{"hands_on_practices": [{"introduction": "理论知识只有通过实践才能变得鲜活。本练习旨在巩固您对 MP2 能量计算中各个基本能量分量之间关系的理解。通过一个直接的计算，您将亲手分离出 MP2 相关能 ($E^{(2)}$)，这是超越 Hartree-Fock 近似的第一个关键修正项。", "problem": "在一项计算量子化学研究中，我们研究了水分子（$H_2O$）的电子基态。该计算采用 Møller-Plesset (MP) 微扰理论来处理电子相关性，而在更简单的 Hartree-Fock (HF) 方法中，电子相关性是被忽略的。\n\n在 MP 理论的框架内，总电子能量表示为对 Hartree-Fock 能量的一系列修正。Hartree-Fock 能量 $E_{HF}$ 本身是零阶能量 $E^{(0)}$ 和一阶能量修正 $E^{(1)}$ 的和。直到二阶的总能量（称为 MP2 能量）由 $E_{MP2} = E_{HF} + E^{(2)}$ 给出，其中 $E^{(2)}$ 是二阶能量修正。这个二阶修正 $E^{(2)}$ 被特别称为 MP2 相关能，因为它代表了超出平均场近似的电子相关性的领头阶修正。\n\n从水分子的计算输出中，获得了以下能量组分：\n- 零阶能量 $E^{(0)}$ 为 $-85.914$ 原子单位 (a.u.)。\n- 一阶能量修正 $E^{(1)}$ 为 $+9.891$ a.u.。\n- MP2 总能量 $E_{MP2}$ 为 $-76.223$ a.u.。\n\n使用这些信息，计算水分子的 MP2 相关能 $E^{(2)}$。答案以原子单位 (a.u.) 表示，并四舍五入到三位有效数字。", "solution": "在 Møller-Plesset 微扰理论中，Hartree-Fock 能量是零阶项和一阶项的和：\n$$\nE_{HF} = E^{(0)} + E^{(1)}.\n$$\n根据给定的值，\n$$\nE_{HF} = -85.914 + 9.891 = -76.023 \\text{ a.u.}\n$$\nMP2 总能量与相关能的关系如下：\n$$\nE_{MP2} = E_{HF} + E^{(2)} \\quad \\Rightarrow \\quad E^{(2)} = E_{MP2} - E_{HF}.\n$$\n代入数值，\n$$\nE^{(2)} = -76.223 - (-76.023) = -0.200 \\text{ a.u.}\n$$\n四舍五入到三位有效数字，MP2 相关能为 $-0.200$ 原子单位。", "answer": "$$\\boxed{-0.200}$$", "id": "1995089"}, {"introduction": "Møller-Plesset 微扰理论公式的核心是描述电子从占据轨道激发到虚拟轨道的求和。本练习通过分析最简单的分子——氢分子 ($H_2$)——来帮助您将抽象的公式与具体的物理图像联系起来。您将需要识别出对 $E^{(2)}$ 能量有贡献的唯一轨道激发，从而深刻理解指数 $i,j,a,b$ 的含义。", "problem": "在计算量子化学中，Møller-Plesset微扰理论是一种在Hartree-Fock近似之外引入电子相关效应的常用方法。考虑最简单的双原子分子H₂，使用最小基组进行建模。该模型恰好产生两个空间分子轨道 (MO)：一个占据的成键分子轨道和一个未占据的 (虚) 反键分子轨道。\n\n为了本题的目的，我们将占据分子轨道标记为轨道1，虚分子轨道标记为轨道2。Møller-Plesset理论中的标准索引约定使用索引 $i, j, k, \\dots$ 表示占据分子轨道，使用索引 $a, b, c, \\dots$ 表示虚分子轨道。\n\n对于闭壳层体系，二阶能量校正 (MP2) 由以下表达式给出：\n$$E^{(2)} = \\sum_{i,j}^{\\text{occ}} \\sum_{a,b}^{\\text{virt}} \\frac{\\langle ij|ab \\rangle (2 \\langle ab|ij \\rangle - \\langle ab|ji \\rangle)}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}$$\n其中，求和遍历所有占据和虚空间轨道，$\\epsilon_k$ 是轨道 $k$ 的能量，$\\langle kl|mn \\rangle$ 是双电子排斥积分。\n\n对于在这种最小基组下描述的H₂分子，求和简化为唯一的非零项。以下哪个索引元组 $(i, j, a, b)$ 代表了对 $E^{(2)}$ 能量的这一独特贡献？\n\nA. $(1, 1, 1, 2)$\n\nB. $(1, 2, 2, 2)$\n\nC. $(1, 1, 2, 2)$\n\nD. $(1, 2, 1, 2)$\n\nE. 此系统不存在非零项。", "solution": "给定闭壳层体系在空间轨道下的MP2能量表达式为\n$$E^{(2)} = \\sum_{i,j}^{\\text{occ}} \\sum_{a,b}^{\\text{virt}} \\frac{\\langle ij|ab \\rangle \\left(2 \\langle ab|ij \\rangle - \\langle ab|ji \\rangle\\right)}{\\epsilon_{i} + \\epsilon_{j} - \\epsilon_{a} - \\epsilon_{b}}.$$\n在最小基组的H₂模型中，恰好有两个空间分子轨道：一个占据的成键轨道 (标记为1) 和一个未占据的反键轨道 (标记为2)。因此，占据索引集为 $\\{1\\}$，虚轨道索引集为 $\\{2\\}$。\n\n因为求和遍历占据索引 $i,j$ 和虚轨道索引 $a,b$，与这些集合一致的唯一允许选择是\n$$i=1,\\quad j=1,\\quad a=2,\\quad b=2.$$\n所有其他组合要么将占据索引分配给虚轨道，要么反之，因此被求和域排除。\n\n为了确认这个单项是非零的，考虑其分子和分母。分子是\n$$\\langle 11|22 \\rangle \\left(2 \\langle 22|11 \\rangle - \\langle 22|11 \\rangle\\right) = \\langle 11|22 \\rangle \\langle 22|11 \\rangle,$$\n该项通常是非零的，因为 $\\langle 11|22 \\rangle$ 和 $\\langle 22|11 \\rangle$ 是不同空间轨道之间的标准双电子库仑/交换型积分。分母是\n$$\\epsilon_{1} + \\epsilon_{1} - \\epsilon_{2} - \\epsilon_{2} = 2\\left(\\epsilon_{1} - \\epsilon_{2}\\right),$$\n该项是非零的，因为在非简并的最小基组H₂体系中，占据轨道和虚轨道的能量是不同的。\n\n因此，对 $E^{(2)}$ 恰好有一个非零贡献，对应于元组 $(i,j,a,b) = (1,1,2,2)$，这与选项C相符。其他列出的选项要么违反了占据/虚轨道索引的约定，要么不对应于求和中的允许项。", "answer": "$$\\boxed{C}$$", "id": "1383036"}, {"introduction": "在掌握了基本概念之后，是时候将理论转化为代码了。这个高级练习挑战您编写一个程序来计算 MP2 相关能，直接实现 $E^{(2)}$ 的数学表达式。通过处理轨道能量和双电子积分，您将获得计算化学软件如何执行这些基本后 Hartree-Fock 计算的第一手经验。", "problem": "在 Møller-Plesset 微扰理论 (MPn) 中，给定一个闭壳层参考态，具体为二阶 Møller-Plesset 微扰理论 (MP2)。设 $N_{\\mathrm{occ}}$ 为占据分子轨道的数量，$N_{\\mathrm{virt}}$ 为未占（虚拟）分子轨道的数量，所有轨道均在正则 Hartree-Fock (HF) 分子轨道基中表示。给定以哈特里 (Hartree) 为单位的占据轨道能量 $\\{\\epsilon_i\\}_{i=1}^{N_{\\mathrm{occ}}}$ 和以哈特里 (Hartree) 为单位的未占（虚拟）轨道能量 $\\{\\epsilon_a\\}_{a=1}^{N_{\\mathrm{virt}}}$。同时，给定以哈特里 (Hartree) 为单位的空间轨道上的反对称化双电子积分 $\\langle ij || ab \\rangle$，其中 $i,j \\in \\{1,\\dots,N_{\\mathrm{occ}}\\}$ 且 $a,b \\in \\{1,\\dots,N_{\\mathrm{virt}}\\}$。反对称化双电子积分定义为 $\\langle ij || ab \\rangle = \\langle ij | ab \\rangle - \\langle ij | ba \\rangle$，并遵循关系式 $\\langle ij || ab \\rangle = - \\langle ji || ab \\rangle = - \\langle ij || ba \\rangle = \\langle ji || ba \\rangle$；所有量均为实数。二阶相关能定义如下：\n$$\nE^{(2)} \\;=\\; \\frac{1}{4} \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\sum_{a=1}^{N_{\\mathrm{virt}}} \\sum_{b=1}^{N_{\\mathrm{virt}}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b},\n$$\n能量以哈特里 (Hartree) 表示。\n\n您的任务是编写一个完整的、可运行的程序，为以下每个测试用例计算 $E^{(2)}$。在每个测试用例中，数据按如下方式指定：\n- 以哈特里 (Hartree) 为单位的占据能量列表 $\\{\\epsilon_i\\}$。\n- 以哈特里 (Hartree) 为单位的未占（虚拟）能量列表 $\\{\\epsilon_a\\}$。\n- 一个独立的非零 $\\langle ij || ab \\rangle$ 分量列表，仅给出满足 $i < j$ 和 $a < b$ 的指标对。所有未列出的分量均为零。完整的反对称化张量由上述反对称关系定义。\n\n测试套件：\n1) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 2$。\n   - $\\{\\epsilon_i\\} = [-0.5, -0.4]$ 哈特里。\n   - $\\{\\epsilon_a\\} = [0.1, 0.2]$ 哈特里。\n   - 非零独立积分 (哈特里): $(i,j,a,b,\\langle ij || ab \\rangle) = (1,2,1,2,0.06)$。\n\n2) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 2$。\n   - $\\{\\epsilon_i\\} = [-0.5, -0.35]$ 哈特里。\n   - $\\{\\epsilon_a\\} = [0.15, 0.25]$ 哈特里。\n   - 无非零独立积分 (所有 $\\langle ij || ab \\rangle = 0$)。\n\n3) $N_{\\mathrm{occ}} = 1$, $N_{\\mathrm{virt}} = 1$。\n   - $\\{\\epsilon_i\\} = [-0.6]$ 哈特里。\n   - $\\{\\epsilon_a\\} = [0.3]$ 哈特里。\n   - 无非零独立积分 (所有 $\\langle ij || ab \\rangle = 0$)。\n\n4) $N_{\\mathrm{occ}} = 3$, $N_{\\mathrm{virt}} = 2$。\n   - $\\{\\epsilon_i\\} = [-0.8, -0.6, -0.5]$ 哈特里。\n   - $\\{\\epsilon_a\\} = [0.1, 0.3]$ 哈特里。\n   - 非零独立积分 (哈特里):\n     $(1,2,1,2,0.04)$, $(1,3,1,2,0.05)$, $(2,3,1,2,0.03)$。\n\n5) $N_{\\mathrm{occ}} = 2$, $N_{\\mathrm{virt}} = 3$。\n   - $\\{\\epsilon_i\\} = [-0.7, -0.45]$ 哈特里。\n   - $\\{\\epsilon_a\\} = [0.2, 0.25, 0.5]$ 哈特里。\n   - 非零独立积分 (哈特里):\n     $(1,2,1,2,0.02)$, $(1,2,1,3,-0.03)$, $(1,2,2,3,0.01)$。\n\n输出规范：\n- 为每个测试用例计算以哈特里 (Hartree) 为单位的 $E^{(2)}$。\n- 将每个结果四舍五入到小数点后 $10$ 位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，不含空格。例如：\"[x1,x2,x3,x4,x5]\"。每个条目的单位是哈特里 (Hartree)。\n\n以哈特里 (Hartree) 为单位作答，按上述要求四舍五入到小数点后十位。", "solution": "该问题要求计算闭壳层体系的二阶 Møller-Plesset 微扰理论 (MP2) 相关能，记为 $E^{(2)}$。在进行求解之前，需要对问题陈述进行严格验证。\n\n**问题验证**\n\n步骤 1：提取已知条件。\n- 提供了 MP2 能量的公式：\n$$\nE^{(2)} \\;=\\; \\frac{1}{4} \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\sum_{a=1}^{N_{\\mathrm{virt}}} \\sum_{b=1}^{N_{\\mathrm{virt}}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\n- $N_{\\mathrm{occ}}$ 是占据轨道的数量，$N_{\\mathrm{virt}}$ 是未占（虚拟）轨道的数量。\n- $\\{\\epsilon_i\\}$ 和 $\\{\\epsilon_a\\}$ 分别是占据轨道和未占（虚拟）轨道能量。\n- $\\langle ij || ab \\rangle$ 是反对称化双电子积分，定义为 $\\langle ij || ab \\rangle = \\langle ij | ab \\rangle - \\langle ij | ba \\rangle$。\n- 积分遵循对称关系：$\\langle ij || ab \\rangle = - \\langle ji || ab \\rangle = - \\langle ij || ba \\rangle = \\langle ji || ba \\rangle$。\n- 对于每个测试用例，给出了 $\\{\\epsilon_i\\}$、$\\{\\epsilon_a\\}$ 的列表，以及满足指标对 $i < j$ 和 $a < b$ 的非零 $\\langle ij || ab \\rangle$ 分量。所有未列出的分量均指定为零。\n\n步骤 2：已知条件的验证。\n- **科学依据**：该问题基于量子化学的既定原理，特别是 MP2 理论。$E^{(2)}$ 的公式和积分的性质都是标准的，尽管所提供的 $E^{(2)}$ 具体公式是几种形式之一，并依赖于某些隐含假设，这些假设已由问题的约束条件阐明。\n- **适定性**：该问题是适定的。提供了一个明确的目标函数 ($E^{(2)}$)，以及每个测试用例的所有必要输入数据。存在唯一解，且可通过直接计算获得。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n- **一致性与完整性**：问题陈述是自洽且内部一致的。仅提供 $i < j$ 和 $a < b$ 的非零积分这一约束条件，意味着所有其他积分（包括 $i=j$ 的情况）均为零。这是一种简化，但在问题定义范围内是有效的。\n\n步骤 3：结论。\n该问题被认定为有效。可以推导出解决方案。\n\n**求解推导**\n\n问题的核心是计算 $E^{(2)}$ 的四重求和。直接、朴素的实现方式计算效率低下。更严谨的方法是利用求和项的对称性。\n\n被加项为 $T_{ijab} = \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}$。\n分母 $D_{ijab} = \\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b$ 对于交换 $i$ 和 $j$ 以及交换 $a$ 和 $b$ 是对称的。也就是说，$D_{ijab} = D_{jiab} = D_{ijba} = D_{jiba}$。\n分子 $\\big(\\langle ij || ab \\rangle\\big)^2$ 由于给定的反对称关系而表现出相同的对称性：\n$\\big(\\langle ji || ab \\rangle\\big)^2 = \\big(-\\langle ij || ab \\rangle\\big)^2 = \\big(\\langle ij || ab \\rangle\\big)^2$。\n$\\big(\\langle ij || ba \\rangle\\big)^2 = \\big(-\\langle ij || ab \\rangle\\big)^2 = \\big(\\langle ij || ab \\rangle\\big)^2$。\n因此，项 $T_{ijab}$ 在这些指标置换下是不变的：$T_{ijab} = T_{jiab} = T_{ijba} = T_{jiba}$。\n\n求和遍历所有指标 $i,j \\in \\{1,...,N_{\\mathrm{occ}}\\}$ 和 $a,b \\in \\{1,...,N_{\\mathrm{virt}}\\}$。我们可以通过考虑指标的两种情况来分析求和。\n\n1.  指标相等的情况：\n    - 如果 $a=b$，积分 $\\langle ij || aa \\rangle = \\langle ij|aa \\rangle - \\langle ij|aa \\rangle = 0$（根据定义）。因此所有 $a=b$ 的项都为零。\n    - 如果 $i=j$，积分为 $\\langle ii || ab \\rangle$。问题陈述指明只有 $i < j$（且 $a < b$）的积分可以非零，且“所有未列出的分量均为零”。这意味着所有 $i=j$ 的积分都恒为零。因此，所有 $i=j$ 的项都为零。\n\n2.  指标不相等的情况：$i \\ne j$ 且 $a \\ne b$。\n    遍历所有 $i,j,a,b$ 的完整求和可以通过将指标限制为有序对来重写，以避免重复计数。对于任意一组特定的四个不同指标 $\\{i_0, j_0\\}$ 和 $\\{a_0, b_0\\}$，其中我们可以选择 $i_0 < j_0$ 和 $a_0 < b_0$，完整的无限制求和包含四个相同的项：$T_{i_0j_0a_0b_0}$, $T_{j_0i_0a_0b_0}$, $T_{i_0j_0b_0a_0}$ 和 $T_{j_0i_0b_0a_0}$。\n    因此，遍历所有 $i,j,a,b$（其中 $i \\ne j, a \\ne b$）的总和等价于遍历有序、不同指标求和的四倍：\n    $$ \\sum_{i \\ne j}^{\\mathrm{occ}} \\sum_{a \\ne b}^{\\mathrm{virt}} T_{ijab} = \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} 4 \\cdot T_{ijab} $$\n    将此代入 $E^{(2)}$ 的原始表达式：\n    $$ E^{(2)} = \\frac{1}{4} \\left( \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} 4 \\cdot \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b} \\right) $$\n    $4$ 和 $\\frac{1}{4}$ 因子相互抵消。这得到了简化的、计算上更高效的公式：\n    $$ E^{(2)} = \\sum_{i < j}^{\\mathrm{occ}} \\sum_{a < b}^{\\mathrm{virt}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b} $$\n    这个最终表达式就是必须实现的。计算过程是通过对所提供的非零积分列表中的贡献进行求和，因为这些积分已经是在 $i < j$ 和 $a < b$ 条件下指定的。\n\n**算法**\n对于每个测试用例：\n1.  将能量 $E^{(2)}$ 初始化为 $0$。\n2.  获取占据能量列表 $\\{\\epsilon_i\\}$、未占（虚拟）能量列表 $\\{\\epsilon_a\\}$ 以及非零积分列表。为便于计算，能量应存储在零索引数组中。\n3.  遍历每个提供的积分元组 $(i, j, a, b, V)$，其中 $V = \\langle ij || ab \\rangle$，且指标是基于 1 的。\n4.  对于每个积分，使用基于 0 的数组索引来确定相应的轨道能量：$\\epsilon_{i-1}$、$\\epsilon_{j-1}$、$\\epsilon_{a-1}$、$\\epsilon_{b-1}$。\n5.  计算能量分母 $D = \\epsilon_{i-1} + \\epsilon_{j-1} - \\epsilon_{a-1} - \\epsilon_{b-1}$。问题的条件（占据能量为负，虚拟能量为正）确保了 $D$ 始终为负且非零，从而避免了奇点。\n6.  计算此项对能量的贡献：$\\frac{V^2}{D}$。\n7.  将此贡献加到总能量 $E^{(2)}$ 中。\n8.  遍历完所有提供的积分后，总和即为该测试用例的最终 $E^{(2)}$。\n9.  必须按要求将结果格式化为小数点后 10 位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the MP2 correlation energy for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"eps_occ\": np.array([-0.5, -0.4]),\n            \"eps_virt\": np.array([0.1, 0.2]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.06)\n            ],\n        },\n        {\n            \"eps_occ\": np.array([-0.5, -0.35]),\n            \"eps_virt\": np.array([0.15, 0.25]),\n            \"integrals\": [],\n        },\n        {\n            \"eps_occ\": np.array([-0.6]),\n            \"eps_virt\": np.array([0.3]),\n            \"integrals\": [],\n        },\n        {\n            \"eps_occ\": np.array([-0.8, -0.6, -0.5]),\n            \"eps_virt\": np.array([0.1, 0.3]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.04),\n                (1, 3, 1, 2, 0.05),\n                (2, 3, 1, 2, 0.03),\n            ],\n        },\n        {\n            \"eps_occ\": np.array([-0.7, -0.45]),\n            \"eps_virt\": np.array([0.2, 0.25, 0.5]),\n            \"integrals\": [\n                (1, 2, 1, 2, 0.02),\n                (1, 2, 1, 3, -0.03),\n                (1, 2, 2, 3, 0.01),\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e2_corr = calculate_mp2_energy(case[\"eps_occ\"], case[\"eps_virt\"], case[\"integrals\"])\n        results.append(e2_corr)\n    \n    # Format the results to 10 decimal places and create the output string.\n    formatted_results = [f\"{res:.10f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_mp2_energy(eps_occ, eps_virt, integrals):\n    \"\"\"\n    Calculates the MP2 correlation energy based on the simplified formula.\n\n    $$\n    E^{(2)} = \\sum_{i  j}^{\\mathrm{occ}} \\sum_{a  b}^{\\mathrm{virt}} \\frac{\\big(\\langle ij || ab \\rangle\\big)^2}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n    $$\n\n    Args:\n        eps_occ (np.ndarray): Array of occupied orbital energies.\n        eps_virt (np.ndarray): Array of virtual orbital energies.\n        integrals (list): A list of tuples, where each tuple contains\n                          (i, j, a, b, value) for a non-zero antisymmetrized\n                          two-electron integral. Indices are 1-based.\n    \n    Returns:\n        float: The calculated MP2 correlation energy E(2).\n    \"\"\"\n    e2_corr = 0.0\n\n    for i, j, a, b, value in integrals:\n        # Convert 1-based indices to 0-based for array access\n        i_idx, j_idx = i - 1, j - 1\n        a_idx, b_idx = a - 1, b - 1\n        \n        # Get orbital energies\n        eps_i = eps_occ[i_idx]\n        eps_j = eps_occ[j_idx]\n        eps_a = eps_virt[a_idx]\n        eps_b = eps_virt[b_idx]\n        \n        # Calculate the energy denominator\n        denominator = eps_i + eps_j - eps_a - eps_b\n        \n        # Add the contribution to the total E(2) energy\n        if denominator != 0:\n            e2_corr += (value**2) / denominator\n            \n    return e2_corr\n\nsolve()\n```", "id": "2458952"}]}