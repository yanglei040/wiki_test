{"hands_on_practices": [{"introduction": "在芯片制造验证过程中，一个关键步骤是确保芯片在最坏的功耗情况下不会过热。本练习将引导你应用基本的一阶RC热模型，来计算为了有效地进行压力测试，需要持续多长时间。通过这个实践，你将掌握运用能量守恒方程预测温度随时间变化的核心技能，这在设计可靠的硬件测试中至关重要。[@problem_id:3684967]", "problem": "一个片上系统 (SoC) 的生产验证程序必须在高活动度测试模式下验证最坏情况下的结峰值温度，表示为 $T_{\\mathrm{peak}}$。假设芯片的热行为可以通过一个单一的集总热阻-热容网络来建模，该网络由从结到环境的热阻 $R_{\\mathrm{th}}$ 和捕捉了芯片、封装和直接机械组件总热容量的热容 $C_{\\mathrm{th}}$ 组成。设环境温度为 $T_{\\mathrm{amb}}$。测试在设备已充分闲置足够长的时间后开始，使其结温等于 $T_{\\mathrm{amb}}$。\n\n为了模拟最坏情况下的开关活动，测试模式在一个固定的工作点下（无动态电压和频率缩放）以最大活动度驱动所有核心。互补金属氧化物半导体 (CMOS) 逻辑中的动态功耗由经过充分验证的关系式 $P_{\\mathrm{dyn}} = C_{\\mathrm{eff}} V^{2} f \\alpha$ 给出，其中 $C_{\\mathrm{eff}}$ 是有效开关电容，$V$ 是电源电压，$f$ 是时钟频率，$\\alpha$ 是活动因子。考虑一个拥有 $N$ 个相同核心和一个 uncore 子系统的 SoC，该 uncore 子系统的功耗在测试下近似恒定。相关参数如下：\n- 核心数量 $N = 8$,\n- 每个核心的有效开关电容 $C_{\\mathrm{eff,core}} = 0.5 \\times 10^{-9}\\,\\mathrm{F}$,\n- 电源电压 $V = 1.0\\,\\mathrm{V}$,\n- 时钟频率 $f = 2.5 \\times 10^{9}\\,\\mathrm{Hz}$,\n- 测试模式下的活动因子 $\\alpha = 1$,\n- uncore 功耗 $P_{\\mathrm{uncore}} = 5\\,\\mathrm{W}$,\n- 热阻 $R_{\\mathrm{th}} = 3.0\\,\\mathrm{K/W}$,\n- 热容 $C_{\\mathrm{th}} = 40\\,\\mathrm{J/K}$,\n- 环境温度 $T_{\\mathrm{amb}} = 25\\,^{\\circ}\\mathrm{C}$。\n\n生产验证要求持续的高活动度测试时间足够长，以使结温至少达到规格阈值 $T_{\\mathrm{spec}} = 68\\,^{\\circ}\\mathrm{C}$。\n\n使用能量平衡和热 RC 建模的第一性原理，推导最坏情况测试模式必须持续的最小持续时间 $t$，以使结温达到 $T_{\\mathrm{spec}}$。以秒为单位表示您的最终答案，并将答案四舍五入到三位有效数字。", "solution": "问题要求计算在高活动度测试模式下，片上系统 (SoC) 达到指定结温 $T_{\\mathrm{spec}}$ 所需的最小时间。SoC 的热行为被建模为一个一阶集总热阻-热容 (RC) 网络。\n\n控制该系统的基本原理是能量平衡方程。储存在热容 $C_{\\mathrm{th}}$ 中的热能变化率等于流入系统的净功率。这个净功率是芯片耗散的总功率 $P_{\\mathrm{total}}$ 与传导到周围环境的热量之差。\n\n设 $T_{\\mathrm{j}}(t)$ 为时间 $t$ 时的结温，$T_{\\mathrm{amb}}$ 为环境温度。能量储存率为 $C_{\\mathrm{th}} \\frac{d T_{\\mathrm{j}}(t)}{dt}$。传导到环境的热量由 $\\frac{T_{\\mathrm{j}}(t) - T_{\\mathrm{amb}}}{R_{\\mathrm{th}}}$ 给出，其中 $R_{\\mathrm{th}}$ 是从结到环境的热阻。因此，能量平衡由以下一阶线性常微分方程描述：\n$$ C_{\\mathrm{th}} \\frac{d T_{\\mathrm{j}}(t)}{dt} = P_{\\mathrm{total}} - \\frac{T_{\\mathrm{j}}(t) - T_{\\mathrm{amb}}}{R_{\\mathrm{th}}} $$\n\n首先，我们必须计算总功耗 $P_{\\mathrm{total}}$。这是 $N$ 个核心消耗的功率 $P_{\\mathrm{cores}}$ 与 uncore 子系统消耗的功率 $P_{\\mathrm{uncore}}$ 之和。单个核心的动态功耗由 $P_{\\mathrm{dyn,core}} = C_{\\mathrm{eff,core}} V^{2} f \\alpha$ 给出。对于 $N$ 个相同的核心，来自核心的总功率为 $P_{\\mathrm{cores}} = N \\times P_{\\mathrm{dyn,core}}$。\n\n使用给定的值：\n- 核心数量, $N = 8$\n- 每个核心的有效开关电容, $C_{\\mathrm{eff,core}} = 0.5 \\times 10^{-9}\\,\\text{F}$\n- 电源电压, $V = 1.0\\,\\text{V}$\n- 时钟频率, $f = 2.5 \\times 10^{9}\\,\\text{Hz}$\n- 活动因子, $\\alpha = 1$\n\n核心的总功率为：\n$$ P_{\\mathrm{cores}} = 8 \\times (0.5 \\times 10^{-9}\\,\\text{F}) \\times (1.0\\,\\text{V})^{2} \\times (2.5 \\times 10^{9}\\,\\text{Hz}) \\times 1 $$\n$$ P_{\\mathrm{cores}} = 8 \\times 0.5 \\times 2.5 \\times (10^{-9} \\times 10^{9}) \\,\\text{W} = 10\\,\\text{W} $$\n芯片耗散的总功率是核心功率和 uncore 功率之和, $P_{\\mathrm{uncore}} = 5\\,\\text{W}$：\n$$ P_{\\mathrm{total}} = P_{\\mathrm{cores}} + P_{\\mathrm{uncore}} = 10\\,\\text{W} + 5\\,\\text{W} = 15\\,\\text{W} $$\n\n现在我们求解这个微分方程。让我们定义高出环境的温升为 $\\Delta T(t) = T_{\\mathrm{j}}(t) - T_{\\mathrm{amb}}$。那么 $\\frac{d(\\Delta T(t))}{dt} = \\frac{d T_{\\mathrm{j}}(t)}{dt}$。将此代入能量平衡方程：\n$$ C_{\\mathrm{th}} \\frac{d(\\Delta T(t))}{dt} = P_{\\mathrm{total}} - \\frac{\\Delta T(t)}{R_{\\mathrm{th}}} $$\n将其整理成一阶线性常微分方程的标准形式：\n$$ R_{\\mathrm{th}} C_{\\mathrm{th}} \\frac{d(\\Delta T(t))}{dt} + \\Delta T(t) = P_{\\mathrm{total}} R_{\\mathrm{th}} $$\n我们定义热时间常数为 $\\tau_{\\mathrm{th}} = R_{\\mathrm{th}} C_{\\mathrm{th}}$。方程变为：\n$$ \\tau_{\\mathrm{th}} \\frac{d(\\Delta T(t))}{dt} + \\Delta T(t) = P_{\\mathrm{total}} R_{\\mathrm{th}} $$\n该方程的通解形式为 $\\Delta T(t) = \\Delta T_{\\mathrm{ss}} + A \\exp(-t/\\tau_{\\mathrm{th}})$，其中 $\\Delta T_{\\mathrm{ss}}$ 是稳态温升，发生在 $\\frac{d(\\Delta T)}{dt}=0$ 时。从方程可知，$\\Delta T_{\\mathrm{ss}} = P_{\\mathrm{total}} R_{\\mathrm{th}}$。\n所以，$\\Delta T(t) = P_{\\mathrm{total}} R_{\\mathrm{th}} + A \\exp(-t/\\tau_{\\mathrm{th}})$。\n\n我们使用初始条件来求解常数 $A$。问题陈述设备从闲置状态开始，因此其初始结温等于环境温度：$T_{\\mathrm{j}}(0) = T_{\\mathrm{amb}}$。这意味着初始温升为零：$\\Delta T(0) = T_{\\mathrm{j}}(0) - T_{\\mathrm{amb}} = 0$。\n将 $t=0$ 代入解中：\n$$ \\Delta T(0) = 0 = P_{\\mathrm{total}} R_{\\mathrm{th}} + A \\exp(0) \\implies A = -P_{\\mathrm{total}} R_{\\mathrm{th}} $$\n温升的特解是：\n$$ \\Delta T(t) = P_{\\mathrm{total}} R_{\\mathrm{th}} (1 - \\exp(-t/\\tau_{\\mathrm{th}})) $$\n用结温 $T_{\\mathrm{j}}(t)$ 表示：\n$$ T_{\\mathrm{j}}(t) = T_{\\mathrm{amb}} + P_{\\mathrm{total}} R_{\\mathrm{th}} (1 - \\exp(-t/\\tau_{\\mathrm{th}})) $$\n\n问题要求计算结温达到 $T_{\\mathrm{spec}} = 68\\,^{\\circ}\\mathrm{C}$ 所需的最小持续时间 $t$。我们令 $T_{\\mathrm{j}}(t) = T_{\\mathrm{spec}}$ 并求解 $t$：\n$$ T_{\\mathrm{spec}} = T_{\\mathrm{amb}} + P_{\\mathrm{total}} R_{\\mathrm{th}} (1 - \\exp(-t/\\tau_{\\mathrm{th}})) $$\n$$ \\frac{T_{\\mathrm{spec}} - T_{\\mathrm{amb}}}{P_{\\mathrm{total}} R_{\\mathrm{th}}} = 1 - \\exp(-t/\\tau_{\\mathrm{th}}) $$\n$$ \\exp(-t/\\tau_{\\mathrm{th}}) = 1 - \\frac{T_{\\mathrm{spec}} - T_{\\mathrm{amb}}}{P_{\\mathrm{total}} R_{\\mathrm{th}}} $$\n对两边取自然对数：\n$$ -\\frac{t}{\\tau_{\\mathrm{th}}} = \\ln\\left(1 - \\frac{T_{\\mathrm{spec}} - T_{\\mathrm{amb}}}{P_{\\mathrm{total}} R_{\\mathrm{th}}}\\right) $$\n$$ t = -\\tau_{\\mathrm{th}} \\ln\\left(1 - \\frac{T_{\\mathrm{spec}} - T_{\\mathrm{amb}}}{P_{\\mathrm{total}} R_{\\mathrm{th}}}\\right) $$\n\n现在，我们将数值代入此表达式。首先，让我们计算热时间常数 $\\tau_{\\mathrm{th}}$ 和稳态温升 $P_{\\mathrm{total}} R_{\\mathrm{th}}$：\n- 热阻, $R_{\\mathrm{th}} = 3.0\\,\\text{K/W}$\n- 热容, $C_{\\mathrm{th}} = 40\\,\\text{J/K}$\n$$ \\tau_{\\mathrm{th}} = R_{\\mathrm{th}} C_{\\mathrm{th}} = (3.0\\,\\text{K/W}) \\times (40\\,\\text{J/K}) = 120\\,\\text{s} $$\n稳态温升为：\n$$ P_{\\mathrm{total}} R_{\\mathrm{th}} = (15\\,\\text{W}) \\times (3.0\\,\\text{K/W}) = 45\\,\\text{K} $$\n所需的温升为：\n$$ T_{\\mathrm{spec}} - T_{\\mathrm{amb}} = 68\\,^{\\circ}\\mathrm{C} - 25\\,^{\\circ}\\mathrm{C} = 43\\,^{\\circ}\\mathrm{C} = 43\\,\\text{K} $$\n注意，摄氏度的温差等于开尔文的温差。\n稳态结温将是 $T_{\\mathrm{j,ss}} = T_{\\mathrm{amb}} + P_{\\mathrm{total}}R_{\\mathrm{th}} = 25\\,^{\\circ}\\mathrm{C} + 45\\,^{\\circ}\\mathrm{C} = 70\\,^{\\circ}\\mathrm{C}$。由于 $T_{\\mathrm{spec}}  T_{\\mathrm{j,ss}}$，因此存在有限时间解。\n\n将这些值代入 $t$ 的表达式中：\n$$ t = -120\\,\\text{s} \\times \\ln\\left(1 - \\frac{43\\,\\text{K}}{45\\,\\text{K}}\\right) $$\n$$ t = -120 \\ln\\left(1 - \\frac{43}{45}\\right) = -120 \\ln\\left(\\frac{2}{45}\\right) $$\n使用对数性质 $\\ln(a/b) = -\\ln(b/a)$：\n$$ t = 120 \\ln\\left(\\frac{45}{2}\\right) = 120 \\ln(22.5) $$\n计算数值：\n$$ t \\approx 120 \\times 3.113515 \\approx 373.6218\\,\\text{s} $$\n问题要求将答案四舍五入到三位有效数字。\n$$ t \\approx 374\\,\\text{s} $$", "answer": "$$\n\\boxed{374}\n$$", "id": "3684967"}, {"introduction": "现代处理器常常利用“睿频”（Turbo Mode）技术，在短时间内超越其标称性能极限以提升响应速度。这种机会性性能提升利用了系统的热惯性，即芯片在达到热极限之前可以在高功率下运行一小段时间。本练习将分析从基准频率切换到睿频模式时的瞬态热行为，让你亲手计算出在不超过最高允许温度的前提下，睿频模式可以持续的最长时间。[@problem_id:3684962]", "problem": "一个多核处理器芯片使用动态电压和频率缩放 (DVFS) 技术进入一个临时的睿频模式，该模式会同时提高时钟频率和电源电压。该封装可以近似为一个单一的主导集总热极点，其特性由热阻 $R_{\\mathrm{th}}$ 和热时间常数 $\\tau$ 描述，并以环境温度 $T_{\\mathrm{amb}}$ 为参考。处理器的总功耗是动态功耗和漏电功耗之和。动态功耗由广泛使用的关系式 $P_{\\mathrm{dyn}} = C_{\\mathrm{eff}} V^{2} f$ 建模，其中 $C_{\\mathrm{eff}}$ 是有效开关电容。漏电功耗建模为 $P_{\\mathrm{leak}} = k_{\\mathrm{leak}} V$，其中 $k_{\\mathrm{leak}}$ 是一个恒定系数。\n\n在基准操作下，处理器运行频率为 $f_{0} = 3.0 \\times 10^{9}\\ \\mathrm{Hz}$，电压为 $V_{0} = 1.0\\ \\mathrm{V}$。在时间 $t = 0$ 时，它进入睿频模式，频率增量为 $\\Delta f = 1.0 \\times 10^{9}\\ \\mathrm{Hz}$，电压增量为 $\\Delta V = 0.1\\ \\mathrm{V}$，因此 $f_{1} = f_{0} + \\Delta f$ 且 $V_{1} = V_{0} + \\Delta V$。使用以下参数：环境温度 $T_{\\mathrm{amb}} = 300\\ \\mathrm{K}$，有效开关电容 $C_{\\mathrm{eff}} = 20 \\times 10^{-9}\\ \\mathrm{F}$，漏电系数 $k_{\\mathrm{leak}} = 10\\ \\mathrm{W}/\\mathrm{V}$，热阻 $R_{\\mathrm{th}} = 0.4\\ \\mathrm{K}/\\mathrm{W}$，以及热时间常数 $\\tau = 10\\ \\mathrm{s}$。最大允许结温为 $T_{\\max} = 340\\ \\mathrm{K}$。\n\n请从能量守恒定律和一个有物理基础的单极点集总热模型明确出发，并使用上述功耗模型，首先推导当系统在 $t=0$ 时从基准模式阶跃到睿频模式后，对于 $t \\geq 0$ 的温度瞬态 $T(t)$。然后，确定最大睿频持续时间 $t_{\\mathrm{win}}$，使得在所有 $t \\in [0, t_{\\mathrm{win}}]$ 的时间内，温度都满足 $T(t) \\leq T_{\\max}$。\n\n将您计算出的 $t_{\\mathrm{win}}$ 最终数值四舍五入到四位有效数字，并以秒为单位表示。", "solution": "具有单一主导极点的集总体的热动态特性可以从能量守恒定律推导得出。设 $T(t)$ 为结温。一个通过热阻 $R_{\\mathrm{th}}$ 连接到环境的集总热容 $C_{\\mathrm{th}}$ 的能量平衡方程为\n$$\nC_{\\mathrm{th}} \\frac{dT}{dt} = P(t) - \\frac{T(t) - T_{\\mathrm{amb}}}{R_{\\mathrm{th}}},\n$$\n其中 $P(t)$ 是传递到芯片的总功率。热时间常数为 $\\tau = R_{\\mathrm{th}} C_{\\mathrm{th}}$，所以我们可以写成\n$$\n\\frac{dT}{dt} = \\frac{1}{C_{\\mathrm{th}}} P(t) - \\frac{T(t) - T_{\\mathrm{amb}}}{R_{\\mathrm{th}} C_{\\mathrm{th}}}\n= \\frac{1}{C_{\\mathrm{th}}} P(t) - \\frac{T(t) - T_{\\mathrm{amb}}}{\\tau}.\n$$\n对于在 $t=0$ 时功率从基准恒定功率 $P_{0}$ 阶跃变化到睿频恒定功率 $P_{1}$ 的情况，该系统是线性时不变的，其对于 $t \\geq 0$ 的解是标准的一阶响应：\n$$\nT(t) = T_{\\infty} + \\bigl( T(0^{+}) - T_{\\infty} \\bigr) \\exp\\!\\left( -\\frac{t}{\\tau} \\right),\n$$\n其中，睿频功率下的新稳态温度为\n$$\nT_{\\infty} = T_{\\mathrm{amb}} + R_{\\mathrm{th}} P_{1},\n$$\n并且初始条件 $T(0^{+})$ 等于稳态基准温度 $T(0^{-}) = T_{\\mathrm{amb}} + R_{\\mathrm{th}} P_{0}$，因为温度是连续的。\n\n我们现在使用给定的功耗模型计算 $P_{0}$ 和 $P_{1}$。总功耗为\n$$\nP = P_{\\mathrm{dyn}} + P_{\\mathrm{leak}} = C_{\\mathrm{eff}} V^{2} f + k_{\\mathrm{leak}} V.\n$$\n基准值：\n$$\nf_{0} = 3.0 \\times 10^{9}, \\quad V_{0} = 1.0, \\quad C_{\\mathrm{eff}} = 20 \\times 10^{-9}, \\quad k_{\\mathrm{leak}} = 10.\n$$\n计算基准动态功耗：\n$$\nP_{\\mathrm{dyn},0} = C_{\\mathrm{eff}} V_{0}^{2} f_{0} = \\left( 20 \\times 10^{-9} \\right) \\cdot (1.0)^{2} \\cdot \\left( 3.0 \\times 10^{9} \\right) = 60.\n$$\n基准漏电功耗：\n$$\nP_{\\mathrm{leak},0} = k_{\\mathrm{leak}} V_{0} = 10 \\cdot 1.0 = 10.\n$$\n因此，\n$$\nP_{0} = 60 + 10 = 70.\n$$\n睿频值：\n$$\nf_{1} = f_{0} + \\Delta f = 3.0 \\times 10^{9} + 1.0 \\times 10^{9} = 4.0 \\times 10^{9}, \\quad V_{1} = V_{0} + \\Delta V = 1.0 + 0.1 = 1.1.\n$$\n睿频动态功耗：\n$$\nP_{\\mathrm{dyn},1} = C_{\\mathrm{eff}} V_{1}^{2} f_{1} = \\left( 20 \\times 10^{-9} \\right) \\cdot (1.1)^{2} \\cdot \\left( 4.0 \\times 10^{9} \\right)\n= \\left( 20 \\times 10^{-9} \\right) \\cdot 1.21 \\cdot \\left( 4.0 \\times 10^{9} \\right)\n= 96.8.\n$$\n睿频漏电功耗：\n$$\nP_{\\mathrm{leak},1} = k_{\\mathrm{leak}} V_{1} = 10 \\cdot 1.1 = 11.\n$$\n因此，\n$$\nP_{1} = 96.8 + 11 = 107.8.\n$$\n当 $R_{\\mathrm{th}} = 0.4$ 且 $T_{\\mathrm{amb}} = 300$ 时，我们有\n$$\nT(0^{+}) = T_{\\mathrm{amb}} + R_{\\mathrm{th}} P_{0} = 300 + 0.4 \\cdot 70 = 300 + 28 = 328,\n$$\n和\n$$\nT_{\\infty} = T_{\\mathrm{amb}} + R_{\\mathrm{th}} P_{1} = 300 + 0.4 \\cdot 107.8 = 300 + 43.12 = 343.12.\n$$\n因此睿频瞬态响应为\n$$\nT(t) = 343.12 + \\left( 328 - 343.12 \\right) \\exp\\!\\left( -\\frac{t}{10} \\right)\n= 343.12 - 15.12 \\exp\\!\\left( -\\frac{t}{10} \\right).\n$$\n为了找到最大睿频持续时间 $t_{\\mathrm{win}}$ 使得对于 $t \\in [0, t_{\\mathrm{win}}]$ 有 $T(t) \\leq T_{\\max}$，我们设 $T(t_{\\mathrm{win}}) = T_{\\max}$ 并求解 $t_{\\mathrm{win}}$。当 $T_{\\max} = 340$ 时，\n$$\n340 = 343.12 - 15.12 \\exp\\!\\left( -\\frac{t_{\\mathrm{win}}}{10} \\right).\n$$\n整理得：\n$$\n15.12 \\exp\\!\\left( -\\frac{t_{\\mathrm{win}}}{10} \\right) = 343.12 - 340 = 3.12,\n$$\n$$\n\\exp\\!\\left( -\\fract_{\\mathrm{win}}}{10} \\right) = \\frac{3.12}{15.12} = \\frac{13}{63}.\n$$\n取自然对数，\n$$\n-\\frac{t_{\\mathrm{win}}}{10} = \\ln\\!\\left( \\frac{13}{63} \\right),\n\\quad \\Rightarrow \\quad\nt_{\\mathrm{win}} = -10 \\, \\ln\\!\\left( \\frac{13}{63} \\right).\n$$\n数值上，$\\ln\\!\\left( \\frac{13}{63} \\right) \\approx -1.57818537$，所以\n$$\nt_{\\mathrm{win}} \\approx 15.7818537.\n$$\n四舍五入到四位有效数字并以秒为单位表示，\n$$\nt_{\\mathrm{win}} = 15.78.\n$$", "answer": "$$\\boxed{15.78}$$", "id": "3684962"}, {"introduction": "热管理策略与处理器的微架构设计和性能表现紧密相连。例如，为了应对局部热点，系统可能会采取节流指令获取等措施，这在降低功耗的同时也影响着每周期指令数（$IPC$）等关键性能指标。本练习将引导你建立一个微架构性能模型来计算功耗变化，并进一步分析这种控制策略所带来的热效应。这个综合性问题将帮助你理解在现代处理器设计中，性能、功耗和温度是如何构成一个紧密耦合的系统的。[@problem_id:3685015]", "problem": "考虑一个正在经历瞬态热点的超标量处理器。该微架构具有前端（指令获取、指令缓存和分支预测）和后端（重命名、调度、执行单元和提交）。处理器在电源电压 $V$ 和时钟频率 $f$ 下运行，一个模块的动态功耗由经过充分验证的关系式 $P_{\\text{dyn}} = \\alpha C V^{2} f$ 建模，其中 $\\alpha$ 是活动因子，$C$ 是有效开关电容。芯片的热行为可以建模为一个连接到环境的单一集总热阻-热容网络，其到环境的热阻为 $R_{\\text{th}}$，封装的热容为 $C_{\\text{th}}$。\n\n在时间 $t = 0$ 时，一个热点触发了指令获取节流，从而减小了获取宽度。这也改变了分支行为并影响了每周期指令数 (IPC)。假设以下有科学依据的参数和建模假设：\n\n- 时钟频率 $f = 3.0 \\,\\mathrm{GHz}$，电源电压 $V = 1.0 \\,\\mathrm{V}$，环境温度 $T_{\\text{amb}} = 25 \\,\\mathrm{^{\\circ}C}$。\n- 热阻 $R_{\\text{th}} = 1.0 \\,\\mathrm{K/W}$，热容 $C_{\\text{th}} = 20 \\,\\mathrm{J/K}$。\n- 在所考虑的时间窗口内，静态泄漏功耗对温度不敏感，为 $P_{\\text{leak}} = 3.0 \\,\\mathrm{W}$。\n- 在 $t = 0$ 之前，处理器以稳态运行，参数如下：\n  - 发射宽度 $W_{\\text{issue}} = 4$ 和获取宽度 $W_{\\text{fetch,0}} = 4$。\n  - 分支密度 $d = 0.20$ 个分支/指令。\n  - 每个分支的预测错误概率 $m_{0} = 0.05$。\n  - 预测错误惩罚 $B = 15$ 个周期。\n  - 前端有效开关电容 $C_{\\text{FE}} = 2.0 \\times 10^{-9} \\,\\mathrm{F}$。\n  - 后端有效开关电容 $C_{\\text{BE}} = 8.0 \\times 10^{-9} \\,\\mathrm{F}$。\n  - 当前端主动获取时，每个获取槽位每周期对 $\\alpha_{\\text{FE}}$ 贡献一个活动增量 $\\alpha_{\\text{slot}} = 0.10$。在由分支预测错误引起的停顿期间，前端仍然有最小化的翻转，每周期贡献 $\\alpha_{\\text{stall}} = 0.02$，这与 $W_{\\text{fetch}}$ 无关。\n  - 在后端，每周期提交的每条指令对后端每指令每周期的活动贡献一个活动增量 $\\alpha_{u} = 0.10$（即，后端的动态功耗通过相同的 $P_{\\text{dyn}} = \\alpha C V^{2} f$ 模型与 IPC 线性相关）。\n- 在 $t = 0$ 时，获取节流将获取宽度减小到 $W_{\\text{fetch,1}} = 2$。同时，每个分支的预测错误概率增加到 $m_{1} = 0.08$（分支密度 $d$ 和惩罚 $B$ 保持不变）。\n\n将没有停顿的周期内的提交能力建模为 $W_{c} = \\min\\!\\big(W_{\\text{issue}}, W_{\\text{fetch}}\\big)$。使用上述定义，从第一性原理推导出一个关于因分支预测错误停顿而损失的周期比例的自洽表达式，并由此确定节流前和节流后条件下的 IPC $R$。使用这些值通过 $P_{\\text{dyn}} = \\alpha C V^{2} f$ 计算节流前后的前端和后端动态功耗，然后计算总功耗。假设在 $t = 0$ 之前，处理器已运行足够长的时间，达到了由节流前总功耗设定的稳态温度。对于 $t \\ge 0$，将功耗视为一个到节流后总功耗的阶跃变化。使用集总热阻-热容模型，确定在时间 $t = 0.50 \\,\\mathrm{s}$ 时的芯片温度。\n\n将最终温度四舍五入到四位有效数字。以摄氏度表示最终温度。", "solution": "该问题要求确定在操作参数发生变化后，处理器在特定时间 $t = 0.50 \\, \\mathrm{s}$ 时的芯片温度。解决方案涉及一个多步骤分析：首先，确定变化前的初始稳态温度；其次，确定变化后的新功耗；第三，求解瞬态热响应。\n\n首先，我们建立一个性能模型来计算每周期指令数 (IPC)，记为 $R$。提交宽度 $W_c$ 是在没有停顿的情况下每周期可以处理的最大指令数，由 $W_c = \\min(W_{\\text{issue}}, W_{\\text{fetch}})$ 给出。停顿是由分支预测错误引入的。设 $S$ 为因停顿而损失的周期比例。那么有效 IPC 为 $R = W_c (1 - S)$。\n\n在一个包含 $N_{\\text{cyc}}$ 个周期的长时间间隔内，提交的指令数为 $N_{\\text{inst}} = R \\times N_{\\text{cyc}}$。分支数为 $N_{\\text{branch}} = N_{\\text{inst}} \\times d$，其中 $d$ 是分支密度。预测错误数为 $N_{\\text{misp}} = N_{\\text{branch}} \\times m$，其中 $m$ 是预测错误概率。每次预测错误花费 $B$ 个周期，因此总停顿周期数为 $N_{\\text{stall}} = N_{\\text{misp}} \\times B = (R \\times N_{\\text{cyc}} \\times d \\times m) \\times B$。停顿周期的比例为 $S = N_{\\text{stall}} / N_{\\text{cyc}} = R \\times d \\times m \\times B$。\n\n我们得到一个关于 $R$ 和 $S$ 的方程组：\n$R = W_c (1 - S)$\n$S = R d m B$\n\n将第二个方程代入第一个方程，得到 $R = W_c (1 - R d m B)$。解出 $R$：\n$R = W_c - R W_c d m B$\n$R(1 + W_c d m B) = W_c$\n$$R = \\frac{W_c}{1 + W_c d m B}$$\n\n这个表达式使我们能够计算节流前和节流后两种情况下的 IPC。\n\n状态 0：节流前分析 ($t  0$)\n给定参数为：$W_{\\text{issue}} = 4$，$W_{\\text{fetch,0}} = 4$，$d = 0.20$，$m_0 = 0.05$ 和 $B = 15$。\n提交宽度为 $W_{c,0} = \\min(4, 4) = 4$。\nIPC 为：\n$$R_0 = \\frac{W_{c,0}}{1 + W_{c,0} d m_0 B} = \\frac{4}{1 + (4)(0.20)(0.05)(15)} = \\frac{4}{1 + 0.6} = \\frac{4}{1.6} = 2.5$$\n停顿周期比例为 $S_0 = R_0 d m_0 B = (2.5)(0.20)(0.05)(15) = 0.375$。\n\n现在，我们计算总功耗 $P_{\\text{total},0}$，它是前端动态功耗 ($P_{\\text{dyn,FE},0}$)、后端动态功耗 ($P_{\\text{dyn,BE},0}$) 和静态泄漏功耗 ($P_{\\text{leak}}$) 的总和。\n动态功耗为 $P_{\\text{dyn}} = \\alpha C V^2 f$。\n前端活动因子 $\\alpha_{\\text{FE},0}$ 是主动获取周期（比例为 $1 - S_0$）和停顿周期（比例为 $S_0$）期间活动的加权平均值：\n$\\alpha_{\\text{FE},0} = (1 - S_0)(W_{\\text{fetch,0}} \\alpha_{\\text{slot}}) + S_0 \\alpha_{\\text{stall}} = (1 - 0.375)(4 \\times 0.10) + (0.375)(0.02) = (0.625)(0.40) + 0.0075 = 0.25 + 0.0075 = 0.2575$。\n$P_{\\text{dyn,FE},0} = \\alpha_{\\text{FE},0} C_{\\text{FE}} V^2 f = (0.2575)(2.0 \\times 10^{-9} \\, \\mathrm{F})(1.0 \\, \\mathrm{V})^2(3.0 \\times 10^9 \\, \\mathrm{Hz}) = 1.545 \\, \\mathrm{W}$。\n\n后端活动因子与 IPC 成正比：$\\alpha_{\\text{BE},0} = R_0 \\alpha_u = (2.5)(0.10) = 0.25$。\n$P_{\\text{dyn,BE},0} = \\alpha_{\\text{BE},0} C_{\\text{BE}} V^2 f = (0.25)(8.0 \\times 10^{-9} \\, \\mathrm{F})(1.0 \\, \\mathrm{V})^2(3.0 \\times 10^9 \\, \\mathrm{Hz}) = 6.0 \\, \\mathrm{W}$。\n\n节流前的总功耗为：\n$P_{\\text{total},0} = P_{\\text{dyn,FE},0} + P_{\\text{dyn,BE},0} + P_{\\text{leak}} = 1.545 \\, \\mathrm{W} + 6.0 \\, \\mathrm{W} + 3.0 \\, \\mathrm{W} = 10.545 \\, \\mathrm{W}$。\n\n当 $t  0$ 时，处理器处于稳态温度 $T(0)$。稳态关系为 $T_{\\text{ss}} = T_{\\text{amb}} + P_{\\text{total}} R_{\\text{th}}$。\n$T(0) = T_{\\text{amb}} + P_{\\text{total},0} R_{\\text{th}} = 25 \\, ^{\\circ}\\mathrm{C} + (10.545 \\, \\mathrm{W})(1.0 \\, \\mathrm{K/W}) = 35.545 \\, ^{\\circ}\\mathrm{C}$。\n\n状态 1：节流后分析 ($t \\ge 0$)\n在 $t = 0$ 时，参数变为 $W_{\\text{fetch,1}} = 2$ 和 $m_1 = 0.08$。\n新的提交宽度为 $W_{c,1} = \\min(4, 2) = 2$。\n新的 IPC 为：\n$$R_1 = \\frac{W_{c,1}}{1 + W_{c,1} d m_1 B} = \\frac{2}{1 + (2)(0.20)(0.08)(15)} = \\frac{2}{1 + 0.48} = \\frac{2}{1.48} = \\frac{50}{37} \\approx 1.35135$$\n新的停顿周期比例为 $S_1 = R_1 d m_1 B = (\\frac{50}{37})(0.20)(0.08)(15) = \\frac{12}{37} \\approx 0.32432$。\n\n计算新的总功耗 $P_{\\text{total},1}$：\n$\\alpha_{\\text{FE},1} = (1 - S_1)(W_{\\text{fetch,1}} \\alpha_{\\text{slot}}) + S_1 \\alpha_{\\text{stall}} = (1 - \\frac{12}{37})(2 \\times 0.10) + (\\frac{12}{37})(0.02) = (\\frac{25}{37})(0.20) + \\frac{0.24}{37} = \\frac{5}{37} + \\frac{0.24}{37} = \\frac{5.24}{37}$。\n$P_{\\text{dyn,FE},1} = \\alpha_{\\text{FE},1} C_{\\text{FE}} V^2 f = (\\frac{5.24}{37})(2.0 \\times 10^{-9} \\, \\mathrm{F})(1.0 \\, \\mathrm{V})^2(3.0 \\times 10^9 \\, \\mathrm{Hz}) = \\frac{31.44}{37} \\, \\mathrm{W}$。\n\n$\\alpha_{\\text{BE},1} = R_1 \\alpha_u = (\\frac{50}{37})(0.10) = \\frac{5}{37}$。\n$P_{\\text{dyn,BE},1} = \\alpha_{\\text{BE},1} C_{\\text{BE}} V^2 f = (\\frac{5}{37})(8.0 \\times 10^{-9} \\, \\mathrm{F})(1.0 \\, \\mathrm{V})^2(3.0 \\times 10^9 \\, \\mathrm{Hz}) = \\frac{120}{37} \\, \\mathrm{W}$。\n\n节流后的总功耗为：\n$P_{\\text{total},1} = P_{\\text{dyn,FE},1} + P_{\\text{dyn,BE},1} + P_{\\text{leak}} = \\frac{31.44}{37} \\, \\mathrm{W} + \\frac{120}{37} \\, \\mathrm{W} + 3.0 \\, \\mathrm{W} = \\frac{151.44}{37} + 3.0 = \\frac{151.44 + 111}{37} = \\frac{262.44}{37} \\, \\mathrm{W} \\approx 7.093 \\, \\mathrm{W}$。\n\n最后，我们对瞬态热行为进行建模。该系统由以下一阶微分方程描述：\n$C_{\\text{th}} \\frac{dT}{dt} + \\frac{T(t) - T_{\\text{amb}}}{R_{\\text{th}}} = P_{\\text{total},1}$ 对于 $t \\ge 0$。\n对于初始条件 $T(0)$，该方程的解为：\n$T(t) = T_{\\text{ss},1} + (T(0) - T_{\\text{ss},1}) \\exp(-t/\\tau_{\\text{th}})$\n其中 $\\tau_{\\text{th}} = R_{\\text{th}} C_{\\text{th}}$ 是热时间常数，$T_{\\text{ss},1}$ 是新的稳态温度。\n\n新的稳态温度为：\n$T_{\\text{ss},1} = T_{\\text{amb}} + P_{\\text{total},1} R_{\\text{th}} = 25 \\, ^{\\circ}\\mathrm{C} + (\\frac{262.44}{37} \\, \\mathrm{W})(1.0 \\, \\mathrm{K/W}) = 25 + \\frac{262.44}{37} \\, ^{\\circ}\\mathrm{C} \\approx 32.093 \\, ^{\\circ}\\mathrm{C}$。\n\n热时间常数为：\n$\\tau_{\\text{th}} = R_{\\text{th}} C_{\\text{th}} = (1.0 \\, \\mathrm{K/W})(20 \\, \\mathrm{J/K}) = 20 \\, \\mathrm{s}$。\n\n现在我们可以计算在 $t = 0.50 \\, \\mathrm{s}$ 时的温度：\n$T(0.50) = T_{\\text{ss},1} + (T(0) - T_{\\text{ss},1}) \\exp(-0.50/\\tau_{\\text{th}})$\n$T(0.50) = (25 + \\frac{262.44}{37}) + \\left(35.545 - (25 + \\frac{262.44}{37})\\right) \\exp(-0.50/20)$\n$T(0.50) = (32.09297...) + (35.545 - 32.09297...) \\exp(-0.025)$\n$T(0.50) = 32.09297... + (3.452027...) \\exp(-0.025)$\n使用 $\\exp(-0.025) \\approx 0.9753099$：\n$T(0.50) \\approx 32.09297 + (3.452027)(0.9753099) \\approx 32.09297 + 3.36680 \\approx 35.45977 \\, ^{\\circ}\\mathrm{C}$。\n\n四舍五入到四位有效数字，得到 $35.46 \\, ^{\\circ}\\mathrm{C}$。", "answer": "$$\\boxed{35.46}$$", "id": "3685015"}]}