{"hands_on_practices": [{"introduction": "要理解操作系统性能，核心在于掌握进程的CPU-I/O交替执行模型。这个练习将带你从最基础的模型入手：一个单一进程在CPU和I/O设备之间循环。通过这个练习 [@problem_id:3671863]，你将学会如何利用基本的概率论知识来计算关键的性能指标——资源利用率，并由此确定系统的瓶颈所在。", "problem": "考虑一个单一的长期运行进程，该进程在中央处理器 (CPU) 突发和磁盘输入/输出 (I/O) 突发之间重复交替。设 CPU 突发持续时间是速率参数为 $\\lambda$ 的指数随机变量，独立且同分布，记为 $C_{i} \\sim \\text{Exp}(\\lambda)$。设磁盘 I/O 突发持续时间是速率参数为 $\\mu$ 的指数随机变量，独立且同分布，记为 $D_{i} \\sim \\text{Exp}(\\mu)$。该进程永不终止，在突发之间没有思考时间；它在每次 CPU 突发后立即请求磁盘 I/O，并在每次磁盘 I/O 完成后立即准备好使用 CPU。系统包含一个单一的 CPU 和一个单一的磁盘设备，两者都采用非抢占式先到先服务 (FCFS) 策略进行调度。为了比较，还考虑一种假设性情况，即两个设备都使用非抢占式最短作业优先 (SJF) 调度，并且能完美预知下一次突发的长度。\n\n仅使用利用率的基本定义（即资源处于繁忙状态的长期时间比例）以及交替突发过程的平稳性，推导以 $\\lambda$ 和 $\\mu$ 表示的稳态 CPU 利用率和磁盘利用率。说明在此单进程设置中，利用率是否受 FCFS 和 SJF 调度策略选择的影响，并解释在什么条件下 CPU 成为瓶颈，以及在什么条件下磁盘成为瓶颈，其中“瓶颈”指的是长期利用率较高的资源。无需进行数值四舍五入。将最终答案表示为一个单行矩阵，其中包含以 $\\lambda$ 和 $\\mu$ 表示的 CPU 利用率和磁盘利用率的简化符号表达式。[@problem_id:155]", "solution": "该问题陈述已经过验证，被认为是有效的。这是一个在操作系统性能分析领域内自成体系、有科学依据且定义明确的问题。它依赖于标准的随机模型和基本定义。\n\n问题的核心是为一个在 CPU 和 I/O 突发之间交替的单一、永不终止的进程确定中央处理器 (CPU) 和磁盘设备的长期利用率。\n\n设 $C_i$ 为第 $i$ 次 CPU 突发的持续时间，对于 $i=1, 2, \\dots$。问题陈述中指出，$C_i$ 是遵循速率参数为 $\\lambda$ 的指数分布的独立同分布 (i.i.d.) 随机变量。其概率密度函数为 $f_C(t) = \\lambda \\exp(-\\lambda t)$，其中 $t \\ge 0$。CPU 突发的期望值或平均持续时间由下式给出：\n$$E[C_i] = \\frac{1}{\\lambda}$$\n\n类似地，设 $D_i$ 为第 $i$ 次磁盘 I/O 突发的持续时间。这些是遵循速率参数为 $\\mu$ 的指数分布的 i.i.d. 随机变量。其概率密度函数为 $f_D(t) = \\mu \\exp(-\\mu t)$，其中 $t \\ge 0$。I/O 突发持续时间的期望值为：\n$$E[D_i] = \\frac{1}{\\mu}$$\n\n该进程执行一个连续的周期序列，每个周期由一次 CPU 突发和一次 I/O 突发组成。设 $T_{cycle, i}$ 为第 $i$ 个周期的持续时间。则 $T_{cycle, i} = C_i + D_i$。由于该过程是平稳的，我们可以分析一个平均周期内的行为。一个完整周期的期望持续时间是：\n$$E[T_{cycle}] = E[C_i + D_i] = E[C_i] + E[D_i] = \\frac{1}{\\lambda} + \\frac{1}{\\mu}$$\n这可以通过通分来简化：\n$$E[T_{cycle}] = \\frac{\\mu + \\lambda}{\\lambda\\mu}$$\n\n利用率定义为资源在长期内处于繁忙状态的时间比例。对于像这样的平稳遍历过程，长期时间平均利用率等于每个周期的期望繁忙时间与每个周期的期望总时间的比值。\n\n对于 CPU，它在每个周期 $T_{cycle, i}$ 内繁忙的持续时间为 $C_i$。因此，CPU 利用率 $U_{CPU}$ 为：\n$$U_{CPU} = \\frac{E[C_i]}{E[T_{cycle}]} = \\frac{E[C_i]}{E[C_i] + E[D_i]}$$\n代入期望值：\n$$U_{CPU} = \\frac{\\frac{1}{\\lambda}}{\\frac{1}{\\lambda} + \\frac{1}{\\mu}} = \\frac{\\frac{1}{\\lambda}}{\\frac{\\mu + \\lambda}{\\lambda\\mu}} = \\frac{1}{\\lambda} \\cdot \\frac{\\lambda\\mu}{\\lambda + \\mu} = \\frac{\\mu}{\\lambda + \\mu}$$\n\n对于磁盘设备，它在每个周期内繁忙的持续时间为 $D_i$。因为这是一个单进程系统，CPU 和磁盘永远不会同时繁忙。当 CPU 活跃时，磁盘是空闲的，反之亦然。磁盘利用率 $U_{DISK}$ 为：\n$$U_{DISK} = \\frac{E[D_i]}{E[T_{cycle}]} = \\frac{E[D_i]}{E[C_i] + E[D_i]}$$\n代入期望值：\n$$U_{DISK} = \\frac{\\frac{1}{\\mu}}{\\frac{1}{\\lambda} + \\frac{1}{\\mu}} = \\frac{\\frac{1}{\\mu}}{\\frac{\\mu + \\lambda}{\\lambda\\mu}} = \\frac{1}{\\mu} \\cdot \\frac{\\lambda\\mu}{\\lambda + \\mu} = \\frac{\\lambda}{\\lambda + \\mu}$$\n作为一致性检查，请注意 $U_{CPU} + U_{DISK} = \\frac{\\mu}{\\lambda + \\mu} + \\frac{\\lambda}{\\lambda + \\mu} = \\frac{\\lambda + \\mu}{\\lambda + \\mu} = 1$。这是符合预期的，因为该进程总是在使用 CPU 或磁盘，没有空闲或思考时间。\n\n接下来，我们必须考虑调度策略（非抢占式先到先服务 vs. 非抢占式最短作业优先）的影响。调度策略是为解决多个进程或作业竞争单一资源时的争用而设计的算法。在这个问题中，只有一个进程。当此进程需要 CPU 时，它是就绪队列中唯一的进程。当它需要磁盘时，它是磁盘队列中唯一的进程。因此，从来没有多于一个的作业可供选择。任何工作保守型调度策略，包括 FCFS 和 SJF，都会做出相同的决定：调度唯一可用的作业。因此，在这种单进程场景下，调度策略的选择对系统行为或最终的利用率没有影响。\n\n最后，我们确定瓶颈条件。瓶颈被定义为具有较高长期利用率的资源。\n如果 $U_{CPU} > U_{DISK}$，则 CPU 是瓶颈：\n$$\\frac{\\mu}{\\lambda + \\mu} > \\frac{\\lambda}{\\lambda + \\mu}$$\n由于 $\\lambda > 0$ 和 $\\mu > 0$，分母 $\\lambda + \\mu$ 是正数，所以我们可以在不等式两边同乘以它而不改变不等号方向：\n$$\\mu > \\lambda$$\n回顾 $E[C_i] = 1/\\lambda$ 和 $E[D_i] = 1/\\mu$，条件 $\\mu > \\lambda$ 等价于 $1/\\lambda > 1/\\mu$，这意味着 $E[C_i] > E[D_i]$。因此，如果 CPU 的平均服务时间（突发持续时间）大于磁盘的平均服务时间，则 CPU 是瓶颈。\n\n相反，如果 $U_{DISK} > U_{CPU}$，则磁盘是瓶颈。通过对称推理，这发生在 $\\lambda > \\mu$ 或 $E[D_i] > E[C_i]$ 的情况下。如果磁盘的平均服务时间大于 CPU 的平均服务时间，则磁盘是瓶颈。如果 $\\lambda = \\mu$，则利用率相等，系统是平衡的。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\mu}{\\lambda + \\mu} & \\frac{\\lambda}{\\lambda + \\mu} \\end{pmatrix}}$$", "id": "3671863"}, {"introduction": "在掌握了基本的CPU-I/O模型后，下一步是思考如何优化它。真实世界中的I/O操作通常包含固定的启动延迟和可变的数据传输时间。这个练习 [@problem_id:3671917] 将引导你分析一种常见的优化技术——批处理（batching），通过将多次小的I/O请求合并为一次大的请求，来摊销固定的延迟成本，从而提升系统吞吐量。", "problem": "考虑一个操作系统进程，其交替进行中央处理器 (CPU) 突发和输入/输出 (I/O) 突发。该进程重复执行一个 CPU 突发，使用内存中已有的数据进行计算，耗时 $C$ 毫秒，然后在下一次 CPU 突发开始前，发出一个阻塞式读取请求，从磁盘获取接下来的 $S$ 字节数据。对于大小为 $x$ 字节的连续读取，磁盘的服务时间模型为一个固定的寻道加旋转延迟 $L$ 毫秒与传输时间 $x/B$ 毫秒之和，其中 $B$ 是平均顺序吞吐量，单位为字节/毫秒。假设进程在每次读取期间都会阻塞，并且内存足以容纳任何预取的数据而无需额外开销。将应用程序的长期吞吐量定义为每毫秒处理的有用数据的渐进平均字节数，并假设存储是物理上现实的，即 $L>0$。\n\n现在假设该进程采用批处理方式：它不再是每次 CPU 突发后发出一次大小为 $S$ 字节的读取请求，而是连续执行 $k$ 次 CPU 突发（消耗先前获取的数据），然后在下一组 $k$ 次 CPU 突发开始前，发出一次大小为 $kS$ 字节的阻塞式读取请求。批处理通过将固定延迟分摊到更大的传输量上，从而减少了 I/O 突发的次数。\n\n仅从 CPU 和 I/O 突发的核心定义以及上述标准磁盘服务时间模型出发，推导出最小整数批处理大小 $k_{\\min}$，使得批处理产生的长期吞吐量严格高于非批处理策略。请将最终答案表示为一个不带单位的整数。", "solution": "首先对问题进行严格的验证。\n\n**步骤 1：提取已知条件**\n-   CPU 突发时间：$C$ 毫秒。\n-   每次 CPU 突发的数据大小：$S$ 字节。\n-   磁盘寻道加旋转延迟：$L$ 毫秒。\n-   磁盘顺序吞吐量：$B$ 字节/毫秒。\n-   大小为 $x$ 字节的读取的磁盘服务时间：$L + \\frac{x}{B}$ 毫秒。\n-   批处理策略：连续 $k$ 次 CPU 突发，然后进行一次大小为 $kS$ 的读取。非批处理策略对应于 $k=1$。\n-   约束条件：存储是物理上现实的，因此 $L>0$。\n-   目标：找到最小整数批处理大小 $k_{\\min}$，使得批处理的长期吞吐量严格高于非批处理策略。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题建立在操作系统研究中使用的标准、典型的模型之上。交替的 CPU 和 I/O 突发概念是进程行为的基本抽象。包含固定延迟和可变传输时间的磁盘服务时间模型，是存储设备性能公认的一阶近似。通过批处理来分摊固定开销的原理是计算机科学中的核心优化技术。该问题在科学上是合理的。\n-   **良置性**：所有变量（$C$、$S$、$L$、$B$、$k$）都有定义。性能指标（长期吞吐量）有明确的规定。目标是找到满足严格不等式的最小整数 $k_{\\min}$，这指向一个明确定义的数学问题。包含约束条件 $L>0$至关重要，它防止了退化情况并确保了有意义的解。\n-   **目标**：问题以精确、定量且无偏见的语言陈述。\n-   **完整性与一致性**：问题是自洽的，提供了推导所需的所有必要信息，没有内部矛盾。\n\n**结论：** 该问题被判定为 **有效**。这是一个良置的、有科学依据的问题，旨在测试系统性能分析中的基本概念。\n\n**求解推导**\n\n长期吞吐量，记为 $\\eta$，定义为每毫秒处理的有用数据的渐进平均字节数。我们可以通过分析一个完整的操作周期来计算它：\n$$ \\eta = \\frac{\\text{Total data processed in a cycle}}{\\text{Total time for the cycle}} $$\n\n首先，我们分析非批处理策略，它对应于批处理大小 $k=1$。在一个单周期内，进程执行一次 CPU 突发和一次 I/O 突发。\n-   CPU 突发的时间为 $C$。\n-   I/O 是一次大小为 $S$ 的读取。根据磁盘服务时间模型，这次 I/O 突发的时间为 $L + \\frac{S}{B}$。\n-   一个周期的总时间 $T_1$ 是 CPU 和 I/O 突发时间之和：\n    $$ T_1 = C + L + \\frac{S}{B} $$\n-   此周期内处理的数据量为 $S$。\n-   因此，非批处理策略的吞吐量 $\\eta_1$ 为：\n    $$ \\eta_1 = \\frac{S}{T_1} = \\frac{S}{C + L + \\frac{S}{B}} $$\n\n接下来，我们分析整数批处理大小为 $k$ 的批处理策略。该策略的一个宏周期包括 $k$ 次 CPU 突发，然后是一次更大的 I/O 突发。\n-   $k$ 次连续 CPU 突发的总时间为 $kC$。\n-   单次 I/O 是大小为 $kS$ 的读取。这次 I/O 突发的时间为 $L + \\frac{kS}{B}$。\n-   一个宏周期的总时间 $T_k$ 是总 CPU 时间和单次 I/O 时间之和：\n    $$ T_k = kC + L + \\frac{kS}{B} $$\n-   此宏周期内处理的总数据量为 $kS$。\n-   因此，批处理策略的吞吐量 $\\eta_k$ 为：\n    $$ \\eta_k = \\frac{kS}{T_k} = \\frac{kS}{kC + L + \\frac{kS}{B}} $$\n\n问题要求找到最小整数批处理大小 $k_{\\min}$，使得批处理吞吐量严格大于非批处理吞吐量。我们必须找到满足不等式 $\\eta_k > \\eta_1$ 的最小整数 $k$。非批处理情况是 $k=1$，所以我们寻找一个 $k \\ge 2$ 的解。\n\n我们建立不等式：\n$$ \\frac{kS}{kC + L + \\frac{kS}{B}} > \\frac{S}{C + L + \\frac{S}{B}} $$\n考虑到 $S$ 是以字节为单位的大小，它必须是正数 ($S>0$)。我们可以安全地将不等式两边同时除以 $S$：\n$$ \\frac{k}{kC + L + \\frac{kS}{B}} > \\frac{1}{C + L + \\frac{S}{B}} $$\n所有参数（$C$、$L$、$S$、$B$）和批处理大小 $k$ 都是正量。因此，不等式两边的分母都严格为正。我们可以进行交叉相乘而无需改变不等号方向：\n$$ k \\left( C + L + \\frac{S}{B} \\right) > 1 \\left( kC + L + \\frac{kS}{B} \\right) $$\n将左边的 $k$ 分配进去：\n$$ kC + kL + \\frac{kS}{B} > kC + L + \\frac{kS}{B} $$\n$kC$ 和 $\\frac{kS}{B}$ 这两项同时出现在不等式两边，可以通过相减消去：\n$$ kL > L $$\n问题明确指出 $L > 0$，模拟具有非零延迟的物理现实磁盘。由于 $L$ 是一个正常数，我们可以将不等式两边同时除以 $L$ 而不改变不等号方向：\n$$ k > 1 $$\n这个结果表明，任何严格大于 $1$ 的批处理大小 $k$ 都将产生比非批处理策略更高的吞吐量。问题要求满足此条件的最小*整数*批处理大小 $k_{\\min}$。满足 $k > 1$ 的整数集合是 $\\{2, 3, 4, \\dots\\}$。这个集合中最小的整数是 $2$。\n因此，能严格提高吞吐量的最小整数批处理大小是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3671917"}, {"introduction": "单个进程的行为模型是基础，但真实系统通常同时运行多个进程，它们会为共享资源而竞争。这个高级练习 [@problem_id:3671871] 将带你进入多进程环境，使用排队论中的闭合网络模型来分析系统性能。你将学习如何量化多道程序水平（即并发进程数）对系统吞吐量和响应时间的影响，并据此进行系统容量规划以满足服务质量（QoS）要求。", "problem": "一个计算机系统运行着一个由 $N$ 个相同进程组成的封闭式工作负载，这些进程在一次中央处理器（CPU）突发和一次磁盘输入/输出（I/O）操作之间交替进行。CPU和磁盘每次都使用先来先服务（FCFS）调度来服务一个请求，其服务时间是独立同分布的指数分布。平均CPU突发时间为 $4 \\, \\mathrm{ms}$，平均磁盘服务时间为 $6 \\, \\mathrm{ms}$。上下文切换开销和思考时间可以忽略不计。每个进程在每个周期内重复地访问CPU一次，然后访问磁盘一次。\n\n令 $I$ 表示磁盘I/O请求的稳态响应时间（等待时间加服务时间）。您的任务是选择多道程序设计级别 $N$（即驻留进程的最大数量），以使磁盘I/O响应时间超过给定阈值 $T$ 的概率满足\n$\n\\Pr(I > T) \\le \\epsilon.\n$\n取 $T = 0.20 \\, \\mathrm{s}$ 和 $\\epsilon = 0.10$。\n\n仅从排队论中关于指数服务队列和闭合积形式网络的核心定义和经过充分检验的结果出发，推导这对磁盘在稳态下的有效到达率施加的约束，将该速率与作为 $N$ 的函数的系统吞吐量联系起来，并确定使该不等式成立的最大整数值 $N$。在您的推导中，通过用系统吞脱量和CPU服务参数来表示，明确地将您选择的规模与所选 $N$ 下的CPU空闲概率联系起来，并计算在该 $N$ 下的数值（最终答案只报告 $N$）。\n\n将您的最终答案表示为满足要求的单个整数 $N_{\\max}$。除了精确的整数选择外，不需要进行四舍五入。时间必须以秒为单位处理，但最终答案是无量纲的。", "solution": "该问题描述了一个闭合排队网络，其中有固定数量的 $N$ 个进程在两个服务中心之间循环：一个CPU和一个磁盘。两个中心都是单服务器队列（$m=1$），采用先来先服务（FCFS）规则，且服务时间呈指数分布。该系统是Gordon-Newell或闭合Jackson排队网络的经典例子。\n\n给定的参数是：\n平均CPU服务时间，$S_{CPU} = 4 \\, \\mathrm{ms} = 0.004 \\, \\mathrm{s}$。\n平均磁盘服务时间，$S_{disk} = 6 \\, \\mathrm{ms} = 0.006 \\, \\mathrm{s}$。\n服务速率是平均服务时间的倒数：\nCPU服务速率，$\\mu_{CPU} = 1/S_{CPU} = 1/0.004 \\, \\mathrm{s}^{-1} = 250 \\, \\mathrm{s}^{-1}$。\n磁盘服务速率，$\\mu_{disk} = 1/S_{disk} = 1/0.006 \\, \\mathrm{s}^{-1} = \\frac{500}{3} \\, \\mathrm{s}^{-1} \\approx 166.67 \\, \\mathrm{s}^{-1}$。\n\n目标是找到最大的整数多道程序设计级别 $N$，使得磁盘I/O响应时间 $I$ 超过阈值 $T = 0.20 \\, \\mathrm{s}$ 的概率不超过 $\\epsilon = 0.10$。即 $\\Pr(I > T) \\le \\epsilon$。\n\n首先，我们分析磁盘I/O子系统。对于一个积形式闭合排队网络中的节点，例如本系统中的磁盘，其稳态响应时间分布等同于一个M/M/1队列的响应时间分布。这个等效队列的到达率 $\\lambda$ 是系统的稳态吞吐量，我们记为 $X(N)$，服务速率为 $\\mu_{disk}$。对于M/M/1队列，响应时间 $I$ 服从参数为 $\\mu_{disk} - X(N)$ 的指数分布。其概率密度函数为 $f(t) = (\\mu_{disk}-X(N))\\exp(-(\\mu_{disk}-X(N))t)$，对于 $t \\ge 0$。\n\n累积分布函数为 $\\Pr(I \\le t) = 1 - \\exp(-(\\mu_{disk}-X(N))t)$，所以互补累积分布函数（生存函数）为：\n$$\n\\Pr(I > t) = \\exp(-(\\mu_{disk} - X(N))t)\n$$\n这个结果对于一个稳定队列是有效的，这要求到达率小于服务速率，即 $X(N)  \\mu_{disk}$。\n\n问题施加了约束 $\\Pr(I  T) \\le \\epsilon$。代入生存函数的表达式以及给定的 $T$ 和 $\\epsilon$ 值：\n$$\n\\exp(-(\\mu_{disk} - X(N))T) \\le \\epsilon\n$$\n为了找到对系统吞吐量 $X(N)$ 的约束，我们解这个不等式。对两边取自然对数（这是一个单调递增函数，因此保持不等式方向）：\n$$\n-(\\mu_{disk} - X(N))T \\le \\ln(\\epsilon)\n$$\n两边除以 $-T$（一个负数），不等式方向反转：\n$$\n\\mu_{disk} - X(N) \\ge -\\frac{\\ln(\\epsilon)}{T}\n$$\n整理以分离出 $X(N)$，我们得到系统吞吐量的上限，这也是磁盘的有效到达率：\n$$\nX(N) \\le \\mu_{disk} + \\frac{\\ln(\\epsilon)}{T}\n$$\n这就是对磁盘有效到达率推导出的约束。让我们计算这个最大允许吞吐量 $X_{max}$。\n$$\nX_{max} = \\frac{1}{S_{disk}} + \\frac{\\ln(\\epsilon)}{T} = \\frac{1}{0.006 \\, \\mathrm{s}} + \\frac{\\ln(0.10)}{0.20 \\, \\mathrm{s}}\n$$\n$$\nX_{max} \\approx 166.667 \\, \\mathrm{s}^{-1} + \\frac{-2.302585}{0.20} \\, \\mathrm{s}^{-1} \\approx 166.667 \\, \\mathrm{s}^{-1} - 11.513 \\, \\mathrm{s}^{-1} \\approx 155.154 \\, \\mathrm{s}^{-1}\n$$\n所以，我们必须找到最大的整数 $N$，使得 $X(N) \\le 155.154 \\, \\mathrm{s}^{-1}$。\n\n接下来，我们建立多道程序设计级别 $N$ 和系统吞吐量 $X(N)$ 之间的关系。我们使用平均值分析（Mean Value Analysis, MVA）算法，这是一种用于求解闭合排队网络的迭代方法。MVA算法基于到达定理和利特尔法则（Little's Law）。它根据具有 $n-1$ 个体的系统的性能指标来计算具有 $n$ 个个体的系统的性能指标。\n\n对于这个双节点系统，MVA的递推关系是：\n1. 每个节点 $i \\in \\{\\text{CPU, disk}\\}$ 的平均响应时间：$R_i(n) = S_i (1 + Q_i(n-1))$\n2. 系统吞吐量：$X(n) = \\frac{n}{R_{CPU}(n) + R_{disk}(n)}$\n3. 每个节点 $i$ 的平均队列长度：$Q_i(n) = X(n) R_i(n)$\n\n迭代从初始条件 $Q_{CPU}(0) = 0$ 和 $Q_{disk}(0) = 0$ 开始。我们计算 $X(n)$，对于 $n=1, 2, 3, \\ldots$，直到 $X(n)$ 超过 $X_{max}$ 时停止。\n\n对于 $n=1$:\n$R_{CPU}(1) = S_{CPU}(1+Q_{CPU}(0)) = 0.004(1+0) = 0.004 \\, \\mathrm{s}$\n$R_{disk}(1) = S_{disk}(1+Q_{disk}(0)) = 0.006(1+0) = 0.006 \\, \\mathrm{s}$\n$X(1) = \\frac{1}{R_{CPU}(1) + R_{disk}(1)} = \\frac{1}{0.004 + 0.006} = \\frac{1}{0.01} = 100 \\, \\mathrm{s}^{-1}$。\n$X(1) = 100 \\le 155.154$，所以 $N \\ge 1$。\n$Q_{CPU}(1) = X(1)R_{CPU}(1) = 100 \\times 0.004 = 0.4$\n$Q_{disk}(1) = X(1)R_{disk}(1) = 100 \\times 0.006 = 0.6$\n\n对于 $n=2$:\n$R_{CPU}(2) = S_{CPU}(1+Q_{CPU}(1)) = 0.004(1+0.4) = 0.0056 \\, \\mathrm{s}$\n$R_{disk}(2) = S_{disk}(1+Q_{disk}(1)) = 0.006(1+0.6) = 0.0096 \\, \\mathrm{s}$\n$X(2) = \\frac{2}{0.0056 + 0.0096} = \\frac{2}{0.0152} \\approx 131.579 \\, \\mathrm{s}^{-1}$。\n$X(2) \\approx 131.579 \\le 155.154$，所以 $N \\ge 2$。\n$Q_{CPU}(2) = X(2)R_{CPU}(2) \\approx 131.579 \\times 0.0056 \\approx 0.7368$\n$Q_{disk}(2) = X(2)R_{disk}(2) \\approx 131.579 \\times 0.0096 \\approx 1.2632$\n\n对于 $n=3$:\n$R_{CPU}(3) = S_{CPU}(1+Q_{CPU}(2)) = 0.004(1+0.7368) = 0.0069472 \\, \\mathrm{s}$\n$R_{disk}(3) = S_{disk}(1+Q_{disk}(2)) = 0.006(1+1.2632) = 0.0135792 \\, \\mathrm{s}$\n$X(3) = \\frac{3}{0.0069472 + 0.0135792} = \\frac{3}{0.0205264} \\approx 146.154 \\, \\mathrm{s}^{-1}$。\n$X(3) \\approx 146.154 \\le 155.154$，所以 $N \\ge 3$。\n$Q_{CPU}(3) = X(3)R_{CPU}(3) \\approx 146.154 \\times 0.0069472 \\approx 1.0154$\n$Q_{disk}(3) = X(3)R_{disk}(3) \\approx 146.154 \\times 0.0135792 \\approx 1.9846$\n\n对于 $n=4$:\n$R_{CPU}(4) = S_{CPU}(1+Q_{CPU}(3)) = 0.004(1+1.0154) = 0.0080616 \\, \\mathrm{s}$\n$R_{disk}(4) = S_{disk}(1+Q_{disk}(3)) = 0.006(1+1.9846) = 0.0179076 \\, \\mathrm{s}$\n$X(4) = \\frac{4}{0.0080616 + 0.0179076} = \\frac{4}{0.0259692} \\approx 154.028 \\, \\mathrm{s}^{-1}$。\n$X(4) \\approx 154.028 \\le 155.154$，所以 $N \\ge 4$。\n$Q_{CPU}(4) = X(4)R_{CPU}(4) \\approx 154.028 \\times 0.0080616 \\approx 1.2416$\n$Q_{disk}(4) = X(4)R_{disk}(4) \\approx 154.028 \\times 0.0179076 \\approx 2.7584$\n\n对于 $n=5$:\n$R_{CPU}(5) = S_{CPU}(1+Q_{CPU}(4)) = 0.004(1+1.2416) = 0.0089664 \\, \\mathrm{s}$\n$R_{disk}(5) = S_{disk}(1+Q_{disk}(4)) = 0.006(1+2.7584) = 0.0225504 \\, \\mathrm{s}$\n$X(5) = \\frac{5}{0.0089664 + 0.0225504} = \\frac{5}{0.0315168} \\approx 158.644 \\, \\mathrm{s}^{-1}$。\n$X(5) \\approx 158.644  155.154$。\n对于 $N=5$，该条件被违反。因此，满足不等式的最大整数值 $N$ 是 4。\n\n最后，按照要求，我们将 $N=4$ 的选择与CPU空闲概率联系起来。CPU的利用率 $U_{CPU}(N)$ 是其繁忙时间的比例。根据利用率法则，它是系统吞吐量和平均服务时间的乘积：\n$$\nU_{CPU}(N) = X(N) \\cdot S_{CPU}\n$$\nCPU的空闲概率 $P_{idle, CPU}(N)$ 是其利用率的补集：\n$$\nP_{idle, CPU}(N) = 1 - U_{CPU}(N) = 1 - X(N) \\cdot S_{CPU}\n$$\n此表达式将CPU空闲概率与系统吞吐量和服务参数联系起来。对于我们选择的 $N=4$ 值，我们计算此概率：\n$$\nP_{idle, CPU}(4) = 1 - X(4)S_{CPU} \\approx 1 - (154.028 \\, \\mathrm{s}^{-1})(0.004 \\, \\mathrm{s}) \\approx 1 - 0.6161 = 0.3839\n$$\n这证实了在最大允许的多道程序设计级别下，CPU大约有 $38.4\\%$ 的时间是空闲的。瓶颈设备是磁盘，因为它的服务时间更长。在 $N=4$ 时，磁盘的利用率是 $U_{disk}(4) = X(4)S_{disk} \\approx 154.028 \\times 0.006 = 0.9242$，这个值要高得多。\n\n最终答案是满足要求的最大整数 $N$。", "answer": "$$\n\\boxed{4}\n$$", "id": "3671871"}]}