{"hands_on_practices": [{"introduction": "掌握谐振腔理论的第一步是能够从麦克斯韦方程等基本原理出发，推导出特定模式的电磁场分布。本练习将引导你完成这一基本功，计算一个矩形腔中特定 $\\mathrm{TE}$ 模式的场，并对其进行归一化，使得腔内存储的总能量为一个单位焦耳。通过这个过程，你不仅能加深对场分布数学形式的理解，还能将其与能量这个物理量直接联系起来 [@problem_id:3292037]。", "problem": "考虑一个理想电导体矩形谐振腔，其尺寸沿 $x$、$y$ 和 $z$ 轴分别为 $a$、$b$ 和 $d$。腔内填充有均匀、各向同性、无损耗的介质，其介电常数为 $\\epsilon=\\epsilon_{0}\\epsilon_{r}$，磁导率为 $\\mu=\\mu_{0}\\mu_{r}$，其中 $\\epsilon_{0}$ 和 $\\mu_{0}$ 分别为自由空间的介电常数和磁导率，$\\epsilon_{r}$ 和 $\\mu_{r}$ 分别为相对介电常数和相对磁导率。假设场为时间谐波场，采用相量表示法 $e^{j\\omega t}$。\n\n关注相对于 $z$ 轴的横电模式（$\\mathrm{TE}^{z}$），特别是 $\\mathrm{TE}_{101}$ 模式，其在可分离的本征函数标记中具有 $m=1$，$n=0$，$p=1$。使用麦克斯韦方程组和理想电导体（PEC）的边界条件，从第一性原理出发，推导与 $\\mathrm{TE}_{101}$ 模式一致的场分布，并计算归一化常数。该常数定义为纵向磁场分量 $H_{z}$ 的实数振幅 $H_{0}$，使得存储在腔内的总时间平均电磁能量恰好为 $1$ 焦耳。\n\n设谐振腔尺寸和介质参数为\n$a = 0.30~\\mathrm{m}$，$b = 0.20~\\mathrm{m}$，$d = 0.25~\\mathrm{m}$，$\\epsilon_{r} = 2.30$ 和 $\\mu_{r} = 1.00$。\n\n你的最终答案必须是归一化常数 $H_{0}$ 的单一数值，以 $\\mathrm{A/m}$ 为单位表示。将你的答案四舍五入到三位有效数字。", "solution": "该问题要求推导矩形谐振腔中 $\\mathrm{TE}_{101}^{z}$ 模式的归一化常数 $H_{0}$，使得总时间平均储能为 $1$ 焦耳。推导过程必须从第一性原理出发。\n\n我们从无源（$\\vec{J}=\\vec{0}$，$\\rho=0$）、均匀、各向同性、无损耗介质中的时间谐波形式的麦克斯韦方程组开始：\n$$ \\nabla \\times \\vec{E} = -j\\omega\\mu\\vec{H} $$\n$$ \\nabla \\times \\vec{H} = j\\omega\\epsilon\\vec{E} $$\n$$ \\nabla \\cdot \\vec{E} = 0 $$\n$$ \\nabla \\cdot \\vec{H} = 0 $$\n其中 $\\epsilon$ 是介电常数，$\\mu$ 是磁导率，$\\omega$ 是角频率。\n\n对第一个方程取旋度，并代入第二个方程，我们推导出电场 $\\vec{E}$ 的矢量亥姆霍兹方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = -j\\omega\\mu (\\nabla \\times \\vec{H}) = -j\\omega\\mu (j\\omega\\epsilon\\vec{E}) = \\omega^2\\mu\\epsilon\\vec{E} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2\\vec{E}$ 和条件 $\\nabla \\cdot \\vec{E} = 0$，我们得到：\n$$ \\nabla^2\\vec{E} + k^2\\vec{E} = \\vec{0} $$\n其中 $k^2 = \\omega^2\\mu\\epsilon$。类似的推导可以得到磁场 $\\vec{H}$ 的相同亥姆霍兹方程：\n$$ \\nabla^2\\vec{H} + k^2\\vec{H} = \\vec{0} $$\n\n对于相对于 $z$ 轴的横电模式（$\\mathrm{TE}^{z}$），电场在 $z$ 方向上没有分量，即 $E_z = 0$。因此，求解纵向磁场分量 $H_z$ 会很方便，它必须满足标量亥姆霍兹方程：\n$$ (\\nabla^2 + k^2) H_z = 0 $$\n我们使用分离变量法求解此偏微分方程，假设 $H_z(x, y, z) = X(x)Y(y)Z(z)$。将其代入方程得到：\n$$ \\frac{1}{X}\\frac{d^2X}{dx^2} + \\frac{1}{Y}\\frac{d^2Y}{dy^2} + \\frac{1}{Z}\\frac{d^2Z}{dz^2} + k^2 = 0 $$\n该方程可分离为三个常微分方程，分离条件为 $k_x^2 + k_y^2 + k_z^2 = k^2$：\n$$ \\frac{d^2X}{dx^2} + k_x^2 X = 0, \\quad \\frac{d^2Y}{dy^2} + k_y^2 Y = 0, \\quad \\frac{d^2Z}{dz^2} + k_z^2 Z = 0 $$\n\n谐振腔由位于 $x \\in \\{0, a\\}$、$y \\in \\{0, b\\}$ 和 $z \\in \\{0, d\\}$ 的理想电导体（PEC）壁界定。边界条件是切向电场分量和法向磁场分量在表面上必须为零。对于 TE$^{z}$ 模式，$H_z$ 的边界条件是 Neumann 条件，即法向导数在切向壁上为零，而 $E_z=0$ 的边界条件是 Dirichlet 条件。\n- 对于 $X(x)=A_x\\cos(k_x x)+B_x\\sin(k_x x)$：$\\frac{dX}{dx}|_{x=0}=0 \\Rightarrow B_x=0$。然后 $\\frac{dX}{dx}|_{x=a}=0 \\Rightarrow \\sin(k_x a)=0$，因此 $k_x = \\frac{m\\pi}{a}$，其中 $m=0, 1, 2, \\ldots$。\n- 对于 $Y(y)=A_y\\cos(k_y y)+B_y\\sin(k_y y)$：$\\frac{dY}{dy}|_{y=0}=0 \\Rightarrow B_y=0$。然后 $\\frac{dY}{dy}|_{y=b}=0 \\Rightarrow \\sin(k_y b)=0$，因此 $k_y = \\frac{n\\pi}{b}$，其中 $n=0, 1, 2, \\ldots$。\n- 对于 $Z(z)=A_z\\cos(k_z z)+B_z\\sin(k_z z)$：$E_x, E_y \\propto \\sin(k_z z)$ 必须在 $z=0, d$ 为零，这意味着 $Z(0)=Z(d)=0$。因此 $A_z=0$ 和 $\\sin(k_z d)=0$，所以 $k_z = \\frac{p\\pi}{d}$，其中 $p=1, 2, 3, \\ldots$。\n\n综合这些，一般 $\\mathrm{TE}_{mnp}^{z}$ 模式的 $H_z$ 解为：\n$$ H_z(x, y, z) = H_0 \\cos\\left(\\frac{m\\pi x}{a}\\right) \\cos\\left(\\frac{n\\pi y}{b}\\right) \\sin\\left(\\frac{p\\pi z}{d}\\right) $$\n其中 $H_0$ 是振幅。问题指定了 $\\mathrm{TE}_{101}$ 模式，因此我们有 $m=1$，$n=0$ 和 $p=1$。\n$$ k_x = \\frac{\\pi}{a}, \\quad k_y = 0, \\quad k_z = \\frac{\\pi}{d} $$\n纵向磁场分量为：\n$$ H_z(x, y, z) = H_0 \\cos\\left(\\frac{\\pi x}{a}\\right) \\sin\\left(\\frac{\\pi z}{d}\\right) $$\n\n其他场分量可从 $H_z$ 和麦克斯韦方程组导出。对于 $\\mathrm{TE}_{101}$ 模式，场不随 $y$ 变化。根据 $\\nabla \\cdot \\vec{H} = 0$，我们有 $\\frac{\\partial H_x}{\\partial x} = -\\frac{\\partial H_z}{\\partial z}$。对 $x$ 积分可得 $H_x$。根据 $\\nabla \\times \\vec{H} = j\\omega\\epsilon\\vec{E}$，可得 $E_y = \\frac{1}{j\\omega\\epsilon}(\\frac{\\partial H_x}{\\partial z} - \\frac{\\partial H_z}{\\partial x})$。计算可得非零场分量为：\n$$ H_x = -H_0 \\frac{a}{d} \\sin\\left(\\frac{\\pi x}{a}\\right) \\cos\\left(\\frac{\\pi z}{d}\\right) $$\n$$ H_z = H_0 \\cos\\left(\\frac{\\pi x}{a}\\right) \\sin\\left(\\frac{\\pi z}{d}\\right) $$\n$$ E_y = \\frac{j\\omega\\mu a}{\\pi} H_0 \\sin\\left(\\frac{\\pi x}{a}\\right) \\sin\\left(\\frac{\\pi z}{d}\\right) $$\n所有其他分量（$H_y, E_x, E_z$）均为零。\n\n存储在腔内的总时间平均电磁能量 $W$ 是时间平均电能 $W_e$ 和磁能 $W_m$ 的总和。在无损耗谐振腔中，在谐振时有 $W_e = W_m$。\n$$ W_e = \\frac{\\epsilon}{4}\\int_V |\\vec{E}|^2 dV, \\quad W_m = \\frac{\\mu}{4}\\int_V |\\vec{H}|^2 dV $$\n总能量 $W = W_e + W_m = 2 W_m$。我们来计算 $W_m$：\n$$ |\\vec{H}|^2 = |H_x|^2 + |H_z|^2 = \\left(H_0 \\frac{a}{d}\\right)^2 \\sin^2\\left(\\frac{\\pi x}{a}\\right) \\cos^2\\left(\\frac{\\pi z}{d}\\right) + H_0^2 \\cos^2\\left(\\frac{\\pi x}{a}\\right) \\sin^2\\left(\\frac{\\pi z}{d}\\right) $$\n$$ W_m = \\frac{\\mu}{4} \\int_0^d \\int_0^b \\int_0^a H_0^2 \\left[ \\frac{a^2}{d^2} \\sin^2\\left(\\frac{\\pi x}{a}\\right) \\cos^2\\left(\\frac{\\pi z}{d}\\right) + \\cos^2\\left(\\frac{\\pi x}{a}\\right) \\sin^2\\left(\\frac{\\pi z}{d}\\right) \\right] dx dy dz $$\n被积函数与 $y$ 无关，因此对 $y$ 的积分得到一个因子 $b$。我们使用积分恒等式 $\\int_0^L \\sin^2(\\frac{k\\pi u}{L}) du = \\int_0^L \\cos^2(\\frac{k\\pi u}{L}) du = \\frac{L}{2}$，其中整数 $k \\ge 1$。\n$$ \\int_0^a \\sin^2\\left(\\frac{\\pi x}{a}\\right)dx = \\frac{a}{2}, \\quad \\int_0^a \\cos^2\\left(\\frac{\\pi x}{a}\\right)dx = \\frac{a}{2} $$\n$$ \\int_0^d \\sin^2\\left(\\frac{\\pi z}{d}\\right)dz = \\frac{d}{2}, \\quad \\int_0^d \\cos^2\\left(\\frac{\\pi z}{d}\\right)dz = \\frac{d}{2} $$\n$W_m$ 的积分部分变为：\n$$ \\int_0^d \\int_0^a [\\dots] dxdz = \\frac{a^2}{d^2} \\left(\\frac{a}{2}\\right)\\left(\\frac{d}{2}\\right) + \\left(\\frac{a}{2}\\right)\\left(\\frac{d}{2}\\right) = \\frac{a^3}{4d} + \\frac{ad}{4} = \\frac{a(a^2+d^2)}{4d} $$\n因此，时间平均磁能为：\n$$ W_m = \\frac{\\mu b H_0^2}{4} \\left[ \\frac{a(a^2+d^2)}{4d} \\right] = \\frac{\\mu a b H_0^2 (a^2+d^2)}{16d} $$\n总储能为 $W = 2 W_m$：\n$$ W = \\frac{\\mu a b H_0^2 (a^2+d^2)}{8d} $$\n给定条件是 $W=1$ 焦耳。我们求解 $H_0$：\n$$ H_0^2 = \\frac{8d}{\\mu a b (a^2+d^2)} $$\n$$ H_0 = \\sqrt{\\frac{8d}{\\mu a b (a^2+d^2)}} $$\n\n现在，我们代入给定的数值：\n$a = 0.30~\\mathrm{m}$，$b = 0.20~\\mathrm{m}$，$d = 0.25~\\mathrm{m}$，$\\mu_r = 1.00$。\n磁导率为 $\\mu = \\mu_r \\mu_0 = 1.00 \\times 4\\pi \\times 10^{-7}~\\mathrm{H/m}$。\n$$ H_0 = \\sqrt{\\frac{8(0.25)}{(4\\pi \\times 10^{-7})(0.30)(0.20)\\left((0.30)^2 + (0.25)^2\\right)}} $$\n$$ H_0 = \\sqrt{\\frac{2.0}{(4\\pi \\times 10^{-7})(0.06)(0.09 + 0.0625)}} $$\n$$ H_0 = \\sqrt{\\frac{2.0}{(4\\pi \\times 10^{-7})(0.06)(0.1525)}} $$\n$$ H_0 = \\sqrt{\\frac{2.0}{(4\\pi \\times 10^{-7})(0.00915)}} $$\n$$ H_0 = \\sqrt{\\frac{2.0}{1.149849... \\times 10^{-8}}} $$\n$$ H_0 = \\sqrt{173933550.9...} $$\n$$ H_0 \\approx 13188.387~\\mathrm{A/m} $$\n四舍五入到三位有效数字，我们得到：\n$$ H_0 \\approx 1.32 \\times 10^4~\\mathrm{A/m} $$\n请注意，$\\epsilon_r$ 的值是不需要的，因为归一化是基于磁场和总能量关系 $W=2W_m$。在基于无损耗谐振腔磁场进行的推导中，这是一个预料之中的结果。", "answer": "$$ \\boxed{1.32 \\times 10^{4}} $$", "id": "3292037"}, {"introduction": "在理解了单个谐振模式的特性后，下一个自然而然的步骤是探索不同模式之间的关系，即谐振谱的结构。本练习聚焦于一个核心概念：对称性及其对模式简并的影响。你将分析当谐振腔具有几何对称性（例如，底面为正方形）时，为何不同的模式（如 $\\mathrm{TE}_{mnp}$ 和 $\\mathrm{TE}_{nmp}$）会具有完全相同的谐振频率，并学习如何量化这种简并度 [@problem_id:3291968]。", "problem": "一个内部尺寸为 $a$、$b$ 和 $d$ 的矩形理想电导体（PEC）腔体中充满了介电常数为 $\\varepsilon$、磁导率为 $\\mu$ 的均匀、各向同性、无损耗介质。考虑角频率为 $\\omega$ 的无源、时谐电磁场，并设波数为 $k=\\omega\\sqrt{\\mu\\varepsilon}$。PEC 边界条件强制要求电场的切向分量在每个导电壁上都为零。从麦克斯韦方程组和 PEC 边界条件出发，电磁谐振问题简化为腔体体积上的一个矢量亥姆霍兹特征值问题。使用与 PEC 边界条件一致的分离变量法，本征场可以展开为沿 $x$、$y$ 和 $z$ 坐标的正弦函数乘积，其整数索引强制满足在 $x=0$、$x=a$、$y=0$、$y=b$、$z=0$ 和 $z=d$ 处的边界条件。将注意力限制在驻波腔模族上，其可分离的标量因子在所有六个壁上都为零，因此相应的三个整数索引满足 $m\\in\\mathbb{N}$、$n\\in\\mathbb{N}$ 和 $p\\in\\mathbb{N}$。\n\n从所述基本定律和边界条件出发，推导允许的波数的谐振特征值关系，并说明谐振频率如何依赖于三元组 $(m,n,p)$。然后，施加几何对称条件 $a=b$，并根据具有 PEC 边界条件的拉普拉斯算子的谱，严格解释交换索引 $m$ 和 $n$ 是否会改变谐振频率。基于该推理，量化指定模式族仅由 $a=b$ 对称性引起的简并度 $g(m,n,p)$。您的最终答案必须是仅用 $m$ 和 $n$ 表示的 $g(m,n,p)$ 的单个闭式解析表达式。不需要四舍五入，最终表达式中不包含任何单位。", "solution": "该问题要求推导矩形理想电导体（PEC）腔体的谐振频率关系，并分析在几何对称条件下特定模式的简并性。\n\n首先，我们从基本原理推导谐振频率关系。在无源（$\\vec{J}=\\vec{0}$，$\\rho=0$）、均匀、各向同性、无损耗的介质中，角频率为 $\\omega$ 的时谐场的麦克斯韦方程组为：\n$$ \\nabla \\times \\vec{E} = -j\\omega\\mu\\vec{H} $$\n$$ \\nabla \\times \\vec{H} = j\\omega\\varepsilon\\vec{E} $$\n$$ \\nabla \\cdot \\vec{E} = 0 $$\n$$ \\nabla \\cdot \\vec{H} = 0 $$\n对第一个方程取旋度，并代入第二个方程，我们得到电场 $\\vec{E}$ 的矢量亥姆霍兹方程：\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2\\vec{E} = -j\\omega\\mu(\\nabla \\times \\vec{H}) = \\omega^2\\mu\\varepsilon\\vec{E} $$\n鉴于 $\\nabla \\cdot \\vec{E} = 0$，方程简化为：\n$$ \\nabla^2\\vec{E} + k^2\\vec{E} = \\vec{0} $$\n其中 $k^2 = \\omega^2\\mu\\varepsilon$ 是波数的平方。电场的每个笛卡尔分量，例如 $E_x$，都必须满足标量亥姆霍兹方程：\n$$ (\\nabla^2 + k^2)\\psi = 0 $$\n其中 $\\psi$ 可以代表任何场分量。问题陈述本征场可以展开为正弦函数的乘积，并且我们只考虑那些可分离标量因子在腔体六个壁（由 $x \\in [0, a]$、$y \\in [0, b]$ 和 $z \\in [0, d]$ 定义）上都为零的模式。这等同于求解在腔体壁上具有齐次狄利克雷边界条件的标量亥姆霍兹方程。\n\n我们使用分离变量法，假设解的形式为 $\\psi(x, y, z) = X(x)Y(y)Z(z)$。将其代入标量亥姆霍兹方程并除以 $\\psi$ 可得：\n$$ \\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\frac{1}{Z(z)}\\frac{d^2Z}{dz^2} = -k^2 $$\n每一项都必须是常数，因此我们定义分离常数 $-k_x^2$、$-k_y^2$ 和 $-k_z^2$：\n$$ \\frac{d^2X}{dx^2} = -k_x^2 X(x), \\quad \\frac{d^2Y}{dy^2} = -k_y^2 Y(y), \\quad \\frac{d^2Z}{dz^2} = -k_z^2 Z(z) $$\n约束条件为 $k_x^2 + k_y^2 + k_z^2 = k^2$。\n\n标量因子在壁上为零的边界条件意味着：\n$X(0) = X(a) = 0$，$Y(0) = Y(b) = 0$，以及 $Z(0) = Z(d) = 0$。\n$X(x)$ 的通解是 $X(x) = C_1 \\cos(k_x x) + C_2 \\sin(k_x x)$。条件 $X(0)=0$ 意味着 $C_1=0$。对于非平凡解（$C_2 \\neq 0$），条件 $X(a)=0$ 要求 $\\sin(k_x a) = 0$，这意味着 $k_x a = m\\pi$，其中 $m$ 是某个整数。问题规定 $m \\in \\mathbb{N} = \\{1, 2, 3, \\dots\\}$，这确保了非平凡的正弦形状。因此，$k_x$ 的允许值为 $k_x = \\frac{m\\pi}{a}$。\n同理，在 $y$ 和 $z$ 方向上应用边界条件可得：\n$k_y = \\frac{n\\pi}{b}$，其中 $n \\in \\mathbb{N}$。\n$k_z = \\frac{p\\pi}{d}$，其中 $p \\in \\mathbb{N}$。\n\n将这些量子化的波数代入分离约束条件，得到允许的波数平方 $k_{mnp}^2$ 的谐振特征值关系：\n$$ k_{mnp}^2 = \\left(\\frac{m\\pi}{a}\\right)^2 + \\left(\\frac{n\\pi}{b}\\right)^2 + \\left(\\frac{p\\pi}{d}\\right)^2 = \\pi^2 \\left( \\frac{m^2}{a^2} + \\frac{n^2}{b^2} + \\frac{p^2}{d^2} \\right) $$\n谐振角频率为 $\\omega_{mnp} = k_{mnp}/\\sqrt{\\mu\\varepsilon}$。相应的谐振频率 $f_{mnp} = \\omega_{mnp}/(2\\pi)$ 为：\n$$ f_{mnp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\left(\\frac{m}{a}\\right)^2 + \\left(\\frac{n}{b}\\right)^2 + \\left(\\frac{p}{d}\\right)^2 } $$\n该表达式显示了谐振频率对模式索引三元组 $(m, n, p)$ 和腔体尺寸的依赖关系。\n\n接下来，我们施加几何对称条件 $a=b$。频率表达式变为：\n$$ f_{mnp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\frac{m^2+n^2}{a^2} + \\frac{p^2}{d^2} } $$\n为了确定交换索引 $m$ 和 $n$ 是否会改变谐振频率，我们计算 $f_{nmp}$：\n$$ f_{nmp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\frac{n^2+m^2}{a^2} + \\frac{p^2}{d^2} } $$\n由于 $m^2+n^2 = n^2+m^2$，显然有 $f_{mnp} = f_{nmp}$。因此，当 $a=b$ 时，交换索引 $m$ 和 $n$ 不会改变谐振频率。\n\n这种现象是拉普拉斯算子谱对称性的直接结果。谐振频率由带有狄利克雷边界条件的负拉普拉斯算子 $-\\nabla^2$ 的特征值决定。特征值为 $\\lambda_{mnp} = k_{mnp}^2$。当 $a=b$ 时，算子的定义域（腔体）关于 $x$ 和 $y$ 坐标的交换是对称的。这种几何对称性意味着算子的谱也必须在此交换下保持不变。模式 $(m,n,p)$ 和 $(n,m,p)$ 的特征值分别为 $\\lambda_{mnp} = \\pi^2(\\frac{m^2+n^2}{a^2} + \\frac{p^2}{d^2})$ 和 $\\lambda_{nmp} = \\pi^2(\\frac{n^2+m^2}{a^2} + \\frac{p^2}{d^2})$，它们是相同的。如果 $m \\neq n$，对应的本征函数（例如 $\\sin(\\frac{m\\pi x}{a})\\sin(\\frac{n\\pi y}{a})\\sin(\\frac{p\\pi z}{d})$ 和 $\\sin(\\frac{n\\pi x}{a})\\sin(\\frac{m\\pi y}{a})\\sin(\\frac{p\\pi z}{d})$）是不同的。同一特征值存在多个不同本征函数的现象称为简并。\n\n最后，我们量化仅由这种 $a=b$ 对称性产生的简并度 $g(m,n,p)$。该简并度仅取决于索引 $m$ 和 $n$，因为索引 $p$ 不受 $x \\leftrightarrow y$ 对称性的影响。我们考虑给定模式 $(m, n, p)$ 的两种情况：\n1. 如果 $m \\neq n$：模式索引 $(m, n, p)$ 和 $(n, m, p)$ 是不同的，对应两个不同的本征函数。由于 $f_{mnp} = f_{nmp}$，这两个模式是简并的。简并态的简并度为 $2$。\n2. 如果 $m = n$：模式索引为 $(m, m, p)$。交换前两个索引会得到相同的三元组 $(m, m, p)$。只有一个不同的模式。这个状态相对于此对称性是非简并的。简并度为 $1$。\n\n为了将其表示为单一的闭式解析表达式，我们使用克罗内克 delta 函数 $\\delta_{mn}$，其定义为：如果 $m=n$，则 $\\delta_{mn} = 1$；如果 $m \\neq n$，则 $\\delta_{mn} = 0$。简并度 $g(m,n)$ 可以写为：\n如果 $m \\neq n$，$g(m,n) = 2$。\n如果 $m = n$，$g(m,n) = 1$。\n函数 $2 - \\delta_{mn}$ 满足这些条件：\n对于 $m \\neq n$，$g(m,n) = 2 - \\delta_{mn} = 2 - 0 = 2$。\n对于 $m=n$，$g(m,n) = 2 - \\delta_{nn} = 2 - 1 = 1$。\n对于任意给定的正整数对 $m$ 和 $n$，该表达式正确地量化了简并集 $\\{(m,n,p), (n,m,p)\\}$ 中的模式数量。", "answer": "$$ \\boxed{2 - \\delta_{mn}} $$", "id": "3291968"}, {"introduction": "对称性原理在现代光子学中有着前沿的应用，其中一个引人入胜的例子便是“连续谱中的束缚态”（Bound States in the Continuum, BIC）。本练习将理论与计算相结合，引导你使用时间耦合模理论（Temporal Coupled-Mode Theory, TCMT）来理解一个理想对称结构如何能够“囚禁”光，形成一个品质因数无限大的BIC。你将进一步推导当对称性被微小地破坏时，这个理想束缚态如何转变为一个具有极高但有限品质因数的“准BIC”，并学习如何通过编程验证其品质因数与对称性破缺参数之间的标度关系 [@problem_id:3291857]。", "problem": "考虑一个嵌入在介电常数为 $\\epsilon$、磁导率为 $\\mu$ 的均匀背景介质中的一维、镜像对称的开放电磁腔。设该腔支持一个角频率为 $\\omega_0$ 的单时谐共振模式，其复数电场和磁场分别为 $\\mathbf{E}(\\mathbf{r},t) = \\Re\\{\\mathbf{E}(\\mathbf{r}) e^{i \\omega t}\\}$ 和 $\\mathbf{H}(\\mathbf{r},t) = \\Re\\{\\mathbf{H}(\\mathbf{r}) e^{i \\omega t}\\}$，满足麦克斯韦方程组，即 $ \\nabla \\times \\mathbf{E} = -i\\omega\\mu\\mathbf{H} $ 和 $ \\nabla \\times \\mathbf{H} = i\\omega\\epsilon\\mathbf{E} $，并在无穷远处满足向外辐射边界条件。假设共振模式相对于腔的中间平面具有奇宇称，因此在完美镜像对称的情况下，其与两个辐射通道（向左和向右传播的平面波连续谱）的耦合振幅大小相等，符号相反。\n\n在时间耦合模理论（TCMT）下，定义共振模式的复振幅 $a(t)$，使得存储的电磁能量为 $U = |a|^2$。在没有外部驱动的情况下，该模式的动力学由 $ \\mathrm{d} a/\\mathrm{d}t = (i \\omega_0 - \\gamma_{\\mathrm{rad}}) a $ 控制，其中 $\\gamma_{\\mathrm{rad}}$ 是由与连续谱耦合引起的辐射衰减率。设与连续谱的耦合分别由进入左右辐射通道的复振幅 $g_{\\mathrm{L}}$ 和 $g_{\\mathrm{R}}$ 表示。对于完美对称腔中的奇宇称模式，$g_{\\mathrm{L}} = g$ 和 $g_{\\mathrm{R}} = - g$，其中 $g \\in \\mathbb{C}$，因此远场振幅发生相消干涉，辐射损耗消失，从而产生一个对称性保护的连续谱中束缚态。\n\n现在引入一个可控的镜像对称破缺参数 $\\delta \\in \\mathbb{R}$，其一阶近似模型通过扰动通道耦合来表示，即 $g_{\\mathrm{L}}(\\delta) = g (1 + \\delta)$ 和 $g_{\\mathrm{R}}(\\delta) = - g (1 - \\delta)$。向连续谱辐射的时间平均功率 $P_{\\mathrm{rad}}$ 可以表示为净出射振幅的二次型，该振幅是 $g_{\\mathrm{L}}(\\delta)$ 和 $g_{\\mathrm{R}}(\\delta)$ 与 $a$ 的线性乘积。定义一个实的正归一化常数 $\\Gamma$，它吸收了连续谱归一化以及从出射振幅到单位 $|a|^2$ 功率的映射，因此辐射衰减率为 $\\gamma_{\\mathrm{rad}} = P_{\\mathrm{rad}}/(2 U)$。\n\n任务：\n- 从上述物理模型和基本定律出发，推导辐射衰减率 $\\gamma_{\\mathrm{rad}}$ 对称破缺参数 $\\delta$ 的依赖关系，展示由 $g_{\\mathrm{L}}(\\delta)$ 和 $g_{\\mathrm{R}}(\\delta)$ 的干涉及能量-通量平衡得出的关于 $\\delta$ 的主阶标度关系。然后推导由此产生的连续谱中准束缚态（quasi-BIC）的品质因子 $Q = \\omega_0 / (2 \\gamma_{\\mathrm{rad}})$。\n- 实现一个程序，根据给定的参数集计算 $Q$。对所有测试用例使用以下固定数值：角频率 $\\omega_0 = 2 \\pi \\times 10^{10}$ $\\mathrm{rad/s}$ 和 $\\Gamma = 10^{6}$ $\\mathrm{s}^{-1}$。根据 $\\Gamma$ 的定义，将耦合振幅 $g$ 视为已包含在 $\\Gamma$ 中。忽略非辐射损耗，使得总衰减率等于辐射衰减率。所有计算出的 $Q$ 值都是无量纲的，并且必须以浮点数形式返回。\n- 使用您推导的关系式，计算测试套件中各个对称破缺参数下的 $Q$ 值：\n  1. $\\delta = 0$\n  2. $\\delta = 10^{-3}$\n  3. $\\delta = 5 \\times 10^{-3}$\n  4. $\\delta = - 10^{-2}$\n  5. $\\delta = 10^{-1}$\n- 此外，对于 $\\delta$ 非零的情况，通过在对数变量中进行线性拟合，估算经验关系 $Q \\propto |\\delta|^{-p}$ 中的标度指数 $p$。具体来说，通过对非零测试用例的 $\\log Q$ 与 $\\log |\\delta|$ 进行最小二乘拟合，计算得到的斜率的负值即为 $p$。将 $p$ 以浮点数形式返回。\n\n单位和格式：\n- $\\omega_0$ 的单位为 $\\mathrm{rad/s}$，$\\Gamma$ 的单位为 $\\mathrm{s}^{-1}$。量 $Q$ 是无量纲的。角度未使用，也无需指定。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，各项按顺序排列为 $[Q(\\delta=0), Q(10^{-3}), Q(5 \\times 10^{-3}), Q(-10^{-2}), Q(10^{-1}), p]$。如果任何测试用例的 $Q$ 发散，请用浮点无穷大值表示。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于电磁波现象的原理，特别是腔共振和连续谱中束缚态（BICs）理论。时间耦合模理论（TCMT）的使用是一个标准且合适的框架。该问题是适定的、客观的、自洽的，并且所有提供的参数在物理上都是一致的。因此，我们可以进行完整的推导和求解。\n\n**第一部分：辐射衰减率（$\\gamma_{\\mathrm{rad}}$）和品质因子（$Q$）的推导**\n\n问题要求我们推导辐射衰减率 $\\gamma_{\\mathrm{rad}}$ 和品质因子 $Q$ 对称破缺参数 $\\delta$ 的依赖关系。\n\n存储能量 $U$、辐射功率 $P_{\\mathrm{rad}}$ 和辐射衰减率 $\\gamma_{\\mathrm{rad}}$ 之间的基本关系如下：\n$$\n\\gamma_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}}{2U}\n$$\n共振模式中存储的能量根据模式振幅 $a(t)$ 定义为 $U = |a|^2$。因此：\n$$\n\\gamma_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}}{2|a|^2}\n$$\n问题指定了一个具有奇宇称共振模式的一维镜像对称腔。在完美对称的情况下（$\\delta=0$），与左（$g_{\\mathrm{L}}$）右（$g_{\\mathrm{R}}$）辐射通道的耦合振幅为 $g_{\\mathrm{L}} = g$ 和 $g_{\\mathrm{R}} = -g$。问题关键地指出，对于这种对称情况，“远场振幅发生相消干涉，辐射损耗消失。”这表明总辐射功率不是每个通道功率的非相干总和（那将与 $|g_{\\mathrm{L}}|^2 + |g_{\\mathrm{R}}|^2$ 成正比），而是由辐射到连续谱中的场相干叠加的结果。\n\n因此，辐射场的净振幅与各个通道耦合振幅之和成正比。设此净耦合振幅为 $g_{\\mathrm{net}}$。时间平均辐射功率 $P_{\\mathrm{rad}}$ 与此净振幅的平方模量和模式振幅的平方模量 $|a|^2$ 成正比。\n$$\nP_{\\mathrm{rad}} \\propto |g_{\\mathrm{net}}|^2 |a|^2\n$$\n净耦合振幅 $g_{\\mathrm{net}}$ 是扰动后的耦合振幅 $g_{\\mathrm{L}}(\\delta)$ 和 $g_{\\mathrm{R}}(\\delta)$ 的和：\n$$\ng_{\\mathrm{net}}(\\delta) = g_{\\mathrm{L}}(\\delta) + g_{\\mathrm{R}}(\\delta)\n$$\n代入给定的扰动耦合表达式，$g_{\\mathrm{L}}(\\delta) = g(1 + \\delta)$ 和 $g_{\\mathrm{R}}(\\delta) = -g(1 - \\delta)$：\n$$\ng_{\\mathrm{net}}(\\delta) = g(1 + \\delta) + (-g(1 - \\delta)) = g(1 + \\delta - 1 + \\delta) = 2g\\delta\n$$\n因此，辐射功率与 $|2g\\delta|^2$ 成正比：\n$$\nP_{\\mathrm{rad}} \\propto |2g\\delta|^2 |a|^2 = 4 |g|^2 \\delta^2 |a|^2\n$$\n问题引入了一个实的正数常数 $\\Gamma$，“它吸收了连续谱归一化以及从出射振幅到单位 $|a|^2$ 功率的映射”，并进一步说明“将耦合振幅 $g$ 视为已包含在 $\\Gamma$ 中”。这意味着我们可以将比例常数以及 $|g|^2$ 和任何其他因子（如因子 $4$）封装到一个定义衰减率尺度的单一常数中。最直接且一致的解释是将 $\\gamma_{\\mathrm{rad}}$ 的关系定义为：\n$$\n\\gamma_{\\mathrm{rad}}(\\delta) = \\Gamma \\delta^2\n$$\n我们来验证一下这个形式。问题给出的 $\\Gamma$ 的单位是 $\\mathrm{s}^{-1}$，这是衰减率的单位，而 $\\delta$ 是无量纲的，所以量纲分析是正确的。此表达式表明，对于 $\\delta=0$，$\\gamma_{\\mathrm{rad}}(0) = 0$，这正确地描述了对称性保护的连续谱中束缚态（一种具有无限寿命或零衰减率的模式）。当对称性被打破时（$\\delta \\neq 0$），一个辐射损耗通道打开，其衰减率与扰动参数 $\\delta$呈二次方关系。这种 $\\delta^2$ 依赖性是由对称性破缺产生的准BIC的一个标志。\n\n接下来，我们推导品质因子 $Q$。其定义为：\n$$\nQ = \\frac{\\omega_0}{2 \\gamma_{\\mathrm{rad}}}\n$$\n代入我们推导出的 $\\gamma_{\\mathrm{rad}}(\\delta)$ 表达式：\n$$\nQ(\\delta) = \\frac{\\omega_0}{2 (\\Gamma \\delta^2)} = \\frac{\\omega_0}{2\\Gamma\\delta^2}\n$$\n这就是准BIC的品质因子作为对称破缺参数 $\\delta$ 的函数的最终表达式。\n\n**第二部分：标度指数（$p$）的计算**\n\n问题要求我们找到关系式 $Q \\propto |\\delta|^{-p}$ 中的标度指数 $p$。根据我们推导的公式，\n$$\nQ(\\delta) = \\left(\\frac{\\omega_0}{2\\Gamma}\\right) \\frac{1}{\\delta^2} = \\left(\\frac{\\omega_0}{2\\Gamma}\\right) |\\delta|^{-2}\n$$\n通过直接比较，我们可以看出理论上的标度指数是 $p=2$。\n\n为了按要求进行数值确认，我们对对数变量进行线性拟合。对 $Q$ 的表达式取对数：\n$$\n\\log(Q) = \\log\\left(\\frac{\\omega_0}{2\\Gamma}\\right) + \\log(|\\delta|^{-2})\n$$\n$$\n\\log(Q) = \\log\\left(\\frac{\\omega_0}{2\\Gamma}\\right) - 2\\log(|\\delta|)\n$$\n这是一个 $y = c + mx$ 形式的线性方程，其中 $y = \\log(Q)$，$x = \\log(|\\delta|)$，截距为 $c = \\log(\\omega_0/(2\\Gamma))$，斜率为 $m = -2$。问题将 $p$ 定义为 $\\log(Q)$ 对 $\\log(|\\delta|)$ 的斜率的负值。因此，$p = -m = -(-2) = 2$。由于所提供的数据点将完美拟合此理论模型，数值最小二乘拟合将得出精确为 $2$ 的指数 $p$。\n\n**第三部分：数值计算**\n\n我们使用给定的值：\n- $\\omega_0 = 2 \\pi \\times 10^{10} \\, \\mathrm{rad/s}$\n- $\\Gamma = 10^6 \\, \\mathrm{s}^{-1}$\n\n$Q$ 的计算公式为：\n$$\nQ(\\delta) = \\frac{2 \\pi \\times 10^{10}}{2 \\times 10^6 \\times \\delta^2} = \\frac{\\pi \\times 10^4}{\\delta^2}\n$$\n我们为每个指定的 $\\delta$ 值计算 $Q$：\n1.  $\\delta = 0$: $Q(0) = \\frac{\\pi \\times 10^4}{0^2} \\rightarrow \\infty$。\n2.  $\\delta = 10^{-3}$: $Q(10^{-3}) = \\frac{\\pi \\times 10^4}{(10^{-3})^2} = \\frac{\\pi \\times 10^4}{10^{-6}} = \\pi \\times 10^{10}$。\n3.  $\\delta = 5 \\times 10^{-3}$: $Q(5 \\times 10^{-3}) = \\frac{\\pi \\times 10^4}{(5 \\times 10^{-3})^2} = \\frac{\\pi \\times 10^4}{25 \\times 10^{-6}} = \\frac{\\pi}{25} \\times 10^{10} = 4\\pi \\times 10^8$。\n4.  $\\delta = -10^{-2}$: $Q(-10^{-2}) = \\frac{\\pi \\times 10^4}{(-10^{-2})^2} = \\frac{\\pi \\times 10^4}{10^{-4}} = \\pi \\times 10^8$。\n5.  $\\delta = 10^{-1}$: $Q(10^{-1}) = \\frac{\\pi \\times 10^4}{(10^{-1})^2} = \\frac{\\pi \\times 10^4}{10^{-2}} = \\pi \\times 10^6$。\n\n标度指数 $p$，根据解析推导并由非零 $\\delta$ 情况下的数值拟合确认，为 $p=2$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the quality factor Q of a quasi-BIC and its scaling exponent.\n    \n    The solution is based on the derived relationship Q = omega_0 / (2 * Gamma * delta^2),\n    which arises from the coherent destructive interference of radiation channels being\n    perturbed by a symmetry-breaking parameter delta.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    # Angular frequency in rad/s\n    omega_0 = 2 * np.pi * 1e10\n    # Normalization constant for decay rate in s^-1\n    Gamma = 1e6\n\n    # Define the test cases for the symmetry-breaking parameter delta.\n    deltas = [0.0, 1e-3, 5e-3, -1e-2, 1e-1]\n\n    q_values = []\n    \n    # Calculate Q for each delta\n    for delta in deltas:\n        if delta == 0:\n            # For the perfect BIC case (delta=0), the decay rate is zero,\n            # so the quality factor Q is infinite.\n            q_values.append(np.inf)\n        else:\n            # The radiative decay rate is gamma_rad = Gamma * delta^2\n            gamma_rad = Gamma * delta**2\n            # The quality factor is Q = omega_0 / (2 * gamma_rad)\n            q_val = omega_0 / (2 * gamma_rad)\n            q_values.append(q_val)\n            \n    # --- Estimate the scaling exponent p ---\n    # The relationship is Q proportional to |delta|^-p.\n    # In log-log scale, log(Q) = C - p * log(|delta|).\n    # The exponent p is the negative of the slope of log(Q) vs log(|delta|).\n    \n    # Filter for non-zero deltas and their corresponding Q values.\n    non_zero_deltas = [d for d in deltas if d != 0]\n    non_zero_q_values = [q for d, q in zip(deltas, q_values) if d != 0]\n\n    # Prepare data for linear regression in log-space.\n    log_abs_deltas = np.log(np.abs(non_zero_deltas))\n    log_q_values = np.log(non_zero_q_values)\n    \n    # Perform a linear least-squares fit (degree 1 polynomial).\n    # polyfit returns [slope, intercept].\n    slope, intercept = np.polyfit(log_abs_deltas, log_q_values, 1)\n    \n    # The scaling exponent p is the negative of the slope.\n    p = -slope\n\n    # Combine all results into a single list for output.\n    # The order must be [Q(delta=0), Q(delta=1e-3), ..., p]\n    results = q_values + [p]\n\n    # Print the final result in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3291857"}]}