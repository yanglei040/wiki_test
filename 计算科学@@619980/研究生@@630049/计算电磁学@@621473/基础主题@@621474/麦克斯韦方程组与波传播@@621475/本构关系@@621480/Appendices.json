{"hands_on_practices": [{"introduction": "电磁波在金属等导电材料内部如何表现？这个基本问题可以通过研究麦克斯韦方程组与材料本构关系之间的相互作用来回答。本练习将引导您完成一个经典的推导，以量化良导体中波的衰减，并引入复传播常数和趋肤深度这两个关键概念。掌握这一分析对于理解屏蔽、功率损耗以及电子电路和通信系统中的高频效应至关重要。[@problem_id:3295112]", "problem": "考虑一个角频率为 $\\omega$ 的时谐均匀平面电磁（EM）波，在一个由本构关系 $\\mathbf{D}=\\epsilon \\mathbf{E}$、$\\mathbf{B}=\\mu \\mathbf{H}$ 和 $\\mathbf{J}=\\sigma \\mathbf{E}$ 表征的均匀、各向同性、线性介质中沿 $+z$ 方向传播，其中 $\\epsilon$ 是介电常数，$\\mu$ 是磁导率，$\\sigma$ 是电导率。在相量域中进行计算，时间依赖关系为 $\\exp(j\\omega t)$，其中 $j=\\sqrt{-1}$。假设该介质是良导体，满足 $\\sigma \\gg \\omega \\epsilon$。\n\n从频域中的麦克斯韦方程组和给定的本构关系出发，推导该平面波的复传播常数 $\\gamma=\\alpha+j\\beta$ 以及相应的趋肤深度 $\\delta$（定义为 $\\delta=1/\\alpha$）。在所述良导体假设下，将 $\\gamma$ 和 $\\delta$ 的最终结果表示为仅包含 $\\omega$、$\\mu$ 和 $\\sigma$ 的封闭形式。以解析表达式的形式给出最终答案。不要将中间方程或恒等式作为最终答案。", "solution": "所述问题具有科学依据，提法恰当且客观。这是计算电磁学和波传播理论中的一个标准推导。所有必要的已知条件和前提均已提供，不存在矛盾或歧义。问题被认定为有效，并将提供解答。\n\n目标是从麦克斯韦方程组出发，推导在良导体中传播的均匀平面波的复传播常数 $\\gamma$ 和趋肤深度 $\\delta$。\n\n我们从线性、各向同性、均匀且无自由电荷源（$\\rho_v = 0$）的介质中的频域（相量）麦克斯韦方程组开始：\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + j\\omega\\mathbf{D}\n$$\n$$\n\\nabla \\cdot \\mathbf{D} = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\n此处，$\\mathbf{E}$、$\\mathbf{H}$、$\\mathbf{D}$、$\\mathbf{B}$ 和 $\\mathbf{J}$ 分别是电场强度、磁场强度、电通量密度、磁通量密度和电流密度的相量表示。角频率为 $\\omega$，且 $j = \\sqrt{-1}$。\n\n我们将给定的本构关系 $\\mathbf{D}=\\epsilon \\mathbf{E}$、$\\mathbf{B}=\\mu \\mathbf{H}$ 和 $\\mathbf{J}=\\sigma \\mathbf{E}$ 代入麦克斯韦的旋度方程：\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H} \\quad (1)\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\sigma\\mathbf{E} + j\\omega\\epsilon\\mathbf{E} = (\\sigma + j\\omega\\epsilon)\\mathbf{E} \\quad (2)\n$$\n为推导电场的波动方程，我们对方程(1)取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega\\mu(\\nabla \\times \\mathbf{H})\n$$\n接下来，我们使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$。对于电场 $\\mathbf{E}$，该恒等式为 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2\\mathbf{E}$。根据麦克斯韦第三个方程 $\\nabla \\cdot \\mathbf{D} = 0$ 和本构关系 $\\mathbf{D}=\\epsilon \\mathbf{E}$，我们有 $\\nabla \\cdot (\\epsilon\\mathbf{E}) = \\epsilon(\\nabla \\cdot \\mathbf{E}) = 0$。对于一个 $\\epsilon \\neq 0$ 的非平凡介质，可以得出 $\\nabla \\cdot \\mathbf{E} = 0$。因此，该矢量恒等式简化为 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\nabla^2\\mathbf{E}$。\n\n将这个简化的恒等式和方程(2)代入取了旋度的方程(1)中，我们得到：\n$$\n-\\nabla^2\\mathbf{E} = -j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E}\n$$\n重新整理该式，得到电场的矢量亥姆霍兹方程：\n$$\n\\nabla^2\\mathbf{E} - j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E} = 0\n$$\n该方程描述了波的传播，其一般形式为 $\\nabla^2\\mathbf{E} - \\gamma^2\\mathbf{E} = 0$。通过比较，我们确定复传播常数的平方 $\\gamma^2$ 为：\n$$\n\\gamma^2 = j\\omega\\mu(\\sigma + j\\omega\\epsilon) = j\\omega\\mu\\sigma - \\omega^2\\mu\\epsilon\n$$\n问题指定该介质为良导体，其满足条件 $\\sigma \\gg \\omega\\epsilon$。这意味着传导电流密度远大于位移电流密度（$|\\mathbf{J}| = \\sigma|\\mathbf{E}| \\gg |j\\omega\\mathbf{D}| = \\omega\\epsilon|\\mathbf{E}|$)。在此近似下，与 $\\sigma$ 相比，$\\gamma^2$ 表达式中的 $\\omega\\epsilon$ 项可以忽略不计：\n$$\n\\gamma^2 \\approx j\\omega\\mu\\sigma\n$$\n为求得 $\\gamma$，我们必须对这个复数取平方根。我们将虚数单位 $j$ 表示为极坐标形式 $j = \\exp(j\\pi/2)$。\n$$\n\\gamma \\approx \\sqrt{\\omega\\mu\\sigma \\exp(j\\pi/2)} = \\sqrt{\\omega\\mu\\sigma} \\cdot \\left(\\exp(j\\pi/2)\\right)^{1/2} = \\sqrt{\\omega\\mu\\sigma} \\exp(j\\pi/4)\n$$\n使用欧拉公式 $\\exp(j\\theta) = \\cos(\\theta) + j\\sin(\\theta)$，我们将极坐标形式转换回直角坐标形式：\n$$\n\\exp(j\\pi/4) = \\cos(\\frac{\\pi}{4}) + j\\sin(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}} + j\\frac{1}{\\sqrt{2}} = \\frac{1+j}{\\sqrt{2}}\n$$\n将此结果代入 $\\gamma$ 的表达式中：\n$$\n\\gamma \\approx \\sqrt{\\omega\\mu\\sigma} \\left( \\frac{1+j}{\\sqrt{2}} \\right) = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}(1+j)\n$$\n这就是在良导体近似下复传播常数 $\\gamma$ 的最终表达式。\n\n复传播常数定义为 $\\gamma = \\alpha + j\\beta$，其中 $\\alpha$ 是衰减常数，$\\beta$ 是相移常数。通过令我们推导出的 $\\gamma$ 表达式的实部和虚部分别相等，我们得到：\n$$\n\\alpha = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}\n$$\n$$\n\\beta = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}\n$$\n趋肤深度 $\\delta$ 定义为电场振幅衰减至其表面值 $1/e$ 时的深度。它由衰减常数的倒数给出，即 $\\delta=1/\\alpha$。\n$$\n\\delta = \\frac{1}{\\alpha} = \\frac{1}{\\sqrt{\\frac{\\omega\\mu\\sigma}{2}}} = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}}\n$$\n这是趋肤深度 $\\delta$ 的最终表达式。问题要求给出 $\\gamma$ 和 $\\delta$ 的最终解析表达式。", "answer": "$$\n\\boxed{\\gamma = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}(1+j), \\quad \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}}}\n$$", "id": "3295112"}, {"introduction": "虽然简单的电导率是一个很好的起点，但许多材料，特别是处于光学频率下的金属，表现出频率依赖（色散）行为，这无法用一个恒定的 $\\sigma$ 来描述。本练习通过使用德鲁德模型（一种物理上合理的本构关系）对金属进行建模，进入了时域仿真的动态世界。您将对该模型进行离散化，以便在时域有限差分 (FDTD) 仿真中使用，并且最重要的是，您将分析由材料模型本身引起的特定数值稳定性约束，这对于任何计算物理学家或工程师来说都是一项关键技能。[@problem_id:3295082]", "problem": "考虑一维时域有限差分（FDTD）法，用于模拟由 Drude 型本构关系描述的均匀金属。该金属的极化密度 $P(t)$ 由以下二阶常微分方程控制：\n$$\\frac{d^{2}P}{dt^{2}}+\\gamma\\,\\frac{dP}{dt}+\\omega_{p}^{2}\\,P=\\epsilon_{0}\\,\\omega_{p}^{2}\\,E,$$\n其中 $\\epsilon_{0}$ 是真空介电常数，$\\gamma>0$ 是碰撞频率，$\\omega_{p}>0$ 是等离子体频率，而 $E$ 是电场。电场和磁场使用标准的一维交错 Yee 格式进行演化。Drude 金属的色散特性意味着，对于低于等离子体频率的角频率 $\\omega$，有 $\\mathrm{Re}\\{\\epsilon(\\omega)\\} < 0$。如果辅助微分方程（ADE）的离散化引入了靠近奈奎斯特频率的离散时间极点，这可能导致伪谐振。\n\n仅从麦克斯韦方程组的微分形式和上述 Drude 极化方程出发，完成以下任务：\n\n1. 使用与 Yee 格式一致的蛙跳中心时间离散化方法，对 Drude 极化方程进行离散化，以获得一个联系 $P^{n+1}$、$P^{n}$、$P^{n-1}$ 和驱动项 $E^{n}$ 的三项线性递推关系，其中 $n$ 是由 $\\Delta t$ 分隔的离散时间步长的索引。推导该递推关系齐次部分的特征多项式。\n\n2. 通过定位其离散时间极点并应用离散时间稳定性测试，分析 ADE 递推关系的稳定性，以确保极点严格位于单位圆内。由此，获得 $\\Delta t$ 的一个显式界限，确保极化的离散谐振频率严格低于奈奎斯特频率，从而避免在等离子体频率附近的伪谐振。将此界限仅用 $\\omega_{p}$ 和 $\\Delta t$ 表示。\n\n3. 推导真空中 Yee 格式的一维数值色散关系，并获得联系 $\\Delta t$、空间步长 $\\Delta x$ 和光速 $c$ 的 Courant 型条件。陈述为保证角频率解为实数所必需的 $\\Delta t$ 的相应界限。\n\n4. 结合步骤 2 和 3 的界限，给出一个单一的解析表达式，用于表示最大允许时间步长 $\\Delta t_{\\max}$，该步长能同时确保 FDTD 的稳定性以及避免在 $\\mathrm{Re}\\{\\epsilon(\\omega)\\} < 0$ 的金属中由 ADE 引起的伪谐振。\n\n5. 对于一个网格，其参数为 $\\Delta x=5.0\\times 10^{-9}\\,\\mathrm{m}$，等离子体频率 $\\omega_{p}=1.5\\times 10^{16}\\,\\mathrm{s}^{-1}$，碰撞频率 $\\gamma=8.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，光速 $c=2.99792458\\times 10^{8}\\,\\mathrm{m/s}$，数值计算 $\\Delta t_{\\max}$。将您的答案四舍五入至四位有效数字，并以秒为单位表示。", "solution": "该问题要求对应用于 Drude 金属的时域有限差分（FDTD）方法进行多步分析，最终以数值计算最大稳定时间步长告终。验证过程确认了该问题具有科学依据、提法恰当，并且所有提供的数据都是一致且物理上现实的。我们开始解答。\n\n**1. Drude 极化方程的离散化**\n\n控制极化密度 $P(t)$ 的常微分方程如下：\n$$\n\\frac{d^{2}P}{dt^{2}}+\\gamma\\,\\frac{dP}{dt}+\\omega_{p}^{2}\\,P=\\epsilon_{0}\\,\\omega_{p}^{2}\\,E\n$$\n我们使用与 Yee 算法一致的蛙跳中心格式对该方程进行时间离散化。时间被离散化为 $t = n \\Delta t$，其中 $n$ 是整数时间步长索引，$\\Delta t$ 是时间步长大小。假设场 $P$ 和 $E$ 在时间上位于同一位置，在整数时间步长 $n$ 处取值。我们对导数使用中心差分近似，中心点在时间 $n$：\n$$\n\\frac{d^{2}P}{dt^{2}}\\bigg|_{t=n\\Delta t} \\approx \\frac{P^{n+1} - 2P^{n} + P^{n-1}}{(\\Delta t)^{2}}\n$$\n$$\n\\frac{dP}{dt}\\bigg|_{t=n\\Delta t} \\approx \\frac{P^{n+1} - P^{n-1}}{2\\Delta t}\n$$\n将这些近似值代入 Drude 方程，得到：\n$$\n\\frac{P^{n+1} - 2P^{n} + P^{n-1}}{(\\Delta t)^{2}} + \\gamma\\,\\frac{P^{n+1} - P^{n-1}}{2\\Delta t} + \\omega_{p}^{2}\\,P^{n} = \\epsilon_{0}\\,\\omega_{p}^{2}\\,E^{n}\n$$\n为了找到 $P^{n+1}$ 的递推关系，我们按时间索引对各项进行分组：\n$$\nP^{n+1}\\left(\\frac{1}{(\\Delta t)^{2}} + \\frac{\\gamma}{2\\Delta t}\\right) + P^{n}\\left(\\omega_{p}^{2} - \\frac{2}{(\\Delta t)^{2}}\\right) + P^{n-1}\\left(\\frac{1}{(\\Delta t)^{2}} - \\frac{\\gamma}{2\\Delta t}\\right) = \\epsilon_{0}\\,\\omega_{p}^{2}\\,E^{n}\n$$\n将整个方程乘以 $(\\Delta t)^{2}$ 得到：\n$$\nP^{n+1}\\left(1 + \\frac{\\gamma\\Delta t}{2}\\right) + P^{n}\\left(\\omega_{p}^{2}(\\Delta t)^{2} - 2\\right) + P^{n-1}\\left(1 - \\frac{\\gamma\\Delta t}{2}\\right) = \\epsilon_{0}\\,\\omega_{p}^{2}(\\Delta t)^{2}\\,E^{n}\n$$\n解出 $P^{n+1}$，得到三项线性递推关系：\n$$\nP^{n+1} = \\frac{2 - \\omega_{p}^{2}(\\Delta t)^{2}}{1 + \\frac{\\gamma\\Delta t}{2}}P^{n} - \\frac{1 - \\frac{\\gamma\\Delta t}{2}}{1 + \\frac{\\gamma\\Delta t}{2}}P^{n-1} + \\frac{\\epsilon_{0}\\,\\omega_{p}^{2}(\\Delta t)^{2}}{1 + \\frac{\\gamma\\Delta t}{2}}E^{n}\n$$\n通过将驱动项 $E^{n}$ 设置为 0，可以得到该递推关系的齐次部分：\n$$\nP^{n+1}\\left(1 + \\frac{\\gamma\\Delta t}{2}\\right) + P^{n}\\left(\\omega_{p}^{2}(\\Delta t)^{2} - 2\\right) + P^{n-1}\\left(1 - \\frac{\\gamma\\Delta t}{2}\\right) = 0\n$$\n通过代入 $P^{k} = \\lambda^{k}$（其中 $\\lambda$ 为某个常数），可以找到特征多项式：\n$$\n\\lambda^{2}\\left(1 + \\frac{\\gamma\\Delta t}{2}\\right) + \\lambda\\left(\\omega_{p}^{2}(\\Delta t)^{2} - 2\\right) + \\left(1 - \\frac{\\gamma\\Delta t}{2}\\right) = 0\n$$\n这就是该递推关系齐次部分的特征多项式。\n\n**2. 辅助微分方程（ADE）递推关系的稳定性分析**\n\n问题要求给出 $\\Delta t$ 的一个界限以防止伪谐振，当离散时间极点接近奈奎斯特频率时会发生伪谐振。这对应于离散谐振频率接近 $\\tilde{\\omega} = \\pi/\\Delta t$。对于这种类型的频率混叠不稳定性，最严格的条件出现在无阻尼情况下，即 $\\gamma=0$。问题的措辞，要求界限“仅用 $\\omega_p$ 和 $\\Delta t$ 表示”，进一步表明应分析此极限情况。在步骤 1 的特征多项式中设置 $\\gamma=0$ 得到：\n$$\n\\lambda^{2} + (\\omega_{p}^{2}(\\Delta t)^{2} - 2)\\lambda + 1 = 0\n$$\n根（极点）由 $\\lambda = \\exp(\\pm i\\tilde{\\omega}_{0}\\Delta t)$ 给出，其中 $\\tilde{\\omega}_{0}$ 是数值谐振频率。根之和为 $\\lambda_1 + \\lambda_2 = 2\\cos(\\tilde{\\omega}_{0}\\Delta t)$。从多项式可知，这个和是 $-( \\omega_{p}^{2}(\\Delta t)^{2} - 2) = 2 - \\omega_{p}^{2}(\\Delta t)^{2}$。因此，\n$$\n\\cos(\\tilde{\\omega}_{0}\\Delta t) = 1 - \\frac{\\omega_{p}^{2}(\\Delta t)^{2}}{2}\n$$\n另外，使用恒等式 $1 - \\cos(x) = 2\\sin^{2}(x/2)$，我们找到了无阻尼振荡器著名的 FDTD 色散关系：\n$$\n\\sin\\left(\\frac{\\tilde{\\omega}_{0}\\Delta t}{2}\\right) = \\frac{\\omega_{p}\\Delta t}{2}\n$$\n为了使 $\\tilde{\\omega}_{0}$ 是一个实数频率，反正弦函数的参数的绝对值必须小于或等于 1：\n$$\n\\left|\\frac{\\omega_{p}\\Delta t}{2}\\right| \\leq 1 \\implies \\omega_{p}\\Delta t \\leq 2\n$$\n当数值频率 $\\tilde{\\omega}_0$ 达到奈奎斯特频率 $\\omega_{N} = \\pi/\\Delta t$ 时，发生伪谐振。这发生在 $\\tilde{\\omega}_{0}\\Delta t = \\pi$ 时，即 $\\tilde{\\omega}_{0}\\Delta t / 2 = \\pi/2$。此时，$\\sin(\\pi/2) = 1$，这正好对应于稳定性条件的极限，$\\omega_{p}\\Delta t / 2 = 1$。为确保离散谐振频率*严格低于*奈奎斯特频率，我们必须强制执行一个严格不等式：\n$$\n\\omega_{p}\\Delta t  2\n$$\n这个不等式表示了用 $\\omega_p$ 和 $\\Delta t$ 表示的 $\\Delta t$ 的界限。由此，$\\Delta t$ 的显式界限为 $\\Delta t  2/\\omega_p$。\n\n**3. Yee 格式的数值色散与 Courant 条件**\n\n在一维情况下，对于沿 $x$ 轴传播且场分量为 $E_z$ 和 $H_y$ 的波，真空中的麦克斯韦旋度方程为：\n$$\n\\epsilon_{0}\\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x} \\quad , \\quad \\mu_{0}\\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}\n$$\n将它们结合起来得到波动方程 $\\frac{\\partial^2 E_z}{\\partial t^2} = c^2 \\frac{\\partial^2 E_z}{\\partial x^2}$，其中 $c=1/\\sqrt{\\epsilon_0 \\mu_0}$。应用标准的 Yee FDTD 格式，我们用空间和时间上的中心差分来近似二阶导数，从而得到离散波动方程：\n$$\n\\frac{E_{z,i}^{n+1} - 2E_{z,i}^{n} + E_{z,i}^{n-1}}{(\\Delta t)^{2}} = c^{2}\\frac{E_{z,i+1}^{n} - 2E_{z,i}^{n} + E_{z,i-1}^{n}}{(\\Delta x)^{2}}\n$$\n我们假设一个离散平面波解的形式为 $E_{z,i}^{n} = E_{0}\\exp[i(k_{x}i\\Delta x - \\omega n\\Delta t)]$，其中 $k_x$ 是数值波数，$\\omega$ 是数值角频率。将此解代入离散波动方程，得到：\n$$\n\\frac{\\exp(-i\\omega\\Delta t) - 2 + \\exp(i\\omega\\Delta t)}{(\\Delta t)^{2}} = c^{2}\\frac{\\exp(ik_{x}\\Delta x) - 2 + \\exp(-ik_{x}\\Delta x)}{(\\Delta x)^{2}}\n$$\n使用恒等式 $\\cos(\\theta) = (\\exp(i\\theta) + \\exp(-i\\theta))/2$，我们得到：\n$$\n\\frac{2\\cos(\\omega\\Delta t) - 2}{(\\Delta t)^{2}} = c^{2}\\frac{2\\cos(k_{x}\\Delta x) - 2}{(\\Delta x)^{2}}\n$$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^{2}(\\theta/2)$：\n$$\n\\frac{-4\\sin^{2}(\\frac{\\omega\\Delta t}{2})}{(\\Delta t)^{2}} = c^{2}\\frac{-4\\sin^{2}(\\frac{k_{x}\\Delta x}{2})}{(\\Delta x)^{2}}\n$$\n这可以简化为一维数值色散关系：\n$$\n\\frac{1}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{c}{\\Delta x}\\sin\\left(\\frac{k_{x}\\Delta x}{2}\\right)\n$$\n为了使角频率 $\\omega$ 对于所有可能的实数波数 $k_x$ 都是实数值，等式右边除以 $1/\\Delta t$ 后，必须是反正弦函数的有效参数。$|\\sin(k_{x}\\Delta x/2)|$ 的最大值为 1。因此，我们必须有：\n$$\n\\left|\\frac{c\\Delta t}{\\Delta x}\\sin\\left(\\frac{k_{x}\\Delta x}{2}\\right)\\right| \\leq 1 \\implies \\frac{c\\Delta t}{\\Delta x} \\leq 1\n$$\n这就是 Courant-Friedrichs-Lewy (CFL) 稳定性条件。对应的 $\\Delta t$ 界限是：\n$$\n\\Delta t \\leq \\frac{\\Delta x}{c}\n$$\n\n**4. $\\Delta t_{\\max}$ 的组合稳定性界限**\n\n为同时确保 FDTD 波更新的数值稳定性和避免 ADE 离散化引起的伪谐振，时间步长 $\\Delta t$ 必须同时满足两个推导出的条件：\n1. ADE 稳定性（来自步骤 2）：$\\Delta t  \\frac{2}{\\omega_{p}}$\n2. FDTD 稳定性（来自步骤 3）：$\\Delta t \\leq \\frac{\\Delta x}{c}$\n\n最大允许时间步长 $\\Delta t_{\\max}$ 是满足两个不等式的最大值。因此，它必须是两个上界中的最小值：\n$$\n\\Delta t_{\\max} = \\min\\left(\\frac{2}{\\omega_{p}}, \\frac{\\Delta x}{c}\\right)\n$$\n注意，第一个界限在技术上是一个严格不等式，但在定义最大值时，我们考虑其极限情况。\n\n**5. $\\Delta t_{\\max}$ 的数值计算**\n\n我们已知以下数值：\n- 空间步长：$\\Delta x = 5.0 \\times 10^{-9}\\,\\mathrm{m}$\n- 等离子体频率：$\\omega_{p} = 1.5 \\times 10^{16}\\,\\mathrm{s}^{-1}$\n- 碰撞频率：$\\gamma = 8.0 \\times 10^{13}\\,\\mathrm{s}^{-1}$ （此参数未出现在推导的简化稳定性判据中，因为对于给定值，其对界限的影响可以忽略不计。）\n- 光速：$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$\n\n首先，我们根据 ADE 稳定性判据计算界限：\n$$\n\\Delta t_{\\text{ADE}} = \\frac{2}{\\omega_{p}} = \\frac{2}{1.5 \\times 10^{16}\\,\\mathrm{s}^{-1}} \\approx 1.3333 \\times 10^{-16}\\,\\mathrm{s}\n$$\n接下来，我们计算 Courant 稳定性界限：\n$$\n\\Delta t_{\\text{Courant}} = \\frac{\\Delta x}{c} = \\frac{5.0 \\times 10^{-9}\\,\\mathrm{m}}{2.99792458 \\times 10^{8}\\,\\mathrm{m/s}} \\approx 1.66782 \\times 10^{-17}\\,\\mathrm{s}\n$$\n比较两个界限：\n$$\n\\Delta t_{\\max} = \\min(1.3333 \\times 10^{-16}\\,\\mathrm{s}, 1.66782 \\times 10^{-17}\\,\\mathrm{s}) = 1.66782 \\times 10^{-17}\\,\\mathrm{s}\n$$\n在这种情况下，Courant 条件是更严格的限制条件。将结果四舍五入至四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} \\approx 1.668 \\times 10^{-17}\\,\\mathrm{s}\n$$", "answer": "$$\n\\boxed{1.668 \\times 10^{-17}}\n$$", "id": "3295082"}, {"introduction": "现实世界中的材料通常不仅是色散的，而且是各向异性的，这意味着它们的电磁响应取决于场的方向。最后的这个练习旨在解决为这类复杂介质设计一个稳健的 FDTD 方案的挑战，这些介质在晶体光学、超材料和先进复合材料等应用中至关重要。通过推导离散的坡印亭定理，您将为具有张量介电常数和空间变化的电导率的介质建立一个严格的、基于能量的稳定性判据，这代表了开发可靠且准确的计算模型的关键技术。[@problem_id:3295110]", "problem": "考虑微分形式的麦克斯韦方程组以及各向异性有损介质的本构关系。设电通量密度为 $\\,\\mathbf{D} = \\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,\\mathbf{E}\\,$，其中 $\\,\\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,$ 为对称正定张量；磁通量密度为 $\\,\\mathbf{B} = \\mu\\,\\mathbf{H}\\,$，其中标量 $\\,\\mu  0\\,$；传导电流为 $\\,\\mathbf{J}_c = \\sigma(\\mathbf{r})\\,\\mathbf{E}\\,$，其中标量 $\\,\\sigma(\\mathbf{r}) \\ge 0\\,$。其演化由 $\\,\\partial_t \\mathbf{D} + \\mathbf{J}_c = \\nabla \\times \\mathbf{H}\\,$ 和 $\\,\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}\\,$ 控制。\n\n您将为 $\\,\\mathbf{E}\\,$ 和 $\\,\\mathbf{H}\\,$ 设计一个基于交错 Yee 晶格的时域有限差分方案，该方案对于具有 $\\,\\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,$ 和非均匀 $\\,\\sigma(\\mathbf{r})\\,$ 的各向异性有损介质是稳定的。具体来说，您必须：\n\n- 从上述基本定律和核心定义出发，为 $\\,\\mathbf{H}\\,$ 构建一个时间上蛙跳式的离散化，并为 $\\,\\mathbf{E}\\,$ 的传导项构建一个梯形（时间中心）离散化，使得每个单元中 $\\,\\mathbf{E}\\,$ 的更新涉及对 $\\,\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma \\bar{\\bar{I}}\\,$ 的局部求逆，其中 $\\,\\bar{\\bar{I}}\\,$ 是单位张量。\n- 在 Yee 网格上推导离散 Poynting 定理，该定理定义了形式为 $$W^n = \\frac{1}{2}\\sum_{\\text{cells}} \\mathbf{E}^n \\cdot \\bar{\\bar{\\epsilon}}\\,\\mathbf{E}^n + \\frac{1}{2}\\sum_{\\text{faces}} \\mu\\,|\\mathbf{H}^{n+\\frac{1}{2}}|^2,$$ 的离散能量，并证明时间增量 $\\,W^{n+1} - W^n\\,$ 等于一个涉及 $\\,\\sigma\\,|\\mathbf{E}|^2\\,$ 的耗散项的负值加上一个边界通量项。在周期性边界条件下，必须证明净通量为零。\n- 根据这个离散能量恒等式，就最大局部波速和 Yee 网格离散旋度算子界，为稳定性（能量不增加）得出一个精确的显式时间步长约束。该界必须依赖于整个域上 $\\,\\bar{\\bar{\\epsilon}}\\,$ 的最小特征值以及网格间距 $\\,\\Delta x\\,$, $\\,\\Delta y\\,$ 和 $\\,\\Delta z\\,$。\n\n假设磁导率 $\\,\\mu\\,$ 是一个空间均匀的正标量。令 $\\,\\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))\\,$ 表示张量在位置 $\\,\\mathbf{r}\\,$ 处的最小特征值，并定义全局最小值 $\\,\\epsilon_{\\min} = \\min_{\\mathbf{r}} \\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))\\,$。局部特征速度为 $\\,c(\\mathbf{r}) = 1/\\sqrt{\\mu\\,\\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))}\\,$，最坏情况下的速度为 $\\,c_{\\max} = 1/\\sqrt{\\mu\\,\\epsilon_{\\min}}\\,$。您的推导必须表明，显式时间步长约束采用精确的 Yee 网格形式 $$\\Delta t \\le \\frac{1}{c_{\\max}\\,\\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2}}\\;,$$ 并解释为什么通过梯形（时间中心）项处理的 $\\,\\sigma(\\mathbf{r})\\,$ 不会进一步限制 $\\,\\Delta t\\,$，而是仅贡献严格的耗散项。\n\n您的程序必须为一组测试用例实现计算出的界限 $\\,\\Delta t_{\\max}\\,$。对于每个测试用例，您将获得网格间距、一个均匀的标量 $\\,\\mu\\,$、域中代表性单元的一系列 $\\,\\bar{\\bar{\\epsilon}}\\,$ 张量，以及一系列标量电导率 $\\,\\sigma(\\mathbf{r})\\,$（可能在单元之间变化）。您的程序应计算 $\\,\\epsilon_{\\min}\\,$ 作为所提供张量的最小特征值中的最小值，然后使用推导出的界限计算 $\\,\\Delta t_{\\max}\\,$。输出必须是一行，包含一个用方括号括起来的逗号分隔的结果列表。\n\n所有答案必须以秒为单位，表示为十进制数，并严格按照下述输出格式聚合为单行。\n\n测试套件：\n\n- 情况1（一般3D，中等各向异性，中等电导率）：$\\,\\Delta x = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$；$\\,\\mu = \\mu_0\\,$；三个张量 $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(2\\epsilon_0,3\\epsilon_0,4\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(2.5\\epsilon_0,2.5\\epsilon_0,2.5\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_3 = \\mathrm{diag}\\left(3\\epsilon_0,4\\epsilon_0,5\\epsilon_0\\right)\\,$；电导率 $\\,\\sigma = [0,10^3,5\\times 10^3]\\,\\mathrm{S/m}\\,$.\n- 情况2（高电导率，低介电常数极端情况）：$\\,\\Delta x = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$；$\\,\\mu = \\mu_0\\,$；张量 $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(\\epsilon_0,2\\epsilon_0,5\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(1.2\\epsilon_0,3\\epsilon_0,4\\epsilon_0\\right)\\,$；电导率 $\\,\\sigma = [10^8,10^6]\\,\\mathrm{S/m}\\,$.\n- 情况3（具有非常小特征值的强各向异性）：$\\,\\Delta x = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$；$\\,\\mu = \\mu_0\\,$；张量 $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(0.5\\epsilon_0,2\\epsilon_0,2\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(0.6\\epsilon_0,1.8\\epsilon_0,2.2\\epsilon_0\\right)\\,$；电导率 $\\,\\sigma = [10^4,10^5]\\,\\mathrm{S/m}\\,$.\n- 情况4（具有薄层的高度非均匀网格）：$\\,\\Delta x = 5.0\\times 10^{-4}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 5.0\\times 10^{-4}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 5.0\\times 10^{-5}\\,\\mathrm{m}\\,$；$\\,\\mu = \\mu_0\\,$；张量 $\\,\\bar{\\bar{\\epsilon}} = \\mathrm{diag}\\left(3\\epsilon_0,3\\epsilon_0,3\\epsilon_0\\right)\\,$；电导率 $\\,\\sigma = [10^3]\\,\\mathrm{S/m}\\,$.\n\n常量：$\\,\\epsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}\\,$, $\\,\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}\\,$。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。例如，$\\,\\left[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4\\right]\\,$。\n- 每个 $\\,\\Delta t_i\\,$ 必须是代表秒的浮点数。\n\n不需要外部输入；测试套件已嵌入程序中。设计和推导必须基于第一性原理，并避免使用未从离散能量论证中推导出的快捷公式。", "solution": "该问题是有效的，因为它提法恰当，科学上基于麦克斯韦理论和标准数值方法，并为获得唯一解提供了完整的数据和要求。我们着手进行推导和实现。\n\n解决方案需要三个主要部分：\n1.  为指定的各向异性有损介质建立时域有限差分（FDTD）更新方程。\n2.  推导离散能量平衡（Poynting 定理），并解释电导率的隐式处理如何在不影响时间步长约束的情况下导致能量耗散。\n3.  从系统的能量动态特性推导数值稳定性的精确时间步长（$\\Delta t$）约束。\n\n### FDTD 更新方程\n\n我们从各向异性有损介质中的时域麦克斯韦方程组开始：\n$$ \\partial_t \\mathbf{D} + \\mathbf{J}_c = \\nabla \\times \\mathbf{H} \\quad (1) $$\n$$ \\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E} \\quad (2) $$\n本构关系由以下公式给出：\n$$ \\mathbf{D} = \\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,\\mathbf{E} $$\n$$ \\mathbf{B} = \\mu\\,\\mathbf{H} $$\n$$ \\mathbf{J}_c = \\sigma(\\mathbf{r})\\,\\mathbf{E} $$\n将本构关系代入麦克斯韦方程组，并假设 $\\bar{\\bar{\\epsilon}}$、$\\mu$ 和 $\\sigma$ 不随时间变化，我们得到：\n$$ \\bar{\\bar{\\epsilon}}(\\mathbf{r}) \\frac{\\partial \\mathbf{E}}{\\partial t} + \\sigma(\\mathbf{r}) \\mathbf{E} = \\nabla \\times \\mathbf{H} \\quad (3) $$\n$$ \\mu \\frac{\\partial \\mathbf{H}}{\\partial t} = -\\nabla \\times \\mathbf{E} \\quad (4) $$\n我们在交错的 Yee 晶格上离散这些方程。时间被离散为 $t = n \\Delta t$。电场 $\\mathbf{E}$ 在整数时间步 $n$ 计算，磁场 $\\mathbf{H}$ 在半整数时间步 $n \\pm 1/2$ 计算。这形成了蛙跳式时间步进方案。\n\n**磁场 (H) 更新：**\n我们使用中心差分对时间导数在 $t = (n+1)\\Delta t$ 处进行离散化来处理方程 (4)：\n$$ \\mu \\frac{\\mathbf{H}^{n+3/2} - \\mathbf{H}^{n+1/2}}{\\Delta t} = -(\\nabla \\times \\mathbf{E})^{n+1} $$\n这产生了标准的显式蛙跳式 $\\mathbf{H}$ 更新：\n$$ \\mathbf{H}^{n+3/2} = \\mathbf{H}^{n+1/2} - \\frac{\\Delta t}{\\mu} (\\nabla \\times \\mathbf{E})^{n+1} $$\n\n**电场 (E) 更新：**\n我们通过将时间导数中心化在 $t = (n+1/2)\\Delta t$ 来离散化方程 (3)。问题指定对传导项 $\\sigma \\mathbf{E}$ 使用梯形（时间中心）法则。这意味着该项被评估为它在时间步 $n$ 和 $n+1$ 处值的平均值。\n$$ \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t} + \\sigma \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^n}{2} = (\\nabla \\times \\mathbf{H})^{n+1/2} $$\n为了获得 $\\mathbf{E}^{n+1}$ 的更新方程，我们重新排列各项：\n$$ \\left(\\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t} + \\frac{\\sigma}{2}\\bar{\\bar{I}}\\right) \\mathbf{E}^{n+1} = \\left(\\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t} - \\frac{\\sigma}{2}\\bar{\\bar{I}}\\right) \\mathbf{E}^n + (\\nabla \\times \\mathbf{H})^{n+1/2} $$\n乘以 $\\Delta t$，我们得到：\n$$ \\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^{n+1} = \\left(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^n + \\Delta t (\\nabla \\times \\mathbf{H})^{n+1/2} $$\n这给出了 $\\mathbf{E}^{n+1}$ 的半隐式更新方程：\n$$ \\mathbf{E}^{n+1} = \\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right)^{-1} \\left[ \\left(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^n + \\Delta t (\\nabla \\times \\mathbf{H})^{n+1/2} \\right] $$\n如规定，此更新涉及在定义 $\\mathbf{E}$ 的每个单元中对矩阵 $\\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right)$ 进行求逆。由于 $\\bar{\\bar{\\epsilon}}$ 是对称正定（SPD）且 $\\sigma \\ge 0$，该矩阵总是可逆的。\n\n### 离散 Poynting 定理与电导率的作用\n\n可以推导出一个离散能量平衡来分析该方案的稳定性。问题将时间步 $n$ 的离散能量泛函定义为：\n$$ W^n = \\frac{1}{2}\\sum_{\\text{cells}} \\mathbf{E}^n \\cdot \\bar{\\bar{\\epsilon}}\\,\\mathbf{E}^n + \\frac{1}{2}\\sum_{\\text{faces}} \\mu\\,|\\mathbf{H}^{n+\\frac{1}{2}}|^2 $$\n其中求和遍及所有网格单元/面，并隐式地包含了单元体积 $\\Delta V$。能量的变化为 $W^{n+1} - W^n$。我们逐项分析这个变化。\n$$ \\Delta W_E = \\frac{1}{2}\\sum \\left(\\mathbf{E}^{n+1}\\cdot\\bar{\\bar{\\epsilon}}\\mathbf{E}^{n+1} - \\mathbf{E}^n\\cdot\\bar{\\bar{\\epsilon}}\\mathbf{E}^n\\right) = \\frac{1}{2}\\sum (\\mathbf{E}^{n+1}-\\mathbf{E}^n)\\cdot\\bar{\\bar{\\epsilon}}(\\mathbf{E}^{n+1}+\\mathbf{E}^n) $$\n从安培定律的离散化，我们有 $\\bar{\\bar{\\epsilon}}(\\mathbf{E}^{n+1}-\\mathbf{E}^n) = \\Delta t (\\nabla\\times\\mathbf{H})^{n+1/2} - \\frac{\\Delta t \\sigma}{2}(\\mathbf{E}^{n+1}+\\mathbf{E}^n)$。代入此式：\n$$ \\Delta W_E = \\frac{1}{2}\\sum \\left( \\Delta t (\\nabla\\times\\mathbf{H})^{n+1/2} - \\frac{\\Delta t \\sigma}{2}(\\mathbf{E}^{n+1}+\\mathbf{E}^n) \\right) \\cdot (\\mathbf{E}^{n+1}+\\mathbf{E}^n) $$\n$$ \\Delta W_E = \\Delta t \\sum (\\nabla\\times\\mathbf{H})^{n+1/2} \\cdot \\mathbf{E}^{n+1/2} - \\Delta t \\sum \\sigma |\\mathbf{E}^{n+1/2}|^2 $$\n其中我们使用简写 $\\mathbf{E}^{n+1/2} = (\\mathbf{E}^{n+1}+\\mathbf{E}^n)/2$。\n\n磁能的变化为：\n$$ \\Delta W_H = \\frac{1}{2}\\sum \\mu \\left(|\\mathbf{H}^{n+3/2}|^2 - |\\mathbf{H}^{n+1/2}|^2\\right) = \\frac{1}{2}\\sum \\mu (\\mathbf{H}^{n+3/2}-\\mathbf{H}^{n+1/2})\\cdot(\\mathbf{H}^{n+3/2}+\\mathbf{H}^{n+1/2}) $$\n根据法拉第定律，$\\mathbf{H}^{n+3/2}-\\mathbf{H}^{n+1/2} = -\\frac{\\Delta t}{\\mu}(\\nabla\\times\\mathbf{E})^{n+1}$。代入此式：\n$$ \\Delta W_H = -\\Delta t \\sum (\\nabla\\times\\mathbf{E})^{n+1} \\cdot \\mathbf{H}^{n+1} $$\n其中 $\\mathbf{H}^{n+1} = (\\mathbf{H}^{n+3/2}+\\mathbf{H}^{n+1/2})/2$。\n总能量变化为 $W^{n+1}-W^n = \\Delta W_E + \\Delta W_H$。使用向量恒等式 $\\sum (\\nabla\\times\\mathbf{A})\\cdot\\mathbf{B} = \\sum \\mathbf{A}\\cdot(\\nabla\\times\\mathbf{B}) + \\text{通量项}$ 的离散版本，我们得到：\n$$ W^{n+1}-W^n = \\Delta t \\sum \\left[ \\mathbf{H}^{n+1/2}\\cdot(\\nabla\\times\\mathbf{E})^{n+1/2} - \\mathbf{H}^{n+1}\\cdot(\\nabla\\times\\mathbf{E})^{n+1} \\right] - \\Delta t \\sum \\sigma|\\mathbf{E}^{n+1/2}|^2 - \\text{Flux}^{n+1/2} $$\n在周期性边界条件下，通量项消失。第二项，$-\\Delta t \\sum \\sigma|\\mathbf{E}^{n+1/2}|^2$，是由于电导率引起的能量耗散，由于 $\\sigma \\ge 0$，该项始终为非正。此项代表以热量形式损失的能量。\n\n对电导率项的隐式（梯形）处理使该方案的这一部分无条件稳定。更新可以写为 $\\mathbf{E}^{n+1}_{\\text{lossy part}} = (\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}})^{-1}(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}}) \\mathbf{E}^n$。令 $\\mathbf{M} = \\bar{\\bar{\\epsilon}}^{-1/2}(\\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}})\\bar{\\bar{\\epsilon}}^{-1/2}$。由于 $\\bar{\\bar{\\epsilon}}$ 是对称正定（SPD）的，所以 $\\bar{\\bar{\\epsilon}}^{-1/2}$ 也是，并且 $\\mathbf{M}$ 是具有实正特征值 $\\lambda_M  0$ 的对称正定矩阵。放大算子类似于 $(\\mathbf{I}+\\mathbf{M})^{-1}(\\mathbf{I}-\\mathbf{M})$，这是一个 Cayley 变换。其特征值为 $\\frac{1-\\lambda_M}{1+\\lambda_M}$，其模严格小于 1。因此，传导步骤是一个压缩映射，确保了耗散和稳定性，并且不会对 $\\Delta t$ 施加其自身的上限。\n\n### 稳定性约束推导\n\n整个方案的稳定性由算法的显式、无损部分决定。能量平衡中的 $\\Delta t \\sum [ \\dots ]$ 项由于时间上的交错而不为零。为了推导一个精确的界，对整个二阶系统进行矩阵稳定性分析是最严谨的。我们首先考虑无损情况（$\\sigma=0$）。\n这两个一阶更新方程可以合并为关于 $\\mathbf{E}$ 的一个二阶更新方程：\n$$ \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t} = \\nabla\\times\\mathbf{H}^{n+1/2} \\quad \\text{和} \\quad \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n} - \\mathbf{E}^{n-1}}{\\Delta t} = \\nabla\\times\\mathbf{H}^{n-1/2} $$\n将两者相减得到：\n$$ \\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t}(\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}) = \\frac{1}{\\Delta t}\\nabla\\times(\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-1/2}) $$\n代入 H 更新式 $\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-1/2} = - \\frac{\\Delta t}{\\mu}(\\nabla\\times\\mathbf{E})^n$:\n$$ \\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t}(\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}) = \\frac{1}{\\Delta t}\\nabla\\times\\left(-\\frac{\\Delta t}{\\mu}\\nabla\\times\\mathbf{E}^n\\right) $$\n$$ \\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1} = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1}(\\nabla\\times\\nabla\\times\\mathbf{E}^n) $$\n设 $\\mathbf{E}^n(\\mathbf{r}) = \\mathbf{E}_0 e^{j(\\omega n\\Delta t - \\mathbf{k}\\cdot\\mathbf{r})}$。在 Yee 网格上的离散旋度算子在傅里叶域中对应于乘以 $j\\tilde{\\mathbf{k}}$，其中 $\\tilde{k}_x = \\frac{2}{\\Delta x}\\sin(k_x \\Delta x/2)$，依此类推。时间上的中心差分变为 $(e^{j\\omega\\Delta t} - 2 + e^{-j\\omega\\Delta t}) = -4\\sin^2(\\omega\\Delta t/2)$。\n$$ -4\\sin^2(\\omega\\Delta t/2)\\mathbf{E}_0 = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1} (j\\tilde{\\mathbf{k}}\\times(j\\tilde{\\mathbf{k}}\\times\\mathbf{E}_0)) = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1}(-\\tilde{k}^2 \\mathbf{E}_0 + \\tilde{\\mathbf{k}}(\\tilde{\\mathbf{k}}\\cdot\\mathbf{E}_0))$$\n为保证数值稳定性，$\\omega\\Delta t$ 必须为实数，这意味着 $\\sin^2(\\omega\\Delta t/2) \\leq 1$。\n$$ \\sin^2(\\frac{\\omega\\Delta t}{2}) = \\frac{\\Delta t^2}{4\\mu} \\frac{\\mathbf{E}_0 \\cdot \\bar{\\bar{\\epsilon}}^{-1}(\\tilde{k}^2\\mathbf{E}_0 - \\tilde{\\mathbf{k}}(\\tilde{\\mathbf{k}}\\cdot\\mathbf{E}_0))}{\\mathbf{E}_0 \\cdot \\mathbf{E}_0} \\le 1 $$\n为了找到最严格的约束，我们必须在所有波矢 $\\mathbf{k}$ 和所有场极化 $\\mathbf{E}_0$ 上最大化右侧表达式。使表达式最大化的极化是 $\\bar{\\bar{\\epsilon}}^{-1}$ 对应于其最大特征值的特征向量，该最大特征值为 $1/\\lambda_{\\min}(\\bar{\\bar{\\epsilon}})$。设整个域上的这个最小特征值为 $\\epsilon_{\\min}$。该项的最大值则受限于：\n$$ \\max \\frac{\\lambda_{\\max}(\\bar{\\bar{\\epsilon}}^{-1}) \\cdot \\lambda_{\\max}(\\tilde{k}^2\\mathbf{I} - \\tilde{\\mathbf{k}}\\tilde{\\mathbf{k}}^T)}{\\mu} = \\frac{1}{\\mu\\epsilon_{\\min}} \\max_{\\mathbf{k}}(|\\tilde{\\mathbf{k}}|^2) = c_{\\max}^2 \\max_{\\mathbf{k}}(|\\tilde{\\mathbf{k}}|^2) $$\n其中 $c_{\\max} = 1/\\sqrt{\\mu\\epsilon_{\\min}}$。$|\\tilde{\\mathbf{k}}|^2$ 的最大值在 $\\sin^2$ 项为 1 时出现：\n$$ \\max(|\\tilde{\\mathbf{k}}|^2) = \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 $$\n将此代入稳定性条件 $\\sin^2(\\omega\\Delta t/2) \\le 1$：\n$$ \\frac{\\Delta t^2}{4} c_{\\max}^2 \\left( \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 \\right) \\le 1 $$\n$$ \\Delta t^2 c_{\\max}^2 \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} \\right) \\le 1 $$\n这就得出了各向异性 Yee 方案的精确 Courant-Friedrichs-Lewy (CFL) 稳定性条件：\n$$ \\Delta t \\le \\frac{1}{c_{\\max} \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2}} $$\n这证实了所要求的表达式。如前所示，来自 $\\sigma$ 的耗散项只移除能量，因此这个为无损情况推导出的界，对于有损情况仍然是其约束条件。", "answer": "[2.723536531311e-12,1.925833316267e-12,2.723536531311e-12,2.862269584340e-13]", "id": "3295110"}]}