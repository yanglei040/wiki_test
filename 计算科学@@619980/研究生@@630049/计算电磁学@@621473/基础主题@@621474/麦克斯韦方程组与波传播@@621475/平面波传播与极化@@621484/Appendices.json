{"hands_on_practices": [{"introduction": "理解偏振是波动物理学的基础。本练习将引导您从线性分量的叠加出发，推导出椭圆偏振波的数学描述——偏振椭圆。通过完成这一推导并将其应用于一个具体案例，您将巩固对振幅和相位差如何决定偏振状态的理解。[@problem_id:3341066]", "problem": "一个时谐、无源的平面电磁波在均匀、各向同性、无损耗的介质中沿 $+z$ 方向传播。在空间中的一个固定点，横向平面内的瞬时电场矢量由两个正交分量的叠加给出\n$$\nE_{x}(t)=E_{0x}\\cos\\left(\\omega t-kz\\right),\\qquad E_{y}(t)=E_{0y}\\cos\\left(\\omega t-kz+\\delta\\right),\n$$\n其中 $E_{0x}>0$，$E_{0y}>0$，且相位差 $\\delta$ 为实数。通过这两个谐波分量的叠加，电场矢量的顶端在 $xy$ 平面内描绘出一个极化椭圆。\n\n从上述表示出发，并仅利用以下基本定律：(i) 均匀介质中的麦克斯韦方程组允许具有横向场的平面波解；(ii) 瞬时场是时谐相量的实部，推导极化椭圆在 $E_{x}$ 和 $E_{y}$ 中的二次型隐式方程。然后，通过对该二次型进行对角化，得到以 $E_{0x}$、$E_{0y}$ 和 $\\delta$ 表示的长半轴和短半轴长度的通用表达式，并确定在固定 $z$ 处场矢量随时间增加的旋转方向。\n\n将您的结果应用于 $E_{0x}=2~\\text{V/m}$，$E_{0y}=1~\\text{V/m}$ 和 $\\delta=\\pi/2$ 的情况。报告：\n- 长半轴长度 $a$，\n- 短半轴长度 $b$，\n- 以及一个标量旋转方向代码 $s$，定义为：当沿传播方向 $+z$ 看去时，顺时针旋转（根据电气和电子工程师协会 (IEEE) 约定为右手）时 $s=+1$，逆时针旋转（根据 IEEE 约定为左手）时 $s=-1$。\n\n将 $a$ 和 $b$ 以 $\\text{V/m}$ 为单位表示。以行矩阵 $\\begin{pmatrix}a  b  s\\end{pmatrix}$ 的形式给出您的最终结果，使用精确值（不进行四舍五入）。", "solution": "首先将对问题陈述的科学合理性、一致性和完整性进行验证。\n\n### 步骤 1：提取已知条件\n- **波类型**: 时谐、无源平面电磁波。\n- **介质**: 均匀、各向同性、无损耗。\n- **传播方向**: 沿 $+z$ 方向。\n- **电场分量**: 在空间中的一个固定点，瞬时横向电场分量为：\n  - $E_{x}(t)=E_{0x}\\cos\\left(\\omega t-kz\\right)$\n  - $E_{y}(t)=E_{0y}\\cos\\left(\\omega t-kz+\\delta\\right)$\n- **参数**: $E_{0x}>0$，$E_{0y}>0$，$\\delta$ 为实相位差。\n- **推导要求**:\n  1. 推导极化椭圆在 $E_x$ 和 $E_y$ 中的二次型隐式方程。\n  2. 通过对该二次型进行对角化，得到以 $E_{0x}$、$E_{0y}$ 和 $\\delta$ 表示的长半轴 ($a$) 和短半轴 ($b$) 长度的通用表达式。\n  3. 确定在固定 $z$ 处场矢量随时间增加的旋转方向。\n- **特定情况**:\n  - $E_{0x}=2~\\text{V/m}$\n  - $E_{0y}=1~\\text{V/m}$\n  - $\\delta=\\pi/2$\n- **要求输出**: 对于特定情况，报告：\n  - 长半轴长度 $a$。\n  - 短半轴长度 $b$。\n  - 旋转方向代码 $s$，其中当沿传播方向看去时，顺时针（CW，右手）旋转为 $s=+1$，逆时针（CCW，左手）旋转为 $s=-1$。\n- **结果格式**: 行矩阵 $\\begin{pmatrix}a  b  s\\end{pmatrix}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是电磁波极化研究中的一个标准练习，是物理学和工程学中的一个核心课题。\n- **科学依据**: 该问题基于麦克斯韦方程组及其平面波解，这些是经典电磁学的基本原理。将椭圆极化波表示为两个正交线性极化分量的叠加是一种标准且正确的表述。\n- **适定性**: 该问题提供了推导所求量所需的所有信息。分量振幅和相位差之间的关系，以及极化椭圆的性质，都有明确的定义。存在一个唯一、稳定且有意义的解。\n- **客观性**: 语言精确且定量。对旋转方向代码 $s$ 和观察约定 (IEEE) 的定义都已明确说明，消除了歧义。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。这是一个定义明确、自成体系且科学合理的电磁学领域问题。我将继续进行求解。\n\n### 极化椭圆方程的推导\n让我们分析一个固定平面（例如 $z=0$）上的场。对 $z$ 的依赖性可以被吸收到时间原点的相移中，因此这个选择不影响椭圆的形状或方向。令 $\\phi = \\omega t - kz$。场分量为：\n$$\nE_x = E_{0x}\\cos(\\phi) \\label{eq:1}\n$$\n$$\nE_y = E_{0y}\\cos(\\phi + \\delta) \\label{eq:2}\n$$\n从第一个方程，我们有 $\\cos(\\phi) = \\frac{E_x}{E_{0x}}$。我们还知道 $\\sin(\\phi) = \\pm\\sqrt{1-\\cos^2(\\phi)} = \\pm\\sqrt{1-(\\frac{E_x}{E_{0x}})^2}$。\n使用余弦和角公式展开第二个方程：\n$$\nE_y = E_{0y}(\\cos\\phi\\cos\\delta - \\sin\\phi\\sin\\delta)\n$$\n两边除以 $E_{0y}$ 并代入 $\\cos\\phi$：\n$$\n\\frac{E_y}{E_{0y}} = \\frac{E_x}{E_{0x}}\\cos\\delta - \\sin\\phi\\sin\\delta\n$$\n分离出 $\\sin\\phi$ 项并两边平方：\n$$\n\\left(\\frac{E_y}{E_{0y}} - \\frac{E_x}{E_{0x}}\\cos\\delta\\right)^2 = (\\sin\\phi\\sin\\delta)^2 = \\sin^2\\phi\\sin^2\\delta\n$$\n代入 $\\sin^2\\phi = 1 - (\\frac{E_x}{E_{0x}})^2$：\n$$\n\\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_x}{E_{0x}}\\right)^2\\cos^2\\delta = \\left(1 - \\left(\\frac{E_x}{E_{0x}}\\right)^2\\right)\\sin^2\\delta\n$$\n$$\n\\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_x}{E_{0x}}\\right)^2\\cos^2\\delta = \\sin^2\\delta - \\left(\\frac{E_x}{E_{0x}}\\right)^2\\sin^2\\delta\n$$\n合并包含 $E_x^2$ 的项：\n$$\n\\left(\\frac{E_x}{E_{0x}}\\right)^2(\\cos^2\\delta + \\sin^2\\delta) + \\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta = \\sin^2\\delta\n$$\n使用恒等式 $\\cos^2\\delta + \\sin^2\\delta = 1$，我们得到极化椭圆的隐式方程：\n$$\n\\left(\\frac{E_x}{E_{0x}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_y}{E_{0y}}\\right)^2 = \\sin^2\\delta\n$$\n这是一个关于 $E_x$ 和 $E_y$ 的二次型，符合要求。\n\n### 长半轴和短半轴的推导\n问题要求通过对角化二次型来推导半轴。一个等效且物理上更直观的方法是，找出电场矢量大小的平方 $E^2 = E_x^2 + E_y^2$ 随时间演变的最小值和最大值。这些极值分别对应于短半轴 ($b$) 和长半轴 ($a$) 的平方。这个过程在数学上等同于使系统对角化的几何旋转。\n\n令 $I(\\phi) = E^2(\\phi) = E_x^2(\\phi) + E_y^2(\\phi)$。\n$$\nI(\\phi) = E_{0x}^2\\cos^2\\phi + E_{0y}^2\\cos^2(\\phi+\\delta)\n$$\n使用恒等式 $\\cos^2\\theta = \\frac{1+\\cos(2\\theta)}{2}$：\n$$\nI(\\phi) = \\frac{E_{0x}^2}{2}(1+\\cos(2\\phi)) + \\frac{E_{0y}^2}{2}(1+\\cos(2\\phi+2\\delta))\n$$\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[E_{0x}^2\\cos(2\\phi) + E_{0y}^2\\cos(2\\phi+2\\delta)]\n$$\n展开最后一项：\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[E_{0x}^2\\cos(2\\phi) + E_{0y}^2(\\cos(2\\phi)\\cos(2\\delta) - \\sin(2\\phi)\\sin(2\\delta))]\n$$\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[\\cos(2\\phi)(E_{0x}^2+E_{0y}^2\\cos(2\\delta)) - \\sin(2\\phi)(E_{0y}^2\\sin(2\\delta))]\n$$\n这个表达式的形式为 $C_0 + C_1\\cos(2\\phi) - C_2\\sin(2\\phi)$，它描述了一个正弦波。其极值为 $C_0 \\pm \\sqrt{C_1^2+C_2^2}$。随时间变化部分的振幅为：\n$$\nR = \\frac{1}{2}\\sqrt{(E_{0x}^2+E_{0y}^2\\cos(2\\delta))^2 + (E_{0y}^2\\sin(2\\delta))^2}\n$$\n$$\nR = \\frac{1}{2}\\sqrt{E_{0x}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta) + E_{0y}^4\\cos^2(2\\delta) + E_{0y}^4\\sin^2(2\\delta)}\n$$\n$$\nR = \\frac{1}{2}\\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\n$$\n$I(\\phi)$ 的最大值和最小值是半轴的平方，$a^2$ 和 $b^2$：\n$$\na^2 = I_{max} = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + R = \\frac{1}{2}\\left(E_{0x}^2+E_{0y}^2 + \\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\\right)\n$$\n$$\nb^2 = I_{min} = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) - R = \\frac{1}{2}\\left(E_{0x}^2+E_{0y}^2 - \\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\\right)\n$$\n取平方根即可得到长半轴 $a$ 和短半轴 $b$ 的长度。\n\n### 旋转方向的确定\n在固定位置 $z$ 处，随着时间 $t$ 增加，旋转方向可以通过检查叉积 $\\mathbf{E}(t) \\times \\frac{d\\mathbf{E}(t)}{dt}$ 的 $z$ 分量的符号来确定。矢量 $\\frac{d\\mathbf{E}(t)}{dt}$ 与 $\\mathbf{E}(t)$ 顶端的路径相切。正的 $z$ 分量对应于逆时针（CCW）旋转（从 $+x$ 到 $+y$），负的 $z$ 分量对应于顺时针（CW）旋转。\n\n令 $\\phi(t) = \\omega t - kz$。速度矢量为 $\\frac{d\\mathbf{E}}{dt} = \\omega\\frac{d\\mathbf{E}}{d\\phi}$。\n$\\frac{dE_x}{d\\phi} = -E_{0x}\\sin\\phi$ 且 $\\frac{dE_y}{d\\phi} = -E_{0y}\\sin(\\phi+\\delta)$。\n$\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}$ 的 $z$ 分量是：\n$$\n\\left(\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}\\right)_z = E_x \\frac{dE_y}{d\\phi} - E_y \\frac{dE_x}{d\\phi}\n$$\n$$\n= (E_{0x}\\cos\\phi)(-E_{0y}\\sin(\\phi+\\delta)) - (E_{0y}\\cos(\\phi+\\delta))(-E_{0x}\\sin\\phi)\n$$\n$$\n= -E_{0x}E_{0y}[\\cos\\phi\\sin(\\phi+\\delta) - \\cos(\\phi+\\delta)\\sin\\phi]\n$$\n使用三角恒等式 $\\sin(A-B) = \\sin A\\cos B - \\cos A\\sin B$，其中 $A = \\phi+\\delta$，$B = \\phi$：\n$$\n\\left(\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}\\right)_z = -E_{0x}E_{0y}\\sin((\\phi+\\delta)-\\phi) = -E_{0x}E_{0y}\\sin\\delta\n$$\n$\\mathbf{E} \\times \\frac{d\\mathbf{E}}{dt}$ 的相应分量是 $\\omega(-E_{0x}E_{0y}\\sin\\delta)$。由于 $E_{0x}, E_{0y}, \\omega$ 均为正值，符号完全由 $-\\sin\\delta$ 决定。\n- 如果 $\\sin\\delta > 0$，叉积方向为 $-z$ 方向，表示**顺时针 (CW)** 旋转。\n- 如果 $\\sin\\delta < 0$，叉积方向为 $+z$ 方向，表示**逆时针 (CCW)** 旋转。\n- 如果 $\\sin\\delta = 0$，则为线极化，没有旋转。\n\n根据问题的定义（顺时针为 $s=+1$，逆时针为 $s=-1$），旋转方向代码为 $s = \\text{sgn}(\\sin\\delta)$。\n\n### 应用于给定情况\n我们已知 $E_{0x}=2~\\text{V/m}$，$E_{0y}=1~\\text{V/m}$，以及 $\\delta=\\pi/2$。\n\n**半轴 $a$ 和 $b$**：\n对于 $\\delta = \\pi/2$，我们有 $2\\delta=\\pi$，所以 $\\cos(2\\delta) = \\cos(\\pi) = -1$。\n$$\na^2 = \\frac{1}{2}\\left(2^2+1^2 + \\sqrt{2^4+1^4+2(2^2)(1^2)(-1)}\\right)\n$$\n$$\na^2 = \\frac{1}{2}\\left(4+1 + \\sqrt{16+1-8}\\right) = \\frac{1}{2}\\left(5 + \\sqrt{9}\\right) = \\frac{1}{2}(5+3) = 4\n$$\n$$\na = \\sqrt{4} = 2~\\text{V/m}\n$$\n$$\nb^2 = \\frac{1}{2}\\left(2^2+1^2 - \\sqrt{2^4+1^4+2(2^2)(1^2)(-1)}\\right)\n$$\n$$\nb^2 = \\frac{1}{2}\\left(5 - \\sqrt{9}\\right) = \\frac{1}{2}(5-3) = 1\n$$\n$$\nb = \\sqrt{1} = 1~\\text{V/m}\n$$\n对于这个特殊情况，有一个更简单的检验方法：当 $\\delta=\\pm\\pi/2$ 时，$\\cos\\delta=0$，椭圆方程变为 $\\left(\\frac{E_x}{E_{0x}}\\right)^2 + \\left(\\frac{E_y}{E_{0y}}\\right)^2 = 1$。这是一个轴与坐标轴对齐的椭圆方程，其半轴等于 $E_{0x}$ 和 $E_{0y}$。长半轴 $a$ 是两者中较大的一个，短半轴 $b$ 是较小的一个。因此，$a = \\max(E_{0x}, E_{0y}) = 2~\\text{V/m}$ 且 $b = \\min(E_{0x}, E_{0y}) = 1~\\text{V/m}$。这证实了结果。\n\n**旋转方向代码 $s$**：\n旋转方向由 $s = \\text{sgn}(\\sin\\delta)$ 给出。\n对于 $\\delta=\\pi/2$，$\\sin\\delta = \\sin(\\pi/2) = 1$。\n$$\ns = \\text{sgn}(1) = +1\n$$\n这表示顺时针（右手）旋转。\n\n最终结果是包含计算值的行矩阵 $\\begin{pmatrix}a  b  s\\end{pmatrix}$。\n$a=2$，$b=1$，$s=1$。", "answer": "$$\\boxed{\\begin{pmatrix} 2  1  1 \\end{pmatrix}}$$", "id": "3341066"}, {"introduction": "当一个有限光束经历全内反射时，它会产生一个几何光学无法预测的横向位移，即古斯-汉欣效应 (Goos-Hänchen effect)。本练习要求您从第一性原理出发，通过对平面波角谱使用稳相法来推导该位移。这项实践有助于深入理解光的波动性以及波与物质在界面相互作用时的精细现象。[@problem_id:3341028]", "problem": "一束自由空间波长为 $\\lambda_{0}$ 的单色高斯光束，在折射率为 $n_{1}$ 的无损耗、均匀、各向同性、非磁性电介质中传播，并入射到与折射率为 $n_{2}$ 的低折射率电介质的平面界面上，其中 $n_{1} > n_{2}$。偏振为横电（TE）偏振，意味着电场垂直于入射面。入射角 $\\theta_{i}$ 略大于由 $\\sin(\\theta_{c}) = n_{2}/n_{1}$ 定义的临界角 $\\theta_{c}$，具体为 $\\theta_{i} = \\theta_{c} + 0.5$ 度。所有用于微积分运算的角度都必须以弧度为单位。假设光束的角谱很窄，以便稳相近似适用于反射场。\n\n从无源介质中的麦克斯韦方程组和界面处的切向场边界条件出发，推导全内反射条件下的TE菲涅耳反射系数及其作为 $\\theta_{i}$ 函数的相位。然后，将反射光束建模为平面波的角谱叠加，并使用稳相原理，获得沿界面的光束质心 Goos–Hänchen 横向位移 $\\Delta$ 的闭式解析表达式，该表达式用 $n_{1}$、$n_{2}$、$\\theta_{i}$ 和自由空间波数 $k_{0} = 2\\pi/\\lambda_{0}$ 表示。对 $n_{1} = 1.5$、$n_{2} = 1.0$ 和 $\\lambda_{0} = 633$ nm 的情况，数值计算 $\\Delta$。以微米为单位表示最终的横向位移，并将答案四舍五入到两位有效数字。", "solution": "用户在计算电磁学领域提供了一个有效的问题陈述，具体涉及高斯光束发生全内反射（TIR）时的 Goos–Hänchen 效应。我将进行完整的推导和解答。\n\n该问题分三部分解决：\n1.  全内反射条件下 TE 菲涅耳反射系数 $r_{TE}$ 及其相位 $\\phi_{TE}$ 的推导。\n2.  使用稳相近似推导 Goos–Hänchen 横向位移 $\\Delta$。\n3.  对给定参数数值计算 $\\Delta$。\n\n### 第1部分：TE菲涅耳反射系数及相位\n\n我们从无源、无损耗、非磁性、各向同性介质中的时谐麦克斯韦方程组开始：\n$$ \\nabla \\times \\vec{E} = i\\omega\\mu_0 \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = -i\\omega\\epsilon \\vec{E} $$\n这些方程组合形成电场 $\\vec{E}$ 的亥姆霍兹方程：\n$$ \\nabla^2 \\vec{E} + k^2 \\vec{E} = 0 $$\n其中波数为 $k = n k_0$，$n$ 是折射率，$k_0 = 2\\pi/\\lambda_0$ 是自由空间波数。\n\n设两个电介质之间的界面为平面 $z=0$。介质1（$n_1$）位于区域 $z<0$，介质2（$n_2$）位于区域 $z>0$。入射面为 $xz$ 平面。对于横电（TE）偏振，电场垂直于入射面，即 $\\vec{E} = E_y \\hat{y}$。\n\n在界面处，我们考虑一个入射、一个反射和一个透射平面波：\n-   入射波：$\\vec{E}_i = \\hat{y} E_{0i} \\exp[i(k_{ix}x + k_{iz}z)]$\n-   反射波：$\\vec{E}_r = \\hat{y} E_{0r} \\exp[i(k_{rx}x + k_{rz}z)]$\n-   透射波：$\\vec{E}_t = \\hat{y} E_{0t} \\exp[i(k_{tx}x + k_{tz}z)]$\n\n相关的磁场由 $\\vec{H} = (i\\omega\\mu_0)^{-1} \\nabla \\times \\vec{E}$ 求得。我们只需要切向分量 $H_x$：\n$$ H_x = \\frac{1}{i\\omega\\mu_0} \\frac{\\partial E_y}{\\partial z} $$\n\n$z=0$ 处的边界条件要求 $\\vec{E}$ 和 $\\vec{H}$ 的切向分量是连续的。这意味着沿界面的相位匹配，$k_{ix} = k_{rx} = k_{tx} \\equiv k_x$。根据入射角为 $\\theta_i$ 的几何关系，我们有 $k_x = k_1 \\sin\\theta_i = n_1 k_0 \\sin\\theta_i$。波矢的 z 分量为 $k_{iz} = n_1 k_0 \\cos\\theta_i$，$k_{rz} = -n_1 k_0 \\cos\\theta_i$，以及 $k_{tz} = \\sqrt{k_2^2 - k_x^2} = k_0\\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}$。\n\n在 $z=0$ 处应用边界条件：\n1.  $E_y$ 的连续性：$E_{0i} + E_{0r} = E_{0t}$\n2.  $H_x$ 的连续性：$k_{iz} E_{0i} + k_{rz} E_{0r} = k_{tz} E_{0t}$\n\n将 $k_{iz} = -k_{rz} = n_1 k_0 \\cos\\theta_i$ 代入第二个方程：\n$$ n_1 k_0 \\cos\\theta_i (E_{0i} - E_{0r}) = k_{tz} E_{0t} $$\n令 $r_{TE} = E_{0r}/E_{0i}$ 和 $t_{TE} = E_{0t}/E_{0i}$，我们得到方程组：\n1.  $1 + r_{TE} = t_{TE}$\n2.  $n_1 k_0 \\cos\\theta_i (1 - r_{TE}) = k_{tz} (1 + r_{TE})$\n\n求解 $r_{TE}$：\n$$ r_{TE} = \\frac{n_1 k_0 \\cos\\theta_i - k_{tz}}{n_1 k_0 \\cos\\theta_i + k_{tz}} = \\frac{n_1 \\cos\\theta_i - \\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}}{n_1 \\cos\\theta_i + \\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}} $$\n当 $\\theta_i > \\theta_c$ 时发生全内反射（TIR），其中 $\\sin\\theta_c = n_2/n_1$。在这种情况下，$n_1 \\sin\\theta_i > n_2$，使得平方根内的项为负。透射波矢的 z 分量变为纯虚数：\n$$ k_{tz} = i k_0 \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2} \\equiv i\\alpha $$\n其中 $\\alpha = k_0 \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}$ 是实数且为正。透射波是在 $z>0$ 区域中指数衰减的隐失波。\n\n将 $k_{tz} = i\\alpha$ 代入 $r_{TE}$ 的表达式中：\n$$ r_{TE} = \\frac{n_1 k_0 \\cos\\theta_i - i\\alpha}{n_1 k_0 \\cos\\theta_i + i\\alpha} $$\n这是一个形如 $(A-iB)/(A+iB)$ 的复数，其模为 $|r_{TE}| = 1$，这与无损耗介质中全内反射的预期相符。反射是全反射，但它引入了一个相移 $\\phi_{TE}$。我们可以写成 $r_{TE} = \\exp(i\\phi_{TE})$。\n相位由下式给出：\n$$ \\phi_{TE} = \\arg(n_1 k_0 \\cos\\theta_i - i\\alpha) - \\arg(n_1 k_0 \\cos\\theta_i + i\\alpha) $$\n令 $\\tan\\delta = \\alpha / (n_1 k_0 \\cos\\theta_i)$，我们有 $\\phi_{TE} = -\\delta - \\delta = -2\\delta$。因此，TE 反射系数的相位是：\n$$ \\phi_{TE}(\\theta_i) = -2 \\arctan\\left(\\frac{\\alpha}{n_1 k_0 \\cos\\theta_i}\\right) = -2 \\arctan\\left(\\frac{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}}{n_1 \\cos\\theta_i}\\right) $$\n\n### 第2部分：Goos–Hänchen 位移\n\n像高斯光束这样的空间有限光束可以表示为平面波的叠加，每个平面波具有略微不同的入射角和相应的波矢分量 $k_x$。在界面 $z=0$ 处的反射光束轮廓 $E_r(x)$ 由傅里叶积分给出：\n$$ E_r(x) = \\int \\tilde{E}_i(k_x) r_{TE}(k_x) e^{ik_x x} dk_x $$\n其中 $\\tilde{E}_i(k_x)$ 是入射光束的角谱，$r_{TE}(k_x) = \\exp[i\\phi_{TE}(k_x)]$ 是每个平面波分量的反射系数。\n$$ E_r(x) = \\int \\tilde{E}_i(k_x) \\exp[i(k_x x + \\phi_{TE}(k_x))] dk_x $$\n稳相近似指出，对于以 $k_{x,0}$ 为中心的窄带谱，积分主要由相位稳相的点贡献。反射光束的质心位于位置 $x$ 处，该处总相位 $\\Phi(k_x) = k_x x + \\phi_{TE}(k_x)$ 相对于 $k_x$ 的导数为零：\n$$ \\frac{d\\Phi}{dk_x} = x + \\frac{d\\phi_{TE}}{dk_x} = 0 $$\n这给出了光束质心的横向位移 $\\Delta$ 为：\n$$ \\Delta = -\\left. \\frac{d\\phi_{TE}}{dk_x} \\right|_{k_x = k_{x,0}} $$\n其中 $k_{x,0} = n_1 k_0 \\sin\\theta_i$ 对应于中心入射角 $\\theta_i$。我们使用链式法则来计算导数：\n$$ \\Delta = -\\frac{d\\phi_{TE}}{d\\theta_i} \\frac{d\\theta_i}{dk_x} $$\n我们有 $k_x = n_1 k_0 \\sin\\theta_i$，所以 $\\frac{dk_x}{d\\theta_i} = n_1 k_0 \\cos\\theta_i$。因此，$\\frac{d\\theta_i}{dk_x} = \\frac{1}{n_1 k_0 \\cos\\theta_i}$。\n\n接下来，我们对 $\\phi_{TE}(\\theta_i)$ 求导：\n$$ \\frac{d\\phi_{TE}}{d\\theta_i} = \\frac{d}{d\\theta_i} \\left[ -2 \\arctan\\left(\\frac{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}}{n_1 \\cos\\theta_i}\\right) \\right] $$\n使用 $\\frac{d}{dx}\\arctan(u) = \\frac{u'}{1+u^2}$，并经过仔细计算（如思考过程中所示），该导数计算结果为：\n$$ \\frac{d\\phi_{TE}}{d\\theta_i} = - \\frac{2 n_1 \\sin\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\n将这些结果代入 $\\Delta$ 的表达式中：\n$$ \\Delta = - \\left( - \\frac{2 n_1 \\sin\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} \\right) \\left( \\frac{1}{n_1 k_0 \\cos\\theta_i} \\right) $$\n因子 $n_1$ 被消掉，得到 Goos-Hänchen 位移的闭式表达式：\n$$ \\Delta = \\frac{2 \\sin\\theta_i}{k_0 \\cos\\theta_i \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\n这也可以用 $\\lambda_0$ 和 $\\tan\\theta_i$ 来表示：\n$$ \\Delta = \\frac{\\lambda_0}{\\pi} \\frac{\\tan\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\n\n### 第3部分：数值计算\n\n我们有以下给定参数：\n-   $n_1 = 1.5$\n-   $n_2 = 1.0$\n-   $\\lambda_0 = 633 \\text{ nm} = 6.33 \\times 10^{-7} \\text{ m}$\n\n首先，我们计算临界角 $\\theta_c$：\n$$ \\sin\\theta_c = \\frac{n_2}{n_1} = \\frac{1.0}{1.5} = \\frac{2}{3} $$\n$$ \\theta_c = \\arcsin\\left(\\frac{2}{3}\\right) \\approx 41.8103^\\circ $$\n给定的入射角 $\\theta_i$ 为：\n$$ \\theta_i = \\theta_c + 0.5^\\circ \\approx 41.8103^\\circ + 0.5^\\circ = 42.3103^\\circ $$\n我们需要这个角度的三角函数值：\n$$ \\sin\\theta_i = \\sin(42.3103^\\circ) \\approx 0.67315 $$\n$$ \\cos\\theta_i = \\cos(42.3103^\\circ) \\approx 0.73943 $$\n自由空间波数为：\n$$ k_0 = \\frac{2\\pi}{\\lambda_0} = \\frac{2\\pi}{6.33 \\times 10^{-7} \\text{ m}} \\approx 9.926 \\times 10^6 \\text{ m}^{-1} $$\n现在我们计算分母项 $\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}$：\n$$ \\sqrt{(1.5)^2 (0.67315)^2 - (1.0)^2} = \\sqrt{2.25 \\times 0.45313 - 1.0} = \\sqrt{1.01954 - 1.0} = \\sqrt{0.01954} \\approx 0.13978 $$\n最后，我们将这些值代入 $\\Delta$ 的表达式中：\n$$ \\Delta = \\frac{2 \\times 0.67315}{(9.926 \\times 10^6 \\text{ m}^{-1}) \\times 0.73943 \\times 0.13978} $$\n$$ \\Delta = \\frac{1.3463}{1.026 \\times 10^6 \\text{ m}^{-1}} \\approx 1.312 \\times 10^{-6} \\text{ m} $$\n问题要求结果以微米为单位，并四舍五入到两位有效数字。\n$$ \\Delta \\approx 1.312 \\text{ µm} $$\n四舍五入到两位有效数字，得到：\n$$ \\Delta \\approx 1.3 \\text{ µm} $$", "answer": "$$\n\\boxed{1.3}\n$$", "id": "3341028"}, {"introduction": "在计算电磁学中，精确模拟开放边界是一项关键挑战，特别是对于可能引起不稳定的倏逝波。这项高级实践涉及设计和优化一种完美匹配层 (Perfectly Matched Layer, PML)，您需要从麦克斯韦方程组推导其特性，并实现一个算法来最小化反射。本练习将理论波动物理学与数值仿真工具的实际工程设计联系起来。[@problem_id:3341069]", "problem": "考虑一个基于伸展坐标完美匹配层 (PML) 的频域吸收半空间，用于形式为 $\\exp\\!\\left(i\\,q_x x + i\\,k_y y\\right)$ 且 $z$ 方向不变 ($k_z = 0$) 的二维平面波。设自由空间占据 $x < 0$ 区域，PML 占据 $x \\ge 0$ 区域。自由空间参数为 $ \\epsilon_0 $ (介电常数，单位 F/m)，$ \\mu_0 $ (磁导率，单位 H/m)，以及 $ c = 1/\\sqrt{\\epsilon_0 \\mu_0} $ (光速，单位 m/s)。角频率为 $ \\omega = 2\\pi f $，其中 $ f $ 的单位为 Hz。在 PML 内部，采用一个对角的复坐标伸展张量 $ \\mathbf{s} = \\mathrm{diag}(s_x, s_y, s_z) $，其中每个 $ s_\\alpha $ 都是无量纲的，且可能为复数。PML 中的等效各向异性材料张量（在主基下）通过复伸展变换得到，产生对角张量 $ \\bar{\\bar{\\epsilon}} = \\mathrm{diag}(\\epsilon_x, \\epsilon_y, \\epsilon_z) $ 和 $ \\bar{\\bar{\\mu}} = \\mathrm{diag}(\\mu_x, \\mu_y, \\mu_z) $。\n\n你的任务如下。\n\n1) 从频域 Maxwell 方程组和复坐标伸展变换出发，推导：\n- 用 $ \\epsilon_0, \\mu_0 $ 和 $ s_x, s_y, s_z $ 表示的 PML 材料张量分量 $ \\epsilon_x, \\epsilon_y, \\epsilon_z $ 和 $ \\mu_x, \\mu_y, \\mu_z $ 的表达式。\n- 对于 $ k_z = 0 $ 的两种解耦偏振，PML 中法向波数 $ q_x $ 的色散关系：\n  - 具有非零 $ E_z $ 的横电波（将此偏振记为 TE$_z$）。\n  - 具有非零 $ H_z $ 的横磁波（将此偏振记为 TM$_z$）。\n  色散关系必须仅用 $ \\epsilon_0, \\mu_0, \\epsilon_\\alpha, \\mu_\\alpha, \\omega, k_y $ 和 $ q_x $ 表示。\n- 对于每种偏振，推导在自由空间 ($ x < 0 $) 和 PML ($ x \\ge 0 $) 之间的单一界面上的切向场反射系数（相对于 $ x = 0 $ 处的切向电场振幅定义）的表达式。其中，自由空间中的倏逝入射波满足 $ q_{x1}^2 = k_0^2 - k_y^2 $，且 $ k_0 = \\omega \\sqrt{\\epsilon_0 \\mu_0} $。对于每种偏振，表达式应简化为仅含 $ \\epsilon_0, \\mu_0, \\epsilon_\\alpha, \\mu_\\alpha, \\omega, k_y, q_{x1}, q_{x2} $ 的闭合形式，其中 $ q_{x2} $ 是从相应色散关系中获得的 PML 中的适当法向波数。\n\n2) 使用你推导的表达式，设计一个算法，对于一个给定的固定法向伸展参数 $ s_x \\in \\mathbb{C} $，优化切向伸展参数 $ s_y $ 和 $ s_z $（限制为实数、严格为正，并从下面指定的离散候选集合中选择）。目标是在满足以下稳定性和物理性条件的前提下，最小化单一界面上两种反射系数（TE$_z$ 和 TM$_z$）的最坏情况（最大）幅值：\n- 入射波在自由空间中是倏逝波：$ k_y^2 > k_0^2 $。\n- 对于每种偏振，PML 中的透射波都随着 $ x \\to +\\infty $ 而衰减，即所选的 $ q_{x2} $ 分支必须对 TE$_z$ 和 TM$_z$ 均满足 $ \\operatorname{Im}(q_{x2}) > 0 $。\n- 伸展因子 $ s_y $ 和 $ s_z $ 必须位于一个预设的离散集合 $ \\mathcal{S} $ 中，该集合包含大于 $ 1 $ 的实数值（如下文提供），这反映了为减轻时域实现中与倏逝波相关的晚期增长而施加的稳定性要求。\n\n3) 将该算法实现为一个完整的、可运行的程序。对于所提供测试套件中的每个测试用例，该程序对所有对 $ (s_y, s_z) \\in \\mathcal{S} \\times \\mathcal{S} $ 进行穷举搜索，并返回由最优 $ s_y $、最优 $ s_z $ 和最小化的最坏情况反射幅值 $ J^\\star = \\min_{s_y,s_z \\in \\mathcal{S}} \\max\\{ |R_{\\mathrm{TE}_z}|, |R_{\\mathrm{TM}_z}| \\} $组成的三元组。如果任一偏振的衰减条件 $ \\operatorname{Im}(q_{x2}) \\le 0 $ 不满足，则该候选对是不可行的，必须跳过。如果多个可行候选对在 $ 10^{-12} $ 的数值容差内达到了相同的最小 $ J^\\star $ 值，则从中选择使 $ |s_y - 1| + |s_z - 1| $ 最小的对。如果仍然存在平局，选择具有最小 $ s_y $ 的对；如果仍然平局，则选择具有最小 $ s_z $ 的对。\n\n所有物理量必须使用国际单位制 (SI) 表示。频率单位为 Hz，$ k_y $ 单位为 $\\mathrm{m}^{-1}$，最终的反射幅值为无量纲实数。不使用角度。最终的数值输出必须以十进制浮点数形式报告。\n\n测试套件：\n- 所有情况下使用的全局常量：\n  - $ \\epsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $\n  - $ \\mu_0 = 4\\pi\\times 10^{-7} \\ \\mathrm{H/m} $\n  - 切向伸展的候选集：$ \\mathcal{S} = \\{ 1.2,\\ 1.5,\\ 2.0,\\ 3.0 \\} $\n  - 平方根的分支选择规则：对于任何复数 $ \\zeta $，使用主分支定义 $ \\sqrt{\\zeta} $，如果 $ \\operatorname{Im}(\\sqrt{\\zeta}) < 0 $，则用其负值替换，以强制 $ \\operatorname{Im}(\\sqrt{\\zeta}) \\ge 0 $。当此 $ \\sqrt{\\zeta} $ 被解释为 $ q_{x2} $ 时，如果最终选择的根的虚部 $ \\operatorname{Im}(\\sqrt{\\zeta}) \\le 0 $，则该候选是不可行的。\n\n- 用例 1 (happy-path): $ f = 10\\,\\mathrm{GHz} $, $ s_x = 1 + i\\,1.0 $, and $ k_y = 1.30\\,k_0 $.\n- 用例 2 (近截止倏逝): $ f = 6\\,\\mathrm{GHz} $, $ s_x = 1 + i\\,0.3 $, and $ k_y = 1.05\\,k_0 $.\n- 用例 3 (强法向伸展下的强倏逝): $ f = 12\\,\\mathrm{GHz} $, $ s_x = 2.0 + i\\,2.0 $, and $ k_y = 2.50\\,k_0 $.\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含三个测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，每个测试用例按顺序附加三个值 $ [s_y^\\star, s_z^\\star, J^\\star] $。也就是说，输出必须是一个包含九个浮点数的扁平列表：$ [s_{y,1}^\\star, s_{z,1}^\\star, J_1^\\star, s_{y,2}^\\star, s_{z,2}^\\star, J_2^\\star, s_{y,3}^\\star, s_{z,3}^\\star, J_3^\\star] $。每个浮点数必须四舍五入到六位小数。", "solution": "该问题要求推导在伸展坐标完美匹配层 (PML) 中平面波传播的关键公式，并随后设计一个算法来优化 PML 的性能。整个过程基于频域电磁学的原理。\n\n我们从时谐 Maxwell 旋度方程开始，假设在一个像自由空间一样的无源、线性和各向同性介质中，时间依赖性为 $e^{i\\omega t}$：\n$$ \\nabla \\times \\mathbf{E} = -i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = i\\omega\\epsilon_0 \\mathbf{E} $$\nPML 是通过频域中的复坐标伸展变换构建的。对于笛卡尔坐标系，这等效于将空间导数 $\\frac{\\partial}{\\partial \\alpha}$（其中 $\\alpha \\in \\{x, y, z\\}$）替换为伸展后的版本 $\\frac{1}{s_\\alpha}\\frac{\\partial}{\\partial \\alpha}$，其中 $s_\\alpha$ 是复伸展因子。这将旋度算子 $\\nabla \\times$ 变换为一个修正的算子 $\\tilde{\\nabla} \\times$。在 PML 介质中，用原始笛卡尔坐标书写的方程变为：\n$$ \\tilde{\\nabla} \\times \\mathbf{E} = -i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\tilde{\\nabla} \\times \\mathbf{H} = i\\omega\\epsilon_0 \\mathbf{E} $$\n为了将其表示为各向异性介质中的标准 Maxwell 系统，即 $\\nabla \\times \\mathbf{E} = -i\\omega\\bar{\\bar{\\mu}}\\cdot\\mathbf{H}$ 和 $\\nabla \\times \\mathbf{H} = i\\omega\\bar{\\bar{\\epsilon}}\\cdot\\mathbf{E}$，我们可以展开伸展旋度方程的分量并重新组合各项。一个更直接的方法是使用坐标伸展理论的既定结果，该理论能得出对角的等效介电常数和磁导率张量，$\\bar{\\bar{\\epsilon}} = \\mathrm{diag}(\\epsilon_x, \\epsilon_y, \\epsilon_z)$ 和 $\\bar{\\bar{\\mu}} = \\mathrm{diag}(\\mu_x, \\mu_y, \\mu_z)$。\n\n**1. PML 材料张量分量的推导**\n\n使用对角伸展张量 $\\mathbf{s} = \\mathrm{diag}(s_x, s_y, s_z)$ 的复坐标伸展变换会产生一个等效的各向异性介质，其本构参数如下：\n$$ \\bar{\\bar{\\epsilon}} = \\epsilon_0 \\mathbf{\\Lambda} \\quad \\text{和} \\quad \\bar{\\bar{\\mu}} = \\mu_0 \\mathbf{\\Lambda} $$\n其中 $\\mathbf{\\Lambda}$ 是一个对角矩阵，由下式给出：\n$$ \\mathbf{\\Lambda} = \\mathrm{diag}\\left( \\frac{s_y s_z}{s_x}, \\frac{s_x s_z}{s_y}, \\frac{s_x s_y}{s_z} \\right) $$\n因此，材料张量的分量为：\n$$ \\epsilon_x = \\epsilon_0 \\frac{s_y s_z}{s_x}, \\quad \\epsilon_y = \\epsilon_0 \\frac{s_x s_z}{s_y}, \\quad \\epsilon_z = \\epsilon_0 \\frac{s_x s_y}{s_z} $$\n$$ \\mu_x = \\mu_0 \\frac{s_y s_z}{s_x}, \\quad \\mu_y = \\mu_0 \\frac{s_x s_z}{s_y}, \\quad \\mu_z = \\mu_0 \\frac{s_x s_y}{s_z} $$\n这些就是所要求的 PML 材料张量分量的表达式。\n\n**2. 色散关系的推导**\n\n我们分析形式为 $\\exp(i q_x x + i k_y y)$ 的平面波，因为问题指定 $k_z=0$。del 算子变为 $\\nabla \\rightarrow i(q_x \\hat{x} + k_y \\hat{y})$。PML 介质中的 Maxwell 方程组为：\n$$ i(q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{E} = -i\\omega \\bar{\\bar{\\mu}} \\cdot \\mathbf{H} \\implies (q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{E} = -\\omega \\bar{\\bar{\\mu}} \\cdot \\mathbf{H} $$\n$$ i(q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{H} = i\\omega \\bar{\\bar{\\epsilon}} \\cdot \\mathbf{E} \\implies (q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{H} = \\omega \\bar{\\bar{\\epsilon}} \\cdot \\mathbf{E} $$\n我们考虑两种解耦的偏振。\n\n对于**横电 (TE$_z$)** 偏振，非零场为 $E_z$、$H_x$ 和 $H_y$。第一个旋度方程 $(q_x \\hat{x} + k_y \\hat{y}) \\times (E_z \\hat{z}) = -\\omega(\\mu_x H_x \\hat{x} + \\mu_y H_y \\hat{y})$ 得出：\n$$ k_y E_z = -\\omega \\mu_x H_x \\implies H_x = -\\frac{k_y}{\\omega \\mu_x} E_z $$\n$$ -q_x E_z = -\\omega \\mu_y H_y \\implies H_y = \\frac{q_x}{\\omega \\mu_y} E_z $$\n第二个旋度方程 $(q_x \\hat{x} + k_y \\hat{y}) \\times (H_x \\hat{x} + H_y \\hat{y}) = \\omega \\epsilon_z E_z \\hat{z}$ 给出标量关系：\n$$ q_x H_y - k_y H_x = \\omega \\epsilon_z E_z $$\n代入 $H_x$ 和 $H_y$ 的表达式：\n$$ q_x \\left(\\frac{q_x}{\\omega \\mu_y} E_z\\right) - k_y \\left(-\\frac{k_y}{\\omega \\mu_x} E_z\\right) = \\omega \\epsilon_z E_z $$\n除以 $E_z$ 并乘以 $\\omega$ 得到 TE$_z$ 色散关系：\n$$ \\frac{q_x^2}{\\mu_y} + \\frac{k_y^2}{\\mu_x} = \\omega^2 \\epsilon_z $$\n\n对于**横磁 (TM$_z$)** 偏振，非零场为 $H_z$、$E_x$ 和 $E_y$。遵循类似的步骤。第二个旋度方程 $(q_x \\hat{x} + k_y \\hat{y}) \\times (H_z \\hat{z}) = \\omega(\\epsilon_x E_x \\hat{x} + \\epsilon_y E_y \\hat{y})$ 得出：\n$$ k_y H_z = \\omega \\epsilon_x E_x \\implies E_x = \\frac{k_y}{\\omega \\epsilon_x} H_z $$\n$$ -q_x H_z = \\omega \\epsilon_y E_y \\implies E_y = -\\frac{q_x}{\\omega \\epsilon_y} H_z $$\n第一个旋度方程 $(q_x \\hat{x} + k_y \\hat{y}) \\times (E_x \\hat{x} + E_y \\hat{y}) = -\\omega \\mu_z H_z \\hat{z}$ 给出：\n$$ q_x E_y - k_y E_x = -\\omega \\mu_z H_z $$\n代入 $E_x$ 和 $E_y$ 的表达式：\n$$ q_x \\left(-\\frac{q_x}{\\omega \\epsilon_y} H_z\\right) - k_y \\left(\\frac{k_y}{\\omega \\epsilon_x} H_z\\right) = -\\omega \\mu_z H_z $$\n除以 $H_z$ 并乘以 $-\\omega$ 得到 TM$_z$ 色散关系：\n$$ \\frac{q_x^2}{\\epsilon_y} + \\frac{k_y^2}{\\epsilon_x} = \\omega^2 \\mu_z $$\n\n**3. 反射系数的推导**\n\n界面位于 $x=0$。区域 1 ($x<0$) 是自由空间 ($\\epsilon_0, \\mu_0$)，区域 2 ($x \\ge 0$) 是 PML。一束平面波从区域 1 入射。边界条件要求 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的切向分量在 $x=0$ 处连续。反射系数 $R$ 是反射切向电场振幅与入射切向电场振幅之比。在区域 1 中，场是入射波（波数 $q_{x1}$）和反射波（波数 $-q_{x1}$）之和。在区域 2 中，只有透射波（波数 $q_{x2}$）。自由空间的色散关系为 $q_{x1}^2 + k_y^2 = k_0^2 = \\omega^2\\epsilon_0\\mu_0$。\n\n对于 **TE$_z$ 偏振**，切向场是 $E_z$ 和 $H_y$。\n$E_z$ 的连续性： $E_{z,1}(0) = E_{z,2}(0) \\implies E_z^i + E_z^r = E_z^t$。\n$H_y$ 的连续性： $H_{y,1}(0) = H_{y,2}(0)$。\n横向波导纳为 $Y_{TE} = H_y/E_z$。在区域 1，$Y_{1,TE} = q_{x1}/(\\omega\\mu_0)$。在区域 2，$Y_{2,TE} = q_{x2,TE}/(\\omega\\mu_y)$。\n$H_y^i+H_y^r = H_y^t \\implies Y_{1,TE}E_z^i - Y_{1,TE}E_z^r = Y_{2,TE}E_z^t$。\n设 $R_{\\mathrm{TE}_z} = E_z^r/E_z^i$ 且 $T_{\\mathrm{TE}_z} = E_z^t/E_z^i = 1+R_{\\mathrm{TE}_z}$，我们得到 $Y_{1,TE}(1-R_{\\mathrm{TE}_z}) = Y_{2,TE}(1+R_{\\mathrm{TE}_z})$。\n求解 $R_{\\mathrm{TE}_z}$：\n$$ R_{\\mathrm{TE}_z} = \\frac{Y_{1,TE} - Y_{2,TE}}{Y_{1,TE} + Y_{2,TE}} = \\frac{q_{x1}/\\mu_0 - q_{x2,TE}/\\mu_y}{q_{x1}/\\mu_0 + q_{x2,TE}/\\mu_y} = \\frac{q_{x1}\\mu_y - q_{x2,TE}\\mu_0}{q_{x1}\\mu_y + q_{x2,TE}\\mu_0} $$\n其中 $q_{x2,TE}$ 是 TE$_z$ 情况下 PML 中的法向波数。\n\n对于 **TM$_z$ 偏振**，切向场是 $E_y$ 和 $H_z$。\n$E_y$ 的连续性： $E_{y,1}(0) = E_{y,2}(0) \\implies E_y^i + E_y^r = E_y^t$。\n$H_z$ 的连续性： $H_{z,1}(0) = H_{z,2}(0)$。\n横向波导纳为 $Y_{TM} = -H_z/E_y$。在区域 1，$Y_{1,TM} = \\omega\\epsilon_0/q_{x1}$。在区域 2，$Y_{2,TM} = \\omega\\epsilon_y/q_{x2,TM}$。\n$H_z^i + H_z^r = H_z^t \\implies -Y_{1,TM}E_y^i + Y_{1,TM}E_y^r = -Y_{2,TM}E_y^t$。\n设 $R_{\\mathrm{TM}_z} = E_y^r/E_y^i$ 且 $T_{\\mathrm{TM}_z} = E_y^t/E_y^i = 1+R_{\\mathrm{TM}_z}$，我们得到 $Y_{1,TM}(-1+R_{\\mathrm{TM}_z}) = -Y_{2,TM}(1+R_{\\mathrm{TM}_z})$。\n这可以简化为 $Y_{1,TM}(1-R_{\\mathrm{TM}_z}) = Y_{2,TM}(1+R_{\\mathrm{TM}_z})$。\n求解 $R_{\\mathrm{TM}_z}$：\n$$ R_{\\mathrm{TM}_z} = \\frac{Y_{1,TM} - Y_{2,TM}}{Y_{1,TM} + Y_{2,TM}} = \\frac{\\omega\\epsilon_0/q_{x1} - \\omega\\epsilon_y/q_{x2,TM}}{\\omega\\epsilon_0/q_{x1} + \\omega\\epsilon_y/q_{x2,TM}} = \\frac{\\epsilon_0/q_{x1} - \\epsilon_y/q_{x2,TM}}{\\epsilon_0/q_{x1} + \\epsilon_y/q_{x2,TM}} = \\frac{q_{x2,TM}\\epsilon_0 - q_{x1}\\epsilon_y}{q_{x2,TM}\\epsilon_0 + q_{x1}\\epsilon_y} $$\n其中 $q_{x2,TM}$ 是 TM$_z$ 情况下 PML 中的法向波数。\n\n**算法设计**\n\n该算法的核心是实现推导出的公式并执行穷举搜索。将材料参数代入色散关系后，可以得到一个关键的简化。对于 TE$_z$ 和 TM$_z$ 两种情况：\n$$ q_{x2}^2 = s_x^2 \\left(k_0^2 - \\frac{k_y^2}{s_y^2}\\right) $$\n这表明 $q_{x2,TE} = q_{x2,TM} = q_{x2}$，并且波数 $q_{x2}$ 与 $s_z$ 无关。因此，可行性条件 $\\operatorname{Im}(q_{x2}) > 0$ 仅取决于 $s_y$（对于固定的 $s_x$ 和 $k_y$）。\n\n我们再来简化反射系数。令 $Z_{ratio} = s_x s_z / s_y$。\n$ \\mu_y = \\mu_0 Z_{ratio} $ 且 $ \\epsilon_y = \\epsilon_0 Z_{ratio} $。\n$$ R_{\\mathrm{TE}_z} = \\frac{q_{x1}(\\mu_0 Z_{ratio}) - q_{x2}\\mu_0}{q_{x1}(\\mu_0 Z_{ratio}) + q_{x2}\\mu_0} = \\frac{q_{x1} Z_{ratio} - q_{x2}}{q_{x1} Z_{ratio} + q_{x2}} $$\n$$ R_{\\mathrm{TM}_z} = \\frac{q_{x2}\\epsilon_0 - q_{x1}(\\epsilon_0 Z_{ratio})}{q_{x2}\\epsilon_0 + q_{x1}(\\epsilon_0 Z_{ratio})} = \\frac{q_{x2} - q_{x1} Z_{ratio}}{q_{x2} + q_{x1} Z_{ratio}} = -R_{\\mathrm{TE}_z} $$\n这意味着 $|R_{\\mathrm{TM}_z}| = |R_{\\mathrm{TE}_z}|$。目标函数 $J = \\max\\{ |R_{\\mathrm{TE}_z}|, |R_{\\mathrm{TM}_z}| \\}$ 简化为 $J = |R_{\\mathrm{TE}_z}|$。\n\n算法如下：\n对于每个测试用例 $(f, s_x, k_y/k_0)$：\n1. 将 `min_J_star` 初始化为无穷大，并为 `best_sy`、`best_sz` 和 `best_tie_breaker` 设置占位符。\n2. 计算常数：$\\omega = 2\\pi f$，$k_0 = \\omega/c$，$k_y$，以及 $q_{x1} = \\sqrt{k_0^2 - k_y^2}$（确保 $\\operatorname{Im}(q_{x1}) \\ge 0$）。\n3. 遍历排序后的候选集 $\\mathcal{S}$ 中的每个 $s_y$。\n    a. 计算 $q_{x2}^2 = s_x^2 (k_0^2 - k_y^2/s_y^2)$。\n    b. 计算 $q_{x2} = \\sqrt{q_{x2}^2}$。应用分支选择规则：如果 $\\operatorname{Im}(q_{x2})  0$，则设 $q_{x2} = -q_{x2}$。\n    c. 如果 $\\operatorname{Im}(q_{x2}) \\le 0$，则此 $s_y$ 不可行。继续下一个 $s_y$。\n4. 对于每个可行的 $s_y$，遍历排序后的候选集 $\\mathcal{S}$ 中的每个 $s_z$。\n    a. 使用上面推导的公式计算 $J = |R_{\\mathrm{TE}_z}|$。\n    b. 将当前的 $J$ 与 `min_J_star` 进行比较，并应用指定的平局决胜规则。\n        i. 如果 $J$ 比 `min_J_star` 小超过 $10^{-12}$ 的容差，我们就有了一个新的最佳候选者。更新 `min_J_star`、`best_sy`、`best_sz` 和平局决胜值 $|s_y - 1| + |s_z - 1|$。\n        ii. 如果 $J$ 在 `min_J_star` 的容差范围内，则检查平局决胜值。如果当前对的平局决胜值较小，则更新最佳候选者。\n        iii. 如果平局决胜值也相等，我们不进行更新。因为迭代是针对排序后的 $s_y$ 和 $s_z$ 进行的，所以第一个找到的候选对在所有平局对中将始终具有字典序最小的 $(s_y, s_z)$。\n5. 循环完成后，存储的 `best_sy`、`best_sz` 和 `min_J_star` 构成该测试用例的结果。\n最终的程序为所有测试用例实现此逻辑并格式化输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PML optimization problem for the given test suite.\n    \"\"\"\n\n    # Global constants\n    EPS0 = 8.854187817e-12  # F/m\n    MU0 = 4 * np.pi * 1e-7  # H/m\n    C0 = 1 / np.sqrt(EPS0 * MU0) # m/s\n    S_CANDIDATES = [1.2, 1.5, 2.0, 3.0]\n    TOL = 1e-12\n\n    # Test suite\n    test_cases = [\n        # (f in Hz, s_x, k_y/k_0 ratio)\n        (10e9, 1.0 + 1.0j, 1.30),\n        (6e9, 1.0 + 0.3j, 1.05),\n        (12e9, 2.0 + 2.0j, 2.50),\n    ]\n\n    final_results = []\n\n    # Sort S_CANDIDATES to naturally handle tie-breaking on smallest sy, then sz\n    sorted_s_candidates = sorted(S_CANDIDATES)\n\n    for f, s_x, ky_k0_ratio in test_cases:\n        # Initialize optimal values for the current case\n        best_sy = -1.0\n        best_sz = -1.0\n        min_J_star = float('inf')\n        best_tie_breaker_val = float('inf')\n\n        # Calculate case-specific physical parameters\n        omega = 2 * np.pi * f\n        k0 = omega / C0\n        ky = ky_k0_ratio * k0\n\n        # Calculate free-space normal wavenumber q_x1\n        # Incident wave is evanescent, so k_y > k_0 and q_x1_sq is negative\n        q_x1_sq = k0**2 - ky**2\n        q_x1 = np.sqrt(complex(q_x1_sq)) # q_x1 is purely imaginary with Im(q_x1) > 0\n\n        # Exhaustive search over all (s_y, s_z) pairs\n        for sy in sorted_s_candidates:\n            # Calculate q_x2, which is independent of s_z\n            q_x2_sq = s_x**2 * (k0**2 - (ky/sy)**2)\n            q_x2 = np.sqrt(q_x2_sq)\n\n            # Apply branch selection rule: Im(q_x2) >= 0\n            if q_x2.imag < 0:\n                q_x2 = -q_x2\n\n            # Feasibility check: transmitted wave must decay, Im(q_x2) > 0\n            if q_x2.imag <= 0:\n                continue # This s_y is infeasible\n\n            for sz in sorted_s_candidates:\n                # Calculate the objective function J = max(|R_TEz|, |R_TMz|)\n                # Based on derivations, |R_TEz| = |R_TMz|, so J = |R_TEz|\n                Z_ratio = s_x * sz / sy\n                \n                numerator = q_x1 * Z_ratio - q_x2\n                denominator = q_x1 * Z_ratio + q_x2\n\n                if abs(denominator) < 1e-15:\n                    current_J = float('inf')\n                else:\n                    R_TEz = numerator / denominator\n                    current_J = abs(R_TEz)\n                \n                current_tie_breaker_val = abs(sy - 1) + abs(sz - 1)\n\n                # Update logic with tie-breaking rules\n                # Rule 1: Minimize J_star\n                if current_J < min_J_star - TOL:\n                    min_J_star = current_J\n                    best_sy = sy\n                    best_sz = sz\n                    best_tie_breaker_val = current_tie_breaker_val\n                # Rule 2: If J_star is tied, minimize tie-breaker\n                elif abs(current_J - min_J_star) <= TOL:\n                    # Using ''<'' here handles floating point comparisons safely\n                    if current_tie_breaker_val < best_tie_breaker_val - TOL:\n                        min_J_star = current_J\n                        best_sy = sy\n                        best_sz = sz\n                        best_tie_breaker_val = current_tie_breaker_val\n                    # Rule 3  4 (smallest sy, then sz) are handled implicitly\n                    # by iterating over sorted S_CANDIDATES and not updating\n                    # on a tie-breaker tie. The first pair found is kept.\n\n        final_results.extend([best_sy, best_sz, min_J_star])\n\n    # Format the output string as required\n    output_str = \",\".join(f\"{v:.6f}\" for v in final_results)\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3341069"}]}