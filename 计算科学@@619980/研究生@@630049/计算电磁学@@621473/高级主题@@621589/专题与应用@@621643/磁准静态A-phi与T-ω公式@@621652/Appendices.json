{"hands_on_practices": [{"introduction": "在应用复杂的数值公式之前，我们必须首先确定其适用范围。本练习将引导您从第一性原理出发，推导定义磁准静态（MQS）区域的关键无量纲参数。通过为一个假设场景计算这些参数，您将具体地理解何时传导电流远大于位移电流，从而可以忽略电磁波的传播效应。[@problem_id:3328349]", "problem": "一个特性长度为 $L$ 的均匀、各向同性、线性导电块，在频率 $f$ 下被正弦激励。材料参数为 $\\mu = 100 \\mu_{0}$，$\\sigma = 5 \\times 10^{6}$ S/m，$\\epsilon = 5 \\epsilon_{0}$，其中 $L = 0.1$ m， $f = 1$ kHz。在磁准静态 (MQS) 区域，当电磁波传播效应可忽略不计且传导电流远大于位移电流时，涡流公式（例如磁矢量势-电标量势（$A$–$\\phi$）公式和电矢量势-磁标量势（$T$–$\\Omega$）公式）是合理的。\n\n从 Maxwell 方程组和线性介质的本构关系出发，推导在该给定频率和长度尺度下，证明该介质的 MQS 近似是合理的无量纲参数。您的推导必须从基本定律和定义开始，并得出用于比较以下各项的无量纲量：\n- 特性尺寸 $L$ 与介质中电磁波的波长，\n- 位移电流与传导电流的大小，\n- 以及特性尺寸 $L$ 与趋肤深度。\n\n使用给定数据计算它们的数值。然后，估算在此条件下，该介质中因忽略安培定律中的位移电流项而引入的相对误差，以无单位小数形式表示。将最终答案四舍五入至四位有效数字。", "solution": "问题陈述经评估有效。它具有科学依据，提法明确，客观，是计算电磁学中的一个标准问题。所有必要的数据均已提供。我们可以开始求解。\n\n分析从 Maxwell 方程组开始。对于角频率为 $\\omega = 2\\pi f$ 的正弦激励，我们使用时谐（相量）形式。在无源（$\\rho_{\\text{v}} = 0$）、线性、均匀、各向同性的介质中，它们是：\n$$ \\nabla \\cdot \\mathbf{E} = 0 $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n$$ \\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + j\\omega \\mathbf{D} $$\n\n介质的本构关系是：\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\n$$ \\mathbf{B} = \\mu \\mathbf{H} $$\n$$ \\mathbf{J} = \\sigma \\mathbf{E} $$\n此处，$\\mathbf{J}$ 是传导电流密度。将本构关系代入安培定律得到：\n$$ \\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} + j\\omega \\epsilon \\mathbf{E} $$\n项 $\\mathbf{J}_{\\text{c}} = \\sigma\\mathbf{E}$ 代表传导电流密度，项 $\\mathbf{J}_{\\text{d}} = j\\omega\\epsilon\\mathbf{E}$ 代表位移电流密度。\n\n当传导电流远大于位移电流时，磁准静态（MQS）近似是合理的。第一个无量纲参数是这两种电流密度大小的比值。\n$$ \\frac{|\\mathbf{J}_{\\text{d}}|}{|\\mathbf{J}_{\\text{c}}|} = \\frac{|j\\omega\\epsilon\\mathbf{E}|}{|\\sigma\\mathbf{E}|} = \\frac{\\omega\\epsilon}{\\sigma} $$\n当 $\\frac{\\omega\\epsilon}{\\sigma} \\ll 1$ 时，MQS 区域有效。\n\n任何准静态近似的第二个理由是系统的特性长度 $L$ 远小于周围自由空间中的电磁波波长 $\\lambda_0$。这确保了延迟效应可以忽略不计。虽然问题要求的是*介质中*的波长，但我们首先建立亥姆霍兹波动方程来找到它。对法拉第定律取旋度，我们得到 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega (\\nabla \\times \\mathbf{B})$。使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2\\mathbf{E}$ 并代入 $\\nabla \\cdot \\mathbf{E} = 0$、$\\mathbf{B} = \\mu\\mathbf{H}$ 和安培定律，我们得到：\n$$ -\\nabla^2 \\mathbf{E} = -j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E} $$\n$$ \\nabla^2 \\mathbf{E} + [j\\omega\\mu\\sigma + \\omega^2\\mu\\epsilon]\\mathbf{E} = 0 $$\n这是亥姆霍兹方程 $\\nabla^2 \\mathbf{E} + k^2\\mathbf{E} = 0$，其中复传播常数 $k$ 由 $k^2 = \\omega^2\\mu\\epsilon - j\\omega\\mu\\sigma$ 给出。\n由于我们已经确定 MQS 要求 $\\frac{\\omega\\epsilon}{\\sigma} \\ll 1$，因此该介质是良导体。在这种情况下，$k^2$ 中的位移电流项与传导电流项相比可以忽略不计：$\\omega^2\\mu\\epsilon \\ll \\omega\\mu\\sigma$。\n因此，传播常数简化为：\n$$ k^2 \\approx -j\\omega\\mu\\sigma $$\n$$ k = \\sqrt{-j\\omega\\mu\\sigma} = \\sqrt{\\omega\\mu\\sigma}\\sqrt{-j} = \\sqrt{\\omega\\mu\\sigma} \\left(\\frac{1-j}{\\sqrt{2}}\\right) = (1-j)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} $$\n复传播常数的一般形式是 $k = \\beta - j\\alpha$，其中 $\\beta$ 是相常数（波数），$\\alpha$ 是衰减常数。对于该介质，我们有：\n$$ \\alpha = \\beta = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}} $$\n趋肤深度 $\\delta$ 是场振幅衰减到 $1/e$ 倍的距离，定义为 $\\delta = 1/\\alpha$。\n$$ \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} $$\n介质中的波长 $\\lambda$ 与相常数的关系为 $\\lambda = 2\\pi/\\beta$。\n$$ \\lambda = 2\\pi \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} = 2\\pi\\delta $$\n问题要求我们推导比较 $L$ 与 $\\lambda$ 和 $L$ 与 $\\delta$ 的无量纲量。它们是 $L/\\lambda$ 和 $L/\\delta$。条件 $L \\ll \\lambda$ 经常被引用来忽略波动效应。然而，在良导体中，这个条件等价于 $L \\ll 2\\pi\\delta$。这些比率并不决定 MQS 的有效性，而是表征 MQS 区域内的物理行为（例如，强或弱趋肤效应）。忽略波传播（延迟）的主要条件是 $L \\ll \\lambda_0$，其中 $\\lambda_0 = c_0/f$ 是自由空间波长。\n\n现在我们计算数值。\n给定参数：\n$L = 0.1\\ \\mathrm{m}$\n$f = 1\\ \\mathrm{kHz} = 10^3\\ \\mathrm{Hz}$\n$\\mu = 100 \\mu_0 = 100 \\times (4\\pi \\times 10^{-7}\\ \\mathrm{H/m}) = 4\\pi \\times 10^{-5}\\ \\mathrm{H/m}$\n$\\sigma = 5 \\times 10^6\\ \\mathrm{S/m}$\n$\\epsilon = 5 \\epsilon_0 = 5 \\times (8.854 \\times 10^{-12}\\ \\mathrm{F/m}) \\approx 4.427 \\times 10^{-11}\\ \\mathrm{F/m}$\n角频率为 $\\omega = 2\\pi f = 2\\pi \\times 10^3\\ \\mathrm{rad/s}$。\n\n无量纲参数1：位移电流与传导电流之比。\n$$ \\frac{\\omega\\epsilon}{\\sigma} = \\frac{(2\\pi \\times 10^3\\ \\mathrm{rad/s})(4.427 \\times 10^{-11}\\ \\mathrm{F/m})}{5 \\times 10^6\\ \\mathrm{S/m}} \\approx 5.562 \\times 10^{-14} $$\n由于 $5.562 \\times 10^{-14} \\ll 1$，传导电流占主导地位的 MQS 准则被很好地满足。\n\n趋肤深度 $\\delta$：\n$$ \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} = \\sqrt{\\frac{2}{(2\\pi \\times 10^3)(4\\pi \\times 10^{-5})(5 \\times 10^6)}} = \\sqrt{\\frac{2}{4\\pi^2 \\times 10^5}}\\ \\mathrm{m} \\approx 7.118 \\times 10^{-4}\\ \\mathrm{m} $$\n因此，趋肤深度约为 $0.7118\\ \\mathrm{mm}$。\n\n介质中的波长 $\\lambda$：\n$$ \\lambda = 2\\pi\\delta \\approx 2\\pi(7.118 \\times 10^{-4}\\ \\mathrm{m}) \\approx 4.472 \\times 10^{-3}\\ \\mathrm{m} $$\n介质中的波长约为 $4.472\\ \\mathrm{mm}$。\n\n无量纲参数2：特性尺寸与趋肤深度之比。\n$$ \\frac{L}{\\delta} = \\frac{0.1\\ \\mathrm{m}}{7.118 \\times 10^{-4}\\ \\mathrm{m}} \\approx 140.5 $$\n由于 $L \\gg \\delta$，我们处于强趋肤效应区域，涡流显著地屏蔽了导电块内部免受磁场的影响。\n\n无量纲参数3：特性尺寸与介质中波长之比。\n$$ \\frac{L}{\\lambda} = \\frac{0.1\\ \\mathrm{m}}{4.472 \\times 10^{-3}\\ \\mathrm{m}} \\approx 22.36 $$\n$L > \\lambda$ 这一事实并未使 MQS 模型失效。它表明电磁场的相位在距离 $L$ 上有显著变化。然而，由于场振幅在更短的距离 $\\delta = \\lambda/(2\\pi)$ 上呈指数衰减，这种相位变化仅在薄薄的趋肤层内是相关的。整体行为是扩散性的，而不是传播性的，这正是导体中 MQS 的本质。\n\n因忽略安培定律中的位移电流项 $\\mathbf{J}_{\\text{d}} = j\\omega\\epsilon\\mathbf{E}$ 而引入的相对误差，是被忽略项的大小与保留项 $\\mathbf{J}_{\\text{c}} = \\sigma\\mathbf{E}$ 大小的比值。\n$$ \\text{相对误差} = \\frac{|\\mathbf{J}_{\\text{d}}|}{|\\mathbf{J}_{\\text{c}}|} = \\frac{\\omega\\epsilon}{\\sigma} $$\n我们已经计算过这个值。\n$$ \\text{相对误差} \\approx 5.562 \\times 10^{-14} $$\n将其四舍五入至四位有效数字得到 $5.562 \\times 10^{-14}$。", "answer": "$$\\boxed{5.562 \\times 10^{-14}}$$", "id": "3328349"}, {"introduction": "确定了MQS的适用范围后，我们现在来探究其在导体中的核心物理效应：磁扩散。本练习要求您从麦克斯韦方程组和势函数公式出发，推导出磁扩散方程，并利用标度分析（scaling analysis）找出特征磁扩散时间。这个时间尺度对于理解涡流屏蔽和电磁装置的瞬态响应等现象至关重要。[@problem_id:3328292]", "problem": "考虑一个特征尺寸为 $L$ 的均匀、各向同性、单连通导体，其材料属性均匀：电导率为 $\\sigma$，磁导率为 $\\mu$。该导体具有线性的本构关系，且位移电流可忽略不计。在磁准静态 (MQS) 假设下，场由麦克斯韦方程组和欧姆定律 $J = \\sigma E$ 控制，磁通量密度 $B$ 和磁场强度 $H$ 通过 $B = \\mu H$ 相关联。在 $t=0$ 时，于边界上施加一个外部切向磁场的阶跃变化，磁场开始穿透导体。\n\n从基本的MQS定律出发，使用磁矢势-标势公式 ($A$-$\\phi$ 公式)，其中 $B = \\nabla \\times A$ 和 $E = -\\partial A / \\partial t - \\nabla \\phi$；或使用电矢势-磁标量势公式 ($T$-$\\Omega$ 公式)，其中 $J = \\nabla \\times T$，推导出导体中一个代表性场量的控制扩散方程。应用于此扩散方程，使用一个物理上一致的标度分析，求出控制磁场穿透距离 $L$ 所需时间的特征磁扩散时间尺度。\n\n你不能假定任何关于扩散时间或趋肤深度的简便公式；相反，必须从MQS方程和上面概述的势公式出发进行推导。清楚地说明你所采用的任何规范条件或简化（例如均匀的 $\\mu$ 和 $\\sigma$ 以及没有自由电荷积累），并确保推导过程与所述的物理假设保持一致。\n\n将你的最终答案表示为特征磁扩散时间尺度的单个闭式解析表达式。不要进行数值计算。不要在最终的方框表达式中包含单位。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第一步：提取已知条件\n-   **系统**：一个均匀、各向同性、单连通的导体。\n-   **参数**：特征尺寸 $L$，均匀电导率 $\\sigma$，均匀磁导率 $\\mu$。\n-   **假设**：线性本构关系，可忽略的位移电流（磁准静态或MQS假设）。\n-   **控制定律和关系**：\n    -   MQS麦克斯韦方程组。\n    -   欧姆定律：$J = \\sigma E$。\n    -   本构关系：$B = \\mu H$。\n-   **建议的势公式**：\n    -   磁矢量势 ($\\mathbf{A}$) 和电标势 ($\\phi$)：$B = \\nabla \\times \\mathbf{A}$ 和 $E = -\\partial \\mathbf{A} / \\partial t - \\nabla \\phi$。\n    -   电矢量势 ($\\mathbf{T}$) 和磁标量势 ($\\Omega$)：$J = \\nabla \\times \\mathbf{T}$。\n-   **过程**：\n    1.  从基本的MQS定律出发。\n    2.  使用其中一种势公式。\n    3.  推导一个代表性场量的控制扩散方程。\n    4.  对此方程应用物理上一致的标度分析。\n    5.  求出特征磁扩散时间尺度。\n-   **约束条件**：\n    -   不假定扩散时间或趋肤深度的简便公式。\n    -   清楚地说明所采用的任何规范条件或简化。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学基础**：该问题基于麦克斯韦方程组的磁准静态近似，这是经典电磁学的基石，用于描述涡流和磁扩散等低频现象。所有原理、定律（$J=\\sigma E$, $B=\\mu H$）和数学工具（势公式、标度分析）在物理学和工程学中都是标准且公认的。\n2.  **适定性**：该问题是适定的。它要求从基本方程推导一个特征物理量（时间尺度），这是理论物理学中的一个标准程序。该推导过程会得出一个唯一、稳定且有意义的结果。\n3.  **客观性**：该问题以精确、客观和定量的科学语言陈述。\n4.  **完整性与一致性**：该问题是自洽的。它提供了所有必要的物理参数（$\\sigma$, $\\mu$, $L$）、控制原理（MQS）以及清晰的推导路径。没有矛盾之处。\n5.  **非病态**：该问题结构清晰，能得出一个唯一的时间尺度答案。\n6.  **非平凡性**：要求从基本定律和势公式推导结果，确保了该问题不是简单地背诵公式。它考验了概念理解和演绎推理能力。\n\n### 第三步：结论与行动\n该问题是有效的。将提供完整的解答。\n\n推导从磁准静态学的基本方程开始。麦克斯韦方程组的MQS近似，忽略了位移电流项（$\\partial D / \\partial t$），包括：\n法拉第电磁感应定律：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n安培定律（MQS形式）：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} $$\n磁场高斯定律：\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n对于线性、各向同性、均匀介质，本构关系为 $B = \\mu H$ 和欧姆定律 $J = \\sigma E$，其中 $\\mu$ 和 $\\sigma$ 是常数。\n\n我们将使用磁矢量势 ($\\mathbf{A}$) 和电标势 ($\\phi$) 公式。定义 $B = \\nabla \\times \\mathbf{A}$ 内在地满足了磁场高斯定律，因为旋度的散度恒为零（$\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$）。\n\n将 $B = \\nabla \\times \\mathbf{A}$ 代入法拉第定律得到：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{A}) = -\\nabla \\times \\left(\\frac{\\partial \\mathbf{A}}{\\partial t}\\right) $$\n这可以重排为：\n$$ \\nabla \\times \\left(\\mathbf{E} + \\frac{\\partial \\mathbf{A}}{\\partial t}\\right) = 0 $$\n一个旋度为零的矢量场可以表示为一个标量势的梯度。我们将此标量势定义为 $-\\phi$，从而得到：\n$$ \\mathbf{E} + \\frac{\\partial \\mathbf{A}}{\\partial t} = -\\nabla \\phi $$\n因此，电场用势表示为：\n$$ \\mathbf{E} = -\\frac{\\partial \\mathbf{A}}{\\partial t} - \\nabla \\phi $$\n接下来，我们使用安培定律，并代入本构关系：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} \\implies \\nabla \\times \\left(\\frac{\\mathbf{B}}{\\mu}\\right) = \\sigma \\mathbf{E} $$\n对于均匀介质，$\\mu$ 是一个常数，所以：\n$$ \\frac{1}{\\mu} (\\nabla \\times \\mathbf{B}) = \\sigma \\mathbf{E} $$\n现在，我们代入 $\\mathbf{B}$ 和 $\\mathbf{E}$ 的势表示：\n$$ \\frac{1}{\\mu} \\nabla \\times (\\nabla \\times \\mathbf{A}) = \\sigma \\left(-\\frac{\\partial \\mathbf{A}}{\\partial t} - \\nabla \\phi\\right) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$，方程变为：\n$$ \\frac{1}{\\mu} \\left(\\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}\\right) = -\\sigma \\frac{\\partial \\mathbf{A}}{\\partial t} - \\sigma \\nabla \\phi $$\n这个方程很复杂，但可以通过为磁矢量势 $\\mathbf{A}$ 选择一个规范来简化。在MQS中，库仑规范是一个方便且物理上合适的选择：\n$$ \\nabla \\cdot \\mathbf{A} = 0 $$\n应用此规范条件，$\\nabla(\\nabla \\cdot \\mathbf{A})$ 项消失，方程简化为：\n$$ -\\frac{1}{\\mu} \\nabla^2 \\mathbf{A} = -\\sigma \\frac{\\partial \\mathbf{A}}{\\partial t} - \\sigma \\nabla \\phi $$\n整理得到：\n$$ \\nabla^2 \\mathbf{A} = \\mu \\sigma \\frac{\\partial \\mathbf{A}}{\\partial t} + \\mu \\sigma \\nabla \\phi $$\n为了处理 $\\nabla \\phi$ 项，我们考虑电荷的连续性。在MQS中，假设电荷弛豫时间 $\\tau_e = \\epsilon/\\sigma$ 远小于所关心的时间尺度。任何自由电荷的积累几乎瞬间消散，因此我们可以假设导体内的自由电荷密度 $\\rho_{\\text{v}} \\approx 0$。根据电场高斯定律，$\\nabla \\cdot \\mathbf{E} = \\rho_{\\text{v}}/\\epsilon$。更基本地，从电荷守恒 $\\nabla \\cdot \\mathbf{J} = -\\partial \\rho_{\\text{v}} / \\partial t$ 可知，条件 $\\rho_{\\text{v}} \\approx 0$ 意味着 $\\nabla \\cdot \\mathbf{J} = 0$。使用欧姆定律，对于均匀电导率，$\\nabla \\cdot \\mathbf{J} = \\sigma \\nabla \\cdot \\mathbf{E} = 0$，这意味着 $\\nabla \\cdot \\mathbf{E} = 0$。\n\n对以势表示的 $\\mathbf{E}$ 的表达式取散度：\n$$ \\nabla \\cdot \\mathbf{E} = \\nabla \\cdot \\left(-\\frac{\\partial \\mathbf{A}}{\\partial t} - \\nabla \\phi\\right) = -\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\phi $$\n由于 $\\nabla \\cdot \\mathbf{E} = 0$ 并且我们选择了库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，我们发现标势 $\\phi$ 必须满足拉普拉斯方程：\n$$ \\nabla^2 \\phi = 0 $$\n对于一个单连通导体区域，如果边界上的势 $\\phi$ 是常数（这对于单个导电体是一个合理的物理假设），拉普拉斯方程的唯一解是 $\\phi$ 在整个体积内都是常数。一个常数势的梯度为零，因此 $\\nabla \\phi = 0$。\n\n当 $\\nabla \\phi = 0$ 时，导体内磁矢势 $\\mathbf{A}$ 的控制方程成为一个齐次矢量扩散方程：\n$$ \\nabla^2 \\mathbf{A} = \\mu \\sigma \\frac{\\partial \\mathbf{A}}{\\partial t} $$\n这个方程描述了磁场的变化（由 $\\mathbf{A}$ 表示）如何扩散到导体中。在导体内部，同样的扩散方程也控制着 $\\mathbf{B}$、$\\mathbf{H}$ 和 $\\mathbf{J}$。\n\n为了找出该扩散过程的特征时间尺度，我们进行标度分析。设 $L$ 为导体的特征长度尺度，$\\tau$ 为扩散的特征时间尺度。我们引入用撇号表示的无量纲变量：\n$$ x' = \\frac{x}{L}, \\quad y' = \\frac{y}{L}, \\quad z' = \\frac{z}{L}, \\quad t' = \\frac{t}{\\tau} $$\n微分算子的标度关系为：\n$$ \\nabla = \\frac{1}{L} \\nabla' \\implies \\nabla^2 = \\frac{1}{L^2} \\nabla'^2 $$\n$$ \\frac{\\partial}{\\partial t} = \\frac{1}{\\tau} \\frac{\\partial}{\\partial t'} $$\n将这些经过标度变换的算子代入扩散方程：\n$$ \\frac{1}{L^2} \\nabla'^2 \\mathbf{A} = \\mu \\sigma \\frac{1}{\\tau} \\frac{\\partial \\mathbf{A}}{\\partial t'} $$\n我们可以重排此方程，将所有有量纲的常数组合在一起：\n$$ \\nabla'^2 \\mathbf{A} = \\left( \\frac{\\mu \\sigma L^2}{\\tau} \\right) \\frac{\\partial \\mathbf{A}}{\\partial t'} $$\n在此方程的无量纲形式中，相对于无量纲变量，时间和空间导数的量级为1。为了使方程具有物理意义，乘以时间导数项的系数也必须量级为1。这就建立了物理参数与特征时间尺度之间的关系。\n$$ \\frac{\\mu \\sigma L^2}{\\tau} \\approx 1 $$\n因此，特征磁扩散时间尺度 $\\tau$ 由下式给出：\n$$ \\tau = \\mu \\sigma L^2 $$\n这是磁场穿透到导体内部特征距离 $L$ 所需的时间。", "answer": "$$ \\boxed{\\mu \\sigma L^{2}} $$", "id": "3328292"}, {"introduction": "现在，我们从连续介质的物理学转向离散的计算建模世界。这个编程练习聚焦于 $T$-$\\Omega$ 公式及其对电流连续性的巧妙处理。您将通过实现离散算子来探索规范自由度（gauge freedom）和拓扑零空间（topological nullspaces）的概念，从而学会如何为单连通和多连通导体确保一个适定的（well-posed）数值系统。[@problem_id:3328303]", "problem": "在计算电磁学的磁准静态范畴中，从麦克斯韦方程组的微分形式出发，并考虑导体内部传导电流远大于位移电流的磁准静态（MQS）近似。在此背景下，$T$-$\\Omega$ 公式在导电区域使用矢量电流势 $\\mathbf{T}$，在非导电区域使用磁标势 $\\Omega$。导电区域满足 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$，并定义电流密度 $\\mathbf{J} = \\nabla \\times \\mathbf{T}$。非导电区域满足 $\\nabla \\times \\mathbf{H} = \\mathbf{0}$，因此有 $\\mathbf{H} = -\\nabla \\Omega$。\n\n因为对于任何足够光滑的标量场 $\\psi$，都有 $\\nabla \\times (\\nabla \\psi) = \\mathbf{0}$，所以变换 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 不会改变 $\\mathbf{J} = \\nabla \\times \\mathbf{T}$。这产生了一种规范不变性，并相应地在与梯度场相关的离散系统中产生了一个零空间。任务是在离散设置中，识别与 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 相关的零空间，并构建一个最小约束集来消除此零空间，同时不使系统被过度约束，从而只保留具有物理意义的自由度（包括可能与多连通拓扑相关的谐波分量）。\n\n使用以下基于代表导体的二维单元复形上的定向关联算子的离散框架：\n\n- 设 $V$ 为节点数（标量势自由度），$E$ 为定向边数（矢量电流势自由度），$F$ 为定向面（单元）数。\n- 定义离散梯度算子 $G \\in \\mathbb{R}^{E \\times V}$，它通过边差分将节点标量势 $\\psi \\in \\mathbb{R}^{V}$ 映射到边值 $\\mathbf{T} \\in \\mathbb{R}^{E}$，即 $\\mathbf{T} = G \\psi$。\n- 定义离散旋度算子 $C \\in \\mathbb{R}^{F \\times E}$，它通过对每个面周围的定向边贡献求和，将边值 $\\mathbf{T}$ 映射到面环流，即离散意义上的 $\\nabla \\times \\mathbf{T}$。\n- 与规范相关的零空间由集合 $\\{\\nabla \\psi : \\psi \\in \\mathbb{R}^{V}\\}$ 给出，它对应于 $G$ 的值域。其维度等于 $G$ 的秩，即 $V - N_c$，其中 $N_c$ 是节点图的连通分量数。\n- 消除此零空间的最小约束集可通过对所有标量测试函数 $q$ 强制执行弱无散条件 $\\int_{\\Omega} (\\nabla \\cdot \\mathbf{T}) q \\, d\\Omega = 0$ 来获得，在具有标准欧几里得内积的离散设置中，这简化为 $G^{\\top} \\mathbf{T} = \\mathbf{0}$。设 $D := G^{\\top}$ 为约束矩阵；则 $\\operatorname{rank}(D) = \\operatorname{rank}(G) = V - N_c$，这恰好消除了与规范相关的自由度，而没有过度约束系统。\n- 应用约束后，$C$ 的剩余零空间对应于与拓扑（例如孔洞）相关的谐波边场，其维度等于第一贝蒂数 $b_1$。\n\n实现一个程序，该程序：\n1. 为指定的测试网格构建 $G$、 $C$ 和 $D = G^{\\top}$。\n2. 计算 $\\dim(\\mathcal{N}_{\\text{gauge}}) = \\operatorname{rank}(G)$、 $D$ 的秩，以及剩余零空间维度 $\\dim\\big(\\{\\mathbf{T} : C \\mathbf{T} = \\mathbf{0},\\, D \\mathbf{T} = \\mathbf{0}\\}\\big) = E - \\operatorname{rank}([C; D])$，其中 $ [C; D] $ 表示 $C$ 和 $D$ 的垂直堆叠。\n\n使用以下导体网格测试套件（每个网格通过矩形网格和面移除来创建孔洞，以及可能多个不连通分量，从而定义 $V$、 $E$、 $F$）：\n\n- 测试用例 1（正常路径）：一个单连通的 $2 \\times 2$ 矩形导体。它有 $3 \\times 3$ 个节点，没有孔洞。\n- 测试用例 2（多连通）：一个 $3 \\times 3$ 的矩形导体，移除了中心面以创建一个孔洞。\n- 测试用例 3（边缘情况，不连通）：两个不连通的 $1 \\times 1$ 矩形导体（无孔洞），共同作为一个具有两个分量的单个网格处理。\n\n对于每个测试用例，计算并返回：\n- $d_{\\text{gauge}} = \\operatorname{rank}(G)$，\n- $r_D = \\operatorname{rank}(D)$，\n- $d_{\\text{remain}} = E - \\operatorname{rank}([C; D])$。\n\n所有输出均为整数。您的程序应生成一行输出，其中包含测试用例的结果，格式为逗号分隔的列表的列表，用方括号括起来，并按测试用例的顺序排列。例如，您的程序必须打印一行格式为 $[[d_{\\text{gauge}},r_D,d_{\\text{remain}}],[\\dots],[\\dots]]$ 的内容。\n\n不涉及物理单位或角度单位；这些量是从离散算子上的线性代数推导出的纯整数。", "solution": "该问题要求分析在磁准静态的T-$\\Omega$公式中出现的离散算子的零空间结构。我们首先按照指定协议验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n-   **物理模型：** 磁准静态（MQS）近似，其中传导电流远大于位移电流。\n-   **公式：** T-$\\Omega$ 公式，在导体中使用矢量电流势 $\\mathbf{T}$（$\\mathbf{J} = \\nabla \\times \\mathbf{T}$），在非导体中使用磁标势 $\\Omega$（$\\mathbf{H} = -\\nabla \\Omega$）。\n-   **规范不变性：** 变换 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 保持电流密度 $\\mathbf{J}$ 不变。\n-   **离散框架：** 一个具有 $V$ 个节点、$E$ 条边和 $F$ 个面的二维单元复形。\n    -   离散梯度：$G \\in \\mathbb{R}^{E \\times V}$，将节点值映射到边值。\n    -   离散旋度：$C \\in \\mathbb{R}^{F \\times E}$，将边值映射到面值。\n-   **零空间定义：**\n    -   规范零空间：$G$ 的值域，$\\operatorname{ran}(G)$，其维度为 $\\dim(\\operatorname{ran}(G)) = \\operatorname{rank}(G) = V - N_c$，其中 $N_c$ 是连通分量的数量。\n    -   约束：通过约束矩阵 $D := G^{\\top}$ 施加弱无散条件，得到约束方程 $D \\mathbf{T} = \\mathbf{0}$。\n    -   剩余零空间：谐波场的空间，$\\{\\mathbf{T} : C \\mathbf{T} = \\mathbf{0}, D \\mathbf{T} = \\mathbf{0}\\}$，其维度为 $E - \\operatorname{rank}([C; D])$。\n-   **任务：** 对于三个指定的网格，构建 $G$、$C$ 和 $D$，并计算维度 $d_{\\text{gauge}} = \\operatorname{rank}(G)$、$r_D = \\operatorname{rank}(D)$ 和 $d_{\\text{remain}} = E - \\operatorname{rank}([C; D])$。\n-   **测试用例：**\n    1.  一个单连通的 $2 \\times 2$ 矩形导体。\n    2.  一个 $3 \\times 3$ 的矩形导体，中心面被移除（一个孔洞）。\n    3.  两个不连通的 $1 \\times 1$ 矩形导体。\n-   **输出格式：** 逗号分隔的列表的列表：$[[d_{\\text{gauge}}, r_D, d_{\\text{remain}}], \\dots]$。\n\n**步骤2：使用提取的已知信息进行验证**\n-   **科学依据：** 该问题牢固地植根于计算电磁学和离散流形上的矢量微积分（一个通常称为离散外微分的领域）的原理。T-$\\Omega$ 公式、MQS 近似、规范自由度以及关联算子（$G$ 和 $C$）的使用都是标准概念。算子秩与拓扑不变量（$N_c$，连通分量数，和 $b_1$，第一贝蒂数）之间的关系是代数拓扑在数学上可靠的推论。\n-   **良态性：** 该问题为要构建的数学对象和要计算的量提供了明确的定义。每个计算都存在一个唯一的、有意义的整数解。\n-   **客观性：** 语言正式、精确，没有任何主观性。\n\n**步骤3：结论与行动**\n该问题具有科学有效性、良态性和客观性。它不包含任何矛盾、歧义或不成立的前提。因此，我们可以继续进行求解。\n\n### 基于原理的解决方案\n\n该解决方案涉及为每个指定的网格拓扑构建离散算子，然后使用数值线性代数来确定所需的秩和零空间维度。该方法基于应用于离散单元复形的代数拓扑原理。\n\n**1. 导体域的离散化**\n导体由一个二维单元复形表示。该复形的元素是节点（顶点，0-胞腔）、边（1-胞腔）和面（2-胞腔）。我们分别用 $V$、$E$ 和 $F$ 表示它们的数量。对于每个测试用例，我们通过定义构成网格的节点、边和面集来构建此复形。\n-   **节点：** 对于一个 $N_x \\times N_y$ 的网格，节点由整数对 $(i, j)$ 索引，其中 $i \\in [0, N_x]$ 且 $j \\in [0, N_y]$。可以为每个节点分配一个唯一的整数索引，例如 $k = i \\cdot (N_y+1) + j$。\n-   **边：** 边连接相邻节点。我们定义两组：连接 $(i, j)$ 到 $(i+1, j)$ 的水平边和连接 $(i, j)$ 到 $(i, j+1)$ 的垂直边。每条边都被赋予一个固定的方向，例如，从较小的坐标索引到较大的坐标索引。\n-   **面：** 面是由四条边界定的基本矩形单元。通过从完整网格中移除面来创建孔洞。\n\n**2. 离散算子的构建**\n线性算子 $G$ 和 $C$ 分别是表示离散梯度和旋度的关联矩阵。\n\n-   **离散梯度 $G \\in \\mathbb{R}^{E \\times V}$：** 此算子将定义在节点上的标量势（所谓的 $0$-形式）映射到定义在边上的矢量势分量（$1$-形式）。对于一条从节点 $v_i$ 指向节点 $v_j$ 的边 $e_k$，$G$ 的第 $k$ 行在第 $i$ 列包含一个 $-1$，在第 $j$ 列包含一个 $+1$，所有其他条目均为 $0$。这表示跨边的电势差。\n    $$ (G\\psi)_k = \\psi_j - \\psi_i $$\n-   **离散旋度 $C \\in \\mathbb{R}^{F \\times E}$：** 此算子将边值（$1$-形式）映射到面上的标量值（$2$-形式）。对于一个由一组定向边 $\\partial f_k$ 界定的面 $f_k$，$C$ 的第 $k$ 行计算环流。如果边 $e_l$ 是 $\\partial f_k$ 的一部分且其方向与面的方向（例如，逆时针）匹配，则条目 $C_{kl}$ 为 $+1$；如果方向相反，则为 $-1$；否则为 $0$。\n    $$ (C\\mathbf{T})_k = \\sum_{e_l \\in \\partial f_k} \\sigma_{kl} T_l \\quad (\\sigma_{kl} \\in \\{-1, 1\\}) $$\n\n**3. 规范零空间与约束**\n规范自由度 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 在离散设置中被捕获为 $\\mathbf{T} \\mapsto \\mathbf{T} + G\\psi$。所有此类规范变换的集合形成一个子空间 $\\operatorname{ran}(G)$，这是物理问题的零空间，因为 $C(G\\psi) = \\mathbf{0}$（梯度的旋度为零）。\n-   **规范零空间维度, $d_{\\text{gauge}}$：** 这个与规范相关的零空间的维度是 $G$ 的值域的维度，即 $\\operatorname{rank}(G)$。从代数拓扑可知，$\\operatorname{rank}(G) = V - N_c$，其中 $N_c$ 是网格的连通分量数。我们将其计算为 $d_{\\text{gauge}} = \\operatorname{rank}(G)$。\n-   **约束矩阵 $D = G^{\\top}$：** 为了消除规范自由度，我们对 $\\mathbf{T}$ 施加约束。条件 $\\nabla \\cdot \\mathbf{T} = 0$ 在弱意义上通过要求 $G^{\\top} \\mathbf{T} = \\mathbf{0}$ 来施加。矩阵 $D = G^{\\top} \\in \\mathbb{R}^{V \\times E}$ 是离散散度算子。约束的秩 $r_D = \\operatorname{rank}(D) = \\operatorname{rank}(G^{\\top})$ 必须等于 $d_{\\text{gauge}}$，以便完全消除规范自由度而不过度约束系统。由于 $\\operatorname{rank}(A) = \\operatorname{rank}(A^{\\top})$，我们期望 $r_D = d_{\\text{gauge}}$。\n\n**4. 剩余（谐波）零空间**\n施加约束后，我们感兴趣的是组合系统的零空间：$\\{\\mathbf{T} \\in \\mathbb{R}^E \\mid C\\mathbf{T} = \\mathbf{0} \\text{ and } D\\mathbf{T} = \\mathbf{0}\\}$。这对应于既无旋又无散的矢量场，称为谐波场。这个空间的维度 $d_{\\text{remain}}$ 等于域的第一贝蒂数 $b_1$，它表示拓扑“孔洞”或“隧道”的数量。\n为了计算这个维度，我们形成一个堆叠矩阵 $S = [C; D]$。$S$ 的零度给出了 $d_{\\text{remain}}$。根据秩-零度定理，$\\operatorname{rank}(S) + \\operatorname{nullity}(S) = E$。因此，\n$$ d_{\\text{remain}} = E - \\operatorname{rank}([C; D]) $$\n\n**5. 实现与测试用例执行**\n算法首先为每个测试用例定义生成网格结构。对于具有多个不连通分量的情况，为每个分量构建局部的 $G$ 和 $C$ 矩阵，然后将它们组装成全局块对角矩阵。总边数 $E$ 是所有分量中边数的总和。最后，使用标准的数值线性代数例程计算 $G$、$D$ 和堆叠矩阵 $[C; D]$ 的秩。\n\n-   **测试用例 1（$2 \\times 2$ 网格）：** $V=9, E=12, F=4, N_c=1, b_1=0$。\n    -   $d_{\\text{gauge}} = V-N_c = 9-1=8$。\n    -   $r_D = 8$。\n    -   $d_{\\text{remain}} = b_1 = 0$。\n-   **测试用例 2（带一个孔洞的 $3 \\times 3$ 网格）：** $V=16, E=24, F=8, N_c=1, b_1=1$。\n    -   $d_{\\text{gauge}} = V-N_c = 16-1=15$。\n    -   $r_D = 15$。\n    -   $d_{\\text{remain}} = b_1 = 1$。\n-   **测试用例 3（两个 $1 \\times 1$ 网格）：** 两个分量。分量1：$V_1=4, E_1=4$。分量2：$V_2=4, E_2=4$。总计：$V=8, E=8, F=2, N_c=2, b_1=0$。\n    -   $d_{\\text{gauge}} = V-N_c = 8-2=6$。\n    -   $r_D = 6$。\n    -   $d_{\\text{remain}} = b_1 = 0$。\n\n该问题的解决方案应为这些理论预测的数值计算结果，其输出为一个特定格式的字符串。根据计算，预期的结果是 `[[8,8,0],[15,15,1],[6,6,0]]`。", "answer": "[[8,8,0],[15,15,1],[6,6,0]]", "id": "3328303"}]}