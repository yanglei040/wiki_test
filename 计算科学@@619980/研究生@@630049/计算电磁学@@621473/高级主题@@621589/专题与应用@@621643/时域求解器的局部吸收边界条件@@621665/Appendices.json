{"hands_on_practices": [{"introduction": "理想的吸收边界条件（ABC）应完全吸收出射波，不产生任何反射。本练习通过分析法向入射的平面波，揭示了完美吸收的基本条件，它将反射系数与边界阻抗和媒质的本征阻抗联系起来，为所有ABC的设计奠定了理论基础。通过这个推导，您将理解阻抗匹配是实现无反射边界的关键概念 [@problem_id:3324491]。", "problem": "考虑在均匀、各向同性、非色散介质中的时域麦克斯韦方程组，该介质的介电常数为 $\\varepsilon$，磁导率为 $\\mu$，\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = - \\mu \\, \\frac{\\partial \\mathbf{H}(\\mathbf{r},t)}{\\partial t}, \\qquad\n\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\varepsilon \\, \\frac{\\partial \\mathbf{E}(\\mathbf{r},t)}{\\partial t},\n$$\n其中 $\\mathbf{E}$ 和 $\\mathbf{H}$ 分别是电场和磁场。该介质的本征阻抗为 $\\eta = \\sqrt{\\mu/\\varepsilon}$，波速为 $c = 1/\\sqrt{\\mu \\varepsilon}$。一个计算域被位于 $z = 0$ 处的平面边界截断，其外向单位法向量为 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$。在该边界上，应用了时域中的局部基于Silver–Müller的吸收边界条件 (ABC)，其形式为\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\, \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0,\n$$\n其中 $\\eta_{b}>0$ 是一个给定的边界阻抗参数，下标 ${t}$ 表示场相对于边界的切向分量。\n\n一列角频率为 $\\omega$ 的线性偏振平面波，从计算域内部垂直入射到该边界上，沿 $+\\hat{\\mathbf{z}}$ 方向传播。其电场为\n$$\n\\mathbf{E}_{\\text{i}}(\\mathbf{r},t) = \\Re\\!\\left\\{\\mathbf{E}_{0} \\exp\\!\\big(-\\mathrm{i}\\omega t + \\mathrm{i} k z\\big)\\right\\}, \\quad \\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{x}}, \\quad k = \\frac{\\omega}{c},\n$$\n相应的磁场满足平面波关系 $\\mathbf{H}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\mathbf{E}_{\\text{i}}$，其中 $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ 是单位传播方向。\n\n假设边界产生一列镜面反射平面波，令 $\\Gamma$ 表示复反射系数（在 $z=0$ 处，反射电场相量振幅与入射电场相量振幅之比）。仅使用上述控制方程和边界条件，推导 $\\Gamma$ 关于 $\\eta$ 和 $\\eta_{b}$ 的闭式表达式。将最终的反射系数表示为一个无量纲的复振幅。不需要进行数值舍入，最终答案中也不应包含物理单位。", "solution": "该问题基于电磁学的基本原理和计算电磁学的标准实践，问题设定良好且科学合理。我们可以开始求解。\n\n问题要求解一个垂直入射到由Silver-Müller型吸收边界条件 (ABC) 定义的边界上的平面波的复反射系数 $\\Gamma$。使用复相量在频域中进行分析是最佳方法。\n\n首先，我们用相量形式表示入射波和反射波。时域场与其相量对应项 $\\tilde{\\mathbf{E}}(\\mathbf{r})$ 和 $\\tilde{\\mathbf{H}}(\\mathbf{r})$ 的关系为 $\\mathbf{E}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$ 和 $\\mathbf{H}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{H}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$，其中 $\\mathrm{i}$ 是虚数单位。\n\n沿 $+\\hat{\\mathbf{z}}$ 方向传播的入射电场相量由下式给出\n$$\n\\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) = \\mathbf{E}_{0} \\exp(\\mathrm{i} k z) = E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\n其中 $k = \\omega/c$ 是波数。相应的入射磁场相量可使用平面波关系 $\\tilde{\\mathbf{H}}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\tilde{\\mathbf{E}}_{\\text{i}}$ 求得，其中 $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ 是传播方向，$\\eta = \\sqrt{\\mu/\\varepsilon}$ 是介质的本征阻抗。\n$$\n\\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) = \\frac{1}{\\eta} \\hat{\\mathbf{z}} \\times \\big( E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\n接下来，我们定义反射波，假设它是一个镜面反射的平面波。对于垂直入射到位于 $z=0$ 的平面边界上的情况，反射波沿 $-\\hat{\\mathbf{z}}$ 方向传播。反射系数 $\\Gamma$ 是在边界 $z=0$ 处，反射电场相量振幅与入射电场相量振幅之比。因此，反射电场相量为\n$$\n\\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\n我们假设反射电场的偏振与入射电场相同，这对于这种各向同性边界条件是符合预期的。相应的反射磁场相量可使用沿 $\\hat{\\mathbf{k}}_\\text{r} = -\\hat{\\mathbf{z}}$ 方向传播的波的平面波关系求得：$\\tilde{\\mathbf{H}}_{\\text{r}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}}_\\text{r} \\times \\tilde{\\mathbf{E}}_{\\text{r}}$。\n$$\n\\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{1}{\\eta} (-\\hat{\\mathbf{z}}) \\times \\big( \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\n总电场和磁场是入射场和反射场的叠加：\n$$\n\\tilde{\\mathbf{E}}(\\mathbf{r}) = \\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = E_{0} \\big( \\exp(\\mathrm{i} k z) + \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(\\mathbf{r}) = \\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{E_{0}}{\\eta} \\big( \\exp(\\mathrm{i} k z) - \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{y}}\n$$\n\n现在，我们在平面 $z=0$ 处应用吸收边界条件。ABC 在时域中给出为\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0\n$$\n其中下标 $t$ 表示相对于边界的切向分量。对于谐波时间依赖性 $\\exp(-\\mathrm{i}\\omega t)$，此 ABC 直接变换到频域为\n$$\n\\tilde{\\mathbf{E}}_{t}(\\mathbf{r}) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\tilde{\\mathbf{H}}_{t}(\\mathbf{r}) \\quad \\text{for} \\quad z=0\n$$\n外向单位法向量为 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$。在边界 $z=0$ 处，总场为\n$$\n\\tilde{\\mathbf{E}}(z=0) = E_{0} (1+\\Gamma) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(z=0) = \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}}\n$$\n由于 $\\tilde{\\mathbf{E}}(z=0)$ 和 $\\tilde{\\mathbf{H}}(z=0)$ 完全位于 $xy$-平面内，它们分别等于其切向分量 $\\tilde{\\mathbf{E}}_{t}(z=0)$ 和 $\\tilde{\\mathbf{H}}_{t}(z=0)$。\n\n将这些代入相量域的 ABC 中：\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\, \\hat{\\mathbf{z}} \\times \\left( \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}} \\right)\n$$\n我们计算叉积：$\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{y}} = -\\hat{\\mathbf{x}}$。\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\frac{E_{0}}{\\eta} (1-\\Gamma) (-\\hat{\\mathbf{x}})\n$$\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = \\frac{\\eta_{b}}{\\eta} E_{0} (1-\\Gamma) \\hat{\\mathbf{x}}\n$$\n由于 $E_{0}$ 非零，我们可以从两边消去向量项 $E_{0}\\hat{\\mathbf{x}}$，得到一个关于 $\\Gamma$ 的标量方程：\n$$\n1+\\Gamma = \\frac{\\eta_{b}}{\\eta} (1-\\Gamma)\n$$\n我们现在求解 $\\Gamma$。两边乘以 $\\eta$：\n$$\n\\eta(1+\\Gamma) = \\eta_{b}(1-\\Gamma)\n$$\n$$\n\\eta + \\eta\\Gamma = \\eta_{b} - \\eta_{b}\\Gamma\n$$\n重新整理各项，将含有 $\\Gamma$ 的项组合在一起：\n$$\n\\eta\\Gamma + \\eta_{b}\\Gamma = \\eta_{b} - \\eta\n$$\n$$\n\\Gamma (\\eta + \\eta_{b}) = \\eta_{b} - \\eta\n$$\n最后，两边除以 $(\\eta + \\eta_{b})$，得到反射系数的闭式表达式：\n$$\n\\Gamma = \\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}\n$$\n该表达式是无量纲的，并用指定的参数 $\\eta$ 和 $\\eta_{b}$ 表示。这是在具有表面阻抗 $\\eta_b$ 的边界上反射的著名公式。对于完美吸收垂直入射波的理想Silver-Müller ABC，会设置 $\\eta_b = \\eta$，从而得到 $\\Gamma=0$。", "answer": "$$\\boxed{\\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}}$$", "id": "3324491"}, {"introduction": "在理解了理想的法向入射情况后，我们必须考察更贴近现实的斜入射场景。本练习将探讨为法向入射设计的简单单向波算子ABC在波以一定角度入射时的性能表现。通过推导反射系数与入射角的函数关系，您将揭示这类简单ABC的一个关键局限性：其性能在掠射（接近90度角）时会急剧恶化，从而理解发展更复杂ABC的必要性 [@problem_id:3324557]。", "problem": "考虑一个二维、均匀、各向同性的无源电磁介质，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，因此波速为 $c = (\\varepsilon \\mu)^{-1/2}$。在这种介质中，电场的每个笛卡尔分量都满足标量波动方程 $u_{tt} = c^{2}(u_{xx} + u_{yy})$，其中 $u(x,y,t)$ 表示电场的一个分量。设计算域为半空间 $x \\ge 0$，在 $x = 0$ 处有一个平面人工边界，并考虑实施一个局部吸收边界条件 (ABC)，该条件在边界上施加单向算子，\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\n假设一个角频率为 $\\omega$ 的时谐平面波在内部向边界传播，其相量表示和时间依赖性为 $\\exp(-\\mathrm{i}\\,\\omega t)$，因此入射场为\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\n其中色散关系 $k^{2} = k_{x}^{2} + k_{y}^{2} = (\\omega/c)^{2}$ 成立。设入射角 $\\theta \\in [0,\\pi/2)$ 是相对于边界法线（$+x$ 轴）以弧度为单位测量的，因此 $k_{x} = -k\\cos\\theta$ 和 $k_{y} = k\\sin\\theta$，其中 $k = \\omega/c$。边界附近的总场是入射场和镜面反射场 $u_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big)$ 的叠加 $u_{t} = u_{i} + R\\,u_{r}$，其中反射系数为 $R(\\theta)$。\n\n从波动方程和平面波色散关系出发，仅使用 $x=0$ 处的边界算子 $(\\partial_{t} - c\\,\\partial_{x})$，推导出所引起的反射系数 $R(\\theta)$ 完全用 $\\sin\\theta$ 表示的精确闭式表达式。然后，通过对你的结果进行渐近分析，确定在掠射极限 $\\theta \\to \\pi/2$ 下反射幅度的主要标度关系，并解释为何这种行为暴露了单向算子用于局部吸收边界条件在掠射情况下的局限性。\n\n请提供你的最终答案，形式为仅依赖于 $\\sin\\theta$ 的单个 $R(\\theta)$ 的闭式解析表达式。不需要数值近似。角度必须以弧度为单位处理。", "solution": "在均匀各向同性介质中，电磁场分量满足麦克斯韦方程组。在无源且材料参数恒定的情况下，电场的每个笛卡尔分量都满足标量波动方程\n$$\nu_{tt} = c^{2}(u_{xx} + u_{yy}),\n$$\n其中 $c = (\\varepsilon \\mu)^{-1/2}$ 是波速。一个时谐平面波解具有形式\n$$\nu(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\n且满足色散关系\n$$\nk^{2} = k_{x}^{2} + k_{y}^{2} = \\left(\\frac{\\omega}{c}\\right)^{2}.\n$$\n设平面人工边界位于 $x=0$ 处，计算域为 $x \\ge 0$。通过波动算子的单向算子分解推导出的局部吸收边界条件 (ABC) 施加\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\n该算子会湮没向 $x$ 减小方向传播的波（左行波），并且对于垂直于边界的波是一阶精确的。为了研究斜入射的反射情况，考虑一个从域内向边界传播的入射平面波。入射角 $\\theta \\in [0,\\pi/2)$ 是相对于边界法线（$+x$ 轴）定义的，波数分量为\n$$\nk_{x} = -k\\cos\\theta,\\quad k_{y} = k\\sin\\theta,\\quad k = \\frac{\\omega}{c}.\n$$\n入射场为\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(-k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big),\n$$\n而反射场，根据镜面对称性，为\n$$\nu_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big).\n$$\n边界附近的总场为 $u_{t} = u_{i} + R\\,u_{r}$，其中 $R(\\theta)$ 是我们旨在计算的复反射系数。将边界算子应用于 $x=0$ 处的总场，得到\n$$\n\\left[(\\partial_{t} - c\\,\\partial_{x})(u_{i} + R\\,u_{r})\\right]_{x=0} = 0.\n$$\n我们来计算导数。对于时间导数，\n$$\n\\partial_{t} u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i},\\qquad \\partial_{t} u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r}.\n$$\n对于沿 $x$ 的空间导数，\n$$\n\\partial_{x} u_{i} = \\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i},\\qquad \\partial_{x} u_{r} = \\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r}.\n$$\n因此，\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} - c\\,\\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} + \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{i}.\n$$\n类似地，\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - c\\,\\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{r}.\n$$\n使用 $c\\,k = \\omega$，这些式子简化为\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,u_{i},\\qquad\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,u_{r}.\n$$\n在 $x=0$ 处，入射场和反射场在 $y$ 和 $t$ 上具有相同的相位因子，并且在 $x$ 方向上的振幅为单位值，因为 $\\exp(\\mathrm{i}\\,(\\pm k\\cos\\theta\\,x))\\big|_{x=0} = 1$。记 $U_{0} = \\exp\\!\\big(\\mathrm{i}\\,(k\\sin\\theta\\,y - \\omega t)\\big)$，我们有 $u_{i}\\big|_{x=0} = U_{0}$ 和 $u_{r}\\big|_{x=0} = U_{0}$。边界条件变为\n$$\n-\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,U_{0} + R\\,\\big(-\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,U_{0}\\big) = 0.\n$$\n两边同除以 $-\\mathrm{i}\\,\\omega\\,U_{0}$ 得到\n$$\n(1 - \\cos\\theta) + R\\,(1 + \\cos\\theta) = 0,\n$$\n所以反射系数为\n$$\nR(\\theta) = -\\,\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}.\n$$\n为了仅用 $\\sin\\theta$ 表示 $R(\\theta)$，注意到对于 $\\theta \\in [0,\\pi/2)$，有 $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$。代入此恒等式得到\n$$\nR(\\theta) = -\\,\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}.\n$$\n这就是所要求的仅依赖于 $\\sin\\theta$ 的闭式解析表达式。\n\n对于掠射情况，$\\theta \\to \\pi/2$，所以 $\\sin\\theta \\to 1$，因此 $\\cos\\theta \\to 0$。根据精确公式，\n$$\nR(\\theta) \\xrightarrow[\\theta \\to \\pi/2]{} -\\,\\frac{1 - 0}{1 + 0} = -1,\n$$\n这表明在极限情况下发生全反射。与 $-1$ 的主阶偏差可以通过对小的 $\\cos\\theta$ 展开分子和分母得到，\n$$\n1 + R(\\theta) = \\frac{2\\,\\cos\\theta}{1 + \\cos\\theta} \\sim 2\\,\\cos\\theta \\quad \\text{as} \\quad \\cos\\theta \\to 0.\n$$\n用 $\\sin\\theta$ 表示，使用 $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$ 得到\n$$\n1 + R(\\theta) \\sim 2\\,\\sqrt{1 - \\sin^{2}\\theta} \\quad \\text{as} \\quad \\sin\\theta \\to 1.\n$$\n因此，对于掠射情况，感应反射系数的幅度趋近于1，而其系数与-1的偏差的标度关系如同 $1 - \\sin^{2}\\theta$ 的平方根。这暴露了局部单向算子ABC的一个局限性：它对于法向入射（$\\theta = 0$ 产生 $R = 0$）是精确的，但随着入射变为掠射，它会变得具有高反射性，这是低阶局部ABC对于具有大切向波数的波的一个已知缺陷。", "answer": "$$\\boxed{-\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}}$$", "id": "3324557"}, {"introduction": "最后一步是将理论洞察转化为时域有限差分（FDTD）模拟的离散世界。这个练习从连续的解析公式转向了数值计算，为您提供了一个量化和评估ABC性能的实践机会。通过计算和比较一阶和二阶Mur氏ABC对斜入射离散平面波的反射，您将亲身体验到高阶条件在处理宽角度波传播问题时为何至关重要 [@problem_id:3324495]。", "problem": "考虑一个二维时域有限差分法（FDTD）公式，用于处理$z$轴横磁（$\\mathrm{TM}_z$）极化，其非零场分量为 $E_z$、$H_x$ 和 $H_y$。设Yee网格间距满足 $\\Delta x = \\Delta y$，并将库朗数 $S$ 定义为 $S = c \\Delta t / \\Delta x$，其中 $c$ 是光速。假设区域是离散均匀、各向同性且无损的。假设体介质中存在一个单色离散平面波解，形式为 $E_z(m, j, n) = \\Re\\{ \\tilde{E} \\exp(j (n \\, \\omega \\Delta t - m \\, k_x \\Delta x - j \\, k_y \\Delta y)) \\}$，其中 $m, j, n$ 分别是 $x$、$y$ 和时间的整数索引，$k_x$、$k_y$ 和 $\\omega$ 分别表示离散波数分量和角频率。二维Yee格式下 $\\mathrm{TM}_z$ 的离散色散关系是一个经过充分检验的公式\n$$\n\\sin^2\\!\\left(\\frac{\\omega \\Delta t}{2}\\right) \\;=\\; S^2 \\left[ \\sin^2\\!\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\!\\left(\\frac{k_y \\Delta y}{2}\\right) \\right],\n$$\n您可以将其作为一个基本依据。\n\n我们在平面 $m=0$ 处放置一个垂直于 $x$ 方向的局部吸收边界。一个入射角为 $\\theta$（定义为传播方向与边界法线，即$+x$轴之间的夹角）的离散平面波，其相位方向由 $(k_x, k_y)$ 决定，我们定义无量纲的相位分量为 $\\kappa_x = k_x \\Delta x$ 和 $\\kappa_y = k_y \\Delta y$。对于给定的角度 $\\theta$，选择一个无量纲的总波数大小 $\\kappa$，并设置 $\\kappa_x = \\kappa \\cos \\theta$ 和 $\\kappa_y = \\kappa \\sin \\theta$。然后，离散角频率由色散关系确定\n$$\n\\sin\\!\\left(\\frac{u}{2}\\right) \\;=\\; S \\,\\sqrt{ \\sin^2\\!\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\!\\left(\\frac{\\kappa_y}{2}\\right) }, \\quad \\text{其中 } u = \\omega \\Delta t,\n$$\n取主支 $u \\in [0,\\pi]$。\n\n我们考虑两种仅应用于 $m=0$ 处离散场 $E_z$ 的局部吸收边界条件（ABC）：\n\n1) 一阶Mur吸收边界条件（Mur-1），写成仅使用 $m=0$ 和 $m=1$ 处场的完全离散形式：\n$$\nE_z^{n+1}(0,j) \\;=\\; E_z^{n}(1,j) \\;+\\; r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right],\n$$\n其中 $r = \\dfrac{S - 1}{S + 1}$。\n\n2) 一种二阶局部Mur型吸收边界条件（Mur-2），通过在时域中对精确单向算子进行二阶近似，并对切向曲率项进行梯形时间积分推导得出，得到以下显式边界更新：\n$$\n(1 - \\tfrac{S}{2}) \\, E_z^{n+1}(0,j) \\;+\\; \\tfrac{S}{2} \\, E_z^{n+1}(1,j) \\;=\\; \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] \\;+\\; \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) \\;-\\; \\tfrac{S}{2} \\, E_z^{n}(1,j).\n$$\n此更新仅使用当前和紧邻前一时间步的场以及边界上最近的切向邻点。\n\n假设一个从内部向边界传播的斜入射离散平面波：\n$$\nE_{z,\\text{inc}}^{n}(m,j) = \\exp\\!\\left( j \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\n以及一个反射波\n$$\nE_{z,\\text{ref}}^{n}(m,j) = R \\,\\exp\\!\\left( j \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\n其中 $R$ 为复反射系数。总场为 $E_z^n = E_{z,\\text{inc}}^n + E_{z,\\text{ref}}^n$。将此总场代入 $m=0$ 处的每个边界更新中，会得到一个关于 $R$ 的复线性方程，该方程对应于每个角频率 $u$ 和相位分量 $(\\kappa_x,\\kappa_y)$。\n\n任务。对于入射角 $\\theta = 60$ 度（角度必须以度为单位），以及固定的无量纲空间波数大小 $\\kappa = \\pi/2$，在约束条件 $\\Delta x = \\Delta y$ 下，计算几种不同库朗数 $S$ 对应的 Mur-2 和 Mur-1 吸收边界条件的数值反射系数的模 $\\lvert R \\rvert$。使用上述色散关系从 $(S,\\kappa_x,\\kappa_y)$ 确定 $u$。对于每个测试用例，报告一对浮点数值 $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$。\n\n角度单位说明。对 $\\theta$ 使用度。\n\n单位。最终输出不需要物理单位；所有数字均报告为无单位的浮点值。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是对应于一个测试用例的双元素列表，按以下给出的顺序排列，不含空格。例如：“[[0.1,0.2],[0.3,0.4]]”。\n\n测试套件。使用以下测试用例以确保覆盖与稳定性相关的库朗数：\n- 用例1（正常情况）：$S = 0.5$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n- 用例2（接近稳定性边缘）：$S = 0.7$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n- 用例3（小时间步长）：$S = 0.3$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n\n答案规范。输出必须是一个包含三个条目的列表，每个条目是一个包含两个浮点数的列表，顺序为 $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$，对应于上面列出的三个用例。", "solution": "该问题经评估有效。它在科学上基于计算电磁学的原理，特别是时域有限差分法（FDTD）和吸收边界条件（ABC）的分析。该问题是适定的、自洽的、客观的，提供了所有必要的方程、参数和明确的任务。其前提与既定理论一致，所需计算虽然不简单，但在数学上是合理的。\n\n目标是确定当一个离散平面波入射到两种不同的局部吸收边界条件 Mur-1 和 Mur-2 上时，复反射系数的模 $\\lvert R \\rvert$。该分析是通过将总场（入射波加反射波）的解析形式代入每种吸收边界条件的离散方程中来进行的。这个过程会产生一个关于 $R$ 的复线性方程，然后可以求解该方程。\n\n首先，我们为给定的测试用例定义参数：库朗数 $S$、入射角 $\\theta$ 和无量纲波数大小 $\\kappa$。\n角度 $\\theta$ 以度为单位给出，在进行三角函数计算时必须转换为弧度：$\\theta_{\\text{rad}} = \\theta \\cdot \\pi / 180$。\n无量纲波数分量由 $\\kappa_x = \\kappa \\cos \\theta_{\\text{rad}}$ 和 $\\kappa_y = \\kappa \\sin \\theta_{\\text{rad}}$ 给出。\n无量纲角频率 $u = \\omega \\Delta t$ 由离散色散关系确定：\n$$\nu = 2 \\arcsin\\left( S \\sqrt{ \\sin^2\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\left(\\frac{\\kappa_y}{2}\\right) } \\right)\n$$\n\n总场 $E_z$ 是入射波和反射波之和：\n$$\nE_z^n(m, j) = E_{z,\\text{inc}}^{n}(m,j) + E_{z,\\text{ref}}^{n}(m,j) = \\exp\\left( j \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right) + R \\exp\\left( j \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right)\n$$\n我们可以提出公共的时间和切向相位项：\n$$\nE_z^n(m, j) = \\exp(j(nu - j\\kappa_y)) \\left[ \\exp(-jm\\kappa_x) + R \\exp(jm\\kappa_x) \\right]\n$$\n我们定义一个与空间相关的部分 $Z_m = \\exp(-jm\\kappa_x) + R \\exp(jm\\kappa_x)$。吸收边界条件应用于边界 $m=0$ 处，因此我们需要 $m=0$ 和 $m=1$ 处的场：\n$Z_0 = 1 + R$\n$Z_1 = \\exp(-j\\kappa_x) + R \\exp(j\\kappa_x)$\n\n以下关系将用于处理时间步长和切向空间位移：\n$E_z^{n+1}(m, j) = E_z^n(m, j) \\exp(ju)$\n$E_z^{n}(m, j \\pm 1) = E_z^n(m, j) \\exp(\\mp j\\kappa_y)$\n\n**1. Mur-1 吸收边界条件的反射系数推导**\n\n一阶Mur吸收边界条件由下式给出：\n$$\nE_z^{n+1}(0,j) = E_z^{n}(1,j) + r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right], \\quad \\text{其中 } r = \\frac{S - 1}{S + 1}\n$$\n重新整理以获得更对称的形式：\n$$\n(S+1)E_z^{n+1}(0,j) + (S-1)E_z^{n}(0,j) = (S-1)E_z^{n+1}(1,j) + (S+1)E_z^{n}(1,j)\n$$\n代入平面波形式。在除以公共相位因子 $\\exp(j(nu - j\\kappa_y))$ 后，我们得到一个关于 $Z_0$ 和 $Z_1$ 的方程：\n$$\n(S+1)Z_0\\exp(ju) + (S-1)Z_0 = (S-1)Z_1\\exp(ju) + (S+1)Z_1\n$$\n$$\nZ_0 \\left[ (S+1)\\exp(ju) + (S-1) \\right] = Z_1 \\left[ (S-1)\\exp(ju) + (S+1) \\right]\n$$\n设 $A = (S+1)\\exp(ju) + (S-1)$ 和 $B = (S+1) + (S-1)\\exp(ju)$。方程为 $Z_0 A = Z_1 B$。\n代入 $Z_0$ 和 $Z_1$ 的表达式：\n$$\n(1+R)A = (\\exp(-j\\kappa_x) + R\\exp(j\\kappa_x)) B\n$$\n求解 $R$ 可得：\n$$\nA + RA = B\\exp(-j\\kappa_x) + RB\\exp(j\\kappa_x) \\implies R(A - B\\exp(j\\kappa_x)) = B\\exp(-j\\kappa_x) - A\n$$\n$$\nR_{\\text{Mur1}} = \\frac{B\\exp(-j\\kappa_x) - A}{A - B\\exp(j\\kappa_x)}\n$$\n\n**2. Mur-2 吸收边界条件的反射系数推导**\n\n二阶Mur型吸收边界条件由下式给出：\n$$\n(1 - \\tfrac{S}{2}) E_z^{n+1}(0,j) + \\tfrac{S}{2} E_z^{n+1}(1,j) = \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] + \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) - \\tfrac{S}{2} E_z^{n}(1,j)\n$$\n首先，简化切向有限差分项：\n$$\nE_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1) = E_z^n(0,j) (\\exp(-j\\kappa_y) - 2 + \\exp(j\\kappa_y)) = E_z^n(0,j) (2\\cos\\kappa_y - 2) = -4\\sin^2(\\kappa_y/2)E_z^n(0,j)\n$$\n将此结果和平面波形式代入吸收边界条件。在除以 $\\exp(j(nu-j\\kappa_y))$ 后，我们得到：\n$$\n(1 - \\tfrac{S}{2})Z_0\\exp(ju) + \\tfrac{S}{2}Z_1\\exp(ju) = \\left(\\tfrac{S^2}{2}\\right)Z_0(-4\\sin^2(\\kappa_y/2)) + \\left(1 + \\tfrac{S}{2}\\right)Z_0 - \\tfrac{S}{2}Z_1\n$$\n合并含 $Z_0$ 和 $Z_1$ 的项：\n$$\nZ_1 \\left( \\tfrac{S}{2}\\exp(ju) + \\tfrac{S}{2} \\right) = Z_0 \\left[ -2S^2\\sin^2(\\kappa_y/2) + \\left(1 + \\tfrac{S}{2}\\right) - \\left(1 - \\tfrac{S}{2}\\right)\\exp(ju) \\right]\n$$\n设 $C = \\tfrac{S}{2}(1 + \\exp(ju))$ 和 $D = -2S^2\\sin^2(\\kappa_y/2) + (1 + \\tfrac{S}{2}) - (1 - \\tfrac{S}{2})\\exp(ju)$。方程为 $Z_1 C = Z_0 D$。\n代入 $Z_0$ 和 $Z_1$ 的表达式：\n$$\n(\\exp(-j\\kappa_x) + R\\exp(j\\kappa_x)) C = (1+R) D\n$$\n求解 $R$ 可得：\n$$\nC\\exp(-j\\kappa_x) + RC\\exp(j\\kappa_x) = D + RD \\implies R(C\\exp(j\\kappa_x) - D) = D - C\\exp(-j\\kappa_x)\n$$\n$$\nR_{\\text{Mur2}} = \\frac{D - C\\exp(-j\\kappa_x)}{C\\exp(j\\kappa_x) - D}\n$$\n对于每个测试用例，使用参数 $S$、$\\theta$ 和 $\\kappa$ 来计算 $\\kappa_x$、$\\kappa_y$ 和 $u$。然后将这些值代入 $R_{\\text{Mur1}}$ 和 $R_{\\text{Mur2}}$ 的表达式中，以求得复反射系数。最终结果是它们的模，$\\lvert R_{\\text{Mur1}} \\rvert$ 和 $\\lvert R_{\\text{Mur2}} \\rvert$。", "answer": "[[0.06316279140670868,0.3333333333333333],[0.04639556108155998,0.22274475475932527],[0.09347313098522329,0.4727138356910694]]", "id": "3324495"}]}