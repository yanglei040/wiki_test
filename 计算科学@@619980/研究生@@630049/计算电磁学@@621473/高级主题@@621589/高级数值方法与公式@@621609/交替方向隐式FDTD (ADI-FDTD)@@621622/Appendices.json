{"hands_on_practices": [{"introduction": "本练习是理解ADI-FDTD方法核心机制的基础。你将从麦克斯韦方程组出发，为二维横磁（TM）波推导完整的两步更新方程。这项练习 [@problem_id:3289199] 将巩固你对算子分裂如何将问题转化为一系列一维三对角线系统（这是克服显式方法CFL稳定性限制的关键）的理解。", "problem": "考虑一个无损耗、均匀的二维电磁介质，其电介质常数为 $\\varepsilon$，磁导率为 $\\mu$，该介质在具有空间步长 $\\Delta x$ 和 $\\Delta y$ 以及时间步长 $\\Delta t$ 的均匀Yee网格上进行离散化。重点关注z方向的横磁极化（TM$_z$），其中非零场分量为 $(E_z, H_x, H_y)$。仅从微分形式的麦克斯韦旋度方程和场分量的标准交错Yee布局出发，构建一个分为两个子步的交替方向隐式时域有限差分（ADI-FDTD）方案：第一个子步在 $x$ 方向上是隐式的，第二个子步在 $y$ 方向上是隐式的。使用 Peaceman–Rachford 类型的时间分裂，通过从 $t^n$ 到 $t^{n+1/2}$ 和从 $t^{n+1/2}$ 到 $t^{n+1}$ 的半步更新来实现。\n\n你的任务是：\n- 推导第一个子步（在 $x$ 方向隐式）的全离散更新关系式，该关系式将 $(H_x, H_y, E_z)$ 从时间索引 $n$ 更新到 $n+\\tfrac{1}{2}$，使用与Yee网格交错结构一致的中心二阶差分算子。明确指出在此子步中哪些空间导数是隐式处理的，哪些是显式处理的。\n- 推导第二个子步（在 $y$ 方向隐式）的全离散更新关系式，该关系式将 $(H_x, H_y, E_z)$ 从时间索引 $n+\\tfrac{1}{2}$ 更新到 $n+1$，并再次指明空间导数的隐式与显式处理方式。\n- 对于每个子步，根据需要消除磁场未知量的隐式耦合，将 $E_z$ 的更新简化为沿隐式方向的一维三对角线性系统。用 $\\Delta t$、$\\varepsilon$、$\\mu$、$\\Delta x$ 和 $\\Delta y$ 明确写出每个子步中求解 $E_z$ 的三对角模板系数。同时，提供磁场更新中出现的显式有限差分模板系数。\n- 假设所有点均为内部点并忽略边界条件，以便标准中心差分处处适用。清晰定义你所采用的离散导数算子和Yee交错结构。\n\n最后，从第一个子步（在 $x$ 方向隐式）中 $E_z$ 的三对角系统中，提取三对角算子的中心系数（即乘以沿 $x$ 方向当前网格线索引处的 $E_z$ 的系数），并将其表示为关于 $\\Delta t$、$\\varepsilon$、$\\mu$ 和 $\\Delta x$ 的闭合形式解析表达式。将此中心系数作为你的最终答案报告。最终答案中不要包含单位。最终答案必须是单一的闭合形式解析表达式。", "solution": "该问题是有效的，因为它科学地基于麦克斯韦方程和成熟的ADI-FDTD数值方法，问题本身是适定的、客观的且自洽的。我们将着手进行推导。\n\n出发点是无源、无损耗、均匀介质中z方向横磁（TM$_z$）极化的麦克斯韦旋度方程，介质的电介质常数为 $\\varepsilon$，磁导率为 $\\mu$：\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} = \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n这些方程在一个二维Yee网格上进行离散化。一个网格点由对应于空间坐标 $(i\\Delta x, j\\Delta y)$ 的索引 $(i, j)$ 表示，一个时间步由对应于时间 $t^n = n\\Delta t$ 的索引 $n$ 表示。根据TM$_z$的标准Yee格式，场分量在空间和时间上是交错的：\n- $E_z$ 位于 $(i\\Delta x, j\\Delta y)$ 和整数时间步 $n\\Delta t$。我们将其表示为 $E_z|_{i,j}^n$。\n- $H_x$ 位于 $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 和半整数时间步 $(n+\\frac{1}{2})\\Delta t$。我们将其表示为 $H_x|_{i, j+1/2}^{n+1/2}$。\n- $H_y$ 位于 $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$ 和半整数时间步 $(n+\\frac{1}{2})\\Delta t$。我们将其表示为 $H_y|_{i+1/2, j}^{n+1/2}$。\n\n然而，ADI-FDTD方法通常在算法中将所有场分量置于相同的时间实例（$n, n+1/2, n+1$）。空间交错结构保持不变：\n- $E_z \\rightarrow E_z|_{i,j}$\n- $H_x \\rightarrow H_x|_{i, j+1/2}$\n- $H_y \\rightarrow H_y|_{i+1/2, j}$\n\n我们定义与此交错结构一致的二阶中心空间差分算子：\n$$\n\\delta_x f|_{i} = \\frac{f|_{i+1/2} - f|_{i-1/2}}{\\Delta x}, \\quad \\delta_y f|_{j} = \\frac{f|_{j+1/2} - f|_{j-1/2}}{\\Delta y}\n$$\n$$\n\\delta_x f|_{i+1/2} = \\frac{f|_{i+1} - f|_{i}}{\\Delta x}, \\quad \\delta_y f|_{j+1/2} = \\frac{f|_{j+1} - f|_{j}}{\\Delta y}\n$$\n对于半个时间步长 $\\Delta t/2$ 上的时间导数，我们使用一阶向前差分，例如 $\\frac{\\partial F}{\\partial t} \\approx \\frac{F^{n+1/2} - F^n}{\\Delta t/2}$。\n\nPeaceman-Rachford 分裂方案将从时间 $n$ 到 $n+1$ 的更新分为两个子步。TM$_z$ 系统方程的右侧算子被分裂为仅包含 $x$ 导数的算子 ($A_x$) 和仅包含 $y$ 导数的算子 ($A_y$)。\n\n**子步 1：从 $t^n$ 更新到 $t^{n+1/2}$（在 $x$ 方向隐式）**\n\n在此子步中，$x$ 导数被隐式处理（在时间 $n+1/2$ 处取值），而 $y$ 导数被显式处理（在时间 $n$ 处取值）。半离散方程为：\n$$\n\\varepsilon \\frac{E_z^{n+1/2} - E_z^n}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1/2} - H_x^n}{\\Delta t/2} = -\\frac{\\partial E_z^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1/2} - H_y^n}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\n应用定义的离散算子，我们得到全离散更新关系式：\n\n1.  以 $(i,j)$ 为中心的 $E_z$ 更新方程：\n    $$\n    \\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i-1/2,j}^{n+1/2}}{\\Delta x} - \\frac{H_x|_{i,j+1/2}^n - H_x|_{i,j-1/2}^n}{\\Delta y}\n    $$\n    在这里，作用于 $H_y$ 的 $\\delta_x$ 算子是隐式的，而作用于 $H_x$ 的 $\\delta_y$ 算子是显式的。\n\n2.  以 $(i+1/2,j)$ 为中心的 $H_y$ 更新方程：\n    $$\n    \\mu \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i+1/2,j}^n}{\\Delta t/2} = \\frac{E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}}{\\Delta x}\n    $$\n    作用于 $E_z$ 的 $\\delta_x$ 算子是隐式的。\n\n3.  以 $(i,j+1/2)$ 为中心的 $H_x$ 更新方程：\n    $$\n    \\mu \\frac{H_x|_{i,j+1/2}^{n+1/2} - H_x|_{i,j+1/2}^n}{\\Delta t/2} = -\\frac{E_z|_{i,j+1}^n - E_z|_{i,j}^n}{\\Delta y}\n    $$\n    作用于 $E_z$ 的 $\\delta_y$ 算子是显式的。该方程可以直接求解 $H_x|_{i,j+1/2}^{n+1/2}$：\n    $$\n    H_x|_{i,j+1/2}^{n+1/2} = H_x|_{i,j+1/2}^n - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^n - E_z|_{i,j}^n \\right)\n    $$\n    这个显式 $H_x$ 更新的有限差分模板系数，对于 $E_z|_{i,j}^n$ 是 $\\frac{\\Delta t}{2\\mu\\Delta y}$，对于 $E_z|_{i,j+1}^n$ 是 $-\\frac{\\Delta t}{2\\mu\\Delta y}$。\n\n为了获得 $E_z$ 的三对角系统，我们首先重排隐式 $H_y$ 更新方程，以 $E_z^{n+1/2}$ 和已知值来表示 $H_y^{n+1/2}$：\n$$\nH_y|_{i+1/2,j}^{n+1/2} = H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n$$\n将这个 $H_y|_{i+1/2,j}^{n+1/2}$ 的表达式以及一个类似的 $H_y|_{i-1/2,j}^{n+1/2}$ 表达式代入 $E_z$ 方程：\n$$\n\\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{1}{\\Delta x} \\left[ \\left( H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}) \\right) - \\left( H_y|_{i-1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i,j}^{n+1/2} - E_z|_{i-1,j}^{n+1/2}) \\right) \\right] - \\delta_y H_x|_{i,j}^n\n$$\n重新整理各项，将未知数 ($E_z^{n+1/2}$) 归到左侧（LHS），已知数归到右侧（RHS）：\n$$\nE_z|_{i,j}^{n+1/2} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2} \\left[ E_z|_{i+1,j}^{n+1/2} - 2E_z|_{i,j}^{n+1/2} + E_z|_{i-1,j}^{n+1/2} \\right] = E_z|_{i,j}^n + \\frac{\\Delta t}{2\\varepsilon} \\left( \\delta_x H_y|_{i,j}^n - \\delta_y H_x|_{i,j}^n \\right)\n$$\n对于每个水平线（$j$ 为常数），这是一个一维三对角系统。方程的形式为 $a_i E_z|_{i-1,j}^{n+1/2} + b_i E_z|_{i,j}^{n+1/2} + c_i E_z|_{i+1,j}^{n+1/2} = d_i$。作用于 $E_z$ 的三对角算子的模板系数为：\n- 左系数 ($a_i$): $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n- 中心系数 ($b_i$): $1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}$\n- 右系数 ($c_i$): $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n\n一旦对所有 $E_z|_{i,j}^{n+1/2}$ 求解了三对角系统，就可以使用已知的 $E_z$ 值显式地完成 $H_y|_{i+1/2,j}^{n+1/2}$ 的更新。这个 $H_y$ 更新的模板系数，对于 $E_z|_{i+1,j}^{n+1/2}$ 是 $\\frac{\\Delta t}{2\\mu\\Delta x}$，对于 $E_z|_{i,j}^{n+1/2}$ 是 $-\\frac{\\Delta t}{2\\mu\\Delta x}$。\n\n**子步 2：从 $t^{n+1/2}$ 更新到 $t^{n+1}$（在 $y$ 方向隐式）**\n\n这个子步与第一个子步是对称的。现在 $y$ 导数是隐式的（在 $t^{n+1}$ 处取值），而 $x$ 导数是显式的（在 $t^{n+1/2}$ 处取值）。\n$$\n\\varepsilon \\frac{E_z^{n+1} - E_z^{n+1/2}}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1} - H_x^{n+1/2}}{\\Delta t/2} = -\\frac{\\partial E_z^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1} - H_y^{n+1/2}}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\n遵循与子步1类似的程序：\n\n1.  $H_y$ 的更新现在是显式的：\n    $$\n    H_y|_{i+1/2,j}^{n+1} = H_y|_{i+1/2,j}^{n+1/2} + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n    $$\n    模板系数是作用于 $E_z^{n+1/2}$ 值的 $\\frac{\\Delta t}{2\\mu\\Delta x}$ 和 $-\\frac{\\Delta t}{2\\mu\\Delta x}$。\n\n2.  $E_z$ 和 $H_x$ 的更新是隐式耦合的。我们将 $H_x^{n+1}$ 的表达式代入 $E_z$ 更新方程。这会为每个垂直线（$i$ 为常数）产生一个三对角系统：\n    $$\n    - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j-1}^{n+1} + \\left(1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}\\right) E_z|_{i,j}^{n+1} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j+1}^{n+1} = \\text{RHS}\n    $$\n    其中 RHS（右侧）仅包含来自时间 $n+1/2$ 的已知值。\n    作用于 $E_z$ 的三对角算子的模板系数为：\n    - 下系数: $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n    - 中心系数: $1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}$\n    - 上系数: $- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n\n3.  在求解出 $E_z^{n+1}$ 后，$H_x$ 的更新可以显式完成：\n    $$\n    H_x|_{i,j+1/2}^{n+1} = H_x|_{i,j+1/2}^{n+1/2} - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^{n+1} - E_z|_{i,j}^{n+1} \\right)\n    $$\n    模板系数是作用于 $E_z^{n+1}$ 值的 $\\frac{\\Delta t}{2\\mu\\Delta y}$ 和 $-\\frac{\\Delta t}{2\\mu\\Delta y}$。\n\n所要求的最终答案是第一个子步中求解 $E_z$ 的三对角算子的中心系数，该子步在 $x$ 方向是隐式的。\n该系数在子步1的方程中被确定为 $b_i$。\n$$\n\\text{中心系数} = 1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}\n$$", "answer": "$$\n\\boxed{1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}}\n$$", "id": "3289199"}, {"introduction": "在掌握了算法的推导之后，分析其数值行为至关重要。本练习 [@problem_id:3289170] 将指导你在一维情况下进行冯·诺依曼稳定性分析，以研究该方法的数值色散和稳定性。通过计算群速度 $v_g$ 和放大因子模 $|G|$，你将深入了解离散化如何引入影响波传播速度和振幅的人为效应，这是准确解读仿真结果的关键一步。", "problem": "考虑在真空中传播的一维横向电磁波，其受麦克斯韦方程组支配，在交错空间网格（Yee网格）上进行离散，并使用专用于一维空间的交替方向隐式时域有限差分（ADI-FDTD）方法在时间上进行推进。在这种情况下，一阶麦克斯韦算子的梯形（Crank–Nicolson）时间离散的交替方向隐式分裂简化为应用于一维交错麦克斯韦系统的梯形法则，该方法在空间和时间上都是无条件稳定且具有二阶精度。\n\n从真空中的无源一维麦克斯韦方程组和上述离散化假设出发，使用拟设 $E_i^n = E_0 \\exp\\!\\big(i\\,(i\\,\\kappa - n\\,\\Omega)\\big)$ 和 $H_{i+1/2}^n = H_0 \\exp\\!\\big(i\\,( (i+1/2)\\,\\kappa - n\\,\\Omega)\\big)$ 进行 von Neumann 平面波分析，其中 $\\kappa = k\\,\\Delta x$ 和 $\\Omega = \\omega\\,\\Delta t$，以推导离散色散关系和单步放大因子 $G$。然后：\n\n1) 根据离散色散关系 $\\omega = \\omega(k)$，计算群速度 $v_g = \\partial \\omega/\\partial k$。\n\n2) 计算放大因子的大小 $\\lvert G \\rvert$。\n\n对以下参数集评估这两个量：\n- 真空波速 $c = 3.00 \\times 10^{8}\\,\\mathrm{m/s}$。\n- 空间步长 $\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$。\n- 时间步长 $\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$。\n- 波数满足 $k\\,\\Delta x = \\kappa = \\pi/2$。\n\n为以给定波数为中心的窄带波包提供结果的物理解释，讨论其在多个时间步长上的传播速度和振幅演化。以 $\\mathrm{m/s}$ 为单位表示群速度的最终数值，并将放大因子的大小表示为无量纲数。将最终数值四舍五入至六位有效数字。假设所有相位和角度量均以弧度为单位。", "solution": "该问题要求推导和评估应用于麦克斯韦方程组的一维交替方向隐式时域有限差分（ADI-FDTD）方案的群速度和放大因子。如题目所述，该方法在一维情况下简化为在交错 Yee 网格上使用 Crank-Nicolson（梯形法则）进行时间积分。\n\n我们从真空中传播的横向电磁波的无源一维麦克斯韦旋度方程开始，对于沿 $x$ 方向传播的场分量 $E_y$ 和 $H_z$，可以写成：\n$$ \\frac{\\partial E_y}{\\partial t} = -\\frac{1}{\\epsilon_0} \\frac{\\partial H_z}{\\partial x} $$\n$$ \\frac{\\partial H_z}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_y}{\\partial x} $$\n此处，$\\epsilon_0$ 和 $\\mu_0$ 分别是真空的介电常数和磁导率，通过 $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$ 与光速 $c$ 相关。\n\n问题指定了一个交错空间网格（Yee网格），我们在整数网格点 $i$ 上定义 $E_y$，在半整数网格点 $i+1/2$ 上定义 $H_z$。空间导数由二阶中心差分近似：\n$$ \\frac{\\partial H_z}{\\partial x} \\bigg|_i \\approx \\frac{H_{z, i+1/2} - H_{z, i-1/2}}{\\Delta x} $$\n$$ \\frac{\\partial E_y}{\\partial x} \\bigg|_{i+1/2} \\approx \\frac{E_{y, i+1} - E_{y, i}}{\\Delta x} $$\n时间离散化使用梯形法则（Crank-Nicolson方法），这涉及到对时间步 $n$ 和 $n+1$ 上的右侧空间导数进行平均。令 $E_i^n$ 表示 $E_y(i\\Delta x, n\\Delta t)$，$H_{i+1/2}^n$ 表示 $H_z((i+1/2)\\Delta x, n\\Delta t)$。离散化后的方程为：\n$$ \\frac{E_i^{n+1} - E_i^n}{\\Delta t} = -\\frac{1}{2\\epsilon_0 \\Delta x} \\left[ (H_{i+1/2}^{n+1} - H_{i-1/2}^{n+1}) + (H_{i+1/2}^n - H_{i-1/2}^n) \\right] $$\n$$ \\frac{H_{i+1/2}^{n+1} - H_{i+1/2}^n}{\\Delta t} = -\\frac{1}{2\\mu_0 \\Delta x} \\left[ (E_{i+1}^{n+1} - E_i^{n+1}) + (E_{i+1}^n - E_i^n) \\right] $$\n\n为了进行 von Neumann 稳定性分析，我们代入给定的平面波拟设：\n$E_i^n = E_0 \\exp\\big(i(i\\kappa - n\\Omega)\\big)$\n$H_{i+1/2}^n = H_0 \\exp\\big(i((i+1/2)\\kappa - n\\Omega)\\big)$\n其中 $\\kappa = k\\Delta x$，$\\Omega = \\omega\\Delta t$，$i$ 是虚数单位。放大因子为 $G = \\exp(-i\\Omega)$，因此有 $E_i^{n+1} = G E_i^n$ 和 $H_{i+1/2}^{n+1} = G H_{i+1/2}^n$。\n\n将拟设代入离散方程，我们得到一个关于振幅 $E_0$ 和 $H_0$ 的两个线性代数方程组。\n\n对于第一个方程（$E_y$ 的更新）：\n$E_i^n(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} \\left[ (G H_{i-1/2}^n(\\exp(i\\kappa)-1)) + (H_{i-1/2}^n(\\exp(i\\kappa)-1)) \\right]$\n$E_0 \\exp(i(i\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(i((i-1/2)\\kappa-n\\Omega)) (\\exp(i\\kappa)-1)$\n消去公因子并使用 $\\exp(-i\\kappa/2)(\\exp(i\\kappa)-1) = \\exp(i\\kappa/2)-\\exp(-i\\kappa/2) = 2i\\sin(\\kappa/2)$：\n$E_0 (G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(-i\\kappa/2) (\\exp(i\\kappa)-1)$\n$E_0 (G-1) = -\\frac{\\Delta t}{\\epsilon_0 \\Delta x} (G+1) H_0 (i\\sin(\\kappa/2))$\n$$ E_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x} H_0 \\quad (1)$$\n\n对于第二个方程（$H_z$ 的更新）：\n$H_{i+1/2}^n(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} \\left[ (G E_i^n(\\exp(i\\kappa)-1)) + (E_i^n(\\exp(i\\kappa)-1)) \\right]$\n$H_0 \\exp(i((i+1/2)\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 \\exp(i(i\\kappa-n\\Omega))(\\exp(i\\kappa)-1)$\n$H_0 \\exp(i\\kappa/2)(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 (\\exp(i\\kappa)-1)$\n$H_0 (G-1) = -\\frac{\\Delta t}{\\mu_0 \\Delta x} (G+1) E_0 (i\\sin(\\kappa/2))$\n$$ H_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x} E_0 \\quad (2)$$\n\n为了得到非平凡解 $(E_0, H_0)$，由方程 (1) 和 (2) 构成的方程组的行列式必须为零：\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x}\\right) \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x}\\right) = 0 $$\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - (i^2) \\frac{(\\Delta t)^2 \\sin^2(\\kappa/2)}{\\epsilon_0 \\mu_0 (\\Delta x)^2} = 0 $$\n使用 $c=1/\\sqrt{\\epsilon_0\\mu_0}$ 和 Courant 数 $S = c\\Delta t/\\Delta x$：\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right) = 0 $$\n$$ \\frac{G-1}{G+1} = \\pm i S \\sin\\left(\\frac{\\kappa}{2}\\right) $$\n对于前向传播波，其中 $E_y = Z_0 H_z$ 且 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间阻抗，方程 (1) 意味着我们必须选择负号：\n$\\frac{G-1}{G+1} = -i S \\sin(\\kappa/2)$。\n求解 $G$：\n$G-1 = -i S \\sin(\\kappa/2) (G+1) \\implies G(1 + i S \\sin(\\kappa/2)) = 1 - i S \\sin(\\kappa/2)$\n$$ G = \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} $$\n\n放大因子的大小 $|G|$ 计算如下：\n$$ |G| = \\left| \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} \\right| = \\frac{|1 - i S \\sin(\\kappa/2)|}{|1 + i S \\sin(\\kappa/2)|} = \\frac{\\sqrt{1^2 + (-S \\sin(\\kappa/2))^2}}{\\sqrt{1^2 + (S \\sin(\\kappa/2))^2}} = 1 $$\n这证实了该数值方案是无条件稳定且非耗散的。对于任何有效的参数集，都有 $|G|=1$。保留六位有效数字的值为 $1.00000$。\n\n为了找到离散色散关系，我们将 $G$ 与角频率 $\\omega$ 联系起来。\n$G = \\exp(-i\\Omega) = \\exp(-i\\omega\\Delta t)$。\n复数 $1 + i S \\sin(\\kappa/2)$ 的辐角是 $\\arctan(S \\sin(\\kappa/2))$。因此，$G$ 的辐角是 $-2\\arctan(S \\sin(\\kappa/2))$。\n$\\exp(-i\\omega\\Delta t) = \\exp(-2i \\arctan(S \\sin(\\kappa/2)))$。\n这给出了色散关系：\n$$ \\omega(k) = \\frac{2}{\\Delta t} \\arctan\\left(S \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) = \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) $$\n\n群速度 $v_g$ 是 $\\omega$ 对 $k$ 的导数：\n$$ v_g = \\frac{\\partial \\omega}{\\partial k} = \\frac{2}{\\Delta t} \\frac{\\partial}{\\partial k} \\left[ \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) \\right] $$\n使用链式法则，设 $u(k) = \\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)$：\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)} \\cdot \\frac{d u}{d k} $$\n$$ \\frac{d u}{d k} = \\frac{c\\Delta t}{\\Delta x} \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\cdot \\frac{\\Delta x}{2} $$\n将此代回：\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right)} \\cdot \\frac{c\\Delta t}{2} \\cos\\left(\\frac{\\kappa}{2}\\right) $$\n$$ v_g = \\frac{c \\cos(\\kappa/2)}{1 + S^2 \\sin^2(\\kappa/2)} $$\n\n现在，我们对给定参数计算 $v_g$ 和 $|G|$：\n$c = 3.00 \\times 10^8\\,\\mathrm{m/s}$\n$\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n$\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$\n$\\kappa = k\\Delta x = \\pi/2$\n\n首先，计算 Courant 数 $S$：\n$S = \\frac{c\\Delta t}{\\Delta x} = \\frac{(3.00 \\times 10^8\\,\\mathrm{m/s})(3.00 \\times 10^{-11}\\,\\mathrm{s})}{1.00 \\times 10^{-2}\\,\\mathrm{m}} = \\frac{9.00 \\times 10^{-3}}{1.00 \\times 10^{-2}} = 0.900$\n\n对于群速度 $v_g$，我们使用 $\\kappa = \\pi/2$：\n$\\sin(\\kappa/2) = \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$\\cos(\\kappa/2) = \\cos(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$$ v_g = \\frac{(3.00 \\times 10^8) \\cos(\\pi/4)}{1 + (0.900)^2 \\sin^2(\\pi/4)} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{\\sqrt{2}}{2})^2} $$\n$$ v_g = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{1}{2})} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + 0.405} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1.405} $$\n$$ v_g = \\frac{3.00 \\times \\sqrt{2}}{2 \\times 1.405} \\times 10^8 \\approx \\frac{3.00 \\times 1.41421356}{2.810} \\times 10^8 \\approx 1.50983654 \\times 10^8\\,\\mathrm{m/s} $$\n四舍五入到六位有效数字，$v_g = 1.50984 \\times 10^8\\,\\mathrm{m/s}$。\n\n放大因子的大小 $|G|$ 精确为 $1$。保留六位有效数字，即为 $1.00000$。\n\n物理解释：\n群速度 $v_g \\approx 1.51 \\times 10^8\\,\\mathrm{m/s}$ 是以给定波数（$k\\Delta x = \\pi/2$）为中心的窄带波包的包络传播速度。这个速度大约只有真空中光速 $c$ 的一半。这种显著的偏差是数值色散的结果，这是空间和时间离散化带来的效应。对于给定的参数，网格分辨率为每个波长4个单元（$\\lambda = 2\\pi/k = 2\\pi/(\\pi/(2\\Delta x)) = 4\\Delta x$），这是相当粗糙的，会导致显著的数值色散误差，从而减慢波包的速度。\n\n放大因子的大小 $|G|=1$ 表明该数值方案是非耗散的（幺正的）。单个平面波模式的振幅随时间完美保持。对于一个波包来说，这意味着尽管其形状会因为其组成频率分量的速度不同（数值色散）而发生畸变和展宽，但其总能量在多个时间步长上是守恒的。\n\n最终答案是群速度的数值和放大因子的大小。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.50984 \\times 10^8  & 1.00000 \\end{pmatrix} } $$", "id": "3289170"}, {"introduction": "真实世界的应用常常涉及复杂材料。本练习 [@problem_id:3289210] 将你的技能扩展到非均匀介质的仿真中，通过解决介电常数 $\\epsilon(x)$ 发生突变的材料界面挑战。你将使用一种物理上一致的面通量公式来推导修正后的三对角线系数，从而学习在模拟现实电磁环境时如何确保准确性和稳定性。", "problem": "考虑在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀线上，无源一维麦克斯韦方程组：\n$$\n\\epsilon(x)\\,\\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x},\\qquad\n\\mu\\,\\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x},\n$$\n其中 $\\mu$ 是一个正常数，$\\epsilon(x)$ 是分段常数，在两个相邻网格节点 $x_{j_0}$ 和 $x_{j_0+1}$ 之间有一个跳跃间断点。令 $E_j^n$ 表示在节点 $x_j$ 和时间 $t^n$ 处的电场 $E$，令 $H_{j+1/2}^n$ 表示在交错半节点 $x_{j+1/2}$ 和时间 $t^n$ 处的磁场 $H$。一维交替方向隐式时域有限差分 (ADI-FDTD) 更新在消去 $H$ 后，可简化为对电场的梯形 (Crank–Nicolson) 隐式步。\n问题陈述，从麦克斯韦方程组可推导出如下波动方程：\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = \\frac{1}{\\mu\\,\\epsilon(x)}\\,\\frac{\\partial^2 E}{\\partial x^2},\n$$\n一种在材料界面处保持弱意义下相容的二阶精度空间离散化方法，使用面加权通量公式，其中界面波速的平方 $c^2(x) = 1/(\\mu\\,\\epsilon(x))$ 在单元面上求值。定义面心值\n$$\nc_{j+1/2}^2 := \\left(\\frac{1}{2}\\left(\\frac{1}{c_j^2}+\\frac{1}{c_{j+1}^2}\\right)\\right)^{-1} = \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j+1}\\right)},\n$$\n其中 $c_j^2 = 1/(\\mu\\,\\epsilon_j)$ 且 $\\epsilon_j := \\epsilon(x_j)$。由此得到的 $E^{n+1}$ 的隐式更新可以写成一个三对角线性系统\n$$\na_j\\,E_{j-1}^{n+1} + b_j\\,E_j^{n+1} + c_j\\,E_{j+1}^{n+1} = r_j,\n$$\n其右端项 $r_j$ 由上一步的量构成。\n\n从麦克斯韦方程出发，对空间算子使用上述面通量公式，并结合时间上的梯形法则，推导三对角系数 $a_j$、$b_j$ 和 $c_j$ 的表达式，这些表达式通过面心值 $c_{j\\pm 1/2}^2$ 正确处理 $\\epsilon(x)$ 的跳跃。您的推导必须从给定的物理定律开始，经过一个相容的半离散形式，最终得到全离散的隐式格式。此外，请根据您推导出的系数，解释界面附近 $\\epsilon(x)$ 的巨大差异如何影响所得三对角系统的条件数以及间断点邻域内的局部截断误差。\n\n将您的最终答案表示为系数三元组 $\\left(a_j,\\,b_j,\\,c_j\\right)$ 的单一闭式解析表达式，用 $\\Delta t$、$\\Delta x$、$\\mu$ 和节点介电常数 $\\epsilon_j$ 表示，该表达式对所有节点（包括与界面相邻的两个节点）均有效。无需进行数值计算，最终表达式中不应包含单位。", "solution": "出发点是无源一维麦克斯韦方程组，\n$$\n\\epsilon(x)\\,\\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x},\\qquad\n\\mu\\,\\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x},\n$$\n其中 $\\mu>0$ 为常数，$\\epsilon(x)>0$ 为分段常数。消去 $H$ 得到一个关于 $E$ 的二阶双曲方程。对第一个方程关于时间求导，并代入第二个方程中的 $\\partial H/\\partial t$：\n$$\n\\epsilon(x)\\,\\frac{\\partial^2 E}{\\partial t^2} = \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial H}{\\partial x}\\right)\n= \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial H}{\\partial t}\\right)\n= \\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\,\\frac{\\partial E}{\\partial x}\\right).\n$$\n因为 $\\mu$ 是常数，我们得到\n$$\n\\epsilon(x)\\,\\frac{\\partial^2 E}{\\partial t^2} = \\frac{1}{\\mu}\\,\\frac{\\partial^2 E}{\\partial x^2}.\n$$\n该方程可等价地写为 $\\frac{\\partial^2 E}{\\partial t^2} = c^2(x)\\,\\frac{\\partial^2 E}{\\partial x^2}$，其中 $c^2(x) := \\frac{1}{\\mu\\,\\epsilon(x)}$。\n为了在存在不连续系数 $\\epsilon(x)$ 的情况下获得一个稳健的数值方案，通常采用有限体积法或等效的通量守恒有限差分法。该方法直接离散化守恒形式的方程 $\\epsilon(x)\\frac{\\partial^2 E}{\\partial t^2} = \\frac{\\partial}{\\partial x}(\\frac{1}{\\mu}\\frac{\\partial E}{\\partial x})$。问题中描述的“面加权通量公式”正是为此目的。它构建了一个半离散系统：\n$$\n\\frac{d^2 E_j}{dt^2} = \\frac{1}{(\\Delta x)^2}\\left[c_{j+1/2}^2\\,(E_{j+1}-E_j) - c_{j-1/2}^2\\,(E_j-E_{j-1})\\right]\n$$\n其中，面心速度平方 $c_{j\\pm 1/2}^2$ 采用给定的调和平均值，以确保在介电常数界面上正确地保持数值通量的连续性。\n$$\nc_{j+1/2}^2 := \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j+1}\\right)}.\n$$\n这种选择保证了离散通量在弱意义下遵循位移场 $D=\\epsilon\\,E$ 的界面连续性。\n\n为了构建一个在一维情况下无条件稳定且与交替方向隐式时域有限差分 (ADI-FDTD) 分裂（在一维中简化为梯形法则）相容的二阶精度隐式时间更新，我们对上述半离散系统引入辅助速度 $V=\\partial E/\\partial t$ 以构成一个一阶系统：\n$$\n\\frac{\\partial E_j}{\\partial t} = V_j,\\qquad \\frac{\\partial V_j}{\\partial t} = \\frac{1}{(\\Delta x)^2}\\left[c_{j+1/2}^2\\,(E_{j+1}-E_j) - c_{j-1/2}^2\\,(E_j-E_{j-1})\\right].\n$$\n对时间从 $t^n$ 到 $t^{n+1}$ 应用梯形 (Crank–Nicolson) 法则：\n$$\nE_j^{n+1} = E_j^{n} + \\frac{\\Delta t}{2}\\left(V_j^{n+1}+V_j^n\\right),\n$$\n$$\nV_j^{n+1} = V_j^{n} + \\frac{\\Delta t}{2\\Delta x^2}\\left[c_{j+1/2}^2\\left(E_{j+1}^{n+1}+E_{j+1}^{n} - (E_j^{n+1}+E_j^{n})\\right) - c_{j-1/2}^2\\left(E_j^{n+1}+E_j^{n} - (E_{j-1}^{n+1}+E_{j-1}^{n})\\right)\\right].\n$$\n利用第二个方程从第一个方程中消去 $V_j^{n+1}$，得到 $E^{n+1}$ 的线性隐式更新。将其代入并整理左侧乘以 $E_{j-1}^{n+1}$、$E_j^{n+1}$ 和 $E_{j+1}^{n+1}$ 的项，可得到三对角系统：\n$$\n-\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j-1/2}^2\\,E_{j-1}^{n+1}\n+\\left(1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left[c_{j-1/2}^2+c_{j+1/2}^2\\right]\\right)E_j^{n+1}\n-\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j+1/2}^2\\,E_{j+1}^{n+1}\n= r_j,\n$$\n其中右端项 $r_j$ 汇集了来自 $E^n$、$V^n$ 及其空间邻近点的已知贡献。因此，三对角系数为：\n$$\na_j = -\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j-1/2}^2,\\qquad\nb_j = 1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{j-1/2}^2+c_{j+1/2}^2\\right),\\qquad\nc_j = -\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\,c_{j+1/2}^2,\n$$\n其中面心波速为\n$$\nc_{j\\pm 1/2}^2 = \\frac{2}{\\mu\\left(\\epsilon_j+\\epsilon_{j\\pm 1}\\right)}.\n$$\n\n这些表达式自动地处理了界面节点，因为与界面相邻的面在 $c_{j_0+1/2}^2$ 中使用了两个不同的介电常数 $\\epsilon_{j_0}$ 和 $\\epsilon_{j_0+1}$。在均匀子区域中，$\\epsilon_j=\\epsilon_{j\\pm 1}$，面速度简化为 $c_{j\\pm 1/2}^2=1/(\\mu\\,\\epsilon_j)$。\n\n关于条件数，当 $\\Delta t>0$ 和 $c_{j\\pm 1/2}^2>0$ 时，系数矩阵是对称且严格对角占优的，因此在标准边界条件下是正定的。然而，$\\epsilon(x)$ 的大对比度会在 $c_{j\\pm 1/2}^2$ 中产生大跳跃，这会局部削弱一致的对角占优性并增加特征值的分布范围。一个粗略的指标是比率\n$$\n\\kappa \\sim \\frac{1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{\\max,-1/2}^2+c_{\\max,+1/2}^2\\right)}{1+\\frac{\\Delta t^2}{4\\,\\Delta x^2}\\left(c_{\\min,-1/2}^2+c_{\\min,+1/2}^2\\right)},\n$$\n其中 $c_{\\max,\\cdot}^2$ 和 $c_{\\min,\\cdot}^2$ 表示区域内的极端面速度。由于 $c^2\\propto 1/\\epsilon$，高的 $\\epsilon$ 对比度会导致更大的条件数，这意味着 Krylov 求解器需要更多迭代，或者直接求解器的灵敏度更高。\n\n对于局部截断误差，远离界面时，面速度是光滑的（常数），中心差分产生 $\\mathcal{O}(\\Delta x^2)$ 的空间误差和 $\\mathcal{O}(\\Delta t^2)$ 的时间误差。在间断点处，连续解在 $\\partial E/\\partial x$ 中有一个由 $\\epsilon$ 的跳跃引起的扭折(kink)。采用调和平均的通量形式离散化方法能够一致地捕捉弱解，抑制伪振荡，并强制执行正确的通量跳跃条件。然而，由于集中在界面上的 $c^2(x)$ 的分布导数，界面附近的局部空间截断误差会降至 $\\mathcal{O}(\\Delta x)$。这是二阶格式在存在系数间断情况下的预期行为：在光滑区域全局保持二阶精度，而在跳跃点附近，除非采用特殊的界面重构，否则阶数会降低。\n\n总之，从麦克斯韦方程出发，采用梯形隐式时间积分器和空间上的面加权通量离散化，通过能感知界面的面速度来包含分段常数 $\\epsilon(x)$ 影响的修正三对角系数由上述表达式给出。这些保证了一个对称正定系统，在间断点处具有鲁棒的行为，尽管条件数和局部截断误差会受到介电常数跳跃幅度的影响。", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\Delta t^{2}}{2\\mu\\,\\Delta x^{2}\\left(\\epsilon_{j-1}+\\epsilon_{j}\\right)}, \n&1+\\dfrac{\\Delta t^{2}}{2\\mu\\,\\Delta x^{2}}\\!\\left(\\dfrac{1}{\\epsilon_{j-1}+\\epsilon_{j}}+\\dfrac{1}{\\epsilon_{j}+\\epsilon_{j+1}}\\right), \n&-\\dfrac{\\Delta t^{2}}{2\\mu\\,\\Delta x^{2}\\left(\\epsilon_{j}+\\epsilon_{j+1}\\right)}\n\\end{pmatrix}}$$", "id": "3289210"}]}