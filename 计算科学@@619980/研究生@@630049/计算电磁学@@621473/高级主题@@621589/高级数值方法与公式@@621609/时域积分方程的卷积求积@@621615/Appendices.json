{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。本练习将带你从最核心的定义出发，通过泰勒展开直接计算卷积求积（CQ）的权重。这个过程不仅能让你深入理解CQ权重是如何从一个给定的数值积分方法（此处为梯形法则）和系统传递函数中产生的，还能通过分析权重随时间的衰减特性，揭示该数值格式在处理长时间演化问题时保持稳定性的内在机制[@problem_id:3322767]。", "problem": "电磁散射的时域积分方程（TDIE）可以写成时间上的因果Volterra卷积，其中未知场与一个核进行卷积，该核的拉普拉斯变换是一个传递函数。一种经过充分检验的、用于此类卷积的稳定长时离散化方法是卷积求积（CQ），它由一个底层的单步法通过相应的离散符号生成。对于梯形法则（也称为隐式中点法），离散符号由有理函数 $\\delta(\\zeta)=2(1-\\zeta)/(1+\\zeta)$ 给出。考虑一个标量TDIE卷积，其传递函数为 $Z(s)=1/\\sqrt{s}$。使用时间步长 $\\Delta t=1$ 的CQ方法，CQ权重 $\\{\\omega_{n}\\}_{n\\geq 0}$ 由生成函数 $\\sum_{n=0}^{\\infty}\\omega_{n}\\zeta^{n}=Z\\!\\left(\\delta(\\zeta)/\\Delta t\\right)$ 隐式定义，该函数编码了对于因果输入的采样时间点 $\\{f_{n}\\}$ 的因果离散卷积 $u_{n}=\\sum_{j=0}^{n}\\omega_{j} f_{n-j}$。\n\n从卷积及其拉普拉斯变换的基本定义出发，并使用CQ的生成函数表征，推导出在上述 $\\delta(\\zeta)$、$Z(s)$ 和 $\\Delta t$ 选择下，前三个CQ权重 $\\omega_{0}$、$\\omega_{1}$ 和 $\\omega_{2}$ 的精确闭式表达式。然后，通过识别生成函数的主导奇点并应用解析组合学中的转换原理来推导 $\\omega_{n}$ 的主阶行为，从而分析当 $n\\to\\infty$ 时 $\\omega_{n}$ 的渐近衰减率。解释这些权重的符号和衰减与TDIE离散化中晚期不稳定性抑制的关系。\n\n将这三个权重表示为精确的解析表达式。最终答案必须是包含 $\\omega_{0}$、$\\omega_{1}$ 和 $\\omega_{2}$ 的单行矩阵。无需四舍五入。", "solution": "该问题具有科学依据，提法恰当且客观。所有必要信息均已提供，且没有内部矛盾。时域积分方程（TDIE）、卷积求积（CQ）、生成函数和传递函数等概念在计算电磁学和数值分析中是标准概念。因此，该问题被认为是有效的，并将提供解答。\n\n问题的核心在于分析生成函数 $G(\\zeta) = \\sum_{n=0}^{\\infty}\\omega_{n}\\zeta^{n}$ 的幂级数展开系数。该函数定义为 $G(\\zeta) = Z(\\delta(\\zeta)/\\Delta t)$。\n\n首先，我们构建该问题的具体生成函数。给定：\n- 传递函数：$Z(s) = 1/\\sqrt{s} = s^{-1/2}$。\n- 梯形法则的离散符号：$\\delta(\\zeta) = 2(1-\\zeta)/(1+\\zeta)$。\n- 时间步长：$\\Delta t = 1$。\n\n将这些代入定义中，我们得到生成函数 $G(\\zeta)$：\n$$\nG(\\zeta) = Z\\left(\\frac{\\delta(\\zeta)}{\\Delta t}\\right) = Z(\\delta(\\zeta)) = \\left( \\frac{2(1-\\zeta)}{1+\\zeta} \\right)^{-1/2} = \\sqrt{\\frac{1+\\zeta}{2(1-\\zeta)}}\n$$\n这可以重写为：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} (1+\\zeta)^{1/2} (1-\\zeta)^{-1/2}\n$$\nCQ权重 $\\{\\omega_n\\}_{n \\ge 0}$ 是 $G(\\zeta)$ 的麦克劳林级数的系数：\n$$\nG(\\zeta) = \\omega_0 + \\omega_1 \\zeta + \\omega_2 \\zeta^2 + \\dots\n$$\n\n为了求出前三个权重 $\\omega_0$、$\\omega_1$ 和 $\\omega_2$，我们将 $G(\\zeta)$ 在 $\\zeta=0$ 附近展开为幂级数。我们使用广义二项式定理，$(1+x)^{\\alpha} = \\sum_{k=0}^{\\infty} \\binom{\\alpha}{k} x^k$。\n\n$(1+\\zeta)^{1/2}$ 的展开式为：\n$$\n(1+\\zeta)^{1/2} = \\binom{1/2}{0} + \\binom{1/2}{1}\\zeta + \\binom{1/2}{2}\\zeta^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta + \\frac{\\frac{1}{2}(\\frac{1}{2}-1)}{2!}\\zeta^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta - \\frac{1}{8}\\zeta^2 + O(\\zeta^3)\n$$\n$(1-\\zeta)^{-1/2}$ 的展开式为：\n$$\n(1-\\zeta)^{-1/2} = \\binom{-1/2}{0} + \\binom{-1/2}{1}(-\\zeta) + \\binom{-1/2}{2}(-\\zeta)^2 + O(\\zeta^3)\n$$\n系数为：\n$\\binom{-1/2}{0} = 1$\n$\\binom{-1/2}{1} = -1/2$\n$\\binom{-1/2}{2} = \\frac{-\\frac{1}{2}(-\\frac{1}{2}-1)}{2!} = \\frac{-\\frac{1}{2}(-\\frac{3}{2})}{2} = \\frac{3}{8}$\n所以展开式为：\n$$\n(1-\\zeta)^{-1/2} = 1 + (-\\frac{1}{2})(-\\zeta) + (\\frac{3}{8})(-\\zeta)^2 + O(\\zeta^3) = 1 + \\frac{1}{2}\\zeta + \\frac{3}{8}\\zeta^2 + O(\\zeta^3)\n$$\n现在我们将这两个级数与前置因子 $1/\\sqrt{2}$ 相乘：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} \\left( 1 + \\frac{1}{2}\\zeta - \\frac{1}{8}\\zeta^2 + \\dots \\right) \\left( 1 + \\frac{1}{2}\\zeta + \\frac{3}{8}\\zeta^2 + \\dots \\right)\n$$\n我们按 $\\zeta$ 的幂次合并项：\n- 常数项 ($\\zeta^0$)：$\\frac{1}{\\sqrt{2}} (1 \\cdot 1) = \\frac{1}{\\sqrt{2}}$\n- $\\zeta^1$ 项：$\\frac{1}{\\sqrt{2}} \\left( 1 \\cdot \\frac{1}{2}\\zeta + \\frac{1}{2}\\zeta \\cdot 1 \\right) = \\frac{1}{\\sqrt{2}} (1 \\zeta) = \\frac{1}{\\sqrt{2}}\\zeta$\n- $\\zeta^2$ 项：$\\frac{1}{\\sqrt{2}} \\left( 1 \\cdot \\frac{3}{8}\\zeta^2 + (\\frac{1}{2}\\zeta) (\\frac{1}{2}\\zeta) + (-\\frac{1}{8}\\zeta^2) \\cdot 1 \\right) = \\frac{1}{\\sqrt{2}} \\left( \\frac{3}{8} + \\frac{1}{4} - \\frac{1}{8} \\right)\\zeta^2 = \\frac{1}{\\sqrt{2}} \\left( \\frac{3+2-1}{8} \\right)\\zeta^2 = \\frac{1}{\\sqrt{2}}\\frac{4}{8}\\zeta^2 = \\frac{1}{\\sqrt{2}}\\frac{1}{2}\\zeta^2$\n\n因此，$G(\\zeta)$ 的展开式为：\n$$\nG(\\zeta) = \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}}\\zeta + \\frac{1}{2\\sqrt{2}}\\zeta^2 + O(\\zeta^3)\n$$\n通过与 $G(\\zeta) = \\omega_0 + \\omega_1\\zeta + \\omega_2\\zeta^2 + \\dots$ 比较，我们确定前三个权重：\n$$\n\\omega_0 = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\n$$\n\\omega_1 = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\n$$\n\\omega_2 = \\frac{1}{2\\sqrt{2}} = \\frac{\\sqrt{2}}{4}\n$$\n\n接下来，我们分析当 $n$ 很大时 $\\omega_n$ 的渐近衰减率。根据解析组合学的原理，系数 $[\\zeta^n]G(\\zeta)$ 的渐近行为由函数 $G(\\zeta)$ 的主导奇点（即模最小的奇点）决定。函数 $G(\\zeta) = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(1-\\zeta)^{-1/2}$ 在 $\\zeta=1$ 和 $\\zeta=-1$ 处有支点奇点。两者的模都为 $1$，因此它们都是主导奇点。\n\n在 $\\zeta=1$ 附近，我们可以写出 $G(\\zeta) = f(\\zeta)(1-\\zeta)^{-1/2}$，其中 $f(\\zeta) = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}$。当 $\\zeta \\to 1$ 时，行为主要由奇点决定：\n$$\nG(\\zeta) \\sim f(1) (1-\\zeta)^{-1/2} = \\frac{1}{\\sqrt{2}}(1+1)^{1/2} (1-\\zeta)^{-1/2} = \\frac{\\sqrt{2}}{\\sqrt{2}}(1-\\zeta)^{-1/2} = (1-\\zeta)^{-1/2}\n$$\n奇点分析的转换定理指出，如果一个函数在 $\\zeta=\\rho$ 处有一个形如 $C(1-\\zeta/\\rho)^{-\\alpha}$ 的孤立奇点，那么它的第 $n$ 个系数渐近于 $C \\frac{n^{\\alpha-1}}{\\Gamma(\\alpha)}\\rho^{-n}$。这里，$C=1$，$\\rho=1$，$\\alpha=1/2$。奇点在 $\\zeta=1$ 处对 $\\omega_n$ 的贡献为：\n$$\n\\omega_n^{(+1)} \\sim \\frac{n^{1/2-1}}{\\Gamma(1/2)} (1)^{-n} = \\frac{n^{-1/2}}{\\sqrt{\\pi}}\n$$\n\n在 $\\zeta=-1$ 附近，$(1+\\zeta)^{1/2}$ 项变得奇异。我们分析当 $\\zeta \\to -1$ 时 $G(\\zeta)$ 的行为：\n$$\nG(\\zeta) \\sim \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(1-(-1))^{-1/2} = \\frac{1}{\\sqrt{2}}(1+\\zeta)^{1/2}(2)^{-1/2} = \\frac{1}{2}(1+\\zeta)^{1/2}\n$$\n这个奇点形如 $K(1-\\zeta/\\rho)^{\\beta}$，其中 $K=1/2$，$\\rho=-1$，$\\beta=1/2$。来自这样一个项的系数衰减得更快。它对 $\\omega_n$ 的贡献为 $n^{-\\beta-1}=n^{-3/2}$ 阶。具体来说，这个贡献渐近于 $-(-1)^n \\frac{1}{4\\sqrt{\\pi}} n^{-3/2}$。\n\n总的渐近行为是所有主导奇点贡献的总和。由于 $n^{-1/2}$ 比 $n^{-3/2}$ 衰减得慢，主阶行为完全由 $\\zeta=1$ 处的奇点决定。因此，渐近衰减率为：\n$$\n\\omega_n \\sim \\frac{1}{\\sqrt{\\pi n}} = O(n^{-1/2})\n$$\n\n最后，我们讨论这些发现与晚期不稳定性抑制的关系。TDIE离散化中的晚期不稳定性通常表现为非物理的、指数增长的数值解，这些是数值方法的产物。一个稳定的格式必须正确捕捉连续系统的物理行为。\n\n与 $Z(s)=1/\\sqrt{s}$ 对应的连续核是拉普拉斯逆变换 $\\mathcal{L}^{-1}\\{s^{-1/2}\\}(t) = (\\pi t)^{-1/2}$ (对于 $t>0$)。这个核是正的，并表现出缓慢的代数衰减。这种缓慢衰减代表了控制方程分数阶性质所固有的“长时记忆”效应。\n\nCQ权重 $\\{\\omega_n\\}$ 充当这个核的离散版本。我们的分析揭示了两个关键性质：\n1. 权重以 $\\omega_n \\sim O(n^{-1/2})$ 的形式代数衰减。这正确地模拟了连续核的缓慢衰减。一个错误地施加更快（例如，指数级）衰减的格式将无法捕捉长时记忆物理现象，并在晚期变得不准确。\n2. 对于 $n \\ge 0$，权重 $\\omega_n$ 都是正的。这可以通过将 $G(\\zeta)$ 重写为 $\\frac{1}{\\sqrt{2}}(1+\\zeta)(1-\\zeta^2)^{-1/2}$ 来证明。$(1-\\zeta^2)^{-1/2}$ 的展开式只包含 $\\zeta^2$ 的非负次幂，且系数为正。乘以 $(1+\\zeta)$ 会得到一个所有系数都为正的级数。这种正性与连续核的正性相匹配，防止在数值解中引入虚假的、非物理的振荡。\n\n基于梯形法则的CQ方法已知能将虚轴 $\\text{Re}(s)=0$ 映射到单位圆 $|\\zeta|=1$。因此，$Z(s)$ 在 $s=0$ 处的奇点被映射到单位圆上，而不是其内部，这一点至关重要。得到的离散系统（与权重 $\\omega_n$ 的卷积）不是有界输入有界输出（BIBO）稳定的，因为 $\\sum |\\omega_n| \\sim \\sum n^{-1/2}$ 发散。然而，这是正确的行为，因为底层的连续算子（一个分数半积分）也不是BIBO稳定的；它会放大像阶跃函数这样的有界输入。CQ格式的“稳定性”在于它能够复现连续系统的正确物理行为，而不引入寄生的、指数增长的模式。正权重和正确的代数衰减率相结合，确保了数值解保持物理意义，并免受困扰其他方法的非物理晚期不稳定性。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{4} \\end{pmatrix}}\n$$", "id": "3322767"}, {"introduction": "不同的线性多步法会催生出具有不同特性的卷积求积格式。本练习将探讨另一种广泛使用的格式——二阶后向差分公式（BDF2），并将其应用于电磁学中的延迟势积分算子。你需要从第一性原理出发推导BDF2的符号，并分析其稳定性，最终确定为保证数值稳定性所允许的最大时间步长。这一过程将加深你对数值方法的选择如何直接影响计算的稳定性和准确性的理解[@problem_id:3296284]。", "problem": "考虑自由空间中瞬态电磁散射的因果边界积分公式，该公式在作用于表面电流密度的推迟势算子层面上表示。记 $K(t)$ 为算子值核，它将随时间变化的表面电流映射到边界上产生的推迟势。其关于时间 $t$ 的拉普拉斯变换为 $F(s)$，由于因果性和有限传播速度，该函数在 $\\Re s > 0$ 时是解析的。对于单层推迟势的标量代理，使用标量波动方程的基本解 $G(t,r) = \\delta(t - r/c)/(4\\pi r)$，其拉普拉斯变换为 $\\widehat{G}(s,r) = \\exp(-s r/c)/(4\\pi r)$（其中 $r>0$，波速 $c>0$）。假设源-观测点分离距离固定为 $r=R>0$，则标量传递函数变为 $F(s) = \\exp(-s R/c)/(4\\pi R)$。\n\n你需要基于2阶向后差分公式（BDF2）构建一个卷积求积（CQ）方法，用于在均匀时间步长 $\\Delta t>0$ 下对因果卷积 $(K * J)(t) = \\int_{0}^{t} K(t-\\tau) J(\\tau)\\,\\mathrm{d}\\tau$ 进行时间离散化。按如下步骤进行：\n\n- 从均匀网格 $t_{n} = n \\Delta t$ 上一阶导数 $y'(t)$ 的线性多步逼近出发，通过强制其对最高2次多项式精确，从第一性原理导出BDF2符号。由此，导出从复 $z$-平面到拉普拉斯 $s$-平面的卷积求积映射，用 $z$ 和 $\\Delta t$ 表示。明确写出最终的映射关系。\n\n- 使用通过生成级数 $\\sum_{n=0}^{\\infty} w_{n} z^{n} = F(s(z))$ 定义的卷积求积权重 $\\{w_{n}\\}_{n\\ge 0}$（其中 $s(z)$ 是上面得到的映射），符号化地用 $F$ 和 $\\Delta t$ 表示 $w_{0}$。然后，利用标量代理 $F(s) = \\exp(-s R/c)/(4\\pi R)$，将 $w_{0}$ 显式地表示为关于 $R$、$c$ 和 $\\Delta t$ 的闭式函数。\n\n- 为了对应用于推迟势的CQ离散化进行稳定性分析，回想 $F(s)$ 的解析性在半平面 $\\Re s > 0$ 上成立。离散CQ的计算使用映射 $s(z)$ 在圆形围线 $|z|=\\rho$（其中 $0\\rho1$）上，通过柯西积分公式计算权重。关注该围线，分析 $|z|=\\rho$ 在映射 $s(z)$ 下的像，并计算 $\\Re s(z)$ 相对于圆上角度的最小值。然后，要求对于给定的 $\\sigma_{0}0$ 满足预解式横坐标条件 $\\min_{\\lvert z\\rvert=\\rho} \\Re s(z) \\ge \\sigma_{0}$，确定保证沿该围线 $\\Re s(z)\\ge \\sigma_{0}$ 的最大允许时间步长 $\\Delta t_{\\max}(\\rho,\\sigma_{0})$。\n\n作为你的最终答案，提供一个关于 $\\rho$ 和 $\\sigma_{0}$ 的单一闭式解析表达式 $\\Delta t_{\\max}(\\rho,\\sigma_{0})$，其中 $0\\rho1$ 且 $\\sigma_{0}>0$。不需要进行数值计算，最终方框内的答案不应包含任何单位。", "solution": "本题要求推导与BDF2卷积求积方法相关的几个量，并最终在特定条件下求出最大稳定时间步长。解答过程按照问题陈述中列出的三个部分展开。\n\n第1部分：BDF2符号和映射 $s(z)$ 的推导。\n\n2阶向后差分公式（BDF2）是一种用于逼近常微分方程解的线性多步法。其在一网格点 $t_n = n \\Delta t$ 处对一阶导数 $y'(t)$ 的计算公式为：\n$$ \\alpha_{0} y_{n} + \\alpha_{1} y_{n-1} + \\alpha_{2} y_{n-2} = \\Delta t y'_{n} $$\n系数 $\\alpha_{0}$、$\\alpha_{1}$ 和 $\\alpha_{2}$ 是通过要求该公式对最高2次的多项式精确来确定的。我们用多项式 $y(t)=1$、$y(t_n)-t$ 和 $(y(t_n)-t)^2$ 在 $t=t_n$ 处进行测试。为简化起见，设 $t_n=0$，则 $t_{n-1}=-\\Delta t$，$t_{n-2}=-2\\Delta t$。\n\n1.  对于 $y(t)=1$：$y_n=1$，$y_{n-1}=1$，$y_{n-2}=1$，$y'_n=0$。\n    $$ \\alpha_{0}(1) + \\alpha_{1}(1) + \\alpha_{2}(1) = \\Delta t (0) \\implies \\alpha_{0} + \\alpha_{1} + \\alpha_{2} = 0 $$\n\n2.  对于 $y(t)=t$：$y_n=0$，$y_{n-1}=-\\Delta t$，$y_{n-2}=-2\\Delta t$，$y'_n=1$。\n    $$ \\alpha_{0}(0) + \\alpha_{1}(-\\Delta t) + \\alpha_{2}(-2\\Delta t) = \\Delta t (1) \\implies -\\alpha_{1} - 2\\alpha_{2} = 1 $$\n\n3.  对于 $y(t)=t^2$：$y_n=0$，$y_{n-1}=(-\\Delta t)^2 = (\\Delta t)^2$，$y_{n-2}=(-2\\Delta t)^2 = 4(\\Delta t)^2$，由于 $y'(t)=2t$，$y'_n=0$。\n    $$ \\alpha_{0}(0) + \\alpha_{1}((\\Delta t)^2) + \\alpha_{2}(4(\\Delta t)^2) = \\Delta t(0) \\implies \\alpha_{1} + 4\\alpha_{2} = 0 $$\n\n我们得到一个三元线性方程组：\n(i) $\\alpha_{0} + \\alpha_{1} + \\alpha_{2} = 0$\n(ii) $-\\alpha_{1} - 2\\alpha_{2} = 1$\n(iii) $\\alpha_{1} + 4\\alpha_{2} = 0$\n\n由(iii)可得 $\\alpha_{1} = -4\\alpha_{2}$。将其代入(ii)得到 $-(-4\\alpha_{2}) - 2\\alpha_{2} = 1$，化简为 $2\\alpha_{2}=1$，所以 $\\alpha_{2}=\\frac{1}{2}$。\n然后，$\\alpha_{1} = -4(\\frac{1}{2}) = -2$。\n最后，由(i)可得 $\\alpha_{0} = -\\alpha_{1} - \\alpha_{2} = -(-2) - \\frac{1}{2} = \\frac{3}{2}$。\n\n因此，BDF2公式为：\n$$ \\frac{3}{2} y_{n} - 2 y_{n-1} + \\frac{1}{2} y_{n-2} = \\Delta t y'_{n} $$\n在卷积求积中，离散卷积权重 $\\{w_n\\}$ 由生成函数 $\\sum_{n=0}^{\\infty} w_n z^n = F(s(z))$ 确定。函数 $s(z)$ 是离散微分算子的符号。它通过考虑差分算子作用于几何序列得到，这对应于应用Z变换。微分算子为 $D \\approx \\frac{1}{\\Delta t} (\\frac{3}{2}I - 2S^{-1} + \\frac{1}{2}S^{-2})$，其中 $I$ 是单位算子，$S^{-1}$ 是后向移位算子（$S^{-1}y_n = y_{n-1}$）。其符号通过将 $S^{-1}$ 替换为复变量 $z$ 得到。\n这给出了从 $z$-平面到拉普拉斯 $s$-平面的映射：\n$$ s(z) = \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2z + \\frac{1}{2}z^2\\right) $$\n该表达式可以重写为：\n$$ s(z) = \\frac{z^2 - 4z + 3}{2\\Delta t} $$\n\n第2部分：第一个CQ权重 $w_{0}$ 的计算。\n\n卷积求积权重 $\\{w_n\\}_{n \\ge 0}$ 是 $F(s(z))$ 在 $z=0$ 附近泰勒展开的系数：\n$$ \\sum_{n=0}^{\\infty} w_{n} z^{n} = F(s(z)) $$\n为了求得第一个权重 $w_0$，我们在生成函数级数中令 $z=0$：\n$$ w_0 = F(s(0)) $$\n使用第1部分中推导出的 $s(z)$ 表达式：\n$$ s(0) = \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2(0) + \\frac{1}{2}(0)^2\\right) = \\frac{3}{2\\Delta t} $$\n符号上，第一个权重是 $w_0 = F\\left(\\frac{3}{2\\Delta t}\\right)$。\n\n现在，使用特定的标量代理传递函数 $F(s) = \\frac{\\exp(-s R/c)}{4\\pi R}$，我们可以求出 $w_0$ 的显式表达式：\n$$ w_0 = F\\left(\\frac{3}{2\\Delta t}\\right) = \\frac{\\exp\\left(-\\left(\\frac{3}{2\\Delta t}\\right) \\frac{R}{c}\\right)}{4\\pi R} $$\n$$ w_0 = \\frac{\\exp\\left(-\\frac{3R}{2c\\Delta t}\\right)}{4\\pi R} $$\n\n第3部分：稳定性分析和最大时间步长 $\\Delta t_{\\max}$。\n\n该问题要求分析圆 $|z|=\\rho$（其中 $0\\rho1$）在映射 $s(z)$ 下的像，并找到 $\\Re s(z)$ 在此围线上的最小值。设 $z = \\rho e^{i\\theta}$，其中 $\\theta \\in [0, 2\\pi)$。\n$$ s(\\rho e^{i\\theta}) = \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2\\rho e^{i\\theta} + \\frac{1}{2}\\rho^2 e^{i2\\theta}\\right) $$\n$s(z)$ 的实部为：\n$$ \\Re s(z) = \\frac{1}{\\Delta t} \\Re\\left[\\frac{3}{2} - 2\\rho(\\cos\\theta + i\\sin\\theta) + \\frac{1}{2}\\rho^2(\\cos(2\\theta) + i\\sin(2\\theta))\\right] $$\n$$ \\Re s(z) = \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2\\rho\\cos\\theta + \\frac{1}{2}\\rho^2\\cos(2\\theta)\\right) $$\n为了找到该表达式的最小值，我们分析函数 $g(\\theta) = \\frac{3}{2} - 2\\rho\\cos\\theta + \\frac{1}{2}\\rho^2\\cos(2\\theta)$。使用恒等式 $\\cos(2\\theta) = 2\\cos^2\\theta - 1$：\n$$ g(\\theta) = \\frac{3}{2} - 2\\rho\\cos\\theta + \\frac{1}{2}\\rho^2(2\\cos^2\\theta - 1) = \\rho^2\\cos^2\\theta - 2\\rho\\cos\\theta + \\left(\\frac{3}{2} - \\frac{\\rho^2}{2}\\right) $$\n设 $x = \\cos\\theta$。我们想要求二次函数 $h(x) = \\rho^2 x^2 - 2\\rho x + (\\frac{3}{2} - \\frac{\\rho^2}{2})$ 在区间 $x \\in [-1, 1]$ 上的最小值。\n这是一个开口向上的抛物线（因为 $\\rho^2>0$）。其顶点位于 $x_v = \\frac{-(-2\\rho)}{2\\rho^2} = \\frac{1}{\\rho}$。\n给定 $0  \\rho  1$，顶点位置 $x_v = 1/\\rho$ 严格大于 $1$。因此，在区间 $[-1, 1]$ 上，函数 $h(x)$ 是单调递减的，其最小值在右端点 $x=1$ 处取得。\n因此，$g(\\theta)$ 的最小值在 $\\cos\\theta=1$（即 $\\theta=0$）时取得。\n最小值为：\n$$ g_{min} = g(0) = \\frac{3}{2} - 2\\rho\\cos(0) + \\frac{1}{2}\\rho^2\\cos(0) = \\frac{3}{2} - 2\\rho + \\frac{1}{2}\\rho^2 $$\n所以，$s(z)$ 的实部在 $|z|=\\rho$ 上的最小值为：\n$$ \\min_{|z|=\\rho} \\Re s(z) = \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2\\rho + \\frac{1}{2}\\rho^2\\right) $$\n稳定性条件给定为 $\\min_{|z|=\\rho} \\Re s(z) \\ge \\sigma_0$，其中 $\\sigma_0 > 0$。\n$$ \\frac{1}{\\Delta t} \\left(\\frac{3}{2} - 2\\rho + \\frac{1}{2}\\rho^2\\right) \\ge \\sigma_0 $$\n括号中的项可以写为 $\\frac{1}{2}(\\rho^2 - 4\\rho + 3) = \\frac{1}{2}(1-\\rho)(3-\\rho)$。由于 $0  \\rho  1$，$(1-\\rho)$ 和 $(3-\\rho)$ 均为正，因此整个项是正的。我们可以重排不等式来求解 $\\Delta t$：\n$$ \\Delta t \\le \\frac{1}{\\sigma_0} \\left(\\frac{3}{2} - 2\\rho + \\frac{1}{2}\\rho^2\\right) $$\n最大允许时间步长 $\\Delta t_{\\max}$ 是此不等式的上界：\n$$ \\Delta t_{\\max}(\\rho, \\sigma_0) = \\frac{1}{\\sigma_0} \\left(\\frac{3}{2} - 2\\rho + \\frac{1}{2}\\rho^2\\right) = \\frac{3 - 4\\rho + \\rho^2}{2\\sigma_0} $$\n这也可以写成因式分解的形式：\n$$ \\Delta t_{\\max}(\\rho, \\sigma_0) = \\frac{(1-\\rho)(3-\\rho)}{2\\sigma_0} $$\n该表达式给出了所需的最大时间步长，作为 $\\rho$ 和 $\\sigma_0$ 的函数。", "answer": "$$ \\boxed{\\frac{\\rho^{2} - 4\\rho + 3}{2\\sigma_{0}}} $$", "id": "3296284"}, {"introduction": "卷积求积方法的一大优势在于其能够自然地处理频域中复杂的物理现象，例如材料色散。本计算实践旨在通过一个编程练习，展示CQ在解决色散介质问题中的威力，而这类问题对于传统的时域方法通常颇具挑战性。你将为一个经典的Debye色散介质实现卷积求积，计算其阶跃响应，并评估不同材料参数对数值稳定性的影响。这将为你展示如何将CQ理论应用于解决前沿的计算电磁学问题[@problem_id:3296281]。", "problem": "考虑一个由麦克斯韦方程组和色散本构关系所描述的均匀、各向同性、非磁性德拜介质。电场 $E(t)$ 和磁场 $H(t)$ 满足以下基本定律\n$$\\nabla\\times E(t)=-\\mu\\,\\frac{\\partial H(t)}{\\partial t},\\quad \\nabla\\times H(t)=\\frac{\\partial D(t)}{\\partial t},$$\n其中电通量密度 $D(t)$ 通过时间卷积与电场 $E(t)$ 相关。在拉普拉斯域中（拉普拉斯变量为 $s$），德拜介电常数模型为\n$$\\epsilon(s)=\\epsilon_\\infty+\\frac{\\epsilon_s-\\epsilon_\\infty}{1+s\\tau},$$\n其中 $\\epsilon_\\infty$ 是高频介电常数极限，$\\epsilon_s$ 是静态介电常数，$\\tau$ 是弛豫时间。\n\n一个用于电磁散射的标准时域边界积分方程通过一个频率相关的面积分算子引入了推迟势。对于一个在代表性分离距离上的单个配置点自由度，我们可以在拉普拉斯域中将单层势算子的标量传递函数建模为\n$$G(s)=\\frac{e^{-k(s)\\,r_0}}{4\\pi\\,r_0},\\quad k(s)=s\\,\\sqrt{\\mu\\,\\epsilon(s)},$$\n其中 $r_0$ 是一个代表有效相互作用距离的正长度尺度，$\\mu$ 是磁导率（在此问题中假设为常数，且等于真空磁导率）。这个简化的传递函数通过 $k(s)$ 捕捉了频率依赖性，同时保留了与德拜介质中波传播相关的因果衰减。\n\n卷积求积（CQ）方法可近似因果时域卷积\n$$y(t)=\\int_0^t g(t-\\xi)\\,u(\\xi)\\,\\mathrm{d}\\xi\\quad\\text{with}\\quad \\mathcal{L}\\{g\\}(s)=G(s),$$\n为离散卷积 $y_n\\approx\\sum_{j=0}^n w_j\\,u_{n-j}$，其中 $w_n$ 是从一个 A-稳定时间步进方法的生成函数中获得的 CQ 权重。对于梯形法则，其生成函数为\n$$\\delta(\\zeta)=\\frac{2(1-\\zeta)}{1+\\zeta},$$\n且 CQ 权重通过柯西积分表示定义为\n$$w_n=\\frac{1}{2\\pi i}\\oint_{|\\zeta|=\\rho}\\!G\\!\\left(\\frac{\\delta(\\zeta)}{\\Delta t}\\right)\\,\\zeta^{-n-1}\\,\\mathrm{d}\\zeta,$$\n其中 $0\\rho1$ 且 $\\Delta t0$ 是时间步长。在数值上，这个积分通过在圆 $|\\zeta|=\\rho$ 上使用梯形法则来近似，得到\n$$w_n\\approx \\frac{1}{N}\\sum_{\\ell=0}^{N-1}G\\!\\left(\\frac{\\delta(\\zeta_\\ell)}{\\Delta t}\\right)\\,\\zeta_\\ell^{-n},\\quad \\zeta_\\ell=\\rho\\,e^{2\\pi i \\ell/N}.$$\n\n您的任务是为所描述的德拜介质实现梯形法则卷积求积，以计算标量算子 $G(s)$ 的离散阶跃响应，并通过测量单位阶跃输入的输出序列的放大率来评估其作为弛豫时间 $\\tau$ 函数的稳定性。使用以下科学上一致的参数：\n- 真空磁导率 $\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$。\n- 真空介电常数 $\\epsilon_0=8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n- 高频介电常数 $\\epsilon_\\infty=2\\,\\epsilon_0$。\n- 静态介电常数 $\\epsilon_s=5\\,\\epsilon_0$。\n- 代表性距离 $r_0=0.1\\,\\mathrm{m}$。\n- 时间步长 $\\Delta t=1\\times 10^{-10}\\,\\mathrm{s}$。\n- 时间步数 $N_t=256$。\n- CQ 围线半径 $\\rho=0.95$。\n- 单位圆上的求积点数 $N=2048$。\n\n将单位阶跃输入定义为 $u_n=1$，$n=0,1,\\dots,N_t-1$。对于下面测试套件中的每个弛豫时间 $\\tau$，计算 CQ 权重 $w_n$ 和输出序列 $y_n=\\sum_{j=0}^n w_j$（离散阶跃响应）。使用随时间的最大绝对值\n$$A(\\tau)=\\max_{0\\le nN_t}\\,|y_n|,$$\n作为无量纲稳定性指标：较小的值表示离散卷积与色散算子具有更强的阻尼和更好的稳定性。\n\n测试套件：\n- 情况 1：$\\tau=0$。\n- 情况 2：$\\tau=1\\times 10^{-12}\\,\\mathrm{s}$。\n- 情况 3：$\\tau=1\\times 10^{-9}\\,\\mathrm{s}$。\n- 情况 4：$\\tau=1\\times 10^{-6}\\,\\mathrm{s}$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$\\texttt{[result1,result2,result3,result4]}$）。\n- 该列表必须包含与给定测试套件案例顺序相对应的四个无量纲放大值 $[A(\\tau_1),A(\\tau_2),A(\\tau_3),A(\\tau_4)]$。[@problem_id:458]", "solution": "该问题是适定的且科学上合理的，它基于计算电磁学的既定原理，特别是卷积求积（CQ）在色散介质中波传播的时域边界积分方程中的应用。所有必需的物理常数、材料属性和数值参数均已提供，并且其值与该领域的典型场景一致。该问题代表了一项有效且非平凡的计算任务。\n\n中心目标是计算德拜介质中标量波算子的离散阶跃响应，并针对不同的材料弛豫时间 $\\tau$，通过放大度量 $A(\\tau)$ 来评估其稳定性。解决方案涉及实现梯形法则卷积求积方法。\n\n步骤如下：\n\n1.  **定义系统传递函数**：物理系统由拉普拉斯域中的标量传递函数 $G(s)$ 建模。该函数描述了均匀、各向同性、非磁性德拜介质中的推迟势。它由下式给出\n    $$G(s)=\\frac{e^{-k(s)\\,r_0}}{4\\pi\\,r_0}$$\n    其中 $r_0$ 是一个特征距离。传播常数 $k(s)$ 捕捉了材料的色散性质，并定义为\n    $$k(s)=s\\,\\sqrt{\\mu\\,\\epsilon(s)}$$\n    此处，$\\mu$ 是磁导率，取真空值 $\\mu_0$。频率相关的介电常数 $\\epsilon(s)$ 由单极点德拜模型描述：\n    $$\\epsilon(s)=\\epsilon_\\infty+\\frac{\\epsilon_s-\\epsilon_\\infty}{1+s\\tau}$$\n    其中 $\\epsilon_\\infty$ 是高频介电常数，$\\epsilon_s$ 是静态介电常数，$\\tau$ 是弛豫时间。对于 $\\tau=0$ 的特殊情况，介电常数变为常数 $\\epsilon(s) = \\epsilon_\\infty + (\\epsilon_s - \\epsilon_\\infty) = \\epsilon_s$，代表非色散介质。为保证因果性，必须选择 $k(s)$ 的平方根分支，使得当 $\\mathrm{Re}(s) \\ge 0$ 时，$\\mathrm{Re}(k(s)) \\ge 0$。\n\n2.  **使用卷积求积（CQ）进行离散化**：连续时域卷积 $y(t) = (g*u)(t)$（其中 $\\mathcal{L}\\{g\\}(s) = G(s)$）由离散卷积 $y_n = \\sum_{j=0}^{n} w_j u_{n-j}$ 近似。CQ 权重 $w_n$ 是利用数值时间积分格式的生成函数从传递函数 $G(s)$ 导出的。对于 A-稳定梯形法则，生成函数为\n    $$\\delta(\\zeta)=\\frac{2(1-\\zeta)}{1+\\zeta}$$\n    拉普拉斯变量 $s$ 通过映射 $s = \\delta(\\zeta)/\\Delta t$ 与复平面上圆上的离散变量 $\\zeta$ 相关联，其中 $\\Delta t$ 是时间步长。\n\n3.  **通过快速傅里叶变换（FFT）计算 CQ 权重**：CQ 权重 $w_n$ 由一个柯西积分形式上给出，该积分在圆形围线 $|\\zeta|=\\rho  1$ 上使用梯形法则进行数值近似。这种近似等价于逆离散傅里叶变换（IDFT）。权重的公式为\n    $$w_n\\approx \\frac{1}{N}\\sum_{\\ell=0}^{N-1}G\\!\\left(\\frac{\\delta(\\zeta_\\ell)}{\\Delta t}\\right)\\,\\zeta_\\ell^{-n}, \\quad \\text{with} \\quad \\zeta_\\ell=\\rho\\,e^{2\\pi i \\ell/N}$$\n    其中 $N$ 是求积点数。令 $W_\\ell = G(\\delta(\\zeta_\\ell)/\\Delta t)$。该公式可以重写为：\n    $$w_n \\approx \\frac{\\rho^{-n}}{N} \\sum_{\\ell=0}^{N-1} W_\\ell e^{-2\\pi i n \\ell / N}$$\n    求和项恰好是序列 $\\{W_\\ell\\}_{\\ell=0}^{N-1}$ 的 $N$ 点离散傅里叶变换（DFT）的第 $n$ 个分量。因此，权重可以使用 FFT 算法高效计算：\n    $$w_n \\approx \\frac{\\rho^{-n}}{N} \\left(\\mathrm{FFT}\\left(\\{W_\\ell\\}\\right)\\right)_n$$\n    我们只需要计算 $n=0, 1, \\dots, N_t-1$ 时的这些权重。由于底层的时域脉冲响应 $g(t)$ 是实数，构建的序列 $W_\\ell$ 将呈现共轭对称性（$W_\\ell = W_{N-\\ell}^*$），从而确保计算出的权重 $w_n$ 是实数。\n\n4.  **计算离散阶跃响应**：问题指定了单位阶跃输入 $u_n = 1$（对于所有 $n \\ge 0$）。得到的输出序列 $y_n$ 是离散阶跃响应：\n    $$y_n = \\sum_{j=0}^{n} w_j u_{n-j} = \\sum_{j=0}^{n} w_j (1) = \\sum_{j=0}^{n} w_j$$\n    这就是 CQ 权重的累积和。\n\n5.  **确定稳定性指标**：对于测试套件中的每个 $\\tau$ 值，我们计算 $n=0, 1, \\dots, N_t-1$ 时的输出序列 $y_n$。然后，通过放大因子 $A(\\tau)$ 来量化稳定性，该因子定义为在此时间区间内输出序列的最大绝对值：\n    $$A(\\tau)=\\max_{0\\le nN_t}\\,|y_n|$$\n    对四种指定的 $\\tau$ 情况分别计算该值。\n\n整体算法如下：\n对于每个给定的 $\\tau$：\na. 定义所有物理常数（$\\mu_0, \\epsilon_0, \\epsilon_s, \\epsilon_\\infty, r_0$）和数值参数（$\\Delta t, N_t, \\rho, N$）。\nb. 在 CQ 围线上生成 $N$ 个求积点：$\\zeta_\\ell = \\rho \\exp(2\\pi i \\ell / N)$，其中 $\\ell = 0, \\dots, N-1$。\nc. 将这些点映射到拉普拉斯域：$s_\\ell = (2/\\Delta t)(1-\\zeta_\\ell)/(1+\\zeta_\\ell)$。\nd. 对于每个 $s_\\ell$，通过先计算 $\\epsilon(s_\\ell)$，然后计算 $k(s_\\ell)$，最后计算 $G(s_\\ell)$ 来求得传递函数 $W_\\ell = G(s_\\ell)$。\ne. 计算序列 $\\{W_\\ell\\}$ 的 FFT 以获得 $\\{V_n\\} = \\mathrm{FFT}(\\{W_\\ell\\})$。\nf. 使用 $w_n = \\mathrm{Re}(V_n / (N \\rho^n))$ 计算前 $N_t$ 个 CQ 权重，其中 $n=0, \\dots, N_t-1$。\ng. 通过求 $\\{w_n\\}$ 的累积和来计算离散阶跃响应 $y_n$。\nh. 求放大率 $A(\\tau) = \\max(|y_n|)$。\n对所有四种 $\\tau$ 的情况重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability indicator for a Debye medium using Convolution Quadrature.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    mu_0 = 4.0 * np.pi * 1e-7  # Free-space permeability (H/m)\n    eps_0 = 8.854187817e-12    # Vacuum permittivity (F/m)\n    eps_inf = 2.0 * eps_0         # High-frequency permittivity\n    eps_s = 5.0 * eps_0           # Static permittivity\n    r0 = 0.1                      # Representative distance (m)\n    dt = 1.0e-10                  # Time step (s)\n    Nt = 256                      # Number of time steps\n    rho = 0.95                    # CQ contour radius\n    N = 2048                      # Number of quadrature points\n\n    # Test suite for relaxation time tau (s)\n    test_cases = [\n        0.0,\n        1.0e-12,\n        1.0e-9,\n        1.0e-6,\n    ]\n\n    results = []\n    \n    # Pre-calculate common numerical arrays\n    ell = np.arange(N)\n    zeta = rho * np.exp(2j * np.pi * ell / N)\n    s_laplace = (2.0 / dt) * (1.0 - zeta) / (1.0 + zeta)\n\n    n_indices = np.arange(Nt)\n    rho_powers = rho ** n_indices\n\n    for tau in test_cases:\n        # Step 1: Evaluate the Debye permittivity epsilon(s)\n        # Handle tau=0 case to avoid division by zero if s is such that 1+s*tau is zero, though unlikely.\n        if tau == 0.0:\n            eps = np.full(N, eps_s, dtype=complex)\n        else:\n            eps = eps_inf + (eps_s - eps_inf) / (1.0 + s_laplace * tau)\n\n        # Step 2: Evaluate the wave number k(s)\n        # The principal branch of np.sqrt ensures Re(k(s))>0 for Re(s)>0, which is physically correct.\n        k_s = s_laplace * np.sqrt(mu_0 * eps)\n\n        # Step 3: Evaluate the transfer function G(s)\n        G_s = np.exp(-k_s * r0) / (4.0 * np.pi * r0)\n\n        # Step 4: Compute CQ weights via FFT\n        # The formula is w_n = (rho^-n / N) * FFT(G_s)_n\n        w_fft = np.fft.fft(G_s)\n        \n        # We only need the first Nt weights\n        weights_fft_subset = w_fft[:Nt]\n        \n        # Calculate the final weights. The result should be real since the impulse response is real.\n        weights = np.real(weights_fft_subset / (N * rho_powers))\n\n        # Step 5: Compute the discrete step response (cumulative sum of weights)\n        # y_n = sum_{j=0 to n} w_j\n        step_response = np.cumsum(weights)\n\n        # Step 6: Calculate the stability indicator A(tau)\n        A_tau = np.max(np.abs(step_response))\n        results.append(A_tau)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3296281"}]}