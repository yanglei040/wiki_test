{"hands_on_practices": [{"introduction": "在将任何数值方法付诸实践之前，理解其固有的准确性是至关重要的一步。本练习通过分析一个经典的谐振腔问题，探讨了对称凝聚节点（SCN）方法的核心精度特性。通过从第一性原理推导数值色散关系，您可以亲手揭示网格分辨率如何影响仿真结果的准确性，并预测其收敛阶数 ([@problem_id:3353237])。", "problem": "一个边长为 $L_{x}=L_{y}=L_{z}=L$ 的理想电导体矩形腔，其内部填充有均匀、无损耗的介质，介质的介电常数为 $\\varepsilon$，磁导率为 $\\mu$，波速为 $c = 1/\\sqrt{\\varepsilon \\mu}$。考虑在均匀立方网格上使用 Symmetrical Condensed Node (SCN) 格式（在 Transmission-Line Matrix (TLM) 方法中）来模拟此谐振腔，空间步长为 $\\Delta$，时间步长为 $\\Delta t = s\\,\\Delta/c$，其中 $s$ 是一个为保证稳定性而满足 $0 < s < s_{\\max}$ 的固定类 Courant 数。您将使用此模拟来估计横磁模式 $\\mathrm{TM}_{111}$ 的谐振角频率 $\\omega_{111}$，并进行网格收敛性研究。\n\n1. 提出一个网格加密研究方案，用于估计 $\\mathrm{TM}_{111}$ 模式的数值谐振角频率的收敛速率。请具体说明如何测量相对于解析值的误差，以及如何从一系列步长为 $\\Delta$, $\\Delta/2$, $\\Delta/4$, $\\ldots$ 的模拟中提取观测到的收敛阶 $p$。\n\n2. 仅从腔内的无源麦克斯韦方程组出发，并基于 SCN-TLM 格式是一种在均匀网格上的无损耗、时间中心、空间中心的显式更新格式这一事实，在均匀无界介质中进行平面波色散分析，通过对小 $\\Delta$ 进行泰勒展开，得到数值角频率 $\\omega_{\\mathrm{num}}$ 与波矢分量 $k_{x}$、$k_{y}$、$k_{z}$ 之间的主阶关系。然后，对谐振腔本征问题使用分离变量法，将此小 $\\Delta$ 色散展开式与立方腔计算出的谐振角频率 $\\omega_{111}(\\Delta)$ 中的误差联系起来。您的推导必须从麦克斯韦方程组所蕴含的连续矢量亥姆霍兹本征问题出发，对均匀介质中的 SCN-TLM 色散使用平面波拟设，并采用与中心二阶格式一致的泰勒展开。\n\n3. 设立方腔 $\\mathrm{TM}_{111}$ 模式的解析谐振角频率表示为 $\\omega_{111}^{\\mathrm{exact}} = \\pi c \\sqrt{3}/L$。将相对误差定义为 $\\varepsilon(\\Delta) = \\big|\\omega_{111}(\\Delta)-\\omega_{111}^{\\mathrm{exact}}\\big|/\\omega_{111}^{\\mathrm{exact}}$ (以小数形式表示)。假设当 $\\Delta \\to 0$ 时，误差的渐近行为形式为 $\\varepsilon(\\Delta) \\sim C\\,\\Delta^{p}$，其中常数 $C>0$，请使用您基于色散的推导来确定阶数 $p$ 的期望值。\n\n最终答案请给出 $p$ 的值，该值应为一个无单位的纯数。", "solution": "问题陈述具有科学依据、提法恰当且自成体系。它描述了计算电磁学中的一个标准问题：谐振腔模拟的数值色散误差分析。所有给定的数据、定义和物理原理都是正确且一致的。立方腔 $\\mathrm{TM}_{111}$ 模式的解析谐振频率被正确地表述为 $\\omega_{111}^{\\mathrm{exact}} = \\pi c \\sqrt{3}/L$。问题要求推导收敛阶，这是数值方法的一种标准分析。因此，该问题被认为是有效的，可以构建一个解。\n\n该问题分为三个部分。我将按顺序进行解答。\n\n对于第一部分，需要提出一个网格加密研究方案，以经验性地估计收敛阶 $p$。步骤如下：\n1.  建立一系列空间离散化逐渐加细的模拟。设初始空间步长为 $\\Delta_0$。一种常见的加密策略是二分法，创建一系列步长 $\\Delta_i = \\Delta_0 / 2^i$，$i=0, 1, 2, \\ldots$。长度为 $L$ 的谐振腔沿一边对应的网格单元数为 $N_i = L/\\Delta_i$。时间步长必须相应地缩放以保持一个恒定的类 Courant 数 $s$，使得 $\\Delta t_i = s\\Delta_i/c$。\n2.  对于序列中的每个空间步长 $\\Delta_i$，使用 Symmetrical Condensed Node (SCN) Transmission-Line Matrix (TLM) 格式进行谐振腔的完整时域模拟。谐振腔由一个宽频谱源（例如高斯脉冲）激励，以激发多个谐振模式。在腔内的一个探测点处，记录一个场分量（例如 $E_z$）随时间变化的情况。\n3.  从时域信号中提取目标模式的数值谐振频率 $\\omega_{111}(\\Delta_i)$。这通常通过对记录的信号应用傅里叶变换（例如，快速傅里叶变换）来获得其频谱。谐振频率表现为明显的峰值。通过识别与 $\\mathrm{TM}_{111}$ 模式对应的峰值来找到 $\\omega_{111}(\\Delta_i)$。\n4.  计算每次模拟相对于已知解析解 $\\omega_{111}^{\\mathrm{exact}} = \\pi c \\sqrt{3}/L$ 的相对误差。误差为 $\\varepsilon(\\Delta_i) = \\big|\\omega_{111}(\\Delta_i)-\\omega_{111}^{\\mathrm{exact}}\\big|/\\omega_{111}^{\\mathrm{exact}}$。\n5.  假设误差遵循渐近关系 $\\varepsilon(\\Delta) \\approx C\\Delta^p$（其中 $C$ 为某个常数，$p$ 为阶数），则可以估计 $p$ 的值。对于步长为 $\\Delta_{i-1}$ 和 $\\Delta_i = \\Delta_{i-1}/2$ 的两次连续加密，我们有误差比 $\\varepsilon(\\Delta_{i-1}) / \\varepsilon(\\Delta_i) \\approx (C \\Delta_{i-1}^p) / (C (\\Delta_{i-1}/2)^p) = 2^p$。因此，观测到的收敛阶可以计算为 $p \\approx \\log_2(\\varepsilon(\\Delta_{i-1}) / \\varepsilon(\\Delta_i))$。通过对几对加密计算此值，可以验证当 $\\Delta \\to 0$ 时 $p$ 是否收敛到一个稳定值。或者，可以生成 $\\varepsilon(\\Delta_i)$ 相对于 $\\Delta_i$ 的双对数图。在渐近区域中，所得直线的斜率可提供对 $p$ 的估计。\n\n对于问题的第二部分，我们必须通过色散分析推导数值频率的主阶误差。\n我们从均匀、无损耗介质中的无源麦克斯韦旋度方程开始：\n$$ \\nabla \\times \\mathbf{E} = -\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\varepsilon \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n假设形式为 $\\mathbf{E}(\\mathbf{r},t) = \\mathbf{E}_0 e^{j(\\omega t - \\mathbf{k}\\cdot\\mathbf{r})}$ 和 $\\mathbf{H}(\\mathbf{r},t) = \\mathbf{H}_0 e^{j(\\omega t - \\mathbf{k}\\cdot\\mathbf{r})}$ 的时谐平面波解，这些方程变为代数方程：$j\\mathbf{k} \\times \\mathbf{E} = j\\omega\\mu \\mathbf{H}$ 和 $j\\mathbf{k} \\times \\mathbf{H} = -j\\omega\\varepsilon \\mathbf{E}$。将它们组合起来可得到精确的连续色散关系：$\\omega^2 = c^2 k^2$，其中 $c = 1/\\sqrt{\\varepsilon\\mu}$ 且 $k^2 = |\\mathbf{k}|^2 = k_x^2+k_y^2+k_z^2$。\n\nSCN-TLM 格式被描述为在均匀网格上的无损耗、时间中心、空间中心的显式更新格式。这些是标准的二阶 Finite-Difference Time-Domain (FDTD) Yee 格式的定义性属性。一个公认的结果是，在均匀立方网格上的 SCN-TLM 格式在波传播特性方面等效于 Yee FDTD 格式。当一个离散平面波被代入麦克斯韦方程组的有限差分形式时，中心差分算子将导数转换为缩放的正弦函数。这个过程导出了在空间步长为 $\\Delta$ 的立方网格上 SCN-TLM/Yee 格式的数值色散关系：\n$$ \\frac{1}{(c \\Delta t)^2} \\sin^2\\left(\\frac{\\omega_{\\mathrm{num}} \\Delta t}{2}\\right) = \\frac{1}{\\Delta^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta}{2}\\right) \\right] $$\n为了分析小 $\\Delta$ 时的误差，我们对正弦函数进行泰勒展开，$\\sin(x) = x - x^3/6 + O(x^5)$，这给出了 $\\sin^2(x) = x^2 - x^4/3 + O(x^6)$。\n色散关系的左侧 (LHS) 变为：\n$$ \\text{LHS} = \\frac{1}{(c \\Delta t)^2} \\left[ \\left(\\frac{\\omega_{\\mathrm{num}} \\Delta t}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\omega_{\\mathrm{num}} \\Delta t}{2}\\right)^4 + \\dots \\right] = \\frac{\\omega_{\\mathrm{num}}^2}{4c^2} \\left( 1 - \\frac{(\\omega_{\\mathrm{num}} \\Delta t)^2}{12} + \\dots \\right) $$\n右侧 (RHS) 变为：\n$$ \\text{RHS} = \\frac{1}{\\Delta^2} \\sum_{i \\in \\{x,y,z\\}} \\left[ \\left(\\frac{k_i \\Delta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k_i \\Delta}{2}\\right)^4 + \\dots \\right] = \\frac{1}{4} \\sum_{i \\in \\{x,y,z\\}} \\left( k_i^2 - \\frac{k_i^4 \\Delta^2}{12} + \\dots \\right) = \\frac{k^2}{4} - \\frac{\\Delta^2}{48}\\sum_{i \\in \\{x,y,z\\}} k_i^4 + \\dots $$\n令两个展开式相等并乘以 $4$：\n$$ \\frac{\\omega_{\\mathrm{num}}^2}{c^2} \\left( 1 - \\frac{(\\omega_{\\mathrm{num}} \\Delta t)^2}{12} \\right) \\approx k^2 - \\frac{\\Delta^2}{12}\\sum_{i} k_i^4 $$\n我们求解 $\\omega_{\\mathrm{num}}^2$，并在高阶项中使用最低阶近似 $\\omega_{\\mathrm{num}} \\approx ck$。由于 $\\Delta t = s\\Delta/c$，我们有 $(\\omega_{\\mathrm{num}} \\Delta t)^2 \\approx (ck \\cdot s\\Delta/c)^2 = (sk\\Delta)^2$。\n$$ \\omega_{\\mathrm{num}}^2 \\approx c^2 \\left( k^2 - \\frac{\\Delta^2}{12}\\sum_{i} k_i^4 \\right) \\left( 1 - \\frac{(sk\\Delta)^2}{12} \\right)^{-1} \\approx c^2 \\left( k^2 - \\frac{\\Delta^2}{12}\\sum_{i} k_i^4 \\right) \\left( 1 + \\frac{s^2k^2\\Delta^2}{12} \\right) $$\n$$ \\omega_{\\mathrm{num}}^2 \\approx c^2 \\left( k^2 + \\frac{s^2k^4\\Delta^2}{12} - \\frac{\\Delta^2}{12}\\sum_{i} k_i^4 \\right) = c^2k^2 \\left[ 1 + \\frac{\\Delta^2}{12} \\left( s^2 k^2 - \\frac{\\sum_i k_i^4}{k^2} \\right) \\right] $$\n取平方根并对小的 $x$ 使用 $\\sqrt{1+x} \\approx 1+x/2$：\n$$ \\omega_{\\mathrm{num}} \\approx ck \\left[ 1 + \\frac{\\Delta^2}{24} \\left( s^2 k^2 - \\frac{\\sum_i k_i^4}{k^2} \\right) \\right] $$\n这给出了用波矢分量表示的数值频率。对于谐振腔本征问题，边界条件使波矢分量量子化。对于边长为 $L$ 的立方腔中的 $\\mathrm{TM}_{111}$ 模式，我们有 $k_x = k_y = k_z = \\pi/L$。这给出 $k^2 = 3(\\pi/L)^2$ 和 $\\sum_i k_i^4 = 3(\\pi/L)^4$。\n代入这些值：\n$$ \\omega_{111}(\\Delta) \\approx c\\sqrt{3}\\frac{\\pi}{L} \\left[ 1 + \\frac{\\Delta^2}{24} \\left( s^2 \\left(3\\frac{\\pi^2}{L^2}\\right) - \\frac{3(\\pi/L)^4}{3(\\pi/L)^2} \\right) \\right] = \\omega_{111}^{\\mathrm{exact}} \\left[ 1 + \\frac{\\Delta^2}{24} \\left( \\frac{\\pi^2}{L^2}(3s^2-1) \\right) \\right] $$\n因此，计算出的谐振角频率的误差为：\n$$ \\omega_{111}(\\Delta) - \\omega_{111}^{\\mathrm{exact}} \\approx \\omega_{111}^{\\mathrm{exact}} \\left[ \\frac{\\pi^2(3s^2-1)}{24L^2} \\right] \\Delta^2 $$\n\n对于第三部分，我们确定收敛阶 $p$ 的期望值。相对误差定义为 $\\varepsilon(\\Delta) = \\big|\\omega_{111}(\\Delta)-\\omega_{111}^{\\mathrm{exact}}\\big|/\\omega_{111}^{\\mathrm{exact}}$。根据第二部分的结果，我们有：\n$$ \\varepsilon(\\Delta) = \\frac{|\\omega_{111}(\\Delta)-\\omega_{111}^{\\mathrm{exact}}|}{\\omega_{111}^{\\mathrm{exact}}} \\approx \\left| \\frac{\\pi^2(3s^2-1)}{24L^2} \\right| \\Delta^2 $$\n该表达式具有 $\\varepsilon(\\Delta) \\approx C \\Delta^p$ 的形式，其中常数 $C$ 由 $C = |\\pi^2(3s^2-1)/(24L^2)|$ 给出，指数 $p$ 被明确地识别出来。分析表明，数值误差的主导项与 $\\Delta^2$ 成正比。\n因此，收敛阶 $p$ 的期望值为 $2$。这与 SCN-TLM 格式（等效于 Yee 格式）是一种在空间和时间上都是二阶精确的方法这一事实相符。", "answer": "$$\n\\boxed{2}\n$$", "id": "3353237"}, {"introduction": "在掌握了理想无耗环境下的 SCN 方法后，下一步是将其应用于包含真实世界材料损耗的场景。本练习将指导您如何将导电损耗整合到 SCN 模型中，并通过与解析解的直接比较来验证模型的有效性。您将从麦克斯韦方程组和离散的 SCN 节点模型分别推导衰减常数，从而深入理解宏观材料属性（如电导率 $\\sigma$）如何转化为离散网络中的集总元件 ([@problem_id:3353186])。", "problem": "一列角频率为 $\\,\\omega\\,$ 的平面波沿 $\\,\\hat{x}\\,$ 方向在一种均匀、各向同性、线性的介质中传播，该介质的电容率为 $\\,\\epsilon\\,$，磁导率为 $\\,\\mu\\,$，电导率为 $\\,\\sigma\\,$。目标是计算在传输线矩阵（Transmission Line Matrix, TLM）方法中，由对称凝聚节点（Symmetrical Condensed Node, SCN）方案预测的衰减常数 $\\,\\alpha\\,$（单位为 $\\,\\mathrm{m^{-1}}\\,$），并将其与从麦克斯韦方程组推导出的解析连续介质值进行比较。\n\n从第一性原理出发，使用宏观麦克斯韦方程组的微分形式和本构关系作为基础。在连续介质中，传播常数 $\\,\\gamma\\,$（其中 $\\,\\gamma = \\alpha + j \\beta\\,$）源于有损介质中的电磁场方程。在与 $\\,\\hat{x}\\,$ 对齐的一维空间离散SCN表示中，将SCN节点表示为一个双端口散射节点，其各端口具有相等的特征导纳，并带有一个模拟传导损耗的局部并联电导；在节点处应用基尔霍夫电流定律（Kirchhoff’s Current Law, KCL）以推导节点散射关系。由此，确定一个向右传播的平面波的单单元前向传输因子，并用它来获得单位长度的离散衰减常数。您的推导必须从麦克斯韦方程组和SCN节点方程（电流平衡和所有端口上的相等节点电压）的层面开始，然后逻辑地推演至连续介质和SCN衰减常数的最终表达式。不要引入快捷公式；每一步都必须直接遵循所述的基本定律和经过检验的事实。\n\n为进行数值评估，假设真空电容率 $\\,\\epsilon_0\\,$ 和真空磁导率 $\\,\\mu_0\\,$ 是已知常数，并为相对参数 $\\,\\epsilon_r\\,$ 和 $\\,\\mu_r\\,$ 定义 $\\,\\epsilon = \\epsilon_0 \\epsilon_r\\,$ 和 $\\,\\mu = \\mu_0 \\mu_r\\,$。在SCN模型中，使用沿 $\\,\\hat{x}\\,$ 方向空间步长为 $\\,\\Delta x\\,$ 的均匀网格，并采用一维标准SCN映射，其中局部并联导纳与电导率和单元尺寸成正比。计算出的衰减常数必须以 $\\,\\mathrm{m^{-1}}\\,$ 报告。角度不是所要求输出的一部分，因此不需要角度单位。\n\n实现一个程序，对以下每个测试用例，计算：\n- 从有损均匀介质中平面波的麦克斯韦方程组推导出的解析连续介质衰减常数 $\\,\\alpha_{\\mathrm{cont}}\\,$，以及\n- 从一维SCN节点散射分析推导出的SCN预测的衰减常数 $\\,\\alpha_{\\mathrm{scn}}\\,$。\n\n对每个测试用例，输出一个浮点数，该数等于由以下公式定义的相对误差：\n$$\n\\delta = \n\\begin{cases}\n\\left|\\alpha_{\\mathrm{scn}} - \\alpha_{\\mathrm{cont}}\\right| \\big/ \\alpha_{\\mathrm{cont}},  \\text{若 } \\alpha_{\\mathrm{cont}} > \\varepsilon_{\\mathrm{tiny}}, \\\\\n\\left|\\alpha_{\\mathrm{scn}}\\right|,  \\text{若 } \\alpha_{\\mathrm{cont}} \\le \\varepsilon_{\\mathrm{tiny}},\n\\end{cases}\n$$\n其中 $\\,\\varepsilon_{\\mathrm{tiny}}\\,$ 是一个小的正阈值，以避免除以零。程序应产生单行输出，包含用逗号分隔并用方括号括起来的结果（例如，$\\,\\left[\\delta_1,\\delta_2,\\delta_3\\right]\\,$）。\n\n使用以下测试套件，所有量均以国际单位制（SI）表示：\n- 测试用例 $\\,1\\,$（正常路径，低损耗电介质）：$\\,\\epsilon_r = 4.0\\,$, $\\,\\mu_r = 1.0\\,$, $\\,\\sigma = 1.0\\times 10^{-3}\\,$ S/m, $\\,f = 1.0\\times 10^{9}\\,$ Hz, $\\,\\Delta x = \\lambda/20\\,$，其中 $\\,\\lambda = \\left(c_0/\\sqrt{\\epsilon_r \\mu_r}\\right) \\big/ f\\,$ 且 $\\,c_0 = 299\\,792\\,458\\,$ m/s。\n- 测试用例 $\\,2\\,$（边界情况，零电导率）：$\\,\\epsilon_r = 2.25\\,$, $\\,\\mu_r = 1.0\\,$, $\\,\\sigma = 0.0\\,$ S/m, $\\,f = 3.0\\times 10^{8}\\,$ Hz, $\\,\\Delta x = \\lambda/20\\,$，$\\,\\lambda\\,$ 的定义同上。\n- 测试用例 $\\,3\\,$（重要边缘案例，中等良导体）：$\\,\\epsilon_r = 1.0\\,$, $\\,\\mu_r = 1.0\\,$, $\\,\\sigma = 1.0\\times 10^{4}\\,$ S/m, $\\,f = 1.0\\times 10^{9}\\,$ Hz, $\\,\\Delta x = \\lambda/20\\,$。\n- 测试用例 $\\,4\\,$（空间细化，收敛性检查）：与测试用例 $\\,1\\,$ 相同的介质，但 $\\,\\Delta x = \\lambda/100\\,$。\n- 测试用例 $\\,5\\,$（频率变化，相同的低损耗介质）：$\\,\\epsilon_r = 4.0\\,$, $\\,\\mu_r = 1.0\\,$, $\\,\\sigma = 1.0\\times 10^{-3}\\,$ S/m, $\\,f = 1.0\\times 10^{8}\\,$ Hz, $\\,\\Delta x = \\lambda/20\\,$。\n\n您的程序必须：\n- 从麦克斯韦方程组计算 $\\,\\alpha_{\\mathrm{cont}}\\,$，\n- 从具有双端口节点和与 $\\,\\sigma \\Delta x\\,$ 成正比的局部并联导纳的一维SCN节点散射理论计算 $\\,\\alpha_{\\mathrm{scn}}\\,$，\n- 生成最终输出行 $\\,\\left[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5\\right]\\,$。\n\n所有输出中，衰减常数的单位必须是 $\\,\\mathrm{m^{-1}}\\,$，而相对误差是无量纲的。不得使用百分比；任何比率都应表示为小数。最终程序必须是自包含的，并且不需要外部输入。", "solution": "问题陈述是计算电磁学中一个有效且适定的问题。它具有科学依据、自成体系且客观。推导和计算所需量所必需的所有参数和定义都已提供。因此，我们可以开始求解。\n\n### 第1部分：解析连续介质衰减常数 ($\\alpha_{\\mathrm{cont}}$)\n\n我们从无源（$\\rho = 0$, $\\mathbf{J}_{\\mathrm{ext}} = 0$）、线性、各向同性且均匀的介质中的麦克斯韦方程组开始，该介质的特征是电容率 $\\epsilon$、磁导率 $\\mu$ 和电导率 $\\sigma$。旋度方程的微分形式为：\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n该介质的本构关系和欧姆定律为：\n$$\n\\mathbf{D} = \\epsilon \\mathbf{E}\n$$\n$$\n\\mathbf{B} = \\mu \\mathbf{H}\n$$\n$$\n\\mathbf{J} = \\sigma \\mathbf{E}\n$$\n假设场是时谐的，角频率为 $\\omega$，我们可以使用相量表示法：$\\mathbf{E}(x,y,z,t) = \\text{Re}\\{\\mathbf{E}(x,y,z) e^{j\\omega t}\\}$。频域中的旋度方程变为：\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B} = -j\\omega\\mu \\mathbf{H}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + j\\omega \\mathbf{D} = (\\sigma + j\\omega\\epsilon) \\mathbf{E}\n$$\n为推导波动方程，我们对第一个方程取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega\\mu (\\nabla \\times \\mathbf{H})\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ 并注意到在无源区域 $\\nabla \\cdot \\mathbf{D} = 0 \\implies \\nabla \\cdot \\mathbf{E} = 0$，我们得到：\n$$\n-\\nabla^2 \\mathbf{E} = -j\\omega\\mu (\\sigma + j\\omega\\epsilon) \\mathbf{E}\n$$\n这可以简化为有损介质的亥姆霍兹方程：\n$$\n\\nabla^2 \\mathbf{E} - \\gamma^2 \\mathbf{E} = 0\n$$\n其中 $\\gamma^2$ 是复传播常数的平方：\n$$\n\\gamma^2 = j\\omega\\mu(\\sigma + j\\omega\\epsilon) = j\\omega\\sigma\\mu - \\omega^2\\mu\\epsilon\n$$\n对于沿 $+\\hat{x}$ 方向传播的均匀平面波，电场可以写成 $\\mathbf{E}(x) = \\mathbf{E}_0 e^{-\\gamma x}$。传播常数 $\\gamma$ 是一个复数，定义为 $\\gamma = \\alpha + j\\beta$，其中 $\\alpha$ 是衰减常数，$\\beta$ 是相位常数。为了求得 $\\alpha$，我们必须求 $\\gamma$ 的实部。\n$$\n\\gamma = \\sqrt{j\\omega\\sigma\\mu - \\omega^2\\mu\\epsilon}\n$$\n我们来分析复数 $Z = \\gamma^2 = -\\omega^2\\mu\\epsilon + j(\\omega\\sigma\\mu)$。我们希望求出 $\\text{Re}\\{\\sqrt{Z}\\}$。\n$Z$ 的模为：\n$$\n|Z| = \\sqrt{(-\\omega^2\\mu\\epsilon)^2 + (\\omega\\sigma\\mu)^2} = \\sqrt{\\omega^4\\mu^2\\epsilon^2 + \\omega^2\\sigma^2\\mu^2} = \\omega\\mu\\sqrt{\\omega^2\\epsilon^2 + \\sigma^2}\n$$\n$Z$ 的实部为 $\\text{Re}\\{Z\\} = -\\omega^2\\mu\\epsilon$。\n对于任意复数 $z = a+jb$，其平方根的实部由 $\\text{Re}\\{\\sqrt{z}\\} = \\sqrt{\\frac{|z|+a}{2}}$ 给出。将此应用于 $\\gamma = \\sqrt{Z}$：\n$$\n\\alpha = \\text{Re}\\{\\gamma\\} = \\sqrt{\\frac{|Z| + \\text{Re}\\{Z\\}}{2}} = \\sqrt{\\frac{\\omega\\mu\\sqrt{\\omega^2\\epsilon^2 + \\sigma^2} - \\omega^2\\mu\\epsilon}{2}}\n$$\n在主平方根内提出因子 $\\omega^2\\mu\\epsilon$ 可以得到一个数值上更稳定的形式：\n$$\n\\alpha_{\\mathrm{cont}} = \\sqrt{\\frac{\\omega^2\\mu\\epsilon}{2} \\left(\\sqrt{1 + \\left(\\frac{\\sigma}{\\omega\\epsilon}\\right)^2} - 1\\right)} = \\omega\\sqrt{\\frac{\\mu\\epsilon}{2}\\left(\\sqrt{1 + \\left(\\frac{\\sigma}{\\omega\\epsilon}\\right)^2} - 1\\right)}\n$$\n这就是解析连续介质衰减常数 $\\alpha_{\\mathrm{cont}}$ 的表达式。\n\n### 第2部分：对称凝聚节点（SCN）衰减常数 ($\\alpha_{\\mathrm{scn}}$)\n\n在一维TLM方法中，空间被离散化为长度为 $\\Delta x$ 的线段。在这些线段的连接处是SCN节点。对于一维问题，每个节点是一个双端口网络。连接节点的传输线模拟了介质的无损特性（$\\epsilon, \\mu$），其特征导纳为 $Y_0 = \\sqrt{\\epsilon/\\mu}$。传导损耗通过在每个节点处放置一个并联电导 $G$ 来建模。对于长度为 $\\Delta x$ 的单元，该电导由 $G = \\sigma \\Delta x$ 给出。\n\n考虑一个单一节点。设 $V_L^i$ 和 $V_R^i$ 分别为从左、右端口入射到节点上的电压脉冲。节点上的总电压 $V_n$ 对所有端口是公共的。根据基尔霍夫电流定律（KCL），流入节点的电流总和必须为零。\n来自左端口的电流为 $I_L = 2Y_0 V_L^i - Y_0 V_n$。\n来自右端口的电流为 $I_R = 2Y_0 V_R^i - Y_0 V_n$。\n流过并联电导的电流为 $I_G = G V_n$。\nKCL规定 $I_L + I_R - I_G = 0$，所以：\n$$\n(2Y_0 V_L^i - Y_0 V_n) + (2Y_0 V_R^i - Y_0 V_n) - G V_n = 0\n$$\n$$\n2Y_0(V_L^i + V_R^i) = (2Y_0 + G)V_n\n$$\n因此节点电压为：\n$$\nV_n = \\frac{2Y_0}{2Y_0 + G} (V_L^i + V_R^i)\n$$\n从一个端口散射（反射/透射）的电压脉冲为 $V^r = V_n - V^i$。我们关心的是向右传播的波，因此我们考虑一个从左边入射的脉冲 $V_L^i$，而右边没有入射脉冲 $V_R^i=0$。透过节点传输到右端口的脉冲是 $V_R^r$。\n$$\nV_R^r = V_n - V_R^i = V_n - 0 = \\frac{2Y_0}{2Y_0 + G} V_L^i\n$$\n节点的传输系数为 $S_{21} = V_R^r / V_L^i = \\frac{2Y_0}{2Y_0 + G}$。\n这个透射脉冲 $V_R^r$ 接着沿长度为 $\\Delta x$ 的传输线传播到下一个节点。传播过程引入了时间延迟 $\\Delta t$ 和相应的相移 $e^{-j\\omega\\Delta t}$。无损线上的相速为 $v_p = 1/\\sqrt{\\mu\\epsilon}$，所以 $\\Delta t = \\Delta x / v_p = \\Delta x\\sqrt{\\mu\\epsilon}$。\n单单元前向传输因子 $T$ 是入射到节点 $k+1$ 的脉冲与入射到节点 $k$ 的脉冲之比：\n$$\nT = S_{21} e^{-j\\omega\\Delta t} = \\left(\\frac{2Y_0}{2Y_0 + G}\\right) e^{-j\\omega\\Delta x\\sqrt{\\mu\\epsilon}}\n$$\n这个离散传输因子必须对应于连续介质中传播距离为 $\\Delta x$ 的传播因子，即 $e^{-\\gamma_{\\mathrm{scn}} \\Delta x}$。\n$$\ne^{-\\gamma_{\\mathrm{scn}} \\Delta x} = \\left(\\frac{2Y_0}{2Y_0 + G}\\right) e^{-j\\omega\\Delta x\\sqrt{\\mu\\epsilon}}\n$$\n对两边取自然对数：\n$$\n-\\gamma_{\\mathrm{scn}} \\Delta x = \\ln\\left(\\frac{2Y_0}{2Y_0 + G}\\right) - j\\omega\\Delta x\\sqrt{\\mu\\epsilon}\n$$\n$$\n\\gamma_{\\mathrm{scn}} = -\\frac{1}{\\Delta x} \\ln\\left(\\frac{2Y_0}{2Y_0 + G}\\right) + j\\omega\\sqrt{\\mu\\epsilon} = \\frac{1}{\\Delta x} \\ln\\left(\\frac{2Y_0 + G}{2Y_0}\\right) + j\\omega\\sqrt{\\mu\\epsilon}\n$$\n衰减常数 $\\alpha_{\\mathrm{scn}}$ 是 $\\gamma_{\\mathrm{scn}}$ 的实部：\n$$\n\\alpha_{\\mathrm{scn}} = \\text{Re}\\{\\gamma_{\\mathrm{scn}}\\} = \\frac{1}{\\Delta x} \\ln\\left(1 + \\frac{G}{2Y_0}\\right)\n$$\n代入 $G = \\sigma \\Delta x$ 和 $Y_0 = \\sqrt{\\epsilon/\\mu}$ 的表达式：\n$$\n\\alpha_{\\mathrm{scn}} = \\frac{1}{\\Delta x} \\ln\\left(1 + \\frac{\\sigma \\Delta x}{2\\sqrt{\\epsilon/\\mu}}\\right) = \\frac{1}{\\Delta x} \\ln\\left(1 + \\frac{\\sigma \\Delta x}{2}\\sqrt{\\frac{\\mu}{\\epsilon}}\\right)\n$$\n这就是SCN预测的衰减常数的最终表达式。\n\n### 第3部分：数值评估\n\n推导出的 $\\alpha_{\\mathrm{cont}}$ 和 $\\alpha_{\\mathrm{scn}}$ 的公式将在一个程序中实现。该程序将为每个测试用例计算这些值，然后根据问题陈述中定义的相对误差 $\\delta$ 进行计算：\n$$\n\\delta = \n\\begin{cases}\n\\left|\\alpha_{\\mathrm{scn}} - \\alpha_{\\mathrm{cont}}\\right| \\big/ \\alpha_{\\mathrm{cont}},  \\text{若 } \\alpha_{\\mathrm{cont}} > \\varepsilon_{\\mathrm{tiny}}, \\\\\n\\left|\\alpha_{\\mathrm{scn}}\\right|,  \\text{若 } \\alpha_{\\mathrm{cont}} \\le \\varepsilon_{\\mathrm{tiny}},\n\\end{cases}\n$$\n其中 $\\varepsilon_{\\mathrm{tiny}}$ 是一个小的阈值。最终输出是这些误差的列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the analytical continuum attenuation constant\n    and the SCN-TLM predicted attenuation constant for a series of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    epsilon_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    mu_0 = 4 * np.pi * 1e-7      # Vacuum permeability in H/m\n    c_0 = 299792458.0           # Speed of light in vacuum in m/s\n    epsilon_tiny = 1e-12         # Small threshold for division\n\n    # Test cases: (epsilon_r, mu_r, sigma, f, dx_rule_denominator)\n    test_cases = [\n        (4.0, 1.0, 1.0e-3, 1.0e9, 20.0),   # Test case 1\n        (2.25, 1.0, 0.0, 3.0e8, 20.0),     # Test case 2\n        (1.0, 1.0, 1.0e4, 1.0e9, 20.0),    # Test case 3\n        (4.0, 1.0, 1.0e-3, 1.0e9, 100.0),  # Test case 4\n        (4.0, 1.0, 1.0e-3, 1.0e8, 20.0),   # Test case 5\n    ]\n\n    results = []\n    for eps_r, mu_r, sigma, f, dx_denom in test_cases:\n        # --- Parameter Calculation ---\n        omega = 2.0 * np.pi * f\n        eps = epsilon_0 * eps_r\n        mu = mu_0 * mu_r\n\n        # --- Continuum Attenuation Constant (alpha_cont) ---\n        alpha_cont = 0.0\n        # The formula is only valid for non-zero omega and epsilon.\n        # If sigma is 0, alpha is 0.\n        if sigma > 0.0 and omega > 0.0 and eps > 0.0:\n            loss_tangent_sq = (sigma / (omega * eps))**2\n            sqrt_term = np.sqrt(1.0 + loss_tangent_sq)\n            alpha_cont = omega * np.sqrt((mu * eps / 2.0) * (sqrt_term - 1.0))\n        \n        # --- SCN Attenuation Constant (alpha_scn) ---\n        # Calculate spatial step delta_x\n        lambda_medium = (c_0 / np.sqrt(eps_r * mu_r)) / f\n        delta_x = lambda_medium / dx_denom\n\n        alpha_scn = 0.0\n        # If sigma is 0, the shunt conductance G is 0, and attenuation is 0.\n        if sigma > 0.0:\n            # Characteristic admittance of the lossless line Y0 = sqrt(epsilon/mu)\n            # Its inverse, intrinsic impedance Z_medium = sqrt(mu/epsilon)\n            intrinsic_impedance_medium = np.sqrt(mu / eps)\n            \n            # Argument for the natural logarithm in the alpha_scn formula\n            log_arg = 1.0 + (sigma * delta_x / 2.0) * intrinsic_impedance_medium\n            \n            alpha_scn = (1.0 / delta_x) * np.log(log_arg)\n\n        # --- Relative Error Calculation ---\n        if alpha_cont > epsilon_tiny:\n            delta = np.abs(alpha_scn - alpha_cont) / alpha_cont\n        else:\n            # Handle cases where alpha_cont is zero or near-zero\n            delta = np.abs(alpha_scn)\n        \n        results.append(delta)\n\n    # --- Final Output Formatting ---\n    # Convert results to strings for a clean comma-separated list\n    output_str = \",\".join(map(str, results))\n    print(f\"[{output_str}]\")\n\nsolve()\n\n```", "id": "3353186"}, {"introduction": "从均匀介质到实际工程组件，本练习将带您进入微波工程中的一个典型问题：波导不连续性。您将学习如何为一个波导阶跃不连续设计一个数值基准测试，并推导其在单模近似下的反射系数。更重要的是，本练习聚焦于从 SCN-TLM 仿真的原始时域数据中提取如 S 参数等有意义的工程参数所需的完整后处理流程，包括去嵌入等关键技术 ([@problem_id:3353232])。", "problem": "一个在 $z < 0$ 区域、宽度为 $a_1$、高度为 $b$ 的空气填充矩形波导，在 $z = 0$ 处突然连接到另一个在 $z > 0$ 区域、宽度为 $a_2$、高度同样为 $b$ 的空气填充矩形波导，其壁为理想电导体 (PEC)。一个频率为 $f$ 的单一前向传播主模 $\\mathrm{TE}_{10}$ 从 $z < 0$ 一侧入射，频率 $f$ 的选择满足 $f > c/(2 a_1)$ 和 $f > c/(2 a_2)$。要求您为传输线矩阵 (TLM) 方法的对称简缩节点 (SCN) 方案构建一个数值基准，用于预测该不连续处的反射系数，并概述如何对 SCN 时域数据进行后处理以提取频率相关的反射系数。\n\n从频域的麦克斯韦方程组和均匀 PEC 波导的边界条件出发，仅使用成熟的矩形波导模式理论和均匀截面中单导模的传输线类比，推导在忽略高阶倏逝模耦合的单模近似下，阶跃处主模反射系数的表达式。然后，描述一个可靠的后处理程序，该程序利用在 $a_1 \\times b$ 均匀截面中 $z = -d < 0$ 的参考平面上收集的 SCN 时域记录，得出一个作为频率 $f$ 函数的不连续处复反射系数的估计值。\n\n哪个选项最符合推导出的表达式和正确的 SCN 后处理工作流程？\n\nA. 使用主模传输线类比，其中每个均匀截面均采用 $\\mathrm{TE}$ 波阻抗，并使用基于端口的入射/反射分解和去嵌入技术：\n- 反射模型：$\\Gamma = \\dfrac{Z_{\\mathrm{TE},2} - Z_{\\mathrm{TE},1}}{Z_{\\mathrm{TE},2} + Z_{\\mathrm{TE},1}}$，其中 $Z_{\\mathrm{TE},i} = \\dfrac{\\omega \\mu_0}{\\beta_i}$，$\\beta_i = \\sqrt{k_0^2 - (\\pi/a_i)^2}$，$k_0 = \\omega \\sqrt{\\mu_0 \\epsilon_0}$，且 $\\omega = 2 \\pi f$。\n- SCN 后处理：在均匀的 $a_1 \\times b$ 截面中，于 $z = -d$ 处放置一个参考平面；用宽带脉冲激励；通过标准的 TLM 场到端口校准，从 SCN 链路电压和链路电流重建端口等效电压 $V(t)$ 和电流 $I(t)$ 的时间序列；形成前向/后向波 $V^\\pm(t) = \\big(V(t) \\pm Z_{\\mathrm{TE},1} I(t)\\big)/2$；应用时间门以隔离第一次反射；通过快速傅里叶变换 (FFT) 计算频谱 $V^\\pm(\\omega)$；计算参考平面处的 $\\Gamma_{\\mathrm{meas}}(\\omega) = V^-(\\omega)/V^+(\\omega)$；通过 $\\Gamma(\\omega) = \\Gamma_{\\mathrm{meas}}(\\omega) e^{2 j \\beta_1 d}$ 去嵌入从该平面到不连续处的传播效应。\n\nB. 使用 $\\mathrm{TM}$ 波阻抗并用反相位去嵌入：\n- 反射模型：$\\Gamma = \\dfrac{Z_{\\mathrm{TM},2} - Z_{\\mathrm{TM},1}}{Z_{\\mathrm{TM},2} + Z_{\\mathrm{TM},1}}$，其中 $Z_{\\mathrm{TM},i} = \\dfrac{\\beta_i}{\\omega \\epsilon_0}$，$\\beta_i$ 的定义同 A。\n- SCN 后处理：从 SCN 链路电压计算参考平面上的总横向电场幅值；进行 FFT 得到 $E(\\omega)$；通过将第一次反射后的 $E(\\omega)$ 除以反射前的 $E(\\omega)$ 来估计 $\\Gamma_{\\mathrm{meas}}(\\omega)$；通过 $\\Gamma(\\omega) = \\Gamma_{\\mathrm{meas}}(\\omega) e^{-2 j \\beta_1 d}$ 进行去嵌入。\n\nC. 使用正确的 $\\mathrm{TE}$ 波阻抗，但省去了电流重建和时间门控：\n- 反射模型：$\\Gamma = \\dfrac{Z_{\\mathrm{TE},2} - Z_{\\mathrm{TE},1}}{Z_{\\mathrm{TE},2} + Z_{\\mathrm{TE},1}}$，其中 $Z_{\\mathrm{TE},i}$ 和 $\\beta_i$ 同 A。\n- SCN 后处理：用宽带脉冲激励；在 $z = -d$ 处，仅记录 SCN 链路电压并将其相加形成单个电压迹线 $V(t)$；进行 FFT 得到 $V(\\omega)$；将第一次到达后的频谱与第一次到达前的频谱之比计算为 $\\Gamma(\\omega)$，不进行任何去嵌入或模式投影。\n\nD. 断言当无高阶模式传播时单模失配是精确的，并省略去嵌入：\n- 反射模型：如果频率 $f$ 低于两个波导中所有高阶模式的截止频率，那么精确的反射系数等于单模传输线失配 $\\Gamma = \\dfrac{Z_{\\mathrm{TE},2} - Z_{\\mathrm{TE},1}}{Z_{\\mathrm{TE},2} + Z_{\\mathrm{TE},1}}$。\n- SCN 后处理：直接从 $z = -d$ 处的原始 SCN 链路电压计算 $\\Gamma(\\omega)$ 为 $V_\\text{ref}(\\omega)/V_\\text{inc}(\\omega)$，不进行任何时间门控或去嵌入，因为如果倏逝模不传播，它们就不会影响测量。\n\n选择最合适的选项。", "solution": "问题陈述的验证如下。\n\n**步骤 1：提取已知条件**\n- **几何结构：** 一个在 $z < 0$ 区域、宽度为 $a_1$、高度为 $b$ 的矩形波导，在 $z = 0$ 处连接到另一个在 $z > 0$ 区域、宽度为 $a_2$、高度为 $b$ 的矩形波导。连接点在 $z = 0$。\n- **材料：** 波导是空气填充的（$\\mu_0, \\epsilon_0$）并具有理想电导体 (PEC) 壁。\n- **激励：** 一个单一前向传播的主模 $\\mathrm{TE}_{10}$ 从 $z < 0$ 处入射。\n- **频率 ($f$)：** 频率 $f$ 满足 $f > c/(2 a_1)$ 和 $f > c/(2 a_2)$，其中 $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$。这确保了 $\\mathrm{TE}_{10}$ 模的频率高于其截止频率，并在两个波导段中都能传播。\n- **任务 1 (理论)：** 使用传输线类比，在单模近似（忽略高阶倏逝模）下，推导阶跃连接点 ($z=0$) 处主模反射系数的表达式。\n- **任务 2 (数值)：** 描述一个后处理程序，用于处理在参考平面 $z = -d < 0$ 处收集的对称简缩节点 (SCN) 时域数据，以求得不连续处的频率相关反射系数。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于电磁学、微波工程（波导理论）和计算电磁学（SCN-TLM 方法）的既定原理。该设置描述了一个典型问题（波导阶跃不连续性）。它在科学上是合理的。\n- **适定性：** 该问题是适定的。在单模近似下推导反射系数是一个标准的教科书练习。描述数值后处理工作流程是从时域仿真中提取 S 参数的标准程序。\n- **客观性：** 语言技术性强、精确，且不含主观内容。\n- **完整性：** 提供了解决任务所需的所有物理参数（几何结构、材料、模式类型、频率条件）。问题是自洽的。\n- **其他缺陷：** 问题没有表现出任何其他无效标志（不切实际的条件、循环论证、模糊性等）。\n\n**步骤 3：结论和行动**\n问题陈述有效。将按要求推导解决方案。\n\n### 反射系数的推导\n\n问题要求基于单导模的传输线类比进行推导。对于均匀波导中的横电 (TE) 模，横向电场 $\\mathbf{E}_t$ 和横向磁场 $\\mathbf{H}_t$ 之间的关系可以用波阻抗来表征。\n\n对于在宽度为 $a_i$、填充介质磁导率为 $\\mu_0$、介电常数为 $\\epsilon_0$ 的矩形波导中的主模 $\\mathrm{TE}_{10}$，沿 $+z$ 方向传播的非零场分量可以写为：\n$$ E_y(x, z) = E_0 \\sin\\left(\\frac{\\pi x}{a_i}\\right) e^{-j\\beta_i z} $$\n$$ H_x(x, z) = -\\frac{\\beta_i}{\\omega \\mu_0} E_0 \\sin\\left(\\frac{\\pi x}{a_i}\\right) e^{-j\\beta_i z} $$\n其中 $\\omega = 2\\pi f$ 是角频率。传播常数 $\\beta_i$ 由色散关系给出：\n$$ \\beta_i = \\sqrt{k_0^2 - k_{c,i}^2} $$\n此处，$k_0 = \\omega\\sqrt{\\mu_0 \\epsilon_0} = \\omega/c$ 是自由空间波数，$k_{c,i} = \\pi/a_i$ 是宽度为 $a_i$ 的波导中 $\\mathrm{TE}_{10}$ 模的截止波数。条件 $f > c/(2 a_i)$ 确保了 $k_0 > k_{c,i}$，因此 $\\beta_i$ 是实数，模式得以传播。\n\nTE 波阻抗 $Z_{\\mathrm{TE},i}$ 定义为前向传播波的横向电场与横向磁场之比。注意矢量方向（$\\mathbf{E}_t = E_y \\hat{y}$，$\\mathbf{H}_t = H_x \\hat{x}$），阻抗为 $Z_{\\mathrm{TE},i} = E_y / (-H_x)$。\n$$ Z_{\\mathrm{TE},i} = \\frac{E_y}{-H_x} = \\frac{E_0 \\sin(\\pi x/a_i) e^{-j\\beta_i z}}{ \\frac{\\beta_i}{\\omega \\mu_0} E_0 \\sin(\\pi x/a_i) e^{-j\\beta_i z}} = \\frac{\\omega \\mu_0}{\\beta_i} $$\n单模近似忽略了在不连续处 ($z=0$) 为满足电磁边界条件而激发的高阶（倏逝）模式的作用。在此近似中，该连接点被建模为两个特性阻抗分别为 $Z_1 = Z_{\\mathrm{TE},1}$ 和 $Z_2 = Z_{\\mathrm{TE},2}$ 的传输线之间的简单连接。\n\n两个阻抗为 $Z_1$ 和 $Z_2$ 的传输线连接处的反射系数 $\\Gamma$ 的标准公式为：\n$$ \\Gamma = \\frac{Z_2 - Z_1}{Z_2 + Z_1} $$\n将两个波导段的 TE 波阻抗代入，我们得到在此近似下主模的反射系数：\n$$ \\Gamma = \\frac{Z_{\\mathrm{TE},2} - Z_{\\mathrm{TE},1}}{Z_{\\mathrm{TE},2} + Z_{\\mathrm{TE},1}} $$\n其中 $Z_{\\mathrm{TE},i} = \\dfrac{\\omega \\mu_0}{\\beta_i}$ 且 $\\beta_i = \\sqrt{k_0^2 - (\\pi/a_i)^2}$。理论推导到此完成。\n\n### SCN 后处理程序\n\n目标是从使用 SCN-TLM 方法计算的时域数据中，数值估算不连续处 ($z=0$) 的复数、频率相关的反射系数 $\\Gamma(\\omega)$。一个可靠的程序包括以下步骤：\n1.  **激励：** 使用宽带脉冲（例如高斯脉冲）作为源，在输入波导（宽度 $a_1$）中激励 $\\mathrm{TE}_{10}$ 模式。这允许通过单次仿真在宽频率范围内表征系统。\n2.  **数据采集：** 在均匀输入波导段的 $z = -d$ 处（其中 $d > 0$）建立一个参考平面。在此平面上记录时域场。SCN-TLM 方法计算链路电压。为了正确表征导模，必须将这些链路电压组合起来以重建物理的 E 场和 H 场。然后，使用模式投影来找到入射和反射 $\\mathrm{TE}_{10}$ 模式随时间变化的系数。这等效于计算端口等效电压 $V(t)$ 和电流 $I(t)$。对于 $\\mathrm{TE}_{10}$ 模，$V(t)$ 通常与横向 E 场 ($E_y$) 在该模式 E 场分布上的投影成正比，而 $I(t)$ 与横向 H 场 ($H_x$) 在该模式 H 场分布上的投影成正比。\n3.  **波分解：** 参考平面上的总电压 $V(t)$ 和总电流 $I(t)$ 是前向传播（入射）波和后向传播（反射）波的叠加。为了分离它们，最好在频域中进行操作。\n    - 通过快速傅里叶变换 (FFT) 计算频谱 $V(\\omega) = \\mathcal{F}\\{V(t)\\}$ 和 $I(\\omega) = \\mathcal{F}\\{I(t)\\}$。\n    - 在频域中，总电压和电流为 $V(\\omega) = V^+(\\omega) + V^-(\\omega)$ 和 $I(\\omega) = I^+(\\omega) + I^-(\\omega) = V^+(\\omega)/Z_{\\mathrm{TE},1}(\\omega) - V^-(\\omega)/Z_{\\mathrm{TE},1}(\\omega)$。\n    - 求解该系统得到前向波 $V^+(\\omega)$ 和后向波 $V^-(\\omega)$：\n      $$ V^+(\\omega) = \\frac{1}{2} \\left[ V(\\omega) + Z_{\\mathrm{TE},1}(\\omega) I(\\omega) \\right] $$\n      $$ V^-(\\omega) = \\frac{1}{2} \\left[ V(\\omega) - Z_{\\mathrm{TE},1}(\\omega) I(\\omega) \\right] $$\n    - 可以在进行 FFT 之前，对时域信号（例如 $V(t)$ 和 $I(t)$，或分离出的 $V^-(t)$）应用时间门控，以消除来自源或仿真边界的杂散反射，从而提高准确性。\n4.  **反射系数计算：** 测量平面处的反射系数 $\\Gamma_{\\mathrm{meas}}(\\omega)$ 是后向波与前向波频谱之比：\n    $$ \\Gamma_{\\mathrm{meas}}(\\omega) = \\frac{V^-(\\omega)}{V^+(\\omega)} $$\n5.  **去嵌入：** 计算出的 $\\Gamma_{\\mathrm{meas}}(\\omega)$ 是在参考平面 $z = -d$ 处的。为了得到不连续处 ($z=0$) 的反射系数 $\\Gamma(\\omega)$，我们必须考虑由于 $2d$ 的往返传播距离引起的相位延迟。前向波从 $z=-d$ 传播到 $z=0$（相位因子 $e^{-j\\beta_1 d}$），发生反射，然后后向波从 $z=0$ 传播到 $z=-d$（相位因子 $e^{-j\\beta_1 d}$）。因此，$\\Gamma_{\\mathrm{meas}}(\\omega) = \\Gamma(\\omega) e^{-j 2\\beta_1 d}$。为了去嵌入，我们求解 $\\Gamma(\\omega)$：\n    $$ \\Gamma(\\omega) = \\Gamma_{\\mathrm{meas}}(\\omega) e^{j 2\\beta_1 d} $$\n\n### 选项评估\n\n**A. 使用主模传输线类比，其中每个均匀截面均采用 $\\mathrm{TE}$ 波阻抗，并使用基于端口的入射/反射分解和去嵌入技术：**\n- **反射模型：** $\\Gamma = \\dfrac{Z_{\\mathrm{TE},2} - Z_{\\mathrm{TE},1}}{Z_{\\mathrm{TE},2} + Z_{\\mathrm{TE},1}}$，其中 $Z_{\\mathrm{TE},i} = \\dfrac{\\omega \\mu_0}{\\beta_i}$ 且 $\\beta_i = \\sqrt{k_0^2 - (\\pi/a_i)^2}$。这与我们推导的表达式完全匹配。\n- **SCN 后处理：** 所描述的工作流程是一个标准且稳健的程序。它正确地指出了需要宽带激励、重建端口等效 $V(t)$ 和 $I(t)$、波分解、使用 FFT 和去嵌入。去嵌入公式 $\\Gamma(\\omega) = \\Gamma_{\\mathrm{meas}}(\\omega) e^{2 j \\beta_1 d}$ 是正确的。在时域中形成 $V^\\pm(t)$ 的描述略有不精确（因为 $Z_{\\mathrm{TE},1}$ 是频率相关的，这应该是一个卷积），但总体工作流程，包括最终的 FFT 和去嵌入步骤，在概念上是合理的，代表了一种正确的专业方法。\n- **结论：** 正确。\n\n**B. 使用 $\\mathrm{TM}$ 波阻抗并用反相位去嵌入：**\n- **反射模型：** 它使用了 TM 波阻抗 $Z_{\\mathrm{TM},i} = \\beta_i/(\\omega \\epsilon_0)$，这对于所述的 $\\mathrm{TE}_{10}$ 模式是错误的。\n- **SCN 后处理：** 描述存在缺陷。它建议仅使用电场幅值，这会丢弃关键的相位信息。去嵌入公式 $\\Gamma(\\omega) = \\Gamma_{\\mathrm{meas}}(\\omega) e^{-2 j \\beta_1 d}$ 指数中的符号错误，这将增加相位延迟而不是消除它。\n- **结论：** 错误。\n\n**C. 使用正确的 $\\mathrm{TE}$ 波阻抗，但省去了电流重建和时间门控：**\n- **反射模型：** 模型是正确的。\n- **SCN 后处理：** 该程序存在严重缺陷。简单地对 SCN 链路电压求和不会产生有意义的模式电压。丢弃磁场信息 ($I(t)$) 妨碍了稳健的波分解。最重要的是，省略去嵌入是一个根本性错误，因为测量是在 $z = -d$ 处进行的，而不是在不连续处。\n- **结论：** 错误。\n\n**D. 断言当无高阶模式传播时单模失配是精确的，并省略去嵌入：**\n- **反射模型：** 如果高阶模式低于截止频率，单模模型就是“精确”的这一说法是错误的。在不连续处总是会产生倏逝模以满足边界条件，它们存储的无功电能会影响反射系数。单模模型是一个近似。\n- **SCN 后处理：** 使用“原始 SCN 链路电压”的建议是无效的。省略去嵌入是一个根本性错误。关于倏逝模不影响测量的理由也是不正确的。\n- **结论：** 错误。\n\n基于此分析，选项 A 是唯一一个既提供了正确的理论模型（在所述近似范围内），又提供了一个合理、专业认可的数值后处理工作流程的选项。", "answer": "$$\\boxed{A}$$", "id": "3353232"}]}