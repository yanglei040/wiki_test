{"hands_on_practices": [{"introduction": "仅仅在理论上对超奇异算子进行正则化是不够的；其离散近似也必须是稳定的，尤其是在处理臭名昭著的低频失效问题时。此练习利用一个极简的“玩具模型”，揭示了保证低频稳定性的核心代数结构，即由Rao-Wilton-Glisson (RWG) 和 Buffa-Christiansen (BC) 等兼容的试探与检验函数空间构成的离散de Rham序列 [@problem_id:3316178]。通过分析离散的inf-sup条件，您可以亲手验证为何这种特定配对对于构建稳健的边界元方法至关重要。", "problem": "考虑嵌入三维空间中的一个单连通、开放、平面上的外时谐麦克斯韦边界积分公式。在构建诺伊曼型条件时会出现超奇异边界积分算子，众所周知，该算子在朴素的伽辽金离散化中是不稳定的。一种标准的、物理上合理的正则化方法是通过在表面上进行分部积分，并使用以单层势的切向导数表示的形式，通常称为 Maue 型正则化。在离散背景下，当波数 $k \\to 0$ 时，稳定性要求试验空间和测试空间的选择是相容的。一种能保证稳定性的配对是使用 Rao–Wilton–Glisson (RWG) 试探函数和 Buffa–Christiansen (BC) 测试函数。您的任务是推导并实现一个最小、自包含、稳定的正则化超奇异算子的离散表示，在最简单的非平凡三角形网格上使用 RWG 试探和 BC 测试，然后分析当 $k \\to 0$ 时的离散 inf-sup 常数。\n\n从以下公认的基础出发：\n- 频域中的麦克斯韦方程组，其波数为 $k$，以及相关的亥姆霍兹方程的自由空间格林函数。\n- 基于表面上的单层算子及其切向微分算子的边界积分表示，该表示通过分部积分得到了超奇异算子的正则化形式。\n- 三角形网格上的离散 de Rham 序列，其中 RWG 函数位于主边上，BC 函数位于对偶边上，通过以无度量方式表示表面微分算子的关联矩阵相连接。\n\n为了使计算明确且可在单个程序中完全复现，无需外部几何文件，请使用以下用于网格和离散算子的最小模型：\n- 几何与网格：平面 $z=0$ 上的一个单位正方形被分割成 2 个共享一条内部边的直角三角形。这两个三角形是仅有的面。恰好有一条内部边，这是唯一的 RWG 自由度。这两个面通过对偶复形定义了 BC 测试空间，从而产生与该内部边配对的唯一一个 BC 自由度。\n- 离散表面旋度/关联：用 $C \\in \\mathbb{R}^{2 \\times 1}$ 表示将单个内部主边映射到两个面的定向面-边关联矩阵。为保持方向一致，取 $C = [1,-1]^{\\top}$。\n- 面上的离散单层近似：通过面图上的离散亥姆霍兹算子的逆来模拟正则化单层算子。设 $L \\in \\mathbb{R}^{2 \\times 2}$ 为两个面邻接的图拉普拉斯算子，$L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$。对于 $k>0$，定义 $V_k = (L + k^2 I)^{-1}$。对于 $k=0$，定义 $V_0$ 为 $L$ 的 Moore–Penrose 伪逆，这与静态极限一致，并正确处理开放表面上的常数零空间。此选择是单层算子基于质量集中拉普拉斯-贝尔特拉米正则化的一个一致、无度量的代理，并在 $k \\to 0$ 时保持了正确的零空间结构。\n- 混合形式的正则化超奇异算子：使用 Maue 型正则化和 RWG–BC 配对，离散双线性形式可以建模为 $1 \\times 1$ 矩阵\n$$\nB_k \\equiv C^{\\top} V_k C \\in \\mathbb{R}^{1 \\times 1}.\n$$\n这是连续正则化超奇异算子的图-亥姆霍兹代理，使用 BC 进行测试，使用 RWG 进行试探。\n- 范数和 inf-sup 常数：为了分离配对的稳定性属性，对 RWG 和 BC 空间均使用单位质量矩阵，$M_{\\mathrm{RWG}} = 1$ 和 $M_{\\mathrm{BC}} = 1$。离散 inf-sup 常数即为 $M_{\\mathrm{BC}}^{-1/2} B_k M_{\\mathrm{RWG}}^{-1/2}$ 的最小奇异值，由于该矩阵是 $1 \\times 1$ 的，因此简化为 $B_k$ 的绝对值。\n\n任务：\n1) 基于上述基础，论证为何 Maue 型正则化在离散层面上会导出形如 $B_k = C^{\\top} V_k C$ 的表示（根据给定定义），以及为何必须使用伪逆 $V_0$ 来处理静态零空间。请勿引入任何其他未引用的建模假设。\n2) 实现一个程序，为给定网格构建 $C$、$L$ 和 $V_k$，组装 $B_k = C^{\\top} V_k C$，并计算作为 $B_k$ 最小奇异值的离散 inf-sup 常数。\n3) 对于下方的测试套件，计算每个 $k$ 对应的离散 inf-sup 常数并报告结果。所有输出均为无量纲实数。\n\n测试套件：\n- 情况 1 (理想情况)：$k = 1.0$。\n- 情况 2 (中等小值)：$k = 0.1$。\n- 情况 3 (极小值)：$k = 10^{-6}$。\n- 情况 4 (静态极限)：$k = 0.0$ (对 $V_0$ 使用 Moore–Penrose 伪逆)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按给定顺序排列的四种情况的结果，以逗号分隔并用方括号括起来，例如 `[r_1,r_2,r_3,r_4]`。", "solution": "该问题被评估为有效，因为它在计算电磁学方面有科学依据，是适定的、客观的，并且内部一致。它提出了一个简化但概念上合理的模型，用于研究超奇异边界积分算子的混合有限元离散的低频稳定性。\n\n任务是论证所提供的正则化超奇异算子的离散模型，然后为一组给定的波数计算其稳定性常数。\n\n### 1. 离散模型的理论论证\n\n任务的核心是论证正则化超奇异算子的离散表示 $B_k = C^{\\top} V_k C$ 以及在静态极限 $k=0$ 时使用伪逆的合理性。\n\n#### 1.1. Maue 型正则化与离散形式 $C^{\\top} V_k C$\n\n超奇异算子，通常表示为 $\\mathcal{K}$，出现在麦克斯韦方程组的边界积分公式中。在电场积分方程 (EFIE) 的背景下，作用于表面电流密度 $\\mathbf{J}$ 的算子由 $\\mathcal{A}(\\mathbf{J}) = i\\omega\\mu_0 \\mathcal{S}_k(\\mathbf{J}) + \\frac{1}{i\\omega\\epsilon_0} \\mathcal{K}(\\mathbf{J})$ 给出，其中 $\\mathcal{S}_k$ 是单层势算子，$\\mathcal{K}$ 是超奇异算子。波数为 $k = \\omega\\sqrt{\\mu_0 \\epsilon_0}$。\n\n对 $\\mathcal{K}$ 的朴素离散在数值上是不稳定的。Maue 型正则化是克服这种不稳定性的标准程序。它依赖于恒等式 $\\mathcal{K}(\\mathbf{J}) = (\\nabla_S \\nabla_S \\cdot + k^2 \\mathbf{I}) \\mathcal{S}_k(\\mathbf{J})$，其中 $\\nabla_S$ 和 $\\nabla_S \\cdot$ 分别是表面梯度和表面散度。超奇异算子的弱形式，在用函数 $\\mathbf{g}$ 测试时为 $\\langle \\mathbf{g}, \\mathcal{K}(\\mathbf{f}) \\rangle$，其中 $\\mathbf{f}$ 是试探函数。使用表面上的分部积分（表面矢量格林恒等式），有问题的项 $\\nabla_S \\nabla_S \\cdot$ 被正则化：\n$$\n\\langle \\mathbf{g}, \\mathcal{K}(\\mathbf{f}) \\rangle = \\langle \\nabla_S \\cdot \\mathbf{g}, \\mathcal{S}_k(\\nabla_S \\cdot \\mathbf{f}) \\rangle + k^2 \\langle \\mathbf{g}, \\mathcal{S}_k(\\mathbf{f}) \\rangle\n$$\n这种形式是稳定的，是现代有限元边界元方法的基础。该公式的低频（$k \\to 0$）稳定性关键取决于 $\\mathbf{f}$ 的试探空间和 $\\mathbf{g}$ 的测试空间的选择。众所周知，将 Rao-Wilton-Glisson (RWG) 函数用于 $\\mathbf{f}$ 和 Buffa-Christiansen (BC) 函数用于 $\\mathbf{g}$ 的配对，提供了一种在 $k \\to 0$ 时稳健的稳定离散化。\n\n该问题提供了此公式的一个最小、无度量的离散模型。让我们分析其组成部分：\n- **试探函数和测试函数**：RWG 试探函数的单个自由度对应于单个内部边上基函数的系数。BC 测试函数的单个自由度通过对偶网格与此边相关联。\n- **离散表面散度 $C$**：与一条边相关联的 RWG 基函数具有分段常数的表面散度，在相邻的两个面上取相反的值。问题用矩阵 $C = [1, -1]^{\\top} \\in \\mathbb{R}^{2 \\times 1}$ 来模拟从基于边的系数到基于面的散度系数的这种映射。该矩阵是一个定向的面-边关联矩阵，并作为表面散度算子 $\\nabla_S \\cdot$ 的一个离散、无度量的表示。\n- **离散单层算子 $V_k$**：单层算子 $\\mathcal{S}_k$ 是表面亥姆霍兹方程 $(-\\Delta_S + k^2) u = \\sigma$ 的解算子，其中 $\\sigma$ 是表面源密度， $u$ 是产生的势。其离散对应物 $V_k$ 将面上的离散源的系数映射到面上的离散势的系数。表达式 $V_k = (L + k^2 I)^{-1}$ 是离散亥姆霍兹算子的一个规范模型，其中 $L$ 是表示 $-\\Delta_S$ 的图拉普拉斯算子，$k^2 I$ 是质量项。给定的拉普拉斯算子 $L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$ 是共享一条边的两个面组成的网格的正确图拉普拉斯算子。\n- **用于测试的伴随算子**：在 Petrov-Galerkin 格式中，弱形式中应用于测试函数的算子是应用于试探函数的算子的伴随算子。在这个具有单位质量矩阵的离散、无度量设置中，离散散度 $C$ 的伴随是其转置 $C^{\\top}$。\n\n结合这些元素，正则化双线性形式的主要项 $\\langle \\nabla_S \\cdot \\mathbf{g}, \\mathcal{S}_k(\\nabla_S \\cdot \\mathbf{f}) \\rangle$ 被离散化为 $C^{\\top} V_k C$。第二项 $k^2 \\langle \\mathbf{g}, \\mathcal{S}_k(\\mathbf{f}) \\rangle$ 是 $k$ 的更高阶项，其稳定性不那么关键。所选模型 $B_k = C^\\top V_k C$ 关注于导致低频行为的主要结构，是离散外微分中一个公认的范式。\n\n#### 1.2. 静态极限 ($k=0$) 与 Moore-Penrose 伪逆\n\n当波数 $k$ 设为 $0$ 时，离散算子 $V_k$ 变为 $V_0 = (L + 0^2 I)^{-1} = L^{-1}$。我们必须分析矩阵 $L = \\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}$。其列是线性相关的，向量 $[1, 1]^\\top$ 在其零空间中，因为 $L[1, 1]^\\top = [0, 0]^\\top$。因此，$L$ 是奇异的，其标准逆不存在。\n\n这种奇异性有其物理和数学基础。矩阵 $L$ 代表静态拉普拉斯-贝尔特拉米算子 $-\\Delta_S$。在没有边界的表面上（或像本例一样，具有自然边界条件），拉普拉斯算子的零空间由常数函数组成。向量 $[1, 1]^\\top$ 代表了网格两个面上的常数函数。\n\n然而，算子 $L$ 并不作用于任意向量。它作用于离散散度算子 $C$ 的输出。对于单个 RWG 系数 $x \\in \\mathbb{R}^1$，产生的散度向量是 $Cx = [x, -x]^\\top$。这个向量的元素之和为 $x - x = 0$。这意味着向量 $Cx$ 与 $L$ 的零空间正交（因为 $\\langle [x, -x]^\\top, [1, 1]^\\top \\rangle = x - x = 0$）。\n\n因此，向量 $Cx$ 位于算子 $L$ 的值域内。方程 $L\\mathbf{y} = Cx$ 是相容的，对 $\\mathbf{y}$ 有解。解不是唯一的；如果 $\\mathbf{y}_p$ 是一个特解，则通解为 $\\mathbf{y}_p + \\alpha [1, 1]^\\top$，其中 $\\alpha$ 是任意标量。为了获得一个唯一、良定义的算子，我们必须选择一个特定的解。标准的选择是那个本身与 $L$ 的零空间正交的唯一解。Moore-Penrose 伪逆, $L^+$, 正好提供了这个解。\n\n因此，对于静态情况 $k=0$，单层算子的正确定义是 $V_0 = L^+$。这个过程在数学上是合理的，在物理上对应于对势施加零均值条件，这对于由内部 RWG 函数的散度产生的平衡电荷分布是合适的。极限 $\\lim_{k\\to 0} V_k = L^+$ 的连续性进一步证实了这一选择。\n\n### 2. Inf-Sup 常数的计算\n\n离散 inf-sup 常数 $\\gamma_k$ 是矩阵 $B_k = C^{\\top} V_k C$ 的最小奇异值。由于 $B_k$ 是一个 $1 \\times 1$ 的矩阵（一个标量），它的奇异值就是它的绝对值，$\\gamma_k = |B_k|$。\n\n#### 情况 1：$k > 0$\n算子矩阵是 $L + k^2 I = \\begin{bmatrix} 1+k^2  -1 \\\\ -1  1+k^2 \\end{bmatrix}$。\n行列式是 $\\det(L + k^2 I) = (1+k^2)^2 - 1 = 1 + 2k^2 + k^4 - 1 = k^2(2+k^2)$。\n逆矩阵是 $V_k = (L + k^2 I)^{-1} = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} 1+k^2  1 \\\\ 1  1+k^2 \\end{bmatrix}$。\n\n我们现在组装 $B_k = C^{\\top} V_k C$:\n$$\nB_k = \\begin{bmatrix} 1  -1 \\end{bmatrix} \\left( \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} 1+k^2  1 \\\\ 1  1+k^2 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}\n$$\n首先，$C^{\\top}V_k$：\n$$\nC^{\\top}V_k = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} (1+k^2)-1  1-(1+k^2) \\end{bmatrix} = \\frac{1}{k^2(2+k^2)} \\begin{bmatrix} k^2  -k^2 \\end{bmatrix} = \\frac{1}{2+k^2} \\begin{bmatrix} 1  -1 \\end{bmatrix}\n$$\n然后，$(C^{\\top}V_k)C$：\n$$\nB_k = \\left( \\frac{1}{2+k^2} \\begin{bmatrix} 1  -1 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{2+k^2} (1\\cdot 1 + (-1)\\cdot(-1)) = \\frac{2}{2+k^2}\n$$\ninf-sup 常数是 $\\gamma_k = |B_k| = \\frac{2}{2+k^2}$，对于所有实数 $k$ 均为正。\n\n#### 情况 2：$k_0 = 0$\n我们计算 $L = \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$ 的 Moore-Penrose 伪逆。$L$ 的谱分解产生特征值 $\\lambda_1 = 2$ 和 $\\lambda_2=0$。伪逆是通过对非零特征值求逆来形成的。\n$L$ 具有谱分解 $L = \\lambda_1 \\mathbf{u}_1 \\mathbf{u}_1^\\top + \\lambda_2 \\mathbf{u}_2 \\mathbf{u}_2^\\top$，其中 $\\mathbf{u}_1 = \\frac{1}{\\sqrt{2}}[1, -1]^\\top$ and $\\mathbf{u}_2 = \\frac{1}{\\sqrt{2}}[1, 1]^\\top$。\n伪逆是 $V_0 = L^+ = \\frac{1}{\\lambda_1} \\mathbf{u}_1 \\mathbf{u}_1^\\top$：\n$$\nV_0 = \\frac{1}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1  -1 \\end{bmatrix} \\right) = \\frac{1}{4} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n现在我们组装 $B_0 = C^{\\top} V_0 C$:\n$$\nB_0 = \\begin{bmatrix} 1  -1 \\end{bmatrix} \\left( \\frac{1}{4} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} 2  -2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{4} (2 - (-2)) = \\frac{4}{4} = 1\n$$\ninf-sup 常数是 $\\gamma_0 = |B_0| = 1$。这个结果与一般公式在 $k \\to 0$ 时的极限一致：$\\lim_{k\\to 0} \\frac{2}{2+k^2} = 1$。稳定性常数有界且不为零，证明了该公式的稳健性。\n\n### 3. 测试套件的数值结果\n-   情况 1 ($k=1.0$)： $\\gamma_{1.0} = \\frac{2}{2+1^2} = \\frac{2}{3} \\approx 0.6667$\n-   情况 2 ($k=0.1$)： $\\gamma_{0.1} = \\frac{2}{2+0.1^2} = \\frac{2}{2.01} \\approx 0.9950$\n-   情况 3 ($k=10^{-6}$)： $\\gamma_{10^{-6}} = \\frac{2}{2+(10^{-6})^2} = \\frac{2}{2+10^{-12}} \\approx 1.0$\n-   情况 4 ($k=0.0$)： $\\gamma_0 = 1.0$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete inf-sup constant for a minimal model of a\n    regularized hypersingular operator with RWG-BC basis functions.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        1.0,        # Case 1: happy path\n        0.1,        # Case 2: moderately small k\n        1e-6,       # Case 3: very small k\n        0.0,        # Case 4: static limit\n    ]\n\n    # Define the discrete operators based on the provided minimal model.\n    # C is the discrete surface curl/incidence matrix (2x1).\n    C = np.array([[1.0], [-1.0]])\n    \n    # L is the graph Laplacian for the two-face adjacency (2x2).\n    L = np.array([[1.0, -1.0], [-1.0, 1.0]])\n    \n    # I is the identity matrix (2x2).\n    I = np.eye(2)\n\n    results = []\n    for k in test_cases:\n        # For k > 0, the discrete single-layer operator V_k is the inverse of\n        # the discrete Helmholtz operator (L + k^2 * I).\n        if k > 0.0:\n            V_k = np.linalg.inv(L + k**2 * I)\n        # For k = 0, the operator L is singular. We use the Moore-Penrose\n        # pseudoinverse, which correctly handles the static nullspace.\n        else:\n            V_k = np.linalg.pinv(L)\n        \n        # Assemble the discrete bilinear form B_k = C^T * V_k * C.\n        # The result is a 1x1 matrix.\n        B_k_matrix = C.T @ V_k @ C\n        \n        # The discrete inf-sup constant is the smallest singular value of B_k.\n        # For a 1x1 matrix [b], this is simply its absolute value |b|.\n        inf_sup_constant = np.abs(B_k_matrix[0, 0])\n        \n        results.append(inf_sup_constant)\n\n    # Final print statement in the exact required format.\n    # e.g., [r_1,r_2,r_3,r_4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3316178"}, {"introduction": "在理解了稳定离散格式的重要性之后，下一步是建立对正则化公式本身的信心。本练习通过将一个关键的正则化恒等式（Maue公式）的谱方法计算结果与一个更直观的、基于边值邻近场有限差分的近似解进行比较，从而验证了该公式的正确性 [@problem_id:3316200]。通过实践证明抽象的数学公式与直接的物理近似能够得到一致的结果，本练习将巩固您对正则化技术的理解与信任。", "problem": "您需要通过比较一种仅边界正则化公式与沿表面法线方向在极细网格上的近表面“类体积”计算，来验证二维静电学中超奇异边界积分算子的正则化。边界是单位圆，场由拉普拉斯方程控制。角度必须以弧度处理。不需要物理单位。最终输出必须是包含布尔值列表的单行。\n\n从二维静电学的以下基本基础开始：拉普拉斯方程及其自由空间格林函数。二维拉普拉斯方程的自由空间格林函数是\n$$\nG(\\mathbf{x},\\mathbf{y}) \\;=\\; -\\frac{1}{2\\pi}\\,\\log\\lVert \\mathbf{x}-\\mathbf{y}\\rVert,\n$$\n其中 $\\mathbf{x},\\mathbf{y}\\in\\mathbb{R}^2$。将在光滑闭合曲线 $\\Gamma$ 上密度为 $\\varphi$ 的双层势定义为\n$$\n\\big(D\\varphi\\big)(\\mathbf{x}) \\;=\\; \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\varphi(\\mathbf{y}) \\, ds_{\\mathbf{y}},\n$$\n其中 $\\partial/\\partial n(\\mathbf{y})$ 表示在 $\\mathbf{y}\\in\\Gamma$ 处的外法向导数，而 $ds_{\\mathbf{y}}$ 是弧长测度。超奇异边界算子 $N$ 定义为双层势法向导数的边界极限：\n$$\n(N\\varphi)(\\mathbf{x}) \\;=\\; \\lim_{\\substack{\\mathbf{x}'\\to\\mathbf{x}\\\\ \\mathbf{x}'\\notin \\Gamma}} \\frac{\\partial}{\\partial n(\\mathbf{x})}\\big(D\\varphi\\big)(\\mathbf{x}'),\n\\qquad \\mathbf{x}\\in \\Gamma.\n$$\n众所周知（Maue 公式，这是光滑曲线上拉普拉斯超奇异算子的一个标准正则化恒等式），对于光滑闭合曲线上的拉普拉斯方程：\n$$\nN\\varphi \\;=\\; -\\frac{\\partial}{\\partial s}\\,\\Big(S\\,\\frac{\\partial\\varphi}{\\partial s}\\Big),\n$$\n其中 $S$ 是由下式给出的单层算子\n$$\n(S\\psi)(\\mathbf{x}) \\;=\\; \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\psi(\\mathbf{y})\\,ds_{\\mathbf{y}},\n$$\n而 $\\partial/\\partial s$ 表示沿 $\\Gamma$ 的切向导数。\n\n在单位圆 $\\Gamma=\\{\\mathbf{x}(\\theta)=(\\cos\\theta,\\sin\\theta),\\, \\theta\\in[0,2\\pi)\\}$ 上，边界上的单层算子在傅里叶基中对角化。如果 $\\psi(\\theta)=\\sum_{n=-\\infty}^{\\infty}\\hat\\psi_n e^{\\mathrm{i} n\\theta}$，则\n$$\n(S\\psi)(\\theta) \\;=\\; \\sum_{n\\neq 0} \\frac{1}{2|n|}\\,\\hat\\psi_n\\,e^{\\mathrm{i} n\\theta}, \\qquad \\text{并且} \\qquad (S\\psi)_0=0.\n$$\n因此，\n$$\nN\\varphi(\\theta) \\;=\\; \\sum_{n\\neq 0} \\frac{|n|}{2}\\,\\hat\\varphi_n\\,e^{\\mathrm{i} n\\theta}.\n$$\n\n您的任务是在单位圆上实现并验证 $N\\varphi$ 的两种数值近似方法：\n\n1) 正则化仅边界方法（谱方法）：使用离散傅里叶变换（在 $\\theta$ 的等距节点上）实现 $N\\varphi(\\theta)=-\\frac{\\partial}{\\partial s}\\big(S(\\partial\\varphi/\\partial s)\\big)$。具体来说，使用上面的傅里叶乘子恒等式在傅里叶域中应用 $S$，并使用傅里叶微分来应用 $\\partial/\\partial s$，注意在单位圆上 $\\partial/\\partial s=\\partial/\\partial\\theta$。\n\n2) 近表面“类体积”方法：定义 $\\mathbf{x}(\\theta)=(\\cos\\theta,\\sin\\theta)$ 和外单位法向量 $\\mathbf{n}(\\theta)=\\mathbf{x}(\\theta)$。对于一个小的偏移量 $\\delta>0$，定义近表面点 $\\mathbf{x}^{\\pm}_\\delta(\\theta) = \\mathbf{x}(\\theta) \\pm \\delta\\,\\mathbf{n}(\\theta) = (1\\pm \\delta)\\,\\mathbf{x}(\\theta)$。通过在 $\\tau\\in[0,2\\pi)$ 上进行求积来计算这些近表面点上的双层势 $D\\varphi$：\n$$\n\\big(D\\varphi\\big)(\\mathbf{x}) \\;\\approx\\; \\sum_{j=0}^{M-1} w \\,\\frac{\\partial G(\\mathbf{x},\\mathbf{y}_j)}{\\partial n(\\mathbf{y}_j)}\\,\\varphi(\\tau_j), \\quad \\mathbf{y}_j=(\\cos\\tau_j,\\sin\\tau_j), \\quad \\mathbf{n}(\\mathbf{y}_j)=\\mathbf{y}_j,\n$$\n其中均匀节点为 $\\tau_j = 2\\pi j/M$，权重为 $w=2\\pi/M$，且\n$$\n\\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\;=\\; \\nabla_{\\mathbf{y}} G(\\mathbf{x},\\mathbf{y})\\cdot \\mathbf{n}(\\mathbf{y}) \\;=\\; \\frac{1}{2\\pi}\\,\\frac{(\\mathbf{x}-\\mathbf{y})\\cdot \\mathbf{n}(\\mathbf{y})}{\\lVert \\mathbf{x}-\\mathbf{y}\\rVert^2}.\n$$\n对于每个边界节点 $\\theta_i$，通过中心差分来近似边界法向导数：\n$$\n\\left.\\frac{\\partial}{\\partial n} D\\varphi\\right|_{\\mathbf{x}(\\theta_i)} \\;\\approx\\; \\frac{D\\varphi\\big(\\mathbf{x}^+_\\delta(\\theta_i)\\big)-D\\varphi\\big(\\mathbf{x}^-_\\delta(\\theta_i)\\big)}{2\\delta}.\n$$\n\n计算并比较在一组 $N$ 个等距边界节点 $\\theta_i=2\\pi i/N$, $i=0,\\dots,N-1$ 上 $N\\varphi$ 的两种近似。使用差值的绝对 $L^2(\\Gamma)$ 范数来衡量差异，该范数通过圆上的梯形法则进行离散化：\n$$\n\\lVert e\\rVert_{L^2(\\Gamma)} \\;\\approx\\; \\left( \\sum_{i=0}^{N-1} \\big| e(\\theta_i)\\big|^2 \\,\\Delta s \\right)^{1/2}, \\qquad \\Delta s = \\frac{2\\pi}{N}.\n$$\n如果绝对 $L^2(\\Gamma)$ 误差小于或等于给定的容差 $\\epsilon$，则认为场的一致性是可接受的。\n\n实现一个程序，对于下面指定的每个测试案例，返回一个布尔值，指示近表面方法是否在给定的 $\\epsilon$ 容差内与正则化谱方法在绝对 $L^2(\\Gamma)$ 范数下一致。所有角度必须使用弧度。不需要物理单位。最终输出必须是单行，其中包含用方括号括起来并以逗号分隔的结果列表（例如，\"[True,False,True]\"）。\n\n测试套件（每个案例指定边界采样大小 $N$、源求积点数 $M$、偏移量 $\\delta$、容差 $\\epsilon$ 和密度 $\\varphi(\\theta)$）：\n\n- 案例 1 (正常路径)：$N=256$，$M=4096$，$\\delta=10^{-3}$，$\\epsilon=10^{-3}$，密度为 $\\varphi(\\theta) = \\sin(3\\theta) + \\tfrac{1}{2}\\cos(2\\theta)$。\n\n- 案例 2 (高频密度)：$N=512$，$M=16384$，$\\delta=7.5\\times 10^{-4}$，$\\epsilon=2\\times 10^{-3}$，密度为 $\\varphi(\\theta) = \\sin(15\\theta)$。\n\n- 案例 3 (边界情况，恒定密度)：$N=256$，$M=4096$，$\\delta=10^{-3}$，$\\epsilon=10^{-4}$，密度为 $\\varphi(\\theta) = 1$。\n\n- 案例 4 (减少求积点，混合模式)：$N=256$，$M=1024$，$\\delta=2\\times 10^{-3}$，$\\epsilon=5\\times 10^{-3}$，密度为 $\\varphi(\\theta) = \\sin(9\\theta) + 0.2\\cos(5\\theta)$。\n\n您的程序必须按指定顺序计算每个案例的布尔结果，并打印一行包含结果列表的字符串，格式需完全符合要求。", "solution": "该问题要求在单位圆上验证二维拉普拉斯超奇异边界积分算子 $N$ 的数值正则化。这是通过将一种基于 Maue 正则化公式的谱精确仅边界方法与一种使用近表面势评估和有限差分的直接数值近似进行比较来实现的。\n\n超奇异算子 $N$ 定义为双层势 $D\\varphi$ 在边界 $\\Gamma$ 上的法向导数：\n$$\n(N\\varphi)(\\mathbf{x}) = \\lim_{\\mathbf{x}' \\to \\mathbf{x}} \\frac{\\partial}{\\partial n(\\mathbf{x})} (D\\varphi)(\\mathbf{x}'), \\quad \\mathbf{x} \\in \\Gamma\n$$\n其中\n$$\n(D\\varphi)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\varphi(\\mathbf{y}) ds_{\\mathbf{y}}\n$$\n且 $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi}\\log\\|\\mathbf{x}-\\mathbf{y}\\|$ 是二维拉普拉斯方程的自由空间格林函数。\n\n我们将在单位圆上的一组离散的 $N$ 个等距点 $\\mathbf{x}_i = (\\cos\\theta_i, \\sin\\theta_i)$ 上实现并比较两种计算 $(N\\varphi)(\\mathbf{x})$ 的方法，其中 $\\theta_i = 2\\pi i/N$，对于 $i=0, \\dots, N-1$。\n\n### 方法 1：正则化谱方法\n\n此方法利用了 Maue 公式，该公式使用单层算子 $S$ 对超奇异算子 $N$ 进行正则化：\n$$\nN\\varphi = -\\frac{\\partial}{\\partial s} \\left( S \\frac{\\partial\\varphi}{\\partial s} \\right)\n$$\n在单位圆上，弧长导数 $\\partial/\\partial s$ 等价于角导数 $\\partial/\\partial\\theta$。对于一个傅里叶级数为 $\\psi(\\theta) = \\sum_{n=-\\infty}^{\\infty} \\hat{\\psi}_n e^{\\mathrm{i}n\\theta}$ 的函数 $\\psi$，算子 $\\partial/\\partial\\theta$ 和 $S$ 的作用可以表示为傅里叶域中的乘法：\n-   $\\mathcal{F}\\left(\\frac{\\partial\\psi}{\\partial\\theta}\\right)_n = \\mathrm{i}n\\,\\hat{\\psi}_n$\n-   当 $n \\neq 0$ 时，$\\mathcal{F}(S\\psi)_n = \\frac{1}{2|n|}\\,\\hat{\\psi}_n$，当 $n=0$ 时为 $0$。\n\n将这些组合用于 $N\\varphi = -\\frac{\\partial}{\\partial\\theta} S \\frac{\\partial\\varphi}{\\partial\\theta}$，可以得到算子 $N$ 的傅里叶乘子：\n$$\n\\mathcal{F}(N\\varphi)_n = -(\\mathrm{i}n) \\left( \\frac{1}{2|n|} (\\mathrm{i}n\\,\\hat{\\varphi}_n) \\right) = \\frac{n^2}{2|n|}\\,\\hat{\\varphi}_n = \\frac{|n|}{2}\\,\\hat{\\varphi}_n \\quad (\\text{对于 } n \\neq 0)\n$$\n且 $\\mathcal{F}(N\\varphi)_0 = 0$。这与所给的公式相符。\n\n数值实现过程如下：\n1.  在 $N$ 个点 $\\theta_i$ 上离散化密度 $\\varphi(\\theta)$。\n2.  使用快速傅里叶变换 (FFT) 算法计算其离散傅里叶变换 (DFT)，得到系数 $\\hat{\\varphi}_k$。\n3.  确定与 DFT 频率对应的离散波数 $k$。对于长度为 $N$ 的变换，这些是整数，从 $0$ 到 $\\lfloor N/2 \\rfloor$ 以及从 $-\\lceil N/2 \\rceil+1$ 到 $-1$。\n4.  通过将每个系数 $\\hat{\\varphi}_k$ 乘以 $|k|/2$ 来应用 $N$ 的谱乘子。$k=0$（直流）分量被正确地乘以 $0$。\n5.  计算所得系数的逆 DFT，以获得 $(N\\varphi)(\\theta_i)$ 的值。\n\n### 方法 2：近表面有限差分法\n\n此方法直接近似 $N\\varphi$ 作为 $D\\varphi$ 的法向导数的定义。每个边界点 $\\mathbf{x}(\\theta_i)$ 处的法向导数通过使用沿法向偏离边界微小距离的点上的 $D\\varphi$ 值，通过二阶中心有限差分来近似：\n$$\n(N\\varphi)(\\mathbf{x}_i) \\approx \\frac{(D\\varphi)(\\mathbf{x}^+_\\delta(\\theta_i)) - (D\\varphi)(\\mathbf{x}^-_\\delta(\\theta_i))}{2\\delta}\n$$\n其中，对于一个小的偏移量 $\\delta > 0$，$\\mathbf{x}^{\\pm}_\\delta(\\theta_i) = \\mathbf{x}(\\theta_i) \\pm \\delta \\mathbf{n}(\\theta_i) = (1 \\pm \\delta)\\mathbf{x}(\\theta_i)$。\n\n双层势 $D\\varphi$ 在任何边界外点 $\\mathbf{x}$ 的值是通过在边界上进行数值求积来计算的。该积分使用梯形法则，以 $M$ 个均匀源点 $\\mathbf{y}_j = (\\cos\\tau_j, \\sin\\tau_j)$ 进行离散化，其中 $\\tau_j = 2\\pi j/M$。\n$$\n(D\\varphi)(\\mathbf{x}) \\approx \\sum_{j=0}^{M-1} \\frac{2\\pi}{M} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y}_j)}{\\partial n(\\mathbf{y}_j)} \\varphi(\\tau_j)\n$$\n双层积分的核函数由下式给出：\n$$\n\\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\nabla_{\\mathbf{y}} G(\\mathbf{x}, \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y}) = \\frac{1}{2\\pi} \\frac{(\\mathbf{x} - \\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{\\|\\mathbf{x} - \\mathbf{y}\\|^2}\n$$\n在单位圆上，对于 $\\mathbf{y} = (\\cos\\tau, \\sin\\tau)$ 和 $\\mathbf{n}(\\mathbf{y}) = \\mathbf{y}$，以及一个求值点 $\\mathbf{x} = (1 \\pm \\delta)(\\cos\\theta, \\sin\\theta)$，这简化为：\n$$\n\\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\frac{1}{2\\pi} \\frac{(1 \\pm \\delta)\\cos(\\theta - \\tau) - 1}{(1 \\pm \\delta)^2 - 2(1 \\pm \\delta)\\cos(\\theta - \\tau) + 1}\n$$\n对每个点 $\\mathbf{x}_{i, \\delta}^{\\pm}$ 执行此计算以找到 $(D\\varphi)(\\mathbf{x}_{i, \\delta}^{\\pm})$，然后将它们用于有限差分公式。\n\n### 验证与比较\n\n对于每个测试案例，我们使用两种方法计算 $N$ 个节点上 $N\\varphi$ 的值向量，称之为 $(N\\varphi)_{\\text{spectral}}$ 和 $(N\\varphi)_{\\text{direct}}$。误差定义为差分向量 $e_i = (N\\varphi)_{\\text{spectral}}(\\theta_i) - (N\\varphi)_{\\text{direct}}(\\theta_i)$。两种方法之间的一致性通过计算此误差的离散化绝对 $L^2(\\Gamma)$ 范数来量化：\n$$\n\\|e\\|_{L^2(\\Gamma)} \\approx \\left(\\sum_{i=0}^{N-1} |e_i|^2 \\Delta s \\right)^{1/2}\n$$\n其中 $\\Delta s = 2\\pi/N$ 是节点间的弧长间距。如果 $\\|e\\|_{L^2(\\Gamma)} \\le \\epsilon$，其中 $\\epsilon$ 是给定的容差，则认为近表面方法与谱方法一致。\n\n值得注意的是，对于恒定密度，例如案例 3 中的 $\\varphi(\\theta)=1$，预期两种方法会产生显著不同的结果。正则化谱方法正确地得出 $(N\\varphi)(\\theta)=0$，因为 $\\partial\\varphi/\\partial\\theta = 0$。然而，已知恒定密度的双层势是一个阶跃函数（在 $\\Gamma$ 外为 $0$，在 $\\Gamma$ 内为 $-1$）。其在边界上的法向导数的有限差分近似不收敛，而是产生一个与 $1/\\delta$ 成正比的大值。这种行为是直接有限差分法的一个已知特征，凸显了正则化的必要性。验证任务是按规定实现这些方法，并报告其结果的一致性（或不一致性）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_phi_func(phi_str):\n    \"\"\"\n    Returns a lambda function for the given density string.\n    \"\"\"\n    if phi_str == \"sin(3*theta) + 0.5*cos(2*theta)\":\n        return lambda theta: np.sin(3 * theta) + 0.5 * np.cos(2 * theta)\n    elif phi_str == \"sin(15*theta)\":\n        return lambda theta: np.sin(15 * theta)\n    elif phi_str == \"1\":\n        return lambda theta: np.ones_like(theta)\n    elif phi_str == \"sin(9*theta) + 0.2*cos(5*theta)\":\n        return lambda theta: np.sin(9 * theta) + 0.2 * np.cos(5 * theta)\n    else:\n        raise ValueError(f\"Unknown phi function: {phi_str}\")\n\ndef solve_case(N, M, delta, epsilon, phi_func):\n    \"\"\"\n    Solves a single test case for the hypersingular operator validation.\n    \n    Args:\n        N (int): Number of boundary sampling points.\n        M (int): Number of quadrature points for source integration.\n        delta (float): Offset for near-surface evaluation.\n        epsilon (float): Tolerance for L2 error comparison.\n        phi_func (callable): Function for the density phi(theta).\n        \n    Returns:\n        bool: True if L2 error is within tolerance, False otherwise.\n    \"\"\"\n    \n    # === Method 1: Regularized Spectral Method ===\n    # Grid for boundary evaluation (N points)\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    \n    # Evaluate density on the N-point grid\n    phi_on_N = phi_func(theta)\n    \n    # Compute DFT of the density\n    phi_hat = np.fft.fft(phi_on_N)\n    \n    # Get integer wavenumbers for the DFT\n    k = np.fft.fftfreq(N) * N\n    \n    # Spectral multiplier for the hypersingular operator N\n    N_multiplier = 0.5 * np.abs(k)\n    \n    # Apply multiplier in Fourier domain\n    Nphi_hat_spectral = N_multiplier * phi_hat\n    \n    # Inverse DFT to get N(phi) in physical space\n    # The result should be real; take the real part to discard small imag parts from numerical error.\n    Nphi_spectral = np.fft.ifft(Nphi_hat_spectral).real\n\n    # === Method 2: Near-Surface Finite Difference Method ===\n    # Grid for quadrature (M points)\n    tau = np.linspace(0, 2 * np.pi, M, endpoint=False)\n    \n    # Evaluate density on the M-point quadrature grid\n    phi_on_M = phi_func(tau)\n\n    # Use broadcasting to compute kernel matrices efficiently\n    # theta is (N, 1), tau is (1, M), so cos_diff is (N, M)\n    cos_diff = np.cos(theta[:, None] - tau[None, :])\n    \n    # --- Evaluation at x_plus (outside the circle) ---\n    r_plus = 1.0 + delta\n    # Numerator of the double-layer kernel\n    num_plus = r_plus * cos_diff - 1.0\n    # Denominator of the double-layer kernel\n    den_plus = r_plus**2 - 2.0 * r_plus * cos_diff + 1.0\n    # Kernel matrix (N x M)\n    K_plus = (1.0 / (2.0 * np.pi)) * num_plus / den_plus\n    # Quadrature sum for D(phi) at x_plus points\n    Dphi_plus = K_plus @ phi_on_M * (2.0 * np.pi / M)\n\n    # --- Evaluation at x_minus (inside the circle) ---\n    r_minus = 1.0 - delta\n    num_minus = r_minus * cos_diff - 1.0\n    den_minus = r_minus**2 - 2.0 * r_minus * cos_diff + 1.0\n    K_minus = (1.0 / (2.0 * np.pi)) * num_minus / den_minus\n    Dphi_minus = K_minus @ phi_on_M * (2.0 * np.pi / M)\n    \n    # --- Centered finite difference for N(phi) ---\n    Nphi_direct = (Dphi_plus - Dphi_minus) / (2.0 * delta)\n\n    # === Comparison ===\n    error_vec = Nphi_spectral - Nphi_direct\n    \n    # Discretized L2(Gamma) norm of the error\n    delta_s = 2.0 * np.pi / N\n    l2_error = np.sqrt(np.sum(np.abs(error_vec)**2) * delta_s)\n    \n    return l2_error = epsilon\n\ndef solve():\n    # Test suite from the problem description.\n    # Each tuple: (N, M, delta, epsilon, phi_string)\n    test_cases = [\n        (256, 4096, 1e-3, 1e-3, \"sin(3*theta) + 0.5*cos(2*theta)\"),\n        (512, 16384, 7.5e-4, 2e-3, \"sin(15*theta)\"),\n        (256, 4096, 1e-3, 1e-4, \"1\"),\n        (256, 1024, 2e-3, 5e-3, \"sin(9*theta) + 0.2*cos(5*theta)\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, M, delta, epsilon, phi_str = case\n        phi_func = get_phi_func(phi_str)\n        result = solve_case(N, M, delta, epsilon, phi_func)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3316200"}, {"introduction": "拥有了稳定且经过验证的公式后，实际应用中的最后一个主要障碍是其数值实现。正则化将超奇异积分转化为弱奇异积分，但这仍然需要特殊的数值处理，尤其是在计算奇异性最强的对角线矩阵元素（即自作用项）时 [@problem_id:3316164]。本练习将指导您应用Duffy变换，这是一种强大的坐标变换技术，可将奇异积分映射到高维度的正则积分上，从而能用标准的高斯求积法则精确计算。掌握此技术是准确高效地实现边界元方法的关键。", "problem": "考虑在单个平坦三角形表面元 $\\Delta \\subset \\mathbb{R}^{3}$（其顶点为 $\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}$）上，用于时谐电磁学的正则化超奇异边界积分算子。经过标准的 Maue 型分部积分正则化后，该算子核在限制于重合单元贡献时，包含一个弱奇异分量，其在 $\\mathbf{r} = \\mathbf{r}'$ 附近的局部主项与 $\\ln \\rho$ 成正比（其中 $\\rho = \\|\\mathbf{r} - \\mathbf{r}'\\|$），外加一个光滑余项。设 $\\phi$ 和 $\\psi$ 是 $\\Delta$ 上的光滑检验函数（例如，固定次数的分片多项式基函数），并考虑模型奇异二重积分\n$$\nI_{\\mathrm{sing}} = \\int_{\\Delta} \\int_{\\Delta} \\ln \\|\\mathbf{r} - \\mathbf{r}'\\| \\, \\phi(\\mathbf{r}) \\, \\psi(\\mathbf{r}') \\, \\mathrm{d}S_{\\mathbf{r}} \\, \\mathrm{d}S_{\\mathbf{r}'} .\n$$\n你需要设计一个针对重合单元情况的 Duffy 型坐标变换，该变换将局部近对角积分转换为具有显式单变量对数因子的张量积形式，然后估计应用于变换后积分的张量积 Gauss 型求积的代数收敛性。\n\n任务：\n- 参数化参考三角形 $\\widehat{\\Delta} = \\{ (\\lambda_{1}, \\lambda_{2}) \\in \\mathbb{R}^{2} : \\lambda_{1} \\ge 0, \\lambda_{2} \\ge 0, \\lambda_{1} + \\lambda_{2} \\le 1 \\}$，通过 $\\mathbf{r}(\\lambda_{1}, \\lambda_{2}) = \\mathbf{r}_{1} + \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b}$，其中 $\\mathbf{a} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$ 和 $\\mathbf{b} = \\mathbf{r}_{3} - \\mathbf{r}_{1}$，对 $\\mathbf{r}'(\\mu_{1}, \\mu_{2})$ 也做类似处理。仅使用基本的几何和测度论知识，在一个满足重心坐标 $\\mu_{i} \\le \\lambda_{i}$（对于 $i=1,2,3$，其中 $\\lambda_{3} = 1 - \\lambda_{1} - \\lambda_{2}$ 和 $\\mu_{3} = 1 - \\mu_{1} - \\mu_{2}$）的代表性近对角子域上，构建一个 Duffy 型变换。在该子域中，强制关系 $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$，其中 $\\zeta \\in [0,1]$ 是一个标量坍缩参数，并证明距离在远离三角形边的 $\\boldsymbol{\\lambda}$ 上一致地表现为 $\\rho \\asymp (1 - \\zeta)$，而曲面测度积变换为 $\\mathrm{d}S_{\\mathbf{r}} \\, \\mathrm{d}S_{\\mathbf{r}'} = C_{\\Delta} \\, \\zeta^{2} \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta$，其中 $C_{\\Delta}  0$ 是一个仅取决于三角形几何形状的常数，此变换至多相差一个在子域内有上下界的光滑严格为正的因子。最后得出结论：经过光滑单位分解进行局部化后，奇异贡献可简化为在 $\\widehat{\\Delta} \\times [0,1]$ 上的一个三重积分，形式如下\n$$\n\\int_{0}^{1} \\int_{\\widehat{\\Delta}} \\zeta^{2} \\, \\ln(1 - \\zeta) \\, G(\\lambda_{1}, \\lambda_{2}, \\zeta) \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta,\n$$\n其中 $G$ 在该紧致域上是光滑且严格为正的。\n\n现在，假设你使用一个张量积求积来近似这个三重积分，该求积包括：\n- 在 $[0,1]$ 上的 $\\zeta$ 变量上使用一个 $n$ 点 Gauss–Legendre 法则，以及\n- 在 $\\widehat{\\Delta}$ 上对 $(\\lambda_{1}, \\lambda_{2})$ 变量使用一个 $n$ 阶对称三角形求积，该求积使用 $\\mathcal{O}(n^{2})$ 个点。\n\n令 $P$ 表示此重合单元贡献所需的求积点总数。通过估计由对数端点奇异性的 $\\zeta$ 积分引起的主要求积误差，并仅使用关于 Gauss–Legendre 对端点对数被积函数的精度的成熟结果以及 $G$ 的光滑性，确定代数衰减指数 $\\alpha$，使得复合张量积求积误差 $E(P)$ 满足\n$$\nE(P) = \\mathcal{O}\\!\\left( P^{-\\alpha} \\right) \\quad \\text{as} \\quad P \\to \\infty .\n$$\n只需提供最终的指数 $\\alpha$ 作为最简分数。无需单位。", "solution": "我们从 $\\mathbb{R}^{3}$ 中一个平坦三角形 $\\Delta$ 上的积分算子设定开始。令 $\\mathbf{a} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$ 和 $\\mathbf{b} = \\mathbf{r}_{3} - \\mathbf{r}_{1}$。该三角形的仿射参数化为 $\\mathbf{r}(\\lambda_{1}, \\lambda_{2}) = \\mathbf{r}_{1} + \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b}$，其中 $(\\lambda_{1}, \\lambda_{2}) \\in \\widehat{\\Delta} = \\{ \\lambda_{1} \\ge 0, \\lambda_{2} \\ge 0, \\lambda_{1} + \\lambda_{2} \\le 1 \\}$。面积元为 $\\mathrm{d}S_{\\mathbf{r}} = |\\mathbf{a} \\times \\mathbf{b}| \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2}$。类似地，参数化 $\\mathbf{r}'(\\mu_{1}, \\mu_{2}) = \\mathbf{r}_{1} + \\mu_{1} \\mathbf{a} + \\mu_{2} \\mathbf{b}$，其中 $(\\mu_{1}, \\mu_{2}) \\in \\widehat{\\Delta}$，且 $\\mathrm{d}S_{\\mathbf{r}'} = |\\mathbf{a} \\times \\mathbf{b}| \\, \\mathrm{d}\\mu_{1} \\, \\mathrm{d}\\mu_{2}$。\n\n在计算电磁学中，对超奇异算子进行 Maue 型正则化后，沿对角线 $\\{ \\mathbf{r} = \\mathbf{r}' \\}$ 的剩余弱奇异核的主阶可以建模为 $c \\, \\ln \\rho$，其中 $\\rho = \\| \\mathbf{r} - \\mathbf{r}' \\|$ 且 $c \\in \\mathbb{R}$ 为某个常数，外加一个光滑余项。由于 $\\phi$ 和 $\\psi$ 在 $\\Delta$ 上是光滑的，局部奇异结构由几何和对数决定。我们关注 $\\widehat{\\Delta} \\times \\widehat{\\Delta}$ 的一个代表性子域，其中重心坐标满足分量序\n$$\n\\mu_{i} \\le \\lambda_{i} \\quad \\text{for} \\quad i = 1, 2, 3, \\qquad \\text{with} \\quad \\lambda_{3} = 1 - \\lambda_{1} - \\lambda_{2}, \\ \\ \\mu_{3} = 1 - \\mu_{1} - \\mu_{2}.\n$$\n在该子域上，可以通过坍缩参数 $\\zeta \\in [0,1]$ 将内点参数化为 $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$，即\n$$\n\\mu_{1} = \\zeta \\lambda_{1}, \\qquad \\mu_{2} = \\zeta \\lambda_{2}, \\qquad \\mu_{3} = \\zeta \\lambda_{3},\n$$\n使得 $\\mathbf{r}'$ 在重心坐标中位于连接 $\\mathbf{r}_{1}$ 和 $\\mathbf{r}$ 的线段上。这是用于重合单元的典型 Duffy 型映射：它将四维近对角集坍缩到三维张量积集 $\\widehat{\\Delta} \\times [0,1]$ 上，并与在 $\\widehat{\\Delta} \\times \\widehat{\\Delta}$ 的其他五个由分量序的排列定义的子域上的类似构造配对。\n\n距离缩放。通过上述映射，\n$$\n\\mathbf{r}' - \\mathbf{r} \\, = \\, \\left( \\zeta \\lambda_{1} - \\lambda_{1} \\right) \\mathbf{a} \\, + \\, \\left( \\zeta \\lambda_{2} - \\lambda_{2} \\right) \\mathbf{b} \\, = \\, - (1 - \\zeta) \\left( \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\right),\n$$\n因此\n$$\n\\rho \\, = \\, \\| \\mathbf{r}' - \\mathbf{r} \\| \\, = \\, (1 - \\zeta) \\, \\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\|.\n$$\n在一个排除了三角形边附近薄层（这可以通过标准的单位分解和局部边图来处理）的紧致邻域中，$\\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\|$ 由固定的正常数作为上下界，所以\n$$\n\\rho \\asymp (1 - \\zeta) \\quad \\text{uniformly in} \\quad (\\lambda_{1}, \\lambda_{2}) \\in \\widehat{\\Delta}_{\\mathrm{int}} \\subset \\widehat{\\Delta},\n$$\n因此\n$$\n\\ln \\rho \\, = \\, \\ln(1 - \\zeta) \\, + \\, \\ln \\| \\lambda_{1} \\mathbf{a} + \\lambda_{2} \\mathbf{b} \\| .\n$$\n第二项在 $(\\lambda_{1}, \\lambda_{2})$ 上是光滑的，因此唯一的非光滑依赖是新变量 $\\zeta$ 中的因子 $\\ln(1 - \\zeta)$。\n\n测度变换。在此映射下，曲面测度积通过类余面积恒等式进行变换（这可由重心坐标中微分的多重线性代数和仿射参数化得出）\n$$\n\\mathrm{d}S_{\\mathbf{r}} \\, \\mathrm{d}S_{\\mathbf{r}'} \\, = \\, |\\mathbf{a} \\times \\mathbf{b}|^{2} \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\mu_{1} \\, \\mathrm{d}\\mu_{2} \\, = \\, C_{\\Delta} \\, \\zeta^{2} \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta,\n$$\n其中 $C_{\\Delta}  0$ 是一个仅取决于 $\\mathbf{a}$ 和 $\\mathbf{b}$ 的常数，因子 $\\zeta^{2}$ 源于二维缩放 $\\boldsymbol{\\mu} = \\zeta \\boldsymbol{\\lambda}$（$(\\mu_{1}, \\mu_{2})$ 中的微分 2-形式是 $(\\lambda_{1}, \\lambda_{2})$ 中相应形式的 $\\zeta^{2}$ 倍，不计及由余面积因子解释的含 $\\mathrm{d}\\zeta$ 的项；例如，参见在重合单纯形上 Duffy 方法的标准推导）。因此，在局部化并将光滑、严格为正的因子吸收到光滑被积函数中之后，奇异贡献简化为三重积分\n$$\n\\int_{0}^{1} \\int_{\\widehat{\\Delta}} \\zeta^{2} \\, \\ln(1 - \\zeta) \\, G(\\lambda_{1}, \\lambda_{2}, \\zeta) \\, \\mathrm{d}\\lambda_{1} \\, \\mathrm{d}\\lambda_{2} \\, \\mathrm{d}\\zeta,\n$$\n其中 $G \\in C^{\\infty}(\\widehat{\\Delta} \\times [0,1])$ 在该紧致域上有正的上下界。\n\n求积设计与 $\\zeta$ 方向的误差。考虑一个张量积求积，其构成如下：\n- 在 $\\zeta \\in [0,1]$ 上使用一个 $n$ 点 Gauss–Legendre 法则，以及\n- 在 $\\widehat{\\Delta}$ 上使用一个 $n$ 阶对称三角形法则，它使用 $\\mathcal{O}(n^{2})$ 个求积点。\n\n因此，求积点的总数为\n$$\nP \\, = \\, C_{0} \\, n \\, \\times \\, C_{1} \\, n^{2} \\, = \\, C \\, n^{3} ,\n$$\n对于某些与 $n$ 无关的常数 $C_{0}, C_{1}, C  0$，所以 $n \\asymp P^{1/3}$。\n\n由于 $G$ 在所有变量中都是光滑的，唯一的非光滑因子是 $\\ln(1 - \\zeta)$ 乘以光滑权重 $\\zeta^{2}$。对于形如\n$$\n\\int_{0}^{1} \\ln(1 - \\zeta) \\, \\widetilde{g}(\\zeta) \\, \\mathrm{d}\\zeta,\n$$\n的积分，其中 $\\widetilde{g} \\in C^{\\infty}[0,1]$，Gauss–Legendre 求积对端点对数奇异性的标准误差估计（这是正交多项式求积的数值分析中一个经过充分检验的事实）表明，对于 $\\zeta$ 积分，存在一个代数衰减\n$$\nE_{\\zeta}(n) \\, = \\, \\mathcal{O}\\!\\left( n^{-2} \\right)\n$$\n。在三角形上的光滑 $(\\lambda_{1}, \\lambda_{2})$ 积分相对于三角形法则的阶产生超代数（或至少是高阶代数）收敛，因此不主导整体收敛率。因此，张量积求积的整体误差由 $\\zeta$ 方向决定，并满足\n$$\nE(n) \\, = \\, \\mathcal{O}\\!\\left( n^{-2} \\right) .\n$$\n\n将误差用总点数 $P \\asymp n^{3}$ 表示，我们得到\n$$\nE(P) \\, = \\, \\mathcal{O}\\!\\left( \\left( P^{1/3} \\right)^{-2} \\right) \\, = \\, \\mathcal{O}\\!\\left( P^{-2/3} \\right) .\n$$\n因此，所求的代数衰减指数是\n$$\n\\alpha \\, = \\, \\frac{2}{3} .\n$$\n\n这一结论在包含其他五个近对角子域（由重心坐标分量序的其他排列产生）的情况下是稳健的，因为每个子域都贡献了相同的 $\\zeta$ 端点对数和相同的 $\\zeta^{2}$ 雅可比因子，并且在局部化后，所有常数在紧致域上都一致地有界于零和无穷大之间。核的光滑余项和非重合单元对产生光滑积分，其求积误差的衰减速度至少与此处分析的主要近对角贡献一样快。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3316164"}]}