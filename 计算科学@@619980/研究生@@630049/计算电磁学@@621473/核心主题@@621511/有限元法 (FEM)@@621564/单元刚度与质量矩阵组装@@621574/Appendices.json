{"hands_on_practices": [{"introduction": "我们动手实践的第一步是掌握有限元方法 (FEM) 的基本构件：单元矩阵。这个练习将引导您完成将物理单元上的积分变换到标准参考单元上，并使用数值积分计算单元刚度矩阵 $K_e$ 和质量矩阵 $M_e$ 的全过程。通过比较不同阶数高斯积分法则的结果，您将亲身体会到数值积分精度对计算结果的直接影响，这是确保有限元计算准确性的关键一环 [@problem_id:3305143]。", "problem": "考虑通过有限元法（FEM）离散的二维时谐横电（TE）标量亥姆霍兹公式，其作用于一个等参双线性四边形（$p=1$, $Q_{1}$）单元上，该单元在物理空间中是一个边长为 $a$ 和 $b$（单位：米）的轴对齐矩形。介质是均匀且各向同性的，具有恒定的介电常数 $\\varepsilon$ 和磁导率 $\\mu$，角频率为 $\\omega$。设参考单元为方形区域 $[-1,1] \\times [-1,1]$，其标准双线性形函数为 $N_{i}(\\xi,\\eta)$，$i=1,\\dots,4$，并且到物理单元的仿射映射的雅可比行列式为 $\\det J = ab/4$。\n\n在此 TE 标量设置中，局部单元刚度矩阵和质量矩阵定义如下\n$$\n(K_{e})_{ij} \\;=\\; \\int_{\\Omega_{e}} \\frac{1}{\\mu} \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega, \n\\qquad\n(M_{e})_{ij} \\;=\\; \\int_{\\Omega_{e}} \\omega^{2} \\varepsilon \\, N_{i} N_{j} \\, \\mathrm{d}\\Omega.\n$$\n\n任务：\n1. 从上述弱形式定义和等参映射出发，将 $K_{e}$ 和 $M_{e}$ 表示为 $[-1,1]^{2}$ 上的参考积分，并使用 $2 \\times 2$ 高斯-勒让德法则（每个方向上的节点为 $\\pm 1/\\sqrt{3}$，单位权重）进行精确计算。给出用 $a$、$b$、$\\mu$、$\\varepsilon$ 和 $\\omega$ 表示的精确单元矩阵。\n\n2. 使用 $1 \\times 1$ 高斯法则（在 $[-1,1]^{2}$ 上，单个节点位于 $(0,0)$，权重为 $4$），计算相应的求积近似值 $K_{e}^{(1\\times 1)}$ 和 $M_{e}^{(1\\times 1)}$。\n\n3. 对于 $K_{e}$ 和 $M_{e}$，使用相对弗罗贝尼乌斯范数误差来量化由 $1 \\times 1$ 法则引起的求积误差\n$$\nE_{K} \\;=\\; \\frac{\\|\\,K_{e}^{(1\\times 1)} - K_{e}\\,\\|_{F}}{\\|\\,K_{e}\\,\\|_{F}},\n\\qquad\nE_{M} \\;=\\; \\frac{\\|\\,M_{e}^{(1\\times 1)} - M_{e}\\,\\|_{F}}{\\|\\,M_{e}\\,\\|_{F}}.\n$$\n\n在 $a = 0.3$、$b = 0.2$ 的情况下计算这些误差。将最终答案表示为行向量 $(E_{K}, E_{M})$，并四舍五入到四位有效数字。以无量纲数报告最终答案。", "solution": "首先对问题进行验证。\n\n### 步骤1：提取已知条件\n- **公式**：二维时谐横电（TE）标量亥姆霍兹方程。\n- **方法**：有限元法（FEM）。\n- **单元**：单个等参双线性四边形（$p=1$, $Q_1$）单元。\n- **物理域**：边长为 $a$ 和 $b$（单位：米）的轴对齐矩形 $\\Omega_e$。\n- **参考域**：坐标系 $(\\xi, \\eta)$ 中的方形区域 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$。\n- **映射**：从参考单元到物理单元的仿射映射，其雅可比行列式为 $\\det J = ab/4$。\n- **材料属性**：均匀且各向同性的介质，具有恒定的介电常数 $\\varepsilon$ 和磁导率 $\\mu$。\n- **频率**：角频率 $\\omega$。\n- **形函数**：标准双线性形函数 $N_{i}(\\xi,\\eta)$，其中 $i=1, \\dots, 4$。\n- **单元矩阵定义**：\n  - 刚度矩阵：$(K_{e})_{ij} = \\int_{\\Omega_{e}} \\frac{1}{\\mu} \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$\n  - 质量矩阵：$(M_{e})_{ij} = \\int_{\\Omega_{e}} \\omega^{2} \\varepsilon \\, N_{i} N_{j} \\, \\mathrm{d}\\Omega$\n- **任务1求积**：使用 $2 \\times 2$ 高斯-勒让德求积法进行精确计算。\n- **任务2求积**：使用 $1 \\times 1$ 高斯求积法进行近似计算。\n- **任务3误差度量**：相对弗罗贝尼乌斯范数误差，$E_X = \\|\\,X_{e}^{(1\\times 1)} - X_{e}\\,\\|_{F}/\\|\\,X_{e}\\,\\|_{F}$，其中 $X \\in \\{K, M\\}$。\n- **任务3参数**：$a = 0.3$，$b = 0.2$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是有限元法在亥姆霍兹方程上的标准应用，而亥姆霍兹方程是计算电磁学的基石。刚度矩阵和质量矩阵的定义对于 TE 标量公式是正确的。等参映射是标准的。对于从一个 $2 \\times 2$ 正方形到一个 $a \\times b$ 矩形的仿射映射，指定的雅可比行列式是正确的。在参考单元上，刚度矩阵和质量矩阵的被积函数是关于每个变量（$\\xi$ 和 $\\eta$）次数最多为 2 的多项式。一个 $2 \\times 2$ 高斯-勒让德求积法则能够精确地积分每个变量次数最高为 $2 \\times 2 - 1 = 3$ 的多项式。因此，该法则提供精确计算的说法是正确的。该问题是适定的、客观的、自洽的，并且所有数据在物理上和数学上都是一致的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n求解过程首先将积分从物理单元 $\\Omega_e$ 变换到参考单元 $\\hat{\\Omega}$，然后计算这些积分以求得矩阵，最后计算指定的误差。\n\n**1. 等参映射与积分变换**\n设物理坐标为 $(x,y)$，参考坐标为 $(\\xi,\\eta)$。对于一个角点位于原点的轴对齐矩形，其仿射映射为 $x = \\frac{a}{2}(1+\\xi)$ 和 $y = \\frac{b}{2}(1+\\eta)$。此变换的雅可比矩阵为\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2}  0 \\\\ 0  \\frac{b}{2} \\end{pmatrix}\n$$\n其行列式为 $\\det(J) = \\frac{ab}{4}$，逆雅可比矩阵为 $J^{-1} = \\begin{pmatrix} 2/a  0 \\\\ 0  2/b \\end{pmatrix}$。\n物理坐标系中的梯度算子变换如下：\n$$\n\\nabla_{(x,y)} = \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = (J^{-1})^T \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{a} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{2}{b} \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\n微分面积元变换为 $\\mathrm{d}\\Omega = \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta = \\frac{ab}{4} \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$。\n\n双线性形函数为：\n$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$。\n\n**任务1：精确单元矩阵（$K_e$, $M_e$）**\n\n质量矩阵积分变换到参考单元上：\n$$\n(M_e)_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\omega^2 \\varepsilon N_i N_j \\left(\\frac{ab}{4}\\right) \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{\\omega^2 \\varepsilon ab}{4} \\int_{-1}^{1} \\int_{-1}^{1} N_i N_j \\, \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n令 $M_{ij}^{\\text{ref}} = \\int_{-1}^{1} \\int_{-1}^{1} N_i N_j \\, \\mathrm{d}\\xi \\mathrm{d}\\eta$。精确积分（或等效的 $2 \\times 2$ 高斯法则）得到众所周知的参考质量矩阵：\n$$\nM^{\\text{ref}} = \\frac{1}{9} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix}\n$$\n因此，精确的单元质量矩阵为：\n$$\nM_e = \\frac{\\omega^2 \\varepsilon ab}{36} \\begin{pmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{pmatrix}\n$$\n\n刚度矩阵积分变换为：\n$$\n(K_e)_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{\\mu} (\\nabla_{(x,y)} N_i \\cdot \\nabla_{(x,y)} N_j) \\left(\\frac{ab}{4}\\right) \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n点积为 $\\nabla N_i \\cdot \\nabla N_j = \\frac{4}{a^2} \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} + \\frac{4}{b^2} \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta}$。\n$$\n(K_e)_{ij} = \\frac{ab}{4\\mu} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{4}{a^2} \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} + \\frac{4}{b^2} \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta} \\right) \\mathrm{d}\\xi \\mathrm{d}\\eta = \\frac{b}{a\\mu} K_{ij}^\\xi + \\frac{a}{b\\mu} K_{ij}^\\eta\n$$\n其中 $K_{ij}^\\xi = \\int_{-1}^1 \\int_{-1}^1 \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial N_j}{\\partial \\xi} \\mathrm{d}\\xi \\mathrm{d}\\eta$ 且 $K_{ij}^\\eta = \\int_{-1}^1 \\int_{-1}^1 \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial N_j}{\\partial \\eta} \\mathrm{d}\\xi \\mathrm{d}\\eta$。\n精确积分给出标准参考矩阵：\n$$\nK^{\\xi} = \\frac{1}{6} \\begin{pmatrix} 2  -2  -1  1 \\\\ -2  2  1  -1 \\\\ -1  1  2  -2 \\\\ 1  -1  -2  2 \\end{pmatrix}, \\quad K^{\\eta} = \\frac{1}{6} \\begin{pmatrix} 2  1  -1  -2 \\\\ 1  2  -2  -1 \\\\ -1  -2  2  1 \\\\ -2  -1  1  2 \\end{pmatrix}\n$$\n综合这些，精确的单元刚度矩阵为：\n$$\nK_e = \\frac{1}{6\\mu} \\left[ \\frac{b}{a} \\begin{pmatrix} 2  -2  -1  1 \\\\ -2  2  1  -1 \\\\ -1  1  2  -2 \\\\ 1  -1  -2  2 \\end{pmatrix} + \\frac{a}{b} \\begin{pmatrix} 2  1  -1  -2 \\\\ 1  2  -2  -1 \\\\ -1  -2  2  1 \\\\ -2  -1  1  2 \\end{pmatrix} \\right]\n$$\n\n**任务2：使用 $1 \\times 1$ 高斯法则计算近似矩阵（$K_e^{(1\\times 1)}$, $M_e^{(1\\times 1)}$）**\n\n在 $\\hat{\\Omega}$ 上的 $1 \\times 1$ 高斯法则将积分近似为 $\\int_{-1}^1 \\int_{-1}^1 f(\\xi,\\eta) \\mathrm{d}\\xi\\mathrm{d}\\eta \\approx 4 f(0,0)$。\n在 $(\\xi,\\eta)=(0,0)$ 处，对所有 $i=1,\\dots,4$ 都有 $N_i(0,0) = 1/4$。\n参考质量矩阵的被积函数变为 $N_i(0,0)N_j(0,0) = 1/16$。\n$$\n(M_{e}^{(1\\times 1)})_{ij} = \\frac{\\omega^2 \\varepsilon ab}{4} \\left( 4 \\times N_i(0,0)N_j(0,0) \\right) = \\frac{\\omega^2 \\varepsilon ab}{4} \\left( 4 \\times \\frac{1}{16} \\right) = \\frac{\\omega^2 \\varepsilon ab}{16}\n$$\n这导致一个常数矩阵：\n$$\nM_e^{(1\\times 1)} = \\frac{\\omega^2 \\varepsilon ab}{16} \\begin{pmatrix} 1  1  1  1 \\\\ 1  1  1  1 \\\\ 1  1  1  1 \\\\ 1  1  1  1 \\end{pmatrix}\n$$\n对于刚度矩阵，我们计算在 $(0,0)$ 处的形函数导数：\n$\\frac{\\partial N_1}{\\partial\\xi}=-\\frac{1}{4}, \\frac{\\partial N_2}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_3}{\\partial\\xi}=\\frac{1}{4}, \\frac{\\partial N_4}{\\partial\\xi}=-\\frac{1}{4}$\n$\\frac{\\partial N_1}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_2}{\\partial\\eta}=-\\frac{1}{4}, \\frac{\\partial N_3}{\\partial\\eta}=\\frac{1}{4}, \\frac{\\partial N_4}{\\partial\\eta}=\\frac{1}{4}$\n用 $1 \\times 1$ 法则近似 $K^\\xi$ 和 $K^\\eta$：\n$(K^{\\xi, (1\\times 1)})_{ij} = 4 \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\frac{\\partial N_j}{\\partial \\xi}(0,0)$。这给出：\n$$\nK^{\\xi, (1\\times 1)} = \\frac{4}{16} \\begin{pmatrix} -1 \\\\ 1 \\\\ 1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} -1  1  1  -1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1  -1  -1  1 \\\\ -1  1  1  -1 \\\\ -1  1  1  -1 \\\\ 1  -1  -1  1 \\end{pmatrix}\n$$\n类似地，\n$$\nK^{\\eta, (1\\times 1)} = \\frac{4}{16} \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} -1  -1  1  1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1  1  -1  -1 \\\\ 1  1  -1  -1 \\\\ -1  -1  1  1 \\\\ -1  -1  1  1 \\end{pmatrix}\n$$\n近似刚度矩阵为 $K_e^{(1\\times 1)} = \\frac{b}{a\\mu}K^{\\xi, (1\\times 1)} + \\frac{a}{b\\mu}K^{\\eta, (1\\times 1)}$，即：\n$$\nK_e^{(1\\times 1)} = \\frac{1}{4\\mu} \\left[ \\frac{b}{a} \\begin{pmatrix} 1  -1  -1  1 \\\\ -1  1  1  -1 \\\\ -1  1  1  -1 \\\\ 1  -1  -1  1 \\end{pmatrix} + \\frac{a}{b} \\begin{pmatrix} 1  1  -1  -1 \\\\ 1  1  -1  -1 \\\\ -1  -1  1  1 \\\\ -1  -1  1  1 \\end{pmatrix} \\right]\n$$\n\n**任务3：求积误差评估**\n\n相对弗罗贝尼乌斯范数误差为 $E_X = \\frac{\\|X_e^{(1\\times 1)} - X_e\\|_F}{\\|X_e\\|_F}$。注意，公共标量因子会抵消。\n\n对于质量矩阵，$E_M = \\frac{\\|\\frac{\\omega^2 \\varepsilon ab}{16} J_4 - \\frac{\\omega^2 \\varepsilon ab}{4} M^{\\text{ref}}\\|_F}{\\|\\frac{\\omega^2 \\varepsilon ab}{4} M^{\\text{ref}}\\|_F} = \\frac{\\|\\frac{1}{4} J_4 - M^{\\text{ref}}\\|_F}{\\|M^{\\text{ref}}\\|_F}$，其中 $J_4$ 是全为1的 $4 \\times 4$ 矩阵。\n令 $\\Delta M = \\frac{1}{4} J_4 - M^{\\text{ref}} = \\frac{1}{36} \\left( 9 J_4 - 4 \\begin{pmatrix} 4  2  1  2 \\\\ \\dots \\end{pmatrix} \\right) = \\frac{1}{36} \\begin{pmatrix} -7  1  5  1 \\\\ 1  -7  1  5 \\\\ 5  1  -7  1 \\\\ 1  5  1  -7 \\end{pmatrix}$。\n$\\|\\Delta M\\|_F^2 = (\\frac{1}{36})^2 \\left( 4 \\times ((-7)^2 + 1^2 + 5^2 + 1^2) \\right) = (\\frac{1}{36})^2 (4 \\times 76) = \\frac{304}{1296}$。\n$\\|M^{\\text{ref}}\\|_F^2 = (\\frac{1}{9})^2 \\left( 4 \\times (4^2+2^2+1^2+2^2) \\right) = (\\frac{1}{81}) (4 \\times 25) = \\frac{100}{81}$。\n$E_M^2 = \\frac{304/1296}{100/81} = \\frac{304}{1296} \\frac{81}{100} = \\frac{304}{16 \\times 100} = \\frac{19}{100} = 0.19$。\n$E_M = \\sqrt{0.19} \\approx 0.435889...$\n此误差与 $a$ 和 $b$ 无关。\n\n对于刚度矩阵，我们令 $\\alpha = a/b$ 和 $\\beta = b/a$。因子 $1/\\mu$ 抵消。\n令 $K'_e = 6\\mu K_e = \\beta(6K^\\xi) + \\alpha(6K^\\eta)$ 和 $K'^{(1\\times 1)}_e = 4\\mu K_e^{(1\\times 1)} = \\beta(4K^{\\xi,(1\\times 1)}) + \\alpha(4K^{\\eta,(1\\times 1)})$。缩放比例不同。我们使用 $K_e' = \\mu K_e$ 和 $K_e'^{(1\\times 1)} = \\mu K_e^{(1\\times 1)}$。\n$\\Delta K' = K_e'^{(1\\times 1)} - K_e' = \\beta(K^{\\xi,(1\\times 1)}-K^\\xi) + \\alpha(K^{\\eta,(1\\times 1)}-K^\\eta)$。\n$K^{\\xi,(1\\times 1)}-K^\\xi = \\frac{1}{4} \\begin{pmatrix} 1  \\dots \\end{pmatrix} - \\frac{1}{6} \\begin{pmatrix} 2  \\dots \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} -1  1  -1  1 \\\\ 1  -1  1  -1 \\\\ -1  1  -1  1 \\\\ 1  -1  1  -1 \\end{pmatrix} = \\frac{1}{12}U$。\n可以证明 $K^{\\eta,(1\\times 1)}-K^\\eta = \\frac{1}{12}U$ 也成立。\n所以，$\\Delta K' = \\beta(\\frac{1}{12}U) + \\alpha(\\frac{1}{12}U) = \\frac{\\alpha+\\beta}{12}U$。\n$\\|\\Delta K'\\|_F^2 = \\left(\\frac{\\alpha+\\beta}{12}\\right)^2 \\|U\\|_F^2 = \\left(\\frac{\\alpha+\\beta}{12}\\right)^2 \\times 16 = \\frac{(\\alpha+\\beta)^2}{9}$。\n分母为 $\\|K'_e\\|_F^2 = \\|\\beta K^\\xi + \\alpha K^\\eta\\|_F^2 = \\beta^2\\|K^\\xi\\|_F^2 + \\alpha^2\\|K^\\eta\\|_F^2 + 2\\alpha\\beta \\langle K^\\xi, K^\\eta \\rangle_F$。\n$\\|K^\\xi\\|_F^2_F = \\|K^\\eta\\|_F^2 = (\\frac{1}{6})^2(40) = \\frac{40}{36} = \\frac{10}{9}$。\n$\\langle K^\\xi, K^\\eta \\rangle_F = (\\frac{1}{6})^2 \\sum (6K^\\xi)_{ij}(6K^\\eta)_{ij} = \\frac{1}{36}(4) = \\frac{1}{9}$。\n$\\|K'_e\\|_F^2 = \\beta^2(\\frac{10}{9}) + \\alpha^2(\\frac{10}{9}) + 2\\alpha\\beta(\\frac{1}{9}) = \\frac{2}{9}(5\\alpha^2+5\\beta^2+\\alpha\\beta)$。\n$E_K^2 = \\frac{\\|\\Delta K'\\|_F^2}{\\|K'_e\\|_F^2} = \\frac{(\\alpha+\\beta)^2/9}{ \\frac{2}{9}(5\\alpha^2+5\\beta^2+\\alpha\\beta) } = \\frac{(\\alpha+\\beta)^2}{2(5\\alpha^2+5\\beta^2+\\alpha\\beta)}$。\n\n现在，我们代入 $a=0.3$ 和 $b=0.2$。\n$\\alpha = a/b = 1.5 = 3/2$。 $\\beta = b/a = 2/3$。\n$\\alpha\\beta = 1$。 $\\alpha+\\beta = 3/2 + 2/3 = 13/6$。 $\\alpha^2 = 9/4$。 $\\beta^2=4/9$。\n$E_K^2 = \\frac{(13/6)^2}{2(5(9/4) + 5(4/9) + 1)} = \\frac{169/36}{2(45/4 + 20/9 + 1)} = \\frac{169/36}{2((405+80+36)/36)} = \\frac{169}{2(521)} = \\frac{169}{1042}$。\n$E_K = \\sqrt{169/1042} = 13/\\sqrt{1042} \\approx 0.402720...$\n\n最终误差，四舍五入到四位有效数字，为：\n$E_K \\approx 0.4027$\n$E_M \\approx 0.4359$\n\n最终答案是行向量 $(E_K, E_M)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.4027  0.4359 \\end{pmatrix}\n}\n$$", "id": "3305143"}, {"introduction": "在掌握了单个单元矩阵的计算之后，下一步自然是学习如何将它们组装成一个完整的全局系统。这个练习将指导您为一个一维亥姆霍兹特征值问题构建全局刚度矩阵 $K$ 和质量矩阵 $M$，并学习如何施加狄利克雷边界条件。通过计算系统矩阵 $M^{-1}K$ 的条件数并观察其随网格加密的变化趋势，您将深入理解离散化如何影响最终线性系统的数值属性，这对于求解大规模问题至关重要 [@problem_id:3305124]。", "problem": "考虑在理想导电空腔中，横电模的麦克斯韦方程组的一维时谐简化形式，在区间域 $[0,1]$ 上，施加齐次狄利克雷边界条件（$E(0)=0$ 和 $E(1)=0$），该问题可以表示为如下弱形式的标量特征值问题：求 $u \\neq 0$ 且 $u \\in H_0^1(0,1)$，使得\n$$\\int_{0}^{1} \\frac{d u}{d x} \\frac{d v}{d x} \\, dx = \\lambda \\int_{0}^{1} u \\, v \\, dx \\quad \\text{对于所有 } v \\in H_0^1(0,1),$$\n其中 $\\lambda$ 是一个非负特征值。使用有限元法（FEM），通过协调的分片多项式基函数进行离散化，可以得到一个对称正定刚度矩阵 $K$ 和一个对称正定质量矩阵 $M$，因此离散广义特征值问题可写为\n$$K \\, \\mathbf{u} = \\lambda \\, M \\, \\mathbf{u},$$\n其中 $\\mathbf{u}$ 是离散场的系数向量。由 $M$-内积诱导的算子 $M^{-1}K$ 的条件数（CN）等于矩阵对 $(K,M)$ 的最大广义特征值 $\\lambda$ 与最小广义特征值之比：\n$$\\kappa(M^{-1}K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}.$$\n您的任务是：对于 $[0,1]$ 上的一族均匀细化的网格，使用固定的多项式阶数 $p=1$ 的标准、连续、分片线性拉格朗日基函数，组装全局单元刚度矩阵和质量矩阵，施加齐次狄利克雷边界条件，并为每个网格计算 $\\kappa(M^{-1}K)$ 的数值。\n\n您必须从上述弱形式出发，并采用以下基本建模和离散化步骤，不可引入任何跳过这些步骤的简化公式：\n- 在 $[0,1]$ 上定义一个包含 $N$ 个单元的均匀网格，节点位于 $x_i = i h$（$i = 0,1,\\dots,N$），其中 $h = 1/N$。\n- 在每个单元上，使用张成局部逼近空间的两个局部、连续、分片线性的拉格朗日基函数，并将它们映射到物理单元上。\n- 通过计算每个单元上基函数及其导数乘积的积分，精确计算局部单元刚度和质量的贡献。\n- 根据网格拓扑，将这些局部贡献组装成全局刚度矩阵 $K$ 和质量矩阵 $M$。\n- 通过移除与边界节点 $x=0$ 和 $x=1$ 相关的自由度（DOF）来施加齐次狄利克雷边界条件，得到大小为 $(N-1) \\times (N-1)$ 的缩减矩阵。\n- 计算缩减系统矩阵对 $(K,M)$ 的广义特征值，然后计算最大与最小特征值之比，即 $\\kappa(M^{-1}K)$。\n\n科学真实性要求：模型是无量纲的，所有量均在单位区间 $[0,1]$ 上以一致的无量纲单位进行计算。\n\n设计一个程序，执行上述步骤，并为以下均匀网格测试套件计算 $\\kappa(M^{-1}K)$：\n- 正常情况：$N = 16$， $N = 32$。\n- 类似边界的最小内部自由度情况：$N = 2$。\n- 中等程度的细化：$N = 4$，$N = 8$。\n- 用于细化趋势分析的重要边缘情况：$N = 64$，$N = 128$。\n\n您的程序应生成单行输出，其中包含这些网格的条件数，按 $[N=2,N=4,N=8,N=16,N=32,N=64,N=128]$ 的顺序列出，形式为方括号内以逗号分隔的列表（例如 $[a_1,a_2,\\dots,a_7]$），其中每个 $a_i$ 是一个浮点数，代表对应 $N$ 的 $\\kappa(M^{-1}K)$ 值。", "solution": "该问题要求计算一维特征值问题有限元离散化的条件数 $\\kappa(M^{-1}K)$。分析过程遵循指定的有限元法（FEM）步骤。\n\n该特征值问题的弱形式是：寻找一个非平凡函数 $u \\in H_0^1(0,1)$ 和一个对应的特征值 $\\lambda \\ge 0$，使得：\n$$ \\int_{0}^{1} \\frac{d u}{d x} \\frac{d v}{d x} \\, dx = \\lambda \\int_{0}^{1} u \\, v \\, dx $$\n对于所有测试函数 $v \\in H_0^1(0,1)$ 均成立。空间 $H_0^1(0,1)$ 由在区间 $[0,1]$ 上一阶导数平方可积且在边界 $x=0$ 和 $x=1$ 处为零的函数组成。\n\n这个问题的离散形式是广义矩阵特征值问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其中 $K$ 是刚度矩阵，$M$ 是质量矩阵。条件数定义为最大特征值与最小特征值之比，即 $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$。\n\n**1. 离散化与基函数**\n域 $[0,1]$ 被离散化为包含 $N$ 个单元的均匀网格，每个单元的长度为 $h = 1/N$。节点位于 $x_i = i h$（$i \\in \\{0, 1, \\dots, N\\}$）。我们使用连续的分片线性（$p=1$）拉格朗日基函数。在参考单元 $\\hat{I} = [0, 1]$ 上，两个局部基函数为：\n$$ \\hat{\\phi}_1(\\hat{x}) = 1 - \\hat{x} $$\n$$ \\hat{\\phi}_2(\\hat{x}) = \\hat{x} $$\n它们关于参考坐标 $\\hat{x}$ 的导数为：\n$$ \\frac{d\\hat{\\phi}_1}{d\\hat{x}} = -1 \\quad \\text{和} \\quad \\frac{d\\hat{\\phi}_2}{d\\hat{x}} = 1 $$\n\n**2. 单元矩阵**\n一个仿射映射将参考单元坐标 $\\hat{x} \\in [0,1]$ 变换到长度为 $h$ 的单元 $I_e = [x_{i-1}, x_i]$ 中的物理坐标 $x$：\n$$ x(\\hat{x}) = x_{i-1} + h\\hat{x} $$\n积分的变量替换为 $dx = h \\, d\\hat{x}$，导数的链式法则给出 $\\frac{d\\phi}{dx} = \\frac{d\\hat{\\phi}}{d\\hat{x}}\\frac{d\\hat{x}}{dx} = \\frac{1}{h}\\frac{d\\hat{\\phi}}{d\\hat{x}}$。\n\n局部的 $2 \\times 2$ 单元刚度矩阵 $K^e$ 的项由下式给出：\n$$ K^e_{ij} = \\int_{I_e} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} \\, dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\hat{x}}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\hat{x}}\\right) h \\, d\\hat{x} = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\hat{x}}\\frac{d\\hat{\\phi}_j}{d\\hat{x}} \\, d\\hat{x} $$\n对 $i,j \\in \\{1,2\\}$ 计算此积分可得：\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n局部的 $2 \\times 2$ 单元质量矩阵 $M^e$ 的项由下式给出：\n$$ M^e_{ij} = \\int_{I_e} \\phi_i \\phi_j \\, dx = \\int_{0}^{1} \\hat{\\phi}_i(\\hat{x}) \\hat{\\phi}_j(\\hat{x}) h \\, d\\hat{x} = h \\int_{0}^{1} \\hat{\\phi}_i(\\hat{x})\\hat{\\phi}_j(\\hat{x}) \\, d\\hat{x} $$\n计算此积分可得：\n$$ M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n\n**3. 全局组装**\n全局刚度矩阵 $K$ 和质量矩阵 $M$ 的大小为 $(N+1) \\times (N+1)$，对应于网格中的 $N+1$ 个节点。它们是通过将 $N$ 个局部单元矩阵的贡献相加来组装的。对于连接节点 $i-1$ 和 $i$ 的单元，其局部矩阵的项被加到全局矩阵的相应位置。此过程（在施加边界条件之前）会产生以下对称三对角全局矩阵：\n$$ K = \\frac{1}{h} \\begin{pmatrix} 1  -1    \\\\ -1  2  -1   \\\\  \\ddots  \\ddots  \\ddots  \\\\   -1  2  -1 \\\\    -1  1 \\end{pmatrix}, \\quad M = \\frac{h}{6} \\begin{pmatrix} 2  1    \\\\ 1  4  1   \\\\  \\ddots  \\ddots  \\ddots  \\\\   1  4  1 \\\\    1  2 \\end{pmatrix} $$\n\n**4. 边界条件施加**\n齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$ 意味着与边界节点（节点 $0$ 和节点 $N$）相关的解系数为零。通过从全局矩阵中移除第一行（索引为 $0$）和最后一行（索引为 $N$）以及第一列和最后一列，可以从系统中消除这些自由度。这样就得到了缩减后的刚度矩阵 $K_{red}$ 和质量矩阵 $M_{red}$，两者的大小均为 $(N-1) \\times (N-1)$，对应于内部节点 $1, 2, \\dots, N-1$。\n$$ K_{red} = \\frac{1}{h} \\begin{pmatrix} 2  -1   \\\\ -1  2  -1  \\\\  \\ddots  \\ddots  \\ddots \\\\   -1  2  -1 \\\\    -1  2 \\end{pmatrix}_{(N-1) \\times (N-1)} $$\n$$ M_{red} = \\frac{h}{6} \\begin{pmatrix} 4  1   \\\\ 1  4  1  \\\\  \\ddots  \\ddots  \\ddots \\\\   1  4  1 \\\\    1  4 \\end{pmatrix}_{(N-1) \\times (N-1)} $$\n\n**5. 广义特征值问题与条件数**\n最后一步是求解缩减后的广义特征值问题 $K_{red}\\mathbf{u}_{int} = \\lambda M_{red}\\mathbf{u}_{int}$，以得到 $N-1$ 个特征值 $\\{\\lambda_j\\}$。这些特征值通过数值方法计算。然后，通过计算这些特征值中的最大值与最小值之比来得到条件数：\n$$ \\kappa(M^{-1}K) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} $$\n下面的算法为指定的 $N$ 值实现了这一过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Computes the condition number of the FEM operator M^-1 K for a 1D\n    eigenvalue problem on a series of uniformly refined meshes.\n    \"\"\"\n    # Define the test cases from the problem statement, ordered as required for output.\n    test_cases = [2, 4, 8, 16, 32, 64, 128]\n\n    results = []\n    for N in test_cases:\n        # Mesh parameter\n        h = 1.0 / N\n        \n        # Reduced system size (number of interior nodes)\n        # N elements, N+1 total nodes, N-1 interior nodes\n        size_reduced = N - 1\n\n        if size_reduced == 0:\n            # If N=1, there are no interior nodes, the problem is ill-defined.\n            # For N=2, size_reduced is 1, a valid 1x1 system.\n            # All test cases have N >= 2.\n            raise ValueError(\"Number of elements N must be >= 2 for interior DOFs.\")\n\n        # Step 1: Define local element stiffness and mass matrices.\n        # These are computed from the integrals of basis functions and their\n        # derivatives over a reference element.\n        K_local = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n        M_local = (h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n\n        # Step 2: Assemble global matrices.\n        # Global matrices are of size (N+1)x(N+1) corresponding to all nodes.\n        size_global = N + 1\n        K_global = np.zeros((size_global, size_global))\n        M_global = np.zeros((size_global, size_global))\n\n        # Loop over elements and add local contributions to global matrices.\n        for i in range(N):\n            # Element `i` connects nodes `i` and `i+1`.\n            # The local 2x2 matrix is added to the corresponding block \n            # of the global matrix.\n            K_global[i:i+2, i:i+2] += K_local\n            M_global[i:i+2, i:i+2] += M_local\n\n        # Step 3: Enforce homogeneous Dirichlet boundary conditions.\n        # This is done by removing the rows and columns corresponding to the\n        # boundary nodes (node 0 and node N). The reduced matrices correspond\n        # to the interior nodes (1, 2, ..., N-1).\n        K_reduced = K_global[1:N, 1:N]\n        M_reduced = M_global[1:N, 1:N]\n\n        # Step 4: Compute the generalized eigenvalues.\n        # eigh is used because the matrices are symmetric and positive-definite.\n        # It solves the problem A*x = lambda*B*x.\n        eigenvalues = eigh(K_reduced, M_reduced, eigvals_only=True)\n        \n        # Step 5: Compute the condition number.\n        # For a single eigenvalue (case N=2), max and min are the same.\n        lambda_min = np.min(eigenvalues)\n        lambda_max = np.max(eigenvalues)\n        \n        condition_number = lambda_max / lambda_min\n        results.append(condition_number)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3305124"}, {"introduction": "最后的实践练习将我们的关注点从静态系统转向动态行为，探索矩阵组装选择对时域仿真精度的具体影响。您将通过傅里叶分析方法，推导一维波动方程的离散色散关系，并编写程序来量化“一致质量矩阵”与“集总质量矩阵”所带来的数值相速度误差。这个练习深刻揭示了矩阵组装策略（例如质量集总）与仿真结果的物理保真度（如数值色散）之间的内在联系 [@problem_id:3305148]。", "problem": "考虑在间距为 $h$ 的均匀网格上，采用周期性边界条件和无量纲单位（其中波速 $c = 1$），对无损、无源的一维（$1$D）横电磁（TEM）麦克斯韦方程组进行简化。从法拉第定律和安培定律中消去磁场，可得到关于电场分量 $E(x,t)$ 的二阶波动方程，\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = c^2 \\frac{\\partial^2 E}{\\partial x^2}.\n$$\n在均匀网格上，使用伽辽金有限元法 (FEM) 和连续分段线性基函数，通过在整个网格上组装单元贡献得到的半离散系统为\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\n其中 $\\mathbf{u}(t)$ 是电场的节点值，$\\mathbf{M}$ 是单元组装的质量矩阵，$\\mathbf{K}$ 是单元组装的刚度矩阵。定义两种质量矩阵变体：\n- 一致质量矩阵 $\\mathbf{M}_{\\mathrm{c}}$，通过精确的单元积分获得。\n- 集中质量矩阵 $\\mathbf{M}_{\\mathrm{l}}$，通过对一致矩阵进行行和集中获得。\n\n使用步长均匀的 $\\Delta t$ 的显式中心差分格式进行时间推进，\n$$\n\\mathbf{M}\\,\\frac{\\mathbf{u}^{n+1} - 2\\,\\mathbf{u}^{n} + \\mathbf{u}^{n-1}}{\\Delta t^2} + \\mathbf{K}\\,\\mathbf{u}^{n} = \\mathbf{0},\n$$\n其中 $\\mathbf{u}^{n}$ 表示在时间层 $t^n = n\\,\\Delta t$ 上的节点向量。\n\n你的任务是：\n- 从上述基本定律和定义出发，推导在长度为 $h$ 的区间上的单个线性有限元的单元矩阵，以及在均匀周期性网格上组装后得到的 $\\mathbf{M}_{\\mathrm{c}}$、$\\mathbf{M}_{\\mathrm{l}}$ 和 $\\mathbf{K}$ 的三对角形式。\n- 在无限均匀网格上使用傅里叶（冯·诺依曼）分析，推导连接无量纲时间频率 $\\Omega$、无量纲空间相位增量 $\\theta = k\\,h$、时间步长 $\\Delta t$ 以及组装算子（针对 $\\mathbf{M}_{\\mathrm{c}}$ 和 $\\mathbf{M}_{\\mathrm{l}}$ 两种情况）的傅里叶符号的离散色散关系。\n- 将离散相速度定义为\n$$\nc_{\\mathrm{ph}}^{\\mathrm{num}}(\\theta,\\Delta t) = \\frac{(\\Omega/\\Delta t)}{(k)} = \\frac{h\\,\\Omega}{\\Delta t\\,\\theta},\n$$\n相对相速度误差定义为\n$$\ne(\\theta,\\Delta t) = \\left|\\,c_{\\mathrm{ph}}^{\\mathrm{num}}(\\theta,\\Delta t) - 1\\,\\right|.\n$$\n- 为确保在共同的稳定性限制下进行公平比较，选择时间步长为\n$$\n\\Delta t = \\alpha\\,\\frac{h}{c}\\,\\sqrt{\\frac{1}{3}},\n$$\n其中用户选择的类库朗数因子 $\\alpha \\in (0,1)$ 同样地应用于 $\\mathbf{M}_{\\mathrm{c}}$ 和 $\\mathbf{M}_{\\mathrm{l}}$ 两种情况。\n\n实现一个程序，该程序：\n- 对下面指定的每个测试用例，使用从组装的单元矩阵和显式格式推导出的色散关系，分别计算一致质量矩阵和集中质量矩阵的相对相速度误差 $e_{\\mathrm{c}}$ 和 $e_{\\mathrm{l}}$。\n- 将结果汇总为成对的列表 $[e_{\\mathrm{c}}, e_{\\mathrm{l}}]$（每个测试用例一对），并以 Python 风格的列表形式将其单行打印出来。\n\n使用以下测试套件，其中每个用例指定 $(h, \\theta, \\alpha)$：\n- 用例 1：$h = 0.1$, $\\theta = \\pi/16$, $\\alpha = 0.2$。\n- 用例 2：$h = 0.1$, $\\theta = \\pi/2$, $\\alpha = 0.9$。\n- 用例 3：$h = 0.1$, $\\theta = 7\\pi/8$, $\\alpha = 0.9$。\n- 用例 4：$h = 0.1$, $\\theta = \\pi$, $\\alpha = 0.99$。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表，顺序与上文相同，例如 $[[e_{\\mathrm{c},1}, e_{\\mathrm{l},1}],[e_{\\mathrm{c},2}, e_{\\mathrm{l},2}],\\dots]$。\n- 每个 $e_{\\mathrm{c}}$ 和 $e_{\\mathrm{l}}$ 都必须是浮点数。\n- 角度以弧度为单位，不使用物理单位（无量纲公式）。", "solution": "该问题被评估为有效，因为它科学地基于计算电磁学和数值分析的原理，其定义完整、一致且适定，并以客观、正式的语言表述。因此，我们可以进行推导和求解。\n\n主要目标是分析一维波动方程\n$$\n\\frac{\\partial^2 E}{\\partial t^2} = c^2 \\frac{\\partial^2 E}{\\partial x^2},\n$$\n（波速 $c=1$）的伽辽金有限元法 (FEM) 解的数值色散特性。该分析在使用显式中心差分时间积分格式时，比较了质量矩阵的两种变体：一致质量矩阵（$\\mathbf{M}_{\\mathrm{c}}$）和集中质量矩阵（$\\mathbf{M}_{\\mathrm{l}}$）。\n\n**1. 弱形式与单元矩阵的推导**\n\n伽辽金有限元法从控制方程的弱形式（或变分形式）开始。我们将波动方程乘以一个检验函数 $\\phi(x)$，并在空间域上进行积分。对空间导数项进行分部积分后，半离散弱形式为：寻找电场近似解 $E_h(x,t) = \\sum_j u_j(t) \\phi_j(x)$，使得对于每个基函数 $\\phi_i$，\n$$\n\\int \\phi_i \\frac{\\partial^2 E_h}{\\partial t^2} dx + \\int c^2 \\frac{\\partial \\phi_i}{\\partial x} \\frac{\\partial E_h}{\\partial x} dx = 0.\n$$\n代入 $E_h$ 的展开式并设 $c=1$，可得到矩阵系统 $\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}$，其中全局质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 的各项由单元级贡献组装而成：\n$$\nM_{ij} = \\int \\phi_i \\phi_j dx \\quad \\text{和} \\quad K_{ij} = \\int \\frac{\\partial \\phi_i}{\\partial x} \\frac{\\partial \\phi_j}{\\partial x} dx.\n$$\n我们考虑一个定义在局部区间 $[0, h]$ 上、长度为 $h$ 的单个有限元。该单元节点 1 和 2 的连续分段线性基函数（帽函数）为：\n$$\n\\phi_1(x) = 1 - \\frac{x}{h}, \\quad \\phi_2(x) = \\frac{x}{h} \\quad \\text{for } x \\in [0, h].\n$$\n它们的导数为 $\\frac{d\\phi_1}{dx} = -\\frac{1}{h}$ 和 $\\frac{d\\phi_2}{dx} = \\frac{1}{h}$。\n\n单元刚度矩阵 $\\mathbf{K}^{(e)}$ 计算如下：\n$$\nK_{ij}^{(e)} = \\int_0^h \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} dx \\implies \\mathbf{K}^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}.\n$$\n单元一致质量矩阵 $\\mathbf{M}_{\\mathrm{c}}^{(e)}$ 通过对基函数的乘积进行积分计算得出：\n$$\nM_{c,ij}^{(e)} = \\int_0^h \\phi_i(x) \\phi_j(x) dx \\implies \\mathbf{M}_{\\mathrm{c}}^{(e)} = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n\n**2. 组装算子与集中化**\n\n对于均匀周期性网格，全局矩阵是循环矩阵。这种矩阵对向量的作用可以通过一个应用于每个节点 $j$ 的重复模板来描述。该模板由共享节点 $j$ 的两个单元 $[x_{j-1}, x_j]$ 和 $[x_j, x_{j+1}]$ 的贡献组装而成。\n作用于节点 $j$ 处节点向量 $\\mathbf{u}$ 的刚度算子 $\\mathbf{K}$ 的模板为：\n$$\n(\\mathbf{K}\\mathbf{u})_j = \\frac{1}{h}(-u_{j-1} + 2u_j - u_{j+1}), \\quad \\text{模板: } \\frac{1}{h}[-1, 2, -1].\n$$\n一致质量算子 $\\mathbf{M}_{\\mathrm{c}}$ 的模板为：\n$$\n(\\mathbf{M}_{\\mathrm{c}}\\ddot{\\mathbf{u}})_j = \\frac{h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}), \\quad \\text{模板: } \\frac{h}{6}[1, 4, 1].\n$$\n集中质量矩阵 $\\mathbf{M}_{\\mathrm{l}}$ 是通过将 $\\mathbf{M}_{\\mathrm{c}}$ 的每行元素求和并将结果置于对角线上得到的。对于模板 $\\frac{h}{6}[1, 4, 1]$，行和为 $\\frac{h}{6}(1+4+1) = h$。这产生一个对角矩阵 $\\mathbf{M}_{\\mathrm{l}} = h\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。其算子作用很简单：\n$$\n(\\mathbf{M}_{\\mathrm{l}}\\ddot{\\mathbf{u}})_j = h\\ddot{u}_j.\n$$\n\n**3. 傅里叶分析与算子符号**\n\n我们通过将离散平面波解 $u_j^n = \\hat{u} e^{i(k x_j - \\Omega t^n)}$ 代入完全离散的中心差分格式来进行傅里叶分析：\n$$\n\\mathbf{M}\\,\\frac{\\mathbf{u}^{n+1} - 2\\,\\mathbf{u}^{n} + \\mathbf{u}^{n-1}}{\\Delta t^2} + \\mathbf{K}\\,\\mathbf{u}^{n} = \\mathbf{0}.\n$$\n令 $\\theta = kh$ 为每个单元的无量纲空间相位增量。一个基于模板的算子对该波的作用，会变为乘以其傅里叶符号。\n刚度算子的傅里叶符号 $\\hat{K}(\\theta)$ 为：\n$$\n\\hat{K}(\\theta) = \\frac{1}{h}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{1}{h}(2 - 2\\cos\\theta) = \\frac{4\\sin^2(\\theta/2)}{h}.\n$$\n一致质量算子的傅里叶符号 $\\hat{M}_{\\mathrm{c}}(\\theta)$ 为：\n$$\n\\hat{M}_{\\mathrm{c}}(\\theta) = \\frac{h}{6}(e^{-i\\theta} + 4 + e^{i\\theta}) = \\frac{h}{6}(4 + 2\\cos\\theta) = \\frac{h}{3}(2 + \\cos\\theta).\n$$\n集中质量算子的傅里叶符号很简单，即 $\\hat{M}_{\\mathrm{l}}(\\theta) = h$。\n时间差分算子变为：\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} \\rightarrow \\frac{e^{-i\\Omega} - 2 + e^{i\\Omega}}{\\Delta t^2} = \\frac{2(\\cos\\Omega - 1)}{\\Delta t^2} = -\\frac{4\\sin^2(\\Omega/2)}{\\Delta t^2}.\n$$\n\n**4. 离散色散关系的推导**\n\n将这些符号代入变换后的离散方程，得到：\n$$\n\\hat{M}(\\theta) \\left( -\\frac{4\\sin^2(\\Omega/2)}{\\Delta t^2} \\right) + \\hat{K}(\\theta) = 0 \\implies \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\frac{\\Delta t^2}{4} \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}.\n$$\n这给出了一般的色散关系：\n$$\n\\Omega = 2 \\arcsin\\left(\\frac{\\Delta t}{2} \\sqrt{\\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}}\\right).\n$$\n现在我们针对两种质量矩阵将此关系具体化。\n\n对于一致质量矩阵（$\\mathbf{M}_{\\mathrm{c}}$）：\n$$\n\\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\mathrm{c}}(\\theta)} = \\frac{4\\sin^2(\\theta/2)/h}{h/3(2+\\cos\\theta)} = \\frac{12\\sin^2(\\theta/2)}{h^2(2+\\cos\\theta)} = \\frac{12\\sin^2(\\theta/2)}{h^2(3-2\\sin^2(\\theta/2))}.\n$$\n对于集中质量矩阵（$\\mathbf{M}_{\\mathrm{l}}$）：\n$$\n\\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\mathrm{l}}(\\theta)} = \\frac{4\\sin^2(\\theta/2)/h}{h} = \\frac{4\\sin^2(\\theta/2)}{h^2}.\n$$\n将这些比率代入 $\\Omega$ 的方程，得到 $\\Omega_{\\mathrm{c}}$ 和 $\\Omega_{\\mathrm{l}}$ 的特定色散关系。\n\n**5. 数值相速度与误差**\n\n问题指定了时间步长 $\\Delta t = \\alpha \\frac{h}{c} \\sqrt{\\frac{1}{3}} = \\alpha h \\sqrt{1/3}$（因为 $c=1$）。\n数值相速度定义为 $c_{\\mathrm{ph}}^{\\mathrm{num}} = \\frac{\\Omega/\\Delta t}{k} = \\frac{h\\Omega}{\\theta\\Delta t}$。代入 $\\Delta t$ 的表达式：\n$$\nc_{\\mathrm{ph}}^{\\mathrm{num}} = \\frac{h\\Omega}{\\theta (\\alpha h \\sqrt{1/3})} = \\frac{\\sqrt{3}\\,\\Omega}{\\alpha\\,\\theta}.\n$$\n对于**一致质量矩阵**，将相应的比率代入 $\\Omega$ 的公式：\n$$\n\\Omega_{\\mathrm{c}} = 2 \\arcsin\\left( \\frac{\\alpha h \\sqrt{1/3}}{2} \\sqrt{\\frac{12\\sin^2(\\theta/2)}{h^2(3-2\\sin^2(\\theta/2))}} \\right) = 2 \\arcsin\\left( \\frac{\\alpha \\sin(\\theta/2)}{\\sqrt{3-2\\sin^2(\\theta/2)}} \\right).\n$$\n因此，相速度为：\n$$\nc_{\\mathrm{ph}, \\mathrm{c}}^{\\mathrm{num}} = \\frac{2\\sqrt{3}}{\\alpha\\,\\theta} \\arcsin\\left( \\frac{\\alpha \\sin(\\theta/2)}{\\sqrt{3-2\\sin^2(\\theta/2)}} \\right).\n$$\n对于**集中质量矩阵**，推导过程类似：\n$$\n\\Omega_{\\mathrm{l}} = 2 \\arcsin\\left( \\frac{\\alpha h \\sqrt{1/3}}{2} \\sqrt{\\frac{4\\sin^2(\\theta/2)}{h^2}} \\right) = 2 \\arcsin\\left( \\frac{\\alpha}{\\sqrt{3}} \\sin(\\theta/2) \\right).\n$$\n相速度为：\n$$\nc_{\\mathrm{ph}, \\mathrm{l}}^{\\mathrm{num}} = \\frac{2\\sqrt{3}}{\\alpha\\,\\theta} \\arcsin\\left( \\frac{\\alpha}{\\sqrt{3}} \\sin(\\theta/2) \\right).\n$$\n每种情况的相对相速度误差计算为 $e = |c_{\\mathrm{ph}}^{\\mathrm{num}} - 1|$。这些是在程序中实现的最终公式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative phase-velocity errors for a 1D FEM wave equation\n    simulation using consistent and lumped mass matrices.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (h, theta, alpha)\n    test_cases = [\n        (0.1, np.pi / 16.0, 0.2),\n        (0.1, np.pi / 2.0, 0.9),\n        (0.1, 7.0 * np.pi / 8.0, 0.9),\n        (0.1, np.pi, 0.99),\n    ]\n\n    results = []\n    for h, theta, alpha in test_cases:\n        # The mesh spacing 'h' is not needed in the final algebraic expressions\n        # for the normalized phase velocity, but is kept for contextual clarity.\n        \n        # Common terms\n        sin_theta_half = np.sin(theta / 2.0)\n        sqrt3 = np.sqrt(3.0)\n\n        # --- Consistent Mass Matrix Calculation ---\n        \n        # Argument of arcsin for the numerical frequency Omega_c\n        arg_c_arcsin = (alpha * sin_theta_half) / np.sqrt(3.0 - 2.0 * sin_theta_half**2)\n        \n        # The argument must be = 1 for a stable, non-dissipative scheme.\n        if arg_c_arcsin > 1.0:\n            arg_c_arcsin = 1.0 # Cap at stability limit for a real result\n            \n        # Numerical frequency Omega_c\n        omega_c = 2.0 * np.arcsin(arg_c_arcsin)\n        \n        # Numerical phase velocity c_ph_c\n        # Formula: c_ph = (sqrt(3) * Omega) / (alpha * theta)\n        c_ph_c = (sqrt3 * omega_c) / (alpha * theta)\n        \n        # Relative phase velocity error e_c\n        e_c = np.abs(c_ph_c - 1.0)\n        \n        # --- Lumped Mass Matrix Calculation ---\n        \n        # Argument of arcsin for the numerical frequency Omega_l\n        arg_l_arcsin = (alpha * sin_theta_half) / sqrt3\n\n        # The argument must be = 1 for stability.\n        if arg_l_arcsin > 1.0:\n            arg_l_arcsin = 1.0\n\n        # Numerical frequency Omega_l\n        omega_l = 2.0 * np.arcsin(arg_l_arcsin)\n        \n        # Numerical phase velocity c_ph_l\n        c_ph_l = (sqrt3 * omega_l) / (alpha * theta)\n\n        # Relative phase velocity error e_l\n        e_l = np.abs(c_ph_l - 1.0)\n\n        results.append([e_c, e_l])\n\n    # Format the output string as a Python-style list of lists,\n    # with no spaces within sublists, e.g., [[e_c1,e_l1],[e_c2,e_l2]].\n    output_str = f\"[{','.join(f'[{ec},{el}]' for ec, el in results)}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "3305148"}]}