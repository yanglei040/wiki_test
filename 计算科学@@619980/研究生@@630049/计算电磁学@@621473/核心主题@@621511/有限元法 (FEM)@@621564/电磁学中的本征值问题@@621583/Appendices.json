{"hands_on_practices": [{"introduction": "电磁本征问题的数值解本身具有任意的振幅，因此需要进行归一化才能赋予其明确的物理意义。本练习将引导您完成一个基本但至关重要的过程：将一个简单的平面波本征模进行归一化，使其总的电磁储能等于一个单位。通过这个计算，您不仅能加深对麦克斯韦方程和时谐场能量概念的理解，还能为后续处理更复杂的有损耗、非厄米系统的归一化方法奠定基础 [@problem_id:3304078]。", "problem": "考虑一个在均匀、各向同性、无损耗介质中的无源时谐麦克斯韦特征值问题，其介电常数 $\\epsilon>0$ 和磁导率 $\\mu>0$ 为常数，时间依赖关系为 $\\exp(j \\omega t)$（已省略）。区域 $\\Omega$ 是一个体积为 $V$ 的三维周期性盒子，因此在周期性边界条件下，平面波是允许的本征模式。设 $\\mathbf{k} \\in \\mathbb{R}^{3}$ 且 $\\hat{\\mathbf{k}}=\\mathbf{k}/\\|\\mathbf{k}\\|$，并设 $\\mathbf{e}$ 是一个满足 $\\mathbf{k}\\cdot \\mathbf{e}=0$ 的常数单位极化矢量。考虑本征模式\n$$\n\\mathbf{E}(\\mathbf{r})=\\alpha\\,\\mathbf{e}\\,\\exp\\!\\big(j\\,\\mathbf{k}\\cdot \\mathbf{r}\\big),\\qquad \\mathbf{H}(\\mathbf{r})\\ \\text{determined by Maxwell's equations},\n$$\n其中 $\\|\\mathbf{k}\\|=\\omega\\sqrt{\\mu\\epsilon}$，从而满足色散关系。确定一个实数、非负标量 $\\alpha$，使得总时间平均电磁能\n$$\n\\frac{1}{4}\\int_{\\Omega}\\big(\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2}\\big)\\,dV=1.\n$$\n将 $\\alpha$ 的最终答案以仅含 $\\epsilon$ 和 $V$ 的闭合形式表示。无需进行数值计算。\n\n然后，简要解释（无需进行任何计算）在有损耗的色散介质中（其中 $\\epsilon$ 和/或 $\\mu$ 是复数且与频率相关），归一化是如何改变的，并至少说出一种在计算电磁学中用于此类非厄米特征值问题的数学上一致的归一化约定。你的解释应简洁且概念化；最终评分的答案仅为 $\\alpha$ 的值。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它描述了在周期性区域内的无损耗、均匀介质中电磁本征模式的标准归一化程序。我们可以开始求解。\n\n问题要求为一个给定的平面波电场本征模式确定一个实数、非负的标量归一化常数 $\\alpha$，\n$$\n\\mathbf{E}(\\mathbf{r})=\\alpha\\,\\mathbf{e}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n使得在体积 $\\Omega$ 内的总时间平均电磁能等于 1。归一化条件是\n$$\n\\frac{1}{4}\\int_{\\Omega}\\big(\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2}\\big)\\,dV=1\n$$\n介质是无损耗、均匀、各向同性的，其介电常数 $\\epsilon>0$ 和磁导率 $\\mu>0$。矢量 $\\mathbf{e}$ 是一个单位极化矢量，$\\|\\mathbf{e}\\|=1$，并且它与波矢 $\\mathbf{k}$ 横向，即 $\\mathbf{k}\\cdot \\mathbf{e}=0$。\n\n首先，我们必须使用麦克斯韦方程组来确定与给定电场 $\\mathbf{E}(\\mathbf{r})$ 对应的磁场 $\\mathbf{H}(\\mathbf{r})$。对于省略了时间依赖关系 $\\exp(j \\omega t)$ 的时谐场，法拉第感应定律为\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H}\n$$\n我们可以求解 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\frac{1}{-j\\omega\\mu} (\\nabla \\times \\mathbf{E}) = \\frac{j}{\\omega\\mu} (\\nabla \\times \\mathbf{E})\n$$\n为了计算 $\\mathbf{E}$ 的旋度，我们应用矢量恒等式 $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + (\\nabla f) \\times \\mathbf{A}$。在我们的例子中，$f(\\mathbf{r}) = \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})$ 且矢量 $\\mathbf{A} = \\alpha\\mathbf{e}$ 是常数。因此，$\\nabla \\times \\mathbf{A} = \\mathbf{0}$。$f$ 的梯度是 $\\nabla f = \\nabla \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r}) = j\\mathbf{k}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})$。\n因此，$\\mathbf{E}$ 的旋度是\n$$\n\\nabla \\times \\mathbf{E} = (\\nabla \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})) \\times (\\alpha\\mathbf{e}) = (j\\mathbf{k}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})) \\times (\\alpha\\mathbf{e}) = j\\alpha(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n将此代入 $\\mathbf{H}$ 的表达式中：\n$$\n\\mathbf{H}(\\mathbf{r}) = \\frac{j}{\\omega\\mu} \\left[ j\\alpha(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r}) \\right] = -\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n接下来，我们计算场的范数平方，$\\|\\mathbf{E}\\|^2 = \\mathbf{E} \\cdot \\mathbf{E}^*$ 和 $\\|\\mathbf{H}\\|^2 = \\mathbf{H} \\cdot \\mathbf{H}^*$，其中 $*$ 表示复共轭。\n对于电场：\n$$\n\\|\\mathbf{E}(\\mathbf{r})\\|^2 = \\left(\\alpha\\,\\mathbf{e}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right) \\cdot \\left(\\alpha\\,\\mathbf{e}^*\\,\\exp(-j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right)\n$$\n因为 $\\mathbf{e}$ 是一个实矢量，所以 $\\mathbf{e}^*=\\mathbf{e}$。\n$$\n\\|\\mathbf{E}(\\mathbf{r})\\|^2 = \\alpha^2 (\\mathbf{e}\\cdot\\mathbf{e}) \\exp(0) = \\alpha^2 \\|\\mathbf{e}\\|^2 = \\alpha^2(1)^2 = \\alpha^2\n$$\n对于磁场：\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\left(-\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right) \\cdot \\left(-\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})^*\\exp(-j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right)\n$$\n因为 $\\mathbf{k}$ 和 $\\mathbf{e}$ 是实矢量，所以 $(\\mathbf{k} \\times \\mathbf{e})^* = \\mathbf{k} \\times \\mathbf{e}$。\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\frac{\\alpha^2}{(\\omega\\mu)^2} \\|\\mathbf{k} \\times \\mathbf{e}\\|^2\n$$\n根据横向条件 $\\mathbf{k}\\cdot\\mathbf{e}=0$，$\\mathbf{k}$ 和 $\\mathbf{e}$ 之间的夹角是 $\\pi/2$。它们的叉积的模为 $\\|\\mathbf{k} \\times \\mathbf{e}\\| = \\|\\mathbf{k}\\| \\|\\mathbf{e}\\| \\sin(\\pi/2) = \\|\\mathbf{k}\\|$。设 $k = \\|\\mathbf{k}\\|$。\n那么，$\\|\\mathbf{H}\\|^2 = \\frac{\\alpha^2 k^2}{\\omega^2\\mu^2}$。\n问题给出了平面波的色散关系：$k = \\omega\\sqrt{\\mu\\epsilon}$，这意味着 $k^2 = \\omega^2\\mu\\epsilon$。将此代入 $\\|\\mathbf{H}\\|^2$ 的表达式中：\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\frac{\\alpha^2(\\omega^2\\mu\\epsilon)}{\\omega^2\\mu^2} = \\alpha^2 \\frac{\\epsilon}{\\mu}\n$$\n我们观察到 $\\|\\mathbf{E}\\|^2$ 和 $\\|\\mathbf{H}\\|^2$ 在整个区域 $\\Omega$ 中都是常数。\n\n现在我们可以计算归一化积分。被积函数是\n$$\n\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2} = \\epsilon\\alpha^2 + \\mu\\left(\\alpha^2 \\frac{\\epsilon}{\\mu}\\right) = \\epsilon\\alpha^2 + \\epsilon\\alpha^2 = 2\\epsilon\\alpha^2\n$$\n这证明了在无损耗介质中平面波的时间平均能量均分：电能密度和磁能密度相等，$\\frac{1}{4}\\epsilon\\|\\mathbf{E}\\|^2 = \\frac{1}{4}\\epsilon\\alpha^2$ 且 $\\frac{1}{4}\\mu\\|\\mathbf{H}\\|^2 = \\frac{1}{4}\\mu(\\alpha^2\\epsilon/\\mu) = \\frac{1}{4}\\epsilon\\alpha^2$。\n\n总能量是\n$$\n\\frac{1}{4}\\int_{\\Omega} (2\\epsilon\\alpha^2) \\,dV = \\frac{\\epsilon\\alpha^2}{2} \\int_{\\Omega} dV\n$$\n$dV$ 在区域 $\\Omega$ 上的积分是其体积 $V$。所以总能量是\n$$\nW = \\frac{\\epsilon\\alpha^2 V}{2}\n$$\n根据归一化条件，令其等于 1：\n$$\n\\frac{\\epsilon\\alpha^2 V}{2} = 1\n$$\n我们现在可以解出 $\\alpha$。因为 $\\alpha$ 是一个非负标量：\n$$\n\\alpha^2 = \\frac{2}{\\epsilon V} \\implies \\alpha = \\sqrt{\\frac{2}{\\epsilon V}}\n$$\n这就是用 $\\epsilon$ 和 $V$ 表示的所需归一化常数。\n\n关于在有损耗、色散介质中归一化的概念性问题：\n在这类介质中，介电常数 $\\epsilon(\\omega)$ 和/或磁导率 $\\mu(\\omega)$ 变为复数且与频率相关。这会带来几个后果。控制波动算符不再是厄米的，导致复数特征值（复频率 $\\omega$），代表时间上的衰减。时间平均储能的标准表达式不再有效。在线性、色散和弱损耗介质中，时间平均能量密度的正确表达式由 Brillouin 公式给出：\n$$\nw(\\mathbf{r}) = \\frac{1}{4}\\left(\\frac{d(\\omega\\,\\text{Re}\\{\\epsilon(\\omega)\\})}{d\\omega}\\|\\mathbf{E}(\\mathbf{r})\\|^2 + \\frac{d(\\omega\\,\\text{Re}\\{\\mu(\\omega)\\})}{d\\omega}\\|\\mathbf{H}(\\mathbf{r})\\|^2\\right)\n$$\n这个表达式说明了储存在介质极化和磁化动态响应中的能量。\n对于在有损耗或开放系统中出现的非厄米特征值问题，右特征矢量（即模式本身）和左特征矢量不再互为伴随。它们形成一个双正交集。对于这些问题，一个数学上一致且广泛使用的归一化约定是**双正交归一化 (biorthogonal normalization)**。在此约定中，对应于不同特征值的右特征矢量 $\\mathbf{u}_i$ 和左特征矢量 $\\mathbf{v}_j$ 在一个适当定义的内积下是正交的，并且选择归一化使得 $\\langle \\mathbf{v}_j, \\mathbf{u}_i \\rangle = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 δ。这确保了任何任意场的唯一模态展开。", "answer": "$$\n\\boxed{\\sqrt{\\frac{2}{\\epsilon V}}}\n$$", "id": "3304078"}, {"introduction": "在许多实际应用中，我们关心的并非最低阶的本征模，而是位于特定工作频段内的“内部”本征模。标准的迭代求解器在求解这类内部本征值时效率低下。本练习旨在介绍一种强大的数值技巧——“位移-反演”谱变换方法 (shift-and-invert) [@problem_id:3304065]。该方法通过巧妙的数学变换，将求解靠近目标频率 $\\sigma$ 的本征值问题，转化为求解一个新算子的最大本征值问题，从而极大地加速了收敛速度。", "problem": "一个无源的理想电导腔体在频域中通过从麦克斯韦方程组推导出的旋度-旋度特征问题进行建模：寻找非平凡电场 $\\mathbf{E}$ 和角频率 $\\omega$ 使得\n$$\n\\nabla \\times \\mu^{-1} \\nabla \\times \\mathbf{E} \\;=\\; \\omega^{2} \\,\\epsilon\\, \\mathbf{E}, \n$$\n在传导边界上满足边界条件 $\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$。在适当的无散子空间上进行相容有限元法（FEM）离散化，得到广义矩阵特征值问题\n$$\n\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}, \n$$\n其中，$\\mathbf{K}$ 和 $\\mathbf{M}$ 分别是由旋度-旋度和质量项的双线性形式产生的埃尔米特矩阵，$\\lambda = \\omega^{2}$，质量矩阵 $\\mathbf{M}$ 在离散子空间上是埃尔米特正定的，刚度矩阵 $\\mathbf{K}$ 是埃尔米特半正定的。假设目标是计算位于给定实数位移 $\\sigma \\in \\mathbb{R}$ 附近的特征值 $\\lambda$，其中 $\\sigma$ 不等于任何精确特征值。\n\n考虑将克雷洛夫子空间方法应用于一个线性算子映射，该映射是隐式定义的：对于给定的向量 $\\mathbf{v}$，通过求解线性系统\n$$\n\\left(\\mathbf{K} - \\sigma \\mathbf{M}\\right)\\,\\mathbf{w} \\;=\\; \\mathbf{M}\\,\\mathbf{v},\n$$\n来计算唯一的解 $\\mathbf{w}$，然后返回 $\\mathbf{w}$ 作为算子对 $\\mathbf{v}$ 的作用结果。这种构造通常用于加速收敛到 $\\sigma$ 附近的特征值。\n\n关于这种构造，以下哪些陈述是正确的？选择所有适用项。\n\nA. 如果 $(\\lambda, \\mathbf{e})$ 是 $\\mathbf{K}\\,\\mathbf{e}=\\lambda \\mathbf{M}\\,\\mathbf{e}$ 的一个特征对，且 $\\lambda \\neq \\sigma$，那么 $\\mathbf{e}$ 是该隐式定义算子的一个特征向量，其特征值为 $\\mu = (\\lambda - \\sigma)^{-1}$。因此，靠近 $\\sigma$ 的特征值 $\\lambda$ 被映射为大模的特征值 $\\mu$。\n\nB. 该构造将靠近 $\\sigma$ 的特征值 $\\lambda$ 映射为小模的特征值 $\\mu$，因此，以主特征值（最大模特征值）为目标的方法将倾向于收敛到远离 $\\sigma$ 的特征值。\n\nC. 为了保持特征向量不变，该方法需要显式地构造 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)^{-1}$；仅仅求解系数为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$ 的线性系统并不能产生相同的特征对。\n\nD. 假设 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是埃尔米特矩阵且 $\\mathbf{M}$ 是正定的，并且 $\\sigma \\in \\mathbb{R}$ 位于谱之外。那么，该隐式定义的算子关于 $\\mathbf{M}$-内积是自伴的，具有实数特征值 $\\mu$，并拥有一个与原问题的广义特征向量重合的 $\\mathbf{M}$-正交特征基。\n\nE. 在克雷洛夫子空间方法中，每一次应用该隐式定义的算子都需要求解一个线性系统，其系数矩阵为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$，右端项为 $\\mathbf{M}$ 乘以当前向量。", "solution": "用户提供了一个问题陈述，该问题关于由谐振腔中麦克斯韦方程组的有限元法（FEM）离散化产生的广义特征值问题的移位-求逆谱变换的性质。\n\n### 第一步：提取已知条件\n\n-   **连续特征问题**：寻找非平凡电场 $\\mathbf{E}$ 和角频率 $\\omega$ 使得 $\\nabla \\times \\mu^{-1} \\nabla \\times \\mathbf{E} \\;=\\; \\omega^{2} \\,\\epsilon\\, \\mathbf{E}$。\n-   **边界条件**：在理想电导边界上 $\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$。\n-   **离散化特征问题**：$\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}$。\n-   **矩阵性质**：\n    -   $\\mathbf{K}$ 是一个埃尔米特半正定刚度矩阵。\n    -   $\\mathbf{M}$ 是一个埃尔米特正定质量矩阵。\n    -   特征值为 $\\lambda = \\omega^{2}$。\n-   **计算目标**：计算靠近给定实数位移 $\\sigma \\in \\mathbb{R}$ 的特征值 $\\lambda$。\n-   **对位移的约束**：$\\sigma$ 不等于任何精确特征值 $\\lambda$。\n-   **算子定义**：一个算子被隐式定义。对于给定的向量 $\\mathbf{v}$，算子对 $\\mathbf{v}$ 的作用产生一个向量 $\\mathbf{w}$，该向量是线性系统 $\\left(\\mathbf{K} - \\sigma \\mathbf{M}\\right)\\,\\mathbf{w} \\;=\\; \\mathbf{M}\\,\\mathbf{v}$ 的唯一解。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题在计算电磁学和数值线性代数中有充分的依据。旋度-旋度方程是无源电磁腔体频域分析的标准起点。其有限元离散化导致广义特征值问题 $\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}$ 是该领域的基石。$\\mathbf{K}$ 和 $\\mathbf{M}$ 是埃尔米特和（半）正定的性质对于标准的伽辽金有限元公式是正确的。\n-   **适定性**：该问题描述了移位-求逆谱变换。位移 $\\sigma$ 不是特征值的条件确保了矩阵 $\\mathbf{K} - \\sigma \\mathbf{M}$ 是非奇异的（可逆的），从而使算子是适定的。关于该算子性质所提出的问题是标准的，并且有明确的答案。\n-   **客观性**：该问题使用精确、标准的数学和工程术语（例如，埃尔米特、正定、克雷洛夫子空间方法、特征对）进行陈述。它不含主观或模糊的语言。\n-   **完整性与一致性**：该问题提供了分析所提议算子所需的所有必要信息和定义。设置中没有矛盾之处。\n-   **可行性与现实性**：所描述的方法，称为移位-求逆策略（通常与 Arnoldi 或 Lanczos 算法一起使用），是一种广泛使用且高效的实用技术，用于寻找大型稀疏矩阵系统的内部特征值。\n\n### 第三步：判断与行动\n\n问题陈述是有效的。这是一个工程数值方法中的标准、适定问题。我将继续进行推导和选项分析。\n\n### 算子性质推导\n\n问题定义了一个算子，我们称之为 $\\mathbf{T}$，其对向量 $\\mathbf{v}$ 的作用是通过求解以下系统来产生一个向量 $\\mathbf{w}$：\n$$ (\\mathbf{K} - \\sigma \\mathbf{M})\\,\\mathbf{w} = \\mathbf{M}\\,\\mathbf{v} $$\n由于 $\\sigma$ 不是特征值，矩阵 $(\\mathbf{K} - \\sigma \\mathbf{M})$ 是可逆的。因此，我们可以将算子 $\\mathbf{T}$ 显式地写为：\n$$ \\mathbf{T} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} $$\n\n设 $(\\lambda, \\mathbf{e})$ 是原问题的一个特征对，满足 $\\mathbf{K}\\,\\mathbf{e} = \\lambda \\mathbf{M}\\,\\mathbf{e}$。我们将分析 $\\mathbf{T}$ 对特征向量 $\\mathbf{e}$ 的作用。\n\n我们重排原特征值方程：\n$$ \\mathbf{K}\\,\\mathbf{e} - \\sigma \\mathbf{M}\\,\\mathbf{e} = \\lambda \\mathbf{M}\\,\\mathbf{e} - \\sigma \\mathbf{M}\\,\\mathbf{e} $$\n$$ (\\mathbf{K} - \\sigma \\mathbf{M})\\,\\mathbf{e} = (\\lambda - \\sigma) \\mathbf{M}\\,\\mathbf{e} $$\n因为 $\\lambda$ 是一个特征值而 $\\sigma$ 不是，所以 $\\lambda \\neq \\sigma$，因此标量 $(\\lambda - \\sigma)$ 非零。我们可以用 $(\\mathbf{K} - \\sigma \\mathbf{M})^{-1}$ 左乘：\n$$ \\mathbf{e} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1}(\\lambda - \\sigma) \\mathbf{M}\\,\\mathbf{e} $$\n提出标量 $(\\lambda - \\sigma)$：\n$$ \\mathbf{e} = (\\lambda - \\sigma) \\left[ (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} \\right] \\mathbf{e} $$\n识别出算子 $\\mathbf{T}$：\n$$ \\mathbf{e} = (\\lambda - \\sigma) \\mathbf{T}\\,\\mathbf{e} $$\n除以非零标量 $(\\lambda - \\sigma)$，我们得到算子 $\\mathbf{T}$ 的特征值方程：\n$$ \\mathbf{T}\\,\\mathbf{e} = \\frac{1}{\\lambda - \\sigma} \\mathbf{e} $$\n这表明 $\\mathbf{e}$ 是算子 $\\mathbf{T}$ 的一个特征向量。对应的特征值，我们称之为 $\\mu$，是：\n$$ \\mu = \\frac{1}{\\lambda - \\sigma} $$\n\n### 逐项分析\n\n**A. 如果 $(\\lambda, \\mathbf{e})$ 是 $\\mathbf{K}\\,\\mathbf{e}=\\lambda \\mathbf{M}\\,\\mathbf{e}$ 的一个特征对，且 $\\lambda \\neq \\sigma$，那么 $\\mathbf{e}$ 是该隐式定义算子的一个特征向量，其特征值为 $\\mu = (\\lambda - \\sigma)^{-1}$。因此，靠近 $\\sigma$ 的特征值 $\\lambda$ 被映射为大模的特征值 $\\mu$。**\n\n这个陈述是我们上述推导的直接结果。算子 $\\mathbf{T}$ 的特征值确实是 $\\mu = (\\lambda - \\sigma)^{-1}$。如果原始特征值 $\\lambda$ 接近位移 $\\sigma$，分母 $(\\lambda - \\sigma)$ 将成为一个小数。小数的倒数是一个大数。因此，靠近 $\\sigma$ 的特征值 $\\lambda$ 被映射为大模的特征值 $\\mu$。这个性质正是使用此方法的原因：像 Arnoldi 或 Lanczos 这样的克雷洛夫方法对最大模的特征值（主特征值）收敛最快。\n**结论：正确。**\n\n**B. 该构造将靠近 $\\sigma$ 的特征值 $\\lambda$ 映射为小模的特征值 $\\mu$，因此，以主特征值（最大模特征值）为目标的方法将倾向于收敛到远离 $\\sigma$ 的特征值。**\n\n这个陈述与选项A的结论在逻辑上相反。如上所述，靠近 $\\sigma$ 的特征值 $\\lambda$ 被映射为大模的特征值 $\\mu$，而不是小模。因此，寻找主特征值的克雷洛夫方法将收敛到期望的特征值（那些靠近 $\\sigma$ 的特征值）。\n**结论：不正确。**\n\n**C. 为了保持特征向量不变，该方法需要显式地构造 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)^{-1}$；仅仅求解系数为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$ 的线性系统并不能产生相同的特征对。**\n\n这个陈述反映了对克雷洛夫子空间方法如何实现的误解。算子 $\\mathbf{T}$ 对向量 $\\mathbf{v}$ 的作用是 $\\mathbf{T}\\mathbf{v} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} \\mathbf{v}$。在计算上，这是通过首先计算向量 $\\mathbf{b} = \\mathbf{M}\\mathbf{v}$，然后求解线性系统 $(\\mathbf{K} - \\sigma \\mathbf{M})\\mathbf{w} = \\mathbf{b}$ 来得到 $\\mathbf{w}$。解 $\\mathbf{w}$ 等于 $\\mathbf{T}\\mathbf{v}$。这个过程*就是*算子的应用。显式构造逆矩阵在计算上要昂贵得多（例如，对于密集矩阵是 $O(N^3)$），而且通常在数值上比求解相应的线性系统更不稳定（例如，对于密集 LU 分解是 $O(N^2)$，对于稀疏系统则快得多）。求解系统是实现逆算子作用的标准、高效且正确的方法。通过这个过程，特征向量被完美地保留下来。\n**结论：不正确。**\n\n**D. 假设 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是埃尔米特矩阵且 $\\mathbf{M}$ 是正定的，并且 $\\sigma \\in \\mathbb{R}$ 位于谱之外。那么，该隐式定义的算子关于 $\\mathbf{M}$-内积是自伴的，具有实数特征值 $\\mu$，并拥有一个与原问题的广义特征向量重合的 $\\mathbf{M}$-正交特征基。**\n\n让我们验证其关于 $\\mathbf{M}$-内积的自伴性，该内积定义为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\mathbf{y}^H \\mathbf{M} \\mathbf{x}$。如果 $\\langle \\mathbf{T}\\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\langle \\mathbf{x}, \\mathbf{T}\\mathbf{y} \\rangle_{\\mathbf{M}}$，则算子 $\\mathbf{T}$ 是自伴的。\n\n左边：$\\langle \\mathbf{T}\\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\mathbf{y}^H \\mathbf{M} (\\mathbf{T}\\mathbf{x}) = \\mathbf{y}^H \\mathbf{M} (\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{x}$。\n\n右边：$\\langle \\mathbf{x}, \\mathbf{T}\\mathbf{y} \\rangle_{\\mathbf{M}} = (\\mathbf{T}\\mathbf{y})^H \\mathbf{M} \\mathbf{x} = ((\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{y})^H \\mathbf{M} \\mathbf{x} = \\mathbf{y}^H \\mathbf{M}^H ((\\mathbf{K} - \\sigma\\mathbf{M})^{-1})^H \\mathbf{M} \\mathbf{x}$。\n\n鉴于 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是埃尔米特矩阵且 $\\sigma$ 是实数，矩阵 $(\\mathbf{K} - \\sigma\\mathbf{M})$ 也是埃尔米特矩阵：$(\\mathbf{K} - \\sigma\\mathbf{M})^H = \\mathbf{K}^H - \\sigma^* \\mathbf{M}^H = \\mathbf{K} - \\sigma \\mathbf{M}$。埃尔米特矩阵的逆也是埃尔米特矩阵，所以 $((\\mathbf{K} - \\sigma\\mathbf{M})^{-1})^H = (\\mathbf{K} - \\sigma\\mathbf{M})^{-1}$。此外，$\\mathbf{M}^H = \\mathbf{M}$。将这些代入右边的表达式得到：\n右边 = $\\mathbf{y}^H \\mathbf{M} (\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{x}$，这与左边相同。\n因此，算子 $\\mathbf{T}$ 关于 $\\mathbf{M}$-内积是自伴的。线性代数中的一个基本结果表明，一个关于某个内积自伴的算子具有实数特征值，并拥有一套完备的关于该内积正交的特征向量。由于 $\\lambda$ 和 $\\sigma$ 是实数，特征值 $\\mu = (\\lambda - \\sigma)^{-1}$ 确实是实数。特征向量与原问题的广义特征向量 $\\mathbf{e}$ 相同，已知这些广义特征向量构成一个 $\\mathbf{M}$-正交集。\n**结论：正确。**\n\n**E. 在克雷洛夫子空间方法中，每一次应用该隐式定义的算子都需要求解一个线性系统，其系数矩阵为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$，右端项为 $\\mathbf{M}$ 乘以当前向量。**\n\n这个陈述是对应用算子 $\\mathbf{T}$ 的一个精确的程序性描述。克雷洛夫子空间方法为子空间 $\\text{span}(\\mathbf{v}, \\mathbf{T}\\mathbf{v}, \\mathbf{T}^2\\mathbf{v}, \\dots)$ 构建一个基。为了计算序列中的下一个向量，例如 $\\mathbf{w} = \\mathbf{T}\\mathbf{v}$，必须求解线性系统 $(\\mathbf{K} - \\sigma \\mathbf{M})\\mathbf{w} = \\mathbf{M}\\mathbf{v}$，正如问题中对算子的定义所规定的那样。系数矩阵是 $(\\mathbf{K} - \\sigma \\mathbf{M})$，右端项是 $\\mathbf{M}$ 乘以输入向量 $\\mathbf{v}$。这正是移位-求逆方法的实现方式。\n**结论：正确。**", "answer": "$$\\boxed{ADE}$$", "id": "3304065"}, {"introduction": "经典的电磁问题通常处理无损耗系统，对应于厄米算子。然而，现代光子学和超材料领域的研究常常涉及精心设计的增益和损耗，这引出了非厄米物理的范畴。这类系统展现出许多新奇的物理现象，如宇称-时间 (PT) 对称性破缺和奇异点 (exceptional points, EPs)，在奇异点处，系统的本征值和本征向量会发生合并。本练习通过一个简化的 $2 \\times 2$ 矩阵模型，让您亲手模拟和分析从实数谱到复数谱的相变过程，并学习如何识别标志着奇异点出现的数学特征 [@problem_id:3304079]。", "problem": "考虑一个沿 $z$ 轴的一维、均匀、平移不变的电磁波导，其标量横向电场分布为 $E(x,z) = \\psi(x)\\,e^{i \\beta z}$，其中 $\\beta$ 是复传播常数，$\\psi(x)$ 是横向模式分布。假设场为角频率为 $\\omega$ 的时谐场，并忽略磁对比度（相对磁导率等于 $1$）。设相对介电常数具有平衡增益/损耗形式 $\\epsilon_r(x) = \\epsilon_{r0} + i \\gamma f(x)$，其中 $f(x)$ 是一个实值函数，满足 $f(-x) = - f(x)$ 以强制实现宇称-时间（PT）对称性，$\\gamma \\ge 0$ 是一个实数控制参数。\n\n从麦克斯韦方程组和关于 $\\psi(x)$ 的亥姆霍兹方程出发，通过双模耦合模式简化，将控制最低两个超模的非厄米特征值问题近似为一个 $2 \\times 2$ 矩阵算符，其形式如下\n$$\n\\mathbf{A}(\\gamma) = \n\\begin{bmatrix}\n\\beta_0 + i \\gamma  \\kappa \\\\\n\\kappa  \\beta_0 - i \\gamma\n\\end{bmatrix},\n$$\n其中 $\\beta_0$ 和 $\\kappa$ 是由底层对称保守结构（当 $\\gamma = 0$ 时）决定的实常数。该简化算符是 PT 对称的，在 $\\gamma \\ne 0$ 时是非厄米的，其谱 $\\{\\lambda_j(\\gamma)\\}$ 近似于两个超模的谱 $\\{\\beta_j(\\gamma)\\}$。\n\n你的任务是实现一个程序，对于给定的参数集 $(\\beta_0, \\kappa)$ 和 $\\gamma$ 的扫描范围，该程序将：\n\n1. 构建特征值问题 $\\mathbf{A}(\\gamma)\\,\\mathbf{v} = \\lambda\\,\\mathbf{v}$，并为每个采样的 $\\gamma$ 计算两个特征值。\n2. 在扫描范围内，识别出使两个特征值最接近合并的 $\\gamma$ 值（即最小化绝对差 $|\\lambda_1(\\gamma) - \\lambda_2(\\gamma)|$）。将此值记为 $\\gamma^\\star$，并将相应的（几乎）合并的特征值记为 $\\lambda^\\star$。\n3. 判断在 $\\gamma^\\star$ 处的合并是否为严格意义上的奇异点，即亏损特征值（代数重数超过几何重数）。通过计算 $\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}$ 的零度对其进行分类：如果在数值容差范围内两个特征值相等且零度为 $1$，则声明为亏损点；如果在相等时零度为 $2$，则为非亏损简并；如果特征值在容差范围内不相等，则扫描范围内未找到奇异点。\n4. 对于亏损情况，通过求解广义链方程\n$$\n\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{w} = \\mathbf{v},\n$$\n来计算与 $\\lambda^\\star$ 相关的若尔当链向量 $\\mathbf{w}$，其中 $\\mathbf{v}$ 是满足 $\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{v} = \\mathbf{0}$ 的（右）特征向量。在非亏损或未合并的情况下，仍尝试通过同一方程的最小二乘解计算近似广义特征向量 $\\mathbf{w}$，并报告残差范数。链方程的残差由\n$$\nr = \\left\\|\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{w} - \\mathbf{v}\\right\\|_2.\n$$\n来量化。\n\n全程使用无量纲归一化单位（无需进行物理单位转换；所有量均视为无量纲）。在判断特征值是否相等以及通过奇异值计算数值零度时，使用 $10^{-8}$ 的固定绝对数值容差。\n\n为以下测试套件实现上述过程，在均匀间隔的网格上扫描 $\\gamma$：\n\n- 测试用例 1（理想情况，PT 对称性在扫描范围内破缺）：$\\beta_0 = 10.0$，$\\kappa = 0.3$，$\\gamma$ 从 $0.0$ 扫描到 $0.6$，步长为 $0.002$。\n- 测试用例 2（边界条件，非亏损简并）：$\\beta_0 = 10.0$，$\\kappa = 0.0$，$\\gamma$ 从 $0.0$ 扫描到 $0.4$，步长为 $0.002$。\n- 测试用例 3（边缘情况，扫描范围内无奇异点）：$\\beta_0 = 10.0$，$\\kappa = 0.25$，$\\gamma$ 从 $0.0$ 扫描到 $0.2$，步长为 $0.002$。\n\n对于每个测试用例，生成一个包含三个条目的列表作为结果：\n- 识别出的 $\\gamma^\\star$（浮点数）。\n- 残差范数 $r$（浮点数）。\n- 一个布尔值，指示是否在 $\\gamma^\\star$ 处检测到亏损奇异点。\n\n最终输出格式：你的程序应生成单行输出，其中包含所有测试用例的结果。结果是一个包含在方括号中的逗号分隔列表，每个测试用例的结果本身也是一个形式为 $[\\gamma^\\star, r, \\text{defective}]$ 的列表。例如，输出应类似于 $[[\\ldots],[\\ldots],[\\ldots]]$。不涉及角度；由于所有量都是无量纲的，因此不需要物理单位。", "solution": "该问题要求分析一个 $2 \\times 2$ 的非厄米、宇称-时间（PT）对称矩阵算符，它是一个具有平衡增益和损耗的双模电磁波导的简化模型。目标是在指定的参数范围内识别和表征奇异点（EPs）。\n\n控制矩阵算符由下式给出：\n$$\n\\mathbf{A}(\\gamma) = \n\\begin{bmatrix}\n\\beta_0 + i \\gamma  \\kappa \\\\\n\\kappa  \\beta_0 - i \\gamma\n\\end{bmatrix}\n$$\n其中 $\\beta_0$ 和 $\\kappa$ 是代表底层保守系统的实常数，$\\gamma \\ge 0$ 是一个控制非厄米增益-损耗项大小的实参数。\n\n首先，我们通过求解特征值问题 $\\mathbf{A}(\\gamma)\\mathbf{v} = \\lambda\\mathbf{v}$ 来确定该系统的解析性质。特征值 $\\lambda$ 可通过特征方程 $\\det(\\mathbf{A}(\\gamma) - \\lambda \\mathbf{I}) = 0$ 求得：\n$$\n\\det \\begin{bmatrix}\n(\\beta_0 - \\lambda) + i \\gamma  \\kappa \\\\\n\\kappa  (\\beta_0 - \\lambda) - i \\gamma\n\\end{bmatrix} = 0\n$$\n$$\n((\\beta_0 - \\lambda) + i \\gamma)((\\beta_0 - \\lambda) - i \\gamma) - \\kappa^2 = 0\n$$\n$$\n(\\beta_0 - \\lambda)^2 - (i\\gamma)^2 - \\kappa^2 = 0\n$$\n$$\n(\\beta_0 - \\lambda)^2 = \\kappa^2 - \\gamma^2\n$$\n这得出两个特征值：\n$$\n\\lambda_{1,2}(\\gamma) = \\beta_0 \\mp \\sqrt{\\kappa^2 - \\gamma^2}\n$$\n\n特征值的行为取决于 $\\gamma$ 和 $|\\kappa|$ 之间的关系。不失一般性地，假设 $\\kappa \\ge 0$：\n1.  **PT 对称相（$\\gamma  \\kappa$）：** 项 $\\kappa^2 - \\gamma^2$ 为正，因此特征值 $\\lambda_{1,2}$ 是实数且不相等。系统拥有纯实谱，这是 PT 对称相未破缺的标志。\n2.  **奇异点（$\\gamma = \\kappa$）：** 平方根项消失，导致特征值合并为单个值：$\\lambda_1 = \\lambda_2 = \\beta_0$。这个合并点是奇异点的候选点。\n3.  **PT 破缺相（$\\gamma > \\kappa$）：** 项 $\\kappa^2 - \\gamma^2$ 为负。特征值变为一对复共轭：$\\lambda_{1,2} = \\beta_0 \\mp i\\sqrt{\\gamma^2 - \\kappa^2}$。复数谱的出现标志着 PT 对称性的自发破缺。\n\n为了确定在 $\\gamma^\\star = \\kappa$ 处的合并是否为亏损奇异点，我们必须检查该特征值的几何重数是否小于其代数重数。由于合并，代数重数为 $2$。几何重数是矩阵 $\\mathbf{M} = \\mathbf{A}(\\gamma^\\star) - \\lambda^\\star\\mathbf{I}$ 的零空间维度（零度）。此处，$\\gamma^\\star = \\kappa$ 且 $\\lambda^\\star = \\beta_0$。\n$$\n\\mathbf{M} = \\mathbf{A}(\\kappa) - \\beta_0\\mathbf{I} = \n\\begin{bmatrix}\n\\beta_0 + i \\kappa  \\kappa \\\\\n\\kappa  \\beta_0 - i \\kappa\n\\end{bmatrix} - \n\\begin{bmatrix}\n\\beta_0  0 \\\\\n0  \\beta_0\n\\end{bmatrix} = \n\\begin{bmatrix}\ni \\kappa  \\kappa \\\\\n\\kappa  -i \\kappa\n\\end{bmatrix}\n$$\n对于 $\\kappa \\ne 0$，该矩阵的两行是线性相关的（第二行是第一行的 $-i$ 倍）。因此，$\\mathbf{M}$ 的秩为 $1$。根据秩-零度定理，零度为 $2 - \\text{rank}(\\mathbf{M}) = 2 - 1 = 1$。由于几何重数（$1$）小于代数重数（$2$），该矩阵是亏损的，在 $\\gamma = \\kappa$ 处的合并是一个真正的奇异点。一个重要的特殊情况是当 $\\kappa=0$ 时，在 $\\gamma=0$ 处矩阵 $\\mathbf{M}$ 是零矩阵，其零度为 $2$。这对应于一个非亏损（恶魔点）简并。\n\n在一个亏损 EP 处，特征向量也发生合并。单个特征向量 $\\mathbf{v}$ 是若尔当链的一部分，该链包含一个满足链方程的广义特征向量 $\\mathbf{w}$：\n$$\n\\mathbf{M}\\,\\mathbf{w} = (\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I})\\,\\mathbf{w} = \\mathbf{v}\n$$\n其中 $\\mathbf{v}$ 是满足 $(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I})\\mathbf{v} = \\mathbf{0}$ 的特征向量。对于一个亏损矩阵，这个方程组是相容的，并且可以求解出 $\\mathbf{w}$。\n\n数值实现过程如下：\n1.  对每个测试用例，我们定义一个 $\\gamma$ 值的网格。\n2.  在每个 $\\gamma$ 值处，我们构造矩阵 $\\mathbf{A}(\\gamma)$ 并计算其特征值 $\\lambda_1, \\lambda_2$。\n3.  我们找到使绝对差 $|\\lambda_1 - \\lambda_2|$ 最小的 $\\gamma^\\star$ 值。相应的近似合并的特征值 $\\lambda^\\star$ 取为 $\\gamma^\\star$ 处两个特征值的平均值。\n4.  为了对 $\\gamma^\\star$ 处的点进行分类，我们构造 $\\mathbf{M} = \\mathbf{A}(\\gamma^\\star) - \\lambda^\\star\\mathbf{I}$。$\\mathbf{M}$ 的数值零度通过计算其小于给定容差 $10^{-8}$ 的奇异值数量来确定。如果零度为 $1$ 且特征值差也低于容差，则检测到一个 EP。\n5.  计算与 $\\lambda^\\star$ 对应的特征向量 $\\mathbf{v}$ 并将其归一化。通过使用最小二乘求解器（`numpy.linalg.lstsq`）求解线性系统 $\\mathbf{M}\\mathbf{w} = \\mathbf{v}$ 来找到广义特征向量 $\\mathbf{w}$，该求解器对奇异（亏损/简并）和非奇异情况都具有鲁棒性。\n6.  最后，计算残差范数 $r = \\|\\mathbf{M}\\mathbf{w} - \\mathbf{v}\\|_2$。该范数量化了若尔当链方程的满足程度。对于一个真正的 EP 或一个未合并点（此时 $\\mathbf{M}$ 可逆），该范数将接近于零；但对于一个非亏损简并（此时 $\\mathbf{M}=\\mathbf{0}$ 且 $\\mathbf{v}\\ne\\mathbf{0}$），该范数将显著非零。", "answer": "```python\nimport numpy as np\n\ndef analyze_pt_system(beta0, kappa, gamma_range, tol):\n    \"\"\"\n    Analyzes a 2x2 PT-symmetric system to find and classify exceptional points.\n\n    Args:\n        beta0 (float): Real part of the diagonal elements.\n        kappa (float): Real coupling coefficient.\n        gamma_range (tuple): A tuple (start, stop, step) defining the scan range for gamma.\n        tol (float): Numerical tolerance for equality and nullity checks.\n\n    Returns:\n        list: A list containing [gamma_star, residual_norm, is_defective].\n    \"\"\"\n    gamma_start, gamma_stop, gamma_step = gamma_range\n    num_points = int(round((gamma_stop - gamma_start) / gamma_step)) + 1\n    gammas = np.linspace(gamma_start, gamma_stop, num_points)\n\n    min_separation = float('inf')\n    gamma_star = -1.0\n    eigenvalues_at_min_sep = None\n\n    for gamma in gammas:\n        A = np.array([\n            [beta0 + 1j * gamma, kappa],\n            [kappa,             beta0 - 1j * gamma]\n        ], dtype=np.complex128)\n        \n        eigenvalues = np.linalg.eigvals(A)\n        separation = np.abs(eigenvalues[0] - eigenvalues[1])\n        \n        if separation  min_separation:\n            min_separation = separation\n            gamma_star = gamma\n            eigenvalues_at_min_sep = eigenvalues\n\n    # Perform analysis at the identified point gamma_star\n    A_star = np.array([\n        [beta0 + 1j * gamma_star, kappa],\n        [kappa,             beta0 - 1j * gamma_star]\n    ], dtype=np.complex128)\n    \n    # The coalesced eigenvalue is approximated by the mean of the two nearly-equal eigenvalues\n    lambda_star = np.mean(eigenvalues_at_min_sep)\n\n    # Construct the matrix M for defectiveness and Jordan chain analysis\n    M = A_star - lambda_star * np.identity(2, dtype=np.complex128)\n\n    # 1. Defectiveness check using SVD for numerical nullity\n    _ , s, _ = np.linalg.svd(M)\n    nullity = np.sum(s  tol)\n    \n    # An EP is defective if nullity is 1 and eigenvalues are coalesced\n    is_defective = (nullity == 1) and (min_separation  tol)\n\n    # 2. Jordan chain vector and residual norm calculation\n    # Find the eigenvector v. Using np.linalg.eig on A_star is robust.\n    _ , eigvecs_star = np.linalg.eig(A_star)\n    \n    # Choose the eigenvector whose eigenvalue is closest to lambda_star\n    v_index = np.argmin(np.abs(np.linalg.eigvals(A_star) - lambda_star))\n    v = eigvecs_star[:, v_index]\n    v = v / np.linalg.norm(v)  # Normalize for a consistent residual measure\n\n    # Solve M w = v for w using least squares, which handles all cases\n    w, _, _, _ = np.linalg.lstsq(M, v, rcond=None)\n    \n    # Calculate the residual norm as per the problem definition\n    residual_norm = np.linalg.norm(M @ w - v)\n    \n    return [gamma_star, residual_norm, is_defective]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (beta0, kappa, (gamma_start, gamma_stop, gamma_step))\n        (10.0, 0.3,  (0.0, 0.6, 0.002)),  # PT-breaking inside scan\n        (10.0, 0.0,  (0.0, 0.4, 0.002)),  # Non-defective degeneracy\n        (10.0, 0.25, (0.0, 0.2, 0.002)),  # No EP in scan range\n    ]\n    \n    tolerance = 1e-8\n    results = []\n    \n    for case in test_cases:\n        beta0, kappa, gamma_range = case\n        result = analyze_pt_system(beta0, kappa, gamma_range, tolerance)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of list and boolean matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3304079"}]}