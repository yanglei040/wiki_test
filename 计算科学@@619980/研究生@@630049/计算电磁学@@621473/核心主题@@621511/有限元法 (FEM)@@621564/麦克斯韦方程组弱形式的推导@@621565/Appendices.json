{"hands_on_practices": [{"introduction": "本练习旨在解决计算完美导电腔体谐振频率的经典问题。通过为亥姆霍兹方程（curl-curl）特征值问题推导其弱形式，您将直面一个常见的数值陷阱：非物理“伪”模式的出现。这项实践对于理解如何施加高斯定律等潜在的物理约束，以确保数值解的稳定性和准确性至关重要。[@problem_id:3297829]", "problem": "一个有界单连通的腔域 $\\Omega \\subset \\mathbb{R}^3$，其具有 Lipschitz 边界 $\\partial \\Omega$，填充有非均匀但一致有界的对称正定电容率张量场 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和磁导率张量场 $\\boldsymbol{\\mu}(\\mathbf{x})$。该边界是理想电导体 (PEC)，因此电场的切向分量为零。在无源、时谐条件下，根据高斯定律，电场是无散场，物理共振频率由一个旋度-旋度特征问题得到。仅从麦克斯韦方程组的无源、时谐形式、PEC 边界条件和标准的向量微积分恒等式出发，推导电场腔体特征问题的变分（弱）形式，该形式在一个合适的 Sobolev 空间中产生一个对称的特征值问题，并明确指出正确的本质边界条件。然后，解释一个数学上精确的程序，以消除位于旋度算子核中的梯度子空间，从而在相容离散化中避免伪零特征值。\n\n哪个选项正确地陈述了弱形式和消除梯度场的正确方法？\n\nA. 令 $V = H_0(\\mathrm{curl};\\Omega) \\equiv \\{\\mathbf{v}\\in H(\\mathrm{curl};\\Omega): \\mathbf{n}\\times \\mathbf{v} = \\mathbf{0}\\text{ on }\\partial \\Omega\\}$。特征问题是：求非零的 $(\\mathbf{E},\\lambda)\\in V\\times \\mathbb{R}_+$ 使得\n$$\na(\\mathbf{E},\\mathbf{v}) = \\lambda\\, m(\\mathbf{E},\\mathbf{v}) \\quad \\forall \\mathbf{v}\\in V,\n$$\n其中\n$$\na(\\mathbf{E},\\mathbf{v}) \\equiv \\int_{\\Omega} \\boldsymbol{\\mu}^{-1}(\\mathbf{x})\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\mathbf{x}, \n\\qquad\nm(\\mathbf{E},\\mathbf{v}) \\equiv \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{x})\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x}.\n$$\n为消除梯度场 $\\nabla \\phi$，使用到 $\\boldsymbol{\\varepsilon}$-无散子空间上的 $\\boldsymbol{\\varepsilon}$-加权 Helmholtz 投影 $P$：对任意 $\\mathbf{w}\\in L^2(\\Omega)^3$，求 $\\phi\\in H_0^1(\\Omega)$ 使得\n$$\n\\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} \\quad \\forall q\\in H_0^1(\\Omega),\n$$\n并设 $P\\mathbf{w} = \\mathbf{w} - \\nabla \\phi$。在 $P V$ 中求解特征问题（等价地，对所有 $q\\in H_0^1(\\Omega)$ 强制 $(\\boldsymbol{\\varepsilon} \\mathbf{E}, \\nabla q)=0$）。\n\nB. 令 $V = H(\\mathrm{curl};\\Omega)$，不加本质边界条件。对二阶方程进行分部积分以获得边界项，并在 $\\partial \\Omega$ 上施加自然边界条件 $\\mathbf{n}\\times (\\boldsymbol{\\mu}^{-1}\\nabla \\times \\mathbf{E})=\\mathbf{0}$。通过求解以下方程得到 $\\phi\\in H_0^1(\\Omega)$ 来投影梯度场\n$$\n\\int_{\\Omega} \\boldsymbol{\\mu}^{-1}\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\boldsymbol{\\mu}^{-1}\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} \\quad \\forall q\\in H_0^1(\\Omega),\n$$\n并定义映射 $\\mathbf{w}\\mapsto \\mathbf{w}-\\nabla \\phi$。\n\nC. 令 $V = H_0(\\mathrm{curl};\\Omega)$，并引入一个标量场 $p\\in H_0^1(\\Omega)$作为拉格朗日乘子，以在 $\\boldsymbol{\\varepsilon}$-内积下强制与梯度正交。混合特征问题是：求非零的 $(\\mathbf{E},p,\\lambda)\\in V\\times H_0^1(\\Omega)\\times \\mathbb{R}_+$ 使得\n$$\n\\int_{\\Omega} \\boldsymbol{\\mu}^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, (\\nabla p)\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x} \\quad \\forall \\mathbf{v}\\in V,\n$$\n$$\n\\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{E}\\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} = 0 \\quad \\forall q\\in H_0^1(\\Omega).\n$$\n这强制了对所有 $q$ 都有 $(\\boldsymbol{\\varepsilon} \\mathbf{E}, \\nabla q)=0$，从而消除了梯度场。\n\nD. 令 $V = H_0^1(\\Omega)^3$ 并施加本质边界条件 $\\mathbf{E}=\\mathbf{0}$ 于 $\\partial \\Omega$ 上。使用对称双线性形式\n$$\na(\\mathbf{E},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\mu}^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\mathbf{x}, \n\\qquad \nm(\\mathbf{E},\\mathbf{v}) = \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x},\n$$\n并注意到不需要投影，因为梯度场已被 $V$ 排除。\n\nE. 令 $V = H_0(\\mathrm{curl};\\Omega)$ 并添加一个弱形式强制 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E})=0$ 的罚项：对于固定的 $\\alpha>0$，求解\n$$\n\\int_{\\Omega} \\boldsymbol{\\mu}^{-1}\\, (\\nabla \\times \\mathbf{E})\\cdot (\\nabla \\times \\mathbf{v})\\, \\mathrm{d}\\mathbf{x} + \\alpha \\int_{\\Omega} \\big(\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E})\\big)\\, \\big(\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{v})\\big)\\, \\mathrm{d}\\mathbf{x}\n= \\lambda \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{E}\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x}\n$$\n对所有 $\\mathbf{v}\\in V$ 成立。这对于任何有限的 $\\alpha$ 都能精确地投影掉梯度场，并产生没有伪零特征值的正确谱。", "solution": "该问题陈述是计算电磁学中一个有效且适定的问题。它描述了在一个带有理想电导体（PEC）壁的无源腔体中确定共振频率的问题，这是一个经典的特征值问题。材料属性、区域和边界条件都是标准的。任务是推导弱形式，并解释如何处理旋度算子在数值上存在问题的核。\n\n让我们从第一性原理开始推导。\n\n无源、时谐的麦克斯韦方程组，对于电场 $\\mathbf{E}$ 和磁场 $\\mathbf{H}$ 如下：\n$$\n\\nabla \\times \\mathbf{E} = -i\\omega \\boldsymbol{\\mu}(\\mathbf{x}) \\mathbf{H} \\quad (1)\n$$\n$$\n\\nabla \\times \\mathbf{H} = i\\omega \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\mathbf{E} \\quad (2)\n$$\n其中 $\\omega$ 是角频率，$\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 分别是电容率和磁导率张量，它们被给定为对称且正定的。\n\n从方程(1)，假设存在非平凡的时谐场（即 $\\omega \\neq 0$），我们可以用 $\\mathbf{E}$ 来表示 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\frac{i}{\\omega} \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) (\\nabla \\times \\mathbf{E})\n$$\n这里，$\\boldsymbol{\\mu}^{-1}$ 表示磁导率张量的逆。将这个 $\\mathbf{H}$ 的表达式代入方程（2），得到电场 $\\mathbf{E}$ 的旋度-旋度方程：\n$$\n\\nabla \\times \\left( \\frac{i}{\\omega} \\boldsymbol{\\mu}^{-1} (\\nabla \\times \\mathbf{E}) \\right) = i\\omega \\boldsymbol{\\varepsilon} \\mathbf{E}\n$$\n乘以 $\\omega/i$ 并重新整理，得到特征值问题的强形式：\n$$\n\\nabla \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) = \\omega^2 \\boldsymbol{\\varepsilon} \\mathbf{E}\n$$\n我们定义特征值为 $\\lambda = \\omega^2$。\n\n为推导变分（弱）形式，我们乘以一个向量测试函数 $\\mathbf{v}$ 并在区域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\mathbf{v} \\cdot \\left( \\nabla \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\right) \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} \\mathbf{v} \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\mathrm{d}\\mathbf{x}\n$$\n我们对左边应用向量微积分恒等式 $\\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B}) = (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{B} - \\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B})$，其中 $\\mathbf{A} = \\mathbf{v}$ 且 $\\mathbf{B} = \\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}$。这得到：\n$$\n\\int_{\\Omega} (\\nabla \\times \\mathbf{v}) \\cdot (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\mathrm{d}\\mathbf{x} - \\int_{\\Omega} \\nabla \\cdot (\\mathbf{v} \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E})) \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\mathbf{v} \\mathrm{d}\\mathbf{x}\n$$\n对左侧第二项使用散度定理，并利用向量恒等式 $\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c}) = (\\mathbf{a} \\times \\mathbf{b}) \\cdot \\mathbf{c}$，我们将体积分转化为边界 $\\partial \\Omega$ 上的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\mathbf{v} \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E})) \\mathrm{d}\\mathbf{x} = \\oint_{\\partial \\Omega} (\\mathbf{v} \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E})) \\cdot \\mathbf{n} \\mathrm{d}S = \\oint_{\\partial \\Omega} (\\mathbf{n} \\times \\mathbf{v}) \\cdot (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\mathrm{d}S\n$$\n对于旋度平方可积的场，合适的函数空间是 Sobolev 空间 $H(\\mathrm{curl};\\Omega) = \\{\\mathbf{u} \\in (L^2(\\Omega))^3 : \\nabla \\times \\mathbf{u} \\in (L^2(\\Omega))^3\\}$。在理想电导体（PEC）上的物理边界条件是电场的切向分量为零：$\\mathbf{n} \\times \\mathbf{E}|_{\\partial \\Omega} = \\mathbf{0}$。这是一个本质边界条件，因此必须被构建到试探函数 $\\mathbf{E}$ 的函数空间中，并且为了对称性，也要构建到测试函数 $\\mathbf{v}$ 的函数空间中。因此，正确的空间是 $V = H_0(\\mathrm{curl};\\Omega) = \\{\\mathbf{v} \\in H(\\mathrm{curl};\\Omega) : \\mathbf{n} \\times \\mathbf{v} = \\mathbf{0} \\text{ on } \\partial \\Omega\\}$。由于 $\\mathbf{v} \\in V$，其切向分量 $\\mathbf{n} \\times \\mathbf{v}$ 在 $\\partial \\Omega$ 上为零，导致边积分为零。\n\n得到的弱形式为：求非零的 $(\\mathbf{E}, \\lambda) \\in V \\times \\mathbb{R}_+$ 使得\n$$\n\\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{v}) \\mathrm{d}\\mathbf{x} = \\lambda \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\mathbf{v} \\mathrm{d}\\mathbf{x} \\quad \\forall \\mathbf{v} \\in V\n$$\n这可以写成 $a(\\mathbf{E}, \\mathbf{v}) = \\lambda m(\\mathbf{E}, \\mathbf{v})$，其中对称双线性形式为：\n$$\na(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v}) \\mathrm{d}\\mathbf{x}\n$$\n$$\nm(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{u}) \\cdot \\mathbf{v} \\mathrm{d}\\mathbf{x}\n$$\n旋度算子的核是所有梯度场的集合，即 $\\{\\nabla \\phi\\}$。任何形式为 $\\mathbf{E} = \\nabla \\phi$ 的试探函数，其中 $\\phi \\in H_0^1(\\Omega)$（使得在 $\\partial\\Omega$上$\\mathbf{n}\\times\\nabla\\phi = \\mathbf{0}$），都在 $V$ 中并且有 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。这使得左侧的 $a(\\nabla \\phi, \\mathbf{v})$ 对任何 $\\mathbf{v}$ 都等于 $0$。特征值方程变为 $0 = \\lambda m(\\nabla \\phi, \\mathbf{v})$。对于 $\\lambda \\ne 0$，这意味着对所有 $\\mathbf{v}$ 都有 $m(\\nabla \\phi, \\mathbf{v})=0$，这意味着 $\\nabla \\phi = \\mathbf{0}$。然而，如果 $\\lambda = 0$，方程 $0=0$ 对任何 $\\nabla\\phi$ 都成立。这意味着整个无限维空间 $\\nabla H_0^1(\\Omega)$ 是 $\\lambda=0$ 的一个特征空间，这在数值离散化中会导致伪零特征值。\n\n物理上有意义的解还必须满足电介质的高斯定律，$\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = 0$。其弱形式为，对所有光滑的 $q$，$\\int_{\\Omega} q \\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\mathrm{d}\\mathbf{x} = 0$。分部积分后，这等价于要求解 $\\mathbf{E}$ 在 $\\boldsymbol{\\varepsilon}$-加权内积下与梯度场正交：\n$$\n\\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\nabla q \\mathrm{d}\\mathbf{x} = 0 \\quad \\forall q \\in H_0^1(\\Omega)\n$$\n这个约束正确地滤掉了非物理的梯度场。有两种标准方法来强制执行此约束。\n1.  **正交投影：** 将空间 $V$分解为无散部分和梯度部分，$V = V_S \\oplus \\nabla H_0^1(\\Omega)$，其中该和是关于 $m(\\cdot,\\cdot)$ 内积正交的。我们可以通过找到一个 $\\phi \\in H_0^1(\\Omega)$，使得 $\\mathbf{w} - \\nabla \\phi$与 $\\nabla H_0^1(\\Omega)$ 正交，从而将任何函数 $\\mathbf{w} \\in V$显式地投影到 $V_S$ 上。这导致需要为每个待投影的函数求解一个关于 $\\phi$ 的类泊松方程。\n2.  **拉格朗日乘子：** 引入一个拉格朗日乘子 $p \\in H_0^1(\\Omega)$，在一个混合形式中强制执行约束 $\\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\nabla q \\mathrm{d}\\mathbf{x} = 0$。\n\n现在我们评估给定的选项。\n\n**A.** 这个选项正确地陈述了函数空间 $V = H_0(\\mathrm{curl};\\Omega)$ 和双线性形式 $a(\\cdot,\\cdot)$ 与 $m(\\cdot,\\cdot)$，这与我们的推导相符。它接着描述了用于消除梯度场的正交投影法。该过程涉及通过求解一个泊松方程的弱形式来找到 $\\phi \\in H_0^1(\\Omega)$：$\\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\nabla \\phi \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{w} \\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x}$。这个方程正确地说明了 $\\mathbf{w}$ 到梯度空间上的投影 $\\nabla\\phi$ 是这样的，即残差 $\\mathbf{w}-\\nabla\\phi$ 关于 $\\boldsymbol{\\varepsilon}$-加权内积与梯度空间正交。这是进行 $\\boldsymbol{\\varepsilon}$-加权 Helmholtz-Hodge 投影的正确程序。得到的特征问题随后在正确定义的无散子空间中求解。结论：**正确**。\n\n**B.** 这个选项错误地建议使用 $V = H(\\mathrm{curl};\\Omega)$ 且不加本质边界条件，而是施加一个自然边界条件 $\\mathbf{n}\\times (\\boldsymbol{\\mu}^{-1}\\nabla \\times \\mathbf{E})=\\mathbf{0}$。这对应于理想磁导体，而不是理想电导体。PEC 条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 对于此问题形式是必不可少的。此外，它建议使用基于 $\\boldsymbol{\\mu}^{-1}$-加权内积的投影来消除梯度。约束 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = 0$ 要求相对于由 $m(\\cdot, \\cdot)$ 形式定义的 $\\boldsymbol{\\varepsilon}$-加权内积正交。使用错误的加权无法强制执行物理约束。结论：**不正确**。\n\n**C.** 这个选项正确地识别了空间 $V=H_0(\\mathrm{curl};\\Omega)$ 并提出了一个带有拉格朗日乘子 $p \\in H_0^1(\\Omega)$ 的混合形式。第二个方程 $\\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, \\mathbf{E}\\cdot \\nabla q\\, \\mathrm{d}\\mathbf{x} = 0$ 直接对 $\\mathbf{E}$ 施加了所需的弱无散约束。第一个方程用项 $\\int_{\\Omega} \\boldsymbol{\\varepsilon}\\, (\\nabla p)\\cdot \\mathbf{v}\\, \\mathrm{d}\\mathbf{x}$ 增强了原始问题。对于非零特征值 $\\lambda$，该形式正确地意味着 $p=0$ 并得到约束（物理）子空间中的特征对 $(\\mathbf{E}, \\lambda)$。这是强制执行散度约束和消除伪模式的一种标准有效方法。结论：**正确**。\n\n**D.** 这个选项建议使用函数空间 $V = H_0^1(\\Omega)^3$。这在 $\\partial \\Omega$ 上施加了边界条件 $\\mathbf{E} = \\mathbf{0}$，这在物理上是不正确的，而且限制性过强。在 PEC 表面上，$\\mathbf{E}$ 的法向分量通常不为零。因此，这种形式没有模拟正确的物理问题。声称该空间排除了梯度场也不是在旋度-旋度问题背景下避免伪模式的恰当理由。结论：**不正确**。\n\n**E.** 这个选项提出了一种罚方法。该形式增加了一个项 $\\alpha \\int_{\\Omega} \\big(\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E})\\big)\\, \\big(\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{v})\\big)\\, \\mathrm{d}\\mathbf{x}$。这个项没有被很好地定义，因为对于一个一般的函数 $\\mathbf{v} \\in H(\\mathrm{curl};\\Omega)$，它的散度不保证在 $L^2(\\Omega)$ 中，因此积分可能不存在。此外，对于有限的罚参数 $\\alpha$，罚方法只近似地强制执行约束，只有在极限 $\\alpha \\to \\infty$ 时才精确执行。声称这种方法对于*任何有限的* $\\alpha$ 都能*精确地*投影掉梯度场是错误的。罚方法通常将伪特征值移至大的非零值，而不是消除它们。结论：**不正确**。\n\n选项A和C都提出了解决所述问题的数学上合理且标准的方法。", "answer": "$$\\boxed{AC}$$", "id": "3297829"}, {"introduction": "从特征值问题转向源驱动场景，本练习将探讨材料属性如何影响弱形式的数学结构。您将分析导致问题不定性的条件，尤其是在无损介质接近谐振时的情况，并理解其对解的存在性和唯一性的影响。这项练习突显了问题物理特性（例如，材料损耗）与选择合适数值求解器之间的关键联系。[@problem_id:3297806]", "problem": "考虑一个有界 Lipschitz 区域 $\\Omega \\subset \\mathbb{R}^3$，其中包含一种线性、均匀、各向同性的介质，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，电导率为 $\\sigma$。设时谐约定为 $e^{i \\omega t}$，角频率 $\\omega > 0$。源是给定的外加电流密度 $\\mathbf{J} \\in L^2(\\Omega)^3$。电场 $\\mathbf{E}$ 和磁场 $\\mathbf{H}$ 满足宏观麦克斯韦方程组\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}, \\qquad\n\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}\n$$\n在 $\\Omega$ 中，以及理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ on $\\partial \\Omega$，其中 $\\mathbf{n}$ 是 $\\partial \\Omega$ 的单位外法向量。利用这些定律和定义，通过消去 $\\mathbf{H}$ 并使用适当的、强制施加 PEC 边界条件的 $H(\\mathrm{curl})$ 协调空间中的函数 $\\mathbf{v}$ 进行检验，推导出 $\\mathbf{E}$ 的弱形式。然后，从得到的弱形式出发进行推理，以确定相关的半双线性形式何时是不定的或奇异的，并解释这对适定性（唯一性和稳定性）以及在有限元方法 (FEM) 中对数值求解器的选择有何影响。\n\n下列陈述中哪些是正确的？\n\nA. 在一个有界、单连通的空腔中，若 $\\sigma = 0$，实数 $\\varepsilon > 0$，实数 $\\mu > 0$，且边界为 PEC，则弱旋度-旋度形式在 $H_0(\\mathrm{curl}; \\Omega)$ 上是强制的；因此，离散系统是对称正定的，共轭梯度 (CG) 法无条件收敛。\n\nB. 在一个无损耗空腔中（即 $\\sigma = 0$，$\\varepsilon, \\mu$ 为实数），当 $\\omega$ 与空腔的某个本征频率重合时，与弱形式相关的算子是奇异的；引入一个小的电导率 $\\sigma > 0$（等效于介电常数中存在正的虚部）会产生一个复值半双线性形式，该形式在经过适当的相位旋转后是强制的，从而恢复唯一性并稳定数值解。\n\nC. 对于有损耗介质，即 $\\mathrm{Im}(\\varepsilon) > 0$ 或 $\\sigma > 0$，离散系统通常是非厄米 (non-Hermitian) 的；专为非厄米矩阵设计的克雷洛夫 (Krylov) 方法，如广义最小残差 (GMRES) 法是合适的，而共轭梯度 (CG) 法不适用。\n\nD. $H_0(\\mathrm{curl}; \\Omega)$ 中作为旋度算子的非平凡核而存在的梯度场，意味着弱形式是正定的；即使在接近共振时，也不需要稳定化或预处理。\n\nE. 使用 Nédélec 边元来遵循 $H(\\mathrm{curl})$ 协调性，并通过增加散度约束或规范稳定化来增强该形式，可以抑制伪模；在接近共振时，近似麦克斯韦算子并强制施加 inf-sup 条件的块预处理器能提高鲁棒性。\n\n选择所有适用项。", "solution": "出发点是在 $e^{i\\omega t}$ 约定下的频域中的基本宏观麦克斯韦方程组：\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}, \\qquad\n\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}.\n$$\n我们考虑理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ on $\\partial \\Omega$，并在空间 $H_0(\\mathrm{curl}; \\Omega) := \\{ \\mathbf{u} \\in H(\\mathrm{curl}; \\Omega) : \\mathbf{n} \\times \\mathbf{u} = \\mathbf{0} \\text{ on } \\partial \\Omega \\}$ 中求解 $\\mathbf{E}$。\n\n通过将第二个方程中的 $\\mathbf{H}$ 代入第一个方程来消去 $\\mathbf{H}$。从 $\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}$，我们得到\n$$\n\\mathbf{H} = \\frac{i}{\\omega \\mu} \\nabla \\times \\mathbf{E}.\n$$\n代入 $\\nabla \\times \\mathbf{H}$：\n$$\n\\nabla \\times \\mathbf{H} = \\nabla \\times \\left( \\frac{i}{\\omega \\mu} \\nabla \\times \\mathbf{E} \\right) = \\frac{i}{\\omega} \\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right).\n$$\n因此，$\\mathbf{E}$ 的强形式为\n$$\n\\frac{i}{\\omega} \\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) = \\mathbf{J} + \\sigma \\mathbf{E} + i \\omega \\varepsilon \\mathbf{E}.\n$$\n两边同乘以 $-i \\omega$ 以获得标准的旋度-旋度方程：\n$$\n\\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) - \\omega^2 \\varepsilon \\mathbf{E} - i \\omega \\sigma \\mathbf{E} = i \\omega \\mathbf{J}.\n$$\n为了推导弱形式，取一个测试函数 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$，乘以其复共轭 $\\overline{\\mathbf{v}}$，并在 $\\Omega$ 上积分。使用向量微积分恒等式以及 $\\mathbf{E}$ 和 $\\mathbf{v}$ 在 $\\partial \\Omega$ 上的切向分量为零（这通过分部积分消除了边界项），我们得到半双线性形式 $a(\\cdot,\\cdot)$ 和线性形式 $f(\\cdot)$:\n$$\na(\\mathbf{E}, \\mathbf{v}) := \\int_{\\Omega} \\mu^{-1} \\left( \\nabla \\times \\mathbf{E} \\right) \\cdot \\overline{ \\left( \\nabla \\times \\mathbf{v} \\right)} \\, \\mathrm{d}x - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}x - i \\omega \\int_{\\Omega} \\sigma \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}x,\n$$\n$$\nf(\\mathbf{v}) := i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}x.\n$$\n弱问题是：找到 $\\mathbf{E} \\in H_0(\\mathrm{curl}; \\Omega)$，使得\n$$\na(\\mathbf{E}, \\mathbf{v}) = f(\\mathbf{v}) \\quad \\text{for all } \\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega).\n$$\n\n无损耗情况下的不定性（$\\sigma = 0$，实数 $\\varepsilon > 0$，实数 $\\mu > 0$）。半双线性形式简化为\n$$\na_0(\\mathbf{E}, \\mathbf{v}) := \\int_{\\Omega} \\mu^{-1} \\left( \\nabla \\times \\mathbf{E} \\right) \\cdot \\overline{ \\left( \\nabla \\times \\mathbf{v} \\right)} \\, \\mathrm{d}x - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\mathbf{E} \\cdot \\overline{\\mathbf{v}} \\, \\mathrm{d}x.\n$$\n考虑对于 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$ 的二次型 $a_0(\\mathbf{v}, \\mathbf{v})$：\n$$\na_0(\\mathbf{v}, \\mathbf{v}) = \\int_{\\Omega} \\mu^{-1} \\left| \\nabla \\times \\mathbf{v} \\right|^2 \\, \\mathrm{d}x - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\left| \\mathbf{v} \\right|^2 \\, \\mathrm{d}x.\n$$\n两个结构特性导致不定性：\n- $H_0(\\mathrm{curl}; \\Omega)$ 上旋度算子的核包含梯度场。具体来说，对于任何 $\\phi \\in H_0^1(\\Omega)$，$\\mathbf{v} = \\nabla \\phi$ 满足 $\\mathbf{v} \\in H_0(\\mathrm{curl}; \\Omega)$ 且 $\\nabla \\times \\mathbf{v} = \\mathbf{0}$。于是\n$$\na_0(\\nabla \\phi, \\nabla \\phi) = - \\omega^2 \\int_{\\Omega} \\varepsilon \\, \\left| \\nabla \\phi \\right|^2 \\, \\mathrm{d}x < 0 \\quad \\text{for } \\nabla \\phi \\neq \\mathbf{0}.\n$$\n因此，$a_0$ 在梯度子空间上是负的。\n- 在具有非零旋度的无散子空间上，对于足够小的 $\\omega$ 或对于旋度相对于其 $L^2$ 范数较大的函数，第一项可以主导第二项，从而得到 $a_0(\\mathbf{v}, \\mathbf{v}) > 0$。\n\n因此，$a_0$ 是厄米 (Hermitian) 的且强不定的，并且在 $H_0(\\mathrm{curl}; \\Omega)$ 上强制性不成立，因为无法用 $a_0(\\mathbf{v}, \\mathbf{v})$ 一致地界定 $\\left\\| \\mathbf{v} \\right\\|_{H(\\mathrm{curl})}^2$。特别是，当存在梯度场时，没有庞加莱 (Poincaré) 型不等式能仅通过旋度来控制 $\\mathbf{v}$ 的 $L^2$ 范数。\n\n共振和奇异性。齐次无损耗问题（$\\mathbf{J} = \\mathbf{0}$，$\\sigma = 0$）简化为特征值方程\n$$\n\\nabla \\times \\left( \\mu^{-1} \\nabla \\times \\mathbf{E} \\right) = \\omega^2 \\varepsilon \\mathbf{E}\n$$\n以及 PEC 边界条件。非平凡解 $\\mathbf{E} \\neq \\mathbf{0}$ 恰好在空腔本征频率处存在；在这些 $\\omega$ 处，算子是奇异的，非齐次问题可能没有唯一解，或者在离散化后变得病态。\n\n损耗的影响（$\\sigma > 0$ 或 $\\mathrm{Im}(\\varepsilon) > 0$）。当 $\\sigma > 0$ 时，半双线性形式有一个额外的严格耗散部分：\n$$\n\\mathrm{Im}\\, a(\\mathbf{v}, \\mathbf{v}) = \\omega \\int_{\\Omega} \\sigma \\, \\left| \\mathbf{v} \\right|^2 \\, \\mathrm{d}x \\ge \\omega \\sigma_{\\min} \\left\\| \\mathbf{v} \\right\\|_{L^2(\\Omega)}^2,\n$$\n其中 $\\sigma_{\\min}$ 是 $\\sigma$ 在 $\\Omega$ 上的一个正常数下界。通过将方程乘以一个相位因子 $e^{i \\theta}$（一种处理复半双线性形式的标准技术），可以将不定的实部旋转到虚轴上，并利用正的虚部来建立一个强制性（或 inf-sup）不等式，形式为\n$$\n\\left| a(\\mathbf{v}, \\mathbf{v}) \\right| \\ge c \\, \\left\\| \\mathbf{v} \\right\\|_{H(\\mathrm{curl}; \\Omega)}^2 \\quad \\text{for some } c > 0,\n$$\n这与 $a(\\cdot,\\cdot)$ 的有界性一起，通过 Babuška–Nečas 定理意味着唯一性和稳定性。在离散形式中，由于耗散项，矩阵通常变为复数且非厄米的。\n\n对数值方法的影响。在具有实系数的无损耗情况下，使用 $H(\\mathrm{curl})$ 协调的 Nédélec 单元离散化后的算子是厄米不定的；适用于对称不定系统的克雷洛夫求解器，如最小残差法 (MINRES)，是合适的，而共轭梯度 (CG) 法要求正定性，因此不适用。在有损耗或有吸收边界条件（例如，完美匹配层，它也引入了非厄米性）的情况下，矩阵变为非厄米，广义最小残差法 (GMRES) 或相关方法是合适的。鲁棒性和效率进一步要求预处理器尊重 $H(\\mathrm{curl})$ 结构和离散亥姆霍兹分解（例如，块预处理器和基于 Hiptmair–Xu 算子的 $H(\\mathrm{curl})$ 求解器）。稳定化策略，例如增加一个散度惩罚项或使用拉格朗日乘子的混合形式来强制 $\\nabla \\cdot (\\varepsilon \\mathbf{E}) = 0$，有助于抑制伪梯度模。\n\n逐项分析：\n\nA. 该选项声称无损耗弱形式在 $H_0(\\mathrm{curl}; \\Omega)$ 上具有强制性，并且 CG 法适用。如前所示，$a_0(\\cdot,\\cdot)$ 是厄米且强不定的：梯度场导致 $a_0(\\nabla \\phi,\\nabla \\phi) < 0$，强制性不成立。离散矩阵不是对称正定的；CG 法不适用。结论：错误。\n\nB. 在无损耗空腔的本征频率处，算子是奇异的（具有非平凡核）。引入 $\\sigma > 0$ 会增加一个严格的耗散项 $- i \\omega \\sigma \\int \\mathbf{E} \\cdot \\overline{\\mathbf{v}}$，从而得到一个对角线上具有正虚部的复半双线性形式，这使得在经过相位旋转后能够建立强制性（或 inf-sup）不等式，恢复了唯一性并改善了条件数。结论：正确。\n\nC. 当 $\\mathrm{Im}(\\varepsilon) > 0$ 或 $\\sigma > 0$ 时，离散矩阵通常是复数且非厄米的。适用于非厄米系统的克雷洛夫方法，如广义最小残差法 (GMRES)，是合适的；共轭梯度 (CG) 法仅限于厄米正定矩阵，此处不适用。结论：正确。\n\nD. 旋度核中梯度场的存在并不意味着正定性；它贡献了在无损耗情况下 $a_0(\\mathbf{v}, \\mathbf{v})$ 为负的方向，从而加剧了不定性，并说明了需要稳定化或适当的预处理，尤其是在接近共振时。结论：错误。\n\nE. Nédélec 边元确保了 $H(\\mathrm{curl})$ 协调性，并保持了精确序列结构，这对于避免伪模至关重要。通过增加散度约束或规范稳定化来增强形式，可以抑制无旋的伪分量。在接近共振时，近似麦克斯韦算子并遵循 inf-sup 结构的块预处理器能提高鲁棒性和收敛性。结论：正确。", "answer": "$$\\boxed{BCE}$$", "id": "3297806"}, {"introduction": "这项高级实践旨在解决使用完美匹配层（PML）模拟无界开放区域问题的挑战。您将为一个包含复杂各向异性材料张量的系统（这是PML的典型特征）推导并构建其弱形式。通过这项练习，您将巩固如何使用Nédélec棱边元和散度稳定等专业工具，为复杂的真实世界电磁仿真建立稳定且精确的有限元模型。[@problem_id:3297838]", "problem": "考虑在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$ 中的时谐麦克斯韦方程组，采用 $e^{i \\omega t}$ 约定。该域被分解为一个物理子域 $\\Omega_{\\mathrm{phys}}$ 和一个完美匹配层 (PML) 子域 $\\Omega_{\\mathrm{PML}}$，满足 $\\overline{\\Omega} = \\overline{\\Omega_{\\mathrm{phys}}} \\cup \\overline{\\Omega_{\\mathrm{PML}}}$ 且 $\\Omega_{\\mathrm{phys}} \\cap \\Omega_{\\mathrm{PML}} = \\emptyset$。令 $\\mathbf{E} : \\Omega \\to \\mathbb{C}^3$ 表示电场，令 $\\mathbf{J} : \\Omega \\to \\mathbb{C}^3$ 为给定的外加电流密度，在 $\\Omega_{\\mathrm{phys}}$ 中满足 $\\nabla \\cdot \\mathbf{J} = 0$。在外边界 $\\partial \\Omega$ 上，假设为理想电导体 (PEC) 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$，其中 $\\mathbf{n}$ 是单位外法向量。\n\n在频域中，$\\Omega$ 内的控制方程强形式为\n$$\n\\nabla \\times \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E}(\\mathbf{x}) \\big) \\;-\\; \\omega^2 \\, \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E}(\\mathbf{x})\n\\;=\\; i \\omega \\, \\mathbf{J}(\\mathbf{x}) \\quad \\text{in } \\Omega,\n$$\n其本构张量 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 有界且分片光滑。在 $\\Omega_{\\mathrm{phys}}$ 中，假设 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 是实、对称且一致正定的。在 $\\Omega_{\\mathrm{PML}}$ 中，它们是由复坐标伸展引起的复值各向异性张量，并且满足强椭圆性，即存在常数 $c_\\varepsilon, c_\\mu > 0$，使得对于所有 $\\mathbf{u}, \\boldsymbol{\\xi} \\in \\mathbb{C}^3$ 和几乎所有 $\\mathbf{x} \\in \\Omega_{\\mathrm{PML}}$，\n$$\n\\mathrm{Re}\\!\\left( \\mathbf{u} \\cdot \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\overline{\\mathbf{u}} \\right) \\;\\ge\\; c_\\varepsilon \\, \\lVert \\mathbf{u} \\rVert^2, \n\\qquad\n\\mathrm{Re}\\!\\left( \\boldsymbol{\\xi} \\cdot \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\overline{\\boldsymbol{\\xi}} \\right) \\;\\ge\\; c_\\mu \\, \\lVert \\boldsymbol{\\xi} \\rVert^2.\n$$\n\n仅使用基本定律和核心定义，推导适用于在 $\\Omega$ 的四面体网格上使用多项式次数为 $p \\ge 1$ 的第一类 Nédélec 边元进行近似的弱形式，并仔细说明函数空间设定、边界项处理方式，以及来自 PML 的复各向异性系数如何进入半双线性形式。然后，从下面选择一种组装策略，该策略在使用第一类 Nédélec 边元和标准 Gaussian 求积时，能保持稳定性（在所述假设下没有伪梯度模式和适定的离散问题）和精度（在存在空间变化的复各向异性系数时具有高阶一致性）。\n\n哪个选项是正确的？\n\nA. 使用边元空间 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，该空间由次数为 $p$ 且在 $\\partial \\Omega$ 上切向迹为零的第一类 Nédélec 函数构成。组装在第一个参数上线性、在第二个参数上反线性的半双线性形式：\n$$\na(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\mathbf{x}\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x}\n\\;+\\; \\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} ) \\big) \\, \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{v} ) \\big) } \\, d\\mathbf{x},\n$$\n其中稳定化参数 $\\eta > 0$ 与 $h$ 无关，并选择得足够小以免污染精度。使用线性泛函\n$$\n\\ell(\\mathbf{v}) \\;=\\; i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x}.\n$$\n通过 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 强加 PEC 边界条件，因此不出现边界项。在求积点处计算复各向异性张量 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$ 的值，并且不对它们进行共轭；采用足够精确的求积（例如，阶数至少为 $2p$）以捕捉其空间变化和多项式乘积。\n\nB. 使用不带本质边界条件的边元空间 $\\mathbf{V}_h \\subset \\mathbf{H}(\\mathrm{curl}; \\Omega)$，并通过添加分部积分产生的边界项来弱施加 PEC 边界。组装一个在两个参数上都线性的双线性形式，并通过对 PML 系数进行共轭使其“Hermitian化”：\n$$\n\\tilde{a}(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\overline{\\boldsymbol{\\mu}^{-1}}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E} \\big) \\cdot \\nabla \\times \\mathbf{v} \\, d\\mathbf{x}\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\overline{\\boldsymbol{\\varepsilon}}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\mathbf{v} \\, d\\mathbf{x},\n$$\n没有稳定化项，也不对测试函数进行复共轭。忽略散度约束，因为 $\\nabla \\cdot \\mathbf{J} = 0$。\n\nC. 用次数为 $p$ 的连续 Lagrange 节点元 $\\mathbf{W}_h \\subset \\mathbf{H}^1(\\Omega)$ 替换边元，并通过对旋度施加罚项来强制切向连续性：\n$$\n\\hat{a}(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\alpha \\int_{\\Omega} (\\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\mathbf{x}\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x},\n$$\n其中选择较大的 $\\alpha > 0$，并将各向异性 PML 近似为其各向同性平均值以简化求积。不使用散度稳定化。\n\nD. 使用第一类 Nédélec 边元 $\\mathbf{V}_h \\subset \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 但组装以下形式：\n$$\na_D(\\mathbf{E}, \\mathbf{v}) \\;=\\; \\int_{\\Omega} \\big( \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{ \\boldsymbol{\\mu}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{v} } \\, d\\mathbf{x}\n\\;-\\; \\omega^2 \\int_{\\Omega} \\big( \\mathrm{Re}\\,\\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E} \\big) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x},\n$$\n丢弃 PML 张量的虚部以改善条件数，并省略任何与散度相关的稳定化。通过函数空间强加 PEC，使边界项消失。\n\n选择正确反映了在使用边元处理复各向异性 PML 系数时，弱形式的稳定和精确组装的选项。", "solution": "问题要求给出在使用第一类 Nédélec 边元求解包含完美匹配层 (PML) 的区域中的时谐麦克斯韦方程组时，正确的弱形式和组装策略。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n*   **控制方程（强形式）：**\n    $$ \\nabla \\times \\big( \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{E}(\\mathbf{x}) \\big) \\;-\\; \\omega^2 \\, \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\mathbf{E}(\\mathbf{x}) \\;=\\; i \\omega \\, \\mathbf{J}(\\mathbf{x}) \\quad \\text{in } \\Omega $$\n*   **域：** 一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^3$，其中 $\\Omega$ 是物理子域 $\\Omega_{\\mathrm{phys}}$ 和 PML 子域 $\\Omega_{\\mathrm{PML}}$ 的并集。\n*   **边界条件：** 在外边界 $\\partial \\Omega$ 上的理想电导体 (PEC) 条件，由 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$ 给出。\n*   **源：** 满足性质 $\\nabla \\cdot \\mathbf{J} = 0$ (在 $\\Omega_{\\mathrm{phys}}$ 中) 的外加电流密度 $\\mathbf{J}$。\n*   **本构张量：** $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}(\\mathbf{x})$ 有界且分片光滑。\n    *   在 $\\Omega_{\\mathrm{phys}}$ 中，它们是实、对称且一致正定的。\n    *   在 $\\Omega_{\\mathrm{PML}}$ 中，它们是满足强椭圆性条件的复值各向异性张量：\n      $$ \\mathrm{Re}\\!\\left( \\mathbf{u} \\cdot \\boldsymbol{\\varepsilon}(\\mathbf{x}) \\, \\overline{\\mathbf{u}} \\right) \\;\\ge\\; c_\\varepsilon \\, \\lVert \\mathbf{u} \\rVert^2, \\quad \\mathrm{Re}\\!\\left( \\boldsymbol{\\xi} \\cdot \\boldsymbol{\\mu}^{-1}(\\mathbf{x}) \\, \\overline{\\boldsymbol{\\xi}} \\right) \\;\\ge\\; c_\\mu \\, \\lVert \\boldsymbol{\\xi} \\rVert^2 $$\n*   **离散化：** 在四面体网格上使用次数为 $p \\ge 1$ 的第一类 Nédélec 边元。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述描述了计算电磁学中使用 PML 截断来建模开放区域问题的标准设置。控制方程是频域中正确的电场波动方程。本构张量的属性对于物理介质和功能性 PML 都是正确指定的。PEC 边界条件是标准的。所述任务是推导适用于一种特定、成熟的有限元类型（Nédélec 元）的弱形式。\n\n问题陈述中有一个微小的不一致之处：`$\\Omega_{\\mathrm{phys}} \\cap \\Omega_{\\mathrm{PML}} \\neq \\emptyset$`。在一个域的标准划分中，子域是不相交的开集，因此它们的交集为空。属性 $\\boldsymbol{\\varepsilon}$ 和 $\\boldsymbol{\\mu}$ 在 $\\Omega_{\\mathrm{phys}}$ 和 $\\Omega_{\\mathrm{PML}}$ 中定义不同，因此重叠会导致矛盾。假设这是一个印刷错误，实际应为标准划分 $\\Omega_{\\mathrm{phys}} \\cap \\Omega_{\\mathrm{PML}} = \\emptyset$，且它们的闭包覆盖了 $\\Omega$，那么这个问题是适定且科学上合理的。这个微小的不一致性不影响进行严格的分析。\n\n**步骤3：结论与行动**\n在标准解释下，即 $\\Omega$ 被划分为不相交的子域 $\\Omega_{\\mathrm{phys}}$ 和 $\\Omega_{\\mathrm{PML}}$，该问题是有效的。我们继续进行求解。\n\n### 弱形式的推导\n\n目标是找到一个适合用 Nédélec 边元近似的问题的弱形式。容纳旋度算子和切向边界条件的电场 $\\mathbf{E}$ 的自然函数空间是 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega) = \\{ \\mathbf{u} \\in \\mathbf{L}^2(\\Omega)^3 : \\nabla \\times \\mathbf{u} \\in \\mathbf{L}^2(\\Omega)^3, \\mathbf{n} \\times \\mathbf{u}|_{\\partial\\Omega} = \\mathbf{0} \\}$。\n\n我们采用 Galerkin 方法。我们寻求一个解 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，使得对于所有测试函数 $\\mathbf{v} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，下式成立：\n$$\n\\int_{\\Omega} \\left( \\nabla \\times \\big( \\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E} \\big) - \\omega^2 \\boldsymbol{\\varepsilon} \\mathbf{E} \\right) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x} = \\int_{\\Omega} (i \\omega \\mathbf{J}) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x}\n$$\n对测试函数 $\\mathbf{v}$ 取复共轭是为了定义复向量场的标准 $L^2$ 内积，这会导出一个半双线性形式（在第一个参数上线性，在第二个参数上反线性）。\n\n我们对第一项使用分部积分，利用向量恒等式 $\\nabla \\cdot (\\mathbf{A} \\times \\mathbf{B}) = (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{B} - \\mathbf{A} \\cdot (\\nabla \\times \\mathbf{B})$。令 $\\mathbf{A} = \\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}$ 且 $\\mathbf{B} = \\overline{\\mathbf{v}}$。\n$$\n\\int_{\\Omega} \\left( \\nabla \\times (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\right) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x} = \\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\overline{\\mathbf{v}}) \\, d\\mathbf{x} + \\int_{\\partial\\Omega} \\left( (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\times \\overline{\\mathbf{v}} \\right) \\cdot \\mathbf{n} \\, dS.\n$$\n边界积分可以使用标量三重积性质重写为 $\\int_{\\partial\\Omega} (\\mathbf{n} \\times \\overline{\\mathbf{v}}) \\cdot (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\, dS$。由于解和测试函数都在 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 中，它们的切向迹 $\\mathbf{n} \\times \\mathbf{v}$ 在 $\\partial\\Omega$ 上为零。因此，边界积分消失。\n\n得到的弱形式是：找到 $\\mathbf{E} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$，使得对于所有 $\\mathbf{v} \\in \\mathbf{H}_0(\\mathrm{curl}; \\Omega)$：\n$$\n\\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\mathbf{x} - \\omega^2 \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x} = i \\omega \\int_{\\Omega} \\mathbf{J} \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x}.\n$$\n\n**稳定性：** 半双线性形式 $a(\\mathbf{E}, \\mathbf{v}) = \\int_{\\Omega} (\\boldsymbol{\\mu}^{-1} \\nabla \\times \\mathbf{E}) \\cdot \\overline{\\nabla \\times \\mathbf{v}} \\, d\\mathbf{x} - \\omega^2 \\int_{\\Omega} (\\boldsymbol{\\varepsilon} \\mathbf{E}) \\cdot \\overline{\\mathbf{v}} \\, d\\mathbf{x}$ 在其离散版本中已知有一个大的核空间，对应于梯度场（伪模式），这些梯度场位于旋度算子的零空间中。这导致有限元矩阵的病态。\n\n为了确保稳定性，必须增强该形式以控制这些非物理模式。这可以通过强制执行散度条件 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = -\\frac{1}{i\\omega}\\nabla \\cdot \\mathbf{J}$ 来实现。由于 $\\mathbf{J}$ 是无散度的，这简化为 $\\nabla \\cdot (\\boldsymbol{\\varepsilon} \\mathbf{E}) = 0$。一种标准技术是在弱形式中添加一个罚项，以惩罚对该条件的违反。一个合适的稳定化半双线性形式是：\n$$\na_{\\text{stab}}(\\mathbf{E}, \\mathbf{v}) = a(\\mathbf{E}, \\mathbf{v}) + \\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{E} ) \\big) \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{v} ) \\big) } \\, d\\mathbf{x},\n$$\n其中 $\\eta > 0$ 是一个稳定化参数，通常是一个量级为 1 的常数。此项在梯度场的有问题子空间上增加了矫顽性，从而确保了一个适定的离散系统。\n\n**组装：** 对于使用次数为 $p$ 的 Nédélec 基函数的有限元实现，积分通过求积法进行数值计算。被积函数涉及最高次数为 $2p$ 的多项式乘积以及空间变化的复各向异性系数 $\\boldsymbol{\\varepsilon}(\\mathbf{x})$ 和 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$。为了保持精度，需要一个足够高阶的求积法则（例如，阶数 $2p$ 或更高）。来自算子的复系数 $\\boldsymbol{\\varepsilon}$ 和 $\\boldsymbol{\\mu}^{-1}$ 必须按原样计算，不进行共轭，因为它们是被离散化的线性算子的一部分。\n\n### 逐项分析\n\n**A. 正确。** 该选项提出的形式与推导出的稳定且精确的方法一致。\n- **函数空间：** 它正确地将离散空间 $\\mathbf{V}_h$ 识别为由第一类 Nédélec 函数构成的 $\\mathbf{H}_0(\\mathrm{curl}; \\Omega)$ 的一个子空间，这强加了 PEC 边界条件 $\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。\n- **半双线性形式：** 该形式被正确地定义为半双线性的（在第一个参数上线性，在第二个参数上反线性），并且与标准的弱形式相匹配。\n- **稳定化：** 它包含了对稳定性至关重要的散度稳定化项 $\\eta \\int_{\\Omega} \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{E} ) \\big) \\overline{ \\big( \\nabla \\cdot ( \\boldsymbol{\\varepsilon} \\mathbf{v} ) \\big) } \\, d\\mathbf{x}$。\n- **线性泛函：** 右侧的泛函 $\\ell(\\mathbf{v})$ 是正确的。\n- **组装：** 它正确地指出复系数不被共轭，并且需要高阶求积。整个过程对应于一种最先进的方法。\n\n**B. 错误。** 该选项包含几个基本错误。\n- **形式：** 它提出了一个双线性形式而不是半双线性形式，并且错误地对材料系数 ($\\overline{\\boldsymbol{\\mu}^{-1}}$, $\\overline{\\boldsymbol{\\varepsilon}}$) 进行了共轭，这不符合 Galerkin 过程。它还省略了对测试函数的共轭，这与标准的复内积不一致。\n- **边界条件：** 它建议弱施加边界条件，但没有在变分形式中包含必要的边界项。\n- **稳定化：** 它明确省略了稳定化项，这将导致一个遭受伪梯度模式困扰的病态、不稳定的离散系统。所提供的理由（`忽略散度约束，因为 $\\nabla \\cdot \\mathbf{J} = 0$`）是错误的。\n\n**C. 错误。** 该选项提出了一种完全不同且有缺陷的方法。\n- **函数空间：** 它建议使用连续 Lagrange 节点元 ($\\mathbf{H}^1(\\Omega)$)，这对于电场公式化是错误的选择。这个空间对向量场的所有分量都施加了连续性，这过于严格，并且已知会引入伪解。\n- **弱形式：** 它通过用一个标量参数 $\\alpha$ 替换磁导率张量 $\\boldsymbol{\\mu}^{-1}(\\mathbf{x})$ 来改变问题的物理性质。\n- **PML 模型：** 它建议用各向同性平均值来近似各向异性 PML，这将破坏“完美匹配”的特性并引起伪反射，从而违背了 PML 的目的。\n\n**D. 错误。** 该选项也包含几个关键缺陷。\n- **弱形式：** 第一项 $\\int_{\\Omega} \\big( \\nabla \\times \\mathbf{E} \\big) \\cdot \\overline{ \\boldsymbol{\\mu}(\\mathbf{x}) \\, \\nabla \\times \\mathbf{v} } \\, d\\mathbf{x}$ 是不正确的。它使用了 $\\boldsymbol{\\mu}$ 而不是控制方程所要求的 $\\boldsymbol{\\mu}^{-1}$。这从根本上改变了算子。\n- **PML 物理：** 它建议丢弃 PML 张量的虚部。虚部是产生吸收/阻尼的部分。去掉它们会使 PML 作为吸收层变得毫无用处。\n- **稳定化：** 它省略了必要的散度稳定化，导致方法不稳定。\n\n基于此分析，选项 A 是唯一描述了针对给定问题的正确、稳定且精确的数值方法的选项。", "answer": "$$\\boxed{A}$$", "id": "3297838"}]}