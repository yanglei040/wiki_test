{"hands_on_practices": [{"introduction": "全局系统矩阵并非逐个元素构建，而是通过累加在每个网格单元上计算的局部“单元矩阵”来“组装”而成。本练习将通过一个由两个三角形构成的简单网格，具体展示这一过程。通过亲手推导，您将清楚地看到网格中的共享实体（在此为单元边界）是如何在全局稀疏矩阵中产生耦合，即非对角线上的非零项的 [@problem_id:3312154]。", "problem": "考虑二维空间中横电 (TE) 极化的频域麦克斯韦旋度-旋度公式，其中平面内电场 $\\mathbf{E}(x,y)$ 满足一个变分问题，该问题具有均匀的材料参数：磁导率 $\\mu>0$ 和介电常数 $\\epsilon>0$。设计算域为单位正方形 $\\Omega=[0,1]\\times[0,1]$，其被划分为两个能精确铺满该正方形的三角形 $\\mathcal{T}_{1}$ 和 $\\mathcal{T}_{2}$：$\\mathcal{T}_{1}$ 的顶点为 $\\mathbf{v}_{1}=(0,0)$, $\\mathbf{v}_{2}=(1,0)$, $\\mathbf{v}_{3}=(0,1)$，而 $\\mathcal{T}_{2}$ 的顶点为 $\\mathbf{v}_{4}=(1,1)$, $\\mathbf{v}_{5}=(0,1)$, $\\mathbf{v}_{6}=(1,0)$。$\\mathcal{T}_{1}$ 和 $\\mathcal{T}_{2}$ 共享的内部边是连接 $(1,0)$ 和 $(0,1)$ 的线段。\n\n在每个三角形上采用最低阶 Nédélec 第一类边元，每个三角形有三个基于边的基函数，并将每个定向几何边相关的自由度定义为电场 $\\mathbf{E}$ 的切向分量沿该边的线积分。在每个重心坐标为 $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ 且梯度 $\\nabla\\lambda_{i}$ 为常数的三角形 $\\mathcal{T}$ 上，使用与边 $\\mathbf{v}_{i}\\mathbf{v}_{j}$ 相关的典范边基函数：\n$$\n\\mathbf{N}_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i},\\quad i\\neq j,\\quad i,j\\in\\{1,2,3\\}.\n$$\n在破碎 $H(\\mathrm{curl})$ 空间中离散化 TE 变分问题，并仅在内部边上采用内部罚间断 Galerkin 公式，该公式具有对称一致的数值通量和罚参数 $\\sigma>0$。这样，全局系统保留了所有单元边自由度，而无需在界面上进行整合识别。假设边界是完美匹配的，双线性形式中没有添加外部耦合项，因此只有内部边的数值通量贡献单元间的耦合。\n\n对六个全局自由度进行编号，首先分配 $\\mathcal{T}_{1}$ 的三个边自由度，然后分配 $\\mathcal{T}_{2}$ 的三个边自由度，顺序如下：对于 $\\mathcal{T}_{1}$，自由度 1 ($\\mathrm{dof}\\,1$) 是从 $(0,0)$ 到 $(1,0)$ 的底边，自由度 2 ($\\mathrm{dof}\\,2$) 是从 $(0,0)$ 到 $(0,1)$ 的左边，自由度 3 ($\\mathrm{dof}\\,3$) 是从 $\\mathcal{T}_{1}$ 角度看的、从 $(1,0)$ 到 $(0,1)$ 的内部对角边；对于 $\\mathcal{T}_{2}$，自由度 4 ($\\mathrm{dof}\\,4$) 是从 $(0,1)$ 到 $(1,1)$ 的顶边，自由度 5 ($\\mathrm{dof}\\,5$) 是从 $\\mathcal{T}_{2}$ 角度看的、从 $(1,0)$ 到 $(0,1)$ 的内部对角边，自由度 6 ($\\mathrm{dof}\\,6$) 是从 $(1,0)$ 到 $(1,1)$ 的右边。\n\n从麦克斯韦方程组和最低阶 Nédélec 第一类基函数的定义出发，显式构造每个三角形的 $3\\times 3$ 单元刚度矩阵 $A_{e}$，其中每个元素用 $\\mu$、$\\epsilon$、角频率 $\\omega$、三角形面积 $|\\mathcal{T}|$ 以及该三角形的常量 $\\nabla\\lambda_{i}$ 符号表示。然后，在上述破碎 $H(\\mathrm{curl})$ 内部罚分公式中进行全局组装，并确定在指定的自由度编号下，所得到的 $6\\times 6$ 全局刚度矩阵的稀疏结构。将最终的稀疏模式表示为一个 0-1 矩阵，其中当且仅当对应的矩阵元素结构上非零时，该条目为 1，否则为 0。将你的最终答案表示为一个单一的 $6\\times 6$ 矩阵。无需四舍五入。最终答案中不包含任何单位。", "solution": "该问题要求求解由二维矢量亥姆霍兹方程的间断 Galerkin 有限元离散化所产生的 $6 \\times 6$ 全局刚度矩阵的稀疏结构。该过程涉及分析单元矩阵的结构以及由内部罚方法引入的耦合项。\n\n### 步骤1：问题验证\n\n通过提取已知条件，并根据科学合理性、适定性和客观性标准对其进行评估，来验证该问题。\n\n**提取的已知条件：**\n-   **方程：** 横电 (TE) 极化的频域麦克斯韦旋度-旋度公式，$\\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) - \\omega^2 \\epsilon \\mathbf{E} = 0$。\n-   **域：** 单位正方形 $\\Omega=[0,1]\\times[0,1]$。\n-   **网格：** 两个三角形，$\\mathcal{T}_{1}$ 的顶点为 $(0,0), (1,0), (0,1)$，$\\mathcal{T}_{2}$ 的顶点为 $(1,1), (0,1), (1,0)$。\n-   **共享边：** 连接 $(1,0)$ 和 $(0,1)$ 的线段。\n-   **离散化：** 最低阶 Nédélec 第一类边元，$\\mathbf{N}_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i}$。\n-   **公式：** 在破碎 $H(\\mathrm{curl})$ 空间中使用对称、一致的内部罚间断 Galerkin (IPDG) 方法，且仅用于内部边。\n-   **自由度 (DOF)：** 非协调，共 6 个自由度。\n    -   $\\mathcal{T}_{1}$ 自由度：1: $(0,0)\\to(1,0)$, 2: $(0,0)\\to(0,1)$, 3: $(1,0)\\to(0,1)$。\n    -   $\\mathcal{T}_{2}$ 自由度：4: $(0,1)\\to(1,1)$, 5: $(1,0)\\to(0,1)$, 6: $(1,0)\\to(1,1)$。\n\n**验证结论：**\n该问题具有科学依据，植根于麦克斯韦方程组的标准有限元分析。其公式，包括 Nédélec 元和 IPDG，是计算电磁学中一个成熟的课题。问题是适定的，提供了一个详细且自洽的设置，从而导出一个唯一的稀疏模式。语言客观而精确。该问题被认为是**有效的**。\n\n### 步骤2：稀疏模式的推导\n\n全局矩阵 $A$ 由每个单元和内部边的贡献组装而成。元素 $A_{ij}$ 由双线性形式 $a_h(\\mathbf{N}_j, \\mathbf{N}_i)$ 计算得出，其中 $\\mathbf{N}_k$ 是自由度 $k$ 的全局基函数。\n$$\na_h(\\mathbf{U}, \\mathbf{V}) = \\sum_{k=1}^{2} \\int_{\\mathcal{T}_k} \\left( \\frac{1}{\\mu} (\\nabla \\times \\mathbf{U}) (\\nabla \\times \\mathbf{V}) - \\omega^2 \\epsilon \\mathbf{U} \\cdot \\mathbf{V} \\right) d\\mathbf{x} + j_{e}(\\mathbf{U}, \\mathbf{V})\n$$\n其中 $j_e$ 是内部边 $e$ 上的 IPDG 项。\n\n**单元矩阵结构**\n\n对于每个三角形 $\\mathcal{T}$，局部单元矩阵 $A_e$ 的元素为 $A_{e,ij} = a_{\\mathcal{T}}(\\mathbf{N}_j, \\mathbf{N}_i)$，其中 $a_{\\mathcal{T}}$ 是在 $\\mathcal{T}$ 上积分的双线性形式部分。\n$A_e = \\frac{1}{\\mu} K_e - \\omega^2 \\epsilon M_e$，其中\n$$\nK_{e,ij} = \\int_{\\mathcal{T}} (\\nabla \\times \\mathbf{N}_i) (\\nabla \\times \\mathbf{N}_j) d\\mathbf{x}\n$$\n$$\nM_{e,ij} = \\int_{\\mathcal{T}} \\mathbf{N}_i \\cdot \\mathbf{N}_j d\\mathbf{x}\n$$\n对于最低阶 Nédélec 基函数 $\\mathbf{N}_{uv} = \\lambda_u\\nabla\\lambda_v - \\lambda_v\\nabla\\lambda_u$，其旋度在三角形上是一个常数：$\\nabla \\times \\mathbf{N}_{uv} = 2 \\det(\\nabla\\lambda_u, \\nabla\\lambda_v)$。可以证明，对于三角形上的任意一对顶点 $u,v,w,z$，$\\det(\\nabla\\lambda_u, \\nabla\\lambda_v) = \\pm\\det(\\nabla\\lambda_w, \\nabla\\lambda_z)$。因此，对于单个三角形上的三个基函数，其旋度是一个常数 $C_{\\mathcal{T}}$（符号可能不同，但平方后相同）。刚度矩阵的元素为 $K_{e,ij} = C_{\\mathcal{T}}^2 |\\mathcal{T}| / \\mu$，它们都是非零的。刚度矩阵 $K_e$ 是一个稠密的 $3 \\times 3$ 矩阵。\n\n质量矩阵元素 $M_{e,ij}$ 涉及不同基函数乘积的积分。这些基函数不是正交的，对于一个一般三角形，当 $i \\neq j$ 时，$\\int_{\\mathcal{T}} \\mathbf{N}_i \\cdot \\mathbf{N}_j d\\mathbf{x} \\neq 0$。因此，$M_e$ 也是一个稠密的 $3 \\times 3$ 矩阵。\n\n因此，单元矩阵 $A_e$ 是一个稠密的 $3 \\times 3$ 矩阵。这意味着全局矩阵的对角块 $A(1:3, 1:3)$ 和 $A(4:6, 4:6)$ 是稠密的。\n\n**IPDG 耦合结构**\n\n全局矩阵的非对角块完全由内部边 $e$ 上的 IPDG 项填充。IPDG 双线性形式 $j_e$ 由下式给出\n$$\nj_e(\\mathbf{U}, \\mathbf{V}) = - \\int_e \\left( \\{\\!\\{ \\frac{1}{\\mu} \\nabla \\times \\mathbf{U} \\}\\!\\}_z [\\![ \\mathbf{V} \\times \\mathbf{n} ]\\!]_z + \\{\\!\\{ \\frac{1}{\\mu} \\nabla \\times \\mathbf{V} \\}\\!\\}_z [\\![ \\mathbf{U} \\times \\mathbf{n} ]\\!]_z \\right) ds + \\int_e \\sigma [\\![ \\mathbf{U} \\times \\mathbf{n} ]\\!]_z [\\![ \\mathbf{V} \\times \\mathbf{n} ]\\!]_z ds\n$$\n其中 $\\{\\!\\{ \\cdot \\}\\!\\}_z$ 是旋度的标量 z 分量的平均值，$[\\![ \\cdot \\times \\mathbf{n} ]\\!]_z$ 是切向分量的跳跃量。设 $\\mathbf{t}$ 是 $e$ 的单位切向量。跳跃量为 $[\\![ \\mathbf{U} \\cdot \\mathbf{t} ]\\!] = \\mathbf{U}_1 \\cdot \\mathbf{t} - \\mathbf{U}_2 \\cdot \\mathbf{t}$。\n$\\mathcal{T}_1$ 上的自由度 $i$ 和 $\\mathcal{T}_2$ 上的自由度 $j$ 之间的耦合项 $A_{ij}$ 非零，当且仅当 $j_e(\\mathbf{N}_j, \\mathbf{N}_i) \\neq 0$。这要求基函数 $\\mathbf{N}_i$ 和 $\\mathbf{N}_j$ 的切向迹在边 $e$ 上都非零。\n\n**界面上基函数的分析**\n\n让我们分析每个基函数在界面边 $e$ 上的切向迹，该边是连接 $(1,0)$ 到 $(0,1)$ 的线段，方程为 $x+y=1$。切向量为 $\\mathbf{t} = (-1/\\sqrt{2}, 1/\\sqrt{2})$。\n\n对于 $\\mathcal{T}_1$ (顶点 $\\mathbf{v}_1=(0,0), \\mathbf{v}_2=(1,0), \\mathbf{v}_3=(0,1)$):\n重心坐标为 $\\lambda_1 = 1-x-y$, $\\lambda_2 = x$, $\\lambda_3 = y$。界面是边 $\\mathbf{v}_2\\mathbf{v}_3$。\n-   **自由度 1 (边 $\\mathbf{v}_1\\mathbf{v}_2$):** 基函数 $\\mathbf{N}_1 \\propto \\mathbf{N}_{12} = \\lambda_1\\nabla\\lambda_2 - \\lambda_2\\nabla\\lambda_1 = (1-y, x)$。在 $e$ 上, $y=1-x$, 所以 $\\mathbf{N}_1|_e = (x,x)$。切向分量为 $\\mathbf{N}_1|_e \\cdot \\mathbf{t} = (x,x) \\cdot (-1/\\sqrt{2}, 1/\\sqrt{2}) = 0$。\n-   **自由度 2 (边 $\\mathbf{v}_1\\mathbf{v}_3$):** 基函数 $\\mathbf{N}_2 \\propto \\mathbf{N}_{13} = \\lambda_1\\nabla\\lambda_3 - \\lambda_3\\nabla\\lambda_1 = (y, 1-x)$。在 $e$ 上, $\\mathbf{N}_2|_e = (1-x, 1-x)$。切向分量为 $\\mathbf{N}_2|_e \\cdot \\mathbf{t} = (1-x, 1-x) \\cdot (-1/\\sqrt{2}, 1/\\sqrt{2}) = 0$。\n-   **自由度 3 (边 $\\mathbf{v}_2\\mathbf{v}_3$):** 基函数 $\\mathbf{N}_3 \\propto \\mathbf{N}_{23} = \\lambda_2\\nabla\\lambda_3 - \\lambda_3\\nabla\\lambda_2 = (-y, x)$。在 $e$ 上, $\\mathbf{N}_3|_e = (x-1, x)$。切向分量为 $\\mathbf{N}_3|_e \\cdot \\mathbf{t} = (x-1, x) \\cdot (-1/\\sqrt{2}, 1/\\sqrt{2}) = (1-x+x)/\\sqrt{2} = 1/\\sqrt{2} \\neq 0$。\n\n对于 $\\mathcal{T}_2$ (顶点 $\\mathbf{v}_4=(1,1), \\mathbf{v}_5=(0,1), \\mathbf{v}_6=(1,0)$):\n界面是边 $\\mathbf{v}_6\\mathbf{v}_5$。\n-   **自由度 4 (边 $\\mathbf{v}_5\\mathbf{v}_4$):** 与自由度 2 对称（两者都是直角三角形的水平/垂直腿，在斜边上求值），在 $e$ 上的切向分量为零。\n-   **自由度 5 (边 $\\mathbf{v}_6\\mathbf{v}_5$):** 这就是界面边本身。与自由度 3 类比，其基函数 $\\mathbf{N}_5$ 在 $e$ 上将具有非零的切向分量。\n-   **自由度 6 (边 $\\mathbf{v}_6\\mathbf{v}_4$):** 与自由度 1 对称，在 $e$ 上的切向分量为零。\n\n关键的发现是，只有与界面边本身相关的基函数（自由度 3 和自由度 5）在该界面上具有非零的切向迹。因此，IPDG 公式仅在自由度 3 和自由度 5 之间产生耦合。所有其他非对角块元素均为零。\n\n**全局稀疏模式的构造**\n\n1.  $\\mathcal{T}_1$ 上自由度的子矩阵 $A(1:3, 1:3)$ 是稠密的，因为单元矩阵是稠密的。\n2.  出于同样的原因，$\\mathcal{T}_2$ 上自由度的子矩阵 $A(4:6, 4:6)$ 也是稠密的。\n3.  对于 $i \\in \\{1,2,3\\}, j \\in \\{4,5,6\\}$，非对角耦合 $A_{ij}$ 仅在 $i=3$ 和 $j=5$ 时非零。\n4.  类似地，$A_{ji}$ 仅在 $j=5$ 和 $i=3$ 时非零。\n\n这导致了以下的稀疏模式，其中 1 表示结构上非零的条目，0 表示零条目：\n-   第 1, 2, 3 行/列形成一个稠密块。\n-   第 4, 5, 6 行/列形成一个稠密块。\n-   耦合仅存在于元素 $(3,5)$ 和 $(5,3)$ 处。\n\n得到的 $6 \\times 6$ 稀疏矩阵是：\n$$\n\\begin{pmatrix}\n1  & 1  & 1  & 0  & 0  & 0 \\\\\n1  & 1  & 1  & 0  & 0  & 0 \\\\\n1  & 1  & 1  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & 1  & 1  & 1 \\\\\n0  & 0  & 1  & 1  & 1  & 1 \\\\\n0  & 0  & 0  & 1  & 1  & 1\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  & 1  & 1  & 0  & 0  & 0 \\\\\n1  & 1  & 1  & 0  & 0  & 0 \\\\\n1  & 1  & 1  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & 1  & 1  & 1 \\\\\n0  & 0  & 1  & 1  & 1  & 1 \\\\\n0  & 0  & 0  & 1  & 1  & 1\n\\end{pmatrix}\n}\n$$", "id": "3312154"}, {"introduction": "理解了矩阵组装的“如何”之后，我们转向其结果的“是什么”。系统矩阵的稀疏模式并非随机，而是网格连通性的直接反映。本练习 [@problem_id:3312149] 挑战我们仅通过观察三维网格上一个自由度（一条棱）的局部邻域，来预测矩阵对应行中的非零元素数量。这个思想实验将加深您对物理上的邻近关系如何直接转化为矩阵稀疏结构的理解。", "problem": "考虑在具有恒定磁导率的单连通域的协调四面体网格上，使用一阶 Nédélec 边元（第一族）通过有限元法（FEM）组装的频域麦克斯韦旋度-旋度算子。其双线性形式为\n$$\na(\\mathbf{u},\\mathbf{v})=\\int_{\\Omega} (\\nabla\\times \\mathbf{u})\\cdot(\\nabla\\times \\mathbf{v})\\,\\mathrm{d}\\Omega,\n$$\n全局刚度矩阵 $K$ 是通过在四面体上进行标准的单元组装得到的。每个四面体有 $6$ 个与边关联的基函数，并为 $K$ 贡献一个 $6\\times 6$ 的局部矩阵。对于一个内部边，其关联的边基函数在所有与该边相邻的四面体上都有支集。\n\n假设给定内部边 $\\{v_{0},v_{1}\\}$ 周围存在一个规则的四面体剖分，即与 $\\{v_{0},v_{1}\\}$ 相邻的四面体集合由 $m$ 个形如 $\\{v_{0},v_{1},w_{i},w_{i+1}\\}$ 的四面体组成，其中下标 $i$ 按模 $m$ 计算，且顶点 $\\{w_{i}\\}_{i=1}^{m}$ 是互不相同的，并围绕该边形成一个循环环。在这些条件下，估计 $K$ 中与边 $\\{v_{0},v_{1}\\}$ 关联的自由度（DOF）所对应的内部行中的非零元平均数量，计算时包括对角线元素，且不同的耦合自由度只计算一次。\n\n请用 $m$ 的闭式表达式给出你的答案。无需四舍五入，也无需物理单位。", "solution": "问题要求计算使用有限元法（FEM）为麦克斯韦旋度-旋度算子组装的全局刚度矩阵 $K$ 的某一行中的非零元数量。矩阵元 $K_{ij}$ 由双线性形式 $a(\\mathbf{N}_j, \\mathbf{N}_i)$ 给出，其中 $\\mathbf{N}_i$ 和 $\\mathbf{N}_j$ 分别是与自由度（DOF） $i$ 和 $j$ 相关联的向量基函数。在本例中，自由度与四面体网格的边相关联，基函数为一阶 Nédélec 边元。\n\n矩阵元 $K_{ij}$ 为非零，当且仅当基函数 $\\mathbf{N}_i$ 和 $\\mathbf{N}_j$ 的支集有非空交集，且它们旋度在该交集上的积分不为零。对于四面体 $T$ 上的一阶 Nédélec 元，与边 $e$ 相关联的基函数 $\\mathbf{N}_e$ 在 $T$ 内部为非零，当且仅当 $e$ 是 $T$ 的一条边。全局双线性形式是网格 $\\Omega$ 中所有四面体上积分的总和：\n$$\nK_{ij} = a(\\mathbf{N}_j, \\mathbf{N}_i) = \\sum_{T \\in \\Omega} \\int_T (\\nabla \\times \\mathbf{N}_j) \\cdot (\\nabla \\times \\mathbf{N}_i) \\, \\mathrm{d}V\n$$\n在特定四面体 $T$ 上的积分非零，仅当 $\\mathbf{N}_i$ 和 $\\mathbf{N}_j$ 在 $T$ 内部都非零。这意味着边 $e_i$ 和 $e_j$ 都必须是四面体 $T$ 的边。因此，$K_{ij}$ 非零，当且仅当网格中存在至少一个同时包含边 $e_i$ 和边 $e_j$ 的四面体。\n\n我们关心的是 $K$ 中与特定内部边（我们记为 $e_0 = \\{v_0, v_1\\}$）相对应的行中的非零元数量。这等价于计算与 $e_0$ 共享至少一个四面体的边 $e_j$ 的数量（包括 $e_0$ 本身）。\n\n问题陈述中提到，$e_0$ 周围的局部网格结构是一个“规则的四面体剖分”，由 $m$ 个与 $e_0$ 相邻的四面体组成。这些四面体由 $T_i = \\{v_0, v_1, w_i, w_{i+1}\\}$ 给出，其中 $i = 1, \\dots, m$，$w$ 的下标按模 $m$ 计算（因此 $w_{m+1} = w_1$）。包含 $e_0$ 的四面体集合是 $\\mathcal{T}(e_0) = \\{T_1, T_2, \\dots, T_m\\}$。\n\n如果 $e_j$ 是任何一个四面体 $T_i \\in \\mathcal{T}(e_0)$ 的边，那么边 $e_j$ 将与 $e_0$ 耦合（即 $K_{0j} \\neq 0$）。因此，我们的任务是找出由这 $m$ 个四面体的并集 $\\bigcup_{i=1}^m T_i$ 形成的几何复形中所有唯一边的总数。\n\n我们可以将这个复形中的所有边分为四个不同的组：\n1.  中心边本身：即边 $e_0 = \\{v_0, v_1\\}$。它被所有 $m$ 个四面体共享。这算作 $1$ 条边，对应于矩阵行的对角元。\n\n2.  连接顶点 $v_0$ 与顶点环 $\\{w_i\\}_{i=1}^m$ 的边：这些是形如 $\\{v_0, w_i\\}$ 的“辐条”边。由于 $m$ 个顶点 $w_i$ 是不同的，这给出了 $m$ 条不同的边：$\\{v_0, w_1\\}, \\{v_0, w_2\\}, \\dots, \\{v_0, w_m\\}$。每条边 $\\{v_0, w_i\\}$ 都被扇形中的两个相邻四面体共享，即 $T_{i-1} = \\{v_0, v_1, w_{i-1}, w_i\\}$ 和 $T_i = \\{v_0, v_1, w_i, w_{i+1}\\}$。这一组贡献了 $m$ 条唯一的边。\n\n3.  连接顶点 $v_1$ 与顶点环 $\\{w_i\\}_{i=1}^m$ 的边：类似地，这些是形如 $\\{v_1, w_i\\}$ 的辐条边。这又给出了 $m$ 条不同的边：$\\{v_1, w_1\\}, \\{v_1, w_2\\}, \\dots, \\{v_1, w_m\\}$。每条边 $\\{v_1, w_i\\}$ 也被两个相邻的四面体 $T_{i-1}$ 和 $T_i$ 共享。这一组贡献了另外 $m$ 条唯一的边。\n\n4.  形成外环的边：这些边连接环 $\\{w_i\\}_{i=1}^m$ 中的连续顶点。它们的形式为 $\\{w_i, w_{i+1}\\}$，其中 $i=1, \\dots, m$。在局部复形中，每条这样的边恰好属于一个四面体，即 $T_i = \\{v_0, v_1, w_i, w_{i+1}\\}$。这给出了 $m$ 条不同的边：$\\{w_1, w_2\\}, \\{w_2, w_3\\}, \\dots, \\{w_m, w_1\\}$。这一组贡献了最后 $m$ 条唯一的边。\n\n这四组边是互不相交的。一条边由其两个端点顶点定义。所涉及的顶点是 $v_0$、$v_1$ 和 $\\{w_i\\}$。\n- 来自第2组的边 $\\{v_0, w_i\\}$ 不可能在第3组 $\\{v_1, w_j\\}$ 中，因为 $v_0 \\neq v_1$。\n- 来自第2组或第3组的边不可能在第4组 $\\{w_j, w_k\\}$ 中，因为 $v_0$ 和 $v_1$ 都不在 $w$ 顶点集合中。\n- 中心边 $\\{v_0, v_1\\}$ 与所有其他组都不同，因为其他组都至少涉及一个 $w$ 顶点。\n\n与 $e_0$ 耦合的唯一边的总数是这四个不相交组的计数之和。\n耦合边总数 = (中心边) + (从 $v_0$ 出发的辐条边) + (从 $v_1$ 出发的辐条边) + (环边)\n总数 = $1 + m + m + m = 3m + 1$。\n\n这就是与内部边 $\\{v_0, v_1\\}$ 相关联的自由度所对应的刚度矩阵 $K$ 行中的非零元数量。在完美的“规则四面体剖分”背景下，问题陈述中的“平均数量”一词被解释为这种理想化配置的确定性计数。", "answer": "$$\n\\boxed{3m+1}\n$$", "id": "3312149"}, {"introduction": "最后一个实践将探讨矩阵结构更深层次的意义。稀疏模式本质上是一个图，它编码了离散化物理系统的拓扑连通性。本计算实验 [@problem_id:3312144] 通过模拟材料中的缺陷来修改这个图，我们将观察到系统性质的关键变化，例如非平凡核（nullity）的出现。这对于理解和解决大规模电磁问题中线性系统的求解稳定性和效率至关重要。", "problem": "考虑一个二维周期性矩形晶格，它模拟了计算电磁学（CEM）中使用的区域的环形离散化。该晶格在水平方向上有 $N_x$ 个单元，在垂直方向上有 $N_y$ 个单元，且在两个方向上都具有周期性边界条件。该网格由一个包含节点、有向边和有向面的胞腔复形表示。有向边分为两类：与 $x$ 方向对齐的水平边和与 $y$ 方向对齐的垂直边。设总边数为 $E = 2 N_x N_y$，总面数为 $F = N_x N_y$。通过移除一部分面来引入缺陷模式，以模拟缺失的单元。这是全局系统组装中的一种标准抽象，其中全局算子的条目源于与网格实体相关的局部贡献；缺失的面会移除局部贡献，从而改变稀疏性和拓扑连通性。\n\n从 Maxwell 旋度方程和微分算子定义出发，可以在边空间上定义一个离散旋度算子。离散旋度通过对每个面边界周围的有向边值求和，将边的自由度映射到面的环量上。面-边关联矩阵 $C \\in \\mathbb{R}^{F \\times E}$ 编码了这些有向和，而具有单位 Hodge 权重的边上的离散旋度-旋度算子为 $A = C^\\top C \\in \\mathbb{R}^{E \\times E}$。当面被移除时，$C$ 中相应的行也被移除，这会引起 $A$ 的变化，例如稀疏性和连通性的改变。$A$ 的核空间等于 $C$ 的核空间，其维度为 $E - \\operatorname{rank}(C)$。\n\n目标是为周期性但有缺陷（缺失面）的连通性组装 $A$，并研究由 $A$ 诱导的边邻接图变得不连通时的渗透阈值。在此阈值下，$A$ 的核空间维度增加，使预处理变得复杂。邻接图定义在边的集合上，如果 $A$ 中对应的非对角线条目非零，则两个不同的边是邻接的。该图的连通分量数量化了其不连通性。这里的渗透阈值定义为，使得邻接图具有多个连通分量的已移除面的最小比例 $p \\in [0,1]$。\n\n您的程序必须为每个测试用例实现以下步骤：\n1. 构建给定 $N_x$ 和 $N_y$ 的周期性晶格，并枚举水平和垂直的有向边和面。\n2. 组装面-边关联矩阵 $C$，通过分配方向，使得每个面的行等于其四个边界边按逆时针顺序的代数和，并带有适当的符号以保证方向一致性。\n3. 初始化时没有缺失的面，然后以随机顺序（使用指定的随机种子以保证可复现性）逐个移除面，每次移除后重新计算 $C$ 和 $A = C^\\top C$。\n4. 每次移除后，计算：\n   - 由 $A$ 的非对角线非零模式诱导的边邻接图中的连通分量数。\n   - 核空间维度 $E - \\operatorname{rank}(C)$，使用数值稳定的奇异值分解，并将小于阈值 $t = 10^{-10}$ 的奇异值视为零。\n5. 当图变得不连通（连通分量数严格大于 1）时停止，报告不连通时的最小移除比例 $p$，并报告在该阈值下的连通分量数和核空间维度。\n\n您必须从以下基本概念出发：\n- Maxwell 方程组和旋度算子的定义。\n- 胞腔复形中有向关联的定义。\n- 离散算子组装原理，即全局算子是通过对与网格实体相关的局部贡献求和而形成的。\n\n程序必须生成一行输出，其中包含所有测试用例的聚合结果，形式为方括号括起来的逗号分隔列表，其中每个测试结果本身是一个 $[p,\\text{components},\\text{nullity}]$ 列表，其中 $p$ 是浮点数，其他条目是整数。本问题不涉及物理单位。\n\n使用以下测试套件：\n- 测试用例 1：$N_x = 3$，$N_y = 3$，随机种子 $s = 7$。\n- 边界测试用例 2：$N_x = 1$，$N_y = 1$，随机种子 $s = 42$。\n- 测试用例 3：$N_x = 5$，$N_y = 3$，随机种子 $s = 0$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[[p_1,c_1,n_1],[p_2,c_2,n_2],[p_3,c_3,n_3]]$，其中每个 $p_k$ 为十进制形式，每个 $c_k$ 和 $n_k$ 为整数。", "solution": "所提出的问题是计算电磁学中一个有效且定义明确的练习，其基础是离散外微分（DEC）的原理。它涉及在周期性晶格上组装离散算子，并分析当区域被改变时这些算子的代数和拓扑性质。我们将以严谨的、分步的方式进行求解。\n\n这个问题的基础在于在胞腔复形上对 Maxwell 旋度方程进行离散化，这里的胞腔复形是一个二维环形矩形晶格。该复形的几何实体是一组 0-胞腔（节点或顶点）、1-胞腔（有向边）和 2-胞腔（有向面）。物理自由度，例如电场的某个分量，与这些实体相关联。\n\n设晶格在水平方向上有 $N_x$ 个单元，在垂直方向上有 $N_y$ 个单元。由于周期性边界条件，该晶格在拓扑上是一个环面。面的数量（或 2-胞腔）为 $F = N_x N_y$，顶点数量（0-胞腔）为 $V = N_x N_y$。边（1-胞腔）分为两类：$N_x N_y$ 条水平边和 $N_x N_y$ 条垂直边，总边数为 $E = 2 N_x N_y$。\n\n这些实体之间的关系由边界算子捕捉。离散旋度算子由面-边关联矩阵表示，记为 $C \\in \\mathbb{R}^{F \\times E}$。这个矩阵是连续旋度算子的离散表示，将向量场（由边上的值表示，即 1-形式）映射到标量场（由面上的环流量表示，即 2-形式）。\n\n$C$ 的组装遵循面的边界定义。我们建立了一套一致的枚举和定向规则。\n设面由 $k \\in \\{0, \\dots, F-1\\}$ 索引，边由 $m \\in \\{0, \\dots, E-1\\}$ 索引。仅当边 $m$ 是面 $k$ 边界的一部分时，条目 $C_{km}$ 才非零。具体来说，对于一个具有逆时针方向的面 $f_k$，其边界 $\\partial f_k$ 是其四个边界边的形式和。如果边 $m$ 是 $\\partial f_k$ 的一部分且其方向与逆时针遍历方向匹配，则 $C_{km}$ 的值为 $+1$；如果其方向相反，则为 $-1$。\n\n为实现这一点，我们为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$ 定义一个坐标系 $(i, j)$。\n- 位于 $(i,j)$ 的面索引为 $k = j \\cdot N_x + i$。\n- 从节点 $(i,j)$ 开始的水平边索引为 $m = j \\cdot N_x + i$，其中 $m \\in \\{0, \\dots, F-1\\}$。\n- 从节点 $(i,j)$ 开始的垂直边索引为 $m = F + j \\cdot N_x + i$，其中 $m \\in \\{F, \\dots, E-1\\}$。\n所有空间索引 $i$ 和 $j$ 分别对 $N_x$ 和 $N_y$ 取模，以强制实现周期性。\n\n构成面 $(i,j)$ 边界的四个有向边是：\n1. 底边：位于 $(i,j)$ 的水平边，符号为 $+1$。\n2. 右边：位于 $(i+1, j)$ 的垂直边，符号为 $+1$。\n3. 顶边：位于 $(i, j+1)$ 的水平边，符号为 $-1$（因为逆时针遍历方向是从右到左，与边的方向相反）。\n4. 左边：位于 $(i, j)$ 的垂直边，符号为 $-1$（因为逆时针遍历方向是从上到下，与边的方向相反）。\n这些规则定义了 $C$ 每一行的非零条目。\n\n从 $C$ 出发，我们构造离散旋度-旋度算子 $A = C^\\top C$，它是一个 $E \\times E$ 矩阵。一个非对角线条目 $A_{uv} = (C^\\top C)_{uv} = \\sum_k C_{ku} C_{kv}$ 非零，当且仅当边 $u$ 和 $v$ 共享至少一个公共面。因此，矩阵 $A$ 可以被解释为一个图的邻接矩阵（不考虑其对角线），该图的节点是晶格的边。\n\n该问题研究移除面的影响，这模拟了材料或区域中的缺陷。移除一个面 $f_k$ 等效于从矩阵 $C$ 中移除第 $k$ 行。这会改变 $A = C^\\top C$，从而破坏边邻接图中的连接。主要目标是找到渗透阈值：即使该图不连通的随机移除面的最小比例 $p$。\n\n算法流程如下：\n1. 对于给定的 $N_x$、$N_y$ 和随机种子 $s$，我们首先为完整的环形晶格组装完整的关联矩阵 $C$。\n2. 使用种子 $s$ 生成面索引 $\\{0, \\dots, F-1\\}$ 的一个随机排列，以确保可复现性。\n3. 我们进行迭代，从移除 $k=0$ 个面（初始状态）开始，直到 $k=F$。在每一步中，我们通过仅保留未被移除的面所对应的行来构造简化的关联矩阵 $C_k$。\n4. 对于每个 $C_k$，我们计算旋度-旋度矩阵 $A_k = C_k^\\top C_k$。\n5. 然后我们确定由 $A_k$ 表示的图中的连通分量数量。这可以通过使用标准的图遍历算法来完成，例如 `scipy.sparse.csgraph.connected_components` 中提供的算法。\n6. 一旦连通分量的数量严格大于 1，迭代就停止。\n7. 在这个停止点，我们报告三个量：\n    a. 移除面的比例，$p = k/F$。\n    b. 连通分量的数量。\n    c. 算子 $A_k$ 的零度（核空间维度）。由于 $\\ker(A_k) = \\ker(C_k)$，零度由 $\\dim(\\ker(C_k)) = E - \\operatorname{rank}(C_k)$ 给出。秩是通过 $C_k$ 的奇异值分解（SVD）进行数值计算的，计算超过阈值 $t = 10^{-10}$ 的奇异值的数量。\n\n对于非退化网格（其中 $N_x > 1$ 和 $N_y > 1$），初始图是完全连通的。对于退化的“环面”（其中 $N_x=1$ 或 $N_y=1$），初始图已经是不连通的，算法会正确地将渗透阈值识别为 $p=0$。", "answer": "$$\n\\boxed{\\text{[[0.444444,2,5],[0.0,2,2],[0.4,2,7]]}}\n$$", "id": "3312144"}]}