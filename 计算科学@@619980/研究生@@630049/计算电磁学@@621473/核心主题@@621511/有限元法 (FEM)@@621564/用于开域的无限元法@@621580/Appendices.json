{"hands_on_practices": [{"introduction": "本练习直击无限元设计的核心。通过分析一个基本情形——径向对称波——我们可以推导出在人工边界上场与其导数之间的精确解析关系[@problem_id:3319001]。本练习将指导您创建一个简单的无限元，它能完美地再现这一物理条件，从而清晰地揭示无反射边界条件背后的核心原理。", "problem": "一个三维空间中的均匀、各向同性、无损耗的外部区域包围着一个有界计算域，该计算域具有一个半径为 $R>0$ 的球形人工边界。考虑自由空间中一个径向对称、无源的瞬态电磁场，其由一个标量代表场 $u(r,t)$ 表征。在外部区域 $r>R$ 中，该场满足在球对称条件下从麦克斯韦方程组得到的标量波动方程，\n$$\n\\partial_{tt} u(r,t) - c^{2}\\,\\frac{1}{r^{2}}\\,\\partial_{r}\\!\\left(r^{2}\\,\\partial_{r} u(r,t)\\right) = 0,\\quad r>R,\\ t>0,\n$$\n其中 $c>0$ 是介质中的光速。假设该场在时间上是因果的，并且向外辐射，即没有能量从空间无穷远处传来。\n\n引入关于时间的单边拉普拉斯变换，其拉普拉斯变量 $s$ 满足 $\\Re s>0$，\n$$\nU(r,s) = \\int_{0}^{\\infty} u(r,t)\\,\\exp(-s t)\\,\\mathrm{d}t.\n$$\n从上述波动方程和给定的物理假设出发，推导控制 $U(r,s)$ 的常微分方程，并找出在 $\\Re s>0$ 条件下容许的出射解。据此，确定在 $r=R$ 处的精确 Dirichlet-to-Neumann (DtN) 映射，其定义为函数 $Z(s,R)$ 在以下关系式中：\n$$\n\\partial_{r} U(R,s) = -\\,Z(s,R)\\,U(R,s).\n$$\n\n现在，通过单自由度拟设，在半无限外层 $r\\in[R,\\infty)$ 上为该开放域构建一个无限元模型\n$$\nU_{\\mathrm{IE}}(r,s) = U(R,s)\\,\\frac{R}{r}\\,\\exp\\!\\big(-\\beta\\,(r-R)\\big),\\quad r\\ge R,\n$$\n其中 $\\beta$ 是一个复值衰减参数，它可能依赖于 $s$ 和 $c$，但与 $r$ 无关。从时域观点及其拉普拉斯变换的角度来解释该无限元，强制此拟设在 $r=R$ 处产生与真实出射解完全相同的 DtN 关系。计算 $\\beta$ 关于 $s$ 和 $c$ 的闭式解析表达式。\n\n你的最终答案必须是 $\\beta$ 的一个无单位的解析表达式。不要进行近似；无需四舍五入。", "solution": "首先对问题进行严格的验证过程。\n\n### 第一步：提取已知条件\n- **控制方程：** 在三维球对称外部区域（$r>R$）中的标量波动方程由下式给出\n$$ \\partial_{tt} u(r,t) - c^{2}\\,\\frac{1}{r^{2}}\\,\\partial_{r}\\!\\left(r^{2}\\,\\partial_{r} u(r,t)\\right) = 0,\\quad r>R,\\ t>0 $$\n- **常数和参数：** 人工边界的半径为 $R>0$，波速为 $c>0$。\n- **物理假设：** 介质是均匀、各向同性、无损耗的。场 $u(r,t)$ 是无源的、径向对称的、时间上因果的，并且向外辐射，这意味着没有能量从 $r\\to\\infty$ 传来。\n- **拉普拉斯变换：** 单边拉普拉斯变换定义为\n$$ U(r,s) = \\int_{0}^{\\infty} u(r,t)\\,\\exp(-s t)\\,\\mathrm{d}t $$\n其中拉普拉斯变量 $s$ 满足 $\\Re s>0$。\n- **Dirichlet-to-Neumann (DtN) 映射：** 在边界 $r=R$ 处的精确 DtN 映射由关系式中的函数 $Z(s,R)$ 定义\n$$ \\partial_{r} U(R,s) = -\\,Z(s,R)\\,U(R,s) $$\n- **无限元 (IE) 拟设：** 为外部区域 $r\\ge R$ 提出了一个单自由度的 IE 模型，形式如下\n$$ U_{\\mathrm{IE}}(r,s) = U(R,s)\\,\\frac{R}{r}\\,\\exp\\!\\big(-\\beta\\,(r-R)\\big) $$\n其中 $\\beta$ 是一个复值参数，可能依赖于 $s$ 和 $c$。\n- **目标：** 任务是通过强制从 IE 拟设推导出的 DtN 映射与从控制波动方程推导出的精确 DtN 映射相同，来求出 $\\beta$ 的解析表达式。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据、是适定的且客观的。它基于标准的标量波动方程，这是麦克斯韦方程组在球对称条件下的简化形式。拉普拉斯变换、出射波条件、Dirichlet-to-Neumann 映射以及无限元方法等概念在计算物理与工程领域都是标准且成熟的。问题提供了所有必要信息，没有矛盾，并且语言精确。该任务是一个目标明确的形式化数学推导。不存在任何会使问题无效的缺陷。\n\n### 第三步：结论与行动\n问题有效。现在将推导完整解。\n\n### 精确 Dirichlet-to-Neumann (DtN) 映射的推导\n\n我们首先将单边拉普拉斯变换应用于标量波动方程。时间导数项 $\\partial_{tt} u(r,t)$ 的变换由下式给出\n$$ \\mathcal{L}\\{\\partial_{tt} u(r,t)\\} = s^{2} U(r,s) - s u(r,0) - \\partial_{t} u(r,0)|_{t=0} $$\n因果性假设意味着系统在 $t \\le 0$ 时处于静止状态，因此初始条件为 $u(r,0)=0$ 和 $\\partial_{t} u(r,0)|_{t=0}=0$。因此，变换简化为 $\\mathcal{L}\\{\\partial_{tt} u(r,t)\\} = s^{2} U(r,s)$。\n空间导数是关于 $r$ 的，而不是 $t$，所以变换直接作用于 $u(r,t)$。在拉普拉斯域中，波动方程变成了一个关于变量 $r$ 的常微分方程 (ODE)：\n$$ s^{2} U(r,s) - c^{2}\\,\\frac{1}{r^{2}}\\,\\frac{d}{dr}\\!\\left(r^{2}\\,\\frac{d}{dr} U(r,s)\\right) = 0 $$\n整理各项，我们得到\n$$ \\frac{d}{dr}\\!\\left(r^{2}\\,\\frac{dU}{dr}\\right) - \\frac{s^{2}}{c^{2}} r^{2} U = 0 $$\n让我们定义拉普拉斯域中的波数为 $k = s/c$。该方程即为球谐亥姆霍兹方程：\n$$ \\frac{d}{dr}\\!\\left(r^{2}\\,\\frac{dU}{dr}\\right) - k^{2} r^{2} U = 0 $$\n为求解此常微分方程，我们使用代换 $U(r,s) = \\frac{V(r,s)}{r}$。其导数为：\n$$ \\frac{dU}{dr} = \\frac{1}{r}\\frac{dV}{dr} - \\frac{1}{r^{2}}V $$\n$$ r^{2}\\frac{dU}{dr} = r\\frac{dV}{dr} - V $$\n$$ \\frac{d}{dr}\\left(r^{2}\\frac{dU}{dr}\\right) = \\frac{d}{dr}\\left(r\\frac{dV}{dr} - V\\right) = \\left(r\\frac{d^{2}V}{dr^{2}} + \\frac{dV}{dr}\\right) - \\frac{dV}{dr} = r\\frac{d^{2}V}{dr^{2}} $$\n将此代回 $U(r,s)$ 的常微分方程，我们得到一个关于 $V(r,s)$ 的更简单的常微分方程：\n$$ r\\frac{d^{2}V}{dr^{2}} - k^{2} r^{2} \\frac{V}{r} = 0 \\implies \\frac{d^{2}V}{dr^{2}} - k^{2}V = 0 $$\n$V(r,s)$ 的通解为\n$$ V(r,s) = C_{1}(s) \\exp(kr) + C_{2}(s) \\exp(-kr) $$\n因此，$U(r,s)$ 的通解为\n$$ U(r,s) = C_{1}(s)\\frac{\\exp(kr)}{r} + C_{2}(s)\\frac{\\exp(-kr)}{r} $$\n现在我们必须应用物理条件，即波向外辐射，且没有能量从无穷远处传来。第一项包含 $\\exp(kr) = \\exp(sr/c)$，当 $r \\to \\infty$ 时发散，因为 $\\Re(s)>0$ 且 $c>0$。这代表一个从无穷远处传来的不符合物理的入射波。第二项包含 $\\exp(-kr) = \\exp(-sr/c)$，当 $r \\to \\infty$ 时衰减为零。这代表了物理上容许的出射波。因此，我们必须设置 $C_{1}(s)=0$。\n物理上合理的解是\n$$ U(r,s) = C_{2}(s)\\frac{\\exp(-kr)}{r} $$\n现在我们可以计算精确的 DtN 映射 $Z(s,R)$。我们首先求 $U(r,s)$ 的径向导数：\n$$ \\partial_{r} U(r,s) = \\frac{d}{dr} \\left( C_{2}(s)\\frac{\\exp(-kr)}{r} \\right) = C_{2}(s) \\left( -\\frac{k\\exp(-kr)}{r} - \\frac{\\exp(-kr)}{r^{2}} \\right) $$\n$$ \\partial_{r} U(r,s) = - \\left( k + \\frac{1}{r} \\right) \\left( C_{2}(s) \\frac{\\exp(-kr)}{r} \\right) = - \\left( k + \\frac{1}{r} \\right) U(r,s) $$\n在边界 $r=R$ 处计算此表达式：\n$$ \\partial_{r} U(R,s) = - \\left( k + \\frac{1}{R} \\right) U(R,s) $$\n通过与定义 $\\partial_{r} U(R,s) = -Z(s,R)U(R,s)$ 进行比较，我们确定精确的 DtN 映射为：\n$$ Z(s,R) = k + \\frac{1}{R} = \\frac{s}{c} + \\frac{1}{R} $$\n\n### 从无限元拟设推导 DtN 映射\n\n接下来，我们考虑无限元拟设：\n$$ U_{\\mathrm{IE}}(r,s) = U(R,s)\\,\\frac{R}{r}\\,\\exp\\!\\big(-\\beta\\,(r-R)\\big) $$\n为了找到此拟设产生的 DtN 映射，我们计算其径向导数 $\\partial_r U_{\\mathrm{IE}}(r,s)$。我们可以将相对于 $r$ 为常数的项组合在一起：\n$$ U_{\\mathrm{IE}}(r,s) = \\left( U(R,s) R \\exp(\\beta R) \\right) \\frac{\\exp(-\\beta r)}{r} $$\n导数为\n$$ \\partial_{r} U_{\\mathrm{IE}}(r,s) = \\left( U(R,s) R \\exp(\\beta R) \\right) \\frac{d}{dr} \\left( \\frac{\\exp(-\\beta r)}{r} \\right) $$\n$$ \\partial_{r} U_{\\mathrm{IE}}(r,s) = \\left( U(R,s) R \\exp(\\beta R) \\right) \\left( -\\frac{\\beta \\exp(-\\beta r)}{r} - \\frac{\\exp(-\\beta r)}{r^{2}} \\right) $$\n$$ \\partial_{r} U_{\\mathrm{IE}}(r,s) = - \\left(\\beta + \\frac{1}{r} \\right) \\left( U(R,s) R \\exp(\\beta R) \\frac{\\exp(-\\beta r)}{r} \\right) $$\n注意到最后一个括号中的项即为 $U_{\\mathrm{IE}}(r,s)$，我们有\n$$ \\partial_{r} U_{\\mathrm{IE}}(r,s) = - \\left(\\beta + \\frac{1}{r} \\right) U_{\\mathrm{IE}}(r,s) $$\n我们关心的是在 $r=R$ 处的 DtN 映射。在 $r=R$ 处计算导数：\n$$ \\partial_{r} U_{\\mathrm{IE}}(R,s) = - \\left(\\beta + \\frac{1}{R} \\right) U_{\\mathrm{IE}}(R,s) $$\n根据构造，该拟设满足 $U_{\\mathrm{IE}}(R,s) = U(R,s)$。因此，\n$$ \\partial_{r} U_{\\mathrm{IE}}(R,s) = - \\left(\\beta + \\frac{1}{R} \\right) U(R,s) $$\n因此，由无限元拟设所蕴含的 DtN 映射，我们称之为 $Z_{\\mathrm{IE}}(s,R)$，是\n$$ Z_{\\mathrm{IE}}(s,R) = \\beta + \\frac{1}{R} $$\n\n### $\\beta$ 的计算\n\n问题要求无限元拟设在 $r=R$ 处产生精确的 DtN 关系。这意味着我们必须强制执行条件 $Z_{\\mathrm{IE}}(s,R) = Z(s,R)$。\n$$ \\beta + \\frac{1}{R} = \\frac{s}{c} + \\frac{1}{R} $$\n从两边减去 $1/R$ 即可得到 $\\beta$ 的表达式：\n$$ \\beta = \\frac{s}{c} $$\n这个结果表明，对于球对称波动问题，要使单自由度无限元是精确的，其衰减参数 $\\beta$ 必须等于拉普拉斯域中的波数 $k=s/c$。", "answer": "$$\\boxed{\\frac{s}{c}}$$", "id": "3319001"}, {"introduction": "尽管无限元在模拟远场方面表现出色，但实际问题通常包含尖锐的几何特征（如拐角），这些特征会在电磁场中产生奇异性。本练习[@problem_id:3318991]旨在探讨这些近场奇异性的本质，以及它们如何与整个数值格式相互作用。理解这种区别对于开发稳健的混合方法至关重要，因为它阐明了为何仅靠远场处理无法解决由局部几何形状引起的收敛问题。", "problem": "考虑一个平面开放域中的理想电导体障碍物对横向电磁场的时谐散射问题。在横磁（TM）极化下，平面外电场分量由一个标量场 $u$ 表示，它在障碍物外部满足亥姆霍兹方程 $\\Delta u + k^{2} u = 0$，并在障碍物表面上满足狄利克雷边界条件 $u=0$。在横电（TE）极化下，平面外磁场分量由一个标量场 $u$ 表示，它在外部满足相同的亥姆霍兹方程，但在障碍物表面上满足诺伊曼边界条件 $\\partial_{n} u = 0$。在任何一种情况下，场在无穷远处都满足索末菲辐射条件，该条件强制要求波是纯粹的出射波。\n\n我们关注障碍物的单个凸多边形角，其内角为 $\\Theta_{\\mathrm{int}} \\in (0,\\pi)$；外部计算域在该角处有一个局部楔形张角 $\\Theta := 2\\pi - \\Theta_{\\mathrm{int}}$。使用以该角为中心建立的局部极坐标系 $(r,\\theta)$，控制方程为 $\\Delta u + k^{2} u = 0$（对于 $r>0$ 和 $\\theta \\in (0,\\Theta)$），同时在楔形边界 $\\theta=0$ 和 $\\theta=\\Theta$ 上满足 $u=0$（TM）或 $\\partial_{n}u=0$（TE），并且当 $r \\to \\infty$ 时满足索末菲辐射条件。\n\n采用了一种混合有限元/无限元方法：障碍物周围的有界子域通过标准有限元进行离散化，而无界外部则通过一个无限元层进行离散化，该层通过沿径向的适当坐标映射和基函数构造来强制执行辐射条件。近场行为受局部角点奇性的影响，而远场则由辐射条件控制。\n\n关于角点奇性及其与开放域的无限元处理方法的相互作用，以下哪些陈述是正确的？\n\nA. 在狄利克雷情况（TM）下，主导角点奇性的形式为 $u(r,\\theta) \\sim r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\dfrac{\\pi}{\\Theta} = \\dfrac{\\pi}{2\\pi - \\Theta_{\\mathrm{int}}}$，因此最小正奇异指数随着外部楔形角 $\\Theta$ 的增大而减小。\n\nB. 用放置在靠近障碍物处的局部吸收边界条件截断区域，可以消除角点奇性，并在无需网格加密或基函数丰富的准均匀有限元网格上实现一致的指数$p$-收敛。\n\nC. 无限元层旨在通过映射径向坐标和定制基函数以适应出射行为来强制执行索末菲辐射条件，但它并不能正则化局部角点奇性；因此，除非在角点附近采用网格加密或用角点奇异函数丰富基函数，否则混合离散化的整体收敛性会受到角点奇性的限制。\n\nD. 在诺伊曼情况（TE）下，主导角点奇性的形式为 $u(r,\\theta) \\sim r^{\\lambda} \\cos(\\lambda \\theta)$，其最小正指数 $\\lambda = \\dfrac{\\pi}{\\Theta} = \\dfrac{\\pi}{2\\pi - \\Theta_{\\mathrm{int}}}$ 与狄利克雷情况相同，因此需要等效的网格加密策略来恢复最优收敛性。\n\nE. 在无限元层中使用包含因子 $\\exp(i k r)$ 的振荡基函数，会增加 $r=0$ 处角点奇性的阶数，因此与非振荡基函数相比，会降低障碍物附近的近似精度。", "solution": "我们将通过首先提取给定信息，然后评估其科学有效性和自洽性来验证问题陈述。\n\n### 步骤1：提取已知条件\n- **控制方程：** 在平面域中理想电导体（PEC）障碍物外部，场 $u$ 满足时谐标量亥姆霍兹方程 $\\Delta u + k^{2} u = 0$。波数为 $k$。\n- **PEC障碍物上的极化和边界条件（BCs）：**\n    - **横磁（TM）：** $u$ 是平面外电场。边界条件是狄利克雷条件，$u=0$。\n    - **横电（TE）：** $u$ 是平面外磁场。边界条件是诺伊曼条件，$\\partial_{n} u = 0$。\n- **远场条件：** 索末菲辐射条件，确保当与障碍物的距离趋于无穷大时，波是纯粹的出射波。\n- **局部几何：** 单个凸多边形角，内角为 $\\Theta_{\\mathrm{int}} \\in (0,\\pi)$。外部计算域有一个局部楔形张角 $\\Theta = 2\\pi - \\Theta_{\\mathrm{int}}$。\n- **局部坐标系：** 以该角为中心的极坐标系 $(r,\\theta)$，域在局部由 $r>0$ 和 $\\theta \\in (0,\\Theta)$ 描述。\n- **数值方法：** 混合有限元/无限元方法（FEM/IEM）。有限元法（FEM）用于障碍物周围的有界子域，而无限元法（IEM）用于无界外部区域。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是计算电磁学中用于二维散射的标准模型。亥姆霍兹方程直接由时谐场的麦克斯韦方程组导出。PEC表面上分别针对TM和TE极化的狄利克雷和诺伊曼边界条件是基础性的。索末菲辐射条件是开放域散射问题唯一性的正确物理条件。对椭圆偏微分方程（PDEs）解的角点奇性分析是数学分析中一个成熟的课题。所有内容都具有科学依据。\n2.  **适定性：** 所描述的物理问题（亥姆霍兹方程及其指定的边界和辐射条件）是适定的。问题要求分析解和数值方法的性质，这是该领域问题的有效且结构良好的格式。\n3.  **客观性：** 问题陈述使用了物理学和数值分析的精确、客观和标准术语。\n4.  **完整性和一致性：** 问题提供了分析角点附近解的局部行为所需的所有必要信息。几何约束 $\\Theta_{\\mathrm{int}} \\in (0, \\pi)$ 意味着外角 $\\Theta \\in (\\pi, 2\\pi)$，这是确定奇性性质的关键信息。设置是完整且一致的。\n\n### 步骤3：结论和行动\n问题陈述有效。它具有科学依据、适定且自洽。可以继续求解过程。\n\n### 求解推导\n在角点附近（$r \\to 0$），解 $u$ 的主阶行为由拉普拉斯方程 $\\Delta u = 0$ 控制，因为 $\\Delta u$ 项的尺度为 $r^{\\lambda-2}$，而 $k^2 u$ 项的尺度为 $r^\\lambda$，如果 $\\lambda2$，当 $r$ 很小时，后者可以忽略不计。在极坐标 $(r, \\theta)$ 中，拉普拉斯方程为 $\\frac{1}{r}\\frac{\\partial}{\\partial r}(r \\frac{\\partial u}{\\partial r}) + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} = 0$。\n使用分离变量法，$u(r,\\theta) = R(r)\\Phi(\\theta)$，我们找到形式为 $u(r,\\theta) = r^{\\lambda} (A \\cos(\\lambda\\theta) + B \\sin(\\lambda\\theta))$ 的解。我们寻找最小的正指数 $\\lambda$，使得解是非平凡的，并且满足在 $\\theta=0$ 和 $\\theta=\\Theta$ 处的边界条件。\n\n**狄利克雷情况（TM极化）：在 $\\theta=0$ 和 $\\theta=\\Theta$ 上 $u=0$。**\n- $u(r,0) = 0 \\implies r^{\\lambda}(A \\cos(0) + B \\sin(0)) = 0 \\implies A=0$。\n- $u(r,\\Theta) = 0 \\implies r^{\\lambda}(B \\sin(\\lambda\\Theta)) = 0$。对于非平凡解，我们需要 $B \\neq 0$，所以 $\\sin(\\lambda\\Theta) = 0$。\n- 这意味着 $\\lambda\\Theta = m\\pi$，其中 $m$ 是整数。最小正指数对应 $m=1$，得到 $\\lambda = \\frac{\\pi}{\\Theta}$。\n- 主导项为 $u(r,\\theta) \\sim r^{\\pi/\\Theta} \\sin(\\frac{\\pi}{\\Theta}\\theta)$。\n\n**诺伊曼情况（TE极化）：在 $\\theta=0$ 和 $\\theta=\\Theta$ 上 $\\partial_n u=0$。**\n该边界条件对应于在楔形面上 $\\frac{\\partial u}{\\partial \\theta} = 0$。\n- $\\frac{\\partial u}{\\partial \\theta} = r^{\\lambda} \\lambda (-A \\sin(\\lambda\\theta) + B \\cos(\\lambda\\theta))$。\n- 在 $\\theta=0$ 处：$r^{\\lambda} \\lambda (-A \\sin(0) + B \\cos(0)) = 0 \\implies B=0$。\n- 在 $\\theta=\\Theta$ 处：$r^{\\lambda} \\lambda (-A \\sin(\\lambda\\Theta)) = 0$。对于非平凡解，我们需要 $A \\neq 0$，所以 $\\sin(\\lambda\\Theta) = 0$。\n- 这再次意味着 $\\lambda\\Theta = m\\pi$，最小正指数对应 $m=1$ 时为 $\\lambda = \\frac{\\pi}{\\Theta}$。（$m=0$ 的情况给出 $\\lambda=0$，是一个常数解，非奇异）。\n- 主导项为 $u(r,\\theta) \\sim r^{\\pi/\\Theta} \\cos(\\frac{\\pi}{\\Theta}\\theta)$。\n\n解的正则性由指数 $\\lambda$ 决定。对于凸角，$\\Theta_{\\mathrm{int}} \\in (0,\\pi)$，所以外角 $\\Theta = 2\\pi - \\Theta_{\\mathrm{int}} \\in (\\pi, 2\\pi)$。这意味着对于TM和TE两种情况，指数 $\\lambda = \\pi/\\Theta$ 都在范围 $(1/2, 1)$ 内。由于 $\\lambda  1$，解的梯度 $\\nabla u$ 在 $r=0$ 处是奇异的。这种有限的正则性，$u \\in H^{1+\\lambda-\\epsilon}$ (对于任意 $\\epsilon > 0$) 但 $u \\notin H^2$，会降低标准有限元方法的收敛速度。\n\n### 逐项分析\n\n**A. 在狄利克雷情况（TM）下，主导角点奇性的形式为 $u(r,\\theta) \\sim r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\dfrac{\\pi}{\\Theta} = \\dfrac{\\pi}{2\\pi - \\Theta_{\\mathrm{int}}}$，因此最小正奇异指数随着外部楔形角 $\\Theta$ 的增大而减小。**\n我们对狄利克雷情况的推导证实了奇性的形式为 $u(r,\\theta) \\sim r^{\\lambda} \\sin(\\lambda\\theta)$，其中 $\\lambda = \\pi/\\Theta$。给定了关系 $\\Theta = 2\\pi - \\Theta_{\\mathrm{int}}$。函数 $\\lambda(\\Theta) = \\pi/\\Theta$ 是 $\\Theta$ 的递减函数。因此，随着外部楔形角 $\\Theta$ 的增大，指数 $\\lambda$ 减小，使得奇性更强。该陈述与分析完全一致。\n**结论：正确。**\n\n**B. 用放置在靠近障碍物处的局部吸收边界条件截断区域，可以消除角点奇性，并在无需网格加密或基函数丰富的准均匀有限元网格上实现一致的指数$p$-收敛。**\n局部吸收边界条件（ABC）是一种施加在边界 $r=R_{ABC}0$ 上的人工边界条件，用于近似索末菲辐射条件。它影响 $rR_{ABC}$ 区域内的问题。角点奇性是 $r=0$ 处的一个局部现象，由障碍物的非光滑几何形状和控制偏微分方程引起。ABC不改变角点处的物理或几何特性，因此不能消除奇性。解的正则性仍然很低（$u \\notin H^2$）。指数$p$-收敛仅对解析解可能。对于准均匀网格上的奇异解，收敛是代数的且非最优的，受限于奇异指数 $\\lambda$。\n**结论：不正确。**\n\n**C. 无限元层旨在通过映射径向坐标和定制基函数以适应出射行为来强制执行索末菲辐射条件，但它并不能正则化局部角点奇性；因此，除非在角点附近采用网格加密或用角点奇异函数丰富基函数，否则混合离散化的整体收敛性会受到角点奇性的限制。**\n无限元法（IEM）应用于外部域，通常对于某个耦合半径 $R0$ 的 $r \\ge R$ 区域。其目的是正确模拟向无穷远处的波传播。角点奇性存在于 $r=0$ 处，在有限元域内。IEM对角点处解的行为没有影响。混合FEM/IEM方案的总误差是FEM部分、IEM部分和耦合误差的总和。FEM部分的误差将由角点附近奇异解的较差近似所主导。对于尺寸为 $h$ 的准均匀网格，该误差在 $H^1$-范数下为 $\\mathcal{O}(h^\\lambda)$ 级别。为了恢复最优收敛速度，标准程序是使用分级网格（h-FEM）或用已知的奇异函数来丰富基函数（p/hp-FEM）。该陈述准确地描述了这种情况。\n**结论：正确。**\n\n**D. 在诺伊曼情况（TE）下，主导角点奇性的形式为 $u(r,\\theta) \\sim r^{\\lambda} \\cos(\\lambda \\theta)$，其最小正指数 $\\lambda = \\dfrac{\\pi}{\\Theta} = \\dfrac{\\pi}{2\\pi - \\Theta_{\\mathrm{int}}}$ 与狄利克雷情况相同，因此需要等效的网格加密策略来恢复最优收敛性。**\n我们对诺伊曼情况的推导表明，主导项为 $u(r,\\theta) \\sim r^{\\lambda} \\cos(\\lambda\\theta)$，其中 $\\lambda = \\pi/\\Theta$。这个指数确实与狄利克雷情况相同。由于奇性的强度（由径向指数 $\\lambda$ 决定）在两种情况下是相同的，因此对FEM收敛性的影响是相同的。网格加密策略是根据 $\\lambda$ 的值设计的，以最优地分布近似误差。因此，相同的 $\\lambda$ 需要等效的网格加密。\n**结论：正确。**\n\n**E. 在无限元层中使用包含因子 $\\exp(i k r)$ 的振荡基函数，会增加 $r=0$ 处角点奇性的阶数，因此与非振荡基函数相比，会降低障碍物附近的近似精度。**\n在基函数中包含振荡因子 $\\exp(i k r)$ 是亥姆霍兹方程无限元的一个关键特征。它将波传播的正确物理特性构建到远场（$r \\to \\infty$）的近似空间中。这些基函数用于无限元层，该层远离障碍物（对于 $r \\ge R  0$）。$r=0$ 处的角点奇性是一种近场效应，由局部几何和边界条件决定。远场中基函数的选择对原点处奇性的数学形式或强度（阶数）没有影响。\n**结论：不正确。**", "answer": "$$\\boxed{ACD}$$", "id": "3318991"}, {"introduction": "最后的这项练习将理论转向地球物理传感领域的实际应用。您将为一个探地雷达（GPR）在分层各向异性地球上的模型进行编程实现，其中无限元概念通过导纳公式得以体现[@problem_id:3318977]。通过求解导波的特性，这个编程练习综合了本章的各个概念，用于分析一个复杂的、真实的波传播场景。", "problem": "考虑一个用于探地雷达（GPR）的二维横磁（TM）极化模型，其中场沿水平坐标 $x$ 以 $\\exp(i k_x x)$ 的形式变化，并沿垂直坐标 $y$ 衰减。垂直方向 $y$ 上的开放域要求通过一个无限元基底来处理，该基底在每个半空间中由指数衰减函数组成。分层地球被建模为：$y  0$ 的上半空间为空气层，$-d \\le y \\le 0$ 为有限厚度的各向异性土壤层，以及 $y  -d$ 的下半空间为各向异性土壤层。各向异性土壤层是单轴的，其光轴垂直于界面（竖直方向），其特性由相对介电常数张量 $\\boldsymbol{\\varepsilon}_r = \\mathrm{diag}(\\varepsilon_{x}, \\varepsilon_{y}, \\varepsilon_{z})$ 和各向同性的电导率 $\\sigma$ 描述。假设所有区域的磁导率均为 $\\mu = \\mu_0$。\n\n从频域 Maxwell 方程 $\\nabla \\times \\mathbf{E} = i \\omega \\mu \\mathbf{H}$ 和 $\\nabla \\times \\mathbf{H} = -i \\omega \\boldsymbol{\\varepsilon} \\mathbf{E} + \\sigma \\mathbf{E}$ 出发，对于与垂直轴对齐的单轴各向异性，通过强制平面波解和本构关系，可以推导出均匀单轴介质中的 TM 垂直衰减常数，得到\n$$\n\\gamma_j(k_x,\\omega) = \\sqrt{\\frac{\\varepsilon_{x,j}}{\\varepsilon_{z,j}}\\,k_x^2 - \\omega^2 \\mu_0 \\varepsilon_{x,j}},\n$$\n其中 $\\varepsilon_{x,j}$ 和 $\\varepsilon_{z,j}$ 是第 $j$ 层的复介电常数，由 $\\varepsilon_{x,j} = \\varepsilon_0 \\varepsilon_{r,x,j} - i \\sigma_j/\\omega$ 和 $\\varepsilon_{z,j} = \\varepsilon_0 \\varepsilon_{r,z,j} - i \\sigma_j/\\omega$ 给出，其中 $\\varepsilon_0$ 是真空介电常数。空气半空间具有各向同性介电常数 $\\varepsilon_{\\text{air}} = \\varepsilon_0$ 和波数 $k_0 = \\omega \\sqrt{\\mu_0 \\varepsilon_0}$，从而得到空气中的垂直衰减常数\n$$\n\\gamma_{\\text{air}}(k_x,\\omega) = \\sqrt{k_x^2 - k_0^2}.\n$$\n\n将每个区域中的 TM 特性导纳定义为\n$$\nY_j(k_x,\\omega) = \\frac{\\gamma_j(k_x,\\omega)}{\\omega \\mu_0},\n$$\n其中 $j$ 表示每个分层或半空间。对于一个厚度为 $d$、其后为一个导纳为 $Y_b$ 的半空间的有限厚度层，该有限层顶部的输入导纳由倏逝传输线关系式给出\n$$\nY_{\\text{in}}(k_x,\\omega) = Y_1 \\,\\frac{Y_b + Y_1 \\tanh\\!\\left(\\gamma_1 d\\right)}{Y_1 + Y_b \\tanh\\!\\left(\\gamma_1 d\\right)},\n$$\n其中 $Y_1$ 和 $\\gamma_1$ 是该有限层的特性导纳和垂直衰减常数。\n\n利用半空间的无限元基底，施加无外部源以及远离界面的辐射或衰减条件，得到 $y=0$ 处的表面波色散关系：\n$$\nF(k_x;\\omega) \\equiv Y_{\\text{air}}(k_x,\\omega) + Y_{\\text{in}}(k_x,\\omega) = 0.\n$$\n一个物理上允许的束缚表面波满足 $\\operatorname{Re}(k_x)  k_0$ 和 $\\operatorname{Re}(\\gamma_{\\text{air}})  0$，并且在每个有耗土壤区域中，$\\operatorname{Re}(\\gamma_j)  0$ 以确保波远离界面时衰减。复传播常数 $k_x$ 决定了沿界面的单位长度衰减 $\\alpha = \\operatorname{Im}(k_x)$，该值必须以 $\\mathrm{nepers/m}$ 为单位报告。为了量化空气-土壤界面对辐射的影响，定义空气中高度 $y=h$ 处的无量纲向上泄漏因子为\n$$\nL(h) = \\exp\\!\\left(-2\\,\\operatorname{Re}(\\gamma_{\\text{air}})\\,h\\right),\n$$\n它表示空气中倏逝场的振幅平方随高度的指数衰减；将 $L$ 以小数形式报告。如果在容差范围内未找到允许的束缚表面波根（例如，由于极端电导率阻止了波的束缚），则必须返回 $\\alpha = 0.0$ 和 $L = 1.0$。\n\n您的任务是：\n- 通过使用由 $\\gamma_{\\text{air}}$、$\\gamma_1$ 和 $\\gamma_2$ 所蕴含的指数基底，借助上述导纳公式，在半无限区域中实施无限元表示以强制衰减。\n- 求解非线性复数方程 $F(k_x;\\omega) = 0$ 以得到 $k_x$，方法是同时找到其实部和虚部的根，使用稳健的数值方法和满足 $\\operatorname{Re}(k_x)  k_0$ 的适当初始猜测值。\n- 计算并报告量 $\\alpha$（单位为 $\\mathrm{nepers/m}$）和 $L$（以指定单位的小数形式）。\n\n使用以下物理常数：$\\varepsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$ 和 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$。\n\n测试套件：\n- 案例 1 (理想情况): 频率 $f = 200\\times 10^{6}\\ \\mathrm{Hz}$，有限层厚度 $d = 0.5\\ \\mathrm{m}$，源高度 $h = 0.2\\ \\mathrm{m}$，有限层参数 $\\varepsilon_{r,x,1} = 4.0$，$\\varepsilon_{r,z,1} = 6.0$，$\\sigma_1 = 0.01\\ \\mathrm{S/m}$；底部半空间参数 $\\varepsilon_{r,x,2} = 9.0$，$\\varepsilon_{r,z,2} = 9.0$，$\\sigma_2 = 0.1\\ \\mathrm{S/m}$。\n- 案例 2 (边界情况，低损耗干沙): 频率 $f = 100\\times 10^{6}\\ \\mathrm{Hz}$，有限层厚度 $d = 1.0\\ \\mathrm{m}$，源高度 $h = 0.05\\ \\mathrm{m}$，有限层参数 $\\varepsilon_{r,x,1} = 2.3$，$\\varepsilon_{r,z,1} = 2.0$，$\\sigma_1 = 1.0\\times 10^{-4}\\ \\mathrm{S/m}$；底部半空间参数 $\\varepsilon_{r,x,2} = 3.0$，$\\varepsilon_{r,z,2} = 2.8$，$\\sigma_2 = 5.0\\times 10^{-4}\\ \\mathrm{S/m}$。\n- 案例 3 (边缘情况，湿粘土): 频率 $f = 300\\times 10^{6}\\ \\mathrm{Hz}$，有限层厚度 $d = 0.3\\ \\mathrm{m}$，源高度 $h = 0.1\\ \\mathrm{m}$，有限层参数 $\\varepsilon_{r,x,1} = 20.0$，$\\varepsilon_{r,z,1} = 25.0$，$\\sigma_1 = 1.0\\ \\mathrm{S/m}$；底部半空间参数 $\\varepsilon_{r,x,2} = 30.0$，$\\varepsilon_{r,z,2} = 30.0$，$\\sigma_2 = 5.0\\ \\mathrm{S/m}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\alpha_1,L_1,\\alpha_2,L_2,\\alpha_3,L_3]$，其中每个 $\\alpha$ 的单位是 $\\mathrm{nepers/m}$，每个 $L$ 是一个小数。为了数值稳定性和可读性，返回浮点值；如果未找到束缚表面波根，则 $\\alpha$ 返回 $0.0$，$L$ 返回 $1.0$。", "solution": "所提供的问题是计算电磁学中一个有效且适定的问题。其目标是找到由分层地球结构引导的横磁（TM）表面波的复传播常数 $k_x$，并由此推导出衰减和一个泄漏因子。这是通过求解一个复非线性色散关系 $F(k_x; \\omega) = 0$ 来完成的。求解过程首先将物理模型转化为一组复值数学函数，然后采用数值求根算法。\n\n首先，我们确定常数和频率相关的参数。对于每个给定的频率 $f$，角频率为 $\\omega = 2 \\pi f$，真空波数为 $k_0 = \\omega \\sqrt{\\mu_0 \\varepsilon_0}$。每个土壤层 $j$ 的物理特性由水平和垂直方向的复介电常数 $\\varepsilon_{x,j}$ 和 $\\varepsilon_{z,j}$ 来描述。它们由 $\\varepsilon_{x,j} = \\varepsilon_0 \\varepsilon_{r,x,j} - i \\sigma_j/\\omega$ 和 $\\varepsilon_{z,j} = \\varepsilon_0 \\varepsilon_{r,z,j} - i \\sigma_j/\\omega$ 给出，其中 $\\varepsilon_0$ 是真空介电常数，$\\varepsilon_{r,x,j}$ 和 $\\varepsilon_{r,z,j}$ 是相对介电常数，$\\sigma_j$ 是电导率。\n\n模型的核心在于垂直衰减常数（用 $\\gamma$ 表示）和特性导纳（用 $Y$ 表示）的表达式。这些量是未知的复水平波数 $k_x$ 的函数。对于上半空气半空间（$y  0$），衰减常数和导纳为：\n$$ \\gamma_{\\text{air}}(k_x) = \\sqrt{k_x^2 - k_0^2} $$\n$$ Y_{\\text{air}}(k_x) = \\frac{\\gamma_{\\text{air}}(k_x)}{\\omega \\mu_0} $$\n对于每个各向异性土壤层 $j$（其中 $j=1$ 代表有限层，$j=2$ 代表底部半空间），它们是：\n$$ \\gamma_j(k_x) = \\sqrt{\\frac{\\varepsilon_{x,j}}{\\varepsilon_{z,j}} k_x^2 - \\omega^2 \\mu_0 \\varepsilon_{x,j}} $$\n$$ Y_j(k_x) = \\frac{\\gamma_j(k_x)}{\\omega \\mu_0} $$\n波必须在远离界面处衰减的物理条件要求每个区域的 $\\operatorname{Re}(\\gamma)  0$。在计算复数平方根时，我们必须选择主支，其具有非负的实部。这是像 `NumPy` 这样的数值库的默认行为，因此会自动满足该条件。\n\n针对半无限域（空气和底部土壤层）的无限元方法是通过导纳形式体系来实现的。向下看入底部半空间（第 2 层）的导纳就是其特性导纳，$Y_b = Y_2(k_x)$。从空气-土壤界面（$y=0$）向下看的导纳是厚度为 $d$、后接第 2 层的有限层（第 1 层）的输入导纳 $Y_{\\text{in}}(k_x)$。这是使用传输线输入导纳变换计算的：\n$$ Y_{\\text{in}}(k_x) = Y_1(k_x) \\frac{Y_2(k_x) + Y_1(k_x) \\tanh(\\gamma_1(k_x) d)}{Y_1(k_x) + Y_2(k_x) \\tanh(\\gamma_1(k_x) d)} $$\n束缚表面波存在的条件是，在没有外部源的情况下，切向场在 $y=0$ 界面上是连续的。这导致了横向谐振条件，要求向上看（$Y_{\\text{air}}$）和向下看（$Y_{\\text{in}}$）的导纳之和为零。这就给出了需要求解 $k_x$ 的最终色散关系：\n$$ F(k_x) \\equiv Y_{\\text{air}}(k_x) + Y_{\\text{in}}(k_x) = 0 $$\n由于 $k_x$ 是复数，$k_x = k_{x,r} + i k_{x,i}$，这个单一的复数方程等价于一个由两个实数方程组成的系统：$\\operatorname{Re}[F(k_x)] = 0$ 和 $\\operatorname{Im}[F(k_x)] = 0$。我们使用一个数值例程，特别是 `scipy.optimize.root`，来求解这个关于两个未知数 $(k_{x,r}, k_{x,i})$ 的系统。\n\n一个关键步骤是为求解器提供一个合适的初始猜测值。束缚表面波是一种“慢波”，意味着它沿界面的相速度小于上层介质（空气）中的光速。这意味着其水平波数必须大于空气波数，即 $\\operatorname{Re}(k_x)  k_0$。因此，一个具有物理动机的初始猜测值是，其实部略大于 $k_0$，虚部为一个小的正值（以计入预期的损耗），例如 $k_x^{(0)} = 1.05 k_0 + i 0.1 k_0$。\n\n在找到 $k_x$ 的数值解后，我们必须验证其物理上的可容许性。主要条件是 $\\operatorname{Re}(k_x)  k_0$。如果求解器未能收敛，或者所得的根不满足此条件，我们断定在给定参数下不存在可容许的束缚表面波，并返回指定的默认值 $\\alpha = 0.0$ 和 $L = 1.0$。如果找到了可容许的根，我们就计算所需的输出。衰减常数是解的虚部，$\\alpha = \\operatorname{Im}(k_x)$。在高度 $h$ 处的向上泄漏因子 $L$ 计算为 $L(h) = \\exp(-2 \\operatorname{Re}(\\gamma_{\\text{air}}(k_x)) h)$，其中 $\\gamma_{\\text{air}}$ 使用已解出的 $k_x$ 值进行评估。对每个测试案例重复此过程。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the surface-wave dispersion relation for a three-layer GPR model\n    to find the attenuation constant and upward leakage factor.\n    \"\"\"\n    \n    # Physical constants\n    EPS0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    MU0 = 4 * np.pi * 1e-7   # Vacuum permeability in H/m\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: f, d, h, (erx1, erz1, sigma1), (erx2, erz2, sigma2)\n        (200e6, 0.5, 0.2, (4.0, 6.0, 0.01), (9.0, 9.0, 0.1)),\n        # Case 2\n        (100e6, 1.0, 0.05, (2.3, 2.0, 1.0e-4), (3.0, 2.8, 5.0e-4)),\n        # Case 3\n        (300e6, 0.3, 0.1, (20.0, 25.0, 1.0), (30.0, 30.0, 5.0)),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        f, d, h, params1, params2 = case\n        \n        omega = 2.0 * np.pi * f\n        k0 = omega * np.sqrt(MU0 * EPS0)\n\n        erx1, erz1, sigma1 = params1\n        erx2, erz2, sigma2 = params2\n\n        # Complex permittivities for the layers\n        eps_x1 = EPS0 * erx1 - 1j * sigma1 / omega\n        eps_z1 = EPS0 * erz1 - 1j * sigma1 / omega\n        eps_x2 = EPS0 * erx2 - 1j * sigma2 / omega\n        eps_z2 = EPS0 * erz2 - 1j * sigma2 / omega\n\n        def dispersion_function_system(k_vec):\n            \"\"\"\n            Represents the complex dispersion relation F(kx) = 0 as a system\n            of two real equations Re[F(kx)] = 0, Im[F(kx)] = 0.\n            \n            Args:\n                k_vec: A real numpy array [Re(kx), Im(kx)].\n            \n            Returns:\n                A real numpy array [Re(F), Im(F)].\n            \"\"\"\n            kx = k_vec[0] + 1j * k_vec[1]\n            \n            # Vertical decay constant in air. np.sqrt of a complex number\n            # returns the principal root with a non-negative real part,\n            # which satisfies the physical decay condition Re(gamma) = 0.\n            gamma_air = np.sqrt(kx**2 - k0**2)\n            \n            # Vertical decay constants in soil layers\n            gamma1_sq_arg = (eps_x1 / eps_z1) * kx**2 - omega**2 * MU0 * eps_x1\n            gamma1 = np.sqrt(gamma1_sq_arg)\n            \n            gamma2_sq_arg = (eps_x2 / eps_z2) * kx**2 - omega**2 * MU0 * eps_x2\n            gamma2 = np.sqrt(gamma2_sq_arg)\n\n            # Characteristic admittances\n            Y_air = gamma_air / (omega * MU0)\n            Y1 = gamma1 / (omega * MU0)\n            Y2 = gamma2 / (omega * MU0) # Y_b, the backing admittance\n            \n            # Input admittance at y=0, looking into the layered earth\n            tanh_g1d = np.tanh(gamma1 * d)\n            # Avoid division by zero if denominator is numerically zero\n            denominator = (Y1 + Y2 * tanh_g1d)\n            if np.abs(denominator)  1e-18:\n                 # This case is unlikely to be the root of F=0 unless Y1 is huge,\n                 # but serves as a safeguard.\n                 return [1e12, 1e12]\n            Y_in = Y1 * (Y2 + Y1 * tanh_g1d) / denominator\n            \n            # The dispersion function to be zeroed: F(kx) = Y_air(kx) + Y_in(kx)\n            F = Y_air + Y_in\n            \n            return [np.real(F), np.imag(F)]\n\n        # Initial guess for kx. A bound surface wave must have Re(kx)  k0.\n        # Guess is a slow wave with some initial attenuation.\n        initial_guess = [k0 * 1.05, k0 * 0.1]\n        \n        # Solve the system of nonlinear equations Re(F)=0, Im(F)=0\n        sol = root(dispersion_function_system, initial_guess, method='hybr', tol=1e-9)\n\n        found_admissible_root = False\n        if sol.success:\n            kx_sol = sol.x[0] + 1j * sol.x[1]\n            \n            # Check the admissibility condition for a bound surface wave\n            if np.real(kx_sol)  k0:\n                found_admissible_root = True\n                \n                alpha = np.imag(kx_sol)\n                gamma_air_sol = np.sqrt(kx_sol**2 - k0**2)\n                L = np.exp(-2.0 * np.real(gamma_air_sol) * h)\n                \n                results.extend([alpha, L])\n        \n        if not found_admissible_root:\n            # If solver fails or the root is not physically admissible\n            alpha = 0.0\n            L = 1.0\n            results.extend([alpha, L])\n\n    # Format the final output as a single comma-separated line in brackets.\n    # We use a floating-point format with sufficient precision.\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```", "id": "3318977"}]}