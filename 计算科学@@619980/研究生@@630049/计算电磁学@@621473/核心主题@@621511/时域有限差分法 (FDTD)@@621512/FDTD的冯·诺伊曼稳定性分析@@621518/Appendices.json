{"hands_on_practices": [{"introduction": "理论的基石是严格的推导。这项练习将指导您从麦克斯韦方程组和 Yee 元胞的中心差分格式出发，通过冯·诺依曼稳定性分析，推导出三维 FDTD 方法的数值色散关系。这个过程不仅是理解 FDTD 方法稳定性的核心，也揭示了时间步长、空间步长和波在离散网格上传播的数值行为之间的深刻联系。通过完成这项练习，您将能够从根本上掌握著名的 Courant-Friedrichs-Lewy (CFL) 稳定条件的由来及其在各向异性网格中的应用。", "problem": "考虑真空中的齐次、无源的麦克斯韦旋度方程，\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t}=-\\nabla\\times\\mathbf{E},\\qquad \\frac{\\partial \\mathbf{D}}{\\partial t}=\\nabla\\times\\mathbf{H},\n$$\n以及真空中的本构关系 $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ 和 $\\mathbf{B}=\\mu_{0}\\mathbf{H}$，其中 $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$ 是光速。使用经典二阶中心 Yee 时域有限差分（Finite-Difference Time-Domain, FDTD）格式在三维直角网格上对这些方程进行离散化，其空间步长为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$，并采用蛙跳格式的时间步长 $\\Delta t$，电场和磁场按照标准 Yee 排列在空间和时间上交错分布。\n\n1) 应用以下形式的离散平面波拟设\n$$\n\\mathbf{E}^{n}(\\mathbf{r}_{\\mathbf{m}})=\\mathbf{E}_{0}\\,G^{n}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\\qquad\n\\mathbf{H}^{n+\\frac{1}{2}}(\\mathbf{r}_{\\mathbf{m}+\\frac{1}{2}})=\\mathbf{H}_{0}\\,G^{n+\\frac{1}{2}}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\n$$\n其中 $\\theta_{x}=k_{x}\\Delta x$，$\\theta_{y}=k_{y}\\Delta y$，$\\theta_{z}=k_{z}\\Delta z$，通过 $G=\\exp(-i\\omega\\Delta t)$ 的关系，推导连接离散角频率 $\\omega$ 和波数 $k_{x}$、$k_{y}$、$k_{z}$ 的离散数值色散关系。你的推导必须从麦克斯韦旋度方程和 Yee 中心差分近似开始，并经过 von Neumann 分析，该分析消除了场振幅，从而得到一个关于 $\\omega$、$k_{x}$、$k_{y}$、$k_{z}$ 和空间步长的标量关系。\n\n2) 解释所得到的数值色散关系如何根据“对于所有可分辨的空间频率，放大因子的模必须小于或等于1”这一要求，来导出对时间步长的稳定性约束。\n\n3) 将你的结果应用于网格 $\\Delta x=\\Delta$、$\\Delta y=2\\Delta$ 和 $\\Delta z=3\\Delta$ 的情况，并定义 Courant 数 $\\sigma=c\\,\\Delta t/\\Delta$。对于所有离散波数，确保稳定性的最大允许 Courant 数 $\\sigma_{\\max}$ 是多少？请以单个精确值的形式给出最终答案，不带单位。不要提供不等式。", "solution": "所述问题在科学上是合理的、提法得当的，并包含了推导唯一解所需的所有必要信息。它代表了计算电磁学中一个标准且基础的分析。因此，我们可以开始求解。\n\n根据问题陈述的要求，解答分为三个部分。\n\n1) 数值色散关系的推导。\n\n我们从真空中的无源麦克斯韦旋度方程开始：\n$$\n\\mu_{0}\\frac{\\partial \\mathbf{H}}{\\partial t}=-\\nabla\\times\\mathbf{E}\n$$\n$$\n\\varepsilon_{0}\\frac{\\partial \\mathbf{E}}{\\partial t}=\\nabla\\times\\mathbf{H}\n$$\nYee FDTD 格式在交错网格上离散化这些方程。蛙跳格式在交替的半个时间步长上更新电场和磁场。中心有限差分更新方程为：\n$$\n\\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} \\hat{\\nabla} \\times \\mathbf{H}^{n+\\frac{1}{2}}\n$$\n$$\n\\frac{\\mathbf{H}^{n+\\frac{1}{2}} - \\mathbf{H}^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\hat{\\nabla} \\times \\mathbf{E}^{n}\n$$\n其中 $\\hat{\\nabla}\\times$ 是离散旋度算子，场在各自交错的时空位置上进行评估。\n\n为了进行 von Neumann 稳定性分析，我们代入问题中给出的离散平面波拟设。作用于平面波拟设的离散旋度算子 $\\hat{\\nabla}\\times$ 等效于乘以向量算子 $i\\mathbf{k}_{\\text{eff}}$，其中 $\\mathbf{k}_{\\text{eff}}$ 是有效数值波矢量，其分量为：\n$$\nk_{\\text{eff},x} = \\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right), \\quad k_{\\text{eff},y} = \\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right), \\quad k_{\\text{eff},z} = \\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\n$$\n将拟设代入电场更新方程：\n$$\n\\frac{\\mathbf{E}_{0}G^{n+1} - \\mathbf{E}_{0}G^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{n+\\frac{1}{2}}\n$$\n两边同除以 $G^{n}$：\n$$\n\\frac{\\mathbf{E}_{0}(G - 1)}{\\Delta t} = \\frac{i}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{E}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = \\frac{i\\Delta t}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\n将拟设代入磁场更新方程：\n$$\n\\frac{\\mathbf{H}_{0}G^{n+\\frac{1}{2}} - \\mathbf{H}_{0}G^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{n}\n$$\n两边同除以 $G^{n-1/2}$：\n$$\n\\frac{\\mathbf{H}_{0}(G - 1)}{\\Delta t} = -\\frac{i}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{H}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = -\\frac{i\\Delta t}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\n令 $(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}})$ 项表示为 $A$。我们得到一个由两个代数矢量方程组成的系统：\n$$\n(1) \\quad \\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\n$$\n(2) \\quad \\mu_{0} A \\mathbf{H}_{0} = -i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\n我们通过将 (2) 式代入 (1) 式来消去 $\\mathbf{H}_{0}$。由 (2) 式可得 $\\mathbf{H}_{0} = -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})$。\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t \\left( \\mathbf{k}_{\\text{eff}} \\times \\left( -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right) \\right) = \\frac{(\\Delta t)^2}{\\mu_0 A} \\left( \\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right)\n$$\n使用矢量恒等式 $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{c}) - \\mathbf{c}(\\mathbf{a} \\cdot \\mathbf{b})$ 以及对于横波 $\\mathbf{k}_{\\text{eff}} \\cdot \\mathbf{E}_{0} = 0$ 的事实，我们有 $\\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) = -k_{\\text{eff}}^2 \\mathbf{E}_{0}$。\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = -\\frac{(\\Delta t)^2 k_{\\text{eff}}^2}{\\mu_0 A} \\mathbf{E}_{0}\n$$\n由于 $\\mathbf{E}_0$ 非零，我们可以消去它：\n$$\n\\mu_0 \\varepsilon_0 A^2 = -(\\Delta t)^2 k_{\\text{eff}}^2 \\implies \\frac{A^2}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\n现在，代入 $G = \\exp(-i\\omega\\Delta t)$。项 $A = G^{\\frac{1}{2}} - G^{-\\frac{1}{2}} = \\exp(-i\\omega\\Delta t/2) - \\exp(i\\omega\\Delta t/2) = -2i\\sin(\\omega\\Delta t/2)$。\n所以，$A^2 = -4\\sin^2(\\omega\\Delta t/2)$。\n$$\n\\frac{-4\\sin^2(\\omega\\Delta t/2)}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\n$$\n\\left(\\frac{2}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = k_{\\text{eff}}^2 = \\left(\\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\n化简后，我们得到数值色散关系：\n$$\n\\left(\\frac{1}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = \\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\n\n2) 对稳定性约束的推论。\n\n为了使数值格式稳定，放大因子 $G$ 的模对于所有可能的模式都必须小于或等于 1，即 $|G| \\le 1$。如果 $|G|1$，任何数值误差或场分量都将随时间指数增长，从而使模拟失效。\n关系式 $G=\\exp(-i\\omega\\Delta t)$ 将 $G$ 与数值频率 $\\omega$ 联系起来。如果 $\\omega$ 是纯实数，则 $|G|=|\\exp(-i\\omega\\Delta t)|=1$。如果 $\\omega$ 有虚部，$\\omega = \\omega_R + i\\omega_I$，则 $|G|=|\\exp(-i(\\omega_R+i\\omega_I)\\Delta t)| = |\\exp(\\omega_I \\Delta t)\\exp(-i\\omega_R \\Delta t)| = \\exp(\\omega_I \\Delta t)$。为保证稳定性（$|G|\\le 1$），我们必须有 $\\omega_I \\le 0$。一个 $\\omega_I  0$ 的解是一个衰减的、非物理的模式，但它是稳定的。指数增长的模式（$\\omega_I  0$）对应于不稳定性。\n\n色散关系可以重新整理以求解 $\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)$：\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\pm c\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2}\n$$\n为了使 $\\omega$ 为实数，项 $\\sin(\\omega\\Delta t/2)$ 必须是一个模小于或等于 $1$ 的实数。方程的右侧始终为实数。因此，稳定性条件简化为：\n$$\n\\left| \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right| \\le 1\n$$\n这意味着：\n$$\nc\\Delta t \\sqrt{\\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 + \\left(\\frac{\\sin(k_z \\Delta z/2)}{\\Delta z}\\right)^2} \\le 1\n$$\n这个不等式必须对网格可以分辨的所有空间频率 $(k_x, k_y, k_z)$ 成立。为了确保这一点，我们必须检查使左侧最大化的“最坏情况”。在奈奎斯特（Nyquist）频率处，即 $k_j \\Delta j = \\pi$ (其中 $j \\in \\{x,y,z\\}$)，正弦项达到最大值 1。将所有分量的 $\\sin(k_j\\Delta j/2) = \\sin(\\pi/2)=1$ 代入，得到最严格的条件：\n$$\nc\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2} \\le 1\n$$\n这就是著名的三维 FDTD 方法的 Courant-Friedrichs-Lewy (CFL) 稳定性条件。\n\n3) 指定网格的最大 Courant 数。\n\n给定网格步长 $\\Delta x = \\Delta$，$\\Delta y = 2\\Delta$，和 $\\Delta z = 3\\Delta$，Courant 数定义为 $\\sigma = c\\Delta t/\\Delta$。我们将这些代入第 2 部分推导出的通用稳定性条件：\n$$\nc\\Delta t \\sqrt{\\frac{1}{(\\Delta)^2} + \\frac{1}{(2\\Delta)^2} + \\frac{1}{(3\\Delta)^2}} \\le 1\n$$\n从平方根中提出因子 $1/\\Delta$：\n$$\n\\frac{c\\Delta t}{\\Delta} \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\n代入 Courant 数 $\\sigma$ 的定义：\n$$\n\\sigma \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\n现在，我们化简平方根下的表达式：\n$$\n1 + \\frac{1}{4} + \\frac{1}{9} = \\frac{36}{36} + \\frac{9}{36} + \\frac{4}{36} = \\frac{49}{36}\n$$\n不等式变为：\n$$\n\\sigma \\sqrt{\\frac{49}{36}} \\le 1 \\implies \\sigma \\frac{7}{6} \\le 1\n$$\n这给出了对 $\\sigma$ 的稳定性约束：\n$$\n\\sigma \\le \\frac{6}{7}\n$$\n最大允许 Courant 数 $\\sigma_{\\max}$ 是此不等式边界上的值。因此，\n$$\n\\sigma_{\\max} = \\frac{6}{7}\n$$", "answer": "$$\\boxed{\\frac{6}{7}}$$", "id": "3360079"}, {"introduction": "仅仅知道稳定性的边界是不够的，理解跨越边界的后果同样重要。这项练习将引导您探索当时间步长违反一维 FDTD 格式的 CFL 条件时会发生什么。您将不仅仅是判断一个方案是否稳定，而是要定量地推导出不稳定模式的振幅随时间增长的速率。这项实践将使您对“数值不稳定”这一概念有一个更具体、更深刻的认识，直观地理解为何不稳定的计算结果会迅速地被非物理的指数增长所淹没。", "problem": "考虑横电磁波的一维自由空间麦克斯韦方程组，其电场分量为 $E_{y}$，磁场分量为 $H_{z}$，使用时域有限差分 (FDTD) 方法的标准交错 Yee 格式进行离散化。设空间网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，介电常数为 $\\epsilon$，磁导率为 $\\mu$，光速为 $c = 1/\\sqrt{\\epsilon \\mu}$。蛙跳格式更新方程为\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = H_{z}^{n-\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\left[E_{y}^{n}(m+1) - E_{y}^{n}(m)\\right],\n$$\n$$\nE_{y}^{n+1}(m) = E_{y}^{n}(m) - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left[H_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - H_{z}^{n+\\frac{1}{2}}\\!\\left(m-\\frac{1}{2}\\right)\\right].\n$$\n通过假设以下形式的离散平面波解，进行 von Neumann (傅里叶) 稳定性分析：\n$$\nE_{y}^{n}(m) = \\tilde{E}\\,\\exp\\!\\left(i\\,m\\,\\kappa\\right)\\exp\\!\\left(i\\,n\\,\\Omega\\right),\\qquad\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\left(m+\\tfrac{1}{2}\\right)\\kappa\\right)\\exp\\!\\left(i\\left(n+\\tfrac{1}{2}\\right)\\Omega\\right),\n$$\n其中 $\\kappa = k\\,\\Delta x$ 是无量纲波数，$\\Omega = \\omega\\,\\Delta t$ 是无量纲角频率。设 Courant-Friedrichs-Lewy (CFL) 数为 $S = c\\,\\Delta t/\\Delta x$。假设时间步长轻微违反 CFL 界限，使得\n$$\n\\Delta t = (1+\\delta)\\frac{\\Delta x}{c},\\quad \\delta  0,\n$$\n即 $S = 1+\\delta  1$。定义时间不稳定性增长率 $\\gamma$ 为一个实数，使得在连续时间 $t = n\\,\\Delta t$ 中，不稳定模式的振幅按 $\\exp(\\gamma\\,t)$ 的比例变化。\n\n对于所有离散空间波数 $\\kappa \\in [0,\\pi]$，确定此一维自由空间 Yee 格式的最大时间不稳定性增长率 $\\gamma_{\\max}$，并将其表示为关于 $c$、$\\Delta x$ 和 $\\delta$ 的闭式解析表达式。最终答案以 $\\mathrm{s}^{-1}$ 为单位表示。", "solution": "问题要求在一维 Yee FDTD 格式中，当 Courant-Friedrichs-Lewy (CFL) 稳定性条件被违反时，求最大时间不稳定性增长率 $\\gamma_{\\max}$。该分析将使用 von Neumann (傅里叶) 方法进行。\n\n出发点是横向电场分量 $E_{y}$ 和磁场分量 $H_{z}$ 的时域有限差分 (FDTD) 更新方程组：\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = H_{z}^{n-\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\left[E_{y}^{n}(m+1) - E_{y}^{n}(m)\\right]\n$$\n$$\nE_{y}^{n+1}(m) = E_{y}^{n}(m) - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left[H_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - H_{z}^{n+\\frac{1}{2}}\\!\\left(m-\\frac{1}{2}\\right)\\right]\n$$\n这里，$m$ 是空间索引，$n$ 是时间索引。$\\Delta x$ 是空间步长，$\\Delta t$ 是时间步长，$\\epsilon$ 是介电常数，$\\mu$ 是磁导率。\n\n我们假设给定形式的离散平面波解（单个傅里叶模式）：\n$$\nE_{y}^{n}(m) = \\tilde{E}\\,\\exp\\!\\left(i\\,m\\,\\kappa\\right)\\exp\\!\\left(i\\,n\\,\\Omega\\right)\n$$\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\left(m+\\tfrac{1}{2}\\right)\\kappa\\right)\\exp\\!\\left(i\\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\n$$\n其中 $\\tilde{E}$ 和 $\\tilde{H}$ 是复振幅，$\\kappa = k\\,\\Delta x$ 是无量纲波数，$\\Omega = \\omega\\,\\Delta t$ 是无量纲角频率。\n\n将这些拟设形式代入 FDTD 更新方程，可将差分方程转化为代数方程。\n\n对于 $H_z$ 更新方程，在代入平面波形式并除以公共因子 $\\exp(i\\,m\\,\\kappa)\\exp(i\\,n\\,\\Omega)$ 后，我们得到：\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\exp\\!\\left(i\\frac{\\Omega}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\exp\\!\\left(-i\\frac{\\Omega}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\left[\\exp(i\\kappa) - 1\\right]\n$$\n整理各项：\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( \\exp\\!\\left(i\\frac{\\Omega}{2}\\right) - \\exp\\!\\left(-i\\frac{\\Omega}{2}\\right) \\right) = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( \\exp\\!\\left(i\\frac{\\kappa}{2}\\right) - \\exp\\!\\left(-i\\frac{\\kappa}{2}\\right) \\right)\n$$\n使用欧拉公式 $\\sin(x) = (e^{ix}-e^{-ix})/(2i)$：\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( 2i\\sin\\!\\left(\\frac{\\Omega}{2}\\right) \\right) = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( 2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\right)\n$$\n这简化为一个关联 $\\tilde{E}$ 和 $\\tilde{H}$ 的线性方程：\n$$\n\\sin\\!\\left(\\frac{\\Omega}{2}\\right)\\tilde{H} = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\tilde{E}\n$$\n\n类似地，对于 $E_y$ 更新方程，代入平面波形式可得：\n$$\n\\tilde{E}\\,\\exp(i\\Omega) = \\tilde{E} - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left[\\exp\\!\\left(i\\frac{\\kappa}{2}\\right) - \\exp\\!\\left(-i\\frac{\\kappa}{2}\\right)\\right]\n$$\n整理并使用欧拉公式：\n$$\n\\tilde{E}\\left(\\exp(i\\Omega) - 1\\right) = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n$$\n\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(\\exp\\!\\left(i\\frac{\\Omega}{2}\\right) - \\exp\\!\\left(-i\\frac{\\Omega}{2}\\right)\\right) = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n这简化为第二个线性方程：\n$$\n\\sin\\!\\left(\\frac{\\Omega}{2}\\right)\\tilde{E} = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\tilde{H}\n$$\n\n现在我们得到了一个关于 $\\tilde{E}$ 和 $\\tilde{H}$ 的齐次线性方程组。为了存在非平凡解，系数矩阵的行列式必须为零：\n$$\n\\begin{vmatrix} \\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)  \\sin\\!\\left(\\frac{\\Omega}{2}\\right) \\\\ \\sin\\!\\left(\\frac{\\Omega}{2}\\right)  \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\end{vmatrix} = 0\n$$\n$$\n\\left(\\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\\left(\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right) - \\sin^2\\!\\left(\\frac{\\Omega}{2}\\right) = 0\n$$\n使用光速关系式 $c = 1/\\sqrt{\\epsilon\\mu}$ 和 Courant-Friedrichs-Lewy (CFL) 数的定义 $S = c\\,\\Delta t/\\Delta x$，上式简化为一维 Yee 格式的数值色散关系：\n$$\n\\sin^2\\!\\left(\\frac{\\Omega}{2}\\right) = \\frac{c^2(\\Delta t)^2}{(\\Delta x)^2}\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right) = S^2\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right)\n$$\n每个时间步长的放大因子为 $G = \\exp(i\\Omega)$。为保证稳定性，我们要求 $|G| \\le 1$。令 $X = \\exp(i\\Omega/2)$，则 $G = X^2$。色散关系给出 $\\sin(\\Omega/2) = \\pm S\\sin(\\kappa/2)$。使用 $\\sin(\\theta) = (e^{i\\theta}-e^{-i\\theta})/(2i)$，我们可以写出：\n$$\n\\frac{X - X^{-1}}{2i} = \\pm S\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\implies X^2 - \\left(\\pm 2iS\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)X - 1 = 0\n$$\n这是一个关于 $X$ 的二次方程，其解为：\n$$\nX = \\pm iS\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\pm \\sqrt{1 - S^2\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right)}\n$$\n为使格式稳定，所有 $X$ 的解的模必须满足 $|X| \\le 1$。如果 $S^2\\sin^2(\\kappa/2) \\le 1$，则平方根下的项为非负，且 $|X|^2 = (S\\sin(\\kappa/2))^2 + (1 - S^2\\sin^2(\\kappa/2)) = 1$。此时格式是稳定的（且非耗散的）。此条件必须对所有 $\\kappa \\in [0, \\pi]$ 成立。由于 $\\max_{\\kappa \\in [0, \\pi]} \\sin^2(\\kappa/2) = 1$（在 $\\kappa=\\pi$ 处取到），因此稳定性条件是 $S \\le 1$。\n\n题目指出该条件被违反，即 $S=1+\\delta  1$。在这种情况下，存在一个波数 $\\kappa$ 的范围，使得 $S^2\\sin^2(\\kappa/2)  1$。对于这些波数，平方根下的项为负，导致不稳定模式。令 $A = S\\sin(\\kappa/2)$。对于 $A1$：\n$$\nX = \\pm iA \\pm i\\sqrt{A^2 - 1} = i\\left(\\pm A \\pm \\sqrt{A^2-1}\\right)\n$$\n$X$ 的解是纯虚数。不稳定模式对应于模大于 1 的解。$X$ 的四个解的模为 $|A \\pm \\sqrt{A^2-1}|$。两个不稳定解的模为 $|X| = A + \\sqrt{A^2-1}$。\n每个完整时间步长的放大因子的模 $|G|$ 是 $|X|^2$：\n$$\n|G| = \\left(A + \\sqrt{A^2-1}\\right)^2\n$$\n不稳定模式的振幅在 $n$ 个时间步长后增长为 $|G|^n$。我们通过振幅缩放关系 $\\exp(\\gamma t) = \\exp(\\gamma n \\Delta t)$ 将其与连续时间增长率 $\\gamma$ 联系起来。\n$$\n\\exp(\\gamma n \\Delta t) = (|G|)^n \\implies \\exp(\\gamma \\Delta t) = |G|\n$$\n取自然对数，我们求得 $\\gamma$：\n$$\n\\gamma \\Delta t = \\ln|G| = \\ln\\left[\\left(A + \\sqrt{A^2-1}\\right)^2\\right] = 2\\ln\\left(A + \\sqrt{A^2-1}\\right)\n$$\n对于 $x \\ge 1$，使用恒等式 $\\arccosh(x) = \\ln(x+\\sqrt{x^2-1})$：\n$$\n\\gamma \\Delta t = 2\\,\\arccosh(A) \\implies \\gamma = \\frac{2}{\\Delta t}\\arccosh\\left(S\\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n该表达式给出了增长率作为离散波数 $\\kappa$ 的函数。为了找到最大增长率 $\\gamma_{\\max}$，我们必须在所有可能的波数 $\\kappa \\in [0, \\pi]$ 上最大化此表达式。函数 $\\arccosh(x)$ 在 $x \\ge 1$ 上是单调递增的。因此，我们需要最大化其自变量 $S\\sin(\\kappa/2)$。这在 $\\sin(\\kappa/2)$ 取最大值时发生，即在 $\\kappa=\\pi$ 处，此时 $\\sin(\\pi/2)=1$。\n在此波数下，自变量为 $S$。因此，最大增长率为：\n$$\n\\gamma_{\\max} = \\frac{2}{\\Delta t}\\arccosh(S)\n$$\n最后，我们用给定的参数 $c$、$\\Delta x$ 和 $\\delta$ 来表示它。给定 $S=1+\\delta$ 和 $\\Delta t = (1+\\delta) \\frac{\\Delta x}{c}$。将这些代入 $\\gamma_{\\max}$ 的表达式中：\n$$\n\\gamma_{\\max} = \\frac{2}{(1+\\delta)\\frac{\\Delta x}{c}}\\arccosh(1+\\delta)\n$$\n$$\n\\gamma_{\\max} = \\frac{2c}{(1+\\delta)\\Delta x}\\arccosh(1+\\delta)\n$$\n单位是秒的倒数，符合要求。", "answer": "$$\\boxed{\\frac{2c}{(1+\\delta)\\Delta x}\\arccosh(1+\\delta)}$$", "id": "3360162"}, {"introduction": "在实际的电磁仿真中，我们处理的材料往往不是理想的无损介质。这项练习将冯·诺依曼分析的应用扩展到包含导电损耗的复杂媒质中。您将分析在有耗媒质中，描述物理损耗的电导率 $\\sigma$ 是如何影响 FDTD 更新方程的放大系数 $G$ 的。通过这个过程，您将发现一个重要且在实践中非常有用的结论：物理损耗的存在如何改变数值稳定性的条件，这对于精确模拟真实世界中的电磁问题至关重要。", "problem": "考虑在均匀、各向同性、非磁性介质中，求解麦克斯韦方程组的三维时域有限差分 (FDTD) 方法（Yee 格式）。该介质的电容率为 $\\epsilon=\\epsilon_{0}\\epsilon_{r}$，磁导率为 $\\mu=\\mu_{0}$，并具有有限电导率 $\\sigma \\ge 0$。包含传导项的控制旋度方程为\n$$\n\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} + \\sigma \\mathbf{E} = \\nabla \\times \\mathbf{H}, \n\\qquad\n\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} = - \\nabla \\times \\mathbf{E}.\n$$\n在间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的均匀 Yee 网格上，设 $\\mathbf{E}$ 在半整数时间步 $t^{n+1/2}$ 采样，$\\mathbf{H}$ 在整数时间步 $t^{n}$ 采样。对传导项使用时间中心差分离散，即用 $\\sigma \\left(\\mathbf{E}^{n+1/2} + \\mathbf{E}^{n-1/2}\\right)/2$ 来近似时间 $t^{n}$ 处的 $\\sigma \\mathbf{E}$。这会得到以下形式的标准显式更新\n$$\n\\mathbf{E}^{n+1/2} = C_{\\mathrm{ea}}\\, \\mathbf{E}^{n-1/2} + C_{\\mathrm{eb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{H}^{n}\\right), \n\\qquad\n\\mathbf{H}^{n+1} = \\mathbf{H}^{n} - C_{\\mathrm{hb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{E}^{n+1/2}\\right),\n$$\n其中 $\\nabla_{\\mathrm{d}} \\times$ 表示离散旋度，并且\n$$\n\\gamma \\equiv \\frac{\\sigma \\Delta t}{2 \\epsilon}, \n\\quad\nC_{\\mathrm{ea}} = \\frac{1-\\gamma}{1+\\gamma}, \n\\quad\nC_{\\mathrm{eb}} = \\frac{\\Delta t}{\\epsilon(1+\\gamma)}, \n\\quad\nC_{\\mathrm{hb}} = \\frac{\\Delta t}{\\mu}.\n$$\n假设离散平面波解的形式为 $\\mathbf{E}^{n+1/2}(\\mathbf{r}) = \\tilde{\\mathbf{E}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$ 和 $\\mathbf{H}^{n}(\\mathbf{r}) = \\tilde{\\mathbf{H}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$，进行 von Neumann 稳定性分析。其中 $G$ 是每个 Yee 时间步的放大因子。作用于这些模式的离散旋度引入了以下因子\n$$\ns_{x} = \\frac{\\sin(k_{x} \\Delta x/2)}{\\Delta x}, \n\\quad\ns_{y} = \\frac{\\sin(k_{y} \\Delta y/2)}{\\Delta y}, \n\\quad\ns_{z} = \\frac{\\sin(k_{z} \\Delta z/2)}{\\Delta z}, \n\\quad\nS^{2} = s_{x}^{2} + s_{y}^{2} + s_{z}^{2}.\n$$\n推导控制稳定性的关于 $G$ 的标量二次关系式，并确定 Courant 数\n$$\n\\nu \\equiv c\\, \\Delta t \\sqrt{\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}}, \n\\qquad c \\equiv \\frac{1}{\\sqrt{\\mu \\epsilon}},\n$$\n的值。在此值下达到稳定性边界，即对于最坏情况下的空间谐波（网格上可能的最大 $S^{2}$），$|G|=1$ 过渡到 $|G|1$。将临界 Courant 数的最终答案表示为单个精确数（无单位，不四舍五入）。", "solution": "该问题要求对有损介质中麦克斯韦方程组的三维时域有限差分 (FDTD) 方法进行 von Neumann 稳定性分析。我们需要推导放大因子 $G$ 的二次关系式，然后确定临界 Courant 数 $\\nu$。\n\n首先，我们将离散旋度算子 $\\nabla_{\\mathrm{d}} \\times$ 对假设的平面波解的作用形式化。对于矢量场的一个分量，例如 $F_z$，Yee 格式在点 $(i, j, k)$ 处将 $\\frac{\\partial F_z}{\\partial y}$ 近似为 $\\frac{F_z(i, j+1/2, k) - F_z(i, j-1/2, k)}{\\Delta y}$。当作用于平面波形式 $\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = \\exp(i(k_x x + k_y y + k_z z))$ 时，这个有限差分变为：\n$$\n\\frac{\\exp(ik_y(y+\\Delta y/2)) - \\exp(ik_y(y-\\Delta y/2))}{\\Delta y} \\exp(ik_x x)\\exp(ik_z z) = \\frac{\\exp(i\\mathbf{k}\\cdot\\mathbf{r})(\\exp(ik_y\\Delta y/2) - \\exp(-ik_y\\Delta y/2))}{\\Delta y} = \\frac{2i\\sin(k_y\\Delta y/2)}{\\Delta y} \\exp(i\\mathbf{k}\\cdot\\mathbf{r})\n$$\n问题定义了 $s_y = \\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}$。因此，离散偏导数算子 $\\delta_y$ 对应于乘以 $2is_y$。将其推广到三维，作用于平面波 $\\mathbf{F} = \\tilde{\\mathbf{F}} \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 的离散旋度算子等价于乘以一个矩阵算子，对于矢量场而言，这对应于运算 $i(2\\mathbf{s}) \\times \\tilde{\\mathbf{F}}$，其中 $\\mathbf{s}=(s_x, s_y, s_z)$。这个因子 $2$ 在标准中心差分格式中是至关重要且隐含的。\n\n我们将平面波拟设 $\\mathbf{E}^{n+1/2}(\\mathbf{r}) = \\tilde{\\mathbf{E}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$ 和 $\\mathbf{H}^{n}(\\mathbf{r}) = \\tilde{\\mathbf{H}}\\, G^{n} \\exp(i \\mathbf{k}\\cdot \\mathbf{r})$ 代入给定的更新方程。根据问题陈述中的拟设，放大因子 $G$ 代表一个完整时间步 $\\Delta t$ 内的增长。\n\n第一个更新方程是关于电场的：\n$$\n\\mathbf{E}^{n+1/2} = C_{\\mathrm{ea}}\\, \\mathbf{E}^{n-1/2} + C_{\\mathrm{eb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{H}^{n}\\right)\n$$\n代入拟设形式：\n$$\n\\tilde{\\mathbf{E}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = C_{\\mathrm{ea}}\\tilde{\\mathbf{E}}G^{n-1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) + C_{\\mathrm{eb}} \\left( i(2\\mathbf{s}) \\times (\\tilde{\\mathbf{H}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})) \\right)\n$$\n两边同除以 $G^{n-1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 得：\n$$\n\\tilde{\\mathbf{E}}G = C_{\\mathrm{ea}}\\tilde{\\mathbf{E}} + i2C_{\\mathrm{eb}}G(\\mathbf{s} \\times \\tilde{\\mathbf{H}})\n$$\n重新整理得到我们的第一个矢量方程：\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = i2C_{\\mathrm{eb}}G(\\mathbf{s} \\times \\tilde{\\mathbf{H}}) \\quad (1)\n$$\n第二个更新方程是关于磁场的：\n$$\n\\mathbf{H}^{n+1} = \\mathbf{H}^{n} - C_{\\mathrm{hb}}\\, \\left(\\nabla_{\\mathrm{d}} \\times \\mathbf{E}^{n+1/2}\\right)\n$$\n代入拟设：\n$$\n\\tilde{\\mathbf{H}}G^{n+1}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) = \\tilde{\\mathbf{H}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r}) - C_{\\mathrm{hb}} \\left( i(2\\mathbf{s}) \\times (\\tilde{\\mathbf{E}}G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})) \\right)\n$$\n两边同除以 $G^{n}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 得：\n$$\n\\tilde{\\mathbf{H}}G = \\tilde{\\mathbf{H}} - i2C_{\\mathrm{hb}}(\\mathbf{s} \\times \\tilde{\\mathbf{E}})\n$$\n重新整理得到我们的第二个矢量方程：\n$$\n(G-1)\\tilde{\\mathbf{H}} = -i2C_{\\mathrm{hb}}(\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\quad (2)\n$$\n现在我们得到了一个关于常矢量 $\\tilde{\\mathbf{E}}$ 和 $\\tilde{\\mathbf{H}}$ 的耦合方程组。为了求出色散关系，我们消去其中一个矢量。从方程 (2) 中，我们将 $\\tilde{\\mathbf{H}}$ 用 $\\tilde{\\mathbf{E}}$ 表示：\n$$\n\\tilde{\\mathbf{H}} = -\\frac{i2C_{\\mathrm{hb}}}{G-1}(\\mathbf{s} \\times \\tilde{\\mathbf{E}})\n$$\n将此代入方程 (1)：\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = i2C_{\\mathrm{eb}}G \\left( \\mathbf{s} \\times \\left( -\\frac{i2C_{\\mathrm{hb}}}{G-1}(\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\right) \\right)\n$$\n化简该表达式：\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = \\frac{4C_{\\mathrm{eb}}C_{\\mathrm{hb}}G}{G-1} \\left( \\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) \\right)\n$$\n我们使用矢量三重积恒等式 $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$。这里，$\\mathbf{a}=\\mathbf{b}=\\mathbf{s}$ 且 $\\mathbf{c}=\\tilde{\\mathbf{E}}$。\n$$\n\\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) = \\mathbf{s}(\\mathbf{s} \\cdot \\tilde{\\mathbf{E}}) - \\tilde{\\mathbf{E}}(\\mathbf{s} \\cdot \\mathbf{s})\n$$\n对于横向电磁波，波矢量与电场矢量正交。其离散形式为 $\\mathbf{s} \\cdot \\tilde{\\mathbf{E}} = 0$。同时，$\\mathbf{s} \\cdot \\mathbf{s} = S^2$。该恒等式简化为：\n$$\n\\mathbf{s} \\times (\\mathbf{s} \\times \\tilde{\\mathbf{E}}) = -S^2 \\tilde{\\mathbf{E}}\n$$\n将此代回我们的方程：\n$$\n(G - C_{\\mathrm{ea}})\\tilde{\\mathbf{E}} = \\frac{4C_{\\mathrm{eb}}C_{\\mathrm{hb}}G}{G-1}(-S^2\\tilde{\\mathbf{E}})\n$$\n由于 $\\tilde{\\mathbf{E}}$ 是一个非零振幅矢量，我们可以将其约去，得到关于 $G$ 的标量方程：\n$$\n(G - C_{\\mathrm{ea}})(G-1) = -4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 G\n$$\n展开左侧并重新整理，得到所求的关于 $G$ 的二次关系式：\n$$\nG^2 - (1+C_{\\mathrm{ea}})G + C_{\\mathrm{ea}} = -4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 G\n$$\n$$\nG^2 + \\left(4C_{\\mathrm{eb}}C_{\\mathrm{hb}}S^2 - (1+C_{\\mathrm{ea}})\\right)G + C_{\\mathrm{ea}} = 0\n$$\n为使数值格式稳定，放大因子的模必须对所有可能的空间谐波（即对所有 $\\mathbf{k}$）满足 $|G| \\le 1$。物理损耗 ($\\sigma0$) 的存在会增强稳定性，这意味着 $|G|$ 将小于无损情况下的值。因此，稳定性边界由最严格的情况决定，即 $\\sigma=0$ 的无损介质。\n在无损情况下，$\\sigma=0 \\implies \\gamma = \\frac{\\sigma \\Delta t}{2 \\epsilon} = 0$。系数变为：\n$C_{\\mathrm{ea}} = \\frac{1-0}{1+0} = 1$\n$C_{\\mathrm{eb}} = \\frac{\\Delta t}{\\epsilon(1+0)} = \\frac{\\Delta t}{\\epsilon}$\n$C_{\\mathrm{hb}} = \\frac{\\Delta t}{\\mu}$\n项 $C_{\\mathrm{eb}}C_{\\mathrm{hb}} = \\frac{(\\Delta t)^2}{\\mu\\epsilon}$。使用光速的定义 $c=1/\\sqrt{\\mu\\epsilon}$，此项变为 $(c\\Delta t)^2$。\n在无损情况下，关于 $G$ 的二次方程简化为：\n$$\nG^2 + \\left(4(c\\Delta t S)^2 - 2\\right)G + 1 = 0\n$$\n这是一个形式为 $G^2 + pG + 1 = 0$ 的二次方程。其根为 $G = \\frac{-p \\pm \\sqrt{p^2-4}}{2}$。为了使解稳定 ($|G| \\le 1$)，根的模不能大于 1。如果根是共轭复数，它们的模为 $|G|^2 = 1$，这正处于稳定性边界上。这种情况发生在判别式为非正数时，即 $p^2 - 4 \\le 0$，这意味着 $p^2 \\le 4$，或 $-2 \\le p \\le 2$。\n让我们检查我们的系数 $p = 4(c\\Delta t S)^2 - 2$ 是否满足这个条件：\n$$\n-2 \\le 4(c\\Delta t S)^2 - 2 \\le 2\n$$\n在不等式的所有部分加上 2，得到：\n$$\n0 \\le 4(c\\Delta t S)^2 \\le 4\n$$\n左侧不等式 $0 \\le 4(c\\Delta t S)^2$ 对实数总是成立。右侧不等式给出了稳定性条件：\n$$\n4(c\\Delta t S)^2 \\le 4 \\implies (c\\Delta t S)^2 \\le 1 \\implies c\\Delta t S \\le 1\n$$\n这个条件必须对所有空间波矢量 $\\mathbf{k}$ 都成立。最严格的约束是由网格上 $S$ 的最大可能值（记为 $S_{\\mathrm{max}}$）施加的。$S^2$ 的值为：\n$$\nS^2 = \\left(\\frac{\\sin(k_{x} \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_{y} \\Delta y/2)}{\\Delta y}\\right)^2 + \\left(\\frac{\\sin(k_{z} \\Delta z/2)}{\\Delta z}\\right)^2\n$$\n正弦函数的最大值是 1，这发生在奈奎斯特频率处（例如，$k_x = \\pi/\\Delta x$，所以 $k_x\\Delta x/2 = \\pi/2$）。因此，$S^2$ 的最大值是：\n$$\nS_{\\mathrm{max}}^2 = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\n$$\n将此代入稳定性条件，得到 Courant-Friedrichs-Lewy (CFL) 稳定性极限：\n$$\nc \\Delta t \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}} \\le 1\n$$\n问题将 Courant 数定义为 $\\nu \\equiv c\\, \\Delta t \\sqrt{\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}}$。\n因此，稳定性条件就是 $\\nu \\le 1$。对于最坏情况模式，当 $|G|=1$ 向不稳定性过渡时，就达到了稳定性边界，此时该不等式变为等式。\n$$\n\\nu = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3360095"}]}