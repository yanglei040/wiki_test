{"hands_on_practices": [{"introduction": "在任何时域仿真开始之前，都必须确保其从一个物理上一致的状态出发。本练习将探讨在色散介质中为电磁场和辅助变量设置初始值时所依据的因果性和平衡性的基本原则。正确地初始化仿真是获得有意义结果的首要且最关键的一步。[@problem_id:3289844]", "problem": "一个三维时域有限差分 (FDTD) 模拟将在一个线性、无源、因果色散介质中进行初始化，该介质的电响应通过辅助微分方程 (ADE) 方法实现。电磁场初始处于静止状态，即 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ 且 $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$。在 $t=0$ 时没有自由电荷或自由电流，因此 $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$ 且 $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$。电通量密度满足 $\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$，其中 $\\mathbf{P}$ 是极化矢量，极化电流密度为 $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$。色散的 ADE 表示由一组稳定的线性常微分方程构成，这些方程描述了内部材料状态，在电场 $\\mathbf{E}$ 的驱动下产生 $\\mathbf{P}$。这些方程采用与 Yee 场更新相同的蛙跳式交错格式进行时间积分，其中 $\\mathbf{E}$ 定义在整数时间 $t^n=n\\Delta t$，$\\mathbf{H}$ 定义在半整数时间 $t^{n+\\frac{1}{2}}$。\n\n从微分形式的宏观麦克斯韦方程组出发，\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}},\\quad\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{B}=0,\n$$\n其中 $\\mathbf{D}=\\epsilon_0\\mathbf{E}+\\mathbf{P}$ 且 $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$，并假设当 $\\mathbf{E}=\\mathbf{0}$ 时 ADE 内部动力学对应于一个无源稳定平衡，请确定当模拟从 $\\mathbf{E}=\\mathbf{H}=\\mathbf{0}$ 开始时，下列哪种方案能为 ADE 变量 $\\mathbf{P}$ 和 $\\dot{\\mathbf{P}}$ 提供既不违反麦克斯韦方程组也不违反材料状态方程的一致初始条件。\n\nA. 在所有地方设置 $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ 和 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$。对于与色散极点相关的任何一阶 ADE 内部状态变量 $\\mathbf{q}_m$，将其初始化为对应于 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ 的平衡值，在线性无源介质中该值为 $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$。\n\nB. 通过将 $\\mathbf{P}(\\mathbf{r},0)$ 设置为零频极化率响应来为材料预加载“静态”极化，并通过取 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$ 来施加阻尼，尽管 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$，以便弛豫立即开始。\n\nC. 选择任意非零无散极化场，$\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ 且 $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$，并设置 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$。这保证了 $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$，同时不引入初始极化电流。\n\nD. 遵循 Yee 时间交错格式，设置 $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ 和 $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$，并选择 $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ 和极化电流 $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$。在给定 $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ 的条件下，将任何一阶 ADE 内部状态初始化为其平衡值，在线性无源介质中该值为 $\\mathbf{0}$。\n\n选择所有正确的选项。", "solution": "该问题要求在一个时域有限差分 (FDTD) 模拟中，为由辅助微分方程 (ADE) 方法描述的色散介质的状态变量寻找一致的初始条件。该模拟从“初始静止”状态开始，意味着在时间 $t=0$ 时电磁场为零，并且没有自由电荷或自由电流。\n\n首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 模拟：三维 FDTD。\n- 介质：线性、无源、因果、色散。\n- 方法：辅助微分方程 (ADE)。\n- 初始电磁场：$\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$，$\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$。\n- 初始自由源：$\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$，$\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$。\n- 本构关系：$\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$。\n- 极化电流：$\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$。\n- ADE 动力学：用于内部状态的稳定线性常微分方程，由驱动 $\\mathbf{E}$ 产生 $\\mathbf{P}$。当 $\\mathbf{E}=\\mathbf{0}$ 时，对应于一个无源稳定平衡。\n- Yee 时间交错：$\\mathbf{E}$ 在整数时间 $t^n=n\\Delta t$，$\\mathbf{H}$ 在半整数时间 $t^{n+\\frac{1}{2}}$。\n- 控制方程：宏观麦克斯韦方程组。\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t} \\quad (1)\n$$\n$$\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}} \\quad (2)\n$$\n$$\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t} \\quad (3)\n$$\n$$\n\\nabla\\cdot\\mathbf{B}=0 \\quad (4)\n$$\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有坚实的科学基础，代表了计算电磁学中的一个标准场景。线性、无源、因果色散介质，FDTD 方法，ADE 公式，麦克斯韦方程组以及静止初始条件等概念在物理学和工程学中都是标准且定义明确的。问题本身是自洽的，没有内部矛盾。所提供的数据足以确定所提初始条件的一致性。语言客观而精确。因此，该问题是有效的。\n\n**步骤 3：结论与行动**\n问题是有效的。我们开始求解。\n\n**一致初始条件的推导**\n\n核心原则是，材料状态变量（$\\mathbf{P}$、$\\dot{\\mathbf{P}}$ 以及任何内部 ADE 状态）的初始条件必须在初始时刻 $t=0$ 与麦克斯韦方程组和介质的本构性质都保持一致。\n\n1.  **线性、无源、因果介质的含义：**\n    介质被指定为因果介质。因果性要求系统的响应不能先于其原因。在这里，电场 $\\mathbf{E}$ 是原因（或驱动），而极化 $\\mathbf{P}$ 是结果（或响应）。问题陈述系统“初始静止”，即 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$。这意味着在所有时间 $t \\le 0$，电场都为零。在一个因果系统中，如果对于所有 $t \\le 0$，$\\mathbf{E}(\\mathbf{r},t)=\\mathbf{0}$，那么极化也必须为零，即对于所有 $t \\le 0$，$\\mathbf{P}(\\mathbf{r},t)=\\mathbf{0}$。这引出两个直接的结论：\n    -   初始极化必须为零：$\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$。\n    -   初始极化时间导数也必须为零：$\\dot{\\mathbf{P}}(\\mathbf{r},0) = \\frac{\\partial\\mathbf{P}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$。\n\n2.  **稳定平衡的含义：**\n    问题陈述 ADE 动力学在“$\\mathbf{E}=\\mathbf{0}$ 时有一个无源稳定平衡”。对于一个线性系统，这个唯一的稳定平衡点是零状态。由于驱动场为 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$，材料必须处于这个平衡状态。这证实了不仅 $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$，而且 ADE 模型的任何内部状态变量（我们称之为 $\\mathbf{q}_m$）也必须处于其平衡值，即 $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$。\n\n3.  **与 $t=0$ 时麦克斯韦方程组的一致性：**\n    让我们在给定初始场和源的情况下，验证这些条件是否与 $t=0$ 时的麦克斯韦方程组一致。\n    -   **$\\mathbf{D}$ 的高斯定律 (方程 2):** 我们必须满足 $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0) = \\rho_{\\mathrm{f}}(\\mathbf{r},0)$。\n        由于 $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$，这要求 $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$。\n        代入本构关系：$\\nabla\\cdot(\\epsilon_0 \\mathbf{E}(\\mathbf{r},0) + \\mathbf{P}(\\mathbf{r},0))=0$。\n        使用给定的 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ 和我们推导出的 $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$，我们得到 $\\nabla\\cdot(\\mathbf{0}+\\mathbf{0})=0$，该式成立。\n\n    -   **安培定律 (方程 1):** 我们必须满足 $\\nabla\\times\\mathbf{H}(\\mathbf{r},0) = \\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0) + \\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0}$。\n        由于 $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$ 且 $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$，这要求 $\\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$。\n        展开 $\\mathbf{D}$ 的时间导数：$\\frac{\\partial}{\\partial t}(\\epsilon_0 \\mathbf{E} + \\mathbf{P})\\Big|_{t=0} = \\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) + \\dot{\\mathbf{P}}(\\mathbf{r},0) = \\mathbf{0}$。\n        我们推导出的条件 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ 使该方程简化为 $\\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) = \\mathbf{0}$，即 $\\dot{\\mathbf{E}}(\\mathbf{r},0)=\\mathbf{0}$。这个条件是自洽的；在没有任何在 $t=0$ 时刻开启的驱动源的情况下，场的初始时间导数确实应该为零，并保持为零。\n\n对于一个静止、线性、无源且因果的色散介质，唯一一致的初始条件是所有场变量和材料状态变量都为零。\n\n**逐项分析**\n\nA. **在所有地方设置 $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ 和 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$。对于与色散极点相关的任何一阶 ADE 内部状态变量 $\\mathbf{q}_m$，将其初始化为对应于 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ 的平衡值，在线性无源介质中该值为 $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$。**\n该陈述是我们从第一性原理推导出的直接而精确的结论。它正确地指出，在一个从静止状态（$\\mathbf{E}=\\mathbf{0}, \\mathbf{H}=\\mathbf{0}$）开始的线性、因果、无源系统中，所有内部材料状态也必须处于其零平衡状态。这包括极化强度 $\\mathbf{P}$、其时间导数 $\\dot{\\mathbf{P}}$ 以及任何底层的 ADE 状态变量 $\\mathbf{q}_m$。如上所示，这组条件与麦克斯韦方程组完全一致。\n结论：**正确**。\n\nB. **通过将 $\\mathbf{P}(\\mathbf{r},0)$ 设置为零频极化率响应来为材料预加载“静态”极化，并通过取 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$ 来施加阻尼，尽管 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$，以便弛豫立即开始。**\n该方案违反了基本假设。设置 $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$ 与因果介质在 $t\\le 0$ 时 $\\mathbf{E}(t)=\\mathbf{0}$ 的“初始静止”条件相矛盾。这样的初始状态代表介质中储存了势能，它不是一个静止状态。这描述的是将系统准备在一个激发态并观察其弛豫的过程，这是一个不同的物理问题。\n结论：**不正确**。\n\nC. **选择任意非零无散极化场，$\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ 且 $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$，并设置 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$。这保证了 $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$，同时不引入初始极化电流。**\n该选项包含多处不一致。首先，与选项 B 一样，它提出 $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$，这违反了系统的静止和因果性质。其次，它建议在材料处于非平衡状态（当 $\\mathbf{E}=\\mathbf{0}$ 时的平衡值为 $\\mathbf{P}=\\mathbf{0}$，而此时 $\\mathbf{P}\\neq\\mathbf{0}$）时设置 $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$。一个处于非平衡状态的无源系统将自然地开始向平衡松弛，这个过程意味着 $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$。对于一个典型的线性无源模型（例如 Debye 模型），有 $\\mathbf{P}\\neq\\mathbf{0}$ 和 $\\mathbf{E}=\\mathbf{0}$ 会迫使 $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$。因此，同时设置 $\\mathbf{P}\\neq\\mathbf{0}$ 和 $\\dot{\\mathbf{P}}=\\mathbf{0}$ 与材料自身的状态方程不一致。\n结论：**不正确**。\n\nD. **遵循 Yee 时间交错格式，设置 $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ 和 $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$，并选择 $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ 和极化电流 $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$。在给定 $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ 的条件下，将任何一阶 ADE 内部状态初始化为其平衡值，在线性无源介质中该值为 $\\mathbf{0}$。**\n该选项提出了与选项 A 相同的物理原理，但将其转换为了 Yee FDTD 算法的特定表示法。\n-   $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ 是 $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ 的离散形式。\n-   $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$ 是在蛙跳格式中为表示 $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$ 而对第一个半时间步长的磁场进行的标准初始化。\n-   $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ 以及将 ADE 状态初始化为 $\\mathbf{0}$ 是将初始材料状态设置为其零平衡的离散版本，与 $\\mathbf{E}^0=\\mathbf{0}$ 一致。\n-   $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\mathbf{0}$ 指定了在第一个半时间步长处的极化电流为零。这是其他初始条件的必然结果。由于系统从平衡状态开始（$\\mathbf{E}^0=\\mathbf{0}$，$\\mathbf{P}^0=\\mathbf{0}$，ADE 状态为 $\\mathbf{0}$），在第一个时间间隔内没有驱动来感生极化电流。\n该选项为在离散时间和空间中初始化 FDTD 模拟提供了一个完整且正确的方案，与连续时间物理学完全一致。\n结论：**正确**。", "answer": "$$\\boxed{AD}$$", "id": "3289844"}, {"introduction": "时域仿真中的一个主要挑战是数值不稳定性，即误差呈指数级增长，导致结果毫无用处。本练习将深入探讨多极点洛伦兹（Lorentz）材料（一种常见的电介质模型）的离散化ADE的稳定性分析。你将推导与材料相关的稳定性约束，并学习它如何与著名的电磁场Courant–Friedrichs–Lewy (CFL)条件相互作用，从而揭示在为完整仿真选择时间步长$ \\Delta t $时所面临的权衡。[@problem_id:3289828]", "problem": "要求您形式化并计算当多个洛伦兹振子模型化的色散材料的极点在目标频带附近紧密分布时，其离散时间稳定性约束。背景是结合辅助微分方程（ADE, Auxiliary Differential Equation）方法处理色散的时域有限差分（FDTD, Finite-Difference Time-Domain）计算电磁学。核心目标是从第一性原理出发，推导 ADE 材料子系统及其与电磁场 Courant–Friedrichs–Lewy（CFL, Courant–Friedrichs–Lewy）约束相互作用的稳定性约束，并进行数值实现。\n\n从以下基本原理出发，推导离散时间稳定性约束：\n- 在线性色散介质中，由洛伦兹极化模型描述的麦克斯韦方程组为：\n$$\n\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\n其中\n$$\n\\mathbf{D}(t) = \\epsilon_0 \\epsilon_{\\infty} \\mathbf{E}(t) + \\mathbf{P}(t), \\quad \\mathbf{P}(t) = \\sum_{j=1}^{N_p} \\mathbf{P}_j(t),\n$$\n并且对于每个洛伦兹极点 $j$，\n$$\n\\frac{d^2 \\mathbf{P}_j}{dt^2} + \\gamma_j \\frac{d \\mathbf{P}_j}{dt} + \\omega_j^2 \\mathbf{P}_j = \\epsilon_0 \\Delta \\epsilon_j \\omega_j^2 \\mathbf{E}(t),\n$$\n此处 $\\epsilon_0$ 是真空介电常数，$\\mu_0$ 是真空磁导率，$\\epsilon_{\\infty}$ 是高频介电常数，$\\Delta \\epsilon_j$ 是极点 $j$ 的强度，$\\gamma_j$ 是其阻尼系数（单位为 $\\mathrm{s}^{-1}$），$\\omega_j$ 是其角共振频率（单位为 $\\mathrm{rad/s}$）。\n\n您必须使用与标准蛙跳 FDTD 时间步进格式一致的显式二阶中心差分格式，对洛伦兹极点常微分方程进行离散化，并确定离散 ADE 更新的齐次部分保持稳定时，离散时间步长 $\\Delta t$ 所需满足的条件。稳定性必须通过线性离散时间系统根的位置来评估（例如，针对二阶实系数多项式的 Jury 稳定性判据）。然后，对于多个极点，确定目标角频带附近的极点聚集如何影响 $\\Delta t$ 的选择，并解释其与三维 Yee 网格的电磁 CFL 约束之间的相互作用。\n\n对于三维 Yee 网格，CFL 约束基于真空中的光速 $c$，其中 $c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}} = 299792458\\,\\mathrm{m/s}$。对于空间步长为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的三维情况，时间步长的 CFL 上限为\n$$\n\\Delta t_{\\mathrm{EM}} \\le \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}.\n$$\n综合要求是，实际使用的时间步长 $\\Delta t$ 必须同时满足 ADE 材料稳定性约束和电磁 CFL 约束。您必须计算最大稳定时间步长 $\\Delta t_{\\max}$ 为\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}}\\right),\n$$\n其中 $\\Delta t_{\\mathrm{material}}$ 是能够使所有极点 $j$ 的离散 ADE 子系统保持稳定的最大时间步长。\n\n您的程序必须实现所推导的约束，并为以下每个测试用例计算 $\\Delta t_{\\max}$。所有物理量必须使用国际单位制处理，结果必须以秒为单位表示。角频率的角度单位是弧度。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，如 $[\\Delta t_1, \\Delta t_2, \\Delta t_3]$。每个结果都必须是单位为秒的浮点数。\n\n测试套件：\n- 案例 1 (太赫兹频段附近的密集极点簇，电磁 CFL 非限制性):\n  - 极点：三个洛伦兹极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 1.00\\times 10^{12}\\,\\mathrm{Hz}$，$f_2 = 1.02\\times 10^{12}\\,\\mathrm{Hz}$，$f_3 = 0.98\\times 10^{12}\\,\\mathrm{Hz}$；阻尼系数 $\\gamma_1 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-3}\\,\\mathrm{m}$，$\\Delta y = 10^{-3}\\,\\mathrm{m}$，$\\Delta z = 10^{-3}\\,\\mathrm{m}$。\n- 案例 2 (吉赫兹频段附近的极点簇，由于精细网格导致电磁 CFL 强限制性):\n  - 极点：三个洛伦兹极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 1.00\\times 10^{9}\\,\\mathrm{Hz}$，$f_2 = 1.05\\times 10^{9}\\,\\mathrm{Hz}$，$f_3 = 0.95\\times 10^{9}\\,\\mathrm{Hz}$；阻尼系数 $\\gamma_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 5.0\\times 10^{8}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 2.0\\times 10^{8}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-6}\\,\\mathrm{m}$，$\\Delta y = 10^{-6}\\,\\mathrm{m}$，$\\Delta z = 10^{-6}\\,\\mathrm{m}$。\n- 案例 3 (多太赫兹频段附近具有高阻尼的密集极点簇，由于粗糙网格导致电磁 CFL 非限制性):\n  - 极点：三个洛伦兹极点，角频率为 $\\omega_j = 2\\pi f_j$，其中 $f_1 = 3.00\\times 10^{12}\\,\\mathrm{Hz}$，$f_2 = 3.10\\times 10^{12}\\,\\mathrm{Hz}$，$f_3 = 2.90\\times 10^{12}\\,\\mathrm{Hz}$；阻尼系数 $\\gamma_1 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$\\gamma_2 = 1.0\\times 10^{12}\\,\\mathrm{s}^{-1}$，$\\gamma_3 = 5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$。\n  - 网格：$\\Delta x = 10^{-2}\\,\\mathrm{m}$，$\\Delta y = 10^{-2}\\,\\mathrm{m}$，$\\Delta z = 10^{-2}\\,\\mathrm{m}$。\n\n您的程序应输出一行，包含按上述案例顺序排列的三个计算出的最大稳定时间步长（单位为秒），格式为逗号分隔的列表并用方括号括起，例如 $[v_1,v_2,v_3]$。不应打印任何其他文本。输出必须是浮点数。", "solution": "该问题是有效的，因为它在科学上基于经典电磁学和数值分析，问题设定良好，并且为推导和计算提供了所有必要的参数。分析的重点是辅助微分方程 (ADE) 齐次部分的稳定性，为此，所提供的参数 $\\omega_j$ 和 $\\gamma_j$ 是足够的。\n\n目标是为时域有限差分 (FDTD) 方法中使用的多极点洛伦兹色散材料模型推导离散时间稳定性约束。这需要分析材料极化的控制常微分方程 (ODE) 的离散化。\n\n让我们考虑单个极化分量 $\\mathbf{P}_j(t)$ 的洛伦兹模型的齐次部分，为清晰起见，我们可以将其作为标量方程进行分析，暂时省略矢量和极点索引符号：\n$$\n\\frac{d^2 P}{dt^2} + \\gamma \\frac{d P}{dt} + \\omega^2 P = 0\n$$\n这是一个二阶线性齐次常微分方程。问题指定使用显式二阶中心差分格式进行离散化。我们将时间离散化为 $t = n\\Delta t$，并令 $P^n$ 表示 $P(n\\Delta t)$。在时间 $t=n\\Delta t$ 处，导数的中心差分近似为：\n$$\n\\frac{d^2 P}{dt^2} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\frac{d P}{dt} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - P^{n-1}}{2\\Delta t}\n$$\n将这些表达式代入齐次常微分方程，得到离散时间方程：\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2} + \\gamma \\left( \\frac{P^{n+1} - P^{n-1}}{2\\Delta t} \\right) + \\omega^2 P^n = 0\n$$\n为分析此线性递推关系的稳定性，我们按时间步索引（$n+1$、$n$、$n-1$）重新排列各项：\n$$\nP^{n+1} \\left( \\frac{1}{(\\Delta t)^2} + \\frac{\\gamma}{2\\Delta t} \\right) + P^n \\left( \\omega^2 - \\frac{2}{(\\Delta t)^2} \\right) + P^{n-1} \\left( \\frac{1}{(\\Delta t)^2} - \\frac{\\gamma}{2\\Delta t} \\right) = 0\n$$\n两边同乘以 $(\\Delta t)^2$，我们得到一个更方便的形式：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) P^{n+1} + \\left( (\\omega \\Delta t)^2 - 2 \\right) P^n + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) P^{n-1} = 0\n$$\n这是一个线性齐次差分方程。其稳定性由其特征多项式的根决定。假设解的形式为 $P^n = z^n$（其中 $z$ 为某个复数），我们将其代入方程：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) z^2 + \\left( (\\omega \\Delta t)^2 - 2 \\right) z + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = 0\n$$\n这是一个 $az^2 + bz + c = 0$ 形式的二次多项式，其中：\n$a = 1 + \\frac{\\gamma \\Delta t}{2}$\n$b = (\\omega \\Delta t)^2 - 2$\n$c = 1 - \\frac{\\gamma \\Delta t}{2}$\n\n为使离散系统稳定，根 $z$ 的模长不得超过 1，即 $|z| \\le 1$。我们应用针对实系数二阶多项式的 Jury 稳定性判据。由于阻尼系数 $\\gamma \\ge 0$ 且时间步长 $\\Delta t > 0$，系数 $a$ 总是正的 ($a > 1$)。临界稳定 ($|z| \\le 1$) 的判据为：\n1. $a+b+c \\ge 0$\n2. $a-b+c \\ge 0$\n3. $|c| \\le a$\n\n我们来评估每个条件。\n条件 1：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) + \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = (\\omega \\Delta t)^2 \\ge 0\n$$\n该条件总是满足的。\n\n条件 3：\n$$\n|c| \\le a \\implies \\left| 1 - \\frac{\\gamma \\Delta t}{2} \\right| \\le 1 + \\frac{\\gamma \\Delta t}{2}\n$$\n该不等式等价于 $- (1 + \\frac{\\gamma \\Delta t}{2}) \\le 1 - \\frac{\\gamma \\Delta t}{2} \\le 1 + \\frac{\\gamma \\Delta t}{2}$。右侧不等式简化为 $0 \\le \\gamma \\Delta t$，这对于 $\\gamma \\ge 0$ 成立。左侧不等式简化为 $-1 \\le 1$，这总是成立。因此，对于任何物理阻尼，该条件都无条件满足。\n\n条件 2：\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) - \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) \\ge 0\n$$\n$$\n1 + \\frac{\\gamma \\Delta t}{2} - (\\omega \\Delta t)^2 + 2 + 1 - \\frac{\\gamma \\Delta t}{2} \\ge 0\n$$\n$$\n4 - (\\omega \\Delta t)^2 \\ge 0 \\implies (\\omega \\Delta t)^2 \\le 4\n$$\n由于 $\\omega$ 和 $\\Delta t$ 均为正数，取正平方根，得到稳定性约束：\n$$\n\\omega \\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{\\omega}\n$$\n这是单个洛伦兹极点的稳定性约束。对于由多个极点 ($j = 1, \\dots, N_p$) 描述的材料，其极化是总和 $\\mathbf{P} = \\sum_j \\mathbf{P}_j$。每个 $\\mathbf{P}_j$ 的齐次方程是解耦的。因此，用于整个模拟的单个时间步长 $\\Delta t$ 必须同时满足每个极点的稳定性条件。这要求：\n$$\n\\Delta t \\le \\min_{j} \\left( \\frac{2}{\\omega_j} \\right)\n$$\n这个最小值由具有最大共振频率的极点决定，$\\omega_{\\max} = \\max_j(\\omega_j)$。因此，材料子系统的稳定性约束为：\n$$\n\\Delta t_{\\mathrm{material}} = \\frac{2}{\\max_j(\\omega_j)}\n$$\n极点的聚集之所以重要，仅在于簇中频率最高的极点决定了该极限。对于这种特定的中心差分格式，阻尼系数 $\\gamma_j$ 不影响稳定性边界。\n\n该材料稳定性约束必须与电磁场传播的 Courant–Friedrichs–Lewy (CFL) 约束同时满足。对于空间步长为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的三维 Yee 网格，CFL 约束为：\n$$\n\\Delta t_{\\mathrm{EM}} = \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n其中 $c$ 是真空中的光速。FDTD 模拟的总体最大稳定时间步长是这两个条件中更严格的一个：\n$$\n\\Delta t_{\\max} = \\min\\left( \\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}} \\right)\n$$\n现在将此通用公式应用于具体的测试用例。在 $\\Delta x = \\Delta y = \\Delta z = \\Delta_s$ 的特殊情况下，CFL 极限简化为 $\\Delta t_{\\mathrm{EM}} = \\frac{\\Delta_s}{c\\sqrt{3}}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for FDTD simulations with\n    multi-pole Lorentz dispersive materials.\n    \"\"\"\n    \n    # Speed of light in vacuum (m/s)\n    c = 299792458.0\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (list of frequencies in Hz, list of damping coefficients in s^-1, grid spacing in m).\n    # The damping coefficients (gamma) are not used in the stability calculation\n    # derived for the central-difference scheme, but are retained for data integrity.\n    test_cases = [\n        # Case 1: Closely spaced cluster near a THz band, CFL non-limiting.\n        (\n            [1.00e12, 1.02e12, 0.98e12],     # frequencies f_j\n            [5.0e10, 5.0e10, 5.0e10],        # damping coefficients gamma_j\n            1.0e-3                           # grid spacing delta_s\n        ),\n        # Case 2: Cluster near a GHz band, CFL highly limiting.\n        (\n            [1.00e9, 1.05e9, 0.95e9],       # frequencies f_j\n            [1.0e8, 5.0e8, 2.0e8],          # damping coefficients gamma_j\n            1.0e-6                           # grid spacing delta_s\n        ),\n        # Case 3: Cluster near a multi-THz band, CFL non-limiting.\n        (\n            [3.00e12, 3.10e12, 2.90e12],     # frequencies f_j\n            [1.0e13, 1.0e12, 5.0e12],        # damping coefficients gamma_j\n            1.0e-2                           # grid spacing delta_s\n        )\n    ]\n\n    results = []\n\n    for case in test_cases:\n        frequencies_hz, _, delta_s = case\n\n        # 1. Calculate the material stability constraint (dt_material)\n        \n        # The stability constraint is dictated by the highest resonance frequency.\n        # First, find the maximum frequency f_max in Hz.\n        f_max = max(frequencies_hz)\n        \n        # Convert it to the maximum angular frequency omega_max in rad/s.\n        omega_max = 2 * np.pi * f_max\n        \n        # The ADE stability constraint derived from the central-difference scheme is:\n        # dt_material = 2 / omega_max\n        dt_material = 2.0 / omega_max\n\n        # 2. Calculate the electromagnetic CFL constraint (dt_em)\n        \n        # For a 3D Yee grid with dx = dy = dz = delta_s, the CFL constraint is:\n        # dt_em = delta_s / (c * sqrt(3))\n        dt_em = delta_s / (c * np.sqrt(3.0))\n\n        # 3. Determine the overall maximum stable time step\n        \n        # The actual time step must satisfy both constraints.\n        dt_max = min(dt_material, dt_em)\n        results.append(dt_max)\n\n    # Print the results in the specified single-line format.\n    # Using scientific notation to represent the small float values precisely.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "3289828"}, {"introduction": "现实世界中的材料通常用大量的色散极点来建模，这使得ADE更新的计算成本非常高。本练习专注于将ADE系统重构为块对角状态空间表示，这种结构是现代高性能计算的关键。通过分析该结构，你将理解它如何利用单指令多数据（Single Instruction, Multiple Data, SIMD）范式实现高效并行化，从而显著加速仿真过程。[@problem_id:3289886]", "problem": "考虑一个线性、均匀、各向同性的色散电介质，其在频域中的电极化率由 $N$ 个洛伦兹振子极点的总和来表征。在时域中，该模型可以由电通量密度 $\\mathbf{D}$、电场 $\\mathbf{E}$ 和 $N$ 个辅助极化密度 $\\{P_{m}\\}_{m=1}^{N}$ 之间的一组 $N$ 个耦合本构关系表示，其中对于每个极点 $m$，\n$$\n\\mathbf{D}(t) = \\epsilon_{0}\\epsilon_{\\infty}\\mathbf{E}(t) + \\sum_{m=1}^{N} P_{m}(t),\n$$\n并且每个 $P_{m}$ 服从二阶常微分方程\n$$\n\\ddot{P}_{m}(t) + \\gamma_{m}\\dot{P}_{m}(t) + \\omega_{0,m}^{2} P_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t),\n$$\n其中 $\\epsilon_{0}$ 是真空介电常数，$\\epsilon_{\\infty}$ 是高频相对介电常数，并且对于每个极点 $m$，$\\gamma_{m}$ 是阻尼率，$\\omega_{0,m}$ 是共振频率，$\\omega_{p,m}$ 是等离子体频率。麦克斯韦旋度方程照常关联 $\\mathbf{E}$ 和磁通量密度 $\\mathbf{B}$。\n\n定义辅助电流 $J_{m}(t) \\equiv \\dot{P}_{m}(t)$ 并引入单极点状态向量 $x_{m}(t) \\equiv \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$。使用此状态，单极点本构动力学可以写成一阶形式，\n$$\n\\dot{x}_{m}(t) = F_{m}\\,x_{m}(t) + G_{m}\\,\\mathbf{E}(t),\n$$\n其中 $F_{m}$ 和 $G_{m}$ 是仅依赖于 $\\gamma_{m}$、$\\omega_{0,m}$ 和 $\\omega_{p,m}$ 的常数矩阵。考虑一个均匀的时间步长 $\\Delta t$，并使用梯形法则（也称为 Crank-Nicolson 方法）对上述一阶单极点系统进行离散化，以获得关于 $x_{m}^{n+1}$、$x_{m}^{n}$、$\\mathbf{E}^{n+1}$ 和 $\\mathbf{E}^{n}$ 的 $x_{m}^{n} \\equiv x_{m}(n\\Delta t)$ 的线性隐式时间更新。组合全局状态 $X^{n} \\equiv \\begin{pmatrix} x_{1}^{n} \\\\ \\vdots \\\\ x_{N}^{n} \\end{pmatrix}$，并将得到的 $N$ 极点辅助微分方程（ADE）更新写成块对角状态空间形式的紧凑向量-矩阵递归。然后，基于推导出的结构，从第一性原理出发，解释为什么块对角形式能够在没有数据冒险的情况下实现跨极点的单指令多数据（SIMD）更新。\n\n回答以下问题：\n\n- 从麦克斯韦方程和给定的洛伦兹极点本构律出发，推导梯形法则时间离散化的单极点更新，并以紧凑的块对角状态空间形式 $X^{n+1} = \\mathcal{A}\\,X^{n} + \\mathcal{B}\\,\\mathbf{E}^{n+1} + \\mathcal{B}\\,\\mathbf{E}^{n}$ 表示全局 $N$ 极点递归，其中 $\\mathcal{A}$ 和 $\\mathcal{B}$ 不依赖于时间。\n- 以闭合形式给出块对角更新矩阵 $\\mathcal{A}$，并用 $\\Delta t$、$\\{\\gamma_{m}\\}$ 和 $\\{\\omega_{0,m}\\}$ 显式表示。\n- 解释块对角结构和单极点独立性如何实现跨 $N$ 个极点的单指令多数据（SIMD）更新。\n\n你的最终答案必须是矩阵 $\\mathcal{A}$ 的单一闭合形式解析表达式，仅用 $\\Delta t$、$\\{\\gamma_{m}\\}$ 和 $\\{\\omega_{0,m}\\}$ 表示。最终答案中不要包含任何等号或附加评论。不需要进行数值计算。", "solution": "该问题要求使用辅助微分方程（ADE）方法推导多极点洛伦兹色散模型的基于梯形法则的时域更新方程，并分析所得结构以进行并行计算。\n\n首先，我们必须形式化状态空间表示。每个极化密度极点 $m$ 的控制二阶常微分方程（ODE）如下：\n$$\n\\ddot{P}_{m}(t) + \\gamma_{m}\\dot{P}_{m}(t) + \\omega_{0,m}^{2} P_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t)\n$$\n问题陈述中存在一个符号不一致的问题：$P_m$ 是非粗体，表示标量，而 $\\mathbf{E}(t)$ 是粗体，表示矢量。对于线性各向同性介质，极化的矢量分量仅取决于电场的相应矢量分量。例如，$x$ 分量的 ODE 将是 $\\ddot{P}_{m,x}(t) + \\gamma_{m}\\dot{P}_{m,x}(t) + \\omega_{0,m}^{2} P_{m,x}(t) = \\omega_{p,m}^{2} E_x(t)$。$y$ 和 $z$ 分量的方程形式相同。因此，我们可以对单个标量分量进行推导，得到的更新系数对于所有三个空间分量都将是相同的。让标量变量 $P_m(t)$、$J_m(t)$ 和 $E(t)$ 代表这样一个分量。\n\n每个极点 $m$ 的状态向量定义为 $x_{m}(t) = \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$，其中 $J_{m}(t) = \\dot{P}_{m}(t)$。状态向量的一阶导数是 $\\dot{x}_{m}(t) = \\begin{pmatrix} \\dot{P}_{m}(t) \\\\ \\ddot{P}_{m}(t) \\end{pmatrix}$。使用定义和控制 ODE，我们可以写出：\n$$\n\\dot{x}_{m}(t) = \\begin{pmatrix} J_{m}(t) \\\\ -\\omega_{0,m}^{2} P_{m}(t) - \\gamma_{m} J_{m}(t) + \\omega_{p,m}^{2} E(t) \\end{pmatrix}\n$$\n这可以通过识别常数矩阵 $F_m$ 和 $G_m$ 来表示为一阶矩阵形式 $\\dot{x}_{m}(t) = F_{m}x_{m}(t) + G_{m}E(t)$：\n$$\nF_{m} = \\begin{pmatrix} 0   1 \\\\ -\\omega_{0,m}^{2}   -\\gamma_{m} \\end{pmatrix}, \\quad G_{m} = \\begin{pmatrix} 0 \\\\ \\omega_{p,m}^{2} \\end{pmatrix}\n$$\n接下来，我们使用梯形法则（Crank-Nicolson 方法）在一个时间步长 $\\Delta t$ 上对该系统进行离散化。对于一般的一阶 ODE $\\dot{y} = f(y,t)$，法则是 $y^{n+1} - y^{n} = \\frac{\\Delta t}{2} \\left[ f(y^{n+1}, t^{n+1}) + f(y^{n}, t^{n}) \\right]$。将此应用于我们的线性系统：\n$$\nx_{m}^{n+1} - x_{m}^{n} = \\frac{\\Delta t}{2} \\left[ (F_{m}x_{m}^{n+1} + G_{m}E^{n+1}) + (F_{m}x_{m}^{n} + G_{m}E^{n}) \\right]\n$$\n为了找到 $x_{m}^{n+1}$ 的显式更新规则，我们重新排列方程，将包含 $x_{m}^{n+1}$ 的项分组到左侧，所有其他项分组到右侧：\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n+1} = \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。求解 $x_{m}^{n+1}$ 得：\n$$\nx_{m}^{n+1} = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\n这是单极点更新方程。我们现在可以确定单极点更新矩阵。令 $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$ 且 $B_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m}$。更新为 $x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$，这可以组装成规定的全局状态空间形式。\n\n全局状态向量是 $X^n = \\begin{pmatrix} x_1^n \\\\ \\vdots \\\\ x_N^n \\end{pmatrix}$。由于每个极点 $m$ 的动力学仅取决于其自身的状态 $x_m$ 和公共场 $E$，因此各极点之间的更新是解耦的。全局递归是：\n$$\nX^{n+1} = \\mathcal{A} X^n + \\mathcal{B} (E^{n+1} + E^n)\n$$\n其中问题要求 $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}E^{n+1} + \\mathcal{B}E^{n}$ 的形式。矩阵 $\\mathcal{A}$ 和 $\\mathcal{B}$ 具有块结构：\n$$\n\\mathcal{A} = \\begin{pmatrix} A_1  0  \\cdots  0 \\\\ 0  A_2  \\cdots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\cdots  A_N \\end{pmatrix}, \\quad \\mathcal{B} = \\begin{pmatrix} B_1 \\\\ B_2 \\\\ \\vdots \\\\ B_N \\end{pmatrix}\n$$\n问题要求 $\\mathcal{A}$ 的闭合形式表达式。为了找到它，我们必须计算矩阵 $A_m$。首先，我们找到要相乘和求逆的矩阵：\n$$\nI - \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1  -\\frac{\\Delta t}{2} \\\\ \\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 + \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$$\nI + \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)$ 的行列式是：\n$$\n\\det\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) = (1)\\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\left(-\\frac{\\Delta t}{2}\\right)\\left(\\frac{\\Delta t}{2}\\omega_{0,m}^{2}\\right) = 1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2}\n$$\n让我们将此行列式表示为 $D_m$。其逆矩阵是：\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m}  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 \\end{pmatrix}\n$$\n现在我们计算 $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$：\n$$\nA_m = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m}  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n执行矩阵乘法得到分子矩阵的分量：\n$$\n(A_m)_{11} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{12} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right)\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ \\Delta t \\right]\n$$\n$$\n(A_m)_{21} = \\frac{1}{D_m} \\left[ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} - \\frac{\\Delta t}{2}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ -\\Delta t \\, \\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{22} = \\frac{1}{D_m} \\left[ -\\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} + \\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n所以块 $A_m$ 是：\n$$\nA_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}  \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n$$\n全局矩阵 $\\mathcal{A}$ 是由这些 $A_m$ 块构成的块对角矩阵。\n\n最后，我们解释为什么这种结构能够实现 SIMD 更新。SIMD 代表单指令多数据（Single Instruction, Multiple Data），这是一种并行处理范式，其中相同的操作同时在多个数据点上执行。\n推导出的全局更新方程是 $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}(E^{n+1} + E^{n})$。关键特征是矩阵 $\\mathcal{A}$ 是块对角的。这种结构在数学上表示了洛伦兹极点的物理独立性。单个极点状态的更新，$x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$，仅取决于其自身的先前状态 $x_m^n$ 和公共驱动场 $E$。它不依赖于任何其他极点 $k \\neq m$ 的状态 $x_k^n$。\n这种独立性是 SIMD 并行化的关键。\n1.  **单指令**：计算 $A_m x_m^n$ 并加上场项所需的算术运算序列对每个极点 $m$ 都是相同的。这个序列构成了“单指令”。尽管 $A_m$ 中的系数（源自 $\\gamma_m$, $\\omega_{0,m}$）对每个极点都不同，但计算的结构是相同的。\n2.  **多数据**：$N$ 个不同极点的状态向量 $\\{x_1^n, x_2^n, ..., x_N^n\\}$ 构成了“多数据”。\n在 SIMD 架构中（例如，在 CPU 上使用 AVX 指令或在 GPU 上），可以将多个极点的状态向量分量加载到宽向量寄存器中。例如，一个寄存器可以容纳一组不同极点 $m$ 的 $P_m$ 值，另一个寄存器可以容纳 $J_m$ 值。然后，由更新算法定义的相同的浮点乘法和加法将并行应用于寄存器中的所有数据通道。\n因为极点 $m$ 的更新不需要来自极点 $k$ 的任何信息，所以极点更新之间没有**数据冒险**。所有 $N$ 个极点都可以并发更新，而无需等待彼此的结果。这种极点间数据依赖性的缺乏使得具有块对角更新矩阵的 ADE-FDTD 算法在现代并行硬件上异常高效。\n最终答案是矩阵 $\\mathcal{A}$ 的闭合形式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} A_1  \\mathbf{0}  \\cdots  \\mathbf{0} \\\\ \\mathbf{0}  A_2  \\cdots  \\mathbf{0} \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ \\mathbf{0}  \\mathbf{0}  \\cdots  A_N \\end{pmatrix} \\text{ 其中 } A_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}  \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2}  1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n}\n$$", "id": "3289886"}]}