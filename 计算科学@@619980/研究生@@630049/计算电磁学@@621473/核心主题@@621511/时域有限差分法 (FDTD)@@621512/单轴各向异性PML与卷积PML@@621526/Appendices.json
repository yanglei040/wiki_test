{"hands_on_practices": [{"introduction": "在实现单轴各向异性完美匹配层（UPML）之前，理解其对仿真数值稳定性的影响至关重要。本实践将指导您通过冯·诺依曼稳定性分析，推导存在UPML时的 Courant-Friedrichs-Lewy (CFL) 条件。通过这一过程，您将揭示PML的复坐标伸缩参数如何直接约束模拟所允许的最大时间步长，从而为任何FDTD实现奠定坚实的理论基础。[@problem_id:3358766]", "problem": "考虑一个在均匀 Yee 网格上建立的三维时域有限差分 (FDTD) 方案，其网格间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$。该方案实现了一个通过复坐标拉伸描述的单轴完美匹配层 (UPML)。其基础物理受线性介质中的麦克斯韦方程组控制，即 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$、$\\nabla \\times \\mathbf{H} = \\partial \\mathbf{D}/\\partial t$，以及本构关系 $\\mathbf{D} = \\overline{\\overline{\\epsilon}}\\,\\mathbf{E}$、$\\mathbf{B} = \\overline{\\overline{\\mu}}\\,\\mathbf{H}$，其中真空中的光速为 $c = 1/\\sqrt{\\epsilon_{0}\\mu_{0}}$。在 UPML 中，材料张量 $\\overline{\\overline{\\epsilon}}$ 和 $\\overline{\\overline{\\mu}}$ 由对角复数拉伸算子 $\\overline{\\overline{s}} = \\mathrm{diag}(s_{x}, s_{y}, s_{z})$ 根据以下公式导出：\n$$\n\\overline{\\overline{\\epsilon}} = \\epsilon_{0}\\,\\epsilon_{r}\\,\\mathrm{diag}\\!\\left(\\frac{s_{y}s_{z}}{s_{x}},\\,\\frac{s_{x}s_{z}}{s_{y}},\\,\\frac{s_{x}s_{y}}{s_{z}}\\right), \\quad\n\\overline{\\overline{\\mu}} = \\mu_{0}\\,\\mu_{r}\\,\\mathrm{diag}\\!\\left(\\frac{s_{y}s_{z}}{s_{x}},\\,\\frac{s_{x}s_{z}}{s_{y}},\\,\\frac{s_{x}s_{y}}{s_{z}}\\right).\n$$\n假设一个均匀的 UPML 区域，其恒定的对角拉伸因子以卷积完美匹配层 (CPML) 的形式建模为\n$$\ns_{i}(\\omega) = \\kappa_{i} + \\frac{\\sigma_{i}}{\\alpha_{i} + j\\,\\omega\\,\\epsilon_{0}}, \\quad i \\in \\{x,y,z\\},\n$$\n其中 $\\kappa_{i} \\geq 1$、$\\sigma_{i} \\geq 0$ 和 $\\alpha_{i} \\geq 0$ 是常数。使用 Yee 方案的离散平面波 (von Neumann) 分析和上述各向异性本构关系，推导时间步长 $\\Delta t$ 的 Courant–Friedrichs–Lewy (CFL) 稳定性边界，该边界保证了在该均匀 UPML 中对所有可分辨的离散空间频率的绝对稳定性。明确展示对角拉伸幅度 $|s_{i}(\\omega)|$ 如何通过有效波速进入该边界，并论证损耗项 $\\sigma_{i}$ 和 $\\alpha_{i}$ 如何影响对 $\\Delta t$ 的最终约束。\n\n提供最大稳定时间步长 $\\Delta t_{\\max}$ 的最终闭式表达式，该表达式用 $c$、$\\Delta x$、$\\Delta y$、$\\Delta z$ 和 $\\kappa_{i}$ 表示，并且在该均匀 UPML 中对所有频率都有一致的保证。时间步长限制以秒为单位表示。无需四舍五入。", "solution": "本问题要求推导在由复坐标拉伸描述的单轴完美匹配层 (UPML) 中，三维时域有限差分 (FDTD) 方案的 Courant–Friedrichs–Lewy (CFL) 稳定性边界。分析将通过离散平面波 (von Neumann) 稳定性分析进行。\n\n在应用了由给定各向异性张量隐式定义的拉伸坐标变换后，频域中的控制方程导出了连续平面波 $\\mathbf{E} = \\mathbf{E}_{0} \\exp(j\\omega t - j\\mathbf{k} \\cdot \\mathbf{r})$ 的色散关系：\n$$\n\\frac{k_{x}^{2}}{s_{x}(\\omega)^{2}} + \\frac{k_{y}^{2}}{s_{y}(\\omega)^{2}} + \\frac{k_{z}^{2}}{s_{z}(\\omega)^{2}} = \\omega^{2}\\mu_{0}\\mu_{r}\\epsilon_{0}\\epsilon_{r} = \\frac{\\omega^{2}}{v_{m}^{2}}\n$$\n其中 $k_{x}$、$k_{y}$、$k_{z}$ 是波矢量 $\\mathbf{k}$ 的分量，$\\omega$ 是角频率，而 $v_{m} = 1/\\sqrt{\\mu_{0}\\mu_{r}\\epsilon_{0}\\epsilon_{r}} = c/\\sqrt{\\mu_{r}\\epsilon_{r}}$ 是背景介质中的光速。问题要求最终表达式用 $c$ 表示，这意味着背景介质是真空，因此 $\\epsilon_{r}=1$，$\\mu_{r}=1$，并且 $v_{m}=c$。\n\nFDTD 方法对空间和时间都进行离散化。在 von Neumann 分析中，我们考察 Yee 网格上单个离散平面波模式的行为。该分析通过将连续导数算子替换为其有限差分对应项，导出一个数值色散关系。对于均匀网格上的中心差分格式，这些替换如下：\n$$\n\\frac{\\partial}{\\partial t} \\rightarrow \\frac{Z^{1/2} - Z^{-1/2}}{\\Delta t} \\quad \\text{或} \\quad \\omega \\rightarrow \\tilde{\\omega} = \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)\n$$\n$$\n\\frac{\\partial}{\\partial i} \\rightarrow \\frac{e^{-j k_{i} \\Delta i/2} - e^{j k_{i} \\Delta i/2}}{\\Delta i} \\quad \\text{或} \\quad k_{i} \\rightarrow \\tilde{k}_{i} = \\frac{2}{\\Delta i} \\sin\\left(\\frac{k_{i} \\Delta i}{2}\\right) \\quad \\text{for } i \\in \\{x, y, z\\}\n$$\n其中 $Z = \\exp(j\\omega\\Delta t)$ 是放大因子，而 $\\Delta t, \\Delta x, \\Delta y, \\Delta z$ 是时间和空间步长。\n\n对于像 CPML 这样的色散介质，数值方案的稳定性由介质的高频响应决定。CFL 条件是对信息在网格上传播的最大速度的约束。该速度由介质在无限频率极限下 ($\\omega \\rightarrow \\infty$) 的性质控制，这对应于瞬时响应。包括有效 PML 公式在内的因果材料模型，其色散特性必须在无限频率时消失。\n\n给定的复数拉伸因子为：\n$$\ns_{i}(\\omega) = \\kappa_{i} + \\frac{\\sigma_{i}}{\\alpha_{i} + j\\,\\omega\\,\\epsilon_{0}}, \\quad i \\in \\{x,y,z\\}\n$$\n在高频极限下，我们有：\n$$\n\\lim_{\\omega\\to\\infty} s_{i}(\\omega) = \\lim_{\\omega\\to\\infty} \\left( \\kappa_{i} + \\frac{\\sigma_{i}}{\\alpha_{i} + j\\,\\omega\\,\\epsilon_{0}} \\right) = \\kappa_{i}\n$$\n因为分母中包含 $\\omega$ 的项会趋于无穷，使得分数项消失。因此，为了确定 CFL 稳定性边界，UPML 表现为一个具有实数拉伸因子 $s_{i} = \\kappa_{i}$ 的简单非色散各向异性介质。\n\n必须考虑损耗参数 $\\sigma_{i}$ 和 $\\alpha_{i}$ 的影响。这些参数控制 PML 的吸收特性。假设 PML 被恰当设计为无源的，损耗项会向系统中引入阻尼。阻尼只会使 FDTD 方案更稳定（即减小放大因子 $|Z|$ 的幅度）；它不能使对 $\\Delta t$ 的稳定性条件更严格。因此，稳定性边界由最坏情况下的无损耗情景决定，这对应于 $s_{i}=\\kappa_{i}$ 的高频极限。\n\n将高频拉伸因子 $s_{i} = \\kappa_{i}$ 和 FDTD 数值算子代入连续色散关系，我们得到系统的数值色散关系：\n$$\n\\frac{1}{c^{2}} \\left( \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^{2} = \\frac{1}{\\kappa_{x}^{2}} \\left( \\frac{2}{\\Delta x} \\sin\\left(\\frac{k_{x} \\Delta x}{2}\\right) \\right)^{2} + \\frac{1}{\\kappa_{y}^{2}} \\left( \\frac{2}{\\Delta y} \\sin\\left(\\frac{k_{y} \\Delta y}{2}\\right) \\right)^{2} + \\frac{1}{\\kappa_{z}^{2}} \\left( \\frac{2}{\\Delta z} \\sin\\left(\\frac{k_{z} \\Delta z}{2}\\right) \\right)^{2}\n$$\n求解 $\\sin^{2}(\\omega \\Delta t/2)$：\n$$\n\\sin^{2}\\left(\\frac{\\omega \\Delta t}{2}\\right) = (c \\Delta t)^{2} \\left[ \\frac{\\sin^{2}\\left(\\frac{k_{x} \\Delta x}{2}\\right)}{(\\kappa_{x}\\Delta x)^{2}} + \\frac{\\sin^{2}\\left(\\frac{k_{y} \\Delta y}{2}\\right)}{(\\kappa_{y}\\Delta y)^{2}} + \\frac{\\sin^{2}\\left(\\frac{k_{z} \\Delta z}{2}\\right)}{(\\kappa_{z}\\Delta z)^{2}} \\right]\n$$\n对于一个稳定的方案，任何对应于实数值空间频率 ($k_{x}, k_{y}, k_{z}$) 的 $\\omega$ 解都必须具有非正虚部，即 $\\Im(\\omega) \\le 0$。这确保了放大因子 $|Z| = |\\exp(j\\omega\\Delta t)| = \\exp(-\\Im(\\omega)\\Delta t) \\le 1$。对此的一个充分条件是要求对于任意实数值的 $k_{x}, k_{y}, k_{z}$，计算出的 $\\omega$ 都是实数。这要求 $\\sin^{2}(\\omega \\Delta t/2)$ 方程的右侧必须小于或等于 $1$。\n\n为了找到对 $\\Delta t$ 最严格的条件，我们必须使方程右侧相对于空间波数最大化。当正弦项的自变量是 $\\pi/2$ 的奇数倍时，它们达到最大值，这使得 $\\sin^{2}(\\cdot) = 1$。这对应于网格可分辨的最高空间频率（奈奎斯特频率）。\n$$\n\\max_{k_x, k_y, k_z} \\left[ \\dots \\right] = \\frac{1}{(\\kappa_{x}\\Delta x)^{2}} + \\frac{1}{(\\kappa_{y}\\Delta y)^{2}} + \\frac{1}{(\\kappa_{z}\\Delta z)^{2}}\n$$\n将此最大值代入稳定性不等式中：\n$$\n1 \\ge (c \\Delta t)^{2} \\left[ \\frac{1}{(\\kappa_{x}\\Delta x)^{2}} + \\frac{1}{(\\kappa_{y}\\Delta y)^{2}} + \\frac{1}{(\\kappa_{z}\\Delta z)^{2}} \\right]\n$$\n求解 $\\Delta t$ 得到稳定性极限：\n$$\n(\\Delta t)^{2} \\le \\frac{1}{c^{2} \\left[ \\left(\\frac{1}{\\kappa_{x} \\Delta x}\\right)^{2} + \\left(\\frac{1}{\\kappa_{y} \\Delta y}\\right)^{2} + \\left(\\frac{1}{\\kappa_{z} \\Delta z}\\right)^{2} \\right]}\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = \\frac{1}{c \\sqrt{\\left(\\frac{1}{\\kappa_{x} \\Delta x}\\right)^{2} + \\left(\\frac{1}{\\kappa_{y} \\Delta y}\\right)^{2} + \\left(\\frac{1}{\\kappa_{z} \\Delta z}\\right)^{2}}}\n$$\n该表达式提供了在均匀 UPML 内，对所有频率和所有可分辨的波传播角度都一致的 CFL 稳定性边界，前提是参数的选择使得介质是无源的。假设 $c$ 的单位是米/秒，$\\Delta x, \\Delta y, \\Delta z$ 的单位是米，则 $\\Delta t$ 的最终单位是秒。", "answer": "$$\\boxed{\\frac{1}{c \\sqrt{\\left(\\frac{1}{\\kappa_{x} \\Delta x}\\right)^{2} + \\left(\\frac{1}{\\kappa_{y} \\Delta y}\\right)^{2} + \\left(\\frac{1}{\\kappa_{z} \\Delta z}\\right)^{2}}}}$$", "id": "3358766"}, {"introduction": "在掌握了理论稳定性极限之后，下一步是验证具体实现的稳定性。本练习要求您将一维卷积完美匹配层（CPML）的更新方程建模为一个线性系统，并数值计算其更新矩阵的特征值。通过确认所有特征值的模都严格小于1，您可以直接证明在给定CPML参数下，您的FDTD格式是稳定的，这是确保数值模拟可靠性的关键一步。[@problem_id:3358782]", "problem": "考虑用于麦克斯韦方程组的一维时域有限差分 (FDTD) 格式，该格式包含一个卷积完美匹配层 (CPML)，它是单轴各向异性完美匹配层 (UA-PML) 的时域等效形式。电磁场在交错时间网格上更新：电场 $E$ 在整数时间索引 $n$ 处更新，磁场 $H$ 在半整数时间索引 $n+\\tfrac{1}{2}$ 处更新。假设一个沿 $x$ 方向的 CPML，其采用非分裂场形式，并通过记忆变量实现。对于角波数为 $k$（单位：弧度/米）的单个空间傅里叶谐波，离散空间导数可以表示为与复数因子 $J$ 的乘积，其中 $J = \\mathrm{i} S$ 且 $S = \\tfrac{2}{\\Delta x} \\sin\\!\\big(\\tfrac{k \\Delta x}{2}\\big)$。\n\n设 $\\epsilon$ 为介电常数（单位：法拉/米），$\\mu$ 为磁导率（单位：亨利/米），并定义光速 $c = \\tfrac{1}{\\sqrt{\\mu \\epsilon}}$。设时间步长为 $\\Delta t$，空间步长为 $\\Delta x$，并强制满足 Courant 条件 $\\Delta t = 0.99 \\,\\tfrac{\\Delta x}{c}$。CPML 使用参数 $\\sigma$（单位：1/秒）、$\\kappa$（无量纲）和 $\\alpha$（单位：1/秒）来定义坐标拉伸算子。相关的记忆变量递推系数为\n$$\nb = \\exp\\!\\Big(-\\big(\\tfrac{\\sigma}{\\kappa} + \\alpha\\big) \\Delta t\\Big), \\quad\nc = \\frac{\\sigma}{\\sigma \\kappa + \\kappa^2 \\alpha} \\, (b - 1).\n$$\n\n在一维情况下，CPML 通过对应于 $x$ 方向导数贡献的辅助记忆变量 $\\psi_E$ 和 $\\psi_H$ 来修改有效离散通量。使用空间导数的傅里叶表示，单个谐波的更新方程是线性的，并由以下公式给出\n$$\nH^{n+\\frac{1}{2}} = H^{n-\\frac{1}{2}} + \\frac{\\Delta t}{\\mu} \\left( \\frac{1}{\\kappa} J E^n + \\psi_E^n \\right),\n$$\n$$\n\\psi_H^{n+\\frac{1}{2}} = b \\, \\psi_H^{n-\\frac{1}{2}} + c \\, J \\, H^{n+\\frac{1}{2}},\n$$\n$$\nE^{n+1} = E^n + \\frac{\\Delta t}{\\epsilon} \\left( \\frac{1}{\\kappa} J H^{n+\\frac{1}{2}} + \\psi_H^{n+\\frac{1}{2}} \\right),\n$$\n$$\n\\psi_E^{n+1} = b \\, \\psi_E^n + c \\, J \\, E^{n+1}.\n$$\n这些关系定义了一个从时间 $n$ 的状态向量\n$$\n\\mathbf{x}^n = \\begin{bmatrix} E^n \\\\ H^{n-\\frac{1}{2}} \\\\ \\psi_E^n \\\\ \\psi_H^{n-\\frac{1}{2}} \\end{bmatrix},\n$$\n到时间 $n+1$ 的状态向量\n$$\n\\mathbf{x}^{n+1} = \\begin{bmatrix} E^{n+1} \\\\ H^{n+\\frac{1}{2}} \\\\ \\psi_E^{n+1} \\\\ \\psi_H^{n+\\frac{1}{2}} \\end{bmatrix} = \\mathbf{A} \\, \\mathbf{x}^n,\n$$\n的线性更新映射，其中 $\\mathbf{A}$ 是一个由 $\\epsilon$、$\\mu$、$\\Delta x$、$\\Delta t$、$k$、$\\sigma$、$\\kappa$ 和 $\\alpha$ 决定的 $4 \\times 4$ 复矩阵。目标是显式地构造 $\\mathbf{A}$，并为选定的参数集计算其特征值。\n\n从麦克斯韦方程组和 UA-PML 复坐标拉伸出发，在傅里叶谐波的设定下推导出上述离散更新，并组装出显式线性更新矩阵 $\\mathbf{A}$。然后，对于一组科学上合理的参数值，计算 $\\mathbf{A}$ 的特征值，并验证它们都严格位于复平面的单位圆内部。\n\n所有量都必须在国际单位制 (SI) 下进行解释：距离单位为米，时间单位为秒，介电常数单位为法拉/米，磁导率单位为亨利/米，角波数 $k$ 单位为弧度/米。角度（如果存在）必须以弧度为单位。每个测试用例的验证必须返回一个布尔值，该值指示是否所有特征值都满足 $|\\lambda|  1$。\n\n使用以下参数值的测试套件：\n1. 用例 1（正常路径，中等阻尼，近奈奎斯特空间谐波）：$\\epsilon = \\epsilon_0$, $\\mu = \\mu_0$, $\\Delta x = 1.0 \\times 10^{-3}$, $\\Delta t = 0.99 \\,\\tfrac{\\Delta x}{c}$, $k = 0.9 \\,\\tfrac{\\pi}{\\Delta x}$, $\\sigma = 5.0 \\times 10^{10}$, $\\kappa = 3.0$, $\\alpha = 2.0 \\times 10^{9}$。\n2. 用例 2（强阻尼，最差情况奈奎斯特谐波）：$\\epsilon = \\epsilon_0$, $\\mu = \\mu_0$, $\\Delta x = 1.0 \\times 10^{-3}$, $\\Delta t = 0.99 \\,\\tfrac{\\Delta x}{c}$, $k = \\tfrac{\\pi}{\\Delta x}$, $\\sigma = 1.0 \\times 10^{10}$, $\\kappa = 1.5$, $\\alpha = 1.0 \\times 10^{9}$。\n3. 用例 3（较小空间步长，高阻尼，中频带谐波）：$\\epsilon = \\epsilon_0$, $\\mu = \\mu_0$, $\\Delta x = 5.0 \\times 10^{-4}$, $\\Delta t = 0.99 \\,\\tfrac{\\Delta x}{c}$, $k = \\tfrac{\\pi}{2 \\Delta x}$, $\\sigma = 3.0 \\times 10^{10}$, $\\kappa = 2.5$, $\\alpha = 5.0 \\times 10^{9}$。\n4. 用例 4（较大的 $\\kappa$ 值，中等阻尼，低频谐波）：$\\epsilon = \\epsilon_0$, $\\mu = \\mu_0$, $\\Delta x = 2.0 \\times 10^{-3}$, $\\Delta t = 0.99 \\,\\tfrac{\\Delta x}{c}$, $k = 0.2 \\,\\tfrac{\\pi}{\\Delta x}$, $\\sigma = 8.0 \\times 10^{10}$, $\\kappa = 4.0$, $\\alpha = 1.0 \\times 10^{9}$。\n\n此处 $\\epsilon_0$ 和 $\\mu_0$ 分别表示真空介电常数和真空磁导率，且 $c = \\tfrac{1}{\\sqrt{\\mu_0 \\epsilon_0}}$。\n\n您的程序必须：\n- 为每个用例构造矩阵 $\\mathbf{A}$，\n- 计算其特征值，\n- 判断是否所有特征值都满足 $|\\lambda|  1$，\n- 生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $\\big[$result1,result2,result3,result4$\\big]$，其中每个结果都是一个布尔值。\n\n不允许外部输入。输出必须是严格符合指定格式的单行文本。", "solution": "用户提供的问题经评估是有效的。它在科学上基于计算电磁学的原理，特别是时域有限差分 (FDTD) 方法和卷积完美匹配层 (CPML) 吸收体。这个问题是适定的，提供了一套完整的方程和参数来构建一个线性系统并分析其稳定性，这是偏微分方程数值分析中的一个标准程序。所给的参数和常数在物理上是现实的，并且在量纲上是一致的。\n\n问题的核心是确定给定的 FDTD-CPML 格式对于单个空间傅里叶谐波的稳定性。稳定性由线性更新矩阵 $\\mathbf{A}$ 的特征值决定，该矩阵将系统状态从一个时间步映射到下一个时间步。为使数值解保持有界，$\\mathbf{A}$ 的所有特征值 $\\lambda$ 必须满足 $|\\lambda| \\le 1$。对于像 PML 这样的耗散系统（其设计目的是吸收出射波），我们期望其特征值严格位于单位圆内部，即 $|\\lambda|  1$。\n\n更新矩阵 $\\mathbf{A}$ 的推导过程如下。系统状态由以下向量定义：\n$$\n\\mathbf{x}^n = \\begin{bmatrix} E^n \\\\ H^{n-\\frac{1}{2}} \\\\ \\psi_E^n \\\\ \\psi_H^{n-\\frac{1}{2}} \\end{bmatrix}\n$$\n下一个时间步的状态由以下公式给出：\n$$\n\\mathbf{x}^{n+1} = \\begin{bmatrix} E^{n+1} \\\\ H^{n+\\frac{1}{2}} \\\\ \\psi_E^{n+1} \\\\ \\psi_H^{n+\\frac{1}{2}} \\end{bmatrix} = \\mathbf{A} \\, \\mathbf{x}^n\n$$\n我们的目标是通过将 $\\mathbf{x}^{n+1}$ 的每个分量表示为 $\\mathbf{x}^n$ 各分量的线性组合，来求得这个 $4 \\times 4$ 复矩阵 $\\mathbf{A}$。我们使用所提供的四个更新方程：\n1.  $H^{n+\\frac{1}{2}} = H^{n-\\frac{1}{2}} + \\frac{\\Delta t}{\\mu} \\left( \\frac{1}{\\kappa} J E^n + \\psi_E^n \\right)$\n2.  $\\psi_H^{n+\\frac{1}{2}} = b \\, \\psi_H^{n-\\frac{1}{2}} + c \\, J \\, H^{n+\\frac{1}{2}}$\n3.  $E^{n+1} = E^n + \\frac{\\Delta t}{\\epsilon} \\left( \\frac{1}{\\kappa} J H^{n+\\frac{1}{2}} + \\psi_H^{n+\\frac{1}{2}} \\right)$\n4.  $\\psi_E^{n+1} = b \\, \\psi_E^n + c \\, J \\, E^{n+1}$\n\n对于波数为 $k$ 的单个傅里叶谐波，离散空间导数算子为 $J = \\mathrm{i} S$，其中 $S = \\frac{2}{\\Delta x} \\sin(\\frac{k \\Delta x}{2})$。CPML 系数为 $b = \\exp(-\\left(\\frac{\\sigma}{\\kappa} + \\alpha\\right) \\Delta t)$ 和 $c = \\frac{\\sigma}{\\sigma \\kappa + \\kappa^2 \\alpha} (b - 1)$。\n\n让我们来推导与 $\\mathbf{x}^{n+1}$ 各分量相对应的 $\\mathbf{A}$ 的各行。\n\n首先，我们求出 $H^{n+\\frac{1}{2}}$ 的表达式，它对应于 $\\mathbf{x}^{n+1}$ 的第二个分量。方程 (1) 已经处于所需的形式：\n$$\nH^{n+\\frac{1}{2}} = \\left(\\frac{\\Delta t J}{\\mu \\kappa}\\right) E^n + (1) H^{n-\\frac{1}{2}} + \\left(\\frac{\\Delta t}{\\mu}\\right) \\psi_E^n + (0) \\psi_H^{n-\\frac{1}{2}}\n$$\n这给出了矩阵 $\\mathbf{A}$ 的第二行（对矩阵行/列使用基于 1 的索引）：\n$$\n\\mathbf{A}_{2,1} = \\frac{\\Delta t J}{\\mu \\kappa}, \\quad \\mathbf{A}_{2,2} = 1, \\quad \\mathbf{A}_{2,3} = \\frac{\\Delta t}{\\mu}, \\quad \\mathbf{A}_{2,4} = 0\n$$\n\n接下来，我们求出 $\\psi_H^{n+\\frac{1}{2}}$ 的表达式（$\\mathbf{x}^{n+1}$ 的第四个分量）。我们将 $H^{n+\\frac{1}{2}}$ 的表达式代入方程 (2)：\n$$\n\\psi_H^{n+\\frac{1}{2}} = b \\, \\psi_H^{n-\\frac{1}{2}} + c \\, J \\, \\left[ \\left(\\frac{\\Delta t J}{\\mu \\kappa}\\right) E^n + H^{n-\\frac{1}{2}} + \\left(\\frac{\\Delta t}{\\mu}\\right) \\psi_E^n \\right]\n$$\n$$\n\\psi_H^{n+\\frac{1}{2}} = \\left(\\frac{c \\Delta t J^2}{\\mu \\kappa}\\right) E^n + (c J) H^{n-\\frac{1}{2}} + \\left(\\frac{c \\Delta t J}{\\mu}\\right) \\psi_E^n + (b) \\psi_H^{n-\\frac{1}{2}}\n$$\n这给出了 $\\mathbf{A}$ 的第四行：\n$$\n\\mathbf{A}_{4,1} = \\frac{c \\Delta t J^2}{\\mu \\kappa}, \\quad \\mathbf{A}_{4,2} = c J, \\quad \\mathbf{A}_{4,3} = \\frac{c \\Delta t J}{\\mu}, \\quad \\mathbf{A}_{4,4} = b\n$$\n\n现在，我们求出 $E^{n+1}$ 的表达式（$\\mathbf{x}^{n+1}$ 的第一个分量）。我们将 $H^{n+\\frac{1}{2}}$ 和 $\\psi_H^{n+\\frac{1}{2}}$ 的表达式（即 $\\mathbf{A}$ 的第 2 行和第 4 行作用于 $\\mathbf{x}^n$ 的结果）代入方程 (3)：\n$$\nE^{n+1} = E^n + \\frac{\\Delta t}{\\epsilon} \\left( \\frac{1}{\\kappa} J H^{n+\\frac{1}{2}} + \\psi_H^{n+\\frac{1}{2}} \\right)\n= E^n + \\frac{\\Delta t J}{\\epsilon \\kappa} \\left(\\sum_{j=1}^4 \\mathbf{A}_{2,j} x_j^n\\right) + \\frac{\\Delta t}{\\epsilon} \\left(\\sum_{j=1}^4 \\mathbf{A}_{4,j} x_j^n\\right)\n$$\n其中 $x_j^n$ 是 $\\mathbf{x}^n$ 的分量。收集 $x_j^n$ 的系数：\n$$\nE^{n+1} = \\sum_{j=1}^4 \\mathbf{A}_{1,j} x_j^n \\implies \\mathbf{A}_{1,j} = \\delta_{1,j} + \\frac{\\Delta t J}{\\epsilon \\kappa} \\mathbf{A}_{2,j} + \\frac{\\Delta t}{\\epsilon} \\mathbf{A}_{4,j}\n$$\n其中 $\\delta_{1,j}$ 是克罗内克 δ。这就定义了 $\\mathbf{A}$ 的第一行。\n\n最后，我们求出 $\\psi_E^{n+1}$ 的表达式（$\\mathbf{x}^{n+1}$ 的第三个分量）。我们将 $E^{n+1}$ 的表达式（即 $\\mathbf{A}$ 的第 1 行作用于 $\\mathbf{x}^n$ 的结果）代入方程 (4)：\n$$\n\\psi_E^{n+1} = b \\, \\psi_E^n + c \\, J \\, E^{n+1} = b \\, \\psi_E^n + c \\, J \\, \\left(\\sum_{j=1}^4 \\mathbf{A}_{1,j} x_j^n\\right)\n$$\n收集 $x_j^n$ 的系数：\n$$\n\\psi_E^{n+1} = \\sum_{j=1}^4 \\mathbf{A}_{3,j} x_j^n \\implies \\mathbf{A}_{3,j} = b \\delta_{3,j} + c J \\mathbf{A}_{1,j}\n$$\n这就定义了 $\\mathbf{A}$ 的第三行。\n\n通过这些步骤，完整的矩阵 $\\mathbf{A}$ 就被构造出来了。对于每个测试用例，我们代入给定的参数值，计算 $\\mathbf{A}$ 的数值项，计算其四个复特征值 $\\lambda_i$，并验证对于所有的 $i=1, 2, 3, 4$ 是否都有 $|\\lambda_i|  1$。结果是一个布尔值，指示该稳定性条件是否得到满足。下面的程序为提供的测试套件实现了这一过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Constructs the FDTD-CPML update matrix and checks its stability.\n    \"\"\"\n    # Define physical constants in SI units\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    MU_0 = 4 * np.pi * 1e-7      # Vacuum permeability (H/m)\n    C_LIGHT = 1 / np.sqrt(EPSILON_0 * MU_0)  # Speed of light in vacuum (m/s)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path, moderate damping, near-Nyquist\n        {\"dx\": 1.0e-3, \"k_factor\": 0.9, \"sigma\": 5.0e10, \"kappa\": 3.0, \"alpha\": 2.0e9},\n        # Case 2: strong damping, worst-case Nyquist\n        {\"dx\": 1.0e-3, \"k_factor\": 1.0, \"sigma\": 1.0e10, \"kappa\": 1.5, \"alpha\": 1.0e9},\n        # Case 3: smaller spatial step, high damping, mid-band\n        {\"dx\": 5.0e-4, \"k_factor\": 0.5, \"sigma\": 3.0e10, \"kappa\": 2.5, \"alpha\": 5.0e9},\n        # Case 4: larger kappa, moderate damping, low-frequency\n        {\"dx\": 2.0e-3, \"k_factor\": 0.2, \"sigma\": 8.0e10, \"kappa\": 4.0, \"alpha\": 1.0e9},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Material properties (vacuum)\n        eps = EPSILON_0\n        mu = MU_0\n\n        # Discretization parameters\n        dx = case[\"dx\"]\n        dt = 0.99 * dx / C_LIGHT\n        \n        # Spatial Fourier harmonic parameter\n        k = case[\"k_factor\"] * np.pi / dx\n        S = (2 / dx) * np.sin(k * dx / 2)\n        J = 1j * S\n\n        # CPML parameters\n        sigma = case[\"sigma\"]\n        kappa = case[\"kappa\"]\n        alpha = case[\"alpha\"]\n\n        # CPML recursion coefficients\n        b = np.exp(-(sigma / kappa + alpha) * dt)\n        if (sigma * kappa + kappa**2 * alpha) == 0:\n            # Avoid division by zero, although this shouldn't happen with given params\n            c_pml = 0 \n        else:\n            c_pml = (sigma / (sigma * kappa + kappa**2 * alpha)) * (b - 1)\n\n        # Construct the 4x4 update matrix A\n        # A maps [E^n, H^{n-1/2}, psi_E^n, psi_H^{n-1/2}]^T\n        # to    [E^{n+1}, H^{n+1/2}, psi_E^{n+1}, psi_H^{n+1/2}]^T\n        A = np.zeros((4, 4), dtype=complex)\n\n        # Row 2 (index 1): Update for H^{n+1/2}\n        # H^{n+1/2} = H^{n-1/2} + (dt/mu) * ( (1/kappa)*J*E^n + psi_E^n )\n        A[1, 0] = dt * J / (mu * kappa) # Coeff of E^n\n        A[1, 1] = 1.0                   # Coeff of H^{n-1/2}\n        A[1, 2] = dt / mu               # Coeff of psi_E^n\n        A[1, 3] = 0.0                   # Coeff of psi_H^{n-1/2}\n\n        # Row 4 (index 3): Update for psi_H^{n+1/2}\n        # psi_H^{n+1/2} = b*psi_H^{n-1/2} + c_pml*J*H^{n+1/2}\n        # Substitute H^{n+1/2} using the coefficients from row 1\n        A[3, 0] = c_pml * J * A[1, 0]\n        A[3, 1] = c_pml * J * A[1, 1]\n        A[3, 2] = c_pml * J * A[1, 2]\n        A[3, 3] = b + c_pml * J * A[1, 3] # A[1, 3] is 0, so this simplifies to b\n\n        # Row 1 (index 0): Update for E^{n+1}\n        # E^{n+1} = E^n + (dt/eps) * ( (1/kappa)*J*H^{n+1/2} + psi_H^{n+1/2} )\n        # Substitute H^{n+1/2} and psi_H^{n+1/2} using their coefficients\n        E_coeffs_from_H = (dt * J / (eps * kappa)) * A[1, :]\n        E_coeffs_from_psiH = (dt / eps) * A[3, :]\n        A[0, :] = E_coeffs_from_H + E_coeffs_from_psiH\n        A[0, 0] += 1.0 # Add the E^n term\n\n        # Row 3 (index 2): Update for psi_E^{n+1}\n        # psi_E^{n+1} = b*psi_E^n + c_pml*J*E^{n+1}\n        # Substitute E^{n+1} using its coefficients from row 0\n        psiE_coeffs_from_E = c_pml * J * A[0, :]\n        A[2, :] = psiE_coeffs_from_E\n        A[2, 2] += b # Add the b*psi_E^n term\n\n        # Compute eigenvalues of A\n        eigvals = np.linalg.eigvals(A)\n\n        # Check if all eigenvalues are strictly inside the unit circle\n        is_stable = np.all(np.abs(eigvals)  1.0)\n        results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3358782"}, {"introduction": "一个稳定的实现不一定是一个正确的实现。最后的这个实践介绍了“人造解方法”（Method of Manufactured Solutions, MMS），这是一种用于代码验证的强大技术。通过将一个已知的、解析的精确解代入离散化的控制方程中，您将学会如何度量由此产生的残差，该残差可以帮助您区分固有的离散化误差和关键的实现错误，从而确保代码的准确性。[@problem_id:3358794]", "problem": "考虑在自由空间中沿 $x$ 轴的一维横向电磁波传播，其电场为 $E_y(x,t)$，磁场为 $H_z(x,t)$。其基本依据是简谐时间依赖关系 $e^{j\\omega t}$ 下的一维麦克斯韦旋度方程，在频域中写作 $dH_z/dx = j\\omega\\epsilon_0 E_y$ 和 $dE_y/dx = j\\omega\\mu_0 H_z$。完美匹配层 (Perfectly Matched Layer, PML) 可以通过复坐标拉伸进行建模。在单轴各向异性完美匹配层 (uniaxial anisotropic Perfectly Matched Layer, UAPML) 中，整个域内的均匀复拉伸 $s_x$ 通过 $d/dx \\mapsto \\frac{1}{s_x} d/dx$ 来修改空间导数，而 $\\epsilon_0$ 和 $\\mu_0$ 保持不变。在卷积完美匹配层 (convolutional Perfectly Matched Layer, CPML) 中，对于单一频率，相同的均匀拉伸可以表示为将拉伸分解为有理形式 $s_x = \\kappa_x + \\frac{\\sigma_x}{j\\omega\\epsilon_0} + \\frac{\\alpha_x}{j\\omega}$，其中 $\\kappa_x$、$\\sigma_x$ 和 $\\alpha_x$ 是实数非负参数。\n\n您的任务是使用制造解方法，通过在整个域中使用均匀复拉伸来验证PML的实现，并计算离散残差以诊断离散化误差与实现误差。请按以下步骤进行：\n\n1. 从基本的一维麦克斯韦旋度方程和均匀拉伸 $s_x$ 的替换 $d/dx \\mapsto \\frac{1}{s_x} d/dx$ 出发，推导拉伸介质中关于 $E_y(x)$ 的二阶标量方程，并确定由自由空间色散关系所隐含的波数。仅使用所述的基本定律和定义。\n\n2. 选择一个与拉伸介质一致的制造单色解，该解应是非平凡、空间变化且平滑的。设自由空间波数为 $k_0 = \\omega \\sqrt{\\mu_0 \\epsilon_0}$，制造电场为 $E_y(x) = E_0 \\exp(-j k_0 s_x x)$，其中振幅 $E_0 \\neq 0$ 为实数。设 $H_z(x)$ 是由拉伸介质中的旋度方程所对应的磁场。由于残差将被归一化，因此无需指定 $E_0$。\n\n3. 在覆盖长度 $L$ 的 $N$ 个点的均匀网格上，对 $E_y(x)$ 的二阶方程进行离散化，网格间距为 $\\Delta x = L/(N-1)$，在内部点上使用标准的二阶中心差分近似来计算 $d^2E_y/dx^2$。将每个内部网格点 $x_i$ 的残差定义为将制造场值代入离散化方程后，方程左侧的值。将归一化残差定义为残差向量的离散 $\\ell_2$ 范数与在内部点采样的制造场向量的离散 $\\ell_2$ 范数之比。此归一化残差是无量纲的。\n\n4. 对于UAPML，使用正确的拉伸方程计算归一化残差。为模拟实现错误，为一个错误地仅缩放一个本构参数的求解器计算归一化残差（等效于在正确方程需要 $s_x^2$ 的地方使用 $s_x$ 的一次方）。比较残差的量级。\n\n5. 对于CPML，在单一频率下，通过参数 $\\kappa_x$、$\\sigma_x$ 和 $\\alpha_x$ 表达相同的均匀拉伸 $s_x$。使用正确组装的 $s_x$ 计算归一化残差。为模拟CPML中的实现错误，使用一个不正确的拉伸计算归一化残差，其中电导率项缺少因子 $\\epsilon_0$，即 $s_x^{\\text{wrong}} = \\kappa_x + \\frac{\\sigma_x}{j\\omega}$。\n\n所有物理常数和参数必须明确指定，并且制造解必须使用这些值进行评估。使用以下以国际单位制 (SI) 表示的测试套件：\n\n- 自由空间参数：$\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$，$\\epsilon_0 = 8.854187817 \\times 10^{-12}\\ \\mathrm{F/m}$。\n- 光速：$c_0 = 1/\\sqrt{\\mu_0 \\epsilon_0}$，仅在需要时用于验证。\n- 频率：$f = 1.0 \\times 10^9\\ \\mathrm{Hz}$，角频率 $\\omega = 2\\pi f$，单位为 $\\mathrm{rad/s}$。\n- 域长度：$L = 1.0\\ \\mathrm{m}$。\n- 制造拉伸目标：$s_x = 1 - 0.2 j$（无量纲）。\n- 正确情况下的CPML参数：$\\kappa_x = 1.0$，$\\alpha_x = 0.0$，以及选择 $\\sigma_x$ 使得 $\\frac{\\sigma_x}{\\omega \\epsilon_0} = 0.2$，即 $\\sigma_x = 0.2\\,\\omega\\,\\epsilon_0$，单位为 $\\mathrm{S/m}$。\n\n使用以下五个测试用例计算归一化残差：\n\n- 测试1（UAPML，正确，细网格）：$N = 201$，$s_x = 1 - 0.2 j$，正确的二阶方程。\n- 测试2（UAPML，正确，粗网格）：$N = 21$，$s_x = 1 - 0.2 j$，正确的二阶方程。\n- 测试3（UAPML，实现错误）：$N = 201$，$s_x = 1 - 0.2 j$，但在需要 $s_x^2$ 的源项中使用了 $s_x$ 的一次方。\n- 测试4（CPML，正确组装）：$N = 201$，通过 $s_x = \\kappa_x + \\frac{\\sigma_x}{j\\omega\\epsilon_0} + \\frac{\\alpha_x}{j\\omega}$ 从 $\\kappa_x$、$\\sigma_x$、$\\alpha_x$ 计算 $s_x$，并使用正确的二阶方程。\n- 测试5（CPML，参数缩放错误）：$N = 201$，计算 $s_x^{\\text{wrong}} = \\kappa_x + \\frac{\\sigma_x}{j\\omega}$（缺少 $\\epsilon_0$），并在二阶方程中代替 $s_x$ 使用。\n\n程序必须为每个测试用例计算归一化残差，结果为实值浮点数。所有计算必须在国际单位制 (SI) 下执行。角度由复指数隐含，因此不需要单独的角度单位。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[r1,r2,r3,r4,r5]”），其中 $r1$ 到 $r5$ 分别是测试1到5的归一化残差。", "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。它提出了一个计算电磁学中的标准验证任务，使用制造解方法来测试完美匹配层（PMLs）的实现。所有参数和测试用例都得到了明确的定义。\n\n求解过程分四个阶段进行：1) 推导UAPML介质中电场的连续控制方程，2) 构建离散化和残差的公式，3) 分析具体的测试用例，以及 4) 实现数值计算。\n\n**1. 控制方程的推导**\n\n我们从频域中的一维、时谐麦克斯韦旋度方程开始，假设时间依赖性为 $e^{j\\omega t}$：\n$$\n\\frac{dH_z}{dx} = j\\omega\\epsilon_0 E_y\n$$\n$$\n\\frac{dE_y}{dx} = j\\omega\\mu_0 H_z\n$$\n单轴各向异性PML (UAPML) 通过引入一个在整个域内均匀的复坐标拉伸因子 $s_x$ 来建模。这将空间导数算子修改为 $d/dx \\rightarrow \\frac{1}{s_x} d/dx$。将此变换应用于麦克斯韦方程组，得到：\n$$\n\\frac{1}{s_x} \\frac{dH_z}{dx} = j\\omega\\epsilon_0 E_y \\quad \\implies \\quad \\frac{dH_z}{dx} = j\\omega\\epsilon_0 s_x E_y \\quad (1)\n$$\n$$\n\\frac{1}{s_x} \\frac{dE_y}{dx} = j\\omega\\mu_0 H_z \\quad \\implies \\quad \\frac{dE_y}{dx} = j\\omega\\mu_0 s_x H_z \\quad (2)\n$$\n为了得到关于 $E_y(x)$ 的二阶方程，我们将方程 (2) 对 $x$ 求导，并代入方程 (1)。由于 $s_x$ 是一个常数，我们按以下步骤进行。首先，从方程 (2) 中分离出 $H_z$：\n$$\nH_z = \\frac{1}{j\\omega\\mu_0 s_x} \\frac{dE_y}{dx}\n$$\n接下来，将这个关于 $H_z$ 的表达式对 $x$ 求导：\n$$\n\\frac{dH_z}{dx} = \\frac{1}{j\\omega\\mu_0 s_x} \\frac{d^2E_y}{dx^2}\n$$\n将此结果代入方程 (1) 得到：\n$$\n\\frac{1}{j\\omega\\mu_0 s_x} \\frac{d^2E_y}{dx^2} = j\\omega\\epsilon_0 s_x E_y\n$$\n重新整理各项，我们得到关于 $E_y(x)$ 的亥姆霍兹型方程：\n$$\n\\frac{d^2E_y}{dx^2} = (j\\omega s_x)^2 \\mu_0 \\epsilon_0 E_y = -\\omega^2 \\mu_0 \\epsilon_0 s_x^2 E_y\n$$\n定义自由空间波数为 $k_0 = \\omega \\sqrt{\\mu_0 \\epsilon_0}$，我们有 $k_0^2 = \\omega^2 \\mu_0 \\epsilon_0$。最终的二阶标量方程是：\n$$\n\\frac{d^2E_y}{dx^2} + k_0^2 s_x^2 E_y = 0\n$$\n该方程表明，拉伸介质中的有效波数为 $k_s = k_0 s_x$。\n\n所提供的制造解是 $E_y(x) = E_0 \\exp(-j k_0 s_x x)$。这是一个以复波数 $k_s$ 传播的平面波，是所推导的连续方程的精确解。\n\n**2. 离散化与残差定义**\n\n长度为 $L$ 的域被离散化为一个由 $N$ 个点组成的均匀网格 $\\{x_i\\}_{i=0}^{N-1}$，网格间距为 $\\Delta x = L/(N-1)$。在内部网格点 $x_i$（$1 \\le i \\le N-2$）处，$E_y$ 的二阶导数使用二阶中心有限差分进行近似：\n$$\n\\frac{d^2E_y}{dx^2}\\bigg|_{x_i} \\approx \\frac{E_y(x_{i+1}) - 2E_y(x_i) + E_y(x_{i-1})}{\\Delta x^2}\n$$\n将此近似代入控制方程，得到离散方程。每个内部点 $x_i$ 处的残差 $R_i$ 被定义为将精确制造解 $E_{y,i}^{\\text{manuf}} = E_y(x_i)$ 代入离散方程后得到的值。对于正确的控制方程，残差为：\n$$\nR_i = \\frac{E_{y,i+1}^{\\text{manuf}} - 2E_{y,i}^{\\text{manuf}} + E_{y,i-1}^{\\text{manuf}}}{\\Delta x^2} + k_0^2 s_x^2 E_{y,i}^{\\text{manuf}}\n$$\n此残差不为零的唯一原因是有限差分近似的截断误差。对于实现错误，残差表达式将基于错误实现的方程，从而导致一个大得多的值。\n\n归一化残差 $r$ 是残差向量 $\\vec{R} = (R_1, ..., R_{N-2})$ 的离散 $\\ell_2$-范数与在内部点上评估的制造场向量 $\\vec{E}^{\\text{manuf}} = (E_{y,1}^{\\text{manuf}}, ..., E_{y,N-2}^{\\text{manuf}})$ 的离散 $\\ell_2$-范数之比：\n$$\nr = \\frac{\\|\\vec{R}\\|_{\\ell_2}}{\\|\\vec{E}^{\\text{manuf}}\\|_{\\ell_2}} = \\frac{\\sqrt{\\sum_{i=1}^{N-2} |R_i|^2}}{\\sqrt{\\sum_{i=1}^{N-2} |E_{y,i}^{\\text{manuf}}|^2}}\n$$\n\n**3. 测试用例分析**\n\n设 $s_x^{\\text{target}} = 1 - 0.2j$。制造解始终为 $E_y(x) = E_0\\exp(-j k_0 s_x^{\\text{target}} x)$。不失一般性，我们设 $E_0=1$。\n\n- **测试1和2（UAPML，正确）：** 使用正确的离散方程和 $N=201$ 及 $N=21$ 计算残差。该残差仅反映离散化误差。由于中心差分格式是二阶精确的，误差与 $\\Delta x^2$ 成正比。$N=21$ 的网格（$\\Delta x = 1/20$）比 $N=201$ 的网格（$\\Delta x = 1/200$）粗10倍，因此我们预计测试2的残差大约是测试1的 $10^2=100$ 倍。\n\n- **测试3（UAPML，错误）：** 残差是针对一个实现中的错误计算的，其中假设控制方程为 $\\frac{d^2E_y}{dx^2} + k_0^2 s_x E_y = 0$。将制造解（它求解的是正确的方程）代入这个不正确的离散形式。产生的残差主要由模型误差项 $k_0^2(s_x-s_x^2)E_y$ 主导，该项在 $\\Delta x \\to 0$ 时不会消失。此残差应比测试1中的离散化误差大几个数量级。\n\n- **测试4（CPML，正确）：** 拉伸因子由其CPML参数组装而成：$s_x = \\kappa_x + \\frac{\\sigma_x}{j\\omega\\epsilon_0} + \\frac{\\alpha_x}{j\\omega}$。当 $\\kappa_x=1.0$，$\\alpha_x=0.0$ 且 $\\sigma_x = 0.2\\omega\\epsilon_0$ 时，我们得到 $s_x = 1.0 + \\frac{0.2\\omega\\epsilon_0}{j\\omega\\epsilon_0} = 1.0 - 0.2j = s_x^{\\text{target}}$。由于这与UAPML情况相同，并且在相同的网格上使用了相同的正确控制方程，其结果必须与测试1的结果相同。\n\n- **测试5（CPML，错误）：** 由于电导率项的分母中缺少 $\\epsilon_0$，组装了一个不正确的拉伸因子 $s_x^{\\text{wrong}} = \\kappa_x + \\frac{\\sigma_x}{j\\omega} = 1 - j(0.2\\epsilon_0)$。将基于 $s_x^{\\text{target}}$ 的制造解代入使用 $(s_x^{\\text{wrong}})^2$ 的离散方程中。$s_x^{\\text{wrong}}$ 和 $s_x^{\\text{target}}$ 之间的不匹配将产生一个巨大的残差，主要由实现误差项 $k_0^2((s_x^{\\text{wrong}})^2 - (s_x^{\\text{target}})^2)E_y$ 主导。该残差将显著大于离散化误差。\n\n**4. 数值实现**\n\n通过实现所述的残差计算，对每个测试用例进行计算。物理常数按规定使用国际单位制（SI）单位。计算并报告五个测试用例的归一化残差的最终值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes normalized residuals for five test cases related to PML implementations.\n    \"\"\"\n    # Define physical and numerical constants in SI units\n    MU_0 = 4 * np.pi * 1e-7\n    EPS_0 = 8.854187817e-12\n    FREQ = 1.0e9\n    OMEGA = 2 * np.pi * FREQ\n    K0 = OMEGA * np.sqrt(MU_0 * EPS_0)\n    L = 1.0\n\n    # The target stretch factor for the manufactured solution\n    S_X_TARGET = 1.0 - 0.2j\n\n    def compute_normalized_residual(N, s_x_manuf, s_x_pde, pde_s_power):\n        \"\"\"\n        Computes the normalized residual for a given set of parameters.\n        \n        Args:\n            N (int): Number of grid points.\n            s_x_manuf (complex): Stretch factor for the manufactured solution.\n            s_x_pde (complex): Stretch factor in the discretized PDE.\n            pde_s_power (int): Power of s_x_pde in the PDE.\n        \"\"\"\n        # 1. Define the grid\n        delta_x = L / (N - 1)\n        x = np.linspace(0, L, N, dtype=np.float64)\n\n        # 2. Generate manufactured solution on the grid: E_y(x) = exp(-j*k0*s_x_manuf*x)\n        E_manuf = np.exp(-1j * K0 * s_x_manuf * x)\n\n        # 3. Discretize the PDE to calculate the residual at interior points\n        # The PDE is: d^2(E)/dx^2 + k0^2 * (s_x_pde)^pde_s_power * E = 0\n        \n        # Interior points (indices 1 to N-2)\n        interior_indices = slice(1, -1)\n        E_manuf_interior = E_manuf[interior_indices]\n\n        # Central difference approximation of d^2(E)/dx^2\n        D2_E_manuf = (E_manuf[2:] - 2 * E_manuf[interior_indices] + E_manuf[:-2]) / (delta_x**2)\n        \n        # Residual vector\n        residual_vector = D2_E_manuf + (K0**2) * (s_x_pde**pde_s_power) * E_manuf_interior\n        \n        # 4. Compute the normalized l2-norm of the residual\n        norm_residual = np.linalg.norm(residual_vector)\n        norm_field = np.linalg.norm(E_manuf_interior)\n        \n        if norm_field == 0:\n            return 0.0\n        \n        return norm_residual / norm_field\n\n    results = []\n\n    # Test 1: UAPML, correct, fine grid (N=201)\n    r1 = compute_normalized_residual(N=201, s_x_manuf=S_X_TARGET, s_x_pde=S_X_TARGET, pde_s_power=2)\n    results.append(r1)\n\n    # Test 2: UAPML, correct, coarse grid (N=21)\n    r2 = compute_normalized_residual(N=21, s_x_manuf=S_X_TARGET, s_x_pde=S_X_TARGET, pde_s_power=2)\n    results.append(r2)\n\n    # Test 3: UAPML, implementation error (N=201)\n    r3 = compute_normalized_residual(N=201, s_x_manuf=S_X_TARGET, s_x_pde=S_X_TARGET, pde_s_power=1)\n    results.append(r3)\n    \n    # Test 4: CPML, correct assembly (N=201)\n    kappa_x = 1.0\n    alpha_x = 0.0\n    sigma_x = 0.2 * OMEGA * EPS_0\n    s_x_cpml = kappa_x + sigma_x / (1j * OMEGA * EPS_0) + alpha_x / (1j * OMEGA)\n    # This calculation is identical to Test 1, as s_x_cpml equals S_X_TARGET\n    r4 = compute_normalized_residual(N=201, s_x_manuf=s_x_cpml, s_x_pde=s_x_cpml, pde_s_power=2)\n    results.append(r4)\n\n    # Test 5: CPML, parameter scaling error (N=201)\n    # The PDE uses an incorrectly assembled s_x_wrong\n    s_x_wrong_cpml = kappa_x + sigma_x / (1j * OMEGA) # Missing EPS_0\n    r5 = compute_normalized_residual(N=201, s_x_manuf=S_X_TARGET, s_x_pde=s_x_wrong_cpml, pde_s_power=2)\n    results.append(r5)\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3358794"}]}