{"hands_on_practices": [{"introduction": "为了在计算机上模拟电磁波在极性介质（如水）中的传播，我们必须将描述其响应的连续物理模型转化为离散的数值算法。本练习将指导你运用辅助微分方程（ADE）方法，为 Debye 色散模型推导出一套适用于时域有限差分（FDTD）框架的更新方程。这个过程不仅是理论到实践的关键一步，更是构建稳定可靠数值模拟的基础技能。[@problem_id:3301054]", "problem": "考虑一个非磁性、各向同性的德拜电介质，其本构关系为 $\\,\\mathbf{D}(t)=\\epsilon_{0}\\,\\epsilon_{\\infty}\\,\\mathbf{E}(t)+\\mathbf{P}(t)\\,$，其中德拜极化强度 $\\,\\mathbf{P}(t)\\,$ 服从一阶常微分方程 $\\,\\tau\\,\\dot{\\mathbf{P}}(t)+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)\\,$，其中 $\\,\\tau0\\,$ 是弛豫时间，$\\,\\epsilon_{0}\\,$ 是真空介电常数，$\\,\\epsilon_{\\infty}\\,$ 是高频相对介电常数，且 $\\,\\Delta\\epsilon=\\epsilon_{s}-\\epsilon_{\\infty}0\\,$ 是静态增量。在嵌入时域有限差分 (FDTD) 方法的辅助微分方程 (ADE) 公式中，我们寻求一个在时间步长 $\\,\\Delta t\\,$ 上形式为 $\\,\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}\\,$ 的单步更新，其中上标表示离散的时间层级。从麦克斯韦方程组和德拜本构定律出发，通过在区间 $[t^{n},t^{n+1}]$ 上使用二阶中心时间离散化来离散化 $\\,\\tau\\,\\dot{\\mathbf{P}}+\\mathbf{P}=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}\\,$，从而推导基于 ADE 的 FDTD 极化更新：将 $\\,\\dot{\\mathbf{P}}\\,$ 替换为步长上的对称差分，并将非导数项用其在 $[t^{n},t^{n+1}]$ 上的算术平均值来近似。将得到的更新用 $\\,\\mathbf{P}^{n},\\mathbf{E}^{n},\\mathbf{E}^{n+1}\\,$ 和参数 $\\,\\tau,\\Delta t,\\epsilon_{0},\\Delta\\epsilon\\,$ 显式表示出来。\n\n然后，分析此更新的齐次部分（将电场驱动项设为零），以提取单步放大因子 $\\,z_{\\text{Debye}}\\,$，该因子是与连续德拜极点 $\\,s=-\\frac{1}{\\tau}\\,$ 对应的离散时间极点。利用你所应用的中心离散化的基本原理，给出一个关于比率 $\\,\\Delta t/\\tau\\,$ 的充分条件，使得映射后的离散德拜极点严格位于复平面的单位圆内。\n\n你最终报告的量必须是离散德拜极点 $\\,z_{\\text{Debye}}\\,$ 作为 $\\,\\Delta t\\,$ 和 $\\,\\tau\\,$ 函数的闭式解析表达式。最终报告的量中不要包含单位。无需四舍五入。", "solution": "在继续之前，对问题进行验证。\n\n### 第一步：提取已知条件\n- **本构关系**: 对于非磁性、各向同性的德拜电介质，$\\mathbf{D}(t)=\\epsilon_{0}\\,\\epsilon_{\\infty}\\,\\mathbf{E}(t)+\\mathbf{P}(t)$。\n- **极化常微分方程**: $\\tau\\,\\dot{\\mathbf{P}}(t)+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)$。\n- **参数**: $\\tau0$ (弛豫时间)，$\\epsilon_{0}$ (真空介电常数)，$\\epsilon_{\\infty}$ (高频相对介电常数)，以及 $\\Delta\\epsilon=\\epsilon_{s}-\\epsilon_{\\infty}0$ (静态增量)。\n- **目标更新形式**: 在时间步长 $\\Delta t$ 上的 $\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}$。\n- **离散化方法**: 在 $[t^{n},t^{n+1}]$ 上使用二阶中心时间离散化。$\\dot{\\mathbf{P}}$ 被对称差分替换，非导数项由其算术平均值近似。\n- **要求的分析**: 推导 $\\mathbf{P}^{n+1}$ 的更新方程，分析其齐次部分以找到离散德拜极点 $z_{\\text{Debye}}$，并为稳定性（$|z_{\\text{Debye}}|  1$）提供关于 $\\Delta t/\\tau$ 的充分条件。\n- **最终报告的量**: $z_{\\text{Debye}}$ 作为 $\\Delta t$ 和 $\\tau$ 的函数的闭式表达式。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**: 该问题在科学上是合理的。德拜模型是电介质弛豫的标准物理模型，而时域有限差分 (FDTD) 方法中的辅助微分方程 (ADE) 方法是计算电磁学中的一个经典课题。\n- **适定性**: 该问题是适定的。离散化的指令具体而明确，可以导出一个唯一的更新方程。后续的稳定性分析是一个标准的数学过程。\n- **客观性**: 问题以精确、客观的语言陈述，没有任何主观或推测性成分。\n- **结论**: 所有验证标准均已满足。该问题没有科学缺陷、歧义或矛盾。\n\n### 第三步：裁定与行动\n该问题是 **有效的**。将推导解答。\n\n控制德拜极化强度 $\\mathbf{P}(t)$ 的常微分方程如下：\n$$\n\\tau\\,\\frac{d\\mathbf{P}(t)}{dt}+\\mathbf{P}(t)=\\epsilon_{0}\\,\\Delta\\epsilon\\,\\mathbf{E}(t)\n$$\n问题要求在时间区间 $[t^n, t^{n+1}]$ 上使用二阶中心差分格式对该方程进行离散化。这通过在时间中点 $t^{n+1/2} = t^n + \\frac{\\Delta t}{2}$ 对该方程进行求值来实现。\n\n时间导数项 $\\dot{\\mathbf{P}}(t)$ 使用二阶精度的中心有限差分进行近似：\n$$\n\\frac{d\\mathbf{P}}{dt}\\bigg|_{t^{n+1/2}} \\approx \\frac{\\mathbf{P}^{n+1} - \\mathbf{P}^{n}}{\\Delta t}\n$$\n其中 $\\mathbf{P}^{k} \\equiv \\mathbf{P}(t^k)$ 且 $\\Delta t = t^{n+1} - t^n$。\n\n非导数项 $\\mathbf{P}(t)$ 和 $\\mathbf{E}(t)$ 通过它们在区间上的算术平均值来近似，这也是二阶精度的：\n$$\n\\mathbf{P}(t^{n+1/2}) \\approx \\frac{\\mathbf{P}^{n+1} + \\mathbf{P}^{n}}{2}\n$$\n$$\n\\mathbf{E}(t^{n+1/2}) \\approx \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^{n}}{2}\n$$\n\n将这些离散近似代入连续的极化常微分方程，得到：\n$$\n\\tau \\left( \\frac{\\mathbf{P}^{n+1} - \\mathbf{P}^{n}}{\\Delta t} \\right) + \\frac{\\mathbf{P}^{n+1} + \\mathbf{P}^{n}}{2} = \\epsilon_{0}\\,\\Delta\\epsilon \\left( \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^{n}}{2} \\right)\n$$\n为了得到 $\\mathbf{P}^{n+1}$ 的显式更新，我们重新整理方程，将包含 $\\mathbf{P}^{n+1}$ 的项收集到左侧，所有其他项放在右侧：\n$$\n\\mathbf{P}^{n+1} \\left( \\frac{\\tau}{\\Delta t} + \\frac{1}{2} \\right) = \\mathbf{P}^{n} \\left( \\frac{\\tau}{\\Delta t} - \\frac{1}{2} \\right) + \\frac{\\epsilon_{0}\\,\\Delta\\epsilon}{2} \\left( \\mathbf{E}^{n+1} + \\mathbf{E}^{n} \\right)\n$$\n现在，我们通过将整个方程乘以 $\\mathbf{P}^{n+1}$ 的系数的倒数来求解 $\\mathbf{P}^{n+1}$：\n$$\n\\mathbf{P}^{n+1} = \\frac{\\frac{\\tau}{\\Delta t} - \\frac{1}{2}}{\\frac{\\tau}{\\Delta t} + \\frac{1}{2}} \\mathbf{P}^{n} + \\frac{\\frac{\\epsilon_{0}\\,\\Delta\\epsilon}{2}}{\\frac{\\tau}{\\Delta t} + \\frac{1}{2}} \\left( \\mathbf{E}^{n+1} + \\mathbf{E}^{n} \\right)\n$$\n通过将分子和分母同乘以 $2\\Delta t$ 来简化系数：\n$\\mathbf{P}^n$ 的系数是：\n$$\n\\alpha = \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}\n$$\n电场项的系数是：\n$$\n\\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t}\n$$\n这给出了所要求的形式 $\\mathbf{P}^{n+1}=\\alpha\\,\\mathbf{P}^{n}+\\beta\\,\\mathbf{E}^{n+1}+\\gamma\\,\\mathbf{E}^{n}$ 的显式更新方程：\n$$\n\\mathbf{P}^{n+1} = \\left( \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{P}^{n} + \\left( \\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{E}^{n+1} + \\left( \\frac{\\epsilon_{0}\\,\\Delta\\epsilon\\,\\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{E}^{n}\n$$\n\n接下来，我们通过将驱动项设为零（即 $\\mathbf{E}^{n} = \\mathbf{E}^{n+1} = \\mathbf{0}$）来分析此更新方程的齐次部分。齐次递推关系为：\n$$\n\\mathbf{P}^{n+1} = \\left( \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right) \\mathbf{P}^{n}\n$$\n这是一个一阶线性递推关系。其解的形式为 $\\mathbf{P}^n = (\\text{常数}) \\cdot z^n$。单步放大因子 $z$ 是比率 $\\mathbf{P}^{n+1}/\\mathbf{P}^{n}$。这个因子就是与连续时间极点 $s = -1/\\tau$ 对应的离散时间极点 $z_{\\text{Debye}}$。从齐次方程中，我们可以直接确定这个极点：\n$$\nz_{\\text{Debye}} = \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}\n$$\n这就是所要求的离散德拜极点的表达式。\n\n最后，我们确定比率 $\\Delta t/\\tau$ 的一个充分条件，使得该极点严格位于单位圆内，即 $|z_{\\text{Debye}}|  1$。此条件确保了极化更新的数值稳定性。\n$$\n\\left| \\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t} \\right|  1\n$$\n鉴于 $\\tau  0$ 且时间步长 $\\Delta t  0$，分母 $2\\tau + \\Delta t$ 总是正的。因此，不等式简化为：\n$$\n|2\\tau - \\Delta t|  2\\tau + \\Delta t\n$$\n这个绝对值不等式等价于以下一对不等式：\n$$\n-(2\\tau + \\Delta t)  2\\tau - \\Delta t  2\\tau + \\Delta t\n$$\n我们分别分析每个不等式。\n1. 右侧不等式： $2\\tau - \\Delta t  2\\tau + \\Delta t \\implies -\\Delta t  \\Delta t \\implies 0  2\\Delta t$。这对于任何非零时间步长 $\\Delta t  0$ 都成立。\n2. 左侧不等式： $-(2\\tau + \\Delta t)  2\\tau - \\Delta t \\implies -2\\tau - \\Delta t  2\\tau - \\Delta t \\implies -2\\tau  2\\tau \\implies 0  4\\tau$。这是成立的，因为问题陈述中已指明 $\\tau  0$。\n\n对于任何有效的物理参数 $\\tau  0$ 和任何时间步长 $\\Delta t  0$，这两个不等式都成立。这意味着中心差分格式（等价于 Crank-Nicolson 方法或梯形法则）对于德拜模型是无条件稳定的。离散极点的模 $|z_{\\text{Debye}}|$ 总是严格小于 1。因此，任何规定 $\\Delta t/\\tau$ 为正且有限的条件都是稳定性的充分条件。例如，任何 $\\Delta t/\\tau  0$ 都是一个充分条件。\n\n问题要求的是离散德拜极点的闭式解析表达式，该表达式已被推导出。", "answer": "$$\n\\boxed{\\frac{2\\tau - \\Delta t}{2\\tau + \\Delta t}}\n$$", "id": "3301054"}, {"introduction": "与描述极性分子弛豫的 Debye 模型不同，Drude 模型描述了金属等材料中自由载流子的行为，这带来了独特的物理特性和数值挑战。本练习将引导你深入探究 Drude 模型的物理内涵，通过分析其在零频率处的数学奇点（极点），理解其与直流电导和数值模拟中长期漂移现象的深刻联系。这项实践重在概念的融会贯通，而非简单的公式推导。[@problem_id:3301026]", "problem": "一种均匀、线性、各向同性的介质包含一群自由电子，其数密度为 $n$，电荷为 $-e$，质量为 $m$，唯象阻尼率为 $\\gamma$。一个外加电场 $E(t)$ 根据带有线性阻力的牛顿第二定律驱动电子运动，其方程为 $m\\,\\frac{d^{2}x}{dt^{2}}+m\\,\\gamma\\,\\frac{dx}{dt}=-e\\,E(t)$。宏观电极化强度定义为 $P(t)=-n\\,e\\,x(t)$，电极化率 $\\chi(\\omega)$ 通过时间傅里叶变换定义为 $P(\\omega)=\\varepsilon_{0}\\,\\chi(\\omega)\\,E(\\omega)$，其中 $\\varepsilon_{0}$ 是真空介电常数。假设采用标准傅里叶变换约定，时间依赖关系为 $\\mathrm{e}^{-i\\omega t}$，并且 $\\gamma\\ge 0$。\n\n使用这些定义并仅依据基本定律，从第一性原理推断 Drude 对 $\\chi(\\omega)$ 的贡献的解析结构及其在时域中的意义。特别地，确定在原点 $\\omega=0$ 处是否以及如何出现极点，并阐明这对恒定（阶跃）电场的响应以及对诸如带辅助微分方程 (ADE) 的时域有限差分 (FDTD) 方法等时域数值实现意味着什么。\n\n选择所有正确的选项。\n\nA. 增加 Drude 贡献会在 $\\omega=0$ 处引入 $\\chi(\\omega)$ 的一个极点（对于 $\\gamma0$ 是单极点），这在频率响应中反映为一个与 $1/(i\\omega)$ 成正比的因子。在时域中，一个恒定的外加电场 $E(t)=E_{0}\\,u(t)$ 会产生一个极化电流 $J(t)=\\frac{dP}{dt}$，该电流渐近到一个非零常数，因此 $P(t)$ 在 $t$ 很大时线性增长。因此，ADE 更新必须根据初始场一致地设置初始色散状态变量以避免伪漂移；对电流 $J$ 而非极化强度 $P$ 进行演化可以减少累积误差。\n\nB. Drude 贡献在虚轴上或其附近没有极点，阶跃响应 $P(t)$ 对所有 $t$ 都保持有界，因此色散状态变量的初始化无关紧要；仅满足 Courant–Friedrichs–Lewy 时间步长条件就能防止数值漂移。\n\nC. Drude 项仅增加了一个高频共振；在 $\\omega=0$ 处，电极化率有一个零点而不是极点，因此没有直流传导。因此，一个稳定的实现应该在每个时间步强制将极化电流重置为零。\n\nD. 如果 $\\gamma\\ne 0$，$\\chi(\\omega)$ 在 $\\omega=0$ 处的极点会消失。任何观察到的长时间漂移纯粹是离散化伪影，通过减小时间步長即可消除，因此不需要特殊的初始化或公式更改。\n\nE. 缓解与原点极点相关的长时间漂移的一种实用方法是，引入一个非常小的恢复频率（将 Drude 项转变为共振频率 $\\omega_{0}$ 远小于感兴趣频带的低频 Lorentz 项），或者对 ADE 使用隐式梯形法则 (Crank–Nicolson) 离散化。这些方法将临界积分器移出单位圆，或使其被中性但鲁棒地积分；两者都能抑制漂移，尽管如果不小心处理，增加 $\\omega_{0}$ 会使真实的直流电导率产生偏差。\n\n只选择与上述第一性原理分析完全一致的陈述。这里 $u(t)$ 表示单位阶跃函数，所有其他符号均具有其在计算电磁学中的常规含义。", "solution": "出发点和频域电极化率。对于一个受到电场 $E(t)$ 和线性阻尼力作用的单个自由电子，牛顿第二定律给出\n$$\nm\\,\\frac{d^{2}x}{dt^{2}}+m\\,\\gamma\\,\\frac{dx}{dt}=-e\\,E(t).\n$$\n极化强度为 $P(t)=-n\\,e\\,x(t)$，其中 $n$ 是电子数密度。使用约定 $\\mathrm{e}^{-i\\omega t}$ 进行时间傅里叶变换，我们得到\n$$\n-m\\,\\omega^{2}\\,x(\\omega)-i\\,m\\,\\gamma\\,\\omega\\,x(\\omega)=-e\\,E(\\omega),\n$$\n所以\n$$\nx(\\omega)=\\frac{e}{m}\\,\\frac{1}{\\omega^{2}+i\\gamma\\omega}\\,E(\\omega).\n$$\n因此，\n$$\nP(\\omega)=-n\\,e\\,x(\\omega)=-\\frac{n\\,e^{2}}{m}\\,\\frac{1}{\\omega^{2}+i\\gamma\\omega}\\,E(\\omega).\n$$\n定义等离子体频率为 $\\omega_{p}^{2}=\\dfrac{n\\,e^{2}}{\\varepsilon_{0}\\,m}$ 和电极化率为 $P(\\omega)=\\varepsilon_{0}\\,\\chi(\\omega)\\,E(\\omega)$，得到 Drude 电极化率\n$$\n\\chi(\\omega)=-\\frac{\\omega_{p}^{2}}{\\omega^{2}+i\\gamma\\omega}=-\\frac{\\omega_{p}^{2}}{\\omega\\,(\\omega+i\\gamma)}.\n$$\n解析结构和原点处的极点。分母可分解为 $\\omega(\\omega+i\\gamma)$。因此，对于任何 $\\gamma\\ge 0$，在 $\\omega=0$ 处都有一个极点。如果 $\\gamma0$，在 $\\omega=0$ 处的极点是单极点，并且在下半平面的 $\\omega=-i\\gamma$ 处有第二个单极点，这与因果律一致。如果 $\\gamma=0$，电极化率表现为 $-\\omega_{p}^{2}/\\omega^{2}$，并在 $\\omega=0$ 处呈现一个二阶极点。原点处的极点意味着在频率响应中存在一个与 $1/(i\\omega)$ 成正比的因子，这在时域中对应于对时间的积分。\n\n时域意义和阶跃响应。考虑用 $P(t)$ 表示的时域常微分方程是有启发性的。使用 $P(t)=-n\\,e\\,x(t)$，运动方程变为\n$$\n\\frac{d^{2}P}{dt^{2}}+\\gamma\\,\\frac{dP}{dt}=\\varepsilon_{0}\\,\\omega_{p}^{2}\\,E(t).\n$$\n令 $J(t)=\\dfrac{dP}{dt}$ 表示极化电流。微分得到关于 $J$ 的一阶方程：\n$$\n\\frac{dJ}{dt}+\\gamma\\,J=\\varepsilon_{0}\\,\\omega_{p}^{2}\\,E(t).\n$$\n对于一个在 $t=0$ 时施加的阶跃电场 $E(t)=E_{0}\\,u(t)$，且初始条件为 $J(0)=J_{0}$，解为\n$$\nJ(t)=J_{0}\\,e^{-\\gamma t}+\\frac{\\varepsilon_{0}\\,\\omega_{p}^{2}\\,E_{0}}{\\gamma}\\,\\bigl(1-e^{-\\gamma t}\\bigr).\n$$\n当 $t\\to\\infty$ 时，对于 $\\gamma0$，$J(t)\\to \\dfrac{\\varepsilon_{0}\\,\\omega_{p}^{2}}{\\gamma}\\,E_{0}$。这是一个非零的恒定电流密度，与直流电导率 $\\sigma_{0}=\\dfrac{\\varepsilon_{0}\\,\\omega_{p}^{2}}{\\gamma}$ 一致。因为 $P(t)=\\int_{0}^{t}J(\\tau)\\,d\\tau+P(0)$，所以在 $t$ 很大时，极化强度以斜率 $\\dfrac{\\varepsilon_{0}\\,\\omega_{p}^{2}}{\\gamma}\\,E_{0}$ 线性增长：\n$$\nP(t)=P(0)+\\frac{\\varepsilon_{0}\\,\\omega_{p}^{2}\\,E_{0}}{\\gamma}\\,t+\\text{暂态项}.\n$$\n这种长期增长是 $\\omega=0$ 处极点的时域表现。\n\n对时域数值格式的意义。在带辅助微分方程 (ADE) 的时域有限差分 (FDTD) 方法中，人们通过演化额外的状态变量来表示材料色散。关于 $J(t)$ 的方程，\n$$\n\\frac{dJ}{dt}+\\gamma\\,J=\\varepsilon_{0}\\,\\omega_{p}^{2}\\,E(t),\n$$\n在 $\\omega=0$ 处包含一个临界积分模式（传递函数中有一个因子 $1/(i\\omega)$）。在显式蛙跳离散化中，这表现为离散时间 $z$ 平面中单位圆上或非常靠近单位圆的一个状态。结果是：\n- 如果 $J$ 的初始条件与初始场 $E$ 不一致（例如，选择的 $J(0)$ 未反映任何直流偏置），即使在没有外部激励的情况下，该格式也可能在 $P$ 中表现出长时间漂移或长期累积。\n- 直接存储和更新 $P$ 会由于隐式的时间积分而加剧舍入误差和截断误差的累积。转而演化 $J$ 可以避免显式的累积步骤并减少漂移。\n- 缓解措施包括：基于初始 $E$ 对 $J$ 进行一致的初始化，以及采用数值上鲁棒的时间积分方法，如梯形法则 (Crank–Nicolson)，该方法对线性系统是 A-稳定的，并能抑制与临界模式相关的伪增长。另一种缓解措施是通过增加一个小的恢复频率 $\\omega_{0}$ 来正则化模型，将 Drude 项转变为 Lorentz 项；这会移除原点极点并消除 $P$ 的长期增长，但代价是改变了真实的直流行为，除非进行补偿。\n\n逐项分析。\n\nA. 正确。推导出的电极化率 $\\chi(\\omega)=-\\dfrac{\\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)}$ 在 $\\omega=0$ 处有一个极点（对于 $\\gamma0$ 是单极点）。在时域中，阶跃响应显示 $J(t)\\to \\dfrac{\\varepsilon_{0}\\,\\omega_{p}^{2}}{\\gamma}\\,E_{0}$ 并且 $P(t)$ 在 $t$ 很大时线性增长。积分器的存在意味着 ADE 格式必须一致地初始化状态变量；演化 $J$ 而不是 $P$ 可以减少累积误差。\n\nB. 不正确。在 $\\omega=0$ 处明确存在一个极点；$P(t)$ 的阶跃响应是无界的（线性增长），正确的初始化很重要。Courant–Friedrichs–Lewy 条件解决的是电磁场更新的稳定性问题，而不是消除由临界积分本构子系统引起的漂移。\n\nC. 不正确。Drude 项是自由载流子的贡献，没有恢复力；它不增加高频共振，并且在 $\\omega=0$ 处电极化率有一个极点，而不是零点。在每个步骤强制将 $J$ 重置为零与直流传导的物理原理相矛盾，只会隐藏或扭曲材料响应。\n\nD. 不正确。对于 $\\gamma\\ne 0$，在 $\\omega=0$ 处的二阶极点降为单极点，但并未消失。减小时间步长并不能移除积分器；它只减少每一步的截断误差。如果没有正确的初始化或鲁棒的积分格式，长时间漂移仍然会存在。\n\nE. 正确。增加一个小的恢复频率 $\\omega_{0}$ 将 Drude 项转换为 Lorentz 项，将极点从 $\\omega=0$ 移到 $\\omega=\\pm\\omega_{0}$（并且，在有阻尼的情况下，移入下半平面），从而消除了 $P$ 的长期增长，但也改变了真实的直流行为，除非进行补偿。对 ADE 使用隐式梯形法则 (Crank–Nicolson) 离散化是 A-稳定的，并且在处理临界模式时不会引入人为的阻尼或增长，从而在保持底层连续时间积分器行为的同时抑制了由数值误差引起的漂移。\n\n因此，正确的选项是 A 和 E。", "answer": "$$\\boxed{AE}$$", "id": "3301026"}, {"introduction": "Lorentz 模型是描述材料色散现象最通用的模型之一，能够精确刻画共振吸收效应。然而，一个有效的数值模拟不仅要准确，还必须遵守能量守恒等基本物理定律。本项编程实践要求你亲自实现 Lorentz 模型，并设计一个基于能量的“无源性”测试，以验证你的模拟不会凭空产生能量，从而深刻理解不同数值方法在保持物理真实性上的优劣。[@problem_id:3301071]", "problem": "考虑一个线性、均匀、各向同性的色散介质，其电位移场满足 $ \\mathbf{D}(t) = \\varepsilon_0 \\mathbf{E}(t) + \\mathbf{P}(t) $，其中 $ \\varepsilon_0 $ 是真空介电常数，$ \\mathbf{P}(t) $ 是极化强度。在单共振洛伦兹模型中，极化强度遵循以下常微分方程\n$$\n\\frac{\\mathrm{d}^2 \\mathbf{P}}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} \\mathbf{P}}{\\mathrm{d} t} + \\omega_0^2 \\mathbf{P} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}(t),\n$$\n其中 $ \\gamma \\ge 0 $ 是阻尼率（单位为 $ \\mathrm{s}^{-1} $），$ \\omega_0  0 $ 是共振角频率（单位为 $ \\mathrm{rad/s} $），$ \\omega_p  0 $ 是等离子体角频率（单位为 $ \\mathrm{rad/s} $）。假设 $ \\mathbf{E}(t) $ 和 $ \\mathbf{P}(t) $ 共线，因此点积简化为大小的标量积；将标量电场表示为 $ E(t) $，极化强度表示为 $ P(t) $。\n\n从洛伦兹极化方程和本构关系出发，推导一个能量平衡关系，用以表示电场对极化强度做功的速率，\n$$\nW(t) = E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t},\n$$\n并用储存的内能密度 $ U(t) $ 和一个非负耗散项来表达。仅使用基本定律和核心定义来构建此能量关系；不要引用任何预先推导的快捷公式。基于此能量关系，定义一个基于能量的测试，用以验证对于由指定 $ E(t) $ 在有限区间 $ [0, T] $ 上驱动、且初始极化强度和速度为零的任何数值计算的极化强度 $ P(t) $，当模型参数满足无源性（$ \\gamma \\ge 0 $，$ \\omega_0  0 $，$ \\omega_p  0 $）且数值格式是能量一致的时，总耗散能量密度\n$$\nP_{\\text{loss}} = \\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t\n$$\n永远不为负。您的测试必须明确计算以焦耳每立方米（J/m$^3$）为单位的 $ P_{\\text{loss} } $，并标记任何因离散化引起的、在明确定义的数值容差范围内 $P_{\\text{loss}}  0$ 的违规情况。\n\n构建一个完整的可运行程序算法，以实现以下功能：\n- 使用两种不同的时间步进格式，对一阶状态空间形式 $ \\dot{x}_1 = x_2 $, $ \\dot{x}_2 = -\\gamma x_2 - \\omega_0^2 x_1 + \\varepsilon_0 \\omega_p^2 E(t) $（其中 $ x_1 = P $，$ x_2 = \\dot{P} $）进行洛伦兹极化动力学模拟：\n    1. Crank–Nicolson (CN) 方法，这是一种二阶精度且在时间上是梯形的格式。\n    2. 前向欧拉法，这是一种一阶显式格式。\n- 使用梯形法则计算积分 $ \\int_0^T E(t)\\,\\dot{P}(t)\\,\\mathrm{d}t $ 以得到 $ P_{\\text{loss}} $。\n- 当数值计算的 $ P_{\\text{loss}} $ 小于容差变为负值时，检测并报告由离散化引起的违规。违规判据定义如下：计算一个尺度 $ S = \\varepsilon_0 E_0^2 T $，其中 $ E_0 $ 是 $ E(t) $ 的峰值大小，$ T $ 是模拟持续时间，并将容差设为 $ \\tau = 10^{-6} S $，当 $ E_0 = 0 $ 时 $ \\tau = 10^{-12} $。如果 $P_{\\text{loss}}  -\\tau$，则声明为违规。\n\n使用以下测试套件，它涵盖了一个典型情况、一个容易出现离散化问题的粗时间步长情况、一个零场边界情况以及一个无阻尼边界情况。所有量都必须在国际单位制（SI）中处理，计算出的 $ P_{\\text{loss}} $ 必须以焦耳每立方米（J/m$^3$）为单位。\n\n设 $ \\varepsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $，$ \\omega_0 = 2\\pi\\times 100\\times 10^9 \\ \\mathrm{rad/s} $，$ \\omega_p = 2\\pi\\times 200\\times 10^9 \\ \\mathrm{rad/s} $。对于每种情况，使用指定的 $ \\gamma $ 和标量驱动场\n$$\nE(t) = E_0 \\sin(\\omega_c t)\\,\\exp\\!\\left(-\\left(\\frac{t - T/2}{\\sigma}\\right)^2\\right),\n$$\n零场情况除外，此时 $ E(t) \\equiv 0 $。对于 $ \\omega_c t $，角度单位是弧度。\n\n测试套件：\n- 情况 A（能量一致性基准）：CN 方法，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0.05\\,\\omega_0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = 0.9\\,\\omega_0 $，$ \\sigma = T/6 $。\n- 情况 B（粗步长，显式格式）：前向欧拉法，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 1.0\\times 10^{-10} \\ \\mathrm{s} $，$ \\gamma = 0.001\\,\\omega_0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = \\omega_0 $，$ \\sigma = T/6 $。\n- 情况 C（零场边界情况）：CN 方法，$ T = 1.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 5.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0.05\\,\\omega_0 $，$ E_0 = 0 $，$ \\omega_c $ 未使用，$ \\sigma $ 未使用。\n- 情况 D（无阻尼边界情况）：CN 方法，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = \\omega_0 $，$ \\sigma = T/4 $。\n\n您的程序必须：\n1. 对每种情况，使用初始条件 $ P(0) = 0 $，$ \\dot{P}(0) = 0 $ 对洛伦兹方程进行数值积分。\n2. 在 $ [0, T] $ 区间上对 $ E(t)\\,\\dot{P}(t) $ 应用梯形法则，计算以 J/m$^3$ 为单位的 $ P_{\\text{loss}} $。\n3. 使用指定的容差规则确定是否发生违规。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，输出一个双元素列表 $[P_{\\text{loss}}, \\text{violation}]$，其中 $P_{\\text{loss}}$ 是一个以 J/m$^3$ 为单位的浮点数，$\\text{violation}$ 是一个布尔值。例如，最后一行必须看起来像\n[[P_{\\text{loss,A}},True/False],[P_{\\text{loss,B}},True/False],[P_{\\text{loss,C}},True/False],[P_{\\text{loss,D}},True/False]]\n并且实际程序输出中没有空格。", "solution": "该问题要求推导电介质极化的单共振洛伦兹模型的能量平衡，并实现一个数值测试来验证两种不同时间步进格式的能量一致性。\n\n首先，我们验证问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **本构关系：** $ \\mathbf{D}(t) = \\varepsilon_0 \\mathbf{E}(t) + \\mathbf{P}(t) $\n- **洛伦兹极化常微分方程：** $ \\frac{\\mathrm{d}^2 \\mathbf{P}}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} \\mathbf{P}}{\\mathrm{d} t} + \\omega_0^2 \\mathbf{P} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}(t) $\n- **标量假设：** $ E(t) $ 和 $ P(t) $ 是标量大小。\n- **参数：** 阻尼率 $ \\gamma \\ge 0 $，共振角频率 $ \\omega_0  0 $，等离子体角频率 $ \\omega_p  0 $。\n- **做功速率定义：** $ W(t) = E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t} $\n- **总耗散能量：** $ P_{\\text{loss}} = \\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t $\n- **初始条件：** $ P(0) = 0 $，$ \\dot{P}(0) = 0 $。\n- **状态空间形式：** $ \\dot{x}_1 = x_2 $, $ \\dot{x}_2 = -\\gamma x_2 - \\omega_0^2 x_1 + \\varepsilon_0 \\omega_p^2 E(t) $，其中 $ x_1 = P, x_2 = \\dot{P} $。\n- **数值格式：** Crank–Nicolson (CN) 和前向欧拉 (FE)。\n- **$P_{\\text{loss}}$ 的积分方法：** 梯形法则。\n- **违规判据：** 如果 $P_{\\text{loss}}  -\\tau$ 则为违规，其中容差 $ \\tau $ 由 $ \\tau = 10^{-6} S $ 定义，$ S = \\varepsilon_0 E_0^2 T $，当 $ E_0 = 0 $ 时 $ \\tau = 10^{-12} $。\n- **常数：** $ \\varepsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $，$ \\omega_0 = 2\\pi\\times 100\\times 10^9 \\ \\mathrm{rad/s} $，$ \\omega_p = 2\\pi\\times 200\\times 10^9 \\ \\mathrm{rad/s} $。\n- **驱动场：** $ E(t) = E_0 \\sin(\\omega_c t)\\,\\exp(-\\left(\\frac{t - T/2}{\\sigma}\\right)^2) $，除非 $ E_0 = 0 $。\n- **测试套件：**\n    - 情况 A: CN，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0.05\\,\\omega_0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = 0.9\\,\\omega_0 $，$ \\sigma = T/6 $。\n    - 情况 B: FE，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 1.0\\times 10^{-10} \\ \\mathrm{s} $，$ \\gamma = 0.001\\,\\omega_0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = \\omega_0 $，$ \\sigma = T/6 $。\n    - 情况 C: CN，$ T = 1.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 5.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0.05\\,\\omega_0 $，$ E_0 = 0 $。\n    - 情况 D: CN，$ T = 2.0\\times 10^{-9} \\ \\mathrm{s} $，$ \\Delta t = 2.0\\times 10^{-12} \\ \\mathrm{s} $，$ \\gamma = 0 $，$ E_0 = 1.0\\times 10^{5} \\ \\mathrm{V/m} $，$ \\omega_c = \\omega_0 $，$ \\sigma = T/4 $。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了电介质色散的标准单共振洛伦兹模型，这是经典光学和电磁学的基石。其控制方程是一个被充分理解的二阶线性常微分方程（ODE）。功、储存能量和耗散的概念在物理学中是基础性的。该任务涉及从第一性原理推导能量平衡，这是一个标准流程。指定的前向欧拉法和 Crank-Nicolson 方法是求解常微分方程的典型格式。该问题是适定的：它提供了一个明确定义的初值问题，包含了所有必要的参数、初始条件、常数以及驱动项的具体函数形式。语言客观而精确。违规判据的定义清晰明确。问题是自洽且内部一致的。这是计算物理学中一个不平凡的练习，它测试了对物理模型以及用于模拟它的数值方法属性的理解。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行求解。\n\n### 能量平衡的推导\n\n分析从洛伦兹极化方程的标量形式开始：\n$$\n\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t) = \\varepsilon_0 \\omega_p^2 E(t)\n$$\n电场对单位体积的极化介质做功的速率由 $ W(t) = E(t) \\frac{\\mathrm{d}P}{\\mathrm{d}t} $ 给出。为推导能量平衡，我们首先从洛伦兹方程中解出 $ E(t) $：\n$$\nE(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t)\\right)\n$$\n将此表达式代入做功速率方程，得到：\n$$\nW(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2} + \\gamma \\frac{\\mathrm{d} P}{\\mathrm{d} t} + \\omega_0^2 P(t)\\right) \\frac{\\mathrm{d} P}{\\mathrm{d} t}\n$$\n分配项 $ \\frac{\\mathrm{d}P}{\\mathrm{d}t} $：\n$$\nW(t) = \\frac{1}{\\varepsilon_0 \\omega_p^2} \\left[ \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right) \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2}\\right) + \\omega_0^2 P(t) \\frac{\\mathrm{d} P}{\\mathrm{d} t} \\right] + \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2\n$$\n我们注意到方括号中的项是二次型的导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} t} \\left( \\frac{1}{2} \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 \\right) = \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right) \\left(\\frac{\\mathrm{d}^2 P}{\\mathrm{d} t^2}\\right) \\quad \\text{and} \\quad \\frac{\\mathrm{d}}{\\mathrm{d} t} \\left( \\frac{1}{2}\\omega_0^2 P(t)^2 \\right) = \\omega_0^2 P(t) \\frac{\\mathrm{d} P}{\\mathrm{d} t}\n$$\n这使我们可以将做功速率方程写为：\n$$\nE(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t} = \\frac{\\mathrm{d}}{\\mathrm{d} t} \\left[ \\frac{1}{2\\varepsilon_0 \\omega_p^2} \\left( \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 + \\omega_0^2 P(t)^2 \\right) \\right] + \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2\n$$\n此方程即为所求的能量平衡关系。它表明，场做的功的速率 $ W(t) $ 等于储存的内能密度的变化率 $ \\frac{\\mathrm{d}U}{\\mathrm{d}t} $ 加上能量耗散的速率 $ Q_{\\text{diss}}(t) $。各项可识别为：\n- 储存的内能密度：$ U(t) = \\frac{1}{2\\varepsilon_0 \\omega_p^2} \\left( \\left(\\frac{\\mathrm{d}P}{\\mathrm{d}t}\\right)^2 + \\omega_0^2 P(t)^2 \\right) $。它包含与束缚电荷振子相关的动能项（与 $ (\\dot{P})^2 $ 成正比）和势能项（与 $ P^2 $ 成正比）。\n- 功率耗散密度：$ Q_{\\text{diss}}(t) = \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2 $。由于参数 $ \\gamma $ 和 $ \\varepsilon_0 \\omega_p^2 $ 是非负的，且 $ (\\dot{P})^2 \\geq 0 $，耗散率总是非负的，这与热力学第二定律一致。\n\n### 基于能量的无源性测试\n\n为求出在区间 $ [0, T] $ 内从场传递到介质的总能量，我们对能量平衡方程进行积分：\n$$\n\\int_{0}^{T} E(t)\\,\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\,\\mathrm{d}t = \\int_{0}^{T} \\frac{\\mathrm{d}U}{\\mathrm{d}t}\\,\\mathrm{d}t + \\int_{0}^{T} \\frac{\\gamma}{\\varepsilon_0 \\omega_p^2} \\left(\\frac{\\mathrm{d} P}{\\mathrm{d} t}\\right)^2 \\,\\mathrm{d}t\n$$\n左边是量 $ P_{\\text{loss}} $。右边的第一项是 $ U(T) - U(0) $。因此，\n$$\nP_{\\text{loss}} = U(T) - U(0) + \\int_{0}^{T} Q_{\\text{diss}}(t) \\,\\mathrm{d}t\n$$\n给定初始条件 $ P(0) = 0 $ 和 $ \\dot{P}(0) = 0 $，初始储存能量 $ U(0) $ 为零。方程简化为：\n$$\nP_{\\text{loss}} = U(T) + \\int_{0}^{T} Q_{\\text{diss}}(t) \\,\\mathrm{d}t\n$$\n由于对于所有 $ t $，$ U(t) $ 和 $ Q_{\\text{diss}}(t) $ 都是非负的，总传递能量 $ P_{\\text{loss}} $ 必须是非负的。如果一个数值格式能保持这一性质，则它是能量一致的。任何计算出的 $ P_{\\text{loss}}  0 $（超出微小的数值容差）都表明离散化格式产生了非物理的人为能量，从而违背了无源性。\n\n### 数值算法设计\n\n这个二阶常微分方程被转换为一个由两个一阶常微分方程组成的系统。设状态向量为 $ \\mathbf{x}(t) = [x_1(t), x_2(t)]^T = [P(t), \\dot{P}(t)]^T $。该系统为：\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{A} \\mathbf{x}(t) + \\mathbf{b} E(t), \\quad \\text{where} \\quad \\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -\\omega_0^2  -\\gamma \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 0 \\\\ \\varepsilon_0 \\omega_p^2 \\end{pmatrix}\n$$\n\n**1. 前向欧拉（FE）法：** 这是一种显式、一阶方法。给定 $ \\mathbf{x}^n \\approx \\mathbf{x}(n\\Delta t) $，下一个状态为：\n$$\n\\mathbf{x}^{n+1} = \\mathbf{x}^n + \\Delta t (\\mathbf{A} \\mathbf{x}^n + \\mathbf{b} E(t_n)) = (\\mathbf{I} + \\Delta t \\mathbf{A}) \\mathbf{x}^n + \\Delta t \\mathbf{b} E(t_n)\n$$\n其中 $ \\mathbf{I} $ 是 $ 2 \\times 2 $ 的单位矩阵。该格式只是条件稳定的。对于振荡系统，稳定性通常要求 $ \\omega_0 \\Delta t \\ll 1 $。在情况 B 中，$ \\omega_0 \\Delta t \\approx 6.28 \\times 10^{11} \\times 10^{-10} \\approx 62.8 $，严重违反了稳定性条件。预计这将导致数值不稳定和无源性测试失败。\n\n**2. Crank-Nicolson (CN) 方法：** 这是一种基于梯形法则的隐式、二阶方法：\n$$\n\\frac{\\mathbf{x}^{n+1} - \\mathbf{x}^n}{\\Delta t} = \\frac{1}{2} \\left[ (\\mathbf{A} \\mathbf{x}^n + \\mathbf{b} E(t_n)) + (\\mathbf{A} \\mathbf{x}^{n+1} + \\mathbf{b} E(t_{n+1})) \\right]\n$$\n重新整理以求解 $ \\mathbf{x}^{n+1} $ 会得到一个线性系统：\n$$\n\\left(\\mathbf{I} - \\frac{\\Delta t}{2} \\mathbf{A}\\right) \\mathbf{x}^{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2} \\mathbf{A}\\right) \\mathbf{x}^n + \\frac{\\Delta t}{2} \\mathbf{b} (E(t_n) + E(t_{n+1}))\n$$\n对于此线性系统，CN 方法是无条件稳定的，并且已知对于保守系统（即当 $ \\gamma=0 $ 时）是能量守恒的。预计在指定条件下它将通过无源性测试。\n\n**$P_{\\text{loss}}$ 的计算：** 在数值计算出 $ P(t_n) $ 和 $ \\dot{P}(t_n) $ 从 $ n=0 $ 到 $ N=T/\\Delta t $ 的时间序列后，我们计算被积函数 $ W_n = E(t_n)\\dot{P}(t_n) $。然后使用梯形法则近似该积分：\n$$\nP_{\\text{loss}} = \\int_0^T W(t)\\,\\mathrm{d}t \\approx \\sum_{n=0}^{N-1} \\frac{\\Delta t}{2}(W_n + W_{n+1})\n$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation and analysis\n    for the specified test cases.\n    \"\"\"\n    # Define physical constants\n    EPS0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    W0 = 2 * np.pi * 100e9   # Resonance angular frequency in rad/s\n    WP = 2 * np.pi * 200e9   # Plasma angular frequency in rad/s\n\n    # Define the test suite\n    test_cases = [\n        # Case A: CN, well-resolved, should pass\n        {\n            \"name\": \"A\", \"method\": \"CN\", \"T\": 2.0e-9, \"dt\": 2.0e-12,\n            \"gamma_factor\": 0.05, \"E0\": 1.0e5, \"wc_factor\": 0.9, \"sigma_factor\": 1/6\n        },\n        # Case B: FE, coarse step, should fail (unstable)\n        {\n            \"name\": \"B\", \"method\": \"FE\", \"T\": 2.0e-9, \"dt\": 1.0e-10,\n            \"gamma_factor\": 0.001, \"E0\": 1.0e5, \"wc_factor\": 1.0, \"sigma_factor\": 1/6\n        },\n        # Case C: CN, zero field, should yield zero loss\n        {\n            \"name\": \"C\", \"method\": \"CN\", \"T\": 1.0e-9, \"dt\": 5.0e-12,\n            \"gamma_factor\": 0.05, \"E0\": 0.0, \"wc_factor\": 1.0, \"sigma_factor\": 1/6\n        },\n        # Case D: CN, no damping, should pass (energy-conserving)\n        {\n            \"name\": \"D\", \"method\": \"CN\", \"T\": 2.0e-9, \"dt\": 2.0e-12,\n            \"gamma_factor\": 0.0, \"E0\": 1.0e5, \"wc_factor\": 1.0, \"sigma_factor\": 1/4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        method = case[\"method\"]\n        T, dt = case[\"T\"], case[\"dt\"]\n        E0 = case[\"E0\"]\n        gamma = case[\"gamma_factor\"] * W0\n        wc = case[\"wc_factor\"] * W0\n        sigma = case[\"sigma_factor\"] * T\n\n        # Time grid\n        num_steps = int(round(T / dt))\n        t = np.linspace(0, T, num_steps + 1)\n\n        # Driving electric field\n        if E0 == 0:\n            E = np.zeros_like(t)\n        else:\n            E = E0 * np.sin(wc * t) * np.exp(-((t - T / 2) / sigma)**2)\n\n        # System matrices\n        A = np.array([[0, 1], [-W0**2, -gamma]])\n        b = np.array([0, EPS0 * WP**2])\n\n        # State vector initialization (X[0,:]=P, X[1,:]=P_dot)\n        X = np.zeros((2, num_steps + 1))\n        X[:, 0] = [0, 0] # Initial conditions P(0)=0, P_dot(0)=0\n\n        # Time stepping loop\n        if method == 'CN':\n            I = np.identity(2)\n            ML = I - 0.5 * dt * A\n            MR = I + 0.5 * dt * A\n            inv_ML = np.linalg.inv(ML)\n            update_mat_X = inv_ML @ MR\n            update_vec_E = inv_ML @ (0.5 * dt * b)\n            \n            for n in range(num_steps):\n                X[:, n + 1] = update_mat_X @ X[:, n] + update_vec_E * (E[n] + E[n+1])\n\n        elif method == 'FE':\n            I = np.identity(2)\n            M_FE = I + dt * A\n            b_FE = dt * b\n\n            for n in range(num_steps):\n                X[:, n + 1] = M_FE @ X[:, n] + b_FE * E[n]\n        \n        # Extract derivative of polarization\n        P_dot = X[1, :]\n\n        # Calculate total absorbed/dissipated energy density\n        integrand = E * P_dot\n        P_loss = np.trapz(integrand, t)\n\n        # Violation check\n        if E0 == 0:\n            tolerance = 1e-12\n        else:\n            S = EPS0 * E0**2 * T\n            tolerance = 1e-6 * S\n        \n        violation = P_loss  -tolerance\n\n        results.append([P_loss, violation])\n\n    # Format the final output string\n    output_parts = [f\"[{r[0]},{str(r[1])}]\" for r in results]\n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3301071"}]}