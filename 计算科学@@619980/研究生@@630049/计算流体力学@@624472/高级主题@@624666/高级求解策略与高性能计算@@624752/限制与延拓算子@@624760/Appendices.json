{"hands_on_practices": [{"introduction": "在多重网格方法中，算子的构建是核心环节。本练习将从最基本的第一性原理出发，指导你构建计算流体力学中最常用的延拓算子之一——线性与双线性插值算子。通过推导其在一维和二维张量积形式下的具体形式，并分析其对二次多项式的插值误差，你将掌握评估算子精度阶的关键方法，从而将抽象的算子概念与具体的多项式插值理论联系起来 ([@problem_id:3357474])。", "problem": "考虑一维空间中的均匀粗网格，其节点间距为 $H$，节点横坐标为 $x_i = i H$，其中 $i \\in \\mathbb{Z}$。令 $u^H_i$ 表示对一个足够光滑的标量场 $u(x)$ 的粗网格近似，该标量场是计算流体力学 (CFD) 中出现的场变量。定义一个间距为 $h = H/2$ 的细网格，其节点包括 $x_i$、$x_i + H/2$ 和 $x_{i+1} = x_i + H$。\n\n(a) 仅使用插值的基本定义，即插值是在选定的多项式空间中与插值点处数据相匹配的唯一元素，推导将粗网格节点值 $\\{u^H_i, u^H_{i+1}\\}$ 映射到细网格节点 $\\{x_i, x_i + H/2, x_{i+1}\\}$ 处值的一维延长算子，要求插值在每个粗单元 $[x_i, x_{i+1}]$ 上是线性的。写出这三个细网格点的所得到的点态映射，用 $\\{u^H_i, u^H_{i+1}\\}$ 表示。\n\n(b) 现在考虑二维空间中的一个均匀粗网格，其粗节点位于 $(x,y) \\in \\{0,H\\} \\times \\{0,H\\}$，标量场仍为 $u(x,y)$。通过取 (a) 部分中导出的一维线性插值的张量积，构造粗单元 $[0,H] \\times [0,H]$ 上的双线性延长算子。计算单元中心 $(H/2,H/2)$ 处的双线性延长值，并用角点值 $\\{u^H(0,0), u^H(H,0), u^H(0,H), u^H(H,H)\\}$ 表示。\n\n(c) 为了通过多项式精确性检验来评估精度阶，令 $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$ 为一个二次多项式，其中 $a$, $b$, $c$, $d$, $e$ 和 $g$ 是常数。使用 (b) 部分得到的双线性延长，计算单元中心的插值误差，定义为\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\n其中 $I(x,y)$ 是由角点粗网格值 $\\{f(0,0), f(H,0), f(0,H), f(H,H)\\}$ 构建的双线性插值函数。请以 $a$、$b$ 和 $H$ 的单个闭式解析表达式形式给出最终答案。不要使用大-$\\mathcal{O}$ 符号，也无需四舍五入。", "solution": "我们从给定单元上插值的基本定义开始：插值函数是在指定的多项式空间中，与插值点处的已知数据相匹配的唯一成员。在一维空间中，该空间是每个粗单元上次数最多为 $1$ 的多项式集合；在二维空间中，该空间是这些一维空间的张量积，即双线性多项式集合。\n\n(a) 部分。粗单元 $[x_i,x_{i+1}]$ 上的一维线性延长。\n\n在 $[x_i,x_{i+1}]$ 上，其中 $x_{i+1} = x_i + H$，一维线性插值函数由 Lagrange 基函数表征\n$$\nN_0(x) = \\frac{x_{i+1} - x}{H}, \\qquad N_1(x) = \\frac{x - x_i}{H},\n$$\n它们满足 $N_0(x_i) = 1$、$N_0(x_{i+1}) = 0$、$N_1(x_i) = 0$ 和 $N_1(x_{i+1}) = 1$。给定粗网格节点值 $u^H_i \\approx u(x_i)$ 和 $u^H_{i+1} \\approx u(x_{i+1})$，线性插值函数为\n$$\nI(x) = u^H_i \\, N_0(x) + u^H_{i+1} \\, N_1(x).\n$$\n在单元中的三个细网格点处求值：\n- 在 $x = x_i$ 处，\n$$\nI(x_i) = u^H_i \\, N_0(x_i) + u^H_{i+1} \\, N_1(x_i) = u^H_i.\n$$\n- 在 $x = x_i + H/2$ 处，\n$$\nN_0\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{x_{i+1} - (x_i + H/2)}{H} = \\frac{H/2}{H} = \\frac{1}{2}, \\quad\nN_1\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{(x_i + H/2) - x_i}{H} = \\frac{1}{2},\n$$\n所以\n$$\nI\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{1}{2} u^H_i + \\frac{1}{2} u^H_{i+1}.\n$$\n- 在 $x = x_{i+1}$ 处，\n$$\nI(x_{i+1}) = u^H_{i+1}.\n$$\n因此，从粗节点到单元中细节点的一维延长映射为\n$$\n\\bigl(u^H_i, u^H_{i+1}\\bigr) \\mapsto \\left( u^H_i,\\ \\frac{u^H_i + u^H_{i+1}}{2},\\ u^H_{i+1} \\right).\n$$\n\n(b) 部分。作为张量积的二维双线性延长以及在单元中心的求值。\n\n在粗单元 $[0,H] \\times [0,H]$上，取 $x$ 和 $y$ 方向的一维基函数：\n$$\nN_0(x) = \\frac{H - x}{H}, \\quad N_1(x) = \\frac{x}{H}, \\qquad\nM_0(y) = \\frac{H - y}{H}, \\quad M_1(y) = \\frac{y}{H}.\n$$\n单元角点上的双线性基函数为 $\\{ \\phi_{pq}(x,y) = N_p(x) M_q(y) \\}_{p,q \\in \\{0,1\\}}$，因此给定角点值\n$$\nu^H_{00} = u^H(0,0), \\quad u^H_{10} = u^H(H,0), \\quad u^H_{01} = u^H(0,H), \\quad u^H_{11} = u^H(H,H),\n$$\n双线性插值函数为\n$$\nI(x,y) = u^H_{00} \\, N_0(x) M_0(y) + u^H_{10} \\, N_1(x) M_0(y) + u^H_{01} \\, N_0(x) M_1(y) + u^H_{11} \\, N_1(x) M_1(y).\n$$\n在中心点 $(H/2,H/2)$ 处，有\n$$\nN_0\\!\\left(\\frac{H}{2}\\right) = N_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}, \\qquad\nM_0\\!\\left(\\frac{H}{2}\\right) = M_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}.\n$$\n因此，\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\sum_{p=0}^{1} \\sum_{q=0}^{1} u^H_{pq} \\, \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} \\left( u^H_{00} + u^H_{10} + u^H_{01} + u^H_{11} \\right).\n$$\n\n(c) 部分。二次多项式在中心的插值误差及精度阶评估。\n\n令 $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$。在四个角点处计算 $f$ 的值：\n- 在 $(0,0)$ 处：\n$$\nf(0,0) = g.\n$$\n- 在 $(H,0)$ 处：\n$$\nf(H,0) = a H^2 + d H + g.\n$$\n- 在 $(0,H)$ 处：\n$$\nf(0,H) = b H^2 + e H + g.\n$$\n- 在 $(H,H)$ 处：\n$$\nf(H,H) = a H^2 + b H^2 + c H^2 + d H + e H + g = (a + b + c) H^2 + d H + e H + g.\n$$\n因此，使用 (b) 部分的结果，中心处的双线性延长值为\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{1}{4} \\left[ g + (a H^2 + d H + g) + (b H^2 + e H + g) + \\bigl( (a+b+c) H^2 + d H + e H + g \\bigr) \\right].\n$$\n合并同类项：\n- 常数项：$g + g + g + g = 4 g$ 得到 $\\frac{1}{4} \\cdot 4 g = g$。\n- 与 $H$ 成正比的项：$d H + d H = 2 d H$ 和 $e H + e H = 2 e H$ 得到 $\\frac{1}{4} (2 d H + 2 e H) = \\frac{d+e}{2} H$。\n- 与 $H^2$ 成正比的项：$a H^2 + b H^2 + (a+b+c) H^2 = (2 a + 2 b + c) H^2$ 得到 $\\frac{1}{4} (2 a + 2 b + c) H^2$。\n\n因此，\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2.\n$$\n计算 $f$ 在中心点的精确值：\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = a \\left(\\frac{H}{2}\\right)^{2} + b \\left(\\frac{H}{2}\\right)^{2} + c \\left(\\frac{H}{2}\\right)\\left(\\frac{H}{2}\\right) + d \\left(\\frac{H}{2}\\right) + e \\left(\\frac{H}{2}\\right) + g.\n$$\n化简：\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g.\n$$\n中心的插值误差定义为\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\n则其值为\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g \\right) - \\left( g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2 \\right).\n$$\n消去公因子 $\\frac{d+e}{2} H$ 和 $g$，我们得到\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} - \\frac{2 a + 2 b + c}{4} \\right) H^2 = - \\frac{a + b}{4} \\, H^2.\n$$\n这个精确表达式表明，双线性延长能够精确地重现混合项 $c x y$ 以及所有线性和常数项，并且主导误差与 $H^2$ 成比例，这证明了对于足够光滑的场，其局部二次模型能代表截断行为时，该延长在单元中心具有二阶精度。", "answer": "$$\\boxed{-\\frac{a+b}{4}\\,H^{2}}$$", "id": "3357474"}, {"introduction": "理解了算子的基本构造后，下一步是观察它们在实际算法中如何协同工作。本练习将引导你手动完成一个完整的全近似格式 (Full Approximation Scheme, FAS) V-循环，这是解决CFD中常见的非线性问题的标准多重网格方法。通过为一个一维非线性扩散问题显式计算每一步，包括状态和残差的限制、粗网格修正以及修正量的延拓，你将深刻理解信息如何在不同层级的网格间传递与处理，从而揭开FAS算法的神秘面纱 ([@problem_id:3357488])。", "problem": "考虑一个代表计算流体动力学的一维、稳态、非线性扩散模型问题：$x \\in [0,1]$ 上的标量场 $u(x)$ 满足\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1,\n$$\n狄利克雷边界条件为 $u(0) = 0$ 和 $u(1) = 0$。在均匀网格上，使用保守的中心有限体积/有限差分格式对算子进行离散化，其中对于网格间距 $h$ 和内部节点索引 $i$，离散非线性算子 $N^{h}(u)$ 为\n$$\n\\left(N^{h}(u)\\right)_{i} \\equiv - \\frac{1}{h} \\left( \\frac{1}{h} a_{i+\\frac{1}{2}} \\left( u_{i+1} - u_{i} \\right) - \\frac{1}{h} a_{i-\\frac{1}{2}} \\left( u_{i} - u_{i-1} \\right) \\right),\n$$\n其中非线性面扩散系数定义为\n$$\na_{i+\\frac{1}{2}} \\equiv 1 + \\left( \\frac{u_{i} + u_{i+1}}{2} \\right)^{2}.\n$$\n\n使用以下设置，完成一个全近似方案（FAS）V循环的计算：\n\n- 细网格：$h = \\frac{1}{4}$，节点位于 $x = 0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1$，有三个对应于 $x = \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}$ 的内部未知数 $\\tilde{u}^{h} = \\left( \\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3} \\right)^{\\top}$。\n- 粗网格：$H = 2h = \\frac{1}{2}$，节点位于 $x = 0, \\frac{1}{2}, 1$，在 $x = \\frac{1}{2}$ 处有一个内部未知数 $u^{H}$。\n- 两个网格上的右端项是常数源 $1$ 的离散化，即对于 $i=1,2,3$ 有 $f^{h}_{i} = 1$，在粗网格内部节点处有 $f^{H} = 1$。\n- 初始细网格迭代值为零：$\\tilde{u}^{h} = (0,0,0)^{\\top}$。\n- 状态（网格函数）的限制算子是注入 $R_{u}: \\mathbb{R}^{3} \\to \\mathbb{R}$，定义为 $R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$。\n- 残差/亏量的限制算子是一维全加权 $R_{r}: \\mathbb{R}^{3} \\to \\mathbb{R}$，\n$$\nR_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}.\n$$\n- 修正量的延长算子 $P: \\mathbb{R} \\to \\mathbb{R}^{3}$ 是从粗网格内部修正量 $e^{H}$ 到细网格节点的线性插值，\n$$\nP(e^{H}) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top}.\n$$\n- 在粗网格上，从注入的粗网格状态开始，执行一步牛顿法来近似求解FAS粗网格方程。也就是说，设 $F^{H}(u^{H}) \\equiv N^{H}(u^{H}) - \\left( f^{H}_{\\text{FAS}} \\right)$，取\n$$\nu^{H} \\leftarrow u^{H} - \\frac{F^{H}(u^{H})}{\\left( F^{H} \\right)'(u^{H})},\n$$\n从 $u^{H} = R_{u}(\\tilde{u}^{h})$ 开始。\n\n按以下步骤进行FAS计算：\n\n1. 计算细网格亏量 $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$。\n2. 限制状态：$\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$，并根据相同的离散化原理和网格间距 $H$ 写出粗网格非线性算子 $N^{H}(u^{H})$。\n3. 使用亏量和状态限制，以及在 $\\tilde{u}^{H}$ 处求值的粗网格算子，构成FAS粗网格右端项 $f^{H}_{\\text{FAS}}$。\n4. 对粗网格方程应用一步牛顿法，得到 $u^{H}$。\n5. 计算粗网格修正量 $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$。\n6. 延长修正量 $e^{h} \\equiv P(e^{H})$ 并更新细网格迭代值 $u^{h,\\text{new}} \\equiv \\tilde{u}^{h} + e^{h}$。\n\n在这些步骤中，明确写出 $R_{u}$、$R_{r}$ 和 $P$ 对状态和亏量的每次应用，并解释粗网格修正量如何修改细网格迭代值。最后，报告中心节点 $x = \\frac{1}{2}$ 处更新后的细网格迭代值。以单个实数形式提供最终答案。无需四舍五入，该量为无量纲量。", "solution": "用户希望对一个特定的一维非线性扩散问题执行一个全近似方案（FAS）的V循环。该过程被分解为问题陈述中指定的六个不同步骤。\n\n首先，我们建立数学背景。非线性边值问题是：\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1, \\quad x \\in [0,1]\n$$\n边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n\n细网格的间距为 $h = \\frac{1}{4}$，在位置 $x_1 = \\frac{1}{4}$、$x_2 = \\frac{1}{2}$ 和 $x_3 = \\frac{3}{4}$ 处分别有三个内部未知数 $\\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3}$。边界节点为 $u_0 = u(0) = 0$ 和 $u_4 = u(1) = 0$。细网格解的初始猜测为 $\\tilde{u}^{h} = (\\tilde{u}_1, \\tilde{u}_2, \\tilde{u}_3)^{\\top} = (0, 0, 0)^{\\top}$。源项离散化为 $f^{h} = (1, 1, 1)^{\\top}$。\n\n粗网格的间距为 $H = 2h = \\frac{1}{2}$，在 $x = \\frac{1}{2}$ 处有一个内部未知数 $u^{H}$。边界节点为 $u^{H}_{0} = 0$ 和 $u^{H}_{2} = 0$。\n\n在内部节点 $i$ 处的细网格离散算子是：\n$$\n\\left(N^{h}(u)\\right)_{i} = - \\frac{1}{h^2} \\left( a_{i+\\frac{1}{2}} (u_{i+1} - u_{i}) - a_{i-\\frac{1}{2}} (u_{i} - u_{i-1}) \\right)\n$$\n其中 $a_{i+\\frac{1}{2}} = 1 + \\left( \\frac{u_i + u_{i+1}}{2} \\right)^{2}$ 且 $\\frac{1}{h^2} = \\frac{1}{(1/4)^2} = 16$。\n\n针对单个内部未知数 $u^H$ 的粗网格离散算子以类似方式导出。设 $u^H$ 为中心节点处的值。\n$$\nN^{H}(u^{H}) = - \\frac{1}{H^2} \\left( a_{1+\\frac{1}{2}}(u^{H}_{2} - u^{H}) - a_{1-\\frac{1}{2}}(u^{H} - u^{H}_{0}) \\right)\n$$\n当 $H=\\frac{1}{2}$，$u^{H}_{0}=0$，$u^{H}_{2}=0$ 时，扩散系数变为 $a_{1+\\frac{1}{2}} = 1 + (\\frac{u^H+0}{2})^2$ 和 $a_{1-\\frac{1}{2}} = 1 + (\\frac{0+u^H}{2})^2$。两者都等于 $1 + \\frac{(u^H)^2}{4}$。\n$$\nN^{H}(u^{H}) = -4 \\left( \\left(1 + \\frac{(u^H)^2}{4}\\right)(0 - u^H) - \\left(1 + \\frac{(u^H)^2}{4}\\right)(u^H - 0) \\right) = -4 \\left( -2u^H \\left(1 + \\frac{(u^H)^2}{4}\\right) \\right) = 8u^H + 2(u^H)^3\n$$\n现在我们执行FAS V循环的步骤。\n\n**步骤1：计算细网格亏量 $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$**\n初始迭代值为 $\\tilde{u}^{h} = (0,0,0)^{\\top}$。边界值为 $\\tilde{u}_0 = 0$ 和 $\\tilde{u}_4 = 0$。\n首先计算面扩散系数：\n$$\na_{i+\\frac{1}{2}} = 1 + \\left( \\frac{\\tilde{u}_i + \\tilde{u}_{i+1}}{2} \\right)^2 = 1 + \\left( \\frac{0 + 0}{2} \\right)^2 = 1\n$$\n这对所有面都成立。\n然后对每个内部节点 $i=1,2,3$ 计算离散算子 $N^{h}(\\tilde{u}^{h})$：\n$$\n\\left(N^{h}(\\tilde{u}^{h})\\right)_{i} = -16 \\left( 1(\\tilde{u}_{i+1} - \\tilde{u}_i) - 1(\\tilde{u}_i - \\tilde{u}_{i-1}) \\right) = -16 \\left( 1(0 - 0) - 1(0 - 0) \\right) = 0\n$$\n因此，$N^{h}(\\tilde{u}^{h}) = (0,0,0)^{\\top}$。\n亏量（或残差）为：\n$$\nd^{h} = f^{h} - N^{h}(\\tilde{u}^{h}) = (1,1,1)^{\\top} - (0,0,0)^{\\top} = (1,1,1)^{\\top}\n$$\n\n**步骤2：限制状态：$\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$**\n状态限制算子 $R_u$ 定义为注入：$R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$。\n将此应用于当前的细网格迭代值：\n$$\n\\tilde{u}^{H} = R_{u}\\left((0,0,0)^{\\top}\\right) = 0\n$$\n\n**步骤3：构成FAS粗网格右端项 $f^{H}_{\\text{FAS}}$**\n粗网格方程为 $N^H(u^H) = f^H_{\\text{FAS}}$，其中FAS右端项定义为：\n$$\nf^{H}_{\\text{FAS}} = N^{H}(\\tilde{u}^{H}) + R_{r}(f^{h} - N^{h}(\\tilde{u}^{h})) = N^{H}(\\tilde{u}^{H}) + R_{r}(d^{h})\n$$\n我们计算右侧的每一项：\n- 根据步骤2，$\\tilde{u}^{H} = 0$。所以，$N^{H}(\\tilde{u}^{H}) = N^{H}(0) = 8(0) + 2(0)^3 = 0$。\n- 残差限制算子是一维全加权 $R_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}$。根据步骤1，$d^h=(1,1,1)^{\\top}$。\n$$\nR_{r}(d^{h}) = \\frac{1}{4}(1) + \\frac{1}{2}(1) + \\frac{1}{4}(1) = 1\n$$\n结合这些结果，得到FAS右端项：\n$$\nf^{H}_{\\text{FAS}} = 0 + 1 = 1\n$$\n待近似求解的粗网格方程是 $N^{H}(u^{H}) = 1$，即 $8u^{H} + 2(u^{H})^3 = 1$。\n\n**步骤4：对粗网格方程应用一步牛顿法，得到 $u^{H}$**\n我们使用一步牛顿法求解 $F^{H}(u^{H}) \\equiv 8u^{H} + 2(u^{H})^3 - 1 = 0$，从 $u^{H}_{\\text{start}} = \\tilde{u}^H = 0$ 开始。\n牛顿更新法则是 $u^{H}_{\\text{new}} = u^{H}_{\\text{old}} - \\frac{F^{H}(u^{H}_{\\text{old}})}{(F^{H})'(u^{H}_{\\text{old}})}$。\n$F^{H}$ 的导数是 $(F^{H})'(u^{H}) = \\frac{d}{du^H}(8u^{H} + 2(u^{H})^3 - 1) = 8 + 6(u^{H})^2$。\n我们在起始点 $u^{H}_{\\text{old}} = 0$ 处计算 $F^H$ 及其导数：\n$$\nF^{H}(0) = 8(0) + 2(0)^3 - 1 = -1\n$$\n$$\n(F^{H})'(0) = 8 + 6(0)^2 = 8\n$$\n更新后的粗网格解 $u^H$ 是：\n$$\nu^{H} = 0 - \\frac{-1}{8} = \\frac{1}{8}\n$$\n\n**步骤5：计算粗网格修正量 $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$**\n粗网格修正是新粗网格解与限制后的细网格解之差：\n$$\ne^{H} = u^{H} - \\tilde{u}^{H} = \\frac{1}{8} - 0 = \\frac{1}{8}\n$$\n\n**步骤6：延长修正量 $e^{h} \\equiv P(e^{H})$ 并更新细网格迭代值**\n粗网格修正量 $e^H$ 使用延长算子 $P$ 插值到细网格。将 $P$ 应用于粗网格修正量 $e^H$ 得到细网格修正向量 $e^h$：\n$$\ne^{h} = P(e^H) = P\\left(\\frac{1}{8}\\right) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top} = \\left( \\frac{1}{2} \\cdot \\frac{1}{8}, \\; \\frac{1}{8}, \\; \\frac{1}{2} \\cdot \\frac{1}{8} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\n然后通过加上这个修正量来更新细网格迭代值。这一步将粗网格上捕捉到的低频误差信息注入回细网格解中：\n$$\nu^{h,\\text{new}} \\equiv \\tilde{u}^{h} + e^{h}\n$$\n$$\nu^{h,\\text{new}} = (0, 0, 0)^{\\top} + \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\n问题要求的是中心节点 $x = \\frac{1}{2}$ 处的更新值，它对应于向量 $u^{h,\\text{new}}$ 的第二个分量。该值为 $\\frac{1}{8}$。", "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$", "id": "3357488"}, {"introduction": "理论学习中接触的算子模板通常适用于理想的内部区域，但在实际应用中，我们必须处理边界条件带来的复杂性。本练习旨在弥合理论与实践之间的鸿沟，探讨如何在狄利克雷边界附近修正标准的全加权限制算子。你将学习如何通过重新归一化权重来调整算子，以在避免使用域外“虚拟点”的同时，保持其代数性质（如常数保持性），这是确保多重网格方法鲁棒性的关键一步 ([@problem_id:3440509])。", "problem": "考虑一个在多边形域上的二维椭圆偏微分方程（PDE），其边界为齐次狄利克雷边界条件，且直边界段与笛卡尔网格对齐。设细网格以节点为中心，间距为 $h$，内部节点的索引为 $(i,j)$；粗网格的间距为 $H=2h$，内部粗网格节点的索引为 $(I,J)$。对于远离边界的内部粗网格节点，经典的全加权限制算子通过一个 $3\\times 3$ 的模板将细网格上的节点场 $r_{i,j}$（例如，残差）映射到粗网格上：\n$$\n\\frac{1}{16}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix},\n$$\n该模板以细网格节点 $(2I,2J)$ 为中心。\n\n在狄利克雷边界附近，如果标准的 $3\\times 3$ 模板的支撑域与外部区域重叠，那么在邻近边界的粗网格节点上直接应用上述模板可能需要域外（鬼点）的细网格值。一种避免使用鬼点的稳健修正是，将对应于域外细网格节点的权重设置为零，并对域内剩余的权重进行重新归一化，以使限制算子能够保持常数，即修改后的权重之和为 $1$。\n\n我们关注一个粗网格节点 $(I,J)$，它邻近一条与网格对齐的直狄利克雷边界，但不在角点上。这种情况使得标准 $3\\times 3$ 模板在边界法线方向上的一整列细网格节点都位于域外。假设缺失的这一列对应于相对于细网格中心 $(2I,2J)$ 的 $3\\times 3$ 模板的“左”列。\n\n仅从以下要求出发：限制算子是可用细网格值的凸组合（权重非负且和为 $1$），并且在没有边界时退化为内部全加权形式。请通过移除域外列并重新缩放剩余权重，推导此边界邻近粗网格节点上的重新归一化全加权模板。请以完整的 $3\\times 3$ 权重矩阵（从左下到右上排序）的形式给出你的最终答案，在排除的位置填入 $0$，并将所有元素表示为精确分数。", "solution": "本问题要求推导一个用于邻近与网格对齐的直狄利克雷边界的粗网格节点的修正全加权限制算子模板。该修正必须遵循保持常数的原则，即模板权重必须非负且总和为 $1$。\n\n对于一个内部粗网格节点 $(I,J)$，标准的全加权限制算子由一个 $3 \\times 3$ 的权重模板定义，该模板应用于对应细网格节点 $(2I, 2J)$ 及其周围的细网格残差场 $r$。我们记未归一化的权重为矩阵 $W$，其形式如下：\n$$\nW =\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n这些未归一化权重的总和是 $S_{total} = 1+2+1+2+4+2+1+2+1 = 16$。标准的限制算子 $R_{int}$ 通过对这些权重进行归一化得到，即 $R_{int} = \\frac{1}{S_{total}} W = \\frac{1}{16} W$。\n\n本问题考虑的情景是，粗网格节点 $(I,J)$ 靠近边界，导致模板支撑域中对应“左”列的细网格节点位于计算域之外。我们假设矩阵 $W$ 的布局方式是其列对应于网格上的x方向，第一列为“左”列。与左列相关的细网格节点的值是不可用的，这是由于狄利克雷边界条件（边界上的值固定为 $0$，并且不参与内部节点残差的计算）。\n\n修正步骤指出，对应于这些域外细网格节点的权重必须设置为零。$W$ 矩阵左列的未归一化权重为 $1$、$2$ 和 $1$。这些被移除的权重之和为：\n$$\nS_{removed} = 1 + 2 + 1 = 4\n$$\n剩余的未归一化权重位于 $W$ 的第二和第三列。这些剩余权重之和 $S_{rem}$ 是总和减去被移除的权重之和：\n$$\nS_{rem} = S_{total} - S_{removed} = 16 - 4 = 12\n$$\n剩余未归一化权重的矩阵，我们可以称之为 $W_{bound, unnorm}$，是：\n$$\nW_{bound, unnorm} =\n\\begin{pmatrix}\n0  2  1 \\\\\n0  4  2 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n为确保修正后的限制算子保持常数，剩余的权重必须重新归一化，使其总和为 $1$。这可以通过将每个剩余的未归一化权重除以它们的总和 $S_{rem}$ 来实现。新的归一化因子是 $\\frac{1}{S_{rem}} = \\frac{1}{12}$。\n\n因此，得到的边界修正限制模板 $R_{bound}$ 是：\n$$\nR_{bound} = \\frac{1}{12} W_{bound, unnorm} = \\frac{1}{12}\n\\begin{pmatrix}\n0  2  1 \\\\\n0  4  2 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n将标量乘入矩阵并简化分数，得到最终的权重矩阵：\n$$\nR_{bound} =\n\\begin{pmatrix}\n\\frac{0}{12}  \\frac{2}{12}  \\frac{1}{12} \\\\\n\\frac{0}{12}  \\frac{4}{12}  \\frac{2}{12} \\\\\n\\frac{0}{12}  \\frac{2}{12}  \\frac{1}{12}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  \\frac{1}{6}  \\frac{1}{12} \\\\\n0  \\frac{1}{3}  \\frac{1}{6} \\\\\n0  \\frac{1}{6}  \\frac{1}{12}\n\\end{pmatrix}\n$$\n该矩阵表示一个邻近其左侧直边界的粗网格节点的模板。其元素之和为 $0 + \\frac{1}{6} + \\frac{1}{12} + 0 + \\frac{1}{3} + \\frac{1}{6} + 0 + \\frac{1}{6} + \\frac{1}{12} = \\frac{2}{12} + \\frac{1}{12} + \\frac{4}{12} + \\frac{2}{12} + \\frac{2}{12} + \\frac{1}{12} = \\frac{12}{12} = 1$，这证实了该算子按要求保持了常数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{6}  \\frac{1}{12} \\\\\n0  \\frac{1}{3}  \\frac{1}{6} \\\\\n0  \\frac{1}{6}  \\frac{1}{12}\n\\end{pmatrix}\n}\n$$", "id": "3440509"}]}