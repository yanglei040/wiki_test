{"hands_on_practices": [{"introduction": "首先，让我们在一个受控的环境中探讨 h-refinement 的基本效果。第一个练习将量化均匀细分网格对计算成本和预期精度的影响。通过计算网格单元数量、自由度以及理论误差减小率的变化，您将对 h-refinement 固有的尺度特性建立起基础的理解。[@problem_id:3328224]", "problem": "考虑单位正方形 $\\Omega = [0,1] \\times [0,1]$ 上的线性平流方程 $\\partial_{t} u + \\boldsymbol{a} \\cdot \\nabla u = 0$，其中平流速度 $\\boldsymbol{a} \\in \\mathbb{R}^{2}$ 为常数，$u$ 是光滑的。空间离散采用结构化四边形网格上的单元中心二阶有限体积（FV）方法。假设在 $\\partial \\Omega$ 的流入部分施加狄利克雷边界条件，并且每个单元的单元平均值 $u_{i}$ 是唯一的全局耦合主未知量；二阶精度通过线性重构实现，该重构使用从相邻单元平均值计算出的最小二乘梯度。忽略时间离散误差和任何稳定化参数；仅关注空间离散的性质。\n\n初始网格是均匀的，在 $x$ 方向上有 $N_{x} = 37$ 个单元，在 $y$ 方向上有 $N_{y} = 23$ 个单元，正好覆盖 $\\Omega$。执行两级均匀 $h$-加密，每一级将每个四边形单元细分为四个全等的四边形（每一级在每个坐标方向上二等分一次）。令 $N_{0}$ 表示初始单元数，令 $N_{2}$ 表示两级加密后的单元数。令 $\\text{DOF}_{2}$ 表示两级加密后的全局耦合主自由度数。\n\n对于误差估计，对于均匀网格，将特征网格尺寸定义为 $h = \\max(\\Delta x, \\Delta y)$，其中在任何加密级别上，$\\Delta x = 1/N_{x}$ 和 $\\Delta y = 1/N_{y}$。对于应用于线性平流光滑解的二阶 FV 空间离散，假设在全局范数 $E(h)$ 中的主阶空间离散误差服从渐近关系 $E(h) \\propto h^{2}$，并且在渐近区域内具有与加密无关的比例常数。使用 $h$ 的此定义和所述的加密过程，确定：\n\n1. $N_{2}$，经过两级均匀 $h$-加密后的总单元数，\n2. $\\text{DOF}_{2}$，经过两级加密后的全局耦合主自由度数，\n3. 加密后网格（两级后）与初始网格之间的误差减小因子 $R = E(h_{2})/E(h_{0})$，表示为精确分数。\n\n将您的最终答案以单行矩阵 $\\begin{pmatrix} N_{2}  \\text{DOF}_{2}  R \\end{pmatrix}$ 的形式给出，不带单位。无需四舍五入；将 $R$ 表示为精确分数。", "solution": "该问题涉及在均匀 $h$-加密下的单元计数、单元中心方法对应的全局耦合自由度数，以及二阶有限体积（FV）格式下空间离散误差随网格尺寸的渐近标度。\n\n首先，考虑初始网格。区域 $\\Omega = [0,1] \\times [0,1]$ 被一个结构化四边形网格覆盖，其在 $x$ 方向上有 $N_{x} = 37$ 个单元，在 $y$ 方向上有 $N_{y} = 23$ 个单元。因此，初始单元数为\n$$\nN_{0} = N_{x} N_{y} = 37 \\times 23 = 851.\n$$\n现在分析均匀 $h$-加密的效果，即每个加密层级将每个四边形单元细分为四个全等的四边形。将每个四边形细分为四个是通过在每个坐标方向上二等分一次来实现的，这使得 $x$ 和 $y$ 方向上的分辨率都加倍。对于每个加密层级：\n- 单元数增加一个因子 $4$（因为每个原始单元变成四个），\n- 每个方向上的单元数加倍，即 $N_{x} \\mapsto 2 N_{x}$ 和 $N_{y} \\mapsto 2 N_{y}$。\n\n经过两级加密后，单元数的总乘法因子为\n$$\n4 \\times 4 = 4^{2} = 16.\n$$\n因此，\n$$\nN_{2} = 16 N_{0} = 16 \\times 851 = 13{,}616.\n$$\n由于该格式是以单元为中心的，并且唯一的全局耦合主未知量是单元平均值 $u_{i}$，所以自由度数等于单元数。在所述的格式中，没有针对面或节点的额外全局耦合未知量，并且狄利克雷边界条件不引入额外的自由度。因此，\n$$\n\\text{DOF}_{2} = N_{2} = 13{,}616.\n$$\n\n接下来，考虑网格尺寸和误差标度。对于均匀结构化网格，将特征网格尺寸定义为\n$$\nh = \\max(\\Delta x, \\Delta y), \\quad \\Delta x = \\frac{1}{N_{x}}, \\quad \\Delta y = \\frac{1}{N_{y}}.\n$$\n经过一级均匀加密后，$N_{x}$ 和 $N_{y}$ 各自加倍，因此 $\\Delta x$ 和 $\\Delta y$ 各自减半。因此 $h$ 减半。经过两级加密后，$N_{x}$ 和 $N_{y}$ 乘以 $4$，所以 $\\Delta x$ 和 $\\Delta y$ 都除以 $4$，因此\n$$\n\\frac{h_{2}}{h_{0}} = \\frac{1}{4}.\n$$\n对于应用于线性平流光滑解的二阶 FV 空间离散，主阶空间离散误差的标度为\n$$\nE(h) \\propto h^{2}.\n$$\n该标度关系源于对带有线性重构的通量进行泰勒级数分析，其中主截断误差项涉及 $u$ 的二阶导数乘以 $h^{2}$。因此，经过两级加密后的误差减小因子为\n$$\nR = \\frac{E(h_{2})}{E(h_{0})} = \\left( \\frac{h_{2}}{h_{0}} \\right)^{2} = \\left( \\frac{1}{4} \\right)^{2} = \\frac{1}{16}.\n$$\n\n汇总结果，我们有\n$$\nN_{2} = 13{,}616, \\quad \\text{DOF}_{2} = 13{,}616, \\quad R = \\frac{1}{16}.\n$$\n这些可以作为所要求的行矩阵报告。", "answer": "$$\\boxed{\\begin{pmatrix}13616  13616  \\frac{1}{16}\\end{pmatrix}}$$", "id": "3328224"}, {"introduction": "尽管均匀加密很简单，但其计算成本通常很高。自适应加密只在需要的区域进行，效率更高，但也引入了新的约束，特别是对于显式求解器。本练习题将深入探讨局部单元尺寸与 CFL 稳定性条件之间的关键关系，揭示即使仅加密域内一个很小的高速区域，也会如何严格限制全局时间步长。[@problem_id:3328188]", "problem": "考虑一个由欧拉方程控制的一维可压缩流，该流在长度为 $L$ 的区域上通过有限体积法在均匀网格上进行离散化。求解器使用单一的全局时间步长在时间上推进，该时间步长受库朗-弗里德里希斯-列维 (CFL) 数控制的稳定性要求限制。假设使用的全局库朗-弗里德里希斯-列维 (CFL) 数为 $0.8$。\n\n区域长度为 $L=10\\,\\mathrm{m}$，初始网格有 $N=200$ 个均匀单元，每个单元的尺寸为 $h=L/N$。局部最大一维特征速度（等于与双曲系统相关的最大信号速度）在空间上是变化的：在一个包含 $0.05$ 比例单元（即 $0.05N$ 个单元）的连续区域中，速度达到其最大值 $a_{\\max}=1200\\,\\mathrm{m/s}$；在其他所有地方，速度为 $a_{\\mathrm{bulk}}=800\\,\\mathrm{m/s}$。仅在高速区域通过单元细分进行网格h-加密：这 $0.05N$ 个单元中的每一个都被分裂成两个相等的子单元，使得那里的局部单元尺寸减半，而所有其他单元保持不变。假设在一个时间步长内，特征速度 $a_{\\max}$ 和 $a_{\\mathrm{bulk}}$ 保持不变，并且求解器使用一个受所有单元中最严格的局部时间步长限制的单一全局时间步长。\n\n根据双曲守恒律显式稳定性的第一性原理，确定在这次通过单元细分进行的h-加密之后新的全局时间步长 $\\Delta t$。以秒为单位表示最终的 $\\Delta t$，并将您的答案四舍五入到四位有效数字。", "solution": "解答过程从应用于双曲守恒律的显式有限体积法稳定性的第一性原理出发。当使用单一全局时间步长 $\\Delta t$ 时，这种格式的稳定性由库朗-弗里德里希斯-列维 (CFL) 条件控制，该条件必须对计算网格中的每个单元 $i$ 都满足。对于一维问题，该条件由下式给出：\n$$C_i = \\frac{S_i \\Delta t}{h_i} \\le C$$\n其中 $h_i$ 是单元 $i$ 的尺寸，$S_i$ 是该单元内的局部最大信号速度（特征速度），$C$ 是最大允许库朗数，这里作为全局CFL数给出，为 $C = 0.8$。\n\n由于时间步长 $\\Delta t$ 是全局的（对所有单元都相同），因此必须选择它来满足最严格的局部条件。也就是说，$\\Delta t$ 受到为保持稳定而需要最小时间步长的单元的限制。这对应于比值 $\\frac{h_i}{S_i}$ 具有最小值的单元。因此，全局时间步长的计算公式为：\n$$\\Delta t = C \\min_{i} \\left( \\frac{h_i}{S_i} \\right)$$\n我们的任务是确定在指定的h-加密*之后*网格的 $\\Delta t$。\n\n首先，我们描述加密前的网格。区域长度为 $L=10\\,\\mathrm{m}$，离散为 $N=200$ 个均匀单元。初始单元尺寸 $h$ 为：\n$$h = \\frac{L}{N} = \\frac{10\\,\\mathrm{m}}{200} = 0.05\\,\\mathrm{m}$$\n\n接下来，我们分析h-加密*之后*的网格。加密是非均匀的。\n单元被分为两个区域：\n1. 一个高速区域，其中特征速度为 $a_{\\max}=1200\\,\\mathrm{m/s}$。该区域最初包含比例为 $f_{\\text{high}} = 0.05$ 的单元，即 $0.05 \\times 200 = 10$ 个单元。这些单元中的每一个都被分裂成两个，因此它们的尺寸减半。在这个加密区域中，新的单元尺寸 $h_{\\text{ref}}$ 为：\n$$h_{\\text{ref}} = \\frac{h}{2} = \\frac{0.05\\,\\mathrm{m}}{2} = 0.025\\,\\mathrm{m}$$\n\n2. 一个主体区域，即区域的其余部分。这里的特征速度为 $a_{\\mathrm{bulk}}=800\\,\\mathrm{m/s}$。这个区域的单元没有被加密。它们的尺寸 $h_{\\text{bulk}}$ 与初始单元尺寸保持相同：\n$$h_{\\text{bulk}} = h = 0.05\\,\\mathrm{m}$$\n\n现在，我们评估修改后网格中每种类型单元的比值 $\\frac{h_i}{S_i}$，以找到最小值。\n对于未加密的主体区域中的一个单元：\n$$\\frac{h_{\\text{bulk}}}{a_{\\mathrm{bulk}}} = \\frac{0.05\\,\\mathrm{m}}{800\\,\\mathrm{m/s}} = 6.25 \\times 10^{-5}\\,\\mathrm{s}$$\n对于加密的高速区域中的一个单元：\n$$\\frac{h_{\\text{ref}}}{a_{\\max}} = \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}} = \\frac{0.025}{1.2 \\times 10^3}\\,\\mathrm{s} \\approx 2.0833... \\times 10^{-5}\\,\\mathrm{s}$$\n\n我们必须找到这两个值的最小值，以确定全局时间步长的约束：\n$$\\min_{i} \\left( \\frac{h_i}{S_i} \\right) = \\min \\left( \\frac{h_{\\text{bulk}}}{a_{\\mathrm{bulk}}}, \\frac{h_{\\text{ref}}}{a_{\\max}} \\right) = \\min(6.25 \\times 10^{-5}\\,\\mathrm{s}, 2.0833... \\times 10^{-5}\\,\\mathrm{s})$$\n最小值由加密的高速区域中的单元决定：\n$$\\min_{i} \\left( \\frac{h_i}{S_i} \\right) = \\frac{h_{\\text{ref}}}{a_{\\max}} = \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}}$$\n\n最后，我们使用给定的CFL数 $C = 0.8$ 计算新的全局时间步长 $\\Delta t$。\n$$\\Delta t = C \\left( \\frac{h_{\\text{ref}}}{a_{\\max}} \\right) = 0.8 \\times \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}}$$\n让我们计算精确值：\n$$\\Delta t = 0.8 \\times \\frac{0.025}{1200}\\,\\mathrm{s} = \\frac{0.02}{1200}\\,\\mathrm{s} = \\frac{1}{60000}\\,\\mathrm{s} \\approx 1.666... \\times 10^{-5}\\,\\mathrm{s}$$\n问题要求答案四舍五入到四位有效数字。\n$$\\Delta t \\approx 1.667 \\times 10^{-5}\\,\\mathrm{s}$$", "answer": "$$\\boxed{1.667 \\times 10^{-5}}$$", "id": "3328188"}, {"introduction": "自适应网格加密 (AMR) 的一个关键挑战是，在粗细网格之间的非协调界面上保持严格的守恒性，尤其是在使用不同时间步长（子循环）时。这个高级练习将指导您完成通量修正的过程，这是一项确保物理真实性的关键技术。通过协调跨粗细边界的通量，您将理解守恒性是如何被严格执行的，从而确保在界面处不会人为地产生或销毁质量、动量或能量。[@problem_id:3328267]", "problem": "考虑一个三维空间中标量守恒律的有限体积离散化，其由控制体 $V$ 上的积分守恒方程决定：\n$$\n\\frac{d}{dt}\\int_{V} U \\, dV + \\oint_{\\partial V} \\mathbf{F}(U)\\cdot \\mathbf{n} \\, dS = 0,\n$$\n其中 $U$ 是守恒密度，$\\mathbf{F}(U)$ 是其通量。在一个时空加密比均为 $r=2$ 的自适应网格加密 (AMR) 层级结构中，我们关注 $\\ell$ 层上的一个粗网格单元，其东侧面与 $\\ell+1$ 层上 $2\\times 2$ 拼接的细网格面重合。粗网格东侧面的单位外法向量从粗网格单元指向细网格区域。在一个粗网格时间步内，粗网格求解器在粗网格东侧面上产生一个时间平均的法向通量密度（例如，当 $\\mathbf{F}=\\rho \\mathbf{u}$ 时为质量通量密度）。细网格求解器在每个粗网格时间步内以两个等长的子步推进，并为每个子步在每个细网格面上产生时间平均的法向通量密度。\n\n粗网格东侧面的面积为 $A_{c} = 4.0\\times 10^{-2}\\,\\mathrm{m}^{2}$。拼接构成它的四个细网格面的面积各为 $A_{f} = 1.0\\times 10^{-2}\\,\\mathrm{m}^{2}$。在一个粗网格时间步内，粗网格东侧面上的未修正粗网格时间平均通量密度为 $f_{c}^{\\mathrm{uncorr}} = 7.45\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。细网格求解器报告了在两个细网格子步（$m=1,2$）中四个细网格面上的法向通量密度，其中对于粗网格面，正方向定义为从粗网格单元指向细网格区域的方向；而对于细网格面，在重合界面上，正方向定义为从细网格区域指向粗网格单元的方向（即与粗网格面法向相反）：\n- 面 $k=1$：$f_{f,1}^{(1)} = 7.10\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$f_{f,1}^{(2)} = 7.30\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 面 $k=2$：$f_{f,2}^{(1)} = 7.70\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$f_{f,2}^{(2)} = 7.90\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 面 $k=3$：$f_{f,3}^{(1)} = 7.30\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$f_{f,3}^{(2)} = 7.50\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n- 面 $k=4$：$f_{f,4}^{(1)} = 7.50\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$f_{f,4}^{(2)} = 7.70\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n仅从上述积分守恒方程和时间平均法向通量密度的定义出发，完成以下任务：\n1) 推导在子循环条件下，为保证跨界面守恒，修正后的粗网格面时间平均通量密度 $f_{c}^{\\mathrm{corr}}$ 在粗细网格重合界面上必须满足的约束条件。\n2) 使用所提供的数据，计算 $f_{c}^{\\mathrm{corr}}$、相应的在一个粗网格时间步内修正后的面积分粗网格通量 $\\Phi_{c}^{\\mathrm{corr}}$，以及在一个粗网格时间步内细网格面积分通量之和 $\\Phi_{f}$。\n3) 计算修正后的守恒残差，\n$$\nR \\equiv \\Phi_{c}^{\\mathrm{corr}} - \\Phi_{f},\n$$\n注意上述符号约定，使得精确守恒对应于 $R=0$。\n\n将 $R$ 的最终结果以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到八位有效数字。", "solution": "我们从有限体积控制体 $V$ 的积分守恒方程开始：\n$$\n\\frac{d}{dt}\\int_{V} U \\, dV + \\oint_{\\partial V} \\mathbf{F}(U)\\cdot \\mathbf{n} \\, dS = 0.\n$$\n对于使用有限体积法 (FVM) 的数值方法，我们通过对单元各面上的面积分通量求和来近似曲面积分。在一个时间区间 $\\Delta t$ 内，守恒量的更新由面积分通量的时间积分驱动。使用时间平均的法向通量密度，一个时间区间内的面积分通量是时间平均通量密度与面面积的乘积（如果也对时间进行积分，则再乘以时间长度）。当在相同的时间区间内进行比较时，跨越相等时间长度的积分通量之比简化为比较面积加权的时间平均通量密度。\n\n在自适应网格加密 (AMR) 的粗细网格重合界面上，守恒要求穿过粗网格面的通量等于穿过拼接的细网格面的通量之和，其符号由各自的外法向量决定。记粗网格面的外法向量（从粗网格单元指向细网格区域）为 $\\mathbf{n}_{c}$，细网格面的外法向量（在重合面上，从每个细网格单元指向粗网格单元）为 $\\mathbf{n}_{f}=-\\mathbf{n}_{c}$。令 $f_{c}$ 表示沿 $\\mathbf{n}_{c}$ 方向的时间平均粗网格面法向通量密度，令 $f_{f,k}$ 表示在细网格面 $k$ 上沿 $\\mathbf{n}_{f}$ 方向的时间平均细网格面法向通量密度。\n\n在时间加密比为 $r=2$ 的子循环条件下，在一个持续时间为 $\\Delta t_{c}$ 的粗网格步长内，细网格层级会进行两个持续时间相等的子步 $\\Delta t_{f}=\\Delta t_{c}/2$。令 $f_{f,k}^{(m)}$ 为在细网格子步 $m\\in\\{1,2\\}$ 内，细网格面 $k$ 上的时间平均通量密度。整个粗网格时间步内的细网格面时间平均通量密度是两个细网格子步的平均值：\n$$\n\\bar{f}_{f,k} \\equiv \\frac{1}{2}\\left(f_{f,k}^{(1)} + f_{f,k}^{(2)}\\right).\n$$\n\n因为在一个粗网格时间步内，跨越重合界面的积分通量必须精确平衡以满足守恒，我们要求修正后的粗网格面时间平均通量密度 $f_{c}^{\\mathrm{corr}}$ 满足\n$$\n\\underbrace{f_{c}^{\\mathrm{corr}} A_{c}}_{\\text{粗网格时间步内的粗网格面积分通量}} + \\sum_{k=1}^{4} \\underbrace{\\bar{f}_{f,k} A_{f}}_{\\text{粗网格时间步内的细网格面积分通量}} = 0,\n$$\n其中符号约定为：粗网格外法向量从粗网格单元指向细网格区域，而每个细网格外法向量从细网格单元指向粗网格单元。等价地，令大小相等并考虑相反的法向量，\n$$\nf_{c}^{\\mathrm{corr}} A_{c} = \\sum_{k=1}^{4} \\left(-\\bar{f}_{f,k} A_{f}\\right) \\quad \\Longleftrightarrow \\quad f_{c}^{\\mathrm{corr}} = \\frac{1}{A_{c}} \\sum_{k=1}^{4} \\left(-\\bar{f}_{f,k} A_{f}\\right).\n$$\n如果我们采用如前所述的约定，即 $\\bar{f}_{f,k}$ 在 $\\mathbf{n}_{f}=-\\mathbf{n}_{c}$ 方向上为正，那么为保证守恒，在粗网格面法向 $\\mathbf{n}_{c}$ 方向上所需的修正粗网格面通量密度为\n$$\nf_{c}^{\\mathrm{corr}} = -\\,\\frac{1}{A_{c}} \\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f}.\n$$\n对于问题陈述中定义的守恒残差\n$$\nR \\equiv \\Phi_{c}^{\\mathrm{corr}} - \\Phi_{f},\n$$\n其中 $\\Phi_{c}^{\\mathrm{corr}} \\equiv f_{c}^{\\mathrm{corr}} A_{c}$ 且 $\\Phi_{f} \\equiv \\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f}$，$R$ 中内含的外法向符号约定应使得精确守恒对应于 $R=0$。使用上述关系，\n$$\n\\Phi_{c}^{\\mathrm{corr}} = f_{c}^{\\mathrm{corr}} A_{c} = - \\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f} = -\\Phi_{f},\n$$\n如果我们保持相反的法向方向。然而，问题对 $R$ 的定义意在比较具有一致方向的量值，因此我们通过计算具有一致符号约定的 $\\Phi_{c}^{\\mathrm{corr}}$ 和 $\\Phi_{f}$，然后相减来评估 $R$。使用与粗网格面法向对齐的量值，我们取\n$$\n\\Phi_{f}^{\\mathrm{aligned}} \\equiv \\sum_{k=1}^{4} \\left(-\\bar{f}_{f,k}\\right) A_{f},\n$$\n这样在精确算术中 $\\Phi_{c}^{\\mathrm{corr}} = \\Phi_{f}^{\\mathrm{aligned}}$。实际上，我们可以将 $R$ 计算为\n$$\nR = \\Phi_{c}^{\\mathrm{corr}} - \\Phi_{f}^{\\mathrm{aligned}}.\n$$\n\n我们现在根据数据计算必要的平均值和面积。给定的面积为 $A_{c} = 4.0\\times 10^{-2}\\,\\mathrm{m}^{2}$ 和 $A_{f} = 1.0\\times 10^{-2}\\,\\mathrm{m}^{2}$。在粗网格时间步内的细网格面时间平均通量密度为\n$$\n\\bar{f}_{f,1} = \\frac{1}{2}\\left(7.10 + 7.30\\right) = 7.20\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1},\n$$\n$$\n\\bar{f}_{f,2} = \\frac{1}{2}\\left(7.70 + 7.90\\right) = 7.80\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1},\n$$\n$$\n\\bar{f}_{f,3} = \\frac{1}{2}\\left(7.30 + 7.50\\right) = 7.40\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1},\n$$\n$$\n\\bar{f}_{f,4} = \\frac{1}{2}\\left(7.50 + 7.70\\right) = 7.60\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}.\n$$\n细网格面通量密度的面积加权和为\n$$\n\\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f} = \\left(7.20 + 7.80 + 7.40 + 7.60\\right)\\times \\left(1.0\\times 10^{-2}\\right)\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}.\n$$\n计算括号内的和：\n$$\n7.20 + 7.80 + 7.40 + 7.60 = 30.00,\n$$\n因此\n$$\n\\Phi_{f} \\equiv \\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f} = 30.00 \\times \\left(1.0\\times 10^{-2}\\right) = 3.0\\times 10^{-1}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}.\n$$\n将细网格通量与粗网格面法向对齐（因为报告的细网格通量密度与粗网格法向相反），我们有\n$$\n\\Phi_{f}^{\\mathrm{aligned}} = -\\,\\Phi_{f} = -\\,3.0\\times 10^{-1}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}.\n$$\n\n根据守恒约束，修正后的粗网格面时间平均通量密度为\n$$\nf_{c}^{\\mathrm{corr}} = -\\,\\frac{1}{A_{c}} \\sum_{k=1}^{4} \\bar{f}_{f,k} A_{f} = -\\,\\frac{\\Phi_{f}}{A_{c}}.\n$$\n使用数值计算，\n$$\nf_{c}^{\\mathrm{corr}} = -\\,\\frac{3.0\\times 10^{-1}}{4.0\\times 10^{-2}} = -\\,7.5\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}.\n$$\n负号反映了粗网格面的外法向量从粗网格指向细网格，而细网格面的平均值是按相反的法向报告的；因此，在粗网格面法向方向上，$f_{c}^{\\mathrm{corr}}$ 的量值为 $7.5\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，方向从粗网格单元指向细网格区域，这与数据一致。相应的在一个粗网格时间步内修正后的面积分粗网格通量是\n$$\n\\Phi_{c}^{\\mathrm{corr}} \\equiv f_{c}^{\\mathrm{corr}} A_{c} = \\left(-\\,7.5\\right)\\times \\left(4.0\\times 10^{-2}\\right) = -\\,3.0\\times 10^{-1}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}.\n$$\n\n最后，计算守恒残差\n$$\nR = \\Phi_{c}^{\\mathrm{corr}} - \\Phi_{f}^{\\mathrm{aligned}}.\n$$\n当 $\\Phi_{c}^{\\mathrm{corr}} = -\\,3.0\\times 10^{-1}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 且 $\\Phi_{f}^{\\mathrm{aligned}} = -\\,3.0\\times 10^{-1}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 时，我们得到\n$$\nR = \\left(-\\,3.0\\times 10^{-1}\\right) - \\left(-\\,3.0\\times 10^{-1}\\right) = 0.\n$$\n\n因此，精确算术得到 $R=0$，证明了在通量修正后，粗细网格界面上是守恒的。以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 表示并四舍五入到八位有效数字，结果仍然是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3328267"}]}