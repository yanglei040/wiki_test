{"hands_on_practices": [{"introduction": "这项练习是在湍流结构的普适性无量纲描述与特定物理流动中其具体表现之间架起一座基础的桥梁。通过从近壁条带的经典壁面单位维度计算其物理间距 [@problem_id:3299862]，您将在应用摩擦雷诺数和粘性标度化概念方面获得具体经验，从而能够解释和预测真实或模拟槽道流中的特征。这个练习能帮助您将抽象的理论尺度与可测量的物理量直接联系起来。", "problem": "考虑一个在两块间距为 $2\\delta$ 的无限大平行平板之间的统计定常、充分发展的不可压缩湍流平面槽道流，其中半槽高为 $\\delta$。设流体的密度为 $\\rho$，运动粘度为 $\\nu$。摩擦速度 $u_{\\tau}$ 定义为 $u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是平均壁面剪切应力。粘性长度尺度为 $\\ell_{\\nu}=\\nu/u_{\\tau}$，任何长度 $l$ 用壁面（粘性）单位表示为 $l^{+}=l/\\ell_{\\nu}=l\\,u_{\\tau}/\\nu$。摩擦雷诺数定义为 $Re_{\\tau}=u_{\\tau}\\,\\delta/\\nu$。对于近壁条带，假设其以粘性单位计的典型展向间距为 $\\lambda_{z}^{+}\\approx 100$。\n\n已知 $\\rho=1.225\\,\\text{kg}\\,\\text{m}^{-3}$，$\\nu=1.5\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，$\\delta=0.05\\,\\text{m}$，以及 $Re_{\\tau}=1000$，求相应的物理展向条带间距 $\\lambda_{z}$（单位为米）。最终答案以米为单位表示，并四舍五入到四位有效数字。", "solution": "问题陈述已经过严格审查，并被确定是有效的。其科学基础是湍流流体动力学原理，特别是关于壁湍流的研究。该问题是适定的，为求得唯一解提供了所有必要的定义和数据。给定的数值在物理上是现实且一致的。该问题是客观和正式的，没有任何歧义或矛盾。\n\n目标是计算湍流平面槽道流中近壁条带的物理展向间距，记为 $\\lambda_{z}$。\n\n我们已知以下定义和数值：\n- 半槽高: $\\delta = 0.05\\,\\text{m}$\n- 运动粘度: $\\nu = 1.5 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n- 摩擦雷诺数: $Re_{\\tau} = 1000$\n- 以粘性（壁面）单位计的典型展向间距: $\\lambda_{z}^{+} \\approx 100$\n\n物理长度 $l$ 与其壁面单位表示 $l^{+}$ 之间的关系由粘性长度尺度 $\\ell_{\\nu} = \\nu/u_{\\tau}$ 的定义给出，其中 $u_{\\tau}$ 是摩擦速度。具体而言：\n$$l^{+} = \\frac{l}{\\ell_{\\nu}} = \\frac{l u_{\\tau}}{\\nu}$$\n将此定义应用于展向条带间距 $\\lambda_{z}$，我们得到：\n$$\\lambda_{z}^{+} = \\frac{\\lambda_{z} u_{\\tau}}{\\nu}$$\n为了求出物理间距 $\\lambda_{z}$，我们可以重新整理此方程：\n$$\\lambda_{z} = \\frac{\\lambda_{z}^{+} \\nu}{u_{\\tau}}$$\n摩擦速度 $u_{\\tau}$ 没有直接给出。然而，我们可以使用摩擦雷诺数 $Re_{\\tau}$ 的定义来确定它：\n$$Re_{\\tau} = \\frac{u_{\\tau} \\delta}{\\nu}$$\n这个定义在我们需要的参数之间提供了一个直接关系。不直接解出 $u_{\\tau}$，更简洁的方法是解出 $\\frac{u_{\\tau}}{\\nu}$ 这一项：\n$$\\frac{u_{\\tau}}{\\nu} = \\frac{Re_{\\tau}}{\\delta}$$\n现在，我们可以将此表达式代回关于 $\\lambda_{z}$ 的方程中：\n$$\\lambda_{z} = \\frac{\\lambda_{z}^{+}}{\\left(\\frac{u_{\\tau}}{\\nu}\\right)} = \\frac{\\lambda_{z}^{+}}{\\left(\\frac{Re_{\\tau}}{\\delta}\\right)}$$\n化简此表达式可得到最终的符号解：\n$$\\lambda_{z} = \\frac{\\lambda_{z}^{+} \\delta}{Re_{\\tau}}$$\n这个结果表明，物理条带间距 $\\lambda_{z}$ 与半槽高 $\\delta$ 和无量纲条带间距 $\\lambda_{z}^{+}$ 成正比，与摩擦雷诺数 $Re_{\\tau}$ 成反比。流体性质 $\\rho$ 和 $\\nu$ 已被隐含地包含在 $Re_{\\tau}$ 的定义中。注意，提供的密度值 $\\rho = 1.225\\,\\text{kg}\\,\\text{m}^{-3}$ 对于此计算不是必需的，因为该问题是以运动学变量来表述的。\n\n现在我们可以将给定的数值代入推导出的方程。我们将使用典型值 $\\lambda_{z}^{+} = 100$。\n- $\\lambda_{z}^{+} = 100$\n- $\\delta = 0.05\\,\\text{m}$\n- $Re_{\\tau} = 1000$\n\n$$\\lambda_{z} = \\frac{100 \\times 0.05\\,\\text{m}}{1000} = \\frac{5\\,\\text{m}}{1000} = 0.005\\,\\text{m}$$\n问题要求最终答案四舍五入到四位有效数字。计算值 $0.005\\,\\text{m}$ 只有一位有效数字。为了用四位有效数字表示，我们在后面补零：$0.005000\\,\\text{m}$。", "answer": "$$\\boxed{0.005000}$$", "id": "3299862"}, {"introduction": "这项练习建立在壁面单位标度化的原则之上，深入到计算流体动力学模拟设计的实践领域。您将把基本的数值稳定性约束——即 Courant–Friedrichs–Lewy (CFL) 条件和粘性扩散限制——从物理单位转换到优雅且普适的壁面单位框架中 [@problem_id:3299790]。这项实践对于理解如何设置稳定高效的直接数值模拟 (DNS) 或大涡模拟 (LES) 至关重要，因为在这些模拟中，分辨率要求是由流动物理本身决定的。", "problem": "考虑一个不可压缩的牛顿流体平面槽道流，其半槽道高度为 $\\delta$，运动粘度为 $\\nu$。该流动在均匀的笛卡尔网格上使用显式时间积分格式进行模拟，网格间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$，时间步长为 $\\Delta t$。摩擦雷诺数指定为 $Re_{\\tau}$，定义为 $Re_{\\tau} = u_{\\tau} \\delta / \\nu$，其中 $u_{\\tau}$ 是摩擦速度。设该显式格式的稳定性限制由两个标准界限控制：Courant–Friedrichs–Lewy (CFL) 对流约束和粘性扩散约束，以物理单位表示的对流界限形式如下\n$$\n\\max_{\\Omega}\\left(\\frac{|u|\\,\\Delta t}{\\Delta x} + \\frac{|v|\\,\\Delta t}{\\Delta y} + \\frac{|w|\\,\\Delta t}{\\Delta z}\\right) \\leq C_{\\mathrm{CFL}},\n$$\n以及形式为\n$$\n\\nu \\Delta t \\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}\\right) \\leq C_{\\nu},\n$$\n的粘性界限，其中 $C_{\\mathrm{CFL}}$ 和 $C_{\\nu}$ 是给定的、与格式相关的常数，$(u,v,w)$ 是速度分量。\n\n从摩擦速度 $u_{\\tau}$ 和摩擦雷诺数 $Re_{\\tau}$ 的基本定义，以及通过 $x^{+} = x u_{\\tau}/\\nu$ 和 $t^{+} = t u_{\\tau}^{2}/\\nu$ 定义的壁面单位概念出发，推导以壁面单位表示的对流和粘性稳定性约束。然后，对于以下科学上符合实际的参数，\n- $Re_{\\tau} = 395$，\n- $\\delta = 1.00 \\times 10^{-2}\\,\\text{m}$，\n- $\\nu = 1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}$，\n- $\\Delta x = 5.00 \\times 10^{-4}\\,\\text{m}$，$\\Delta y = 1.00 \\times 10^{-4}\\,\\text{m}$，$\\Delta z = 5.00 \\times 10^{-4}\\,\\text{m}$，\n- $\\Delta t = 1.00 \\times 10^{-4}\\,\\text{s}$，\n- $C_{\\mathrm{CFL}} = 0.5$，$C_{\\nu} = 0.2$，\n- 当前步长下域上的瞬时最大值：$\\max_{\\Omega}|u| = 0.70\\,\\text{m/s}$，$\\max_{\\Omega}|v| = 0.10\\,\\text{m/s}$，$\\max_{\\Omega}|w| = 0.30\\,\\text{m/s}$，\n计算壁面单位的间距和时间步长 $(\\Delta x^{+}, \\Delta y^{+}, \\Delta z^{+}, \\Delta t^{+})$。将您的最终数值答案表示为一个行向量，并将每个条目四舍五入到四位有效数字。这些条目是无量纲的，应不带单位报告。", "solution": "该问题是有效的，因为它在科学上基于计算流体动力学的原理，是适定且客观的。它包含了获得唯一解所需的所有信息，并且不违反任何物理定律或数学逻辑。\n\n该问题需要一个包含两部分的解答：首先，推导以壁面单位表示的稳定性约束；其次，对于一组给定的物理参数，计算以壁面单位表示的特定网格和时间步长参数。\n\n**第1部分：以壁面单位推导稳定性约束**\n\n壁面单位的归一化由摩擦速度 $u_{\\tau}$ 和运动粘度 $\\nu$ 定义。物理单位中的任何长度尺度 $L$、时间尺度 $T$ 和速度尺度 $U$ 都通过以下关系与其对应的壁面单位量（$L^{+}$、$T^{+}$、$U^{+}$）相关联：\n$$L^{+} = \\frac{L u_{\\tau}}{\\nu}, \\quad T^{+} = \\frac{T u_{\\tau}^{2}}{\\nu}, \\quad U^{+} = \\frac{U}{u_{\\tau}}$$\n根据这些定义，我们可以用壁面单位量来表示物理量：\n$$L = \\frac{L^{+} \\nu}{u_{\\tau}}, \\quad T = \\frac{T^{+} \\nu}{u_{\\tau}^{2}}, \\quad U = U^{+} u_{\\tau}$$\n这些关系既适用于变量，也适用于微分/有限差分元。具体来说，对于我们的网格间距（$\\Delta x, \\Delta y, \\Delta z$）、时间步长（$\\Delta t$）和速度分量（$u, v, w$），我们有：\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}}, \\quad \\Delta y = \\frac{\\Delta y^{+} \\nu}{u_{\\tau}}, \\quad \\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta t = \\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}$$\n$$u = u^{+} u_{\\tau}, \\quad v = v^{+} u_{\\tau}, \\quad w = w^{+} u_{\\tau}$$\n\n现在，我们变换每个稳定性约束。\n\n**对流 (CFL) 约束：**\n以物理单位表示的约束是：\n$$ \\max_{\\Omega}\\left(\\frac{|u|\\,\\Delta t}{\\Delta x} + \\frac{|v|\\,\\Delta t}{\\Delta y} + \\frac{|w|\\,\\Delta t}{\\Delta z}\\right) \\leq C_{\\mathrm{CFL}} $$\n我们将物理量的表达式用其对应的壁面单位量代入。对于括号内的第一项：\n$$ \\frac{|u|\\,\\Delta t}{\\Delta x} = \\frac{|u^{+} u_{\\tau}| \\left(\\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}\\right)}{\\left(\\frac{\\Delta x^{+} \\nu}{u_{\\tau}}\\right)} = \\frac{|u^{+}| u_{\\tau} \\Delta t^{+} \\nu}{u_{\\tau}^{2}} \\cdot \\frac{u_{\\tau}}{\\Delta x^{+} \\nu} = \\frac{|u^{+}| \\Delta t^{+}}{\\Delta x^{+}} \\frac{u_{\\tau}^{2} \\nu}{u_{\\tau}^{2} \\nu} = \\frac{|u^{+}| \\Delta t^{+}}{\\Delta x^{+}} $$\n另外两项的变换是相同的。因此，以壁面单位表示的对流约束是：\n$$ \\max_{\\Omega}\\left(\\frac{|u^{+}|\\,\\Delta t^{+}}{\\Delta x^{+}} + \\frac{|v^{+}|\\,\\Delta t^{+}}{\\Delta y^{+}} + \\frac{|w^{+}|\\,\\Delta t^{+}}{\\Delta z^{+}}\\right) \\leq C_{\\mathrm{CFL}} $$\n这可以更紧凑地写为：\n$$ \\Delta t^{+} \\max_{\\Omega}\\left(\\frac{|u^{+}|}{\\Delta x^{+}} + \\frac{|v^{+}|}{\\Delta y^{+}} + \\frac{|w^{+}|}{\\Delta z^{+}}\\right) \\leq C_{\\mathrm{CFL}} $$\n\n**粘性扩散约束：**\n以物理单位表示的约束是：\n$$ \\nu \\Delta t \\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}\\right) \\leq C_{\\nu} $$\n代入 $\\Delta t$、$\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的表达式：\n$$ \\nu \\left(\\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}\\right) \\left(\\frac{1}{\\left(\\frac{\\Delta x^{+} \\nu}{u_{\\tau}}\\right)^{2}} + \\frac{1}{\\left(\\frac{\\Delta y^{+} \\nu}{u_{\\tau}}\\right)^{2}} + \\frac{1}{\\left(\\frac{\\Delta z^{+} \\nu}{u_{\\tau}}\\right)^{2}}\\right) \\leq C_{\\nu} $$\n$$ \\frac{\\nu^2 \\Delta t^{+}}{u_{\\tau}^{2}} \\left(\\frac{u_{\\tau}^{2}}{(\\Delta x^{+})^{2} \\nu^2} + \\frac{u_{\\tau}^{2}}{(\\Delta y^{+})^{2} \\nu^2} + \\frac{u_{\\tau}^{2}}{(\\Delta z^{+})^{2} \\nu^2}\\right) \\leq C_{\\nu} $$\n从括号中提出公因子 $\\frac{u_{\\tau}^{2}}{\\nu^2}$：\n$$ \\frac{\\nu^2 \\Delta t^{+}}{u_{\\tau}^{2}} \\frac{u_{\\tau}^{2}}{\\nu^2} \\left(\\frac{1}{(\\Delta x^{+})^{2}} + \\frac{1}{(\\Delta y^{+})^{2}} + \\frac{1}{(\\Delta z^{+})^{2}}\\right) \\leq C_{\\nu} $$\n所有的物理参数都相互抵消，得到以壁面单位表示的粘性约束：\n$$ \\Delta t^{+} \\left(\\frac{1}{(\\Delta x^{+})^{2}} + \\frac{1}{(\\Delta y^{+})^{2}} + \\frac{1}{(\\Delta z^{+})^{2}}\\right) \\leq C_{\\nu} $$\n\n**第2部分：数值计算**\n\n问题的第二部分是计算壁面单位间距和时间步长 $(\\Delta x^{+}, \\Delta y^{+}, \\Delta z^{+}, \\Delta t^{+})$ 的数值。\n给定的参数是：\n- $Re_{\\tau} = 395$\n- $\\delta = 1.00 \\times 10^{-2}\\,\\text{m}$\n- $\\nu = 1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}$\n- $\\Delta x = 5.00 \\times 10^{-4}\\,\\text{m}$\n- $\\Delta y = 1.00 \\times 10^{-4}\\,\\text{m}$\n- $\\Delta z = 5.00 \\times 10^{-4}\\,\\text{m}$\n- $\\Delta t = 1.00 \\times 10^{-4}\\,\\text{s}$\n\n首先，我们根据摩擦雷诺数的定义 $Re_{\\tau} = u_{\\tau} \\delta / \\nu$ 计算摩擦速度 $u_{\\tau}$：\n$$ u_{\\tau} = \\frac{Re_{\\tau} \\nu}{\\delta} = \\frac{395 \\times (1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s})}{1.00 \\times 10^{-2}\\,\\text{m}} = 3.95 \\times 10^{-2}\\,\\text{m/s} $$\n现在我们可以计算以壁面单位表示的无量纲量。\n\n壁面单位间距 $\\Delta x^{+}$ 是：\n$$ \\Delta x^{+} = \\frac{\\Delta x u_{\\tau}}{\\nu} = \\frac{(5.00 \\times 10^{-4}\\,\\text{m}) \\times (3.95 \\times 10^{-2}\\,\\text{m/s})}{1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}} = 19.75 $$\n\n壁面单位间距 $\\Delta y^{+}$ 是：\n$$ \\Delta y^{+} = \\frac{\\Delta y u_{\\tau}}{\\nu} = \\frac{(1.00 \\times 10^{-4}\\,\\text{m}) \\times (3.95 \\times 10^{-2}\\,\\text{m/s})}{1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}} = 3.95 $$\n\n壁面单位间距 $\\Delta z^{+}$ 是：\n$$ \\Delta z^{+} = \\frac{\\Delta z u_{\\tau}}{\\nu} = \\frac{(5.00 \\times 10^{-4}\\,\\text{m}) \\times (3.95 \\times 10^{-2}\\,\\text{m/s})}{1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}} = 19.75 $$\n\n壁面单位时间步长 $\\Delta t^{+}$ 是：\n$$ \\Delta t^{+} = \\frac{\\Delta t u_{\\tau}^{2}}{\\nu} = \\frac{(1.00 \\times 10^{-4}\\,\\text{s}) \\times (3.95 \\times 10^{-2}\\,\\text{m/s})^{2}}{1.00 \\times 10^{-6}\\,\\text{m}^2/\\text{s}} = \\frac{1.00 \\times 10^{-4} \\times 1.56025 \\times 10^{-3}}{1.00 \\times 10^{-6}} = 0.156025 $$\n\n问题要求将每个值四舍五入到四位有效数字。\n- $\\Delta x^{+} = 19.75$\n- $\\Delta y^{+} = 3.950$\n- $\\Delta z^{+} = 19.75$\n- $\\Delta t^{+} = 0.1560$\n\n最终答案是这些值的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n19.75  3.950  19.75  0.1560\n\\end{pmatrix}\n}\n$$", "id": "3299790"}, {"introduction": "这最后一项练习将带您从分析走向创造，挑战您去实现一个壁面解析CFD模拟的关键组成部分：网格本身。您将使用一个常见的拉伸函数来设计壁面法向网格，并确保其满足以粘性单位指定的精确近壁分辨率要求 [@problem_id:3299893]。这个编程练习将巩固您对理论标度化要求如何转化为具体计算网格的理解，这是任何CFD从业者都需具备的基础技能。", "problem": "您的任务是为指定摩擦雷诺数下的不可压缩平面槽道流设计一个壁面法向网格。目标是强制施加所需的近壁粘性单位间距，并计算由此产生的直至槽道中心线的粘性单位间距分布。最终结果必须由一个完整且可运行的程序生成。\n\n使用的基本原理和定义：\n- 平面槽道流的计算流体动力学 (CFD) 模拟通常使用摩擦雷诺数（记为 $Re_\\tau$），其定义为 $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$，其中 $u_\\tau$ 是摩擦速度，$h$ 是槽道半高，$\\nu$ 是运动粘度。\n- 粘性单位壁面法向间距（记为 $\\Delta y^+$）定义为 $\\Delta y^+ = \\dfrac{u_\\tau \\Delta y}{\\nu}$。\n- 使用 $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$，通过粘性长度尺度对壁面法向间距进行无量纲化，可得到关系式 $\\Delta y^+ = Re_\\tau \\dfrac{\\Delta y}{h}$。\n\n设计要求：\n- 使用双曲正弦拉伸律在半槽道 $y \\in [0,h]$ 上构建一个单参数、严格单调的壁面法向网格映射\n$$\ny(\\eta;\\beta) = h\\,\\frac{\\sinh(\\beta\\,\\eta)}{\\sinh(\\beta)} \\quad \\text{for} \\quad \\eta \\in [0,1], \\ \\beta \\ge 0,\n$$\n其中 $\\eta$ 是 $[0,1]$ 上的计算坐标，$\\beta$ 是待定的拉伸参数，以满足所需的近壁间距约束。当 $\\beta \\to 0$ 时，该映射是均匀的；随着 $\\beta$ 的增大，网格越来越向壁面聚集。设半槽道在 $\\eta$ 方向上被离散为 $N_y$ 个均匀区间，即 $\\eta_j = \\dfrac{j}{N_y}$，其中 $j = 0,1,\\dots,N_y$。定义物理位置 $y_j = y(\\eta_j;\\beta)$ 并设间距 $\\Delta y_j = y_j - y_{j-1}$，其中 $j = 1,2,\\dots,N_y$。此时粘性单位间距为\n$$\n\\Delta y_j^+ = Re_\\tau\\,\\frac{\\Delta y_j}{h}.\n$$\n\n需要满足的约束：\n- 给定最大区间数 $N_y$ 和所需第一个单元的粘性单位间距 $\\Delta y_1^+$，选择满足以下条件的拉伸参数 $\\beta$：\n$$\nRe_\\tau\\,\\frac{y\\left(\\tfrac{1}{N_y};\\beta\\right) - y(0;\\beta)}{h} = \\Delta y_1^+,\n$$\n该式可简化为标量方程\n$$\nRe_\\tau\\,\\frac{\\sinh\\!\\left(\\tfrac{\\beta}{N_y}\\right)}{\\sinh(\\beta)} = \\Delta y_1^+.\n$$\n可行性由比率 $\\dfrac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)}$ 的单调行为决定：当 $\\beta \\to 0$ 时，该比率趋近于 $\\dfrac{1}{N_y}$；当 $\\beta \\to \\infty$ 时，该比率趋近于 $0$。因此，当且仅当 $0  \\Delta y_1^+ \\le \\dfrac{Re_\\tau}{N_y}$ 时，目标是可行的。均匀网格边界情况 $\\Delta y_1^+ = \\dfrac{Re_\\tau}{N_y}$ 对应于 $\\beta = 0$，并得出对于所有 $j$ 都有 $\\Delta y_j^+ \\equiv \\dfrac{Re_\\tau}{N_y}$。\n\n任务：\n1. 在具有 $N_y$ 个区间的半槽道上实现双曲正弦拉伸律，并在可行的情况下，确定强制施加所需第一个单元粘性间距 $\\Delta y_1^+$ 的参数 $\\beta \\ge 0$。\n2. 计算从壁面到中心线的完整分布 $\\left[\\Delta y_1^+,\\Delta y_2^+,\\dots,\\Delta y_{N_y}^+\\right]$。\n3. 如果所需的 $\\Delta y_1^+$ 不可行，则为该测试用例输出一个布尔值以表示其不可行。\n\n科学真实性要求：\n- 将 $\\Delta y^+$ 视为无量纲；输出中无需物理单位。\n- 算法必须能稳健地处理均匀网格边界情况（即 $\\beta = 0$）并检测不可行的目标。\n\n测试套件：\n- 使用以下测试用例，每个用例表示为一个元组 $(Re_\\tau, N_y, \\Delta y_1^+)$：\n    - 用例 A (理想路径): $(180, 64, 0.5)$。\n    - 用例 B (均匀网格边界): $\\left(180, 64, \\dfrac{180}{64}\\right)$。\n    - 用例 C (不可行的目标): $(180, 64, 3.0)$。\n    - 用例 D (中等偏高的摩擦雷诺数): $(550, 192, 0.2)$。\n    - 用例 E (强壁面聚集): $(1000, 256, 0.05)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起的逗号分隔列表。\n- 对于可行用例，输出完整的粘性单位间距分布 $\\left[\\Delta y_1^+,\\Delta y_2^+,\\dots,\\Delta y_{N_y}^+\\right]$，并四舍五入到六位小数。\n- 对于不可行用例，输出布尔值 $False$ 来代替分布。\n- 示例结构：$[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C},\\text{result\\_D},\\text{result\\_E}]$，其中每个 $\\text{result\\_X}$ 要么是四舍五入后的浮点数列表，要么是 $False$。", "solution": "该问题要求为平面槽道流模拟设计一个一维壁面法向网格。该设计必须遵守特定的双曲正弦拉伸律，并满足对邻近壁面的第一个网格单元的粘性单位间距的约束。我们将首先验证问题的提法，然后开发一个计算算法来为所提供的测试用例求解。\n\n该问题具有充分的科学依据，属于计算流体动力学 (CFD) 中处理湍流壁面束缚流的标准实践范畴。所提供的定义，如摩擦雷诺数 $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$ 和粘性单位间距 $\\Delta y^+ = \\dfrac{u_\\tau \\Delta y}{\\nu}$，都是该领域的基本概念。使用双曲拉伸函数 $y(\\eta;\\beta)$ 是在速度梯度陡峭的固体边界附近聚集网格点的常用技术。该问题在数学上是适定的，提供了明确的目标、所有必要的方程和一个明确定义的可行性条件。其中没有矛盾、歧义或事实错误。因此，该问题被认为是有效的，并将构建一个解决方案。\n\n解决过程分为三个主要步骤：\n1.  验证所要求的近壁间距的可行性。\n2.  通过求解一个非线性标量方程来确定拉伸参数 $\\beta$。\n3.  使用确定的 $\\beta$ 计算完整的粘性单位间距分布 $[\\Delta y_1^+, \\Delta y_2^+, \\dots, \\Delta y_{N_y}^+]$。\n\n**1. 可行性分析**\n\n第一个单元的粘性间距 $\\Delta y_1^+$ 与拉伸参数 $\\beta$ 之间的关系由以下方程给出：\n$$\nRe_\\tau\\,\\frac{\\sinh\\!\\left(\\frac{\\beta}{N_y}\\right)}{\\sinh(\\beta)} = \\Delta y_1^+\n$$\n让我们分析函数 $f(\\beta) = \\dfrac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)}$ 在 $\\beta \\ge 0$ 时的行为。\n对于小的 $x$，使用泰勒级数展开 $\\sinh(x) \\approx x$，当 $\\beta \\to 0$ 时的极限为：\n$$\n\\lim_{\\beta \\to 0} f(\\beta) = \\lim_{\\beta \\to 0} \\frac{\\beta/N_y}{\\beta} = \\frac{1}{N_y}\n$$\n这对应于一个均匀网格，其中 $N_y$ 个单元每个的厚度为 $\\Delta y = h/N_y$，从而得到一个恒定的粘性间距 $\\Delta y^+ = Re_\\tau (h/N_y)/h = Re_\\tau/N_y$。\n对于大的 $\\beta$，使用当 $x > 0$ 时的渐近行为 $\\sinh(x) \\approx \\frac{1}{2}e^x$：\n$$\n\\lim_{\\beta \\to \\infty} f(\\beta) = \\lim_{\\beta \\to \\infty} \\frac{\\frac{1}{2}e^{\\beta/N_y}}{\\frac{1}{2}e^{\\beta}} = \\lim_{\\beta \\to \\infty} e^{\\beta(1/N_y - 1)} = 0 \\quad (\\text{since } N_y \\ge 1)\n$$\n函数 $f(\\beta)$ 在 $\\beta > 0$ 时是单调递减的。因此，为了使方程有 $\\beta \\ge 0$ 的解，比率的目标值 $\\Delta y_1^+ / Re_\\tau$ 必须位于区间 $(0, 1/N_y]$ 内。这给出了问题中所述的可行性条件：\n$$\n0  \\Delta y_1^+ \\le \\frac{Re_\\tau}{N_y}\n$$\n如果一个给定的目标 $\\Delta y_1^+$ 违反此条件，则不存在实数 $\\beta \\ge 0$，该网格规格是不可行的。\n\n**2. 拉伸参数 $\\beta$ 的确定**\n\n对于一个可行的目标 $\\Delta y_1^+$，我们必须求解 $\\beta$。\n- 如果 $\\Delta y_1^+ = Re_\\tau/N_y$，则网格是均匀的，这对应于边界情况 $\\beta=0$。\n- 如果 $0  \\Delta y_1^+  Re_\\tau/N_y$，我们必须找到以下非线性超越方程的唯一正根 $\\beta > 0$：\n$$\ng(\\beta) = \\frac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)} - \\frac{\\Delta y_1^+}{Re_\\tau} = 0\n$$\n这是一个求根问题。鉴于函数 $g(\\beta)$ 在 $\\beta \\in (0, \\infty)$ 上是单调的，并且 $g(\\beta \\to 0^+) > 0$ 和 $g(\\beta \\to \\infty)  0$，因此保证存在唯一的根。可以使用数值算法（如 Brent 方法）高效地找到这个根，该方法在 `SciPy` 等科学计算库中可用。我们将把 $\\beta$ 的搜索范围限定在一个合适的区间内，例如 $[10^{-9}, 200]$，以确保求解器能找到正根。\n\n**3. 间距分布的计算**\n\n一旦确定了 $\\beta$，我们就可以计算粘性单位间距的整个分布 $\\Delta y_j^+$，其中 $j=1, \\dots, N_y$。第 $j$ 个网格点的物理位置是 $y_j = y(\\eta_j;\\beta)$，其中 $\\eta_j = j/N_y$。使用无量纲坐标 $\\tilde{y} = y/h$ 会更方便。\n$$\n\\tilde{y}_j = \\frac{y_j}{h} = \\frac{\\sinh(\\beta\\eta_j)}{\\sinh(\\beta)} = \\frac{\\sinh(\\beta j / N_y)}{\\sinh(\\beta)}\n$$\n第 $j$ 个单元的无量纲间距是 $\\Delta\\tilde{y}_j = \\tilde{y}_j - \\tilde{y}_{j-1}$。那么粘性单位间距就是 $\\Delta y_j^+ = Re_\\tau \\Delta\\tilde{y}_j$。\n$$\n\\Delta y_j^+ = Re_\\tau \\left( \\frac{\\sinh(\\beta j / N_y) - \\sinh(\\beta (j-1) / N_y)}{\\sinh(\\beta)} \\right)\n$$\n对于 $\\beta=0$ 的情况，这简化为对所有 $j$ 均成立的均匀间距 $\\Delta y_j^+ = Re_\\tau/N_y$。\n\n为了数值稳健性，特别是当 $\\beta$ 很大时，$\\tilde{y}_j$ 的计算可以重写以避免 $\\sinh$ 函数中的溢出。恒等式 $\\sinh(x) = (e^x - e^{-x})/2$ 导致：\n$$\n\\frac{\\sinh(A)}{\\sinh(B)} = \\frac{e^A - e^{-A}}{e^B - e^{-B}} = e^{A-B} \\frac{1 - e^{-2A}}{1 - e^{-2B}}\n$$\n将此应用于 $A = \\beta j/N_y$ 和 $B = \\beta$，我们得到一个对于所有 $\\beta > 0$ 都数值稳定的形式：\n$$\n\\tilde{y}_j = e^{\\beta(j/N_y - 1)} \\frac{1 - e^{-2\\beta j/N_y}}{1 - e^{-2\\beta}}\n$$\n算法的步骤是首先使用这个稳健的公式（如果 $\\beta=0$，则使用 $\\tilde{y}_j = j/N_y$）为 $j=0, \\dots, N_y$ 生成一个物理位置数组 $\\tilde{y}_j$。然后，通过取相邻位置的差值 $\\Delta\\tilde{y}_j = \\tilde{y}_j - \\tilde{y}_{j-1}$ 来计算间距。最后，将这些间距乘以 $Re_\\tau$ 以获得所需的分布 $\\Delta y_j^+$。收集每个测试用例的结果，不可行的用例用布尔值 `False` 表示。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes a wall-normal grid spacing distribution for channel flow.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        (180, 64, 0.5),\n        # Case B (uniform-grid boundary)\n        (180, 64, 180.0/64.0),\n        # Case C (infeasible target)\n        (180, 64, 3.0),\n        # Case D (moderately high friction Reynolds number)\n        (550, 192, 0.2),\n        # Case E (strong wall clustering)\n        (1000, 256, 0.05),\n    ]\n\n    results = []\n    \n    # Machine precision for small number comparisons\n    TOL = np.finfo(float).eps * 100\n\n    for case in test_cases:\n        Re_tau, Ny, dy1_plus_target = case\n        Ny = int(Ny) # Ensure Ny is an integer\n\n        # Step 1: Feasibility Check\n        uniform_limit = Re_tau / Ny\n        if not (0  dy1_plus_target = uniform_limit + TOL):\n            results.append(False)\n            continue\n\n        # Step 2: Determine stretching parameter beta\n        beta = 0.0\n        # Check for the uniform grid case with a tolerance\n        if np.isclose(dy1_plus_target, uniform_limit):\n            beta = 0.0\n        else:\n            target_ratio = dy1_plus_target / Re_tau\n            \n            def objective_func(b):\n                # This form can cause overflow for large b, but root_scalar is robust,\n                # and expected beta values are within float64's sinh range.\n                if b  TOL:\n                    # Taylor expansion for small b: (b/Ny) / b = 1/Ny\n                    return 1.0/Ny - target_ratio\n                return np.sinh(b / Ny) / np.sinh(b) - target_ratio\n            \n            # Use a robust bracketing solver. The root is guaranteed to be in (0, inf).\n            # The bracket [TOL, 300] is sufficient for practical cases.\n            try:\n                sol = root_scalar(objective_func, bracket=[TOL, 300], method='brentq')\n                if sol.converged:\n                    beta = sol.root\n                else:\n                    # Should not be reached with valid inputs\n                    results.append(False) \n                    continue\n            except ValueError:\n                # Occurs if signs at bracket endpoints are the same, implies no root in bracket\n                results.append(False)\n                continue\n\n        # Step 3: Compute the spacing distribution\n        eta = np.arange(Ny + 1) / Ny\n        y_norm = np.zeros(Ny + 1)\n\n        if beta  TOL:\n            # Uniform grid case\n            y_norm = eta\n        else:\n            # Numerically stable formula for y_norm for beta > 0\n            # y_norm = sinh(beta*eta) / sinh(beta)\n            # which is y_norm = exp(beta*(eta-1)) * (1-exp(-2*beta*eta))/(1-exp(-2*beta))\n            # The calculation is done for eta > 0. y_norm[0] is always 0.\n            # eta[0] is 0, so the expression correctly evaluates to 0 for the first point.\n            # To prevent divide-by-zero if somehow beta is large enough for the denominator to be 0\n            # (1-exp(-2*beta)) is only zero for beta=0, which is handled.\n            numerator = 1.0 - np.exp(-2.0 * beta * eta)\n            denominator = 1.0 - np.exp(-2.0 * beta)\n            prefactor = np.exp(beta * (eta - 1.0))\n            y_norm = prefactor * numerator / denominator\n\n        dy_norm = np.diff(y_norm)\n        dy_plus_dist = Re_tau * dy_norm\n        \n        # Round the final distribution\n        rounded_dist = [round(val, 6) for val in dy_plus_dist]\n        results.append(rounded_dist)\n\n    # Format the final output string as specified\n    string_results = []\n    for r in results:\n        if isinstance(r, bool):\n            string_results.append(str(r))\n        else:\n            # Format list of floats to \"[f1,f2,...,fN]\"\n            s = f\"[{','.join([f'{val:.6f}' for val in r])}]\"\n            string_results.append(s)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(string_results)}]\")\n\nsolve()\n```", "id": "3299893"}]}