{"hands_on_practices": [{"introduction": "任何计算流体动力学（CFD）模拟的基石都始于计算网格的构建和时间积分方案稳定性的保证。本练习将探讨网格各向异性（即在不同方向上具有不同间距的网格）对模拟的准确性和稳定性的影响，这在实际工程应用中十分常见。通过推导截断误差和显式黏性项的时间步长限制，您将把理论数值分析与实际模拟设置直接联系起来 [@problem_id:3340070]。", "problem": "考虑二维不可压缩Navier–Stokes方程，研究区域为一个边长为$L$的方形顶盖驱动腔，顶盖以均匀速度$U$沿$x$方向移动，所有壁面均为无滑移边界条件。采用标准的投影法来强制满足不可压缩性：一个显式的粘性更新步骤产生一个临时速度场，然后求解一个压力泊松问题将该场投影到无散子空间上。空间离散在均匀但各向异性的笛卡尔网格上采用二阶中心有限差分，网格间距为 $\\Delta x \\neq \\Delta y$，其中 $\\Delta x = L/N_{x}$ 和 $\\Delta y = L/N_{y}$，$N_{x}$ 和 $N_{y}$ 为给定的正整数。内部节点 $(i,j)$ 处标量场 $\\phi$ 的离散拉普拉斯算子定义为\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} \\equiv \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}}.\n$$\n从偏微分方程模型和上述离散算子出发，完成以下任务：\n\n(1) 推导离散拉普拉斯算子 $(\\nabla_{h}^{2}\\phi)_{i,j}$ 的主阶截断误差，用 $\\phi$ 的连续导数表示，并明确展示其对 $\\Delta x$ 和 $\\Delta y$ 的依赖关系。\n\n(2) 考虑应用于速度各分量的粘性项的显式前向欧拉更新，\n$$\n\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} + \\nu\\,\\Delta t\\,\\nabla_{h}^{2}\\boldsymbol{u}^{n},\n$$\n其中 $\\nu$ 是运动粘度，$\\Delta t$ 是时间步长。使用对腔壁上具有齐次狄利克雷边界条件的离散拉普拉斯算子进行的模态（特征值）分析，推导出一个依赖于 $\\Delta x$ 和 $\\Delta y$ 的 $\\Delta t$ 稳定性界限。解释各向异性（$\\Delta x \\neq \\Delta y$）如何影响这个界限。\n\n(3) 使用离散内积论证，证明为什么当使用相容的中心差分计算散度和梯度时，Helmholtz–Hodge投影步骤在适当的离散 $\\ell^{2}$ 范数下是非扩张的，因此不会对第(2)部分中推导出的显式粘性稳定性界限施加更严格的限制。\n\n最后，对于一个腔体，其参数为 $L = 0.1$ $\\mathrm{m}$，$N_{x} = 128$，$N_{y} = 64$，以及 $\\nu = 1.0 \\times 10^{-6}$ $\\mathrm{m}^{2}/\\mathrm{s}$，计算你在第(2)部分中推导的显式粘性更新的最大稳定时间步长 $\\Delta t$。用秒表示你的最终时间步长，并将答案四舍五入到四位有效数字。", "solution": "本问题探讨了不可压缩Navier-Stokes方程的有限差分格式的数值分析，重点关注截断误差、稳定性以及投影法的性质。我们将按顺序解决问题的每个部分。\n\n(1) 离散拉普拉斯算子的截断误差\n\n离散拉普拉斯算子 $(\\nabla_{h}^{2}\\phi)_{i,j}$ 的截断误差 $\\tau_{i,j}$ 定义为，作用于连续场 $\\phi(x,y)$ 的离散算子与作用于同一场的精确连续拉普拉斯算子在网格点 $(x_i, y_j)$ 处的值之差。\n$$\n\\tau_{i,j} = (\\nabla_{h}^{2}\\phi)_{i,j} - (\\nabla^{2}\\phi)(x_i, y_j)\n$$\n连续拉普拉斯算子为 $\\nabla^{2}\\phi = \\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\partial^{2}\\phi}{\\partial y^{2}}$。给定的离散拉普拉斯算子为\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} = \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}}\n$$\n为求截断误差，我们对 $\\phi_{i\\pm1, j}$ 和 $\\phi_{i, j\\pm1}$ 在点 $(x_i, y_j)$ 附近进行泰勒级数展开，假设 $\\phi$ 足够光滑。对于 $x$ 方向的导数，我们有：\n$$\n\\phi_{i+1,j} = \\phi(x_i+\\Delta x, y_j) = \\phi_{i,j} + \\Delta x\\frac{\\partial\\phi}{\\partial x} + \\frac{\\Delta x^{2}}{2!}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\Delta x^{3}}{3!}\\frac{\\partial^{3}\\phi}{\\partial x^{3}} + \\frac{\\Delta x^{4}}{4!}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{5})\n$$\n$$\n\\phi_{i-1,j} = \\phi(x_i-\\Delta x, y_j) = \\phi_{i,j} - \\Delta x\\frac{\\partial\\phi}{\\partial x} + \\frac{\\Delta x^{2}}{2!}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} - \\frac{\\Delta x^{3}}{3!}\\frac{\\partial^{3}\\phi}{\\partial x^{3}} + \\frac{\\Delta x^{4}}{4!}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{5})\n$$\n将这两个展开式相加，奇数阶导数项被消去：\n$$\n\\phi_{i+1,j} + \\phi_{i-1,j} = 2\\phi_{i,j} + \\Delta x^{2}\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{2\\Delta x^{4}}{24}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{6})\n$$\n整理此表达式以匹配离散导数的形式，得到：\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{\\Delta x^{2}} = \\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + O(\\Delta x^{4})\n$$\n对 $y$ 方向进行相同的分析，得到：\n$$\n\\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{\\Delta y^{2}} = \\frac{\\partial^{2}\\phi}{\\partial y^{2}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}} + O(\\Delta y^{4})\n$$\n将这些表达式代入离散拉普拉斯算子的定义中，我们得到：\n$$\n(\\nabla_{h}^{2}\\phi)_{i,j} = \\left(\\frac{\\partial^{2}\\phi}{\\partial x^{2}} + \\frac{\\partial^{2}\\phi}{\\partial y^{2}}\\right) + \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}} + O(\\Delta x^{4}, \\Delta y^{4})\n$$\n括号中的项是连续拉普拉斯算子 $\\nabla^{2}\\phi$。因此，主阶截断误差为：\n$$\n\\tau_{i,j} = \\frac{\\Delta x^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial x^{4}} + \\frac{\\Delta y^{2}}{12}\\frac{\\partial^{4}\\phi}{\\partial y^{2}}\n$$\n该离散格式在空间上是二阶精确的，其误差明确地依赖于网格间距 $\\Delta x$ 和 $\\Delta y$。\n\n(2) 显式粘性更新的稳定性界限\n\n显式前向欧拉格式 $\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} + \\nu\\,\\Delta t\\,\\nabla_{h}^{2}\\boldsymbol{u}^{n}$ 用于粘性项的稳定性，是通过考察离散误差模态的放大情况来分析的。该分析对每个速度分量都相同，因此我们考虑一个标量场 $u$。模态分析需要找到具有齐次狄利克雷边界条件的离散拉普拉斯算子 $\\nabla_{h}^{2}$ 的特征值。\n\n离散域上的一个特征模态可以写成 $u_{i,j} = \\sin(k_x x_i) \\sin(k_y y_j)$，其中 $x_i = i\\Delta x$ 且 $y_j = j\\Delta y$。波数为 $k_x = m\\pi/L$ 和 $k_y = p\\pi/L$，其中整数 $m \\in [1, N_x-1]$ 和 $p \\in [1, N_y-1]$。将离散拉普拉斯算子应用于此模态，得到：\n$$\n(\\nabla_{h}^{2}u)_{i,j} = \\left( \\frac{\\sin(k_x(i+1)\\Delta x) - 2\\sin(k_x i\\Delta x) + \\sin(k_x(i-1)\\Delta x)}{\\Delta x^2} \\right)\\sin(k_y j\\Delta y) + \\sin(k_x i\\Delta x)\\left( \\frac{\\sin(k_y(j+1)\\Delta y) - 2\\sin(k_y j\\Delta y) + \\sin(k_y(j-1)\\Delta y)}{\\Delta y^2} \\right)\n$$\n使用三角恒等式 $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$，$x$ 项的分子简化为 $2\\sin(k_x i\\Delta x)\\cos(k_x\\Delta x) - 2\\sin(k_x i\\Delta x) = 2\\sin(k_x i\\Delta x)(\\cos(k_x\\Delta x)-1)$。再利用半角公式 $\\cos(\\theta)-1 = -2\\sin^2(\\theta/2)$，此式变为 $-4\\sin(k_x i\\Delta x)\\sin^2(k_x\\Delta x/2)$。$y$ 项也得到类似的结果。\n因此，算子作用的结果为：\n$$\n(\\nabla_{h}^{2}u)_{i,j} = \\left[ -\\frac{4}{\\Delta x^2}\\sin^2\\left(\\frac{k_x\\Delta x}{2}\\right) - \\frac{4}{\\Delta y^2}\\sin^2\\left(\\frac{k_y\\Delta y}{2}\\right) \\right] u_{i,j}\n$$\n方括号中的表达式是对应于模态 $(m,p)$ 的特征值 $\\lambda_{m,p}$。将一个特征模态代入时间步进格式，得到 $u^{n+1} = (1 + \\nu\\Delta t \\lambda_{m,p})u^n$。放大因子为 $G = 1 + \\nu\\Delta t \\lambda_{m,p}$。为保证稳定性，我们需要 $|G| \\leq 1$，即 $-1 \\leq 1 + \\nu\\Delta t \\lambda_{m,p} \\leq 1$。\n对于任何非平凡模态，特征值 $\\lambda_{m,p}$ 都是严格为负的，所以 $G \\leq 1$ 的条件总是满足的。剩下的条件是 $-1 \\leq 1 + \\nu\\Delta t \\lambda_{m,p}$，这意味着 $\\nu\\Delta t \\lambda_{m,p} \\geq -2$，或 $\\Delta t \\leq \\frac{-2}{\\nu\\lambda_{m,p}}$。\n\n为确保对所有可能的模态都稳定，我们必须对具有最大绝对值的特征值（即最负的特征值，记为 $\\lambda_{min}$）满足此条件。这发生在网格能支持的最高频率模态，此时 $\\sin^2$ 项最大化。其参数为 $\\frac{k_x\\Delta x}{2} = \\frac{m\\pi}{L}\\frac{L/N_x}{2} = \\frac{m\\pi}{2N_x}$ 和 $\\frac{k_y\\Delta y}{2} = \\frac{p\\pi}{2N_y}$。$\\sin^2$ 的最大值为 $1$，当其参数趋近于 $\\pi/2$ 时达到。这对应于最高波数，$m=N_x-1$ 和 $p=N_y-1$，此时 $k_x \\approx \\pi/\\Delta x$ 和 $k_y \\approx \\pi/\\Delta y$。对于这些“最坏情况”的模态，$\\sin^2(k_x\\Delta x/2) \\approx 1$ 且 $\\sin^2(k_y\\Delta y/2) \\approx 1$。\n因此，最负的特征值近似为：\n$$\n\\lambda_{min} \\approx -\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta y^2}\n$$\n稳定性条件变为：\n$$\n\\Delta t \\leq \\frac{-2}{\\nu(-\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta y^2})} = \\frac{1}{2\\nu(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2})}\n$$\n各向异性（$\\Delta x \\neq \\Delta y$）直接进入这个界限中。稳定性极限由网格间距平方倒数之和决定。如果一个网格间距远小于另一个（例如 $\\Delta x \\ll \\Delta y$），则具有较小间距的项（$1/\\Delta x^2$）将主导总和，使时间步长的限制变得更加严苛。稳定性实际上由网格中最小的网格单元尺寸决定。\n\n(3) 投影步骤的非扩张性质\n\n投影步骤将临时速度场 $\\boldsymbol{u}^*$ 分解为一个无散部分 $\\boldsymbol{u}^{n+1}$ 和一个标量势 $\\phi$（与压力相关）的梯度，使得 $\\boldsymbol{u}^* = \\boldsymbol{u}^{n+1} + \\nabla_h \\phi$。根据构造，$\\nabla_h \\cdot \\boldsymbol{u}^{n+1} = 0$。问题是要证明该投影在离散 $\\ell^2$ 范数下是非扩张的，即 $\\|\\boldsymbol{u}^{n+1}\\|_2 \\leq \\|\\boldsymbol{u}^*\\|_2$。\n\n$\\ell^2$ 范数的平方通过内积定义，$\\|\\boldsymbol{v}\\|_2^2 = \\langle \\boldsymbol{v}, \\boldsymbol{v} \\rangle = \\sum_{i,j} \\boldsymbol{v}_{i,j} \\cdot \\boldsymbol{v}_{i,j} \\Delta x \\Delta y$。我们计算 $\\boldsymbol{u}^*$ 的范数平方：\n$$\n\\|\\boldsymbol{u}^*\\|^2 = \\langle \\boldsymbol{u}^{n+1} + \\nabla_h \\phi, \\boldsymbol{u}^{n+1} + \\nabla_h \\phi \\rangle = \\|\\boldsymbol{u}^{n+1}\\|^2 + 2\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle + \\|\\nabla_h \\phi\\|^2\n$$\n关键步骤是分析交叉项 $\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle$。利用分部求和的性质（即分部积分的离散模拟），并假设梯度（$\\nabla_h$）和散度（$\\nabla_h \\cdot$）的有限差分算子是相容的，内积可以被重写。对于满足负伴随关系 $\\langle \\boldsymbol{v}, \\nabla_h \\psi \\rangle = -\\langle \\nabla_h \\cdot \\boldsymbol{v}, \\psi \\rangle$ 的离散算子（在适当条件下边界项消失），我们有：\n$$\n\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle = -\\langle\\nabla_h \\cdot \\boldsymbol{u}^{n+1}, \\phi\\rangle\n$$\n根据投影的定义，所得的速度场 $\\boldsymbol{u}^{n+1}$ 是离散无散的，所以 $\\nabla_h \\cdot \\boldsymbol{u}^{n+1} = 0$。因此，内积为零：\n$$\n\\langle\\boldsymbol{u}^{n+1}, \\nabla_h \\phi\\rangle = 0\n$$\n这表明离散无散场空间和离散梯度场空间在此内积下是正交的。该分解是正交的。\n将此结果代回 $\\|\\boldsymbol{u}^*\\|^2$ 的表达式中，得到：\n$$\n\\|\\boldsymbol{u}^*\\|^2 = \\|\\boldsymbol{u}^{n+1}\\|^2 + \\|\\nabla_h \\phi\\|^2\n$$\n这是勾股定理的离散形式。由于范数的平方 $\\|\\nabla_h \\phi\\|^2$ 是非负的，直接可以得出：\n$$\n\\|\\boldsymbol{u}^{n+1}\\|^2 \\leq \\|\\boldsymbol{u}^*\\|^2\n$$\n对两边取平方根，我们发现 $\\|\\boldsymbol{u}^{n+1}\\|_2 \\leq \\|\\boldsymbol{u}^*\\|_2$。这证实了投影步骤是非扩张的。它不会放大速度场的范数。因此，整个格式的稳定性仅由显式粘性（以及如果存在的对流项）更新决定，投影步骤不施加任何额外的、更严格的稳定性约束。\n\n最终计算\n\n我们被要求计算给定参数下的最大稳定时间步长 $\\Delta t_{max}$。公式是：\n$$\n\\Delta t_{max} = \\frac{1}{2\\nu\\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2}\\right)}\n$$\n给定的值为 $L = 0.1\\,\\mathrm{m}$，$N_x = 128$，$N_y = 64$，以及 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$。\n首先，我们计算网格间距：\n$$\n\\Delta x = \\frac{L}{N_x} = \\frac{0.1\\,\\mathrm{m}}{128}\n$$\n$$\n\\Delta y = \\frac{L}{N_y} = \\frac{0.1\\,\\mathrm{m}}{64}\n$$\n接下来，我们计算间距平方的倒数：\n$$\n\\frac{1}{\\Delta x^2} = \\left(\\frac{128}{0.1}\\right)^2 = 1280^2 = 1,638,400\\,\\mathrm{m}^{-2}\n$$\n$$\n\\frac{1}{\\Delta y^2} = \\left(\\frac{64}{0.1}\\right)^2 = 640^2 = 409,600\\,\\mathrm{m}^{-2}\n$$\n它们的和是：\n$$\n\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} = 1,638,400 + 409,600 = 2,048,000\\,\\mathrm{m}^{-2}\n$$\n现在，我们将此值代入稳定性公式：\n$$\n\\Delta t_{max} = \\frac{1}{2(1.0 \\times 10^{-6}\\,\\mathrm{m^2/s})(2,048,000\\,\\mathrm{m}^{-2})} = \\frac{1}{2 \\times 10^{-6} \\times 2.048 \\times 10^{6}\\,\\mathrm{s}^{-1}} = \\frac{1}{4.096\\,\\mathrm{s}^{-1}}\n$$\n进行最后的除法运算：\n$$\n\\Delta t_{max} = 0.244140625\\,\\mathrm{s}\n$$\n按要求四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{max} \\approx 0.2441\\,\\mathrm{s}\n$$", "answer": "$$\\boxed{0.2441}$$", "id": "3340070"}, {"introduction": "在求解Navier-Stokes方程时，存在多种数学表述方法，其中流函数-涡量方法是二维流动问题的经典选择。此方法的一个核心挑战是涡量没有直接的物理边界条件，必须通过运动学关系从流函数中推导。本练习将引导您推导一个二阶精度的壁面涡量边界条件，深入了解数值边界条件是如何被构造出来以确保求解的整体精度与稳定性 [@problem_id:3340086]。", "problem": "考虑一个高度为 $H$ 的方形域中的二维不可压缩顶盖驱动方腔问题，该问题在两个方向上间距均为 $h$ 的均匀笛卡尔网格上进行离散化。使用不可压缩纳维-斯托克斯方程的流函数-涡量公式，其中流函数 $\\psi(x,y)$ 满足运动学关系 $u = \\partial \\psi / \\partial y$ 和 $v = - \\partial \\psi / \\partial x$，标量涡量 $\\omega(x,y)$ 定义为 $\\omega = \\partial v / \\partial x - \\partial u / \\partial y$。流函数-涡量的运动学约束为 $\\nabla^{2} \\psi = - \\omega$，在整个域内成立。在所有固壁上，无穿透条件意味着流函数沿壁面为常数；在顶盖 $y = H$ 上取 $\\psi = \\psi_{w}$。顶盖以恒定的切向速度 $U$ 沿 $x$ 方向移动，因此 $u(x,H) = U$ 且 $v(x,H) = 0$。\n\n设 $j$ 为 $y$ 方向的网格线索引，其中 $j = N$ 表示位于 $y = H$ 处的顶壁，$j = N - 1$ 表示位于 $y = H - h$ 处的第一条内部网格线，$j = N - 2$ 表示位于 $y = H - 2h$ 处的第二条内部网格线。类似地，设 $i$ 为 $x$ 方向的网格线索引。记 $\\psi_{i,N} = \\psi(x_{i},H)$，$\\psi_{i,N-1} = \\psi(x_{i},H-h)$，以及 $\\psi_{i,N-2} = \\psi(x_{i},H-2h)$。\n\n从上述基本定义出发，并使用在壁面法向方向上关于 $y = H$ 的泰勒展开，构建一个用于顶壁涡量 $\\omega_{i,N} = \\omega(x_{i},H)$ 的二阶精度离散边界条件，该条件用量 $\\psi_{i,N}$、$\\psi_{i,N-1}$、$\\psi_{i,N-2}$、网格间距 $h$ 和顶盖速度 $U$ 来表示。您的构建必须：\n\n- 仅使用定义 $u = \\partial \\psi / \\partial y$、$v = - \\partial \\psi / \\partial x$、$\\omega = \\partial v / \\partial x - \\partial u / \\partial y$ 和 $\\nabla^{2} \\psi = - \\omega$，以及光滑性（所需导数的存在性）。\n- 通过在壁面法向展开的泰勒级数余项中，显式地消去所有直到 $h$ 阶的项，以确保在 $h$ 上达到二阶相容性。\n- 解释在顶壁无穿透条件下为什么 $\\psi_{xx}(x,H) = 0$，以及这如何简化了壁面上 $\\omega$ 和 $\\psi$ 之间的关系。\n\n然后，通过从第一性原理出发阐述以下几点，分析您的边界条件对计算出的近壁面涡量的稳定性和影响：\n\n- 相容性：证明对于任何近壁面流向速度 $u(y)$ 在 $y$ 方向上是线性的流场，以及对于顶盖匀速运动 $u(x,H) = U$, $v(x,H) = 0$，您的边界条件能够恢复精确的壁面涡量。\n- 稳定性：对于粘性流，使用基于能量或拟涡能的推理，论证为什么作为 $\\omega(x_{i},H) = - \\partial^{2} \\psi / \\partial y^{2}(x_{i},H)$ 的二阶精度近似的边界条件，在半离散的扩散主导区域内不会在壁面注入虚假的拟涡能，因此相对于一阶壁面涡量近似是非失稳的。\n- 近壁面影响：解释提高壁面涡量条件的精度阶数如何改变主阶截断误差和计算出的顶盖附近涡量梯度的定性行为，特别是在减轻移动壁面附近的过冲或下冲以及提高剪应力 $\\tau_{w} = \\mu \\, \\partial u / \\partial y$ 的精度方面。\n\n将您的最终答案表示为 $\\omega_{i,N}$ 关于 $\\psi_{i,N}$、$\\psi_{i,N-1}$、$\\psi_{i,N-2}$、$h$ 和 $U$ 的一个单一的、封闭形式的解析表达式。不需要进行数值计算，最终表达式中不应包含任何单位。", "solution": "目标是推导方腔移动顶盖上涡量 $\\omega$ 的一个二阶精度有限差分边界条件。推导将基于不可压缩纳维-斯托克斯方程的流函数-涡量公式。\n\n控制方程和定义如下：\n- 运动学关系：$u = \\frac{\\partial \\psi}{\\partial y}$ 和 $v = -\\frac{\\partial \\psi}{\\partial x}$。\n- 涡量定义：$\\omega = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。\n- 流函数-涡量方程：$\\nabla^{2} \\psi = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = -\\omega$。\n\n最后一个方程，即流函数 $\\psi$ 的泊松方程，在域内处处成立，包括其边界。在顶壁上（索引为 $j=N$）的任意点 $(x_i, H)$，我们有：\n$$\n\\omega(x_i, H) = -\\left( \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} \\right)\\bigg|_{y=H}\n$$\n我们将网格点 $i$ 处的壁面量记为 $\\omega_{i,N} = \\omega(x_i, H)$ 和 $\\psi_{i,N} = \\psi(x_i, H)$。\n\n首先，我们分析 $\\frac{\\partial^2 \\psi}{\\partial x^2}(x_i, H)$ 项。问题陈述给出了顶盖上的边界条件为 $u(x,H) = U$ 和 $v(x,H) = 0$。在 $y=H$ 这条线上的无穿透条件 $v=0$ 意味着：\n$$\nv(x,H) = -\\frac{\\partial \\psi}{\\partial x}(x,H) = 0\n$$\n该方程对沿顶盖的所有 $x$ 都成立。这意味着 $\\psi(x,H)$ 关于 $x$ 是一个常数。问题陈述通过指定在顶盖上 $\\psi = \\psi_w$ 证实了这一点。由于 $\\psi(x,H)$ 不随 $x$ 变化，其关于 $x$ 的一阶和二阶偏导数均为零：\n$$\n\\frac{\\partial \\psi}{\\partial x}(x,H) = 0 \\quad \\text{和} \\quad \\frac{\\partial^2 \\psi}{\\partial x^2}(x,H) = 0\n$$\n这简化了顶壁上涡量和流函数之间的关系：\n$$\n\\omega(x_i, H) = - \\frac{\\partial^2 \\psi}{\\partial y^2}(x_i, H) \\quad \\implies \\quad \\omega_{i,N} = -\\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N}\n$$\n我们现在的目标是利用域内网格点（$j=N$、$j=N-1$、$j=N-2$）的 $\\psi$ 值和已知的速度边界条件，找到 $\\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N}$ 的一个二阶精度有限差分近似。\n\n我们对固定的 $x_i$，在 $y=H$ 点附近，为 $y = H-h$ 和 $y = H-2h$ 处的 $\\psi$ 编写泰勒级数展开：\n$$\n\\psi_{i,N-1} = \\psi(x_i, H-h) = \\psi_{i,N} - h \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} + \\frac{h^2}{2} \\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N} - \\frac{h^3}{6} \\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n$$\n\\psi_{i,N-2} = \\psi(x_i, H-2h) = \\psi_{i,N} - 2h \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} + \\frac{(2h)^2}{2} \\left(\\frac{\\partial^2 \\psi}{\\partial y^2}\\right)_{i,N} - \\frac{(2h)^3}{6} \\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n切向速度的边界条件 $u(x,H)=U$ 给了我们 $\\psi$ 的一阶导数：\n$$\nu(x_i, H) = \\left(\\frac{\\partial \\psi}{\\partial y}\\right)_{i,N} = U\n$$\n将此式以及 $\\omega_{i,N} = -(\\psi_{yy})_{i,N}$ 代入展开式，得到：\n$$\n(1) \\quad \\psi_{i,N-1} = \\psi_{i,N} - hU - \\frac{h^2}{2}\\omega_{i,N} - \\frac{h^3}{6}\\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n$$\n(2) \\quad \\psi_{i,N-2} = \\psi_{i,N} - 2hU - 2h^2\\omega_{i,N} - \\frac{4h^3}{3}\\left(\\frac{\\partial^3 \\psi}{\\partial y^3}\\right)_{i,N} + O(h^4)\n$$\n我们寻求一个二阶精度的 $\\omega_{i,N}$ 表达式，这意味着其截断误差必须是 $O(h^2)$。为达到此目的，我们必须消去未知的三阶导数项 $(\\psi_{yyy})_{i,N}$。我们可以通过取方程 $(1)$ 和 $(2)$ 的线性组合来实现。为了消去 $h^3$ 项，我们将方程 $(1)$ 乘以 $8$ 再减去方程 $(2)$：\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = 8\\left(\\psi_{i,N} - hU - \\frac{h^2}{2}\\omega_{i,N}\\right) - \\left(\\psi_{i,N} - 2hU - 2h^2\\omega_{i,N}\\right) + O(h^4)\n$$\n$O(h^3)$ 项为 $8(-\\frac{h^3}{6}) - (-\\frac{8h^3}{6}) = 0$，所以它按预期消掉了。现在，我们简化剩余的表达式：\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = (8\\psi_{i,N} - \\psi_{i,N}) - (8hU - 2hU) - (4h^2\\omega_{i,N} - 2h^2\\omega_{i,N}) + O(h^4)\n$$\n$$\n8\\psi_{i,N-1} - \\psi_{i,N-2} = 7\\psi_{i,N} - 6hU - 2h^2\\omega_{i,N} + O(h^4)\n$$\n最后，我们求解 $\\omega_{i,N}$：\n$$\n2h^2\\omega_{i,N} = 7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2} - 6hU + O(h^4)\n$$\n$$\n\\omega_{i,N} = \\frac{7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2}}{2h^2} - \\frac{3U}{h} + O(h^2)\n$$\n这就得到了所需的壁面涡量 $\\omega_{i,N}$ 的二阶精度表达式。\n\n接下来，我们讨论所要求的分析要点。\n\n- **相容性**：为证明相容性，我们在一个流场上测试该公式，其中流向速度在壁面法向坐标上是线性的，$u(y) = A(y-H) + U$。这满足 $u(H)=U$。该速度剖面的涡量为 $\\omega = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} = 0 - A = -A$。我们必须验证我们的 $\\omega_{i,N}$ 公式能得出这个精确值。\n首先，我们通过积分 $u = \\partial\\psi/\\partial y$ 来找到相应的流函数：\n$\\psi(y) = \\int (A(y-H) + U) dy = \\frac{A}{2}(y-H)^2 + Uy + C$。\n我们在网格点上计算 $\\psi$ 的值：\n$\\psi_{i,N} = \\psi(H) = UH+C$。\n$\\psi_{i,N-1} = \\psi(H-h) = \\frac{A}{2}(-h)^2 + U(H-h) + C = \\psi_{i,N} + \\frac{A}{2}h^2 - Uh$。\n$\\psi_{i,N-2} = \\psi(H-2h) = \\frac{A}{2}(-2h)^2 + U(H-2h) + C = \\psi_{i,N} + 2Ah^2 - 2Uh$。\n将这些值代入我们推导的 $\\omega_{i,N}$ 公式中：\n$$\n\\omega_{i,N} = \\frac{7\\psi_{i,N} - 8(\\psi_{i,N} + \\frac{A}{2}h^2 - Uh) + (\\psi_{i,N} + 2Ah^2 - 2Uh)}{2h^2} - \\frac{3U}{h}\n$$\n包含 $\\psi_{i,N}$ 的项相消：$(7-8+1)\\psi_{i,N} = 0$。分子中剩余的项为：\n$(-8)(\\frac{A}{2}h^2) + 2Ah^2 + (-8)(-Uh) - 2Uh = -4Ah^2 + 2Ah^2 + 8Uh - 2Uh = -2Ah^2 + 6Uh$。\n所以，\n$$\n\\omega_{i,N} = \\frac{-2Ah^2 + 6Uh}{2h^2} - \\frac{3U}{h} = -A + \\frac{3U}{h} - \\frac{3U}{h} = -A\n$$\n这与精确涡量 $\\omega = -A$ 相匹配。因此，该边界条件对于具有局部线性速度剖面的流场是相容且精确的。\n\n- **稳定性**：涡量输运方程 $\\frac{D\\omega}{Dt} = \\nu \\nabla^2\\omega$ 的数值格式的稳定性与总拟涡能 $E = \\frac{1}{2}\\int \\omega^2 dA$ 的行为有关。$E$ 的时间演化由 $\\frac{dE}{dt} = \\nu \\oint_{\\partial \\Omega} \\omega \\frac{\\partial \\omega}{\\partial n} dS - \\nu \\int_\\Omega |\\nabla\\omega|^2 dA$ 给出。第一项表示边界上的拟涡能产生，而第二项表示内部的粘性耗散。如果边界条件引入了虚假的、非物理的拟涡能源，就可能出现数值不稳定性。在无滑移壁面上，涡量的物理生成与速度梯度直接相关，概括为壁面上的运动学条件 $\\omega = -\\psi_{yy}$。$\\omega$ 的数值边界条件是对这种物理联系的近似。一阶精度条件的截断误差为 $O(h)$，它充当了这个阶数的人为拟涡能源/汇。如果这个人造项是源，它会向模拟中注入非物理能量，导致不稳定性。二阶精度近似将此误差减小到 $O(h^2)$。通过更忠实地表示涡量生成的物理机制，它极大地减小了边界处虚假拟涡能源的量级。这使得该格式相比于一阶格式更不易失稳，因为它更紧密地遵循了物理能量（拟涡能）平衡。\n\n- **近壁面影响**：壁面涡量条件的精度阶数对数值解的质量有深远影响。\n    - **截断误差**：通过将精度阶数从一阶 $O(h)$ 提高到二阶 $O(h^2)$，计算出的壁面涡量误差随网格细化呈二次方减小，而不是线性减小。这使得可以用更少的网格点获得显著更精确的结果。\n    - **定性行为**：移动顶盖附近的流动特征是一个具有非常高涡量梯度的薄剪切层。低阶边界条件可能在壁面附近的计算涡量剖面中引入数值振荡（过冲/下冲），未能平滑地捕捉这些梯度。二阶条件为 $\\omega_{i,N}$ 提供了更精确的值，它为在内部求解的涡量输运方程提供了一个更好的狄利克雷条件。这导致了壁面附近更平滑、更符合物理的涡量场，减轻了低阶格式中常见的数值伪影。\n    - **剪应力精度**：顶壁上的剪应力为 $\\tau_w = \\mu (\\partial u / \\partial y)|_{y=H}$。在壁面上，我们有 $\\omega = \\partial v/\\partial x - \\partial u/\\partial y$。由于在整个壁面上 $v=0$，所以 $\\partial v/\\partial x = 0$，这给出 $\\omega|_{y=H} = -(\\partial u / \\partial y)|_{y=H}$。因此，壁面剪应力与壁面涡量成正比：$\\tau_w = -\\mu \\omega_w$。计算出的剪应力（一个具有重要工程意义的量）的精度因此完全由壁面涡量的精度决定。一个二阶精度的涡量边界条件会产生一个二阶精度的剪应力，这是对较简单格式所提供的一阶精度的实质性改进。", "answer": "$$ \\boxed{ \\frac{7\\psi_{i,N} - 8\\psi_{i,N-1} + \\psi_{i,N-2}}{2h^2} - \\frac{3U}{h} } $$", "id": "3340086"}, {"introduction": "在高雷诺数流动中，物理粘性效应很弱，对流项起主导作用，此时对流格式的选择至关重要。不同的数值格式会引入其特有的误差，这些误差有时表现得如同一种“数值粘性”。本练习利用修正方程分析方法，来量化一阶迎风格式所产生的数值粘性，并揭示其对解的影响，特别是它如何抑制高雷诺数流动中的小尺度涡结构 [@problem_id:3340106]。", "problem": "考虑一个边长为 $L$、顶盖速度为 $U$ 的二维不可压缩顶盖驱动方腔，在雷诺数 $Re = \\dfrac{U L}{\\nu}$ 较高的情况下，其中 $\\nu$ 是运动粘度。重点关注 Navier–Stokes 方程涡量形式中的拟涡能动力学。二维涡量方程由标量涡量场 $\\omega(x,y,t)$ 的输运-扩散平衡给出，在高雷诺数下，物理扩散可以忽略不计。在计算流体动力学 (CFD) 模拟中，$\\omega$ 的平流项在具有 $N \\times N$ 个点的均匀笛卡尔网格上，采用前向欧拉时间积分器和一阶迎风空间离散格式进行离散化。设网格间距为 $\\Delta x = \\Delta y = L/N$，时间步长选择满足基于顶盖速度的 Courant–Friedrichs–Lewy (CFL) 条件，即 $\\Delta t = C \\, \\Delta x / U$，其中 $C = 0.6$。在方腔核心内部的关注位置，假设 $x$ 和 $y$ 方向的局部平均速度分别为 $u = 0.5 \\, U$ 和 $v = 0.5 \\, U$。作为一个代表性的小尺度涡结构，将局部涡量建模为可分离的傅里叶模态\n$$\n\\omega(x,y,t) = \\hat{\\omega}(t) \\cos(k x)\\cos(k y),\n$$\n其波数为 $k = \\dfrac{32 \\pi}{L}$，对应波长为 $\\lambda = \\dfrac{L}{16}$。将拟涡能定义为 $E(t) = \\dfrac{1}{2}\\int \\omega^2 \\, \\mathrm{d}A$，并在一个局部周期性区域上计算所有面积分，以使边界项消失。\n\n仅使用基本平衡关系和对所选数值平流格式的领先阶修正方程分析，将平流截断误差建模为一个作用于 $\\omega$ 的各向异性拉普拉斯算子，其方向上不同的有效系数依赖于 $u$、$v$、$\\Delta x$ 和 $\\Delta t$。推导由下式定义的拟涡能衰减率 $\\gamma_{\\text{num}}$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\gamma_{\\text{num}} \\, E,\n$$\n该衰减率仅由格式引起的数值扩散所导致，然后计算其在以下参数集下的数值：\n$$\nL = 0.1 \\ \\text{m}, \\quad U = 1.0 \\ \\text{m} \\, \\text{s}^{-1}, \\quad N = 256, \\quad C = 0.6, \\quad u = 0.5 \\, U, \\quad v = 0.5 \\, U.\n$$\n\n以 $\\text{s}^{-1}$ 为单位表示最终的 $\\gamma_{\\text{num}}$，并将答案四舍五入至四位有效数字。最后，解释结果的大小和对 $k$ 的依赖性如何与方腔内高雷诺数下小尺度涡的阻尼相关，但仅报告 $\\gamma_{\\text{num}}$ 的数值作为最终答案。", "solution": "问题要求推导由一阶迎風 (FOU) 格式应用于单个涡量模态平流所产生的数值扩散导致的拟涡能衰减率 $\\gamma_{\\text{num}}$。\n\n在二维不可压缩流动中，忽略物理粘性，涡量 $\\omega$ 的控制方程是平流方程：\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = 0\n$$\n问题指明，该方程在时间上使用前向欧拉格式，在空间上使用一阶迎风格式进行离散化。给定局部速度 $u=0.5U>0$ 和 $v=0.5U>0$，迎风格式使用后向差分。在网格点 $(i,j)$ 和时间步 $n$ 上的全离散方程为：\n$$\n\\frac{\\omega_{i,j}^{n+1} - \\omega_{i,j}^n}{\\Delta t} + u \\left( \\frac{\\omega_{i,j}^n - \\omega_{i-1,j}^n}{\\Delta x} \\right) + v \\left( \\frac{\\omega_{i,j}^n - \\omega_{i,j-1}^n}{\\Delta y} \\right) = 0\n$$\n其中 $\\Delta x = \\Delta y$ 是均匀网格间距。\n\n为了找出离散化误差的影响，我们通过在点 $(x_i, y_j, t_n)$ 附近对每一项进行泰勒级数展开，来进行修正方程分析。\n时间导数项为：\n$$\n\\frac{\\omega_{i,j}^{n+1} - \\omega_{i,j}^n}{\\Delta t} = \\frac{\\partial \\omega}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 \\omega}{\\partial t^2} + O(\\Delta t^2)\n$$\n空间导数项为：\n$$\nu \\left( \\frac{\\omega_{i,j}^n - \\omega_{i-1,j}^n}{\\Delta x} \\right) = u \\left( \\frac{\\omega - (\\omega - \\Delta x \\frac{\\partial \\omega}{\\partial x} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} - \\dots)}{\\Delta x} \\right) = u \\frac{\\partial \\omega}{\\partial x} - \\frac{u \\Delta x}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} + O(\\Delta x^2)\n$$\n$$\nv \\left( \\frac{\\omega_{i,j}^n - \\omega_{i,j-1}^n}{\\Delta y} \\right) = v \\left( \\frac{\\omega - (\\omega - \\Delta y \\frac{\\partial \\omega}{\\partial y} + \\frac{\\Delta y^2}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} - \\dots)}{\\Delta y} \\right) = v \\frac{\\partial \\omega}{\\partial y} - \\frac{v \\Delta y}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} + O(\\Delta y^2)\n$$\n将这些代入离散方程并重新整理，得到该格式实际求解的修正偏微分方程：\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\frac{v \\Delta y}{2} \\frac{\\partial^2 \\omega}{\\partial y^2} - \\frac{\\Delta t}{2} \\frac{\\partial^2 \\omega}{\\partial t^2} + \\dots\n$$\n其中右侧代表领先阶的截断误差。为了用空间导数表示 $\\frac{\\partial^2 \\omega}{\\partial t^2}$ 项，我们可以对原始偏微分方程求导，其零阶近似为 $\\frac{\\partial \\omega}{\\partial t} \\approx -u \\frac{\\partial \\omega}{\\partial x} - v \\frac{\\partial \\omega}{\\partial y}$。这导致 $\\frac{\\partial^2 \\omega}{\\partial t^2} \\approx u^2 \\frac{\\partial^2 \\omega}{\\partial x^2} + v^2 \\frac{\\partial^2 \\omega}{\\partial y^2} + 2uv \\frac{\\partial^2 \\omega}{\\partial x \\partial y}$。修正方程变为：\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\left(\\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\omega}{\\partial x^2} + \\left(\\frac{v \\Delta y}{2} - \\frac{v^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\omega}{\\partial y^2} - uv\\Delta t \\frac{\\partial^2 \\omega}{\\partial x \\partial y} + \\dots\n$$\n问题要求将截断误差建模为各向异性拉普拉斯算子，这意味着我们考虑 $\\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2}$ 和 $\\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2}$ 项。因此，修正方程被建模为：\n$$\n\\frac{\\partial \\omega}{\\partial t} + u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} = \\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2}\n$$\n其数值扩散系数依赖于方向：\n$$\n\\nu_{\\text{num},x} = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right), \\quad \\nu_{\\text{num},y} = \\frac{v \\Delta y}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta y}\\right)\n$$\n由于 $\\Delta x = \\Delta y$，这些可以简化为：\n$$\n\\nu_{\\text{num},x} = \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right), \\quad \\nu_{\\text{num},y} = \\frac{v \\Delta x}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right)\n$$\n拟涡能定义为 $E(t) = \\frac{1}{2} \\int_A \\omega^2 \\, \\mathrm{d}A$。其时间导数为：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_A \\omega \\frac{\\partial \\omega}{\\partial t} \\, \\mathrm{d}A\n$$\n代入 $\\frac{\\partial \\omega}{\\partial t}$ 的修正方程：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_A \\omega \\left(-u \\frac{\\partial \\omega}{\\partial x} - v \\frac{\\partial \\omega}{\\partial y} + \\nu_{\\text{num},x} \\frac{\\partial^2 \\omega}{\\partial x^2} + \\nu_{\\text{num},y} \\frac{\\partial^2 \\omega}{\\partial y^2} \\right) \\mathrm{d}A\n$$\n平流项 $\\int \\omega u \\frac{\\partial \\omega}{\\partial x}$ 和 $\\int \\omega v \\frac{\\partial \\omega}{\\partial y}$ 在指定的周期性区域上积分为零。剩下的项通过分部积分处理（利用周期性域的边界项为零这一事实）：\n$$\n\\int_A \\omega \\frac{\\partial^2 \\omega}{\\partial x^2} \\, \\mathrm{d}A = - \\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A, \\quad \\int_A \\omega \\frac{\\partial^2 \\omega}{\\partial y^2} \\, \\mathrm{d}A = - \\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A\n$$\n因此，拟涡能的演化由数值耗散控制：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\nu_{\\text{num},x} \\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A - \\nu_{\\text{num},y} \\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A\n$$\n现在我们代入给定的涡量模态 $\\omega(x,y,t) = \\hat{\\omega}(t) \\cos(k x)\\cos(k y)$。\n拟涡能为 $E(t) = \\frac{1}{2} \\hat{\\omega}(t)^2 \\int_A \\cos^2(kx)\\cos^2(ky) \\, \\mathrm{d}A$。\n空间导数为 $\\frac{\\partial \\omega}{\\partial x} = -k \\hat{\\omega} \\sin(kx)\\cos(ky)$ 和 $\\frac{\\partial \\omega}{\\partial y} = -k \\hat{\\omega} \\cos(kx)\\sin(ky)$。\n耗散积分为：\n$$\n\\int_A \\left(\\frac{\\partial \\omega}{\\partial x}\\right)^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\int_A \\sin^2(kx)\\cos^2(ky) \\, \\mathrm{d}A\n$$\n$$\n\\int_A \\left(\\frac{\\partial \\omega}{\\partial y}\\right)^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\int_A \\cos^2(kx)\\sin^2(ky) \\, \\mathrm{d}A\n$$\n对于周期性域，$\\cos^2(\\theta)$ 和 $\\sin^2(\\theta)$ 的空间平均值为 $\\frac{1}{2}$。因此，$\\cos^2(kx)\\cos^2(ky)$、$\\sin^2(kx)\\cos^2(ky)$ 和 $\\cos^2(kx)\\sin^2(ky)$ 的平均值均为 $\\frac{1}{4}$。设该区域的面积为 $A$。\n$E(t) = \\frac{1}{2} \\hat{\\omega}^2 \\frac{A}{4}$。\n$\\int_A (\\frac{\\partial \\omega}{\\partial x})^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\frac{A}{4}$。\n$\\int_A (\\frac{\\partial \\omega}{\\partial y})^2 \\mathrm{d}A = k^2 \\hat{\\omega}^2 \\frac{A}{4}$。\n将这些代入拟涡能速率方程：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -(\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) k^2 \\hat{\\omega}^2 \\frac{A}{4}\n$$\n我们可以用拟涡能来表示 $\\hat{\\omega}^2 \\frac{A}{4}$：从 $E = \\frac{1}{2} \\hat{\\omega}^2 \\frac{A}{4}$，我们得到 $\\hat{\\omega}^2 \\frac{A}{4} = 2E$。\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -2 k^2 (\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) E\n$$\n根据定义，$\\frac{\\mathrm{d}E}{\\mathrm{d}t} = - \\gamma_{\\text{num}} E$。比较这些可以得到衰减率：\n$$\n\\gamma_{\\text{num}} = 2 k^2 (\\nu_{\\text{num},x} + \\nu_{\\text{num},y}) = 2 k^2 \\left( \\frac{u \\Delta x}{2} \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) + \\frac{v \\Delta x}{2} \\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right) \\right)\n$$\n$$\n\\gamma_{\\text{num}} = k^2 \\Delta x \\left( u\\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) + v\\left(1 - \\frac{v \\Delta t}{\\Delta x}\\right) \\right)\n$$\n现在我们代入给定的数值：\n$L = 0.1 \\ \\text{m}$，$U = 1.0 \\ \\text{m} \\, \\text{s}^{-1}$，$N = 256$，$C = 0.6$。\n$u = 0.5 \\, U = 0.5 \\ \\text{m/s}$，$v = 0.5 \\, U = 0.5 \\ \\text{m/s}$。\n$k = \\frac{32 \\pi}{L} = \\frac{32 \\pi}{0.1} = 320 \\pi \\ \\text{m}^{-1}$。\n$\\Delta x = \\frac{L}{N} = \\frac{0.1}{256} \\ \\text{m}$。\n$\\Delta t = C \\frac{\\Delta x}{U} = 0.6 \\frac{0.1/256}{1.0} = \\frac{0.06}{256} \\ \\text{s}$。\n局部 Courant 数为：\n$C_x = \\frac{u \\Delta t}{\\Delta x} = u \\frac{C/U}{1} = 0.5 \\times \\frac{0.6}{1.0} = 0.3$。\n$C_y = \\frac{v \\Delta t}{\\Delta x} = v \\frac{C/U}{1} = 0.5 \\times \\frac{0.6}{1.0} = 0.3$。\n由于 $u=v$ 因而 $C_x=C_y$，$\\gamma_{\\text{num}}$ 的表达式简化为：\n$$\n\\gamma_{\\text{num}} = k^2 \\Delta x \\left( 2u(1-C_x) \\right)\n$$\n代入数值：\n$$\n\\gamma_{\\text{num}} = (320 \\pi)^2 \\left(\\frac{0.1}{256}\\right) \\left( 2 \\times 0.5 \\times (1-0.3) \\right)\n$$\n$$\n\\gamma_{\\text{num}} = 102400 \\pi^2 \\left(\\frac{0.1}{256}\\right) (1.0 \\times 0.7)\n$$\n$$\n\\gamma_{\\text{num}} = 102400 \\pi^2 \\left(\\frac{0.1}{256}\\right) (0.7)\n$$\n简化数值因子：$\\frac{102400}{256} = \\frac{1024 \\times 100}{256} = 4 \\times 100 = 400$。\n$$\n\\gamma_{\\text{num}} = 400 \\pi^2 \\times 0.1 \\times 0.7 = 40 \\pi^2 \\times 0.7 = 28 \\pi^2\n$$\n现在，我们计算最终的数值：\n$$\n\\gamma_{\\text{num}} = 28 \\times (\\pi)^2 \\approx 28 \\times 9.8696044 \\approx 276.34892 \\ \\text{s}^{-1}\n$$\n四舍五入到四位有效数字，我们得到 276.3。", "answer": "$$\\boxed{276.3}$$", "id": "3340106"}]}