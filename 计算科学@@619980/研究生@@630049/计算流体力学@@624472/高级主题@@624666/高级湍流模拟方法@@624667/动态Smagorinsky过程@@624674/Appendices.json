{"hands_on_practices": [{"introduction": "本练习揭示了常系数Smagorinsky模型的一个根本性弱点。通过分析一个简单的层流剪切流，我们将看到该模型如何错误地预测了亚格子尺度（SGS）耗散，并从原理上理解为何基于Germano恒等式的动态程序能够正确地“关闭”自身。这项实践为发展更先进的LES模型提供了核心动机[@problem_id:3373067]。", "problem": "考虑一个不可压缩层流简单剪切流的大涡模拟 (LES)，其滤波后的速度场由 $\\bar{\\mathbf{u}}(x,y,z) = (G y,\\, 0,\\, 0)$ 给出，其中 $G$ 是一个恒定的剪切率。该 LES 应用一个宽度为 $\\Delta$ 的空间滤波器，并通过涡粘性封闭来模拟偏应力部分的亚格子尺度 (SGS) 应力。\n\n从以下定义和定律出发，执行以下操作：\n1. 使用不可压缩流的滤波后应变率张量 $S_{ij}$ 的运动学定义，计算标量大小 $|\\bar{S}|$，仅用 $G$ 表示，其中大小定义为 $|\\bar{S}| = \\left(2\\,\\bar{S}_{ij}\\,\\bar{S}_{ij}\\right)^{1/2}$。\n2. 使用涡粘性封闭 $\\tau^{\\mathrm{SGS}}_{ij} - \\frac{1}{3}\\,\\tau^{\\mathrm{SGS}}_{kk}\\,\\delta_{ij} = -2\\,\\nu_{t}\\,\\bar{S}_{ij}$ 和 Smagorinsky 假设 $\\nu_{t} = \\left(C_{S}\\,\\Delta\\right)^{2}\\,|\\bar{S}|$（其中模型系数 $C_{S}$ 为常数），从第一性原理出发进行论证，解释为什么即使在网格加密（即 $\\Delta \\to 0$）时，尽管流动是完全层流且被完全解析，这个恒定 $C_{S}$ 封闭仍然预测非零的 SGS 耗散。然后，从动态 Smagorinsky 程序的核心——Germano 恒等式出发，解释为什么动态计算的 $C_{S}^{2}$ 对于此流动会消失为零。\n\n仅使用以下基本要素作为您的出发点：\n- 不可压缩滤波后的连续性方程 $\\partial \\bar{u}_{i}/\\partial x_{i} = 0$。\n- 滤波后的应变率定义 $\\bar{S}_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\bar{u}_{j}}{\\partial x_{i}}\\right)$。\n- 偏应力 SGS 封闭 $\\tau^{\\mathrm{SGS}}_{ij} - \\frac{1}{3}\\,\\tau^{\\mathrm{SGS}}_{kk}\\,\\delta_{ij} = -2\\,\\nu_{t}\\,\\bar{S}_{ij}$，其中 $\\nu_{t} = \\left(C_{S}\\,\\Delta\\right)^{2}\\,|\\bar{S}|$。\n- LES 和测试滤波的 Germano 恒等式：$L_{ij} = \\widetilde{\\overline{u_{i}\\,u_{j}}} - \\tilde{\\bar{u}}_{i}\\,\\tilde{\\bar{u}}_{j}$，其中波浪号表示测试滤波，上划线表示网格滤波，且 $L_{ij}$ 是 Leonard 应力。\n\n将 $|\\bar{S}|$ 的值报告为仅用 $G$ 表示的单个代数表达式。无需进行数值计算。如果在论证中引入任何物理单位，请使用标准的国际单位制 (SI) 明确说明，但最终报告的表达式必须是仅用 $G$ 写出的无量纲形式。", "solution": "该问题要求对给定的不可压缩层流简单剪切流，对 Smagorinsky 亚格子尺度 (SGS) 模型进行两部分分析。首先，我们计算滤波后的应变率张量的大小。其次，我们分析恒定系数和动态 Smagorinsky 模型对此流动的行为。\n\n**第 1 部分：计算滤波后的应变率大小 $|\\bar{S}|$**\n\n问题给出了滤波后的速度场 $\\bar{\\mathbf{u}}$ 在笛卡尔坐标系 $(x_1, x_2, x_3) = (x, y, z)$ 中的分量为：\n$$\n\\bar{u}_1 = G y = G x_2 \\\\\n\\bar{u}_2 = 0 \\\\\n\\bar{u}_3 = 0\n$$\n其中 $G$ 是恒定的剪切率。\n\n滤波后的应变率张量 $\\bar{S}_{ij}$ 定义为：\n$$\n\\bar{S}_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\bar{u}_{j}}{\\partial x_{i}}\\right)\n$$\n我们计算该张量的分量。速度分量中唯一非零的偏导数是 $\\frac{\\partial \\bar{u}_1}{\\partial x_2} = G$。所有其他导数，如 $\\frac{\\partial \\bar{u}_1}{\\partial x_1}$、$\\frac{\\partial \\bar{u}_1}{\\partial x_3}$、$\\frac{\\partial \\bar{u}_2}{\\partial x_j}$ 和 $\\frac{\\partial \\bar{u}_3}{\\partial x_j}$，均为零。\n\n$\\bar{S}_{ij}$ 的对角分量为：\n$$\n\\bar{S}_{11} = \\frac{\\partial \\bar{u}_1}{\\partial x_1} = 0 \\\\\n\\bar{S}_{22} = \\frac{\\partial \\bar{u}_2}{\\partial x_2} = 0 \\\\\n\\bar{S}_{33} = \\frac{\\partial \\bar{u}_3}{\\partial x_3} = 0\n$$\n非对角分量为：\n$$\n\\bar{S}_{12} = \\bar{S}_{21} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_1}{\\partial x_2} + \\frac{\\partial \\bar{u}_2}{\\partial x_1}\\right) = \\frac{1}{2}(G + 0) = \\frac{G}{2} \\\\\n\\bar{S}_{13} = \\bar{S}_{31} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_1}{\\partial x_3} + \\frac{\\partial \\bar{u}_3}{\\partial x_1}\\right) = \\frac{1}{2}(0 + 0) = 0 \\\\\n\\bar{S}_{23} = \\bar{S}_{32} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_2}{\\partial x_3} + \\frac{\\partial \\bar{u}_3}{\\partial x_2}\\right) = \\frac{1}{2}(0 + 0) = 0\n$$\n因此，滤波后的应变率张量的矩阵形式为：\n$$\n\\bar{S}_{ij} =\n\\begin{pmatrix}\n0 & \\frac{G}{2} & 0 \\\\\n\\frac{G}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n滤波后的应变率张量的大小定义为 $|\\bar{S}| = (2\\,\\bar{S}_{ij}\\,\\bar{S}_{ij})^{1/2}$，其中隐含了对重复指标的求和。\n首先，我们计算乘积 $\\bar{S}_{ij}\\,\\bar{S}_{ij}$：\n$$\n\\bar{S}_{ij}\\,\\bar{S}_{ij} = \\sum_{i=1}^3 \\sum_{j=1}^3 (\\bar{S}_{ij})^2 = (\\bar{S}_{12})^2 + (\\bar{S}_{21})^2 = \\left(\\frac{G}{2}\\right)^2 + \\left(\\frac{G}{2}\\right)^2 = \\frac{G^2}{4} + \\frac{G^2}{4} = \\frac{G^2}{2}\n$$\n现在，我们将此结果代入 $|\\bar{S}|$ 的定义中：\n$$\n|\\bar{S}| = \\left(2 \\cdot \\frac{G^2}{2}\\right)^{1/2} = \\left(G^2\\right)^{1/2} = |G|\n$$\n由于问题要求表达式仅用 $G$ 表示，且剪切率是一个可正可负的标量，最准确的形式是 $|G|$。\n\n**第 2 部分：Smagorinsky 封闭分析**\n\n**恒定系数 Smagorinsky 模型的失效：**\n标准 Smagorinsky 模型提出了由下式给出的涡粘性 $\\nu_t$：\n$$\n\\nu_t = (C_S \\Delta)^2 |\\bar{S}|\n$$\n其中 $C_S$ 是一个常数，$\\Delta$ 是滤波器宽度。偏应力 SGS 应力则被建模为：\n$$\n\\tau^{\\mathrm{SGS}}_{ij} - \\frac{1}{3}\\tau^{\\mathrm{SGS}}_{kk}\\delta_{ij} = -2 \\nu_t \\bar{S}_{ij}\n$$\n动能的 SGS 耗散率是 $\\epsilon_{\\mathrm{SGS}} = -(\\tau^{\\mathrm{SGS}}_{ij} - \\frac{1}{3}\\tau^{\\mathrm{SGS}}_{kk}\\delta_{ij})\\bar{S}_{ij} = 2 \\nu_t \\bar{S}_{ij}\\bar{S}_{ij}$。\n对于给定流场，我们得到 $|\\bar{S}| = |G|$。将其代入 $\\nu_t$ 的模型中：\n$$\n\\nu_t = (C_S \\Delta)^2 |G|\n$$\n由于在此公式中 $C_S$ 是一个非零常数，$\\Delta > 0$，并且我们假设一个非平凡的剪切流 ($G \\neq 0$)，该模型预测涡粘性非零，即 $\\nu_t \\neq 0$。这反过来又导致了非零的偏应力 SGS 应力和非零的 SGS 耗散率：\n$$\n\\epsilon_{\\mathrm{SGS}} = 2 \\left((C_S \\Delta)^2 |G|\\right) \\left(\\frac{G^2}{2}\\right) = (C_S \\Delta)^2 |G| G^2 = C_S^2 \\Delta^2 |G|^3\n$$\n根本的缺陷在于原始流场被指定为*层流*。在层流中，没有湍流脉动，因此 SGS 应力张量必须为零。恒定系数 Smagorinsky 模型仅依赖于*已解析*应变率的大小 $|\\bar{S}|$。由于简单剪切流具有非零的平均应变率，该模型错误地预测了亚格子尺度湍流的存在，并虚假地从已解析流场中移除了能量。该模型无法区分具有平均剪切的湍流和简单的层流剪切。即使网格加密 ($\\Delta \\to 0$)，对于任何有限的 $\\Delta$，该模型都会预测虚假的耗散，尽管这种耗散在极限情况下确实正确地趋于零。\n\n**动态 Smagorinsky 程序的成功：**\n动态程序通过基于两个不同滤波尺度（网格滤波器，宽度为 $\\Delta$，记作 $\\bar{\\cdot}$；测试滤波器，宽度为 $\\hat{\\Delta} > \\Delta$，记作 $\\tilde{\\cdot}$）上的可用流动信息来计算 $C_S$，从而弥补了这一缺陷。该程序源于 Germano 恒等式，该恒等式关联了这两个尺度上的应力：\n$$\nL_{ij} = T_{ij} - \\widetilde{\\tau_{ij}}\n$$\n其中 $L_{ij} = \\widetilde{\\bar{u}_i \\bar{u}_j} - \\tilde{\\bar{u}}_i \\tilde{\\bar{u}}_j$ 是 Leonard 应力（可从已解析场 $\\bar{u}_i$ 计算），$T_{ij} = \\widetilde{\\overline{u_i u_j}} - \\tilde{\\bar{u}}_i \\tilde{\\bar{u}}_j$ 是亚测试尺度应力，$\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$ 是亚格子尺度应力。\n\n通过使用 Smagorinsky 封闭对 $\\tau_{ij}$ 和 $T_{ij}$ 的偏量部分进行建模，并假设 $C_S$ 在两个滤波层级之间是常数，可以得到关系式 $L_{ij}^{\\text{dev}} = C_S^2 M_{ij}$，其中 $L_{ij}^{\\text{dev}}$ 是 Leonard 应力张量的偏量部分，而 $M_{ij}$ 是一个同样可以从滤波后的速度场计算出的张量：\n$$\nM_{ij} = 2\\Delta^2 \\widetilde{|\\bar{S}|\\bar{S}_{ij}} - 2\\hat{\\Delta}^2 |\\tilde{\\bar{S}}|\\tilde{\\bar{S}}_{ij}\n$$\n然后通过最小化此关系中的误差来求得 $C_S^2$，通常采用最小二乘法：$C_S^2 = \\frac{L_{ij}^{\\text{dev}} M_{ij}}{M_{kl} M_{kl}}$。\n\n让我们为给定的流场 $\\bar{u}_1 = Gx_2$ 分析 $L_{ij}$ 和 $M_{ij}$。我们假设标准滤波器不会改变坐标的线性函数，因此 $\\tilde{\\bar{u}}_1 = \\widetilde{Gx_2} = Gx_2 = \\bar{u}_1$。然而，滤波确实会影响非线性项。\n在乘积 $\\bar{u}_i \\bar{u}_j$ 中，唯一的非零项是 $\\bar{u}_1\\bar{u}_1 = (Gx_2)^2$。对这个二次项应用测试滤波器得到 $\\widetilde{(Gx_2)^2} = (Gx_2)^2 + C$，其中 $C$ 是一个依赖于滤波器形状和宽度 $\\hat{\\Delta}$ 的常数（例如，对于一维箱式滤波器，$C = G^2\\hat{\\Delta}^2/12$）。\nLeonard 应力分量为：\n$$\nL_{11} = \\widetilde{\\bar{u}_1 \\bar{u}_1} - \\tilde{\\bar{u}}_1 \\tilde{\\bar{u}}_1 = ((Gx_2)^2 + C) - (Gx_2)^2 = C\n$$\n所有其他分量 $L_{ij}$ 均为零，因为它们涉及像 $\\bar{u}_1\\bar{u}_2=0$ 这样的乘积。因此，$L_{ij}$ 是一个对角张量。所以，它的偏量部分 $L_{ij}^{\\text{dev}} = L_{ij} - \\frac{1}{3}L_{kk}\\delta_{ij}$ 也是一个对角张量。\n\n现在，我们来分析 $M_{ij}$。由于 $\\tilde{\\bar{u}}_i = \\bar{u}_i$，应变率张量也相同：$\\tilde{\\bar{S}}_{ij} = \\bar{S}_{ij}$，其大小也相同：$|\\tilde{\\bar{S}}| = |\\bar{S}| = |G|$。项 $|\\bar{S}|\\bar{S}_{ij}$ 是一个常数张量场。对常数场进行滤波会得到常数本身，因此 $\\widetilde{|\\bar{S}|\\bar{S}_{ij}} = |\\bar{S}|\\bar{S}_{ij}$。\n将这些代入 $M_{ij}$ 的表达式中：\n$$\nM_{ij} = (2\\Delta^2 - 2\\hat{\\Delta}^2)|\\bar{S}|\\bar{S}_{ij}\n$$\n这表明 $M_{ij}$ 与 $\\bar{S}_{ij}$ 成正比。正如我们在第 1 部分中发现的，$\\bar{S}_{ij}$ 是一个纯非对角张量。\n\n最后，我们从分子 $L_{ij}^{\\text{dev}} M_{ij}$ 计算 $C_S^2$。这是一个对角张量 ($L_{ij}^{\\text{dev}}$) 和一个纯非对角张量 ($M_{ij}$) 的缩并积（内积）。这样的乘积恒为零：\n$$\nL_{ij}^{\\text{dev}} M_{ij} = \\sum_{i,j} L_{ij}^{\\text{dev}} M_{ij} = 0\n$$\n分母 $M_{kl}M_{kl}$ 与 $\\bar{S}_{kl}\\bar{S}_{kl} = G^2/2$ 成正比，该值非零。\n因此，动态计算出的系数为：\n$$\nC_S^2 = \\frac{0}{\\text{非零}} = 0\n$$\n动态程序正确地确定了对于这种层流，模型系数必须为零，这反过来意味着 $\\nu_t = 0$，并且虚假的 SGS 耗散被消除。该模型正确地“自行关闭”。", "answer": "$$\n\\boxed{|G|}\n$$", "id": "3373067"}, {"introduction": "动态程序的理论推导通常假设滤波与微分算子是可交换的（即$ \\mathcal{F}[D[u]] = D[\\mathcal{F}[u]] $）。本练习将通过一个具体的解析计算，展示在近壁区域，由于离散格式的不对称性，这一假设会失效。理解这种非对易性所引入的误差，对于在高精度近壁流动的LES模拟中评估和改进模型至关重要[@problem_id:3373076]。", "problem": "考虑一个一维不可压缩大涡模拟 (LES)，其建立在间距为 $h$ 的均匀网格上，网格点为 $x_j = j h$（其中整数 $j \\geq 0$），并在 $x_0 = 0$ 处设有一个无穿透壁面。设解析速度分量为 $u(x,t)$，并以滤波后的不可压缩纳维-斯托克斯方程为基本依据，其中解析场通过应用网格滤波器产生，而亚格子尺度 (SGS) 应力则源于未解析尺度的相互作用。动态 Smagorinsky 过程构建了一个测试滤波系统，利用 Germano 恒等式来推断局部模型系数，该恒等式假设测试滤波器与空间微分是可交换的。\n\n在本问题中，您将提供并分析一个在均匀网格上的具体反例，展示一个离散箱式测试滤波器与相应的离散微分算子在固体边界附近的不可交换性。具体而言，定义作用于网格函数 $v_j = v(x_j)$ 的离散测试滤波器 $\\mathcal{F}$ 如下：\n- 内部滤波器（$j \\geq 1$）：$\\mathcal{F}[v]_j = \\frac{1}{3}\\left(v_{j-1} + v_j + v_{j+1}\\right)$，\n- 边界滤波器（$j = 0$）：$\\mathcal{F}[v]_0 = \\frac{1}{2}\\left(v_0 + v_1\\right)$，\n并定义作用于 $v_j$ 的离散微分算子 $D$ 如下：\n- 内部二阶中心差分（$j \\geq 1$）：$D[v]_j = \\frac{v_{j+1} - v_{j-1}}{2 h}$，\n- 边界二阶单边前向差分（$j = 0$）：$D[v]_0 = \\frac{-3 v_0 + 4 v_1 - v_2}{2 h}$。\n\n设解析场为精确解析函数 $u(x) = \\exp(\\lambda x)$，其中常数 $\\lambda > 0$。使用上述算子，计算测试滤波器和微分算子在第一个内部节点 $x_1$ 处的对易子，即\n$$\n\\left[\\mathcal{F}, D\\right]u\\,\\big|_{x_1} \\equiv \\mathcal{F}\\!\\left[D[u]\\right]_1 - D\\!\\left[\\mathcal{F}[u]\\right]_1,\n$$\n并将您的最终结果表示为关于 $h$ 和 $\\lambda$ 的闭式解析表达式。然后，解释该对易子的非零值如何影响动态 Smagorinsky 过程中使用的 Germano 恒等式的精确性，并特别强调为什么不可交换性会在边界附近为该恒等式引入一个附加项。\n\n将最终的对易子值表示为单个闭式解析表达式。无需四舍五入。", "solution": "该问题陈述是有效的，因为它在计算流体动力学领域内提出了一个适定的、有科学依据的问题，特别是关于动态 Smagorinsky 过程的数值分析。所有算子、函数和条件都已明确定义，从而可以得到唯一且可验证的解。\n\n问题的核心是计算离散测试滤波器 $\\mathcal{F}$ 和离散微分算子 $D$ 在第一个内部网格点 $x_1$ 处的对易子。对易子定义为 $[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\mathcal{F}[D[u]]_1 - D[\\mathcal{F}[u]]_1$。\n\n网格点由 $x_j = j h$（$j \\geq 0$）给出。速度场由函数 $u(x) = \\exp(\\lambda x)$ 给出，因此其在离散网格上的值为 $u_j = u(x_j) = \\exp(\\lambda j h)$。\n\n计算分两部分进行。\n\n首先，我们计算项 $\\mathcal{F}[D[u]]_1$。\n在第一个内部节点 $j=1$ 处的滤波算子为 $\\mathcal{F}[v]_1 = \\frac{1}{3}(v_0 + v_1 + v_2)$。为了对场 $v = D[u]$ 求此值，我们需要计算 $D[u]_0$、$D[u]_1$ 和 $D[u]_2$。\n\n微分算子 $D$ 在边界（$j=0$）和内部（$j \\geq 1$）的定义不同。\n在边界（$j=0$）处：\n$$\nD[u]_0 = \\frac{-3 u_0 + 4 u_1 - u_2}{2 h} = \\frac{-3 \\exp(0) + 4 \\exp(\\lambda h) - \\exp(2\\lambda h)}{2 h} = \\frac{-3 + 4 \\exp(\\lambda h) - \\exp(2\\lambda h)}{2 h}\n$$\n在第一个内部点（$j=1$）处：\n$$\nD[u]_1 = \\frac{u_2 - u_0}{2 h} = \\frac{\\exp(2\\lambda h) - \\exp(0)}{2 h} = \\frac{\\exp(2\\lambda h) - 1}{2 h}\n$$\n在第二个内部点（$j=2$）处：\n$$\nD[u]_2 = \\frac{u_3 - u_1}{2 h} = \\frac{\\exp(3\\lambda h) - \\exp(\\lambda h)}{2 h}\n$$\n现在，我们在 $j=1$ 处应用滤波器 $\\mathcal{F}$：\n$$\n\\mathcal{F}[D[u]]_1 = \\frac{1}{3}\\left(D[u]_0 + D[u]_1 + D[u]_2\\right)\n$$\n$$\n\\mathcal{F}[D[u]]_1 = \\frac{1}{3} \\left[ \\frac{-3 + 4 \\exp(\\lambda h) - \\exp(2\\lambda h)}{2 h} + \\frac{\\exp(2\\lambda h) - 1}{2 h} + \\frac{\\exp(3\\lambda h) - \\exp(\\lambda h)}{2 h} \\right]\n$$\n将各项合并到公分母 $6h$ 上：\n$$\n\\mathcal{F}[D[u]]_1 = \\frac{1}{6h} \\left[ (-3 + 4 \\exp(\\lambda h) - \\exp(2\\lambda h)) + (\\exp(2\\lambda h) - 1) + (\\exp(3\\lambda h) - \\exp(\\lambda h)) \\right]\n$$\n$$\n\\mathcal{F}[D[u]]_1 = \\frac{1}{6h} \\left[ (-3 - 1) + (4 - 1)\\exp(\\lambda h) + (-1 + 1)\\exp(2\\lambda h) + \\exp(3\\lambda h) \\right]\n$$\n$$\n\\mathcal{F}[D[u]]_1 = \\frac{1}{6h} \\left[ -4 + 3 \\exp(\\lambda h) + \\exp(3\\lambda h) \\right]\n$$\n\n其次，我们计算项 $D[\\mathcal{F}[u]]_1$。\n在 $j=1$ 处的微分算子为 $D[v]_1 = \\frac{v_2 - v_0}{2h}$。为了对场 $v = \\mathcal{F}[u]$ 求此值，我们需要计算 $\\mathcal{F}[u]_0$ 和 $\\mathcal{F}[u]_2$。\n\n滤波算子 $\\mathcal{F}$ 在边界（$j=0$）和内部（$j \\geq 1$）的定义不同。\n在边界（$j=0$）处：\n$$\n\\mathcal{F}[u]_0 = \\frac{1}{2}(u_0 + u_1) = \\frac{1}{2}(1 + \\exp(\\lambda h))\n$$\n在第二个内部点（$j=2$）处：\n$$\n\\mathcal{F}[u]_2 = \\frac{1}{3}(u_1 + u_2 + u_3) = \\frac{1}{3}(\\exp(\\lambda h) + \\exp(2\\lambda h) + \\exp(3\\lambda h))\n$$\n现在，我们在 $j=1$ 处应用微分算子 $D$：\n$$\nD[\\mathcal{F}[u]]_1 = \\frac{\\mathcal{F}[u]_2 - \\mathcal{F}[u]_0}{2h}\n$$\n$$\nD[\\mathcal{F}[u]]_1 = \\frac{1}{2h} \\left[ \\frac{1}{3}(\\exp(\\lambda h) + \\exp(2\\lambda h) + \\exp(3\\lambda h)) - \\frac{1}{2}(1 + \\exp(\\lambda h)) \\right]\n$$\n将各项合并到公分母 $12h$ 上：\n$$\nD[\\mathcal{F}[u]]_1 = \\frac{1}{12h} \\left[ 2(\\exp(\\lambda h) + \\exp(2\\lambda h) + \\exp(3\\lambda h)) - 3(1 + \\exp(\\lambda h)) \\right]\n$$\n$$\nD[\\mathcal{F}[u]]_1 = \\frac{1}{12h} \\left[ 2\\exp(\\lambda h) + 2\\exp(2\\lambda h) + 2\\exp(3\\lambda h) - 3 - 3\\exp(\\lambda h) \\right]\n$$\n$$\nD[\\mathcal{F}[u]]_1 = \\frac{1}{12h} \\left[ -3 - \\exp(\\lambda h) + 2\\exp(2\\lambda h) + 2\\exp(3\\lambda h) \\right]\n$$\n\n最后，我们计算对易子 $[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\mathcal{F}[D[u]]_1 - D[\\mathcal{F}[u]]_1$：\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{1}{6h} \\left[ -4 + 3 \\exp(\\lambda h) + \\exp(3\\lambda h) \\right] - \\frac{1}{12h} \\left[ -3 - \\exp(\\lambda h) + 2\\exp(2\\lambda h) + 2\\exp(3\\lambda h) \\right]\n$$\n将所有项置于分母 $12h$ 之上：\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{1}{12h} \\left\\{ 2\\left( -4 + 3 \\exp(\\lambda h) + \\exp(3\\lambda h) \\right) - \\left( -3 - \\exp(\\lambda h) + 2\\exp(2\\lambda h) + 2\\exp(3\\lambda h) \\right) \\right\\}\n$$\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{1}{12h} \\left\\{ (-8 + 6 \\exp(\\lambda h) + 2\\exp(3\\lambda h)) - (-3 - \\exp(\\lambda h) + 2\\exp(2\\lambda h) + 2\\exp(3\\lambda h)) \\right\\}\n$$\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{1}{12h} \\left[ -8 + 6 \\exp(\\lambda h) + 2\\exp(3\\lambda h) + 3 + \\exp(\\lambda h) - 2\\exp(2\\lambda h) - 2\\exp(3\\lambda h) \\right]\n$$\n按 $\\exp(\\lambda h)$ 的幂次对项进行分组：\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{1}{12h} \\left[ (-8 + 3) + (6 + 1)\\exp(\\lambda h) - 2\\exp(2\\lambda h) + (2 - 2)\\exp(3\\lambda h) \\right]\n$$\n$$\n[\\mathcal{F}, D]u\\,\\big|_{x_1} = \\frac{-5 + 7\\exp(\\lambda h) - 2\\exp(2\\lambda h)}{12h}\n$$\n这是在 $x_1$ 处对易子的闭式解析表达式。该结果通常为非零，表明离散滤波器和微分算子在边界附近是不可交换的。\n\n这个非零对易子对动态 Smagorinsky 过程的影响是显著的。该过程依赖于 Germano 恒等式，该恒等式关联了网格滤波尺度的亚格子尺度 (SGS) 应力 $\\tau_{ij}$、测试滤波尺度的 SGS 应力 $T_{ij}$ 以及解析 (Leonard) 应力 $L_{ij} = \\widehat{\\overline{u_i u_j}} - \\hat{\\bar{u}}_i \\hat{\\bar{u}}_j$。该恒等式的代数形式 $L_{ij} = T_{ij} - \\hat{\\tau}_{ij}$ 根据定义总是精确的。\n\n然而，动态过程是通过滤波后的运动方程关联这些应力来确定模型系数的。当测试滤波算子 $\\mathcal{F}$（帽子符号）应用于滤波后的动量方程时，会出现形如 $\\mathcal{F}[\\partial_j(\\phi)]$ 的项，其中 $\\phi$ 可能是解析动量通量或 SGS 应力张量。如果滤波器和导数算子可交换，我们将有 $\\mathcal{F}[\\partial_j(\\phi)] = \\partial_j(\\mathcal{F}[\\phi])$。由此产生的动态系数方程组将与连续公式一致。\n\n当算子不可交换时，如上述计算所示，会产生一个误差项：\n$$\n\\mathcal{F}[\\partial_j(\\phi)] = \\partial_j(\\mathcal{F}[\\phi]) + [\\mathcal{F}, \\partial_j](\\phi)\n$$\n这个对易子 $[\\mathcal{F}, \\partial_j](\\phi)$ 在推导 Smagorinsky 系数的控制方程中充当一个额外的、未建模的源项。这污染了 Leonard 应力与建模的 SGS 应力之间的关系。尺度相似性假设（该假设假定 SGS 应力模型在网格和测试滤波尺度上具有相同的函数形式）在离散层面上被违反，因为作用于测试滤波场的有效导数 $D[\\mathcal{F}[\\bar{u}]]$ 与网格滤波场的滤波导数 $\\mathcal{F}[D[\\bar{u}]]$ 是不相同的。\n\n这种不可交换性在固体边界附近尤其成问题。在远离边界的区域内部，对于均匀网格，滤波器和微分算子通常都是对称且具有平移不变性的，这使得它们可以交换。然而，在边界附近，这些算子的模板必须改变（例如，变为单边格式），从而破坏了对称性。正如本问题中的特定算子所示，这些不同的模板导致了非零对易子。这在近壁区域引入了显著的建模误差，损害了动态过程的准确性，而 SGS 应力在这些区域通常是最重要的。", "answer": "$$\n\\boxed{\\frac{-5 + 7\\exp(\\lambda h) - 2\\exp(2\\lambda h)}{12h}}\n$$", "id": "3373076"}, {"introduction": "本练习将指导您实现动态程序的核心算法：模型系数的局部计算。我们将推导并实现一个约束最小二乘估计器，从而直面诸如数值不稳定性以及由负系数代表的能量“回传”（backscatter）等实际问题。通过施加物理约束来确保模型的耗散性，是高级LES建模中的一项关键技能[@problem_id:3373015]。", "problem": "考虑一个二维、不可压缩的大涡模拟 (Large-Eddy Simulation, LES) 设定，该设定使用一个空间局部的动态涡粘模型来模拟子网格尺度 (Subgrid-Scale, SGS) 应力。设某点的解析速度梯度定义了解析应变率张量为 $S_{ij} = \\tfrac{1}{2} \\left( \\partial \\bar{u}_i/\\partial x_j + \\partial \\bar{u}_j/\\partial x_i \\right)$，对于不可压缩流，该张量满足 $S_{11} + S_{22} = 0$。Smagorinsky 拟设将 SGS 应力的偏量部分建模为 $\\tau_{ij}^{\\mathrm{sgs}} - \\tfrac{1}{3}\\tau_{kk}^{\\mathrm{sgs}}\\delta_{ij} = -2 \\nu_t S_{ij}$，其中涡粘性为 $\\nu_t = C \\Delta^2 \\lvert S \\rvert$。这里 $C$ 是一个待动态估计的无量纲系数，$\\Delta$ 是解析尺度上的滤波宽度，$\\lvert S \\rvert$ 是解析应变大小，定义为 $\\lvert S \\rvert = \\sqrt{2 S_{ij} S_{ij}}$，其中隐含的求和是遍历所有指标的完全双重缩并。\n\n动态 Smagorinsky 过程使用一个测试滤波器（用帽子符号表示）和 Germano 恒等式，将一个测量的 Leonard 应力张量与一个线性依赖于 $C$ 的模型项关联起来。在二维情况下，Germano 恒等式可以符号化地写为 $L_{ij} \\approx 2 C M_{ij}$，其中 $L_{ij}$ 是通过测试滤波和网格滤波得到的 Leonard 张量，而 $M_{ij}$ 是一个由滤波场和模型形式组装而成的已知对称张量。局部动态系数 $C$ 由 $L_{ij}$ 和 $2 C M_{ij}$ 之间残差的最小二乘最小化器给出，该最小化基于双重缩并 $A:B \\equiv \\sum_{i,j} A_{ij} B_{ij}$ 导出的欧几里得 (Frobenius) 范数。\n\n您的任务是：\n- 仅从上述定义出发，使用标准的双重缩并 $A:B = \\sum_{i=1}^{2}\\sum_{j=1}^{2} A_{ij} B_{ij}$，推导出产生 $C$ 的局部最小二乘估计值（作为 $L_{ij}$ 和 $M_{ij}$ 的函数）的正规方程。\n- 实现两种 $C$ 的局部估计器：\n  1. 无约束最小二乘估计器 $C_{\\mathrm{LS}}$。\n  2. 有约束最小二乘估计器 $C_{\\mathrm{CLS}}$，它强制执行逐点不等式约束 $C \\ge C_{\\min}$，其中 $C_{\\min}$ 是一个给定的非负下界。如果在某点因分母恒为零而导致最小二乘正规方程病态，则通过在分母中添加一个小的 Tikhonov 正则化项 $\\varepsilon$（$\\varepsilon = 10^{-12}$）来处理，然后应用该约束。\n- 对每个点，使用模型形式和您的局部 $C$ 估计值，计算解析动能收支中出现的从解析尺度到子网格尺度的能量传递密度 $\\Pi = -\\tau_{ij}^{\\mathrm{sgs}} S_{ij}$。将 $\\Pi$ 完全用 $C$、$\\Delta$ 和解析应变率张量表示。假设不可压缩性，因此各向同性应力对 $\\Pi$ 没有贡献。\n- 对于下面的每个测试用例，计算所有点上 $C_{\\mathrm{LS}}$ 的空间平均值、 $C_{\\mathrm{CLS}}$ 的空间平均值，以及相应的 $\\Pi$ 场的空间平均值，记为 $\\overline{C_{\\mathrm{LS}}}$、$\\overline{C_{\\mathrm{CLS}}}$、$\\overline{\\Pi}_{\\mathrm{LS}}$ 和 $\\overline{\\Pi}_{\\mathrm{CLS}}$。\n\n使用以下测试套件。每个测试用例都是二维的，所有量都是无量纲的。在一个测试用例中，所有点的解析滤波宽度是常数，为 $\\Delta = 1.0$。在每个点，仅按 $(\\cdot)_{11}$、$(\\cdot)_{12}$、$(\\cdot)_{22}$ 的顺序列出对称张量的独立分量。对于每个测试，计算所有列出点的平均值。\n\n测试用例 A（理想情况，无约束和有约束结果一致）：\n- $C_{\\min} = 0.0$。\n- 各点的解析应变 $S_{ij}$：\n  - 各点的 $\\left( S_{11}, S_{12}, S_{22} \\right)$：$\\left( (0.5, 0.3, -0.5), (0.4, 0.2, -0.4), (0.6, 0.1, -0.6), (0.1, 0.05, -0.1), (0.3, 0.25, -0.3) \\right)$。\n- 各点的 Leonard 张量 $L_{ij}$：\n  - $\\left( (0.0048, 0.0024, 0.0072), (0.006, 0.003, 0.005), (0.007, 0.00224, 0.0056), (0.0032, 0.0008, 0.0024), (0.00396, 0.00198, 0.00484) \\right)$。\n- 各点的模型张量 $M_{ij}$：\n  - $\\left( (0.02, 0.01, 0.03), (0.03, 0.015, 0.025), (0.025, 0.008, 0.02), (0.02, 0.005, 0.015), (0.018, 0.009, 0.022) \\right)$。\n\n测试用例 B（回散，无约束的负 $C$ 值被约束截断）：\n- $C_{\\min} = 0.0$。\n- 各点的 $S_{ij}$：\n  - $\\left( (0.5, 0.4, -0.5), (0.7, 0.2, -0.7), (0.2, 0.3, -0.2), (0.4, 0.1, -0.4), (0.6, 0.25, -0.6) \\right)$。\n- 各点的 $L_{ij}$：\n  - $\\left( (-0.0024, -0.0012, -0.0036), (-0.0048, -0.0024, -0.0032), (-0.0015, -0.0006, -0.0017), (-0.00308, -0.0014, -0.00266), (-0.00216, -0.00108, -0.00252) \\right)$。\n- 各点的 $M_{ij}$：\n  - $\\left( (0.02, 0.01, 0.03), (0.03, 0.015, 0.02), (0.015, 0.006, 0.017), (0.022, 0.01, 0.019), (0.018, 0.009, 0.021) \\right)$。\n\n测试用例 C（近奇异正规方程，正则化加严格正约束）：\n- $C_{\\min} = 0.02$。\n- 各点的 $S_{ij}$：\n  - $\\left( (0.5, 0.2, -0.5), (0.3, 0.4, -0.3), (0.7, 0.1, -0.7) \\right)$。\n- 各点的 $L_{ij}$：\n  - $\\left( (0.0001, 0.00005, 0.00012), (0.00005, 0.00002, 0.00006), (0.00008, 0.00003, 0.00007) \\right)$。\n- 各点的 $M_{ij}$：\n  - $\\left( (0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0) \\right)$。\n\n测试用例 D（阈值提高了小的正系数）：\n- $C_{\\min} = 0.09$。\n- 各点的 $S_{ij}$：\n  - $\\left( (0.35, 0.25, -0.35), (0.45, 0.15, -0.45), (0.55, 0.2, -0.55), (0.4, 0.1, -0.4) \\right)$。\n- 各点的 $L_{ij}$：\n  - $\\left( (0.0024, 0.0012, 0.00216), (0.0035, 0.00168, 0.00308), (0.0048, 0.0024, 0.00384), (0.0018, 0.0009, 0.002) \\right)$。\n- 各点的 $M_{ij}$：\n  - $\\left( (0.02, 0.01, 0.018), (0.025, 0.012, 0.022), (0.03, 0.015, 0.024), (0.018, 0.009, 0.02) \\right)$。\n\n算法和数值要求：\n- 对称二维张量使用完全双重缩并的定义，因此对于任何由其独立分量 $(A_{11}, A_{12}, A_{22})$ 和 $(B_{11}, B_{12}, B_{22})$ 表示的对称张量 $A_{ij}$ 和 $B_{ij}$，双重缩并为 $A:B = A_{11}B_{11} + A_{22}B_{22} + 2 A_{12} B_{12}$，Frobenius 范数的平方为 $A:A$。\n- 在获得每个点的 $C$ 的最小二乘估计后，计算该点进入解析动能收支的从解析尺度到子网格尺度的能量传递密度 $\\Pi$，然后在每个测试用例中对所列点进行平均。\n- 所有量都是无量纲的，因此不需要物理单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，按顺序包含测试用例 A、B、C、D 的列表的列表。每个内部列表必须是 $[\\overline{C_{\\mathrm{LS}}}, \\overline{C_{\\mathrm{CLS}}}, \\overline{\\Pi}_{\\mathrm{LS}}, \\overline{\\Pi}_{\\mathrm{CLS}}]$ 的形式，其中每个条目四舍五入到六位小数。例如，一个有效的整体格式是 $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]]$，其中每个 $a_k,b_k,c_k,d_k$ 是一个小数点后有六位数字的十进制数。", "solution": "该问题是有效的，因为它在科学上基于计算流体动力学原理，特别是大涡模拟 (LES)，并提出了一个适定、自洽且客观的计算任务。所有必要的数据和定义都已提供，不存在内部矛盾或违反数学、物理原理的情况。\n\n求解过程分三部分：首先，推导局部动态系数 C；其次，推导 SGS 能量传递密度 Π；第三，将这些公式应用于所提供的测试用例。\n\n### 动态系数 C 的推导\n\n动态过程通过最小化 Leonard 张量 $L_{ij}$ 与其模型 $2 C M_{ij}$ 之间的残差来估计 Smagorinsky 系数 $C$。目标是找到使残差张量 $R_{ij} = L_{ij} - 2 C M_{ij}$ 的 Frobenius 范数平方最小化的 $C$ 值。成本函数 $J(C)$ 为：\n$$ J(C) = R_{ij} : R_{ij} = (L_{ij} - 2 C M_{ij}) : (L_{ij} - 2 C M_{ij}) $$\n其中双重缩并 $A:B$ 定义为 $\\sum_{i,j} A_{ij} B_{ij}$。利用双重缩并的性质展开成本函数可得：\n$$ J(C) = (L:L) - 2C(L:M) - 2C(M:L) + 4C^2(M:M) $$\n由于双重缩并是可交换的 ($L:M = M:L$)，上式可简化为：\n$$ J(C) = (L:L) - 4C(L:M) + 4C^2(M:M) $$\n为求最小值，我们计算 $J(C)$ 对 $C$ 的导数并令其为零。这给出了正规方程：\n$$ \\frac{dJ}{dC} = -4(L:M) + 8C(M:M) = 0 $$\n求解 $C$ 可得无约束最小二乘估计值 $C_{\\mathrm{LS}}$：\n$$ C_{\\mathrm{LS}} = \\frac{4(L:M)}{8(M:M)} = \\frac{L:M}{2(M:M)} $$\n对于由其独立分量 $(A_{11}, A_{12}, A_{22})$ 和 $(B_{11}, B_{12}, B_{22})$ 给出的对称二维张量，所需的双重缩并计算如下：\n$$ L:M = L_{11}M_{11} + L_{22}M_{22} + 2L_{12}M_{12} $$\n$$ M:M = M_{11}^2 + M_{22}^2 + 2M_{12}^2 $$\n\n问题指定了两种 $C$ 的估计器：\n\n1.  **无约束估计器 $C_{\\mathrm{LS}}$**：这由推导出的公式直接给出。当分母 $2(M:M)$ 恒为零（即 $M_{ij}$ 是零张量）时，方程是病态的。问题规定通过在分母中添加一个小的参数 $\\varepsilon = 10^{-12}$ 来进行 Tikhonov 正则化。因此公式变为：\n    $$ C_{\\mathrm{LS}} = \\frac{L:M}{2(M:M) + \\varepsilon'} $$\n    其中如果 $M:M=0$，则 $\\varepsilon' = \\varepsilon$，否则 $\\varepsilon'=0$。根据在“分母中”添加 $\\varepsilon$ 的指令，这是最直接的解释。注意，如果 $M_{ij}=0$，那么 $L:M=0$，导致 $C_{\\mathrm{LS}} = 0$。\n\n2.  **有约束估计器 $C_{\\mathrm{CLS}}$**：该估计器强制执行物理可实现性，通常确保 SGS 模型是耗散的。它是通过将无约束估计值 $C_{\\mathrm{LS}}$ 在指定的非负下界 $C_{\\min}$ 处进行截断得到的：\n    $$ C_{\\mathrm{CLS}} = \\max(C_{\\mathrm{LS}}, C_{\\min}) $$\n\n### SGS 能量传递密度 Π 的推导\n\nSGS 能量传递密度 Π 表示从解析尺度到子网格尺度的能量传递速率。它定义为：\n$$ \\Pi = -\\tau_{ij}^{\\mathrm{sgs}} S_{ij} $$\nSGS 应力张量 $\\tau_{ij}^{\\mathrm{sgs}}$ 可以分解为其偏（无迹）部分 $\\tau_{ij}^{\\mathrm{sgs, dev}}$ 和其各向同性部分：$\\tau_{ij}^{\\mathrm{sgs}} = \\tau_{ij}^{\\mathrm{sgs, dev}} + \\frac{1}{3}\\tau_{kk}^{\\mathrm{sgs}}\\delta_{ij}$。将此代入 Π 的表达式中：\n$$ \\Pi = -\\left(\\tau_{ij}^{\\mathrm{sgs, dev}} + \\frac{1}{3}\\tau_{kk}^{\\mathrm{sgs}}\\delta_{ij}\\right) S_{ij} = -\\tau_{ij}^{\\mathrm{sgs, dev}} S_{ij} - \\frac{1}{3}\\tau_{kk}^{\\mathrm{sgs}} S_{ii} $$\n对于不可压缩流，连续性方程意味着解析应变率张量是无迹的，即 $S_{ii} = S_{11} + S_{22} = 0$。因此，SGS 应力的各向同性部分对能量传递没有贡献，表达式简化为：\n$$ \\Pi = -\\tau_{ij}^{\\mathrm{sgs, dev}} S_{ij} $$\nSmagorinsky 模型为偏 SGS 应力提供了一个本构关系：\n$$ \\tau_{ij}^{\\mathrm{sgs, dev}} = -2 \\nu_t S_{ij} $$\n其中涡粘性为 $\\nu_t = C \\Delta^2 |S|$。将此代入 Π 的表达式中：\n$$ \\Pi = -(-2 \\nu_t S_{ij}) S_{ij} = 2 \\nu_t (S_{ij} S_{ij}) = 2(C \\Delta^2 |S|) (S_{ij} S_{ij}) $$\n应变率张量的大小定义为 $|S| = \\sqrt{2 S_{ij} S_{ij}}$。由此可得 $|S|^2 = 2 S_{ij} S_{ij}$，这意味着 $S_{ij} S_{ij} = \\frac{1}{2}|S|^2$。将这最后一个关系代入 Π 的表达式中：\n$$ \\Pi = 2(C \\Delta^2 |S|) \\left(\\frac{1}{2}|S|^2\\right) = C \\Delta^2 |S|^3 $$\n这就是所求的能量传递密度表达式。对于指定问题，滤波宽度 $\\Delta = 1.0$。大小 $|S|$ 是根据 $S_{ij}$ 的给定分量计算的。对于二维不可压缩流，$S_{22}=-S_{11}$，所以双重缩并 $S:S$ 为：\n$$ S:S = S_{11}^2 + S_{22}^2 + 2S_{12}^2 = S_{11}^2 + (-S_{11})^2 + 2S_{12}^2 = 2S_{11}^2 + 2S_{12}^2 $$\n因此，大小 $|S|$ 为：\n$$ |S| = \\sqrt{2(S:S)} = \\sqrt{2(2S_{11}^2 + 2S_{12}^2)} = 2\\sqrt{S_{11}^2 + S_{12}^2} $$\n\n### 计算步骤\n\n对于每个测试用例，我们对每个数据点执行以下计算：\n1.  计算双重缩并 $L:M$ 和 $M:M$。\n2.  使用推导的公式计算 $C_{\\mathrm{LS}}$，如果 $M:M=0$ 则应用正则化。\n3.  通过应用下界 $C_{\\min}$ 计算 $C_{\\mathrm{CLS}}$。\n4.  计算应变率大小 $|S|$。\n5.  计算能量传递密度 $\\Pi_{\\mathrm{LS}} = C_{\\mathrm{LS}} \\Delta^2 |S|^3$ 和 $\\Pi_{\\mathrm{CLS}} = C_{\\mathrm{CLS}} \\Delta^2 |S|^3$（其中 $\\Delta=1.0$）。\n最后，在每个测试用例中对所有点计算 $C_{\\mathrm{LS}}$、$C_{\\mathrm{CLS}}$、$\\Pi_{\\mathrm{LS}}$ 和 $\\Pi_{\\mathrm{CLS}}$ 的空间平均值。", "answer": "[[0.116035,0.116035,0.119835,0.119835],[-0.070000,0.000000,-0.118967,0.000000],[0.000000,0.020000,0.000000,0.021111],[0.080000,0.090000,0.045437,0.051117]]", "id": "3373015"}]}