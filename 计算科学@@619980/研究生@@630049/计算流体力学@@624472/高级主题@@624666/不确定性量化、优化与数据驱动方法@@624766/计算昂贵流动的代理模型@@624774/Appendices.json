{"hands_on_practices": [{"introduction": "本征正交分解 (Proper Orthogonal Decomposition, POD) 是从高维流场快照中提取主导相干结构的基石技术。通过将复杂流场投影到由能量最优的POD模态构成的低维子空间，我们可以构建高效的降阶模型。本练习将通过一个具体的计算，帮助你掌握如何使用POD基表示一个给定的速度场，并量化由此产生的投影误差，从而深化对POD能量最优性的理解 [@problem_id:3369133]。", "problem": "考虑一个在均匀网格上离散化的无量纲不可压缩流场，其离散 $L^{2}$ 内积等同于 $\\mathbb{R}^{3}$ 上的欧几里得点积。已通过对快照矩阵进行奇异值分解 (SVD)，从快照集中构建了一个秩为 $r=2$ 的本征正交分解 (POD) 基。所得的 $L^{2}$-正交归一 POD 模态由以下矩阵的列向量给出：\n$$\nU_{r} \\;=\\; \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\\\\n0  0\n\\end{pmatrix},\n$$\n因此 $\\phi_{1} = \\left(\\frac{1}{\\sqrt{2}},\\, \\frac{1}{\\sqrt{2}},\\, 0\\right)^{\\top}$ 且 $\\phi_{2} = \\left(-\\frac{1}{\\sqrt{2}},\\, \\frac{1}{\\sqrt{2}},\\, 0\\right)^{\\top}$。令 $P_{r}$ 表示到 $\\operatorname{span}\\{\\phi_{1},\\phi_{2}\\}$ 上的 $L^{2}$-正交投影。\n\n给定一个无量纲离散速度场\n$$\nu \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ \\sqrt{2} \\end{pmatrix}.\n$$\n\n从 $L^{2}$ 内积、正交归一性和正交投影算子的定义出发，计算投影误差范数 $\\|u - P_{r} u\\|_{L^{2}}$。\n\n此外，使用通过奇异值分解 (SVD) 构建 POD 的第一性原理，讨论快照的多样性（例如，广泛的参数变化、多个相干结构或多模态动力学）如何影响与快照矩阵相关的奇异值的衰减率。你的讨论必须基于快照相关算子的性质和 POD 的最优性进行推理，而不是基于启发式规则。投影误差的最终答案必须精确表示，无需四舍五入。", "solution": "该问题包含两部分。第一部分要求计算给定离散速度场到由一组给定的本征正交分解 (POD) 模态张成的子空间上的投影误差范数。第二部分要求就 POD 背景下快照多样性与奇异值衰减率之间的关系进行理论讨论。\n\n**第一部分：投影误差范数的计算**\n\n该问题设定在有限维向量空间 $\\mathbb{R}^{3}$ 中，其中离散 $L^{2}$ 内积定义为标准欧几里得点积，$\\langle u, v \\rangle_{L^{2}} = u^{\\top}v$。相关的范数是欧几里得范数，$\\|u\\|_{L^{2}} = \\sqrt{u^{\\top}u}$。\n\n给定一个秩为 $r=2$ 的 POD 基，它是一个正交归一向量集 $\\{\\phi_{1}, \\phi_{2}\\}$。这些向量由矩阵 $U_{r}$ 的列给出：\n$$\n\\phi_{1} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}, \\quad \\phi_{2} = \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n$$\n通过检查内积可以确认这些基向量的正交归一性：\n$$\n\\langle \\phi_{1}, \\phi_{1} \\rangle = \\left(\\frac{1}{\\sqrt{2}}\\right)^{2} + \\left(\\frac{1}{\\sqrt{2}}\\right)^{2} + 0^{2} = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n$$\n\\langle \\phi_{2}, \\phi_{2} \\rangle = \\left(-\\frac{1}{\\sqrt{2}}\\right)^{2} + \\left(\\frac{1}{\\sqrt{2}}\\right)^{2} + 0^{2} = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n$$\n\\langle \\phi_{1}, \\phi_{2} \\rangle = \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(-\\frac{1}{\\sqrt{2}}\\right) + \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) + (0)(0) = -\\frac{1}{2} + \\frac{1}{2} = 0\n$$\n集合 $\\{\\phi_{1}, \\phi_{2}\\}$ 对于指定的内积确实是正交归一的。\n\n向量 $u$ 到子空间 $W = \\operatorname{span}\\{\\phi_{1}, \\phi_{2}\\}$ 上的正交投影由算子 $P_{r}$ 给出，定义为：\n$$\nP_{r} u = \\sum_{i=1}^{r} \\langle u, \\phi_{i} \\rangle_{L^{2}} \\phi_{i}\n$$\n在我们的情况下，$r=2$，所以给定速度场 $u = \\begin{pmatrix} 1 \\\\ 0 \\\\ \\sqrt{2} \\end{pmatrix}$ 的投影为：\n$$\nP_{2} u = \\langle u, \\phi_{1} \\rangle_{L^{2}} \\phi_{1} + \\langle u, \\phi_{2} \\rangle_{L^{2}} \\phi_{2}\n$$\n首先，我们计算系数，它们是 $u$ 与基向量的内积：\n$$\n\\alpha_{1} = \\langle u, \\phi_{1} \\rangle_{L^{2}} = u^{\\top}\\phi_{1} = \\begin{pmatrix} 1  0  \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} = (1)\\left(\\frac{1}{\\sqrt{2}}\\right) + (0)\\left(\\frac{1}{\\sqrt{2}}\\right) + (\\sqrt{2})(0) = \\frac{1}{\\sqrt{2}}\n$$\n$$\n\\alpha_{2} = \\langle u, \\phi_{2} \\rangle_{L^{2}} = u^{\\top}\\phi_{2} = \\begin{pmatrix} 1  0  \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} = (1)\\left(-\\frac{1}{\\sqrt{2}}\\right) + (0)\\left(\\frac{1}{\\sqrt{2}}\\right) + (\\sqrt{2})(0) = -\\frac{1}{\\sqrt{2}}\n$$\n现在，我们构造投影向量 $P_{2}u$：\n$$\nP_{2} u = \\alpha_{1}\\phi_{1} + \\alpha_{2}\\phi_{2} = \\left(\\frac{1}{\\sqrt{2}}\\right) \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} + \\left(-\\frac{1}{\\sqrt{2}}\\right) \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n投影误差是原始向量 $u$ 与其投影 $P_{2}u$ 之间的差：\n$$\nu - P_{2} u = \\begin{pmatrix} 1 \\\\ 0 \\\\ \\sqrt{2} \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\sqrt{2} \\end{pmatrix}\n$$\n最后，我们计算这个误差向量的 $L^{2}$-范数：\n$$\n\\|u - P_{2} u\\|_{L^{2}} = \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ \\sqrt{2} \\end{pmatrix} \\right\\|_{L^{2}} = \\sqrt{0^{2} + 0^{2} + (\\sqrt{2})^{2}} = \\sqrt{2}\n$$\n或者，根据正交投影的勾股定理，$\\|u - P_r u\\|_{L^2}^2 = \\|u\\|_{L^2}^2 - \\|P_r u\\|_{L^2}^2$。\n我们有 $\\|u\\|_{L^2}^2 = 1^2 + 0^2 + (\\sqrt{2})^2 = 3$。投影的范数为 $\\|P_r u\\|_{L^2}^2 = |\\alpha_1|^2 + |\\alpha_2|^2 = (\\frac{1}{\\sqrt{2}})^2 + (-\\frac{1}{\\sqrt{2}})^2 = \\frac{1}{2} + \\frac{1}{2} = 1$。\n因此，$\\|u - P_r u\\|_{L^2}^2 = 3 - 1 = 2$，得出 $\\|u - P_r u\\|_{L^2} = \\sqrt{2}$。\n\n**第二部分：关于快照多样性与奇异值衰减的讨论**\n\n本征正交分解 (POD) 提供了一个在最小二乘意义上表示数据集合的最优基。POD 基向量 $\\{\\phi_i\\}_{i=1}^N$ 是通过对快照矩阵 $S \\in \\mathbb{R}^{N \\times M}$ 进行奇异值分解 (SVD) 得到的，其中 $N$ 是空间自由度的数量，$M$ 是快照的数量。$S$ 的列是离散快照向量 $\\{s_j\\}_{j=1}^M$。$S$ 的 SVD 分解为 $S = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{N \\times N}$ 的列是 POD 模态 $\\phi_i$，$\\Sigma \\in \\mathbb{R}^{N \\times M}$ 是由奇异值 $\\sigma_i \\geq 0$ 构成的对角矩阵。\n\nPOD 的最优性与奇异值相关。对于任意秩 $r$，POD 基 $\\{\\phi_i\\}_{i=1}^r$ 最小化整个快照集上的平均投影误差：\n$$\n\\min_{\\{\\psi_i\\}_{i=1}^r} \\sum_{j=1}^{M} \\left\\| s_j - \\sum_{i=1}^{r} \\langle s_j, \\psi_i \\rangle \\psi_i \\right\\|^2 = \\sum_{j=1}^{M} \\left\\| s_j - \\sum_{i=1}^{r} \\langle s_j, \\phi_i \\rangle \\phi_i \\right\\|^2 = \\sum_{i=r+1}^{k} \\sigma_i^2\n$$\n其中 $k=\\min(N,M)$。量 $\\sigma_i^2$ 可以解释为第 $i$ 个模态 $\\phi_i$ 捕获的“能量”或方差。该集合的总能量为 $\\sum_{j=1}^M \\|s_j\\|^2 = \\operatorname{tr}(S^{\\top}S) = \\sum_{i=1}^k \\sigma_i^2$。\n\n奇异值 $\\sigma_i$ 的衰减率取决于总能量如何在各个模态之间分布。这种分布与快照之间的线性相关性或关联性直接相关，这是衡量其“多样性”的一个指标。我们考虑快照相关算子，其矩阵表示为格拉姆矩阵 $C = S^{\\top}S \\in \\mathbb{R}^{M \\times M}$。元素 $C_{ij} = \\langle s_i, s_j \\rangle$ 衡量快照 $s_i$ 和快照 $s_j$ 之间的相关性。$C$ 的特征值为 $\\lambda_i = \\sigma_i^2$。\n\n1.  **快照多样性低：** 如果快照不多样（例如，它们代表围绕稳态的微小波动或描绘了单一、主导的相干结构），快照向量 $\\{s_j\\}$ 将高度相关。这意味着这些向量近似线性相关，快照矩阵 $S$ 的有效秩较低。相关矩阵 $C$ 将具有较大的非对角元素，反映了高度的相关性。在这种情况下，$C$ 的特征值谱高度集中。少数几个主导特征值 $\\lambda_i$（以及奇异值 $\\sigma_i$）将捕获系统的大部分能量，而其余的值将非常小。这导致奇异值的**快速衰减**。该系统被认为是低内在维度的。\n\n2.  **快照多样性高：** 如果快照高度多样（例如，它们是从不同的动力学状态、广泛的参数范围或具有多个活跃尺度的湍流中采样的），快照向量之间的相关性将较低，并且在状态空间 $\\mathbb{R}^N$ 中更趋于正交。因此，相关矩阵 $C = S^{\\top}S$ 的非对角元素相对于其对角元素 ($C_{jj} = \\|s_j\\|^2$) 会很小。集合的能量更均匀地分布在更广泛的底层结构中。从信息论的角度来看，这意味着快照集的熵更高。这需要更多的基函数来捕获给定百分比的总能量。$C$ 的特征值 $\\lambda_i$ 将分布得更均匀，导致奇异值 $\\sigma_i$ **缓慢衰减**。这表明系统具有高内在维度。\n\n总而言之，从第一性原理出发，快照集的多样性决定了快照相关矩阵 $C$ 的结构。更高的多样性导致快照向量集更加“分散”，使得 $C$ 更具对角占优性，其特征值谱也更平坦。由于 $C$ 的特征值是 $S$ 的奇异值的平方，因此更大的快照多样性直接对应于奇异值较慢的衰减率。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "3369133"}, {"introduction": "傅里叶神经算子 (Fourier Neural Operator, FNO) 等算子学习方法代表了代理建模的前沿技术，它旨在直接学习无限维函数空间之间的映射，例如流场随时间的演化算子。然而，这类数据驱动模型在长时间积分（roll-out）中常面临数值不稳定的挑战。本练习通过为一个一维对流方程设计一个受物理约束的FNO代理模型，让你亲身体验如何诊断并解决这一关键的稳定性问题，从而为构建鲁棒的动力学系统代理模型打下基础 [@problem_id:3369161]。", "problem": "考虑周期域上的一维线性平流方程，由 $\\partial_t u + c \\partial_x u = 0$ 给出，其中 $u(x,t)$ 是一个标量场，$c$ 是恒定的平流速度，$x \\in [0,L)$，且 $t \\ge 0$。其基本原理是空间傅里叶变换，以及在精确傅里叶演化下，波数为 $k$ 的模式按 $u_k(t+\\Delta t) = \\exp(-\\mathrm{i} k c \\Delta t) u_k(t)$ 前进，其中复放大因子的模为单位1。一个试图预测各模式更新的傅里叶代理模型可能会产生模超过1或相位增量与平流不一致的复放大因子，这在多步迭代应用下会导致展开不稳定性（范数爆炸）。\n\n您的任务是设计并实现一个程序，该程序为一个简单的傅里叶神经算子代理模型实例化，用于计算各模式的复放大因子，并使用类似谱Courant–Friedrichs–Lewy (CFL)的条件对其进行约束，以经验性地绘制稳定性区域。该程序将：\n\n1. 在长度为 $L$ 的周期域上构建一个包含 $N$ 个点的空间网格，间距为 $\\Delta x = L/N$。考虑无量纲场，并以弧度处理角度。\n\n2. 对于与 $[0,L)$ 上的傅里叶网格一致的整数波数 $k$，定义精确的各模式复放大因子 $G_k^{\\mathrm{true}} = \\exp(-\\mathrm{i} k c \\Delta t)$。\n\n3. 定义每个模式的带噪声的代理预测，模型为 $G_k^{\\mathrm{pred}} = G_k^{\\mathrm{true}} \\cdot A_k \\cdot \\exp(\\mathrm{i} \\Phi_k)$，其中 $A_k$ 和 $\\Phi_k$ 表示幅度和相位预测误差，每个模式独立地从具有给定均值和标准差参数的分布中抽取。幅度扰动应建模为 $A_k \\ge 0$ 且中心在1附近，而相位扰动中心在零附近，并以弧度为单位指定。\n\n4. 从一个随机初始场 $u(x,0)$ 开始，实现两种超过 $T$ 步的展开变体：\n   - 无约束：在谱空间中的每一步应用 $G_k^{\\mathrm{pred}}$ 以获得 $u(x,t)$。\n   - 有约束：在展开前修改每个模式的 $G_k^{\\mathrm{pred}}$ 以强制执行类似谱CFL的条件。约束后的放大因子 $G_k^{\\mathrm{cfl}}$ 必须满足以下所有定性要求：\n     a) 幅度界限：强制 $|G_k^{\\mathrm{cfl}}| \\le 1$。\n     b) 相位增量界限：强制 $|\\Delta \\phi_k| \\le |k c \\Delta t|$，其中 $\\Delta \\phi_k$ 是模式 $k$ 的每步相位，且界限以弧度表示。\n     c) 当无量纲CFL比率 $r = |c| \\Delta t / \\Delta x$ 超过1时引入额外阻尼：引入一个单调阻尼因子，该因子随超出量 $r-1$ 和归一化波数大小 $|k|/k_{\\max}$ 的增加而增加，其中 $k_{\\max}$ 是网格上可解析的最大波数大小。\n\n5. 将一次展开的稳定性定义为 $u(x,t)$ 的离散 $\\ell^2$ 范数相对于初始范数保持有界。具体来说，在每一步计算离散范数 $||u^n||_2$，如果 $||u^n||_2 / ||u^0||_2$ 超过一个固定的增长阈值 $G_{\\mathrm{thr}}$，则宣布发生爆炸。如果在 $T$ 步内没有发生爆炸，则认为模拟是稳定的。离散范数应以与网格一致的无量纲单位计算。\n\n6. 为了经验性地绘制稳定性区域，请针对指定的参数值测试套件运行上述过程。对于每种情况，记录一个布尔值对 $[\\mathrm{stable\\_unconstrained}, \\mathrm{stable\\_constrained}]$。\n\n使用以下测试套件，其中所有角度均以弧度为单位，平流速度 $c$ 的单位为米/秒，而 $L$ 的单位为米。通过指定的无量纲CFL比率 $r$ 计算 $\\Delta t = r \\Delta x / |c|$。在所有情况下，使用周期域长度 $L = 2\\pi$，$N = 64$ 个网格点，以及 $T = 100$ 步。设 $G_{\\mathrm{thr}} = 100$。幅度误差参数 $(\\mu_a,\\sigma_a)$ 定义了中心在 $1+\\mu_a$ 附近、变异性为 $\\sigma_a$ 的 $A_k$，相位误差标准差为 $\\sigma_\\phi$。\n\n- 情况1：$c = 1$, $r = 0.5$, $\\mu_a = -0.02$, $\\sigma_a = 0.02$, $\\sigma_\\phi = 0.05$。\n- 情况2：$c = 1$, $r = 1.0$, $\\mu_a = 0.05$, $\\sigma_a = 0.05$, $\\sigma_\\phi = 0.10$。\n- 情况3：$c = 1$, $r = 2.0$, $\\mu_a = 0.10$, $\\sigma_a = 0.05$, $\\sigma_\\phi = 0.15$。\n- 情况4：$c = 1$, $r = 3.0$, $\\mu_a = 0.20$, $\\sigma_a = 0.10$, $\\sigma_\\phi = 0.20$。\n- 情况5：$c = 1$, $r = 0.1$, $\\mu_a = 0.0$, $\\sigma_a = 0.0$, $\\sigma_\\phi = 0.0$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个条目是相应测试用例的布尔值对，格式严格如下：$[[b_1^{\\mathrm{uncon}},b_1^{\\mathrm{con}}],[b_2^{\\mathrm{uncon}},b_2^{\\mathrm{con}}],\\dots,[b_5^{\\mathrm{uncon}},b_5^{\\mathrm{con}}]]$，其中每个 $b_i$ 为 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "solution": "经评估，用户提供的问题是有效的。它在科学上基于计算流体动力学和数值分析的原理，特别是关于双曲偏微分方程代理模型的稳定性。该问题定义明确、客观，并包含足够的信息来构建唯一的解决方案，前提是对指定的定性要求进行合理和标准的解释。我们继续进行求解。\n\n核心任务是研究一维线性平流方程 $\\partial_t u + c \\partial_x u = 0$ 的傅里叶神经算子代理模型的稳定性。该分析通过比较代理模型的无约束展开与强制执行类似于谱空间中Courant–Friedrichs–Lewy (CFL)条件的约束版本的展开来进行。\n\n首先，我们建立计算域和离散化。物理域是一个周期性区间 $x \\in [0, L)$，其中 $L=2\\pi$。该域被离散化为 $N=64$ 个网格点，从而得到网格间距 $\\Delta x = L/N = 2\\pi/64 = \\pi/32$。离散空间坐标为 $x_j = j \\Delta x$，其中 $j \\in \\{0, 1, \\dots, N-1\\}$。\n\n解 $u(x,t)$ 在傅里叶基中表示。离散傅里叶变换 (DFT) 及其逆变换用于在物理表示和谱表示之间切换。与网格对应的波数由 $k = 2\\pi f$ 给出，其中 $f$ 是来自 `numpy.fft.fftfreq(N, d=Δx)` 的离散频率。对于 $L=2\\pi$，这些波数是范围从 $-(N/2)$ 到 $(N/2)-1$ 的整数。可解析的最大波数大小是奈奎斯特波数，$k_{\\max} = \\pi / \\Delta x = N/2$。\n\n平流方程的精确解在傅里叶域中根据规则 $u_k(t+\\Delta t) = G_k^{\\mathrm{true}} u_k(t)$ 演化，其中 $u_k(t)$ 是模式 $k$ 在时间 $t$ 的傅里叶系数。精确的复放大因子是纯相位旋转：\n$$\nG_k^{\\mathrm{true}} = \\exp(-\\mathrm{i} k c \\Delta t)\n$$\n其中 $\\mathrm{i} = \\sqrt{-1}$。对于所有 $k$，$|G_k^{\\mathrm{true}}| = 1$，这确保了解的范数随时间守恒。时间步长 $\\Delta t$ 由无量纲CFL比率 $r = |c|\\Delta t / \\Delta x$ 决定，得到 $\\Delta t = r \\Delta x / |c|$。\n\n代理模型会引入误差。我们将代理模型预测的放大因子 $G_k^{\\mathrm{pred}}$ 建模为真实因子的扰动：\n$$\nG_k^{\\mathrm{pred}} = G_k^{\\mathrm{true}} \\cdot A_k \\cdot \\exp(\\mathrm{i} \\Phi_k)\n$$\n这里，$A_k$ 是乘性幅度误差，$\\Phi_k$ 是加性相位误差。根据问题描述，我们将这些误差建模为从指定分布中抽取的随机变量：\n-   幅度扰动 $A_k$ 通过从正态分布 $\\mathcal{N}(1+\\mu_a, \\sigma_a^2)$ 中抽取并裁剪在零处以确保非负性来建模：$A_k = \\max(0, \\mathcal{N}(1+\\mu_a, \\sigma_a^2))$。\n-   相位误差 $\\Phi_k$ 从零均值正态分布中抽取：$\\Phi_k \\sim \\mathcal{N}(0, \\sigma_\\phi^2)$。\n\n模拟展开从一个随机初始条件 $u(x,0)$ 开始，该条件从标准正态分布生成。超过 $T=100$ 步的展开稳定性通过监测离散 $\\ell^2$ 范数来确定，此处定义为均方根范数 $||u^n||_2 = \\sqrt{\\frac{1}{N}\\sum_{j=0}^{N-1} |u_j^n|^2}$。如果范数放大超过阈值 $G_{\\mathrm{thr}} = 100$，即对于任何步骤 $n \\in \\{1, \\dots, T\\}$，有 $||u^n||_2 / ||u^0||_2 > G_{\\mathrm{thr}}$，则宣布模拟不稳定。\n\n为每个测试用例模拟了两种展开情景：\n1.  **无约束展开**：在每一步使用带噪声的预测 $u_k^{n+1} = G_k^{\\mathrm{pred}} u_k^n$ 更新傅里叶系数。如果任何 $|G_k^{\\mathrm{pred}}| > 1$ 或相位误差累积产生破坏性影响，该方法容易变得不稳定。\n\n2.  **有约束展开**：在每个更新步骤之前，将预测的放大因子 $G_k^{\\mathrm{pred}}$ 修改为约束版本 $G_k^{\\mathrm{cfl}}$，$u_k^{n+1} = G_k^{\\mathrm{cfl}} u_k^n$。$G_k^{\\mathrm{cfl}}$ 的设计遵循指定的定性要求：\n    a.  **幅度界限**：放大因子的模不能超过1。设 $G_k^{\\mathrm{pred}} = |G_k^{\\mathrm{pred}}| \\exp(\\mathrm{i} \\psi_k^{\\mathrm{pred}})$。我们通过裁剪预测的模来强制 $|G_k^{\\mathrm{cfl}}| \\le 1$：$|G_k^{\\mathrm{cfl}}|' = \\min(|G_k^{\\mathrm{pred}}|, 1)$。\n    b.  **相位增量界限**：放大因子的相位 $\\psi_k$ 必须满足 $|\\psi_k| \\le |k c \\Delta t|$。这是一个谱CFL条件，确保任何模式的数值相速度不超过物理平流速度。预测的相位是 $\\psi_k^{\\mathrm{pred}} = -kc\\Delta t + \\Phi_k$。我们通过裁剪相位来强制执行该约束：$\\psi_k^{\\mathrm{cfl}} = \\text{clip}(\\psi_k^{\\mathrm{pred}}, -|kc\\Delta t|, |kc\\Delta t|)$。\n    c.  **额外阻尼**：对于CFL比率 $r > 1$，引入一个额外的阻尼因子，该因子随CFL超出量 $r-1$ 和归一化波数 $|k|/k_{\\max}$ 的增加而增加。我们将其表示为应用于幅度的乘性因子 $D_k$：\n        $$\n        D_k = \n        \\begin{cases} \n        \\max\\left(0, 1 - (r-1) \\frac{|k|}{k_{\\max}}\\right)  \\text{if } r > 1 \\\\\n        1  \\text{if } r \\le 1 \n        \\end{cases}\n        $$\n    最终的约束放大因子通过组合这些修改来构建：\n    $$\n    G_k^{\\mathrm{cfl}} = \\min(|G_k^{\\mathrm{pred}}|, 1) \\cdot D_k \\cdot \\exp(\\mathrm{i} \\cdot \\text{clip}(\\psi_k^{\\mathrm{pred}}, -|kc\\Delta t|, |kc\\Delta t|))\n    $$\n此设计通过构造确保了有约束的展开保持稳定，防止了幅度爆炸和非物理信息传播速度。程序将为提供的测试套件执行这些模拟，并报告每种情况下无约束和有约束展开的稳定性。为了可复现性，使用固定的随机种子。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of mapping stability regions for a Fourier surrogate model\n    of the 1D linear advection equation.\n    \"\"\"\n\n    # --- Simulation Parameters ---\n    L = 2.0 * np.pi  # Domain length (meters)\n    N = 64           # Number of grid points\n    T = 100          # Number of time steps for roll-out\n    G_thr = 100.0    # Norm growth threshold for instability\n\n    # --- Test Suite ---\n    test_cases = [\n        # c, r, mu_a, sigma_a, sigma_phi\n        (1.0, 0.5, -0.02, 0.02, 0.05),\n        (1.0, 1.0, 0.05, 0.05, 0.10),\n        (1.0, 2.0, 0.10, 0.05, 0.15),\n        (1.0, 3.0, 0.20, 0.10, 0.20),\n        (1.0, 0.1, 0.0, 0.0, 0.0),\n    ]\n\n    # Use a fixed random seed for reproducibility\n    np.random.seed(42)\n\n    # --- Pre-computation for the grid ---\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    k_max_abs = np.pi / dx # Nyquist wavenumber\n\n    # Generate a single random initial condition for all runs\n    u0 = np.random.randn(N)\n    norm_u0 = np.linalg.norm(u0) / np.sqrt(N)\n    u0_hat = np.fft.fft(u0)\n\n    results = []\n    for case in test_cases:\n        c, r, mu_a, sigma_a, sigma_phi = case\n        \n        if c == 0:\n            # Avoid division by zero, although not in test cases\n            dt = 0\n        else:\n            dt = r * dx / abs(c)\n\n        # --- Generate Surrogate Errors ---\n        # Generate noise once per case for both roll-outs\n        # Amplitude error factor\n        A_k_noise = np.maximum(0, np.random.normal(1.0 + mu_a, sigma_a, N))\n        # Phase error (in radians)\n        Phi_k_noise = np.random.normal(0.0, sigma_phi, N)\n\n        # --- Define Amplification Factors ---\n        G_k_true = np.exp(-1j * k * c * dt)\n        G_k_pred = G_k_true * A_k_noise * np.exp(1j * Phi_k_noise)\n\n        # --- Define Constrained Amplification Factor (G_k_cfl) ---\n        # a) Amplitude bound\n        mag_pred = A_k_noise\n        mag_cfl_1 = np.minimum(mag_pred, 1.0)\n        \n        # b) Phase increment bound\n        phase_true = -k * c * dt\n        phase_pred = phase_true + Phi_k_noise\n        phase_bound = np.abs(phase_true)\n        phase_cfl = np.clip(phase_pred, -phase_bound, phase_bound)\n        \n        # c) Additional damping for r > 1\n        mag_cfl_2 = mag_cfl_1\n        if r > 1.0:\n            # Damping factor is 0 for k=k_max, 1 for k=0, and linear in between\n            damping_factor = np.maximum(0, 1.0 - (r - 1.0) * np.abs(k) / k_max_abs)\n            mag_cfl_2 = mag_cfl_1 * damping_factor\n        \n        G_k_cfl = mag_cfl_2 * np.exp(1j * phase_cfl)\n\n        # --- Run Simulations ---\n        case_results = []\n        for constrained in [False, True]:\n            u_hat = u0_hat.copy()\n            is_stable = True\n            \n            G_k = G_k_cfl if constrained else G_k_pred\n\n            for _ in range(T):\n                u_hat = G_k * u_hat\n                u_n = np.fft.ifft(u_hat)\n                norm_u_n = np.linalg.norm(u_n) / np.sqrt(N)\n                \n                if norm_u0 > 1e-9 and norm_u_n / norm_u0 > G_thr:\n                    is_stable = False\n                    break\n            \n            case_results.append(is_stable)\n        \n        results.append(case_results)\n\n    # Format the final output string to be exactly as specified\n    # e.g., [[False,True],[False,True],...]\n    result_strings = [str(pair).replace(\" \", \"\") for pair in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3369161"}]}