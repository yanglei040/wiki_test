{"hands_on_practices": [{"introduction": "本征正交分解（POD）是模型降阶的基石，但其标准形式假设了欧几里得内积。本练习将引导您处理更一般的情况，即涉及加权内积，这在有限元离散化中通常由质量矩阵 $M$ 表示。通过掌握将此问题映射为标准奇异值分解（SVD）的坐标变换技术，您将获得一项基本技能，从而能将POD应用于更广泛的计算流体力学问题 [@problem_id:3356822]。", "problem": "考虑一个与对角质量矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 相关的加权内积空间，该矩阵具有严格为正的对角元，表示计算流体动力学状态向量上 $L^2$ 内积的对称正定离散化。设 $X \\in \\mathbb{R}^{n \\times k}$ 是一个快照矩阵，其列是在不同时间采样的状态向量。一组 $r$ 个本征正交分解 (Proper Orthogonal Decomposition, POD) 模态被定义为一个矩阵 $\\Phi \\in \\mathbb{R}^{n \\times r}$ 的列，这些列满足 $M$-正交归一性条件 $\\Phi^\\top M \\Phi = I_r$，并张成一个子空间，该子空间在由 $M$ 诱导的范数（即弗罗贝尼乌斯范数 $\\|X - \\Phi \\Phi^\\top M X\\|_{M,F}$，其中 $\\|A\\|_{M,F}^2 = \\mathrm{trace}(A^\\top M A)$）下，最小化 $X$ 的均方投影误差。\n\n从这些定义以及欧几里得空间中正交投影和奇异值分解 (Singular Value Decomposition, SVD) 的基本性质出发，设计一个算法，通过将快照转换到欧几里得环境，执行标准 SVD，并在原始坐标中恢复模态，从而计算出 $M$-正交归一的 POD 模态，使得结果满足 $M$-正交归一性条件。您的算法还必须使用在欧几里得环境中获得的奇异值来量化截断 POD 子空间所捕获的能量，表示为一个介于 $0$ 和 $1$ 之间的小数。\n\n在一个单一的独立程序中实现该算法。对于下方的每个测试用例，计算：\n1. 一个布尔值，指示计算出的模态是否为 $M$-正交归一，即对于选定的数值容差 $\\varepsilon$，$\\|\\Phi^\\top M \\Phi - I_r\\|_F \\leq \\varepsilon$ 是否成立。\n2. 一个浮点数，给出前 $r$ 个模态捕获的能量分数，定义为前 $r$ 个奇异值的平方和除以在欧几里得变换后的快照矩阵中获得的所有奇异值的平方和。将此分数表示为四舍五入到八位小数的小数。\n\n使用 $\\varepsilon = 10^{-10}$。\n\n测试套件：\n- 用例 1：$n=5$, $k=4$, $M = \\mathrm{diag}([1.0, 2.0, 3.0, 0.5, 4.0])$，以及\n$$\nX = \\begin{bmatrix}\n1  0  2  -1 \\\\\n0  1  1  0 \\\\\n2  1  0  1 \\\\\n-1  0  1  2 \\\\\n0  2  -1  1\n\\end{bmatrix}, \\quad r = 2.\n$$\n- 用例 2：$n=6$, $k=5$, $M = \\mathrm{diag}([1,1,1,1,1,1])$，以及\n$$\nX = \\begin{bmatrix}\n1  0  1  2  1 \\\\\n0  1  1  2  0 \\\\\n0  0  0  0  0 \\\\\n1  2  3  6  1 \\\\\n2  1  3  6  2 \\\\\n3  0  3  6  3\n\\end{bmatrix}, \\quad r = 2.\n$$\n- 用例 3：$n=7$, $k=3$, $M = \\mathrm{diag}([10^{-8}, 10^{-4}, 10^{-2}, 1, 10^{2}, 10^{4}, 10^{8}])$，以及\n$$\nX = \\begin{bmatrix}\n1  2  3 \\\\\n0  1  0 \\\\\n3  0  1 \\\\\n4  1  -1 \\\\\n0  1  2 \\\\\n-2  0  0 \\\\\n1  -1  1\n\\end{bmatrix}, \\quad r = 2.\n$$\n- 用例 4：$n=4$, $k=2$, $M = \\mathrm{diag}([0.75, 1.25, 2.5, 0.5])$，以及\n$$\nX = \\begin{bmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1 \\\\\n-1  2\n\\end{bmatrix}, \\quad r = 2.\n$$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为\n$[b_1, f_1, b_2, f_2, b_3, f_3, b_4, f_4]$，\n其中 $b_i$ 是用例 $i$ 的布尔值正交归一性检查结果，$f_i$ 是用例 $i$ 的能量分数，四舍五入到八位小数。", "solution": "**问题验证**\n\n**第 1 步：提取已知信息**\n- **内积空间：** 一个加权内积空间由一个对角质量矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 定义，其对角元严格为正。对于向量 $u, v \\in \\mathbb{R}^n$，此内积为 $\\langle u, v \\rangle_M = u^\\top M v$。\n- **快照矩阵：** $X \\in \\mathbb{R}^{n \\times k}$ 的列包含状态向量。\n- **本征正交分解 (POD) 模态：** 一组 $r$ 个模态，由矩阵 $\\Phi \\in \\mathbb{R}^{n \\times r}$ 的列表示。\n- **$M$-正交归一性条件：** 模态必须满足 $\\Phi^\\top M \\Phi = I_r$，其中 $I_r$ 是 $r \\times r$ 的单位矩阵。\n- **优化目标：** 由 $\\Phi$ 的列张成的子空间必须最小化投影误差的均方值，该值使用加权弗罗贝尼乌斯范数 $\\|X - \\Phi \\Phi^\\top M X\\|_{M,F}$ 定义，其中 $\\|A\\|_{M,F}^2 = \\mathrm{trace}(A^\\top M A)$。\n- **算法约束：** 计算必须通过将问题转换到欧几里得环境，应用标准奇异值分解 (SVD)，然后将结果转换回来的方式执行。\n- **要求输出：**\n    1. 一个布尔值，表示正交归一性检查 $\\|\\Phi^\\top M \\Phi - I_r\\|_F \\leq \\varepsilon$ 的结果，容差为 $\\varepsilon = 10^{-10}$。\n    2. 前 $r$ 个模态捕获的能量分数，定义为 $(\\sum_{i=1}^r \\sigma_i^2) / (\\sum_{j} \\sigma_j^2)$，其中 $\\sigma_i$ 是在变换后的欧几里得空间中通过 SVD 得到的奇异值。此分数需四舍五入到八位小数。\n- **测试套件：** 提供了四个具体的测试用例，包含矩阵 $M$、$X$ 以及整数 $n, k, r$。\n\n**第 2 步：使用提取的已知信息进行验证**\n- **科学依据：** 该问题在模型降阶理论，特别是本征正交分解 (POD) 中有坚实的基础。使用加权内积（$M$-内积）是 POD 的一个标准扩展，在有限元分析中很常见，其中 $M$ 代表质量矩阵。通过坐标变换将加权范数优化与标准 SVD 联系起来，是一种基本且正确的技术。\n- **适定性：** 问题是适定的。通过在变换空间中应用 Eckart-Young-Mirsky 定理，可以保证最优子空间的存在性和唯一性（在符号差异范围内）。每个测试用例的已知信息是完整且足以执行所需算法的。\n- **客观性：** 问题以数学精度陈述。所有术语、范数和目标都有正式定义。没有歧义或主观性。\n\n**缺陷清单：**\n1. **科学或事实不健全：** 无。前提与已建立的线性代数和数值分析原理一致。\n2. **非形式化或不相关：** 无。该问题是计算科学中一个具体、可形式化的任务。\n3. **不完整或矛盾的设置：** 无。所有必要的数据和定义都已提供并且是一致的。\n4. **不切实际或不可行：** 无。矩阵维度很小，计算完全在标准数值库的能力范围内。规定了 $M$ 的对角元严格为正，并满足此条件，确保 $M$ 是正定的，其平方根是明确定义的。\n5. **不适定或结构不良：** 无。问题结构导向一个唯一、稳定的解。\n6. **伪深刻、琐碎或同义反复：** 无。该问题需要对如何在 SVD 的背景下处理非欧几里得范数有非凡的理解，是计算方法中的一个合理练习。\n7. **超出科学可验证性：** 无。所得模态和能量计算的正确性完全可以通过直接计算进行验证。\n\n**第 3 步：结论和行动**\n该问题是**有效的**。将开发并呈现一个解决方案。\n\n**算法推导**\n\n目标是找到一个 $M$-正交归一基 $\\Phi \\in \\mathbb{R}^{n \\times r}$，以最小化投影误差 $\\|X - \\Phi\\Phi^\\top M X\\|_{M,F}$。该方法的核心是将此问题转换为一个在标准欧几里得空间中的等价问题。\n\n加权内积定义为 $\\langle u, v \\rangle_M = u^\\top M v$。由于 $M$ 是一个对角元严格为正的对角矩阵，因此它是对称正定的。我们可以定义一个矩阵 $M^{1/2}$，它是一个对角矩阵，其对角元是 $M$ 对角元的平方根。因此，$M = M^{1/2} M^{1/2}$。\n\n考虑对任意向量 $v \\in \\mathbb{R}^n$ 进行坐标变换，得到一个新向量 $\\tilde{v} \\in \\mathbb{R}^n$，定义为 $\\tilde{v} = M^{1/2} v$。这个变换空间中的标准欧几里得内积与原始空间中的加权内积关系如下：\n$$\n\\langle \\tilde{u}, \\tilde{v} \\rangle = \\tilde{u}^\\top \\tilde{v} = (M^{1/2} u)^\\top (M^{1/2} v) = u^\\top (M^{1/2})^\\top M^{1/2} v = u^\\top M v = \\langle u, v \\rangle_M\n$$\n这表明原始向量的 $M$-内积等价于变换后向量的欧几里得内积。因此，最小化由 $M$ 诱导的范数中的误差等价于在变换空间中最小化标准欧几里得范数中的误差。\n\n我们将此变换应用于快照矩阵 $X$：\n$$\n\\tilde{X} = M^{1/2} X\n$$\n现在问题是在欧几里得空间中找到 $\\tilde{X}$ 数据的最优秩-$r$ 近似。这是欧几里得空间中的标准 POD 问题，可以通过对 $\\tilde{X}$ 进行奇异值分解 (SVD) 来解决。设 $\\tilde{X}$ 的 SVD 为：\n$$\n\\tilde{X} = U \\Sigma V^\\top\n$$\n这里，$U \\in \\mathbb{R}^{n \\times p}$（其中 $p = \\min(n, k)$）的列是左奇异向量，它们构成一个正交归一基。用于近似 $\\tilde{X}$ 的列的最优 $r$ 维子空间由前 $r$ 个左奇异向量张成。我们将这些向量组成的矩阵表示为 $U_r \\in \\mathbb{R}^{n \\times r}$。这些是变换空间中的 POD 模态，我们称之为 $\\tilde{\\Phi} = U_r$。它们满足标准正交归一性条件 $\\tilde{\\Phi}^\\top \\tilde{\\Phi} = U_r^\\top U_r = I_r$。\n\n为了获得原始空间中的 POD 模态 $\\Phi$，我们必须逆转变换：\n$$\n\\tilde{\\Phi} = M^{1/2} \\Phi \\implies \\Phi = M^{-1/2} \\tilde{\\Phi} = M^{-1/2} U_r\n$$\n这里，$M^{-1/2}$ 是对角元为 $1/\\sqrt{M_{ii}}$ 的对角矩阵。\n\n我们必须验证这些模态满足 $M$-正交归一性条件 $\\Phi^\\top M \\Phi = I_r$：\n$$\n\\Phi^\\top M \\Phi = (M^{-1/2} U_r)^\\top M (M^{-1/2} U_r) = U_r^\\top (M^{-1/2})^\\top M M^{-1/2} U_r\n$$\n由于 $M^{-1/2}$ 是对角的，它是对称的，所以 $(M^{-1/2})^\\top = M^{-1/2}$。\n$$\n\\Phi^\\top M \\Phi = U_r^\\top M^{-1/2} M M^{-1/2} U_r = U_r^\\top (M^{-1/2} M^{1/2})(M^{1/2} M^{-1/2}) U_r = U_r^\\top I I U_r = U_r^\\top U_r = I_r\n$$\n该条件得到满足。这证实了 $\\Phi = M^{-1/2} U_r$ 是正确的 $M$-正交归一 POD 模态。\n\n由前 $r$ 个模态捕获的能量分数是使用从变换矩阵 $\\tilde{X}$ 的 SVD 中获得的奇异值 $\\sigma_i$ 计算的。快照中的总能量（在加权范数下）与 $\\mathrm{trace}(\\tilde{X}^\\top \\tilde{X}) = \\sum_j \\sigma_j^2$ 成正比。由前 $r$ 个模态捕获的能量是 $\\sum_{i=1}^r \\sigma_i^2$。因此，分数为：\n$$\nf = \\frac{\\sum_{i=1}^r \\sigma_i^2}{\\sum_{j=1}^{\\min(n,k)} \\sigma_j^2}\n$$\n\n算法如下：\n1. 给定 $M$（作为对角元向量）、$X$ 和 $r$，构造对角变换矩阵 $M^{1/2}$ 和 $M^{-1/2}$。在实现中，为提高效率，操作可以直接使用对角元向量。\n2. 计算变换后的快照矩阵 $\\tilde{X} = M^{1/2} X$。\n3. 计算 $\\tilde{X}$ 的 SVD 以获得 $U$ 和奇异值 $\\sigma_j$。\n4. 提取 $U$ 的前 $r$ 列以形成 $U_r$。\n5. 计算 POD 模态 $\\Phi = M^{-1/2} U_r$。\n6. 为了验证，计算误差矩阵 $\\|\\Phi^\\top M \\Phi - I_r\\|_F$ 的弗罗贝尼乌斯范数，并检查其是否小于或等于容差 $\\varepsilon=10^{-10}$。\n7. 使用上述公式计算能量分数 $f$。\n此过程将应用于每个测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes M-orthonormal POD modes and captured energy for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"n\": 5, \"k\": 4, \"r\": 2,\n            \"M_diag\": np.array([1.0, 2.0, 3.0, 0.5, 4.0]),\n            \"X\": np.array([\n                [1, 0, 2, -1],\n                [0, 1, 1, 0],\n                [2, 1, 0, 1],\n                [-1, 0, 1, 2],\n                [0, 2, -1, 1]\n            ])\n        },\n        {\n            \"n\": 6, \"k\": 5, \"r\": 2,\n            \"M_diag\": np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"X\": np.array([\n                [1, 0, 1, 2, 1],\n                [0, 1, 1, 2, 0],\n                [0, 0, 0, 0, 0],\n                [1, 2, 3, 6, 1],\n                [2, 1, 3, 6, 2],\n                [3, 0, 3, 6, 3]\n            ])\n        },\n        {\n            \"n\": 7, \"k\": 3, \"r\": 2,\n            \"M_diag\": np.array([1e-8, 1e-4, 1e-2, 1, 1e2, 1e4, 1e8]),\n            \"X\": np.array([\n                [1, 2, 3],\n                [0, 1, 0],\n                [3, 0, 1],\n                [4, 1, -1],\n                [0, 1, 2],\n                [-2, 0, 0],\n                [1, -1, 1]\n            ])\n        },\n        {\n            \"n\": 4, \"k\": 2, \"r\": 2,\n            \"M_diag\": np.array([0.75, 1.25, 2.5, 0.5]),\n            \"X\": np.array([\n                [1, 0],\n                [0, 1],\n                [1, 1],\n                [-1, 2]\n            ])\n        }\n    ]\n\n    epsilon = 1e-10\n    results = []\n\n    for case in test_cases:\n        M_diag = case[\"M_diag\"]\n        X = case[\"X\"]\n        r = case[\"r\"]\n\n        # 1. Compute diagonal transformation operators from M.\n        M_sqrt_diag = np.sqrt(M_diag)\n        M_inv_sqrt_diag = 1.0 / M_sqrt_diag\n\n        # 2. Transform the snapshot matrix to the Euclidean setting.\n        # Broadcasting (n,1) * (n,k) is more efficient than full matrix multiplication.\n        X_tilde = M_sqrt_diag[:, np.newaxis] * X\n\n        # 3. Perform SVD on the transformed snapshot matrix.\n        # `full_matrices=False` is used for efficiency.\n        U, s, Vt = np.linalg.svd(X_tilde, full_matrices=False)\n\n        # 4. Extract the first r transformed modes (leading left singular vectors).\n        Ur = U[:, :r]\n\n        # 5. Transform the modes back to the original weighted inner product space.\n        Phi = M_inv_sqrt_diag[:, np.newaxis] * Ur\n\n        # 6. Verify the M-orthonormality of the computed modes.\n        M_mat = np.diag(M_diag)\n        identity_r = np.eye(r)\n        check_matrix = Phi.T @ M_mat @ Phi\n        ortho_error = np.linalg.norm(check_matrix - identity_r, 'fro')\n        is_orthonormal = ortho_error = epsilon\n\n        # 7. Calculate the fraction of energy captured by the r modes.\n        s_squared = s**2\n        captured_energy = np.sum(s_squared[:r])\n        total_energy = np.sum(s_squared)\n        \n        if total_energy  0:\n            energy_fraction = captured_energy / total_energy\n        else:\n            # This case happens if X is a zero matrix. Assume non-zero data.\n            # If captured and total are both 0, fraction is ill-defined.\n            # Depending on definition, can be 0 or 1. If r>0 and cap=0, tot=0, then 1.\n            # If r=0, cap=0, tot=0, then 0.\n            # For this problem's context with non-zero X, this branch is not taken.\n            energy_fraction = 1.0 if r  0 and captured_energy == 0 else 0.0\n\n        results.append(str(is_orthonormal).lower())\n        results.append(f\"{energy_fraction:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3356822"}, {"introduction": "真实世界的数据不可避免地会受到噪声的污染，这可能导致降阶模型中出现虚假的、非物理的模态。本练习介绍了一种强大的技术来解决此问题，即基于随机矩阵理论中的 Gavish-Donoho 阈值来确定一个最优的截断阶数 $r$。这使您能够系统地将相干的高能结构与噪声基底分离，从而构建出更鲁棒且具有物理意义的模型 [@problem_id:3356836]。", "problem": "一个来自涡主导尾流的计算流体动力学模拟的无量纲平面速度场的一系列等时间间隔快照，通过在 $n$ 个连续时间瞬间对状态向量进行标准堆叠，被收集到一个快照矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times n}$ 中。测量结果受到标准差为 $\\sigma$ 的加性、零均值、独立同分布的高斯噪声污染。对 $\\mathbf{X}$ 进行奇异值分解 (SVD) 后，得到按降序排列的奇异值 $\\{\\sigma_{i}\\}_{i=1}^{n}$。\n\n使用以下科学上合理的数据：\n- 矩阵大小为 $n = 400$（方形）。\n- 估计的无量纲噪声水平为 $\\sigma = 0.05$。\n- 测得的前导奇异值为\n$$\n\\{\\sigma_{i}\\}_{i=1}^{20} = \\{9.0,\\; 7.5,\\; 6.0,\\; 5.0,\\; 3.0,\\; 2.5,\\; 2.0,\\; 1.7,\\; 1.4,\\; 1.2,\\; 1.0,\\; 0.8,\\; 0.6,\\; 0.5,\\; 0.4,\\; 0.35,\\; 0.3,\\; 0.25,\\; 0.2,\\; 0.15\\}.\n$$\n\n从奇异值分解的基本定义和标准含噪快照模型出发，并引用纯噪声矩阵的渐近随机矩阵行为，推导出适用于方形情况的 Gavish–Donoho 通用硬阈值，并应用它来选择用于本征正交分解 (POD) 截断的降阶秩 $r$。然后，从动态模态分解 (DMD) 的第一性原理出发，定性地解释这种秩选择如何影响计算出的 DMD 谱（特征值和振幅），重点关注对虚假的噪声主导内容的抑制。\n\n仅报告所选的秩 $r$ 作为最终答案。无需舍入指令，答案无单位。", "solution": "用户要求我解决一个包含两部分任务的问题。首先，推导并应用 Gavish-Donoho 硬阈值，以确定对含噪数据矩阵进行本征正交分解 (POD) 截断的最优秩。其次，解释这种秩选择对后续动态模态分解 (DMD) 分析的影响。\n\n### 第 1 步：提取已知条件\n- 快照矩阵：$\\mathbf{X} \\in \\mathbb{R}^{n \\times n}$\n- 矩阵大小：$n = 400$\n- 噪声模型：加性、零均值、独立同分布 (i.i.d.) 的高斯噪声。\n- 噪声标准差：$\\sigma = 0.05$\n- 测得的奇异值：$\\{\\sigma_{i}\\}_{i=1}^{n}$，按降序排列。\n- 前 $20$ 个测得的奇异值为：\n$$\n\\{\\sigma_{i}\\}_{i=1}^{20} = \\{9.0,\\; 7.5,\\; 6.0,\\; 5.0,\\; 3.0,\\; 2.5,\\; 2.0,\\; 1.7,\\; 1.4,\\; 1.2,\\; 1.0,\\; 0.8,\\; 0.6,\\; 0.5,\\; 0.4,\\; 0.35,\\; 0.3,\\; 0.25,\\; 0.2,\\; 0.15\\}.\n$$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，借鉴了计算流体动力学、降阶模型 (POD, DMD) 和随机矩阵理论中的既定原理。使用从随机矩阵理论推导出的硬阈值对奇异值谱进行去噪的前提，是现代数据分析中一种标准且被广泛接受的技术。该问题是适定的，提供了计算唯一秩 $r$ 所需的所有数据。其语言客观，数据对于一个无量纲流体动力学问题而言在物理上是合理的。该问题并非微不足道，需要特定的推导及其应用。该问题是有效的。\n\n### 最优硬阈值的推导\n\n该问题将测量的快照矩阵 $\\mathbf{X}$ 建模为真实低秩信号矩阵 $\\mathbf{X}_{\\text{true}}$ 和噪声矩阵 $\\mathbf{N}$ 的和：\n$$\n\\mathbf{X} = \\mathbf{X}_{\\text{true}} + \\mathbf{N}\n$$\n其中 $\\mathbf{X}, \\mathbf{X}_{\\text{true}}, \\mathbf{N} \\in \\mathbb{R}^{n \\times n}$。噪声矩阵 $\\mathbf{N}$ 的元素是从均值为 $0$、方差为 $\\sigma^2$ 的高斯分布中抽取的独立同分布 (i.i.d.) 随机变量。\n\n硬阈值背后的核心原理是识别仅由噪声矩阵 $\\mathbf{N}$ 产生的奇异值范围。测量矩阵 $\\mathbf{X}$ 的奇异值中，大于纯噪声所预期的最大奇异值的部分，被认为属于信号 $\\mathbf{X}_{\\text{true}}$。\n\n我们引用随机矩阵理论 (RMT) 的一个基本结果，即 Marchenko-Pastur 定律，它描述了样本协方差矩阵的特征值分布。让我们考虑矩阵 $\\mathbf{C} = \\frac{1}{n}\\mathbf{N}^T\\mathbf{N}$。在矩阵维度较大 ($n \\to \\infty$) 的极限下，$\\mathbf{C}$ 的特征值 $\\lambda$ 的分布会收敛到一个特定的概率密度函数。该分布的支撑集（即包含特征值的区间）由下式给出：\n$$\n\\lambda \\in [\\sigma^2(1 - \\sqrt{\\beta})^2, \\sigma^2(1 + \\sqrt{\\beta})^2]\n$$\n其中 $\\beta = m/n$ 是矩阵的纵横比。在这个问题中，矩阵是方形的，所以 $m=n=400$，纵横比为 $\\beta = 1$。\n\n将 $\\beta=1$ 代入支撑集区间，我们得到：\n$$\n[\\sigma^2(1 - \\sqrt{1})^2, \\sigma^2(1 + \\sqrt{1})^2] = [\\sigma^2(0)^2, \\sigma^2(2)^2] = [0, 4\\sigma^2]\n$$\n这个结果意味着，对于一个大的方形噪声矩阵，归一化协方差矩阵 $\\frac{1}{n}\\mathbf{N}^T\\mathbf{N}$ 的所有特征值都包含在区间 $[0, 4\\sigma^2]$ 内。最大特征值渐近地趋近于上界：\n$$\n\\lambda_{\\max}\\left(\\frac{1}{n}\\mathbf{N}^T\\mathbf{N}\\right) \\to 4\\sigma^2\n$$\n噪声矩阵 $\\mathbf{N}$ 的奇异值 $s_i$ 与 $\\mathbf{N}^T\\mathbf{N}$ 的特征值通过 $s_i^2 = \\lambda_i(\\mathbf{N}^T\\mathbf{N})$ 相关联。我们可以用 $\\mathbf{C}$ 的特征值来重写这个关系：\n$$\ns_i^2 = \\lambda_i(n\\mathbf{C}) = n \\lambda_i(\\mathbf{C}) \\implies s_i = \\sqrt{n \\lambda_i(\\mathbf{C})}\n$$\n因此，噪声矩阵 $\\mathbf{N}$ 的最大奇异值 $s_{\\max}$ 渐近地趋近于：\n$$\ns_{\\max} \\to \\sqrt{n \\cdot \\lambda_{\\max}(\\mathbf{C})} = \\sqrt{n \\cdot 4\\sigma^2} = 2\\sigma\\sqrt{n}\n$$\n这个值就是通用硬阈值，对于这种方形情况，通常归功于 Gavish 和 Donoho。我们用 $\\tau$ 表示这个阈值。测量矩阵 $\\mathbf{X}$ 中任何大于此阈值的奇异值都被视为信号的一部分，而任何等于或小于此阈值的奇异值则被认为与噪声无法区分。\n$$\n\\tau = 2\\sigma\\sqrt{n}\n$$\n\n### 应用于选择降阶秩 $r$\n\n给定数值 $n = 400$ 和 $\\sigma = 0.05$。我们现在可以计算阈值 $\\tau$：\n$$\n\\tau = 2 \\times 0.05 \\times \\sqrt{400} = 0.1 \\times 20 = 2.0\n$$\n秩 $r$ 的选择是通过计算数据矩阵 $\\mathbf{X}$ 中严格大于此阈值的奇异值 $\\{\\sigma_i\\}$ 的数量来确定的。\n$$\nr = \\text{count}\\{i \\mid \\sigma_i > \\tau\\}\n$$\n使用提供的奇异值列表和计算出的阈值 $\\tau=2.0$：\n- $\\sigma_1 = 9.0 > 2.0$\n- $\\sigma_2 = 7.5 > 2.0$\n- $\\sigma_3 = 6.0 > 2.0$\n- $\\sigma_4 = 5.0 > 2.0$\n- $\\sigma_5 = 3.0 > 2.0$\n- $\\sigma_6 = 2.5 > 2.0$\n- $\\sigma_7 = 2.0 \\ngtr 2.0$\n- $\\sigma_8 = 1.7 \\ngtr 2.0$\n... 并且所有后续的奇异值也都小于 $2.0$。\n\n前 $6$ 个奇异值严格大于阈值。因此，POD 截断的最优秩为 $r=6$。\n\n### 对动态模态分解 (DMD) 的定性影响\n\n在应用 DMD 之前，以秩 $r$ 进行的 POD 截断是一个关键的去噪步骤。\n动态模态分解 (DMD) 旨在寻找一个最佳拟合的线性算子 $\\mathbf{A}$，该算子可以使系统状态随时间演进，即 $\\mathbf{x}_{k+1} \\approx \\mathbf{A}\\mathbf{x}_k$。该算法根据快照数据计算此算子及其谱特性（特征值和特征向量）。DMD 算法的一种常见且稳健的变体是首先将数据投影到低秩 POD 基上。快照矩阵 $\\mathbf{X}$（或其子矩阵）的 SVD 产生 POD 基 $\\mathbf{U}$。将此基截断为其前 $r$ 列 $\\mathbf{U}_r$，可将数据投影到一个捕获流场中能量最集中结构的子空间上。\n\n秩 $r$ 的选择至关重要。奇异值谱 ($\\{\\sigma_i\\}$) 揭示了能量在 POD 模态间的分布。具有大奇异值的前几个模态通常代表大规模、相干且具有物理意义的结构（例如，涡、脱落模式）。具有小奇异值的尾随模态与精细尺度结构相关，并且关键的是，它们主要由测量噪声主导。噪声通常是一个高维随机过程，不遵循 DMD 旨在识别的低维线性动力学。\n\n如果选择的秩 $r$ 远大于最优秩，那么含噪的 POD 模态将被包含在动力学投影到的子空间中。当 DMD 算法试图对这些受噪声污染的数据拟合线性模型时，它会产生大量虚假的 DMD 模态和特征值。由此产生的 DMD 谱（复平面上的特征值集合）会被许多没有物理意义的特征值所污染，这些特征值通常散布在单位圆内。这会掩盖系统的真实动力学，并降低 DMD 模型的质量和可解释性。\n\n通过根据 Gavish-Donoho 硬阈值选择秩 $r=6$，我们系统地滤除了由噪声主导的子空间维度。然后，DMD 算法被应用于系统的“净化”表示，该表示只包含相干的、高能量的动力学。这会得到一个更干净的 DMD 谱，其中包含少数几个主导特征值，这些特征值准确地代表了潜在物理现象的频率和增长/衰减率。对虚假的、由噪声驱动的内容的抑制，会产生一个更稳健、准确且物理上可解释的流体流动降阶模型。", "answer": "$$\n\\boxed{6}\n$$", "id": "3356836"}, {"introduction": "在使用 POD 识别空间模态后，动态模态分解（DMD）可以提供其时间动态特性，但对其结果的解释需要谨慎。本练习旨在解决一个关键问题：频率混叠，该问题在将离散时间的 DMD 特征值映射到其连续时间对应物时出现。通过推导奈奎斯特准则并将其应用于多频流动，您将学习如何选择一个合适的快照时间间隔 $\\Delta t$，以确保能够无歧义地恢复物理振荡频率 [@problem_id:3356844]。", "problem": "考虑一个计算流体动力学场景，其中可解流场可观测量的时域演化由一个线性时不变生成元建模。设状态向量为 $\\mathbf{x}(t)$，其演化遵循形式为 $\\dot{\\mathbf{x}}(t) = \\mathbf{L}\\,\\mathbf{x}(t)$ 的连续时间线性系统，其中 $\\mathbf{L}$ 是一个（可能非正规的）线性算子。在步长为 $\\Delta t$ 的均匀快照采样下，像动态模态分解 (DMD) 这样的数据驱动方法会估计单个采样间隔内有限时间流映射的特征值。在多频流中，由于复对数的多值性，当从离散时间估计中恢复连续时间振荡频率时，这种映射会引入模糊性。\n\n从连续时间演化算子和单个间隔 $\\Delta t$ 上的有限时间传播子的定义出发，推导连续时间生成元的特征值与在间隔 $\\Delta t$ 采样的有限时间流映射的特征值之间的关系。解释当从离散时间特征值映射到连续时间特征值时，其虚部出现模糊性的来源。然后，针对具有有界频率内容的多频流，提出并论证一个关于 $\\Delta t$ 的步长准则，该准则能保证所有物理相关模态的连续时间频率得以唯一恢复。最后，将您的准则应用于以下场景，并说明所选步长是否避免了模糊性：流场包含振荡分量，其角频率有界，满足 $|\\omega_j| \\le \\omega_{\\max}$，其中 $\\omega_{\\max} = 1200\\,\\mathrm{rad/s}$，快照采样步长为 $\\Delta t = 2.5\\times 10^{-3}\\,\\mathrm{s}$。\n\n选择下面的最佳选项。\n\nA. 使用复对数的主分支将离散时间特征值映射到连续时间特征值，对于所有模态 $j$ 都是唯一的，当且仅当 $|\\omega_j|  \\pi/\\Delta t$。因此，在多频流中避免支割模糊性的充分必要准则是 $\\Delta t  \\pi/\\omega_{\\max}$。对于 $\\omega_{\\max} = 1200\\,\\mathrm{rad/s}$，这给出 $\\Delta t_{\\max} \\approx \\pi/1200 \\approx 2.618\\times 10^{-3}\\,\\mathrm{s}$，所以 $\\Delta t = 2.5\\times 10^{-3}\\,\\mathrm{s}$ 避免了模糊性。\n\nB. 唯一性要求对每个模态 $j$ 都有 $|\\omega_j|  2\\pi/\\Delta t$。因此准则是 $\\Delta t  2\\pi/\\omega_{\\max}$。对于 $\\omega_{\\max} = 1200\\,\\mathrm{rad/s}$，这给出 $\\Delta t_{\\max} \\approx 2\\pi/1200 \\approx 5.236\\times 10^{-3}\\,\\mathrm{s}$，所以 $\\Delta t = 2.5\\times 10^{-3}\\,\\mathrm{s}$ 避免了模糊性。\n\nC. 为避免模糊性，所有模态在快照之间的相位推进必须小于 $\\pi/2$，即 $|\\omega_j|  \\pi/(2\\Delta t)$，所以 $\\Delta t  \\pi/(2\\omega_{\\max})$。对于 $\\omega_{\\max} = 1200\\,\\mathrm{rad/s}$，这给出 $\\Delta t_{\\max} \\approx \\pi/(2\\cdot 1200) \\approx 1.309\\times 10^{-3}\\,\\mathrm{s}$，所以 $\\Delta t = 2.5\\times 10^{-3}\\,\\mathrm{s}$ 不能避免模糊性。\n\nD. 如果所有模态都是衰减的，即对每个模态 $j$ 都有 $\\sigma_j = \\Re(\\lambda_j)  0$，那么离散时间特征值的模不为1，即使当 $|\\omega_j| \\ge \\pi/\\Delta t$ 时，连续时间频率的恢复也是唯一的。因此，只要所有 $j$ 的 $\\sigma_j  0$，就不需要对 $\\Delta t$ 施加界限。", "solution": "问题陈述具有科学依据，表述清晰且客观，包含了完整推导和得出结论所需的所有信息。因此，该问题是有效的。\n\n该问题要求进行几项推导并应用其结果。我们将按步骤进行。\n\n**1. 连续时间与离散时间特征值之间的关系**\n\n系统的状态 $\\mathbf{x}(t)$ 遵循以下连续时间线性动力学系统进行演化：\n$$ \\dot{\\mathbf{x}}(t) = \\mathbf{L}\\,\\mathbf{x}(t) $$\n其中 $\\mathbf{L}$ 是连续时间生成元。该方程的形式解由矩阵指数给出：\n$$ \\mathbf{x}(t) = e^{\\mathbf{L}t}\\mathbf{x}(0) $$\n在离散时间 $t_k = k\\Delta t$（$k = 0, 1, 2, \\dots$）进行快照采样。在时刻 $t_{k+1}$ 的状态与时刻 $t_k$ 的状态通过以下方式关联：\n$$ \\mathbf{x}(t_{k+1}) = e^{\\mathbf{L}\\Delta t}\\mathbf{x}(t_k) $$\n这定义了一个离散时间线性系统 $\\mathbf{x}_{k+1} = \\mathbf{A}\\mathbf{x}_k$，其中 $\\mathbf{x}_k \\equiv \\mathbf{x}(t_k)$，离散时间传播子（或有限时间流映射）为 $\\mathbf{A} = e^{\\mathbf{L}\\Delta t}$。动态模态分解 (DMD) 的目标是从数据中近似该算子 $\\mathbf{A}$ 的特征分解。\n\n设 $\\lambda_j$ 是连续时间算子 $\\mathbf{L}$ 的一个特征值，其对应的特征向量为 $\\mathbf{v}_j$。因此，$\\mathbf{L}\\mathbf{v}_j = \\lambda_j\\mathbf{v}_j$。为了找到 $\\mathbf{A}$ 对应的特征值，我们将 $\\mathbf{A}$ 应用于 $\\mathbf{v}_j$：\n$$ \\mathbf{A}\\mathbf{v}_j = e^{\\mathbf{L}\\Delta t}\\mathbf{v}_j $$\n使用矩阵指数的级数定义 $e^{\\mathbf{X}} = \\sum_{n=0}^{\\infty} \\frac{\\mathbf{X}^n}{n!}$，我们有：\n$$ e^{\\mathbf{L}\\Delta t}\\mathbf{v}_j = \\left( \\sum_{n=0}^{\\infty} \\frac{(\\mathbf{L}\\Delta t)^n}{n!} \\right) \\mathbf{v}_j = \\sum_{n=0}^{\\infty} \\frac{(\\Delta t)^n}{n!} (\\mathbf{L}^n \\mathbf{v}_j) $$\n由于 $\\mathbf{L}^n\\mathbf{v}_j = \\lambda_j^n\\mathbf{v}_j$，表达式变为：\n$$ \\mathbf{A}\\mathbf{v}_j = \\left( \\sum_{n=0}^{\\infty} \\frac{(\\lambda_j\\Delta t)^n}{n!} \\right) \\mathbf{v}_j = e^{\\lambda_j\\Delta t}\\mathbf{v}_j $$\n这表明，如果 $\\lambda_j$ 是 $\\mathbf{L}$ 的一个特征值，那么 $\\mu_j = e^{\\lambda_j\\Delta t}$ 就是 $\\mathbf{A}$ 的对应特征值。\n\n**2. 模糊性的来源**\n\nDMD 提供了离散时间特征值 $\\mu_j$ 的估计。为了恢复连续时间系统的性质，我们必须通过反转以下关系来确定连续时间特征值 $\\lambda_j$：\n$$ \\lambda_j = \\frac{1}{\\Delta t} \\ln(\\mu_j) $$\n复对数 $\\ln(z)$ 是一个多值函数。对于任意复数 $z = |z|e^{i\\phi}$，其对数为 $\\ln(z) = \\ln|z| + i(\\phi + 2k\\pi)$，其中 $k$ 是任意整数。\n\n我们将连续时间特征值写为 $\\lambda_j = \\sigma_j + i\\omega_j$，其中 $\\sigma_j = \\Re(\\lambda_j)$ 是增长/衰减率，$\\omega_j = \\Im(\\lambda_j)$ 是角频率。\n从 $\\mu_j = e^{\\lambda_j\\Delta t}$，我们得到 $\\mu_j = e^{(\\sigma_j + i\\omega_j)\\Delta t} = e^{\\sigma_j\\Delta t}e^{i\\omega_j\\Delta t}$。\n因此，$|\\mu_j| = e^{\\sigma_j\\Delta t}$ 且 $\\mu_j$ 的辐角为 $\\arg(\\mu_j) = \\omega_j\\Delta t \\pmod{2\\pi}$。\n\n当我们从 $\\mu_j$ 计算 $\\lambda_j$ 时：\n$$ \\lambda_j = \\frac{1}{\\Delta t} \\ln(\\mu_j) = \\frac{1}{\\Delta t} \\left( \\ln|\\mu_j| + i(\\arg(\\mu_j) + 2k\\pi) \\right) $$\n分离实部和虚部：\n- 实部：$\\sigma_j = \\frac{\\ln|\\mu_j|}{\\Delta t}$。这是唯一确定的。\n- 虚部：$\\omega_j = \\frac{\\arg(\\mu_j) + 2k\\pi}{\\Delta t}$。这是模糊的，因为任何整数 $k$ 都会产生一个有效的数学解。\n这就是模糊性的来源：单个离散时间特征值 $\\mu_j$ 对应于一组无限可能的连续时间频率 $\\{\\omega_j + \\frac{2k\\pi}{\\Delta t} \\mid k \\in \\mathbb{Z}\\}$。这就是频率混叠现象。\n\n**3. 唯一恢复的步长准则**\n\n为解决此模糊性，通常假定真实频率是量值最小的那个。这对应于选择 $k=0$ 并使用复对数的主分支，其虚部位于区间 $(-\\pi, \\pi]$ 内。恢复的频率则为 $\\omega_{j,\\text{recon}} = \\frac{\\operatorname{Im}(\\text{Log}(\\mu_j))}{\\Delta t}$，其中 $\\text{Log}$ 是对数的主值。\n\n为了使这个重构的频率与真实的物理频率相匹配，即 $\\omega_{j,\\text{recon}} = \\omega_j$，单个时间步长内的相位推进 $\\omega_j \\Delta t$ 必须位于主分支区间内：\n$$ -\\pi  \\omega_j \\Delta t \\le \\pi $$\n或者，为正负频率写成更对称的形式：\n$$ |\\omega_j \\Delta t|  \\pi $$\n（使用严格不等式是为了避免在边界 $\\omega_j \\Delta t = \\pi$ 处与 $\\omega_j \\Delta t = -\\pi$ 无法区分的模糊性）。这就是奈奎斯特-香农采样准则。\n\n对于一个所有频率都有界（即 $|\\omega_j| \\le \\omega_{\\max}$）的多频流，为确保所有模态都能唯一恢复，此条件必须对最坏情况（最高频率）成立。因此，我们要求：\n$$ \\omega_{\\max} \\Delta t  \\pi $$\n这可以重排为对采样步长 $\\Delta t$ 的一个准则：\n$$ \\Delta t  \\frac{\\pi}{\\omega_{\\max}} $$\n\n**4. 应用于具体场景**\n\n我们已知：\n- 最大角频率：$\\omega_{\\max} = 1200\\,\\mathrm{rad/s}$\n- 采样步长：$\\Delta t = 2.5\\times 10^{-3}\\,\\mathrm{s}$\n\n使用推导出的准则，我们计算最大允许采样时间 $\\Delta t_{\\max}$：\n$$ \\Delta t_{\\max} = \\frac{\\pi}{\\omega_{\\max}} = \\frac{\\pi}{1200}\\,\\mathrm{s} \\approx \\frac{3.14159}{1200}\\,\\mathrm{s} \\approx 2.618 \\times 10^{-3}\\,\\mathrm{s} $$\n现在我们将所选步长 $\\Delta t$ 与此临界值进行比较：\n$$ 2.5 \\times 10^{-3}\\,\\mathrm{s}  2.618 \\times 10^{-3}\\,\\mathrm{s} $$\n条件 $\\Delta t  \\Delta t_{\\max}$ 得到满足。因此，所选步长避免了流场中存在的所有频率的模糊性。\n\n**选项评估**\n\n**A. 该选项正确陈述了奈奎斯特准则 $|\\omega_j|  \\pi/\\Delta t$，正确推导了对采样时间 $\\Delta t  \\pi/\\omega_{\\max}$ 的条件，正确地执行了计算，并为给定场景得出了正确的结论。\n**结论：正确**\n\n**B. 前提 $|\\omega_j|  2\\pi/\\Delta t$ 是不正确的。这将允许相位推进 $\\omega_j\\Delta t$ 处于 $(-2\\pi, 2\\pi)$ 范围内，这无法解决混叠模糊性（例如，相位 $1.5\\pi$ 会被混叠为 $-0.5\\pi$）。这混淆了采样频率和奈奎斯特频率。\n**结论：不正确**\n\n**C. 前提 $|\\omega_j|  \\pi/(2\\Delta t)$ 过于严格。它对应于要求每个周期超过4个样本，而奈奎斯特准则要求超过2个。虽然这个条件可以防止混叠，但它不是正确的界限。\n**结论：不正确**\n\n**D. 这个陈述是错误的。频率 $\\omega_j$ 的模糊性源于对数虚部的多值性，这与对数的实部（由 $|\\mu_j|$ 决定）无关。一个衰减模态（$\\sigma_j  0$）意味着 $|\\mu_j| = e^{\\sigma_j\\Delta t}  1$，但这与相位模糊性无关。例如，具有 $\\lambda_1 = \\sigma_j + i\\omega_j$ 和 $\\lambda_2 = \\sigma_j + i(\\omega_j + 2\\pi/\\Delta t)$ 的两个模态都映射到相同的离散特征值 $\\mu_j = e^{\\sigma_j\\Delta t}e^{i\\omega_j\\Delta t}$，因此无论 $\\sigma_j$ 的值是多少，都无法通过 DMD 区分它们。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "3356844"}]}