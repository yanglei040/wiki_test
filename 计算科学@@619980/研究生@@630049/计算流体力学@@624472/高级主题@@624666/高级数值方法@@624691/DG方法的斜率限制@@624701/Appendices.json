{"hands_on_practices": [{"introduction": "minmod 限制器是保证间断 Galerkin (DG) 方法单调性的基本工具。本练习通过一个涉及局部极值的关键场景，具体展示了限制器如何工作，即通过将解在该处平坦化来防止非物理振荡。这项实践有助于巩固对限制器核心功能的理解，是掌握斜率限制技术的第一步。[@problem_id:3443823]", "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，该方程在一个由间距 $h>0$、单元中心为 $x_{i}$ 的均匀单元网格 $\\{I_{i}\\}$ 上进行离散化。在分片线性间断 Galerkin (DG) 近似中，单元 $I_{i}$ 内的局部多项式表示为 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 表示单元平均值，$s_{i}$ 是从模态系数估计的斜率。为抑制伪振荡，同时在单调数值通量和 Forward Euler 时间更新下保持离散极值原理，我们强制要求重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 位于相邻单元平均值之间。这意味着容许的斜率必须与单边离散梯度的符号一致，且其大小不得超过它们的量值。\n\n从上述单调性约束和全变差递减 (TVD) 特性的要求出发，推导斜率 $s_{i}$ 关于单边差分 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 的限制规则，然后应用此规则计算在以下特定配置中的限制后斜率 $s_{i}^{\\ell}$：\n- 相邻单元平均值分别为 $\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$ 和 $\\bar{u}_{i+1} = 0.3$。\n- 局部无约束斜率估计为 $s_{i} = 0.9$。\n\n假设 $h>0$，且限制器是使用经典的 minmod 机制构建的，该机制应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$。请提供 $s_{i}^{\\ell}$ 的最终值，该值应为精确数，不进行四舍五入，且不包含任何物理单位。", "solution": "问题要求推导一种用于分片线性间断 Galerkin (DG) 方法的斜率限制规则，并将其应用于一个具体案例。第一步是验证问题陈述的有效性。\n\n**问题验证**\n\n第1步：提取已知条件\n-   一维标量守恒律为 $u_{t} + f(u)_{x} = 0$。\n-   计算网格由间距 $h > 0$、中心为 $x_{i}$ 的均匀单元 $\\{I_{i}\\}$ 组成。\n-   单元 $I_{i}$ 内的局部 DG 近似是一个线性多项式 $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$，其中 $\\bar{u}_{i}$ 是单元平均值，$s_{i}$ 是斜率。\n-   施加了单调性约束：重构的界面值 $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ 必须位于相邻单元平均值之间。\n-   此约束意味着容许的斜率必须与单边离散梯度 $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ 和 $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$ 的符号一致，且其大小不得超过它们的量值。\n-   用于计算的具体数值为：$\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = 0.2$，$\\bar{u}_{i+1} = 0.3$。\n-   局部无约束斜率估计为 $s_{i} = 0.9$。\n-   要使用的限制器是经典的 minmod 机制，该机制应用于集合 $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$。\n\n第2步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及 DG 方法的标准斜率限制技术（具体来说是 TVD 型限制器），这是偏微分方程数值分析中的一个成熟领域。问题是适定的，提供了所有必要数据和明确的目标。术语精确客观。没有矛盾、缺失数据或不科学的前提。该问题是计算流体力学和数值方法领域的标准练习。\n\n第3步：结论与行动\n问题被认为是有效的。将提供完整的解答。\n\n**限制规则的推导**\n\n在此背景下，斜率限制器的目标是强制执行单调性原理，防止在数值解中产生新的局部极值，这对于获得双曲守恒律的物理上有意义的、无振荡的解至关重要。问题陈述为限制后的斜率提供了核心约束，我们将对其进行形式化。\n\n令 $s_i^\\ell$ 表示限制后的斜率。单边离散梯度（或有限差分斜率）定义如下：\n-   后向差分斜率：$\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   前向差分斜率：$\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\n对 $s_i^\\ell$ 的约束如下：\n1.  **符号一致性**：斜率 $s_i^\\ell$ 必须与 $\\Delta_i^-$ 和 $\\Delta_i^+$ 两者具有相同的符号。这只有在 $\\Delta_i^-$ 和 $\\Delta_i^+$ 具有相同符号时才可能。如果它们的符号不同，这种情况发生在局部极值（峰值或谷值）处，那么没有非零斜率能与两者都符号一致。在这种情况下，为防止过冲或下冲，重构必须是常数，意味着斜率必须为零。所以，如果 $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$，则 $s_i^\\ell = 0$。\n2.  **大小约束**：斜率的量值不得超过单边离散梯度的量值。这可以转化为 $|s_i^\\ell| \\le |\\Delta_i^-|$ 和 $|s_i^\\ell| \\le |\\Delta_i^+|$。结合这些，我们得到 $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$。\n\n这些条件被 minmod 函数精确地概括了，该函数对一组参数 $\\{a_1, a_2, \\dots, a_n\\}$ 定义如下：\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n)  \\text{如果对所有 } j \\text{ 都有 } a_j > 0 \\\\\n\\max(a_1, \\dots, a_n)  \\text{如果对所有 } j \\text{ 都有 } a_j  0 \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n将此应用于两个离散梯度，满足从邻居导出的单调性界限的最大斜率为 $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$。\n\n最后一步是限制原始的、无约束的斜率 $s_{i}$。限制的原则是尽可能少地修改原始斜率。限制后的斜率 $s_i^\\ell$ 必须满足上面推导的单调性条件，同时其量值也不能大于原始斜率的量值，即 $|s_i^\\ell| \\le |s_i|$。这通过将原始斜率 $s_i$ 作为 minmod 函数的一个参数来实现。得到的限制后斜率是：\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\n根据 minmod 函数的性质，这等价于：\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\n这证实了问题陈述中指定的规则的有效性。\n\n**在特定配置下的应用**\n\n我们被要求计算给定数据的限制后斜率 $s_i^\\ell$。minmod 函数的参数是：\n1.  无约束斜率：$s_i = 0.9$。\n2.  后向差分斜率：$\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$。\n3.  前向差分斜率：$\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$。\n\nminmod 函数的三个参数是 $\\{0.9, -0.8/h, 0.1/h\\}$。我们必须确定它们的符号。因为给定 $h0$：\n-   $s_i = 0.9$ 是正的。\n-   $\\Delta_i^- = -0.8/h$ 是负的。\n-   $\\Delta_i^+ = 0.1/h$ 是正的。\n\n参数集合 $\\{0.9, -0.8/h, 0.1/h\\}$ 同时包含正值和负值。根据 minmod 函数的定义，如果参数不都具有相同的符号，则结果为零。这种情况对应于单元 $I_i$ 是一个局部最小值（$\\bar{u}_i$ 小于 $\\bar{u}_{i-1}$ 和 $\\bar{u}_{i+1}$），并且限制器正确地将重构平坦化为一个常数值（$\\bar{u}_{i}$），以防止产生新的、非物理的最小值（下冲）。\n\n因此，限制后的斜率为：\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\n最终值与网格间距 $h$ 无关。", "answer": "$$\\boxed{0}$$", "id": "3443823"}, {"introduction": "虽然限制器通常针对计算域的内部单元进行介绍，但它们在边界上的应用需要特别小心。本练习探讨了如何通过考虑信息流动的方向（特征线）来为流入和流出边界设计一致的单边限制格式。这是构建一个稳健数值求解器所必需的关键步骤，它强调了限制器不仅是一个数学公式，更是一个需要根据物理原理在不同区域进行调整的原则。[@problem_id:3362961]", "problem": "考虑一维空间中的线性标量平流方程，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n其中平流速度 $a \\in \\mathbb{R}$ 为常数，方程定义在有限区间 $[0,L]$ 上，并在 $x=0$ 和 $x=L$ 处具有适当的边界条件。假设使用多项式次数为一（分段线性）的间断伽辽金(DG)方法，在单元尺寸为 $\\Delta x$ 的均匀网格上逼近 $u(x,t)$，其中第 $i$ 个单元为 $I_{i} = [x_{i-\\frac{1}{2}},\\,x_{i+\\frac{1}{2}}]$，中心为 $x_{i}$。每个单元中的DG表示形式为\n$$\nu_{h}(x)\\big|_{I_{i}} = \\bar{u}_{i} + s_{i}\\,(x - x_{i}),\n$$\n其中 $\\bar{u}_{i}$ 是单元平均值，$s_{i}$ 是限制前的单元斜率。一个总变差递减(TVD)斜率限制器作用于 $s_{i}$，以防止产生新的极值。对于内部单元，一个经典的选择是作用于局部斜率和离散梯度集合的minmod限制器，\n$$\ns_{i}^{L} = \\operatorname{minmod}\\!\\left(s_{i},\\,D_{i}^{-},\\,D_{i}^{+}\\right),\n$$\n其中\n$$\nD_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}, \\qquad D_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x},\n$$\nminmod函数的定义为\n$$\n\\operatorname{minmod}(z_{1},\\dots,z_{m}) =\n\\begin{cases}\n\\min\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_j > 0 \\text{ for all } j, \\\\\n\\max\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_j  0 \\text{ for all } j, \\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n在边界单元处，可用的相邻单元平均值较少。基于特征线入流和出流以及迎风数值通量的第一性原理，推导用于入流和出流边界处斜率限制的一致的单边离散梯度：\n- 对于 $a  0$（入流）时位于 $x=0$ 的左边界，用边值状态 $g(t)$ 表示 $D_{0}^{-}$，并证明其与光滑线性剖面的一致性。\n- 对于 $a  0$（出流）时位于 $x=L$ 的右边界，论证为何不应使用 $D_{N-1}^{+}$，并基于可用的内部数据为 $s_{N-1}^{L}$ 提供一个一致的单边限制公式。\n\n然后，对于 $a  0$ 以及在某个固定时间的以下数值数据：\n$$\n\\Delta x = 0.05 \\text{ m}, \\quad \\bar{u}_{N-2} = 1.25, \\quad \\bar{u}_{N-1} = 1.30, \\quad s_{N-1} = 3.5 \\text{ m}^{-1},\n$$\n使用您推导的出流单边限制器，计算最右侧边界单元的限制后斜率 $s_{N-1}^{L}$。以 $\\text{m}^{-1}$ 为单位表示最终斜率。无需四舍五入。", "solution": "用户要求我分析并解决一个关于间断伽辽金(DG)方法在边界单元上进行斜率限制的问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程**：线性标量平流方程 $u_{t} + a\\,u_{x} = 0$，速度 $a \\in \\mathbb{R}$ 为常数。\n- **计算域**：一维区间 $[0,L]$。\n- **数值方法**：使用分段线性多项式 ($p=1$) 的间断伽辽金(DG)方法。\n- **网格**：均匀网格，单元尺寸为 $\\Delta x$。第 $i$ 个单元为 $I_{i} = [x_{i-\\frac{1}{2}},\\,x_{i+\\frac{1}{2}}]$，中心为 $x_{i}$。\n- **DG解的表示**：在单元 $I_i$ 内，解为 $u_{h}(x)\\big|_{I_{i}} = \\bar{u}_{i} + s_{i}\\,(x - x_{i})$，其中 $\\bar{u}_{i}$ 是单元平均值，$s_{i}$ 是（未限制的）斜率。\n- **斜率限制器（内部）**：形式为 $s_{i}^{L} = \\operatorname{minmod}\\!\\left(s_{i},\\,D_{i}^{-},\\,D_{i}^{+}\\right)$ 的总变差递减(TVD)限制器。\n- **离散梯度（内部）**：$D_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}$ 和 $D_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x}$。\n- **Minmod函数定义**：\n$$\n\\operatorname{minmod}(z_{1},\\dots,z_{m}) =\n\\begin{cases}\n\\min\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_j > 0 \\text{ for all } j,\\\\\n\\max\\{z_{1},\\dots,z_{m}\\},  \\text{if } z_j  0 \\text{ for all } j,\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n- **任务1（入流边界）**：对于 $a  0$ 时位于 $x=0$ 的左边界（单元 $I_0$），使用边值状态 $u(0,t) = g(t)$ 推导 $D_{0}^{-}$ 的表达式，并证明其一致性。\n- **任务2（出流边界）**：对于 $a  0$ 时位于 $x=L$ 的右边界（单元 $I_{N-1}$），论证为何不应使用 $D_{N-1}^{+}$，并为 $s_{N-1}^{L}$ 提出一个一致的单边限制器。\n- **任务3（计算）**：给定 $a  0$ 和数据：\n  - $\\Delta x = 0.05 \\text{ m}$\n  - $\\bar{u}_{N-2} = 1.25$\n  - $\\bar{u}_{N-1} = 1.30$\n  - $s_{N-1} = 3.5 \\text{ m}^{-1}$\n  计算限制后的斜率 $s_{N-1}^{L}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题属于偏微分方程数值方法这一成熟领域，特别是计算流体动力学。平流方程、DG方法和TVD斜率限制器都是标准课题。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它要求根据一组给定的数据和定义进行特定的推导和计算。问题清晰，并且基于该领域的标准实践可以得出唯一的、可推导的答案。\n- **客观性**：该问题使用形式化、客观的数学语言陈述。\n- **完整性与一致性**：该问题是自洽的。它提供了执行所要求的推导和最终计算所需的所有必要定义（DG逼近、minmod函数、离散梯度）和数据。物理设置（$a0$ 对应于 $x=0$ 处的入流和 $x=L$ 处的出流）与平流方程的特征线理论一致。\n- **可行性**：所有给定值对于数值模拟都是现实的。这些任务是研究生水平数值分析课程中的标准练习。\n\n**步骤3：结论与行动**\n该问题是有效的。这是一个数值分析领域中适定的、科学上合理的问题。我将继续进行求解。\n\n### 求解过程\n\n该问题要求推导DG背景下斜率限制器的边界处理方法，并进行后续计算。我们将按顺序处理每个部分。\n\n**第1部分：入流边界条件（左边界, $x=0$, $a0$）**\n\n对于平流方程 $u_t + a u_x = 0$ 且 $a0$ 的情况，信息从左向右传播。在像 $x=0$ 这样的入流边界，解由给定的边界数据 $u(0,t) = g(t)$ 决定。数值格式必须尊重这一信息流。\n\n第一个单元 $I_0 = [0, \\Delta x]$ 的限制器需要项 $D_0^{-} = \\frac{\\bar{u}_{0} - \\bar{u}_{-1}}{\\Delta x}$。这涉及到计算域外一个虚构“幽灵”单元 $I_{-1} = [-\\Delta x, 0]$ 的单元平均值 $\\bar{u}_{-1}$。$\\bar{u}_{-1}$ 的值必须以与边界条件 $g(t)$ 一致的方式定义。\n\n定义此幽灵单元平均值的一种标准方法是假设解的剖面平滑地跨越边界。让我们考虑边界附近的一个线性剖面 $u(x) = c_1 x + c_0$。\n$x=0$ 处的边界条件意味着 $u(0) = c_0 = g(t)$。\n$I_0$（中心在 $x_0 = \\frac{\\Delta x}{2}$）中的单元平均值为：\n$$\n\\bar{u}_0 = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} (c_1 x + c_0) \\,dx = \\frac{1}{\\Delta x} \\left[ c_1 \\frac{x^2}{2} + c_0 x \\right]_0^{\\Delta x} = c_1 \\frac{\\Delta x}{2} + c_0\n$$\n假设的幽灵单元 $I_{-1}$（中心在 $x_{-1} = -\\frac{\\Delta x}{2}$）中的单元平均值将是：\n$$\n\\bar{u}_{-1} = \\frac{1}{\\Delta x} \\int_{-\\Delta x}^{0} (c_1 x + c_0) \\,dx = \\frac{1}{\\Delta x} \\left[ c_1 \\frac{x^2}{2} + c_0 x \\right]_{-\\Delta x}^{0} = -c_1 \\frac{\\Delta x}{2} + c_0\n$$\n从 $\\bar{u}_0$ 的表达式中，我们得到 $c_1 \\frac{\\Delta x}{2} = \\bar{u}_0 - c_0$。将此代入 $\\bar{u}_{-1}$ 的表达式中：\n$$\n\\bar{u}_{-1} = -(\\bar{u}_0 - c_0) + c_0 = 2c_0 - \\bar{u}_0\n$$\n由于 $c_0 = g(t)$，我们将幽灵单元平均值定义为 $\\bar{u}_{-1} = 2g(t) - \\bar{u}_0$。\n\n现在我们可以写出单边离散梯度 $D_0^{-}$ 的表达式：\n$$\nD_0^{-} = \\frac{\\bar{u}_0 - \\bar{u}_{-1}}{\\Delta x} = \\frac{\\bar{u}_0 - (2g(t) - \\bar{u}_0)}{\\Delta x} = \\frac{2(\\bar{u}_0 - g(t))}{\\Delta x}\n$$\n为了证明一致性，我们检查此公式是否能恢复线性剖面 $u(x) = c_1 x + c_0$ 的精确斜率。对于这样的剖面，$u_x = c_1$，$g(t) = c_0$，并且 $\\bar{u}_0 = c_1 \\frac{\\Delta x}{2} + c_0$。将这些代入我们推导的公式中：\n$$\nD_0^{-} = \\frac{2 \\left( \\left(c_1 \\frac{\\Delta x}{2} + c_0 \\right) - c_0 \\right)}{\\Delta x} = \\frac{2 \\left(c_1 \\frac{\\Delta x}{2} \\right)}{\\Delta x} = c_1\n$$\n该公式正确地恢复了精确斜率，从而证明了其对于线性剖面的一致性。\n\n**第2部分：出流边界条件（右边界, $x=L$, $a0$）**\n\n在出流边界，特征线正在离开计算域。解由从内部传播来的信息决定。施加外部边界条件没有物理依据。任何数值边界条件都必须反映这种“无害”原则，并且只使用域内（即上游）的数据。\n\n最右侧单元 $I_{N-1}$ 的限制器名义上会涉及到 $D_{N-1}^{+} = \\frac{\\bar{u}_{N} - \\bar{u}_{N-1}}{\\Delta x}$。这需要出流边界外一个幽灵单元 $I_N$ 的平均值 $\\bar{u}_{N}$。由于信息是向外流动的，因此没有任何来自 $x  L$ 的数据应该影响 $[0,L]$ 内部的解。任何对 $\\bar{u}_N$ 的选择都将是人为的，并且会错误地将信息逆着流动方向传播，从而污染数值解。因此，不应使用离散梯度 $D_{N-1}^{+}$。\n\n为了获得一个一致的单边限制器，我们必须仅依赖可用的内部数据。对于单元 $I_{N-1}$，未限制的斜率为 $s_{N-1}$，唯一可用的、具有物理意义的离散梯度是后向梯度 $D_{N-1}^{-} = \\frac{\\bar{u}_{N-1} - \\bar{u}_{N-2}}{\\Delta x}$。这使用了来自单元 $I_{N-1}$ 和 $I_{N-2}$ 的数据，这两个单元都在域内。\n\n在出流边界处，对限制后斜率的一个一致且标准的选择是，仅将minmod函数应用于基于内部数据的可用参数。这导出了单边限制公式：\n$$\ns_{N-1}^{L} = \\operatorname{minmod}\\!\\left(s_{N-1},\\, D_{N-1}^{-}\\right)\n$$\n这通过仅与来自上游数据的趋势进行比较，确保了限制后的斜率不会引入新的振荡。\n\n**第3部分：出流单元的计算**\n\n我们被要求根据以下数据计算最右侧单元的限制后斜率 $s_{N-1}^{L}$：\n- $\\Delta x = 0.05 \\text{ m}$\n- $\\bar{u}_{N-2} = 1.25$\n- $\\bar{u}_{N-1} = 1.30$\n- $s_{N-1} = 3.5 \\text{ m}^{-1}$\n\n我们使用推导出的单边出流限制器公式：$s_{N-1}^{L} = \\operatorname{minmod}(s_{N-1}, D_{N-1}^{-})$。\n\n首先，我们计算后向离散梯度 $D_{N-1}^{-}$：\n$$\nD_{N-1}^{-} = \\frac{\\bar{u}_{N-1} - \\bar{u}_{N-2}}{\\Delta x} = \\frac{1.30 - 1.25}{0.05} = \\frac{0.05}{0.05} = 1.0 \\text{ m}^{-1}\n$$\n现在，我们将minmod函数应用于参数 $z_1 = s_{N-1} = 3.5 \\text{ m}^{-1}$ 和 $z_2 = D_{N-1}^{-} = 1.0 \\text{ m}^{-1}$。\n$$\ns_{N-1}^{L} = \\operatorname{minmod}(3.5, 1.0)\n$$\n由于两个参数（$3.5$ 和 $1.0$）都为正，minmod函数返回它们的最小值：\n$$\n\\operatorname{minmod}(3.5, 1.0) = \\min\\{3.5, 1.0\\} = 1.0\n$$\n因此，最右侧边界单元的限制后斜率为 $s_{N-1}^{L} = 1.0 \\text{ m}^{-1}$。", "answer": "$$\n\\boxed{1.0}\n$$", "id": "3362961"}, {"introduction": "为了将概念应用于更真实的计算流体动力学场景，我们必须将其推广到多维和非均匀网格上。本练习展示了如何在拉伸网格上正确应用限制原理，这在实际计算中非常普遍。它强调了正确处理从参考单元到物理单元的几何映射（由雅可比矩阵 $J$ 描述）的重要性，以确保限制器作用于物理梯度，从而避免因网格变形而产生的人为限制。[@problem_id:3362937]", "problem": "考虑一个二维标量守恒律，在计算流体动力学中一个非均匀、拉伸的四边形网格上，采用多项式次数为 $p=1$ 的间断伽辽金（DG）方法进行离散。对于一个给定的单元，其参考单元是坐标为 $(\\xi,\\eta)\\in[-1,1]^2$ 的正方形，物理映射是仿射的，定义如下：\n$$\n\\begin{pmatrix}\nx \\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nx_c \\\\\ny_c\n\\end{pmatrix}\n+\nJ\n\\begin{pmatrix}\n\\xi \\\\\n\\eta\n\\end{pmatrix},\\quad\nJ=\n\\begin{pmatrix}\n\\frac{h_x}{2}  s \\\\\n0  \\frac{h_y}{2}\n\\end{pmatrix},\n$$\n其中 $h_x=\\frac{3}{10}$，$h_y=3$，且 $s=\\frac{3}{10}$。参考单元上的 DG 解为\n$$\nu(\\xi,\\eta) = a_0 + a_1\\,\\xi + a_2\\,\\eta,\n$$\n系数为 $a_0=\\frac{6}{5}$，$a_1=\\frac{4}{5}$，以及 $a_2=\\frac{3}{2}$。\n\n需要设计一个斜率限制器，使得线性重构不会在每个面上产生新的极值。基本的单调性要求是，对于线性重构在面中心预测的值，\n$$\nu_{\\text{pred},f} = \\bar{u} + \\theta\\,\\nabla_{x} u \\cdot \\boldsymbol{r}_f,\n$$\n其中 $\\bar{u}$ 是单元平均值，$\\nabla_{x} u$ 是物理梯度，$\\boldsymbol{r}_f$ 是从单元中心到面中心的物理向量，$\\theta\\in[0,1]$ 是一个限制器参数，预测值必须位于共享该面的两个单元的平均值所构成的区间内。这个限制器必须考虑度量 $J$，以使拉伸方向不被过度限制。\n\n给定该单元四个面上的相邻单元平均值：左侧相邻单元 $u_L=\\frac{9}{10}$，右侧相邻单元 $u_R=\\frac{12}{5}$，底部相邻单元 $u_B=\\frac{3}{10}$，以及顶部相邻单元 $u_T=\\frac{27}{10}$。\n\n从第一性原理出发：\n1. 使用链式法则将物理梯度 $\\nabla_{x} u$ 用参考梯度 $\\nabla_{\\xi} u$ 和映射雅可比矩阵 $J$ 表示，然后对于给定的 $J$ 和 $(a_1,a_2)$ 计算 $\\nabla_x u$。\n2. 使用考虑了度量的面中心增量 $\\delta u_f = \\nabla_{x} u \\cdot \\boldsymbol{r}_f$，推导一个基于面的 $\\theta$ 表达式，该表达式在每个面上强制满足单调性要求。明确展示度量缩放是如何引入的，并根据 $(a_1,a_2)$ 和 $J$ 计算每个面的 $\\delta u_f$。然后确定每个面允许的 $\\theta$，并取所有面中的最小值。\n\n给出该单元的限制器参数 $\\theta$ 的最终值。最终答案必须是一个实数。无需四舍五入。", "solution": "用户在计算流体动力学领域提供了一个良定问题，特别是关于在一个拉伸的四边形单元上应用间断伽辽金（DG）方法的斜率限制器。该问题有科学依据，内部一致，并包含唯一解所需的所有数据。验证过程的结论是该问题有效。\n\n目标是计算给定单元的限制器参数 $\\theta$。这需要两个主要步骤：首先，计算解的物理梯度 $\\nabla_x u$；其次，使用该梯度为每个面推导和评估允许的限制器参数，最终找到该单元的最小值。\n\n首先，我们确定解的单元平均值。对于包含常数项的多项式基的DG方法，单元平均值 $\\bar{u}$ 就是常数基函数的系数。在本例中，参考单元上的基是 $\\{1, \\xi, \\eta\\}$，解为 $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta$。因此，单元平均值 $\\bar{u}$ 是系数 $a_0$。\n给定 $a_0 = \\frac{6}{5}$，我们有：\n$$\n\\bar{u} = \\frac{6}{5}\n$$\n\n**1. 物理梯度 $\\nabla_x u$ 的计算**\n\n物理梯度 $\\nabla_x u = \\begin{pmatrix} \\partial u / \\partial x \\\\ \\partial u / \\partial y \\end{pmatrix}$ 通过链式法则与参考梯度 $\\nabla_{\\xi} u = \\begin{pmatrix} \\partial u / \\partial \\xi \\\\ \\partial u / \\partial \\eta \\end{pmatrix}$ 相关，这涉及到从参考坐标 $\\boldsymbol{\\xi} = (\\xi, \\eta)^T$ 到物理坐标 $\\boldsymbol{x} = (x, y)^T$ 的映射的雅可比矩阵 $J$。关系式为：\n$$\n\\nabla_{\\xi} u = J^T \\nabla_x u\n$$\n为了求得物理梯度，我们必须对该关系求逆：\n$$\n\\nabla_x u = (J^T)^{-1} \\nabla_{\\xi} u = (J^{-1})^T \\nabla_{\\xi} u\n$$\n首先，我们根据给定的解多项式 $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta$ 计算参考梯度。给定的系数为 $a_1=\\frac{4}{5}$ 和 $a_2=\\frac{3}{2}$。\n$$\n\\nabla_{\\xi} u = \\begin{pmatrix} \\frac{\\partial u}{\\partial \\xi} \\\\ \\frac{\\partial u}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{3}{2} \\end{pmatrix}\n$$\n接下来，我们使用提供的几何参数 $h_x=\\frac{3}{10}$，$h_y=3$ 和 $s=\\frac{3}{10}$ 来计算雅可比矩阵 $J$：\n$$\nJ = \\begin{pmatrix} \\frac{h_x}{2}  s \\\\ 0  \\frac{h_y}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}(\\frac{3}{10})  \\frac{3}{10} \\\\ 0  \\frac{1}{2}(3) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\n$$\n然后我们计算 $J$ 的逆矩阵。行列式为 $\\det(J) = (\\frac{3}{20})(\\frac{3}{2}) - (0)(\\frac{3}{10}) = \\frac{9}{40}$。\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{10} \\\\ 0  \\frac{3}{20} \\end{pmatrix} = \\frac{40}{9} \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{10} \\\\ 0  \\frac{3}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{40 \\cdot 3}{9 \\cdot 2}  -\\frac{40 \\cdot 3}{9 \\cdot 10} \\\\ 0  \\frac{40 \\cdot 3}{9 \\cdot 20} \\end{pmatrix} = \\begin{pmatrix} \\frac{20}{3}  -\\frac{4}{3} \\\\ 0  \\frac{2}{3} \\end{pmatrix}\n$$\n现在我们求物理梯度 $\\nabla_x u$：\n$$\n\\nabla_x u = (J^{-1})^T \\nabla_{\\xi} u = \\begin{pmatrix} \\frac{20}{3}  0 \\\\ -\\frac{4}{3}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} \\frac{4}{5} \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} (\\frac{20}{3})(\\frac{4}{5}) + (0)(\\frac{3}{2}) \\\\ (-\\frac{4}{3})(\\frac{4}{5}) + (\\frac{2}{3})(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{16}{15} + 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix}\n$$\n\n**2. 限制器参数 $\\theta$ 的推导与评估**\n\n单调性要求指出，在面中心处的预测解值 $u_{\\text{pred},f} = \\bar{u} + \\theta \\, \\delta u_f$（其中 $\\delta u_f = \\nabla_x u \\cdot \\boldsymbol{r}_f$）必须位于本单元平均值 $\\bar{u}$ 和其相邻单元平均值 $\\bar{u}_f$ 所定义的区间内。令 $\\Delta u_f = \\bar{u}_f - \\bar{u}$。条件是 $\\min(\\bar{u}, \\bar{u}_f) \\le \\bar{u} + \\theta \\, \\delta u_f \\le \\max(\\bar{u}, \\bar{u}_f)$。\n\n这为每个面导出一个限制器 $\\theta_f$，其可定义为：\n$$\n\\theta_f =\n\\begin{cases}\n    \\min\\left(1, \\frac{\\Delta u_f}{\\delta u_f}\\right)  \\text{若 } \\Delta u_f \\cdot \\delta u_f  0 \\\\\n    0  \\text{若 } \\Delta u_f \\cdot \\delta u_f \\le 0 \\text{ 且 } \\delta u_f \\ne 0 \\\\\n    1  \\text{若 } \\delta u_f = 0\n\\end{cases}\n$$\n条件 $\\Delta u_f \\cdot \\delta u_f  0$ 确保梯度指向相邻单元的平均值（即不产生新的极值）。那么，该单元的总限制器是 $\\theta = \\min(\\theta_L, \\theta_R, \\theta_B, \\theta_T)$。\n\n我们必须首先计算“考虑度量的”增量 $\\delta u_f$。这需要从单元中心到面中心的物理向量 $\\boldsymbol{r}_f$。这些向量可以通过使用 $J$ 映射参考面中心 $\\boldsymbol{\\xi}_f$ 来找到。参考面中心分别是 $\\boldsymbol{\\xi}_L=(-1,0)^T$、$\\boldsymbol{\\xi}_R=(1,0)^T$、$\\boldsymbol{\\xi}_B=(0,-1)^T$ 和 $\\boldsymbol{\\xi}_T=(0,1)^T$。\n物理向量为 $\\boldsymbol{r}_f = J \\boldsymbol{\\xi}_f$：\n- 左侧面 (L): $\\boldsymbol{r}_L = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{20} \\\\ 0 \\end{pmatrix}$\n- 右侧面 (R): $\\boldsymbol{r}_R = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{20} \\\\ 0 \\end{pmatrix}$\n- 底面 (B): $\\boldsymbol{r}_B = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{3}{2} \\end{pmatrix}$\n- 顶面 (T): $\\boldsymbol{r}_T = \\begin{pmatrix} \\frac{3}{20}  \\frac{3}{10} \\\\ 0  \\frac{3}{2} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{10} \\\\ \\frac{3}{2} \\end{pmatrix}$\n\n现在，我们计算增量 $\\delta u_f = \\nabla_x u \\cdot \\boldsymbol{r}_f$：\n- $\\delta u_L = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} -\\frac{3}{20} \\\\ 0 \\end{pmatrix} = (\\frac{16}{3})(-\\frac{3}{20}) = -\\frac{16}{20} = -\\frac{4}{5}$\n- $\\delta u_R = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{3}{20} \\\\ 0 \\end{pmatrix} = (\\frac{16}{3})(\\frac{3}{20}) = \\frac{16}{20} = \\frac{4}{5}$\n- $\\delta u_B = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} -\\frac{3}{10} \\\\ -\\frac{3}{2} \\end{pmatrix} = (\\frac{16}{3})(-\\frac{3}{10}) + (-\\frac{1}{15})(-\\frac{3}{2}) = -\\frac{16}{10} + \\frac{3}{30} = -\\frac{16}{10} + \\frac{1}{10} = -\\frac{15}{10} = -\\frac{3}{2}$\n- $\\delta u_T = \\begin{pmatrix} \\frac{16}{3} \\\\ -\\frac{1}{15} \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{3}{10} \\\\ \\frac{3}{2} \\end{pmatrix} = (\\frac{16}{3})(\\frac{3}{10}) + (-\\frac{1}{15})(\\frac{3}{2}) = \\frac{16}{10} - \\frac{3}{30} = \\frac{16}{10} - \\frac{1}{10} = \\frac{15}{10} = \\frac{3}{2}$\n\n接下来，我们计算与相邻单元平均值的差值 $\\Delta u_f = \\bar{u}_f - \\bar{u}$。给定 $\\bar{u} = \\frac{6}{5}$ 以及相邻单元平均值 $u_L=\\frac{9}{10}$、$u_R=\\frac{12}{5}$、$u_B=\\frac{3}{10}$、$u_T=\\frac{27}{10}$：\n- $\\Delta u_L = \\frac{9}{10} - \\frac{6}{5} = \\frac{9-12}{10} = -\\frac{3}{10}$\n- $\\Delta u_R = \\frac{12}{5} - \\frac{6}{5} = \\frac{6}{5}$\n- $\\Delta u_B = \\frac{3}{10} - \\frac{6}{5} = \\frac{3-12}{10} = -\\frac{9}{10}$\n- $\\Delta u_T = \\frac{27}{10} - \\frac{6}{5} = \\frac{27-12}{10} = \\frac{15}{10} = \\frac{3}{2}$\n\n最后，我们计算每个面的 $\\theta_f$：\n- L面：$\\delta u_L = -\\frac{4}{5}$，$\\Delta u_L = -\\frac{3}{10}$。由于 $\\Delta u_L \\cdot \\delta u_L  0$：\n  $\\theta_L = \\min\\left(1, \\frac{-3/10}{-4/5}\\right) = \\min\\left(1, \\frac{3}{10} \\cdot \\frac{5}{4}\\right) = \\min\\left(1, \\frac{15}{40}\\right) = \\min\\left(1, \\frac{3}{8}\\right) = \\frac{3}{8}$。\n- R面：$\\delta u_R = \\frac{4}{5}$，$\\Delta u_R = \\frac{6}{5}$。由于 $\\Delta u_R \\cdot \\delta u_R  0$：\n  $\\theta_R = \\min\\left(1, \\frac{6/5}{4/5}\\right) = \\min\\left(1, \\frac{6}{4}\\right) = \\min\\left(1, \\frac{3}{2}\\right) = 1$。\n- B面：$\\delta u_B = -\\frac{3}{2}$，$\\Delta u_B = -\\frac{9}{10}$。由于 $\\Delta u_B \\cdot \\delta u_B  0$：\n  $\\theta_B = \\min\\left(1, \\frac{-9/10}{-3/2}\\right) = \\min\\left(1, \\frac{9}{10} \\cdot \\frac{2}{3}\\right) = \\min\\left(1, \\frac{18}{30}\\right) = \\min\\left(1, \\frac{3}{5}\\right) = \\frac{3}{5}$。\n- T面：$\\delta u_T = \\frac{3}{2}$，$\\Delta u_T = \\frac{3}{2}$。由于 $\\Delta u_T \\cdot \\delta u_T  0$：\n  $\\theta_T = \\min\\left(1, \\frac{3/2}{3/2}\\right) = \\min(1, 1) = 1$。\n\n该单元的最终限制器参数 $\\theta$ 是基于面的各值的最小值：\n$$\n\\theta = \\min(\\theta_L, \\theta_R, \\theta_B, \\theta_T) = \\min\\left(\\frac{3}{8}, 1, \\frac{3}{5}, 1\\right)\n$$\n为了找到最小值，我们比较 $\\frac{3}{8}$ 和 $\\frac{3}{5}$。通分后分母为40，我们得到 $\\frac{3}{8} = \\frac{15}{40}$ 和 $\\frac{3}{5} = \\frac{24}{40}$。因此，$\\frac{3}{8}$ 是较小的值。\n$$\n\\theta = \\frac{3}{8}\n$$", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "3362937"}]}