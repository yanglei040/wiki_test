{"hands_on_practices": [{"introduction": "在计算流体力学中，我们常使用能量范数来量化解场的大小，这通常涉及在整个求解域上对场的平方进行积分。在离散的数值计算中，这个连续积分被数值求积所替代，即在特定节点上对函数值进行加权求和。本练习 [@problem_id:3300679] 深入探讨了从连续到离散的这一基本转换，通过计算单个切比雪夫多项式的能量，您将发现离散求积能精确等于连续积分的条件，这正是谱方法具有超高“谱精度”的核心原理。", "problem": "在有界域上的计算流体动力学 (CFD) 中，Chebyshev谱方法通常用Chebyshev多项式来表示场，并通过标准 $L^{2}$ 范数的平方来度量解的能量。考虑一维有界域 $[-1,1]$，并将标量场 $u$ 的连续能量定义为\n$$\nE \\equiv \\|u\\|^{2} = \\int_{-1}^{1} |u(x)|^{2} \\, dx.\n$$\n在实际的谱配置法中，使用基于求积的离散能量。设 Chebyshev-Gauss-Lobatto (CGL) 节点为 $x_{j} = \\cos\\!\\left(\\frac{j\\pi}{N}\\right)$ (对于 $j=0,1,\\dots,N$)，并设 $\\{w_{j}\\}_{j=0}^{N}$ 为 Clenshaw-Curtis (CC) 求积权重，用于通过以下方式近似无权积分 $\\int_{-1}^{1} f(x)\\,dx$：\n$$\nQ_{N}(f) \\equiv \\sum_{j=0}^{N} w_{j}\\, f(x_{j}).\n$$\n将基于求积的离散能量定义为\n$$\nE_{N} \\equiv \\sum_{j=0}^{N} w_{j}\\, |u(x_{j})|^{2}.\n$$\n\n从第一类Chebyshev多项式 $T_{m}(x) = \\cos\\!\\left(m\\arccos x\\right)$ 的定义、将 $[-1,1]$ 映射到 $[0,\\pi]$ 并满足 $dx=-\\sin\\theta\\, d\\theta$ 的变量替换 $x=\\cos\\theta$，以及三角函数在 $[0,\\pi]$ 上的基本正交性出发，完成以下任务：\n\n1. 对于 $u(x) = T_{m}(x)$ (其中 $m \\ge 1$ 为固定整数)，计算精确的连续能量 $E$。\n\n2. 仅利用Chebyshev展开的结构以及具有 $N+1$ 个CGL节点的Clenshaw-Curtis求积对次数至多为 $N$ 的任意代数多项式都精确这一事实，确定一个关于 $N$ 的条件（用 $m$ 表示），在此条件下，对于该 $u$ 有 $E_{N} = E$。\n\n3. 在第2部分中找到的条件下，以单个关于 $m$ 的闭式表达式给出 $E_{N}$ 和 $E$ 的共同值。\n\n你的最终答案必须是第3部分的闭式表达式。不需要单位。不要四舍五入；请提供精确表达式。", "solution": "该问题是有效的，因为它科学上基于谱方法和数值求积的成熟理论，是适定的（提供了所有必要信息），并且陈述客观。我们可以进行正式求解。\n\n该问题要求三个组成部分：特定场 $u(x)$ 的精确连续能量 $E$，使离散能量 $E_N$ 等于 $E$ 的求积点数 $N+1$ 的条件，以及得到的共同值。\n\n首先，我们计算标量场 $u(x) = T_{m}(x)$ 的精确连续能量 $E$，其中 $T_m(x)$ 是 $m$ 次的第一类切比雪夫多项式，且 $m$ 是一个满足 $m \\ge 1$ 的固定整数。连续能量定义为：\n$$\nE = \\int_{-1}^{1} |u(x)|^{2} \\, dx = \\int_{-1}^{1} (T_{m}(x))^{2} \\, dx\n$$\n由于 $x \\in [-1,1]$，$T_m(x)$ 是实值的，因此 $|T_m(x)|^2 = (T_m(x))^2$。\n\n为计算该积分，我们可以将被积函数 $(T_m(x))^2$ 表示为切比雪夫多项式的线性组合。使用定义 $T_m(x) = \\cos(m\\arccos x)$，我们可以进行换元 $x = \\cos\\theta$。这得到 $T_m(\\cos\\theta) = \\cos(m\\theta)$。被积函数变为：\n$$\n(T_m(x))^2 \\to (\\cos(m\\theta))^2\n$$\n使用三角恒等式 $\\cos^2\\alpha = \\frac{1}{2}(1 + \\cos(2\\alpha))$，我们有：\n$$\n(\\cos(m\\theta))^2 = \\frac{1}{2} (1 + \\cos(2m\\theta))\n$$\n注意到 $1 = T_0(x)$ 且 $\\cos(2m\\theta) = T_{2m}(\\cos\\theta) = T_{2m}(x)$，我们可以在切比雪夫基中写出 $(T_m(x))^2$ 的展开式：\n$$\n(T_m(x))^2 = \\frac{1}{2} T_0(x) + \\frac{1}{2} T_{2m}(x)\n$$\n现在我们可以将其代回到 $E$ 的积分中：\n$$\nE = \\int_{-1}^{1} \\left( \\frac{1}{2} T_0(x) + \\frac{1}{2} T_{2m}(x) \\right) dx = \\frac{1}{2} \\int_{-1}^{1} T_0(x) \\, dx + \\frac{1}{2} \\int_{-1}^{1} T_{2m}(x) \\, dx\n$$\n我们分别计算每个积分。对于第一个积分：\n$$\n\\int_{-1}^{1} T_0(x) \\, dx = \\int_{-1}^{1} 1 \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2\n$$\n对于第二个积分，我们计算一般情况 $\\int_{-1}^{1} T_k(x) \\, dx$ (对于整数 $k > 0$) 。使用换元 $x = \\cos\\theta$，其中 $dx = -\\sin\\theta \\, d\\theta$：\n$$\n\\int_{-1}^{1} T_k(x) \\, dx = \\int_{\\pi}^{0} T_k(\\cos\\theta) (-\\sin\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\cos(k\\theta) \\sin\\theta \\, d\\theta\n$$\n使用积化和差恒等式 $\\cos A \\sin B = \\frac{1}{2}(\\sin(A+B) - \\sin(A-B))$：\n$$\n\\int_{0}^{\\pi} \\cos(k\\theta) \\sin\\theta \\, d\\theta = \\frac{1}{2} \\int_{0}^{\\pi} \\left( \\sin((k+1)\\theta) - \\sin((k-1)\\theta) \\right) d\\theta\n$$\n对于整数 $n \\neq 0$，$\\int_0^\\pi \\sin(n\\theta) d\\theta = \\left[-\\frac{\\cos(n\\theta)}{n}\\right]_0^\\pi = \\frac{1 - \\cos(n\\pi)}{n} = \\frac{1 - (-1)^n}{n}$。\n如果 $k$ 是大于1的奇数，则 $k+1$ 和 $k-1$ 都是非零偶数。在这种情况下，$1 - (-1)^{k+1} = 0$ 且 $1 - (-1)^{k-1} = 0$，所以积分为0。如果 $k=1$，积分为 $\\frac{1}{2}\\int_0^\\pi \\sin(2\\theta) d\\theta = 0$。因此对于任何奇数 $k \\ge 1$，积分为0。\n如果 $k$ 是一个偶数 ($k \\ge 2$)，则 $k+1$ 和 $k-1$ 都是奇数。因此 $1 - (-1)^{k+1} = 2$ 且 $1 - (-1)^{k-1} = 2$。积分变为：\n$$\n\\frac{1}{2} \\left( \\frac{2}{k+1} - \\frac{2}{k-1} \\right) = \\frac{1}{k+1} - \\frac{1}{k-1} = \\frac{(k-1) - (k+1)}{(k+1)(k-1)} = \\frac{-2}{k^2-1}\n$$\n在我们的例子中，我们需要计算 $k = 2m$ 时的积分。由于 $m \\ge 1$，$k=2m$ 是一个大于或等于2的偶数。因此：\n$$\n\\int_{-1}^{1} T_{2m}(x) \\, dx = \\frac{-2}{(2m)^2 - 1} = \\frac{-2}{4m^2 - 1}\n$$\n将积分的值代回到 $E$ 的表达式中：\n$$\nE = \\frac{1}{2}(2) + \\frac{1}{2} \\left( \\frac{-2}{4m^2 - 1} \\right) = 1 - \\frac{1}{4m^2 - 1} = \\frac{(4m^2 - 1) - 1}{4m^2 - 1} = \\frac{4m^2 - 2}{4m^2 - 1}\n$$\n这就完成了问题的第一部分。\n\n第二，我们确定离散能量 $E_N$ 等于连续能量 $E$ 时 $N$ 需要满足的条件。离散能量 $E_N$ 是通过将Clenshaw-Curtis求积法则应用于函数 $|u(x)|^2$ 来定义的：\n$$\nE_{N} \\equiv \\sum_{j=0}^{N} w_{j}\\, |u(x_{j})|^{2} = Q_N(|u|^2)\n$$\n等式 $E_N = E$ 等价于求积法则对被积函数是精确的这一陈述，即：\n$$\nQ_N(|u|^2) = \\int_{-1}^{1} |u(x)|^{2} \\, dx\n$$\n被积函数为 $f(x) = |u(x)|^2 = (T_m(x))^2$。如前所示，$(T_m(x))^2 = \\frac{1}{2}T_0(x) + \\frac{1}{2}T_{2m}(x)$。由于 $T_k(x)$ 是一个 $k$ 次代数多项式，被积函数是一个 $2m$ 次的代数多项式。问题陈述，具有 $N+1$ 个节点的Clenshaw-Curtis求积对于次数至多为 $N$ 的任意代数多项式都是精确的。要使该求积对我们的被积函数精确，被积函数的次数必须小于或等于该法则能精确处理的最大次数。这给出了条件：\n$$\n\\text{degree}((T_m(x))^2) \\le N\n$$\n由于 $\\text{degree}((T_m(x))^2) = 2m$，所以对 $N$ 的条件是：\n$$\n2m \\le N\n$$\n\n第三，在条件 $N \\ge 2m$ 下，我们有 $E_N = E$。问题要求的就是这个共同的值。这正是我们在第一部分计算出的 $E$ 的值。对于任何整数 $m \\ge 1$，这个能量的闭式表达式是：\n$$\nE = E_N = \\frac{4m^2 - 2}{4m^2 - 1}\n$$\n这就是最终要求的表达式。", "answer": "$$\\boxed{\\frac{4m^{2}-2}{4m^{2}-1}}$$", "id": "3300679"}, {"introduction": "谱方法使用光滑的全局多项式，因此在处理非光滑函数（如局部力或激波）时会遇到巨大挑战。直接应用往往会导致一种被称为吉布斯现象的伪振荡，这种振荡会污染整个解。本实践练习 [@problem_id:3300734] 将让您掌握两种抑制这些振荡的强大技术。您将亲手实现并比较一种预处理方法（对源项进行磨光）和一种后处理方法（对解应用谱粘性），从而获得在求解高精度问题时处理不连续性的宝贵经验。", "problem": "考虑在有界区间 $[-1,1]$ 上的一维稳态泊松模型，该模型代表了由体积力驱动的壁面有界斯托克斯流，\n$$ u''(x) = f(x), \\quad x \\in (-1,1), \\qquad u(-1)=0,\\quad u(1)=0. $$\n体积力局部作用于右侧壁面附近，并取为近壁区间的指示函数，\n$$ f(x) = \\begin{cases} 1,  x \\in [1-w,\\,1], \\\\ 0,  x \\in [-1,\\,1-w), \\end{cases} $$\n其中 $w \\in (0,2]$。精确解是分段二次的，可以通过直接对模型进行积分以及在界面 $x=1-w$ 处施加 $u(x)$ 和 $u'(x)$ 的连续性条件来获得。您必须使用切比雪夫谱配置法在切比雪夫-高斯-洛巴托点上近似 $u(x)$，并比较处理局部近壁强迫项的三种策略：\n- 使用 $f(x)$ 的原始节点采样的基准配置求解，\n- 一种平滑化强迫项求解，在求解前通过在由 $x=\\cos(\\theta)$ 定义的极角变量 $\\theta \\in [0,\\pi]$（角度必须为弧度）中进行环形高斯卷积来平滑 $f(x)$，以及\n- 一种谱粘性后处理，其中基准数值解 $u(x)$ 通过指数型高波数阻尼器在切比雪夫系数空间中进行滤波。\n\n您必须从以下基本定义开始：\n- 切比雪夫-高斯-洛巴托节点 $x_j = \\cos\\!\\left(\\frac{\\pi j}{N}\\right)$，其中 $j=0,1,\\dots,N$，以及相关的对这些点上的节点值进行微分的一阶导数矩阵 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，二阶导数矩阵为 $D^{(2)} = D^2$。\n- 在配置法中，通过将第一个和最后一个方程替换为 $u(x_0)=0$ 和 $u(x_N)=0$ 来施加齐次 Dirichlet 边界条件。\n- 极角参数化 $x=\\cos(\\theta)$，其中 $\\theta_j = \\frac{\\pi j}{N}$（$j=0,1,\\dots,N$）是均匀分布的。\n- I 型离散余弦变换将切比雪夫-高斯-洛巴托节点上的节点值与切比雪夫系数联系起来，而在 $\\theta$ 的 $2\\pi$ 周期均匀网格上的快速傅里叶变换 (FFT) 可对角化环形卷积。\n\n实现要求：\n1. 基准求解器。构建 $D$ 和 $D^{(2)}$，构造线性系统，该系统对内部节点 $j=1,\\dots,N-1$ 配置 $u''(x_j)=f(x_j)$，施加 $u(x_0)=0$ 和 $u(x_N)=0$，并求解节点向量 $u \\in \\mathbb{R}^{N+1}$。\n2. 平滑化。在均匀的 $2\\pi$ 周期网格 $\\Theta_m = \\frac{\\pi m}{N}$（$m=0,1,\\dots,2N-1$）上定义 $F(\\Theta)=f(\\cos\\Theta)$。通过将波数 $k\\ge 0$ 的实傅里叶系数乘以 $\\exp\\!\\left(-\\tfrac{1}{2}\\sigma_\\theta^2 k^2\\right)$ 来应用环形高斯卷积，其中核函数的标准差为 $\\sigma_\\theta$（以弧度为单位）。将平滑后的值限制在 Chebyshev 角 $\\theta_j = \\frac{\\pi j}{N}$ 上，并使用这个平滑化后的 $f$ 重复基准求解过程。\n3. 谱粘性。计算基准数值解的 I 型离散余弦变换以获得切比雪夫系数 $\\{\\hat{u}_k\\}_{k=0}^N$，并应用一个指数滤波器，\n$$ \\phi_k = \\begin{cases}\n1,  0 \\le k \\le k_c, \\\\\n\\exp\\!\\left(-\\alpha \\left(\\frac{k-k_c}{N-k_c}\\right)^p\\right),  k_c  k \\le N,\n\\end{cases} $$\n其中截止索引为 $k_c = \\lfloor \\rho N \\rfloor$，指数为 $p0$，振幅为 $\\alpha0$。进行逆变换以获得谱粘性解 $u$。\n4. 误差度量。对于任何数值节点向量 $u^{\\text{num}} \\in \\mathbb{R}^{N+1}$，计算其与在相同节点上的精确解 $u^{\\text{exact}}$ 之间的节点均方根误差，\n$$ \\varepsilon_{\\mathrm{RMS}} = \\left( \\frac{1}{N+1}\\sum_{j=0}^N \\bigl(u^{\\text{num}}(x_j) - u^{\\text{exact}}(x_j)\\bigr)^2 \\right)^{1/2}. $$\n\n在所有测试用例中，为平滑和谱粘性使用以下固定参数：\n- 高斯平滑核宽度 $\\sigma_\\theta = \\frac{3}{N}$（弧度），\n- 谱粘性滤波器参数 $\\rho = 0.65$，$p=8$，$\\alpha=36$。\n\n测试组。评估三个测试用例，分别探究理想路径、更尖锐的近壁体积力以及解析度更高的场景：\n- 用例 1：$N=64$，$w=0.3$。\n- 用例 2：$N=64$，$w=0.05$。\n- 用例 3：$N=128$，$w=0.02$。\n\n对于每个用例，计算以下比率：\n$$ r_{\\mathrm{moll}} = \\frac{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{mollified}}}{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}}, \\qquad r_{\\mathrm{visc}} = \\frac{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{viscosity}}}{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}}. $$\n您的程序必须输出单行，该行为一个用方括号括起来的逗号分隔列表，其中包含按以下顺序排列的六个浮点数结果：\n$$ [\\, r_{\\mathrm{moll}}^{(1)},\\; r_{\\mathrm{visc}}^{(1)},\\; r_{\\mathrm{moll}}^{(2)},\\; r_{\\mathrm{visc}}^{(2)},\\; r_{\\mathrm{moll}}^{(3)},\\; r_{\\mathrm{visc}}^{(3)} \\,]. $$\n\n注释：\n- 所有角度必须以弧度为单位。\n- 不需要物理单位。\n- 该公式的实现必须从数学和算法的角度具有普适的理解性，并且仅依赖于所述的基本定义。", "solution": "用户的要求是使用切比雪夫谱配置法求解有界区间上的一维稳态泊松方程，并比较三种处理不连续强迫项的不同策略。该问题是适定的，在偏微分方程数值分析领域有其科学依据，并为完整求解提供了所有必要信息。\n\n以下是求解方法的逐步推导和解释。\n\n### 1. 问题说明\n控制方程为在定义域 $x \\in [-1, 1]$ 上的泊松方程：\n$$ u''(x) = f(x), \\quad x \\in (-1,1) $$\n带有齐次 Dirichlet 边界条件：\n$$ u(-1) = 0, \\quad u(1) = 0 $$\n强迫函数 $f(x)$ 是一个阶跃函数，代表靠近右壁的局部体积力：\n$$ f(x) = \\begin{cases} 1,  x \\in [1-w,\\,1] \\\\ 0,  x \\in [-1,\\,1-w) \\end{cases} $$\n其中 $w \\in (0, 2]$ 是强迫区域的宽度。\n\n### 2. 精确解\n精确解是分段二次的，可以通过对 $u''(x) = f(x)$ 积分两次并施加边界条件，以及在界面 $x = 1-w$ 处解 $u(x)$ 及其一阶导数 $u'(x)$ 的连续性来求得。\n\n对于 $x \\in [-1, 1-w)$，方程为 $u''(x) = 0$。积分两次得到 $u(x) = A x + B$。边界条件 $u(-1)=0$ 意味着 $-A+B=0$，所以 $B=A$。因此，$u(x) = A(x+1)$。\n\n对于 $x \\in [1-w, 1]$，方程为 $u''(x) = 1$。积分两次得到 $u(x) = \\frac{1}{2}x^2 + C x + D$。边界条件 $u(1)=0$ 意味着 $\\frac{1}{2} + C + D = 0$，所以 $D = -C - \\frac{1}{2}$。因此，$u(x) = \\frac{1}{2}x^2 + C(x-1) - \\frac{1}{2} = \\frac{1}{2}(x^2-1) + C(x-1)$。\n\n在 $x=1-w$ 处的连续性：\n1.  $u(x)$ 的连续性：$A((1-w)+1) = \\frac{1}{2}((1-w)^2-1) + C((1-w)-1)$\n2.  $u'(x)$ 的连续性：$A = (1-w) + C$\n\n解这个关于常数 $A$ 和 $C$ 的二元线性方程组，得到：\n$$ A = -\\frac{1}{4}w^2 $$\n$$ C = -\\frac{1}{4}w^2 - 1 + w $$\n\n因此，精确解为：\n$$\nu_{\\text{exact}}(x) = \\begin{cases}\n-\\frac{1}{4}w^2(x+1),  x \\in [-1, 1-w] \\\\\n\\frac{1}{2}(x^2-1) + \\left(-\\frac{1}{4}w^2 - 1 + w\\right)(x-1),  x \\in (1-w, 1]\n\\end{cases}\n$$\n\n### 3. 数值方法：切比雪夫谱配置法\n我们使用 $N+1$ 个切比雪夫-高斯-洛巴托 (CGL) 节点 $x_j = \\cos(\\frac{\\pi j}{N})$（其中 $j=0, 1, \\dots, N$）对定义域进行离散化。注意 $x_0=1$ 且 $x_N=-1$。我们寻求一个近似解向量 $u \\in \\mathbb{R}^{N+1}$，其中 $u_j \\approx u(x_j)$。\n\n解向量的二阶导数通过 $u'' \\approx D^{(2)} u$ 来近似，其中 $D^{(2)} = D^2$ 是切比雪夫一阶导数矩阵 $D$ 的平方。$D$ 的元素由以下公式给出：\n$$\nD_{jk} = \\begin{cases}\n\\frac{c_j}{c_k} \\frac{(-1)^{j+k}}{x_j - x_k},  j \\ne k \\\\\n-\\frac{x_j}{2(1-x_j^2)},  j=1,\\dots,N-1 \\\\\n\\frac{2N^2+1}{6},  j=0 \\\\\n-\\frac{2N^2+1}{6},  j=N\n\\end{cases}\n$$\n其中，当 $j=0, N$ 时 $c_j=2$，否则 $c_j=1$。一个稳健的数值实现通过求和法则 $D_{jj} = -\\sum_{k \\ne j} D_{jk}$ 来计算对角线元素。\n\n离散化的泊松方程是 $ D^{(2)} u = f $，其中 $f_j = f(x_j)$。通过修改该系统来施加边界条件。第一行（对应于 $x_0=1$）被替换为方程 $u_0 = 0$，最后一行（对应于 $x_N=-1$）被替换为 $u_N=0$。这样就得到了一个关于 $u$ 的良态线性系统。\n\n### 4. 处理不连续性的策略\n\n#### 策略 A：基准配置法\n这是上文描述的直接方法。我们在内部节点 $j=1, \\dots, N-1$ 处配置方程 $u''(x_j) = f(x_j)$。右端向量 $b$ 是通过在 CGL 节点上对不连续函数 $f(x)$ 进行采样形成的，即 $b_j = f(x_j)$，并为边界条件设置 $b_0=0, b_N=0$。$f(x)$ 中的不连续性引入了大量高波数分量，导致 Gibbs 现象并降低解的谱精度。\n\n#### 策略 B：强迫项平滑化\n为了减轻 Gibbs 现象，在求解系统之前对不连续的强迫函数 $f(x)$ 进行平滑处理。这是通过在角度变量 $\\theta$（其中 $x=\\cos(\\theta)$）中与高斯核进行卷积来实现的。\n1.  在角坐标中定义一个扩展的 $2\\pi$ 周期网格，$\\Theta_m = \\frac{\\pi m}{N}$，其中 $m=0, 1, \\dots, 2N-1$。\n2.  在此网格上定义强迫函数：$F_m = f(\\cos(\\Theta_m))$。\n3.  使用快速傅里叶变换 (FFT) 计算 $F$ 的离散傅里叶变换。\n4.  在傅里叶空间中，将系数乘以一个高斯滤波器 $\\exp(-\\frac{1}{2}\\sigma_\\theta^2 k^2)$，其中 $k$ 是波数，$\\sigma_\\theta = \\frac{3}{N}$ 是高斯核在弧度单位下的标准差。\n5.  执行逆 FFT 以获得扩展网格上的平滑化强迫函数 $F^{\\text{moll}}$。\n6.  用于求解器的新的平滑强迫向量 $f^{\\text{moll}}$ 是通过将 $F^{\\text{moll}}$ 限制在原始 CGL 节点上得到的，这些节点对应于扩展网格的前 $N+1$ 个点。\n7.  使用这个平滑的 $f^{\\text{moll}}$作为右端项来求解泊松方程。\n\n#### 策略 C：谱粘性后处理\n该策略对从基准方法获得的振荡数值解进行滤波。\n1.  如策略 A 中所述，计算基准解 $u^{\\text{baseline}}$。\n2.  使用 I 型离散余弦变换 (DCT-I) 将 $u^{\\text{baseline}}$ 的节点值转换为切比雪夫谱系数 $\\{\\hat{u}_k\\}$。\n3.  对系数应用指数滤波器：$\\hat{u}^{\\text{visc}}_k = \\phi_k \\hat{u}_k$。滤波器 $\\phi_k$ 旨在阻尼导致 Gibbs 振荡的高波数模式 ($k  k_c$)。其定义如下：\n    $$ \\phi_k = \\begin{cases}\n    1,  0 \\le k \\le k_c \\\\\n    \\exp\\!\\left(-\\alpha \\left(\\frac{k-k_c}{N-k_c}\\right)^p\\right),  k_c  k \\le N\n    \\end{cases} $$\n    其中 $k_c = \\lfloor \\rho N \\rfloor$ 且给定参数为 $\\rho = 0.65$，$p=8$，$\\alpha=36$。\n4.  使用逆 DCT-I 将滤波后的系数 $\\hat{u}^{\\text{visc}}$ 变换回节点空间，以获得平滑解 $u^{\\text{visc}}$。\n\n### 5. 误差评估\n对于三种数值解（$u^{\\text{baseline}}$、$u^{\\text{mollified}}$、$u^{\\text{visc}}$）中的每一种，都在 CGL 节点上计算其与精确解的均方根 (RMS) 误差：\n$$ \\varepsilon_{\\mathrm{RMS}} = \\left( \\frac{1}{N+1}\\sum_{j=0}^N \\bigl(u^{\\text{num}}_j - u^{\\text{exact}}_j\\bigr)^2 \\right)^{1/2} $$\n最后，计算比率 $r_{\\mathrm{moll}} = \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{mollified}} / \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}$ 和 $r_{\\mathrm{visc}} = \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{viscosity}} / \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}$，以量化相对于基准方法的改进程度。小于 1 的比率表示精度有所提高。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import dct, idct, rfft, irfft\n\ndef get_chebyshev_diff_matrix(N: int) - np.ndarray:\n    \"\"\"\n    Constructs the Chebyshev first-derivative matrix on N+1 Chebyshev-Gauss-Lobatto nodes.\n    The diagonal is computed using the sum-to-zero property for stability.\n    \"\"\"\n    if N == 0:\n        return np.zeros((1, 1))\n    \n    j = np.arange(N + 1)\n    x = np.cos(np.pi * j / N)\n\n    c = np.ones(N + 1)\n    c[0] = 2.0\n    c[N] = 2.0\n\n    # Off-diagonal elements\n    C = np.outer(c, 1.0 / c)\n    J_plus_K = np.add.outer(j, j)\n    s = (-1.0)**J_plus_K\n    dX = np.subtract.outer(x, x)\n    # Add identity to avoid division by zero on the diagonal (which is handled next)\n    dX += np.eye(N + 1)\n\n    D = C * s / dX\n\n    # Diagonal elements from sum-to-zero property: D * 1 = 0\n    np.fill_diagonal(D, 0.0)\n    D -= np.diag(np.sum(D, axis=1))\n    \n    return D\n\ndef get_exact_solution(x: np.ndarray, w: float) - np.ndarray:\n    \"\"\"Computes the exact piecewise quadratic solution.\"\"\"\n    u = np.zeros_like(x)\n    x_interface = 1.0 - w\n\n    A = -0.25 * w**2\n    C = A - (1.0 - w)\n\n    # Mask for the two pieces of the solution\n    mask_left = x  x_interface\n    mask_right = ~mask_left\n\n    # u(x) = A(x+1) for x  1-w\n    u[mask_left] = A * (x[mask_left] + 1.0)\n    # u(x) = (x-1)(0.5(x+1) + C) for x = 1-w\n    u[mask_right] = (x[mask_right] - 1.0) * (0.5 * (x[mask_right] + 1.0) + C)\n    \n    return u\n\ndef solve_poisson(N: int, D2: np.ndarray, f_vec: np.ndarray) - np.ndarray:\n    \"\"\"Solves the Poisson system with homogeneous Dirichlet BCs.\"\"\"\n    L = D2.copy()\n    b = f_vec.copy()\n\n    # Impose Dirichlet boundary conditions u(1)=0 and u(-1)=0\n    # Node x_0 = 1, Node x_N = -1\n    L[0, :] = 0.0\n    L[0, 0] = 1.0\n    b[0] = 0.0\n    \n    L[N, :] = 0.0\n    L[N, N] = 1.0\n    b[N] = 0.0\n    \n    # Solve the linear system\n    u = np.linalg.solve(L, b)\n    return u\n\ndef rms_error(u_num: np.ndarray, u_exact: np.ndarray) - float:\n    \"\"\"Computes the root-mean-square nodal error.\"\"\"\n    return np.sqrt(np.mean((u_num - u_exact)**2))\n\ndef run_case_analysis(N: int, w: float, filter_params: tuple):\n    \"\"\"\n    Performs the full analysis for a given (N, w) case, comparing the three methods.\n    \"\"\"\n    rho, p, alpha = filter_params\n    sigma_theta = 3.0 / N\n\n    # Setup grid, exact solution, and differentiation matrix\n    j = np.arange(N + 1)\n    x = np.cos(np.pi * j / N)\n    u_exact = get_exact_solution(x, w)\n    D = get_chebyshev_diff_matrix(N)\n    D2 = D @ D\n\n    # Define forcing vector from raw nodal sampling\n    f_vec_base = (x = 1.0 - w).astype(float)\n\n    # --- 1. Baseline Solve ---\n    u_base = solve_poisson(N, D2, f_vec_base)\n    err_base = rms_error(u_base, u_exact)\n\n    # --- 2. Mollified-Forcing Solve ---\n    # Extend to 2pi-periodic grid for circular convolution\n    M = 2 * N\n    m = np.arange(M)\n    theta_ext = np.pi * m / N\n    x_ext = np.cos(theta_ext)\n    F_ext = (x_ext = 1.0 - w).astype(float)\n    \n    # Apply Gaussian filter in Fourier space\n    F_hat = rfft(F_ext)\n    k_freq = np.arange(len(F_hat)) # Wavenumbers k = 0, 1, ..., N\n    gauss_filter = np.exp(-0.5 * sigma_theta**2 * k_freq**2)\n    F_hat_moll = F_hat * gauss_filter\n    \n    # Transform back and restrict to Chebyshev grid\n    F_moll = irfft(F_hat_moll, n=M)\n    f_vec_moll = F_moll[:N+1]\n    \n    u_moll = solve_poisson(N, D2, f_vec_moll)\n    err_moll = rms_error(u_moll, u_exact)\n\n    # --- 3. Spectral-Viscosity Post-processing ---\n    # Transform baseline solution to Chebyshev coefficient space\n    u_hat_base = dct(u_base, type=1, norm='ortho')\n    \n    # Define exponential filter\n    kc = int(rho * N)\n    k = np.arange(N + 1)\n    sv_filter = np.ones(N + 1)\n    k_tail_indices = k  kc\n    k_tail = k[k_tail_indices]\n    \n    if N  kc: # Avoid division by zero if kc=N\n        sv_filter[k_tail_indices] = np.exp(-alpha * ((k_tail - kc) / (N - kc))**p)\n\n    # Apply filter and transform back to nodal space\n    u_hat_visc = u_hat_base * sv_filter\n    u_visc = idct(u_hat_visc, type=1, norm='ortho')\n    \n    err_visc = rms_error(u_visc, u_exact)\n\n    # --- Calculate and return error ratios ---\n    r_moll = err_moll / err_base\n    r_visc = err_visc / err_base\n    \n    return r_moll, r_visc\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (64, 0.3),   # Case 1\n        (64, 0.05),  # Case 2\n        (128, 0.02), # Case 3\n    ]\n    \n    # Fixed parameters for filter and mollifier\n    filter_params = (0.65, 8, 36) # rho, p, alpha\n    \n    results = []\n    for N, w in test_cases:\n        r_moll, r_visc = run_case_analysis(N, w, filter_params)\n        results.extend([r_moll, r_visc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.16f}' for r in results)}]\")\n\nsolve()\n```", "id": "3300734"}, {"introduction": "对于高阶微分方程，例如在流体力学和固体力学中常见的双调和方程，施加多个边界条件是一项精细的工作。在标准多项式基上简单地代数施加边界条件可能引入数值伪影并导致系统病态。一种更稳健、更优雅的策略是构造一组特殊的基函数，其中每个函数都先天地满足边界条件。这项高等实践 [@problem_id:3300741] 将引导您完成这样一个基函数的解析构造过程，展示如何将物理约束直接构建到数值框架中，以从根本上确保方法的稳定性和准确性。", "problem": "考虑在一维有界域 $[-1,1]$ 上的双谐波算子 $\\frac{d^{4}}{dx^{4}}$，其具有夹持边界条件 $u(-1)=u(1)=u'(-1)=u'(1)=0$。在有界域上计算流体力学 (CFD) 谱离散化的背景下，当边界条件代数地施加于全局多项式基上时，伪模式的一个常见来源便会出现。为消除此类伪模式，请构造一个能恒等满足夹持边界条件的约束切比雪夫基。\n\n从第一类切比雪夫多项式 $T_{n}(x) = \\cos(n \\arccos x)$ 的定义、经过检验的端点恒等式 $T_{n}(1)=1$ 和 $T_{n}(-1)=(-1)^{n}$，以及导数关系 $T_{n}'(x)=n\\,U_{n-1}(x)$ 出发（其中 $U_{n}(x)$ 是第二类切比雪夫多项式，满足 $U_{n}(1)=n+1$ 和 $U_{n}(-1)=(-1)^{n}(n+1)$），对于每个整数 $k \\geq 0$，寻求一个具有以下形式的最小带宽约束基函数\n$$\n\\psi_{k}(x) = T_{k+4}(x) + \\alpha_{k}\\,T_{k+2}(x) + \\beta_{k}\\,T_{k}(x),\n$$\n其系数 $\\alpha_{k}$ 和 $\\beta_{k}$ 的选择应使得 $\\psi_{k}(\\pm 1)=0$ 和 $\\psi_{k}'(\\pm 1)=0$ 恒成立。\n\n(a) 确定 $\\alpha_{k}$ 和 $\\beta_{k}$ 关于 $k$ 的闭式表达式。\n\n(b) 仅通过引用切比雪夫多项式的基本性质、多项式在有界区间上的 Sobolev 空间中的稠密性，以及关于张成和三角变换的线性代数论证，来证明集合 $\\{\\psi_{k}\\}_{k=0}^{\\infty}$ 在 Sobolev 空间 $H^{2}_{0}(-1,1)$（即 $H^{2}(-1,1)$ 中在端点处迹和一阶导数迹均为零的子空间）中是完备的。\n\n简要解释为什么这样的基在双谐波算子的谱离散化中能够消除伪边界模式。\n\n请将 (a) 部分的最终结果表示为 $\\psi_{k}(x)$ 关于 $k$ 和 $T_{n}(x)$ 的单一闭式解析表达式。无需进行数值舍入。", "solution": "我们从第一类切比雪夫多项式的定义 $T_{n}(x) = \\cos(n\\arccos x)$ 开始，这导出了端点恒等式 $T_{n}(1)=1$ 和 $T_{n}(-1)=(-1)^{n}$。导数关系 $T_{n}'(x) = n\\,U_{n-1}(x)$，其中 $U_{n}(x)$ 是第二类切比雪夫多项式，由此可得端点导数值 $T_{n}'(1) = n\\,U_{n-1}(1) = n \\cdot n = n^{2}$ 和 $T_{n}'(-1) = n\\,U_{n-1}(-1) = n \\cdot (-1)^{n-1} n = (-1)^{n-1} n^{2}$。\n\n我们寻求对于每个整数 $k \\geq 0$，一个具有以下形式的约束基函数\n$$\n\\psi_{k}(x) = T_{k+4}(x) + \\alpha_{k}\\,T_{k+2}(x) + \\beta_{k}\\,T_{k}(x),\n$$\n并满足夹持边界条件\n$$\n\\psi_{k}(1)=0,\\quad \\psi_{k}(-1)=0,\\quad \\psi_{k}'(1)=0,\\quad \\psi_{k}'(-1)=0.\n$$\n\n首先，我们施加函数值条件。使用 $T_{n}(1)=1$，我们有\n$$\n\\psi_{k}(1) = 1 + \\alpha_{k} + \\beta_{k} = 0.\n$$\n使用 $T_{n}(-1)=(-1)^{n}$ 并注意到 $k$、$k+2$ 和 $k+4$ 具有相同的奇偶性，我们得到\n$$\n\\psi_{k}(-1) = (-1)^{k+4} + \\alpha_{k}(-1)^{k+2} + \\beta_{k}(-1)^{k} \n= (-1)^{k}\\big(1 + \\alpha_{k} + \\beta_{k}\\big) = 0,\n$$\n因此，一旦 $1+\\alpha_{k}+\\beta_{k}=0$ 成立，$x=-1$ 处的条件就自动满足。于是函数值条件化简为单个线性约束\n$$\n1 + \\alpha_{k} + \\beta_{k} = 0.\n$$\n\n接下来，我们施加导数值条件。根据 $T_{n}'(1) = n^{2}$ 和 $T_{n}'(-1) = (-1)^{n-1} n^{2}$，我们计算\n$$\n\\psi_{k}'(1) = (k+4)^{2} + \\alpha_{k} (k+2)^{2} + \\beta_{k} k^{2} = 0,\n$$\n和\n$$\n\\psi_{k}'(-1) = (-1)^{k+3} (k+4)^{2} + \\alpha_{k} (-1)^{k+1} (k+2)^{2} + \\beta_{k} (-1)^{k-1} k^{2}.\n$$\n因为 $(-1)^{k+3} = (-1)^{k+1} = (-1)^{k-1}$，因子 $(-1)^{k-1}$ 可以被提取出来，得到\n$$\n\\psi_{k}'(-1) = (-1)^{k-1}\\left[ (k+4)^{2} + \\alpha_{k} (k+2)^{2} + \\beta_{k} k^{2} \\right] = 0,\n$$\n所以条件 $\\psi_{k}'(-1)=0$ 等价于 $\\psi_{k}'(1)=0$。因此，导数值条件化简为单个线性约束\n$$\n(k+4)^{2} + \\alpha_{k} (k+2)^{2} + \\beta_{k} k^{2} = 0.\n$$\n\n因此，我们得到一个关于 $\\alpha_{k}$ 和 $\\beta_{k}$ 的 $2 \\times 2$ 线性方程组：\n$$\n\\begin{cases}\n1 + \\alpha_{k} + \\beta_{k} = 0,\\\\\n(k+4)^{2} + \\alpha_{k} (k+2)^{2} + \\beta_{k} k^{2} = 0.\n\\end{cases}\n$$\n我们通过使用 $\\beta_{k} = -1 - \\alpha_{k}$ 从第二个方程中消去 $\\beta_{k}$ 来求解：\n\n$$\n(k+4)^{2} + \\alpha_{k} (k+2)^{2} + (-1 - \\alpha_{k}) k^{2} = 0,\n$$\n\n化简为\n\n$$\n\\big((k+4)^{2} - k^{2}\\big) + \\alpha_{k} \\big((k+2)^{2} - k^{2}\\big) = 0.\n$$\n\n计算差值：\n\n$$\n(k+4)^{2} - k^{2} = 8k + 16,\\qquad (k+2)^{2} - k^{2} = 4k + 4.\n$$\n\n因此\n\n$$\n(8k + 16) + \\alpha_{k} (4k + 4) = 0 \\quad \\Longrightarrow \\quad \\alpha_{k} = -\\frac{8k+16}{4k+4} = -2\\,\\frac{k+2}{k+1}.\n$$\n\n然后\n\n$$\n\\beta_{k} = -1 - \\alpha_{k} = -1 + 2\\,\\frac{k+2}{k+1} = \\frac{k+3}{k+1}.\n$$\n\n因此，约束基函数为\n\n$$\n\\psi_{k}(x) = T_{k+4}(x) - 2\\,\\frac{k+2}{k+1}\\,T_{k+2}(x) + \\frac{k+3}{k+1}\\,T_{k}(x), \\qquad k \\geq 0.\n$$\n\n根据构造，对于每个 $k \\geq 0$，都有 $\\psi_{k}(\\pm 1)=0$ 和 $\\psi_{k}'(\\pm 1)=0$。\n\n现在我们证明其完备性。令 $V := H^{2}_{0}(-1,1) = \\{ v \\in H^{2}(-1,1) : v(\\pm 1)=0,\\ v'(\\pm 1)=0 \\}$。一个标准的结果是，对于紧区间上的任意整数 $m \\geq 0$，代数多项式在 $H^{m}(-1,1)$ 中是稠密的。此外，迹算子 $v \\mapsto v(\\pm 1)$ 和 $v \\mapsto v'(\\pm 1)$ 是 $H^{2}(-1,1)$ 上的连续线性泛函。定义一个连续线性“边界提升”算子 $\\mathcal{B}: \\mathbb{R}^{4} \\to H^{2}(-1,1)$，它将一个函数及其一阶导数的指定端点值映射到一个三次 Hermite 插值多项式 $h(x)$，该多项式满足 $h(\\pm 1)$ 和 $h'(\\pm 1)$ 等于这些指定值。给定任意 $f \\in V$，选择多项式 $q_{n}$ 在 $H^{2}(-1,1)$ 中逼近 $f$。令 $\\gamma(q_{n})$ 表示迹的四元组 $(q_{n}(-1),q_{n}(1),q_{n}'(-1),q_{n}'(1))$，并定义 $r_{n} := q_{n} - \\mathcal{B}(\\gamma(q_{n}))$。则 $r_{n}$ 是满足夹持迹 $r_{n}(\\pm 1)=0$，$r_{n}'(\\pm 1)=0$ 的多项式，并且在 $H^{2}(-1,1)$ 中 $r_{n} \\to f$，因为 $\\gamma(q_{n}) \\to \\gamma(f)=0$ 且 $\\mathcal{B}$ 是连续的。因此，满足夹持边界条件的多项式子空间在 $V$ 中是稠密的。\n\n剩下的任务是证明 $\\{\\psi_{k}\\}_{k=0}^{\\infty}$ 张成了具有夹持迹的多项式子空间。观察到每个 $\\psi_{k}$ 的首项是系数为 1 的 $T_{k+4}(x)$，并且只涉及次数严格更低的 $T_{k+2}(x)$ 和 $T_{k}(x)$。因此，相对于有序切比雪夫基 $\\{T_{0},T_{1},\\dots,T_{N}\\}$，将以 $\\{\\psi_{0},\\dots,\\psi_{N-4}\\}$ 表示的约束多项式的系数向量映射到其切比雪夫系数向量的线性变换是上三角矩阵，且对角线元素为1（在对应于次数 $\\geq 4$ 的块中）。因此，通过标准的三角性及维数计数论证，$\\{\\psi_{0},\\dots,\\psi_{N-4}\\}$ 是次数至多为 $N$ 且满足夹持边界条件的多项式空间的基。取极限 $N \\to \\infty$，我们得出结论：$\\{\\psi_{k}\\}_{k=0}^{\\infty}$ 是约束多项式稠密子空间中的一个完备系，因此在 $V$ 中是完备的。\n\n最后，这样的基在谱离散化中消除了伪边界模式，因为边界条件在试探空间的层面上就已恒等满足。因此，离散算子作用于一个零空间仅由物理上允许的模式构成的子空间，从而避免了代数不一致性以及在事后施加多个边界条件时可能出现的人为的、病态的边界模式。\n\n因此，所求的闭式基函数为\n$$\n\\psi_{k}(x) = T_{k+4}(x) - 2\\,\\frac{k+2}{k+1}\\,T_{k+2}(x) + \\frac{k+3}{k+1}\\,T_{k}(x), \\qquad k \\geq 0.\n$$", "answer": "$$\\boxed{\\,\\psi_{k}(x)=T_{k+4}(x)-2\\,\\frac{k+2}{k+1}\\,T_{k+2}(x)+\\frac{k+3}{k+1}\\,T_{k}(x)\\,}$$", "id": "3300741"}]}