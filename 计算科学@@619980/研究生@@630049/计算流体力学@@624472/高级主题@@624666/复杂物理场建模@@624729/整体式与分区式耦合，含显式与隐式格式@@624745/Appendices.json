{"hands_on_practices": [{"introduction": "理论分析是理解数值方法核心行为的第一步。本练习提供了一个经典的一维弹簧-质量-流体耦合基准问题，通过这个简化的模型，我们可以清晰地推导出分区显式耦合方案中“附加质量不稳定性”的根源，并分析其稳定性的边界条件。通过与无条件稳定的整体式隐式方案进行对比，您将对不同耦合策略的内在稳定特性建立起坚实的理论基础 [@problem_id:3346884]。", "problem": "本文提出了一个一维弹簧-质量-流体耦合基准问题，用于评估计算流体力学 (CFD) 和流固耦合 (FSI) 中的耦合稳定性。一个质量为 $m_s$ 的结构体连接到一个刚度为 $k$ 的线性弹簧上，在静止的不可压缩流体中运动。由于势流加速效应，流体在运动方向上提供了一个恒定的附加质量 $m_a$。假设 $m_s>0$，$m_a\\ge 0$，$k>0$。忽略粘性阻尼和任何拖曳力；唯一的流体效应是惯性效应，通过附加质量进行建模。因此，描述质量块位移 $x(t)$ 的精确耦合连续统常微分方程为\n$$\n\\left(m_s + m_a\\right)\\,\\ddot{x}(t) + k\\,x(t) = 0,\n$$\n该方程由牛顿第二定律和势流的标准线性附加质量闭合模型导出。\n\n我们将比较两种时间积分/耦合策略的稳定性：\n\n- 单体隐式：将参数为 $\\beta=\\tfrac{1}{4}$ 和 $\\gamma=\\tfrac{1}{2}$ 的全隐式 Newmark 族时间积分器直接应用于组合方程 $\\left(m_s+m_a\\right)\\ddot{x} + kx=0$。\n\n- 分区显式：使用单迭代、交错的狄利克雷-诺伊曼耦合以及中心差分结构更新。在均匀步长为 $\\Delta t$ 的离散时间层 $n$ 上，结构加速度由中心差分定义为\n$$\na^n := \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2}.\n$$\n设流体牵引力由附加质量力 $F_f=-m_a \\ddot{x}$ 建模，但采用显式计算并滞后一个时间步，即 $F_f^n=-m_a a^{n-1}$。通过下式推进结构，\n$$\nm_s\\,a^n + k\\,x^n = F_f^n,\n$$\n不进行子迭代。\n\n任务：\n\n1.  仅从牛顿第二定律、附加质量定义以及给定的离散公式出发，推导控制分区显式方案中 $\\{x^n\\}$ 的齐次线性递推关系。\n\n2.  进行冯·诺依曼放大因子分析，通过代入 $x^n=\\hat{x}\\,\\rho^n$（其中 $\\rho$ 为复数），得到单位圆 $|\\rho|=1$ 上的稳定性边界。确定分区显式方案稳定性的 $\\Delta t$ 的充分必要条件，其形式为 $\\Delta t \\le \\Delta t_{\\max}(m_s,m_a,k)$，并找出为使非零 $\\Delta t_{\\max}$ 存在而必须满足的任何质量比约束。\n\n3.  对于将参数为 $\\beta=\\tfrac{1}{4}$、$\\gamma=\\tfrac{1}{2}$ 的单体隐式 Newmark 方案应用于组合质量 $\\left(m_s+m_a\\right)$ 的情况，说明在线性保守动力学中是否存在时间步长限制。\n\n请提供分区显式方案中 $\\Delta t_{\\max}(m_s,m_a,k)$ 的单个闭式解析表达式作为最终结果。不要代入数值。最终的方框表达式中无需包含单位；请仅用 $m_s$、$m_a$ 和 $k$ 来表示您的答案。", "solution": "用户提供的问题陈述已经过严格审查，并被确定为**有效**。该问题具有科学依据，提法恰当，客观，并包含了推导所需结果的所有必要信息。此问题是分析流固耦合 (FSI) 耦合方案数值稳定性的一个标准（尽管简化了）的基准问题。\n\n解答过程按顺序处理三个任务。\n\n### 任务 1：推导递推关系\n\n分区显式方案由三个离散方程定义：\n1.  结构时间推进方程：\n    $$m_s a^n + k x^n = F_f^n$$\n2.  流体力的显式耦合，滞后一个时间步：\n    $$F_f^n = -m_a a^{n-1}$$\n3.  加速度的二阶中心差分近似：\n    $$a^k := \\frac{x^{k+1} - 2x^k + x^{k-1}}{\\Delta t^2}$$\n    其中 $k$ 是一个通用时间层索引，$\\Delta t$ 是恒定的时间步长。\n\n我们首先将流体力定义 (2) 代入结构方程 (1)：\n$$m_s a^n + k x^n = -m_a a^{n-1}$$\n接下来，我们将加速度的中心差分公式 (3) 代入 $a^n$ 和 $a^{n-1}$：\n$$m_s \\left( \\frac{x^{n+1} - 2x^n + x^{n-1}}{\\Delta t^2} \\right) + k x^n = -m_a \\left( \\frac{x^n - 2x^{n-1} + x^{n-2}}{\\Delta t^2} \\right)$$\n为了消去分母 $\\Delta t^2$，我们将整个方程乘以 $\\Delta t^2$：\n$$m_s (x^{n+1} - 2x^n + x^{n-1}) + k \\Delta t^2 x^n = -m_a (x^n - 2x^{n-1} + x^{n-2})$$\n最后一步是通过将所有项移到左侧并按时间索引分组，将此方程重排为齐次线性递推关系：\n$$m_s x^{n+1} + (-2m_s x^n + m_s x^{n-1}) + k \\Delta t^2 x^n + (m_a x^n - 2m_a x^{n-1} + m_a x^{n-2}) = 0$$\n$$m_s x^{n+1} + (-2m_s + k \\Delta t^2 + m_a)x^n + (m_s - 2m_a)x^{n-1} + m_a x^{n-2} = 0$$\n这就是控制离散位移 $\\{x^n\\}$ 所需的齐次线性递推关系。\n\n### 任务 2：分区显式方案的稳定性分析\n\n为进行冯·诺依曼稳定性分析，我们假设解的形式为 $x^n = \\hat{x} \\rho^n$，其中 $\\rho$ 是复放大因子。将其代入递推关系中得到：\n$$m_s \\hat{x} \\rho^{n+1} + (m_a - 2m_s + k \\Delta t^2) \\hat{x} \\rho^n + (m_s - 2m_a) \\hat{x} \\rho^{n-1} + m_a \\hat{x} \\rho^{n-2} = 0$$\n两边除以 $\\hat{x} \\rho^{n-2}$（假设 $\\hat{x} \\neq 0$ 且 $\\rho \\neq 0$），我们得到放大因子 $\\rho$ 的特征多项式：\n$$P(\\rho) = m_s \\rho^3 + (m_a - 2m_s + k \\Delta t^2) \\rho^2 + (m_s - 2m_a) \\rho + m_a = 0$$\n为使方案稳定，该多项式的所有根 $\\rho_i$ 都必须满足条件 $|\\rho_i| \\le 1$。稳定性边界出现在至少有一个根位于单位圆上时，即 $|\\rho|=1$。对于此类显式方案，一个常见的稳定性极限发生在实根在 $\\rho=-1$ 处穿过单位圆时。\n\n我们在 $\\rho = -1$ 处计算特征多项式的值：\n$$P(-1) = m_s(-1)^3 + (m_a - 2m_s + k \\Delta t^2)(-1)^2 + (m_s - 2m_a)(-1) + m_a$$\n$$P(-1) = -m_s + (m_a - 2m_s + k \\Delta t^2) - (m_s - 2m_a) + m_a$$\n$$P(-1) = -m_s + m_a - 2m_s + k \\Delta t^2 - m_s + 2m_a + m_a$$\n$$P(-1) = (-m_s - 2m_s - m_s) + (m_a + 2m_a + m_a) + k \\Delta t^2$$\n$$P(-1) = -4m_s + 4m_a + k \\Delta t^2$$\n对于三次多项式，使用 Jury 稳定性判据的更正式方法要求，对于一个稳定的系统（所有根都在单位圆内），$(-1)^3 P(-1) > 0$ 成立，这可以简化为 $P(-1)  0$。\n$$-4m_s + 4m_a + k \\Delta t^2  0$$\n$$k \\Delta t^2  4(m_s - m_a)$$\n要使这个不等式在 $\\Delta t^2$ 为正的情况下成立，右侧必须为正。鉴于 $k>0$，这对质量施加了一个关键约束：\n$$m_s - m_a > 0 \\implies m_s > m_a$$\n这是为使非零的稳定时间步长 $\\Delta t_{\\max}$ 存在而必须满足的质量比约束。如果 $m_s \\le m_a$，则分区显式方案是无条件不稳定的。\n\n假设 $m_s > m_a$，稳定性条件为：\n$$\\Delta t^2  \\frac{4(m_s - m_a)}{k}$$\n因此，稳定性边界由最大允许时间步长 $\\Delta t_{\\max}$ 定义：\n$$\\Delta t_{\\max} = \\sqrt{\\frac{4(m_s - m_a)}{k}} = 2\\sqrt{\\frac{m_s - m_a}{k}}$$\n这个从 $\\rho=-1$ 条件推导出的结果确实是最紧的约束，这一点已通过 Jury 稳定性判据的完整应用得到证实。\n\n### 任务 3：单体隐式方案的稳定性\n\n单体方案将单个时间积分器应用于完全耦合的运动方程：\n$$(m_s + m_a)\\ddot{x}(t) + k x(t) = 0$$\n这是一个标准的线性、无阻尼、单自由度振子方程，其总质量为 $M = m_s + m_a$，刚度为 $K=k$。\n指定的时间积分器是参数为 $\\beta=\\frac{1}{4}$ 和 $\\gamma=\\frac{1}{2}$ 的 Newmark 方法。这个参数选择对应于常平均加速度法，该方法在数学上等效于二阶系统的梯形法则。\n在数值分析和结构动力学中，一个公认的结论是，常平均加速度法对于线性系统是无条件稳定的。这意味着对于任何时间步长 $\\Delta t > 0$ 的选择，无论 $\\Delta t$ 相对于系统固有周期有多大，数值解都不会出现无界增长。\n因此，对于单体隐式 Newmark 方案，稳定性**没有时间步长限制**。\n\n最终要求回答的是任务2中 $\\Delta t_{\\max}$ 的表达式。", "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_s - m_a}{k}}}\n$$", "id": "3346884"}, {"introduction": "在理论分析的基础上，本练习将引导您进入数值稳定性的实践探索。您将为一个简化的流-固耦合通道模型构建分区显式和整体式隐式两种方案的放大矩阵，这是数值分析中的一项核心技能。通过计算这些矩阵的谱半径，您将能够以数值方式判断不同参数（如密度比）下的稳定性，从而直观地验证分区显式方案在特定条件下的脆弱性以及整体式方案的鲁棒性 [@problem_id:3346901]。", "problem": "考虑一个简化的流固耦合 (FSI) 模型，该模型用于一个二维通道，其具有一个长度为 $L$、平面外宽度为单位长度的柔性壁段。该壁被建模为单位长度的单自由度线质量 $m_s$，与单位长度刚度为 $k_s$ 的线性弹簧和单位长度阻尼为 $c_s$ 的线性缓冲器相耦合。周围密度为 $\\rho_f$ 的不可压缩流体引起一个惯性反作用力，在线性化的小振幅情况下，可表示为单位长度的附加质量 $M_a = C_a \\rho_f L^2$，其中 $C_a$ 是一个无量纲的、与几何相关的附加质量系数。壁在法向的位移是 $y(t)$，流体的相互作用力作用于抵抗界面的加速度。密度比定义为 $r = m_s / (\\rho_f L^2)$，这是一个无量纲量。\n\n从牛顿第二定律出发，考虑柔性壁，并将流体反作用力建模为附加质量。在连续设定下，这会导出一个关于 $y(t)$ 的常微分方程 (ODE)，该方程耦合了结构惯性 $m_s$ 和流体诱导的惯性 $M_a$，以及阻尼 $c_s$ 和刚度 $k_s$ 项。您将比较两种数值耦合策略：\n\n1. 一种分区显式界面更新方法，它使用前一时间步计算的流体惯性反作用力来推进结构。对结构使用一阶前向欧拉时间离散化。在此设定中，时间步 $n$ 的离散流体力必须建模为由前一步加速度引起的反作用力，即作为抵抗运动的 $-M_a a^{n-1}$。\n\n2. 一种整体隐式牛顿耦合方法，它在新时间点上同时处理结构和流体反作用力。使用一阶后向欧拉时间离散化，并在时间步 $n+1$ 隐式处理耦合惯性 $(m_s + M_a)$。\n\n根据这些原理，推导每种格式的线性、时间步到时间步的放大算子，写成一个显式矩阵，将时间步 $n$ 的状态映射到时间步 $n+1$ 的状态。对于分区显式格式，必须选择状态以适应流体反作用力中一步加速度的延迟。对于整体隐式格式，使用后向欧拉速度更新和位移更新直接消去加速度，以形成位移-速度变量的闭合放大矩阵。对于两种格式，离散时间系统是稳定的，当且仅当放大矩阵的谱半径（特征值的最大绝对值）严格小于 $1$。\n\n您的程序必须实现以下步骤：\n\n- 对于每个测试用例，计算单位长度的附加质量 $M_a = C_a \\rho_f L^2$。\n- 构建分区显式格式在前向欧拉下的放大矩阵，使用滞后的流体反作用力 $-M_a a^{n-1}$，状态向量包含位移 $y^n$、速度 $v^n$ 和前一步的加速度 $a^{n-1}$。\n- 构建整体隐式格式在后向欧拉下的放大矩阵，其中 $(m_s + M_a)$ 被隐式处理，状态向量包含 $y^n$ 和 $v^n$。\n- 计算每个放大矩阵的谱半径，并通过检查谱半径是否严格小于 $1$ 来判断每种格式的稳定性（true 表示稳定，false 表示不稳定）。\n- 将每个测试用例的结果聚合为一个成对的列表 $[s_{\\mathrm{part}}, s_{\\mathrm{mono}}]$，其中 $s_{\\mathrm{part}}$ 和 $s_{\\mathrm{mono}}$ 是分别指示分区显式和整体隐式格式稳定性的布尔值。\n\n物理和数值单位：\n\n- $L$ 单位为 $\\mathrm{m}$，$\\rho_f$ 单位为 $\\mathrm{kg/m^3}$，$m_s$ 单位为 $\\mathrm{kg/m}$，$k_s$ 单位为 $\\mathrm{N/m^2}$，$c_s$ 单位为 $\\mathrm{N\\cdot s/m^2}$，$C_a$ 无量纲，时间步 $\\Delta t$ 单位为 $\\mathrm{s}$。\n\n测试套件：\n\n- 情况 1：$L = 0.1\\,\\mathrm{m}$，$\\rho_f = 1000\\,\\mathrm{kg/m^3}$，$m_s = 0.1\\,\\mathrm{kg/m}$，$k_s = 1.0\\times 10^4\\,\\mathrm{N/m^2}$，$c_s = 100\\,\\mathrm{N\\cdot s/m^2}$，$C_a = 1.0$，$\\Delta t = 0.005\\,\\mathrm{s}$。\n- 情况 2 (无阻尼边界类型)：$L = 0.1\\,\\mathrm{m}$，$\\rho_f = 1000\\,\\mathrm{kg/m^3}$，$m_s = 10.0\\,\\mathrm{kg/m}$，$k_s = 1.0\\times 10^4\\,\\mathrm{N/m^2}$，$c_s = 0\\,\\mathrm{N\\cdot s/m^2}$，$C_a = 0.8$，$\\Delta t = 0.02\\,\\mathrm{s}$。\n- 情况 3 (重结构)：$L = 0.1\\,\\mathrm{m}$，$\\rho_f = 1000\\,\\mathrm{kg/m^3}$，$m_s = 100.0\\,\\mathrm{kg/m}$，$k_s = 5.0\\times 10^3\\,\\mathrm{N/m^2}$，$c_s = 200\\,\\mathrm{N\\cdot s/m^2}$，$C_a = 0.3$，$\\Delta t = 0.05\\,\\mathrm{s}$。\n- 情况 4 (大附加质量)：$L = 0.1\\,\\mathrm{m}$，$\\rho_f = 1000\\,\\mathrm{kg/m^3}$，$m_s = 1.0\\,\\mathrm{kg/m}$，$k_s = 8.0\\times 10^3\\,\\mathrm{N/m^2}$，$c_s = 50\\,\\mathrm{N\\cdot s/m^2}$，$C_a = 1.5$，$\\Delta t = 0.02\\,\\mathrm{s}$。\n\n要求的最终输出格式：\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号括起来，其中每个条目本身是每个测试用例（按上述顺序）的一个双元素布尔值列表；例如 $[[\\mathrm{True},\\mathrm{False}],\\ldots]$。", "solution": "用户请求对一个简化的流固耦合 (FSI) 问题的数值稳定性进行分析。该分析需要为两种不同的耦合格式推导和实现放大算子：一种是分区显式格式，另一种是整体隐式格式。该问题在科学上是合理的、适定的，并且为进行完整分析提供了所有必要的参数。\n\n### 控制方程\n该问题描述了一个用于柔性壁位移 $y(t)$ 的单自由度力学系统。壁段具有单位长度的结构质量 $m_s$，由刚度为 $k_s$ 的弹簧和阻尼为 $c_s$ 的缓冲器约束。流体的反作用力被建模为附加质量 $M_a$，它提供一个与壁的加速度 $a(t) = \\ddot{y}(t)$ 相反的惯性力。\n\n应用牛顿第二定律，合力等于质量乘以加速度。作用在结构上的力有弹簧力 ($-k_s y$)、阻尼力 ($-c_s v$，其中 $v=\\dot{y}$) 和流体力 ($-M_a a$)。\n$$\nm_s a(t) = -k_s y(t) - c_s v(t) - M_a a(t)\n$$\n重新整理各项，得到完全耦合系统的标准二阶线性常微分方程 (ODE)：\n$$\n(m_s + M_a) a(t) + c_s v(t) + k_s y(t) = 0\n$$\n该方程代表一个阻尼谐振子，其有效质量为 $M_{eff} = m_s + M_a$。我们现在将使用指定的两种格式对该系统进行离散化。\n\n### 格式 1：分区显式格式\n此格式对结构时间积分使用前向欧拉方法，并根据前一时间步的加速度 $a^{n-1}$ 显式处理流体力。这先验地是被称为“附加质量不稳定性”的潜在不稳定性的来源。\n\n离散方程为：\n1.  在时间步 $n$ 的牛顿第二定律，使用滞后的流体力：\n    $$\n    m_s a^n = -k_s y^n - c_s v^n - M_a a^{n-1}\n    $$\n2.  速度和位移的前向欧拉更新：\n    $$\n    v^{n+1} = v^n + \\Delta t \\cdot a^n\n    $$\n    $$\n    y^{n+1} = y^n + \\Delta t \\cdot v^n\n    $$\n\n为构建放大矩阵，我们首先用时间步 $n$ 和 $n-1$ 的状态表示当前加速度 $a^n$：\n$$\na^n = -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1}\n$$\n问题指定了一个包含滞后加速度的状态向量：$\\mathbf{z}^n = [y^n, v^n, a^{n-1}]^T$。下一时间步的状态是 $\\mathbf{z}^{n+1} = [y^{n+1}, v^{n+1}, a^n]^T$。\n\n$\\mathbf{z}^{n+1}$ 各分量的更新方程为：\n$$\ny^{n+1} = 1 \\cdot y^n + \\Delta t \\cdot v^n + 0 \\cdot a^{n-1}\n$$\n$$\nv^{n+1} = v^n + \\Delta t \\left( -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1} \\right) = -\\frac{k_s \\Delta t}{m_s} y^n + \\left(1 - \\frac{c_s \\Delta t}{m_s}\\right) v^n - \\frac{M_a \\Delta t}{m_s} a^{n-1}\n$$\n$$\na^{n} = -\\frac{k_s}{m_s} y^n - \\frac{c_s}{m_s} v^n - \\frac{M_a}{m_s} a^{n-1}\n$$\n这些方程可以写成矩阵形式 $\\mathbf{z}^{n+1} = \\mathbf{A}_{\\mathrm{part}} \\mathbf{z}^n$，其中分区显式放大矩阵 $\\mathbf{A}_{\\mathrm{part}}$ 为：\n$$\n\\mathbf{A}_{\\mathrm{part}} =\n\\begin{pmatrix}\n1  \\Delta t  0 \\\\\n-\\frac{k_s \\Delta t}{m_s}  1 - \\frac{c_s \\Delta t}{m_s}  -\\frac{M_a \\Delta t}{m_s} \\\\\n-\\frac{k_s}{m_s}  -\\frac{c_s}{m_s}  -\\frac{M_a}{m_s}\n\\end{pmatrix}\n$$\n\n### 格式 2：整体隐式格式\n此格式使用后向欧拉方法，在时间步 $n+1$ 隐式处理整个系统，包括流体附加质量。\n\n在时间 $n+1$ 处计算的完全隐式离散运动方程为：\n$$\n(m_s + M_a) a^{n+1} + c_s v^{n+1} + k_s y^{n+1} = 0\n$$\n后向欧拉更新将时间步 $n+1$ 的状态与时间步 $n$ 的状态联系起来：\n$$\ny^{n+1} = y^n + \\Delta t \\cdot v^{n+1}\n$$\n$$\nv^{n+1} = v^n + \\Delta t \\cdot a^{n+1} \\implies a^{n+1} = \\frac{v^{n+1} - v^n}{\\Delta t}\n$$\n此格式的状态向量是 $\\mathbf{z}^n = [y^n, v^n]^T$。为了找到放大矩阵，我们必须将 $\\mathbf{z}^{n+1} = [y^{n+1}, v^{n+1}]^T$ 表示为 $\\mathbf{z}^n$ 的函数。我们将 $y^{n+1}$ 和 $a^{n+1}$ 的表达式代入隐式运动方程：\n$$\nM_{eff} \\left( \\frac{v^{n+1} - v^n}{\\Delta t} \\right) + c_s v^{n+1} + k_s (y^n + \\Delta t \\cdot v^{n+1}) = 0\n$$\n其中 $M_{eff} = m_s + M_a$。我们现在求解 $v^{n+1}$：\n$$\n\\left( \\frac{M_{eff}}{\\Delta t} + c_s + k_s \\Delta t \\right) v^{n+1} = -k_s y^n + \\frac{M_{eff}}{\\Delta t} v^n\n$$\n设 $D = \\frac{M_{eff}}{\\Delta t} + c_s + k_s \\Delta t$。则：\n$$\nv^{n+1} = \\left(-\\frac{k_s}{D}\\right) y^n + \\left(\\frac{M_{eff}/\\Delta t}{D}\\right) v^n\n$$\n现在，我们使用其更新规则找到 $y^{n+1}$：\n$$\ny^{n+1} = y^n + \\Delta t \\cdot v^{n+1} = y^n + \\Delta t \\left[ \\left(-\\frac{k_s}{D}\\right) y^n + \\left(\\frac{M_{eff}/\\Delta t}{D}\\right) v^n \\right]\n$$\n$$\ny^{n+1} = \\left(1 - \\frac{k_s \\Delta t}{D}\\right) y^n + \\left(\\frac{M_{eff}}{D}\\right) v^n\n$$\n这些方程构成了矩阵系统 $\\mathbf{z}^{n+1} = \\mathbf{A}_{\\mathrm{mono}} \\mathbf{z}^n$，其中整体隐式放大矩阵 $\\mathbf{A}_{\\mathrm{mono}}$ 是：\n$$\n\\mathbf{A}_{\\mathrm{mono}} =\n\\begin{pmatrix}\n1 - \\frac{k_s \\Delta t}{D}  \\frac{M_{eff}}{D} \\\\\n-\\frac{k_s}{D}  \\frac{M_{eff}/\\Delta t}{D}\n\\end{pmatrix}\n$$\n\n### 稳定性分析\n对于两种格式，数值方法是稳定的，当且仅当系统状态不会随时间无限增长。对于 $\\mathbf{z}^{n+1} = \\mathbf{A} \\mathbf{z}^n$ 形式的线性时不变系统，这要求放大矩阵 $\\mathbf{A}$ 的谱半径（记为 $\\rho(\\mathbf{A})$）严格小于 $1$。谱半径定义为矩阵 $\\mathbf{A}$ 特征值的最大绝对值：\n$$\n\\rho(\\mathbf{A}) = \\max_{i} |\\lambda_i(\\mathbf{A})|\n$$\n稳定性判据是 $\\rho(\\mathbf{A})  1$。程序将为每个矩阵和测试用例计算该值以确定稳定性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of partitioned explicit and monolithic implicit\n    schemes for a simplified fluid-structure interaction problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: L, rho_f, m_s, k_s, c_s, C_a, dt\n        (0.1, 1000.0, 0.1, 1.0e4, 100.0, 1.0, 0.005),\n        # Case 2: undamped boundary-type\n        (0.1, 1000.0, 10.0, 1.0e4, 0.0, 0.8, 0.02),\n        # Case 3: heavy structure\n        (0.1, 1000.0, 100.0, 5.0e3, 200.0, 0.3, 0.05),\n        # Case 4: large added mass\n        (0.1, 1000.0, 1.0, 8.0e3, 50.0, 1.5, 0.02),\n    ]\n\n    results = []\n    for L, rho_f, m_s, k_s, c_s, C_a, dt in test_cases:\n        # Compute added mass per unit length\n        M_a = C_a * rho_f * L**2\n\n        # --- Scheme 1: Partitioned Explicit ---\n        # Construct the amplification matrix A_part\n        # State vector: [y^n, v^n, a^(n-1)]\n        # A_part maps state at n to state at n+1\n        if m_s == 0:\n            # Avoid division by zero, though not expected in test cases\n            is_stable_part = False\n        else:\n            A_part = np.array([\n                [1.0, dt, 0.0],\n                [-k_s * dt / m_s, 1.0 - c_s * dt / m_s, -M_a * dt / m_s],\n                [-k_s / m_s, -c_s / m_s, -M_a / m_s]\n            ], dtype=np.float64)\n            \n            # Compute spectral radius and check stability\n            eigvals_part = np.linalg.eigvals(A_part)\n            rho_part = np.max(np.abs(eigvals_part))\n            is_stable_part = rho_part  1.0\n\n        # --- Scheme 2: Monolithic Implicit ---\n        # Construct the amplification matrix A_mono\n        # State vector: [y^n, v^n]\n        # A_mono maps state at n to state at n+1\n        M_eff = m_s + M_a\n        D = M_eff / dt + c_s + k_s * dt\n        \n        if D == 0:\n            # Avoid division by zero, not expected for physical parameters\n            is_stable_mono = False\n        else:\n            A_mono = np.array([\n                [1.0 - k_s * dt / D, M_eff / D],\n                [-k_s / D, (M_eff / dt) / D]\n            ], dtype=np.float64)\n\n            # Compute spectral radius and check stability\n            eigvals_mono = np.linalg.eigvals(A_mono)\n            rho_mono = np.max(np.abs(eigvals_mono))\n            is_stable_mono = rho_mono  1.0\n        \n        results.append([is_stable_part, is_stable_mono])\n\n    # Final print statement in the exact required format.\n    # The required format \"[[True,False],...]\" is the standard string\n    # representation of a list of lists of booleans in Python, with spaces removed.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3346901"}, {"introduction": "除了稳定性，耦合方案的精度同样至关重要，尤其是在涉及波传播的场景中。本练习通过分析声波与弹性板相互作用时的虚假反射，深入探讨了不同方案的保真度。您需要推导并实现物理系统、分区方案和整体式方案的反射系数，并通过量化误差来评估数值方案捕捉真实物理现象的能力，从而体会到保持界面一致性的整体式方案在精度上的优势 [@problem_id:3346902]。", "problem": "考虑一道一维小振幅平面声波，在可压缩流体（密度为 $\\rho$，声速为 $c$）中，入射到位于 $x=0$ 处的柔性板上。该板的面积为 $A$，集总质量为 $m$，线性刚度为 $k$。假设板遵循线性声学和单自由度结构模型。设入射质点速度波为 $u_{\\text{inc}}(t)$，反射分量为 $u_{\\text{ref}}(t)$；总界面速度为 $v(t) = u_{\\text{inc}}(t) + u_{\\text{ref}}(t)$。流体在界面处的特征关系为 $p(t) = \\rho c \\big(u_{\\text{inc}}(t) - u_{\\text{ref}}(t)\\big)$，其中 $p(t)$ 是作用在板上的界面压力。板位移 $\\xi(t)$ 满足 $m \\ddot{\\xi}(t) + k \\xi(t) = A p(t)$ 且 $v(t) = \\dot{\\xi}(t)$。在频域中对时谐激励进行分析，并定义速度反射系数 $R(\\omega) = U_{\\text{ref}}(\\omega) / U_{\\text{inc}}(\\omega)$，其中 $U_{\\text{inc}}(\\omega)$ 和 $U_{\\text{ref}}(\\omega)$ 是 $u_{\\text{inc}}(t)$ 和 $u_{\\text{ref}}(t)$ 在角频率 $\\omega$ 下的复振幅。\n\n任务 1：根据上述基本关系，推导板的连续时间频率响应 $H_{\\text{cont}}(\\omega) = V(\\omega)/P(\\omega)$，然后用 $\\rho$、$c$、$A$、$m$、$k$ 和 $\\omega$ 表示连续时间反射系数 $R_{\\text{phys}}(\\omega)$。\n\n任务 2：考虑离散时间下的分区显式单步延迟耦合，时间步长为均匀的 $\\Delta t$。假设离散时间谐波信号的复数乘子为 $z = e^{i \\omega \\Delta t}$。流体更新使用延迟的结构速度，因此界面压力为 $p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^{n-1}\\big)$。结构采用显式欧拉格式推进：\n- $\\xi^n = \\xi^{n-1} + \\Delta t\\, v^{n-1}$，\n- $v^n = v^{n-1} + \\frac{\\Delta t}{m}\\big(A p^n - k \\xi^{n-1}\\big)$。\n使用 $z$ 中的线性时谐分析，推导结构的离散传递函数 $H_{\\text{part}}(z) = V/P$ 和由此产生的离散反射系数 $R_{\\text{part}}(\\omega)$。\n\n任务 3：考虑采用界面一致质量耦合的整体梯形（Crank–Nicolson）时间积分，在同一时间层级上，流体和结构之间没有延迟：\n- $m \\frac{v^n - v^{n-1}}{\\Delta t} = \\frac{A}{2}\\big(p^n + p^{n-1}\\big) - \\frac{k}{2}\\big(\\xi^n + \\xi^{n-1}\\big)$，\n- $\\xi^n - \\xi^{n-1} = \\frac{\\Delta t}{2}\\big(v^n + v^{n-1}\\big)$，\n- $p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^n\\big)$。\n使用 $z = e^{i \\omega \\Delta t}$ 的线性时谐分析，推导 $H_{\\text{mono}}(z) = V/P$ 和由此产生的离散反射系数 $R_{\\text{mono}}(\\omega)$。\n\n任务 4：对于一组给定的物理参数和时间步长，将每个离散格式的伪反射误差幅值定义为 $E_{\\text{part}} = |R_{\\text{part}}(\\omega) - R_{\\text{phys}}(\\omega)|$ 和 $E_{\\text{mono}} = |R_{\\text{mono}}(\\omega) - R_{\\text{phys}}(\\omega)|$，其中 $|\\cdot|$ 表示复模。将 $R_{\\text{phys}}$ 解释为理想的连续时间目标，并将离散格式与其进行比较。这量化了分区单步延迟如何在界面上传播误差，以及整体界面一致质量耦合如何减少伪反射。该设置模拟了叠加在激波-板相互作用上的小振幅线性扰动，其中界面处的精确阻抗匹配控制着非物理反射。\n\n数值要求和单位：\n- 所有输入均使用国际单位制（SI）：$\\rho$ 单位为千克/立方米， $c$ 单位为米/秒， $A$ 单位为平方米， $m$ 单位为千克， $k$ 单位为牛顿/米， $\\Delta t$ 单位为秒。频率以赫兹（周/秒）为单位的 $f$ 或以弧度/秒为单位的 $\\omega$ 给出，其中 $\\omega = 2 \\pi f$；在计算中所有角度量均使用弧度。\n- 最终输出为无量纲浮点数。\n\n要实现和评估的测试套件：\n- 情况 1（标准情况，空气，中等频率）：$\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 2.0$, $k = 5 \\times 10^{4}$, $\\Delta t = 5 \\times 10^{-4}$, $f = 80$。使用 $\\omega = 2 \\pi f$。\n- 情况 2（结构共振）：$\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 1.0$, $k = 1 \\times 10^{5}$, $\\Delta t = 1 \\times 10^{-3}$, $\\omega = \\sqrt{k/m}$。\n- 情况 3（近奈奎斯特激励）：$\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 2.0$, $k = 5 \\times 10^{4}$, $\\Delta t = 1 \\times 10^{-4}$, $\\omega = 0.8 \\pi / \\Delta t$。\n- 情况 4（强流体阻抗，类水，中等面积）：$\\rho = 1000$, $c = 1500$, $A = 1.0 \\times 10^{-2}$, $m = 0.2$, $k = 1 \\times 10^{5}$, $\\Delta t = 2 \\times 10^{-4}$, $f = 500$。使用 $\\omega = 2 \\pi f$。\n- 情况 5（高刚度、轻质板，高频）：$\\rho = 1.2$, $c = 340$, $A = 1.0$, $m = 0.5$, $k = 1 \\times 10^{7}$, $\\Delta t = 5 \\times 10^{-5}$, $f = 2000$。使用 $\\omega = 2 \\pi f$。\n\n程序规范：\n- 实现推导出的公式，为每种情况计算 $R_{\\text{phys}}(\\omega)$、$R_{\\text{part}}(\\omega)$ 和 $R_{\\text{mono}}(\\omega)$，然后计算 $E_{\\text{part}}$ 和 $E_{\\text{mono}}$。\n- 对于每种情况，计算改进因子 $I = E_{\\text{part}}/E_{\\text{mono}}$。大于 1 的值表示与分区延迟格式相比，整体界面一致质量耦合减少了伪反射。\n- 您的程序应生成单行输出，其中包含 5 个改进因子，形式为用方括号括起来的逗号分隔列表（例如，`\"[I_1,I_2,I_3,I_4,I_5]\"`）。每个 $I_j$ 必须是十进制形式的浮点数。", "solution": "本解答旨在解决一个计算流固耦合（FSI）问题。核心任务是针对一维声-结构相互作用问题，在三种不同模型下推导并比较其频域反射系数：1) 精确连续时间物理模型，2) 具有单步延迟的离散时间分区显式耦合格式，以及 3) 离散时间整体隐式耦合格式。该比较量化了数值格式引入的伪反射。\n\n分析在频域中进行。对于连续时间，我们使用傅里叶变换，其中时间导数 $\\frac{d}{dt}$ 被替换为与角频率 $\\omega$ 的乘积 $i\\omega$。对于离散时间，我们使用 Z 变换，其中时间序列 $x^n$ 由其复振幅 $X$ 表示，时间步进算子为 $z=e^{i\\omega\\Delta t}$，其中 $\\Delta t$ 是时间步长。\n\n### 任务 1：连续时间物理模型推导\n\n柔性板的动力学由单自由度运动方程描述：\n$$m \\ddot{\\xi}(t) + k \\xi(t) = A p(t)$$\n其中 $\\xi(t)$ 是板位移， $m$ 是质量， $k$ 是刚度， $A$ 是面积， $p(t)$ 是界面压力。界面速度为 $v(t) = \\dot{\\xi}(t)$。\n\n在频域中，这些变为：\n$$V(\\omega) = i\\omega \\Xi(\\omega) \\quad \\implies \\quad \\Xi(\\omega) = \\frac{V(\\omega)}{i\\omega}$$\n$$(i\\omega)^2 = -\\omega^2$$\n将这些代入运动方程可得：\n$$m(-\\omega^2) \\frac{V(\\omega)}{i\\omega} + k \\frac{V(\\omega)}{i\\omega} = A P(\\omega)$$\n$$\\left( k - m\\omega^2 \\right) \\frac{V(\\omega)}{i\\omega} = A P(\\omega)$$\n连续时间频率响应，或称导纳，$H_{\\text{cont}}(\\omega) = V(\\omega)/P(\\omega)$ 为：\n$$H_{\\text{cont}}(\\omega) = \\frac{i\\omega A}{k - m\\omega^2}$$\n接下来，我们推导反射系数 $R_{\\text{phys}}(\\omega) = U_{\\text{ref}}(\\omega) / U_{\\text{inc}}(\\omega)$。界面关系为：\n$$V(\\omega) = U_{\\text{inc}}(\\omega) + U_{\\text{ref}}(\\omega) \\quad (1)$$\n$$P(\\omega) = \\rho c \\left(U_{\\text{inc}}(\\omega) - U_{\\text{ref}}(\\omega)\\right) \\quad (2)$$\n其中 $\\rho$ 是流体密度， $c$ 是声速。由 $(1)$ 可得 $U_{\\text{ref}}(\\omega) = V(\\omega) - U_{\\text{inc}}(\\omega)$。将其代入 $(2)$：\n$$P(\\omega) = \\rho c \\left(U_{\\text{inc}}(\\omega) - (V(\\omega) - U_{\\text{inc}}(\\omega))\\right) = \\rho c \\left(2U_{\\text{inc}}(\\omega) - V(\\omega)\\right)$$\n使用导纳关系 $V(\\omega) = H_{\\text{cont}}(\\omega) P(\\omega)$，我们可以写出：\n$$P(\\omega) = \\rho c \\left(2U_{\\text{inc}}(\\omega) - H_{\\text{cont}}(\\omega) P(\\omega)\\right)$$\n$$P(\\omega) \\left(1 + \\rho c H_{\\text{cont}}(\\omega)\\right) = 2 \\rho c U_{\\text{inc}}(\\omega)$$\n求解 $V(\\omega)$:\n$$V(\\omega) = H_{\\text{cont}}(\\omega) P(\\omega) = \\frac{2 \\rho c H_{\\text{cont}}(\\omega)}{1 + \\rho c H_{\\text{cont}}(\\omega)} U_{\\text{inc}}(\\omega)$$\n最后，求解反射系数：\n$$R_{\\text{phys}}(\\omega) = \\frac{U_{\\text{ref}}(\\omega)}{U_{\\text{inc}}(\\omega)} = \\frac{V(\\omega) - U_{\\text{inc}}(\\omega)}{U_{\\text{inc}}(\\omega)} = \\frac{2 \\rho c H_{\\text{cont}}(\\omega)}{1 + \\rho c H_{\\text{cont}}(\\omega)} - 1$$\n$$R_{\\text{phys}}(\\omega) = \\frac{2 \\rho c H_{\\text{cont}}(\\omega) - \\left(1 + \\rho c H_{\\text{cont}}(\\omega)\\right)}{1 + \\rho c H_{\\text{cont}}(\\omega)} = \\frac{\\rho c H_{\\text{cont}}(\\omega) - 1}{1 + \\rho c H_{\\text{cont}}(\\omega)}$$\n\n### 任务 2：分区显式格式推导\n\n分区格式的离散方程为：\n$$ \\xi^n = \\xi^{n-1} + \\Delta t\\, v^{n-1} \\quad (3) $$\n$$ v^n = v^{n-1} + \\frac{\\Delta t}{m}\\big(A p^n - k \\xi^{n-1}\\big) \\quad (4) $$\n$$ p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^{n-1}\\big) \\quad (5) $$\n我们假设谐波信号的形式为 $q^n = Q z^n$，其中 $z=e^{i\\omega\\Delta t}$。将此应用于方程 $(3)$ 和 $(4)$：\n由 $(3)$: $\\Xi z^n - \\Xi z^{n-1} = \\Delta t V z^{n-1} \\implies \\Xi z^{n-1}(z-1) = \\Delta t V z^{n-1} \\implies \\Xi(z-1) = \\Delta t V \\implies \\Xi = \\frac{\\Delta t}{z-1} V$。\n由 $(4)$: $V z^n - V z^{n-1} = \\frac{\\Delta t}{m}(A P z^n - k \\Xi z^{n-1})$。两边除以 $z^{n-1}$:\n$$V(z-1) = \\frac{\\Delta t}{m}(A P z - k \\Xi)$$\n代入 $\\Xi$ 的表达式：\n$$V(z-1) = \\frac{\\Delta t}{m} \\left(A P z - k \\frac{\\Delta t}{z-1} V\\right)$$\n$$V\\left[(z-1) + \\frac{k (\\Delta t)^2}{m(z-1)}\\right] = \\frac{A \\Delta t z}{m} P$$\n$$V\\left[\\frac{(z-1)^2 + \\frac{k}{m}(\\Delta t)^2}{z-1}\\right] = \\frac{A \\Delta t z}{m} P$$\n离散传递函数 $H_{\\text{part}}(z) = V/P$ 为：\n$$H_{\\text{part}}(z) = \\frac{A \\Delta t z}{m} \\frac{z-1}{(z-1)^2 + \\frac{k}{m}(\\Delta t)^2}$$\n接下来，我们推导离散反射系数。由 $(5)$:\n$$P z^n = \\rho c (2 U_{\\text{inc}} z^n - V z^{n-1}) \\implies P = \\rho c (2 U_{\\text{inc}} - V z^{-1})$$\n运动学关系 $v^n = u_{\\text{inc}}^n + u_{\\text{ref}}^n$ 给出在任意时间步长下 $V=U_{\\text{inc}}+U_{\\text{ref}}$。\n使用 $V = H_{\\text{part}}(z) P$:\n$$P = \\rho c (2 U_{\\text{inc}} - H_{\\text{part}}(z) P z^{-1})$$\n$$P \\left(1 + \\rho c z^{-1} H_{\\text{part}}(z)\\right) = 2 \\rho c U_{\\text{inc}}$$\n$$V = H_{\\text{part}}(z)P = \\frac{2 \\rho c H_{\\text{part}}(z)}{1 + \\rho c z^{-1} H_{\\text{part}}(z)} U_{\\text{inc}}$$\n$$R_{\\text{part}}(\\omega) = \\frac{V - U_{\\text{inc}}}{U_{\\text{inc}}} = \\frac{2 \\rho c H_{\\text{part}}(z)}{1 + \\rho c z^{-1} H_{\\text{part}}(z)} - 1 = \\frac{2 \\rho c H_{\\text{part}}(z) - (1 + \\rho c z^{-1} H_{\\text{part}}(z))}{1 + \\rho c z^{-1} H_{\\text{part}}(z)}$$\n$$R_{\\text{part}}(\\omega) = \\frac{\\rho c H_{\\text{part}}(z) (2 - z^{-1}) - 1}{1 + \\rho c z^{-1} H_{\\text{part}}(z)}$$\n\n### 任务 3：整体梯形格式推导\n\n整体格式的离散方程为：\n$$ m \\frac{v^n - v^{n-1}}{\\Delta t} = \\frac{A}{2}\\big(p^n + p^{n-1}\\big) - \\frac{k}{2}\\big(\\xi^n + \\xi^{n-1}\\big) \\quad (6) $$\n$$ \\xi^n - \\xi^{n-1} = \\frac{\\Delta t}{2}\\big(v^n + v^{n-1}\\big) \\quad (7) $$\n$$ p^n = \\rho c \\big(2 u_{\\text{inc}}^n - v^n\\big) \\quad (8) $$\n将谐波信号假设应用于 $(6)$ 和 $(7)$:\n由 $(7)$: $\\Xi(z-1) = \\frac{\\Delta t}{2}V(z+1) \\implies \\Xi = V \\frac{\\Delta t}{2} \\frac{z+1}{z-1}$。\n由 $(6)$: $m \\frac{V(z-1)}{\\Delta t} = \\frac{A}{2}P(z+1) - \\frac{k}{2}\\Xi(z+1)$。\n代入 $\\Xi$:\n$$ m \\frac{V(z-1)}{\\Delta t} = \\frac{A}{2}P(z+1) - \\frac{k}{2} \\left(V \\frac{\\Delta t}{2} \\frac{z+1}{z-1}\\right) (z+1) $$\n$$ V \\left[ \\frac{m(z-1)}{\\Delta t} + \\frac{k \\Delta t (z+1)^2}{4(z-1)} \\right] = P \\frac{A(z+1)}{2} $$\n$$ V \\left[ \\frac{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2}{4 \\Delta t (z-1)} \\right] = P \\frac{A(z+1)}{2} $$\n离散传递函数 $H_{\\text{mono}}(z) = V/P$ 为：\n$$H_{\\text{mono}}(z) = \\frac{A(z+1)}{2} \\frac{4 \\Delta t (z-1)}{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2} = \\frac{2 A \\Delta t (z^2-1)}{4m(z-1)^2 + k (\\Delta t)^2 (z+1)^2}$$\n接下来，我们推导相应的反射系数。由 $(8)$:\n$$P z^n = \\rho c (2 U_{\\text{inc}} z^n - V z^n) \\implies P = \\rho c (2 U_{\\text{inc}} - V)$$\n此关系在形式上与连续情况相同。因此，遵循与任务 1 中相同的推导，我们得到：\n$$R_{\\text{mono}}(\\omega) = \\frac{\\rho c H_{\\text{mono}}(z) - 1}{1 + \\rho c H_{\\text{mono}}(z)}$$\n这种形式突显了整体格式保留了物理阻抗关系的结构，其数值误差仅限于对系统导纳的近似，$H_{\\text{mono}}(z) \\approx H_{\\text{cont}}(\\omega)$。\n\n### 任务 4：误差度量\n\n分区格式和整体格式的伪反射误差定义为离散反射系数与物理反射系数之差的模：\n$$E_{\\text{part}} = \\left|R_{\\text{part}}(\\omega) - R_{\\text{phys}}(\\omega)\\right|$$\n$$E_{\\text{mono}} = \\left|R_{\\text{mono}}(\\omega) - R_{\\text{phys}}(\\omega)\\right|$$\n改进因子 $I$ 是这些误差的比率，它量化了此问题中整体格式相对于分区格式的相对精度：\n$$I = \\frac{E_{\\text{part}}}{E_{\\text{mono}}}$$\n若 $I > 1$，则表示整体格式产生的伪反射误差更小。以下程序实现了这些公式，用以计算给定测试用例的 $I$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the improvement factor of a monolithic vs. partitioned FSI coupling scheme\n    for five different test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (rho, c, A, m, k, dt, f, omega_expr)\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 2.0, 'k': 5e4, 'dt': 5e-4, 'f': 80, 'omega_expr': None},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 1.0, 'k': 1e5, 'dt': 1e-3, 'f': None, 'omega_expr': 'sqrt(k/m)'},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 2.0, 'k': 5e4, 'dt': 1e-4, 'f': None, 'omega_expr': '0.8*pi/dt'},\n        {'rho': 1000, 'c': 1500, 'A': 1.0e-2, 'm': 0.2, 'k': 1e5, 'dt': 2e-4, 'f': 500, 'omega_expr': None},\n        {'rho': 1.2, 'c': 340, 'A': 1.0, 'm': 0.5, 'k': 1e7, 'dt': 5e-5, 'f': 2000, 'omega_expr': None},\n    ]\n\n    improvement_factors = []\n    \n    for case in test_cases:\n        rho, c, A, m, k, dt = case['rho'], case['c'], case['A'], case['m'], case['k'], case['dt']\n        f, omega_expr = case['f'], case['omega_expr']\n\n        if f is not None:\n            omega = 2 * np.pi * f\n        elif omega_expr == 'sqrt(k/m)':\n            omega = np.sqrt(k / m)\n        elif omega_expr == '0.8*pi/dt':\n            omega = 0.8 * np.pi / dt\n        else:\n            raise ValueError(\"Invalid case setup for omega calculation.\")\n\n        # Use 1j for imaginary unit\n        j = 1j\n\n        # Task 1: Continuous-time physical model (R_phys)\n        H_cont_denom = k - m * omega**2\n        \n        # At resonance (omega = sqrt(k/m)), H_cont is infinite and R_phys limits to 1.\n        if np.isclose(H_cont_denom, 0):\n            R_phys = 1.0 + 0.0j\n        else:\n            H_cont = (j * omega * A) / H_cont_denom\n            R_phys = (rho * c * H_cont - 1) / (rho * c * H_cont + 1)\n\n        # Common discrete-time variable z\n        z = np.exp(j * omega * dt)\n\n        # Task 2: Partitioned explicit scheme (R_part)\n        H_part_denom = (z - 1)**2 + (k / m) * dt**2\n        H_part = (A * dt / m) * (z * (z - 1)) / H_part_denom\n        R_part_num = rho * c * H_part * (2 - 1/z) - 1\n        R_part_den = 1 + rho * c * (1/z) * H_part\n        R_part = R_part_num / R_part_den\n\n        # Task 3: Monolithic trapezoidal scheme (R_mono)\n        H_mono_denom = 4 * m * (z - 1)**2 + k * dt**2 * (z + 1)**2\n        H_mono = (2 * A * dt * (z**2 - 1)) / H_mono_denom\n        R_mono = (rho * c * H_mono - 1) / (rho * c * H_mono + 1)\n\n        # Task 4: Errors and improvement factor\n        E_part = np.abs(R_part - R_phys)\n        E_mono = np.abs(R_mono - R_phys)\n\n        # The improvement factor I = E_part / E_mono\n        if np.isclose(E_mono, 0.0):\n            # If mono error is zero (or near-zero), improvement is effectively infinite if part has error.\n            # If both are zero, improvement is 1 (no difference).\n            improvement_factor = 1.0 if np.isclose(E_part, 0.0) else np.inf\n        else:\n            improvement_factor = E_part / E_mono\n            \n        improvement_factors.append(improvement_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, improvement_factors))}]\")\n\nsolve()\n```", "id": "3346902"}]}