{"hands_on_practices": [{"introduction": "在高超声速流场中，激波后的气体分子平动能和转动能会迅速升高，但振动能的激发则需要一个弛豫过程。本练习旨在通过经典的Landau-Teller模型，让学生亲手实现对这一热力学非平衡现象的建模，并将其预测结果与高精度的直接模拟蒙特卡洛（DSMC）方法进行对比 [@problem_id:3332484]。这项实践有助于学生掌握描述振动能弛豫的基本物理原理和数值方法。", "problem": "考虑一道一维正激波在充满氮气的激波管中形成。上游流动的特征由给定的上游马赫数 $M_{\\infty}$、上游滞止（总）压力 $p_0$ 和上游静温 $T_1$ 确定。假设气体为热力学和量热学完美的理想气体，具有恒定比热比 $\\gamma$，并忽略化学反应、电子激发以及激波下游的任何空间变化（波后平动温度被视为在时间上均匀，并等于紧随激波后的静温）。氮气的振动模态被建模为量子谐振子，其振动特征温度为 $\\theta_v$。\n\n从跨越正激波的基本守恒定律和量子谐振子的振动能定义出发，实现 Landau–Teller 振动弛豫模型\n$$\n\\frac{dE_v}{dt} = \\frac{E_v^\\ast(T) - E_v}{\\tau_v(T)},\n$$\n其中 $E_v(t)$ 是单位摩尔的振动能，$E_v^\\ast(T)$ 是在温度 $T$ 下单位摩尔的平衡振动能，$\\tau_v(T)$ 是振动弛豫时间。使用 Millikan–White 关系式计算氮气的 $\\tau_v(T)$，该关系式由常数 $A$ 和 $B$ 参数化；关系式以绝对温度 $T$（单位为 $\\mathrm{K}$）和以大气压为单位的静压表示。对于氮气，使用 $A=1.75$ 和 $B=3.94$。输入该关系式的压力必须以大气压为单位，时间单位为秒。\n\n需使用的假设和常数：\n- 气体：氮气。\n- 比热比：$\\gamma = 1.4$（恒定）。\n- 上游静温：$T_1 = 300\\,\\mathrm{K}$。\n- 普适气体常数：$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 氮气振动特征温度：$\\theta_v = 3390\\,\\mathrm{K}$。\n- 上游静压 $p_1$ 通过上游滞止压力 $p_0$ 和 $M_{\\infty}$ 使用等熵关系获得。下游波后静压 $p_2$ 和温度 $T_2$ 通过理想气体的正激波关系式获得。\n\n量子谐振子的单位摩尔平衡振动能被定义为温度的函数，与 $\\theta_v$ 和 $R$ 相关。Landau–Teller 常微分方程需在均匀波后温度 $T_2$ 和恒定 $\\tau_v(T_2)$ 的条件下进行积分，以预测在指定时间的 $E_v(t)$。使用紧邻上游在 $T_1$ 时的平衡振动能作为初始条件 $E_v(0)=E_v^\\ast(T_1)$。为进行交叉验证，将预测的 $E_v(t)$ 与相同条件下给定的直接模拟蒙特卡洛（DSMC）基准值进行比较。\n\n您的程序必须为每个测试场景计算 Landau–Teller 预测与 DSMC 基准在指定时间点上的最大绝对相对偏差，即\n$$\n\\max_i \\left| \\frac{E_v^{\\mathrm{LT}}(t_i) - E_v^{\\mathrm{DSMC}}(t_i)}{E_v^{\\mathrm{DSMC}}(t_i)} \\right|,\n$$\n该值为无量纲的。程序必须输出一行，其中包含所有场景的最大偏差，形式为方括号内以逗号分隔的列表。不应打印任何其他文本。\n\n使用以下测试套件（所有压力单位为大气压，所有时间单位为秒，所有振动能单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$）：\n\n测试场景 1（正常路径，中等高超声速激波）：\n- 参数：$M_{\\infty} = 6.0$, $p_0 = 2.0$。\n- 时间点：$t = [10\\times 10^{-6}, 50\\times 10^{-6}, 100\\times 10^{-6}]$。\n- 在这些时间点上 $E_v(t)$ 的 DSMC 基准值：$[31.6, 153.3, 298.3]$。\n\n测试场景 2（边缘案例，高马赫数下极低的波后压力）：\n- 参数：$M_{\\infty} = 12.0$, $p_0 = 0.5$。\n- 时间点：$t = [20\\times 10^{-6}, 100\\times 10^{-6}, 500\\times 10^{-6}]$。\n- 在这些时间点上 $E_v(t)$ 的 DSMC 基准值：$[5.22, 26.11, 123.60]$。\n\n测试场景 3（边界案例，弱激波）：\n- 参数：$M_{\\infty} = 2.0$, $p_0 = 1.0$。\n- 时间点：$t = [10\\times 10^{-6}, 100\\times 10^{-6}, 10^{-3}]$。\n- 在这些时间点上 $E_v(t)$ 的 DSMC 基准值：$[1.37, 9.35, 33.18]$。\n\n需注意的实现细节：\n- 通过 $p_0$ 和 $M_{\\infty}$ 使用理想气体的等熵关系计算 $p_1$（单位为大气压）。\n- 通过 $M_{\\infty}$ 和 $p_1$ 使用理想气体正激波关系式（源于质量、动量和能量守恒）计算 $p_2$ 和 $T_2$。\n- 在代入 Millikan–White 关系式之前，将 $p_2$ 转换为大气压单位。\n- 使用适用于量子谐振子的 $E_v^\\ast(T)$（用 $\\theta_v$ 和 $R$ 表示），然后在恒定 $T_2$ 下求解 Landau–Teller 方程以获得 $E_v(t)$。\n- 报告每个场景的最大绝对相对偏差，形式为浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，形式为方括号内以逗号分隔的列表（例如，\"[result1,result2,result3]\"），其中每个结果是对应测试场景的最大绝对相对偏差。", "solution": "该问题要求对氮气（$N_2$）在一维正激波后的振动能弛豫过程进行建模。问题的核心是求解 Landau–Teller 振动弛豫方程，并将结果与直接模拟蒙特卡洛（DSMC）方法的基准数据进行比较。这涉及一个多步骤计算，结合了气体动力学、统计力学和化学动力学的原理。\n\n### 步骤 1：确定波后热力学状态\n\n首先，我们必须确定紧邻激波锋面下游的气体热力学条件。气体被视为热力学和量热学完美的理想气体，具有恒定的比热比 $\\gamma = 1.4$。上游状态由马赫数 $M_{\\infty}$、滞止压力 $p_0$ 和静温 $T_1 = 300\\,\\mathrm{K}$ 定义。\n\n上游静压 $p_1$ 由滞止压力 $p_0$ 和马赫数 $M_{\\infty}$ 通过理想气体的等熵关系确定：\n$$\n\\frac{p_0}{p_1} = \\left( 1 + \\frac{\\gamma - 1}{2} M_{\\infty}^2 \\right)^{\\frac{\\gamma}{\\gamma - 1}}\n$$\n求解 $p_1$ 即可得到进入激波的气体静压。\n\n接下来，我们应用 Rankine-Hugoniot 关系式求解正激波，以找到波后区域（用下标 $2$ 表示）的静压 $p_2$ 和静温 $T_2$。跨越激波的压力比和温度比是上游马赫数 $M_{\\infty}$ 和比热比 $\\gamma$ 的函数：\n$$\n\\frac{p_2}{p_1} = 1 + \\frac{2\\gamma}{\\gamma + 1} (M_{\\infty}^2 - 1)\n$$\n$$\n\\frac{T_2}{T_1} = \\frac{\\left(1 + \\frac{\\gamma-1}{2}M_{\\infty}^2\\right)\\left(\\frac{2\\gamma}{\\gamma-1}M_{\\infty}^2 - 1\\right)}{\\frac{(\\gamma+1)^2}{2(\\gamma-1)}M_{\\infty}^2}\n$$\n这些方程提供了驱动振动弛豫过程的恒定平动-转动温度 $T_2$ 和压力 $p_2$。\n\n### 步骤 2：振动能与弛豫建模\n\n双原子氮分子的振动能模态被建模为量子谐振子（QHO）。在给定温度 $T$ 下，平衡摩尔振动能 $E_v^\\ast$ 由统计力学的 Planck 公式给出：\n$$\nE_v^\\ast(T) = R \\frac{\\theta_v}{e^{\\theta_v/T} - 1}\n$$\n其中 $R$ 是普适气体常数，$\\theta_v$ 是氮气的特征振动温度（$\\theta_v = 3390\\,\\mathrm{K}$）。\n\n在激波之后，分子的平动和转动模态几乎瞬间热化到高温 $T_2$。然而，振动模态的调整则要慢得多。这个弛豫过程由 Landau–Teller 方程描述：\n$$\n\\frac{dE_v}{dt} = \\frac{E_v^\\ast(T) - E_v}{\\tau_v(T, p)}\n$$\n问题陈述要求假设波后温度 $T = T_2$ 和压力 $p = p_2$ 均匀。因此，平衡能量 $E_v^\\ast(T_2)$ 和振动弛豫时间 $\\tau_v(T_2, p_2)$ 都是常数。此常微分方程（ODE）的初始条件是振动能冻结在其上游平衡值，即 $E_v(t=0) = E_v^\\ast(T_1)$。\n\n振动弛豫时间 $\\tau_v$ 使用经验性的 Millikan–White 关系式计算。问题描述没有明确指出函数形式，这是一个模糊之处。根据常规做法和所提供的参数名称（$A$ 和 $B$），最合理的解释是：\n$$\n\\log_{10}(p \\tau_v) = A T^{-1/3} - B\n$$\n其中压力 $p$ 必须以大气压为单位，温度 $T$ 以开尔文为单位，得到的 $\\tau_v$ 单位为秒。对于氮气，给定的常数为 $A=1.75$ 和 $B=3.94$。我们将在此关系式中使用波后压力 $p_2$ 和温度 $T_2$。\n\nLandau–Teller 常微分方程是一个一阶线性常系数微分方程。其在初始条件 $E_v(0) = E_v^\\ast(T_1)$ 下的解为：\n$$\nE_v(t) = E_v^\\ast(T_2) + \\left(E_v^\\ast(T_1) - E_v^\\ast(T_2)\\right) e^{-t/\\tau_v}\n$$\n此方程提供了激波通过后任意时刻 $t$ 的预测振动能 $E_v^{\\mathrm{LT}}(t)$。\n\n### 步骤 3：与基准数据比较及最终度量\n\n最后一步是计算 Landau–Teller 模型预测与所提供的 DSMC 基准值之间的偏差。对于每个测试场景，我们将在每个指定的时间点 $t_i$ 计算绝对相对偏差：\n$$\n\\delta_i = \\left| \\frac{E_v^{\\mathrm{LT}}(t_i) - E_v^{\\mathrm{DSMC}}(t_i)}{E_v^{\\mathrm{DSMC}}(t_i)} \\right|\n$$\n每个场景要求的输出是这些偏差在所有时间点上的最大值：\n$$\n\\text{Deviation}_{\\max} = \\max_{i} (\\delta_i)\n$$\n\n每个测试用例的计算流程如下：\n1.  给定 $M_{\\infty}$ 和 $p_0$（单位：atm），将 $p_0$ 转换为帕斯卡。\n2.  使用等熵关系计算 $p_1$（Pa）。\n3.  使用正激波关系式计算 $p_2$（Pa）和 $T_2$（K）。\n4.  将 $p_2$ 从帕斯卡转换为大气压，以便在 Millikan–White 关系式中使用。\n5.  使用波后状态 $(T_2, p_{2,\\text{atm}})$ 计算振动弛豫时间 $\\tau_v$。\n6.  分别计算上游和波后的平衡振动能 $E_v^\\ast(T_1)$ 和 $E_v^\\ast(T_2)$。\n7.  使用 $E_v(t)$ 的解析解，在给定的时间点计算 Landau-Teller 预测值 $E_v^{\\mathrm{LT}}(t_i)$。\n8.  计算 $E_v^{\\mathrm{LT}}(t_i)$ 与所提供的 $E_v^{\\mathrm{DSMC}}(t_i)$ 值之间的最大绝对相对偏差。\n对所有三个测试场景重复此过程。在某些场景中观察到的较大偏差凸显了这种简化模型（例如，恒定的波后温度，经验性的弛豫时间关系式）与像 DSMC 这样的高保真方法相比的局限性，尤其是在极端条件下。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational relaxation problem for nitrogen behind a normal shock\n    for three specified test scenarios and calculates the maximum deviation from\n    DSMC benchmarks.\n    \"\"\"\n\n    # Define physical and model constants\n    GAMMA = 1.4  # Ratio of specific heats for N2\n    T1_K = 300.0  # Upstream static temperature in Kelvin\n    R_GAS = 8.314462618  # Universal gas constant in J/(mol*K)\n    THETA_V_K = 3390.0  # Characteristic vibrational temperature for N2 in Kelvin\n    P_ATM_TO_PA = 101325.0  # Conversion factor from atmospheres to Pascals\n\n    # Millikan-White correlation parameters for N2\n    MW_A = 1.75\n    MW_B = 3.94\n\n    def calculate_max_deviation(m_inf, p0_atm, times_s, ev_dsmc):\n        \"\"\"\n        Calculates the maximum absolute relative deviation between the Landau-Teller\n        model and DSMC data for a single test scenario.\n\n        Args:\n            m_inf (float): Upstream Mach number.\n            p0_atm (float): Upstream stagnation pressure in atmospheres.\n            times_s (list[float]): List of time points in seconds.\n            ev_dsmc (list[float]): List of DSMC benchmark vibrational energies in J/mol.\n\n        Returns:\n            float: The maximum absolute relative deviation.\n        \"\"\"\n        # Convert stagnation pressure to SI units (Pascals)\n        p0_pa = p0_atm * P_ATM_TO_PA\n\n        # Step 1: Calculate upstream static pressure (p1) using the isentropic relation.\n        p1_pa = p0_pa / (1 + (GAMMA - 1) / 2 * m_inf**2)**(GAMMA / (GAMMA - 1))\n\n        # Step 2: Calculate post-shock pressure (p2) and temperature (T2)\n        # using normal shock relations for a perfect gas.\n        m_inf_sq = m_inf**2\n        \n        # Pressure ratio\n        p2_over_p1 = 1 + 2 * GAMMA / (GAMMA + 1) * (m_inf_sq - 1)\n        p2_pa = p1_pa * p2_over_p1\n\n        # Temperature ratio\n        t2_over_t1_num = (1 + (GAMMA - 1) / 2 * m_inf_sq) * (2 * GAMMA / (GAMMA - 1) * m_inf_sq - 1)\n        t2_over_t1_den = ((GAMMA + 1)**2 / (2 * (GAMMA - 1))) * m_inf_sq\n        t2_k = T1_K * t2_over_t1_num / t2_over_t1_den\n\n        # Step 3: Calculate equilibrium vibrational energy (Ev*) for a quantum harmonic oscillator.\n        def ev_star(T):\n            if T == 0: return 0.0\n            # To prevent overflow in exp for very small T\n            exp_arg = THETA_V_K / T\n            if exp_arg > 100: return 0.0\n            return R_GAS * THETA_V_K / (np.exp(exp_arg) - 1)\n\n        ev_star_t1 = ev_star(T1_K)\n        ev_star_t2 = ev_star(t2_k)\n\n        # Step 4: Calculate the vibrational relaxation time (tau_v) using Millikan-White correlation.\n        p2_atm = p2_pa / P_ATM_TO_PA\n        # Assumed form: log10(p*tau_v) = A * T^(-1/3) - B\n        log10_ptau = MW_A * t2_k**(-1/3) - MW_B\n        ptau = 10**log10_ptau\n        tau_v_s = ptau / p2_atm\n\n        # Step 5: Solve the Landau-Teller equation to find Ev(t).\n        # Ev(t) = Ev*(T2) + (Ev*(T1) - Ev*(T2)) * exp(-t/tau_v)\n        times_s = np.array(times_s)\n        ev_lt = ev_star_t2 + (ev_star_t1 - ev_star_t2) * np.exp(-times_s / tau_v_s)\n\n        # Step 6: Calculate maximum absolute relative deviation between LT and DSMC.\n        ev_dsmc = np.array(ev_dsmc)\n        relative_deviations = np.abs((ev_lt - ev_dsmc) / ev_dsmc)\n        max_relative_deviation = np.max(relative_deviations)\n\n        return max_relative_deviation\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (M_inf, p0_atm, times_s, ev_dsmc)\n        (6.0, 2.0, [10e-6, 50e-6, 100e-6], [31.6, 153.3, 298.3]),\n        (12.0, 0.5, [20e-6, 100e-6, 500e-6], [5.22, 26.11, 123.60]),\n        (2.0, 1.0, [10e-6, 100e-6, 1e-3], [1.37, 9.35, 33.18]),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_inf, p0_atm, times, ev_dsmc_data = case\n        result = calculate_max_deviation(m_inf, p0_atm, times, ev_dsmc_data)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3332484"}, {"introduction": "除了热力学非平衡，高温气体还会发生离解和复合等化学反应，即化学非平衡。本练习聚焦于一个简化的五组分空气模型，要求学生计算在给定双温度（$T$和$T_v$）条件下的化学反应源项，并分析系统的刚性 [@problem_id:3332419]。通过构建化学反应速率的雅可比矩阵并求解其特征值，学生可以定量地理解化学反应动力学中的刚性问题，这对于后续选择和设计高效稳定的数值积分方案至关重要。", "problem": "给定一个均匀的零维气体单元，其中包含一个五组分空气混合物，组分集为 $\\{N_2, O_2, NO, N, O\\}$。该混合物使用双温非平衡框架进行建模，该框架具有一个平动-转动温度 $T$ 和一个振动-电子温度 $T_v$。假设气体遵循理想气体定律。反应速率遵循质量作用动力学，并具有 Arrhenius 型的温度依赖性。您的任务是计算每个组分 $s$ 的稳态摩尔生成速率 $\\dot{\\omega}_s$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$），并通过雅可比矩阵 $\\partial \\dot{\\omega}/\\partial \\mathbf{X}$ 的特征值来评估刚度，其中 $\\mathbf{X}$ 是组分摩尔分数的向量。您必须为每个测试用例报告一个单一的刚度度量，其定义为 $\\partial \\dot{\\omega}/\\partial \\mathbf{C}$ 特征值实部中的最大绝对值（单位为 $\\mathrm{s}^{-1}$），其中 $\\mathbf{C}$ 是摩尔浓度的向量。所有计算出的生成速率必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$ 为单位表示，刚度度量必须以 $\\mathrm{s}^{-1}$ 为单位表示。将每个报告的数字四舍五入到六位有效数字。\n\n基本原理和定义：\n- 设通用气体常数为 $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$。\n- 对于压力为 $p$、平动-转动温度为 $T$ 的均匀单元，摩尔分数为 $X_i$ 的组分 $i$ 的摩尔浓度为 $C_i = \\dfrac{p}{R_u T} X_i$。记 $\\alpha = \\dfrac{p}{R_u T}$，因此 $C_i = \\alpha X_i$。\n- 对于每个基元反应 $r$，标量反应速率（每单位体积）$\\dot{q}_r$ 遵循质量作用动力学，即它是一个温度依赖性速率系数与反应物摩尔浓度的适当次幂的乘积。组分摩尔生成速率为 $\\dot{\\omega}_s = \\sum_r \\nu_{s,r} \\dot{q}_r$，其中 $\\nu_{s,r}$ 是反应 $r$ 中组分 $s$ 的化学计量变化系数，定义为产物减去反应物。\n\n机理：\n考虑以下在五个组分上进行的五步反应机理，使用双温非平衡公式，其中单分子解离取决于 $T_v$，双分子交换取决于 $T$：\n- 反应 $\\#1$：$N_2 + O \\rightarrow NO + N$。速率系数 $k_1(T) = A_1 T^{n_1} \\exp\\!\\left(-\\dfrac{E_{a1}}{R_u T}\\right)$，其中 $A_1 = 5.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$，$n_1=0$，$E_{a1}=1.0\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 反应 $\\#2$：$O_2 + N \\rightarrow NO + O$。速率系数 $k_2(T) = A_2 T^{n_2} \\exp\\!\\left(-\\dfrac{E_{a2}}{R_u T}\\right)$，其中 $A_2 = 5.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$，$n_2=0$，$E_{a2}=1.2\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 反应 $\\#3$：$NO + O \\rightarrow O_2 + N$。速率系数 $k_3(T) = A_3 T^{n_3} \\exp\\!\\left(-\\dfrac{E_{a3}}{R_u T}\\right)$，其中 $A_3 = 1.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$，$n_3=0$，$E_{a3}=8.0\\times 10^4\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 反应 $\\#4$：$N_2 \\rightarrow N + N$。双温解离，$k_4(T_v) = A_4 T_v^{n_4} \\exp\\!\\left(-\\dfrac{E_{a4}}{R_u T_v}\\right)$，其中 $A_4 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$n_4=0$，$E_{a4}=9.42\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n- 反应 $\\#5$：$O_2 \\rightarrow O + O$。双温解离，$k_5(T_v) = A_5 T_v^{n_5} \\exp\\!\\left(-\\dfrac{E_{a5}}{R_u T_v}\\right)$，其中 $A_5 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，$n_5=0$，$E_{a5}=4.94\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n反应速率的质量作用形式：\n- $\\dot{q}_1 = k_1(T)\\,C_{N_2}\\,C_O$。\n- $\\dot{q}_2 = k_2(T)\\,C_{O_2}\\,C_N$。\n- $\\dot{q}_3 = k_3(T)\\,C_{NO}\\,C_O$。\n- $\\dot{q}_4 = k_4(T_v)\\,C_{N_2}$。\n- $\\dot{q}_5 = k_5(T_v)\\,C_{O_2}$。\n\n组分排序为 $\\{N_2, O_2, NO, N, O\\}$ 的化学计量变化系数 $\\nu_{s,r}$：\n- 反应 $\\#1$：$\\nu_{\\cdot,1} = [-1,\\,0,\\, +1,\\, +1,\\, -1]$。\n- 反应 $\\#2$：$\\nu_{\\cdot,2} = [\\,0,\\, -1,\\, +1,\\, -1,\\, +1]$。\n- 反应 $\\#3$：$\\nu_{\\cdot,3} = [\\,0,\\, +1,\\, -1,\\, +1,\\, -1]$。\n- 反应 $\\#4$：$\\nu_{\\cdot,4} = [-1,\\, 0,\\, 0,\\, +2,\\, 0]$。\n- 反应 $\\#5$：$\\nu_{\\cdot,5} = [\\,0,\\, -1,\\, 0,\\, 0,\\, +2]$。\n\n雅可比矩阵定义和刚度评估：\n- 设 $\\mathbf{X} = [X_{N_2}, X_{O_2}, X_{NO}, X_N, X_O]^T$。关于摩尔分数的雅可比矩阵为 $J_X = \\dfrac{\\partial \\dot{\\omega}}{\\partial \\mathbf{X}}$，其中每个元素为 $[J_X]_{s,j} = \\sum_{r} \\nu_{s,r} \\dfrac{\\partial \\dot{q}_r}{\\partial X_j}$。\n- 使用 $C_i=\\alpha X_i$ 和上述质量作用形式，非零偏导数为：\n  - 对于 $\\dot{q}_1$：$\\dfrac{\\partial \\dot{q}_1}{\\partial X_{N_2}} = k_1(T)\\,\\alpha\\,C_O$，$\\dfrac{\\partial \\dot{q}_1}{\\partial X_O} = k_1(T)\\,\\alpha\\,C_{N_2}$。\n  - 对于 $\\dot{q}_2$：$\\dfrac{\\partial \\dot{q}_2}{\\partial X_{O_2}} = k_2(T)\\,\\alpha\\,C_N$，$\\dfrac{\\partial \\dot{q}_2}{\\partial X_N} = k_2(T)\\,\\alpha\\,C_{O_2}$。\n  - 对于 $\\dot{q}_3$：$\\dfrac{\\partial \\dot{q}_3}{\\partial X_{NO}} = k_3(T)\\,\\alpha\\,C_O$，$\\dfrac{\\partial \\dot{q}_3}{\\partial X_O} = k_3(T)\\,\\alpha\\,C_{NO}$。\n  - 对于 $\\dot{q}_4$：$\\dfrac{\\partial \\dot{q}_4}{\\partial X_{N_2}} = k_4(T_v)\\,\\alpha$。\n  - 对于 $\\dot{q}_5$：$\\dfrac{\\partial \\dot{q}_5}{\\partial X_{O_2}} = k_5(T_v)\\,\\alpha$。\n- 为了以具有物理意义的时间尺度单位评估刚度，计算 $J_C = \\dfrac{\\partial \\dot{\\omega}}{\\partial \\mathbf{C}} = \\dfrac{1}{\\alpha} J_X$，其特征值的单位为 $\\mathrm{s}^{-1}$。将刚度度量 $S$ 定义为 $S = \\max\\limits_i \\left| \\Re\\left(\\lambda_i(J_C)\\right) \\right|$，单位为 $\\mathrm{s}^{-1}$。\n\n测试套件：\n为以下3个测试用例计算 $\\dot{\\omega}_s$ 和刚度度量 $S$。所有摩尔分数必须按给定值使用，不要重新归一化。\n\n- 用例 $\\#1$（一般高超声速非平衡）：$p = 5000\\,\\mathrm{Pa}$，$T = 6000\\,\\mathrm{K}$，$T_v = 9000\\,\\mathrm{K}$，$\\mathbf{X} = [0.70,\\, 0.20,\\, 0.05,\\, 0.03,\\, 0.02]$。\n- 用例 $\\#2$（高温、高解离）：$p = 1000\\,\\mathrm{Pa}$，$T = 10000\\,\\mathrm{K}$，$T_v = 10000\\,\\mathrm{K}$，$\\mathbf{X} = [0.10,\\, 0.05,\\, 0.10,\\, 0.40,\\, 0.35]$。\n- 用例 $\\#3$（强非平衡振动激发，含痕量原子）：$p = 5000\\,\\mathrm{Pa}$，$T = 3000\\,\\mathrm{K}$，$T_v = 12000\\,\\mathrm{K}$，$\\mathbf{X} = [0.79,\\, 0.199998,\\, 0.010002,\\, 10^{-6},\\, 10^{-6}]$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个包含六个值的嵌套逗号分隔列表 $[\\dot{\\omega}_{N_2}, \\dot{\\omega}_{O_2}, \\dot{\\omega}_{NO}, \\dot{\\omega}_N, \\dot{\\omega}_O, S]$。每个数字必须四舍五入到六位有效数字。例如，输出应类似于 $[[a_1,b_1,c_1,d_1,e_1,f_1],[a_2,b_2,c_2,d_2,e_2,f_2],[a_3,b_3,c_3,d_3,e_3,f_3]]$，其中 $a_i$ 到 $f_i$ 是用例 $i$ 的计算值。", "solution": "所提出的问题要求计算高超声速非平衡条件下五组分空气混合物的组分摩尔生成速率和化学刚度度量。该问题在科学上是适定的，并提供了一套完整的物理定律、动力学数据和初始条件，以获得唯一解。我们将通过系统地实施所提供的模型来着手解决。\n\n这个问题的基础在于化学动力学，其中组分摩尔浓度向量 $\\mathbf{C}$ 的时间演化由一个常微分方程组描述：\n$$ \\frac{d\\mathbf{C}}{dt} = \\dot{\\mathbf{\\omega}}(\\mathbf{C}, T, T_v) $$\n在这里，$\\dot{\\mathbf{\\omega}}$ 表示每个组分的净摩尔生成速率向量。我们的任务是计算 $\\dot{\\mathbf{\\omega}}$ 的瞬时值，并通过 $\\dot{\\mathbf{\\omega}}$ 相对于 $\\mathbf{C}$ 的雅可比矩阵来表征系统的刚度。\n\n组分向量排序为 $\\mathbf{C} = [C_{N_2}, C_{O_2}, C_{NO}, C_N, C_O]^T$。\n\n步骤1：计算摩尔浓度\n\n问题陈述，气体混合物遵循理想气体定律。给定压力 $p$、平动-转动温度 $T$ 和摩尔分数向量 $\\mathbf{X} = [X_{N_2}, X_{O_2}, X_{NO}, X_N, X_O]^T$，组分 $s$ 的摩尔浓度由下式给出：\n$$ C_s = X_s \\frac{p}{R_u T} $$\n其中 $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$ 是通用气体常数。我们定义项 $\\alpha = \\frac{p}{R_u T}$ 以将表达式简化为 $C_s = \\alpha X_s$。对于每个测试用例，此转换将是第一个计算步骤。\n\n步骤2：计算反应速率系数\n\n反应速率取决于温度依赖的速率系数 $k_r$，该系数遵循 Arrhenius 型定律。对于依赖于平动-转动温度 $T$ 的反应，其形式为：\n$$ k_r(T) = A_r T^{n_r} \\exp\\left(-\\frac{E_{ar}}{R_u T}\\right) \\quad \\text{for } r \\in \\{1, 2, 3\\} $$\n对于依赖于振动-电子温度 $T_v$ 的双温解离反应，其形式为：\n$$ k_r(T_v) = A_r T_v^{n_r} \\exp\\left(-\\frac{E_{ar}}{R_u T_v}\\right) \\quad \\text{for } r \\in \\{4, 5\\} $$\n为五个反应中的每一个都提供了参数 $A_r$、$n_r$ 和 $E_{ar}$。由于所有 $n_r=0$，表达式简化为标准的 Arrhenius 形式。\n\n步骤3：计算标量反应速率\n\n每个反应的标量进展速率 $\\dot{q}_r$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$）由质量作用定律确定。问题为每个反应提供了具体形式：\n\\begin{align*}\n\\dot{q}_1 = k_1(T)\\,C_{N_2}\\,C_O \\\\\n\\dot{q}_2 = k_2(T)\\,C_{O_2}\\,C_N \\\\\n\\dot{q}_3 = k_3(T)\\,C_{NO}\\,C_O \\\\\n\\dot{q}_4 = k_4(T_v)\\,C_{N_2} \\\\\n\\dot{q}_5 = k_5(T_v)\\,C_{O_2}\n\\end{align*}\n\n步骤4：计算组分摩尔生成速率\n\n每个组分 $s$ 的净摩尔生成速率 $\\dot{\\omega}_s$ 是其在所有反应中生成和消耗的总和。这由下式给出：\n$$ \\dot{\\omega}_s = \\sum_{r=1}^{5} \\nu_{s,r} \\dot{q}_r $$\n其中 $\\nu_{s,r}$ 是反应 $r$ 中组分 $s$ 的化学计量系数（产物为正，反应物为负）。化学计量矩阵 $\\nu$ 已提供，其中行对应于组分（$N_2, O_2, NO, N, O$），列对应于反应（$1$ 到 $5$）：\n$$ \\nu = \\begin{pmatrix}\n-1  & 0  & 0  & -1 & 0 \\\\\n0  & -1 & 1  & 0  & -1 \\\\\n1  & 1  & -1 & 0  & 0 \\\\\n1  & -1 & 1  & 2  & 0 \\\\\n-1 & 1  & -1 & 0  & 2\n\\end{pmatrix} $$\n生成速率向量 $\\dot{\\mathbf{\\omega}}$ 可以简洁地计算为矩阵-向量乘积 $\\dot{\\mathbf{\\omega}} = \\nu \\dot{\\mathbf{q}}$，其中 $\\dot{\\mathbf{q}} = [\\dot{q}_1, \\dot{q}_2, \\dot{q}_3, \\dot{q}_4, \\dot{q}_5]^T$。\n\n步骤5：雅可比矩阵计算和刚度评估\n\n当控制动力学的系统存在巨大差异的时间尺度时，常微分方程组中就会出现刚度问题。在化学动力学中，这对应于某些反应比其他反应进行得快得多。刚度在数学上由速率向量的雅可比矩阵的特征值来表征。问题要求计算关于摩尔浓度的雅可比矩阵 $J_C$，其元素为：\n$$ [J_C]_{s,j} = \\frac{\\partial \\dot{\\omega}_s}{\\partial C_j} $$\n使用 $\\dot{\\omega}_s$ 的定义，我们有：\n$$ [J_C]_{s,j} = \\frac{\\partial}{\\partial C_j} \\left( \\sum_{r=1}^{5} \\nu_{s,r} \\dot{q}_r \\right) = \\sum_{r=1}^{5} \\nu_{s,r} \\frac{\\partial \\dot{q}_r}{\\partial C_j} $$\n标量反应速率 $\\dot{q}_r$ 相对于浓度 $C_j$ 的偏导数从其质量作用形式推导得出：\n\\begin{itemize}\n    \\item $\\dfrac{\\partial \\dot{q}_1}{\\partial C_{N_2}} = k_1 C_O$, $\\dfrac{\\partial \\dot{q}_1}{\\partial C_O} = k_1 C_{N_2}$\n    \\item $\\dfrac{\\partial \\dot{q}_2}{\\partial C_{O_2}} = k_2 C_N$, $\\dfrac{\\partial \\dot{q}_2}{\\partial C_N} = k_2 C_{O_2}$\n    \\item $\\dfrac{\\partial \\dot{q}_3}{\\partial C_{NO}} = k_3 C_O$, $\\dfrac{\\partial \\dot{q}_3}{\\partial C_O} = k_3 C_{NO}$\n    \\item $\\dfrac{\\partial \\dot{q}_4}{\\partial C_{N_2}} = k_4$\n    \\item $\\dfrac{\\partial \\dot{q}_5}{\\partial C_{O_2}} = k_5$\n\\end{itemize}\n所有其他偏导数均为零。这些项被组装成 $5 \\times 5$ 的雅可比矩阵 $J_C$。\n\n$J_C$ 的特征值 $\\lambda_i$ 的单位是时间的倒数（$\\mathrm{s}^{-1}$），其实部对应于当前状态周围扰动的指数衰减或增长率。大的负实部表示快速衰减的模式，这是刚度的来源。刚度度量 $S$ 定义为这些特征值实部的最大绝对值：\n$$ S = \\max_{i} |\\Re(\\lambda_i)| $$\n该值代表了系统中倒数的最快化学时间尺度。\n\n以下代码为三个指定的测试用例分别实现了这些计算，报告了五个组分的生成速率和刚度度量 $S$，每个值都四舍五入到六位有效数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes steady molar production rates and a stiffness measure for a\n    five-species nonequilibrium air mixture.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R_u = 8.314462618\n\n    # Reaction parameters: [A (m^3/mol/s or 1/s), n, E_a (J/mol)]\n    reaction_params = {\n        1: {'A': 5.0e7, 'n': 0.0, 'Ea': 1.0e5, 'temp_type': 'T'},\n        2: {'A': 5.0e7, 'n': 0.0, 'Ea': 1.2e5, 'temp_type': 'T'},\n        3: {'A': 1.0e7, 'n': 0.0, 'Ea': 8.0e4, 'temp_type': 'T'},\n        4: {'A': 1.0e13, 'n': 0.0, 'Ea': 9.42e5, 'temp_type': 'Tv'},\n        5: {'A': 1.0e13, 'n': 0.0, 'Ea': 4.94e5, 'temp_type': 'Tv'}\n    }\n\n    # Stoichiometric matrix (nu_sr): rows=species, cols=reactions\n    # Species order: N2, O2, NO, N, O\n    nu = np.array([\n        [-1,  0,  0, -1,  0],  # N2\n        [ 0, -1,  1,  0, -1],  # O2\n        [ 1,  1, -1,  0,  0],  # NO\n        [ 1, -1,  1,  2,  0],  # N\n        [-1,  1, -1,  0,  2]   # O\n    ])\n\n    # Test cases: [p (Pa), T (K), T_v (K), X (mole fractions)]\n    test_cases = [\n        (5000.0, 6000.0, 9000.0, np.array([0.70, 0.20, 0.05, 0.03, 0.02])),\n        (1000.0, 10000.0, 10000.0, np.array([0.10, 0.05, 0.10, 0.40, 0.35])),\n        (5000.0, 3000.0, 12000.0, np.array([0.79, 0.199998, 0.010002, 1e-6, 1e-6]))\n    ]\n    \n    # Species indices map\n    s_map = {'N2': 0, 'O2': 1, 'NO': 2, 'N': 3, 'O': 4}\n\n    results = []\n    for case in test_cases:\n        p, T, Tv, X = case\n\n        # Step 1: Molar Concentrations\n        alpha = p / (R_u * T)\n        C = alpha * X\n        C_N2, C_O2, C_NO, C_N, C_O = C\n\n        # Step 2: Rate Coefficients\n        k = {}\n        temps = {'T': T, 'Tv': Tv}\n        for r_idx, params in reaction_params.items():\n            temp_key = params['temp_type']\n            temp = temps[temp_key]\n            k[r_idx] = params['A'] * (temp**params['n']) * np.exp(-params['Ea'] / (R_u * temp))\n\n        # Step 3: Scalar Reaction Rates\n        q_dot = np.zeros(5)\n        q_dot[0] = k[1] * C_N2 * C_O      # q1\n        q_dot[1] = k[2] * C_O2 * C_N      # q2\n        q_dot[2] = k[3] * C_NO * C_O      # q3\n        q_dot[3] = k[4] * C_N2            # q4\n        q_dot[4] = k[5] * C_O2            # q5\n\n        # Step 4: Species Molar Production Rates\n        omega_dot = nu @ q_dot\n\n        # Step 5: Jacobian Matrix J_C\n        J_C = np.zeros((5, 5))\n\n        # Column 0: d/dC_N2\n        J_C[:, s_map['N2']] = nu[:, 0] * (k[1] * C_O) + nu[:, 3] * k[4]\n        \n        # Column 1: d/dC_O2\n        J_C[:, s_map['O2']] = nu[:, 1] * (k[2] * C_N) + nu[:, 4] * k[5]\n\n        # Column 2: d/dC_NO\n        J_C[:, s_map['NO']] = nu[:, 2] * (k[3] * C_O)\n\n        # Column 3: d/dC_N\n        J_C[:, s_map['N']] = nu[:, 1] * (k[2] * C_O2)\n\n        # Column 4: d/dC_O\n        J_C[:, s_map['O']] = nu[:, 0] * (k[1] * C_N2) + nu[:, 2] * (k[3] * C_NO)\n\n        # Step 6: Stiffness Measure\n        eigenvalues = np.linalg.eigvals(J_C)\n        stiffness_measure = np.max(np.abs(np.real(eigenvalues)))\n        \n        # Collect results for this case\n        case_results = list(omega_dot)\n        case_results.append(stiffness_measure)\n        results.append(case_results)\n\n    # Format the final output string with 6 significant figures per number\n    # using the 'g' format specifier.\n    output_str = f\"[{','.join(f'[{\",\".join(f\"{val:.6g}\" for val in row)}]' for row in results)}]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "3332419"}, {"introduction": "在真实的飞行器绕流问题中，热力学和化学非平衡过程是紧密耦合且高度刚性的，这给数值模拟带来了巨大挑战。本练习将前两个实践中的概念相结合，要求学生为一个包含振动弛豫和离解反应的耦合系统，实现一个全隐式的向后欧拉时间积分格式 [@problem_id:3332459]。通过使用牛顿法求解非线性方程组，学生将亲身体验解决刚性问题的核心数值策略，并学习如何评估数值解的物理守恒性和正定性。", "problem": "考虑一个单一、空间均匀的计算单元，该单元代表了高超声速非平衡氮气流中的激波后区域，其中会发生离解和振动弛豫。该混合物包含两种化学组分：氮分子 $N_2$ 和氮原子 $N$。单位体积的摩尔浓度用 $n_{N_2}$ 和 $n_N$ 表示（单位：$\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。平动-转动温度为 $T$， $N_2$ 的振动温度为 $T_v$ （单位：$\\mathrm{K}$）。在时间步长内，该系统被建模为绝热和等容系统。\n\n以下基本原理和本构关系被用作建模基础：\n\n- 数密度的理想气体定律：$n_{\\mathrm{tot}} = n_{N_2} + n_N$ 且 $p = n_{\\mathrm{tot}} R T$，其中 $p$ 是压强（单位：$\\mathrm{Pa}$），$R$ 是普适气体常数（单位：$\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$）。\n- 反应机理：$N_2 \\leftrightharpoons 2N$。根据质量作用定律，以摩尔浓度形式表示的净反应速率（正向减去逆向）为\n$$\n\\mathcal{R}(T,T_v,n_{N_2},n_N) = k_f(T,T_v)\\, n_{N_2} - k_b(T)\\, n_N^2,\n$$\n其中 $k_f$ 和 $k_b$ 是速率系数，其单位的选择使得 $\\mathcal{R}$ 的单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$。正向速率由一个 Arrhenius 形式给出，并由一个 Treanor 型振动非平衡因子进行调制，\n$$\nk_f(T,T_v) = A_f \\exp\\!\\left(-\\frac{E_a}{R T}\\right)\\,\\exp\\!\\left(\\Theta_v\\left(\\frac{1}{T}-\\frac{1}{T_v}\\right)\\right),\n$$\n其中 $A_f$ 是指前因子（单位：$\\mathrm{s}^{-1}$），$E_a$ 是活化能（单位：$\\mathrm{J}\\,\\mathrm{mol}^{-1}$），$\\Theta_v$ 是 $N_2$ 的特征振动温度（单位：$\\mathrm{K}$）。当 $T_v=T$ 时，逆向速率通过平衡常数在温度 $T$ 下强制实现化学详细平衡，\n$$\nk_b(T) = \\frac{A_f \\exp\\!\\left(-\\frac{E_a}{R T}\\right)}{K_{\\mathrm{eq}}(T)}, \\qquad K_{\\mathrm{eq}}(T) = K_{\\mathrm{pref}}\\, T^{3/2} \\exp\\!\\left(-\\frac{D}{R T}\\right),\n$$\n其中 $K_{\\mathrm{pref}}$ 是一个常数，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-3/2}$，$D$ 是 $N_2$ 的摩尔离解能（单位：$\\mathrm{J}\\,\\mathrm{mol}^{-1}$）。\n\n- Landau–Teller (LT) 振动弛豫模型：振动温度根据以下公式向平动-转动温度弛豫\n$$\n\\frac{d T_v}{d t} = \\frac{T - T_v}{\\tau_v},\n$$\n其中 $\\tau_v$ 是振动弛豫时间（单位：$\\mathrm{s}$）。对于本问题，$\\tau_v$ 被视为一个常数参数。\n- 根据化学计量导出的组分生成速率：\n$$\n\\frac{d n_{N_2}}{d t} = -\\mathcal{R}, \\qquad \\frac{d n_N}{d t} = 2\\,\\mathcal{R}.\n$$\n在连续时间模型中，这些关系意味着单位体积的氮原子总数 $N_{\\mathrm{atoms}} = n_N + 2 n_{N_2}$ 是守恒的。\n- 单元内的绝热总能量守恒：单位体积的总内能 $U$ 是平动-转动显能、$N_2$ 的振动能和化学键能之和，\n$$\nU(n_{N_2},n_N,T_v,T) = n_N \\left(\\frac{3}{2} R T\\right) + n_{N_2} \\left(\\frac{5}{2} R T\\right) + n_{N_2}\\, e_{\\mathrm{vib}}(T_v) - n_{N_2}\\, D,\n$$\n其中每摩尔 $N_2$ 的振动能由量子谐振子表达式建模\n$$\ne_{\\mathrm{vib}}(T_v) = \\frac{R \\Theta_v}{\\exp(\\Theta_v/T_v) - 1}.\n$$\n在绝热和等容条件下，在一个时间步长内，总能量 $U$ 必须保持不变。\n\n您的任务是使用后向欧拉法，对由 $n_{N_2}$、$n_N$、$T_v$ 和 $T$ 组成的刚性常微分方程组，执行一个大小为 $\\Delta t$（单位：$\\mathrm{s}$）的隐式时间步。具体来说，给定在时间 $t^n$ 的状态，表示为 $(n_{N_2}^n, n_N^n, T_v^n, T^n)$，计算在时间 $t^{n+1} = t^n + \\Delta t$ 的状态 $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$，使其满足以下非线性系统\n$$\nn_{N_2}^{n+1} = n_{N_2}^{n} - \\Delta t\\, \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1}),\n$$\n$$\nn_N^{n+1} = n_{N}^{n} + 2 \\Delta t\\, \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1}),\n$$\n$$\nT_v^{n+1} = T_v^{n} + \\Delta t\\, \\frac{T^{n+1} - T_v^{n+1}}{\\tau_v},\n$$\n$$\nU(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1}) = U(n_{N_2}^{n},n_{N}^{n},T_v^{n},T^{n}).\n$$\n使用牛顿类方法求解该非线性系统以获得 $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$。在计算出 $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$ 后，评估：\n- 正性：$n_{N_2}^{n+1} \\ge 0$，$n_{N}^{n+1} \\ge 0$，$T_v^{n+1} > 0$，$T^{n+1} > 0$。\n- 原子守恒：$n_{N}^{n+1} + 2 n_{N_2}^{n+1}$ 与 $n_{N}^{n} + 2 n_{N_2}^{n}$ 在指定的相对容差范围内相等。\n- 能量守恒：$U(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1})$ 与 $U(n_{N_2}^{n},n_{N}^{n},T_v^{n},T^{n})$ 在指定的相对容差范围内相等。\n\n在程序中使用以下常数和单位：\n- $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $\\Theta_v = 3390\\,\\mathrm{K}$，\n- $D = 9.76 \\times 96{,}485.33212\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，\n- $A_f = 10^5\\,\\mathrm{s}^{-1}$，\n- $E_a = 2.0 \\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$，\n- $K_{\\mathrm{pref}} = 10^3\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-3/2}$，\n- $\\tau_v = 2.0 \\times 10^{-6}\\,\\mathrm{s}$。\n\n对以下初始状态和时间步的测试套件实施隐式步和评估。在每种情况下，初始摩尔浓度 $(n_{N_2}^n,n_N^n)$ 之和应为 $p/(R T^n)$，以与理想气体定律保持一致：\n1. 情况 A (理想情况)：$p = 5.0 \\times 10^4\\,\\mathrm{Pa}$，$T^n = 8000\\,\\mathrm{K}$，$T_v^n = 5000\\,\\mathrm{K}$，$n_{N_2}^n = 0.50\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$n_N^n = 0.25\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$\\Delta t = 5.0 \\times 10^{-7}\\,\\mathrm{s}$。\n2. 情况 B (边界情况：全原子初始状态)：$p = 2.0 \\times 10^4\\,\\mathrm{Pa}$，$T^n = 9000\\,\\mathrm{K}$，$T_v^n = 9000\\,\\mathrm{K}$，$n_{N_2}^n = 0.00\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$n_N^n = \\dfrac{p}{R T^n}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$\\Delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$。\n3. 情况 C (边缘情况：极小时间步)：$p = 1.01325 \\times 10^5\\,\\mathrm{Pa}$，$T^n = 6000\\,\\mathrm{K}$，$T_v^n = 4000\\,\\mathrm{K}$，$n_{N_2}^n = 1.80\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$n_N^n = 0.23\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$\\Delta t = 1.0 \\times 10^{-9}\\,\\mathrm{s}$。\n4. 情况 D (边缘情况：推动刚性动力学的极大时间步)：$p = 8.0 \\times 10^4\\,\\mathrm{Pa}$，$T^n = 10000\\,\\mathrm{K}$，$T_v^n = 3000\\,\\mathrm{K}$，$n_{N_2}^n = 0.70\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$n_N^n = 0.26\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$，$\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$。\n\n评估容差：\n- 原子守恒容差：相对差异小于 $10^{-10}$，\n- 能量守恒容差：相对差异小于 $10^{-8}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个包含三个布尔值 $[b_{\\mathrm{pos}}, b_{\\mathrm{atoms}}, b_{\\mathrm{energy}}]$ 的列表。例如，对于四个用例，输出必须是 $[[b_{1,\\mathrm{pos}},b_{1,\\mathrm{atoms}},b_{1,\\mathrm{energy}}],[b_{2,\\mathrm{pos}},b_{2,\\mathrm{atoms}},b_{2,\\mathrm{energy}}],[b_{3,\\mathrm{pos}},b_{3,\\mathrm{atoms}},b_{3,\\mathrm{energy}}],[b_{4,\\mathrm{pos}},b_{4,\\mathrm{atoms}},b_{4,\\mathrm{energy}}]]$ 的形式，并使用布尔字面量。", "solution": "用户提供了一个有科学依据、适定且客观的问题。它描述了一个用于高温氮气热化学非平衡的标准物理模型，这是高超声速学的一个核心课题。任务是实现一种稳健的数值方法，特别是用牛顿类方法求解的后向欧拉时间步进格式，以求出离散时间间隔后系统的状态。该问题被验证为合理，有必要提供完整的解法。\n\n求解过程分三个阶段：\n1.  为新时间步的状态变量建立控制非线性方程组。\n2.  推导牛顿法所需的雅可比矩阵。\n3.  实现 Newton-Raphson 求解器以找到每个测试用例的解，然后进行指定的物理和数值评估。\n\n系统在任意时间 $t$ 的状态由变量向量 $\\mathbf{x} = [n_{N_2}, n_N, T_v, T]^T$ 描述，分别代表 $N_2$ 和 $N$ 的摩尔浓度、$N_2$ 的振动温度以及平动-转动温度。给定在时间 $t^n$ 的状态 $\\mathbf{x}^n$，我们寻求在时间 $t^{n+1} = t^n + \\Delta t$ 的状态 $\\mathbf{x}^{n+1}$。\n\n### 1. 控制非线性系统\n\n后向欧拉法将常微分方程组 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(\\mathbf{y})$ 离散化为 $\\frac{\\mathbf{y}^{n+1} - \\mathbf{y}^n}{\\Delta t} = \\mathbf{f}(\\mathbf{y}^{n+1})$。这会导出一个关于 $\\mathbf{y}^{n+1}$ 的非线性代数方程组。所提供的微分方程为：\n$$\n\\frac{d n_{N_2}}{d t} = -\\mathcal{R} \\\\\n\\frac{d n_N}{d t} = 2\\,\\mathcal{R} \\\\\n\\frac{d T_v}{d t} = \\frac{T - T_v}{\\tau_v}\n$$\n此外，由于系统是绝热且等容的，单位体积的总内能 $U$ 是守恒的：\n$$\nU(n_{N_2},n_N,T_v,T) = \\text{constant}\n$$\n前两个关于组分浓度的微分方程是线性相关的。将第二个方程与第一个方程的 $2$ 倍相加，得到 $\\frac{d n_N}{dt} + 2\\frac{d n_{N_2}}{dt} = 0$，这意味着单位体积的氮原子总数 $N_{\\mathrm{atoms}} = n_N + 2n_{N_2}$ 是一个守恒量。组分方程的离散时间形式，$n_N^{n+1} - n_N^n = 2\\Delta t \\mathcal{R}^{n+1}$ 和 $n_{N_2}^{n+1} - n_{N_2}^n = -\\Delta t \\mathcal{R}^{n+1}$，也保全此守恒量，即 $n_N^{n+1} + 2n_{N_2}^{n+1} = n_N^n + 2n_{N_2}^n$。\n\n为了为 $\\mathbf{x}^{n+1}$ 中的 $4$ 个未知数构建一个适定的 $4 \\times 4$ 系统，我们将其中一个冗余的组分方程替换为原子守恒定律。这得到了一个由 $4$ 个独立非线性方程组成的系统 $\\mathbf{F}(\\mathbf{x}^{n+1}) = \\mathbf{0}$，其中 $\\mathbf{x}^{n+1} = [n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1}]^T$：\n\n1.  **$N_2$ 组分平衡：** 从 $n_{N_2}^{n+1} - n_{N_2}^n = -\\Delta t \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1})$，我们定义第一个残差分量：\n    $$F_1(\\mathbf{x}^{n+1}) = n_{N_2}^{n+1} - n_{N_2}^{n} + \\Delta t\\, \\mathcal{R}^{n+1} = 0$$\n2.  **原子守恒：** 氮原子总数是守恒的。设 $N_{\\mathrm{atoms,tot}} = n_N^n + 2n_{N_2}^n$。第二个残差是：\n    $$F_2(\\mathbf{x}^{n+1}) = n_N^{n+1} + 2n_{N_2}^{n+1} - N_{\\mathrm{atoms,tot}} = 0$$\n3.  **振动能平衡 (Landau-Teller)：** 从 $T_v^{n+1} - T_v^n = \\Delta t \\frac{T^{n+1} - T_v^{n+1}}{\\tau_v}$，我们重新整理得到第三个残差：\n    $$F_3(\\mathbf{x}^{n+1}) = T_v^{n+1}(1 + \\Delta t/\\tau_v) - T_v^n - (\\Delta t/\\tau_v) T^{n+1} = 0$$\n4.  **总能量守恒：** 总内能 $U$ 是恒定的，$U^{n+1} = U^n$。设 $U_n = U(n_{N_2}^{n},n_N^{n},T_v^{n},T^{n})$。第四个残差是：\n    $$F_4(\\mathbf{x}^{n+1}) = U(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1}) - U_n = 0$$\n    其中 $U(n_{N_2},n_N,T_v,T) = n_N \\left(\\frac{3}{2} R T\\right) + n_{N_2} \\left(\\frac{5}{2} R T\\right) + n_{N_2}\\, e_{\\mathrm{vib}}(T_v) - n_{N_2}\\, D$。\n\n我们使用牛顿法求解此方程组 $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$，以得到 $\\mathbf{x} = \\mathbf{x}^{n+1}$。迭代更新公式为 $\\mathbf{x}_{k+1} = \\mathbf{x}_k - [J(\\mathbf{x}_k)]^{-1} \\mathbf{F}(\\mathbf{x}_k)$，其中 $J$ 是雅可比矩阵 $J_{ij} = \\partial F_i / \\partial x_j$。迭代从初始猜测 $\\mathbf{x}_0 = \\mathbf{x}^n$ 开始。\n\n### 2. 雅可比矩阵推导\n\n雅可比矩阵 $J$ 是一个 $4 \\times 4$ 矩阵，其元素为残差向量 $\\mathbf{F} = [F_1, F_2, F_3, F_4]^T$ 对解向量 $\\mathbf{x} = [n_{N_2}, n_N, T_v, T]^T$ 的偏导数。为清晰起见，我们省略了上标 $^{n+1}$。\n\n本构关系所需的偏导数如下：\n- $\\mathcal{R} = k_f n_{N_2} - k_b n_N^2$\n- $k_f(T,T_v) = A_f \\exp\\left(-\\frac{E_a}{R T}\\right)\\,\\exp\\left(\\Theta_v\\left(\\frac{1}{T}-\\frac{1}{T_v}\\right)\\right)$\n- $\\frac{\\partial k_f}{\\partial T} = k_f \\frac{E_a - R\\Theta_v}{RT^2}$\n- $\\frac{\\partial k_f}{\\partial T_v} = k_f \\frac{\\Theta_v}{T_v^2}$\n- $k_b(T) = \\frac{k_f(T,T)}{K_{\\mathrm{eq}}(T)} = \\frac{A_f \\exp(-E_a/RT)}{K_{\\mathrm{pref}}\\, T^{3/2} \\exp(-D/RT)}$\n- $\\frac{\\partial k_b}{\\partial T} = k_b \\left( \\frac{E_a-D}{RT^2} - \\frac{3}{2T} \\right)$\n- $e_{\\mathrm{vib}}(T_v) = \\frac{R \\Theta_v}{\\exp(\\Theta_v/T_v) - 1}$\n- $\\frac{d e_{\\mathrm{vib}}}{d T_v} = \\frac{R \\Theta_v^2}{T_v^2} \\frac{\\exp(\\Theta_v/T_v)}{(\\exp(\\Theta_v/T_v) - 1)^2}$\n\n雅可比矩阵的元素 $J_{ij} = \\partial F_i / \\partial x_j$ 如下：\n\n**第 1 行 ($F_1$ 的导数)：**\n- $J_{11} = \\frac{\\partial F_1}{\\partial n_{N_2}} = 1 + \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial n_{N_2}} = 1 + \\Delta t\\, k_f$\n- $J_{12} = \\frac{\\partial F_1}{\\partial n_N} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial n_N} = -2 \\Delta t\\, k_b n_N$\n- $J_{13} = \\frac{\\partial F_1}{\\partial T_v} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial T_v} = \\Delta t\\, n_{N_2} \\frac{\\partial k_f}{\\partial T_v}$\n- $J_{14} = \\frac{\\partial F_1}{\\partial T} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial T} = \\Delta t \\left( n_{N_2} \\frac{\\partial k_f}{\\partial T} - n_N^2 \\frac{\\partial k_b}{\\partial T} \\right)$\n\n**第 2 行 ($F_2$ 的导数)：**\n- $J_{21} = \\frac{\\partial F_2}{\\partial n_{N_2}} = 2$\n- $J_{22} = \\frac{\\partial F_2}{\\partial n_N} = 1$\n- $J_{23} = \\frac{\\partial F_2}{\\partial T_v} = 0$\n- $J_{24} = \\frac{\\partial F_2}{\\partial T} = 0$\n\n**第 3 行 ($F_3$ 的导数)：**\n- $J_{31} = \\frac{\\partial F_3}{\\partial n_{N_2}} = 0$\n- $J_{32} = \\frac{\\partial F_3}{\\partial n_N} = 0$\n- $J_{33} = \\frac{\\partial F_3}{\\partial T_v} = 1 + \\Delta t/\\tau_v$\n- $J_{34} = \\frac{\\partial F_3}{\\partial T} = -\\Delta t/\\tau_v$\n\n**第 4 行 ($F_4$ 的导数)：**\n- $J_{41} = \\frac{\\partial F_4}{\\partial n_{N_2}} = \\frac{5}{2} R T + e_{\\mathrm{vib}}(T_v) - D$\n- $J_{42} = \\frac{\\partial F_4}{\\partial n_N} = \\frac{3}{2} R T$\n- $J_{43} = \\frac{\\partial F_4}{\\partial T_v} = n_{N_2} \\frac{d e_{\\mathrm{vib}}}{d T_v}$\n- $J_{44} = \\frac{\\partial F_4}{\\partial T} = \\left(\\frac{3}{2} n_N + \\frac{5}{2} n_{N_2}\\right) R$\n\n### 3. 实现与评估\n\nNewton-Raphson 算法在 Python 中实现。对于每个测试用例，求解器在当前猜测值 $\\mathbf{x}_k$ 处迭代计算残差向量 $\\mathbf{F}$ 和雅可比矩阵 $J$，求解线性系统 $J \\Delta\\mathbf{x} = -\\mathbf{F}$ 以获得更新量 $\\Delta\\mathbf{x}$，并更新解 $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\Delta\\mathbf{x}$。迭代持续进行，直到残差向量的 $L_2$ 范数低于 $10^{-9}$ 的容差。\n\n收敛后，对最终状态 $\\mathbf{x}^{n+1}$ 进行评估：\n- **正性：** 检查是否 $n_{N_2}^{n+1} \\ge 0$，$n_N^{n+1} \\ge 0$，$T_v^{n+1} > 0$ 以及 $T^{n+1} > 0$。\n- **原子守恒：** 将相对误差 $|(n_N^{n+1} + 2n_{N_2}^{n+1}) - N_{\\mathrm{atoms,tot}}| / |N_{\\mathrm{atoms,tot}}|$ 与 $10^{-10}$ 的容差进行比较。由于该守恒定律通过 $F_2=0$ 内置于非线性系统中，预计此检查将以接近机器精度的水平通过。\n- **能量守恒：** 将相对误差 $|U^{n+1} - U^n|/|U^n|$ 与 $10^{-8}$ 的容差进行比较。这验证了求解器已经收敛到一个以足够精度满足能量守恒定律 $F_4=0$ 的状态。\n\n然后针对四个指定的测试用例运行该实现，并收集评估结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    # Constants\n    R = 8.314462618  # J mol^-1 K^-1\n    THETA_V = 3390.0  # K\n    D_EV = 9.76  # eV\n    F_CONST = 96485.33212 # C/mol or J/V/mol\n    D = D_EV * F_CONST  # J mol^-1\n    A_F = 1.0e5  # s^-1\n    E_A = 2.0e5  # J mol^-1\n    K_PREF = 1.0e3  # mol m^-3 K^(-3/2)\n    TAU_V = 2.0e-6  # s\n\n    # Tolerances\n    TOL_ATOMS = 1.0e-10\n    TOL_ENERGY = 1.0e-8\n    NEWTON_TOL = 1.0e-9\n    MAX_ITER = 100\n\n    # Constitutive Relations\n    def e_vib(Tv):\n        # Vibrational energy per mole\n        if Tv == 0: return 0.0 # handle potential unphysical states during iteration\n        arg = THETA_V / Tv\n        # Avoid overflow for large arg, exp(arg) will be huge, e_vib -> 0\n        if arg > 100: return 0.0\n        return R * THETA_V / (np.exp(arg) - 1.0)\n\n    def U_total(n_n2, n_n, Tv, T):\n        # Total internal energy per unit volume\n        return (n_n * 1.5 * R * T +\n                n_n2 * 2.5 * R * T +\n                n_n2 * e_vib(Tv) -\n                n_n2 * D)\n\n    def kf_func(T, Tv):\n        # Forward rate coefficient\n        if T == 0 or Tv == 0: return 0.0\n        return A_F * np.exp(-E_A / (R * T)) * np.exp(THETA_V * (1.0/T - 1.0/Tv))\n\n    def kf_eq_func(T):\n        # Forward rate coefficient at T_v = T\n        if T == 0: return 0.0\n        return A_F * np.exp(-E_A / (R * T))\n\n    def K_eq_func(T):\n        # Equilibrium constant\n        if T == 0: return 0.0\n        return K_PREF * T**1.5 * np.exp(-D / (R * T))\n\n    def kb_func(T):\n        # Backward rate coefficient\n        if T == 0: return 0.0\n        K_eq = K_eq_func(T)\n        if K_eq == 0.0: return float('inf') # Should not happen for T > 0\n        return kf_eq_func(T) / K_eq\n\n    def reaction_rate(T, Tv, n_n2, n_n):\n        # Net reaction rate\n        return kf_func(T, Tv) * n_n2 - kb_func(T) * n_n**2\n\n    # Jacobian-related derivatives\n    def d_kf_d_T(T, Tv):\n        if T == 0 or Tv == 0: return 0.0\n        return kf_func(T, Tv) * (E_A - R * THETA_V) / (R * T**2)\n\n    def d_kf_d_Tv(T, Tv):\n        if T == 0 or Tv == 0: return 0.0\n        return kf_func(T, Tv) * THETA_V / Tv**2\n\n    def d_kb_d_T(T):\n        if T == 0: return 0.0\n        return kb_func(T) * ((E_A - D) / (R * T**2) - 1.5 / T)\n    \n    def d_e_vib_d_Tv(Tv):\n        if Tv == 0: return 0.0\n        arg = THETA_V / Tv\n        if arg > 100: return 0.0\n        exp_arg = np.exp(arg)\n        return R * (THETA_V / Tv)**2 * exp_arg / (exp_arg - 1.0)**2\n\n    def solve_case(initial_state, dt):\n        n_n2_n, n_n_n, Tv_n, T_n = initial_state\n        \n        N_atoms_tot = n_n_n + 2.0 * n_n2_n\n        U_n = U_total(n_n2_n, n_n_n, Tv_n, T_n)\n\n        # Initial guess for Newton's method\n        x_k = np.array([n_n2_n, n_n_n, Tv_n, T_n], dtype=float)\n\n        for _ in range(MAX_ITER):\n            n_n2_k, n_n_k, Tv_k, T_k = x_k\n\n            # Build residual vector F\n            F = np.zeros(4)\n            \n            # Check for unphysical state during iteration\n            if T_k == 0 or Tv_k == 0:\n                # Iteration diverged to unphysical state, break and fail\n                return [False, False, False]\n            \n            R_k = reaction_rate(T_k, Tv_k, n_n2_k, n_n_k)\n            F[0] = n_n2_k - n_n2_n + dt * R_k\n            F[1] = n_n_k + 2.0 * n_n2_k - N_atoms_tot\n            F[2] = Tv_k * (1.0 + dt / TAU_V) - Tv_n - (dt / TAU_V) * T_k\n            F[3] = U_total(n_n2_k, n_n_k, Tv_k, T_k) - U_n\n            \n            if np.linalg.norm(F) < NEWTON_TOL:\n                break\n\n            # Build Jacobian matrix J\n            J = np.zeros((4, 4))\n            \n            kf_k = kf_func(T_k, Tv_k)\n            kb_k = kb_func(T_k)\n\n            # Row 1\n            J[0, 0] = 1.0 + dt * kf_k\n            J[0, 1] = -2.0 * dt * kb_k * n_n_k\n            J[0, 2] = dt * n_n2_k * d_kf_d_Tv(T_k, Tv_k)\n            J[0, 3] = dt * (n_n2_k * d_kf_d_T(T_k, Tv_k) - n_n_k**2 * d_kb_d_T(T_k))\n\n            # Row 2\n            J[1, 0] = 2.0\n            J[1, 1] = 1.0\n            \n            # Row 3\n            J[2, 2] = 1.0 + dt / TAU_V\n            J[2, 3] = -dt / TAU_V\n\n            # Row 4\n            J[3, 0] = 2.5 * R * T_k + e_vib(Tv_k) - D\n            J[3, 1] = 1.5 * R * T_k\n            J[3, 2] = n_n2_k * d_e_vib_d_Tv(Tv_k)\n            J[3, 3] = (1.5 * n_n_k + 2.5 * n_n2_k) * R\n            \n            try:\n                delta_x = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                # Failed to solve, likely singular Jacobian\n                return [False, False, False]\n            \n            # Basic damping to prevent unphysical states\n            alpha = 1.0\n            while alpha > 1e-8:\n                x_new = x_k + alpha * delta_x\n                if x_new[0] >= -1e-12 and x_new[1] >= -1e-12 and x_new[2] > 0 and x_new[3] > 0:\n                    x_k = x_new\n                    break\n                alpha /= 2.0\n            else: # If while loop finishes without break\n                # Damping failed, can't find physical step\n                return [False, False, False]\n        else:\n            # Newton's method did not converge\n            return [False, False, False]\n\n        n_n2_f, n_n_f, Tv_f, T_f = x_k\n        n_n2_f = max(0.0, n_n2_f)\n        n_n_f = max(0.0, n_n_f)\n\n        # Assessments\n        positivity_ok = (n_n2_f >= 0 and n_n_f >= 0 and Tv_f > 0 and T_f > 0)\n\n        N_atoms_f = n_n_f + 2.0 * n_n2_f\n        atom_consv_ok = np.abs(N_atoms_f - N_atoms_tot) / np.abs(N_atoms_tot) < TOL_ATOMS if N_atoms_tot != 0 else N_atoms_f == 0\n\n        U_f = U_total(n_n2_f, n_n_f, Tv_f, T_f)\n        energy_consv_ok = np.abs(U_f - U_n) / np.abs(U_n) < TOL_ENERGY if U_n != 0 else U_f == 0\n\n        return [positivity_ok, atom_consv_ok, energy_consv_ok]\n\n    # Test cases\n    p_A, T_n_A, Tv_n_A, n_n2_n_A, n_n_n_A, dt_A = 5.0e4, 8000.0, 5000.0, 0.50, 0.25, 5.0e-7\n    \n    p_B, T_n_B, Tv_n_B, n_n2_n_B, dt_B = 2.0e4, 9000.0, 9000.0, 0.0, 1.0e-6\n    n_n_n_B = p_B / (R * T_n_B)\n    \n    p_C, T_n_C, Tv_n_C, n_n2_n_C, n_n_n_C, dt_C = 1.01325e5, 6000.0, 4000.0, 1.80, 0.23, 1.0e-9\n    \n    p_D, T_n_D, Tv_n_D, n_n2_n_D, n_n_n_D, dt_D = 8.0e4, 10000.0, 3000.0, 0.70, 0.26, 1.0e-4\n\n    test_cases = [\n        ((n_n2_n_A, n_n_n_A, Tv_n_A, T_n_A), dt_A),\n        ((n_n2_n_B, n_n_n_B, Tv_n_B, T_n_B), dt_B),\n        ((n_n2_n_C, n_n_n_C, Tv_n_C, T_n_C), dt_C),\n        ((n_n2_n_D, n_n_n_D, Tv_n_D, T_n_D), dt_D)\n    ]\n    \n    results = []\n    for case, dt in test_cases:\n        result = solve_case(case, dt)\n        results.append(result)\n\n    # Format output as a string representation of a list of lists of booleans\n    # The problem asks for boolean literals, which in Python are `True` and `False`\n    # The `str` function will correctly format them.\n    # The example [b,b,b] is a schematic, not a literal string output.\n    output_str = '[' + ','.join(map(str, results)) + ']'\n    output_str = output_str.replace(\"'\", \"\") # Remove quotes for strict adherence to boolean literal output\n    print(output_str)\n\nsolve()\n\n```", "id": "3332459"}]}