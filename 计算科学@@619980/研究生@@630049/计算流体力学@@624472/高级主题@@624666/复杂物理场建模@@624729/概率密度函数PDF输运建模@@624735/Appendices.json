{"hands_on_practices": [{"introduction": "在概率密度函数（PDF）输运建模中，我们最终得到的是一个或多个标量在特定时空点的概率密度函数。为了将这些信息与传统的雷诺平均（RANS）或大涡模拟（LES）模型联系起来，或者为了验证模型的物理真实性，我们需要从PDF中提取关键的统计矩。本练习将通过一个由高斯混合模型表示的PDF，指导您计算其前四阶中心矩和协方差矩阵，并验证重要的可实现性约束，例如施瓦茨不等式 [@problem_id:3355017]。", "problem": "在计算流体力学中，对于湍流反应流的概率密度函数输运模型，人们通常会对一个标量的数值计算得到的单点概率密度函数（PDF）进行后处理，以提取用于 Reynolds-Averaged Navier–Stokes (RANS) 或 Large Eddy Simulation (LES) 中封闭项的统计量。考虑在固定空间位置 $\\mathbf{x}_0$ 和时间 $t_0$ 的一个无量纲守恒标量 $\\phi$。$\\phi$ 的数值计算得到的单点PDF，记为 $f_{\\phi}(\\xi,\\mathbf{x}_0,t_0)$，可以很好地由以下双组分高斯混合模型表示：\n$$\nf_{\\phi}(\\xi) \\;=\\; w_{1}\\,\\mathcal{N}\\!\\left(\\xi\\,;\\,m_{1},\\,s_{1}^{2}\\right) \\;+\\; w_{2}\\,\\mathcal{N}\\!\\left(\\xi\\,;\\,m_{2},\\,s_{2}^{2}\\right),\n$$\n其中 $w_{1}=\\frac{1}{3}$，$w_{2}=\\frac{2}{3}$，$m_{1}=-1$，$m_{2}=2$，$s_{1}^{2}=\\frac{1}{2}$，$s_{2}^{2}=2$，且 $\\mathcal{N}(\\xi\\,;\\,m,\\,s^{2})$ 是均值为 $m$、方差为 $s^{2}$ 的正态分布。\n\n仅使用PDF矩的基本定义，计算在 $(\\mathbf{x}_0,t_0)$ 处 $\\phi$ 的前四个中心矩，其对 $n\\in\\{1,2,3,4\\}$ 的定义如下：\n$$\n\\mu_{n} \\;=\\; \\int_{-\\infty}^{\\infty} \\left(\\xi - \\mu_{\\phi}\\right)^{n} \\, f_{\\phi}(\\xi) \\, d\\xi,\n$$\n其中 $\\mu_{\\phi}=\\int_{-\\infty}^{\\infty}\\xi\\,f_{\\phi}(\\xi)\\,d\\xi$ 是 $\\phi$ 的均值。\n\n接下来，考虑在同一 $(\\mathbf{x}_0,t_0)$ 处的两个无量纲守恒标量 $(\\phi,\\psi)$ 的联合统计量。数值计算得到的两点联合PDF可由 $\\mathbb{R}^{2}$ 中相应的双组分高斯混合模型表示，其组分权重 $w_{k}$ 和组分均值如下：\n$$\n\\boldsymbol{\\mu}_{1}=\\begin{pmatrix} m_{1} \\\\ n_{1} \\end{pmatrix}=\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\qquad\n\\boldsymbol{\\mu}_{2}=\\begin{pmatrix} m_{2} \\\\ n_{2} \\end{pmatrix}=\\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix},\n$$\n以及组分协方差矩阵：\n$$\n\\boldsymbol{\\Sigma}_{1}=\\begin{pmatrix} s_{1}^{2}  c_{1} \\\\ c_{1}  t_{1}^{2} \\end{pmatrix}\n=\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{1}{2} \\end{pmatrix}, \\qquad\n\\boldsymbol{\\Sigma}_{2}=\\begin{pmatrix} s_{2}^{2}  c_{2} \\\\ c_{2}  t_{2}^{2} \\end{pmatrix}\n=\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix},\n$$\n其中 $t_{1}^{2}=\\frac{1}{2}$，$t_{2}^{2}=2$，$c_{1}=\\frac{1}{4}$，$c_{2}=1$。根据混合模型协方差的基本定义，构建在 $(\\mathbf{x}_0,t_0)$ 处 $(\\phi,\\psi)$ 的总协方差矩阵 $\\mathbf{C}$，并验证由施瓦茨不等式给出的可实现性约束：\n$$\n|C_{12}| \\;\\leq\\; \\sqrt{C_{11}\\,C_{22}},\n$$\n其中 $C_{ij}$ 是 $\\mathbf{C}$ 的元素。\n\n最后，定义可实现性裕度\n$$\nR \\;=\\; \\sqrt{C_{11}\\,C_{22}} \\;-\\; |C_{12}|\n$$\n并根据给定数据计算其值。将 $R$ 的最终数值结果精确表示（不进行四舍五入），并注意在此设定中所有量均为无量纲。你的最终答案必须仅为 $R$ 的值。", "solution": "首先，我们处理单个标量 $\\phi$ 的统计量。概率密度函数（PDF）$f_{\\phi}(\\xi)$ 是一个双组分高斯混合模型：\n$$\nf_{\\phi}(\\xi) = w_{1}\\,\\mathcal{N}(\\xi; m_{1}, s_{1}^{2}) + w_{2}\\,\\mathcal{N}(\\xi; m_{2}, s_{2}^{2})\n$$\n参数为 $w_{1}=\\frac{1}{3}$，$w_{2}=\\frac{2}{3}$，$m_{1}=-1$，$m_{2}=2$，$s_{1}^{2}=\\frac{1}{2}$ 及 $s_{2}^{2}=2$。\n\n$\\phi$ 的均值，记为 $\\mu_{\\phi}$，是各组分均值的加权平均：\n$$\n\\mu_{\\phi} = E[\\phi] = \\sum_{k=1}^{2} w_k m_k = w_1 m_1 + w_2 m_2\n$$\n代入给定值：\n$$\n\\mu_{\\phi} = \\left(\\frac{1}{3}\\right)(-1) + \\left(\\frac{2}{3}\\right)(2) = -\\frac{1}{3} + \\frac{4}{3} = 1\n$$\n第 $n$ 阶中心矩 $\\mu_n$ 定义为 $\\mu_n = E[(\\phi - \\mu_{\\phi})^n]$。对于混合分布，这等于：\n$$\n\\mu_n = \\sum_{k=1}^{2} w_k E_k[(\\xi - \\mu_{\\phi})^n]\n$$\n其中 $E_k[\\cdot]$ 表示关于第 $k$ 个组分分布 $\\mathcal{N}(\\xi; m_k, s_k^2)$ 的期望。令 $Z_k$ 是一个服从 $\\mathcal{N}(0, s_k^2)$ 分布的随机变量，并令 $\\delta_k = m_k - \\mu_{\\phi}$。那么 $\\xi - \\mu_{\\phi} = (\\xi - m_k) + (m_k - \\mu_{\\phi}) = Z_k + \\delta_k$。期望变为 $E_k[(Z_k + \\delta_k)^n]$。\n我们有 $\\delta_1 = m_1 - \\mu_{\\phi} = -1 - 1 = -2$ 和 $\\delta_2 = m_2 - \\mu_{\\phi} = 2 - 1 = 1$。\n方差为 $s_k^2$ 的正态分布的中心矩为 $E_k[Z_k^1]=0$，$E_k[Z_k^2]=s_k^2$，$E_k[Z_k^3]=0$，$E_k[Z_k^4]=3s_k^4$。\n使用二项式展开计算 $E_k[(Z_k + \\delta_k)^n]$：\n对于 $n=1$：$E_k[Z_k + \\delta_k] = E_k[Z_k] + \\delta_k = \\delta_k$。\n对于 $n=2$：$E_k[(Z_k + \\delta_k)^2] = E_k[Z_k^2] + 2\\delta_k E_k[Z_k] + \\delta_k^2 = s_k^2 + \\delta_k^2$。\n对于 $n=3$：$E_k[(Z_k + \\delta_k)^3] = E_k[Z_k^3] + 3\\delta_k E_k[Z_k^2] + 3\\delta_k^2 E_k[Z_k] + \\delta_k^3 = 3\\delta_k s_k^2 + \\delta_k^3$。\n对于 $n=4$：$E_k[(Z_k + \\delta_k)^4] = E_k[Z_k^4] + 4\\delta_k E_k[Z_k^3] + 6\\delta_k^2 E_k[Z_k^2] + 4\\delta_k^3 E_k[Z_k] + \\delta_k^4 = 3s_k^4 + 6\\delta_k^2 s_k^2 + \\delta_k^4$。\n\n对于组分 1 ($s_1^2 = \\frac{1}{2}$, $\\delta_1 = -2$)：\n$E_1[\\xi - \\mu_{\\phi}] = -2$\n$E_1[(\\xi - \\mu_{\\phi})^2] = \\frac{1}{2} + (-2)^2 = \\frac{9}{2}$\n$E_1[(\\xi - \\mu_{\\phi})^3] = 3(-2)(\\frac{1}{2}) + (-2)^3 = -3 - 8 = -11$\n$E_1[(\\xi - \\mu_{\\phi})^4] = 3(\\frac{1}{2})^2 + 6(-2)^2(\\frac{1}{2}) + (-2)^4 = 3(\\frac{1}{4}) + 12 + 16 = \\frac{3}{4} + 28 = \\frac{115}{4}$\n\n对于组分 2 ($s_2^2 = 2$, $\\delta_2 = 1$)：\n$E_2[\\xi - \\mu_{\\phi}] = 1$\n$E_2[(\\xi - \\mu_{\\phi})^2] = 2 + 1^2 = 3$\n$E_2[(\\xi - \\mu_{\\phi})^3] = 3(1)(2) + 1^3 = 6 + 1 = 7$\n$E_2[(\\xi - \\mu_{\\phi})^4] = 3(2)^2 + 6(1)^2(2) + 1^4 = 12 + 12 + 1 = 25$\n\n$\\phi$ 的中心矩为：\n$\\mu_1 = w_1 E_1[\\xi - \\mu_{\\phi}] + w_2 E_2[\\xi - \\mu_{\\phi}] = (\\frac{1}{3})(-2) + (\\frac{2}{3})(1) = 0$。\n$\\mu_2 = w_1 E_1[(\\xi - \\mu_{\\phi})^2] + w_2 E_2[(\\xi - \\mu_{\\phi})^2] = (\\frac{1}{3})(\\frac{9}{2}) + (\\frac{2}{3})(3) = \\frac{3}{2} + 2 = \\frac{7}{2}$。\n$\\mu_3 = w_1 E_1[(\\xi - \\mu_{\\phi})^3] + w_2 E_2[(\\xi - \\mu_{\\phi})^3] = (\\frac{1}{3})(-11) + (\\frac{2}{3})(7) = \\frac{-11+14}{3} = \\frac{3}{3} = 1$。\n$\\mu_4 = w_1 E_1[(\\xi - \\mu_{\\phi})^4] + w_2 E_2[(\\xi - \\mu_{\\phi})^4] = (\\frac{1}{3})(\\frac{115}{4}) + (\\frac{2}{3})(25) = \\frac{115}{12} + \\frac{50}{3} = \\frac{115+200}{12} = \\frac{315}{12} = \\frac{105}{4}$。\n前四个中心矩为 $\\mu_1=0$，$\\mu_2=\\frac{7}{2}$，$\\mu_3=1$ 和 $\\mu_4=\\frac{105}{4}$。\n\n接下来，我们构建 $(\\phi, \\psi)$ 联合PDF的总协方差矩阵 $\\mathbf{C}$。令 $\\mathbf{X} = (\\phi, \\psi)^T$。总均值向量 $\\boldsymbol{\\mu}$ 是各组分均值向量 $\\boldsymbol{\\mu}_k$ 的加权平均：\n$$\n\\boldsymbol{\\mu} = w_1 \\boldsymbol{\\mu}_1 + w_2 \\boldsymbol{\\mu}_2 = \\frac{1}{3} \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1/3 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 4/3 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n总协方差矩阵 $\\mathbf{C}$ 由全协方差定律给出：\n$$\n\\mathbf{C} = E[\\text{Cov}(\\mathbf{X}|k)] + \\text{Cov}(E[\\mathbf{X}|k])\n$$\n第一项是组分协方差矩阵的加权平均：\n$$\nE[\\text{Cov}(\\mathbf{X}|k)] = w_1 \\boldsymbol{\\Sigma}_1 + w_2 \\boldsymbol{\\Sigma}_2 = \\frac{1}{3}\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{1}{2} \\end{pmatrix} + \\frac{2}{3}\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6}  \\frac{1}{12} \\\\ \\frac{1}{12}  \\frac{1}{6} \\end{pmatrix} + \\begin{pmatrix} \\frac{4}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1+8}{6}  \\frac{1+8}{12} \\\\ \\frac{1+8}{12}  \\frac{1+8}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{6}  \\frac{9}{12} \\\\ \\frac{9}{12}  \\frac{9}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}  \\frac{3}{4} \\\\ \\frac{3}{4}  \\frac{3}{2} \\end{pmatrix}\n$$\n第二项是组分均值向量的协方差：\n$$\n\\text{Cov}(E[\\mathbf{X}|k]) = \\sum_{k=1}^{2} w_k (\\boldsymbol{\\mu}_k - \\boldsymbol{\\mu})(\\boldsymbol{\\mu}_k - \\boldsymbol{\\mu})^T\n$$\n组分均值与总均值的偏差为：\n$\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix}$\n$\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n所以，\n$$\n\\text{Cov}(E[\\mathbf{X}|k]) = \\frac{1}{3} \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix} \\begin{pmatrix} -2  -2 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 4  4 \\\\ 4  4 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3}  \\frac{4}{3} \\\\ \\frac{4}{3}  \\frac{4}{3} \\end{pmatrix} + \\begin{pmatrix} \\frac{2}{3}  \\frac{2}{3} \\\\ \\frac{2}{3}  \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 2  2 \\\\ 2  2 \\end{pmatrix}\n$$\n总协方差矩阵是这两个矩阵的和：\n$$\n\\mathbf{C} = \\begin{pmatrix} \\frac{3}{2}  \\frac{3}{4} \\\\ \\frac{3}{4}  \\frac{3}{2} \\end{pmatrix} + \\begin{pmatrix} 2  2 \\\\ 2  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}+2  \\frac{3}{4}+2 \\\\ \\frac{3}{4}+2  \\frac{3}{2}+2 \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{2}  \\frac{11}{4} \\\\ \\frac{11}{4}  \\frac{7}{2} \\end{pmatrix}\n$$\n因此，$C_{11} = \\frac{7}{2}$，$C_{22} = \\frac{7}{2}$，以及 $C_{12} = \\frac{11}{4}$。注意 $C_{11} = \\mu_2$，即 $\\phi$ 的方差，正如预期。\n我们验证可实现性约束（施瓦茨不等式）：$|C_{12}| \\leq \\sqrt{C_{11}C_{22}}$。\n$$\n\\left|\\frac{11}{4}\\right| \\leq \\sqrt{\\left(\\frac{7}{2}\\right)\\left(\\frac{7}{2}\\right)} \\implies \\frac{11}{4} \\leq \\frac{7}{2} \\implies \\frac{11}{4} \\leq \\frac{14}{4}\n$$\n不等式 $11 \\leq 14$ 成立，因此可实现性约束得到满足。\n\n最后，我们计算可实现性裕度 $R$：\n$$\nR = \\sqrt{C_{11}C_{22}} - |C_{12}|\n$$\n代入我们求得的值：\n$$\nR = \\sqrt{\\left(\\frac{7}{2}\\right)\\left(\\frac{7}{2}\\right)} - \\left|\\frac{11}{4}\\right| = \\frac{7}{2} - \\frac{11}{4} = \\frac{14}{4} - \\frac{11}{4} = \\frac{3}{4}\n$$\n可实现性裕度的值为 $\\frac{3}{4}$。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "3355017"}, {"introduction": "PDF方法的核心思想之一是用一组随机微分方程（SDE）来描述流体质点的演化，这在拉格朗日框架下尤为常见。理解这些SDE的解及其统计特性，对于掌握PDF模型至关重要。本练习将引导您求解一个基础的朗之万型SDE，该SDE描述了均匀各向同性湍流中的速度分量，并从第一性原理出发推导出湍动能 $k(t)$ 随时间的指数弛豫行为 [@problem_id:3355030]。", "problem": "考虑计算流体力学中均匀各向同性湍流的单点概率密度函数（PDF）输运模型。对于 $i \\in \\{1,2,3\\}$，粒子速度分量 $u_{i}(t)$ 的演化遵循一个由独立标准维纳过程 $W_{i}(t)$ 驱动的线性朗之万型随机微分方程（SDE）：\n$$\n\\mathrm{d}u_{i}(t) = a_{i}(u,t)\\,\\mathrm{d}t + \\sum_{j=1}^{3} B_{ij}\\,\\mathrm{d}W_{j}(t),\n$$\n其线性漂移和各向同性扩散由下式指定\n$$\na_{i}(u,t) = -\\beta\\,u_{i}(t), \\qquad B_{ij} = \\sqrt{\\frac{2\\,\\beta\\,k}{3}}\\,\\delta_{ij},\n$$\n其中 $\\beta>0$ 是一个恒定的松弛率，$k>0$ 是一个代表由随机强迫所施加的能级的恒定参数，而 $\\delta_{ij}$ 是克罗内克δ函数。假设初始条件为零均值和各向同性，满足\n$$\n\\langle u_{i}(0)\\rangle = 0, \\qquad k(0) \\equiv \\frac{1}{2}\\,\\langle u_{i}(0)\\,u_{i}(0)\\rangle = k_{0},\n$$\n其中 $k_{0}>0$ 是给定的，尖括号表示系综期望。所有分量 $W_{i}(t)$ 都是独立的标准布朗运动，因此 $\\mathrm{d}W_{i}(t)\\,\\mathrm{d}W_{j}(t) = \\delta_{ij}\\,\\mathrm{d}t$。\n\n仅从 Itô 微积分和上述 SDE 出发，推导 $u_{i}(t)$ 的闭式解，并用它来计算三维空间中的湍动能\n$$\nk(t) \\equiv \\frac{1}{2}\\,\\langle u_{i}(t)\\,u_{i}(t)\\rangle,\n$$\n。从第一性原理证明 $k(t)$ 表现出由模型参数控制的指数松弛。将您的最终答案表示为 $k(t)$ 关于 $\\beta$、$k$、$k_{0}$ 和 $t$ 的单个闭式解析表达式。不需要数值近似。", "solution": "速度分量 $u_{i}(t)$ 的控制SDE由下式给出：\n$$\n\\mathrm{d}u_{i}(t) = a_{i}(u,t)\\,\\mathrm{d}t + \\sum_{j=1}^{3} B_{ij}\\,\\mathrm{d}W_{j}(t)\n$$\n代入给定的漂移 $a_i$ 和扩散 $B_{ij}$ 的形式：\n$$\n\\mathrm{d}u_{i}(t) = -\\beta\\,u_{i}(t)\\,\\mathrm{d}t + \\sum_{j=1}^{3} \\sqrt{\\frac{2\\,\\beta\\,k}{3}}\\,\\delta_{ij}\\,\\mathrm{d}W_{j}(t)\n$$\n由于克罗内克δ函数 $\\delta_{ij}$，对 $j$ 的求和坍缩，只留下 $j=i$ 的项。这产生了三个独立的SDE，每个分量 $i \\in \\{1,2,3\\}$ 一个：\n$$\n\\mathrm{d}u_{i}(t) = -\\beta\\,u_{i}(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{i}(t)\n$$\n其中为记法简洁，我们定义了常数 $\\sigma = \\sqrt{\\frac{2\\,\\beta\\,k}{3}}$。这是一个线性SDE，具体来说是一个Ornstein-Uhlenbeck过程。为了求解它，我们使用积分因子，这类似于求解一阶线性常微分方程的方法。令积分因子为 $I(t) = \\exp(\\beta t)$。我们考虑乘积 $\\exp(\\beta t) u_{i}(t)$ 的微分。对一个函数 $f(t, X_t)$，其中 $\\mathrm{d}X_t = \\alpha(t,X_t)\\mathrm{d}t + \\gamma(t,X_t)\\mathrm{d}W_t$，使用 Itô 乘法法则，我们有 $\\mathrm{d}f = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + \\frac{\\partial f}{\\partial X}\\mathrm{d}X_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial X^2}(\\mathrm{d}X_t)^2$。对于 $f(t, u_i) = \\exp(\\beta t) u_i(t)$，我们有 $\\frac{\\partial f}{\\partial t} = \\beta \\exp(\\beta t) u_i(t)$，$\\frac{\\partial f}{\\partial u_i} = \\exp(\\beta t)$，以及 $\\frac{\\partial^2 f}{\\partial u_i^2}=0$。Itô 法则简化为标准乘法法则：\n$$\n\\mathrm{d}(\\exp(\\beta t) u_{i}(t)) = (\\beta \\exp(\\beta t) u_i(t))\\,\\mathrm{d}t + \\exp(\\beta t)\\,\\mathrm{d}u_{i}(t)\n$$\n代入 $\\mathrm{d}u_{i}(t)$ 的表达式：\n$$\n\\mathrm{d}(\\exp(\\beta t) u_{i}(t)) = \\beta \\exp(\\beta t) u_i(t)\\,\\mathrm{d}t + \\exp(\\beta t) \\left( -\\beta\\,u_{i}(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{i}(t) \\right)\n$$\n漂移项相互抵消：\n$$\n\\mathrm{d}(\\exp(\\beta t) u_{i}(t)) = \\sigma \\exp(\\beta t)\\,\\mathrm{d}W_{i}(t)\n$$\n将此式从时间 $0$ 积分到 $t$：\n$$\n\\int_{0}^{t} \\mathrm{d}(\\exp(\\beta s) u_{i}(s)) = \\int_{0}^{t} \\sigma \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s)\n$$\n$$\n\\exp(\\beta t) u_{i}(t) - \\exp(0) u_{i}(0) = \\sigma \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s)\n$$\n解出 $u_{i}(t)$ 得到其闭式解：\n$$\nu_{i}(t) = u_{i}(0)\\exp(-\\beta t) + \\sigma \\exp(-\\beta t) \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s)\n$$\n这是速度分量 $u_{i}(t)$ 的解。接下来，我们计算湍动能，$k(t) = \\frac{1}{2}\\langle u_{i}(t)u_{i}(t) \\rangle = \\frac{1}{2}\\sum_{i=1}^{3} \\langle u_{i}(t)^2 \\rangle$。我们从计算 $\\langle u_{i}(t)^2 \\rangle$ 开始。将 $u_i(t)$ 的表达式平方：\n$$\nu_{i}(t)^2 = \\left( u_{i}(0)\\exp(-\\beta t) + \\sigma \\exp(-\\beta t) \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right)^2\n$$\n$$\nu_{i}(t)^2 = u_{i}(0)^2\\exp(-2\\beta t) + 2 u_{i}(0) \\sigma \\exp(-2\\beta t) \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) + \\sigma^2 \\exp(-2\\beta t) \\left( \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right)^2\n$$\n现在，我们对该方程取系综期望 $\\langle \\cdot \\rangle$。根据期望的线性性质：\n$$\n\\langle u_{i}(t)^2 \\rangle = \\langle u_{i}(0)^2 \\rangle \\exp(-2\\beta t) + 2 \\sigma \\exp(-2\\beta t) \\left\\langle u_{i}(0) \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right\\rangle + \\sigma^2 \\exp(-2\\beta t) \\left\\langle \\left( \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right)^2 \\right\\rangle\n$$\n我们计算每一项的期望。\n第一项保持不变。\n对于第二个（交叉）项，初始条件 $u_{i}(0)$ 在时间 $t=0$ 时确定，而 Itô 积分涉及 $s \\in [0, t]$ 的维纳过程增量 $\\mathrm{d}W_{i}(s)$。由于维纳过程的未来增量与过去无关，所以 $u_{i}(0)$ 与该积分独立。因此，乘积的期望等于期望的乘积：\n$$\n\\left\\langle u_{i}(0) \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right\\rangle = \\langle u_{i}(0) \\rangle \\left\\langle \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right\\rangle\n$$\n任何具有确定性被积函数的 Itô 積分的期望为零。此外，给定条件为 $\\langle u_{i}(0) \\rangle = 0$。因此，整个交叉项为零。\n对于第三项，我们使用 Itô 等距性质，该性质指出对于一个确定性函数 $f(s)$：\n$$\n\\left\\langle \\left( \\int_{0}^{t} f(s)\\,\\mathrm{d}W_{i}(s) \\right)^2 \\right\\rangle = \\int_{0}^{t} f(s)^2\\,\\mathrm{d}s\n$$\n在我们的例子中，$f(s) = \\exp(\\beta s)$ 是确定性的。所以，\n$$\n\\left\\langle \\left( \\int_{0}^{t} \\exp(\\beta s)\\,\\mathrm{d}W_{i}(s) \\right)^2 \\right\\rangle = \\int_{0}^{t} (\\exp(\\beta s))^2\\,\\mathrm{d}s = \\int_{0}^{t} \\exp(2\\beta s)\\,\\mathrm{d}s = \\left[ \\frac{1}{2\\beta} \\exp(2\\beta s) \\right]_{0}^{t} = \\frac{1}{2\\beta}(\\exp(2\\beta t) - 1)\n$$\n将这些结果代回 $\\langle u_{i}(t)^2 \\rangle$ 的方程中：\n$$\n\\langle u_{i}(t)^2 \\rangle = \\langle u_{i}(0)^2 \\rangle\\exp(-2\\beta t) + 0 + \\sigma^2 \\exp(-2\\beta t) \\left( \\frac{\\exp(2\\beta t) - 1}{2\\beta} \\right)\n$$\n$$\n\\langle u_{i}(t)^2 \\rangle = \\langle u_{i}(0)^2 \\rangle\\exp(-2\\beta t) + \\frac{\\sigma^2}{2\\beta} (1 - \\exp(-2\\beta t))\n$$\n现在，代入 $\\sigma^2 = \\frac{2\\beta k}{3}$ 的表达式：\n$$\n\\frac{\\sigma^2}{2\\beta} = \\frac{1}{2\\beta} \\left( \\frac{2\\beta k}{3} \\right) = \\frac{k}{3}\n$$\n所以，对于每个分量 $i$：\n$$\n\\langle u_{i}(t)^2 \\rangle = \\langle u_{i}(0)^2 \\rangle\\exp(-2\\beta t) + \\frac{k}{3} (1 - \\exp(-2\\beta t))\n$$\n最后，我们通过对 $i=1, 2, 3$ 求和并乘以 $\\frac{1}{2}$ 来计算湍动能 $k(t)$：\n$$\nk(t) = \\frac{1}{2} \\sum_{i=1}^{3} \\langle u_{i}(t)^2 \\rangle = \\frac{1}{2} \\sum_{i=1}^{3} \\left[ \\langle u_{i}(0)^2 \\rangle\\exp(-2\\beta t) + \\frac{k}{3} (1 - \\exp(-2\\beta t)) \\right]\n$$\n$$\nk(t) = \\left( \\frac{1}{2} \\sum_{i=1}^{3} \\langle u_{i}(0)^2 \\rangle \\right) \\exp(-2\\beta t) + \\frac{1}{2} \\sum_{i=1}^{3} \\frac{k}{3} (1 - \\exp(-2\\beta t))\n$$\n括号中的第一项根据定义是初始湍动能 $k_0 = \\frac{1}{2}\\langle u_{i}(0)u_{i}(0) \\rangle$。对于第二项，被加数相对于 $i$ 是常数，因此总和是被加数的3倍：\n$$\nk(t) = k_{0}\\exp(-2\\beta t) + \\frac{1}{2} \\cdot 3 \\cdot \\frac{k}{3} (1 - \\exp(-2\\beta t))\n$$\n$$\nk(t) = k_{0}\\exp(-2\\beta t) + \\frac{k}{2} (1 - \\exp(-2\\beta t))\n$$\n这个表达式展示了湍动能的指数松弛。它可以被重排以突显从初始状态 $k_0$ 到稳态值的松弛过程：\n$$\nk(t) = k_{0}\\exp(-2\\beta t) + \\frac{k}{2} - \\frac{k}{2}\\exp(-2\\beta t)\n$$\n$$\nk(t) = \\left( k_{0} - \\frac{k}{2} \\right) \\exp(-2\\beta t) + \\frac{k}{2}\n$$\n这就是 $k(t)$ 的最终闭式解析表达式。它表明 $k(t)$ 从其初始值 $k_0$ 以 $2\\beta$ 的松弛率指数松弛到稳态值 $\\frac{k}{2}$。", "answer": "$$\\boxed{\\left( k_{0} - \\frac{k}{2} \\right) \\exp(-2\\beta t) + \\frac{k}{2}}$$", "id": "3355030"}, {"introduction": "在PDF输运方程中，分子混合等小尺度过程无法直接解析，必须通过封闭模型来描述，这构成了PDF建模的核心挑战。标量耗散率 $\\chi$ 是表征分子混合强度的关键物理量。本练习将向您展示如何基于对未解析标量梯度的合理假设，从一个已知的标量PDF出发，推导出标量耗散率的PDF，从而建立起宏观混合模型（如IEM模型）与微观统计分布之间的桥梁 [@problem_id:3354995]。", "problem": "考虑一个统计均匀且各向同性的不可压缩湍流，该湍流输运一个被动标量场 $\\phi(\\mathbf{x},t)$，其分子扩散率为常数 $D$。在时间 $t=t_{0}$ 时，欧拉概率密度函数（PDF；probability density function）输运求解器提供了联合场 $f(\\phi,\\mathbf{x},t_{0})$ 以及与“与均值交换的相互作用”（IEM；Interaction by Exchange with the Mean）封闭模型相关的微观混合频率 $\\lambda(t_{0})$，并假设后者在 $t_{0}$ 时空间均匀。标量耗散率定义为 $\\chi = 2 D |\\nabla \\phi|^{2}$。\n\n从第一性原理（$\\chi$ 的定义以及概率密度在变量变换下的变换性质）出发，并且不借助任何预先指定的目标公式，构建一种诊断方法，以从欧拉 $\\phi$-PDF 解中恢复域平均标量耗散率 PDF $p(\\chi)$。为了封闭未解析的梯度统计量，做出以下具有科学依据且与各向同性一致的假设：\n\n- 在给定 $\\phi$ 的条件下，标量梯度矢量 $\\nabla \\phi$ 的分量是独立的、零均值的高斯随机变量，具有相等的方差 $a^{2}$（该方差原则上可能依赖于 $\\phi$ 和 $\\mathbf{x}$，但对于 $t_{0}$ 时的均匀各向同性情况，采用一个由下面指定的一致性条件决定的单一常数 $a$）。\n- 将从此梯度封闭模型中获得的平均标量耗散与 IEM 微观混合预测值相匹配，即 $\\langle \\chi \\rangle = 2 \\lambda(t_{0}) \\,\\sigma_{\\phi}^{2}(t_{0})$，其中标量方差 $\\sigma_{\\phi}^{2}(t_{0})$ 由欧拉 $\\phi$-PDF 计算得出：\n$$\n\\sigma_{\\phi}^{2}(t_{0}) = \\int_{\\Omega}\\int_{\\mathbb{R}} \\left(\\phi - \\mu_{\\phi}(t_{0})\\right)^{2}\\, f(\\phi,\\mathbf{x},t_{0})\\, d\\phi\\, d\\mathbf{x}, \\quad\n\\mu_{\\phi}(t_{0}) = \\int_{\\Omega}\\int_{\\mathbb{R}} \\phi\\, f(\\phi,\\mathbf{x},t_{0})\\, d\\phi\\, d\\mathbf{x},\n$$\n其中 $\\Omega$ 表示空间域。\n\n在这些假设下，推导出一个关于域平均标量耗散率 PDF $p(\\chi)$ 在 $t_{0}$ 时的闭式解析表达式（不含积分），该表达式用 $\\chi$、$\\lambda(t_{0})$ 和 $\\sigma_{\\phi}^{2}(t_{0})$ 表示。$\\chi$ 的单位为 $\\mathrm{s}^{-1}$；得到的 PDF $p(\\chi)$ 的单位为 $\\mathrm{s}$。不需要进行数值计算，也无需四舍五入。您的最终答案必须是 $p(\\chi)$ 的单个解析表达式。", "solution": "目标是推导在时间 $t=t_0$ 时标量耗散率的概率密度函数（PDF）$p(\\chi)$。为简化符号，在最终表达式之前，对 $t_0$ 的依赖将在诸如 $\\lambda$ 和 $\\sigma_{\\phi}^{2}$ 等符号中被隐式表示。\n\n标量耗散率定义为 $\\chi = 2 D |\\nabla \\phi|^{2}$。设标量梯度的分量为 $g_i = \\frac{\\partial \\phi}{\\partial x_i}$（$i=1, 2, 3$）。则 $|\\nabla \\phi|^{2} = g_1^2 + g_2^2 + g_3^2$，耗散率为 $\\chi = 2D (g_1^2 + g_2^2 + g_3^2)$。\n\n问题陈述，作为封闭假设，梯度分量 $g_i$ 是独立的、服从均值为零、方差为 $a^2$ 的同分布（i.i.d.）高斯随机变量。\n$$\ng_i \\sim N(0, a^2) \\quad \\text{for } i=1, 2, 3\n$$\n我们可以定义标准化随机变量 $Z_i = g_i/a$，它们是独立的、服从标准正态分布的同分布变量，即 $Z_i \\sim N(0, 1)$。\n\n梯度分量的平方和可以用这些标准正态变量表示：\n$$\nS = |\\nabla \\phi|^2 = g_1^2 + g_2^2 + g_3^2 = a^2(Z_1^2 + Z_2^2 + Z_3^2)\n$$\n$k$ 个独立标准正态随机变量的平方和服从自由度为 $k$ 的卡方分布，记为 $\\chi^2_k$。因此，变量 $Y = Z_1^2 + Z_2^2 + Z_3^2$ 服从自由度为 3 的卡方分布，即 $Y \\sim \\chi^2_3$。\n\n对于 $y \\ge 0$，$\\chi^2_k$ 变量的 PDF 由下式给出：\n$$\np_Y(y) = \\frac{1}{2^{k/2} \\Gamma(k/2)} y^{k/2 - 1} \\exp\\left(-\\frac{y}{2}\\right)\n$$\n对于 $k=3$，并使用恒等式 $\\Gamma(3/2) = \\frac{1}{2}\\Gamma(1/2) = \\frac{\\sqrt{\\pi}}{2}$，$Y$ 的 PDF 为：\n$$\np_Y(y) = \\frac{1}{2^{3/2} \\Gamma(3/2)} y^{1/2} \\exp\\left(-\\frac{y}{2}\\right) = \\frac{1}{2\\sqrt{2} (\\sqrt{\\pi}/2)} y^{1/2} \\exp\\left(-\\frac{y}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} y^{1/2} \\exp\\left(-\\frac{y}{2}\\right)\n$$\n我们感兴趣的变量是标量耗散率 $\\chi$。首先，我们求 $S = a^2 Y$ 的 PDF。使用变量替换公式 $p_S(s) = p_Y(y(s)) |\\frac{dy}{ds}|$，其中 $y=s/a^2$ 且 $\\frac{dy}{ds} = 1/a^2$：\n$$\np_S(s) = \\frac{1}{\\sqrt{2\\pi}} \\left(\\frac{s}{a^2}\\right)^{1/2} \\exp\\left(-\\frac{s}{2a^2}\\right) \\frac{1}{a^2} = \\frac{s^{1/2}}{\\sqrt{2\\pi} (a^2)^{3/2}} \\exp\\left(-\\frac{s}{2a^2}\\right)\n$$\n现在我们求 $\\chi = 2DS$ 的 PDF。再次使用变量替换公式 $p(\\chi) = p_S(s(\\chi)) |\\frac{ds}{d\\chi}|$，其中 $s=\\chi/(2D)$ 且 $\\frac{ds}{d\\chi} = 1/(2D)$：\n$$\np(\\chi) = \\frac{(\\chi/(2D))^{1/2}}{\\sqrt{2\\pi} (a^2)^{3/2}} \\exp\\left(-\\frac{\\chi/(2D)}{2a^2}\\right) \\frac{1}{2D} = \\frac{\\chi^{1/2}}{(2D)^{1/2}\\sqrt{2\\pi} a^3 (2D)} \\exp\\left(-\\frac{\\chi}{4Da^2}\\right)\n$$\n$$\np(\\chi) = \\frac{1}{4\\sqrt{\\pi}D^{3/2}a^3} \\chi^{1/2} \\exp\\left(-\\frac{\\chi}{4Da^2}\\right)\n$$\n这是一个伽马分布的 PDF。一个随机变量 $X \\sim \\Gamma(k, \\theta)$（形状参数为 $k$，尺度参数为 $\\theta$）的 PDF 为 $p(x) = \\frac{1}{\\Gamma(k)\\theta^k} x^{k-1} \\exp(-x/\\theta)$。比较我们得到的 $p(\\chi)$ 表达式，我们确定形状参数 $k-1=1/2$，因此 $k=3/2$，尺度参数 $\\theta = 4Da^2$。前置因子为 $1/(\\Gamma(3/2)\\theta^{3/2}) = 1/((\\sqrt{\\pi}/2)(4Da^2)^{3/2}) = 1/((\\sqrt{\\pi}/2) 8 D^{3/2} a^3) = 1/(4\\sqrt{\\pi}D^{3/2}a^3)$，这与我们的推导相符。\n\n伽马分布变量的均值为 $\\langle \\chi \\rangle = k\\theta$。\n$$\n\\langle\\chi\\rangle = \\frac{3}{2} (4Da^2) = 6Da^2\n$$\n问题提供了一个一致性条件来确定未知的模型参数 $a^2$：平均标量耗散必须与 IEM 模型的预测相匹配。在 $t=t_0$ 时：\n$$\n\\langle\\chi\\rangle = 2\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\n$$\n令两个 $\\langle\\chi\\rangle$ 的表达式相等：\n$$\n6Da^2 = 2\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\n$$\n求解参数组 $4Da^2$，也就是尺度参数 $\\theta$：\n$$\nDa^2 = \\frac{1}{3}\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0) \\implies \\theta = 4Da^2 = \\frac{4}{3}\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\n$$\n现在我们将这个尺度参数 $\\theta$ 的表达式代回到 $\\chi$ 的伽马 PDF 中：\n$$\np(\\chi) = \\frac{1}{\\Gamma(3/2)\\theta^{3/2}} \\chi^{1/2} \\exp\\left(-\\frac{\\chi}{\\theta}\\right)\n$$\n$$\np(\\chi) = \\frac{1}{(\\sqrt{\\pi}/2) \\left(\\frac{4}{3}\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2}} \\chi^{1/2} \\exp\\left(-\\frac{\\chi}{\\frac{4}{3}\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)}\\right)\n$$\n我们来简化分母中的归一化常数：\n$$\n\\frac{\\sqrt{\\pi}}{2} \\left(\\frac{4}{3}\\right)^{3/2} \\left(\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2} = \\frac{\\sqrt{\\pi}}{2} \\frac{4^{3/2}}{3^{3/2}} \\left(\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2} = \\frac{\\sqrt{\\pi}}{2} \\frac{8}{3\\sqrt{3}} \\left(\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2}\n$$\n$$\n= \\frac{4\\sqrt{\\pi}}{3\\sqrt{3}} \\left(\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2}\n$$\n将此代回到 PDF 表达式中：\n$$\np(\\chi) = \\frac{3\\sqrt{3}}{4\\sqrt{\\pi}\\left(\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)\\right)^{3/2}} \\chi^{1/2} \\exp\\left(-\\frac{3\\chi}{4\\lambda(t_0)\\sigma_{\\phi}^{2}(t_0)}\\right)\n$$\n这就是在时间 $t_0$ 时域平均标量耗散率 PDF $p(\\chi)$ 的最终闭式解析表达式，用 $\\chi$、$\\lambda(t_0)$ 和 $\\sigma_{\\phi}^{2}(t_0)$ 表示。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{3}}{4\\sqrt{\\pi}\\left(\\lambda(t_{0})\\sigma_{\\phi}^{2}(t_{0})\\right)^{3/2}} \\chi^{1/2} \\exp\\left(-\\frac{3\\chi}{4\\lambda(t_{0})\\sigma_{\\phi}^{2}(t_{0})}\\right)}\n$$", "id": "3354995"}]}