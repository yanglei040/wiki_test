{"hands_on_practices": [{"introduction": "本练习旨在建立振荡机翼上的气动力与颤振发生之间的基本联系。通过分析一个简化的广义气动力模型，您将推导出气动阻尼，并确定系统变得不稳定的精确条件（即临界速度和频率）。这项实践对于理解颤振本质上是一个负气动阻尼问题至关重要。[@problem_id:3290263]", "problem": "一个处于单一主导弹性模态下运动的直、大展弦比机翼，可用单一广义坐标 $q(t)$ 建模，其广义质量为 $M$，结构圆频率为 $\\omega_{s}$。该机翼在密度为 $\\rho_{\\infty}$、来流速度为 $U$ 的不可压缩流中运行。半弦长为 $b$，折合频率为 $k = \\omega_{s} b / U$。对于足够小的简谐振动 $q(t) = \\Re\\{ \\hat{q} \\exp(i \\omega_{s} t) \\}$，一项线性化的计算流体动力学（CFD）分析给出了单位模态振幅下的复广义气动力的有理函数拟合：\n$$\n\\hat{Q}(k,U) \\;=\\; \\rho_{\\infty} U^{2} b^{2}\\,\\big( a_{0} + a_{2} k^{2} \\big) \\;+\\; i\\,\\rho_{\\infty} U^{2} b^{2}\\,\\big( b_{1} k - b_{3} k^{3} \\big),\n$$\n其中 $a_{0}, a_{2}, b_{1}, b_{3}$ 是无量纲常数。模态气动阻尼比 $\\zeta_{a}(k)$ 定义为等效粘性气动阻尼系数与 $2 M \\omega_{s}$ 之比，其中等效粘性系数是通过在同一简谐运动上，真实广义气动力与线性粘性阻尼器所交换的时间平均功率相等来定义的。\n\n已知参数如下：\n- $\\rho_{\\infty} = 1.225\\ \\mathrm{kg/m^{3}}$，\n- $b = 0.5\\ \\mathrm{m}$，\n- $M = 62\\ \\mathrm{kg}$，\n- $\\omega_{s} = 16\\pi\\ \\mathrm{rad/s}$，\n- $a_{0} = 5.0$, $a_{2} = 0.6$, $b_{1} = 3.2$, $b_{3} = 1.6$，\n\n执行以下操作：\n1) 从一个振荡周期内的功-能等效关系和简谐运动的等效粘性阻尼定义出发，推导 $\\zeta_{a}(k)$ 的闭式表达式，使其仅为 $k$ 和给定常数的函数。\n2) 确定使 $\\zeta_{a}(k)$ 符号改变的最小正值 $k$，并利用 $k = \\omega_{s} b / U$ 计算相应的来流速度 $U$。\n\n将 $k$ 和 $U$ 均四舍五入至四位有效数字。$U$ 以 $\\mathrm{m/s}$ 为单位表示。仅提供最终的数值对 $(k, U)$。如果在中间步骤中出现角度，必须以弧度为单位进行计算。", "solution": "该问题被评估为有效，因为它在科学上基于气动弹性力学和振动理论的原理，是适定的，并且为获得唯一解提供了所有必要的参数和定义。\n\n解答过程按题目要求分为两部分。\n\n第1部分：气动阻尼比 $\\zeta_{a}(k)$ 的推导\n\n机翼的简谐运动由单一广义坐标 $q(t)$ 描述。我们将此运动表示为 $q(t) = \\Re\\{ \\hat{q} \\exp(i \\omega_{s} t) \\}$。不失一般性，我们可以将复振幅 $\\hat{q}$ 取为代表峰值位移的实数 $q_{0}$，因此 $q(t) = q_{0} \\cos(\\omega_{s} t)$。相应的广义速度为 $\\dot{q}(t) = -q_{0} \\omega_{s} \\sin(\\omega_{s} t)$。\n\n广义气动力的复振幅为 $\\hat{Q}_{\\text{total}} = \\hat{Q} q_{0}$，其中 $\\hat{Q}(k,U)$ 是单位模态振幅下的力。我们用实部和虚部表示 $\\hat{Q}$，即 $\\hat{Q} = Q_{R} + i Q_{I}$，其中：\n$$\nQ_{R} = \\rho_{\\infty} U^{2} b^{2}\\,\\big( a_{0} + a_{2} k^{2} \\big)\n$$\n$$\nQ_{I} = \\rho_{\\infty} U^{2} b^{2}\\,\\big( b_{1} k - b_{3} k^{3} \\big)\n$$\n时域气动力 $Q(t)$ 是复力的实部：\n$$\nQ(t) = \\Re\\{ \\hat{Q}_{\\text{total}} \\exp(i \\omega_{s} t) \\} = \\Re\\{ q_{0} (Q_{R} + i Q_{I}) (\\cos(\\omega_{s} t) + i \\sin(\\omega_{s} t)) \\}\n$$\n$$\nQ(t) = q_{0} \\big( Q_{R} \\cos(\\omega_{s} t) - Q_{I} \\sin(\\omega_{s} t) \\big)\n$$\n在一个振荡周期 $T = 2\\pi/\\omega_{s}$ 内，气动力对结构所做的功 $W_{a}$ 由瞬时功率 $P_a(t) = Q(t) \\dot{q}(t)$ 的积分给出。\n$$\nW_{a} = \\int_{0}^{T} Q(t) \\dot{q}(t) dt = \\int_{0}^{2\\pi/\\omega_{s}} \\Big[ q_{0} \\big( Q_{R} \\cos(\\omega_{s} t) - Q_{I} \\sin(\\omega_{s} t) \\big) \\Big] \\Big[ -q_{0} \\omega_{s} \\sin(\\omega_{s} t) \\Big] dt\n$$\n$$\nW_{a} = -q_{0}^{2} \\omega_{s} \\int_{0}^{2\\pi/\\omega_{s}} \\Big( Q_{R} \\cos(\\omega_{s} t) \\sin(\\omega_{s} t) - Q_{I} \\sin^{2}(\\omega_{s} t) \\Big) dt\n$$\n利用定积分 $\\int_{0}^{T} \\cos(\\omega_{s} t) \\sin(\\omega_{s} t) dt = 0$ 和 $\\int_{0}^{T} \\sin^{2}(\\omega_{s} t) dt = T/2 = \\pi/\\omega_{s}$，我们得到：\n$$\nW_{a} = -q_{0}^{2} \\omega_{s} \\left( 0 - Q_{I} \\frac{\\pi}{\\omega_{s}} \\right) = \\pi q_{0}^{2} Q_{I}\n$$\n接下来，考虑一个力为 $F_{d}(t) = -C_{a,eq} \\dot{q}(t)$ 的等效线性粘性阻尼器。该阻尼器在一个周期内所做的功 $W_{d}$ 为：\n$$\nW_{d} = \\int_{0}^{T} F_{d}(t) \\dot{q}(t) dt = \\int_{0}^{T} (-C_{a,eq} \\dot{q}(t)) \\dot{q}(t) dt = -C_{a,eq} \\int_{0}^{T} \\dot{q}(t)^{2} dt\n$$\n$$\nW_{d} = -C_{a,eq} \\int_{0}^{2\\pi/\\omega_{s}} (-q_{0} \\omega_{s} \\sin(\\omega_{s} t))^{2} dt = -C_{a,eq} q_{0}^{2} \\omega_{s}^{2} \\int_{0}^{2\\pi/\\omega_{s}} \\sin^{2}(\\omega_{s} t) dt\n$$\n$$\nW_{d} = -C_{a,eq} q_{0}^{2} \\omega_{s}^{2} \\left( \\frac{\\pi}{\\omega_{s}} \\right) = -\\pi C_{a,eq} q_{0}^{2} \\omega_{s}\n$$\n问题通过令交换的功相等来定义等效粘性系数 $C_{a,eq}$。阻尼器耗散的能量为 $-W_d$，而从结构传递到流体的能量为 $-W_a$。令这些功相等得到 $W_a = W_d$。\n$$\n\\pi q_{0}^{2} Q_{I} = -\\pi C_{a,eq} q_{0}^{2} \\omega_{s}\n$$\n解出 $C_{a,eq}$ 得到：\n$$\nC_{a,eq} = -\\frac{Q_{I}}{\\omega_{s}}\n$$\n气动阻尼比 $\\zeta_{a}(k)$ 定义为 $\\zeta_{a}(k) = C_{a,eq} / (2 M \\omega_{s})$。代入 $C_{a,eq}$ 的表达式：\n$$\n\\zeta_{a}(k) = \\frac{-Q_{I}/\\omega_{s}}{2 M \\omega_{s}} = -\\frac{Q_{I}}{2 M \\omega_{s}^{2}}\n$$\n现在，我们代入 $Q_{I}$ 的给定表达式，并使用折合频率的定义 $k = \\omega_{s} b / U$，通过写出 $U = \\omega_{s} b / k$ 来消去来流速度 $U$。\n$$\n\\zeta_{a}(k) = -\\frac{\\rho_{\\infty} U^{2} b^{2}\\,\\big( b_{1} k - b_{3} k^{3} \\big)}{2 M \\omega_{s}^{2}} = -\\frac{\\rho_{\\infty} \\left(\\frac{\\omega_{s} b}{k}\\right)^{2} b^{2}\\,\\big( b_{1} k - b_{3} k^{3} \\big)}{2 M \\omega_{s}^{2}}\n$$\n$$\n\\zeta_{a}(k) = -\\frac{\\rho_{\\infty} \\frac{\\omega_{s}^{2} b^{2}}{k^{2}} b^{2}\\,\\big( b_{1} k - b_{3} k^{3} \\big)}{2 M \\omega_{s}^{2}}\n$$\n项 $\\omega_{s}^{2}$ 被消去：\n$$\n\\zeta_{a}(k) = -\\frac{\\rho_{\\infty} b^{4}}{2 M k^{2}} \\big( b_{1} k - b_{3} k^{3} \\big) = -\\frac{\\rho_{\\infty} b^{4}}{2 M} \\left( \\frac{b_{1}}{k} - b_{3} k \\right)\n$$\n重新整理各项，得到 $\\zeta_{a}(k)$ 的最终闭式表达式：\n$$\n\\zeta_{a}(k) = \\frac{\\rho_{\\infty} b^{4}}{2 M} \\left( b_{3} k - \\frac{b_{1}}{k} \\right)\n$$\n\n第2部分：临界折合频率 $k$ 和颤振速度 $U$ 的确定\n\n气动弹性不稳定性（在此情景下为颤振）发生在系统的总阻尼变为零然后变为负值时。假设结构阻尼可以忽略不计，这对应于气动阻尼比 $\\zeta_{a}(k)$ 的符号从正变为负。临界条件为 $\\zeta_{a}(k) = 0$。\n$$\n\\frac{\\rho_{\\infty} b^{4}}{2 M} \\left( b_{3} k - \\frac{b_{1}}{k} \\right) = 0\n$$\n由于前置因子 $\\frac{\\rho_{\\infty} b^{4}}{2 M}$ 是一个非零正常数，该条件简化为：\n$$\nb_{3} k - \\frac{b_{1}}{k} = 0\n$$\n对于 $k > 0$，我们可以乘以 $k$：\n$$\nb_{3} k^{2} = b_{1} \\implies k^{2} = \\frac{b_{1}}{b_{3}}\n$$\n发生符号变化的最小正值 $k$ 是：\n$$\nk = \\sqrt{\\frac{b_{1}}{b_{3}}}\n$$\n代入给定的数值 $b_{1} = 3.2$ 和 $b_{3} = 1.6$：\n$$\nk = \\sqrt{\\frac{3.2}{1.6}} = \\sqrt{2} \\approx 1.41421356\n$$\n四舍五入到四位有效数字，得到 $k = 1.414$。\n\n相应的来流速度 $U$ 可由折合频率的定义 $U = \\omega_{s} b / k$ 求得。使用给定的值 $\\omega_{s} = 16\\pi\\ \\mathrm{rad/s}$ 和 $b = 0.5\\ \\mathrm{m}$：\n$$\nU = \\frac{(16\\pi) (0.5)}{\\sqrt{2}} = \\frac{8\\pi}{\\sqrt{2}} = 4\\sqrt{2}\\pi \\approx 17.77153175\n$$\n四舍五入到四位有效数字，得到 $U = 17.77\\ \\mathrm{m/s}$。\n\n因此，颤振起始点的对 $(k, U)$ 约为 $(1.414, 17.77)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.414 & 17.77\n\\end{pmatrix}\n}\n$$", "id": "3290263"}, {"introduction": "无论是实验还是计算，实际的颤振分析通常始于结构运动的时间历程数据。本练习模拟了这一情景，要求您从一系列位移峰值中提取关键的失稳参数——增长率和频率。掌握这种技术（对数增量法的一种应用）对于解读复杂的时间推进模拟结果至关重要。[@problem_id:3290262]", "problem": "对经典颤振起始点附近的典型翼段，在小初始振幅下进行了完全耦合的计算流体动力学（CFD）和结构动力学仿真。在早期的线性阶段，主导不稳定模态的响应可以建模为单个复特征模态的实部，因此测得的广义位移满足 $x(t) \\approx A \\exp(\\sigma t) \\cos(\\omega t + \\phi)$，其中 $A$ 是未知振幅，$\\sigma$ 是实值增长率，$\\omega$ 是角频率，$\\phi$ 是未知相位。仿真输出了从原始时域推进数据中提取的、测得的位移时程的以下连续局部极大值：\n- 在 $t_0 = 0.000~\\mathrm{s}$ 时，$x(t_0) = 0.010000~\\mathrm{m}$。\n- 在 $t_1 = 0.100~\\mathrm{s}$ 时，$x(t_1) = 0.013500~\\mathrm{m}$。\n- 在 $t_2 = 0.200~\\mathrm{s}$ 时，$x(t_2) = 0.018225~\\mathrm{m}$。\n\n假设早期动力学由单个不稳定模态主导，且测得的极大值尚未受到非线性饱和的影响，请估计与模型 $x(t) \\approx A \\exp(\\sigma t) \\cos(\\omega t + \\phi)$ 一致的增长率 $\\sigma$ 和角频率 $\\omega$。将 $\\sigma$ 以 $\\mathrm{s}^{-1}$ 为单位表示，$\\omega$ 以 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$ 为单位表示，并将两者均四舍五入至四位有效数字。请以行矩阵 $\\begin{pmatrix} \\sigma & \\omega \\end{pmatrix}$ 的形式给出最终答案。", "solution": "题目要求基于模型 $x(t) \\approx A \\exp(\\sigma t) \\cos(\\omega t + \\phi)$，根据位移极大值的时间序列来估计增长率 $\\sigma$ 和角频率 $\\omega$。\n\n首先，我们验证问题陈述。\n**第1步：提取已知条件**\n- 广义位移模型：$x(t) \\approx A \\exp(\\sigma t) \\cos(\\omega t + \\phi)$，其中 $A$ 是未知振幅，$\\sigma$ 是实值增长率，$\\omega$ 是角频率，$\\phi$ 是未知相位。\n- 位移时程的连续局部极大值：\n  - 在 $t_0 = 0.000~\\mathrm{s}$ 时，$x(t_0) = 0.010000~\\mathrm{m}$。\n  - 在 $t_1 = 0.100~\\mathrm{s}$ 时，$x(t_1) = 0.013500~\\mathrm{m}$。\n  - 在 $t_2 = 0.200~\\mathrm{s}$ 时，$x(t_2) = 0.018225~\\mathrm{m}$。\n- 假设：动力学由早期线性阶段的单个不稳定模态主导。\n- 要求输出：估计 $\\sigma$ 和 $\\omega$，四舍五入至四位有效数字，以行矩阵 $\\begin{pmatrix} \\sigma & \\omega \\end{pmatrix}$ 形式呈现。\n\n**第2步：使用提取的已知条件进行验证**\n- 该问题具有科学依据。所提供的模型是具有指数增长/衰减和正弦振荡的单自由度线性系统响应的标准数学表示，这是气动弹性系统中颤振起始的特征。\n- 该问题是适定的。如解答所示，所提供的数据足以唯一确定两个未知参数 $\\sigma$ 和 $\\omega$。数据点与所提出的模型一致。\n- 该问题是客观的，并使用精确、正式的语言。\n- 该问题是自洽且一致的。连续极大值之比相等（$0.013500 / 0.010000 = 1.35$ 且 $0.018225 / 0.013500 = 1.35$），这符合指数增长模型的要求。极大值之间的时间步长也是均匀的。\n- 没有违反科学原理、不完整或验证标准中列出的其他缺陷。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n**解题推导**\n\n位移由以下函数建模：\n$$x(t) = A \\exp(\\sigma t) \\cos(\\omega t + \\phi)$$\n其中 $t$ 是时间，$A$ 是振幅常数，$\\sigma$ 是增长率，$\\omega$ 是角频率，$\\phi$ 是相角。\n\n首先，我们确定角频率 $\\omega$。时间 $t_0$、$t_1$ 和 $t_2$ 对应于 $x(t)$ 的连续局部极大值。该函数连续局部极大值之间的时间间隔是振荡的周期，我们用 $T$ 表示。为了找到极大值的位置，我们将导数 $x'(t)$ 设为零：\n$$x'(t) = \\frac{d}{dt} \\left[ A \\exp(\\sigma t) \\cos(\\omega t + \\phi) \\right] = A \\exp(\\sigma t) [ \\sigma \\cos(\\omega t + \\phi) - \\omega \\sin(\\omega t + \\phi) ] = 0$$\n这意味着在极大值出现的时刻 $t_k$，有 $\\sigma \\cos(\\omega t_k + \\phi) - \\omega \\sin(\\omega t_k + \\phi) = 0$，或\n$$\\tan(\\omega t_k + \\phi) = \\frac{\\sigma}{\\omega}$$\n由于右侧是常数，$\\omega t_k + \\phi$ 的值必须相差 $\\pi$ 的倍数。设 $\\psi = \\arctan(\\sigma/\\omega)$。所有极值（包括极大值和极小值）出现的时间解由 $\\omega t_k + \\phi = \\psi + k\\pi$ 给出，其中 $k$ 为整数。连续极大值之间的时间对应于 $k$ 变化了 $2$（例如，从 $k$ 到 $k+2$），因此周期 $T$ 由下式给出：\n$$\\omega(t_{k+2} - t_k) = (\\psi + (k+2)\\pi) - (\\psi + k\\pi) = 2\\pi$$\n$$T = t_{k+2} - t_k = \\frac{2\\pi}{\\omega}$$\n根据给定数据，连续极大值的时间是 $t_0 = 0.000~\\mathrm{s}$、$t_1 = 0.100~\\mathrm{s}$ 和 $t_2 = 0.200~\\mathrm{s}$。周期 $T$ 是它们之间的时间间隔：\n$$T = t_1 - t_0 = 0.100~\\mathrm{s} - 0.000~\\mathrm{s} = 0.100~\\mathrm{s}$$\n用下一个时间间隔检验得到相同结果：$T = t_2 - t_1 = 0.200~\\mathrm{s} - 0.100~\\mathrm{s} = 0.100~\\mathrm{s}$。\n现在我们可以计算角频率 $\\omega$：\n$$\\omega = \\frac{2\\pi}{T} = \\frac{2\\pi}{0.100~\\mathrm{s}} = 20\\pi~\\mathrm{rad}\\,\\mathrm{s}^{-1}$$\n数值上，这是 $\\omega \\approx 62.83185...~\\mathrm{rad}\\,\\mathrm{s}^{-1}$。四舍五入到四位有效数字，得到 $\\omega \\approx 62.83~\\mathrm{rad}\\,\\mathrm{s}^{-1}$。\n\n接下来，我们确定增长率 $\\sigma$。我们考察在两个连续极大值时刻 $t_k$ 和 $t_{k+1} = t_k + T$ 的位移值之比。\n$$x(t_k) = A \\exp(\\sigma t_k) \\cos(\\omega t_k + \\phi)$$\n$$x(t_{k+1}) = x(t_k + T) = A \\exp(\\sigma (t_k + T)) \\cos(\\omega (t_k + T) + \\phi)$$\n由于 $\\omega T = (2\\pi/T)T = 2\\pi$，余弦项以周期 $T$ 为周期：\n$$\\cos(\\omega(t_k + T) + \\phi) = \\cos(\\omega t_k + 2\\pi + \\phi) = \\cos(\\omega t_k + \\phi)$$\n因此，连续极大值之比简化为：\n$$\\frac{x(t_{k+1})}{x(t_k)} = \\frac{A \\exp(\\sigma t_k) \\exp(\\sigma T) \\cos(\\omega t_k + \\phi)}{A \\exp(\\sigma t_k) \\cos(\\omega t_k + \\phi)} = \\exp(\\sigma T)$$\n这种技术被称为对数衰减法（对于增长情况，则为对数增量法）。我们使用给定的位移值 $x_0 = x(t_0) = 0.010000~\\mathrm{m}$ 和 $x_1 = x(t_1) = 0.013500~\\mathrm{m}$。\n$$\\frac{x_1}{x_0} = \\frac{0.013500}{0.010000} = 1.35$$\n我们可以用下一对点 $x_1$ 和 $x_2 = x(t_2) = 0.018225~\\mathrm{m}$ 来验证。\n$$\\frac{x_2}{x_1} = \\frac{0.018225}{0.013500} = 1.35$$\n恒定的比率证实了数据与模型的一致性。\n我们将理论比率设为等于测量比率：\n$$\\exp(\\sigma T) = 1.35$$\n代入 $T = 0.100~\\mathrm{s}$：\n$$\\exp(0.100 \\sigma) = 1.35$$\n为了求解 $\\sigma$，我们对两边取自然对数：\n$$0.100 \\sigma = \\ln(1.35)$$\n$$\\sigma = \\frac{\\ln(1.35)}{0.100} = 10 \\ln(1.35)~\\mathrm{s}^{-1}$$\n数值上，$\\ln(1.35) \\approx 0.30010459...$，所以：\n$$\\sigma \\approx 10 \\times 0.30010459... = 3.0010459...~\\mathrm{s}^{-1}$$\n四舍五入到四位有效数字，得到 $\\sigma \\approx 3.001~\\mathrm{s}^{-1}$。\n\n估计的参数为 $\\sigma \\approx 3.001~\\mathrm{s}^{-1}$ 和 $\\omega \\approx 62.83~\\mathrm{rad}\\,\\mathrm{s}^{-1}$。以要求的矩阵格式表示为 $\\begin{pmatrix} 3.001 & 62.83 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3.001 & 62.83 \\end{pmatrix}}\n$$", "id": "3290262"}, {"introduction": "计算气动弹性学中的一个常见陷阱是，将数值不稳定性误判为物理上的颤振。这项高级实践将直面这一挑战，要求您实现一个时间积分方案，并应用基于功-能原理的判据来严格检验物理不稳定性的发生。通过比较一个振动周期内气动力注入的能量与结构阻尼耗散的能量，您将学会一种可靠的方法来验证模拟结果的物理真实性。[@problem_id:3290273]", "problem": "考虑一个单自由度气动弹性振子，其广义坐标为 $\\mathbf{x}(t)\\in\\mathbb{R}$，速度为 $\\dot{\\mathbf{x}}(t)$，加速度为 $\\ddot{\\mathbf{x}}(t)$，其运动遵循牛顿第二定律和功能定理。结构模型是线性的，具有质量 $m$（单位 $\\mathrm{kg}$）、结构粘性阻尼 $c$（单位 $\\mathrm{N\\cdot s/m}$）和刚度 $k$（单位 $\\mathrm{N/m}$）。气动载荷由计算流体动力学模型提供，在小扰动线性范围内，可表示为广义坐标、广义速度和广义加速度的线性组合，其系数分别为 $k_a$（单位 $\\mathrm{N/m}$）、$c_a$（单位 $\\mathrm{N\\cdot s/m}$）和 $h_a$（单位 $\\mathrm{kg}$）。结构运动方程为\n$$\nm\\,\\ddot{\\mathbf{x}}(t) + c\\,\\dot{\\mathbf{x}}(t) + k\\,\\mathbf{x}(t) = \\mathbf{F}_a(t),\n$$\n其中 $\\mathbf{F}_a(t)$ 是广义气动力。\n\n您的任务是，使用牛顿定律和功能定理从第一性原理出发，推导出一个基于周期积分气动功率输入的每周期能量准则，该准则用于确定在一个周期内是否发生了净物理气动弹性能量注入。使用此准则来区分物理颤振（克服结构耗散的净正能量注入）与广义-$\\alpha$ 时间积分格式中因算法阻尼选择而导致的表观数值行为。然后，您必须实现一个完整且可运行的程序，该程序能够：\n\n- 使用用于二阶系统的广义-$\\alpha$ 方法对运动方程在一个振荡周期内进行积分，该方法由期望的无穷远处谱半径 $\\rho_\\infty\\in[0,1]$ 参数化。\n- 将计算流体动力学载荷视为线性的，即 $\\mathbf{F}_a(t)$ 线性地依赖于 $\\mathbf{x}(t)$、$\\dot{\\mathbf{x}}(t)$ 和 $\\ddot{\\mathbf{x}}(t)$，其系数为给定的 $k_a$、$c_a$ 和 $h_a$。\n- 通过对气动功率进行数值积分来计算一个周期内的气动能量输入，并通过对粘性耗散率进行数值积分来计算同一周期内的结构粘性耗散。\n- 当且仅当一个周期内的净能量严格为正时，将每个测试用例分类为物理颤振（如果需要，可使用一个小的数值容差）；否则，将其分类为非颤振。\n\n假设除了气动载荷外，没有其他外部非保守力。广义-$\\alpha$ 参数的选择必须能够实现二阶系统所期望的高频谱半径 $\\rho_\\infty$，并且更新必须以该方法所需的中间加权状态来表示。运动学更新必须与 Newmark 族更新一致，其参数 $\\beta$ 和 $\\gamma$ 与所选的广义-$\\alpha$ 参数保持一致。\n\n科学真实性要求：\n- 所有量都必须使用其物理单位进行处理，但最终答案仅要求布尔分类；不应打印任何单位。\n- 一个振荡周期应定义为 $T = 2\\pi/\\omega_n$，其中 $\\omega_n = \\sqrt{k/m}$；在每个测试用例中，使用此周期进行能量积分。\n\n测试套件：\n在您的程序中实现以下四个测试用例。对于每个用例，设置初始条件为 $\\mathbf{x}(0)=A$, $\\dot{\\mathbf{x}}(0)=0$, and $\\ddot{\\mathbf{x}}(0)=0$。\n\n1. 正常路径物理颤振用例：$m = 50~\\mathrm{kg}$，$c = 50~\\mathrm{N\\cdot s/m}$，$k = 2\\times 10^5~\\mathrm{N/m}$，$k_a = 1\\times 10^4~\\mathrm{N/m}$，$c_a = 120~\\mathrm{N\\cdot s/m}$，$h_a = 10~\\mathrm{kg}$，$\\rho_\\infty = 0.5$，$A = 0.01~\\mathrm{m}$，以及时间步长 $\\Delta t = T/500$。\n2. 稳定用例：$m = 50~\\mathrm{kg}$，$c = 50~\\mathrm{N\\cdot s/m}$，$k = 2\\times 10^5~\\mathrm{N/m}$，$k_a = 1\\times 10^4~\\mathrm{N/m}$，$c_a = 10~\\mathrm{N\\cdot s/m}$，$h_a = 10~\\mathrm{kg}$，$\\rho_\\infty = 0.5$，$A = 0.01~\\mathrm{m}$，以及时间步长 $\\Delta t = T/500$。\n3. 近中性边界用例：$m = 50~\\mathrm{kg}$，$c = 50~\\mathrm{N\\cdot s/m}$，$k = 2\\times 10^5~\\mathrm{N/m}$，$k_a = 1\\times 10^4~\\mathrm{N/m}$，$c_a = 50~\\mathrm{N\\cdot s/m}$，$h_a = 10~\\mathrm{kg}$，$\\rho_\\infty = 0.5$，$A = 0.01~\\mathrm{m}$，以及时间步长 $\\Delta t = T/500$。\n4. 数值阻尼但物理颤振用例（强算法阻尼和更粗的时间步长）：$m = 50~\\mathrm{kg}$，$c = 50~\\mathrm{N\\cdot s/m}$，$k = 2\\times 10^5~\\mathrm{N/m}$，$k_a = 1\\times 10^4~\\mathrm{N/m}$，$c_a = 120~\\mathrm{N\\cdot s/m}$，$h_a = 10~\\mathrm{kg}$，$\\rho_\\infty = 0.0$，$A = 0.01~\\mathrm{m}$，以及时间步长 $\\Delta t = T/40$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的分类结果，格式为方括号括起来的、以逗号分隔的 Python 风格布尔值列表（例如 `[True,False,False,True]`）。不应打印任何其他文本。", "solution": "用户想要解决一个单自由度气动弹性问题。\n\n### 问题验证\n\n所提供的问题是计算结构动力学和气动弹性力学领域中一个定义明确的任务。\n\n-   **提取的已知条件**：\n    -   运动方程：$m\\,\\ddot{\\mathbf{x}}(t) + c\\,\\dot{\\mathbf{x}}(t) + k\\,\\mathbf{x}}(t) = \\mathbf{F}_a(t)$，其中 $\\mathbf{x}(t) \\in \\mathbb{R}$。\n    -   结构参数：质量 $m$ (kg)，阻尼 $c$ (N·s/m)，刚度 $k$ (N/m)。\n    -   线性气动力：$\\mathbf{F}_a(t)$ 是 $\\mathbf{x}(t)$、$\\dot{\\mathbf{x}}(t)$ 和 $\\ddot{\\mathbf{x}}(t)$ 的线性函数，系数为 $k_a$ (N/m)、$c_a$ (N·s/m) 和 $h_a$ (kg)。\n    -   时间积分：用于二阶系统的广义-$\\alpha$ 方法，由 $\\rho_\\infty \\in [0, 1]$ 参数化。\n    -   颤振准则：一个周期内的净能量严格为正，由气动功率输入和结构粘性耗散计算得出。\n    -   积分周期：一个结构固有周期，$T = 2\\pi/\\omega_n$，其中 $\\omega_n = \\sqrt{k/m}$。\n    -   初始条件：$\\mathbf{x}(0)=A$, $\\dot{\\mathbf{x}}(0)=0$, $\\ddot{\\mathbf{x}}(0)=0$。\n    -   测试用例：提供了四组不同的参数集。\n\n-   **验证结论**：\n    -   该问题在牛顿力学、功能定理和成熟的气动弹性模型方面**具有科学依据**。\n    -   作为一个二阶常微分方程的初值问题，它是**适定的**，所有必要的参数和条件都已提供。\n    -   语言是**客观**且精确的。\n    -   设置是**完整且一致的**。对 $\\ddot{\\mathbf{x}}(0)=0$ 的规定是初始化数值模拟的明确指令，而不是一个物理上的矛盾。\n    -   该问题既非微不足道也非故作高深；它解决了计算动力学中的一个核心挑战：区分物理不稳定性与数值假象。\n\n-   **结论**：该问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的解决方案\n\n解决方案分四步展开：1) 推导完整的气动弹性运动方程，2) 推导颤振的能量准则，3) 构建广义-$\\alpha$ 数值积分格式，以及 4) 描述计算算法。\n\n**1. 气动弹性运动方程**\n\n结构系统遵循线性质量-弹簧-阻尼系统的牛顿第二定律：\n$$m\\ddot{x}(t) + c\\dot{x}(t) + kx(t) = F_a(t)$$\n其中 $m$、$c$ 和 $k$ 分别是结构质量、粘性阻尼和刚度。$x(t)$ 是广义位移，$F_a(t)$ 是广义气动力。\n\n问题指定了一个线性气动模型，其中力是位移、速度和加速度的线性组合。这是对小扰动的常见近似。力表示为：\n$$F_a(t) = k_a x(t) + c_a \\dot{x}(t) + h_a \\ddot{x}(t)$$\n这里，$k_a$ 是气动刚度，$c_a$ 代表气动阻尼效应（正的 $c_a$ 通常对应于一个产生能量的机制，即负物理阻尼），$h_a$ 是附加质量或气动质量。\n\n将气动力代入运动方程，并将所有项移到一边，得到完整的航空结构系统的齐次二阶线性常微分方程：\n$$m\\ddot{x}(t) + c\\dot{x}(t) + kx(t) = k_a x(t) + c_a \\dot{x}(t) + h_a \\ddot{x}(t)$$\n$$(m - h_a)\\ddot{x}(t) + (c - c_a)\\dot{x}(t) + (k - k_a)x(t) = 0$$\n这个方程可以写成标准形式 $m_{eff}\\ddot{x}(t) + c_{eff}\\dot{x}(t) + k_{eff}x(t) = 0$，其中有效质量 $m_{eff} = m - h_a$，有效阻尼 $c_{eff} = c - c_a$，有效刚度 $k_{eff} = k - k_a$。系统的稳定性由有效阻尼 $c_{eff}$ 的符号决定。物理颤振，一种不稳定的自激振荡，在 $c_{eff}  0$ 时发生，这等价于 $c_a > c$。\n\n**2. 颤振的能量准则**\n\n功能定理指出，系统机械能的变化率等于所有非保守力提供的功率。*结构*系统的机械能为 $E_{mech}(t) = \\frac{1}{2}m\\dot{x}(t)^2 + \\frac{1}{2}kx(t)^2$。其时间导数为：\n$$\\frac{dE_{mech}}{dt} = m\\dot{x}\\ddot{x} + kx\\dot{x} = \\dot{x}(m\\ddot{x} + kx)$$\n从原始结构方程中，我们代入 $m\\ddot{x} + kx = F_a(t) - c\\dot{x}$，得到：\n$$\\frac{dE_{mech}}{dt} = \\dot{x}(F_a(t) - c\\dot{x}) = F_a(t)\\dot{x}(t) - c\\dot{x}(t)^2$$\n令 $P_a(t) = F_a(t)\\dot{x}(t)$ 为气动力输入的功率，令 $P_d(t) = c\\dot{x}(t)^2$ 为结构阻尼耗散的功率。\n\n在周期为 $T$ 的一个振荡周期内，结构机械能的净变化是净功率的积分：\n$$\\Delta E_{mech} = \\int_{0}^{T} \\frac{dE_{mech}}{dt} dt = \\int_{0}^{T} P_a(t) dt - \\int_{0}^{T} P_d(t) dt = W_a - W_d$$\n这里，$W_a$ 是气动力对结构所做的总功，$W_d$ 是一个周期内结构阻尼耗散的总能量。\n\n问题将物理颤振定义为净物理能量注入系统并克服结构耗散的状态。这对应于一个周期内结构机械能的净增加。因此准则为：\n$$\\text{颤振} \\iff \\Delta E_{mech} > 0 \\iff W_a - W_d > 0$$\n这个基于能量的准则是稳健的，因为它直接量化了物理能量交换，独立于数值积分格式引入的任何人为阻尼。\n\n**3. 广义-$\\alpha$ 数值积分**\n\n广义-$\\alpha$ 方法是一种用于结构动力学的隐式、二阶精度时间积分格式。它提供了用户可控的高频数值阻尼，由无穷远处谱半径 $\\rho_\\infty \\in [0, 1]$ 控制。较小的 $\\rho_\\infty$ 值会引入更多阻尼。\n\n该方法在时间步 $[t_n, t_{n+1}]$ 内的中间点求解运动方程：\n$$m_{eff} \\ddot{x}_{n+1-\\alpha_m} + c_{eff} \\dot{x}_{n+1-\\alpha_f} + k_{eff} x_{n+1-\\alpha_f} = 0$$\n中间状态是 $t_n$ 和 $t_{n+1}$ 处状态的加权平均：\n$$x_{n+1-\\alpha_f} = (1-\\alpha_f)x_{n+1} + \\alpha_f x_n$$\n$$\\dot{x}_{n+1-\\alpha_f} = (1-\\alpha_f)\\dot{x}_{n+1} + \\alpha_f \\dot{x}_n$$\n$$\\ddot{x}_{n+1-\\alpha_m} = (1-\\alpha_m)\\ddot{x}_{n+1} + \\alpha_m \\ddot{x}_n$$\n状态更新遵循 Newmark-$\\beta$ 族关系：\n$$\\dot{x}_{n+1} = \\dot{x}_n + \\Delta t[(1-\\gamma)\\ddot{x}_n + \\gamma \\ddot{x}_{n+1}]$$\n$$x_{n+1} = x_n + \\Delta t \\dot{x}_n + \\frac{\\Delta t^2}{2}[(1-2\\beta)\\ddot{x}_n + 2\\beta \\ddot{x}_{n+1}]$$\n为实现二阶精度和最优高频耗散，参数根据 $\\rho_\\infty$ 定义：\n$$\\alpha_m = \\frac{2\\rho_\\infty - 1}{\\rho_\\infty + 1}, \\quad \\alpha_f = \\frac{\\rho_\\infty}{\\rho_\\infty + 1}$$\n$$\\gamma = \\frac{1}{2} - \\alpha_m + \\alpha_f, \\quad \\beta = \\frac{1}{4}(1 - \\alpha_m + \\alpha_f)^2$$\n\n**4. 算法实现**\n\n该算法在一个结构周期 $T$ 内对运动方程进行积分，并计算能量 $W_a$ 和 $W_d$。\n\n1.  **初始化**：对于每个测试用例，计算结构周期 $T = 2\\pi\\sqrt{m/k}$ 和时间步长 $\\Delta t$。计算有效系统参数（$m_{eff}, c_{eff}, k_{eff}$）和广义-$\\alpha$ 参数（$\\alpha_m, \\alpha_f, \\gamma, \\beta$）。根据给定的初始条件 $x_0=A$, $\\dot{x}_0=0$, $\\ddot{x}_0=0$ 初始化位移 $x$、速度 $\\dot{x}$ 和加速度 $\\ddot{x}$ 的状态向量。\n\n2.  **时间步进**：系统从 $t=0$ 推进到 $t=T$。在从 $t_n$ 到 $t_{n+1}$ 的每一步中：\n    a.  目标是求解未知加速度 $\\ddot{x}_{n+1}$。将 Newmark 关系式代入中间状态的定义中，然后代入主运动方程。对于线性系统，这会产生一个关于 $\\ddot{x}_{n+1}$ 的单一线性方程：\n    $$\\ddot{x}_{n+1} [ m_{eff}(1-\\alpha_m) + c_{eff}(1-\\alpha_f)\\gamma\\Delta t + k_{eff}(1-\\alpha_f)\\beta\\Delta t^2 ] = -\\text{RHS}(x_n, \\dot{x}_n, \\ddot{x}_n)$$\n    其中右侧项 $\\text{RHS}$ 包含所有依赖于 $t_n$ 状态的项。\n    b.  一旦 $\\ddot{x}_{n+1}$ 计算出来，就使用显式 Newmark 更新公式找到速度 $\\dot{x}_{n+1}$ 和位移 $x_{n+1}$。\n\n3.  **能量计算**：使用梯形法则在区间 $[0, T]$ 上数值计算功的积分 $W_a$ 和 $W_d$。在每个时间步 $[t_n, t_{n+1}]$ 中，对积分的贡献是：\n    $$\\Delta W_a = \\frac{P_a(t_n) + P_a(t_{n+1})}{2}\\Delta t$$\n    $$\\Delta W_d = \\frac{P_d(t_n) + P_d(t_{n+1})}{2}\\Delta t$$\n    其中功率为 $P_a(t) = (k_a x(t) + c_a \\dot{x}(t) + h_a \\ddot{x}(t))\\dot{x}(t)$ 和 $P_d(t) = c\\dot{x}(t)^2$。这些贡献在所有时间步上求和。\n\n4.  **分类**：在完成一个周期的积分后，计算净能量变化 $\\Delta E_{mech} = W_a - W_d$。当且仅当 $\\Delta E_{mech}$ 严格为正时，系统被分类为物理颤振。在比较中使用一个小的数值容差来处理浮点不精确性，特别是对于中性稳定情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the aeroelastic flutter problem for a set of test cases.\n    \n    This function implements a generalized-alpha time integrator to simulate a\n    single-degree-of-freedom aeroelastic oscillator. It then uses an energy-based\n    criterion to determine if physical flutter occurs.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy-path physical flutter case\n        {'m': 50.0, 'c': 50.0, 'k': 2e5, 'ka': 1e4, 'ca': 120.0, 'ha': 10.0, 'rho_inf': 0.5, 'A': 0.01, 'dt_denom': 500},\n        # 2. Stable case\n        {'m': 50.0, 'c': 50.0, 'k': 2e5, 'ka': 1e4, 'ca': 10.0, 'ha': 10.0, 'rho_inf': 0.5, 'A': 0.01, 'dt_denom': 500},\n        # 3. Near-neutral boundary case\n        {'m': 50.0, 'c': 50.0, 'k': 2e5, 'ka': 1e4, 'ca': 50.0, 'ha': 10.0, 'rho_inf': 0.5, 'A': 0.01, 'dt_denom': 500},\n        # 4. Numerically damped but physically fluttering case\n        {'m': 50.0, 'c': 50.0, 'k': 2e5, 'ka': 1e4, 'ca': 120.0, 'ha': 10.0, 'rho_inf': 0.0, 'A': 0.01, 'dt_denom': 40},\n    ]\n\n    results = []\n    for case in test_cases:\n        is_flutter = run_simulation(**case)\n        results.append(is_flutter)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_simulation(m, c, k, ka, ca, ha, rho_inf, A, dt_denom):\n    \"\"\"\n    Runs a single simulation for a given set of parameters.\n\n    Args:\n        m, c, k: Structural mass, damping, and stiffness.\n        ka, ca, ha: Aerodynamic stiffness, damping, and mass coefficients.\n        rho_inf: Spectral radius at infinity for the generalized-alpha method.\n        A: Initial displacement.\n        dt_denom: Denominator for the time step calculation (dt = T / dt_denom).\n\n    Returns:\n        A boolean indicating if physical flutter is detected.\n    \"\"\"\n    # 1. Setup simulation parameters\n    w_n = np.sqrt(k / m)\n    T = 2 * np.pi / w_n\n    dt = T / dt_denom\n    n_steps = int(round(T / dt))\n\n    # Effective system parameters for the homogeneous equation\n    m_eff = m - ha\n    c_eff = c - ca\n    k_eff = k - ka\n\n    # 2. Generalized-alpha parameters\n    alpha_m = (2 * rho_inf - 1) / (rho_inf + 1)\n    alpha_f = rho_inf / (rho_inf + 1)\n    gamma = 0.5 - alpha_m + alpha_f\n    beta = 0.25 * (1 - alpha_m + alpha_f)**2\n\n    # 3. Initialize state and history arrays\n    x = np.zeros(n_steps + 1)\n    v = np.zeros(n_steps + 1)\n    a = np.zeros(n_steps + 1)\n\n    # Set initial conditions as per problem statement\n    x[0] = A\n    v[0] = 0.0\n    a[0] = 0.0\n    \n    # 4. Time integration loop\n    w_a = 0.0  # Work done by aerodynamic forces\n    w_d = 0.0  # Energy dissipated by structural damping\n\n    # Pre-calculate LHS coefficient, which is constant for a linear system\n    lhs_coeff = m_eff * (1 - alpha_m) + c_eff * (1 - alpha_f) * gamma * dt + k_eff * (1 - alpha_f) * beta * dt**2\n\n    # Calculate initial powers at step n=0 for the trapezoidal rule\n    F_a_n = ka * x[0] + ca * v[0] + ha * a[0]\n    P_a_n = F_a_n * v[0]\n    P_d_n = c * v[0]**2\n\n    for n in range(n_steps):\n        x_n, v_n, a_n = x[n], v[n], a[n]\n        \n        # Predictor-corrector form of Gen-alpha\n        # In this form, we solve for a_n1 from a linear system.\n        # The RHS only contains terms from step n.\n        rhs_term_a = m_eff * alpha_m * a_n\n        rhs_term_v = c_eff * (v_n + (1 - alpha_f) * (1-gamma) * dt * a_n)\n        rhs_term_x = k_eff * (x_n + (1-alpha_f)*dt*v_n + (1-alpha_f)*(0.5-beta)*dt**2*a_n)\n        rhs = -(rhs_term_a + rhs_term_v + rhs_term_x)\n        \n        # Solve for acceleration a_{n+1}\n        a_n1 = rhs / lhs_coeff\n\n        # Update velocity and displacement to get state at n+1 (corrector step)\n        v_n1 = v_n + dt * ((1-gamma)*a_n + gamma*a_n1)\n        x_n1 = x_n + dt*v_n + dt**2 * ((0.5-beta)*a_n + beta*a_n1)\n        \n        x[n+1], v[n+1], a[n+1] = x_n1, v_n1, a_n1\n\n        # 5. Numerically integrate energy/work terms using the trapezoidal rule\n        # Calculate powers at step n+1\n        F_a_n1 = ka * x_n1 + ca * v_n1 + ha * a_n1\n        P_a_n1 = F_a_n1 * v_n1\n        P_d_n1 = c * v_n1**2\n        \n        # Add contribution from interval [t_n, t_{n+1}]\n        w_a += 0.5 * (P_a_n + P_a_n1) * dt\n        w_d += 0.5 * (P_d_n + P_d_n1) * dt\n        \n        # Update powers for the next iteration step\n        P_a_n = P_a_n1\n        P_d_n = P_d_n1\n\n    # 6. Classification based on net energy\n    net_energy = w_a - w_d\n    \n    # Use a small positive tolerance for the strict inequality, as suggested\n    # by the prompt, to handle floating-point artifacts for the neutral case.\n    # A tolerance of 1e-9 is small relative to the expected energy magnitudes.\n    is_flutter = net_energy > 1e-9\n    \n    return is_flutter\n\nsolve()\n```", "id": "3290273"}]}