{"hands_on_practices": [{"introduction": "本练习旨在巩固火焰面模型的基本概念。通过从第一性原理出发，您将学习如何将守恒标量——混合分数($Z$)——与更直观的化学参数——当量比($\\phi$)——进行数学关联。更重要的是，您将运用此关联来分析一个具有重要物理意义的现象，即部分预混对火焰熄火特性的影响，从而将抽象的理论定义与具体的工程问题联系起来 [@problem_id:3318846]。", "problem": "在计算流体力学（CFD）的湍流燃烧小火焰模型中，反应混合物的局部状态由混合分数 $Z$ 参数化，它是两个流股混合过程中的一个守恒标量。考虑一个典型的双流股配置：一个燃料流和一个氧化剂流，它们在不发生反应的情况下混合，通过线性叠加产生局部的反应前质量分数 $Y_{F}(Z)$ 和 $Y_{O}(Z)$。局部当量比 $\\phi$ 定义为实际燃料-氧化剂质量比与其化学计量值的比值，其中单步化学反应表示为 $F + s\\,O \\rightarrow \\text{products}$，$s$ 是化学计量的氧化剂-燃料质量比。为标量输运的目的，假设路易斯数为1且密度恒定。\n\n设燃料流的组成为 $Y_{F,F}$ 和 $Y_{O,F}$，氧化剂流的组成为 $Y_{F,O}$ 和 $Y_{O,O}$。假设混合分数在逆流混合层中的空间依赖关系由下式给出\n$$\nZ(\\xi) = \\frac{1}{2}\\left[1 - \\tanh(\\alpha \\,\\xi)\\right],\n$$\n其中 $\\alpha > 0$ 为常数，$\\xi$ 是垂直于驻点平面的坐标。分子扩散率是一个常数 $D > 0$。标量耗散率为\n$$\n\\chi(\\xi) = 2 D \\left|\\frac{dZ}{d\\xi}\\right|^{2}。\n$$\n在非预混小火焰的意义上，当化学计量表面处的标量耗散率 $\\chi_{st} \\equiv \\chi(\\xi_{st})$（其中 $Z(\\xi_{st}) = Z_{st}$）超过一个与化学反应相关的临界值 $\\chi_{\\text{ext,crit}}$ 时，就会发生熄火。\n\n你需要通过允许氧化剂流中存在非零的燃料背景（由 $Y_{F,O} > 0$ 量化）来分析部分预混情况。仅使用上述定义和线性双流股混合作为基本依据，按以下步骤进行：\n\n1) 对于具有 $Y_{F,F}$、$Y_{O,F}$、$Y_{F,O}$ 和 $Y_{O,O}$ 的通用双流股混合，推导局部当量比 $\\phi$ 和混合分数 $Z$ 之间的映射关系 $\\phi(Z)$。\n\n2) 将问题具体化为一个甲烷-氧气化学反应替代模型，其中 $s = 4$，流股组分如下：\n- 燃料流：$Y_{F,F} = 1$, $Y_{O,F} = 0$。\n- 氧化剂流氧气质量分数：$Y_{O,O} = 0.21$。\n比较两种氧化剂情况：\n(a) 无背景燃料：$Y_{F,O} = 0$。\n(b) 部分预混：$Y_{F,O} = 0.02$。\n对于每种情况，通过施加化学计量混合条件并确定 $\\phi(Z_{st}) = 1$ 的位置，来确定化学计量混合分数 $Z_{st}$。\n\n3) 利用上面给出的 $Z(\\xi)$ 分布，将 $\\chi_{st}$ 表示为仅包含 $Z_{st}$、$D$ 和 $\\alpha$ 的函数，并计算比率\n$$\nR \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0},\n$$\n在比较中保持 $D$、$\\alpha$ 和 $\\chi_{\\text{ext,crit}}$ 不变。该比率量化了由氧化剂流中的背景燃料引起的、由混合控制的熄火倾向的变化。\n\n提供 $R$ 的最终数值，四舍五入到四位有效数字。将你的答案表示为一个无单位的无量纲数。", "solution": "用户要求解答一个关于燃烧理论的多部分问题，具体涉及小火焰模型。我将首先验证题目陈述的有效性，如果有效，则继续进行详细解答。\n\n### 题目验证\n\n#### 步骤 1：提取已知条件\n- **混合分数**：$Z$。$Z$ 是一个守恒标量。\n- **反应前质量分数**：燃料为 $Y_F(Z)$，氧化剂为 $Y_O(Z)$，由线性叠加确定。\n- **局部当量比**：$\\phi = \\frac{Y_F / Y_O}{1/s} = s \\frac{Y_F}{Y_O}$。\n- **单步化学反应**：$F + s\\,O \\rightarrow \\text{products}$。\n- **化学计量氧化剂-燃料质量比**：$s$。\n- **假设**：路易斯数为1，密度恒定。\n- **流股组分**：\n    - 燃料流：质量分数 $Y_{F,F}$ 和 $Y_{O,F}$。\n    - 氧化剂流：质量分数 $Y_{F,O}$ 和 $Y_{O,O}$。\n- **混合分数空间分布**：$Z(\\xi) = \\frac{1}{2}\\left[1 - \\tanh(\\alpha \\,\\xi)\\right]$，常数 $\\alpha > 0$。$\\xi$ 是垂直于驻点平面的坐标。\n- **分子扩散率**：常数 $D > 0$。\n- **标量耗散率**：$\\chi(\\xi) = 2 D \\left|\\frac{dZ}{d\\xi}\\right|^{2}$。\n- **化学计量标量耗散率**：$\\chi_{st} \\equiv \\chi(\\xi_{st})$，其中 $Z(\\xi_{st}) = Z_{st}$。\n- **熄火条件**：当 $\\chi_{st}$ 超过临界值 $\\chi_{\\text{ext,crit}}$ 时发生熄火。\n- **第2和第3部分的数值**：\n    - $s = 4$。\n    - 燃料流：$Y_{F,F} = 1$, $Y_{O,F} = 0$。\n    - 氧化剂流：$Y_{O,O} = 0.21$。\n    - 情况 (a)：无背景燃料，$Y_{F,O} = 0$。\n    - 情况 (b)：部分预混，$Y_{F,O} = 0.02$。\n- **要求输出**：比率 $R \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0}$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于燃烧科学中成熟的小火焰概念，这是湍流燃烧建模的基石。混合分数、当量比和标量耗散率的定义都是该领域的标准。该设置描述了一个典型的逆流混合问题。所有方面都牢固地植根于化学工程和流体力学的原理。\n- **问题良定性**：问题被构造成一系列推导和计算。每个步骤都从上一步逻辑地得出。给定的信息足以推导出所要求比率 $R$ 的唯一解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观或基于意见的陈述。\n- **其他检查**：问题是自洽的，提供了所有必要的定义和数据。没有矛盾之处。该设置是燃烧研究中使用的标准理想化模型，因此就其目的而言是科学上合理的。问题是实质性的，需要基于基本原理进行一系列推理。\n\n#### 步骤 3：结论与行动\n该题目是有效的。这是一个来自计算流体力学和燃烧理论领域的、问题良定、科学合理且客观的问题。我将继续进行详细解答。\n\n### 解答\n\n解答过程按照题目要求分为三个部分构建。\n\n#### 1) $\\phi(Z)$ 映射关系的推导\n\n燃料的局部质量分数 $Y_F(Z)$ 和氧化剂的局部质量分数 $Y_O(Z)$ 由燃料流（在 $Z=1$ 处）和氧化剂流（在 $Z=0$ 处）之间的线性混合法则给出。在题目的符号体系中，流股组分中燃料流用下标 $F$ 表示，氧化剂流用下标 $O$ 表示，混合法则是：\n$$\nY_F(Z) = Z \\cdot Y_{F,F} + (1-Z) \\cdot Y_{F,O}\n$$\n$$\nY_O(Z) = Z \\cdot Y_{O,F} + (1-Z) \\cdot Y_{O,O}\n$$\n局部当量比 $\\phi$ 定义为实际燃料-氧化剂比率除以化学计量燃料-氧化剂比率（$1/s$）：\n$$\n\\phi = s \\frac{Y_F}{Y_O}\n$$\n将 $Y_F(Z)$ 和 $Y_O(Z)$ 的线性混合法则代入 $\\phi$ 的定义，得到映射关系 $\\phi(Z)$：\n$$\n\\phi(Z) = s \\frac{Z Y_{F,F} + (1-Z) Y_{F,O}}{Z Y_{O,F} + (1-Z) Y_{O,O}}\n$$\n这是给定双流股混合构型下，局部当量比和混合分数之间的一般关系。\n\n#### 2) 化学计量混合分数 $Z_{st}$ 的确定\n\n化学计量混合分数 $Z_{st}$ 是混合物处于化学计量状态时的 $Z$ 值，即 $\\phi(Z_{st}) = 1$。将 $\\phi(Z)$ 的表达式设为 1，得到：\n$$\n1 = s \\frac{Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O}}{Z_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O}}\n$$\n为了求解 $Z_{st}$，我们重排该方程：\n$$\nZ_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O} = s \\left( Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O} \\right)\n$$\n$$\nZ_{st} Y_{O,F} + Y_{O,O} - Z_{st} Y_{O,O} = s Z_{st} Y_{F,F} + s Y_{F,O} - s Z_{st} Y_{F,O}\n$$\n合并包含 $Z_{st}$ 的项：\n$$\nY_{O,O} - s Y_{F,O} = Z_{st} \\left( s Y_{F,F} - s Y_{F,O} - Y_{O,F} + Y_{O,O} \\right)\n$$\n分离 $Z_{st}$ 得到通解：\n$$\nZ_{st} = \\frac{Y_{O,O} - s Y_{F,O}}{s Y_{F,F} + Y_{O,O} - Y_{O,F} - s Y_{F,O}}\n$$\n我们现在使用给定的数值将此结果具体化：$s=4$，$Y_{F,F}=1$，$Y_{O,F}=0$，$Y_{O,O}=0.21$。$Z_{st}$ 的表达式变为：\n$$\nZ_{st} = \\frac{0.21 - 4 Y_{F,O}}{4(1) + 0.21 - 0 - 4 Y_{F,O}} = \\frac{0.21 - 4 Y_{F,O}}{4.21 - 4 Y_{F,O}}\n$$\n我们针对两种指定情况对此进行评估。\n\n(a) 无背景燃料：$Y_{F,O} = 0$。\n$$\nZ_{st,a} = \\frac{0.21 - 4(0)}{4.21 - 4(0)} = \\frac{0.21}{4.21}\n$$\n\n(b) 部分预混：$Y_{F,O} = 0.02$。\n$$\nZ_{st,b} = \\frac{0.21 - 4(0.02)}{4.21 - 4(0.02)} = \\frac{0.21 - 0.08}{4.21 - 0.08} = \\frac{0.13}{4.13}\n$$\n\n#### 3) 比率 $R$ 的计算\n\n首先，我们推导标量耗散率 $\\chi_{st}$ 作为 $Z_{st}$ 的函数的表达式。标量耗散率由 $\\chi(\\xi) = 2 D |dZ/d\\xi|^2$ 给出。我们需要从给定的分布 $Z(\\xi) = \\frac{1}{2}[1 - \\tanh(\\alpha \\xi)]$ 中求出导数 $dZ/d\\xi$。\n$$\n\\frac{dZ}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{1}{2} - \\frac{1}{2}\\tanh(\\alpha \\xi) \\right) = -\\frac{1}{2} \\text{sech}^2(\\alpha \\xi) \\cdot \\alpha = -\\frac{\\alpha}{2} \\text{sech}^2(\\alpha \\xi)\n$$\n我们需要用 $Z$ 来表示这个导数。根据 $Z(\\xi)$ 的定义，我们有 $2Z = 1 - \\tanh(\\alpha\\xi)$，这给出 $\\tanh(\\alpha\\xi) = 1-2Z$。使用恒等式 $\\text{sech}^2(x) = 1 - \\tanh^2(x)$，我们发现：\n$$\n\\text{sech}^2(\\alpha\\xi) = 1 - \\left(1-2Z\\right)^2 = 1 - \\left(1 - 4Z + 4Z^2\\right) = 4Z - 4Z^2 = 4Z(1-Z)\n$$\n将此代回导数中：\n$$\n\\frac{dZ}{d\\xi} = -\\frac{\\alpha}{2} \\left[ 4Z(1-Z) \\right] = -2\\alpha Z(1-Z)\n$$\n现在，我们可以将 $\\chi$ 写成 $Z$ 的函数：\n$$\n\\chi(Z) = 2 D \\left| -2\\alpha Z(1-Z) \\right|^2 = 2 D \\left[ 4\\alpha^2 Z^2(1-Z)^2 \\right] = 8D\\alpha^2 Z^2(1-Z)^2\n$$\n化学计量表面处的标量耗散率 $\\chi_{st}$ 通过将此表达式在 $Z=Z_{st}$ 处求值得到：\n$$\n\\chi_{st} = 8D\\alpha^2 Z_{st}^2(1-Z_{st})^2\n$$\n题目要求我们计算比率 $R \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0}$。使用 $\\chi_{st}$ 的表达式，并分别用下标 $b$ 和 $a$ 表示两种情况：\n$$\nR = \\frac{8D\\alpha^2 Z_{st,b}^2(1-Z_{st,b})^2}{8D\\alpha^2 Z_{st,a}^2(1-Z_{st,a})^2}\n$$\n常数 $8D\\alpha^2$ 被消去，因为它们保持不变：\n$$\nR = \\left( \\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\right)^2\n$$\n让我们为每种情况计算 $Z(1-Z)$ 项。\n对于情况 (a)：\n$$\nZ_{st,a}(1-Z_{st,a}) = \\frac{0.21}{4.21} \\left(1 - \\frac{0.21}{4.21}\\right) = \\frac{0.21}{4.21} \\left(\\frac{4.21-0.21}{4.21}\\right) = \\frac{0.21 \\times 4.00}{(4.21)^2} = \\frac{0.84}{(4.21)^2}\n$$\n对于情况 (b)：\n$$\nZ_{st,b}(1-Z_{st,b}) = \\frac{0.13}{4.13} \\left(1 - \\frac{0.13}{4.13}\\right) = \\frac{0.13}{4.13} \\left(\\frac{4.13-0.13}{4.13}\\right) = \\frac{0.13 \\times 4.00}{(4.13)^2} = \\frac{0.52}{(4.13)^2}\n$$\n现在我们计算这些项的比率：\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} = \\frac{0.52 / (4.13)^2}{0.84 / (4.21)^2} = \\frac{0.52}{0.84} \\times \\left(\\frac{4.21}{4.13}\\right)^2\n$$\n现在我们计算数值：\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\approx \\frac{0.52}{0.84} \\times (1.019370...)^2 \\approx 0.619047... \\times 1.039116... \\approx 0.643265...\n$$\n最后，我们将此值平方来计算 $R$：\n$$\nR = (0.643265...)^2 \\approx 0.413790...\n$$\n四舍五入到四位有效数字，我们得到 $R \\approx 0.4138$。", "answer": "$$\\boxed{0.4138}$$", "id": "3318846"}, {"introduction": "将理论模型转化为计算流体动力学(CFD)仿真中的实用工具，需要开发稳健的数值算法。火焰面解在某些参数区间内常常表现出多值响应，即著名的“S形曲线”，这在数值上可能导致不稳定甚至使仿真失败。本实践 [@problem_id:3318797] 将指导您设计并实现一个连续且稳健的查表算法，以处理这一关键的数值挑战，这是开发和应用燃烧模型的工程师必须掌握的核心技能。", "problem": "您的任务是设计并测试一个鲁棒的分支感知属性查找算法，该算法用于基于小火焰的燃烧模型。该算法通过使用一个源自$S$曲线拓扑结构的分支指示器，来强制实现点火-熄灭分支间的连续性。请在无量纲环境下工作，以避免使用物理单位。您的实现必须是完全自包含的，并能产生确定性的结果。\n\n起点和基本依据：\n- 考虑在湍流燃烧的小火焰区域中出现的稳态、混合分数条件下的进程变量平衡。在该区域中，局部混合分数$Z$是一个守恒标量，而化学计量混合分数处的化学计量标量耗散率（SDR），记为$\\chi_{st}$，控制着扩散混合时间尺度。在稳态小火焰近似中，归一化进程变量$C \\in [0,1]$的输运方程中，扩散项和反应源项的平衡产生了一个非线性代数关系。当由$\\chi_{st}$参数化时，该关系呈现出$S$形响应。\n- 使用一个通过临界点附近的渐近简化得到的流形的简化无量纲替代模型，其中进程变量$C$满足代数约束\n$$\nF(C;\\chi_{st}) \\equiv C^3 - \\alpha C + \\beta(\\chi_{st}) = 0,\n$$\n其中参数$\\alpha > 0$以及$\\beta(\\chi_{st}) = \\kappa(\\chi_{st}-\\chi_0)$，$\\kappa>0$和$\\chi_0$为常数。这种三次范式捕捉了由反应与扩散之间的竞争所产生的$S$曲线拓扑结构。判别式条件\n$$\n\\Delta(\\chi_{st}) = 4\\alpha^3 - 27\\beta(\\chi_{st})^2\n$$\n决定了是存在$3$个实数解（$\\Delta>0$），对应于熄灭、不稳定和点火分支，还是只存在一个实数解（$\\Delta \\le 0$）。\n\n您的任务：\n1. 从$S$曲线拓扑结构的角度，推导一个光滑的分支指示器，用于区分下部和上部稳定分支。该指示器仅使用可以从给定$\\chi_{st}$下$F(C;\\chi_{st})=0$的根计算得出的局部信息。该指示器必须：\n   - 将目标进程变量$C_t$映射到一个连续权重$w \\in [0,1]$，使得在下部稳定分支附近$w \\approx 0$，在上部稳定分支附近$w \\approx 1$。\n   - 该指示器关于$C_t$与一个您使用$S$曲线几何结构定义的、具有拓扑意义的分界线（例如，位于下部和上部稳定根之间的一个位置）之间的有符号距离是单调的。\n   - 在只有一个实数根存在的单值区域（$\\Delta \\le 0$）简化为一个常数。\n2. 使用第1部分中的指示器，为标量“表”量$q$构建一个分支感知的查找。该量由流形固定并取决于分支。对于此问题，设$q$等于流形进程变量，即$q(C;\\chi_{st},Z) = C$，在适当的稳定分支上取值。当在给定$\\chi_{st}$下存在3个实数根时，通过使用您的指示器$w$对下部和上部稳定流形值进行凸组合来强制实现连续性，同时排除不稳定的根：\n   - 如果在$\\chi_{st}$处存在3个实数根，将有序的根表示为$C_{low}(\\chi_{st}) \\le C_{mid}(\\chi_{st}) \\le C_{high}(\\chi_{st})$。您的查找应返回一个连续值$q^{lookup}(\\chi_{st},Z,C_t)$，该值根据您的指示器混合下部和上部稳定分支，并取决于$C_t$。\n   - 如果只有一个实数根，则返回该根作为查找结果，且与$C_t$无关。\n3. 展示您的方法在分支合并的临界化学计量标量耗散率附近的鲁棒性。从三次判别式确定折叠点位置。令\n$$\n\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,\\alpha^{3/2}, \\quad \\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa}.\n$$\n您将测试当$\\chi_{st}$接近$\\chi_{crit}^{+}$时的行为。\n\n测试套件和参数：\n- 使用以下无量纲参数值：\n  - $\\alpha = 1.0$, $\\kappa = 1.0$, $\\chi_0 = 1.0$。\n  - 指示器的平滑尺度：$\\delta = 2\\times 10^{-2}$。\n  - 对于任何具有3个实数根的$\\chi_{st}$，将$C_{low}(\\chi_{st})$和$C_{high}(\\chi_{st})$分别定义为最小和最大的实数根。将该$\\chi_{st}$处的分界线定义为$C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$。\n- 按此确切顺序，使用指定的偏移量计算以下五个定量指标：\n  $1.$ 中心，下分支保真度：设$\\chi_{st} = \\chi_0$，计算$C_{low}(\\chi_0)$并设$C_t = C_{low}(\\chi_0) + 10^{-2}$。计算绝对误差\n  $$\n  e_{low} = \\left|\\,q^{lookup}(\\chi_0,Z,C_t) - C_{low}(\\chi_0)\\,\\right|.\n  $$\n  $2.$ 中心，上分支保真度：设$\\chi_{st} = \\chi_0$，计算$C_{high}(\\chi_0)$并设$C_t = C_{high}(\\chi_0) - 10^{-2}$。计算\n  $$\n  e_{high} = \\left|\\,q^{lookup}(\\chi_0,Z,C_t) - C_{high}(\\chi_0)\\,\\right|.\n  $$\n  $3.$ 跨分界线的连续性：设$\\chi_{st} = \\chi_0$，计算$C_{sep}(\\chi_0)$并令$\\varepsilon = 10^{-4}$。计算连续性跳跃\n  $$\n  J = \\left|\\,q^{lookup}\\big(\\chi_0,Z,C_{sep}(\\chi_0)+\\varepsilon\\big) - q^{lookup}\\big(\\chi_0,Z,C_{sep}(\\chi_0)-\\varepsilon\\big)\\,\\right|.\n  $$\n  $4.$ 近折叠点，上分支保真度：设$\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$，计算$C_{high}(\\chi_{st})$，设$C_t = C_{high}(\\chi_{st}) - 10^{-3}$。计算\n  $$\n  e_{fold} = \\left|\\,q^{lookup}(\\chi_{st},Z,C_t) - C_{high}(\\chi_{st})\\,\\right|.\n  $$\n  $5.$ 跨折叠点鲁棒性：设$\\chi_1 = \\chi_{crit}^{+} - 10^{-4}$，$\\chi_2 = \\chi_{crit}^{+} + 10^{-4}$，计算$C_{sep}(\\chi_1)$，并评估\n  $$\n  D = \\left|\\,q^{lookup}(\\chi_2,Z,C_{sep}(\\chi_1)) - q^{lookup}(\\chi_1,Z,C_{sep}(\\chi_1))\\,\\right|.\n  $$\n- 在此问题中，混合分数$Z$是一个虚拟输入；将$q$视为与$Z$无关，以隔离分支处理。\n- 您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序严格为$[e_{low},e_{high},J,e_{fold},D]$。将每个条目表示为至少包含小数点后六位的小数浮点数。\n\n约束和要求：\n- 您的推导必须基于$S$曲线拓扑和判别式所隐含的折叠结构，而不是任何仅通过对$\\chi_{st}$设置阈值来进行的临时的if-else案例选择。\n- 指示器必须在远离折叠点处对$C_t$和$\\chi_{st}$是光滑的，并且不得使用任何$C_t$的不连续函数。\n- 算法必须能鲁棒地处理根合并的接近临界的$\\chi_{st}$值，而不会产生未定义值或非数值（NaN）结果。\n- 假设所有量都是无量纲的；不要附加物理单位。", "solution": "## 问题验证\n\n### 步骤1：提取给定条件\n- **控制方程**：进程变量$C$是代数方程$F(C;\\chi_{st}) = C^3 - \\alpha C + \\beta(\\chi_{st}) = 0$的一个实根。\n- **参数**：\n  - $\\alpha > 0$ 是一个常数。\n  - $\\beta(\\chi_{st}) = \\kappa(\\chi_{st}-\\chi_0)$，其中$\\kappa > 0$和$\\chi_0$是常数。\n  - $\\chi_{st}$是化学计量标量耗散率（SDR）。\n- **判别式**：$\\Delta(\\chi_{st}) = 4\\alpha^3 - 27\\beta(\\chi_{st})^2$。\n- **根结构**：\n  - 如果$\\Delta > 0$：3个实根（$C_{low} \\le C_{mid} \\le C_{high}$）。\n  - 如果$\\Delta \\le 0$：1个实根。\n- **任务1（分支指示器）**：\n  - 推导一个光滑分支指示器$w(C_t)$，其中$C_t$是目标进程变量。\n  - $w \\in [0,1]$。\n  - 在下部稳定分支附近$w \\approx 0$，在上部稳定分支附近$w \\approx 1$。\n  - 关于$C_t$与分界线之间的有符号距离是单调的。\n  - 在单值区域（$\\Delta \\le 0$）为常数。\n- **任务2（分支感知查找）**：\n  - 查找量为$q(C;\\chi_{st},Z) = C$。混合分数$Z$是一个虚拟变量。\n  - 如果存在3个根，查找值为$q^{lookup} = (1-w)C_{low} + wC_{high}$。\n  - 如果存在1个根，查找值为该单个根。\n- **临界点**：\n  - $\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,\\alpha^{3/2}$。\n  - $\\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa}$。\n- **测试套件参数**：\n  - $\\alpha = 1.0$, $\\kappa = 1.0$, $\\chi_0 = 1.0$。\n  - 平滑尺度$\\delta = 2\\times 10^{-2}$。\n  - 分界线定义：$C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$。\n- **待计算指标**：\n  1. $e_{low} = |q^{lookup}(\\chi_0,Z,C_{low}(\\chi_0) + 10^{-2}) - C_{low}(\\chi_0)|$。\n  2. $e_{high} = |q^{lookup}(\\chi_0,Z,C_{high}(\\chi_0) - 10^{-2}) - C_{high}(\\chi_0)|$。\n  3. $J = |q^{lookup}(\\chi_0,Z,C_{sep}(\\chi_0)+\\varepsilon) - q^{lookup}(\\chi_0,Z,C_{sep}(\\chi_0)-\\varepsilon)|$，其中$\\varepsilon=10^{-4}$。\n  4. $e_{fold} = |q^{lookup}(\\chi_{st},Z,C_t) - C_{high}(\\chi_{st})|$，其中$\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$，$C_t = C_{high}(\\chi_{st}) - 10^{-3}$。\n  5. $D = |q^{lookup}(\\chi_2,Z,C_{sep}(\\chi_1)) - q^{lookup}(\\chi_1,Z,C_{sep}(\\chi_1))|$，其中$\\chi_1 = \\chi_{crit}^{+} - 10^{-4}$，$\\chi_2 = \\chi_{crit}^{+} + 10^{-4}$。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据充分**：该问题植根于燃烧领域已建立的小火焰模型理论，使用了一个典型的三次方程，它代表了尖点灾变的范式，精确地描述了点火-熄灭（$S$曲线）现象。所有概念都是该领域的标准概念。\n- **适定性**：该问题设定了一个清晰、确定性的计算任务。所有参数、方程和测试条件都已明确定义，从而得到一组唯一的数值结果。\n- **客观性**：语言精确且量化。任务涉及特定算法的推导和实现，并报告客观的数值指标。\n\n基于此，该问题是**有效的**。它是在计算流体动力学和燃烧理论背景下应用数值方法的一个定义明确的问题。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供一个完整的解决方案。\n\n---\n\n### 第1部分：分支指示器的推导\n问题要求一个光滑分支指示器$w$来区分$S$曲线的下部（$C_{low}$）和上部（$C_{high}$）稳定分支。该指示器必须是目标进程变量$C_t$的函数，并应映射到区间$[0,1]$。\n提供的分界线$C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$，为两个稳定分支的影响域提供了一条自然的分界线。$C_t$与此分界线之间的有符号距离$d = C_t - C_{sep}$可用于构建该指示器。\n\n一个能从$0$平滑过渡到$1$的合适函数是经过适当缩放的双曲正切函数。我们将分支指示器$w$定义为：\n$$\nw(C_t; \\chi_{st}) = \\frac{1}{2}\\left[ 1 + \\tanh\\left(\\frac{C_t - C_{sep}(\\chi_{st})}{\\delta}\\right) \\right]\n$$\n其中$\\delta$是指定的平滑尺度。该指示器满足所需属性：\n- 它是$C_t$（以及通过$C_{sep}$依赖于$\\chi_{st}$）的一个光滑、可微的函数。\n- 当$C_t \\to -\\infty$时，$\\tanh$的参数变得很大且为负，因此$\\tanh \\to -1$，$w \\to 0$。这对应于下部分支。\n- 当$C_t \\to +\\infty$时，$\\tanh$的参数变得很大且为正，因此$\\tanh \\to 1$，$w \\to 1$。这对应于上部分支。\n- 它随$C_t$单调递增，因此也随与分界线的有符号距离单调递增。\n\n该指示器仅在多值区域（$\\Delta > 0$）中定义，其中$C_{low}$和$C_{high}$是不同的。根据问题描述，整个查找算法将分别处理单值区域。\n\n### 第2部分：分支感知查找算法的构建\n用于量$q$（此处$q=C$）的分支感知查找算法将标量耗散率$\\chi_{st}$和目标进程变量$C_t$作为输入。算法流程如下：\n\n1.  **计算状态参数**：给定$\\chi_{st}$，计算$\\beta = \\kappa(\\chi_{st} - \\chi_0)$。\n2.  **确定流形拓扑**：计算判别式$\\Delta = 4\\alpha^3 - 27\\beta^2$。\n3.  **执行查找**：\n    - **如果$\\Delta \\le 0$（单值区域）**：方程$C^3 - \\alpha C + \\beta = 0$只有一个实根。算法必须找到这个根$C_{single}$并返回它。查找结果与$C_t$无关。\n      $$\n      q^{lookup}(\\chi_{st}, Z, C_t) = C_{single}(\\chi_{st})\n      $$\n    - **如果$\\Delta > 0$（多值区域）**：存在三个实根。算法必须找到并排序它们：$C_{low} \\le C_{mid} \\le C_{high}$。外侧的两个根$C_{low}$和$C_{high}$分别对应于稳定的下部（熄灭）和上部（点燃）分支。中间的根$C_{mid}$是不稳定的，被排除在查找之外。\n        - 首先，计算分界线：$C_{sep} = \\tfrac{1}{2}(C_{low} + C_{high})$。\n        - 接下来，使用第1部分的公式计算分支指示器：$w = \\frac{1}{2}\\left[ 1 + \\tanh\\left(\\frac{C_t - C_{sep}}{\\delta}\\right) \\right]$。\n        - 最后，将查找值计算为稳定分支值的凸组合：\n          $$\n          q^{lookup}(\\chi_{st}, Z, C_t) = (1 - w)C_{low}(\\chi_{st}) + w C_{high}(\\chi_{st})\n          $$\n这种构造确保了对于多值区域中的给定$\\chi_{st}$，当目标场变量$C_t$穿过分界线时，查找提供从$C_{low}$到$C_{high}$的连续过渡。\n\n### 第3部分：算法实现与测试套件\n\n该算法使用`numpy`库在Python中实现，主要用于数值运算，特别是求解三次多项式的根。测试套件要求根据指定参数计算五个指标。\n\n首先，我们确定临界值。$S$曲线的折叠点发生在$\\Delta=0$时，这意味着$\\beta = \\pm\\beta_{crit}$。\n给定$\\alpha=1.0$, $\\kappa=1.0$, $\\chi_0=1.0$：\n$\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,(1.0)^{3/2} = \\frac{2}{3\\sqrt{3}} \\approx 0.38490018$。\n相应的临界$\\chi_{st}$值为：\n$\\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa} = 1.0 \\pm \\beta_{crit}$。\n上界值$\\chi_{crit}^{+} = 1.0 + \\beta_{crit} \\approx 1.38490018$对应于熄灭转折点，在该点上部和中部自分支合并（在$C = \\sqrt{\\alpha/3} = 1/\\sqrt{3}$处）。\n\n五个指标计算如下：\n1.  **$e_{low}$**：在$\\chi_{st}=1.0$时，$\\beta=0$，根为$C_{low}=-1, C_{mid}=0, C_{high}=1$。$C_{sep}=0$。当$C_t = -1.0 + 10^{-2} = -0.99$时，$C_t$远低于$C_{sep}$，因此$w \\approx 0$，$q^{lookup} \\approx C_{low}$。误差将非常小。\n2.  **$e_{high}$**：在$\\chi_{st}=1.0$时，当$C_t = 1.0 - 10^{-2} = 0.99$时，$C_t$远高于$C_{sep}$，因此$w \\approx 1$，$q^{lookup} \\approx C_{high}$。误差也将非常小。\n3.  **$J$**：在$\\chi_{st}=1.0$时，我们在$C_{sep}=0$的两侧评估查找值。其差值衡量了过渡区域的陡峭程度，由$\\delta$控制。对于小参数，$\\tanh(x) \\approx x$，所以$J \\approx 2 \\cdot \\tanh(\\varepsilon/\\delta) \\approx 2\\varepsilon/\\delta = 2 \\cdot 10^{-4} / (2 \\cdot 10^{-2}) = 0.01$。\n4.  **$e_{fold}$**：此处，$\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$正好在多值区域内，靠近熄灭折叠点。根$C_{mid}$和$C_{high}$非常接近。目标$C_t = C_{high} - 10^{-3}$相对于平滑尺度$\\delta$仍然远离分界线$C_{sep}$，因此$w$将非常接近1，查找将是准确的。\n5.  **$D$**：该指标量化了当$C_t$固定在折叠前分界线值$C_{sep}(\\chi_1)$时，穿越折叠点的查找过程的不连续性。对于$\\chi_1$，$q^{lookup}$的评估值为$C_{sep}(\\chi_1)$。对于$\\chi_2 > \\chi_{crit}^{+}$，系统有一个单根，它是$C_{low}$分支的延续。值$D = |C_{single}(\\chi_2) - C_{sep}(\\chi_1)|$测量了跳跃，预计会很显著，因为$C_{sep}$被定义为相距甚远的$C_{low}$和$C_{high}$根的中点。\n\n提供的Python代码实现了此逻辑并计算了指定的指标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: No scipy functions are needed as numpy.tanh is sufficient.\n\ndef solve():\n    \"\"\"\n    Implements the branch-aware lookup algorithm and runs the test suite\n    as specified in the problem statement.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # The 'test_cases' structure is not used directly as the tests are specific.\n    # Instead, we define the global parameters for the problem.\n    alpha = 1.0\n    kappa = 1.0\n    chi0 = 1.0\n    delta = 2e-2\n    dummy_z = 0.0 # Placeholder for the dummy mixture fraction variable\n\n    def find_real_roots(chi_st_val):\n        \"\"\"\n        Finds the real roots of the cubic equation C^3 - alpha*C + beta = 0\n        for a given chi_st value.\n        \"\"\"\n        beta_val = kappa * (chi_st_val - chi0)\n        coeffs = [1, 0, -alpha, beta_val]\n        all_roots = np.roots(coeffs)\n        # Filter for real roots (imaginary part is close to zero)\n        real_roots = all_roots[np.isclose(all_roots.imag, 0)].real\n        return np.sort(real_roots)\n\n    def q_lookup(chi_st_val, z_val, C_t_val):\n        \"\"\"\n        Constructs the branch-aware lookup for the scalar quantity q.\n        The variable z_val is ignored as per the problem description.\n        \"\"\"\n        beta_val = kappa * (chi_st_val - chi0)\n        discriminant = 4 * alpha**3 - 27 * beta_val**2\n\n        # Case 1: Single real root exists\n        if discriminant = 0:\n            roots = find_real_roots(chi_st_val)\n            # In edge cases (at the fold), numerical precision might yield\n            # a double root. Taking the mean is a robust way to handle this.\n            return np.mean(roots)\n        \n        # Case 2: Three real roots exist\n        else:\n            roots = find_real_roots(chi_st_val)\n            C_low, _, C_high = roots\n            \n            # Define the separatrix based on the two stable roots\n            C_sep = 0.5 * (C_low + C_high)\n            \n            # Calculate the smooth branch indicator weight 'w'\n            tanh_arg = (C_t_val - C_sep) / delta\n            w = 0.5 * (1 + np.tanh(tanh_arg))\n            \n            # Form the convex combination of the stable branch values\n            q_val = (1 - w) * C_low + w * C_high\n            return q_val\n\n    # Main logic to calculate the five specified metrics\n    results = []\n    \n    # --- Pre-computation of critical values ---\n    beta_crit = (2 / (3 * np.sqrt(3))) * alpha**(3/2)\n    chi_crit_p = chi0 + beta_crit / kappa\n\n    # --- Metric 1: Center, lower-branch fidelity (e_low) ---\n    chi_st_1 = chi0\n    # For chi_st=chi0, beta=0. The roots are -1, 0, 1. So C_low=-1.\n    C_low_1 = -1.0\n    C_t_1 = C_low_1 + 1e-2\n    q_lookup_1 = q_lookup(chi_st_1, dummy_z, C_t_1)\n    e_low = abs(q_lookup_1 - C_low_1)\n    results.append(e_low)\n\n    # --- Metric 2: Center, upper-branch fidelity (e_high) ---\n    chi_st_2 = chi0\n    # For chi_st=chi0, beta=0. The roots are -1, 0, 1. So C_high=1.\n    C_high_2 = 1.0\n    C_t_2 = C_high_2 - 1e-2\n    q_lookup_2 = q_lookup(chi_st_2, dummy_z, C_t_2)\n    e_high = abs(q_lookup_2 - C_high_2)\n    results.append(e_high)\n\n    # --- Metric 3: Continuity across the separatrix (J) ---\n    chi_st_3 = chi0\n    epsilon = 1e-4\n    # For chi_st=chi0, C_sep = 0.5 * (-1 + 1) = 0.\n    C_sep_3 = 0.0\n    q_lookup_3_plus = q_lookup(chi_st_3, dummy_z, C_sep_3 + epsilon)\n    q_lookup_3_minus = q_lookup(chi_st_3, dummy_z, C_sep_3 - epsilon)\n    J = abs(q_lookup_3_plus - q_lookup_3_minus)\n    results.append(J)\n\n    # --- Metric 4: Near-fold, upper-branch fidelity (e_fold) ---\n    chi_st_4 = chi_crit_p - 1e-4\n    roots_4 = find_real_roots(chi_st_4)\n    _, _, C_high_4 = roots_4\n    C_t_4 = C_high_4 - 1e-3\n    q_lookup_4 = q_lookup(chi_st_4, dummy_z, C_t_4)\n    e_fold = abs(q_lookup_4 - C_high_4)\n    results.append(e_fold)\n\n    # --- Metric 5: Across-fold robustness (D) ---\n    chi1_5 = chi_crit_p - 1e-4\n    chi2_5 = chi_crit_p + 1e-4\n\n    # Calculate q1 at chi1 (3-root region)\n    roots_5_1 = find_real_roots(chi1_5)\n    C_low_5_1, _, C_high_5_1 = roots_5_1\n    C_sep_5_1 = 0.5 * (C_low_5_1 + C_high_5_1)\n    # The query is at C_t = C_sep_5_1\n    q1 = q_lookup(chi1_5, dummy_z, C_sep_5_1)\n\n    # Calculate q2 at chi2 (1-root region)\n    # The C_t value (C_sep_5_1) is irrelevant for the single-root case\n    q2 = q_lookup(chi2_5, dummy_z, C_sep_5_1)\n    \n    D = abs(q2 - q1)\n    results.append(D)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3318797"}, {"introduction": "火焰面模型是进行湍流火焰大涡模拟(LES)的强大工具，但其成功应用依赖于对亚格子尺度(SGS)项的精确建模。本练习 [@problem_id:3318856] 将提供一个典型的现代湍流燃烧建模工作流程的实践经验。您将学习如何利用高保真度的直接数值模拟(DNS)数据，来校准一个用于描述反应进度变量方差产生项的亚格子模型，从而掌握连接理论、数据与建模实践的关键环节。", "problem": "您的任务是，在使用基于小火焰方法对湍流反应流进行大涡模拟 (LES) 时，推导、实现和校准一个用于法沃尔 (Favre) 滤波的进程变量方差生成的亚网格模型。\n\n考虑一个定义为产物质量分数归一化线性组合的进程变量，记为 $c$（其中 $0 \\le c \\le 1$），其反应源项记为 $\\dot{\\omega}_c$。在基于小火焰的建模框架中，滤波后的源项 $\\tilde{\\dot{\\omega}}_c$ 是通过从一个预先计算的层流稳态小火焰库中，作为混合分数及其矩的函数进行查找得到的；然而，在本问题中，所需的滤波后梯度是直接给出的。\n\n从 $c$ 的滤波（法沃尔）方差（记为 $\\widetilde{c''^2}$）开始，其中 $c'' = c - \\tilde{c}$ 表示 $c$ 的法沃尔脉动。方差生成的一个贡献项来自 $c$ 和 $\\dot{\\omega}_c$ 之间的协方差，即 $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$。对 $c$ 和 $\\dot{\\omega}_c$ 之间的未解析协方差使用以下形式的广义梯度模型\n$$\n\\tau(c,\\dot{\\omega}_c) \\equiv \\widetilde{c \\, \\dot{\\omega}_c} - \\tilde{c} \\, \\tilde{\\dot{\\omega}}_c \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c,\n$$\n其中 $C_g$ 是一个待校准的未知无量纲模型系数，$\\Delta$ 是 LES 滤波宽度（单位为 $\\mathrm{m}$），重复的索引表示求和。假设密度变化适中，因此对于所提供的数据集，法沃尔协方差和雷诺协方差近似相等，并且分子输运效应不显式地进入当前的校准过程。\n\n您的任务是：\n1. 推导由亚网格热释放引起的方差生成项 $P_\\omega$ 的模型表达式，用 $C_g$、$\\Delta$、$\\nabla \\tilde{c}$ 和 $\\nabla \\tilde{\\dot{\\omega}}_c$ 表示。清晰地说明 $P_\\omega$ 的单位。\n2. 通过最小化直接数值模拟 (DNS) 估计的 $\\tau(c,\\dot{\\omega}_c)$ 与广义梯度模型预测值 $C_g \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ 之间的均方误差来校准 $C_g$。使用以下校准数据集，该数据集代表了在不同 $\\Delta$ 下滤波的引燃射流火焰 DNS 结果：\n   - 情况 #1：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.6666666666666668 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 #2：$\\Delta = 1.5 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [800, \\, 600, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 30, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.0875 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 #3：$\\Delta = 0.8 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [-500, \\, 400, \\, 100] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, -120, \\, 40] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = -7.68 \\times 10^{-3} \\ \\mathrm{s}^{-1}$。\n   - 情况 #4：$\\Delta = 1.2 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [0, \\, 1000, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 100, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.2 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 #5：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [300, \\, -400, \\, 500] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [-150, \\, 200, \\, -250] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = -2.0833333333333334 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n3. 校准 $C_g$ 后，对以下每个测试用例预测生成项 $P_\\omega$。所有最终结果以浮点数形式表示，单位为 $\\mathrm{s}^{-1}$。\n   - 测试 #A（常规路径）：$\\Delta = 1.1 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [700, \\, 200, \\, 100] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [70, \\, 40, \\, 10] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 #B（边界，源项梯度为零）：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 #C（反向对齐梯度）：$\\Delta = 0.9 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [400, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [-100, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 #D（滤波宽度标度）：$\\Delta = 2.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [500, \\, 500, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 50, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n\n实现要求：\n- 您的程序必须根据校准集计算最小二乘估计值 $C_g^\\star$，然后为每个测试用例计算 $P_\\omega = 2 \\, C_g^\\star \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$。\n- 本问题中不涉及角度。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 分别是测试 #A 到测试 #D 的预测 $P_\\omega$ 值，单位为 $\\mathrm{s}^{-1}$。\n\n测试套件覆盖范围说明：\n- 测试 #A 是一个通用的非退化配置。\n- 测试 #B 强制执行当 $\\nabla \\tilde{\\dot{\\omega}}_c$ 为零时生成项为零的边界条件。\n- 测试 #C 检查模型对反向对齐梯度的符号敏感性。\n- 测试 #D 检验模型预测的 $\\Delta^2$ 标度关系。\n\n所有物理量必须在国际单位制 (SI) 中处理，最终输出的单位必须是 $\\mathrm{s}^{-1}$。", "solution": "经检验，该问题是有效的。它在湍流燃烧模拟领域具有科学依据，问题设定良好，目标明确，数据充分，且没有任何主观或矛盾的陈述。\n\n### 第1部分：方差产生模型的推导\n\n该问题涉及对法沃尔滤波的进程变量方差 $\\widetilde{c''^2}$ 的输运方程中的一个项进行建模。我们感兴趣的项是由化学源项引起的方差生成项，我们将其记为 $P_\\omega$。该项表示为 $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$。\n\n进程变量 $c$ 的法沃尔脉动定义为 $c'' = c - \\tilde{c}$。类似地，对于源项 $\\dot{\\omega}_c$，我们有 $\\dot{\\omega}_c'' = \\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c$。项 $\\widetilde{c'' \\dot{\\omega}_c''}$ 代表 $c$ 和 $\\dot{\\omega}_c$ 脉动量的法沃尔滤波协方差。它可以展开为：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{(c - \\tilde{c})(\\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c)} = \\widetilde{c \\dot{\\omega}_c - c \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\dot{\\omega}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c}\n$$\n利用滤波算子的线性和对于任意量 $A$ 和 $B$ 都具有 $\\widetilde{\\tilde{A} B} = \\tilde{A} \\tilde{B}$ 的性质，我们可以简化表达式：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{c \\dot{\\omega}_c} - \\widetilde{c \\tilde{\\dot{\\omega}}_c} - \\widetilde{\\tilde{c} \\dot{\\omega}_c} + \\widetilde{\\tilde{c} \\tilde{\\dot{\\omega}}_c} = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\tilde{\\dot{\\omega}}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c\n$$\n这个结果表达式正是问题中为未解析协方差 $\\tau(c, \\dot{\\omega}_c)$ 提供的定义。因此，我们有以下恒等式：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\tau(c, \\dot{\\omega}_c)\n$$\n因此，方差生成项为 $P_\\omega = 2 \\, \\tau(c, \\dot{\\omega}_c)$。\n\n问题为 $\\tau(c, \\dot{\\omega}_c)$ 提供了一个广义梯度模型：\n$$\n\\tau(c, \\dot{\\omega}_c) \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c = C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n其中 $C_g$ 是一个无量纲模型系数，$\\Delta$ 是滤波宽度，梯度是针对滤波后物理量的。\n\n将此模型代入 $P_\\omega$ 的表达式，我们得到方差生成的最终模型表达式：\n$$\nP_\\omega \\approx 2 \\, C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n\n为了确定 $P_\\omega$ 的单位，我们分析表达式中每一项的单位：\n- $C_g$：无量纲。\n- $\\Delta$：$\\mathrm{m}$，所以 $\\Delta^2$：$\\mathrm{m}^2$。\n- 进程变量 $\\tilde{c}$ 是无量纲的，所以其梯度 $\\nabla \\tilde{c}$ 的单位是 $\\mathrm{m}^{-1}$。\n- 源项 $\\tilde{\\dot{\\omega}}_c$ 是一个速率，单位为 $\\mathrm{s}^{-1}$，所以其梯度 $\\nabla \\tilde{\\dot{\\omega}}_c$ 的单位是 $\\mathrm{m}^{-1} \\mathrm{s}^{-1}$。\n- 点积 $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ 的单位是 $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^{-1} \\mathrm{s}^{-1}) = \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n\n因此，$P_\\omega$ 的单位是 $(\\mathrm{m}^2) \\cdot (\\mathrm{m}^{-2} \\mathrm{s}^{-1}) = \\mathrm{s}^{-1}$。\n\n### 第2部分：模型系数 $C_g$ 的校准\n\n系数 $C_g$ 是通过最小化协方差的 DNS 数据 $\\tau_{\\mathrm{DNS}}$ 与模型预测值 $\\tau_{\\text{model}} = C_g \\, M$ 之间的平方误差和来校准的，其中对于每个校准情况 $i$， $M_i = \\Delta_i^2 \\, (\\nabla \\tilde{c}_i \\cdot \\nabla \\tilde{\\dot{\\omega}}_{c,i})$。\n平方误差和为 $S = \\sum_{i=1}^{N} (\\tau_{\\mathrm{DNS}, i} - C_g M_i)^2$。为了最小化 $S$ 关于 $C_g$ 的值，我们将其导数设为零：\n$$\n\\frac{dS}{dC_g} = \\sum_{i=1}^{N} 2 (\\tau_{\\mathrm{DNS}, i} - C_g M_i) (-M_i) = 0\n$$\n求解最优系数 $C_g^\\star$：\n$$\nC_g^\\star = \\frac{\\sum_{i=1}^{N} \\tau_{\\mathrm{DNS}, i} M_i}{\\sum_{i=1}^{N} M_i^2}\n$$\n我们首先为 $N=5$ 个校准情况中的每一个计算 $M_i$ 的值。\n- 情况 1: $M_1 = (1.0 \\times 10^{-3})^2 (1000 \\cdot 200) = 10^{-6} \\cdot 2 \\times 10^5 = 0.2 \\, \\mathrm{s}^{-1}$。\n- 情况 2: $M_2 = (1.5 \\times 10^{-3})^2 (800 \\cdot 50 + 600 \\cdot 30) = 2.25 \\times 10^{-6} \\cdot 58000 = 0.1305 \\, \\mathrm{s}^{-1}$。\n- 情况 3: $M_3 = (0.8 \\times 10^{-3})^2 (-500 \\cdot 200 + 400 \\cdot (-120) + 100 \\cdot 40) = 0.64 \\times 10^{-6} \\cdot (-144000) = -0.09216 \\, \\mathrm{s}^{-1}$。\n- 情况 4: $M_4 = (1.2 \\times 10^{-3})^2 (1000 \\cdot 100) = 1.44 \\times 10^{-6} \\cdot 10^5 = 0.144 \\, \\mathrm{s}^{-1}$。\n- 情况 5: $M_5 = (1.0 \\times 10^{-3})^2 (300 \\cdot (-150) - 400 \\cdot 200 + 500 \\cdot (-250)) = 10^{-6} \\cdot (-250000) = -0.25 \\, \\mathrm{s}^{-1}$。\n\n检查发现，所提供的 DNS 数据 $\\tau_{\\mathrm{DNS},i}$ 与一个常数系数 $C_g = 1/12 \\approx 0.08333...$ 的模型预测完全对应：\n- 情况 1: $(1/12) M_1 = 0.2/12 = 1/60 \\approx 0.01666...$，与 $\\tau_{\\mathrm{DNS},1}$ 匹配。\n- 情况 2: $(1/12) M_2 = 0.1305/12 = 0.010875$，与 $\\tau_{\\mathrm{DNS},2}$ 匹配。\n- 情况 3: $(1/12) M_3 = -0.09216/12 = -0.00768$，与 $\\tau_{\\mathrm{DNS},3}$ 匹配。\n- 情况 4: $(1/12) M_4 = 0.144/12 = 0.012$，与 $\\tau_{\\mathrm{DNS},4}$ 匹配。\n- 情况 5: $(1/12) M_5 = -0.25/12 = -1/48 \\approx -0.020833...$，与 $\\tau_{\\mathrm{DNS},5}$ 匹配。\n由于对于每个数据点，当 $C_g = 1/12$ 时误差为零，最小二乘法最小化过程将精确地得出这个值。因此，$C_g^\\star = 1/12$。\n\n### 第3部分：测试用例的方差生成预测\n\n使用校准后的系数 $C_g^\\star = 1/12$，方差生成的模型为：\n$$\nP_\\omega = 2 \\cdot \\frac{1}{12} \\cdot \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c) = \\frac{1}{6} \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n我们将此公式应用于每个测试用例。\n- **测试 A**:\n  - $\\Delta^2 = (1.1 \\times 10^{-3})^2 = 1.21 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (700 \\cdot 70 + 200 \\cdot 40 + 100 \\cdot 10) = 49000 + 8000 + 1000 = 58000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,A} = \\frac{1}{6} (1.21 \\times 10^{-6})(58000) = \\frac{0.07018}{6} \\approx 0.0116966... \\, \\mathrm{s}^{-1}$。\n\n- **测试 B**:\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (1000 \\cdot 0) = 0$。\n  - $P_{\\omega,B} = 0 \\, \\mathrm{s}^{-1}$。\n\n- **测试 C**:\n  - $\\Delta^2 = (0.9 \\times 10^{-3})^2 = 0.81 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (400 \\cdot (-100)) = -40000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,C} = \\frac{1}{6} (0.81 \\times 10^{-6})(-40000) = \\frac{-0.0324}{6} = -0.0054 \\, \\mathrm{s}^{-1}$。\n\n- **测试 D**:\n  - $\\Delta^2 = (2.0 \\times 10^{-3})^2 = 4.0 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (500 \\cdot 50 + 500 \\cdot 50) = 25000 + 25000 = 50000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,D} = \\frac{1}{6} (4.0 \\times 10^{-6})(50000) = \\frac{0.2}{6} = \\frac{1}{30} \\approx 0.033333... \\, \\mathrm{s}^{-1}$。\n\n以下代码将以编程方式执行这些计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, calibrates, and applies a subgrid model for progress-variable\n    variance production in LES of turbulent combustion.\n    \"\"\"\n\n    # ----------------------------------------------------------------------\n    # Part 1: Calibration of the model coefficient C_g\n    # ----------------------------------------------------------------------\n\n    # The model for the unresolved covariance is:\n    # tau_model = Cg * M, where M = Delta^2 * (grad(c) . grad(omega_c))\n    # We calibrate Cg using the provided DNS dataset.\n\n    calibration_cases = [\n        # (Delta, grad_c, grad_omega_c, tau_dns)\n        (1.0e-3, np.array([1000, 0, 0]), np.array([200, 0, 0]), 1.6666666666666668e-2),\n        (1.5e-3, np.array([800, 600, 0]), np.array([50, 30, 0]), 1.0875e-2),\n        (0.8e-3, np.array([-500, 400, 100]), np.array([200, -120, 40]), -7.68e-3),\n        (1.2e-3, np.array([0, 1000, 0]), np.array([0, 100, 0]), 1.2e-2),\n        (1.0e-3, np.array([300, -400, 500]), np.array([-150, 200, -250]), -2.0833333333333334e-2),\n    ]\n\n    M_cal = []\n    tau_dns_cal = []\n\n    for case in calibration_cases:\n        delta, grad_c, grad_omega_c, tau_dns = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        M = delta**2 * dot_product\n        M_cal.append(M)\n        tau_dns_cal.append(tau_dns)\n\n    M_cal_vec = np.array(M_cal)\n    tau_dns_cal_vec = np.array(tau_dns_cal)\n\n    # The optimal coefficient Cg* is found by minimizing the sum of\n    # squared errors, leading to the least-squares formula:\n    # Cg* = sum(tau_i * M_i) / sum(M_i^2)\n    # Using np.dot for vectorized summation.\n    sum_tau_M = np.dot(tau_dns_cal_vec, M_cal_vec)\n    sum_M_sq = np.dot(M_cal_vec, M_cal_vec)\n\n    # Since the data is noise-free, any non-zero M_i can determine Cg.\n    # Cg_star = tau_dns_cal_vec[0] / M_cal_vec[0]\n    # For robustness and generality, use the least-squares formula.\n    if sum_M_sq == 0:\n        # Avoid division by zero, although not expected for this dataset\n        Cg_star = 0.0\n    else:\n        Cg_star = sum_tau_M / sum_M_sq\n\n    # ----------------------------------------------------------------------\n    # Part 2: Prediction for the test cases\n    # ----------------------------------------------------------------------\n    \n    # The production term model is P_omega = 2 * Cg* * Delta^2 * (grad(c) . grad(omega_c))\n    \n    test_cases = [\n        # (Delta, grad_c, grad_omega_c)\n        (1.1e-3, np.array([700, 200, 100]), np.array([70, 40, 10])), # Test A\n        (1.0e-3, np.array([1000, 0, 0]), np.array([0, 0, 0])),        # Test B\n        (0.9e-3, np.array([400, 0, 0]), np.array([-100, 0, 0])),      # Test C\n        (2.0e-3, np.array([500, 500, 0]), np.array([50, 50, 0])),       # Test D\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, grad_c, grad_omega_c = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        \n        # P_omega = 2 * Cg_star * M\n        M = delta**2 * dot_product\n        p_omega = 2.0 * Cg_star * M\n        results.append(p_omega)\n    \n    # Format the final output as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3318856"}]}