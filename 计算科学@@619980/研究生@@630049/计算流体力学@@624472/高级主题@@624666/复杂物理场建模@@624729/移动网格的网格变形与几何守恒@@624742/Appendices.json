{"hands_on_practices": [{"introduction": "在任意拉格朗日-欧拉（ALE）方法中，确保几何守恒律（GCL）是获得精确可靠结果的基石。我们的第一个练习将从最基本的单元——一个移动的三角形面——开始。通过这个练习，你将从第一性原理出发，推导出一个精确的标量面法向速度，该速度能够准确地描述由顶点运动引起的体积变化率。这个推导不仅是理论上的一个重要练习，更是理解更复杂多面体单元上GCL计算的基础。[@problem_id:3344771]", "problem": "考虑一个由平面界定的移动控制体的三维任意拉格朗日-欧拉（ALE）离散化。设其中一个面为三角形，其顶点位置为$\\boldsymbol{x}_{1}(t)$、$\\boldsymbol{x}_{2}(t)$和$\\boldsymbol{x}_{3}(t)$，在给定的时间区间内对所有$t$保持不共线，因此该面在每一时刻都是平的。设顶点速度$\\boldsymbol{v}_{i}(t) = d\\boldsymbol{x}_{i}/dt$在该区间内是时间的线性函数。通过有向面积向量$\\boldsymbol{S}_{f}(t) = \\frac{1}{2}\\left(\\boldsymbol{x}_{2}(t)-\\boldsymbol{x}_{1}(t)\\right)\\times\\left(\\boldsymbol{x}_{3}(t)-\\boldsymbol{x}_{1}(t)\\right)$定义该三角形面的瞬时单位法向量$\\boldsymbol{n}_{f}(t)$和面积$A_{f}(t)$，其中$\\boldsymbol{n}_{f}(t) = \\boldsymbol{S}_{f}(t)/\\|\\boldsymbol{S}_{f}(t)\\|$且$A_{f}(t) = \\|\\boldsymbol{S}_{f}(t)\\|$。假设面上的网格速度使用该三角形的标准重心形函数在空间上线性分布，即对于在时刻$t$位于面上的任意点$\\boldsymbol{x}$，\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = N_{1}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{1}(t) + N_{2}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{2}(t) + N_{3}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{3}(t),\n$$\n其中$N_{i}(\\boldsymbol{x},t)$是线性形函数，在时刻$t$于该面上满足$N_{i}(\\boldsymbol{x}_{j}(t),t) = \\delta_{ij}$和$N_{1}+N_{2}+N_{3}=1$。\n\n从雷诺输运定理和几何守恒律出发，推导出一个精确的标量面法向速度$w_{f}(t)$，使得移动面贡献的瞬时体积率等于网格速度法向分量的面积分，\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA,\n$$\n对于该区间内的所有时刻均成立。然后证明，在所述的顶点运动时间上线性以及面上空间上线性插值的假设下，对于所有从$\\{\\boldsymbol{v}_{1}(t),\\boldsymbol{v}_{2}(t),\\boldsymbol{v}_{3}(t)\\}$到面法向速度的标量映射中，该$w_{f}(t)$是唯一的，该映射对每一种可能的顶点速度选择都能重现相同的瞬时扫掠体积。\n\n将您的最终答案表示为$w_{f}(t)$关于$\\boldsymbol{n}_{f}(t)$和$\\boldsymbol{v}_{i}(t)$ ($i=1,2,3$) 的闭式解析表达式。", "solution": "该问题在计算流体力学领域中提法明确且具有科学依据，特别涉及任意拉格朗日-欧拉（ALE）公式和几何守恒律（GCL）。所提供的假设对于在移动网格上开发和分析二阶精度数值格式是标准的。因此，我们可以进行推导和证明。\n\n该问题分为两部分：首先，推导标量面法向速度$w_f(t)$的表达式；其次，在给定条件下证明该表达式的唯一性。\n\n**第一部分：面法向速度 $w_f(t)$ 的推导**\n\n我们从问题陈述中提供的定义方程开始，该方程将标量面速度$w_f(t)$与面上的网格速度场$\\boldsymbol{v}_g(\\boldsymbol{x}, t)$联系起来：\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n此处，$A_f(t)$是三角形面的面积，$\\boldsymbol{n}_f(t)$是其单位法向量。\n\n面上任意点$\\boldsymbol{x}$的网格速度$\\boldsymbol{v}_g$由顶点速度$\\boldsymbol{v}_i(t)$使用重心形函数$N_i(\\boldsymbol{x},t)$线性插值得到：\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t)\n$$\n将$\\boldsymbol{v}_g(\\boldsymbol{x}, t)$的这个表达式代入积分方程得到：\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\left( \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n顶点速度$\\boldsymbol{v}_i(t)$和面法向量$\\boldsymbol{n}_f(t)$是时间$t$的函数，但在任何给定时刻，它们相对于在面$A_f(t)$上的空间积分变量$\\boldsymbol{x}$是常数。因此，我们可以将它们移到积分之外。根据积分和点积的线性性质：\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n下一步是计算形函数在三角形面积上的积分。对于线性三角形单元，形函数$N_i$与对应于顶点$i$的重心坐标相同。有限元理论中的一个标准结果是，第$i$个重心坐标在三角形面积上的积分等于总面积的三分之一。即：\n$$\n\\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA = \\frac{A_{f}(t)}{3}\n$$\n对于每个$i \\in \\{1, 2, 3\\}$。这可以通过注意到线性函数$N_i$在三角形上的平均值是其在形心处的值，即$1/3$来理解。\n\n将此结果代回我们关于$w_f(t)$的方程中：\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\frac{A_{f}(t)}{3} \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n问题陈述中提到顶点保持不共线，这确保了面面积$A_f(t)$是严格为正的。因此，我们可以将两边同时除以$A_f(t)$：\n$$\nw_{f}(t) = \\sum_{i=1}^{3} \\frac{1}{3} (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n通过提出常数和法向量，可以将其写得更紧凑：\n$$\nw_{f}(t) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n该表达式将标量面法向速度定义为面顶点平均速度在面法向方向上的分量。请注意，瞬时速度的此番推导并不需要顶点运动时间上线性的假设。\n\n**第二部分：唯一性证明**\n\n我们现在证明，所推导的$w_f(t)$表达式，在所有从顶点速度集合$\\{\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)\\}$到面法向速度的可能标量映射中是唯一的，其条件是该映射必须对*每一种*可能的顶点速度选择都能重现正确的瞬时扫掠体积率。\n\n设该标量映射用$\\mathcal{W}$表示，使得$w_f(t) = \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t))$。面所扫掠的瞬时体积率由运动学定义给出，即速度场法向分量在该表面上的面积分。在具有指定网格速度插值的ALE方法的背景下，该率为：\n$$\n\\dot{V}_f(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n问题要求由映射$\\mathcal{W}$生成的标量速度$w_f(t)$重现相同的率：\n$$\nA_f(t) w_f(t) = \\dot{V}_f(t)\n$$\n因此，对映射$\\mathcal{W}$的条件是：\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n如第一部分所证，右侧的积分计算结果为：\n$$\n\\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n将此代入$\\mathcal{W}$的条件中：\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n由于$A_f(t) \\neq 0$，我们可以用它来除，以获得$\\mathcal{W}$必须采取的显式函数形式：\n$$\n\\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n该方程指定了对于任何给定的速度输入集$\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$，映射$\\mathcal{W}$必须产生的确切值。由于该条件必须对这些速度的*所有*可能选择都成立，因此该函数形式是唯一确定的。任何其他映射$\\mathcal{W}'$，如果对任何一组速度产生不同的值，都将违反重现由线性插值网格速度的积分所定义的正确瞬时扫掠体积率的基本要求。\n\n因此，推导出的$w_f(t)$表达式不仅是一个有效的选择，而且是与所述前提相一致的唯一选择。", "answer": "$$\n\\boxed{w_{f}(t) = \\frac{1}{3} \\boldsymbol{n}_{f}(t) \\cdot \\left(\\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t)\\right)}\n$$", "id": "3344771"}, {"introduction": "真实的计算流体动力学应用常常涉及由任意多边形构成的复杂网格。在上一个练习的基础上，我们将把几何守恒律的原理推广到更通用的多面体单元。本练习要求你为一个任意多边形面推导出一个封闭形式的面法向速度表达式，该表达式依赖于一种特定的“扇形分解”和“星形面积权重”。完成此练习将使你掌握在高级有限体积法中处理复杂几何形状并确保GCL的关键技术。[@problem_id:3344765]", "problem": "考虑在三维移动多面体网格上的任意拉格朗日-欧拉（ALE）有限体积公式。设单元 $i$ 具有边界-面 $f \\in \\partial i$。每个面 $f$ 是一个具有 $N_{f} \\ge 3$ 个顶点的平面多边形，顶点按 $k=1,\\dots,N_{f}$ 循环标记，其顶点位置为 $\\mathbf{r}_{f,k}(t) \\in \\mathbb{R}^{3}$，顶点网格速度为 $\\mathbf{v}_{f,k}(t) = \\frac{d \\mathbf{r}_{f,k}}{dt}$。将面的外向单位法向量记为 $\\mathbf{n}_{f}$，面面积记为 $A_{f}$，面心记为 $\\mathbf{c}_{f}$，定义为多边形的面积质心。\n\n假设面内部的网格速度 $\\mathbf{v}(\\mathbf{x},t)$ 是通过将面扇形分解为三角形 $\\left[ \\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1} \\right]$（$k=1,\\dots,N_{f}$，约定 $\\mathbf{r}_{f,N_{f}+1} \\equiv \\mathbf{r}_{f,1}$）进行三角剖分，然后对顶点速度进行分段线性插值来构建的。对于扇形中的每个三角形，令其投影到面法向量上的有向面积为\n$$\nA_{f,[\\mathbf{c}_{f},k,k+1]} \\equiv \\frac{1}{2}\\,\\mathbf{n}_{f} \\cdot \\left[ \\left(\\mathbf{r}_{f,k} - \\mathbf{c}_{f}\\right) \\times \\left(\\mathbf{r}_{f,k+1} - \\mathbf{c}_{f}\\right) \\right],\n$$\n使得 $\\sum_{k=1}^{N_{f}} A_{f,[\\mathbf{c}_{f},k,k+1]} = A_{f}$，其中面的方向由 $A_{f,[\\mathbf{c}_{f},k,k+1]}$ 的符号编码。定义顶点“星形”面积权重为\n$$\nA_{f,k}^{\\star} \\equiv A_{f,[\\mathbf{c}_{f},k-1,k]} + A_{f,[\\mathbf{c}_{f},k,k+1]}, \\quad k=1,\\dots,N_{f},\n$$\n并约定循环索引 $\\mathbf{r}_{f,0} \\equiv \\mathbf{r}_{f,N_{f}}$。\n\n从第一性原理——雷诺输运定理和散度定理——出发，可以证明在ALE框架中，单元体积的精确几何守恒律（GCL）要求离散恒等式\n$$\n\\frac{d V_{i}}{dt} \\;=\\; \\sum_{f \\in \\partial i} A_{f}\\, w_{f},\n$$\n其中 $w_{f}$ 是面法向网格速度，定义为 $\\mathbf{v}(\\mathbf{x},t)$ 在面上的法向分量的面积平均值。在每个面内给定的分段线性插值条件下，推导一个仅用顶点速度 $\\mathbf{v}_{f,k}$、面单位法向量 $\\mathbf{n}_{f}$、面面积 $A_{f}$ 和星形权重 $A_{f,k}^{\\star}$ 表示的 $w_{f}$ 的封闭形式表达式。您的表达式必须对任何多面体单元和任何与上述线性面插值一致的顶点运动有效，并且必须精确保证离散GCL $\\frac{d V_{i}}{dt} = \\sum_{f \\in \\partial i} A_{f} w_{f}$。\n\n将您的最终答案表示为关于 $\\left\\{ \\mathbf{v}_{f,k} \\right\\}$、$\\mathbf{n}_{f}$、$A_{f}$ 和 $\\left\\{ A_{f,k}^{\\star} \\right\\}$ 的单个 $w_{f}$ 的解析公式。不需要进行数值评估。如果引入任何额外量，请明确地将它们定义为给定几何数据的函数。最终答案必须是单个封闭形式的表达式。不需要单位。角度单位不适用。", "solution": "### 步骤1：提取已知条件\n- **框架**：三维移动多面体网格上的任意拉格朗日-欧拉（ALE）有限体积公式。\n- **单元几何**：一个单元 $i$ 的边界由多个面 $f \\in \\partial i$ 构成。每个面 $f$ 是一个具有 $N_f \\ge 3$ 个顶点的平面多边形。\n- **顶点数据**：顶点位置为 $\\mathbf{r}_{f,k}(t) \\in \\mathbb{R}^{3}$，顶点网格速度为 $\\mathbf{v}_{f,k}(t) = \\frac{d \\mathbf{r}_{f,k}}{dt}$，其中 $k=1,\\dots,N_{f}$（循环标记）。\n- **面属性**：外向单位法向量为 $\\mathbf{n}_{f}$，面面积为 $A_{f}$，面心为 $\\mathbf{c}_{f}$（面积质心）。\n- **网格速度场**：面内部的网格速度 $\\mathbf{v}(\\mathbf{x},t)$ 是通过将面扇形分解为三角形 $[\\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1}]$（$k=1,\\dots,N_{f}$，并约定 $\\mathbf{r}_{f,N_{f}+1} \\equiv \\mathbf{r}_{f,1}$），然后对顶点速度进行分段线性插值来构建的。\n- **定义**：\n    - 扇形三角形的有向面积：$A_{f,[\\mathbf{c}_{f},k,k+1]} \\equiv \\frac{1}{2}\\,\\mathbf{n}_{f} \\cdot [ (\\mathbf{r}_{f,k} - \\mathbf{c}_{f}) \\times (\\mathbf{r}_{f,k+1} - \\mathbf{c}_{f}) ]$。\n    - 总面面积：$A_{f} = \\sum_{k=1}^{N_{f}} A_{f,[\\mathbf{c}_{f},k,k+1]}$。\n    - 顶点“星形”面积权重：$A_{f,k}^{\\star} \\equiv A_{f,[\\mathbf{c}_{f},k-1,k]} + A_{f,[\\mathbf{c}_{f},k,k+1]}$，并约定 $\\mathbf{r}_{f,0} \\equiv \\mathbf{r}_{f,N_{f}}$。\n- **控制定律**：离散几何守恒律（GCL）由 $\\frac{d V_{i}}{dt} = \\sum_{f \\in \\partial i} A_{f}\\, w_{f}$ 给出。\n- **目标量**：面法向网格速度 $w_{f}$ 定义为 $\\mathbf{v}(\\mathbf{x},t)$ 在面 $f$ 上的法向分量的面积平均值。\n- **目标**：推导一个仅用 $\\{ \\mathbf{v}_{f,k} \\}$、$\\mathbf{n}_{f}$、$A_{f}$ 和 $\\{ A_{f,k}^{\\star} \\}$ 表示的 $w_{f}$ 的封闭形式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题植根于计算流体动力学的标准原理，特别是针对移动网格的ALE方法和几何守恒律。所有概念都已成熟。\n- **适定性**：问题定义明确。目标量 $w_f$ 被精确地定义为一个积分，而被积函数（网格速度场）由清晰的插值规则指定。目标是计算这个积分。\n- **客观性**：语言正式、数学化，没有歧义或主观陈述。\n- **完整性与一致性**：该问题提供了推导所求表达式所需的所有必要定义和约束。定义的量在内部是一致的。例如，将星形权重 $A_{f,k}^\\star$ 对所有顶点 $k$ 求和，正确地得到两倍的面面积 $2A_f$，因为每个扇形三角形的面积被计算了两次。问题是自洽的。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n\n面法向网格速度 $w_{f}$ 定义为网格速度场 $\\mathbf{v}(\\mathbf{x},t)$ 在面 $f$ 上的法向分量的面积加权平均值。数学上表示为：\n$$\nw_{f} = \\frac{1}{A_{f}} \\int_{A_{f}} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_{f} \\, dA\n$$\n问题指明，对面 $A_f$ 的积分是通过将面分解为以 $[\\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1}]$ 为顶点的扇形三角形 $T_{f,k}$（$k = 1, \\dots, N_f$）来计算的。该积分变为在这些三角形上的积分之和：\n$$\nA_{f} w_{f} = \\sum_{k=1}^{N_{f}} \\int_{T_{f,k}} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_{f} \\, dA\n$$\n在每个三角形 $T_{f,k}$ 内部，速度场 $\\mathbf{v}(\\mathbf{x},t)$ 是其三个顶点速度 $\\mathbf{v}(\\mathbf{c}_f, t)$、$\\mathbf{v}_{f,k}$ 和 $\\mathbf{v}_{f,k+1}$ 的线性插值。我们将面心的速度记为 $\\mathbf{v}_c \\equiv \\mathbf{v}(\\mathbf{c}_f, t)$。对于三角形上的线性函数，其积分为三角形的面积乘以其在顶点处的值的平均值。将此应用于矢量场 $\\mathbf{v}(\\mathbf{x},t)$ 的每个分量，我们得到：\n$$\n\\int_{T_{f,k}} \\mathbf{v}(\\mathbf{x},t) \\, dA = A_{f,[k]} \\frac{\\mathbf{v}_c + \\mathbf{v}_{f,k} + \\mathbf{v}_{f,k+1}}{3}\n$$\n此处，为简洁起见，我们将三角形 $[\\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1}]$ 的面积记为 $A_{f,[k]} \\equiv A_{f,[\\mathbf{c}_{f},k,k+1]}$。注意，这是问题中定义的有向面积。假设面的方向一致，我们将其视为正的几何面积。\n\n与 $\\mathbf{n}_f$ 作点积并对所有三角形求和：\n$$\nA_{f} w_{f} = \\sum_{k=1}^{N_{f}} \\left( A_{f,[k]} \\frac{\\mathbf{v}_c + \\mathbf{v}_{f,k} + \\mathbf{v}_{f,k+1}}{3} \\right) \\cdot \\mathbf{n}_{f}\n$$\n我们可以通过分离 $\\mathbf{v}_c$ 和顶点速度的贡献来重新排列求和：\n$$\n3 A_{f} w_{f} = \\sum_{k=1}^{N_{f}} A_{f,[k]} \\left( (\\mathbf{v}_c \\cdot \\mathbf{n}_f) + (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f) + (\\mathbf{v}_{f,k+1} \\cdot \\mathbf{n}_f) \\right)\n$$\n$$\n3 A_{f} w_{f} = (\\mathbf{v}_c \\cdot \\mathbf{n}_f) \\sum_{k=1}^{N_{f}} A_{f,[k]} + \\sum_{k=1}^{N_{f}} A_{f,[k]} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f) + \\sum_{k=1}^{N_{f}} A_{f,[k]} (\\mathbf{v}_{f,k+1} \\cdot \\mathbf{n}_f)\n$$\n第一个和是总面面积，$\\sum_{k=1}^{N_{f}} A_{f,[k]} = A_f$。对于剩下的两个和，我们可以按顶点速度 $\\mathbf{v}_{f,j}$ 对项进行分组。项 $\\mathbf{v}_{f,j} \\cdot \\mathbf{n}_f$ 在第二个和中当 $k=j$ 时出现，系数为 $A_{f,[j]}$；在第三个和中当 $k=j-1$ 时出现（使用循环索引），系数为 $A_{f,[j-1]}$。\n$\\mathbf{v}_{f,j} \\cdot \\mathbf{n}_f$ 的组合系数为 $A_{f,[j-1]} + A_{f,[j]}$，即 $A_{f,[\\mathbf{c}_{f},j-1,j]} + A_{f,[\\mathbf{c}_{f},j,j+1]}$。这恰好是顶点星形面积权重 $A_{f,j}^{\\star}$ 的定义。因此，对所有顶点贡献的求和为：\n$$\n\\sum_{k=1}^{N_{f}} \\left( A_{f,[k]} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f) + A_{f,[k]} (\\mathbf{v}_{f,k+1} \\cdot \\mathbf{n}_f) \\right) = \\sum_{j=1}^{N_{f}} A_{f,j}^{\\star} (\\mathbf{v}_{f,j} \\cdot \\mathbf{n}_f)\n$$\n将这些结果代回，我们得到：\n$$\n3 A_{f} w_{f} = A_{f} (\\mathbf{v}_c \\cdot \\mathbf{n}_f) + \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n这个表达式仍然包含未知的质心速度 $\\mathbf{v}_c$。为了消除它，我们强制一个基本的一致性条件。插值方案对于已经是线性的速度场必须是精确的。考虑面上一个全局线性速度场，例如刚体旋转 $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega} \\times (\\mathbf{x} - \\mathbf{p})$。对于平面区域 $A$ 上的任意线性函数 $f(\\mathbf{x})$，其在面积质心 $\\mathbf{c}$ 处的值等于该函数的面积平均值：$f(\\mathbf{c}) = \\frac{1}{A} \\int_A f(\\mathbf{x}) dA$。\n将此属性应用于我们的分段线性速度场 $\\mathbf{v}(\\mathbf{x},t)$，我们有：\n$$\n\\mathbf{v}(\\mathbf{c}_f, t) = \\frac{1}{A_f} \\int_{A_f} \\mathbf{v}(\\mathbf{x},t) \\, dA\n$$\n记 $\\mathbf{v}_c = \\mathbf{v}(\\mathbf{c}_f, t)$ 并与 $\\mathbf{n}_f$ 作点积：\n$$\n\\mathbf{v}_c \\cdot \\mathbf{n}_f = \\left(\\frac{1}{A_f} \\int_{A_f} \\mathbf{v}(\\mathbf{x},t) \\, dA\\right) \\cdot \\mathbf{n}_f = \\frac{1}{A_f} \\int_{A_f} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_f \\, dA\n$$\n根据定义，右侧恰好是 $w_f$。因此，我们得到关键的恒等式：\n$$\n\\mathbf{v}_c \\cdot \\mathbf{n}_f = w_f\n$$\n这意味着，对于基于从面积质心出发的扇形分解的指定分段线性插值，质心处的法向速度必须等于面上的平均法向速度。将此代入我们关于 $w_f$ 的方程中：\n$$\n3 A_{f} w_{f} = A_{f} w_{f} + \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n现在我们可以解出 $w_f$：\n$$\n2 A_{f} w_{f} = \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n$$\nw_{f} = \\frac{1}{2 A_{f}} \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n该表达式完全按照要求，仅用给定的顶点速度 $\\mathbf{v}_{f,k}$、面面积 $A_f$、面法向量 $\\mathbf{n}_f$ 和定义的星形面积权重 $A_{f,k}^{\\star}$ 来表示面法向速度 $w_f$。此公式精确地满足了给定网格速度定义下的GCL条件。", "answer": "$$\n\\boxed{w_{f} = \\frac{1}{2 A_{f}} \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_{f})}\n$$", "id": "3344765"}, {"introduction": "几何守恒律的意义远不止于保持自由流的精度；它与模拟的数值稳定性，特别是动态网格的有效性，息息相关。这个实践练习将理论付诸实践，探讨一个尖角附近的网格运动问题。你将首先推导在不同物理边界条件下网格运动所必须满足的运动学约束，然后通过分析一个邻近尖角的单元的运动，得出一个为防止网格单元“翻转”或退化所需的最大允许时间步长。这个练习深刻揭示了GCL在避免网格失效和确保模拟稳健性中的实际作用。[@problem_id:3344805]", "problem": "一个内角为 $\\phi$ 的二维楔形域，通过贴体网格进行离散，用于不可压缩Navier–Stokes方程的任意拉格朗日-欧拉（ALE）方法。该楔形域由两个在原点处以锐角相交的平直壁面组成。每个壁面都是一条由极角 $\\theta=\\pm \\phi/2$ 和半径 $r \\ge 0$ 参数化的射线。壁面进行指定的刚性边界运动，该运动纯粹垂直于每个壁面，指向楔形域内部，速度恒为 $V_{n}>0$ 且无切向分量。\n\n您需要对壁面施加与此边界运动相容的网格运动，针对两种物理边界类型：\n\n- 无滑移壁面：流体速度等于边界处的壁面速度。\n- 滑移（无穿透）壁面：流体速度的法向分量等于壁面的法向速度，但切向分量不受此运动学条件约束。\n\n仅使用运动学和几何守恒的第一性原理，按以下步骤进行。\n\n1) 从ALE映射 $\\boldsymbol{x}=\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 和网格速度的定义 $\\boldsymbol{w}=\\partial \\boldsymbol{\\chi}/\\partial t$ 出发，推导移动壁面上每种边界类型的网格速度的运动学相容性条件。不要假设任何特定的网格求解器；完全用指定的壁面速度 $\\boldsymbol{U}_{w}$ 以及单位法向量 $\\boldsymbol{n}$ 和切向量 $\\boldsymbol{t}$ 来表示壁面约束。\n\n2) 考虑靠近角点的最底层相邻三角形单元，该单元由三个网格节点构成：位于原点的角点节点，以及位于两壁面上相同固定半径 $r_{0}$ 处的两个壁面相邻节点（$\\theta=\\pm \\phi/2$），这两个壁面节点由一条直的内部边（“底边”）连接。假设采用显式前向欧拉网格更新 $\\boldsymbol{x}^{n+1}=\\boldsymbol{x}^{n}+\\Delta t\\,\\boldsymbol{w}^{n}$，并且两个壁面相邻节点完全按照第1部分中约束所决定的壁面速度移动。仅使用运动学和几何守恒原理（即，控制体的体积变化率等于网格法向速度的边面积分），推导出一个保证此三角形单元在一次欧拉更新内不发生翻转（即其底边段不会坍缩至负长度）的最大时间步长 $\\Delta t_{\\max}$ 的封闭形式表达式。您的表达式必须用 $r_{0}$、$\\phi$ 和 $V_{n}$ 表示。\n\n3) 对 $r_{0}=1.00\\,\\mathrm{cm}$、$\\phi=20\\,\\mathrm{degrees}$ 和 $V_{n}=0.50\\,\\mathrm{m/s}$ 的情况，对您的表达式进行数值计算。将您最终的 $\\Delta t_{\\max}$ 数值答案四舍五入到四位有效数字。时间以秒为单位表示。三角函数中使用的所有角度都必须是弧度。", "solution": "### 第1部分：运动学相容性条件\n设 $\\boldsymbol{x}$ 为移动壁面上一点的位置，$\\boldsymbol{U}_w$ 为该点在壁面上的速度。题目说明该运动纯粹垂直于壁面，指向楔形域内部，速度恒为 $V_n > 0$。因此，我们可以将壁面速度写为 $\\boldsymbol{U}_w = V_n \\boldsymbol{n}$，其中 $\\boldsymbol{n}$ 是指向流体域的壁面单位法向量。\n\n网格速度，记为 $\\boldsymbol{w}$，定义为网格节点位置随时间的变化率，$\\boldsymbol{w} = \\partial \\boldsymbol{\\chi} / \\partial t$，其中 $\\boldsymbol{x} = \\boldsymbol{\\chi}(\\boldsymbol{X}, t)$ 是从参考坐标 $\\boldsymbol{X}$ 到物理坐标 $\\boldsymbol{x}$ 的ALE映射。为了使网格与移动边界保持一致，边界上的网格节点必须以与边界运动相容的方式移动。所需的相容性条件取决于施加在流体上的物理边界条件。\n\n\\textbf{无滑移壁面：}\n对于无滑移壁面，壁面处的流体速度 $\\boldsymbol{u}$ 必须等于壁面速度 $\\boldsymbol{U}_w$。\n$$ \\boldsymbol{u}|_{\\text{wall}} = \\boldsymbol{U}_w $$\n在ALE框架中，通常在此类边界上强制网格节点表现出类似拉格朗日的行为，即网格速度被设置为等于当地的流体速度。这确保了边界上的网格节点能够跟踪相同的流体质点。\n$$ \\boldsymbol{w}|_{\\text{wall}} = \\boldsymbol{u}|_{\\text{wall}} $$\n综合这些条件，得到无滑移壁面上网格速度的运动学约束：\n$$ \\boldsymbol{w} = \\boldsymbol{U}_w $$\n代入给定的壁面速度，条件为 $\\boldsymbol{w} = V_n \\boldsymbol{n}$。这是一个完整的向量约束，同时确定了网格速度的法向和切向分量。\n\n\\textbf{滑移（无穿透）壁面：}\n对于滑移壁面，约束条件是流体与壁面之间相对速度的法向分量为零。流体可以沿壁面自由切向移动。条件是：\n$$ (\\boldsymbol{u} - \\boldsymbol{U}_w) \\cdot \\boldsymbol{n} = 0 \\implies \\boldsymbol{u} \\cdot \\boldsymbol{n} = \\boldsymbol{U}_w \\cdot \\boldsymbol{n} $$\n从纯粹的几何角度来看，为了使网格保持在边界上，网格速度的法向分量必须与壁面速度的法向分量相匹配。网格节点沿边界的切向运动不受此运动学要求的约束，可以由网格运动求解器指定，通常是为了优化网格质量。\n因此，运动学相容性条件仅针对网格速度的法向分量：\n$$ \\boldsymbol{w} \\cdot \\boldsymbol{n} = \\boldsymbol{U}_w \\cdot \\boldsymbol{n} $$\n代入给定的壁面速度，此条件为 $\\boldsymbol{w} \\cdot \\boldsymbol{n} = (V_n \\boldsymbol{n}) \\cdot \\boldsymbol{n} = V_n$。切向分量 $\\boldsymbol{w} \\cdot \\boldsymbol{t}$（其中 $\\boldsymbol{t}$ 是单位切向量）仍然是任意的。\n\n### 第2部分：最大时间步长 $\\Delta t_{\\max}$ 的推导\n我们被要求考虑一个特定情景，其中壁面相邻节点“完全按照第1部分中约束所决定的壁面速度移动”。指定的物理壁面运动是纯法向的，没有切向分量。对于无滑移情况，$\\boldsymbol{w} = \\boldsymbol{U}_w = V_n \\boldsymbol{n}$。对于滑移情况，虽然 $\\boldsymbol{w} \\cdot \\boldsymbol{t}$ 在运动学上是自由的，但与指定的物理运动（其切向速度为零）相符的最直接解释是设置 $\\boldsymbol{w} \\cdot \\boldsymbol{t} = 0$。因此，就本题而言，对于两种边界条件，壁面节点的速度均取为 $\\boldsymbol{w} = V_n \\boldsymbol{n}$。\n\n让我们建立一个笛卡尔坐标系，原点位于楔形角点，$x$轴平分楔形角 $\\phi$。\n在时间 $t^n$ 时，三角形单元的三个节点是：\n$P_0$：角点节点，$\\boldsymbol{x}_0^n = (0, 0)$。\n$P_1$：上壁面节点，位于半径 $r_0$ 和角度 $\\theta = \\phi/2$ 处。$\\boldsymbol{x}_1^n = (r_0 \\cos(\\phi/2), r_0 \\sin(\\phi/2))$。\n$P_2$：下壁面节点，位于半径 $r_0$ 和角度 $\\theta = -\\phi/2$ 处。$\\boldsymbol{x}_2^n = (r_0 \\cos(\\phi/2), -r_0 \\sin(\\phi/2))$。\n\n角点节点 $P_0$ 是静止的，所以其网格速度为 $\\boldsymbol{w}_0 = \\boldsymbol{0}$。\n对于上壁面（$\\theta=\\phi/2$），向外的切向量是 $(\\cos(\\phi/2), \\sin(\\phi/2))$。向内的单位法向量是 $\\boldsymbol{n}_1 = (\\sin(\\phi/2), -\\cos(\\phi/2))$。$P_1$ 的网格速度是 $\\boldsymbol{w}_1 = V_n \\boldsymbol{n}_1 = V_n (\\sin(\\phi/2), -\\cos(\\phi/2))$。\n对于下壁面（$\\theta=-\\phi/2$），向外的切向量是 $(\\cos(-\\phi/2), \\sin(-\\phi/2))$。向内的单位法向量是 $\\boldsymbol{n}_2 = (\\sin(\\phi/2), \\cos(\\phi/2))$。$P_2$ 的网格速度是 $\\boldsymbol{w}_2 = V_n \\boldsymbol{n}_2 = V_n (\\sin(\\phi/2), \\cos(\\phi/2))$。\n\n使用显式前向欧拉更新，时间 $t^{n+1} = t^n + \\Delta t$ 时的节点位置为：\n$\\boldsymbol{x}_0^{n+1} = \\boldsymbol{x}_0^n = (0, 0)$。\n$\\boldsymbol{x}_1^{n+1} = \\boldsymbol{x}_1^n + \\Delta t \\, \\boldsymbol{w}_1 = (r_0 \\cos(\\phi/2) + \\Delta t V_n \\sin(\\phi/2), r_0 \\sin(\\phi/2) - \\Delta t V_n \\cos(\\phi/2))$。\n$\\boldsymbol{x}_2^{n+1} = \\boldsymbol{x}_2^n + \\Delta t \\, \\boldsymbol{w}_2 = (r_0 \\cos(\\phi/2) + \\Delta t V_n \\sin(\\phi/2), -r_0 \\sin(\\phi/2) + \\Delta t V_n \\cos(\\phi/2))$。\n\n当单元面积变为零或负值时，会发生单元翻转。一个方便的检查方法是考察三角形底边的长度，即连接 $P_1$ 和 $P_2$ 的内部边。\n在时间 $t^{n+1}$ 时代表底边的向量是 $\\vec{P_2P_1}^{n+1} = \\boldsymbol{x}_1^{n+1} - \\boldsymbol{x}_2^{n+1}$。\n$\\boldsymbol{x}_1^{n+1}$ 和 $\\boldsymbol{x}_2^{n+1}$ 的 $x$ 分量相同。$y$ 分量的差为：\n$y_1^{n+1} - y_2^{n+1} = (r_0 \\sin(\\phi/2) - \\Delta t V_n \\cos(\\phi/2)) - (-r_0 \\sin(\\phi/2) + \\Delta t V_n \\cos(\\phi/2))$\n$= 2 r_0 \\sin(\\phi/2) - 2 \\Delta t V_n \\cos(\\phi/2)$。\n所以，$\\vec{P_2P_1}^{n+1} = (0, 2 r_0 \\sin(\\phi/2) - 2 \\Delta t V_n \\cos(\\phi/2))$。\n底边长度 $L^{n+1}$ 是该向量的模。初始时，对于 $\\Delta t=0$，该项为正（对于 $0  \\phi  \\pi$）。当该项变为零时，底边坍缩为零长度。\n$2 r_0 \\sin(\\phi/2) - 2 \\Delta t_{\\max} V_n \\cos(\\phi/2) = 0$。\n$r_0 \\sin(\\phi/2) = \\Delta t_{\\max} V_n \\cos(\\phi/2)$。\n求解坍缩前的最大时间步长 $\\Delta t_{\\max}$ 得：\n$\\Delta t_{\\max} = \\frac{r_0 \\sin(\\phi/2)}{V_n \\cos(\\phi/2)} = \\frac{r_0}{V_n} \\tan(\\frac{\\phi}{2})$。\n如题所求，此结果是直接从前向欧拉更新对节点位置的几何影响推导出来的。对几何守恒律（GCL）的引用强调了核心问题是保持正的单元体积（面积），这在这种特定几何形状中，通过防止底边坍缩来保证。\n\n### 第3部分：数值计算\n我们有以下给定值：\n$r_0 = 1.00 \\, \\mathrm{cm} = 0.01 \\, \\mathrm{m}$。\n$\\phi = 20 \\, \\mathrm{degrees}$。\n$V_n = 0.50 \\, \\mathrm{m/s}$。\n\n$\\Delta t_{\\max}$ 的公式要求角度以弧度为单位。楔形半角为 $\\phi/2 = 10 \\, \\mathrm{degrees}$。\n换算成弧度，即为 $\\frac{\\phi}{2} = 10 \\times \\frac{\\pi}{180} = \\frac{\\pi}{18}$ 弧度。\n\n将数值代入推导出的表达式：\n$\\Delta t_{\\max} = \\frac{0.01 \\, \\mathrm{m}}{0.50 \\, \\mathrm{m/s}} \\tan(10^{\\circ}) = 0.02 \\tan(\\frac{\\pi}{18}) \\, \\mathrm{s}$。\n现在，我们计算数值：\n$\\tan(\\frac{\\pi}{18}) \\approx 0.17632698$。\n$\\Delta t_{\\max} \\approx 0.02 \\times 0.17632698 \\, \\mathrm{s} \\approx 0.0035265396 \\, \\mathrm{s}$。\n将结果四舍五入到四位有效数字，我们得到：\n$\\Delta t_{\\max} \\approx 0.003527 \\, \\mathrm{s}$。\n用科学记数法表示为 $3.527 \\times 10^{-3} \\, \\mathrm{s}$。", "answer": "$$\\boxed{3.527 \\times 10^{-3}}$$", "id": "3344805"}]}