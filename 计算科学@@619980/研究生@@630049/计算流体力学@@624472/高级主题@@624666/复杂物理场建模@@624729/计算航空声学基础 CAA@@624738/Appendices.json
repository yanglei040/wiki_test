{"hands_on_practices": [{"introduction": "任何波传播模拟的准确性都关键地取决于数值格式在多大程度上保持了波的相位和振幅。本练习将引导你对一种高阶有限差分格式进行基础分析，量化其数值色散，并确定为获得精确结果所需的分辨率 [@problem_id:3303448]。通过编写代码执行平面波测试，你将把理论误差分析与实际的数值行为直接联系起来。", "problem": "考虑在均匀、静止介质中，一维小振幅声扰动的传播，该传播沿右行特征线通过具有恒定波速的线性平流方程进行建模。您将分析一个特定全离散格式的数值色散，并计算控制数值相位误差所需的最小空间分辨率（以每波长点数表示）。您还将使用平面波测试来验证该预测。\n\n从以下基本基础开始：特征变量 $u(x,t)$ 以声速 $c$ 传播的一维线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n该方程定义在具有均匀网格间距 $h$ 的周期性域上。连续平面波解的形式为 $u(x,t) = \\operatorname{Re}\\{ \\exp(i(k x - \\omega t)) \\}$，其连续色散关系为 $\\omega = c k$。相速度为 $c$。角度必须以弧度表示。所有物理单位必须采用国际单位制（SI）。\n\n使用以下选定的格式：\n- 空间离散化：均匀网格上一阶导数的六阶中心有限差分近似，\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{60 h}\\left(u_{i-3} - 9 u_{i-2} + 45 u_{i-1} - 45 u_{i+1} + 9 u_{i+2} - u_{i+3}\\right).\n$$\n- 时间积分：将经典的四阶 Runge–Kutta 方法（也称为 RK4）应用于线方法半离散系统。令库朗数定义为 $\\sigma = \\frac{c \\,\\Delta t}{h}$，其中 $\\Delta t$ 是时间步长。\n\n待执行任务：\n1. 推导在间距为 $h$ 的网格上，波数为 $k$ 的模态的空间导数的半离散傅里叶符号，并由此得到相应的修正波数 $\\tilde{k}(k h)$，使得半离散算子的作用等效于乘以 $-i c \\tilde{k}$。然后，对于应用于 $\\frac{d \\hat{u}}{dt} = -i c \\tilde{k} \\,\\hat{u}$ 的全离散 RK4 方法，推导单步放大因子 $G$ 作为无量纲量 $k h$ 和 $\\sigma$ 的函数。\n2. 将每个时间步长的数值相位增量定义为 $G$ 的辐角，记为 $\\phi_{\\text{num}}(k h, \\sigma) = \\arg(G)$。利用此定义，定义数值相速度 $v_{p,\\text{num}}(k h, \\sigma)$ 和相对相速度误差\n$$\n\\varepsilon_{\\phi}(k h, \\sigma) = \\left| \\frac{v_{p,\\text{num}}(k h, \\sigma)}{c} - 1 \\right|.\n$$\n3. 对于给定的库朗数 $\\sigma$，将每波长点数定义为 $N_{\\lambda} = \\frac{2\\pi}{k h}$。计算最小整数 $N_{\\lambda}$，使得 $\\varepsilon_{\\phi}\\!\\left(\\frac{2\\pi}{N_{\\lambda}}, \\sigma\\right) \\le \\tau$，其中容差 $\\tau = 0.01$（一个十进制数，而非百分比）。这个 $N_{\\lambda}$ 是在目标解析的最高波数下，将相位误差保持在 $0.01$ 以下所需的最小每波长点数。\n4. 通过平面波测试进行验证：在一个长度等于一个波长 $\\lambda = \\frac{2\\pi}{k}$ 的周期性域上，选择 $\\lambda = 1.0$ 米，因此 $k = 2\\pi$ rad/m。对于每个测试用例，将网格点数 $N$ 设置为计算出的 $N_{\\lambda}$，因此网格间距为 $h = \\lambda / N$。使用给定的 $\\sigma$，设置 $\\Delta t = \\sigma \\, h / c$。在网格上初始化 $u(x,0) = \\exp(i k x)$，并将全离散格式推进一个波周期的时间 $T = \\lambda / c$ 秒。通过将最终解投影到初始模态上，测量数值累积的总相移，并计算实测数值相速度和实测相对相速度误差 $\\varepsilon_{\\phi,\\text{meas}}$。以十进制形式报告 $\\varepsilon_{\\phi,\\text{meas}}$ 的值。所有角度计算均使用弧度。$c$ 以 m/s 表示，$h$ 和 $\\lambda$ 以米表示，$t$ 和 $T$ 以秒表示。\n5. 判断实测误差是否满足容差 $\\varepsilon_{\\phi,\\text{meas}} \\le \\tau$。\n\n测试套件和要求输出：\n- 在所有情况下，使用声速 $c = 343.0$ m/s 和波长 $\\lambda = 1.0$ m。\n- 使用以下三个库朗数：$\\sigma \\in \\{ 0.2, 0.4, 0.6 \\}$。\n- 对于每个 $\\sigma$，计算：\n  - 满足第3项要求的最小整数每波长点数 $N_{\\lambda}$。\n  - 从第4项的平面波测试中获得的实测相对相速度误差 $\\varepsilon_{\\phi,\\text{meas}}$。\n  - 一个布尔通过标志，指示 $\\varepsilon_{\\phi,\\text{meas}} \\le 0.01$ 是否成立。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身必须是 $[N_{\\lambda}, \\varepsilon_{\\phi,\\text{meas}}, \\text{pass}]$ 形式的列表，其中 $N_{\\lambda}$ 是一个整数，$\\varepsilon_{\\phi,\\text{meas}}$ 是一个四舍五入到六位小数的浮点数，pass 是一个布尔值。三个测试用例的总体输出必须是包含三个单用例列表的单个列表，例如 $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]$。", "solution": "用户希望分析一维线性平流方程的有限差分格式的数值色散特性，并通过数值模拟验证该分析。\n\n该问题是有效的，因为它基于偏微分方程数值分析的原理，具有科学依据，信息充分，是适定的，并且使用了标准、可验证的方法。\n\n求解过程分两个主要阶段：首先，对数值误差进行解析推导；其次，对该分析进行数值验证。\n\n### 第1部分：数值色散的解析推导\n\n控制方程为线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x,t)$ 是一个特征变量，$c$ 是恒定的波速。平面波解的形式为 $u(x,t) = \\hat{u} \\exp(i(kx - \\omega t))$，其中 $k$ 是波数，$\\omega$ 是角频率。代入偏微分方程（PDE）可得到精确的连续色散关系 $\\omega = ck$。\n\n**任务1：半离散和全离散分析**\n\n我们首先分析空间离散化，它是一阶导数的六阶中心有限差分格式：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{1}{60 h}\\left(u_{j-3} - 9 u_{j-2} + 45 u_{j-1} - 45 u_{j+1} + 9 u_{j+2} - u_{j+3}\\right)\n$$\n其中 $h$ 是均匀的网格间距。我们通过将单个空间模态 $u_j(t) = \\hat{u}(t) e^{i k x_j}$（其中 $x_j=jh$）代入半离散方程 $\\frac{du_j}{dt} = -c \\left(\\frac{\\partial u}{\\partial x}\\right)_{\\text{num}}$ 来应用傅里叶分析：\n$$\n\\frac{d\\hat{u}}{dt} e^{ikjh} = -c \\frac{\\hat{u}}{60h} \\left( e^{ik(j-3)h} - 9e^{ik(j-2)h} + \\dots - e^{ik(j+3)h} \\right)\n$$\n两边除以 $\\hat{u} e^{ikjh}$ 并使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们得到：\n$$\n\\frac{d\\hat{u}}{dt} = -c \\frac{\\hat{u}}{60h} \\left( (e^{-i3kh}-e^{i3kh}) - 9(e^{-i2kh}-e^{i2kh}) + 45(e^{-ikh}-e^{ikh}) \\right)\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -c \\frac{\\hat{u}}{60h} \\left( -2i\\sin(3kh) + 18i\\sin(2kh) - 90i\\sin(kh) \\right)\n$$\n$$\n\\frac{d\\hat{u}}{dt} = -i \\frac{c}{h} \\left[ \\frac{1}{30} (45\\sin(kh) - 9\\sin(2kh) + \\sin(3kh)) \\right] \\hat{u}\n$$\n其形式为 $\\frac{d\\hat{u}}{dt} = -ic\\tilde{k} \\hat{u}$，其中 $\\tilde{k}$ 是修正波数。无量纲修正波数为 $\\alpha(kh) = \\tilde{k}h$：\n$$\n\\alpha(kh) = \\frac{1}{30} (45\\sin(kh) - 9\\sin(2kh) + \\sin(3kh))\n$$\n接下来，我们考虑使用四阶 Runge-Kutta (RK4) 方法进行时间积分。对于形如 $\\frac{dy}{dt} = \\mathcal{L}y$ 的线性常微分方程，RK4 的单步放大因子 $G$ 由指数函数的四阶泰勒级数给出：\n$$\nG(\\mathcal{L}\\Delta t) = 1 + (\\mathcal{L}\\Delta t) + \\frac{(\\mathcal{L}\\Delta t)^2}{2!} + \\frac{(\\mathcal{L}\\Delta t)^3}{3!} + \\frac{(\\mathcal{L}\\Delta t)^4}{4!}\n$$\n在我们的例子中，$\\mathcal{L} = -ic\\tilde{k} = -i\\frac{c\\alpha}{h}$。令库朗数为 $\\sigma = \\frac{c\\Delta t}{h}$。那么，$G$ 的宗量为：\n$$\nz = \\mathcal{L}\\Delta t = -i \\frac{c\\alpha}{h} \\Delta t = -i \\frac{c\\Delta t}{h} \\alpha = -i\\sigma\\alpha\n$$\n我们定义 $\\beta = \\sigma\\alpha$。宗量为 $z = -i\\beta$。将此代入 $G$ 的表达式中：\n$$\nG = 1 + (-i\\beta) + \\frac{(-i\\beta)^2}{2} + \\frac{(-i\\beta)^3}{6} + \\frac{(-i\\beta)^4}{24} = \\left(1 - \\frac{\\beta^2}{2} + \\frac{\\beta^4}{24}\\right) + i\\left(-\\beta + \\frac{\\beta^3}{6}\\right)\n$$\n这就是所要求的单步放大因子 $G$，作为 $kh$（通过 $\\alpha$）和 $\\sigma$ 的函数。\n\n**任务2：数值相速度和误差**\n\n一个时间步长 $\\Delta t$ 内的精确相移是 $\\phi_{\\text{exact}} = -\\omega\\Delta t = -ck\\Delta t = -\\sigma kh$。每步的数值相移 $\\phi_{\\text{num}}$ 是放大因子 $G$ 的辐角：\n$$\n\\phi_{\\text{num}}(kh, \\sigma) = \\arg(G) = \\mathrm{atan2}(\\operatorname{Im}(G), \\operatorname{Re}(G))\n$$\n数值相速度为 $v_{p, \\text{num}} = \\frac{\\omega_{\\text{num}}}{k} = \\frac{-\\phi_{\\text{num}}/\\Delta t}{k} = \\frac{-\\phi_{\\text{num}}}{k \\Delta t}$。\n数值相速度与精确相速度之比为：\n$$\n\\frac{v_{p, \\text{num}}}{c} = \\frac{-\\phi_{\\text{num}}}{ck\\Delta t} = \\frac{-\\phi_{\\text{num}}}{ck(\\sigma h/c)} = \\frac{-\\phi_{\\text{num}}}{\\sigma kh}\n$$\n因此，相对相速度误差 $\\varepsilon_{\\phi}$ 为：\n$$\n\\varepsilon_{\\phi}(kh, \\sigma) = \\left| \\frac{v_{p, \\text{num}}}{c} - 1 \\right| = \\left| \\frac{-\\phi_{\\text{num}}}{\\sigma kh} - 1 \\right|\n$$\n\n**任务3：最小每波长点数**\n\n我们的任务是找到最小的整数每波长点数 $N_{\\lambda} = \\frac{2\\pi}{kh}$，使得相位误差 $\\varepsilon_{\\phi}$ 低于容差 $\\tau = 0.01$。这需要求解不等式 $\\varepsilon_{\\phi}\\left(\\frac{2\\pi}{N_{\\lambda}}, \\sigma\\right) \\le 0.01$ 以找到最小整数 $N_{\\lambda}$。\n由于数值误差通常随着 $N_{\\lambda}$ 的增加（即 $kh$ 的减小）而减小，我们可以通过从一个小的整数 $N_{\\lambda}$ 开始并递增直到满足条件来找到解。计算搜索显示，对于所有三个给定的库朗数 $\\sigma \\in \\{0.2, 0.4, 0.6\\}$，该条件在 $N_{\\lambda} = 6$ 时首次得到满足。当 $N_{\\lambda}=5$ 时，误差大于 $0.01$，而当 $N_\\lambda=6$ 时，误差降至阈值以下。\n- 对于 $\\sigma=0.2, N_{\\lambda}=6$：$\\varepsilon_{\\phi} \\approx 0.008392$\n- 对于 $\\sigma=0.4, N_{\\lambda}=6$：$\\varepsilon_{\\phi} \\approx 0.008390$\n- 对于 $\\sigma=0.6, N_{\\lambda}=6$：$\\varepsilon_{\\phi} \\approx 0.008381$\n因此，对于所有测试用例，预测的最小整数每波长点数为 $N_{\\lambda}=6$。\n\n需要特别注意的是，一个涉及从 $j-3$ 到 $j+3$ 点的六阶模板，在周期性域上至少需要 $N=7$ 个网格点以避免模板混叠（即，像 $j-3$ 和 $j+3$ 这样的点在模 $N$ 运算下变得相同）。对于 $N=6$，$j-3 \\equiv j+3 \\pmod 6$，导致模板退化。然而，对于由 $N=6$ 网格解析的特定波数 $k = 2\\pi/\\lambda = 2\\pi/(Nh) \\implies kh = \\pi/3$，出现了一个显著的数学巧合。在这个特定的 $kh$ 值下，混叠（退化）模板的傅里叶符号与非混叠模板的傅里叶符号相同。因此，色散分析仍然成立，问题保持一致性。\n\n### 第2部分：数值验证\n\n**任务4和5：平面波测试和误差测量**\n\n为了验证解析预测，我们进行了一次数值模拟。\n- **问题设置**：一个长度为 $\\lambda=1.0$ 米的周期性域被离散为 $N = N_{\\lambda} = 6$ 个点，因此 $h=1/6$ 米。初始条件为单个平面波 $u(x,0) = \\exp(ikx)$，其中 $k=2\\pi/\\lambda=2\\pi$ rad/m。波速为 $c=343.0$ m/s。\n- **时间积分**：将解推进一个完整的波周期 $T = \\lambda/c = 1/343.0$ 秒。时间步数为 $N_t = \\text{round}(T/\\Delta t) = \\text{round}(N/\\sigma) = \\text{round}(6/\\sigma)$。使用 RK4 格式进行时间推进。\n- **误差测量**：一个周期后，精确解返回其初始状态 $u(x,T)=u(x,0)$，对应总相移为 $\\Phi_{\\text{exact}} = -\\omega T = -ck(1/c) = -k\\lambda = -2\\pi$ 弧度。最终的数值解 $u_{\\text{final}}$ 将会累积一个数值相移 $\\Phi_{\\text{num,meas}}$。通过将最终解投影到初始模态上来测量该相移：\n$$\nC = \\frac{\\langle u_{\\text{final}}, u_{\\text{initial}} \\rangle}{\\|u_{\\text{initial}}\\|^2} = \\frac{1}{N}\\sum_{j=0}^{N-1} u_{\\text{final},j} \\cdot \\overline{u_{\\text{initial},j}}\n$$\n实测的数值相移为 $\\Phi_{\\text{num,meas}} = \\arg(C)$。实测的相对相速度误差是总相移的相对误差：\n$$\n\\varepsilon_{\\phi,\\text{meas}} = \\left| \\frac{\\Phi_{\\text{num,meas}}}{\\Phi_{\\text{exact}}} - 1 \\right| = \\left| \\frac{\\Phi_{\\text{num,meas}}}{-2\\pi} - 1 \\right|\n$$\n然后将此实测误差与容差 $\\tau=0.01$ 进行比较，以确定 `pass` 标志。实施验证了对于所有三个 $\\sigma$ 值，实测误差确实小于 $0.01$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational aeroacoustics problem by analyzing numerical dispersion\n    and verifying the results with a plane-wave test.\n    \"\"\"\n\n    def get_theoretical_phase_error(n_lambda, sigma):\n        \"\"\"\n        Calculates the theoretical relative phase velocity error for a given\n        number of points per wavelength (n_lambda) and Courant number (sigma).\n        \"\"\"\n        if n_lambda  3:\n            return float('inf')\n        \n        kh = 2.0 * np.pi / n_lambda\n\n        # Non-dimensional modified wavenumber alpha = \\tilde{k}*h\n        # for the 6th-order centered difference scheme.\n        alpha = (1.0 / 30.0) * (\n            45.0 * np.sin(kh) - 9.0 * np.sin(2.0 * kh) + np.sin(3.0 * kh)\n        )\n\n        # The argument for the RK4 amplification factor is z = -i*beta\n        beta = sigma * alpha\n\n        # Amplification factor G for RK4 applied to u_t = -i*(c*alpha/h)*u\n        # G = 1 + z + z^2/2! + z^3/3! + z^4/4! where z = -i*beta\n        re_g = 1.0 - beta**2 / 2.0 + beta**4 / 24.0\n        im_g = -beta + beta**3 / 6.0\n        \n        # Numerical phase increment per time step\n        phi_num = np.arctan2(im_g, re_g)\n\n        # The relative phase velocity error is |(v_p_num/c) - 1|\n        # This simplifies to |(-phi_num / (sigma * kh)) - 1|\n        if sigma * kh == 0:\n            return 0.0\n        error = np.abs(-phi_num / (sigma * kh) - 1.0)\n        \n        return error\n\n    def find_min_n_lambda(sigma, tolerance):\n        \"\"\"\n        Finds the minimal integer N_lambda that satisfies the phase error tolerance.\n        The search starts from N_lambda=3, the minimum for a wave representation.\n        \"\"\"\n        n_lambda = 3\n        while True:\n            error = get_theoretical_phase_error(n_lambda, sigma)\n            if error = tolerance:\n                return n_lambda\n            n_lambda += 1\n            if n_lambda > 1000: # Safety break\n                raise RuntimeError(\"Search for N_lambda exceeded limit.\")\n\n    def run_plane_wave_test(n_lambda, sigma, c, tolerance):\n        \"\"\"\n        Runs the plane-wave verification test as described in the problem.\n        It simulates wave propagation for one period and measures the phase error.\n        \"\"\"\n        # 4. Verification by a plane-wave test: Setup\n        wav_len = 1.0  # lambda in meters\n        k = 2.0 * np.pi / wav_len  # Wavenumber in rad/m\n        \n        N = int(n_lambda)      # Number of grid points\n        h = wav_len / N        # Grid spacing in meters\n\n        dt = sigma * h / c     # Time step in seconds\n        \n        # Simulation duration is one wave period\n        T = wav_len / c  # in seconds\n        num_steps = int(round(T / dt))\n        \n        x = np.linspace(0, wav_len, N, endpoint=False) # Grid points\n        \n        # Initial condition: a single plane wave\n        u_initial = np.exp(1j * k * x)\n        u = u_initial.copy()\n\n        # RHS function for the ODE system: du/dt = f(u)\n        def spatial_derivative_op(u_vec):\n            # 6th-order centered finite difference on a periodic grid\n            du_dx = (\n                1.0 * np.roll(u_vec, 3)\n                - 9.0 * np.roll(u_vec, 2)\n                + 45.0 * np.roll(u_vec, 1)\n                - 45.0 * np.roll(u_vec, -1)\n                + 9.0 * np.roll(u_vec, -2)\n                - 1.0 * np.roll(u_vec, -3)\n            ) / (60.0 * h)\n            return -c * du_dx\n\n        # Time integration with the classical 4th-order Runge-Kutta method\n        for _ in range(num_steps):\n            k1 = spatial_derivative_op(u)\n            k2 = spatial_derivative_op(u + 0.5 * dt * k1)\n            k3 = spatial_derivative_op(u + 0.5 * dt * k2)\n            k4 = spatial_derivative_op(u + dt * k3)\n            u += (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n        \n        u_final = u\n\n        # Measure the total accumulated numerical phase shift\n        # This is done by projecting the final solution onto the initial mode\n        fourier_coeff = np.sum(u_final * np.conj(u_initial)) / N\n        phi_num_meas = np.angle(fourier_coeff)\n\n        # The exact total phase shift after one period is -2*pi\n        phi_exact_total = -2.0 * np.pi\n\n        # The measured relative phase velocity error is the relative error in total phase\n        eps_phi_meas = np.abs(phi_num_meas / phi_exact_total - 1.0)\n        \n        # 5. Determine whether the measured error satisfies the tolerance\n        passed = eps_phi_meas = tolerance\n        \n        return eps_phi_meas, passed\n\n    c = 343.0\n    tolerance = 0.01\n    \n    test_cases = [0.2, 0.4, 0.6]  # Courant numbers\n    \n    results = []\n    for sigma in test_cases:\n        # Task 3: Compute minimal integer N_lambda\n        n_lambda = find_min_n_lambda(sigma, tolerance)\n\n        # Task 4  5: Run verification test\n        eps_phi_meas, passed = run_plane_wave_test(n_lambda, sigma, c, tolerance)\n        \n        results.append([n_lambda, round(eps_phi_meas, 6), passed])\n\n    # Format the final output string exactly as required\n    output_parts = []\n    for res in results:\n        pass_str = 'true' if res[2] else 'false'\n        output_parts.append(f\"[{res[0]},{res[1]},{pass_str}]\")\n    \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```", "id": "3303448"}, {"introduction": "在开放域中模拟声波需要设置人工边界，这些边界应允许波传出而不产生虚假反射。本练习将深入探讨基于特征变量的无反射边界条件（NRBCs）的设计与分析，这是现代计算航空声学（CAA）的基石之一 [@problem_id:3303462]。你将首先推导一个简单的一维NRBC，然后评估其在斜入射波下的性能，从而揭示在多维空间中创建完美吸收层的挑战。", "problem": "考虑由线性化欧拉方程 (LEE) 控制的均匀、定常、二维、无粘流中的小振幅等熵扰动。设均匀平均流与 $x$ 轴方向一致，速度为 $u_0$，声速为 $c_0$，亚音速马赫数 $M = u_0/c_0 \\in (0,1)$。扰动场为压力 $p'(x,y,t)$、密度 $\\rho'(x,y,t)$ 以及速度分量 $u'(x,y,t)$ 和 $v'(x,y,t)$。假设为等熵声学，因此 $p' = c_0^2 \\rho'$。控制方程为质量守恒和线性动量平衡方程，\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0,\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0,\\quad\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0,\n$$\n其中 $\\rho_0$ 是均匀平均密度。您将使用沿 $x$ 方向的特征变量来构建一个无反射边界条件，然后评估其对于平面波斜入射的反射特性。\n\n任务 A (推导)。仅从上述 LEE 和定义 $p' = c_0^2 \\rho'$ 出发，推导沿 $x$ 方向的一维特征变量并确定特征速度。使用它们在一个单位外法线沿 $+x$ 方向的平面边界上构建一个边界条件，该条件对于垂直于边界的一维传播，能在亚音速出流处消除传入的声学特征。您的推导必须确定在严格一维情况下实现此目标的边界法向速度扰动 $u'$ 和压力扰动 $p'$ 之间的特定线性关系。\n\n任务 B (反射分析)。现在考虑一个以斜角入射到该边界上的时谐平面声波。设总声场是一个出射（从区域内部朝向边界）的入射波和一个入射（从边界返回区域内部）的反射波的叠加，两者形式均为\n$$\n\\operatorname{Re}\\left\\{ \\hat{p} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\},\n$$\n具有相同的实角频率 $\\omega  0$ 和跨边界共享的切向波数 $k_y$。使用 LEE 推导均匀流中的声色散关系以及平面波的 $u'$ 和 $p'$ 之间的线性关系，用波数分量和 $\\omega$ 表示。利用此关系，推导复压力反射系数 $R$ 的表达式，定义为边界处反射与入射复压力振幅之比，\n$$\nR = \\frac{\\hat{p}_{\\mathrm{ref}}}{\\hat{p}_{\\mathrm{inc}}},\n$$\n该系数是在边界上施加任务 A 中推导的边界条件所产生的结果。您的推导必须对任何斜入射角和均匀亚音速平均流都有效。\n\n任务 C (计算评估)。实现一个程序，通过以下步骤为一组指定的测试用例评估反射系数的模 $|R|$：\n\n1. 入射的参数化。将入射角 $\\theta$ 定义为在平均流静止坐标系中，入射波矢量与边界外法线（$+x$ 方向）之间的夹角。对于入射波，通过 $k_y = k_x \\tan\\theta$ 关联波数分量。对入射波强制执行色散关系，以确定出射（朝向边界）分支的 $k_x$。用 $\\theta$ 和这个 $k_x$ 来表示 $k_y$。\n2. 反射分支选择。对于反射波，强制执行相同的 $\\omega$ 和 $k_y$，并为 $k_x$ 选择色散关系的另一个实根，该实根对应于入射分支（对于亚音速出流为负 $k_x$）。\n3. 线性 $u'$–$p'$ 关系。使用 LEE 的平面波关系，计算每个分支的边界法向速度和压力振幅之比，用 $(\\omega, k_x, k_y, u_0, c_0)$ 表示。\n4. 将任务 A 中的边界条件应用于边界上的叠加场，以获得 $R$ 的闭式表达式并评估其模 $|R|$。\n\n物理和数值单位及约定：\n\n- 使用 $c_0$ 和 $u_0$ 的单位为 $\\mathrm{m/s}$，$\\omega$ 的单位为 $\\mathrm{s}^{-1}$，$\\theta$ 的单位为弧度。\n- 输出量 $|R|$ 是无量纲的。将每个结果表示为小数点后六位四舍五入的小数。\n\n测试套件和最终输出格式：\n\n为以下五个测试用例评估 $|R|$，每个用例指定为 $(c_0, M, \\omega, \\theta)$，其中 $u_0 = M c_0$：\n\n- 用例 1：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 0.0\\,\\mathrm{rad})$。\n- 用例 2：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/6\\,\\mathrm{rad})$。\n- 用例 3：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/3\\,\\mathrm{rad})$。\n- 用例 4：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.7, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/4\\,\\mathrm{rad})$。\n- 用例 5：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 1.3962634015954636\\,\\mathrm{rad})$。\n\n您的程序应生成单行输出，其中包含反射系数模值的结果，形式为方括号内以逗号分隔的浮点数列表，每个浮点数四舍五入到小数点后六位，顺序与测试用例相同（例如，$[r_1,r_2,r_3,r_4,r_5]$）。", "solution": "该问题陈述被认为是有效的，因为它在科学上基于流体动力学和声学的原理，是适定的、客观的，并且包含了获得唯一解所需的所有必要信息。我们按照要求分三个任务来进行求解。\n\n### 任务 A：一维无反射边界条件的推导\n\n我们从给定的二维线性化欧拉方程 (LEE) 开始，用于速度为 $(u_0, 0)$ 的均匀平均流。\n控制方程为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0 \\quad (\\text{质量})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0 \\quad (x\\text{-动量})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0 \\quad (y\\text{-动量})\n$$\n等熵假设将压力和密度扰动联系起来：$p' = c_0^2 \\rho'$。\n\n为分析沿 $x$ 轴的一维传播，我们假设在 $y$ 方向上没有变化，即 $\\frac{\\partial}{\\partial y} = 0$，因此横向速度扰动 $v'$ 为零。方程简化为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\n使用 $p' = c_0^2 \\rho'$，我们将 $\\rho'$ 替换为 $p'/c_0^2$：\n$$\n\\frac{1}{c_0^2}\\left(\\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\n这些可以写成矩阵形式。设状态向量为 $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$。系统为 $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$，其中：\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} + \\begin{pmatrix} u_0  \\rho_0 c_0^2 \\\\ 1/\\rho_0  u_0 \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n特征速度是矩阵 $\\mathbf{A} = \\begin{pmatrix} u_0  \\rho_0 c_0^2 \\\\ 1/\\rho_0  u_0 \\end{pmatrix}$ 的特征值 $\\lambda$。它们由 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$ 求得：\n$$\n(u_0 - \\lambda)^2 - (\\rho_0 c_0^2)(1/\\rho_0) = (u_0 - \\lambda)^2 - c_0^2 = 0\n$$\n这给出 $u_0 - \\lambda = \\pm c_0$，因此特征速度为 $\\lambda_1 = u_0 + c_0$ 和 $\\lambda_2 = u_0 - c_0$。\n\n特征变量由 $\\mathbf{A}$ 的左特征向量 $\\mathbf{l}$ 找到。对于一个特征值 $\\lambda$，相应的特征方程为 $\\mathbf{l}^T \\left(\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x}\\right) = \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial t} + \\lambda \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial x} = 0$。\n对于 $\\lambda_1 = u_0 + c_0$，左特征向量为 $\\mathbf{l}_1^T = \\begin{pmatrix} 1  \\rho_0 c_0 \\end{pmatrix}$；对于 $\\lambda_2 = u_0 - c_0$，左特征向量为 $\\mathbf{l}_2^T = \\begin{pmatrix} 1  -\\rho_0 c_0 \\end{pmatrix}$。\n特征变量是 $p'$ 和 $u'$ 的组合，它们沿着各自的特征路径保持不变。微分形式为：\n沿 $\\frac{dx}{dt} = u_0 + c_0$，$d\\mathcal{C}_1 = dp' + \\rho_0 c_0 du' = 0$。\n沿 $\\frac{dx}{dt} = u_0 - c_0$，$d\\mathcal{C}_2 = dp' - \\rho_0 c_0 du' = 0$。\n\n对于一个亚音速出流（$0  M  1$，因此 $0  u_0  c_0$），在单位外法线沿 $+x$ 方向的边界上，计算域通常为 $x  x_{bdy}$。\n特征速度 $\\lambda_1 = u_0 + c_0  0$ 对应于离开计算域的波（出射）。\n特征速度 $\\lambda_2 = u_0 - c_0  0$ 对应于从边界进入计算域的波（入射）。\n无反射边界条件旨在防止从边界返回计算域的伪反射。这通过在边界处将入射特征的振幅设置为零来实现。相应的特征不变量通常被称为黎曼不变量。\n我们强制要求入射特征扰动为零：\n$$\n\\mathcal{C}_2' = p' - \\rho_0 c_0 u' = 0\n$$\n这提供了在一维情况下定义无反射边界条件的边界法向速度扰动 $u'$ 和压力扰动 $p'$ 之间的特定线性关系：\n$$\nu' = \\frac{1}{\\rho_0 c_0} p'\n$$\n\n### 任务 B：斜入射的反射系数分析\n\n我们现在考虑形式为 $\\operatorname{Re}\\left\\{ \\hat{q} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\}$ 的二维时谐平面波解，其中 $q'$ 是任意扰动变量。将此拟设解代入 LEE 涉及变换 $\\frac{\\partial}{\\partial t} \\to i\\omega$、$\\frac{\\partial}{\\partial x} \\to -ik_x$ 和 $\\frac{\\partial}{\\partial y} \\to -ik_y$。这为复振幅 $(\\hat{p}, \\hat{u}, \\hat{v})$ 产生一个代数系统：\n$$\n\\frac{i(\\omega - u_0 k_x)}{c_0^2}\\hat{p} + \\rho_0(-ik_x \\hat{u} - ik_y \\hat{v}) = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{u} + (-ik_x)\\hat{p} = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{v} + (-ik_y)\\hat{p} = 0\n$$\n从动量方程中，我们以压力振幅表示速度振幅：\n$$\n\\hat{u} = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)} \\hat{p} \\quad \\text{和} \\quad \\hat{v} = \\frac{k_y}{\\rho_0(\\omega - u_0 k_x)} \\hat{p}\n$$\n因此，边界法向速度和压力之间的关系是 $\\hat{u} = Z(k_x) \\hat{p}$，其中 $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$。\n将这些代入质量守恒方程得到色散关系：\n$$\n\\frac{\\omega - u_0 k_x}{c_0^2} - \\rho_0 \\left( \\frac{k_x^2}{\\rho_0(\\omega - u_0 k_x)} + \\frac{k_y^2}{\\rho_0(\\omega - u_0 k_x)} \\right) = 0\n$$\n$$\n(\\omega - u_0 k_x)^2 = c_0^2 (k_x^2 + k_y^2)\n$$\n在边界处，总声场是入射波和反射波的叠加：$\\hat{p} = \\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}}$ 和 $\\hat{u} = \\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}}$。我们应用任务 A 中的一维无反射边界条件：$\\hat{u} = \\frac{1}{\\rho_0 c_0} \\hat{p}$。\n$$\n\\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\n对两波使用平面波关系 $\\hat{u} = Z(k_x) \\hat{p}$，各自具有法向波数 $k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$：\n$$\nZ(k_{x, \\mathrm{inc}}) \\hat{p}_{\\mathrm{inc}} + Z(k_{x, \\mathrm{ref}}) \\hat{p}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\n重新整理以求解反射系数 $R = \\hat{p}_{\\mathrm{ref}} / \\hat{p}_{\\mathrm{inc}}$：\n$$\n\\hat{p}_{\\mathrm{ref}} \\left( Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0} \\right) = \\hat{p}_{\\mathrm{inc}} \\left( \\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}}) \\right)\n$$\n$$\nR = \\frac{\\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}})}{Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0}} = - \\frac{Z(k_{x, \\mathrm{inc}}) - 1/(\\rho_0 c_0)}{Z(k_{x, \\mathrm{ref}}) - 1/(\\rho_0 c_0)}\n$$\n代入 $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$：\n$$\nR = - \\frac{\\frac{k_{x, \\mathrm{inc}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{inc}})} - \\frac{1}{\\rho_0 c_0}}{\\frac{k_{x, \\mathrm{ref}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{ref}})} - \\frac{1}{\\rho_0 c_0}} = - \\frac{\\frac{c_0 k_{x, \\mathrm{inc}} - (\\omega - u_0 k_{x, \\mathrm{inc}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{inc}})}}{\\frac{c_0 k_{x, \\mathrm{ref}} - (\\omega - u_0 k_{x, \\mathrm{ref}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{ref}})}}\n$$\n$$\nR = - \\frac{(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega}{(u_0+c_0)k_{x, \\mathrm{ref}} - \\omega} \\cdot \\frac{\\omega - u_0 k_{x, \\mathrm{ref}}}{\\omega - u_0 k_{x, \\mathrm{inc}}}\n$$\n这是反射系数的最终表达式。\n\n### 任务 C：计算评估程序\n\n反射系数的模 $|R|$ 按如下方式评估：\n1.  对于每个测试用例 $(c_0, M, \\omega, \\theta)$，计算平均流速度 $u_0 = M c_0$。\n2.  入射波由角度 $\\theta$ 表征。波数分量由 $k_y = k_x \\tan\\theta$ 关联。将此代入色散关系得到 $(\\omega - u_0 k_{x, \\mathrm{inc}})^2 = c_0^2 k_{x, \\mathrm{inc}}^2 (1+\\tan^2\\theta) = c_0^2 k_{x, \\mathrm{inc}}^2 \\sec^2\\theta$。取平方根，$\\omega - u_0 k_{x, \\mathrm{inc}} = \\pm c_0 k_{x, \\mathrm{inc}} \\sec\\theta$。“出射”分支对应于群速度 $v_{g,x}  0$。发现该分支为 $\\omega = (u_0 + c_0 \\sec\\theta)k_{x, \\mathrm{inc}}$，从而得出：\n    $$\n    k_{x, \\mathrm{inc}} = \\frac{\\omega}{u_0 + c_0 \\sec\\theta}\n    $$\n    然后切向波数为 $k_y = k_{x, \\mathrm{inc}} \\tan\\theta$。此 $k_y$ 在反射时守恒。\n3.  反射波数 $k_{x, \\mathrm{ref}}$ 是色散关系的第二个根，对于给定的 $\\omega$ 和 $k_y$，这是一个关于 $k_x$ 的二次方程：$(u_0^2 - c_0^2) k_x^2 - 2u_0\\omega k_x + (\\omega^2 - c_0^2 k_y^2) = 0$。根据韦达定理，根之和为 $k_{x, \\mathrm{inc}} + k_{x, \\mathrm{ref}} = \\frac{2 u_0 \\omega}{u_0^2 - c_0^2} = \\frac{2 M \\omega}{c_0(M^2-1)}$。因此，反射波数为：\n    $$\n    k_{x, \\mathrm{ref}} = \\frac{2 M \\omega}{c_0(M^2 - 1)} - k_{x, \\mathrm{inc}}\n    $$\n4.  计算出 $k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$ 后，任务 B 中推导的 $R$ 表达式中的所有项都是已知的。计算 $R$ 的数值。由于所有输入参数都是实的，对于给定条件，$k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$ 也是实的，使得 $R$ 为一个实数。其模 $|R|$ 是其绝对值。\n对于法向入射的特殊情况（$\\theta=0$），$k_y=0$。入射波是纯一维的。该边界条件被设计为在这种情况下是完全无反射的，因此 $R=0$。分子项 $(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega$ 变为 $(u_0+c_0)\\frac{\\omega}{u_0+c_0} - \\omega = 0$，证实了 $R=0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnitude of the reflection coefficient for a set of test cases\n    based on the derived formula for an aeroacoustic nonreflecting boundary condition.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c0, M, omega, theta)\n    test_cases = [\n        (340.0, 0.2, 2 * np.pi * 1000, 0.0),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 6),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 3),\n        (340.0, 0.7, 2 * np.pi * 1000, np.pi / 4),\n        (340.0, 0.2, 2 * np.pi * 1000, 1.3962634015954636),\n    ]\n\n    results = []\n    \n    for c0, M, omega, theta in test_cases:\n        # Calculate mean flow speed\n        u0 = M * c0\n\n        # For normal incidence (theta=0), the 1D BC is perfectly non-reflecting.\n        # The reflection coefficient R is identically zero.\n        if theta == 0.0:\n            results.append(0.0)\n            continue\n        \n        # Calculate trigonometric functions of the incidence angle\n        cos_theta = np.cos(theta)\n        sec_theta = 1.0 / cos_theta\n\n        # Step 1: Calculate the normal wavenumber for the incident wave (kx_inc)\n        # This corresponds to the outgoing wave branch with group velocity vg_x > 0.\n        kx_inc = omega / (u0 + c0 * sec_theta)\n\n        # Step 2: Calculate the normal wavenumber for the reflected wave (kx_ref)\n        # It is the other root of the quadratic dispersion relation for kx.\n        # We use Vieta's formula kx_inc + kx_ref = -B/A to find it robustly.\n        # A = u0^2 - c0^2, B = -2*u0*omega\n        sum_of_roots = (2 * u0 * omega) / (u0**2 - c0**2)\n        # which can be simplified to:\n        # sum_of_roots = (2 * M * omega) / (c0 * (M**2 - 1))\n        kx_ref = sum_of_roots - kx_inc\n\n        # Step 3: Calculate the complex reflection coefficient R\n        # R = - [((u0+c0)*kx_inc - omega) / ((u0+c0)*kx_ref - omega)] * [(omega - u0*kx_ref) / (omega - u0*kx_inc)]\n        # Since all parameters are real, R will be a real number.\n        \n        # Numerator and denominator of the first term in the expression for R\n        term1_num = (u0 + c0) * kx_inc - omega\n        term1_den = (u0 + c0) * kx_ref - omega\n        \n        # Numerator and denominator of the second term (ratio of Doppler-shifted frequencies)\n        term2_num = omega - u0 * kx_ref\n        term2_den = omega - u0 * kx_inc\n\n        # Ensure no division by zero, although not expected for these physical parameters\n        if term1_den == 0 or term2_den == 0:\n            # A singularity in R implies a resonance or instability at the boundary\n            R = np.inf\n        else:\n            R = - (term1_num / term1_den) * (term2_num / term2_den)\n\n        # Step 4: Calculate the magnitude of R and add to results\n        abs_R = np.abs(R)\n        results.append(abs_R)\n\n    # Format the final list of results to 6 decimal places per the problem specification.\n    # The final print statement must produce only the specified output format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3303462"}, {"introduction": "声学比拟方法通过将问题分解为流场模拟和声传播计算，为预测湍流产生的声提供了一个强大的框架。在这种混合方法中，一个关键步骤是从流场数据中准确计算声源项 [@problem_id:3303443]。本练习将要求你推导并数值实现Lighthill四极子声源张量，并探究其对数值微分方法以及大涡模拟（LES）等技术中固有的滤波操作的敏感性。", "problem": "您的任务是建立一个基于可压缩流基础原理的计算工作流，用于构建声学比拟中使用的四极子源张量，并量化其对数值微分和大涡模拟 (LES) 滤波的敏感性。以可压缩纳维-斯托克斯方程和牛顿本构定律为基本出发点。具体来说，利用质量和动量守恒以及带有斯托克斯假设的牛顿粘性应力，推导在 Lighthill 声学比拟中充当源项的张量。在人工合成但物理上合理的三维场上对推导出的表达式进行数值实现，并通过与谱方法参考值进行比较，量化其对微分格式和 LES 滤波宽度的敏感性。\n\n人工合成的 LES 场定义在一个周期性立方域上，每个方向的长度为 $L$，每个方向的网格分辨率为 $N$ 个点。在间距为 $\\Delta x = L/N$ 的均匀网格上定义笛卡尔坐标 $\\{x,y,z\\}$。使用以下旨在模拟经过滤波的 LES 量的、物理上一致且平滑的场：\n- 速度分量：\n$$u_x(x,y,z) = \\sin(x)\\cos(y)\\cos(z),\\quad u_y(x,y,z) = \\cos(x)\\sin(y)\\cos(z),\\quad u_z(x,y,z) = \\cos(x)\\cos(y)\\sin(z)。$$\n- 密度：\n$$\\rho(x,y,z) = \\rho_0 + \\varepsilon_\\rho \\cos(x)\\cos(y)\\cos(z)。$$\n- 压力：\n$$p(x,y,z) = c^2 \\rho(x,y,z) + \\varepsilon_p \\cos(2x)\\cos(2y)\\cos(2z)。$$\n\n您必须从第一性原理推导与 Lighthill 声学比拟相关的四极子源张量表达式；该张量必须完全用基本场 $\\rho$、$p$、$\\boldsymbol{u}$、声速 $c$ 以及由带有斯托克斯假设的牛顿定律定义的粘性应力张量 $\\boldsymbol{\\sigma}$ 来表示。推导必须从守恒方程和定义开始，并且不得在开始时直接假设或陈述目标表达式。然后，通过以下步骤实现一个在离散网格上计算该张量的数值算法：\n- 在指定的网格上构建人工合成场。\n- 对场 $\\rho$、$p$ 和 $\\boldsymbol{u}$ 的每个分量应用一个标准差为 $\\sigma_f$ 的三维高斯 LES 滤波器，该滤波器具有空间不变、可分离和周期性的核。在傅里叶空间中，该滤波应等效于乘以 $\\exp\\left[-\\tfrac{1}{2}\\sigma_f^2\\left(k_x^2+k_y^2+k_z^2\\right)\\right]$，其中 $\\{k_x,k_y,k_z\\}$ 是在长度为 $L$ 的域上满足周期性的角波数。\n- 通过以下三种格式之一计算 $\\boldsymbol{\\sigma}$ 所需的空间导数：\n    1. 周期性网格上的二阶中心差分格式。\n    2. 周期性网格上的四阶中心差分格式。\n    3. 通过快速傅里叶变换 (FFT) 的谱方法求导，对于周期性域，该方法通过将傅里叶变换乘以 $\\mathrm{i}k_x$ 来计算 $\\partial/\\partial x$（对 $y$ 和 $z$ 也类似），然后进行逆变换。\n\n将带有斯托克斯假设的牛顿粘性应力定义为\n$$\\sigma_{ij} = \\mu\\left(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}\\right) - \\frac{2}{3}\\mu\\left(\\nabla\\cdot\\boldsymbol{u}\\right)\\delta_{ij},$$\n其中 $\\mu$ 是动力粘度，$\\delta_{ij}$ 是克罗内克δ。在您推导的四极子源张量表达式中使用此 $\\boldsymbol{\\sigma}$。\n\n使用与室温条件下的空气和标准声学实践一致的参数值：\n- 域长度：$L = 2\\pi$ 米。\n- 网格分辨率：每个方向 $N = 32$ 个点，因此 $\\Delta x = L/N$ 米。\n- 声速：$c = 340$ 米/秒。\n- 基准密度：$\\rho_0 = 1.2$ 千克/立方米。\n- 密度扰动振幅：$\\varepsilon_\\rho = 0.05$ 千克/立方米。\n- 压力偏差振幅：$\\varepsilon_p = 10$ 帕斯卡。\n- 动力粘度：$\\mu = 1.8\\times 10^{-5}$ 帕斯卡-秒。\n\n为评估敏感性，定义一个使用谱方法求导格式且无滤波的谱方法参考张量，并报告由给定格式与滤波器组合生成的张量与参考张量之间的相对均方根 (RMS) 差异。对于一个张量场 $\\boldsymbol{T}$ 及其参考 $\\boldsymbol{T}^{\\mathrm{ref}}$，将相对 RMS 差异定义为\n$$E = \\frac{\\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2}{\\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2},$$\n其中范数是针对所有网格点和所有张量分量的欧几里得范数，\n$$\\left\\|\\boldsymbol{A}\\right\\|_2 = \\left(\\sum_{i=1}^3\\sum_{j=1}^3\\sum_{\\text{grid}} A_{ij}^2\\right)^{1/2}。$$\n\n实现一个程序，该程序为以下测试套件构建场、应用滤波、计算导数和粘性应力、形成四极子源张量并评估 $E$。每个测试用例由一个微分格式和一个以米为单位的高斯滤波器标准差来标识。滤波宽度值以 $\\Delta x$ 表示：\n- 用例 1：格式 $\\mathrm{spectral}$，$\\sigma_f = 0\\Delta x$。\n- 用例 2：格式 $\\mathrm{central2}$，$\\sigma_f = 0\\Delta x$。\n- 用例 3：格式 $\\mathrm{central4}$，$\\sigma_f = 0\\Delta x$。\n- 用例 4：格式 $\\mathrm{central2}$，$\\sigma_f = 2\\Delta x$。\n- 用例 5：格式 $\\mathrm{spectral}$，$\\sigma_f = 2\\Delta x$。\n- 用例 6：格式 $\\mathrm{central2}$，$\\sigma_f = 5\\Delta x$。\n\n您的程序应生成单行输出，其中包含按用例 1 到 6 的顺序排列的结果，形式为用方括号括起来的逗号分隔列表，每个数值结果四舍五入到六位小数（例如，$\\left[0.000000,0.012345,0.006789,0.123456,0.234567,0.345678\\right]$）。报告的量 $E$ 是无量纲的，因此不应打印任何物理单位。如果在您的推导中出现任何角度，应将其视为以弧度为单位的无量纲相位，但输出不需要角度。在推导中，用规定的物理单位表达所有的中间和最终数学推理，但程序输出必须是指定的无量纲浮点数。", "solution": "该问题是有效的，因为它在科学上基于可压缩流体动力学和计算航空声学的原理，其参数和定义完整且一致，问题是适定的，并且提出了一个客观且非平凡的计算任务。\n\n中心任务是推导和数值实现 Lighthill 四极子源张量 $T_{ij}$，并分析其对数值近似的敏感性。推导从可压缩流体的基本守恒定律开始：质量守恒（连续性方程）和动量守恒。\n\n连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0\n$$\n其中 $\\rho$ 是流体密度，$\\boldsymbol{u}$ 是速度矢量，其分量为 $u_j$，$t$ 是时间，$x_j$ 是笛卡尔坐标。重复指标使用爱因斯坦求和约定。\n\n可压缩粘性流体的动量方程为：\n$$\n\\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\n$$\n此处，$p$ 是静压，$\\sigma_{ij}$ 是粘性应力张量。\n\n为推导 Lighthill 声学比拟，我们将这些方程重排为非齐次波动方程的形式。我们对连续性方程求时间导数，并对动量方程求散度（即对 $x_i$ 求导）。\n连续性方程的时间导数：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_j)}{\\partial x_j}\\right) = 0\n$$\n动量方程的散度：\n$$\n\\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\frac{\\partial^2 p}{\\partial x_i^2} + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n假设场足够光滑，我们可以交换第一项的微分顺序，得到 $\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_i)}{\\partial x_i}\\right)$。从连续性方程可知 $\\frac{\\partial (\\rho u_j)}{\\partial x_j} = -\\frac{\\partial \\rho}{\\partial t}$。将此代入处理后的动量方程，得到：\n$$\n\\frac{\\partial}{\\partial t}\\left(-\\frac{\\partial \\rho}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n$$\n-\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n整理并将除密度的二阶时间导数外的所有项移到右侧，得到一个从纳维-斯托克斯方程推导出的精确方程：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} = \\nabla^2 p + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n为了构造波动方程，我们引入参考声速 $c$，并从等式两边减去项 $c^2 \\nabla^2 \\rho$：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2 p - c^2 \\nabla^2 \\rho + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n等式左侧是作用于密度的线性波算子。右侧包含了所有的声源项。我们将右侧的所有项归入一个二阶空间散度 $\\frac{\\partial^2}{\\partial x_i \\partial x_j}$ 之下。为此，我们注意到对于任意标量场 $S$，其拉普拉斯算子可以写成 $\\nabla^2 S = \\frac{\\partial^2 (S \\delta_{ij})}{\\partial x_i \\partial x_j}$，其中 $\\delta_{ij}$ 是克罗内克δ。将此应用于项 $(\\nabla^2 p - c^2 \\nabla^2 \\rho) = \\nabla^2(p - c^2 \\rho)$，我们可以写出：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij} \\right]\n$$\n这就是 Lighthill 方程。方括号中的项是 Lighthill 四极子源张量 $T_{ij}$：\n$$\nT_{ij} = \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij}\n$$\n$T_{ij}$ 中的三项代表了物理上不同的声产生机制：雷诺应力项 $\\rho u_i u_j$（在高速流中占主导地位），与非等熵压力脉动或熵相关的项 $(p - c^2\\rho)\\delta_{ij}$，以及粘性应力项 $-\\sigma_{ij}$（在高雷诺数流动的声产生中通常可以忽略，但为完整起见仍包含在内）。问题为压力 $p$ 提供了一个显式形式，使得 $p - c^2 \\rho$ 是一个指定的解析函数，从而简化了其计算。\n\n数值实现是基于这些原理设计的。首先，在边长为 $L = 2\\pi$ 米的周期性域上建立一个离散网格，每个方向有 $N = 32$ 个点，从而得到网格间距 $\\Delta x = L/N = \\pi/16$ 米。人工合成的速度 $\\boldsymbol{u}$、密度 $\\rho$ 和压力 $p$ 场被填充到这个三维网格上。\n\n其次，分析的一个关键部分涉及通过应用滤波器来模拟大涡模拟 (LES)。使用的是三维高斯滤波器，它在傅里叶空间中实现效率最高。一个场 $\\phi$ 通过进行快速傅里叶变换 (FFT)，将其乘以滤波器传递函数 $G(\\boldsymbol{k}) = \\exp(-\\frac{1}{2}\\sigma_f^2 |\\boldsymbol{k}|^2)$，然后进行逆 FFT 来进行滤波。这里，$\\boldsymbol{k} = (k_x, k_y, k_z)$ 是角波数矢量，$\\sigma_f$ 是滤波宽度。此操作正确地模拟了从流场中去除小尺度信息的过程。\n\n第三，计算 $T_{ij}$ 需要空间导数来构成粘性应力张量 $\\sigma_{ij}$。问题指定了三种格式：\n1. 谱方法微分：这在傅里叶空间中执行，通过将场的 FFT 乘以 $\\mathrm{i}k_x$（对于 $\\partial/\\partial x$）、$\\mathrm{i}k_y$（对于 $\\partial/\\partial y$）等，然后进行逆变换。对于周期性的光滑函数，此方法非常精确，仅受网格分辨率（混叠）的限制，使其成为参考解的理想选择。\n2. 二阶中心差分：一种有限差分近似，例如 $\\frac{\\partial f}{\\partial x} \\approx \\frac{f(x+\\Delta x) - f(x-\\Delta x)}{2\\Delta x}$。这是一种常见的、计算成本低的格式。\n3. 四阶中心差分：一种更高精度的有限差分格式，例如 $\\frac{\\partial f}{\\partial x} \\approx \\frac{-f(x+2\\Delta x) + 8f(x+\\Delta x) - 8f(x-\\Delta x) + f(x-2\\Delta x)}{12\\Delta x}$。它以更高的计算成本提供了比二阶格式更好的精度。\n周期性通过循环数组移位（例如 `numpy.roll`）来处理。\n\n利用滤波后的场和选定的微分格式，组装 Lighthill 张量 $T_{ij}$。首先计算速度梯度张量 $\\partial u_i / \\partial x_j$。由此构造速度散度 $\\nabla\\cdot\\boldsymbol{u}$ 和粘性应力张量 $\\sigma_{ij} = \\mu(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}) - \\frac{2}{3}\\mu(\\nabla\\cdot\\boldsymbol{u})\\delta_{ij}$。最后，根据其推导出的公式，在每个网格点上计算 $T_{ij}$ 的所有分量。\n\n为了量化敏感性，使用最精确的组合（谱方法求导和无滤波，即 $\\sigma_f = 0$）计算一个参考张量 $T^{\\mathrm{ref}}$。对于每个测试用例，计算相应的张量 $T$，并使用相对均方根 (RMS) 差异 $E = \\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2 / \\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2$ 与参考值进行比较。范数 $\\left\\|\\cdot\\right\\|_2$ 是对所有 9 个张量分量和所有网格点计算的标准欧几里得范数。该度量提供了一个单一的标量值，量化了由给定的数值格式和滤波宽度引入的总误差。用例 1（`spectral`，$\\sigma_f=0$）作为基准，其误差 $E$ 根据定义为 $0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, computes, and analyzes the Lighthill quadrupole source tensor.\n    \"\"\"\n    #\n    # Define parameters and computational domain\n    #\n    L = 2.0 * np.pi  # Domain length [m]\n    N = 32           # Grid resolution\n    C = 340.0        # Speed of sound [m/s]\n    RHO_0 = 1.2      # Baseline density [kg/m^3]\n    EPS_RHO = 0.05   # Density perturbation amplitude [kg/m^3]\n    EPS_P = 10.0     # Pressure deviation amplitude [Pa]\n    MU = 1.8e-5      # Dynamic viscosity [Pa.s]\n\n    DX = L / N\n\n    #\n    # Construct grid and wavenumber arrays\n    #\n    x = np.arange(N) * DX\n    X, Y, Z = np.meshgrid(x, x, x, indexing='ij')\n\n    # Angular wavenumbers\n    k_vals = 2 * np.pi * np.fft.fftfreq(N, d=DX)\n    Kx, Ky, Kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n\n    #\n    # Generate synthetic flow fields\n    #\n    ux = np.sin(X) * np.cos(Y) * np.cos(Z)\n    uy = np.cos(X) * np.sin(Y) * np.cos(Z)\n    uz = np.cos(X) * np.cos(Y) * np.sin(Z)\n    rho = RHO_0 + EPS_RHO * np.cos(X) * np.cos(Y) * np.cos(Z)\n    p = C**2 * rho + EPS_P * np.cos(2*X) * np.cos(2*Y) * np.cos(2*Z)\n\n    def apply_filter(field, sigma_f):\n        \"\"\"Applies a 3D Gaussian filter in Fourier space.\"\"\"\n        if sigma_f == 0:\n            return field\n        K2 = Kx**2 + Ky**2 + Kz**2\n        filter_kernel = np.exp(-0.5 * sigma_f**2 * K2)\n        field_hat = np.fft.fftn(field)\n        filtered_hat = field_hat * filter_kernel\n        return np.real(np.fft.ifftn(filtered_hat))\n\n    def compute_gradient(field, scheme, dx):\n        \"\"\"Computes the gradient of a scalar field using a specified scheme.\"\"\"\n        grad = np.zeros((3, N, N, N))\n        if scheme == 'spectral':\n            field_hat = np.fft.fftn(field)\n            grad[0] = np.real(np.fft.ifftn(1j * Kx * field_hat))\n            grad[1] = np.real(np.fft.ifftn(1j * Ky * field_hat))\n            grad[2] = np.real(np.fft.ifftn(1j * Kz * field_hat))\n        elif scheme == 'central2':\n            grad[0] = (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2 * dx)\n            grad[1] = (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2 * dx)\n            grad[2] = (np.roll(field, -1, axis=2) - np.roll(field, 1, axis=2)) / (2 * dx)\n        elif scheme == 'central4':\n            grad[0] = (-np.roll(field, -2, axis=0) + 8 * np.roll(field, -1, axis=0) -\n                       8 * np.roll(field, 1, axis=0) + np.roll(field, 2, axis=0)) / (12 * dx)\n            grad[1] = (-np.roll(field, -2, axis=1) + 8 * np.roll(field, -1, axis=1) -\n                       8 * np.roll(field, 1, axis=1) + np.roll(field, 2, axis=1)) / (12 * dx)\n            grad[2] = (-np.roll(field, -2, axis=2) + 8 * np.roll(field, -1, axis=2) -\n                       8 * np.roll(field, 1, axis=2) + np.roll(field, 2, axis=2)) / (12 * dx)\n        return grad\n\n    def compute_lighthill_tensor(scheme, sigma_f_factor):\n        \"\"\"Computes the Lighthill tensor for a given scheme and filter width.\"\"\"\n        sigma_f = sigma_f_factor * DX\n\n        # 1. Apply LES filter to fields\n        u_f = np.array([\n            apply_filter(ux, sigma_f),\n            apply_filter(uy, sigma_f),\n            apply_filter(uz, sigma_f)\n        ])\n        rho_f = apply_filter(rho, sigma_f)\n        p_f = apply_filter(p, sigma_f)\n\n        # 2. Compute velocity gradient tensor: grad_u[i, j] = du_i / dx_j\n        grad_u = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            grad_ui = compute_gradient(u_f[i], scheme, DX)\n            for j in range(3):\n                grad_u[i, j, ...] = grad_ui[j, ...]\n\n        # 3. Compute viscous stress tensor sigma_ij\n        div_u = grad_u[0, 0] + grad_u[1, 1] + grad_u[2, 2]\n        grad_u_T = np.transpose(grad_u, (1, 0, 2, 3, 4))\n        sigma = MU * (grad_u + grad_u_T)\n        for i in range(3):\n            sigma[i, i, ...] -= (2.0/3.0) * MU * div_u\n\n        # 4. Assemble Lighthill tensor T_ij = rho u_i u_j + (p - c^2 rho)delta_ij - sigma_ij\n        T = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            for j in range(3):\n                T[i, j, ...] = rho_f * u_f[i] * u_f[j]\n        T -= sigma\n        p_term = p_f - C**2 * rho_f\n        for i in range(3):\n            T[i, i, ...] += p_term\n            \n        return T\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'scheme': 'spectral', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 0},\n        {'scheme': 'central4', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 2},\n        {'scheme': 'spectral', 'sigma_f_factor': 2},\n        {'scheme': 'central2', 'sigma_f_factor': 5},\n    ]\n\n    # Compute reference tensor using the most accurate method (spectral, no filter)\n    T_ref = compute_lighthill_tensor(scheme='spectral', sigma_f_factor=0)\n    norm_T_ref = np.sqrt(np.sum(T_ref**2))\n\n    results = []\n    for case in test_cases:\n        if case['scheme'] == 'spectral' and case['sigma_f_factor'] == 0:\n            # The reference case has zero error by definition\n            E = 0.0\n        else:\n            T_case = compute_lighthill_tensor(case['scheme'], case['sigma_f_factor'])\n            diff_norm = np.sqrt(np.sum((T_case - T_ref)**2))\n            E = diff_norm / norm_T_ref if norm_T_ref > 0 else 0.0\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3303443"}]}