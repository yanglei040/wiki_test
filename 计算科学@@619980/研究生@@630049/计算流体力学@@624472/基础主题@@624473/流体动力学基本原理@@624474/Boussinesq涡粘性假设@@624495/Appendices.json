{"hands_on_practices": [{"introduction": "第一个练习将布辛涅斯克（Boussinesq）假说应用于一个典型的均匀剪切流进行实践检验。您将实现核心关系式来计算湍流生成项，并将一个标准的涡粘性代数模型与基于“生成-耗散”平衡物理原理约束的涡粘性值 $ \\nu_t $ 进行比较。这项练习旨在阐明涡粘性模型在基本湍流中是如何被校准和评估的。[@problem_id:3371271]", "problem": "考虑不可压缩均匀剪切湍流，其平均速度梯度 $\\partial \\bar{U}_1/\\partial x_2 = S_0$ 在平均窗口内空间均匀且不随时间变化。令 $R_{ij}=\\overline{u_i' u_j'}$ 表示雷诺应力张量，$S_{ij}=\\tfrac{1}{2}\\left(\\partial \\bar{U}_i/\\partial x_j + \\partial \\bar{U}_j/\\partial x_i\\right)$ 表示平均应变率张量。湍动能生成率为 $\\mathcal{P}=-R_{ij} S_{ij}$。在具有给定平均梯度的均匀剪切中，只有 $S_{12}=S_{21}=S_0/2$ 不为零。Boussinesq 涡黏性假设将雷诺应力偏量部分建模为与平均应变率成正比，比例系数为涡黏性 $\\nu_t$，并将对角线部分建模为与湍动能 $k$ 成正比的各向同性湍流压力。在统计定常的均匀剪切湍流中，通常观察到生成率 $\\mathcal{P}$ 与耗散率 $\\epsilon$ 近似平衡。\n\n您的任务是编写一个程序，针对下述每个测试案例，使用上述定义和假设来：计算直接数值模拟（DNS；Direct Numerical Simulation）剪切应力数据所隐含的生成率，将其与一个由常用 $\\nu_t$ 涡黏性封闭构建的基准 Boussinesq 预测进行比较，然后计算一个调整后的涡黏性 $\\nu_t^\\star$，该黏性在定常状态下强制生成率与耗散率近似平衡。使用国际单位制（SI），其中 $S_0$ 的单位是 $\\mathrm{s}^{-1}$，$k$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$，$\\epsilon$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$，$\\nu_t$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$R_{12}$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。此问题不涉及角度。对于任何比率或十进制值，请将结果表示为十进制数；不要使用百分号。\n\n对于每个测试案例，您的程序必须：\n- 输入参数：$(S_0, k, \\epsilon, R_{12}^{DNS})$。\n- 计算此设置下由 DNS 隐含的生成率，使用均匀剪切恒等式，结果为一个标量 $\\mathcal{P}^{DNS}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$。\n- 使用经过充分检验的代数封闭 $\\nu_t^{(0)} = C_\\mu k^2/\\epsilon$（其中 $C_\\mu = 0.09$）计算基准涡黏性 $\\nu_t^{(0)}$，此公式在 $\\epsilon>0$ 时适用。如果 $\\epsilon=0$ 且 $k>0$，则定义 $\\nu_t^{(0)}=+\\infty$。如果 $k=0$ 且 $\\epsilon=0$，则定义 $\\nu_t^{(0)}=0$。\n- 计算由 $\\nu_t^{(0)}$ 在给定均匀剪切条件下隐含的基准 Boussinesq 生成率预测 $\\mathcal{P}^{(0)}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$。如果 $S_0=0$，则定义 $\\mathcal{P}^{(0)}=0$。\n- 计算调整后的涡黏性 $\\nu_t^\\star$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，该黏性在均匀剪切下强制生成率约等于耗散率。如果 $S_0\\ne 0$，使用 $\\nu_t^\\star=\\epsilon/S_0^2$。如果 $S_0=0$ 且 $\\epsilon=0$，则定义 $\\nu_t^\\star=0$。如果 $S_0=0$ 且 $\\epsilon>0$，则定义 $\\nu_t^\\star=+\\infty$。\n- 使用专门针对均匀剪切的 Boussinesq 假设，计算由 $\\nu_t^\\star$ 隐含的模型剪切应力，记为 $R_{12}^{model,\\star}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。如果 $S_0=0$，则定义 $R_{12}^{model,\\star}=0$。\n\n测试套件（五个案例），每个案例以 $(S_0, k, \\epsilon, R_{12}^{DNS})$ 的形式给出，单位如上所述：\n- 案例 A：$(10.0, 0.5, 1.0, -0.08)$。\n- 案例 B（剪切和耗散消失的边界）：$(0.0, 0.1, 0.0, 0.0)$。\n- 案例 C（强剪切）：$(50.0, 2.0, 50.0, -0.9)$。\n- 案例 D（弱剪切和耗散）：$(2.0, 0.05, 0.01, -0.004)$。\n- 案例 E（零剪切下不可能的定常平衡）：$(0.0, 0.1, 0.1, 0.0)$。\n\n对于每个案例，您的程序必须输出一个包含四个数字的列表：\n- $\\mathcal{P}^{DNS}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$，\n- $\\mathcal{P}^{(0)}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$，\n- $\\nu_t^\\star$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，\n- $R_{12}^{model,\\star}$，单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$。\n\n当一个值根据给定规则在数学上未定义时，对于浮点值，请使用 IEEE 表示 $+\\infty$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试案例的四元数列表按测试套件的顺序排列，例如 $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],\\dots]$。", "solution": "我们从雷诺平均动量方程开始，其中出现了雷诺应力 $R_{ij}=\\overline{u_i' u_j'}$。平均应变率张量定义为 $S_{ij}=\\tfrac{1}{2}\\left(\\partial \\bar{U}_i/\\partial x_j + \\partial \\bar{U}_j/\\partial x_i\\right)$。湍动能生成率由精确恒等式 $\\mathcal{P}=-R_{ij}S_{ij}$ 定义。对于平均速度为 $\\bar{U}_1=S_0 x_2$ 且所有其他平均速度分量为零的均匀剪切流，只有 $S_{12}=S_{21}=S_0/2$ 不为零。\n\n在 Boussinesq 涡黏性假设下，$R_{ij}$ 的偏量部分被建模为 $-2\\nu_t S_{ij}$。对于不可压缩平均流，对角线贡献 $(2/3)k\\delta_{ij}$ 不对生成率产生贡献，因为 $S_{ii}=0$。因此，将该模型代入生成率的定义中得到\n$$\n\\mathcal{P}^{model}=-\\left(-2\\nu_t S_{ij}\\right)S_{ij} = 2\\nu_t S_{ij}S_{ij}.\n$$\n在均匀剪切中，$S_{12}=S_{21}=S_0/2$，所有其他 $S_{ij}=0$，因此\n$$\nS_{ij}S_{ij} = S_{12}^2 + S_{21}^2 = \\left(\\frac{S_0}{2}\\right)^2 + \\left(\\frac{S_0}{2}\\right)^2 = \\frac{S_0^2}{2},\n$$\n所以\n$$\n\\mathcal{P}^{model} = 2\\nu_t \\left(\\frac{S_0^2}{2}\\right) = \\nu_t S_0^2.\n$$\n对于均匀剪切中 DNS 隐含的生成率，只有 $R_{12}$ 有贡献：\n$$\n\\mathcal{P}^{DNS} = -R_{ij}S_{ij} = -(R_{12}S_{12}+R_{21}S_{21}) = -2 R_{12}\\left(\\frac{S_0}{2}\\right) = -R_{12} S_0.\n$$\n\n在统计定常的均匀湍流中，主导阶能量平衡为 $\\mathcal{P}\\approx \\epsilon$，其中 $\\epsilon$ 是耗散率。用 Boussinesq 模型强制实现此平衡可得\n$$\n\\nu_t^\\star S_0^2 \\approx \\epsilon \\quad \\Rightarrow \\quad \\nu_t^\\star = \\frac{\\epsilon}{S_0^2},\n$$\n前提是 $S_0\\ne 0$。如果 $S_0=0$ 且 $\\epsilon=0$，则对于任何有限的 $\\nu_t$，平衡都成立，我们按惯例设定 $\\nu_t^\\star=0$。如果 $S_0=0$ 但 $\\epsilon>0$，则没有有限的 $\\nu_t$ 能满足此平衡，我们设定 $\\nu_t^\\star=+\\infty$ 以标记此不可能性。\n\n为了与一个通用的基准封闭进行比较，我们使用双方程模型类别中广泛采用的代数关系式 $\\nu_t^{(0)} = C_\\mu k^2/\\epsilon$，其中当 $\\epsilon>0$ 时 $C_\\mu=0.09$。对于 $\\epsilon=0$ 且 $k>0$ 的情况，此公式是奇异的，我们设定 $\\nu_t^{(0)}=+\\infty$。如果 $k=0$ 且 $\\epsilon=0$，我们设定 $\\nu_t^{(0)}=0$。相应的均匀剪切基准生成率则为 $\\mathcal{P}^{(0)} = \\nu_t^{(0)} S_0^2$。如果 $S_0=0$，则无论 $\\nu_t$ 是否为有限值，生成率都必须为零，我们明确设定 $\\mathcal{P}^{(0)}=0$ 以避免诸如 $+\\infty \\cdot 0$ 之类的未定义乘积。\n\n最后，在均匀剪切的 Boussinesq 假设下，模型化的剪切应力与 $\\nu_t$ 直接相关：\n$$\n-R_{12}^{model} = 2\\nu_t S_{12} = \\nu_t S_0 \\quad \\Rightarrow \\quad R_{12}^{model} = -\\nu_t S_0.\n$$\n使用 $\\nu_t^\\star$，我们计算 $R_{12}^{model,\\star} = -\\nu_t^\\star S_0$。如果 $S_0=0$，根据定义我们设定 $R_{12}^{model,\\star}=0$，因为平均剪切消失了。\n\n每个测试案例的算法：\n- 读取 $(S_0,k,\\epsilon,R_{12}^{DNS})$。\n- 计算 $\\mathcal{P}^{DNS}=-R_{12}^{DNS} S_0$。\n- 使用 $C_\\mu=0.09$ 并根据上述条件规则计算 $\\nu_t^{(0)}$。\n- 计算 $\\mathcal{P}^{(0)}=\\nu_t^{(0)} S_0^2$；如果 $S_0=0$，则设定 $\\mathcal{P}^{(0)}=0$。\n- 根据上述条件规则计算 $\\nu_t^\\star$。\n- 计算 $R_{12}^{model,\\star}=-\\nu_t^\\star S_0$；如果 $S_0=0$，则设定 $R_{12}^{model,\\star}=0$。\n- 返回 $[\\mathcal{P}^{DNS}, \\mathcal{P}^{(0)}, \\nu_t^\\star, R_{12}^{model,\\star}]$。\n\n将此算法应用于指定的测试套件，使用给定的 SI 单位数值，可为每个案例生成唯一的数值输出列表，包括按规则定义的 $+\\infty$。程序将这些按案例生成的列表汇总成一个单一列表，并按要求格式在单行中打印出来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef baseline_nu_t(Cmu, k, eps):\n    # Compute baseline eddy viscosity nu_t^(0) = Cmu * k^2 / eps with guards.\n    if eps > 0.0:\n        return Cmu * (k ** 2) / eps\n    elif k == 0.0:\n        return 0.0\n    else: # k > 0 and eps == 0\n        return float('inf')\n\ndef adjusted_nu_t(S0, eps):\n    # Compute adjusted eddy viscosity nu_t* = eps / S0^2 with guards.\n    if S0 != 0.0:\n        return eps / (S0 ** 2)\n    elif eps == 0.0:\n        return 0.0\n    else: # S0 == 0 and eps > 0\n        return float('inf')\n\ndef production_dns(S0, R12_dns):\n    # Homogeneous shear: P_DNS = - R12_dns * S0\n    return -R12_dns * S0\n\ndef production_boussinesq(S0, nu_t):\n    # Homogeneous shear: P_model = nu_t * S0^2\n    # Guard S0 == 0 to avoid inf * 0 ambiguities.\n    if S0 == 0.0:\n        return 0.0\n    else:\n        return nu_t * (S0 ** 2)\n\ndef modeled_shear_stress(S0, nu_t):\n    # Boussinesq: R12_model = - nu_t * S0\n    if S0 == 0.0:\n        return 0.0\n    else:\n        return -nu_t * S0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (S0 [1/s], k [m^2/s^2], eps [m^2/s^3], R12_DNS [m^2/s^2])\n    test_cases = [\n        (10.0, 0.5, 1.0, -0.08),   # Case A\n        (0.0, 0.1, 0.0, 0.0),      # Case B\n        (50.0, 2.0, 50.0, -0.9),   # Case C\n        (2.0, 0.05, 0.01, -0.004), # Case D\n        (0.0, 0.1, 0.1, 0.0),      # Case E\n    ]\n    Cmu = 0.09\n\n    results = []\n    for S0, k, eps, R12_dns in test_cases:\n        P_dns = production_dns(S0, R12_dns)\n        nu0 = baseline_nu_t(Cmu, k, eps)\n        P0 = production_boussinesq(S0, nu0)\n        nu_star = adjusted_nu_t(S0, eps)\n        R12_model_star = modeled_shear_stress(S0, nu_star)\n\n        # Collect results for this case\n        results.append([P_dns, P0, nu_star, R12_model_star])\n\n    # Final print statement in the exact required format.\n    # Print Python-style list with floats, including inf where applicable.\n    def format_value(v):\n        # Ensure consistent string representation for floats and inf\n        if isinstance(v, float):\n            if np.isinf(v):\n                return \"inf\"\n            elif np.isneginf(v):\n                return \"-inf\"\n            else:\n                return str(v)\n        return str(v)\n\n    formatted_cases = []\n    for row in results:\n        formatted_row = \"[\" + \",\".join(format_value(x) for x in row) + \"]\"\n        formatted_cases.append(formatted_row)\n\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nsolve()\n```", "id": "3371271"}, {"introduction": "在应用了模型之后，我们现在来研究其一个著名的局限性。在具有强无旋应变的流动中，例如在驻点附近，布辛涅斯克假说可能产生非物理性的结果。本练习将通过检查“可实现性”（realizability）条件的违反情况来展示这种“驻点反常”（stagnation point anomaly）现象，这些条件是雷诺应力必须满足的基本物理约束。[@problem_id:3371220]", "problem": "考虑一个三维不可压缩湍流，其平均速度梯度张量的平均旋转张量为零，而平均应变张量很强，这是驻点边界层的典型特征。设平均应变张量用 $S_{ij}$ 表示，平均旋转张量用 $\\Omega_{ij}$ 表示。假设 $\\Omega_{ij} \\approx 0$，并且 $S_{ij}$ 是可对角化的，其中一个强压缩主方向与 $x$ 轴对齐。为简单起见，采用一个典范表示：\n$$\nS_{ij} = \\mathrm{diag}(-a,\\; a,\\; 0),\n$$\n其中 $a>0$ 且 $\\mathrm{tr}(S)=0$。\n\nBoussinesq 涡粘性假设将雷诺应力张量建模为\n$$\nR_{ij} \\equiv \\langle u_i' u_j' \\rangle \\approx \\frac{2}{3}k \\, \\delta_{ij} - 2 \\nu_t S_{ij},\n$$\n其中 $k$ 是湍动能，$\\nu_t$ 是湍流（涡）运动粘度。定义各向异性张量 $b_{ij}$ 为\n$$\nb_{ij} \\equiv \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij}.\n$$\n湍流的一个必要可实现性条件是 $b_{ij}$ 的特征值位于闭区间 $[-1/3,\\,2/3]$ 内，这意味着每个法向应力分量 $R_{ii}$ 都满足物理边界 $0 \\le R_{ii} \\le 2k$。\n\n在这种无旋强应变情况下，您将研究两个问题：\n\n1) 对流向法向应力的过高预测：仅使用上述定义和可实现性边界，推导出一个关于 $(a, k, \\nu_t)$ 的条件。在此条件下，Boussinesq 假设预测的流向法向应力 $R_{xx}$ 超过了其在 $x$ 方向上与可实现性一致的最大值。将此实现为一个布尔测试，当且仅当发生此类过高预测时返回真。\n\n2) 使用指定的湍流普朗特数对被动标量传热的过低预测：对于平均梯度为 $\\partial \\theta / \\partial x \\equiv G_x$ 的被动标量，梯度扩散闭合给出了沿 $x$ 方向的湍流标量通量为\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx - \\alpha_t \\, G_x, \\quad \\alpha_t \\equiv \\frac{\\nu_t}{\\mathrm{Pr}_t},\n$$\n其中 $\\mathrm{Pr}_t$ 是湍流普朗特数。一个经过充分检验的经验事实是，在 $\\Omega_{ij} \\approx 0$ 的强应变、驻点主导流中，有效湍流普朗特数会下降至接近 0.7 的值，而在弱应变流中，它保持在 0.85 附近。为解决此问题，请使用基于无量纲应变参数\n$$\n\\chi \\equiv \\frac{\\nu_t \\, a}{k}\n$$\n的以下分段常数规则来对此趋势进行建模：\n- 如果 $\\chi \\ge 0.5$，则设置有效值 $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.7$。\n- 如果 $\\chi < 0.5$，则设置有效值 $\\mathrm{Pr}_{t,\\mathrm{true}} = 0.85$。\n\n给定一个用户指定的模型值 $\\mathrm{Pr}_{t,\\mathrm{model}}$，当且仅当使用该模型值计算的湍流热通量的大小小于使用有效值计算的湍流热通量的大小时，才声明该模型过低预测了沿 $x$ 方向的传热，即：\n$$\n\\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|.\n$$\n\n您的任务是编写一个程序，为下面的每个测试用例计算两个布尔值：\n- 第一个布尔值表示 Boussinesq 模型是否因违反与可实现性一致的最大值而过高预测了 $R_{xx}$。\n- 第二个布尔值表示与根据 $\\chi$ 确定的有效值 $\\mathrm{Pr}_{t,\\mathrm{true}}$ 相比，指定的 $\\mathrm{Pr}_{t,\\mathrm{model}}$ 是否过低预测了建模的湍流热通量的大小。\n\n所有量都应视为无量纲数；不要使用物理单位。\n\n测试套件（每个用例以 $(a, k, \\nu_t, \\mathrm{Pr}_{t,\\mathrm{model}}, G_x)$ 的形式给出）：\n- 用例 1（理想路径，弱应变）：$(10.0,\\; 1.0,\\; 0.04,\\; 0.85,\\; 1.0)$。\n- 用例 2（中等强度应变，低于过高预测阈值）：$(10.0,\\; 1.0,\\; 0.06,\\; 0.85,\\; 1.0)$。\n- 用例 3（$R_{xx}$ 过高预测的边界）：$(10.0,\\; 1.0,\\; 0.06666666666666667,\\; 0.85,\\; 1.0)$。\n- 用例 4（强应变，明显的 $R_{xx}$ 过高预测）：$(10.0,\\; 1.0,\\; 0.08,\\; 0.90,\\; 1.0)$。\n- 用例 5（非常强的应变，使用低 $\\mathrm{Pr}_{t,\\mathrm{model}}$ 的模型）：$(10.0,\\; 1.0,\\; 0.12,\\; 0.70,\\; 1.0)$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的配对列表，每个配对是一个测试用例的两个布尔值 $[b_1,b_2]$ 组成的列表，整个列表用方括号括起来。例如，三个用例的输出可能如下所示：\"[[True,False],[False,False],[True,True]]\"。", "solution": "问题陈述经核实具有科学依据、适定且客观。它植根于湍流建模的标准理论，并提出了一套清晰、可解决的任务。我们接下来进行推导和求解。\n\n解决方案要求对每个给定的测试用例评估两个条件。第一个条件涉及 Boussinesq 涡粘性模型对可实现性的违背，第二个条件涉及标量通量模型的准确性。\n\n**1. 流向法向应力 ($R_{xx}$) 过高预测的条件**\n\nBoussinesq 假设将雷诺应力张量 $R_{ij} \\equiv \\langle u_i' u_j' \\rangle$ 建模为平均应变张量 $S_{ij}$ 的线性函数：\n$$\nR_{ij} = \\frac{2}{3}k \\, \\delta_{ij} - 2\\nu_t S_{ij}\n$$\n此处，$k$ 是湍动能，$\\nu_t$ 是涡粘性，$\\delta_{ij}$ 是克罗内克 δ。问题指定了一个无旋驻点流的平均应变张量：\n$$\nS_{ij} = \\mathrm{diag}(-a, a, 0)\n$$\n其中 $a > 0$。我们的任务是找出模型预测的流向法向应力 $R_{xx}$ 超过其与可实现性一致的最大值 $2k$ 的条件。分量 $R_{xx}$ 对应于 $i=1$ 和 $j=1$。使用所提供的 $S_{ij}$ 定义，我们有 $S_{11} = -a$。克罗内克 δ $\\delta_{11}$ 为 $1$。将这些代入 Boussinesq 公式，得到：\n$$\nR_{xx} = R_{11} = \\frac{2}{3}k \\cdot (1) - 2\\nu_t (-a) = \\frac{2}{3}k + 2\\nu_t a\n$$\n如果模型违反了可实现性边界 $R_{xx} \\le 2k$，则称其过高预测了此应力。因此，过高预测的条件是：\n$$\nR_{xx} > 2k\n$$\n代入我们建模的 $R_{xx}$ 的表达式：\n$$\n\\frac{2}{3}k + 2\\nu_t a > 2k\n$$\n我们针对无量纲参数求解此不等式。假设 $k>0$，我们从两边减去 $\\frac{2}{3}k$：\n$$\n2\\nu_t a > 2k - \\frac{2}{3}k\n$$\n$$\n2\\nu_t a > \\frac{4}{3}k\n$$\n两边除以 $2$，然后再除以 $k$（因为 $k>0$），我们得到以无量纲应变参数 $\\chi \\equiv \\frac{\\nu_t a}{k}$ 表示的条件：\n$$\n\\frac{\\nu_t a}{k} > \\frac{2}{3}\n$$\n每个测试用例的第一个布尔结果 $b_1$ 为 `True`，当且仅当 $\\chi > \\frac{2}{3}$。\n\n**2. 被动标量通量过低预测的条件**\n\n沿 $x$ 方向的湍流标量通量 $q_x$ 使用梯度扩散假设进行建模：\n$$\nq_x \\equiv \\langle u_x' \\theta' \\rangle \\approx -\\alpha_t G_x = -\\frac{\\nu_t}{\\mathrm{Pr}_t} G_x\n$$\n其中 $\\mathrm{Pr}_t$ 是湍流普朗特数，$G_x$ 是平均标量梯度。当使用用户指定的模型值 $\\mathrm{Pr}_{t,\\mathrm{model}}$ 计算的通量大小小于使用经验确定的“真实”值 $\\mathrm{Pr}_{t,\\mathrm{true}}$ 计算的通量大小时，定义为传热幅度过低预测：\n$$\n\\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} G_x\\right| < \\left|-\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}} G_x\\right|\n$$\n鉴于 $\\nu_t$、$\\mathrm{Pr}_t$ 和 $|\\mathrm{G}_x|$（对于非平凡梯度）均为正数，我们可以简化此不等式：\n$$\n\\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{model}}} < \\frac{\\nu_t}{\\mathrm{Pr}_{t,\\mathrm{true}}}\n$$\n两边除以 $\\nu_t$ 并取倒数，不等号方向反转：\n$$\n\\mathrm{Pr}_{t,\\mathrm{model}} > \\mathrm{Pr}_{t,\\mathrm{true}}\n$$\n这个简单的不等式就是过低预测的条件。$\\mathrm{Pr}_{t,\\mathrm{true}}$ 的值由无量纲应变参数 $\\chi = \\frac{\\nu_t a}{k}$ 的分段常数函数确定：\n$$\n\\mathrm{Pr}_{t,\\mathrm{true}} =\n\\begin{cases}\n    0.7   \\text{如果 } \\chi \\ge 0.5 \\\\\n    0.85  \\text{如果 } \\chi < 0.5\n\\end{cases}\n$$\n第二个布尔结果 $b_2$ 为 `True`，当且仅当给定的 $\\mathrm{Pr}_{t,\\mathrm{model}}$ 大于根据此规则确定的 $\\mathrm{Pr}_{t,\\mathrm{true}}$ 值。\n\n将要实现的算法将对每个测试用例首先计算 $\\chi = \\frac{\\nu_t a}{k}$，然后评估上面推导出的两个布尔条件。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes two boolean flags for each test case according to the problem statement.\n    1. Boussinesq model overprediction of streamwise normal stress.\n    2. Model underprediction of passive scalar heat transfer.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, k, nu_t, Pr_t_model, G_x)\n    test_cases = [\n        (10.0, 1.0, 0.04, 0.85, 1.0),\n        (10.0, 1.0, 0.06, 0.85, 1.0),\n        (10.0, 1.0, 0.06666666666666667, 0.85, 1.0),\n        (10.0, 1.0, 0.08, 0.90, 1.0),\n        (10.0, 1.0, 0.12, 0.70, 1.0),\n    ]\n\n    results = []\n    \n    # Define constants used in the analysis.\n    RXX_OVERPREDICTION_THRESHOLD = 2.0 / 3.0\n    CHI_PRT_THRESHOLD = 0.5\n    PRT_TRUE_HIGH_STRAIN = 0.7\n    PRT_TRUE_LOW_STRAIN = 0.85\n\n    for case in test_cases:\n        a, k, nu_t, pr_t_model, g_x = case\n\n        # Calculate the dimensionless strain parameter chi.\n        # Assuming k is not zero, which is physically required for turbulence.\n        chi = (nu_t * a) / k\n\n        # Part 1: Check for R_xx overprediction.\n        # The condition derived is chi > 2/3.\n        b1 = chi > RXX_OVERPREDICTION_THRESHOLD\n        \n        # Part 2: Check for heat transfer underprediction.\n        # First, determine the \"true\" turbulent Prandtl number based on chi.\n        if chi >= CHI_PRT_THRESHOLD:\n            pr_t_true = PRT_TRUE_HIGH_STRAIN\n        else:\n            pr_t_true = PRT_TRUE_LOW_STRAIN\n        \n        # The condition for underprediction is Pr_t_model > Pr_t_true.\n        b2 = pr_t_model > pr_t_true\n\n        results.append([b1, b2])\n\n    # Final print statement in the exact required format.\n    # e.g., [[True,False],[False,False],[True,True]]\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3371220"}, {"introduction": "最后的这项练习提供了一种强大而通用的方法来评估布辛涅斯克假说的有效性。该假说的核心假设是雷诺应力各向异性张量 $ a_{ij} $ 与平均应变率张量 $ S_{ij} $ 是对齐的。在这里，您将使用张量分解来精确地量化这种对齐程度，通过计算一个“捕捉分数”（captured fraction）来揭示模型在不同流动情景下捕捉了多少湍流物理。[@problem_id:3371295]", "problem": "您需要实现一个完整的程序，该程序将雷诺应力张量分解为各向同性部分和偏量部分，进一步将偏量部分分解为与平均应变率对齐和不对齐的分量，然后量化由 Boussinesq 涡粘性假设捕获的偏量内容的比例。此任务必须以纯数学术语提出和解决，并且必须在科学上与计算流体动力学保持一致。\n\n请使用以下定义和要求。令雷诺应力张量表示为 $R_{ij}$，平均湍动能表示为 $k$，单位张量表示为 $\\delta_{ij}$，平均应变率张量表示为 $S_{ij}$。假设所有张量均为 $3 \\times 3$、实值和对称张量。定义湍动能为 $k = \\frac{1}{2} R_{kk}$，各向同性部分为 $R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$。定义偏量部分为 $a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$。为二阶张量空间配备 Frobenius 内积 $\\langle A, B \\rangle = A_{ij} B_{ij}$ 和 Frobenius 范数 $\\|A\\|_F = \\sqrt{\\langle A, A \\rangle}$。\n\n将 $a_{ij}$ 分解为两个分量 $a_{ij}^{\\parallel}$ 和 $a_{ij}^{\\perp}$ 的和，其中 $a_{ij}^{\\parallel}$ 是 $a_{ij}$ 在由 $S_{ij}$ 张成的一维子空间上的正交投影，而 $a_{ij}^{\\perp}$ 是在 Frobenius 内积意义下与 $S_{ij}$ 正交的余项。具体来说，如果 $\\langle S, S \\rangle > 0$，定义投影系数 $c = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle}$ 并设置 $a_{ij}^{\\parallel} = c S_{ij}$ 和 $a_{ij}^{\\perp} = a_{ij} - a_{ij}^{\\parallel}$。如果 $\\langle S, S \\rangle = 0$，则设置 $a_{ij}^{\\parallel} = 0$ 和 $a_{ij}^{\\perp} = a_{ij}$。\n\n定义捕获比例 $f$ 为与 $S_{ij}$ 对齐的偏量大小所占的比例：\n$$\nf = \n\\begin{cases}\n\\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2},  \\text{if } \\|a\\|_F > 0, \\\\\n1,  \\text{if } \\|a\\|_F = 0,\n\\end{cases}\n$$\n约定如果 $\\langle S, S \\rangle = 0$ 且 $\\|a\\|_F > 0$，则 $f = 0$。值 $f$ 是无量纲的。其科学解释是，$f$ 量化了可由基于与平均应变率对齐的涡粘性模型表示的雷诺应力偏量部分的比例。\n\n为以下测试套件实现此分解和比例计算，该套件包括不同的流动原型和雷诺数（雷诺数作为元数据提供并且是无量纲的）。每个案例都以数值形式指定 $R_{ij}$ 和 $S_{ij}$：\n\n- 案例1（剪切，中等雷诺数 $Re = 10^4$）：\n  - $R = \\begin{bmatrix} 1.0  -0.6  0.0 \\\\ -0.6  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0  10.0  0.0 \\\\ 10.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n- 案例2（刚体旋转，高雷诺数 $Re = 10^5$）：\n  - $R = \\begin{bmatrix} 1.1333333333333333  0.0  0.0 \\\\ 0.0  1.1333333333333333  0.0 \\\\ 0.0  0.0  1.7333333333333334 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n- 案例3（曲剪切，极高雷诺数 $Re = 2 \\times 10^5$）：\n  - $R = \\begin{bmatrix} 0.4666666666666667  0.3  0.0 \\\\ 0.3  1.2  0.0 \\\\ 0.0  0.0  0.6666666666666666 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 5.0  0.0  0.0 \\\\ 0.0  -5.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n- 案例4（与剪切未对齐的各向异性，雷诺数 $Re = 3 \\times 10^4$）：\n  - $R = \\begin{bmatrix} 0.5333333333333333  0.0  0.0 \\\\ 0.0  1.1333333333333333  0.0 \\\\ 0.0  0.0  0.5333333333333333 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 0.0  10.0  0.0 \\\\ 10.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n- 案例5（具有非零平均应变的各向同性湍流，雷诺数 $Re = 5 \\times 10^3$）：\n  - $R = \\begin{bmatrix} 0.4  0.0  0.0 \\\\ 0.0  0.4  0.0 \\\\ 0.0  0.0  0.4 \\end{bmatrix}$\n  - $S = \\begin{bmatrix} 2.0  0.0  0.0 \\\\ 0.0  -2.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n\n您的程序必须：\n- 对每个案例，计算上述定义的 $k$、$R^{\\mathrm{iso}}_{ij}$、$a_{ij}$、$a_{ij}^{\\parallel}$、$a_{ij}^{\\perp}$ 和捕获比例 $f$。\n- 完全按照所述实现边界约定。\n- 生成单行输出，其中包含所有测试案例的捕获比例，形式为用方括号括起来的逗号分隔列表。每个比例必须四舍五入到六位小数。例如，输出格式必须与 $[f_1,f_2,f_3,f_4,f_5]$ 完全一致，其中每个 $f_i$ 打印为小数点后保留六位的小数。\n- 这些比例是无量纲的，因此输出中不需要物理单位。\n\n此任务不涉及角度。不涉及百分比；必须按规定将比例打印为小数。确保科学真实性以及与上述定义和约定在内部保持一致。算法对于所提供的输入必须是数值鲁棒的，包括 $S_{ij}$ 是零张量或 $a_{ij}$ 是零张量的边界情况。", "solution": "该问题要求实现一个程序来量化雷诺应力各向异性张量与平均应变率张量之间的对齐程度。这种量化是验证 Boussinesq 涡粘性假设的关键一步，该假设是计算流体动力学（CFD）中许多湍流模型的基石。该假设假定雷诺应力张量的偏量部分 $a_{ij}$ 与平均应变率张量 $S_{ij}$ 之间通过一个涡粘性系数 $\\nu_t$ 存在线性关系：$a_{ij} = -2\\nu_t S_{ij}$。这意味着张量 $a_{ij}$ 与张量 $S_{ij}$ 完全对齐（即成比例）。“捕获比例” $f$ 衡量了对于给定的流动数据，这种假设的对齐在多大程度上成立。\n\n解决方案首先形式化数学框架，然后将其应用于每个指定的测试案例。所有张量都假设为 $3 \\times 3$、实值和对称的。\n\n首先，我们基于给定的雷诺应力张量 $R_{ij}$ 定义必要的量。平均湍动能 $k$ 是 $R_{ij}$ 的迹的一半：\n$$k = \\frac{1}{2} R_{kk} = \\frac{1}{2} \\text{tr}(R)$$\n雷诺应力张量 $R_{ij}$ 可以分解为一个各向同性部分 $R^{\\mathrm{iso}}_{ij}$ 和一个偏量（或各向异性）部分 $a_{ij}$。各向同性部分定义为：\n$$R^{\\mathrm{iso}}_{ij} = \\frac{2}{3} k \\delta_{ij}$$\n其中 $\\delta_{ij}$ 是 Kronecker delta（单位张量）。偏量部分 $a_{ij}$ 是剩余部分：\n$$a_{ij} = R_{ij} - R^{\\mathrm{iso}}_{ij}$$\n根据这种构造，张量 $a_{ij}$ 总是无迹的，即 $a_{kk} = 0$。\n\n为了测量张量之间的“大小”和“角度”，我们使用 Frobenius 内积及其诱导范数。对于两个张量 $A$ 和 $B$，内积是它们对应分量乘积之和：\n$$\\langle A, B \\rangle = A_{ij} B_{ij} = \\sum_{i,j} A_{ij} B_{ij}$$\n张量 $A$ 的 Frobenius 范数由下式给出：\n$$\\|A\\|_F = \\sqrt{\\langle A, A \\rangle} = \\sqrt{\\sum_{i,j} A_{ij}^2}$$\n\n问题的核心是将各向异性张量 $a_{ij}$ 分解为一个与平均应变率张量 $S_{ij}$ 对齐的分量 $a_{ij}^{\\parallel}$ 和一个与其正交的分量 $a_{ij}^{\\perp}$。这是通过将 $a_{ij}$ 正交投影到由 $S_{ij}$ 张成的一维子空间上来实现的。\n对齐分量 $a_{ij}^{\\parallel}$ 通过以下方式求得：\n$$a_{ij}^{\\parallel} = \\text{proj}_{S}(a) = \\frac{\\langle a, S \\rangle}{\\langle S, S \\rangle} S_{ij} = c S_{ij}$$\n其中 $c$ 是投影系数。这在 $\\langle S, S \\rangle = \\|S\\|_F^2 > 0$ 时有效。如果 $S_{ij}$ 是零张量，$\\langle S, S \\rangle = 0$，则投影定义为零，因此 $a_{ij}^{\\parallel} = 0$。\n\n捕获比例 $f$ 定义为对齐分量的模的平方与总各向异性张量的模的平方之比：\n$$f = \\frac{\\|a^{\\parallel}\\|_F^2}{\\|a\\|_F^2}$$\n该表达式在 $\\|a\\|_F > 0$ 时有效。如果 $\\|a\\|_F = 0$（即流动是各向同性的），则该比例定义为 $f=1$。\n我们可以推导出更直接的 $f$ 计算公式。代入 $a^{\\parallel}$ 的表达式：\n$$\\|a^{\\parallel}\\|_F^2 = \\|c S\\|_F^2 = c^2 \\|S\\|_F^2 = \\left(\\frac{\\langle a, S \\rangle}{\\|S\\|_F^2}\\right)^2 \\|S\\|_F^2 = \\frac{\\langle a, S \\rangle^2}{\\|S\\|_F^2}$$\n因此，捕获比例变为：\n$$f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$$\n这相当于将张量 $a$ 和 $S$ 视为 $3 \\times 3$ 矩阵的九维空间中的向量时，它们之间夹角的余弦平方。当 $\\|a\\|_F > 0$ 和 $\\|S\\|_F > 0$ 时，此公式用于计算。\n\n完整的算法如下：\n1.  给定张量 $R$ 和 $S$。\n2.  计算 $k = \\frac{1}{2} \\text{tr}(R)$。\n3.  计算 $a = R - \\frac{2}{3} k I$，其中 $I$ 是单位矩阵。\n4.  计算 $\\|a\\|_F^2 = \\sum_{i,j} a_{ij}^2$。\n5.  如果 $\\|a\\|_F^2$ 接近于零，则 $f=1$。\n6.  计算 $\\|S\\|_F^2 = \\sum_{i,j} S_{ij}^2$。\n7.  如果 $\\|S\\|_F^2$ 接近于零（且 $\\|a\\|_F^2$ 不为零），则 $f=0$。\n8.  否则，计算 $\\langle a, S \\rangle = \\sum_{i,j} a_{ij} S_{ij}$。\n9.  计算 $f = \\frac{\\langle a, S \\rangle^2}{\\|a\\|_F^2 \\|S\\|_F^2}$。\n\n我们现在将此过程应用于每个测试案例。\n\n**情况1：**\n$R = \\begin{bmatrix} 1.0  -0.6  0.0 \\\\ -0.6  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0  10.0  0.0 \\\\ 10.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2} (1.0 + 1.0 + 1.0) = 1.5$。\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.5)I = 1.0 I$。\n3.  $a = R - I = \\begin{bmatrix} 0.0  -0.6  0.0 \\\\ -0.6  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$。\n4.  $\\|a\\|_F^2 = (-0.6)^2 + (-0.6)^2 = 0.36 + 0.36 = 0.72$。\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 100 + 100 = 200$。\n6.  $\\langle a, S \\rangle = (-0.6)(10.0) + (-0.6)(10.0) = -12.0$。\n7.  $f_1 = \\frac{(-12.0)^2}{(0.72)(200)} = \\frac{144}{144} = 1.0$。\n\n**情况2：**\n$R = \\begin{bmatrix} 1.133...  0.0  0.0 \\\\ 0.0  1.133...  0.0 \\\\ 0.0  0.0  1.733... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 1.133333 + 1.133333 + 1.733334 = 4.0$。$k = \\frac{1}{2}(4.0) = 2.0$。\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(2.0)I = \\frac{4}{3}I$。$4/3 \\approx 1.333333$。\n3.  $a_{11} = a_{22} = 1.133333 - 1.333333 = -0.2$。$a_{33} = 1.733334 - 1.333333 \\approx 0.4$。\n    $a = \\begin{bmatrix} -0.2  0.0  0.0 \\\\ 0.0  -0.2  0.0 \\\\ 0.0  0.0  0.4 \\end{bmatrix}$。\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (-0.2)^2 + (0.4)^2 = 0.04 + 0.04 + 0.16 = 0.24 > 0$。\n5.  $S$ 是零张量，所以 $\\|S\\|_F^2 = 0$。\n6.  根据问题中对于 $\\|a\\|_F > 0$ 和 $\\|S\\|_F = 0$ 的约定，$f_2 = 0.0$。\n\n**情况3：**\n$R = \\begin{bmatrix} 0.466...  0.3  0.0 \\\\ 0.3  1.2  0.0 \\\\ 0.0  0.0  0.666... \\end{bmatrix}$, $S = \\begin{bmatrix} 5.0  0.0  0.0 \\\\ 0.0  -5.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.466667 + 1.2 + 0.666667 = 2.333334 = 7/3$。$k = \\frac{1}{2}(7/3) = 7/6$。\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(7/6)I = \\frac{7}{9}I$。$7/9 \\approx 0.777778$。\n3.  $a_{11} \\approx 0.466667 - 0.777778 = -0.311111 = -14/45$。\n    $a_{22} = 1.2 - 0.777778 = 0.422222 = 19/45$。\n    $a_{33} \\approx 0.666667 - 0.777778 = -0.111111 = -1/9 = -5/45$。\n    $a_{12}=a_{21}=0.3$。\n4.  $\\|a\\|_F^2 = (-14/45)^2 + (19/45)^2 + (-5/45)^2 + 2(0.3)^2 = \\frac{196+361+25}{2025} + 0.18 = \\frac{582}{2025} + 0.18 \\approx 0.467407$。\n5.  $\\|S\\|_F^2 = 5^2 + (-5)^2 = 50$。\n6.  $\\langle a, S \\rangle = (-14/45)(5) + (19/45)(-5) = \\frac{-70-95}{45} = \\frac{-165}{45} = -11/3$。\n7.  $f_3 = \\frac{(-11/3)^2}{(0.467407...)(50)} = \\frac{121/9}{23.37037...} \\approx 0.575277$。\n\n**情况4：**\n$R = \\begin{bmatrix} 0.533...  0.0  0.0 \\\\ 0.0  1.133...  0.0 \\\\ 0.0  0.0  0.533... \\end{bmatrix}$, $S = \\begin{bmatrix} 0.0  10.0  0.0 \\\\ 10.0  0.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n1.  $\\text{tr}(R) \\approx 0.533333 + 1.133333 + 0.533333 = 2.2$。$k = \\frac{1}{2}(2.2) = 1.1$。\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(1.1)I = \\frac{2.2}{3}I = \\frac{11}{15}I$。$11/15 \\approx 0.733333$。\n3.  $a_{11} \\approx 0.533333 - 0.733333 = -0.2$。\n    $a_{22} \\approx 1.133333 - 0.733333 = 0.4$。\n    $a_{33} \\approx 0.533333 - 0.733333 = -0.2$。非对角线元素为零。\n4.  $\\|a\\|_F^2 = (-0.2)^2 + (0.4)^2 + (-0.2)^2 = 0.04 + 0.16 + 0.04 = 0.24$。\n5.  $\\|S\\|_F^2 = (10.0)^2 + (10.0)^2 = 200$。\n6.  $\\langle a, S \\rangle = a_{12}S_{12} + a_{21}S_{21} = (0)(10) + (0)(10) = 0$。\n7.  $f_4 = \\frac{0^2}{(0.24)(200)} = 0.0$。\n\n**情况5：**\n$R = \\begin{bmatrix} 0.4  0.0  0.0 \\\\ 0.0  0.4  0.0 \\\\ 0.0  0.0  0.4 \\end{bmatrix}$, $S = \\begin{bmatrix} 2.0  0.0  0.0 \\\\ 0.0  -2.0  0.0 \\\\ 0.0  0.0  0.0 \\end{bmatrix}$\n1.  $k = \\frac{1}{2}(0.4 + 0.4 + 0.4) = 0.6$。\n2.  $R^{\\mathrm{iso}} = \\frac{2}{3}(0.6)I = 0.4I$。\n3.  $a = R - R^{\\mathrm{iso}} = 0.4I - 0.4I = \\mathbf{0}$。\n4.  $\\|a\\|_F^2 = 0$。\n5.  根据问题中对于 $\\|a\\|_F = 0$ 的约定，$f_5 = 1.0$。\n\n最终计算出的值为 $f_1 = 1.0$，$f_2 = 0.0$，$f_3 \\approx 0.575277$，$f_4 = 0.0$ 和 $f_5 = 1.0$。", "answer": "```python\nimport numpy as np\n\ndef calculate_captured_fraction(R: np.ndarray, S: np.ndarray) -> float:\n    \"\"\"\n    Computes the fraction of the deviatoric Reynolds stress captured by a\n    Boussinesq-type linear model aligned with the mean rate-of-strain.\n\n    Args:\n        R: The 3x3 Reynolds stress tensor.\n        S: The 3x3 mean rate-of-strain tensor.\n\n    Returns:\n        The captured fraction f, a dimensionless value between 0 and 1.\n    \"\"\"\n    # Use a small tolerance for floating point comparisons to zero.\n    TOL = 1e-12\n\n    # Ensure inputs are numpy arrays with double precision for accuracy.\n    R = np.array(R, dtype=np.float64)\n    S = np.array(S, dtype=np.float64)\n\n    # 1. Calculate turbulent kinetic energy k = 0.5 * tr(R)\n    k = 0.5 * np.trace(R)\n\n    # 2. Calculate the deviatoric Reynolds stress (anisotropy) tensor a\n    a = R - (2.0 / 3.0) * k * np.identity(3)\n\n    # 3. Calculate the squared Frobenius norm of the anisotropy tensor a\n    norm_a_sq = np.sum(a * a)\n\n    # 4. Handle the boundary case where the flow is isotropic (a is zero)\n    if norm_a_sq  TOL:\n        return 1.0\n\n    # 5. Calculate the squared Frobenius norm of the mean strain-rate tensor S\n    norm_s_sq = np.sum(S * S)\n\n    # 6. Handle the boundary case where the mean strain-rate is zero\n    if norm_s_sq  TOL:\n        return 0.0\n        \n    # 7. Calculate the Frobenius inner product of a and S\n    inner_prod = np.sum(a * S)\n\n    # 8. Calculate the captured fraction f\n    f = (inner_prod ** 2) / (norm_a_sq * norm_s_sq)\n    \n    return f\n\ndef solve():\n    \"\"\"\n    Runs the test suite and prints the captured fractions for each case.\n    \"\"\"\n    # Define test cases from the problem statement\n    test_cases = [\n        { # Case 1\n            \"R\": [[1.0, -0.6, 0.0], [-0.6, 1.0, 0.0], [0.0, 0.0, 1.0]],\n            \"S\": [[0.0, 10.0, 0.0], [10.0, 0.0, 0.0], [0.0, 0.0, 0.0]],\n        },\n        { # Case 2\n            \"R\": [[1.1333333333333333, 0.0, 0.0], [0.0, 1.1333333333333333, 0.0], [0.0, 0.0, 1.7333333333333334]],\n            \"S\": [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]],\n        },\n        { # Case 3\n            \"R\": [[0.4666666666666667, 0.3, 0.0], [0.3, 1.2, 0.0], [0.0, 0.0, 0.6666666666666666]],\n            \"S\": [[5.0, 0.0, 0.0], [0.0, -5.0, 0.0], [0.0, 0.0, 0.0]],\n        },\n        { # Case 4\n            \"R\": [[0.5333333333333333, 0.0, 0.0], [0.0, 1.1333333333333333, 0.0], [0.0, 0.0, 0.5333333333333333]],\n            \"S\": [[0.0, 10.0, 0.0], [10.0, 0.0, 0.0], [0.0, 0.0, 0.0]],\n        },\n        { # Case 5\n            \"R\": [[0.4, 0.0, 0.0], [0.0, 0.4, 0.0], [0.0, 0.0, 0.4]],\n            \"S\": [[2.0, 0.0, 0.0], [0.0, -2.0, 0.0], [0.0, 0.0, 0.0]],\n        },\n    ]\n\n    fractions = []\n    for case in test_cases:\n        R_matrix = np.array(case[\"R\"])\n        S_matrix = np.array(case[\"S\"])\n        f = calculate_captured_fraction(R_matrix, S_matrix)\n        fractions.append(f)\n\n    # Format output as a list of strings rounded to 6 decimal places\n    formatted_fractions = [f\"{f:.6f}\" for f in fractions]\n    \n    # Print the final result in the required format\n    print(f\"[{','.join(formatted_fractions)}]\")\n\nsolve()\n```", "id": "3371295"}]}