{"hands_on_practices": [{"introduction": "我们从衰减均匀各向同性湍流这一理想情况开始。这个练习将引导你简化精确的湍动能（TKE）收支方程，展示在没有平均剪切的情况下，湍流的产生如何停止，能量如何随时间耗散。通过应用一个简单的封闭模型，你将求解湍动能的衰减规律，并将其与真实世界的观测结果进行比较，从而体会到模型假设的重要性 ([@problem_id:3379218])。", "problem": "考虑在无界域中，具有零平均剪切和空间均匀平均流的高雷诺数牛顿流体的不可压缩、衰减、均匀各向同性湍流（HIT）。从瞬时不可压缩Navier–Stokes方程出发，使用雷诺分解，定义雷诺应力张量 $R_{ij}=\\overline{u_{i}^{\\prime}u_{j}^{\\prime}}$ 和湍动能 $k=\\tfrac{1}{2}\\overline{u_{i}^{\\prime}u_{i}^{\\prime}}$。推导雷诺应力输运方程的迹所蕴含的精确动能收支方程，然后将其应用于此HIT情景，以证明对产生项$P=0$和$k$的净输运项$T_{k}\\approx 0$的估计是合理的。通过采用常用的高雷诺数模型 $\\varepsilon=C_{\\varepsilon}\\,k^{3/2}/L$ 来封闭剩余的耗散项，其中 $C_{\\varepsilon}$ 是一个正常数，$L$ 是一个积分长度尺度。在一个有限的衰减区间内，假设 $L$ 近似不随时间变化。在初始条件 $k(0)=k_{0}>0$下，求解得到的关于$k(t)$的常微分方程，并确定由幂律行为 $k(t)\\sim A\\,t^{-n}$ (当$t\\to\\infty$时)定义的渐近衰减指数$n$，其中$A>0$是一个常数。将$n$的值作为最终答案。简要评论该预测与报道的由栅格生成的湍流的典型实验衰减指数相比如何。最终答案必须是无单位的单个数字，无需四舍五入。", "solution": "该问题陈述被验证为具有科学依据、适定且客观。它描述了湍流理论中一个经典但理想化的问题——均匀各向同性湍流（HIT）的衰减。其假设、定义和任务在计算流体力学和湍流模型领域都是标准的。在给定的约束条件下，该问题是可解的。\n\n对于密度为常数$\\rho$和运动粘度为$\\nu$的牛顿流体，其瞬时不可压缩Navier-Stokes方程由下式给出：\n$$\n\\frac{\\partial u_i}{\\partial t} + u_j \\frac{\\partial u_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j}\n$$\n并满足不可压缩流动的连续性方程：\n$$\n\\frac{\\partial u_i}{\\partial x_i} = 0\n$$\n我们应用雷诺分解，将瞬时量分解为其时间平均（平均）和脉动分量：$u_i = U_i + u_i'$ 和 $p = P + p'$。根据定义，脉动量的平均值为零，即 $\\overline{u_i'} = 0$。\n\n湍动能（TKE）$k = \\frac{1}{2}\\overline{u_i'u_i'}$的输运方程是通过取雷诺应力输运方程迹的一半来推导的。一个更直接的推导方法是将脉动速度$u_i'$的动量方程乘以$u_i'$然后取平均。得到的精确TKE收支方程是：\n$$\n\\frac{\\partial k}{\\partial t} + U_j \\frac{\\partial k}{\\partial x_j} = P - \\varepsilon - T_k^{\\text{turb}} + T_k^{\\text{press}} + T_k^{\\text{visc}}\n$$\n其中各项为：\n1.  $k$的变化率：左侧的 $\\frac{Dk}{Dt} = \\frac{\\partial k}{\\partial t} + U_j \\frac{\\partial k}{\\partial x_j}$ 是$k$跟随平均流的物质导数。\n2.  产生项 ($P$): $P = -\\overline{u_i'u_j'} \\frac{\\partial U_i}{\\partial x_j}$。该项表示动能从平均流向湍流脉动的转移。它仅在存在平均速度梯度（剪切）时才不为零。\n3.  耗散项 ($\\varepsilon$): $\\varepsilon = \\nu \\overline{\\frac{\\partial u_i'}{\\partial x_j} \\frac{\\partial u_i'}{\\partial x_j}}$。该项表示在最小运动尺度上，TKE通过粘性作用转化为内能（热量）的速率。它始终是一个汇项 ($ \\varepsilon \\ge 0 $)。\n4.  湍流输运项 ($T_k^{\\text{turb}}$): $\\frac{\\partial}{\\partial x_j} \\left(\\frac{1}{2}\\overline{u_i'u_i'u_j'}\\right)$。该项表示由速度脉动自身引起的TKE的空间再分布。\n5.  压力输运项 ($T_k^{\\text{press}}$): $\\frac{\\partial}{\\partial x_j} \\left(\\frac{1}{\\rho}\\overline{p'u_j'}\\right)$。该项描述由压力脉动引起的TKE的空间再分布。\n6.  粘性输运项 ($T_k^{\\text{visc}}$): $-\\nu \\frac{\\partial^2 k}{\\partial x_j \\partial x_j}$。该项描述由粘性力引起的TKE的空间再分布。\n\n$k$的净输运，在问题中表示为$T_k$，是空间再分布项的总和，可以写成散度形式：\n$T_k = \\frac{\\partial}{\\partial x_j} \\left( \\frac{1}{2}\\overline{u_i'u_i'u_j'} + \\frac{1}{\\rho}\\overline{p'u_j'} - \\nu \\frac{\\partial k}{\\partial x_j} \\right)$。\n\n问题指定了均匀各向同性湍流（HIT）。我们现在应用这些条件来简化TKE收支方程。\n- **均匀性**：根据定义，在均匀湍流中，所有单点统计量（如$k$, $\\overline{u_i'u_j'}$等）都与空间位置无关。因此，任何平均量的空间导数都为零。\n    - 问题陈述了“零平均剪切”，这意味着 $\\frac{\\partial U_i}{\\partial x_j} = 0$。因此，产生项恰好为零：$P = -\\overline{u_i'u_j'} \\frac{\\partial U_i}{\\partial x_j} = 0$。\n    - 净输运项 $T_k$ 表示为平均量的散度。由于在均匀湍流中所有平均量的空间导数都为零，净输运项也恰好为零：$T_k = 0$。这证明了问题中给出的估计 $T_k \\approx 0$ 是合理的（对于理想的均匀性，它恰好为零）。\n- **各向同性**：各向同性湍流在统计上对于坐标轴的旋转是不变的。这是一个比均匀性更强的条件，但在这里也同样适用。用于验证$P=0$（如果没有直接假设零剪切）的主要推论是，对于各向同性湍流，雷诺应力张量是对角的：$\\overline{u_i'u_j'} = \\frac{2}{3}k\\delta_{ij}$。对于不可压缩的平均流（$\\frac{\\partial U_i}{\\partial x_i}=0$），这也导致产生项为零：$P = - \\frac{2}{3}k\\delta_{ij}\\frac{\\partial U_i}{\\partial x_j} = - \\frac{2}{3}k\\frac{\\partial U_i}{\\partial x_i} = 0$。\n\n在$P=0$和$T_k=0$的条件下，并注意到在均匀湍流中$U_j \\frac{\\partial k}{\\partial x_j}=0$，TKE收支方程简化为：\n$$\n\\frac{dk}{dt} = -\\varepsilon\n$$\n该方程描述了衰减湍流，其中湍动能仅因粘性耗散而随时间减少。\n\n为了解此方程，我们需要一个关于$\\varepsilon$的“封闭模型”。问题提供了高雷诺数模型：\n$$\n\\varepsilon = C_{\\varepsilon} \\frac{k^{3/2}}{L}\n$$\n其中$C_{\\varepsilon}$是一个正常数，$L$是大涡的一个特征长度尺度，假设其不随时间变化。将此代入简化的TKE方程，得到关于$k(t)$的常微分方程（ODE）：\n$$\n\\frac{dk}{dt} = - \\frac{C_{\\varepsilon}}{L} k^{3/2}\n$$\n这是一个可分离的ODE。我们分离变量：\n$$\nk^{-3/2} dk = - \\frac{C_{\\varepsilon}}{L} dt\n$$\n我们将此方程从初始时间$t=0$（此时$k(0)=k_0$）积分到稍后的时间$t$：\n$$\n\\int_{k_0}^{k(t)} k'^{-3/2} dk' = \\int_0^t - \\frac{C_{\\varepsilon}}{L} dt'\n$$\n$$\n\\left[ \\frac{k'^{-1/2}}{-1/2} \\right]_{k_0}^{k(t)} = - \\frac{C_{\\varepsilon}}{L} t\n$$\n$$\n-2 \\left( k(t)^{-1/2} - k_0^{-1/2} \\right) = - \\frac{C_{\\varepsilon}}{L} t\n$$\n$$\nk(t)^{-1/2} - k_0^{-1/2} = \\frac{C_{\\varepsilon}}{2L} t\n$$\n解出 $k(t)$：\n$$\nk(t)^{-1/2} = k_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t\n$$\n$$\nk(t) = \\left( k_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t \\right)^{-2}\n$$\n问题要求渐近衰减指数$n$，由幂律$k(t) \\sim A t^{-n}$（当$t \\to \\infty$时）定义。在此极限下，关于$t$的线性项主导了常数初始条件项$k_0^{-1/2}$：\n$$\nk_0^{-1/2} + \\frac{C_{\\varepsilon}}{2L} t \\approx \\frac{C_{\\varepsilon}}{2L} t \\quad \\text{for } t \\to \\infty\n$$\n将此近似代回$k(t)$的解中：\n$$\nk(t) \\sim \\left( \\frac{C_{\\varepsilon}}{2L} t \\right)^{-2} = \\left( \\frac{C_{\\varepsilon}}{2L} \\right)^{-2} t^{-2}\n$$\n将此与形式$k(t) \\sim A t^{-n}$比较，我们确定常数$A = (\\frac{C_{\\varepsilon}}{2L})^{-2} = \\frac{4L^2}{C_{\\varepsilon}^2}$，以及最重要的衰减指数：\n$$\nn = 2\n$$\n作为简要评论，这个预测的衰减指数$n=2$显著高于在栅格湍流（这是衰减HIT的常用实验室替代物）实验中通常观测到的值。实验研究通常报告的衰减指数在$n \\approx 1.1 - 1.4$的范围内。这种差异主要源于问题中简化的假设，即积分长度尺度$L$是恒定的。实际上，随着湍流的衰减，大的含能涡倾向于尺寸增大，这意味着$L$随时间增加。考虑$L$增长的更高级理论（例如，假设$L \\propto t^{1/2}$）预测的指数更接近$n=1$，这与实验结果更吻合。", "answer": "$$\\boxed{2}$$", "id": "3379218"}, {"introduction": "Boussinesq 假设提供了一个简单的线性封闭关系，但它在许多复杂流动中会失效。本练习使用平面驻点流来揭示线性模型的关键缺陷：它无法预测湍流的三维特性。然后，你将运用张量不变性和量纲分析的原理，构建一个最小的非线性模型，并根据直接数值模拟（DNS）数据对其进行校准，亲身体验模型改进的过程 ([@problem_id:3379158])。", "problem": "考虑一个不可压缩平面驻点流，其平均速度场定义为 $U_{x}(x,y,z) = a\\,x$, $U_{y}(x,y,z) = -a\\,y$ 和 $U_{z}(x,y,z) = 0$，其中 $a>0$ 是一个常数应变率。对称平均应变率张量为 $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}}\\right)$。该流动是无旋的，其 $S_{ij}$ 为对角张量且迹为零。在雷诺平均湍流模型中，偏运动学雷诺应力张量定义为 $R_{ij} = -\\overline{u_{i}'u_{j}'} + \\frac{2}{3}k\\,\\delta_{ij}$，其中 $k = \\frac{1}{2}\\overline{u_{m}'u_{m}'}$ 是湍动能，$\\delta_{ij}$ 是克罗内克δ函数。经典的线性涡粘（Boussinesq）假设假定 $R_{ij} = 2\\,\\nu_{t}\\,S_{ij}$，其中 $\\nu_{t}$ 是湍流涡粘系数。\n\n您的任务是：\n\n1) 从上述定义和给定的平均速度场出发，显式推导 $S_{ij}$，并证明线性涡粘假设在该流场中意味着 $R_{zz} = 0$。解释为什么这个预测无法表示在平面驻点湍流的直接数值模拟（DNS）中观察到的沿 $z$ 方向的非零法向应力差。\n\n2) 为 $R_{ij}$ 提出了一个最小的非线性扩展，该扩展：\n- 对 $i$ 和 $j$ 是对称的，\n- 是标架无关的，并且仅由平均应变张量 $S_{ij}$ 构建，\n- 是无迹的（即，仅对偏量部分有贡献），\n- 与仅使用 $k$ 和 $\\nu_{t}$ 作为湍流尺度的量纲分析一致，\n并写出其包含一个待定无量纲系数 $\\gamma$ 的通用形式。\n\n3) 使用流场中某一点的以下DNS数据：\n- 应变率大小 $a = 100\\,\\mathrm{s}^{-1}$，\n- 湍动能 $k = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$，\n- 涡粘系数 $\\nu_{t} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$，\n- 偏法向雷诺应力 $R_{xx}^{\\mathrm{DNS}} = 0.12\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{yy}^{\\mathrm{DNS}} = -0.08\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$，\n\n通过匹配偏法向应力的 $z$ 分量来校准您提出的非线性扩展中的系数 $\\gamma$。然后验证相同的 $\\gamma$ 能否恢复给定的 $R_{xx}^{\\mathrm{DNS}}$ 和 $R_{yy}^{\\mathrm{DNS}}$。\n\n将校准后的 $\\gamma$ 作为您的最终答案。将您的答案四舍五入到四位有效数字。$\\gamma$ 不需要单位。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤1：提取已知条件\n- 平均速度场：$U_{x}(x,y,z) = a\\,x$, $U_{y}(x,y,z) = -a\\,y$, 和 $U_{z}(x,y,z) = 0$，应变率 $a > 0$。\n- 平均应变率张量定义：$S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_{i}}{\\partial x_{j}} + \\frac{\\partial U_{j}}{\\partial x_{i}}\\right)$。\n- 流动性质：不可压缩、无旋。\n- 偏运动学雷诺应力张量定义：$R_{ij} = -\\overline{u_{i}'u_{j}'} + \\frac{2}{3}k\\,\\delta_{ij}$。\n- 湍动能定义：$k = \\frac{1}{2}\\overline{u_{m}'u_{m}'}$。\n- 克罗内克δ函数：$\\delta_{ij}$。\n- 线性涡粘（Boussinesq）假设：$R_{ij} = 2\\,\\nu_{t}\\,S_{ij}$，其中 $\\nu_{t}$ 是湍流涡粘系数。\n- 某一点的DNS数据：\n  - 应变率大小：$a = 100\\,\\mathrm{s}^{-1}$。\n  - 湍动能：$k = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n  - 涡粘系数：$\\nu_{t} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n  - 偏法向雷诺应力：$R_{xx}^{\\mathrm{DNS}} = 0.12\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{yy}^{\\mathrm{DNS}} = -0.08\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$, $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题设定在雷诺平均纳维-斯托克斯（RANS）湍流模型的标准框架内。雷诺应力、涡粘性、Boussinesq假设等概念是该领域的基础。所提出的对线性模型的局限性分析以及非线性修正的建立是湍流理论中的一个经典课题。所有定义和原理在科学上都是合理的。\n- **适定性**：问题陈述清晰，包含三个独立且连续的任务。所提供的数据足以完成所有必需的计算。这些问题导向一个唯一且有意义的解。\n- **客观性**：语言精确且专业。给定的数据在问题背景下是客观且可验证的。给定偏应力之和 $R_{xx}^{\\mathrm{DNS}} + R_{yy}^{\\mathrm{DNS}} + R_{zz}^{\\mathrm{DNS}} = 0.12 - 0.08 - 0.04 = 0$，这与偏张量的定义（$R_{ii} = 0$）一致。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它科学合理、适定、客观且自洽。将提供完整解答。\n\n---\n\n**1) 线性涡粘模型分析**\n\n首先，我们计算给定速度场 $U_1 = ax_1$, $U_2 = -ax_2$, $U_3 = 0$ 的平均应变率张量 $S_{ij}$ 的分量。注意，我们使用索引表示法，其中 $(x, y, z)$ 对应于 $(x_1, x_2, x_3)$。\n对角分量为：\n$$S_{11} = \\frac{\\partial U_1}{\\partial x_1} = a$$\n$$S_{22} = \\frac{\\partial U_2}{\\partial x_2} = -a$$\n$$S_{33} = \\frac{\\partial U_3}{\\partial x_3} = 0$$\n非对角分量全为零。例如：\n$$S_{12} = \\frac{1}{2}\\left(\\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1}\\right) = \\frac{1}{2}(0 + 0) = 0$$\n根据对称性，$S_{21} = 0$。类似地，所有其他涉及 $x_3$ 方向的非对角分量也为零。\n因此，平均应变率张量为：\n$$S_{ij} = \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix}$$\n该张量的迹为 $S_{ii} = a - a + 0 = 0$，这与流动不可压缩（$\\nabla \\cdot \\mathbf{U} = S_{ii} = 0$）的条件一致。\n\n现在，我们应用线性涡粘（Boussinesq）假设 $R_{ij} = 2\\,\\nu_{t}\\,S_{ij}$。代入 $S_{ij}$ 的矩阵形式：\n$$R_{ij} = 2\\,\\nu_{t} \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 2\\nu_{t}a  0  0 \\\\ 0  -2\\nu_{t}a  0 \\\\ 0  0  0 \\end{pmatrix}$$\n从此结果可知，分量 $R_{33}$（或 $R_{zz}$）显式地为零：\n$$R_{zz} = 0$$\n所提供的DNS数据显示 $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$，这是非零的。这种差异源于线性模型的一个根本缺陷。Boussinesq假设假定了偏雷诺应力 $R_{ij}$ 与平均应变率 $S_{ij}$ 之间存在直接的线性关系。在此流场中，$z$ 方向的平均应变为零（$S_{zz}=0$），这迫使模型预测该方向的偏法向应力为零（$R_{zz}=0$）。然而，真实的湍流本质上是三维的。即使在平面平均流中，湍流脉动也不局限于该平面，并且通过压力-应变相互作用，湍动能在所有三个分量之间进行重新分配。这导致所有法向雷诺应力都具有非零值，这一现象被称为“回归各向同性”。线性模型未能捕捉到这一关键物理机制，它为一个二维平均流预测了一个二维的湍流状态，这与实验和DNS的观测结果相悖。\n\n**2) 非线性扩展的提议**\n\n我们寻求一个 $R_{ij}$ 的最小非线性扩展，它需满足对称性、标架无关性、无迹性，并由 $S_{ij}$ 构建，同时与使用 $k$ 和 $\\nu_{t}$ 作为湍流尺度的量纲分析一致。\n对于无旋流，$R_{ij}$ 作为 $S_{ij}$ 函数的最一般展开式必须是 $S_{ij}$ 张量积的线性组合。线性项是 $2\\nu_t S_{ij}$。次简单的，或最小的，非线性项是关于 $S_{ij}$ 的二次项。唯一可以由 $S_{ij}$ 构造的对称、标架无关的二阶张量是 $S_{ik}S_{kj}$。\n我们提出的模型形式为：$R_{ij} = 2\\nu_t S_{ij} + (\\text{非线性项})$。非线性项必须是无迹的。$S_{ik}S_{kj}$ 的迹是 $S_{ik}S_{ki} = S_{ij}S_{ij}$（利用 $S_{ij}$ 的对称性），通常不为零。为了使该项无迹，我们必须减去其迹乘以 $\\frac{1}{3}\\delta_{ij}$。因此，非线性扩展的张量部分是 $\\left(S_{ik}S_{kj} - \\frac{1}{3} S_{mn}S_{nm} \\delta_{ij}\\right)$。\n为了量纲一致性，这个新项的前置因子的单位，在乘以 $S_{ik}S_{kj}$ 的单位（$T^{-2}$）后，必须得到 $R_{ij}$ 的单位（$L^2 T^{-2}$）。因此，前置因子的单位必须是 $L^2$。从给定的湍流尺度 $k$（单位 $L^2 T^{-2}$）和 $\\nu_t$（单位 $L^2 T^{-1}$），我们可以构造一个单位为 $L^2$ 的量：$\\frac{\\nu_t^2}{k}$。其单位是 $(L^2 T^{-1})^2 / (L^2 T^{-2}) = (L^4 T^{-2}) / (L^2 T^{-2}) = L^2$。\n结合这些元素，并引入一个无量纲系数 $\\gamma$，最小的非线性扩展为：\n$$R_{ij} = 2\\nu_t S_{ij} + \\gamma \\frac{\\nu_t^2}{k} \\left( S_{ik}S_{kj} - \\frac{1}{3} S_{mn}S_{nm} \\delta_{ij} \\right)$$\n这种形式满足所有陈述的要求。\n\n**3) 系数 $\\gamma$ 的校准**\n\n我们使用特定的流场和DNS数据来校准 $\\gamma$。首先，我们计算该流场的张量项。我们已经有了 $S_{ij}$。\n二次项 $S_{ik}S_{kj}$ 是矩阵乘积 $S^2$：\n$$S_{ik}S_{kj} = \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} a  0  0 \\\\ 0  -a  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} a^2  0  0 \\\\ 0  a^2  0 \\\\ 0  0  0 \\end{pmatrix}$$\n其迹为 $S_{mn}S_{nm} = \\mathrm{Tr}(S^2) = a^2 + a^2 + 0 = 2a^2$。\n现在，我们将这些代入非线性模型方程中计算 $R_{ij}$ 的分量。\n对于 $R_{zz}$（即 $i=j=3$）：\n$$R_{zz} = 2\\nu_t S_{33} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{33} - \\frac{1}{3} (2a^2) \\delta_{33} \\right)$$\n$$R_{zz} = 2\\nu_t(0) + \\gamma \\frac{\\nu_t^2}{k} \\left( 0 - \\frac{2a^2}{3}(1) \\right) = -\\frac{2}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\n我们通过将其设置为DNS值 $R_{zz}^{\\mathrm{DNS}} = -0.04\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$ 来校准 $\\gamma$：\n$$-0.04 = -\\frac{2}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\n求解 $\\gamma$：\n$$\\gamma = \\frac{0.04 \\times \\frac{3}{2} \\times k}{\\nu_t^2 a^2} = \\frac{0.06 k}{\\nu_t^2 a^2}$$\n代入给定值 $a = 100\\,\\mathrm{s}^{-1}$，$k = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$，和 $\\nu_{t} = 5.0\\times 10^{-4}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$：\n$$\\gamma = \\frac{0.06 \\times 0.30}{(5.0 \\times 10^{-4})^2 \\times (100)^2} = \\frac{0.018}{(25 \\times 10^{-8}) \\times 10^4} = \\frac{0.018}{25 \\times 10^{-4}} = \\frac{180}{25} = 7.2$$\n现在，我们通过检查对 $R_{xx}$ 和 $R_{yy}$ 的预测来验证 $\\gamma$ 的这个值。\n对于 $R_{xx}$（即 $i=j=1$）：\n$$R_{xx} = 2\\nu_t S_{11} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{11} - \\frac{1}{3} (2a^2) \\delta_{11} \\right)$$\n$$R_{xx} = 2\\nu_t a + \\gamma \\frac{\\nu_t^2}{k} \\left( a^2 - \\frac{2a^2}{3} \\right) = 2\\nu_t a + \\frac{1}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\n第一项是线性贡献：$2\\nu_t a = 2 \\times (5.0 \\times 10^{-4}) \\times 100 = 0.1\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n第二项是非线性修正。我们可以将其与 $R_{zz}$ 联系起来：$R_{xx}$ 的非线性部分是 $R_{zz}$ 非线性部分的 $-\\frac{1}{2}$ 倍。\n$R_{xx}$ 的非线性修正 = $-\\frac{1}{2} R_{zz}^{\\mathrm{DNS}} = -\\frac{1}{2}(-0.04) = 0.02\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n所以，$R_{xx} = 0.1 + 0.02 = 0.12\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。这与 $R_{xx}^{\\mathrm{DNS}}$ 完全匹配。\n\n对于 $R_{yy}$（即 $i=j=2$）：\n$$R_{yy} = 2\\nu_t S_{22} + \\gamma \\frac{\\nu_t^2}{k} \\left( (S^2)_{22} - \\frac{1}{3} (2a^2) \\delta_{22} \\right)$$\n$$R_{yy} = 2\\nu_t (-a) + \\gamma \\frac{\\nu_t^2}{k} \\left( a^2 - \\frac{2a^2}{3} \\right) = -2\\nu_t a + \\frac{1}{3} \\gamma \\frac{\\nu_t^2 a^2}{k}$$\n线性贡献是 $-0.1\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。非线性修正与 $R_{xx}$ 的相同，为 $0.02\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。\n所以，$R_{yy} = -0.1 + 0.02 = -0.08\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$。这也与 $R_{yy}^{\\mathrm{DNS}}$ 完全匹配。\n因此，校准值 $\\gamma=7.2$ 得到了验证。问题要求答案保留四位有效数字。", "answer": "$$\\boxed{7.200}$$", "id": "3379158"}, {"introduction": "最后一个练习将带你进入现代湍流模型开发的领域，在这里计算工具和数据至关重要。你将编写一个程序，通过对来自均匀剪切流的合成直接数值模拟（DNS）数据进行拟合，来重构压力-应变模型的系数。这项任务涉及应用张量完整性基底，执行线性回归，并实施蒙特卡洛方法来验证所得应力张量的物理可实现性 ([@problem_id:3379167])。", "problem": "您将承担一项基于不可压缩纳维-斯托克斯方程和雷诺平均湍流的建模任务，并且必须将其实现为一个完整的、可运行的程序。任务目标是，通过对由平均应变率张量和平均旋转张量构成的完整性基进行约束回归，利用均匀剪切的直接数值模拟（DNS）数据来重建压力-应变再分配项，然后通过验证雷诺应力张量沿随机方向的非负性来测试其可实现性。\n\n从不可压缩的纳维-斯托克斯方程出发，应用雷诺分解，并使用以下标准定义：\n- 雷诺应力张量（RST）定义为 $R_{ij} = \\langle u_i^{\\prime} u_j^{\\prime} \\rangle$，其中 $u_i^{\\prime}$ 是速度脉动，$\\langle \\cdot \\rangle$ 表示平均运算。\n- 平均速度梯度为 $G_{ij} = \\partial U_i / \\partial x_j$。\n- 平均应变率张量为 $S_{ij} = \\left(G_{ij} + G_{ji}\\right)/2$。\n- 平均旋转张量为 $\\Omega_{ij} = \\left(G_{ij} - G_{ji}\\right)/2$。\n- 压力-应变再分配项为 $\\Pi_{ij}$，在雷诺应力输运方程中，该项是对称且无迹的（即 $\\Pi_{ij} = \\Pi_{ji}$ 且 $\\Pi_{ii} = 0$）。\n\n对于均匀剪切流，平均梯度 $G_{ij}$ 在空间上是恒定的。为了遵循伽利略不变性和张量完整性，我们考虑一个由 $S_{ij}$ 和 $\\Omega_{ij}$ 构建的、最高为二阶的对称无迹张量基。使用以下完整性基：\n- $B_{ij}^{(1)} = S_{ij}$，\n- $B_{ij}^{(2)} = S_{ik}\\Omega_{kj} - \\Omega_{ik}S_{kj}$，\n- $B_{ij}^{(3)} = S_{ik}S_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(S^2)\\,\\delta_{ij}$，\n- $B_{ij}^{(4)} = \\Omega_{ik}\\Omega_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(\\Omega^2)\\,\\delta_{ij}$，\n\n其中 $\\delta_{ij}$ 是克罗内克δ函数，$\\mathrm{tr}(\\cdot)$ 是迹，重复指标表示求和。在不可压缩流中，$\\mathrm{tr}(S) = 0$，因此 $B_{ij}^{(1)}$ 也是无迹的。当 $S_{ij}$ 对称且 $\\Omega_{ij}$ 反对称时，每个 $B_{ij}^{(k)}$ 都是对称且无迹的。\n\n针对每个快照，根据剪切率大小 $\\gamma$ 定义无量纲化矩阵：\n- $S_{ij}^{\\ast} = S_{ij}/\\gamma$，\n- $\\Omega_{ij}^{\\ast} = \\Omega_{ij}/\\gamma$，\n并相应地，通过在上述基中用 $S_{ij}^{\\ast}$ 和 $\\Omega_{ij}^{\\ast}$ 替换 $S_{ij}$ 和 $\\Omega_{ij}$ 来定义 $B_{ij}^{(k)\\ast}$。将归一化的压力-应变项建模为\n$$\n\\widetilde{\\Pi}_{ij} = \\frac{\\Pi_{ij}}{k} = \\gamma \\sum_{k=1}^{4} c_k\\, B_{ij}^{(k)\\ast},\n$$\n其中 $k$ 是湍动能，$c_k$ 是待通过最小二乘法识别的无量纲回归系数。通过构造基的方式，该回归被约束在对称无迹子空间内。您的程序必须使用线性最小二乘法，从合成的DNS快照中重建 $c_k$。\n\n为您提供一个测试套件，包含五个均匀剪切快照，每个快照都由一个剪切率大小 $\\gamma$（单位为 $\\mathrm{s}^{-1}$）和一个恒定的平均梯度矩阵 $G_{ij}$（单位为 $\\mathrm{s}^{-1}$）指定，如下所示。对于旋转情况，使用正常正交变换 $Q$ 和 $G = Q\\,G_0\\,Q^{\\top}$。\n\n- 案例 $1$（$x$–$y$ 平面内的简单剪切）：$\\gamma = 1.0$， $G = \\begin{bmatrix} 0  1.0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$。\n- 案例 $2$（$x$–$z$ 平面内的简单剪切）：$\\gamma = 1.5$， $G = \\begin{bmatrix} 0  0  1.5 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$。\n- 案例 $3$（$y$–$z$ 平面内的简单剪切）：$\\gamma = 2.0$， $G = \\begin{bmatrix} 0  0  0 \\\\ 0  0  2.0 \\\\ 0  0  0 \\end{bmatrix}$。\n- 案例 $４$（案例1绕z轴旋转角度 $\\theta = 45^\\circ$）：$\\gamma = 1.2$， $G_0 = \\begin{bmatrix} 0  1.2  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$，$Q = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{bmatrix}$（内部计算使用弧度）。\n- 案例 $5$（案例2绕x轴旋转角度 $\\theta = 60^\\circ$）：$\\gamma = 1.8$， $G_0 = \\begin{bmatrix} 0  0  1.8 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$，$Q = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\theta  -\\sin\\theta \\\\ 0  \\sin\\theta  \\cos\\theta \\end{bmatrix}$（内部计算使用弧度）。\n\n对于每个案例，假设用于 $\\widetilde{\\Pi}_{ij}$ 的合成DNS数据是由上述模型和未知的真实系数生成的，且不含噪声。您的程序必须使用以弗罗贝尼乌斯范数为目标的线性最小二乘法来重建系数 $c_k$，该方法由所选的对称无迹基隐式约束。\n\n可实现性检验：对于每个案例，您还会得到一个雷诺应力矩阵 $R_{ij}$（单位为 $\\mathrm{m}^2/\\mathrm{s}^2$）用于测试可实现性。一个可实现的 $R_{ij}$ 必须是对称半正定的，即对于任何单位向量 $n_i$，均有 $n_i R_{ij} n_j \\ge 0$。请实现一个蒙特卡洛可实现性检验：在 $\\mathbb{R}^3$ 的单位球面上均匀采样 $N$ 个随机单位向量 $n$，并在一个数值容差范围内验证所有样本都满足 $n^{\\top} R n \\ge 0$。使用 $N = 1000$、一个固定的随机种子，并将任何低于 $-10^{-12}$ 的值视为违反可实现性。\n\n使用以下 $R_{ij}$ 矩阵：\n- 案例 $1$：$R = \\begin{bmatrix} 0.8  0.05  0.0 \\\\ 0.05  0.7  0.0 \\\\ 0.0  0.0  0.6 \\end{bmatrix}$。\n- 案例 $2$：$R = \\begin{bmatrix} 1.0  0.02  0.03 \\\\ 0.02  0.9  0.04 \\\\ 0.03  0.04  0.95 \\end{bmatrix}$。\n- 案例 $3$：$R = \\begin{bmatrix} 0.6  0.01  0.0 \\\\ 0.01  0.6  0.02 \\\\ 0.0  0.02  0.6 \\end{bmatrix}$。\n- 案例 $4$：$R = \\begin{bmatrix} 0.7  -0.1  0.05 \\\\ -0.1  0.8  -0.02 \\\\ 0.05  -0.02  0.75 \\end{bmatrix}$。\n- 案例 $5$：$R = \\begin{bmatrix} 0.5  0.12  -0.08 \\\\ 0.12  0.55  0.06 \\\\ -0.08  0.06  0.5 \\end{bmatrix}$。\n\n您的程序必须：\n- 从每个给定的 $G_{ij}$ 和 $\\gamma$ 计算 $S_{ij}$ 和 $\\Omega_{ij}$。\n- 构建 $S_{ij}^{\\ast}$ 和 $\\Omega_{ij}^{\\ast}$，组合四个基张量 $B_{ij}^{(k)\\ast}$，并构建堆叠的线性系统，以便从合成的DNS数据 $\\widetilde{\\Pi}_{ij}$ 回归出 $c_k$。\n- 执行最小二乘法来估计 $c_k$。\n- 使用 $N = 1000$ 个随机单位向量、一个固定的随机种子和 $10^{-12}$ 的容差，对每个给定的 $R_{ij}$ 执行可实现性检验。\n\n角度单位说明：内部三角函数计算必须使用弧度。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个列表，内含四个重建的系数，后跟五个案例的五个可实现性布尔值。系数必须是浮点数，保留六位小数，布尔值必须是单词 True 或 False。最终输出必须是：\n$[\\text{c1},\\text{c2},\\text{c3},\\text{c4},\\text{b1},\\text{b2},\\text{b3},\\text{b4},\\text{b5}]$，例如，$[0.850000,-0.300000,0.150000,-0.100000,True,True,True,True,True]$。\n\n测试套件覆盖要求：\n- 包括不同平面上的简单剪切的一般情况（案例1-3）。\n- 包括旋转坐标系以确保基的多样性（案例4-5）。\n- 使用可实现性检验来验证在随机方向采样下的对称性和半正定性。\n\n请确保您的实现在科学上具有真实性且内部一致，并按规定格式生成输出。不允许使用外部输入；所有数据必须内嵌在程序中。所有需要单位的量已在上方指定；重建的系数是无量纲的，剪切率 $\\gamma$ 的单位是 $\\mathrm{s}^{-1}$，雷诺应力矩阵 $R_{ij}$ 的单位是 $\\mathrm{m}^2/\\mathrm{s}^2$。", "solution": "用户提供了一项开发湍流模型问题的程序任务。该程序必须从合成数据中重建线性压力-应变模型的系数，并随后测试给定雷诺应力张的可实现性。本文档对问题陈述进行了详细验证，并随后提供了一个原则性的解决方案，概述了必要的理论和计算步骤。\n\n### 问题验证\n\n**第1步：提取的已知条件**\n\n*   **控制方程**：不可压缩纳维-斯托克斯方程，雷诺平均。\n*   **关键张量**：\n    *   雷诺应力张量 (RST)：$R_{ij} = \\langle u_i^{\\prime} u_j^{\\prime} \\rangle$。\n    *   平均速度梯度：$G_{ij} = \\partial U_i / \\partial x_j$。\n    *   平均应变率：$S_{ij} = (G_{ij} + G_{ji})/2$。\n    *   平均旋转：$\\Omega_{ij} = (G_{ij} - G_{ji})/2$。\n    *   压力-应变再分配：$\\Pi_{ij}$，对称且无迹（$\\Pi_{ii} = 0$）。\n*   **流动条件**：均匀剪切，其中 $G_{ij}$ 在空间上是恒定的。\n*   **模型完整性基 ($B_{ij}^{(k)}$)**：\n    *   $B_{ij}^{(1)} = S_{ij}$\n    *   $B_{ij}^{(2)} = S_{ik}\\Omega_{kj} - \\Omega_{ik}S_{kj}$\n    *   $B_{ij}^{(3)} = S_{ik}S_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(S^2)\\,\\delta_{ij}$\n    *   $B_{ij}^{(4)} = \\Omega_{ik}\\Omega_{kj} - \\dfrac{1}{3}\\,\\mathrm{tr}(\\Omega^2)\\,\\delta_{ij}$\n*   **模型公式**：归一化的压力-应变项 $\\widetilde{\\Pi}_{ij} = \\Pi_{ij} / k$ 建模为：\n    $$ \\widetilde{\\Pi}_{ij} = \\gamma \\sum_{k=1}^{4} c_k\\, B_{ij}^{(k)\\ast} $$\n    其中 $k$ 是湍动能，$\\gamma$ 是剪切率大小，$c_k$ 是无量纲系数，$B_{ij}^{(k)\\ast}$ 是由无量纲张量 $S_{ij}^{\\ast} = S_{ij}/\\gamma$ 和 $\\Omega_{ij}^{\\ast} = \\Omega_{ij}/\\gamma$ 构成的基张量。\n*   **任务1：系数重建**：使用五个合成的DNS快照，通过线性最小二乘法估计四个系数 $c_k$。这些快照由模型本身和一组“真实”系数生成，这些系数通过示例输出格式隐式提供。\n*   **任务2：可实现性检验**：使用蒙特卡洛方法，检验给定的雷诺应力矩阵 $R_{ij}$ 是否为对称半正定（$n_i R_{ij} n_j \\geq 0$），其中 $N=1000$ 个随机单位向量 $n_i$。如果 $n_i R_{ij} n_j  -10^{-12}$，则视为违反。\n*   **测试案例**：提供了五个案例，每个案例都带有剪切率 $\\gamma$、平均梯度矩阵 $G_{ij}$ 和用于测试的雷诺应力矩阵 $R_{ij}$。案例4和5涉及坐标旋转。\n*   **输出格式**：单行输出，包含一个列表，其中有四个重建的系数（浮点数，6位小数）和五个可实现性布尔值。例如：`[0.850000,-0.300000,0.150000,-0.100000,True,True,True,True,True]`。\n\n**第2步：使用提取的已知条件进行验证**\n\n已根据验证标准对问题陈述进行了评估。\n\n*   **科学依据充分**：该问题在经典流体力学和湍流理论中有充分的依据。雷诺平均纳维-斯托克斯（RANS）方程、封闭问题概念、压力-应变项以及使用完整性基进行建模，都是该领域的标准和成熟课题（例如，Pope, 1975, \"Turbulent Flows\"）。对雷诺应力张量的可实现性条件也是一个基本的物理约束。\n*   **适定性**：该问题是适定的。核心任务是进行线性回归，以找到4个未知系数 $c_k$。所提供的5个快照中的每一个都会产生一个张量方程。一个对称、无迹的 $3 \\times 3$ 张量有5个自由度。因此，我们有 $5 \\times 5 = 25$ 个线性方程来求解4个未知数。这构成了一个超定系统，按要求可用最小二乘法恰当地求解。包含多样化的流场案例（简单剪切和旋转剪切）确保了在所有案例中综合考虑时，基张量很可能是线性无关的，从而防止回归矩阵出现秩亏。\n*   **客观和完整**：问题陈述语言客观精确。所有必要的数据（所有案例的 $\\gamma, G_{ij}, R_{ij}$）、定义（基张量）和数值参数（$N=1000$，容差 $10^{-12}$）都已提供。\n*   **歧义消解**：“假设用于 $\\widetilde{\\Pi}_{ij}$ 的合成DNS数据是由上述模型和未知的真实系数生成的”这一陈述意味着，就此问题而言，该模型是精确的。一个合理的行动方案是假设一组“真实”系数，生成“测量”数据（$\\widetilde{\\Pi}_{ij}$），然后验证所实现的回归算法能否恢复这些系数。示例输出格式为这些真实系数提供了合理的值，这些值将用于数据合成。\n\n**第3步：结论与行动**\n\n该问题是**有效的**。它是一个一致、科学合理且定义明确的计算任务，代表了湍流模型开发中的典型问题。解决方案将按计划进行。\n\n### 解决方案\n\n该解决方案包括两个主要部分：首先，使用线性回归重建模型系数；其次，对给定的雷诺应力张量进行蒙特卡洛可实现性检验。\n\n**1. 理论公式与回归设置**\n\n核心任务是求解线性模型中的系数 $c_k$：\n$$ \\widetilde{\\Pi}_{ij} = \\gamma \\sum_{k=1}^{4} c_k\\, B_{ij}^{(k)\\ast} $$\n这个张量方程对所提供的 $M=5$ 个快照中的每一个都成立。为了求解四个未知系数 $c_k$，我们可以将这组张量方程转换为一个单一的矩阵-向量线性系统 $A\\mathbf{x} = \\mathbf{b}$，然后使用最小二乘法求解。\n\n一个 $3 \\times 3$ 的对称无迹张量 $T_{ij}$ 有5个独立分量。我们可以定义一个向量化映射 $\\mathrm{vec}(\\cdot)$，将这样一个张量映射到一个 $\\mathbb{R}^5$ 中的向量。对此映射的一个一致选择是：\n$$ \\mathrm{vec}(T) = [T_{11}, T_{22}, T_{12}, T_{13}, T_{23}]^T $$\n请注意，由于无迹条件，$T_{33} = -(T_{11} + T_{22})$；由于对称性，$T_{ji} = T_{ij}$。\n\n将此向量化应用于每个快照 $m \\in \\{1, \\dots, 5\\}$ 的模型方程，可得：\n$$ \\mathrm{vec}(\\widetilde{\\Pi}^{(m)}) = \\gamma^{(m)} \\sum_{k=1}^{4} c_k\\, \\mathrm{vec}(B^{(k)\\ast,(m)}) $$\n这是一个包含5个线性方程的系统，用于求解4个未知数 $c_k$。我们可以汇集所有 $M=5$ 个快照的方程。令 $\\mathbf{x} = [c_1, c_2, c_3, c_4]^T$ 为未知系数向量。令矩阵 $A$ 是一个 $(5M \\times 4)$ 的矩阵，其中第 $k$ 列由每个快照 $m$ 的向量 $\\gamma^{(m)} \\mathrm{vec}(B^{(k)\\ast,(m)})$ 垂直堆叠而成：\n$$\nA_{\\cdot, k} = \\begin{bmatrix}\n\\gamma^{(1)} \\mathrm{vec}(B^{(k)\\ast,(1)}) \\\\\n\\gamma^{(2)} \\mathrm{vec}(B^{(k)\\ast,(2)}) \\\\\n\\vdots \\\\\n\\gamma^{(5)} \\mathrm{vec}(B^{(k)\\ast,(5)})\n\\end{bmatrix}\n$$\n类似地，向量 $\\mathbf{b}$ 是一个 $(5M \\times 1)$ 的向量，由堆叠的向量化“测量”压力-应变项构成：\n$$\n\\mathbf{b} = \\begin{bmatrix}\n\\mathrm{vec}(\\widetilde{\\Pi}^{(1)}) \\\\\n\\mathrm{vec}(\\widetilde{\\Pi}^{(2)}) \\\\\n\\vdots \\\\\n\\mathrm{vec}(\\widetilde{\\Pi}^{(5)})\n\\end{bmatrix}\n$$\n问题现在是标准形式 $A\\mathbf{x} \\approx \\mathbf{b}$。$\\mathbf{x}$ 的最小二乘解使残差的弗罗贝尼乌斯范数 $\\|A\\mathbf{x} - \\mathbf{b}\\|_2$ 最小化，并由 $\\mathbf{x} = (A^T A)^{-1} A^T \\mathbf{b}$ 给出。这将通过数值方法计算。\n\n$\\mathbf{b}$ 的合成数据将使用一组真实系数 $c_{\\text{true}} = [0.85, -0.30, 0.15, -0.10]$ 生成，这一点由问题的示例输出所暗示。对于每个案例 $m$，我们计算 $\\widetilde{\\Pi}_{ij}^{(m)} = \\gamma^{(m)} \\sum_{k=1}^4 c_{k, \\text{true}} B_{ij}^{(k)\\ast, (m)}$，然后构造 $\\mathbf{b}$。\n\n**2. 可实现性检验**\n\n雷诺应力张量 $R_{ij}$ 必须是对称半正定的，才具有物理可实现性。半正定条件要求对于任何非零向量 $n_i$，都有 $n_i R_{ij} n_j \\ge 0$。检验所有单位向量 $n_i$ 就足够了。\n\n直接的解析检验方法是计算 $R_{ij}$ 的特征值，并确保它们都是非负的。但是，问题指定了采用蒙特卡洛方法。这包括：\n1.  生成大量的（$N = 1000$）随机单位向量 $n$，这些向量在 $\\mathbb{R}^3$ 的单位球面上均匀分布。一个标准方法是生成服从标准正态分布的三维向量，然后将每个向量归一化为单位长度。\n2.  对于每个随机单位向量 $n$，计算二次型 $q = n^T R n$。\n3.  如果任何计算出的 $q$ 值小于指定的数值容差 $-10^{-12}$，则认为可实现性条件被违反。\n\n**3. 计算算法**\n\n程序中实现的整体算法将是：\n\n1.  **初始化**：定义五个测试案例及其各自的 $\\gamma$、$G_{ij}$（或其旋转分量）和 $R_{ij}$。定义“真实”系数 $c_{\\text{true}}$。初始化一个空的 $25 \\times 4$ 矩阵 $A$ 和一个空的 $25 \\times 1$ 向量 $\\mathbf{b}$。\n2.  **遍历测试案例进行回归**：对于每个案例 $m=1, \\dots, 5$：\n    a.  计算完整的平均速度梯度张量 $G^{(m)}$。对于旋转案例，这涉及 $G = Q G_0 Q^T$。\n    b.  从 $G^{(m)}$ 计算平均应变率 $S^{(m)}$ 和平均旋转 $\\Omega^{(m)}$ 张量。\n    c.  用 $\\gamma^{(m)}$ 对这些张量进行归一化，得到 $S^{\\ast,(m)}$ 和 $\\Omega^{\\ast,(m)}$。\n    d.  使用定义计算四个基张量 $B^{(k)\\ast,(m)}$。\n    e.  生成合成的压力-应变张量 $\\widetilde{\\Pi}^{(m)} = \\gamma^{(m)} \\sum_{k=1}^4 c_{k, \\text{true}} B^{(k)\\ast,(m)}$。\n    f.  将 $\\widetilde{\\Pi}^{(m)}$ 向量化，并将得到的5个分量放入 $\\mathbf{b}$ 的相应行中。\n    g.  对于每个基张量 $k=1, \\dots, 4$，将 $\\gamma^{(m)} B^{(k)\\ast,(m)}$ 向量化，并将得到的5个分量放入 $A$ 的第 $k$ 列的相应行中。\n3.  **求解系数**：使用数值最小二乘求解器（例如 `numpy.linalg.lstsq`）找到求解 $A\\mathbf{x} = \\mathbf{b}$ 的系数向量 $\\mathbf{x} = [c_1, c_2, c_3, c_4]^T$。\n4.  **遍历测试案例进行可实现性检验**：对于每个案例 $m=1, \\dots, 5$：\n    a.  检索给定的雷诺应力张量 $R^{(m)}$。\n    b.  使用 $N=1000$ 个随机单位向量进行蒙特卡洛可实现性检验。\n    c.  存储布尔结果（True 表示可实现，False 表示不可实现）。\n5.  **最终输出**：将四个恢复的系数格式化为六位小数，并将它们与五个布尔结果组合成一个列表。按指定格式打印该列表。\n\n这种结构化的方法确保了问题的所有要求都以科学和数值的严谨性得到满足。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a turbulence modeling problem: reconstructs pressure-strain model\n    coefficients via least squares and tests Reynolds stress realizability.\n    \"\"\"\n    \n    # Define the \"true\" coefficients to generate synthetic measurement data.\n    # These are inferred from the problem's example output format.\n    c_true = np.array([0.85, -0.30, 0.15, -0.10])\n    \n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"id\": 1,\n            \"gamma\": 1.0,\n            \"G\": np.array([[0.0, 1.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[0.8, 0.05, 0.0], [0.05, 0.7, 0.0], [0.0, 0.0, 0.6]]),\n        },\n        {\n            \"id\": 2,\n            \"gamma\": 1.5,\n            \"G\": np.array([[0.0, 0.0, 1.5], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[1.0, 0.02, 0.03], [0.02, 0.9, 0.04], [0.03, 0.04, 0.95]]),\n        },\n        {\n            \"id\": 3,\n            \"gamma\": 2.0,\n            \"G\": np.array([[0.0, 0.0, 0.0], [0.0, 0.0, 2.0], [0.0, 0.0, 0.0]]),\n            \"R\": np.array([[0.6, 0.01, 0.0], [0.01, 0.6, 0.02], [0.0, 0.02, 0.6]]),\n        },\n        {\n            \"id\": 4,\n            \"gamma\": 1.2,\n            \"G0\": np.array([[0.0, 1.2, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"theta_rad\": np.deg2rad(45),\n            \"Q\": lambda th: np.array([[np.cos(th), -np.sin(th), 0], [np.sin(th), np.cos(th), 0], [0, 0, 1]]),\n            \"R\": np.array([[0.7, -0.1, 0.05], [-0.1, 0.8, -0.02], [0.05, -0.02, 0.75]]),\n        },\n        {\n            \"id\": 5,\n            \"gamma\": 1.8,\n            \"G0\": np.array([[0.0, 0.0, 1.8], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n            \"theta_rad\": np.deg2rad(60),\n            \"Q\": lambda th: np.array([[1, 0, 0], [0, np.cos(th), -np.sin(th)], [0, np.sin(th), np.cos(th)]]),\n            \"R\": np.array([[0.5, 0.12, -0.08], [0.12, 0.55, 0.06], [-0.08, 0.06, 0.5]]),\n        },\n    ]\n\n    # Initialize the global regression system matrices\n    A = np.zeros((5 * 5, 4))\n    b = np.zeros(5 * 5)\n    \n    # Vectorization map for symmetric trace-free 3x3 tensors\n    # T -> [T11, T22, T12, T13, T23]\n    def vectorize_tensor(T):\n        return np.array([T[0, 0], T[1, 1], T[0, 1], T[0, 2], T[1, 2]])\n\n    for i, case in enumerate(test_cases):\n        gamma = case[\"gamma\"]\n        if \"G\" in case:\n            G = case[\"G\"]\n        else:\n            Q = case[\"Q\"](case[\"theta_rad\"])\n            G0 = case[\"G0\"]\n            G = Q @ G0 @ Q.T\n            \n        # Calculate mean rate-of-strain and rotation tensors\n        S = 0.5 * (G + G.T)\n        Omega = 0.5 * (G - G.T)\n\n        # Non-dimensionalize\n        S_star = S / gamma\n        Omega_star = Omega / gamma\n\n        # Calculate basis tensors\n        I = np.identity(3)\n        B_star = [None] * 4\n        \n        # B_ij^(1) = S_ij\n        B_star[0] = S_star\n        \n        # B_ij^(2) = S_ik * Omega_kj - Omega_ik * S_kj\n        B_star[1] = S_star @ Omega_star - Omega_star @ S_star\n        \n        # B_ij^(3) = S_ik * S_kj - 1/3 * tr(S^2) * delta_ij\n        S_star_sq = S_star @ S_star\n        tr_S_star_sq = np.trace(S_star_sq)\n        B_star[2] = S_star_sq - (1/3) * tr_S_star_sq * I\n        \n        # B_ij^(4) = Omega_ik * Omega_kj - 1/3 * tr(Omega^2) * delta_ij\n        Omega_star_sq = Omega_star @ Omega_star\n        tr_Omega_star_sq = np.trace(Omega_star_sq)\n        B_star[3] = Omega_star_sq - (1/3) * tr_Omega_star_sq * I\n        \n        # Generate synthetic DNS data for Pi_tilde\n        Pi_tilde_synthetic = np.zeros((3, 3))\n        for k in range(4):\n            Pi_tilde_synthetic += c_true[k] * B_star[k]\n        Pi_tilde_synthetic *= gamma\n\n        # Assemble the rows for the global A and b matrices for this case\n        row_start = i * 5\n        row_end = row_start + 5\n        b[row_start:row_end] = vectorize_tensor(Pi_tilde_synthetic)\n        \n        for k in range(4):\n            A[row_start:row_end, k] = vectorize_tensor(gamma * B_star[k])\n\n    # Solve the linear least squares problem A*c = b for c\n    c_estimated, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n\n    # Perform realizability check for each case\n    def check_realizability(R, N=1000, seed=0, tol=-1e-12):\n        # R must be symmetric positive semi-definite.\n        # Check symmetry first\n        if not np.allclose(R, R.T):\n            return False\n            \n        # Set seed for reproducibility\n        rng = np.random.default_rng(seed)\n        \n        # Generate N random 3D vectors from a standard normal distribution\n        vecs = rng.standard_normal(size=(N, 3))\n        \n        # Normalize them to get uniform distribution on the unit sphere\n        norms = np.linalg.norm(vecs, axis=1, keepdims=True)\n        unit_vecs = vecs / norms\n        \n        # Calculate n^T * R * n for all vectors n\n        # This is equivalent to sum( (n @ R) * n, axis=1 )\n        quadratic_form_values = np.einsum('ni,ij,nj->n', unit_vecs, R, unit_vecs)\n        \n        # Check if any value is below the tolerance\n        if np.any(quadratic_form_values  tol):\n            return False\n        \n        return True\n\n    realizability_results = []\n    for case in test_cases:\n        realizability_results.append(check_realizability(case[\"R\"]))\n\n    # Prepare final output string\n    formatted_coeffs = [f\"{c:.6f}\" for c in c_estimated]\n    formatted_bools = [str(b) for b in realizability_results]\n    \n    final_list = formatted_coeffs + formatted_bools\n    \n    print(f\"[{','.join(final_list)}]\")\n\n\nsolve()\n```", "id": "3379167"}]}