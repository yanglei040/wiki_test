{"hands_on_practices": [{"introduction": "理论工具不仅用于抽象分析，更在实践中用于诊断和修正数值格式。本练习将分析一个典型的不稳定格式——用于对流方程的前向时间中心空间（FTCS）格式。我们将通过修正方程揭示其内在的不稳定性，并运用冯·诺依曼稳定性分析来精确计算恢复其稳定性所需的人工粘性大小，从而将理论与实践紧密结合起来 [@problem_id:3304527]。", "problem": "考虑定义在周期性域上的一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。使用的网格间距为 $\\Delta x$，时间步长为 $\\Delta t$。该数值格式通过前向欧拉时间离散、平流导数的二阶中心差分以及附加的人工粘性项的标准二阶中心差分来推进 $u$：\n$$\nu_{j}^{n+1}\n=\nu_{j}^{n}\n-\n\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n+\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\n其中 $\\nu \\ge 0$ 是（常数）人工粘性系数。令 Courant–Friedrichs–Lewy (CFL) 数为 $c = a\\,\\Delta t/\\Delta x$，并假设 $|c| \\le 1$。\n\n使用基于泰勒展开和原始偏微分方程的修正方程观点，从机理上解释为何未修正的中心格式（当 $\\nu=0$ 时）是名义上不稳定的，以及添加人工粘性如何在保持相容性的同时抵消这种不稳定性。然后，对上述离散格式进行傅里叶（von Neumann）稳定性分析，以获得波数为 $k$ 的傅里叶模态的放大因子 $G(k)$，并施加要求 $|G(k)| \\le 1$ 对所有波数成立。\n\n当 $|c| \\le 1$ 时，以闭合形式确定人工粘性系数 $\\nu_{\\text{min}}$ 的最小值，该值是 $a$、$\\Delta t$ 和 $\\Delta x$ 的函数，并能确保对所有波数都有 $|G(k)| \\le 1$。将最终答案表示为解析表达式。无需四舍五入，最终表达式中不应包含任何单位。", "solution": "所提出的问题是分析双曲型偏微分方程有限差分格式的一个标准练习。验证过程证实了该问题具有科学依据、是适定的且客观的。所有必要的参数和定义均已提供，不存在任何矛盾。该问题是计算流体动力学领域内一个形式化且可解的问题。因此，我们继续进行完整解答。\n\n按照要求，分析分为两个主要部分。首先，我们使用修正方程方法，为未修正中心差分格式的不稳定性以及人工粘性的稳定化效应提供机理上的解释。其次，我们进行形式化的傅里叶（von Neumann）稳定性分析，以推导人工粘性系数的精确条件。\n\n### 第一部分：修正方程分析与相容性\n\n数值格式由下式给出：\n$$\nu_{j}^{n+1}\n=\nu_{j}^{n}\n-\n\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n+\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\n为了推导该格式实际求解的修正偏微分方程，我们围绕点 $(x_j, t_n)$ 对每一项进行泰勒级数展开，其中 $x_j=j\\Delta x$ 且 $t_n=n\\Delta t$。我们将该点的精确解记为 $u$。\n\\begin{align*} u_{j}^{n+1} = u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3) \\\\ u_{j\\pm 1}^{n} = u \\pm \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4) \\end{align*}\n将这些展开式代入格式，格式可重排为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n=\n-a \\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\,\\Delta x}\n+\n\\nu \\frac{u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}}\n$$\n我们得到：\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a \\left( u_x + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots \\right) + \\nu \\left( u_{xx} + \\frac{(\\Delta x)^2}{12} u_{xxxx} + \\dots \\right)\n$$\n重新整理以匹配原始偏微分方程 $u_t + a u_x = 0$ 的形式，得到截断的偏微分方程：\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} u_{tt} - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n为了得到修正方程，我们必须将右侧的时间导数用空间导数表示。在最低阶上，该格式近似为 $u_t \\approx -a u_x$。对时间求导得到 $u_{tt} \\approx -a u_{xt} = -a \\frac{\\partial}{\\partial x}(u_t) \\approx -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}$。将此代回方程得到：\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n$$\nu_t + a u_x = \\left( \\nu - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n这就是修正方程。领阶误差项是一个二阶导数（扩散）项，其等效扩散系数为 $\\nu_{\\text{eff}} = \\nu - \\frac{a^2 \\Delta t}{2}$。\n\n**未修正格式的不稳定性（$\\nu = 0$）：**\n当 $\\nu=0$ 时，修正方程为 $u_t + a u_x = -\\frac{a^2 \\Delta t}{2} u_{xx} + \\dots$。这是一个具有负扩散系数的平流-扩散方程。负扩散系数会导致解的高频分量被指数级放大，使得数值格式无条件不稳定。这类似于在时间上反向求解热方程。\n\n**使用人工粘性进行稳定化（$\\nu > 0$）：**\n添加系数为 $\\nu$ 的人工粘性项，会在修正方程中引入一个正扩散项 $\\nu u_{xx}$。该项抵消了中心差分格式中固有的负数值扩散。为使格式稳定，等效扩散系数必须为非负，即 $\\nu_{\\text{eff}} \\ge 0$。这要求 $\\nu - \\frac{a^2 \\Delta t}{2} \\ge 0$，或 $\\nu \\ge \\frac{a^2 \\Delta t}{2}$。\n\n**保持相容性：**\n如果一个格式的截断误差在 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时消失，则该格式与一个偏微分方程是相容的。截断误差包含 $\\nu u_{xx}$ 项。如果 $\\nu$ 是一个固定常数，那么该格式将与平流-扩散方程 $u_t + a u_x = \\nu u_{xx}$ 相容，而不是与原始平流方程相容。然而，人工粘性 $\\nu$ 通常被选择为网格参数的函数。正如我们将要展示的，为保证稳定性所需的最小粘性为 $\\nu_{min} = \\frac{a^2 \\Delta t}{2}$。选择该值后，格式中附加项的系数 $\\frac{\\nu \\Delta t}{(\\Delta x)^2}$ 变为 $\\frac{(a^2 \\Delta t/2) \\Delta t}{(\\Delta x)^2} = \\frac{1}{2} (\\frac{a \\Delta t}{\\Delta x})^2 = \\frac{c^2}{2}$。在 $c$ 保持不变的极限下，该项不一定消失。然而，通过选择这个 $\\nu$ 值，修正方程中的领阶误差项 $(\\nu - \\frac{a^2 \\Delta t}{2}) u_{xx}$ 完全消失。该格式变成了 Lax-Wendroff 格式，而已知 Lax-Wendroff 格式与原始偏微分方程 $u_t + a u_x = 0$ 相容，并且是二阶精度的。因此，添加精确适量的人工粘性不仅可以稳定格式，还能提高其精度，并保持与目标偏微分方程的相容性。\n\n### 第二部分：傅里叶（von Neumann）稳定性分析\n\n我们通过考虑解的单个傅里叶模态来分析格式的稳定性：\n$$\nu_j^n = G^n(k) e^{i k x_j}\n$$\n其中 $k$ 是波数，$x_j = j\\Delta x$，$i = \\sqrt{-1}$，$G(k)$ 是每个时间步的放大因子。将此假设形式代入数值格式得到：\n$$\nG(k) e^{i k j \\Delta x} = e^{i k j \\Delta x} - \\frac{a \\Delta t}{2 \\Delta x} (e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x}) + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (e^{i k (j+1) \\Delta x} - 2e^{i k j \\Delta x} + e^{i k (j-1) \\Delta x})\n$$\n除以 $e^{i k j \\Delta x}$ 并化简：\n$$\nG(k) = 1 - \\frac{a \\Delta t}{2 \\Delta x} (e^{i k \\Delta x} - e^{-i k \\Delta x}) + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\n令 $\\theta = k \\Delta x$ 为每个网格单元的相移。使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$ 和 $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$，并定义 CFL 数 $c = \\frac{a \\Delta t}{\\Delta x}$ 和扩散数 $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2}$，我们得到放大因子：\n$$\nG(\\theta) = 1 - \\frac{c}{2}(2i \\sin\\theta) + d(-4\\sin^2(\\theta/2)) = \\left(1 - 4d \\sin^2(\\frac{\\theta}{2})\\right) - i c \\sin\\theta\n$$\n为使格式稳定，对于所有可能的波数，即对于所有 $\\theta \\in [-\\pi, \\pi]$，放大因子的模必须不大于1。\n$$\n|G(\\theta)|^2 \\le 1^2\n$$\n$$\n\\left(1 - 4d \\sin^2(\\frac{\\theta}{2})\\right)^2 + (-c \\sin\\theta)^2 \\le 1\n$$\n使用恒等式 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$，上式变为：\n$$\n1 - 8d \\sin^2(\\frac{\\theta}{2}) + 16d^2 \\sin^4(\\frac{\\theta}{2}) + 4c^2 \\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) \\le 1\n$$\n令 $S = \\sin^2(\\theta/2)$。对于 $\\theta \\in [-\\pi, \\pi]$，我们有 $S \\in [0, 1]$。使用 $\\cos^2(\\theta/2) = 1-S$，该不等式化简为：\n$$\n-8d S + 16d^2 S^2 + 4c^2 S (1 - S) \\le 0\n$$\n对于 $S > 0$，我们可以除以 $S$：\n$$\n-8d + 16d^2 S + 4c^2(1-S) \\le 0\n$$\n$$\nS(16d^2 - 4c^2) + (4c^2 - 8d) \\le 0\n$$\n该不等式对 $S$ 是线性的，并且必须对所有 $S \\in [0, 1]$ 成立。只要该不等式在区间的端点 $S=0$ 和 $S=1$ 处成立，就能保证这一点。\n在 $S=0$ 处：\n$$ 4c^2 - 8d \\le 0 \\implies d \\ge \\frac{c^2}{2} $$\n在 $S=1$ 处：\n$$ (16d^2 - 4c^2) + (4c^2 - 8d) \\le 0 \\implies 16d^2 - 8d \\le 0 \\implies 8d(2d-1) \\le 0 $$\n由于 $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$，这可以化简为 $2d-1 \\le 0$，即 $d \\le \\frac{1}{2}$。\n\n结合这两个条件，稳定性要求为 $\\frac{c^2}{2} \\le d \\le \\frac{1}{2}$。题目指明 $|c| \\le 1$，这确保了 $\\frac{c^2}{2} \\le \\frac{1}{2}$，因此存在满足这两个条件的 $d$ 值。\n\n### 第三部分：确定最小人工粘性\n\n我们寻求确保稳定性的最小人工粘性系数 $\\nu_{\\text{min}}$。这对应于扩散数 $d$ 的最小可能值。从稳定性条件 $d \\ge \\frac{c^2}{2}$，所需的最小值为：\n$$\nd_{\\text{min}} = \\frac{c^2}{2}\n$$\n代回 $d$ 和 $c$ 的定义：\n$$\n\\frac{\\nu_{\\text{min}} \\Delta t}{(\\Delta x)^2} = \\frac{1}{2} \\left( \\frac{a \\Delta t}{\\Delta x} \\right)^2 = \\frac{a^2 (\\Delta t)^2}{2 (\\Delta x)^2}\n$$\n通过乘以 $\\frac{(\\Delta x)^2}{\\Delta t}$ 来求解 $\\nu_{\\text{min}}$（假设 $\\Delta t > 0$）：\n$$\n\\nu_{\\text{min}} = \\frac{a^2 \\Delta t}{2}\n$$\n这是在约束 $|c| \\le 1$ 下，为确保对所有波数都稳定所需的最小人工粘性系数。这个来自严格的 von Neumann 分析的结果，与从修正方程分析中推断出的、为抵消负数值扩散所需的值精确匹配。", "answer": "$$\n\\boxed{\\frac{a^{2} \\Delta t}{2}}\n$$", "id": "3304527"}, {"introduction": "在分析了双层格式之后，我们转向引入了新复杂性的多层格式。蛙跳格式是一个经典的例子，它虽然无耗散且二阶精确，但在产生物理模式的同时，也伴随着一个“寄生”的计算模式。本练习将引导你通过傅里叶分析发现这两种模式，并理解为何即使一个中性稳定的格式也可能产生伪振荡，这是选择时间推进方法时的一个关键考量 [@problem_id:3304581]。", "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数，方程定义在空间步长为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 的均匀时间步上。令 $u_{j}^{n}$ 表示在空间节点 $x_{j} = j\\,\\Delta x$ 和时间层 $t_{n} = n\\,\\Delta t$ 上的网格函数。蛙跳有限差分格式定义为\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\nu \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$。假设采用周期性边界条件和足够光滑的初始数据，从而可以使用傅里叶模态分析。\n\n使用傅里叶（Von Neumann）稳定性分析方法，假设单个傅里叶模态为 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,x_{j}\\right)$，其中 $k \\in \\mathbb{R}$ 是空间波数，$i$ 是虚数单位。推导蛙跳格式的放大因子 $G(k)$，其定义为 $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$。识别并描述任何寄生计算模态，并通过援引 Lax 等价定理，确定它们在对所有 $n \\in \\mathbb{Z}$ 的 $\\hat{u}^{n}$ 有界性意义上的稳定性以及对收敛性的影响。在您的推理中，从 PDE 和格式的定义出发，通过逻辑推导得出放大因子及其模。\n\n将您的最终答案表示为放大因子对 $G_{\\pm}(k)$ 的闭式解，用 $k$、$\\nu$ 和 $\\Delta x$ 表示。所有三角函数均使用弧度制。不需要进行数值舍入，最终表达式中不应出现物理单位。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它提出了偏微分方程（PDE）数值方法分析中的一个标准任务，特别是将傅里叶（Von Neumann）稳定性分析应用于线性平流方程的蛙跳格式。所有术语都定义清晰，目标明确。因此，可以推导出解答。\n\n控制线性平流 PDE 如下：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $u(x,t)$ 是被输运的量，$a \\in \\mathbb{R}$ 是常数波速，下标表示偏微分。蛙跳有限差分格式在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上离散化此 PDE：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\Delta t} + a \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x} = 0\n$$\n整理后得到问题陈述中提供的计算模板：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\frac{a\\,\\Delta t}{\\Delta x} \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n引入 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$，格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\nu \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n为进行 Von Neumann 稳定性分析，我们将单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,x_{j}\\right)$ 代入该格式。此处，$k$ 是波数，$i = \\sqrt{-1}$，且 $x_{j} = j\\,\\Delta x$。相邻点的空间相关性可以相对于中心点 $j$ 表示为：\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,(j+1)\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(i\\,k\\,\\Delta x\\right)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,(j-1)\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\n$$\n将这些表达式以及 $u_{j}^{n+1}$ 和 $u_{j}^{n-1}$ 代入蛙跳格式方程，得到：\n$$\n\\hat{u}^{n+1}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right) = \\hat{u}^{n-1}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right) - \\nu \\left(\\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(i\\,k\\,\\Delta x\\right) - \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\\right)\n$$\n除以公因子 $\\exp(i\\,k\\,j\\Delta x)$，我们得到关于振幅 $\\hat{u}^{n}$ 的线性、齐次、二阶差分方程：\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - \\nu \\hat{u}^{n} \\left(\\exp\\!\\left(i\\,k\\,\\Delta x\\right) - \\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\\right)\n$$\n使用欧拉恒等式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，括号中的项变为 $2i\\sin(k\\,\\Delta x)$。此时振幅的方程为：\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - 2i\\nu\\sin(k\\,\\Delta x)\\,\\hat{u}^{n}\n$$\n$$\n\\hat{u}^{n+1} + 2i\\nu\\sin(k\\,\\Delta x)\\,\\hat{u}^{n} - \\hat{u}^{n-1} = 0\n$$\n问题通过关系式 $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$ 定义放大因子 $G(k)$，这意味着 $\\hat{u}^{n} = G(k)\\,\\hat{u}^{n-1}$，因此 $\\hat{u}^{n} = (G(k))^{n}\\hat{u}^{0}$。将此等比数列形式代入差分方程，得到关于 $G \\equiv G(k)$ 的特征方程：\n$$\nG^{n+1} + 2i\\nu\\sin(k\\,\\Delta x)\\,G^{n} - G^{n-1} = 0\n$$\n除以 $G^{n-1}$ (假设 $G \\neq 0$)，我们得到关于放大因子 $G$ 的二次方程：\n$$\nG^{2} + \\left(2i\\nu\\sin(k\\,\\Delta x)\\right)G - 1 = 0\n$$\n我们使用二次公式 $G = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $G$，其中系数为 $a=1$，$b=2i\\nu\\sin(k\\,\\Delta x)$ 和 $c=-1$。\n$$\nG_{\\pm} = \\frac{-2i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{\\left(2i\\nu\\sin(k\\,\\Delta x)\\right)^{2} - 4(1)(-1)}}{2}\n$$\n$$\nG_{\\pm} = \\frac{-2i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{-4\\nu^{2}\\sin^{2}(k\\,\\Delta x) + 4}}{2}\n$$\n$$\nG_{\\pm}(k) = -i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)}\n$$\n这就是蛙跳格式的两个放大因子。存在两个因子是该格式为三层（或两步）时间方法的直接结果。\n\n振幅的通解是两个模态的线性组合：$\\hat{u}^{n} = c_{1}(G_{+})^{n} + c_{2}(G_{-})^{n}$。为使格式稳定，Von Neumann 准则要求对所有波数 $k$ 都有 $|G(k)| \\leq 1$。我们来考察 $G_{\\pm}$ 的模。\n\n情况1：稳定区域，$|\\nu| \\le 1$。\n如果满足 CFL 条件 $|\\nu| \\le 1$，那么由于 $|\\sin(k\\,\\Delta x)| \\le 1$，我们有 $|\\nu\\sin(k\\,\\Delta x)| \\le 1$。这意味着 $\\nu^{2}\\sin^{2}(k\\,\\Delta x) \\le 1$，所以平方根下的项 $1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)$ 是实数且非负。令 $\\beta = \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)}$。放大因子为 $G_{\\pm} = \\pm\\beta - i\\nu\\sin(k\\,\\Delta x)$。这些复数的模的平方是：\n$$\n|G_{\\pm}|^{2} = (\\pm\\beta)^{2} + (-\\nu\\sin(k\\,\\Delta x))^{2} = \\beta^{2} + \\nu^{2}\\sin^{2}(k\\,\\Delta x)\n$$\n$$\n|G_{\\pm}|^{2} = \\left(1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)\\right) + \\nu^{2}\\sin^{2}(k\\,\\Delta x) = 1\n$$\n因此，当 $|\\nu| \\le 1$ 时，两个放大因子的模都恰好为 $1$。该格式是中性稳定的；它既不放大也不衰减任何傅里叶模态。\n\n情况2：不稳定区域，$|\\nu| > 1$。\n如果 $|\\nu| > 1$，则存在波数 $k$（例如，使得 $|\\sin(k\\Delta x)| > 1/|\\nu|$），对于这些波数，$1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)  0$。平方根变为纯虚数：$\\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} = \\pm i \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}$。\n放大因子为 $G_{\\pm} = -i\\nu\\sin(k\\,\\Delta x) \\pm i\\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}$。这些是纯虚数。我们来考虑其中一个的模：\n$$\n|G_{-}| = \\left|-i\\left(\\nu\\sin(k\\,\\Delta x) + \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}\\right)\\right| = |\\nu\\sin(k\\,\\Delta x)| + \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}\n$$\n对于波数 $k$ 使得 $|\\sin(k\\Delta x)|=1$ 的情况，我们得到 $|G_{-}| = |\\nu| + \\sqrt{\\nu^{2} - 1}$。由于 $|\\nu|1$，很明显 $|G_{-}|  1$。此模态的振幅呈指数增长，导致格式不稳定。\n\n稳定计算（$|\\nu| \\le 1$）下模态的特征：\n物理模态 $G_{+}$ 必须逼近解析放大因子 $G_{\\text{exact}} = \\exp(-iak\\Delta t) = \\exp(-i\\nu k\\Delta x)$。对于小的 $k\\Delta x$，我们展开 $G_{+}$：\n$$\nG_{+}(k) = \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} - i\\nu\\sin(k\\,\\Delta x)\n$$\n对于小的 $z=k\\Delta x$，使用 $\\sin(z) \\approx z - z^3/6$ 和 $\\sqrt{1-y} \\approx 1-y/2$：\n$$\nG_{+}(k) \\approx \\left(1 - \\frac{1}{2}\\nu^2(k\\Delta x)^2\\right) - i\\nu(k\\Delta x)\n$$\n精确因子的展开式为 $G_{\\text{exact}} \\approx 1 - i\\nu(k\\Delta x) - \\frac{1}{2}\\nu^2(k\\Delta x)^2$。两个展开式在二阶项上匹配。这证实了 $G_{+}$ 是物理模态，且该格式是二阶精度的。\n\n寄生模态是 $G_{-}$。对于小的 $k\\Delta x$，其展开式为：\n$$\nG_{-}(k) = -\\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} - i\\nu\\sin(k\\,\\Delta x)\n$$\n$$\nG_{-}(k) \\approx -\\left(1 - \\frac{1}{2}\\nu^2(k\\Delta x)^2\\right) - i\\nu(k\\Delta x) \\approx -1 - i\\nu(k\\Delta x)\n$$\n当 $k\\Delta x \\to 0$（长波极限）时，$G_{+}(k) \\to 1$ 而 $G_{-}(k) \\to -1$。项 $(G_{-})^{n} \\approx (-1)^{n}$ 引入了周期为 $2\\Delta t$ 的振荡。这种高频振荡是时间中心差分的人为产物，在 PDE 中没有物理基础。这就是寄生计算模态。由于 $|G_{-}|=1$，该模态不会衰减并且会持续存在，有可能污染物理（真实）解。\n\n对收敛性的影响：Lax 等价定理指出，对于一个相容的线性有限差分格式，稳定性是收敛的充要条件。\n1.  **相容性：** 蛙跳格式是平流方程的一个相容离散化，其截断误差为 $O(\\Delta t^2, \\Delta x^2)$。\n2.  **稳定性：** 如前所示，当且仅当满足 CFL 条件 $|\\nu| \\le 1$ 时，该格式是稳定的（中性稳定）。\n\n因此，根据 Lax 等价定理，当 $\\Delta t, \\Delta x \\to 0$ 时（前提是 $|\\nu|$ 是常数且 $\\le 1$），蛙跳格式收敛于真实解。然而，未衰减的寄生模态的存在是一个重大的实际问题。尽管数值解在极限情况下是收敛的，但对于任何有限的网格分辨率，解都可能被虚假的 $2\\Delta t$ 振荡所污染，其初始振幅取决于启动三层格式所使用的方法。", "answer": "$$\n\\boxed{\\begin{pmatrix} -i\\nu \\sin(k\\Delta x) + \\sqrt{1 - \\nu^2 \\sin^2(k\\Delta x)} \\\\ -i\\nu \\sin(k\\Delta x) - \\sqrt{1 - \\nu^2 \\sin^2(k\\Delta x)} \\end{pmatrix}}\n$$", "id": "3304581"}, {"introduction": "拉克斯等价定理（Lax Equivalence Theorem）为线性问题提供了强有力的收敛性保证，然而在包含间断的实际计算流体力学问题中，线性理论可能具有误导性。最后的这个实践练习将通过编程实现，对比一个高阶（Lax-Wendroff）格式与一个一阶（迎风）格式在阶跃间断附近的行为。你将亲手验证吉布斯振荡（Gibbs-like oscillations）等现象，并理解总变差递减（TVD）这类非线性稳定性概念的重要性 [@problem_id:3304576]。", "problem": "考虑一个周期性域上的一维线性平流初值问题，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\\quad x \\in [0,1),\\ t \\ge 0,\n$$\n其中平流速度 $a  0$ 为常数。使用以下基本依据：\n- 对于一个有限差分格式，相容性的定义是，当网格间距 $\\Delta x \\to 0$ 和时间步长 $\\Delta t \\to 0$ 时，其局部截断误差趋于零，其中库朗数 $C = a \\Delta t/\\Delta x$ 固定。\n- 对于线性常系数格式，线性（冯·诺依曼）稳定性通过傅里叶模 $e^{i j \\theta}$ 的放大因子 $G(\\theta)$ 来评估，稳定性要求 $\\max_{\\theta \\in [0,\\pi]} |G(\\theta)| \\le 1$。\n- Lax等价定理指出：对于一个具有相容有限差分格式的线性初值问题，线性稳定性等价于在与稳定性估计相关的范数下的收敛性。\n- 总变差递减（TVD）是一种非线性稳定性属性，要求离散总变差 $TV(u^n) = \\sum_j |u^n_{j+1} - u^n_j|$ 不随时间增加。\n\n您将构建一个数值示例，该示例展示了一个相容但非TVD的二阶格式在间断点附近的类吉布斯振荡，并量化说明为什么Lax等价定理不保证非线性稳定性。实现两种具有周期性边界条件的显式格式：\n1. 一种二阶Lax–Wendroff格式：\n$$\nu^{n+1}_j = u^n_j - \\frac{C}{2} \\left(u^n_{j+1} - u^n_{j-1}\\right) + \\frac{C^2}{2} \\left(u^n_{j+1} - 2 u^n_j + u^n_{j-1}\\right),\n$$\n其中 $C = a \\Delta t/\\Delta x$。\n2. 一种针对 $a  0$ 的一阶迎风（差分单元）格式：\n$$\nu^{n+1}_j = u^n_j - C \\left(u^n_j - u^n_{j-1}\\right).\n$$\n\n为两种情况定义初始数据：\n- 间断阶跃：\n$$\nu_0(x) = \\begin{cases}\n1, 0 \\le x  0.5,\\\\\n0, 0.5 \\le x  1,\n\\end{cases}\n$$\n其在 $t=0$ 时的界为 $u \\in [0,1]$。\n- 光滑波：\n$$\nu_0(x) = \\sin(2\\pi x),\n$$\n其精确解为 $u(x,t) = \\sin\\left(2\\pi(x - a t)\\right)$。\n\n使用以下测试套件。在每个测试中，取 $a = 1$，周期性域 $[0,1)$ 被离散化为 $N$ 个点，位置为 $x_j = j \\Delta x$，其中 $\\Delta x = 1/N$, $j = 0,1,\\dots,N-1$。使用时间步长 $\\Delta t = C \\Delta x / a$ 演化到指定的最终时间 $T$，执行大小为 $\\Delta t$ 的完整步长，如果需要，则执行一个大小为 $T - n \\Delta t$ 的最后一步，以使总演化时间恰好为 $T$。\n\n- 测试1（理想情况）：Lax–Wendroff格式，间断阶跃初始数据，$N = 400$，$C = 0.5$，$T = 0.25$。计算过冲振幅\n$$\n\\mathrm{OS} = \\max\\left(\\max_j u^n_j - 1,\\ 0,\\ -\\min_j u^n_j\\right),\n$$\n它衡量了对物理界限 $[0,1]$ 的违反程度。\n- 测试2（边界库朗数）：Lax–Wendroff格式，间断阶跃初始数据，$N = 400$，$C = 1.0$，$T = 0.25$。计算 $\\mathrm{OS}$。\n- 测试3（单调格式比较）：迎风格式，间断阶跃初始数据，$N = 400$，$C = 0.5$，$T = 0.25$。计算 $\\mathrm{OS}$。\n- 测试4（线性稳定性检查）：对于Lax–Wendroff格式，计算傅里叶模角 $\\theta \\in [0,\\pi]$ 的放大因子\n$$\nG(\\theta; C) = 1 - i C \\sin\\theta - C^2 (1 - \\cos\\theta),\n$$\n并返回一个布尔值，指示是否 $\\max_{\\theta \\in [0,\\pi]} |G(\\theta; 0.5)| \\le 1$。\n- 测试5（边界附近的线性稳定性）：返回一个布尔值，指示是否 $\\max_{\\theta \\in [0,\\pi]} |G(\\theta; 1.0)| \\le 1$。\n- 测试6（光滑数据上的收敛阶）：Lax–Wendroff格式，光滑初始数据 $u_0(x) = \\sin(2\\pi x)$，$T = 0.25$，使用 $N_1 = 200$ 和 $N_2 = 400$，两者均在 $C = 0.5$。计算每个 $N$ 的离散 $\\ell^2$ 误差 $E_N = \\left(\\Delta x \\sum_j \\left(u^{N}(x_j,T) - u_{\\text{exact}}(x_j,T)\\right)^2\\right)^{1/2}$，并报告观测到的阶\n$$\np = \\log_2\\left(\\frac{E_{N_1}}{E_{N_2}}\\right).\n$$\n- 测试7（间断上的总变差增长）：Lax–Wendroff格式，间断阶跃初始数据，$N = 400$，$C = 0.5$，$T = 0.25$。计算总变差比率\n$$\nR_{\\mathrm{TV}} = \\frac{TV(u(\\cdot,T))}{TV(u(\\cdot,0))},\\quad TV(u) = \\sum_{j=0}^{N-1} \\left|u_{j+1} - u_j\\right|,\n$$\n其中使用周期性索引 $u_N \\equiv u_0$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，`[result1,result2,result3,...]`）。输出必须按顺序为：\n1. 测试1的过冲振幅 $\\mathrm{OS}$，为浮点数。\n2. 测试2的过冲振幅 $\\mathrm{OS}$，为浮点数。\n3. 测试3的过冲振幅 $\\mathrm{OS}$，为浮点数。\n4. 测试4的线性稳定性，为布尔值。\n5. 测试5的线性稳定性，为布尔值。\n6. 测试6的观测阶 $p$，为浮点数。\n7. 测试7的总变差比率 $R_{\\mathrm{TV}}$，为浮点数。\n\n不需要物理单位。放大因子中用于 $\\theta$ 的角度必须以弧度处理。将每个数值输出直接表示为列表中的浮点数或布尔值，不带百分号或单位。", "solution": "所提出的问题是计算流体力学领域中一个适定且标准的练习，特别涉及一维线性平流方程的数值解。它要求实现和分析两种有限差分格式，以展示由Lax等价定理所概括的相容性、稳定性和收敛性的基本概念，并强调该定理在非线性稳定性现象（如吉布斯振荡）方面的局限性。该问题具有科学依据，内部一致，并为获得唯一解提供了所有必要的数据。\n\n我们的任务是求解周期性域上的一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0, \\quad x \\in [0,1), \\ t \\ge 0\n$$\n其中 $a  0$ 是一个恒定的平流速度。解 $u(x,t)$ 表示一个以速度 $a$ 传输（平流）而不改变其形状的量。精确解由 $u(x,t) = u_0(x-at)$ 给出，其中 $u_0(x)$ 是初始条件。我们将空间域 $[0,1)$ 离散化为 $N$ 个点 $x_j = j \\Delta x$，其中 $j = 0, 1, \\dots, N-1$ 且 $\\Delta x = 1/N$。时间域用时间步长 $\\Delta t$ 进行离散化。它们之间的关系由Courant-Friedrichs-Lewy（CFL）数给出，$C = a \\Delta t / \\Delta x$。\n\n该问题要求对两种数值格式进行比较分析：\n\n1. 二阶Lax-Wendroff (LW) 格式：\n$$\nu^{n+1}_j = u^n_j - \\frac{C}{2} \\left(u^n_{j+1} - u^n_{j-1}\\right) + \\frac{C^2}{2} \\left(u^n_{j+1} - 2 u^n_j + u^n_{j-1}\\right)\n$$\n该格式由 $u(x, t+\\Delta t)$ 在时间上的泰勒级数展开推导而来，利用控制偏微分方程将时间导数替换为空间导数。它在空间和时间上都是二阶精确的，记为 $\\mathcal{O}(\\Delta x^2, \\Delta t^2)$。\n\n2. 一阶迎风 (FOU) 或差分单元格式 (针对 $a0$)：\n$$\nu^{n+1}_j = u^n_j - C \\left(u^n_j - u^n_{j-1}\\right)\n$$\n该格式由空间导数的后向差分推导而来，尊重波的传播方向（“迎风”方向）。它仅为一阶精确，$\\mathcal{O}(\\Delta x, \\Delta t)$，并且已知会引入显著的数值扩散，从而模糊解的尖锐特征。\n\n这个问题的中心主题是数值格式三个关键属性之间的关系：\n-   **相容性**：如果一个格式的局部截断误差——将离散算子应用于精确解时产生的误差——在 $\\Delta x \\to 0$ 和 $\\Delta t \\to 0$ 时消失，则该格式是相容的。LW和FOU格式都与平流方程相容。\n-   **稳定性**：如果在计算过程中误差不被放大，则格式是稳定的。对于线性常系数问题，这通过冯·诺依曼稳定性分析进行评估。我们寻找单个傅里叶模 $u^n_j \\propto G^n e^{i j \\theta}$ 的放大因子 $G(\\theta)$。稳定性要求对所有傅里叶波数 $\\theta$ 都有 $|G(\\theta)| \\le 1$。对于Lax-Wendroff格式，放大因子为 $G(\\theta; C) = 1 - i C \\sin\\theta - C^2 (1 - \\cos\\theta)$。其模的平方为 $|G(\\theta;C)|^2 = 1 - 4C^2(1-C^2)\\sin^4(\\theta/2)$。为了使其小于或等于1，我们需要 $C^2(1-C^2) \\ge 0$。由于 $C^2 \\ge 0$，该条件简化为 $1-C^2 \\ge 0$，即 $|C| \\le 1$。因此，Lax-Wendroff格式对于高达1的库朗数是线性稳定的。\n-   **收敛性**：如果数值解在网格细化时趋近于真实解，则格式是收敛的。**Lax等价定理**提供了基石般的联系：对于应用于适定线性初值问题的相容格式，稳定性是收敛的充要条件。\n\n然而，Lax等价定理仅保证在特定范数（例如 $\\ell^2$ 范数）下的收敛性。它不保证逐点收敛或解的定性特征的保持。正是在这里，**非线性稳定性**的概念变得至关重要，特别是对于具有尖锐梯度或间断的问题。一个关键属性是**总变差递减 (TVD)**，这意味着离散解的总变差 $TV(u^n) = \\sum_j |u^n_{j+1} - u^n_j|$ 不随时间增加。TVD格式不会产生新的振荡。**Godunov定理**指出，任何线性的TVD格式最多只有一阶精度。这个深刻的结果意味着像Lax-Wendroff这样的高阶线性格式*不可能*是TVD的。因此，尽管它对于光滑问题是线性稳定和收敛的，但预计它会在间断点附近产生非物理振荡（吉布斯现象）。另一方面，一阶迎风格式对于 $C \\in [0,1]$ 是TVD的，不会产生此类振荡，但代价是过度的数值扩散。\n\n本问题中的一系列测试旨在通过数值方式验证这些理论要点。\n\n-   **测试1和2**：将LW格式应用于间断阶跃剖面。对于 $C=0.5$，该格式在其稳定性极限内，但不是TVD的，因此我们预计会产生非物理的过冲和下冲，导致 $\\mathrm{OS}  0$。对于 $C=1.0$ 的特殊情况，LW格式简化为 $u^{n+1}_j = u^n_{j-1}$，这相当于每个时间步将数据精确地移动一个网格单元。对于这个特定的库朗数，该格式是无耗散和无色散的，能够完美地平移阶跃函数。因此，我们期望 $\\mathrm{OS} = 0$。\n\n-   **测试3**：将一阶迎风格式应用于相同的阶跃剖面，其中 $C=0.5$。由于该格式对于 $C \\in [0,1]$ 是TVD的，它不会产生新的极值。解将保持在其初始最小值和最大值 $[0,1]$ 的界限内。因此，过冲 $\\mathrm{OS}$ 必须为 $0$。\n\n-   **测试4和5**：这些测试直接验证了LW格式的线性稳定性分析。基于稳定性要求 $|C| \\le 1$ 的推导，我们期望发现稳定性条件 $\\max_\\theta |G(\\theta; C)| \\le 1$ 对 $C=0.5$ 和 $C=1.0$ 都成立。\n\n-   **测试6**：该测试评估LW格式在光滑正弦波上的收敛率。Lax等价定理保证了收敛性。由于LW是二阶格式，其误差应随网格间距 $\\Delta x$ 的减小而呈二次方下降。通过将 $\\Delta x$ 减半（从 $N_1=200$ 到 $N_2=400$），$\\ell^2$ 误差 $E_N$ 应减少约 $2^2=4$ 倍。因此，观测到的收敛阶 $p = \\log_2(E_{N_1}/E_{N_2})$ 应约等于 $2$。\n\n-   **测试7**：该测试量化了LW格式应用于间断剖面时的非TVD性质。对于周期域上从1到0的阶跃，初始总变差为 $TV(u^0) = |0-1| + |1-0| = 2$。格式产生的振荡将增加相邻网格点之间的绝对差之和，导致最终总变差 $TV(u(\\cdot,T))  TV(u^0)$。因此，比率 $R_{\\mathrm{TV}}$ 将大于1。\n\n以下计算将实现这些测试，为理论讨论提供量化证据。实现将使用周期性边界条件，这可以通过解数组的循环移位来高效处理。所有模拟都演化到一个时间 $T$，该时间是时间步长 $\\Delta t$ 的整数倍，从而简化了时间推进循环。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical analysis problem by running seven distinct tests on finite difference schemes\n    for the 1D linear advection equation.\n    \"\"\"\n\n    # --- Helper Functions for Schemes and Simulation ---\n\n    def lw_step(u, C):\n        \"\"\"Performs one time step of the Lax-Wendroff scheme.\"\"\"\n        u_jp1 = np.roll(u, -1)\n        u_jm1 = np.roll(u, 1)\n        u_new = u - (C / 2.0) * (u_jp1 - u_jm1) + \\\n                (C**2 / 2.0) * (u_jp1 - 2.0 * u + u_jm1)\n        return u_new\n\n    def fou_step(u, C):\n        \"\"\"Performs one time step of the first-order upwind scheme (a0).\"\"\"\n        u_jm1 = np.roll(u, 1)\n        u_new = u - C * (u - u_jm1)\n        return u_new\n\n    def run_simulation(scheme_func, u0, N, C, T, a):\n        \"\"\"\n        Runs a simulation from t=0 to t=T.\n        Note: The problem statement specifies a final smaller timestep if T is not a\n        multiple of dt. However, for all given test cases, T is an exact\n        multiple of dt, so this logic is not triggered.\n        \"\"\"\n        dx = 1.0 / N\n        dt = C * dx / a\n        \n        # In all test cases, T/dt is an integer, so we can use round().\n        num_steps = int(round(T / dt))\n        \n        u = np.copy(u0)\n        for _ in range(num_steps):\n            u = scheme_func(u, C)\n        return u\n\n    # --- Test Case Implementations ---\n\n    def test1():\n        \"\"\"Lax–Wendroff, discontinuous step, C=0.5. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test2():\n        \"\"\"Lax–Wendroff, discontinuous step, C=1.0. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 1.0, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test3():\n        \"\"\"Upwind, discontinuous step, C=0.5. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(fou_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test4():\n        \"\"\"Lax–Wendroff, linear stability check for C=0.5.\"\"\"\n        C = 0.5\n        theta = np.linspace(0, np.pi, 2001)  # A fine grid for theta\n        # Formula for amplification factor G\n        G = 1 - 1j * C * np.sin(theta) - C**2 * (1 - np.cos(theta))\n        max_G_abs = np.max(np.abs(G))\n        # Use a small tolerance for floating point comparisons\n        return max_G_abs = 1.0 + 1e-9\n\n    def test5():\n        \"\"\"Lax–Wendroff, linear stability check for C=1.0.\"\"\"\n        C = 1.0\n        theta = np.linspace(0, np.pi, 2001)\n        G = 1 - 1j * C * np.sin(theta) - C**2 * (1 - np.cos(theta))\n        max_G_abs = np.max(np.abs(G))\n        return max_G_abs = 1.0 + 1e-9\n\n    def test6():\n        \"\"\"Lax-Wendroff, convergence order on smooth data.\"\"\"\n        T, C, a = 0.25, 0.5, 1.0\n        \n        # Coarse grid (N1)\n        N1 = 200\n        x1 = np.linspace(0, 1, N1, endpoint=False)\n        dx1 = 1.0 / N1\n        u0_1 = np.sin(2 * np.pi * x1)\n        u_final_1 = run_simulation(lw_step, u0_1, N1, C, T, a)\n        u_exact_1 = np.sin(2 * np.pi * (x1 - a * T))\n        error1 = np.sqrt(dx1 * np.sum((u_final_1 - u_exact_1)**2))\n        \n        # Fine grid (N2)\n        N2 = 400\n        x2 = np.linspace(0, 1, N2, endpoint=False)\n        dx2 = 1.0 / N2\n        u0_2 = np.sin(2 * np.pi * x2)\n        u_final_2 = run_simulation(lw_step, u0_2, N2, C, T, a)\n        u_exact_2 = np.sin(2 * np.pi * (x2 - a * T))\n        error2 = np.sqrt(dx2 * np.sum((u_final_2 - u_exact_2)**2))\n        \n        # Compute observed order p\n        order = np.log2(error1 / error2)\n        return order\n\n    def test7():\n        \"\"\"Lax-Wendroff, Total Variation growth on discontinuity.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        \n        # Initial Total Variation\n        tv0 = np.sum(np.abs(np.roll(u0, -1) - u0))\n        \n        # Final Total Variation\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        tv_final = np.sum(np.abs(np.roll(u_final, -1) - u_final))\n        \n        return tv_final / tv0\n\n    # --- Execute Tests and Format Output ---\n\n    results = [\n        test1(),\n        test2(),\n        test3(),\n        test4(),\n        test5(),\n        test6(),\n        test7()\n    ]\n    \n    # Format boolean as lowercase 'true'/'false' as per standard Python str()\n    formatted_results = [str(r).lower() if isinstance(r, bool) else str(r) for r in results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3304576"}]}