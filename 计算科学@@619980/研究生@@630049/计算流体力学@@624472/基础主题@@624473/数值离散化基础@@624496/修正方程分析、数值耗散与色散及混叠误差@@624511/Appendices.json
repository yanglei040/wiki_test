{"hands_on_practices": [{"introduction": "修正方程分析是揭示数值格式内在误差特性的强大工具。此练习将该分析应用于一个经典的MacCormack格式，通过推导其修正方程，我们将量化其作为耗散和色散效应体现出来的截断误差。通过这个基础练习[@problem_id:3346245]，您可以掌握修正方程分析的核心技术，并直观理解CFL数等参数如何直接影响格式的误差行为。", "problem": "考虑在空间步长为 $h$、时间步长为 $\\tau$ 的均匀网格上，系数为常数的线性平流方程 $u_t + a u_x = 0$，其中 $a \\in \\mathbb{R}$。定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = \\frac{a \\tau}{h}$。应用其标准一维形式的 MacCormack 预估-校正方法，其中预估步使用向前差分，校正步使用向后差分：\n$$\nu_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right), \\quad\nu_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right).\n$$\n从该离散化和基础偏微分方程出发，进行修正方程分析，该分析应一致地保留并组合由预估步和校正步引入的交叉项。使用傅里叶模态假定 $u_i^n = \\exp\\!\\left(i\\left(k x_i - \\omega t_n\\right)\\right)$，将离散放大因子与连续修正方程联系起来，并确定主阶色散和耗散修正项。推导一个形如\n$$\nu_t + a u_x = \\chi(\\lambda,a)\\, h^2\\, u_{xxx} - \\delta(\\lambda,a)\\, h^3\\, u_{xxxx} + O\\!\\left(h^4\\right),\n$$\n的闭式修正方程，其中 $\\chi(\\lambda,a)$ 和 $\\delta(\\lambda,a)$ 的显式解析表达式通过将格式放大因子的级数展开与修正色散关系的指数形式进行匹配而得出。基于这些表达式，找出能够消除主阶 $O(h^3)$ 色散误差的 CFL 值 $\\lambda_\\star$，并给出上述表示中主阶耗散系数 $\\delta(\\lambda,a)$ 的符号形式。\n\n在您的推导中，解释数值色散和数值耗散的作用，并讨论在离散符号中混叠误差如何在高波数下表现出来，以及耗散的存在与否如何影响对其的控制。您最终报告的量必须是：\n- 能够消除 $O(h^3)$ 色散项的单一 CFL 值 $\\lambda_\\star$。\n- $\\delta(\\lambda,a)$ 的闭式表达式。\n\n使用 LaTeX 的 $pmatrix$ 将您的最终答案表示为单个解析表达式或单个行向量。无需四舍五入。", "solution": "本分析的对象是一维常系数线性平流方程，其形式如下：\n$$\nu_t + a u_x = 0\n$$\n其中 $a \\in \\mathbb{R}$ 是恒定的平流速度。我们在空间步长为 $h$、时间步长为 $\\tau$ 的均匀网格上分析 MacCormack 预估-校正格式。Courant–Friedrichs–Lewy (CFL) 数定义为 $\\lambda = \\frac{a \\tau}{h}$。\n\n该格式由两个步骤定义：\n1.  **预估步 (向前差分)：**\n    $$\n    u_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right)\n    $$\n2.  **校正步 (对预估值使用向后差分)：**\n    $$\n    u_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right)\n    $$\n\n我们的首要任务是将这两个步骤合并成一个单一的显式公式，用时间层 $n$ 的值来表示 $u_i^{n+1}$。我们将预估步的表达式代入校正步的表达式中。\n首先，我们写出索引为 $i$ 和 $i-1$ 的预估步：\n$$\nu_i^{(p)} = (1+\\lambda)u_i^n - \\lambda u_{i+1}^n\n$$\n$$\nu_{i-1}^{(p)} = (1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\n$$\n现在，将这些代入校正步方程：\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ u_i^n + \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\lambda \\left( \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\left((1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\\right) \\right) \\right]\n$$\n简化大括号内的项：\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda \\left( (1+2\\lambda)u_i^n - \\lambda u_{i+1}^n - (1+\\lambda)u_{i-1}^n \\right) \\right]\n$$\n分配内部的 $-\\lambda$：\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda(1+2\\lambda)u_i^n + \\lambda^2 u_{i+1}^n + \\lambda(1+\\lambda)u_{i-1}^n \\right]\n$$\n根据空间索引收集各项：\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ \\left(2+\\lambda - \\lambda - 2\\lambda^2\\right)u_i^n + \\left(\\lambda^2 - \\lambda\\right)u_{i+1}^n + \\left(\\lambda^2 + \\lambda\\right)u_{i-1}^n \\right]\n$$\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2 - 2\\lambda^2)u_i^n + \\lambda(\\lambda-1)u_{i+1}^n + \\lambda(\\lambda+1)u_{i-1}^n \\right]\n$$\n这可以简化为著名的 Lax-Wendroff 格式的模板：\n$$\nu_i^{n+1} = (1 - \\lambda^2)u_i^n + \\frac{\\lambda(\\lambda-1)}{2}u_{i+1}^n + \\frac{\\lambda(\\lambda+1)}{2}u_{i-1}^n\n$$\n\n为了进行修正方程分析，我们引入傅里叶模态假定 $u_j^n = G^n(k) \\exp(i k x_j)$，其中 $x_j=jh$，$k$ 是波数，$G(k)$ 是放大因子。将此代入单步格式可得：\n$$\nG \\exp(ikx_i) = (1 - \\lambda^2)\\exp(ikx_i) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikx_{i+1}) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(ikx_{i-1})\n$$\n两边同除以 $\\exp(ikx_i)$：\n$$\nG = (1 - \\lambda^2) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikh) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(-ikh)\n$$\n使用无量纲波数 $\\theta = kh$ 和欧拉公式 $\\exp(\\pm i\\theta) = \\cos(\\theta) \\pm i\\sin(\\theta)$，我们得到：\n$$\nG(\\theta) = 1 - \\lambda^2 + \\left(\\frac{\\lambda(\\lambda-1)}{2} + \\frac{\\lambda(\\lambda+1)}{2}\\right)\\cos(\\theta) + i\\left(\\frac{\\lambda(\\lambda-1)}{2} - \\frac{\\lambda(\\lambda+1)}{2}\\right)\\sin(\\theta)\n$$\n$$\nG(\\theta) = 1 - \\lambda^2 + \\lambda^2\\cos(\\theta) - i\\lambda\\sin(\\theta) = 1 - \\lambda^2(1-\\cos(\\theta)) - i\\lambda\\sin(\\theta)\n$$\n修正方程的形式为 $u_t + a u_x = \\mathcal{L}_{err}(u)$，其中 $\\mathcal{L}_{err}$ 代表误差项。在一个时间步长 $\\tau$ 内，修正方程的放大因子为 $G_{mod} = \\exp(-i\\omega_{mod}\\tau)$，其中 $\\omega_{mod}(k)$ 是修正色散关系。我们通过将 $u(x,t) = \\exp(i(kx-\\omega_{mod}t))$ 代入目标修正方程来找到 $\\omega_{mod}$：\n$u_t + a u_x = \\chi h^2 u_{xxx} - \\delta h^3 u_{xxxx}$\n$$\n-i\\omega_{mod} + a(ik) = \\chi h^2 (ik)^3 - \\delta h^3 (ik)^4\n$$\n$$\n-i\\omega_{mod} = -iak - i\\chi k^3 h^2 - \\delta k^4 h^3\n$$\n乘以 $\\tau$ 并使用 $\\lambda = a\\tau/h$ 和 $\\theta=kh$：\n$$\n-i\\omega_{mod}\\tau = -iak\\tau - i\\chi k^3 h^2 \\tau - \\delta k^4 h^3 \\tau = -i\\lambda\\theta - i\\chi(k^3 h^3)\\frac{\\tau}{h} - \\delta(k^4 h^4)\\frac{\\tau}{h}\n$$\n$$\n\\ln(G_{mod}) = -i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 + O(\\theta^5)\n$$\n我们必须将其与数值格式的 $\\ln(G(\\theta))$ 的泰勒级数展开进行匹配。让我们对小 $\\theta$ 展开 $G(\\theta)$：\n$$\n\\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - O(\\theta^6)\n$$\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - O(\\theta^7)\n$$\n$$\nG(\\theta) = 1 - \\lambda^2\\left(\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\dots\\right) - i\\lambda\\left(\\theta - \\frac{\\theta^3}{6} + \\dots\\right)\n$$\n$$\nG(\\theta) = 1 - i\\lambda\\theta - \\frac{\\lambda^2\\theta^2}{2} + i\\frac{\\lambda\\theta^3}{6} + \\frac{\\lambda^2\\theta^4}{24} + O(\\theta^5)\n$$\n使用级数 $\\ln(1+z) = z - z^2/2 + z^3/3 - \\dots$，其中 $z = G(\\theta)-1 = -i\\lambda\\theta - \\frac{\\lambda^2\\theta^2}{2} + i\\frac{\\lambda\\theta^3}{6} + \\dots$：\n按 $\\theta$ 的幂次收集各项可得展开式为：\n$$\n\\ln(G(\\theta)) = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4 + O(\\theta^5)\n$$\n将此与 $\\ln(G_{mod})$ 进行比较：\n$$\n-i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4\n$$\n匹配虚部 $\\theta^3$ 项（色散误差）：\n$$\n-i\\frac{\\chi\\lambda}{a} = i\\frac{\\lambda(1-\\lambda^2)}{6} \\implies \\chi(\\lambda,a) = -\\frac{a(1-\\lambda^2)}{6} = \\frac{a(\\lambda^2-1)}{6}\n$$\n这是主阶色散误差项 $h^2 u_{xxx}$ 的系数。数值色散源于奇数阶导数误差项，这些项导致解的不同傅里叶分量以不正确的、依赖于波数的相速度传播，从而扭曲解的轮廓。\n\n匹配实部 $\\theta^4$ 项（耗散误差）：\n$$\n-\\frac{\\delta\\lambda}{a} = -\\frac{\\lambda^2(1-\\lambda^2)}{8} \\implies \\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}\n$$\n这是主阶耗散误差项的系数，在修正方程中写为 $-\\delta h^3 u_{xxxx}$。数值耗散源于偶数阶导数误差项，这些项导致傅里叶分量的振幅衰减。这种效应通常对更高的波数（更短的波长）更强，并且对于抑制虚假的高频振荡可能是有益的。这种振荡可由混叠产生，即高于网格奈奎斯特频率 ($k_{Nyquist} = \\pi/h$) 的波数被错误地表示为较低的波数。这种错误表示可能导致非物理行为，例如分量向错误的方向传播。耗散项的系数在稳定范围 $|\\lambda|1$ 内为正，它系统地从系统中移除能量，特别是在高波数处，从而控制由混叠引起的不稳定性的增长。\n\n为消除主阶 $O(h^2)$ 色散误差，我们将其系数 $\\chi(\\lambda, a)$ 置零：\n$$\n\\frac{a(\\lambda^2-1)}{6} = 0\n$$\n假设 $a \\neq 0$，这要求 $\\lambda^2 - 1 = 0$，解得 $\\lambda = \\pm 1$。无论哪种情况，都有 $|\\lambda|=1$。对于 $a0$ 的特定情况，对应的 CFL 数为 $\\lambda=1$。因此，我们确定特定值 $\\lambda_\\star=1$ 是三阶色散消失的条件。当 $\\lambda_\\star = \\pm 1$ 时，格式变为精确解，$u_i^{n+1}=u_{i\\mp1}^n$，并且所有误差项，包括耗散项，都消失了。\n\n所要求的量是 CFL 值 $\\lambda_\\star$ 和 $\\delta(\\lambda,a)$ 的表达式。\n1.  消除 $O(h^2)$ 色散项的单一 CFL 值为 $\\lambda_\\star=1$（或更一般地， $|\\lambda_\\star|=1$）。我们将报告其主正值。\n2.  主阶耗散系数为 $\\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{a\\lambda(1-\\lambda^2)}{8} \\end{pmatrix}}\n$$", "id": "3346245"}, {"introduction": "当从线性问题转向非线性问题（如伯格斯方程）时，会引入新的挑战，特别是混淆误差。此练习探讨了非线性项的不同离散格式——即使在连续层面数学上等价——如何显著影响数值解的守恒特性。我们将通过比较一个标准的守恒格式和一个斜对称格式[@problem_id:3346217]，来理解后者如何在离散层面精确保持动能守恒，从而有效控制非线性能量的增长。", "problem": "考虑一个周期性域上的一维无粘性 Burgers 方程，其坐标为 $x \\in [0,2\\pi)$，时间为 $t \\geq 0$，\n$$\nu_{t} + u\\,u_{x} = 0,\n$$\n其中 $u(x,t)$ 足够光滑。令 $\\{x_{j}\\}_{j=0}^{N-1}$ 表示一个间距为 $h = \\frac{2\\pi}{N}$ 的等距网格，并令 $D$ 表示由下式定义的半离散二阶中心差分算子\n$$\nD u_{j} = \\frac{u_{j+1}-u_{j-1}}{2h},\n$$\n采用周期性索引。\n\n考虑非线性项 $u\\,u_{x}$ 的两种半离散格式：\n\n1. 守恒形式，\n$$\nu_{t,j} + \\frac{1}{2}\\,D\\!\\left(u_{j}^{2}\\right) = 0,\n$$\n\n2. 反对称、动能守恒的分裂形式，\n$$\nu_{t,j} + \\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) + \\frac{1}{3}\\,u_{j}\\,D u_{j} = 0.\n$$\n\n这些格式在没有显式去混叠程序的情况下使用。假设 $u$ 具有傅里叶表示 $u(x,t) = \\sum_{k} \\hat{u}(k,t)\\,\\exp(i k x)$，其中 $k$ 是与网格一致的整数波数。定义离散动能\n$$\nE_{d}(t) = \\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}(t)^{2},\n$$\n并考虑每种半离散格式所产生的能量收支。修正方程分析使用中心差分的泰勒展开\n$$\nD f = f_{x} + \\frac{h^{2}}{6} f_{xxx} + \\mathcal{O}(h^{4}),\n$$\n并将其一致地应用于所有微分，且将混叠解释为离散乘积法则 $D(u^{2}) \\neq 2 u\\,D u$ 在网格上的失效。\n\n对每种格式，推导其连续形式的 $\\mathcal{O}(h^{2})$ 修正方程，并使用相应的半离散能量收支，通过将模式 $k$ 处的主阶能量变化与粘性能量衰减定律匹配，来定义一个有效的、依赖于波数的数值粘性 $\\nu_{\\text{num}}(k)$：\n$$\n\\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx -\\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2},\n$$\n所有由混叠引起的能量转移均在此意义上进行解释。假设场包含足够的傅里叶分量，以在守恒格式中实现非零的由混叠引起的能量转移，并且 $D$ 满足相对于离散内积的离散分部求和性质。\n\n最后，在这些假设下，计算比率\n$$\nR(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)}\n$$\n对于任何可解波数 $k$。将最终答案表示为单个实数。无需四舍五入，且方框内的最终答案无需附加物理单位。如果相关，角度应以弧度为单位进行解释。", "solution": "问题要求计算无粘性 Burgers 方程的两种不同半离散化格式的有效数值粘性之比 $R(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)}$。每种格式的数值粘性 $\\nu_{\\text{num}}(k)$ 将根据其相应的半离散能量收支来确定。\n\n首先，我们确定问题陈述中给出的定义。\n两种半离散格式是：\n1. 守恒形式：\n$$\nu_{t,j} + \\frac{1}{2}\\,D\\!\\left(u_{j}^{2}\\right) = 0 \\quad (\\text{格式 1})\n$$\n2. 反对称、动能守恒的分裂形式：\n$$\nu_{t,j} + \\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) + \\frac{1}{3}\\,u_{j}\\,D u_{j} = 0 \\quad (\\text{格式 2})\n$$\n离散动能定义为：\n$$\nE_{d}(t) = \\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}(t)^{2}\n$$\n假设中心差分算子 $D$ 满足离散分部求和 (SBP) 性质。对于周期性域，该性质意味着对于任意网格函数 $f_j$ 和 $g_j$，离散内积满足：\n$$\n\\sum_{j=0}^{N-1} f_{j} (D g_{j}) = - \\sum_{j=0}^{N-1} g_{j} (D f_{j})\n$$\n\n问题的核心在于确定每种格式的能量收支，即离散动能的变化率 $\\frac{dE_d}{dt}$。$E_d$ 的时间导数是：\n$$\n\\frac{dE_d}{dt} = \\frac{d}{dt}\\left(\\frac{h}{2}\\sum_{j=0}^{N-1} u_{j}^{2}\\right) = \\frac{h}{2}\\sum_{j=0}^{N-1} 2 u_{j} \\frac{du_j}{dt} = h\\sum_{j=0}^{N-1} u_{j} u_{t,j}\n$$\n现在我们代入每种格式的 $u_{t,j}$ 表达式。\n\n我们来分析反对称格式（格式 2）。该格式的决定性特征，正如其名称所示，是其在能量收支方面的表现。将格式 2 的 $u_{t,j}$ 代入 $\\frac{dE_d}{dt}$ 的表达式中：\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = h\\sum_{j=0}^{N-1} u_{j} \\left(-\\frac{1}{3}\\,D\\!\\left(u_{j}^{2}\\right) - \\frac{1}{3}\\,u_{j}\\,D u_{j}\\right)\n$$\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = -\\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}\\,D\\!\\left(u_{j}^{2}\\right) - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\n我们对第一项应用分部求和性质，令 $f_j = u_j$ 和 $g_j = u_j^2$：\n$$\n\\sum_{j=0}^{N-1} u_{j}\\,D\\!\\left(u_{j}^{2}\\right) = - \\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\n将此结果代回能量变化的表达式中：\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = -\\frac{h}{3}\\left(- \\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\\right) - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j}\n$$\n$$\n\\frac{dE_d^{\\text{skew}}}{dt} = \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j} - \\frac{h}{3}\\sum_{j=0}^{N-1} u_{j}^{2}\\,D u_{j} = 0\n$$\n因此，反对称格式精确地守恒离散动能。\n\n问题要求我们通过将能量变化与粘性衰减定律匹配来定义一个有效的数值粘性 $\\nu_{\\text{num}}(k)$：\n$$\n\\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx -\\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2}\n$$\n总能量变化率是所有波数 $k$ 上的模态能量变化之和：\n$$\n\\frac{dE_d}{dt} = \\sum_{k} C_k \\frac{d}{dt}\\left(\\frac{|\\hat{u}(k)|^{2}}{2}\\right) \\approx - \\sum_{k} C_k \\nu_{\\text{num}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2}\n$$\n其中 $C_k$ 是一个与傅里叶变换归一化相关的常数。\n因为我们已经证明了 $\\frac{dE_d^{\\text{skew}}}{dt} = 0$，可得：\n$$\n\\sum_{k} C_k \\nu_{\\text{num}}^{\\text{skew}}(k)\\,k^{2}\\,|\\hat{u}(k)|^{2} = 0\n$$\n对于物理上有意义的粘性，我们必须有 $\\nu_{\\text{num}}(k) \\ge 0$。由于 $k^2 \\ge 0$，$|\\hat{u}(k)|^2 \\ge 0$，且 $C_k  0$，该和仅当每一项都为零时才为零。这意味着对于任何具有非零能量的模式（$|\\hat{u}(k)| \\ne 0$），我们必须有 $\\nu_{\\text{num}}^{\\text{skew}}(k) = 0$。\n\n对于守恒格式（格式 1），问题明确说明要假设存在导致非零能量转移的条件。这意味着 $\\nu_{\\text{num}}^{\\text{cons}}(k)$ 并非对所有 $k$ 都恒为零。事实上，对格式 1 进行类似的能量收支分析表明，其能量变化与混叠误差有关，并且通常不为零。\n\n基于这些发现，我们可以计算所要求的比率：\n$$\nR(k) = \\frac{\\nu_{\\text{num}}^{\\text{skew}}(k)}{\\nu_{\\text{num}}^{\\text{cons}}(k)} = \\frac{0}{\\nu_{\\text{num}}^{\\text{cons}}(k)}\n$$\n对于任何守恒格式的数值耗散不为零（如假设）的波数 $k$，该比率都是有明确定义的。\n\n因此，比率 $R(k)$ 为 $0$。\n\n通过泰勒级数展开进行修正方程分析的信息是一个潜在的干扰项。虽然该分析揭示了主阶截断误差（对于两种格式而言，该误差本质上是色散的），但它并没有完全捕捉到格式相对于守恒离散能量范数的性质。反对称格式的精确代数守恒性质是决定其有效数值耗散的关键因素，而其有效数值耗散恒为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "3346217"}, {"introduction": "在许多包含激波或陡峭梯度的计算流体力学应用中，我们需要有选择地添加数值耗散。这个练习将修正方程分析应用于一个包含人工黏性的数值格式，其中黏性大小由一个激波传感器控制。我们将量化该传感器对不同波长解的响应，以及这种响应如何转化为一个依赖于解本身的人工黏性系数[@problem_id:3346187]。这个练习将理论与应用相结合，展示了如何通过调节格式参数，在抑制激波附近振荡的同时，保持解在光滑区域的精度。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $u(x,t)$ 为被动标量，其平流速度 $a$ 为常数。使用间距为 $h$ 的均匀网格，并通过时间步长为 $\\Delta t$ 的前向欧拉时间离散格式来推进求解。为了在光滑区域最小化伪阻尼的同时增加激波捕捉能力，以半离散形式引入了一个人工粘性项，该项为由激波传感器缩放的二阶差分。在网格索引为 $i$、时间层为 $n$ 处的全离散更新格式为\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\n其中，人工粘性系数逐点定义为\n$$\n\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n},\n$$\n其中 $C_{\\text{vis}}  0$ 是一个无量纲缩放参数，激波传感器为\n$$\nS_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|.\n$$\n您可以假设在光滑区域中计算 $S_{i}^{n}$ 时不施加任何额外的限制。应使用修正方程分析将离散格式与一个连续方程联系起来，从而揭示主阶耗散和色散修正，并量化在行波存在时传感器的作用。特别地，考虑一个光滑行波 $u(x,t) = A \\sin\\!\\big(k(x - a t)\\big)$，其振幅为 $A$，波数为 $k$（单位为弧度/单位长度）。关注无量纲波数 $\\theta = k h$ 的分量，并假设一个 $\\theta \\approx 0.5$ 的单一傅里叶模态在局部谱中占主导地位。\n\n任务：\n1. 从离散更新格式和激波传感器的定义出发，推导 $u(x,t)$ 的主阶修正方程，并用 $C_{\\text{vis}}$、$a$、$h$ 以及行波处传感器的局部值，来识别由人工粘性项引起的等效连续粘性场 $\\nu_{\\text{num}}(x)$。\n2. 对于无量纲波数为 $\\theta = k h$ 的单一傅里叶模态，使用离散传感器的定义，推导传感器大小作为 $\\theta$ 函数的闭式表达式。由此，将光滑行波附近的等效粘性 $\\nu_{\\text{num}}$ 明确表示为 $\\theta$ 的函数。\n3. 使用修正方程的结果和二阶差分算子的离散符号，求出对于波数为 $k$、网格间距为 $h$ 的傅里叶模态，由人工粘性引起的每步振幅衰减因子，并用 $C_{\\text{vis}}$、$a$、$\\Delta t$、$h$ 和 $\\theta$ 表示。\n4. 设平流速度为 $a = 1.2$ (米/秒)，网格间距为 $h = 1.0 \\times 10^{-2}$ (米)，时间步长满足库朗-弗里德里希-列维（CFL）数 $\\lambda = a\\,\\Delta t / h = 0.7$。施加要求：对于 $\\theta = 0.5$ 的傅里叶分量，每时间步的振幅衰减最多为 $0.01$（十进制形式）。在此要求下，确定无量纲粘性缩放参数 $C_{\\text{vis}}$ 的最大允许值，以避免对 $\\theta \\approx 0.5$ 的分量产生过度阻尼。\n将最终答案四舍五入到四位有效数字。将最终答案表示为无量纲数。", "solution": "问题要求对一维线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的一个数值格式进行四部分分析。该格式由下式给出\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\n其中人工粘性系数为 $\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n}$，激波传感器为 $S_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|$。\n\n**1. 修正方程与等效粘性**\n\n为推导修正方程，我们将有限差分格式中的各项在点 $(x_i, t_n)$ 附近进行泰勒级数展开。设 $u = u(x_i, t_n)$。\n左侧的时间导数项近似为\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{(u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\dots) - u}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^2).\n$$\n右侧的空间差分展开如下：\n一阶导数的中心差分：\n$$\n\\frac{u_{i+1}^n - u_{i-1}^n}{2h} = \\frac{(u+h u_x+\\frac{h^2}{2}u_{xx}+\\frac{h^3}{6}u_{xxx}+\\dots)-(u-h u_x+\\frac{h^2}{2}u_{xx}-\\frac{h^3}{6}u_{xxx}+\\dots)}{2h} = u_x + \\frac{h^2}{6}u_{xxx} + O(h^4).\n$$\n二阶导数的中心差分：\n$$\n\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} = \\frac{(u+h u_x+\\frac{h^2}{2}u_{xx}+\\dots) - 2u + (u-h u_x+\\frac{h^2}{2}u_{xx}-\\dots)}{h^2} = u_{xx} + \\frac{h^2}{12}u_{xxxx} + O(h^4).\n$$\n将这些展开式代入格式中，得到：\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a\\left(u_x + \\frac{h^2}{6}u_{xxx}\\right) + \\nu_i^n \\left(u_{xx} + \\frac{h^2}{12}u_{xxxx}\\right) + \\dots\n$$\n为消去 $u_{tt}$ 项，我们将原始偏微分方程 $u_t = -a u_x$ 对时间求导：$u_{tt} = -a u_{xt} = -a(u_t)_x = -a(-a u_x)_x = a^2 u_{xx}$。\n将此结果代回展开后的格式中：\n$$\nu_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a u_x - \\frac{ah^2}{6}u_{xxx} + \\nu_i^n u_{xx} + \\dots\n$$\n重新整理以匹配修正偏微分方程的形式，我们得到：\n$$\nu_t + a u_x = (\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx} - \\frac{ah^2}{6}u_{xxx} + O(\\Delta t^2, h^4, \\Delta t h^2).\n$$\n这就是主阶修正方程。项 $(\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx}$ 是总的主阶耗散，包括附加的人工粘性和由平流项的前向欧拉时间、中心空间离散产生的数值粘性。项 $-\\frac{ah^2}{6}u_{xxx}$ 是主阶数值色散。\n\n问题要求的是由人工粘性项引起的等效连续粘性场 $\\nu_{\\text{num}}(x)$。这对应于乘以二阶导数 $u_{xx}$ 的系数 $\\nu_i^n$ 的连续模拟。因此，等效粘性就是 $\\nu_i^n$ 的连续表示。\n$$\n\\nu_{\\text{num}}(x,t) = C_{\\text{vis}}\\,a\\,h\\,S(x,t)\n$$\n其中 $S(x,t)$ 是传感器 $S_i^n$ 的连续模拟。这是第一个任务的答案。\n\n**2. 传感器大小和作为 $\\theta$ 函数的等效粘性**\n\n我们分析单一傅里叶模态 $u(x) = \\exp(I k x)$ 下的传感器，其中 $I = \\sqrt{-1}$。分析在固定的时间层 $n$ 进行。无量纲波数为 $\\theta = k h$。\n$u_j = \\exp(I k x_j) = \\exp(I k (jh))$.\n传感器比率的分子涉及二阶差分算子 $\\delta^2$：\n$$\nu_{i+1} - 2u_i + u_{i-1} = u_i(\\exp(I\\theta) - 2 + \\exp(-I\\theta)) = u_i(2\\cos(\\theta) - 2) = -4u_i\\sin^2(\\frac{\\theta}{2}).\n$$\n分母涉及跨度为 $2h$ 的中心一阶差分算子，我们称之为 $\\delta_{2x}$：\n$$\nu_{i+1} - u_{i-1} = u_i(\\exp(I\\theta) - \\exp(-I\\theta)) = u_i(2I\\sin(\\theta)).\n$$\n对于这个复模态，比率为：\n$$\n\\frac{u_{i+1} - 2u_i + u_{i-1}}{u_{i+1} - u_{i-1}} = \\frac{-4u_i\\sin^2(\\frac{\\theta}{2})}{2Iu_i\\sin(\\theta)} = \\frac{-4\\sin^2(\\frac{\\theta}{2})}{2I(2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2}))} = \\frac{-\\sin(\\frac{\\theta}{2})}{I\\cos(\\frac{\\theta}{2})} = I\\tan(\\frac{\\theta}{2}).\n$$\n传感器 $S_i^n$ 是这个复数的模。由于问题关注单一模态，我们为此模态计算传感器。\n$$\nS(\\theta) = \\left|I\\tan(\\frac{\\theta}{2})\\right| = \\left|\\tan(\\frac{\\theta}{2})\\right|.\n$$\n对于在网格上表示的物理波，我们考虑 $k h = \\theta \\in [0, \\pi]$，此时 $\\tan(\\theta/2) \\ge 0$。因此，\n$$\nS(\\theta) = \\tan(\\frac{\\theta}{2}).\n$$\n此模态的等效粘性则为 $\\theta$ 的函数：\n$$\n\\nu_{\\text{num}}(\\theta) = C_{\\text{vis}}\\,a\\,h\\,S(\\theta) = C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2}).\n$$\n\n**3. 每步振幅衰减因子**\n\n傅里叶模态 $u_i^n = \\hat{u}^n e^{I k x_i}$ 的振幅演化由放大因子 $G = \\hat{u}^{n+1}/\\hat{u}^n$ 描述。将该模态代入离散格式：\n$$\nG u_i^n = u_i^n - \\frac{a\\Delta t}{2h}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n).\n$$\n两边同除以 $u_i^n$ 并代入第2部分中找到的离散算子符号：\n$$\nG = 1 - \\frac{a\\Delta t}{2h}(2I\\sin\\theta) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(-4\\sin^2(\\frac{\\theta}{2})).\n$$\n使用CFL数 $\\lambda = a\\Delta t/h$：\n$$\nG = 1 - I\\lambda\\sin\\theta - \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\n“由人工粘性引起的振幅衰减因子”指的是阻尼振幅的项。$G$ 的实部控制振幅变化。\n$$\n\\text{Re}(G) = 1 - \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\n每步的振幅相对衰减量，我们称之为 $\\mathcal{R}$，是在 $\\text{Re}(G)$ 中从 1 减去的正量：\n$$\n\\mathcal{R} = \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\n代入第2部分中 $\\nu_{\\text{num}}(\\theta)$ 的表达式：\n$$\n\\mathcal{R} = \\frac{4\\Delta t}{h^2} \\left(C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2})\\right) \\sin^2(\\frac{\\theta}{2}) = 4 \\left(\\frac{a\\Delta t}{h}\\right) C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\n因此，每步振幅衰减为：\n$$\n\\mathcal{R} = 4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\n\n**4. $C_{\\text{vis}}$ 的最大允许值**\n\n我们得到的约束是，对于 $\\theta = 0.5$，每时间步的振幅衰减最多为 $0.01$。这意味着 $\\mathcal{R} \\le 0.01$。\n$$\n4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}) \\le 0.01.\n$$\n我们需要找到 $C_{\\text{vis}}$ 的最大允许值，该值在等号成立时取得：\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\lambda \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2})}.\n$$\n给定的参数是：\n- $\\lambda = 0.7$\n- $\\theta = 0.5$ (弧度)\n\n因此，$\\theta/2 = 0.25$ 弧度。我们计算三角函数：\n$$\n\\tan(0.25) \\approx 0.255340758\n$$\n$$\n\\sin(0.25) \\approx 0.247403959\n$$\n$$\n\\sin^2(0.25) \\approx 0.061208611\n$$\n现在，将这些值代入 $C_{\\text{vis, max}}$ 的表达式中：\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\times 0.7 \\times \\tan(0.25) \\times \\sin^2(0.25)}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{2.8 \\times 0.255340758 \\times 0.061208611}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{0.04375404} \\approx 0.2285461\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nC_{\\text{vis, max}} \\approx 0.2285.\n$$", "answer": "$$\n\\boxed{0.2285}\n$$", "id": "3346187"}]}