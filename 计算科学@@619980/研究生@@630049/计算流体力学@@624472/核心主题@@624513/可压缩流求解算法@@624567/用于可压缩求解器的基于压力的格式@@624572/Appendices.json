{"hands_on_practices": [{"introduction": "在设计可压缩流求解器时，一个基本的选择是确定主要的能量变量。这个选择会影响关键物理过程（如压力功和能量转换）在数学上和数值上的表达方式。本练习要求您从第一性原理出发，推导并比较静态焓 ($h$) 和总能 ($E$) 的输运方程，从而揭示保守格式与在特定流态下可能更方便的格式之间的权衡。[@problem_id:3353133]", "problem": "考虑一个动力粘度 $\\mu$ 和热导率 $k$ 均为常数的可压缩牛顿流体，其受质量守恒、动量守恒以及内能形式的热力学第一定律支配。令 $\\rho$ 表示质量密度，$\\boldsymbol{u}$ 表示速度， $p$ 表示热力学压力，$\\boldsymbol{\\tau}$ 表示粘性应力张量，$\\boldsymbol{q}$ 表示遵循傅里叶定律 $\\boldsymbol{q} = -k \\nabla T$ 的热通量矢量，其中 $T$ 是温度。定义总比能 $E = e + \\tfrac{1}{2}|\\boldsymbol{u}|^2$，其中 $e$ 是比内能，以及静比焓 $h = e + p/\\rho$。您的任务是根据守恒定律和热力学恒等式进行推理，以表达当一个基于压力的计算流体力学(CFD)求解器选择推进 $h$ 或 $E$ 时，压力功和动能交换项是如何以不同方式表示的。\n\n仅从以下几点出发：\n- 连续性方程，\n- 动量方程，以及\n- 针对粘性、导热流体的内能形式的第一定律，\n\n进行以下概念性推导：\n- 结合内能和动能平衡，得到总能量的守恒形式，并找出压力-速度耦合出现的位置，\n- 使用热力学恒等式和连续性方程，将内能平衡转化为静焓平衡，并找出可压缩性如何进入方程。\n\n然后，根据您的推导，选择所有关于在基于压力的可压缩求解器中，$h$ 为基础与 $E$ 为基础的公式中压力功和动能交换项如何出现的正确陈述。\n\nA. 在 $E$ 的守恒总能量公式中，压力功和动能-内能交换通过 $\\nabla\\cdot(p \\boldsymbol{u})$ 以面通量的形式出现，并且在 $E$ 方程中没有显式的体积源项 $-p\\,\\nabla\\cdot\\boldsymbol{u}$。\n\nB. 在 $h$ 的静焓公式中，可压缩性相互作用以压力的物质导数 $D p/D t$ 的形式出现在右侧，即，显式的 $p\\,\\nabla\\cdot\\boldsymbol{u}$ 项不存在。\n\nC. 将内能平衡和动能平衡相加，消除了 $-p\\,\\nabla\\cdot\\boldsymbol{u}$ 和 $-\\boldsymbol{u}\\cdot\\nabla p$ 这对项，将它们转化为 $\\nabla\\cdot(p \\boldsymbol{u})$；这个恒等式是守恒总能量通量的基础。\n\nD. 粘性耗散 $\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$ 不进入静焓方程，因为焓已经考虑了力学效应。\n\nE. 对于理想气体，静焓方程只包含一个与 $\\nabla\\cdot \\boldsymbol{u}$ 成比例的源项；因此它不需要 $D p/D t$。\n\nF. 在基于压力的可压缩求解器中，使用 $h$ 代替 $E$ 会将压力-速度耦合从对流通量转移到一个涉及 $D p/D t$ 的源项，这可能会影响跨激波的离散守恒，除非采取特殊措施。\n\n选择所有适用项。", "solution": "该问题陈述是计算流体力学领域中一个有效且适定的问题，其基础是流体和热力学的基本原理。我们将进行完整的推导和分析。\n\n作为起点的基本控制方程是：\n1.  **连续性方程：**\n    $$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0 $$\n    用物质导数 $D/Dt = \\partial/\\partial t + \\boldsymbol{u} \\cdot \\nabla$ 表示，这等价于 $\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\nabla \\cdot \\boldsymbol{u}$。\n\n2.  **动量方程（非守恒形式）：**\n    $$ \\rho \\frac{D\\boldsymbol{u}}{Dt} = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} $$\n\n3.  **内能方程：**\n    $$ \\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n    这里，$-p (\\nabla \\cdot \\boldsymbol{u})$ 代表压缩/膨胀的可逆功，$\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$ 是不可逆的粘性耗散（由粘性应力做功转化为内能），而 $-\\nabla \\cdot \\boldsymbol{q}$ 是通过传导增加的热量。\n\n### 总能量 ($E$) 方程的推导\n\n总比能定义为 $E = e + \\frac{1}{2}|\\boldsymbol{u}|^2$。其演化可以通过将内能和动能的演化方程相加得到。\n\n首先，我们通过将速度矢量 $\\boldsymbol{u}$ 与动量方程做点积来推导动能方程：\n$$ \\boldsymbol{u} \\cdot \\left(\\rho \\frac{D\\boldsymbol{u}}{Dt}\\right) = \\boldsymbol{u} \\cdot (-\\nabla p) + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\n认识到 $\\boldsymbol{u} \\cdot \\frac{D\\boldsymbol{u}}{Dt} = \\frac{D}{Dt}\\left(\\frac{1}{2}\\boldsymbol{u}\\cdot\\boldsymbol{u}\\right) = \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right)$，我们得到比动能的方程：\n$$ \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = -\\boldsymbol{u} \\cdot \\nabla p + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\n现在，我们将内能方程与动能方程相加：\n$$ \\rho \\frac{De}{Dt} + \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = [-p (\\nabla \\cdot \\boldsymbol{u}) - \\boldsymbol{u} \\cdot \\nabla p] + [\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau})] - \\nabla \\cdot \\boldsymbol{q} $$\n左边合并为 $\\rho \\frac{DE}{Dt}$。我们对右边的项进行分组。\n使用散度的乘积法则，我们确定两个关键的恒等式：\n1.  对于压力功项：$p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{u} \\cdot \\nabla p = \\nabla \\cdot (p \\boldsymbol{u})$。\n2.  对于粘性功项：$\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u})$。\n\n将这些恒等式代入相加后的方程，得到非守恒形式的总能量输运方程：\n$$ \\rho \\frac{DE}{Dt} = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\n为了得到完全守恒形式，我们使用关系式 $\\rho \\frac{D\\phi}{Dt} = \\frac{\\partial (\\rho \\phi)}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u} \\phi)$，这是连续性方程的直接推论。将其应用于 $E$：\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot (\\rho E \\boldsymbol{u}) = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\n将所有项重排为散度形式，得到标准的守恒形式：\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot [(\\rho E + p) \\boldsymbol{u}] = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u} - \\boldsymbol{q}) $$\n关键的观察是，压力功项，即来自内能的 $-p(\\nabla \\cdot \\boldsymbol{u})$ 和来自动能的 $-\\boldsymbol{u}\\cdot\\nabla p$，它们是体积源项，合并成一个单一的散度项 $-\\nabla \\cdot (p \\boldsymbol{u})$，该项代表能量的通量。\n\n### 静焓 ($h$) 方程的推导\n\n静比焓定义为 $h = e + p/\\rho$。为了找到其输运方程，我们从这个定义开始。应用物质导数：\n$$ \\frac{Dh}{Dt} = \\frac{De}{Dt} + \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) $$\n对压力/密度项使用商法则：\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}\\frac{D\\rho}{Dt} $$\n根据连续性方程，我们有 $\\frac{D\\rho}{Dt} = -\\rho \\nabla \\cdot \\boldsymbol{u}$。代入此式：\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}(-\\rho \\nabla \\cdot \\boldsymbol{u}) = \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} $$\n将此结果代回 $Dh/Dt$ 的表达式，并乘以 $\\rho$：\n$$ \\rho \\frac{Dh}{Dt} = \\rho \\frac{De}{Dt} + \\rho \\left( \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} \\right) = \\rho \\frac{De}{Dt} + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\n最后，我们代入给定的内能方程 $\\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$：\n$$ \\rho \\frac{Dh}{Dt} = (-p \\nabla \\cdot \\boldsymbol{u} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}) + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\n项 $+p \\nabla \\cdot \\boldsymbol{u}$ 和 $-p \\nabla \\cdot \\boldsymbol{u}$ 相互抵消。这得到了静焓的输运方程：\n$$ \\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n在这里，显式的压缩功项 $p(\\nabla\\cdot \\boldsymbol{u})$ 已被压力的物质导数 $Dp/Dt$ 所取代，后者作为一个源项。这是与内能公式的关键区别。\n\n### 选项评估\n\n**A. 在 $E$ 的守恒总能量公式中，压力功和动能-内能交换通过 $\\nabla\\cdot(p \\boldsymbol{u})$ 以面通量的形式出现，并且在 $E$ 方程中没有显式的体积源项 $-p\\,\\nabla\\cdot\\boldsymbol{u}$。**\n这是正确的。我们的推导表明，体积源项 $-p(\\nabla \\cdot \\boldsymbol{u})$（来自 $e$）和 $-\\boldsymbol{u} \\cdot \\nabla p$（来自能量）的组合在 $E$ 的方程中产生了项 $-\\nabla \\cdot(p \\boldsymbol{u})$。在有限体积法中，一个散度项在一个控制体上积分后会变成一个面积分（通量），该积分在单元面上进行计算。原始的源项 $-p\\,\\nabla\\cdot\\boldsymbol{u}$ 不再显式存在。**正确**。\n\n**B. 在 $h$ 的静焓公式中，可压缩性相互作用以压力的物质导数 $D p/D t$ 的形式出现在右侧，即，显式的 $p\\,\\nabla\\cdot\\boldsymbol{u}$ 项不存在。**\n这是正确的。我们对 $h$ 方程的推导明确表明，项 $\\pm p\\,\\nabla\\cdot\\boldsymbol{u}$ 相互抵消，压力变化对流体微团的影响以源项 $Dp/Dt$ 的形式出现。这个项概括了在内能方程中由 $-p(\\nabla\\cdot\\boldsymbol{u})$ 表示的可压缩性效应。**正确**。\n\n**C. 将内能平衡和动能平衡相加，消除了 $-p\\,\\nabla\\cdot\\boldsymbol{u}$ 和 $-\\boldsymbol{u}\\cdot\\nabla p$ 这对项，将它们转化为 $\\nabla\\cdot(p \\boldsymbol{u})$；这个恒等式是守恒总能量通量的基础。**\n这是正确的。该陈述准确地描述了推导总能量方程的关键数学步骤。恒等式 $-\\left(p\\nabla\\cdot\\boldsymbol{u} + \\boldsymbol{u}\\cdot\\nabla p\\right) = -\\nabla\\cdot(p\\boldsymbol{u})$ 正是使得分离的、非守恒的功项能够合并成一个具有通量散度数学形式的单一项，这是守恒公式的要求。**正确**。\n\n**D. 粘性耗散 $\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$ 不进入静焓方程，因为焓已经考虑了力学效应。**\n这是不正确的。我们的推导 $\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$ 清楚地表明粘性耗散项 $\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$ 是存在的。这个项代表了机械能到内能（热）的不可逆转换，并且在任何能量或焓平衡中都必须考虑。焓本身并不包含这种耗散效应。**不正确**。\n\n**E. 对于理想气体，静焓方程只包含一个与 $\\nabla\\cdot \\boldsymbol{u}$ 成比例的源项；因此它不需要 $D p/D t$。**\n这是不正确的。推导出的焓方程对任何流体都是通用的。该方程是 $\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\dots$。它包含源项 $Dp/Dt$，而*不*包含与 $\\nabla\\cdot\\boldsymbol{u}$ 成比例的源项。假设理想气体并不会改变这个基本结构。该陈述将焓公式与内能公式混淆了，后者确实包含项 $-p \\nabla\\cdot\\boldsymbol{u}$。**不正确**。\n\n**F. 在基于压力的可压缩求解器中，使用 $h$ 代替 $E$ 会将压力-速度耦合从对流通量转移到一个涉及 $D p/D t$ 的源项，这可能会影响跨激波的离散守恒，除非采取特殊措施。**\n这是正确的。这个陈述正确地解释了我们推导的数值含义。在 $E$-公式中，压力出现在对流通量项 $(\\rho E + p)\\boldsymbol{u}$ 中。这是一种严格的守恒形式，能够正确捕捉激波。在 $h$-公式中，其守恒形式为 $\\frac{\\partial (\\rho h)}{\\partial t} + \\nabla \\cdot (\\rho h \\boldsymbol{u}) = \\frac{Dp}{Dt} + \\dots$，压力耦合已转移到源项 $Dp/Dt$。一个在源项中包含导数的方程不是严格的守恒形式。应用于此类方程的标准数值格式将无法正确计算像激波这样的不连续面的速度和强度，从而违反了朗肯-雨贡纽跳跃条件。这是CFD中一个众所周知的问题，因此在跨音速/超音速流中对 $h$-公式需要进行特殊处理。**正确**。", "answer": "$$\\boxed{ABCF}$$", "id": "3353133"}, {"introduction": "在选择基于焓的格式后，求解器必须精确地模拟焓与其他热力学变量（如温度）的关联。在许多应用中，假设比热容恒定是不够的。本练习要求您处理一个更真实的、随温度变化的定压比热容 ($c_p(T)$)，以推导焓的精确关系及其雅可比贡献 ($\\frac{\\partial h}{\\partial T}$)，这是现代耦合求解器稳定性和收敛性的一个关键组成部分。[@problem_id:3353153]", "problem": "考虑一种单组分理想气体，其气体常数 $R$ 为常数，等压热容 $c_{p}(T)$ 随温度变化。一个基于压力的可压缩求解器通过焓输运方程来推进静焓 $h(T)$ 的求解，并使用全耦合的 Newton 线性化方法，其中雅可比矩阵需要 $\\partial h/\\partial T$ 这一项。从热力学第一定律和连续介质的静焓定义出发，并利用理想气体状态方程，写出以 $h(T)$ 表示的焓输运方程，并将 $h(T)$ 表示为相对于选定参考温度 $T_{\\mathrm{ref}}$（在该温度下 $h(T_{\\mathrm{ref}})=0$）的形式，该形式应与随温度变化的 $c_{p}(T)$ 一致。假设在中等温度范围内，热容有以下科学上合理的表示形式：\n$$\nc_{p}(T) \\;=\\; c_{0} \\;+\\; c_{1}\\,T \\;+\\; c_{2}\\,T^{2} \\;+\\; \\frac{c_{3}}{T},\n$$\n其中 $c_{0}$、$c_{1}$、$c_{2}$ 和 $c_{3}$ 是正常数。以封闭形式推导耦合求解器所需的雅可比矩阵贡献项 $\\partial h/\\partial T$，将其表示为 $T$ 和给定常数的函数。将最终答案表示为单个封闭形式的解析表达式。不需要进行数值计算。", "solution": "本问题要求推导对于具有随温度变化的等压比热容 $c_p(T)$ 的理想气体，其雅可比矩阵贡献项 $\\frac{\\partial h}{\\partial T}$。推导过程必须基于基本的热力学原理。\n\n我们从连续介质的比静焓 $h$ 的定义开始：\n$$h = e + \\frac{p}{\\rho}$$\n其中 $e$ 是比内能，$p$ 是静压，$\\rho$ 是密度。以微分形式，使用比容 $v = 1/\\rho$：\n$$dh = de + d(pv) = de + p\\,dv + v\\,dp$$\n对于可逆过程，以比性质表示的热力学第一定律为：\n$$de = T\\,ds - p\\,dv$$\n其中 $T$ 是绝对温度，$s$ 是比熵。将 $de$ 的表达式代入 $dh$ 的微分式中，得到一个基本的热力学关系式：\n$$dh = (T\\,ds - p\\,dv) + p\\,dv + v\\,dp = T\\,ds + v\\,dp$$\n等压比热容 $c_p$ 定义为在恒定压力下，焓对温度的偏导数：\n$$c_p \\equiv \\left(\\frac{\\partial h}{\\partial T}\\right)_p$$\n对于一般物质，焓 $h$ 是温度和压力的函数，即 $h(T, p)$。其全微分为 $dh = (\\frac{\\partial h}{\\partial T})_p dT + (\\frac{\\partial h}{\\partial p})_T dp$。使用 $c_p$ 的定义，上式变为：\n$$dh = c_p\\,dT + \\left(\\frac{\\partial h}{\\partial p}\\right)_T dp$$\n对于理想气体，状态方程为 $p = \\rho R T$ 或 $pv = RT$。我们可以证明理想气体的焓仅是温度的函数。$(\\frac{\\partial h}{\\partial p})_T$ 项可以通过表达式 $(\\frac{\\partial h}{\\partial p})_T = v - T(\\frac{\\partial v}{\\partial T})_p$ 与状态方程关联起来。对于理想气体，$v(T,p) = RT/p$，因此 $(\\frac{\\partial v}{\\partial T})_p = R/p = v/T$。代入此式可得：\n$$\\left(\\frac{\\partial h}{\\partial p}\\right)_T = v - T\\left(\\frac{v}{T}\\right) = v - v = 0$$\n因此，对于理想气体，焓不依赖于压力，即 $h = h(T)$。微分式 $dh$ 简化为：\n$$dh = c_p(T)\\,dT$$\n这表明，对于理想气体，即使其热容随温度变化，焓对温度的常导数也等于等压比热容。\n\n问题要求给出 $h(T)$ 相对于参考温度 $T_{\\mathrm{ref}}$ （在该温度下 $h(T_{\\mathrm{ref}}) = 0$）的表达式。我们通过对前面的关系式从 $T_{\\mathrm{ref}}$ 到 $T$ 进行积分来得到该表达式：\n$$\\int_{h(T_{\\mathrm{ref}})}^{h(T)} dh' = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n$$h(T) - h(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n应用条件 $h(T_{\\mathrm{ref}}) = 0$：\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n问题给出了 $c_p(T)$ 的函数形式：\n$$c_p(T) = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\n将其代入 $h(T)$ 的积分式中：\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\left(c_{0} + c_{1}\\tau + c_{2}\\tau^{2} + \\frac{c_{3}}{\\tau}\\right) d\\tau$$\n执行定积分得到：\n$$h(T) = \\left[ c_{0}\\tau + \\frac{c_{1}}{2}\\tau^{2} + \\frac{c_{2}}{3}\\tau^{3} + c_{3}\\ln(\\tau) \\right]_{T_{\\mathrm{ref}}}^{T}$$\n$$h(T) = \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - \\left( c_{0}T_{\\mathrm{ref}} + \\frac{c_{1}}{2}T_{\\mathrm{ref}}^{2} + \\frac{c_{2}}{3}T_{\\mathrm{ref}}^{3} + c_{3}\\ln(T_{\\mathrm{ref}}) \\right)$$\n这就是比静焓作为温度函数的表达式。\n\n需要推导的主要量是雅可比矩阵贡献项 $\\frac{\\partial h}{\\partial T}$。由于 $h$ 仅是 $T$ 的函数，这等价于全导数 $\\frac{dh}{dT}$。我们可以通过对已导出的 $h(T)$ 表达式直接对 $T$ 求导来得到。涉及 $T_{\\mathrm{ref}}$ 的项是一个常数，其导数为零。\n$$\\frac{\\partial h}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - (\\text{常数}) \\right]$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}\\frac{d(T)}{dT} + \\frac{c_{1}}{2}\\frac{d(T^{2})}{dT} + \\frac{c_{2}}{3}\\frac{d(T^{3})}{dT} + c_{3}\\frac{d(\\ln(T))}{dT}$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}(1) + \\frac{c_{1}}{2}(2T) + \\frac{c_{2}}{3}(3T^{2}) + c_{3}\\left(\\frac{1}{T}\\right)$$\n简化此表达式，我们得到最终结果：\n$$\\frac{\\partial h}{\\partial T} = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\n正如微积分基本定理和我们最初的热力学分析所预期的，焓积分的导数就是比热容，即 $\\frac{\\partial h}{\\partial T} = c_p(T)$。在温度是自变量的耦合求解器中，该项对于能量（或焓）输运方程的 Newton 线性化至关重要。\n\n为求完整，问题陈述中要求的焓输运方程可以从一般能量方程推导得出。一个常见的形式是：\n$$\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} - \\nabla \\cdot \\mathbf{q} + \\mathbf{\\Phi}$$\n其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ 是物质导数，$\\mathbf{q}$ 是热通量矢量（例如，根据傅里叶定律，$\\mathbf{q} = -k \\nabla T$），而 $\\mathbf{\\Phi} = \\mathbf{\\tau} : \\nabla\\mathbf{u}$ 代表粘性耗散函数。在求解温度 $T$ 的耦合数值求解器中，焓 $h$ 被处理为 $h(T)$。在对任何包含 $h$ 的项（例如瞬态项 $\\rho \\frac{\\partial h}{\\partial t} = \\rho \\frac{\\partial h}{\\partial T} \\frac{\\partial T}{\\partial t}$）进行线性化时，就会出现 $\\frac{\\partial h}{\\partial T}$ 这一项。", "answer": "$$\\boxed{c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}}$$", "id": "3353153"}, {"introduction": "基于压力的可压缩求解器常常面临刚性问题：即使流动本身很慢，时间步长也会受到快速传播的声波的严格限制。本练习介绍了一种强大的解决方案——隐式-显式 (IMEX) 时间积分方法，该方法隐式处理刚性的声学项，同时显式处理其他项。通过稳定性分析，您将量化该方法如何放宽时间步长限制（尤其是在中低马赫数下），从而显著提高模拟效率。[@problem_id:3353113]", "problem": "考虑一个一维等熵可压缩流，该流动由围绕一个均匀状态（具有恒定速度 $u_{0} > 0$、密度 $\\rho_{0}$、压力 $p_{0}$ 和声速 $a$）的线性化欧拉方程所支配。马赫数定义为 $M = u_{0}/a$。在基于压力的公式化中，动量和连续性（压力）方程的线性化，得到了关于原始变量 $u$ 和 $p$ 的方程组：\n$$\n\\frac{\\partial u}{\\partial t} + u_{0} \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0, \\qquad\n\\frac{\\partial p}{\\partial t} + u_{0} \\frac{\\partial p}{\\partial x} + \\rho_{0} a^{2} \\frac{\\partial u}{\\partial x} = 0,\n$$\n此处假设为等熵行为，因此 $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$。\n\n您将研究一种隐式-显式（IMEX）时间积分策略，其中与压力相关的声学耦合项被隐式处理，而对流项被显式处理。具体来说，考虑一个间距为 $\\Delta x$ 的均匀周期性网格，并对无量纲波数角为 $\\theta \\in [0,\\pi]$ 的傅里叶模态应用以下空间离散化：\n- 对于与 $u_{0}$ 成正比的对流导数，使用一阶迎风差分，其符号为 $D_{\\text{up}}(\\theta) = \\frac{1 - \\exp(-i\\theta)}{\\Delta x}$。\n- 对于非对角项中的声学耦合导数，使用中心差分，其符号为 $D_{\\text{c}}(\\theta) = \\frac{i \\sin\\theta}{\\Delta x}$。\n\n设隐式-显式（IMEX）更新通过对显式对流部分使用前向欧拉法和对隐式声学部分使用后向欧拉法，从时间层 $n$ 推进到 $n+1$。记 Courant–Friedrichs–Lewy (CFL) 数为\n$$\nC = \\frac{u_{0} \\Delta t}{\\Delta x}, \\qquad \\Lambda = \\frac{a \\Delta t}{\\Delta x},\n$$\n其中 $\\Delta t$ 是时间步长。对得到的线性更新进行一次 von Neumann 傅里叶分析，以推导复数放大因子以及相应的稳定性条件，该条件要求放大矩阵的谱半径对于所有 $\\theta \\in [0,\\pi]$ 均小于或等于 $1$。由此，确定最大允许无量纲声学 CFL 数 $\\Lambda_{\\max}$ 作为马赫数 $M$ 的显式函数，并根据推导出的条件解释，为何在此 IMEX 处理下，对于中等马赫数 $M$，与声波相关的刚性问题得到了缓解。\n\n请以 $\\Lambda_{\\max}(M)$ 的单一闭式表达式形式给出最终答案，不带单位。答案必须是单一的解析表达式，而不是不等式或方程。", "solution": "该问题要求对一个给定的针对一维线性化可压缩欧拉方程的隐式-显式（IMEX）格式进行 von Neumann 稳定性分析。我们将确定最大允许声学 CFL 数 $\\Lambda_{\\max}$ 作为马赫数 $M$ 的函数。\n\n首先，我们写出给定的偏微分方程组：\n$$\n\\frac{\\partial u}{\\partial t} + u_{0} \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial p}{\\partial t} + u_{0} \\frac{\\partial p}{\\partial x} + \\rho_{0} a^{2} \\frac{\\partial u}{\\partial x} = 0\n$$\n为了在不失一般性的前提下简化分析，我们可以对变量应用一个尺度变换以使声学项对称。放大矩阵的特征值在这种线性变换下是不变的。令新变量为 $u' = u$ 和 $p' = p/(\\rho_0 a)$。方程组变为：\n$$\n\\frac{\\partial u'}{\\partial t} + u_{0} \\frac{\\partial u'}{\\partial x} + a \\frac{\\partial p'}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial p'}{\\partial t} + u_{0} \\frac{\\partial p'}{\\partial x} + a \\frac{\\partial u'}{\\partial x} = 0\n$$\n为简单起见，我们去掉撇号，并使用此对称形式。我们考虑解向量 $\\mathbf{v}(x,t) = [u(x,t), p(x,t)]^T$ 的一个傅里叶模态，其形式为 $\\mathbf{v}(x,t) = \\hat{\\mathbf{v}}(t) \\exp(ikx)$，其中 $k$ 是波数。空间导数 $\\partial/\\partial x$ 被其离散傅里叶符号所替代。令 $\\theta = k\\Delta x$ 为无量纲波数角。\n\n傅里叶空间中的半离散化系统为：\n$$\n\\frac{d\\hat{\\mathbf{v}}}{dt} = \\mathbf{A} \\hat{\\mathbf{v}}\n$$\n根据 IMEX 分裂，算子矩阵 $\\mathbf{A}$ 被分裂为显式部分 $\\mathbf{E}$ (对流)和隐式部分 $\\mathbf{I}$ (声学)。\n$$\n\\mathbf{E} = -u_0 D_{\\text{up}}(\\theta) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\quad , \\quad \\mathbf{I} = -a D_{\\text{c}}(\\theta) \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n其中 $D_{\\text{up}}(\\theta) = \\frac{1 - \\exp(-i\\theta)}{\\Delta x}$ 且 $D_{\\text{c}}(\\theta) = \\frac{i \\sin\\theta}{\\Delta x}$。\n\n对显式部分使用前向欧拉法、对隐式部分使用后向欧拉法的 IMEX 时间积分格式由下式给出：\n$$\n\\frac{\\hat{\\mathbf{v}}^{n+1} - \\hat{\\mathbf{v}}^n}{\\Delta t} = \\mathbf{E} \\hat{\\mathbf{v}}^n + \\mathbf{I} \\hat{\\mathbf{v}}^{n+1}\n$$\n对 $\\hat{\\mathbf{v}}^{n+1}$ 进行整理，得到更新规则 $\\hat{\\mathbf{v}}^{n+1} = \\mathbf{G} \\hat{\\mathbf{v}}^n$，其中 $\\mathbf{G}$ 是放大矩阵：\n$$\n(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I}) \\hat{\\mathbf{v}}^{n+1} = (\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E}) \\hat{\\mathbf{v}}^n \\implies \\mathbf{G} = (\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1} (\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})\n$$\n此处，$\\mathbf{I}_{\\text{mat}}$ 是单位矩阵。我们来计算右侧的矩阵。\n$$\n\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E} = \\left(1 - \\Delta t u_0 \\frac{1 - \\exp(-i\\theta)}{\\Delta x}\\right) \\mathbf{I}_{\\text{mat}} = \\left(1 - C(1 - \\exp(-i\\theta))\\right) \\mathbf{I}_{\\text{mat}}\n$$\n其中 $C = u_0 \\Delta t / \\Delta x$ 是对流 CFL 数。\n$$\n\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I} = \\mathbf{I}_{\\text{mat}} + \\Delta t a \\frac{i \\sin\\theta}{\\Delta x} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  i \\Lambda \\sin\\theta \\\\ i \\Lambda \\sin\\theta  1 \\end{pmatrix}\n$$\n其中 $\\Lambda = a \\Delta t / \\Delta x$ 是声学 CFL 数。\n其逆矩阵为：\n$$\n(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1} = \\frac{1}{1 - (i \\Lambda \\sin\\theta)^2} \\begin{pmatrix} 1  -i \\Lambda \\sin\\theta \\\\ -i \\Lambda \\sin\\theta  1 \\end{pmatrix} = \\frac{1}{1 + \\Lambda^2 \\sin^2\\theta} \\begin{pmatrix} 1  -i \\Lambda \\sin\\theta \\\\ -i \\Lambda \\sin\\theta  1 \\end{pmatrix}\n$$\n矩阵 $(\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})$ 和 $(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1}$ 是可交换的，因为前者是单位矩阵的标量倍。因此，它们乘积 $\\mathbf{G}$ 的特征值是它们各自特征值的乘积。\n$(\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})$ 的特征值是 $\\zeta = 1 - C(1 - \\exp(-i\\theta))$。\n矩阵 $(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1}$ 的矩阵部分的特征值可由特征方程 $(1-\\lambda)^2 - (-i\\Lambda\\sin\\theta)^2 = 0$ 求得，该方程给出 $\\lambda = 1 \\mp i\\Lambda\\sin\\theta$。所以，完整逆矩阵的特征值为 $\\frac{1 \\mp i\\Lambda\\sin\\theta}{1 + \\Lambda^2 \\sin^2\\theta}$。\n\n放大矩阵 $\\mathbf{G}$ 的特征值 $\\lambda_G$ 因此为：\n$$\n\\lambda_G = \\left(1 - C(1 - \\exp(-i\\theta))\\right) \\frac{1 \\mp i\\Lambda\\sin\\theta}{1 + \\Lambda^2 \\sin^2\\theta}\n$$\n为保证稳定性，对于所有 $\\theta \\in [0, \\pi]$，$\\mathbf{G}$ 的谱半径必须小于或等于 $1$。这意味着 $|\\lambda_G|^2 \\le 1$。\n$$\n|\\lambda_G|^2 = |1 - C(1 - \\exp(-i\\theta))|^2 \\left| \\frac{1 \\mp i\\Lambda\\sin\\theta}{1 + \\Lambda^2 \\sin^2\\theta} \\right|^2\n$$\n我们来计算这两个因子的模的平方。\n$|1 - C(1 - \\exp(-i\\theta))|^2 = |(1-C+C\\cos\\theta) - iC\\sin\\theta|^2 = (1-C+C\\cos\\theta)^2 + (C\\sin\\theta)^2 = 1 - 2C(1-C)(1-\\cos\\theta)$。\n$\\left| \\frac{1 \\mp i\\Lambda\\sin\\theta}{1 + \\Lambda^2 \\sin^2\\theta} \\right|^2 = \\frac{|1 \\mp i\\Lambda\\sin\\theta|^2}{(1 + \\Lambda^2 \\sin^2\\theta)^2} = \\frac{1 + \\Lambda^2 \\sin^2\\theta}{(1 + \\Lambda^2 \\sin^2\\theta)^2} = \\frac{1}{1 + \\Lambda^2 \\sin^2\\theta}$。\n稳定性条件变为：\n$$\n\\frac{1 - 2C(1-C)(1-\\cos\\theta)}{1 + \\Lambda^2 \\sin^2\\theta} \\le 1\n$$\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1 + \\Lambda^2 \\sin^2\\theta\n$$\n$$\n-2C(1-C)(1-\\cos\\theta) \\le \\Lambda^2 \\sin^2\\theta\n$$\n为使此不等式对所有 $\\theta \\in [0, \\pi]$ 成立，我们分析各项的符号。由于 $\\Lambda^2 \\ge 0$，$\\sin^2\\theta \\ge 0$，且 $1-\\cos\\theta \\ge 0$，因此右侧总是非负的。\n如果左侧 $(1-\\cos\\theta)$ 项的系数是非正的，即 $-2C(1-C) \\le 0$，那么左侧总是非正的，并且该不等式对 $\\Lambda$ 的任何值都成立。\n条件 $-2C(1-C) \\le 0$ 意味着 $C(1-C) \\ge 0$。由于 CFL 数 $C = u_0 \\Delta t / \\Delta x$ 必须为正，我们需要 $1-C \\ge 0$，这给出了约束条件 $C \\le 1$。\n因此，只要对流 CFL 数满足 $C \\le 1$，该格式对于任何声学 CFL 数 $\\Lambda$ 都是稳定的。\n\n问题要求将最大允许声学 CFL 数 $\\Lambda_{\\max}$ 表示为马赫数 $M$ 的函数。我们使用 CFL 数之间的关系：\n$$\nC = \\frac{u_0 \\Delta t}{\\Delta x} = \\frac{u_0}{a} \\frac{a \\Delta t}{\\Delta x} = M \\Lambda\n$$\n稳定性条件 $C \\le 1$ 可以用 $M$ 和 $\\Lambda$ 来重写：\n$$\nM \\Lambda \\le 1\n$$\n对于给定的马赫数 $M > 0$，这对 $\\Lambda$ 施加了一个上限：\n$$\n\\Lambda \\le \\frac{1}{M}\n$$\n因此，最大允许无量纲声学 CFL 数为 $\\Lambda_{\\max} = 1/M$。\n\n最后，我们解释为什么这种 IMEX 处理可以降低刚性。一个完全显式的格式必须解析系统中最快的波，这些波以速度 $u_0 \\pm a$ 传播。这种格式的稳定性极限通常具有 $\\Delta t \\le \\frac{\\Delta x}{|u_0|+a}$ 的形式，这可以转换为 $\\frac{(|u_0|+a)\\Delta t}{\\Delta x} \\le K$，其中 $K$ 是某个量级为 1 的常数。假设 $K=1$ 且 $u_0>0$，我们得到 $C + \\Lambda \\le 1$，或 $\\Lambda(M+1) \\le 1$，从而得到显式声学 CFL 极限为 $\\Lambda_{\\text{exp}} \\le \\frac{1}{M+1}$。\n将 IMEX 极限 $\\Lambda_{\\text{IMEX}} \\le 1/M$ 与显式极限进行比较，我们看到 $\\frac{1}{M} > \\frac{1}{M+1}$。最大时间步长之比为 $\\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{exp}}} = \\frac{1/M}{1/(M+1)} = \\frac{M+1}{M} = 1 + \\frac{1}{M}$。\n在中等马赫数（例如，$M<1$）下，这个比率显著大于 $1$。例如，在 $M=0.1$ 时，IMEX 格式允许的时间步长是显式格式的 $11$ 倍。当 $a \\gg u_0$（即小 $M$）时，会出现刚性问题，这迫使显式格式采用非常小的 $\\Delta t$ 来解析快速的声波。IMEX 格式隐式地处理这些刚性声学项，从而有效地从稳定性约束中移除了声速 $a$。由此产生的时间步长限制 $\\Delta t \\le \\frac{\\Delta x}{u_0}$，仅取决于慢得多的对流速度 $u_0$，从而缓解了刚性问题。", "answer": "$$\\boxed{\\frac{1}{M}}$$", "id": "3353113"}]}