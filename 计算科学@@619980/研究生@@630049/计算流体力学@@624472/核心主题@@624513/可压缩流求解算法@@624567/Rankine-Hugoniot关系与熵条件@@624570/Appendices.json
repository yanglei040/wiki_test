{"hands_on_practices": [{"introduction": "要真正理解激波，我们必须从最基本的原理出发。本练习将引导您直接从一个标量守恒律的积分形式推导出Rankine-Hugoniot跳跃条件。通过执行这一基础推导，并对一个非凸通量应用Lax熵条件，您将巩固对不连续性如何被数学描述以及如何筛选出物理上合理的解的理解[@problem_id:3356128]。", "problem": "考虑在 $\\mathbb{R} \\times (0,\\infty)$ 上的标量守恒律 $u_{t} + f(u)_{x} = 0$，其分段常数弱解具有单个移动间断，模型为 $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x > s(t)\\}}$，其中 $s(t)$ 为 Lipschitz 连续轨迹。通量由 $f(u) = u^{3} - 3u$ 给出，黎曼数据为 $u_{L} = 2$ 和 $u_{R} = 0$。\n\n1) 仅从跨越间断的时空控制体上的守恒积分形式以及 $u$ 是一个弱解的假设出发，推导连接激波速度 $s'(t)$ 与迹 $u_{L}$、$u_{R}$ 及相应通量值的跳跃条件。\n\n2) 对于给定的通量和状态，计算激波速度 $s'(t)$。请以精确数形式给出最终答案。\n\n3) 解释标量守恒律中用于从所有弱解中筛选出物理间断的熵容许性判据，并说明在何种条件下，第 2 部分中得到的激波速度是与熵解相容的唯一速度。特别地，评估从 $u_{L} = 2$ 到 $u_{R} = 0$ 的激波是否满足基于特征压缩的标准容许性条件。\n\n将第 2 部分的最终答案表示为一个精确数，无需四舍五入，也无需单位。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n-   **控制方程**：标量守恒律为 $u_{t} + f(u)_{x} = 0$，定义域为 $\\mathbb{R} \\times (0,\\infty)$。\n-   **通量函数**：通量由 $f(u) = u^{3} - 3u$ 给出。\n-   **解的结构**：弱解具有单个移动间断，描述为 $u(x,t) = u_{L}\\,\\mathbf{1}_{\\{x  s(t)\\}} + u_{R}\\,\\mathbf{1}_{\\{x > s(t)\\}}$。\n-   **间断路径**：间断的路径 $s(t)$ 是一个 Lipschitz 连续函数。\n-   **黎曼数据**：常数状态为 $u_{L} = 2$ 和 $u_{R} = 0$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是双曲型偏微分方程数学理论中的一个标准练习，特别关注标量守恒律、Rankine–Hugoniot 条件和熵解。这些是计算流体力学和连续介质力学中的基本概念。该问题在科学和数学上是合理的。\n2.  **适定性**：该问题是标量守恒律的黎曼问题。此类问题物理相关（熵）解的存在性和唯一性已由 Oleinik 和 Kružkov 的工作很好地确立。在此背景下，该问题是适定的。\n3.  **客观性**：问题使用精确的数学语言和定义陈述。所有量都被明确定义。\n4.  **不完整或矛盾的设定**：问题提供了所有必要信息：偏微分方程、通量函数、初始状态和假定的解结构。没有矛盾之处。\n5.  **不切实际或不可行**：该问题是一个理论模型，并不声称代表具有测量数据的特定物理系统。其组成部分在数学上是一致的。\n6.  **不适定或结构不良**：该问题结构良好，在熵解的标准框架下导向一个唯一的、有意义的解。\n7.  **伪深刻、琐碎或同义反复**：该问题需要标准的但非平凡的推导、计算和概念解释，测试了该主题的基础知识。\n8.  **超出科学可验证性**：该问题是一个数学构造，完全可以通过逻辑推导和已建立的数学理论进行验证。\n\n### 第 3 步：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n***\n\n### 第 1 部分：Rankine–Hugoniot 跳跃条件的推导\n\n守恒律 $u_{t} + f(u)_{x} = 0$ 可以写成积分形式。对于空间中的任意控制体 $[x_{1}, x_{2}]$，守恒量 $u$ 的总量变化率等于穿过边界的净通量：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = f(u(x_{1}, t)) - f(u(x_{2}, t))\n$$\n该形式对光滑解成立。对于在 $x=s(t)$ 处有间断的弱解，我们必须谨慎应用此原理。\n\n让我们考虑一个在空间中固定的控制体 $[x_{1}, x_{2}]$，它在所有我们关心的时间 $t$ 内都包含激波，即 $x_{1}  s(t)  x_{2}$。解的形式为：当 $x  s(t)$ 时，$u(x,t) = u_{L}$；当 $x > s(t)$ 时，$u(x,t) = u_{R}$。\n\n左侧的积分可以在间断处拆分：\n$$\n\\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\int_{x_{1}}^{s(t)} u_{L} \\,dx + \\int_{s(t)}^{x_{2}} u_{R} \\,dx = u_{L} (s(t) - x_{1}) + u_{R} (x_{2} - s(t))\n$$\n现在，我们对这个表达式关于时间 $t$ 求导。由于 $x_{1}$、$x_{2}$、$u_{L}$ 和 $u_{R}$ 都是常数，我们对 $s(t)$ 使用链式法则，并将其导数记为 $s'(t)$：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\,dx = \\frac{d}{dt} [u_{L} s(t) - u_{L} x_{1} + u_{R} x_{2} - u_{R} s(t)] = u_{L} s'(t) - u_{R} s'(t) = s'(t)(u_{L} - u_{R})\n$$\n积分形式的右侧涉及边界 $x_{1}$ 和 $x_{2}$ 处的通量。由于 $x_{1}  s(t)$ 且 $x_{2} > s(t)$，我们有 $u(x_{1}, t) = u_{L}$ 和 $u(x_{2}, t) = u_{R}$。因此通量项为：\n$$\nf(u(x_{1}, t)) - f(u(x_{2}, t)) = f(u_{L}) - f(u_{R})\n$$\n令两个表达式相等，我们得到：\n$$\ns'(t)(u_{L} - u_{R}) = f(u_{L}) - f(u_{R})\n$$\n这就是 Rankine–Hugoniot 跳跃条件。它将间断速度 $s'(t)$ 与其两侧的状态 $u_{L}$、$u_{R}$ 及相应的通量值联系起来。该速度（通常记为 $s$）由下式给出：\n$$\ns'(t) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{[f]}{[u]}\n$$\n其中 $[q] = q_L - q_R$ 表示量 $q$ 跨过间断的跳跃。\n\n### 第 2 部分：激波速度的计算\n\n给定通量函数 $f(u) = u^{3} - 3u$ 和黎曼数据 $u_{L} = 2$、$u_{R} = 0$。我们应用第 1 部分推导出的 Rankine–Hugoniot 条件。\n\n首先，我们计算左右状态下的通量：\n-   对于 $u_{L} = 2$：$f(u_{L}) = f(2) = 2^{3} - 3(2) = 8 - 6 = 2$。\n-   对于 $u_{R} = 0$：$f(u_{R}) = f(0) = 0^{3} - 3(0) = 0$。\n\n接下来，我们计算通量和状态的跳跃：\n-   通量跳跃：$[f] = f(u_{L}) - f(u_{R}) = 2 - 0 = 2$。\n-   状态跳跃：$[u] = u_{L} - u_{R} = 2 - 0 = 2$。\n\n激波速度 $s'(t)$ 是这些跳跃的比值：\n$$\ns'(t) = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{2}{2} = 1\n$$\n激波速度是常数，$s'(t) = 1$。\n\n### 第 3 部分：熵容许性判据\n\n守恒律的弱解不一定唯一。需要一个额外的判据，即所谓的熵条件，来筛选出物理上正确的解。对于标量守恒律，这个条件确保了沿特征线携带的信息是流入激波间断，而不是从间断处发出。激波波前代表了一个信息丢失的不可逆过程，这类似于热力学系统中熵的增加。\n\n信息传播的速度，即特征速度，由 $c(u) = f'(u)$ 给出。对于给定的通量 $f(u) = u^{3} - 3u$，特征速度为：\n$$\nc(u) = f'(u) = \\frac{d}{du}(u^{3} - 3u) = 3u^{2} - 3\n$$\n激波的标准容许性条件，即 Lax 熵条件，要求激波左侧的特征速度大于激波速度，而激波速度又必须大于激波右侧的特征速度。这种“特征压缩”可表示为：\n$$\nf'(u_{L}) > s'(t) > f'(u_{R})\n$$\n让我们针对给定的问题评估这个条件。我们有 $u_{L} = 2$，$u_{R} = 0$，并且我们求得 $s'(t) = 1$。我们计算左右状态下的特征速度：\n-   $c(u_{L}) = f'(u_{L}) = f'(2) = 3(2)^{2} - 3 = 3(4) - 3 = 12 - 3 = 9$。\n-   $c(u_{R}) = f'(u_{R}) = f'(0) = 3(0)^{2} - 3 = 0 - 3 = -3$。\n\n将这些值代入 Lax 熵不等式：\n$$\n9 > 1 > -3\n$$\n这个不等式成立。因此，连接 $u_{L}=2$ 到 $u_{R}=0$ 且速度为 $s'=1$ 的激波满足 Lax 熵条件，是一个容许的、物理的激波。\n\n对于给定的黎曼问题，此激波解的唯一性源于熵解的一般理论（例如，Kružkov 的理论）。该理论保证了满足熵条件的解是唯一的。当一个间断满足 Lax 条件时，该激波就是唯一熵解的正确构造单元。\n\n值得注意的是，通量函数 $f(u) = u^{3} - 3u$ 是非凸的，因为其二阶导数 $f''(u) = 6u$ 会变号。对于非凸通量，需要更一般的 Oleinik 熵条件。该条件指出，对于所有介于 $u_{L}$ 和 $u_{R}$ 之间的 $u$，连接通量图上点 $(u_{L}, f(u_{L}))$ 和 $(u_{R}, f(u_{R}))$ 的线段（弦）必须位于 $f(u)$ 图像的一侧。在我们的情况中，$u_{L}>u_{R}$，弦必须位于通量图的上方。该弦连接 $(0,0)$ 和 $(2,2)$，其方程为 $y(u)=u$。条件是对于 $u \\in [0, 2]$，$f(u) \\le u$。这等价于 $u^{3} - 3u \\le u$，即 $u^{3} - 4u \\le 0$。因式分解得到 $u(u-2)(u+2) \\le 0$。对于 $u \\in (0,2)$，此表达式为负，在端点处为零，因此条件成立。所以，即使在这个更严格、更一般的条件下，该激波也是容许的。", "answer": "$$\\boxed{1}$$", "id": "3356128"}, {"introduction": "在掌握了基本的跳跃条件之后，我们现在将其应用于一个更真实的物理系统：可压缩欧拉方程。这个实践将分析一个活塞驱动的正激波问题，这是一个气体动力学中的经典问题，并将分析扩展到不确定性量化。通过推导激波速度的隐式关系并计算其对气体性质的敏感性，您将学会如何不仅使用Rankine-Hugoniot关系求解状态，还能进行高级工程分析[@problem_id:3356163]。", "problem": "一个刚性活塞将一道平面正激波驱动进入静止的理想气体中。上游气体（状态 $1$）初始静止，其压力 $p_1 = 1.00 \\times 10^5\\,\\mathrm{Pa}$，密度 $\\rho_1 = 1.225\\,\\mathrm{kg/m^3}$。在所关心的时间尺度上，活塞以 $u_p = 300\\,\\mathrm{m/s}$ 的匀速侵入气体，一道单一、稳定的平面激波以实验室坐标系速度 $S$ 传播到未受扰动的气体中。工作流体遵循理想气体状态方程 (EOS)，其比熱比 $\\gamma$ 是一个常数但不确定；所有其他量均视为已知和确定性的。假设激波是物理上可接受的（熵增的）。\n\n仅从激波固定坐标系中跨越间断面的一维质量、动量和能量守恒定律，以及理想气体焓关系式 $h = \\gamma p/[(\\gamma - 1)\\rho]$ 出发，按如下步骤进行。\n\n1. 针对此活塞驱动构型，推导出一个单一的隐式方程 $F(S,\\gamma)=0$，该方程关联了激波速度 $S$ 和状态方程参数 $\\gamma$，并用给定的上游数据 $(p_1,\\rho_1)$ 和活塞速度 $u_p$ 表示。\n2. 使用对您的 $F(S,\\gamma)=0$ 方程的隐式微分，求出在名义值 $\\gamma_0 = 1.40$ 处的线性化灵敏度 $\\partial S / \\partial \\gamma$。在此求值过程中，使用您的隐式方程所对应的激波速度 $S(\\gamma_0)$。\n3. 假设 $\\gamma$ 的标准不确定度为 $\\sigma_\\gamma = 0.020$。使用一阶不确定度传播方法，估计激波速度的标准不确定度为 $\\sigma_S \\approx \\left|\\left.\\partial S/\\partial \\gamma\\right|_{\\gamma_0}\\right| \\,\\sigma_\\gamma$。\n\n以 $\\mathrm{m/s}$ 为单位表示 $\\sigma_S$ 的最终数值，并将您的答案四舍五入到三位有效数字。不要使用任何预先制表的正激波公式；从守恒定律和理想气体模型推导您的关系式。明确说明您用来选择与熵条件一致的正确激波解所进行的任何物理可接受性检查。最终答案必须是一个实数。", "solution": "该问题要求从第一性原理出发，推导活塞驱动激波的速度 $S$ 对气体比热比 $\\gamma$ 的灵敏度。\n\n求解过程分为三个主要部分：\n1. 推导关联激波速度 $S$ 和比热比 $\\gamma$ 的隐式方程。\n2. 计算在名义值 $\\gamma_0$ 处的线性化灵敏度 $\\partial S / \\partial \\gamma$。\n3. 基于 $\\gamma$ 的不确定度，估计激波速度的不确定度 $\\sigma_S$。\n\n我们已知上游静止状态（状态 $1$）的压力为 $p_1 = 1.00 \\times 10^5\\,\\mathrm{Pa}$，密度为 $\\rho_1 = 1.225\\,\\mathrm{kg/m^3}$。气体初始静止，因此其在实验室坐标系中的速度为 $u_1 = 0$。一个活塞以 $u_p = 300\\,\\mathrm{m/s}$ 的恒定速度侵入该气体，驱动一道平面正激波，其在实验室坐标系中的速度为 $S$。激波后的气体（状态 $2$）被带到与活塞相同的速度，因此 $u_2 = u_p$。该气体为理想气体，其焓由 $h = \\gamma p / ((\\gamma - 1)\\rho)$ 给出。\n\n该问题必须在激波固定坐标系中求解，在该坐标系中激波是静止的。此激波固定坐标系中的速度（用撇号表示）与实验室坐标系中的速度通过 $u' = u - S$ 相关联。\n上游气体速度为 $u'_1 = u_1 - S = 0 - S = -S$。\n下游气体速度为 $u'_2 = u_2 - S = u_p - S$。\n\nRankine–Hugoniot 关系式表达了跨越静止激波的质量、动量和能量守恒，具体如下：\n1. 质量守恒：$\\rho_1 u'_1 = \\rho_2 u'_2$\n$$ \\rho_1 (-S) = \\rho_2 (u_p - S) \\implies \\rho_1 S = \\rho_2 (S - u_p) \\quad (1) $$\n2. 动量守恒：$p_1 + \\rho_1 (u'_1)^2 = p_2 + \\rho_2 (u'_2)^2$\n$$ p_1 + \\rho_1 S^2 = p_2 + \\rho_2 (u_p - S)^2 \\quad (2) $$\n3. 能量守恒：$h_1 + \\frac{1}{2}(u'_1)^2 = h_2 + \\frac{1}{2}(u'_2)^2$\n$$ h_1 + \\frac{1}{2} S^2 = h_2 + \\frac{1}{2} (u_p - S)^2 \\quad (3) $$\n\n我们的首要目标是通过消去未知的下游状态变量 $p_2$ 和 $\\rho_2$ 来推导出一个单一方程 $F(S, \\gamma) = 0$。\n\n从质量守恒方程（1），我们可以用 $\\rho_1$ 和速度来表示 $\\rho_2$：\n$$ \\rho_2 = \\rho_1 \\frac{S}{S - u_p} \\quad (4) $$\n对于压缩激波，必须有 $\\rho_2 > \\rho_1$。由于激波侵入气体时 $S > 0$，这意味着 $S - u_p > 0$，所以 $S > u_p$。\n\n接着，我们重排动量方程（2）以解出 $p_2$：\n$p_2 = p_1 + \\rho_1 S^2 - \\rho_2 (S - u_p)^2$。\n代入 (4) 式中的 $\\rho_2$：\n$p_2 = p_1 + \\rho_1 S^2 - \\left(\\rho_1 \\frac{S}{S - u_p}\\right) (S-u_p)^2 = p_1 + \\rho_1 S^2 - \\rho_1 S (S - u_p)$。\n$p_2 = p_1 + \\rho_1 S^2 - \\rho_1 S^2 + \\rho_1 S u_p$。\n$$ p_2 = p_1 + \\rho_1 S u_p \\quad (5) $$\n\n现在，我们使用能量方程（3）。重排该方程得到：\n$h_2 - h_1 = \\frac{1}{2} (S^2 - (u_p-S)^2) = \\frac{1}{2} (S^2 - (S^2 - 2Su_p + u_p^2)) = S u_p - \\frac{1}{2} u_p^2$。\n使用理想气体焓关系式 $h = \\gamma p / ((\\gamma - 1)\\rho)$：\n$h_2 - h_1 = \\frac{\\gamma}{\\gamma - 1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right)$。\n令 $h_2 - h_1$ 的两个表达式相等：\n$$ \\frac{\\gamma}{\\gamma - 1} \\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = S u_p - \\frac{1}{2} u_p^2 \\quad (6) $$\n将 (5) 式的 $p_2$ 和 (4) 式的 $\\rho_2$ 代入方程 (6)：\n$\\frac{p_2}{\\rho_2} = \\frac{p_1 + \\rho_1 S u_p}{\\rho_1 S / (S - u_p)} = \\frac{(p_1 + \\rho_1 S u_p)(S - u_p)}{\\rho_1 S}$。\n将此式代入 (6)：\n$\\frac{\\gamma}{\\gamma - 1} \\left( \\frac{(p_1 + \\rho_1 S u_p)(S - u_p)}{\\rho_1 S} - \\frac{p_1}{\\rho_1} \\right) = S u_p - \\frac{1}{2} u_p^2$。\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1} \\left( \\frac{p_1 S - p_1 u_p + \\rho_1 S^2 u_p - \\rho_1 S u_p^2 - p_1 S}{S} \\right) = S u_p - \\frac{1}{2} u_p^2$。\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1} \\frac{-p_1 u_p + \\rho_1 u_p S^2 - \\rho_1 u_p S u_p}{S} = u_p \\left(S - \\frac{u_p}{2}\\right)$。\n由于 $u_p \\neq 0$，我们可以将两边同除以 $u_p$：\n$\\frac{\\gamma}{(\\gamma - 1)\\rho_1 S} (-p_1 + \\rho_1 S^2 - \\rho_1 S u_p) = S - \\frac{u_p}{2}$。\n$\\frac{\\gamma}{\\gamma - 1} (S - u_p - \\frac{p_1}{\\rho_1 S}) = S - \\frac{u_p}{2}$。\n$\\frac{\\gamma(S - u_p)}{\\gamma - 1} - \\frac{\\gamma p_1}{(\\gamma - 1)\\rho_1 S} = S - \\frac{u_p}{2}$。\n重排各项以解出含 $p_1$ 的项：\n$\\frac{\\gamma(S - u_p)}{\\gamma - 1} - (S - \\frac{u_p}{2}) = \\frac{\\gamma p_1}{(\\gamma - 1)\\rho_1 S}$。\n$\\frac{\\gamma S - \\gamma u_p - (\\gamma-1)(S - u_p/2)}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$。\n$\\frac{\\gamma S - \\gamma u_p - \\gamma S + \\gamma u_p/2 + S - u_p/2}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$。\n$\\frac{S - (\\gamma/2)u_p - u_p/2}{\\gamma-1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1 S}$。\n$S - \\frac{\\gamma + 1}{2}u_p = \\frac{\\gamma p_1}{\\rho_1 S}$。\n$S^2 - \\frac{\\gamma + 1}{2} u_p S - \\frac{\\gamma p_1}{\\rho_1} = 0$。\n这就是所求的隐式方程 $F(S, \\gamma) = 0$。为方便起见，我们可以乘以 $2\\rho_1$：\n$$ F(S, \\gamma) = 2\\rho_1 S^2 - (\\gamma+1)\\rho_1 u_p S - 2\\gamma p_1 = 0 \\quad (7) $$\n这是一个关于 $S$ 的二次方程。物理上可接受的解必须满足 $S>0$ 和 $S>u_p$。解为：\n$S = \\frac{(\\gamma+1)\\rho_1 u_p \\pm \\sqrt{((\\gamma+1)\\rho_1 u_p)^2 - 4(2\\rho_1)(-2\\gamma p_1)}}{4\\rho_1} = \\frac{(\\gamma+1)u_p}{4} \\pm \\sqrt{\\left(\\frac{(\\gamma+1)u_p}{4}\\right)^2 + \\frac{\\gamma p_1}{\\rho_1}}$。\n平方根下的项是正的。为确保 $S>0$，我们必须取正根。这个选择也确保了 $S > u_p$，正如压缩激波所要求的，因为 $\\sqrt{\\left(\\frac{(\\gamma+1)u_p}{4}\\right)^2 + \\frac{\\gamma p_1}{\\rho_1}} > \\frac{(\\gamma+1)u_p}{4}$，这意味着 $S > 2\\frac{(\\gamma+1)u_p}{4} = \\frac{\\gamma+1}{2}u_p$。对于 $\\gamma>1$，这意味着 $S>u_p$。\n\n接下来，我们通过对 $F(S, \\gamma) = 0$ 进行隐式微分来求灵敏度 $\\partial S / \\partial \\gamma$。\n$\\frac{dF}{d\\gamma} = \\frac{\\partial F}{\\partial S}\\frac{\\partial S}{\\partial \\gamma} + \\frac{\\partial F}{\\partial \\gamma} = 0 \\implies \\frac{\\partial S}{\\partial \\gamma} = -\\frac{\\partial F / \\partial \\gamma}{\\partial F / \\partial S}$。\n$F(S, \\gamma)$ 对 (7) 式的偏导数是：\n$\\frac{\\partial F}{\\partial S} = 4\\rho_1 S - (\\gamma+1)\\rho_1 u_p$。\n$\\frac{\\partial F}{\\partial \\gamma} = - \\rho_1 u_p S - 2p_1$。\n所以，灵敏度为：\n$$ \\frac{\\partial S}{\\partial \\gamma} = - \\frac{-\\rho_1 u_p S - 2p_1}{4\\rho_1 S - (\\gamma+1)\\rho_1 u_p} = \\frac{\\rho_1 u_p S + 2p_1}{4\\rho_1 S - (\\gamma+1)\\rho_1 u_p} $$\n为了计算这个值，我们首先需要求出名义值 $\\gamma_0 = 1.40$ 对应的激波速度 $S_0$。\n使用取正根的 $S$ 的解：\n$S_0 = S(\\gamma_0) = \\frac{(\\gamma_0+1)u_p}{4} + \\sqrt{\\left(\\frac{(\\gamma_0+1)u_p}{4}\\right)^2 + \\frac{\\gamma_0 p_1}{\\rho_1}}$。\n已知数据：$u_p=300\\,\\mathrm{m/s}$，$p_1=1.00 \\times 10^5\\,\\mathrm{Pa}$，$\\rho_1=1.225\\,\\mathrm{kg/m^3}$，$\\gamma_0=1.40$。\n$\\frac{(\\gamma_0+1)u_p}{4} = \\frac{(1.40+1) \\times 300}{4} = \\frac{2.4 \\times 300}{4} = 180\\,\\mathrm{m/s}$。\n$\\frac{\\gamma_0 p_1}{\\rho_1} = \\frac{1.40 \\times 1.00 \\times 10^5}{1.225} \\approx 114285.71\\,\\mathrm{m^2/s^2}$。\n$S_0 = 180 + \\sqrt{(180)^2 + 114285.71} = 180 + \\sqrt{32400 + 114285.71} = 180 + \\sqrt{146685.71}$。\n$S_0 \\approx 180 + 382.9957 \\approx 562.9957\\,\\mathrm{m/s}$。\n\n现在我们计算在 $(\\gamma_0, S_0)$ 处的灵敏度 $\\partial S / \\partial \\gamma$：\n分子：$\\rho_1 u_p S_0 + 2p_1 = (1.225)(300)(562.9957) + 2(1.00 \\times 10^5)$\n$= 367.5 \\times 562.9957 + 200000 \\approx 206890.93 + 200000 = 406890.93\\,\\mathrm{N/m^2}$。\n分母：$4\\rho_1 S_0 - (\\gamma_0+1)\\rho_1 u_p = 4(1.225)(562.9957) - (1.40+1)(1.225)(300)$\n$= 4.9 \\times 562.9957 - 2.4 \\times 367.5 \\approx 2758.679 - 882 = 1876.679\\,\\mathrm{kg \\cdot m/(s \\cdot m^2)}$。\n$\\left.\\frac{\\partial S}{\\partial \\gamma}\\right|_{\\gamma_0} = \\frac{406890.93}{1876.679} \\approx 216.819\\,\\mathrm{m/s}$。\n\n最后，我们使用一阶不确定度传播方法估计激波速度的标准不确定度 $\\sigma_S$。\n$\\sigma_S \\approx \\left|\\left.\\frac{\\partial S}{\\partial \\gamma}\\right|_{\\gamma_0}\\right| \\sigma_\\gamma$。\n已知 $\\sigma_\\gamma = 0.020$。\n$\\sigma_S \\approx |216.819| \\times 0.020 \\approx 4.33638\\,\\mathrm{m/s}$。\n四舍五入到三位有效数字，激波速度的不确定度为 $4.34\\,\\mathrm{m/s}$。", "answer": "$$\n\\boxed{4.34}\n$$", "id": "3356163"}, {"introduction": "当使用非凸的状态方程时，激波现象的复杂性会急剧增加，可能产生违反简单Lax熵条件的非经典激波。这项高级编程练习要求您为一个包含van der Waals气体模型的欧拉方程组实现一个数值通量，并明确地施加更具一般性的Liu熵条件。通过追踪Hugoniot曲线并构造一个惩罚激波速度，您将获得关于非经典激波理论的实践经验，并学会如何将复杂的数学条件转化为一个可行的数值方案[@problem_id:3356172]。", "problem": "您需要从第一性原理出发，为一维可压缩欧拉方程实现一个两点数值通量，该通量通过惩罚沿 Hugoniot 曲线上激波速度的增加来显式地强制执行 Liu 熵条件。其守恒形式的控制系统是欧拉方程组，状态向量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，物理通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，其中 $\\rho$ 是质量密度，$u$ 是速度，$E$ 是比总能，$e = E - \\tfrac{1}{2}u^{2}$ 是比内能，$p$ 是热力学压力。状态方程是一个无量纲的 van der Waals 类型模型，具有吸引参数 $a$ 和协体积参数 $b$，由下式给出\n$$\np(\\rho,e) = \\frac{(\\gamma - 1)\\,\\rho\\, e}{1 - b\\,\\rho} - a\\,\\rho^{2},\n$$\n其定义域限制为 $\\rho  1/b$。所有量均为无量纲；报告所有数值结果时不带物理单位。\n\n连接左状态 L 和右状态 R 的界面激波速度 $\\sigma$ 受到跨越以速度 $\\sigma$ 移动的定常间断的 Rankine–Hugoniot 关系的约束：\n- 质量：$\\rho_{R}(u_{R} - \\sigma) = \\rho_{L}(u_{L} - \\sigma) = m$。\n- 动量：$p_{R} + \\rho_{R}(u_{R} - \\sigma)^{2} = p_{L} + \\rho_{L}(u_{L} - \\sigma)^{2}$。\n- 能量：$h_{R} + \\tfrac{1}{2}(u_{R} - \\sigma)^{2} = h_{L} + \\tfrac{1}{2}(u_{L} - \\sigma)^{2}$，其中 $h = e + p/\\rho$。\n\n从能量跳跃可以得到左右热力学状态之间的经典热力学 Hugoniot 关系：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}(p_{R} + p_{L})(v_{R} - v_{L}) = 0,\n$$\n其中 $v = 1/\\rho$ 是比容。对于一个给定的左状态 $(\\rho_{L}, u_{L}, p_{L})$，其内能 $e_{L}$ 由状态方程确定，以及一个选定的右密度 $\\rho_{R}$，Hugoniot 关系与 van der Waals 状态方程共同构成一个关于 $e_{R}$ 的线性方程。记 $v_{L} = 1/\\rho_{L}$，$v_{R} = 1/\\rho_{R}$，以及 $A_{R} = (\\gamma - 1)\\rho_{R}/(1 - b\\rho_{R})$。则\n$$\ne_{R} = \\frac{ e_{L} - \\tfrac{1}{2}\\,(p_{L} - a\\rho_{R}^{2})\\,(v_{R} - v_{L}) }{ 1 + \\tfrac{1}{2}\\,A_{R}\\,(v_{R} - v_{L}) },\n$$\n$$\np_{R} = A_{R}\\,e_{R} - a\\rho_{R}^{2}.\n$$\n沿 Hugoniot 曲线的质量通量大小由动量-质量跳跃组合确定：\n$$\nm^{2} = \\frac{p_{R} - p_{L}}{v_{L} - v_{R}},\n$$\n激波速度为\n$$\n\\sigma = u_{L} - \\frac{m}{\\rho_{L}} = u_{R} - \\frac{m}{\\rho_{R}}.\n$$\n对于 $p_{R} > p_{L}$ 和 $\\rho_{R} > \\rho_{L}$ 的压缩激波，假设主分支 $m \\ge 0$。\n\nLiu 熵条件要求从左状态到右状态的容许激波位于 Hugoniot 曲线上当远离左状态时激波速度非增的部分。设 $\\xi \\in [0,1]$ 参数化从左状态开始的 Hugoniot 曲线，其中 $\\rho(\\xi) = \\rho_{L} + \\xi(\\rho_{R} - \\rho_{L})$。通过上述构造定义相应的激波速度 $\\sigma(\\xi)$。Liu 条件要求 $\\sigma(\\xi)$ 在 $\\xi$ 上是非增的。为了在数值界面通量中强制执行此条件，定义一个惩罚序列 $\\sigma_{\\text{pen}}(\\xi)$ 作为 $\\sigma(\\xi)$ 的移动最小值：\n$$\n\\sigma_{\\text{pen}}(\\xi_{k}) = \\min_{0 \\le j \\le k}\\, \\sigma(\\xi_{j}),\n$$\n对于一个离散集合 $\\{\\xi_{k}\\}_{k=0}^{N}$，其中 $\\xi_{0} = 0$ 且 $\\xi_{N} = 1$。\n\n对于左状态 $U_{L}$ 和与 Hugoniot 一致的右状态 $U_{R}$，定义两点数值通量为\n$$\nF^{\\text{pen}}(U_{L},U_{R}) = \\tfrac{1}{2}\\big(F(U_{L}) + F(U_{R})\\big) - \\tfrac{1}{2}\\, \\alpha\\, (U_{R} - U_{L}),\n$$\n其中 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$ 是惩罚后的特征速度尺度。这是一个对称耗散模型，其中特征耗散由惩罚后的激波速度设定，以遵循 Liu 条件。如果在任何样本点，$\\sigma(\\xi)$ 的构造不容许（例如 $m^{2} \\le 0$），则将无效样本视为非激波状态，并基于遇到的最后一个容许的 $\\sigma(\\xi)$ 来确定耗散；如果不存在容许的样本，则设置 $\\alpha = 0$。\n\n您的程序必须实现以下功能：\n\n1) 给定参数 $(\\gamma,a,b)$、一个左状态 $(\\rho_{L},u_{L},p_{L})$ 和一个目标右密度 $\\rho_{R}$（其中 $\\rho_{R} > \\rho_{L}$ 且 $\\rho_{L},\\rho_{R}  1/b$），通过在 $\\xi \\in (0,1]$ 中采样 $N$ 个等距点来构建离散的 Hugoniot 路径，其中 $\\rho(\\xi)$ 从 $\\rho_{L}$ 到 $\\rho_{R}$ 线性插值。在每个样本点，根据上述关系计算 $(e_{R},p_{R})$、质量通量大小 $m$ 和激波速度 $\\sigma(\\xi)$。忽略违反容许性（$m^{2} \\le 0$）的样本。使用 $N = 100$。\n\n2) 从容许的 $\\sigma(\\xi)$ 序列中，形成惩罚后的移动最小值序列 $\\sigma_{\\text{pen}}(\\xi)$。\n\n3) 在 $\\xi = 1$ 处使用 Hugoniot 关系构建右状态 $(\\rho_{R},u_{R},E_{R})$，然后以 $\\alpha = |\\sigma_{\\text{pen}}(1)|$ 形成惩罚数值通量 $F^{\\text{pen}}(U_{L},U_{R})$。\n\n4) 对于每个测试用例，报告：\n   - 一个布尔值，指示原始序列 $\\sigma(\\xi)$ 在容差 $\\tau = 10^{-8}$ 内是否为非增的（即，所有向前差分都 $\\le \\tau$）。\n   - 一个布尔值，指示惩罚序列 $\\sigma_{\\text{pen}}(\\xi)$ 在相同容差内是否为非增的。\n   - 惩罚数值通量的质量分量，即 $F^{\\text{pen}}(U_{L},U_{R})$ 的第一个分量，四舍五入到 $6$ 位小数。\n\n使用以下测试套件来检验不同区域，包括经典和非经典行为：\n\n- 用例 A（类经典激波）：$(\\gamma,a,b) = (1.4, 0.5, 0.1)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (0.8, 0.0, 1.0)$，右密度 $\\rho_{R} = 1.3$。\n- 用例 B（非凸区域候选）：$(\\gamma,a,b) = (1.35, 1.0, 0.25)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (1.0, 0.0, 0.2)$，右密度 $\\rho_{R} = 2.4$。\n- 用例 C（靠近协体积极限的边界情况）：$(\\gamma,a,b) = (1.4, 0.8, 0.22)$，左状态 $(\\rho_{L},u_{L},p_{L}) = (1.5, 0.05, 0.5)$，右密度 $\\rho_{R} = 2.9$。\n\n您的程序应生成单行输出，其中包含三个测试用例的结果，形式为方括号内的逗号分隔列表，每个测试用例的结果本身是按上述顺序排列的列表。例如，打印的输出必须具有以下形式\n```\n[ [\\text{bool}_{A}, \\text{bool}_{A}^{\\text{pen}}, \\text{flux}_{A}], [\\text{bool}_{B}, \\text{bool}_{B}^{\\text{pen}}, \\text{flux}_{B}], [\\text{bool}_{C}, \\text{bool}_{C}^{\\text{pen}}, \\text{flux}_{C}] ]\n```\n其中布尔值为该语言的字面布尔值，通量项为四舍五入到小数点后 $6$ 位的十进制数。", "solution": "目标是在为具有 van der Waals 类型状态方程的一维欧拉方程构建两点数值通量时，沿 Hugoniot 曲线强制执行 Liu 熵条件。该构造基于守恒律和经典的 Rankine–Hugoniot 关系，我们现在使用这些关系来推导所需的公式和算法。\n\n从一维空间中的守恒欧拉方程开始，其状态向量为 $U = [\\rho,\\rho u,\\rho E]^{\\top}$，通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$。热力学通过指定的 van der Waals 类型状态方程闭合\n$$\np(\\rho,e) = \\frac{(\\gamma - 1)\\,\\rho\\, e}{1 - b \\rho} - a \\rho^{2},\n$$\n其容许域为 $\\rho  1/b$。对于给定的 $(\\rho,p)$，我们可以反解求得 $e$：\n$$\ne = \\frac{(p + a \\rho^{2})(1 - b \\rho)}{(\\gamma - 1)\\rho}。\n$$\n\n跨越一个以速度 $\\sigma$ 传播的间断，Rankine–Hugoniot 关系表达了守恒律的积分形式：\n$$\n\\rho_{R}(u_{R} - \\sigma) = \\rho_{L}(u_{L} - \\sigma) = m,\n$$\n$$\np_{R} + \\rho_{R}(u_{R} - \\sigma)^{2} = p_{L} + \\rho_{L}(u_{L} - \\sigma)^{2},\n$$\n$$\nh_{R} + \\tfrac{1}{2}(u_{R} - \\sigma)^{2} = h_{L} + \\tfrac{1}{2}(u_{L} - \\sigma)^{2},\n$$\n其中 $h = e + p/\\rho$ 是比焓。第三个方程可以重排为与激波速度无关的经典热力学 Hugoniot 关系：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}(p_{R} + p_{L})(v_{R} - v_{L}) = 0,\\quad v = \\frac{1}{\\rho}。\n$$\n给定一个左状态 $(\\rho_{L},u_{L},p_{L})$，其内能 $e_{L}$ 由状态方程给出，我们通过选择一个候选的右密度 $\\rho_{R}$ 来参数化 Hugoniot 曲线，并寻求与 van der Waals 模型和 Hugoniot 关系一致的相应 $(e_{R},p_{R})$。定义\n$v_{L} = \\frac{1}{\\rho_{L}}$，$v_{R} = \\frac{1}{\\rho_{R}}$，$A_{R} = \\frac{(\\gamma - 1)\\rho_{R}}{1 - b \\rho_{R}}$。\n则 $p_{R} = A_{R} e_{R} - a \\rho_{R}^{2}$。将其代入 Hugoniot 关系，得到一个关于 $e_{R}$ 的线性方程：\n$$\ne_{R} - e_{L} + \\tfrac{1}{2}\\big(A_{R} e_{R} - a \\rho_{R}^{2} + p_{L}\\big)(v_{R} - v_{L}) = 0,\n$$\n可以显式求解出 $e_{R}$：\n$$\ne_{R} = \\frac{ e_{L} - \\tfrac{1}{2}(p_{L} - a \\rho_{R}^{2})(v_{R} - v_{L}) }{ 1 + \\tfrac{1}{2} A_{R}(v_{R} - v_{L}) }。\n$$\n一旦获得 $e_{R}$，$p_{R}$ 就直接由状态方程得出。动量和质量跳跃关系可以结合起来，得到质量通量平方的公式：\n$$\nm^{2} = \\frac{p_{R} - p_{L}}{v_{L} - v_{R}}。\n$$\n对于 $\\rho_{R} > \\rho_{L}$ 且通常 $p_{R} > p_{L}$ 的压缩激波，我们有 $v_{R}  v_{L}$，因此 $m^{2} > 0$。选择 $m \\ge 0$ 的主分支，定义激波速度为\n$$\n\\sigma = u_{L} - \\frac{m}{\\rho_{L}}。\n$$\n右侧速度则由质量和动量跳跃关系得出\n$$\nu_{R} = u_{L} + \\frac{p_{L} - p_{R}}{m},\n$$\n右侧总能为 $E_{R} = e_{R} + \\tfrac{1}{2} u_{R}^{2}$。\n\nLiu 熵条件指出，沿着由 $\\xi \\in [0,1]$ 参数化的 Hugoniot 路径，其中 $\\rho(\\xi) = \\rho_{L} + \\xi(\\rho_{R} - \\rho_{L})$，容许激波必须位于激波速度 $\\sigma(\\xi)$ 对 $\\xi$ 非增的部分。在数值上，我们将 $\\xi$ 离散化为 $N$ 个均匀样本 $\\{\\xi_{k}\\}_{k=1}^{N}$，并在容许的情况下（即 $m^{2}(\\xi_{k}) > 0$）计算 $\\sigma(\\xi_{k})$。为了强制执行 Liu 条件，我们定义一个惩罚序列 $\\sigma_{\\text{pen}}(\\xi_{k})$ 作为移动最小值：\n$$\n\\sigma_{\\text{pen}}(\\xi_{k}) = \\min\\{\\sigma(\\xi_{1}), \\sigma(\\xi_{2}), \\ldots, \\sigma(\\xi_{k})\\}。\n$$\n这种构造通过定义确保了 $\\sigma_{\\text{pen}}(\\xi_{k})$ 是非增的。\n\n然后，我们使用界面处的惩罚激波速度 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$ 作为对称两点数值通量中的特征耗散尺度：\n$$\nF^{\\text{pen}}(U_{L},U_{R}) = \\tfrac{1}{2}\\big(F(U_{L}) + F(U_{R})\\big) - \\tfrac{1}{2}\\,\\alpha\\,(U_{R} - U_{L})。\n$$\n这类似于一个 Rusanov（局部 Lax–Friedrichs）通量，但耗散尺度与 Liu 容许的激波速度相关联，而不是最大特征波速；因此，它通过裁剪到移动最小值来惩罚 $\\sigma(\\xi)$ 的任何增加，从而遵循 Liu 条件。如果在采样过程中没有找到容许的激波（即所有的 $m^{2} \\le 0$），我们设置 $\\alpha = 0$，此时通量退化为该界面的中心通量。\n\n每个测试用例的算法步骤如下：\n\n1) 从 $(\\rho_{L},p_{L})$ 计算 $e_{L}$，使用 $e_{L} = \\big(p_{L} + a \\rho_{L}^{2}\\big)\\big(1 - b \\rho_{L}\\big)\\big/\\big((\\gamma - 1)\\rho_{L}\\big)$，以及 $E_{L} = e_{L} + \\tfrac{1}{2}u_{L}^{2}$。构建 $U_{L} = [\\rho_{L}, \\rho_{L} u_{L}, \\rho_{L} E_{L}]^{\\top}$。\n\n2) 对 $k = 1,\\ldots,N$（$N = 100$）采样 $\\xi_{k} = k/N$，并设置 $\\rho(\\xi_{k}) = \\rho_{L} + \\xi_{k}(\\rho_{R} - \\rho_{L})$。对于每个样本：\n   - 计算 $v_{L}, v(\\xi_{k}), A(\\xi_{k})$。\n   - 从线性 Hugoniot 关系计算 $e(\\xi_{k})$，并从状态方程计算 $p(\\xi_{k})$。\n   - 计算 $m^{2}(\\xi_{k}) = \\big(p(\\xi_{k}) - p_{L}\\big)\\big/\\big(v_{L} - v(\\xi_{k})\\big)$。如果 $m^{2}(\\xi_{k}) \\le 0$，则将该样本标记为无效，并从激波速度序列中排除。\n   - 否则，设置 $m(\\xi_{k}) = \\sqrt{m^{2}(\\xi_{k})}$ 和 $\\sigma(\\xi_{k}) = u_{L} - m(\\xi_{k})/\\rho_{L}$。\n\n3) 在有效的激波速度 $\\{\\sigma(\\xi_{k})\\}$ 上，形成移动最小值序列 $\\{\\sigma_{\\text{pen}}(\\xi_{k})\\}$。如果所有向前差分都 $\\le \\tau$（容差 $\\tau = 10^{-8}$），则定义原始序列为非增的。根据构造，惩罚序列是非增的。\n\n4) 在 $\\xi_{N} = 1$ 处，按如下方式构建右状态：计算 $e_{R}, p_{R}, m$，然后 $u_{R} = u_{L} + (p_{L} - p_{R})/m$ 和 $E_{R} = e_{R} + \\tfrac{1}{2}u_{R}^{2}$。构建 $U_{R} = [\\rho_{R}, \\rho_{R} u_{R}, \\rho_{R} E_{R}]^{\\top}$。\n\n5) 如果最终样本是容许的，则计算 $\\alpha = |\\sigma_{\\text{pen}}(\\xi_{N})|$；否则取最后一个容许样本的 $\\sigma_{\\text{pen}}$；如果没有容许的样本，则设置 $\\alpha = 0$。\n\n6) 计算 $F^{\\text{pen}}(U_{L},U_{R})$ 并报告其第一个分量（四舍五入到 6 位小数），以及检查原始序列和惩罚序列非增行为的两个布尔值。\n\n该测试套件包含三个用例，旨在探究不同区域：一个类经典压缩激波，其中气体响应接近凸性；一个非凸区域候选，具有较大的吸引和协体积参数，可能出现非经典行为；以及一个靠近协体积极限的边界情况，以测试容许性和鲁棒性。对于每个用例，我们提供 $(\\gamma,a,b)$、$(\\rho_{L},u_{L},p_{L})$ 和 $\\rho_{R}$，所有量均为无量纲，并要求程序输出包含三个三元组 $[ \\text{raw\\_nonincreasing}, \\text{penalized\\_nonincreasing}, \\text{mass\\_flux} ]$ 的单行列表，格式如指定。", "answer": "[[True,True,0.592506],[False,True,0.372506],[False,True,0.671391]]", "id": "3356172"}]}