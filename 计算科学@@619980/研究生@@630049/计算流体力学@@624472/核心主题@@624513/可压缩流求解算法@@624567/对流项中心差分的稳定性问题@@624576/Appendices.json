{"hands_on_practices": [{"introduction": "我们首先通过一个看似合理的数值方案来入手：将空间上的二阶中心差分与时间上的二阶龙格-库塔法相结合来求解对流方程。通过严格的冯·诺依曼稳定性分析，本练习将揭示一个令人惊讶但至关重要的结论：对于纯对流问题，这些标准方法的组合实际上是无条件不稳定的[@problem_id:3365179]。这个例子为我们理解为何中心差分在处理对流项时需要特别考虑奠定了基础。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，方程定义在间距为 $\\Delta x$ 的均匀网格上，并服从周期性边界条件。令 $u_{j}(t)$ 表示网格索引 $j \\in \\mathbb{Z}$ 处的半离散近似解，该解是通过用二阶中心差分算子对空间导数进行离散得到的。在傅里叶模态分析下，设 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,\\theta\\,j)$，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数，则半离散算子的特征值为 $\\lambda(\\theta) = \\frac{-i\\,a\\,\\sin(\\theta)}{\\Delta x}$。\n\n时间积分通过将一个两步二阶显式 Runge–Kutta (RK) 方法应用于半离散系统 $d\\hat{u}/dt = \\lambda(\\theta)\\,\\hat{u}$ 来执行。对于一个通用的两步二阶显式 Runge–Kutta 方法，其在线性测试方程 $y' = \\lambda\\,y$ 上的单步更新可以写成 $y^{n+1} = R(z)\\,y^{n}$ 的形式，其中 $z = \\lambda\\,\\Delta t$，$R(z)$ 是该方法的稳定性函数，仅由阶条件确定。\n\n从控制方程和空间半离散化出发，使用 Courant–Friedrichs–Lewy (CFL) 数的定义 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$，从二阶 Runge–Kutta 阶条件推导出稳定性函数 $R(z)$，并分析其与虚轴 $z = i\\,y$（其中 $y \\in \\mathbb{R}$）的交集。施加 von Neumann 稳定性要求 $|R(\\lambda(\\theta)\\,\\Delta t)| \\le 1$ 对所有 $\\theta \\in [-\\pi,\\pi]$ 成立，并确定使该不等式成立的无量纲 CFL 数 $\\nu$ 的最大允许值。\n\n将最终答案表示为单个实数，不带单位。无需四舍五入。", "solution": "问题要求计算一维线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的最大允许 Courant–Friedrichs–Lewy (CFL) 数 $\\nu$。该方程在空间上使用二阶中心差分格式进行离散，在时间上使用通用的两步二阶显式 Runge–Kutta (RK) 方法进行积分。\n\n这种全离散格式的稳定性是通过将时间积分方法应用于半离散系统来确定的。在傅里叶分析下，该系统由 $\\frac{d\\hat{u}}{dt} = \\lambda(\\theta)\\,\\hat{u}$ 给出。这里，$\\hat{u}$ 是傅里叶模态的振幅，$\\lambda(\\theta)$ 是空间离散算子的特征值。题目给出这些特征值为 $\\lambda(\\theta) = -\\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x}$。\n\n应用于线性测试方程 $y' = \\lambda y$ 的显式时间步进方法的稳定性由其稳定性函数 $R(z)$ 控制，其中 $z = \\lambda \\Delta t$。如果放大因子 $g = R(z)$ 满足 $|g| \\le 1$，则格式是稳定的。对于我们的系统，这个 von Neumann 稳定性要求转化为对所有无量纲波数 $\\theta \\in [-\\pi, \\pi]$，都有 $|R(\\lambda(\\theta)\\,\\Delta t)| \\le 1$。\n\n我们的第一步是推导任何两步二阶显式 RK 方法的稳定性函数 $R(z)$。对于常微分方程 $y' = f(y)$，一个通用的两步显式 RK 方法由以下公式给出：\n$$k_1 = f(y^n)$$\n$$k_2 = f(y^n + \\alpha_{21} \\Delta t k_1)$$\n$$y^{n+1} = y^n + \\Delta t (b_1 k_1 + b_2 k_2)$$\n其中 $\\alpha_{21}$、$b_1$ 和 $b_2$ 是该方法的系数。对于线性测试方程 $y'=\\lambda y$，我们有 $f(y) = \\lambda y$。各个阶段变为：\n$$k_1 = \\lambda y^n$$\n$$k_2 = \\lambda(y^n + \\alpha_{21} \\Delta t (\\lambda y^n)) = \\lambda y^n(1 + \\alpha_{21} \\lambda \\Delta t)$$\n单步更新为：\n$$y^{n+1} = y^n + \\Delta t (b_1 (\\lambda y^n) + b_2 (\\lambda y^n(1 + \\alpha_{21} \\lambda \\Delta t)))$$\n$$y^{n+1} = y^n \\left(1 + (b_1+b_2)\\lambda \\Delta t + b_2 \\alpha_{21} (\\lambda \\Delta t)^2\\right)$$\n稳定性函数 $R(z)$ 是放大因子，其中 $z = \\lambda \\Delta t$：\n$$R(z) = 1 + (b_1+b_2)z + b_2 \\alpha_{21} z^2$$\n为使 RK 方法达到二阶精度，其系数必须满足阶条件。二阶的条件是：\n$$ b_1 + b_2 = 1 $$\n$$ b_2 \\alpha_{21} = \\frac{1}{2} $$\n将这些条件代入 $R(z)$ 的表达式中，就唯一地确定了任何两步二阶显式 RK 方法的稳定性函数：\n$$R(z) = 1 + z + \\frac{1}{2} z^2$$\n\n接下来，我们必须找到该方法在虚轴上的稳定区域。空间算子的特征值 $\\lambda(\\theta)$ 是纯虚数。因此，它们与 $\\Delta t$ 的乘积，即稳定性函数 $R(z)$ 的自变量 $z$，也是纯虚数。设 $z = iy$，其中 $y$ 为实数。我们分析稳定性条件 $|R(iy)| \\le 1$。\n$$R(iy) = 1 + (iy) + \\frac{1}{2}(iy)^2 = 1 + iy - \\frac{1}{2}y^2 = \\left(1 - \\frac{1}{2}y^2\\right) + i(y)$$\n放大因子的模的平方为：\n$$|R(iy)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + y^2 = 1 - y^2 + \\frac{1}{4}y^4 + y^2 = 1 + \\frac{1}{4}y^4$$\nvon Neumann 稳定性条件 $|R(iy)| \\le 1$ 等价于 $|R(iy)|^2 \\le 1$。\n$$1 + \\frac{1}{4}y^4 \\le 1$$\n这个不等式简化为：\n$$\\frac{1}{4}y^4 \\le 0$$\n由于 $y$ 是实数，$y^4$ 总是非负的。因此，这个不等式成立的唯一可能是 $y^4 = 0$，这意味着 $y=0$。这个关键结果表明，任何二阶显式 RK 方法的稳定域仅在原点 $z=0$ 处与虚轴相交。\n\n最后，我们将此发现应用于具体问题。对于我们的离散系统，稳定性函数的自变量是：\n$$z(\\theta) = \\lambda(\\theta) \\Delta t = \\left(-\\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x}\\right) \\Delta t = -i \\left(\\frac{a\\,\\Delta t}{\\Delta x}\\right) \\sin(\\theta)$$\n使用 CFL 数的定义 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$，我们有：\n$$z(\\theta) = -i\\,\\nu\\,\\sin(\\theta)$$\n稳定性条件 $|R(z(\\theta))| \\le 1$ 必须对所有 $\\theta \\in [-\\pi, \\pi]$ 成立。\n当 $\\theta$ 在其定义域内变化时，$\\sin(\\theta)$ 覆盖区间 $[-1, 1]$。因此，$z(\\theta)$ 的所有取值集合是虚轴上从 $-i\\nu$ 到 $i\\nu$ 的线段。\n$$ \\{z(\\theta) \\mid \\theta \\in [-\\pi, \\pi]\\} = [-i\\nu, i\\nu] $$\n为使格式稳定，这整个区间必须位于时间步进方法的稳定域内。我们已经确定，沿虚轴的稳定域是单个点 $\\{0\\}$。因此，我们必须满足条件：\n$$[-i\\nu, i\\nu] \\subseteq \\{0\\}$$\n这种包含关系只有在区间本身就是点 $\\{0\\}$ 时才可能成立，这要求其长度为零。这意味着 $\\nu$ 必须等于 $0$。\n\n任何非零的 CFL 数 $\\nu > 0$ 都会产生非零的特征值（例如，对于 $\\theta = \\frac{\\pi}{2}$，$z = -i\\nu$），此时 $|R(-i\\nu)|^2 = 1 + \\frac{1}{4}\\nu^4 > 1$，表明不稳定。因此，对于任何正的平流速度和时间步长，该格式都是无条件不稳定的。\n\n使稳定性不等式成立的 CFL 数 $\\nu$ 的最大允许值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3365179"}, {"introduction": "鉴于像龙格-库塔法这样的标准显式方法可能会失效，我们现在转向一种替代方案：蛙跳（leapfrog）时间格式。本练习将展示，通过使用一种多层时间格式，中心差分在求解对流问题时可以实现条件稳定[@problem_id:3365230]。然而，这种稳定性也带来了新的挑战，即非物理“计算模式”的出现，这突显了数值格式设计中固有的权衡。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a$ 为恒定平流速度，定义在周期性区域上。该方程在一个均匀空间网格 $x_{j} = j\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$ 上进行离散，其中 $j$ 和 $n$ 为整数，且 $\\Delta x, \\Delta t > 0$。使用 $[t^{n-1}, t^{n+1}]$ 上的中心差分来近似 $t^{n}$ 处的时间导数，使用 $x$ 上的中心差分来近似 $t^{n}$ 处的空间导数，并定义库朗数 $r = \\frac{a\\,\\Delta t}{\\Delta x}$。使用 von Neumann 傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,\\theta\\,j)$（其中无量纲波数角 $\\theta$ 以弧度为单位），推导与蛙跳时间步进结合中心空间差分相关的放大因子 $G(\\theta,r)$。然后，要求在 $|G(\\theta,r)| \\leq 1$ 对所有 $\\theta \\in [-\\pi,\\pi]$ 成立的意义下具有一致稳定性，并确定满足此界限的 $r$ 的最大允许值（最大库朗数）。最后，检查为 $G(\\theta,r)$ 求得的根，并根据它们的代数关系推断是否存在计算（寄生）模式，并解释其出现的机理。最终输出 $G(\\theta,r)$ 的闭式表达式以及等于最大允许库朗数的单个实数。无需四舍五入，也无需报告物理单位；角度必须以弧度为单位进行解释。", "solution": "一维线性平流方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是输运量，$a$ 是恒定的平流速度。\n\n问题指定了在均匀网格上的离散化，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$，其中 $u_j^n$ 近似 $u(x_j, t^n)$。时间导数 $\\frac{\\partial u}{\\partial t}$ 在时间层 $n$ 处由中心差分（蛙跳格式）近似：\n$$\n\\left(\\frac{\\partial u}{\\partial t}\\right)_j^n \\approx \\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t}\n$$\n空间导数 $\\frac{\\partial u}{\\partial x}$ 在网格点 $j$ 处由中心差分近似：\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\n$$\n将这些近似代入平流方程，得到有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^{n-1}}{2\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\n为了进行 von Neumann 稳定性分析，我们将单个傅里叶模式 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ 代入有限差分方程。这里，$\\theta = k\\Delta x$ 是无量纲波数，其中 $k$ 是波数。\n$$\n\\frac{\\hat{u}^{n+1}\\exp(i\\theta j) - \\hat{u}^{n-1}\\exp(i\\theta j)}{2\\Delta t} + a \\frac{\\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1))}{2\\Delta x} = 0\n$$\n我们可以将整个方程除以公因子 $\\exp(i\\theta j)$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2\\Delta x} = 0\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，方程变为：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n-1}}{2\\Delta t} + a \\hat{u}^{n} \\frac{2i\\sin(\\theta)}{2\\Delta x} = 0\n$$\n乘以 $2\\Delta t$ 并重新整理，得到振幅 $\\hat{u}^n$ 的递推关系：\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n-1} = -2i \\left(\\frac{a\\Delta t}{\\Delta x}\\right) \\sin(\\theta) \\hat{u}^n\n$$\n引入库朗数 $r = \\frac{a\\Delta t}{\\Delta x}$，我们有：\n$$\n\\hat{u}^{n+1} + \\left(2ir\\sin(\\theta)\\right)\\hat{u}^n - \\hat{u}^{n-1} = 0\n$$\n放大因子 $G$ 定义为 $\\hat{u}^{n+1} = G \\hat{u}^n$。由于这是一种两步法，该递推关系关联了三个时间层。因此，我们假设解的形式为 $\\hat{u}^n = (\\hat{u}^0)G^n$。将其代入递推关系得到：\n$$\n(\\hat{u}^0)G^{n+1} + \\left(2ir\\sin(\\theta)\\right)(\\hat{u}^0)G^n - (\\hat{u}^0)G^{n-1} = 0\n$$\n除以 $(\\hat{u}^0)G^{n-1}$（假设 $G \\neq 0$ 且 $\\hat{u}^0 \\neq 0$），我们得到放大因子 $G$ 的特征方程：\n$$\nG^2 + (2ir\\sin(\\theta))G - 1 = 0\n$$\n这是一个关于 $G$ 的二次方程。我们使用二次方程求根公式求解其根：\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{(2ir\\sin(\\theta))^2 - 4(1)(-1)}}{2}\n$$\n$$\nG(\\theta,r) = \\frac{-2ir\\sin(\\theta) \\pm \\sqrt{-4r^2\\sin^2(\\theta) + 4}}{2}\n$$\n$$\nG(\\theta,r) = -ir\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)}\n$$\n这给出了与该格式相关的两个放大因子的表达式。\n\n为使格式稳定，放大因子的模必须对所有实数 $\\theta$ 满足 $|G(\\theta,r)| \\leq 1$。我们分析平方根下的项 $1 - r^2\\sin^2(\\theta)$。\n\n情况1：$1 - r^2\\sin^2(\\theta) \\geq 0$。\n在这种情况下，平方根是实数。令 $A = r\\sin(\\theta)$ 和 $B = \\sqrt{1 - r^2\\sin^2(\\theta)}$。那么 $G = -iA \\pm B$。$G$ 的模为：\n$$\n|G| = \\sqrt{(\\pm B)^2 + (-A)^2} = \\sqrt{B^2 + A^2} = \\sqrt{(1 - r^2\\sin^2(\\theta)) + (r^2\\sin^2(\\theta))} = \\sqrt{1} = 1\n$$\n所以，如果 $1 - r^2\\sin^2(\\theta) \\geq 0$，该格式是中性稳定的，满足稳定性要求 $|G| \\leq 1$。为使此条件对所有 $\\theta \\in [-\\pi, \\pi]$ 成立，我们必须检查最坏情况，即 $|\\sin(\\theta)|$ 取最大值时。$\\sin^2(\\theta)$ 的最大值为 $1$。因此，我们必须有：\n$$\n1 - r^2(1) \\geq 0 \\implies r^2 \\leq 1 \\implies |r| \\leq 1\n$$\n这是该格式的 Courant-Friedrichs-Lewy (CFL) 条件。库朗数 $r$ 的最大允许值为 $1$。\n\n情况2：$1 - r^2\\sin^2(\\theta) < 0$。\n如果 $|r| > 1$，对于一定范围的 $\\theta$ 值，这种情况会发生。此时，平方根下的项为负数。我们可以写成 $\\sqrt{1 - r^2\\sin^2(\\theta)} = i\\sqrt{r^2\\sin^2(\\theta) - 1}$。放大因子为：\n$$\nG = -ir\\sin(\\theta) \\pm i\\sqrt{r^2\\sin^2(\\theta) - 1} = i\\left(-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}\\right)\n$$\n$G$ 的模是 $|-r\\sin(\\theta) \\pm \\sqrt{r^2\\sin^2(\\theta) - 1}|$。让我们考虑括号中带正号的根（这个选择会导致放大）。其模为 $|-r\\sin(\\theta) + \\sqrt{r^2\\sin^2(\\theta) - 1}|$。如果我们假设 $r>0$，我们可以选择 $\\theta$ 使得 $\\sin(\\theta)<0$，从而使模大于1。例如，如果 $r>1$，我们取 $\\theta = -\\pi/2$，则 $\\sin(\\theta)=-1$。那么 $G=i(r \\pm \\sqrt{r^2 - 1})$。模为 $|r \\pm \\sqrt{r^2 - 1}|$。对于正号，模为 $r + \\sqrt{r^2-1}$。因为 $r > 1$，我们有 $r^2 - 1 > 0$，所以 $r + \\sqrt{r^2 - 1} > r > 1$。因此，其中一个根的模大于 $1$，导致指数增长和不稳定性。\n\n因此，该格式对所有波数都稳定的条件要求 $|r| \\leq 1$。$r$ 的最大允许值为 $1$。\n\n最后，我们分析这些根以理解计算模式。特征方程 $G^2 + (2ir\\sin(\\theta))G - 1 = 0$ 产生两个不同的 $G$ 的根，我们称之为 $G_1$ 和 $G_2$。原始的偏微分方程是时间上一阶的，所以其演化应只依赖于一个“模式”。而数值格式是三层（两步）法，在时间索引 $n$ 上是二阶的，这内在地引入了第二个非物理的解。这个伪解就是计算（或寄生）模式。这两个根之间的代数关系可以通过对特征多项式使用韦达定理找到：根的乘积 $G_1 G_2$ 等于常数项，即 $-1$。\n$$\nG_1 G_2 = -1\n$$\n在稳定区域（$|r| \\leq 1$），我们证明了两个根的模都为 $|G_1| = |G_2| = 1$。其中一个根 $G_1$ 近似了物理波的传播。对于小的 $r\\theta$，$G_1 \\approx 1 - ir\\theta - \\frac{1}{2}(r\\theta)^2 \\approx \\exp(-ir\\theta)$，这对应于精确解的放大因子。另一个根是 $G_2 = -1/G_1 \\approx -\\exp(ir\\theta)$。对于小波数（$\\theta \\to 0$），$G_1 \\to 1$ 且 $G_2 \\to -1$。这意味着计算模式表现为时间上的高频振荡，在每个时间步（$(-1)^n$）符号都会翻转，这会污染数值解。这第二个根的存在是用二阶中心差分来近似一阶时间导数的直接后果。\n\n最终答案要求给出 $G(\\theta,r)$ 的表达式和最大允许库朗数。", "answer": "$$\n\\boxed{\n\\begin{gathered}\n-ir\\,\\sin(\\theta) \\pm \\sqrt{1 - r^2\\sin^2(\\theta)} \\\\\n1\n\\end{gathered}\n}\n$$", "id": "3365230"}, {"introduction": "最后，我们将从理论分析转向实际编程，在本练习中直观地观察中心差分不稳定性的后果。通过编写程序求解一个稳态对流-扩散问题，你将亲眼看到当对流远大于扩散（即网格佩克莱特数过高）时，解中出现的非物理振荡[@problem_id:3365178]。这项实践将抽象的数值不稳定性概念变得具体化，并展示了它对解的质量的实际影响。", "problem": "考虑在域 $[0,1]$ 上的一个一维、稳态、线性对流-扩散边界值问题，其对象为一个无源标量场 $\\phi(x)$，具有恒定的材料属性和恒定的速度。其连续控制方程是写成守恒形式的扩散通量和对流通量平衡方程，\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0,\n$$\n其中 $\\Gamma>0$ 是扩散系数，$\\rho>0$ 是密度，而 $u$ 是一个可正可负的恒定速度。施加狄利克雷（Dirichlet）边界条件 $\\phi(0)=\\phi_L$ 和 $\\phi(1)=\\phi_R$。所有量均被视为无量纲。您必须完全在无量纲单位下进行计算。\n\n您的任务是使用单元中心有限体积法，在由 $N$ 个等大控制体积组成的均匀网格上（单元交界面位于 $x_i = i \\Delta x$，其中 $\\Delta x = 1/N$ 且 $i=0,1,\\ldots,N$），并对对流通量采用中心差分格式，来构建一个数值算例，以说明众所周知的稳定性问题：当网格佩克莱特数（Peclet number）的量级大于 2，即 $|Pe| > 2$ 时，即使所得的线性系统仍然可解，中心差分格式也会产生非单调的内部振荡。\n\n从每个控制体积的守恒出发，使用以下方法离散化方程：\n- 对交界面上的扩散通量采用二阶中心差分。\n- 对交界面上的对流质量通量采用二阶中心差分。\n\n推导所得的、针对内部单元中心值 $\\phi_1,\\ldots,\\phi_{N-1}$ 的三对角线性系统，用扩散导率 $D=\\Gamma/\\Delta x$、质量通量 $F=\\rho u$ 和网格佩克莱特数 $Pe = F \\Delta x/\\Gamma$ 表示。不要引入任何人工耗散或迎风格式；两种通量均使用纯中心差分。组装线性系统，并将狄利克雷边界条件并入右侧项。\n\n按如下方式定义非单调内部振荡的量化检测器。给定计算出的包含边界的离散解 $\\{\\phi_i\\}_{i=0}^N$，如果以下条件中至少有一条成立，则判断存在内部振荡：\n- 存在索引 $j \\in \\{1,\\ldots,N-1\\}$，使得 $\\phi_j$ 严格位于以 $\\phi_L$ 和 $\\phi_R$ 为端点的闭区间之外。\n- 存在索引 $j \\in \\{1,\\ldots,N-2\\}$，使得乘积 $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$，即一阶差分符号改变，表明存在离散的内部极值点。\n\n实现一个程序，该程序能够：\n- 对每个指定的测试用例，构建并求解上述均匀网格上的中心差分有限体积格式的线性系统。\n- 对每个用例，报告一个布尔值，指示是否根据上述准则检测到非单调内部振荡。\n\n使用以下五个测试用例，每个用例由元组 $(N, Pe, \\phi_L, \\phi_R)$ 指定：\n- 用例 $1$：$(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$。\n- 用例 $2$：$(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$。\n- 用例 $3$：$(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$。\n- 用例 $4$：$(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$。\n- 用例 $5$：$(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$。\n\n注：\n- 固定 $\\Gamma=1$ 和 $\\rho=1$ 以使所有量无量纲化。则 $D = 1/\\Delta x$ 且 $F = Pe/\\Delta x$。均匀网格间距为 $\\Delta x = 1/N$。\n- 您必须一致地使用 $Pe$ 的符号来确定质量通量 $F$ 的符号。\n- 最终的线性系统必须严格按照中心差分有限体积公式组装；不要对系数进行正则化、限制或修改。\n\n您的程序应生成单行输出，其中包含按上述五个测试用例顺序排列的结果，形式为用方括号括起来的逗号分隔列表。例如，输出形式应为 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_k$ 是一个布尔值，指示是否为用例 $k$ 检测到内部振荡。本问题不涉及角度或物理单位；所有量均为无量纲。唯一要求的输出是这一行指定格式的内容。", "solution": "任务是推导并求解一维稳态对流扩散方程的离散形式，并检查解是否存在非物理振荡。\n\n**1. 通过有限体积法进行离散化**\n守恒形式的控制方程为 $\\frac{\\mathrm{d}}{\\mathrm{d}x} J(x) = 0$，其中 $J(x)$ 是总通量，由 $J = -\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} + F\\phi$ 给出，其中 $F = \\rho u$。这意味着总通量在整个域内是恒定的。\n\n我们使用节点中心有限体积法。通过 $N+1$ 个位于 $x_i = i\\Delta x$（$i=0, 1, \\ldots, N$，其中 $\\Delta x = 1/N$）的节点，将域 $[0,1]$ 划分为 $N$ 个段。未知量是内部节点 $i=1, \\ldots, N-1$ 处的值 $\\phi_i$。边界值已给定：$\\phi_0 = \\phi_L$ 和 $\\phi_N = \\phi_R$。\n\n我们在围绕内部节点 $x_i$ 的控制体积 (CV) 上对控制方程进行积分。该 CV 从位于 $x_i - \\Delta x/2$ 的西 (w) 面延伸到位于 $x_i + \\Delta x/2$ 的东 (e) 面。\n$$ \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{\\mathrm{d}J}{\\mathrm{d}x} \\mathrm{d}x = 0 $$\n$$ J_e - J_w = 0 $$\n其中 $J_e$ 和 $J_w$ 分别是 CV 东面和西面的总通量。\n\n**2. 使用中心差分进行通量近似**\n交界面处的通量使用二阶中心差分进行扩散和对流的近似。\n\n在东面 $e$（节点 $i$ 和 $i+1$ 的中点）：扩散通量近似为：\n$$ \\left(-\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)_e \\approx -\\Gamma \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} = -D(\\phi_{i+1} - \\phi_i) $$\n其中 $D=\\Gamma/\\Delta x$。\n对流通量需要交界面上的 $\\phi$ 值，该值通过线性插值得到：\n$$ (F\\phi)_e \\approx F \\phi_e = F \\frac{\\phi_i + \\phi_{i+1}}{2} $$\n东面 $e$ 处的总通量为：\n$$ J_e \\approx F \\frac{\\phi_i + \\phi_{i+1}}{2} - D(\\phi_{i+1} - \\phi_i) = \\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} $$\n\n类似地，在西面 $w$（节点 $i-1$ 和 $i$ 的中点）：\n$$ J_w \\approx F \\frac{\\phi_{i-1} + \\phi_i}{2} - D(\\phi_i - \\phi_{i-1}) = \\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1} $$\n\n**3. 代数方程的推导**\n将通量近似值代入平衡方程 $J_e - J_w = 0$：\n$$ \\left[\\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1}\\right] - \\left[\\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1}\\right] = 0 $$\n收集关于 $\\phi_{i-1}$、$\\phi_i$ 和 $\\phi_{i+1}$ 的项：\n$$ -\\left(D + \\frac{F}{2}\\right)\\phi_{i-1} + \\left(2D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} = 0 $$\n为了用网格佩克莱特数 $Pe = F\\Delta x/\\Gamma = F/D$ 表示，我们将整个方程除以 $D$：\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{i-1} + 2\\phi_i - \\left(1 - \\frac{Pe}{2}\\right)\\phi_{i+1} = 0 $$\n这个代数方程将节点 $i$ 处的值与其直接相邻节点联系起来。\n\n**4. 线性系统的组装**\n该方程对所有内部节点 $i=1, \\ldots, N-1$ 成立。我们为未知向量 $\\vec{\\phi} = [\\phi_1, \\ldots, \\phi_{N-1}]^T$ 组装一个形式为 $A\\vec{\\phi} = \\vec{b}$ 的三对角线性系统。\n\n矩阵 $A$ 是一个 $(N-1) \\times (N-1)$ 的三对角矩阵，其系数如下：\n-   主对角线 ($d_i$)：$2$\n-   次对角线 ($a_i$)：$-\\left(1 + \\frac{Pe}{2}\\right)$\n-   超对角线 ($c_i$)：$-\\left(1 - \\frac{Pe}{2}\\right) = \\frac{Pe}{2} - 1$\n\n边界条件 $\\phi_0 = \\phi_L$ 和 $\\phi_N = \\phi_R$ 被并入右侧向量 $\\vec{b}$。\n对于第一个方程 ($i=1$)：\n$$ 2\\phi_1 - \\left(1 - \\frac{Pe}{2}\\right)\\phi_2 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_0 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_L $$\n因此，$b_1 = (1 + Pe/2)\\phi_L$。\n\n对于最后一个方程 ($i=N-1$)：\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{N-2} + 2\\phi_{N-1} = \\left(1 - \\frac{Pe}{2}\\right)\\phi_N = \\left(1 - \\frac{Pe}{2}\\right)\\phi_R $$\n因此，$b_{N-1} = (1 - Pe/2)\\phi_R$。\n\n对于所有其他方程 ($i=2, \\ldots, N-2$)，右侧项为零，$b_i = 0$。\n\n**5. 稳定性和振荡**\n中心差分格式只有在矩阵 $A$ 是对角占优时才是稳定的并产生单调解。这要求 $|d_i| \\geq |a_i| + |c_i|$，即：\n$$ |2| \\geq \\left|-\\left(1 + \\frac{Pe}{2}\\right)\\right| + \\left|-\\left(1 - \\frac{Pe}{2}\\right)\\right| $$\n$$ 2 \\geq \\left|1 + \\frac{Pe}{2}\\right| + \\left|1 - \\frac{Pe}{2}\\right| $$\n这个不等式仅在 $|Pe/2| \\leq 1$ 或 $|Pe| \\leq 2$ 时成立。当 $|Pe| > 2$ 时，对角占优性丧失，模板中相邻节点的系数可能变为负值，导致非物理的振荡解。本问题要求展示这种行为。\n\n**6. 计算步骤**\n程序将对每个测试用例执行以下步骤：\n1.  给定 $N$、$Pe$、$\\phi_L$ 和 $\\phi_R$。\n2.  如上推导，构建 $(N-1) \\times (N-1)$ 的三对角矩阵 $A$ 和右侧向量 $\\vec{b}$。\n3.  求解线性系统 $A\\vec{\\phi} = \\vec{b}$ 以找到内部解值 $\\phi_1, \\ldots, \\phi_{N-1}$。\n4.  通过在前面添加 $\\phi_L$ 并在后面添加 $\\phi_R$ 来创建完整的解数组 $\\{\\phi_i\\}_{i=0}^N$。\n5.  应用两个指定的标准来检测振荡：\n    *   检查是否有任何内部 $\\phi_j$ 严格位于 $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$ 之外。\n    *   检查对于任何 $j \\in \\{1, \\ldots, N-2\\}$ 是否有 $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$。\n6.  如果检测到振荡，则报告 `True`，否则报告 `False`。", "answer": "```\n[False,True,True,False,True]\n```", "id": "3365178"}]}