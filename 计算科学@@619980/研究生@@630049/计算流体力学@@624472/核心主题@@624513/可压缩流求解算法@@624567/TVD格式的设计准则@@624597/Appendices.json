{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方法莫过于亲手实践。本练习将带领你逐步完成一个经典的通量修正输运（FCT）格式的计算过程。通过对一个初始为阶跃函数的一维线性平流问题进行求解[@problem_id:3307932]，你将亲身体验如何组合低阶和高阶格式的通量，并利用TVD准则对修正通量进行限制，从而在抑制数值振荡的同时保持解的陡峭外形。", "problem": "考虑守恒形式的标量单元平均值 $u$ 的线性平流方程，由 $u_{t} + a\\,u_{x} = 0$ 给出，其中波速 $a > 0$ 为常数。在具有单元宽度 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上，使用一维守恒有限体积离散化方法。假设 $a = 1$，$\\Delta x = 1$，$\\Delta t = 0.3$，因此库朗数 (Courant number) 为 $C = a\\,\\Delta t/\\Delta x = 0.3$。初始数据为单位阶跃：对于所有 $i \\le -1$，$u_{i}^{n} = 1$；对于所有 $i \\ge 0$，$u_{i}^{n} = 0$。关注界面区域 $i \\in \\{-2,-1,0,1,2\\}$，并假设在该区域之外，状态保持其远场常数值。\n\n采用通量修正输运 (Flux-Corrected Transport, FCT) 框架，在该框架中，一个一阶单调低阶格式被修正以趋向一个高阶格式，且该修正受限于旨在强制实现总变差递减 (Total Variation Diminishing, TVD) 特性的设计准则。使用以下组件：\n- 低阶格式为一阶迎风有限体积法，其数值通量 $F_{i+\\frac{1}{2}}^{L}$ 由迎风状态确定。\n- 高阶候选格式为二阶 Lax–Wendroff 格式，以通量差分形式表示，并且仅用于定义反扩散通量（高阶和低阶数值通量之差）。\n\n按如下方式实现单个 FCT 时间步。首先，根据迎风通量计算低阶更新值 $u_{i}^{L}$。接着，将 Lax–Wendroff 通量与迎风通量之差作为界面反扩散通量 $A_{i+\\frac{1}{2}}$。然后，应用一个受 TVD 设计准则约束的限制器，即修正后的解 $u_{i}^{n+1}$ 相对于其在时间层 $n$ 的相邻数据，不得产生新的局部极值。使用从时间层 $n$ 的三点模板 $\\{i-1,i,i+1\\}$ 提取的标准局部邻域界限来保证 TVD 单调性，并通过在两个相邻单元共用的每个界面上使用单个受限通量 $\\tilde{A}_{i+\\frac{1}{2}}$ 来强制守恒。具体而言，对于每个单元，根据邻域界限和低阶值 $u_{i}^{L}$ 计算允许的正、负修正预算，然后限制每个面上的反扩散通量，以确保两个相邻单元均不超过其允许的预算；取一个面上的最终限制器为两个相邻单元中限制最严格的那个。\n\n对间断点附近的界面和单元执行此完整过程，确定界面 $i+\\tfrac{1}{2} = -\\tfrac{1}{2}$ 处的受限反扩散通量，并计算 $i \\in \\{-1,0,1\\}$ 的修正后单元平均值 $u_{i}^{n+1}$。将此单个受限 FCT 步骤后 $i=0$ 处的更新单元平均值作为最终答案报告。以单个数字形式提供最终答案。无需四舍五入。", "solution": "用户希望解决一个计算流体动力学问题，具体来说是将通量修正输运 (FCT) 格式应用于一个简单的平流问题。\n该问题陈述经确认为科学上合理、适定的，并包含获得唯一解所需的所有信息。这是守恒律数值方法的标准练习。我们开始求解。\n\n控制方程是守恒形式的线性平流方程：\n$$u_t + (au)_x = 0$$\n其中 $u$ 是守恒标量，$a$ 是恒定波速。\n问题提供了以下参数：\n- 波速：$a=1$。\n- 网格间距：$\\Delta x = 1$。\n- 时间步长：$\\Delta t = 0.3$。\n- 库朗数为 $C = \\frac{a \\Delta t}{\\Delta x} = \\frac{1 \\cdot 0.3}{1} = 0.3$。\n\n初始条件是离散为单元平均值的单位阶跃函数：\n$$u_i^n = \\begin{cases} 1  \\text{for } i \\le -1 \\\\ 0  \\text{for } i \\ge 0 \\end{cases}$$\n我们关注间断点周围的单元，特别是 $i \\in \\{-2, -1, 0, 1, 2\\}$。初始值为：\n$u_{-2}^n = 1$\n$u_{-1}^n = 1$\n$u_0^n = 0$\n$u_1^n = 0$\n$u_2^n = 0$\n\nFCT 过程包括几个步骤，我们将仔细遵循。\n\n**第 1 步：低阶更新**\n低阶格式是一阶迎风法。有限体积更新由下式给出：\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^L - F_{i-1/2}^L)$$\n由于波速 $a=1 > 0$，迎风数值通量为 $F_{i+1/2}^L = a u_i^n = u_i^n$。\n更新方程变为：\n$$u_i^L = u_i^n - \\frac{\\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C(u_i^n - u_{i-1}^n)$$\n我们为感兴趣的单元计算低阶解 $u_i^L$：\n- 对于 $i=-1$：$u_{-1}^L = u_{-1}^n - C(u_{-1}^n - u_{-2}^n) = 1 - 0.3(1 - 1) = 1$。\n- 对于 $i=0$：$u_0^L = u_0^n - C(u_0^n - u_{-1}^n) = 0 - 0.3(0 - 1) = 0.3$。\n- 对于 $i=1$：$u_1^L = u_1^n - C(u_1^n - u_0^n) = 0 - 0.3(0 - 0) = 0$。\n\n一个时间步后的低阶解场为：$u_{-1}^L = 1$，$u_0^L = 0.3$，$u_1^L = 0$。\n\n**第 2 步：反扩散通量**\n反扩散通量 $A_{i+1/2}$ 是高阶 (Lax-Wendroff) 通量 $F_{i+1/2}^H$ 和低阶 (迎风) 通量 $F_{i+1/2}^L$ 之差：\n$$A_{i+1/2} = F_{i+1/2}^H - F_{i+1/2}^L$$\n线性平流的 Lax-Wendroff 通量为 $F_{i+1/2}^H = \\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{a^2 \\Delta t}{2 \\Delta x}(u_{i+1}^n - u_i^n) = \\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n$。\n迎风通量为 $F_{i+1/2}^L = a u_i^n$。\n因此，反扩散通量为：\n$$A_{i+1/2} = \\left(\\frac{a}{2}(1-C)u_{i+1}^n + \\frac{a}{2}(1+C)u_i^n\\right) - a u_i^n = \\frac{a}{2}(1-C)(u_{i+1}^n - u_i^n)$$\n代入给定值 $a=1$ 和 $C=0.3$：\n$$A_{i+1/2} = \\frac{1}{2}(1-0.3)(u_{i+1}^n - u_i^n) = 0.35(u_{i+1}^n - u_i^n)$$\n我们计算与单元 $i \\in \\{-1, 0, 1\\}$ 相关的界面上的反扩散通量，这些界面是 $i \\in \\{-3/2, -1/2, 1/2, 3/2\\}$。\n- $A_{-3/2} = 0.35(u_{-1}^n - u_{-2}^n) = 0.35(1 - 1) = 0$。\n- $A_{-1/2} = 0.35(u_0^n - u_{-1}^n) = 0.35(0 - 1) = -0.35$。\n- $A_{1/2} = 0.35(u_1^n - u_0^n) = 0.35(0 - 0) = 0$。\n- $A_{3/2} = 0.35(u_2^n - u_1^n) = 0.35(0 - 0) = 0$。\n唯一的非零反扩散通量在界面 $i=-1/2$ 处。\n\n**第 3 步：限制器应用**\n最终的修正解 $u_i^{n+1}$ 是通过将反扩散修正的受限部分加到低阶解上来计算的：\n$$u_i^{n+1} = u_i^L - \\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\n其中 $\\tilde{A}$ 是受限的反扩散通量。项 $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i-1/2}$ 表示从左侧进入单元 $i$ 的反扩散，而 $\\frac{\\Delta t}{\\Delta x}\\tilde{A}_{i+1/2}$ 表示从单元 $i$ 向右侧离开的反扩散。一个正通量 $\\tilde{A}_{j+1/2}$ 将“修正质量”从单元 $j$ 移动到单元 $j+1$。\n\nTVD 约束要求不产生新的局部极值。更新后的值 $u_i^{n+1}$ 必须位于其在时间层 $n$ 的邻居设定的界限内：\n$$u_i^{\\min} \\le u_i^{n+1} \\le u_i^{\\max}$$\n其中 $u_i^{\\min} = \\min(u_{i-1}^n, u_i^n, u_{i+1}^n)$ 且 $u_i^{\\max} = \\max(u_{i-1}^n, u_i^n, u_{i+1}^n)$。\n根据这些界限，我们定义单元 $i$ 相对于其低阶状态 $u_i^L$ 的可用修正“空间”：\n- 最大允许增加量（正预算）：$Q_i^+ = u_i^{\\max} - u_i^L$。\n- 最大允许减少量（负预算）：$Q_i^- = u_i^L - u_i^{\\min}$。\n\n我们为与非零通量 $A_{-1/2}$ 相邻的单元（即单元 $i=-1$ 和 $i=0$）计算这些值。\n- 对于 $i=-1$：\n  $u_{-1}^{\\min} = \\min(u_{-2}^n, u_{-1}^n, u_0^n) = \\min(1, 1, 0) = 0$。\n  $u_{-1}^{\\max} = \\max(u_{-2}^n, u_{-1}^n, u_0^n) = \\max(1, 1, 0) = 1$。\n  $u_{-1}^L = 1$。\n  $Q_{-1}^+ = u_{-1}^{\\max} - u_{-1}^L = 1 - 1 = 0$。\n  $Q_{-1}^- = u_{-1}^L - u_{-1}^{\\min} = 1 - 0 = 1$。\n- 对于 $i=0$：\n  $u_0^{\\min} = \\min(u_{-1}^n, u_0^n, u_1^n) = \\min(1, 0, 0) = 0$。\n  $u_0^{\\max} = \\max(u_{-1}^n, u_0^n, u_1^n) = \\max(1, 0, 0) = 1$。\n  $u_0^L = 0.3$。\n  $Q_0^+ = u_0^{\\max} - u_0^L = 1 - 0.3 = 0.7$。\n  $Q_0^- = u_0^L - u_0^{\\min} = 0.3 - 0 = 0.3$。\n\n现在我们限制通量 $A_{-1/2} = -0.35$。\n由反扩散通量引起的单元 $i$ 的变化是 $\\delta_i = -\\frac{\\Delta t}{\\Delta x}(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2}) = -0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$。\n通量 $A_{-1/2}$ 是负值，表示“修正质量”从单元 $i=0$（给予单元）转移到单元 $i=-1$（接收单元）。\n待转移的修正质量量为 $M = \\frac{\\Delta t}{\\Delta x} |A_{-1/2}| = 0.3 \\times |-0.35| = 0.105$。\n此转移试图将 $u_{-1}$ 增加 $0.105$，并将 $u_0$ 减少 $0.105$。\n\n我们根据这两个单元的预算来检查这一点：\n- 接收单元是 $i=-1$。其增加的能力是 $Q_{-1}^+ = 0$。请求的增加量是 $0.105$。由于 $0.105 > 0$，接收单元无法容纳此转移。它能接受的最大值为 $0$。\n- 给予单元是 $i=0$。其减少的能力是 $Q_0^- = 0.3$。请求的减少量是 $0.105$。由于 $0.105 \\le 0.3$，给予单元可以承受此转移。\n\n最终的受限通量必须对两个相邻单元都是可接受的。我们采用最严格的约束。转移的“修正质量”量 $M^*$，不得超过给予单元所能提供的量，也不得超过接收单元所能接受的量。\n$$M^* = \\min(\\text{请求的转移量, 给予单元能力, 接收单元能力})$$\n$$M^* = \\min(M, Q_0^-, Q_{-1}^+) = \\min(0.105, 0.3, 0) = 0$$\n受限的转移量为 $M^*=0$。这意味着导致此转移的受限通量必须为零。\n受限转移量通过 $M^* = \\frac{\\Delta t}{\\Delta x} |\\tilde{A}_{-1/2}|$ 与受限通量相关联。\n由于 $M^* = 0$，我们有 $\\tilde{A}_{-1/2} = 0$。\n\n所有其他反扩散通量已经为零，因此它们对应的受限通量也为零。对于所有 $i$，$\\tilde{A}_{i+1/2} = 0$。\n\n**第 4 步：最终更新**\n我们使用受限通量计算修正后的单元平均值。\n$$u_i^{n+1} = u_i^L - 0.3(\\tilde{A}_{i+1/2} - \\tilde{A}_{i-1/2})$$\n由于所有的 $\\tilde{A}_{i+1/2}$ 均为零，所有单元的修正项都为零。最终解就是低阶解。\n$$u_i^{n+1} = u_i^L$$\n- 对于 $i=-1$：$u_{-1}^{n+1} = u_{-1}^L = 1$。\n- 对于 $i=0$：$u_0^{n+1} = u_0^L = 0.3$。\n- 对于 $i=1$：$u_1^{n+1} = u_1^L = 0$。\n\n$i=0$ 处的更新单元平均值为 $u_0^{n+1} = 0.3$。\n这个结果是 TVD 格式在急剧间断点处的典型特征；高阶格式的反压缩性质被单调性约束完全抑制，导致该格式局部退化为其一阶扩散部分。\n所要求的最终答案是 $u_0^{n+1}$ 的值。", "answer": "$$\\boxed{0.3}$$", "id": "3307932"}, {"introduction": "上一个练习展示了限制器的“操作”过程，而本练习则深入探讨其设计的“原理”。TVD格式的核心在于一个能够感知解的光滑度的限制器函数 $\\phi(r)$，其中光滑度指示器 $r$ 的定义至关重要。本练习要求你从第一性原理出发，分析为何 $r$ 的定义必须与信息传播的方向（即迎风方向）保持一致[@problem_id:3307900]，这对于构建在波速改变符号时依然稳健的格式至关重要。", "problem": "考虑标量守恒律 $u_t + f(u)_x = 0$，该方程定义在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上。局部特征速度为 $a = f'(u)$，其符号可能在空间和时间上发生改变。定义左、右单边差分分别为 $\\Delta^- u_i = u_i - u_{i-1}$ 和 $\\Delta^+ u_i = u_{i+1} - u_i$。一种高分辨率通量限制有限体积格式通过带有限制斜率的分段线性重构来建立界面状态，并使用迎风偏置的数值通量来推进解。斜率限制器是光滑度指示子 $r$ 的函数 $\\phi(r)$；数值上的总变差不增 (TVD) 特性要求限制器的设计和 $r$ 的定义与信息传播的方向保持一致。\n\n从守恒律和有限体积更新公式 $u_i^{n+1} = u_i^n - \\lambda\\left(F_{i+1/2} - F_{i-1/2}\\right)$ 出发（其中 $\\lambda = \\Delta t / \\Delta x$ 且 $F_{i\\pm1/2}$ 是由重构的左/右状态构造的迎风通量），请从第一性原理推导为什么光滑度指示子 $r$ 的定义必须与迎风方向对齐。特别地，请关注特征速度 $a$ 的符号如何决定左偏或右偏差分哪一个是迎风的。使用总变差的离散形式 $\\mathrm{TV}(u^n) = \\sum_i \\left|u_{i+1}^n - u_i^n\\right|$ 和三点格式的单调性准则来论证，当 $a$ 的符号改变时，哪种 $r$ 的定义能保持 TVD 特性，哪种不能。然后，选择一个选项，该选项为右行波和左行波正确地提供了 $r$ 的对称定义，并给出了能确保在 $a$ 符号变化时 TVD 特性得以维持的理由。\n\nA. 对所有界面和所有 $a$ 的符号，均使用 $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$，并在各处应用相同的限制器 $\\phi(r)$。该比率的对称性确保了无论 $a$ 的符号如何，TVD 特性都能得到满足。\n\nB. 对于界面处的右行波（$a>0$），使用 $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$；对于左行波（$a<0$），使用 $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$。选择一个限制器 $\\phi(r)$，使其在光滑度图上对 $r \\ge 0$ 满足标准的 TVD 约束，并在 $r \\le 0$ 时设 $\\phi(r) = 0$。这将限制器的修正与迎风梯度对齐，并在 $a$ 符号变化时保持 TVD 特性。\n\nC. 对所有界面，均使用 $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$，从而使得 $r_i \\ge 0$ 恒成立。选择任意单调不减的限制器函数 $\\phi(r)$；$r$ 的正性保证了 TVD 特性，而与 $a$ 的符号无关。\n\nD. 使用中心差分来定义 $r_i$，即 $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$，从而使 $r_i$ 与 $a$ 的符号无关。通过这种无方向性的光滑度指示子，任何标准的限制器 $\\phi(r)$ 都能在 $a$ 符号变化时保持 TVD 特性。", "solution": "用户希望我验证问题陈述，如果有效，则提供详细的解决方案。\n\n### 第一步：提取已知条件\n问题提供了以下信息：\n- 一个标量守恒律：$u_t + f(u)_x = 0$。\n- 一个具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格。\n- 局部特征速度：$a = f'(u)$。\n- 单边差分算子：$\\Delta^- u_i = u_i - u_{i-1}$ 和 $\\Delta^+ u_i = u_{i+1} - u_i$。\n- 一个有限体积更新法则：$u_i^{n+1} = u_i^n - \\lambda\\left(F_{i+1/2} - F_{i-1/2}\\right)$，其中 $\\lambda = \\Delta t / \\Delta x$。\n- 数值通量 $F_{i\\pm1/2}$ 是使用迎风偏置和高分辨率通量限制方法通过分段线性重构构造的。\n- 重构使用了一个斜率限制器，它是光滑度指示子 $r$ 的一个函数 $\\phi(r)$。\n- 总变差的定义为 $\\mathrm{TV}(u^n) = \\sum_i \\left|u_{i+1}^n - u_i^n\\right|$。\n- 核心任务是：从第一性原理推导为什么光滑度指示子 $r$ 的定义必须与迎风方向对齐，而迎风方向由特征速度 $a$ 的符号决定。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行审查。\n\n- **科学上合理**：该问题牢固地植根于双曲型偏微分方程数值方法的理论，这是计算流体力学和应用数学的一个主要课题。总变差不增 (TVD) 格式、通量限制器和迎风等概念是该领域标准和基础的内容。所有给出的方程和定义都是标准的。\n- **适定性**：该问题是适定的。它要求推导 TVD 格式的一个关键设计原则（迎风相关的光滑度指示子 $r$ 的定义），并应用此原则来评估给定的选项。前提清晰，并且存在一个唯一的、可以通过逻辑推导得出的答案。\n- **客观性**：该问题以该领域通用的精确、客观和技术性语言陈述。诸如“特征速度”、“通量限制”和“光滑度指示子”等术语具有明确定义的含义。\n\n问题陈述没有表现出验证清单中列出的任何缺陷。它不是科学上不合理的、不可形式化的、不完整的、不切实际的、不适定的、琐碎的或不可验证的。\n\n### 第三步：结论与行动\n问题陈述是**有效的**。我现在将进行推导和求解。\n\n### 从第一性原理推导\n对于双曲守恒律，高分辨率格式的目标是在解的光滑区域达到至少二阶精度，同时防止在间断点附近出现伪振荡（吉布斯现象）。总变差不增 (TVD) 特性，即 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$，是防止此类振荡的充分条件。\n\n高分辨率格式通过将低阶（一阶）单调格式与高阶格式相混合来实现这一目标。一阶迎风格式是单调（因此也是 TVD）格式的典型例子，但它具有高耗散性。像 Lax-Wendroff 这样的高阶格式耗散性较低，但可能会引入振荡。这种混合由一个通量限制器函数 $\\phi$ 控制，该函数依赖于一个“光滑度指示子”$r$。\n\n该方法的核心在于“迎风”一词。双曲型方程描述了信息沿特征线的传播。这种传播的方向由特征速度 $a = f'(u)$ 的符号给出。一个稳定的数值格式必须尊重这种方向性；这就是迎风原理。\n\n我们来分析光滑度指示子 $r$ 的作用。它旨在通过比较连续的梯度来衡量解剖面的局部“光滑度”。在解光滑的区域（例如，直线或平缓曲线），连续的梯度几乎相等，它们的比率 $r$ 应接近于1。在这些区域，限制器 $\\phi(r)$ 应允许进行高阶修正。在极值点或间断点附近，连续的梯度在大小或符号上差异显著，导致 $r$ 远不为1或为负。在这些区域，限制器 $\\phi(r)$ 必须减小或消除高阶修正，迫使格式局部地退化为稳健的一阶迎风方法以保持单调性。\n\n关键的洞见在于，梯度的比较必须与信息流动的方向一致。比率 $r$ 应始终定义为：\n$$\nr = \\frac{\\text{波的上游梯度}}{\\text{波的下游梯度}}\n$$\n我们考虑单元 $i$ 内的重构，它被用来确定通量 $F_{i-1/2}$ 和 $F_{i+1/2}$。相关的梯度是代表左侧梯度的后向差分 $\\frac{\\Delta^- u_i}{\\Delta x} = \\frac{u_i - u_{i-1}}{\\Delta x}$，和代表右侧梯度的前向差分 $\\frac{\\Delta^+ u_i}{\\Delta x} = \\frac{u_{i+1} - u_i}{\\Delta x}$。\n\n情况1：右行波 ($a > 0$)\n信息从左向右传播。对于单元 $i$ 内的重构，“迎风”方向来自左侧（来自单元 $i-1$）。“顺风”方向指向右侧（朝向单元 $i+1$）。因此，迎风梯度与 $\\Delta^- u_i$ 成正比，顺风梯度与 $\\Delta^+ u_i$ 成正比。单元 $i$ 的光滑度指示子 $r_i$ 必须定义为：\n$$\nr_i = \\frac{\\text{迎风梯度}}{\\text{顺风梯度}} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i} = \\frac{\\Delta^- u_i}{\\Delta^+ u_i}\n$$\n\n情况2：左行波 ($a  0$)\n信息从右向左传播。对于单元 $i$ 内的重构，“迎风”方向现在来自右侧（来自单元 $i+1$）。“顺风”方向指向左侧（朝向单元 $i-1$）。迎风梯度现在与 $\\Delta^+ u_i$ 成正比，顺风梯度与 $\\Delta^- u_i$ 成正比。为了保持 $r$ 作为迎风梯度与顺风梯度之比的物理意义，其定义必须反转：\n$$\nr_i = \\frac{\\text{迎风梯度}}{\\text{顺风梯度}} = \\frac{u_{i+1} - u_i}{u_i - u_{i-1}} = \\frac{\\Delta^+ u_i}{\\Delta^- u_i}\n$$\n\n因此，$r$ 的定义必须依赖于 $a$ 的符号，以正确识别迎风和顺风梯度。对所有的 $a$ 使用单一的定义将意味着在其中一种情况（$a0$ 或 $a0$）下，$r$ 将被定义为顺风梯度与迎风梯度之比。一个基于标准的迎风-顺风比率设计的限制器函数 $\\phi(r)$ 若应用于不正确的输入，将导致 TVD 特性的破坏，并可能引起数值不稳定或振荡。在 $r \\le 0$ 时 $\\phi(r)=0$ 的条件通过在极值点（此处连续梯度符号相反）关闭高阶修正来确保单调性。\n\n### 逐项分析\n\n**A. 对所有界面和所有 $a$ 的符号，均使用 $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$，并在各处应用相同的限制器 $\\phi(r)$。该比率的对称性确保了无论 $a$ 的符号如何，TVD 特性都能得到满足。**\n这种方法存在根本性缺陷。如上所推导，这个 $r_i$ 的定义仅对右行波 ($a  0$) 是正确的。对于左行波 ($a  0$)，它代表的是顺风梯度与迎风梯度之比。将一个标准的限制器函数 $\\phi(r)$ 应用于这个反转的比率将不满足 TVD 条件。关于“对称性”的说法没有根据且不正确。\n**结论：不正确。**\n\n**B. 对于界面处的右行波（$a0$），使用 $r_i^{(+)} = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$；对于左行波（$a0$），使用 $r_i^{(-)} = \\dfrac{\\Delta^+ u_i}{\\Delta^- u_i}$。选择一个限制器 $\\phi(r)$，使其在光滑度图上对 $r \\ge 0$ 满足标准的 TVD 约束，并在 $r \\le 0$ 时设 $\\phi(r) = 0$。这将限制器的修正与迎风梯度对齐，并在 $a$ 符号变化时保持 TVD 特性。**\n此选项正确地实现了从第一性原理推导出的原则。它将光滑度指示子 $r$ 定义为迎风梯度与顺风梯度之比，并根据特征速度 $a$ 的符号切换定义。这确保了限制器函数 $\\phi(r)$ 始终接收到具有物理意义的输入，使其能够正确地调节数值通量，并在波向改变的区域保持 TVD 特性。在 $r \\le 0$ 时 $\\phi(r) = 0$ 的条件也是 TVD 限制器设计的标准且必要的一部分，用于处理非单调区域。\n**结论：正确。**\n\n**C. 对所有界面，均使用 $r_i = \\dfrac{\\left|\\Delta^- u_i\\right|}{\\left|\\Delta^+ u_i\\right|}$，从而使得 $r_i \\ge 0$ 恒成立。选择任意单调不减的限制器函数 $\\phi(r)$；$r$ 的正性保证了 TVD 特性，而与 $a$ 的符号无关。**\n此选项因多个原因而不正确。首先，通过取绝对值，它丢弃了关于梯度符号的关键信息。$r \\le 0$ 的条件是局部极值的主要信号，此时限制器必须最为激进（即 $\\phi(r)=0$）。这个定义使得 $r$ 在极值点也为正，可能导致产生新的振荡。其次，即使在单调区域，此定义也等同于选项 A，因此在 $a  0$ 时未能适应迎风方向。第三，声称任何单调不减的限制器都能保证 TVD 是错误的；限制器必须位于 $\\phi-r$ 平面上的一个特定区域（TVD 区域）内，而单调不减并非充分条件。\n**结论：不正确。**\n\n**D. 使用中心差分来定义 $r_i$，即 $r_i = \\dfrac{u_{i+1} - u_{i-1}}{u_{i+2} - u_i}$，从而使 $r_i$ 与 $a$ 的符号无关。通过这种无方向性的光滑度指示子，任何标准的限制器 $\\phi(r)$ 都能在 $a$ 符号变化时保持 TVD 特性。**\n此选项误解了迎风的基本原理。其目标不是要“无方向性”。双曲型问题的物理学是具有方向性的，数值方法必须尊重这一点。试图创建一个与方向无关的指示子否定了迎风偏置格式的核心概念。所提议的 $r_i$ 定义是非标准的，比较了非同寻常模板上的梯度，并且在迎风的背景下没有清晰的物理释义。没有理论基础表明，将标准的限制器 $\\phi$ 应用于这个非正统的比率 $r_i$ 会得到一个 TVD 格式。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "3307900"}, {"introduction": "一个理论上完美的数值格式，在实际的计算机有限精度运算中可能表现不佳。本练习将带你直面这一挑战，探讨在光滑度指示器 $r$ 的分母接近于零时，浮点误差如何破坏TVD性质。通过评估不同的“正则化”或无比率（ratio-free）的限制器设计方案[@problem_id:3307923]，你将学会如何设计出不仅理论上正确，而且在实际计算中足够稳健的高分辨率格式。", "problem": "考虑一维线性平流方程 $u_t + a \\, u_x = 0$（其中 $a  0$），该方程在一个间距为 $\\Delta x$ 的均匀网格上求解，并采用前向欧拉时间步长 $\\Delta t$，使得库朗数 $\\nu = a \\, \\Delta t / \\Delta x$ 位于 $(0,1]$ 区间内。在每个界面 $x_{i+1/2}$ 处，采用一种带有通量限制器函数 $\\phi$ 的高分辨率守恒律单调上游中心格式 (MUSCL) 通量，该方法使用基于局部斜率比 $r_i$ 的左态分段线性重构。令 $\\Delta_- u_i = u_i - u_{i-1}$ 和 $\\Delta_+ u_i = u_{i+1} - u_i$，并设 $x_{i+1/2}$ 处的数值通量为\n$$\nF_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i,\n$$\n在 $x_{i-1/2}$ 处有基于 $r_{i-1}$ 的类似表达式。全离散更新格式为 $u_i^{n+1} = u_i^n - \\nu \\, (F_{i+1/2} - F_{i-1/2}) / a$。\n\n总变差递减 (TVD) 要求是离散总变差 $\\mathrm{TV}(u^n) = \\sum_i |u_{i+1}^n - u_i^n|$ 对所有 $n$ 满足 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$。\n\n在精确算术中，当 $r_i = \\Delta_- u_i / \\Delta_+ u_i$ 时，对 $\\phi$ 的经典 TVD 约束（例如，为此通量形式在 Sweby 图中总结的那些约束）可以确保 TVD。然而，在有限精度算术中，当 $|\\Delta_+ u_i|$ 和 $|\\Delta_- u_i|$ 非常小（接近常数状态）时，舍入误差会严重干扰 $r_i$ 的符号和大小，可能违反保证 TVD 所需的条件。\n\n现要求您评估以下设计提案，这些提案旨在提高有限精度下的鲁棒性，同时保持 TVD。假设 $\\nu \\in (0,1]$ 是固定的且 $a  0$。\n\n在浮点计算中，舍入误差可能会干扰接近零的 $r$，下列哪个提案（如果采用）能保证格式对所有数据和所有 $\\nu \\in (0,1]$ 保持 TVD？选择所有适用的选项。\n\nA. 保持符号的 Epsilon 正则化比率：\n定义 $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)}$，其中 $\\varepsilon  0$ 是一个固定的数，且当 $x \\ge 0$ 时 $\\mathrm{sign}(x) = +1$，否则 $\\mathrm{sign}(x) = -1$。使用任意满足以下条件的限制器 $\\phi$：非递减，对 $r \\le 0$ 满足 $\\phi(r) = 0$，对 $r \\ge 0$ 满足 $0 \\le \\phi(r) \\le \\min\\{2 r, 2\\}$。通量保持不变，仅将 $r_i$ 替换为 $r_{i,\\varepsilon}$。结论：该方法对所有 $\\nu \\in (0,1]$ 产生一个 TVD 格式。\n\nB. 无符号控制的 Epsilon 偏移分母：\n定义 $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon}$，其中 $\\varepsilon  0$ 是一个固定的数。使用满足与选项 A 中相同的逐点边界的任意限制器 $\\phi$。通量保持不变，仅将 $r_i$ 替换为 $r_{i,\\varepsilon}$。结论：该方法对所有 $\\nu \\in (0,1]$ 产生一个 TVD 格式。\n\nC. 斜率空间中的阈值化斜率限制器 (无比率)：\n将基于比率的限制器替换为直接在增量上定义的斜率限制器，\n$$\ns_{i,\\varepsilon} = \n\\begin{cases}\n\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i),  \\text{若 } \\max\\{|\\Delta_- u_i|, |\\Delta_+ u_i|\\}  \\varepsilon,\\\\\n0,  \\text{否则,}\n\\end{cases}\n$$\n其中 $\\varepsilon  0$，并设置 $F_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, s_{i,\\varepsilon}$，即高阶修正是受限斜率本身，而不是 $\\phi(r_i) \\, \\Delta_+ u_i$。结论：该方法对所有 $\\nu \\in (0,1]$ 产生一个 TVD 格式。\n\nD. 无需对 $r \\le 0$ 进行特殊处理的光滑 van Albada 限制器：\n使用 $\\phi_{\\mathrm{va}}(r) = \\dfrac{r^2 + r}{r^2 + 1}$，由浮点比率 $r_i = \\Delta_- u_i / \\Delta_+ u_i$ 计算得出，不进行 $\\varepsilon$ 正则化，也不对 $r \\le 0$ 进行裁剪。结论：由于 $\\phi_{\\mathrm{va}}$ 在 $r = 0$ 附近是光滑的，该格式对所有 $\\nu \\in (0,1]$ 保持 TVD。\n\n您的答案应为在所述条件下保证 TVD 的选项集合。为证明您的选择，请从总变差的定义和数值通量的结构出发进行推理，而不是诉诸权威或实现方面的经验。要求科学真实性：任何反例都必须与给定的格式和容许的参数范围一致。", "solution": "该问题要求评估四种用于修改 MUSCL 型格式的提案，以确保其在有限精度算术中保持总变差递减 (TVD)。\n\n首先，我们在精确算术中为给定格式的 TVD 属性建立理论基础。该格式由一维线性平流方程 $u_t + a \\, u_x = 0$（其中 $a  0$）定义。全离散更新由下式给出：\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2})$$\n使用库朗数 $\\nu = a \\Delta t / \\Delta x$，上式变为：\n$$u_i^{n+1} = u_i^n - \\frac{\\nu}{a} (F_{i+1/2} - F_{i-1/2})$$\n界面 $x_{i+1/2}$ 处的数值通量由下式给出：\n$$F_{i+1/2} = a \\, u_i + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i$$\n其中 $\\Delta_+ u_i = u_{i+1} - u_i$，斜率比为 $r_i = \\Delta_- u_i / \\Delta_+ u_i = (u_i - u_{i-1}) / (u_{i+1} - u_i)$。\n类似地，$x_{i-1/2}$ 处的通量为 $F_{i-1/2} = a \\, u_{i-1} + \\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_{i-1}) \\, \\Delta_+ u_{i-1}$。\n\n将通量定义代入更新方程，我们得到差分形式的格式：\n$$u_i^{n+1} = u_i^n - \\frac{\\nu}{a} \\left[ \\left( a u_i + \\frac{a(1-\\nu)}{2} \\phi(r_i) \\Delta_+ u_i \\right) - \\left( a u_{i-1} + \\frac{a(1-\\nu)}{2} \\phi(r_{i-1}) \\Delta_+ u_{i-1} \\right) \\right]$$\n$$u_i^{n+1} = u_i^n - \\nu (u_i - u_{i-1}) - \\frac{\\nu(1-\\nu)}{2} \\left[ \\phi(r_i) \\Delta_+ u_i - \\phi(r_{i-1}) \\Delta_+ u_{i-1} \\right]$$\n使用 $\\Delta_+ u_{i-1} = u_i - u_{i-1} = \\Delta_- u_i$，我们得到：\n$$u_i^{n+1} = u_i^n - \\nu \\Delta_- u_i - \\frac{\\nu(1-\\nu)}{2} \\left[ \\phi(r_i) \\Delta_+ u_i - \\phi(r_{i-1}) \\Delta_- u_i \\right]$$\n\n如果格式不产生新的局部极值，并且不放大现有的极值，则 TVD 属性 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$ 得到保证。对于这类通量限制器格式，防止产生新极值的一个关键条件是，作为反扩散通量的高阶修正项必须在局部极值点处被禁用。单元 $i$ 处的局部极值意味着 $\\Delta_- u_i$ 和 $\\Delta_+ u_i$ 符号相反（或其中一个为零），即 $r_i \\le 0$。因此，格式为 TVD 的一个基本必要条件是：\n$$\\phi(r) = 0 \\quad \\text{for} \\quad r \\le 0$$\n选项 A 中提到的作为此通量形式经典约束一部分的进一步条件是：\n$$0 \\le \\phi(r) \\le 2r \\quad \\text{for} \\quad r  0$$\n$$0 \\le \\phi(r) \\le 2 \\quad \\text{for} \\quad r  0$$\n对于 $r0$，这些条件可以概括为 $0 \\le \\phi(r) \\le \\min(2r, 2)$。\n\n问题的核心在于，在有限精度算术中，当 $\\Delta_+ u_i$ 接近零时，$r_i$ 的计算值可能具有不正确的量值，以及至关重要的不正确符号。不正确的符号可能导致在 $\\phi(r_i)$ 本应为零的地方得到非零值，从而引入伪振荡并违反 TVD 属性。我们现在评估每个提案解决此问题的能力。\n\n**A 选项分析：**\n提出的正则化是 $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)}$，其中 $\\mathrm{sign}(x)$ 是一个非标准的符号函数，定义为当 $x \\ge 0$ 时为 $+1$，否则为 $-1$。\n让我们分析分母 $D = \\Delta_+ u_i + \\varepsilon \\, \\mathrm{sign}(\\Delta_+ u_i)$。\n\\begin{itemize}\n    \\item 如果 $\\Delta_+ u_i  0$，$D = \\Delta_+ u_i + \\varepsilon  \\varepsilon$。\n    \\item 如果 $\\Delta_+ u_i  0$，$D = \\Delta_+ u_i - \\varepsilon  -\\varepsilon$。\n    \\item 如果 $\\Delta_+ u_i = 0$，$D = 0 + \\varepsilon \\cdot 1 = \\varepsilon  0$。\n\\end{itemize}\n在所有情况下，分母的量值由 $\\varepsilon$ 从下方限定，这防止了除以接近零的数。最重要的是，这种正则化保留了分母相对于 $\\Delta_+ u_i$ 的符号。具体来说，对于所有 $\\Delta_+ u_i \\neq 0$，有 $\\mathrm{sign}(D) = \\mathrm{sign}(\\Delta_+ u_i)$（当 $\\Delta_+ u_i=0$ 时为正）。因此，正则化比率 $r_{i,\\varepsilon}$ 的符号与精确比率 $r_i = \\Delta_- u_i / \\Delta_+ u_i$ 的符号相同。\n由于符号被正确地维持，$\\phi(r \\le 0) = 0$ 的条件得到了稳健的执行。如果真实解存在极值（$r_i \\le 0$），正则化格式也将计算出一个非正比率，并正确地将反扩散修正设置为零。在光滑区域（$r_i  0$），则使用一个行为良好的非零限制器值。限制器函数 $\\phi$ 本身满足 TVD 边界。通过为其提供一个稳健计算的参数 $r_{i,\\varepsilon}$，格式的 TVD 属性（其严重依赖于这些条件）得以保持。\n结论是，对于任何满足所述 TVD 边界的限制器 $\\phi$，此修改都会产生一个 TVD 格式。这是成立的，因为即使在浮点不确定性下，该修改也能正确识别单调性（$r0$）与极值（$r \\le 0$），从而使限制器能够按 TVD 理论的预期工作。\n结论：**正确**。\n\n**B 选项分析：**\n提出的正则化是 $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{\\Delta_+ u_i + \\varepsilon}$。\n这种形式也通过确保分母的量值至少为 $\\varepsilon$ 来防止除以零，前提是 $\\Delta_+ u_i \\ge -\\varepsilon$。然而，它在一个关键场景中未能保持比率的符号。\n考虑一个局部极大值，其中 $\\Delta_- u_i  0$ 且 $\\Delta_+ u_i$ 是一个小的负数。例如，令 $\\Delta_+ u_i = -\\delta$，其中 $0  \\delta  \\varepsilon$。精确比率为 $r_i = \\Delta_- u_i / (-\\delta)  0$。TVD 属性要求 $\\phi(r_i) = 0$。\n使用正则化后，分母变为 $D = -\\delta + \\varepsilon  0$。正则化比率为 $r_{i,\\varepsilon} = \\dfrac{\\Delta_- u_i}{-\\delta + \\varepsilon}  0$。\n格式随后将计算出 $\\phi(r_{i,\\varepsilon})  0$（假设 $\\Delta_-u_i \\neq 0$），在局部极大值处应用反扩散修正。这正是 TVD 格式必须防止的，因为它会产生过冲和伪振荡。因此，该提案不能保证格式保持 TVD。\n结论：**不正确**。\n\n**C 选项分析：**\n该提案用直接的“斜率限制器”公式替换了基于比率的通量限制器。受限的量是 $s_{i,\\varepsilon}$，它是一个受限差分。\n通量中提出的高阶修正项是 $\\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, s_{i,\\varepsilon}$。它所替换的项是 $\\tfrac{1}{2} \\, a \\, (1 - \\nu) \\, \\phi(r_i) \\, \\Delta_+ u_i$。因此，该提案等效于设置 $\\phi(r_i) \\, \\Delta_+ u_i = s_{i,\\varepsilon}$。\n让我们分析 $s_{i,\\varepsilon}$。不考虑阈值时，$s_i = \\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$。minmod 函数的定义是：如果 $|a|  |b|$ 且 $ab0$，则 $\\mathrm{minmod}(a,b) = a$；如果 $|b|  |a|$ 且 $ab0$，则为 $b$；如果 $ab \\le 0$，则为 $0$。\n让我们将其与标准 minmod 通量限制器的 $\\phi(r_i) \\Delta_+ u_i$ 进行比较，对于该限制器有 $\\phi_{\\text{minmod}}(r) = \\max(0, \\min(r,1))$。\n如果 $r_i  0$，则 $\\Delta_- u_i$ 和 $\\Delta_+ u_i$ 符号相同。\n\\begin{itemize}\n    \\item 如果 $0  r_i \\le 1$，那么 $\\phi_{\\text{minmod}}(r_i) = r_i$。该项为 $r_i \\Delta_+ u_i = (\\Delta_- u_i / \\Delta_+ u_i) \\Delta_+ u_i = \\Delta_- u_i$。此时，$|\\Delta_- u_i| \\le |\\Delta_+ u_i|$，所以 $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = \\Delta_- u_i$。\n    \\item 如果 $r_i  1$，那么 $\\phi_{\\text{minmod}}(r_i) = 1$。该项为 $1 \\cdot \\Delta_+ u_i = \\Delta_+ u_i$。此时，$|\\Delta_- u_i|  |\\Delta_+ u_i|$，所以 $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = \\Delta_+ u_i$。\n\\end{itemize}\n如果 $r_i \\le 0$，那么 $\\phi_{\\text{minmod}}(r_i) = 0$。该项为 $0$。此时，$\\Delta_- u_i$ 和 $\\Delta_+ u_i$ 符号相反或其中一个为零，所以 $\\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i) = 0$。\n因此，$s_i = \\mathrm{minmod}(\\Delta_- u_i, \\Delta_+ u_i)$ 在数学上与 $\\phi_{\\text{minmod}}(r_i) \\Delta_+ u_i$ 是等价的。\nminmod 限制器 $\\phi_{\\text{minmod}}(r)$ 满足问题陈述中给出的 TVD 条件（$0 \\le \\phi(r) \\le \\min(2r,2)$ 且 $\\phi(r \\le 0) = 0$）。\n该提案的主要优点是它直接计算受限差分，完全避免了比率 $r_i$ 的计算，从而规避了除以接近零的数的问题。这是一种计算上稳健的方法。增加的阈值在斜率很小时将 $s_{i,\\varepsilon}$ 置为 0，这只是在接近常数的区域中迫使格式降为一阶，这是一个保留 TVD 属性的安全操作。\n因此，这是一种实现 TVD 格式的有效且稳健的方法。\n结论：**正确**。\n\n**D 选项分析：**\n该提案建议使用 van Albada 限制器 $\\phi_{\\mathrm{va}}(r) = \\dfrac{r^2 + r}{r^2 + 1}$，且不对 $r \\le 0$ 作任何特殊处理。给出的理由是它在 $r=0$ 附近的光滑性。\n然而，TVD 属性并非由光滑性保证。它依赖于一组代数不等式。其中最基本的一条是，对于非正比率，限制器必须为零，即 $\\phi(r \\le 0) = 0$，以防止新极值的增长。\n让我们对给定的 $\\phi_{\\mathrm{va}}(r)$ 检查此条件。对于 $r \\in (-1, 0)$，$r^2  0$ 且 $r  0$，并且 $|r|  |r^2|$，所以 $r^2+r  0$。因此 $\\phi_{\\mathrm{va}}(r)  0$。对于 $r  -1$，$r^2+r  0$，所以 $\\phi_{\\mathrm{va}}(r)0$。例如，$\\phi_{\\mathrm{va}}(-2) = (4-2)/(4+1) = 2/5 \\neq 0$。\n该函数显然不对于所有 $r \\le 0$ 都为零。它违反了格式成为 TVD 的一个必要条件，即使在精确算术中也是如此。浮点误差可能发生的事实，相对于这个根本性缺陷而言是次要的。声称在 $r=0$ 处的光滑性可确保 TVD 属性的说法是不合逻辑的；光滑性与解析极值的精度有关，而与防止其增长无关。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "3307923"}]}