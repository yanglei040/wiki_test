{"hands_on_practices": [{"introduction": "激波是可压缩流体中的一种常见的不连续现象，它对数值方法的稳定性构成了巨大挑战。本练习将通过引入人工体积粘性来展示一种经典的激波捕捉方法，从而在数值上稳定计算。通过这个实践 [@problem_id:3299267]，您将亲手操作如何将物理原理（热力学第二定律）与数值技术相结合，以确保解的物理真实性和数值稳定性。", "problem": "考虑一个由理想气体的无粘性欧拉方程建模的一维可压缩流，该模型增加了一个人工体积粘度项，用以在有限体积法（FVM）中稳定激波过渡。设该气体遵循理想气体定律，其比热比 $\\gamma$ 和比气体常数 $R$ 为常数。从热力学第二定律的局部形式（克劳修斯-杜安不等式）和单位质量熵 $s$ 的定义出发，论证引入体积粘度系数 $\\zeta \\ge 0$ 会在流动局部受压时产生与该不等式一致的熵产率。提出一个与局部压缩率成正比的人工体积粘性压力，并根据一致的离散压缩率估计和面心热力学状态，为单元 $i$ 和 $i+1$ 之间界面上的人工体积压力 $q_{b,i+\\frac{1}{2}}$ 建立一个面心离散格式。\n\n然后，对于间距为 $\\Delta x$ 的均匀网格中的单个界面 $i+\\frac{1}{2}$，考虑界面两侧的以下单元中心状态：\n- 左侧状态（单元 $i$）：密度 $\\rho_i = 1.0$ $\\mathrm{kg/m^3}$，速度 $u_i = 500$ $\\mathrm{m/s}$，压力 $p_i = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$。\n- 右侧状态（单元 $i+1$）：密度 $\\rho_{i+1} = 2.5$ $\\mathrm{kg/m^3}$，速度 $u_{i+1} = 100$ $\\mathrm{m/s}$，压力 $p_{i+1} = 2.0 \\times 10^{5}$ $\\mathrm{Pa}$。\n\n假设 $\\gamma = 1.4$, $R = 287$ $\\mathrm{J/(kg \\cdot K)}$，以及 $\\Delta x = 2.0 \\times 10^{-3}$ $\\mathrm{m}$。使用算术平均来定义面心密度和温度，\n$$\n\\rho_{i+\\frac{1}{2}} = \\frac{\\rho_i + \\rho_{i+1}}{2}, \\qquad T_{i+\\frac{1}{2}} = \\frac{T_i + T_{i+1}}{2}, \\qquad T_i = \\frac{p_i}{\\rho_i R}, \\quad T_{i+1} = \\frac{p_{i+1}}{\\rho_{i+1} R}.\n$$\n设面上的离散压缩率为\n$$\nC_{i+\\frac{1}{2}} = \\max\\left(0, -\\frac{u_{i+1} - u_i}{\\Delta x}\\right).\n$$\n施加一个设计要求，即界面处的人工体积粘度仅通过体积粘性机制产生一个规定的单位质量局部熵产率 $\\dot{s}^* = 1.0 \\times 10^{4}$ $\\mathrm{J/(kg \\cdot K \\cdot s)}$。使用面心量和体积粘性熵产关系，确定所需的面体积粘度系数 $\\zeta_{i+\\frac{1}{2}}$。\n\n将最终数值四舍五入至四位有效数字。最终的粘度系数以 $\\mathrm{Pa \\cdot s}$ 为单位表示。", "solution": "该问题被评估为科学上合理、设定良好且客观。所有必要的数据和定义都已提供，以获得唯一解。人工粘度、热力学第二定律及其在CFD中的数值实现等概念是标准的，并且表述正确。因此，该问题是有效的。\n\n问题包括两部分：首先，是关于人工体积粘度项形式的理论论证；其次，是基于规定的熵产率计算粘度系数。\n\n第1部分：人工体积粘度的理论动机\n\n分析熵产的基础是简单可压缩物质的吉布斯关系式，它结合了热力学第一和第二定律。对于单位质量流体的过程，其形式为：\n$$\nT ds = de + p dv\n$$\n其中 $s$ 是比熵， $T$ 是绝对温度， $e$ 是比内能， $p$ 是热力学压力， $v = 1/\\rho$ 是比容，而 $\\rho$ 是密度。\n\n取物质导数 $D/Dt = \\partial/\\partial t + \\mathbf{u} \\cdot \\nabla$，它跟随流体质点的运动，我们得到其速率形式：\n$$\nT \\frac{Ds}{Dt} = \\frac{De}{Dt} + p \\frac{Dv}{Dt}\n$$\n量 $\\dot{s} = Ds/Dt$ 是单位质量的熵产率。对于包含压力场做功的流体，热力学第一定律（能量守恒）由下式给出：\n$$\n\\rho \\frac{De}{Dt} = -\\nabla \\cdot (p\\mathbf{u}) + (\\mathbf{u} \\cdot \\nabla)p = -p(\\nabla \\cdot \\mathbf{u})\n$$\n最后的等式在空间均匀的压力梯度下成立，但 $-p(\\nabla \\cdot \\mathbf{u})$ 形式表示可逆的压缩功。对于无粘、非导热流，这是唯一的功项。\n\n从比容的定义 $v = 1/\\rho$，我们求其物质导数：\n$$\n\\frac{Dv}{Dt} = \\frac{D}{Dt}\\left(\\frac{1}{\\rho}\\right) = -\\frac{1}{\\rho^2}\\frac{D\\rho}{Dt}\n$$\n连续性方程（质量守恒）为 $\\frac{D\\rho}{Dt} + \\rho (\\nabla \\cdot \\mathbf{u}) = 0$，这意味着 $\\frac{D\\rho}{Dt} = -\\rho (\\nabla \\cdot \\mathbf{u})$。将此代入 $Dv/Dt$ 的表达式中：\n$$\n\\frac{Dv}{Dt} = -\\frac{1}{\\rho^2}(-\\rho (\\nabla \\cdot \\mathbf{u})) = \\frac{1}{\\rho}(\\nabla \\cdot \\mathbf{u})\n$$\n现在，将 $De/Dt$ 和 $Dv/Dt$ 的表达式代入无粘流的吉布斯关系式速率形式中：\n$$\nT \\frac{Ds}{Dt} = \\frac{1}{\\rho}(-p(\\nabla \\cdot \\mathbf{u})) + p\\left(\\frac{1}{\\rho}(\\nabla \\cdot \\mathbf{u})\\right) = 0\n$$\n这意味着 $Ds/Dt = 0$，即光滑、无粘、非导热的流动是等熵的。这在物理上是正确的，但它未能捕捉到必须在激波中发生的不可逆熵增。\n\n为了在数值上捕捉激波的这种不可逆性，引入了人工体积粘度项。这在动量和能量方程中增加了一个耗散的“压力”项 $q_b$。有效压力变为 $p_{eff} = p + q_b$。能量方程被修改以包括这个附加压力所做的功：\n$$\n\\rho \\frac{De}{Dt} = -(p+q_b)(\\nabla \\cdot \\mathbf{u})\n$$\n将这个修改后的能量方程代回吉布斯关系式中：\n$$\nT \\frac{Ds}{Dt} = \\frac{1}{\\rho}(-(p+q_b)(\\nabla \\cdot \\mathbf{u})) + p\\left(\\frac{1}{\\rho}(\\nabla \\cdot \\mathbf{u})\\right)\n$$\n$$\nT \\frac{Ds}{Dt} = -\\frac{p}{\\rho}(\\nabla \\cdot \\mathbf{u}) - \\frac{q_b}{\\rho}(\\nabla \\cdot \\mathbf{u}) + \\frac{p}{\\rho}(\\nabla \\cdot \\mathbf{u}) = -\\frac{q_b}{\\rho}(\\nabla \\cdot \\mathbf{u})\n$$\n因此，单位质量的熵产率为：\n$$\n\\dot{s} = \\frac{Ds}{Dt} = -\\frac{q_b}{\\rho T}(\\nabla \\cdot \\mathbf{u})\n$$\n热力学第二定律，以克劳修斯-杜安不等式的形式，要求局部熵产率必须为非负，即 $\\dot{s} \\ge 0$。由于 $\\rho > 0$ 和 $T > 0$，这对以下条件施加了约束：\n$$\n-q_b(\\nabla \\cdot \\mathbf{u}) \\ge 0\n$$\n激波的特点是强压缩，其中流体体积减小，意味着 $\\nabla \\cdot \\mathbf{u}  0$。为了在这些区域满足第二定律，我们必须有 $q_b > 0$。在膨胀区域（$\\nabla \\cdot \\mathbf{u} > 0$），这将意味着 $q_b  0$，这通常是不希望出现的，因为它可能导致非物理行为。因此，人工粘度通常被设计为仅在压缩期间起作用。\n\n这启发了一个模型，其中 $q_b$ 与局部压缩率成正比。我们定义人工体积粘性压力为：\n$$\nq_b = -\\zeta (\\nabla \\cdot \\mathbf{u}) \\quad \\text{对于} \\quad \\nabla \\cdot \\mathbf{u}  0, \\quad \\text{并且} \\quad q_b = 0 \\quad \\text{其他情况}\n$$\n其中 $\\zeta \\ge 0$ 是体积粘度系数。这可以紧凑地写成：\n$$\nq_b = \\zeta \\max(0, -(\\nabla \\cdot \\mathbf{u}))\n$$\n使用此模型，熵产率变为：\n$$\n\\dot{s} = -\\frac{\\zeta \\max(0, -(\\nabla \\cdot \\mathbf{u}))}{\\rho T}(\\nabla \\cdot \\mathbf{u}) = \\frac{\\zeta}{\\rho T} (\\max(0, -(\\nabla \\cdot \\mathbf{u})))^2 = \\frac{\\zeta}{\\rho T}(\\nabla \\cdot \\mathbf{u})^2 \\quad (\\text{如果 } \\nabla \\cdot \\mathbf{u}  0)\n$$\n由于 $\\zeta \\ge 0$，$\\rho > 0$，$T > 0$ 且 $(\\nabla \\cdot \\mathbf{u})^2 \\ge 0$，这个公式保证了 $\\dot{s} \\ge 0$，与热力学第二定律一致。\n\n对于一维有限体积法，我们在单元界面 $i+\\frac{1}{2}$ 处对其进行离散化。散度 $\\nabla \\cdot \\mathbf{u}$ 变为 $du/dx$，近似为 $(u_{i+1} - u_i)/\\Delta x$。界面处的人工体积压力为：\n$$\nq_{b,i+\\frac{1}{2}} = \\zeta_{i+\\frac{1}{2}} \\max\\left(0, -\\frac{u_{i+1} - u_i}{\\Delta x}\\right) = \\zeta_{i+\\frac{1}{2}} C_{i+\\frac{1}{2}}\n$$\n其中 $C_{i+\\frac{1}{2}}$ 是离散压缩率，$\\zeta_{i+\\frac{1}{2}}$ 是我们需要求解的面心粘度系数。\n\n第2部分：粘度系数的数值计算\n\n界面 $i+\\frac{1}{2}$ 处的熵产率由导出关系的离散形式给出：\n$$\n\\dot{s}_{i+\\frac{1}{2}} = \\frac{\\zeta_{i+\\frac{1}{2}}}{\\rho_{i+\\frac{1}{2}} T_{i+\\frac{1}{2}}} (C_{i+\\frac{1}{2}})^2\n$$\n我们被给定一个规定的熵产率 $\\dot{s}^* = 1.0 \\times 10^4$ $\\mathrm{J/(kg \\cdot K \\cdot s)}$，并且必须找到相应的 $\\zeta_{i+\\frac{1}{2}}$。整理方程得到：\n$$\n\\zeta_{i+\\frac{1}{2}} = \\frac{\\dot{s}^* \\rho_{i+\\frac{1}{2}} T_{i+\\frac{1}{2}}}{(C_{i+\\frac{1}{2}})^2}\n$$\n我们现在使用给定的数据计算所需的量：$\\rho_i = 1.0$, $u_i = 500$, $p_i = 1.0 \\times 10^5$, $\\rho_{i+1} = 2.5$, $u_{i+1} = 100$, $p_{i+1} = 2.0 \\times 10^5$, $\\Delta x = 2.0 \\times 10^{-3}$, $R = 287$, 以及 $\\dot{s}^* = 1.0 \\times 10^4$。所有单位均为国际单位制（SI）。\n\n1.  计算面心密度 $\\rho_{i+\\frac{1}{2}}$:\n    $$\n    \\rho_{i+\\frac{1}{2}} = \\frac{\\rho_i + \\rho_{i+1}}{2} = \\frac{1.0 + 2.5}{2} = 1.75 \\ \\mathrm{kg/m^3}\n    $$\n\n2.  计算单元中心温度 $T_i$ 和 $T_{i+1}$:\n    $$\n    T_i = \\frac{p_i}{\\rho_i R} = \\frac{1.0 \\times 10^5}{1.0 \\times 287} = \\frac{100000}{287} \\ \\mathrm{K}\n    $$\n    $$\n    T_{i+1} = \\frac{p_{i+1}}{\\rho_{i+1} R} = \\frac{2.0 \\times 10^5}{2.5 \\times 287} = \\frac{200000}{717.5} = \\frac{80000}{287} \\ \\mathrm{K}\n    $$\n\n3.  计算面心温度 $T_{i+\\frac{1}{2}}$:\n    $$\n    T_{i+\\frac{1}{2}} = \\frac{T_i + T_{i+1}}{2} = \\frac{1}{2} \\left( \\frac{100000}{287} + \\frac{80000}{287} \\right) = \\frac{180000}{2 \\times 287} = \\frac{90000}{287} \\ \\mathrm{K}\n    $$\n\n4.  计算离散压缩率 $C_{i+\\frac{1}{2}}$:\n    $$\n    \\frac{u_{i+1} - u_i}{\\Delta x} = \\frac{100 - 500}{2.0 \\times 10^{-3}} = \\frac{-400}{0.002} = -2.0 \\times 10^5 \\ \\mathrm{s^{-1}}\n    $$\n    流动是压缩性的，所以：\n    $$\n    C_{i+\\frac{1}{2}} = \\max\\left(0, -(-2.0 \\times 10^5)\\right) = 2.0 \\times 10^5 \\ \\mathrm{s^{-1}}\n    $$\n\n5.  将这些值代入 $\\zeta_{i+\\frac{1}{2}}$ 的表达式中：\n    $$\n    \\zeta_{i+\\frac{1}{2}} = \\frac{(1.0 \\times 10^4) \\times (1.75) \\times \\left(\\frac{90000}{287}\\right)}{(2.0 \\times 10^5)^2}\n    $$\n    $$\n    \\zeta_{i+\\frac{1}{2}} = \\frac{10^4 \\times 1.75 \\times 9 \\times 10^4}{287 \\times 4.0 \\times 10^{10}} = \\frac{1.75 \\times 9 \\times 10^8}{287 \\times 4.0 \\times 10^{10}}\n    $$\n    $$\n    \\zeta_{i+\\frac{1}{2}} = \\frac{15.75}{1148} \\times 10^{-2} \\approx 0.013719512 \\times 10^{-2} \\ \\mathrm{Pa \\cdot s}\n    $$\n    $$\n    \\zeta_{i+\\frac{1}{2}} \\approx 1.3719512 \\times 10^{-4} \\ \\mathrm{Pa \\cdot s}\n    $$\n将结果四舍五入到四位有效数字：\n$$\n\\zeta_{i+\\frac{1}{2}} \\approx 1.372 \\times 10^{-4} \\ \\mathrm{Pa \\cdot s}\n$$", "answer": "$$\\boxed{1.372 \\times 10^{-4}}$$", "id": "3299267"}, {"introduction": "可压缩流动的控制方程通常是“刚性”的，因为声波的传播速度远大于流体的对流速度，这使得显式时间推进方法的计算效率极低。本练习 [@problem_id:3299322] 将带您深入现代隐式求解器的核心，通过推导通量雅可比矩阵来应对这一挑战。理解雅可比矩阵的结构和作用，是使用牛顿-克雷洛夫（Newton-Krylov）等先进方法处理刚性问题、从而实现大时间步长和高效计算的关键。", "problem": "考虑一个由量热完全理想气体的欧拉方程控制的一维无粘可压缩流。设守恒状态向量为 $U = \\begin{pmatrix} U_{1} \\\\ U_{2} \\\\ U_{3} \\end{pmatrix} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位质量的总能量。相应的守恒形式物理通量向量为 $F(U) = \\begin{pmatrix} F_{1}(U) \\\\ F_{2}(U) \\\\ F_{3}(U) \\end{pmatrix}$，其中 $F_{1}(U) = \\rho u$，$F_{2}(U) = \\rho u^{2} + p$，$F_{3}(U) = u(\\rho E + p)$。压力由理想气体关系式 $p = (\\gamma - 1)\\rho\\left(E - \\frac{1}{2}u^{2}\\right)$ 给出，其中 $\\gamma$ 是比热比。\n\n从守恒定律和这些本构关系出发，以守恒变量 $(\\rho, \\rho u, \\rho E)$ 显式推导通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$。然后，解释 $A(U)$ 如何出现在用于有限体积半离散化的 Newton-Krylov 隐式求解器中残差的线性化过程，并讨论近似分解作为 Krylov 迭代的预处理策略的作用，重点关注可压缩流中声-对流刚性所带来的挑战。\n\n回答规范：\n- 以 $\\rho$、$m$（其中 $m \\equiv \\rho u$）、$U_{3}$（其中 $U_{3} \\equiv \\rho E$）和 $\\gamma$ 表示 $3 \\times 3$ 矩阵 $A(U)$，提供单一的闭式解析表达式。不得代入任何数值。\n- 最终表达式中不需要单位。\n- 您最终在方框内的答案必须仅为该矩阵表达式。", "solution": "在尝试求解之前，将对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n该问题为量热完全理想气体的一维无粘可压缩流提供了以下数据和定义：\n-   **守恒状态向量**：$U = \\begin{pmatrix} U_{1} \\\\ U_{2} \\\\ U_{3} \\end{pmatrix} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位质量的总能量。\n-   **物理通量向量**：$F(U) = \\begin{pmatrix} F_{1}(U) \\\\ F_{2}(U) \\\\ F_{3}(U) \\end{pmatrix}$，其分量为：\n    -   $F_{1}(U) = \\rho u$\n    -   $F_{2}(U) = \\rho u^{2} + p$\n    -   $F_{3}(U) = u(\\rho E + p)$\n-   **状态方程**：压力 $p$ 由 $p = (\\gamma - 1)\\rho\\left(E - \\frac{1}{2}u^{2}\\right)$ 给出，其中 $\\gamma$ 是比热比。\n-   **任务**：\n    1.  用守恒变量 $(\\rho, m, U_{3})$（其中 $m \\equiv \\rho u$，$U_{3} \\equiv \\rho E$）推导通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$。\n    2.  解释 $A(U)$ 如何进入 Newton-Krylov 隐式求解器中残差的线性化过程。\n    3.  讨论近似分解作为预处理策略，重点关注声-对流刚性。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n-   **科学基础**：该问题基于一维欧拉方程，这是可压缩流体动力学研究的基础。状态向量、通量向量以及量热完全理想气体状态方程的定义都是标准的、科学上正确的。\n-   **适定性**：从给定的向量函数推导雅可比矩阵的任务是一个定义明确的数学过程。随后的概念性讨论也是适定的，要求解释计算流体动力学 (CFD) 中的标准概念。\n-   **客观性**：该问题使用精确、无歧义且客观的数学和物理术语陈述。没有主观或基于观点的陈述。\n-   **完整性和一致性**：推导雅可比矩阵所需的所有必要函数关系和定义均已提供。这些定义是内部一致的。\n-   **其他缺陷**：该问题是高等计算流体动力学中的一个标准练习，没有表现出任何其他缺陷，如琐碎、隐喻或不切实际。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个完整、合理的解答。\n\n### 求解推导\n\n解答包括两部分：通量雅可比矩阵的推导及其在隐式数值方法中作用的讨论。\n\n#### 第1部分：通量雅可比矩阵 $A(U)$ 的推导\n\n通量雅可比矩阵定义为 $A_{ij} = \\frac{\\partial F_i}{\\partial U_j}$。自变量是守恒状态向量 $U$ 的分量。根据问题规范，我们将其标记为 $U_1 = \\rho$，$U_2 = m \\equiv \\rho u$，$U_3 = \\rho E$。\n\n首先，我们必须将通量向量 $F(U)$ 完全用 $(\\rho, m, U_3)$ 表示。\n原始变量 $u$ 和 $p$ 可以写成：\n$u = \\frac{\\rho u}{\\rho} = \\frac{m}{\\rho}$\n单位质量的总能量为 $E = \\frac{\\rho E}{\\rho} = \\frac{U_3}{\\rho}$。\n压力 $p$ 由下式给出：\n$p = (\\gamma - 1)\\rho\\left(E - \\frac{1}{2}u^{2}\\right) = (\\gamma - 1)\\rho\\left(\\frac{U_3}{\\rho} - \\frac{1}{2}\\left(\\frac{m}{\\rho}\\right)^2\\right) = (\\gamma - 1)\\left(U_3 - \\frac{m^2}{2\\rho}\\right)$\n\n现在，我们重写通量向量 $F$ 的分量：\n$F_1 = \\rho u = m$\n$F_2 = \\rho u^2 + p = \\rho\\left(\\frac{m}{\\rho}\\right)^2 + (\\gamma - 1)\\left(U_3 - \\frac{m^2}{2\\rho}\\right) = \\frac{m^2}{\\rho} + (\\gamma - 1)U_3 - \\frac{\\gamma-1}{2}\\frac{m^2}{\\rho} = \\frac{3-\\gamma}{2}\\frac{m^2}{\\rho} + (\\gamma-1)U_3$\n$F_3 = u(\\rho E + p) = \\frac{m}{\\rho}(U_3 + p) = \\frac{m}{\\rho}\\left[U_3 + (\\gamma - 1)\\left(U_3 - \\frac{m^2}{2\\rho}\\right)\\right] = \\frac{m}{\\rho}\\left[\\gamma U_3 - \\frac{\\gamma-1}{2}\\frac{m^2}{\\rho}\\right] = \\frac{\\gamma m U_3}{\\rho} - \\frac{\\gamma-1}{2}\\frac{m^3}{\\rho^2}$\n\n雅可比矩阵 $A = \\frac{\\partial F}{\\partial U}$ 是一个 $3 \\times 3$ 矩阵，其元素为 $A_{ij} = \\frac{\\partial F_i}{\\partial U_j}$，其中微分是关于 $U = (\\rho, m, U_3)^T$ 的。\n\n**A 的第1行**：\n$F_1 = m$\n$A_{11} = \\frac{\\partial F_1}{\\partial \\rho} = 0$\n$A_{12} = \\frac{\\partial F_1}{\\partial m} = 1$\n$A_{13} = \\frac{\\partial F_1}{\\partial U_3} = 0$\n\n**A 的第2行**：\n$F_2 = \\frac{3-\\gamma}{2}\\frac{m^2}{\\rho} + (\\gamma-1)U_3$\n$A_{21} = \\frac{\\partial F_2}{\\partial \\rho} = -\\frac{3-\\gamma}{2}\\frac{m^2}{\\rho^2}$\n$A_{22} = \\frac{\\partial F_2}{\\partial m} = \\frac{3-\\gamma}{2}\\frac{2m}{\\rho} = (3-\\gamma)\\frac{m}{\\rho}$\n$A_{23} = \\frac{\\partial F_2}{\\partial U_3} = \\gamma-1$\n\n**A 的第3行**：\n$F_3 = \\frac{\\gamma m U_3}{\\rho} - \\frac{\\gamma-1}{2}\\frac{m^3}{\\rho^2}$\n$A_{31} = \\frac{\\partial F_3}{\\partial \\rho} = -\\frac{\\gamma m U_3}{\\rho^2} - \\frac{\\gamma-1}{2}m^3\\left(\\frac{-2}{\\rho^3}\\right) = -\\frac{\\gamma m U_3}{\\rho^2} + \\frac{(\\gamma-1)m^3}{\\rho^3}$\n$A_{32} = \\frac{\\partial F_3}{\\partial m} = \\frac{\\gamma U_3}{\\rho} - \\frac{\\gamma-1}{2}\\frac{3m^2}{\\rho^2} = \\frac{\\gamma U_3}{\\rho} - \\frac{3(\\gamma-1)m^2}{2\\rho^2}$\n$A_{33} = \\frac{\\partial F_3}{\\partial U_3} = \\frac{\\gamma m}{\\rho}$\n\n组合这些元素得到通量雅可比矩阵 $A(\\rho, m, U_3)$。\n\n#### 第2部分：$A(U)$ 在数值方法中的作用\n\n通量雅可比矩阵 $A(U)$ 是欧拉方程隐式数值方法的基石，尤其是在 Newton-Krylov 框架内。\n\n欧拉方程 $\\frac{\\partial U}{\\partial t} + \\frac{\\partial F}{\\partial x} = 0$ 的有限体积半离散化，对每个控制体 $i$ 中的单元平均状态向量 $U_i$ 产生一个常微分方程组：\n$$ \\frac{d U_i}{d t} = -\\frac{1}{V_i} \\sum_{k} \\mathcal{F}_{ik} \\cdot \\vec{S}_k \\equiv -R_i(U) $$\n这里，$R_i(U)$ 是单元 $i$ 的离散残差，它是单元 $i$ 及其相邻单元中状态向量的函数，而 $\\mathcal{F}_{ik}$ 是通过面 $k$ 的数值通量。对全局状态向量 $U$ 应用隐式时间步进格式（如后向欧拉法），会为新时间层 $n+1$ 的状态产生一个非线性方程组：\n$$ \\frac{U^{n+1} - U^n}{\\Delta t} + R(U^{n+1}) = 0 $$\n我们定义一个函数 $G(U^{n+1}) = U^{n+1} - U^n + \\Delta t R(U^{n+1}) = 0$。这个非线性系统必须在每个时间步求解。牛顿法是求解此类系统的迭代过程。给定一个迭代值 $U^k$，通过求解以下线性系统来找到更新量 $\\delta U = U^{k+1} - U^k$：\n$$ J_G(U^k) \\delta U = -G(U^k) $$\n矩阵 $J_G$ 是系统函数 $G$ 相对于 $U$ 的雅可比矩阵：\n$$ J_G = \\frac{\\partial G}{\\partial U} = I + \\Delta t \\frac{\\partial R}{\\partial U} $$\n其中 $I$ 是单位矩阵，$\\frac{\\partial R}{\\partial U}$ 是残差向量的雅可比矩阵。这个残差雅可比矩阵的元素 $\\frac{\\partial R_i}{\\partial U_j}$ 是由数值通量的雅可比矩阵构造的，而数值通量的雅可比矩阵又源于物理通量雅可比矩阵 $A(U)$。例如，对于一个数值通量 $\\mathcal{F}_{i+1/2}(U_i, U_{i+1})$，其雅可比矩阵 $\\frac{\\partial\\mathcal{F}_{i+1/2}}{\\partial U_i}$ 和 $\\frac{\\partial\\mathcal{F}_{i+1/2}}{\\partial U_{i+1}}$ 与 $A(U_i)$ 和 $A(U_{i+1})$ 直接相关。因此，$A(U)$ 是填充大型稀疏系统雅可比矩阵 $J_G$ 的基本矩阵。\n\n在 Newton-Krylov 方法中，这个大型线性系统 $J_G \\delta U = -G$ 使用迭代 Krylov 子空间方法（如 GMRES）求解。一个关键优势是 Krylov 方法不需要显式构造矩阵 $J_G$；它们只需要其对向量的作用，即矩阵-向量乘积 $J_G v$。这可以用有限差分来近似，从而使该方法成为“无矩阵”方法。\n\n然而，Krylov 方法的收敛性高度依赖于矩阵 $J_G$ 的条件数。对于可压缩流，由于物理刚性，该矩阵通常是严重病态的。刚性源于系统特征波速的巨大差异，这些波速是 $A(U)$ 的特征值：$\\lambda_1=u, \\lambda_2=u+c, \\lambda_3=u-c$，其中 $c = \\sqrt{\\gamma p / \\rho}$ 是声速。在低马赫数（$|u| \\ll c$）下，对流速度 $|u|$ 远小于声波速度 $|u \\pm c| \\approx c$。这种物理信号传播速度的差异导致系统雅可比矩阵 $J_G$ 的条件数很大，从而导致 Krylov 求解器的收敛性差。\n\n为了加速收敛，使用预处理器 $P$。目标是找到一个易于求逆的矩阵 $P \\approx J_G$，使得预处理后的系统 $P^{-1} J_G \\delta U = -P^{-1}G$ 是良态的（其特征值聚集在 1 附近）。近似分解 (AF) 提供了一种强大的预处理策略。AF 方法通过更简单、更易求逆的算子之积来近似复杂的、耦合的隐式算子 $J_G$。例如，在多维问题中，可以使用类似 ADI（交替方向隐式）的分解作为预处理器：\n$$ P = (I + \\Delta t \\delta_x A) (I + \\Delta t \\delta_y B) $$\n其中 $A$ 和 $B$ 分别是 $x$ 和 $y$ 方向的通量雅可比矩阵，$\\delta_x, \\delta_y$ 是离散空间导数算子。对 $P$ 求逆涉及一系列低维、块三对角系统的求解，这在计算上比对完整的 $J_G$ 求逆要便宜得多。这种分解虽然是近似的，但它捕捉了算子的基本结构，特别是刚性的声波传播。通过有效地“预先求逆”算子中最刚性的部分，AF 预处理器将病态问题转化为 Krylov 求解器可以高效处理的问题，即使对于非常刚性的可压缩流问题，也能实现稳健而快速的收敛。", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0   1   0 \\\\\n-\\frac{3-\\gamma}{2}\\frac{m^2}{\\rho^2}   (3-\\gamma)\\frac{m}{\\rho}   \\gamma - 1 \\\\\n-\\frac{\\gamma m U_3}{\\rho^2} + \\frac{(\\gamma-1)m^3}{\\rho^3}   \\frac{\\gamma U_3}{\\rho} - \\frac{3(\\gamma-1)m^2}{2\\rho^2}   \\frac{\\gamma m}{\\rho}\n\\end{pmatrix}\n} $$", "id": "3299322"}, {"introduction": "在模拟无界域流动（如外流空气动力学）时，人工设定的计算边界可能会产生虚假的波反射，从而污染整个求解域的精度。本练习 [@problem_id:3299256] 通过分析波的传播和声阻抗，探讨了无反射边界条件背后的物理和数学原理。您将理解为何简单的边界条件在处理斜入射波时会失效，并学习如何设计更精确的边界条件，这对于开放域问题的高保真模拟至关重要。", "problem": "考虑一个二维线性化欧拉方程组，其基流为沿 $x$ 轴方向速度为 $U$ 的均匀流，具有恒定的基流密度 $\\rho_0$ 和恒定的声速 $a_0$。设流动的马赫数为 $M = U/a_0$。区域为上半平面 $y \\ge 0$，计算边界位于 $y=0$ 处。一列角频率为 $\\omega$、波矢为 $\\boldsymbol{k} = (k_x, k_y)$ 的平面波斜向入射到边界上。定义入射角 $\\phi \\in [0,\\pi/2)$ 为波矢 $\\boldsymbol{k}$ 与边界法向（$+y$ 方向）之间的锐角，因此法向波数分量为 $k_n = k_y$ 且 $\\cos \\phi = |k_n|/|\\boldsymbol{k}|$。假设扰动为小振幅，并采用无量纲单位，使得 $\\rho_0 = 1$ 和 $a_0 = 1$，角度以弧度为单位。\n\n您的任务是分析在 $M=0.3$ 和 $M=3$ 条件下，声波和熵波斜入射时特征无反射边界条件的一致性和精度损失，并为掠射情况提出修正。请按以下步骤从第一性原理出发进行推导：\n\n1. 从均匀基流的二维空间线性化欧拉方程出发，推导声学模态和熵模态的平面波关系。使用基本的质量和动量守恒定律，以及声学模态的等熵关系。对于声学平面波，证明其色散关系为 $$(\\omega - U k_x)^2 = a_0^2 (k_x^2 + k_y^2)$$。对于纯熵波，证明其对流色散关系为 $$\\omega - U k_x = 0$$，且压力和速度扰动为零。\n\n2. 对于一个与 $x$ 轴对齐的边界（法向为 $+y$ 方向），定义一个假设法向入射的一维特征无反射封闭。在此封闭中，边界对边界压力扰动 $p'$ 和法向速度扰动 $v'$ 施加一个形如 $$p' = Z_{\\text{1D}}\\, v'$$ 的线性关系，其中 $Z_{\\text{1D}}$ 是与法向入射相符的一维声阻抗。仅使用垂直于边界的一维声学特征，用 $\\rho_0$ 和 $a_0$ 来确定 $Z_{\\text{1D}}$。\n\n3. 使用您推导出的声学平面波关系，推导边界所见的真实斜入射法向声阻抗，$$Z_{\\text{true}}(\\phi) = \\frac{p'}{v'}$$。仅用 $\\rho_0$、 $a_0$ 和 $\\phi$ 表示 $Z_{\\text{true}}(\\phi)$。解释阻抗不匹配 $Z_{\\text{1D}} \\ne Z_{\\text{true}}(\\phi)$ 如何导致声波的反射系数模非零，\n$$R_{\\text{ac}}(\\phi) = \\left|\\frac{Z_{\\text{1D}} - Z_{\\text{true}}(\\phi)}{Z_{\\text{1D}} + Z_{\\text{true}}(\\phi)}\\right|$$\n并讨论在边界法向与平均流正交的情况下，该系数模对 $\\phi$ 的依赖性和对 $M$ 的无关性。\n\n4. 对于熵波，使用推导出的关系论证在特征无反射封闭下边界处的反射系数模，并解释为什么该系数由压力和法向速度扰动的存在与否精确确定。\n\n5. 通过使用入射角 $\\phi$ 修改边界阻抗，提出一个掠射修正，以消除声波的阻抗不匹配。给出修正后的阻抗 $Z_{\\text{corr}}(\\phi)$ 和相应的修正后反射系数模\n$$R_{\\text{ac,corr}}(\\phi) = \\left|\\frac{Z_{\\text{corr}}(\\phi) - Z_{\\text{true}}(\\phi)}{Z_{\\text{corr}}(\\phi) + Z_{\\text{true}}(\\phi)}\\right|$$。\n解释当 $\\phi \\to \\pi/2$（掠射）时的极限行为。\n\n实现一个程序，针对指定的测试套件，计算并输出每种情况下的未修正和修正后的反射系数模。使用无量纲单位，其中 $\\rho_0=1$ 和 $a_0=1$，角度以弧度为单位。熵波的情况应根据其定义属性进行一致性处理。\n\n测试套件：\n- 声波, $M=0.3$, $\\phi = 0$。\n- 声波, $M=0.3$, $\\phi = \\pi/4$。\n- 声波, $M=0.3$, $\\phi = \\pi/2 - 10^{-3}$。\n- 声波, $M=3$, $\\phi = 0$。\n- 声波, $M=3$, $\\phi = \\pi/4$。\n- 声波, $M=3$, $\\phi = \\pi/2 - 10^{-3}$。\n- 熵波, $M=0.3$, $\\phi = \\pi/4$。\n- 熵波, $M=3$, $\\phi = \\pi/4$。\n\n对于每个测试用例，计算两个浮点数：未修正的反射系数模 $R_{\\text{uncorr}}$ 和修正后的反射系数模 $R_{\\text{corr}}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与上述测试套件完全一致，并平铺为\n$$[R_{\\text{uncorr}}^{(1)}, R_{\\text{corr}}^{(1)}, R_{\\text{uncorr}}^{(2)}, R_{\\text{corr}}^{(2)}, \\dots, R_{\\text{uncorr}}^{(8)}, R_{\\text{corr}}^{(8)}]$$。", "solution": "该问题要求从第一性原理出发，对线性化欧拉方程的无反射边界条件进行深入分析。我们将首先验证问题陈述的有效性，然后推导所需的关系并执行计算。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **控制方程**：二维线性化欧拉方程。\n- **基流**：均匀速度 $(U, 0)$，恒定密度 $\\rho_0$，恒定声速 $a_0$。\n- **马赫数**：$M = U/a_0$。\n- **区域**：上半平面 $y \\ge 0$，边界位于 $y=0$。\n- **扰动**：频率为 $\\omega$、波矢为 $\\boldsymbol{k} = (k_x, k_y)$ 的平面波。\n- **入射角**：$\\phi \\in [0, \\pi/2)$ 是 $\\boldsymbol{k}$ 与 $+y$ 方向（边界法向）之间的锐角。\n- **定义**：$k_n = k_y$, $\\cos \\phi = |k_n|/|\\boldsymbol{k}|$。\n- **无量纲化**：$\\rho_0 = 1$, $a_0 = 1$。角度以弧度为单位。\n- **要求推导的内容**：\n    1. 声学色散关系：$(\\omega - U k_x)^2 = a_0^2 (k_x^2 + k_y^2)$。\n    2. 熵波色散关系：$\\omega - U k_x = 0$，且 $p'=0$、速度扰动为零。\n    3. 基于 $p' = Z_{\\text{1D}} v'$ 封闭的一维法向入射阻抗 $Z_{\\text{1D}}$。\n    4. 真实斜入射阻抗 $Z_{\\text{true}}(\\phi) = p'/v'$。\n    5. 声学反射系数 $R_{\\text{ac}}(\\phi)$。\n    6. 熵波反射系数。\n    7. 修正后的阻抗 $Z_{\\text{corr}}(\\phi)$ 和反射系数 $R_{\\text{ac,corr}}(\\phi)$。\n- **测试套件**：8 个涉及声波和熵波的案例，条件为 $M=0.3, 3$，角度为 $\\phi=0, \\pi/4, \\pi/2-10^{-3}$。\n- **输出**：一个平铺的未修正和修正后的反射系数列表 $[R_{\\text{uncorr}}^{(1)}, R_{\\text{corr}}^{(1)}, \\dots]$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学基础**：该问题建立在流体动力学和波理论的公认原理之上，特别是线性化欧拉方程，这是声学和计算流体动力学（CFD）的基础。所有概念（色散关系、阻抗、反射系数）都是标准概念。\n- **适定性**：该问题结构为一系列推导，然后针对一组特定参数进行计算。目标清晰，所需输出定义唯一，能够得到有意义的解。\n- **客观性**：问题以精确的技术语言陈述，没有任何主观或模棱两可的术语。\n- **一致性和完整性**：所提供的信息是自洽的，足以进行推导。几何设置（平均流平行于边界）和入射角的定义是清晰的。没有矛盾之处。\n\n**第3步：结论与行动**\n该问题科学上合理、适定且客观。这是一个有效的问题，可以从第一性原理解决。\n\n### 推导与求解\n\n**1. 平面波关系**\n\n围绕平均状态 $(\\rho_0, U, 0, p_0)$ 的小扰动 $(\\rho', u', v', p')$ 的二维线性化欧拉方程为：\n$$\n\\begin{align*}\n\\frac{D \\rho'}{Dt} + \\rho_0 \\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0 \\quad \\text{(质量守恒)} \\\\\n\\rho_0 \\frac{D u'}{Dt} = -\\frac{\\partial p'}{\\partial x} \\quad \\text{(x-动量守恒)} \\\\\n\\rho_0 \\frac{D v'}{Dt} = -\\frac{\\partial p'}{\\partial y} \\quad \\text{(y-动量守恒)}\n\\end{align*}\n$$\n其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + U \\frac{\\partial}{\\partial x}$ 是跟随平均流的物质导数。我们寻求形如 $q' = \\hat{q} e^{i(k_x x + k_y y - \\omega t)}$ 的平面波解。应用此假设，微分算子转换为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$, $\\frac{\\partial}{\\partial x} \\to ik_x$, 以及 $\\frac{\\partial}{\\partial y} \\to ik_y$。物质导数算子变为 $-i(\\omega - U k_x) = -i\\tilde{\\omega}$，其中 $\\tilde{\\omega}$ 是多普勒频移。方程组变为关于振幅 $(\\hat{\\rho}, \\hat{u}, \\hat{v}, \\hat{p})$ 的代数系统：\n$$\n\\begin{align*}\n-i\\tilde{\\omega} \\hat{\\rho} + \\rho_0 (ik_x \\hat{u} + ik_y \\hat{v}) = 0 \\\\\n-i\\tilde{\\omega} \\rho_0 \\hat{u} = -ik_x \\hat{p} \\\\\n-i\\tilde{\\omega} \\rho_0 \\hat{v} = -ik_y \\hat{p}\n\\end{align*}\n$$\n\n**声波**：对于声波，扰动是等熵的，因此 $p' = a_0^2 \\rho'$，这意味着 $\\hat{p} = a_0^2 \\hat{\\rho}$。\n从动量方程，假设 $\\tilde{\\omega} \\ne 0$：\n$$ \\hat{u} = \\frac{k_x}{\\rho_0 \\tilde{\\omega}} \\hat{p}, \\quad \\hat{v} = \\frac{k_y}{\\rho_0 \\tilde{\\omega}} \\hat{p} $$\n将这些代入质量守恒方程：\n$$ -\\tilde{\\omega} \\hat{\\rho} + \\rho_0 \\left(k_x \\frac{k_x \\hat{p}}{\\rho_0 \\tilde{\\omega}} + k_y \\frac{k_y \\hat{p}}{\\rho_0 \\tilde{\\omega}}\\right) = 0 \\implies -\\tilde{\\omega} \\hat{\\rho} + \\frac{k_x^2 + k_y^2}{\\tilde{\\omega}} \\hat{p} = 0 $$\n使用 $\\hat{\\rho} = \\hat{p}/a_0^2$：\n$$ \\left(-\\frac{\\tilde{\\omega}}{a_0^2} + \\frac{k_x^2 + k_y^2}{\\tilde{\\omega}}\\right) \\hat{p} = 0 $$\n对于非平凡解 $(\\hat{p} \\ne 0)$，括号中的项必须为零，从而得到声学色散关系：\n$$ \\tilde{\\omega}^2 = a_0^2 (k_x^2 + k_y^2) \\implies (\\omega - U k_x)^2 = a_0^2 (k_x^2 + k_y^2) $$\n\n**熵波**：熵波是被流体对流输运的密度/温度脉动，没有相关的压力或速度扰动。因此，根据定义，$\\hat{p} = 0$, $\\hat{u} = 0$, 和 $\\hat{v} = 0$。\n动量方程变为 $0=0$。质量守恒方程变为：\n$$ -i\\tilde{\\omega} \\hat{\\rho} = 0 \\implies -i(\\omega - U k_x) \\hat{\\rho} = 0 $$\n对于非平凡的密度扰动 $(\\hat{\\rho} \\ne 0)$，必须有 $\\tilde{\\omega}=0$。这给出了熵波的色散关系：\n$$ \\omega - U k_x = 0 $$\n\n**2. 一维特征无反射封闭**\n\n在 $y \\ge 0$ 区域的 $y=0$ 处设置的无反射边界条件（NRBC）必须只允许波离开该区域。对于纯粹沿 $+y$ 方向传播的一维声波，控制方程简化为 $\\frac{\\partial p'}{\\partial t} = -a_0 \\frac{\\partial p'}{\\partial y}$ 和 $\\rho_0 \\frac{\\partial v'}{\\partial t} = -\\frac{\\partial p'}{\\partial y}$。结合这两个方程得到 $\\rho_0 \\frac{\\partial v'}{\\partial t} = \\frac{1}{a_0}\\frac{\\partial p'}{\\partial t}$，积分后得到 $p' = (\\rho_0 a_0) v'$。这是出射波的阻抗关系。一个简单的 NRBC 在边界上对总扰动场强制施加此关系。问题将此封闭定义为 $p' = Z_{\\text{1D}} v'$。通过比较，与法向入射相符的一维声阻抗是：\n$$ Z_{\\text{1D}} = \\rho_0 a_0 $$\n在指定的无量纲化下（$\\rho_0=1, a_0=1$），$Z_{\\text{1D}} = 1$。此封闭假设所有波都垂直入射到边界上。\n\n**3. 斜入射阻抗与反射**\n\n对于斜入射的声学平面波，法向声阻抗是压力扰动与法向速度扰动之比，即 $Z = \\hat{p}/\\hat{v}$。从 y-动量关系可知，$\\hat{p} = \\frac{\\rho_0 \\tilde{\\omega}}{k_y} \\hat{v}$。因此，阻抗为 $Z = \\frac{\\rho_0 \\tilde{\\omega}}{k_y}$。\n为了区分入射波和出射波，我们分析垂直于边界的群速度分量 $v_{g,y} = \\frac{\\partial \\omega}{\\partial k_y}$。从色散关系可知，$\\omega = U k_x \\pm a_0 \\sqrt{k_x^2 + k_y^2}$，所以 $v_{g,y} = \\frac{\\pm a_0 k_y}{\\sqrt{k_x^2+k_y^2}}$。出射波具有 $v_{g,y} > 0$，这要求 $k_y$ 的符号与 $\\pm$ 中选择的符号一致。我们选择“+”号和 $k_y > 0$。这对应于 $\\tilde{\\omega} = \\omega - Uk_x = a_0 \\sqrt{k_x^2+k_y^2} > 0$。\n因此，出射波的真实阻抗是：\n$$ Z_{\\text{true}} = \\frac{\\rho_0 (a_0 \\sqrt{k_x^2+k_y^2})}{k_y} = \\frac{\\rho_0 a_0 |\\boldsymbol{k}|}{|k_y|} $$\n使用问题对入射角的定义 $\\cos\\phi = |k_y|/|\\boldsymbol{k}|$，阻抗变为：\n$$ Z_{\\text{true}}(\\phi) = \\frac{\\rho_0 a_0}{\\cos\\phi} $$\n这个表达式与马赫数 $M = U/a_0$ 无关，因为来自时间导数的多普勒因子 $\\tilde{\\omega}=\\omega-Uk_x$ 与从色散关系中出现的相同因子相消。平均流平行于边界，不影响法向阻抗。\n\n边界条件所假设的阻抗 $Z_{\\text{1D}}$ 与真实的物理阻抗 $Z_{\\text{true}}(\\phi)$ 之间的不匹配会导致伪反射。压力反射系数 $R$ 由标准的阻抗不匹配公式给出，其中 $Z_{\\text{1D}}$ 充当负载阻抗，$Z_{\\text{true}}(\\phi)$ 充当介质的特性阻抗：\n$$ R_{\\text{ac}}(\\phi) = \\frac{Z_{\\text{1D}} - Z_{\\text{true}}(\\phi)}{Z_{\\text{1D}} + Z_{\\text{true}}(\\phi)} $$\n反射系数的模是这个复数（在这种情况下是实数）的绝对值：\n$$ R_{\\text{ac}}(\\phi) = \\left|\\frac{\\rho_0 a_0 - \\frac{\\rho_0 a_0}{\\cos\\phi}}{\\rho_0 a_0 + \\frac{\\rho_0 a_0}{\\cos\\phi}}\\right| = \\left|\\frac{1 - 1/\\cos\\phi}{1 + 1/\\cos\\phi}\\right| = \\left|\\frac{\\cos\\phi - 1}{\\cos\\phi + 1}\\right| $$\n由于 $\\phi \\in [0, \\pi/2)$，$\\cos\\phi \\in (0,1]$，分子非正，分母为正。因此：\n$$ R_{\\text{ac}}(\\phi) = \\frac{1-\\cos\\phi}{1+\\cos\\phi} = \\tan^2\\left(\\frac{\\phi}{2}\\right) $$\n对于法向入射（$\\phi=0$），$R_{\\text{ac}}(0)=0$（完美吸收）。对于掠射（$\\phi \\to \\pi/2$），$R_{\\text{ac}}(\\phi) \\to 1$（全反射）。\n\n**4. 熵波反射**\n\n熵波的特征是具有零压力和零速度扰动（$p'=0, \\boldsymbol{v'}=0$）。其能量由群速度 $\\boldsymbol{v}_g = (\\partial \\omega/\\partial k_x, \\partial \\omega/\\partial k_y) = (U, 0)$ 决定，纯粹沿 $x$ 轴传播，因此平行于 $y=0$ 的边界。从能量角度看，熵波永远不会“撞击”边界，无论其相位阵面（即任何 $k_y$ 值）的方向如何。因此，它不能被边界反射。\n边界条件 $p' = Z v'$ 只关联压力和法向速度。由于入射熵波具有 $p'_i=0$ 和 $v'_i=0$，该条件自然满足（$0=0$），而不需要产生任何反射声波（$p'_r=0, v'_r=0$）。\n因此，在这种类型的边界条件下，熵波的反射系数恰好为零。\n\n**5. 掠射修正**\n\n为了消除声波的反射，边界条件的阻抗必须与波的真实阻抗完全匹配。我们提出一个修正后的阻抗 $Z_{\\text{corr}}(\\phi)$，它是入射角的函数：\n$$ Z_{\\text{corr}}(\\phi) = Z_{\\text{true}}(\\phi) = \\frac{\\rho_0 a_0}{\\cos\\phi} $$\n使用此阻抗的边界条件 $p' = Z_{\\text{corr}}(\\phi) v'$ 对于入射角为 $\\phi$ 的声波是完全无反射的。修正后的反射系数模为：\n$$ R_{\\text{ac,corr}}(\\phi) = \\left|\\frac{Z_{\\text{corr}}(\\phi) - Z_{\\text{true}}(\\phi)}{Z_{\\text{corr}}(\\phi) + Z_{\\text{true}(\\phi)}}\\right| = \\left|\\frac{Z_{\\text{true}}(\\phi) - Z_{\\text{true}}(\\phi)}{Z_{\\text{true}}(\\phi) + Z_{\\text{true}(\\phi)}}\\right| = 0 $$\n这对所有 $\\phi \\in [0, \\pi/2)$ 都成立。\n在掠射极限下，$\\phi \\to \\pi/2$，我们有 $\\cos\\phi \\to 0$，因此 $Z_{\\text{corr}}(\\phi) \\to \\infty$。边界条件 $p' = Z_{\\text{corr}}(\\phi) v'$ 则意味着对于任何有限压力，都有 $v' \\to 0$，这正是刚性壁边界条件。这在物理上是正确的，因为一个几乎平行于表面传播的波，其法向速度分量应被抑制。\n\n对于熵波，修正后的边界条件不会改变结果。入射波仍然有 $p'_i=0, v'_i=0$，修正后的反射系数保持为零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes uncorrected and corrected reflection coefficients for acoustic and\n    entropy waves based on the linearized Euler equations.\n    \"\"\"\n\n    # Define the test cases from the problem statement:\n    # (wave_type, Mach_number, incidence_angle_phi_rad)\n    test_cases = [\n        ('Acoustic', 0.3, 0.0),\n        ('Acoustic', 0.3, np.pi / 4.0),\n        ('Acoustic', 0.3, np.pi / 2.0 - 1e-3),\n        ('Acoustic', 3.0, 0.0),\n        ('Acoustic', 3.0, np.pi / 4.0),\n        ('Acoustic', 3.0, np.pi / 2.0 - 1e-3),\n        ('Entropy', 0.3, np.pi / 4.0),\n        ('Entropy', 3.0, np.pi / 4.0),\n    ]\n\n    results = []\n    \n    # Nondimensional units are used: rho_0 = 1, a_0 = 1\n    # One-dimensional impedance for normal incidence\n    # Z_1D = rho_0 * a_0 = 1.0\n    \n    for case in test_cases:\n        wave_type, M, phi = case\n        \n        R_uncorr = 0.0\n        R_corr = 0.0\n\n        if wave_type == 'Acoustic':\n            # The reflection coefficient for acoustic waves is independent of Mach number M.\n            \n            # The impedance mismatch is between Z_1D = 1 and Z_true = 1/cos(phi).\n            # The reflection coefficient magnitude is |(Z_1D - Z_true) / (Z_1D + Z_true)|.\n            # R_uncorr = |(1 - 1/cos(phi)) / (1 + 1/cos(phi))|\n            #          = |(cos(phi) - 1) / (cos(phi) + 1)|\n            # Since phi is in [0, pi/2), cos(phi) is in (0, 1].\n            # So, R_uncorr = (1 - cos(phi)) / (1 + cos(phi))\n            \n            cos_phi = np.cos(phi)\n            \n            # Handle potential division by zero if phi = pi, though not in test range.\n            if 1.0 + cos_phi == 0:\n                # This case corresponds to phi = pi, where reflection is undefined\n                # in this formulation but can be considered infinite based on the tan^2(phi/2) formula.\n                # It is not relevant for the given problem range phi in [0, pi/2).\n                R_uncorr = np.inf\n            else:\n                R_uncorr = (1.0 - cos_phi) / (1.0 + cos_phi)\n\n            # The corrected boundary condition uses an impedance Z_corr = Z_true.\n            # This perfectly matches the wave impedance, resulting in zero reflection.\n            R_corr = 0.0\n            \n        elif wave_type == 'Entropy':\n            # An entropy wave has p'=0 and v'=0. It also has a group velocity\n            # parallel to the boundary, so it does not impinge on it energetically.\n            # The boundary condition p' = Z*v' is trivially satisfied (0 = Z*0).\n            # No acoustic wave is generated.\n            # Thus, the reflection coefficient is zero for both uncorrected and\n            # corrected boundary conditions.\n            R_uncorr = 0.0\n            R_corr = 0.0\n\n        results.append(R_uncorr)\n        results.append(R_corr)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts each float to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3299256"}]}