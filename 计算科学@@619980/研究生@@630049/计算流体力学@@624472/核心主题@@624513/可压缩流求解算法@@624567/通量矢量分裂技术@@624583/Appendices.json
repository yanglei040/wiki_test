{"hands_on_practices": [{"introduction": "通量矢量分裂方法的核心思想是根据信息传播的方向来分离通量，而这个方向由欧拉方程雅可比矩阵的特征值（即特征速度）决定。本练习将引导你从第一性原理出发，推导并计算这些至关重要的速度，从而夯实你对迎风格式背后物理机理的理解。[@problem_id:3366221]", "problem": "考虑理想气体的一维可压缩欧拉方程的守恒形式，其守恒状态向量为 $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量向量为 $\\mathbf{F}(\\mathbf{U}) = \\big(\\rho u, \\rho u^{2} + p, u(E + p)\\big)^{\\mathsf{T}}$。压力 $p$ 通过理想气体状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2} \\rho u^{2}\\right)$ 与总能量密度 $E$ 和密度 $\\rho$ 相关联，其中 $\\gamma$ 是比热比。声速 $a$ 的热力学定义为 $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$，即在恒定熵 $s$ 下压力对密度的导数。计算流体动力学（CFD）的框架通常利用通量雅可比矩阵的特征信息来构建迎风格式，例如 Steger–Warming 通量矢量分裂法，该方法根据波速的符号来分离通量贡献。\n\n从上述基本定律和定义出发，在不引用任何预先给定的特征公式的情况下，首先推导出一维欧拉方程的特征波速以及理想气体的声速 $a$ 关于 $\\gamma$、$p$ 和 $\\rho$ 的表达式。然后，对于给定的均匀状态 $(\\rho, u, p) = (1.0, 0.3, 1.0)$ 和 $\\gamma = 1.4$，数值计算声速 $a$ 以及三个特征速度 $u - a$、 $u$ 和 $u + a$。假设变量是无量纲的，因此不需要物理单位。将您的数值答案四舍五入到六位有效数字。以单行矩阵的形式报告您的最终答案，顺序为 $[a,\\ u - a,\\ u,\\ u + a]$。", "solution": "该问题要求推导一维欧拉方程的特征波速和理想气体的声速表达式，然后对特定状态进行数值评估。步骤如下。\n\n首先，我们推导系统的特征速度。一维欧拉方程的守恒形式由下式给出：\n$$ \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0 $$\n其中 $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 是守恒变量向量，$\\mathbf{F} = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$ 是通量向量。变量包括密度 $\\rho$、速度 $u$、单位体积总能量 $E$ 和压力 $p$。该系统由理想气体状态方程 $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$ 封闭，其中 $\\gamma$ 是比热比。\n\n特征波速是通量雅可比矩阵 $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ 的特征值。直接计算此雅可比矩阵在代数上是繁重的。一种更系统的方法是使用原始变量向量（例如 $\\mathbf{W} = (\\rho, u, p)^{\\mathsf{T}}$）将方程转换为拟线性形式。\n\n使用链式法则，欧拉方程可以写为：\n$$ \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0 $$\n令 $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ 和 $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$。方程变为 $\\mathbf{M} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$。左乘 $\\mathbf{M}^{-1}$ 得到拟线性形式 $\\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{M}^{-1}\\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$。特征速度 $\\lambda$ 是矩阵 $\\mathbf{A} = \\mathbf{M}^{-1}\\mathbf{B}$ 的特征值，也就是广义特征值问题 $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$ 的根。\n\n我们来计算矩阵 $\\mathbf{M}$ 和 $\\mathbf{B}$。首先，我们将守恒变量 $\\mathbf{U}$ 用原始变量 $\\mathbf{W}$ 表示：\n$U_1 = \\rho$\n$U_2 = \\rho u$\n$U_3 = E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$\n矩阵 $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ 为：\n$$ \\mathbf{M} = \\frac{\\partial(U_1, U_2, U_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} 1  0  0 \\\\ u  \\rho  0 \\\\ \\frac{1}{2}u^2  \\rho u  \\frac{1}{\\gamma-1} \\end{pmatrix} $$\n接下来，我们将通量向量 $\\mathbf{F}$ 用 $\\mathbf{W}$ 表示：\n$F_1 = \\rho u$\n$F_2 = \\rho u^2 + p$\n$F_3 = u(E+p) = u\\left(\\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2 + p\\right) = u\\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\\right) = \\frac{\\gamma u p}{\\gamma-1} + \\frac{1}{2}\\rho u^3$\n矩阵 $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$ 为：\n$$ \\mathbf{B} = \\frac{\\partial(F_1, F_2, F_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} u  \\rho  0 \\\\ u^2  2\\rho u  1 \\\\ \\frac{1}{2}u^3  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2  \\frac{\\gamma u}{\\gamma-1} \\end{pmatrix} $$\n现在我们求解特征方程 $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$：\n$$ \\det\\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ u^2 - \\lambda u  2\\rho u - \\lambda \\rho  1 \\\\ \\frac{1}{2}u^3 - \\frac{\\lambda}{2}u^2  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u}{\\gamma-1} - \\frac{\\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\n因式分解各项：\n$$ \\det\\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ u(u-\\lambda)  \\rho(2u - \\lambda)  1 \\\\ \\frac{u^2}{2}(u-\\lambda)  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u - \\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\n第一列中的因子 $(u-\\lambda)$ 表明我们可以将其从行列式中提取出来。这意味着一个特征值是 $\\lambda_1 = u$。\n对于 $\\lambda \\neq u$，我们可以将第一列除以 $(u-\\lambda)$（或通过列变换更正式地看到这一点）并求解剩余的行列式。一个更直接的方法是沿第一行进行代数余子式展开：\n$$ (u-\\lambda)\\left[\\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda\\rho u\\right)\\right] - \\rho\\left[u(u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}(u-\\lambda)\\right] = 0 $$\n提取公因式 $(u-\\lambda)$：\n$$ (u-\\lambda)\\left\\{\\left[\\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{\\gamma p}{\\gamma-1} - \\frac{3}{2}\\rho u^2 + \\lambda\\rho u\\right] - \\rho\\left[u\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}\\right]\\right\\} = 0 $$\n对于 $\\lambda \\neq u$，大括号中的表达式必须为零。我们来展开并简化这个表达式：\n$$ \\frac{\\rho}{\\gamma-1}(2u-\\lambda)(\\gamma u-\\lambda) - \\frac{\\gamma p}{\\gamma-1} - \\frac{3}{2}\\rho u^2 + \\lambda\\rho u - \\frac{\\rho u}{\\gamma-1}(\\gamma u-\\lambda) + \\frac{1}{2}\\rho u^2 = 0 $$\n将各项按 $\\lambda$ 的幂次重新组合，我们得到一个关于 $\\lambda$ 的二次方程 $A\\lambda^2 + B\\lambda + C = 0$。\n- $\\lambda^2$ 的系数为 $A = \\rho$。\n- $\\lambda$ 的系数为 $B = \\frac{\\rho}{\\gamma-1}(-2u - \\gamma u) - \\rho u \\frac{-\\lambda}{\\gamma-1} + \\lambda\\rho u = \\dots = -2\\rho u$。为简化，直接收集原式中 $\\lambda$ 的系数：来自 $\\rho(2u-\\lambda)(\\gamma u-\\lambda)$ 的是 $-\\rho(2+\\gamma)u$；来自 $\\lambda\\rho u(\\gamma-1)$ 的是 $\\rho u(\\gamma-1)$；来自 $-\\rho u(\\gamma u-\\lambda)$ 的是 $\\rho u$。总和为 $-\\rho(2+\\gamma)u + \\rho u(\\gamma-1) + \\rho u = \\rho u (-2-\\gamma+\\gamma-1+1) = -2\\rho u$。\n- 常数项 $C$ 为 $\\frac{2\\rho\\gamma u^2}{\\gamma-1} - \\frac{\\gamma p}{\\gamma-1} - \\frac{3}{2}\\rho u^2 - \\frac{\\rho\\gamma u^2}{\\gamma-1} + \\frac{1}{2}\\rho u^2 = \\dots = \\rho u^2 - \\gamma p$。\n剩余特征值的方程简化为：\n$$ \\rho\\lambda^2 - 2\\rho u \\lambda + (\\rho u^2 - \\gamma p) = 0 $$\n除以 $\\rho$（非零）：\n$$ \\lambda^2 - 2u\\lambda + u^2 - \\frac{\\gamma p}{\\rho} = 0 $$\n$$ (\\lambda - u)^2 = \\frac{\\gamma p}{\\rho} $$\n$$ \\lambda - u = \\pm\\sqrt{\\frac{\\gamma p}{\\rho}} $$\n这给出了另外两个特征值：$\\lambda_{2,3} = u \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n\n其次，我们推导声速 $a$ 的表达式。问题将其定义为 $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$，其中导数是在恒定熵 $s$ 下计算的。对于量热完全理想气体，等熵过程遵循关系式 $p = K\\rho^\\gamma$，其中 $K$ 是常数。该关系源于热力学第一定律 $de = Tds - p d(1/\\rho)$，其中 $e$ 是比内能。对于理想气体，$e=c_v T$ 且 $p=\\rho R T$。对于等熵过程（$ds=0$），这导致 $p/\\rho^\\gamma = \\text{常数}$。\n对 $p$ 关于 $\\rho$ 求偏导数：\n$$ a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\frac{\\partial}{\\partial \\rho}(K\\rho^\\gamma) = K\\gamma\\rho^{\\gamma-1} $$\n代入 $K = p/\\rho^\\gamma$：\n$$ a^2 = \\left(\\frac{p}{\\rho^\\gamma}\\right)\\gamma\\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho} $$\n因此，声速为 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n因此，一维欧拉方程的三个特征波速为 $\\lambda_1 = u$、$\\lambda_2 = u - a$ 和 $\\lambda_3 = u + a$。\n\n第三，我们为给定的均匀状态计算这些速度：$\\rho = 1.0$，$u = 0.3$，$p = 1.0$ 和 $\\gamma = 1.4$。所有变量都是无量纲的。\n\n声速 $a$ 为：\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.183215956... $$\n四舍五入到六位有效数字，我们得到 $a \\approx 1.18322$。\n\n三个特征速度是：\n1.  $u - a = 0.3 - \\sqrt{1.4} \\approx 0.3 - 1.183215956... = -0.883215956...$\n    四舍五入到六位有效数字，$u - a \\approx -0.883216$。\n2.  $u = 0.3$。用六位有效数字表示为 $0.300000$。\n3.  $u + a = 0.3 + \\sqrt{1.4} \\approx 0.3 + 1.183215956... = 1.483215956...$\n    四舍五入到六位有效数字，$u + a \\approx 1.48322$。\n\n最终结果按 $[a,\\ u-a,\\ u,\\ u+a]$ 的顺序排列。", "answer": "$$ \\boxed{\\begin{pmatrix} 1.18322  -0.883216  0.300000  1.48322 \\end{pmatrix}} $$", "id": "3366221"}, {"introduction": "理解了特征速度后，我们便可以构建数值通量函数。本练习将经典的 Steger-Warming 通量矢量分裂格式与 Rusanov 格式进行直接比较，让你能够针对一个给定的激波管类问题，亲手计算并量化它们在处理迎风效应和引入数值耗散方面的差异。[@problem_id:3320859]", "problem": "考虑理想气体的一维可压缩欧拉方程，其比热比 $\\gamma = 1.4$。设一个界面分隔两个恒定状态，其原始变量由左状态 $(\\rho_{L}, u_{L}, p_{L}) = (\\,1.2\\,\\text{kg}\\,\\text{m}^{-3},\\, 600\\,\\text{m}\\,\\text{s}^{-1},\\, 2.0 \\times 10^{5}\\,\\text{Pa}\\,)$ 和右状态 $(\\rho_{R}, u_{R}, p_{R}) = (\\,0.8\\,\\text{kg}\\,\\text{m}^{-3},\\, 700\\,\\text{m}\\,\\text{s}^{-1},\\, 1.0 \\times 10^{5}\\,\\text{Pa}\\,)$ 给出。使用计算流体动力学中通量矢量分裂技术的第一性原理，在该界面处计算：\n- 由 Rusanov（局部 Lax–Friedrichs）数值通量产生的质量通量分量，\n- 由 Steger–Warming 通量矢量分裂产生的质量通量分量，\n然后构成标量差 $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$。\n\n在为给定状态评估 $\\Delta$ 之前，您必须从欧拉方程及其特征结构出发，并使用理想气体声速关系来证明每种数值通量构造的合理性。将最终的 $\\Delta$ 以 $\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示，并将最终答案四舍五入到五位有效数字。", "solution": "该问题要求计算和比较在两个指定流体状态之间的界面上，由两种不同的数值通量格式——Rusanov 和 Steger-Warming——产生的质量通量分量。控制方程是一维可压缩欧拉方程，其守恒形式可以写为：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0\n$$\n其中 $\\mathbf{U}$ 是守恒变量矢量，$\\mathbf{F}$ 是通量矢量。对于理想气体，它们由以下公式给出：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位体积的总能量。总能量通过理想气体的状态方程与其他变量相关：\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\n其中 $\\gamma$ 是比热比，给定为 $\\gamma = 1.4$。声速 $c$ 由下式给出：\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n问题指定了界面处的两个状态，左状态 (L) 和右状态 (R)。\n左状态：$(\\rho_L, u_L, p_L) = (1.2\\,\\text{kg}\\,\\text{m}^{-3}, 600\\,\\text{m}\\,\\text{s}^{-1}, 2.0 \\times 10^{5}\\,\\text{Pa})$。\n右状态：$(\\rho_R, u_R, p_R) = (0.8\\,\\text{kg}\\,\\text{m}^{-3}, 700\\,\\text{m}\\,\\text{s}^{-1}, 1.0 \\times 10^{5}\\,\\text{Pa})$。\n\n首先，我们为每个状态计算导出量。\n\n对于左状态 (L)：\n声速为：\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (2.0 \\times 10^5)}{1.2}} = \\sqrt{\\frac{2.8 \\times 10^5}{1.2}} \\approx 483.0459\\,\\text{m}\\,\\text{s}^{-1}\n$$\n总能量为：\n$$\nE_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{2.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(1.2)(600)^2 = 5.0 \\times 10^5 + 2.16 \\times 10^5 = 7.16 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\n状态矢量 $\\mathbf{U}_L$ 和通量矢量 $\\mathbf{F}_L$ 为：\n$$\n\\mathbf{U}_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\times 600 \\\\ 7.16 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 720 \\\\ 7.16 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_L = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ (E_L+p_L)u_L \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 1.2 \\times (600)^2 + 2.0 \\times 10^5 \\\\ (7.16 \\times 10^5 + 2.0 \\times 10^5) \\times 600 \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 6.32 \\times 10^5 \\\\ 5.496 \\times 10^8 \\end{pmatrix}\n$$\n\n对于右状态 (R)：\n声速为：\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{0.8}} = \\sqrt{1.75 \\times 10^5} \\approx 418.3300\\,\\text{m}\\,\\text{s}^{-1}\n$$\n总能量为：\n$$\nE_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(0.8)(700)^2 = 2.5 \\times 10^5 + 1.96 \\times 10^5 = 4.46 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\n状态矢量 $\\mathbf{U}_R$ 和通量矢量 $\\mathbf{F}_R$ 为：\n$$\n\\mathbf{U}_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\times 700 \\\\ 4.46 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 560 \\\\ 4.46 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_R = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ (E_R+p_R)u_R \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 0.8 \\times (700)^2 + 1.0 \\times 10^5 \\\\ (4.46 \\times 10^5 + 1.0 \\times 10^5) \\times 700 \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 4.92 \\times 10^5 \\\\ 3.822 \\times 10^8 \\end{pmatrix}\n$$\n\n现在我们可以计算数值通量了。\n\n**Steger-Warming 通量矢量分裂**\nSteger-Warming 格式根据通量雅可比矩阵 $A = \\partial \\mathbf{F} / \\partial \\mathbf{U}$ 的特征值的符号，将通量矢量 $\\mathbf{F}$ 分裂为两部分，$\\mathbf{F}^+$ 和 $\\mathbf{F}^-$。$A$ 的特征值为 $\\lambda_1 = u-c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u+c$。界面处的数值通量由下式给出：\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R)\n$$\n分裂的定义是：如果所有特征值都为正，则 $\\mathbf{F}^+ = \\mathbf{F}$ 且 $\\mathbf{F}^- = \\mathbf{0}$。如果所有特征值都为负，则 $\\mathbf{F}^+ = \\mathbf{0}$ 且 $\\mathbf{F}^- = \\mathbf{F}$。\n对于左状态，$u_L = 600$ 且 $c_L \\approx 483.05$。由于 $u_L > c_L > 0$，流场是超音速的。状态 L 的所有特征值均为正：\n$\\lambda_{1,L} = u_L - c_L > 0$\n$\\lambda_{2,L} = u_L > 0$\n$\\lambda_{3,L} = u_L + c_L > 0$\n因此，对于状态 L，分裂通量为 $\\mathbf{F}^+(\\mathbf{U}_L) = \\mathbf{F}_L$ 和 $\\mathbf{F}^-(\\mathbf{U}_L) = \\mathbf{0}$。\n\n对于右状态，$u_R = 700$ 且 $c_R \\approx 418.33$。由于 $u_R > c_R > 0$，流场也是超音速的。状态 R 的所有特征值均为正：\n$\\lambda_{1,R} = u_R - c_R > 0$\n$\\lambda_{2,R} = u_R > 0$\n$\\lambda_{3,R} = u_R + c_R > 0$\n因此，对于状态 R，分裂通量为 $\\mathbf{F}^+(\\mathbf{U}_R) = \\mathbf{F}_R$ 和 $\\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{0}$。\n\n将这些代入界面通量的公式：\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{F}_L + \\mathbf{0} = \\mathbf{F}_L\n$$\n质量通量分量 $f_{\\rho}^{\\text{SW}}$ 是 $\\mathbf{F}^{\\text{SW}}$ 的第一个分量，也就是 $\\mathbf{F}_L$ 的第一个分量：\n$$\nf_{\\rho}^{\\text{SW}} = (\\rho u)_L = 1.2 \\times 600 = 720\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**Rusanov (局部 Lax-Friedrichs) 通量**\nRusanov 通量定义为：\n$$\n\\mathbf{F}^{\\text{Rusanov}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{S_{\\max}}{2}(\\mathbf{U}_R - \\mathbf{U}_L)\n$$\n其中 $S_{\\max}$ 是界面处的最大局部信号速度，由下式给出：\n$$\nS_{\\max} = \\max(|u_L| + c_L, |u_R| + c_R)\n$$\n使用先前计算的值：\n$|u_L| + c_L = 600 + 483.0459 = 1083.0459\\,\\text{m}\\,\\text{s}^{-1}$\n$|u_R| + c_R = 700 + 418.3300 = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$\n所以，$S_{\\max} = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$。\n\n我们需要质量通量分量 $f_{\\rho}^{\\text{Rusanov}}$，它是矢量 $\\mathbf{F}^{\\text{Rusanov}}$ 的第一个分量：\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}((\\rho u)_L + (\\rho u)_R) - \\frac{S_{\\max}}{2}(\\rho_R - \\rho_L)\n$$\n代入数值：\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(720 + 560) - \\frac{1118.3300}{2}(0.8 - 1.2)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(1280) - (559.1650)( -0.4)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = 640 + 223.6660 = 863.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**差值 $\\Delta$**\n最后，我们计算差值 $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$：\n$$\n\\Delta = 863.6660 - 720 = 143.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n根据要求，将结果四舍五入到五位有效数字：\n$$\n\\Delta \\approx 143.67\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$", "answer": "$$\n\\boxed{143.67}\n$$", "id": "3320859"}, {"introduction": "简单的数值格式在精确捕捉所有类型的波结构时常常会遇到困难。本练习将介绍一种更先进的对流上游分裂方法（AUSM+），并展示其关键优势：在理想条件下能够无数值耗散地精确解析接触间断。通过亲手验证这一特性，你将深入理解“高性能”格式的设计思想，以及为何此类方法对于高保真度模拟至关重要。[@problem_id:3320913]", "problem": "考虑理想气体的一维欧拉方程，其比热比 $\\gamma = 1.4$。设一个平面界面（与计算面法线对齐，即理想对齐）两侧的左右状态表示一个纯接触间断：\n- 左状态：密度 $\\rho_{L} = 1.0$，速度 $u_{L} = 600$，压力 $p_{L} = 1.0 \\times 10^{5}$。\n- 右状态：密度 $\\rho_{R} = 0.8$，速度 $u_{R} = 600$，压力 $p_{R} = 1.0 \\times 10^{5}$。\n所有量均采用国际单位制（SI）：$\\rho$ 的单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$u$ 的单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$p$ 的单位为 $\\mathrm{Pa}$。\n\n使用平流上游分裂方法+（Advection Upstream Splitting Method Plus, AUSM+）的通量矢量分裂原理，并从欧拉通量和理想气体定律的定义出发，推导界面上的 AUSM+ 数值通量矢量 $\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(F_{1},\\,F_{2},\\,F_{3}\\right)$，其中 $F_{1}$、$F_{2}$ 和 $F_{3}$ 分别为在给定界面处计算的质量通量、动量通量和能量通量。在您的推导中，解释为什么在理想对齐和给定的接触间断条件下，AUSM+ 能够实现接触间断的精确输运。然后，计算所提供状态下 $\\left(F_{1},\\,F_{2},\\,F_{3}\\right)$ 的数值。\n\n将 $F_{1}$ 以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 表示，$F_{2}$ 以 $\\mathrm{N}\\,\\mathrm{m}^{-2}$ 表示，$F_{3}$ 以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 表示。以精确值（无需四舍五入）提供最终的数值通量矢量。", "solution": "我们从一维欧拉方程及其通量开始。对于守恒变量 $\\boldsymbol{U} = \\left(\\rho,\\,\\rho u,\\,E\\right)$，$x$ 方向的物理通量矢量为\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\left(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\right),\n$$\n其中 $E = \\rho e + \\tfrac{1}{2}\\rho u^{2}$ 是单位体积的总能量，$e$ 是单位质量的内能，理想气体定律通过以下公式关联压力和内能\n$$\np = (\\gamma - 1)\\rho e \\quad \\Rightarrow \\quad \\rho e = \\frac{p}{\\gamma - 1}.\n$$\n因此，\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}.\n$$\n\n通量矢量分裂方法通过将对流输运与声学（压力）贡献分离开，并基于马赫数相关的分裂进行信息上游化，来构造数值界面通量 $\\boldsymbol{F}^{\\mathrm{num}}$。在平流上游分裂方法+（AUSM+）中，对流量使用马赫数分裂进行上游化，声学量则以一种避免伪振荡并能在理想对齐条件下保持接触间断精确输运的方式进行分裂。\n\nAUSM+ 的一个关键特性是，当界面理想对齐（界面法线与间断法线对齐）且左右状态共享相同的速度和压力时，它能精确输运接触间断。在这种情况下，接触波以流体速度移动，且不存在声学跳跃（$p_{L} = p_{R}$）。AUSM+ 能够恢复精确的上游对流输运和界面处一致的压力：\n- 对于 $u > 0$ 的超音速流，马赫数分裂产生纯粹来自左侧的上游对流，即质量通量简化为 $m = \\rho_{L} u_{L}$，界面压力为 $p_{f} = p_{L}$，能量对流通量使用左状态的总焓 $h_{t,L} = (E_{L} + p_{L})/\\rho_{L}$，因此 $F_{3} = m h_{t,L} = u_{L}(E_{L} + p_{L})$。\n\n我们验证给定状态在两侧确实是超音速的。声速为\n$$\na = \\sqrt{\\gamma \\frac{p}{\\rho}}.\n$$\n左侧：\n$$\na_{L} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{1.0}} = \\sqrt{1.4 \\times 10^{5}}.\n$$\n右侧：\n$$\na_{R} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{0.8}} = \\sqrt{1.75 \\times 10^{5}}.\n$$\n数值上，\n$$\na_{L} = \\sqrt{140000} \\approx 374.1657387, \\quad a_{R} = \\sqrt{175000} \\approx 418.3300133.\n$$\n当 $u_{L} = u_{R} = 600$ 时，马赫数为\n$$\nM_{L} = \\frac{u_{L}}{a_{L}} \\approx \\frac{600}{374.1657387} \\approx 1.603, \\quad M_{R} = \\frac{u_{R}}{a_{R}} \\approx \\frac{600}{418.3300133} \\approx 1.435,\n$$\n两者均严格大于 $1$，证实为超音速流。\n\n对于 AUSM+，在 $u > 0$ 的超音速区域，分裂函数简化，使得界面上的整个对流输运源于左状态（纯上游），而声学（压力）部分等于左侧压力。因此，在给定的接触间断（$u_{L} = u_{R}$，$p_{L} = p_{R}$）和理想对齐条件下，AUSM+ 实现了接触间断的精确输运：\n- 精确质量通量：\n$$\nF_{1} = m = \\rho_{L} u_{L}.\n$$\n- 精确动量通量：\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L}.\n$$\n- 精确能量通量：\n$$\nF_{3} = u_{L}(E_{L} + p_{L}), \\quad \\text{其中} \\quad E_{L} = \\frac{p_{L}}{\\gamma - 1} + \\frac{1}{2}\\rho_{L} u_{L}^{2}.\n$$\n\n我们现在计算数值。\n\n计算 $E_{L}$：\n$$\nE_{L} = \\frac{1.0 \\times 10^{5}}{1.4 - 1} + \\frac{1}{2} \\cdot 1.0 \\cdot 600^{2} = \\frac{1.0 \\times 10^{5}}{0.4} + \\frac{1}{2} \\cdot 360000 = 2.5 \\times 10^{5} + 1.8 \\times 10^{5} = 4.3 \\times 10^{5}.\n$$\n然后\n$$\nE_{L} + p_{L} = 4.3 \\times 10^{5} + 1.0 \\times 10^{5} = 5.3 \\times 10^{5}.\n$$\n\n质量通量：\n$$\nF_{1} = \\rho_{L} u_{L} = 1.0 \\cdot 600 = 600.\n$$\n\n动量通量：\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L} = 1.0 \\cdot 600^{2} + 1.0 \\times 10^{5} = 360000 + 100000 = 460000.\n$$\n\n能量通量：\n$$\nF_{3} = u_{L}(E_{L} + p_{L}) = 600 \\cdot 5.3 \\times 10^{5} = 3.18 \\times 10^{8}.\n$$\n\n因此，界面上的 AUSM+ 数值通量矢量为\n$$\n\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(600,\\,460000,\\,3.18 \\times 10^{8}\\right),\n$$\n这表示在超音速区域理想对齐条件下接触间断的精确上游输运。", "answer": "$$\\boxed{\\begin{pmatrix}600  460000  3.18 \\times 10^{8}\\end{pmatrix}}$$", "id": "3320913"}]}