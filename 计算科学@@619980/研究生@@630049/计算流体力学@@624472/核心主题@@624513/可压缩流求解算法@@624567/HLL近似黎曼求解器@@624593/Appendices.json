{"hands_on_practices": [{"introduction": "本练习将抽象的 HLL 通量公式置于一个具体的数值计算背景中。通过为经典的 Sod 激波管问题计算通量，并在 Godunov 类格式下执行单步时间更新，您将直接观察到近似 Riemann 求解器如何驱动流场的演化。这个练习旨在建立对求解器与有限体积法之间相互作用的基础理解。[@problem_id:3329729]", "problem": "考虑质量、动量和总能量守恒形式的一维可压缩欧拉方程，\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0,\n$$\n其守恒变量和物理通量向量为\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix},\n$$\n以及理想气体状态方程\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right).\n$$\n其中，$\\rho$ 是密度，$u$ 是速度，$E$ 是总能量，$p$ 是压力，$\\gamma$ 是比热比。在使用分段常数重构的 Godunov 有限体积法中，网格单元 $i$ 在一个时间步 $\\Delta t$ 内的更新由守恒通量差控制，\n$$\nU_{i}^{n+1} = U_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2} - F_{i-1/2}\\right),\n$$\n其中 $F_{i\\pm 1/2}$ 是交界面 $x_{i\\pm 1/2}$ 处的数值通量，通过（近似）求解由左右相邻网格单元状态构成的黎曼问题得到。\n\n您需要使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器计算 Sod 激波管交界面处的通量 $F_{i+1/2}$，并随后更新左侧网格单元的单元平均值。该求解器通过两个边界信号速度和一个常数中间状态来模拟黎曼问题的解。波速应根据从相邻的左右状态推断出的欧拉系统的极端单侧特征速度来估计。\n\n假设使用间距为 $\\Delta x = 0.01$（无量纲单位）的均匀网格，并考虑间断正好位于 $x_{i+1/2}$ 处，因此左侧网格单元 $i$ 处于标准 Sod 左状态，右侧网格单元 $i+1$ 处于标准 Sod 右状态，具体为\n$$\n\\rho_{L} = 1, \\quad u_{L} = 0, \\quad p_{L} = 1, \\qquad \\rho_{R} = \\frac{1}{8}, \\quad u_{R} = 0, \\quad p_{R} = \\frac{1}{10},\n$$\n且 $\\gamma = \\frac{7}{5}$。使用 $\\text{CFL} = 0.5$ 的 Courant–Friedrichs–Lewy (CFL) 数，通过以下公式在交界面局部设置时间步长\n$$\n\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)},\n$$\n其中 $a = \\sqrt{\\gamma p/\\rho}$ 是每个状态下的局部声速。取网格单元 $i$ 左侧面 $x_{i-1/2}$ 处的通量 $F_{i-1/2}$ 为由两个相同的左状态构成的黎曼问题的解（这与 $t^n$ 时刻的分段常数重构一致）。\n\n使用双波 HLL 构造计算 HLL 数值通量 $F_{i+1/2}$，并对网格单元 $i$ 执行一次 Godunov 更新。报告更新后的密度 $\\rho_{i}^{n+1}$（无量纲单位）。您的最终答案必须是单个数字或单个闭式解析表达式。如果提供数值，请给出精确值，或者在无法避免近似时，四舍五入到四位有效数字。", "solution": "本题要求使用 Godunov 型有限体积法，计算一个时间步后网格单元内更新后的密度。数值通量需要使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器来求解一维欧拉方程。具体案例是 Sod 激波管问题。\n\n首先，我们根据所提供的数据确定初始状态及其属性。左状态（L，位于网格单元 $i$）和右状态（R，位于网格单元 $i+1$）以原始变量 $(\\rho, u, p)$ 的形式给出。我们使用下标 L 表示网格单元 $i$ 中的状态，下标 R 表示网格单元 $i+1$ 中的状态。\n\n左状态的给定数据：\n$\\rho_L = 1$, $u_L = 0$, $p_L = 1$。\n比热比为 $\\gamma = \\frac{7}{5}$。\n\n右状态的给定数据：\n$\\rho_R = \\frac{1}{8}$, $u_R = 0$, $p_R = \\frac{1}{10}$。\n\n基于这些数据，我们可以计算其他热力学量和状态向量。声速 $a$ 由 $a = \\sqrt{\\gamma p / \\rho}$ 给出。\n对于左状态：\n$$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(7/5) \\cdot 1}{1}} = \\sqrt{\\frac{7}{5}}$$\n单位体积总能量 $E$ 通过理想气体状态方程与压力 $p$ 相关联：$p = (\\gamma-1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$。\n对于左状态：\n$$p_L = (\\gamma - 1)\\left(E_L - \\frac{1}{2}\\rho_L u_L^2\\right) \\implies 1 = \\left(\\frac{7}{5} - 1\\right)\\left(E_L - \\frac{1}{2}(1)(0)^2\\right) \\implies 1 = \\frac{2}{5} E_L \\implies E_L = \\frac{5}{2}$$\n守恒状态向量 $U_L$ 和通量向量 $F_L$ 为：\n$$U_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix}, \\quad F(U_L) = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(E_L + p_L) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$$\n\n对于右状态：\n$$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(7/5) \\cdot (1/10)}{1/8}} = \\sqrt{\\frac{7}{5} \\cdot \\frac{8}{10}} = \\sqrt{\\frac{56}{50}} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$$\n$$p_R = (\\gamma - 1)\\left(E_R - \\frac{1}{2}\\rho_R u_R^2\\right) \\implies \\frac{1}{10} = \\left(\\frac{2}{5}\\right)\\left(E_R - \\frac{1}{2}\\left(\\frac{1}{8}\\right)(0)^2\\right) \\implies \\frac{1}{10} = \\frac{2}{5} E_R \\implies E_R = \\frac{5}{20} = \\frac{1}{4}$$\n守恒状态向量 $U_R$ 和通量向量 $F_R$ 为：\n$$U_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix}, \\quad F(U_R) = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(E_R + p_R) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix}$$\n\n接下来，我们确定数值更新的参数。时间步 $\\Delta t$ 由 CFL 条件设定：\n$$\\Delta t = \\frac{\\text{CFL}\\,\\Delta x}{\\max\\left(|u_{L}| + a_{L},\\, |u_{R}| + a_{R}\\right)}$$\n其中 $\\text{CFL} = 0.5$ 且 $\\Delta x = 0.01$。最大信号速度为：\n$$\\max\\left(|0| + \\sqrt{\\frac{7}{5}},\\, |0| + \\frac{2\\sqrt{7}}{5}\\right) = \\max\\left(\\sqrt{1.4},\\, \\sqrt{1.12}\\right) = \\sqrt{\\frac{7}{5}}$$\n因此，时间步为：\n$$\\Delta t = \\frac{0.5 \\cdot 0.01}{\\sqrt{7/5}} = \\frac{0.005}{\\sqrt{7/5}}$$\n更新所需的比率 $\\frac{\\Delta t}{\\Delta x}$ 为：\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n\nHLL 求解器需要估计黎曼扇的最左 ($S_L$) 和最右 ($S_R$) 信号速度。我们使用基于左右状态的极值特征速度 $u \\pm a$ 的估计：\n$$S_L = \\min(u_L - a_L, u_R - a_R) = \\min\\left(0 - \\sqrt{\\frac{7}{5}}, 0 - \\frac{2\\sqrt{7}}{5}\\right) = -\\sqrt{\\frac{7}{5}}$$\n$$S_R = \\max(u_L + a_L, u_R + a_R) = \\max\\left(0 + \\sqrt{\\frac{7}{5}}, 0 + \\frac{2\\sqrt{7}}{5}\\right) = \\sqrt{\\frac{7}{5}}$$\n由于 $S_L  0$ 且 $S_R > 0$，HLL 通量 $F_{i+1/2}$ 由下式给出：\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}$$\n我们来计算各项：\n$$S_R - S_L = \\sqrt{\\frac{7}{5}} - \\left(-\\sqrt{\\frac{7}{5}}\\right) = 2\\sqrt{\\frac{7}{5}}$$\n$$S_L S_R = -\\left(\\sqrt{\\frac{7}{5}}\\right)^2 = -\\frac{7}{5}$$\n$$U_R - U_L = \\begin{pmatrix} 1/8 \\\\ 0 \\\\ 1/4 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 5/2 \\end{pmatrix} = \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix}$$\n$$S_L S_R (U_R - U_L) = -\\frac{7}{5} \\begin{pmatrix} -7/8 \\\\ 0 \\\\ -9/4 \\end{pmatrix} = \\begin{pmatrix} 49/40 \\\\ 0 \\\\ 63/20 \\end{pmatrix}$$\n$$S_R F_L - S_L F_R = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\left(-\\sqrt{\\frac{7}{5}}\\right)\\begin{pmatrix} 0 \\\\ 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 1 + 1/10 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{7}{5}}\\begin{pmatrix} 0 \\\\ 11/10 \\\\ 0 \\end{pmatrix}$$\nHLL 通量表达式的分子是最后两个结果的和：\n$$\\text{Numerator} = \\begin{pmatrix} 0 \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{49}{40} \\\\ 0 \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix}$$\n除以分母 $S_R - S_L$：\n$$F_{i+1/2}^{\\text{HLL}} = \\frac{1}{2\\sqrt{7/5}} \\begin{pmatrix} \\frac{49}{40} \\\\ \\frac{11}{10}\\sqrt{\\frac{7}{5}} \\\\ \\frac{63}{20} \\end{pmatrix} = \\begin{pmatrix} \\frac{49}{80\\sqrt{7/5}} \\\\ \\frac{11}{20} \\\\ \\frac{63}{40\\sqrt{7/5}} \\end{pmatrix}$$\n网格单元 $i$ 的有限体积更新公式为：\n$$U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\n在时刻 $n$，网格单元 $i$ 的状态为 $U_i^n = U_L$。单元左交界面 $F_{i-1/2}$ 处的通量来自于黎曼问题 $(U_L, U_L)$。对于这个平凡黎曼问题，通量就是 $F(U_L) = F_L$。\n因此，$F_{i-1/2} = F_L = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n我们关心的是更新后的密度 $\\rho_i^{n+1}$，即 $U_i^{n+1}$ 的第一个分量。\n$$\\rho_i^{n+1} = (U_i^{n+1})_1 = (U_L)_1 - \\frac{\\Delta t}{\\Delta x} \\left( (F_{i+1/2}^{\\text{HLL}})_1 - (F_L)_1 \\right)$$\n代入数值：\n$$(U_L)_1 = \\rho_L = 1$$\n$$\\frac{\\Delta t}{\\Delta x} = \\frac{0.5}{\\sqrt{7/5}}$$\n$$(F_{i+1/2}^{\\text{HLL}})_1 = \\frac{49}{80\\sqrt{7/5}}$$\n$$(F_L)_1 = 0$$\n所以密度的更新方程为：\n$$\\rho_i^{n+1} = 1 - \\frac{0.5}{\\sqrt{7/5}} \\left( \\frac{49}{80\\sqrt{7/5}} - 0 \\right)$$\n$$\\rho_i^{n+1} = 1 - \\frac{0.5 \\cdot 49}{80 (\\sqrt{7/5})^2} = 1 - \\frac{24.5}{80 \\cdot (7/5)} = 1 - \\frac{24.5}{112} = 1 - \\frac{49}{224}$$\n简化分数，我们得到：\n$$\\rho_i^{n+1} = 1 - \\frac{7}{32} = \\frac{25}{32}$$\n网格单元 $i$ 中更新后的密度精确值为 $\\frac{25}{32}$。\n\n其小数形式为 0.78125。", "answer": "$$\\boxed{\\frac{25}{32}}$$", "id": "3329729"}, {"introduction": "HLL 求解器的鲁棒性在于其能够处理各种流动状态，包括超音速条件。本问题旨在探索一个关键的极限情况，即整个波结构向单一方向移动，从而展示该格式内在的迎风特性。通过分析信号速度的符号，您将深入理解 HLL 通量如何正确捕捉超音速流中信息传播的物理特性。[@problem_id:3329752]", "problem": "考虑理想气体的一维欧拉守恒形式方程，其状态向量为 $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$，其中 $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2} \\rho u^{2}$。在界面 $x = 0$ 处给定一个黎曼问题，其左侧原始状态为 $(\\rho_{L}, u_{L}, p_{L})$，右侧原始状态为 $(\\rho_{R}, u_{R}, p_{R})$。比热比为 $\\gamma = 1.4$。左、右两侧的状态分别为\n- $(\\rho_{L}, u_{L}, p_{L}) = (1.0, 500, 1.0 \\times 10^{5})$，\n- $(\\rho_{R}, u_{R}, p_{R}) = (0.9, 450, 0.8 \\times 10^{5})$，\n其中 $\\rho$ 的单位是 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$u$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$p$ 的单位是 $\\mathrm{Pa}$。各状态下的理想气体声速为 $a = \\sqrt{\\gamma p / \\rho}$。\n\n基于各状态下最快的左行和右行声波，为信号速度设定物理上合理的界限：\n$$\nS_{L} = \\min\\!\\big(u_{L} - a_{L},\\, u_{R} - a_{R}\\big), \\qquad\nS_{R} = \\max\\!\\big(u_{L} + a_{L},\\, u_{R} + a_{R}\\big).\n$$\n\n使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器，从一个由波 $x = S_{L} t$ 和 $x = S_{R} t$ 界定的时空控制体上的积分守恒形式出发，并假设这些波之间存在一个单一的常数中间状态。推导界面数值通量 $F_{\\mathrm{HLL}}$ 在由 $S_{L}$ 和 $S_{R}$ 符号划分的三个区域中的表达式。然后，对于给定的数据，确定 $S_{L} \\ge 0$ 或 $S_{R} \\le 0$ 是否成立，识别生效区域，并计算界面处的 x 方向动量通量分量 $\\big(F_{\\mathrm{HLL}}\\big)_{2}$。根据您的符号评估，简要讨论其对界面处超音速入流或出流的意义。\n\n将 $\\big(F_{\\mathrm{HLL}}\\big)_{2}$ 的最终数值结果四舍五入至四位有效数字。以帕斯卡为单位表示最终答案。", "solution": "### HLL 数值通量的推导\nHLL 近似黎曼求解器用一个双波模型来近似黎曼问题的解。它假设解由三个常数状态（$U_L$、$U_{HLL}$、$U_R$）组成，这三个状态由两个以速度 $S_L$ 和 $S_R$ 传播的波分隔。在界面 $x=0$ 处的状态由下式给出：\n$$\nU(x, t) =\n\\begin{cases}\nU_L  \\text{若 } x/t  S_L \\\\\nU_{HLL}  \\text{若 } S_L \\le x/t \\le S_R \\\\\nU_R  \\text{若 } x/t > S_R\n\\end{cases}\n$$\n通过对左行波（速度 $S_L$）和右行波（速度 $S_R$）应用 Rankine-Hugoniot 条件，并求解得到的方程组，可以导出中间区域的恒定通量 $F_{HLL}$：\n$$\nF_{HLL} = \\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}\n$$\n此处，$F_L = F(U_L)$ 且 $F_R = F(U_R)$。在界面 $x=0$ 处的数值通量，记为 $F_{\\mathrm{HLL}}$，是该位置状态对应的通量。该状态取决于 $S_L$ 和 $S_R$ 的符号，其完整表达式为：\n$$\nF_{\\mathrm{HLL}} =\n\\begin{cases}\nF_L  \\text{若 } S_L \\ge 0 \\\\\n\\dfrac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L}  \\text{若 } S_L  0 \\text{ 且 } S_R > 0 \\\\\nF_R  \\text{若 } S_R \\le 0\n\\end{cases}\n$$\n\n### 针对给定数据的计算\n首先，我们使用 $a = \\sqrt{\\gamma p / \\rho}$ 计算左、右状态的声速。\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{1.0}} = \\sqrt{140000} \\approx 374.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (0.8 \\times 10^5)}{0.9}} = \\sqrt{\\frac{112000}{0.9}} \\approx 352.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n接下来，我们计算信号速度 $S_L$ 和 $S_R$。\n对于 $S_L$：\n$u_L - a_L = 500 - 374.166 = 125.834 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R - a_R = 450 - 352.767 = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_L = \\min(125.834, 97.233) = 97.233 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n对于 $S_R$：\n$u_L + a_L = 500 + 374.166 = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$u_R + a_R = 450 + 352.767 = 802.767 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$\nS_R = \\max(874.166, 802.767) = 874.166 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n\n### 生效区域的识别与动量通量计算\n我们已经发现 $S_L \\approx 97.233 > 0$。这对应于 HLL 通量表达式中的第一种情况。因此，生效区域是 $S_L \\ge 0$，界面处的数值通量就是左侧状态的通量：\n$$\nF_{\\mathrm{HLL}} = F_L = F(U_L)\n$$\n问题要求计算 x 方向动量通量分量，即通量向量的第二个分量 $\\big(F\\big)_{2} = \\rho u^2 + p$。我们为左侧状态计算该值。\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = \\big(F_L\\big)_{2} = \\rho_L u_L^2 + p_L\n$$\n代入给定值：\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = (1.0 \\,\\, \\mathrm{kg}\\,\\mathrm{m}^{-3})(500 \\,\\, \\mathrm{m}\\,\\mathrm{s}^{-1})^2 + (1.0 \\times 10^5 \\,\\, \\mathrm{Pa})\n$$\n$$\n\\big(F_{\\mathrm{HLL}}\\big)_{2} = 1.0 \\times 250000 + 100000 = 250000 + 100000 = 350000 \\,\\, \\mathrm{Pa}\n$$\n四舍五入到四位有效数字，结果是 $3.500 \\times 10^5 \\,\\, \\mathrm{Pa}$。\n\n### 物理意义讨论\n条件 $S_L > 0$ 意味着系统中最慢的可能信号，即相对于流动的左行声波，仍然在 x 正方向移动。左、右两个状态的物理流速都大于各自的当地声速（马赫数 $M_L \\approx 1.336 > 1$ 和 $M_R \\approx 1.276 > 1$）。两种流动都是超音速的。所有信号，包括最慢的信号（$S_L$），都从左向右传播，这意味着存在来自左侧的**超音速入流**。界面 $x=0$ 处的信息完全由上游（左侧）状态决定。下游（右侧）状态对界面处的流动条件没有因果影响。这一物理推理证明了为什么 HLL 数值通量能正确地简化为左侧状态的物理通量 $F_L$。", "answer": "$$\n\\boxed{3.500 \\times 10^{5}}\n$$", "id": "3329752"}, {"introduction": "虽然 HLL 求解器很鲁棒，但它也存在已知的缺陷，尤其是在处理接触间断时。本练习旨在通过将求解器应用于纯接触波来揭示这一局限性，您将观察到数值扩散现象。通过将 HLL 的结果与更精密的 HLLC (Harten-Lax-van Leer-Contact) 求解器的结果进行比较，您将体会到发展能够解析更广泛波动现象的多波近似 Riemann 求解器的动机。[@problem_id:3329792]", "problem": "考虑守恒形式下的一维理想气体欧拉方程，\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\n其守恒变量为\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},\n$$\n通量为\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\,(E + p) \\end{pmatrix}.\n$$\n假设理想气体状态方程的比热比为 $\\,\\gamma = 1.4\\,$，因此\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\,\\rho u^{2}.\n$$\n考虑具有以下左、右状态的黎曼问题\n$$\n(\\rho_{L}, u_{L}, p_{L}) = (1,\\,1,\\,1), \\qquad (\\rho_{R}, u_{R}, p_{R}) = (0.125,\\,1,\\,1).\n$$\n因此，初始间断是一个纯接触间断：压力和速度相等，而密度不同。\n\n使用 Harten–Lax–van Leer (HLL) 近似黎曼求解器，并根据两侧的当地声速计算 Davis 型波速界，确定界面处的恒定中间状态，并展示接触间断的抹平现象。然后，使用 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器，并根据 Rankine–Hugoniot 条件确定接触波速，确定保持接触间断的界面状态。最后，以一个无量纲数的形式报告 HLL 预测的界面中间密度与 HLLC 预测的界面密度之比。将答案四舍五入至四位有效数字。", "solution": "首先，我们计算左 ($L$) 状态和右 ($R$) 状态所需的热力学和状态变量。\n声速 $a$ 由 $a = \\sqrt{\\gamma p / \\rho}$ 给出。\n对于左状态：\n$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}$。\n\n对于右状态：\n$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 1}{0.125}} = \\sqrt{1.4 \\times 8} = \\sqrt{11.2}$。\n\n接下来，我们计算守恒状态向量 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$，以及相应的通量向量 $\\boldsymbol{F}_L$ 和 $\\boldsymbol{F}_R$。\n对于左状态 $(\\rho_L, u_L, p_L) = (1, 1, 1)$：\n$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(1)(1)^2 = 2.5 + 0.5 = 3$。\n$\\boldsymbol{U}_L = \\begin{pmatrix} 1 \\\\ 1 \\\\ 3 \\end{pmatrix}$。\n$\\boldsymbol{F}_L = \\begin{pmatrix} 1 \\\\ 2 \\\\ 4 \\end{pmatrix}$。\n\n对于右状态 $(\\rho_R, u_R, p_R) = (0.125, 1, 1)$：\n$E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1}{1.4 - 1} + \\frac{1}{2}(0.125)(1)^2 = 2.5 + 0.0625 = 2.5625$。\n$\\boldsymbol{U}_R = \\begin{pmatrix} 0.125 \\\\ 0.125 \\\\ 2.5625 \\end{pmatrix}$。\n$\\boldsymbol{F}_R = \\begin{pmatrix} 0.125 \\\\ 1.125 \\\\ 3.5625 \\end{pmatrix}$。\n\n#### HLL 求解器分析\n\nHLL 求解器用两个速度为 $S_L$ 和 $S_R$ 的波来近似黎曼扇，这两个波之间包含一个单一的恒定中间状态 $\\boldsymbol{U}_{HLL}$。我们使用 Davis 型波速估计：\n$S_L = \\min(u_L - a_L, u_R - a_R) = \\min(1 - \\sqrt{1.4}, 1 - \\sqrt{11.2}) = 1 - \\sqrt{11.2}$。\n$S_R = \\max(u_L + a_L, u_R + a_R) = \\max(1 + \\sqrt{1.4}, 1 + \\sqrt{11.2}) = 1 + \\sqrt{11.2}$。\n\n由于 $1  \\sqrt{11.2}$，我们有 $S_L  0$ 和 $S_R > 0$。位于 $x/t = 0$ 的界面在黎曼扇内部，该区域的状态是恒定状态 $\\boldsymbol{U}_{HLL}$，由下式给出：\n$$ \\boldsymbol{U}_{HLL} = \\frac{S_R \\boldsymbol{U}_R - S_L \\boldsymbol{U}_L - (\\boldsymbol{F}_R - \\boldsymbol{F}_L)}{S_R - S_L} $$\n我们关心的是该状态的密度分量 $\\rho_{HLL}$：\n$$ \\rho_{HLL} = \\frac{S_R \\rho_R - S_L \\rho_L - ((\\rho u)_R - (\\rho u)_L)}{S_R - S_L} $$\n代入已知值：\n分母为 $S_R - S_L = (1 + \\sqrt{11.2}) - (1 - \\sqrt{11.2}) = 2\\sqrt{11.2}$。\n分子为：\n$N = (1 + \\sqrt{11.2})(0.125) - (1 - \\sqrt{11.2})(1) - (0.125 - 1)$\n$N = 0.125 + 0.125\\sqrt{11.2} - 1 + \\sqrt{11.2} + 0.875$\n$N = (0.125 - 1 + 0.875) + (0.125 + 1)\\sqrt{11.2} = 1.125\\sqrt{11.2}$\n因此，中间密度为：\n$$ \\rho_{HLL} = \\frac{1.125\\sqrt{11.2}}{2\\sqrt{11.2}} = \\frac{1.125}{2} = 0.5625 $$\n这个值展示了 HLL 格式固有的数值扩散或对接触间断的“抹平”效应。\n\n#### HLLC 求解器分析\n\nHLLC 求解器为接触间断增加了一个速度为 $S_*$ 的中间波。对于纯接触间断（$u_L=u_R=u$ 且 $p_L=p_R=p$），其精确解包含一个以速度 $S_* = u = 1$ 移动的单一接触波。HLLC 求解器旨在精确解析此种情况。\n\nHLLC 解包含两个中间星区状态，$\\boldsymbol{U}_{*L}$（对于 $S_L  x/t  S_*$）和 $\\boldsymbol{U}_{*R}$（对于 $S_*  x/t  S_R$）。我们有 $S_L \\approx -2.345  0$ 且 $S_* = 1 > 0$。位于 $x/t=0$ 的界面处于左星区，即 $S_L  0  S_*$。因此，界面上的状态为 $\\boldsymbol{U}_{*L}$。该区域的密度 $\\rho_{*L}$ 由下式给出：\n$$ \\rho_{*L} = \\rho_L \\frac{S_L - u_L}{S_L - S_*} $$\n代入数值：\n$\\rho_L = 1$，$u_L = 1$，$S_L = 1 - \\sqrt{11.2}$，以及 $S_* = 1$：\n$$ \\rho_{*L} = (1) \\frac{(1 - \\sqrt{11.2}) - 1}{(1 - \\sqrt{11.2}) - 1} = \\frac{-\\sqrt{11.2}}{-\\sqrt{11.2}} = 1 $$\nHLLC 预测的界面 $x/t=0$ 处的密度为 $\\rho_{HLLC} = \\rho_{*L} = 1$。这表明 HLLC 正确地恢复了移动接触波左侧的状态，即原始的左状态。\n\n#### 最终比值\n\n问题要求计算 HLL 预测的中间密度与 HLLC 预测的界面密度之比。\n比值 $= \\frac{\\rho_{HLL}}{\\rho_{HLLC}} = \\frac{0.5625}{1} = 0.5625$。\n\n结果要求四舍五入到四位有效数字。数值 $0.5625$ 已有四位有效数字。", "answer": "$$\\boxed{0.5625}$$", "id": "3329792"}]}