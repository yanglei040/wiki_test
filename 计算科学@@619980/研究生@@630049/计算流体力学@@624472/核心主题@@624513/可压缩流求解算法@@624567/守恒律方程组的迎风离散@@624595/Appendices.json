{"hands_on_practices": [{"introduction": "迎风格式的核心思想是将双曲系统的波动分解到各自的特征方向上。在处理复杂的非线性系统（如欧拉方程）之前，掌握线性系统的特征分解是至关重要的第一步。本练习将引导你为一个简单的二维线性系统计算特征值和特征向量，并构建用于特征变换的矩阵，为理解更复杂的迎风离散化方案奠定坚实的数学基础。[@problem_id:3386349]", "problem": "考虑一维空间中的线性双曲守恒律方程组，其形式为 $U_{t}+A\\,U_{x}=0$，其中 $U(x,t)\\in\\mathbb{R}^{2}$，$A\\in\\mathbb{R}^{2\\times 2}$ 是一个常数矩阵。在方程组的迎风离散格式中，使用特征分解来解耦各个场，并沿着波的传播方向布置数值耗散。特征变换定义为 $U=R\\,W$，其中 $R$ 是由 $A$ 的右特征向量组成的矩阵，$W$ 是特征变量，对角化关系为 $A=R\\,\\Lambda\\,R^{-1}$，且 $\\Lambda=\\operatorname{diag}(\\lambda_{1},\\lambda_{2})$ 包含所有特征值。从特征值的基本定义（特征多项式 $\\det(A-\\lambda I)=0$ 的根）和右特征向量的基本定义（$(A-\\lambda I)\\,r=0$ 的非平凡解）出发，计算给定矩阵\n$$\nA=\\begin{pmatrix}\n2  1\\\\\n0  1\n\\end{pmatrix}\n$$\n的这些对象。\n将特征值排序，使得 $\\lambda_{1}>\\lambda_{2}$。为了消除尺度不确定性并使结果唯一，我们施加以下归一化约定：选择与 $\\lambda_{1}$ 相关的右特征向量 $r_{1}$，使其第一个分量为 $1$；选择与 $\\lambda_{2}$ 相关的右特征向量 $r_{2}$，使其第二个分量为 $1$。构造与对角化关系 $A=R\\,\\Lambda\\,R^{-1}$ 一致的特征矩阵 $R=[r_{1}\\;r_{2}]$ 及其逆矩阵 $R^{-1}$。\n\n将你的最终答案以一个行矩阵的形式表示为一个解析表达式，其中按顺序包含：两个特征值 $\\lambda_{1}$ 和 $\\lambda_{2}$，两个右特征向量 $r_{1}$ 和 $r_{2}$（每个均为 $2\\times 1$ 的列向量），矩阵 $R$ 和矩阵 $R^{-1}$。不需要四舍五入，也不涉及物理单位。", "solution": "该问题要求计算给定矩阵 $A$ 的特征值、特征向量以及特征矩阵 $R$ 和 $R^{-1}$。该系统由方程 $U_{t}+A\\,U_{x}=0$ 控制，其中矩阵 $A$ 定义为\n$$\nA=\\begin{pmatrix}\n2  1\\\\\n0  1\n\\end{pmatrix}.\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(A-\\lambda I)=0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n首先，我们构造矩阵 $A-\\lambda I$：\n$$\nA-\\lambda I = \\begin{pmatrix}\n2  1\\\\\n0  1\n\\end{pmatrix} - \\lambda \\begin{pmatrix}\n1  0\\\\\n0  1\n\\end{pmatrix} = \\begin{pmatrix}\n2-\\lambda  1\\\\\n0  1-\\lambda\n\\end{pmatrix}.\n$$\n该矩阵的行列式为\n$$\n\\det(A-\\lambda I) = (2-\\lambda)(1-\\lambda) - (1)(0) = (2-\\lambda)(1-\\lambda).\n$$\n令行列式为零，即 $(2-\\lambda)(1-\\lambda) = 0$，得到特征值为 $\\lambda = 2$ 和 $\\lambda = 1$。问题规定了排序约定 $\\lambda_{1} > \\lambda_{2}$。因此，我们有\n$$\n\\lambda_{1} = 2, \\quad \\lambda_{2} = 1.\n$$\n对应的特征值对角矩阵为\n$$\n\\Lambda = \\begin{pmatrix}\n\\lambda_{1}  0\\\\\n0  \\lambda_{2}\n\\end{pmatrix} = \\begin{pmatrix}\n2  0\\\\\n0  1\n\\end{pmatrix}.\n$$\n接下来，我们通过对每个特征值求解方程 $(A-\\lambda I)r=0$ 来确定右特征向量 $r_1$ 和 $r_2$。\n\n对于第一个特征值 $\\lambda_{1} = 2$，方程为 $(A-2I)r_{1}=0$：\n$$\n\\begin{pmatrix}\n2-2  1\\\\\n0  1-2\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1}\\\\\ny_{1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  1\\\\\n0  -1\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1}\\\\\ny_{1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0\\\\\n0\n\\end{pmatrix}.\n$$\n该矩阵方程可导出一个独立的方程 $y_{1}=0$。分量 $x_{1}$ 是一个自由变量。因此，对应于 $\\lambda_{1}=2$ 的任何特征向量都具有 $k \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 的形式，其中 $k$ 是任意非零标量。问题施加的归一化条件是 $r_{1}$ 的第一个分量必须为 $1$。这使得 $x_{1}=1$（且 $k=1$），从而得到唯一的特征向量\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n对于第二个特征值 $\\lambda_{2} = 1$，方程为 $(A-1I)r_{2}=0$：\n$$\n\\begin{pmatrix}\n2-1  1\\\\\n0  1-1\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{2}\\\\\ny_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  1\\\\\n0  0\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{2}\\\\\ny_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0\\\\\n0\n\\end{pmatrix}.\n$$\n该矩阵方程可导出方程 $x_{2}+y_{2}=0$，可以写成 $x_{2}=-y_{2}$。因此，对应于 $\\lambda_{2}=1$ 的任何特征向量都具有 $k \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ 的形式，其中 $k$ 是任意非零标量。问题施加的归一化条件是 $r_{2}$ 的第二个分量必须为 $1$。这使得 $y_{2}=1$（且 $k=1$），从而意味着 $x_{2}=-1$。唯一的特征向量是\n$$\nr_{2} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}.\n$$\n矩阵 $R$ 由特征向量 $r_{1}$ 和 $r_{2}$作为列构成，即 $R = [r_{1}\\;r_{2}]$：\n$$\nR = \\begin{pmatrix}\n1  -1\\\\\n0  1\n\\end{pmatrix}.\n$$\n为了求逆矩阵 $R^{-1}$，我们可以使用 $2 \\times 2$ 矩阵的求逆公式：如果 $M = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，那么 $M^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。对于矩阵 $R$，我们有 $a=1$，$b=-1$，$c=0$ 和 $d=1$。其行列式为 $\\det(R) = (1)(1) - (-1)(0) = 1$。因此逆矩阵为\n$$\nR^{-1} = \\frac{1}{1} \\begin{pmatrix}\n1  -(-1) \\\\\n-0  1\n\\end{pmatrix} = \\begin{pmatrix}\n1  1 \\\\\n0  1\n\\end{pmatrix}.\n$$\n计算得到的完整对象集包括特征值 $\\lambda_{1}=2$ 和 $\\lambda_{2}=1$，特征向量 $r_{1}=\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $r_{2}=\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$，以及矩阵 $R=\\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}$ 和 $R^{-1}=\\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1  \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}  \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}  \\begin{pmatrix} 1  -1 \\\\ 0  1 \\end{pmatrix}  \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "3386349"}, {"introduction": "从理论走向实践，构建一个完整的高分辨率迎风格式是关键的一步。本练习涵盖了从单元平均值到界面通量计算的整个过程，包括特征空间中的斜率限制和界面状态重构，这是现代激波捕捉格式的核心。通过完成这个练习，你将亲手实现一个二阶迎风格式的空间离散部分，深刻理解如何利用特征信息来控制数值振荡并提高精度。[@problem_id:3386345]", "problem": "考虑以守恒形式写出的一维可压缩欧拉方程，其状态向量为 $\\mathbf{U} = [\\rho, \\rho u, E]^\\top$，其中 $\\rho$ 是质量密度（单位为 $\\mathrm{kg\\,m^{-3}}$），$u$ 是速度（单位为 $\\mathrm{m\\,s^{-1}}$），$E$ 是总能量密度（单位为 $\\mathrm{J\\,m^{-3}}$）。控制守恒律为\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = \\mathbf{0},\n$$\n其通量函数为\n$$\n\\mathbf{F}(\\mathbf{U}) = \\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p \\\\\nu(E + p)\n\\end{bmatrix},\n$$\n以及理想气体的状态方程，\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right),\n$$\n其中 $p$ 是压力（单位为 $\\mathrm{Pa}$），$\\gamma$ 是无量纲的比热比。比焓 $H = \\frac{E + p}{\\rho}$（单位为 $\\mathrm{m^2\\,s^{-2}}$），声速 $a = \\sqrt{\\gamma p / \\rho}$（单位为 $\\mathrm{m\\,s^{-1}}$）。\n\n守恒律系统的迎风离散格式利用了通量雅可比矩阵 $\\mathbf{A}(\\mathbf{U}) = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ 的特征结构，对于一维欧拉方程，其特征值为 $u - a$、$u$ 和 $u + a$。记 $\\mathbf{R}(\\mathbf{U})$ 为其列是 $\\mathbf{A}(\\mathbf{U})$ 右特征向量的矩阵，$\\mathbf{L}(\\mathbf{U}) = \\mathbf{R}(\\mathbf{U})^{-1}$ 为相应的左特征向量矩阵。在守恒变量下，$\\mathbf{R}(\\mathbf{U})$ 的一个标准选择是\n$$\n\\mathbf{R}(\\mathbf{U}) =\n\\begin{bmatrix}\n1  1  1 \\\\\nu - a  u  u + a \\\\\nH - ua  \\tfrac{1}{2}u^2  H + ua\n\\end{bmatrix}.\n$$\n\n给定界面 $x_{i+1/2}$ 周围的相邻单元平均守恒欧拉变量，即 $\\mathbf{U}_{i-1}$、$\\mathbf{U}_i$、$\\mathbf{U}_{i+1}$ 和 $\\mathbf{U}_{i+2}$，任务是执行特征限制线性重构以获得界面上的左右状态，然后计算迎风数值通量。重构过程包括：使用 $\\mathbf{L}(\\mathbf{U})$ 将单边差分转换到特征空间，逐分量应用斜率限制器，然后用 $\\mathbf{R}(\\mathbf{U})$ 转换回来。对于单元 $i$，定义\n$$\n\\Delta \\mathbf{U}_- = \\mathbf{U}_i - \\mathbf{U}_{i-1}, \\quad \\Delta \\mathbf{U}_+ = \\mathbf{U}_{i+1} - \\mathbf{U}_i,\n$$\n$$\n\\Delta \\mathbf{w}_- = \\mathbf{L}(\\mathbf{U}_i)\\,\\Delta \\mathbf{U}_-, \\quad \\Delta \\mathbf{w}_+ = \\mathbf{L}(\\mathbf{U}_i)\\,\\Delta \\mathbf{U}_+,\n$$\n并逐分量应用限制器 $\\phi(\\cdot,\\cdot)$ 以获得受限特征斜率 $\\boldsymbol{\\phi}_i$，然后重构界面上的左状态\n$$\n\\mathbf{U}_{L,i+1/2} = \\mathbf{U}_i + \\tfrac{1}{2}\\,\\mathbf{R}(\\mathbf{U}_i)\\,\\boldsymbol{\\phi}_i.\n$$\n对于右状态，以单元 $i+1$ 为中心重复相同的步骤，\n$$\n\\Delta \\mathbf{U}_-^{(i+1)} = \\mathbf{U}_{i+1} - \\mathbf{U}_i, \\quad \\Delta \\mathbf{U}_+^{(i+1)} = \\mathbf{U}_{i+2} - \\mathbf{U}_{i+1},\n$$\n$$\n\\Delta \\mathbf{w}_-^{(i+1)} = \\mathbf{L}(\\mathbf{U}_{i+1})\\,\\Delta \\mathbf{U}_-^{(i+1)}, \\quad \\Delta \\mathbf{w}_+^{(i+1)} = \\mathbf{L}(\\mathbf{U}_{i+1})\\,\\Delta \\mathbf{U}_+^{(i+1)},\n$$\n以获得 $\\boldsymbol{\\phi}_{i+1}$，然后重构\n$$\n\\mathbf{U}_{R,i+1/2} = \\mathbf{U}_{i+1} - \\tfrac{1}{2}\\,\\mathbf{R}(\\mathbf{U}_{i+1})\\,\\boldsymbol{\\phi}_{i+1}.\n$$\n\n两种广泛使用的斜率限制器是 minmod 限制器和单调中心 (MC) 限制器，对于标量 $a$ 和 $b$ 定义如下\n$$\n\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  ab > 0, \\\\\n0,  ab \\le 0,\n\\end{cases}\n$$\n$$\n\\operatorname{MC}(a,b) = \\operatorname{minmod}\\left(\\tfrac{1}{2}(a+b), \\operatorname{minmod}(2a, 2b)\\right).\n$$\n这些定义被逐分量地应用于特征增量。\n\n一旦获得 $\\mathbf{U}_{L,i+1/2}$ 和 $\\mathbf{U}_{R,i+1/2}$，就在 $x_{i+1/2}$ 处计算一个迎风数值通量。为此，使用带有 Einfeldt 速度的 Harten–Lax–van Leer (HLLE) 通量。对于左右状态 $\\mathbf{U}_L$ 和 $\\mathbf{U}_R$ 及其对应的原始变量 $(\\rho_L,u_L,p_L)$ 和 $(\\rho_R,u_R,p_R)$ 与声速 $a_L$ 和 $a_R$，它定义了信号速度\n$$\nS_L = \\min(u_L - a_L,\\, u_R - a_R), \\quad S_R = \\max(u_L + a_L,\\, u_R + a_R),\n$$\n以及 HLLE 通量\n$$\n\\mathbf{F}_{\\mathrm{HLLE}}(\\mathbf{U}_L,\\mathbf{U}_R) = \\begin{cases}\n\\mathbf{F}(\\mathbf{U}_L),  S_L \\ge 0, \\\\\n\\mathbf{F}(\\mathbf{U}_R),  S_R \\le 0, \\\\\n\\frac{S_R \\mathbf{F}(\\mathbf{U}_L) - S_L \\mathbf{F}(\\mathbf{U}_R) + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L},  \\text{otherwise}.\n\\end{cases}\n$$\n\n在一个完整的、可运行的程序中实现上述过程。对于下面每个测试用例，给定 $\\gamma$、一个限制器选项（字符串 $\"\\mathrm{minmod}\"$ 或 $\"\\mathrm{mc}\"$），以及由国际单位制 (SI) 中的原始变量 $(\\rho,u,p)$ 指定的四个相邻单元。您必须将这些原始变量转换为守恒变量，执行特征限制和重构以获得 $\\mathbf{U}_{L,i+1/2}$ 和 $\\mathbf{U}_{R,i+1/2}$，然后计算 HLLE 通量。如果在重构过程中任何中间状态产生非物理值（即 $\\rho \\le 0$ 或 $p \\le 0$），则通过将 $\\rho$ 和 $p$ 替换为小的下限值 $\\rho_{\\min} = 10^{-12}\\ \\mathrm{kg\\,m^{-3}}$ 和 $p_{\\min} = 10^{-12}\\ \\mathrm{Pa}$ 来强制进行正定性修正，并重新计算 $E = \\frac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho u^2$ 以保持一致性。最终的通量分量需用国际单位制表示：质量通量单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$，动量通量单位为 $\\mathrm{kg\\,m^{-1}\\,s^{-2}}$，能量通量单位为 $\\mathrm{W\\,m^{-2}}$。\n\n测试套件（每个案例列出了单元 $i-1$、$i$、$i+1$、$i+2$ 的 $(\\rho,u,p)$）：\n\n- 案例 1：$\\gamma = 1.4$，限制器 $\"\\mathrm{mc}\"$，\n  - $i-1$: $(1.0, 30.0, 100000.0)$,\n  - $i$: $(1.1, 32.0, 100500.0)$,\n  - $i+1$: $(1.2, 34.0, 101000.0)$,\n  - $i+2$: $(1.3, 36.0, 101500.0)$。\n\n- 案例 2：$\\gamma = 1.4$，限制器 $\"\\mathrm{minmod}\"$ (激波管间断)，\n  - $i-1$: $(1.0, 0.0, 100000.0)$,\n  - $i$: $(1.0, 0.0, 100000.0)$,\n  - $i+1$: $(0.125, 0.0, 10000.0)$,\n  - $i+2$: $(0.125, 0.0, 10000.0)$。\n\n- 案例 3：$\\gamma = 1.4$，限制器 $\"\\mathrm{mc}\"$ (接触间断)，\n  - $i-1$: $(1.0, 100.0, 100000.0)$,\n  - $i$: $(1.0, 100.0, 100000.0)$,\n  - $i+1$: $(2.0, 100.0, 100000.0)$,\n  - $i+2$: $(2.0, 100.0, 100000.0)$。\n\n- 案例 4：$\\gamma = 1.4$，限制器 $\"\\mathrm{minmod}\"$ (近真空鲁棒性测试)，\n  - $i-1$: $(10^{-3}, 10.0, 1.0)$,\n  - $i$: $(5\\times 10^{-4}, 10.0, 0.5)$,\n  - $i+1$: $(10^{-4}, 10.0, 0.1)$,\n  - $i+2$: $(10^{-4}, 10.0, 0.1)$。\n\n- 案例 5：$\\gamma = 1.4$，限制器 $\"\\mathrm{mc}\"$ (跨音速稀疏波状构型)，\n  - $i-1$: $(1.0, -50.0, 100000.0)$,\n  - $i$: $(1.0, -20.0, 80000.0)$,\n  - $i+1$: $(1.0, 20.0, 80000.0)$,\n  - $i+2$: $(1.0, 50.0, 100000.0)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例的通量分量按 $[F_1, F_2, F_3]$（质量、动量、能量）的顺序列为一个三元列表。输出中任何地方都不能有空格。例如，格式应类似于 $[[f_{1,1},f_{1,2},f_{1,3}],[f_{2,1},f_{2,2},f_{2,3}],\\dots]$，其中每个 $f_{k,j}$ 是一个国际单位制下的浮点数。", "solution": "问题陈述经过了仔细验证，并被确定为 **有效的**。它基于计算流体力学的原理，具有科学依据，是一个带有清晰且确定性算法流程的适定问题，并且其表述是客观的。该问题提供了继续进行所需的所有信息，因为左特征向量矩阵 $\\mathbf{L}(\\mathbf{U})$ 被唯一地定义为所提供的右特征向量矩阵 $\\mathbf{R}(\\mathbf{U})$ 的逆矩阵。因此，我们可以进行完整的求解。\n\n任务是为一维欧拉方程计算在单元界面 $x_{i+1/2}$ 处的 Harten–Lax–van Leer-Einfeldt (HLLE) 数值通量。这需要一个涉及基于特征的斜率限制的状态重构的多步流程。每个测试用例的总体算法如下：\n1. 将模板中四个单元（$i-1, i, i+1, i+2$）的初始单元平均原始变量 $(\\rho, u, p)$ 转换为守恒变量 $\\mathbf{U} = [\\rho, \\rho u, E]^\\top$。\n2. 使用以单元 $i$ 为中心的特征限制线性近似，重构界面左侧的状态向量 $\\mathbf{U}_{L,i+1/2}$。\n3. 使用以单元 $i+1$ 为中心的类似近似，重构界面右侧的状态向量 $\\mathbf{U}_{R,i+1/2}$。\n4. 对重构的左右状态应用正定性保持修正，以确保物理可实现性（$\\rho > 0, p > 0$）。\n5. 使用最终的左右界面状态计算 HLLE 数值通量 $\\mathbf{F}_{\\mathrm{HLLE}}$。\n\n我们现在将详细说明这些步骤中的每一步。\n\n**1. 状态变量与转换**\n\n流体的状态由守恒变量向量 $\\mathbf{U} = [\\rho, \\rho u, E]^\\top$ 描述，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位体积的总能量。控制欧拉方程由 $\\mathbf{U}$ 及其对应的通量向量 $\\mathbf{F}(\\mathbf{U})$ 给出。\n\n通常，使用原始变量 $(\\rho, u, p)$ 更为方便，其中 $p$ 是压力。对于比热比为 $\\gamma$ 的理想气体，状态方程关联了这些量。\n\n要从原始变量 $(\\rho, u, p)$ 转换为守恒变量 $\\mathbf{U}$，我们计算总能量密度 $E$：\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\n则守恒向量为 $\\mathbf{U} = [\\rho, \\rho u, E]^\\top$。\n\n要从守恒变量 $\\mathbf{U} = [U_1, U_2, U_3]^\\top$ 转换回原始变量，我们有：\n$$\n\\rho = U_1\n$$\n$$\nu = \\frac{U_2}{U_1}\n$$\n$$\np = (\\gamma - 1)\\left(U_3 - \\frac{1}{2}\\frac{U_2^2}{U_1}\\right)\n$$\n这些转换是后续步骤的基础。\n\n**2. 特征分解与特征结构**\n\n重构方法的迎风性质依赖于通量雅可比矩阵 $\\mathbf{A}(\\mathbf{U}) = \\partial \\mathbf{F} / \\partial \\mathbf{U}$ 的特征分解。对于一维欧拉方程，$\\mathbf{A}(\\mathbf{U})$ 的特征值为 $\\lambda_1 = u - a$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是声速。\n\n问题提供了右特征向量矩阵 $\\mathbf{R}(\\mathbf{U})$：\n$$\n\\mathbf{R}(\\mathbf{U}) =\n\\begin{bmatrix}\n1  1  1 \\\\\nu - a  u  u + a \\\\\nH - ua  \\tfrac{1}{2}u^2  H + ua\n\\end{bmatrix}\n$$\n其中 $H = (E + p) / \\rho$ 是比焓。左特征向量矩阵 $\\mathbf{L}(\\mathbf{U})$ 定义为 $\\mathbf{R}(\\mathbf{U})$ 的逆矩阵：\n$$\n\\mathbf{L}(\\mathbf{U}) = \\mathbf{R}(\\mathbf{U})^{-1}\n$$\n这些矩阵有助于将状态变量的差分转换为特征场的差分，在特征场中可以更有效地应用斜率限制来控制振荡。对于每个重构步骤，必须使用重构模板中心单元的状态来计算这些矩阵。\n\n**3. 带斜率限制的二阶重构**\n\n为达到二阶精度，我们在每个单元内重构线性变化的状态。界面 $x_{i+1/2}$ 处的值是通过使用受限斜率对单元平均值 $\\mathbf{U}_i$ 进行外插得到的。\n\n**左状态重构 ($\\mathbf{U}_{L,i+1/2}$):**\n此重构以单元 $i$ 为中心，并使用单元 ($i-1, i, i+1$) 的模板。\n1. 计算相对于单元 $i$ 的守恒变量的“左”和“右”差分：\n   $$\n   \\Delta \\mathbf{U}_- = \\mathbf{U}_i - \\mathbf{U}_{i-1}, \\quad \\Delta \\mathbf{U}_+ = \\mathbf{U}_{i+1} - \\mathbf{U}_i\n   $$\n2. 使用在中心状态 $\\mathbf{U}_i$ 处计算的左特征向量 $\\mathbf{L}(\\mathbf{U}_i)$ 将这些差分投影到特征空间：\n   $$\n   \\Delta \\mathbf{w}_- = \\mathbf{L}(\\mathbf{U}_i)\\,\\Delta \\mathbf{U}_-, \\quad \\Delta \\mathbf{w}_+ = \\mathbf{L}(\\mathbf{U}_i)\\,\\Delta \\mathbf{U}_+\n   $$\n3. 将斜率限制器函数 $\\phi(\\cdot, \\cdot)$ 逐分量地应用于特征差分 $\\Delta \\mathbf{w}_-$ 和 $\\Delta \\mathbf{w}_+$，以获得受限的特征斜率向量 $\\boldsymbol{\\phi}_i$。指定的限制器为：\n   - Minmod: $\\operatorname{minmod}(a,b) = \\begin{cases} \\operatorname{sign}(a)\\,\\min(|a|,|b|),  ab > 0 \\\\ 0,  ab \\le 0 \\end{cases}$\n   - 单调中心 (MC): $\\operatorname{MC}(a,b) = \\operatorname{minmod}\\left(\\frac{a+b}{2}, \\operatorname{minmod}(2a, 2b)\\right)$\n4. 使用 $\\mathbf{R}(\\mathbf{U}_i)$ 将受限的特征斜率转换回守恒变量空间，并重构界面处的左状态：\n   $$\n   \\mathbf{U}_{L,i+1/2} = \\mathbf{U}_i + \\tfrac{1}{2}\\,\\mathbf{R}(\\mathbf{U}_i)\\,\\boldsymbol{\\phi}_i\n   $$\n\n**右状态重构 ($\\mathbf{U}_{R,i+1/2}$):**\n此重构以单元 $i+1$ 为中心，并使用单元 ($i, i+1, i+2$) 的模板。过程是类似的：\n1. 计算相对于单元 $i+1$ 的差分：\n   $$\n   \\Delta \\mathbf{U}_-^{(i+1)} = \\mathbf{U}_{i+1} - \\mathbf{U}_i, \\quad \\Delta \\mathbf{U}_+^{(i+1)} = \\mathbf{U}_{i+2} - \\mathbf{U}_{i+1}\n   $$\n2. 使用 $\\mathbf{L}(\\mathbf{U}_{i+1})$ 投影到特征空间：\n   $$\n   \\Delta \\mathbf{w}_-^{(i+1)} = \\mathbf{L}(\\mathbf{U}_{i+1})\\,\\Delta \\mathbf{U}_-^{(i+1)}, \\quad \\Delta \\mathbf{w}_+^{(i+1)} = \\mathbf{L}(\\mathbf{U}_{i+1})\\,\\Delta \\mathbf{U}_+^{(i+1)}\n   $$\n3. 应用限制器得到受限斜率 $\\boldsymbol{\\phi}_{i+1}$。\n4. 重构界面处的右状态。注意负号，因为我们是从单元 $i+1$ 的中心向后外插：\n   $$\n   \\mathbf{U}_{R,i+1/2} = \\mathbf{U}_{i+1} - \\tfrac{1}{2}\\,\\mathbf{R}(\\mathbf{U}_{i+1})\\,\\boldsymbol{\\phi}_{i+1}\n   $$\n\n**4. 正定性保持修正**\n\n线性重构过程可能产生非物理状态，即具有负密度或负压力的状态。如果 $\\mathbf{U}_{L,i+1/2}$ 或 $\\mathbf{U}_{R,i+1/2}$ 出现这种情况，则应用修正。首先，将状态转换为原始变量 $(\\rho, u, p)$。如果 $\\rho \\le 0$ 或 $p \\le 0$，它们将被替换为小的正下限值：$\\rho \\to \\max(\\rho, \\rho_{\\min})$ 和 $p \\to \\max(p, p_{\\min})$，其中 $\\rho_{\\min} = 10^{-12} \\, \\mathrm{kg\\,m^{-3}}$ 和 $p_{\\min} = 10^{-12} \\, \\mathrm{Pa}$。然后根据修正后的原始状态重新计算总能量 $E$，$E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$，以恢复热力学一致性。\n\n**5. HLLE 数值通量**\n\n利用界面上物理有效的左右状态 $\\mathbf{U}_L \\equiv \\mathbf{U}_{L,i+1/2}$ 和 $\\mathbf{U}_R \\equiv \\mathbf{U}_{R,i+1/2}$，我们可以计算 HLLE 通量。\n1. 计算两个状态的原始变量 $(\\rho_L, u_L, p_L)$、$(\\rho_R, u_R, p_R)$ 以及声速 $a_L$、$a_R$。\n2. 根据 Einfeldt 估算最小和最大信号速度：\n   $$\n   S_L = \\min(u_L - a_L, u_R - a_R), \\quad S_R = \\max(u_L + a_L, u_R + a_R)\n   $$\n3. 计算物理通量 $\\mathbf{F}_L = \\mathbf{F}(\\mathbf{U}_L)$ 和 $\\mathbf{F}_R = \\mathbf{F}(\\mathbf{U}_R)$。\n4. HLLE 通量由下式给出：\n   $$\n   \\mathbf{F}_{\\mathrm{HLLE}}(\\mathbf{U}_L, \\mathbf{U}_R) = \\begin{cases}\n   \\mathbf{F}_L,  \\text{if } S_L \\ge 0 \\\\\n   \\mathbf{F}_R,  \\text{if } S_R \\le 0 \\\\\n   \\frac{S_R \\mathbf{F}_L - S_L \\mathbf{F}_R + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L},  \\text{otherwise}\n   \\end{cases}\n   $$\n得到的通量向量 $\\mathbf{F}_{\\mathrm{HLLE}} = [F_1, F_2, F_3]^\\top$ 是单个测试用例的最终答案，其分量分别代表穿过界面的质量、动量和能量的数值通量。实现将对每个提供的测试用例精确地遵循这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the given CFD problem for all test cases.\n    It implements characteristic-limited reconstruction and the HLLE flux\n    for the 1D Euler equations.\n    \"\"\"\n\n    # --- Constants and Test Cases ---\n    RHO_MIN = 1e-12\n    P_MIN = 1e-12\n\n    test_cases = [\n        # Case 1: Smooth flow\n        {\n            \"gamma\": 1.4, \"limiter\": \"mc\",\n            \"cells_prim\": [\n                (1.0, 30.0, 100000.0),  # i-1\n                (1.1, 32.0, 100500.0),  # i\n                (1.2, 34.0, 101000.0),  # i+1\n                (1.3, 36.0, 101500.0),  # i+2\n            ]\n        },\n        # Case 2: Shock tube (Sod problem-like)\n        {\n            \"gamma\": 1.4, \"limiter\": \"minmod\",\n            \"cells_prim\": [\n                (1.0, 0.0, 100000.0),\n                (1.0, 0.0, 100000.0),\n                (0.125, 0.0, 10000.0),\n                (0.125, 0.0, 10000.0),\n            ]\n        },\n        # Case 3: Contact discontinuity\n        {\n            \"gamma\": 1.4, \"limiter\": \"mc\",\n            \"cells_prim\": [\n                (1.0, 100.0, 100000.0),\n                (1.0, 100.0, 100000.0),\n                (2.0, 100.0, 100000.0),\n                (2.0, 100.0, 100000.0),\n            ]\n        },\n        # Case 4: Near-vacuum test\n        {\n            \"gamma\": 1.4, \"limiter\": \"minmod\",\n            \"cells_prim\": [\n                (1e-3, 10.0, 1.0),\n                (5e-4, 10.0, 0.5),\n                (1e-4, 10.0, 0.1),\n                (1e-4, 10.0, 0.1),\n            ]\n        },\n        # Case 5: Transonic rarefaction\n        {\n            \"gamma\": 1.4, \"limiter\": \"mc\",\n            \"cells_prim\": [\n                (1.0, -50.0, 100000.0),\n                (1.0, -20.0, 80000.0),\n                (1.0, 20.0, 80000.0),\n                (1.0, 50.0, 100000.0),\n            ]\n        }\n    ]\n\n    # --- Helper Functions ---\n\n    def primitive_to_conservative(prim, gamma):\n        rho, u, p = prim\n        rho_u = rho * u\n        E = p / (gamma - 1.0) + 0.5 * rho * u**2\n        return np.array([rho, rho_u, E])\n\n    def conservative_to_primitive(U, gamma):\n        rho, rho_u, E = U\n        u = rho_u / rho\n        p = (gamma - 1.0) * (E - 0.5 * rho * u**2)\n        return np.array([rho, u, p])\n\n    def positivity_fix(U, gamma):\n        rho, u, p = conservative_to_primitive(U, gamma)\n        \n        rho_new = max(rho, RHO_MIN)\n        p_new = max(p, P_MIN)\n        \n        if rho_new != rho or p_new != p:\n            E_new = p_new / (gamma - 1.0) + 0.5 * rho_new * u**2\n            return np.array([rho_new, rho_new * u, E_new])\n        return U\n\n    def get_eigen_structures(U, gamma):\n        rho, u, p = conservative_to_primitive(U, gamma)\n        # Ensure pressure and density are physical for sound speed calculation\n        p_physical = max(p, P_MIN)\n        rho_physical = max(rho, RHO_MIN)\n\n        a = np.sqrt(gamma * p_physical / rho_physical)\n        E = U[2]\n        H = (E + p) / rho\n\n        R = np.array([\n            [1.0, 1.0, 1.0],\n            [u - a, u, u + a],\n            [H - u * a, 0.5 * u**2, H + u * a]\n        ])\n        L = np.linalg.inv(R)\n        return R, L\n\n    def minmod(a, b):\n        return 0.5 * (np.sign(a) + np.sign(b)) * np.minimum(np.abs(a), np.abs(b))\n\n    def mc_limiter(a, b):\n        return minmod(0.5 * (a + b), minmod(2.0 * a, 2.0 * b))\n\n    def apply_limiter(dw_minus, dw_plus, limiter_type):\n        if limiter_type == \"minmod\":\n            return minmod(dw_minus, dw_plus)\n        elif limiter_type == \"mc\":\n            return mc_limiter(dw_minus, dw_plus)\n        else:\n            raise ValueError(f\"Unknown limiter: {limiter_type}\")\n\n    def compute_euler_flux(U, gamma):\n        rho, u, p = conservative_to_primitive(U, gamma)\n        rho_u = U[1]\n        E = U[2]\n        return np.array([\n            rho_u,\n            rho_u * u + p,\n            u * (E + p)\n        ])\n    \n    def compute_hlle_flux(U_L, U_R, gamma):\n        # Apply positivity fix before computing flux\n        U_L = positivity_fix(U_L, gamma)\n        U_R = positivity_fix(U_R, gamma)\n\n        rho_L, u_L, p_L = conservative_to_primitive(U_L, gamma)\n        rho_R, u_R, p_R = conservative_to_primitive(U_R, gamma)\n        \n        # Ensure physical sound speed calculation\n        p_L_phys = max(p_L, P_MIN)\n        rho_L_phys = max(rho_L, RHO_MIN)\n\n        p_R_phys = max(p_R, P_MIN)\n        rho_R_phys = max(rho_R, RHO_MIN)\n\n        a_L = np.sqrt(gamma * p_L_phys / rho_L_phys)\n        a_R = np.sqrt(gamma * p_R_phys / rho_R_phys)\n        \n        S_L = min(u_L - a_L, u_R - a_R)\n        S_R = max(u_L + a_L, u_R + a_R)\n\n        F_L = compute_euler_flux(U_L, gamma)\n        F_R = compute_euler_flux(U_R, gamma)\n\n        if S_L >= 0:\n            return F_L\n        elif S_R <= 0:\n            return F_R\n        else:\n            return (S_R * F_L - S_L * F_R + S_L * S_R * (U_R - U_L)) / (S_R - S_L)\n\n    def process_case(case):\n        gamma = case[\"gamma\"]\n        limiter_type = case[\"limiter\"]\n        cells_prim = case[\"cells_prim\"]\n\n        U_im1, U_i, U_ip1, U_ip2 = [primitive_to_conservative(p, gamma) for p in cells_prim]\n\n        # --- Left State Reconstruction (at i+1/2, centered at i) ---\n        R_i, L_i = get_eigen_structures(U_i, gamma)\n        dU_minus = U_i - U_im1\n        dU_plus = U_ip1 - U_i\n        dw_minus = L_i @ dU_minus\n        dw_plus = L_i @ dU_plus\n        phi_i = apply_limiter(dw_minus, dw_plus, limiter_type)\n        U_L = U_i + 0.5 * (R_i @ phi_i)\n\n        # --- Right State Reconstruction (at i+1/2, centered at i+1) ---\n        R_ip1, L_ip1 = get_eigen_structures(U_ip1, gamma)\n        dU_minus_ip1 = U_ip1 - U_i\n        dU_plus_ip1 = U_ip2 - U_ip1\n        dw_minus_ip1 = L_ip1 @ dU_minus_ip1\n        dw_plus_ip1 = L_ip1 @ dU_plus_ip1\n        phi_ip1 = apply_limiter(dw_minus_ip1, dw_plus_ip1, limiter_type)\n        U_R = U_ip1 - 0.5 * (R_ip1 @ phi_ip1)\n\n        # --- Compute HLLE Flux ---\n        flux = compute_hlle_flux(U_L, U_R, gamma)\n        return flux\n\n    # --- Main Execution Loop ---\n    results = []\n    for case in test_cases:\n        result_flux = process_case(case)\n        results.append(result_flux)\n\n    # --- Format and Print Output ---\n    # The output format must be exact: no spaces, comma-separated lists.\n    # Ex: [[f1,f2,f3],[g1,g2,g3]]\n    inner_results_str = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_results_str)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3386345"}, {"introduction": "一个数值格式的成功不仅取决于其空间离散的精度，还取决于其时间演化的稳定性。对于显式时间推进格式，时间步长 $\\Delta t$ 必须满足CFL (Courant–Friedrichs–Lewy) 条件，以确保数值解的稳定。本练习要求你利用在迎风法中至关重要的特征波速信息，为一个二维欧拉方程求解器计算出稳定的时间步长，从而将空间离散与时间稳定性联系起来，形成一个完整的求解器设计思路。[@problem_id:3386359]", "problem": "给定单个计算网格单元及其各面上的局部二维可压缩欧拉方程数据，并计划在守恒律系统的迎风有限体积离散化中使用 Harten–Lax–van Leer–Contact (HLLC) 通量。您的任务是计算一个稳定的、满足 Courant–Friedrichs–Lewy (CFL) 条件的单元时间步长 $\\,\\Delta t\\,$，该条件基于穿过单元各面的最大投影特征速度。计算必须纯粹基于第一性原理：利用二维欧拉系统沿每个面外法线方向的特征结构来界定穿过该面的最快信息传播速度，然后汇总这些界限，从而为该单元获得一个可证明稳定的显式时间步长。\n\n仅使用以下物理和数值数据，所有数据均以国际单位制（SI 单位）表示：\n- 比热比 $\\,\\gamma\\,$（无量纲）。\n- Courant–Friedrichs–Lewy 数（CFL 数），记为 $\\,\\mathrm{CFL}\\,$（无量纲）。\n- 单元度量 $\\,V\\,$，对于二维计算，即为单元面积，单位为平方米（$\\mathrm{m}^2$）。\n- 对于单元的每个面 $\\,f\\,$：\n  - 面度量 $\\,A_f\\,$，对于二维计算，即为面的长度，单位为米（$\\mathrm{m}$）。\n  - 外向き单位法向量 $\\,\\mathbf{n}_f = (n_x,n_y)\\,$。\n  - 面在单元一侧的左状态 $\\,(\\rho_L, u_L, v_L, p_L)\\,$，其中密度单位为千克/立方米（$\\mathrm{kg}/\\mathrm{m}^3$），速度分量单位为米/秒（$\\mathrm{m}/\\mathrm{s}$），压力单位为帕斯卡（$\\mathrm{Pa}$）。\n  - 面在相邻单元一侧的右状态 $\\,(\\rho_R, u_R, v_R, p_R)\\,$，单位相同。\n\n科学和数值要求：\n- 您的推理应基于二维可压缩欧拉方程的守恒形式以及该系统的双曲特性。使用沿 $\\,\\mathbf{n}_f\\,$ 投影的通量雅可比矩阵的特征值来确定垂直于每个面的特征速度。\n- 对于每个面，使用一个与 HLLC 构造一致的、对最快左行和右行信号的稳健且物理上合理的界限，来确定穿过该面的特征速度的最大量值。\n- 综合所有面的贡献，以获得该单元的稳定显式时间步长，单位为秒（$\\mathrm{s}$）。将每个得到的 $\\,\\Delta t\\,$ 值表示为四舍五入到十位小数的浮点数。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如“[result1,result2,result3]”。列表中的条目必须是每个测试用例的稳定时间步长 $\\,\\Delta t\\,$（单位为秒），并精确到小数点后十位。\n\n测试套件：\n为以下四个案例中的每一个提供计算出的 $\\,\\Delta t\\,$。在所有案例中，法向量均为外向き单位向量。\n\n1) 正常情况下的亚音速/超音速混合方向：\n- $\\,\\gamma = 1.4\\,$, $\\,\\mathrm{CFL} = 0.5\\,$, $\\,V = 1.0\\,\\mathrm{m}^2\\,$.\n- 面：\n  - 东面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,100.0,0.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (0.8,150.0,0.0,80000.0)\\,$.\n  - 西面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (-1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,100.0,0.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,50.0,0.0,120000.0)\\,$.\n  - 北面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,100.0,0.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.2,100.0,20.0,110000.0)\\,$.\n  - 南面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,-1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,100.0,0.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (0.9,100.0,-10.0,90000.0)\\,$.\n\n2) 纯声学平衡状态：\n- $\\,\\gamma = 1.4\\,$, $\\,\\mathrm{CFL} = 0.9\\,$, $\\,V = 1.0\\,\\mathrm{m}^2\\,$.\n- 面：\n  - 东面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,0.0,0.0,200000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,0.0,0.0,200000.0)\\,$.\n  - 西面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (-1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,0.0,0.0,200000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,0.0,0.0,200000.0)\\,$.\n  - 北面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,0.0,0.0,200000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,0.0,0.0,200000.0)\\,$.\n  - 南面： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,-1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.0,0.0,0.0,200000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,0.0,0.0,200000.0)\\,$.\n\n3) 带有近退化面的斜向流：\n- $\\,\\gamma = 1.4\\,$, $\\,\\mathrm{CFL} = 0.4\\,$, $\\,V = 0.75\\,\\mathrm{m}^2\\,$.\n- 面：\n  - 面 1： $\\,A_f = 1.0\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.866025403784,0.5)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (0.5,300.0,100.0,50000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (0.6,320.0,80.0,60000.0)\\,$.\n  - 面 2： $\\,A_f = 0.8\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (-1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (0.5,300.0,100.0,50000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (0.4,280.0,120.0,40000.0)\\,$.\n  - 面 3： $\\,A_f = 0.000001\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,-1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (0.5,300.0,100.0,50000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (0.55,290.0,90.0,55000.0)\\,$.\n\n4) 高速单原子气体：\n- $\\,\\gamma = 1.67\\,$, $\\,\\mathrm{CFL} = 0.6\\,$, $\\,V = 0.1\\,\\mathrm{m}^2\\,$.\n- 面：\n  - 东面： $\\,A_f = 0.4\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.2,800.0,50.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.0,850.0,40.0,90000.0)\\,$.\n  - 西面： $\\,A_f = 0.4\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (-1.0,0.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.2,800.0,50.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.3,780.0,60.0,110000.0)\\,$.\n  - 北面： $\\,A_f = 0.2\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.2,800.0,50.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.1,790.0,70.0,95000.0)\\,$.\n  - 南面： $\\,A_f = 0.2\\,\\mathrm{m}\\,$, $\\,\\mathbf{n}_f = (0.0,-1.0)\\,$,\n    左状态 $\\,(\\rho_L,u_L,v_L,p_L) = (1.2,800.0,50.0,100000.0)\\,$,\n    右状态 $\\,(\\rho_R,u_R,v_R,p_R) = (1.15,810.0,30.0,105000.0)\\,$.\n\n您的程序必须为四个案例中的每一个计算出以秒为单位的 $\\,\\Delta t\\,$，并以“[dt_case1,dt_case2,dt_case3]”的格式打印单行，每个 $\\,\\Delta t\\,$ 四舍五入到十位小数。输入中不使用任何角度；所有矢量都以笛卡尔分量明确给出。输出中不涉及百分比，只有代表秒的小数浮点数。", "solution": "该问题要求计算二维可压缩欧拉方程显式有限体积离散化的稳定时间步长 $\\Delta t$。稳定性约束基于 Courant–Friedrichs–Lewy (CFL) 条件，该条件确保数值依赖域包含物理依赖域。对于给定的计算单元，这意味着时间步长必须足够小，以确保信息在单步内不会传播到相邻单元之外。\n\n控制方程为守恒形式的二维欧拉方程：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} + \\frac{\\partial \\mathbf{G}(\\mathbf{U})}{\\partial y} = 0\n$$\n其中 $\\mathbf{U}$ 是守恒变量矢量，$\\mathbf{F}$ 和 $\\mathbf{G}$ 是通量矢量：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ E \\end{pmatrix}, \\quad\n\\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ \\rho u v \\\\ u(E+p) \\end{pmatrix}, \\quad\n\\mathbf{G} = \\begin{pmatrix} \\rho v \\\\ \\rho uv \\\\ \\rho v^2 + p \\\\ v(E+p) \\end{pmatrix}\n$$\n单位体积总能量 $E$ 通过理想气体状态方程与压力 $p$、密度 $\\rho$ 和速度 $\\mathbf{u}=(u,v)$ 相关联：$E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho(u^2+v^2)$，其中 $\\gamma$ 是比热比。\n\n对于有限体积法，我们考虑在面积为 $V$ 的单元上的积分形式。单元平均状态 $\\mathbf{U}_i$ 的半离散更新为：\n$$\n\\frac{d\\mathbf{U}_i}{dt} = -\\frac{1}{V} \\sum_{f \\in \\partial i} \\mathcal{F}_f A_f\n$$\n其中求和遍历单元的所有面，$A_f$ 是面 $f$ 的长度，$\\mathcal{F}_f$ 是垂直于该面的数值通量。对于显式时间步进格式（如前向欧拉法），稳定性由系统雅可比矩阵的特征值决定。单元 $i$ 的一个充分稳定性条件由下式给出：\n$$\n\\Delta t_i \\le \\mathrm{CFL} \\cdot \\frac{V_i}{\\sum_{f \\in \\partial i} S_{\\mathrm{max},f} A_f}\n$$\n在此，$\\mathrm{CFL}$ 是 Courant 数，$S_{\\mathrm{max},f}$ 是垂直于面 $f$ 的特征速度量值的上界。\n\n问题要求基于欧拉方程的特征结构和 HLLC (Harten–Lax–van Leer–Contact) 黎曼求解器的原理来确定 $S_{\\mathrm{max},f}$。穿过一个面的通量由沿该面外法线矢量 $\\mathbf{n}_f = (n_x, n_y)$ 方向的局部一维黎曼问题确定。在 $\\mathbf{n}_f$ 方向上投影的欧拉方程的特征速度（特征值）为 $u_n$、$u_n$、$u_n+a$ 和 $u_n-a$，其中 $u_n = \\mathbf{u} \\cdot \\mathbf{n}_f = u n_x + v n_y$ 是法向速度，$a = \\sqrt{\\gamma p / \\rho}$ 是声速。\n\nHLLC 求解器考虑一个面上的两个不连续状态：左状态 $(\\rho_L, u_L, v_L, p_L)$ 和右状态 $(\\rho_R, u_R, v_R, p_R)$。为确保黎曼问题产生的所有波都被捕捉，需要对最快的左行波速 ($S_L$) 和右行波速 ($S_R$) 进行稳健的估计。一个常用且可靠的选择（通常归功于 Davis）是：\n$$\nS_L = \\min(u_{n,L} - a_L, u_{n,R} - a_R)\n$$\n$$\nS_R = \\max(u_{n,L} + a_L, u_{n,R} + a_R)\n$$\n其中，对于 $K \\in \\{L, R\\}$，$u_{n,K} = u_K n_x + v_K n_y$ 且 $a_K = \\sqrt{\\gamma p_K / \\rho_K}$。穿过该面的信息传播最大信号速度就是这些波前速度绝对值的最大值，$S_{\\text{max}} = \\max(|S_L|, |S_R|)$。这可以证明等价于：\n$$\nS_{\\mathrm{max},f} = \\max(|u_{n,L}|+a_L, |u_{n,R}|+a_R)\n$$\n该表达式为界面处通量雅可比矩阵的谱半径提供了一个保守的界限，使其成为确保数值稳定性的绝佳选择。\n\n因此，计算给定单元时间步长的算法如下：\n1. 初始化分母项 $\\Sigma = 0$。\n2. 对于单元的每个面 $f$：\n    a. 确定左右状态的流体属性 $(\\rho_K, u_K, v_K, p_K)$ 以及外法线 $\\mathbf{n}_f = (n_x, n_y)$。\n    b. 计算每个状态的法向速度：$u_{n,K} = u_K n_x + v_K n_y$。\n    c. 计算每个状态的声速：$a_K = \\sqrt{\\gamma p_K / \\rho_K}$。\n    d. 找出该面的最大信号速度：$S_{\\mathrm{max},f} = \\max(|u_{n,L}|+a_L, |u_{n,R}|+a_R)$。\n    e. 将该面的贡献加到分母上：$\\Sigma = \\Sigma + A_f \\cdot S_{\\mathrm{max},f}$。\n3. 处理完所有面后，使用单元的全局数据（$\\mathrm{CFL}$ 数和面积 $V$）计算稳定时间步长：\n$$\n\\Delta t = \\frac{\\mathrm{CFL} \\cdot V}{\\Sigma}\n$$\n此过程将应用于问题描述中提供的每个测试用例。最终的数值按要求四舍五入到十位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stable time step for multiple CFD test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: Happy-path mixed subsonic/supersonic directions\n        {\n            \"gamma\": 1.4, \"CFL\": 0.5, \"V\": 1.0,\n            \"faces\": [\n                {\"A_f\": 1.0, \"n_f\": (1.0, 0.0), \"left\": (1.0, 100.0, 0.0, 100000.0), \"right\": (0.8, 150.0, 0.0, 80000.0)},\n                {\"A_f\": 1.0, \"n_f\": (-1.0, 0.0), \"left\": (1.0, 100.0, 0.0, 100000.0), \"right\": (1.0, 50.0, 0.0, 120000.0)},\n                {\"A_f\": 1.0, \"n_f\": (0.0, 1.0), \"left\": (1.0, 100.0, 0.0, 100000.0), \"right\": (1.2, 100.0, 20.0, 110000.0)},\n                {\"A_f\": 1.0, \"n_f\": (0.0, -1.0), \"left\": (1.0, 100.0, 0.0, 100000.0), \"right\": (0.9, 100.0, -10.0, 90000.0)},\n            ]\n        },\n        # Case 2: Purely acoustic balanced state\n        {\n            \"gamma\": 1.4, \"CFL\": 0.9, \"V\": 1.0,\n            \"faces\": [\n                {\"A_f\": 1.0, \"n_f\": (1.0, 0.0), \"left\": (1.0, 0.0, 0.0, 200000.0), \"right\": (1.0, 0.0, 0.0, 200000.0)},\n                {\"A_f\": 1.0, \"n_f\": (-1.0, 0.0), \"left\": (1.0, 0.0, 0.0, 200000.0), \"right\": (1.0, 0.0, 0.0, 200000.0)},\n                {\"A_f\": 1.0, \"n_f\": (0.0, 1.0), \"left\": (1.0, 0.0, 0.0, 200000.0), \"right\": (1.0, 0.0, 0.0, 200000.0)},\n                {\"A_f\": 1.0, \"n_f\": (0.0, -1.0), \"left\": (1.0, 0.0, 0.0, 200000.0), \"right\": (1.0, 0.0, 0.0, 200000.0)},\n            ]\n        },\n        # Case 3: Oblique flow with a nearly degenerate face\n        {\n            \"gamma\": 1.4, \"CFL\": 0.4, \"V\": 0.75,\n            \"faces\": [\n                {\"A_f\": 1.0, \"n_f\": (0.866025403784, 0.5), \"left\": (0.5, 300.0, 100.0, 50000.0), \"right\": (0.6, 320.0, 80.0, 60000.0)},\n                {\"A_f\": 0.8, \"n_f\": (-1.0, 0.0), \"left\": (0.5, 300.0, 100.0, 50000.0), \"right\": (0.4, 280.0, 120.0, 40000.0)},\n                {\"A_f\": 0.000001, \"n_f\": (0.0, -1.0), \"left\": (0.5, 300.0, 100.0, 50000.0), \"right\": (0.55, 290.0, 90.0, 55000.0)},\n            ]\n        },\n        # Case 4: High-speed monatomic gas\n        {\n            \"gamma\": 1.67, \"CFL\": 0.6, \"V\": 0.1,\n            \"faces\": [\n                {\"A_f\": 0.4, \"n_f\": (1.0, 0.0), \"left\": (1.2, 800.0, 50.0, 100000.0), \"right\": (1.0, 850.0, 40.0, 90000.0)},\n                {\"A_f\": 0.4, \"n_f\": (-1.0, 0.0), \"left\": (1.2, 800.0, 50.0, 100000.0), \"right\": (1.3, 780.0, 60.0, 110000.0)},\n                {\"A_f\": 0.2, \"n_f\": (0.0, 1.0), \"left\": (1.2, 800.0, 50.0, 100000.0), \"right\": (1.1, 790.0, 70.0, 95000.0)},\n                {\"A_f\": 0.2, \"n_f\": (0.0, -1.0), \"left\": (1.2, 800.0, 50.0, 100000.0), \"right\": (1.15, 810.0, 30.0, 105000.0)},\n            ]\n        },\n    ]\n\n    results = []\n    for case_data in test_cases:\n        dt = calculate_dt(case_data)\n        results.append(f\"{dt:.10f}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef calculate_dt(case_data):\n    \"\"\"\n    Computes the CFL-limited time step for a single computational cell.\n    \n    The time step is calculated based on the formula:\n    dt = CFL * V / sum(A_f * S_max_f)\n    where S_max_f = max(|u_n_L| + a_L, |u_n_R| + a_R)\n    \"\"\"\n    gamma = case_data['gamma']\n    CFL = case_data['CFL']\n    V = case_data['V']\n    faces = case_data['faces']\n\n    sum_AS_max = 0.0\n\n    for face in faces:\n        A_f = face['A_f']\n        n_f = np.array(face['n_f'])\n        \n        # Unpack left and right states\n        rho_L, u_L, v_L, p_L = face['left']\n        rho_R, u_R, v_R, p_R = face['right']\n\n        # Normal velocity for left state\n        vel_L = np.array([u_L, v_L])\n        u_n_L = np.dot(vel_L, n_f)\n        \n        # Speed of sound for left state\n        a_L = np.sqrt(gamma * p_L / rho_L)\n\n        # Normal velocity for right state\n        vel_R = np.array([u_R, v_R])\n        u_n_R = np.dot(vel_R, n_f)\n\n        # Speed of sound for right state\n        a_R = np.sqrt(gamma * p_R / rho_R)\n\n        # Maximum signal speed at the face\n        S_max_f = max(abs(u_n_L) + a_L, abs(u_n_R) + a_R)\n\n        # Accumulate the sum of (Area * Max_Speed) over all faces\n        sum_AS_max += A_f * S_max_f\n\n    # Calculate the final time step\n    if sum_AS_max > 0:\n        dt = CFL * V / sum_AS_max\n    else:\n        # This case (e.g., vacuum) would imply an infinite time step is stable.\n        dt = float('inf') \n        \n    return dt\n\nsolve()\n```", "id": "3386359"}]}