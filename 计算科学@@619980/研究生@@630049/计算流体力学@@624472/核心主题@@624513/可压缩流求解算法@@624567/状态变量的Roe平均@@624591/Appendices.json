{"hands_on_practices": [{"introduction": "为了真正理解Roe平均法的必要性，我们首先必须明白为什么更简单的方法是不足的。本练习直面此问题，通过比较两种方法：一种是数学上严谨的Roe平均，另一种是天真地对原始变量进行算术平均。通过计算这两种方法导致的波速偏差 [@problem_id:3359643]，您将具体地理解原始变量和守恒变量之间的非线性关系如何使得简单的平均法不足以构建一个自洽的线性化格式。", "problem": "考虑一维（1D）可压缩理想气体欧拉方程，比热比 $\\gamma = 1.4$。守恒变量为 $U = [\\rho, \\rho u, \\rho v, \\rho w, E]^{\\mathsf{T}}$，原始变量为 $W = [\\rho, u, v, w, p]^{\\mathsf{T}}$。变换 $U(W)$ 由以下恒等式定义：$U_{1} = \\rho$，$U_{2} = \\rho u$，$U_{3} = \\rho v$，$U_{4} = \\rho w$ 和 $U_{5} = E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2}\\rho\\left(u^{2} + v^{2} + w^{2}\\right)$（理想气体闭合关系）。\n\n给定一个具有左右两种状态的黎曼问题，流动方向沿 $x$ 轴，无横向运动：\n- 左侧状态 $W_{L}$：$\\rho_{L} = 1.0$，$u_{L} = 200$，$v_{L} = 0$，$w_{L} = 0$，$p_{L} = 100000$。\n- 右侧状态 $W_{R}$：$\\rho_{R} = 0.5$，$u_{R} = 0$，$v_{R} = 0$，$w_{R} = 0$，$p_{R} = 50000$。\n\n任务：\n1) 从欧拉守恒定律和理想气体焓关系出发，构造满足 Roe 线性化性质的 Roe 一致平均态，该状态由 Roe 平均速度 $\\tilde{u}$ 和 Roe 平均比总焓 $\\tilde{H}$ 表征。利用这些量，通过比焓和声速之间的理想气体关系计算 Roe 平均声速 $\\tilde{a}$。\n\n2) 对原始变量进行算术平均得到 $W_{\\mathrm{avg}} = \\dfrac{1}{2}(W_{L} + W_{R})$，并由此使用理想气体关系 $a = \\sqrt{\\gamma p/\\rho}$ 和平均速度 $u_{\\mathrm{avg}}$ 计算相应的声速 $a_{\\mathrm{avg}}$。\n\n3) 证明对于给定数据，平均化和变换通常不可交换，即证明 $U\\!\\left(\\dfrac{W_{L} + W_{R}}{2}\\right) \\neq \\dfrac{U(W_{L}) + U(W_{R})}{2}$，并简要解释是哪个非线性项导致了这种情况。\n\n4) 将波速偏差定义为两种平均路径预测的右行特征速度之差，\n$$\nB \\equiv \\left(u_{\\mathrm{avg}} + a_{\\mathrm{avg}}\\right) - \\left(\\tilde{u} + \\tilde{a}\\right).\n$$\n计算给定状态下的 $B$。以米/秒为单位表示最终偏差，并将答案四舍五入到四位有效数字。", "solution": "## 问题验证\n\n### 步骤 1：提取给定信息\n\n问题提供了以下信息：\n- 方程：一维可压缩理想气体欧拉方程。\n- 守恒变量：$U = [\\rho, \\rho u, \\rho v, \\rho w, E]^{\\mathsf{T}}$。\n- 原始变量：$W = [\\rho, u, v, w, p]^{\\mathsf{T}}$。\n- 变换 $U(W)$：$U_{1} = \\rho$，$U_{2} = \\rho u$，$U_{3} = \\rho v$，$U_{4} = \\rho w$ 和 $U_{5} = E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2}\\rho\\left(u^{2} + v^{2} + w^{2}\\right)$。\n- 气体常数：$\\gamma = 1.4$。\n- 左侧状态 $W_{L}$：$\\rho_{L} = 1.0$，$u_{L} = 200$，$v_{L} = 0$，$w_{L} = 0$，$p_{L} = 100000$。\n- 右侧状态 $W_{R}$：$\\rho_{R} = 0.5$，$u_{R} = 0$，$v_{R} = 0$，$w_{R} = 0$，$p_{R} = 50000$。\n- 波速偏差的定义：$B \\equiv \\left(u_{\\mathrm{avg}} + a_{\\mathrm{avg}}\\right) - \\left(\\tilde{u} + \\tilde{a}\\right)$。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据指定标准对问题进行验证：\n- **科学性**：该问题基于流体动力学的基石——欧拉方程。理想气体定律以及守恒/原始变量的定义是该领域的标准。Roe 平均法是计算流体动力学中用于构造近似黎曼求解器的一种成熟技术。所有提供的信息在科学上都是合理的。\n- **适定性**：问题提供了执行所需计算的所有必要数据和定义。每项任务都有明确的定义，并能得出唯一的数值结果。结构逻辑清晰且自成体系。\n- **客观性**：问题以精确、定量的术语陈述，没有任何主观或模糊的语言。\n- **完整性和一致性**：给定的状态和常数是完整且一致的。没有矛盾之处。\n- **真实性**：密度、速度和压力的数值对于气体动力学场景是物理上现实的（例如，隐含使用了国际单位制中的 kg/m³、m/s 和 Pa，并且是一致的）。\n\n### 步骤 3：结论与行动\n\n问题陈述是有效的。这是一个计算流体动力学中的标准、适定问题，符合所有验证标准。将提供完整解答。\n\n## 解答\n\n该问题要求针对一维气体动力学中的一个给定黎曼问题，计算并比较由两种不同平均方法得到的状态变量和波速。\n\n### 任务 1：Roe 平均态计算\n\nRoe 平均法定义了一个特定的平均状态，用波浪号 $(\\tilde{\\cdot})$ 表示，该状态可以线性化黎曼问题。Roe 平均量的构造是为了满足性质 $F(U_R) - F(U_L) = \\tilde{A}(U_R - U_L)$，其中 $\\tilde{A}$ 是在 Roe 状态下计算的通量雅可比矩阵。对于理想气体的欧拉方程，Roe 平均密度、速度分量和总焓由加权平均给出。\n\nRoe 平均密度是几何平均值：\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}}\n$$\n任何其他变量 $q$ 使用密度加权公式进行平均：\n$$\n\\tilde{q} = \\frac{\\sqrt{\\rho_{L}}q_{L} + \\sqrt{\\rho_{R}}q_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\n给定 $\\rho_L = 1.0$ 和 $\\rho_R = 0.5$，我们有 $\\sqrt{\\rho_L} = 1.0$ 和 $\\sqrt{\\rho_R} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$。\n\nRoe 平均速度 $\\tilde{u}$ 为：\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}u_{L} + \\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1.0 \\times 200 + \\frac{1}{\\sqrt{2}} \\times 0}{1.0 + \\frac{1}{\\sqrt{2}}} = \\frac{200}{1 + \\frac{1}{\\sqrt{2}}} = \\frac{200\\sqrt{2}}{\\sqrt{2}+1}\n$$\n$$\n\\tilde{u} = \\frac{200\\sqrt{2}(\\sqrt{2}-1)}{(\\sqrt{2}+1)(\\sqrt{2}-1)} = 200(2 - \\sqrt{2}) \\approx 117.1573 \\, \\text{m/s}\n$$\n为了求出 Roe 平均比总焓 $\\tilde{H}$，我们首先计算左右状态的比总焓 $H_L$ 和 $H_R$。比总焓 $H$ 定义为 $H = \\frac{E+p}{\\rho}$。对于理想气体，其表达式为 $H = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho} + \\frac{1}{2}|\\mathbf{u}|^2$。\n给定 $\\gamma = 1.4$，我们有 $\\gamma-1 = 0.4$。\n$$\nH_L = \\frac{1.4}{0.4}\\frac{p_L}{\\rho_L} + \\frac{1}{2}u_L^2 = 3.5 \\times \\frac{100000}{1.0} + \\frac{1}{2}(200)^2 = 350000 + 20000 = 370000 \\, \\text{J/kg}\n$$\n$$\nH_R = \\frac{1.4}{0.4}\\frac{p_R}{\\rho_R} + \\frac{1}{2}u_R^2 = 3.5 \\times \\frac{50000}{0.5} + \\frac{1}{2}(0)^2 = 3.5 \\times 100000 = 350000 \\, \\text{J/kg}\n$$\n现在，我们计算 $\\tilde{H}$：\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}H_{L} + \\sqrt{\\rho_{R}}H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1.0 \\times 370000 + \\frac{1}{\\sqrt{2}} \\times 350000}{1.0 + \\frac{1}{\\sqrt{2}}} = \\frac{370000\\sqrt{2} + 350000}{\\sqrt{2}+1}\n$$\n$$\n\\tilde{H} = (370000\\sqrt{2} + 350000)(\\sqrt{2}-1) = 370000 \\times 2 - 370000\\sqrt{2} + 350000\\sqrt{2} - 350000\n$$\n$$\n\\tilde{H} = 740000 - 350000 - 20000\\sqrt{2} = 390000 - 20000\\sqrt{2} \\approx 361715.73 \\, \\text{J/kg}\n$$\nRoe 平均声速 $\\tilde{a}$ 可由 Roe 平均焓和速度导出：\n$$\n\\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\n我们需要 $\\frac{1}{2}\\tilde{u}^2$：\n$$\n\\frac{1}{2}\\tilde{u}^2 = \\frac{1}{2}\\left(200(2-\\sqrt{2})\\right)^2 = \\frac{1}{2} \\times 40000 \\times (4 - 4\\sqrt{2} + 2) = 20000(6 - 4\\sqrt{2}) = 120000 - 80000\\sqrt{2}\n$$\n代入 $\\tilde{a}^2$ 的表达式中：\n$$\n\\tilde{a}^2 = 0.4 \\left( (390000 - 20000\\sqrt{2}) - (120000 - 80000\\sqrt{2}) \\right)\n$$\n$$\n\\tilde{a}^2 = 0.4 (270000 + 60000\\sqrt{2}) = 108000 + 24000\\sqrt{2}\n$$\n$$\n\\tilde{a} = \\sqrt{108000 + 24000\\sqrt{2}} \\approx 376.7508 \\, \\text{m/s}\n$$\n\n### 任务 2：算术平均态计算\n\n原始变量的算术平均值 $W_{\\mathrm{avg}} = \\frac{1}{2}(W_L + W_R)$ 计算如下：\n$$\n\\rho_{\\mathrm{avg}} = \\frac{1}{2}(\\rho_L + \\rho_R) = \\frac{1}{2}(1.0 + 0.5) = 0.75\n$$\n$$\nu_{\\mathrm{avg}} = \\frac{1}{2}(u_L + u_R) = \\frac{1}{2}(200 + 0) = 100 \\, \\text{m/s}\n$$\n$$\np_{\\mathrm{avg}} = \\frac{1}{2}(p_L + p_R) = \\frac{1}{2}(100000 + 50000) = 75000 \\, \\text{Pa}\n$$\n与此算术平均态对应的声速 $a_{\\mathrm{avg}}$ 使用理想气体的标准公式计算：\n$$\na_{\\mathrm{avg}} = \\sqrt{\\frac{\\gamma p_{\\mathrm{avg}}}{\\rho_{\\mathrm{avg}}}} = \\sqrt{\\frac{1.4 \\times 75000}{0.75}} = \\sqrt{1.4 \\times 100000} = \\sqrt{140000} = 100\\sqrt{14} \\approx 374.1657 \\, \\text{m/s}\n$$\n\n### 任务 3：平均化与变换的不可交换性\n\n我们证明从原始变量到守恒变量的变换 $U(W)$ 与算术平均不可交换。我们必须证明 $U(W_{\\mathrm{avg}}) \\neq \\frac{1}{2}(U(W_L) + U(W_R))$。\n\n首先，我们计算左右状态的守恒变量向量 $U(W_L)$ 和 $U(W_R)$。\n$E_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{100000}{0.4} + \\frac{1}{2}(1.0)(200)^2 = 250000 + 20000 = 270000$。\n$E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{50000}{0.4} + 0 = 125000$。\n所以，$U(W_L) = [1.0, 200, 0, 0, 270000]^{\\mathsf{T}}$ 且 $U(W_R) = [0.5, 0, 0, 0, 125000]^{\\mathsf{T}}$。\n\n这些守恒向量的算术平均值为：\n$$\n\\frac{1}{2}(U(W_L) + U(W_R)) = \\frac{1}{2}[1.5, 200, 0, 0, 395000]^{\\mathsf{T}} = [0.75, 100, 0, 0, 197500]^{\\mathsf{T}}\n$$\n现在，我们将算术平均后的原始状态 $W_{\\mathrm{avg}} = [0.75, 100, 0, 0, 75000]^{\\mathsf{T}}$ 变换为守恒变量 $U(W_{\\mathrm{avg}})$：\n$U_1 = \\rho_{\\mathrm{avg}} = 0.75$。\n$U_2 = \\rho_{\\mathrm{avg}} u_{\\mathrm{avg}} = 0.75 \\times 100 = 75$。\n$U_5 = E_{\\mathrm{avg}} = \\frac{p_{\\mathrm{avg}}}{\\gamma-1} + \\frac{1}{2}\\rho_{\\mathrm{avg}} u_{\\mathrm{avg}}^2 = \\frac{75000}{0.4} + \\frac{1}{2}(0.75)(100)^2 = 187500 + 3750 = 191250$。\n所以，$U(W_{\\mathrm{avg}}) = [0.75, 75, 0, 0, 191250]^{\\mathsf{T}}$。\n\n比较两个结果：\n$$\nU(W_{\\mathrm{avg}}) = [0.75, 75, 0, 0, 191250]^{\\mathsf{T}} \\neq [0.75, 100, 0, 0, 197500]^{\\mathsf{T}} = \\frac{1}{2}(U(W_L) + U(W_R))\n$$\n不等式成立。这是变换 $U(W)$ 非线性性质的直接结果。具体来说，动量（$\\rho u$）和总能量（$E$）的表达式涉及原始变量的乘积。对于任意两个状态 $W_L$ 和 $W_R$，乘积的平均值不等于平均值的乘积，例如，$\\frac{1}{2}(\\rho_L u_L + \\rho_R u_R) \\neq \\left(\\frac{\\rho_L+\\rho_R}{2}\\right)\\left(\\frac{u_L+u_R}{2}\\right)$，除非两个状态是平凡相关的。动量分量的差异为 $\\frac{1}{4}(\\rho_L u_L + \\rho_R u_R - \\rho_L u_R - \\rho_R u_L) = \\frac{1}{4}(\\rho_L - \\rho_R)(u_L - u_R)$，对于给定的数据，该值非零。\n\n### 任务 4：波速偏差计算\n\n波速偏差 $B$ 定义为两种平均方法得到的右行特征速度 $\\lambda_{\\max} = u+a$ 之差。\n$$\nB = \\left(u_{\\mathrm{avg}} + a_{\\mathrm{avg}}\\right) - \\left(\\tilde{u} + \\tilde{a}\\right)\n$$\n使用前面任务中计算出的值：\n$u_{\\mathrm{avg}} + a_{\\mathrm{avg}} = 100 + \\sqrt{140000} \\approx 100 + 374.1657 = 474.1657$ m/s.\n$\\tilde{u} + \\tilde{a} = 200(2-\\sqrt{2}) + \\sqrt{108000 + 24000\\sqrt{2}} \\approx 117.1573 + 376.7508 = 493.9081$ m/s.\n\n偏差 $B$ 为：\n$$\nB \\approx 474.1657 - 493.9081 = -19.7424 \\, \\text{m/s}\n$$\n将结果四舍五入到四位有效数字，我们得到 $B = -19.74$ m/s。", "answer": "$$\n\\boxed{-19.74}\n$$", "id": "3359643"}, {"introduction": "在确立了需要一种特殊平均方法的必要性之后，我们现在来深入探究Roe平均状态的具体性质。本练习将情景简化为等密度情况，以分离出速度和压力跳跃对平均声速的影响。通过一次目标明确的推导 [@problem_id:3359628]，您会发现Roe方法系统性地产生一个比简单算术平均值更大的声速，这是对该格式固有数值耗散来源的一个关键洞见。", "problem": "考虑一维无粘流，该流体为量热完全气体，其定比热比 $\\gamma  1$。该流动由守恒形式的可压缩欧拉方程描述，状态向量为 $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$，其中 $\\rho$ 是质量密度，$u$ 是速度，$E$ 是单位体积的总能量。热力学封闭关系由 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 给出，其中 $p$ 是压力。比总焓为 $H = \\dfrac{E + p}{\\rho} = h + \\tfrac{1}{2}u^{2}$，其中 $h$ 是热力学焓。对于量热完全气体，声速满足 $a^{2} = \\gamma p / \\rho$ 且 $h = \\dfrac{a^{2}}{\\gamma - 1}$。\n\n令 $\\boldsymbol{U}_{L}$ 和 $\\boldsymbol{U}_{R}$ 表示一个黎曼问题的左右状态。Roe 线性化旨在寻找一个常雅可比矩阵 $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$，该矩阵在一个适当平均的状态 $\\tilde{\\boldsymbol{U}}$ 下求值，使得精确的通量差满足 $\\boldsymbol{F}(\\boldsymbol{U}_{R}) - \\boldsymbol{F}(\\boldsymbol{U}_{L}) = \\boldsymbol{A}(\\tilde{\\boldsymbol{U}})\\big(\\boldsymbol{U}_{R} - \\boldsymbol{U}_{L}\\big)$，并且 $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$ 具有物理系统的特征结构。\n\n从这些基础出发，推导在何种条件下，Roe 平均原始变量会简化为特定变量的算术平均值。然后，将情况特殊化到质量密度相等，即 $\\rho_{L} = \\rho_{R} = \\rho$，但 $u_{L}$、$u_{R}$、$p_{L}$ 和 $p_{R}$ 是任意的。仅使用上述物理定律和定义，推导 Roe 平均声速与左右声速算术平均值之差的闭式表达式：\n$$\n\\Delta a \\equiv \\tilde{a} - \\frac{a_{L} + a_{R}}{2},\n$$\n该表达式用 $\\gamma$、$u_{L}$、$u_{R}$、$a_{L}$ 和 $a_{R}$ 表示。在您的推导中，讨论等式 $\\rho_{L} = \\rho_{R}$ 对 Roe 平均速度和焓的影响，并定性解释您得到的 $\\Delta a$ 结果如何影响与 Roe 型通量中声波相关的迎风耗散的大小。\n\n提供 $\\Delta a$ 的最终闭式表达式。您可以保留所有量为符号形式；不需要进行数值代入。如果进行数值计算，速度单位以米/秒表示。", "solution": "该问题陈述具有科学依据、适定且客观。它基于可压缩欧拉方程的标准形式以及计算流体力学中 Roe 近似黎曼求解器的既定原理。定义是正确的，目标是基于这些原理进行形式推导。因此，该问题是有效的，将提供一个解答。\n\nRoe 线性化的基础在于找到一个平均状态 $\\tilde{\\boldsymbol{U}}$，使得通量差性质 $\\Delta \\boldsymbol{F} = \\boldsymbol{A}(\\tilde{\\boldsymbol{U}}) \\Delta \\boldsymbol{U}$ 得以满足，其中 $\\Delta(\\cdot) = (\\cdot)_R - (\\cdot)_L$。对于量热完全气体的一维欧拉方程，这通过定义以下 Roe 平均量来实现：\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_{L} \\rho_{R}}\n$$\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}} u_{L} + \\sqrt{\\rho_{R}} u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}} H_{L} + \\sqrt{\\rho_{R}} H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\n这里，$\\tilde{\\rho}$、$\\tilde{u}$ 和 $\\tilde{H}$（比总焓）是基本的平均量。所有其他平均变量，如平均声速 $\\tilde{a}$，都由这些量导出。\n\n问题的第一部分要求找出特定 Roe 平均变量简化为算术平均值的条件。检查 $\\tilde{u}$ 和 $\\tilde{H}$ 的公式，我们可以看到它们是权重为 $\\sqrt{\\rho_{L}}$ 和 $\\sqrt{\\rho_{R}}$ 的加权平均。这些加权平均当且仅当权重相等时，才变为简单的算术平均。这在 $\\sqrt{\\rho_{L}} = \\sqrt{\\rho_{R}}$ 时发生，等价于条件 $\\rho_{L} = \\rho_{R}$。因此，对于跨间断的密度为常数的情况，Roe 平均速度和比总焓就是其各自左右状态值的简单算术平均。注意，Roe 平均密度 $\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}}$ 变为几何平均。\n\n我们现在特殊化到问题中规定的情况：$\\rho_{L} = \\rho_{R} = \\rho$。正如刚刚确立的，这个条件对 Roe 平均速度和焓有直接影响。\nRoe 平均密度变为：\n$$\n\\tilde{\\rho} = \\sqrt{\\rho \\cdot \\rho} = \\rho\n$$\nRoe 平均速度变为算术平均：\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho} u_{L} + \\sqrt{\\rho} u_{R}}{\\sqrt{\\rho} + \\sqrt{\\rho}} = \\frac{u_{L} + u_{R}}{2}\n$$\nRoe 平均比总焓也变为算术平均：\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho} H_{L} + \\sqrt{\\rho} H_{R}}{\\sqrt{\\rho} + \\sqrt{\\rho}} = \\frac{H_{L} + H_{R}}{2}\n$$\n\nRoe 平均声速 $\\tilde{a}$ 是通过平均状态变量定义的，与气体的热力学关系一致。具体来说，它由下式给出：\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^{2}\\right)\n$$\n代入常密度情况下 $\\tilde{u}$ 和 $\\tilde{H}$ 的表达式：\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left(\\frac{H_{L} + H_{R}}{2} - \\frac{1}{2}\\left(\\frac{u_{L} + u_{R}}{2}\\right)^{2}\\right)\n$$\n我们现在必须用给定的变量 $a_{L}, a_{R}, u_{L}, u_{R}$ 来表示 $H_{L}$ 和 $H_{R}$。比总焓 $H$ 通过 $H = h + \\frac{1}{2}u^{2}$ 和 $h = \\frac{a^{2}}{\\gamma-1}$ 与声速 $a$ 和速度 $u$ 相关。因此：\n$$\nH = \\frac{a^{2}}{\\gamma-1} + \\frac{1}{2}u^{2}\n$$\n将此应用于左右状态：\n$$\nH_{L} = \\frac{a_{L}^{2}}{\\gamma-1} + \\frac{1}{2}u_{L}^{2} \\quad \\text{和} \\quad H_{R} = \\frac{a_{R}^{2}}{\\gamma-1} + \\frac{1}{2}u_{R}^{2}\n$$\n将这些代入我们关于 $\\tilde{a}^{2}$ 的方程中：\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left[ \\frac{1}{2}\\left(\\left(\\frac{a_{L}^{2}}{\\gamma-1} + \\frac{1}{2}u_{L}^{2}\\right) + \\left(\\frac{a_{R}^{2}}{\\gamma-1} + \\frac{1}{2}u_{R}^{2}\\right)\\right) - \\frac{1}{8}(u_{L} + u_{R})^{2} \\right]\n$$\n现在，我们简化该表达式。\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left[ \\frac{a_{L}^{2} + a_{R}^{2}}{2(\\gamma - 1)} + \\frac{u_{L}^{2} + u_{R}^{2}}{4} - \\frac{u_{L}^{2} + 2u_{L}u_{R} + u_{R}^{2}}{8} \\right]\n$$\n将 $(\\gamma-1)$ 项分配到方括号中的第一项，并合并速度项：\n$$\n\\tilde{a}^{2} = \\frac{a_{L}^{2} + a_{R}^{2}}{2} + (\\gamma - 1)\\left[ \\frac{2(u_{L}^{2} + u_{R}^{2}) - (u_{L}^{2} + 2u_{L}u_{R} + u_{R}^{2})}{8} \\right]\n$$\n分子中的项简化为：\n$$\n2u_{L}^{2} + 2u_{R}^{2} - u_{L}^{2} - 2u_{L}u_{R} - u_{R}^{2} = u_{L}^{2} - 2u_{L}u_{R} + u_{R}^{2} = (u_{L} - u_{R})^{2}\n$$\n这给出了 Roe 平均声速平方的最终表达式：\n$$\n\\tilde{a}^{2} = \\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}\n$$\n问题要求推导 $\\Delta a = \\tilde{a} - \\frac{a_{L} + a_{R}}{2}$。对上述 $\\tilde{a}^2$ 的表达式取平方根得到 $\\tilde{a}$：\n$$\n\\tilde{a} = \\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}}\n$$\n因此，差值 $\\Delta a$ 为：\n$$\n\\Delta a = \\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}} - \\frac{a_{L} + a_{R}}{2}\n$$\n\n对于定性讨论，我们分析 $\\Delta a$ 的符号。考虑恒等式 $\\frac{a_{L}^{2} + a_{R}^{2}}{2} = \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2} + \\left(\\frac{a_{L} - a_{R}}{2}\\right)^{2}$。将其代入 $\\tilde{a}^{2}$ 的表达式中：\n$$\n\\tilde{a}^{2} = \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2} + \\left(\\frac{a_{L} - a_{R}}{2}\\right)^{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}\n$$\n由于实数的平方是非负的，且 $\\gamma  1$，右侧的所有三项都是非负的。这直接意味着 $\\tilde{a}^{2} \\geq \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2}$，并且由于声速是非负的，所以 $\\tilde{a} \\geq \\frac{a_{L} + a_{R}}{2}$。因此，$\\Delta a \\geq 0$。Roe 平均声速总是大于或等于左右声速的算术平均值。等式（$\\Delta a = 0$）成立的充要条件是 $a_{L} = a_{R}$ 且 $u_{L} = u_{R}$，在给定 $\\rho_{L}=\\rho_{R}$ 的情况下，这意味着左右状态是相同的。\n\nRoe 型通量中的数值耗散大小与 Roe 矩阵 $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$ 的特征值的大小成正比。对应于声波的特征值为 $\\tilde{\\lambda}_{1,3} = \\tilde{u} \\pm \\tilde{a}$。结果 $\\Delta a \\geq 0$ 表明，与简单的算术平均相比，Roe 平均过程通常会高估声速 $\\tilde{a}$。这个较大的 $\\tilde{a}$ 值增加了声学特征值的大小，即 $|\\tilde{u} \\pm \\tilde{a}|$。因此，与声波相关的迎风耗散增加了。这种效应是由左右状态之间的压力（反映在 $a_{L,R}$ 中）和速度差异共同驱动的。对于具有大速度差（剪切层）但密度恒定的间断，这可能会引入过多的数值粘性，导致对此类特征的抹平超过了物理上应有的程度。", "answer": "$$\n\\boxed{\\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}} - \\frac{a_{L} + a_{R}}{2}}\n$$", "id": "3359628"}, {"introduction": "计算流体力学（CFD）的理论构建最终要在实际应用中接受检验，特别是在保证数值模拟的稳定性方面。这最后一个练习搭建了从Roe平均理论到其对显式时间推进格式实际影响之间的桥梁。您将使用Roe平均波速来计算Courant-Friedrichs-Lewy (CFL) 条件所允许的最大稳定时间步长，从而展示这些平均量如何直接决定一个模拟的计算成本和可行性 [@problem_id:3359591]。", "problem": "考虑量热完全理想气体的一维可压缩欧拉方程，其比热比$\\gamma$为常数。一个使用Roe近似黎曼求解器的显式有限体积法，在Courant-Friedrichs-Lewy (CFL) 约束下对守恒变量进行时间推进。在一个间距为$\\Delta x$的均匀网格的特定单元交界面处，左、右两侧的原始状态（密度$\\rho$、速度$u$和压力$p$）分别为\n- 左侧状态：$\\rho_{L} = 1.2 \\, \\text{kg/m}^3$，$u_{L} = 50 \\, \\text{m/s}$，$p_{L} = 101325 \\, \\text{Pa}$，\n- 右侧状态：$\\rho_{R} = 0.8 \\, \\text{kg/m}^3$，$u_{R} = -30 \\, \\text{m/s}$，$p_{R} = 80000 \\, \\text{Pa}$。\n\n假设$\\gamma = 1.4$，且时间步长受此交界面限制。选择的Courant数为$0.7$，网格间距为$\\Delta x = 1.0 \\times 10^{-2} \\, \\text{m}$。利用由这些左、右状态构建的Roe线性化以及显式方法的Courant-Friedrichs-Lewy (CFL) 稳定性要求，确定最大稳定时间步长$\\Delta t_{\\max}$。\n\n最终答案以秒为单位表示，并四舍五入至四位有效数字。", "solution": "该问题要求确定使用Roe近似黎曼求解器的显式有限体积格式的最大稳定时间步长$\\Delta t_{\\max}$。此类格式的稳定性由Courant-Friedrichs-Lewy (CFL) 条件决定。对于一维欧拉方程，CFL条件规定数值依赖区域必须包含物理依赖区域。这表示为：\n$$ C = \\frac{\\Delta t}{\\Delta x} S_{\\max} \\le C_{\\max} $$\n其中$C$是Courant数，$\\Delta t$是时间步长，$\\Delta x$是网格间距，$S_{\\max}$是交界面处的最大信号速度（最快特征波的速率大小）。问题指定了Courant数$C = 0.7$。为了求得最大稳定时间步长，我们求解$\\Delta t$：\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{S_{\\max}} $$\n对于Roe求解器，最大信号速度$S_{\\max}$由Roe平均雅可比矩阵$\\tilde{A}$的特征值确定。一维欧拉方程的矩阵$\\tilde{A}$的特征值为$\\tilde{u}$、$\\tilde{u} + \\tilde{a}$和$\\tilde{u} - \\tilde{a}$，其中$\\tilde{u}$是Roe平均速度，$\\tilde{a}$是Roe平均声速。这些特征值的最大绝对值是该矩阵的谱半径，由下式给出：\n$$ S_{\\max} = \\max(|\\tilde{u}|, |\\tilde{u} + \\tilde{a}|, |\\tilde{u} - \\tilde{a}|) = |\\tilde{u}| + \\tilde{a} $$\n因此，任务简化为根据给定的左($L$)、右($R$)状态计算Roe平均量$\\tilde{u}$和$\\tilde{a}$。\n\n给定的原始变量为：\n- 左侧状态：$\\rho_{L} = 1.2 \\, \\text{kg/m}^3$，$u_{L} = 50 \\, \\text{m/s}$，$p_{L} = 101325 \\, \\text{Pa}$。\n- 右侧状态：$\\rho_{R} = 0.8 \\, \\text{kg/m}^3$，$u_{R} = -30 \\, \\text{m/s}$，$p_{R} = 80000 \\, \\text{Pa}$。\n比热比为$\\gamma = 1.4$。网格间距为$\\Delta x = 1.0 \\times 10^{-2} \\, \\text{m}$。\n\n首先，我们定义并计算Roe平均速度$\\tilde{u}$。该公式是基于密度平方根的加权平均：\n$$ \\tilde{u} = \\frac{\\sqrt{\\rho_{L}} u_{L} + \\sqrt{\\rho_{R}} u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} $$\n代入给定值：\n$$ \\tilde{u} = \\frac{\\sqrt{1.2} (50) + \\sqrt{0.8} (-30)}{\\sqrt{1.2} + \\sqrt{0.8}} \\approx \\frac{(1.095445)(50) + (0.894427)(-30)}{1.095445 + 0.894427} \\approx \\frac{54.77225 - 26.83281}{1.989872} \\approx 14.0408 \\, \\text{m/s} $$\n\n接下来，我们计算Roe平均声速$\\tilde{a}$。这是通过Roe平均比总焓$\\tilde{H}$，利用以下关系式推导得出：\n$$ \\tilde{a}^2 = (\\gamma - 1) \\left( \\tilde{H} - \\frac{1}{2} \\tilde{u}^2 \\right) $$\nRoe平均比总焓$\\tilde{H}$的定义与$\\tilde{u}$类似：\n$$ \\tilde{H} = \\frac{\\sqrt{\\rho_{L}} H_{L} + \\sqrt{\\rho_{R}} H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} $$\n其中$H_L$和$H_R$是左、右状态的比总焓。对于量热完全气体，比总焓$H$由下式给出：\n$$ H = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho} + \\frac{1}{2} u^2 $$\n我们计算$H_L$和$H_R$：\n$$ H_L = \\frac{1.4}{1.4-1} \\frac{101325}{1.2} + \\frac{1}{2} (50)^2 = \\frac{1.4}{0.4} (84437.5) + \\frac{1}{2}(2500) = 295531.25 + 1250 = 296781.25 \\, \\text{J/kg} $$\n$$ H_R = \\frac{1.4}{1.4-1} \\frac{80000}{0.8} + \\frac{1}{2} (-30)^2 = \\frac{1.4}{0.4} (100000) + \\frac{1}{2}(900) = 350000 + 450 = 350450 \\, \\text{J/kg} $$\n现在，我们可以计算$\\tilde{H}$：\n$$ \\tilde{H} = \\frac{\\sqrt{1.2} (296781.25) + \\sqrt{0.8} (350450)}{\\sqrt{1.2} + \\sqrt{0.8}} \\approx \\frac{(1.095445)(296781.25) + (0.894427)(350450)}{1.989872} \\approx \\frac{325102.39 + 313437.49}{1.989872} \\approx 320892.59 \\, \\text{J/kg} $$\n有了$\\tilde{u}$和$\\tilde{H}$，我们可以求出$\\tilde{a}$：\n$$ \\tilde{a}^2 = (1.4 - 1) \\left( 320892.59 - \\frac{1}{2} (14.0408)^2 \\right) \\approx 0.4 \\left( 320892.59 - \\frac{1}{2} (197.144) \\right) = 0.4 (320892.59 - 98.572) = 0.4(320794.018) \\approx 128317.61 $$\n$$ \\tilde{a} = \\sqrt{128317.61} \\approx 358.2145 \\, \\text{m/s} $$\n交界面处的最大信号速度为：\n$$ S_{\\max} = |\\tilde{u}| + \\tilde{a} \\approx |14.0408| + 358.2145 = 372.2553 \\, \\text{m/s} $$\n最后，我们利用CFL条件计算最大稳定时间步长$\\Delta t_{\\max}$：\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{S_{\\max}} = 0.7 \\times \\frac{1.0 \\times 10^{-2}}{372.2553} \\approx \\frac{0.007}{372.2553} \\approx 1.88044 \\times 10^{-5} \\, \\text{s} $$\n按照要求，将结果四舍五入至四位有效数字：\n$$ \\Delta t_{\\max} \\approx 1.880 \\times 10^{-5} \\, \\text{s} $$", "answer": "$$\\boxed{1.880 \\times 10^{-5}}$$", "id": "3359591"}]}