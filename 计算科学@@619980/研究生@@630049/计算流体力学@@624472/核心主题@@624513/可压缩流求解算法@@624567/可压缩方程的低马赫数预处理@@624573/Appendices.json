{"hands_on_practices": [{"introduction": "本节的实践练习将深入探讨为何标准的可压缩流求解器在低速流动中会遇到困难。我们将探究总能量（一个关键的守恒变量）在低马赫数极限下如何被不恰当地缩放，从而导致数值刚性。通过第一性原理推导和一个简单的编程练习[@problem_id:3341795]，您将发现能使能量方程保持良态的正确热力学缩放方法，并理解为何这是低马赫数预处理的一个基本概念。", "problem": "您的任务是为可压缩流的能量变量建立一套与低马赫数预处理相一致的、有原理的无量纲化和缩放方法，然后在一个简单的非等熵加热管道流模型上验证其结果。背景是计算流体动力学（CFD）中针对可压缩方程的低马赫数预处理。您的推导和程序必须是自洽的，从基本定律和核心定义出发，不假设任何专门的预处理公式。目标是展示这种缩放是什么，为什么它是正确的，以及它是如何推导出来的，从而确保当马赫数（$M$）趋于零时，能量输运项保持在$\\mathcal{O}(1)$量级。\n\n从理想气体的守恒形式可压缩Navier–Stokes方程和理想气体定律开始。使用以下基本定义和事实：\n- 理想气体定律 $p=\\rho R T$，其中 $p$ 是压力，$\\rho$ 是密度，$R$ 是比气体常数，$T$ 是温度。\n- 比热满足 $c_p-c_v=R$，其中 $c_p=\\dfrac{\\gamma R}{\\gamma-1}$ 和 $c_v=\\dfrac{R}{\\gamma-1}$，$\\gamma$ 是比热比。\n- 声速为 $a=\\sqrt{\\gamma R T}$，马赫数为 $M=\\dfrac{U}{a_{\\mathrm{ref}}}$，其中 $U$ 是特征速度，$a_{\\mathrm{ref}}=\\sqrt{\\gamma R T_{\\mathrm{ref}}}$ 是参考温度 $T_{\\mathrm{ref}}$ 下的参考声速。\n- 静焓为 $h=c_p T$，内能为 $e=c_v T$，单位质量总能量为 $E=e+\\dfrac{1}{2}\\lvert\\mathbf{u}\\rvert^2$，单位质量总焓为 $H=h+\\dfrac{1}{2}\\lvert\\mathbf{u}\\rvert^2$。\n- 在沿 $x$ 轴的一维稳态管道流中，采用平推流速度 $u=U$，能量对流通量的形式为 $\\rho u H$。\n\n您的任务是：\n1. 推导任务。从上述基础出发，为 $h$ 和 $E$ 推导出一个一致的缩放和无量纲化方法，该方法与低马赫数预处理兼容，并能得到一个当 $M\\to 0$ 时保持在 $\\mathcal{O}(1)$ 量级的能量输运项。您必须从第一性原理出发进行推理，解释为什么选择适当的参考尺度以及这些尺度如何从控制方程中得出。您可以假设预处理概念会重新缩放热力学刚性以平衡声学和对流的贡献，但不要在问题陈述中引入任何未经证明的目标公式。\n2. 验证任务。考虑一个非等熵的加热管道流，施加的加热使得出口温度 $T_{\\mathrm{out}}$ 是入口/参考温度 $T_{\\mathrm{ref}}$ 的倍数，即 $T_{\\mathrm{out}}=f\\,T_{\\mathrm{ref}}$，其中 $f>1$。假设在低马赫数条件下，压力变化很小，并近似认为沿管道 $p\\approx p_{\\mathrm{ref}}$，流动为均匀平推流 $u=U$，且 $U=M\\,a_{\\mathrm{ref}}$。使用理想气体定律计算 $\\rho_{\\mathrm{out}}\\approx \\dfrac{p_{\\mathrm{ref}}}{R\\,T_{\\mathrm{out}}}$，并取 $H_{\\mathrm{out}}=c_p T_{\\mathrm{out}}+\\dfrac{1}{2}U^2$。在两种缩放方式下，定义一个无量纲的“出口处归一化对流能量输运度量”：\n   - 一种基于声学焓的归一化，由您推导的低马赫数预处理缩放所隐含。为便于测试，取特征能量通量尺度为 $\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U$，其中 $\\rho_{\\mathrm{ref}}=\\dfrac{p_{\\mathrm{ref}}}{R\\,T_{\\mathrm{ref}}}$ 且 $a_{\\mathrm{ref}}=\\sqrt{\\gamma R T_{\\mathrm{ref}}}$。\n   - 一种使用 $\\rho_{\\mathrm{ref}}\\,U^3$ 的朴素速度平方归一化，已知这种方法与低马赫数缩放不一致。\n   需要计算的两个无量纲度量分别为：\n   $$S_{\\mathrm{good}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U},\\qquad S_{\\mathrm{bad}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,U^3}.$$\n   您必须在程序中使用上述定义来数值验证，对于不同的加热情况，当 $M\\to 0$ 时，$S_{\\mathrm{good}}$ 保持在 $\\mathcal{O}(1)$ 量级，而 $S_{\\mathrm{bad}}$ 则不然。\n\n验证中使用的物理常数和单位：\n- 参考温度 $T_{\\mathrm{ref}}$（单位 $\\mathrm{K}$）：$300$。\n- 参考压力 $p_{\\mathrm{ref}}$（单位 $\\mathrm{Pa}$）：$101325$。\n- 比热比 $\\gamma$：$1.4$。\n- 比气体常数 $R$（单位 $\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$）：$287$。\n所有输出必须是无单位的（无量纲浮点数）。\n\n测试套件：\n为以下每个 $(M,f)$ 情况计算有序对 $\\left[S_{\\mathrm{good}},S_{\\mathrm{bad}}\\right]$：\n- 情况 1：$M=1.0$, $f=1.0$。\n- 情况 2：$M=0.1$, $f=1.5$。\n- 情况 3：$M=0.01$, $f=2.0$。\n- 情况 4：$M=0.001$, $f=1.2$。\n这些情况涵盖了一般的压缩流状态、带加热的中等低马赫数状态、带强加热的深度低马赫数状态，以及带轻微加热的极端低马赫数边界。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的四个有序对列表，列表由方括号括起，每个有序对也由方括号括起，例如 $\\left[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]\\right]$。数值 $x_i$ 和 $y_i$ 必须是浮点数。", "solution": "该问题要求在低马赫数可压缩流的背景下，为能量变量推导一种热力学上一致的缩放方法，然后进行数值验证。推导过程必须源于流体动力学和热力学的第一性原理。\n\n### 低马赫数能量缩放的推导\n\n在模拟低马赫数（$M \\to 0$）可压缩流时，根本的挑战在于控制方程的多尺度性质。声波速度 $a$ 远大于流体速度 $U$，导致系统变得刚性。这种刚性在能量方程中尤为突出。我们的目标是推导一种无量纲化方案，确保当 $M \\to 0$ 时，能量方程中的各项保持在单位量级，即 $\\mathcal{O}(1)$。\n\n我们从理想气体的单位质量总能量 $E$ 和单位质量总焓 $H$ 的定义开始：\n$$E = e + \\frac{1}{2}|\\mathbf{u}|^2 = c_v T + \\frac{1}{2}|\\mathbf{u}|^2$$\n$$H = h + \\frac{1}{2}|\\mathbf{u}|^2 = c_p T + \\frac{1}{2}|\\mathbf{u}|^2$$\n其中 $e$ 是比内能，$h$ 是比静焓，$T$ 是温度，$\\mathbf{u}$ 是速度矢量，$c_v$ 和 $c_p$ 分别是定容比热和定压比热。\n\n问题的核心在于为无量纲化选择合适的参考尺度。我们用下标 `ref` 表示参考量，用撇号（'）表示无量纲量，例如 $\\mathbf{u} = U \\mathbf{u}'$，其中 $U$ 是特征速度。\n\n一种常用于高速可压缩流的朴素缩放方法是，用特征动能 $U^2$ 来缩放所有能量量。让我们来检验这种选择的后果。无量纲总能量 $E'_{naive}$ 将是：\n$$E'_{naive} = \\frac{E}{U^2} = \\frac{c_v T}{U^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{U^2}$$\n为了分析第一项，我们使用声速的定义 $a^2 = \\gamma R T$ 和马赫数的定义 $M = U/a_{\\mathrm{ref}}$。\n$$\\frac{c_v T}{U^2} = \\frac{c_v T}{M^2 a_{\\mathrm{ref}}^2} = \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) \\frac{c_v T_{\\mathrm{ref}}}{M^2 a_{\\mathrm{ref}}^2}$$\n使用 $c_v = R/(\\gamma-1)$ 和 $a_{\\mathrm{ref}}^2 = \\gamma R T_{\\mathrm{ref}}$，我们发现：\n$$\\frac{c_v T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\frac{R/(\\gamma-1) T_{\\mathrm{ref}}}{\\gamma R T_{\\mathrm{ref}}} = \\frac{1}{\\gamma(\\gamma-1)}$$\n假设温度波动有界，$T/T_{\\mathrm{ref}} = \\mathcal{O}(1)$，则 $E'_{naive}$ 的热能贡献变为：\n$$\\frac{c_v T}{U^2} = \\mathcal{O}\\left(\\frac{1}{M^2}\\right)$$\n因此，无量綱总能量变为：\n$$E'_{naive} = \\mathcal{O}\\left(\\frac{1}{M^2}\\right) + \\frac{1}{2}|\\mathbf{u}'|^2$$\n当 $M \\to 0$ 时，缩放后的热能项发散。这表明在低马赫数区域，$U^2$ 不是一个合适的总能量尺度。物理原因是，对于低速流，内能远大于动能。总能量由其热能部分主导。\n\n一个一致的缩放必须承认这一物理现实。占主导地位的热能 $h = c_p T$ 与声速的平方 $a^2 = \\gamma R T$ 直接相关。这表明比能量量（$e, h, E, H$）的一个自然参考尺度是 $a_{\\mathrm{ref}}^2$。让我们使用这个尺度来定义一个新的无量纲总能量 $E'$：\n$$E' = \\frac{E}{a_{\\mathrm{ref}}^2} = \\frac{c_v T}{a_{\\mathrm{ref}}^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2}$$\n我们再次分析这些项：\n热能项是 $\\dfrac{c_v T}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right) \\dfrac{c_v T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right) \\dfrac{1}{\\gamma(\\gamma-1)} = \\mathcal{O}(1)$。\n动能项是 $\\dfrac{1}{2}\\dfrac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{2}\\dfrac{U^2 |\\mathbf{u}'|^2}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{2} M^2 |\\mathbf{u}'|^2 = \\mathcal{O}(M^2)$。\n因此，正确缩放的无量纲总能量是：\n$$E' = \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) \\frac{1}{\\gamma(\\gamma-1)} + \\frac{1}{2}M^2|\\mathbf{u}'|^2$$\n当 $M \\to 0$ 时，$E'$ 保持在 $\\mathcal{O}(1)$ 量级，并平滑地趋近于缩放后的内能。这种缩放是良态的，并消除了与能量变量相关的系统刚性。\n\n这个原理可以延伸到能量对流通量 $\\rho \\mathbf{u} H$。该通量的特征尺度为 $(\\rho_{\\mathrm{ref}})(U)(H_{\\mathrm{ref}})$。使用我们推导出的尺度 $H_{\\mathrm{ref}} = a_{\\mathrm{ref}}^2$，特征通量变为 $\\rho_{\\mathrm{ref}} U a_{\\mathrm{ref}}^2$。这对应于 $S_{\\mathrm{good}}$ 定义中的分母。那么无量纲通量为：\n$$\\frac{\\rho \\mathbf{u} H}{\\rho_{\\mathrm{ref}} U a_{\\mathrm{ref}}^2} = \\rho' \\mathbf{u}' \\frac{H}{a_{\\mathrm{ref}}^2} = \\rho' \\mathbf{u}' \\left(\\frac{c_p T}{a_{\\mathrm{ref}}^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2}\\right)$$\n项 $\\dfrac{c_p T}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right)\\dfrac{1}{\\gamma-1} = \\mathcal{O}(1)$。当 $M \\to 0$ 时，完整的无量纲通量是 $\\mathcal{O}(1)$，确保了能量输运方程是良态的。这种缩放正是应用于能量方程的低马赫数预处理的精髓：它重新缩放热力学状态以与对流现象相平衡。\n\n### 数值验证\n\n现在我们使用指定的加热管道流模型来验证这个结论。我们将计算两个无量纲度量 $S_{\\mathrm{good}}$ 和 $S_{\\mathrm{bad}}$，它们分别代表正确和错误缩放的能量通量。\n\n公式为：\n$$S_{\\mathrm{good}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U} = \\dfrac{\\rho_{\\mathrm{out}}\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2}$$\n$$S_{\\mathrm{bad}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,U^3}$$\n管道出口处的量定义为：\n$T_{\\mathrm{out}} = f T_{\\mathrm{ref}}$\n$U = M a_{\\mathrm{ref}}$\n在低马赫数假设 $p \\approx p_{\\mathrm{ref}}$下，理想气体定律 $p = \\rho R T$ 给出 $\\rho_{\\mathrm{out}} = \\dfrac{p_{\\mathrm{ref}}}{R T_{\\mathrm{out}}} = \\dfrac{p_{\\mathrm{ref}}}{R f T_{\\mathrm{ref}}}$。由于 $\\rho_{\\mathrm{ref}} = \\dfrac{p_{\\mathrm{ref}}}{R T_{\\mathrm{ref}}}$，我们有 $\\rho_{\\mathrm{out}} = \\dfrac{\\rho_{\\mathrm{ref}}}{f}$。\n出口总焓为 $H_{\\mathrm{out}} = c_p T_{\\mathrm{out}} + \\frac{1}{2}U^2 = c_p f T_{\\mathrm{ref}} + \\frac{1}{2}M^2 a_{\\mathrm{ref}}^2$。\n\n将这些代入 $S_{\\mathrm{good}}$ 的表达式中：\n$$S_{\\mathrm{good}} = \\frac{(\\rho_{\\mathrm{ref}}/f)(c_p f T_{\\mathrm{ref}} + \\frac{1}{2}M^2 a_{\\mathrm{ref}}^2)}{\\rho_{\\mathrm{ref}} a_{\\mathrm{ref}}^2} = \\frac{c_p T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} + \\frac{M^2}{2f}$$\n使用 $c_p = \\dfrac{\\gamma R}{\\gamma-1}$ 和 $a_{\\mathrm{ref}}^2 = \\gamma R T_{\\mathrm{ref}}$，常数项简化为 $\\dfrac{c_p T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{\\gamma-1}$。\n因此，我们得到解析表达式：\n$$S_{\\mathrm{good}} = \\frac{1}{\\gamma-1} + \\frac{M^2}{2f}$$\n$$S_{\\mathrm{bad}} = \\frac{S_{\\mathrm{good}}}{M^2} = \\frac{1}{M^2(\\gamma-1)} + \\frac{1}{2f}$$\n当 $M \\to 0$ 时，$S_{\\mathrm{good}}$ 趋近于常数 $\\dfrac{1}{\\gamma-1}$，证实它是一个 $\\mathcal{O}(1)$ 的量。相比之下，$S_{\\mathrm{bad}}$ 以 $\\mathcal{O}(M^{-2})$ 的速度发散。以下程序将从基本定义出发，对给定的测试案例数值地计算这些值，以验证此行为。对于 $\\gamma=1.4$，$S_{\\mathrm{good}}$ 的极限值是 $1/(1.4-1.0) = 2.5$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates energy flux scaling for low-Mach number flows.\n    \"\"\"\n    # Define physical constants and reference-state properties\n    T_ref = 300.0  # Reference temperature in K\n    p_ref = 101325.0  # Reference pressure in Pa\n    gamma = 1.4  # Ratio of specific heats\n    R = 287.0  # Specific gas constant in J/(kg*K)\n\n    # Define the test cases as a list of (Mach number, temperature factor) tuples\n    test_cases = [\n        (1.0, 1.0),\n        (0.1, 1.5),\n        (0.01, 2.0),\n        (0.001, 1.2),\n    ]\n\n    results = []\n\n    # Calculate derived reference quantities\n    a_ref = np.sqrt(gamma * R * T_ref)\n    rho_ref = p_ref / (R * T_ref)\n    c_p = gamma * R / (gamma - 1.0)\n\n    for M, f in test_cases:\n        # Calculate flow properties based on the test case\n        U = M * a_ref\n        T_out = f * T_ref\n        \n        # Approximate density at exit assuming constant pressure p_ref\n        rho_out = p_ref / (R * T_out)\n        \n        # Calculate total enthalpy at exit\n        H_out = c_p * T_out + 0.5 * U**2\n        \n        # Calculate the convective energy flux at the exit\n        energy_flux = rho_out * U * H_out\n        \n        # Calculate the \"good\" scaling denominator (acoustic-enthalpy-based)\n        # This scale is O(rho_ref * U * a_ref^2)\n        denom_good = rho_ref * (a_ref**2) * U\n        \n        # Calculate the \"bad\" scaling denominator (naive velocity-squared-based)\n        # This scale is O(rho_ref * U^3)\n        denom_bad = rho_ref * (U**3)\n        \n        # Compute the two dimensionless measures\n        # Note: If M=0, U=0, leading to division by zero. The problem uses M > 0.\n        S_good = energy_flux / denom_good\n        S_bad = energy_flux / denom_bad\n        \n        results.append([S_good, S_bad])\n\n    # Format the output string precisely as required: [[r1_1,r1_2],[r2_1,r2_2],...]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3341795"}, {"introduction": "基于正确缩放的必要性，这个练习将展示预处理的一个主要实际好处：加速收敛到稳态。您将分析Turkel预处理器如何修正欧拉方程的特征速度[@problem_id:3341765]。通过为一个显式格式计算稳定的伪时间步长，您将量化这种特征值重缩放如何缓解在低马赫数下由快速传播的声波所施加的严格时间步限制。", "problem": "考虑比热比为 $\\gamma=1.4$ 的量热完全理想气体在一维定常均匀流中的情况，自由来流马赫数为 $M=0.02$。可压缩欧拉方程写成准线性形式为 $\\partial \\mathbf{Q}/\\partial t + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$，其中 $\\mathbf{Q}$ 表示守恒变量，$\\mathbf{F}$ 表示无粘通量。为加速收敛到定常状态，采用带有预处理矩阵的伪时间 $\\tau$ 积分，因此伪时间系统为 $\\mathbf{P}\\,\\partial \\mathbf{Q}/\\partial \\tau + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$，其中 $\\mathbf{P}$ 是 Turkel 预处理矩阵。\n\n假设在均匀状态附近进行线性化，并考虑在间距为 $\\Delta x$ 的均匀网格上进行伪时间上的一阶显式前向欧拉更新。Courant–Friedrichs–Lewy (CFL) 数定义为 $\\mathrm{CFL} = \\lambda_{\\max}\\,\\Delta \\tau/\\Delta x$，其中 $\\lambda_{\\max}$ 是沿 $x$ 方向的预处理特征速度的最大模，$\\Delta \\tau$ 是伪时间步长。物理声速为 $a$，流速为 $u$，马赫数定义为 $M = |u|/a$。对于量热完全气体，有 $a = \\sqrt{\\gamma p/\\rho}$，其中 $p$ 是压力，$\\rho$ 是密度。\n\n在低马赫数区域，采用 Turkel 预处理时，声学特征速度会按因子 $\\sqrt{\\beta}$ 进行缩放，其中预处理参数在 $M \\leq 1$ 时满足 $\\beta = M^{2}$，而对流特征速度保持为 $u$。利用这些事实，推导该显式格式的稳定性约束，并计算当 $\\mathrm{CFL} = 0.5$、$M = 0.02$、$\\gamma = 1.4$ 且网格尺寸为 $\\Delta x$ 时的稳定伪时间步长 $\\Delta \\tau$。将您的最终答案以秒为单位，表示为关于 $\\Delta x$ 和 $a$ 的单一简化的闭式解析表达式。无需四舍五入。", "solution": "我们从准线性形式的可压缩欧拉方程开始，在均匀状态附近进行线性化，此时一维空间中的通量雅可比矩阵具有特征速度 $u-a$、$u$ 和 $u+a$。这些是沿 $x$ 方向的未预处理雅可比矩阵 $\\partial \\mathbf{F}/\\partial \\mathbf{Q}$ 的特征值。引入伪时间 $\\tau$ 和 Turkel 预处理后，该系统可写为\n$$\n\\mathbf{P}\\,\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0},\n$$\n或等价地写为\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\mathbf{P}^{-1}\\,\\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}.\n$$\n预处理的作用是将空间算子的特征速度从其物理值修改为预处理值。在用于低马赫数流动的 Turkel 预处理器中，对流特征速度 $u$ 保持不变，而声学速度按因子 $\\sqrt{\\beta}$ 进行缩放，其中预处理参数在 $M \\leq 1$ 时满足 $\\beta = M^{2}$。因此，预处理后的特征速度为\n$$\n\\lambda_{1} = u - a\\sqrt{\\beta}, \\quad \\lambda_{2} = u, \\quad \\lambda_{3} = u + a\\sqrt{\\beta}.\n$$\n\n对于应用在线性化系统上、间距为 $\\Delta x$ 的均匀网格上的伪时间显式前向欧拉格式，标准的冯·诺依曼稳定性分析给出了 Courant–Friedrichs–Lewy 条件\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max\\left(|\\lambda_{1}|,|\\lambda_{2}|,|\\lambda_{3}|\\right)}.\n$$\n对于 $u \\geq 0$ 的亚音速流和较小的马赫数（此处 $M=0.02$），这三个特征速度的最大模为\n$$\n\\lambda_{\\max} = u + a\\sqrt{\\beta}.\n$$\n使用马赫数的定义 $M = |u|/a$，我们有 $u = M a$。将 $u = M a$ 和 $\\beta = M^{2}$ 代入 $\\lambda_{\\max}$ 可得\n$$\n\\lambda_{\\max} = M a + a\\sqrt{M^{2}} = M a + a M = 2 M a.\n$$\n\n因此，稳定性约束变为\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{2 M a}.\n$$\n使用指定的参数 $\\mathrm{CFL} = 0.5$ 和 $M = 0.02$，上式可简化为\n$$\n\\Delta \\tau = \\frac{0.5\\,\\Delta x}{2 \\cdot 0.02 \\, a} = \\frac{0.5\\,\\Delta x}{0.04\\,a} = \\frac{12.5\\,\\Delta x}{a}.\n$$\n此处，$a$ 是物理声速，对于比热比 $\\gamma=1.4$ 的量热完全理想气体，其表达式为 $a = \\sqrt{\\gamma p/\\rho}$。由于 $p$ 和 $\\rho$ 未指定，因此用 $\\Delta x$ 和 $a$ 表示的闭式表达式即为最终结果。单位是秒，因为 $\\Delta x$ 的单位是长度，$a$ 的单位是长度/时间，所以它们的比值单位是时间。\n\n因此，在给定条件下，采用 Turkel 预处理的稳定伪时间步长为\n$$\n\\Delta \\tau = \\frac{12.5\\,\\Delta x}{a}.\n$$", "answer": "$$\\boxed{\\frac{12.5\\,\\Delta x}{a}}$$", "id": "3341765"}, {"introduction": "最后的这个实践练习将超越数值效率，转向物理精度的关键问题。我们将研究一个预处理求解器是否能够捕捉到一个微弱的二阶物理现象——声流[@problem_id:3341755]。通过使用一个基于局部Lax–Friedrichs格式的模型，您将评估预处理如何减少该格式固有的数值耗散，从而保护微弱的主声波，并使得解析更弱的声流成为可能。", "problem": "要求您使用一个有原则的代理模型来评估，一种用于可压缩流的低马赫数预处理离散格式，是否能够解析量级为 $\\overline{\\mathbf{u}}=O(M^2)$ 的二阶声流平均流，而不会对主声场造成过度的数值耗散。在一维空间中进行分析，并进行无量纲化，使得参考声速为 $c=1$，基态速度为零，周期性域的长度为 $L=1$。考虑一个波数为 $k=2\\pi$（域中一个波长）的单一右行声学傅里叶模式，其声学马赫数为 $M$，因此主声学速度振幅的标度为 $O(M)$，而声流平均的标度为 $O(M^2)$。Weiss–Smith 意义下的低马赫数预处理通过一个因子 $\\beta(M)=\\max(M,M_{\\mathrm{cut}})$ 来修正声学特征速度，其中 $M_{\\mathrm{cut}}$ 是一个预设的截止值；也就是说，有效声速变为 $\\pm \\beta(M)\\,c$。\n\n使用以下基本依据和假设，并从中推导出所有需要的关系，不要引入无法从它们逻辑推导出的公式：\n\n- 从关于均匀静止状态的线性化可压缩方程及其特征形式出发，在没有预处理的情况下，声学特征会解耦并以速度 $\\pm c$ 传播。\n- 假设在每个波长有 $N_p$ 个点的均匀网格上，使用局部Lax–Friedrichs (LLF) 数值通量（也称为 Rusanov 通量）进行半离散空间离散化。LLF耗散参数等于沿法线方向的通量雅可比矩阵的谱半径；对于声学模式，在预处理系统中，该参数等于 $\\alpha=\\beta(M)\\,c$，而在没有预处理的情况下，它等于 $\\alpha=c$。\n- 对网格间距为 $\\Delta x=1/N_p$、波数为 $\\theta=2\\pi/N_p$ 的单一傅里叶模式，应用标准的傅里叶或冯诺依曼分析到半离散LLF算子上。根据该模式在LLF作用下的半离散演化，确定由LLF耗散项引起的模式振幅随时间的指数衰减率。然后，在一个物理波周期 $T=L/c$（由未经预处理的物理过程设定）内，获得仅由空间数值耗散引起的主声学模式的振幅衰减因子 $A\\in(0,1)$。\n- 最后，论证在 $M$ 的主导阶上，二阶声流平均幅值与主模式振幅的平方成比例，因此由数值耗散引起的声流幅值的相对误差可以近似为 $E=1-A^2$。同样，定义一个周期内的主波振幅下降为 $D=1-A$。\n\n判定标准：对于给定的参数集 $(M,N_p,M_{\\mathrm{cut}},\\delta,\\varepsilon,\\mathrm{precond})$，其中 $\\mathrm{precond}\\in\\{\\mathrm{True},\\mathrm{False}\\}$ 表示是否应用预处理，当且仅当 $D\\le \\delta$ 和 $E\\le \\varepsilon$ 同时成立时，宣布该配置能够解析 $O(M^2)$ 的声流而没有过度耗散。\n\n任务：实现一个程序，对于下面套件中的每个测试用例，根据上述步骤计算布尔决策，并根据 $\\mathrm{precond}$ 的指示判断是否使用预处理。假设在所有情况下 $c=1$ 和 $L=1$。在此评估中，主波传播无需模拟物理粘性。\n\n测试套件（每个元组为 $(M,N_p,M_{\\mathrm{cut}},\\delta,\\varepsilon,\\mathrm{precond})$）：\n- $\\left(0.01,\\,64,\\,0.1,\\,0.2,\\,0.2,\\,\\mathrm{False}\\right)$\n- $\\left(0.01,\\,64,\\,0.1,\\,0.2,\\,0.2,\\,\\mathrm{True}\\right)$\n- $\\left(0.0001,\\,64,\\,0.01,\\,0.1,\\,0.1,\\,\\mathrm{True}\\right)$\n- $\\left(0.0001,\\,64,\\,0.01,\\,0.1,\\,0.1,\\,\\mathrm{False}\\right)$\n- $\\left(0.05,\\,16,\\,0.1,\\,0.15,\\,0.25,\\,\\mathrm{True}\\right)$\n- $\\left(0.1,\\,256,\\,0.05,\\,0.1,\\,0.15,\\,\\mathrm{False}\\right)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”），其中每个结果为 True 或 False，按上面列出的顺序对应每个测试用例。由于此处指定的无量纲化，不需要物理单位。傅里叶波数中使用的角度是无量纲的相角。", "solution": "该问题是计算流体力学数值方法分析中一个有效且适定的练习。它要求通过构建一个基于主声波数值耗散的代理模型，来评估一种数值格式解析物理现象——声流——的能力。分析将通过推导指定格式的数值耗散率，并将产生的波衰减与预设的误差容限进行比较来进行。\n\n其基本物理过程是声流，其中速度振幅为 $O(M)$ 的一阶声场驱动了幅值为 $O(M^2)$ 的二阶平均流，其中 $M$ 是声学马赫数。问题的核心是量化此过程中的数值误差。给定声流幅值的相对误差 $E$ 可以通过主波能量的衰减来近似。如果主波振幅在一个特征时间内衰减一个因子 $A$，其能量（与振幅的平方成正比）将衰减 $A^2$。因此，相对损失为 $E = 1-A^2$。直接的振幅下降是 $D=1-A$。如果 $D$ 和声流误差 $E$ 都分别低于给定的阈值 $\\delta$ 和 $\\varepsilon$，则该配置被认为是足够的。\n\n我们的第一步是对数值格式引起的主声波衰减进行建模。该格式是在均匀网格上使用局部Lax-Friedrichs (LLF) 或 Rusanov 数值通量对一维线性化可压缩欧拉方程进行的半离散化。分析是针对代表主声波的单个傅里叶模式进行的。\n\n设与右行声波相关的特征变量 $w(x,t)$ 由标量平流方程控制：\n$$\n\\frac{\\partial w}{\\partial t} + c \\frac{\\partial w}{\\partial x} = 0\n$$\n其中 $c=1$ 是无量纲声速。在网格间距为 $\\Delta x$、节点为 $j$ 的网格上，守恒律 $\\frac{\\partial w}{\\partial t} + \\frac{\\partial f(w)}{\\partial x} = 0$ 的半离散形式由下式给出：\n$$\n\\frac{dw_j}{dt} = -\\frac{1}{\\Delta x} \\left( F_{j+1/2} - F_{j-1/2} \\right)\n$$\n其中 $F_{j+1/2}$ 是节点 $j$ 和 $j+1$ 之间的数值通量。对于LLF格式，该通量为：\n$$\nF_{j+1/2} = \\frac{1}{2} \\left[ f(w_j) + f(w_{j+1}) \\right] - \\frac{\\alpha}{2} \\left( w_{j+1} - w_j \\right)\n$$\n此处，$f(w) = cw$ 是物理通量，$\\alpha$ 是数值耗散参数，设定为最大特征速度（通量雅可比矩阵的谱半径）。问题陈述指出，对于未预处理的系统，$\\alpha=c$，而对于预处理的系统，$\\alpha=\\beta(M)c$。由于 $c=1$，我们有：\n$$\n\\alpha = \\begin{cases} 1  \\text{without preconditioning} \\\\ \\beta(M) = \\max(M, M_{\\mathrm{cut}})  \\text{with preconditioning} \\end{cases}\n$$\n将LLF通量代入半离散方程得到：\n$$\n\\frac{dw_j}{dt} = -\\frac{c}{2\\Delta x}(w_{j+1} - w_{j-1}) + \\frac{\\alpha}{2\\Delta x}(w_{j+1} - 2w_j + w_{j-1})\n$$\n第一项是平流项 $-c \\frac{\\partial w}{\\partial x}$ 的二阶中心差分近似，第二项是类似于离散拉普拉斯算子的数值耗散项。\n\n为了找到耗散率，我们通过代入单个傅里叶模式 $w_j(t) = \\hat{w}(t) e^{ikx_j} = \\hat{w}(t) e^{ij\\theta}$ 来进行冯诺依曼分析，其中 $k=2\\pi$ 是物理波数，$\\Delta x = L/N_p = 1/N_p$ 是每个波长 $N_p$ 个点的网格间距，$\\theta = k\\Delta x = 2\\pi/N_p$ 是无量纲的网格波数。这个代换将网格值 $w_j$ 的常微分方程转换为关于模态振幅 $\\hat{w}$ 的方程：\n$$\n\\frac{d\\hat{w}}{dt} = \\left[ -\\frac{c}{2\\Delta x}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\alpha}{2\\Delta x}(e^{i\\theta} - 2 + e^{-i\\theta}) \\right] \\hat{w}(t)\n$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} - 2 + e^{-i\\theta} = 2\\cos\\theta - 2$，方程变为：\n$$\n\\frac{d\\hat{w}}{dt} = \\left[ -i\\frac{c\\sin\\theta}{\\Delta x} + \\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x} \\right] \\hat{w}(t)\n$$\n这是一个形如 $\\frac{d\\hat{w}}{dt} = \\lambda \\hat{w}$ 的线性常微分方程，其解为 $\\hat{w}(t) = \\hat{w}(0)e^{\\lambda t}$。复特征值 $\\lambda$ 决定了模式的行为。虚部对应于数值相速度（色散），而实部控制振幅的增长或衰减（不稳定性或耗散）。其实部为：\n$$\n\\lambda_{Re} = \\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x}\n$$\n由于 $\\cos\\theta \\le 1$，所以 $\\lambda_{Re} \\le 0$，这表明LLF格式是耗散的，正如预期。随时间的指数衰减率为 $\\sigma = -\\lambda_{Re}$：\n$$\n\\sigma = -\\frac{\\alpha(\\cos\\theta - 1)}{\\Delta x} = \\frac{\\alpha(1 - \\cos\\theta)}{\\Delta x}\n$$\n代入 $\\Delta x = 1/N_p$ 和 $\\theta = 2\\pi/N_p$，我们得到：\n$$\n\\sigma = N_p \\alpha \\left(1 - \\cos\\left(\\frac{2\\pi}{N_p}\\right)\\right)\n$$\n经过时间 $t$ 后波的振幅为 $|\\hat{w}(t)| = |\\hat{w}(0)|e^{-\\sigma t}$。问题要求在一个物理波周期 $T = L/c$ 内评估衰减。由于 $L=1$ 和 $c=1$，该周期为 $T=1$。因此，振幅衰减因子 $A$ 为：\n$$\nA = \\frac{|\\hat{w}(T)|}{|\\hat{w}(0)|} = e^{-\\sigma T} = e^{-\\sigma}\n$$\n确定衰减因子 $A$ 后，我们计算误差度量：\n$$\nD = 1-A \\quad \\text{and} \\quad E=1-A^2\n$$\n对于每个测试用例 $(M, N_p, M_{\\mathrm{cut}}, \\delta, \\varepsilon, \\mathrm{precond})$ 的最终决策由逻辑条件给出：\n$$\n\\text{Result} = (D \\le \\delta) \\land (E \\le \\varepsilon)\n$$\n这就完成了算法的推导。对于每个测试用例，我们计算 $\\alpha$，然后是 $\\sigma$，接着是 $A$，然后是 $D$ 和 $E$，最后应用决策准则。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes whether a low-Mach-number preconditioned discretization\n    can resolve second-order acoustic streaming based on a proxy model for\n    numerical dissipation.\n    \"\"\"\n\n    # Test suite: each tuple is (M, Np, Mcut, delta, epsilon, precond)\n    test_cases = [\n        (0.01, 64, 0.1, 0.2, 0.2, False),\n        (0.01, 64, 0.1, 0.2, 0.2, True),\n        (0.0001, 64, 0.01, 0.1, 0.1, True),\n        (0.0001, 64, 0.01, 0.1, 0.1, False),\n        (0.05, 16, 0.1, 0.15, 0.25, True),\n        (0.1, 256, 0.05, 0.1, 0.15, False),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        M, Np, Mcut, delta, epsilon, precond = case\n\n        # Assign reference sound speed c=1 as per problem statement.\n        c = 1.0\n\n        # Step 1: Determine the LLF dissipation parameter alpha.\n        # It is the spectral radius of the (preconditioned) flux Jacobian.\n        if precond:\n            # For the preconditioned system, alpha = beta(M)*c\n            # where beta(M) = max(M, Mcut).\n            beta_M = max(M, Mcut)\n            alpha = beta_M * c\n        else:\n            # For the unpreconditioned system, alpha = c.\n            alpha = c\n\n        # Step 2: Determine the exponential-in-time decay rate sigma.\n        # This comes from Fourier analysis of the semi-discrete operator.\n        # The dimensionless grid wavenumber is theta = 2*pi/Np.\n        # The grid spacing is Delta_x = 1/Np.\n        # sigma = alpha * (1 - cos(theta)) / Delta_x\n        sigma = Np * alpha * (1 - np.cos(2 * np.pi / Np))\n\n        # Step 3: Compute the amplitude attenuation factor A over one\n        # physical wave period T=L/c. Since L=1 and c=1, T=1.\n        # A = exp(-sigma * T) = exp(-sigma).\n        A = np.exp(-sigma)\n\n        # Step 4: Calculate the error metrics.\n        # D: primary-wave amplitude drop.\n        # E: relative error in the streaming magnitude.\n        D = 1.0 - A\n        E = 1.0 - A**2\n\n        # Step 5: Apply the decision criterion.\n        # The configuration is successful if D is less than or equal to delta AND E is less than or equal to epsilon.\n        decision = (D = delta) and (E = epsilon)\n        results.append(decision)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3341755"}]}