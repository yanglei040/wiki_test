{"hands_on_practices": [{"introduction": "理论分析是理解任何数值格式特性的第一步。本练习将引导你使用冯·诺依曼稳定性分析方法，深入探究Lax-Wendroff格式的核心性质。通过推导其放大因子，你将亲手揭示该格式的数值耗散特性，特别是它如何影响网格上可分辨的最高频率波，这是理解其在处理不同波形成分时表现的关键。", "problem": "一位科学家正在模拟一维流体流动中非反应性示踪剂的输运。示踪剂的浓度 $u(x, t)$ 由线性平流方程控制：$\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$，其中 $c$ 是流体的恒定正速度。\n\n为了数值求解该方程，在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上采用了一种有限差分法。浓度 $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ 的更新规则由 Lax-Wendroff 格式给出：\n$$u_j^{n+1} = u_j^n - \\frac{c \\Delta t}{2 \\Delta x}(u_{j+1}^n - u_{j-1}^n) + \\frac{1}{2}\\left(\\frac{c \\Delta t}{\\Delta x}\\right)^2(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n\n已知该格式会引入数值耗散，从而衰减解的傅里叶模态的振幅。给定模态的衰减量取决于无量纲 Courant 数 $\\nu = \\frac{c \\Delta t}{\\Delta x}$。我们关心的是网格上可以表示的最高频率模态的行为，其波长为 $2\\Delta x$。这个特定模态通常会经历最显著的衰减。\n\n为使格式稳定，Courant 数必须在一定范围内。在这个稳定范围内，确定 Courant 数 $\\nu$ 的特定正值，使得该最高频率模态的数值耗散最大化（即，其振幅在单个时间步长后被最强烈地减小）。", "solution": "我们通过 von Neumann 分析来分析 Lax-Wendroff 格式。考虑一个傅里叶模态 $u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\theta)$，其中 $\\theta=k\\Delta x$。那么\n$$\nu_{j+1}^{n}-u_{j-1}^{n}=\\hat{u}^{n}\\exp(i j \\theta)\\left[\\exp(i\\theta)-\\exp(-i\\theta)\\right]=2i\\hat{u}^{n}\\exp(i j \\theta)\\sin\\theta,\n$$\n$$\nu_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}=\\hat{u}^{n}\\exp(i j \\theta)\\left[\\exp(i\\theta)-2+\\exp(-i\\theta)\\right]=2\\hat{u}^{n}\\exp(i j \\theta)\\left(\\cos\\theta-1\\right).\n$$\n设 $\\nu=\\frac{c\\Delta t}{\\Delta x}$，代入更新规则可得\n$$\nu_{j}^{n+1}=\\hat{u}^{n}\\exp(i j \\theta)\\left[1-\\frac{\\nu}{2}(2i\\sin\\theta)+\\frac{\\nu^{2}}{2}\\cdot 2(\\cos\\theta-1)\\right]\n=\\hat{u}^{n}\\exp(i j \\theta)\\,G(\\theta),\n$$\n因此放大因子为\n$$\nG(\\theta)=1-i\\nu\\sin\\theta+\\nu^{2}(\\cos\\theta-1).\n$$\n对于网格上的最高频率模态，波长为 $2\\Delta x$，因此 $\\theta=\\pi$。使用 $\\sin\\pi=0$ 和 $\\cos\\pi=-1$，\n$$\nG(\\pi)=1- i\\nu\\cdot 0+\\nu^{2}(-1-1)=1-2\\nu^{2}.\n$$\n因此，一步之后振幅乘以 $|G(\\pi)|=|1-2\\nu^{2}|$。Lax-Wendroff 格式在 $0\\leq \\nu \\leq 1$ 时是稳定的。在此区间上，\n$$\n|1-2\\nu^{2}|=\\begin{cases}\n1-2\\nu^{2},  0\\leq \\nu \\leq \\frac{1}{\\sqrt{2}},\\\\\n2\\nu^{2}-1,  \\frac{1}{\\sqrt{2}}\\leq \\nu \\leq 1,\n\\end{cases}\n$$\n它在 $[0,\\frac{1}{\\sqrt{2}}]$ 上递减，在 $[\\frac{1}{\\sqrt{2}},1]$ 上递增。因此， $|G(\\pi)|$ 的最小值（即最大衰减）出现在\n$$\n\\nu=\\frac{1}{\\sqrt{2}},\n$$\n此时 $G(\\pi)=0$，该模态在一个步长内被完全衰减。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "2225601"}, {"introduction": "在了解了Lax-Wendroff格式的耗散特性后，我们接下来探讨一个与之相伴而生的重要现象：数值振荡。这个练习通过一个精心设计的阶跃初值问题，让你证明高阶线性格式一个固有的“缺陷”——它不满足离散极值原理。你将计算出，在经过一个时间步后，解会在间断点附近产生超越初始范围的过冲（overshoot），这是理解为什么Lax-Wendroff格式会在激波或接触间断等剧烈变化区域产生非物理解的关键。", "problem": "考虑一维线性平流方程 $\\partial_{t} u + a \\,\\partial_{x} u = 0$，其中 $u(x,t)$ 是一个被动标量，$a>0$ 是一个常数平流速度，代表了分层地球物理柱中的向右正压流。设空间域是均匀的，网格点为 $x_{i} = i\\,\\Delta x$，时间层级为 $t^{n} = n\\,\\Delta t$。定义 Courant-Friedrichs-Lewy (CFL) 数 $\\sigma = a\\,\\Delta t/\\Delta x$，并假设 $0  \\sigma  1$。从控制方程出发，利用时间上的二阶泰勒展开以及空间导数的二阶中心差分，推导在网格点 $x_{i}$ 处，以 $u_{i-1}^{n}$、$u_{i}^{n}$ 和 $u_{i+1}^{n}$ 表示的显式的二阶精度Lax-Wendroff更新格式。\n\n现在考虑以下旨在模拟尖锐地球物理示踪剂锋面的离散初始条件：对于所有 $i \\leq 0$，有 $u_{i}^{0} = 1$；对于所有 $i \\geq 1$，有 $u_{i}^{0} = 0$。使用您推导的 Lax-Wendroff 更新格式，计算在 $x_{0}$ 处单步更新后的 $u_{0}^{1}$，作为 CFL 数 $\\sigma$ 的函数。请将您的最终答案表示为封闭形式的解析表达式。无需四舍五入，量 $u$ 是无量纲的。", "solution": "用户提供了一个需要分两部分回答的问题：首先，推导一维线性平流方程的 Lax-Wendroff 数值格式；其次，将此格式应用于特定的初始条件，以求出单个时间步后特定网格点上的值。\n\n### 步骤 1：问题验证\n\n首先对问题陈述进行严格的验证过程。\n\n**逐字提取的已知条件：**\n*   控制方程：$\\partial_{t} u + a \\,\\partial_{x} u = 0$\n*   $u(x,t)$ 是一个被动标量。\n*   $a>0$ 是一个常数平流速度。\n*   空间域：均匀，网格点为 $x_{i} = i\\,\\Delta x$。\n*   时间层级：$t^{n} = n\\,\\Delta t$。\n*   CFL 数：$\\sigma = a\\,\\Delta t/\\Delta x$。\n*   CFL 条件：$0  \\sigma  1$。\n*   推导方法：时间上的二阶泰勒展开，空间导数的二阶中心差分。\n*   待推导的格式：在 $x_{i}$ 处，以 $u_{i-1}^{n}$、$u_{i}^{n}$ 和 $u_{i+1}^{n}$ 表示的显式、时间上两步、空间上单步的高阶 Lax-Wendroff 更新格式。\n*   离散初始条件：对于所有 $i \\leq 0$，$u_{i}^{0} = 1$。\n*   离散初始条件：对于所有 $i \\geq 1$，$u_{i}^{0} = 0$。\n*   计算目标：计算在 $x_{0}$ 处单步更新后的 $u_{0}^{1}$，作为 CFL 数 $\\sigma$ 的函数。\n*   答案格式：封闭形式的解析表达式，无需四舍五入，$u$ 是无量纲的。\n\n**使用提取的已知条件进行验证：**\n*   **科学性：**该问题基于线性平流方程，这是流体动力学和计算方法的基石。Lax-Wendroff 格式是求解该方程的标准、有据可查的二阶方法。该设置在科学上是合理的。\n*   **适定性：**问题定义清晰。它要求进行标准推导，然后进行直接计算。所有必要信息（控制方程、初始条件、离散化方法）都已提供。它能导出一个唯一、稳定且有意义的解。短语“时间上两步”是对从二阶时间导数推导出的格式的一种略微非标准但可以理解的描述，并且不影响可解性。\n*   **客观性：**问题以精确的数学和物理术语陈述，没有主观性或模糊性。\n*   **完整性和一致性：**问题是自洽和一致的。初始条件定义明确，对 CFL 数的约束是标准的。\n\n**结论与行动：**\n问题是**有效的**。这是偏微分方程数值分析中的一个标准练习。将继续进行求解。\n\n### 步骤 2：Lax-Wendroff 格式的推导\n\n推导从 $u(x,t)$ 在点 $(x, t)$ 附近关于时间的二阶泰勒级数展开开始：\n$$u(x, t+\\Delta t) = u(x,t) + \\Delta t \\, \\partial_t u(x,t) + \\frac{(\\Delta t)^2}{2} \\, \\partial_{tt} u(x,t) + O((\\Delta t)^3)$$\n控制方程为 $\\partial_{t} u = -a \\partial_{x} u$。为了求时间的二阶导数，我们将控制方程对时间求导：\n$$\\partial_{tt} u = \\partial_t(-a \\partial_x u) = -a \\partial_{tx} u$$\n假设 $u$ 足够光滑，使得混合偏导数相等 ($\\partial_{tx} u = \\partial_{xt} u$)，我们可以写出：\n$$\\partial_{tt} u = -a \\partial_x (\\partial_t u)$$\n再次用控制方程代入 $\\partial_t u$：\n$$\\partial_{tt} u = -a \\partial_x (-a \\partial_x u) = a^2 \\partial_{xx} u$$\n现在我们将 $\\partial_t u$ 和 $\\partial_{tt} u$ 的表达式代回泰勒展开式：\n$$u(x, t+\\Delta t) = u(x,t) - a \\Delta t \\, \\partial_x u(x,t) + \\frac{a^2 (\\Delta t)^2}{2} \\, \\partial_{xx} u(x,t) + O((\\Delta t)^3)$$\n现在对该方程进行空间和时间上的离散化。我们将 $u(x_i, t^n)$ 记为 $u_i^n$。方程变为：\n$$u_i^{n+1} \\approx u_i^n - a \\Delta t (\\partial_x u)_i^n + \\frac{a^2 (\\Delta t)^2}{2} (\\partial_{xx} u)_i^n$$\n我们使用二阶中心有限差分来近似空间导数：\n$$(\\partial_x u)_i^n \\approx \\frac{u_{i+1}^n - u_{i-1}^n}{2 \\Delta x}$$\n$$(\\partial_{xx} u)_i^n \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\\Delta x)^2}$$\n将这些有限差分近似代入离散化的时间步进方程，得到：\n$$u_i^{n+1} = u_i^n - a \\Delta t \\left(\\frac{u_{i+1}^n - u_{i-1}^n}{2 \\Delta x}\\right) + \\frac{a^2 (\\Delta t)^2}{2} \\left(\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\\Delta x)^2}\\right)$$\n我们引入 Courant-Friedrichs-Lewy (CFL) 数 $\\sigma = \\frac{a \\Delta t}{\\Delta x}$。该方程可以重写为以 $\\sigma$ 表示的形式：\n$$u_i^{n+1} = u_i^n - \\frac{\\sigma}{2}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\sigma^2}{2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n这就是显式 Lax-Wendroff 更新格式。我们可以按空间索引（$i-1, i, i+1$）对各项进行分组，以获得更紧凑的形式：\n$$u_i^{n+1} = u_{i-1}^n \\left(\\frac{\\sigma}{2} + \\frac{\\sigma^2}{2}\\right) + u_i^n \\left(1 - \\sigma^2\\right) + u_{i+1}^n \\left(-\\frac{\\sigma}{2} + \\frac{\\sigma^2}{2}\\right)$$\n对系数进行因式分解，得到格式模板的最终形式：\n$$u_i^{n+1} = \\frac{\\sigma(\\sigma+1)}{2} u_{i-1}^n + (1 - \\sigma^2) u_i^n + \\frac{\\sigma(\\sigma-1)}{2} u_{i+1}^n$$\n\n### 步骤 3：计算 $u_0^1$\n\n我们需要计算一个时间步后，网格点 $x_0$ 上的标量 $u$ 的值，即 $u_0^1$。我们在推导出的 Lax-Wendroff 格式中设置 $i=0$ 和 $n=0$：\n$$u_0^1 = u_0^0 - \\frac{\\sigma}{2}(u_{1}^0 - u_{-1}^0) + \\frac{\\sigma^2}{2}(u_{1}^0 - 2u_0^0 + u_{-1}^0)$$\n问题给出了在时间 $t^0=0$ 时的离散初始条件：\n*   对于所有 $i \\leq 0$，$u_i^0 = 1$。这意味着 $u_0^0 = 1$ 且 $u_{-1}^0 = 1$。\n*   对于所有 $i \\geq 1$，$u_i^0 = 0$。这意味着 $u_1^0 = 0$。\n\n我们将这些具体值代入 $u_0^1$ 的方程中：\n$$u_0^1 = 1 - \\frac{\\sigma}{2}(0 - 1) + \\frac{\\sigma^2}{2}(0 - 2(1) + 1)$$\n现在，我们简化该表达式：\n$$u_0^1 = 1 - \\frac{\\sigma}{2}(-1) + \\frac{\\sigma^2}{2}(-1)$$\n$$u_0^1 = 1 + \\frac{\\sigma}{2} - \\frac{\\sigma^2}{2}$$\n这就是 $u_0^1$ 作为 CFL 数 $\\sigma$ 的函数的最终封闭形式解析表达式。", "answer": "$$\\boxed{1 + \\frac{\\sigma}{2} - \\frac{\\sigma^2}{2}}$$", "id": "3603389"}, {"introduction": "最后一个实践将理论与编程相结合，将我们从线性平流方程推进到更具挑战性的非线性守恒律——无粘汉堡方程。你将实现一个完整的数值模拟，观察一个光滑的初始波形如何逐渐演化并形成激波，并在此过程中亲眼见证并量化Lax-Wendroff格式产生的数值过冲。这个练习不仅能巩固你对格式特性的理解，还能让你掌握在实际计算流体力学问题中评估数值格式性能的实用技能。", "problem": "考虑周期性区域 $x \\in [0,1]$ 上具有凸通量 $f(u)$ 的一维非线性标量守恒律 $u_t + f(u)_x = 0$。使用特定的凸通量 $f(u) = \\frac{1}{2} u^2$（无粘伯格斯方程）。设初始条件为一个从高状态到低状态的光滑单调阶跃，\n$$\nu(x,0) = u_R + \\frac{1}{2}(u_L - u_R)\\left(1 - \\tanh\\left(\\frac{x - x_0}{\\nu}\\right)\\right),\n$$\n其中 $u_L = 1$, $u_R = 0$, $x_0 = 0.5$，平滑参数 $\\nu  0$。这种构型是压缩性的，并会演化成一个激波，已知这会在Lax–Wendroff格式中引发色散性过冲。\n\n从守恒形式 $u_t + f(u)_x = 0$ 出发，基于时间上的泰勒展开并保持守恒形式，推导适用于一般标量非线性凸通量的两步显式Lax–Wendroff (LW) 格式。在具有 $N$ 个点、网格间距 $\\Delta x = 1/N$ 和周期性边界条件的均匀网格上实现此LW格式。使用自适应选择的时间步长 $\\Delta t$ 以满足Courant–Friedrichs–Lewy (CFL) 稳定性条件 $\\max|f'(u)| \\frac{\\Delta t}{\\Delta x} \\leq \\mathrm{CFL}$，其中 $\\mathrm{CFL} = 0.9$。将解演化至一个固定的最终时间 $T = 0.2$（无量纲）。\n\n将在时间 $T$ 的过冲幅度定义为对不变范围 $[u_{\\min}, u_{\\max}] = [\\min(u_L,u_R), \\max(u_L,u_R)] = [0,1]$ 的最大违背：\n$$\n\\mathcal{O} = \\max\\left( \\max_x\\left( u(x,T) - u_{\\max} \\right), \\max_x\\left( u_{\\min} - u(x,T) \\right) \\right),\n$$\n按照惯例，最大值计算中的负值取为 $0$。换句话说，$\\mathcal{O}$ 是数值解在物理容许范围 $[0,1]$ 之外的最大距离。\n\n你的任务是编写一个程序，该程序：\n- 为给定的 $N$ 和 $\\nu$ 构建初始条件。\n- 使用推导的LW格式，配合周期性边界条件和遵循所述CFL条件的自适应时间步长，将解演化至时间 $T$。\n- 计算在时间 $T$ 的过冲幅度 $\\mathcal{O}$。\n\n测试套件：\n- 案例 $1$：$(N,\\nu) = (256, 0.05)$。\n- 案例 $2$：$(N,\\nu) = (512, 0.05)$。\n- 案例 $3$：$(N,\\nu) = (1024, 0.05)$。\n- 案例 $4$：$(N,\\nu) = (512, 0.02)$。\n- 案例 $5$：$(N,\\nu) = (512, 0.10)$。\n- 案例 $6$：$(N,\\nu) = (128, 0.01)$。\n\n覆盖性设计：\n- 案例 1-3 在固定的 $\\nu$ 下改变 $\\Delta x$，以探究过冲如何随网格加密而变化。\n- 案例 4-5 在固定的 $N$ 下改变 $\\nu$，以探究其对初始光滑尺度的依赖性。\n- 案例 6 结合了粗网格和陡峭的过渡，以探究接近稳定性和分辨率极限的挑战性边缘条件。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含六个测试案例的过冲幅度，格式为方括号内以逗号分隔的列表，例如 $[o_1,o_2,o_3,o_4,o_5,o_6]$，其中每个 $o_k$ 是对应案例的浮点值 $\\mathcal{O}$。\n- 不应打印任何额外文本。", "solution": "该问题是有效的。它提出了一个标准的计算流体力学任务：使用Lax-Wendroff格式求解具有特定初始条件的无粘伯格斯方程，并量化由此产生的数值伪影（过冲）。所有参数、方程和条件都定义明确、科学合理且客观。\n\n控制方程为一维标量守恒律，由下式给出：\n$$\nu_t + f(u)_x = 0\n$$\n其中无粘伯格斯方程的凸通量函数为：\n$$\nf(u) = \\frac{1}{2} u^2\n$$\n区域为 $x \\in [0,1]$，带有周期性边界条件。初始条件是一个平滑的激波剖面：\n$$\nu(x,0) = u_R + \\frac{1}{2}(u_L - u_R)\\left(1 - \\tanh\\left(\\frac{x - x_0}{\\nu}\\right)\\right)\n$$\n参数为 $u_L = 1$、$u_R = 0$、$x_0 = 0.5$ 和平滑参数 $\\nu  0$。这可以简化为：\n$$\nu(x,0) = \\frac{1}{2}\\left(1 - \\tanh\\left(\\frac{x - 0.5}{\\nu}\\right)\\right)\n$$\n这个初始剖面代表一个压缩波，它将变陡形成激波，这种情况已知会在像Lax-Wendroff这样的二阶线性格式中产生伪振荡。\n\n**两步Lax-Wendroff格式的推导**\nLax-Wendroff (LW) 格式由解 $u(x,t)$ 在时间变量 $t$ 上的泰勒级数展开推导而来：\n$$\nu(x, t+\\Delta t) = u(x,t) + \\Delta t u_t(x,t) + \\frac{(\\Delta t)^2}{2} u_{tt}(x,t) + O((\\Delta t)^3)\n$$\n通过反复使用守恒律 $u_t = -f(u)_x$，将时间导数 $u_t$ 和 $u_{tt}$ 替换为空间导数。一阶导数是直接的。二阶导数通过对偏微分方程（PDE）关于时间求导得到：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-f(u)_x) = -\\frac{\\partial}{\\partial x}(f(u)_t)\n$$\n使用链式法则，$f(u)_t = f'(u) u_t$，其中 $f'(u)$ 是通量的雅可比矩阵。代入 $u_t = -f(u)_x$ 可得：\n$$\nu_{tt} = -\\frac{\\partial}{\\partial x}\\left(f'(u) (-f(u)_x)\\right) = \\frac{\\partial}{\\partial x}\\left(f'(u) f(u)_x\\right)\n$$\n对于伯格斯方程，$f'(u) = u$。将时间导数代回泰勒展开式会得到一个单步更新公式。然而，为了更容易地保持守恒形式，使用了等效的Richtmyer两步格式。设 $u^n_j$ 是在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的网格上对 $u(x_j, t_n)$ 的数值近似。\n\n**第 1 步：预测步。** 在单元界面 $x_{j+1/2}$ 和时间 $t_n + \\Delta t/2$ 计算一个中间解 $u^{n+1/2}_{j+1/2}$：\n$$\nu^{n+1/2}_{j+1/2} = \\frac{1}{2}(u^n_{j+1} + u^n_j) - \\frac{\\Delta t}{2 \\Delta x}(f(u^n_{j+1}) - f(u^n_j))\n$$\n这实际上是在半个区间上应用的前向时间、中心空间 (FTCS) 步。\n\n**第 2 步：校正步。** 最终解 $u^{n+1}_j$ 通过使用在预测的半步值处计算的通量的中心差分得到：\n$$\nu^{n+1}_j = u^n_j - \\frac{\\Delta t}{\\Delta x}(f(u^{n+1/2}_{j+1/2}) - f(u^{n+1/2}_{j-1/2}))\n$$\n该格式在空间和时间上都是二阶精确的，并且是守恒的，从而确保了正确的激波速度。\n\n**数值实现**\n模拟在 $N$ 个点的均匀网格上进行，$x_j = j \\Delta x$，其中 $j=0, \\dots, N-1$，且 $\\Delta x = 1/N$。周期性边界条件通过环绕索引来处理，例如，单元格 $N-1$ 的邻居是单元格 $0$。\n\n时间步长 $\\Delta t$ 是自适应的，在每次迭代时重新计算以满足Courant-Friedrichs-Lewy (CFL) 稳定性条件：\n$$\n\\max|f'(u^n)| \\frac{\\Delta t}{\\Delta x} \\leq \\mathrm{CFL}\n$$\n当 $f'(u) = u$ 且 $\\mathrm{CFL} = 0.9$ 时，时间步长为：\n$$\n\\Delta t = 0.9 \\frac{\\Delta x}{\\max_j |u^n_j|}\n$$\n模拟从 $t=0$ 运行到最终时间 $T=0.2$。最后一个时间步长会被调整以确保恰好在 $T$ 结束。\n\n**过冲计算**\n一旦得到最终解 $u(x,T)$，就计算过冲幅度 $\\mathcal{O}$。它被定义为对初始数据范围 $[u_{\\min}, u_{\\max}] = [0,1]$ 的最大违背。根据问题的定义：\n$$\n\\mathcal{O} = \\max\\left( \\max_x\\left( u(x,T) - u_{\\max} \\right), \\max_x\\left( u_{\\min} - u(x,T) \\right) \\right)\n$$\n其中最大值计算中的负值被视为 $0$。这等价于：\n$$\n\\mathcal{O} = \\max\\left( 0.0, \\max_x(u(x,T)) - 1.0, 0.0 - \\min_x(u(x,T)) \\right)\n$$\n该公式计算了高于 $u_{\\max}=1$ 或低于 $u_{\\min}=0$ 的最大偏差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_overshoot(N, nu, T_final=0.2, CFL=0.9):\n    \"\"\"\n    Solves the 1D inviscid Burgers' equation using the two-step Lax-Wendroff scheme\n    and computes the overshoot magnitude at a final time.\n\n    Args:\n        N (int): Number of grid points.\n        nu (float): Smoothing parameter for the initial condition.\n        T_final (float): Final time for the simulation.\n        CFL (float): CFL number for stability.\n\n    Returns:\n        float: The computed overshoot magnitude O.\n    \"\"\"\n    # 1. Grid and Initial Condition Setup\n    dx = 1.0 / N\n    # Grid points x_j = j*dx for j = 0, ..., N-1\n    x = np.linspace(0.0, 1.0 - dx, N)\n\n    u_L, u_R, x_0 = 1.0, 0.0, 0.5\n    u = u_R + 0.5 * (u_L - u_R) * (1.0 - np.tanh((x - x_0) / nu))\n\n    # 2. Flux Function\n    def f(u_vec):\n        \"\"\"Flux function for inviscid Burgers' equation.\"\"\"\n        return 0.5 * u_vec**2\n\n    # 3. Time Evolution Loop\n    t = 0.0\n    while t  T_final:\n        # a. Adaptive time step based on CFL condition\n        # f'(u) = u, so max|f'(u)| is max|u|\n        max_speed = np.max(np.abs(u))\n        if max_speed  1e-12: # Avoid division by zero if solution is trivial\n            dt = CFL * dx \n        else:\n            dt = CFL * dx / max_speed\n\n        # Ensure the final time step lands exactly on T_final\n        if t + dt > T_final:\n            dt = T_final - t\n        \n        # b. Two-Step Lax-Wendroff Scheme\n        # Periodic boundary conditions are handled by np.roll\n        \n        # Step 1: Predictor (calculates u at half-steps j+1/2)\n        # u_jp1 corresponds to u at index j+1\n        u_jp1 = np.roll(u, -1)\n        f_u = f(u)\n        f_u_jp1 = f(u_jp1)\n        u_half = 0.5 * (u_jp1 + u) - (dt / (2.0 * dx)) * (f_u_jp1 - f_u)\n\n        # Step 2: Corrector (updates u at grid points j)\n        f_half = f(u_half)\n        # f_half_jm1 corresponds to flux at half-step j-1/2\n        f_half_jm1 = np.roll(f_half, 1)\n        u = u - (dt / dx) * (f_half - f_half_jm1)\n\n        t += dt\n\n    # 4. Overshoot Calculation\n    u_max_range = 1.0\n    u_min_range = 0.0\n    \n    # Positive overshoot: max(u) - u_max_range\n    # Negative overshoot magnitude: u_min_range - min(u)\n    overshoot_pos = np.max(u) - u_max_range\n    overshoot_neg = u_min_range - np.min(u)\n    \n    # The magnitude is the larger of the two, or 0 if within range\n    overshoot_magnitude = np.max([0.0, overshoot_pos, overshoot_neg])\n\n    return overshoot_magnitude\n\ndef solve():\n    \"\"\"\n    Runs the simulation for all test cases and prints the results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (256, 0.05),     # Case 1\n        (512, 0.05),     # Case 2\n        (1024, 0.05),    # Case 3\n        (512, 0.02),     # Case 4\n        (512, 0.10),     # Case 5\n        (128, 0.01),     # Case 6\n    ]\n\n    results = []\n    for N, nu in test_cases:\n        result = compute_overshoot(N=N, nu=nu)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures high precision floating-point representation.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3375643"}]}