{"hands_on_practices": [{"introduction": "要分析任何时间积分格式，核心在于推导其稳定性函数 $R(z)$ 并解读其在复平面上的稳定性区域。本练习 [@problem_id:3287737] 将通过三个经典的一步法——前向欧拉、后向欧拉和梯形法则——来训练这项基本技能。通过这个过程，你将掌握分析积分器稳定性的基础，并接触到A-稳定性和L-稳定性等关键概念。", "problem": "考虑一个在线性化偏微分方程的计算流体动力学（CFD）直线法离散中出现的线性检验问题：常微分方程（ODE）$y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$ 代表半离散空间算子的一个特征值，且 $y(t) \\in \\mathbb{C}$。设时间步长为 $n$ 的单步数值更新可写为 $y_{n+1} = R(z)\\,y_n$，其中 $z = \\lambda \\,\\Delta t \\in \\mathbb{C}$ 且时间步长 $\\Delta t > 0$。函数 $R(z)$ 称为稳定性函数。绝对稳定区域是所有满足 $|R(z)| \\leq 1$ 的 $z \\in \\mathbb{C}$ 的集合。\n\n从以下应用于常微分方程 $y'(t) = \\lambda y(t)$ 的时间积分方法的基本定义出发：\n- Forward Euler 方法（显式一阶方法），\n- Backward Euler 方法（隐式一阶方法），\n- 梯形法则（隐式二阶方法，在常微分方程的背景下也称为 Crank–Nicolson 方法），\n\n对每种方法，推导其对应的稳定性函数 $R(z)$，并完整地刻画其在复平面上的绝对稳定区域。你的刻画必须包括一个描述该区域的精确不等式和一个几何描述。指出每种方法是否是 $A$-稳定的（绝对稳定区域包含半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$），以及是否是 $L$-稳定的（即沿负实轴 $\\lim_{z \\to -\\infty} R(z) = 0$）。\n\n作为你的最终答案，报告这三种方法的三个稳定性函数 $R(z)$，按 Forward Euler、Backward Euler、梯形法则的顺序排列成一个单行矩阵。不需要进行数值舍入。不需要单位。", "solution": "该问题是有效的，因为它提法明确，在常微分方程数值方法的理论中有科学依据，并且包含了获得唯一解所需的所有信息。我们将着手推导稳定性函数，并分析三种指定方法各自的稳定性质。\n\n模型问题是线性常微分方程（ODE）$y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$。应用于此 ODE 的单步数值方法产生一个形式为 $y_{n+1} = R(z) y_n$ 的递推关系，其中 $y_n$ 是对 $y(t_n)$ 的数值近似，$z = \\lambda \\Delta t$，$R(z)$ 是稳定性函数。\n\n将要分析的三种方法是前向欧拉法、后向欧拉法和梯形法则。\n\n**1. 前向欧拉法 (Forward Euler Method)**\n\n前向欧拉法是一种显式一阶方法，其更新规则定义为：\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_n)$$\n将此应用于检验方程 $y'(t) = \\lambda y(t)$，我们代入 $y'(t_n) = \\lambda y(t_n) \\approx \\lambda y_n$：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_n) = (1 + \\lambda \\Delta t) y_n$$\n通过令 $z = \\lambda \\Delta t$，我们可以识别出稳定性函数 $R(z)$：\n$$R_{\\text{FE}}(z) = 1 + z$$\n绝对稳定域由 $|R(z)| \\leq 1$ 定义。对于前向欧拉法，这是：\n$$|1 + z| \\leq 1$$\n令 $z = x + iy$，其中 $x, y \\in \\mathbb{R}$。不等式变为：\n$$|1 + x + iy| \\leq 1$$\n对模进行平方，我们得到：\n$$(1+x)^2 + y^2 \\leq 1^2$$\n这个不等式描述了复平面上以点 $(-1, 0)$ 为中心、半径为 $1$ 的闭圆盘。\n\n这个稳定域不包含整个左半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$。例如，点 $z = -3$ 满足 $\\operatorname{Re}(z) \\leq 0$ 但位于该圆盘之外。因此，前向欧拉法**不是 A-稳定的**。\n\n对于 L-稳定性，我们考察当 $z$ 沿负实轴趋于 $-\\infty$ 时 $R(z)$ 的极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{FE}}(z) = \\lim_{z \\to -\\infty} (1+z) = -\\infty$$\n由于极限不为 $0$，该方法**不是 L-稳定的**。\n\n**2. 后向欧拉法 (Backward Euler Method)**\n\n后向欧拉法是一种隐式一阶方法，定义为：\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_{n+1})$$\n将此应用于检验方程，我们代入 $y'(t_{n+1}) = \\lambda y(t_{n+1}) \\approx \\lambda y_{n+1}$：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1})$$\n我们必须解出 $y_{n+1}$：\n$$y_{n+1}(1 - \\lambda \\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 - \\lambda \\Delta t} y_n$$\n令 $z = \\lambda \\Delta t$，稳定性函数为：\n$$R_{\\text{BE}}(z) = \\frac{1}{1 - z}$$\n绝对稳定域由 $|R(z)| \\leq 1$ 给出：\n$$\\left|\\frac{1}{1-z}\\right| \\leq 1 \\implies 1 \\leq |1-z|$$\n令 $z = x + iy$。不等式变为：\n$$1 \\leq |1 - (x + iy)| = |(1-x) - iy|$$\n两边平方得：\n$$1^2 \\leq (1-x)^2 + (-y)^2 \\implies 1 \\leq (x-1)^2 + y^2$$\n这个不等式描述了复平面上以点 $(1, 0)$ 为中心、半径为 $1$ 的开圆盘的外部区域。该圆盘的边界包含在稳定区域内。\n\n为了检查 A-稳定性，我们必须验证该区域是否包含左半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$。对于任何满足 $x \\leq 0$ 的 $z=x+iy$，我们有 $x-1 \\leq -1$，这意味着 $(x-1)^2 \\geq 1$。由于 $y^2 \\geq 0$，对于左半平面中的任何 $z$，条件 $(x-1)^2 + y^2 \\geq 1$ 总是满足的。因此，后向欧拉法**是 A-稳定的**。\n\n对于 L-稳定性，我们计算极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{BE}}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0$$\n由于极限为 $0$，该方法**是 L-稳定的**。\n\n**3. 梯形法则 (Crank–Nicolson Method)**\n\n梯形法则是一种隐式二阶方法，定义为：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [y'(t_n) + y'(t_{n+1})]$$\n将此应用于检验方程，得到：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [\\lambda y_n + \\lambda y_{n+1}]$$\n解出 $y_{n+1}$：\n$$y_{n+1}\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = y_n\\left(1 + \\frac{\\lambda \\Delta t}{2}\\right)$$\n$$y_{n+1} = \\frac{1 + \\lambda \\Delta t / 2}{1 - \\lambda \\Delta t / 2} y_n$$\n令 $z = \\lambda \\Delta t$，稳定性函数为：\n$$R_{\\text{TR}}(z) = \\frac{1 + z/2}{1 - z/2} = \\frac{2+z}{2-z}$$\n绝对稳定域由 $|R(z)| \\leq 1$ 给出：\n$$\\left|\\frac{1 + z/2}{1 - z/2}\\right| \\leq 1 \\implies |1 + z/2| \\leq |1 - z/2|$$\n令 $z = x + iy$。不等式为：\n$$\\left|1 + \\frac{x+iy}{2}\\right| \\leq \\left|1 - \\frac{x+iy}{2}\\right|$$\n$$\\left|\\left(1+\\frac{x}{2}\\right) + i\\frac{y}{2}\\right| \\leq \\left|\\left(1-\\frac{x}{2}\\right) - i\\frac{y}{2}\\right|$$\n两边平方：\n$$\\left(1+\\frac{x}{2}\\right)^2 + \\left(\\frac{y}{2}\\right)^2 \\leq \\left(1-\\frac{x}{2}\\right)^2 + \\left(-\\frac{y}{2}\\right)^2$$\n$$1 + x + \\frac{x^2}{4} + \\frac{y^2}{4} \\leq 1 - x + \\frac{x^2}{4} + \\frac{y^2}{4}$$\n$$2x \\leq 0 \\implies x \\leq 0$$\n稳定区域恰好是复平面的闭合左半部分，即 $\\operatorname{Re}(z) \\leq 0$。\n\n根据定义，如果一个方法的稳定区域包含左半平面，那么该方法就是 A-稳定的。由于梯形法则的稳定区域恰好是左半平面，因此它**是 A-稳定的**。\n\n对于 L-稳定性，我们计算极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{TR}}(z) = \\lim_{z \\to -\\infty} \\frac{2+z}{2-z} = \\lim_{z \\to -\\infty} \\frac{2/z+1}{2/z-1} = \\frac{1}{-1} = -1$$\n由于极限是 $-1$ 而不是 $0$，该方法**不是 L-稳定的**。解的高频分量（对应于具有大负实部的 $z$）不会被衰减，而是以交替的符号持续存在。", "answer": "$$\\boxed{\\begin{pmatrix} 1+z  \\frac{1}{1-z}  \\frac{2+z}{2-z} \\end{pmatrix}}$$", "id": "3287737"}, {"introduction": "一个数值方法的实用性前提是，当步长减小时，其数值解必须收敛于真实解。Dahlquist等价定理指出，对于线性多步法，收敛性等价于相容性与零点稳定性的结合。本练习 [@problem_id:3287759] 将通过一个违反零点稳定性的例子，深刻揭示为何零点稳定性是任何实用多步格式都不可或缺的条件，即使该方法是相容的。", "problem": "在计算流体动力学 (CFD) 中，一种常见的途径是使用线法 (MOL) 对守恒律进行半离散化，从而得到一个形如 $y'(t) = f(t,y(t))$ 的初值问题，其中 $f$ 是一个光滑的右端项。在此背景下，线性多步法是一类标准的时间积分器。一个 $k$ 步线性多步法由系数 $\\{\\alpha_{j}\\}_{j=0}^{k}$ 和 $\\{\\beta_{j}\\}_{j=0}^{k}$ 定义，其形式为\n$$\n\\sum_{j=0}^{k} \\alpha_{j} y_{n+j} \\;=\\; h \\sum_{j=0}^{k} \\beta_{j} f\\!\\left(t_{n+j},y_{n+j}\\right),\n$$\n其中 $h$ 是常数时间步长，且 $t_{n} = t_{0} + n h$。如果方法的局部截断误差 $\\tau_{n}$ 在 $h \\to 0$ 时满足 $\\tau_{n} \\to 0$，则称该方法是相容的；如果特征多项式 $\\rho(\\zeta) = \\sum_{j=0}^{k} \\alpha_{j} \\zeta^{j}$ 的每个根 $\\zeta$ 都满足 $|\\zeta| \\le 1$，且任何模为 $1$ 的根都是单根，则称该方法是零稳定的。\n\n构造一个相容但非零稳定的两步法，并证明即使局部截断误差在 $h \\to 0$ 时趋于零，其全局误差也可能发散。按以下步骤进行。\n\n1. 考虑由系数 $\\alpha_{0} = 2$、$\\alpha_{1} = -3$、$\\alpha_{2} = 1$ 和 $\\beta_{0} = -1$、$\\beta_{1} = 0$、$\\beta_{2} = 0$ 定义的两步线性多步法，即\n$$\ny_{n+2} \\;-\\; 3 y_{n+1} \\;+\\; 2 y_{n} \\;=\\; -\\, h\\, f(t_{n},y_{n}).\n$$\n从光滑函数 $y(t)$ 的泰勒展开出发，推导局部截断误差\n$$\n\\tau_{n} \\;=\\; \\frac{1}{h} \\left( y(t_{n+2}) \\;-\\; 3 y(t_{n+1}) \\;+\\; 2 y(t_{n}) \\;+\\; h\\, y'(t_{n}) \\right)\n$$\n并证明当 $h \\to 0$ 时，它满足 $\\tau_{n} = \\mathcal{O}(h)$，因此该方法是相容的。显式计算 $\\tau_{n}$ 中的主项。\n\n2. 确定特征多项式 $\\rho(\\zeta)$ 及其根。得出该方法非零稳定的结论。\n\n3. 将该方法应用于线性问题 $y'(t) = \\exp(t)$，初值为 $y(0) = 1$，并从精确解中获取起始值 $y_{0} = y(0)$ 和 $y_{1} = y(h)$。令 $e_{n} = y_{n} - y(t_{n})$ 表示全局误差。仅使用上述定义和右端项关于 $y$ 的线性性，推导出精确的非齐次误差递推关系\n$$\ne_{n+2} \\;-\\; 3 e_{n+1} \\;+\\; 2 e_{n} \\;=\\; -\\, h\\, \\tau_{n}, \\quad e_{0} = 0,\\; e_{1} = 0,\n$$\n并证明对于所有足够小的 $h \\in \\left(0, \\ln 2\\right)$ 和任何固定的最终时间 $T > 0$（其中 $N = T/h$），误差大小 $|e_{N}|$ 的增长速度至少与 $c\\, h^{2}\\, 2^{N}$ 一样快，其中 $c > 0$ 是一个与 $h$ 无关的常数。得出结论：当 $h \\to 0$ 且 $T$ 固定时，有 $|e_{N}| \\to \\infty$，即尽管 $\\tau_{n} \\to 0$，全局误差仍然发散。\n\n作为具体的交付成果，计算此方法特征多项式的根半径 $R$（根的绝对值的最大值）。将 $R$ 报告为一个无量纲数。无需四舍五入。", "solution": "我们从两步线性多步法的标准形式开始，\n$$\n\\sum_{j=0}^{2} \\alpha_{j} y_{n+j} \\;=\\; h \\sum_{j=0}^{2} \\beta_{j} f(t_{n+j}, y_{n+j}).\n$$\n所给的系数为 $\\alpha_{0} = 2$、$\\alpha_{1} = -3$、$\\alpha_{2} = 1$ 和 $\\beta_{0} = -1$、$\\beta_{1} = 0$、$\\beta_{2} = 0$。因此，该方法可写为\n$$\ny_{n+2} \\;-\\; 3 y_{n+1} \\;+\\; 2 y_{n} \\;=\\; -\\, h\\, f(t_{n}, y_{n}).\n$$\n\n**步骤 1：通过局部截断误差验证相容性**\n局部截断误差 $\\tau_{n}$ 是将精确解 $y(t)$ 代入格式中，再除以 $h$ 所得到的余项：\n$$\n\\tau_{n} \\;=\\; \\frac{1}{h} \\left( y(t_{n+2}) \\;-\\; 3 y(t_{n+1}) \\;+\\; 2 y(t_{n}) \\;+\\; h\\, y'(t_{n}) \\right).\n$$\n令 $t = t_{n}$。使用 $y(t+h)$ 和 $y(t+2h)$ 在 $t$ 点的泰勒展开，\n$$\n\\begin{aligned}\ny(t+h) = y(t) + h y'(t) + \\frac{h^{2}}{2} y''(t) + \\frac{h^{3}}{6} y^{(3)}(t) + \\mathcal{O}(h^{4}), \\\\\ny(t+2h) = y(t) + 2 h y'(t) + \\frac{(2h)^{2}}{2} y''(t) + \\frac{(2h)^{3}}{6} y^{(3)}(t) + \\mathcal{O}(h^{4}),\n\\end{aligned}\n$$\n我们计算\n$$\n\\begin{aligned}\ny(t+2h) - 3 y(t+h) + 2 y(t) + h y'(t) \\\\\n= \\left[ y(t) + 2 h y'(t) + 2h^2 y''(t) + \\frac{4h^3}{3} y^{(3)}(t) \\right] \\\\\n\\quad - 3 \\left[ y(t) + h y'(t) + \\frac{h^2}{2} y''(t) + \\frac{h^3}{6} y^{(3)}(t) \\right] + 2 y(t) + h y'(t) + \\mathcal{O}(h^{4}) \\\\\n= (1 - 3 + 2) y(t) + (2h - 3h + h) y'(t) + \\left(2h^2 - \\frac{3h^2}{2}\\right) y''(t) + \\left(\\frac{4h^3}{3} - \\frac{h^3}{2}\\right) y^{(3)}(t) + \\mathcal{O}(h^{4}) \\\\\n= \\frac{1}{2} h^{2} y''(t) + \\frac{5}{6} h^{3} y^{(3)}(t) + \\mathcal{O}(h^{4}).\n\\end{aligned}\n$$\n两边除以 $h$ 得到\n$$\n\\tau_{n} \\;=\\; \\frac{1}{2} h\\, y''(t_{n}) \\;+\\; \\frac{5}{6} h^{2} y^{(3)}(t_{n}) \\;+\\; \\mathcal{O}(h^{3}),\n$$\n所以当 $h \\to 0$ 时 $\\tau_{n} = \\mathcal{O}(h)$。这验证了相容性，并额外确定了 $\\tau_{n}$ 中的主项为 $(1/2) h\\, y''(t_{n})$。\n\n**步骤 2：零稳定性**\n特征多项式为\n$$\n\\rho(\\zeta) \\;=\\; \\alpha_{0} + \\alpha_{1} \\zeta + \\alpha_{2} \\zeta^{2} \\;=\\; 2 \\;-\\; 3 \\zeta \\;+\\; \\zeta^{2} \\;=\\; (\\zeta - 1) (\\zeta - 2).\n$$\n其根为 $\\zeta_{1} = 1$ 和 $\\zeta_{2} = 2$。由于存在模大于 $1$ 的根（$\\zeta_2 = 2$），该方法不满足根条件，因此非零稳定。\n\n**步骤 3：对于光滑右端项，全局误差的发散性**\n考虑 $y'(t) = \\exp(t)$ 且 $y(0) = 1$，并定义 $e_{n} = y_{n} - y(t_{n})$。因为右端项与 $y$ 无关，从数值格式中减去代入精确解后的表达式，即可得到全局误差的线性非齐次递推关系，\n$$\ne_{n+2} \\;-\\; 3 e_{n+1} \\;+\\; 2 e_{n} \\;=\\; -\\, h\\, \\tau_{n}, \\qquad e_{0} = 0, \\quad e_{1} = 0.\n$$\n根据步骤 1，当 $y(t) = \\exp(t)$ 时，我们有\n$$\n\\tau_{n} \\;=\\; \\frac{1}{2} h\\, y''(t_{n}) \\;+\\; \\mathcal{O}(h^{2}) \\;=\\; \\frac{1}{2} h\\, \\exp(t_{n}) \\;+\\; \\mathcal{O}(h^{2}).\n$$\n因此存在 $h_{0} \\in (0, \\ln 2)$ 和一个常数 $c_{0} \\in (0, 1/2)$，使得对于所有 $h \\in (0, h_{0}]$ 和所有满足 $t_{n} \\in [0,T]$ 的 $n$，\n$$\n\\tau_{n} \\;\\ge\\; c_{0}\\, h\\, \\exp(t_{n}).\n$$\n定义 $r_{n} = - h\\, \\tau_{n}$，则 $r_{n} \\le - c_{0}\\, h^{2} \\exp(t_{n})$ 且 $|r_{n}| \\ge c_{0}\\, h^{2} \\exp(t_{n})$。\n\n我们现在根据驱动序列 $\\{r_{n}\\}$ 显式地解此递推关系。当 $e_{0} = e_{1} = 0$ 时，通过归纳法可得到精确表示\n$$\ne_{n} \\;=\\; \\sum_{j=0}^{n-2} \\left( 2^{\\,n-1-j} \\;-\\; 1 \\right) r_{j}, \\qquad n \\ge 2.\n$$\n此恒等式可通过对 $n$ 进行直接归纳来验证：\n- 对于 $n=2$，$e_2 = (2^1-1)r_0 = r_0$。这与递推关系 $e_2 - 3e_1 + 2e_0 = r_0$ (其中 $e_0=e_1=0$) 一致，所以成立。\n- 假设该式对所有小于或等于 $n+1$ 的指标都成立。那么，\n$$\n\\begin{aligned}\ne_{n+2} = 3 e_{n+1} - 2 e_{n} + r_n \\\\\n= 3 \\sum_{j=0}^{n-1} \\left( 2^{n-j} - 1 \\right) r_{j} - 2 \\sum_{j=0}^{n-2} \\left( 2^{n-1-j} - 1 \\right) r_{j} + r_{n} \\\\\n= 3 \\left( 2^{n-(n-1)} - 1 \\right) r_{n-1} + \\sum_{j=0}^{n-2} \\left[ 3 \\left( 2^{n-j} - 1 \\right) - 2 \\left( 2^{n-1-j} - 1 \\right) \\right] r_{j} + r_{n} \\\\\n= 3(2-1)r_{n-1} + \\sum_{j=0}^{n-2} \\left[ 3 \\cdot 2^{n-j} - 3 - 2^{n-j} + 2 \\right] r_{j} + r_{n} \\\\\n= 3r_{n-1} + \\sum_{j=0}^{n-2} \\left[ 2 \\cdot 2^{n-j} - 1 \\right] r_{j} + r_{n} \\\\\n= (2^2 - 1)r_{n-1} + \\sum_{j=0}^{n-2} \\left( 2^{n+1-j} - 1 \\right) r_{j} + (2^1 - 1)r_n \\\\\n= \\left( 2^{n+1-(n-1)} - 1 \\right) r_{n-1} + \\sum_{j=0}^{n-2} \\left( 2^{n+1-j} - 1 \\right) r_{j} + \\left( 2^{n+1-n} - 1 \\right) r_{n} \\\\\n= \\sum_{j=0}^{n} \\left( 2^{n+1-j} - 1 \\right) r_{j}\n\\end{aligned}\n$$\n这正是指标为 $n+2$ 时所声称的形式，即 $e_{n+2} = \\sum_{j=0}^{(n+2)-2} (2^{(n+2)-1-j} - 1)r_j = \\sum_{j=0}^{n} (2^{n+1-j} - 1)r_j$。\n\n因此，对于 $N = T/h$ 和 $h \\in (0, h_{0}]$，我们有\n$$\n\\begin{aligned}\n|e_{N}| = \\left| \\sum_{j=0}^{N-2} \\left( 2^{\\,N-1-j} - 1 \\right) r_{j} \\right| \\\\\n= \\sum_{j=0}^{N-2} \\left( 2^{\\,N-1-j} - 1 \\right) |r_{j}| \\quad \\text{因为 } r_{j} \\le 0 \\\\\n\\ge \\sum_{j=0}^{N-2} 2^{\\,N-1-j} |r_{j}| \\;-\\; \\sum_{j=0}^{N-2} |r_{j}| \\\\\n\\ge c_{0} h^{2} 2^{\\,N-1} \\sum_{j=0}^{N-2} \\frac{\\exp(jh)}{2^j} \\;-\\; c_{0} h^{2} \\sum_{j=0}^{N-2} \\exp(j h) \\\\\n= c_{0} h^{2} 2^{\\,N-1} \\sum_{j=0}^{N-2} \\left( \\frac{\\exp(h)}{2} \\right)^{j} \\;-\\; c_{0} h^{2} \\sum_{j=0}^{N-2} \\exp(j h).\n\\end{aligned}\n$$\n对于所有 $h \\in (0, h_{0}] \\subset (0, \\ln 2)$，比值 $\\exp(h)/2 \\in (0,1)$，因此该几何级数和有一个一致下界 $C_1 > 0$。第二个和有界于 $\\sum_{j=0}^{N-2} \\exp(j h) \\le N \\exp(T) = (T/h) \\exp(T)$。因此，\n$$\n|e_{N}| \\;\\ge\\; c_{0} C_{1}\\, h^{2}\\, 2^{\\,N-1} \\;-\\; c_0 h (T \\exp(T)).\n$$\n当 $h \\to 0$ 且 $N = T/h \\to \\infty$ 时，项 $2^{\\,N-1} = 2^{\\,T/h - 1}$ 的指数增长支配了任何代数项，因此 $|e_{N}| \\to \\infty$。这表明，尽管当 $h \\to 0$ 时 $\\tau_{n} \\to 0$（相容性），但由于零稳定性的失效，全局误差仍然发散。\n\n最终交付成果。特征多项式为 $\\rho(\\zeta) = \\zeta^{2} - 3 \\zeta + 2$，其根为 $\\zeta = 1$ 和 $\\zeta = 2$，因此根半径为 $R = 2$。", "answer": "$$\\boxed{2}$$", "id": "3287759"}, {"introduction": "理论上，A-稳定性保证了刚性问题的稳定性，但这并不总能确保良好的数值行为。这个编程实践 [@problem_id:3287801] 旨在对比一种仅为A-稳定的方法（BDF2）和一种L-稳定的方法（SDIRK），以揭示所谓的“振铃”或非物理振荡现象。通过亲手实现这些格式，你将直接观察到为何在精确模拟以刚性扩散或反应为主导的瞬态过程时，L-稳定性是一个极其重要的特性。", "problem": "考虑标量刚性弛豫常微分方程 (ODE) $u_t = -\\lambda \\left(u - u^\\ast\\right)$，其中 $\\lambda \\gg 1$。定义偏差变量 $v(t) = u(t) - u^\\ast$，它满足 $v_t = -\\lambda v$，其精确解为 $v(t) = v(0)\\,\\exp\\left(-\\lambda t\\right)$。对于固定的时间步长 $\\Delta t$，定义无量纲刚性参数 $r = \\lambda \\Delta t$。您将比较二阶两步向后差分格式 (Backward Differentiation Formula of order 2, BDF method of order 2, 缩写为 BDF2) 和一个L-稳定的二阶单对角隐式龙格-库塔方法 (Singly Diagonally Implicit Runge–Kutta method, SDIRK method) 的精度和稳定性表现。\n\n您的程序必须实现以下内容，仅使用以下基本事实：(i) BDF2 使用二阶向后差分，其右侧项在新时间点上取值；(ii) SDIRK 方法使用两个具有相同对角系数的隐式阶段：\n\n- 转换为 $v(t) = u(t) - u^\\ast$，从而数值任务简化为对 $v_t = -\\lambda v$ 进行积分。\n- 对于 BDF2，在第一个时间层级使用一个后向欧拉启动步，然后在第二个时间层级使用一个 BDF2 步，两者都使用相同的步长 $\\Delta t$。这通过单个后向欧拉步从 $v^0$ 生成 $v^1$，然后通过单个 BDF2 步从 $\\left(v^1,v^0\\right)$ 生成 $v^2$。\n- 对于 SDIRK，使用标准的、对角参数为 $\\gamma = 1 - 1/\\sqrt{2}$ 的两阶段二阶 SDIRK 方法，从 $v^0$ 开始，应用两个具有相同 $\\Delta t$ 的步长来获得 $v^2$。\n\n对于每种方法，您必须：\n- 通过检查任意步骤中 $v$ 的符号是否与 $v^0$ 的符号相比发生了变化，来检测相对于稳态的过冲或下冲。形式上，定义一个布尔值，如果存在任何步索引 $n$ 使得 $v^n \\cdot v^0  0$ 且 $|v^n| > 0$，则该值为 $\\mathrm{True}$；否则为 $\\mathrm{False}$。\n- 通过计算比率 $\\rho = |v^2|/|v^0|$ 来量化两步后的渐近阻尼。\n\n通过推导方法定义所隐含的代数更新，为线性问题 $v_t = -\\lambda v$ 从第一性原理实现这两种方法。对于 BDF2 步，推导并利用将 $v^{n+1}$ 与 $\\left(v^n,v^{n-1}\\right)$ 联系起来的线性递推关系，用于方程 $v_t = -\\lambda v$。对于 SDIRK 步，推导并利用将参数为 $\\gamma$ 的两阶段方法应用于 $v_t = -\\lambda v$ 时的阶段方程，然后使用阶段值形成时间更新。避免任何自适应时间步长或非线性迭代；对于此标量线性问题，阶段方程和步进方程可以以闭合形式求解。\n\n测试套件：\n在以下参数集上运行您的程序，每个参数集由 $\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right)$ 组成，使用大小为 $\\Delta t$ 的恰好两个均匀步长：\n- 情况 1：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(50,\\,0.02,\\,2,\\,1\\right)$，因此 $r = 1$。\n- 情况 2：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(1000,\\,0.1,\\,2,\\,1\\right)$，因此 $r = 100$。\n- 情况 3：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(50,\\,0.001,\\,2,\\,1\\right)$，因此 $r = 0.05$。\n- 情况 4：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(200,\\,0.05,\\,0,\\,1\\right)$，因此 $r = 10$ 且初始偏差为负。\n- 情况 5：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(10^6,\\,10^{-3},\\,3,\\,1\\right)$，因此 $r = 1000$。\n\n对于每种情况，按顺序计算并返回以下 4 个量：\n- BDF2 过冲布尔值。\n- SDIRK 过冲布尔值。\n- BDF2 两步阻尼比 $\\rho_{\\mathrm{BDF2}} = |v^2|/|v^0|$。\n- SDIRK 两步阻尼比 $\\rho_{\\mathrm{SDIRK}} = |v^2|/|v^0|$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个形如 $\\left[\\text{BDF2\\_overshoot},\\text{SDIRK\\_overshoot},\\rho_{\\mathrm{BDF2}},\\rho_{\\mathrm{SDIRK}}\\right]$ 的子列表。\n- 布尔值必须显示为 $\\mathrm{True}$ 或 $\\mathrm{False}$。\n- 浮点数必须使用标准的四舍五入精确到 6 位小数。\n- 方括号内任何位置都不得有多余的空白字符。\n\n所需格式示例（仅供说明）：$\\left[[\\mathrm{False},\\mathrm{False},0.123456,0.012345],[\\dots]\\right]$。", "solution": "用户提交了来自数值分析领域的有效问题陈述，具体涉及刚性常微分方程时间积分格式的稳定性和准确性。该问题具有科学依据，提法恰当，客观，并包含唯一解所需的所有必要信息。我现在将进行正式的推导和求解。\n\n该问题要求对应用于标量线性刚性弛豫方程的两种二阶时间积分格式进行比较分析：\n$$\n\\frac{du}{dt} = u_t = -\\lambda (u - u^\\ast)\n$$\n其中 $\\lambda \\gg 1$。通过将与平衡态的偏差定义为 $v(t) = u(t) - u^\\ast$，我们得到更简单的齐次线性 ODE：\n$$\n\\frac{dv}{dt} = v_t = -\\lambda v\n$$\n数值分析将在此方程上进行。无量纲刚性参数定义为 $r = \\lambda \\Delta t$，其中 $\\Delta t$ 是固定的时间步长。我们将为 BDF2 和 SDIRK 方法推导过冲和两步阻尼比 $\\rho = |v^2|/|v^0|$ 的表达式。\n\n### 二阶向后差分格式 (BDF2)\n\nBDF2 方法的指定过程包括一个使用一阶后向欧拉 (BE) 方法的启动步，然后是一个二阶 BDF2 方法的步进。\n\n**1. 后向欧拉启动步：**\n将 BE 方法应用于 $v_t = -\\lambda v$ 以从 $t_0=0$ 时的 $v^0$ 求出时间 $t_1 = \\Delta t$ 时的近似值 $v^1$ 由下式给出：\n$$\n\\frac{v^1 - v^0}{\\Delta t} = -\\lambda v^1\n$$\n求解 $v^1$ 可得：\n$$\nv^1 - v^0 = -(\\lambda \\Delta t) v^1 = -r v^1\n$$\n$$\nv^1 (1 + r) = v^0 \\implies v^1 = \\frac{1}{1+r} v^0\n$$\n\n**2. BDF2 步：**\nBDF2 方法使用 $v^0$ 和 $v^1$ 来求出时间 $t_2 = 2\\Delta t$ 时的 $v^2$。该公式源自于在 $t_{n+1}$ 处对导数的二阶向后差分近似：\n$$\n\\frac{3v^{n+1} - 4v^n + v^{n-1}}{2\\Delta t} = f(t_{n+1}, v^{n+1}) = -\\lambda v^{n+1}\n$$\n对于我们的第二步 ($n=1$)，这变为：\n$$\n\\frac{3v^2 - 4v^1 + v^0}{2\\Delta t} = -\\lambda v^2\n$$\n$$\n3v^2 - 4v^1 + v^0 = -2(\\lambda \\Delta t) v^2 = -2r v^2\n$$\n求解 $v^2$：\n$$\nv^2(3 + 2r) = 4v^1 - v^0\n$$\n代入来自 BE 步的 $v^1$ 表达式：\n$$\nv^2(3 + 2r) = 4\\left(\\frac{1}{1+r} v^0\\right) - v^0 = \\left(\\frac{4}{1+r} - 1\\right) v^0 = \\frac{4 - (1+r)}{1+r} v^0 = \\frac{3-r}{1+r} v^0\n$$\n因此，该两步过程的放大因子为：\n$$\nG_{\\mathrm{BDF2}}(r) = \\frac{v^2}{v^0} = \\frac{3-r}{(1+r)(3+2r)}\n$$\n\n**3. BDF2 的过冲和阻尼：**\n- **过冲：**如果任何 $v^n$ 的符号与 $v^0$ 相反，则会发生过冲。\n  - 对于第一步，$v^1/v^0 = 1/(1+r)$，对于 $r > 0$ 始终为正。第一步不会发生过冲。\n  - 对于第二步，$v^2/v^0$ 的符号由 $G_{\\mathrm{BDF2}}(r)$ 的符号决定。由于分母 $(1+r)(3+2r)$ 对于 $r>0$ 为正，符号由分子 $3-r$ 决定。如果 $3-r  0$ (即 $r > 3$)，则发生过冲。\n- **阻尼比：**两步阻尼比为 $\\rho_{\\mathrm{BDF2}} = |v^2/v^0| = |G_{\\mathrm{BDF2}}(r)|$。\n$$\n\\rho_{\\mathrm{BDF2}} = \\left| \\frac{3-r}{(1+r)(3+2r)} \\right|\n$$\n\n### 单对角隐式龙格-库塔 (SDIRK) 方法\n\n问题指定了一个两阶段、二阶、$L$-稳定的 SDIRK 方法，其对角 Butcher 系数为 $\\gamma = 1 - 1/\\sqrt{2}$。对于线性 ODE $v_t = -\\lambda v$，龙格-库塔方法的单步执行等效于乘以其稳定性函数，$v^{n+1} = R(-\\lambda \\Delta t) v^n = R(-r) v^n$。对于此 SDIRK 方法，稳定性函数为 $R(-r) = \\frac{1 - r(1-2\\gamma)}{(1+r\\gamma)^2}$。我们将此单步放大因子表示为 $S(r) = R(-r)$。\n\n两步过程涉及使用相同的步长 $\\Delta t$ 应用此方法两次。\n$v^1 = S(r) v^0$\n$v^2 = S(r) v^1 = (S(r))^2 v^0$\n\n**1. SDIRK 放大因子：**\n当 $\\gamma = 1 - 1/\\sqrt{2}$ 时，我们可以简化一些项：\n$1 - 2\\gamma = 1 - 2(1 - 1/\\sqrt{2}) = 1 - 2 + \\sqrt{2} = \\sqrt{2} - 1$。\n单步放大因子为：\n$$\nS(r) = \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2}\n$$\n两步放大因子为 $G_{\\mathrm{SDIRK}}(r) = v^2/v^0 = (S(r))^2$。\n\n**2. SDIRK 的过冲和阻尼：**\n- **过冲：**如果 $v^1$ 或 $v^2$ 的符号与 $v^0$ 相反，则发生过冲。\n  - 对于第二步，$v^2/v^0 = (S(r))^2 \\ge 0$。相对于初始状态 $v^0$，第二步不可能发生过冲。\n  - 对于第一步，如果 $v^1/v^0 = S(r)  0$ 则发生过冲。$S(r)$ 的分母是一个平方，因此是非负的。符号由分子 $1 - r(\\sqrt{2}-1)$ 决定。过冲的条件是 $1 - r(\\sqrt{2}-1)  0$，这意味着 $r > \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1 \\approx 2.414$。\n- **阻尼比：**两步阻尼比为 $\\rho_{\\mathrm{SDIRK}} = |v^2/v^0| = |(S(r))^2| = (S(r))^2$。\n$$\n\\rho_{\\mathrm{SDIRK}} = \\left( \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2} \\right)^2\n$$\n\n基于这些推导，可以实现一个程序来为给定的测试套件计算所需的量。", "answer": "```python\n# 完整且可运行的 Python 3 代码在此处。\n# 导入必须遵守指定的执行环境。\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    解决比较 BDF2 和 SDIRK 方法处理刚性 ODE 的问题。\n    \"\"\"\n    # 根据问题陈述定义测试用例。\n    test_cases = [\n        # (lambda, dt, u0, u_star)\n        (50.0, 0.02, 2.0, 1.0),    # r = 1\n        (1000.0, 0.1, 2.0, 1.0),   # r = 100\n        (50.0, 0.001, 2.0, 1.0),   # r = 0.05\n        (200.0, 0.05, 0.0, 1.0),   # r = 10\n        (10**6, 10**-3, 3.0, 1.0)  # r = 1000\n    ]\n\n    all_results = []\n    \n    # SDIRK 方法的常量\n    sqrt2 = np.sqrt(2)\n    gamma = 1 - 1 / sqrt2\n    sdirk_overshoot_threshold = sqrt2 + 1\n    sqrt2_minus_1 = sqrt2 - 1\n    \n    # BDF2 过冲阈值\n    bdf2_overshoot_threshold = 3.0\n\n    for case in test_cases:\n        lam, dt, u0, u_star = case\n        \n        # 计算无量纲刚性参数\n        r = lam * dt\n        \n        # -------- BDF2 方法 --------\n        # 检查过冲\n        bdf2_overshoot = r > bdf2_overshoot_threshold\n        \n        # 计算两步阻尼比\n        rho_bdf2_val = abs((3 - r) / ((1 + r) * (3 + 2 * r)))\n\n        # -------- SDIRK 方法 --------\n        # 检查过冲\n        sdirk_overshoot = r > sdirk_overshoot_threshold\n        \n        # 计算单步放大因子\n        s_of_r = (1 - r * sqrt2_minus_1) / (1 + r * gamma)**2\n        \n        # 计算两步阻尼比\n        rho_sdirk_val = s_of_r**2\n        \n        # 为一个案例组装结果，格式化为字符串\n        case_results = [\n            \"True\" if bdf2_overshoot else \"False\",\n            \"True\" if sdirk_overshoot else \"False\",\n            f\"{rho_bdf2_val:.6f}\",\n            f\"{rho_sdirk_val:.6f}\"\n        ]\n        all_results.append(case_results)\n\n    # 完全按照规定格式化最终输出字符串\n    inner_strings = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # 最终的 print 语句必须只生成指定的单行格式。\n    print(final_output)\n\nsolve()\n```", "id": "3287801"}]}