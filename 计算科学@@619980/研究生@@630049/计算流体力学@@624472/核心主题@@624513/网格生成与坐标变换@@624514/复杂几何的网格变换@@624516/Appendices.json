{"hands_on_practices": [{"introduction": "在评估网格对数值模拟的影响之前，我们必须首先掌握如何用数学语言精确描述网格的局部几何特性。本练习将引导你通过一个经典的极坐标式映射，从第一性原理出发计算度量张量。这是理解网格正交性、单元拉伸比等关键概念的基石，为你分析更复杂的网格变换打下坚实的数学基础。[@problem_id:3327571]", "problem": "在计算流体动力学 (CFD) 中，针对复杂几何形状的曲线网格生成通常采用从计算域到物理域的映射。考虑从计算坐标 $(\\xi,\\eta)$ 到笛卡尔物理坐标 $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$ 的二维映射，其表达式为：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\big(r(\\xi)\\cos\\eta,\\; r(\\xi)\\sin\\eta\\big), \\quad r(\\xi) = 1 + \\beta\\,\\xi,\n$$\n其中 $\\beta0$，$\\xi\\in[0,1]$，且 $\\eta\\in[0,2\\pi)$ 以弧度为单位。仅使用CFD中曲线坐标微分几何的基本定义（协变基向量、度量张量、正交性判据和尺度因子），执行以下操作：\n\n- 从协变基向量的定义 $\\mathbf{x}_{\\xi}=\\partial\\mathbf{x}/\\partial\\xi$ 和 $\\mathbf{x}_{\\eta}=\\partial\\mathbf{x}/\\partial\\eta$ 出发，推导协变度量张量分量 $g_{ij}=\\mathbf{x}_{i}\\cdot\\mathbf{x}_{j}$（其中 $i,j\\in\\{\\xi,\\eta\\}$），并用 $\\beta$、$\\xi$ 和 $\\eta$ 表示。\n- 使用曲线坐标中的正交性定义，判断坐标线是否正交，并解释参数 $\\beta$ 如何影响正交性。\n- 将局部单元纵横比 $A(\\xi,\\eta)$ 定义为尺度因子之比 $h_{\\eta}/h_{\\xi}$，其中 $h_{i}=\\sqrt{g_{ii}}$（$i\\in\\{\\xi,\\eta\\}$）。用 $\\beta$ 和 $\\xi$ 推导出 $A(\\xi,\\eta)$，并解释 $\\beta$ 的变化如何改变整个网格的纵横比分布。\n\n最终答案仅报告纵横比 $A(\\xi)$ 关于 $\\beta$ 和 $\\xi$ 的闭式解析表达式。无需数值计算，也无需四舍五入。最终答案中不要包含单位。", "solution": "该问题经验证具有科学依据、提法恰当、客观且完整。所有必要信息均已提供，且任务在应用于计算流体动力学的微分几何标准框架内定义明确。求解过程如下。\n\n问题提供了一个从计算坐标 $(\\xi, \\eta)$ 到物理笛卡尔坐标 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta))$ 的二维映射。该映射由下式给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\big(r(\\xi)\\cos\\eta, r(\\xi)\\sin\\eta\\big)\n$$\n其中 $r(\\xi) = 1 + \\beta\\xi$，约束条件为 $\\beta  0$，$\\xi \\in [0, 1]$，以及 $\\eta \\in [0, 2\\pi)$。\n\n首先，我们推导协变度量张量分量 $g_{ij}$。这需要计算协变基向量 $\\mathbf{x}_{\\xi}$ 和 $\\mathbf{x}_{\\eta}$，它们是位置向量 $\\mathbf{x}$ 关于计算坐标的偏导数。\n\n位置向量为 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta)) = \\big((1+\\beta\\xi)\\cos\\eta, (1+\\beta\\xi)\\sin\\eta\\big)$。\n\n关于 $\\xi$ 的偏导数为：\n$$\n\\mathbf{x}_{\\xi} = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\left( \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\xi} = (\\beta\\cos\\eta, \\beta\\sin\\eta)\n$$\n\n关于 $\\eta$ 的偏导数为：\n$$\n\\mathbf{x}_{\\eta} = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\left( \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta, (1+\\beta\\xi)\\cos\\eta\\big)\n$$\n\n接下来，我们计算协变度量张量的分量 $g_{ij} = \\mathbf{x}_{i} \\cdot \\mathbf{x}_{j}$，其中 $i, j \\in \\{\\xi, \\eta\\}$。\n\n分量 $g_{\\xi\\xi}$ 为：\n$$\ng_{\\xi\\xi} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\xi} = (\\beta\\cos\\eta)^2 + (\\beta\\sin\\eta)^2 = \\beta^2\\cos^2\\eta + \\beta^2\\sin^2\\eta = \\beta^2(\\cos^2\\eta + \\sin^2\\eta) = \\beta^2\n$$\n\n分量 $g_{\\eta\\eta}$ 为：\n$$\ng_{\\eta\\eta} = \\mathbf{x}_{\\eta} \\cdot \\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta\\big)^2 + \\big((1+\\beta\\xi)\\cos\\eta\\big)^2 = (1+\\beta\\xi)^2\\sin^2\\eta + (1+\\beta\\xi)^2\\cos^2\\eta\n$$\n$$\ng_{\\eta\\eta} = (1+\\beta\\xi)^2(\\sin^2\\eta + \\cos^2\\eta) = (1+\\beta\\xi)^2\n$$\n\n非对角分量 $g_{\\xi\\eta}$ 为：\n$$\ng_{\\xi\\eta} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\eta} = (\\beta\\cos\\eta)\\big(-(1+\\beta\\xi)\\sin\\eta\\big) + (\\beta\\sin\\eta)\\big((1+\\beta\\xi)\\cos\\eta\\big)\n$$\n$$\ng_{\\xi\\eta} = -\\beta(1+\\beta\\xi)\\cos\\eta\\sin\\eta + \\beta(1+\\beta\\xi)\\sin\\eta\\cos\\eta = 0\n$$\n由于度量张量是对称的，所以 $g_{\\eta\\xi} = g_{\\xi\\eta} = 0$。\n\n因此，协变度量张量的分量为：\n$$\ng_{\\xi\\xi} = \\beta^2, \\quad g_{\\eta\\eta} = (1+\\beta\\xi)^2, \\quad g_{\\xi\\eta} = g_{\\eta\\xi} = 0\n$$\n\n第二个任务是判断坐标线是否正交。一个曲线坐标系是正交的，当且仅当其度量张量的非对角分量为零。在本例中，我们发现对于 $\\xi$ 和 $\\eta$ 在其各自定义域内的所有值，$g_{\\xi\\eta} = g_{\\eta\\xi} = 0$。这意味着基向量 $\\mathbf{x}_{\\xi}$ 和 $\\mathbf{x}_{\\eta}$ 在每一点都是正交的。因此，坐标线（即 $\\xi$ 等值线和 $\\eta$ 等值线）在整个网格上都是正交的。参数 $\\beta$ 是一个正常数，它影响 $\\mathbf{x}_{\\xi}$ 的大小，但不改变 $g_{\\xi\\eta}=0$ 这一事实。所以，对于任何 $\\beta  0$，该坐标系都是正交的，$\\beta$ 对正交属性本身没有影响。从几何角度看，$\\xi$ 等值线是圆，而 $\\eta$ 等值线是径向线，这两组线总是相互正交的。\n\n第三个任务是推导局部单元纵横比，其定义为 $A(\\xi, \\eta) = h_{\\eta}/h_{\\xi}$。尺度因子（或称拉梅系数）$h_i$ 定义为 $h_i = \\sqrt{g_{ii}}$。\n\n尺度因子 $h_{\\xi}$ 为：\n$$\nh_{\\xi} = \\sqrt{g_{\\xi\\xi}} = \\sqrt{\\beta^2} = |\\beta|\n$$\n已知 $\\beta  0$，我们有 $h_{\\xi} = \\beta$。\n\n尺度因子 $h_{\\eta}$ 为：\n$$\nh_{\\eta} = \\sqrt{g_{\\eta\\eta}} = \\sqrt{(1+\\beta\\xi)^2} = |1+\\beta\\xi|\n$$\n已知 $\\beta  0$ 且 $\\xi \\in [0, 1]$，项 $1+\\beta\\xi$ 严格为正，所以 $|1+\\beta\\xi| = 1+\\beta\\xi$。因此，$h_{\\eta} = 1+\\beta\\xi$。\n\n现在，我们可以计算纵横比 $A(\\xi, \\eta)$：\n$$\nA(\\xi, \\eta) = \\frac{h_{\\eta}}{h_{\\xi}} = \\frac{1+\\beta\\xi}{\\beta}\n$$\n纵横比的表达式仅依赖于 $\\xi$ 和 $\\beta$，而与 $\\eta$ 无关。因此，我们可以将其写作 $A(\\xi)$。\n$$\nA(\\xi) = \\frac{1+\\beta\\xi}{\\beta} = \\frac{1}{\\beta} + \\xi\n$$\n为了解释 $\\beta$ 的影响，我们考察这个表达式。纵横比 $A(\\xi)$ 表示 $\\eta$ 方向（方位角方向）的局部弧长与 $\\xi$ 方向（径向）的局部长度之比。\n- 对于一个固定的 $\\beta$，$A(\\xi)$ 随 $\\xi$ 线性增加。在内边界（$\\xi=0$）处，$A(0) = 1/\\beta$。在外边界（$\\xi=1$）处，$A(1) = (1+\\beta)/\\beta = 1/\\beta + 1$。这表明当沿径向向外移动时，网格单元在方位角方向上逐渐被拉伸。\n- 对于一个较小的 $\\beta  0$，$1/\\beta$ 的值很大。这导致整个域的纵横比都很大，意味着单元在 $\\eta$ 方向上被高度拉长。这对应于一个狭窄的环形区域，其中径向网格间距（与 $\\beta$ 成正比）远小于方位角间距（与 $r(\\xi)=1+\\beta\\xi \\approx 1$ 成正比）。\n- 对于一个较大的 $\\beta$，$1/\\beta$ 的值很小。纵横比在 $\\xi=0$ 处从接近零开始（$A(0) = 1/\\beta \\to 0$），并随着 $\\xi$ 的增加而趋近于 1。这意味着靠近内边界的单元在径向方向上被拉伸，而越靠近外边界，单元则变得越各向同性（更接近正方形）。一个大的 $\\beta$ 对应一个具有显著径向拉伸的宽环形区域。\n\n最终要求的量是纵横比 $A(\\xi)$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1 + \\beta \\xi}{\\beta}}$$", "id": "3327571"}, {"introduction": "掌握了如何量化网格属性后，下一步是探究这些属性如何具体地影响我们求解的物理控制方程。本练习通过一个简化的斜交仿射变换，清晰地揭示了网格的非正交性如何在扩散方程中引入额外的、非物理的交叉导数项。通过编程实践，你将学习如何量化这些交叉项对数值格式稳定性和精度的影响，从而深刻理解网格质量与计算保真度之间的直接联系。[@problem_id:3327534]", "problem": "考虑一个标量场 $u(x,y,t)$ 的二维（$2$-D）扩散，该过程由源于第一性原理的标准扩散方程控制。该方程指出，$u$ 的变化率与其梯度的散度成正比：$\\partial u / \\partial t = \\nu \\nabla^{2} u$，其中 $\\nu$ 是扩散系数。在计算流体力学（CFD）中，在复杂几何上求解此方程通常需要从物理坐标 $(x,y)$ 变换到计算坐标 $(\\xi,\\eta)$，这会引入度量项，并且对于非正交网格，还会引入交叉导数项。从多元函数的链式法则以及梯度和拉普拉斯算子的定义出发，推导在 $(\\xi,\\eta)$ 坐标系下变换后的扩散算子的一般形式，该形式应包含协变和逆变度量张量以及雅可比行列式。然后，将其特化到一个模拟非正交性的斜仿射映射：$x(\\xi,\\eta) = \\xi + \\alpha \\eta$ 和 $y(\\xi,\\eta) = \\eta$，其中 $\\alpha$ 是一个无量纲的倾斜参数。基于此特化，确定由非正交性引入的交叉导数项及其系数。\n\n接下来，设计一个简单的数值扩散测试，使用间距为 $h$（单位：米）的均匀计算网格、中心差分近似以及时间步长为 $\\Delta t$（单位：秒）的显式前向欧拉方法的单个时间步。假设计算网格上存在一个傅里叶模态，其波数为 $k_{\\xi}$ 和 $k_{\\eta}$（角度必须以弧度给出）。使用经过充分检验的中心差分格式的离散傅里叶分析，沿 $\\xi$、$\\eta$ 方向的离散二阶导数算子以及混合导数 $\\xi\\eta$ 算子各自具有已知的傅里叶模态特征值，这些特征值依赖于 $k_{\\xi}$、$k_{\\eta}$ 和 $h$。利用这些特征值，计算在正交网格（基准情况，$\\alpha = 0$）和倾斜网格（非正交情况，$\\alpha \\neq 0$）上，单个前向欧拉步长的离散放大因子。将相对放大误差比 $R$ 定义为由非正交性引起的数值阻尼变化量，并用基准阻尼进行归一化：\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1},\n$$\n其中 $G_{0}$ 是正交网格的放大因子，$G_{\\alpha}$ 是非正交网格的放大因子。\n\n你的程序必须实现此分析，并为以下测试套件生成 $R$ 的数值。每个参数集是一个元组 $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t)$，其中 $h$ 的单位是米，$\\nu$ 的单位是 $\\mathrm{m}^{2}/\\mathrm{s}$，角度 $k_{\\xi}$ 和 $k_{\\eta}$ 的单位是弧度：\n- 测试 1（基准正交情况）：$(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.0,\\pi/3,\\pi/3,1.0,0.1,0.05)$。\n- 测试 2（轻度倾斜，相等模态）：$(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.2,\\pi/3,\\pi/3,1.0,0.1,0.05)$。\n- 测试 3（中度倾斜，不等模态）：$(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.5,\\pi/6,\\pi/3,1.0,0.1,0.05)$。\n- 测试 4（强倾斜，高波数）：$(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.9,\\pi/2,\\pi/2,1.0,0.05,0.02)$。\n- 测试 5（单方向恒定下的倾斜，边界情况）：$(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.7,\\pi/3,0.0,1.0,0.1,0.05)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中每个 $r_{i}$ 是对应测试用例计算出的 $R$ 的浮点数值。角度必须按弧度处理，所有中间量必须根据指定的物理单位进行一致计算。根据其构造，输出的浮点数是无量纲的。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于连续介质力学、张量微积分和数值分析的原理。其设定是自洽、一致且适定的，为推导唯一解提供了所有必要信息。\n\n求解过程分三个阶段进行：\n$1$. 推导广义的变换后扩散算子。\n$2$. 针对给定的斜仿射坐标变换，对算子进行特化。\n$3$. 对离散化方程进行数值分析，以推导相对放大误差比 $R$。\n\n**$1$. 扩散算子的变换**\n\n起点是物理笛卡尔坐标 $(x,y)$ 中的二维扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u = \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n我们考虑变换到一个通用的计算坐标系 $(\\xi^1, \\xi^2) \\equiv (\\xi, \\eta)$。该关系由 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$ 给出。偏导数的链式法则为：\n$$\n\\frac{\\partial}{\\partial \\xi^i} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial}{\\partial x^k}\n$$\n其中隐含了对重复索引 $k \\in \\{1,2\\}$ 的求和，并且 $(x^1, x^2) \\equiv (x,y)$。这关联了两个坐标系中的梯度算子。\n\n张量微积分的一个标准结果表明，拉普拉斯算子 $\\nabla^2$ 的变换形式如下：\n$$\n\\nabla^2 u = \\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} \\left( J g^{ij} \\frac{\\partial u}{\\partial \\xi^j} \\right)\n$$\n其中隐含了对 $i,j \\in \\{1,2\\}$ 的求和。这里，$J$ 是变换的雅可比行列式，$g^{ij}$ 是逆变度量张量的分量。\n\n雅可比矩阵 $\\mathbf{J}$ 及其行列式 $J$ 为：\n$$\n\\mathbf{J} = \\begin{pmatrix} x_\\xi  x_\\eta \\\\ y_\\xi  y_\\eta \\end{pmatrix}, \\quad J = \\det(\\mathbf{J}) = x_\\xi y_\\eta - x_\\eta y_\\xi\n$$\n其中下标表示偏微分（例如，$x_\\xi = \\partial x/\\partial \\xi$）。\n\n协变度量张量 $\\mathbf{G} = [g_{ij}]$ 定义为 $\\mathbf{G} = \\mathbf{J}^T \\mathbf{J}$：\n$$\ng_{ij} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial x^k}{\\partial \\xi^j} \\implies \\mathbf{G} = \\begin{pmatrix} x_\\xi^2+y_\\xi^2  x_\\xi x_\\eta + y_\\xi y_\\eta \\\\ x_\\xi x_\\eta + y_\\xi y_\\eta  x_\\eta^2+y_\\eta^2 \\end{pmatrix}\n$$\n逆变度量张量 $\\mathbf{G}^{-1} = [g^{ij}]$ 是 $\\mathbf{G}$ 的逆矩阵。可以证明 $\\det(\\mathbf{G}) = J^2$，从而得到：\n$$\n[g^{ij}] = \\frac{1}{J^2} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} x_\\eta^2+y_\\eta^2  -(x_\\xi x_\\eta + y_\\xi y_\\eta) \\\\ -(x_\\xi x_\\eta + y_\\xi y_\\eta)  x_\\xi^2+y_\\xi^2 \\end{pmatrix}\n$$\n\n**$2$. 对斜仿射映射的特化**\n\n问题指定了斜仿射映射：\n$$\nx(\\xi, \\eta) = \\xi + \\alpha \\eta, \\quad y(\\xi, \\eta) = \\eta\n$$\n我们计算其偏导数：\n$$\nx_\\xi = 1, \\quad x_\\eta = \\alpha, \\quad y_\\xi = 0, \\quad y_\\eta = 1\n$$\n雅可比行列式为：\n$$\nJ = x_\\xi y_\\eta - x_\\eta y_\\xi = (1)(1) - (\\alpha)(0) = 1\n$$\n由于雅可比行列式及其导出的所有度量系数都将是常数，变换后的拉普拉斯算子得以简化。一般形式 $\\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} (J g^{ij} \\frac{\\partial u}{\\partial \\xi^j})$ 变为 $g^{ij} \\frac{\\partial^2 u}{\\partial \\xi^i \\partial \\xi^j}$，因为 $J$ 和 $g^{ij}$ 都是常数。\n\n逆变度量张量 $[g^{ij}]$ 的分量为：\n$$\ng^{11} = \\frac{1}{J^2}(x_\\eta^2 + y_\\eta^2) = \\frac{1}{1^2}(\\alpha^2 + 1^2) = 1 + \\alpha^2\n$$\n$$\ng^{22} = \\frac{1}{J^2}(x_\\xi^2 + y_\\xi^2) = \\frac{1}{1^2}(1^2 + 0^2) = 1\n$$\n$$\ng^{12} = g^{21} = -\\frac{1}{J^2}(x_\\xi x_\\eta + y_\\xi y_\\eta) = -\\frac{1}{1^2}((1)(\\alpha) + (0)(1)) = -\\alpha\n$$\n将这些分量代入简化的拉普拉斯表达式中：\n$$\n\\nabla^2 u = g^{11} \\frac{\\partial^2 u}{\\partial \\xi^2} + g^{22} \\frac{\\partial^2 u}{\\partial \\eta^2} + 2g^{12} \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n$$\n\\nabla^2 u = (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} + \\frac{\\partial^2 u}{\\partial \\eta^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n由 $\\alpha \\neq 0$ 表示的非正交性引入了交叉导数项 $-2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}$，其系数为 $-2\\alpha$。\n\n**$3$. 数值放大因子分析**\n\n变换后的扩散方程为：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\left( (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta} + \\frac{\\partial^2 u}{\\partial \\eta^2} \\right)\n$$\n我们使用时间上的前向欧拉法和空间上的二阶中心差分法，在间距为 $\\Delta\\xi = \\Delta\\eta = h$ 的均匀网格上对此方程进行离散化。将一个傅里叶模态 $u^n_{i,j} = \\hat{u}^n e^{I(k_\\xi i h + k_\\eta j h)}$ 代入离散化方程，以求解放大因子 $G = \\hat{u}^{n+1}/\\hat{u}^n$。\n\n离散空间算子具有以下傅里叶特征值（符号）：\n- $\\delta^2_\\xi u \\to \\lambda_{\\xi\\xi} \\hat{u}$，其中 $\\lambda_{\\xi\\xi} = \\frac{-4}{h^2}\\sin^2(k_\\xi h/2)$\n- $\\delta^2_\\eta u \\to \\lambda_{\\eta\\eta} \\hat{u}$，其中 $\\lambda_{\\eta\\eta} = \\frac{-4}{h^2}\\sin^2(k_\\eta h/2)$\n- $\\delta_{\\xi\\eta} u \\to \\lambda_{\\xi\\eta} \\hat{u}$，其中 $\\lambda_{\\xi\\eta} = -\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)$\n\n应用前向欧拉格式 $u^{n+1} = u^n + \\Delta t (\\text{RHS})^n$ 并代入傅里叶模态和特征值，我们得到：\n$$\n\\hat{u}^{n+1} = \\hat{u}^n + \\nu \\Delta t \\left[ (1+\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right] \\hat{u}^n\n$$\n对于给定的倾斜度 $\\alpha$，其放大因子（表示为 $G_\\alpha$）为：\n$$\nG_\\alpha = 1 + \\nu \\Delta t \\left[ (1+\\alpha^2)\\lambda_{\\xi\\xi} - 2\\alpha\\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right]\n$$\n对于正交情况（$\\alpha=0$），放大因子 $G_0$ 为：\n$$\nG_0 = 1 + \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\n相对放大误差比 $R$ 定义为：\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1}\n$$\n分子是：\n$$\nG_\\alpha - G_0 = \\nu \\Delta t \\left[ (\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} \\right]\n$$\n分母是：\n$$\nG_0 - 1 = \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\n项 $\\nu \\Delta t$ 被消去，这表明 $R$ 衡量的是空间离散化的一种结构特性：\n$$\nR = \\frac{\\alpha^2 \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta}}{\\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta}}\n$$\n代入特征值的表达式：\n$$\nR = \\frac{\\alpha^2 \\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) - 2\\alpha \\left(-\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)\\right)}{\\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) + \\frac{-4}{h^2}\\sin^2(\\frac{k_\\eta h}{2})}\n$$\n通过消去公因子 $-1/h^2$ 并将分子和分母同除以 $4$ 来进行简化：\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 2\\alpha \\sin(k_\\xi h)\\sin(k_\\eta h)}{4\\sin^2(k_\\xi h/2) + 4\\sin^2(k_\\eta h/2)}\n$$\n使用恒等式 $\\sin(x) = 2\\sin(x/2)\\cos(x/2)$，我们可以写出：\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 8\\alpha \\sin(k_\\xi h/2)\\cos(k_\\xi h/2)\\sin(k_\\eta h/2)\\cos(k_\\eta h/2)}{4\\left(\\sin^2(k_\\xi h/2) + \\sin^2(k_\\eta h/2)\\right)}\n$$\n令 $\\theta_\\xi = k_\\xi h/2$ 和 $\\theta_\\eta = k_\\eta h/2$，用于实现的最终表达式为：\n$$\nR = \\frac{\\alpha^2 \\sin^2(\\theta_\\xi) - 2\\alpha \\sin(\\theta_\\xi)\\cos(\\theta_\\xi)\\sin(\\theta_\\eta)\\cos(\\theta_\\eta)}{\\sin^2(\\theta_\\xi) + \\sin^2(\\theta_\\eta)}\n$$\n此公式将用于所提供的测试用例。当分母为零时（即 $k_\\xi h$ 和 $k_\\eta h$ 均为 $2\\pi$ 的倍数），分子也为零，从而产生 $0/0$ 的不定形式。在这种数值阻尼为零的情况下，比率 $R$ 取为 $0$，因为没有可测量的阻尼误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_r(alpha, k_xi, k_eta, h):\n    \"\"\"\n    Computes the relative amplification error ratio R.\n\n    The formula for R is derived from the Fourier analysis of the\n    central-differenced diffusion equation on a skewed affine grid.\n    The ratio R is independent of the diffusion coefficient nu and\n    the time step dt.\n\n    Args:\n        alpha (float): Dimensionless skew parameter.\n        k_xi (float): Wavenumber in the xi-direction (in radians for angle-like quantity).\n        k_eta (float): Wavenumber in the eta-direction (in radians for angle-like quantity).\n        h (float): Uniform grid spacing.\n\n    Returns:\n        float: The calculated value of the relative amplification error ratio R.\n    \"\"\"\n    theta_xi = k_xi * h / 2.0\n    theta_eta = k_eta * h / 2.0\n\n    sin_theta_xi = np.sin(theta_xi)\n    sin_theta_eta = np.sin(theta_eta)\n\n    denominator = sin_theta_xi**2 + sin_theta_eta**2\n\n    # If the denominator is close to zero, it means the numerical damping for the\n    # orthogonal grid is zero (G_0 = 1). This occurs for wavenumbers that are\n    # not resolved by the grid (e.g., k_xi*h=0, k_eta*h=0). In this 0/0 case,\n    # the relative error is conceptually zero.\n    if np.isclose(denominator, 0.0):\n        return 0.0\n\n    cos_theta_xi = np.cos(theta_xi)\n    cos_theta_eta = np.cos(theta_eta)\n    \n    # Numerator corresponds to the change in damping due to skewness.\n    # It contains terms proportional to alpha and alpha^2.\n    numerator = (alpha**2 * sin_theta_xi**2 -\n                 2 * alpha * sin_theta_xi * cos_theta_xi * sin_theta_eta * cos_theta_eta)\n    \n    # Using the identity sin(2x) = 2sin(x)cos(x), an alternative form for the\n    # second term in the numerator is -alpha * sin(k_xi*h) * sin(k_eta*h) / 2,\n    # which is used in some derivations. The current form is direct.\n    \n    r = numerator / denominator\n    return r\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (alpha, k_xi, k_eta, h, nu, dt).\n    # nu and dt are not used in the final formula for R but are part of the problem spec.\n    test_cases = [\n        # Test 1 (baseline orthogonal case)\n        (0.0, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 2 (mild skew, equal modes)\n        (0.2, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 3 (moderate skew, unequal modes)\n        (0.5, np.pi/6, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 4 (strong skew, high wavenumbers)\n        (0.9, np.pi/2, np.pi/2, 1.0, 0.05, 0.02),\n        # Test 5 (skew with one direction constant, edge case)\n        (0.7, np.pi/3, 0.0, 1.0, 0.1, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, k_xi, k_eta, h, nu, dt = case\n        result = compute_r(alpha, k_xi, k_eta, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3327534"}, {"introduction": "在真实的计算流体动力学（CFD）应用中，网格质量往往是多种因素共同作用的结果，例如扭曲、拉伸和不光滑等问题可能同时存在。这项练习要求我们将之前学到的分析方法融会贯通，从整体上评估不同质量的网格对平流问题的数值色散误差的影响。这不仅是对理论知识的综合运用，更是培养CFD工程师在实践中做出明智判断的关键能力。[@problem_id:3327566]", "problem": "考虑一个被动标量 $\\,\\phi(x,y,t)\\,$ 的二维线性标量平流方程，其形式为\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y} = 0,\n$$\n速度分量是均匀的，$\\,u = U  0\\,$ 且 $\\,v = 0\\,$. 物理域是一个长度为 $\\,L_x\\,$、高度为 $\\,L_y\\,$ 的光滑通道，其中包含一个流线型凸起。标量的初始条件是与流向对齐的单一傅里叶模态，\n$$\n\\phi(x,y,0) = \\sin\\!\\left(\\frac{2\\pi x}{L_x}\\right),\n$$\n因此物理波数为 $\\,k_x = 2\\pi/L_x\\,$ 且 $\\,k_y = 0\\,$. 你在一个具有 $\\,N_\\xi \\times N_\\eta\\,$ 个点的均匀计算网格上，使用曲线坐标变换 $\\,(\\xi,\\eta) \\mapsto (x(\\xi,\\eta), y(\\xi,\\eta))\\,$ 来离散化空间，并使用计算坐标下的二阶中心差分来离散化空间导数算子。时间积分是二阶精度的，并且在所有情况下都使用相同的 Courant–Friedrichs–Lewy (CFL) 数。该曲线坐标系下的格式是保守的，并且精确满足几何守恒律 (GCL)。\n\n考虑两个尺寸相同（$\\,N_\\xi \\times N_\\eta\\,$）的网格 $\\,\\mathcal{G}_1\\,$ 和 $\\,\\mathcal{G}_2\\,$。在这两种情况下，计算步长 $\\,\\Delta_\\xi\\,$ 和 $\\,\\Delta_\\eta\\,$ 都是均匀的，但物理度量不同：\n\n- 网格 $\\,\\mathcal{G}_1\\,$ 是近正交且光滑的：相对于 $\\,x\\,$ 方向的最大网格线偏斜角以 $\\,\\theta_{\\max}^{(1)} \\le 10^{\\circ}\\,$ 为界；最大单元纵横比（定义为物理流向边长与物理横流向边长之比）满足 $\\,\\mathrm{AR}_{\\max}^{(1)} \\le 3\\,$；逆变度量分量及其一阶导数是光滑的，每个单元的相对变化以 $\\,\\epsilon_1 \\le 0.05\\,$ 为界，量化为\n$$\n\\max\\limits_{i,j}\\left(\\left|\\frac{x_\\xi(i+1,j)-x_\\xi(i-1,j)}{x_\\xi(i,j)}\\right|,\\ \\left|\\frac{x_\\eta(i,j+1)-x_\\eta(i,j-1)}{x_\\eta(i,j)}\\right|\\right) \\le \\epsilon_1.\n$$\n\n- 网格 $\\,\\mathcal{G}_2\\,$ 的偏斜和拉伸更强：$\\,\\theta_{\\max}^{(2)} \\le 35^{\\circ}\\,$；$\\,\\mathrm{AR}_{\\max}^{(2)} \\le 12\\,$，单元主要在流向被拉长；相同的度量分量表现出振荡聚集，每个单元的相对变化以 $\\,\\epsilon_2 \\le 0.30\\,$ 为界，即，\n$$\n\\max\\limits_{i,j}\\left(\\left|\\frac{x_\\xi(i+1,j)-x_\\xi(i-1,j)}{x_\\xi(i,j)}\\right|,\\ \\left|\\frac{x_\\eta(i,j+1)-x_\\eta(i,j-1)}{x_\\eta(i,j)}\\right|\\right) \\le \\epsilon_2,\n$$\n在凸起附近，振荡波长约为 $\\,4\\,$ 个计算单元。\n\n假设 $\\,\\mathcal{G}_1\\,$ 和 $\\,\\mathcal{G}_2\\,$ 都满足适定离散化通常所需的光滑性要求，并且在一个流向波长的短时传播过程中，边界反射可以忽略。基于曲线坐标变换和线性平流的有限差分色散的第一性原理，预测对于平流的单模态初始条件，哪个网格产生的空间色散误差（相速误差）更低。\n\n选择最佳答案：\n\nA. 网格 $\\,\\mathcal{G}_1\\,$ 产生的色散误差更低，因为近正交性、有界的纵横比和光滑的度量最小化了各向异性相误差，并抑制了由度量引起的可变系数效应。\n\nB. 网格 $\\,\\mathcal{G}_2\\,$ 产生的色散误差更低，因为在流向拉长的单元减小了平流方向的截断误差，并且偏斜改善了与流线的对齐。\n\nC. 两个网格产生的色散误差相当，因为它们有相同数量的点、相同的计算步长 $\\,\\Delta_\\xi\\,$ 和 $\\,\\Delta_\\eta\\,$，并且都满足几何守恒律。\n\nD. 如果没有时间步长的细节，比较结果是不确定的，因为在这种设置下，色散误差主要由时间离散化主导，而非空间网格质量。", "solution": "用户希望我分析一个计算流体力学中的问题，该问题涉及两种不同曲线网格上的数值色散误差。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：被动标量 $\\phi(x,y,t)$ 的二维线性标量平流方程为\n    $$ \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y} = 0 $$\n-   **速度场**：均匀速度分量为 $u = U  0$ 和 $v = 0$。方程简化为 $\\frac{\\partial \\phi}{\\partial t} + U \\frac{\\partial \\phi}{\\partial x} = 0$。\n-   **物理域**：一个长度为 $L_x$、高度为 $L_y$ 的光滑通道，其中包含一个流线型凸起。\n-   **初始条件**：$\\phi(x,y,0) = \\sin\\left(\\frac{2\\pi x}{L_x}\\right)$。这是一个单一傅里叶模态，其物理波数为 $k_x = 2\\pi/L_x$ 且 $k_y = 0$。\n-   **数值格式**：\n    -   使用了曲线坐标变换 $(\\xi,\\eta) \\mapsto (x(\\xi,\\eta), y(\\xi,\\eta))$。\n    -   计算网格是均匀的，有 $N_\\xi \\times N_\\eta$ 个点，均匀步长为 $\\Delta_\\xi$ 和 $\\Delta_\\eta$。\n    -   空间导数在计算坐标 $(\\xi, \\eta)$ 中使用二阶中心差分离散。\n    -   时间积分是二阶精度的。\n    -   所有模拟的 Courant–Friedrichs–Lewy (CFL) 数都相同。\n    -   该格式是保守的，并且精确满足几何守恒律 (GCL)。\n-   **网格 $\\mathcal{G}_1$**：近正交且光滑。\n    -   最大偏斜角：相对于 $x$ 方向为 $\\theta_{\\max}^{(1)} \\le 10^{\\circ}$。\n    -   最大单元纵横比：$\\mathrm{AR}_{\\max}^{(1)} \\le 3$。\n    -   度量光滑性：度量导数的每个单元相对变化以 $\\epsilon_1 \\le 0.05$ 为界。\n-   **网格 $\\mathcal{G}_2$**：强烈偏斜和拉伸。\n    -   最大偏斜角：$\\theta_{\\max}^{(2)} \\le 35^{\\circ}$。\n    -   最大单元纵横比：$\\mathrm{AR}_{\\max}^{(2)} \\le 12$，伴随流向拉伸。\n    -   度量光滑性：振荡性，度量导数的每个单元相对变化以 $\\epsilon_2 \\le 0.30$ 为界，振荡波长约为 $\\sim 4$ 个计算单元。\n-   **假设**：\n    -   两个网格对于适定的离散化都足够光滑。\n    -   边界反射可以忽略。\n-   **问题**：预测哪个网格产生的空间色散误差（相速误差）更低。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述在科学上基于偏微分方程数值方法的理论，特别是在计算流体力学领域。所使用的概念——线性平流、曲线坐标、有限差分、色散误差、网格质量度量（偏斜度、纵横比、度量光滑性）和几何守恒律——在该领域都是标准且明确定义的。\n\n这个问题是适定的。它提供了一个清晰的物理和数值设置，并要求基于明确说明的网格质量差异，对特定误差类型（空间色散）进行定性比较。所提供的信息是充分且自洽的。使用单一傅里叶模态初始条件是分析数值色散的标准技术。两个网格的约束和属性都得到了定量定义。\n\n这个问题是客观的，没有主观论断。通过应用有限差分格式在曲线网格上的截断误差分析的第一性原理，可以回答这个问题。这个问题并非微不足道；它要求对网格几何属性如何转化为变换后控制方程中的数值误差项有细致的理解。\n\n满足有效问题的所有标准。\n\n### 步骤 3：结论与行动\n问题是有效的。我现在将开始推导解决方案。\n\n### 推导\n\n物理坐标 $(x,y)$ 中的控制方程是：\n$$ \\frac{\\partial \\phi}{\\partial t} + U \\frac{\\partial \\phi}{\\partial x} = 0 $$\n我们将此方程变换到计算坐标 $(\\xi,\\eta)$。使用链式法则求导，方程变换为拟线性形式：\n$$ \\frac{\\partial \\phi}{\\partial t} + (U\\xi_x) \\frac{\\partial \\phi}{\\partial \\xi} + (U\\eta_x) \\frac{\\partial \\phi}{\\partial \\eta} = 0 $$\n项 $\\xi_x = \\frac{\\partial \\xi}{\\partial x}$ 和 $\\eta_x = \\frac{\\partial \\eta}{\\partial x}$ 是变换的度量项。它们可以用物理坐标对计算坐标的导数来表示：$\\xi_x = y_\\eta/J$ 和 $\\eta_x = -y_\\xi/J$，其中 $J = x_\\xi y_\\eta - x_\\eta y_\\xi$ 是变换的雅可比行列式。变换后的方程是：\n$$ \\frac{\\partial \\phi}{\\partial t} + \\frac{U y_\\eta}{J} \\frac{\\partial \\phi}{\\partial \\xi} - \\frac{U y_\\xi}{J} \\frac{\\partial \\phi}{\\partial \\eta} = 0 $$\n这是一个在 $(\\xi, \\eta)$ 空间中的平流方程，其可变平流速度为 $C_\\xi(\\xi, \\eta) = U y_\\eta / J$ 和 $C_\\eta(\\xi, \\eta) = -U y_\\xi / J$。\n\n问题陈述，在均匀计算网格上，空间导数使用二阶中心差分格式。对于中心差分算子 $\\frac{\\partial}{\\partial \\xi} \\approx \\delta_\\xi$ 作用于波 $\\phi = e^{i(k_\\xi \\xi)}$ 的修正波数分析表明，有效波数 $k'_\\xi$ 为：\n$$ k'_\\xi = \\frac{\\sin(k_\\xi \\Delta\\xi)}{\\Delta\\xi} $$\n对于小的 $k_\\xi \\Delta\\xi$，这大约是 $k'_\\xi \\approx k_\\xi - \\frac{(k_\\xi \\Delta\\xi)^2}{6}k_\\xi$。因此，数值相速与真实相速不同，这是色散误差的来源。主导误差项与解的三阶导数 $\\frac{\\partial^3 \\phi}{\\partial \\xi^3}$ 成正比。\n\n然而，这种分析适用于常系数情况。在我们的案例中，系数 $C_\\xi$ 和 $C_\\eta$ 是网格度量的函数，并随位置变化。数值格式的截断误差不仅包括标准的色散项，还包括涉及度量导数的项。对于保守格式，离散化方程近似于 $\\frac{\\partial (J\\phi)}{\\partial t} + \\frac{\\partial (U_\\xi \\phi)}{\\partial \\xi} + \\frac{\\partial (U_\\eta \\phi)}{\\partial \\eta} = 0$，其中 $U_\\xi$ 和 $U_\\eta$ 是逆变速度。空间部分的主导截断误差项形式为：\n$$ \\text{LTE}_{\\text{space}} \\propto \\Delta\\xi^2 \\frac{\\partial^3 (U_\\xi \\phi)}{\\partial \\xi^3} + \\Delta\\eta^2 \\frac{\\partial^3 (U_\\eta \\phi)}{\\partial \\eta^3} $$\n展开这些项，例如 $\\frac{\\partial^3 (U_\\xi \\phi)}{\\partial \\xi^3}$，会产生像 $U_\\xi \\frac{\\partial^3 \\phi}{\\partial \\xi^3}$（标准色散项）这样的项，但也会产生涉及度量导数的新项，例如 $\\frac{\\partial U_\\xi}{\\partial \\xi} \\frac{\\partial^2 \\phi}{\\partial \\xi^2}$ 和 $\\frac{\\partial^2 U_\\xi}{\\partial \\xi^2} \\frac{\\partial \\phi}{\\partial \\xi}$。这些新项，通常称为可变系数误差或度量诱导误差，会显著增加总数值误差，包括色散。\n\n让我们基于这种理解来比较这两个网格：\n\n**网格 $\\mathcal{G}_1$（高质量网格）：**\n1.  **近正交性（$\\theta_{\\max}^{(1)} \\le 10^{\\circ}$）：**对于与坐标轴对齐的网格，$y_\\xi = 0$。小的偏斜度意味着 $y_\\xi$ 很小。这使得人为的横流平流速度 $C_\\eta = -U y_\\xi/J$ 很小。该问题在数值上更“接近”原始的一维平流问题，从而减少了各向异性误差的一个主要来源。\n2.  **光滑度量（$\\epsilon_1 \\le 0.05$）：**$\\epsilon_1$ 的小值意味着映射的一阶导数（$x_\\xi, y_\\xi$ 等）变化平滑且缓慢。这意味着映射函数（$x, y$）的二阶及更高阶导数很小。因此，度量项的导数（例如 $\\frac{\\partial U_\\xi}{\\partial \\xi}$）很小。这抑制了截断误差展开中额外的度量诱导误差项的量级。\n3.  **有界纵横比（$\\mathrm{AR}_{\\max}^{(1)} \\le 3$）：**适度的纵横比有助于在不同的计算方向上保持相似的分辨率，这通常有利于控制各向异性误差，特别是当流动不完全与网格方向对齐时。\n\n**网格 $\\mathcal{G}_2$（低质量网格）：**\n1.  **强偏斜性（$\\theta_{\\max}^{(2)} \\le 35^{\\circ}$）：**大的偏斜角意味着在某些区域 $y_\\xi$ 的值很大。这导致了很大的人为横流平流速度 $C_\\eta$。数值格式必须精确地抵消在 $\\xi$ 和 $\\eta$ 计算方向上的平流效应，以再现纯粹的 $x$ 方向物理平流。中心差分格式在这种情况下表现不佳，会导致显著的相位（色散）和振幅误差。\n2.  **振荡度量（$\\epsilon_2 \\le 0.30$）：**这是最具破坏性的属性。度量导数的大且振荡的特性（由 $\\epsilon_2 = 0.30$ 指示）意味着像 $\\frac{\\partial U_\\xi}{\\partial \\xi}$ 和 $\\frac{\\partial^2 U_\\xi}{\\partial \\xi^2}$ 这样的项很大且变化迅速。这些项在修正微分方程中引入了大的伪源项，用非物理的振荡污染解，并严重降低相位精度。度量振荡的波长约为 $\\sim 4$ 个网格单元这一事实尤其有害，因为它可能与数值格式发生共振相互作用，产生高波数误差。\n3.  **高纵横比（$\\mathrm{AR}_{\\max}^{(2)} \\le 12$）：**虽然沿流向的单元拉伸有时可能很有效，但高纵横比与高偏斜度相结合是众所周知的数值误差的强力来源。\n\n**结论：**\n网格 $\\mathcal{G}_1$ 的设计旨在最小化曲线网格特有的数值误差来源。其近正交性、适度的纵横比，以及最重要的是，光滑的度量，确保了截断误差很小，并且主要由底层中心差分格式固有的、表现良好的色散所主导。网格 $\\mathcal{G}_2$ 表现出已知会产生大数值误差的特征（高偏斜度、高纵横比和不光滑、振荡的度量）。特别是，振荡的度量会引入大的度量诱导色散和耗散，导致比在网格 $\\mathcal{G}_1$ 上大得多的整体相位误差。因此，网格 $\\mathcal{G}_1$ 将产生显著更低的空间色散误差。\n\n### 逐项分析\n\n**A. 网格 $\\,\\mathcal{G}_1\\,$ 产生的色散误差更低，因为近正交性、有界的纵横比和光滑的度量最小化了各向异性相误差，并抑制了由度量引起的可变系数效应。**\n此陈述正确地指出了关键因素。近正交性和有界的纵横比减少了各向异性误差。光滑的度量对于抑制“可变系数效应”至关重要，这些效应是由度量导数产生的附加误差项。此选项提供了完整而准确的解释。此陈述是 **正确的**。\n\n**B. 网格 $\\,\\mathcal{G}_2\\,$ 产生的色散误差更低，因为在流向拉长的单元减小了平流方向的截断误差，并且偏斜改善了与流线的对齐。**\n此陈述不正确。虽然流向单元拉伸可以作为高效网格设计策略的一部分，但它本身并不能减少每个点的截断误差。更重要的是，偏斜度对精度有害；它代表了与此问题中笛卡尔坐标对齐的流线的*错位*，并在计算域中引入了大量人为的横向流动平流。此陈述是 **不正确的**。\n\n**C. 两个网格产生的色散误差相当，因为它们有相同数量的点、相同的计算步长 $\\,\\Delta_\\xi\\,$ 和 $\\,\\Delta_\\eta\\,$，并且都满足几何守恒律。**\n这是一个有缺陷的论点。如果网格质量差异巨大，即使点数相同也不能保证相当的精度。曲线网格上的截断误差关键取决于度量项及其导数，而不仅仅是 $\\Delta\\xi$ 和 $\\Delta\\eta$。满足 GCL 是保证一致性和避免均匀流产生伪源项的必要条件，但它不能消除由差的网格质量放大的高阶截断误差（如色散）。此陈述是 **不正确的**。\n\n**D. 如果没有时间步长的细节，比较结果是不确定的，因为在这种设置下，色散误差主要由时间离散化主导，而非空间网格质量。**\n此陈述不正确。问题明确要求比较*空间*色散误差。空间网格质量对数值误差的影响可能非常大，而且常常是主导性的，尤其是在比较高质量网格和低质量网格时。鉴于网格 $\\mathcal{G}_2$ 的极端缺陷，几乎可以肯定空间误差源将占主导地位。问题并非不确定；数值分析的原理允许做出明确的预测。此陈述是 **不正确的**。", "answer": "$$\\boxed{A}$$", "id": "3327566"}]}