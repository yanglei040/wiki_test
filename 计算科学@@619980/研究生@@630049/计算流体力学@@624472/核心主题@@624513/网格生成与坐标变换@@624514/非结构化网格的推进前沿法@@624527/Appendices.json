{"hands_on_practices": [{"introduction": "要掌握前沿推进法，我们必须首先理解其核心的迭代循环。本练习将引导您在一个简化的二维场景中，逐步完成该方法的基本步骤：选择一个活跃的前沿边，生成一个新的三角形单元，然后更新前沿数据结构。通过亲手执行这些操作，您将对该算法如何逐步填充区域建立起直观的认识 [@problem_id:3289637]。", "problem": "考虑一个用于通过前沿推进法 (Advancing-Front Method, AFM) 进行非结构化三角剖分的凸方形区域，该区域由按逆时针顺序排列的顶点 $V_1 = (0, 0)$、$V_2 = (l, 0)$、$V_3 = (l, l)$ 和 $V_4 = (0, l)$ 定义，其中 $l > 0$ 是以米为单位的统一目标边长。初始前沿是由有向边 $(V_1 \\rightarrow V_2)$、$(V_2 \\rightarrow V_3)$、$(V_3 \\rightarrow V_4)$ 和 $(V_4 \\rightarrow V_1)$ 按逆时针顺序组成的多边形边界。\n\n使用 AFM（前沿推进法）的等边放置规则：给定一个活动前沿边 $(A \\rightarrow B)$，构建一个候选顶点 $P$，使得三角形 $(A, B, P)$ 是以 $(A, B)$ 为底边的等边三角形，并选择位于区域内侧的顶点。对于一个逆时针定向的凸多边形，其内部位于每个有向边界边的左侧。设等边顶点是通过将边向量 $B - A$ 绕点 $A$ 旋转 $+60^{\\circ}$（左侧选择）形成的，即 $P = A + R_{+60^{\\circ}}(B - A)$，其中旋转矩阵为\n$$\nR_{+60^{\\circ}} \\;=\\; \\begin{pmatrix}\n\\cos(60^{\\circ})  &-\\sin(60^{\\circ}) \\\\\n\\sin(60^{\\circ})  &\\cos(60^{\\circ})\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n\\frac{1}{2}  &-\\frac{\\sqrt{3}}{2} \\\\\n\\frac{\\sqrt{3}}{2}  &\\frac{1}{2}\n\\end{pmatrix}.\n$$\n按以下步骤进行：\n- 首先选择活动边 $(V_1 \\rightarrow V_2)$ 并插入相应的等边顶点 $P_1$，生成三角形 $(V_1, V_2, P_1)$。通过移除 $(V_1 \\rightarrow V_2)$ 并添加与 $P_1$ 相邻的新边来更新前沿。\n- 接下来选择活动边 $(V_2 \\rightarrow V_3)$，插入等边顶点 $P_2$，生成三角形 $(V_2, V_3, P_2)$，并相应地更新前沿。\n- 然后选择活动边 $(V_3 \\rightarrow V_4)$，插入等边顶点 $P_3$，生成三角形 $(V_3, V_4, P_3)$，并相应地更新前沿。\n\n计算 $P_1$、$P_2$ 和 $P_3$ 的坐标，将每次插入后的前沿明确地列为一个有向边的有序集合，并确定前三个三角形的面积。作为最终答案，提供这前三个三角形的面积之和，以关于 $l$ 的封闭形式解析表达式表示。最终面积总和以平方米表示。无需四舍五入。", "solution": "将通过首先提取所有给定信息，然后评估其科学合理性、一致性和完整性来验证该问题。\n\n### 步骤 1：提取已知条件\n- 区域：一个凸方形，其顶点按逆时针顺序排列为 $V_1 = (0, 0)$、$V_2 = (l, 0)$、$V_3 = (l, l)$ 和 $V_4 = (0, l)$。\n- 参数：$l > 0$ 是以米为单位的统一目标边长。\n- 初始前沿：由有向边 $(V_1 \\rightarrow V_2)$、$(V_2 \\rightarrow V_3)$、$(V_3 \\rightarrow V_4)$ 和 $(V_4 \\rightarrow V_1)$ 按逆时针顺序组成的多边形边界。\n- 顶点放置规则：对于活动前沿边 $(A \\rightarrow B)$，候选顶点 $P$ 的构建方式是使三角形 $(A, B, P)$ 为等边三角形且位于区域内侧。\n- 顶点计算公式：$P = A + R_{+60^{\\circ}}(B - A)$，其中旋转矩阵为 $R_{+60^{\\circ}} = \\begin{pmatrix} \\frac{1}{2}  &-\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2}  &\\frac{1}{2} \\end{pmatrix}$。\n- 步骤：\n  1. 选择边 $(V_1 \\rightarrow V_2)$，生成顶点 $P_1$ 和三角形 $(V_1, V_2, P_1)$，并更新前沿。\n  2. 选择边 $(V_2 \\rightarrow V_3)$，生成顶点 $P_2$ 和三角形 $(V_2, V_3, P_2)$，并更新前沿。\n  3. 选择边 $(V_3 \\rightarrow V_4)$，生成顶点 $P_3$ 和三角形 $(V_3, V_4, P_3)$，并更新前沿。\n- 解答中要求输出：$P_1$、$P_2$、$P_3$ 的坐标；每次插入后的前沿；以及前三个三角形的面积。\n- 最终答案：这三个三角形的面积之和。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n- **科学依据：** 该问题基于前沿推进法 (AFM)，这是一种在计算几何和计算流体动力学中用于生成非结构化网格的成熟算法。所使用的数学运算（向量代数、旋转）是标准且正确的。\n- **适定性：** 该问题提供了一个明确定义的初始状态（一个方形区域和前沿）、一套用于生成新点和单元的确定性规则，以及一个特定的操作序列。该过程清晰明确，并导向唯一的解。\n- **客观性：** 语言精确，没有主观或基于观点的陈述。所有术语都经过了数学定义。\n- **完整性与一致性：** 提供了所有必要信息（顶点、目标长度、顶点规则、步骤）。设置中没有矛盾。顶点计算公式正确地对应于逆时针定向边界上面向内部的三角形的 $+60^{\\circ}$ 旋转。\n\n### 步骤 3：结论与行动\n该问题有效。这是一个计算几何领域中适定的、有科学依据的问题。将提供详细的解答。\n\n### 解题推导\n解题过程遵循前沿推进法的规定步骤。正方形的顶点给定为 $V_1 = (0, 0)$、$V_2 = (l, 0)$、$V_3 = (l, l)$ 和 $V_4 = (0, l)$。初始前沿 $\\mathcal{F}_0$ 是构成边界的有向边的有序集合：\n$$\n\\mathcal{F}_0 = ((V_1 \\rightarrow V_2), (V_2 \\rightarrow V_3), (V_3 \\rightarrow V_4), (V_4 \\rightarrow V_1))\n$$\n\n**步骤 1：处理边 $(V_1 \\rightarrow V_2)$**\n第一个活动边是 $(A \\rightarrow B) = (V_1 \\rightarrow V_2)$。\n- $A = V_1 = (0, 0)$。\n- $B = V_2 = (l, 0)$。\n- 边向量为 $B - A = (l, 0)$。\n- 使用给定公式计算顶点 $P_1$：$P_1 = A + R_{+60^{\\circ}}(B - A)$。\n$$\nP_1 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2}  &-\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2}  &\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} l \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{l}{2} \\\\ \\frac{l\\sqrt{3}}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{l}{2} \\\\ \\frac{l\\sqrt{3}}{2} \\end{pmatrix}\n$$\n因此，第一个顶点的坐标是 $P_1 = \\left(\\frac{l}{2}, \\frac{l\\sqrt{3}}{2}\\right)$。\n形成一个新的三角形 $T_1 = (V_1, V_2, P_1)$。这是一个边长为 $l$ 的等边三角形。其面积记为 $\\text{Area}(T_1)$，由公式 $\\frac{\\sqrt{3}}{4} \\times (\\text{边长})^2$ 给出。\n$$\n\\text{Area}(T_1) = \\frac{\\sqrt{3}}{4}l^2\n$$\n通过用两条新边 $(V_1 \\rightarrow P_1)$ 和 $(P_1 \\rightarrow V_2)$ 替换边 $(V_1 \\rightarrow V_2)$ 来更新前沿。更新后的前沿 $\\mathcal{F}_1$ 为：\n$$\n\\mathcal{F}_1 = ((V_1 \\rightarrow P_1), (P_1 \\rightarrow V_2), (V_2 \\rightarrow V_3), (V_3 \\rightarrow V_4), (V_4 \\rightarrow V_1))\n$$\n\n**步骤 2：处理边 $(V_2 \\rightarrow V_3)$**\n下一个活动边是 $(A \\rightarrow B) = (V_2 \\rightarrow V_3)$。\n- $A = V_2 = (l, 0)$。\n- $B = V_3 = (l, l)$。\n- 边向量为 $B - A = (0, l)$。\n- 计算顶点 $P_2$：$P_2 = A + R_{+60^{\\circ}}(B - A)$。\n$$\nP_2 = \\begin{pmatrix} l \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2}  &-\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2}  &\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ l \\end{pmatrix} = \\begin{pmatrix} l \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{l\\sqrt{3}}{2} \\\\ \\frac{l}{2} \\end{pmatrix} = \\begin{pmatrix} l - \\frac{l\\sqrt{3}}{2} \\\\ \\frac{l}{2} \\end{pmatrix}\n$$\n因此，第二个顶点的坐标是 $P_2 = \\left(l - \\frac{l\\sqrt{3}}{2}, \\frac{l}{2}\\right)$。\n形成一个新的三角形 $T_2 = (V_2, V_3, P_2)$。这是一个边长为 $|V_3 - V_2| = |(0, l)| = l$ 的等边三角形。其面积为：\n$$\n\\text{Area}(T_2) = \\frac{\\sqrt{3}}{4}l^2\n$$\n通过用边 $(V_2 \\rightarrow P_2)$ 和 $(P_2 \\rightarrow V_3)$ 替换 $\\mathcal{F}_1$ 中的边 $(V_2 \\rightarrow V_3)$ 来更新前沿。更新后的前沿 $\\mathcal{F}_2$ 为：\n$$\n\\mathcal{F}_2 = ((V_1 \\rightarrow P_1), (P_1 \\rightarrow V_2), (V_2 \\rightarrow P_2), (P_2 \\rightarrow V_3), (V_3 \\rightarrow V_4), (V_4 \\rightarrow V_1))\n$$\n\n**步骤 3：处理边 $(V_3 \\rightarrow V_4)$**\n下一个活动边是 $(A \\rightarrow B) = (V_3 \\rightarrow V_4)$。\n- $A = V_3 = (l, l)$。\n- $B = V_4 = (0, l)$。\n- 边向量为 $B - A = (-l, 0)$。\n- 计算顶点 $P_3$：$P_3 = A + R_{+60^{\\circ}}(B - A)$。\n$$\nP_3 = \\begin{pmatrix} l \\\\ l \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2}  &-\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2}  &\\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -l \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} l \\\\ l \\end{pmatrix} + \\begin{pmatrix} -\\frac{l}{2} \\\\ -\\frac{l\\sqrt{3}}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{l}{2} \\\\ l - \\frac{l\\sqrt{3}}{2} \\end{pmatrix}\n$$\n因此，第三个顶点的坐标是 $P_3 = \\left(\\frac{l}{2}, l - \\frac{l\\sqrt{3}}{2}\\right)$。\n形成一个新的三角形 $T_3 = (V_3, V_4, P_3)$。这是一个边长为 $|V_4 - V_3| = |(-l, 0)| = l$ 的等边三角形。其面积为：\n$$\n\\text{Area}(T_3) = \\frac{\\sqrt{3}}{4}l^2\n$$\n通过用边 $(V_3 \\rightarrow P_3)$ 和 $(P_3 \\rightarrow V_4)$ 替换 $\\mathcal{F}_2$ 中的边 $(V_3 \\rightarrow V_4)$ 来更新前沿。最终的前沿 $\\mathcal{F}_3$ 为：\n$$\n\\mathcal{F}_3 = ((V_1 \\rightarrow P_1), (P_1 \\rightarrow V_2), (V_2 \\rightarrow P_2), (P_2 \\rightarrow V_3), (V_3 \\rightarrow P_3), (P_3 \\rightarrow V_4), (V_4 \\rightarrow V_1))\n$$\n\n**最终计算：面积之和**\n问题要求计算生成的前三个三角形 $T_1$、$T_2$ 和 $T_3$ 的面积之和。\n总面积 $A_{total}$ 为：\n$$\nA_{total} = \\text{Area}(T_1) + \\text{Area}(T_2) + \\text{Area}(T_3)\n$$\n$$\nA_{total} = \\frac{\\sqrt{3}}{4}l^2 + \\frac{\\sqrt{3}}{4}l^2 + \\frac{\\sqrt{3}}{4}l^2 = 3 \\times \\left(\\frac{\\sqrt{3}}{4}l^2\\right)\n$$\n$$\nA_{total} = \\frac{3\\sqrt{3}}{4}l^2\n$$\n由于 $l$ 的单位是米，所以面积的单位是平方米。", "answer": "$$\\boxed{\\frac{3\\sqrt{3}}{4}l^{2}}$$", "id": "3289637"}, {"introduction": "生成单元仅仅是第一步；为了进行可靠的计算流体力学（CFD）模拟，这些单元的质量必须足够高。本练习将深入探讨三维四面体单元质量评估这一关键任务，介绍半径比（radius ratio）和二面角（dihedral angles）等核心衡量标准。您将学习如何计算这些度量值，以判断一个候选单元是否满足必要的接受标准 [@problem_id:3289592]。", "problem": "在计算流体动力学（CFD）的背景下，考虑一个采用前沿推进法（AF）的非结构四面体网格生成步骤，其中通过从一个活动前沿面上抬升一个顶点来生成一个候选四面体。设该候选四面体有顶点 $\\mathbf{a}$、$\\mathbf{b}$、$\\mathbf{c}$ 和 $\\mathbf{d}$，其笛卡尔坐标由下式给出\n$$\n\\mathbf{a} = (0,\\,0,\\,0),\\quad\n\\mathbf{b} = (1,\\,0,\\,0),\\quad\n\\mathbf{c} = (0,\\,1,\\,0),\\quad\n\\mathbf{d} = (0.2,\\,0.3,\\,1).\n$$\n网格的可接受性由前沿推进法中使用的两个标准几何质量准则决定：\n- 半径比质量界限 $q \\ge q_{\\min}$，其中 $q_{\\min} = 0.80$。\n- 最小二面角界限 $\\theta_{\\min} \\ge 0.75$ 弧度。\n\n从基本几何定义出发，计算该四面体的体积 $V$、总表面积 $S$、内切球半径 $r$、外接球半径 $R$，以及由归一化半径比 $q = \\dfrac{3 r}{R}$ 定义的质量度量 $q$。此外，计算所有二面角（以弧度表示）并确定最小二面角 $\\theta_{\\min}$，然后判断该候选四面体是否同时满足两个可接受性标准。\n\n仅使用以下基本公式：\n- 用于计算体积的标量三重积：$V = \\dfrac{\\left| \\left( (\\mathbf{b}-\\mathbf{a}) \\times (\\mathbf{c}-\\mathbf{a}) \\right) \\cdot (\\mathbf{d}-\\mathbf{a}) \\right|}{6}$。\n- 用于计算三角形面积的叉积公式：$A_{\\triangle} = \\dfrac{1}{2}\\left\\| \\mathbf{u} \\times \\mathbf{v}\\right\\|$。\n- 四面体的内切球半径-体积-表面积关系：$V = \\dfrac{1}{3} r S$。\n- 外心是与所有顶点等距的唯一点，通过求解形如 $\\left(\\mathbf{b}-\\mathbf{a}\\right)\\cdot \\mathbf{O} = \\dfrac{\\|\\mathbf{b}\\|^{2}-\\|\\mathbf{a}\\|^{2}}{2}$ 的线性方程组得到。\n- 两个法向量分别为 $\\mathbf{n}_{1}$ 和 $\\mathbf{n}_{2}$ 的面之间的二面角由 $\\theta = \\pi - \\arccos\\!\\left( \\dfrac{\\mathbf{n}_{1}\\cdot \\mathbf{n}_{2}}{\\|\\mathbf{n}_{1}\\|\\,\\|\\mathbf{n}_{2}\\|} \\right)$ 给出。\n\n将最终报告的数值 $q$ 四舍五入到四位有效数字。二面角以弧度表示。以无量纲形式报告 $q$。你的最终答案必须仅为 $q$ 的单一值。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观且完整的。所有必要的数据、定义和公式均已提供，不存在内部矛盾或违反数学、物理原理的情况。该问题是计算几何在计算流体动力学网格质量分析中应用的一个标准练习。因此，我们可以开始解答。\n\n四面体的顶点给定为 $\\mathbf{a} = (0,\\,0,\\,0)$、$\\mathbf{b} = (1,\\,0,\\,0)$、$\\mathbf{c} = (0,\\,1,\\,0)$ 和 $\\mathbf{d} = (0.2,\\,0.3,\\,1)$。由于顶点 $\\mathbf{a}$ 位于原点，从 $\\mathbf{a}$ 指向其他顶点的向量就是这些顶点的坐标向量本身：\n$$ \\mathbf{v}_{ab} = \\mathbf{b} - \\mathbf{a} = (1,\\,0,\\,0) $$\n$$ \\mathbf{v}_{ac} = \\mathbf{c} - \\mathbf{a} = (0,\\,1,\\,0) $$\n$$ \\mathbf{v}_{ad} = \\mathbf{d} - \\mathbf{a} = (0.2,\\,0.3,\\,1) $$\n\n首先，我们使用标量三重积公式计算四面体的体积 $V$：\n$$ V = \\frac{\\left| \\left( \\mathbf{v}_{ab} \\times \\mathbf{v}_{ac} \\right) \\cdot \\mathbf{v}_{ad} \\right|}{6} $$\n叉积为：\n$$ \\mathbf{v}_{ab} \\times \\mathbf{v}_{ac} = (1,\\,0,\\,0) \\times (0,\\,1,\\,0) = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{vmatrix} = (0,\\,0,\\,1) $$\n点积为：\n$$ (0,\\,0,\\,1) \\cdot (0.2,\\,0.3,\\,1) = 1 $$\n因此，体积为：\n$$ V = \\frac{1}{6} $$\n\n接下来，我们计算总表面积 $S$。这需要计算四个三角形面 $\\triangle abc$、$\\triangle abd$、$\\triangle acd$ 和 $\\triangle bcd$ 各自的面积。我们使用公式 $A_{\\triangle} = \\frac{1}{2}\\left\\| \\mathbf{u} \\times \\mathbf{v}\\right\\|$。\n面 $\\triangle abc$ 的面积：\n$$ A_{abc} = \\frac{1}{2}\\|\\mathbf{v}_{ab} \\times \\mathbf{v}_{ac}\\| = \\frac{1}{2}\\|(0,0,1)\\| = \\frac{1}{2} $$\n面 $\\triangle abd$ 的面积：\n$$ \\mathbf{v}_{ab} \\times \\mathbf{v}_{ad} = (1,0,0) \\times (0.2,0.3,1) = (0, -1, 0.3) $$\n$$ A_{abd} = \\frac{1}{2}\\|(0, -1, 0.3)\\| = \\frac{1}{2}\\sqrt{0^2 + (-1)^2 + 0.3^2} = \\frac{1}{2}\\sqrt{1.09} $$\n面 $\\triangle acd$ 的面积：\n$$ \\mathbf{v}_{ac} \\times \\mathbf{v}_{ad} = (0,1,0) \\times (0.2,0.3,1) = (1, 0, -0.2) $$\n$$ A_{acd} = \\frac{1}{2}\\|(1, 0, -0.2)\\| = \\frac{1}{2}\\sqrt{1^2 + 0^2 + (-0.2)^2} = \\frac{1}{2}\\sqrt{1.04} $$\n面 $\\triangle bcd$ 的面积：\n$$ \\mathbf{v}_{bc} = \\mathbf{c}-\\mathbf{b} = (-1,1,0) $$\n$$ \\mathbf{v}_{bd} = \\mathbf{d}-\\mathbf{b} = (-0.8,0.3,1) $$\n$$ \\mathbf{v}_{bc} \\times \\mathbf{v}_{bd} = (-1,1,0) \\times (-0.8,0.3,1) = (1, 1, -0.3+0.8) = (1, 1, 0.5) $$\n$$ A_{bcd} = \\frac{1}{2}\\|(1, 1, 0.5)\\| = \\frac{1}{2}\\sqrt{1^2+1^2+0.5^2} = \\frac{1}{2}\\sqrt{2.25} = \\frac{1}{2}(1.5) = \\frac{3}{4} $$\n总表面积 $S$ 是这些面积之和：\n$$ S = A_{abc} + A_{abd} + A_{acd} + A_{bcd} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{1.09} + \\frac{1}{2}\\sqrt{1.04} + \\frac{3}{4} = \\frac{5}{4} + \\frac{1}{2}(\\sqrt{1.09} + \\sqrt{1.04}) $$\n\n内切球半径 $r$ 使用关系式 $V = \\frac{1}{3} r S$ 求得：\n$$ r = \\frac{3V}{S} = \\frac{3(1/6)}{S} = \\frac{1/2}{S} = \\frac{1}{2S} = \\frac{1}{\\frac{5}{2} + \\sqrt{1.09} + \\sqrt{1.04}} $$\n\n为求外接球半径 $R$，我们首先求出外心 $\\mathbf{O}=(x,y,z)$，该点与所有顶点等距。我们求解所提供的线性方程组：\n$$ (\\mathbf{b}-\\mathbf{a})\\cdot \\mathbf{O} = \\frac{\\|\\mathbf{b}\\|^{2}-\\|\\mathbf{a}\\|^{2}}{2} $$\n$$ (\\mathbf{c}-\\mathbf{a})\\cdot \\mathbf{O} = \\frac{\\|\\mathbf{c}\\|^{2}-\\|\\mathbf{a}\\|^{2}}{2} $$\n$$ (\\mathbf{d}-\\mathbf{a})\\cdot \\mathbf{O} = \\frac{\\|\\mathbf{d}\\|^{2}-\\|\\mathbf{a}\\|^{2}}{2} $$\n我们有 $\\|\\mathbf{a}\\|^2=0$, $\\|\\mathbf{b}\\|^2=1^2=1$, $\\|\\mathbf{c}\\|^2=1^2=1$, 以及 $\\|\\mathbf{d}\\|^2=0.2^2+0.3^2+1^2=0.04+0.09+1=1.13$。方程组变为：\n1. $(1,0,0) \\cdot (x,y,z) = \\frac{1-0}{2} \\implies x = 0.5$\n2. $(0,1,0) \\cdot (x,y,z) = \\frac{1-0}{2} \\implies y = 0.5$\n3. $(0.2,0.3,1) \\cdot (x,y,z) = \\frac{1.13-0}{2} \\implies 0.2x+0.3y+z = 0.565$\n将 $x=0.5$ 和 $y=0.5$ 代入第三个方程：\n$$ 0.2(0.5) + 0.3(0.5) + z = 0.565 \\implies 0.1 + 0.15 + z = 0.565 \\implies z = 0.315 $$\n外心为 $\\mathbf{O} = (0.5, 0.5, 0.315)$。外接球半径 $R$ 是从 $\\mathbf{O}$ 到任一顶点（例如 $\\mathbf{a}$）的距离：\n$$ R = \\|\\mathbf{O}-\\mathbf{a}\\| = \\|\\mathbf{O}\\| = \\sqrt{0.5^2 + 0.5^2 + 0.315^2} = \\sqrt{0.25 + 0.25 + 0.099225} = \\sqrt{0.599225} $$\n\n现在我们计算半径比质量度量 $q$：\n$$ q = \\frac{3r}{R} = \\frac{3}{R \\times (2S)} = \\frac{3}{\\sqrt{0.599225} \\left( \\frac{5}{2} + \\sqrt{1.09} + \\sqrt{1.04} \\right)} $$\n数值计算如下：\n$R \\approx \\sqrt{0.599225} \\approx 0.774096$\n$S \\approx \\frac{5}{4} + \\frac{1}{2}(1.04403 + 1.01980) = 1.25 + 1.031915 = 2.281915$\n$r = \\frac{1}{2S} \\approx \\frac{1}{2(2.281915)} \\approx 0.219114$\n$$ q = \\frac{3r}{R} \\approx \\frac{3 \\times 0.219114}{0.774096} \\approx \\frac{0.657342}{0.774096} \\approx 0.849178 $$\n四舍五入到四位有效数字，$q \\approx 0.8492$。\n\n接下来，我们计算二面角。这需要计算每个面朝外的法向量。对于面 $\\triangle v_1 v_2 v_3$，其法向量 $\\mathbf{n} = (\\mathbf{v}_2-\\mathbf{v}_1) \\times (\\mathbf{v}_3-\\mathbf{v}_1)$，如果 $\\mathbf{n} \\cdot (\\mathbf{v}_4-\\mathbf{v}_1) < 0$，则该法向量朝外。\n- 面 $\\triangle abc$ (相对于 $\\mathbf{d}$): $\\mathbf{n}_{abc} = (\\mathbf{b}-\\mathbf{a}) \\times (\\mathbf{c}-\\mathbf{a}) = (0,0,1)$。检验: $\\mathbf{n}_{abc} \\cdot (\\mathbf{d}-\\mathbf{a}) = 1 > 0$。所以，朝外法向量为 $\\mathbf{n}_1 = -(0,0,1) = (0,0,-1)$。$\\|\\mathbf{n}_1\\| = 1$。\n- 面 $\\triangle abd$ (相对于 $\\mathbf{c}$): $\\mathbf{n}_{abd} = (\\mathbf{b}-\\mathbf{a}) \\times (\\mathbf{d}-\\mathbf{a}) = (0,-1,0.3)$。检验: $\\mathbf{n}_{abd} \\cdot (\\mathbf{c}-\\mathbf{a}) = -1 < 0$。朝外法向量为 $\\mathbf{n}_2=(0,-1,0.3)$。$\\|\\mathbf{n}_2\\| = \\sqrt{1.09}$。\n- 面 $\\triangle acd$ (相对于 $\\mathbf{b}$): $\\mathbf{n}_{acd} = (\\mathbf{c}-\\mathbf{a}) \\times (\\mathbf{d}-\\mathbf{a}) = (1,0,-0.2)$。检验: $\\mathbf{n}_{acd} \\cdot (\\mathbf{b}-\\mathbf{a}) = 1 > 0$。朝外法向量为 $\\mathbf{n}_3=(-1,0,0.2)$。$\\|\\mathbf{n}_3\\| = \\sqrt{1.04}$。\n- 面 $\\triangle bcd$ (相对于 $\\mathbf{a}$): $\\mathbf{n}_{bcd} = (\\mathbf{c}-\\mathbf{b}) \\times (\\mathbf{d}-\\mathbf{b}) = (1,1,0.5)$。检验: $\\mathbf{n}_{bcd} \\cdot (\\mathbf{a}-\\mathbf{b}) = -1 < 0$。朝外法向量为 $\\mathbf{n}_4=(1,1,0.5)$。$\\|\\mathbf{n}_4\\| = 1.5$。\n\n两个朝外法向量为 $\\mathbf{n}_i, \\mathbf{n}_j$ 的面之间的二面角 $\\theta$ 由公式 $\\theta = \\pi - \\arccos\\left(\\frac{\\mathbf{n}_i\\cdot\\mathbf{n}_j}{\\|\\mathbf{n}_i\\|\\|\\mathbf{n}_j\\|}\\right)$ 给出。\n- 边 $ab$ 上的角 (面 $abc, abd$): $\\mathbf{n}_1 \\cdot \\mathbf{n}_2 = (0,0,-1)\\cdot(0,-1,0.3) = -0.3$。$\\theta_{ab} = \\pi - \\arccos\\left(\\frac{-0.3}{1 \\cdot \\sqrt{1.09}}\\right) \\approx 1.279$ 弧度。\n- 边 $ac$ 上的角 (面 $abc, acd$): $\\mathbf{n}_1 \\cdot \\mathbf{n}_3 = (0,0,-1)\\cdot(-1,0,0.2) = -0.2$。$\\theta_{ac} = \\pi - \\arccos\\left(\\frac{-0.2}{1 \\cdot \\sqrt{1.04}}\\right) \\approx 1.374$ 弧度。\n- 边 $ad$ 上的角 (面 $abd, acd$): $\\mathbf{n}_2 \\cdot \\mathbf{n}_3 = (0,-1,0.3)\\cdot(-1,0,0.2) = 0.06$。$\\theta_{ad} = \\pi - \\arccos\\left(\\frac{0.06}{\\sqrt{1.09}\\sqrt{1.04}}\\right) \\approx 1.627$ 弧度。\n- 边 $bc$ 上的角 (面 $abc, bcd$): $\\mathbf{n}_1 \\cdot \\mathbf{n}_4 = (0,0,-1)\\cdot(1,1,0.5) = -0.5$。$\\theta_{bc} = \\pi - \\arccos\\left(\\frac{-0.5}{1 \\cdot 1.5}\\right) = \\pi - \\arccos\\left(-\\frac{1}{3}\\right) \\approx 1.231$ 弧度。\n- 边 $bd$ 上的角 (面 $abd, bcd$): $\\mathbf{n}_2 \\cdot \\mathbf{n}_4 = (0,-1,0.3)\\cdot(1,1,0.5) = -0.85$。$\\theta_{bd} = \\pi - \\arccos\\left(\\frac{-0.85}{\\sqrt{1.09} \\cdot 1.5}\\right) \\approx 0.996$ 弧度。\n- 边 $cd$ 上的角 (面 $acd, bcd$): $\\mathbf{n}_3 \\cdot \\mathbf{n}_4 = (-1,0,0.2)\\cdot(1,1,0.5) = -0.9$。$\\theta_{cd} = \\pi - \\arccos\\left(\\frac{-0.9}{\\sqrt{1.04} \\cdot 1.5}\\right) \\approx 0.941$ 弧度。\n\n最小二面角为 $\\theta_{\\min\\_calc} = \\theta_{cd} \\approx 0.941$ 弧度。\n\n最后，我们检查可接受性标准：\n1. 半径比：$q \\approx 0.8492$。条件是 $q \\ge q_{\\min} = 0.80$。由于 $0.8492 \\ge 0.80$，此标准得到满足。\n2. 二面角：计算出的最小二面角为 $\\theta_{\\min\\_calc} \\approx 0.941$ 弧度。条件是 $\\theta_{\\min} \\ge 0.75$ 弧度。由于 $0.941 \\ge 0.75$，此标准也得到满足。\n\n该候选四面体满足两个可接受性标准。问题要求将 $q$ 的单一值作为最终答案。", "answer": "$$\n\\boxed{0.8492}\n$$", "id": "3289592"}, {"introduction": "在评估一个单元的质量之前，需要进行一项更基本的检查：它的有效性。本练习介绍了四面体有向体积的概念，它决定了单元是正确定向（正体积）、退化（零体积）还是反转（负体积）。通过分析一个近乎退化的案例，您将理解为什么在编写可靠的网格生成软件时，稳健地处理浮点误差是至关重要的 [@problem_id:3289601]。", "problem": "在计算流体动力学（CFD）的非结构四面体网格生成的前沿推进法中，通过将一个候选点连接到一个定向的活动前沿面来形成一个新的单元。考虑一个具有有序顶点 $a$、$b$、$c$ 的定向面和候选顶点 $d$，其坐标（单位：米）分别为 $a=(0,0,0)$、$b=(1,0,0)$、$c=(0,1,0)$ 和 $d=(1.0 \\times 10^{-10},\\,1.0 \\times 10^{-10},\\,1.0 \\times 10^{-9})$。从将仿射映射的雅可比行列式与三维空间中的体积缩放联系起来的第一性原理，以及通过三个边向量的行列式定义定向体积出发，推导四面体 $(a,b,c,d)$ 的有符号体积 $V$ 的表达式，该表达式用由这些点构成的向量表示。使用此表达式计算 $V$ 的数值，并利用 $V$ 的符号来判断该四面体相对于有序面 $(a,b,c)$ 是正向定向（$V>0$）、退化（$V=0$）还是反向（$V<0$）。然后，提出一个基于局部长度尺度 $h$ 和机器单位舍入误差 $u$ 的浮点容差策略，以在实践中鲁棒地分类近退化情况，明确地根据面 $(a,b,c)$ 定义 $h$，并说明如何在决策规则中使用该容差。\n\n将您计算出的 $V$ 四舍五入到四位有效数字。最终体积以立方米表示。仅报告 $V$ 的值作为您的最终数值答案。", "solution": "顶点为 $(a, b, c, d)$ 的四面体的有符号体积 $V$ 可以从仿射变换的性质推导得出。考虑参数空间 $(\\xi, \\eta, \\zeta)$ 中的一个参考单位四面体 $\\mathcal{T}_{\\text{ref}}$，其有序顶点为 $p_0=(0,0,0)$、$p_1=(1,0,0)$、$p_2=(0,1,0)$ 和 $p_3=(0,0,1)$。此参考四面体的有符号体积为 $V_{\\text{ref}} = \\frac{1}{6}$。\n\n一个仿射映射 $F$ 将参考顶点 $p_i$ 变换到物理空间顶点 $a, b, c, d$。我们建立映射使得 $p_0 \\rightarrow a$，$p_1 \\rightarrow b$，$p_2 \\rightarrow c$ 和 $p_3 \\rightarrow d$。仿射映射的一般形式为 $F(p) = M p + \\mathbf{t}$，其中 $M$ 是一个 $3 \\times 3$ 矩阵，$\\mathbf{t}$ 是一个平移向量。\n根据顶点对应关系，我们找到平移向量：\n$F(p_0) = M(0,0,0)^T + \\mathbf{t} = a \\implies \\mathbf{t} = a$。\n矩阵 $M$ 的列可以通过映射参数空间的基向量找到：\n$F(p_1) = M(1,0,0)^T + a = b \\implies M_{\\cdot 1} = b-a$。\n$F(p_2) = M(0,1,0)^T + a = c \\implies M_{\\cdot 2} = c-a$。\n$F(p_3) = M(0,0,1)^T + a = d \\implies M_{\\cdot 3} = d-a$。\n矩阵 $M$ 正是该变换的雅可比矩阵 $J_F$，其列是从顶点 $a$ 出发的四面体的边向量：\n$$J_F = M = \\begin{pmatrix} b-a & c-a & d-a \\end{pmatrix}$$\n一个区域的体积会根据变换的雅可比行列式的值进行缩放。对于有符号体积，该关系为：\n$$V = V_{\\text{ref}} \\cdot \\det(J_F)$$\n代入 $V_{\\text{ref}} = \\frac{1}{6}$，我们得到四面体 $(a,b,c,d)$ 的有符号体积 $V$ 所需的表达式：\n$$V = \\frac{1}{6} \\det(b-a, c-a, d-a)$$\n该表达式等价于边向量标量三重积的六分之一，$V = \\frac{1}{6} ((b-a) \\times (c-a)) \\cdot (d-a)$。\n\n接下来，我们计算给定坐标（单位均为米）下的 $V$ 的数值：$a=(0,0,0)$、$b=(1,0,0)$、$c=(0,1,0)$ 和 $d=(1.0 \\times 10^{-10}, 1.0 \\times 10^{-10}, 1.0 \\times 10^{-9})$。\n从顶点 $a$ 出发的边向量是：\n$\\vec{v}_1 = b-a = (1, 0, 0)$\n$\\vec{v}_2 = c-a = (0, 1, 0)$\n$\\vec{v}_3 = d-a = (1.0 \\times 10^{-10}, 1.0 \\times 10^{-10}, 1.0 \\times 10^{-9})$\n有符号体积由这些向量构成的矩阵的行列式计算得出：\n$$V = \\frac{1}{6} \\begin{vmatrix} 1 & 0 & 1.0 \\times 10^{-10} \\\\ 0 & 1 & 1.0 \\times 10^{-10} \\\\ 0 & 0 & 1.0 \\times 10^{-9} \\end{vmatrix}$$\n由于这是一个上三角矩阵，其行列式是对角线元素的乘积：\n$$\\det(J_F) = 1 \\cdot 1 \\cdot (1.0 \\times 10^{-9}) = 1.0 \\times 10^{-9}$$\n因此，有符号体积为：\n$$V = \\frac{1}{6} \\times (1.0 \\times 10^{-9}) \\text{ m}^3 \\approx 0.16666... \\times 10^{-9} \\text{ m}^3$$\n按要求四舍五入到四位有效数字，我们得到：\n$$V \\approx 1.667 \\times 10^{-10} \\text{ m}^3$$\n\n$V$ 的符号决定了四面体的定向。\n- 如果 $V>0$，四面体是正向定向的。顶点顺序 $(a,b,c,d)$ 遵循右手定则。\n- 如果 $V<0$，四面体是反向或负向定向的。\n- 如果 $V=0$，四面体是退化的（其四个顶点共面）。\n由于我们计算出的 $V \\approx 1.667 \\times 10^{-10}$ 是正数，所以该四面体相对于面 $(a,b,c)$ 是正向定向的。\n\n对于网格划分的实际应用，浮点运算使得与 0 的直接比较不可靠。一种用于分类近退化情况的鲁棒策略是使用基于局部单元尺寸和机器精度的容差。\n1.  **定义局部长度尺度 $h$**：为单元定义一个特征长度尺度。对于面 $(a,b,c)$，一个鲁棒的选择是其最长边的长度。\n    该面的边长为 $|b-a|=\\sqrt{1^2+0^2+0^2}=1$、 $|c-a|=\\sqrt{0^2+1^2+0^2}=1$ 和 $|c-b|=\\sqrt{(-1)^2+1^2+0^2}=\\sqrt{2}$。\n    长度尺度为 $h = \\max(1, 1, \\sqrt{2}) = \\sqrt{2}$ 米。\n\n2.  **定义体积容差 $\\epsilon_V$**：定义一个容差 $\\epsilon_V$ 来为体积建立一个“数值零”区域。该容差应根据单元的特征体积 $h^3$ 和机器单位舍入误差 $u$（对于 IEEE 754 双精度，约等于 $2.22 \\times 10^{-16}$）进行缩放。该容差由下式给出：\n    $$\\epsilon_V = u \\cdot h^3$$\n    这种公式使得退化测试与网格尺度无关。对于给定的问题，$\\epsilon_V = u \\cdot (\\sqrt{2})^3 = u \\cdot 2\\sqrt{2}$。\n\n3.  **提出决策规则**：通过将计算出的有符号体积 $V$ 与容差 $\\epsilon_V$进行比较，可以鲁棒地对定向进行分类：\n    -   如果 $V > \\epsilon_V$：四面体被分类为**正向定向**。\n    -   如果 $V < -\\epsilon_V$：四面体被分类为**反向**。\n    -   如果 $|V| \\le \\epsilon_V$：四面体被分类为**退化**。在前沿推进算法中，这样的单元将被拒绝，并考虑替代的候选点。\n在我们的例子中，$V \\approx 1.667 \\times 10^{-10}$，而 $\\epsilon_V \\approx (2.22 \\times 10^{-16}) \\cdot 2\\sqrt{2} \\approx 6.28 \\times 10^{-16}$。由于 $V \\gg \\epsilon_V$，该四面体被鲁棒地分类为正向定向，尽管它是一个非常扁平的“狭长”单元。", "answer": "$$\\boxed{1.667 \\times 10^{-10}}$$", "id": "3289601"}]}