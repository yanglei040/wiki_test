{"hands_on_practices": [{"introduction": "任何复杂的算法都始于对其基本步骤的透彻理解。本练习将引导您“解剖”共轭梯度（CG）方法的单次完整迭代过程。通过为一个简单的 $2 \\times 2$ 对称正定线性系统手动计算所有关键量，您将直观地看到步长 $\\alpha_k$ 和共轭方向系数 $\\beta_k$ 是如何通过优化原理（即误差最小化和 $A$-共轭性）自然产生的。完成这个基础练习是牢固掌握CG方法内部运行机制的关键一步。[@problem_id:3371621]", "problem": "考虑一个源于计算流体动力学中椭圆算子的对称正定离散化的线性系统，例如在最小控制体格式上的压力泊松方程。设矩阵为 $A = \\begin{pmatrix} 4 & 1 \\\\ 1 & 3 \\end{pmatrix}$，右端项为 $b=\\begin{pmatrix}1\\\\2\\end{pmatrix}$，初始迭代向量为 $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$。共轭梯度法 (CG) 是通过在克雷洛夫子空间上最小化二次泛函 $\\phi(x)=\\frac{1}{2}x^{\\top}Ax-b^{\\top}x$ 推导出来的，其中残差为 $r_{k}=b-Ax_{k}$，搜索方向相互 $A$-共轭，并且选择步长以使得新残差在欧几里得内积下与当前搜索方向正交。从这些基本原理出发，并且不使用任何简便公式，为给定的 $A$、$b$ 和 $x_{0}$ 显式计算第一步的量 $\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。提供精确值，不要进行四舍五入。为了报告，将最终答案表示为行向量 $\\left(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0}\\right)$ 的形式，其中 $x_{1,i}$ 和 $r_{1,i}$ 分别表示 $x_{1}$ 和 $r_{1}$ 的分量。", "solution": "该问题是适定且科学合理的。它要求在给定一个线性系统的情况下，从算法的基本原理出发，计算共轭梯度 (CG) 法的第一次迭代，而不是依赖于现成的算法总结。\n\n待求解的系统是 $Ax=b$，其中矩阵 $A$ 是对称正定 (SPD) 的。CG 方法通过最小化二次泛函 $\\phi(x) = \\frac{1}{2}x^{\\top}Ax - b^{\\top}x$ 来迭代地构造解。该泛函的梯度是 $\\nabla\\phi(x) = Ax - b$，它是残差 $r(x) = b - Ax$ 的负值。因此，最小化 $\\phi(x)$ 等价于找到满足 $\\nabla\\phi(x) = 0$ 的 $x$，这正是 $Ax=b$ 的解。\n\n给定的条件是：\n矩阵 $A = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n右端项向量 $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n解的初始猜测 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n对于迭代 $k=0, 1, 2, ...$，CG 算法按如下步骤进行：\n1. 更新解： $x_{k+1} = x_{k} + \\alpha_{k} p_{k}$\n2. 更新残差： $r_{k+1} = r_{k} - \\alpha_{k} A p_{k}$\n3. 更新搜索方向： $p_{k+1} = r_{k+1} + \\beta_{k} p_{k}$\n\n参数 $\\alpha_k$ 和 $\\beta_k$ 是从核心原理推导出来的。\n\n**步骤 0：初始化**\n\n首先，我们根据初始猜测 $x_0$ 计算初始残差 $r_0$。\n$$r_{0} = b - Ax_{0}$$\n由于 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，初始残差就是 $b$：\n$$r_{0} = b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n第一个搜索方向 $p_0$ 被选为最速下降方向，即初始残差：\n$$p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n\n**步骤 1：第一次迭代 ($k=0$)**\n\n我们需要计算 $\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。\n\n**计算步长 $\\alpha_{0}$**\n选择步长 $\\alpha_{0}$ 以沿搜索方向 $p_{0}$ 最小化 $\\phi(x_{1}) = \\phi(x_{0} + \\alpha_{0} p_{0})$。当新残差 $r_{1}$ 与当前搜索方向 $p_{0}$ 正交时，即 $p_{0}^{\\top}r_{1} = 0$，达到此最小值。\n新残差由 $r_{1} = b - Ax_{1} = b - A(x_{0} + \\alpha_{0} p_{0}) = (b - Ax_{0}) - \\alpha_{0}Ap_{0} = r_0 - \\alpha_0 A p_0$ 给出。\n将其代入正交性条件：\n$$p_{0}^{\\top}(r_{0} - \\alpha_{0} A p_{0}) = 0$$\n$$p_{0}^{\\top}r_{0} - \\alpha_{0} p_{0}^{\\top}A p_{0} = 0$$\n求解 $\\alpha_0$ 可得：\n$$\\alpha_{0} = \\frac{p_{0}^{\\top}r_{0}}{p_{0}^{\\top}A p_{0}}$$\n由于 $p_0 = r_0$，这变为：\n$$\\alpha_{0} = \\frac{r_{0}^{\\top}r_{0}}{r_{0}^{\\top}A r_{0}}$$\n我们计算必要的量：\n$r_{0}^{\\top}r_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (1)(1) + (2)(2) = 1 + 4 = 5$。\n$A p_{0} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) \\\\ 1(1) + 3(2) \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$。\n$p_{0}^{\\top}A p_{0} = r_{0}^{\\top}A p_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (1)(6) + (2)(7) = 6 + 14 = 20$。\n代入这些值：\n$$\\alpha_{0} = \\frac{5}{20} = \\frac{1}{4}$$\n\n**计算新的迭代向量 $x_{1}$**\n新的解估计值 $x_1$ 是通过从 $x_0$ 沿方向 $p_0$ 移动步长 $\\alpha_0$ 得到的：\n$$x_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{2}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$$\n因此，$x_{1,1} = \\frac{1}{4}$ 且 $x_{1,2} = \\frac{1}{2}$。\n\n**计算新的残差 $r_{1}$**\n新的残差 $r_1$ 可以使用更新公式计算：\n$$r_{1} = r_{0} - \\alpha_{0} A p_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{1}{4} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{6}{4} \\\\ 2 - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{4} - \\frac{6}{4} \\\\ \\frac{8}{4} - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{4} \\\\ \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$$\n因此，$r_{1,1} = -\\frac{1}{2}$ 且 $r_{1,2} = \\frac{1}{4}$。\n\n**计算系数 $\\beta_{0}$**\n系数 $\\beta_0$ 用于构造下一个搜索方向 $p_1 = r_1 + \\beta_0 p_0$。其基本原理是，新的搜索方向 $p_1$ 必须与前一个方向 $p_0$ 是 $A$-共轭的，即 $p_{1}^{\\top}A p_{0} = 0$。\n$$(r_{1} + \\beta_{0} p_{0})^{\\top}A p_{0} = 0$$\n$$r_{1}^{\\top}A p_{0} + \\beta_{0} p_{0}^{\\top}A p_{0} = 0$$\n求解 $\\beta_0$：\n$$\\beta_{0} = -\\frac{r_{1}^{\\top}A p_{0}}{p_{0}^{\\top}A p_{0}}$$\n从前面的计算中我们已经得到：$A p_0 = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$ 和 $p_{0}^{\\top}A p_{0} = 20$。\n我们需要计算分子：\n$r_{1}^{\\top}A p_{0} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (-\\frac{1}{2})(6) + (\\frac{1}{4})(7) = -3 + \\frac{7}{4} = -\\frac{12}{4} + \\frac{7}{4} = -\\frac{5}{4}$。\n现在我们可以计算 $\\beta_0$：\n$$\\beta_{0} = - \\frac{-\\frac{5}{4}}{20} = \\frac{5}{4 \\cdot 20} = \\frac{5}{80} = \\frac{1}{16}$$\n\n所求的量为 $\\alpha_{0} = \\frac{1}{4}$，$x_{1} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$，$r_{1} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$ 和 $\\beta_{0} = \\frac{1}{16}$。\n将最终答案组合成指定的行向量格式 $(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0})$。\n这得到行向量 $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{2}, -\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{16})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{16} \\end{pmatrix}}$$", "id": "3371621"}, {"introduction": "我们不仅关心一个算法如何工作，更关心它的工作效率。CG方法的收敛速度与所求解的线性系统矩阵 $A$ 的谱特性密切相关，尤其是其谱条件数 $\\kappa(A)$。这个练习将指导您应用CG方法的经典收敛上界，来估算在给定的条件数下，要达到特定的计算精度理论上需要多少次迭代。这个练习清晰地揭示了为什么在计算流体力学问题中常见的大条件数会严重影响计算效率，从而凸显了预处理技术的重要性。[@problem_id:3371645]", "problem": "考虑一个对称正定线性系统 $A x = b$，该系统来自于在均匀网格上对不可压缩流中的稳态压力泊松方程进行的单元中心有限体积离散化，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，其谱条件数 $\\kappa(A)$ 定义为 $\\kappa(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$。对该系统应用共轭梯度法（CG），且采用精确算术运算且无预处理。假设已知谱条件数为 $\\kappa(A) = 10^{4}$。使用共轭梯度法在 $A$-范数下关于 $\\kappa(A)$ 的标准最坏情况误差界，确定最小的整数迭代次数 $k$，使得该界保证从任意初始误差开始，$A$-范数误差的缩减因子最多为 $10^{-6}$。将最终的迭代次数表示为一个不带单位的整数。", "solution": "该问题要求确定共轭梯度法（CG）所需的最小整数迭代次数，记为 $k$，以保证对线性系统 $A x = b$ 实现指定的误差缩减。给定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的。分析依赖于CG方法的标准最坏情况收敛界。\n\n第 $k$ 次迭代的误差定义为 $e_k = x_k - x$，其中 $x_k$ 是第 $k$ 次迭代的近似解，$x$ 是精确解。误差在 $A$-范数下度量，其定义为对任意向量 $v \\in \\mathbb{R}^n$，$\\|v\\|_A = \\sqrt{v^T A v}$。CG方法迭代 $k$ 次后，$A$-范数下相对误差缩减的经典上界由以下不等式给出：\n$$ \\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k $$\n其中 $e_0$ 是初始误差，$\\kappa(A)$ 是矩阵 $A$ 的谱条件数，定义为其最大特征值与最小特征值的比值，$\\kappa(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。\n\n问题提供了以下数据：\n1. 谱条件数为 $\\kappa(A) = 10^4$。\n2. 期望的误差缩减因子最多为 $10^{-6}$。这意味着我们要寻找最小的 $k$，使得误差比的上界小于或等于这个值：$\\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 10^{-6}$。\n\n我们必须找到满足不等式的最小整数 $k$，其中理论界的右侧受所需缩减因子的约束：\n$$ 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k \\leq 10^{-6} $$\n我们代入给定的值 $\\kappa(A) = 10^4$。首先，我们计算条件数的平方根：\n$$ \\sqrt{\\kappa(A)} = \\sqrt{10^4} = 10^2 = 100 $$\n将此代入不等式，得到：\n$$ 2 \\left( \\frac{100 - 1}{100 + 1} \\right)^k \\leq 10^{-6} $$\n$$ 2 \\left( \\frac{99}{101} \\right)^k \\leq 10^{-6} $$\n为了求解整数 $k$，我们首先分离出以 $k$ 为幂的项：\n$$ \\left( \\frac{99}{101} \\right)^k \\leq \\frac{1}{2} \\times 10^{-6} $$\n接下来，我们对不等式两边取自然对数。由于自然对数 $\\ln(x)$ 对于 $x > 0$ 是一个单调递增函数，不等号的方向保持不变：\n$$ \\ln\\left[ \\left( \\frac{99}{101} \\right)^k \\right] \\leq \\ln\\left( \\frac{1}{2} \\times 10^{-6} \\right) $$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq \\ln\\left( \\frac{1}{2} \\right) + \\ln(10^{-6}) $$\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq -\\ln(2) - 6 \\ln(10) $$\n由于项 $\\ln(99/101)$ 的参数 $99/101$ 小于 1，所以该项为负。因此，当我们除以 $\\ln(99/101)$ 来分离 $k$ 时，必须反转不等号的方向：\n$$ k \\geq \\frac{-\\ln(2) - 6 \\ln(10)}{\\ln(99/101)} $$\n为了方便计算，可以将分子和分母同乘以 $-1$，并利用性质 $-\\ln(x/y) = \\ln(y/x)$，从而得到表达式：\n$$ k \\geq \\frac{\\ln(2) + 6 \\ln(10)}{\\ln(101/99)} $$\n为了求出 $k$ 的下界的数值，我们使用自然对数的标准值：$\\ln(2) \\approx 0.693147$ 和 $\\ln(10) \\approx 2.302585$。\n分子是：\n$$ \\ln(2) + 6 \\ln(10) \\approx 0.693147 + 6 \\times (2.302585) = 0.693147 + 13.81551 = 14.508657 $$\n分母是：\n$$ \\ln\\left(\\frac{101}{99}\\right) = \\ln(101) - \\ln(99) \\approx 4.6151205 - 4.5951198 = 0.0200007 $$\n现在，我们计算比值：\n$$ k \\geq \\frac{14.508657}{0.0200007} \\approx 725.409 $$\n迭代次数 $k$ 必须是整数。不等式 $k \\geq 725.409$ 要求我们找到满足此条件的最小整数。这可以通过对该数值取上整得到：\n$$ k = \\lceil 725.409 \\rceil = 726 $$\n因此，为了保证最坏情况下的误差缩减最多为 $10^{-6}$，至少需要 $726$ 次迭代。", "answer": "$$\\boxed{726}$$", "id": "3371645"}, {"introduction": "上一个练习揭示了大条件数带来的挑战，而预处理技术正是应对这一挑战的关键。然而，引入预处理器 $M$ 会带来新的考量。本练习是一个重要的思想实验，旨在揭示预处理共轭梯度法（PCG）中的一个常见陷阱：直接使用预处理后的残差范数 $\\|M^{-1} r_k\\|_2$ 作为停机准则有时会产生误导，导致在真实残差 $\\|r_k\\|_2$ 依然很大的情况下算法提前终止。理解这种尺度效应对于在实际应用中开发和使用稳健的PCG求解器至关重要。[@problem_id:3371613]", "problem": "在计算流体力学中，当离散化诸如压力泊松方程等椭圆算子时，会遇到求解对称正定 (SPD) 线性系统的共轭梯度 (CG) 求解器。考虑不可压缩流压力修正的典型模型问题，即在具有齐次狄利克雷边界条件的矩形域上的压力泊松方程，由 $-\\nabla^{2} p = f$ 给出。在间距为 $h_x$ 和 $h_y$ 的均匀笛卡尔网格上进行标准的二阶中心有限差分離散化，会得到一个具有五点模板的 SPD 线性系统 $A p = b$；对于内部节点，对角元满足 $A_{ii} = 2\\left(h_x^{-2} + h_y^{-2}\\right)$，坐标方向上的非对角元为 $-h_x^{-2}$ 和 $-h_y^{-2}$。用于求解 $A p = b$ 的预处理共轭梯度 (PCG) 方法，在使用一个左预处理器 $M$ (SPD) 时，会生成迭代解 $p_k$ 和残差 $r_k = b - A p_k$。一个常用的诊断指标是预处理残差的欧几里得范数，即 $\\|M^{-1} r_k\\|_2$。\n\n仅从这些基本事实以及残差和预处理的定义出发，构建并评估这样一些情景：在这些情景中，预处理残差范数 $\\|M^{-1} r_k\\|_2$ 可能具有欺骗性地小，而真实残差范数 $\\|r_k\\|_2$ 仍然大到不可接受。特别地，请使用离散化算子的缩放、残差的定义以及诸如 $\\|M^{-1} r\\|_2 \\le \\|M^{-1}\\|_2 \\|r\\|_2$ 和 $r = M (M^{-1} r)$（意味着 $\\|r\\|_2 \\le \\|M\\|_2 \\|M^{-1} r\\|_2$）等算子范数不等式，从第一性原理进行推理。除了所述内容外，不要假设任何特定的停止准则；相反，应检查关于 $\\|M^{-1} r_k\\|_2$ 的绝对阈值如何可能错误地表示收敛状态。\n\n以下哪个选项正确地构建了这样的情景，并正确解释了为什么基于 $\\|M^{-1} r_k\\|_2$ 的一个小的绝对值进行简单停止可能是误导性的？选择所有适用项。\n\nA. 对于五点拉普拉斯算子，在 $x$ 方向上使用各向异性拉伸网格，$h_x = 10^{-3}$ 且 $h_y = 1$，并使用 Jacobi 预处理器 $M = \\mathrm{diag}(A)$。假设在某次迭代 $k$ 中，残差 $r_k$ 集中在单个内部节点上，其大小为 $\\|r_k\\|_2 \\approx 10^{3}$。那么 $M_{ii} \\approx 2\\left(h_x^{-2} + h_y^{-2}\\right) \\approx 2 \\cdot 10^{6}$，因此 $M^{-1} r_k$ 的相应分量被大约 $1/M_{ii}$ 缩小，得到 $\\|M^{-1} r_k\\|_2 \\approx 5 \\cdot 10^{-4}$，尽管 $\\|r_k\\|_2 \\approx 10^{3}$。根据 $\\|M^{-1} r_k\\|_2$ 的绝对阈值停止迭代将过早地宣布收敛，尽管真实残差很大。\n\nB. 对于任何 SPD 预处理器 $M$，量 $\\|M^{-1} r_k\\|_2$ 都是 $\\|r_k\\|_2$ 的一个单调递减且可靠的替代指标，因此当 $\\|M^{-1} r_k\\|_2$ 很小时停止迭代不会产生误导。\n\nC. 在对 SPD 系统进行左预处理时，真实误差的 $A$-能量范数 $\\|p_k - p_\\star\\|_{A} = \\sqrt{(p_k - p_\\star)^{\\top} A (p_k - p_\\star)}$ 总是满足形式为 $\\|p_k - p_\\star\\|_{A} \\le C \\|M^{-1} r_k\\|_2$ 的界，其中常数 $C$ 与 $M$ 无关，因此小的 $\\|M^{-1} r_k\\|_2$ 总是收敛的一个可信指标。\n\nD. 考虑一个极端但与 SPD 一致的选择 $A = I$（例如，在无量纲化和一个局部解耦子问题的精确对角占优之后出现），并使用对角 SPD 预处理器 $M = \\mathrm{diag}(10^{6}, 1, \\dots, 1)$。从 $p_0 = 0$ 开始，并取 $b = r_0 = 10^{3} e_1$，得到 $\\|r_0\\|_2 = 10^{3}$，而 $\\|M^{-1} r_0\\|_2 = 10^{-3}$。预处理器对第一个分量的重新缩放非常强烈，以至于对 $\\|M^{-1} r_k\\|_2$ 进行的绝对停止测试会接受一个具有很大真实残差的解。", "solution": "用户希望在预处理共轭梯度 (PCG) 方法的背景下，对真实残差范数和预处理残差范数之间的关系进行批判性分析。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **控制方程：** 压力泊松方程，$-\\nabla^{2} p = f$，在具有齐次狄利克雷边界条件的矩形域上。\n-   **离散化方法：** 在均匀笛卡尔网格上进行标准的二阶中心有限差分，网格间距为 $h_x$ 和 $h_y$。\n-   **线性系统：** 一个 SPD 线性系统 $A p = b$。\n-   **矩阵性质：** 对于内部节点 $i$，对角元为 $A_{ii} = 2\\left(h_x^{-2} + h_y^{-2}\\right)$，非对角元为 $-h_x^{-2}$ 和 $-h_y^{-2}$（五点模板）。\n-   **数值方法：** 预处理共轭梯度 (PCG)，使用左预处理器 $M$，其为 SPD。\n-   **定义：** 迭代解为 $p_k$。残差为 $r_k = b - A p_k$。\n-   **收敛诊断：** 预处理残差的欧几里得范数，$\\|M^{-1} r_k\\|_2$。\n-   **核心任务：** 构建并评估在哪些情景中，$\\|M^{-1} r_k\\|_2$ 可能具有欺骗性地小，而真实残差范数 $\\|r_k\\|_2$ 仍然很大。\n-   **分析工具：** 使用算子的缩放、残差的定义以及算子范数不等式 $\\|M^{-1} r\\|_2 \\le \\|M^{-1}\\|_2 \\|r\\|_2$ 和 $\\|r\\|_2 \\le \\|M\\|_2 \\|M^{-1} r\\|_2$。\n-   **约束：** 检查关于 $\\|M^{-1} r_k\\|_2$ 的绝对阈值如何可能产生误导。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学基础：** 问题陈述牢固地植根于求解偏微分方程的数值线性代数的标准理论和实践中。压力泊松方程、有限差分離散化、由此产生的 SPD 矩阵结构以及 PCG 方法都是计算科学与工程中的经典课题。\n-   **适定性：** 该问题作为一个概念分析任务是适定的。它要求基于明确定义的理论框架和数学关系来评估特定情景。基于这些原则，可以对每个选项得出明确的结论。\n-   **客观性：** 问题以精确、客观、技术性的语言陈述，没有歧义或主观看法。\n\n问题陈述内部一致、科学上合理且适定。未检测到任何缺陷。\n\n**步骤 3：结论和行动**\n\n问题有效。将继续进行求解过程。\n\n### 推导和选项分析\n\n问题的核心在于真实残差范数 $\\|r_k\\|_2$ 和预处理残差范数 $\\|M^{-1} r_k\\|_2$ 之间的关系。这两个量通过 SPD 预处理器 $M$ 相关联。根据定义，$r_k = M(M^{-1} r_k)$。应用诱导矩阵范数的性质，我们可以建立界：\n$$\n\\|r_k\\|_2 = \\|M(M^{-1} r_k)\\|_2 \\le \\|M\\|_2 \\|M^{-1} r_k\\|_2\n$$\n$$\n\\|M^{-1} r_k\\|_2 \\le \\|M^{-1}\\|_2 \\|r_k\\|_2\n$$\n从第一个不等式可以看出，如果预处理器 $M$ 的谱范数 $\\|M\\|_2 = \\lambda_{\\max}(M)$很大，那么 $\\|r_k\\|_2$ 可能远大于 $\\|M^{-1} r_k\\|_2$。当 $\\|M\\|_2 \\gg 1$ 时，就会出现“欺骗性地小”的预处理残差范数。在这种情况下，$\\|M^{-1} r_k\\|_2$ 的小值不能保证 $\\|r_k\\|_2$ 的小值。基于 $\\|M^{-1} r_k\\|_2$ 绝对容差的停止准则变得不可靠，因为它忽略了 $M$ 的缩放效应。一个更稳健的停止准则会涉及相对范数，例如 $\\|M^{-1} r_k\\|_2 \\le \\text{tol} \\cdot \\|M^{-1} r_0\\|_2$，或者直接监控真实残差范数（会带来额外的计算成本）。\n\n我们现在根据这一原则评估每个选项。\n\n**A. 对于五点拉普拉斯算子，在 $x$ 方向上使用各向异性拉伸网格，$h_x = 10^{-3}$ 且 $h_y = 1$，并使用 Jacobi 预处理器 $M = \\mathrm{diag}(A)$。假设在某次迭代 $k$ 中，残差 $r_k$ 集中在单个内部节点上，其大小为 $\\|r_k\\|_2 \\approx 10^{3}$。那么 $M_{ii} \\approx 2\\left(h_x^{-2} + h_y^{-2}\\right) \\approx 2 \\cdot 10^{6}$，因此 $M^{-1} r_k$ 的相应分量被大约 $1/M_{ii}$ 缩小，得到 $\\|M^{-1} r_k\\|_2 \\approx 5 \\cdot 10^{-4}$，尽管 $\\|r_k\\|_2 \\approx 10^{3}$。根据 $\\|M^{-1} r_k\\|_2$ 的绝对阈值停止迭代将过早地宣布收敛，尽管真实残差很大。**\n\nJacobi 预处理器定义为 $M = \\mathrm{diag}(A)$。对于内部节点 $i$，$A$ 的对角元由 $A_{ii} = 2(h_x^{-2} + h_y^{-2})$ 给出。\n给定网格间距 $h_x = 10^{-3}$ 和 $h_y = 1$，我们有：\n$$\nA_{ii} = 2 \\left( (10^{-3})^{-2} + 1^{-2} \\right) = 2(10^6 + 1) \\approx 2 \\cdot 10^6\n$$\n预处理器 $M$ 是一个对角矩阵，其对角线上的值很大。因此，它的逆 $M^{-1}$ 也是一个对角矩阵，其元素为 $M^{-1}_{ii} = 1/A_{ii} \\approx 1/(2 \\cdot 10^6) = 5 \\cdot 10^{-7}$。\n该情景假设残差 $r_k$ 集中在单个节点（比如说节点 $j$）上，使得 $\\|r_k\\|_2 \\approx 10^3$。这意味着 $r_k \\approx 10^3 e_j$，其中 $e_j$ 是标准基向量。\n预处理残差是 $M^{-1} r_k$。由于 $M^{-1}$ 和 $r_k$ 都是局域化的，我们有：\n$$\nM^{-1} r_k \\approx M^{-1} (10^3 e_j) = 10^3 (M^{-1} e_j) = 10^3 (M^{-1}_{jj}) e_j \\approx 10^3 (5 \\cdot 10^{-7}) e_j = 5 \\cdot 10^{-4} e_j\n$$\n因此，预处理残差的范数为：\n$$\n\\|M^{-1} r_k\\|_2 \\approx \\|5 \\cdot 10^{-4} e_j\\|_2 = 5 \\cdot 10^{-4}\n$$\n计算是正确的。我们遇到了真实残差范数很大（$\\approx 10^3$），而预处理残差范数很小（$\\approx 5 \\cdot 10^{-4}$）的情况。这种差异是由预处理器 $M$ 中的大元素引起的，即一个大的 $\\|M\\|_2 \\approx 2 \\cdot 10^6$。像 $\\|M^{-1} r_k\\|_2  10^{-3}$ 这样的绝对停止准则将被满足，导致过早终止。此选项正确地构建了一个物理相关的场景，并准确地解释了其机制。\n\n结论：**正确**。\n\n**B. 对于任何 SPD 预处理器 $M$，量 $\\|M^{-1} r_k\\|_2$ 都是 $\\|r_k\\|_2$ 的一个单调递减且可靠的替代指标，因此当 $\\|M^{-1} r_k\\|_2$ 很小时停止迭代不会产生误导。**\n\n该陈述提出了两个强有力的主张。首先，$\\|M^{-1} r_k\\|_2$ 是单调递减的。虽然 PCG 算法确保误差的 $A$-范数 $\\|p_k - p_\\star\\|_A$ 单调递减，因此残差的 $A^{-1}$-范数 $\\|r_k\\|_{A^{-1}}$ 也单调递减，但对于 $\\|M^{-1} r_k\\|_2$ 通常不能保证这一点。它可能表现出非单调行为，尽管趋势是下降的。其次，更重要的是，它声称 $\\|M^{-1} r_k\\|_2$ 是 $\\|r_k\\|_2$ 的“可靠替代指标”。正如我们最初的推导所确立的，关系是 $\\|r_k\\|_2 \\le \\|M\\|_2 \\|M^{-1} r_k\\|_2$。如果 $\\|M\\|_2$ 很大，那么在绝对意义上，$\\|M^{-1} r_k\\|_2$ 不是 $\\|r_k\\|_2$ 的可靠替代指标。前者的一个小值并不意味着后者也是一个小值。选项 A 为此主张提供了一个直接的反例。\n\n结论：**不正确**。\n\n**C. 在对 SPD 系统进行左预处理时，真实误差的 $A$-能量范数 $\\|p_k - p_\\star\\|_{A} = \\sqrt{(p_k - p_\\star)^{\\top} A (p_k - p_\\star)}$ 总是满足形式为 $\\|p_k - p_\\star\\|_{A} \\le C \\|M^{-1} r_k\\|_2$ 的界，其中常数 $C$ 与 $M$ 无关，因此小的 $\\|M^{-1} r_k\\|_2$ 总是收敛的一个可信指标。**\n\n让我们分析误差范数和预处理残差范数之间的关系。误差为 $e_k = p_k - p_\\star$，残差为 $r_k = b - Ap_k = A p_\\star - A p_k = -A e_k$。\n误差的 $A$-能量范数是 $\\|e_k\\|_A$。其平方为：\n$$\n\\|e_k\\|_A^2 = e_k^\\top A e_k = (-A^{-1} r_k)^\\top A (-A^{-1} r_k) = r_k^\\top A^{-1} A A^{-1} r_k = r_k^\\top A^{-1} r_k = \\|r_k\\|_{A^{-1}}^2\n$$\n这是一个标准恒等式。现在我们将其与 $\\|M^{-1} r_k\\|_2$ 联系起来。令 $z_k = M^{-1} r_k$，这意味着 $r_k = M z_k$。\n$$\n\\|e_k\\|_A^2 = (M z_k)^\\top A^{-1} (M z_k) = z_k^\\top M A^{-1} M z_k\n$$\n要使其被 $C^2 \\|z_k\\|_2^2$ 界定，其中 $C$ 是一个常数，我们必须有：\n$$\nz_k^\\top M A^{-1} M z_k \\le C^2 (z_k^\\top z_k)\n$$\n根据诱导 2-范数的定义（或瑞利商），对于所有 $z_k$ 满足此式的最小可能 $C^2$ 值是矩阵 $M A^{-1} M$ 的最大特征值。\n$$\nC^2 = \\lambda_{\\max}(M A^{-1} M) = \\|M A^{-1} M\\|_2\n$$\n这个常数 $C = \\sqrt{\\|M A^{-1} M\\|_2}$ 明确地依赖于预处理器 $M$。该陈述声称 $C$ 与 $M$ 无关是错误的。例如，如果我们将 $M$ 乘以一个因子 $\\alpha > 0$，常数将变为 $C' = \\sqrt{\\|\\alpha M A^{-1} \\alpha M\\|_2} = \\alpha \\sqrt{\\|M A^{-1} M\\|_2} = \\alpha C$。\n\n结论：**不正确**。\n\n**D. 考虑一个极端但与 SPD 一致的选择 $A = I$（例如，在无量纲化和一个局部解耦子问题的精确对角占优之后出现），并使用对角 SPD 预处理器 $M = \\mathrm{diag}(10^{6}, 1, \\dots, 1)$。从 $p_0 = 0$ 开始，并取 $b = r_0 = 10^{3} e_1$，得到 $\\|r_0\\|_2 = 10^{3}$，而 $\\|M^{-1} r_0\\|_2 = 10^{-3}$。预处理器对第一个分量的重新缩放非常强烈，以至于对 $\\|M^{-1} r_k\\|_2$ 进行的绝对停止测试会接受一个具有很大真实残差的解。**\n\n该选项提供了一个清晰、抽象的测试案例。\n-   系统矩阵：$A = I$ (单位矩阵)，它是 SPD 的。\n-   预处理器：$M = \\mathrm{diag}(10^6, 1, \\dots, 1)$，它也是 SPD 的。\n-   初始状态：$p_0 = 0$。初始残差为 $r_0 = b - A p_0 = b$。\n-   右侧项：$b = 10^3 e_1$，其中 $e_1$ 是第一个标准基向量。\n迭代 $k=0$ 时的真实残差是 $r_0 = 10^3 e_1$。其欧几里得范数为：\n$$\n\\|r_0\\|_2 = \\|10^3 e_1\\|_2 = 10^3\n$$\n这是一个很大的残差。\n逆预处理器是 $M^{-1} = \\mathrm{diag}(10^{-6}, 1, \\dots, 1)$。\n$k=0$ 时的预处理残差是 $M^{-1} r_0$：\n$$\nM^{-1} r_0 = M^{-1} (10^3 e_1) = 10^3 (M^{-1} e_1) = 10^3 (10^{-6} e_1) = 10^{-3} e_1\n$$\n其欧几里得范数为：\n$$\n\\|M^{-1} r_0\\|_2 = \\|10^{-3} e_1\\|_2 = 10^{-3}\n$$\n这是一个很小的值。该情景构建正确。初始状态将满足像 $\\|M^{-1} r_k\\|_2  10^{-2}$ 这样的停止准则，导致算法立即终止并接受初始猜测 $p_0 = 0$ 作为解，尽管真实残差范数为 $10^3$。所提供的解释是准确的：$M$ 的巨大第一个条目（即大的 $\\|M\\|_2 = 10^6$）导致了强烈的重新缩放和范数之间的差异。\n\n结论：**正确**。", "answer": "$$\\boxed{AD}$$", "id": "3371613"}]}