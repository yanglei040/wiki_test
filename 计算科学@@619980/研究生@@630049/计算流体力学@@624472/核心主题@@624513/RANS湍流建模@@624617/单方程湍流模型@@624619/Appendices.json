{"hands_on_practices": [{"introduction": "要精确地模拟壁面束缚湍流，理解湍流模型在近壁区域的行为至关重要。本练习将引导你通过量纲分析，从单方程模型输运方程的基本物理项出发，推导出一个关于近壁网格分辨率的准则 [@problem_id:3350429]。通过深入剖析黏性底层中扩散项和破坏项之间的平衡，你将不仅仅是记忆一个经验法则，而是从根本上理解为何精细的近壁网格是保证模型物理真实性的先决条件。", "problem": "考虑一个光滑平板壁面上的不可压缩、零压力梯度湍流边界层，其通过一个针对修正涡黏性变量（记为 $\\tilde{\\nu}$）的单输运方程闭合模型进行建模。设分子运动黏度为 $\\nu$，法向壁面坐标为 $y$（在壁面处 $y=0$），在近壁区域，到最近壁面的距离为 $d$。摩擦速度为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，内尺度定义为 $y^{+} = y u_{\\tau}/\\nu$。在粘性子层中，假设 $y^{+} \\ll 5$ 且 $\\tilde{\\nu} \\ll \\nu$。\n\n从以下基本依据出发：\n- 在粘性子层中，$d \\approx y$。\n- 近壁平均剪切遵循 $U^{+} \\approx y^{+}$，这意味着 $S \\equiv |\\partial U/\\partial y| \\approx u_{\\tau}^{2}/\\nu$。\n- $\\tilde{\\nu}$ 输运的稳态、一维（法向壁面）平衡包括一个对 $\\tilde{\\nu}$ 线性、系数为 $c_{b1} S$ 的生成项，一个系数为 $(\\nu + \\tilde{\\nu})/\\sigma$ 的保守扩散项，以及一个与 $(\\tilde{\\nu}/d)^{2}$ 成正比、系数为 $c_{w1}$ 的非线性耗散项；此处 $c_{b1}$、$c_{w1}$ 和 $\\sigma$ 是正的、无量纲的闭合常数。\n\n仅使用适用于粘性子层（$\\tilde{\\nu} \\ll \\nu$、$d \\approx y$、稳态一维平衡、可忽略的对流）的渐近量级分析方法，完成以下任务：\n- 在位于 $y_{1}$ 的第一个离壁单元中心处，分析法向壁面网格间距如何控制扩散项和耗散项对 $\\tilde{\\nu}$ 离散平衡的相对贡献大小。\n- 确定必须解析的最严格的近壁长度尺度，以防止耗散项压倒扩散项，从而保持正确的渐近量级关系 $\\tilde{\\nu} \\ll \\nu$。\n- 基于此分析，推导出一个将第一个离壁单元中心放置在粘性子层内的、基于网格的准则。将该准则表示为最大允许的、内尺度归一化的第一单元位置 $y_{1,\\max}^{+}$ 的闭合形式，仅用模型常数表达。\n\n你的最终答案必须是 $y_{1,\\max}^{+}$ 的一个仅用 $\\sigma$ 和 $c_{b1}$ 表示的单个闭合形式解析表达式。最终答案中不要包含单位。如果你选择计算任何中间数值示例，请勿在最终答案中使用它。", "solution": "用户要求对问题陈述进行严格验证，如果问题被判定为有效，则提供完整解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **系统**：一个光滑平板壁面上的不可压缩、零压力梯度湍流边界层。\n-   **模型**：一个针对修正涡黏性 $\\tilde{\\nu}$ 的单输运方程闭合模型。\n-   **变量和坐标**：\n    -   分子运动黏度：$\\nu$。\n    -   法向壁面坐标：$y$，在壁面处 $y=0$。\n    -   到最近壁面的距离：$d$。\n    -   摩擦速度：$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$。\n    -   内尺度（壁面单位）：$y^{+} = y u_{\\tau}/\\nu$。\n-   **关注区域**：粘性子层。\n-   **粘性子层假设**：\n    -   $y^{+} \\ll 5$。\n    -   $\\tilde{\\nu} \\ll \\nu$。\n    -   $d \\approx y$。\n    -   近壁平均剪切：$S \\equiv |\\partial U/\\partial y| \\approx u_{\\tau}^{2}/\\nu$。\n-   **输运方程平衡（稳态，一维法向壁面）**：\n    1.  生成项：对 $\\tilde{\\nu}$ 线性，系数为 $c_{b1} S$。该项为 $c_{b1} S \\tilde{\\nu}$。\n    2.  扩散项：保守形式，系数为 $(\\nu + \\tilde{\\nu})/\\sigma$。该项为 $\\frac{d}{dy}\\left[ \\frac{\\nu + \\tilde{\\nu}}{\\sigma} \\frac{d\\tilde{\\nu}}{dy} \\right]$。\n    3.  耗散项：非线性，与 $(\\tilde{\\nu}/d)^{2}$ 成正比，系数为 $c_{w1}$。该项为 $-c_{w1} (\\tilde{\\nu}/d)^{2}$。\n-   **常数**：$c_{b1}$、$c_{w1}$ 和 $\\sigma$ 是正的、无量纲的闭合常数。\n-   **任务**：\n    1.  分析在第一个离壁单元中心 $y_{1}$ 处，离散的扩散项和耗散项的相对大小。\n    2.  确定最严格的近壁长度尺度，以确保耗散项不会压倒扩散项，且量级关系 $\\tilde{\\nu} \\ll \\nu$ 得以保持。\n    3.  推导最大允许 $y_{1}^{+}$（记为 $y_{1,\\max}^{+}$）的基于网格的准则，仅用 $\\sigma$ 和 $c_{b1}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题牢固地植根于计算流体力学（CFD）和湍流模型领域。所描述的模型是单方程模型的一种通用形式，其结构与 Spalart-Allmaras 模型相似，其在近壁区域的分析是 CFD 中一个标准且重要的课题。粘性子层的物理特性及相关尺度律是公认的。（有效）\n-   **适定性**：该问题设定了一个明确的任务：基于对模型方程各项的分析，推导一个网格间距准则。它提供了模型方程的所有必要组成部分和渐近背景。最终答案仅依赖于特定常数的要求为推导过程提供了强有力的约束。（有效）\n-   **客观性**：该问题以物理学和工程学中常见的精确、客观的语言陈述。它没有任何主观论断或模糊不清之处。（有效）\n\n该问题没有表现出说明中列出的任何无效性缺陷。这是一个在湍流模型领域中定义明确的理论问题。\n\n**步骤 3：结论和行动**\n\n问题是**有效**的。将提供一个完整的、有理有据的解答。\n\n### 解答\n\n该问题要求为单方程湍流模型模拟中的第一个离壁单元推导一个网格布置准则。该准则必须确保数值离散化能正确地表示粘性子层内各项的物理平衡。\n\n修正涡黏性 $\\tilde{\\nu}$ 的稳态一维输运方程由生成项（$P_{\\tilde{\\nu}}$）、扩散项（$D_{\\tilde{\\nu}}$）和耗散项（$Dest_{\\tilde{\\nu}}$）的平衡给出：\n$$ D_{\\tilde{\\nu}} + P_{\\tilde{\\nu}} + Dest_{\\tilde{\\nu}} = 0 $$\n$$ \\frac{d}{dy} \\left[ \\left(\\frac{\\nu + \\tilde{\\nu}}{\\sigma}\\right) \\frac{d\\tilde{\\nu}}{dy} \\right] + c_{b1} S \\tilde{\\nu} - c_{w1} \\left(\\frac{\\tilde{\\nu}}{d}\\right)^2 = 0 $$\n在粘性子层中，我们应用给定的假设：$d \\approx y$，$S \\approx u_{\\tau}^{2}/\\nu$ 和 $\\tilde{\\nu} \\ll \\nu$。方程简化为：\n$$ \\frac{d}{dy} \\left( \\frac{\\nu}{\\sigma} \\frac{d\\tilde{\\nu}}{dy} \\right) + c_{b1} \\frac{u_{\\tau}^{2}}{\\nu} \\tilde{\\nu} - c_{w1} \\left(\\frac{\\tilde{\\nu}}{y}\\right)^2 \\approx 0 $$\n问题的核心是分析该方程在位于 $y_1$ 的第一个单元中心处的离散形式。在典型的单元中心有限体积法中，偏微分方程的各项在此位置进行近似。我们对这些离散项的量级进行尺度分析。设第一个单元中心处的值为 $\\tilde{\\nu}_1$。\n\n1.  **生成项 ($P_1$)**：该项是局部的，可以直接在 $y_1$ 处计算。\n    $$ P_1 \\approx c_{b1} S_1 \\tilde{\\nu}_1 \\approx c_{b1} \\frac{u_{\\tau}^{2}}{\\nu} \\tilde{\\nu}_1 $$\n2.  **耗散项 ($J_1$)**：该项也是局部的。\n    $$ J_1 \\approx c_{w1} \\left(\\frac{\\tilde{\\nu}_1}{y_1}\\right)^2 $$\n3.  **扩散项 ($D_1$)**：该项表示扩散对单元的净效应。在与壁面相邻的第一个单元中（壁面处 $\\tilde{\\nu}=0$），扩散主要起到汇的作用，将 $\\tilde{\\nu}_1$ 从单元移除到壁面。代表通量散度的离散扩散算子的特征尺度可以基于在距离 $y_1$ 上的梯度来建模。到壁面的通量尺度为 $\\frac{\\nu}{\\sigma} \\frac{\\tilde{\\nu}_1}{y_1}$。该通量在单元体积（厚度约为 $y_1$）上的散度给出了此项在偏微分方程平衡中的量级。\n    $$ D_1 \\sim \\frac{1}{y_1} \\left( \\frac{\\nu}{\\sigma} \\frac{\\tilde{\\nu}_1}{y_1} \\right) = \\frac{\\nu \\tilde{\\nu}_1}{\\sigma y_1^2} $$\n    由于它起到汇的作用，其对平衡的贡献为负。\n\n粘性子层中正确的物理行为是，湍流被粘性耗散，这一过程由扩散项和耗散项的平衡主导。湍流的生成被抑制，是一个高阶效应。因此，物理上正确的各项量级关系是 $|D_1| \\approx |J_1| \\gg |P_1|$。网格准则必须在离散项上强制实施这种量级关系，以避免出现非物理的数值解。\n\n首先，我们通过假设主平衡 $|D_1| \\approx |J_1|$ 成立，来建立对 $\\tilde{\\nu}_1$ 的估计。\n$$ \\frac{\\nu \\tilde{\\nu}_1}{\\sigma y_1^2} \\approx c_{w1} \\left(\\frac{\\tilde{\\nu}_1}{y_1}\\right)^2 $$\n求解 $\\tilde{\\nu}_1$（对于 $\\tilde{\\nu}_1 \\neq 0$）：\n$$ \\frac{\\nu}{\\sigma} \\approx c_{w1} \\tilde{\\nu}_1 \\implies \\tilde{\\nu}_1 \\approx \\frac{\\nu}{\\sigma c_{w1}} $$\n这基于应占主导地位的物理平衡，为第一个单元中 $\\tilde{\\nu}$ 的量级提供了一个估计。\n\n接下来，我们施加条件，即生成项必须次于主要平衡项。我们使用扩散项进行比较，因此 $|P_1| \\lesssim |D_1|$。如果此条件被违反（即，如果 $y_1$ 太大），生成项会变得人为地过大，导致对近壁湍流的不正确预测。最大网格间距的极限情况发生在生成项的量级与扩散项的量级相当之时。\n$$ P_1 \\lesssim D_1 \\implies c_{b1} \\frac{u_{\\tau}^{2}}{\\nu} \\tilde{\\nu}_1 \\lesssim \\frac{\\nu \\tilde{\\nu}_1}{\\sigma y_1^2} $$\n$\\tilde{\\nu}_1$ 项从两侧消去，这一点至关重要，因为对其自身的估计是复杂的。\n$$ c_{b1} \\frac{u_{\\tau}^{2}}{\\nu} \\lesssim \\frac{\\nu}{\\sigma y_1^2} $$\n我们现在求解 $y_1$ 以找到对网格间距的约束。\n$$ y_1^2 \\lesssim \\frac{\\nu^2}{\\sigma c_{b1} u_{\\tau}^{2}} $$\n取平方根：\n$$ y_1 \\lesssim \\frac{\\nu}{u_{\\tau} \\sqrt{\\sigma c_{b1}}} $$\n问题要求将准则用内尺度归一化单位 $y_1^{+} = y_1 u_{\\tau}/\\nu$ 表示。我们将不等式两边乘以 $u_{\\tau}/\\nu$：\n$$ \\frac{y_1 u_{\\tau}}{\\nu} \\lesssim \\frac{\\nu}{u_{\\tau} \\sqrt{\\sigma c_{b1}}} \\frac{u_{\\tau}}{\\nu} $$\n$$ y_1^{+} \\lesssim \\frac{1}{\\sqrt{\\sigma c_{b1}}} $$\n这个不等式定义了所需的基于网格的准则。第一个单元位置的最大允许值 $y_{1,\\max}^{+}$ 对应于此条件的等式极限。该表达式仅依赖于 $\\sigma$ 和 $c_{b1}$，正如问题陈述所要求的。常数 $c_{w1}$ 通过两步尺度分析的逻辑被消除了。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{\\sigma c_{b1}}}}\n$$", "id": "3350429"}, {"introduction": "在掌握了近壁分辨率的理论基础后，下一步是将其应用于实际的计算流体力学（CFD）问题中。本练习提供了一个具体场景，要求你计算为达到目标 $y^+$ 值所需的第一个离壁网格单元的高度 [@problem_id:3350492]。这项实践不仅能巩固你的计算技能，更重要的是，它促使你思考这一网格选择对数值稳定性（刚度问题）和求解精度（如壁面剪切应力预测）之间权衡的影响。", "problem": "考虑空气流经光滑平板时形成的不可压缩湍流边界层，使用 Spalart–Allmaras (SA) 单方程湍流模型求解，不使用壁面函数（即，壁面解析，工作变量在壁面处设为零）。一个先验估计给出摩擦速度为 $u_\\tau = 0.5\\,\\mathrm{m/s}$，运动黏度为 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。使用标准的近壁区标度，确定第一个单元中心合适的壁面法向位置 $y_1$ 以实现 $y^+\\approx 1$，并选择最能描述由此对 Spalart–Allmaras 模型近壁区预测的准确性和稳定性产生影响的选项。选择唯一的最佳选项。\n\nA. $y_1 \\approx 3.0\\times 10^{-5}\\,\\mathrm{m}$。这将第一个点置于粘性子层中，能够精确捕捉壁面剪切应力和分离起始点。它会增加近壁区源项和扩散项的刚性，对于显式格式可能需要更小的时间步长，但在适当的离散化或隐式积分下仍能保持稳定。\n\nB. $y_1 \\approx 3.0\\times 10^{-4}\\,\\mathrm{m}$。这将第一个点置于缓冲层中，对于 Spalart–Allmaras 模型是最佳的，因为它在不使用壁面函数的情况下，既缓解了刚性问题，又保持了近壁区的准确性。\n\nC. $y_1 \\approx 5.5\\times 10^{-3}\\,\\mathrm{m}$。Spalart–Allmaras 模型中的近壁区阻尼使得准确性对 $y^+$ 的值不敏感，因此这样的间距是可接受的，并通过避免近壁区的刚性来提高稳定性。\n\nD. $y_1 \\approx 3.0\\times 10^{-6}\\,\\mathrm{m}$。为了获得高保真度，这个选择是必要的，因为当接近壁面时，生成项会变得奇异，但这会使求解器不稳定；因此，对于 Spalart–Allmaras 模型，应首选壁面函数。\n\nE. $y_1 \\approx 1.0\\times 10^{-3}\\,\\mathrm{m}$。当在壁面处将 $\\tilde{\\nu}$ 设置为零时，Spalart–Allmaras 模型被设计为对近壁区分辨率不敏感，因此这种间距可以在没有额外时间步长限制的情况下，产生可靠的准确性和更高的鲁棒性。", "solution": "问题陈述已经过验证，被认为是合理的。它提出了一个标准的计算流体力学 (CFD) 问题，涉及湍流边界层、Spalart–Allmaras (SA) 湍流模型和近壁区分辨率要求。所提供的物理参数是现实的，问题提得很好。\n\n问题的核心包括两个部分：首先，计算所需的近壁区网格间距；其次，分析此间距对 SA 模型的影响。\n\n**第一部分：计算第一个单元中心位置 $y_1$**\n\n无量纲壁面距离，记作 $y^+$，是壁面约束湍流中的一个关键参数。其定义为：\n$$ y^+ = \\frac{u_\\tau y}{\\nu} $$\n其中 $y$ 是到壁面的物理法向距离，$u_\\tau$ 是摩擦速度，$\\nu$ 是流体的运动黏度。\n\n问题指定该模拟是“壁面解析”的，根据 CFD 的惯例，这要求将第一个计算单元的中心放置在离壁面 $y_1$ 的位置，使其无量纲等效值 $y_1^+$ 约等于 1。这确保了第一个节点位于粘性子层内，该区域的速度剖面是线性的，可以被数值网格直接解析。\n\n给定值为：\n- 目标无量纲壁面距离：$y_1^+ \\approx 1$\n- 摩擦速度：$u_\\tau = 0.5\\,\\mathrm{m/s}$\n- 运动黏度：$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$\n\n我们可以重新排列 $y^+$ 的定义式来求解物理距离 $y_1$：\n$$ y_1 = \\frac{y_1^+ \\nu}{u_\\tau} $$\n将给定值代入此方程：\n$$ y_1 = \\frac{(1) \\times (1.5\\times 10^{-5}\\,\\mathrm{m^2/s})}{0.5\\,\\mathrm{m/s}} = 3.0 \\times 10^{-5}\\,\\mathrm{m} $$\n因此，第一个单元中心合适的壁面法向位置为 $y_1 \\approx 3.0 \\times 10^{-5}\\,\\mathrm{m}$。\n\n**第二部分：近壁区分辨率对 Spalart–Allmaras 模型的影响分析**\n\n确定了所需的网格间距后，我们现在分析它对使用 SA 模型的数值模拟的影响。\n\n1.  **准确性：** 湍流边界层的近壁区域具有不同分层的特征。粘性子层通常存在于 $y^+  5$ 的区域，是粘性剪切占主导地位的地方。通过将第一个网格点放置在 $y_1^+ \\approx 1$ 处，我们正在解析这一层。这对于精确计算壁面剪切应力 $\\tau_w = \\mu (\\partial u / \\partial y)|_{y=0}$ 至关重要，而壁面剪切应力是表面摩擦阻力的主要决定因素。$\\tau_w$ 的精确预测对于对近壁区梯度敏感的现象也至关重要，例如流动分离和传热。SA 模型的工作变量 $\\tilde{\\nu}$ 的边界条件是在壁面处 $\\tilde{\\nu}=0$，并且该模型专门用阻尼函数来构建，以便在解析粘性子层时能正确表现。\n\n2.  **数值稳定性和刚性：** SA 模型工作变量 $\\tilde{\\nu}$ 的输运方程包括生成项、耗散项和扩散项。耗散项的形式为 $-c_{w1} f_w (\\frac{\\tilde{\\nu}}{d})^2$，其中 $d$ 是到壁面的距离。当接近壁面时（$d \\to 0$），即使有阻尼函数 $f_w$ 的作用，该项也可能变得非常大。这给方程组带来了数值刚性。刚性系统具有差别悬殊的时间尺度，对于显式时间积分格式，稳定性极限由最快的时间尺度决定。因此，解析近壁区（即具有非常小的 $d$）会迫使使用非常小的时间步长来维持稳定性，从而显著增加计算成本。这种刚性可以通过适当的数值技术有效管理，例如使用全隐式或半隐式时间积分格式，这些格式不受与显式格式相同的严格稳定性约束。\n\n因此，将第一个网格点放置在 $y_1^+ \\approx 1$ 处是一种标准的权衡：这对于壁面解析模拟的高精度是必要的，但会引入数值刚性，必须由求解器妥善处理。\n\n**选项评估**\n\nA. **$y_1 \\approx 3.0\\times 10^{-5}\\,\\mathrm{m}$。这将第一个点置于粘性子层中，能够精确捕捉壁面剪切应力和分离起始点。它会增加近壁区源项和扩散项的刚性，对于显式格式可能需要更小的时间步长，但在适当的离散化或隐式积分下仍能保持稳定。**\n- $y_1$ 的计算值是正确的。\n- 将点放置在 $y_1^+ \\approx 1$ 处确实是在粘性子层中（$y^+  5$）。\n- 对准确性的好处（壁面剪切应力、分离）陈述正确。\n- 关于数值刚性增加的问题及其对时间步长（特别是对于显式格式）的影响和解决方法（隐式积分）的描述都是正确和准确的。\n- **结论：正确。**\n\nB. **$y_1 \\approx 3.0\\times 10^{-4}\\,\\mathrm{m}$。这将第一个点置于缓冲层中，对于 Spalart–Allmaras 模型是最佳的，因为它在不使用壁面函数的情况下，既缓解了刚性问题，又保持了近壁区的准确性。**\n- $y_1$ 的值不正确。该值对应于 $y_1^+ = \\frac{(0.5)(3.0\\times 10^{-4})}{1.5\\times 10^{-5}} = 10$，这位于缓冲层中。\n- 声称这在“不使用壁面函数的情况下保持近壁区精度”是“最优”的说法是错误的。不使用壁面函数的模拟需要解析粘性子层（$y_1^+ \\approx 1$）。将第一个节点放在 $y_1^+ = 10$ 处无法做到这一点，并且会导致壁面剪切应力的结果不准确。\n- **结论：不正确。**\n\nC. **$y_1 \\approx 5.5\\times 10^{-3}\\,\\mathrm{m}$。Spalart–Allmaras 模型中的近壁区阻尼使得准确性对 $y^+$ 的值不敏感，因此这样的间距是可接受的，并通过避免近壁区的刚性来提高稳定性。**\n- $y_1$ 的值不正确。该值对应于 $y_1^+ \\approx 183$，这位于对数律区。\n- 对于壁面解析模拟，声称 SA 模型的准确性“对 $y^+$ 的值不敏感”是根本错误的。$y_1^+ \\approx 1$ 这一指导原则的全部目的正是因为该模型对近壁区分辨率的敏感性。如此粗糙的网格将强制要求使用壁面函数。\n- **结论：不正确。**\n\nD. **$y_1 \\approx 3.0\\times 10^{-6}\\,\\mathrm{m}$。为了获得高保真度，这个选择是必要的，因为当接近壁面时，生成项会变得奇异，但这会使求解器不稳定；因此，对于 Spalart–Allmaras 模型，应首选壁面函数。**\n- $y_1$ 的值不正确。该值对应于 $y_1^+ = 0.1$。虽然不完全错误，但 $y_1^+ \\approx 1$ 是标准目标。\n- 声称生成项“变得奇异”是错误的。SA 的生成项 $c_{b1} \\tilde{S} \\tilde{\\nu}$ 在壁面处趋于零，因为 $\\tilde{\\nu} \\to 0$。是耗散项的一部分包含一个与距离相关的潜在奇异性，而不是生成项。\n- “应首选壁面函数”的结论是一种过度简化；SA 模型是专门为积分到壁面而设计的。\n- **结论：不正确。**\n\nE. **$y_1 \\approx 1.0\\times 10^{-3}\\,\\mathrm{m}$。当在壁面处将 $\\tilde{\\nu}$ 设置为零时，Spalart–Allmaras 模型被设计为对近壁区分辨率不敏感，因此这种间距可以在没有额外时间步长限制的情况下，产生可靠的准确性和更高的鲁棒性。**\n- $y_1$ 的值不正确。该值对应于 $y_1^+ \\approx 33$，将节点置于对数律区。\n- 与选项 C 一样，声称该模型“对近壁区分辨率不敏感”是错误的。一个第一个节点在 $y_1^+ \\approx 33$ 的壁面解析模拟不会产生“可靠的准确性”。\n- **结论：不正确。**\n\n基于详细分析，选项 A 是唯一一个既给出了正确计算，又提供了物理上和数值上都合理的解释的选项。", "answer": "$$\\boxed{A}$$", "id": "3350492"}, {"introduction": "当计算资源有限，无法承担解析黏性底层所需的极细密网格时，壁面函数（wall functions）便成为一种高效且实用的替代方案。本练习将通过一个编程任务，指导你为Spalart-Allmaras模型构建一个壁面函数耦合方案 [@problem_id:3350457]。你需要推导在粗糙网格的第一个节点上施加滑移速度和湍流工作变量边界条件所需的公式，从而将理论上的壁面律转化为可执行的数值边界条件，这是连接理论与工程应用的关键一步。", "problem": "您的任务是为附着在光滑平板上的、零压力梯度湍流边界层中的 Spalart–Allmaras 单方程湍流模型在粗网格上构建一个计算壁面函数耦合。目标是在第一个离壁位置为 Spalart–Allmaras 模型施加滑移速度和工作变量的边界条件，从而使得对于无量纲壁面距离 $y^+ \\approx 30$ 的点，内层到外层的应力平衡得到满足，同时对于更小和更大的 $y^+$ 值保持鲁棒。您的程序必须为一组给定的测试案例计算第一个离壁点处的滑移壁面速度和工作变量的边界条件。\n\n从以下基本原理和标准定义开始：\n- 平均壁面切应力定义为 $\\tau_w = \\rho u_\\tau^2$，其中 $\\rho$ 是质量密度，$u_\\tau$ 是摩擦速度。\n- 在平衡、零压力梯度的湍流边界层的近壁区域，总切应力近似恒定，由 $\\tau = \\rho \\left( \\nu + \\nu_t \\right) \\dfrac{dU}{dy}$ 给出，其中 $\\nu$ 是运动黏度，$\\nu_t$ 是湍流运动黏度，$U(y)$ 是平行于壁面的平均速度，$y$ 是壁面法向距离。\n- 对于光滑表面上的壁面律：\n  - 在粘性子层中，对于 $y^+ \\le y^+_{crit}$，使用 $U^+ = y^+$，这意味着 $\\dfrac{dU}{dy} = \\dfrac{u_\\tau^2}{\\nu}$。\n  - 在对数律层中，对于 $y^+  y^+_{crit}$，使用 $U^+ = \\dfrac{1}{\\kappa} \\ln y^+ + B$，这意味着 $\\dfrac{dU}{dy} = \\dfrac{u_\\tau}{\\kappa y}$。\n  此处 $U^+ = \\dfrac{U}{u_\\tau}$，$y^+ = \\dfrac{u_\\tau y}{\\nu}$，$\\kappa$ 是 von Kármán 常数，$B$ 是一个加法常数，$y^+_{crit}$ 是粘性区域和对数区域之间的阈值。使用 $\\kappa = 0.41$，$B = 5.2$ 和 $y^+_{crit} = 11.81$。\n- 在 Spalart–Allmaras 模型中，湍流运动黏度通过 $\\nu_t = \\tilde{\\nu} \\, f_{v1}$ 与工作变量相关，其中 $f_{v1} = \\dfrac{\\chi^3}{\\chi^3 + C_{v1}^3}$ 且 $\\chi = \\dfrac{\\tilde{\\nu}}{\\nu}$。使用 $C_{v1} = 7.1$。强制施加正值约束 $\\nu_t \\ge 0$ 和 $\\tilde{\\nu} \\ge 0$。\n\n从这些基础出发，通过强制 $\\tau = \\tau_w$ 并结合适当的近壁梯度公式，推导第一个离壁位置 $y = y_p$ 处的湍流运动黏度 $\\nu_t$ 的表达式。然后，在 $y = 0$ 处施加一个滑移壁面值 $U_w$，使得在壁面处的 $U_w$ 和 $y = y_p$ 处的 $U_p$ 之间的线性剖面能产生目标应力，其中 $U_p$ 是使用如上所述的 $u_\\tau$ 和 $y_p$ 从壁面律获得的。最后，反演 Spalart–Allmaras 关系，从 $\\nu_t$ 和 $\\nu$ 计算 $y = y_p$ 处的工作变量 $\\tilde{\\nu}$。\n\n您的程序必须为每个测试案例计算并返回：\n- 滑移壁面速度 $U_w$，单位为 m/s。\n- 在 $y_p$ 处的工作变量值 $\\tilde{\\nu}$，单位为 $\\text{m}^2/\\text{s}$。\n- 一个无量纲相对应力误差，定义为 $\\left|\\dfrac{\\tau_{calc} - \\tau_w}{\\tau_w}\\right|$，其中 $\\tau_{calc} = \\rho \\left( \\nu + \\nu_t \\right) \\dfrac{U_p - U_w}{y_p}$ 是由线性剖面和您计算的量所隐含的应力。此值必须为非负实数。\n\n所有报告的速度必须以 m/s 表示，所有运动黏度以 $\\text{m}^2/\\text{s}$ 表示。相对应力误差必须是十进制数。所有输出必须四舍五入到六位小数。\n\n使用以下参数集测试套件。每个参数集是一个元组 $(\\rho, \\nu, u_\\tau, y_p, \\kappa, B, C_{v1}, y^+_{crit})$，单位如上指定：\n- 案例 1 (类空气，目标 $y^+ \\approx 30$)：$(1.225,\\ 1.5\\times 10^{-5},\\ 0.5,\\ y_p,\\ 0.41,\\ 5.2,\\ 7.1,\\ 11.81)$，其中 $y_p = \\dfrac{30 \\times 1.5 \\times 10^{-5}}{0.5}$ 米。\n- 案例 2 (类空气，子层 $y^+ \\approx 2$)：$(1.225,\\ 1.5\\times 10^{-5},\\ 0.5,\\ y_p,\\ 0.41,\\ 5.2,\\ 7.1,\\ 11.81)$，其中 $y_p = \\dfrac{2 \\times 1.5 \\times 10^{-5}}{0.5}$ 米。\n- 案例 3 (类空气，外对数层 $y^+ \\approx 200$)：$(1.225,\\ 1.5\\times 10^{-5},\\ 0.5,\\ y_p,\\ 0.41,\\ 5.2,\\ 7.1,\\ 11.81)$，其中 $y_p = \\dfrac{200 \\times 1.5 \\times 10^{-5}}{0.5}$ 米。\n- 案例 4 (类水，目标 $y^+ \\approx 30$)：$(997.0,\\ 1.0\\times 10^{-6},\\ 1.2,\\ y_p,\\ 0.41,\\ 5.2,\\ 7.1,\\ 11.81)$，其中 $y_p = \\dfrac{30 \\times 1.0 \\times 10^{-6}}{1.2}$ 米。\n\n实现要求：\n- 对于每个案例，使用上述指定的分段壁面律计算 $U_p$。然后强制 $\\tau = \\tau_w$ 以确定 $\\nu_t(y_p)$，并计算滑移壁面速度 $U_w$，使得在 $U_w$ 和 $U_p$ 之间跨越 $y_p$ 的线性剖面下能产生正确的应力。\n- 反演函数 $\\nu_t = \\tilde{\\nu} \\, f_{v1}\\!\\left(\\dfrac{\\tilde{\\nu}}{\\nu}\\right)$ 以从已知的 $\\nu_t$ 和 $\\nu$ 中获得 $\\tilde{\\nu}$。您可以使用保证 $\\tilde{\\nu} \\ge 0$ 的鲁棒的数值反演方法。\n- 强制施加正值约束 $\\nu_t \\ge 0$ 和 $\\tilde{\\nu} \\ge 0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个列表的列表，其中每个内部列表对应一个测试案例，并按顺序包含三个四舍五入后的值 $[U_w,\\ \\tilde{\\nu},\\ \\text{relative\\_stress\\_error}]$。\n- 该行必须精确格式化为用方括号括起来的逗号分隔列表，每个内部列表也用方括号括起来，例如：[[a,b,c],[d,e,f],...]，所有数字都四舍五入到六位小数，且无额外文本。", "solution": "该问题提法恰当，科学上基于计算流体动力学和湍流模拟的既定原则。它提供了一套完整的方程、常数和数据，用于推导 Spalart-Allmaras 模型的壁面函数，并将其应用于一系列测试案例。所有必需的参数都已指定，推导路径在逻辑上是合理的。因此，该问题被认为是有效的。\n\n求解过程首先针对由参数集 $(\\rho, \\nu, u_\\tau, y_p, \\kappa, B, C_{v1}, y^+_{crit})$ 指定的任意测试案例推导所需量。下标 $_p$ 表示位于离壁面距离为 $y_p$ 的第一个离壁网格点上的值。\n\n**1. 初步计算**\n第一个网格点的壁面法向距离 $y_p$ 是根据目标无量纲壁面距离 $y^+_{target}$，使用定义 $y^+ = \\dfrac{u_\\tau y}{\\nu}$ 确定的。\n$$ y_p = \\frac{y^+_{target} \\nu}{u_\\tau} $$\n此点的实际无量纲壁面距离是 $y_p^+ = \\dfrac{u_\\tau y_p}{\\nu}$。根据构造，$y_p^+ = y^+_{target}$。\n\n**2. $y_p$ 处的平均速度**\n平行于壁面的平均速度 $U_p = U(y_p)$ 使用壁面律计算，该定律以分段形式给出。公式的选择取决于 $y_p^+$ 是在粘性子层还是在对数律层，过渡发生在 $y^+_{crit}$。\n\n如果 $y_p^+ \\le y^+_{crit}$ (粘性子层)：\n$$ U_p^+ = y_p^+ \\implies U_p = u_\\tau y_p^+ = u_\\tau \\frac{u_\\tau y_p}{\\nu} = \\frac{u_\\tau^2 y_p}{\\nu} $$\n\n如果 $y_p^+  y^+_{crit}$ (对数律层)：\n$$ U_p^+ = \\frac{1}{\\kappa} \\ln(y_p^+) + B \\implies U_p = u_\\tau \\left( \\frac{1}{\\kappa} \\ln(y_p^+) + B \\right) $$\n\n**3. $y_p$ 处的湍流运动黏度 $\\nu_t$**\n湍流黏度 $\\nu_t(y_p)$ 是通过强制施加 $y_p$ 处的总切应力等于壁面切应力的条件来确定的，即 $\\tau = \\tau_w$。\n$$ \\tau = \\rho (\\nu + \\nu_t) \\frac{dU}{dy} \\quad \\text{和} \\quad \\tau_w = \\rho u_\\tau^2 $$\n在 $y=y_p$ 处设置 $\\tau = \\tau_w$ 得：\n$$ \\rho (\\nu + \\nu_t(y_p)) \\left. \\frac{dU}{dy} \\right|_{y_p} = \\rho u_\\tau^2 \\implies \\nu_t(y_p) = \\frac{u_\\tau^2}{\\left. \\frac{dU}{dy} \\right|_{y_p}} - \\nu $$\n速度梯度 $\\left. \\frac{dU}{dy} \\right|_{y_p}$ 也从壁面律获得。\n\n如果 $y_p^+ \\le y^+_{crit}$：\n$$ \\frac{dU}{dy} = \\frac{d}{dy}(u_\\tau y^+) = \\frac{d}{dy}\\left(\\frac{u_\\tau^2 y}{\\nu}\\right) = \\frac{u_ \\tau^2}{\\nu} $$\n将此代入 $\\nu_t(y_p)$ 的表达式：\n$$ \\nu_t(y_p) = \\frac{u_\\tau^2}{u_\\tau^2/\\nu} - \\nu = \\nu - \\nu = 0 $$\n这与粘性子层的物理特性一致，在该层中湍流效应可以忽略不计。\n\n如果 $y_p^+  y^+_{crit}$：\n$$ \\frac{dU}{dy} = \\frac{d}{dy}\\left(u_\\tau \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{u_\\tau y}{\\nu}\\right) + B\\right)\\right) = u_\\tau \\frac{1}{\\kappa} \\frac{1}{y} = \\frac{u_\\tau}{\\kappa y} $$\n在 $y=y_p$ 处，梯度为 $\\frac{u_\\tau}{\\kappa y_p}$。代入此值：\n$$ \\nu_t(y_p) = \\frac{u_\\tau^2}{u_\\tau / (\\kappa y_p)} - \\nu = \\kappa u_\\tau y_p - \\nu $$\n强制施加正值约束 $\\nu_t(y_p) \\ge 0$。对于 $y_p^+  y^+_{crit} = 11.81$ 和 $\\kappa = 0.41$，我们有 $\\kappa y_p^+ = \\kappa u_\\tau y_p / \\nu  0.41 \\times 11.81 \\approx 4.84$，这意味着 $\\kappa u_\\tau y_p  4.84 \\nu$，所以 $\\kappa u_\\tau y_p - \\nu  0$。对于这些参数，在对数律层区域内正值约束自然得到满足。\n\n**4. 滑移壁面速度 $U_w$**\n在壁面（$y=0$）处施加一个滑移速度 $U_w$，使得在 $(y=0, U=U_w)$ 和 $(y=y_p, U=U_p)$ 之间的线性速度剖面能够产生正确的壁面切应力 $\\tau_w$。这个线性剖面的梯度是 $\\frac{U_p - U_w}{y_p}$。\n$$ \\tau_w = \\rho (\\nu + \\nu_t(y_p)) \\frac{U_p - U_w}{y_p} $$\n由于 $\\tau_w = \\rho u_\\tau^2$，我们可以解出 $U_w$：\n$$ u_\\tau^2 = (\\nu + \\nu_t(y_p)) \\frac{U_p - U_w}{y_p} \\implies U_w = U_p - \\frac{u_\\tau^2 y_p}{\\nu + \\nu_t(y_p)} $$\n\n**5. $y_p$ 处的 Spalart-Allmaras 工作变量 $\\tilde{\\nu}$**\n工作变量 $\\tilde{\\nu}$ 是通过反演 Spalart-Allmaras 的湍流黏度关系 $\\nu_t = \\tilde{\\nu} f_{v1}$ 来计算的。\n$$ \\nu_t = \\tilde{\\nu} \\frac{\\chi^3}{\\chi^3 + C_{v1}^3}, \\quad \\text{其中} \\quad \\chi = \\frac{\\tilde{\\nu}}{\\nu} $$\n代入 $\\tilde{\\nu} = \\chi \\nu$：\n$$ \\frac{\\nu_t}{\\nu} = \\frac{\\chi^4}{\\chi^3 + C_{v1}^3} $$\n令 $k = \\nu_t/\\nu$，这可以重新整理成一个关于 $\\chi$ 的四次多项式方程：\n$$ \\chi^4 - k\\chi^3 - k C_{v1}^3 = 0 $$\n如果 $\\nu_t=0$，则 $k=0$ 且 $\\chi=0$，这意味着 $\\tilde{\\nu}=0$。\n如果 $\\nu_t0$，我们必须找到该方程唯一的非负实根。设 $f(\\chi) = \\chi^4 - k\\chi^3 - k C_{v1}^3$。\n- $f(0) = -k C_{v1}^3  0$。\n- 当 $\\chi \\to \\infty$ 时，$f(\\chi) \\to \\infty$。\n- 导数为 $f'(\\chi) = 4\\chi^3 - 3k\\chi^2 = \\chi^2(4\\chi-3k)$。\n该函数在 $\\chi = 3k/4$ 处有局部最小值，其函数值为负。由于 $f(0)  0$ 且函数在 $\\chi > 3k/4$ 时递增，因此存在唯一的正实根。这个根可以使用诸如 Brent-Dekker 方法之类的鲁棒算法进行数值求解。一旦找到根 $\\chi_{root}$，工作变量就计算为 $\\tilde{\\nu} = \\chi_{root} \\nu$。\n\n**6. 相对应力误差**\n相对应力误差定义为 $\\left|\\dfrac{\\tau_{calc} - \\tau_w}{\\tau_w}\\right|$，其中 $\\tau_{calc}$ 是使用计算值通过线性剖面近似得到的应力：\n$$ \\tau_{calc} = \\rho (\\nu + \\nu_t(y_p)) \\frac{U_p - U_w}{y_p} $$\n代入第 4 步中 $U_w$ 的表达式：\n$$ \\tau_{calc} = \\rho (\\nu + \\nu_t(y_p)) \\frac{1}{y_p} \\left( U_p - \\left( U_p - \\frac{u_\\tau^2 y_p}{\\nu + \\nu_t(y_p)} \\right) \\right) = \\rho (\\nu + \\nu_t(y_p)) \\frac{1}{y_p} \\left( \\frac{u_\\tau^2 y_p}{\\nu + \\nu_t(y_p)} \\right) = \\rho u_\\tau^2 = \\tau_w $$\n根据构造，$\\tau_{calc}$ 与 $\\tau_w$ 相同。因此，相对应力误差必须为零，除非存在浮点计算误差。这个误差的数值计算可作为对实现的一致性检查。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes slip velocity, SA working variable, and stress error for wall-function coupling.\n    \"\"\"\n    # Each parameter set is a tuple:\n    # (rho, nu, u_tau, target_y_plus, kappa, B, C_v1, y_p_crit)\n    test_cases = [\n        (1.225, 1.5e-5, 0.5, 30.0, 0.41, 5.2, 7.1, 11.81),  # Case 1\n        (1.225, 1.5e-5, 0.5, 2.0, 0.41, 5.2, 7.1, 11.81),   # Case 2\n        (1.225, 1.5e-5, 0.5, 200.0, 0.41, 5.2, 7.1, 11.81), # Case 3\n        (997.0, 1.0e-6, 1.2, 30.0, 0.41, 5.2, 7.1, 11.81),  # Case 4\n    ]\n\n    all_results = []\n    for case in test_cases:\n        rho, nu, u_tau, target_y_plus, kappa, B, C_v1, y_crit_plus = case\n\n        # 1. Calculate y_p, the first off-wall point distance\n        y_p = target_y_plus * nu / u_tau\n        \n        # By construction, y_p_plus is equal to target_y_plus\n        y_p_plus = u_tau * y_p / nu\n\n        # 2. Compute mean velocity U_p at y_p from the law of the wall\n        if y_p_plus = y_crit_plus:\n            # Viscous sublayer\n            U_p_plus = y_p_plus\n        else:\n            # Logarithmic layer\n            U_p_plus = (1.0 / kappa) * np.log(y_p_plus) + B\n        U_p = U_p_plus * u_tau\n\n        # 3. Compute turbulent viscosity nu_t at y_p\n        if y_p_plus = y_crit_plus:\n            # Viscous sublayer: turbulent viscosity is zero\n            nu_t = 0.0\n        else:\n            # Logarithmic layer\n            nu_t_candidate = kappa * u_tau * y_p - nu\n            nu_t = max(0.0, nu_t_candidate)\n\n        # 4. Compute slip wall velocity U_w\n        denominator_Uw = nu + nu_t\n        U_w = U_p - (u_tau**2 * y_p) / denominator_Uw\n\n        # 5. Compute Spalart-Allmaras working variable nu_tilde at y_p\n        if nu_t = 1e-15: # Effectively zero\n            nu_tilde = 0.0\n        else:\n            k = nu_t / nu\n            C_v1_cubed = C_v1**3\n            \n            # Define the quartic function for chi = nu_tilde / nu\n            def f_chi(chi):\n                return chi**4 - k * chi**3 - k * C_v1_cubed\n\n            # Find the unique positive root using a robust numerical solver\n            # The root is guaranteed to exist and be unique for chi  0.\n            # A bracket [0, k + 1000] is safe for the expected range of k.\n            sol = root_scalar(f_chi, bracket=[0, k + 1000], method='brentq')\n            chi_root = sol.root\n            nu_tilde = chi_root * nu\n\n        # 6. Compute dimensionless relative stress error\n        tau_w = rho * u_tau**2\n        if y_p  0:\n            grad_U_linear = (U_p - U_w) / y_p\n            tau_calc = rho * (nu + nu_t) * grad_U_linear\n        else: # Should not happen with given inputs\n            tau_calc = 0.0\n\n        if tau_w  1e-15:\n            relative_stress_error = abs((tau_calc - tau_w) / tau_w)\n        else: # Handle case of zero wall stress\n            relative_stress_error = 0.0\n\n        all_results.append([U_w, nu_tilde, relative_stress_error])\n\n    # Format the final output string as specified\n    formatted_cases = []\n    for case_results in all_results:\n        formatted_values = [f\"{val:.6f}\" for val in case_results]\n        formatted_cases.append(f\"[{','.join(formatted_values)}]\")\n    \n    # Print the final result in a single line\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```", "id": "3350457"}]}