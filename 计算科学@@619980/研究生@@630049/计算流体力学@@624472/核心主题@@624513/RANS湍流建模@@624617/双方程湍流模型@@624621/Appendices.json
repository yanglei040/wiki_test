{"hands_on_practices": [{"introduction": "准确捕捉壁面湍流是计算流体力学中的核心挑战之一。本练习将指导你计算无量纲壁面距离 $y^+$，并根据其数值决定采用壁面函数还是直接解析近壁区的低雷诺数模型，这是任何壁面束缚流动模拟成功的关键第一步。[@problem_id:3385404]", "problem": "将要进行一项计算流体动力学（CFD）中的雷诺平均纳维-斯托克斯（RANS）模拟，用于模拟流经光滑平板的湍流、外部不可压缩流动。近壁区解析计划使用一个双方程湍流模型。测得壁面摩擦速度为 $u_{\\tau} = 0.42\\,\\mathrm{m/s}$，从壁面到第一个单元中心的距离为 $\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$，流体的运动粘度为 $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$。\n\n从壁面摩擦速度的定义和壁湍流内尺度律中使用的粘性长度尺度出发，推导第一个单元的无量纲壁面距离 $y^{+}$ 并计算其值。然后，基于内层结构（粘性子层、缓冲层和对数区）的物理原理以及双方程湍流模型（例如带壁面函数的高雷诺数 $k$–$\\epsilon$ 模型及其低雷诺数变体，或积分到壁面的剪切应力输运（SST）$k$–$\\omega$ 模型）的近壁面建模理念，判断对于给定的网格应使用壁面函数还是低雷诺数公式，并为这些处理方法之间的阈值选择提供理由。\n\n将最终答案表示为一个包含两个元素的行矩阵：\n- 计算出的 $y^{+}$ 值，四舍五入到三位有效数字，以及\n- 一个指示符 $I$，其中 $I = 1$ 表示应使用壁面函数，$I = 0$ 表示应使用低雷诺数公式。\n\n所有输入值均采用国际单位制（SI），$y^{+}$ 和 $I$ 为无量纲量。无需其他输出。", "solution": "首先对问题进行验证，以确保其科学性、适定性和客观性。\n\n### 步骤 1：提取已知条件\n问题陈述中提供了以下数据：\n- 壁面摩擦速度：$u_{\\tau} = 0.42\\,\\mathrm{m/s}$\n- 从壁面到第一个单元中心的距离：$\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$\n- 流体的运动粘度：$\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- 流动为流经光滑平板的湍流、外部不可压缩流动。\n- 将使用一个双方程湍流模型。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学性：** 该问题使用了计算流体动力学（CFD）和湍流模型中的标准概念，特别是雷诺平均纳维-斯托克斯（RANS）方程。壁面摩擦速度（$u_{\\tau}$）、无量纲壁面距离（$y^{+}$）、壁面函数和低雷诺数模型的定义是该领域的基本原理。给定的数值对于标准条件下的空气流动是物理上现实的。\n2.  **适定性：** 问题定义清晰。它要求计算一个特定的无量纲参数 $y^{+}$，并基于CFD实践中公认的标准做出后续决策。所提供的信息充分且一致，能够得出一个唯一且有意义的解。\n3.  **客观性：** 语言技术性强且精确，没有任何主观或模棱两可的陈述。\n4.  **完整性与一致性：** 问题是自洽的，为所需的计算和推理提供了所有必要的数据。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的，因为它是科学的、适定的和完整的。将提供完整解答。\n\n### 解答推导\n\n该问题要求一个两部分的答案：计算无量纲壁面距离 $y^{+}$，以及决定适当的近壁面建模策略。\n\n**第 1 部分：$y^{+}$ 的推导与计算**\n\n湍流边界层的近壁区域由壁面剪切应力 $\\tau_w$、流体密度 $\\rho$ 和流体运动粘度 $\\nu$ 导出的尺度来表征。\n\n壁面摩擦速度 $u_{\\tau}$ 被定义为速度尺度，由下式给出：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n虽然没有直接给出 $\\tau_w$ 和 $\\rho$，但提供了 $u_{\\tau}$，因此这个定义可作为概念上的起点。\n\n近壁区域的特征长度尺度是粘性长度尺度 $\\delta_{\\nu}$。其定义为：\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}\n$$\n该尺度代表粘性效应占主导地位的近似厚度。\n\n无量纲壁面距离，记为 $y^{+}$，是距壁面的法向距离 $y$ 被这个粘性长度尺度无量纲化的结果：\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}}\n$$\n将 $\\delta_{\\nu}$ 的定义代入 $y^{+}$ 的表达式，得到直接计算的公式：\n$$\ny^{+} = \\frac{y \\cdot u_{\\tau}}{\\nu}\n$$\n在CFD网格的背景下，相关的距离 $y$ 是从壁面到第一个计算单元中心的距离，即给定的 $\\Delta y$。因此，第一个单元的 $y^{+}$ 为：\n$$\ny^{+} = \\frac{\\Delta y \\cdot u_{\\tau}}{\\nu}\n$$\n现在，我们将给定值代入此方程：\n- $u_{\\tau} = 0.42\\,\\mathrm{m/s}$\n- $\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$\n- $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n\n$$\ny^{+} = \\frac{(5.0 \\times 10^{-5}\\,\\mathrm{m}) \\cdot (0.42\\,\\mathrm{m/s})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}}\n$$\n正如对无量纲量的预期，单位被消去：$(\\mathrm{m} \\cdot \\mathrm{m/s}) / (\\mathrm{m^2/s}) = \\mathrm{m^2/s} / \\mathrm{m^2/s}$。\n$$\ny^{+} = \\frac{5.0 \\times 0.42}{1.5} = \\frac{2.1}{1.5} = \\frac{21}{15} = \\frac{7}{5} = 1.4\n$$\n问题要求结果四舍五入到三位有效数字，所以值为 $1.40$。\n\n**第 2 部分：近壁面处理方法的论证**\n\n使用壁面函数还是低雷诺数公式（即，将模型方程积分到壁面）的选择，关键取决于第一个单元中心的 $y^{+}$ 值。这是因为这两种方法是基于对湍流边界层内层不同部分的建模。内层根据 $y^{+}$ 大致分为：\n1.  **粘性子层 ($y^{+} \\lesssim 5$):** 粘性剪切应力占主导地位。无量纲速度剖面是线性的，$u^{+} = y^{+}$，其中 $u^{+} = u/u_{\\tau}$。\n2.  **缓冲层 ($5 \\lesssim y^{+} \\lesssim 30$):** 粘性应力和湍流（雷诺）应力都很重要。这个区域很复杂，起着过渡作用。\n3.  **对数区 ($y^{+} \\gtrsim 30$):** 湍流剪切应力占主导地位。速度剖面遵循对数律，$u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$，其中 $\\kappa \\approx 0.41$ 是冯·卡门（von Kármán）常数，对于光滑壁面 $C \\approx 5.2$。\n\n相应的CFD建模策略是：\n- **低雷诺数公式（或壁面解析模型，如 SST $k$-$\\omega$）：** 这些模型被设计为在整个内层（包括粘性子层）中都有效。它们解析近壁面的陡峭梯度。为了使这些模型准确，网格必须非常精细，将第一个单元的中心置于粘性子层的深处。普遍接受的标准是 $y^{+} \\approx 1$。\n- **壁面函数（与高雷诺数模型如标准 $k$-$\\epsilon$ 模型一起使用）：** 这种方法避免了解析粘性子层和缓冲层。它假设第一个单元位于对数区。壁面函数使用对数律来“桥接”第一个单元中心和壁面之间的区域，为平均流和湍流方程提供边界条件。这要求第一个单元中心位于 $y^{+} > 30$。强烈不建议将第一个单元放置在缓冲区域（$5 \\lesssim y^{+} \\lesssim 30$），因为线性剖面和对数律在此区域均不成立，会导致显著的建模误差。\n\n在本问题中，计算出的第一个单元的无量纲壁面距离为 $y^{+} = 1.40$。该值正好落在粘性子层内（$1.40  5$）。因此，这种网格分辨率适用于将边界层一直解析到壁面的低雷诺数公式。它完全不适用于需要 $y^{+} > 30$ 的壁面函数方法。\n\n因此，应使用低雷诺数公式。对于此选择，指示符 $I$ 定义为 $I=0$。\n\n最终答案由计算值 $y^{+} = 1.40$ 和指示符 $I=0$ 组成。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.40  0 \\end{pmatrix}}\n$$", "id": "3385404"}, {"introduction": "正确的边界条件是获得可靠模拟结果的基石。在实际工程问题中，我们通常拥有的是湍流强度和湍流尺度等物理量，而计算时需要将其转化为湍流模型中的变量（如 $k$, $\\varepsilon$, 或 $\\omega$）。本练习将带你完成这一转化过程，并进一步探讨下游流动对入口湍流尺度选择的敏感性，这对于评估模拟的不确定性至关重要。[@problem_id:3385389]", "problem": "考虑在恒定横截面的直管道中，使用包含两方程湍流闭合模型的雷诺平均纳维-斯托克斯 (RANS) 方程所模拟的稳态、不可压缩、高雷诺数柱塞流。在入口处，平均速度为 $U = 20\\,\\mathrm{m/s}$，湍流强度为 $I = 0.05$（定义为均方根速度脉动与平均速度之比），积分长度尺度为 $L = 0.03\\,\\mathrm{m}$。假设标准涡粘性系数为 $C_{\\mu} = 0.09$，且入口湍流近似为均匀各向同性。\n\n任务：\n- 从湍流强度 $I$ 的定义和湍动能的各向同性关系出发，推导入口湍动能 $k(0)$ 的表达式，并计算其数值，单位为 $\\mathrm{m^2/s^2}$。\n- 使用与涡粘性闭合模型一致的高雷诺数标度来描述耗散率，推导入口耗散率 $\\varepsilon(0)$ 的表达式，并计算其数值，单位为 $\\mathrm{m^2/s^3}$。\n- 为使 $k\\text{–}\\omega$ 模型与 $k\\text{–}\\varepsilon$ 模型在入口处的涡粘性一致地初始化，推导入口比耗散率 $\\omega(0)$ 的表达式，并计算其数值，单位为 $\\mathrm{s^{-1}}$。\n- 在入口下游，忽略前 $x^{\\ast} = 2\\,\\mathrm{m}$ 距离内的平均剪切产生项，并仅通过平流和耗散来模拟湍动能的演化。从忽略产生项的 $k$ 的 RANS 输运方程出发，推导 $k(x)$ 关于 $U$、$L$、$C_{\\mu}$ 和 $k(0)$ 的闭式表达式。然后，使用涡粘性闭合模型消去 $\\varepsilon(x)$，得到涡粘性 $\\nu_{t}(x)$ 的闭式表达式。\n- 定义下游涡粘性对入口长度尺度的无量纲对数敏感度为 $S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$。推导 $S_{\\nu}(L;x^{\\ast})$ 的解析表达式，并计算其在 $x^{\\ast} = 2\\,\\mathrm{m}$ 处的数值。\n\n将最终敏感度 $S_{\\nu}(L;x^{\\ast})$ 四舍五入到四位有效数字。将最终敏感度表示为无量纲数。", "solution": "首先对问题进行验证，确保其科学合理、适定且客观。\n\n### 第 1 步：提取已知条件\n- 流动类型：稳态、不可压缩、高雷诺数柱塞流。\n- 几何形状：恒定横截面的直管道。\n- 湍流模型：雷诺平均纳维-斯托克斯 (RANS) 与两方程闭合模型。\n- 入口平均速度：$U = 20\\,\\mathrm{m/s}$。\n- 入口湍流强度：$I = 0.05$。\n- 入口积分长度尺度：$L = 0.03\\,\\mathrm{m}$。\n- 涡粘性系数：$C_{\\mu} = 0.09$。\n- 入口湍流特性：近似均匀各向同性。\n- 下游分析距离：$x^{\\ast} = 2\\,\\mathrm{m}$。\n- 对数敏感度定义：$S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$。\n- 下游演化简化：在前 $x^{\\ast} = 2\\,\\mathrm{m}$ 距离内忽略平均剪切产生项和扩散项，仅考虑平流和耗散。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述具有科学依据，使用了计算流体力学和湍流模拟领域的标准概念和术语（例如，RANS、$k-\\varepsilon$、$k-\\omega$、涡粘性、湍流强度）。所提供的数值对于典型的工程流动是物理上现实的。问题是适定的，每个任务都定义清晰，并提供了足够的信息来获得唯一解。语言客观，没有歧义。简化假设，如在模拟湍流衰减时忽略产生项和扩散项，在此背景下是标准做法。该问题并非微不足道，需要涉及湍流模拟原理和微积分的多步推导。\n\n### 第 3 步：结论与行动\n问题有效。下面提供完整解答。\n\n### 任务 1：入口湍动能 $k(0)$\n单位质量的湍动能 $k$ 定义为 $k = \\frac{1}{2}(\\overline{u'^2} + \\overline{v'^2} + \\overline{w'^2})$，其中 $u'$、$v'$ 和 $w'$ 是坐标方向上的速度脉动。对于各向同性湍流，法向雷诺应力相等：$\\overline{u'^2} = \\overline{v'^2} = \\overline{w'^2}$。因此，$k = \\frac{3}{2}\\overline{u'^2}$。\n湍流强度 $I$ 定义为速度脉动分量的均方根与平均速度 $U$之比。对于各向同性湍流，即为 $I = \\frac{\\sqrt{\\overline{u'^2}}}{U}$。\n从此定义可知，$\\overline{u'^2} = I^2 U^2$。将此代入 $k$ 的表达式中，得到：\n$$k = \\frac{3}{2} (I^2 U^2) = \\frac{3}{2} I^2 U^2$$\n在入口处（$x=0$），我们可以计算湍动能的值 $k(0)$：\n$$k(0) = \\frac{3}{2} (0.05)^2 (20\\,\\mathrm{m/s})^2 = \\frac{3}{2} (0.0025) (400\\,\\mathrm{m^2/s^2}) = 1.5\\,\\mathrm{m^2/s^2}$$\n\n### 任务 2：入口耗散率 $\\varepsilon(0)$\n耗散率 $\\varepsilon$ 可通过量纲分析与湍动能 $k$ 和积分长度尺度 $L$ 联系起来，$\\varepsilon \\propto k^{3/2}/L$。CFD 中的一种常见做法（与涡粘性闭合模型一致）是将涡粘性 $\\nu_t$ 与这些尺度联系起来。在 $k-\\varepsilon$ 模型中，涡粘性定义为 $\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon}$。它也可以用一个特征速度（$\\sim k^{1/2}$）和一个长度尺度来标度。与 $k-\\varepsilon$ 模型常数一致的该长度尺度的标准模型是 $L_{\\text{model}} = C_{\\mu}^{1/4} L$。这得出 $\\nu_t \\propto k^{1/2} (C_{\\mu}^{1/4} L)$。将两种 $\\nu_t$ 的形式相等，可以得到 $\\varepsilon$ 的关系式。一个更直接且广泛用于设置入口条件的公式，与此标度一致，是：\n$$\\varepsilon = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L}$$\n在入口处，我们使用 $k(0) = 1.5\\,\\mathrm{m^2/s^2}$，$L = 0.03\\,\\mathrm{m}$ 和 $C_{\\mu} = 0.09$ 计算 $\\varepsilon(0)$：\n$$\\varepsilon(0) = (0.09)^{3/4} \\frac{(1.5\\,\\mathrm{m^2/s^2})^{3/2}}{0.03\\,\\mathrm{m}} = (0.09)^{3/4} \\frac{1.5\\sqrt{1.5}}{0.03} \\frac{\\mathrm{m^3/s^3}}{\\mathrm{m}} \\approx 10.061\\,\\mathrm{m^2/s^3}$$\n\n### 任务 3：入口比耗散率 $\\omega(0)$\n在标准高雷诺数 $k-\\omega$ 模型中，涡粘性定义为 $\\nu_t = k/\\omega$。为确保与 $k-\\varepsilon$ 模型在入口处的一致性，我们令它们各自的 $\\nu_t$ 表达式相等：\n$$C_{\\mu} \\frac{k(0)^2}{\\varepsilon(0)} = \\frac{k(0)}{\\omega(0)}$$\n求解比耗散率 $\\omega(0)$：\n$$\\omega(0) = \\frac{\\varepsilon(0)}{C_{\\mu} k(0)}$$\n代入 $\\varepsilon(0)$ 和 $k(0)$ 的表达式，得到与物理尺度的直接关系：\n$$\\omega(0) = \\frac{C_{\\mu}^{3/4} k(0)^{3/2} / L}{C_{\\mu} k(0)} = C_{\\mu}^{-1/4} \\frac{k(0)^{1/2}}{L}$$\n使用数值进行计算：\n$$\\omega(0) = \\frac{10.061\\,\\mathrm{m^2/s^3}}{0.09 \\times 1.5\\,\\mathrm{m^2/s^2}} \\approx 74.526\\,\\mathrm{s^{-1}}$$\n\n### 任务 4：$k(x)$ 和 $\\nu_t(x)$ 的下游演化\n在稳态一维柱塞流中，忽略产生项和扩散项的 $k$ 的输运方程为：\n$$U \\frac{dk}{dx} = -\\varepsilon(x)$$\n我们假设用于入口条件的 $\\varepsilon$ 和 $k$ 之间的关系在下游衰减湍流中仍然成立，其中 $L$ 是一个代表含能涡初始尺度的常数参数：\n$$\\varepsilon(x) = C_{\\mu}^{3/4} \\frac{k(x)^{3/2}}{L}$$\n将其代入输运方程，得到一个关于 $k(x)$ 的可分离常微分方程：\n$$U \\frac{dk}{dx} = -C_{\\mu}^{3/4} \\frac{k^{3/2}}{L}$$\n$$k^{-3/2} dk = -\\frac{C_{\\mu}^{3/4}}{UL} dx$$\n从入口（$x=0$）积分到下游位置 $x$：\n$$\\int_{k(0)}^{k(x)} k'^{-3/2} dk' = -\\int_{0}^{x} \\frac{C_{\\mu}^{3/4}}{UL} dx'$$\n$$\\left[ -2k'^{-1/2} \\right]_{k(0)}^{k(x)} = -\\frac{C_{\\mu}^{3/4}}{UL} x$$\n$$-2(k(x)^{-1/2} - k(0)^{-1/2}) = -\\frac{C_{\\mu}^{3/4}}{UL} x$$\n$$k(x)^{-1/2} = k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4}}{2UL} x$$\n求解 $k(x)$，得到闭式表达式：\n$$k(x) = \\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)^{-2}$$\n接下来，我们求涡粘性 $\\nu_t(x)$。我们使用 $k-\\varepsilon$ 模型的定义和 $\\varepsilon(x)$ 的假定关系：\n$$\\nu_t(x) = C_{\\mu} \\frac{k(x)^2}{\\varepsilon(x)} = C_{\\mu} \\frac{k(x)^2}{C_{\\mu}^{3/4} k(x)^{3/2}/L} = C_{\\mu}^{1/4} L k(x)^{1/2}$$\n代入 $k(x)^{1/2} = (k(x))^{-1/2 \\cdot (-1)} = (k(x)^{-1/2})^{-1}$ 的表达式：\n$$\\nu_t(x) = C_{\\mu}^{1/4} L \\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)^{-1}$$\n\n### 任务 5：敏感度分析 $S_{\\nu}(L;x^{\\ast})$\n无量纲对数敏感度定义为 $S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$。根据链式法则，这等价于 $S_{\\nu}(L;x^{\\ast}) = L \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial L}$。\n首先，我们对 $\\nu_t(x)$ 的表达式取自然对数：\n$$\\ln \\nu_t(x) = \\ln(C_{\\mu}^{1/4}) + \\ln(L) - \\ln\\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)$$\n注意 $k(0)$ 依赖于 $I$ 和 $U$，而不依赖于 $L$。现在，我们对 $L$ 求导：\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = 0 + \\frac{1}{L} - \\frac{1}{k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL}} \\cdot \\frac{\\partial}{\\partial L}\\left( \\frac{C_{\\mu}^{3/4} x}{2U} L^{-1} \\right)$$\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = \\frac{1}{L} - \\frac{1}{k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL}} \\cdot \\left( -\\frac{C_{\\mu}^{3/4} x}{2UL^2} \\right)$$\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = \\frac{1}{L} + \\frac{C_{\\mu}^{3/4} x / (2UL^2)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\n乘以 $L$ 得到敏感度 $S_{\\nu}$：\n$$S_{\\nu}(L;x) = L \\left( \\frac{1}{L} \\right) + \\frac{C_{\\mu}^{3/4} x / (2UL)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\n$$S_{\\nu}(L;x) = 1 + \\frac{C_{\\mu}^{3/4} x / (2UL)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\n现在，我们计算在 $x^{\\ast} = 2\\,\\mathrm{m}$ 处的数值。首先，我们计算各分量项：\n$k(0)^{-1/2} = (1.5)^{-1/2} \\approx 0.816497\\,\\mathrm{s/m}$。\n$\\frac{C_{\\mu}^{3/4} x^{\\ast}}{2UL} = \\frac{(0.09)^{3/4} \\times 2}{2 \\times 20 \\times 0.03} = \\frac{(0.09)^{3/4}}{0.6} \\approx \\frac{0.164317}{0.6} \\approx 0.273861\\,\\mathrm{s/m}$。\n将这些值代入 $S_{\\nu}$ 的表达式中：\n$$S_{\\nu}(L;x^{\\ast}) = 1 + \\frac{0.273861}{0.816497 + 0.273861} = 1 + \\frac{0.273861}{1.090358} \\approx 1 + 0.251165 \\approx 1.251165$$\n四舍五入到四位有效数字，敏感度为 $1.251$。", "answer": "$$\\boxed{1.251}$$", "id": "3385389"}, {"introduction": "高级湍流模型之所以性能更优，关键在于其内部精巧的物理机制。剪切应力输运（SST）$k-\\omega$ 模型的核心创新之一就是引入了湍流粘性限制器，以防止在分离流等复杂流动中过高地预测湍流粘性。本练习将通过编程实践，对比有无限制器时湍流粘性和剪切应力的计算差异，让你直观地理解 SST 模型在改善分离流预测方面的优势所在。[@problem_id:3385353]", "problem": "考虑雷诺平均纳维-斯托克斯 (RANS) 方程和 Boussinesq 假设。Boussinesq 假设通过一个湍流（涡）黏度将雷诺应力张量模拟为与平均应变率张量成正比。Boussinesq 关系式表明，雷诺应力张量的偏量部分为 $$\\tau_{ij}^{\\prime} = 2 \\rho \\nu_t S_{ij},$$ 其中 $\\rho$ 是流体密度，$\\nu_t$ 是湍流运动黏度，$S_{ij}$ 是平均应变率张量。标量应变率大小定义为 $$S = \\sqrt{2 S_{ij} S_{ij}},$$ 而模拟的剪切应力大小为 $$\\tau = 2 \\rho \\nu_t S.$$\n\n在两方程湍流模型中，需要求解湍流动能 $k$ 和另一个决定湍流时间尺度的变量（例如，比耗散率 $\\omega$）的输运方程。在标准 $k$–$\\omega$ 模型中，量纲一致性和能量收支论证导出了一个将 $k$ 和 $\\omega$ 与 $\\nu_t$ 联系起来的涡黏度标度关系。在剪切应力输运 (SST) 模型中，引入了一个限制机制来避免在强剪切或逆压梯度区域出现过大的涡黏度，这对于实际预测分离流是必要的。在远离壁面的区域，SST 限制器可以用应变率大小、一个正常数系数 $a_1$ 和比耗散率 $\\omega$ 来表示。\n\n从 Boussinesq 假设和上述定义出发，您必须推导出用 $k$ 和 $\\omega$ 表示的基准涡黏度关系，以及在近壁混合函数为单位值时，使用系数 $a_1$ 和应变率大小 $S$ 的 SST 限制涡黏度关系。然后，使用这些关系，为代表分离流区域的给定一维采样场 $k(x)$、$\\omega(x)$ 和 $S(x)$ 计算模拟的剪切应力大小 $\\tau$ 场。假设密度 $\\rho$ 恒定，且各场足够平滑且严格非负。使用 $a_1 = 0.31$ 和 $\\rho = 1.225 \\,\\text{kg}/\\text{m}^3$。\n\n数值和输出要求：\n- 实现两种涡黏度公式：\n  1. 用 $k$ 和 $\\omega$ 表示的 $k$–$\\omega$ 模型的基准关系。\n  2. 在 SST 混合函数在远离壁面时为单位值的极限情况下，由 $k$、$\\omega$、$S$ 和 $a_1$ 构成的剪切应力输运 (SST) 限制关系。\n- 对于每个测试用例，计算两种模拟的剪切应力大小分布：\n  1. 不带限制器（基准）。\n  2. 带 SST 限制器（远离壁面形式）。\n- 对于每个测试用例，报告三个量：\n  1. 不带限制器的平均模拟剪切应力大小，以帕斯卡（牛顿每平方米）为单位。\n  2. 带限制器的平均模拟剪切应力大小，以帕斯卡（牛顿每平方米）为单位。\n  3. 平均值的相对变化量（限制值减去无限制值）除以无限制平均值，以小数表示（非百分比）。\n- 所有剪切应力值必须以 $\\text{Pa}$ 表示，如果使用任何角度，则必须以弧度表示。此处没有角度输入。\n- 仅使用一个无穷小正常数 $\\varepsilon$ 来避免 $\\omega$ 出现除以零的情况，以确保物理一致性。\n\n测试套件：\n- 用例 1（分离剪切层中的高剪切，限制器激活）：\n  - $$k = [0.6,\\,0.8,\\,1.0,\\,1.1,\\,1.0,\\,0.9,\\,0.8,\\,0.7,\\,0.6,\\,0.5] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [600,\\,550,\\,500,\\,450,\\,400,\\,350,\\,300,\\,250,\\,220,\\,200] \\,\\text{s}^{-1},$$\n  - $$S = [900,\\,800,\\,700,\\,600,\\,500,\\,400,\\,300,\\,250,\\,200,\\,150] \\,\\text{s}^{-1}.$$\n- 用例 2（回流核心，低应变率，限制器大部分不激活）：\n  - $$k = [0.4,\\,0.5,\\,0.6,\\,0.5,\\,0.4] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [800,\\,900,\\,1000,\\,900,\\,800] \\,\\text{s}^{-1},$$\n  - $$S = [30,\\,25,\\,20,\\,25,\\,30] \\,\\text{s}^{-1}.$$\n- 用例 3（再附点附近的过渡剪切，限制器部分激活）：\n  - $$k = [0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.5,\\,0.4] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [200,\\,220,\\,240,\\,260,\\,280,\\,300,\\,320] \\,\\text{s}^{-1},$$\n  - $$S = [100,\\,110,\\,120,\\,130,\\,140,\\,150,\\,160] \\,\\text{s}^{-1}.$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来。每个内部列表必须完全按照上述顺序包含对应测试用例的三个浮点数。例如：$$[[\\tau_{\\text{mean,unlimited}},\\tau_{\\text{mean,limited}},\\Delta],\\ldots].$$", "solution": "该问题要求使用源自两方程湍流模型的两种不同湍流（涡）黏度 $\\nu_t$ 公式来计算模拟的湍流剪切应力大小。第一种是标准 $k$-$\\omega$ 模型的基准公式，第二种是剪切应力输运 (SST) $k$-$\\omega$ 模型的限制器增强公式。\n\n此分析的基础是 Boussinesq 假设，它通过涡黏度 $\\nu_t$ 将雷诺应力张量的偏量部分 $\\tau'_{ij}$ 与平均应变率张量 $S_{ij}$ 联系起来：\n$$ \\tau'_{ij} = 2 \\rho \\nu_t S_{ij} $$\n这里，$\\rho$ 是流体密度。问题基于此关系和标量应变率大小 $S = \\sqrt{2 S_{ij} S_{ij}}$ 定义了一个标量模拟剪切应力大小 $\\tau$：\n$$ \\tau = 2 \\rho \\nu_t S $$\n核心任务是根据两种指定的湍流模型来定义 $\\nu_t$。\n\n### 第 1 步：基准涡黏度公式（标准 $k$-$\\omega$ 模型）\n\n在两方程模型中，求解湍流动能 $k$ 和另一个决定湍流时间尺度 $T_{turb}$ 的变量的输运方程。比耗散率 $\\omega$ 就是这样一个变量，它表示单位能量的湍流能量耗散率，因此 $\\omega \\propto 1/T_{turb}$。湍流动能 $k$ 的量纲是速度的平方，$[k] = L^2 T^{-2}$，而 $\\omega$ 的量纲是频率，$[\\omega] = T^{-1}$。\n\n湍流运动黏度 $\\nu_t$ 的量纲必须是 $L^2 T^{-1}$。通过量纲分析，能够为 $\\nu_t$ 产生正确单位的最简单的 $k$ 和 $\\omega$ 组合是它们的比值：\n$$ [\\nu_t] = \\frac{[k]}{[\\omega]} = \\frac{L^2 T^{-2}}{T^{-1}} = L^2 T^{-1} $$\n基于此量纲推理，由 Wilcox 开发的标准 $k-\\omega$ 模型将涡黏度定义为：\n$$ \\nu_{t, \\text{unlimited}} = \\frac{k}{\\omega} $$\n这是基准的，或称无限制的公式。将其代入 $\\tau$ 的方程，得到无限制的剪切应力大小：\n$$ \\tau_{\\text{unlimited}} = 2 \\rho \\left( \\frac{k}{\\omega} \\right) S $$\n为确保在 $\\omega$ 接近零时的数值稳定性，我们将其计算为 $\\tau_{\\text{unlimited}} = 2 \\rho (k/(\\omega + \\varepsilon)) S$，其中 $\\varepsilon$ 是一个小的正常数。\n\n### 第 2 步：SST 限制的涡黏度公式\n\n标准 $k-\\omega$ 模型的一个已知问题是它倾向于在强逆压梯度或流动分离区域过高地预测剪切应力。由 Menter 开发的剪切应力输运 (SST) 模型通过在涡黏度上引入一个限制器来解决这个问题。这个限制器受到 Bradshaw 假说的启发，该假说观察到在许多边界层流动中，湍流剪切应力的大小与湍流动能成正比，即 $|\\tau_{\\text{turb}}| \\approx \\rho a_1 k$，其中 $a_1$ 是一个经验常数。\n\n通过将此与 Boussinesq 关系式 $\\tau \\approx \\rho \\nu_t S$ 结合，我们可以推导出对涡黏度的一个限制：\n$$ \\rho \\nu_t S \\le \\rho a_1 k \\implies \\nu_t \\le \\frac{a_1 k}{S} $$\nSST 模型通过修改涡黏度的定义来包含这一物理约束。在远离壁面处，模型的第二个混合函数 $F_2$ 为 1，SST 涡黏度定义为：\n$$ \\nu_{t, \\text{limited}} = \\frac{a_1 k}{\\max(a_1 \\omega, S)} $$\n这个公式巧妙地在标准 $k-\\omega$ 行为和剪切应力限制器之间切换：\n- 如果 $a_1 \\omega \\ge S$（低应变区域），则 $\\max(a_1 \\omega, S) = a_1 \\omega$，表达式简化为 $\\nu_{t, \\text{limited}} = \\frac{a_1 k}{a_1 \\omega} = \\frac{k}{\\omega}$。这恢复了基准公式。\n- 如果 $S  a_1 \\omega$（高应变区域，例如分离剪切层），则 $\\max(a_1 \\omega, S) = S$，表达式变为 $\\nu_{t, \\text{limited}} = \\frac{a_1 k}{S}$。这施加了基于 Bradshaw 假说的涡黏度限制。\n\n这等价于写作 $\\nu_{t, \\text{limited}} = \\min(\\frac{k}{\\omega}, \\frac{a_1 k}{S})$。将 SST 公式代入 $\\tau$ 的方程，得到限制的剪切应力大小：\n$$ \\tau_{\\text{limited}} = 2 \\rho \\left( \\frac{a_1 k}{\\max(a_1 \\omega, S)} \\right) S $$\n\n### 第 3 步：计算步骤\n\n对于每个测试用例，我们都给定了一维数组 $k(x)$、$\\omega(x)$ 和 $S(x)$。所需的输出按以下方式计算：\n1.  对于域中的每个点 $x_i$，使用推导出的公式、给定的常数 $\\rho = 1.225 \\,\\text{kg}/\\text{m}^3$ 和 $a_1 = 0.31$ 以及数据数组，计算 $\\tau_{\\text{unlimited}}(x_i)$ 和 $\\tau_{\\text{limited}}(x_i)$。\n2.  计算每个剪切应力分布的平均值：\n    $$ \\bar{\\tau}_{\\text{unlimited}} = \\frac{1}{N} \\sum_{i=1}^{N} \\tau_{\\text{unlimited}}(x_i) $$\n    $$ \\bar{\\tau}_{\\text{limited}} = \\frac{1}{N} \\sum_{i=1}^{N} \\tau_{\\text{limited}}(x_i) $$\n3.  计算平均剪切应力的相对变化量：\n    $$ \\Delta = \\frac{\\bar{\\tau}_{\\text{limited}} - \\bar{\\tau}_{\\text{unlimited}}}{\\bar{\\tau}_{\\text{unlimited}}} $$\n这三个值——$\\bar{\\tau}_{\\text{unlimited}}$、$\\bar{\\tau}_{\\text{limited}}$ 和 $\\Delta$——是为每个提供的测试用例计算的。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes modeled shear stress magnitude based on baseline and SST-limited\n    k-omega turbulence model formulations.\n    \"\"\"\n    # Define physical and model constants\n    RHO = 1.225    # Fluid density in kg/m^3\n    A1 = 0.31      # SST model coefficient\n    EPSILON = 1e-12 # Small constant for numerical stability\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: High shear, limiter active\n        (\n            np.array([0.6, 0.8, 1.0, 1.1, 1.0, 0.9, 0.8, 0.7, 0.6, 0.5]), # k [m^2/s^2]\n            np.array([600, 550, 500, 450, 400, 350, 300, 250, 220, 200]), # omega [s^-1]\n            np.array([900, 800, 700, 600, 500, 400, 300, 250, 200, 150])  # S [s^-1]\n        ),\n        # Case 2: Recirculation core, low strain, limiter mostly inactive\n        (\n            np.array([0.4, 0.5, 0.6, 0.5, 0.4]), # k [m^2/s^2]\n            np.array([800, 900, 1000, 900, 800]), # omega [s^-1]\n            np.array([30, 25, 20, 25, 30])      # S [s^-1]\n        ),\n        # Case 3: Transitional shear, limiter partially active\n        (\n            np.array([0.2, 0.3, 0.4, 0.5, 0.6, 0.5, 0.4]), # k [m^2/s^2]\n            np.array([200, 220, 240, 260, 280, 300, 320]), # omega [s^-1]\n            np.array([100, 110, 120, 130, 140, 150, 160])  # S [s^-1]\n        )\n    ]\n\n    all_results = []\n    for k, omega, S in test_cases:\n        # 1. Unlimited (baseline k-omega) calculation\n        # The term (k / (omega + EPSILON)) represents the baseline eddy viscosity.\n        nu_t_unlimited = k / (omega + EPSILON)\n        tau_unlimited = 2 * RHO * nu_t_unlimited * S\n        mean_tau_unlimited = np.mean(tau_unlimited)\n\n        # 2. Limited (SST k-omega) calculation\n        # The term (A1 * k / max(A1*omega, S)) represents the SST-limited eddy viscosity.\n        sst_denominator = np.maximum(A1 * omega, S)\n        \n        # Initialize the limited eddy viscosity array and guard against division by zero.\n        nu_t_limited = np.zeros_like(k)\n        safe_indices = sst_denominator  EPSILON\n        \n        # Calculate limited eddy viscosity only for numerically safe indices.\n        if np.any(safe_indices):\n            nu_t_limited[safe_indices] = A1 * k[safe_indices] / sst_denominator[safe_indices]\n        \n        tau_limited = 2 * RHO * nu_t_limited * S\n        mean_tau_limited = np.mean(tau_limited)\n\n        # 3. Fractional change calculation\n        # Guard against division by zero if the unlimited mean is zero.\n        if abs(mean_tau_unlimited)  EPSILON:\n            frac_change = (mean_tau_limited - mean_tau_unlimited) / mean_tau_unlimited\n        else:\n            # If unlimited mean is zero, and limited mean is also zero, change is 0.\n            # Otherwise, the change is infinite (not expected in this problem).\n            frac_change = 0.0 if abs(mean_tau_limited)  EPSILON else np.inf\n\n        all_results.append([mean_tau_unlimited, mean_tau_limited, frac_change])\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    # Using str().replace() ensures no spaces are present in the output.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3385353"}]}