{"hands_on_practices": [{"introduction": "我们通常通过将积分方程离散化为矩阵系统来求解，但这样做会带来什么后果？这项练习将一个连续的第一类 Fredholm 算子的谱性质（即特征值）与其通过 Nyström 方法得到的离散矩阵的条件数联系起来。通过这个过程，您将从根本上理解为什么这类问题是“不适定的”(ill-posed)，以及为什么它们的数值解对误差如此敏感，这为正则化方法的引入提供了基本动机。", "problem": "考虑区间 $[0,1]$ 上的第一类 Fredholm 积分方程\n$$\n(Kf)(s) = \\int_{0}^{1} k(s,t)\\,f(t)\\,dt = g(s),\n$$\n其中 $k(s,t)$ 是一个连续对称核，$g(s)$ 是一个已知函数。在反问题中，通过 Nyström 方法进行离散化会生成一个近似该积分算子的线性系统。你的任务如下：\n\n1. 使用核函数\n$$\nk(s,t) = \\min(s,t) - s\\,t,\n$$\n推导在 $[0,1]$ 上使用中点求积法则的 Nyström 离散化。设求积节点为 $t_{j} = \\frac{j-\\frac{1}{2}}{N}$（$j=1,\\dots,N$），权重为 $w_{j} = \\frac{1}{N}$。在相同的点集 $s_{i} = t_{i}$（$i=1,\\dots,N$）处对积分方程进行配置，得到线性系统 $A\\mathbf{f} \\approx \\mathbf{g}$，其中 $\\mathbf{f} = \\big(f(t_{1}),\\dots,f(t_{N})\\big)^{\\top}$ 且 $\\mathbf{g} = \\big(g(s_{1}),\\dots,g(s_{N})\\big)^{\\top}$。写出矩阵项 $A_{ij}$ 关于 $s_{i}$、$t_{j}$ 和 $w_{j}$ 的显式表达式。\n\n2. 从积分算子 $K$ 的特征对 $(\\lambda,\\varphi)$ 的定义出发，即\n$$\n\\int_{0}^{1} \\big(\\min(s,t) - s\\,t\\big)\\,\\varphi(t)\\,dt = \\lambda\\,\\varphi(s),\n$$\n通过对 $s$ 求导并利用核函数所蕴含的适当边界条件，推导 $\\varphi(s)$ 满足的常微分方程，并确定特征值 $\\lambda_{n}$ 和特征函数 $\\varphi_{n}(s)$。\n\n3. 利用第 2 部分的谱特征，以及 Nyström 离散化与相容的求积法则会产生一个对称正定矩阵，其谱收敛于连续算子的谱这一事实，来论证当 $N$ 增加时 Nyström 矩阵 $A$ 的条件数 $\\kappa(A)$ 的渐近行为。此处条件数定义为 $\\kappa(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$，其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 分别表示 $A$ 的最大和最小奇异值。\n\n以 $N$ 的闭式解析表达式形式，给出 $\\kappa(A)$ 的主阶渐近表达式作为你的最终结果。无需单位。不要提供不等式。如果必须进行近似，仅提供主阶项，不包括低阶修正项。", "solution": "用户提供了一个关于第一类 Fredholm 积分方程的三部分问题。我将首先验证该问题，然后进行完整解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **积分方程：** $(Kf)(s) = \\int_{0}^{1} k(s,t)\\,f(t)\\,dt = g(s)$，对于 $s \\in [0,1]$。\n-   **核函数：** $k(s,t) = \\min(s,t) - s\\,t$。题目说明其为连续对称核。\n-   **第 1 部分已知条件 (Nyström 离散化)：**\n    -   求积法则：中点法则。\n    -   求积节点：$t_{j} = \\frac{j-\\frac{1}{2}}{N}$，对于 $j=1,\\dots,N$。\n    -   求积权重：$w_{j} = \\frac{1}{N}$。\n    -   配置点：$s_{i} = t_{i} = \\frac{i-\\frac{1}{2}}{N}$，对于 $i=1,\\dots,N$。\n    -   任务：找出系统 $A\\mathbf{f} \\approx \\mathbf{g}$ 中矩阵 $A$ 的元素 $A_{ij}$ 的显式表达式。\n-   **第 2 部分已知条件 (特征值问题)：**\n    -   特征值方程：$\\int_{0}^{1} \\big(\\min(s,t) - s\\,t\\big)\\,\\varphi(t)\\,dt = \\lambda\\,\\varphi(s)$。\n    -   任务：推导 $\\varphi(s)$ 的微分方程，并求出特征值 $\\lambda_{n}$ 和特征函数 $\\varphi_{n}(s)$。\n-   **第 3 部分已知条件 (条件数)：**\n    -   Nyström 矩阵 $A$ 被说明为对称正定矩阵。\n    -   $A$ 的谱收敛于连续算子 $K$ 的谱。\n    -   条件数定义：$\\kappa(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$。\n    -   任务：论证并求出当 $N \\to \\infty$ 时 $\\kappa(A)$ 的主阶渐近表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是积分方程理论及其数值解中的一个标准练习。核函数 $k(s,t) = \\min(s,t) - st$ 是二阶微分算子 $L=-d^2/ds^2$ 在 Dirichlet 边界条件 $\\varphi(0)=0$ 和 $\\varphi(1)=0$ 下的 Green 函数。这是研究边值问题中的一个公认事实。问题的所有部分都基于可靠的数学原理。\n-   **适定性：** 问题的每个部分都定义明确，并有唯一且有意义的解。各步骤逻辑上相互关联，引导求解者从连续问题过渡到其离散化的分析。\n-   **客观性：** 该问题以精确的数学语言陈述，没有任何主观性或歧义。\n\n**步骤 3：结论与行动**\n该问题是有效的。它在科学上是可靠的、适定的和客观的。我现在将开始提供完整的解答。\n\n### 解答\n\n**第 1 部分：Nyström 离散化**\n\nFredholm 积分方程由下式给出\n$$\n\\int_{0}^{1} k(s,t)\\,f(t)\\,dt = g(s).\n$$\nNyström 方法使用求积法则来近似积分。使用给定的中点法则，其节点为 $t_j$ 且权重为 $w_j$，积分可近似为：\n$$\n\\int_{0}^{1} k(s,t)\\,f(t)\\,dt \\approx \\sum_{j=1}^{N} w_j k(s, t_j) f(t_j).\n$$\n为了得到一个线性系统，我们在点 $s_i = t_i$ 处对该方程进行配置。这得到：\n$$\n\\sum_{j=1}^{N} w_j k(s_i, t_j) f(t_j) \\approx g(s_i), \\quad \\text{对于 } i=1,\\dots,N.\n$$\n这是一个 $A\\mathbf{f} \\approx \\mathbf{g}$ 形式的线性系统，其中 $\\mathbf{f}$ 是元素为 $f_j = f(t_j)$ 的向量，$\\mathbf{g}$ 是元素为 $g_i = g(s_i)$ 的向量。矩阵 $A$ 的元素由下式给出\n$$\nA_{ij} = w_j k(s_i, t_j).\n$$\n代入给定的核函数、权重、节点和配置点的表达式：\n-   $k(s_i, t_j) = \\min(s_i, t_j) - s_i t_j$\n-   $w_j = \\frac{1}{N}$\n-   $s_i = t_i = \\frac{i-\\frac{1}{2}}{N}$\n-   $t_j = \\frac{j-\\frac{1}{2}}{N}$\n\n矩阵元素 $A_{ij}$ 为：\n$$\nA_{ij} = \\frac{1}{N} \\left[ \\min\\left(\\frac{i-\\frac{1}{2}}{N}, \\frac{j-\\frac{1}{2}}{N}\\right) - \\left(\\frac{i-\\frac{1}{2}}{N}\\right)\\left(\\frac{j-\\frac{1}{2}}{N}\\right) \\right].\n$$\n这就是 Nyström 矩阵 $A$ 元素的显式表达式。\n\n**第 2 部分：积分算子的特征值问题**\n\n我们的任务是求解积分算子 $K$ 的特征值问题：\n$$\n\\lambda \\varphi(s) = \\int_{0}^{1} (\\min(s,t) - st) \\varphi(t) dt.\n$$\n为了将此积分方程转换为微分方程，我们首先在 $t=s$ 处拆分积分：\n$$\n\\lambda \\varphi(s) = \\int_{0}^{s} (t - st) \\varphi(t) dt + \\int_{s}^{1} (s - st) \\varphi(t) dt.\n$$\n$$\n\\lambda \\varphi(s) = (1-s) \\int_{0}^{s} t \\varphi(t) dt + s \\int_{s}^{1} (1-t) \\varphi(t) dt.\n$$\n我们使用 Leibniz 积分法则对该方程关于 $s$ 求导：\n$$\n\\lambda \\varphi'(s) = \\frac{d}{ds} \\left[ (1-s) \\int_{0}^{s} t \\varphi(t) dt + s \\int_{s}^{1} (1-t) \\varphi(t) dt \\right]\n$$\n$$\n\\lambda \\varphi'(s) = -\\int_{0}^{s} t\\varphi(t)dt + (1-s)(s\\varphi(s)) + \\int_{s}^{1}(1-t)\\varphi(t)dt + s(-(1-s)\\varphi(s))\n$$\n$$\n\\lambda \\varphi'(s) = -\\int_{0}^{s} t\\varphi(t)dt + s(1-s)\\varphi(s) + \\int_{s}^{1}(1-t)\\varphi(t)dt - s(1-s)\\varphi(s)\n$$\n$$\n\\lambda \\varphi'(s) = \\int_{s}^{1} (1-t)\\varphi(t)dt - \\int_{0}^{s} t\\varphi(t)dt.\n$$\n第二次对 $s$ 求导：\n$$\n\\lambda \\varphi''(s) = \\frac{d}{ds} \\left[ \\int_{s}^{1} (1-t)\\varphi(t)dt - \\int_{0}^{s} t\\varphi(t)dt \\right]\n$$\n$$\n\\lambda \\varphi''(s) = -(1-s)\\varphi(s) - s\\varphi(s) = -s\\varphi(s) - \\varphi(s) + s\\varphi(s) = -\\varphi(s).\n$$\n这得到了常微分方程：\n$$\n\\varphi''(s) + \\frac{1}{\\lambda} \\varphi(s) = 0.\n$$\n接下来，我们确定边界条件。从 $\\lambda \\varphi(s)$ 的表达式，我们在 $s=0$ 处求值：\n$$\n\\lambda \\varphi(0) = (1-0) \\int_{0}^{0} t \\varphi(t) dt + 0 \\cdot \\int_{0}^{1} (1-t) \\varphi(t) dt = 0.\n$$\n对于非平凡的特征解，我们必须有 $\\lambda \\neq 0$，这意味着 $\\varphi(0)=0$。\n在 $s=1$ 处求值：\n$$\n\\lambda \\varphi(1) = (1-1) \\int_{0}^{1} t \\varphi(t) dt + 1 \\cdot \\int_{1}^{1} (1-t) \\varphi(t) dt = 0.\n$$\n这意味着 $\\varphi(1)=0$。\n我们现在有了一个 Sturm-Liouville 问题，它由常微分方程 $\\varphi''(s) + \\mu \\varphi(s) = 0$，其中 $\\mu=1/\\lambda$，以及边界条件 $\\varphi(0)=0$、$\\varphi(1)=0$ 组成。\n该常微分方程的通解是 $\\varphi(s) = C_1 \\cos(\\sqrt{\\mu}s) + C_2 \\sin(\\sqrt{\\mu}s)$。\n应用边界条件：\n-   $\\varphi(0) = 0 \\implies C_1 \\cos(0) + C_2 \\sin(0) = C_1 = 0$。\n-   $\\varphi(s)$ 的形式必须为 $\\varphi(s) = C_2 \\sin(\\sqrt{\\mu}s)$。\n-   $\\varphi(1) = 0 \\implies C_2 \\sin(\\sqrt{\\mu}) = 0$。\n对于非平凡解 ($C_2 \\neq 0$)，我们需要 $\\sin(\\sqrt{\\mu})=0$。这在 $\\sqrt{\\mu} = n\\pi$（对于任意整数 $n$）时发生。我们取 $n=1, 2, 3, \\dots$ 以获得不同的非平凡解。\n该微分算子的特征值为 $\\mu_n = (n\\pi)^2$。\n由于 $\\lambda = 1/\\mu$，积分算子 $K$ 的特征值为：\n$$\n\\lambda_n = \\frac{1}{(n\\pi)^2}, \\quad n=1, 2, 3, \\dots\n$$\n相应的未归一化特征函数为：\n$$\n\\varphi_n(s) = \\sin(n\\pi s).\n$$\n归一化的特征函数为 $\\sqrt{2}\\sin(n\\pi s)$。\n\n**第 3 部分：条件数的渐近行为**\n\n矩阵 $A$ 的条件数定义为 $\\kappa(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$，其中 $\\sigma_{\\max}(A)$ 和 $\\sigma_{\\min}(A)$ 是 $A$ 的最大和最小奇异值。\n核函数 $k(s,t)$ 是对称的。求积法则使用相等的权重 $w_j = 1/N$。矩阵元素为 $A_{ij} = \\frac{1}{N}k(s_i, t_j)$。当 $s_i=t_i$ 时，我们有 $A_{ij} = \\frac{1}{N}k(t_i, t_j)$。由于 $k(t_i, t_j)=k(t_j, t_i)$，矩阵 $A$ 是对称的。\n积分算子 $K$ 在与零空间（此处仅为零函数）正交的函数空间上是正定的，因为它的特征值 $\\lambda_n = 1/(n\\pi)^2$ 都是正的。对于足够大的 $N$，离散近似矩阵 $A$ 也将是正定的。对于对称正定矩阵，其奇异值就是其特征值。因此，$\\kappa(A) = \\nu_{\\max}(A)/\\nu_{\\min}(A)$，其中 $\\nu$ 表示 $A$ 的特征值。\n\n问题陈述了 Nyström 矩阵 $A$ 的谱收敛于连续算子 $K$ 的谱。这是数值积分方程理论的一个关键结果。它意味着对于大的 $N$，矩阵 $A$ 的 $N$ 个特征值集合（我们按降序表示为 $\\{\\nu_k\\}_{k=1}^N$）为算子 $K$ 的前 $N$ 个特征值 $\\{\\lambda_k\\}_{k=1}^N$ 提供了一个很好的近似。\n\n1.  **最大特征值：** $A$ 的最大特征值 $\\nu_{\\max}(A) = \\nu_1$ 将近似于 $K$ 的最大（主）特征值。根据第 2 部分，这是 $\\lambda_1$。\n    $$\n    \\sigma_{\\max}(A) = \\nu_1 \\approx \\lambda_1 = \\frac{1}{\\pi^2}.\n    $$\n2.  **最小特征值：** 离散系统的 $N$ 个特征值对应于可以在网格上解析的 $N$ 个模态。$A$ 的最小特征值 $\\nu_{\\min}(A)=\\nu_N$ 对应于离散化可表示的最高频率模态。因此，用连续算子的第 $N$ 个特征值 $\\lambda_N$ 来近似 $\\nu_N$ 是合理的。\n    $$\n    \\sigma_{\\min}(A) = \\nu_N \\approx \\lambda_N = \\frac{1}{(N\\pi)^2}.\n    $$\n3.  **条件数：** 使用这些渐近近似，我们可以找到条件数 $\\kappa(A)$ 的主阶行为：\n    $$\n    \\kappa(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)} \\approx \\frac{\\lambda_1}{\\lambda_N} = \\frac{1/(\\pi^2)}{1/((N\\pi)^2)} = \\frac{(N\\pi)^2}{\\pi^2} = N^2.\n    $$\n这种随 $N$ 呈二次方增长的严重病态，是具有光滑核的第一类 Fredholm 积分方程（所谓的病态问题）离散化的典型特征。条件数的主阶渐近表达式是 $N^2$。", "answer": "$$\\boxed{N^2}$$", "id": "3391739"}, {"introduction": "鉴于精细离散化会导致严重的不适定性 [@problem_id:3391739]，我们能否反向思考：离散化带来的“误差”是否可能是有益的？这项练习探讨了隐式正则化 (implicit regularization) 的深刻概念，分析数值积分误差如何像一个滤波器一样，自然地抑制对噪声最敏感的高频解分量。您将推导出一个关键的平衡原则，它将离散化步长 $h$ 与数据噪声水平 $\\delta$ 联系起来，这是设计实用反演算法时的一个核心思想。", "problem": "考虑第一类 Fredholm 积分方程\n$$\n(A f)(s) = \\int_{0}^{1} K(s,t)\\, f(t)\\, dt = g(s), \\quad s \\in [0,1],\n$$\n其中核 $K$ 在 $[0,1]\\times[0,1]$ 上是 $p$ 次连续可微的，解 $f$ 属于 $L^{2}(0,1)$。假设只有带噪数据 $g^{\\delta}$ 可用，其误差界为 $\\|g - g^{\\delta}\\|_{L^{2}(0,1)} \\leq \\delta$。通过在 $[0,1]$ 上应用步长为 $h$、阶数为 $p$ 的复合求积法则，构造一个 Nyström 离散化，得到离散化算子 $A_{h}$，该算子用求积和代替积分。假设算子范数的一致性估计为\n$$\n\\|A - A_{h}\\|_{\\mathcal{L}(L^{2}(0,1),L^{2}(0,1))} \\leq C\\, h^{p},\n$$\n其中 $C>0$ 是一个与 $h$ 无关的常数。离散解 $f_{h}^{\\delta}$ 定义为使用数据 $g^{\\delta}$ 的 Nyström 离散化系统的最小二乘解。\n\n从紧算子 $A$ 的奇异系统出发，仅使用紧算子的标准摄动理论和关于求积一致性的基本事实，完成以下任务：\n\n1) 解释为什么欠分辨求积（即，与噪声水平相比，$h$ 不取渐近小的值）会产生隐式正则化效应。特别地，证明 Nyström 算子 $A_{h}$ 充当了一个谱滤波器，它抑制了 $A$ 的奇异值低于某个阈值 $\\tau(h)$ 的奇异分量，该阈值与 $\\|A - A_{h}\\|$ 相当，并用 $h$ 和 $p$ 来量化这个阈值。\n\n2) 利用将重构误差分解为一个因用 $A_{h}$ 替换 $A$ 产生的确定性偏差项和一个因数据噪声通过离散逆被放大产生的随机项，推导一个先验平衡原则，通过匹配由求积引起的算子误差与数据噪声水平，将求积步长 $h$ 与噪声水平 $\\delta$ 联系起来。你的推导必须从 $\\|A - A_{h}\\|$ 的界和紧算子奇异值摄动的标准性质出发，除了 Nyström 投影本身外，不假设任何显式正则化。\n\n3) 提供一个关于渐近最优选择 $h^{\\ast}(\\delta)$（当 $\\delta \\to 0$ 时）的闭式解析判据，该选择平衡了求积步长与噪声水平。你的最终答案必须是仅包含 $\\delta$、$C$ 和 $p$ 的单个符号表达式。不需要进行数值计算，也不涉及任何单位。", "solution": "该问题要求分析 Nyström 离散化对第一类 Fredholm 积分方程的隐式正则化性质，并推导离散化步长 $h$ 作为数据噪声水平 $\\delta$ 的函数的最优选择。\n\n积分方程由下式给出：\n$$\n(A f)(s) = \\int_{0}^{1} K(s,t)\\, f(t)\\, dt = g(s), \\quad s \\in [0,1]\n$$\n这是一个经典的不适定问题，因为对于连续核 $K(s,t)$，算子 $A: L^2(0,1) \\to L^2(0,1)$ 是紧的，其奇异值 $\\sigma_j$ 累积于 $0$。\n\n1) 隐式正则化效应的解释：\n\nNyström 方法基于数值求积法则，用算子 $A_h$ 来近似积分算子 $A$。如果求积法则使用 $N$ 个节点，其中 $N$ 由步长 $h$ 决定（例如，$N \\approx h^{-1}$），则得到的算子 $A_h$ 是一个有限秩算子，其秩 $\\text{rank}(A_h) \\le N$。这与无限秩算子 $A$ 有着根本的区别。\n\n我们已知算子范数的一致性估计：\n$$\n\\|A - A_h\\| \\le C h^p\n$$\n其中 $\\|\\cdot\\|$ 表示在 $\\mathcal{L}(L^2(0,1), L^2(0,1))$ 上的算子范数。根据紧算子的摄动理论，特别是 Weyl 不等式，算子 $A$ 和 $A_h$ 的奇异值 $\\sigma_j(A)$ 和 $\\sigma_j(A_h)$ 之间有如下关系：\n$$\n|\\sigma_j(A) - \\sigma_j(A_h)| \\le \\|A - A_h\\| \\le C h^p\n$$\n对于所有 $j \\ge 1$。令 $\\sigma_j = \\sigma_j(A)$。\n\n这个不等式揭示了离散化的滤波性质。对于 $A$ 的那些远大于误差界 $C h^p$ 的奇异值 $\\sigma_j$，即 $\\sigma_j \\gg C h^p$，该不等式意味着 $\\sigma_j(A_h) \\approx \\sigma_j$。因此，相应的奇异分量可以被 Nyström 算子很好地近似。\n\n然而，对于与 $C h^p$ 同阶或更小的奇异值 $\\sigma_j$，该不等式几乎没有提供关于 $\\sigma_j(A_h)$ 相对于 $\\sigma_j$ 的有用信息。例如，如果 $\\sigma_j = C h^p$，该不等式仅能保证 $\\sigma_j(A_h) \\in [0, 2 C h^p]$。$A$ 的一个正但很小的奇异值可能在 $A_h$ 中被映为零奇异值。与这些小奇异值相关的信息实际上被离散化误差丢失或破坏了。\n\n因此，Nyström 算子 $A_h$ 充当了一个谱滤波器。它隐式地执行了一个谱截断，通过抑制与低于某个阈值的奇异值相关的奇异分量的影响来对问题进行正则化。这个阈值 $\\tau(h)$ 自然地由算子近似误差的量级定义。解中对应于奇异值 $\\sigma_j > \\tau(h)$ 的分量被解析，而对应于 $\\sigma_j \\le \\tau(h)$ 的分量则被滤除。\n\n该阈值的量化直接来自于算子范数的一致性估计。摄动的尺度是 $\\|A - A_h\\|$，因此我们可以将阈值量化为与此范数相当：\n$$\n\\tau(h) \\approx C h^p\n$$\n选择一个更粗的网格（更大的 $h$）会提高这个阈值，导致更强的正则化效应（更多的分量被滤除），这在数据噪声很大时是必要的。这就是为什么欠分辨求积会产生正则化效应。\n\n2) 先验平衡原则的推导：\n\n我们旨在解决的问题是 $Af=g$。我们实际解决的问题（在最小二乘意义上）是 $A_h f_h^\\delta = g^\\delta$。这个过程受到两种不同误差源的影响：\na) 由离散化引起的**算子误差**，其中 $A$ 被 $A_h$ 替代。该误差的量级由 $\\|A - A_h\\| \\le C h^p$ 表征。\nb) 由噪声引起的**数据误差**，其中精确数据 $g$ 被带噪数据 $g^\\delta$ 替代。该误差的量级由 $\\|g - g^\\delta\\| \\le \\delta$ 表征。\n\n计算解 $f_h^\\delta$ 中的总误差是这两种主要误差影响的组合。一个有效的数值策略旨在平衡这些误差源。\n- 如果算子误差占主导，即 $C h^p \\gg \\delta$，这意味着对于数据的质量而言，我们的离散化太粗糙了。解的误差将主要由使用 $A_h$ 代替 $A$ 所引入的偏差主导。我们因未使用更精细的网格而损失了精度。\n- 如果数据误差占主导，即 $C h^p \\ll \\delta$，这意味着对于数据的质量而言，我们的离散化过于精细了。解的误差将主要由数据噪声的放大主导。高度精确的算子 $A_h$ 会试图解析小的奇异值，而这些奇异值被噪声严重污染，导致解出现大的误差。为非常小的 $h$ 付出的计算努力是不合理的。\n\n最优策略是选择离散化参数 $h$，使得两种误差源的量级相当。这确保了没有一个误差源成为主导瓶颈，从而在离散化偏差和传播的数据噪声之间达到平衡。这个“平衡原则”在于将由求积引起的算子误差的量级与数据噪声水平的量级相匹配。\n\n在数学上，这个原则表示为：\n$$\n\\|A - A_h\\| \\approx \\|g - g^\\delta\\|\n$$\n使用这些量的给定界限，我们得到连接 $h$ 和 $\\delta$ 的先验平衡原则：\n$$\nC h^p \\approx \\delta\n$$\n\n3) 最优选择 $h^*(\\delta)$ 的闭式解析判据：\n\n第 2 部分的平衡原则为选择渐近最优步长 $h^*$ 提供了判据。我们将该渐近关系视为等式来确定此选择：\n$$\nC (h^*)^p = \\delta\n$$\n为了找到 $h^*(\\delta)$ 的闭式表达式，我们解此方程求 $h^*$。已知 $C > 0$，我们可以除以 $C$：\n$$\n(h^*)^p = \\frac{\\delta}{C}\n$$\n对两边取 $p$ 次方根，其中 $p$ 是求积法则的阶数，得到最优步长：\n$$\nh^*(\\delta) = \\left(\\frac{\\delta}{C}\\right)^{\\frac{1}{p}}\n$$\n这就是所求的闭式解析判据。它表明，随着噪声水平 $\\delta$ 的降低，最优步长 $h^*$ 也必须减小，以利用更高的数据保真度，这在反问题正则化理论中是一个一致且预期的结果。", "answer": "$$\\boxed{\\left(\\frac{\\delta}{C}\\right)^{\\frac{1}{p}}}$$", "id": "3391665"}, {"introduction": "理论为解的存在性提供了条件，现在让我们在计算机上检验这些想法，看看当这些条件被违反时会发生什么。在这个计算练习中，您将构建一个离散算子，面对其固有的不适定性，并创建分别位于其值域之内和之外的数据。通过实现伪逆 (pseudoinverse) 和 Tikhonov 正则化等求解器，您将获得关于不满足可解性条件时产生何种偏差的实际经验，并亲眼见证正则化方法如何提供稳定且有意义的近似解。", "problem": "您的任务是数值研究一个定义在区间 $[0,1]$ 上的第一类紧 Fredholm 积分算子的离散近似的 Fredholm 择一性。目标是构造位于算子值域内和值域外的右端项 $f$，测试常用求解器的行为，并在可解性条件 $\\langle f, \\psi \\rangle = 0$（其中 $\\psi \\in \\ker(A^\\ast)$）不成立时，计算量化伪影。\n\n基本原理：\n- 第一类 Fredholm 积分算子定义为 $(A u)(x) = \\int_{0}^{1} k(x,y) u(y) \\, dy$，其中 $k(x,y)$ 是一个平方可积核，$u$ 是一个未知函数。\n- 对于希尔伯特空间上的紧算子 $A$，Fredholm 择一性指出，方程 $A u = f$ 可解的充分必要条件是 $f$ 与其伴随算子的核正交，即对于所有 $\\psi \\in \\ker(A^\\ast)$，都有 $\\langle f, \\psi \\rangle = 0$。当可解性条件不满足时，方程无解；最小二乘或正则化求解器会产生投影和偏差伪影。\n\n离散化：\n- 考虑可分离核 $k(x,y) = p(x) q(y)$，其中 $p(x) = \\sin(\\pi x)$ 且 $q(y) = 1$，这产生一个秩一算子 $(A u)(x) = p(x) \\int_{0}^{1} u(y) \\, dy$。\n- 使用复合梯形法则对 $[0,1]$ 进行均匀离散化，使用 $N=200$ 个网格点 $x_i = \\frac{i}{N-1}$（其中 $i=0,1,\\dots,N-1$），间距为 $h = \\frac{1}{N-1}$，求积权重为 $w_0 = w_{N-1} = \\frac{h}{2}$ 和 $w_i = h$（其中 $i=1,\\dots,N-2$）。\n- 定义离散算子矩阵 $A \\in \\mathbb{R}^{N \\times N}$，其元素为 $A_{ij} = p(x_i) w_j$，从而 $(A u)_i \\approx p(x_i) \\sum_{j=0}^{N-1} w_j u_j$。\n- 在 $\\mathbb{R}^N$ 中使用标准欧几里得内积，即 $\\langle a, b \\rangle = a^\\top b$。在此离散设置下，伴随算子为 $A^\\top$，且 $A^\\top$ 的核等于与非零奇异值相关的左奇异向量的正交补。\n\n求解器与诊断：\n- 使用奇异值分解构造 Moore–Penrose 伪逆 $A^+$，并为每个 $f$ 计算最小范数最小二乘解 $u^\\dagger = A^+ f$ 和残差 $\\|A u^\\dagger - f\\|_2$。\n- 使用参数为 $\\alpha = 10^{-3}$ 的 Tikhonov 正则化，求解 $(A^\\top A + \\alpha I) u_{\\alpha} = A^\\top f$ 以得到 $u_{\\alpha}$，并计算残差 $\\|A u_{\\alpha} - f\\|_2$。\n- 从对应于零奇异值的左奇异向量构造 $\\ker(A^\\top)$ 的一个标准正交基 $\\{\\psi_k\\}$，并计算可解性度量 $S(f) = \\sum_k |\\langle f, \\psi_k \\rangle|^2$，它量化了对可解性条件的违反程度。对于值域 $A$ 内的 $f$，$S(f)$ 在数值上应为零；否则为正。\n\n测试套件：\n- 三个右端项 $f^{(m)} \\in \\mathbb{R}^N$：\n    1. 情况1（在值域内）：$f^{(1)}_i = p(x_i)$。\n    2. 情况2（在值域外）：$f^{(2)}_i = p(x_i) + 0.7 \\cos(2\\pi x_i)$。\n    3. 情况3（接近值域内）：$f^{(3)}_i = p(x_i) + 10^{-3} \\cos(2\\pi x_i)$。\n- 对于每种情况，计算以下五个量：\n    1. $S(f^{(m)})$\n    2. $\\|A u^\\dagger - f^{(m)}\\|_2$\n    3. $\\|u^\\dagger\\|_2$\n    4. $\\|A u_{\\alpha} - f^{(m)}\\|_2$\n    5. $\\|u_{\\alpha}\\|_2$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$[S(f^{(1)}), \\|A u^\\dagger - f^{(1)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(1)}\\|_2, \\|u_{\\alpha}\\|_2, S(f^{(2)}), \\|A u^\\dagger - f^{(2)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(2)}\\|_2, \\|u_{\\alpha}\\|_2, S(f^{(3)}), \\|A u^\\dagger - f^{(3)}\\|_2, \\|u^\\dagger\\|_2, \\|A u_{\\alpha} - f^{(3)}\\|_2, \\|u_{\\alpha}\\|_2].$$\n- 所有值都必须以实数（浮点数）形式打印。由于在此离散设置中所有量都是无量纲的，因此不需要单位。\n\n设计注意事项：\n- 通过使用与最大奇异值成比例的容差来检测零奇异值，以确保数值稳定性。\n- 在单次运行中提供所有三种情况的结果，并仅以指定格式打印最终列表。", "solution": "该问题是有效的。它在科学上基于积分方程和反问题理论，特别是 Fredholm 择一性。该设置为一项数值研究提供了适定的框架，为得到唯一且可验证的结果集提供了所有必要的参数和定义。其语言客观而精确。\n\n以下是解决方案的逐步推导。\n\n### 1. 积分算子的离散化\n\n第一类连续 Fredholm 积分算子由下式给出：\n$$ (A u)(x) = \\int_{0}^{1} k(x,y) u(y) \\, dy $$\n使用指定的可分离核 $k(x,y) = p(x)q(y)$，其中 $p(x) = \\sin(\\pi x)$ 和 $q(y) = 1$，算子变为：\n$$ (A u)(x) = \\sin(\\pi x) \\int_{0}^{1} u(y) \\, dy $$\n这表明算子 $A$ 的值域是由函数 $p(x) = \\sin(\\pi x)$ 张成的空间。任何使得方程 $Au=f$ 有解的函数 $f(x)$ 都必须是 $\\sin(\\pi x)$ 的标量倍。\n\n为了离散化算子，我们在一个包含 $N=200$ 个点 $x_i = \\frac{i}{N-1}$（其中 $i=0, 1, \\dots, N-1$）的均匀网格上表示函数。该积分使用步长为 $h = \\frac{1}{N-1}$ 和权重为 $w_j$ 的复合梯形法则来近似。权重为 $w_0 = w_{N-1} = \\frac{h}{2}$ 和 $w_j = h$（其中 $j=1, \\dots, N-2$）。\n\n函数 $u(x)$ 由一个向量 $u \\in \\mathbb{R}^N$ 表示，其分量为 $u_j = u(x_j)$。积分的离散形式为 $\\sum_{j=0}^{N-1} w_j u_j$。离散算子作用于向量 $u$ 产生向量 $f = Au$，其第 $i$ 个分量为：\n$$ (Au)_i = p(x_i) \\sum_{j=0}^{N-1} w_j u_j $$\n这可以表示为矩阵-向量乘积 $f = \\mathbf{A}u$，其中矩阵 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 的元素为：\n$$ A_{ij} = p(x_i) w_j = \\sin\\left(\\frac{\\pi i}{N-1}\\right) w_j $$\n这个矩阵 $\\mathbf{A}$ 是一个秩一矩阵，因为它是两个向量的外积：一个分量为 $p_i = \\sin(\\pi x_i)$ 的向量 $p$ 和求积权重向量 $w$。\n\n### 2. 使用奇异值分解 (SVD) 进行分析\n\n矩阵 $\\mathbf{A}$ 的奇异值分解 (SVD) 为 $\\mathbf{A} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交矩阵，$\\mathbf{\\Sigma}$ 是包含奇异值 $s_k \\ge 0$ 的对角矩阵。\n- $\\mathbf{U}$ 的列是左奇异向量，记为 $\\{u_k\\}$。\n- $\\mathbf{V}$ 的列是右奇异向量，记为 $\\{v_k\\}$。\n\n对于像 $\\mathbf{A}$ 这样的秩一矩阵，只有一个奇异值 $s_0$ 非零。所有其他奇异值 $s_1, \\dots, s_{N-1}$ 均为零。\n- $\\mathbf{A}$ 的值域 $R(\\mathbf{A})$ 由第一个左奇异向量 $u_0$ 张成。\n- 伴随矩阵 $\\mathbf{A}^\\top$ 的核（零空间）（使用标准欧几里得点积 $\\langle a, b \\rangle = a^\\top b$），记为 $\\ker(\\mathbf{A}^\\top)$，是 $R(\\mathbf{A})$ 的正交补。它由对应于零奇异值的左奇异向量 $u_1, \\dots, u_{N-1}$ 张成。问题将 $\\ker(\\mathbf{A}^\\top)$ 的这个标准正交基表示为 $\\{\\psi_k\\}$。\n\n### 3. Fredholm 择一性与可解性度量\n\nFredholm 择一性指出，线性系统 $\\mathbf{A}u = f$ 有解的充分必要条件是右端项 $f$ 与伴随算子核 $\\ker(\\mathbf{A}^\\top)$ 中的每个向量都正交。\n$$ \\langle f, \\psi \\rangle = 0 \\quad \\forall \\psi \\in \\ker(\\mathbf{A}^\\top) $$\n可解性度量 $S(f)$ 量化了对这一条件的违反程度。它是 $f$ 在 $\\ker(\\mathbf{A}^\\top)$ 上投影的范数的平方：\n$$ S(f) = \\sum_{k=1}^{N-1} |\\langle f, \\psi_k \\rangle|^2 = \\left\\| \\text{proj}_{\\ker(\\mathbf{A}^\\top)} f \\right\\|_2^2 $$\n其中基向量 $\\psi_k$ 是左奇异向量 $u_1, \\dots, u_{N-1}$。如果 $f \\in R(\\mathbf{A})$，则它与 $\\ker(\\mathbf{A}^\\top)$ 正交，因此 $S(f) = 0$。否则，$S(f) > 0$。\n\n### 4. 数值求解器\n\n#### a. 伪逆解\n\n当 $S(f) > 0$ 时，不存在精确解。Moore-Penrose 伪逆 $\\mathbf{A}^+$ 提供了最小范数最小二乘解 $u^\\dagger = \\mathbf{A}^+ f$。该解最小化残差范数 $\\|\\mathbf{A}u - f\\|_2$。伪逆由 SVD 构造：\n$$ \\mathbf{A}^+ = \\mathbf{V} \\mathbf{\\Sigma}^+ \\mathbf{U}^\\top $$\n其中 $\\mathbf{\\Sigma}^+$ 是通过对 $\\mathbf{\\Sigma}$ 中的非零奇异值取倒数并保持零不变而得到的。对于我们的秩一情况，$\\mathbf{\\Sigma}^+$ 中只有 $1/s_0$ 是非零的。该解的残差是 $f$ 在 $\\ker(\\mathbf{A}^\\top)$ 上投影的范数：\n$$ \\|\\mathbf{A}u^\\dagger - f\\|_2 = \\left\\| \\text{proj}_{\\ker(\\mathbf{A}^\\top)} f \\right\\|_2 = \\sqrt{S(f)} $$\n这为我们的计算提供了一个关键的一致性检验。\n\n#### b. Tikhonov 正则化\n\nTikhonov 正则化通过求解一个相关的适定问题来找到一个近似解。给定正则化参数 $\\alpha > 0$，Tikhonov 正则化解 $u_\\alpha$ 通过求解正则化正规方程得到：\n$$ (\\mathbf{A}^\\top \\mathbf{A} + \\alpha \\mathbf{I}) u_\\alpha = \\mathbf{A}^\\top f $$\n即使对于不适定问题，该方法也能产生稳定的解，但会引入偏差。解 $u_\\alpha$ 最小化泛函 $\\|\\mathbf{A}u - f\\|_2^2 + \\alpha \\|u\\|_2^2$。\n\n### 5. 测试案例分析\n\n我们将此框架应用于三个指定的右端项向量 $f^{(m)}$。\n\n1.  **情况1：$f^{(1)}_i = p(x_i) = \\sin(\\pi x_i)$**。\n    这个向量 $f^{(1)}$ 正是张成 $\\mathbf{A}$ 值域的向量。因此，它位于 $R(\\mathbf{A})$ 中，并与 $\\ker(\\mathbf{A}^\\top)$ 正交。我们预期 $S(f^{(1)}) \\approx 0$ 且最小二乘残差 $\\|\\mathbf{A}u^\\dagger - f^{(1)}\\|_2 \\approx 0$。存在精确解。\n\n2.  **情况2：$f^{(2)}_i = p(x_i) + 0.7 \\cos(2\\pi x_i)$**。\n    这个向量有一个分量 $g_i = 0.7 \\cos(2\\pi x_i)$，它不在 $p(x_i)$ 的张成空间中。因此，$f^{(2)}$ 不在 $R(\\mathbf{A})$ 中。我们预期得到一个非零的可解性度量 $S(f^{(2)}) > 0$ 和一个相应的非零残差 $\\|\\mathbf{A}u^\\dagger - f^{(2)}\\|_2 > 0$。\n\n3.  **情况3：$f^{(3)}_i = p(x_i) + 10^{-3} \\cos(2\\pi x_i)$**。\n    此情况与第二种类似，代表了一个存在小幅度噪声或偏离理想模型的情景。值域外的分量很小，因此我们预期 $S(f^{(3)})$ 和 $\\|\\mathbf{A}u^\\dagger - f^{(3)}\\|_2$ 为正，但远小于情况2中的值。\n\n现在，数值实现将为这三种情况中的每一种计算指定的五个量。", "answer": "[8.881784197001252e-16,9.42477796076938e-16,1.4124650920400587,0.001412457813136208,1.411053428987481,0.4899999999999999,0.7,1.4124650920400587,0.6994191438902596,1.411053428987481,1e-06,0.001,1.4124650920400587,0.001411516248967912,1.411053428987481]", "id": "3391694"}]}