{"hands_on_practices": [{"introduction": "首先，我们来探索不确定性如何因系统动力学而随时间演变。本练习聚焦于卡尔曼滤波的“预测”步骤，在这一步中，我们基于当前的协方差、系统转换模型和过程噪声，来预测下一时刻的状态误差协方差。通过计算新的协方差矩阵并分析其特性，我们将从几何上理解不确定性为何在某些方向上增长而在另一些方向上收缩，这是洞察系统稳定性和可预测性的关键。[@problem_id:3421213]", "problem": "考虑一个二维离散时间线性随机动态系统，其状态 $x_k \\in \\mathbb{R}^2$ 根据 $x_{k+1} = F x_k + w_k$ 演化，其中 $F = \\mathrm{diag}(2, 0.5)$，过程噪声 $w_k$ 是一个零均值随机向量，独立于 $x_k$ 和当前的状态估计误差，其协方差为 $Q = \\mathrm{diag}(1, 0)$。设初始状态估计误差协方差为\n$$\nP_0 = \\begin{bmatrix} 1  0.2 \\\\ 0.2  1 \\end{bmatrix}.\n$$\n假设一个无偏预测器 $\\hat{x}_{k+1|k} = F \\hat{x}_k$ 并定义状态估计误差为 $e_k = x_k - \\hat{x}_k$。仅从协方差的定义和给定的独立性假设出发，推导预测步协方差 $P_1$，然后确定在一次传播步骤后，状态空间中的哪些标准正交方向表现出不确定性的增长与收缩。将最终答案以单行矩阵的形式给出，按顺序包含：$P_1$ 的四个元素（按行排列：$P_{1,11}, P_{1,12}, P_{1,21}, P_{1,22}$），其后是代表不确定性增长方向的单位向量的两个分量，然后是代表不确定性收缩方向的单位向量的两个分量。以精确值表示最终答案，不要四舍五入。", "solution": "用户想要解决一个关于状态误差协方差传播的问题。\n\n### 第一步：提取已知条件\n- 状态演化模型：$x_{k+1} = F x_k + w_k$\n- 状态向量：$x_k \\in \\mathbb{R}^2$\n- 状态转移矩阵：$F = \\mathrm{diag}(2, 0.5)$\n- 过程噪声：$w_k$ 是一个零均值随机向量，独立于 $x_k$ 和当前的状态估计误差。\n- 过程噪声协方差：$Q = \\mathrm{diag}(1, 0)$\n- 初始状态估计误差协方差：$P_0 = \\begin{bmatrix} 1  0.2 \\\\ 0.2  1 \\end{bmatrix}$\n- 预测器模型：$\\hat{x}_{k+1|k} = F \\hat{x}_k$\n- 状态估计误差定义：$e_k = x_k - \\hat{x}_k$\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它描述了一个标准离散时间卡尔曼滤波器的预测步骤。所有参数都已指定，问题是自洽的。符号 $\\hat{x}_k$ 和 $e_k$ 略有歧义，但在标准卡尔曼滤波器框架下可以一致地解释为分析估计 $\\hat{x}_{k|k}$ 和分析误差 $e_k = x_k - \\hat{x}_{k|k}$。那么初始协方差 $P_0$ 就是步骤 $k=0$ 时的分析误差协方差，即 $P_0 \\equiv P_{0|0}$。所要求的预测步协方差 $P_1$ 则是步骤 $k=1$ 时的预测误差协方差，即 $P_{1|0}$。该问题有效。\n\n### 第三步：结论与行动\n问题有效。开始求解。\n\n该问题要求从第一性原理推导预测步协方差传播方程。设时间 $k$ 测量更新后的状态估计误差（分析误差）为 $e_{k|k} = x_k - \\hat{x}_{k|k}$。其协方差为分析误差协方差，$P_{k|k} = E[e_{k|k} e_{k|k}^T]$。在初始时间 $k=0$ 时，给定 $P_0$，我们将其解释为 $P_{0|0}$。\n\n状态向量根据线性随机方程演化：\n$$x_{k+1} = F x_k + w_k$$\n状态估计通过模型的确定性部分在时间上传播。将 $\\hat{x}_k$ 解释为分析估计 $\\hat{x}_{k|k}$，则时间 $k+1$ 的预测为：\n$$\\hat{x}_{k+1|k} = F \\hat{x}_{k|k}$$\n时间 $k+1$ 的预测误差（或预报误差）是真实状态与预测状态之间的差值：\n$$e_{k+1|k} = x_{k+1} - \\hat{x}_{k+1|k}$$\n代入 $x_{k+1}$ 和 $\\hat{x}_{k+1|k}$ 的表达式：\n$$e_{k+1|k} = (F x_k + w_k) - (F \\hat{x}_{k|k}) = F(x_k - \\hat{x}_{k|k}) + w_k = F e_{k|k} + w_k$$\n预测误差协方差 $P_{k+1|k}$ 定义为预测误差与其自身外积的期望值：\n$$P_{k+1|k} = E[e_{k+1|k} e_{k+1|k}^T] = E[(F e_{k|k} + w_k)(F e_{k|k} + w_k)^T]$$\n展开乘积：\n$$P_{k+1|k} = E[F e_{k|k} e_{k|k}^T F^T + F e_{k|k} w_k^T + w_k e_{k|k}^T F^T + w_k w_k^T]$$\n根据期望算子的线性性质：\n$$P_{k+1|k} = E[F e_{k|k} e_{k|k}^T F^T] + E[F e_{k|k} w_k^T] + E[w_k e_{k|k}^T F^T] + E[w_k w_k^T]$$\n利用 $F$ 是常数矩阵这一事实：\n$$P_{k+1|k} = F E[e_{k|k} e_{k|k}^T] F^T + F E[e_{k|k} w_k^T] + E[w_k e_{k|k}^T] F^T + E[w_k w_k^T]$$\n给定过程噪声 $w_k$ 独立于当前状态估计误差 $e_{k|k}$。因此，它们是不相关的。由于估计过程是无偏的，误差 $e_{k|k}$ 是一个零均值随机向量。过程噪声 $w_k$ 也被给定为零均值。因此，互相关项为零：\n$$E[e_{k|k} w_k^T] = E[e_{k|k}] E[w_k^T] = 0 \\cdot 0^T = 0$$\n协方差的表达式简化为：\n$$P_{k+1|k} = F E[e_{k|k} e_{k|k}^T] F^T + E[w_k w_k^T]$$\n识别出分析误差协方差 $P_{k|k} = E[e_{k|k} e_{k|k}^T]$ 和过程噪声协方差 $Q = E[w_k w_k^T]$ 的定义，我们得到标准的预测步协方差更新方程：\n$$P_{k+1|k} = F P_{k|k} F^T + Q$$\n我们需要计算 $P_1$，它对应于 $P_{1|0}$。我们使用 $k=0$：\n$$P_{1|0} = F P_{0|0} F^T + Q$$\n给定的矩阵是：\n$$F = \\begin{bmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix}, \\quad P_0 = P_{0|0} = \\begin{bmatrix} 1  \\frac{1}{5} \\\\ \\frac{1}{5}  1 \\end{bmatrix}, \\quad Q = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix}$$\n首先，计算乘积 $F P_0 F^T$：\n$$F P_0 F^T = \\begin{bmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} 1  \\frac{1}{5} \\\\ \\frac{1}{5}  1 \\end{bmatrix} \\begin{bmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} 2  \\frac{2}{5} \\\\ \\frac{1}{10}  \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} 2  0 \\\\ 0  \\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} 4  \\frac{1}{5} \\\\ \\frac{1}{5}  \\frac{1}{4} \\end{bmatrix}$$\n接下来，加上过程噪声协方差 $Q$：\n$$P_1 = P_{1|0} = \\begin{bmatrix} 4  \\frac{1}{5} \\\\ \\frac{1}{5}  \\frac{1}{4} \\end{bmatrix} + \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 5  \\frac{1}{5} \\\\ \\frac{1}{5}  \\frac{1}{4} \\end{bmatrix}$$\n为了确定不确定性增长与收缩的方向，我们分析误差协方差矩阵的变化量 $\\Delta P = P_1 - P_0$。由单位向量 $v$ 给出的任意方向上的方差变化为 $v^T \\Delta P v$。最大和最小变化的方向是 $\\Delta P$ 的特征向量。\n$$\\Delta P = P_1 - P_0 = \\begin{bmatrix} 5  \\frac{1}{5} \\\\ \\frac{1}{5}  \\frac{1}{4} \\end{bmatrix} - \\begin{bmatrix} 1  \\frac{1}{5} \\\\ \\frac{1}{5}  1 \\end{bmatrix} = \\begin{bmatrix} 5-1  \\frac{1}{5}-\\frac{1}{5} \\\\ \\frac{1}{5}-\\frac{1}{5}  \\frac{1}{4}-1 \\end{bmatrix} = \\begin{bmatrix} 4  0 \\\\ 0  -\\frac{3}{4} \\end{bmatrix}$$\n矩阵 $\\Delta P$ 是对角矩阵。其特征值是对角线元素 $\\lambda_1 = 4$ 和 $\\lambda_2 = -\\frac{3}{4}$。对应的特征向量是标准基向量。\n\n正特征值表示相应特征向量方向上的方差（不确定性）已经增长。不确定性增长方向对应于 $\\lambda_1 = 4$。其特征向量为：\n$$v_{grow} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$$\n负特征值表示方差（不确定性）已经收缩。不确定性收缩方向对应于 $\\lambda_2 = -\\frac{3}{4}$。其特征向量为：\n$$v_{shrink} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$$\n这些特征向量已经是单位向量并且是正交的，因此是一组有效的标准正交方向。\n\n最终答案要求按行排列 $P_1$ 的四个元素，以及 $v_{grow}$ 的两个分量和 $v_{shrink}$ 的两个分量。\n$P_1$ 的元素是 $P_{1,11}=5$，$P_{1,12}=\\frac{1}{5}$，$P_{1,21}=\\frac{1}{5}$ 和 $P_{1,22}=\\frac{1}{4}$。\n$v_{grow}$ 的分量是 $1$ 和 $0$。\n$v_{shrink}$ 的分量是 $0$ 和 $1$。", "answer": "$$\\boxed{\\begin{pmatrix} 5  \\frac{1}{5}  \\frac{1}{5}  \\frac{1}{4}  1  0  0  1 \\end{pmatrix}}$$", "id": "3421213"}, {"introduction": "在了解了不确定性如何随时间向前传播后，我们现在转向一个关键问题：如何利用新信息来减小不确定性。本练习深入探讨了“分析”或“更新”步骤，即融合观测数据以修正我们的状态估计。你将从第一性原理出发，推导决定新数据理想权重的最优卡尔曼增益，并计算最终的后验（或分析）误差协方差，从而定量地展示测量如何带来更确定的状态估计。[@problem_id:3421248]", "problem": "考虑一个线性高斯数据同化设定，其中状态向量 $x \\in \\mathbb{R}^{2}$ 是二维的，观测 $y \\in \\mathbb{R}$ 是一维的。先验（背景）状态误差为零均值，其协方差为 $P^{f} \\in \\mathbb{R}^{2 \\times 2}$。观测模型为 $y = H x + \\epsilon$，其中 $H \\in \\mathbb{R}^{1 \\times 2}$，观测噪声 $\\epsilon$ 为零均值，与先验误差无关，其协方差为 $R \\in \\mathbb{R}^{1 \\times 1}$。要求您从第一性原理出发，推导 Kalman Filter (KF) 中使用的最优线性最小方差分析步，且不假定任何预先给定的更新公式。从以下基本原则开始：\n\n- 贝叶斯线性高斯模型：如果 $(x, y)$ 是联合高斯分布，具有线性观测算子和独立的高斯噪声，则条件分布 $p(x \\mid y)$ 也是高斯分布。$p(x \\mid y)$ 的均值在所有关于 $y$ 可测的估计量中，使均方估计误差最小。\n- 估计量被限制在线性类 $x^{a} = x^{f} + K\\,(y - H x^{f})$ 中，其中 $K \\in \\mathbb{R}^{2 \\times 1}$ 是一个通过最小化期望平方分析误差来确定的增益。\n- 对于任何零均值随机向量 $z$，其协方差定义为 $\\mathbb{E}[z z^{\\top}]$。\n- 对于独立的零均值随机向量 $u$ 和 $v$，$\\mathbb{E}[u v^{\\top}] = 0$。\n\n仅使用这些基础，完成以下任务：\n\n1. 在线性估计量 $x^{a} = x^{f} + K\\,(y - H x^{f})$ 中，通过最小化分析误差协方差在所有 $K \\in \\mathbb{R}^{2 \\times 1}$ 上的迹，来推导最优增益 $K$。\n2. 推导分析误差协方差 $P^{a}$ 的两种数学上等价的表达式：\n   - 基于将最优 $K$ 直接代入分析误差协方差的标准形式，\n   - 以及在先验协方差和增益上是双线性、并显式地加入了观测噪声贡献的 Joseph 稳定形式。\n3. 对于 \n   $$P^{f} = \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix}, \\quad H = \\begin{bmatrix} 1  0 \\end{bmatrix}, \\quad R = 1$$\n   数值计算最优增益 $K$ 以及由标准形式和 Joseph 形式产生的 $P^{a}$。\n   验证这两个 $P^{a}$ 矩阵是相同的。\n4. 通过直接检查 $2 \\times 2$ 对称矩阵的充要条件，证明所得的 $P^{a}$ 是半正定的。\n\n您的最终答案必须按以下顺序报告六个标量：$K$ 的两个分量，后跟 $P^{a}$ 的四个元素（对于标准形式和 Joseph 形式，该矩阵是相同的），所有数值均为精确有理数。不需要四舍五入，也不涉及单位。将最终答案表示为具有一行六列的单个行矩阵。最终答案中不要包含任何文本。", "solution": "该问题提法适定，具有科学依据，并为完整的推导和数值计算提供了所有必要信息。我们将按顺序处理问题的四个部分。\n\n首先，我们将分析误差 $e^a$ 定义为分析状态 $x^a$ 与真实状态 $x$ 之间的差。先验误差为 $e^f = x^f - x$，其中 $x^f$ 是先验估计。先验误差的协方差由 $P^f = \\mathbb{E}[e^f (e^f)^\\top]$ 给出。观测模型为 $y = Hx + \\epsilon$，其中 $\\epsilon$ 是观测误差，其协方差为 $R = \\mathbb{E}[\\epsilon \\epsilon^\\top]$。先验误差和观测误差是独立的，且均值为零。\n\n分析状态 $x^a$ 由线性估计量 $x^a = x^f + K(y - Hx^f)$ 给出，其中 $K \\in \\mathbb{R}^{2 \\times 1}$ 是增益矩阵。分析误差为：\n$$e^a = x^a - x = \\left(x^f + K(y - Hx^f)\\right) - x$$\n代入 $y = Hx + \\epsilon$：\n$$e^a = x^f - x + K(Hx + \\epsilon - Hx^f)$$\n$$e^a = (x^f - x) + K(H(x-x^f) + \\epsilon)$$\n$$e^a = e^f - KHe^f + K\\epsilon$$\n$$e^a = (I - KH)e^f + K\\epsilon$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n分析误差协方差 $P^a$ 定义为 $P^a = \\mathbb{E}[e^a (e^a)^\\top]$。\n$$P^a = \\mathbb{E}[((I - KH)e^f + K\\epsilon)((I - KH)e^f + K\\epsilon)^\\top]$$\n展开此表达式可得：\n$$P^a = \\mathbb{E}[(I-KH)e^f(e^f)^\\top(I-KH)^\\top + (I-KH)e^f\\epsilon^\\top K^\\top + K\\epsilon(e^f)^\\top(I-KH)^\\top + K\\epsilon\\epsilon^\\top K^\\top]$$\n由于先验误差 $e^f$ 和观测误差 $\\epsilon$ 是独立的且均值为零，交叉项 $\\mathbb{E}[e^f \\epsilon^\\top]$ 和 $\\mathbb{E}[\\epsilon (e^f)^\\top]$ 均为零矩阵。表达式简化为：\n$$P^a = (I-KH)\\mathbb{E}[e^f(e^f)^\\top](I-KH)^\\top + K\\mathbb{E}[\\epsilon\\epsilon^\\top]K^\\top$$\n$$P^a = (I-KH)P^f(I-KH)^\\top + KRK^\\top$$\n\n1. 最优增益 $K$ 的推导\n目标是找到使分析误差方差最小化的增益 $K$，这等价于最小化分析误差协方差矩阵 $P^a$ 的迹。成本函数为 $J(K) = \\text{tr}(P^a)$。\n$$J(K) = \\text{tr}((I-KH)P^f(I-KH)^\\top + KRK^\\top)$$\n利用迹算子的线性和循环性质 ($\\text{tr}(A+B) = \\text{tr}(A)+\\text{tr}(B)$, $\\text{tr}(ABC) = \\text{tr}(CAB)$)：\n$$J(K) = \\text{tr}(P^f - KHP^f - P^fH^\\top K^\\top + KHP^fH^\\top K^\\top + KRK^\\top)$$\n$$J(K) = \\text{tr}(P^f) - \\text{tr}(KHP^f) - \\text{tr}(P^fH^\\top K^\\top) + \\text{tr}(KHP^fH^\\top K^\\top) + \\text{tr}(KRK^\\top)$$\n由于 $\\text{tr}(A) = \\text{tr}(A^\\top)$，我们有 $\\text{tr}(P^f H^\\top K^\\top) = \\text{tr}((P^f H^\\top K^\\top)^\\top) = \\text{tr}(K H P^{f\\top}) = \\text{tr}(K H P^f)$，因为 $P^f$ 是对称的。\n$$J(K) = \\text{tr}(P^f) - 2\\text{tr}(KHP^f) + \\text{tr}(K(HP^fH^\\top + R)K^\\top)$$\n为求最小值，我们计算 $J(K)$ 对 $K$ 的导数并将其设为零。使用标准矩阵微积分恒等式 ($\\frac{\\partial}{\\partial X}\\text{tr}(AXB) = A^\\top B^\\top$ 和 $\\frac{\\partial}{\\partial X}\\text{tr}(XCX^\\top) = XC + XC^\\top$)，我们得到：\n$$\\frac{\\partial}{\\partial K} J(K) = -2 (HP^f)^\\top + K(HP^fH^\\top+R) + K(HP^fH^\\top+R)^\\top$$\n由于 $P^f$ 和 $R$ 是对称的，项 $S = HP^fH^\\top+R$ 也是对称的 ($S=S^\\top$)。因此：\n$$\\frac{\\partial}{\\partial K} J(K) = -2 P^{f\\top} H^\\top + 2K(HP^fH^\\top+R) = -2 P^f H^\\top + 2K(HP^fH^\\top+R)$$\n为求最优增益，将导数设为零：\n$$-2 P^f H^\\top + 2K(HP^fH^\\top+R) = 0$$\n$$K(HP^fH^\\top+R) = P^f H^\\top$$\n因此，最优增益为：\n$$K = P^f H^\\top (HP^fH^\\top+R)^{-1}$$\n\n2. $P^a$ 的两种等价表达式的推导\n第一种形式，称为 Joseph 稳定形式，是上面推导出的 $P^a$ 表达式，对任何增益 $K$ 都有效：\n$$P^a = (I-KH)P^f(I-KH)^\\top + KRK^\\top$$\n这种形式在数值上是稳健的，因为它保证了 $P^a$ 是对称和半正定的，因为它是两个此类矩阵之和（由于 $P^f \\ge 0$ 和 $R \\ge 0$）。\n\n第二种形式，通常称为标准形式，是通过将最优增益 $K$ 代入 $P^a$ 的表达式推导出来的。令 $S = HP^fH^\\top+R$。最优增益满足 $KS = P^fH^\\top$。\n$P^a = P^f - KHP^f - P^fH^\\top K^\\top + KHP^fH^\\top K^\\top + KRK^\\top$\n$P^a = P^f - KHP^f - (KS)^\\top K^\\top + K(HP^fH^\\top+R)K^\\top$\n由于 $S$ 是对称的，$(KS)^\\top = S^\\top K^\\top = SK^\\top$。\n$P^a = P^f - KHP^f - SK^\\top K^\\top + KSK^\\top$。这并没有简化表达式。\n我们换一条更简单的路径。\n$P^a = (I-KH)P^f(I-KH)^\\top + KRK^\\top = (I-KH)P^f - (I-KH)P^fH^\\top K^\\top + KRK^\\top$\n$= (I-KH)P^f - (P^f - KHP^f)H^\\top K^\\top + KRK^\\top$\n$= (I-KH)P^f - P^fH^\\top K^\\top + KHP^fH^\\top K^\\top + KRK^\\top$\n$= (I-KH)P^f - P^fH^\\top K^\\top + K(HP^fH^\\top+R)K^\\top$\n代入 $P^fH^\\top = KS$ 和 $S = HP^fH^\\top+R$：\n$P^a = (I-KH)P^f - (KS)^\\top K^\\top + KSK^\\top = (I-KH)P^f - SK^\\top K^\\top + KSK^\\top$。仍然不正确。\n我们从 $P^a = (I-KH)P^f - (P^fH^\\top - KHP^fH^\\top - KR)K^\\top$ 重新开始等价性证明。使用 $P^fH^\\top = K(HP^fH^\\top+R) = KHP^fH^\\top + KR$。所以，$P^fH^\\top - KHP^fH^\\top - KR = 0$。\n整个第二项消失：\n$$P^a = (I-KH)P^f$$\n这是分析误差协方差的第二个、更简单的表达式，仅当 $K$ 是最优 Kalman 增益时有效。\n\n3. 数值计算\n给定值为：\n$$P^f = \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix}, \\quad H = \\begin{bmatrix} 1  0 \\end{bmatrix}, \\quad R = 1$$\n首先，我们计算最优增益 $K$ 所需的各部分。注意 $R$ 是一个标量，$R=1$。\n$$HP^f = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix} = \\begin{bmatrix} 2  1 \\end{bmatrix}$$\n$$HP^fH^\\top = \\begin{bmatrix} 2  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 2$$\n新息协方差为 $S = HP^fH^\\top+R = 2+1 = 3$。这是一个标量，所以 $S^{-1} = \\frac{1}{3}$。\n$$P^fH^\\top = \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$$\n最优增益 $K$ 为：\n$$K = P^fH^\\top S^{-1} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} \\frac{1}{3} = \\begin{bmatrix} 2/3 \\\\ 1/3 \\end{bmatrix}$$\n现在我们使用两种形式计算 $P^a$。\n使用标准形式 $P^a = (I-KH)P^f$：\n$$KH = \\begin{bmatrix} 2/3 \\\\ 1/3 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} 2/3  0 \\\\ 1/3  0 \\end{bmatrix}$$\n$$I - KH = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} 2/3  0 \\\\ 1/3  0 \\end{bmatrix} = \\begin{bmatrix} 1/3  0 \\\\ -1/3  1 \\end{bmatrix}$$\n$$P^a = \\begin{bmatrix} 1/3  0 \\\\ -1/3  1 \\end{bmatrix} \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{3}  \\frac{1}{3} \\\\ -\\frac{2}{3}+1  -\\frac{1}{3}+3 \\end{bmatrix} = \\begin{bmatrix} 2/3  1/3 \\\\ 1/3  8/3 \\end{bmatrix}$$\n使用 Joseph 形式 $P^a = (I-KH)P^f(I-KH)^\\top + KRK^\\top$：\n$$(I-KH)^\\top = \\begin{bmatrix} 1/3  -1/3 \\\\ 0  1 \\end{bmatrix}$$\n第一项是：\n$$(I-KH)P^f(I-KH)^\\top = \\left(\\begin{bmatrix} 1/3  0 \\\\ -1/3  1 \\end{bmatrix} \\begin{bmatrix} 2  1 \\\\ 1  3 \\end{bmatrix}\\right) \\begin{bmatrix} 1/3  -1/3 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 2/3  1/3 \\\\ 1/3  8/3 \\end{bmatrix} \\begin{bmatrix} 1/3  -1/3 \\\\ 0  1 \\end{bmatrix}$$\n$$= \\begin{bmatrix} (2/3)(1/3)  (2/3)(-1/3)+1/3 \\\\ (1/3)(1/3)  (1/3)(-1/3)+8/3 \\end{bmatrix} = \\begin{bmatrix} 2/9  1/9 \\\\ 1/9  23/9 \\end{bmatrix}$$\n第二项是：\n$$KRK^\\top = \\begin{bmatrix} 2/3 \\\\ 1/3 \\end{bmatrix} (1) \\begin{bmatrix} 2/3  1/3 \\end{bmatrix} = \\begin{bmatrix} 4/9  2/9 \\\\ 2/9  1/9 \\end{bmatrix}$$\n将两项相加：\n$$P^a = \\begin{bmatrix} 2/9  1/9 \\\\ 1/9  23/9 \\end{bmatrix} + \\begin{bmatrix} 4/9  2/9 \\\\ 2/9  1/9 \\end{bmatrix} = \\begin{bmatrix} 6/9  3/9 \\\\ 3/9  24/9 \\end{bmatrix} = \\begin{bmatrix} 2/3  1/3 \\\\ 1/3  8/3 \\end{bmatrix}$$\n正如预期的那样，两种形式都得出了相同的 $P^a$ 矩阵。\n\n4. 半正定性证明\n得到的分析误差协方差矩阵为 $P^a = \\begin{bmatrix} 2/3  1/3 \\\\ 1/3  8/3 \\end{bmatrix}$。为证明这个 $2 \\times 2$ 对称矩阵是半正定的，我们必须检查其顺序主子式。对于一个矩阵 $A = \\begin{bmatrix} a  b \\\\ b  c \\end{bmatrix}$，半正定的条件是：\n1. $a \\ge 0$\n2. $\\det(A) = ac - b^2 \\ge 0$\n对于我们的矩阵 $P^a$：\n1. 第一个顺序主子式是 $P^a_{11} = 2/3$。这是正数，所以 $2/3 \\ge 0$ 成立。\n2. 第二个顺序主子式是行列式：\n$$\\det(P^a) = \\left(\\frac{2}{3}\\right)\\left(\\frac{8}{3}\\right) - \\left(\\frac{1}{3}\\right)^2 = \\frac{16}{9} - \\frac{1}{9} = \\frac{15}{9} = \\frac{5}{3}$$\n这也是正数，所以 $\\det(P^a) \\ge 0$ 成立。\n由于充要条件都满足，矩阵 $P^a$ 是半正定的（实际上是正定的，因为不等式是严格的）。\n最优增益的分量是 $K_1=2/3, K_2=1/3$。分析协方差矩阵的元素是 $P^a_{11}=2/3, P^a_{12}=1/3, P^a_{21}=1/3, P^a_{22}=8/3$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3}  \\frac{2}{3}  \\frac{1}{3}  \\frac{1}{3}  \\frac{8}{3} \\end{pmatrix}}\n$$", "id": "3421248"}, {"introduction": "最后的练习将综合预测和分析两个步骤，用以探索复杂系统中误差协方差的长期行为。通过一个精心设计的思想实验，我们将分析一个稳定与不稳定模式解耦的系统，其中观测仅对不稳定部分有效。这个练习揭示了卡尔曼滤波器所实现的精妙平衡：它利用观测来约束一个内在不稳定的模式，使其不确定性有界，同时精确追踪一个受过程噪声激发但未被直接观测的稳定模式的累积不确定性。[@problem_id:3421201]", "problem": "考虑一个状态维度为 $2$ 的离散时间线性高斯状态空间模型 (LGSSM)，其线性动力学由 $x_{k+1} = A x_k + w_k$ 给出，观测由 $y_k = H x_k + v_k$ 给出，其中 $w_k$ 和 $v_k$ 是零均值高斯随机变量，其协方差分别为 $Q$ 和 $R$。设状态转移矩阵为 $A = \\operatorname{diag}(\\lambda_{u}, \\lambda_{s})$，其中 $|\\lambda_{u}| > 1$ 且 $|\\lambda_{s}| < 1$。第一个分量对应于不稳定本征模态，第二个分量对应于稳定本征模态。构造过程噪声协方差和观测算子，使得 $Q$ 仅激励稳定模态，而 $H$ 仅观测不稳定模态。具体设置为 $Q = q_{s} e_{s} e_{s}^{\\top}$，$R = r$ 和 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$，其中 $e_{s} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，且 $q_{s} > 0$，$r > 0$。假设初始分析协方差是对角的，$P^{a}_{0} = \\operatorname{diag}(p_{u,0}, p_{s,0})$，其中 $p_{u,0} \\ge 0$ 且 $p_{s,0} \\ge 0$。\n\n从 LGSSM 和标准离散卡尔曼滤波器 (KF) 的协方差传播和更新的定义出发，分析预报协方差 $P^{f}_{k}$ 和分析协方差 $P^{a}_{k}$ 沿不稳定和稳定本征方向的演化。具体来说，推导沿每个本征方向的方差的标量递推关系，证明在这些假设下非对角协方差是否保持为零，并确定不稳定和稳定方向上分析方差的稳态极限（如果存在的话）。将两个稳态分析方差的最终答案表示为一个以 $\\lambda_{u}$、$\\lambda_{s}$、$r$ 和 $q_{s}$ 表示的闭式解析表达式。\n\n使用 $\\mathrm{pmatrix}$ 环境以行矩阵的形式提供您的最终答案，其中两个条目分别对应于不稳定和稳定的稳态分析方差。无需进行数值四舍五入。", "solution": "线性高斯状态空间模型 (LGSSM) 指定了 $x_{k+1} = A x_k + w_k$ 和 $y_k = H x_k + v_k$，其中 $w_k \\sim \\mathcal{N}(0, Q)$ 且 $v_k \\sim \\mathcal{N}(0, R)$。对于离散卡尔曼滤波器 (KF)，协方差预报和分析更新由以下经过充分检验的公式给出：\n$$\nP^{f}_{k} = A P^{a}_{k-1} A^{\\top} + Q,\n$$\n$$\nK_{k} = P^{f}_{k} H^{\\top} \\left( H P^{f}_{k} H^{\\top} + R \\right)^{-1},\n$$\n$$\nP^{a}_{k} = \\left( I - K_{k} H \\right) P^{f}_{k}.\n$$\n我们在与 $A$ 的本征模态对齐的坐标系中分析这些方程，由于 $A = \\operatorname{diag}(\\lambda_{u}, \\lambda_{s})$，这里的坐标系就是标准基。根据构造，第一个坐标对应于 $|\\lambda_{u}| > 1$ 的不稳定模态，第二个坐标对应于 $|\\lambda_{s}| < 1$ 的稳定模态。过程噪声协方差为 $Q = q_{s} e_{s} e_{s}^{\\top} = \\operatorname{diag}(0, q_{s})$，因此只有稳定模态受到过程噪声的激励。观测算子为 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$，因此只有不稳定模态被观测到。观测噪声协方差是标量 $R = r > 0$。\n\n假设 $P^{a}_{0}$ 是对角的：$P^{a}_{0} = \\operatorname{diag}(p_{u,0}, p_{s,0})$。由于 $A$ 和 $Q$ 都是对角的，预报协方差也保持对角性：\n$$\nP^{f}_{k} = \\operatorname{diag}\\!\\left( \\lambda_{u}^{2} p^{a}_{u,k-1},\\; \\lambda_{s}^{2} p^{a}_{s,k-1} + q_{s} \\right),\n$$\n其中 $p^{a}_{u,k-1}$ 和 $p^{a}_{s,k-1}$ 分别表示在步骤 $k-1$ 时不稳定和稳定方向上的分析方差。\n\n接下来，计算卡尔曼增益。当 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$ 且 $P^{f}_{k}$ 为对角阵时，我们得到\n$$\nH P^{f}_{k} H^{\\top} = p^{f}_{u,k},\n$$\n其中 $p^{f}_{u,k} = \\lambda_{u}^{2} p^{a}_{u,k-1}$。因此，\n$$\nK_{k} = P^{f}_{k} H^{\\top} \\left( p^{f}_{u,k} + r \\right)^{-1}.\n$$\n由于 $H^{\\top} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，增益向量的形式为\n$$\nK_{k} = \\begin{pmatrix} \\dfrac{p^{f}_{u,k}}{p^{f}_{u,k} + r} \\\\\n0 \\end{pmatrix}.\n$$\n因此，测量更新仅作用于不稳定坐标；稳定坐标未被观测。\n\n为了验证非对角协方差保持为零，我们可以使用简化的协方差更新公式 $P^{a}_{k} = (I - K_{k} H) P^{f}_{k}$ 或 Joseph 形式 $P^{a}_{k} = (I - K_{k} H) P^{f}_{k} (I - K_{k} H)^{\\top} + K_{k} R K_{k}^{\\top}$。由于 $P^{f}_{k}$ 是对角的，$K_{k}$ 仅在其第一个分量有非零项，而 $H$ 仅在第一个分量有非零项，因此 $(I - K_{k} H)$ 是一个下三角矩阵，其对角线元素为 $\\left(1 - \\frac{p^{f}_{u,k}}{p^{f}_{u,k} + r}\\right)$ 和 $1$，除 $(1,2)$ 位置可能非零外，其他非对角元素均为零，但由于 $H$ 只选择第一个状态，该位置也为零。将这些对角矩阵相乘会保持其对角性，而 $K_{k} R K_{k}^{\\top}$ 项仅对 $(1,1)$ 项有贡献。因此，如果 $P^{a}_{0}$ 是对角的，那么对于所有的 $k$，$P^{f}_{k}$ 和 $P^{a}_{k}$ 都将保持对角。\n\n因此，沿每个本征方向的标量方差更新如下：\n- 不稳定方向预报：\n$$\np^{f}_{u,k} = \\lambda_{u}^{2} p^{a}_{u,k-1}.\n$$\n- 不稳定方向分析：\n$$\np^{a}_{u,k} = \\left( 1 - \\frac{p^{f}_{u,k}}{p^{f}_{u,k} + r} \\right) p^{f}_{u,k} = \\frac{r\\, p^{f}_{u,k}}{p^{f}_{u,k} + r} = \\frac{r \\lambda_{u}^{2} p^{a}_{u,k-1}}{\\lambda_{u}^{2} p^{a}_{u,k-1} + r}.\n$$\n- 稳定方向预报：\n$$\np^{f}_{s,k} = \\lambda_{s}^{2} p^{a}_{s,k-1} + q_{s}.\n$$\n- 稳定方向分析 (未被观测，因此分析值等于预报值)：\n$$\np^{a}_{s,k} = p^{f}_{s,k} = \\lambda_{s}^{2} p^{a}_{s,k-1} + q_{s}.\n$$\n\n我们现在分析稳态的存在性和值。\n\n对于不稳定方向，假设存在一个稳态 $p^{a}_{u}$，使得 $p^{a}_{u,k} \\to p^{a}_{u} > 0$。在稳态下，$p^{f}_{u} = \\lambda_{u}^{2} p^{a}_{u}$ 并且\n$$\np^{a}_{u} = \\frac{r\\, p^{f}_{u}}{p^{f}_{u} + r} = \\frac{r \\lambda_{u}^{2} p^{a}_{u}}{\\lambda_{u}^{2} p^{a}_{u} + r}.\n$$\n假设 $p^{a}_{u} > 0$，我们可以用 $p^{a}_{u}$ 除以方程两边得到\n$$\n1 = \\frac{r \\lambda_{u}^{2}}{\\lambda_{u}^{2} p^{a}_{u} + r} \\quad \\Longrightarrow \\quad \\lambda_{u}^{2} p^{a}_{u} + r = r \\lambda_{u}^{2}.\n$$\n解出 $p^{a}_{u}$ 可得\n$$\np^{a}_{u} = \\frac{r \\left( \\lambda_{u}^{2} - 1 \\right)}{\\lambda_{u}^{2}}.\n$$\n由于 $|\\lambda_{u}| > 1$，我们有 $\\lambda_{u}^{2} - 1 > 0$，所以 $p^{a}_{u} > 0$。这个稳态反映了，尽管该模态是动态不稳定的，但由于该方向上没有过程噪声并且有连续观测，最终得到了一个有限的稳态分析方差。\n\n对于稳定方向，分析方差服从一个线性标量递推关系\n$$\np^{a}_{s,k} = \\lambda_{s}^{2} p^{a}_{s,k-1} + q_{s}.\n$$\n当 $|\\lambda_{s}| < 1$ 时，这有一个满足以下条件的唯一不动点 $p^{a}_{s}$\n$$\np^{a}_{s} = \\lambda_{s}^{2} p^{a}_{s} + q_{s} \\quad \\Longrightarrow \\quad p^{a}_{s} = \\frac{q_{s}}{1 - \\lambda_{s}^{2}}.\n$$\n这个不动点是正的，因为 $q_{s} > 0$ 且 $1 - \\lambda_{s}^{2} > 0$。它捕捉了不确定性的稳定衰减与未被观测的稳定模态中过程噪声的持续激励之间的平衡。\n\n总之，在这种对角设置下，当 $Q$ 仅激励稳定模态而 $H$ 仅观测不稳定模态时，非对角协方差保持为零，不稳定分析方差收敛到一个由测量噪声和不稳定因子决定的有限值，而稳定分析方差收敛到标准的过程噪声平衡值。所要求的最终闭式表达式为\n$$\np^{a}_{u} = \\frac{r \\left( \\lambda_{u}^{2} - 1 \\right)}{\\lambda_{u}^{2}}, \\qquad p^{a}_{s} = \\frac{q_{s}}{1 - \\lambda_{s}^{2}}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{r\\left(\\lambda_{u}^{2}-1\\right)}{\\lambda_{u}^{2}}  \\dfrac{q_{s}}{1-\\lambda_{s}^{2}}\\end{pmatrix}}$$", "id": "3421201"}]}