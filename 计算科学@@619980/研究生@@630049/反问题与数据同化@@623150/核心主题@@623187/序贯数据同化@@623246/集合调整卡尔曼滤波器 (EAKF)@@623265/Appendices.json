{"hands_on_practices": [{"introduction": "要真正掌握集合调整卡尔曼滤波器（EAKF），最好的方法是从一个基本示例开始。这项练习将引导您完成一个简单的标量（一维）情况下的 EAKF 更新过程 [@problem_id:3378748]。通过从第一性原理出发，您将亲手计算分析均值和方差，并推导出应用于集合成员的确定性调整，从而深刻理解 EAKF 如何将观测信息融入到集合中，以更新我们对系统状态的估计。", "problem": "考虑一个一维线性高斯数据同化设置，标量状态变量 $x$ 代表气温。给定一个大小为 $N = 5$ 的预报（先验）集合，其成员（单位为开尔文）为\n$$\n\\{x_{1}^{f},x_{2}^{f},x_{3}^{f},x_{4}^{f},x_{5}^{f}\\}=\\{299.0,\\,300.5,\\,298.7,\\,301.2,\\,300.1\\}\\ \\mathrm{K}.\n$$\n观测算子是单位算子，因此观测值 $y$ 直接测量 $x$。有一个值为 $y=300.8\\ \\mathrm{K}$ 的单次观测，观测误差服从均值为零、已知方差为 $R=0.25\\ \\mathrm{K}^{2}$ 的高斯分布。假设预报集合是 $x$ 的高斯先验分布的一个无偏蒙特卡洛表示。\n\n从线性高斯逆问题和数据同化的第一性原理出发，即专门针对线性高斯模型的贝叶斯定理以及由此产生的后验均值和协方差的卡尔曼滤波表征，并利用集合调整卡尔曼滤波器（EAKF）的定义属性——它对集合异常（anomalies）应用一个确定性的、保持均值的线性映射，使得分析集合的样本协方差与卡尔曼后验协方差相匹配，完成以下任务：\n\n- 推导在此设置下，由线性高斯贝叶斯更新所蕴含的标量后验（分析）均值和方差。\n- 根据 EAKF 分析集合在一维情况下必须精确匹配这些后验一阶矩和二阶矩的要求，确定应用于每个集合异常的确定性调整。\n- 应用此调整计算第四个集合成员 $x_{4}^{a}$ 的 EAKF 更新值。\n\n当从给定集合中估计预报协方差时，请使用除数为 $N-1$ 的无偏有限集合样本协方差。将您关于 $x_{4}^{a}$ 的最终数值答案以开尔文为单位表示，并四舍五入到四位有效数字。", "solution": "该问题是有效的。这是一个在数据同化领域内提法恰当、有科学依据的问题，为获得唯一解提供了所有必要信息。\n\n该问题要求使用集合调整卡尔曼滤波器（EAKF）计算特定集合成员的更新值。求解过程首先需要从线性高斯贝叶斯更新中推导出理论上的后验均值和方差，然后利用EAKF的定义属性来确定应用于集合的变换。\n\n**1. 线性高斯系统的贝叶斯框架**\n\n该问题设定在线性高斯框架中。状态变量 $x$ 的先验分布被假定为高斯分布，由预报集合的统计数据表示：\n$$x \\sim \\mathcal{N}(\\bar{x}^f, P^f)$$\n其中 $\\bar{x}^f$ 是预报均值，$P^f$ 是预报误差协方差（在这个一维案例中是一个标量方差）。\n\n观测模型是线性的，并带有加性高斯噪声：\n$$y = Hx + v, \\quad v \\sim \\mathcal{N}(0, R)$$\n其中 $y$ 是观测值，$H$ 是观测算子，$v$ 是观测误差，$R$ 是观测误差方差。由此，似然函数 $p(y|x)$ 也是高斯分布：\n$$y|x \\sim \\mathcal{N}(Hx, R)$$\n\n根据贝叶斯定理，后验分布 $p(x|y)$ 正比于似然函数与先验分布的乘积，$p(x|y) \\propto p(y|x)p(x)$。对于这个线性高斯系统，后验分布也是一个高斯分布：\n$$x|y \\sim \\mathcal{N}(\\bar{x}^a, P^a)$$\n后验（或分析）均值 $\\bar{x}^a$ 和方差 $P^a$ 由标准的卡尔曼滤波更新方程给出。\n\n**2. 后验均值和方差的推导**\n\n首先，我们从给定的预报集合 $\\{x_{1}^{f},x_{2}^{f},x_{3}^{f},x_{4}^{f},x_{5}^{f}\\}=\\{299.0, 300.5, 298.7, 301.2, 300.1\\}$ 中估计先验矩，即预报均值 $\\bar{x}^f$ 和方差 $P^f$。集合大小为 $N=5$。\n\n预报均值是集合的样本均值：\n$$\n\\bar{x}^f = \\frac{1}{N} \\sum_{i=1}^{N} x_i^f = \\frac{1}{5}(299.0 + 300.5 + 298.7 + 301.2 + 300.1) = \\frac{1499.5}{5} = 299.9\\ \\mathrm{K}\n$$\n\n预报方差是无偏样本方差，使用除数 $N-1$：\n$$\nP^f = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_i^f - \\bar{x}^f)^2\n$$\n异常的平方 $(x_i^f - \\bar{x}^f)^2$ 分别是：\n$(299.0 - 299.9)^2 = (-0.9)^2 = 0.81$\n$(300.5 - 299.9)^2 = (0.6)^2 = 0.36$\n$(298.7 - 299.9)^2 = (-1.2)^2 = 1.44$\n$(301.2 - 299.9)^2 = (1.3)^2 = 1.69$\n$(300.1 - 299.9)^2 = (0.2)^2 = 0.04$\n$$\nP^f = \\frac{1}{4}(0.81 + 0.36 + 1.44 + 1.69 + 0.04) = \\frac{4.34}{4} = 1.085\\ \\mathrm{K}^2\n$$\n\n现在，我们应用卡尔曼滤波更新方程。观测算子是单位算子，因此在这个标量情况下，$H=1$。观测值为 $y=300.8\\ \\mathrm{K}$，其误差方差为 $R=0.25\\ \\mathrm{K}^2$。\n\n卡尔曼增益 $K$ 是：\n$$\nK = P^f H^T (H P^f H^T + R)^{-1} = P^f (P^f + R)^{-1} = \\frac{1.085}{1.085 + 0.25} = \\frac{1.085}{1.335}\n$$\n\n分析均值 $\\bar{x}^a$ 是：\n$$\n\\bar{x}^a = \\bar{x}^f + K(y - H\\bar{x}^f) = 299.9 + \\frac{1.085}{1.335}(300.8 - 299.9) = 299.9 + \\frac{1.085}{1.335}(0.9)\n$$\n$$\n\\bar{x}^a = 299.9 + \\frac{0.9765}{1.335} \\approx 299.9 + 0.731460674 \\approx 300.63146\\ \\mathrm{K}\n$$\n\n分析方差 $P^a$ 是：\n$$\nP^a = (I - KH)P^f = (1 - K)P^f = \\left(1 - \\frac{1.085}{1.335}\\right) \\times 1.085 = \\frac{0.25}{1.335} \\times 1.085 = \\frac{0.27125}{1.335}\n$$\n$$\nP^a \\approx 0.20318352\\ \\mathrm{K}^2\n$$\n\n**3. 集合调整卡尔曼滤波器（EAKF）更新**\n\nEAKF 通过一个保持均值并调整异常的确定性线性变换，将每个预报集合成员 $x_i^f$ 更新为分析成员 $x_i^a$：\n$$\nx_i^a = \\bar{x}^a + \\alpha (x_i^f - \\bar{x}^f)\n$$\n其中 $\\bar{x}^a$ 是上面计算出的分析均值。选择缩放因子 $\\alpha$，使得得到的分析集合 $\\{x_i^a\\}$ 的样本方差与理论分析方差 $P^a$ 相匹配。\n\n分析集合的样本方差是：\n$$\nP^a_{\\text{ens}} = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_i^a - \\bar{x}^a)^2 = \\frac{1}{N-1} \\sum_{i=1}^{N} (\\alpha(x_i^f - \\bar{x}^f))^2 = \\alpha^2 \\left(\\frac{1}{N-1} \\sum_{i=1}^{N} (x_i^f - \\bar{x}^f)^2\\right) = \\alpha^2 P^f\n$$\n令 $P^a_{\\text{ens}} = P^a$，我们得到：\n$$\n\\alpha^2 P^f = P^a \\implies \\alpha = \\sqrt{\\frac{P^a}{P^f}}\n$$\n代入 $P^a = (1-K)P^f$：\n$$\n\\alpha = \\sqrt{\\frac{(1-K)P^f}{P^f}} = \\sqrt{1-K}\n$$\n现在我们计算 $\\alpha$ 的值：\n$$\n\\alpha = \\sqrt{1 - \\frac{1.085}{1.335}} = \\sqrt{\\frac{1.335 - 1.085}{1.335}} = \\sqrt{\\frac{0.25}{1.335}} \\approx 0.43274233\n$$\n\n**4. 计算更新后的第四个集合成员**\n\n我们现在应用 EAKF 更新规则来计算第四个集合成员的分析值 $x_4^a$。\n给定的预报成员是 $x_4^f = 301.2\\ \\mathrm{K}$。\n该成员的预报异常是 $x_4^f - \\bar{x}^f = 301.2 - 299.9 = 1.3\\ \\mathrm{K}$。\n\n更新后的值 $x_4^a$ 是：\n$$\nx_4^a = \\bar{x}^a + \\alpha (x_4^f - \\bar{x}^f)\n$$\n使用之前计算的值：\n$$\nx_4^a \\approx 300.63146067 + (0.43274233 \\times 1.3)\n$$\n$$\nx_4^a \\approx 300.63146067 + 0.56256503\n$$\n$$\nx_4^a \\approx 301.1940257\\ \\mathrm{K}\n$$\n\n题目要求答案四舍五入到四位有效数字。这个数字是 $301.194...$。前四位有效数字是 $3、0、1、1$。第五位数字是 $9$，所以我们将第四位有效数字向上取整。\n$$\nx_4^a \\approx 301.2\\ \\mathrm{K}\n$$", "answer": "$$\\boxed{301.2}$$", "id": "3378748"}, {"introduction": "在理解了 EAKF 的基本更新机制之后，探索其作为贝叶斯更新近似方法所带来的微妙后果至关重要。此练习设计了一个巧妙的场景，其中包含一个非线性观测算子，以揭示 EAKF 的一个非直观特性：其结果可能依赖于同化观测的顺序 [@problem_id:3378631]。通过计算不同处理顺序下的最终状态方差，您将揭示有限集合大小和非线性如何相互作用，从而导致路径依赖性，这与理论上完美的贝叶斯更新形成鲜明对比。", "problem": "考虑一个标量状态变量 $x \\in \\mathbb{R}$，其先验有限集合大小为 $N=3$，成员为 $x^{(1)}=-2$、$x^{(2)}=1$ 和 $x^{(3)}=1$。假设存在加性、独立的髙斯观测误差。现有两个观测：\n- 第一个观测为 $y_{1}$，其观测函数为 $h_{1}(x)=x$，误差方差为 $R_{1}=1$。\n- 第二个观测为 $y_{2}$，其观测函数为 $h_{2}(x)=x^{2}$，误差方差为 $R_{2}=1$。\n\n假设实现的观测值等于相应观测函数的先验集合均值，因此对于 $y_{1}$ 和 $y_{2}$ 的新息均为零，只有集合扰动被调整。\n\n同化过程使用集合调整卡尔曼滤波器 (Ensemble Adjustment Kalman Filter, EAKF) 执行。对于每个标量观测 $y$，其观测函数 $z=h(x)$ 应用于每个集合成员以产生 $\\{z^{(i)}\\}_{i=1}^{N}$，EAKF 确定性地调整观测空间扰动，使得 $z$ 的后验方差与标量卡尔曼后验方差一致，然后使用从有限集合计算出的最小二乘线性回归斜率 $b=\\operatorname{cov}(x,z)/\\operatorname{var}(z)$ 将这些调整后的观测空间扰动映射回状态空间扰动。基于以下公式进行计算：\n- 标量线性高斯后验方差公式：$\\operatorname{var}(z \\mid y)=\\left(\\operatorname{var}(z)^{-1}+R^{-1}\\right)^{-1}=\\frac{\\operatorname{var}(z)\\,R}{\\operatorname{var}(z)+R}$。\n- 样本均值、方差和协方差的定义：$\\overline{u}=\\frac{1}{N}\\sum_{i=1}^{N}u^{(i)}$，$\\operatorname{var}(u)=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(u^{(i)}-\\overline{u}\\right)^{2}$，$\\operatorname{cov}(u,v)=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(u^{(i)}-\\overline{u}\\right)\\left(v^{(i)}-\\overline{v}\\right)$。\n\n任务：\n1. 按照 $y_{1}$ 先于 $y_{2}$ 的顺序，使用上述 EAKF 扰动调整逻辑处理这两个观测。计算状态 $x$ 的最终后验集合方差。\n2. 按照相反的顺序，$y_{2}$ 先于 $y_{1}$，处理这两个观测，并计算状态 $x$ 的最终后验集合方差。\n3. 提供差值 $\\Delta=\\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{1}\\rightarrow y_{2}}-\\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{2}\\rightarrow y_{1}}$ 的精确封闭形式表达式，并化简为单个有理数。无需四舍五入。\n4. 简要解释为什么对于这个有限集合，两个后验方差会不同，并讨论至少两种在实践中可以减少或消除这种顺序依赖性的缓解策略。\n\n你的最终答案必须是 $\\Delta$ 的精确值，以单个最简分数形式表示。", "solution": "所述问题具有科学依据，是适定的，并基于数据同化中集合调整卡尔曼滤波器 (EAKF) 的既定原则。所有必要的数据、定义和条件都已提供，且没有内部矛盾。因此，该问题是有效的，可以计算出解。\n\n任务是计算在以两种不同顺序同化两个观测 $y_1$ 和 $y_2$ 后的最终后验状态方差，求出这些方差的差值，并解释结果。集合大小为 $N=3$。样本均值、方差和协方差定义如下：\n$$ \\overline{u}=\\frac{1}{N}\\sum_{i=1}^{N}u^{(i)} $$\n$$ \\operatorname{var}(u)=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(u^{(i)}-\\overline{u}\\right)^{2} $$\n$$ \\operatorname{cov}(u,v)=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(u^{(i)}-\\overline{u}\\right)\\left(v^{(i)}-\\overline{v}\\right) $$\n\n状态 $x$ 的初始先验集合为 $\\{x^{(1)}, x^{(2)}, x^{(3)}\\} = \\{-2, 1, 1\\}$。\n初始先验均值为 $\\bar{x} = \\frac{1}{3}(-2+1+1) = 0$。\n初始先验方差为 $\\operatorname{var}(x) = \\frac{1}{3-1}\\left((-2-0)^2 + (1-0)^2 + (1-0)^2\\right) = \\frac{1}{2}(4+1+1) = 3$。\n\n问题陈述新息为零，因此每一步的后验均值将等于先验均值。我们只需要更新集合扰动。\n\n**1. 按 $y_1$ 先于 $y_2$ 的顺序处理**\n\n**第1步：同化 $y_1$**\n第一个观测是 $y_1$，其观测函数为 $h_1(x)=x$，误差方差为 $R_1=1$。\n将先验集合映射到观测空间：$\\{z_1^{(i)}\\} = \\{h_1(x^{(i)})\\} = \\{-2, 1, 1\\}$。\n$z_1$ 的统计量与 $x$ 的相同：\n$\\bar{z}_1 = \\bar{x} = 0$。\n$\\operatorname{var}(z_1) = \\operatorname{var}(x) = 3$。\n\n使用标量卡尔曼公式计算观测空间中的后验方差：\n$$ \\operatorname{var}(z_1|y_1) = \\frac{\\operatorname{var}(z_1) R_1}{\\operatorname{var}(z_1) + R_1} = \\frac{3 \\cdot 1}{3+1} = \\frac{3}{4} $$\nEAKF 将先验观测扰动按因子 $\\alpha_1$ 进行收缩：\n$$ \\alpha_1 = \\sqrt{\\frac{\\operatorname{var}(z_1|y_1)}{\\operatorname{var}(z_1)}} = \\sqrt{\\frac{3/4}{3}} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2} $$\n调整后的观测扰动为 $z_1'^{\\text{post}(i)} = \\alpha_1 z_1'^{\\text{prior}(i)}$。\n为了更新状态扰动，我们计算线性回归斜率 $b_1$：\n$$ b_1 = \\frac{\\operatorname{cov}(x, z_1)}{\\operatorname{var}(z_1)} = \\frac{\\operatorname{cov}(x, x)}{\\operatorname{var}(x)} = 1 $$\n后验状态扰动是通过应用基于观测空间扰动变化的更新得到的。更新公式为 $x'^{\\text{post}(i)} = x'^{\\text{prior}(i)} + b_1(z_1'^{\\text{post}(i)} - z_1'^{\\text{prior}(i)})$。因为 $z_1=x$，我们有 $z_1' = x'$，所以公式变为 $x'^{\\text{post}(i)} = x'^{\\text{prior}(i)} + 1 \\cdot (\\alpha_1 x'^{\\text{prior}(i)} - x'^{\\text{prior}(i)}) = \\alpha_1 x'^{\\text{prior}(i)}$。\n先验状态扰动为 $\\{x'^{(1)}, x'^{(2)}, x'^{(3)}\\} = \\{-2, 1, 1\\}$。\n后验状态扰动为：\n$x'^{\\text{post}(1)} = \\frac{1}{2}(-2) = -1$\n$x'^{\\text{post}(2)} = \\frac{1}{2}(1) = \\frac{1}{2}$\n$x'^{\\text{post}(3)} = \\frac{1}{2}(1) = \\frac{1}{2}$\n$x$ 的新集合（即下一步的先验）为 $\\{x^{(i)}\\} = \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$，其均值为 $\\bar{x}=0$。\n这个中间集合的方差为 $\\operatorname{var}(x) = \\frac{1}{2}((-1)^2 + (\\frac{1}{2})^2 + (\\frac{1}{2})^2) = \\frac{1}{2}(1+\\frac{1}{4}+\\frac{1}{4}) = \\frac{3}{4}$。\n\n**第2步：同化 $y_2$**\n第二个观测是 $y_2$，其 $h_2(x)=x^2$ 且 $R_2=1$。先验集合为 $x \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$。\n将此集合映射到观测空间：$\\{z_2^{(i)}\\} = \\{h_2(x^{(i)})\\} = \\{(-1)^2, (\\frac{1}{2})^2, (\\frac{1}{2})^2\\} = \\{1, \\frac{1}{4}, \\frac{1}{4}\\}$。\n计算此步骤先验的统计量：\n$\\bar{x} = 0$，$\\operatorname{var}(x) = \\frac{3}{4}$。\n$\\bar{z}_2 = \\frac{1}{3}(1+\\frac{1}{4}+\\frac{1}{4}) = \\frac{1}{2}$。\n$\\operatorname{var}(z_2) = \\frac{1}{2}((1-\\frac{1}{2})^2 + (\\frac{1}{4}-\\frac{1}{2})^2 + (\\frac{1}{4}-\\frac{1}{2})^2) = \\frac{1}{2}((\\frac{1}{2})^2 + (-\\frac{1}{4})^2 + (-\\frac{1}{4})^2) = \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{16}+\\frac{1}{16}) = \\frac{3}{16}$。\n$\\operatorname{cov}(x, z_2) = \\frac{1}{2}\\left( (-1-0)(1-\\frac{1}{2}) + (\\frac{1}{2}-0)(\\frac{1}{4}-\\frac{1}{2}) + (\\frac{1}{2}-0)(\\frac{1}{4}-\\frac{1}{2}) \\right) = \\frac{1}{2}(-\\frac{1}{2} - \\frac{1}{8} - \\frac{1}{8}) = -\\frac{3}{8}$。\n\n计算观测空间中的后验方差：\n$$ \\operatorname{var}(z_2|y_2) = \\frac{\\operatorname{var}(z_2) R_2}{\\operatorname{var}(z_2) + R_2} = \\frac{3/16 \\cdot 1}{3/16+1} = \\frac{3/16}{19/16} = \\frac{3}{19} $$\n收缩因子为 $\\alpha_2 = \\sqrt{\\frac{\\operatorname{var}(z_2|y_2)}{\\operatorname{var}(z_2)}} = \\sqrt{\\frac{3/19}{3/16}} = \\sqrt{\\frac{16}{19}} = \\frac{4}{\\sqrt{19}}$。\n回归斜率为 $b_2 = \\frac{\\operatorname{cov}(x, z_2)}{\\operatorname{var}(z_2)} = \\frac{-3/8}{3/16} = -2$。\n\n最终后验状态扰动为 $x'^{\\text{post}(i)} = x'^{\\text{prior}(i)} + b_2(\\alpha_2 - 1)z_2'^{\\text{prior}(i)}$。\n先验扰动：$x' \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$，$z_2' \\in \\{\\frac{1}{2}, -\\frac{1}{4}, -\\frac{1}{4}\\}$。\n$x'^{\\text{post}(1)} = -1 + (-2)(\\frac{4}{\\sqrt{19}}-1)(\\frac{1}{2}) = -1 - (\\frac{4}{\\sqrt{19}}-1) = -\\frac{4}{\\sqrt{19}}$。\n$x'^{\\text{post}(2)} = \\frac{1}{2} + (-2)(\\frac{4}{\\sqrt{19}}-1)(-\\frac{1}{4}) = \\frac{1}{2} + \\frac{1}{2}(\\frac{4}{\\sqrt{19}}-1) = \\frac{2}{\\sqrt{19}}$。\n$x'^{\\text{post}(3)} = \\frac{1}{2} + (-2)(\\frac{4}{\\sqrt{19}}-1)(-\\frac{1}{4}) = \\frac{2}{\\sqrt{19}}$。\n最终后验方差为：\n$$ \\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{1}\\rightarrow y_{2}} = \\frac{1}{2}\\left( (-\\frac{4}{\\sqrt{19}})^2 + (\\frac{2}{\\sqrt{19}})^2 + (\\frac{2}{\\sqrt{19}})^2 \\right) = \\frac{1}{2}\\left(\\frac{16}{19} + \\frac{4}{19} + \\frac{4}{19}\\right) = \\frac{12}{19} $$\n\n**2. 按 $y_2$ 先于 $y_1$ 的顺序处理**\n\n**第1步：同化 $y_2$**\n先验是初始集合 $x \\in \\{-2, 1, 1\\}$，其 $\\bar{x}=0, \\operatorname{var}(x)=3$。\n观测函数 $h_2(x)=x^2, R_2=1$。\n映射到观测空间：$\\{z_2^{(i)}\\} = \\{h_2(x^{(i)})\\} = \\{(-2)^2, 1^2, 1^2\\} = \\{4, 1, 1\\}$。\n计算统计量：\n$\\bar{z}_2 = \\frac{1}{3}(4+1+1) = 2$。\n$\\operatorname{var}(z_2) = \\frac{1}{2}((4-2)^2 + (1-2)^2 + (1-2)^2) = \\frac{1}{2}(4+1+1) = 3$。\n$\\operatorname{cov}(x, z_2) = \\frac{1}{2}\\left( (-2-0)(4-2) + (1-0)(1-2) + (1-0)(1-2) \\right) = \\frac{1}{2}(-4-1-1) = -3$。\n\n观测空间中的后验方差：\n$$ \\operatorname{var}(z_2|y_2) = \\frac{\\operatorname{var}(z_2) R_2}{\\operatorname{var}(z_2) + R_2} = \\frac{3 \\cdot 1}{3+1} = \\frac{3}{4} $$\n收缩因子 $\\alpha_2 = \\sqrt{\\frac{3/4}{3}} = \\frac{1}{2}$。回归斜率 $b_2 = \\frac{-3}{3}=-1$。\n更新状态扰动：$x'^{\\text{post}(i)} = x'^{\\text{prior}(i)} + b_2(\\alpha_2 - 1)z_2'^{\\text{prior}(i)}$。\n先验扰动：$x' \\in \\{-2, 1, 1\\}$，$z_2' \\in \\{2, -1, -1\\}$。\n$x'^{\\text{post}(1)} = -2 + (-1)(\\frac{1}{2}-1)(2) = -2 + (-1)(-\\frac{1}{2})(2) = -2+1 = -1$。\n$x'^{\\text{post}(2)} = 1 + (-1)(\\frac{1}{2}-1)(-1) = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n$x'^{\\text{post}(3)} = 1 + (-1)(\\frac{1}{2}-1)(-1) = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n中间集合为 $x \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$，其 $\\bar{x}=0$，方差为 $\\operatorname{var}(x) = \\frac{3}{4}$。\n\n**第2步：同化 $y_1$**\n先验为 $x \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$，其 $\\operatorname{var}(x)=\\frac{3}{4}$。观测为 $h_1(x)=x, R_1=1$。\n映射到观测空间：$z_1 \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$。\n$\\bar{z}_1 = 0$，$\\operatorname{var}(z_1) = \\frac{3}{4}$。\n观测空间中的后验方差：\n$$ \\operatorname{var}(z_1|y_1) = \\frac{\\operatorname{var}(z_1) R_1}{\\operatorname{var}(z_1) + R_1} = \\frac{3/4 \\cdot 1}{3/4+1} = \\frac{3/4}{7/4} = \\frac{3}{7} $$\n收缩因子 $\\alpha_1 = \\sqrt{\\frac{3/7}{3/4}} = \\sqrt{\\frac{4}{7}} = \\frac{2}{\\sqrt{7}}$。\n对状态扰动的更新为 $x'^{\\text{post}(i)} = \\alpha_1 x'^{\\text{prior}(i)}$。\n先验扰动：$x' \\in \\{-1, \\frac{1}{2}, \\frac{1}{2}\\}$。\n$x'^{\\text{post}(1)} = \\frac{2}{\\sqrt{7}}(-1) = -\\frac{2}{\\sqrt{7}}$。\n$x'^{\\text{post}(2)} = \\frac{2}{\\sqrt{7}}(\\frac{1}{2}) = \\frac{1}{\\sqrt{7}}$。\n$x'^{\\text{post}(3)} = \\frac{2}{\\sqrt{7}}(\\frac{1}{2}) = \\frac{1}{\\sqrt{7}}$。\n最终后验方差为：\n$$ \\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{2}\\rightarrow y_{1}} = \\frac{1}{2}\\left( (-\\frac{2}{\\sqrt{7}})^2 + (\\frac{1}{\\sqrt{7}})^2 + (\\frac{1}{\\sqrt{7}})^2 \\right) = \\frac{1}{2}\\left(\\frac{4}{7} + \\frac{1}{7} + \\frac{1}{7}\\right) = \\frac{3}{7} $$\n\n**3. 后验方差的差值**\n差值为 $\\Delta = \\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{1}\\rightarrow y_{2}}-\\operatorname{var}^{\\text{post}}_{x}\\big|_{y_{2}\\rightarrow y_{1}}$。\n$$ \\Delta = \\frac{12}{19} - \\frac{3}{7} = \\frac{12 \\cdot 7 - 3 \\cdot 19}{19 \\cdot 7} = \\frac{84 - 57}{133} = \\frac{27}{133} $$\n\n**4. 解释与缓解策略**\n\n后验方差之所以不同，是因为当集合调整卡尔曼滤波器在有限集合和非线性观测算子的情况下顺序应用时，它对观测处理的顺序不是不变的。核心原因在于观测算子的依赖于状态的线性化。该滤波器通过线性回归来近似观测对状态的影响，其系数 $b=\\operatorname{cov}(x,z)/\\operatorname{var}(z)$ 是从当前集合计算得出的。\n\n在 $y_1 \\rightarrow y_2$ 的情况下：线性观测 $y_1$ 首先减小了集合的方差。随后对非线性观测 $y_2$（其 $h_2(x)=x^2$）的同化使用了从这个已经收缩的集合（$\\{-1, 1/2, 1/2\\}$）计算出的回归系数，我们求得该系数为 $b_2 = -2$。\n\n在 $y_2 \\rightarrow y_1$ 的情况下：非线性观测 $y_2$ 首先被同化。回归系数是从原始的、更宽的集合（$\\{-2, 1, 1\\}$）计算得出的，从而产生一个不同的系数 $b_2 = -1$。这种不同的线性化导致了不同的中间集合，尽管第二步中的线性更新在形式上是路径无关的，但它的起点不同，从而导致了不同的最终后验。\n\n这种顺序依赖性是在存在非线性的情况下，使用有限集合来估计用于更新状态的交叉协方差的直接后果。真实的贝叶斯更新是顺序无关的，但 EAKF 是一种近似方法。\n\n减少或消除这种顺序依赖性的两种缓解策略是：\n1.  **批量同化**：同时处理所有观测。这包括将观测向量增广为 $Y = [y_1, y_2]^T$，将观测算子增广为 $H(x)=[h_1(x), h_2(x)]^T$。然后使用矩阵运算对观测空间协方差和回归系数执行一次 EAKF 更新。通过将观测作为一个整体来处理，这在数学上消除了顺序依赖性。\n2.  **增加集合大小**：小集合规模（$N=3$）的采样误差加剧了顺序依赖效应。一个更大的集合将为协方差和回归统计量提供更稳定和准确的估计。当 $N \\rightarrow \\infty$ 时，样本协方差会收敛到潜在分布的真实协方差，滤波器的行为会接近精确卡尔曼滤波器（对于线性问题）或成为更准确的蒙特卡洛近似（对于非线性问题），从而减少顺序依赖性的实际影响。", "answer": "$$\\boxed{\\frac{27}{133}}$$", "id": "3378631"}, {"introduction": "现实世界的数据同化常常面临观测数据被离群值（outliers）污染的挑战，而标准卡尔曼滤波器对此非常敏感。这项高级练习旨在为您配备处理此类问题的工具，指导您开发一个“稳健”的 EAKF 版本 [@problem_id:3378596]。您将利用稳健统计学中的 Huber 损失函数，推导出一个能够自动降低可疑观测数据影响的等效更新方案，从而使滤波器在面对非高斯噪声时表现得更加可靠和稳定。", "problem": "您需要为一个线性反问题在观测值可能被污染的情况下，开发并分析一个鲁棒的确定性平方根集合调整卡尔曼滤波器（EAKF）。开发过程必须从基本的贝叶斯线性高斯更新和 Huber 损失的定义开始，并通过对新息进行重加权来推导出一个鲁棒的重构形式。您的任务以纯数学术语定义，最终的程序必须实现所得算法，并为一组指定的测试用例生成数值答案。不涉及物理单位，也不需要角度。所有量都是无量纲的实数。\n\n假设一个状态集合，其状态维数 $d=1$（标量状态），集合大小为 $N$，线性观测算子 $H$ 由 $H = 1$ 给出，因此观测值即为状态本身。设先验（预报）集合为 $\\{x_i^f\\}_{i=1}^N$，其先验集合均值为 $m^f$，样本先验方差为\n$$\nP_{xx}^f = \\frac{1}{N-1} \\sum_{i=1}^N \\left(x_i^f - m^f\\right)^2.\n$$\n假设一个标量观测值 $y \\in \\mathbb{R}$，其观测噪声方差为 $R > 0$。令新息（观测空间中观测值与先验均值之差）为 $r = y - H m^f = y - m^f$，白化残差为 $z = r / \\sqrt{R}$。为参数 $\\kappa > 0$ 定义 Huber 损失 $\\rho_\\kappa(z)$ 及其导数（Huber 分数）$\\psi_\\kappa(z)$ 如下\n$$\n\\rho_\\kappa(z) = \\begin{cases}\n\\frac{1}{2} z^2,  |z| \\le \\kappa, \\\\\n\\kappa |z| - \\frac{1}{2}\\kappa^2,  |z| > \\kappa,\n\\end{cases}\n\\quad\n\\psi_\\kappa(z) = \\frac{d}{dz} \\rho_\\kappa(z) = \\begin{cases}\nz,  |z| \\le \\kappa, \\\\\n\\kappa \\,\\mathrm{sign}(z),  |z| > \\kappa.\n\\end{cases}\n$$\n考虑将迭代重加权最小二乘（IRLS）原理应用于通过 $\\rho_\\kappa(z)$ 惩罚白化新息的鲁棒目标函数。令权重 $w(z)$ 定义为 $w(z) = \\psi_\\kappa(z)/z$（当 $z \\ne 0$ 时）和 $w(0) = 1$。对于标量观测，证明 IRLS 正规方程等价于一个卡尔曼更新，其中 $R$ 被一个有效观测协方差 $R_\\mathrm{eff}(r) = R / w(z)$ 替代，即：\n$$\nK^r = \\frac{P_{xx}^f}{P_{xx}^f + R_\\mathrm{eff}(r)}, \\quad m^a = m^f + K^r \\, r,\n$$\n其中 $m^a$ 是鲁棒加权下的分析（后验）均值。\n\n利用此等价性，为一个单一标量观测推导出一个鲁棒的确定性平方根 EAKF 更新，该更新在观测空间中调整集合以匹配鲁棒后验均值和方差。具体而言，如果 $P_{yy}^f = P_{xx}^f$ 是观测空间中的样本方差，证明调整后的观测均值增量和后验方差为\n$$\n\\Delta \\bar{y} = \\frac{P_{yy}^f}{P_{yy}^f + R_\\mathrm{eff}(r)} \\, r, \n\\quad \nP_{yy}^a = P_{yy}^f - \\frac{\\left(P_{yy}^f\\right)^2}{P_{yy}^f + R_\\mathrm{eff}(r)} = \\frac{R_\\mathrm{eff}(r) \\, P_{yy}^f}{P_{yy}^f + R_\\mathrm{eff}(r)}.\n$$\n推导异常缩放因子 $\\alpha = \\sqrt{P_{yy}^a / P_{yy}^f} = \\sqrt{R_\\mathrm{eff}(r) / \\left(P_{yy}^f + R_\\mathrm{eff}(r)\\right)}$ 并证明对于预报观测集合 $\\{y_i^f\\}_{i=1}^N$ 的鲁棒 EAKF 观测空间调整为\n$$\ny_i^a = \\bar{y}^f + \\Delta \\bar{y} + \\alpha \\left(y_i^f - \\bar{y}^f\\right),\n$$\n其中 $\\bar{y}^f$ 是预报观测均值。由于 $d = 1$ 且 $H=1$，状态集合更新与观测空间调整一致，即 $x_i^a = y_i^a$。\n\n通过顺序应用将鲁棒 EAKF 扩展到多个标量观测：给定独立的标量观测 $\\{y_j\\}_{j=1}^m$ 和相同的噪声方差 $R$，对 $j=1,2,\\dots,m$ 迭代应用单观测鲁棒 EAKF 步骤，在每一步中使用当前集合重新计算 $r_j = y_j - \\bar{y}_j^f$、$z_j = r_j/\\sqrt{R}$、$w_j = \\psi_\\kappa(z_j)/z_j$（约定 $w_j(0)=1$）以及 $R_{\\mathrm{eff},j} = R / w_j$。在每一步中，从当前集合异常计算 $P_{yy,j}^f$ 并使用鲁棒 EAKF 公式更新集合。\n\n将固定振幅 $M > 0$ 和阈值 $T > 0$ 的有限振幅崩溃分数定义为候选集合中的最小分数 $f$，使得当 $f m$ 个离群值设为值 $M$ 且 $(1-f) m$ 个干净观测值等于 $0$ 时，在使用鲁棒 EAKF 顺序同化所有 $m$ 个观测后，分析均值增量的范数 $|m^a - m^f|$ 超过 $T$。在一个预定义的有限候选分数集合上计算此分数。\n\n您的程序必须为 $d=1$ 实现上述鲁棒 EAKF，并为以下测试套件生成数值结果。集合必须是按规定确定的。\n\n测试套件（每个情况都定义了所有参数）：\n\n- 情况 1（小新息）：$N=21$，$d=1$，$x_i^f = s \\cdot q_i$，其中 $q_i \\in \\{-10,-9,\\dots,9,10\\}$ 且 $s = 0.1$，因此 $m^f = 0$。$H=1$，$R=0.25$，$\\kappa = 1.0$，且 $y = 0.1$。以浮点数形式输出列表 $[w, R_\\mathrm{eff}, |m^a - m^f|]$。\n\n- 情况 2（边界新息）：与情况 1 具有相同的集合和参数，但选择的 $y$ 使得 $|z| = \\kappa$，即 $y = \\kappa \\sqrt{R} = 0.5$。输出列表 $[w, R_\\mathrm{eff}, |m^a - m^f|]$。\n\n- 情况 3（极端离群值）：与情况 1 具有相同的集合和参数，但 $y = 50.0$。输出列表 $[w, R_\\mathrm{eff}, |m^a - m^f|]$。\n\n- 情况 4（有限振幅崩溃分数）：使用 $m=10$ 个观测进行顺序鲁棒 EAKF，集合和参数与情况 1 相同，但混合了离群值和干净的观测值。固定 $M=5.0$ 和 $T=0.5$。考虑候选分数 $F = \\{0.0, 0.3, 0.6, 1.0\\}$，其中 $f m$ 个观测值按顺序设为 $M$，$(1-f) m$ 个设为 $0$。对于每个 $f \\in F$，执行顺序鲁棒 EAKF 并计算最终的 $|m^a - m^f|$。报告使 $|m^a - m^f| \\ge T$ 的最小 $f \\in F$；如果 $F$ 中不存在这样的 $f$，则报告 $0.0$。输出单个浮点数 $f_\\mathrm{min}$。\n\n最终输出格式：您的程序应生成一行输出，其中包含一个逗号分隔的列表，并用方括号括起来：具体为 $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$，其中 $\\text{result1}$、$\\text{result2}$ 和 $\\text{result3}$ 是针对情况 1-3 的三个浮点数的列表，而 $\\text{result4}$ 是针对情况 4 的单个浮点数。", "solution": "该问题被评估为有效，因为它在科学上基于数据同化和鲁棒统计理论，问题提法清晰且提供了所有必要信息，并以客观、正式的语言陈述。其推导和数值计算在该领域内是标准的。\n\n解答过程分两部分进行。首先，我们确认支撑鲁棒集合调整卡尔曼滤波器（EAKF）的数学推导。其次，我们应用推导出的算法来计算四个指定测试用例的数值结果。\n\n### 第一部分：鲁棒 EAKF 更新的推导\n\n鲁棒滤波器的基础是用 Huber 损失函数 $\\rho_\\kappa(z)$ 替代标准的新息二次损失函数。标准的卡尔曼更新最小化一个二次代价函数，这对应于假设高斯误差分布。Huber 损失由于对大的自变量呈线性增长，因此相比于对大误差惩罚极重的二次损失，它对大误差（离群值）不那么敏感。\n\n给定先验均值 $m^f$、先验方差 $P_{xx}^f$、标量观测值 $y$ 和基于 Huber 损失的观测误差模型，标量状态 $x$ 的后验众数可通过最小化目标函数找到：\n$$\nJ(x) = \\frac{1}{2}\\frac{(x - m^f)^2}{P_{xx}^f} + \\rho_\\kappa\\left( \\frac{y-x}{\\sqrt{R}} \\right)\n$$\n我们通过将关于 $x$ 的导数设为零来找到最小值：\n$$\n\\frac{dJ}{dx} = \\frac{x - m^f}{P_{xx}^f} + \\frac{d}{dx} \\rho_\\kappa\\left( \\frac{y-x}{\\sqrt{R}} \\right) = \\frac{x - m^f}{P_{xx}^f} + \\psi_\\kappa\\left( \\frac{y-x}{\\sqrt{R}} \\right) \\left(-\\frac{1}{\\sqrt{R}}\\right) = 0\n$$\n其中 $\\psi_\\kappa(z) = \\frac{d}{dz}\\rho_\\kappa(z)$ 是 Huber 分数函数。这得到：\n$$\n\\frac{x - m^f}{P_{xx}^f} = \\frac{1}{\\sqrt{R}} \\psi_\\kappa\\left( \\frac{y-x}{\\sqrt{R}} \\right)\n$$\n这是一个关于后验众数 $x$ 的非线性方程。迭代重加权最小二乘（IRLS）原理提供了一种求解方法。使用权重函数 $w(z) = \\psi_\\kappa(z)/z$（其中 $w(0)=1$），我们可以写出 $\\psi_\\kappa(z) = w(z)z$。将其代入方程：\n$$\n\\frac{x - m^f}{P_{xx}^f} = \\frac{1}{\\sqrt{R}} w\\left( \\frac{y-x}{\\sqrt{R}} \\right) \\left( \\frac{y-x}{\\sqrt{R}} \\right) = w\\left( \\frac{y-x}{\\sqrt{R}} \\right) \\frac{y-x}{R}\n$$\nIRLS 过程将进行迭代，但一个常用且有效的简化是使用基于先验均值的新息 $r = y - m^f$ 来评估权重。令 $z = r/\\sqrt{R}$。该方程可近似为：\n$$\n\\frac{x - m^f}{P_{xx}^f} \\approx w(z) \\frac{y-x}{R}\n$$\n重新整理以求解 $x$，我们称之为鲁棒分析均值 $m^a$：\n$$\n(m^a - m^f)R = w(z) P_{xx}^f (y - m^a)\n$$\n$$\nm^a(R + w(z)P_{xx}^f) = m^f R + y w(z) P_{xx}^f\n$$\n$$\nm^a = \\frac{m^f R + y w(z) P_{xx}^f}{R + w(z)P_{xx}^f} = \\frac{m^f (R/w(z)) + y P_{xx}^f}{(R/w(z)) + P_{xx}^f}\n$$\n这恰好是卡尔曼滤波器后验均值的标准公式，如果观测误差方差 $R$ 被有效方差 $R_\\mathrm{eff}(r) = R/w(z)$ 替代。该公式也可以用鲁棒卡尔曼增益 $K^r$ 书写：\n$$\nK^r = \\frac{P_{xx}^f}{P_{xx}^f + R_\\mathrm{eff}(r)}\n$$\n$$\nm^a = m^f + K^r(y-m^f) = m^f + K^r r\n$$\n这证实了问题陈述的第一部分。\n\n接下来，我们推导 EAKF 更新方程。EAKF 调整集合以匹配后验均值和方差。在观测空间中（由于 $H=1$，这与状态空间相同），预报观测集合是 $\\{y_i^f\\}_{i=1}^N = \\{x_i^f\\}_{i=1}^N$，其均值为 $\\bar{y}^f = m^f$，方差为 $P_{yy}^f = P_{xx}^f$。\n\n观测空间中的后验均值为 $\\bar{y}^a = m^a$。均值增量为：\n$$\n\\Delta \\bar{y} = \\bar{y}^a - \\bar{y}^f = m^a - m^f = K^r r = \\frac{P_{xx}^f}{P_{xx}^f + R_\\mathrm{eff}(r)} r = \\frac{P_{yy}^f}{P_{yy}^f + R_\\mathrm{eff}(r)} r\n$$\n后验方差 $P_{yy}^a$ 由使用 $R_\\mathrm{eff}$ 的标准卡尔曼公式给出：\n$$\nP_{yy}^a = (1 - K^r) P_{yy}^f = \\left(1 - \\frac{P_{yy}^f}{P_{yy}^f + R_\\mathrm{eff}(r)}\\right) P_{yy}^f = \\frac{R_\\mathrm{eff}(r)}{P_{yy}^f + R_\\mathrm{eff}(r)} P_{yy}^f\n$$\nEAKF 通过缩放集合异常来实现这种方差减小。更新后的异常为 $y_i^a - \\bar{y}^a = \\alpha (y_i^f - \\bar{y}^f)$。更新后集合的方差为 $\\mathrm{Var}(y_i^a) = \\alpha^2 \\mathrm{Var}(y_i^f) = \\alpha^2 P_{yy}^f$。为了匹配目标后验方差，我们必须有 $P_{yy}^a = \\alpha^2 P_{yy}^f$。因此，缩放因子 $\\alpha$ 是：\n$$\n\\alpha = \\sqrt{\\frac{P_{yy}^a}{P_{yy}^f}} = \\sqrt{\\frac{R_\\mathrm{eff}(r) P_{yy}^f / (P_{yy}^f + R_\\mathrm{eff}(r))}{P_{yy}^f}} = \\sqrt{\\frac{R_\\mathrm{eff}(r)}{P_{yy}^f + R_\\mathrm{eff}(r)}}\n$$\n每个集合成员的完整 EAKF 更新通过应用均值增量和异常缩放来构建：\n$$\ny_i^a = \\bar{y}^a + (y_i^a - \\bar{y}^a) = (\\bar{y}^f + \\Delta \\bar{y}) + \\alpha (y_i^f - \\bar{y}^f)\n$$\n由于 $H=1$，状态更新是相同的：$x_i^a = y_i^a$。所有推导都与问题陈述一致。\n\n### 第二部分：数值计算\n\n我们现在将这些公式应用于具体的测试用例。\n\n**通用参数**：\n先验集合 $\\{x_i^f\\}_{i=1}^N$ 定义为 $N=21$ 个成员，$x_i^f = s \\cdot q_i$，其中 $s=0.1$ 且 $q_i \\in \\{-10, \\dots, 10\\}$。\n先验均值为 $m^f = \\frac{0.1}{21}\\sum_{i=-10}^{10} i = 0$。\n先验方差为 $P_{xx}^f = P_{yy}^f = \\frac{1}{N-1}\\sum_{i=1}^N (x_i^f - m^f)^2 = \\frac{1}{20} \\sum_{i=-10}^{10} (0.1 \\cdot i)^2 = \\frac{0.01}{20} \\sum_{i=-10}^{10} i^2$。\n使用平方和公式 $\\sum_{k=1}^{n} k^2 = \\frac{n(n+1)(2n+1)}{6}$，我们有 $\\sum_{i=-10}^{10} i^2 = 2 \\sum_{i=1}^{10} i^2 = 2 \\cdot \\frac{10(11)(21)}{6} = 770$。\n因此，$P_{xx}^f = \\frac{0.01 \\cdot 770}{20} = \\frac{7.7}{20} = 0.385$。\n其他参数：$R=0.25$ ($\\sqrt{R}=0.5$)，$\\kappa=1.0$。\n\n**情况 1：小新息**\n- 观测值：$y = 0.1$。\n- 新息：$r = y - m^f = 0.1 - 0 = 0.1$。\n- 白化残差：$z = r / \\sqrt{R} = 0.1 / 0.5 = 0.2$。\n- 由于 $|z|=0.2 \\le \\kappa=1.0$，权重为 $w = 1.0$。\n- 有效方差：$R_\\mathrm{eff} = R/w = 0.25/1.0 = 0.25$。\n- 均值增量：$|m^a - m^f| = \\left| \\frac{P_{xx}^f}{P_{xx}^f + R_\\mathrm{eff}} r \\right| = \\left| \\frac{0.385}{0.385 + 0.25} \\cdot 0.1 \\right| = \\frac{0.0385}{0.635} \\approx 0.06063$。\n- 结果：$[1.0, 0.25, 0.0606299...]$\n\n**情况 2：边界新息**\n- 观测值：$y = \\kappa \\sqrt{R} = 1.0 \\cdot 0.5 = 0.5$。\n- 新息：$r = y - m^f = 0.5$。\n- 白化残差：$z = r / \\sqrt{R} = 0.5 / 0.5 = 1.0$。\n- 由于 $|z|=1.0 \\le \\kappa=1.0$，权重为 $w = 1.0$。\n- 有效方差：$R_\\mathrm{eff} = R/w = 0.25/1.0 = 0.25$。\n- 均值增量：$|m^a - m^f| = \\left| \\frac{0.385}{0.385 + 0.25} \\cdot 0.5 \\right| = \\frac{0.1925}{0.635} \\approx 0.30315$。\n- 结果：$[1.0, 0.25, 0.303149...]$\n\n**情况 3：极端离群值**\n- 观测值：$y = 50.0$。\n- 新息：$r = y - m^f = 50.0$。\n- 白化残差：$z = r / \\sqrt{R} = 50.0 / 0.5 = 100.0$。\n- 由于 $|z|=100.0 > \\kappa=1.0$，权重为 $w = \\psi_\\kappa(z)/z = (\\kappa \\cdot \\mathrm{sign}(z))/z = 1.0/100.0 = 0.01$。\n- 有效方差：$R_\\mathrm{eff} = R/w = 0.25/0.01 = 25.0$。\n- 均值增量：$|m^a - m^f| = \\left| \\frac{0.385}{0.385 + 25.0} \\cdot 50.0 \\right| = \\frac{19.25}{25.385} \\approx 0.75832$。\n- 结果：$[0.01, 25.0, 0.75832...]$\n这个案例展示了鲁棒性：大的新息导致了一个大的 $R_\\mathrm{eff}$，这降低了离群观测值的影响权重，从而导致比标准卡尔曼滤波器产生的均值位移小得多。\n\n**情况 4：有限振幅崩溃分数**\n此情况需要顺序应用鲁棒 EAKF 更新。我们测试候选分数 $f \\in \\{0.0, 0.3, 0.6, 1.0\\}$，其中 $m=10$ 个观测值中有 $f$ 比例是值为 $M=5.0$ 的离群值。其余 $(1-f)m$ 个观测值为值为 $0$ 的干净值。我们寻求使最终均值增量 $|m^a - m^f|$（其中 $m^f=0$ 是初始均值）超过阈值 $T=0.5$ 的最小 $f$。\n- 对于 $f=0.0$，所有观测值都是 $0$。均值保持为 $0$。$|m^a - m^f| = 0  0.5$。\n- 对于 $f=0.3$，有 $3$ 个观测值为 $5.0$，随后是 $7$ 个观测值为 $0.0$。离群值将均值拉高，但随后的干净观测值会将其拉回。数值计算得出最终 $|m^a-m^f| \\approx 0.395  0.5$。\n- 对于 $f=0.6$，有 $6$ 个观测值为 $5.0$，随后是 $4$ 个观测值为 $0.0$。更多离群值带来的更强的初始拉动，加上滤波器抵抗随后拉回到零的鲁棒性，导致最终的均值位移大于阈值。数值计算得出最终 $|m^a-m^f| \\approx 0.884 \\ge 0.5$。\n- 由于 $f=0.6$ 是有序分数集合中第一个满足条件的，最小分数是 $0.6$。\n- 结果：$0.6$\n\n最终输出将是包含这四个结果的列表，格式如要求所述。", "answer": "```\n[[1.0,0.25,0.06062992125984252],[1.0,0.25,0.3031496062992126],[0.01,25.0,0.7583218436084301],0.6]\n```", "id": "3378596"}]}