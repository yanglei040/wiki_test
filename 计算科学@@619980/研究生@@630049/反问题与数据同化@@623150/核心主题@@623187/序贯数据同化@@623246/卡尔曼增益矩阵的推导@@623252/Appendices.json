{"hands_on_practices": [{"introduction": "卡尔曼滤波最引人入胜的特点之一是它能够更新未直接观测的状态量。本练习将揭示其背后的奥秘：只要状态之间存在相关性，对一个状态的测量就能减少另一个未测量状态的不确定性。我们将通过一个具体的二维系统 [@problem_id:779302]，推导并量化这种通过相关性实现的信息增益，从而深入理解协方差矩阵在信息融合中的关键作用。", "problem": "考虑一个二维系统，其状态由向量 $x = [x_1, x_2]^T$ 描述。我们有该状态的先验估计 $\\hat{x}^{-}$，以及相关的先验误差协方差矩阵 $P^{-}$。该矩阵由下式给出：\n$$\nP^{-} = \\begin{pmatrix} \\sigma_1^2 & \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2 & \\sigma_2^2 \\end{pmatrix}\n$$\n其中，$\\sigma_1^2$ 和 $\\sigma_2^2$ 分别是状态分量 $x_1$ 和 $x_2$ 的先验方差，$\\rho$ 是它们之间的相关系数。\n\n获得单个测量值 $z$，它是仅对第一个状态分量 $x_1$ 的带噪声观测。测量模型是线性的：\n$$\nz = Hx + v\n$$\n其中 $H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$，$v$ 是零均值测量噪声，其方差为 $R = \\sigma_v^2$。\n\n使用卡尔曼滤波器测量更新方程来获得后验状态估计 $\\hat{x}^{+}$ 及其协方差 $P^{+}$：\n1. 卡尔曼增益：$K = P^{-} H^T (H P^{-} H^T + R)^{-1}$\n2. 后验协方差：$P^{+} = (I - KH)P^{-}$\n\n对 $x_1$ 的测量不仅减小了我们对 $x_1$ 估计的不确定性，而且在 $x_1$ 和 $x_2$ 相关（$\\rho \\neq 0$）的情况下，也减小了我们对未测量状态 $x_2$ 估计的不确定性。\n\n定义参数 $\\gamma = \\sigma_1^2 / \\sigma_v^2$，它表示已测量状态的先验方差与测量噪声方差之比。\n\n推导未测量状态分量 $x_2$ 的后验方差与其先验方差的比率表达式。也就是说，找到用 $\\rho$ 和 $\\gamma$ 表示 $\\frac{P_{22}^{+}}{P_{22}^{-}}$ 的表达式。", "solution": "目标是计算未测量状态的后验方差 $P_{22}^{+}$ 与其先验方差 $P_{22}^{-}$ 的比率。先验方差由先验协方差矩阵 $P^{-}$ 的 (2,2) 元素给出，即 $P_{22}^{-} = \\sigma_2^2$。\n\n我们首先计算卡尔曼增益 $K$。卡尔曼增益计算的各部分如下：\n状态到测量矩阵为 $H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$，因此其转置为 $H^T = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n先验协方差矩阵为 $P^{-} = \\begin{pmatrix} \\sigma_1^2 & \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2 & \\sigma_2^2 \\end{pmatrix}$。\n测量噪声协方差为 $R = \\sigma_v^2$。\n\n首先，我们计算项 $P^{-}H^T$：\n$$\nP^{-}H^T = \\begin{pmatrix} \\sigma_1^2 & \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2 & \\sigma_2^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_1^2 \\\\ \\rho \\sigma_1 \\sigma_2 \\end{pmatrix}\n$$\n\n接下来，我们计算新息协方差 $S = H P^{-} H^T + R$：\n$$\nH P^{-} H^T = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} \\sigma_1^2 \\\\ \\rho \\sigma_1 \\sigma_2 \\end{pmatrix} = \\sigma_1^2\n$$\n因此，新息协方差为 $S = \\sigma_1^2 + \\sigma_v^2$。由于这是一个标量，其逆为 $S^{-1} = \\frac{1}{\\sigma_1^2 + \\sigma_v^2}$。\n\n现在我们可以计算卡尔曼增益 $K$：\n$$\nK = P^{-}H^T S^{-1} = \\begin{pmatrix} \\sigma_1^2 \\\\ \\rho \\sigma_1 \\sigma_2 \\end{pmatrix} \\frac{1}{\\sigma_1^2 + \\sigma_v^2} = \\frac{1}{\\sigma_1^2 + \\sigma_v^2} \\begin{pmatrix} \\sigma_1^2 \\\\ \\rho \\sigma_1 \\sigma_2 \\end{pmatrix}\n$$\n\n有了卡尔曼增益，我们可以求出后验协方差矩阵 $P^{+} = (I - KH)P^{-}$。\n首先，我们计算项 $(I - KH)$：\n$$\nKH = \\frac{1}{\\sigma_1^2 + \\sigma_v^2} \\begin{pmatrix} \\sigma_1^2 \\\\ \\rho \\sigma_1 \\sigma_2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\frac{1}{\\sigma_1^2 + \\sigma_v^2} \\begin{pmatrix} \\sigma_1^2 & 0 \\\\ \\rho \\sigma_1 \\sigma_2 & 0 \\end{pmatrix}\n$$\n$$\nI - KH = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\frac{1}{\\sigma_1^2 + \\sigma_v^2} \\begin{pmatrix} \\sigma_1^2 & 0 \\\\ \\rho \\sigma_1 \\sigma_2 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{\\sigma_1^2}{\\sigma_1^2 + \\sigma_v^2} & 0 \\\\ -\\frac{\\rho \\sigma_1 \\sigma_2}{\\sigma_1^2 + \\sigma_v^2} & 1 \\end{pmatrix}\n$$\n化简 (1,1) 元素：\n$$\n1 - \\frac{\\sigma_1^2}{\\sigma_1^2 + \\sigma_v^2} = \\frac{\\sigma_1^2 + \\sigma_v^2 - \\sigma_1^2}{\\sigma_1^2 + \\sigma_v^2} = \\frac{\\sigma_v^2}{\\sigma_1^2 + \\sigma_v^2}\n$$\n因此，\n$$\nI - KH = \\begin{pmatrix} \\frac{\\sigma_v^2}{\\sigma_1^2 + \\sigma_v^2} & 0 \\\\ -\\frac{\\rho \\sigma_1 \\sigma_2}{\\sigma_1^2 + \\sigma_v^2} & 1 \\end{pmatrix}\n$$\n\n现在我们计算后验协方差矩阵 $P^{+}$：\n$$\nP^{+} = (I - KH)P^{-} = \\begin{pmatrix} \\frac{\\sigma_v^2}{\\sigma_1^2 + \\sigma_v^2} & 0 \\\\ -\\frac{\\rho \\sigma_1 \\sigma_2}{\\sigma_1^2 + \\sigma_v^2} & 1 \\end{pmatrix} \\begin{pmatrix} \\sigma_1^2 & \\rho \\sigma_1 \\sigma_2 \\\\ \\rho \\sigma_1 \\sigma_2 & \\sigma_2^2 \\end{pmatrix}\n$$\n我们关心的是 $P^{+}$ 的 (2,2) 元素，即 $P_{22}^{+}$：\n$$\nP_{22}^{+} = \\left(-\\frac{\\rho \\sigma_1 \\sigma_2}{\\sigma_1^2 + \\sigma_v^2}\\right) (\\rho \\sigma_1 \\sigma_2) + (1)(\\sigma_2^2)\n$$\n$$\nP_{22}^{+} = \\sigma_2^2 - \\frac{\\rho^2 \\sigma_1^2 \\sigma_2^2}{\\sigma_1^2 + \\sigma_v^2}\n$$\n\n问题要求比率 $\\frac{P_{22}^{+}}{P_{22}^{-}}$。我们知道 $P_{22}^{-} = \\sigma_2^2$。\n$$\n\\frac{P_{22}^{+}}{P_{22}^{-}} = \\frac{\\sigma_2^2 - \\frac{\\rho^2 \\sigma_1^2 \\sigma_2^2}{\\sigma_1^2 + \\sigma_v^2}}{\\sigma_2^2} = 1 - \\frac{\\rho^2 \\sigma_1^2}{\\sigma_1^2 + \\sigma_v^2}\n$$\n最后，我们代入参数 $\\gamma = \\sigma_1^2 / \\sigma_v^2$。为此，我们可以将分数的分子和分母同除以 $\\sigma_v^2$：\n$$\n\\frac{P_{22}^{+}}{P_{22}^{-}} = 1 - \\frac{\\rho^2 (\\sigma_1^2 / \\sigma_v^2)}{(\\sigma_1^2 / \\sigma_v^2) + (\\sigma_v^2 / \\sigma_v^2)} = 1 - \\frac{\\rho^2 \\gamma}{\\gamma + 1}\n$$", "answer": "$$\n\\boxed{1 - \\frac{\\rho^2 \\gamma}{1 + \\gamma}}\n$$", "id": "779302"}, {"introduction": "实际系统通常配备多个传感器同时提供数据，这就要求我们将卡尔曼滤波框架扩展到能处理联合测量的情形。本练习 [@problem_id:2753313] 将带领我们回归第一性原理，运用线性最小均方误差（LMMSE）估计的正交性原则，为堆叠的测量模型推导最优的联合卡尔曼增益和后验协方差。通过这个从理论推导到数值计算的完整过程，你将掌握处理多维观测数据融合的核心技能。", "problem": "考虑一个用于线性高斯状态估计问题的卡尔曼滤波器的单次测量更新步骤。设先验状态被建模为一个随机向量 $x \\in \\mathbb{R}^{2}$，其先验均值为 $\\hat{x}^{-} \\in \\mathbb{R}^{2}$，先验协方差为 $P \\in \\mathbb{R}^{2 \\times 2}$。根据线性模型同时获得两个独立的测量值\n$$\ny_{1} = H_{1} x + v_{1}, \\quad y_{2} = H_{2} x + v_{2},\n$$\n其中 $H_{1} \\in \\mathbb{R}^{1 \\times 2}$，$H_{2} \\in \\mathbb{R}^{1 \\times 2}$ 是测量矩阵，而 $v_{1} \\sim \\mathcal{N}(0, R_{1})$，$v_{2} \\sim \\mathcal{N}(0, R_{2})$ 是相互独立的零均值高斯噪声，与 $x$ 独立，其协方差分别为 $R_{1} \\in \\mathbb{R}$ 和 $R_{2} \\in \\mathbb{R}$。将测量值堆叠为 $y = \\begin{bmatrix} y_{1} \\\\ y_{2} \\end{bmatrix}$，对应的堆叠测量矩阵为 $H \\in \\mathbb{R}^{2 \\times 2}$，块对角噪声协方差为 $R \\in \\mathbb{R}^{2 \\times 2}$。仅使用联合高斯变量的线性最小均方误差 (LMMSE) 估计的基本原理——即正交性原理和条件高斯性质——推导联合最优线性更新 $ \\hat{x}^{+} = \\hat{x}^{-} + K (y - H \\hat{x}^{-})$ 的表达式，确定最优联合卡尔曼增益 $K \\in \\mathbb{R}^{2 \\times 2}$，并用 $P$、$H$ 和 $R$ 推导相应的后验协方差 $P^{+} \\in \\mathbb{R}^{2 \\times 2}$。\n\n然后，针对以下特定数值情况计算这些表达式：\n$$\nP = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix}, \\quad H_{1} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad R_{1} = 1, \\quad H_{2} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}, \\quad R_{2} = 4,\n$$\n其中 $v_{1}$ 和 $v_{2}$ 相互独立，且与 $x$ 独立。计算此数值实例的联合卡尔曼增益 $K$ 和后验协方差 $P^{+}$。\n\n您最终报告的答案必须是单个标量：后验协方差 $P^{+}$ 的行列式。无需四舍五入。", "solution": "**卡尔曼滤波器更新方程的推导**\n\n给定一个具有联合高斯变量的线性系统。状态 $x$ 具有先验分布，其均值为 $\\mathbb{E}[x] = \\hat{x}^{-}$，协方差为 $\\text{cov}(x) = P$。测量模型被堆叠成一个单一的方程：\n$$y = Hx + v$$\n其中 $y = \\begin{bmatrix} y_1 \\\\ y_2 \\end{bmatrix}$，$H = \\begin{bmatrix} H_1 \\\\ H_2 \\end{bmatrix}$，以及 $v = \\begin{bmatrix} v_1 \\\\ v_2 \\end{bmatrix}$。噪声 $v$ 是零均值的，$\\mathbb{E}[v] = 0$，其协方差为 $R = \\mathbb{E}[vv^T]$。由于 $v_1$ 和 $v_2$ 是独立的，$R$ 是块对角的：\n$$R = \\begin{bmatrix} R_1 & 0 \\\\ 0 & R_2 \\end{bmatrix}$$\n噪声 $v$ 与状态 $x$ 独立。在给定测量值 $y$ 的条件下，$x$ 的最优 LMMSE 估计（记为 $\\hat{x}^{+}$）是条件均值 $\\mathbb{E}[x|y]$。问题指定了线性估计器的形式：\n$$\\hat{x}^{+} = \\hat{x}^{-} + K(y - H\\hat{x}^{-})$$\n向量 $\\tilde{y} = y - H\\hat{x}^{-}$ 是测量新息。最优增益矩阵 $K$ 是通过应用正交性原理求得的，该原理指出后验估计误差 $e^{+} = x - \\hat{x}^{+}$ 必须与新息 $\\tilde{y}$ 正交。\n$$\\mathbb{E}[e^{+} \\tilde{y}^T] = 0$$\n首先，我们用先验误差 $e^{-} = x - \\hat{x}^{-}$ 和噪声 $v$ 来表示误差 $e^{+}$ 和新息 $\\tilde{y}$。\n新息为：\n$$\\tilde{y} = y - H\\hat{x}^{-} = (Hx + v) - H\\hat{x}^{-} = H(x - \\hat{x}^{-}) + v = He^{-} + v$$\n后验误差为：\n$$e^{+} = x - \\hat{x}^{+} = x - (\\hat{x}^{-} + K\\tilde{y}) = (x - \\hat{x}^{-}) - K\\tilde{y} = e^{-} - K(He^{-} + v) = (I - KH)e^{-} - Kv$$\n现在，应用正交性条件：\n$$\\mathbb{E}[((I - KH)e^{-} - Kv)(He^{-} + v)^T] = 0$$\n展开表达式：\n$$\\mathbb{E}[(I - KH)e^{-}(e^{-})^T H^T + (I - KH)e^{-}v^T - Kve^{-T}H^T - Kvv^T] = 0$$\n先验误差 $e^{-}$ 具有零均值，并且与测量噪声 $v$ 不相关。因此，$\\mathbb{E}[e^{-}v^T] = 0$ 且 $\\mathbb{E}[ve^{-T}] = 0$。协方差为 $\\mathbb{E}[e^{-}(e^{-})^T] = P$ 和 $\\mathbb{E}[vv^T] = R$。方程简化为：\n$$(I - KH)\\mathbb{E}[e^{-}(e^{-})^T]H^T - K\\mathbb{E}[vv^T] = 0$$\n$$(I - KH)PH^T - KR = 0$$\n$$PH^T - K H P H^T - KR = 0$$\n$$PH^T = K(H P H^T + R)$$\n求解增益 $K$，假设新息协方差矩阵 $S = H P H^T + R$ 是可逆的：\n$$K = P H^T (H P H^T + R)^{-1}$$\n这就是最优卡尔曼增益的表达式。\n\n接下来，我们推导后验协方差 $P^{+} = \\mathbb{E}[e^{+}(e^{+})^T]$。\n$$P^{+} = \\mathbb{E}[((I - KH)e^{-} - Kv)((I - KH)e^{-} - Kv)^T]$$\n展开并利用 $e^{-}$ 和 $v$ 的不相关性：\n$$P^{+} = \\mathbb{E}[(I - KH)e^{-}(e^{-})^T(I - KH)^T] + \\mathbb{E}[Kvv^T K^T]$$\n$$P^{+} = (I - KH) \\mathbb{E}[e^{-}(e^{-})^T] (I - KH)^T + K \\mathbb{E}[vv^T] K^T$$\n$$P^{+} = (I - KH) P (I - KH)^T + K R K^T$$\n这是协方差更新的 Joseph 形式。一个更简单的形式是：\n$$P^{+} = (I - KH)P$$\n这就是所需的后验协方差表达式。\n\n**数值计算**\n\n给定具体数值：\n$$P = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix}, \\quad H_{1} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad R_{1} = 1, \\quad H_{2} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}, \\quad R_{2} = 4$$\n首先，我们构造堆叠测量矩阵 $H$ 和堆叠噪声协方差矩阵 $R$：\n$$H = \\begin{bmatrix} H_1 \\\\ H_2 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = I_2$$\n$$R = \\begin{bmatrix} R_1 & 0 \\\\ 0 & R_2 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix}$$\n现在，我们计算卡尔曼增益 $K = P H^T (H P H^T + R)^{-1}$。\n当 $H = I_2$ 时，这简化为 $K = P (P + R)^{-1}$。\n新息协方差 $S = P+R$ 是：\n$$S = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} + \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix} = \\begin{bmatrix} 4 & 0 \\\\ 0 & 6 \\end{bmatrix}$$\n$S$ 的逆矩阵是：\n$$S^{-1} = \\begin{bmatrix} 4 & 0 \\\\ 0 & 6 \\end{bmatrix}^{-1} = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{6} \\end{bmatrix}$$\n现在我们计算卡尔曼增益 $K$：\n$$K = P S^{-1} = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{6} \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{2}{6} \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{1}{3} \\end{bmatrix}$$\n接下来，我们计算后验协方差 $P^{+} = (I - KH)P$。\n当 $H = I_2$ 时，即为 $P^{+} = (I - K)P$。\n$$I - K = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{1}{3} \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{3}{4} & 0 \\\\ 0 & 1 - \\frac{1}{3} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{2}{3} \\end{bmatrix}$$\n$$P^{+} = (I - K)P = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{2}{3} \\end{bmatrix} \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}$$\n后验协方差矩阵为 $P^{+} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}$。\n\n问题要求计算后验协方差的行列式，$\\det(P^{+})$。\n由于 $P^{+}$ 是一个对角矩阵，其行列式是对角元素的乘积。\n$$\\det(P^{+}) = \\det\\left(\\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}\\right) = \\left(\\frac{3}{4}\\right) \\times \\left(\\frac{4}{3}\\right) = 1$$\n行列式恰好为 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2753313"}, {"introduction": "为了深刻理解卡尔曼增益的本质，一个有效的方法是探究其在极端情况下的表现。本练习 [@problem_id:2912316] 将引导我们进行一个思想实验：当测量变得“完美”，即测量噪声协方差 $R_k$ 趋近于零时，滤波器会发生什么？通过分析滤波器更新方程的极限行为，我们将揭示卡尔曼增益是如何权衡先验信念与新数据的，并理解当面对确定性信息时，滤波器如何强制执行由测量定义的约束。", "problem": "考虑一个离散时间线性高斯状态空间模型，在时间 $k$ 由下式给出\n$$\nx_k = F_k x_{k-1} + w_{k-1}, \\quad y_k = H_k x_k + v_k,\n$$\n其中 $x_k \\in \\mathbb{R}^n$，$y_k \\in \\mathbb{R}^m$，$w_{k-1} \\sim \\mathcal{N}(0,Q_k)$ 且 $Q_k \\succeq 0$，$v_k \\sim \\mathcal{N}(0,R_k)$ 且 $R_k \\succeq 0$。假设 $w_{k-1}$ 和 $v_k$ 相互独立，且与 $x_{k-1}$ 独立。假设在时间 $k$ 有一个先验高斯分布，其均值为 $\\hat x_{k|k-1}$，协方差为 $P_{k|k-1} \\succ 0$。令 $H_k \\in \\mathbb{R}^{m \\times n}$ 为满行秩，$m \\le n$，并假设 $H_k P_{k|k-1} H_k^\\top$ 是正定的。\n\n你感兴趣的是，当测量噪声协方差趋于零时，离散时间卡尔曼滤波器的行为，即 $R_k = \\epsilon R_{0,k}$，其中 $\\epsilon \\to 0^+$ 且 $R_{0,k} \\succ 0$ 为固定值。考虑在同一时间 $k$，这对卡尔曼增益 $K_k$、更新后的状态估计 $\\hat x_{k|k}$ 和更新后的协方差 $P_{k|k}$ 的极限行为。在所述假设下，选择唯一正确描述此极限的选项。\n\nA. 当 $R_k \\to 0$ 时，有 $K_k \\to P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1}$，更新后的估计满足 $H_k \\hat x_{k|k} = y_k$，并且 $P_{k|k} \\to P_{k|k-1} - P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1} H_k P_{k|k-1}$。\n\nB. 当 $R_k \\to 0$ 时，有 $K_k \\to 0$，因为新息协方差收缩，所以滤波器忽略测量值并信任预测值。\n\nC. 当 $R_k \\to 0$ 时，有 $\\hat x_{k|k} \\to y_k$（与 $H_k$ 无关）且 $P_{k|k} \\to 0$。\n\nD. 当 $R_k \\to 0$ 时，有 $\\|K_k\\| \\to \\infty$，因此由于病态求逆，更新变得无定义。\n\nE. 当 $R_k \\to 0$ 时，有 $P_{k|k} = P_{k|k-1}$，因为在协方差更新中与 $R_k$ 成比例的项消失了。", "solution": "问题要求当测量噪声协方差 $R_k$ 趋近于零矩阵时，卡尔曼滤波器更新步骤的极限行为。时间 $k$ 的标准卡尔曼滤波器更新方程为：\n新息协方差：\n$$ S_k = H_k P_{k|k-1} H_k^\\top + R_k $$\n卡尔曼增益：\n$$ K_k = P_{k|k-1} H_k^\\top S_k^{-1} = P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top + R_k)^{-1} $$\n更新后的状态估计：\n$$ \\hat x_{k|k} = \\hat x_{k|k-1} + K_k (y_k - H_k \\hat x_{k|k-1}) $$\n更新后的误差协方差：\n$$ P_{k|k} = (I - K_k H_k) P_{k|k-1} $$\n\n给定 $R_k = \\epsilon R_{0,k}$，其中 $R_{0,k} \\succ 0$ 是一个固定的正定矩阵，且 $\\epsilon \\to 0^+$。问题还指出 $P_{k|k-1} \\succ 0$ 且 $H_k$ 具有满行秩 $m \\le n$。这意味着矩阵 $H_k P_{k|k-1} H_k^\\top$ 是正定的，因此是可逆的。我们将此矩阵表示为 $\\Sigma_k \\equiv H_k P_{k|k-1} H_k^\\top$。\n\n首先，我们分析卡尔曼增益 $K_k$ 的极限。\n$$ \\lim_{\\epsilon \\to 0^+} K_k = \\lim_{\\epsilon \\to 0^+} P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top + \\epsilon R_{0,k})^{-1} $$\n由于矩阵求逆在可逆矩阵空间上是连续操作，且 $\\Sigma_k = H_k P_{k|k-1} H_k^\\top$ 是可逆的，我们可以将极限移到求逆内部：\n$$ \\lim_{\\epsilon \\to 0^+} K_k = P_{k|k-1} H_k^\\top \\left(\\lim_{\\epsilon \\to 0^+} (H_k P_{k|k-1} H_k^\\top + \\epsilon R_{0,k})\\right)^{-1} $$\n$$ \\lim_{\\epsilon \\to 0^+} K_k = P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1} $$\n我们将这个极限增益表示为 $K_k^*$。\n\n接下来，我们分析极限更新状态估计的性质，$\\hat x_{k|k}^* = \\lim_{\\epsilon \\to 0^+} \\hat x_{k|k}$。\n$$ \\hat x_{k|k}^* = \\hat x_{k|k-1} + K_k^* (y_k - H_k \\hat x_{k|k-1}) $$\n我们通过在方程左侧乘以 $H_k$ 来检验量 $H_k \\hat x_{k|k}^*$：\n$$ H_k \\hat x_{k|k}^* = H_k \\hat x_{k|k-1} + H_k K_k^* (y_k - H_k \\hat x_{k|k-1}) $$\n我们来计算项 $H_k K_k^*$：\n$$ H_k K_k^* = H_k \\left( P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1} \\right) = (H_k P_{k|k-1} H_k^\\top) (H_k P_{k|k-1} H_k^\\top)^{-1} = I_m $$\n其中 $I_m$ 是 $m \\times m$ 的单位矩阵。将此结果代回：\n$$ H_k \\hat x_{k|k}^* = H_k \\hat x_{k|k-1} + I_m (y_k - H_k \\hat x_{k|k-1}) = H_k \\hat x_{k|k-1} + y_k - H_k \\hat x_{k|k-1} = y_k $$\n这表明，在完美测量的极限情况下，更新后的状态估计完美地满足了测量方程。\n\n最后，我们分析更新后误差协方差的极限，$P_{k|k}^* = \\lim_{\\epsilon \\to 0^+} P_{k|k}$。\n使用公式 $P_{k|k} = (I - K_k H_k) P_{k|k-1}$：\n$$ P_{k|k}^* = \\lim_{\\epsilon \\to 0^+} (I - K_k H_k) P_{k|k-1} = (I - K_k^* H_k) P_{k|k-1} $$\n展开 $P_{k|k-1}$，我们得到：\n$$ P_{k|k}^* = P_{k|k-1} - K_k^* H_k P_{k|k-1} $$\n代入 $K_k^*$ 的表达式：\n$$ P_{k|k}^* = P_{k|k-1} - \\left( P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1} \\right) H_k P_{k|k-1} $$\n这个表达式表示在完美地融入了来自测量的所有信息后的残余协方差。不确定性在 $H_k$ 可观测的方向上被消除了。\n\n现在让我们根据我们的推导来评估每个选项。\n\nA. 当 $R_k \\to 0$ 时，有 $K_k \\to P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1}$，更新后的估计满足 $H_k \\hat x_{k|k} = y_k$，并且 $P_{k|k} \\to P_{k|k-1} - P_{k|k-1} H_k^\\top (H_k P_{k|k-1} H_k^\\top)^{-1} H_k P_{k|k-1}$。\n我们的推导证实了这个陈述的所有三个部分。\n- $K_k$ 的极限是正确的。\n- 极限估计 $\\hat x_{k|k}^*$ 的性质是正确的。\n- $P_{k|k}$ 的极限是正确的。\n因此，这个选项是 **正确的**。\n\nB. 当 $R_k \\to 0$ 时，有 $K_k \\to 0$，因为新息协方差收缩，所以滤波器忽略测量值并信任预测值。\n这是不正确的。新息协方差 $S_k = H_k P_{k|k-1} H_k^\\top + R_k$ 收敛于 $H_k P_{k|k-1} H_k^\\top$，这是一个非零正定矩阵。卡尔曼增益 $K_k$ 收敛到一个非零矩阵 $K_k^*$，而不是零矩阵。物理上的解释也相反：当 $R_k \\to 0$ 时，测量变得无限可信，因此滤波器会*更多*地依赖它，而不是更少。在相反的情况下，即 $R_k \\to \\infty$ 时，滤波器才会忽略测量（$K_k \\to 0$）。因此，这个选项是 **不正确的**。\n\nC. 当 $R_k \\to 0$ 时，有 $\\hat x_{k|k} \\to y_k$（与 $H_k$ 无关）且 $P_{k|k} \\to 0$。\n第一个论断，$\\hat x_{k|k} \\to y_k$，在维度上是不一致的，除非 $n=m$。状态估计 $\\hat x_{k|k}$ 在 $\\mathbb{R}^n$ 中，而测量 $y_k$ 在 $\\mathbb{R}^m$ 中。正确的关系是 $H_k \\hat x_{k|k}^* = y_k$。第二个论断，$P_{k|k} \\to 0$，仅在 $m=n$（且 $H_k$ 可逆）时才成立。如果 $m  n$，测量只提供了关于状态的 $m$ 维子空间的信息。在剩下的 $n-m$ 维中的不确定性没有被消除，所以 $P_{k|k}^*$ 是一个秩为 $n-m$ 的非零奇异矩阵。因此，这个选项是 **不正确的**。\n\nD. 当 $R_k \\to 0$ 时，有 $\\|K_k\\| \\to \\infty$，因此由于病态求逆，更新变得无定义。\n这是错误的。卡尔曼增益公式中的求逆是针对矩阵 $S_k = H_k P_{k|k-1} H_k^\\top + R_k$。当 $R_k \\to 0$ 时，该矩阵收敛于 $H_k P_{k|k-1} H_k^\\top$，根据问题假设，这是一个正定且可逆的矩阵。求逆在极限情况下是良定义的，并且极限增益的范数 $\\|K_k^*\\|$ 是有限的。在这个公式中，矩阵 $R_k$ 本身没有被求逆。因此，这个选项是 **不正确的**。\n\nE. 当 $R_k \\to 0$ 时，有 $P_{k|k} = P_{k|k-1}$，因为在协方差更新中与 $R_k$ 成比例的项消失了。\n这反映了对协方差更新的严重误解。这意味着没有从测量中获得任何信息，而这种情况发生在 $K_k = 0$ 时。在这里，$K_k$ 在极限情况下是非零的。当测量噪声为无穷大（$R_k \\to \\infty$）而不是零时，$P_{k|k} = P_{k|k-1}$ 才成立。虽然在协方差更新的Joseph形式中，$P_{k|k} = (I - K_k H_k) P_{k|k-1} (I - K_k H_k)^\\top + K_k R_k K_k^\\top$，$K_k R_k K_k^\\top$ 项确实消失了，但协方差的主要减少来自第一项，因为 $(I - K_k H_k)$ 不是单位矩阵。因此，这个选项是 **不正确的**。\n\n基于这一全面的分析，只有选项A是正确的。", "answer": "$$\\boxed{A}$$", "id": "2912316"}]}