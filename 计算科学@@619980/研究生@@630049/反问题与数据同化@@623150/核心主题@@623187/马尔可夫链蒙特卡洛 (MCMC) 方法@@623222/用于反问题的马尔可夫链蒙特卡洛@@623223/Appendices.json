{"hands_on_practices": [{"introduction": "Metropolis-Hastings 算法是许多 MCMC 方法的核心引擎。它通过计算后验概率的比率来决定是否接受一个提议的移动，从而确保马尔可夫链最终能够有效地探索目标分布。本练习将通过一个非高斯似然函数的具体实例，引导你逐步计算接受概率，从而清晰地展示贝叶斯原理如何转化为算法中的一个具体计算步骤 [@problem_id:3400306]。", "problem": "考虑一个线性逆问题，其中观测数据向量 $y \\in \\mathbb{R}^{2}$ 通过一个正演算子 $G \\in \\mathbb{R}^{2 \\times 2}$ 和加性噪声与未知参数向量 $x \\in \\mathbb{R}^{2}$ 相关联，即 $y = G x + \\varepsilon$。假设噪声分量 $\\varepsilon_{i}$ 独立同分布，服从均值为零、尺度参数 $b > 0$ 已知的 Laplace 分布，因此每个分量的密度为 $p(\\varepsilon_{i}) = \\frac{1}{2 b} \\exp\\!\\big(-|\\varepsilon_{i}|/b\\big)$。假设先验为高斯分布 $x \\sim \\mathcal{N}(m, C)$，其中 $m \\in \\mathbb{R}^{2}$ 且 $C \\in \\mathbb{R}^{2 \\times 2}$ 是对称正定矩阵。您将使用贝叶斯后验分布构建一个带有对称随机游走提议的 Metropolis–Hastings (MH) 步骤。\n\n使用以下具体设定：\n- $G = \\begin{pmatrix} 2  -1 \\\\ 0.5  1 \\end{pmatrix}$,\n- $y = \\begin{pmatrix} 1.2 \\\\ -0.3 \\end{pmatrix}$,\n- $b = 0.25$,\n- $m = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$,\n- $C = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix}$,\n- 当前状态 $x^{(k)} = \\begin{pmatrix} 0.2 \\\\ -0.4 \\end{pmatrix}$，\n- 提议状态 $x' = \\begin{pmatrix} 0.5 \\\\ -0.7 \\end{pmatrix}$，\n- 提议是对称的，即 $q(x' \\mid x^{(k)}) = q(x^{(k)} \\mid x')$。\n\n任务：\n1. 从 Laplace 密度和 $\\varepsilon_{i}$ 的独立性出发，推导依赖于数据的负对数似然 $\\Phi(x)$（定义可相差一个不依赖于 $x$ 的加性常数），然后对给定值进行数值计算，求出 $\\Phi(x^{(k)})$ 和 $\\Phi(x')$。\n2. 使用 Bayes 法则和高斯先验，定义先验势 $\\Psi(x) = \\frac{1}{2} (x - m)^{\\top} C^{-1} (x - m)$，并推导 Metropolis–Hastings 接受率 $r = \\frac{\\pi(x' \\mid y)}{\\pi(x^{(k)} \\mid y)}$ 关于 $\\Phi$ 和 $\\Psi$ 的显式表达式。对给定值进行数值计算，求出 $r$ 并计算接受概率 $\\alpha = \\min\\{1, r\\}$。\n\n将最终的接受概率 $\\alpha$ 表示为小数，并四舍五入到四位有效数字。不需要单位。", "solution": "用户提供了一个定义明确的贝叶斯逆问题，并要求计算特定状态转移的 Metropolis-Hastings 接受概率。该问题在科学上和数学上是合理的、自洽的，并且提供了所有必要的数据和定义。我们开始进行解答。\n\n### 任务 1：负对数似然\n\n问题指明，噪声分量 $\\varepsilon_i$ 独立同分布，服从均值为零、尺度参数为 $b$ 的 Laplace 分布。单个噪声分量的概率密度为 $p(\\varepsilon_i) = \\frac{1}{2b}\\exp(-|\\varepsilon_i|/b)$。由于独立性，噪声向量 $\\varepsilon = \\begin{pmatrix} \\varepsilon_1  \\varepsilon_2 \\end{pmatrix}^\\top$ 的联合概率密度是各个密度的乘积：\n$$ p(\\varepsilon) = p(\\varepsilon_1) p(\\varepsilon_2) = \\left(\\frac{1}{2b}\\exp\\left(-\\frac{|\\varepsilon_1|}{b}\\right)\\right) \\left(\\frac{1}{2b}\\exp\\left(-\\frac{|\\varepsilon_2|}{b}\\right)\\right) = \\frac{1}{4b^2}\\exp\\left(-\\frac{|\\varepsilon_1| + |\\varepsilon_2|}{b}\\right) $$\n用 $L_1$ 范数表示，其中 $\\|\\varepsilon\\|_1 = |\\varepsilon_1| + |\\varepsilon_2|$，则为：\n$$ p(\\varepsilon) = \\frac{1}{4b^2}\\exp\\left(-\\frac{\\|\\varepsilon\\|_1}{b}\\right) $$\n似然函数 $p(y|x)$ 是给定参数 $x$ 时观测值 $y$ 的概率密度。这等价于噪声 $\\varepsilon = y - Gx$ 的概率密度：\n$$ p(y|x) = \\frac{1}{4b^2}\\exp\\left(-\\frac{\\|y - Gx\\|_1}{b}\\right) $$\n负对数似然为 $-\\ln(p(y|x))$：\n$$ -\\ln(p(y|x)) = -\\ln\\left(\\frac{1}{4b^2}\\right) - \\ln\\left(\\exp\\left(-\\frac{\\|y - Gx\\|_1}{b}\\right)\\right) = \\ln(4b^2) + \\frac{1}{b}\\|y - Gx\\|_1 $$\n问题将负对数似然 $\\Phi(x)$ 定义为可相差一个不依赖于 $x$ 的加性常数。因此，我们可以省略 $\\ln(4b^2)$ 项，并将 $\\Phi(x)$ 定义为：\n$$ \\Phi(x) = \\frac{1}{b}\\|y - Gx\\|_1 $$\n现在我们为当前状态 $x^{(k)}$ 和提议状态 $x'$ 计算 $\\Phi(x)$ 的值。给定的值为 $G = \\begin{pmatrix} 2  -1 \\\\ 0.5  1 \\end{pmatrix}$，$y = \\begin{pmatrix} 1.2 \\\\ -0.3 \\end{pmatrix}$，$b = 0.25$，$x^{(k)} = \\begin{pmatrix} 0.2 \\\\ -0.4 \\end{pmatrix}$，以及 $x' = \\begin{pmatrix} 0.5 \\\\ -0.7 \\end{pmatrix}$。\n\n对于当前状态 $x^{(k)}$：\n$$ Gx^{(k)} = \\begin{pmatrix} 2  -1 \\\\ 0.5  1 \\end{pmatrix} \\begin{pmatrix} 0.2 \\\\ -0.4 \\end{pmatrix} = \\begin{pmatrix} 2(0.2) - 1(-0.4) \\\\ 0.5(0.2) + 1(-0.4) \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ -0.3 \\end{pmatrix} $$\n$$ y - Gx^{(k)} = \\begin{pmatrix} 1.2 \\\\ -0.3 \\end{pmatrix} - \\begin{pmatrix} 0.8 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ 0 \\end{pmatrix} $$\n$$ \\|y - Gx^{(k)}\\|_1 = |0.4| + |0| = 0.4 $$\n$$ \\Phi(x^{(k)}) = \\frac{1}{0.25} \\|y - Gx^{(k)}\\|_1 = 4 \\times 0.4 = 1.6 $$\n\n对于提议状态 $x'$：\n$$ Gx' = \\begin{pmatrix} 2  -1 \\\\ 0.5  1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.7 \\end{pmatrix} = \\begin{pmatrix} 2(0.5) - 1(-0.7) \\\\ 0.5(0.5) + 1(-0.7) \\end{pmatrix} = \\begin{pmatrix} 1.7 \\\\ -0.45 \\end{pmatrix} $$\n$$ y - Gx' = \\begin{pmatrix} 1.2 \\\\ -0.3 \\end{pmatrix} - \\begin{pmatrix} 1.7 \\\\ -0.45 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ 0.15 \\end{pmatrix} $$\n$$ \\|y - Gx'\\|_1 = |-0.5| + |0.15| = 0.5 + 0.15 = 0.65 $$\n$$ \\Phi(x') = \\frac{1}{0.25} \\|y - Gx'\\|_1 = 4 \\times 0.65 = 2.6 $$\n\n### 任务 2：先验势和接受概率\n\n先验势由 $\\Psi(x) = \\frac{1}{2}(x - m)^{\\top}C^{-1}(x - m)$ 给出。先验均值为 $m = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，先验协方差为 $C = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix}$。协方差矩阵的逆为：\n$$ C^{-1} = \\begin{pmatrix} 1^{-1}  0 \\\\ 0  4^{-1} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0.25 \\end{pmatrix} $$\n当 $m = 0$ 时，先验势简化为 $\\Psi(x) = \\frac{1}{2}x^{\\top}C^{-1}x$。对于 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$：\n$$ \\Psi(x) = \\frac{1}{2} \\begin{pmatrix} x_1  x_2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  0.25 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\frac{1}{2}(x_1^2 + 0.25x_2^2) $$\n我们为 $x^{(k)}$ 和 $x'$ 计算 $\\Psi(x)$ 的值。\n\n对于当前状态 $x^{(k)} = \\begin{pmatrix} 0.2 \\\\ -0.4 \\end{pmatrix}$：\n$$ \\Psi(x^{(k)}) = \\frac{1}{2}((0.2)^2 + 0.25(-0.4)^2) = \\frac{1}{2}(0.04 + 0.25(0.16)) = \\frac{1}{2}(0.04 + 0.04) = 0.04 $$\n\n对于提议状态 $x' = \\begin{pmatrix} 0.5 \\\\ -0.7 \\end{pmatrix}$：\n$$ \\Psi(x') = \\frac{1}{2}((0.5)^2 + 0.25(-0.7)^2) = \\frac{1}{2}(0.25 + 0.25(0.49)) = \\frac{1}{2}(0.25 + 0.1225) = \\frac{1}{2}(0.3725) = 0.18625 $$\n\n根据 Bayes 法则，后验分布 $\\pi(x|y)$ 与似然和先验的乘积成正比：$\\pi(x|y) \\propto p(y|x)p(x)$。用负势表示，$p(y|x) \\propto \\exp(-\\Phi(x))$ 且 $p(x) \\propto \\exp(-\\Psi(x))$。因此：\n$$ \\pi(x|y) \\propto \\exp(-\\Phi(x))\\exp(-\\Psi(x)) = \\exp(-(\\Phi(x) + \\Psi(x))) $$\n对于对称提议分布，Metropolis-Hastings 接受率 $r$ 是后验概率的比值：\n$$ r = \\frac{\\pi(x'|y)}{\\pi(x^{(k)}|y)} = \\frac{\\exp(-(\\Phi(x') + \\Psi(x')))}{\\exp(-(\\Phi(x^{(k)}) + \\Psi(x^{(k)})))} = \\exp((\\Phi(x^{(k)}) + \\Psi(x^{(k)})) - (\\Phi(x') + \\Psi(x'))) $$\n代入我们计算出的数值：\n$$ \\Phi(x^{(k)}) = 1.6 \\quad , \\quad \\Psi(x^{(k)}) = 0.04 $$\n$$ \\Phi(x') = 2.6 \\quad , \\quad \\Psi(x') = 0.18625 $$\n$r$ 的指数为：\n$$ (1.6 + 0.04) - (2.6 + 0.18625) = 1.64 - 2.78625 = -1.14625 $$\n所以，接受率为：\n$$ r = \\exp(-1.14625) \\approx 0.31780517 $$\n接受概率 $\\alpha$ 定义为 $\\alpha = \\min\\{1, r\\}$。由于 $r  1$：\n$$ \\alpha = r = \\exp(-1.14625) \\approx 0.31780517 $$\n按要求四舍五入到四位有效数字，得到 $\\alpha \\approx 0.3178$。", "answer": "$$\n\\boxed{0.3178}\n$$", "id": "3400306"}, {"introduction": "生成一系列样本仅仅是 MCMC 分析的第一步，我们还必须评估其统计效率。MCMC 链中的样本是自相关的，而积分自相关时间（$\\tau_{\\mathrm{int}}$）正是量化这种相关性影响的关键指标，它告诉我们“等效”的独立样本数量。本练习从第一性原理出发推导 $\\tau_{\\mathrm{int}}$，使你能够深入理解如何诊断 MCMC 的性能，并为后验估计计算准确的不确定性 [@problem_id:3400386]。", "problem": "考虑一个线性高斯逆问题，其中未知参数场为 $u \\in \\mathbb{R}^{d}$，数据为 $y \\in \\mathbb{R}^{m}$，正演算子为 $A \\in \\mathbb{R}^{m \\times d}$，以及加性噪声 $y = A u + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, \\Gamma_{\\eta})$ 且 $u \\sim \\mathcal{N}(m_{0}, \\Gamma_{0})$。使用马尔可夫链蒙特卡洛（MCMC）方法从给定 $y$ 的 $u$ 的后验分布中采样。考虑一个标量摘要 $f(u)$，例如线性泛函 $f(u) = \\ell^{\\top} u$，其中 $\\ell \\in \\mathbb{R}^{d}$。假设 $f(u)$ 的马尔可夫链是严格平稳和遍历的，并且为了分析目的，可以近似为一个一阶高斯自回归过程 $\\text{AR}(1)$，其自回归参数为 $\\phi \\in (-1,1)$：\n$$\nx_{n} = \\phi \\, x_{n-1} + \\epsilon_{n}, \\quad \\epsilon_{n} \\sim \\mathcal{N}(0, \\sigma_{\\epsilon}^{2}), \\quad n \\geq 1,\n$$\n其中 $x_{n} := f(u_{n})$ 表示处于平稳状态的马尔可夫链上的标量摘要。\n\n已知对于所考虑的链，自回归系数为 $\\phi = 0.75$，平稳方差 $\\mathrm{Var}(x_{n}) = \\sigma_{x}^{2}$ 是有限且为正的。从相关平稳序列的自协方差和样本均值方差的基本定义出发，并且不假设任何目标公式：\n\n1. 定义链上标量摘要 $f(u)$ 的滞后-$k$ 自相关函数，并在 $\\text{AR}(1)$ 近似下，推导滞后-$k$ 自相关函数关于 $\\phi$ 的精确表达式。\n\n2. 从平稳相关序列的样本均值 $\\bar{x}_{N} = \\frac{1}{N} \\sum_{n=1}^{N} x_{n}$ 的方差出发，推导积分自相关时间（记为 $\\tau_{\\mathrm{int}}$）的概念，使得对于大的 $N$，$\\bar{x}_{N}$ 的方差可以写成 $\\mathrm{Var}(\\bar{x}_{N}) \\approx \\sigma_{x}^{2} \\, \\tau_{\\mathrm{int}} / N$，并用滞后-$k$ 自相关表示 $\\tau_{\\mathrm{int}}$。\n\n3. 基于无偏样本自协方差\n$$\n\\hat{\\gamma}_{k} := \\frac{1}{N-k} \\sum_{n=1}^{N-k} \\big(x_{n} - \\bar{x}_{N}\\big)\\big(x_{n+k} - \\bar{x}_{N}\\big), \\quad k \\geq 0,\n$$\n样本自相关 $\\hat{\\rho}_{k} := \\hat{\\gamma}_{k}/\\hat{\\gamma}_{0}$，以及一个紧支集窗函数 $w_{k}$（例如 Bartlett 窗 $w_{k} := 1 - \\frac{k}{m+1}$ for $0 \\leq k \\leq m$ and $w_{k} := 0$ for $k > m$，其中 $m$ 是一个截断滞后，其选择是 $N$ 的函数），提出一个用于 $\\tau_{\\mathrm{int}}$ 的有限样本、偏差校正的估计量。推导相应的加窗估计量 $\\hat{\\tau}_{\\mathrm{int}}^{\\mathrm{win}}$，并定性解释与朴素的非加窗求和相比，这种方法如何减少有限样本偏差。\n\n最后，对于给定的 $\\phi = 0.75$，计算 $\\text{AR}(1)$ 近似所蕴含的 $\\tau_{\\mathrm{int}}$ 的精确值。你的最终答案必须是一个实数值，不需要四舍五入。不应使用单位。", "solution": "该问题经验证是自洽的、有科学依据且定义明确的。它展示了一个标准但详细的练习，内容涉及马尔可夫链蒙特卡洛（MCMC）输出的统计分析，这对于 MCMC 在逆问题中的严谨应用至关重要。我们接下来进行解答，该解答分为三个要求的推导，最后是数值计算。\n\n设 $\\{x_n\\}_{n=1}^N$ 是来自平稳 MCMC 运行的标量摘要 $f(u_n)$ 的序列。该过程被假设为严格平稳和遍历的，其均值为 $E[x_n] = \\mu$，方差为有限值 $\\mathrm{Var}(x_n) = \\sigma_x^2$。为了计算协方差和相关性，我们可以分析中心化过程 $x'_n = x_n - \\mu$，其均值为零，这样做不失一般性。下文中，为简化表示，我们将假设 $\\mu=0$。\n\n**1. AR(1) 过程的滞后-$k$ 自相关**\n\n平稳过程 $\\{x_n\\}$ 的滞后-$k$ 自协方差函数 $\\gamma_k$ 定义为相隔 $k$ 个时间步长的观测值之间的协方差：\n$$\n\\gamma_k := \\mathrm{Cov}(x_n, x_{n+k}) = E[x_n x_{n+k}]\n$$\n滞后-$k$ 自相关函数 $\\rho_k$ 是归一化的自协方差：\n$$\n\\rho_k := \\frac{\\gamma_k}{\\gamma_0} = \\frac{\\mathrm{Cov}(x_n, x_{n+k})}{\\mathrm{Var}(x_n)}\n$$\n其中 $\\gamma_0 = \\mathrm{Var}(x_n) = \\sigma_x^2$。\n\n我们已知该过程可近似为一个一阶高斯自回归过程 AR($1$)：\n$$\nx_n = \\phi x_{n-1} + \\epsilon_n, \\quad \\epsilon_n \\sim \\mathcal{N}(0, \\sigma_{\\epsilon}^2)\n$$\n其中噪声项 $\\epsilon_n$ 是独立同分布的，并且也独立于该过程的过去值，即对于 $j0$ 有 $E[x_{n-j} \\epsilon_n] = 0$。\n\n为了求得 $\\gamma_k$，我们将 $x_{n+k}$ 的 AR($1$) 方程两边乘以 $x_n$ 并取期望：\n$$\nE[x_n x_{n+k}] = E[x_n (\\phi x_{n+k-1} + \\epsilon_{n+k})] = \\phi E[x_n x_{n+k-1}] + E[x_n \\epsilon_{n+k}]\n$$\n对于 $k  0$，$x_n$ 是直到时间 $n$ 的噪声项的函数，因此它独立于 $\\epsilon_{n+k}$。于是 $E[x_n \\epsilon_{n+k}] = E[x_n]E[\\epsilon_{n+k}] = 0$。这就得出了 AR($1$) 过程的 Yule-Walker 方程：\n$$\n\\gamma_k = \\phi \\gamma_{k-1}, \\quad \\text{for } k \\geq 1\n$$\n这是一个递归关系。从 $k=1$ 开始，我们得到 $\\gamma_1 = \\phi \\gamma_0$。对于 $k=2$，$\\gamma_2 = \\phi \\gamma_1 = \\phi^2 \\gamma_0$。通过归纳法，通解为：\n$$\n\\gamma_k = \\phi^k \\gamma_0, \\quad \\text{for } k \\geq 0\n$$\n两边除以 $\\gamma_0$，我们得到滞后-$k$ 自相关：\n$$\n\\rho_k = \\frac{\\gamma_k}{\\gamma_0} = \\phi^k\n$$\n\n**2. 积分自相关时间的推导**\n\n序列的样本均值为 $\\bar{x}_N = \\frac{1}{N} \\sum_{n=1}^{N} x_n$。我们首先推導其方差：\n$$\n\\mathrm{Var}(\\bar{x}_N) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{n=1}^{N} x_n\\right) = \\frac{1}{N^2} \\mathrm{Var}\\left(\\sum_{n=1}^{N} x_n\\right)\n$$\n利用协方差算子的线性性：\n$$\n\\mathrm{Var}(\\bar{x}_N) = \\frac{1}{N^2} \\sum_{n=1}^{N} \\sum_{m=1}^{N} \\mathrm{Cov}(x_n, x_m)\n$$\n由于平稳性，$\\mathrm{Cov}(x_n, x_m) = \\gamma_{|n-m|}$。我们可以通过将具有相同滞后 $k = |n-m|$ 的项分组来重写双重求和：\n$$\n\\sum_{n=1}^{N} \\sum_{m=1}^{N} \\gamma_{|n-m|} = N\\gamma_0 + \\sum_{k=1}^{N-1} 2(N-k) \\gamma_k\n$$\n因子 $2(N-k)$ 是在 $N \\times N$ 索引网格中满足 $|n-m|=k$ 的对 $(n,m)$ 的数量。将此代回方差表达式：\n$$\n\\mathrm{Var}(\\bar{x}_N) = \\frac{1}{N^2} \\left[ N\\gamma_0 + 2 \\sum_{k=1}^{N-1} (N-k) \\gamma_k \\right]\n$$\n提出 $N\\gamma_0$：\n$$\n\\mathrm{Var}(\\bar{x}_N) = \\frac{\\gamma_0}{N} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\frac{N-k}{N} \\frac{\\gamma_k}{\\gamma_0} \\right] = \\frac{\\sigma_x^2}{N} \\left[ 1 + 2 \\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right) \\rho_k \\right]\n$$\n对于大量的样本 $N$，以及自相关 $\\rho_k$ 衰减足够快的過程，该求和可以被近似。对于 $k \\ll N$，项 $(1 - k/N) \\approx 1$。如果级数收敛，我们可以将极限扩展到无穷大：\n$$\n\\mathrm{Var}(\\bar{x}_N) \\approx \\frac{\\sigma_x^2}{N} \\left( 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k \\right) \\quad \\text{for large } N\n$$\n积分自相关时间 $\\tau_{\\mathrm{int}}$ 定义为满足 $\\mathrm{Var}(\\bar{x}_N) \\approx \\frac{\\sigma_x^2 \\tau_{\\mathrm{int}}}{N}$。将此定义与我们推导的近似值进行比较，我们确定 $\\tau_{\\mathrm{int}}$ 为：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k\n$$\n这个量将相关序列样本均值的方差与相同长度的独立同分布 (i.i.d.) 序列样本均值的方差联系起来。有效样本大小通常定义为 $N_{\\mathrm{eff}} = N/\\tau_{\\mathrm{int}}$。\n\n**3. $\\tau_{\\mathrm{int}}$ 的有限样本加窗估计量**\n\n在实践中，$\\tau_{\\mathrm{int}}$ 必须从长度为 $N$ 的有限样本中估计。一个朴素的估计量会截断无穷级数并代入样本自相关：$\\hat{\\tau}_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{m} \\hat{\\rho}_k$。这个估计量具有高方差，因为样本自相关 $\\hat{\\rho}_k$ 本身就是带噪声的估计，特别是对于大的 $k$。求和可能会被这种噪声主导，导致对 $\\tau_{\\mathrm{int}}$ 的估计很差，甚至为负值。\n\n一个更好的方法是使用加窗的、偏差校正的估计量。我们给定了无偏样本自协方差估计量：\n$$\n\\hat{\\gamma}_{k} := \\frac{1}{N-k} \\sum_{n=1}^{N-k} \\big(x_{n} - \\bar{x}_{N}\\big)\\big(x_{n+k} - \\bar{x}_{N}\\big)\n$$\n相应的样本自相关是 $\\hat{\\rho}_{k} := \\hat{\\gamma}_{k} / \\hat{\\gamma}_{0}$。$\\tau_{\\mathrm{int}}$ 的加窗估计量是通过用一个衰减到零的窗函数 $w_k$ 对样本自相关进行加权来构造的。这减少了带噪声的高滞后项的贡献。\n加窗估计量的一般形式是：\n$$\n\\hat{\\tau}_{\\mathrm{int}}^{\\mathrm{win}} = 1 + 2 \\sum_{k=1}^{N-1} w_k \\hat{\\rho}_k\n$$\n使用指定的 Bartlett 窗，$w_k = 1 - \\frac{k}{m+1}$ for $0 \\leq k \\leq m$ and $w_k=0$ for $k > m$，估计量变为：\n$$\n\\hat{\\tau}_{\\mathrm{int}}^{\\mathrm{win}} = 1 + 2 \\sum_{k=1}^{m} \\left(1 - \\frac{k}{m+1}\\right) \\hat{\\rho}_k\n$$\n这里，$m$ 是一个截断滞后，选择时满足 $m \\ll N$。\n\n加窗过程减少了估计量的有限样本偏差和方差。朴素求和 $\\sum_{k=1}^m \\hat{\\rho}_k$ 具有正偏差，因为 $\\hat{\\rho}_k$ 项中的噪声不会平均为零，并且会累积。通过对不确定性最大的较大 $k$ 值的 $\\hat{\\rho}_k$ 进行降权，窗函数系统地减小了最终估计的方差。虽然这引入了确定性偏差（通过将权重从单位1改变），但它通常会导致估计量的均方误差大幅降低。特别是 Bartlett 窗，它对应于一种特定的谱密度估计方法，并保证了对 $\\tau_{\\mathrm{int}}$ 的非负估计，这是一个物理上必需的属性。\n\n**最终计算**\n\n我们需要计算具有 $\\phi = 0.75$ 的 AR($1$) 过程的 $\\tau_{\\mathrm{int}}$ 的精确值。\n从第 1 部分，我们有 $\\rho_k = \\phi^k$。从第 2 部分，$\\tau_{\\mathrm{int}}$ 的表达式是：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k = 1 + 2 \\sum_{k=1}^{\\infty} \\phi^k\n$$\n该和是一个无穷几何级数。由于 $|\\phi| = 0.75  1$，级数收敛于：\n$$\n\\sum_{k=1}^{\\infty} \\phi^k = \\frac{\\phi}{1-\\phi}\n$$\n将此代入 $\\tau_{\\mathrm{int}}$ 的表达式中：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\left( \\frac{\\phi}{1-\\phi} \\right) = \\frac{1-\\phi}{1-\\phi} + \\frac{2\\phi}{1-\\phi} = \\frac{1-\\phi+2\\phi}{1-\\phi} = \\frac{1+\\phi}{1-\\phi}\n$$\n现在，我们代入给定值 $\\phi = 0.75$：\n$$\n\\tau_{\\mathrm{int}} = \\frac{1+0.75}{1-0.75} = \\frac{1.75}{0.25} = \\frac{7/4}{1/4} = 7\n$$\n该过程的精确积分自相关时间是 $7$。", "answer": "$$\n\\boxed{7}\n$$", "id": "3400386"}]}