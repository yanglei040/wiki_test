{"hands_on_practices": [{"introduction": "在许多实际应用中，我们从多个传感器收集的数据往往存在相关误差。一个常见但有风险的简化是忽略这些相关性以简化计算。本练习 [@problem_id:3381472] 提供了一个动手实践的机会，让你量化这种简化所带来的确切代价，揭示忽略相关性如何导致对参数不确定性的过度乐观评估。", "problem": "考虑一个标量地球物理状态参数 $\\theta$，该参数将通过在同一足迹上收集的两次卫星辐射计观测进行估算。数据同化算子是线性的，因此观测模型为 $y = H \\theta + \\varepsilon$，其中 $y \\in \\mathbb{R}^{2}$，$H = \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix}$，观测误差 $\\varepsilon \\in \\mathbb{R}^{2}$ 是一个零均值高斯分布，其协方差矩阵为 $\\Sigma$。这两个传感器的方差分别为 $\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$，它们的误差相关性由相关系数 $\\rho \\in (-1,1)$ 描述，因此\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_{1}^{2} & \\rho\\,\\sigma_{1}\\sigma_{2} \\\\\n\\rho\\,\\sigma_{1}\\sigma_{2} & \\sigma_{2}^{2}\n\\end{pmatrix}.\n$$\n在某些操作环境中，非对角线相关性被忽略，协方差被错误地指定为对角矩阵，\n$$\n\\Sigma_{\\text{miss}} = \\begin{pmatrix}\n\\sigma_{1}^{2} & 0 \\\\\n0 & \\sigma_{2}^{2}\n\\end{pmatrix}.\n$$\n从多元正态模型的对数似然定义以及费雪信息 (FI) 和克拉默-拉奥界 (CRB) 的定义出发，推导在正确指定的模型下和忽略非对角线相关性的错误指定模型下，$\\theta$ 的标量 FI。然后，对于特定情况\n$$\nh_{1} = 1.1,\\quad h_{2} = 0.9,\\quad \\sigma_{1} = 0.4,\\quad \\sigma_{2} = 0.5,\\quad \\rho = 0.6,\n$$\n计算真实 CRB 与错误指定的 CRB 之比，\n$$\nR \\equiv \\frac{\\text{CRB}_{\\text{true}}}{\\text{CRB}_{\\text{miss}}}.\n$$\n将 $R$ 报告为一个四舍五入到四位有效数字的实数。该比率不需要单位。", "solution": "该问题要求在误差协方差矩阵的两种不同假设下，推导标量参数 $\\theta$ 的费雪信息 (FI) 和克拉默-拉奥界 (CRB)，然后针对一组特定参数计算这些界的比率。\n\n观测模型由线性方程 $y = H \\theta + \\varepsilon$ 给出，其中 $y \\in \\mathbb{R}^{2}$ 是观测向量，$H \\in \\mathbb{R}^{2 \\times 1}$ 是观测算子，$\\theta \\in \\mathbb{R}$ 是待估算的标量状态参数，$\\varepsilon \\in \\mathbb{R}^{2}$ 是观测误差。误差 $\\varepsilon$ 假定为一个零均值高斯随机变量，因此其概率密度函数为 $p(\\varepsilon) = \\frac{1}{\\sqrt{(2\\pi)^2 \\det(\\Sigma_{gen})}} \\exp\\left(-\\frac{1}{2} \\varepsilon^T \\Sigma_{gen}^{-1} \\varepsilon\\right)$，其中 $\\Sigma_{gen}$ 是一个通用协方差矩阵。\n\n根据观测模型，向量 $y$ 也是一个高斯随机变量，其均值为 $E[y] = H\\theta$，协方差为 $\\Sigma_{gen}$。在给定观测 $y$ 的情况下，$\\theta$ 的似然函数是 $y$ 在观测值处的概率密度函数：\n$$\nL(\\theta; y) = p(y|\\theta) = \\frac{1}{\\sqrt{(2\\pi)^2 \\det(\\Sigma_{gen})}} \\exp\\left(-\\frac{1}{2} (y - H\\theta)^T \\Sigma_{gen}^{-1} (y - H\\theta)\\right)\n$$\n对数似然函数 $\\ln L(\\theta; y)$ 为：\n$$\n\\ln L(\\theta; y) = -\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\Sigma_{gen})) - \\frac{1}{2}(y-H\\theta)^T \\Sigma_{gen}^{-1} (y-H\\theta)\n$$\n标量参数 $\\theta$ 的费雪信息 $I(\\theta)$ 定义为对数似然函数关于 $\\theta$ 的二阶导数的期望值的负数：\n$$\nI(\\theta) = -E\\left[\\frac{\\partial^2 \\ln L(\\theta; y)}{\\partial \\theta^2}\\right]\n$$\n首先，我们计算对数似然函数的导数。一阶导数为：\n$$\n\\frac{\\partial \\ln L}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left(-\\frac{1}{2}(y-H\\theta)^T \\Sigma_{gen}^{-1} (y-H\\theta)\\right) = -\\frac{1}{2} \\left( 2(-H^T) \\Sigma_{gen}^{-1} (y-H\\theta) \\right) = H^T \\Sigma_{gen}^{-1} (y-H\\theta)\n$$\n二阶导数为：\n$$\n\\frac{\\partial^2 \\ln L}{\\partial \\theta^2} = \\frac{\\partial}{\\partial \\theta} \\left(H^T \\Sigma_{gen}^{-1} (y-H\\theta)\\right) = H^T \\Sigma_{gen}^{-1} (-H) = -H^T \\Sigma_{gen}^{-1} H\n$$\n由于二阶导数不是观测值 $y$ 的函数，其期望就是其本身。因此，费雪信息为：\n$$\nI(\\theta) = -(-H^T \\Sigma_{gen}^{-1} H) = H^T \\Sigma_{gen}^{-1} H\n$$\n克拉默-拉奥界 (CRB) 给出了 $\\theta$ 的任何无偏估计量方差的下界。对于标量参数，CRB 是费雪信息的倒数：\n$$\n\\text{CRB}(\\theta) = \\text{Var}(\\hat{\\theta}) \\geq [I(\\theta)]^{-1}\n$$\n\n**1. 正确指定模型的费雪信息 ($I_{\\text{true}}$)**\n\n真实的协方差矩阵为 $\\Sigma = \\begin{pmatrix} \\sigma_{1}^{2} & \\rho\\,\\sigma_{1}\\sigma_{2} \\\\ \\rho\\,\\sigma_{1}\\sigma_{2} & \\sigma_{2}^{2} \\end{pmatrix}$。\n行列式为 $\\det(\\Sigma) = \\sigma_{1}^{2}\\sigma_{2}^{2} - (\\rho\\sigma_{1}\\sigma_{2})^2 = \\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)$。\n逆矩阵为 $\\Sigma^{-1} = \\frac{1}{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)} \\begin{pmatrix} \\sigma_{2}^{2} & -\\rho\\,\\sigma_{1}\\sigma_{2} \\\\ -\\rho\\,\\sigma_{1}\\sigma_{2} & \\sigma_{1}^{2} \\end{pmatrix}$。\n观测矩阵为 $H = \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix}$。\n真实的费雪信息 $I_{\\text{true}}(\\theta)$ 为：\n$$\nI_{\\text{true}}(\\theta) = H^T \\Sigma^{-1} H = \\begin{pmatrix} h_{1} & h_{2} \\end{pmatrix} \\frac{1}{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)} \\begin{pmatrix} \\sigma_{2}^{2} & -\\rho\\,\\sigma_{1}\\sigma_{2} \\\\ -\\rho\\,\\sigma_{1}\\sigma_{2} & \\sigma_{1}^{2} \\end{pmatrix} \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\nI_{\\text{true}}(\\theta) = \\frac{1}{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)} \\left( h_1(h_1\\sigma_2^2 - h_2\\rho\\sigma_1\\sigma_2) + h_2(-h_1\\rho\\sigma_1\\sigma_2 + h_2\\sigma_1^2) \\right)\n$$\n$$\nI_{\\text{true}}(\\theta) = \\frac{h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2}{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)}\n$$\n\n**2. 错误指定模型的费雪信息 ($I_{\\text{miss}}$)**\n\n错误指定的协方差矩阵是对角的：$\\Sigma_{\\text{miss}} = \\begin{pmatrix} \\sigma_{1}^{2} & 0 \\\\ 0 & \\sigma_{2}^{2} \\end{pmatrix}$。\n其逆矩阵为 $\\Sigma_{\\text{miss}}^{-1} = \\begin{pmatrix} 1/\\sigma_{1}^{2} & 0 \\\\ 0 & 1/\\sigma_{2}^{2} \\end{pmatrix}$。\n错误指定的费雪信息 $I_{\\text{miss}}(\\theta)$ 使用此逆矩阵计算得出：\n$$\nI_{\\text{miss}}(\\theta) = H^T \\Sigma_{\\text{miss}}^{-1} H = \\begin{pmatrix} h_{1} & h_{2} \\end{pmatrix} \\begin{pmatrix} 1/\\sigma_{1}^{2} & 0 \\\\ 0 & 1/\\sigma_{2}^{2} \\end{pmatrix} \\begin{pmatrix} h_{1} \\\\ h_{2} \\end{pmatrix} = \\frac{h_1^2}{\\sigma_1^2} + \\frac{h_2^2}{\\sigma_2^2}\n$$\n\n**3. 克拉默-拉奥界之比**\n\n真实 CRB 和错误指定 CRB 分别是它们各自费雪信息的倒数：\n$$\n\\text{CRB}_{\\text{true}} = [I_{\\text{true}}(\\theta)]^{-1} = \\frac{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)}{h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2}\n$$\n$$\n\\text{CRB}_{\\text{miss}} = [I_{\\text{miss}}(\\theta)]^{-1} = \\left(\\frac{h_1^2}{\\sigma_1^2} + \\frac{h_2^2}{\\sigma_2^2}\\right)^{-1} = \\frac{\\sigma_1^2\\sigma_2^2}{h_1^2\\sigma_2^2 + h_2^2\\sigma_1^2}\n$$\n所求比率 $R$ 为：\n$$\nR = \\frac{\\text{CRB}_{\\text{true}}}{\\text{CRB}_{\\text{miss}}} = \\frac{[I_{\\text{true}}(\\theta)]^{-1}}{[I_{\\text{miss}}(\\theta)]^{-1}} = \\frac{I_{\\text{miss}}(\\theta)}{I_{\\text{true}}(\\theta)}\n$$\n代入推导出的费雪信息表达式：\n$$\nR = \\frac{\\frac{h_1^2}{\\sigma_1^2} + \\frac{h_2^2}{\\sigma_2^2}}{\\frac{h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2}{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)}} = \\left(\\frac{h_1^2\\sigma_2^2 + h_2^2\\sigma_1^2}{\\sigma_1^2\\sigma_2^2}\\right) \\left(\\frac{\\sigma_{1}^{2}\\sigma_{2}^{2}(1-\\rho^2)}{h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2}\\right)\n$$\n$$\nR = \\frac{(h_1^2\\sigma_2^2 + h_2^2\\sigma_1^2)(1-\\rho^2)}{h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2}\n$$\n\n**4. 数值计算**\n\n给定值为：$h_{1} = 1.1$，$h_{2} = 0.9$，$\\sigma_{1} = 0.4$，$\\sigma_{2} = 0.5$，以及 $\\rho = 0.6$。\n首先，我们计算平方项和乘积项：\n$h_1^2 = (1.1)^2 = 1.21$\n$h_2^2 = (0.9)^2 = 0.81$\n$\\sigma_1^2 = (0.4)^2 = 0.16$\n$\\sigma_2^2 = (0.5)^2 = 0.25$\n$\\rho^2 = (0.6)^2 = 0.36$\n$1 - \\rho^2 = 1 - 0.36 = 0.64$\n\n现在我们计算 $R$ 表达式中的各项：\n$h_1^2\\sigma_2^2 = 1.21 \\times 0.25 = 0.3025$\n$h_2^2\\sigma_1^2 = 0.81 \\times 0.16 = 0.1296$\n$2h_1h_2\\rho\\sigma_1\\sigma_2 = 2 \\times (1.1) \\times (0.9) \\times (0.6) \\times (0.4) \\times (0.5) = 2 \\times 0.99 \\times 0.6 \\times 0.2 = 0.2376$\n\n现在，将这些值代入 $R$ 的表达式中：\n$R$ 的分子：$(h_1^2\\sigma_2^2 + h_2^2\\sigma_1^2)(1-\\rho^2) = (0.3025 + 0.1296) \\times 0.64 = 0.4321 \\times 0.64 = 0.276544$\n$R$ 的分母：$h_1^2\\sigma_2^2 - 2h_1h_2\\rho\\sigma_1\\sigma_2 + h_2^2\\sigma_1^2 = 0.3025 - 0.2376 + 0.1296 = 0.1945$\n\n比率为：\n$$\nR = \\frac{0.276544}{0.1945} \\approx 1.42182005...\n$$\n四舍五入到四位有效数字，我们得到 $R = 1.422$。这个结果意味着，真实的最小方差 ($\\text{CRB}_{\\text{true}}$) 比忽略正误差相关性而天真地计算出的方差 ($\\text{CRB}_{\\text{miss}}$) 大约 $42.2\\%$。因此，忽略相关性的分析师对可达到的精度过于乐观。", "answer": "$$\\boxed{1.422}$$", "id": "3381472"}, {"introduction": "尽管许多教科书中的例子都集中在高斯噪声上，但大量的科学应用涉及对离散事件的计数，这种情况更适合用泊松分布来描述。本练习 [@problem_id:3381487] 将挑战你从第一性原理出发，为此类模型推导费雪信息，从而加深你对信息如何在非高斯似然函数中编码，以及在低计数（信息匮乏）情况下其行为方式的理解。", "problem": "在光子受限的数据同化场景中，假设有 $n$ 个独立的传感器计数 $y_{i}$（对于 $i \\in \\{1,\\dots,n\\}$），服从 $y_{i} \\sim \\mathrm{Poisson}(\\lambda_{i}(\\theta))$ 分布，其中 $\\theta \\in \\mathbb{R}^{p}$ 是一个未知的参数向量，并且每个正演率函数 $\\lambda_{i} : \\mathbb{R}^{p} \\to \\mathbb{R}_{>0}$ 都是连续可微的。请从基于似然推断的第一性原理出发，从费雪信息矩阵的定义（即在数据模型下得分函数外积的期望）开始，推导出一个用 $\\{\\lambda_{i}(\\theta)\\}_{i=1}^{n}$ 及其关于 $\\theta$ 的梯度表示的费雪信息矩阵 $I(\\theta)$ 的通用表达式。然后，将其特化为对数线性正演模型 $\\lambda_{i}(\\theta) = \\exp(x_{i}^{\\top}\\theta)$，其中 $x_{i} \\in \\mathbb{R}^{p}$ 是已知的。\n\n接下来，考虑 $p=2$ 和 $n=3$ 的情况，其中\n$$\nx_{1}=\\begin{pmatrix}1 \\\\ 0.5\\end{pmatrix},\\quad x_{2}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad x_{3}=\\begin{pmatrix}1 \\\\ 2\\end{pmatrix},\n$$\n并且真实参数为 $\\theta_{0}=\\begin{pmatrix}-2 \\\\ -1\\end{pmatrix}$。使用你推导出的费雪信息表达式，计算线性泛函 $c^{\\top}\\theta$（其中 $c=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$）的任意无偏估计量的克拉美-拉奥下界 (CRLB)，并在 $\\theta=\\theta_{0}$ 处进行求值。将你的最终数值答案表示为一个实数，并四舍五入到 4 位有效数字。\n\n最后，在不改变你的数值结果的情况下，简要讨论低计数状态（即 $\\lambda_{i}(\\theta)$ 很小）如何影响费雪信息以及克拉美-拉奥下界在有限样本反问题和数据同化中的实际紧致性。", "solution": "我们从参数为 $\\theta \\in \\mathbb{R}^{p}$ 的参数族的费雪信息矩阵定义开始，\n$$\nI(\\theta) \\equiv \\mathbb{E}_{\\theta}\\!\\left[\\,\\nabla_{\\theta} \\ell(\\theta; y)\\,\\nabla_{\\theta} \\ell(\\theta; y)^{\\top}\\right],\n$$\n其中 $\\ell(\\theta; y)$ 是对数似然，期望是关于参数为 $\\theta$ 时的数据分布计算的。对于独立的观测值 $\\{y_{i}\\}_{i=1}^{n}$，其中 $y_{i} \\sim \\mathrm{Poisson}(\\lambda_{i}(\\theta))$，联合似然为\n$$\nL(\\theta; y)=\\prod_{i=1}^{n}\\frac{\\exp(-\\lambda_{i}(\\theta))\\,\\lambda_{i}(\\theta)^{y_{i}}}{y_{i}!},\\qquad \\ell(\\theta; y)=\\sum_{i=1}^{n}\\left[-\\lambda_{i}(\\theta)+y_{i}\\ln \\lambda_{i}(\\theta)-\\ln(y_{i}!)\\right].\n$$\n微分求导以获得得分函数：\n$$\n\\nabla_{\\theta}\\ell(\\theta; y)=\\sum_{i=1}^{n}\\left[-\\nabla_{\\theta}\\lambda_{i}(\\theta)+y_{i}\\,\\nabla_{\\theta}\\ln \\lambda_{i}(\\theta)\\right]\n=\\sum_{i=1}^{n}\\left[-\\nabla_{\\theta}\\lambda_{i}(\\theta)+\\frac{y_{i}}{\\lambda_{i}(\\theta)}\\,\\nabla_{\\theta}\\lambda_{i}(\\theta)\\right]\n=\\sum_{i=1}^{n}\\frac{y_{i}-\\lambda_{i}(\\theta)}{\\lambda_{i}(\\theta)}\\,\\nabla_{\\theta}\\lambda_{i}(\\theta).\n$$\n利用独立性，和的外积的期望等于外积的期望之和，因为当 $i \\neq j$ 时，由于协方差为零，交叉项会消失：\n$$\nI(\\theta)=\\sum_{i=1}^{n}\\mathbb{E}_{\\theta}\\!\\left[\\left(\\frac{y_{i}-\\lambda_{i}(\\theta)}{\\lambda_{i}(\\theta)}\\right)^{2}\\right]\\nabla_{\\theta}\\lambda_{i}(\\theta)\\,\\nabla_{\\theta}\\lambda_{i}(\\theta)^{\\top}.\n$$\n对于泊松随机变量，$\\mathrm{Var}(y_{i})=\\lambda_{i}(\\theta)$ 且 $\\mathbb{E}\\!\\left[(y_{i}-\\lambda_{i}(\\theta))^{2}\\right]=\\lambda_{i}(\\theta)$。因此，\n$$\nI(\\theta)=\\sum_{i=1}^{n}\\frac{1}{\\lambda_{i}(\\theta)}\\,\\nabla_{\\theta}\\lambda_{i}(\\theta)\\,\\nabla_{\\theta}\\lambda_{i}(\\theta)^{\\top}.\n$$\n\n将其特化为对数线性模型 $\\lambda_{i}(\\theta)=\\exp(x_{i}^{\\top}\\theta)$，其中 $x_{i}\\in\\mathbb{R}^{p}$。那么\n$$\n\\nabla_{\\theta}\\lambda_{i}(\\theta)=\\exp(x_{i}^{\\top}\\theta)\\,x_{i}=\\lambda_{i}(\\theta)\\,x_{i},\n$$\n因此\n$$\nI(\\theta)=\\sum_{i=1}^{n}\\lambda_{i}(\\theta)\\,x_{i}x_{i}^{\\top}.\n$$\n\n现在取 $p=2, n=3$，其中\n$$\nx_{1}=\\begin{pmatrix}1\\\\ 0.5\\end{pmatrix},\\quad x_{2}=\\begin{pmatrix}1\\\\ 1\\end{pmatrix},\\quad x_{3}=\\begin{pmatrix}1\\\\ 2\\end{pmatrix},\\quad \\theta_{0}=\\begin{pmatrix}-2\\\\ -1\\end{pmatrix}.\n$$\n计算 $\\lambda_{i}(\\theta_{0})=\\exp(x_{i}^{\\top}\\theta_{0})$：\n$$\nx_{1}^{\\top}\\theta_{0}=-2-0.5=-2.5,\\quad \\lambda_{1}=\\exp(-2.5),\n$$\n$$\nx_{2}^{\\top}\\theta_{0}=-2-1=-3,\\quad \\lambda_{2}=\\exp(-3),\n$$\n$$\nx_{3}^{\\top}\\theta_{0}=-2-2=-4,\\quad \\lambda_{3}=\\exp(-4).\n$$\n因此，\n$$\nI(\\theta_{0})=\\lambda_{1}\\begin{pmatrix}1 & 0.5\\\\ 0.5 & 0.25\\end{pmatrix}+\\lambda_{2}\\begin{pmatrix}1 & 1\\\\ 1 & 1\\end{pmatrix}+\\lambda_{3}\\begin{pmatrix}1 & 2\\\\ 2 & 4\\end{pmatrix}.\n$$\n数值上，\n$$\n\\lambda_{1}=\\exp(-2.5)\\approx 0.08208499862,\\quad \\lambda_{2}=\\exp(-3)\\approx 0.04978706837,\\quad \\lambda_{3}=\\exp(-4)\\approx 0.01831563889,\n$$\n所以\n$$\nI(\\theta_{0})\\approx\n\\begin{pmatrix}\n0.15018770588 & 0.12746084546\\\\\n0.12746084546 & 0.14357087359\n\\end{pmatrix}.\n$$\n\n我们要求解 $c^{\\top}\\theta$（其中 $c=\\begin{pmatrix}0\\\\ 1\\end{pmatrix}$）的任意无偏估计量的克拉美-拉奥下界 (CRLB)。对于一个可微的正则模型，线性泛函的 CRLB 是\n$$\n\\mathrm{Var}(\\widehat{c^{\\top}\\theta}) \\ge c^{\\top}I(\\theta)^{-1}c.\n$$\n在这里，它等于 $I(\\theta_{0})^{-1}$ 的 $(2,2)$ 元素。对于一个对称的 $2\\times 2$ 矩阵 $I=\\begin{pmatrix}a & b\\\\ b & d\\end{pmatrix}$，我们有\n$$\nI^{-1}=\\frac{1}{ad-b^{2}}\\begin{pmatrix}d & -b\\\\ -b & a\\end{pmatrix},\\quad \\Rightarrow\\quad \\left[I^{-1}\\right]_{22}=\\frac{a}{ad-b^{2}}.\n$$\n使用 $a=0.15018770588$, $b=0.12746084546$, $d=0.14357087359$，计算\n$$\nad\\approx 0.02156258014,\\quad b^{2}\\approx 0.01624626712,\\quad ad-b^{2}\\approx 0.00531631302,\n$$\n所以\n$$\nc^{\\top}I(\\theta_{0})^{-1}c=\\frac{a}{ad-b^{2}}\\approx \\frac{0.15018770588}{0.00531631302}\\approx 28.25035.\n$$\n四舍五入到 4 位有效数字，得到 $28.25$。\n\n关于低计数状态的讨论：当 $\\lambda_{i}(\\theta)$ 很小时，在半正定序下，$I(\\theta)=\\sum_{i}\\lambda_{i}(\\theta)\\,x_{i}x_{i}^{\\top}$ 会变小，导致其逆矩阵膨胀，克拉美-拉奥下界 $c^{\\top}I(\\theta)^{-1}c$ 增大。因此，低光子计数或稀疏事件会降低局部可辨识性，并抬高方差下界。此外，当许多 $y_{i}$ 等于 0 时，作为克拉美-拉奥下界基础的渐近正态近似在有限样本中可能不那么准确，这会导致似然函数倾斜，并可能使该界的紧致性变差。在这种状态下，精确或非渐近的界（例如 Barankin 界或 Chapman–Robbins 界）以及贝叶斯数据同化中由正则化启发的先验可能更具信息量，而保证正性的重新参数化（如此处使用的对数连接函数）虽然保持了可微性，但并不能消除由小的 $\\lambda_{i}(\\theta)$ 引起的根本信息稀缺性。", "answer": "$$\\boxed{28.25}$$", "id": "3381487"}, {"introduction": "模型中的物理参数，如方差或扩散系数，通常被限制为正值。本练习 [@problem_id:3381492] 介绍了一种处理此类约束的强大技术：重参数化，例如设置 $\\theta = \\exp(\\psi)$。你将探索费雪信息和克拉默-拉奥界在这样的变换下如何变化，这是构建稳健且适定的估计框架的一项基本技能。", "problem": "考虑一个数据同化情景，其中模型与数据的不符包含 $n$ 个独立的标量残差 $r_{1},\\dots,r_{n}$。这些残差被建模为来自一个均值为零、观测误差方差 $\\theta > 0$ 未知的高斯分布的实现。具体来说，残差向量 $\\mathbf{r} = (r_1, \\dots, r_n)^\\top$ 的似然函数为\n$$\np(\\mathbf{r} | \\theta) = (2\\pi\\theta)^{-n/2} \\exp\\left( -\\frac{1}{2\\theta}\\sum_{i=1}^{n} r_i^2 \\right),\n$$\n当均值已知而只有标量方差参数 $\\theta$ 未知时，这是线性高斯数据同化中的标准高斯模型误差似然。为了在进行无约束优化的同时确保方差为正，引入重参数化\n$$\n\\theta = \\exp(\\psi),\n$$\n使得 $\\psi \\in \\mathbb{R}$。\n\n仅使用得分函数、费雪信息和克拉默-拉奥下界的基本定义，完成以下任务：\n\n1. 在上述模型下，推导 $\\psi$ 的费雪信息，记为 $I_\\psi(\\psi)$。\n2. 从 $\\psi$ 的克拉默-拉奥下界出发，使用一阶delta方法论证，求出 $\\theta$ 的任意近似无偏估计量的方差的相应下界。\n\n将你的最终结果表示为一个双元素行矩阵，其第一个元素是 $I_\\psi(\\psi)$，第二个元素是用 $n$ 和 $\\psi$ 表示的 $\\theta$ 的映射克拉默-拉奥下界的闭式解析表达式。无需进行数值近似或四舍五入。", "solution": "按要求，解答过程分为两部分。\n\n**第1部分：推导费雪信息 $I_\\psi(\\psi)$**\n\n参数 $\\psi$ 的费雪信息定义为对数似然函数关于 $\\psi$ 的二阶导数的负期望值。\n$$\nI_\\psi(\\psi) = - \\mathbb{E} \\left[ \\frac{\\partial^2 \\ln p(\\mathbf{r}|\\psi)}{\\partial \\psi^2} \\right]\n$$\n首先，我们写出对数似然函数 $\\mathcal{L}(\\psi) = \\ln p(\\mathbf{r}|\\psi)$。由于似然函数是以 $\\theta$ 表示的，我们从那里开始。\n$$\n\\ln p(\\mathbf{r}|\\theta) = \\ln \\left[ (2\\pi\\theta)^{-n/2} \\exp\\left( -\\frac{1}{2\\theta}\\sum_{i=1}^{n} r_i^{2} \\right) \\right]\n$$\n令 $S = \\sum_{i=1}^{n} r_i^{2}$。对数似然函数为：\n$$\n\\ln p(\\mathbf{r}|\\theta) = -\\frac{n}{2} \\ln(2\\pi\\theta) - \\frac{S}{2\\theta} = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln\\theta - \\frac{S}{2\\theta}\n$$\n现在，我们使用重参数化 $\\theta = \\exp(\\psi)$，这意味着 $\\ln\\theta = \\psi$。将此代入对数似然表达式，得到 $\\mathcal{L}(\\psi)$：\n$$\n\\mathcal{L}(\\psi) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\psi - \\frac{S}{2\\exp(\\psi)} = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\psi - \\frac{S}{2}\\exp(-\\psi)\n$$\n接下来，我们计算 $\\mathcal{L}(\\psi)$ 关于 $\\psi$ 的一阶和二阶导数。\n一阶导数（$\\psi$ 的得分函数）为：\n$$\n\\frac{\\partial \\mathcal{L}(\\psi)}{\\partial \\psi} = \\frac{\\partial}{\\partial \\psi} \\left( -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\psi - \\frac{S}{2}\\exp(-\\psi) \\right) = -\\frac{n}{2} - \\frac{S}{2} \\cdot (-\\exp(-\\psi)) = \\frac{S \\exp(-\\psi)}{2} - \\frac{n}{2}\n$$\n二阶导数为：\n$$\n\\frac{\\partial^2 \\mathcal{L}(\\psi)}{\\partial \\psi^2} = \\frac{\\partial}{\\partial \\psi} \\left( \\frac{S \\exp(-\\psi)}{2} - \\frac{n}{2} \\right) = \\frac{S}{2} \\cdot (-\\exp(-\\psi)) = -\\frac{S}{2\\exp(\\psi)}\n$$\n为了求得费雪信息，我们取这个二阶导数的负期望。期望是在固定 $\\psi$ 的情况下，对数据 $\\mathbf{r}$ 的分布求得的。\n$$\nI_\\psi(\\psi) = - \\mathbb{E} \\left[ -\\frac{S}{2\\exp(\\psi)} \\right] = \\frac{1}{2\\exp(\\psi)} \\mathbb{E}[S]\n$$\n我们需要计算 $\\mathbb{E}[S]$。残差 $r_i$ 是从均值为零、方差为 $\\theta$ 的高斯分布中抽取的独立同分布样本，即 $r_i \\sim N(0, \\theta)$。这样一个随机变量平方的期望就是它的方差：\n$$\n\\mathbb{E}[r_i^2] = \\text{Var}(r_i) + (\\mathbb{E}[r_i])^2 = \\theta + 0^2 = \\theta\n$$\n根据期望的线性性质，和 $S$ 的期望为：\n$$\n\\mathbb{E}[S] = \\mathbb{E}\\left[\\sum_{i=1}^{n} r_i^2\\right] = \\sum_{i=1}^{n} \\mathbb{E}[r_i^2] = \\sum_{i=1}^{n} \\theta = n\\theta\n$$\n将此结果代回 $I_\\psi(\\psi)$ 的表达式：\n$$\nI_\\psi(\\psi) = \\frac{1}{2\\exp(\\psi)} (n\\theta)\n$$\n最后，我们用 $\\psi$ 的定义替换 $\\theta$，即 $\\theta = \\exp(\\psi)$：\n$$\nI_\\psi(\\psi) = \\frac{n\\exp(\\psi)}{2\\exp(\\psi)} = \\frac{n}{2}\n$$\n因此，$\\psi$ 的费雪信息是一个常数，与 $\\psi$ 无关。\n\n**第2部分：推导 $\\theta$ 的克拉默-拉奥下界**\n\n克拉默-拉奥下界（CRB）指出，对于 $\\psi$ 的任意无偏估计量 $\\hat{\\psi}$，其方差的下界是费雪信息的倒数：\n$$\n\\text{Var}(\\hat{\\psi}) \\ge \\frac{1}{I_\\psi(\\psi)}\n$$\n使用第1部分的结果，$\\psi$ 的CRB为：\n$$\n\\text{Var}(\\hat{\\psi}) \\ge \\frac{2}{n}\n$$\n题目要求我们使用一阶delta方法论证来找到 $\\theta$ 的估计量的相应下界。设变换为 $g(\\psi) = \\theta = \\exp(\\psi)$。$\\theta$ 的一个估计量可以通过将此变换应用于 $\\psi$ 的一个估计量来构成，即 $\\hat{\\theta} = g(\\hat{\\psi}) = \\exp(\\hat{\\psi})$。\n\nDelta方法可以近似一个随机变量函数的方差。对于估计量 $\\hat{\\theta} = g(\\hat{\\psi})$，其方差渐近地由下式给出：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx [g'(\\psi)]^2 \\text{Var}(\\hat{\\psi})\n$$\n其中 $g'(\\psi)$ 是变换函数 $g$ 在真实参数值 $\\psi$ 处的导数。\n在我们的例子中，$g(\\psi) = \\exp(\\psi)$，所以其导数为：\n$$\ng'(\\psi) = \\frac{d}{d\\psi} \\exp(\\psi) = \\exp(\\psi)\n$$\n$\\theta$ 的克拉默-拉奥下界是通过将此变换应用于 $\\psi$ 的下界得到的。对于任何是 $\\psi$ 的有效估计量的函数的、$\\theta$ 的近似无偏估计量，其方差将有如下界：\n$$\n\\text{Var}(\\hat{\\theta}) \\ge [g'(\\psi)]^2 \\frac{1}{I_\\psi(\\psi)}\n$$\n代入我们找到的 $g'(\\psi)$ 和 $I_\\psi(\\psi)$ 的表达式：\n$$\n\\text{CRB}(\\theta) = [\\exp(\\psi)]^2 \\cdot \\frac{2}{n} = \\exp(2\\psi) \\frac{2}{n} = \\frac{2\\exp(2\\psi)}{n}\n$$\n这就是 $\\theta$ 的任意近似无偏估计量的方差的克拉默-拉奥下界，用 $n$ 和 $\\psi$ 表示。\n\n最终结果是一个双元素行矩阵，包含 $I_\\psi(\\psi)$ 和推导出的 $\\theta$ 的下界。\n\n第一个元素：$I_\\psi(\\psi) = \\frac{n}{2}$\n第二个元素：$\\text{CRB}(\\theta) = \\frac{2\\exp(2\\psi)}{n}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{n}{2} & \\frac{2\\exp(2\\psi)}{n} \\end{pmatrix}}\n$$", "id": "3381492"}]}