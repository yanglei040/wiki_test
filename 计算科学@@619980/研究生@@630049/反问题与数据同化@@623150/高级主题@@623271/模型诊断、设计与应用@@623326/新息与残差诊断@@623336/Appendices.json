{"hands_on_practices": [{"introduction": "第一个练习构建了数据同化诊断理论的基石。通过推导新息、分析残差与观测误差协方差之间的关系，你将揭示一种被称为 Desroziers 诊断的强大方法，该方法可用于凭经验估计和调整系统的误差统计。[@problem_id:3390983]", "problem": "考虑一个线性高斯数据同化场景，其中，真实状态 $x \\in \\mathbb{R}^{n}$ 通过线性观测算子 $H \\in \\mathbb{R}^{m \\times n}$ 进行观测，观测误差为 $v \\in \\mathbb{R}^{m}$。观测方程为 $y = H x + v$，其中 $v$ 是无偏的，其协方差为 $R \\in \\mathbb{R}^{m \\times m}$。有一个预报 $x_{f} \\in \\mathbb{R}^{n}$，其预报误差 $e_{f} = x - x_{f}$ 是无偏的，协方差为 $B \\in \\mathbb{R}^{n \\times n}$，且与 $v$ 统计独立。分析由线性更新 $x_{a} = x_{f} + K d$ 形成，其中 $K \\in \\mathbb{R}^{n \\times m}$ 是一个增益矩阵，新息 $d \\in \\mathbb{R}^{m}$ 和分析残差 $r_{a} \\in \\mathbb{R}^{m}$ 分别定义为 $d = y - H x_{f}$ 和 $r_{a} = y - H x_{a}$。假设增益 $K$ 是根据在卡尔曼滤波器 (KF) 的线性高斯假设下最小化分析误差协方差的最优线性估计器选择的，并且 $e_{f}$ 和 $v$ 是独立且无偏的。\n\n从上述定义出发，仅使用无偏线性估计器和协方差在线性高斯KF假设下的标准性质，推导互协方差 $E[d r_{a}^{T}]$ 关于问题中给定的协方差的闭式表达式，并以解析形式求出其精确值。然后，简明解释该恒等式如何启发我们利用在 $N$ 个同化循环中产生的数据对 $\\{(d_{i}, r_{a,i})\\}_{i=1}^{N}$ 计算出的样本互协方差，来对观测误差协方差 $R$ 进行经验估计。\n\n你的最终答案必须是上面指定的 $E[d r_{a}^{T}]$ 的单一闭式解析表达式。不需要进行数值计算。如果你在解释中提出了一个经验估计器，不要将其包含在最终答案中。", "solution": "首先验证问题，以确保其具有科学依据、是适定且客观的。\n\n### 步骤1：提取已知条件\n- 真实状态：$x \\in \\mathbb{R}^{n}$\n- 观测算子：$H \\in \\mathbb{R}^{m \\times n}$\n- 观测误差：$v \\in \\mathbb{R}^{m}$，其中 $E[v] = 0$，协方差为 $E[v v^T] = R \\in \\mathbb{R}^{m \\times m}$\n- 观测方程：$y = H x + v$\n- 预报：$x_{f} \\in \\mathbb{R}^{n}$\n- 预报误差：$e_{f} = x - x_{f}$，其中 $E[e_{f}] = 0$，协方差为 $E[e_{f} e_{f}^T] = B \\in \\mathbb{R}^{n \\times n}$\n- 独立性：$e_{f}$ 和 $v$ 统计独立，意味着 $E[e_{f} v^T] = 0$\n- 分析更新方程：$x_{a} = x_{f} + K d$\n- 增益矩阵：$K \\in \\mathbb{R}^{n \\times m}$\n- 新息：$d = y - H x_{f}$\n- 分析残差：$r_{a} = y - H x_{a}$\n- 关键假设：增益 $K$ 是最小化分析误差协方差的最优卡尔曼滤波器增益。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题设定在线性高斯数据同化的标准理论框架内，这是现代估计理论及其在物理科学和工程中应用的一块基石。所有术语都是标准的且定义明确。各项假设（无偏误差、独立性、最优增益）是在该领域推导基础性结论的典型假设。该问题是自洽的，提供了所有必要信息。它在事实上和科学上都是合理的，其目标是推导残差诊断中的一个已知的、非平凡的恒等式。问题没有矛盾、歧义或依赖于伪科学。\n\n### 步骤3：结论与行动\n该问题有效。可以基于给定的已知条件以及协方差和线性估计器的标准性质进行严格推导。\n\n### 推导\n我们的目标是推导互协方差 $E[d r_{a}^{T}]$ 的闭式表达式。我们首先用基本的不相关误差源——预报误差 $e_{f}$ 和观测误差 $v$——来表示新息 $d$ 和分析残差 $r_{a}$。\n\n新息 $d$ 定义为 $d = y - H x_{f}$。代入观测方程 $y = Hx + v$，我们得到：\n$$\nd = (Hx + v) - Hx_{f} = H(x - x_{f}) + v\n$$\n使用预报误差的定义 $e_{f} = x - x_{f}$，可简化为：\n$$\nd = H e_{f} + v\n$$\n分析残差 $r_{a}$ 定义为 $r_{a} = y - H x_{a}$。我们代入分析更新方程 $x_{a} = x_{f} + K d$：\n$$\nr_{a} = y - H(x_{f} + K d) = (y - H x_{f}) - H K d\n$$\n注意到括号中的项是新息 $d$ 的定义，我们找到了分析残差和新息之间的直接关系：\n$$\nr_{a} = d - H K d = (I - H K) d\n$$\n其中 $I$ 是大小为 $m \\times m$ 的单位矩阵。\n\n现在我们可以写出互协方差 $E[d r_{a}^{T}]$ 的表达式：\n$$\nE[d r_{a}^{T}] = E[d ((I - H K) d)^T]\n$$\n使用乘积转置的性质 $(AB)^T = B^T A^T$，我们得到：\n$$\nE[d r_{a}^{T}] = E[d d^T (I - H K)^T] = E[d d^T (I^T - (HK)^T)] = E[d d^T (I - K^T H^T)]\n$$\n由于 $I$、$K$ 和 $H$ 是常数矩阵，我们可以将项 $(I - K^T H^T)$ 移到期望符号之外：\n$$\nE[d r_{a}^{T}] = E[d d^T] (I - K^T H^T)\n$$\n项 $E[d d^T]$ 是新息协方差矩阵，我们记为 $S$。让我们使用 $d$ 的表达式来计算 $S$：\n$$\nS = E[d d^T] = E[(H e_{f} + v)(H e_{f} + v)^T] = E[H e_{f} e_{f}^T H^T + H e_{f} v^T + v e_{f}^T H^T + v v^T]\n$$\n根据期望的线性性质：\n$$\nS = H E[e_{f} e_{f}^T] H^T + H E[e_{f} v^T] + E[v e_{f}^T] H^T + E[v v^T]\n$$\n已知 $e_{f}$ 和 $v$ 是独立的且均值为零。这意味着它们的互协方差为零：$E[e_{f} v^T] = E[e_f]E[v^T] = 0$。类似地，$E[v e_{f}^T] = 0$。我们还已知预报误差协方差 $B = E[e_{f} e_{f}^T]$ 和观测误差协方差 $R = E[v v^T]$ 的定义。将这些代入 $S$ 的表达式，得到新息协方差的标准公式：\n$$\nS = H B H^T + R\n$$\n现在，回到我们的互协方差表达式：\n$$\nE[d r_{a}^{T}] = S (I - K^T H^T) = S - S K^T H^T\n$$\n问题陈述指明增益矩阵 $K$ 在卡尔曼滤波器意义上是最优的。最优卡尔曼增益由下式给出：\n$$\nK = B H^T (H B H^T + R)^{-1} = B H^T S^{-1}\n$$\n我们将这个最优增益代入我们的表达式。首先，求 $K$ 的转置：\n$$\nK^T = (B H^T S^{-1})^T = (S^{-1})^T (B H^T)^T = (S^T)^{-1} H B^T\n$$\n因为协方差矩阵是对称的，所以 $S=S^T$ 且 $B=B^T$。因此，$K^T = S^{-1} H B$。现在我们可以计算 $S K^T H^T$ 这一项：\n$$\nS K^T H^T = S (S^{-1} H B) H^T = (S S^{-1}) H B H^T = I H B H^T = H B H^T\n$$\n最后，我们将此结果代回到 $E[d r_{a}^{T}]$ 的表达式中：\n$$\nE[d r_{a}^{T}] = S - H B H^T\n$$\n代入 $S = H B H^T + R$ 的表达式：\n$$\nE[d r_{a}^{T}] = (H B H^T + R) - H B H^T = R\n$$\n此推导得出了互协方差的闭式解析表达式。\n\n### 对 $R$ 进行经验估计的动机\n恒等式 $E[d r_{a}^{T}] = R$ 是数据同化诊断的一块基石。它表明新息向量（预报残差）和分析残差之间互协方差的理论期望值，恰好等于观测误差协方差矩阵 $R$。这个理论结果提供了一种强大而实用的方法，可以从数据中估计 $R$。\n\n根据大数定律，随着样本量的增加，样本均值会收敛到真实的总体均值。如果一个数据同化系统运行了 $N$ 个循环，产生了一系列新息向量 $\\{d_i\\}_{i=1}^N$ 和相应的分析残差向量 $\\{r_{a,i}\\}_{i=1}^N$，那么可以通过计算样本互协方差来得到期望 $E[d r_{a}^{T}]$ 的一个经验估计：\n$$\n\\hat{R} = \\frac{1}{N-1} \\sum_{i=1}^{N} d_i r_{a,i}^T\n$$\n这种方法被称为 Desroziers 诊断法，它允许仅使用同化系统本身的输出来对 $R$ 进行后验估计。这在实践中非常有价值，因为 $R$（和 $B$）通常是未知且必须进行调整的。这种诊断法提供了一种数据驱动的方式来检查和完善 $R$ 的设定。然而，至关重要的是要认识到，该估计方法的有效性取决于一个关键假设，即同化中使用的增益 $K$ 是最优的，而这又要求预报误差协方差 $B$ 和观测算子 $H$ 被正确设定。模型参数或增益的任何次优性都会使该恒等式失效，并导致对 $R$ 的估计有偏。", "answer": "$$\\boxed{R}$$", "id": "3390983"}, {"introduction": "为了有效地诊断一个系统，通常需要将复杂、相关的残差统计量转换为更简单、标准的形式。本练习将指导你完成“预白化”过程，使用 Cholesky 分解将相关的多元高斯残差向量转换为一个具有独立、标准正态分量的向量，从而使其适用于标准的统计检验。[@problem_id:3391019]", "problem": "考虑一个数据同化中的线性观测模型，其预报状态为 $x_{f} \\in \\mathbb{R}^{2}$，真实状态为 $x \\in \\mathbb{R}^{2}$，观测为 $y \\in \\mathbb{R}^{2}$，由 $y = H x + \\epsilon$ 给出，其中 $H \\in \\mathbb{R}^{2 \\times 2}$ 是线性观测算子，$\\epsilon \\in \\mathbb{R}^{2}$ 是观测误差。假设预报误差 $e_{f} = x - x_{f}$ 是一个协方差为 $B \\in \\mathbb{R}^{2 \\times 2}$ 的零均值高斯随机向量，观测误差 $\\epsilon$ 是一个协方差为 $R \\in \\mathbb{R}^{2 \\times 2}$ 的零均值高斯随机向量，且 $e_{f}$ 和 $\\epsilon$ 是统计独立的。新息（观测减预报残差）定义为 $d = y - H x_{f}$。在上述正确的模型假设下，$d$ 是一个协方差为 $S = H B H^{T} + R$ 的零均值高斯随机向量。\n\n在新息和残差诊断的背景下，我们寻求一种预白化变换，将 $d$ 映射到一个白化残差 $\\tilde{d}$，其分量是独立同分布的标准正态变量。使用 Cholesky 分解 $S = L L^{T}$（其中 $L$ 为下三角矩阵且对角元为正）来构造预白化变换。具体来说，取\n$$\nH = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}, \\quad\nR = \\begin{pmatrix} 1  1 \\\\ 1  4 \\end{pmatrix}.\n$$\n\n任务：\n- 根据给定的 $H$、$B$ 和 $R$ 计算 $S$。\n- 构造 Cholesky 因子 $L$，使得 $S = L L^{T}$，其中 $L$ 为下三角矩阵且对角元为正，并定义预白化变换 $\\tilde{d} = L^{-1} d$。\n- 从多元高斯随机向量线性变换的基本性质出发，在正确模型下推导 $\\tilde{d}$ 的分布。以闭合形式显式计算 $\\tilde{d}$ 的协方差矩阵。\n\n你的最终答案必须是 $\\tilde{d}$ 的协方差矩阵，表示为单个闭合形式的解析表达式。不需要四舍五入，也不涉及单位。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提出得当，并且是客观的。解决问题所需的所有数据和定义均已提供，不存在内部矛盾或歧义。\n\n问题要求计算白化残差向量 $\\tilde{d}$ 的协方差矩阵。解答过程分为三步：\n1.  计算新息协方差矩阵 $S$。\n2.  对 $S$ 进行 Cholesky 分解，求出下三角矩阵 $L$。\n3.  推导白化残差 $\\tilde{d} = L^{-1} d$ 的协方差矩阵。\n\n**第 1 步：计算新息协方差矩阵 $S$**\n\n新息协方差矩阵 $S$ 由公式 $S = H B H^{T} + R$ 给出。\n给定的矩阵是：\n$H = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$，这是 $2 \\times 2$ 的单位矩阵 $I$。\n$B = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}$\n$R = \\begin{pmatrix} 1  1 \\\\ 1  4 \\end{pmatrix}$\n\n因为 $H$ 是单位矩阵，所以 $H B H^{T} = I B I^{T} = B$。\n因此，$S$ 的表达式简化为 $S = B + R$。\n代入给定的矩阵 $B$ 和 $R$：\n$$\nS = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix} + \\begin{pmatrix} 1  1 \\\\ 1  4 \\end{pmatrix}\n$$\n执行矩阵加法：\n$$\nS = \\begin{pmatrix} 3+1  1+1 \\\\ 1+1  1+4 \\end{pmatrix} = \\begin{pmatrix} 4  2 \\\\ 2  5 \\end{pmatrix}\n$$\n矩阵 $S$ 是对称的。为确认其为正定矩阵，我们可以检查其行列式：$\\det(S) = (4)(5) - (2)(2) = 20 - 4 = 16 > 0$。由于第一个顺序主子式 ($4$) 也为正，因此 $S$ 是正定的，且存在唯一的 Cholesky 分解。\n\n**第 2 步：构造 Cholesky 因子 $L$**\n\n我们寻求一个对角元为正的下三角矩阵 $L$，使得 $S = L L^{T}$。令 $L$ 为：\n$$\nL = \\begin{pmatrix} l_{11}  0 \\\\ l_{21}  l_{22} \\end{pmatrix}\n$$\n则 $L L^{T}$ 为：\n$$\nL L^{T} = \\begin{pmatrix} l_{11}  0 \\\\ l_{21}  l_{22} \\end{pmatrix} \\begin{pmatrix} l_{11}  l_{21} \\\\ 0  l_{22} \\end{pmatrix} = \\begin{pmatrix} l_{11}^{2}  l_{11} l_{21} \\\\ l_{11} l_{21}  l_{21}^{2} + l_{22}^{2} \\end{pmatrix}\n$$\n将 $L L^{T}$ 的元素与 $S$ 的元素相等：\n$$\n\\begin{pmatrix} l_{11}^{2}  l_{11} l_{21} \\\\ l_{11} l_{21}  l_{21}^{2} + l_{22}^{2} \\end{pmatrix} = \\begin{pmatrix} 4  2 \\\\ 2  5 \\end{pmatrix}\n$$\n从 $(1,1)$ 元素：$l_{11}^{2} = 4$。由于 $l_{11}$ 必须为正，我们得到 $l_{11} = 2$。\n从 $(2,1)$ 元素：$l_{11} l_{21} = 2$。代入 $l_{11} = 2$，得到 $2 l_{21} = 2$，即 $l_{21} = 1$。\n从 $(2,2)$ 元素：$l_{21}^{2} + l_{22}^{2} = 5$。代入 $l_{21} = 1$，得到 $1^{2} + l_{22}^{2} = 5$，所以 $l_{22}^{2} = 4$。由于 $l_{22}$ 必须为正，我们得到 $l_{22} = 2$。\n\n因此，Cholesky 因子是：\n$$\nL = \\begin{pmatrix} 2  0 \\\\ 1  2 \\end{pmatrix}\n$$\n\n**第 3 步：推导白化残差 $\\tilde{d}$ 的协方差矩阵**\n\n新息向量 $d = y - Hx_{f}$ 是高斯随机向量 $e_{f} = x - x_{f}$ 和 $\\epsilon$ 的线性组合。具体而言，$d = H(x-x_{f}) + \\epsilon = H e_{f} + \\epsilon$。如问题中所述，并在验证中得到确认，$d$ 是一个协方差矩阵为 $S$ 的零均值高斯随机向量，即 $d \\sim \\mathcal{N}(0, S)$。\n\n白化残差 $\\tilde{d}$ 由线性变换 $\\tilde{d} = L^{-1} d$ 定义。\n多元高斯随机向量的一个基本性质指出，如果一个随机向量 $z \\sim \\mathcal{N}(\\mu, \\Sigma)$，那么线性变换 $w = A z$ 会产生一个同样是高斯的随机向量 $w$，其分布为 $w \\sim \\mathcal{N}(A\\mu, A\\Sigma A^{T})$。\n\n将此性质应用于 $\\tilde{d}$：\n- $\\tilde{d}$ 的均值为 $E[\\tilde{d}] = L^{-1} E[d] = L^{-1} \\cdot 0 = 0$。\n- $\\tilde{d}$ 的协方差矩阵，我们称之为 $\\text{Cov}(\\tilde{d})$，由以下公式给出：\n$$\n\\text{Cov}(\\tilde{d}) = (L^{-1}) S (L^{-1})^{T}\n$$\n我们将 $S = L L^{T}$ 代入此表达式：\n$$\n\\text{Cov}(\\tilde{d}) = L^{-1} (L L^{T}) (L^{-1})^{T}\n$$\n使用矩阵恒等式 $(A^{-1})^{T} = (A^{T})^{-1}$，我们可以将 $(L^{-1})^{T}$ 写成 $(L^{T})^{-1}$。\n$$\n\\text{Cov}(\\tilde{d}) = (L^{-1} L) (L^{T} (L^{T})^{-1})\n$$\n因为 $L^{-1}L = I$ 且 $L^{T}(L^{T})^{-1} = I$，其中 $I$ 是单位矩阵，该表达式简化为：\n$$\n\\text{Cov}(\\tilde{d}) = I \\cdot I = I\n$$\n这个推导表明，白化残差的协方差矩阵是单位矩阵，这是预白化变换的预期结果。$\\tilde{d}$ 的分量是不相关的，并且具有单位方差。由于 $\\tilde{d}$ 是高斯分布的，其分量也是独立的，并且是标准正态变量。\n\n为了提供明确的闭合形式答案，$\\tilde{d}$ 的协方差矩阵是 $2 \\times 2$ 的单位矩阵：\n$$\n\\text{Cov}(\\tilde{d}) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这个结果是通用的。为了完整起见，我们可以使用前面计算的具体矩阵来验证它。\n首先，我们求 $L^{-1}$：\n$$\nL^{-1} = \\frac{1}{(2)(2) - (0)(1)} \\begin{pmatrix} 2  0 \\\\ -1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2  0 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ -\\frac{1}{4}  \\frac{1}{2} \\end{pmatrix}\n$$\n然后，我们计算 $\\text{Cov}(\\tilde{d}) = L^{-1} S (L^{-1})^{T}$：\n$$\nL^{-1} S = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ -\\frac{1}{4}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 4  2 \\\\ 2  5 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 0  2 \\end{pmatrix}\n$$\n注意，这个中间结果等于 $L^T$，正如从 $L^{-1}S = L^{-1}LL^T = L^T$ 所预期的那样。\n现在，我们在右边乘以 $(L^{-1})^{T}$：\n$$\n(L^{-1})^{T} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{4} \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n$$\n$$\n\\text{Cov}(\\tilde{d}) = (L^{-1}S)(L^{-1})^{T} = \\begin{pmatrix} 2  1 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{4} \\\\ 0  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} (2)(\\frac{1}{2}) + (1)(0)  (2)(-\\frac{1}{4}) + (1)(\\frac{1}{2}) \\\\ (0)(\\frac{1}{2}) + (2)(0)  (0)(-\\frac{1}{4}) + (2)(\\frac{1}{2}) \\end{pmatrix}\n$$\n$$\n\\text{Cov}(\\tilde{d}) = \\begin{pmatrix} 1  -\\frac{1}{2} + \\frac{1}{2} \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n显式计算证实了一般性推导。$\\tilde{d}$ 的协方差矩阵是 $2 \\times 2$ 的单位矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n}\n$$", "id": "3391019"}, {"introduction": "标准的分析残差可能会产生误导性的小值，因为分析结果已经受到了与之比较的那个观测值本身的影响。这个高级练习引入了留一交叉验证的概念，以推导出一个更可靠的预测误差估计，揭示了标准残差与观测值的自我影响（即“杠杆率”）之间的基本关系。[@problem_id:3391037]", "problem": "考虑一个线性高斯数据同化问题，其未知状态向量为 $\\mathbf{x} \\in \\mathbb{R}^{n}$，具有高斯先验（预报）$\\mathbf{x}_{f}$，其协方差矩阵为 $\\mathbf{B} \\in \\mathbb{R}^{n \\times n}$，以及一组收集在向量 $\\mathbf{y} \\in \\mathbb{R}^{m}$ 中的 $m$ 个标量观测。观测算子是线性的，由 $\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$ 给出，观测误差相互不相关，其方差分别为 $\\sigma_{1}^{2}, \\dots, \\sigma_{m}^{2}$，因此观测误差协方差矩阵是对角的，即 $\\mathbf{R} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{m}^{2})$。观测满足 $\\mathbf{y} = \\mathbf{H}\\mathbf{x} + \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$。\n\n将新息定义为 $\\mathbf{d} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}_{f}$，分析定义为 $\\mathbf{x}_{a} = \\mathbf{x}_{f} + \\mathbf{K}\\mathbf{d}$，其中卡尔曼增益 $\\mathbf{K} \\in \\mathbb{R}^{n \\times m}$ 由 $\\mathbf{K} = \\mathbf{B}\\mathbf{H}^{\\top}\\mathbf{S}^{-1}$ 给出，且 $\\mathbf{S} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} + \\mathbf{R}$。预测的分析空间观测值为 $\\mathbf{y}_{a} = \\mathbf{H}\\mathbf{x}_{a}$，分析残差为 $\\mathbf{r} = \\mathbf{y} - \\mathbf{y}_{a}$。令观测空间中的影响矩阵为 $\\mathbf{A} = \\mathbf{H}\\mathbf{K} \\in \\mathbb{R}^{m \\times m}$。\n\n对于一个固定的索引 $i \\in \\{1,\\dots,m\\}$，按如下方式为第 $i$ 个观测构造留一法（LOO）交叉验证残差：在排除第 $i$ 个观测的同时重新计算分析，方法是将其误差方差设为 $+\\infty$（等价地，构造一个修正后的协方差 $\\mathbf{R}^{(\\Delta)} = \\mathbf{R} + \\Delta \\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}$，其中 $\\Delta \\to +\\infty$，$\\mathbf{e}_{i}$ 是 $\\mathbb{R}^{m}$ 中的第 $i$ 个标准基向量），并定义 $\\mathbf{r}^{\\mathrm{LOO}}$ 为从这个基于排除法的分析中得到的、对照完整观测 $\\mathbf{y}$ 评估的残差向量。令 $r_{i}^{\\mathrm{LOO}}$ 表示 $\\mathbf{r}^{\\mathrm{LOO}}$ 的第 $i$ 个分量，并令 $r_{i}$ 表示原始残差 $\\mathbf{r}$ 的第 $i$ 个分量。同时令 $A_{ii}$ 表示 $\\mathbf{A}$ 的第 $i$ 个对角线元素。\n\n仅从给定的线性高斯模型和定义出发，并在需要时使用标准矩阵恒等式，推导出一个仅依赖于 $r_{i}$ 和 $A_{ii}$ 的关于 $r_{i}^{\\mathrm{LOO}}$ 的闭式解析表达式。您的最终答案必须是单一的解析表达式。不需要进行数值近似或舍入。", "solution": "本题要求解第 $i$ 个观测的留一法（LOO）交叉验证残差 $r_{i}^{\\mathrm{LOO}}$ 与同一观测的标准分析残差 $r_{i}$ 之间的关系。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- 未知状态向量：$\\mathbf{x} \\in \\mathbb{R}^{n}$\n- 先验（预报）状态：$\\mathbf{x}_{f}$\n- 先验协方差矩阵：$\\mathbf{B} \\in \\mathbb{R}^{n \\times n}$\n- 观测向量：$\\mathbf{y} \\in \\mathbb{R}^{m}$\n- 线性观测算子：$\\mathbf{H} \\in \\mathbb{R}^{m \\times n}$\n- 观测误差协方差矩阵：$\\mathbf{R} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{m}^{2})$\n- 观测模型：$\\mathbf{y} = \\mathbf{H}\\mathbf{x} + \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$\n- 新息向量：$\\mathbf{d} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}_{f}$\n- 卡尔曼增益矩阵：$\\mathbf{K} = \\mathbf{B}\\mathbf{H}^{\\top}\\mathbf{S}^{-1}$，其中 $\\mathbf{S} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} + \\mathbf{R}$\n- 分析状态向量：$\\mathbf{x}_{a} = \\mathbf{x}_{f} + \\mathbf{K}\\mathbf{d}$\n- 预测的分析空间观测值：$\\mathbf{y}_{a} = \\mathbf{H}\\mathbf{x}_{a}$\n- 分析残差向量：$\\mathbf{r} = \\mathbf{y} - \\mathbf{y}_{a}$\n- 影响矩阵：$\\mathbf{A} = \\mathbf{H}\\mathbf{K} \\in \\mathbb{R}^{m \\times m}$\n- 对观测 $i$ 的留一法（LOO）程序：在极限 $\\Delta \\to +\\infty$ 下，使用修正的观测误差协方差 $\\mathbf{R}^{(\\Delta)} = \\mathbf{R} + \\Delta \\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}$ 重新计算分析。\n- LOO 残差向量：$\\mathbf{r}^{\\mathrm{LOO}}$ 是从 LOO 分析中得到的、对照完整观测 $\\mathbf{y}$ 评估的残差。\n- $r_{i}^{\\mathrm{LOO}}$：$\\mathbf{r}^{\\mathrm{LOO}}$ 的第 $i$ 个分量。\n- $r_{i}$：$\\mathbf{r}$ 的第 $i$ 个分量。\n- $A_{ii}$：$\\mathbf{A}$ 的第 $i$ 个对角线元素。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学基础扎实：** 该问题牢固地植根于线性高斯数据同化和统计估计（特别是最佳线性无偏估计或 BLUE）的标准理论。所有定义和方程在该领域都是标准的。\n- **适定性：** 该问题提供了所有必要的定义，并要求进行特定的推导。线性高斯框架确保了所定义的量存在且唯一。目标是推导一个已知的恒等式，因此保证存在有意义的解。\n- **客观性：** 语言精确且数学化。没有主观或模糊的术语。\n- **完整性：** 该问题是自洽的。它提供了所有必要的公式和定义。\n- **一致性：** 定义在内部是一致的，并遵循标准惯例。\n- **现实性：** 该设置是数据同化中的一个典型模型，被广泛应用于众多科学和工程学科。\n\n**1.3. 结论与行动**\n问题是有效的。这是数据同化领域一个标准的、适定的、有科学依据的推导。我将继续进行求解。\n\n### 步骤 2：LOO 残差公式的推导\n\n目标是推导一个用 $r_{i}$ 和 $A_{ii}$ 表示 $r_{i}^{\\mathrm{LOO}}$ 的表达式。\n\n首先，我们建立残差向量 $\\mathbf{r}$、新息向量 $\\mathbf{d}$ 和影响矩阵 $\\mathbf{A}$ 之间的关系。\n根据定义，残差为 $\\mathbf{r} = \\mathbf{y} - \\mathbf{y}_{a}$。代入 $\\mathbf{y}_{a}$ 和 $\\mathbf{x}_{a}$ 的表达式：\n$$\n\\mathbf{r} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}_{a} = \\mathbf{y} - \\mathbf{H}(\\mathbf{x}_{f} + \\mathbf{K}\\mathbf{d})\n$$\n整理各项并使用新息的定义 $\\mathbf{d} = \\mathbf{y} - \\mathbf{H}\\mathbf{x}_{f}$：\n$$\n\\mathbf{r} = (\\mathbf{y} - \\mathbf{H}\\mathbf{x}_{f}) - \\mathbf{H}\\mathbf{K}\\mathbf{d} = \\mathbf{d} - \\mathbf{A}\\mathbf{d} = (\\mathbf{I} - \\mathbf{A})\\mathbf{d}\n$$\n其中 $\\mathbf{I}$ 是 $m \\times m$ 的单位矩阵。\n\n接下来，我们为 $(\\mathbf{I} - \\mathbf{A})$ 建立一个重要的恒等式。使用 $\\mathbf{A}$、$\\mathbf{K}$ 和 $\\mathbf{S}$ 的定义：\n$$\n\\mathbf{A} = \\mathbf{H}\\mathbf{K} = \\mathbf{H}(\\mathbf{B}\\mathbf{H}^{\\top})\\mathbf{S}^{-1}\n$$\n因为 $\\mathbf{S} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} + \\mathbf{R}$，我们有 $\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} = \\mathbf{S} - \\mathbf{R}$。将此代入 $\\mathbf{A}$ 的表达式中：\n$$\n\\mathbf{A} = (\\mathbf{S} - \\mathbf{R})\\mathbf{S}^{-1} = \\mathbf{S}\\mathbf{S}^{-1} - \\mathbf{R}\\mathbf{S}^{-1} = \\mathbf{I} - \\mathbf{R}\\mathbf{S}^{-1}\n$$\n这给了我们恒等式 $\\mathbf{I} - \\mathbf{A} = \\mathbf{R}\\mathbf{S}^{-1}$。\n由于观测误差方差 $\\sigma_i^2$ 是正的，$\\mathbf{R}$ 是正定的，因此是可逆的。矩阵 $\\mathbf{S}$ 作为一个半正定矩阵 $\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top}$ 和一个正定矩阵 $\\mathbf{R}$ 的和，也是正定且可逆的。因此，矩阵 $(\\mathbf{I} - \\mathbf{A})$ 是可逆的。\n从 $\\mathbf{r} = (\\mathbf{I} - \\mathbf{A})\\mathbf{d}$，我们可以用 $\\mathbf{r}$ 来表示 $\\mathbf{d}$：\n$$\n\\mathbf{d} = (\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{r}\n$$\n使用我们的恒等式，$(\\mathbf{I} - \\mathbf{A})^{-1} = (\\mathbf{R}\\mathbf{S}^{-1})^{-1} = \\mathbf{S}\\mathbf{R}^{-1}$。所以我们有：\n$$\n\\mathbf{d} = \\mathbf{S}\\mathbf{R}^{-1}\\mathbf{r}\n$$\n\n现在，我们考虑对第 $i$ 个观测的留一法（LOO）分析。这是通过使用一个修正的观测误差协方差矩阵 $\\mathbf{R}^{(\\Delta)} = \\mathbf{R} + \\Delta \\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}$ 并取极限 $\\Delta \\to +\\infty$ 来实现的。让我们用上标 `(i)` 来表示用这个修正后的协方差计算出的量。\n新的新息协方差矩阵是：\n$$\n\\mathbf{S}^{(i)} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} + \\mathbf{R}^{(i)} = (\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top} + \\mathbf{R}) + \\Delta \\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top} = \\mathbf{S} + \\Delta \\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\n$$\n为了求这个秩为1更新后矩阵的逆，我们使用谢尔曼-莫里森公式（Sherman-Morrison formula）：$(\\mathbf{M} + \\mathbf{u}\\mathbf{v}^{\\top})^{-1} = \\mathbf{M}^{-1} - \\frac{\\mathbf{M}^{-1}\\mathbf{u}\\mathbf{v}^{\\top}\\mathbf{M}^{-1}}{1 + \\mathbf{v}^{\\top}\\mathbf{M}^{-1}\\mathbf{u}}$。\n令 $\\mathbf{M}=\\mathbf{S}$、$\\mathbf{u}=\\Delta \\mathbf{e}_{i}$ 和 $\\mathbf{v}=\\mathbf{e}_{i}^{\\top}$，我们得到：\n$$\n(\\mathbf{S}^{(i)})^{-1} = \\mathbf{S}^{-1} - \\frac{\\mathbf{S}^{-1}(\\Delta \\mathbf{e}_{i})\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{1 + \\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}(\\Delta \\mathbf{e}_{i})} = \\mathbf{S}^{-1} - \\frac{\\Delta \\mathbf{S}^{-1}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{1 + \\Delta (\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i})}\n$$\n为了计算当 $\\Delta \\to +\\infty$ 时的极限，我们将分数的分子和分母同时除以 $\\Delta$：\n$$\n(\\mathbf{S}^{(i)})^{-1} = \\mathbf{S}^{-1} - \\frac{\\mathbf{S}^{-1}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\frac{1}{\\Delta} + \\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n令 $(\\mathbf{S}^{\\mathrm{LOO}})^{-1} = \\lim_{\\Delta \\to \\infty} (\\mathbf{S}^{(i)})^{-1}$：\n$$\n(\\mathbf{S}^{\\mathrm{LOO}})^{-1} = \\mathbf{S}^{-1} - \\frac{\\mathbf{S}^{-1}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\nLOO分析不改变预报 $\\mathbf{x}_f$ 或观测 $\\mathbf{y}$，所以新息 $\\mathbf{d}$ 保持不变。LOO残差向量 $\\mathbf{r}^{\\mathrm{LOO}}$ 由下式给出：\n$$\n\\mathbf{r}^{\\mathrm{LOO}} = (\\mathbf{I} - \\mathbf{A}^{\\mathrm{LOO}})\\mathbf{d}\n$$\n其中 $\\mathbf{A}^{\\mathrm{LOO}} = \\mathbf{H}\\mathbf{K}^{\\mathrm{LOO}} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\top}(\\mathbf{S}^{\\mathrm{LOO}})^{-1} = (\\mathbf{S}-\\mathbf{R})(\\mathbf{S}^{\\mathrm{LOO}})^{-1}$。\n$$\n\\mathbf{A}^{\\mathrm{LOO}} = (\\mathbf{S}-\\mathbf{R})\\left(\\mathbf{S}^{-1} - \\frac{\\mathbf{S}^{-1}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\\right) = (\\mathbf{S}-\\mathbf{R})\\mathbf{S}^{-1} - \\frac{(\\mathbf{S}-\\mathbf{R})\\mathbf{S}^{-1}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n认识到 $\\mathbf{A} = (\\mathbf{S}-\\mathbf{R})\\mathbf{S}^{-1}$，我们得到：\n$$\n\\mathbf{A}^{\\mathrm{LOO}} = \\mathbf{A} - \\frac{\\mathbf{A}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n现在我们计算 $\\mathbf{r}^{\\mathrm{LOO}}$：\n$$\n\\mathbf{r}^{\\mathrm{LOO}} = \\left(\\mathbf{I} - \\left(\\mathbf{A} - \\frac{\\mathbf{A}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\\right)\\right)\\mathbf{d} = (\\mathbf{I}-\\mathbf{A})\\mathbf{d} + \\frac{\\mathbf{A}\\mathbf{e}_{i}\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d}}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n由于 $\\mathbf{r} = (\\mathbf{I}-\\mathbf{A})\\mathbf{d}$，这简化为：\n$$\n\\mathbf{r}^{\\mathrm{LOO}} = \\mathbf{r} + \\frac{\\mathbf{A}\\mathbf{e}_{i}(\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d})}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n我们关心的是第 $i$ 个分量，$r_{i}^{\\mathrm{LOO}} = \\mathbf{e}_{i}^{\\top}\\mathbf{r}^{\\mathrm{LOO}}$：\n$$\nr_{i}^{\\mathrm{LOO}} = \\mathbf{e}_{i}^{\\top}\\mathbf{r} + \\mathbf{e}_{i}^{\\top}\\frac{\\mathbf{A}\\mathbf{e}_{i}(\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d})}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}} = r_{i} + \\frac{(\\mathbf{e}_{i}^{\\top}\\mathbf{A}\\mathbf{e}_{i})(\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d})}{\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}}\n$$\n项 $\\mathbf{e}_{i}^{\\top}\\mathbf{A}\\mathbf{e}_{i}$ 是 $\\mathbf{A}$ 的第 $(i,i)$ 个元素，即 $A_{ii}$。项 $\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{e}_{i}$ 是 $\\mathbf{S}^{-1}$ 的第 $(i,i)$ 个元素，我们记为 $(\\mathbf{S}^{-1})_{ii}$。\n$$\nr_{i}^{\\mathrm{LOO}} = r_{i} + \\frac{A_{ii}(\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d})}{(\\mathbf{S}^{-1})_{ii}}\n$$\n为了简化项 $\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d}$，我们使用关系式 $\\mathbf{d} = \\mathbf{S}\\mathbf{R}^{-1}\\mathbf{r}$：\n$$\n\\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}\\mathbf{d} = \\mathbf{e}_{i}^{\\top}\\mathbf{S}^{-1}(\\mathbf{S}\\mathbf{R}^{-1}\\mathbf{r}) = \\mathbf{e}_{i}^{\\top}\\mathbf{R}^{-1}\\mathbf{r}\n$$\n由于 $\\mathbf{R} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{m}^{2})$，其逆矩阵是 $\\mathbf{R}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2}, \\dots, 1/\\sigma_{m}^{2})$。向量 $\\mathbf{R}^{-1}\\mathbf{r}$ 的分量为 $r_k/\\sigma_k^2$。所以，$\\mathbf{e}_{i}^{\\top}\\mathbf{R}^{-1}\\mathbf{r}$ 是它的第 $i$ 个分量，$r_i/\\sigma_i^2$。\n$$\nr_{i}^{\\mathrm{LOO}} = r_{i} + \\frac{A_{ii}(r_{i}/\\sigma_{i}^{2})}{(\\mathbf{S}^{-1})_{ii}} = r_{i}\\left(1 + \\frac{A_{ii}/\\sigma_{i}^{2}}{(\\mathbf{S}^{-1})_{ii}}\\right)\n$$\n为了简化 $(\\mathbf{S}^{-1})_{ii}$，我们使用矩阵恒等式 $\\mathbf{I} - \\mathbf{A} = \\mathbf{R}\\mathbf{S}^{-1}$。取该方程的第 $(i,i)$ 个元素：\n$$\n(\\mathbf{I} - \\mathbf{A})_{ii} = 1 - A_{ii}\n$$\n$$\n(\\mathbf{R}\\mathbf{S}^{-1})_{ii} = \\sum_{k=1}^{m} R_{ik}(\\mathbf{S}^{-1})_{ki}\n$$\n由于 $\\mathbf{R}$ 是对角矩阵，当 $k \\ne i$ 时 $R_{ik} = 0$，且 $R_{ii} = \\sigma_i^2$。该和式简化为一项：\n$$\n(\\mathbf{R}\\mathbf{S}^{-1})_{ii} = R_{ii}(\\mathbf{S}^{-1})_{ii} = \\sigma_{i}^{2}(\\mathbf{S}^{-1})_{ii}\n$$\n因此，我们有 $1 - A_{ii} = \\sigma_{i}^{2}(\\mathbf{S}^{-1})_{ii}$。由于 $\\mathbf{S}^{-1}$ 是正定的，$(\\mathbf{S}^{-1})_{ii} > 0$，这意味着 $A_{ii}  1$。我们可以写出：\n$$\n(\\mathbf{S}^{-1})_{ii} = \\frac{1 - A_{ii}}{\\sigma_{i}^{2}}\n$$\n将此代入我们关于 $r_{i}^{\\mathrm{LOO}}$ 的表达式中：\n$$\nr_{i}^{\\mathrm{LOO}} = r_{i}\\left(1 + \\frac{A_{ii}/\\sigma_{i}^{2}}{(1 - A_{ii})/\\sigma_{i}^{2}}\\right) = r_{i}\\left(1 + \\frac{A_{ii}}{1 - A_{ii}}\\right)\n$$\n简化括号中的项：\n$$\n1 + \\frac{A_{ii}}{1 - A_{ii}} = \\frac{1 - A_{ii}}{1 - A_{ii}} + \\frac{A_{ii}}{1 - A_{ii}} = \\frac{1 - A_{ii} + A_{ii}}{1 - A_{ii}} = \\frac{1}{1 - A_{ii}}\n$$\n最后，我们得到了闭式表达式：\n$$\nr_{i}^{\\mathrm{LOO}} = \\frac{r_{i}}{1 - A_{ii}}\n$$\n这个表达式将第 $i$ 个观测的留一法残差直接与标准残差 $r_i$ 及影响矩阵的相应对角线元素 $A_{ii}$ 联系起来。", "answer": "$$\n\\boxed{\\frac{r_{i}}{1 - A_{ii}}}\n$$", "id": "3391037"}]}