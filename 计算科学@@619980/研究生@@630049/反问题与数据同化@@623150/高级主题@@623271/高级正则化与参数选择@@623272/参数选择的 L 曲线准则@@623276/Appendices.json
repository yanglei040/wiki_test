{"hands_on_practices": [{"introduction": "L曲线是理解正则化参数选择的核心工具，它描绘了解的范数与残差范数之间的权衡关系。本练习将引导你通过奇异值分解（SVD）来推导构成L曲线坐标轴的这两个关键范数的解析表达式。通过这一过程，你将深入理解L曲线为何呈现其特有的“L”形状，并学会如何通过计算曲率来精确定位权衡最佳点，即“拐角”[@problem_id:3394301]。", "problem": "考虑线性反问题 $A x = b$，其中 $A \\in \\mathbb{R}^{m \\times n}$，及其零阶Tikhonov正则化解\n$$\nx_{\\lambda} \\in \\arg \\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|x\\|_{2}^{2} \\right\\},\n$$\n其中 $\\lambda > 0$ 是正则化参数。设 $A$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中奇异值 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{r} > 0$ 位于 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 的对角线上，左奇异向量为 $\\{u_{i}\\}_{i=1}^{m}$（$U$ 的列），右奇异向量为 $\\{v_{i}\\}_{i=1}^{n}$（$V$ 的列）。将数据 $b$ 分解为 $b = \\sum_{i=1}^{r} (u_{i}^{\\top} b) u_{i} + b_{\\perp}$，其中 $b_{\\perp}$ 是与 $A$ 的值域正交的分量。定义残差范数 $r(\\lambda) := \\|A x_{\\lambda} - b\\|_{2}$ 和解的半范数 $p(\\lambda) := \\|x_{\\lambda}\\|_{2}$。\n\n任务：\n1) 从 $x_{\\lambda}$ 的定义和 $A$ 的 SVD 出发，推导以下表达式\n$$\nr(\\lambda)^{2} \\;=\\; \\sum_{i=1}^{r} \\left(\\frac{\\lambda^{2}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)^{2} (u_{i}^{\\top} b)^{2} \\;+\\; \\|b_{\\perp}\\|_{2}^{2},\n\\quad\np(\\lambda)^{2} \\;=\\; \\sum_{i=1}^{r} \\left(\\frac{\\sigma_{i}^{2}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)^{2} \\frac{(u_{i}^{\\top} b)^{2}}{\\sigma_{i}^{2}}.\n$$\n2) 分析 $r(\\lambda)$ 和 $p(\\lambda)$ 如何依赖于 $\\lambda$ 以及数据系数 $(u_{i}^{\\top} b)$ 相对于奇异值 $\\sigma_{i}$ 的衰减率，包括它们在 $\\lambda \\to 0^{+}$ 和 $\\lambda \\to \\infty$ 时的极限。\n3) 定义L曲线为参数曲线 $L(\\lambda) = \\big(\\ln r(\\lambda), \\ln p(\\lambda)\\big)$。平面参数曲线 $(x(\\lambda), y(\\lambda))$ 的曲率由下式给出\n$$\n\\kappa(\\lambda) \\;=\\; \\frac{|x'(\\lambda)\\, y''(\\lambda) \\;-\\; y'(\\lambda)\\, x''(\\lambda)|}{\\big(x'(\\lambda)^{2} + y'(\\lambda)^{2}\\big)^{3/2}}.\n$$\n对于奇异值为 $\\sigma_{1} = 10$, $\\sigma_{2} = 1$, $\\sigma_{3} = 0.1$，数据系数为 $u_{1}^{\\top} b = 1$, $u_{2}^{\\top} b = 0.01$, $u_{3}^{\\top} b = 0.0001$，且 $b_{\\perp} = 0$ 的特定3维问题，计算L曲线在 $\\lambda = 1$ 处的曲率 $\\kappa(1)$。将最终答案四舍五入到4位有效数字。最终答案无单位，必须以单个实数形式给出。", "solution": "该问题要求对一个反问题的Tikhonov正则化解 $x_{\\lambda}$ 进行三部分分析。首先，我们推导残差范数和解范数的表达式。其次，我们分析它们的行为。第三，我们计算一个特定情况下的L曲线曲率。\n\n**第一部分：$r(\\lambda)^2$ 和 $p(\\lambda)^2$ 的推导**\n\nTikhonov正则化解 $x_{\\lambda}$ 最小化泛函 $J(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|x\\|_{2}^{2}$。通过将 $J(x)$ 关于 $x$ 的梯度设为零来找到最小值：\n$$\n\\nabla_{x} J(x) = 2 A^{\\top}(A x - b) + 2 \\lambda^{2} x = 0.\n$$\n这导出了正规方程组：\n$$\n(A^{\\top}A + \\lambda^{2} I) x_{\\lambda} = A^{\\top}b.\n$$\n因此解为 $x_{\\lambda} = (A^{\\top}A + \\lambda^{2} I)^{-1} A^{\\top}b$。我们代入奇异值分解 (SVD) $A = U \\Sigma V^{\\top}$。\n$A^{\\top}A = (V \\Sigma^{\\top} U^{\\top})(U \\Sigma V^{\\top}) = V \\Sigma^{\\top}\\Sigma V^{\\top}$。矩阵 $\\Sigma^{\\top}\\Sigma$ 是一个 $n \\times n$ 的对角矩阵，其对角线上的元素为 $\\sigma_i^2$ ($i=1, \\dots, r$)，其余元素为零。我们将其记为 $\\Sigma_n^2$。\n所以，$A^{\\top}A = V \\Sigma_n^2 V^{\\top}$。同时，$A^{\\top}b = V \\Sigma^{\\top} U^{\\top}b$。将这些代入 $x_{\\lambda}$ 的表达式中：\n$$\nx_{\\lambda} = (V \\Sigma_n^2 V^{\\top} + \\lambda^{2} V V^{\\top})^{-1} V \\Sigma^{\\top} U^{\\top}b = (V(\\Sigma_n^2 + \\lambda^{2} I)V^{\\top})^{-1} V \\Sigma^{\\top} U^{\\top}b.\n$$\n使用性质 $(XYZ)^{-1} = Z^{-1}Y^{-1}X^{-1}$ 和 $V^{-1}=V^{\\top}$，我们得到：\n$$\nx_{\\lambda} = V(\\Sigma_n^2 + \\lambda^{2} I)^{-1}V^{\\top} V \\Sigma^{\\top} U^{\\top}b = V (\\Sigma_n^2 + \\lambda^{2} I)^{-1} \\Sigma^{\\top} U^{\\top}b.\n$$\n矩阵 $(\\Sigma_n^2 + \\lambda^{2} I)^{-1} \\Sigma^{\\top}$ 是一个 $n \\times m$ 矩阵。它的非零元素在对角线上，值为 $\\frac{\\sigma_i}{\\sigma_i^2 + \\lambda^2}$ ($i=1, \\dots, r$)。\n设 $\\hat{b}_i = u_i^{\\top}b$。向量 $U^{\\top}b$ 包含这些系数。\n$(\\Sigma_n^2 + \\lambda^2 I)^{-1} \\Sigma^{\\top}$ 作用于 $U^{\\top}b$ 产生一个 $\\mathbb{R}^n$ 中的向量，其第 $i$ 个分量为 $\\frac{\\sigma_i \\hat{b}_i}{\\sigma_i^2 + \\lambda^2}$ ($i=1, \\dots, r$)，其余分量为零。\n乘以 $V$ 将此向量表示在右奇异向量 $\\{v_i\\}$ 的基上：\n$$\nx_{\\lambda} = \\sum_{i=1}^{r} \\frac{\\sigma_i (u_i^{\\top}b)}{\\sigma_i^2 + \\lambda^2} v_i.\n$$\n现在我们计算解的半范数 $p(\\lambda) = \\|x_{\\lambda}\\|_2$。由于向量 $\\{v_i\\}$ 是标准正交的，其范数的平方是系数的平方和：\n$$\np(\\lambda)^2 = \\|x_{\\lambda}\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i (u_i^{\\top}b)}{\\sigma_i^2 + \\lambda^2}\\right)^2 = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 \\frac{(u_i^{\\top}b)^2}{\\sigma_i^2}.\n$$\n这证实了第二个公式。\n\n接下来，我们计算残差范数 $r(\\lambda) = \\|A x_{\\lambda} - b\\|_2$。首先，求 $A x_{\\lambda}$：\n$$\nA x_{\\lambda} = (U \\Sigma V^{\\top}) \\left( \\sum_{j=1}^{r} \\frac{\\sigma_j (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} v_j \\right) = \\sum_{j=1}^{r} \\frac{\\sigma_j (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} (U \\Sigma V^{\\top} v_j).\n$$\n由于 $V^{\\top}v_j=e_j$（第 $j$ 个标准基向量）且 $\\Sigma e_j = \\sigma_j e_j$，我们有 $U\\Sigma V^{\\top}v_j = U (\\sigma_j e_j) = \\sigma_j u_j$。\n$$\nA x_{\\lambda} = \\sum_{j=1}^{r} \\frac{\\sigma_j^2 (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} u_j.\n$$\n残差向量是 $A x_{\\lambda} - b$。使用给定的分解 $b = \\sum_{i=1}^{r} (u_i^{\\top}b)u_i + b_{\\perp}$：\n$$\nA x_{\\lambda} - b = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} - 1\\right) (u_i^{\\top}b) u_i - b_{\\perp} = \\sum_{i=1}^{r} \\left(\\frac{-\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right) (u_i^{\\top}b) u_i - b_{\\perp}.\n$$\n向量 $\\{u_i\\}$ 是标准正交的，且与 $b_{\\perp}$ 正交。因此，范数的平方是：\n$$\nr(\\lambda)^2 = \\|A x_{\\lambda} - b\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{-\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 (u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 (u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2.\n$$\n这证实了第一个公式。\n\n**第二部分：$r(\\lambda)$ 和 $p(\\lambda)$ 的分析**\n\n函数 $p(\\lambda)$ 和 $r(\\lambda)$ 关于 $\\lambda > 0$ 表现出单调性。\n项 $\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2}$ 是 $\\lambda$ 的递减函数。由于它在 $p(\\lambda)^2$ 的求和式中以平方形式出现，$p(\\lambda)$ 必定是 $\\lambda$ 的严格递减函数。\n项 $\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} = 1 - \\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2}$ 是 $\\lambda$ 的递增函数。由于它在 $r(\\lambda)^2$ 的求和式中以平方形式出现，$r(\\lambda)$ 必定是 $\\lambda$ 的严格递增函数。\n\n$\\lambda \\to 0^{+}$ 时的极限：\n当 $\\lambda \\to 0^{+}$ 时，$\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2} \\to 1$。因此，$p(\\lambda)^2 \\to \\sum_{i=1}^{r} \\frac{(u_i^{\\top}b)^2}{\\sigma_i^2}$。这是 Moore-Penrose 伪逆解 $x^{\\dagger} = \\sum_{i=1}^r \\frac{u_i^{\\top}b}{\\sigma_i}v_i$ 的范数平方。如果不满足离散Picard条件（即 $|u_i^{\\top}b|$ 的衰减速度慢于 $\\sigma_i$），在连续情况下此范数可能非常大或为无穷大。\n当 $\\lambda \\to 0^{+}$ 时，$\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} \\to 0$。因此，$r(\\lambda)^2 \\to \\|b_{\\perp}\\|_2^2$。这是与 $A$ 的值域正交的数据分量的范数，代表了可能的最小残差（最小二乘残差）。\n\n$\\lambda \\to \\infty$ 时的极限：\n当 $\\lambda \\to \\infty$ 时，$\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2} \\sim \\frac{\\sigma_i^2}{\\lambda^2} \\to 0$。因此，$p(\\lambda)^2 \\to 0$。解被高度阻尼并趋近于零向量。\n当 $\\lambda \\to \\infty$ 时，$\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} \\to 1$。因此，$r(\\lambda)^2 \\to \\sum_{i=1}^r(u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2 = \\|b\\|_2^2$。当 $x_\\lambda \\to 0$ 时，残差 $Ax_\\lambda-b$ 趋近于 $-b$，所以其范数趋近于 $\\|b\\|_2$。\n\nL曲线绘制了 $\\ln p(\\lambda)$ 关于 $\\ln r(\\lambda)$ 的图像，由于这种行为，它通常呈L形。小的 $\\lambda$ 值对应于垂直部分（小残差，大解范数），而大的 $\\lambda$ 值对应于水平部分（大残差，小解范数）。\n\n**第三部分：曲率计算**\n\n给定L曲线 $L(\\lambda) = (x(\\lambda), y(\\lambda)) = (\\ln r(\\lambda), \\ln p(\\lambda))$，要求我们计算特定情况下的曲率 $\\kappa(1)$。\n使用范数的平方 $\\rho(\\lambda) = r(\\lambda)^2$ 和 $\\pi(\\lambda) = p(\\lambda)^2$ 更为方便。则曲线坐标为 $x(\\lambda) = \\frac{1}{2}\\ln \\rho(\\lambda)$ 和 $y(\\lambda) = \\frac{1}{2}\\ln \\pi(\\lambda)$。\n我们需要 $x(\\lambda)$ 和 $y(\\lambda)$ 在 $\\lambda=1$ 处的一阶和二阶导数。\n$x'(\\lambda) = \\frac{\\rho'(\\lambda)}{2\\rho(\\lambda)}$, $x''(\\lambda) = \\frac{\\rho''(\\lambda)\\rho(\\lambda) - (\\rho'(\\lambda))^2}{2\\rho(\\lambda)^2}$。\n$y'(\\lambda) = \\frac{\\pi'(\\lambda)}{2\\pi(\\lambda)}$, $y''(\\lambda) = \\frac{\\pi''(\\lambda)\\pi(\\lambda) - (\\pi'(\\lambda))^2}{2\\pi(\\lambda)^2}$。\n\n问题指定 $\\sigma_1 = 10, \\sigma_2 = 1, \\sigma_3 = 0.1$，且 $b_{\\perp}=0$。数据系数的平方为 $\\beta_1 = (u_1^{\\top}b)^2=1^2=1$, $\\beta_2 = (u_2^{\\top}b)^2=(0.01)^2=10^{-4}$, $\\beta_3 = (u_3^{\\top}b)^2=(0.0001)^2=10^{-8}$。\n函数为：\n$\\rho(\\lambda) = \\sum_{i=1}^{3} \\left(\\frac{\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^{2} \\beta_i$，以及 $\\pi(\\lambda) = \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^2}$。\n它们关于 $\\lambda$ 的导数是：\n$\\rho'(\\lambda) = 4\\lambda^3 \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^3}$。\n$\\pi'(\\lambda) = -4\\lambda \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^3}$。\n在 $\\lambda=1$ 时，我们有 $\\rho'(1) = -\\pi'(1)$。\n$\\rho''(\\lambda)=12\\lambda^2 \\sum_{i=1}^{3} \\frac{\\beta_i \\sigma_i^2(\\sigma_i^2 - \\lambda^2)}{(\\sigma_i^2 + \\lambda^2)^4}$。\n$\\pi''(\\lambda) = \\sum_{i=1}^{3} \\frac{\\beta_i \\sigma_i^2 (20\\lambda^2 - 4\\sigma_i^2)}{(\\sigma_i^2 + \\lambda^2)^4}$。\n\n在 $\\lambda=1$ 时：\n$\\rho(1) = (\\frac{1}{101})^2(1) + (\\frac{1}{2})^2(10^{-4}) + (\\frac{1}{1.01})^2(10^{-8}) \\approx 1.2304 \\times 10^{-4}$。\n$\\pi(1) = \\frac{100(1)}{101^2} + \\frac{1(10^{-4})}{2^2} + \\frac{0.01(10^{-8})}{1.01^2} \\approx 9.8280 \\times 10^{-3}$。\n$\\rho'(1) = 4(\\frac{100}{101^3} + \\frac{10^{-4}}{2^3} + \\frac{0.001}{1.01^3}) \\approx 4.3824 \\times 10^{-4}$。\n因此 $\\pi'(1) \\approx -4.3824 \\times 10^{-4}$。\n$\\rho''(1) = 12(\\frac{100(99)}{101^4} + \\frac{1(10^{-4})(0)}{2^4} + \\frac{0.01(10^{-8})(-0.99)}{1.01^4}) \\approx 1.1416 \\times 10^{-3}$。\n$\\pi''(1) = \\frac{100(20-400)}{101^4} + \\frac{10^{-4}(20-4)}{2^4} + \\frac{0.01(10^{-8})(20-0.04)}{1.01^4} \\approx -2.6517 \\times 10^{-4}$。\n\n现在我们计算L曲线坐标的导数：\n$x'(1) = \\frac{\\rho'(1)}{2\\rho(1)} \\approx \\frac{4.3824 \\times 10^{-4}}{2(1.2304 \\times 10^{-4})} \\approx 1.7809$。\n$y'(1) = \\frac{\\pi'(1)}{2\\pi(1)} \\approx \\frac{-4.3824 \\times 10^{-4}}{2(9.8280 \\times 10^{-3})} \\approx -0.022293$。\n$x''(1) = \\frac{\\rho''(1)\\rho(1) - \\rho'(1)^2}{2\\rho(1)^2} \\approx \\frac{(1.1416 \\times 10^{-3})(1.2304 \\times 10^{-4}) - (4.3824 \\times 10^{-4})^2}{2(1.2304 \\times 10^{-4})^2} \\approx -1.7036$。\n$y''(1) = \\frac{\\pi''(1)\\pi(1) - \\pi'(1)^2}{2\\pi(1)^2} \\approx \\frac{(-2.6517 \\times 10^{-4})(9.8280 \\times 10^{-3}) - (-4.3824 \\times 10^{-4})^2}{2(9.8280 \\times 10^{-3})^2} \\approx -0.014484$。\n\n最后，将这些值代入曲率公式 $\\kappa(\\lambda) = \\frac{|x' y'' - y' x''|}{(x'^2 + y'^2)^{3/2}}$：\n分子：\n$|x'(1)y''(1) - y'(1)x''(1)| \\approx |(1.7809)(-0.014484) - (-0.022293)(-1.7036)|$\n$\\approx |-0.025795 - 0.037976| = |-0.063771| = 0.063771$。\n分母：\n$(x'(1)^2+y'(1)^2)^{3/2} \\approx ((1.7809)^2 + (-0.022293)^2)^{3/2}$\n$\\approx (3.1716 + 0.000497)^{3/2} = (3.1721)^{3/2} \\approx 5.6482$。\n\n$\\kappa(1) \\approx \\frac{0.063771}{5.6482} \\approx 0.0112905$。\n四舍五入到4位有效数字，曲率为 $0.01129$。", "answer": "$$\\boxed{0.01129}$$", "id": "3394301"}, {"introduction": "在实际应用中，我们对问题进行建模时所选用的单位或尺度可能会有所不同，一个鲁棒的参数选择方法不应受这些任意选择的影响。本练习旨在探究L曲线的几何不变性，通过分析算子、数据和正则化矩阵的尺度变换如何影响L曲线的形状和参数化[@problem_id:3394265]。你将证明L曲线的几何形状在此类变换下保持不变，而最佳正则化参数会以一种可预测的方式进行伸缩，这揭示了L曲线方法的一个重要优点。", "problem": "考虑一个有限维欧几里得空间中的线性吉洪诺夫（Tikhonov）正则化问题：对于给定的矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和 $L \\in \\mathbb{R}^{p \\times n}$，以及数据向量 $b \\in \\mathbb{R}^{m}$，为每个正则化参数 $\\lambda > 0$ 定义吉洪诺夫解 $x_{\\lambda} \\in \\mathbb{R}^{n}$ 为严格凸泛函\n$$\nJ_{\\lambda}(x) \\equiv \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2}\n$$\n的唯一极小化子，此处假设对于所有 $\\lambda > 0$，$A^{\\top} A + \\lambda^{2} L^{\\top} L$ 都是可逆的（例如，$\\mathrm{null}(A) \\cap \\mathrm{null}(L) = \\{0\\}$）。L-曲线是平面上的参数曲线 $\\lambda \\mapsto \\big(\\xi(\\lambda), \\nu(\\lambda)\\big)$，其坐标为\n$$\n\\xi(\\lambda) \\equiv \\ln\\big(\\rho(\\lambda)\\big), \\quad \\nu(\\lambda) \\equiv \\ln\\big(\\eta(\\lambda)\\big),\n$$\n其中 $\\rho(\\lambda) \\equiv \\|A x_{\\lambda} - b\\|_{2}$ 且 $\\eta(\\lambda) \\equiv \\|L x_{\\lambda}\\|_{2}$。该平面曲线的曲率，作为参数 $\\lambda$ 的函数，由标准公式定义\n$$\n\\kappa(\\lambda) \\equiv \\frac{\\big|\\xi'(\\lambda)\\,\\nu''(\\lambda) - \\nu'(\\lambda)\\,\\xi''(\\lambda)\\big|}{\\big(\\big(\\xi'(\\lambda)\\big)^{2} + \\big(\\nu'(\\lambda)\\big)^{2}\\big)^{3/2}}.\n$$\n现在考虑通过变换 $A \\mapsto \\alpha A$，$b \\mapsto \\beta b$，$L \\mapsto \\gamma L$ 得到的缩放问题，其中 $\\alpha, \\beta, \\gamma \\in \\mathbb{R}_{>0}$。对于相同的参数值 $\\lambda > 0$，定义 $x^{\\alpha,\\beta,\\gamma}_{\\lambda}$ 为\n$$\nJ^{\\alpha,\\beta,\\gamma}_{\\lambda}(x) \\equiv \\|\\alpha A x - \\beta b\\|_{2}^{2} + \\lambda^{2} \\|\\gamma L x\\|_{2}^{2}\n$$\n的唯一极小化子，并定义相应的 L-曲线坐标和曲率为\n$$\n\\xi_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\ln\\big(\\rho_{\\alpha,\\beta,\\gamma}(\\lambda)\\big), \\quad \\nu_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\ln\\big(\\eta_{\\alpha,\\beta,\\gamma}(\\lambda)\\big), \\quad \\kappa_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\frac{\\big|\\xi'_{\\alpha,\\beta,\\gamma}(\\lambda)\\,\\nu''_{\\alpha,\\beta,\\gamma}(\\lambda) - \\nu'_{\\alpha,\\beta,\\gamma}(\\lambda)\\,\\xi''_{\\alpha,\\beta,\\gamma}(\\lambda)\\big|}{\\big(\\big(\\xi'_{\\alpha,\\beta,\\gamma}(\\lambda)\\big)^{2} + \\big(\\nu'_{\\alpha,\\beta,\\gamma}(\\lambda)\\big)^{2}\\big)^{3/2}},\n$$\n其中 $\\rho_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\|\\alpha A x^{\\alpha,\\beta,\\gamma}_{\\lambda} - \\beta b\\|_{2}$ 且 $\\eta_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\|\\gamma L x^{\\alpha,\\beta,\\gamma}_{\\lambda}\\|_{2}$。\n\n从上述定义以及线性系统和范数的基本性质出发，推导缩放参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 对 $(\\xi,\\nu)$ 平面中的 L-曲线坐标以及作为 $\\lambda$ 函数的曲率的影响。特别地，展示缩放后的 L-曲线的曲率如何通过 $\\lambda$ 的重新参数化与未缩放的 L-曲线的曲率相关联。你的最终答案必须是 $\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda)$ 关于 $\\kappa(\\cdot)$、$\\alpha$、$\\beta$ 和 $\\gamma$ 的解析表达式。不需要进行数值计算，也不需要四舍五入。", "solution": "该问题是适定的，并涉及吉洪诺夫（Tikhonov）正则化 L-曲线准则的一个基本性质。我们可以进行形式推导。\n\n未缩放的吉洪诺夫问题旨在最小化泛函\n$$J_{\\lambda}(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2}$$\n唯一的极小化子 $x_{\\lambda}$ 满足正规方程组，该方程组通过将 $J_{\\lambda}(x)$ 对 $x$ 的梯度设为零得到：\n$$\\nabla_{x} J_{\\lambda}(x) = 2 A^{\\top}(A x - b) + 2 \\lambda^{2} L^{\\top}L x = 0$$\n这得到了线性系统：\n$$(A^{\\top}A + \\lambda^{2} L^{\\top}L) x_{\\lambda} = A^{\\top}b$$\n因此，解的形式由 $x_{\\lambda} = (A^{\\top}A + \\lambda^{2} L^{\\top}L)^{-1} A^{\\top}b$ 给出。矩阵 $A^{\\top}A + \\lambda^{2} L^{\\top}L$ 对于 $\\lambda > 0$ 的可逆性是一个前提条件。\n\n类似地，对于缩放后的问题，我们考虑泛函\n$$J^{\\alpha,\\beta,\\gamma}_{\\lambda}(x) = \\|\\alpha A x - \\beta b\\|_{2}^{2} + \\lambda^{2} \\|\\gamma L x\\|_{2}^{2}$$\n极小化子 $x^{\\alpha,\\beta,\\gamma}_{\\lambda}$ 满足相应的正规方程组：\n$$\\nabla_{x} J^{\\alpha,\\beta,\\gamma}_{\\lambda}(x) = 2 (\\alpha A)^{\\top}(\\alpha A x - \\beta b) + 2 (\\lambda \\gamma L)^{\\top}(\\lambda \\gamma L x) = 0$$\n$$\\alpha^{2} A^{\\top}(A x - (\\beta/\\alpha) b) + \\lambda^{2} \\gamma^{2} L^{\\top}L x = 0$$\n整理各项，我们得到缩放问题的线性系统：\n$$(\\alpha^{2} A^{\\top}A + \\lambda^{2} \\gamma^{2} L^{\\top}L) x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\alpha \\beta A^{\\top}b$$\n为了将此解与未缩放的解关联起来，我们处理左侧的矩阵：\n$$\\alpha^{2} \\left( A^{\\top}A + \\frac{\\lambda^{2} \\gamma^{2}}{\\alpha^{2}} L^{\\top}L \\right) x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\alpha \\beta A^{\\top}b$$\n$$\\alpha^{2} \\left( A^{\\top}A + \\left(\\frac{\\lambda \\gamma}{\\alpha}\\right)^{2} L^{\\top}L \\right) x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\alpha \\beta A^{\\top}b$$\n让我们定义一个重新缩放的正则化参数 $\\tilde{\\lambda}$ 作为 $\\lambda$ 的函数：\n$$\\tilde{\\lambda} \\equiv \\frac{\\lambda \\gamma}{\\alpha}$$\n将 $\\tilde{\\lambda}$ 代入方程得到：\n$$\\alpha^{2} (A^{\\top}A + \\tilde{\\lambda}^{2} L^{\\top}L) x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\alpha \\beta A^{\\top}b$$\n解出 $x^{\\alpha,\\beta,\\gamma}_{\\lambda}$：\n$$x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\frac{\\alpha \\beta}{\\alpha^{2}} (A^{\\top}A + \\tilde{\\lambda}^{2} L^{\\top}L)^{-1} A^{\\top}b = \\frac{\\beta}{\\alpha} (A^{\\top}A + \\tilde{\\lambda}^{2} L^{\\top}L)^{-1} A^{\\top}b$$\n我们认出表达式 $(A^{\\top}A + \\tilde{\\lambda}^{2} L^{\\top}L)^{-1} A^{\\top}b$ 是未缩放解 $x_{\\tilde{\\lambda}}$ 的定义。因此，我们建立了缩放解与未缩放解之间的关键关系：\n$$x^{\\alpha,\\beta,\\gamma}_{\\lambda} = \\frac{\\beta}{\\alpha} x_{\\tilde{\\lambda}} = \\frac{\\beta}{\\alpha} x_{\\frac{\\lambda \\gamma}{\\alpha}}$$\n\n接下来，我们分析缩放对 L-曲线坐标的影响。我们首先将缩放后的范数 $\\rho_{\\alpha,\\beta,\\gamma}(\\lambda)$ 和 $\\eta_{\\alpha,\\beta,\\gamma}(\\lambda)$ 与它们未缩放的对应项 $\\rho(\\cdot)$ 和 $\\eta(\\cdot)$ 联系起来。\n对于残差范数：\n$$\\rho_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\|\\alpha A x^{\\alpha,\\beta,\\gamma}_{\\lambda} - \\beta b\\|_{2} = \\left\\|\\alpha A \\left(\\frac{\\beta}{\\alpha} x_{\\tilde{\\lambda}}\\right) - \\beta b\\right\\|_{2} = \\|\\beta A x_{\\tilde{\\lambda}} - \\beta b\\|_{2}$$\n由于 $\\beta > 0$，我们可以将其从范数中提出：\n$$\\rho_{\\alpha,\\beta,\\gamma}(\\lambda) = \\beta \\|A x_{\\tilde{\\lambda}} - b\\|_{2} = \\beta \\rho(\\tilde{\\lambda})$$\n对于解的半范数：\n$$\\eta_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\|\\gamma L x^{\\alpha,\\beta,\\gamma}_{\\lambda}\\|_{2} = \\left\\|\\gamma L \\left(\\frac{\\beta}{\\alpha} x_{\\tilde{\\lambda}}\\right)\\right\\|_{2} = \\left\\|\\frac{\\gamma \\beta}{\\alpha} L x_{\\tilde{\\lambda}}\\right\\|_{2}$$\n由于 $\\alpha, \\beta, \\gamma > 0$，因子 $\\frac{\\gamma \\beta}{\\alpha}$ 是正的，可以被提出：\n$$\\eta_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{\\gamma \\beta}{\\alpha} \\|L x_{\\tilde{\\lambda}}\\|_{2} = \\frac{\\gamma \\beta}{\\alpha} \\eta(\\tilde{\\lambda})$$\n\n现在我们可以确定 L-曲线的对数-对数坐标之间的关系。\n对于横坐标：\n$$\\xi_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\ln\\big(\\rho_{\\alpha,\\beta,\\gamma}(\\lambda)\\big) = \\ln\\big(\\beta \\rho(\\tilde{\\lambda})\\big) = \\ln(\\beta) + \\ln\\big(\\rho(\\tilde{\\lambda})\\big) = \\ln(\\beta) + \\xi(\\tilde{\\lambda})$$\n对于纵坐标：\n$$\\nu_{\\alpha,\\beta,\\gamma}(\\lambda) \\equiv \\ln\\big(\\eta_{\\alpha,\\beta,\\gamma}(\\lambda)\\big) = \\ln\\left(\\frac{\\gamma \\beta}{\\alpha} \\eta(\\tilde{\\lambda})\\right) = \\ln\\left(\\frac{\\gamma \\beta}{\\alpha}\\right) + \\ln\\big(\\eta(\\tilde{\\lambda})\\big) = \\ln\\left(\\frac{\\gamma \\beta}{\\alpha}\\right) + \\nu(\\tilde{\\lambda})$$\n这些关系表明，对于任何给定的 $\\lambda$，缩放后的 L-曲线上的点是通过取原始 L-曲线上对应于 $\\tilde{\\lambda} = \\lambda\\gamma/\\alpha$ 的点，并将其平移一个恒定向量 $\\left(\\ln(\\beta), \\ln\\left(\\frac{\\gamma \\beta}{\\alpha}\\right)\\right)$ 得到的。平移不改变曲线的曲率。然而，参数化已从 $\\tilde{\\lambda}$ 变为 $\\lambda$，这将影响作为参数函数的曲率计算。\n\n为了求出曲率 $\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda)$，我们必须计算 $\\xi_{\\alpha,\\beta,\\gamma}(\\lambda)$ 和 $\\nu_{\\alpha,\\beta,\\gamma}(\\lambda)$ 关于 $\\lambda$ 的一阶和二阶导数。令 $C \\equiv \\frac{\\gamma}{\\alpha}$ 为一个正常数。则 $\\tilde{\\lambda} = C\\lambda$。我们使用链式法则，其中 $\\xi$ 和 $\\nu$ 上的撇号表示对其自变量的微分。\n一阶导数：\n$$\\xi'_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{d}{d\\lambda} \\left[ \\ln(\\beta) + \\xi(C\\lambda) \\right] = \\xi'(C\\lambda) \\cdot \\frac{d(C\\lambda)}{d\\lambda} = C \\xi'(\\tilde{\\lambda})$$\n$$\\nu'_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{d}{d\\lambda} \\left[ \\ln\\left(\\frac{\\gamma \\beta}{\\alpha}\\right) + \\nu(C\\lambda) \\right] = \\nu'(C\\lambda) \\cdot \\frac{d(C\\lambda)}{d\\lambda} = C \\nu'(\\tilde{\\lambda})$$\n二阶导数：\n$$\\xi''_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{d}{d\\lambda} \\left[ C \\xi'(C\\lambda) \\right] = C \\cdot \\xi''(C\\lambda) \\cdot \\frac{d(C\\lambda)}{d\\lambda} = C^{2} \\xi''(\\tilde{\\lambda})$$\n$$\\nu''_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{d}{d\\lambda} \\left[ C \\nu'(C\\lambda) \\right] = C \\cdot \\nu''(C\\lambda) \\cdot \\frac{d(C\\lambda)}{d\\lambda} = C^{2} \\nu''(\\tilde{\\lambda})$$\n现在我们将这些代入曲率 $\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda)$ 的公式中：\n$$\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{\\big|\\xi'_{\\alpha,\\beta,\\gamma}(\\lambda)\\,\\nu''_{\\alpha,\\beta,\\gamma}(\\lambda) - \\nu'_{\\alpha,\\beta,\\gamma}(\\lambda)\\,\\xi''_{\\alpha,\\beta,\\gamma}(\\lambda)\\big|}{\\big(\\big(\\xi'_{\\alpha,\\beta,\\gamma}(\\lambda)\\big)^{2} + \\big(\\nu'_{\\alpha,\\beta,\\gamma}(\\lambda)\\big)^{2}\\big)^{3/2}}$$\n表达式的分子是：\n$$\\big| \\left(C \\xi'(\\tilde{\\lambda})\\right) \\left(C^{2} \\nu''(\\tilde{\\lambda})\\right) - \\left(C \\nu'(\\tilde{\\lambda})\\right) \\left(C^{2} \\xi''(\\tilde{\\lambda})\\right) \\big| = \\big| C^{3} \\left( \\xi'(\\tilde{\\lambda})\\nu''(\\tilde{\\lambda}) - \\nu'(\\tilde{\\lambda})\\xi''(\\tilde{\\lambda}) \\right) \\big|$$\n由于 $C > 0$，这可以简化为 $C^{3} \\big| \\xi'(\\tilde{\\lambda})\\nu''(\\tilde{\\lambda}) - \\nu'(\\tilde{\\lambda})\\xi''(\\tilde{\\lambda}) \\big|$。\n表达式的分母是：\n$$\\big( \\left(C \\xi'(\\tilde{\\lambda})\\right)^{2} + \\left(C \\nu'(\\tilde{\\lambda})\\right)^{2} \\big)^{3/2} = \\big( C^{2} \\left(\\xi'(\\tilde{\\lambda})^{2} + \\nu'(\\tilde{\\lambda})^{2}\\right) \\big)^{3/2}$$\n使用性质 $(ab)^{n} = a^{n}b^{n}$ 并注意到当 $C > 0$ 时 $(C^{2})^{3/2} = |C|^{3} = C^{3}$：\n$$C^{3} \\big( \\xi'(\\tilde{\\lambda})^{2} + \\nu'(\\tilde{\\lambda})^{2} \\big)^{3/2}$$\n结合分子和分母：\n$$\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda) = \\frac{C^{3} \\big| \\xi'(\\tilde{\\lambda})\\nu''(\\tilde{\\lambda}) - \\nu'(\\tilde{\\lambda})\\xi''(\\tilde{\\lambda}) \\big|}{C^{3} \\big( \\xi'(\\tilde{\\lambda})^{2} + \\nu'(\\tilde{\\lambda})^{2} \\big)^{3/2}} = \\frac{\\big| \\xi'(\\tilde{\\lambda})\\nu''(\\tilde{\\lambda}) - \\nu'(\\tilde{\\lambda})\\xi''(\\tilde{\\lambda}) \\big|}{\\big( \\xi'(\\tilde{\\lambda})^{2} + \\nu'(\\tilde{\\lambda})^{2} \\big)^{3/2}}$$\n这正是原始 L-曲线在参数值 $\\tilde{\\lambda}$ 处的曲率 $\\kappa(\\cdot)$ 的定义。\n因此，我们得到最终关系：\n$$\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda) = \\kappa(\\tilde{\\lambda}) = \\kappa\\left(\\frac{\\lambda \\gamma}{\\alpha}\\right)$$\n这个结果表明，将矩阵 $A$ 和 $L$ 分别按因子 $\\alpha$ 和 $\\gamma$ 进行缩放，只会导致曲率函数的正则化参数轴发生简单的缩放，而数据向量 $b$ 按 $\\beta$ 的缩放对曲率没有影响。L-曲线的形状在缩放变换下是不变的，只有它在平面中的位置及其参数化受到影响。由曲率函数的最大值确定的 L-曲线“拐角”的位置，将从 $\\lambda^{*}_{\\text{orig}}$ 移动到一个新值 $\\lambda^{*}_{\\text{scaled}}$，使得 $\\frac{\\lambda^{*}_{\\text{scaled}} \\gamma}{\\alpha} = \\lambda^{*}_{\\text{orig}}$，即 $\\lambda^{*}_{\\text{scaled}} = \\frac{\\alpha}{\\gamma}\\lambda^{*}_{\\text{orig}}$。", "answer": "$$\\boxed{\\kappa_{\\alpha,\\beta,\\gamma}(\\lambda) = \\kappa\\left(\\lambda \\frac{\\gamma}{\\alpha}\\right)}$$", "id": "3394265"}, {"introduction": "将理论付诸实践是掌握任何科学方法的关键。L曲线准则作为一种启发式方法，其有效性需要通过数值实验来检验。在这个编程练习中，你将为一个典型的逆问题从头开始实现L曲线的计算，通过数值方法定位其“拐角”，并将其选择的正则化参数与更严格的离散Picard准则进行比较[@problem_id:3394295]。这个练习不仅能让你熟练掌握L曲线的完整工作流程，还能让你深刻理解启发式“拐角”与信噪分离的理论边界之间的内在联系。", "problem": "给定一个代表逆热方程的合成线性逆问题，其特征为指数衰减的奇异值分解 (SVD)。设正向算子建模为 $$A = U \\Sigma V^{\\top},$$ 其中 $$\\Sigma = \\operatorname{diag}(\\sigma_1,\\dots,\\sigma_n), \\quad \\sigma_i = \\exp(-\\alpha (i-1)),$$ 且 $$\\alpha > 0.$$ 设未知量在右奇异向量基中建模为 $$x_{\\text{true}} = \\sum_{i=1}^n c_i v_i,$$ 其系数为 $$c_i = s_i \\, i^{-p}, \\quad s_i \\in \\{-1,+1\\}.$$ 数据按 $$b = A x_{\\text{true}} + \\varepsilon$$ 生成，其中 $$\\varepsilon$$ 是一个均值为零的高斯噪声向量，其各分量独立且标准差为 $$\\delta.$$ 左奇异向量基中的数据系数为 $$\\beta_i = u_i^{\\top} b = \\sigma_i c_i + \\eta_i,$$ 其中 $$\\eta_i \\sim \\mathcal{N}(0,\\delta^2)$$ 对于不同的 $$i$$ 相互独立。\n\n考虑使用参数为 $$\\lambda > 0$$ 的零阶 Tikhonov 正则化，它定义了具有谱滤波因子 $$f_i(\\lambda) = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$$ 的滤波解。相应的残差范数和解范数分别为 $$\\rho(\\lambda) = \\left\\|A x_{\\lambda} - b\\right\\|_2, \\quad \\eta(\\lambda) = \\left\\|x_{\\lambda}\\right\\|_2.$$ L-曲线是当 $$\\lambda$$ 在对数网格上变化时绘制的参数曲线 $$\\left(\\log \\rho(\\lambda), \\log \\eta(\\lambda)\\right)$$。此处，L-曲线的角点定义为当由 $$\\log \\lambda$$ 参数化时，该对数-对数平面中曲率最大的点。\n\n在此合成设定中（其中真实系数是已知的），Picard 参数指标 $$k_{\\ast}$$ 定义为满足 $$\\sigma_i \\, |c_i| \\le \\delta$$ 的最小指标 $$i \\in \\{1,\\dots,n\\}$$。\n\n你的任务是编写一个完整的、可运行的程序，该程序能够：\n- 如上所述，在 SVD 域中生成合成问题，无需显式构造 $$U$$ 或 $$V$$，而是通过直接使用由 $$\\beta_i = \\sigma_i c_i + \\eta_i$$ 定义的 $$\\{\\sigma_i\\}$$ 和 $$\\{\\beta_i\\}$$。\n- 使用覆盖范围为 $$\\left[\\sigma_n \\cdot 10^{-2}, \\sigma_1 \\cdot 10^{2}\\right]$$ 的对数间隔 $$\\lambda$$ 值网格来计算 L-曲线。\n- 使用离散中心差分，将 L-曲线的角点 $$\\lambda_{\\text{corner}}$$ 估计为由 $$\\log \\lambda$$ 参数化时 $$\\left(\\log \\rho(\\lambda), \\log \\eta(\\lambda)\\right)$$ 的曲率最大值点。\n- 从滤波因子计算角点处的过渡指标 $$i_{\\text{trans}} = \\arg\\min_{i} \\left| f_i(\\lambda_{\\text{corner}}) - \\tfrac{1}{2} \\right|$$。\n- 使用 $$\\delta$$ 和已知的 $$\\{c_i\\}$$ 计算如上定义的 Picard 参数 $$k_{\\ast}$$。\n- 通过以下两个量化标准验证对齐性：\n  1. 通过 $$e_{\\lambda} = \\left|\\log_{10}\\left(\\frac{\\lambda_{\\text{corner}}}{\\sigma_{k_{\\ast}}}\\right)\\right|$$ 衡量 $$\\lambda_{\\text{corner}}$$ 与 $$\\sigma_{k_{\\ast}}$$ 的接近程度。\n  2. 通过 $$e_{\\text{idx}} = \\left|i_{\\text{trans}} - k_{\\ast}\\right|$$ 衡量 $$i_{\\text{trans}}$$ 与 $$k_{\\ast}$$ 的接近程度。\n- 对于每个测试用例，如果 $$e_{\\lambda} \\le 0.2$$ 和 $$e_{\\text{idx}} \\le 1$$ 同时成立，则返回 $$\\text{True}$$，否则返回 $$\\text{False}$$。\n\n使用以下测试套件，每个测试由 $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right)$$ 指定：\n- 案例 $$1$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(80,\\,0.12,\\,2.0,\\,10^{-4},\\,1\\right).$$\n- 案例 $$2$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(120,\\,0.08,\\,1.5,\\,5\\times 10^{-4},\\,2\\right).$$\n- 案例 $$3$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(100,\\,0.20,\\,3.0,\\,10^{-3},\\,3\\right).$$\n- 案例 $$4$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(100,\\,0.12,\\,2.5,\\,10^{-6},\\,4\\right).$$\n- 案例 $$5$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(80,\\,0.12,\\,1.5,\\,5\\times 10^{-3},\\,5\\right).$$\n\n实现细节和要求：\n- 你必须使用 $$\\{\\sigma_i\\}$$、$$\\{\\beta_i\\}$$ 和 $$f_i(\\lambda)$$，从谱公式计算 $$\\rho(\\lambda)$$ 和 $$\\eta(\\lambda)$$，而无需求解线性系统。\n- 必须使用中心有限差分和平面中的标准曲率公式，为参数 $$t=\\log \\lambda$$ 下的 L-曲线计算曲率。\n- 不使用角度，也不涉及任何物理单位。\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的列表形式的结果（例如 $$[r_1,r_2,r_3,r_4,r_5]$$），其中每个 $$r_j$$ 是如上定义的测试用例 $$j$$ 的布尔值。", "solution": "所提出的问题是逆问题领域中一个有效且适定的数值练习。它涉及在 Tikhonov 正则化中，应用和验证用于选择正则化参数的 L-曲线准则。该问题在科学上基于已建立的逆问题理论，内容自洽，并为获得唯一的、可验证的解提供了所有必要的定义和数据。我们将着手提供一个完整的解法。\n\n问题的核心是分析一个线性逆问题 $$Ax = b$$，其中算子 $$A$$ 是病态的，意味着其奇异值 $$\\sigma_i$$ 迅速衰减至零。这使得朴素解 $$x = A^{-1}b$$ 对数据 $$b$$ 中的噪声高度敏感。该问题完全在 $$A$$ 的谱域中建立，这避免了从奇异值分解 (SVD) $$A = U \\Sigma V^{\\top}$$ 中构造矩阵 $$U$$ 和 $$V$$ 的需要，从而可以进行高效的模拟。\n\n奇异值由 $$\\sigma_i = \\exp(-\\alpha (i-1))$$ 给出，其中 $$i \\in \\{1, \\dots, n\\}$$ 且给定衰减率 $$\\alpha > 0$$。真实的未知解 $$x_{\\text{true}}$$ 由其在右奇异向量基 $$\\{v_i\\}$$ 中的系数 $$c_i$$ 定义，即 $$x_{\\text{true}} = \\sum_{i=1}^n c_i v_i$$，其中 $$c_i = s_i \\, i^{-p}$$ 且 $$s_i \\in \\{-1, +1\\}$$。这些系数的衰减率 $$p$$ 表征了 $$x_{\\text{true}}$$ 的光滑度。数据 $$b$$ 由真实解生成，并被标准差为 $$\\delta$$ 的加性高斯噪声 $$\\varepsilon$$ 污染，即 $$b = A x_{\\text{true}} + \\varepsilon$$。该问题可以完全由数据在左奇异向量基 $$\\{u_i\\}$$ 中的系数 $$\\beta_i = u_i^{\\top}b$$ 来描述。根据线性和 SVD 的性质，这些系数由 $$\\beta_i = \\sigma_i c_i + \\eta_i$$ 给出，其中 $$\\eta_i = u_i^{\\top}\\varepsilon$$ 是服从正态分布 $$\\mathcal{N}(0, \\delta^2)$$ 的独立同分布随机变量。\n\nTikhonov 正则化被用来寻找一个稳定的近似解。对于给定的正则化参数 $$\\lambda > 0$$，零阶 Tikhonov 正则化解 $$x_{\\lambda}$$ 最小化泛函 $$\\|Ax - b\\|_2^2 + \\lambda^2 \\|x\\|_2^2$$。在 SVD 基中，该解表示为 $$x_{\\lambda} = \\sum_{i=1}^n f_i(\\lambda) \\frac{\\beta_i}{\\sigma_i} v_i$$。项 $$f_i(\\lambda)$$ 是谱滤波因子，由 $$f_i(\\lambda) = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$$ 给出。这些因子平滑地衰减了对应于小奇异值的解的分量，而这些分量被噪声严重污染。\n\n正则化解的质量关键取决于 $$\\lambda$$ 的选择。L-曲线是为此目的的一种流行的启发式方法。它是解范数的对数 $$\\zeta(\\lambda) = \\log \\|x_{\\lambda}\\|_2$$ 与残差范数的对数 $$\\xi(\\lambda) = \\log \\|A x_{\\lambda} - b\\|_2$$ 的参数图。这些范数可以在谱域中高效计算，而无需构造任何矩阵：\n解范数由下式给出：\n$$ \\eta(\\lambda)^2 = \\|x_{\\lambda}\\|_2^2 = \\sum_{i=1}^n \\left( f_i(\\lambda) \\frac{\\beta_i}{\\sigma_i} \\right)^2 = \\sum_{i=1}^n \\left( \\frac{\\sigma_i \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 $$\n残差范数由下式给出：\n$$ \\rho(\\lambda)^2 = \\|A x_{\\lambda} - b\\|_2^2 = \\sum_{i=1}^n \\left( (f_i(\\lambda) - 1)\\beta_i \\right)^2 = \\sum_{i=1}^n \\left( \\frac{-\\lambda^2 \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 = \\sum_{i=1}^n \\left( \\frac{\\lambda^2 \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 $$\n所得曲线通常呈'L'形。最优的 $$\\lambda$$ 被选在 L 形曲线的“角点”处，这代表了在最小化数据失配（残差）和控制解的大小以防止噪声放大之间的一种折衷。\n\n问题将角点定义为当 L-曲线由 $$t = \\log \\lambda$$ 参数化时曲率最大的点。对于一个参数曲线 $$(x(t), y(t))$$，其曲率 $$\\kappa(t)$$ 由下式给出：\n$$ \\kappa(t) = \\frac{|x'(t) y''(t) - y'(t) x''(t)|}{(x'(t)^2 + y'(t)^2)^{3/2}} $$\n此处，$$x(t)=\\xi(e^t)$$ 且 $$y(t)=\\zeta(e^t)$$。我们为从对数网格中选择的一组离散 $$\\lambda_j$$ 值计算 L-曲线，这对应于参数 $$t_j = \\log \\lambda_j$$ 的一个均匀网格。曲率公式所需的一阶和二阶导数使用中心有限差分进行近似。对于定义在步长为 $$h_t$$ 的均匀网格 $$t_j$$ 上的函数 $$g(t)$$，我们有：\n$$ g'(t_j) \\approx \\frac{g(t_{j+1}) - g(t_{j-1})}{2h_t}, \\quad g''(t_j) \\approx \\frac{g(t_{j+1}) - 2g(t_j) + g(t_{j-1})}{h_t^2} $$\n值 $$\\lambda_{\\text{corner}}$$ 是使计算出的离散曲率最大化的那个 $$\\lambda_j$$。\n\n这种启发式方法的有效性通过将结果与离散 Picard 条件进行比较来检验。该条件指出，为了恢复一个有意义的解，数据系数的信号部分 $$|\\sigma_i c_i|$$ 必须大于噪声水平 $$\\delta$$。Picard 参数指标 $$k_{\\ast}$$ 定义为该条件被违反的最小指标 $$i$$，即 $$\\sigma_i |c_i| \\le \\delta$$。该指标标记了信号主导的谱分量和噪声主导的谱分量之间的边界。一个好的正则化参数 $$\\lambda$$ 应该滤除指标 $$i > k_{\\ast}$$ 的分量，并保留指标 $$i \\le k_{\\ast}$$ 的分量。滤波函数 $$f_i(\\lambda)$$ 在 $$\\sigma_i \\approx \\lambda$$ 附近从 $$\\approx 1$$ 过渡到 $$\\approx 0$$。因此，一个最优的 $$\\lambda$$ 应该接近于 $$\\sigma_{k_{\\ast}}$$。\n\n该假设通过两个度量标准进行检验：\n1.  正则化参数的接近度：$$e_{\\lambda} = \\left|\\log_{10}\\left(\\frac{\\lambda_{\\text{corner}}}{\\sigma_{k_{\\ast}}}\\right)\\right|$$。这衡量了 $$\\lambda_{\\text{corner}}$$ 与 Picard 指标处的奇异值 $$\\sigma_{k_{\\ast}}$$ 之间的数量级一致性。接受阈值为 $$e_{\\lambda} \\le 0.2$$。\n2.  过渡指标的接近度：$$e_{\\text{idx}} = \\left|i_{\\text{trans}} - k_{\\ast}\\right|$$。过渡指标 $$i_{\\text{trans}}$$ 定义为使滤波因子 $$f_i(\\lambda_{\\text{corner}})$$ 最接近 $$1/2$$ 的指标 $$i$$。这发生在 $$\\sigma_i \\approx \\lambda_{\\text{corner}}$$ 时，因此 $$i_{\\text{trans}}$$ 提供了由 L-曲线识别的有效秩的另一种估计。接受阈值为 $$e_{\\text{idx}} \\le 1$$。\n\n程序将对每个测试用例执行这整个过程，包括生成合成数据、计算 L-曲线及其角点、寻找 $$k_{\\ast}$$ 和 $$i_{\\text{trans}}$$，并最终评估两个验证标准以返回一个布尔结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the L-curve validation problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (n, alpha, p, delta, seed)\n        (80, 0.12, 2.0, 1e-4, 1),\n        (120, 0.08, 1.5, 5e-4, 2),\n        (100, 0.20, 3.0, 1e-3, 3),\n        (100, 0.12, 2.5, 1e-6, 4),\n        (80, 0.12, 1.5, 5e-3, 5),\n    ]\n\n    results = []\n    num_lambda_points = 400\n\n    for n, alpha, p, delta, seed in test_cases:\n        # Step 1: Generate the synthetic problem data in the SVD domain\n        np.random.seed(seed)\n        i = np.arange(1, n + 1)\n        \n        # Singular values\n        sigma = np.exp(-alpha * (i - 1))\n        \n        # True solution coefficients\n        s = np.random.choice([-1, 1], size=n)\n        c = s * (i**(-p))\n        \n        # Noisy data coefficients\n        eta = np.random.normal(0, delta, size=n)\n        beta = sigma * c + eta\n\n        # Step 2: Compute the L-curve\n        # Define a logarithmic grid for lambda\n        lambda_min = sigma[-1] * 1e-2\n        lambda_max = sigma[0] * 1e2\n        lambda_vals = np.logspace(np.log10(lambda_min), np.log10(lambda_max), num_lambda_points)\n\n        log_rho_vals = np.zeros(num_lambda_points)\n        log_eta_vals = np.zeros(num_lambda_points)\n\n        for j, lam in enumerate(lambda_vals):\n            lam_sq = lam**2\n            sigma_sq = sigma**2\n            \n            # Filter factors\n            f = sigma_sq / (sigma_sq + lam_sq)\n            \n            # Residual norm (squared)\n            rho_sq = np.sum(((f - 1) * beta)**2)\n            \n            # Solution norm (squared)\n            eta_sq = np.sum((f * beta / sigma)**2)\n            \n            log_rho_vals[j] = 0.5 * np.log(rho_sq)\n            log_eta_vals[j] = 0.5 * np.log(eta_sq)\n\n        # Step 3: Estimate the L-curve corner by maximizing curvature\n        # Parametrization is t = log(lambda), which is uniform\n        t_vals = np.log(lambda_vals)\n        h_t = t_vals[1] - t_vals[0]\n        \n        # Use central differences for derivatives on interior points\n        x = log_rho_vals\n        y = log_eta_vals\n\n        dx_dt = (x[2:] - x[:-2]) / (2 * h_t)\n        dy_dt = (y[2:] - y[:-2]) / (2 * h_t)\n        \n        d2x_dt2 = (x[2:] - 2 * x[1:-1] + x[:-2]) / (h_t**2)\n        d2y_dt2 = (y[2:] - 2 * y[1:-1] + y[:-2]) / (h_t**2)\n\n        # Curvature formula\n        numerator = np.abs(dx_dt * d2y_dt2 - dy_dt * d2x_dt2)\n        denominator = (dx_dt**2 + dy_dt**2)**1.5\n        \n        # Avoid division by zero, although not expected for a standard L-curve\n        # Set curvature to 0 where denominator is close to zero\n        kappa = np.zeros_like(numerator)\n        valid_indices = denominator > 1e-16\n        kappa[valid_indices] = numerator[valid_indices] / denominator[valid_indices]\n        \n        # Find lambda corresponding to max curvature\n        # The curvature is computed on interior points (index 1 to N-2)\n        # So the max index must be offset by 1\n        corner_idx_in_kappa = np.argmax(kappa)\n        corner_idx = corner_idx_in_kappa + 1\n        lambda_corner = lambda_vals[corner_idx]\n\n        # Step 4: Compute the transition index\n        f_corner = sigma**2 / (sigma**2 + lambda_corner**2)\n        i_trans = np.argmin(np.abs(f_corner - 0.5)) + 1 # 1-based index\n\n        # Step 5: Compute the Picard parameter index k_star\n        signal_strength = sigma * np.abs(c)\n        # Find first index i where signal is = noise level.\n        # np.where returns a tuple of arrays; we want the first element of the first array.\n        k_star_candidates = np.where(signal_strength = delta)[0]\n        # In case the condition is never met for the given n, which is unlikely\n        if len(k_star_candidates) == 0:\n            k_star = n\n        else:\n            k_star = k_star_candidates[0] + 1 # 1-based index\n        \n        # Step 6: Validate the alignment with the two criteria\n        sigma_k_star = sigma[k_star - 1]\n        e_lambda = np.abs(np.log10(lambda_corner / sigma_k_star))\n        e_idx = np.abs(i_trans - k_star)\n\n        # Final boolean check\n        is_aligned = (e_lambda = 0.2) and (e_idx = 1)\n        results.append(is_aligned)\n\n    # Format the final output string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3394295"}]}