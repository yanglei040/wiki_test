{"hands_on_practices": [{"introduction": "理解刮削层(Scrape-Off Layer, SOL)输运状态的第一步是量化等离子体的碰撞性。本练习的核心是计算无量纲参数电子碰撞性$\\nu_*$，它直接比较了电子在两次碰撞之间自由行进的距离（平均自由程）与它必须沿磁力线行进的总长度。通过推导并计算$\\nu_*$ ([@problem_id:3718591])，您将掌握一个基本的判据，用以区分刮削层是由鞘层效应主导（低碰撞性）还是由热传导主导（高碰撞性）。", "problem": "托卡马克刮削层（SOL）中的边界等离子体，其特征是沿着长度为 $L_{\\parallel}$ 的磁力线进行的平行输运。沿磁场方向的电子碰撞度的一个常用度量是无量纲参数 $\\nu_{*}$，其定义为连接长度与电子-离子库仑碰撞的电子平均自由程之比。从动理学理论和库仑碰撞物理出发，推导电子碰撞度的表达式\n$$\\nu_{*} \\equiv \\frac{L_{\\parallel}}{\\lambda_{ei}} = \\frac{L_{\\parallel}\\,\\nu_{ei}}{v_{\\mathrm{th},e}},$$\n其中 $v_{\\mathrm{th},e}$ 是电子热速度，$\\nu_{ei}$ 是电子-离子碰撞频率。您可以假设准中性（$n_{e} \\simeq n_{i}$）和电荷数 $Z=1$ 的单电离等离子体。\n\n作为基本依据，请使用：\n- 电子热速度 $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e} / m_{e}}$，\n- 适用于小角度库仑碰撞的 Spitzer 电子-离子碰撞频率标度关系，$\\nu_{ei} \\propto n_{e} Z^{2} \\ln\\Lambda\\, T_{e}^{-3/2}$，其中 $\\ln\\Lambda$ 是库仑对数，\n- 沿磁场方向的粒子数和动量守恒，以及平均自由程为 $\\lambda_{ei} = v_{\\mathrm{th},e}/\\nu_{ei}$。\n\n对于数值计算，您可以使用标准的 Spitzer 系数（对于 $Z=1$，$n_{e}$ 单位为 $\\text{cm}^{-3}$，$T_{e}$ 单位为 $\\text{eV}$）\n$$\\nu_{ei} \\approx 2.91\\times 10^{-6}\\,\\frac{n_{e}\\,\\ln\\Lambda}{T_{e}^{3/2}},$$\n单位为 $\\text{s}^{-1}$。对于参数 $n_{e} = 2\\times 10^{19}\\ \\text{m}^{-3}$，$T_{e} = 60\\ \\text{eV}$，$L_{\\parallel} = 15\\ \\text{m}$ 和 $\\ln\\Lambda = 15$，计算 $\\nu_{*}$。将最终的 $\\nu_{*}$ 表示为一个纯数，并将您的答案四舍五入到三位有效数字。\n\n最后，根据 $\\nu_{*}$ 的量级，定性地论证预期处于哪个 SOL 区：鞘层限制区还是传导限制区。在首次使用时定义缩写刮削层（SOL）。", "solution": "首先验证该问题，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n- 所考虑的系统是托卡马克**刮削层（SOL）**中的边界等离子体，该区域的磁力线是开放的，并终止于材料表面。\n- 特征长度是平行连接长度 $L_{\\parallel}$。\n- 电子碰撞度定义为 $\\nu_{*} \\equiv \\frac{L_{\\parallel}}{\\lambda_{ei}} = \\frac{L_{\\parallel}\\,\\nu_{ei}}{v_{\\mathrm{th},e}}$。\n- 电子平均自由程为 $\\lambda_{ei} = v_{\\mathrm{th},e}/\\nu_{ei}$。\n- 电子热速度由 $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e} / m_{e}}$ 给出。\n- Spitzer 电子-离子碰撞频率的标度关系为 $\\nu_{ei} \\propto n_{e} Z^{2} \\ln\\Lambda\\, T_{e}^{-3/2}$，其中 $\\ln\\Lambda$ 是库仑对数。\n- 对于单电离等离子体（$Z=1$），提供了电子-离子碰撞频率的数值公式：$\\nu_{ei} \\approx 2.91\\times 10^{-6}\\,\\frac{n_{e}\\,\\ln\\Lambda}{T_{e}^{3/2}}$，单位为 $\\text{s}^{-1}$，其中 $n_{e}$ 的单位是 $\\text{cm}^{-3}$，$T_{e}$ 的单位是 $\\text{eV}$。\n- 假设等离子体是准中性的（$n_{e} \\simeq n_{i}$）和单电离的（$Z=1$）。\n- 用于计算的数值为：$n_{e} = 2\\times 10^{19}\\ \\text{m}^{-3}$，$T_{e} = 60\\ \\text{eV}$，$L_{\\parallel} = 15\\ \\text{m}$，以及 $\\ln\\Lambda = 15$。\n- 要求输出：$\\nu_{*}$ 的表达式，其四舍五入到三位有效数字的数值，以及关于 SOL 区的定性论证。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，借鉴了等离子体物理学的既定原理，特别是关于托卡马克中的边界等离子体。碰撞度、热速度和碰撞频率的定义是该领域的标准。所提供的参数对于现代托卡马克的 SOL 来说在物理上是现实的。该问题是适定的，为获得唯一解提供了所有必要信息。它是客观的，没有歧义。因此，该问题被认为是有效的。\n\n### 步骤 3：结论和行动\n该问题有效。将提供完整的解答。\n\n### 碰撞度表达式的推导\n电子碰撞度 $\\nu_{*}$ 定义为平行连接长度 $L_{\\parallel}$ 与电子-离子平均自由程 $\\lambda_{ei}$ 之比。\n$$\n\\nu_{*} \\equiv \\frac{L_{\\parallel}}{\\lambda_{ei}}\n$$\n鉴于平均自由程是电子在两次碰撞之间行进的典型距离，它可以表示为电子热速度 $v_{\\mathrm{th},e}$ 与电子-离子碰撞频率 $\\nu_{ei}$ 之比：\n$$\n\\lambda_{ei} = \\frac{v_{\\mathrm{th},e}}{\\nu_{ei}}\n$$\n将此代入 $\\nu_{*}$ 的定义中，得到：\n$$\n\\nu_{*} = \\frac{L_{\\parallel}}{v_{\\mathrm{th},e} / \\nu_{ei}} = \\frac{L_{\\parallel} \\nu_{ei}}{v_{\\mathrm{th},e}}\n$$\n问题给出了 $\\nu_{ei}$ 和 $v_{\\mathrm{th},e}$ 的标度关系。电子热速度为 $v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e} / m_{e}}$，其标度关系为 $v_{\\mathrm{th},e} \\propto T_{e}^{1/2}$。电子-离子碰撞频率的标度关系为 $\\nu_{ei} \\propto n_{e} Z^{2} \\ln\\Lambda\\, T_{e}^{-3/2}$。对于给定的等离子体种类（$m_e$ 为常数）和电荷态（$Z=1$），我们可以写出 $\\nu_{*}$ 的正比关系。\n$$\n\\nu_{*} \\propto \\frac{L_{\\parallel} \\left( n_{e} \\ln\\Lambda\\, T_{e}^{-3/2} \\right)}{T_{e}^{1/2}}\n$$\n合并涉及电子温度 $T_{e}$ 的项，得出电子碰撞度标度关系的最终表达式：\n$$\n\\nu_{*} \\propto L_{\\parallel} n_{e} \\ln\\Lambda\\, T_{e}^{-2}\n$$\n此表达式显示了碰撞度如何依赖于 SOL 中的关键等离子体参数。\n\n### $\\nu_{*}$ 的数值计算\n我们被要求计算给定参数下的 $\\nu_{*}$ 值：$n_{e} = 2\\times 10^{19}\\ \\text{m}^{-3}$，$T_{e} = 60\\ \\text{eV}$，$L_{\\parallel} = 15\\ \\text{m}$，以及 $\\ln\\Lambda = 15$。\n\n首先，我们计算电子-离子碰撞频率 $\\nu_{ei}$。所提供的公式要求电子密度 $n_{e}$ 的单位为 $\\text{cm}^{-3}$。我们转换给定的值：\n$$\nn_{e} = 2 \\times 10^{19}\\ \\text{m}^{-3} = 2 \\times 10^{19} \\times (10^{-2}\\ \\text{m/cm})^3 = 2 \\times 10^{19} \\times 10^{-6}\\ \\text{cm}^{-3} = 2 \\times 10^{13}\\ \\text{cm}^{-3}\n$$\n现在，我们将这些值代入 $\\nu_{ei}$ 的公式中：\n$$\n\\nu_{ei} \\approx 2.91\\times 10^{-6}\\,\\frac{n_{e}[\\text{cm}^{-3}]\\,\\ln\\Lambda}{(T_{e}[\\text{eV}])^{3/2}} = 2.91\\times 10^{-6}\\,\\frac{(2 \\times 10^{13}) \\times 15}{(60)^{3/2}} \\ \\text{s}^{-1}\n$$\n$$\n\\nu_{ei} \\approx \\frac{8.73 \\times 10^8}{60\\sqrt{60}} \\approx \\frac{8.73 \\times 10^8}{464.758} \\approx 1.8784 \\times 10^6\\ \\text{s}^{-1}\n$$\n接下来，我们使用国际单位制（SI）单位计算电子热速度 $v_{\\mathrm{th},e}$。以 $\\text{eV}$ 为单位给出的量 $T_e$ 代表能量。我们将其转换为焦耳：$E_e = 60\\ \\text{eV} \\times (1.60218 \\times 10^{-19}\\ \\text{J/eV}) = 9.61308 \\times 10^{-18}\\ \\text{J}$。电子质量为 $m_e \\approx 9.10938 \\times 10^{-31}\\ \\text{kg}$。热速度的公式被解释为 $v_{\\mathrm{th},e} = \\sqrt{2 E_e / m_e}$。\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (9.61308 \\times 10^{-18}\\ \\text{J})}{9.10938 \\times 10^{-31}\\ \\text{kg}}} \\approx \\sqrt{2.1106 \\times 10^{13}}\\ \\text{m/s} \\approx 4.5941 \\times 10^6\\ \\text{m/s}\n$$\n最后，我们计算 $\\nu_{*}$：\n$$\n\\nu_{*} = \\frac{L_{\\parallel} \\nu_{ei}}{v_{\\mathrm{th},e}} = \\frac{(15\\ \\text{m}) \\times (1.8784 \\times 10^6\\ \\text{s}^{-1})}{4.5941 \\times 10^6\\ \\text{m/s}}\n$$\n$$\n\\nu_{*} \\approx \\frac{15 \\times 1.8784}{4.5941} \\approx 6.1329\n$$\n四舍五入到三位有效数字，我们得到 $\\nu_{*} \\approx 6.13$。\n\n### SOL 区的确定\nSOL 输运区由电子碰撞度 $\\nu_{*}$ 决定。这个无量纲参数比较了系统尺寸 $L_{\\parallel}$ 与碰撞的特征长度尺度 $\\lambda_{ei}$。\n有两个主要区域：\n1.  **鞘层限制区**：当碰撞度较低时，即 $\\nu_{*} \\ll 1$ 时，出现此区域。在这种情况下，电子平均自由程远大于连接长度（$\\lambda_{ei} \\gg L_{\\parallel}$）。电子沿着磁力线几乎不发生或很少发生碰撞地到达偏滤器靶板。平行热通量受限于等离子体流入材料表面形成的静电鞘层的速率，该速率由离子声速决定。\n2.  **传导限制区**：当碰撞度较高时，即 $\\nu_{*} \\gg 1$ 时，出现此区域。电子平均自由程远小于连接长度（$\\lambda_{ei} \\ll L_{\\parallel}$）。电子在向偏滤器移动时会经历多次碰撞。这种频繁的散射使得输运过程具有扩散性，类似于固体中的热传导。平行热通量受限于电子的经典（Spitzer-Härm）热导率。\n\n我们计算出的值为 $\\nu_{*} \\approx 6.13$。由于该值显著大于 1，等离子体处于高碰撞度区。因此，SOL 预期为**传导限制区**。", "answer": "$$\n\\boxed{6.13}\n$$", "id": "3718591"}, {"introduction": "在确定等离子体处于传导限制状态后，下一个关键问题是理解其行为特征。在此状态下，沿磁力线的热流由电子热传导主导，这会在上游和靶板之间形成显著的温度梯度。本练习([@problem_id:3718554])将指导您从第一性原理出发，推导上游温度$T_u$与磁力线连接长度$L_\\parallel$之间的著名标度律，即$T_u \\propto L_\\parallel^{2/7}$。这一结果深刻揭示了在传导限制的刮削层中，磁场几何结构如何直接影响核心边界的温度，这是聚变反应堆设计和运行中的一个核心物理问题。", "problem": "托卡马克边界等离子体的刮削层（SOL）在一个平行热输运由热传导主导的模式下运行。考虑连接外侧中平面上游位置与偏滤器靶板的一段磁力线，其平行坐标为 $s \\in [0, L_{\\parallel}]$，其中 $s = 0$ 对应靶板，$s = L_{\\parallel}$ 对应上游位置。假设沿磁力线为稳态、一维能量平衡，且体积源项和汇项可忽略不计，因此平行热通量 $q_{\\parallel}$ 在空间上是恒定的。设电子热传导遵循 Spitzer–Härm 输运，其热导率为 $\\kappa_{e}(T) = \\kappa_{0} T^{5/2}$，其中 $\\kappa_{0}$ 是一个常数。在热传导主导的刮削层模式中，靶板电子温度 $T_{t}$ 远小于上游电子温度 $T_{u}$，但为非零值。\n\n假设一次打击点移动使平行连接长度加倍，$L_{\\parallel} \\rightarrow 2 L_{\\parallel}$，而 $q_{\\parallel}$ 保持不变。从给定的物理假设和输运定律出发，推导在 $q_{\\parallel}$ 固定时 $T_{u}$ 随 $L_{\\parallel}$ 变化的标度关系，并预测因 $L_{\\parallel}$ 加倍而导致的 $T_{u}$ 的乘性变化。将最终答案表示为一个等于 $T_{u}^{(\\text{new})} / T_{u}^{(\\text{old})}$ 的无单位解析因子。", "solution": "用户提供了一个问题陈述，必须首先对其科学合理性、完整性和清晰度进行验证。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n-   **系统**：托卡马克边界等离子体刮削层（SOL）。\n-   **模式**：热传导主导。\n-   **几何**：一段磁力线，按一维处理。\n-   **坐标系**：平行坐标 $s$，范围从 $s=0$（偏滤器靶板）到 $s=L_{\\parallel}$（上游位置）。\n-   **物理模型**：稳态、一维能量平衡。\n-   **假设**：\n    1.  沿磁力线的体积能量源和汇可忽略不计。\n    2.  作为稳态条件下（1）的结果，平行热通量 $q_{\\parallel}$ 沿 $s$ 在空间上是恒定的。\n    3.  电子热传导遵循 Spitzer–Härm 输运。\n    4.  电子热导率由 $\\kappa_{e}(T) = \\kappa_{0} T^{5/2}$ 给出，其中 $\\kappa_{0}$ 是一个常数。\n    5.  靶板电子温度 $T_{t}$ 远小于上游电子温度 $T_{u}$（$T_{t} \\ll T_{u}$），但为非零值。\n-   **情景**：平行连接长度加倍，即 $L_{\\parallel} \\rightarrow 2 L_{\\parallel}$。\n-   **约束条件**：在此变化过程中，平行热通量 $q_{\\parallel}$ 保持不变。\n-   **目标**：\n    1.  在 $q_{\\parallel}$ 固定的情况下，推导 $T_{u}$ 随 $L_{\\parallel}$ 变化的标度关系。\n    2.  计算与 $L_{\\parallel}$ 加倍相对应的乘性因子 $T_{u}^{(\\text{new})} / T_{u}^{(\\text{old})}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题在等离子体物理学原理，特别是托卡马克刮削层中的热输运理论方面有坚实的科学依据。Spitzer–Härm 电导率模型（$\\kappa \\propto T^{5/2}$）是碰撞磁化等离子体经典输运理论的标准结果。热传导主导模式、平行连接长度和上游/靶板温度等概念是该领域的基础。\n-   **适定性**：该问题是适定的。它明确了控制物理过程（热传导）、本构关系（$\\kappa_e(T)$）、几何形状以及一个关键的简化近似（$T_t \\ll T_u$），从而能够得到明确的解析解。\n-   **客观性**：语言精确、量化，没有主观或含糊的术语。\n-   **完整性与一致性**：该问题是自洽的。所有必要的物理定律、常数和边界条件近似都已提供。各项假设在内部是一致的。\n-   **现实性与可行性**：所描述的情景——由于打击点移动导致连接长度变化，同时保持热通量恒定——是托卡马克实验中用于研究刮削层物理的合理操作情景。\n-   **其他缺陷**：该问题并非无足轻重、隐喻性或无法验证。它代表了等离子体边界物理学中的一个标准的、具有说明性的计算。\n\n**步骤 3：结论与行动**\n问题陈述被判定为**有效**。将根据所提供的信息构建解决方案。\n\n**问题解答**\n\n该问题涉及沿磁力线的稳态一维热输运。基本原理是能量守恒。在体积源和汇可忽略不计的情况下，热通量的散度为零。在一维情况下，这意味着平行热通量沿坐标 $s$ 是恒定的。问题陈述正确地指出了这一推论，即 $q_{\\parallel}$ 在空间上是恒定的。\n\n热通量和温度梯度之间的关系由傅里叶热传导定律给出。在一维情况下，沿 $s$ 方向的热通量由下式给出：\n$$ q_{s}(s) = -\\kappa_e(T) \\frac{dT}{ds} $$\n热量从热的上游区域（$s=L_{\\parallel}$, $T=T_u$）流向冷的靶板区域（$s=0$, $T=T_t$）。因此，热量沿 $s$ 负方向流动，热通量分量 $q_{s}(s)$ 为负。设 $q_{\\parallel}$ 表示热通量的大小，它是一个正常数。因此，$q_{s}(s) = -q_{\\parallel}$。控制方程变为：\n$$ -q_{\\parallel} = -\\kappa_e(T) \\frac{dT}{ds} $$\n代入给定的 Spitzer–Härm 热导率 $\\kappa_{e}(T) = \\kappa_{0} T^{5/2}$，我们得到：\n$$ q_{\\parallel} = \\kappa_{0} T^{5/2} \\frac{dT}{ds} $$\n这是一个关于温度分布 $T(s)$ 的一阶常微分方程。我们可以通过分离变量法来求解该方程：\n$$ \\kappa_{0} T^{5/2} dT = q_{\\parallel} ds $$\n为了找到上游和靶板温度之间的关系，我们沿磁力线全长对该方程进行积分。积分限从靶板（$s=0$, $T=T_t$）到上游位置（$s=L_{\\parallel}$, $T=T_u$）：\n$$ \\int_{T_{t}}^{T_{u}} \\kappa_{0} T^{5/2} dT = \\int_{0}^{L_{\\parallel}} q_{\\parallel} ds $$\n由于 $\\kappa_{0}$ 和 $q_{\\parallel}$ 是常数，可以将其移到积分号外：\n$$ \\kappa_{0} \\int_{T_{t}}^{T_{u}} T^{5/2} dT = q_{\\parallel} \\int_{0}^{L_{\\parallel}} ds $$\n执行积分得到：\n$$ \\kappa_{0} \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_{t}}^{T_{u}} = q_{\\parallel} [s]_{0}^{L_{\\parallel}} $$\n$$ \\frac{2}{7} \\kappa_{0} (T_{u}^{7/2} - T_{t}^{7/2}) = q_{\\parallel} L_{\\parallel} $$\n这个方程给出了 Spitzer–Härm 热传导下温度、热通量和连接长度之间的一般关系。\n\n问题指明刮削层处于热传导主导模式，其特征是条件 $T_t \\ll T_u$。在此假设下，$T_t^{7/2}$ 项与 $T_u^{7/2}$ 相比可以忽略不计。方程简化为：\n$$ \\frac{2}{7} \\kappa_{0} T_{u}^{7/2} \\approx q_{\\parallel} L_{\\parallel} $$\n这是热传导主导刮削层的特征关系。为了推导 $T_u$ 随 $L_{\\parallel}$ 的标度关系，我们重新整理此表达式以求解 $T_u$：\n$$ T_{u}^{7/2} \\approx \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}} $$\n$$ T_{u} \\approx \\left( \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}} \\right)^{2/7} $$\n问题陈述 $q_{\\parallel}$ 保持固定。量 $7$、$2$ 和 $\\kappa_{0}$ 都是常数。因此，上游温度 $T_u$ 和连接长度 $L_{\\parallel}$ 之间的标度关系是：\n$$ T_{u} \\propto L_{\\parallel}^{2/7} $$\n这就完成了第一部分的目标。\n\n对于第二部分，我们必须找出当 $L_{\\parallel}$ 加倍时 $T_u$ 的乘性变化。设初始状态用 $(T_{u}^{(\\text{old})}, L_{\\parallel}^{(\\text{old})})$ 表示，新状态用 $(T_{u}^{(\\text{new})}, L_{\\parallel}^{(\\text{new})})$ 表示。已知 $L_{\\parallel}^{(\\text{new})} = 2 L_{\\parallel}^{(\\text{old})}$。\n\n使用推导出的标度定律，我们可以写出新旧上游温度之比：\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\frac{ \\left( C \\cdot L_{\\parallel}^{(\\text{new})} \\right)^{2/7} }{ \\left( C \\cdot L_{\\parallel}^{(\\text{old})} \\right)^{2/7} } $$\n其中 $C = \\frac{7 q_{\\parallel}}{2 \\kappa_{0}}$ 是比例常数。常数 $C$ 被消掉：\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\left( \\frac{L_{\\parallel}^{(\\text{new})}}{L_{\\parallel}^{(\\text{old})}} \\right)^{2/7} $$\n将 $L_{\\parallel}^{(\\text{new})} = 2 L_{\\parallel}^{(\\text{old})}$ 代入该比率：\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\left( \\frac{2 L_{\\parallel}^{(\\text{old})}}{L_{\\parallel}^{(\\text{old})}} \\right)^{2/7} = 2^{2/7} $$\n因此，在保持平行热通量恒定的情况下，将连接长度加倍会导致上游温度增加 $2^{2/7}$ 倍。", "answer": "$$\n\\boxed{2^{2/7}}\n$$", "id": "3718554"}, {"introduction": "理论的最终检验在于其预测能力。本练习将理论与计算实践相结合，要求您构建一个综合性的数值实验([@problem_id:3718553])。您将把沿磁力线的Spitzer-Härm热传导模型与靶板处的鞘层边界条件结合起来，创建一个能够模拟从鞘层限制到传导限制状态转变的一维刮削层模型。通过改变输入参数（如热流、连接长度和导热系数），您将能亲手探索这些状态之间的过渡，并量化观察上游和靶板温度的变化，从而加深对两种机制相互作用的理解。", "problem": "考虑一个磁约束聚变等离子体中刮削层（SOL）的一维稳态模型。设沿磁力线的空间坐标为 $s \\in [0,L_{\\parallel}]$，其中 $s=0$ 为上游（靠近分界面/中平面处），$s=L_{\\parallel}$ 为偏滤器靶板。假设：\n\n- 平行电子热通量 $q(s)$ 沿 $s$ 是恒定的，因为在所关注的刮削层段中，体源和体汇可以忽略不计，因此能量守恒意味着 $\\mathrm{d}q/\\mathrm{d}s = 0$。\n- 电子平行热传导遵循 Spitzer-Härm 定标关系，即 $q = -\\kappa(T)\\,\\mathrm{d}T/\\mathrm{d}s$ 且 $\\kappa(T) = \\kappa_0\\,T^{5/2}$，其中 $T$ 是以电子伏特（eV）为单位的电子温度，$\\kappa_0$ 是一个常数前置因子，单位为 $\\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$。\n- 在靶板鞘层（$s=L_{\\parallel}$）处，鞘层热输运设定了热通量的边界条件。靶板处的平行热通量由 $q = \\gamma\\,n_e\\,k_B T\\,c_s$ 给出，其中 $n_e$ 是电子密度，$k_B$ 是玻尔兹曼常数，$T$ 是电子温度，$c_s$ 是声速。声速为 $c_s = \\sqrt{k_B T/m_i}$，其中 $m_i$ 是离子质量。在本问题中，$T$ 的单位必须被一致地处理：热传导公式使用以eV为单位的 $T$，而 $k_B T$ 必须以焦耳为单位，这需要进行转换 $k_B T = e\\,T_{\\mathrm{eV}}$，其中 $e$ 是元电荷，$T_{\\mathrm{eV}}$ 表示以eV为单位的温度。\n\n从这些原理出发，通过沿 $s$ 积分热传导定律，推导上游温度 $T_u = T(0)$、靶板温度 $T_t = T(L_{\\parallel})$ 和恒定热通量 $q$ 之间的关系。当 $q$ 等于 $s=0$ 处给定的输入热通量 $q_{\\mathrm{in}}$ 时，将此关系与鞘层边界条件结合，以获得关于 $T_u$、$T_t$ 和 $q$ 的封闭系统。\n\n定义一个无量纲区域参数 $D$，用于比较沿 $L_{\\parallel}$ 由热传导引起的温度降与靶板处的鞘层项。基于上述定律明确推导 $D$，不引入任何新的经验性闭合关系。根据 $D$ 将区域分类为鞘层限制区或热传导限制区。该分类必须是算法化的：对于鞘层限制区返回 $0$，对于热传导限制区返回 $1$，并使用一个你从推导中证明其合理性的阈值。\n\n你的任务是实现一个数值实验，对于一组测试用例，在保持 $n_e$ 和其他参数不变的情况下，改变 $\\kappa_0$ 和 $L_{\\parallel}$ 的值，并计算以下可观测量：\n\n1. 靶板温度 $T_t$，单位为电子伏特（eV）。\n2. 上游温度 $T_u$，单位为电子伏特（eV）。\n3. 输入热通量 $q_{\\mathrm{in}}$，单位为 $\\mathrm{W}/\\mathrm{m}^2$。\n4. 推导出的无量纲区域参数 $D$（无单位）。\n5. 区域分类，以整数表示（$0$ 表示鞘层限制，$1$ 表示热传导限制）。\n\n所有温度以eV表示，所有热通量以 $\\mathrm{W}/\\mathrm{m}^2$ 表示。$T_t$、$T_u$、$q_{\\mathrm{in}}$ 和 $D$ 的输出值必须四舍五入到三位小数。\n\n在SI单位制下使用以下物理常数：\n- 元电荷 $e = 1.602176634\\times 10^{-19}\\ \\text{C}$。\n- 玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\ \\text{J/K}$。\n- 氘离子质量 $m_i = 3.343583719\\times 10^{-27}\\ \\text{kg}$。\n\n使用以下固定参数：\n- 鞘层热输运因子 $\\gamma = 7.0$。\n- 电子密度 $n_e = 1.0\\times 10^{19}\\ \\text{m}^{-3}$。\n\n为以下 $(\\kappa_0, L_{\\parallel}, q_{\\mathrm{in}})$ 值的测试套件实现实验：\n- 测试1（正常路径，长连接长度）：$\\kappa_0 = 2000\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 20\\ \\text{m}$，$q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\text{W/m}^2$。\n- 测试2（鞘层限制偏向：大 $\\kappa_0$，短 $L_{\\parallel}$）：$\\kappa_0 = 5000\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 2\\ \\text{m}$，$q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\text{W/m}^2$。\n- 测试3（接近过渡区）：$\\kappa_0 = 2000\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 5\\ \\text{m}$，$q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\text{W/m}^2$。\n- 测试4（低热通量）：$\\kappa_0 = 2000\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 20\\ \\text{m}$，$q_{\\mathrm{in}} = 1.0\\times 10^{5}\\ \\text{W/m}^2$。\n- 测试5（强鞘层限制）：$\\kappa_0 = 20000\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 1\\ \\text{m}$，$q_{\\mathrm{in}} = 1.0\\times 10^{7}\\ \\text{W/m}^2$。\n- 测试6（强热传导限制）：$\\kappa_0 = 500\\ \\text{W}\\cdot\\text{m}^{-1}\\cdot\\text{eV}^{-7/2}$，$L_{\\parallel} = 30\\ \\text{m}$，$q_{\\mathrm{in}} = 1.0\\times 10^{7}\\ \\text{W/m}^2$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是 $[T_t, T_u, q_{\\mathrm{in}}, D, \\text{regime}]$ 顺序的列表，其中前四项是四舍五入到三位小数的浮点数，最后一项是整数。例如，总输出应如下所示：\n[[Tt1,Tu1,q1,D1,regime1],[Tt2,Tu2,q2,D2,regime2],...]。", "solution": "用户提供了一个有效且适定的等离子体物理学问题，该问题涉及聚变装置刮削层（SOL）中的热输运。该问题在科学上基于标准的一维稳态双点模型。所有必要的参数、常数和控制方程均已提供，不存在矛盾或模糊之处。我们现在将进行完整的推导和求解。\n\n问题的核心是在恒定的平行热通量 $q$ 下，将上游等离子体温度 $T_u$ 与偏滤器靶板温度 $T_t$ 联系起来。这由两个基本原理控制：沿磁力线的热传导和通过靶板鞘层的热输运。\n\n首先，我们考虑由 Spitzer-Härm 定律描述的电子平行热传导：\n$$q = -\\kappa(T) \\frac{dT}{ds}$$\n其中 $q$ 是热通量，单位为 $\\mathrm{W}/\\mathrm{m}^2$，$s$ 是沿磁力线从上游点（$s=0$）到靶板（$s=L_{\\parallel}$）的坐标，$T$ 是以电子伏特（eV）为单位的电子温度。热导率 $\\kappa(T)$ 由 $\\kappa(T) = \\kappa_0 T^{5/2}$ 给出，其中 $\\kappa_0$ 是一个常数。由于问题陈述体能量源和汇可以忽略不计，因此热通量 $q$ 沿 $s$ 是恒定的。\n\n我们可以对该方程进行积分以求得温度分布。我们分离变量并在刮削层的长度 $L_{\\parallel}$ 上进行积分：\n$$q \\int_{0}^{L_{\\parallel}} ds = -\\kappa_0 \\int_{T(0)}^{T(L_{\\parallel})} T^{5/2} dT$$\n设 $T_u = T(0)$ 且 $T_t = T(L_{\\parallel})$，积分得到：\n$$q L_{\\parallel} = -\\kappa_0 \\left[ \\frac{2}{7} T^{7/2} \\right]_{T_u}^{T_t} = -\\frac{2}{7} \\kappa_0 (T_t^{7/2} - T_u^{7/2})$$\n整理后得到双点模型的基本关系式：\n$$T_u^{7/2} = T_t^{7/2} + \\frac{7 q L_{\\parallel}}{2 \\kappa_0}$$\n这个方程通过热通量、连接长度和热导率将上游温度和靶板温度联系起来。\n\n其次，我们应用偏滤器靶板（$s=L_{\\parallel}$）处的边界条件，该条件由鞘层物理决定。进入鞘层的热通量由以下公式给出：\n$$q = \\gamma n_e k_B T_t c_s$$\n其中 $\\gamma$ 是鞘层热输运因子，$n_e$ 是电子密度，$c_s$ 是离子声速，$c_s = \\sqrt{k_B T_t / m_i}$。项 $k_B T_t$ 代表热能，单位必须是焦耳。由于我们的温度 $T$ 以eV为单位，我们必须使用转换 $k_B T_t \\rightarrow e T_t$，其中 $e$ 是元电荷。代入此式以及 $c_s$ 的表达式：\n$$q = \\gamma n_e (e T_t) \\sqrt{\\frac{e T_t}{m_i}} = \\gamma n_e e^{3/2} m_i^{-1/2} T_t^{3/2}$$\n为方便起见，我们定义鞘层系数 $C_{sh} = \\gamma n_e e^{3/2} m_i^{-1/2}$，于是鞘层边界条件简化为：\n$$q = C_{sh} T_t^{3/2}$$\n\n有了这两个方程，我们就得到了一个封闭系统。对于给定的输入热通量 $q_{\\mathrm{in}}$，我们令 $q = q_{\\mathrm{in}}$ 并求解温度。\n1.  从鞘层方程中，我们求解靶板温度 $T_t$：\n    $$T_t = \\left( \\frac{q_{\\mathrm{in}}}{C_{sh}} \\right)^{2/3}$$\n2.  已知 $T_t$ 和 $q_{\\mathrm{in}}$，我们使用积分后的热传导方程来求解上游温度 $T_u$：\n    $$T_u = \\left( T_t^{7/2} + \\frac{7 q_{\\mathrm{in}} L_{\\parallel}}{2 \\kappa_0} \\right)^{2/7}$$\n\n问题要求定义一个无量纲区域参数 $D$，以区分鞘层限制区和热传导限制区。我们来看关于 $T_u^{7/2}$ 的方程：\n$$T_u^{7/2} = T_t^{7/2} + \\frac{7 q L_{\\parallel}}{2 \\kappa_0}$$\n$T_t^{7/2}$ 项代表由鞘层边界条件设定的温度标度。$\\frac{7 q L_{\\parallel}}{2 \\kappa_0}$ 项代表在距离 $L_{\\parallel}$ 上由热传导引起的温度降。一个自然的无量纲参数是这两项的比值：\n$$D = \\frac{7 q L_{\\parallel} / (2 \\kappa_0)}{T_t^{7/2}} = \\frac{7 q L_{\\parallel}}{2 \\kappa_0 T_t^{7/2}}$$\n$D$ 的物理诠释如下：\n-   如果热传导非常高效（$\\kappa_0$ 很大）或连接长度 $L_{\\parallel}$ 很短，则温度分布几乎是平坦的（$T_u \\approx T_t$）。在这种情况下，热传导项相对于鞘层项很小，因此 $D \\ll 1$。这就是**鞘层限制区**。\n-   如果热传导效率低（$\\kappa_0$ 很小）或连接长度 $L_{\\parallel}$ 很长，则需要很大的温度梯度来驱动热通量，导致 $T_u \\gg T_t$。热传导项占主导地位，因此 $D \\gg 1$。这就是**热传导限制区**。\n\n对于算法分类，必须选择一个阈值。自然的选择是 $D=1$，这一点代表了由热传导引起的温度降与靶板温度本身（在此 $T^{7/2}$ 定标关系下）同量级。在 $D=1$ 时，$T_u^{7/2} = 2T_t^{7/2}$，这意味着 $T_u = 2^{2/7}T_t \\approx 1.22 T_t$。这代表了“平坦”和“陡峭”温度分布之间的一个合理过渡点。因此，我们设定分类规则：\n-   如果 $D < 1$，则为鞘层限制区（返回 $0$）。\n-   如果 $D \\ge 1$，则为热传导限制区（返回 $1$）。\n\n数值实现将遵循这一逻辑。对于每个测试用例 $(\\kappa_0, L_{\\parallel}, q_{\\mathrm{in}})$，我们将使用提供的常数计算 $C_{sh}$，然后使用推导出的公式计算 $T_t$、$T_u$ 和 $D$，最后对区域进行分类。结果将按规定格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state SOL heat transport problem for a series of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs\n    m_ion_d = 3.343583719e-27   # Deuterium ion mass in kg\n\n    # Fixed plasma parameters\n    gamma_sh = 7.0             # Sheath heat transmission factor\n    n_electron = 1.0e19        # Electron density in m^-3\n\n    # Test suite of parameters: (kappa_0, L_parallel, q_in)\n    # kappa_0: W m^-1 eV^-7/2\n    # L_parallel: m\n    # q_in: W/m^2\n    test_cases = [\n        (2000.0, 20.0, 5.0e6),   # Test 1: Happy path, long connection\n        (5000.0, 2.0, 5.0e6),    # Test 2: Sheath-limited bias\n        (2000.0, 5.0, 5.0e6),    # Test 3: Near transition\n        (2000.0, 20.0, 1.0e5),   # Test 4: Low heat flux\n        (20000.0, 1.0, 1.0e7),   # Test 5: Strong sheath-limited\n        (500.0, 30.0, 1.0e7)     # Test 6: Strong conduction-limited\n    ]\n\n    all_results = []\n\n    # Pre-calculate the sheath coefficient C_sh = gamma * n_e * e^(3/2) * m_i^(-1/2)\n    # T_t will be in eV, q in W/m^2.\n    C_sh = gamma_sh * n_electron * (e_charge**1.5) * (m_ion_d**-0.5)\n\n    for case in test_cases:\n        kappa_0, L_parallel, q_in = case\n\n        # 1. Calculate target temperature T_t from the sheath boundary condition\n        # q = C_sh * T_t^(3/2)\n        T_t = (q_in / C_sh)**(2.0 / 3.0)\n\n        # 2. Calculate upstream temperature T_u from the integrated conduction law\n        # T_u^(7/2) = T_t^(7/2) + (7 * q * L_parallel) / (2 * kappa_0)\n        # We calculate the term in parenthesis first\n        conduction_term = (7.0 * q_in * L_parallel) / (2.0 * kappa_0)\n        T_u_pow_7_2 = T_t**3.5 + conduction_term\n        T_u = T_u_pow_7_2**(2.0 / 7.0)\n\n        # 3. Calculate the dimensionless regime parameter D\n        # D = (conduction term) / (sheath term)\n        # where sheath term is T_t^(7/2)\n        if T_t == 0:\n            # Avoid division by zero, though physically T_t > 0 for q_in > 0\n            D = float('inf')\n        else:\n            D = conduction_term / (T_t**3.5)\n\n        # 4. Classify the regime based on D\n        # 0 for sheath-limited (D  1), 1 for conduction-limited (D >= 1)\n        regime = 1 if D >= 1.0 else 0\n\n        # 5. Store the results for this case. q_in is also an \"observable\".\n        # Formatting to 3 decimal places occurs in the final print statement.\n        result_list = [T_t, T_u, q_in, D, regime]\n        all_results.append(result_list)\n\n    # Format the final output string as a list of lists, with no spaces\n    # and with specified rounding for float values.\n    outer_parts = []\n    for res in all_results:\n        # res = [T_t, T_u, q_in, D, regime]\n        inner_parts = [\n            f\"{res[0]:.3f}\",\n            f\"{res[1]:.3f}\",\n            f\"{float(res[2]):.3f}\",\n            f\"{res[3]:.3f}\",\n            str(res[4])\n        ]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n\n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "3718553"}]}