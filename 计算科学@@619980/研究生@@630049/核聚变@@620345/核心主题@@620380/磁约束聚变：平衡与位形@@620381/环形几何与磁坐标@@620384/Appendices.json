{"hands_on_practices": [{"introduction": "安全因子 $q$ 是描述托卡马克等环形约束装置中磁场线螺距的关键无量纲参数，它对等离子体的宏观不稳定性有决定性影响。本练习提供了一个从基本定义出发，通过直接计算磁场在给定磁通面上的环向和角向路径积分来求解 $q$ 值的机会 [@problem_id:3723432]。这项实践将加深你对磁场结构如何决定这一核心物理量的理解，并锻炼在环形几何中应用基本物理原理的能力。", "problem": "考虑一个具有圆形同心磁通量面的大环径比轴对称托卡马克。设小半径为 $r$ 的磁通量面在柱坐标 $(R,\\phi,Z)$ 中由角向角 $\\theta$ 和环向角 $\\phi$ 参数化为\n$$R(\\theta) = R_{0} + r\\cos\\theta,\\quad Z(\\theta) = r\\sin\\theta,$$\n其中角度以弧度为单位。磁场 $\\mathbf{B}(R,Z)$ 由环向场线圈产生的环向分量和由给定的角向磁通函数产生的角向分量组成。具体来说：\n- 环向分量与一组圆形环向场线圈一致，由下式给出\n$$\\mathbf{B}_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\\,\\mathbf{e}_{\\phi},$$\n其中 $\\mathbf{e}_{\\phi}$ 是环向单位矢量，$B_{0}$ 是磁轴 $R=R_{0}$ 处的环向磁场。\n- 角向分量通过轴对称角向磁通函数 $\\psi(r)$ 定义为\n$$\\mathbf{B}_{\\text{pol}} = \\frac{1}{R}\\,\\nabla\\psi(r)\\times \\mathbf{e}_{\\phi}.$$\n\n使用安全因子 $q(\\psi)$ 的基本定义，即磁力线每绕角向一圈所绕的环向圈数。为计算给定磁通量面上的 $q(\\psi)$，需沿该磁通量面上的磁力线计算角向和环向的线积分。然后，验证您的结果与 $\\mathbf{B}_{\\phi}(R)$ 中编码的环向场线圈几何结构的一致性。\n\n计算数据：\n- 大半径 $R_{0} = 2.8\\ \\mathrm{m}$。\n- 磁通量面小半径 $r = 0.40\\ \\mathrm{m}$。\n- 等离子体小半径 $a = 0.60\\ \\mathrm{m}$。\n- 轴上环向场 $B_{0} = 4.5\\ \\mathrm{T}$。\n- 角向磁通函数 $\\psi(r) = \\psi_{0}\\,(r/a)^{2}$，其中 $\\psi_{0} = 0.50\\ \\mathrm{Wb/rad}$ (定义为每弧度的角向磁通量)。\n\n通过在该磁通量面上沿磁力线显式地进行必要的角向和环向线积分，计算磁通量面 $r = 0.40\\ \\mathrm{m}$ 处的安全因子 $q(\\psi)$。在您的推导中，确认环向场线圈的几何结构意味着 $R B_{\\phi}$ 在该磁通量面上是恒定的。将您的最终答案表示为一个无量纲数。将您的答案四舍五入到四位有效数字。", "solution": "安全因子 $q$ 定义为磁力线在角向（poloidal）方向上完整地绕行一圈时，在环向（toroidal）方向上所绕过的圈数。这可以通过对磁力线路径的积分来计算。磁力线方程由下式给出：\n$$ \\frac{dl_{\\text{pol}}}{dl_{\\phi}} = \\frac{B_{\\text{pol}}}{B_{\\phi}} $$\n其中 $dl_{\\text{pol}} = r\\,d\\theta$ 是角向的弧长微元，$dl_{\\phi} = R\\,d\\phi$ 是环向的弧长微元。因此，我们有：\n$$ \\frac{r\\,d\\theta}{R\\,d\\phi} = \\frac{B_{\\text{pol}}}{B_{\\phi}} \\implies \\frac{d\\phi}{d\\theta} = \\frac{R}{r} \\frac{B_{\\phi}}{B_{\\text{pol}}} $$\n安全因子 $q$ 是磁力线绕角向一整圈（$\\Delta\\theta=2\\pi$）时，环向角的变化量 $\\Delta\\phi$ 除以 $2\\pi$：\n$$ q = \\frac{\\Delta\\phi}{2\\pi} = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{d\\phi}{d\\theta} \\,d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{R}{r} \\frac{B_{\\phi}}{B_{\\text{pol}}} \\,d\\theta $$\n首先，我们计算角向磁场 $B_{\\text{pol}}$ 的大小。根据定义 $\\mathbf{B}_{\\text{pol}} = \\frac{1}{R}\\,\\nabla\\psi(r)\\times \\mathbf{e}_{\\phi}$ 和给定的角向磁通函数 $\\psi(r) = \\psi_{0}\\,(r/a)^{2}$，我们得到：\n$$ \\nabla\\psi(r) = \\frac{d\\psi}{dr}\\mathbf{e}_r = \\frac{2\\psi_0 r}{a^2}\\mathbf{e}_r $$\n$$ \\mathbf{B}_{\\text{pol}} = \\frac{1}{R} \\left(\\frac{2\\psi_0 r}{a^2}\\mathbf{e}_r \\times \\mathbf{e}_\\phi\\right) = \\frac{2\\psi_0 r}{R a^2} \\mathbf{e}_\\theta $$\n因此，其大小为 $B_{\\text{pol}} = \\frac{2\\psi_0 r}{R a^2}$。\n环向磁场为 $B_\\phi = \\frac{B_0 R_0}{R}$。将这两个表达式代入 $q$ 的积分公式中：\n$$ q = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{R_0+r\\cos\\theta}{r} \\frac{B_0 R_0/R}{2\\psi_0 r/(R a^2)} \\,d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{R}{r} \\frac{B_0 R_0 a^2 R}{2\\psi_0 r R} \\,d\\theta = \\frac{B_0 R_0 a^2}{2\\psi_0 r^2} \\frac{1}{2\\pi} \\int_0^{2\\pi} (R_0+r\\cos\\theta) \\,d\\theta $$\n等等，这是不正确的。让我们重新从正确的微分关系开始。\n$\\frac{d\\phi}{d\\theta} = \\frac{R}{r} \\frac{B_\\phi}{B_{pol}}$ 是错误的。正确的场线跟随方程是 $\\frac{R d\\phi}{r d\\theta} = \\frac{B_\\phi}{B_{pol}}$，这意味着 $\\frac{d\\phi}{d\\theta} = \\frac{r}{R} \\frac{B_\\phi}{B_{pol}}$。\n因此，\n$$ q = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r}{R} \\frac{B_{\\phi}}{B_{\\text{pol}}} \\,d\\theta $$\n代入磁场分量：\n$$ q = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r}{R} \\frac{B_0 R_0/R}{2\\psi_0 r/(R a^2)} \\,d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r}{R} \\frac{B_0 R_0 a^2}{2\\psi_0 r} \\,d\\theta $$\n$$ q = \\frac{B_0 R_0 a^2}{4\\pi\\psi_0} \\int_0^{2\\pi} \\frac{1}{R} \\,d\\theta = \\frac{B_0 R_0 a^2}{4\\pi\\psi_0} \\int_0^{2\\pi} \\frac{d\\theta}{R_0 + r\\cos\\theta} $$\n这是一个标准积分，$\\int_0^{2\\pi} \\frac{d\\theta}{A+B\\cos\\theta} = \\frac{2\\pi}{\\sqrt{A^2-B^2}}$ (对于 $A > |B|$）。在此问题中，$A=R_0$ 且 $B=r$，条件 $R_0 > r$ 满足。\n$$ q = \\frac{B_0 R_0 a^2}{4\\pi\\psi_0} \\left( \\frac{2\\pi}{\\sqrt{R_0^2-r^2}} \\right) = \\frac{B_0 R_0 a^2}{2\\psi_0 \\sqrt{R_0^2-r^2}} $$\n问题要求确认 $R B_{\\phi}$ 在磁通面上是常数。由给定的环向场分量 $\\mathbf{B}_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\\,\\mathbf{e}_{\\phi}$，其大小为 $B_{\\phi} = \\frac{B_0 R_0}{R}$。两边乘以 $R$ 得到 $R B_{\\phi} = B_0 R_0$。由于 $B_0$ 和 $R_0$ 是常数，因此 $R B_{\\phi}$ 在整个空间中都是常数，自然也在给定的磁通面上是常数。这符合由外部环向场线圈产生的真空场的特性。\n\n现在代入数值：\n$R_0 = 2.8$ m\n$r = 0.40$ m\n$a = 0.60$ m\n$B_0 = 4.5$ T\n$\\psi_0 = 0.50$ Wb/rad\n$$ q = \\frac{(4.5\\,\\mathrm{T})(2.8\\,\\mathrm{m})(0.60\\,\\mathrm{m})^2}{2(0.50\\,\\mathrm{Wb/rad}) \\sqrt{(2.8\\,\\mathrm{m})^2 - (0.40\\,\\mathrm{m})^2}} = \\frac{4.5 \\times 2.8 \\times 0.36}{1.0 \\times \\sqrt{7.84 - 0.16}} = \\frac{4.536}{\\sqrt{7.68}} $$\n$$ q = \\frac{4.536}{2.77128...} \\approx 1.6368... $$\n四舍五入到四位有效数字，得到 $q = 1.637$。", "answer": "$$\\boxed{1.637}$$", "id": "3723432"}, {"introduction": "在磁约束聚变理论中，选择合适的坐标系对于简化分析和计算至关重要。布泽尔 (Boozer) 坐标系就是这样一种巧妙的构造，它通过拉直磁场线，极大地简化了磁流体动力学 (MHD) 平衡和输运方程的形式 [@problem_id:3723461]。本练习要求你推导布泽尔坐标系的雅可比行列式 $J_{\\text{Boozer}}$，这一过程将揭示磁场强度 $B$、磁场协变分量 $G(\\psi)$ 和 $I(\\psi)$ 以及旋转变换 $\\iota(\\psi)$ 之间的深刻几何联系，是掌握高等等离子体平衡理论的基石。", "problem": "考虑一个环向约束等离子体，其具有由标量磁通函数 $\\psi$ 标记的嵌套磁通量面，以及参数化每个磁通量面的角坐标 $(\\theta,\\zeta)$。假设存在一个不随时间变化的磁场 $\\mathbf{B}$，该磁场与磁通量面相切，因此有 $\\mathbf{B}\\cdot\\nabla\\psi=0$。设 $(\\psi,\\theta,\\zeta)$ 为 Boozer 磁坐标，其定义为：磁场具有由旋转变换 $\\iota(\\psi)$（在每个磁通量面上为常数）表征的直磁力线，且磁场的协变分量仅依赖于 $\\psi$，即\n$$\n\\mathbf{B} = I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta,\n$$\n其中 $I(\\psi)$ 和 $G(\\psi)$ 是磁通函数。坐标变换 $\\mathbf{r}(\\psi,\\theta,\\zeta)$ 的 Boozer 雅可比行列式 $J_{\\text{Boozer}}$ 定义为\n$$\nJ_{\\text{Boozer}} \\equiv \\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\zeta\\right)^{-1}.\n$$\n从直磁力线条件和曲线坐标系的基本微分几何恒等式出发，用 $B\\equiv|\\mathbf{B}|$, $I(\\psi)$, $G(\\psi)$, 和 $\\iota(\\psi)$ 推导出 $J_{\\text{Boozer}}$。然后，讨论磁通归一化的改变 $\\psi\\mapsto\\psi' = F(\\psi)$（其中 $F'(\\psi)>0$）如何影响 $J_{\\text{Boozer}}$ 以及您表达式中出现的组合项 $G(\\psi)+\\iota(\\psi) I(\\psi)$。\n\n您的最终答案必须是关于 $B$, $I(\\psi)$, $G(\\psi)$ 和 $\\iota(\\psi)$ 的 $J_{\\text{Boozer}}(\\psi,\\theta,\\zeta)$ 的单个闭式解析表达式。无需进行数值计算，最终答案中不应包含任何单位。如果您引入了任何中间常数或函数，请将它们从最终表达式中消去，以使答案仅涉及 $B$, $I(\\psi)$, $G(\\psi)$ 和 $\\iota(\\psi)$。", "solution": "为了推导布泽尔（Boozer）坐标系下的雅可比行列式 $J_{\\text{Boozer}}$，我们从磁场 $\\mathbf{B}$ 的协变和逆变表示入手。\n\n在布泽尔坐标系 $(\\psi, \\theta, \\zeta)$ 中，磁场 $\\mathbf{B}$ 的协变形式为：\n$$ \\mathbf{B} = I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta $$\n其中 $I(\\psi)$ 和 $G(\\psi)$ 是磁通函数。磁场大小的平方 $B^2$ 可以通过 $\\mathbf{B}$ 与自身的点积计算得出：\n$$ B^2 = \\mathbf{B} \\cdot \\mathbf{B} = \\mathbf{B} \\cdot (I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta) = I(\\psi)(\\mathbf{B} \\cdot \\nabla\\theta) + G(\\psi)(\\mathbf{B} \\cdot \\nabla\\zeta) $$\n注意到 $\\mathbf{B} \\cdot \\nabla\\theta = B^\\theta$ 和 $\\mathbf{B} \\cdot \\nabla\\zeta = B^\\zeta$ 分别是磁场的逆变分量，因此：\n$$ B^2 = I(\\psi)B^\\theta + G(\\psi)B^\\zeta $$\n布泽尔坐标的一个定义性特征是磁力线是“直的”，这意味着在磁通面上，磁力线路径的角向速度与环向速度之比是一个常数，即旋转变换 $\\iota(\\psi)$：\n$$ \\frac{d\\theta}{d\\zeta} = \\frac{B^\\theta}{B^\\zeta} = \\iota(\\psi) $$\n将 $B^\\theta = \\iota(\\psi)B^\\zeta$ 代入 $B^2$ 的表达式中，我们得到：\n$$ B^2 = I(\\psi)(\\iota(\\psi)B^\\zeta) + G(\\psi)B^\\zeta = (G(\\psi) + \\iota(\\psi)I(\\psi)) B^\\zeta \\quad (*)$$\n接下来，我们利用磁场无散度条件 $\\nabla\\cdot\\mathbf{B} = 0$。在一般曲线坐标中，该条件写作：\n$$ \\nabla\\cdot\\mathbf{B} = \\frac{1}{J}\\left( \\frac{\\partial}{\\partial\\psi}(J B^\\psi) + \\frac{\\partial}{\\partial\\theta}(J B^\\theta) + \\frac{\\partial}{\\partial\\zeta}(J B^\\zeta) \\right) = 0 $$\n由于磁力线位于磁通面上，$\\mathbf{B} \\cdot \\nabla\\psi = B^\\psi = 0$。布泽尔坐标的另一个关键特征是其构造使得乘积 $J_{\\text{Boozer}}B^\\theta$ 和 $J_{\\text{Boozer}}B^\\zeta$ 均为磁通函数（即仅依赖于 $\\psi$）。这一特性自动满足了无散度条件。\n\n为了确定这些函数的具体形式，需要一个归一化约定。标准布泽尔坐标约定将磁通坐标 $\\psi$ 定义为环向磁通量 $\\Psi_t$ 除以 $2\\pi$，即 $\\Psi_t = 2\\pi\\psi$。环向磁通量对 $\\psi$ 的导数为：\n$$ \\frac{d\\Psi_t}{d\\psi} = \\int_0^{2\\pi} \\mathbf{B} \\cdot (J_{\\text{Boozer}}\\nabla\\zeta) \\, d\\theta = \\int_0^{2\\pi} J_{\\text{Boozer}} B^\\zeta \\, d\\theta $$\n由于 $J_{\\text{Boozer}}B^\\zeta$ 是一个磁通函数，它在积分中是常数，因此：\n$$ \\frac{d\\Psi_t}{d\\psi} = 2\\pi (J_{\\text{Boozer}}B^\\zeta) $$\n根据我们的归一化约定 $\\frac{d\\Psi_t}{d\\psi} = 2\\pi$，我们立即得到一个核心关系：\n$$ J_{\\text{Boozer}}B^\\zeta = 1 $$\n最后，将 $B^\\zeta = \\frac{B^2}{G(\\psi) + \\iota(\\psi)I(\\psi)}$ 从方程 $(*)$ 代入上述关系式：\n$$ J_{\\text{Boozer}} \\left( \\frac{B^2}{G(\\psi) + \\iota(\\psi)I(\\psi)} \\right) = 1 $$\n求解 $J_{\\text{Boozer}}$ 得到最终表达式：\n$$ J_{\\text{Boozer}} = \\frac{G(\\psi) + \\iota(\\psi)I(\\psi)}{B^2} $$\n关于磁通归一化的改变 $\\psi \\mapsto \\psi' = F(\\psi)$：组合项 $G(\\psi) + \\iota(\\psi)I(\\psi)$ 的值在任一给定的磁通面上是不变的，因为它描述的是该面的内在物理属性。然而，雅可比行列式本身会根据 $J' = J/F'(\\psi)$ 进行变换，这与磁通定义的改变所导致的归一化常数的变化是一致的。", "answer": "$$\n\\boxed{\\frac{G(\\psi) + \\iota(\\psi) I(\\psi)}{B^{2}}}\n$$", "id": "3723461"}, {"introduction": "理论概念的选择往往会对数值计算的效率和精度产生直接影响，磁坐标系的选择就是典型例子。本练习将理论与实践相结合，通过一个具体的数值任务来比较两种常用的磁坐标系——布泽尔 (Boozer) 坐标系与滨田 (Hamada) 坐标系——的优劣 [@problem_id:3723408]。你将通过编写程序实现一个判据，以评估哪个坐标系能使磁面平均的被积函数更“均匀”，从而在数值积分中引入更小的离散误差，深刻体会理论性质在计算物理中的实际应用价值。", "problem": "考虑用于核聚变的环形约束装置中的单个嵌套磁通面。设该磁通面由环向磁通量 $\\psi$ 标记，并由直磁力线角 $(\\theta,\\zeta)$ 参数化，其中 $\\theta \\in [0,2\\pi)$ 是角向角，$\\zeta \\in [0,2\\pi)$ 是环向角，两者均以弧度为单位。磁通面上的磁场强度由一个截断的傅里叶级数表示\n$$\nB(\\theta,\\zeta) = B_0 \\left[ 1 + \\epsilon \\cos(m\\,\\theta - n\\,\\zeta) \\right],\n$$\n其中 $B_0$ 的单位是特斯拉（Tesla），$m$ 和 $n$ 是整数模数，无量纲振幅 $\\epsilon$ 满足 $0 \\le \\epsilon  1$，以确保 $B(\\theta,\\zeta)  0$。假设存在理想磁流体动力学（MHD）平衡和直磁力线磁坐标。\n\n两种广泛使用的磁坐标系是 Boozer 坐标系和 Hamada 坐标系。在 Boozer 坐标系中，一个经过充分检验的性质是 $B^2 J$ 是一个磁通函数，其中 $J$ 是从 $(\\psi,\\theta,\\zeta)$ 到 $(x,y,z)$ 变换的雅可比行列式，而磁通函数仅依赖于 $\\psi$。在 Hamada 坐标系中，一个经过充分检验的性质是 $J$ 本身就是一个磁通函数。在单个磁通面上，任何磁通函数都可以被视为关于 $(\\theta,\\zeta)$ 的常数，并被吸收到归一化中。因此，为了在单个磁通面上进行数值积分，可以将雅可比行列式的角相关性建模为\n- Hamada: $J_{\\mathrm{H}}(\\theta,\\zeta) \\propto 1$,\n- Boozer: $J_{\\mathrm{B}}(\\theta,\\zeta) \\propto \\dfrac{1}{B(\\theta,\\zeta)^2}$,\n这不包括那些不影响均匀性度量的乘法常数。\n\n设 $f(\\theta,\\zeta)$ 是需要在磁通面上平均的目标被积函数。在任何坐标系中，磁通面平均值都与以下积分成正比\n$$\n\\langle f \\rangle \\propto \\int_0^{2\\pi}\\int_0^{2\\pi} f(\\theta,\\zeta)\\, J(\\theta,\\zeta)\\, d\\theta\\, d\\zeta.\n$$\n在实际的数值磁力线追踪和积分中，通常使用对 $(\\theta,\\zeta)$ 的简单均匀采样，因此有效被积函数 $g(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J(\\theta,\\zeta)$ 的均匀性直接影响离散化误差。一个有原则的、与坐标系无关的偏好标准是选择能使 $g$ 的变异系数最小化的坐标系。对于离散样本 $\\{g_k\\}_{k=1}^K$，变异系数定义为\n$$\n\\mathrm{CV}(g) = \\frac{\\sqrt{\\mathrm{Var}(g)}}{\\mathbb{E}[g]}.\n$$\n此处，$\\mathbb{E}[g]$ 和 $\\mathrm{Var}(g)$ 表示在 $(\\theta,\\zeta)$ 均匀网格上的样本均值和样本方差。\n\n你的任务是实现这个偏好标准，并在给定指数 $p$ 和选择 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$ 的情况下，为每个测试用例判断 Boozer 坐标系是否优于 Hamada 坐标系。具体步骤如下：\n\n1. 对每个测试用例，在一个覆盖 $\\theta \\in [0,2\\pi)$ 和 $\\zeta \\in [0,2\\pi)$（单位为弧度）的 $N \\times N$（其中 $N=512$）均匀网格上构造 $B(\\theta,\\zeta)$。\n2. 使用给定的 $p$（无量纲）定义 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$。\n3. 构造 $g_{\\mathrm{H}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{H}}(\\theta,\\zeta)$（其中 $J_{\\mathrm{H}}(\\theta,\\zeta) = 1$）和 $g_{\\mathrm{B}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{B}}(\\theta,\\zeta)$（其中 $J_{\\mathrm{B}}(\\theta,\\zeta) = \\dfrac{1}{B(\\theta,\\zeta)^2}$）。由于变异系数是尺度不变的，乘法归一化常数是无关紧要的。\n4. 计算 $\\mathrm{CV}(g_{\\mathrm{B}})$ 和 $\\mathrm{CV}(g_{\\mathrm{H}})$ 作为浮点数。\n5. 当且仅当 $\\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}})$ 时，判定 Boozer 坐标系为优选。\n\n请为以下参数值的测试套件提供结果，这些参数旨在检验不同的情况：\n- 测试 1（$p=2$ 的理想情况）：$B_0 = 5$ 特斯拉, $\\epsilon = 0.1$, $m = 1$, $n = 1$, $p = 2$。\n- 测试 2（无变化的边界情况）：$B_0 = 5$ 特斯拉, $\\epsilon = 0$, $m = 1$, $n = 1$, $p = 1$。\n- 测试 3（被积函数均匀时偏好 Hamada）：$B_0 = 3$ 特斯拉, $\\epsilon = 0.25$, $m = 2$, $n = 3$, $p = 0$。\n- 测试 4（非平凡比较）：$B_0 = 2$ 特斯拉, $\\epsilon = 0.3$, $m = 3$, $n = 1$, $p = 1$。\n- 测试 5（强但为正的变化）：$B_0 = 4$ 特斯拉, $\\epsilon = 0.9$, $m = 1$, $n = 2$, $p = 2$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots,result_5]$），每个条目是一个布尔值，根据上述标准指示相应测试是否偏好 Boozer 坐标系。在整个过程中，角度必须以弧度处理。不需要外部输入，输出中也不应出现任何物理单位。", "solution": "该问题要求在 Boozer 坐标系和 Hamada 坐标系之间，为在环形磁通面上进行数值积分的目的，确定一个优选的磁坐标系。该偏好标准基于通过选择能产生更均匀有效被积函数的坐标系，来最小化与均匀网格采样相关的数值误差。均匀性由变异系数 $\\mathrm{CV}$ 来量化。\n\n磁通面上的磁场强度 $B$ 是角向角 $\\theta$ 和环向角 $\\zeta$ 的函数，表示为：\n$$B(\\theta,\\zeta) = B_0 \\left[ 1 + \\epsilon \\cos(m\\,\\theta - n\\,\\zeta) \\right]$$\n此处，$B_0$ 是基础磁场强度，$\\epsilon$ 是磁场调制的无量纲振幅，$m$ 和 $n$ 是整数模数。约束条件 $0 \\le \\epsilon  1$ 确保 $B(\\theta,\\zeta)  0$。\n\n用于磁通面平均的目标函数被指定为 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$，其中 $p$ 是一个实数指数。\n\n任何函数 $f$ 的磁通面平均值与有效被积函数 $g(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J(\\theta,\\zeta)$ 在角度域 $\\theta, \\zeta \\in [0, 2\\pi)$ 上的积分成正比。项 $J(\\theta,\\zeta)$ 是坐标变换的雅可比行列式。问题给出了在单个磁通面上两种坐标系中雅可比行列式的角度依赖行为：\n- 在 Hamada 坐标系中，雅可比行列式 $J_{\\mathrm{H}}$ 相对于 $\\theta$ 和 $\\zeta$ 是一个常数。我们可以取 $J_{\\mathrm{H}}(\\theta,\\zeta) \\propto 1$。\n- 在 Boozer 坐标系中，乘积 $B^2 J_{\\mathrm{B}}$ 是一个常数。因此，雅可比行列式必须按 $J_{\\mathrm{B}}(\\theta,\\zeta) \\propto \\frac{1}{B(\\theta,\\zeta)^2}$ 变化。\n\n使用这些形式，我们为每个坐标系定义有效被积函数（不计无关的比例常数）：\n- 对于 Hamada 坐标系：$g_{\\mathrm{H}}(\\theta,\\zeta) = f(\\theta,\\zeta) \\cdot J_{\\mathrm{H}} = B(\\theta,\\zeta)^p \\cdot 1 = B(\\theta,\\zeta)^p$。\n- 对于 Boozer 坐标系：$g_{\\mathrm{B}}(\\theta,\\zeta) = f(\\theta,\\zeta) \\cdot J_{\\mathrm{B}} = B(\\theta,\\zeta)^p \\cdot \\frac{1}{B(\\theta,\\zeta)^2} = B(\\theta,\\zeta)^{p-2}$。\n\n偏好标准是选择其有效被积函数具有较小变异系数 $\\mathrm{CV}$ 的坐标系。一组样本的 $\\mathrm{CV}$ 定义为标准差与均值的比值。由于该度量是尺度不变的，与 $B_0$ 和雅可比行列式相关的比例常数不影响比较。当且仅当不等式 $\\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}})$ 成立时，Boozer 坐标系为优选。\n\n为了实现这一标准，我们进行数值评估。将连续域 $(\\theta, \\zeta) \\in [0, 2\\pi) \\times [0, 2\\pi)$ 离散化为一个 $N \\times N$（其中 $N=512$）的均匀网格。网格点由 $(\\theta_i, \\zeta_j)$ 给出，其中 $\\theta_i = \\frac{2\\pi i}{N}$ 且 $\\zeta_j = \\frac{2\\pi j}{N}$，对于 $i, j \\in \\{0, 1, \\dots, N-1\\}$。\n\n对于由参数 $(B_0, \\epsilon, m, n, p)$ 定义的每个测试用例，执行以下步骤：\n1.  计算网格上所有点的磁场值 $B_{ij} = B(\\theta_i, \\zeta_j)$。\n2.  计算有效被积函数的相应值：$g_{\\mathrm{H}, ij} = (B_{ij})^p$ 和 $g_{\\mathrm{B}, ij} = (B_{ij})^{p-2}$。\n3.  为每组值计算变异系数。对于一组通用的 $K=N^2$ 个网格值 $\\{g_k\\}$，样本均值 $\\mathbb{E}[g]$ 和样本方差 $\\mathrm{Var}(g)$ 为：\n    $$\\mathbb{E}[g] = \\frac{1}{K} \\sum_{k=1}^K g_k$$\n    $$\\mathrm{Var}(g) = \\frac{1}{K} \\sum_{k=1}^K (g_k - \\mathbb{E}[g])^2$$\n    变异系数则为 $\\mathrm{CV}(g) = \\frac{\\sqrt{\\mathrm{Var}(g)}}{\\mathbb{E}[g]}$。\n4.  通过评估布尔表达式 $\\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}})$ 做出最终决定。\n\n将此过程应用于五个指定的测试用例中的每一个。值得注意的是，某些参数选择会导致解析上是平凡的结果。如果 $p=2$，那么 $g_{\\mathrm{B}} \\propto B^0 = 1$，这是完全均匀的。其方差和 $\\mathrm{CV}$ 均为零。除非 $\\epsilon=0$，否则 $g_{\\mathrm{H}} \\propto B^2$ 将是不均匀的，因此 $\\mathrm{CV}(g_{\\mathrm{H}}) > 0$。在这种情况下，总是偏好 Boozer 坐标系。相反，如果 $p=0$，则 $g_{\\mathrm{H}} \\propto B^0 = 1$ 是均匀的，所以 $\\mathrm{CV}(g_{\\mathrm{H}}) = 0$，而 $g_{\\mathrm{B}} \\propto B^{-2}$ 是不均匀的（对于 $\\epsilon>0$），这使得 Hamada 坐标系更优。如果 $\\epsilon=0$，磁场是恒定的，$B=B_0$，使得 $g_{\\mathrm{H}}$ 和 $g_{\\mathrm{B}}$ 都是常数。它们的 $\\mathrm{CV}$ 都为零，条件 $\\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}})$ 的评估结果为 $0  0$，这是假的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of choosing between Boozer and Hamada coordinates based on\n    the uniformity of an effective integrand for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (B0, epsilon, m, n, p).\n    test_cases = [\n        (5.0, 0.1, 1, 1, 2.0),\n        (5.0, 0.0, 1, 1, 1.0),\n        (3.0, 0.25, 2, 3, 0.0),\n        (2.0, 0.3, 3, 1, 1.0),\n        (4.0, 0.9, 1, 2, 2.0),\n    ]\n\n    results = []\n    N = 512\n\n    # Create the angular grids for theta and zeta.\n    # The grid covers [0, 2*pi) as specified.\n    angles = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    theta_grid, zeta_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    for b0, epsilon, m, n, p in test_cases:\n        # Calculate the magnetic field B(theta, zeta) on the grid.\n        # B = B_0 * [1 + epsilon * cos(m*theta - n*zeta)]\n        B_grid = b0 * (1 + epsilon * np.cos(m * theta_grid - n * zeta_grid))\n\n        # Form the effective integrands g_H and g_B.\n        # g_H is proportional to B^p\n        # g_B is proportional to B^(p-2)\n        g_H = np.power(B_grid, p)\n        g_B = np.power(B_grid, p - 2)\n\n        # Calculate the coefficient of variation (CV) for each integrand.\n        # CV(g) = std(g) / mean(g).\n        # We use the population standard deviation (numpy.std default, ddof=0),\n        # as the grid represents the entire population of discrete points.\n        \n        # Denominators (means) are guaranteed to be positive since B > 0.\n        mean_g_H = np.mean(g_H)\n        std_g_H = np.std(g_H)\n        # Avoid division by zero if mean is zero, though not expected here.\n        cv_H = std_g_H / mean_g_H if mean_g_H != 0 else 0\n\n        mean_g_B = np.mean(g_B)\n        std_g_B = np.std(g_B)\n        cv_B = std_g_B / mean_g_B if mean_g_B != 0 else 0\n\n        # Decide if Boozer coordinates are preferred.\n        # The criterion is CV(g_B)  CV(g_H).\n        is_boozer_preferred = cv_B  cv_H\n        results.append(is_boozer_preferred)\n\n    # Final print statement in the exact required format.\n    # The results list contains booleans, which need to be converted to lowercase strings.\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```", "id": "3723408"}]}