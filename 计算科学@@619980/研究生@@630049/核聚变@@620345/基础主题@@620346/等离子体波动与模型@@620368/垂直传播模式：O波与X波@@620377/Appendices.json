{"hands_on_practices": [{"introduction": "对等离子体波的严谨理解始于其数学推导。本练习 [@problem_id:3712630] 要求您直接从波动方程和冷等离子体介电张量出发，推导O波和X波的色散关系。这个过程将加深您对麦克斯韦方程组如何与等离子体介质特性相结合，从而产生这些基本传播模式的理解。", "problem": "考虑一个代表了磁约束核聚变装置的均匀、无碰撞的冷磁化等离子体，它由电子和单一离子种类组成。静磁场为 $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$。一个角频率为 $\\omega$ 的单色平面波垂直于 $\\boldsymbol{B}_{0}$ 传播，其波矢为 $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$。令折射率为 $n \\equiv c k/\\omega$。在冷等离子体近似下，傅里叶空间中的电磁波方程可以写为\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是冷等离子体介电张量。在 Stix 参数化中，对于 $\\boldsymbol{B}_{0} \\parallel \\hat{\\boldsymbol{z}}$，介电张量为\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -\\,i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix},\n$$\n其中 Stix 参数定义为\n$$\nS \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nD \\equiv \\sum_{s}\\frac{\\Omega_{s}}{\\omega}\\,\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nP \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2}},\n$$\n其中求和遍及等离子体中的所有粒子种类 $s$（电子和离子），$\\omega_{ps}^{2} \\equiv n_{s} q_{s}^{2}/(\\varepsilon_{0} m_{s})$ 是粒子种类的等离子体频率，$\\Omega_{s} \\equiv q_{s} B_{0}/m_{s}$ 是粒子种类的回旋频率。\n\n仅从平面波麦克斯韦方程组和上述冷等离子体张量结构出发，推导垂直传播模式的色散关系。识别出两种解耦的极化（寻常模和非常模），并获得每种模式下折射率平方 $n^{2}$ 的闭式表达式，该表达式仅用 Stix 参数 $S$、$D$ 和 $P$ 表示（不要在最终表达式中引入其他参数）。\n\n你的最终答案必须分别是寻常模和非常模的 $n^2$ 的解析表达式。无需进行数值计算。", "solution": "此推导的出发点是介质中电磁波的波动方程，在傅里葉空間中表示为：\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n这里，$\\boldsymbol{k}$ 是波矢，$\\boldsymbol{E}$ 是电场矢量，$\\omega$ 是角频率，$c$ 是真空中的光速，$\\boldsymbol{\\varepsilon}$ 是等离子体的介电张量。\n\n我们可以使用矢量恒等式 $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = (\\boldsymbol{A} \\cdot \\boldsymbol{C})\\boldsymbol{B} - (\\boldsymbol{A} \\cdot \\boldsymbol{B})\\boldsymbol{C}$ 来展开双重叉积。令 $\\boldsymbol{A} = \\boldsymbol{k}$，$\\boldsymbol{B} = \\boldsymbol{k}$ 和 $\\boldsymbol{C} = \\boldsymbol{E}$，波动方程变为：\n$$\n(\\boldsymbol{k} \\cdot \\boldsymbol{E})\\boldsymbol{k} - (\\boldsymbol{k} \\cdot \\boldsymbol{k})\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n问题指定了垂直传播，静磁场为 $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$，波矢为 $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$。因此，我们有 $\\boldsymbol{k} \\cdot \\boldsymbol{k} = k^{2}$ 和 $\\boldsymbol{k} \\cdot \\boldsymbol{E} = k E_{x}$。将这些代入波动方程得到：\n$$\n(k E_{x}) (k \\hat{\\boldsymbol{x}}) - k^{2}\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n我们引入折射率 $n$，定义为 $n^{2} \\equiv c^{2}k^{2}/\\omega^{2}$。将整个方程乘以 $c^{2}/\\omega^{2}$ 得到：\n$$\n\\frac{c^{2}}{\\omega^{2}} k^{2} E_{x} \\hat{\\boldsymbol{x}} - \\frac{c^{2}k^{2}}{\\omega^{2}}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n$$\nn^{2} E_{x} \\hat{\\boldsymbol{x}} - n^{2}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n这个矢量方程可以用矩阵形式表示。$n^{2} E_{x} \\hat{\\boldsymbol{x}}$ 项可以写成 $n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\cdot \\boldsymbol{E}$，其中 $\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}$ 是一个并矢积，由一个在 (1,1) 位置为1、其余位置为0的矩阵表示。$n^{2}\\boldsymbol{E}$ 项对应于 $n^{2}\\boldsymbol{I} \\cdot \\boldsymbol{E}$，其中 $\\boldsymbol{I}$ 是单位矩阵。方程变为：\n$$\n\\left[ \\boldsymbol{\\varepsilon} - n^{2}\\boldsymbol{I} + n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\right] \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n让我们构建括号内的矩阵。给定介电张量的 Stix 参数化形式：\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix}\n$$\n其他矩阵是：\n$$\nn^{2}\\boldsymbol{I} = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix}, \\quad n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n结合这些项，波动方程中的矩阵（我们称之为 $\\boldsymbol{M}$）是：\n$$\n\\boldsymbol{M} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S  0 \\\\ 0  0  P \\end{pmatrix} - \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix} + \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix}\n$$\n齐次线性方程组 $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$ 对电场 $\\boldsymbol{E}$ 有非平凡解的充分必要条件是矩阵 $\\boldsymbol{M}$ 的行列式为零：\n$$\n\\det(\\boldsymbol{M}) = 0\n$$\n$$\n\\det \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix} = 0\n$$\n沿第三行展开行列式得到：\n$$\n(P - n^{2}) \\det \\begin{pmatrix} S  -i D \\\\ i D  S-n^{2} \\end{pmatrix} = 0\n$$\n$$\n(P - n^{2}) \\left[ S(S-n^{2}) - (-i D)(i D) \\right] = 0\n$$\n$$\n(P - n^{2}) (S^{2} - S n^{2} - D^{2}) = 0\n$$\n这个关于垂直传播的一般色散关系可以分解为两个独立的条件，对应着两种不同的波模。\n\n模式1：第一种可能性是第一个因子为零：\n$$\nP - n^{2} = 0 \\implies n^{2} = P\n$$\n为了理解此模式的性质，我们将 $n^{2} = P$ 代回矩阵方程 $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$ 中以考察电场的极化：\n$$\n\\begin{pmatrix} S  -i D  0 \\\\ i D  S-P  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} E_{x} \\\\ E_{y} \\\\ E_{z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第三行 $0 \\cdot E_{z} = 0$ 意味着 $E_{z}$ 可以不为零。左上角的 $2 \\times 2$ 子块给出了关于 $E_{x}$ 和 $E_{y}$ 的方程组。该子矩阵的行列式为 $S(S-P) - (-i D)(i D) = S(S-P) - D^{2}$。假设此行列式不为零（通常情况下确实如此），则该子系统的唯一解是 $E_{x} = 0$ 和 $E_{y} = 0$。因此，该模式的电场矢量为 $\\boldsymbol{E} = (0, 0, E_{z})$，平行于背景磁场 $\\boldsymbol{B}_{0}$。根据定义，此模式为**寻常模（O-mode）**。其折射率仅由 Stix 参数 $P$ 决定。\n\n模式2：第二种可能性是第二个因子为零：\n$$\nS^{2} - S n^{2} - D^{2} = 0\n$$\n解出 $n^{2}$ 得到：\n$$\nS n^{2} = S^{2} - D^{2} \\implies n^{2} = \\frac{S^{2} - D^{2}}{S}\n$$\n为了找到极化，我们再次考察矩阵方程，并假设此模式与第一种不同（即 $P-n^{2} \\neq 0$）。方程 $(P-n^{2})E_{z} = 0$ 现在要求 $E_{z}=0$。这意味着电场被限制在垂直于 $\\boldsymbol{B}_{0}$ 的平面内，即 $\\boldsymbol{E} \\perp \\boldsymbol{B}_{0}$。电场矢量为 $\\boldsymbol{E} = (E_{x}, E_{y}, 0)$。左上角的 $2 \\times 2$ 方程组为：\n$$\nS E_{x} - i D E_{y} = 0\n$$\n$$\ni D E_{x} + (S-n^{2}) E_{y} = 0\n$$\n由于根据此模式的条件，这个 $2 \\times 2$ 系统的行列式为零，因此这两个方程是线性相关的。我们可以用第一个方程来找到联系电场分量的极化比：$E_{y} = \\frac{S}{iD} E_{x} = -i \\frac{S}{D} E_{x}$。电场在垂直于 $\\boldsymbol{B}_0$ 的平面内呈椭圆极化。根据定义，此模式为**非常模（X-mode）**。其折射率取决于 Stix 参数 $S$ 和 $D$。\n\n总而言之，两种垂直传播模式及其折射率平方分别为：\n$1$. 寻常模 (O-mode):\n   $$ n^{2}_{\\text{O}} = P $$\n$2$. 非常模 (X-mode):\n   $$ n^{2}_{\\text{X}} = \\frac{S^{2} - D^{2}}{S} $$\n这些就是所要求的用 Stix 参数表示的闭式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP  \\frac{S^{2} - D^{2}}{S}\n\\end{pmatrix}\n}\n$$", "id": "3712630"}, {"introduction": "在推导出O波和X波的存在之后，一个实际问题随之而来：我们如何在实验中有效地激发其中一种特定的模式？本练习 [@problem_id:324569] 探讨了在等离子体边界进行偏振匹配的关键概念。它阐明了入射波电场与背景磁场的相对方向，如何决定了将能量耦合到所需O波或X波的效率。", "problem": "在一个反射计实验中，一束微波从真空区域（$z  0$）入射到一个占据半空间 $z \\ge 0$ 的冷、均匀、磁化等离子体中。该微波束沿着z轴传播（$\\boldsymbol{k} = k\\hat{\\boldsymbol{z}}$）。静态均匀磁场 $\\boldsymbol{B}_0$ 的方向垂直于传播方向，完全位于x-y平面内，并与x轴成 $\\phi_B$ 角。\n\n入射微波束是线性偏振的。其电场矢量 $\\boldsymbol{E}_{\\text{inc}}$ 也位于x-y平面内，与x轴成 $\\alpha$ 角。\n\n在真空-等离子体界面（$z=0$）处，入射波功率耦合到垂直传播的两种基本电磁模式中：寻常波（O模）和非寻常波（X模）。在此构型下：\n1.  O模是线性偏振的，其电场矢量平行于背景磁场 $\\boldsymbol{B}_0$。\n2.  X模在界面处也是线性偏振的，其电场矢量同时垂直于背景磁场 $\\boldsymbol{B}_0$ 和传播方向 $\\boldsymbol{k}$。\n\n假设条件满足X模能传播到等离子体中（即，发射频率高于相关的截止频率），请推导耦合到X模的入射波功率的比例的表达式。答案请用角度 $\\alpha$ 和 $\\phi_B$ 表示。", "solution": "1. 在$xy$平面内，与x轴成$\\alpha$角的入射电场为\n   $$\\boldsymbol{E}_{\\text{inc}}=E_0(\\cos\\alpha\\,\\hat{\\boldsymbol{x}}+\\sin\\alpha\\,\\hat{\\boldsymbol{y}})$$.\n2. 与x轴成$\\phi_B$角的背景磁场单位矢量为\n   $$\\hat{\\boldsymbol{B}}_0=\\cos\\phi_B\\,\\hat{\\boldsymbol{x}}+\\sin\\phi_B\\,\\hat{\\boldsymbol{y}})$$.\n3. 对于垂直传播（$\\boldsymbol{k}=k\\hat{\\boldsymbol{z}}$），X模的偏振方向为\n   $$\\hat{\\boldsymbol{e}}_X=\\frac{\\hat{\\boldsymbol{k}}\\times\\hat{\\boldsymbol{B}}_0}{|\\hat{\\boldsymbol{k}}\\times\\hat{\\boldsymbol{B}}_0|} = \\hat{\\boldsymbol{z}} \\times (\\cos\\phi_B\\,\\hat{\\boldsymbol{x}} + \\sin\\phi_B\\,\\hat{\\boldsymbol{y}}) = -\\sin\\phi_B\\,\\hat{\\boldsymbol{x}} + \\cos\\phi_B\\,\\hat{\\boldsymbol{y}})$$.\n4. 将 $\\boldsymbol{E}_{\\text{inc}}$ 投影到 $\\hat{\\boldsymbol{e}}_X$ 上：\n   $$\\boldsymbol{E}_{\\text{inc}}\\cdot\\hat{\\boldsymbol{e}}_X = E_0\\bigl(-\\sin\\phi_B\\cos\\alpha+\\cos\\phi_B\\sin\\alpha\\bigr) = E_0\\sin(\\alpha-\\phi_B)$$.\n5. X模中的功率比例是投影的平方再用 $E_0^2$ 归一化：\n   $$\\frac{P_X}{P_{\\text{inc}}} =\\frac{|\\boldsymbol{E}_{\\text{inc}}\\cdot\\hat{\\boldsymbol{e}}_X|^2}{|\\boldsymbol{E}_{\\text{inc}}|^2} =\\sin^2(\\alpha-\\phi_B)$$.", "answer": "$$\\boxed{\\sin^2(\\alpha-\\phi_B)}$$", "id": "324569"}, {"introduction": "标准的冷等离子体模型是一种理想化情况，在聚变等离子体的高功率场景下需要修正。本练习 [@problem_id:3712635] 引入了一个更贴近现实的场景，包含了高功率波场引起的弱相对论效应。通过数值计算这些修正，您将探索在聚变加热等应用中，波的截止和共振等特性如何被改变，从而将理论模型与计算物理实践联系起来。", "problem": "考虑与核聚变相关的磁化等离子体中，电磁波在垂直于均匀静磁场方向上的传播。假设等离子体是均匀的，由电子和单一离子（氘）组成，其特征参数为：数密度 $n_e = n_i$，电荷 $q_e = -e$, $q_i = +e$，电子静止质量 $m_e$，离子质量 $m_i = 2 m_p$，光速 $c$，真空介电常数 $\\varepsilon_0$，以及均匀磁场强度 $B_0$。波以角频率 $\\omega$ 传播，电场振幅为 $E_0$。\n\n从麦克斯韦方程组和均匀磁化等离子体中多组分的冷流体模型（线性化的洛伦兹力和连续性方程）的基本原理出发，完成以下任务：\n\n- 推导垂直传播（$\\boldsymbol{k} \\perp \\boldsymbol{B}_0$）时的极化和介电响应。引入弱相对论性的高功率修正，将电子质量视为有效质量 $m_e' = \\gamma m_e$，其中 $\\gamma$ 是由波中颤动引起的常数洛伦兹因子，$\\gamma = \\sqrt{1 + a_0^2}$ 且 $a_0 = \\dfrac{|q_e| E_0}{m_e c \\, \\omega}$。假设离子质量保持非相对论性。\n- 使用冷等离子体介电张量，表示垂直传播的模式折射率。将各组分的等离子体频率和回旋频率定义为\n$$\\omega_{ps}^2 = \\dfrac{n_s q_s^2}{\\varepsilon_0 m_s'}, \\quad \\Omega_s = \\dfrac{q_s B_0}{m_s'},$$\n其中对于电子，$m_e' = \\gamma m_e$；对于离子，$m_i' = m_i$。定义 Stix 参数\n$$R = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)},$$\n$$S = \\dfrac{R + L}{2}, \\quad P = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega^2}。$$\n证明寻常模（O-波）和非寻常模（X-波）的垂直传播折射率 $N^2 = \\dfrac{c^2 k^2}{\\omega^2}$ 满足\n$$N_\\mathrm{O}^2 = P, \\quad N_\\mathrm{X}^2 = \\dfrac{R L}{S}。$$\n从物理上解释高功率修正（通过 $\\gamma$）如何通过 $m_e'$ 改变截止和共振位置，从而使 $\\omega_{pe}$ 和 $\\Omega_e$ 发生偏移。\n\n你的程序必须实现这些公式，并为指定的测试套件计算 $N_\\mathrm{O}^2$ 和 $N_\\mathrm{X}^2$。所有输入均使用国际单位制（SI）。输出必须是无量纲的，并以浮点数形式报告。\n\n测试套件参数集，每个是一个元组 $(n_e, B_0, \\omega, E_0)$：\n\n1. 一般传播情况：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.10 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 1.0 \\times 10^{6} \\, \\mathrm{V/m}$。\n2. 接近寻常模截止（仅考虑电子的名义值；计算中使用双组分冷等离子体模型）：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 3.984 \\times 10^{11} \\, \\mathrm{rad/s}$, $E_0 = 0 \\, \\mathrm{V/m}$。\n3. 接近上混杂共振（避免精确共振）：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.125 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 0 \\, \\mathrm{V/m}$。\n4. 弱相对论性振幅情况：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$, $B_0 = 6.0 \\, \\mathrm{T}$, $\\omega = 1.20 \\times 10^{12} \\, \\mathrm{rad/s}$, $E_0 = 5.0 \\times 10^{6} \\, \\mathrm{V/m}$。\n\n你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中的值按以下顺序排列\n$$[N_\\mathrm{O}^{2,(1)}, N_\\mathrm{X}^{2,(1)}, N_\\mathrm{O}^{2,(2)}, N_\\mathrm{X}^{2,(2)}, N_\\mathrm{O}^{2,(3)}, N_\\mathrm{X}^{2,(3)}, N_\\mathrm{O}^{2,(4)}, N_\\mathrm{X}^{2,(4)}],$$\n其中上标指测试用例的索引。所有输出均报告为无量纲浮点数。", "solution": "该问题要求推导在冷磁化等离子体中垂直于静磁场传播的寻常模（O-波）和非寻常模（X-波）的折射率，并包含弱相对论性的高功率修正。然后，我们将实现这些公式，以计算给定参数集的折射率。\n\n分析始于控制系统的基本方程：麦克斯韦方程组和冷等离子体流体的线性化运动方程。\n\n在无源介质中，麦克斯韦的旋度方程为：\n$$\n\\nabla \\times \\boldsymbol{E} = - \\dfrac{\\partial \\boldsymbol{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\boldsymbol{B} = \\mu_0 \\boldsymbol{J} + \\mu_0 \\varepsilon_0 \\dfrac{\\partial \\boldsymbol{E}}{\\partial t}\n$$\n等离子体由电子（组分 $s=e$）和氘离子（组分 $s=i$）组成。每个组分对电磁场的响应由冷等离子体（初始热速度为零）的线性化洛伦兹力方程描述：\n$$\nm_s' \\frac{\\partial \\boldsymbol{v}_{s1}}{\\partial t} = q_s (\\boldsymbol{E}_1 + \\boldsymbol{v}_{s1} \\times \\boldsymbol{B}_0)\n$$\n这里，$\\boldsymbol{v}_{s1}$ 和 $\\boldsymbol{E}_1$ 分别是一阶微扰流体速度和电场，$\\boldsymbol{B}_0$ 是均匀的静背景磁场。质量 $m_s'$ 是每个组分的有效质量。根据题目要求，我们通过将电子质量设为 $m_e' = \\gamma m_e$ 来包含对电子的高功率修正，其中 $\\gamma = \\sqrt{1 + a_0^2}$ 且 $a_0 = |q_e| E_0 / (m_e c \\omega)$。对于离子，我们假设其处于非相对论极限，因此 $m_i' = m_i$。\n\n我们假设所有一阶量都以 $e^{i(\\boldsymbol{k} \\cdot \\boldsymbol{r} - \\omega t)}$ 的平面波形式变化。这使我们能够进行替换 $\\partial/\\partial t \\to -i\\omega$ 和 $\\nabla \\to i\\boldsymbol{k}$。运动方程变为：\n$$\n-i\\omega m_s' \\boldsymbol{v}_{s1} = q_s (\\boldsymbol{E}_1 + \\boldsymbol{v}_{s1} \\times \\boldsymbol{B}_0)\n$$\n这个方程可以求解出速度微扰 $\\boldsymbol{v}_{s1}$ 与电场 $\\boldsymbol{E}_1$ 的关系。总等离子体电流密度是各组分贡献的总和：$\\boldsymbol{J}_1 = \\sum_s n_s q_s \\boldsymbol{v}_{s1}$。这通过关系式 $\\boldsymbol{J}_1 = \\boldsymbol{\\sigma} \\cdot \\boldsymbol{E}_1$ 定义了等离子体电导率张量 $\\boldsymbol{\\sigma}$。介电张量 $\\boldsymbol{\\epsilon}$ 则由下式给出：\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\boldsymbol{I} + \\frac{i}{\\omega} \\boldsymbol{\\sigma}\n$$\n不失一般性，设静磁场沿z轴方向，$\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$。介电张量具有以下形式：\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n分量 $S$、$D$ 和 $P$ 用等离子体参数表示。按照惯例，它们被定义为 $S = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}$，$D = \\sum_s \\frac{\\Omega_s \\omega_{ps}^2}{\\omega(\\omega^2 - \\Omega_s^2)}$ 和 $P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}$。问题将 Stix 参数 $R$ 和 $L$ 定义为：\n$$\nR = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)}\n$$\n其中组分等离子体频率的平方为 $\\omega_{ps}^2 = n_s q_s^2 / (\\varepsilon_0 m_s')$，组分回旋频率为 $\\Omega_s = q_s B_0 / m_s'$。这些参数通过 $S = (R+L)/2$ 和 $D = (R-L)/2$ 相互关联。\n\n现在，我们构建波动方程。将平面波形式代入麦克斯韦方程组，得到：\n$$\ni \\boldsymbol{k} \\times \\boldsymbol{E}_1 = i\\omega \\boldsymbol{B}_1\n$$\n$$\ni \\boldsymbol{k} \\times \\boldsymbol{B}_1 = \\mu_0 \\boldsymbol{J}_1 - i\\omega \\mu_0 \\varepsilon_0 \\boldsymbol{E}_1 = -i\\omega \\mu_0 \\left( \\frac{i}{\\omega} \\boldsymbol{\\sigma} + \\varepsilon_0 \\boldsymbol{I} \\right) \\cdot \\boldsymbol{E}_1 = -i\\frac{\\omega}{c^2 \\varepsilon_0} \\boldsymbol{\\epsilon} \\cdot \\boldsymbol{E}_1\n$$\n结合这两个方程，得到一般波动方程：\n$$\n\\boldsymbol{k} \\times (\\boldsymbol{k} \\times \\boldsymbol{E}_1) + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\cdot \\boldsymbol{E}_1 = 0\n$$\n我们考虑垂直传播，所以 $\\boldsymbol{k} \\perp \\boldsymbol{B}_0$。我们选择坐标系，使得 $\\boldsymbol{k} = k \\hat{\\boldsymbol{x}}$ 和 $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$。波动方程可以写成矩阵形式。设 $N = ck/\\omega$ 为折射率。张量算符 $\\boldsymbol{k} \\times (\\boldsymbol{k} \\times \\cdot)$ 变为 $\\boldsymbol{k}(\\boldsymbol{k} \\cdot \\cdot) - k^2 \\boldsymbol{I}$。波动方程为 $(\\frac{\\omega^2}{c^2} \\boldsymbol{N}\\boldsymbol{N} - N^2 \\frac{\\omega^2}{c^2} \\boldsymbol{I} + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0}) \\cdot \\boldsymbol{E}_1 = 0$，简化为：\n$$\n\\left( \\boldsymbol{N}\\boldsymbol{N} - N^2 \\boldsymbol{I} + \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\right) \\cdot \\boldsymbol{E}_1 = 0\n$$\n当 $\\boldsymbol{k} = k \\hat{\\boldsymbol{x}}$ 时，张量 $\\boldsymbol{N}\\boldsymbol{N}$ 只有一个非零分量 $N_x N_x = N^2$。矩阵方程变为：\n$$\n\\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix}\n\\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = 0\n$$\n为了存在非平凡解，矩阵的行列式必须为零：\n$$\n\\det \\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix} = (P - N^2) \\left[ S(S - N^2) - (-iD)(iD) \\right] = 0\n$$\n$$\n(P - N^2) [S(S - N^2) - D^2] = 0\n$$\n这个方程解耦为两种独立的模式：\n\n1.  **寻常模（O-波）：** 第一个解由第一个因子给出：\n    $$ P - N^2 = 0 \\implies N_\\mathrm{O}^2 = P $$\n    对于这种模式，矩阵方程意味着 $E_x = E_y = 0$，而 $E_z$ 可以非零。波的电场平行于背景磁场 $\\boldsymbol{B}_0$ 极化。因此，洛伦兹力项 $\\boldsymbol{v}_{s1} \\times \\boldsymbol{B}_0$ 不影响电子沿 $\\boldsymbol{B}_0$ 的运动，波的行为就像在非磁化等离子体中一样。\n\n2.  **非寻常模（X-波）：** 第二个解由第二个因子给出：\n    $$ S(S - N^2) - D^2 = 0 $$\n    $$ S N^2 = S^2 - D^2 = (S-D)(S+D) $$\n    利用关系式 $R = S+D$ 和 $L = S-D$，我们发现：\n    $$ S N^2 = LR \\implies N_\\mathrm{X}^2 = \\frac{RL}{S} $$\n    对于这种模式，$E_z=0$，电场在垂直于 $\\boldsymbol{B}_0$ 的平面内极化。这种波的传播受磁场强烈影响。\n\n**高功率修正的物理效应：**\n相对论质量修正 $m_e' = \\gamma m_e$ 直接改变了电子等离子体频率和电子回旋频率：\n$$\n\\omega_{pe}'^2 = \\frac{n_e e^2}{\\varepsilon_0 m_e'} = \\frac{1}{\\gamma} \\frac{n_e e^2}{\\varepsilon_0 m_e} = \\frac{\\omega_{pe}^2}{\\gamma}\n$$\n$$\n\\Omega_e' = \\frac{-e B_0}{m_e'} = \\frac{1}{\\gamma} \\frac{-e B_0}{m_e} = \\frac{\\Omega_e}{\\gamma}\n$$\n由于 $\\gamma = \\sqrt{1 + a_0^2} \\ge 1$，有效电子质量随波功率（$E_0^2$）的增加而增加。这种增加的惯性导致电子对波场的响应更加迟缓。因此，它们的自然等离子体振荡频率（$\\omega_{pe}'$）和在磁场中的回旋频率（$|\\Omega_e'|$）都降低了。\n\n截止（$N^2=0$）和共振（$N^2 \\to \\infty$）是波传播的关键特征。它们由特征频率 $\\omega_{pe}'$ 和 $\\Omega_e'$ 决定。\n-   **O-模截止：** 发生在 $N_\\mathrm{O}^2 = P = 0$。忽略微小的离子贡献，条件为 $1 - \\omega_{pe}'^2/\\omega^2 = 0 \\implies \\omega = \\omega_{pe}' = \\omega_{pe}/\\sqrt{\\gamma}$。高功率波（更大的 $\\gamma$）降低了O-模的截止频率。\n-   **X-模共振（上混杂共振）：** 发生在 $N_\\mathrm{X}^2 \\to \\infty$，即当 $S=0$ 时。忽略离子，条件 $S = 1 - \\frac{\\omega_{pe}'^2}{\\omega^2 - \\Omega_e'^2} = 0$ 给出了上混杂频率 $\\omega_{UH}^2 = \\omega_{pe}'^2 + \\Omega_e'^2$。代入相对论修正，我们得到 $\\omega_{UH}^2 = \\frac{\\omega_{pe}^2}{\\gamma} + \\frac{\\Omega_e^2}{\\gamma^2}$。共振频率因高功率效应而向下偏移。\n-   **X-模截止：** 发生在 $N_\\mathrm{X}^2 = 0$，意味着 $R=0$ 或 $L=0$。满足这些条件的频率 $\\omega_R$ 和 $\\omega_L$ 也依赖于 $\\omega_{pe}'$ 和 $\\Omega_e'$，因此会因相对论质量增加而向较低的值偏移。\n\n总而言之，高功率相对论修正使得电子的有效质量变重，降低了它们的特征频率，并将波的截止和共振位置移向更低的频率。这在高功率等离子体加热方案如电子回旋共振加热（ECRH）中是一个关键的非线性效应。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ordinary and extraordinary mode refractive indices for perpendicular\n    propagation in a magnetized plasma, including a weakly relativistic correction.\n    \"\"\"\n    # Physical Constants in SI units\n    e = 1.602176634e-19  # Elementary charge (C)\n    m_e = 9.1093837015e-31 # Electron rest mass (kg)\n    m_p = 1.67262192369e-27 # Proton mass (kg)\n    c = 299792458.0      # Speed of light (m/s)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    \n    # Ion properties (Deuterium)\n    q_i = e\n    m_i = 2 * m_p\n\n    # Test cases: (n_e [m^-3], B_0 [T], omega [rad/s], E_0 [V/m])\n    test_cases = [\n        (5.0e19, 6.0, 1.10e12, 1.0e6),\n        (5.0e19, 6.0, 3.984e11, 0.0),\n        (5.0e19, 6.0, 1.125e12, 0.0),\n        (5.0e19, 6.0, 1.20e12, 5.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n_e, B0, w, E0 = case\n        \n        # Plasma density is the same for electrons and ions\n        n_i = n_e\n\n        # --- High-Power Correction ---\n        # Calculate normalized vector potential a0 and Lorentz factor gamma\n        if E0 == 0.0:\n            gamma = 1.0\n        else:\n            # a0 = |q_e| * E0 / (m_e * c * w)\n            a0 = (e * E0) / (m_e * c * w)\n            gamma = np.sqrt(1 + a0**2)\n            \n        # Effective electron mass\n        me_eff = gamma * m_e\n        # Ion mass remains non-relativistic\n        mi_eff = m_i\n\n        # --- Plasma Species Definition ---\n        # List of dicts to hold species properties\n        species_list = [\n            {'q': -e, 'm': me_eff, 'n': n_e, 'name': 'electron'},\n            {'q': q_i, 'm': mi_eff, 'n': n_i, 'name': 'ion'}\n        ]\n\n        # --- Stix Parameter Calculation ---\n        # Initialize sums for R, L, P\n        sum_R = 0.0\n        sum_L = 0.0\n        sum_P = 0.0\n\n        for s in species_list:\n            # Species plasma frequency squared: w_ps^2 = n*q^2 / (eps0 * m)\n            w_ps2 = (s['n'] * s['q']**2) / (eps0 * s['m'])\n\n            # Species cyclotron frequency: Omega_s = q*B0 / m\n            Omega_s = (s['q'] * B0) / s['m']\n\n            # Accumulate terms for Stix parameters\n            # Check for resonance conditions to avoid division by zero, though problem inputs avoid this.\n            if w - Omega_s == 0 or w + Omega_s == 0:\n                # This case indicates a resonance not handled by cold plasma theory\n                # We can set results to NaN or handle as per a more advanced model.\n                # For this problem, inputs are chosen to avoid this.\n                sum_L = np.nan\n                sum_R = np.nan\n                break\n\n            sum_R += w_ps2 / (w * (w + Omega_s))\n            sum_L += w_ps2 / (w * (w - Omega_s))\n            sum_P += w_ps2 / (w**2)\n        \n        # Final Stix parameters\n        R = 1.0 - sum_R\n        L = 1.0 - sum_L\n        P = 1.0 - sum_P\n        S = (R + L) / 2.0\n\n        # --- Refractive Index Calculation ---\n        # Ordinary mode refractive index squared\n        # N_O^2 = P\n        N2_O = P\n\n        # Extraordinary mode refractive index squared\n        # N_X^2 = R*L / S\n        # Check for upper hybrid resonance where S=0\n        if S == 0.0:\n            N2_X = np.inf\n        else:\n            N2_X = (R * L) / S\n\n        results.extend([N2_O, N2_X])\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3712635"}]}