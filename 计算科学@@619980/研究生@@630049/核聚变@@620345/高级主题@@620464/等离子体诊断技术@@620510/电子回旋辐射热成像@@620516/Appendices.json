{"hands_on_practices": [{"introduction": "ECE热成像的整个原理建立在局部磁场与发射辐射频率之间的直接关系之上。这项练习将带领你回到第一性原理，从洛伦兹力定律推导出非相对论性的电子回旋频率。这为你深入理解为何ECE能够作为一种空间分辨的诊断工具建立了坚实的物理直觉。[@problem_id:3697423]", "problem": "一个轴对称托卡马克在轴上运行，其环向磁场强度为 $B = 5\\,\\mathrm{T}$。在电子回旋发射（ECE）测温法中，观测到的是回旋电子在其电子回旋运动的整数次谐波处发射的辐射。从洛伦兹力定律和电子在匀强磁场中的非相对论性运动方程出发，推导非相对论性电子回旋角频率，并用它来确定二次谐波的发射频率，记为 $f_{2}$。假设对于聚变等离子体中的热电子，非相对论性极限是适用的，其中 $T_{e} \\ll m_{e}c^{2}$。使用以下常数：元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$ 和电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n\n计算当 $B = 5\\,\\mathrm{T}$ 时 $f_{2}$ 的数值。用吉赫兹表示最终频率，并将答案四舍五入到四位有效数字。然后，简要评论该频率是否位于毫米波波段，并考虑典型的传播和仪器实现情况，评论其在托卡马克中用于基于ECE的毫米波诊断的适用性。你的最终答案必须是一个数字。", "solution": "问题陈述经评估是有效的，因为它具有科学依据、良定且客观。它提供了一个基于电磁学和等离子体物理学基本原理的标准物理问题，并为求得唯一解提供了所有必要的数据。\n\n我们从洛伦兹力定律开始推导，该定律描述了带电粒子在电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 中以速度 $\\mathbf{v}$ 运动时所受的力 $\\mathbf{F}$。对于电荷为 $q = -e$ 的电子，该力由下式给出：\n$$ \\mathbf{F} = -e(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) $$\n电子的运动遵循牛顿第二定律，$\\mathbf{F} = m_e \\mathbf{a} = m_e \\frac{d\\mathbf{v}}{dt}$，其中 $m_e$ 是电子质量，$\\mathbf{a}$ 是其加速度。\n\n在匀强磁场 $\\mathbf{B}$ 且无电场（$\\mathbf{E} = \\mathbf{0}$）的情况下，电子的运动方程变为：\n$$ m_e \\frac{d\\mathbf{v}}{dt} = -e(\\mathbf{v} \\times \\mathbf{B}) $$\n为简单起见，我们将磁场与 $z$ 轴对齐，使得 $\\mathbf{B} = B\\hat{\\mathbf{z}}$。速度矢量为 $\\mathbf{v} = v_x\\hat{\\mathbf{x}} + v_y\\hat{\\mathbf{y}} + v_z\\hat{\\mathbf{z}}$。那么，叉积 $\\mathbf{v} \\times \\mathbf{B}$ 为：\n$$ \\mathbf{v} \\times \\mathbf{B} = (v_x\\hat{\\mathbf{x}} + v_y\\hat{\\mathbf{y}} + v_z\\hat{\\mathbf{z}}) \\times (B\\hat{\\mathbf{z}}) = B(v_y\\hat{\\mathbf{x}} - v_x\\hat{\\mathbf{y}}) $$\n将此代入运动方程并分解为笛卡尔分量，得到：\n\\begin{align*} m_e \\frac{dv_x}{dt} = -eBv_y \\\\ m_e \\frac{dv_y}{dt} = eBv_x \\\\ m_e \\frac{dv_z}{dt} = 0 \\end{align*}\n第三个方程意味着平行于磁场的速度分量 $v_z$ 是恒定的。沿磁场方向的运动没有加速度。\n\n前两个方程描述了在垂直于磁场的平面内的运动。它们构成了一个耦合的一阶线性微分方程组。我们可以通过对第一个方程关于时间求导来解耦它们：\n$$ m_e \\frac{d^2v_x}{dt^2} = -eB\\frac{dv_y}{dt} $$\n代入第二个方程中 $\\frac{dv_y}{dt}$ 的表达式，得到：\n$$ m_e \\frac{d^2v_x}{dt^2} = -eB \\left(\\frac{eBv_x}{m_e}\\right) = -\\frac{(eB)^2}{m_e}v_x $$\n重新整理该方程，我们得到简谐振子方程的标准形式：\n$$ \\frac{d^2v_x}{dt^2} + \\left(\\frac{eB}{m_e}\\right)^2 v_x = 0 $$\n这种振荡的角频率就是非相对论性电子回旋角频率 $\\omega_{ce}$：\n$$ \\omega_{ce} = \\frac{eB}{m_e} $$\n此处，$e$ 表示元电荷的大小。这是电子在垂直于磁场的平面内以圆形轨道回旋的角频率。发射的辐射发生在基波回旋频率 $f_{ce}$ 的整数倍（谐波）处。基波频率与角频率的关系为 $f_{ce} = \\frac{\\omega_{ce}}{2\\pi}$。\n$$ f_{ce} = \\frac{eB}{2\\pi m_e} $$\n题目要求的是二次谐波的发射频率 $f_2$，它是基波频率的两倍：\n$$ f_{2} = 2f_{ce} = 2 \\left(\\frac{eB}{2\\pi m_e}\\right) = \\frac{eB}{\\pi m_e} $$\n现在我们使用给定的常数和 $B = 5\\,\\mathrm{T}$ 的磁场来计算 $f_{2}$ 的数值：\n-   $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n-   $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n-   $B = 5\\,\\mathrm{T}$\n\n将这些值代入 $f_2$ 的表达式中：\n$$ f_2 = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C})(5\\,\\mathrm{T})}{\\pi (9.1093837015 \\times 10^{-31}\\,\\mathrm{kg})} $$\n$$ f_2 \\approx \\frac{8.01088317 \\times 10^{-19}}{2.861780447 \\times 10^{-30}}\\,\\mathrm{Hz} \\approx 2.799235 \\times 10^{11}\\,\\mathrm{Hz} $$\n题目要求频率以吉赫兹（$1\\,\\mathrm{GHz} = 10^9\\,\\mathrm{Hz}$）表示，并四舍五入到四位有效数字。\n$$ f_2 \\approx 279.9235\\,\\mathrm{GHz} $$\n$$ f_2 \\approx 279.9\\,\\mathrm{GHz} $$\n\n问题还要求进行简要评论。\n计算出的频率 $f_2 = 279.9\\,\\mathrm{GHz}$ 位于电磁波谱的毫米波段，该波段通常定义为从 $30\\,\\mathrm{GHz}$ 到 $300\\,\\mathrm{GHz}$（波长从 $10\\,\\mathrm{mm}$ 到 $1\\,\\mathrm{mm}$）。这个频率确实非常适合用于托卡马克中基于ECE的诊断。主要原因如下：\n1.  **等离子体传播**：对于典型的高密度托卡马克等离子体，二次谐波ECE频率通常高于等离子体截止频率（如等离子体频率和右旋截止频率）。这使得辐射能够从稠密的等离子体芯部传播到外部天线，而不会被除了回旋共振本身之外的等离子体共振现象所反射或吸收。\n2.  **空间局域化**：托卡马克中的环向磁场在空间上是变化的，近似为 $B \\propto 1/R$，其中 $R$ 是大半径。由于ECE频率与 $B$ 成正比，因此发射频率与等离子体中的径向位置之间存在一一对应关系。通过测量特定频率（例如 $279.9\\,\\mathrm{GHz}$）下的辐射功率，可以确定相应唯一空间位置（此处为磁轴，其中 $B=5\\,\\mathrm{T}$）的电子温度。\n3.  **仪器技术**：用于产生、传输和探测毫米波辐射的技术已经成熟且可靠。诸如准光传输线、外差辐射计和固态探测器等组件易于获得，从而能够构建具有优异灵敏度和时间分辨率的高性能ECE诊断系统。", "answer": "$$ \\boxed{279.9} $$", "id": "3697423"}, {"introduction": "理解了电子回旋辐射的物理原理之后，下一步自然是了解用于测量它的仪器。本练习模拟了使用热负载和冷负载校准外差辐射计的基本实验步骤。通过计算系统噪声温度和最小可探测温度涨落，你将对限制ECE测量精度的因素获得一个实践性的理解。[@problem_id:3697448]", "problem": "在高场聚变装置上，一个毫米波电子回旋发射（ECE）热成像诊断系统使用一个外差辐射计通道，该通道观测电子回旋共振附近的二次谐波非寻常波。该接收机通过实验台上的热/冷负载定标和放电过程中的参数进行表征，具体如下。一个温度为 $T_{hot} = 295 \\,\\mathrm{K}$ 的平面黑体热负载和一个温度为 $T_{cold} = 77 \\,\\mathrm{K}$ 的液氮冷却冷负载依次置于辐射计输入端。通过平方律检波器测得的辐射计输出功率分别为 $P_{hot} = 2.022 \\times 10^{-3} \\,\\mathrm{W}$ 和 $P_{cold} = 2.000 \\times 10^{-3} \\,\\mathrm{W}$。中频（IF）链路的有效噪声带宽为 $B = 1.25 \\times 10^{9} \\,\\mathrm{Hz}$，通道的采样（积分）时间为 $\\tau = 1.00 \\times 10^{-5} \\,\\mathrm{s}$。放电过程中的前向光学系统沿视线的传输效率为 $\\eta_{t} = 0.92$，收集的模式份额（包括偏振和光学耦合）为 $\\kappa = 0.85$，发射层的局部光学深度为 $\\tau_{opt} = 2.00$。假设瑞利-金斯极限对所有给定的温度和频率均有效。\n\n仅从瑞利-金斯极限中热辐射的定义、接收机的线性度以及平方律检测的标准统计特性出发，首先利用热/冷负载测量值确定系统噪声温度 $T_{sys}$。然后，基于辐射计方程，通过乘积 $\\alpha = \\eta_{t} \\,\\kappa \\,\\left(1 - \\exp(-\\tau_{opt})\\right)$ 将输入亮温度涨落与电子温度联系起来，预测该通道的最小可探测电子温度涨落 $\\delta T_{e,\\min}$。\n\n以 $\\mathrm{K}$ 为单位表示 $T_{sys}$ 和 $\\delta T_{e,\\min}$。将两个最终数值结果四舍五入到三位有效数字。", "solution": "该问题要求基于所提供的定标和运行参数，为一个电子回旋发射（ECE）辐射计通道确定系统噪声温度 $T_{sys}$ 和最小可探测电子温度涨落 $\\delta T_{e,\\min}$。\n\n首先，需要对问题陈述进行验证。\n从问题中提取的已知条件如下：\n热负载温度：$T_{hot} = 295 \\,\\mathrm{K}$\n冷负载温度：$T_{cold} = 77 \\,\\mathrm{K}$\n辐射计输出功率（热负载）：$P_{hot} = 2.022 \\times 10^{-3} \\,\\mathrm{W}$\n辐射计输出功率（冷负载）：$P_{cold} = 2.000 \\times 10^{-3} \\,\\mathrm{W}$\n中频（IF）噪声带宽：$B = 1.25 \\times 10^{9} \\,\\mathrm{Hz}$\n采样（积分）时间：$\\tau = 1.00 \\times 10^{-5} \\,\\mathrm{s}$\n前向光学系统传输效率：$\\eta_{t} = 0.92$\n收集的模式份额（耦合效率）：$\\kappa = 0.85$\n局部光学深度：$\\tau_{opt} = 2.00$\n假设：瑞利-金斯极限成立，接收机是线性的，并且平方律检测的标准统计特性适用。\n该问题在科学上基于辐射测量学和等离子体诊断的原理。所有提供的值对于聚变实验中的ECE诊断都是物理上现实的。该问题是适定的，提供了计算所要求量所需的所有必要信息，并且不包含内部矛盾或歧义。因此，该问题被认为是有效的，可以推导出解决方案。\n\n第一步是计算系统噪声温度 $T_{sys}$。问题陈述接收机是线性的，并且瑞利-金斯近似有效。在此极限下，热源发出的噪声功率与其亮温度成正比。外差辐射计会增加其自身的内部噪声，该噪声可以通过一个等效输入噪声温度，即系统噪声温度 $T_{sys}$ 来表征。来自平方律检波器的总输出功率 $P$ 与输入亮温度 $T_{rad}$ 和系统噪声温度 $T_{sys}$ 之和成线性比例关系。\n$$P = C (T_{rad} + T_{sys})$$\n其中 $C$ 是一个比例常数，包含了系统增益、玻尔兹曼常数 $k_B$ 和中频带宽 $B$。\n\n在热/冷负载定标期间，辐射计观测的是黑体源，其亮温度等于其物理温度。我们可以写出两个方程：\n对于热负载：$P_{hot} = C (T_{hot} + T_{sys})$\n对于冷负载：$P_{cold} = C (T_{cold} + T_{sys})$\n\n为了求解 $T_{sys}$，我们可以使用Y因子法，该方法依赖于两个功率测量的比值：\n$$Y = \\frac{P_{hot}}{P_{cold}} = \\frac{C (T_{hot} + T_{sys})}{C (T_{cold} + T_{sys})} = \\frac{T_{hot} + T_{sys}}{T_{cold} + T_{sys}}$$\n重新整理此方程以求解 $T_{sys}$：\n$$Y (T_{cold} + T_{sys}) = T_{hot} + T_{sys}$$\n$$Y T_{cold} + Y T_{sys} = T_{hot} + T_{sys}$$\n$$T_{sys} (Y - 1) = T_{hot} - Y T_{cold}$$\n$$T_{sys} = \\frac{T_{hot} - Y T_{cold}}{Y - 1}$$\n代入给定的数值：\n$Y = \\frac{2.022 \\times 10^{-3}}{2.000 \\times 10^{-3}} = 1.011$\n$$T_{sys} = \\frac{295 - (1.011)(77)}{1.011 - 1} = \\frac{295 - 77.847}{0.011} = \\frac{217.153}{0.011} \\approx 19741.18 \\,\\mathrm{K}$$\n四舍五入到三位有效数字，系统噪声温度为 $T_{sys} = 1.97 \\times 10^{4} \\,\\mathrm{K}$。\n\n第二步是确定最小可探测电子温度涨落 $\\delta T_{e,\\min}$。这由辐射计方程决定，该方程描述了测量的统计不确定度。对于带有平方律检波器的总功率辐射计，测量温度的均方根（RMS）涨落 $\\delta T_{\\text{out}}$ 由总系统温度除以带宽-积分时间乘积的平方根给出。\n输入亮温度的最小可探测变化 $\\delta T_{B, \\min}$ 对应于仪器的噪声等效温度（NET），即信噪比为1时的涨落水平。这种仪器的固有灵敏度由系统自身的噪声基底 $T_{sys}$ 决定。\n$$\\delta T_{B, \\min} = \\frac{T_{sys}}{\\sqrt{B \\tau}}$$\n辐射计测得的亮温度 $T_B$ 通过辐射转移方程与等离子体的电子温度 $T_e$ 相关。对于通过有损耗的光学系统观测的光学灰体介质（$\\tau_{opt} > 0$），关系式为：\n$$T_B = \\eta_{t} \\kappa T_e (1 - \\exp(-\\tau_{opt}))$$\n问题定义了系数 $\\alpha = \\eta_{t} \\kappa (1 - \\exp(-\\tau_{opt}))$，因此我们有一个简单的线性关系：\n$$T_B = \\alpha T_e$$\n电子温度的微小涨落 $\\delta T_e$ 会产生相应的亮温度涨落 $\\delta T_B$：\n$$\\delta T_B = \\alpha \\delta T_e$$\n最小可探测电子温度涨落 $\\delta T_{e,\\min}$ 是产生等于辐射计噪声等效温度 $\\delta T_{B, \\min}$ 的亮温度涨落的值。\n$$\\delta T_{e, \\min} = \\frac{\\delta T_{B, \\min}}{\\alpha} = \\frac{T_{sys}}{\\alpha \\sqrt{B \\tau}}$$\n现在，我们代入已知和计算出的值。首先，计算无量纲因子：\n$\\alpha = \\eta_{t} \\kappa (1 - \\exp(-\\tau_{opt})) = (0.92)(0.85)(1 - \\exp(-2.00)) \\approx (0.782)(1 - 0.135335) \\approx 0.67617$\n带宽-时间乘积为：\n$B \\tau = (1.25 \\times 10^{9} \\,\\mathrm{Hz})(1.00 \\times 10^{-5} \\,\\mathrm{s}) = 12500$\n现在，计算 $\\delta T_{e, \\min}$：\n$$\\delta T_{e, \\min} = \\frac{19741.18}{\\sqrt{12500} \\cdot 0.67617} \\approx \\frac{19741.18}{(111.803)(0.67617)} \\approx \\frac{19741.18}{75.594} \\approx 261.15 \\,\\mathrm{K}$$\n四舍五入到三位有效数字，最小可探测电子温度涨落为 $\\delta T_{e,\\min} = 261 \\,\\mathrm{K}$。\n\n最终答案是 $T_{sys} \\approx 1.97 \\times 10^{4} \\,\\mathrm{K}$ 和 $\\delta T_{e,\\min} \\approx 261 \\,\\mathrm{K}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.97 \\times 10^{4}  261\n\\end{pmatrix}\n}\n$$", "id": "3697448"}, {"introduction": "ECE热成像的最终目标是绘制出整个等离子体的电子温度分布图。这最后一个高级练习通过模拟数据反演过程，将辐射物理与测量现实结合在一起。你将实现一个正向模型，并用它来理解如何从多个ECE通道重建完整的温度剖面，以及更重要的，测量的误差如何传递到最终的科学结果中。[@problem_id:3697449]", "problem": "给定一个用于磁约束聚变等离子体中电子回旋辐射（ECE）温度诊断的简化且物理一致的一维正向模型。该模型基于基本的辐射转移方程和Kirchhoff定律，并沿着等效于到ECE接收器的径向视线的单条射线进行离散化。您的任务是构建该正向模型的雅可比矩阵，然后用它进行线性化不确定性传播，以量化在测量噪声下重建的电子温度剖面的后验标准差。\n\n从以下基本原理和定义开始：\n- 在瑞利-金斯（Rayleigh–Jeans）极限下，亮度温度的辐射转移：沿着路径坐标 $s$，对于吸收系数 $\\kappa(s)$ 和电子温度 $T_e(s)$，探测器处观测到的亮度温度 $T_b$ 是线性输运方程的形式解，\n$$\nT_b = \\int_0^{L} \\kappa(s) T_e(s) \\exp\\!\\Big(-\\int_s^{L} \\kappa(u)\\,\\mathrm{d}u\\Big)\\,\\mathrm{d}s,\n$$\n其中 $L$ 是从等离子体内部到探测器的总路径长度。这源于微分方程 $\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + j$，根据Kirchhoff定律，以亮度温度为单位的发射率 $j=\\kappa T_e$，并利用了强度与亮度温度之间的瑞利-金斯对应关系。\n- 局部电子回旋频率为 $f_{ce}(r) = \\frac{e B(r)}{2\\pi m_e}$，其中 $e$ 是元电荷，$m_e$ 是电子质量，$B(r)$ 是磁场强度。对于一个在谐波 $s$ 上调谐到频率 $f_i$ 的给定ECE通道，当 $f_i \\approx s f_{ce}(r)$ 时，局部吸收达到峰值。\n\n将等离子体沿视线离散化为 $N$ 个均匀单元，索引为 $j \\in \\{0,\\dots,N-1\\}$，其位置 $r_j$ 从等离子体中心（$j=0$）向边缘的探测器（$j=N-1$）递增。设 $\\Delta s$ 为每个单元的均匀路径长度，并将通道 $i$ 在单元 $j$ 处的离散吸收系数定义为\n$$\n\\kappa_{ij} = k_0\\,n_e(r_j)\\,G\\!\\big(f_i - s f_{ce}(r_j)\\big),\n$$\n其中 $k_0$ 是一个设定光深标度的标量，$n_e(r)$ 是给定的无量纲电子密度剖面形状，$G(\\cdot)$ 是一个高斯线型\n$$\nG(\\Delta f) = \\exp\\!\\Big(-\\frac{\\Delta f^2}{2\\,\\delta f^2}\\Big),\n$$\n线宽为 $\\delta f$。那么，通道 $i$ 的离散正向模型为\n$$\ny_i = \\sum_{j=0}^{N-1} \\Delta s \\,\\kappa_{ij}\\,\\exp\\!\\Big(-\\Delta s \\sum_{m=j+1}^{N-1} \\kappa_{im}\\Big)\\,T_j + \\varepsilon_i,\n$$\n其中 $T_j \\equiv T_e(r_j)$ 是单元 $j$ 处的电子温度，$\\varepsilon_i$ 是测量噪声。该模型在 $\\{T_j\\}$ 上是线性的，因此雅可比矩阵 $J$（其元素为 $J_{ij} = \\frac{\\partial y_i}{\\partial T_j}$）等于由下式定义的正向算子矩阵 $W$\n$$\nW_{ij} = \\Delta s \\,\\kappa_{ij}\\,\\exp\\!\\Big(-\\Delta s \\sum_{m=j+1}^{N-1} \\kappa_{im}\\Big).\n$$\n\n假设重建过程采用一个针对 $T$ 的Tikhonov正则化加权最小二乘估计器，\n$$\n\\widehat{T} = \\arg\\min_T \\left\\{(y - WT)^\\top \\Sigma_n^{-1}(y - WT) + \\lambda \\|LT\\|_2^2\\right\\},\n$$\n其中 $\\Sigma_n$ 是测量的噪声协方差，$\\lambda \\ge 0$ 是正则化强度，$L$ 是一个惩罚粗糙度的一阶差分算子。由于该估计器在 $y$ 上是线性的，因此重建的线性化后验协方差为\n$$\n\\mathrm{Cov}(\\widehat{T}) = K \\,\\Sigma_n\\, K^\\top,\\quad \\text{with } K = \\Big(W^\\top \\Sigma_n^{-1} W + \\lambda L^\\top L\\Big)^{-1} W^\\top \\Sigma_n^{-1}.\n$$\n等价地，由于对于 $\\lambda > 0$ 和完整的数据支持，$\\Big(W^\\top \\Sigma_n^{-1} W + \\lambda L^\\top L\\Big)$ 是对称正定的，因此可以使用\n$$\n\\mathrm{Cov}(\\widehat{T}) = \\Big(W^\\top \\Sigma_n^{-1} W + \\lambda L^\\top L\\Big)^{-1} \\, W^\\top \\Sigma_n^{-1} W \\, \\Big(W^\\top \\Sigma_n^{-1} W + \\lambda L^\\top L\\Big)^{-1}.\n$$\n\n实现以下基于物理的参数化，以构建 $W$ 并为一组测试用例评估后验标准差（$\\mathrm{Cov}(\\widehat{T})$ 对角线的平方根）。所有量必须以指定的国际单位制（SI）单位表示，最终报告的不确定性必须以开尔文（kelvin）为单位。\n\n几何与剖面（所有测试用例共享）：\n- 单元数：$N = 20$。\n- 等离子体小半径：$a = 0.5\\,\\mathrm{m}$。\n- 单元位置：$r_j$ 从 $0$ 到 $a$ 均匀分布，其中 $\\Delta s = \\frac{a}{N-1}$。\n- 磁场：$B(r) = B_0 \\left(1 - \\beta\\,\\frac{r}{a}\\right)$，其中 $B_0 = 5.0\\,\\mathrm{T}$ 且 $\\beta = 0.4$。\n- 电子回旋频率：$f_{ce}(r) = \\frac{e B(r)}{2\\pi m_e}$，其中 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ 且 $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$。\n- 谐波：$s = 2$。\n- 电子密度形状：$n_e(r) = 1 - \\left(\\frac{r}{a}\\right)^2$（无量纲，归一化）。\n- 高斯线宽：$\\delta f = 4.0\\times 10^9\\,\\mathrm{Hz}$。\n- ECE通道数：$M = 16$，频率 $f_i$ 从 $170\\times 10^9\\,\\mathrm{Hz}$ 到 $270\\times 10^9\\,\\mathrm{Hz}$ 均匀分布。\n\n正则化：\n- 一阶差分矩阵 $L \\in \\mathbb{R}^{(N-1)\\times N}$，定义为 $(LT)_k = T_{k+1} - T_{k}$，其中 $k \\in \\{0,\\dots,N-2\\}$。\n\n噪声模型与光深标度（测试套件）：\n- 测试用例1（理想情况）：$k_0 = 50.0\\,\\mathrm{m}^{-1}$，$\\lambda = 10^{-2}$，不相关噪声，每个通道的标准差为 $\\sigma = 1.5\\times 10^4\\,\\mathrm{K}$，即 $\\Sigma_n = \\sigma^2 I_M$。\n- 测试用例2（光学薄）：$k_0 = 5.0\\,\\mathrm{m}^{-1}$，$\\lambda = 5\\times 10^{-3}$，不相关噪声，$\\sigma$ 相同。\n- 测试用例3（光学厚边缘加权）：$k_0 = 150.0\\,\\mathrm{m}^{-1}$，$\\lambda = 5\\times 10^{-2}$，不相关噪声，$\\sigma$ 相同。\n- 测试用例4（相关噪声）：$k_0 = 50.0\\,\\mathrm{m}^{-1}$，$\\lambda = 10^{-2}$，相关噪声，最近邻相关系数为 $\\rho = 0.3$，\n$$\n\\Sigma_n[i,j] =\n\\begin{cases}\n\\sigma^2,  i=j,\\\\\n\\rho\\,\\sigma^2,  |i-j| = 1,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n$\\sigma$ 与上述相同。\n\n需实现的任务：\n- 使用离散模型为每个测试用例的 $k_0$ 构建正向矩阵 $W \\in \\mathbb{R}^{M\\times N}$。\n- 将 $L$ 作为一阶差分算子构建一次。\n- 对每个噪声模型，计算 $\\Sigma_n$ 及其逆矩阵 $\\Sigma_n^{-1}$。\n- 计算线性估计器增益 $K$，然后计算后验协方差 $\\mathrm{Cov}(\\widehat{T}) = K \\Sigma_n K^\\top$。\n- 提取后验标准差剖面 $\\sqrt{\\mathrm{diag}(\\mathrm{Cov}(\\widehat{T}))}$。\n\n答案格式与单位要求：\n- 为每个测试用例，报告三个索引处的后验标准差：$j=0$（磁轴）、$j=\\lceil N/2 \\rceil$（中间半径）和 $j=N-1$（边缘）。\n- 所有报告的三个不确定性均以开尔文（kelvin）为单位，每个都四舍五入到三位小数。\n- 您的程序应生成单行输出，包含一个以逗号分隔的列表的列表，每个内部列表对应一个测试用例（按上述顺序排列），例如：$[[u_{1,0},u_{1,\\mathrm{mid}},u_{1,\\mathrm{edge}}],[u_{2,0},\\dots],\\dots]$，其中每个 $u$ 是一个以开尔文为单位的小数。\n- 您的程序必须是一个完整且可运行的实现，执行上述所有步骤，并严格按照指定的输出格式打印一行。不允许随机抽样；所有计算必须根据指定的输入确定性地进行。", "solution": "该问题要求计算从模拟的电子回旋辐射（ECE）测量中重建的电子温度剖面的后验标准差。解决方案涉及实现一个基于辐射转移方程的线性化正向模型，定义一个Tikhonov正则化反演，并应用线性化后验不确定性传播公式。该计算需要对四个具有不同物理或统计参数的独立测试用例进行。\n\n程序步骤如下：\n1.  定义物理和计算域，包括空间网格、ECE频率通道和相关的物理常数。\n2.  对每个测试用例，构建正向算子矩阵 $W$，它将电子温度剖面 $T$ 映射到测量的亮度温度 $y$。\n3.  构建一阶差分正则化算子 $L$ 和噪声协方差矩阵 $\\Sigma_n$。\n4.  计算估计温度剖面 $\\widehat{T}$ 的后验协方差矩阵 $\\mathrm{Cov}(\\widehat{T})$。\n5.  从 $\\mathrm{Cov}(\\widehat{T})$ 的对角线提取后验标准差，并报告指定位置的值。\n\n下面详细说明每个步骤。\n\n首先，我们确定共享的参数和网格。等离子体沿着长度为 $a=0.5\\,\\mathrm{m}$ 的径向视线被离散化为 $N=20$ 个单元。单元位置 $r_j$（对于 $j \\in \\{0, \\dots, N-1\\}$）从 $r_0=0$ 到 $r_{N-1}=a$ 均匀分布。每个单元的路径长度为 $\\Delta s = a/(N-1)$。有 $M=16$ 个ECE测量通道，其频率 $f_i$（对于 $i \\in \\{0, \\dots, M-1\\}$）从 $170 \\times 10^9\\,\\mathrm{Hz}$ 到 $270 \\times 10^9\\,\\mathrm{Hz}$ 均匀分布。\n\n等离子体的物理性质由给定的剖面定义。磁场强度随半径变化，为 $B(r_j) = B_0 (1 - \\beta r_j/a)$，其中 $B_0=5.0\\,\\mathrm{T}$ 且 $\\beta=0.4$。这导致了空间变化的电子回旋频率 $f_{ce}(r_j) = e B(r_j) / (2\\pi m_e)$，其中 $e$ 和 $m_e$ 分别是元电荷和电子质量。电子密度剖面由归一化形状 $n_e(r_j) = 1 - (r_j/a)^2$ 给出。\n\n正向模型的核心是正向算子矩阵 $W \\in \\mathbb{R}^{M \\times N}$。其元素 $W_{ij}$ 源于离散化的辐射转移方程，表示单元 $j$ 中的温度 $T_j$ 对通道 $i$ 信号的贡献。\n构建 $W$ 的过程始于计算吸收系数矩阵 $\\kappa \\in \\mathbb{R}^{M \\times N}$。元素 $\\kappa_{ij}$ 取决于ECE通道频率 $f_i$、单元 $j$ 处的局部等离子体特性以及光深标度因子 $k_0$：\n$$\n\\kappa_{ij} = k_0\\,n_e(r_j)\\,G\\!\\big(f_i - s f_{ce}(r_j)\\big)\n$$\n这里，$s=2$ 是谐波次数，$G(\\Delta f) = \\exp(-\\Delta f^2 / (2\\delta f^2))$ 是高斯线型函数，其给定线宽为 $\\delta f = 4.0\\times 10^9\\,\\mathrm{Hz}$。\n\n在确定吸收系数后，正向矩阵 $W$ 的元素由下式给出：\n$$\nW_{ij} = \\Delta s \\,\\kappa_{ij}\\,\\exp\\!\\Big(-\\Delta s \\sum_{m=j+1}^{N-1} \\kappa_{im}\\Big)\n$$\n指数项表示来自单元 $j$ 的辐射在穿过外部单元（$m > j$）传播到探测器过程中的衰减。总和 $\\sum_{m=j+1}^{N-1} \\kappa_{im}$ 是该路径的光深。由于 $W$ 依赖于 $k_0$，因此需要为每个测试用例执行此计算。\n\n温度重建使用Tikhonov正则化来确保解的稳定性和物理意义。正则化项 $\\lambda \\|LT\\|_2^2$ 惩罚温度剖面的粗糙度。一阶差分算子 $L \\in \\mathbb{R}^{(N-1) \\times N}$ 是一个矩阵，其中每一行 $k$ 计算差值 $T_{k+1} - T_k$。它被定义为 $L_{k,k} = -1$，$L_{k,k+1} = 1$，其他位置为零。\n\n测量不确定性由噪声协方差矩阵 $\\Sigma_n \\in \\mathbb{R}^{M \\times M}$ 表征。对于不相关噪声的测试用例，$\\Sigma_n = \\sigma^2 I_M$，其中 $\\sigma$ 是噪声标准差，$I_M$ 是单位矩阵。对于相关噪声的情况，$\\Sigma_n$ 是一个三对角矩阵，其对角线元素为 $\\sigma^2$，第一副对角线元素为 $\\rho\\sigma^2$，其中 $\\rho$ 是最近邻相关系数。\n\n估计温度剖面的后验协方差 $\\mathrm{Cov}(\\widehat{T})$ 使用提供的公式计算。我们定义矩阵 $A = W^\\top \\Sigma_n^{-1} W + \\lambda L^\\top L$，其中 $\\Sigma_n^{-1}$ 是噪声协方差矩阵的逆矩阵，$\\lambda$ 是正则化参数。矩阵 $A$ 包含了数据保真度（由噪声加权）和剖面平滑度的先验约束。那么后验协方差为：\n$$\n\\mathrm{Cov}(\\widehat{T}) = A^{-1} \\left( W^\\top \\Sigma_n^{-1} W \\right) A^{-1}\n$$\n该计算需要矩阵乘法，以及关键的 $N \\times N$ 矩阵 $A$ 的求逆。\n\n最后，每个单元 $j$ 中温度估计的后验标准差，记为 $\\sigma_{\\widehat{T_j}}$，是协方差矩阵相应对角元素的平方根：\n$$\n\\sigma_{\\widehat{T_j}} = \\sqrt{\\mathrm{Cov}(\\widehat{T})_{jj}}\n$$\n这些标准差量化了在每个空间点上重建温度的不确定性。对所有四个测试用例重复此过程，并报告索引 $j=0$（核心）、$j=10$（中间半径）和 $j=19$（边缘）处的标准差。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import inv\n\ndef solve():\n    \"\"\"\n    Solves the ECE thermography uncertainty propagation problem.\n    \"\"\"\n    # === 1. Define shared constants and geometry ===\n    e = 1.602176634e-19  # Elementary charge in C\n    m_e = 9.1093837015e-31  # Electron mass in kg\n    \n    N = 20  # Number of spatial cells\n    M = 16  # Number of ECE channels\n    \n    a = 0.5  # Plasma minor radius in m\n    B0 = 5.0  # Magnetic field on axis in T\n    beta = 0.4  # Magnetic field gradient parameter\n    \n    s = 2  # Harmonic number\n    df_line = 4.0e9  # Gaussian line width in Hz\n    \n    f_start = 170e9  # Start frequency in Hz\n    f_end = 270e9  # End frequency in Hz\n    \n    # === 2. Set up grids and profiles ===\n    r = np.linspace(0.0, a, N)  # Spatial grid from center to edge\n    ds = a / (N - 1)  # Path length per cell\n    \n    f_channels = np.linspace(f_start, f_end, M)  # ECE frequency channels\n    \n    # Pre-compute spatial profiles\n    B_r = B0 * (1 - beta * r / a)\n    f_ce_r = (e * B_r) / (2 * np.pi * m_e)\n    ne_r = 1 - (r / a)**2\n\n    # === 3. Define the first-difference regularization operator L ===\n    L = np.zeros((N - 1, N))\n    for i in range(N - 1):\n        L[i, i] = -1.0\n        L[i, i + 1] = 1.0\n\n    # === 4. Define test cases ===\n    test_cases = [\n        # k0, lambda, sigma, rho (rho=0 for uncorrelated)\n        (50.0, 1e-2, 1.5e4, 0.0), # Case 1\n        (5.0, 5e-3, 1.5e4, 0.0), # Case 2\n        (150.0, 5e-2, 1.5e4, 0.0),# Case 3\n        (50.0, 1e-2, 1.5e4, 0.3)  # Case 4\n    ]\n\n    all_results = []\n\n    # === 5. Loop through test cases and perform calculations ===\n    for k0, lam, sigma, rho in test_cases:\n        # --- a. Assemble the forward matrix W ---\n        \n        # Calculate absorption coefficient matrix kappa (M x N)\n        kappa = np.zeros((M, N))\n        for i in range(M):\n            for j in range(N):\n                delta_f = f_channels[i] - s * f_ce_r[j]\n                G = np.exp(-delta_f**2 / (2 * df_line**2))\n                kappa[i, j] = k0 * ne_r[j] * G\n        \n        # Calculate forward matrix W (M x N)\n        W = np.zeros((M, N))\n        for i in range(M):\n            for j in range(N):\n                # Sum kappa for cells between j and the detector\n                outward_sum_kappa = np.sum(kappa[i, j + 1:])\n                tau_out = ds * outward_sum_kappa\n                W[i, j] = ds * kappa[i, j] * np.exp(-tau_out)\n\n        # --- b. Assemble the noise covariance matrix Sigma_n ---\n        if rho == 0.0:\n            sigma_n = (sigma**2) * np.eye(M)\n        else:\n            sigma_n = (sigma**2) * np.eye(M)\n            off_diag_val = rho * (sigma**2)\n            sigma_n += off_diag_val * np.eye(M, k=1)\n            sigma_n += off_diag_val * np.eye(M, k=-1)\n        \n        # --- c. Compute the posterior covariance Cov(T_hat) ---\n        sigma_n_inv = inv(sigma_n)\n        \n        WT_sn_inv_W = W.T @ sigma_n_inv @ W\n        LT_L = L.T @ L\n        \n        A = WT_sn_inv_W + lam * LT_L\n        A_inv = inv(A)\n        \n        # Using the form Cov = A_inv * (W^T * Sigma_n_inv * W) * A_inv\n        cov_T_hat = A_inv @ WT_sn_inv_W @ A_inv\n        \n        # --- d. Extract and store standard deviations ---\n        variances = np.diag(cov_T_hat)\n        # Handle potential small negative values from numerical error\n        std_devs = np.sqrt(np.maximum(0, variances))\n        \n        indices_to_report = [0, int(np.ceil(N / 2)), N - 1]\n        \n        case_results = [\n            f\"{std_devs[indices_to_report[0]]:.3f}\",\n            f\"{std_devs[indices_to_report[1]]:.3f}\",\n            f\"{std_devs[indices_to_report[2]]:.3f}\"\n        ]\n        all_results.append(f\"[{','.join(case_results)}]\")\n\n    # === 6. Format and print the final output ===\n    print(f\"[[{','.join(all_results)}]]\")\n\nsolve()\n\n```", "id": "3697449"}]}