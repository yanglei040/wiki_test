{"hands_on_practices": [{"introduction": "要理解随机磁场中极其复杂的输运过程，物理学家们常常从简化的模型入手。Chirikov-Taylor标准映射是哈密顿混沌理论中最经典的模型之一，它通过一个简单的迭代规则，精妙地描述了磁约束聚变装置中谐振面附近磁力线的庞加莱截面动力学。通过这个实践[@problem_id:3720048]，你将亲手实现标准映射，直观地观察系统如何从规则的运动过渡到大范围的混沌，并学习使用有限时间李雅普诺夫指数 $\\lambda_N(K)$ 和扩散系数 $D_N(K)$ 这两个核心指标来定量地刻画混沌的强度和输运行为。", "problem": "考虑一个用于核聚变装置中随机磁场输运的数学模型，其中磁力线被视为哈密顿系统的轨迹。在作用量-角度坐标 $(\\theta,I)$ 中，以环向角作为演化参数，静磁场线遵循正则哈密顿方程 $d\\theta/d\\phi = \\partial H/\\partial I$ 和 $dI/d\\phi = -\\partial H/\\partial \\theta$，其中 $H(\\theta,I,\\phi)$ 在环向角 $\\phi$ 上是 $2\\pi$ 周期的。对于单个主导的共振微扰，每个环向周期采样一次的频闪庞加莱映射可简化为一种保面积的扭转映射，称为Chirikov–Taylor标准映射，它可作为有理面附近磁力线的映射模型。柱面上的标准映射由以下正则更新规则定义\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n), \\quad \\theta_{n+1} = \\theta_n + I_{n+1} \\mod 2\\pi,\n$$\n其中 $n$ 是穿越庞加莱截面的次数索引，$K$ 是一个与微扰强度成正比的非负参数，$\\theta_n \\in [0,2\\pi)$ 是一个角度变量，$I_n \\in \\mathbb{R}$ 是一个与径向漂移成正比的类作用量变量。在此模型中，磁力线输运由两个量度来量化：\n1. 有限时间扩散系数\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 表示对指定初始条件系综的平均，而 $N$ 是映射迭代的次数。\n2. 有限时间最大李雅普诺夫指数\n$$\n\\lambda_N(K) = \\left\\langle \\frac{1}{N}\\sum_{n=0}^{N-1} \\ln \\frac{\\left\\|\\delta \\mathbf{v}_{n+1}\\right\\|}{\\left\\|\\delta \\mathbf{v}_{n}\\right\\|} \\right\\rangle,\n$$\n通过雅可比矩阵演化无穷小微扰 $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ 的切映射计算得出\n$$\nJ(\\theta_n) = \n\\begin{pmatrix}\n1 + K \\cos(\\theta_n) & 1 \\\\\nK \\cos(\\theta_n) & 1\n\\end{pmatrix},\n$$\n其中范数 $\\|\\cdot\\|$ 取为欧几里得范数。该李雅普诺夫指数测量相邻磁力线之间分离的平均指数率，是混沌的一个典型指标。该映射是保面积的，满足 $\\det J(\\theta_n) = 1$。当 $K$ 足够小时，系统表现出Kolmogorov–Arnold–Moser (KAM) 不变曲线，随着 $K$ 的增大，这些曲线会逐渐破裂。\n\n任务：从静磁场线的正则哈密顿结构以及到离散保面积映射的频闪简化出发，实现一个程序，对下面列出的每个测试用例执行以下操作：\n- 对一个由 $M$ 个确定性初始条件组成的系综演化标准映射 $N$ 次迭代。这些初始条件定义为：$\\theta_0$ 在 $[0,2\\pi)$ 内均匀分布，且所有系综成员的 $I_0 = 0$。角度使用弧度制。\n- 通过对系综平均 $(I_N - I_0)^2$ 再除以 $2N$ 来计算 $D_N(K)$。\n- 对于系综中的每个成员，在 $J(\\theta_n)$ 作用下同步演化切动力学来计算 $\\lambda_N(K)$。将所有成员的初始切向量初始化为 $(\\delta \\theta_0,\\delta I_0) = (1,0)$，并在每一步中，累加范数增量的对数，并将切向量重整化为单位范数以防止数值溢出。将有限时间指数在系综上平均以获得 $\\lambda_N(K)$。\n\n角度必须以弧度处理。由于模型是无量纲的，$D_N(K)$ 或 $\\lambda_N(K)$ 无需报告物理单位。\n\n测试套件：\n- 案例1 (可积边界): $K = 0.0$, $N = 4000$, $M = 128$。\n- 案例2 (近可积): $K = 0.5$, $N = 4000$, $M = 128$。\n- 案例3 (近临界KAM破裂): $K = 0.971635$, $N = 8000$, $M = 128$。\n- 案例4 (强混沌): $K = 3.0$, $N = 4000$, $M = 128$。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例贡献一个双元素列表 $[D_N(K),\\lambda_N(K)]$，两个条目都格式化为四舍五入到六位小数的浮点数。最终输出不得包含空格。例如，两个案例的输出应如下所示：$[[0.000000,0.000000],[1.234567,0.890123]]$。\n\n目标是：\n- 通过使用磁力线动力学的正则结构和保面积映射来模拟庞加莱输运，确保科学真实性。\n- 通过将映射和切动力学建立在哈密顿形式理论和雅可比传播的基础上，而不调用特设的输运公式，来展示第一性原理推导。\n- 使用指定的系综和重整化方案，提供数值稳定和确定性的计算。", "solution": "该问题要求实现一个数值模拟，为Chirikov-Taylor标准映射计算两个关键的输运指标——有限时间扩散系数 $D_N(K)$ 和有限时间最大李雅普诺夫指数 $\\lambda_N(K)$。该映射是哈密顿动力学中的一个典范模型，代表了环形聚变装置中共振磁面附近磁力线的频闪演化。该解决方案建立在对一个初始条件统计系综的映射方程和相关切映射进行直接数值积分的基础之上。\n\n整个过程植根于第一性原理，从静磁场线的正则哈密顿结构开始，该结构保证了其演化过程保留相空间体积。将问题简化为像标准映射这样的离散、保面积映射，是等离子体物理和非线性动力学中的一种标准技术。保面积特性，在数学上表示为 $\\det(J)=1$（其中 $J$ 是映射的雅可比矩阵），是底层哈密顿形式理论的直接结果。\n\n算法设计如下：\n\n**1. 系综初始化**\n\n为了获得具有统计意义的输运系数，我们模拟一个包含 $M$ 条轨迹的系综。问题指定了确定性的初始条件。\n- 对于系综中的所有 $M$ 个成员，初始类作用量变量设为 $I_0 = 0$。这对应于所有磁力线都从未受扰动的共振磁面出发。\n- 初始角度变量 $\\theta_0$ 在区间 $[0, 2\\pi)$ 上均匀分布。为了进行确定性、可复现的计算，我们使用公式 $\\theta_{0,j} = \\frac{2\\pi j}{M}$（其中 $j=0, 1, \\dots, M-1$）生成 $M$ 个等间距的点。\n\n**2. 状态向量演化**\n\n对于 $M$ 个初始条件 $(\\theta_{0,j}, I_{0,j})$ 中的每一个，标准映射都迭代 $N$ 步。第 $n+1$ 步的状态由第 $n$ 步的状态通过以下正则更新规则计算得出：\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n)\n$$\n$$\n\\theta_{n+1} = (\\theta_n + I_{n+1}) \\pmod{2\\pi}\n$$\n这里的模运算确保角度 $\\theta$ 保持在基本域 $[0, 2\\pi)$ 内。对 $n = 0, 1, \\dots, N-1$ 迭代应用这些方程，以获得最终状态 $(\\theta_{N,j}, I_{N,j})$。\n\n**3. 扩散系数 $D_N(K)$ 的计算**\n\n扩散系数 $D_N(K)$ 量化了作用量变量 $I$ 在 $N$ 次迭代中的均方根位移，并在系综上进行平均。它是磁力线径向输运的一个度量。其定义为：\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle\n$$\n尖括号 $\\langle \\cdot \\rangle$ 表示系综平均。在我们这个所有成员 $I_0 = 0$ 的特定系综中，计算简化为：\n$$\nD_N(K) = \\frac{1}{2N} \\left( \\frac{1}{M} \\sum_{j=1}^{M} (I_{N,j})^2 \\right) = \\frac{1}{2NM} \\sum_{j=1}^{M} I_{N,j}^2\n$$\n这在 $N$ 次迭代完成后，通过计算最终作用量值平方 $I_{N,j}^2$ 的均值，并乘以因子 $1/(2N)$ 来计算。\n\n**4. 李雅普诺夫指数 $\\lambda_N(K)$ 的计算**\n\n最大李雅普诺夫指数 $\\lambda_N(K)$ 衡量邻近轨迹发散的平均指数率，是混沌的一个基本指标。它是通过沿一条轨迹演化一个无穷小切向量 $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ 来计算的。该向量的演化由切映射决定，这是一个由雅可比矩阵 $J(\\theta_n)$ 定义的线性变换：\n$$\n\\delta \\mathbf{v}_{n+1} = J(\\theta_n) \\delta \\mathbf{v}_n, \\quad \\text{其中} \\quad J(\\theta_n) =\n\\begin{pmatrix}\n1 + K \\cos(\\theta_n) & 1 \\\\\nK \\cos(\\theta_n) & 1\n\\end{pmatrix}\n$$\n直接迭代这个线性映射会导致数值溢出，因为在混沌区域，$\\delta \\mathbf{v}_n$ 的范数会呈指数级增长。为确保数值稳定性，在系综中每条轨迹的每次迭代步骤中，都采用标准的重整化过程。\n\n该过程如下：\n- **初始化**：对每条轨迹 $j$，初始切向量设为单位向量，具体为 $\\delta \\mathbf{v}_{0,j} = (1, 0)$。用于记录增长因子对数的累加和 $S_j$ 初始化为 $0$。\n- **迭代 ($n=0, \\dots, N-1$)**：\n    1. 使用在轨迹当前位置 $\\theta_{n,j}$ 处计算的雅可比矩阵将切向量演化一步：$\\delta \\mathbf{v}'_{n+1,j} = J(\\theta_{n,j}) \\delta \\mathbf{v}_{n,j}$。\n    2. 计算所得向量的欧几里得范数：$d_{n+1,j} = \\|\\delta \\mathbf{v}'_{n+1,j}\\|$。这代表了在第 $n+1$ 步的局部拉伸因子。\n    3. 将该因子的自然对数加到累加和中：$S_j \\leftarrow S_j + \\ln(d_{n+1,j})$。\n    4. 为下一次迭代将切向量重整化为单位长度：$\\delta \\mathbf{v}_{n+1,j} = \\delta \\mathbf{v}'_{n+1,j} / d_{n+1,j}$。\n- **最终计算**：经过 $N$ 次迭代后，每条轨迹的有限时间李雅普诺夫指数为 $\\lambda_{N,j} = S_j / N$。最终值是系综的平均值：\n$$\n\\lambda_N(K) = \\langle \\lambda_{N,j} \\rangle = \\frac{1}{M} \\sum_{j=1}^{M} \\frac{S_j}{N}\n$$\n该算法正确实现了李雅普诺夫指数的定义 $\\lambda_N(K) = \\frac{1}{N} \\langle \\sum_{n=0}^{N-1} \\ln (\\|\\delta \\mathbf{v}_{n+1}\\| / \\|\\delta \\mathbf{v}_n\\|) \\rangle$，因为每一步的重整化确保了 $\\|\\delta \\mathbf{v}_n\\|$ 始终为 $1$。\n\n该实现将利用 `numpy` 在整个系综上进行向量化操作，从而大大提高计算效率。每个测试用例将按顺序处理，应用上述算法生成数据对 $[D_N(K), \\lambda_N(K)]$，然后将其格式化为所需的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_transport_coeffs(K, N, M):\n    \"\"\"\n    Computes the finite-time diffusion coefficient and Lyapunov exponent for the standard map.\n\n    Args:\n        K (float): The stochasticity parameter of the standard map.\n        N (int): The number of map iterations.\n        M (int): The number of ensemble members.\n\n    Returns:\n        tuple[float, float]: A tuple containing (D_N, lambda_N).\n    \"\"\"\n    # 1. Initialize ensemble and state variables\n    # Initial angles are uniformly spaced in [0, 2*pi).\n    thetas = np.linspace(0.0, 2.0 * np.pi, M, endpoint=False, dtype=np.float64)\n    # Initial actions are all zero.\n    Is = np.zeros(M, dtype=np.float64)\n\n    # 2. Initialize tangent vectors and Lyapunov exponent accumulator\n    # Initial tangent vectors are (1, 0) for all ensemble members.\n    delta_thetas = np.ones(M, dtype=np.float64)\n    delta_Is = np.zeros(M, dtype=np.float64)\n    # Accumulator for the sum of logarithms of norms for each trajectory.\n    log_norm_sum = np.zeros(M, dtype=np.float64)\n\n    # 3. Evolve the map and tangent vectors for N steps\n    for _ in range(N):\n        # Store current theta for Jacobian calculation\n        theta_n = thetas\n        \n        # Update state vector (I, theta) according to the standard map equations\n        I_next = Is + K * np.sin(theta_n)\n        theta_next = np.mod(theta_n + I_next, 2.0 * np.pi)\n        \n        # Update states for the next iteration\n        thetas = theta_next\n        Is = I_next\n        \n        # Evolve the tangent vector using the Jacobian matrix\n        # J(theta_n) = [[1 + K*cos(theta_n), 1], [K*cos(theta_n), 1]]\n        K_cos_theta = K * np.cos(theta_n)\n        \n        d_theta_prime = (1.0 + K_cos_theta) * delta_thetas + delta_Is\n        d_I_prime = K_cos_theta * delta_thetas + delta_Is\n        \n        # Calculate the Euclidean norm of the new tangent vector\n        norms = np.sqrt(d_theta_prime**2 + d_I_prime**2)\n        \n        # Add the log of the norm to the accumulator.\n        # Handle cases where norm might be zero to avoid log(0).\n        # For this problem, with initial vector (1,0) and K>=0, norms will be >= 1.\n        log_norm_sum += np.log(norms)\n        \n        # Renormalize the tangent vector to unit length\n        # Add a small epsilon to avoid division by zero, although not strictly necessary here.\n        # As norms >= 1, we can safely divide.\n        delta_thetas = d_theta_prime / norms\n        delta_Is = d_I_prime / norms\n\n    # 4. Calculate final transport coefficients\n    # Diffusion coefficient: D_N = (I_N - I_0)^2> / (2*N)\n    # Since I_0 = 0, this simplifies to\n    # Handle N=0 case to avoid division by zero.\n    if N > 0:\n        D_N = np.mean(Is**2) / (2.0 * N)\n        lambda_N = np.mean(log_norm_sum) / N\n    else:\n        D_N = 0.0\n        lambda_N = 0.0\n    \n    return D_N, lambda_N\n\ndef solve():\n    \"\"\"\n    Main driver function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (K, N, M)\n        (0.0, 4000, 128),      # Case 1\n        (0.5, 4000, 128),      # Case 2\n        (0.971635, 8000, 128), # Case 3\n        (3.0, 4000, 128)       # Case 4\n    ]\n\n    all_results = []\n    for K_val, N_val, M_val in test_cases:\n        dn_val, lambda_n_val = compute_transport_coeffs(K_val, N_val, M_val)\n        all_results.append(f\"[{dn_val:.6f},{lambda_n_val:.6f}]\")\n    \n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3720048"}, {"introduction": "在标准映射揭示了场线混沌的基本特征之后，我们可以转向一个更接近真实物理情景的连续模型。磁力线的轨迹本质上是由一组常微分方程（ODEs）描述的，其中的微小扰动可能导致混沌行为。这个练习[@problem_id:3720061]要求你直接对这组场线方程进行数值积分，并采用Benettin算法来计算有限时间最大李雅普诺夫指数。通过这个过程，你将掌握诊断连续动力学系统中混沌的实用方法，并深入理解相邻磁力线在随机场中是如何呈指数形式分离的。", "problem": "您必须编写一个完整且可运行的程序，用于在一个与核聚变等离子体中随机磁场输运相关的模型中，计算磁力线分离的有限时间最大李雅普诺夫指数。您的实现必须源于第一性原理，并遵循以下说明。\n\n考虑一个三维磁场 $\\mathbf{B}(\\mathbf{x})$，满足 $\\nabla \\cdot \\mathbf{B} = 0$，其构型中主要引导场沿 $z$ 方向，即 $\\mathbf{B} = \\left(B_x, B_y, B_0\\right)$，其中 $B_0$ 为常数，微扰由一个标量势 $A_z(x,y,z)$ 表示，使得 $\\mathbf{B} = \\nabla \\times \\left(A_z \\hat{\\mathbf{z}}\\right) + B_0 \\hat{\\mathbf{z}}$。磁力线满足定义 $d\\mathbf{x}/ds \\parallel \\mathbf{B}$，其中 $s$ 是弧长。在存在强引导场 $B_0 \\neq 0$ 的情况下，标准做法是按 $z$ 重新参数化，并使用以下磁力线方程：\n$$\n\\frac{dx}{dz} = \\frac{B_x}{B_0}, \\quad \\frac{dy}{dz} = \\frac{B_y}{B_0},\n$$\n其中\n$$\nB_x = \\frac{\\partial A_z}{\\partial y}, \\quad B_y = -\\frac{\\partial A_z}{\\partial x}.\n$$\n这是一个哈密顿系统，其中 $z$ 是类时变量，哈密顿量为 $H(x,y,z) = A_z(x,y,z)/B_0$。\n\n对 $A_z(x,y,z)$ 采用以下由傅里叶模式有限和构成的显式无量纲模型：\n$$\nA_z(x,y,z) = \\varepsilon \\sum_{m=1}^{M} \\frac{\\cos\\!\\left(k_{x,m}\\,x + k_{y,m}\\,y + k_{z,m}\\,z + \\phi_m \\right)}{\\sqrt{k_{x,m}^2 + k_{y,m}^2}},\n$$\n其中所有角度均以弧度为单位，$\\varepsilon$ 是无量纲微扰振幅，$M$ 是模式数量，$\\phi_m$ 是固定相位。横向波数归一化确保了每个模式对横向场的贡献相当。由此得到的磁力线常微分方程为：\n$$\n\\frac{dx}{dz} = \\frac{1}{B_0}\\frac{\\partial A_z}{\\partial y} = -\\frac{\\varepsilon}{B_0} \\sum_{m=1}^{M} \\frac{k_{y,m}}{\\sqrt{k_{x,m}^2 + k_{y,m}^2}} \\sin\\!\\left(k_{x,m}\\,x + k_{y,m}\\,y + k_{z,m}\\,z + \\phi_m\\right),\n$$\n$$\n\\frac{dy}{dz} = -\\frac{1}{B_0}\\frac{\\partial A_z}{\\partial x} = \\frac{\\varepsilon}{B_0} \\sum_{m=1}^{M} \\frac{k_{x,m}}{\\sqrt{k_{x,m}^2 + k_{y,m}^2}} \\sin\\!\\left(k_{x,m}\\,x + k_{y,m}\\,y + k_{z,m}\\,z + \\phi_m\\right).\n$$\n\n您的任务是使用Benettin算法计算磁力线分离的有限时间最大李雅普诺夫指数。设 $\\delta_0$ 为两条初始条件分别为 $\\left(x_0,y_0\\right)$ 和 $\\left(x_0 + \\delta_0, y_0\\right)$ 的磁力线之间的微小初始分离距离。在相同的动力学条件下，将两条轨迹演化至最终“时间” $z = T$。在规则的重正化间隔 $\\Delta z_r$ 处，将分离距离重新缩放回 $\\delta_0$ 并累积拉伸因子。有限时间最大李雅普诺夫指数定义为：\n$$\n\\lambda(T) = \\frac{1}{T} \\sum_{j} \\ln\\!\\left(\\frac{\\|\\Delta \\mathbf{r}(z_j)\\|}{\\delta_0}\\right),\n$$\n其中 $\\Delta \\mathbf{r}(z_j)$ 是第 $j$ 次重正化之前的分离向量，求和包含在 $T$ 处的最后一个可能不完整的区间。在 $x$ 和 $y$ 方向的 $2\\pi$ 周期性区域上使用最小镜像约定来测量分离距离，即对 $x$ 和 $y$ 进行模 $2\\pi$ 处理，并使用环面上的最短距离计算分离。\n\n实现要求：\n- 使用固定步长的四阶龙格－库塔积分器以步长 $h$ 推进 $x(z)$ 和 $y(z)$ 的耦合方程。\n- 在每一步之后，通过对 $x$ 和 $y$ 进行模 $2\\pi$ 的环绕处理来施加 $2\\pi$ 周期性。\n- 沿每个坐标使用最小镜像差计算分离距离：在形成欧几里得范数之前，将坐标差映射到 $\\left(-\\pi,\\pi\\right]$ 区间内。\n- 使用Benettin重正化方案，每 $n_r$ 个积分步执行一次重正化，其中 $\\Delta z_r = n_r\\,h$。\n\n使用以下固定的模式和相位集：\n- $M = 8$，\n- 模式列表 $\\left(k_{x,m},k_{y,m},k_{z,m}\\right)$ 等于\n$\\left(1,0,1\\right)$, $\\left(0,1,1\\right)$, $\\left(1,1,2\\right)$, $\\left(2,1,3\\right)$, $\\left(1,2,2\\right)$, $\\left(2,2,1\\right)$, $\\left(3,1,2\\right)$, $\\left(1,3,2\\right)$,\n- 对于所有 $m$，相位 $\\phi_m = 0$。\n\n所有量均为无量纲。所有角度必须以弧度处理。最终的李雅普诺夫指数 $\\lambda(T)$ 是无量纲的。对于数值报告，请将每个计算出的李雅普诺夫指数四舍五入到6位小数。\n\n测试套件：\n为以下每个参数集 $\\left(\\varepsilon, B_0, T, h, \\delta_0, n_r, x_0, y_0\\right)$ 计算 $\\lambda(T)$：\n- 情况1（可积基线）：$\\left(0.0, 1.0, 50.0, 0.02, 10^{-6}, 5, 0.31, 0.27\\right)$。\n- 情况2（弱随机性，长积分）：$\\left(0.1, 1.0, 200.0, 0.02, 10^{-6}, 5, 0.31, 0.27\\right)$。\n- 情况3（强随机性，长积分）：$\\left(0.4, 1.0, 200.0, 0.02, 10^{-6}, 5, 0.31, 0.27\\right)$。\n- 情况4（弱随机性，短积分）：$\\left(0.1, 1.0, 5.0, 0.02, 10^{-6}, 5, 0.31, 0.27\\right)$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表顺序与测试套件的顺序相同，例如 $\\left[\\text{结果}_1,\\text{结果}_2,\\text{结果}_3,\\text{结果}_4\\right]$，其中每个 $\\text{结果}_i$ 是对应情况的有限时间最大李雅普诺夫指数，四舍五入到6位小数。不应打印任何其他文本。", "solution": "用户希望为一个用于核聚变研究的磁力线模型计算有限时间最大李雅普诺夫指数。\n\n### **问题验证**\n\n首先，我将根据指定标准验证问题陈述。\n\n**第1步：提取已知条件**\n\n*   **常微分方程组：** 磁力线坐标 $(x, y)$ 相对于环向坐标 $z$ 的演化由以下方程给出：\n    $$\n    \\frac{dx}{dz} = -\\frac{\\varepsilon}{B_0} \\sum_{m=1}^{M} \\frac{k_{y,m}}{\\sqrt{k_{x,m}^2 + k_{y,m}^2}} \\sin\\!\\left(k_{x,m}\\,x + k_{y,m}\\,y + k_{z,m}\\,z + \\phi_m\\right)\n    $$\n    $$\n    \\frac{dy}{dz} = \\frac{\\varepsilon}{B_0} \\sum_{m=1}^{M} \\frac{k_{x,m}}{\\sqrt{k_{x,m}^2 + k_{y,m}^2}} \\sin\\!\\left(k_{x,m}\\,x + k_{y,m}\\,y + k_{z,m}\\,z + \\phi_m\\right)\n    $$\n*   **数值方法：**\n    *   积分器：固定步长 $h$ 的四阶龙格-库塔（RK4）方法。\n    *   李雅普诺夫指数算法：Benettin算法。\n    *   重正化：每 $n_r$ 个积分步执行一次，对应于 $\\Delta z_r = n_r h$ 的间隔。分离距离被重新缩放至 $\\delta_0$。\n*   **域和边界条件：**\n    *   该域在 $x$ 和 $y$ 方向上都是 $2\\pi$ 周期性的。每步之后必须将坐标对 $2\\pi$ 取模。\n    *   分离距离使用最小镜像约定计算，即在计算欧几里得范数之前，将坐标差映射到区间 $(-\\pi, \\pi]$。\n*   **李雅普诺夫指数公式：**\n    $$\n    \\lambda(T) = \\frac{1}{T} \\sum_{j} \\ln\\!\\left(\\frac{\\|\\Delta \\mathbf{r}(z_j)\\|}{\\delta_0}\\right)\n    $$\n    求和遍历所有重正化事件，包括在时间 $T$ 的最终测量。\n*   **模型参数：**\n    *   模式数 $M=8$。\n    *   模式波矢量 $(k_{x,m},k_{y,m},k_{z,m})$：\n      $\\left(1,0,1\\right)$, $\\left(0,1,1\\right)$, $\\left(1,1,2\\right)$, $\\left(2,1,3\\right)$, $\\left(1,2,2\\right)$, $\\left(2,2,1\\right)$, $\\left(3,1,2\\right)$, $\\left(1,3,2\\right)$。\n    *   对于所有 $m$，相位 $\\phi_m = 0$。\n*   **测试用例：** 任务是为四组参数 $(\\varepsilon, B_0, T, h, \\delta_0, n_r, x_0, y_0)$ 计算 $\\lambda(T)$：\n    1.  $(0.0, 1.0, 50.0, 0.02, 10^{-6}, 5, 0.31, 0.27)$\n    2.  $(0.1, 1.0, 200.0, 0.02, 10^{-6}, 5, 0.31, 0.27)$\n    3.  $(0.4, 1.0, 200.0, 0.02, 10^{-6}, 5, 0.31, 0.27)$\n    4.  $(0.1, 1.0, 5.0, 0.02, 10^{-6}, 5, 0.31, 0.27)$\n*   **输出格式：** 结果以方括号括起来的逗号分隔列表形式输出，每个结果四舍五入到6位小数。\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学上成立的：** 该问题基于一个描述等离子体物理中受扰磁场的标准哈密顿模型。使用李雅普诺夫指数来量化混沌以及使用Benettin算法来计算它们，是非线性动力学中的标准、成熟方法。\n2.  **适定的：** 该问题是适定的。它提供了一个具有给定初始条件的非自治一阶常微分方程组。方程右侧的函数是全局利普希茨的，保证了解的存在性和唯一性。所有参数、数值方法和边界条件都已明确定义，从而可以得到唯一且有意义的数值结果。\n3.  **客观的：** 问题以精确的数学和算法语言陈述，没有任何主观性。\n4.  **完整性和一致性：** 问题是自洽且一致的。为每个测试用例提供了所有必要的参数和定义。分母中的归一化因子 $\\sqrt{k_{x,m}^2 + k_{y,m}^2}$ 是良定义的，因为没有给定的模式具有 $(k_x, k_y) = (0,0)$。\n5.  **可行性：** 数值参数（$T, h$）导致的积分步数（例如，最长情况下为10,000步）在计算上是可行的，完全在现代计算机的能力范围内。\n\n**第3步：结论与行动**\n\n问题是**有效的**。这是一个计算物理学中具体、定义明确的问题。我将继续开发解决方案。\n\n### **解决方案设计**\n\n解决方案的核心是为根据给定常微分方程演化的两条轨迹实现Benettin算法。将使用四阶龙格-库塔（RK4）积分器进行时间步进。\n\n1.  **常微分方程组函数 (`rhs_func`)**：将实现一个函数来计算 $dx/dz$ 和 $dy/dz$ 方程的右侧。该函数将接收位置向量 $\\mathbf{r} = (x,y)$ 和“时间” $z$ 作为输入。为了优化性能，将使用 `numpy` 对计算进行矢量化，同时对所有 $M=8$ 个模式的贡献求和。\n\n2.  **RK4积分器 (`rk4_step`)**：一个标准的固定步长RK4函数将一条轨迹推进一个步长 $h$。它将接收当前位置、当前时间 $z$、步长 $h$ 和 `rhs_func` 函数作为参数。\n\n3.  **最小镜像分离 (`min_image_diff`)**：一个辅助函数将计算 $2\\pi \\times 2\\pi$ 环面上两点之间的分离向量。它将坐标方向的差值映射到区间 $(-\\pi, \\pi]$ 以找到最短路径。\n\n4.  **主计算函数 (`compute_lyapunov`)**：此函数协调单个测试用例的整个计算过程。\n    *   **初始化**：它为两条轨迹设置初始条件：一条起始于 $(x_0, y_0)$ 的参考轨迹和一条起始于 $(x_0 + \\delta_0, y_0)$ 的微扰轨迹。一个变量 `log_stretching_sum` 初始化为 $0$。\n    *   **积分循环**：该函数将总共循环 `num_steps = round(T/h)` 次迭代。在每次迭代中：\n        *   使用 `rk4_step` 函数将两条轨迹都推进一个步长。\n        *   将新位置对 $2\\pi$ 取模以施加周期性边界条件。\n        *   时间 $z$ 增加 $h$。\n    *   **重正化**：每 $n_r$ 步，使用最小镜像约定计算轨迹之间的分离距离 $\\|\\Delta \\mathbf{r}\\|$。将 $\\ln(\\|\\Delta \\mathbf{r}\\| / \\delta_0)$ 的值加到 `log_stretching_sum` 中。然后重新缩放微扰轨迹，使其与参考轨迹的分离距离再次为 $\\delta_0$，方向与分离向量相同。\n    *   **最终区间**：问题规定，对数拉伸因子的总和包括最后一个可能不完整的区间。如果总步数不是 $n_r$ 的整数倍，则必须计算并累加最后一次完整重正化区间后积累的拉伸。\n    *   **结果**：最终的李雅普诺夫指数计算为 $\\lambda(T) = \\text{log\\_stretching\\_sum} / T$。\n\n5.  **驱动程序 (`solve`)**：一个主函数将定义测试用例，为每个用例调用 `compute_lyapunov`，收集结果，将其格式化为6位小数，并以指定的列表格式打印。对于 $\\varepsilon = 0$ 的特殊情况会直接处理，因为其李雅普诺夫指数解析上为0。\n\n这种结构化方法确保了问题陈述的所有要求都得到精确满足。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Set up the problem's fixed parameters\n# Modes (kx, ky, kz)\nMODES = np.array([\n    [1., 0., 1.], [0., 1., 1.], [1., 1., 2.], [2., 1., 3.],\n    [1., 2., 2.], [2., 2., 1.], [3., 1., 2.], [1., 3., 2.]\n], dtype=np.float64)\n\n# Pre-calculate normalization factors for the transverse field components\n# 1 / sqrt(k_x^2 + k_y^2)\nK_PERP_SQ = MODES[:, 0]**2 + MODES[:, 1]**2\n# Handle potential division by zero if a mode has (kx, ky) = (0,0), though not present here.\nwith np.errstate(divide='ignore', invalid='ignore'):\n    NORM_INV = np.divide(1.0, np.sqrt(K_PERP_SQ), where=K_PERP_SQ!=0)\n\ndef compute_lyapunov(eps, b0, T, h, delta0, nr, x0, y0):\n    \"\"\"\n    Computes the finite-time maximal Lyapunov exponent for the given magnetic field line model.\n    \"\"\"\n    if eps == 0.0:\n        return 0.0\n\n    eps_over_b0 = eps / b0\n\n    def rhs_func(pos, z):\n        arg = MODES[:, 0] * pos[0] + MODES[:, 1] * pos[1] + MODES[:, 2] * z\n        sines = np.sin(arg)\n        \n        dxdz = -eps_over_b0 * np.sum(MODES[:, 1] * NORM_INV * sines)\n        dydz =  eps_over_b0 * np.sum(MODES[:, 0] * NORM_INV * sines)\n        \n        return np.array([dxdz, dydz])\n\n    def rk4_step(r, z, h_step, f_rhs):\n        k1 = f_rhs(r, z)\n        k2 = f_rhs(r + 0.5 * h_step * k1, z + 0.5 * h_step)\n        k3 = f_rhs(r + 0.5 * h_step * k2, z + 0.5 * h_step)\n        k4 = f_rhs(r + h_step * k3, z + h_step)\n        return r + (h_step / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\n    def min_image_diff(r_vec2, r_vec1):\n        diff = r_vec2 - r_vec1\n        diff = (diff + np.pi) % (2 * np.pi) - np.pi\n        return diff\n\n    r1 = np.array([x0, y0], dtype=float)\n    r2 = np.array([x0 + delta0, y0], dtype=float)\n    \n    log_stretching_sum = 0.0\n    z_current = 0.0\n    \n    num_steps = int(round(T / h))\n\n    for i in range(1, num_steps + 1):\n        r1_new = rk4_step(r1, z_current, h, rhs_func)\n        r2_new = rk4_step(r2, z_current, h, rhs_func)\n        \n        r1 = r1_new % (2 * np.pi)\n        r2 = r2_new % (2 * np.pi)\n        \n        z_current += h\n        \n        if i % nr == 0:\n            diff_vec = min_image_diff(r2, r1)\n            dist = np.linalg.norm(diff_vec)\n            \n            if dist > 1e-15:\n                log_stretching_sum += np.log(dist / delta0)\n                r2 = r1 + (diff_vec / dist) * delta0\n                r2 = r2 % (2 * np.pi)\n\n    if num_steps > 0 and num_steps % nr != 0:\n        diff_vec = min_image_diff(r2, r1)\n        dist = np.linalg.norm(diff_vec)\n        if dist > 1e-15:\n            log_stretching_sum += np.log(dist / delta0)\n\n    if T > 0:\n      lyap_exp = log_stretching_sum / T\n    else:\n      lyap_exp = 0.0\n\n    return lyap_exp\n\ndef solve():\n    test_cases = [\n        (0.0, 1.0, 50.0, 0.02, 1e-6, 5, 0.31, 0.27),\n        (0.1, 1.0, 200.0, 0.02, 1e-6, 5, 0.31, 0.27),\n        (0.4, 1.0, 200.0, 0.02, 1e-6, 5, 0.31, 0.27),\n        (0.1, 1.0, 5.0, 0.02, 1e-6, 5, 0.31, 0.27),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = compute_lyapunov(*case_params)\n        results.append(result)\n\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3720061"}, {"introduction": "我们已经学习了如何识别和量化磁力线的混沌特性，但其最终的物理影响是什么？最重要的后果便是它极大地增强了等离子体中粒子和热量的径向输运。这个实践练习[@problem_id:3720053]将理论与应用完美结合，它首先引导你利用统计力学的基石——Green-Kubo关系，从随机磁场的统计特性中推导出著名的Rechester-Rosenbluth扩散系数。然后，你将把这个系数应用于一个实际的输运问题中，通过求解一维扩散方程来计算穿过磁分界线附近随机层的粒子通量，从而将微观的场线混沌与宏观的输运现象直接联系起来。", "problem": "在一个与核聚变相关的环形磁约束装置中，假设邻近磁分界面处一个宽度为 $w$ 的窄层受到随机扰动，使得磁力线表现出径向漂移。考虑将电子导向中心视为无源示踪物，其沿着磁力线以近似为分界面处电子热速度的平行速度运动，并且其跨场运动仅由磁力线的随机性引起。该层内的径向坐标为 $x \\in [0,w]$，其中 $x=0$ 位于分界面处（核心等离子体一侧），$x=w$ 位于一个完全吸收壁处。\n\n假设以下具有物理动机的假说：\n- 瞬时径向导向中心速度可写为 $v_{r}(t) = v_{\\parallel}\\,\\delta b(t)$，其中 $v_{\\parallel}$ 是电子平行速度，而 $\\delta b(t) \\doteq \\delta B_{\\perp}(t)/B$ 是一个表示归一化垂直磁扰动的零均值平稳随机过程。\n- 过程 $\\delta b(t)$ 的方差为 $\\langle \\delta b^{2} \\rangle = (\\delta B/B)^{2}$，并具有指数自相关 $\\langle \\delta b(0)\\,\\delta b(t) \\rangle = (\\delta B/B)^{2}\\exp(-|t|/\\tau_{c})$，其相关时间 $\\tau_{c} \\doteq L_{c}/v_{\\parallel}$ 由平行相关长度 $L_{c}$ 决定。\n- 从将扩散系数表示为速度自相关函数时间积分的 Green–Kubo 关系出发，推导由随机磁场产生的有效跨场粒子扩散系数 $D$，并用 $v_{\\parallel}$、$L_{c}$ 和 $\\delta B/B$ 表示。\n\n在随机层中，将电子粒子密度 $n(x)$ 建模为在具有恒定扩散系数 $D$ 且无体积源或汇的一维（1D）稳态跨场扩散作用下演化，因此稳态满足 $0 = \\frac{d}{dx}\\!\\left(D\\,\\frac{dn}{dx}\\right)$。施加边界条件：在分界面处为 $n(0)=n_{\\text{sep}}$（Dirichlet 条件，由与核心等离子体的快速平行平衡固定），在壁面处为 $n(w)=0$（完全吸收体）。据此确定壁面处的外向粒子通量密度 $\\Gamma_{w}$。\n\n使用以下参数：\n- 分界面处的电子温度 $T_{e} = 2.0\\,\\text{keV}$（将 $T_{e}$ 视为能量，因此 $k_{B}T_{e}$ 通过基本电荷与以焦耳为单位的 $T_{e}$ 等同）。\n- 基本电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}$。\n- 电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}$。\n- 相对磁扰动幅度 $\\delta B/B = 1.0 \\times 10^{-3}$。\n- 平行相关长度 $L_{c} = 15\\,\\text{m}$。\n- 随机层宽度 $w = 0.020\\,\\text{m}$。\n- 分界面密度 $n_{\\text{sep}} = 5.0 \\times 10^{19}\\,\\text{m}^{-3}$。\n\n取 $v_{\\parallel}$ 等于电子热速度 $v_{\\text{th},e} \\doteq \\sqrt{2 T_{e} e / m_{e}}$。将壁面处外向粒子通量密度 $\\Gamma_{w}$ 的最终数值以 $\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示，并将答案四舍五入至三位有效数字。", "solution": "问题陈述经评估有效。其科学基础是等离子体物理和磁约束聚变原理，特别是关于随机磁场中的粒子输运。该问题是良定的，具有明确定义的物理模型、控制方程和边界条件，可以得到唯一解。给定的参数对于托卡马克边界等离子体而言是物理上现实的。语言客观而精确。因此，将推导求解。\n\n该问题分两个主要部分解决：首先，推导有效跨场粒子扩散系数 $D$；其次，计算壁面处的粒子通量密度 $\\Gamma_w$。\n\n**第一部分：跨场粒子扩散系数 $D$ 的推导**\n\nGreen–Kubo 关系为扩散系数提供了一个通用表达式，即速度自相关函数的时间积分。对于径向扩散系数 $D$，该关系为：\n$$\nD = \\int_{0}^{\\infty} \\langle v_r(0) v_r(t) \\rangle \\, dt\n$$\n其中 $v_r(t)$ 是粒子导向中心的瞬时径向速度，$\\langle \\dots \\rangle$ 表示对平稳随机过程的系综平均。\n\n问题陈述中指出径向速度由 $v_r(t) = v_{\\parallel} \\delta b(t)$ 给出，其中 $v_{\\parallel}$ 是恒定的电子平行速度，$\\delta b(t)$ 是归一化的垂直磁扰动。将此代入 Green–Kubo 公式，我们得到：\n$$\nD = \\int_{0}^{\\infty} \\langle (v_{\\parallel} \\delta b(0)) (v_{\\parallel} \\delta b(t)) \\rangle \\, dt\n$$\n由于 $v_{\\parallel}$ 是一个常数，可以将其从系综平均中提出：\n$$\nD = v_{\\parallel}^2 \\int_{0}^{\\infty} \\langle \\delta b(0) \\delta b(t) \\rangle \\, dt\n$$\n问题中指定了随机过程 $\\delta b(t)$ 的自相关函数为：\n$$\n\\langle \\delta b(0) \\delta b(t) \\rangle = \\left(\\frac{\\delta B}{B}\\right)^2 \\exp\\left(-\\frac{|t|}{\\tau_c}\\right)\n$$\n其中 $(\\delta B/B)$ 是相对磁扰动幅度，$\\tau_c$ 是相关时间。\n\n将此代入 $D$ 的表达式，并注意到积分区间为 $t \\ge 0$（因此 $|t|=t$）：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\, dt\n$$\n该积分为一个标准指数积分：\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\, dt = \\left[ -\\tau_c \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\right]_{0}^{\\infty} = -\\tau_c(0 - 1) = \\tau_c\n$$\n因此，扩散系数为：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\tau_c\n$$\n问题进一步提供了关系式 $\\tau_c = L_c / v_{\\parallel}$，其中 $L_c$ 是平行相关长度。用此式代入 $\\tau_c$：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\left(\\frac{L_c}{v_{\\parallel}}\\right)\n$$\n这可以简化为扩散系数的最终表达式，通常称为 Rechester-Rosenbluth 扩散系数：\n$$\nD = v_{\\parallel} L_c \\left(\\frac{\\delta B}{B}\\right)^2\n$$\n\n**第二部分：外向粒子通量密度 $\\Gamma_w$ 的计算**\n\n随机层中的稳态一维粒子守恒方程为：\n$$\n\\frac{d}{dx}\\left(D \\frac{dn}{dx}\\right) = 0\n$$\n其中 $n(x)$ 是电子粒子密度，$x \\in [0,w]$ 是径向坐标。\n\n由于上面推导的扩散系数 $D$ 相对于位置 $x$ 是恒定的，方程简化为：\n$$\nD \\frac{d^2n}{dx^2} = 0 \\quad \\implies \\quad \\frac{d^2n}{dx^2} = 0\n$$\n这个二阶常微分方程的通解是 $x$ 的一个线性函数：\n$$\nn(x) = C_1 x + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件确定的积分常数。\n\n边界条件为：\n1.  在分界面处 ($x=0$)：$n(0) = n_{\\text{sep}}$\n2.  在壁面处 ($x=w$)：$n(w) = 0$\n\n应用第一个边界条件：\n$$\nn(0) = C_1(0) + C_2 = n_{\\text{sep}} \\quad \\implies \\quad C_2 = n_{\\text{sep}}\n$$\n应用第二个边界条件：\n$$\nn(w) = C_1 w + C_2 = 0 \\quad \\implies \\quad C_1 w + n_{\\text{sep}} = 0 \\quad \\implies \\quad C_1 = -\\frac{n_{\\text{sep}}}{w}\n$$\n因此，随机层内的密度分布为：\n$$\nn(x) = -\\frac{n_{\\text{sep}}}{w} x + n_{\\text{sep}} = n_{\\text{sep}}\\left(1 - \\frac{x}{w}\\right)\n$$\n粒子通量密度 $\\Gamma(x)$ 由菲克第一扩散定律给出：\n$$\n\\Gamma(x) = -D \\frac{dn}{dx}\n$$\n计算密度梯度：\n$$\n\\frac{dn}{dx} = \\frac{d}{dx}\\left[n_{\\text{sep}}\\left(1 - \\frac{x}{w}\\right)\\right] = -\\frac{n_{\\text{sep}}}{w}\n$$\n将此代入通量表达式：\n$$\n\\Gamma(x) = -D \\left(-\\frac{n_{\\text{sep}}}{w}\\right) = \\frac{D n_{\\text{sep}}}{w}\n$$\n正如在没有内部源或汇的稳态下所预期的那样，整个层中的通量是恒定的。壁面处的外向粒子通量密度 $\\Gamma_w$ 即为此恒定值：\n$$\n\\Gamma_w = \\frac{D n_{\\text{sep}}}{w}\n$$\n代入第一部分中 $D$ 的表达式：\n$$\n\\Gamma_w = \\frac{v_{\\parallel} L_c \\left(\\frac{\\delta B}{B}\\right)^2 n_{\\text{sep}}}{w}\n$$\n\n**第三部分：数值计算**\n\n现在我们将给定的数值代入 $\\Gamma_w$ 的最终表达式中。\n\n首先，计算电子平行速度 $v_{\\parallel}$，其值取为电子热速度 $v_{\\text{th},e}$。问题中指出 $v_{\\text{th},e} \\doteq \\sqrt{2 T_{e} e / m_{e}}$，其中 $T_e = 2.0\\,\\text{keV}$ 被解释为能量。以焦耳为单位的能量是 $E = (2.0 \\times 10^3\\,\\text{eV}) \\times e = (2.0 \\times 10^3) \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}) \\approx 3.204 \\times 10^{-16}\\,\\text{J}$。\n\n使用提供的常数：\n$T_e e = (2.0 \\times 10^3) \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\text{J}) = 3.204\\,353\\,268 \\times 10^{-16}\\,\\text{J}$\n$m_e = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}$\n\n$$\nv_{\\parallel} = \\sqrt{\\frac{2 T_e e}{m_e}} = \\sqrt{\\frac{2 \\times (3.204\\,353\\,268 \\times 10^{-16}\\,\\text{J})}{9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}}} \\approx 2.652\\,382\\,9 \\times 10^7\\,\\text{m}\\,\\text{s}^{-1}\n$$\n\n现在，使用其余参数组合成 $\\Gamma_w$ 的表达式：\n$L_c = 15\\,\\text{m}$\n$\\delta B/B = 1.0 \\times 10^{-3}$\n$n_{\\text{sep}} = 5.0 \\times 10^{19}\\,\\text{m}^{-3}$\n$w = 0.020\\,\\text{m}$\n\n$$\n\\Gamma_w = \\frac{(2.652\\,382\\,9 \\times 10^7\\,\\text{m}\\,\\text{s}^{-1}) \\times (15\\,\\text{m}) \\times (1.0 \\times 10^{-3})^2 \\times (5.0 \\times 10^{19}\\,\\text{m}^{-3})}{0.020\\,\\text{m}}\n$$\n$$\n\\Gamma_w = \\frac{(2.652\\,382\\,9 \\times 10^7) \\times 15 \\times (1.0 \\times 10^{-6}) \\times (5.0 \\times 10^{19})}{0.020} \\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n$$\n\\Gamma_w \\approx 9.946\\,436 \\times 10^{23}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n按要求将结果四舍五入至三位有效数字：\n$$\n\\Gamma_w \\approx 9.95 \\times 10^{23}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$", "answer": "$$\\boxed{9.95 \\times 10^{23}}$$", "id": "3720053"}]}