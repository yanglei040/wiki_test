{"hands_on_practices": [{"introduction": "成功的碎裂是弹丸注入（SPI）技术的第一步，它将单个大弹丸转化为用于缓解等离子体的碎片云。这项练习 ([@problem_id:3694990]) 将带领我们从第一性原理出发，运用动量守恒和能量守恒的基本定律，来估算弹丸撞击碎裂板后产生的碎片速度分布的关键统计特性。通过这个实践，你将学会如何将宏观的撞击过程与碎片的微观动力学联系起来，为理解碎片如何与等离子体相互作用奠定基础。", "problem": "一个用于托卡马克中破裂缓解的碎裂弹丸注入（SPI）的氘弹丸，以速度 $v$ 沿刚性固定碎裂靶的法线方向行进。该弹丸质量为 $m$，在撞击时碎裂成数量巨大（$N$个）的碎片。假设以下基于第一性原理的理想化条件：\n\n- 线性动量守恒适用于弹丸-靶-碎片系统。由于碎裂靶是刚性且固定的，它可以吸收净动量，因此碎片系综无需携带入射动量。\n- 定义碎裂效率 $\\eta \\in (0,1)$ 为入射弹丸动能中最终转化为碎片平动动能的部分；剩余部分耗散为靶的形变、热能和碎片内能激发。\n- 碎片速度呈各向同性分布，可被建模为系综平均值为零、且在每个笛卡尔分量上具有相等方差 $\\sigma^{2}$ 的独立同分布随机矢量。设入射方向为 $+x$ 轴。\n\n仅从线性动量守恒、动能的定义以及所述的建模假设出发，推导碎片速度分布的 $x$ 分量的均值和方差的解析表达式。以一个包含两个条目 $\\big[$均值, 方差$\\big]$ 的行矩阵形式给出最终答案。均值以 $\\mathrm{m/s}$ 为单位，方差以 $(\\mathrm{m/s})^{2}$ 为单位表示。无需数值；用 $v$ 和 $\\eta$ 给出封闭形式的答案。", "solution": "该问题被验证为自洽、一致且有科学依据。这些假设虽然有些是冗余的（例如，各向同性意味着零均值和相等的分量方差），但并不矛盾，并允许得到唯一解。我们将着手推导碎片速度分布的 $x$ 分量的均值和方差。\n\n设碎片的矢量速度为随机矢量 $\\vec{v} = (v_x, v_y, v_z)$。问题陈述碎片速度呈各向同性分布。这意味着速度的概率密度函数 (PDF)，记作 $f(\\vec{v})$，仅是速率 $|\\vec{v}|$ 的函数。即，对于某个函数 $g$，$f(\\vec{v}) = g(|\\vec{v}|) = g(\\sqrt{v_x^2 + v_y^2 + v_z^2})$。\n\n首先，我们推导碎片速度 $x$ 分量的均值，记作 $\\langle v_x \\rangle$。这是 $v_x$ 在分布 $f(\\vec{v})$ 上的期望值。\n$$ \\langle v_x \\rangle = \\iiint_{\\mathbb{R}^3} v_x f(\\vec{v}) \\,dv_x \\,dv_y \\,dv_z $$\n代入各向同性的 PDF 形式：\n$$ \\langle v_x \\rangle = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} v_x \\, g(\\sqrt{v_x^2 + v_y^2 + v_z^2}) \\,dv_x \\,dv_y \\,dv_z $$\n对于任意固定的 $v_y$ 和 $v_z$ 值，被积函数作为 $v_x$ 的函数是一个奇函数，因为 $v_x$ 是奇函数，而 $g(\\sqrt{v_x^2 + \\text{常数}})$ 是 $v_x$ 的偶函数。奇函数在对称区间 $(-\\infty, \\infty)$ 上的积分为零。因此：\n$$ \\langle v_x \\rangle = 0 $$\n这个结果与问题中对速度矢量“系综平均值为零”的明确假设是一致的，因为 $\\langle \\vec{v} \\rangle = \\vec{0}$ 意味着 $\\langle v_x \\rangle = 0$。\n\n接下来，我们推导碎片速度 $x$ 分量的方差，记作 $\\sigma_x^2$。方差定义为：\n$$ \\sigma_x^2 = \\langle (v_x - \\langle v_x \\rangle)^2 \\rangle $$\n由于我们已经证明 $\\langle v_x \\rangle = 0$，方差简化为速度分量平方的均值：\n$$ \\sigma_x^2 = \\langle v_x^2 \\rangle $$\n速度分布的各向同性也意味着笛卡尔分量之间的对称性。均方值必须相等：\n$$ \\langle v_x^2 \\rangle = \\langle v_y^2 \\rangle = \\langle v_z^2 \\rangle $$\n这在问题陈述中也作为一个明确的假设给出。碎片的均方速率是各均方分量之和：\n$$ \\langle |\\vec{v}|^2 \\rangle = \\langle v_x^2 + v_y^2 + v_z^2 \\rangle = \\langle v_x^2 \\rangle + \\langle v_y^2 \\rangle + \\langle v_z^2 \\rangle = 3 \\langle v_x^2 \\rangle $$\n代入 $\\sigma_x^2 = \\langle v_x^2 \\rangle$，我们得到：\n$$ \\langle |\\vec{v}|^2 \\rangle = 3\\sigma_x^2 $$\n现在我们使用关于能量转换的信息。质量为 $m$、速率为 $v$ 的弹丸的入射动能为：\n$$ K_{in} = \\frac{1}{2} m v^2 $$\n碎裂效率 $\\eta$ 是这部分能量中转化为碎片平动动能 $K_f$ 的比例：\n$$ K_f = \\eta K_{in} = \\frac{1}{2} \\eta m v^2 $$\n碎片的总动能也可以表示为单个碎片动能的总和。由于碎片被描述为独立同分布的，我们可以用速率平方的系综平均值 $\\langle |\\vec{v}|^2 \\rangle$ 来表示总动能。所有碎片的总质量为 $m$。总动能是动能的质量加权平均值，对于一个由独立同分布（i.i.d.）粒子组成的系统，这简化为：\n$$ K_f = \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle $$\n令 $K_f$ 的两个表达式相等：\n$$ \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle = \\frac{1}{2} \\eta m v^2 $$\n这就得到了碎片均方速率的表达式：\n$$ \\langle |\\vec{v}|^2 \\rangle = \\eta v^2 $$\n最后，我们将此结果代入我们先前连接 $\\langle |\\vec{v}|^2 \\rangle$ 和方差 $\\sigma_x^2$ 的方程中：\n$$ 3\\sigma_x^2 = \\eta v^2 $$\n解出 $x$ 分量的方差，我们得到：\n$$ \\sigma_x^2 = \\frac{\\eta v^2}{3} $$\n因此，我们仅使用所述的假设，推导出了碎片速度分布 $x$ 分量的均值和方差。均值为 $0 \\, \\mathrm{m/s}$，方差为 $\\frac{\\eta v^2}{3} \\, (\\mathrm{m/s})^2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\eta v^2}{3}\n\\end{pmatrix}\n}\n$$", "id": "3694990"}, {"introduction": "理想的弹丸注入需要将弹丸完全碎裂成微小碎片，但如果碎裂不完全，产生的巨大碎片将对聚变装置构成严重威胁。本练习 ([@problem_id:3695062]) 模拟了这样一个“最坏情况”：一个大的碎片穿过等离子体并直接撞击到装置的内壁。通过建立一个烧蚀模型来计算碎片的存活情况，并估算其撞击时在壁上产生的局部热通量，你将能深刻理解为何保证弹丸的碎裂效率至关重要，并学会如何量化评估这种失效模式带来的风险。", "problem": "在向托卡马克进行Shattered Pellet Injection (SPI)过程中，由不完全破碎产生的球形碎片被认为会保持相对完整并深入穿透。考虑一个初始半径为$r_0$、密度为$\\rho$的单一氖碎片（固态），以速度$v_0$从外中平面弹道式地朝内壁行进。在碎片的渡越过程中，面向等离子体的边缘区域向其表面提供了一个大小近似为$\\Phi_e$的均匀电子能量通量。假设为能量限制烧蚀：烧蚀功率等于碎片表面吸收的电子能量，并且烧蚀氖所需的比能为$H_{\\mathrm{eff}}$（包括加热和潜热效应）。将碎片视为瞬时半径为$r(t)$的球体，忽略碎片的减速和磁力（碎片是中性的且呈弹道式运动），并在此估算中忽略$\\Phi_e$沿路径的变化。\n\n使用基本原理（烧蚀前沿的能量守恒和球体的几何关系），判断碎片是否能幸存到达内壁，如果能，则估算撞击时最大瞬时局部壁面热通量，假设所有剩余动能在碎片的投影接触面积$A_c$上以及在以速度$v_0$穿过厚度为$d$的近表面减速层所设定的相互作用时间$\\delta t$内被热化。取$A_c = \\pi r_{\\mathrm{res}}^2$和$\\delta t = d / v_0$，其中$r_{\\mathrm{res}}$是碎片在内壁处的剩余半径。最终答案以$\\mathrm{MW/m^2}$为单位表示，并四舍五入到三位有效数字。\n\n使用以下具有破坏缓解实验代表性的参数：\n- 初始碎片半径：$r_0 = 4.0 \\,\\mathrm{mm}$。\n- 氖密度（固态）：$\\rho = 1{,}440 \\,\\mathrm{kg/m^3}$。\n- 有效比烧蚀能：$H_{\\mathrm{eff}} = 1.2 \\times 10^{6} \\,\\mathrm{J/kg}$。\n- 到达碎片表面的电子能量通量：$\\Phi_e = 1.0 \\times 10^{9} \\,\\mathrm{W/m^2}$。\n- 弹道速率：$v_0 = 350 \\,\\mathrm{m/s}$。\n- 外壁到内壁的路径长度：$L = 1.10 \\,\\mathrm{m}$。\n- 近表面减速层厚度：$d = 3.0 \\,\\mathrm{mm}$。\n\n科学真实性条件：碎片是中性的，因此不受磁场线束缚；烧蚀受电子能量通量$\\Phi_e$的能量限制；在此估算中，假定等离子体参数在$L$范围内是均匀的；壁面接触面积取为碎片的瞬时投影面积；热通量是单位面积单位时间内的动能热化。\n\n将最大瞬时局部壁面热通量计算为单个实数，单位为$\\mathrm{MW/m^2}$，并四舍五入到三位有效数字。", "solution": "题目陈述首先需要进行验证。\n\n### 步骤1：提取已知条件\n- 初始碎片半径：$r_0 = 4.0 \\,\\mathrm{mm}$\n- 氖密度（固态）：$\\rho = 1{,}440 \\,\\mathrm{kg/m^3}$\n- 有效比烧蚀能：$H_{\\mathrm{eff}} = 1.2 \\times 10^{6} \\,\\mathrm{J/kg}$\n- 到达碎片表面的电子能量通量：$\\Phi_e = 1.0 \\times 10^{9} \\,\\mathrm{W/m^2}$\n- 弹道速率：$v_0 = 350 \\,\\mathrm{m/s}$\n- 外壁到内壁的路径长度：$L = 1.10 \\,\\mathrm{m}$\n- 近表面减速层厚度：$d = 3.0 \\,\\mathrm{mm}$\n- 碎片是瞬时半径为$r(t)$的球体。\n- 烧蚀是能量限制的。\n- 碎片运动是弹道式的（中性，在等离子体中不减速）。\n- $\\Phi_e$沿路径是均匀的。\n- 撞击时的壁面接触面积：$A_c = \\pi r_{\\mathrm{res}}^2$，其中$r_{\\mathrm{res}}$是剩余半径。\n- 撞击时的相互作用时间：$\\delta t = d / v_0$。\n- 壁面热通量是由于剩余动能在面积$A_c$和时间$\\delta t$内热化所致。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：问题描述了一个简化但标准的等离子体中弹丸烧蚀模型（“能量限制”或“无屏蔽”模型），这是聚变破坏缓解研究的核心课题。其基础物理学——能量守恒、运动学和热通量定义——都是基本的。所提供的参数代表了大型托卡马克的实验条件。该模型是一个有效的一阶近似。\n- **适定性**：问题定义明确，目标清晰。所有必要的参数和本构关系都已提供，可以推导出唯一的解。\n- **客观性**：问题使用精确的技术语言陈述，没有主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n该问题科学上合理、适定且客观。判定为**有效**。将推导解答。\n\n解答过程首先确定球形氖碎片的烧蚀速率，然后计算其到达内壁时的尺寸，最后计算撞击的动能沉积产生的局部热通量。\n\n基本原理是碎片表面的能量守恒。从等离子体电子通量吸收的功率$P_{\\mathrm{abs}}$等于烧蚀过程消耗的功率$P_{\\mathrm{ablate}}$。\n\n吸收功率是电子能量通量$\\Phi_e$和碎片表面积$4\\pi r(t)^2$的乘积：\n$$P_{\\mathrm{abs}} = \\Phi_e \\cdot (4\\pi r(t)^2)$$\n\n烧蚀功率是质量损失率$|\\frac{dm}{dt}|$乘以有效比烧蚀能$H_{\\mathrm{eff}}$。球形碎片的质量$m(t)$为$m(t) = \\rho \\frac{4}{3}\\pi r(t)^3$。质量的变化率为：\n$$\\frac{dm}{dt} = \\frac{d}{dt}\\left(\\rho \\frac{4}{3}\\pi r(t)^3\\right) = \\rho \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\n由于半径减小，$\\frac{dr}{dt}$为负，质量损失率$|\\frac{dm}{dt}| = -\\frac{dm}{dt}$。\n因此，烧蚀功率为：\n$$P_{\\mathrm{ablate}} = \\left|\\frac{dm}{dt}\\right| H_{\\mathrm{eff}} = -\\rho H_{\\mathrm{eff}} \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\n\n令吸收功率和烧蚀功率相等：\n$$\\Phi_e \\cdot 4\\pi r(t)^2 = -\\rho H_{\\mathrm{eff}} \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\n这可以简化为关于半径$r(t)$的一阶常微分方程：\n$$\\frac{dr}{dt} = -\\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}}$$\n半径的变化率是恒定的。我们可以将此方程从时间$t=0$（此时半径为$r_0$）积分到稍后的时间$t$：\n$$\\int_{r_0}^{r(t)} dr' = \\int_{0}^{t} -\\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}} dt'$$\n$$r(t) - r_0 = -\\frac{\\Phi_e t}{\\rho H_{\\mathrm{eff}}}$$\n半径作为时间的函数是：\n$$r(t) = r_0 - \\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}} t$$\n\n碎片以恒定的弹道速率$v_0$行进过路径长度$L$。渡越时间$t_{\\mathrm{transit}}$为：\n$$t_{\\mathrm{transit}} = \\frac{L}{v_0}$$\n代入给定值：\n$$t_{\\mathrm{transit}} = \\frac{1.10 \\,\\mathrm{m}}{350 \\,\\mathrm{m/s}} \\approx 3.14286 \\times 10^{-3} \\,\\mathrm{s}$$\n\n碎片到达内壁时的剩余半径$r_{\\mathrm{res}}$是$r(t_{\\mathrm{transit}})$：\n$$r_{\\mathrm{res}} = r_0 - \\frac{\\Phi_e L}{\\rho H_{\\mathrm{eff}} v_0}$$\n我们首先计算烧蚀掉的半径，这是一个正值$\\Delta r = r_0 - r_{\\mathrm{res}}$：\n$$\\Delta r = \\frac{\\Phi_e L}{\\rho H_{\\mathrm{eff}} v_0} = \\frac{(1.0 \\times 10^9 \\,\\mathrm{W/m^2}) (1.10 \\,\\mathrm{m})}{(1440 \\,\\mathrm{kg/m^3}) (1.2 \\times 10^6 \\,\\mathrm{J/kg}) (350 \\,\\mathrm{m/s})} \\approx 1.8188 \\times 10^{-3} \\,\\mathrm{m}$$\n这相当于$1.8188 \\,\\mathrm{mm}$。初始半径为$r_0 = 4.0 \\,\\mathrm{mm}$。\n剩余半径为：\n$$r_{\\mathrm{res}} = 4.0 \\,\\mathrm{mm} - 1.8188 \\,\\mathrm{mm} = 2.1812 \\,\\mathrm{mm} = 2.1812 \\times 10^{-3} \\,\\mathrm{m}$$\n由于$r_{\\mathrm{res}} > 0$，碎片在渡越过程中幸存下来并撞击到内壁。\n\n最大瞬时局部壁面热通量$q_{\\mathrm{wall}}$定义为在接触面积$A_c$和相互作用时间$\\delta t$内沉积的剩余动能$KE_{\\mathrm{res}}$：\n$$q_{\\mathrm{wall}} = \\frac{KE_{\\mathrm{res}}}{A_c \\delta t}$$\n剩余动能为$KE_{\\mathrm{res}} = \\frac{1}{2} m_{\\mathrm{res}} v_0^2$，其中$m_{\\mathrm{res}} = \\rho \\frac{4}{3}\\pi r_{\\mathrm{res}}^3$。\n$$KE_{\\mathrm{res}} = \\frac{1}{2}\\left(\\rho \\frac{4}{3}\\pi r_{\\mathrm{res}}^3\\right) v_0^2 = \\frac{2}{3} \\pi \\rho v_0^2 r_{\\mathrm{res}}^3$$\n问题将接触面积定义为$A_c = \\pi r_{\\mathrm{res}}^2$，相互作用时间定义为$\\delta t = d/v_0$。将这些代入$q_{\\mathrm{wall}}$的表达式中：\n$$q_{\\mathrm{wall}} = \\frac{\\frac{2}{3} \\pi \\rho v_0^2 r_{\\mathrm{res}}^3}{(\\pi r_{\\mathrm{res}}^2) (d/v_0)}$$\n对表达式进行代数化简：\n$$q_{\\mathrm{wall}} = \\frac{2 \\pi \\rho v_0^2 r_{\\mathrm{res}}^3}{3} \\frac{v_0}{\\pi d r_{\\mathrm{res}}^2} = \\frac{2 \\rho v_0^3 r_{\\mathrm{res}}}{3d}$$\n现在，我们将数值代入这个最终表达式。所有值都必须使用国际单位制（SI）基本单位。\n- $\\rho = 1440 \\,\\mathrm{kg/m^3}$\n- $v_0 = 350 \\,\\mathrm{m/s}$\n- $r_{\\mathrm{res}} \\approx 2.1812 \\times 10^{-3} \\,\\mathrm{m}$\n- $d = 3.0 \\,\\mathrm{mm} = 3.0 \\times 10^{-3} \\,\\mathrm{m}$\n\n$$q_{\\mathrm{wall}} = \\frac{2 \\cdot (1440 \\,\\mathrm{kg/m^3}) \\cdot (350 \\,\\mathrm{m/s})^3 \\cdot (2.1812 \\times 10^{-3} \\,\\mathrm{m})}{3 \\cdot (3.0 \\times 10^{-3} \\,\\mathrm{m})}$$\n$$q_{\\mathrm{wall}} = \\frac{2 \\cdot 1440 \\cdot 42875000 \\cdot (2.1812 \\times 10^{-3})}{9.0 \\times 10^{-3}} \\,\\mathrm{W/m^2}$$\n$$q_{\\mathrm{wall}} \\approx \\frac{2.685 \\times 10^{8}}{9.0 \\times 10^{-3}} \\,\\mathrm{W/m^2} \\approx 2.983 \\times 10^{10} \\,\\mathrm{W/m^2}$$\n问题要求答案以兆瓦/平方米（$\\mathrm{MW/m^2}$）为单位。由于$1 \\,\\mathrm{MW} = 10^6 \\,\\mathrm{W}$：\n$$q_{\\mathrm{wall}} \\approx \\frac{2.983 \\times 10^{10}}{10^6} \\,\\mathrm{MW/m^2} = 2.983 \\times 10^4 \\,\\mathrm{MW/m^2}$$\n四舍五入到三位有效数字，结果为$2.98 \\times 10^4 \\,\\mathrm{MW/m^2}$。\n\n让我们用更高的精度重新计算以确保舍入的准确性。\n$r_{\\mathrm{res}} = 0.004 - \\frac{1.1 \\times 10^9}{1440 \\times 1.2 \\times 10^6 \\times 350} = \\frac{1}{250} - \\frac{11}{6048} = \\frac{1649}{756000} \\approx 2.1812169 \\times 10^{-3} \\,\\mathrm{m}$。\n$q_{\\mathrm{wall}} = \\frac{2 \\cdot 1440 \\cdot 350^3}{3 \\cdot 0.003} \\left(\\frac{1649}{756000}\\right) = (1.372 \\times 10^{13}) \\left(\\frac{1649}{756000}\\right) \\approx 2.9926 \\times 10^{10} \\,\\mathrm{W/m^2}$。\n以$\\mathrm{MW/m^2}$为单位，结果是$29926 \\,\\mathrm{MW/m^2}$。\n四舍五入到三位有效数字得到$29900 \\,\\mathrm{MW/m^2}$，即$2.99 \\times 10^4 \\,\\mathrm{MW/m^2}$。", "answer": "$$\\boxed{2.99 \\times 10^4}$$", "id": "3695062"}, {"introduction": "在理解了单个碎片的基本物理过程之后，我们需要转向一个系统性的工程问题：对于像ITER这样的反应堆级托卡马克，究竟需要注入多少杂质才能有效缓解破坏？这项综合性实践 ([@problem_id:3695067]) 要求你建立一个零维（0D）全局模型，将等离子体热能、辐射冷却、杂质同化效率和密度提升等多个物理概念整合在一起。通过这个练习，你将学会如何利用简化的物理模型来解答关键的工程设计问题，并将基于物理原理的计算结果与当前装置的经验定标律进行比较，从而体验从基础物理到工程应用的完整过程。", "problem": "为国际热核聚变实验堆（ITER）中的杂质碎屑丸注入（SPI）实现一个零维（0D）破裂缓解模型。目标是计算能够同时满足热淬熄期间的目标辐射能量份额和目标热淬熄后自由电子密度的最小注入杂质质量，并将此基于模型的质量与一个简单的、基于当前装置热能注入质量的线性定标律进行比较。\n\n必须使用的假设和基本原理：\n- 使用第一性原理能量衡算和光学薄等离子体辐射。在 $T_{\\text{e},0} \\approx T_{\\text{i},0} \\equiv T_0$ 和主离子为单电荷的简化假设下，将总等离子体热能建模为 $W_{\\text{th}}$，因此准中性意味着 $n_{\\text{i},0} \\approx n_{\\text{e},0}$。一个一致的近似因此是\n$$\nW_{\\text{th}} \\approx 3\\, n_{\\text{e},0}\\, T_0\\, V,\n$$\n其中 $T_0$ 的单位是焦耳。\n- 目标辐射能量为 $E_{\\text{rad,target}} = f_{\\text{rad}}\\, W_{\\text{th}}$，其中 $f_{\\text{rad}} \\in (0,1)$。\n- 光学薄杂质线辐射功率密度为 $P_{\\text{rad}}/V = n_{\\text{e}}\\, n_z \\, \\overline{L}_z$，使用一个有效的、淬熄平均的冷却系数 $\\overline{L}_z$，单位为瓦特-米-立方。\n- 对注入到辐射的、载流的等离子体体积中的材料使用单一的吸收效率 $0 \\le \\eta \\le 1$，因此被吸收的杂质粒子数为 $\\eta\\, N_{\\text{inj}}$。\n- 在相关阶段，为杂质采用单一的有效电离度 $\\overline{Z}_{\\text{ion}}$，因此杂质贡献的自由电子密度为 $\\Delta n_{\\text{e}} \\approx \\eta\\, N_{\\text{inj}} \\, \\overline{Z}_{\\text{ion}}/V$。\n- 假设一个特征热淬熄时间 $ \\tau_{\\text{TQ}}$，在此期间辐射以适用于缓解目标的代表性电子密度 $n_{\\text{e,avg}}$ 起作用。\n\n必需的推导目标，仅基于上述基础（不要使用任何上述未说明的预设工程关联式）：\n- 从 $P_{\\text{rad}} = n_{\\text{e}}\\, n_z \\, \\overline{L}_z \\, V$ 和吸收模型出发，通过将时间积分的辐射能量等同于 $E_{\\text{rad,target}}$，推导出关于 $N_{\\text{inj}}$ 的辐射约束。您的最终表达式必须用 $f_{\\text{rad}}$、$W_{\\text{th}}$、$\\eta$、$\\overline{L}_z$、$n_{\\text{e,avg}}$ 和 $\\tau_{\\text{TQ}}$ 表示。\n- 从自由电子密度要求 $n_{\\text{e,post}} \\ge n_{\\text{e},0} + \\Delta n_{\\text{e}}$ 出发，推导出关于 $N_{\\text{inj}}$ 的密度约束，用 $n_{\\text{e,post}}$、$n_{\\text{e},0}$、$V$、$\\eta$ 和 $\\overline{Z}_{\\text{ion}}$ 表示。\n- 所需的注入粒子数是辐射和密度要求中的最大值。使用杂质原子质量 $m_{\\text{atom}}$ 将此数值转换为质量。\n\n与当前装置定标的比较：\n- 定义一个简单的当前装置所需质量的线性定标律 $M_{\\text{scaled}}$，通过对以 $(W_{\\text{ref}}, M_{\\text{ref}}, f_{\\text{rad,ref}})$ 为特征的参考数据集进行归一化：\n$$\nM_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}}.\n$$\n- 计算无量纲比率 $r \\equiv M_{\\text{model}}/M_{\\text{scaled}}$。\n\n实现说明：\n- 实现一个程序，对于下面的测试套件中的每个测试用例，使用以电子伏特（eV）给出的 $T_0$ 通过转换 $1\\,\\text{eV} = e\\,\\text{J}$（其中 $e = 1.602176634\\times 10^{-19}\\,\\text{J/eV}$）计算 $W_{\\text{th}}$（单位为焦耳）。然后计算：\n    - $M_{\\text{model}}$（单位为克），根据辐射和密度约束中的最大值计算。\n    - $M_{\\text{scaled}}$（单位为克），根据参考定标计算。\n    - $r = M_{\\text{model}}/M_{\\text{scaled}}$。\n- 对于数值评估，使用 $n_{\\text{e,avg}} = n_{\\text{e,post}}$。\n\n单位和输出要求：\n- 以克为单位表示 $M_{\\text{model}}$，以克为单位表示 $M_{\\text{scaled}}$，将 $r$ 表示为无量纲浮点数。将所有输出四舍五入到三位有效数字。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，每个测试用例的结果是一个包含三个浮点数的列表，顺序为 $[M_{\\text{model}}\\ \\text{(g)}, M_{\\text{scaled}}\\ \\text{(g)}, r]$。\n\n测试套件（每个用例是一个参数元组，顺序为：杂质质量 $m_{\\text{atom}}$ (kg)，有效电离度 $\\overline{Z}_{\\text{ion}}$ (无量纲)，$\\overline{L}_z$ (W m$^3$)，吸收效率 $\\eta$ (无量纲)，初始电子密度 $n_{\\text{e},0}$ (m$^{-3}$)，初始温度 $T_0$ (eV)，体积 $V$ (m$^3$)，目标辐射份额 $f_{\\text{rad}}$ (无量纲)，淬熄后密度目标 $n_{\\text{e,post}}$ (m$^{-3}$)，热淬熄时间 $\\tau_{\\text{TQ}}$ (s)，参考 $W_{\\text{ref}}$ (J)，参考 $M_{\\text{ref}}$ (g)，参考 $f_{\\text{rad,ref}}$ (无量纲)）：\n- 用例 A（类氖，ITER 基线）：\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.2000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.9$,\n    - $n_{\\text{e,post}} = 5.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 3.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- 用例 B（类氩，中度缓解，辐射主导）：\n    - $m_{\\text{atom}} = 6.6335\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 10$,\n    - $\\overline{L}_z = 3.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.0000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.7$,\n    - $n_{\\text{e,post}} = 1.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 5.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 1.5\\times 10^{6}$,\n    - $M_{\\text{ref}} = 15.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- 用例 C（类氖，密度主导，具有高 $n_{\\text{e,post}}$ 和较低吸收效率）：\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.2$,\n    - $n_{\\text{e},0} = 6.0\\times 10^{19}$,\n    - $T_0 = 1.5000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.6$,\n    - $n_{\\text{e,post}} = 1.5\\times 10^{21}$,\n    - $\\tau_{\\text{TQ}} = 2.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n\n角度单位不适用。输出中不含百分比。确保最终打印的行严格匹配所需格式：一个单独的列表，其中每个测试用例包含一个子列表，按所述顺序排列，每个浮点数四舍五入到三位有效数字，且 $M_{\\text{model}}$ 和 $M_{\\text{scaled}}$ 的单位为克。", "solution": "用户提供了一个有效的、适定的等离子体物理问题。任务是开发一个用于ITER中通过碎屑丸注入（SPI）进行破裂缓解所需杂质质量的零维（0D）模型，并将其与一个简单的线性定标律进行比较。\n\n解决方案流程如下：\n首先，我们建立初始等离子体热能 $W_{\\text{th}}$ 的基本量。\n其次，我们推导注入杂质原子数 $N_{\\text{inj}}$ 的两个约束条件：一个来自辐射掉目标热能份额的要求（辐射约束），另一个来自将等离子体自由电子密度提高到目标值的要求（密度约束）。\n第三，我们确定满足这两个约束的最小所需 $N_{\\text{inj}}$，并将其转换为模型预测质量 $M_{\\text{model}}$。\n第四，我们计算由简单线性定标律预测的质量 $M_{\\text{scaled}}$。\n最后，我们计算比率 $r = M_{\\text{model}} / M_{\\text{scaled}}$。\n\n**1. 等离子体热能**\n问题在电子和离子温度相等（$T_{\\text{e},0} \\approx T_{\\text{i},0} \\equiv T_0$）以及准中性及单电荷主离子（$n_{\\text{i},0} \\approx n_{\\text{e},0}$）的假设下，定义了初始等离子体热能 $W_{\\text{th}}$。总动能是电子和离子能量的总和：\n$$ W_{\\text{th}} = \\frac{3}{2} N_{\\text{e}} k_B T_{\\text{e},0} + \\frac{3}{2} N_{\\text{i}} k_B T_{\\text{i},0} $$\n其中 $N_{\\text{e}} = n_{\\text{e},0} V$ 和 $N_{\\text{i}} = n_{\\text{i},0} V$ 分别是等离子体体积 $V$ 中的总电子数和总离子数。根据假设，这简化为：\n$$ W_{\\text{th}} \\approx \\frac{3}{2} (n_{\\text{e},0}V) k_B T_0 + \\frac{3}{2} (n_{\\text{e},0}V) k_B T_0 = 3 n_{\\text{e},0} V (k_B T_0) $$\n问题以电子伏特（$\\text{eV}$）为单位提供 $T_0$，并指定公式 $W_{\\text{th}} \\approx 3 n_{\\text{e},0} T_0 V$，其中 $T_0$ 的单位是焦耳。如果我们将公式中的 $T_0$ 视为以能量单位表示的温度，这是一致的。因此，必须使用基本电荷 $e$ 将以 $\\text{eV}$ 为单位的温度转换为焦耳：\n$$ T_0 \\, [\\text{J}] = T_0 \\, [\\text{eV}] \\times e $$\n其中 $e \\approx 1.602176634 \\times 10^{-19} \\, \\text{J/eV}$。\n热能的最终表达式为：\n$$ W_{\\text{th}} = 3 \\, n_{\\text{e},0} \\, (T_0[\\text{eV}] \\times e) \\, V $$\n\n**2. 对注入粒子数的辐射约束**\n目标是在热淬熄时间 $\\tau_{\\text{TQ}}$ 内辐射掉目标能量 $E_{\\text{rad,target}} = f_{\\text{rad}} W_{\\text{th}}$。辐射功率来自注入杂质的光学薄线辐射。功率密度由 $P_{\\text{rad}}/V = n_{\\text{e}} n_z \\overline{L}_z$ 给出，其中 $n_z$ 是杂质密度，$\\overline{L}_z$ 是有效冷却系数。\n被吸收的杂质原子数为 $\\eta N_{\\text{inj}}$，其中 $\\eta$ 是吸收效率。因此，杂质密度为 $n_z = \\eta N_{\\text{inj}} / V$。\n总辐射功率为：\n$$ P_{\\text{rad}} = n_{\\text{e}} \\left( \\frac{\\eta N_{\\text{inj}}}{V} \\right) \\overline{L}_z V = n_{\\text{e}} \\, \\eta \\, N_{\\text{inj}} \\, \\overline{L}_z $$\n假设此功率在 $\\tau_{\\text{TQ}}$ 内恒定，并使用一个代表性的平均电子密度 $n_{\\text{e,avg}}$，总辐射能量为 $E_{\\text{rad}} = P_{\\text{rad}} \\times \\tau_{\\text{TQ}}$。令其等于目标辐射能量：\n$$ f_{\\text{rad}} W_{\\text{th}} = (n_{\\text{e,avg}} \\, \\eta \\, N_{\\text{inj,rad}} \\, \\overline{L}_z) \\, \\tau_{\\text{TQ}} $$\n问题指定使用 $n_{\\text{e,avg}} = n_{\\text{e,post}}$。求解为满足辐射约束所需的注入粒子数 $N_{\\text{inj,rad}}$，我们得到：\n$$ N_{\\text{inj,rad}} = \\frac{f_{\\text{rad}} W_{\\text{th}}}{\\eta \\, n_{\\text{e,post}} \\, \\overline{L}_z \\, \\tau_{\\text{TQ}}} $$\n\n**3. 对注入粒子数的密度约束**\n第二个约束是达到目标淬熄后自由电子密度 $n_{\\text{e,post}}$。最终电子密度是初始密度 $n_{\\text{e},0}$ 和由电离杂质贡献的电子 $\\Delta n_{\\text{e}}$ 的总和。最低要求是：\n$$ n_{\\text{e,post}} = n_{\\text{e},0} + \\Delta n_{\\text{e}} $$\n由杂质引起的电子密度增加由 $\\Delta n_{\\text{e}} = \\eta N_{\\text{inj}} \\overline{Z}_{\\text{ion}} / V$ 给出，其中 $\\overline{Z}_{\\text{ion}}$ 是杂质的有效电离态。将此代入密度平衡方程：\n$$ n_{\\text{e,post}} - n_{\\text{e},0} = \\frac{\\eta N_{\\text{inj,dens}} \\overline{Z}_{\\text{ion}}}{V} $$\n求解为满足密度约束所需的注入粒子数 $N_{\\text{inj,dens}}$，得到：\n$$ N_{\\text{inj,dens}} = \\frac{(n_{\\text{e,post}} - n_{\\text{e},0}) V}{\\eta \\overline{Z}_{\\text{ion}}} $$\n该值仅在 $n_{\\text{e,post}} > n_{\\text{e},0}$ 时具有物理意义，这对所有测试用例都成立。\n\n**4. 基于模型的注入质量，$M_{\\text{model}}$**\n为同时满足辐射和密度要求，注入的粒子数 $N_{\\text{inj}}$ 必须足以满足两个约束中要求更严格的一个。因此，我们必须取两个推导值的最大值：\n$$ N_{\\text{inj}} = \\max(N_{\\text{inj,rad}}, N_{\\text{inj,dens}}) $$\n模型预测质量 $M_{\\text{model}}$ 是注入的总粒子数乘以杂质种类的原子质量 $m_{\\text{atom}}$。结果从千克转换为克。\n$$ M_{\\text{model}} \\, [\\text{g}] = (N_{\\text{inj}} \\times m_{\\text{atom}} \\, [\\text{kg}]) \\times 1000 $$\n\n**5. 定标注入质量，$M_{\\text{scaled}}$，及比率 $r$**\n问题定义了一个简单的线性定标律以供比较，基于一个参考装置或数据集：\n$$ M_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}} $$\n其中 ($W_{\\text{ref}}$, $M_{\\text{ref}}$, $f_{\\text{rad,ref}}$) 是参考用例的热能、注入质量和辐射份额。\n最后，计算无量纲比率 $r$：\n$$ r = \\frac{M_{\\text{model}}}{M_{\\text{scaled}}} $$\n\n该实现将对每个测试用例执行这些计算，将 $M_{\\text{model}}$、$M_{\\text{scaled}}$ 和 $r$ 的最终值四舍五入到三位有效数字，并以指定格式呈现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes a 0D model for shattered pellet injection in ITER,\n    compares it to a linear scaling, and formats the output.\n    \"\"\"\n\n    # Elementary charge in J/eV\n    e_charge = 1.602176634e-19\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A (Neon-like, ITER baseline)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.2000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.9,              # dimensionless\n            \"n_epost\": 5.0e20,         # m^-3\n            \"tau_TQ\": 3.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case B (Argon-like, moderate mitigation, radiation-dominated)\n        {\n            \"m_atom\": 6.6335e-26,      # kg\n            \"Z_ion\": 10,               # dimensionless\n            \"L_z\": 3.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.0000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.7,              # dimensionless\n            \"n_epost\": 1.0e20,         # m^-3\n            \"tau_TQ\": 5.0e-3,          # s\n            \"W_ref\": 1.5e6,            # J\n            \"M_ref\": 15.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case C (Neon-like, density-dominated with high n_epost and lower assimilation)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.2,                # dimensionless\n            \"n_e0\": 6.0e19,            # m^-3\n            \"T0\": 1.5000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.6,              # dimensionless\n            \"n_epost\": 1.5e21,         # m^-3\n            \"tau_TQ\": 2.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        }\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number x to sf significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sf - 1 - int(math.floor(math.log10(abs(x)))))\n\n    all_results = []\n    \n    for case in test_cases:\n        # Step 1: Calculate plasma thermal energy in Joules\n        T0_J = case[\"T0\"] * e_charge\n        W_th = 3 * case[\"n_e0\"] * T0_J * case[\"V\"]\n\n        # Step 2: Calculate the number of particles for the radiative constraint\n        N_inj_rad_denom = case[\"eta\"] * case[\"n_epost\"] * case[\"L_z\"] * case[\"tau_TQ\"]\n        N_inj_rad = (case[\"f_rad\"] * W_th) / N_inj_rad_denom\n\n        # Step 3: Calculate the number of particles for the density constraint\n        delta_n_e = case[\"n_epost\"] - case[\"n_e0\"]\n        if delta_n_e > 0:\n             N_inj_dens = (delta_n_e * case[\"V\"]) / (case[\"eta\"] * case[\"Z_ion\"])\n        else:\n            N_inj_dens = 0\n\n        # Step 4: Determine the required number of particles and the model mass\n        N_inj = max(N_inj_rad, N_inj_dens)\n        M_model_kg = N_inj * case[\"m_atom\"]\n        M_model_g = M_model_kg * 1000\n\n        # Step 5: Calculate the mass from the simple scaling law\n        M_scaled_g = case[\"M_ref\"] * (W_th / case[\"W_ref\"]) * (case[\"f_rad\"] / case[\"f_rad_ref\"])\n\n        # Step 6: Calculate the ratio\n        r = M_model_g / M_scaled_g\n\n        # Round results to three significant figures\n        M_model_rounded = round_to_sf(M_model_g, 3)\n        M_scaled_rounded = round_to_sf(M_scaled_g, 3)\n        r_rounded = round_to_sf(r, 3)\n\n        all_results.append([M_model_rounded, M_scaled_rounded, r_rounded])\n\n    # Format the final output string as requested\n    # e.g., [[val,val,val],[val,val,val]]\n    result_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3695067"}]}