{"hands_on_practices": [{"introduction": "格林瓦尔德极限为托卡马克运行中的线平均密度提供了一个重要的经验边界。然而，聚变等离子体并非均匀分布，其内部具有复杂的密度剖面。本练习将经验极限与具体的输运物理模型联系起来，让您能够亲手计算在给定宏观约束下，等离子体芯部所能达到的峰值密度，这对于理解和优化聚变反应率至关重要。通过求解一个简化的粒子输运方程[@problem_id:3694558]，您将深入探索扩散与内向箍缩效应如何共同决定密度剖面的形状。", "problem": "一个大环径比圆形托卡马克的主半径为 $R = 1.6 \\, \\text{m}$，小半径为 $a = 0.45 \\, \\text{m}$。环向等离子体电流为 $I_p = 1.30 \\, \\text{MA}$。电子温度在空间上均匀，为 $T_e = 3.0 \\, \\text{keV}$，有效电荷数为 $Z_{\\text{eff}} = 1$，库仑对数为 $\\ln \\Lambda = 17$。假设在 $0 \\le r \\le a$ 范围内具有轴对称性，并且粒子达到稳态平衡，体积粒子源可忽略不计。\n\n粒子通量由一维径向输运闭合模型建模，\n$$\n\\Gamma_n(r) \\equiv -D \\, \\frac{d n}{d r} + V_p \\, n,\n$$\n其中 $n(r)$ 是密度分布，$D > 0$ 是空间上恒定的湍流扩散系数，$V_p$ 是具有以下参数形式的向内新经典箍缩速度\n$$\nV_p = - D \\, \\frac{C_p \\, \\nu_*}{a},\n$$\n其中 $C_p = 0.9$ 是一个无量纲常数。电子碰撞率 $\\nu_*$ 在中半径 $r = a/2$ 处使用以下公式计算\n$$\n\\nu_* = \\frac{\\nu_{ei} \\, q \\, R}{\\epsilon^{3/2} \\, v_{\\text{th},e}},\n\\quad\n\\epsilon = \\frac{r}{R},\n\\quad\nv_{\\text{th},e} = \\sqrt{\\frac{2 k_B T_e}{m_e}},\n$$\n其中 $q = 2.2$ 是安全因子，$k_B$ 是玻尔兹曼常数，$m_e$ 是电子质量，$\\nu_{ei}$ 是电子-离子碰撞频率，其常用的工程形式为\n$$\n\\nu_{ei} = 2.91 \\times 10^{-6} \\, n_e \\, Z_{\\text{eff}} \\, \\ln \\Lambda \\, T_e^{-3/2},\n$$\n其中 $n_e$ 的单位是 $\\text{cm}^{-3}$，$T_e$ 的单位是 $\\text{eV}$。为计算 $\\nu_{ei}$，取 $n_e$ 等于运行极限下的弦平均密度。\n\n弦平均密度定义为\n$$\nn_L = \\frac{1}{a} \\int_{0}^{a} n(r) \\, dr.\n$$\n假设装置在经验密度极限下运行，因此 $n_L$ 等于给定 $I_p$ 和 $a$ 所对应的极限值。\n\n在这些假设下，导出输运模型所蕴含的稳态 $n(r)$，计算在 $r = a/2$ 处的碰撞率 $\\nu_*$，并确定与运行极限下的弦平均密度一致的中心密度 $n(0)$。将 $n(0)$ 的最终答案以 $10^{20} \\, \\text{m}^{-3}$ 为单位表示，并四舍五入至三位有效数字。", "solution": "此问题已经过验证。\n\n### 第1步：提取已知条件\n-   托卡马克几何参数：主半径 $R = 1.6 \\, \\text{m}$，小半径 $a = 0.45 \\, \\text{m}$。\n-   等离子体参数：环向电流 $I_p = 1.30 \\, \\text{MA}$，电子温度 $T_e = 3.0 \\, \\text{keV}$ (均匀)，有效电荷数 $Z_{\\text{eff}} = 1$，库仑对数 $\\ln \\Lambda = 17$，安全因子 $q = 2.2$。\n-   粒子输运模型：\n    -   粒子通量：$\\Gamma_n(r) = -D \\, \\frac{dn}{dr} + V_p \\, n$，其中 $D > 0$ 为常数。\n    -   箍缩速度：$V_p = - D \\, \\frac{C_p \\, \\nu_*}{a}$，其中 $C_p = 0.9$。\n-   碰撞率定义：$\\nu_*$ 在 $r = a/2$ 处使用公式 $\\nu_* = \\frac{\\nu_{ei} \\, q \\, R}{\\epsilon^{3/2} \\, v_{\\text{th},e}}$ 计算，其中 $\\epsilon = r/R$ 且 $v_{\\text{th},e} = \\sqrt{\\frac{2 k_B T_e}{m_e}}$。\n-   碰撞频率：$\\nu_{ei} = 2.91 \\times 10^{-6} \\, n_e \\, Z_{\\text{eff}} \\, \\ln \\Lambda \\, T_e^{-3/2}$，其中 $n_e$ 单位为 $\\text{cm}^{-3}$，$T_e$ 单位为 $\\text{eV}$。为进行此计算，$n_e$ 取运行极限下的弦平均密度。\n-   条件：稳态粒子平衡 ($\\nabla \\cdot \\vec{\\Gamma}_n = 0$)，且在 $0 \\le r \\le a$ 范围内体积源可忽略不计。\n-   密度平均：弦平均密度定义为 $n_L = \\frac{1}{a} \\int_{0}^{a} n(r) \\, dr$。\n-   运行极限：装置的运行使得 $n_L$ 等于给定 $I_p$ 和 $a$ 下的经验密度极限。\n-   目标：求稳态分布 $n(r)$，在 $r=a/2$ 处的碰撞率 $\\nu_*$ 和中心密度 $n(0)$。$n(0)$ 的最终答案必须以 $10^{20} \\, \\text{m}^{-3}$ 为单位，并四舍五入到三位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，使用了托卡马克输运物理学的标准模型（扩散-对流，新经典碰撞率）。参数对于中型托卡马克是符合实际的。该问题是适定的；控制微分方程和边界/积分条件足以确定唯一解。短语“经验密度极限”在等离子体物理学中是一个标准的、无歧义的提法，指的是 Greenwald 极限，$n_G = I_p / (\\pi a^2)$，它为密度提供了必要的约束条件。所提供的弦平均密度 $n_L$ 的定义在数学上是精确的。不存在矛盾、歧义或事实错误。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n解答过程分为四个主要步骤：1) 根据运行极限确定弦平均密度 $n_L$；2) 从稳态输运方程推导密度分布 $n(r)$ 的函数形式；3) 计算决定分布形状的碰撞率 $\\nu_*$；4) 使用 $n_L$ 的定义求出中心密度 $n(0)$。\n\n**1. 运行极限下的弦平均密度**\n问题陈述装置在经验密度极限下运行，该极限即为 Greenwald 极限 $n_G$。因此，弦平均密度 $n_L$ 等于 $n_G$。\n$$ n_L = n_G = \\frac{I_p [\\text{MA}]}{\\pi (a [\\text{m}])^2} $$\n此 $n_G$ 公式的单位是 $10^{20} \\, \\text{m}^{-3}$。给定 $I_p = 1.30 \\, \\text{MA}$ 和 $a = 0.45 \\, \\text{m}$：\n$$ n_L = \\frac{1.30}{\\pi (0.45)^2} = \\frac{1.30}{\\pi (0.2025)} \\approx 2.04353 \\times 10^{20} \\, \\text{m}^{-3} $$\n\n**2. 稳态密度分布**\n在稳态且 $0 \\le r \\le a$ 范围内粒子源可忽略不计的情况下，粒子连续性方程 $\\frac{1}{r}\\frac{d}{dr}(r \\Gamma_n) = 0$ 意味着径向通量 $\\Gamma_n(r)$ 必须为零。非零通量会在 $r=0$ 处导致奇点。\n$$ \\Gamma_n(r) = -D \\, \\frac{dn}{dr} + V_p \\, n = 0 $$\n代入给定的箍缩速度表达式 $V_p = - D \\, \\frac{C_p \\, \\nu_*}{a}$：\n$$ -D \\, \\frac{dn}{dr} - D \\, \\frac{C_p \\, \\nu_*}{a} \\, n = 0 $$\n由于 $D > 0$，我们可以除以 $-D$：\n$$ \\frac{dn}{dr} + \\left( \\frac{C_p \\, \\nu_*}{a} \\right) n = 0 $$\n问题指定 $\\nu_*$ 在 $r=a/2$ 处计算并用于定义箍缩速度。这意味着在求解分布形状时，$\\nu_*$ 被视为一个常数。设常数尖峰参数为 $\\alpha_n = \\frac{C_p \\, \\nu_*(a/2)}{a}$。微分方程为 $\\frac{dn}{dr} = -\\alpha_n n$。这是一个可分离变量的方程，其解为：\n$$ n(r) = n(0) \\exp(-\\alpha_n r) = n(0) \\exp\\left(-\\frac{C_p \\, \\nu_*(a/2)}{a} r\\right) $$\n其中 $n(0)$ 是 $r=0$ 处的中心密度。这就是密度分布的函数形式。\n\n**3. 碰撞率计算**\n为了确定分布的形状，我们必须计算 $\\nu_*(a/2)$。这需要几个中间计算。\n首先，我们计算电子-离子碰撞频率 $\\nu_{ei}$。该公式要求 $n_e$ 的单位是 $\\text{cm}^{-3}$，$T_e$ 的单位是 $\\text{eV}$。我们使用 $n_e = n_L$。\n$$ n_L \\approx 2.04353 \\times 10^{20} \\, \\text{m}^{-3} = 2.04353 \\times 10^{14} \\, \\text{cm}^{-3} $$\n$$ T_e = 3.0 \\, \\text{keV} = 3000 \\, \\text{eV} $$\n在 $Z_{\\text{eff}} = 1$ 和 $\\ln\\Lambda = 17$ 的条件下：\n$$ \\nu_{ei} = (2.91 \\times 10^{-6}) \\times (2.04353 \\times 10^{14}) \\times (1) \\times (17) \\times (3000)^{-3/2} $$\n$$ \\nu_{ei} \\approx (1.0108 \\times 10^{10}) \\times (3000)^{-1.5} \\approx (1.0108 \\times 10^{10}) \\times (6.0858 \\times 10^{-6}) \\approx 61517.4 \\, \\text{s}^{-1} $$\n接下来，我们用 $T_e=3000 \\, \\text{eV}$ 计算电子热速度 $v_{\\text{th},e}$。注意 $k_B T_e = 3000 \\, \\text{eV} \\approx 4.8065 \\times 10^{-16} \\, \\text{J}$。\n$$ v_{\\text{th},e} = \\sqrt{\\frac{2 k_B T_e}{m_e}} = \\sqrt{\\frac{2 \\times (4.8065 \\times 10^{-16} \\, \\text{J})}{9.1094 \\times 10^{-31} \\, \\text{kg}}} \\approx 3.2486 \\times 10^7 \\, \\text{m/s} $$\n现在我们计算在 $r=a/2$ 处的碰撞率 $\\nu_*$。此处的反环径比为 $\\epsilon = \\frac{a/2}{R} = \\frac{0.45}{2 \\times 1.6} = 0.140625$。\n$$ \\nu_*(a/2) = \\frac{\\nu_{ei} \\, q \\, R}{\\epsilon^{3/2} \\, v_{\\text{th},e}} = \\frac{(61517.4 \\, \\text{s}^{-1}) \\times (2.2) \\times (1.6 \\, \\text{m})}{(0.140625)^{3/2} \\times (3.2486 \\times 10^7 \\, \\text{m/s})} $$\n$$ \\nu_*(a/2) \\approx \\frac{216781}{0.052734 \\times 3.2486 \\times 10^7} \\approx \\frac{216781}{1.7130 \\times 10^6} \\approx 0.12655 $$\n这是中半径处的碰撞率值。\n\n**4. 中心密度计算**\n密度分布的尖峰因子与无量纲参数 $\\alpha_n a$ 相关：\n$$ \\alpha_n a = C_p \\, \\nu_*(a/2) = 0.9 \\times 0.12655 \\approx 0.113895 $$\n我们使用给定的定义将中心密度 $n(0)$ 与弦平均密度 $n_L$ 联系起来：\n$$ n_L = \\frac{1}{a} \\int_{0}^{a} n(r) \\, dr = \\frac{1}{a} \\int_{0}^{a} n(0) \\exp(-\\alpha_n r) \\, dr $$\n$$ n_L = \\frac{n(0)}{a} \\left[ -\\frac{1}{\\alpha_n} \\exp(-\\alpha_n r) \\right]_0^a = \\frac{n(0)}{a\\alpha_n} (1 - \\exp(-a\\alpha_n)) $$\n求解 $n(0)$：\n$$ n(0) = n_L \\frac{a\\alpha_n}{1 - \\exp(-a\\alpha_n)} $$\n代入 $n_L$ 和 $a\\alpha_n$ 的值：\n$$ n(0) = (2.04353 \\times 10^{20} \\, \\text{m}^{-3}) \\times \\frac{0.113895}{1 - \\exp(-0.113895)} $$\n$$ n(0) \\approx (2.04353 \\times 10^{20}) \\times \\frac{0.113895}{1 - 0.89235} = (2.04353 \\times 10^{20}) \\times (1.0580) $$\n$$ n(0) \\approx 2.1619 \\times 10^{20} \\, \\text{m}^{-3} $$\n题目要求答案以 $10^{20} \\, \\text{m}^{-3}$ 为单位，并四舍五入至三位有效数字。\n$$ n(0) \\approx 2.16 \\times 10^{20} \\, \\text{m}^{-3} $$\n最终数值答案是 $2.16$。", "answer": "$$\n\\boxed{2.16}\n$$", "id": "3694558"}, {"introduction": "像格林瓦尔德标度律这样的经验法则是托卡马克运行物理的基石，但它们并非源于第一性原理，而是从大量的实验数据中提炼而成的。本次实践为您提供了一个宝贵的机会，让您扮演实验物理学家的角色，从原始数据出发，构建并验证一个密度极限的标度律。您将运用蒙特卡洛方法等现代统计技术来处理测量不确定性[@problem_id:3694567]，并最终对方程中的标度指数进行推断。掌握这种从数据中提取物理规律并进行不确定性量化的能力，对于解释实验结果和为未来聚变装置做出可靠预测至关重要。", "problem": "给定一个数据集，其中包含几次托卡马克放电的线平均密度极限测量值，以及相应的装置和等离子体参数。教育背景是核聚变，主题是与Greenwald型标度律相关的密度极限。目标是从第一性原理出发，建立一个有原则的经验回归模型，该模型能够量化测量噪声带来的不确定性，然后使用推断出的标度律对新的工作点进行预测，并给出保守的不确定性边界。\n\n从以下适用于磁流体动力学（MHD）的物理基础和定义出发。将每一项作为基本原理或定义使用，而不是作为目标标度律的快捷公式：\n- 静磁学中的安培定律：$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$，它将等离子体电流密度与磁场联系起来。\n- 环向等离子体电流 $I_p$ 产生极向磁场，影响磁流体动力学稳定性、电流剖面和约束。\n- 环向等离子体中的线平均密度 $n$ 反映了粒子库存和输运，并受到与电流和几何形状相关的稳定性及操作约束的限制。\n- 几何参数如小半径 $a$ 和拉长比 $\\kappa$ 影响有效横截面积和位形，而环向场 $B_T$ 影响约束和输运；这些因素促使我们采用一个可分离、量纲一致的幂律回归拟设，而不预先规定任何特定的指数值。\n\n基于这些原理，假设经验密度极限为一个可分离、正值的幂律模型，\n$$\nn_{\\text{lim}} = C \\, I_p^{\\alpha} \\, a^{\\beta} \\, B_T^{\\gamma} \\, \\kappa^{\\delta},\n$$\n其中 $C$ 是一个正常数，$(\\alpha,\\beta,\\gamma,\\delta)$ 是待从数据中推断的实指数；$I_p$ 是单位为 $\\mathrm{A}$ 的环向等离子体电流，$a$ 是单位为 $\\mathrm{m}$ 的小半径，$B_T$ 是单位为 $\\mathrm{T}$ 的环向磁场，$\\kappa$ 是无量纲的拉长比。取自然对数以获得关于未知参数的线性模型。你的程序必须在对数空间中执行加权线性回归，并通过对测量不确定性进行蒙特卡洛抽样来量化不确定性。然后必须根据推断出的标度律后验分布导出的保守边界进行预测性检验。\n\n数据说明。数据集包含 $12$ 次放电的测量量和相对标准差（假设每个量上的测量噪声是独立的、零均值的高斯噪声）。对于每次放电，给定 $(I_p, a, B_T, \\kappa, n_{\\text{lim}})$ 以及 $(s_I, s_a, s_B, s_\\kappa, s_n)$，其中 $s$ 值是相对标准差。所有密度 $n_{\\text{lim}}$ 的单位均为 $\\mathrm{m}^{-3}$。\n\n在你的程序中使用以下数据集：\n- 放电 $1$：$(I_p,a,B_T,\\kappa,n_{\\text{lim}}) = (7.0\\times 10^{5},\\,0.48,\\,2.4,\\,1.72,\\,4.75\\times 10^{20})$，$(s_I,s_a,s_B,s_\\kappa,s_n) = (0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $2$：$(1.2\\times 10^{6},\\,0.55,\\,2.8,\\,1.65,\\,6.26\\times 10^{20})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $3$：$(2.0\\times 10^{6},\\,0.60,\\,3.0,\\,1.80,\\,9.27\\times 10^{20})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $4$：$(3.5\\times 10^{6},\\,0.65,\\,3.5,\\,1.90,\\,1.465\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $5$：$(5.0\\times 10^{6},\\,0.70,\\,4.0,\\,1.95,\\,1.882\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $6$：$(9.0\\times 10^{5},\\,0.40,\\,2.2,\\,1.60,\\,8.31\\times 10^{20})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $7$：$(1.8\\times 10^{6},\\,0.50,\\,2.6,\\,1.75,\\,1.153\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $8$：$(7.0\\times 10^{6},\\,0.80,\\,5.0,\\,2.00,\\,2.134\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $9$：$(1.0\\times 10^{7},\\,0.78,\\,5.3,\\,1.85,\\,3.12\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $10$：$(1.2\\times 10^{7},\\,0.90,\\,5.3,\\,1.95,\\,2.888\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $11$：$(5.0\\times 10^{5},\\,0.30,\\,2.5,\\,1.50,\\,8.18\\times 10^{20})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n- 放电 $12$：$(3.0\\times 10^{6},\\,0.55,\\,3.2,\\,1.75,\\,1.653\\times 10^{21})$，$(0.03,\\,0.02,\\,0.03,\\,0.02,\\,0.10)$。\n\n算法要求和不确定性量化：\n- 通过自然对数将模型转换到对数空间，以获得参数 $(\\ln C,\\alpha,\\beta,\\gamma,\\delta)$ 的线性关系。\n- 执行加权线性回归，其中权重为 $w_i = 1/s_{n,i}^2$ 应用于对数密度残差。通过蒙特卡洛抽样处理预测变量中的不确定性：\n  - 对于每个蒙特卡洛复制样本，从高斯分布中对每个测量量 $x \\in \\{I_p,a,B_T,\\kappa,n_{\\text{lim}}\\}$ 进行抽样，其均值等于测量值，标准差等于其相对标准差乘以其均值，并根据物理合理性需要，将负数抽样结果拒绝或裁剪为小的正数。\n  - 使用抽样值在对数空间中构建加权设计矩阵和响应，并为该复制样本求解加权最小二乘问题。\n- 使用 $N = 3000$ 个独立的蒙特卡洛复制样本，并使用固定的伪随机种子以保证确定性。\n- 从系数样本集合中，获得 $(\\ln C,\\alpha,\\beta,\\gamma,\\delta)$ 的类后验经验分布，并将其传播到预测中。\n\n测试套件和输出：\n- 为以下三个工作点预测 $n_{\\text{lim}}$，并将建议的工作密度 $n_{\\text{op}}$ 与保守边界进行比较：\n  - 测试用例 $1$：$(I_p,a,B_T,\\kappa,n_{\\text{op}}) = (2.5\\times 10^{6},\\,0.62,\\,3.1,\\,1.85,\\,1.0\\times 10^{21})$。\n  - 测试用例 $2$（边缘情况，小半径较小）：$(7.0\\times 10^{5},\\,0.22,\\,2.1,\\,1.60,\\,1.2\\times 10^{21})$。\n  - 测试用例 $3$（大电流、大装置）：$(1.2\\times 10^{7},\\,0.95,\\,5.2,\\,2.00,\\,3.0\\times 10^{21})$。\n- 对于每个测试用例，计算 $N$ 个蒙特卡洛系数样本上 $n_{\\text{lim}}$ 的经验分布。报告 $n_{\\text{lim}}$ 的预测中位数，以及一个布尔值：如果 $n_{\\text{op}}$ 严格小于预测的 $n_{\\text{lim}}$ 分布的保守 $q_{0.05}$ 分位数，则该布尔值为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n- 物理单位：将每个预测的 $n_{\\text{lim}}$ 以 $\\mathrm{m}^{-3}$ 表示。\n- 四舍五入：将每个预测的 $n_{\\text{lim}}$ 四舍五入到 $3$ 位有效数字。\n- 最终输出格式：你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，严格按照 $[\\text{n1},\\text{n2},\\text{n3},\\text{b1},\\text{b2},\\text{b3}]$ 的顺序，其中 $\\text{n1}$、$\\text{n2}$、$\\text{n3}$ 是三个测试用例的四舍五入后的预测中位数（单位为 $\\mathrm{m}^{-3}$），$\\text{b1}$、$\\text{b2}$、$\\text{b3}$ 是如上定义的相应布尔值。", "solution": "目标是基于提供的一组实验测量数据集，为托卡马克密度极限 $n_{\\text{lim}}$ 建立一个经验幂律标度模型。模型参数将通过回归分析推断得出，该分析通过蒙特卡洛模拟严格地考虑了所有量的测量不确定性。然后，这个推断出的标度律将用于预测新工作点的密度极限，并根据一个保守的不确定性边界来评估其操作可行性。\n\n分析始于物理上合理的密度极限幂律拟设，即 $n_{\\text{lim}}$ 作为环向等离子体电流 $I_p$、小半径 $a$、环向磁场 $B_T$ 和等离子体拉长比 $\\kappa$ 的函数：\n$$\nn_{\\text{lim}} = C \\, I_p^{\\alpha} \\, a^{\\beta} \\, B_T^{\\gamma} \\, \\kappa^{\\delta}\n$$\n在此，$C$ 是一个正常数，$\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 是待确定的标度指数。这些预测变量的选择基于磁流体动力学（MHD）原理。根据安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$，$I_p$ 对等离子体约束和稳定性至关重要。几何参数 $a$ 和 $\\kappa$ 定义了等离子体横截面，这会影响电流密度和粒子输运。环向场 $B_T$ 是约束带电粒子的主要因素。\n\n为了便于进行线性回归，我们通过对两边取自然对数来变换模型：\n$$\n\\ln(n_{\\text{lim}}) = \\ln(C) + \\alpha \\ln(I_p) + \\beta \\ln(a) + \\gamma \\ln(B_T) + \\delta \\ln(\\kappa)\n$$\n这个方程对于未知参数 $\\mathbf{p} = [\\ln(C), \\alpha, \\beta, \\gamma, \\delta]^T$ 是线性的。对于一个包含 $M$ 个测量值的数据集（本例中 $M=12$），我们可以将这种关系表示为矩阵形式 $\\mathbf{y} = \\mathbf{X}\\mathbf{p}$，其中 $\\mathbf{y}$ 是观测到的 $\\ln(n_{\\text{lim},i})$ 值的 $M \\times 1$ 向量，$\\mathbf{X}$ 是 $M \\times 5$ 的设计矩阵。$\\mathbf{X}$ 的每一行 $i$ 对应一个观测值，其形式为 $[1, \\ln(I_{p,i}), \\ln(a_i), \\ln(B_{T,i}), \\ln(\\kappa_i)]$。\n\n一个关键挑战是，所有测量量，而不仅仅是响应变量 $n_{\\text{lim}}$，都存在实验不确定性。为了将这些不确定性正确地传播到推断的参数和后续预测中，我们按规定采用蒙特卡洛方法。我们生成 $N=3000$ 个复制数据集。对于每个复制样本，每个测量值 $x_i$（其中 $x \\in \\{I_p, a, B_T, \\kappa, n_{\\text{lim}}\\}$）都从一个高斯分布中抽样，其均值等于其测量值，标准差为其均值与其指定的相对标准差 $s_x$ 的乘积。为保持物理合理性，任何非正值的抽样结果都会被裁剪为一个小的正数。\n\n对于 $N$ 个抽样数据集中的每一个，我们构建相应的对数空间设计矩阵 $\\mathbf{X}_k$ 和响应向量 $\\mathbf{y}_k$（其中 $k$ 是从 $1$ 到 $N$ 的复制索引）。问题规定为每个复制样本执行加权最小二乘（WLS）回归，权重由 $w_i = 1/s_{n,i}^2$ 给出。对数变换后密度的方差 $\\text{Var}(\\ln(n_{\\text{lim},i}))$ 可以通过一阶误差传播近似为 $(\\Delta n_{\\text{lim},i} / n_{\\text{lim},i})^2 = s_{n,i}^2$。因此，权重是对数变换后响应变量方差的倒数。在这个特定问题中，对于所有 $12$ 个数据点，密度的相对标准差 $s_n$ 是恒定的（$s_n=0.10$）。因此，权重矩阵 $\\mathbf{W}$ 是一个所有对角元素都相等的对角矩阵，即 $\\mathbf{W} = (1/s_n^2)\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。参数的WLS解 $\\mathbf{p}_k = (\\mathbf{X}_k^T\\mathbf{W}\\mathbf{X}_k)^{-1}\\mathbf{X}_k^T\\mathbf{W}\\mathbf{y}_k$ 简化为普通最小二乘（OLS）解 $\\mathbf{p}_k = (\\mathbf{X}_k^T\\mathbf{X}_k)^{-1}\\mathbf{X}_k^T\\mathbf{y}_k$。这个OLS问题对于每个复制样本都使用标准的数值线性代数程序高效求解，从而得到一个参数样本 $\\mathbf{p}_k$。\n\n此过程产生一个包含 $N=3000$ 个参数向量的系综 $\\{\\mathbf{p}_k\\}_{k=1}^N$，它形成了一个代表模型参数不确定性的经验分布。为了对新的工作点 $(I_{p,\\text{test}}, a_{\\text{test}}, B_{T,\\text{test}}, \\kappa_{\\text{test}})$ 进行预测，我们首先构建其对数空间特征向量 $\\mathbf{x}_{\\text{test}} = [1, \\ln(I_{p,\\text{test}}), \\ln(a_{\\text{test}}), \\ln(B_{T,\\text{test}}), \\ln(\\kappa_{\\text{test}})]^T$。然后，我们通过对每个参数样本 $\\mathbf{p}_k$ 进行点积运算 $\\ln(n_{\\text{lim},k}) = \\mathbf{x}_{\\text{test}}^T \\mathbf{p}_k$，生成一个包含 $N$ 个预测对数密度值的分布。对这些值取指数，$n_{\\text{lim},k} = \\exp(\\ln(n_{\\text{lim},k}))$，即可得到密度极限的预测分布。\n\n$n_{\\text{lim}}$ 的最终预测值取为该分布的中位数，这是一个稳健的集中趋势估计量。为了提供对操作安全性的保守评估，我们计算预测分布的第5百分位数 $q_{0.05}$。如果一个建议的工作密度 $n_{\\text{op}}$ 严格小于这个下界（$n_{\\text{op}}  q_{0.05}$），则认为它满足保守准则。该方法不仅提供了点估计，还提供了对预测不确定性的有原则的量化，这对于物理和工程应用中的风险评估至关重要。该过程使用固定的伪随机种子以确定性方式实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef round_to_sf(x, sf):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n    \"\"\"\n    if x == 0:\n        return 0.0\n    # Calculate the position of the most significant digit.\n    # The number of digits to round to is sf - 1 - floor(log10(|x|)).\n    # e.g., for 12345 and sf=3, log10 is ~4.09, floor is 4.\n    # sf-1-4 = 3-1-4 = -2. round(12345, -2) - 12300.\n    # e.g., for 0.012345 and sf=3, log10 is ~-1.9, floor is -2.\n    # sf-1-(-2) = 3-1+2 = 4. round(0.012345, 4) - 0.0123.\n    return round(x, sf - 1 - int(np.floor(np.log10(abs(x)))))\n\ndef solve():\n    \"\"\"\n    Performs Monte Carlo based power-law regression for tokamak density limits.\n    \"\"\"\n    # Fixed seed for reproducibility as required by the problem.\n    SEED = 123\n    N_REPLICATES = 3000\n    rng = np.random.default_rng(seed=SEED)\n\n    # Dataset: (I_p, a, B_T, k, n_lim), (s_I, s_a, s_B, s_k, s_n)\n    # The data is structured as mean values followed by fractional standard deviations.\n    dataset = np.array([\n        # Mean values [I_p (A), a (m), B_T (T), k, n_lim (m^-3)]\n        [7.0e5, 0.48, 2.4, 1.72, 4.75e20],\n        [1.2e6, 0.55, 2.8, 1.65, 6.26e20],\n        [2.0e6, 0.60, 3.0, 1.80, 9.27e20],\n        [3.5e6, 0.65, 3.5, 1.90, 1.465e21],\n        [5.0e6, 0.70, 4.0, 1.95, 1.882e21],\n        [9.0e5, 0.40, 2.2, 1.60, 8.31e20],\n        [1.8e6, 0.50, 2.6, 1.75, 1.153e21],\n        [7.0e6, 0.80, 5.0, 2.00, 2.134e21],\n        [1.0e7, 0.78, 5.3, 1.85, 3.12e21],\n        [1.2e7, 0.90, 5.3, 1.95, 2.888e21],\n        [5.0e5, 0.30, 2.5, 1.50, 8.18e20],\n        [3.0e6, 0.55, 3.2, 1.75, 1.653e21],\n        # Fractional std devs [s_I, s_a, s_B, s_k, s_n]\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n        [0.03, 0.02, 0.03, 0.02, 0.10],\n    ])\n    \n    # Split the dataset for clarity\n    means = dataset[:12, :]\n    frac_stds = dataset[12:, :]\n    # Since frac stds are constant for all discharges, we can simplify\n    frac_stds = frac_stds[0, :] * np.ones_like(means)\n    stds = means * frac_stds\n    \n    param_samples = []\n    \n    for _ in range(N_REPLICATES):\n        # Sample data from Gaussian distributions\n        sampled_data = rng.normal(loc=means, scale=stds)\n        \n        # Clip to a small positive number to avoid log(0) or log(-)\n        sampled_data = np.maximum(sampled_data, 1e-12)\n        \n        I_p, a, B_T, kappa, n_lim = sampled_data.T\n        \n        # Construct the linear model in log-space: y = Xp\n        # y = log(n_lim)\n        # X = [1, log(I_p), log(a), log(B_T), log(kappa)]\n        # p = [log(C), alpha, beta, gamma, delta]\n        y_k = np.log(n_lim)\n        X_k = np.vstack([\n            np.ones(means.shape[0]),\n            np.log(I_p),\n            np.log(a),\n            np.log(B_T),\n            np.log(kappa)\n        ]).T\n        \n        # Perform OLS. As per problem description, WLS simplifies to OLS\n        # because the weights are constant for all data points.\n        params, _, _, _ = np.linalg.lstsq(X_k, y_k, rcond=None)\n        param_samples.append(params)\n        \n    param_samples = np.array(param_samples) # Shape: (N_REPLICATES, 5)\n\n    # Test cases: (I_p, a, B_T, k, n_op)\n    test_cases = [\n        (2.5e6, 0.62, 3.1, 1.85, 1.0e21),\n        (7.0e5, 0.22, 2.1, 1.60, 1.2e21),\n        (1.2e7, 0.95, 5.2, 2.00, 3.0e21),\n    ]\n\n    median_predictions = []\n    boolean_checks = []\n\n    for case in test_cases:\n        I_p_test, a_test, B_T_test, k_test, n_op = case\n        \n        # Construct the feature vector for the test case in log-space\n        x_test_log = np.array([1.0, np.log(I_p_test), np.log(a_test), np.log(B_T_test), np.log(k_test)])\n        \n        # Predict log(n_lim) for all parameter samples\n        log_n_lim_preds = param_samples @ x_test_log\n        \n        # Transform back to n_lim\n        n_lim_preds = np.exp(log_n_lim_preds)\n        \n        # Calculate median prediction and q_0.05 quantile\n        median_n_lim = np.median(n_lim_preds)\n        q05_n_lim = np.quantile(n_lim_preds, 0.05)\n        \n        # Round median to 3 significant figures\n        rounded_median = round_to_sf(median_n_lim, 3)\n        median_predictions.append(f\"{rounded_median:.2e}\".replace(\"e+0\", \"e+\"))\n\n        # Check if operating density is below the conservative bound\n        is_safe = n_op  q05_n_lim\n        boolean_checks.append(is_safe)\n        \n    # Combine results and format the final output string\n    final_output_list = median_predictions + boolean_checks\n    print(f\"[{','.join(map(str, final_output_list))}]\")\n\nsolve()\n```", "id": "3694567"}]}