{"hands_on_practices": [{"introduction": "先进托卡马克运行模式的基石之一是实现卓越的能量约束，从而在给定的加热功率下达到更高的聚变性能。本练习将引导您从基本的径向热输运方程出发，通过建立一个简化的内部输运垒（ITB）模型来降低等离子体芯部的热扩散，并与标准的H模式进行对比。通过这个实践，您将亲手推导并量化分析ITB对能量约束时间的提升效果，从而深入理解改善约束对于实现稳态高性能等离子体的核心作用。[@problem_id:3690572]", "problem": "一个在稳态下运行的托卡马克等离子体，其主导行为可以用小半径 $r \\in [0,a]$ 上具有柱对称性的一维径向输运来建模。能量约束时间 $\\tau_{E}$ 在稳态下定义为 $\\tau_{E} = W/P_{\\mathrm{loss}}$，其中 $W$ 是总热能含量，而在稳态条件下，$P_{\\mathrm{loss}}$ 等于总输入功率 $P_{\\mathrm{in}}$。假设等离子体具有均匀的总数密度 $n$，且电子和离子具有单一的共同温度 $T(r)$，使得总能量密度为 $w(r) = 3 n k_{B} T(r)$，其中 $k_{B}$ 是玻尔兹曼常数。稳态能量输运由传导主导，其有效热扩散系数为 $\\chi(r)$，因此能量（热）通量为 $\\boldsymbol{q}(r) = - C \\, \\chi(r) \\, \\nabla T(r)$，其中 $C = 3 n k_{B}$，加热由一个均匀的体源 $S$（单位为 $\\mathrm{W/m^{3}}$）表示。稳态能量平衡方程简化为\n$$\n\\nabla \\cdot \\left( \\chi(r) \\, \\nabla T(r) \\right) = - \\frac{S}{C},\n$$\n边界条件为 $T'(0) = 0$（轴心处的正则性）和 $T(a) = 0$（定义参考边界温度）。\n\n考虑两种情况：\n- 标准的高约束模式（H-模式），具有均匀的 $\\chi(r) = \\chi_{H}$。\n- 具有内部输运垒（ITB）的反剪切位形，建模为分段常数 $\\chi(r)$：当 $0 \\le r \\le r_{b}$ 时，$\\chi(r) = \\chi_{1}$；当 $r_{b} \\le r \\le a$ 时，$\\chi(r) = \\chi_{2}$，且在 $r=r_{b}$ 处 $T(r)$ 和传导热通量是连续的。\n\n仅从上述定义和方程出发（不要假设或引用任何预先推导的约束标度律），推导两种情况下 $\\tau_{E}$ 的表达式，并使用以下科学上合理的参数计算比值 $\\tau_{E}^{\\mathrm{(ITB)}} / \\tau_{E}^{\\mathrm{(H)}}$：\n- 小半径 $a = 0.60$ $\\mathrm{m}$，\n- 输运垒半径 $r_{b} = 0.35$ $\\mathrm{m}$，\n- H-模式均匀扩散系数 $\\chi_{H} = 0.80$ $\\mathrm{m^{2}/s}$，\n- 核心区扩散系数 $\\chi_{1} = 0.20$ $\\mathrm{m^{2}/s}$，\n- 外部区扩散系数 $\\chi_{2} = 0.80$ $\\mathrm{m^{2}/s}$。\n\n假设环的大半径 $R$ 是有限的但足够大，以至于对于小半径上的传导和体积分，柱坐标近似是足够的，忽略辐射和对流损失，并取 $S$ 在整个横截面上是均匀的。将所求比值表示为一个纯数（无单位），并将答案四舍五入到四位有效数字。", "solution": "出发点是稳态传导能量平衡方程：\n$$\n\\nabla \\cdot \\left( \\chi(r) \\, \\nabla T(r) \\right) = - \\frac{S}{C}, \\quad C = 3 n k_{B}.\n$$\n在小半径的柱坐标近似下，并具有角向对称性，径向形式为\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi(r) \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C},\n$$\n边界条件为 $T'(0)=0$（在 $r=0$ 处的正则性）和 $T(a)=0$（参考边界温度）。总热能含量为\n$$\nW = \\int w(r) \\, \\mathrm{d}V = \\int C \\, T(r) \\, \\mathrm{d}V,\n$$\n对于均匀的 $S$，总输入功率为\n$$\nP_{\\mathrm{in}} = \\int S \\, \\mathrm{d}V = S \\, V,\n$$\n其中环的体积为 $V = 2 \\pi^{2} R a^{2}$。利用对称性，体积分可以分解为大半径周长 $2 \\pi R$ 乘以横截面积分。可得\n$$\nW = C \\cdot 4 \\pi^{2} R \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r, \\quad P_{\\mathrm{in}} = S \\cdot 2 \\pi^{2} R a^{2}.\n$$\n因此，能量约束时间为\n$$\n\\tau_{E} = \\frac{W}{P_{\\mathrm{in}}} = \\frac{2 C}{a^{2} S} \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r,\n$$\n对于均匀的 $S$，该式与大半径 $R$ 无关。\n\n标准 H-模式（均匀 $\\chi$）：\n\n设 $\\chi(r) = \\chi_{H}$ 为常数。稳态方程变为\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{H} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C}.\n$$\n定义 $f(r) \\equiv r \\, \\chi_{H} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r}$。则\n$$\n\\frac{\\mathrm{d} f}{\\mathrm{d} r} = - r \\frac{S}{C} \\quad \\Rightarrow \\quad f(r) = - \\frac{S}{2 C} r^{2} + A,\n$$\n且 $r=0$ 处的正则性要求 $f(0)=0 \\Rightarrow A=0$。因此\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{H}} r \\quad \\Rightarrow \\quad T(r) = T_{0} - \\frac{S}{4 C \\chi_{H}} r^{2}.\n$$\n边界条件 $T(a) = 0$ 得出 $T_{0} = \\frac{S}{4 C \\chi_{H}} a^{2}$，所以\n$$\nT(r) = \\frac{S}{4 C \\chi_{H}} \\left( a^{2} - r^{2} \\right).\n$$\n计算横截面积分：\n$$\n\\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r = \\frac{S}{4 C \\chi_{H}} \\int_{0}^{a} \\left( a^{2} r - r^{3} \\right) \\mathrm{d} r = \\frac{S}{4 C \\chi_{H}} \\left( \\frac{a^{4}}{2} - \\frac{a^{4}}{4} \\right) = \\frac{S a^{4}}{16 C \\chi_{H}}.\n$$\n因此\n$$\n\\tau_{E}^{\\mathrm{(H)}} = \\frac{2 C}{a^{2} S} \\cdot \\frac{S a^{4}}{16 C \\chi_{H}} = \\frac{a^{2}}{8 \\chi_{H}}.\n$$\n\n具有内部输运垒的反剪切（分段 $\\chi$）：\n\n令\n$$\n\\chi(r) = \n\\begin{cases}\n\\chi_{1},  0 \\le r \\le r_{b}, \\\\\n\\chi_{2},  r_{b} \\le r \\le a,\n\\end{cases}\n$$\n在 $r=r_{b}$ 处，$T(r)$ 和通量 $r \\chi(r) T'(r)$ 是连续的。在每个区域中，应用相同的积分步骤。\n\n内部区域 $0 \\le r \\le r_{b}$：\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{1} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C} \\quad \\Rightarrow \\quad r \\chi_{1} \\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C} r^{2}.\n$$\n因此\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{1}} r \\quad \\Rightarrow \\quad T_{1}(r) = T_{c} - \\frac{S}{4 C \\chi_{1}} r^{2},\n$$\n其中 $T_{c}$ 是待定的中心温度。\n\n外部区域 $r_{b} \\le r \\le a$：\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{2} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C} \\quad \\Rightarrow \\quad r \\chi_{2} \\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C} r^{2} + A_{2}.\n$$\n在 $r=r_{b}$ 处的通量连续性要求\n$$\nr_{b} \\chi_{1} T_{1}'(r_{b}) = r_{b} \\chi_{2} T_{2}'(r_{b}),\n$$\n并且由于在内部区域 $r \\chi T' = - \\frac{S}{2 C} r^{2}$，这意味着 $A_{2}=0$。因此\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{2}} r \\quad \\Rightarrow \\quad T_{2}(r) = T_{b} - \\frac{S}{4 C \\chi_{2}} \\left( r^{2} - r_{b}^{2} \\right),\n$$\n其中 $T_{b} = T_{2}(r_{b}) = T_{1}(r_{b})$ 确保了温度的连续性。边界条件 $T(a)=0$ 给出\n$$\nT_{b} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right),\n$$\n在 $r_{b}$ 处的匹配确定了 $T_{c}$：\n$$\nT_{c} - \\frac{S}{4 C \\chi_{1}} r_{b}^{2} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right) \\quad \\Rightarrow \\quad T_{c} = \\frac{S}{4 C} \\left( \\frac{r_{b}^{2}}{\\chi_{1}} + \\frac{a^{2} - r_{b}^{2}}{\\chi_{2}} \\right).\n$$\n\n约束时间需要积分\n$$\nI \\equiv \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r = \\int_{0}^{r_{b}} T_{1}(r) \\, r \\, \\mathrm{d} r + \\int_{r_{b}}^{a} T_{2}(r) \\, r \\, \\mathrm{d} r.\n$$\n计算 $I_{1}$：\n$$\nI_{1} = \\int_{0}^{r_{b}} \\left( T_{c} - \\frac{S}{4 C \\chi_{1}} r^{2} \\right) r \\, \\mathrm{d} r = T_{c} \\frac{r_{b}^{2}}{2} - \\frac{S}{4 C \\chi_{1}} \\frac{r_{b}^{4}}{4}.\n$$\n代入 $T_{c}$：\n$$\nI_{1} = \\frac{S}{4 C} \\left[ \\left( \\frac{r_{b}^{2}}{\\chi_{1}} + \\frac{a^{2} - r_{b}^{2}}{\\chi_{2}} \\right) \\frac{r_{b}^{2}}{2} - \\frac{r_{b}^{4}}{4 \\chi_{1}} \\right]\n= \\frac{S}{4 C} \\left( \\frac{r_{b}^{4}}{4 \\chi_{1}} + \\frac{a^{2} r_{b}^{2} - r_{b}^{4}}{2 \\chi_{2}} \\right).\n$$\n计算 $I_{2}$。使用 $T_{b} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right)$，可以将 $T_{2}(r)$ 重写为\n$$\nT_{2}(r) = \\frac{S a^{2}}{4 C \\chi_{2}} - \\frac{S}{4 C \\chi_{2}} r^{2},\n$$\n所以\n$$\nI_{2} = \\int_{r_{b}}^{a} \\left( \\frac{S a^{2}}{4 C \\chi_{2}} - \\frac{S}{4 C \\chi_{2}} r^{2} \\right) r \\, \\mathrm{d} r\n= \\frac{S}{4 C \\chi_{2}} \\left[ \\frac{a^{2}}{2} \\left( a^{2} - r_{b}^{2} \\right) - \\frac{1}{4} \\left( a^{4} - r_{b}^{4} \\right) \\right]\n= \\frac{S}{4 C \\chi_{2}} \\left( \\frac{a^{4}}{4} - \\frac{a^{2} r_{b}^{2}}{2} + \\frac{r_{b}^{4}}{4} \\right).\n$$\n将 $I = I_{1} + I_{2}$ 相加得到紧凑的结果\n$$\nI = \\frac{S}{4 C} \\left( \\frac{r_{b}^{4}}{4 \\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{4 \\chi_{2}} \\right) = \\frac{S}{16 C} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\n因此，\n$$\n\\tau_{E}^{\\mathrm{(ITB)}} = \\frac{2 C}{a^{2} S} \\, I = \\frac{1}{8 a^{2}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\n\n那么比值为\n$$\n\\frac{\\tau_{E}^{\\mathrm{(ITB)}}}{\\tau_{E}^{\\mathrm{(H)}}} = \\frac{ \\frac{1}{8 a^{2}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right) }{ \\frac{a^{2}}{8 \\chi_{H}} } = \\frac{\\chi_{H}}{a^{4}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\n\n代入数值：\n$$\na = 0.60, \\quad r_{b} = 0.35, \\quad \\chi_{H} = 0.80, \\quad \\chi_{1} = 0.20, \\quad \\chi_{2} = 0.80,\n$$\n所有单位均为适当的 $\\mathrm{m}$ 或 $\\mathrm{m^{2}/s}$。计算所需的幂：\n$$\na^{2} = 0.36, \\quad a^{4} = 0.1296, \\quad r_{b}^{2} = 0.1225, \\quad r_{b}^{4} = 0.01500625.\n$$\n计算括号中的值：\n$$\n\\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} = \\frac{0.01500625}{0.20} + \\frac{0.1296 - 0.01500625}{0.80} = 0.07503125 + 0.1432421875 = 0.2182734375.\n$$\n因此\n$$\n\\frac{\\tau_{E}^{\\mathrm{(ITB)}}}{\\tau_{E}^{\\mathrm{(H)}}} = \\frac{0.80}{0.1296} \\times 0.2182734375 = 6.172839506 \\times 0.2182734375 \\approx 1.3473669.\n$$\n四舍五入到四位有效数字，比值为 $1.347$。这个无量纲数直接量化了在所述假设下，反剪切内部输运垒位形相对于标准高约束模式预期的约束增强效果。", "answer": "$$\\boxed{1.347}$$", "id": "3690572"}, {"introduction": "尽管高性能等离子体具有诸多优势，但它们往往更容易受到磁流体（MHD）不稳定性的影响，其中新经典撕裂模（NTM）是实现和维持稳态高$\\beta$运行的主要障碍之一。本练习聚焦于一种关键的主动控制技术：利用外部注入的电子回旋电流驱动（ECCD）来精确地“填补”磁岛中的电流空缺，从而抑制其增长。您将基于修正的卢瑟福方程进行计算，探索稳定NTM所需的最小ECCD功率及其对驱动位置精确度的敏感性，这对于设计真实、鲁棒的反馈控制系统至关重要。[@problem_id:3690615]", "problem": "考虑一个先进托卡马克平衡，其中存在一个极向/环向模数为 $m/n = 3/2$ 的新经典撕裂模(NTM)，该模局域在有理面 $r/a = 0.6$ 处，其中 $a$ 是小半径。磁岛半宽度用 $w$ 表示，运行方案要求将 $w$ 减小到临界半宽度 $w_{\\text{crit}}$ 以下，以确保在稳态下避免NTM的增长。在有理面附近施加电子回旋电流驱动 (ECCD)，以在磁岛O点处提供局域的稳定化螺旋电流。ECCD的沉积具有高斯径向剖面，并且相对于有理面存在径向失准 $\\Delta r$。\n\n从电阻磁流体力学和修正的Rutherford方程的定义出发——该方程平衡了经典撕裂模驱动、新经典自举电流驱动和外部驱动电流——推导在 $w = w_{\\text{crit}}$ 时的稳定化条件，该条件要求外部驱动电流密度超过不稳定项，从而使得 $\\mathrm{d}w/\\mathrm{d}t  0$。利用此条件求得阈值外部驱动电流，然后通过电流驱动效率将其与ECCD功率联系起来。高斯径向准直因子定义为 $F(\\Delta r) = \\exp\\!\\left[-(\\Delta r/\\sigma)^{2}\\right]$，其中 $\\sigma$ 是 $1/e$ 沉积宽度。\n\n假设以下科学上符合实际的放电参数是已知的：\n- 临界半宽度 $w_{\\text{crit}} = 3.0 \\times 10^{-2}\\ \\text{m}$。\n- 极化电流屏蔽半宽度 $w_{\\text{pol}} = 1.2 \\times 10^{-2}\\ \\text{m}$。\n- 经典撕裂模稳定指数 $\\Delta' = 0.80\\ \\text{m}^{-1}$。\n- 无量纲自举驱动系数 $C_{\\text{bs}} = 0.60$。\n- 电流驱动耦合系数 $C_{\\text{CD}} = 2.0 \\times 10^{-5}\\ \\text{A}^{-1}$。\n- 电子回旋电流驱动 (ECCD) 效率 $\\eta_{\\text{CD}} = 1.0 \\times 10^{4}\\ \\text{A}\\ \\text{MW}^{-1}$。\n- 沉积宽度 $\\sigma = 1.5 \\times 10^{-2}\\ \\text{m}$。\n- 可用ECCD功率预算 $P_{\\text{avail}} = 5.0\\ \\text{MW}$。\n\n任务：\n1. 使用在 $w = w_{\\text{crit}}$ 处的稳定化条件，假设具有完美的O点相位和零径向失准（$\\Delta r = 0$），计算确保在 $w = w_{\\text{crit}}$ 处 $\\mathrm{d}w/\\mathrm{d}t  0$ 所需的最小ECCD功率 $P_{\\text{ECCD,min}}$。\n2. 在固定的可用功率 $P_{\\text{avail}}$下，计算在 $w = w_{\\text{crit}}$ 处仍能实现稳定（即在 $w = w_{\\text{crit}}$ 处 $\\mathrm{d}w/\\mathrm{d}t \\le 0$）的最大允许径向失准 $\\Delta r_{\\max}$。\n\n将 $P_{\\text{ECCD,min}}$ 以 $\\text{MW}$ 为单位表示，将 $\\Delta r_{\\max}$ 以 $\\text{m}$ 为单位表示。将两个数值结果都四舍五入到三位有效数字。以单个双元素行矩阵的形式提供最终答案。", "solution": "其物理基础是关于磁岛演化的电阻磁流体力学描述，其中撕裂不稳定性由经典撕裂模驱动、与磁岛内部压力梯度引起的电流亏损相关的新经典自举驱动，以及当沉积在磁岛O点时可以替代缺失的自举电流的外部驱动电流三者之间的平衡所决定。这种平衡由修正的Rutherford方程描述。在主导阶上，磁岛半宽度的演化可以写成一种将驱动项和反驱动项分开的形式，\n$$\n\\frac{\\tau_{R}}{r_{s}} \\frac{\\mathrm{d} w}{\\mathrm{d} t}\n=\n\\underbrace{\\Delta'}_{\\text{classical tearing}}\n+\n\\underbrace{\\frac{C_{\\text{bs}}}{w}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w^{2}}\\right)}_{\\text{bootstrap drive}}\n-\n\\underbrace{\\frac{C_{\\text{CD}}}{w}\\,I_{\\text{CD}}\\,F(\\Delta r)}_{\\text{ECCD counter-drive}}.\n$$\n此处，$\\tau_{R}$ 是电阻时间，$r_{s}$ 是有理面半径，$\\Delta'$ 是经典撕裂模稳定指数，$C_{\\text{bs}}$ 是无量纲自举驱动系数，$w_{\\text{pol}}$ 是极化屏蔽尺度，它会削弱小磁岛的自举驱动，$C_{\\text{CD}}$ 是一个耦合系数（单位为 $\\text{A}^{-1}$），用于量化外部驱动电流 $I_{\\text{CD}}$ 如何与磁岛链耦合，而 $F(\\Delta r)$ 是准直因子，描述了由于径向失准导致的有效驱动的减小。\n\n稳定化要求在工作点 $w = w_{\\text{crit}}$ 处 $\\mathrm{d}w/\\mathrm{d}t \\le 0$。由于前置因子 $\\tau_{R}/r_{s} > 0$，这等价于要求在 $w = w_{\\text{crit}}$ 处，驱动项和反驱动项的和（方括号内的表达式）为负，\n$$\n\\Delta' + \\frac{C_{\\text{bs}}}{w_{\\text{crit}}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n-\n\\frac{C_{\\text{CD}}}{w_{\\text{crit}}}\\,I_{\\text{CD}}\\,F(\\Delta r) \\le 0.\n$$\n对此不等式求解阈值外部驱动电流，可得到在给定的准直 $F(\\Delta r)$ 下，于 $w_{\\text{crit}}$ 处实现稳定化所需的最小电流，\n$$\nI_{\\text{CD,min}}(w_{\\text{crit}}, \\Delta r)\n=\n\\frac{\nw_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n}{\nC_{\\text{CD}}\\,F(\\Delta r)\n}.\n$$\n电子回旋电流驱动 (ECCD) 通过效率 $\\eta_{\\text{CD}}$ 将注入功率 $P_{\\text{ECCD}}$ 与驱动电流联系起来，\n$$\nI_{\\text{CD}} = \\eta_{\\text{CD}}\\,P_{\\text{ECCD}}.\n$$\n因此，在完美准直（$\\Delta r = 0 \\Rightarrow F(0)=1$）下的最小ECCD功率为\n$$\nP_{\\text{ECCD,min}}\n=\n\\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}}\n=\n\\frac{\nw_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n}{\nC_{\\text{CD}}\\,\\eta_{\\text{CD}}\n}.\n$$\n\n对于有限的功率预算 $P_{\\text{avail}}$，稳定化条件可以重写为对准直因子的一个界限，\n$$\n\\eta_{\\text{CD}}\\,P_{\\text{avail}}\\,F(\\Delta r) \\ge I_{\\text{CD,min}}(w_{\\text{crit}}, 0),\n$$\n所以\n$$\nF(\\Delta r) \\ge \\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}.\n$$\n利用高斯剖面 $F(\\Delta r) = \\exp\\!\\left[-(\\Delta r/\\sigma)^{2}\\right]$，我们求解允许的 $\\Delta r$：\n$$\n\\exp\\!\\left[-\\left(\\frac{\\Delta r}{\\sigma}\\right)^{2}\\right]\n\\ge\n\\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}\\,P_{\\text{avail}}},\n\\quad\\Rightarrow\\quad\n\\left(\\frac{\\Delta r}{\\sigma}\\right)^{2}\n\\le\n\\ln\\!\\left(\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n\\right).\n$$\n因此，最大允许径向失准为\n$$\n\\Delta r_{\\max}\n=\n\\sigma\\,\n\\sqrt{\n\\ln\\!\\left(\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n\\right)\n}.\n$$\n\n现在代入给定参数以获得数值。\n\n第1步：计算 $I_{\\text{CD,min}}(w_{\\text{crit}}, 0)$。\n- $w_{\\text{crit}} \\Delta' = (3.0 \\times 10^{-2}) \\times 0.80 = 2.4 \\times 10^{-2}$。\n- $\\displaystyle \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}} = \\left(\\frac{1.2 \\times 10^{-2}}{3.0 \\times 10^{-2}}\\right)^{2} = 0.16$。\n- $1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}} = 0.84$。\n- $C_{\\text{bs}}\\left(1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right) = 0.60 \\times 0.84 = 0.504$。\n- 分子： $w_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right) = 0.024 + 0.504 = 0.528$。\n- 除以 $C_{\\text{CD}}$： $I_{\\text{CD,min}}(w_{\\text{crit}}, 0) = \\dfrac{0.528}{2.0 \\times 10^{-5}} = 2.64 \\times 10^{4}\\ \\text{A}$。\n\n第2步：完美准直下的最小ECCD功率：\n$$\nP_{\\text{ECCD,min}} = \\frac{I_{\\text{CD,min}}}{\\eta_{\\text{CD}}}\n= \\frac{2.64 \\times 10^{4}\\ \\text{A}}{1.0 \\times 10^{4}\\ \\text{A}\\ \\text{MW}^{-1}}\n= 2.64\\ \\text{MW}.\n$$\n\n第3步：在 $P_{\\text{avail}} = 5.0\\ \\text{MW}$ 下的最大允许径向失准：\n- 对数内的比率：\n$$\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n=\n\\frac{(1.0 \\times 10^{4}) \\times 5.0}{2.64 \\times 10^{4}}\n=\n\\frac{5.0 \\times 10^{4}}{2.64 \\times 10^{4}}\n\\approx 1.8939.\n$$\n- 对数：\n$$\n\\ln(1.8939) \\approx 0.639.\n$$\n- 平方根因子：\n$$\n\\sqrt{0.639} \\approx 0.799.\n$$\n- 失准：\n$$\n\\Delta r_{\\max} = \\sigma \\times 0.799 = (1.5 \\times 10^{-2}) \\times 0.799 \\approx 1.20 \\times 10^{-2}\\ \\text{m}.\n$$\n\n将两个结果都四舍五入到三位有效数字，并用要求的单位表示，可得：\n- $P_{\\text{ECCD,min}} = 2.64\\ \\text{MW}$，\n- $\\Delta r_{\\max} = 0.0120\\ \\text{m}$。\n\n以一个双元素行矩阵的形式提供最终答案。", "answer": "$$\\boxed{\\begin{pmatrix}2.64  0.0120\\end{pmatrix}}$$", "id": "3690615"}, {"introduction": "实现高性能稳态运行的最终挑战之一是处理从等离子体中排出的巨大热流，这对于保护面向等离子体的部件（如偏滤器）和实现长期稳定运行至关重要。本练习模拟了一个关键的解决方案：通过主动注入少量杂质（如氖或氩）在等离子体边界形成一个“辐射地幔”，从而将集中的热流以光辐射的形式均匀散发掉。您将计算在满足芯部等离子体纯度约束（$Z_{\\text{eff}}$限制）的前提下，达到目标辐射功率份额所需的杂质注入率，从而体验在实际运行中进行多目标优化的过程。[@problem_id:3690607]", "problem": "您的任务是编写一个完整的、可运行的程序，该程序计算为达到指定的目标辐射功率份额同时维持有效离子电荷约束所需的杂质注入率。其预期的物理背景是用于稳态运行的先进托卡马克情景，推导必须基于第一性原理和经过充分检验的公式。\n\n等离子体被划分为核心区和边缘辐射区。假设存在单一杂质种类，其有效平方电荷数固定，并且一部分杂质存量保留在核心区。以下定义和原理将作为基础：\n\n- 准中性和主导离子：在核心区，假设主导离子密度约等于电子密度，且杂质份额很小。\n- 有效离子电荷 (Z_eff)：将 $Z_\\text{eff}$ 定义为 $Z_\\text{eff} = \\dfrac{\\sum_j n_j Z_j^2}{n_e}$，其中 $n_j$ 和 $Z_j$ 分别是离子种类 $j$ 的数密度和电荷数，$n_e$ 是电子密度。对于有效平方电荷为 $Z_\\text{bar}^2$ 且核心区杂质数密度为 $n_\\text{imp,core} = r_\\text{core} n_\\text{imp}$ 的单一杂质种类，近似有 $Z_\\text{eff,core} \\approx 1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2$。\n- 韧致辐射：使用经过充分检验的近似电子-离子韧致辐射功率密度公式 $P_\\text{brem}^\\prime = C_\\text{brem} Z_\\text{eff} n_e^2 \\sqrt{T_e}$，其中当 $n_e$ 的单位为 $\\text{m}^{-3}$ 且 $T_e$ 的单位为 $\\text{eV}$ 时，$C_\\text{brem} = 1.69 \\times 10^{-38}$（单位为 $\\text{W}\\cdot\\text{m}^3\\cdot\\text{eV}^{-1/2}$）。对于核心区，定义 $A_\\text{core} = C_\\text{brem} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}}$（单位为 $\\text{W/m}^3$）和 $B_\\text{core} = A_\\text{core} V_\\text{core}$（单位为 $\\text{W}$）为无杂质时的基线韧致辐射。存在杂质时，核心区韧致辐射变为 $P_\\text{brem,core} = B_\\text{core} \\left(1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2\\right)$。\n- 谱线辐射：通过有效冕线辐射项 $P_\\text{line} = n_{e,\\text{line}} n_\\text{imp} L_\\text{line}(T_\\text{line}) V_\\text{line}$ 来模拟边缘（及刮削层）的辐射损失，其中 $L_\\text{line}$ 是有效冷却系数（单位为 $\\text{W}\\cdot\\text{m}^3$），$n_{e,\\text{line}}$ 是特征边缘电子密度，$T_\\text{line}$ 是评估 $L_\\text{line}$ 时的特征边缘温度，$V_\\text{line}$ 是有效边缘辐射体积。\n- 稳态全局功率份额：通过 $f_\\text{rad} = \\dfrac{P_\\text{rad}}{P_\\text{in}}$ 定义目标辐射功率份额 $f_\\text{rad}$，其中 $P_\\text{rad} = P_\\text{brem,core} + P_\\text{line}$，$P_\\text{in}$ 是总输入功率。\n\n令 $n_\\text{imp}$ 表示在总等离子体体积 $V_\\text{tot}$ 上的空间平均杂质数密度。在稳态下，将杂质粒子平衡建模为 $n_\\text{imp} = \\dfrac{Q_\\text{imp} \\tau_p}{V_\\text{tot}}$，其中 $Q_\\text{imp}$ 是全局杂质注入率（单位为粒子/秒），$\\tau_p$ 是有效杂质约束时间（单位为秒）。\n\n您的程序必须实现以下计算：\n\n1. 给定测试用例的参数，计算核心区基线韧致辐射 $B_\\text{core} = C_\\text{brem} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}} V_\\text{core}$。\n2. 通过求解以下方程计算达到目标辐射份额所需的杂质密度\n   $$f_\\text{rad} P_\\text{in} = B_\\text{core} + n_\\text{imp} \\left[B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line}\\right].$$\n   分离出 $n_\\text{imp}$ 得到\n   $$n_\\text{imp} = \\dfrac{f_\\text{rad} P_\\text{in} - B_\\text{core}}{B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line}}.$$\n3. 强制物理可行性：\n   - 如果 $f_\\text{rad} P_\\text{in} - B_\\text{core} \\le 0$，则设置 $Q_\\text{imp} = 0$，因为不需要注入杂质。\n   - 施加核心区有效离子电荷约束 $Z_\\text{eff,core} \\le Z_{\\text{eff},\\max}$，这转化为最大杂质密度\n     $$n_{\\text{imp},\\max} = \\dfrac{n_{e,\\text{core}} \\left(Z_{\\text{eff},\\max} - 1\\right)}{r_\\text{core} Z_\\text{bar}^2}.$$\n     如果所需的 $n_\\text{imp}$ 超过 $n_{\\text{imp},\\max}$，则目标不可行；此时返回 $-1$。\n4. 如果可行，计算所需的杂质注入率\n   $$Q_\\text{imp} = \\dfrac{n_\\text{imp} V_\\text{tot}}{\\tau_p}.$$\n\n所有涉及物理单位的量必须一致处理：\n\n- 电子密度 $n_{e,\\text{core}}$ 和 $n_{e,\\text{line}}$ 的单位为 $\\text{m}^{-3}$。\n- 温度 $T_{e,\\text{core}}$ 和 $T_\\text{line}$ 的单位为 $\\text{eV}$。\n- 体积 $V_\\text{core}$、$V_\\text{line}$ 和 $V_\\text{tot}$ 的单位为 $\\text{m}^3$。\n- 输入功率 $P_\\text{in}$ 的单位为 $\\text{W}$。\n- 杂质约束时间 $\\tau_p$ 的单位为 $\\text{s}$。\n- 有效冷却系数 $L_\\text{line}$ 的单位为 $\\text{W}\\cdot\\text{m}^3$。\n- 最终输出 $Q_\\text{imp}$ 必须以粒子/秒 $(\\text{s}^{-1})$ 为单位报告。\n\n使用以下精心选择的测试套件，它涵盖了一个一般可行情况、一个因违反 $Z_\\text{eff}$ 约束而不可行的情况、另一个使用不同杂质的可行情况，以及一个不需要注入的边界情况：\n\n- 测试用例1（可行，氖主导的边缘辐射）：\n  - $n_{e,\\text{core}} = 8.0\\times 10^{19}$, $T_{e,\\text{core}} = 8000$, $V_\\text{core} = 110$.\n  - $n_{e,\\text{line}} = 3.0\\times 10^{19}$, $L_\\text{line} = 3.0\\times 10^{-33}$, $V_\\text{line} = 60$.\n  - $Z_\\text{bar}^2 = 100$, $r_\\text{core} = 0.05$, $Z_{\\text{eff},\\max} = 2.5$.\n  - $P_\\text{in} = 6.0\\times 10^{7}$, $f_\\text{rad} = 0.7$.\n  - $\\tau_p = 0.3$, $V_\\text{tot} = 170$.\n- 测试用例2（因 $Z_\\text{eff}$ 约束而不可行，氖在核心区有更高的滞留率）：\n  - 与测试用例1相同，但 $r_\\text{core} = 0.20$。\n- 测试用例3（可行，氩主导的边缘辐射）：\n  - $n_{e,\\text{core}} = 8.0\\times 10^{19}$, $T_{e,\\text{core}} = 8000$, $V_\\text{core} = 110$.\n  - $n_{e,\\text{line}} = 3.0\\times 10^{19}$, $L_\\text{line} = 5.0\\times 10^{-32}$, $V_\\text{line} = 60$.\n  - $Z_\\text{bar}^2 = 324$, $r_\\text{core} = 0.03$, $Z_{\\text{eff},\\max} = 2.5$.\n  - $P_\\text{in} = 6.0\\times 10^{7}$, $f_\\text{rad} = 0.7$.\n  - $\\tau_p = 0.5$, $V_\\text{tot} = 170$.\n- 测试用例4（边界情况，目标低于基线韧致辐射）：\n  - 与测试用例1相同，但 $f_\\text{rad} = 0.01$。\n\n您的程序应生成单行输出，其中包含测试套件的结果，格式为逗号分隔的列表，并用方括号括起来，注入率的单位为 $\\text{s}^{-1}$。对于不可行的情况，输出 $-1$。对于不需要注入的情况，输出 $0$。例如：“[result1,result2,result3,result4]”。", "solution": "所述问题具有科学依据，提法恰当且自成体系，它基于一个简化但标准的托卡马克等离子体行为模型，提出了一个有效的计算任务。因此，我们将着手提供一个完整的解决方案。\n\n问题的核心是确定必要的杂质注入率 $Q_\\text{imp}$，以实现期望的辐射功率份额 $f_\\text{rad}$，同时满足由有效离子电荷 $Z_\\text{eff,core}$ 表示的核心区等离子体纯度约束。该解决方案源自稳态功率和粒子平衡方程。\n\n首先，我们定义总功率平衡。总辐射功率 $P_\\text{rad}$ 是核心区韧致辐射功率 $P_\\text{brem,core}$ 和边缘谱线辐射功率 $P_\\text{line}$ 的总和。该总功率必须等于输入加热功率 $P_\\text{in}$ 的目标份额 $f_\\text{rad}$。\n$$f_\\text{rad} P_\\text{in} = P_\\text{rad} = P_\\text{brem,core} + P_\\text{line}$$\n核心区韧致辐射功率取决于核心区等离子体参数和核心区杂质的浓度。它由 $P_\\text{brem,core} = B_\\text{core} Z_\\text{eff,core}$ 给出，其中 $B_\\text{core}$ 是纯（$Z_\\text{eff}=1$）氢等离子体的基线韧致辐射。\n$$B_\\text{core} = C_\\text{brem} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}} V_\\text{core}$$\n这里，$C_\\text{brem}$ 是韧致辐射常数，$1.69 \\times 10^{-38} \\, \\text{W}\\cdot\\text{m}^3\\cdot\\text{eV}^{-1/2}$，$n_{e,\\text{core}}$ 是核心区电子密度，$T_{e,\\text{core}}$ 是核心区电子温度，$V_\\text{core}$ 是核心区体积。对于单一杂质种类，核心区有效离子电荷 $Z_\\text{eff,core}$ 近似为：\n$$Z_\\text{eff,core} \\approx 1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2$$\n其中 $n_\\text{imp}$ 是体积平均的杂质密度，$r_\\text{core}$ 是滞留在核心区的总杂质份额，$Z_\\text{bar}^2$ 是杂质离子的有效平方电荷。结合这些，核心区韧致辐射功率为：\n$$P_\\text{brem,core} = B_\\text{core} \\left(1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2\\right)$$\n边缘谱线辐射功率建模为：\n$$P_\\text{line} = n_{e,\\text{line}} n_\\text{imp} L_\\text{line} V_\\text{line}$$\n其中 $n_{e,\\text{line}}$、$L_\\text{line}$ 和 $V_\\text{line}$ 分别是边缘辐射区的特征电子密度、冷却系数和体积。\n\n将 $P_\\text{brem,core}$ 和 $P_\\text{line}$ 的表达式代入功率平衡方程，即可求解所需的杂质密度 $n_\\text{imp}$。\n$$f_\\text{rad} P_\\text{in} = B_\\text{core} + B_\\text{core} \\left(\\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2\\right) + n_{e,\\text{line}} n_\\text{imp} L_\\text{line} V_\\text{line}$$\n令 $\\Delta P = f_\\text{rad} P_\\text{in} - B_\\text{core}$ 为必须由杂质辐射的额外功率。合并与 $n_\\text{imp}$ 成正比的项：\n$$\\Delta P = n_\\text{imp} \\left[ B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line} \\right]$$\n求解 $n_\\text{imp}$ 得：\n$$n_\\text{imp} = \\dfrac{f_\\text{rad} P_\\text{in} - B_\\text{core}}{B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line}}$$\n该方程仅在分子为正时有效，即 $f_\\text{rad} P_\\text{in} > B_\\text{core}$。如果 $f_\\text{rad} P_\\text{in} \\le B_\\text{core}$，则基线韧致辐射已经达到或超过目标辐射功率，因此不需要注入杂质，我们必须设置 $Q_\\text{imp} = 0$。\n\n接下来，我们必须强制执行等离子体纯度约束 $Z_\\text{eff,core} \\le Z_{\\text{eff},\\max}$。这为允许的杂质密度设定了上限。\n$$1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2 \\le Z_{\\text{eff},\\max}$$\n求解 $n_\\text{imp}$ 得到最大允许密度：\n$$n_{\\text{imp},\\max} = \\dfrac{n_{e,\\text{core}} \\left(Z_{\\text{eff},\\max} - 1\\right)}{r_\\text{core} Z_\\text{bar}^2}$$\n如果为达到目标 $f_\\text{rad}$ 所需的密度 $n_\\text{imp}$ 超过此限制，即 $n_\\text{imp} > n_{\\text{imp},\\max}$，则在指定约束下目标是不可行的。在这种情况下，结果指定为 $-1$。\n\n最后，如果情景是可行的（$0  n_\\text{imp} \\le n_{\\text{imp},\\max}$），我们可以从稳态粒子平衡计算所需的杂质注入率 $Q_\\text{imp}$：\n$$n_\\text{imp} = \\dfrac{Q_\\text{imp} \\tau_p}{V_\\text{tot}}$$\n其中 $\\tau_p$ 是杂质约束时间，$V_\\text{tot}$ 是总等离子体体积。因此，所需的注入率为：\n$$Q_\\text{imp} = \\dfrac{n_\\text{imp} V_\\text{tot}}{\\tau_p}$$\n计算算法将为每个提供的测试用例实现这些步骤。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for impurity seeding rates for the given test cases.\n    \"\"\"\n\n    # Define the constant C_brem\n    C_brem = 1.69e-38  # W*m^3*eV^(-1/2)\n\n    # List of test cases, each defined by a dictionary of parameters.\n    test_cases = [\n        # Test case 1 (feasible, neon-dominated edge radiation)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.05, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n        # Test case 2 (infeasible due to Z_eff constraint, neon with higher core retention)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.20, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n        # Test case 3 (feasible, argon-dominated edge radiation)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 5.0e-32, \"V_line\": 60,\n            \"Z_bar_sq\": 324, \"r_core\": 0.03, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.5, \"V_tot\": 170\n        },\n        # Test case 4 (boundary case, target below baseline bremsstrahlung)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.05, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.01,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n    ]\n\n    def calculate_seeding_rate(params, const_c_brem):\n        \"\"\"\n        Calculates the required impurity seeding rate for a single test case.\n        \"\"\"\n        # Step 1: Compute core baseline bremsstrahlung B_core\n        B_core = const_c_brem * params[\"n_e_core\"]**2 * np.sqrt(params[\"T_e_core\"]) * params[\"V_core\"]\n\n        # Calculate the required power to be radiated by impurities\n        P_rad_target = params[\"f_rad\"] * params[\"P_in\"]\n        delta_P = P_rad_target - B_core\n        \n        # Step 3a: Check if any impurity seeding is needed\n        if delta_P = 0:\n            return 0\n\n        # Step 2: Calculate required impurity density n_imp\n        # Denominator of the n_imp expression\n        brem_per_imp = B_core * (params[\"r_core\"] * params[\"Z_bar_sq\"] / params[\"n_e_core\"])\n        line_per_imp = params[\"n_e_line\"] * params[\"L_line\"] * params[\"V_line\"]\n        denominator = brem_per_imp + line_per_imp\n        \n        # Avoid division by zero, although physically unlikely with the given models\n        if denominator == 0:\n            return -1 # Infeasible if impurities have no radiative effect\n\n        n_imp_required = delta_P / denominator\n\n        # Step 3b: Impose the core effective ion charge constraint Z_eff,core = Z_eff,max\n        # which translates to a maximum impurity density n_imp,max\n        # Avoid division by zero if r_core or Z_bar_sq are zero\n        max_imp_denom = params[\"r_core\"] * params[\"Z_bar_sq\"]\n        if max_imp_denom == 0:\n            # If impurities don't affect Z_eff, the constraint is always met\n            n_imp_max = float('inf')\n        else:\n            n_imp_max = (params[\"n_e_core\"] * (params[\"Z_eff_max\"] - 1.0)) / max_imp_denom\n\n        if n_imp_required > n_imp_max:\n            return -1 # Infeasible if it violates the Z_eff constraint\n\n        # Step 4: Compute the required impurity seeding rate Q_imp\n        Q_imp = (n_imp_required * params[\"V_tot\"]) / params[\"tau_p\"]\n        \n        return Q_imp\n    \n    results = []\n    for case_params in test_cases:\n        result = calculate_seeding_rate(case_params, C_brem)\n        # Format -1 and 0 as integers for clarity in the output.\n        if isinstance(result, int) or result == 0:\n            results.append(int(result))\n        else:\n            results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3690607"}]}