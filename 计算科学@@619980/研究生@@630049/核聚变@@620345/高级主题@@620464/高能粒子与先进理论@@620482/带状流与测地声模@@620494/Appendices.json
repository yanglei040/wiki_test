{"hands_on_practices": [{"introduction": "带状流的核心机制是从径向变化的电势中产生剪切的极向流。本练习将引导你通过一个简化的圆柱几何模型，来推导这一基本过程。通过这个练习，你将亲手计算径向电势、径向电场和最终产生的$\\mathbf{E}\\times\\mathbf{B}$流剪切之间的直接关系，而流剪切是理解湍流调控的关键。[@problem_id:3725774]", "problem": "考虑一个具有同心圆形磁通面的大环径比托卡马克，其磁场主要由环向分量主导，因此 $B \\approx B_{\\phi}$，且局部几何可视为柱坐标，其标准正交基 $\\{\\hat{\\boldsymbol{e}}_{r}, \\hat{\\boldsymbol{e}}_{\\theta}, \\hat{\\boldsymbol{e}}_{\\phi}\\}$ 构成一个满足 $\\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{\\phi} = \\hat{\\boldsymbol{e}}_{\\theta}$ 的右手系。一个纬向流由一个仅取决于小半径的轴对称静电势产生，该电势由 $\\phi(r) = \\phi_{0} \\cos(k_{r} r)$ 给出，其中 $r$ 是小半径，$\\phi_{0}$ 是一个恒定振幅，$k_{r}$ 是一个实径向波数。从静电场和磁化带电流体漂移速度的基本定义出发，仅使用大环径比级数 $B \\approx B_{\\phi}$ 且 $B_{\\phi}$ 在主导阶上径向均匀的条件，推导与此纬向势相关的相应径向电场 $E_{r}(r)$ 和极向 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 流的剪切 $\\partial_{r} v_{E\\theta}(r)$。所有三角函数均以弧度为单位。将 $E_{r}$ 以国际单位制（SI）的伏特/米表示，将 $\\partial_{r} v_{E\\theta}$ 以国际单位制（SI）的秒的倒数表示。以单个闭式解析表达式的形式给出您的最终结果，该表达式包含排列为双元素行向量 $\\big(E_{r}(r), \\partial_{r} v_{E\\theta}(r)\\big)$ 的两个量，并用 $\\phi_{0}$、$k_{r}$ 和 $B_{\\phi}$ 表示。无需进行数值计算。", "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n**问题验证**\n\n**第1步：提取已知条件**\n- **系统：** 大环径比托卡马克，同心圆形磁通面。\n- **磁场：** $B \\approx B_{\\phi}$。\n- **几何：** 局部柱坐标，标准正交基为 $\\{\\hat{\\boldsymbol{e}}_{r}, \\hat{\\boldsymbol{e}}_{\\theta}, \\hat{\\boldsymbol{e}}_{\\phi}\\}$。\n- **坐标系法则：** 右手系，满足 $\\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{\\phi} = \\hat{\\boldsymbol{e}}_{\\theta}$。\n- **静电势：** $\\phi(r) = \\phi_{0} \\cos(k_{r} r)$，其中 $r$ 是小半径。\n- **参数：** $\\phi_{0}$ 是恒定振幅，$k_{r}$ 是实径向波数。\n- **磁场均匀性：** $B_{\\phi}$ 在主导阶上径向均匀。\n- **待推导量：** 径向电场 $E_{r}(r)$ 和极向 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 流的剪切 $\\partial_{r} v_{E\\theta}(r)$。\n- **最终结果格式：** 一个双元素行向量 $\\left( E_{r}(r), \\partial_{r} v_{E\\theta}(r) \\right)$，用 $\\phi_{0}$、$k_{r}$ 和 $B_{\\phi}$ 表示。\n\n**第2步：使用提取的已知条件进行验证**\n该问题有科学依据，基于等离子体物理学的基本原理，包括静电场（$\\boldsymbol{E} = -\\nabla\\phi$）和 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 漂移速度的定义。所使用的近似，如大环径比极限和简化的柱坐标几何，是标准的且适用于对托卡马克中纬向流的解析处理。该问题是适定的，提供了所有必要信息，包括对坐标系手性的明确（尽管非标准）定义，该定义是自洽且在数学上有效的。不存在矛盾、歧义或主观因素。该问题是一个可形式化的物理推导。\n\n**第3步：结论与行动**\n问题有效。将提供完整的解答。\n\n**求解推导**\n\n推导过程分三步进行：首先，根据给定电势计算径向电场；其次，计算极向 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 漂移速度；第三，计算该速度的径向剪切。\n\n**1. 径向电场, $E_{r}(r)$**\n\n静电场 $\\boldsymbol{E}$ 定义为静电势 $\\phi$ 的负梯度：\n$$\n\\boldsymbol{E} = -\\nabla \\phi\n$$\n鉴于柱坐标几何以及电势 $\\phi(r)$ 仅取决于小半径 $r$，梯度算子简化为 $\\nabla = \\hat{\\boldsymbol{e}}_{r} \\frac{\\partial}{\\partial r}$。因此，电场是纯径向的：\n$$\n\\boldsymbol{E} = -\\hat{\\boldsymbol{e}}_{r} \\frac{\\partial}{\\partial r} \\phi(r)\n$$\n给定的电势为 $\\phi(r) = \\phi_{0} \\cos(k_{r} r)$。对其求关于 $r$ 的导数：\n$$\n\\frac{\\partial \\phi}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( \\phi_{0} \\cos(k_{r} r) \\right) = \\phi_{0} (-\\sin(k_{r} r)) \\cdot k_{r} = -k_{r} \\phi_{0} \\sin(k_{r} r)\n$$\n将此结果代回 $\\boldsymbol{E}$ 的表达式中：\n$$\n\\boldsymbol{E}(r) = - \\hat{\\boldsymbol{e}}_{r} \\left( -k_{r} \\phi_{0} \\sin(k_{r} r) \\right) = k_{r} \\phi_{0} \\sin(k_{r} r) \\hat{\\boldsymbol{e}}_{r}\n$$\n因此，电场的径向分量 $E_{r}(r)$ 为：\n$$\nE_{r}(r) = k_{r} \\phi_{0} \\sin(k_{r} r)\n$$\n\n**2. 极向 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 流速, $v_{E\\theta}(r)$**\n\n$\\boldsymbol{E} \\times \\boldsymbol{B}$ 漂移速度 $\\boldsymbol{v}_{E}$ 定义为：\n$$\n\\boldsymbol{v}_{E} = \\frac{\\boldsymbol{E} \\times \\boldsymbol{B}}{B^{2}}\n$$\n问题指明使用近似 $\\boldsymbol{B} \\approx B_{\\phi} \\hat{\\boldsymbol{e}}_{\\phi}$，因此 $B^{2} \\approx B_{\\phi}^{2}$。代入 $\\boldsymbol{E}$ 和 $\\boldsymbol{B}$ 的表达式：\n$$\n\\boldsymbol{v}_{E}(r) \\approx \\frac{\\left( E_{r}(r) \\hat{\\boldsymbol{e}}_{r} \\right) \\times \\left( B_{\\phi} \\hat{\\boldsymbol{e}}_{\\phi} \\right)}{B_{\\phi}^{2}} = \\frac{E_{r}(r)}{B_{\\phi}} \\left( \\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{\\phi} \\right)\n$$\n现在我们使用明确给出的坐标系法则：$\\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{\\phi} = \\hat{\\boldsymbol{e}}_{\\theta}$。这产生了一个纯极向流：\n$$\n\\boldsymbol{v}_{E}(r) \\approx \\frac{E_{r}(r)}{B_{\\phi}} \\hat{\\boldsymbol{e}}_{\\theta}\n$$\n该速度的极向分量 $v_{E\\theta}(r)$ 为：\n$$\nv_{E\\theta}(r) = \\frac{E_{r}(r)}{B_{\\phi}} = \\frac{k_{r} \\phi_{0} \\sin(k_{r} r)}{B_{\\phi}}\n$$\n\n**3. 极向流剪切, $\\partial_{r} v_{E\\theta}(r)$**\n\n极向流的剪切是其径向导数 $\\partial_{r} v_{E\\theta}(r)$。我们对 $v_{E\\theta}(r)$ 的表达式求关于 $r$ 的导数。在此微分中，参数 $\\phi_{0}$、$k_{r}$ 和 $B_{\\phi}$ 被视为常数，这与问题陈述中 $B_{\\phi}$ 在主导阶上径向均匀的说法一致。\n$$\n\\partial_{r} v_{E\\theta}(r) = \\frac{\\partial}{\\partial r} \\left( \\frac{k_{r} \\phi_{0} \\sin(k_{r} r)}{B_{\\phi}} \\right) = \\frac{k_{r} \\phi_{0}}{B_{\\phi}} \\frac{\\partial}{\\partial r} \\left( \\sin(k_{r} r) \\right)\n$$\n正弦函数的导数为：\n$$\n\\frac{\\partial}{\\partial r} \\left( \\sin(k_{r} r) \\right) = \\cos(k_{r} r) \\cdot k_{r} = k_{r} \\cos(k_{r} r)\n$$\n将其代回，我们得到流剪切：\n$$\n\\partial_{r} v_{E\\theta}(r) = \\frac{k_{r} \\phi_{0}}{B_{\\phi}} \\left( k_{r} \\cos(k_{r} r) \\right) = \\frac{k_{r}^{2} \\phi_{0} \\cos(k_{r} r)}{B_{\\phi}}\n$$\n\n**最终结果组合**\n\n推导出的两个量是：\n$$\nE_{r}(r) = k_{r} \\phi_{0} \\sin(k_{r} r)\n$$\n$$\n\\partial_{r} v_{E\\theta}(r) = \\frac{k_{r}^{2} \\phi_{0} \\cos(k_{r} r)}{B_{\\phi}}\n$$\n将它们排列成所要求的双元素行向量 $\\left( E_{r}(r), \\partial_{r} v_{E\\theta}(r) \\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nk_{r} \\phi_{0} \\sin(k_{r} r) & \\frac{k_{r}^{2} \\phi_{0} \\cos(k_{r} r)}{B_{\\phi}}\n\\end{pmatrix}\n}\n$$", "id": "3725774"}, {"introduction": "在真实的托卡马克中，环形几何结构引入了新的复杂性。本练习在前一个练习的基础上，从简化的圆柱模型转向更真实的环形几何。你将推导一个由径向电场驱动的极向$\\mathbf{E}\\times\\mathbf{B}$漂移，并计算其磁面平均值，揭示环效应如何导致一个非零的平均流，这是理解带状流和测地声模耦合的关键一步。[@problem_id:3725814]", "problem": "考虑一个轴对称、大环径比的托卡马克，其大半径为 $R_{0}$，小半径为 $r \\ll R_{0}$，具有由极向角 $\\theta$ 参数化的圆形磁通面，因此局部大半径满足 $R(\\theta) = R_{0} + r \\cos\\theta$。设磁场写作 $\\mathbf{B} = B_{\\phi}(R)\\,\\mathbf{e}_{\\phi} + B_{\\theta}(r, \\theta)\\,\\mathbf{e}_{\\theta}$，其中环向分量为 $B_{\\phi}(R) = B_{0} R_{0}/R$，极向分量受安全因子 $q$ 的约束，满足 $q = r B_{\\phi}/(R B_{\\theta})$，这意味着 $B_{\\theta}(r, \\theta) = r B_{\\phi}(R)/(q R)$。假设 $B_{\\phi} \\gg B_{\\theta}$，但在磁场大小中保留 $B_{\\theta}$ 的领头修正项。\n\n带状势仅依赖于小半径，即 $\\phi(r)$，产生一个纯径向的电场 $\\mathbf{E}(r) = -\\nabla \\phi(r) = -\\phi^{\\prime}(r)\\,\\mathbf{e}_{r}$。从电场叉磁场漂移 $\\mathbf{v}_{E} = \\frac{c}{B^{2}}\\,\\mathbf{E}\\times \\mathbf{B}$（其中 $c$ 是光速）出发，依据第一性原理推导 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的极向分量 $v_{E\\theta}(r,\\theta)$，然后计算其磁通面平均值 $\\langle v_{E\\theta}(r)\\rangle = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} v_{E\\theta}(r,\\theta)\\,d\\theta$，保留小参数 $\\varepsilon = r/R_{0}$ 的二阶项，即保留到 $\\mathcal{O}(\\varepsilon^{2})$。\n\n设带状势具体为 $\\phi(r) = \\phi_{0}\\,\\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right)$，其中 $\\phi_{0}$ 和 $\\sigma$ 是正常数，并假设安全因子 $q$ 在磁通面上是常数。其背景是带状流及其与测地声模 (GAM) 的耦合，其中由 $\\phi(r)$ 产生的极向 $\\mathbf{E}\\times\\mathbf{B}$ 流起着核心作用。\n\n将您的最终结果表示为磁通面平均的极向流剖面 $\\langle v_{E\\theta}(r)\\rangle$ 的单一闭合解析表达式，该表达式是 $r$, $q$, $R_{0}$, $B_{0}$, $c$, $\\phi_{0}$ 和 $\\sigma$ 的函数，并且在 $\\mathcal{O}((r/R_{0})^{2})$ 阶有效。速度单位使用厘米/秒。不需要进行数值代入。不要提供中间结果；只呈现最终表达式。不需要四舍五入，最终的方框表达式内不应出现单位。", "solution": "用户要求在大环径比托卡马克中，对磁通面平均的极向 $\\mathbf{E}\\times\\mathbf{B}$ 漂移进行分步推导，结果对逆环径比 $\\varepsilon = r/R_0$ 保留到二阶精度。\n\n### 步骤 1：问题验证\n\n**1.1. 提取的已知条件：**\n-   **几何**：轴对称、大环径比托卡马克。大半径 $R_{0}$，小半径 $r \\ll R_{0}$。\n-   **坐标**：由极向角 $\\theta$ 参数化的圆形磁通面。局部大半径 $R(\\theta) = R_{0} + r \\cos\\theta$。\n-   **磁场**：$\\mathbf{B} = B_{\\phi}(R)\\,\\mathbf{e}_{\\phi} + B_{\\theta}(r, \\theta)\\,\\mathbf{e}_{\\theta}$。\n-   **环向场分量**：$B_{\\phi}(R) = B_{0} R_{0}/R$。\n-   **极向场分量**：$B_{\\theta}(r, \\theta) = r B_{\\phi}(R)/(q R)$，其中 $q$ 是安全因子，假设在磁通面上为常数。\n-   **场量级**：$B_{\\phi} \\gg B_{\\theta}$。\n-   **电场**：$\\mathbf{E}(r) = -\\nabla \\phi(r) = -\\phi^{\\prime}(r)\\,\\mathbf{e}_{r}$，由纯径向势 $\\phi(r)$ 导出。\n-   **E叉B漂移**：$\\mathbf{v}_{E} = \\frac{c}{B^{2}}\\,\\mathbf{E}\\times \\mathbf{B}$，其中 $c$ 是光速。\n-   **任务**：推导极向分量 $v_{E\\theta}(r,\\theta)$ 并计算其磁通面平均值 $\\langle v_{E\\theta}(r)\\rangle = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} v_{E\\theta}(r,\\theta)\\,d\\theta$。\n-   **近似**：结果必须对小参数 $\\varepsilon = r/R_{0}$ 精确到二阶，即包含到 $\\mathcal{O}(\\varepsilon^{2})$ 的项。\n-   **势剖面**：$\\phi(r) = \\phi_{0}\\,\\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right)$，其中 $\\phi_{0}, \\sigma$ 是正常数。\n\n**1.2. 验证：**\n-   **科学依据**：该问题是等离子体物理学中的一个标准练习，特别是在托卡马克中的输运和磁流体动力学模式研究方面。几何结构、场定义和漂移速度公式是该领域的基础。\n-   **适定性**：问题提供了所有必要的定义和参数。要求对一个小参数推导到特定阶数是一个明确定义的数学任务，会得到唯一的解。\n-   **客观性**：问题以精确的数学语言陈述，没有主观或模糊的术语。\n\n**1.3. 结论：**\n问题有效。这是一个基于既定原理的、明确定义的物理问题。我将继续进行求解。\n\n### 步骤 2：磁通面平均的极向漂移推导\n\n目标是计算 $\\langle v_{E\\theta}(r) \\rangle$。我们首先计算 $\\mathbf{E}\\times\\mathbf{B}$ 漂移矢量。电场和磁场由以下公式给出：\n$$ \\mathbf{E} = -\\phi^{\\prime}(r)\\,\\mathbf{e}_{r} $$\n$$ \\mathbf{B} = B_{\\theta}(r, \\theta)\\,\\mathbf{e}_{\\theta} + B_{\\phi}(R)\\,\\mathbf{e}_{\\phi} $$\n叉积 $\\mathbf{E}\\times\\mathbf{B}$ 为：\n$$ \\mathbf{E}\\times\\mathbf{B} = \\left(-\\phi^{\\prime}(r)\\,\\mathbf{e}_{r}\\right) \\times \\left(B_{\\theta}\\,\\mathbf{e}_{\\theta} + B_{\\phi}\\,\\mathbf{e}_{\\phi}\\right) $$\n使用右手环坐标系 $(r, \\theta, \\phi)$ 的叉积规则，其中 $\\mathbf{e}_r \\times \\mathbf{e}_\\theta = \\mathbf{e}_\\phi$ 和 $\\mathbf{e}_r \\times \\mathbf{e}_\\phi = -\\mathbf{e}_\\theta$，我们得到：\n$$ \\mathbf{E}\\times\\mathbf{B} = -\\phi^{\\prime}(r) \\left( B_{\\theta} (\\mathbf{e}_{r}\\times\\mathbf{e}_{\\theta}) + B_{\\phi} (\\mathbf{e}_{r}\\times\\mathbf{e}_{\\phi}) \\right) = -\\phi^{\\prime}(r) \\left( B_{\\theta}\\,\\mathbf{e}_{\\phi} - B_{\\phi}\\,\\mathbf{e}_{\\theta} \\right) = \\phi^{\\prime}(r) B_{\\phi}\\,\\mathbf{e}_{\\theta} - \\phi^{\\prime}(r) B_{\\theta}\\,\\mathbf{e}_{\\phi} $$\n$\\mathbf{E}\\times\\mathbf{B}$ 漂移速度的极向分量 $v_{E\\theta}$ 是平行于 $\\mathbf{e}_{\\theta}$ 的分量：\n$$ v_{E\\theta}(r, \\theta) = \\frac{c}{B^{2}} \\left( \\phi^{\\prime}(r) B_{\\phi}(R) \\right) $$\n为了将此表达式计算到 $\\mathcal{O}(\\varepsilon^2)$，我们必须将 $B_{\\phi}$ 和 $B^2$ 按 $\\varepsilon = r/R_0$ 的幂次展开。\n\n首先，我们展开磁场分量。局部大半径为 $R = R_0 + r\\cos\\theta = R_0(1+\\varepsilon\\cos\\theta)$。\n环向场分量为：\n$$ B_{\\phi} = \\frac{B_0 R_0}{R} = \\frac{B_0 R_0}{R_0(1+\\varepsilon\\cos\\theta)} = B_0 (1+\\varepsilon\\cos\\theta)^{-1} $$\n展开到 $\\varepsilon$ 的二阶：\n$$ B_{\\phi} \\approx B_0 \\left(1 - \\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta\\right) $$\n磁场大小的平方为 $B^2 = B_\\phi^2 + B_\\theta^2$。\n$$ B_\\theta = \\frac{r B_\\phi}{q R} = \\frac{r}{q R_0(1+\\varepsilon\\cos\\theta)} \\left( \\frac{B_0 R_0}{R_0(1+\\varepsilon\\cos\\theta)} \\right) = \\frac{\\varepsilon B_0}{q(1+\\varepsilon\\cos\\theta)^2} $$\n因此，$B^2$ 为：\n$$ B^2 = \\left( \\frac{B_0}{1+\\varepsilon\\cos\\theta} \\right)^2 + \\left( \\frac{\\varepsilon B_0}{q(1+\\varepsilon\\cos\\theta)^2} \\right)^2 = B_0^2 \\left( (1+\\varepsilon\\cos\\theta)^{-2} + \\frac{\\varepsilon^2}{q^2}(1+\\varepsilon\\cos\\theta)^{-4} \\right) $$\n我们将每一项展开到所需精度。保留到 $\\mathcal{O}(\\varepsilon^2)$ 的项：\n$$ (1+\\varepsilon\\cos\\theta)^{-2} \\approx 1 - 2\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta $$\n$$ (1+\\varepsilon\\cos\\theta)^{-4} \\approx 1 - 4\\varepsilon\\cos\\theta + \\dots \\approx 1 \\quad (\\text{因为它乘以了 } \\varepsilon^2) $$\n将这些展开式代入 $B^2$ 的表达式中：\n$$ B^2 \\approx B_0^2 \\left( (1 - 2\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta) + \\frac{\\varepsilon^2}{q^2} \\right) = B_0^2 \\left(1 - 2\\varepsilon\\cos\\theta + \\left(3\\cos^2\\theta + \\frac{1}{q^2}\\right)\\varepsilon^2\\right) $$\n现在我们构建比值 $B_\\phi/B^2$：\n$$ \\frac{B_\\phi}{B^2} \\approx \\frac{B_0(1-\\varepsilon\\cos\\theta+\\varepsilon^2\\cos^2\\theta)}{B_0^2\\left(1 - 2\\varepsilon\\cos\\theta + \\left(3\\cos^2\\theta + \\frac{1}{q^2}\\right)\\varepsilon^2\\right)} = \\frac{1}{B_0} \\frac{1-\\varepsilon\\cos\\theta+\\varepsilon^2\\cos^2\\theta}{1 - \\left[2\\varepsilon\\cos\\theta - \\left(3\\cos^2\\theta + \\frac{1}{q^2}\\right)\\varepsilon^2\\right]} $$\n使用几何级数展开 $(1-x)^{-1} \\approx 1+x+x^2$，其中 $x = 2\\varepsilon\\cos\\theta - \\left(3\\cos^2\\theta + \\frac{1}{q^2}\\right)\\varepsilon^2$：\n$$ \\frac{B_\\phi}{B^2} \\approx \\frac{1}{B_0} (1-\\varepsilon\\cos\\theta+\\varepsilon^2\\cos^2\\theta) \\left(1 + \\left[2\\varepsilon\\cos\\theta - \\left(3\\cos^2\\theta + \\frac{1}{q^2}\\right)\\varepsilon^2\\right] + (2\\varepsilon\\cos\\theta)^2 \\right) $$\n$$ \\frac{B_\\phi}{B^2} \\approx \\frac{1}{B_0} (1-\\varepsilon\\cos\\theta+\\varepsilon^2\\cos^2\\theta) \\left(1 + 2\\varepsilon\\cos\\theta + \\left(-3\\cos^2\\theta - \\frac{1}{q^2} + 4\\cos^2\\theta\\right)\\varepsilon^2 \\right) $$\n$$ \\frac{B_\\phi}{B^2} \\approx \\frac{1}{B_0} (1-\\varepsilon\\cos\\theta+\\varepsilon^2\\cos^2\\theta) \\left(1 + 2\\varepsilon\\cos\\theta + \\left(\\cos^2\\theta - \\frac{1}{q^2}\\right)\\varepsilon^2 \\right) $$\n将这些表达式相乘并保留到 $\\mathcal{O}(\\varepsilon^2)$ 的项：\n-   $\\mathcal{O}(1)$ 阶： $1 \\times 1 = 1$。\n-   $\\mathcal{O}(\\varepsilon)$ 阶：$1 \\times (2\\varepsilon\\cos\\theta) + (-\\varepsilon\\cos\\theta) \\times 1 = \\varepsilon\\cos\\theta$。\n-   $\\mathcal{O}(\\varepsilon^2)$ 阶：$1 \\times \\left(\\varepsilon^2(\\cos^2\\theta - 1/q^2)\\right) + (-\\varepsilon\\cos\\theta) \\times (2\\varepsilon\\cos\\theta) + (\\varepsilon^2\\cos^2\\theta) \\times 1 = (\\cos^2\\theta - 1/q^2 - 2\\cos^2\\theta + \\cos^2\\theta)\\varepsilon^2 = -\\frac{\\varepsilon^2}{q^2}$。\n因此，该比值的最终展开式为：\n$$ \\frac{B_\\phi}{B^2} \\approx \\frac{1}{B_0} \\left( 1 + \\varepsilon\\cos\\theta - \\frac{\\varepsilon^2}{q^2} \\right) $$\n将此结果代回 $v_{E\\theta}$ 的表达式中：\n$$ v_{E\\theta}(r,\\theta) \\approx \\frac{c \\phi'(r)}{B_0} \\left( 1 + \\frac{r}{R_0}\\cos\\theta - \\frac{r^2}{R_0^2 q^2} \\right) $$\n现在我们计算问题中定义的磁通面平均值：\n$$ \\langle v_{E\\theta}(r)\\rangle = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} v_{E\\theta}(r,\\theta)\\,d\\theta = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\frac{c \\phi'(r)}{B_0} \\left( 1 + \\frac{r}{R_0}\\cos\\theta - \\frac{r^2}{R_0^2 q^2} \\right) d\\theta $$\n由于 $\\phi'$, $c$, $B_0$, $r$, $R_0$ 和 $q$ 均与 $\\theta$ 无关，我们可以将它们从积分中提出：\n$$ \\langle v_{E\\theta}(r)\\rangle = \\frac{c \\phi'(r)}{B_0} \\left( \\frac{1}{2\\pi}\\int_{0}^{2\\pi} 1 \\,d\\theta + \\frac{r}{R_0}\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\cos\\theta \\,d\\theta - \\frac{r^2}{R_0^2 q^2}\\frac{1}{2\\pi}\\int_{0}^{2\\pi} 1 \\,d\\theta \\right) $$\n这些是标准积分：$\\int_{0}^{2\\pi} 1 \\,d\\theta = 2\\pi$ 和 $\\int_{0}^{2\\pi}\\cos\\theta \\,d\\theta = 0$。\n$$ \\langle v_{E\\theta}(r)\\rangle = \\frac{c \\phi'(r)}{B_0} \\left( 1 + 0 - \\frac{r^2}{R_0^2 q^2} \\right) = \\frac{c \\phi'(r)}{B_0} \\left(1 - \\frac{r^2}{q^2 R_0^2} \\right) $$\n最后，我们代入指定的势剖面 $\\phi(r) = \\phi_0 \\exp(-r^2/\\sigma^2)$。其导数为：\n$$ \\phi'(r) = \\frac{d}{dr}\\left(\\phi_0 \\exp\\left(-\\frac{r^2}{\\sigma^2}\\right)\\right) = \\phi_0 \\exp\\left(-\\frac{r^2}{\\sigma^2}\\right) \\left(-\\frac{2r}{\\sigma^2}\\right) = -\\frac{2r\\phi_0}{\\sigma^2}\\exp\\left(-\\frac{r^2}{\\sigma^2}\\right) $$\n代入此导数，得到平均极向流的最终表达式：\n$$ \\langle v_{E\\theta}(r)\\rangle = \\frac{c}{B_0} \\left(-\\frac{2r\\phi_0}{\\sigma^2}\\exp\\left(-\\frac{r^2}{\\sigma^2}\\right)\\right) \\left(1 - \\frac{r^2}{q^2 R_0^2} \\right) $$\n$$ \\langle v_{E\\theta}(r)\\rangle = -\\frac{2c\\phi_0 r}{B_0 \\sigma^2} \\left(1 - \\frac{r^2}{q^2 R_0^2} \\right) \\exp\\left(-\\frac{r^2}{\\sigma^2}\\right) $$\n该表达式表示极向上的剩余带状流，这是输运垒和测地声模物理学中的一个关键组成部分。计算是在 CGS 单位制下进行的，这由 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的形式所暗示，因此速度的结果单位是 cm/s。", "answer": "$$\n\\boxed{-\\frac{2c\\phi_{0}r}{B_{0}\\sigma^{2}} \\left(1 - \\frac{r^{2}}{q^{2}R_{0}^{2}}\\right) \\exp\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right)}\n$$", "id": "3725814"}, {"introduction": "理论物理与现代计算科学的结合是聚变研究的前沿。本练习将理论与实践相结合，要求你验证著名的Rosenbluth-Hinton剩余带状流理论。你将编写一个简化的程序来模拟带状流的长时间演化，并将其“测量”结果与理论预测进行比较，这是一个将基础理论应用于验证复杂模拟代码的典型例子。[@problem_id:3725799]", "problem": "考虑一个处于无碰撞、静电、长波极限下的轴对称托卡马克等离子体，其中电子是绝热的，环径比较大，初始条件是纯带状势。目标是通过计算势的带状分量的长时间剩余水平，并将其与归因于 Rosenbluth 和 Hinton 的理论推导预测进行比较，为回旋动理学算法指定验证测试。你的任务是编写一个程序，对于一组给定的安全因子和反环径比值，计算理论预测的剩余分数，并从一个简化的测地声模弛豫模型中数值测量剩余分数，然后在指定的容差内检查两者是否一致。\n\n要求和假设如下：\n- 使用无碰撞、静电、轴对称托卡马克极限，其中电子绝热响应，离子是回旋动理学的，并且波长足够长以至于 $k_r \\rho_i \\ll 1$。初始条件是纯带状势，没有初始的极向或环向模耦合。\n- 将势归一化为 $e \\phi / T_i$ 使其无量纲，并将时间归一化为 $R / c_s$ 使特征测地声模频率无量纲。三角函数中的角度必须以弧度为单位。\n- 长时间剩余分数 $\\mathcal{R}(q,\\epsilon)$ 定义为 $\\mathcal{R}(q,\\epsilon) = \\phi_\\infty / \\phi_0$，其中 $\\phi_0$ 是初始带状势振幅，$\\phi_\\infty$ 是测地声模弛豫后势的长时间极限。\n- 理论预测的剩余分数必须通过在大环径比托卡马克极限下使用准中性和新经典极化的第一性原理推导获得，并且必须依赖于安全因子 $q$ 和反环径比 $\\epsilon$。\n- 为在简化模型中模拟测量，通过以下形式的阻尼测地声模弛豫来表示带状势的时间演化：\n$$\n\\phi(t) = \\phi_\\infty + \\left(\\phi_0 - \\phi_\\infty\\right) \\exp\\left(-\\gamma t\\right) \\cos\\left(\\omega_G t\\right),\n$$\n其中 $\\gamma$ 是无量纲阻尼率，$\\omega_G$ 是无量纲测地声模频率；在这个简化的、大环径比、等温极限下，将 $\\gamma$ 和 $\\omega_G$ 视为与 $q$ 和 $\\epsilon$ 无关的常数。使用 $\\omega_G = \\sqrt{11/4}$（在流体极限中对应于离子-电子温度比 $\\tau = T_i/T_e = 1$），并选择一个适度的阻尼 $\\gamma$ 以使指数项在长时间后变得可忽略不计。通过计算一个较大时间 $T$ 下的 $\\phi(T)/\\phi_0$ 来测量剩余分数。\n- 为理论与测量之间的一致性指定一个容差 $\\delta$，如果 $|\\mathcal{R}_{\\mathrm{meas}} - \\mathcal{R}_{\\mathrm{theory}}| \\le \\delta$ 则输出布尔值 $True$，否则输出 $False$。\n\n测试套件：\n- 使用以下测试用例集，每个用例指定为一个元组 $(q, \\epsilon, \\phi_0)$：\n    - Case A (正常路径): $(q, \\epsilon, \\phi_0) = (2.0, 0.1, 1.0)$。\n    - Case B (较低安全因子): $(q, \\epsilon, \\phi_0) = (1.0, 0.1, 1.0)$。\n    - Case C (较小反环径比): $(q, \\epsilon, \\phi_0) = (2.0, 0.01, 1.0)$。\n    - Case D (较大反环径比和较高 $q$): $(q, \\epsilon, \\phi_0) = (2.5, 0.3, 0.5)$。\n    - Case E (非常低的 $q$ 和中等 $\\epsilon$): $(q, \\epsilon, \\phi_0) = (0.7, 0.2, 1.0)$。\n    - Case F (高 $q$ 和小 $\\epsilon$): $(q, \\epsilon, \\phi_0) = (4.0, 0.05, 1.0)$。\n- 选择一个数值测量时间 $T$，使得 $\\exp(-\\gamma T)$ 在数值上可以忽略不计，并设置容差 $\\delta = 10^{-6}$。\n\n程序输出规范：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个条目对应一个测试用例，顺序与上文相同，并且是一个布尔值，指示测量的剩余分数是否在容差 $\\delta$ 内与理论预测的剩余分数一致。例如，如果所有测试都通过，程序应打印一行形如 $[\\mathrm{True},\\mathrm{True},\\mathrm{True},\\mathrm{True},\\mathrm{True},\\mathrm{True}]$ 的内容。\n\n注意：所有计算通过构造都是无量纲的，因此输出不需要物理单位。$\\cos(\\cdot)$ 中的角度以弧度为单位，简化测量模型中使用的所有数值常数必须在程序中明确定义。", "solution": "该问题要求通过将理论推导的长时间剩余带状势与从简化弛豫模型中数值测量的值进行比较，为回旋动理学算法创建一个验证测试。该比较必须针对由安全因子 $q$ 和反环径比 $\\epsilon$ 定义的几个测试用例进行。\n\n首先，我们必须推导剩余势分数的理论预测 $\\mathcal{R}_{\\mathrm{theory}}(q,\\epsilon)$，该预测归功于 Rosenbluth 和 Hinton。此推导根植于无碰撞、大环径比托卡马克等离子体中的准中性和新经典极化原理。\n\n带状势在磁通量面上是恒定的，作为初始条件 $\\phi_0$ 被建立。等离子体响应以屏蔽此势。在非常短的时间尺度上（离子回旋周期的量级），屏蔽由经典离子极化漂移提供。在长波极限 $k_\\perp \\rho_i \\ll 1$下（其中 $k_\\perp$ 是垂直波数，$\\rho_i$ 是离子回旋半径），等离子体表现出一定的“经典”电容 $C_{cl}$。感应电荷密度通过该电容与势相关。\n\n在更长的时间尺度上，即离子渡越或弹跳运动的特征时间，新经典效应变得重要。在轴对称托卡马克中，带电粒子并非完美地限制在单个磁通量面上。特别是捕获粒子，会执行具有显著径向范围的“香蕉”轨道。径向电场（与带状势相关）的存在会改变这些香蕉轨道，导致等离子体产生额外的径向极化。这就是新经典极化效应，对应于一个额外的“新经典”电容 $C_{neo}$。\n\n等离子体的总长时间电容为 $C_{total} = C_{cl} + C_{neo}$。根据电荷守恒，由初始势源生的电荷必须与最终状态所持有的电荷相同。\n最初，在时间 $t=0^+$，只有快速的经典极化响应：\n$Q = C_{cl} \\phi_0$。\n在长时间极限 $t \\to \\infty$ 下，非周期性带状势稳定到一个剩余值 $\\phi_\\infty$，系统由全部（经典加新经典）电容屏蔽：\n$Q = (C_{cl} + C_{neo}) \\phi_\\infty$。\n\n将守恒电荷 $Q$ 的表达式相等，得到：\n$$C_{cl} \\phi_0 = (C_{cl} + C_{neo}) \\phi_\\infty$$\n因此，剩余分数 $\\mathcal{R}_{\\mathrm{theory}} = \\phi_\\infty / \\phi_0$ 由电容之比给出：\n$$\\mathcal{R}_{\\mathrm{theory}} = \\frac{\\phi_\\infty}{\\phi_0} = \\frac{C_{cl}}{C_{cl} + C_{neo}} = \\frac{1}{1 + C_{neo}/C_{cl}}$$\nRosenbluth 和 Hinton 的开创性工作在无碰撞、大环径比 ($\\epsilon = r/R_0 \\ll 1$) 极限下给出了新经典极化与经典极化之比的解析表达式：\n$$\\frac{C_{neo}}{C_{cl}} \\approx 1.6 \\frac{q^2}{\\sqrt{\\epsilon}}$$\n其中 $q$ 是安全因子，$\\epsilon$ 是反环径比。数值因子 $1.6$ 是一个广泛使用的近似值。将此代入我们的剩余分数表达式，得到待实现的理论公式：\n$$\\mathcal{R}_{\\mathrm{theory}}(q, \\epsilon) = \\frac{1}{1 + 1.6 q^2 / \\sqrt{\\epsilon}}$$\n该公式对任何正值的 $q$ 和 $\\epsilon$ 都有效。\n\n接下来，我们分析为模拟数值测量而提供的带状势 $\\phi(t)$ 时间演化的简化模型。该模型给出为：\n$$\\phi(t) = \\phi_\\infty + \\left(\\phi_0 - \\phi_\\infty\\right) \\exp\\left(-\\gamma t\\right) \\cos\\left(\\omega_G t\\right)$$\n这里，$\\phi_0$ 是初始势，$\\phi_\\infty = \\mathcal{R}_{\\mathrm{theory}} \\phi_0$ 是渐近剩余势，$\\gamma$ 是阻尼率，$\\omega_G$ 是测地声模 (GAM) 频率。问题指定无量纲 GAM 频率为 $\\omega_G = \\sqrt{11/4}$。测量的剩余分数 $\\mathcal{R}_{\\mathrm{meas}}$ 定义为在一个较大但有限的时间 $T$ 下的 $\\phi(T)/\\phi_0$。将模型方程两边除以 $\\phi_0$ 得到：\n$$\\frac{\\phi(t)}{\\phi_0} = \\frac{\\phi_\\infty}{\\phi_0} + \\left(1 - \\frac{\\phi_\\infty}{\\phi_0}\\right) \\exp\\left(-\\gamma t\\right) \\cos\\left(\\omega_G t\\right)$$\n代入 $\\mathcal{R}_{\\mathrm{theory}} = \\phi_\\infty/\\phi_0$，在时间 $T$ 的测量剩余为：\n$$\\mathcal{R}_{\\mathrm{meas}} = \\mathcal{R}_{\\mathrm{theory}} + (1 - \\mathcal{R}_{\\mathrm{theory}}) \\exp(-\\gamma T) \\cos(\\omega_G T)$$\n验证测试包括检查“测量值”是否在给定的容差 $\\delta = 10^{-6}$ 内足够接近理论值：\n$$|\\mathcal{R}_{\\mathrm{meas}} - \\mathcal{R}_{\\mathrm{theory}}| \\le \\delta$$\n代入 $\\mathcal{R}_{\\mathrm{meas}}$ 的表达式，该条件变为：\n$$|(\\mathcal{R}_{\\mathrm{theory}} + (1 - \\mathcal{R}_{\\mathrm{theory}}) e^{-\\gamma T} \\cos(\\omega_G T)) - \\mathcal{R}_{\\mathrm{theory}}| \\le \\delta$$\n$$|(1 - \\mathcal{R}_{\\mathrm{theory}}) e^{-\\gamma T} \\cos(\\omega_G T)| \\le \\delta$$\n左边的项代表由于在有限时间 $T$ 测量而产生的数值误差。为确保对任何测试用例都满足此条件，我们必须适当地选择数值参数 $\\gamma$ 和 $T$。我们知道 $|\\cos(\\omega_G T)| \\le 1$。项 $1 - \\mathcal{R}_{\\mathrm{theory}}$ 也是有界的：由于 $\\mathcal{R}_{\\mathrm{theory}} = (1 + 1.6 q^2/\\sqrt{\\epsilon})^{-1}$，对于正的 $q$ 和 $\\epsilon$，我们有 $0  \\mathcal{R}_{\\mathrm{theory}} \\le 1$，这意味着 $0 \\le 1 - \\mathcal{R}_{\\mathrm{theory}}  1$。因此，如果我们选择 $T$ 使得以下不等式成立，则该不等式必将成立：\n$$e^{-\\gamma T}  \\delta$$\n问题建议使用“适度阻尼”$\\gamma$。我们选择 $\\gamma=1.0$ 作为一个代表性值。当 $\\delta=10^{-6}$ 时，这要求：\n$$e^{-T}  10^{-6} \\implies -T  \\ln(10^{-6}) \\implies T > - \\ln(10^{-6}) \\approx 13.8155$$\n为了确保针对浮点不准确性和前置因子有稳健的安全裕度，我们将选择一个显著更大的时间 $T=40.0$。此时，指数项 $e^{-40} \\approx 4.2 \\times 10^{-18}$，远小于容差 $\\delta$。这保证了对于所有有效输入，测量值都将在指定的容差内与理论值一致。\n\n程序的算法如下：\n1.  定义物理和数值常数：$\\omega_G = \\sqrt{11/4}$，$\\gamma=1.0$，$T=40.0$ 和 $\\delta=10^{-6}$。\n2.  对于每个测试用例 $(q, \\epsilon, \\phi_0)$：\n    a. 计算 $\\mathcal{R}_{\\mathrm{theory}} = (1 + 1.6 q^2 / \\sqrt{\\epsilon})^{-1}$。初始势 $\\phi_0$ 与剩余分数的计算无关。\n    b. 计算 $\\mathcal{R}_{\\mathrm{meas}} = \\mathcal{R}_{\\mathrm{theory}} + (1 - \\mathcal{R}_{\\mathrm{theory}}) \\exp(-\\gamma T) \\cos(\\omega_G T)$。\n    c. 评估布尔条件 $|\\mathcal{R}_{\\mathrm{meas}} - \\mathcal{R}_{\\mathrm{theory}}| \\le \\delta$。\n3.  收集所有测试用例的布尔结果，并以指定格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the agreement between a theoretical Rosenbluth-Hinton residual\n    zonal potential and a measurement from a simplified relaxation model for a\n    set of test cases in tokamak plasma physics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q, epsilon, phi_0)\n    # q: safety factor\n    # epsilon: inverse aspect ratio\n    # phi_0: initial potential amplitude (note: does not affect the residual fraction)\n    test_cases = [\n        # Case A (happy path)\n        (2.0, 0.1, 1.0),\n        # Case B (lower safety factor)\n        (1.0, 0.1, 1.0),\n        # Case C (smaller inverse aspect ratio)\n        (2.0, 0.01, 1.0),\n        # Case D (larger inverse aspect ratio and higher q)\n        (2.5, 0.3, 0.5),\n        # Case E (very low q and moderate epsilon)\n        (0.7, 0.2, 1.0),\n        # Case F (high q and small epsilon)\n        (4.0, 0.05, 1.0),\n    ]\n\n    # Define numerical and physical constants as per the problem description.\n    # Dimensionless GAM frequency squared is 11/4.\n    omega_G = np.sqrt(11.0 / 4.0)\n    # Dimensionless damping rate for the simplified model (chosen as moderate).\n    gamma = 1.0\n    # Numerical measurement time, chosen to be large enough for convergence.\n    # We require exp(-gamma * T)  delta. T=40 is amply sufficient.\n    T = 40.0\n    # Tolerance for agreement check.\n    delta = 1e-6\n\n    results = []\n    for case in test_cases:\n        q, epsilon, _ = case\n\n        # 1. Calculate the theoretically predicted residual fraction (Rosenbluth-Hinton).\n        # R_theory = 1 / (1 + 1.6 * q^2 / sqrt(epsilon))\n        if epsilon == 0:\n            # Avoid division by zero or domain errors, handle as invalid case if needed.\n            # In this problem, all epsilon > 0.\n            # For robustness, we could flag such a case, but it's not in the test suite.\n            pass\n        \n        R_theory = 1.0 / (1.0 + 1.6 * q**2 / np.sqrt(epsilon))\n\n        # 2. Emulate the measurement of the residual fraction from the simplified model.\n        # R_meas(T) = R_theory + (1 - R_theory) * exp(-gamma*T) * cos(omega_G*T)\n        # This formula directly models the time evolution provided in the problem statement.\n        oscillatory_term = (1.0 - R_theory) * np.exp(-gamma * T) * np.cos(omega_G * T)\n        R_meas = R_theory + oscillatory_term\n\n        # 3. Check for agreement within the specified tolerance.\n        # The condition is |R_meas - R_theory| = delta.\n        # This simplifies to checking if the magnitude of the oscillatory term is within delta.\n        numerical_difference = np.abs(R_meas - R_theory)\n        is_agreed = numerical_difference = delta\n        \n        results.append(is_agreed)\n\n    # Final print statement in the exact required format.\n    # The output should be a list of booleans, e.g., [True,True,True,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3725799"}]}