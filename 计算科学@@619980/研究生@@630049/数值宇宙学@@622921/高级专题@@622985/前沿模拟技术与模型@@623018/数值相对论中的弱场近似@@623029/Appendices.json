{"hands_on_practices": [{"introduction": "在弱场引力模拟中，泊松方程是连接物质分布与引力势的核心。在应用数值求解器之前，理解其内在精度至关重要。本练习 [@problem_id:3502863] 将引导您通过动手推导，分析一种标准有限差分法的误差，并将其与谱方法所能达到的精确结果进行比较，从而深入理解数值离散化带来的影响。", "problem": "考虑一个在共动坐标下的边长为 $L$ 的周期性立方宇宙学盒子，该盒子被一个均匀的笛卡尔网格离散化，每个方向有 $N$ 个点，网格间距为 $\\Delta x = L/N$。在广义相对论的弱场近似下，共形牛顿规范中的标量势 $ \\Phi $ 在共动坐标中遵循一个泊松型方程，\n$$\n\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x}),\n$$\n其中 $S(\\mathbf{x})$ 与 $4 \\pi G a^{2} \\bar{\\rho}\\,\\delta(\\mathbf{x})$ 成正比，但在此可被视为一个空间平均值为零的通用源。假设在 $[0,L]^{3}$ 上采用周期性边界条件。\n\n专注于一个沿着 $x$ 轴方向的单一、可分辨、可分离的平面波源，\n$$\nS(\\mathbf{x}) = S_{0} \\cos(k x),\n$$\n其中 $k = 2 \\pi m / L$，整数模数 $m$ 满足 $1 \\leq m \\leq \\frac{N}{2} - 1$，以避免奈奎斯特混叠。\n\n考虑使用两种数值方法来求解该方程的离散版本：\n\n- 一种使用离散傅里叶变换 (DFT) 的谱方法，该方法在傅里叶空间中对非零波矢逐个模式地反演拉普拉斯算子，并将零波数模式 $ \\Phi_{\\mathbf{k}=\\mathbf{0}} $ 设为零，以固定势的规范（常数偏移）。\n\n- 一种在具有周期性边界条件的网格上使用的二阶中心差分有限差分法，它在 $x$ 方向上使用离散拉普拉斯算子模板，\n$$\n(\\nabla^{2} \\Phi)_{j} \\equiv \\frac{\\Phi_{j+1} - 2 \\Phi_{j} + \\Phi_{j-1}}{\\Delta x^{2}},\n$$\n以及在 $y$ 和 $z$ 方向上的类似模板，其中索引对 $N$ 取模。\n\n从连续拉普拉斯算子及其离散二阶中心差分近似的基本定义出发，并仅使用所述的 DFT 和周期性性质，推导作用于一维采样平面波的有限差分拉普拉斯算子的离散特征值。然后用此结果得到，对于单模源，有限差分解相对于精确连续解的相对振幅误差的闭式表达式，\n$$\nE_{\\mathrm{fd}}(k,N,L) \\equiv \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}},\n$$\n约定在两种方法中，势的零波数模式均设为零。你的最终答案必须是 $E_{\\mathrm{fd}}(k,N,L)$ 关于 $k$、$N$ 和 $L$ 的单一闭式解析表达式。不要提供任何中间步骤，并且最终答案中不要包含任何单位。此外，在你的推导中说明谱方法如何处理零模式，以及这对该源的误差有何影响。\n\n无需四舍五入。将最终的相对误差表示为一个无量纲的解析表达式。", "solution": "问题陈述需经过验证。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 泊松型方程 $\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x})$。\n- **域：** 在共动坐标下的边长为 $L$ 的周期性立方盒子，$[0,L]^{3}$。\n- **离散化：** 均匀笛卡尔网格，每个方向 $N$ 个点，网格间距 $\\Delta x = L/N$。\n- **源项：** 单一平面波 $S(\\mathbf{x}) = S_{0} \\cos(k x)$。\n- **波数：** $k = 2 \\pi m / L$，其中整数 $m$ 满足 $1 \\leq m \\leq \\frac{N}{2} - 1$。\n- **源属性：** 空间平均值为零。\n- **边界条件：** 周期性。\n- **谱方法：** 在傅里叶空间中逐模式反演拉普拉斯算子。将势的零波数模式 $\\Phi_{\\mathbf{k}=\\mathbf{0}}$ 设为零。\n- **有限差分 (FD) 法：** 使用二阶中心差分模板来表示拉普拉斯算子，例如，在 $x$ 方向上为 $(\\nabla^{2} \\Phi)_{j} \\equiv \\frac{\\Phi_{j+1} - 2 \\Phi_{j} + \\Phi_{j-1}}{\\Delta x^{2}}$，其中索引对 $N$ 取模。\n- **误差定义：** 相对振幅误差为 $E_{\\mathrm{fd}}(k,N,L) \\equiv \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}}$。\n- **规范约定：** 对所有解，势的零波数模式均设为零。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。它提出了一个在计算物理学背景下的标准数值分析问题。控制方程是基础的，源项定义明确，并且对于 $m \\ge 1$ 满足所述的“空间平均值为零”的属性。边界条件和规范固定 ($\\Phi_{\\mathbf{k}=\\mathbf{0}}=0$) 确保了解的唯一性。对模数 $m$ 的约束确保了波是可分辨的，并且不处于奈奎斯特频率，这是离散方法中的一个标准考虑因素。该问题是自洽的，其术语定义明确。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n目标是求出对于单个傅里叶模式，有限差分解的振幅相对于精确连续解的振幅的相对误差。\n\n**1. 精确连续解**\n给定方程为 $\\nabla^{2} \\Phi(\\mathbf{x}) = S(\\mathbf{x})$。由于源项 $S(\\mathbf{x}) = S_{0} \\cos(k x)$ 仅依赖于坐标 $x$，势 $\\Phi$ 也将仅依赖于 $x$，因此 $\\nabla^{2} \\Phi = \\frac{d^{2}\\Phi}{dx^{2}}$。方程简化为：\n$$\n\\frac{d^{2}\\Phi}{dx^{2}} = S_{0} \\cos(k x)\n$$\n我们寻找形式为 $\\Phi(x) = \\Phi^{\\mathrm{exact}}_{k} \\cos(k x)$ 的解，其中 $\\Phi^{\\mathrm{exact}}_{k}$ 是该模式的振幅。将此拟设对 $x$ 求导两次，得到：\n$$\n\\frac{d\\Phi}{dx} = -\\Phi^{\\mathrm{exact}}_{k} k \\sin(k x)\n$$\n$$\n\\frac{d^{2}\\Phi}{dx^{2}} = -\\Phi^{\\mathrm{exact}}_{k} k^{2} \\cos(k x)\n$$\n将此代回微分方程得到：\n$$\n-\\Phi^{\\mathrm{exact}}_{k} k^{2} \\cos(k x) = S_{0} \\cos(k x)\n$$\n为使该等式对所有 $x$ 成立，系数必须相等。这就给出了精确解的振幅：\n$$\n\\Phi^{\\mathrm{exact}}_{k} = -\\frac{S_{0}}{k^{2}}\n$$\n问题指明势的零波数模式为零。对于 $k = 2\\pi m/L$ 且 $m \\ge 1$，$\\cos(kx)$ 在一个周期 $L$ 上的积分为零。因此，精确解 $\\Phi(x) = -\\frac{S_{0}}{k^{2}} \\cos(k x)$ 的平均值为零，满足此条件。\n\n**2. 关于谱方法的说明**\n问题提到了谱方法。该方法在傅里叶空间中求解方程，其中拉普拉斯算子 $\\nabla^2$ 变为乘以 $-|\\mathbf{k}|^2$ 的代数运算。对于离散数据，使用离散傅里叶变换 (DFT)。在网格上，源被采样为 $S_j = S_{0} \\cos(k x_j)$。此采样函数的 DFT 仅在对应于 $\\pm k$ 的离散波数处有非零分量。谱方法通过 $\\hat{\\Phi}_{\\mathbf{k}} = - \\hat{S}_{\\mathbf{k}} / |\\mathbf{k}|^2$ 从源的系数 $\\hat{S}_{\\mathbf{k}}$ 计算傅里叶系数 $\\hat{\\Phi}_{\\mathbf{k}}$（对于非零波数）。由于源是单个平面波，并且在网格上是周期的（由 $k = 2\\pi m/L$ 保证），DFT 和傅里叶空间中离散拉普拉斯算子的作用是精确的。因此，谱方法对这个特定源能得到精确解，其误差为零。将 $\\Phi_{\\mathbf{k}=\\mathbf{0}}=0$ 的条件是一个规范固定的选择。源的平均值为零，因此其 $\\mathbf{k}=\\mathbf{0}$ 的傅里叶分量也为零，即 $\\hat{S}_{\\mathbf{k}=\\mathbf{0}}=0$。零模式的方程 $0 \\cdot \\hat{\\Phi}_{\\mathbf{k}=\\mathbf{0}} = \\hat{S}_{\\mathbf{k}=\\mathbf{0}} = 0$ 是不确定的。设置 $\\hat{\\Phi}_{\\mathbf{k}=\\mathbf{0}}=0$ 使解唯一，并与精确连续解相匹配。\n\n**3. 有限差分解**\n泊松方程的离散形式为 $(\\nabla^{2}_{\\mathrm{fd}} \\Phi)_{j} = S_j$，其中 $(\\nabla^{2}_{\\mathrm{fd}} \\Phi)_{j}$ 是拉普拉斯算子的二阶中心差分近似，$S_j = S_0 \\cos(k x_j)$ 是在网格点 $x_j = j \\Delta x$（其中 $j \\in \\{0, 1, ..., N-1\\}$）上采样的源。我们寻找形式为 $\\Phi^{\\mathrm{fd}}_{j} = \\Phi^{\\mathrm{fd}}_{k} \\cos(k x_j)$ 的解。为了求出振幅 $\\Phi^{\\mathrm{fd}}_{k}$，我们首先确定作用于模式 $\\cos(k x_j)$ 的有限差分拉普拉斯算子的离散特征值。\n$$\n(\\nabla^{2}_{\\mathrm{fd}} \\cos(k x_j)) = \\frac{\\cos(k x_{j+1}) - 2 \\cos(k x_j) + \\cos(k x_{j-1})}{(\\Delta x)^{2}}\n$$\n使用 $x_{j \\pm 1} = x_j \\pm \\Delta x$ 和三角恒等式 $\\cos(A+B) + \\cos(A-B) = 2\\cos(A)\\cos(B)$，我们有：\n$$\n\\cos(k(x_j + \\Delta x)) + \\cos(k(x_j - \\Delta x)) = 2 \\cos(k x_j) \\cos(k \\Delta x)\n$$\n将此代入有限差分表达式：\n$$\n(\\nabla^{2}_{\\mathrm{fd}} \\cos(k x_j)) = \\frac{2 \\cos(k x_j) \\cos(k \\Delta x) - 2 \\cos(k x_j)}{(\\Delta x)^{2}} = \\left[ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} \\right] \\cos(k x_j)\n$$\n括号中的项是波数为 $k$ 的模式的离散拉普拉斯算子的特征值。离散方程变为：\n$$\n\\Phi^{\\mathrm{fd}}_{k} \\left[ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} \\right] \\cos(k x_j) = S_{0} \\cos(k x_j)\n$$\n求解有限差分振幅 $\\Phi^{\\mathrm{fd}}_{k}$：\n$$\n\\Phi^{\\mathrm{fd}}_{k} = \\frac{S_{0}}{ \\frac{2(\\cos(k \\Delta x) - 1)}{(\\Delta x)^{2}} } = \\frac{S_{0} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)}\n$$\n\n**4. 相对振幅误差**\n相对误差定义为 $E_{\\mathrm{fd}} = \\frac{\\Phi^{\\mathrm{fd}}_{k} - \\Phi^{\\mathrm{exact}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = \\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} - 1$。我们计算振幅的比率：\n$$\n\\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = \\frac{ \\frac{S_{0} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)} }{ -\\frac{S_{0}}{k^{2}} } = -\\frac{k^{2} (\\Delta x)^{2}}{2(\\cos(k \\Delta x) - 1)}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2 \\sin^{2}(\\theta/2)$，我们可以写出 $\\cos(k \\Delta x) - 1 = -2 \\sin^{2}(k \\Delta x / 2)$。\n$$\n\\frac{\\Phi^{\\mathrm{fd}}_{k}}{\\Phi^{\\mathrm{exact}}_{k}} = -\\frac{k^{2} (\\Delta x)^{2}}{2(-2 \\sin^{2}(k \\Delta x / 2))} = \\frac{k^{2} (\\Delta x)^{2}}{4 \\sin^{2}(k \\Delta x / 2)}\n$$\n因此，相对误差为：\n$$\nE_{\\mathrm{fd}} = \\frac{k^{2} (\\Delta x)^{2}}{4 \\sin^{2}(k \\Delta x / 2)} - 1\n$$\n最后，我们代入 $\\Delta x = L/N$，用给定的参数 $k$、$N$ 和 $L$ 来表示误差。\n$$\nE_{\\mathrm{fd}}(k,N,L) = \\frac{k^{2} (L/N)^{2}}{4 \\sin^{2}(k L / (2N))} - 1 = \\frac{k^{2} L^{2}}{4 N^{2} \\sin^{2}\\left(\\frac{k L}{2 N}\\right)} - 1\n$$\n这就是有限差分解的相对振幅误差的闭式表达式。", "answer": "$$\n\\boxed{\\frac{k^{2} L^{2}}{4 N^{2} \\sin^{2}\\left(\\frac{k L}{2 N}\\right)} - 1}\n$$", "id": "3502863"}, {"introduction": "任何可靠的数值相对论代码都必须在适当的极限下正确地再现更简单、更成熟的物理理论。本练习 [@problem_id:3502781] 将指导您完成一个基本的验证过程：为一个受扰动的 Friedmann–Lemaître–Robertson–Walker (FLRW) 时空实施数值解，并验证在弱场和低速条件下，该解能够收敛到牛顿引力和狭义相对论流体力学。这个练习有助于建立对代码基本模块正确性的信心。", "problem": "考虑一个空间平坦、弱微扰的弗里德曼-勒梅特-罗伯逊-沃尔克时空，其在牛顿规范下的线元为\n$$\nds^2 = -(1+2\\Phi)\\,dt^2 + a^2(1-2\\Psi)\\,\\delta_{ij}\\,dx^i\\,dx^j,\n$$\n其中标度因子为 $a$，引力势为 $\\Phi$，空间曲率势为 $\\Psi$。在弱场极限下，当 $a=1$ 且 $\\Phi \\to 0$、$\\Psi=\\Phi$ 时，该度规趋近于闵可夫斯基度规，广义相对论（GR）简化为狭义相对论（SR）。在数值宇宙学中，我们期望离散化的方程能够收敛到：\n- 当 $a=1$ 且 $\\Phi$ 很小时，由泊松方程控制的标量微扰的牛顿引力。\n- 当 $a=1$ 且 $\\Phi = 0$ 时，闵可夫斯基背景上的狭义相对论流体动力学。\n\n从以下基本理论出发：\n- 爱因斯坦场方程在线性化弱场极限下，意味着标量微扰满足泊松方程\n$$\n\\nabla^2 \\Phi = 4\\pi G\\,\\bar{\\rho}\\,\\delta,\n$$\n其中 $\\Phi$ 是引力势，$\\bar{\\rho}$ 是背景密度，$\\delta$ 是密度对比。在弱场、亚视界机制下，这是一个针对标量微扰并经过广泛检验的结果。\n- 对于理想流体，能量动量张量的守恒 $\\nabla_\\mu T^{\\mu\\nu}=0$ 在闵可夫斯基时空中简化为狭义相对论（SR）流体动力学方程。对于无压流体（尘埃），守恒密度为 $U=\\gamma \\rho$，其中 $\\rho$ 是静质量密度，$\\gamma$ 是洛伦兹因子，定义为 $\\gamma = 1/\\sqrt{1-v^2/c^2}$。\n\n你必须执行数值实验来证明这些极限的恢复，并进行收敛性研究。使用自然单位制，其中光速 $c=1$，引力常数 $G=1$。所有量都必须视为无量纲。\n\n区域和初始数据：\n- 长度为 $L=2\\pi$ 的一维周期性区域，坐标 $x\\in[0,L)$。\n- 密度对比 $\\delta(x)$ 是一个单一的正弦模：\n$$\n\\delta(x) = A \\sin(kx),\n$$\n其中 $k=1$，振幅 $A$ 根据每个测试用例指定。背景密度为 $\\bar{\\rho}=1$。\n\n任务：\n1) 弱场极限下的牛顿引力收敛性（$a=1$）：\n   - 使用二阶有限差分拉普拉斯算子在周期性区域上求解离散泊松方程。在傅里叶空间中，对于间距为 $\\Delta x=L/N$ 的均匀网格上模式 $m$ 的离散拉普拉斯特征值为\n   $$\n   \\lambda_m = \\frac{2\\left(1-\\cos\\left(\\frac{2\\pi m}{N}\\right)\\right)}{\\Delta x^2}.\n   $$\n   表示源项 $S(x) = 4\\pi G \\bar{\\rho}\\, \\delta(x)$，计算其离散傅里叶变换，并求解\n   $$\n   \\hat{\\Phi}_m = -\\frac{\\hat{S}_m}{\\lambda_m}, \\quad m\\neq 0,\n   $$\n   设置零模 $\\hat{\\Phi}_0=0$ 以强制势为零均值。然后进行逆变换以获得网格上的 $\\Phi(x)$。将其与连续解析解\n   $$\n   \\Phi_{\\mathrm{ana}}(x) = -\\frac{4\\pi G \\bar{\\rho}}{k^2}\\,A \\sin(kx),\n   $$\n   进行比较，并计算离散 $L^2$ 误差\n   $$\n   E_N = \\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left[\\Phi_i - \\Phi_{\\mathrm{ana}}(x_i)\\right]^2\\right)^{1/2}.\n   $$\n   对于 $A=10^{-3}$，计算 $N=64,128,256$ 时的 $E_N$，然后计算观测到的收敛阶\n   $$\n   p_{64\\to 128} = \\log_2\\left(\\frac{E_{64}}{E_{128}}\\right), \\quad p_{128\\to 256} = \\log_2\\left(\\frac{E_{128}}{E_{256}}\\right).\n   $$\n   同时计算当 $N=128$ 和 $A=0$ 时的边界情况误差 $E_{A=0}$，该值应接近于零。\n\n2) 闵可夫斯基时空中的狭义相对论流体动力学（$a=1$，$\\Phi=0$）：\n   - 使用针对线性平流方程的二阶 Lax–Wendroff 格式，演化在匀速平流 $v$ 下的狭义相对论守恒密度 $U=\\gamma \\rho$\n   $$\n   \\partial_t U + v\\,\\partial_x U = 0.\n   $$\n   在网格索引 $i$ 处的更新为\n   $$\n   U_i^{n+1} = U_i^{n} - \\frac{v\\Delta t}{2\\Delta x}\\left(U_{i+1}^{n}-U_{i-1}^{n}\\right) + \\frac{v^2\\Delta t^2}{2\\Delta x^2}\\left(U_{i+1}^{n} - 2U_i^{n} + U_{i-1}^{n}\\right).\n   $$\n   使用周期性边界条件，库朗因子 $\\mathrm{CFL}=0.5$，并从 $t=0$ 演化到 $t=T=1$，初始条件为 $\\rho(x,0) = \\bar{\\rho} + A \\sin(kx)$ 和恒定速度 $v=0.5$。守恒变量的狭义相对论解析解为\n   $$\n   U_{\\mathrm{ana}}(x,t) = \\gamma \\left[\\bar{\\rho} + A \\sin\\left(k(x-vt)\\right)\\right].\n   $$\n   计算离散 $L^2$ 误差\n   $$\n   E^{\\mathrm{SR}}_N = \\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left[U_i(T) - U_{\\mathrm{ana}}(x_i,T)\\right]^2\\right)^{1/2}\n   $$\n   对于 $N=64,128,256$，并计算观测到的收敛阶\n   $$\n   p^{\\mathrm{SR}}_{64\\to 128} = \\log_2\\left(\\frac{E^{\\mathrm{SR}}_{64}}{E^{\\mathrm{SR}}_{128}}\\right), \\quad p^{\\mathrm{SR}}_{128\\to 256} = \\log_2\\left(\\frac{E^{\\mathrm{SR}}_{128}}{E^{\\mathrm{SR}}_{256}}\\right).\n   $$\n\n3) 狭义相对论动量密度的牛顿极限：\n   - 对于无压流体（尘埃），在闵可夫斯基时空中的狭义相对论动量密度为\n   $$\n   S_{\\mathrm{SR}}(x,t) = \\rho(x,t)\\,\\gamma^2\\,v,\n   $$\n   而牛顿动量密度为\n   $$\n   S_{\\mathrm{N}}(x,t) = \\rho(x,t)\\,v.\n   $$\n   使用在 $t=T=1$ 时的解析解 $\\rho(x,t) = \\bar{\\rho} + A \\sin(k(x-vt))$，计算在速度 $v\\in\\{0.3,0.1,0.05\\}$ 下的区域平均相对 $L^2$ 差异\n   $$\n   R(v) = \\frac{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left[S_{\\mathrm{SR}}(x_i,T) - S_{\\mathrm{N}}(x_i,T)\\right]^2\\right)^{1/2}}{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left[S_{\\mathrm{SR}}(x_i,T)\\right]^2\\right)^{1/2}},\n   $$\n   该值应随着 $v\\to 0$ 而减小并趋向于零，从而证明狭义相对论的牛顿极限。\n\n角度单位：所有三角函数均使用弧度。\n\n单位：使用自然单位制，其中 $c=1$ 且 $G=1$；所有量均为无量纲。\n\n测试套件：\n- 引力求解器：$A=10^{-3}$， $N\\in\\{64,128,256\\}$；边界情况 $A=0$，$N=128$。\n- 狭义相对论平流：$A=10^{-3}$，$v=0.5$，$T=1$，$N\\in\\{64,128,256\\}$。\n- 牛顿极限（动量）：$A=10^{-3}$，$T=1$，$N=1024$，$v\\in\\{0.3,0.1,0.05\\}$。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其结果按如下顺序排列\n$$\n\\left[p_{64\\to 128},\\,p_{128\\to 256},\\,p^{\\mathrm{SR}}_{64\\to 128},\\,p^{\\mathrm{SR}}_{128\\to 256},\\,R(0.3),\\,R(0.1),\\,R(0.05),\\,E_{A=0}\\right].\n$$\n每个条目必须是一个浮点数。例如，输出应类似于“[result1,result2,result3,result4,result5,result6,result7,result8]”。", "solution": "该问题提出了一系列数值实验，旨在验证从数值宇宙学方程中恢复基本物理极限。具体来说，我们将展示在广义相对论的适当弱场近似下，方程如何收敛到牛顿引力和狭义相对论（SR）流体动力学。所有计算均在自然单位制（引力常数 $G=1$、光速 $c=1$）下进行。问题分为三个不同的任务。\n\n**任务 1：牛顿引力收敛性分析**\n\n第一个任务是证明在弱场、非相对论极限（$a=1$，小 $\\Phi$）下，标量微扰的方程能够恢复牛顿引力。其控制方程是引力势 $\\Phi$ 的泊松方程：\n$$\n\\nabla^2 \\Phi = 4\\pi G\\,\\bar{\\rho}\\,\\delta\n$$\n这里，$\\bar{\\rho}$ 是背景物质密度，$\\delta$ 是密度对比。问题定义在一个长度为 $L=2\\pi$、坐标为 $x\\in[0,L)$ 的一维周期性区域上。密度对比是一个单一的正弦模，$\\delta(x) = A \\sin(kx)$，其中波数 $k=1$，背景密度 $\\bar{\\rho}=1$。泊松方程的源项为 $S(x) = 4\\pi G \\bar{\\rho} \\delta(x) = 4\\pi A \\sin(x)$。\n\n在该区域上，假设势的均值为零，其连续解析解可通过设 $\\Phi_{\\mathrm{ana}}(x) = C\\sin(kx)$ 求得。代入泊松方程得到 $\\frac{d^2}{dx^2}(C\\sin(x)) = -C\\sin(x) = 4\\pi A \\sin(x)$，解得 $C = -4\\pi A$。当 $k=1$，$G=1$，$\\bar{\\rho}=1$ 时，解析解为：\n$$\n\\Phi_{\\mathrm{ana}}(x) = -\\frac{4\\pi G \\bar{\\rho}}{k^2}A \\sin(kx) = -4\\pi A \\sin(x)\n$$\n在数值上，我们在一个有 $N$ 个点、间距为 $\\Delta x = L/N$ 的离散网格上求解泊松方程。我们采用傅里叶伪谱方法。方程 $\\nabla^2 \\Phi = S$ 在傅里叶空间中变换为 $(\\widehat{\\nabla^2 \\Phi})_m = \\hat{S}_m$，其中 $\\hat{f}_m$ 表示函数 $f(x)$ 的第 $m$ 个离散傅里叶系数。离散拉普拉斯算子作用于傅里叶模 $e^{i2\\pi mx/L}$ 的效果是乘以其特征值。对于二阶有限差分拉普拉斯算子，对应于模式 $m$ 的特征值是 $-(k^{\\text{eff}}_m)^2$，其中 $k^{\\text{eff}}_m$ 是有效波数。问题中给出了负拉普拉斯算子 $-\\nabla^2$ 的特征值为：\n$$\n\\lambda_m = \\frac{2\\left(1-\\cos\\left(\\frac{2\\pi m}{N}\\right)\\right)}{\\Delta x^2}\n$$\n因此，傅里叶空间中的代数方程变为 $-\\lambda_m \\hat{\\Phi}_m = \\hat{S}_m$。对于非零模式（$m \\neq 0$），我们可以解出势的傅里叶系数：\n$$\n\\hat{\\Phi}_m = -\\frac{\\hat{S}_m}{\\lambda_m}\n$$\n源项的均值 $\\int_0^{2\\pi} \\sin(x) dx = 0$，所以其零频分量 $\\hat{S}_0=0$。我们通过设置 $\\hat{\\Phi}_0=0$ 来强制势的均值为零。然后，通过对系数 $\\hat{\\Phi}_m$ 应用离散傅里叶逆变换，恢复数值解 $\\Phi(x)$。\n\n我们在大小为 $N \\in \\{64, 128, 256\\}$ 的网格上计算数值解 $\\Phi_i$ 与解析解 $\\Phi_{\\mathrm{ana}}(x_i)$ 之间的离散 $L^2$ 误差 $E_N$。然后使用公式 $p = \\log_2(E_{N_1}/E_{N_2})$ 确定收敛阶 $p$。由于拉普拉斯算子的有限差分模板是二阶精确的，我们预期收敛阶约为 $p \\approx 2$。我们还计算振幅 $A=0$ 的边界情况下的误差，该误差应接近机器精度。\n\n**任务 2：狭义相对论流体动力学收敛性分析**\n\n第二个任务是在闵可夫斯基背景（$a=1$，$\\Phi=0$）下展示狭义相对论流体动力学的恢复。我们考虑一个静质量密度为 $\\rho$、速度恒为 $v$ 的无压流体（尘埃）。守恒量是实验室参考系中的密度 $U = \\gamma \\rho$，其中 $\\gamma = (1-v^2/c^2)^{-1/2}$ 是洛伦兹因子。在一维情况下，其演化由线性平流方程控制：\n$$\n\\partial_t U + v\\,\\partial_x U = 0\n$$\n在 $t=0$ 时的初始条件是一个恒定背景上的正弦密度微扰，$\\rho(x,0) = \\bar{\\rho} + A \\sin(kx)$，其中 $\\bar{\\rho}=1$，$A=10^{-3}$，$k=1$。初始守恒密度为 $U(x,0) = \\gamma (\\bar{\\rho} + A \\sin(kx))$。解析解是初始剖面的简单平移：\n$$\nU_{\\mathrm{ana}}(x,t) = \\gamma \\left[\\bar{\\rho} + A \\sin\\left(k(x-vt)\\right)\\right]\n$$\n我们使用二阶 Lax–Wendroff 格式数值求解该平流方程。对于时间步长 $\\Delta t$ 和网格间距 $\\Delta x$，从时间步 $n$ 到 $n+1$ 的更新规则是：\n$$\nU_i^{n+1} = U_i^{n} - \\frac{v\\Delta t}{2\\Delta x}\\left(U_{i+1}^{n}-U_{i-1}^{n}\\right) + \\frac{v^2\\Delta t^2}{2\\Delta x^2}\\left(U_{i+1}^{n} - 2U_i^{n} + U_{i-1}^{n}\\right)\n$$\n该格式使用库朗因子 $\\mathrm{CFL} = v\\Delta t/\\Delta x = 0.5$ 从 $t=0$ 演化到 $T=1$，以确保数值稳定性。应用周期性边界条件。我们计算在 $T=1$ 时，网格大小为 $N \\in \\{64, 128, 256\\}$ 的数值解与解析解之间的 $L^2$ 误差 $E^{\\mathrm{SR}}_N$，并由此计算收敛阶。由于 Lax-Wendroff 格式是二阶精确的，我们预期收敛阶 $p^{\\mathrm{SR}} \\approx 2$。\n\n**任务 3：狭义相对论动量的牛顿极限**\n\n最后一个任务是验证在非相对论极限（$v \\ll c$）下，狭义相对论动量密度趋近于牛顿动量密度。对于尘埃，狭义相对论动量密度为 $S_{\\mathrm{SR}} = T^{0i} = \\rho h u^0 u^i = \\rho \\gamma^2 v$（因为对于尘埃，比焓 $h=1$，且 $u^\\mu = \\gamma(1, \\vec{v})$）。相应的牛顿动量密度为 $S_{\\mathrm{N}} = \\rho v$。\n我们在一个高分辨率网格（$N=1024$）上，使用 $T=1$ 时的平流密度剖面 $\\rho(x,T) = \\bar{\\rho} + A \\sin(k(x-vT))$ 来分析解析解。两种表述之间的一致性通过区域平均相对 $L^2$ 差异来量化：\n$$\nR(v) = \\frac{\\|S_{\\mathrm{SR}} - S_{\\mathrm{N}}\\|_{L^2}}{\\|S_{\\mathrm{SR}}\\|_{L^2}}\n$$\n我们可以对该表达式进行解析简化：\n$$\nS_{\\mathrm{SR}} - S_{\\mathrm{N}} = \\rho \\gamma^2 v - \\rho v = \\rho v (\\gamma^2 - 1)\n$$\n范数之比变为：\n$$\nR(v) = \\frac{\\|\\rho v (\\gamma^2 - 1)\\|}{\\|\\rho v \\gamma^2\\|} = \\frac{|v(\\gamma^2-1)|}{|v\\gamma^2|} \\frac{\\|\\rho\\|}{\\|\\rho\\|} = \\frac{\\gamma^2-1}{\\gamma^2} = 1 - \\frac{1}{\\gamma^2} = 1 - (1-v^2) = v^2\n$$\n这表明狭义相对论和牛顿动量之间的相对差异与 $v^2$ 成正比。我们为一系列递减的速度 $v \\in \\{0.3, 0.1, 0.05\\}$ 计算这个值，以在数值上确认这一行为。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_poisson_error(N: int, A: float) -> float:\n    \"\"\"\n    Solves the 1D periodic Poisson equation using a Fourier method and\n    computes the L2 error against the analytic solution.\n\n    Args:\n        N: Number of grid points.\n        A: Amplitude of the density contrast.\n\n    Returns:\n        The discrete L2 error.\n    \"\"\"\n    # Constants and domain setup\n    G = 1.0\n    rho_bar = 1.0\n    k = 1.0\n    L = 2.0 * np.pi\n    \n    # Grid setup\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Source term\n    delta = A * np.sin(k * x)\n    S = 4.0 * np.pi * G * rho_bar * delta\n    \n    # Solve in Fourier space\n    S_hat = np.fft.fft(S)\n    \n    # Wavenumbers (integer mode numbers)\n    m = np.fft.fftfreq(N) * N\n    \n    # Eigenvalues of the negative discrete Laplacian (-nabla^2)\n    # The m=0 mode gives lambda_0 = 0, leading to a singularity.\n    # We handle it by setting Phi_hat[0] = 0.\n    with np.errstate(divide='ignore', invalid='ignore'):\n        lambda_m = (2.0 * (1.0 - np.cos(2.0 * np.pi * m / N))) / (dx**2)\n    \n    Phi_hat = np.zeros_like(S_hat)\n    # The source term has zero mean, so S_hat[0] is zero.\n    # The condition Phi_hat[0]=0 enforces a zero-mean potential.\n    non_zero_modes = (m != 0)\n    Phi_hat[non_zero_modes] = -S_hat[non_zero_modes] / lambda_m[non_zero_modes]\n\n    # Transform back to real space\n    Phi_num = np.fft.ifft(Phi_hat).real\n    \n    # Analytical solution\n    Phi_ana = -(4.0 * np.pi * G * rho_bar / k**2) * A * np.sin(k * x)\n    \n    # Compute L2 error\n    error = np.linalg.norm(Phi_num - Phi_ana) / np.sqrt(N)\n    \n    return error\n\ndef run_lax_wendroff_advection(N: int, A: float, v: float, T: float) -> float:\n    \"\"\"\n    Evolves the SR linear advection equation using the Lax-Wendroff scheme\n    and computes the L2 error.\n\n    Args:\n        N: Number of grid points.\n        A: Amplitude of the density perturbation.\n        v: Advection velocity.\n        T: Final evolution time.\n\n    Returns:\n        The discrete L2 error at time T.\n    \"\"\"\n    # Constants and domain setup\n    rho_bar = 1.0\n    k = 1.0\n    L = 2.0 * np.pi\n    CFL = 0.5\n    \n    # Grid setup\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Time stepping setup\n    # Adjust dt to land exactly on T\n    dt_provisional = CFL * dx / v\n    n_steps = int(np.ceil(T / dt_provisional))\n    dt = T / n_steps\n\n    # Initial condition for conserved density U = gamma * rho\n    gamma = 1.0 / np.sqrt(1.0 - v**2)\n    rho0 = rho_bar + A * np.sin(k * x)\n    U = gamma * rho0\n    \n    # Coefficients for Lax-Wendroff update\n    c1 = v * dt / (2.0 * dx)\n    c2 = (v**2 * dt**2) / (2.0 * dx**2)\n\n    # Time evolution loop\n    for _ in range(n_steps):\n        U_p1 = np.roll(U, -1)  # U_{i+1}\n        U_m1 = np.roll(U, 1)   # U_{i-1}\n        \n        # Second-order stencil for first derivative\n        advection_term = c1 * (U_p1 - U_m1)\n        # Second-order stencil for second derivative\n        diffusion_term = c2 * (U_p1 - 2.0 * U + U_m1)\n        \n        U = U - advection_term + diffusion_term\n\n    # Analytical solution at T\n    U_ana = gamma * (rho_bar + A * np.sin(k * (x - v * T)))\n\n    # Compute L2 error\n    error = np.linalg.norm(U - U_ana) / np.sqrt(N)\n    \n    return error\n    \ndef calculate_momentum_difference(N: int, A: float, v: float, T: float) -> float:\n    \"\"\"\n    Computes the relative L2 difference between SR and Newtonian momentum densities.\n\n    Args:\n        N: Number of grid points.\n        A: Amplitude of the density perturbation.\n        v: Velocity of the fluid.\n        T: Time of evaluation.\n\n    Returns:\n        The relative L2 difference R(v).\n    \"\"\"\n    # Constants and domain\n    rho_bar = 1.0\n    k = 1.0\n    L = 2.0 * np.pi\n    \n    # Grid\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Lorentz factor\n    gamma = 1.0 / np.sqrt(1.0 - v**2)\n    \n    # Analytic density at time T\n    rho = rho_bar + A * np.sin(k * (x - v * T))\n    \n    # Momentum densities\n    S_N = rho * v\n    S_SR = rho * gamma**2 * v\n    \n    # Relative L2 difference\n    norm_diff = np.linalg.norm(S_SR - S_N)\n    norm_SR = np.linalg.norm(S_SR)\n    \n    # Avoid division by zero if S_SR is zero everywhere\n    if norm_SR == 0:\n        return 0.0\n    \n    return norm_diff / norm_SR\n\ndef solve():\n    \"\"\"\n    Runs all tasks and prints the final results.\n    \"\"\"\n    # --- Task 1: Newtonian Gravity Convergence ---\n    A_grav = 1.0e-3\n    Ns_grav = [64, 128, 256]\n    errors_grav = [calculate_poisson_error(N, A_grav) for N in Ns_grav]\n    \n    p_64_128 = np.log2(errors_grav[0] / errors_grav[1])\n    p_128_256 = np.log2(errors_grav[1] / errors_grav[2])\n    \n    # Boundary case A=0\n    error_A0 = calculate_poisson_error(N=128, A=0.0)\n\n    # --- Task 2: Special-Relativistic Hydrodynamics Convergence ---\n    A_hydro = 1.0e-3\n    v_hydro = 0.5\n    T_hydro = 1.0\n    Ns_hydro = [64, 128, 256]\n    errors_hydro = [run_lax_wendroff_advection(N, A_hydro, v_hydro, T_hydro) for N in Ns_hydro]\n    \n    p_sr_64_128 = np.log2(errors_hydro[0] / errors_hydro[1])\n    p_sr_128_256 = np.log2(errors_hydro[1] / errors_hydro[2])\n\n    # --- Task 3: Newtonian Limit of Momentum Density ---\n    A_limit = 1.0e-3\n    T_limit = 1.0\n    N_limit = 1024\n    vs_limit = [0.3, 0.1, 0.05]\n    R_values = [calculate_momentum_difference(N_limit, A_limit, v, T_limit) for v in vs_limit]\n\n    # --- Assemble and Print Final Results ---\n    results = [\n        p_64_128,\n        p_128_256,\n        p_sr_64_128,\n        p_sr_128_256,\n        R_values[0],\n        R_values[1],\n        R_values[2],\n        error_A0\n    ]\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3502781"}, {"introduction": "爱因斯坦方程的数值解在演化过程中会累积误差，从而可能违反基本的哈密顿约束和动量约束。本练习 [@problem_id:3502832] 深入探讨了一种控制这些违例的强大技术：约束阻尼。您将推导约束能量诊断量的性质，并确定为确保数值解在长时间演化中保持物理有效性所需的阻尼强度。", "problem": "考虑一个空间平坦的 Friedmann–Lemaître–Robertson–Walker (FLRW) 时空在共形时间 $\\eta$ 中的弱场微扰，其标度因子为 $a(\\eta)$。令 $\\mathbf{C}(\\eta,\\mathbf{x}) \\in \\mathbb{R}^{4}$ 表示线性化广义相对论约束违背的矢量，它包含哈密顿约束违背 $\\mathcal{H}$ 和动量约束违背的三个分量 $\\mathcal{M}_{i}$。在一阶对称双曲形式中，缩并的 Bianchi 恒等式意味着，在弱场近似的主导阶上，并且当用共形坐标书写时，$\\mathbf{C}$ 满足一个齐次、常系数、对称双曲的辅助系统，其主部为\n$$\n\\partial_{\\eta} \\mathbf{C} \\;=\\; \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,,\n$$\n其中每个 $\\mathbf{A}^{j} \\in \\mathbb{R}^{4\\times 4}$ 都是常数对称矩阵。假设在一个坐标体积为 $V$ 的立方三维环面上有周期性边界条件，因此全散度的空间边界积分为零。要求您设计一个诊断量，用于在数值演化过程中监测线性化的哈密顿和动量约束，并发展一个简单的阻尼项，该阻尼项可以被证明能减少约束违背，同时不破坏形式上的精度阶。\n\n1) 定义单参数诊断能量族\n$$\nE_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} a(\\eta)^{p}\\,\\mathbf{C}(\\eta,\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}(\\eta,\\mathbf{x})\\,\\mathrm{d}^{3}x \\,,\n$$\n对于实数参数 $p$。仅使用上述主部系统和周期性边界条件，推导 $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ 并确定使 $E_{p}(\\eta)$ 在无阻尼情况下守恒的唯一 $p$ 值，即对于主部系统的所有解 $\\mathbf{C}$，都有 $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)=0$ 成立。\n\n2) 通过添加一个线性阻尼项 $\\partial_{\\eta}\\mathbf{C} \\mapsto \\partial_{\\eta}\\mathbf{C} - \\kappa\\,\\mathbf{C}$（其中常数 $\\kappa>0$）来修改辅助系统。对于在第(1)部分中选定的 $p$ 值，证明在相同假设下，相应的诊断能量遵循严格的衰减定律 $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) = -2\\kappa\\,E_{p}(\\eta)$。\n\n3) 设标度因子为 $a(\\eta) = a_{0}(\\eta/\\eta_{0})^{q}$，其中常数 $a_{0}>0$, $\\eta_{0}>0$ 且 $q\\in\\mathbb{R}$。考虑任意区间 $[\\eta_{i},\\eta_{f}]$，其中 $\\eta_{f}>\\eta_{i}>0$。使用第(2)部分中的衰减定律，确定阻尼系数 $\\kappa$（单位为共形时间分之一）的闭式解析表达式，以在 $[\\eta_{i},\\eta_{f}]$ 区间内实现诊断能量指定的衰减因子 $r \\in (0,1)$，即\n$$\n\\frac{E_{p}(\\eta_{f})}{E_{p}(\\eta_{i})} \\;=\\; r \\,.\n$$\n用 $r$ 和 $\\Delta \\eta \\equiv \\eta_{f}-\\eta_{i}$ 符号化地表示您对 $\\kappa$ 的最终答案。\n\n4) 简要论证为什么在无阻尼主部系统的标准二阶精度离散化中，添加 $-\\kappa\\,\\mathbf{C}$ 项不会破坏其时间和空间上的形式二阶精度，前提是 $\\kappa$ 与网格间距和时间步长无关。此处无需数值估计。\n\n您的最终答案必须是第(3)部分中得到的 $\\kappa$ 的单一解析表达式。以共形时间分之一为单位表示 $\\kappa$。框出的最终答案中不应包含单位。如果您选择对任何特定的 $r$ 和 $\\Delta\\eta$ 进行数值计算 $\\kappa$，请四舍五入到四位有效数字；否则，请保留精确的解析形式。", "solution": "问题陈述已经过验证，被认为是具有科学依据、良定、内部一致且客观的。它提出了一个与数值相对论相关的偏微分方程分析中的标准理论练习，特别涉及约束违背的传播和阻尼。所有必要信息均已提供。\n\n我们现在将依次解答这四个部分。\n\n1) $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ 的推导和 $p$ 的确定。\n\n单参数诊断能量族定义为：\n$$\nE_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} a(\\eta)^{p}\\,\\mathbf{C}(\\eta,\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}(\\eta,\\mathbf{x})\\,\\mathrm{d}^{3}x\n$$\n为了求其关于共形时间 $\\eta$ 的时间导数，我们应用 Leibniz 积分法则。由于积分体积 $V$ 在共动坐标 $\\mathbf{x}$ 中是固定的，导数可以移到积分内部。\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\frac{\\partial}{\\partial\\eta} \\left( a(\\eta)^{p}\\,\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\right) \\mathrm{d}^{3}x\n$$\n使用乘法法则进行微分，我们得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\left( p\\,a(\\eta)^{p-1} \\frac{\\mathrm{d}a}{\\mathrm{d}\\eta} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} + a(\\eta)^{p} \\frac{\\partial}{\\partial\\eta}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{C}) \\right) \\mathrm{d}^{3}x\n$$\n二次型 $\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} = \\sum_{k=1}^{4} C_{k}^{2}$ 的导数是 $\\frac{\\partial}{\\partial\\eta}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{C}) = 2\\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})$。代入此式以及符号 $a' = \\frac{\\mathrm{d}a}{\\mathrm{d}\\eta}$：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\left( p\\,a(\\eta)^{p-1} a' \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} + 2 a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C}) \\right) \\mathrm{d}^{3}x\n$$\n现在，我们将给定的约束的无阻尼演化系统 $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C}$ 代入被积函数的第二项：\n$$\n\\int_{V} a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C}) \\,\\mathrm{d}^{3}x \\;=\\; \\int_{V} a(\\eta)^{p} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\right) \\mathrm{d}^{3}x \\;=\\; a(\\eta)^{p} \\sum_{j=1}^{3} \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x\n$$\n让我们分析积分 $\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x$。我们可以通过注意到对于任何常数矩阵 $\\mathbf{M}$，我们有 $\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}\\mathbf{C}) = (\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C} + \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C})$ 来重写被积函数。如果 $\\mathbf{M}$ 是对称的，即 $\\mathbf{M}=\\mathbf{M}^{\\mathsf{T}}$，那么 $(\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C} = ((\\partial_{j}\\mathbf{C}^{\\mathsf{T}})\\mathbf{M}\\mathbf{C})^{\\mathsf{T}} = \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}^{\\mathsf{T}}(\\partial_{j}\\mathbf{C}) = \\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C})$。因此，对于对称的 $\\mathbf{M}$，我们有 $\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}(\\partial_{j}\\mathbf{C}) = \\frac{1}{2}\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{M}\\mathbf{C})$。\n由于给定的每个矩阵 $\\mathbf{A}^{j}$ 都是对称的，我们可以写出：\n$$\n\\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\;=\\; \\frac{1}{2}\\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{A}^{j}\\mathbf{C})\n$$\n积分变为：\n$$\n\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; \\frac{1}{2} \\int_{V} \\partial_{j}(\\mathbf{C}^{\\mathsf{T}}\\mathbf{A}^{j}\\mathbf{C}) \\,\\mathrm{d}^{3}x\n$$\n根据散度定理，这个关于 $x_j$ 的偏导数的体积分可以转换成 $V$ 边界上的面积分。由于在三维环面上指定了周期性边界条件，这些边界积分消失。因此，对于每个 $j \\in \\{1,2,3\\}$：\n$$\n\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; 0\n$$\n因此，$\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)$ 表达式中的整个第二项都消失了。我们剩下：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} p\\,a(\\eta)^{p-1} a' \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x \\;=\\; \\frac{p\\,a'}{2 a^{1-p}} \\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x\n$$\n为了使 $E_{p}(\\eta)$ 守恒，即 $\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{p}(\\eta)=0$，对于所有可能的解 $\\mathbf{C}$ 以及标度因子的一般演化（我们可以假设对于非平凡的违背有 $a' \\neq 0$ 和 $\\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C}\\,\\mathrm{d}^{3}x > 0$），乘以积分的系数必须为零。这要求 $p=0$。这是使能量守恒的唯一值。\n\n2) 有阻尼系统的衰减证明。\n\n修改后的系统包含一个阻尼项：\n$$\n\\partial_{\\eta}\\mathbf{C} \\;=\\; \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C}\n$$\n其中 $\\kappa$ 是一个正常数。我们分析在第(1)部分中找到的 $p=0$ 值对应的诊断能量 $E_p(\\eta)$：\n$$\nE_{0}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} \\mathbf{C}^{\\mathsf{T}} \\mathbf{C}\\,\\mathrm{d}^{3}x\n$$\n它的时间导数是：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\frac{1}{2}\\int_{V} 2\\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})\\,\\mathrm{d}^{3}x \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}}(\\partial_{\\eta}\\mathbf{C})\\,\\mathrm{d}^{3}x\n$$\n代入有阻尼的演化方程：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C} \\right) \\mathrm{d}^{3}x\n$$\n我们可以将积分分成两部分：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; \\int_{V} \\mathbf{C}^{\\mathsf{T}} \\left( \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} \\right) \\mathrm{d}^{3}x - \\int_{V} \\mathbf{C}^{\\mathsf{T}} (\\kappa\\,\\mathbf{C}) \\,\\mathrm{d}^{3}x\n$$\n正如在第(1)部分所证，由于 $\\mathbf{A}^{j}$ 矩阵的对称性和周期性边界条件，第一个积分为零。第二个积分简化为：\n$$\n- \\int_{V} \\kappa\\,\\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x \\;=\\; - \\kappa \\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x\n$$\n根据 $E_0(\\eta)$ 的定义，我们有 $\\int_{V} \\mathbf{C}^{\\mathsf{T}}\\mathbf{C} \\,\\mathrm{d}^{3}x = 2 E_0(\\eta)$。因此：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\eta}E_{0}(\\eta) \\;=\\; - \\kappa (2 E_0(\\eta)) \\;=\\; -2\\kappa\\,E_{0}(\\eta)\n$$\n这证明了诊断能量 $E_0(\\eta)$ 的严格衰减定律。\n\n3) 阻尼系数 $\\kappa$ 的确定。\n\n我们有关于 $E_0(\\eta)$ 的常微分方程：\n$$\n\\frac{\\mathrm{d}E_{0}}{\\mathrm{d}\\eta} \\;=\\; -2\\kappa\\,E_{0}\n$$\n对于常数 $\\kappa$，该方程的解为：\n$$\nE_{0}(\\eta) \\;=\\; E_{0}(\\eta_{i}) \\exp\\left( -2\\kappa (\\eta - \\eta_{i}) \\right)\n$$\n其中 $\\eta_i$ 是初始共形时间。我们给出的条件是能量在区间 $[\\eta_{i}, \\eta_{f}]$ 上减少了因子 $r$：\n$$\n\\frac{E_{0}(\\eta_{f})}{E_{0}(\\eta_{i})} \\;=\\; r\n$$\n将 $\\eta = \\eta_f$ 时的 $E_0(\\eta)$ 解代入：\n$$\n\\frac{E_{0}(\\eta_{i}) \\exp\\left( -2\\kappa (\\eta_{f} - \\eta_{i}) \\right)}{E_{0}(\\eta_{i})} \\;=\\; r\n$$\n$$\n\\exp\\left( -2\\kappa (\\eta_{f} - \\eta_{i}) \\right) \\;=\\; r\n$$\n定义 $\\Delta\\eta \\equiv \\eta_{f}-\\eta_{i}$，我们有：\n$$\n\\exp(-2\\kappa \\Delta\\eta) \\;=\\; r\n$$\n为了解出 $\\kappa$，我们对两边取自然对数：\n$$\n-2\\kappa \\Delta\\eta \\;=\\; \\ln(r)\n$$\n$$\n\\kappa \\;=\\; -\\frac{\\ln(r)}{2 \\Delta\\eta}\n$$\n由于 $r \\in (0,1)$，我们有 $\\ln(r)  0$，这确保了 $\\kappa  0$（符合要求）。关于标度因子特定形式 $a(\\eta) = a_0(\\eta/\\eta_0)^q$ 的信息，对于证明非静态宇宙中 $p=0$ 的唯一性是必要的，但一旦知道了 $E_0$ 的衰减定律，就不再需要它来求解 $\\kappa$。\n\n4) 精度保持的论证。\n\n偏微分方程数值格式的形式精度阶由局部截断误差决定，该误差衡量精确解满足离散化方程的程度。此误差通常由最高阶导数项的离散化所主导。\n\n原始的无阻尼系统是 $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C}$。该系统的二阶精度格式将具有 $O(\\Delta\\eta^2, \\Delta x^2)$ 的局部截断误差，其中误差项来自于对时间导数 $\\partial_{\\eta}$ 和空间导数 $\\partial_{j}$ 的有限差分近似。\n\n修改后的系统是 $\\partial_{\\eta} \\mathbf{C} = \\sum_{j=1}^{3} \\mathbf{A}^{j}\\,\\partial_{j} \\mathbf{C} - \\kappa\\,\\mathbf{C}$。添加的项 $-\\kappa\\,\\mathbf{C}$ 是一个零阶项，因为它不涉及导数。在数值离散化中，该项可以在每个网格点上精确计算，而不会引入任何新的离散误差。在分析应用于有阻尼方程的格式的总截断误差时（例如，使用泰勒级数展开），来自 $\\partial_{\\eta}$ 和 $\\partial_{j}$ 离散化的误差贡献保持不变。新项 $-\\kappa\\,\\mathbf{C}$ 只是简单地加到方程中。如果用一种在时间上至少是二阶精度的方法（例如 Crank-Nicolson 方法）来处理它，它不会降低格式的整体二阶精度。只要 $\\kappa$ 是一个与网格间距 $(\\Delta x, \\Delta\\eta)$ 无关的常数，添加这个低阶项就不会影响截断误差中的主导阶项，这些项仍然是 $O(\\Delta\\eta^2, \\Delta x^2)$。因此，形式二阶精度得以保持。", "answer": "$$\\boxed{-\\frac{\\ln(r)}{2 \\Delta \\eta}}$$", "id": "3502832"}]}