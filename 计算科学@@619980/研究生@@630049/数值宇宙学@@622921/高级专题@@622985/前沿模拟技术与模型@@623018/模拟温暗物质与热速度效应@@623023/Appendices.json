{"hands_on_practices": [{"introduction": "我们的第一个实践练习聚焦于温暗物质（WDM）模型最基本的特征：对小尺度结构的压制。我们将使用WDM传递函数，这是一个关键的数学工具，用于修正标准的冷暗物质（CDM）功率谱。通过推导压制比的一个性质，您将对WDM的自由流如何改变宇宙的初始条件获得定量的理解，这是任何WDM模拟的第一步。[@problem_id:3489311]", "problem": "在数值宇宙学中，由温暗物质（WDM）的热速度引起的小尺度结构形成的抑制，可以通过将冷暗物质（CDM）的线性物质功率谱乘以一个 WDM 传递函数的平方，来整合到初始条件中。考虑一个模拟设置，其中 WDM 传递函数由广泛使用的拟合形式建模\n$$\nT(k)=\\left[1+\\left(\\alpha\\,k\\right)^{2\\mu}\\right]^{-5/\\mu},\n$$\n其中 $k$ 是共动波数，$\\alpha$ 是由自由流尺度设定的尺度参数，而 $\\mu$ 是一个无量纲的形状参数。那么 WDM 功率谱为\n$$\nP_{\\mathrm{wdm}}(k)=T^{2}(k)\\,P_{\\mathrm{cdm}}(k),\n$$\n抑制比为\n$$\nR(k)\\equiv \\frac{P_{\\mathrm{wdm}}(k)}{P_{\\mathrm{cdm}}(k)}=T^{2}(k)=\\left[1+\\left(\\alpha\\,k\\right)^{2\\mu}\\right]^{-10/\\mu}.\n$$\n定义半模波数 $k_{\\mathrm{hm}}$ 的条件是，功率在此尺度上被抑制了 $1/2$ 的因子，即\n$$\nR\\!\\left(k_{\\mathrm{hm}}\\right)=\\frac{1}{2}.\n$$\n为了量化 $k_{\\mathrm{hm}}$ 附近的抑制程度，定义围绕 $k_{\\mathrm{hm}}$ 的对称三点平均抑制为\n$$\n\\mathcal{A}(\\mu)\\equiv \\frac{1}{3}\\left[R\\!\\left(\\frac{k_{\\mathrm{hm}}}{2}\\right)+R\\!\\left(k_{\\mathrm{hm}}\\right)+R\\!\\left(2\\,k_{\\mathrm{hm}}\\right)\\right].\n$$\n仅从给定的定义出发，推导出一个 $\\mathcal{A}(\\mu)$ 的闭式解析表达式，该表达式仅依赖于无量纲参数 $\\mu$，并且不依赖于 $\\alpha$ 或 $k_{\\mathrm{hm}}$。你的最终答案必须是一个单一的闭式表达式（不需要进行数值计算）。请精确表达最终结果；不需要四舍五入，也不需要单位，因为 $\\mathcal{A}(\\mu)$ 是无量纲的。", "solution": "问题陈述经验证具有科学依据、提法恰当且客观。它基于数值宇宙学中用于解释温暗物质（WDM）效应的标准模型，特别是使用传递函数来抑制冷暗物质（CDM）功率谱。所有变量和函数都得到了清晰的定义，任务是一个数学上严谨且自洽的推导。因此，我将开始进行求解。\n\n目标是为对称三点平均抑制 $\\mathcal{A}(\\mu)$ 推导出一个仅依赖于形状参数 $\\mu$ 的闭式表达式。$\\mathcal{A}(\\mu)$ 的定义如下：\n$$\n\\mathcal{A}(\\mu) \\equiv \\frac{1}{3}\\left[R\\!\\left(\\frac{k_{\\mathrm{hm}}}{2}\\right)+R\\!\\left(k_{\\mathrm{hm}}\\right)+R\\!\\left(2\\,k_{\\mathrm{hm}}\\right)\\right].\n$$\n抑制比 $R(k)$ 定义为\n$$\nR(k) = \\left[1+\\left(\\alpha\\,k\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}}.\n$$\n半模波数 $k_{\\mathrm{hm}}$ 由条件 $R(k_{\\mathrm{hm}}) = \\frac{1}{2}$ 定义。这为消除参数 $\\alpha$ 和 $k_{\\mathrm{hm}}$ 提供了起点。\n\n首先，我们将 $k_{\\mathrm{hm}}$ 的定义应用于 $R(k)$ 的表达式：\n$$\nR(k_{\\mathrm{hm}}) = \\left[1+\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}} = \\frac{1}{2}.\n$$\n为了求解组合项 $(\\alpha k_{\\mathrm{hm}})^{2\\mu}$，我们将方程两边同时取 $-\\frac{\\mu}{10}$ 次幂：\n$$\n\\left(\\left[1+\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}}\\right)^{-\\frac{\\mu}{10}} = \\left(\\frac{1}{2}\\right)^{-\\frac{\\mu}{10}}.\n$$\n这可以简化为\n$$\n1+\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu} = 2^{\\frac{\\mu}{10}}.\n$$\n分离出我们感兴趣的项得到\n$$\n\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu} = 2^{\\frac{\\mu}{10}} - 1.\n$$\n这个关键的中间结果将乘积 $(\\alpha k_{\\mathrm{hm}})$ 表示为 $\\mu$ 的函数，这将使我们能够从 $\\mathcal{A}(\\mu)$ 的最终表达式中消除对它的依赖。\n\n$\\mathcal{A}(\\mu)$ 的表达式需要三项：$R(k_{\\mathrm{hm}})$、$R(\\frac{k_{\\mathrm{hm}}}{2})$ 和 $R(2 k_{\\mathrm{hm}})$。第一项由定义给出：$R(k_{\\mathrm{hm}})=\\frac{1}{2}$。我们现在推导另外两项的表达式。\n\n对于项 $R(\\frac{k_{\\mathrm{hm}}}{2})$，我们将 $k = \\frac{k_{\\mathrm{hm}}}{2}$ 代入 $R(k)$ 的定义中：\n$$\nR\\left(\\frac{k_{\\mathrm{hm}}}{2}\\right) = \\left[1+\\left(\\alpha\\,\\frac{k_{\\mathrm{hm}}}{2}\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}} = \\left[1+\\frac{\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu}}{2^{2\\mu}}\\right]^{-\\frac{10}{\\mu}}.\n$$\n现在，我们代入 $(\\alpha k_{\\mathrm{hm}})^{2\\mu}$ 的表达式：\n$$\nR\\left(\\frac{k_{\\mathrm{hm}}}{2}\\right) = \\left[1+\\frac{2^{\\frac{\\mu}{10}} - 1}{2^{2\\mu}}\\right]^{-\\frac{10}{\\mu}}.\n$$\n这一项现在只依赖于 $\\mu$。\n\n接下来，对于项 $R(2 k_{\\mathrm{hm}})$，我们将 $k = 2 k_{\\mathrm{hm}}$ 代入 $R(k)$ 的定义中：\n$$\nR\\left(2\\,k_{\\mathrm{hm}}\\right) = \\left[1+\\left(\\alpha\\,(2 k_{\\mathrm{hm}})\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}} = \\left[1+2^{2\\mu}\\left(\\alpha\\,k_{\\mathrm{hm}}\\right)^{2\\mu}\\right]^{-\\frac{10}{\\mu}}.\n$$\n再次，我们代入 $(\\alpha k_{\\mathrm{hm}})^{2\\mu}$ 的表达式：\n$$\nR\\left(2\\,k_{\\mathrm{hm}}\\right) = \\left[1+2^{2\\mu}\\left(2^{\\frac{\\mu}{10}} - 1\\right)\\right]^{-\\frac{10}{\\mu}}.\n$$\n这一项也只依赖于 $\\mu$。\n\n最后，我们将这三项代回到 $\\mathcal{A}(\\mu)$ 的定义中：\n$$\n\\mathcal{A}(\\mu) = \\frac{1}{3}\\left[R\\left(\\frac{k_{\\mathrm{hm}}}{2}\\right) + R\\left(k_{\\mathrm{hm}}\\right) + R\\left(2\\,k_{\\mathrm{hm}}\\right)\\right].\n$$\n$$\n\\mathcal{A}(\\mu) = \\frac{1}{3}\\left( \\left[1+\\frac{2^{\\frac{\\mu}{10}} - 1}{2^{2\\mu}}\\right]^{-\\frac{10}{\\mu}} + \\frac{1}{2} + \\left[1+2^{2\\mu}\\left(2^{\\frac{\\mu}{10}} - 1\\right)\\right]^{-\\frac{10}{\\mu}} \\right).\n$$\n这就是 $\\mathcal{A}(\\mu)$ 的闭式解析表达式。它是一个仅与无量纲形状参数 $\\mu$ 有关的函数，所有对尺度参数 $\\alpha$ 和半模波数 $k_{\\mathrm{hm}}$ 的依赖性都已通过基于问题定义的严谨代数代换消除了。推导到此结束。", "answer": "$$\n\\boxed{\\frac{1}{3}\\left(\\left[1 + \\frac{2^{\\frac{\\mu}{10}} - 1}{2^{2\\mu}}\\right]^{-\\frac{10}{\\mu}} + \\frac{1}{2} + \\left[1 + 2^{2\\mu}\\left(2^{\\frac{\\mu}{10}} - 1\\right)\\right]^{-\\frac{10}{\\mu}}\\right)}\n$$", "id": "3489311"}, {"introduction": "正确地初始化粒子速度对于精确捕捉WDM物理至关重要。这个实践将我们从抽象的功率谱带到具体的模拟粒子层面，解决了在膨胀宇宙中赋予热速度的挑战。您将推导从共动动量到物理速度的正确映射关系，并编写一个程序来量化常见但关键的实现错误，从而巩固您对宇宙学和数值方法之间相互作用的理解。[@problem_id:3489237]", "problem": "您的任务是编写一个完整、可运行的程序，该程序定量地对比在某个初始化红移处，于共动参考系和物理参考系中对无碰撞温暗物质粒子的热本动速度进行采样的差异，并论证哈勃流和尺度因子映射如何影响采样得到的速度分布和一个简单的离散噪声代理。\n\n您的推理和实现必须仅基于以下物理基础：\n- 无碰撞物质的相空间密度守恒（刘维尔定理）以及共动动量分布在宇宙膨胀下的不变性。\n- 物理位置与共动位置之间的关系 $\\mathbf{r} = a\\mathbf{x}$ 及其时间导数 $\\dot{\\mathbf{r}} = a\\dot{\\mathbf{x}} + H\\mathbf{r}$，其中 $a$ 是尺度因子，$H$ 是哈勃参数。\n- 物理动量和本动速度之间的非相对论关系 $\\mathbf{p}_\\mathrm{phys} = m\\mathbf{v}_\\mathrm{pec}$。\n- 共动动量的定义 $\\mathbf{q} \\equiv a\\mathbf{p}_\\mathrm{phys}$。\n- 一个包含物质、辐射和暗能量的平坦宇宙学模型，其中哈勃参数作为尺度因子的函数由 $H(a) = H_0 \\sqrt{\\Omega_r a^{-4} + \\Omega_m a^{-3} + \\Omega_\\Lambda}$ 给出，且 $\\Omega_r + \\Omega_m + \\Omega_\\Lambda = 1$。\n\n仅使用这些基础，您必须：\n1. 推导一个各向同性的、不随时间变化的共动分布 $f(\\mathbf{q})$ 如何在尺度因子为 $a$ 时映射为一个物理本动速度分布 $f(\\mathbf{v}_\\mathrm{pec}; a)$，包括雅可比因子。然后，假设 $\\mathbf{q}$ 的单个分量服从零均值、标准差为 $\\sigma_q$ 的高斯（麦克斯韦-玻尔兹曼代理）统计，将推导特化到一维边缘分布。根据您的推导，得到物理本动速度分量的一维标准差 $\\sigma_v(a)$ 关于 $\\sigma_q$、$a$ 和 $m$ 的表达式。\n2. 考虑一种不正确的采样实践，其中热本动速度从共动动量分布中抽取，但在映射到速度时错误地忽略了因子 $a$。根据您的推导，仅用 $a$ 表达乘性偏差 $r_\\mathrm{wrong}(a) \\equiv \\tilde{\\sigma}_v(a) / \\sigma_v(a)$。\n3. 考虑第二种不正确的实践，在测量一维均方根速率之前，错误地将哈勃流加到了本动热速度上。这些粒子的共动位置 $x$ 在区间 $[-L/2, L/2]$ 内均匀分布。使用均匀分布的方差 $\\mathrm{Var}(x) = L^2/12$ 和您的 $H(a)$ 表达式，推导一个乘性偏差因子 $R(a, L)$，量化相对于仅有本动热速度的情况，均方根速率的偏差有多大。用 $H(a)$、$a$、$L$ 和一维本动热弥散 $\\sigma_v(a)$ 表达 $R(a, L)$。\n4. 实现一个程序，对下述每个测试用例执行以下数值实验，以数值方式验证第 1 项，并报告第 2 项和第 3 项中的偏差：\n   - 使用固定的随机种子 $s=12345$ 以保证可复现性。\n   - 给定参数 ($a, \\sigma_{v,1}, m, L, H_0, \\Omega_m, \\Omega_\\Lambda, \\Omega_r, N$)，构建一个零均值、标准差为 $\\sigma_q = m\\sigma_{v,1}$ 的高斯一维共动动量分量分布，其中 $\\sigma_{v,1}$ 是在 $a=1$ 时会实现的一维本动速度弥散。\n   - 生成 $N$ 个独立样本 $q \\sim \\mathcal{N}(0, \\sigma_q^2)$，并使用您的推导将它们映射到本动速度，得到一个采样集 `v_comoving`。\n   - 独立地使用您推导的 $\\sigma_v(a)$ 生成 $N$ 个样本 $v_\\mathrm{physical} \\sim \\mathcal{N}(0, \\sigma_v(a)^2)$。\n   - 计算经验一维标准差 `hat_sigma_comoving` 和 `hat_sigma_physical`，并报告绝对分数差异\n     $$ \\Delta \\equiv \\frac{|\\hat{\\sigma}_\\mathrm{comoving} - \\hat{\\sigma}_\\mathrm{physical}|}{\\sigma_v(a)} $$\n   - 计算并报告第 2 项中的解析错误映射因子 $r_\\mathrm{wrong}(a)$。\n   - 使用每个测试中给出的宇宙学参数，计算并报告第 3 项中的解析哈勃流污染偏差 $R(a, L)$。\n\n物理和数值单位：\n- 将速度 $\\mathbf{v}_\\mathrm{pec}$ 和 $\\sigma_{v,1}$ 的单位视为 $\\mathrm{km\\,s^{-1}}$。\n- 将长度 $L$ 的单位视为 $\\mathrm{Mpc}$。\n- 将哈勃常数 $H_0$ 的单位视为 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$。\n- 质量 $m$ 是一个任意正常数，用于通过 $\\sigma_q = m\\sigma_{v,1}$ 参数化 $\\sigma_q$；程序必须在量纲上保持一致，使得 $\\sigma_v(a)$ 的单位为 $\\mathrm{km\\,s^{-1}}$。\n- 所有输出 $\\Delta$、$r_\\mathrm{wrong}(a)$ 和 $R(a, L)$ 都是无量纲的。将数值报告为浮点数。\n\n测试套件：\n- 使用以下四个测试用例，每个用例指定为一个元组 ($a, \\sigma_{v,1}, m, L, H_0, \\Omega_m, \\Omega_\\Lambda, \\Omega_r, N$)：\n  1. ($\\frac{1}{50}$, 10, 1, 10, 70, 0.3, 0.7, $8.4 \\times 10^{-5}$, 200000)\n  2. ($\\frac{1}{200}$, 10, 1, 10, 70, 0.3, 0.7, $8.4 \\times 10^{-5}$, 200000)\n  3. ($\\frac{1}{5}$, 10, 1, 50, 70, 0.3, 0.7, $8.4 \\times 10^{-5}$, 200000)\n  4. (1, 10, 1, 10, 70, 0.3, 0.7, $8.4 \\times 10^{-5}$, 200000)\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。对于按上述顺序列出的每个测试用例，依次附加 $\\Delta$、$r_\\mathrm{wrong}(a)$ 和 $R(a, L)$。因此，最终输出应包含 12 个浮点数。将每个数字四舍五入到六位小数。例如，一个包含两个虚构测试用例的输出可能看起来像 $[\\Delta_1, r_{\\mathrm{wrong},1}, R_1, \\Delta_2, r_{\\mathrm{wrong},2}, R_2]$。", "solution": "该问题经评估具有科学依据、提法明确且客观。所有必要信息均已提供，物理和数学关系是宇宙学中的标准关系，任务也已明确定义。因此，我将继续提供一个完整的解决方案。\n\n解决方案遵循问题陈述，分为四个部分进行阐述。首先，我们推导共动动量分布与物理本动速度分布之间的关系。其次，我们量化由不正确映射引入的偏差。第三，我们量化由错误地包含哈勃流引入的偏差。最后，我们描述一个用于验证这些发现的数值实验的实现。\n\n### 1. 物理本动速度分布的推导\n\n我们从给定的定义开始，这些定义将共动动量 $\\mathbf{q}$ 与物理本动速度 $\\mathbf{v}_\\mathrm{pec}$ 联系起来：\n1.  共动动量的定义：$\\mathbf{q} \\equiv a \\, \\mathbf{p}_\\mathrm{phys}$，其中 $a$ 是尺度因子，$\\mathbf{p}_\\mathrm{phys}$ 是物理动量。\n2.  物理动量与本动速度之间的非相对论关系：$\\mathbf{p}_\\mathrm{phys} = m \\, \\mathbf{v}_\\mathrm{pec}$，其中 $m$ 是粒子质量。\n\n结合这两个方程，我们用 $\\mathbf{v}_\\mathrm{pec}$ 表示 $\\mathbf{q}$：\n$$\n\\mathbf{q} = a \\, (m \\, \\mathbf{v}_\\mathrm{pec}) = a \\, m \\, \\mathbf{v}_\\mathrm{pec}\n$$\n求解物理本动速度 $\\mathbf{v}_\\mathrm{pec}$，我们找到了从共动动量到它的映射：\n$$\n\\mathbf{v}_\\mathrm{pec} = \\frac{\\mathbf{q}}{a \\, m}\n$$\n问题指出，刘维尔定理意味着共动动量分布 $f(\\mathbf{q})$ 是不随时间变化的。为了找到在尺度因子为 $a$ 时的物理本动速度分布 $f(\\mathbf{v}_\\mathrm{pec}; a)$，我们进行变量替换。相空间密度守恒要求概率元相等：\n$$\nf(\\mathbf{v}_\\mathrm{pec}; a) \\, d^3v_\\mathrm{pec} = f(\\mathbf{q}) \\, d^3q\n$$\n因此，物理速度分布通过变换的雅可比行列式与共动动量分布相关：\n$$\nf(\\mathbf{v}_\\mathrm{pec}; a) = f(\\mathbf{q}(\\mathbf{v}_\\mathrm{pec})) \\left| \\det\\left(\\frac{\\partial q_i}{\\partial v_{\\mathrm{pec},j}}\\right) \\right|\n$$\n变换关系是 $\\mathbf{q} = a \\, m \\, \\mathbf{v}_\\mathrm{pec}$。雅可比矩阵的元素是 $\\frac{\\partial q_i}{\\partial v_{\\mathrm{pec},j}} = a \\, m \\, \\delta_{ij}$。其行列式为 $(a \\, m)^3$。\n\n现在我们特化到一维边缘分布。让我们考虑单个分量，比如 $q_x$。相应的物理速度分量是 $v_{\\mathrm{pec},x} = \\frac{q_x}{a \\, m}$。问题假设 $q_x$ 从一个零均值、标准差为 $\\sigma_q$ 的高斯分布中抽取，即 $q_x \\sim \\mathcal{N}(0, \\sigma_q^2)$。\n\n正态分布的一个性质是，如果一个随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，那么用一个常数 $c$ 对其进行缩放会得到一个新的随机变量 $c X \\sim \\mathcal{N}(c\\mu, (c\\sigma)^2)$。在我们的例子中，缩放常数是 $c = 1/(a \\, m)$。因此，物理本动速度分量 $v_{\\mathrm{pec},x}$ 也遵循一个正态分布，其均值为 $E[v_{\\mathrm{pec},x}] = \\frac{1}{a \\, m} E[q_x] = 0$，方差为 $\\mathrm{Var}(v_{\\mathrm{pec},x}) = \\left(\\frac{1}{a \\, m}\\right)^2 \\mathrm{Var}(q_x) = \\left(\\frac{\\sigma_q}{a \\, m}\\right)^2$。\n\n物理本动速度分量的一维标准差，记为 $\\sigma_v(a)$，是该方差的平方根：\n$$\n\\sigma_v(a) = \\frac{\\sigma_q}{a \\, m}\n$$\n问题进一步规定 $\\sigma_q$ 被参数化为 $\\sigma_q = m \\, \\sigma_{v,1}$，其中 $\\sigma_{v,1}$ 是在 $a=1$ 时的本动速度弥散。将此代入我们的 $\\sigma_v(a)$ 表达式中得到：\n$$\n\\sigma_v(a) = \\frac{m \\, \\sigma_{v,1}}{a \\, m} = \\frac{\\sigma_{v,1}}{a}\n$$\n这个结果正确地表明，随着宇宙的膨胀，本动速度按 $1/a$ 的规律衰减。\n\n### 2. 速度映射不正确引入的偏差\n\n第一个不正确的实践是在映射中省略了尺度因子 $a$。错误采样的速度 $\\tilde{\\mathbf{v}}_\\mathrm{pec}$ 计算如下：\n$$\n\\tilde{\\mathbf{v}}_\\mathrm{pec} = \\frac{\\mathbf{q}}{m}\n$$\n遵循与上面相同的统计论证，这个不正确速度的单个分量的标准差 $\\tilde{\\sigma}_v(a)$ 为：\n$$\n\\tilde{\\sigma}_v(a) = \\frac{\\sigma_q}{m}\n$$\n乘性偏差因子 $r_\\mathrm{wrong}(a)$ 是不正确标准差与正确标准差之比：\n$$\nr_\\mathrm{wrong}(a) \\equiv \\frac{\\tilde{\\sigma}_v(a)}{\\sigma_v(a)} = \\frac{\\sigma_q / m}{\\sigma_q / (a \\, m)} = \\frac{a \\, m}{m} = a\n$$\n偏差就是尺度因子 $a$。对于在早期宇宙（$a \\ll 1$）设定的初始条件，这个错误会导致对真实热速度的显著低估。\n\n### 3. 哈勃流污染引入的偏差\n\n第二个不正确的实践是在计算速度弥散之前，错误地将哈勃流加到本动速度上。粒子的总一维速度是其本动速度与局部哈勃流之和：\n$$\nv_\\mathrm{total,x} = \\mathbf{v}_\\mathrm{pec} \\cdot \\hat{\\mathbf{x}} + (H(a) \\mathbf{r}) \\cdot \\hat{\\mathbf{x}} = v_{\\mathrm{pec},x} + H(a) r_x\n$$\n使用关系式 $\\mathbf{r} = a \\, \\mathbf{x}$，我们有 $r_x = a \\, x$。因此：\n$$\nv_\\mathrm{total,x} = v_{\\mathrm{pec},x} + H(a) \\, a \\, x\n$$\n乘性偏差 $R(a, L)$ 是总速度的均方根（RMS）与仅本动速度的均方根之比。零均值随机变量的均方根就是其标准差。\n$$\nR(a, L) = \\frac{\\sqrt{E[v_\\mathrm{total,x}^2]}}{\\sqrt{E[v_{\\mathrm{pec},x}^2]}}\n$$\n我们知道 $E[v_{\\mathrm{pec},x}^2] = \\mathrm{Var}(v_{\\mathrm{pec},x}) = \\sigma_v(a)^2$，因为其均值为零。现在我们计算均方总速度：\n$$\nE[v_\\mathrm{total,x}^2] = E[(v_{\\mathrm{pec},x} + H(a) \\, a \\, x)^2] = E[v_{\\mathrm{pec},x}^2 + 2 H(a) \\, a \\, x \\, v_{\\mathrm{pec},x} + (H(a) \\, a \\, x)^2]\n$$\n根据期望的线性性质：\n$$\nE[v_\\mathrm{total,x}^2] = E[v_{\\mathrm{pec},x}^2] + 2 H(a) \\, a \\, E[x \\, v_{\\mathrm{pec},x}] + (H(a) \\, a)^2 E[x^2]\n$$\n粒子的本动热速度 $v_{\\mathrm{pec},x}$ 与其共动位置 $x$ 在统计上是独立的。因此，$E[x \\, v_{\\mathrm{pec},x}] = E[x] E[v_{\\mathrm{pec},x}]$。位置 $x$ 从区间 $[-L/2, L/2]$ 上的均匀分布中抽取，其均值为 $E[x] = 0$。本动速度来自均值为 $E[v_{\\mathrm{pec},x}] = 0$ 的高斯分布。因此，交叉项消失。\n\n表达式简化为：\n$$\nE[v_\\mathrm{total,x}^2] = E[v_{\\mathrm{pec},x}^2] + (H(a) \\, a)^2 E[x^2]\n$$\n对于 $[-L/2, L/2]$ 上的均匀分布，方差由 $\\mathrm{Var}(x) = L^2/12$ 给出。由于 $E[x]=0$，我们有 $E[x^2] = \\mathrm{Var}(x) = L^2/12$。将此式和 $E[v_{\\mathrm{pec},x}^2] = \\sigma_v(a)^2$ 代入，我们得到：\n$$\nE[v_\\mathrm{total,x}^2] = \\sigma_v(a)^2 + (H(a) \\, a)^2 \\frac{L^2}{12}\n$$\n偏差因子 $R(a, L)$ 于是为：\n$$\nR(a, L) = \\frac{\\sqrt{\\sigma_v(a)^2 + (H(a) \\, a \\, L)^2 / 12}}{\\sigma_v(a)} = \\sqrt{1 + \\frac{(H(a) \\, a \\, L)^2}{12 \\sigma_v(a)^2}}\n$$\n哈勃参数 $H(a)$ 由平坦宇宙学的弗里德曼方程给出：\n$$\nH(a) = H_0 \\sqrt{\\Omega_r a^{-4} + \\Omega_m a^{-3} + \\Omega_\\Lambda}\n$$\n\n### 4. 数值实现\n\n程序将为每个测试用例实现所推导的公式。\n- 对于给定的测试用例 $(a, \\sigma_{v,1}, m, L, H_0, \\Omega_m, \\Omega_\\Lambda, \\Omega_r, N)$:\n  1.  将所有测试的随机种子固定为 $s=12345$，以保证可复现性。\n  2.  计算理论速度弥散 $\\sigma_v(a) = \\sigma_{v,1}/a$。\n  3.  计算共动动量弥散 $\\sigma_q = m \\, \\sigma_{v,1}$。\n  4.  生成 $N$ 个样本 $q_i \\sim \\mathcal{N}(0, \\sigma_q^2)$。将它们映射到物理速度 $v_i = q_i / (a \\, m)$，并计算样本标准差 $\\hat{\\sigma}_\\mathrm{comoving}$。\n  5.  独立地从目标物理分布 $v'_i \\sim \\mathcal{N}(0, \\sigma_v(a)^2)$ 直接生成 $N$ 个样本，并计算它们的样本标准差 $\\hat{\\sigma}_\\mathrm{physical}$。\n  6.  计算分数差异 $\\Delta = |\\hat{\\sigma}_\\mathrm{comoving} - \\hat{\\sigma}_\\mathrm{physical}| / \\sigma_v(a)$。这个值应该很小，与采样噪声一致，从而验证两种采样方法是等效的。\n  7.  计算错误映射的解析偏差：$r_\\mathrm{wrong}(a) = a$。\n  8.  计算哈勃流污染的解析偏差：$R(a, L) = \\sqrt{1 + (H(a) a L)^2 / (12 \\sigma_v(a)^2)}$，使用给定的 $H(a)$ 公式。\n  9.  对每个案例报告三个无量纲的量 $\\Delta$、 $r_\\mathrm{wrong}(a)$ 和 $R(a, L)$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the warm dark matter thermal velocity sampling problem.\n\n    This function iterates through a set of test cases, each defining a cosmological\n    scenario. For each case, it:\n    1. Numerically validates that sampling from a comoving momentum distribution and\n       correctly mapping to physical velocity is equivalent to sampling directly\n       from the physical velocity distribution. The result is the fractional \n       difference Delta.\n    2. Analytically calculates the multiplicative bias factor `r_wrong` that arises \n       from an incorrect mapping (omitting the scale factor).\n    3. Analytically calculates the multiplicative bias factor `R` that arises from\n       contaminating peculiar velocity measurements with the Hubble flow.\n\n    The results from all test cases are collated and printed in the required format.\n    \"\"\"\n    \n    # Test suite: (a, sigma_v1, m, L, H0, Omega_m, Omega_Lambda, Omega_r, N)\n    test_cases = [\n        (1/50, 10, 1, 10, 70, 0.3, 0.7, 8.4e-5, 200000),\n        (1/200, 10, 1, 10, 70, 0.3, 0.7, 8.4e-5, 200000),\n        (1/5, 10, 1, 50, 70, 0.3, 0.7, 8.4e-5, 200000),\n        (1, 10, 1, 10, 70, 0.3, 0.7, 8.4e-5, 200000),\n    ]\n\n    all_results = []\n    \n    # Use a single random number generator for the entire process for reproducibility.\n    # The seed is fixed as per the problem statement.\n    rng = np.random.default_rng(12345)\n\n    for case in test_cases:\n        a, sigma_v1, m, L, H0, Omega_m, Omega_Lambda, Omega_r, N = case\n\n        # ----------------------------------------------------------------------\n        # Part 1: Numerical validation and calculation of Delta\n        # ----------------------------------------------------------------------\n        \n        # Theoretical 1D peculiar velocity dispersion at scale factor a\n        # sigma_v(a) = sigma_{v,1} / a\n        sigma_v_a = sigma_v1 / a\n\n        # 1D comoving momentum dispersion\n        # sigma_q = m * sigma_{v,1}\n        sigma_q = m * sigma_v1\n\n        # Method 1: Sample from comoving momentum and map to physical velocity\n        # q ~ N(0, sigma_q^2)\n        q_samples = rng.normal(loc=0.0, scale=sigma_q, size=N)\n        # v_pec = q / (a * m)\n        v_comoving_samples = q_samples / (a * m)\n        hat_sigma_comoving = np.std(v_comoving_samples)\n\n        # Method 2: Sample directly from the physical velocity distribution\n        # v_pec ~ N(0, sigma_v(a)^2)\n        v_physical_samples = rng.normal(loc=0.0, scale=sigma_v_a, size=N)\n        hat_sigma_physical = np.std(v_physical_samples)\n\n        # Compute the absolute fractional difference Delta\n        delta = np.abs(hat_sigma_comoving - hat_sigma_physical) / sigma_v_a\n        all_results.append(delta)\n\n        # ----------------------------------------------------------------------\n        # Part 2: Analytic calculation of the wrong-mapping factor r_wrong\n        # ----------------------------------------------------------------------\n        \n        # r_wrong(a) = a\n        r_wrong = a\n        all_results.append(r_wrong)\n\n        # ----------------------------------------------------------------------\n        # Part 3: Analytic calculation of the Hubble-contamination bias R\n        # ----------------------------------------------------------------------\n\n        # Hubble parameter at scale factor a\n        # H(a) = H0 * sqrt(Omega_r*a^-4 + Omega_m*a^-3 + Omega_Lambda)\n        H_a = H0 * np.sqrt(Omega_r * a**-4 + Omega_m * a**-3 + Omega_Lambda)\n\n        # Multiplicative bias factor R(a, L)\n        # R(a, L) = sqrt(1 + (H(a)*a*L)^2 / (12*sigma_v(a)^2))\n        R_a_L = np.sqrt(1.0 + (H_a * a * L)**2 / (12.0 * sigma_v_a**2))\n        all_results.append(R_a_L)\n\n    # Print all results in the specified format, rounded to 6 decimal places.\n    print(f\"[{','.join([f'{val:.6f}' for val in all_results])}]\")\n\nsolve()\n\n```", "id": "3489237"}, {"introduction": "虽然对热速度进行随机抽样在平均意义上是正确的，但它会引入离散噪声，这可能会污染模拟，尤其是在小尺度上。这个高级练习探讨了旨在从一开始就减轻此问题的“宁静启动”（quiet start）技术。通过分析和比较不同的速度分配方案，您将学习如何以最小的伪噪声来初始化模拟，这是高精度数值宇宙学的一项至关重要的技能。[@problem_id:3489333]", "problem": "您正在为一个粒子-网格（PM）求解器，在红移 $z_i$ 处的均匀欧拉网格上，初始化一个温暗物质（WDM）宇宙学 $N$ 体模拟。在每个共动体积为 $V_c$ 的网格单元中，有 $N_p$ 个质量为 $m$ 的等质量宏观粒子，其位置编码了来自拉格朗日初始条件的密度场。为了模拟 WDM 的热运动，必须为每个粒子分配一个特有热速度 $\\mathbf{v}_{\\mathrm{th}}$，该速度从一个在 $z_i$ 处平稳、均匀、各向同性的单粒子速度分布 $f(\\mathbf{v})$ 中抽取，其均值为零 $\\langle \\mathbf{v}_{\\mathrm{th}} \\rangle = \\mathbf{0}$，二阶矩为各向同性 $\\langle v_i v_j \\rangle = \\sigma_{\\mathrm{th}}^2 \\,\\delta_{ij}$，其中 $i,j \\in \\{x,y,z\\}$，$\\delta_{ij}$ 是克罗内克符号。令 $p(s)$ 表示对应的 $s \\equiv \\|\\mathbf{v}_{\\mathrm{th}}\\|$ 的一维速率概率密度。\n\n您需要设计一种热速度的宁静启动（quiet-start）分配方案，该方案能够最小化虚假的网格尺度各向异性，并消除每个单元的净动量。该方案在初始化时必须在每个网格单元中满足以下所有条件：\n\n(i) 每个单元的动量严格为零：$\\sum_{a=1}^{N_p} m\\,\\mathbf{v}_{\\mathrm{th},a} = \\mathbf{0}$。\n\n(ii) 在固定的单次实现中，每个单元的二阶矩张量是各向同性的：$\\sum_{a=1}^{N_p} m\\,\\mathbf{v}_{\\mathrm{th},a}\\mathbf{v}_{\\mathrm{th},a}^{\\top}$ 对于该次实现（而不仅是在期望意义上）与单位张量 $\\mathbf{I}$ 成正比，因此任何残余误差都是相对于 $m\\,N_p\\,\\sigma_{\\mathrm{th}}^2$ 的一个标量前因子误差。\n\n(iii) 在单元系综中具有正确的单粒子速率定律：在对方向进行边缘化后，单粒子速率分布为 $p(s)$，且在均值或方差上没有偏差。\n\n假设 $N_p$ 足够大，以便在需要时进行分组构造。考虑以下四种用于每个单元分配的候选算法：\n\nA. 对每个单元，抽取 $N_p/2$ 个独立的 3 维向量 $\\{\\mathbf{u}_k\\}_{k=1}^{N_p/2}$，其方向在单位球面上各向同性，速率 $s_k \\sim p(s)$。对于该单元中的每个 $k$，将速度 $+\\mathbf{u}_k$ 和 $-\\mathbf{u}_k$ 分配给两个粒子。\n\nB. 对每个单元，固定六个基本方向 $\\{\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}\\}$。抽取三个独立的速率 $s_x, s_y, s_z \\sim p(s)$。将 $N_p$ 个粒子尽可能均匀地分成六个相等的组（如果 $N_p$ 不是六的倍数，则最多相差一个），并将速率 $\\pm s_x$ 分配给 $\\pm \\hat{\\mathbf{x}}$ 组，速率 $\\pm s_y$ 分配给 $\\pm \\hat{\\mathbf{y}}$ 组，速率 $\\pm s_z$ 分配给 $\\pm \\hat{\\mathbf{z}}$ 组。\n\nC. 对每个单元，选择构成球面 2-设计（spherical 2-design）的 $D$ 个单位方向 $\\{\\mathbf{n}_d\\}_{d=1}^{D}$（例如，一个正八面体的 $D=6$ 个顶点，即 $\\{\\pm \\hat{\\mathbf{x}}, \\pm \\hat{\\mathbf{y}}, \\pm \\hat{\\mathbf{z}}\\}$）。将 $N_p$ 个粒子划分为 $K$ 个大小为 $D$ 的完整角度多重态（为简单起见，假设 $D \\mid N_p$）。对于每个多重态 $g \\in \\{1,\\dots,K\\}$，抽取一个速率 $s_g \\sim p(s)$，并将 $D$ 个速度 $\\{+\\!s_g\\,\\mathbf{n}_1,\\,-\\!s_g\\,\\mathbf{n}_1,\\,\\dots,\\,+\\!s_g\\,\\mathbf{n}_{D/2},\\,-\\!s_g\\,\\mathbf{n}_{D/2}\\}$ 分配给该多重态的 $D$ 个粒子，即在一个多重态内所有方向上的速率相等，并进行对跖配对。\n\nD. 对每个单元，选择如选项 C 中构成球面 2-设计的 $D$ 个单位方向 $\\{\\mathbf{n}_d\\}_{d=1}^{D}$。将粒子划分为 $K$ 个大小为 $D$ 的多重态。在每个多重态内，抽取 $D$ 个独立的速率 $\\{s_{g,d}\\} \\sim p(s)$，并将速度 $\\{\\pm s_{g,d}\\,\\mathbf{n}_d\\}$ 分配给对跖对。在单元中分配完所有速度后，通过减去每个单元的平均速度来强制净动量严格为零：$\\mathbf{v}_{\\mathrm{th},a} \\leftarrow \\mathbf{v}_{\\mathrm{th},a} - \\frac{1}{N_p}\\sum_{b=1}^{N_p}\\mathbf{v}_{\\mathrm{th},b}$。\n\n哪个选项满足所述的条件 (i)–(iii)？\n\n- A. 满足 (i) 但不满足 (ii)；仅在期望意义上满足 (iii)。\n\n- B. 满足 (i) 但不满足 (ii) 或 (iii)。\n\n- C. 满足 (i)、(ii) 和 (iii)。\n\n- D. 通过构造，在减法操作后满足 (i)，但不满足 (ii) 或 (iii)。", "solution": "该问题要求根据三个条件，评估四种不同的为 $N$ 体模拟单元中的粒子分配热速度的算法：（i）每个单元的净动量严格为零，（ii）每个单元的二阶矩张量严格各向同性，以及（iii）产生正确的单粒子速率分布。\n\n设一个单元中的粒子索引为 $a=1, \\dots, N_p$。分配给粒子 $a$ 的热速度为 $\\mathbf{v}_a$。每个粒子的质量为 $m$。\n\n这三个条件是：\n(i) 零动量：$\\sum_{a=1}^{N_p} m \\mathbf{v}_a = \\mathbf{0}$。由于 $m$ 是常数，这等价于 $\\sum_{a=1}^{N_p} \\mathbf{v}_a = \\mathbf{0}$。\n(ii) 各向同性的二阶矩张量：速度二阶矩张量，其分量为 $S_{ij} = \\sum_{a=1}^{N_p} v_{a,i} v_{a,j}$，必须与单位张量成正比。这意味着对于某个标量 $C$ 有 $S_{ij} = C \\delta_{ij}$，这意味着 $S_{xx} = S_{yy} = S_{zz}$ 且 $S_{xy} = S_{xz} = S_{yz} = 0$。\n(iii) 正确的速率分布：粒子速率 $s_a = \\|\\mathbf{v}_a\\|$ 的经验概率分布应该是目标分布 $p(s)$ 的一个统计上可靠的表示，其矩（如均值或方差）没有引入偏差。\n\n让我们分析每种提出的算法。\n\n### 算法 A 的分析\n\n该算法将粒子配对。对每个粒子对，生成一个随机向量 $\\mathbf{u}_k$，并为该对分配速度 $+\\mathbf{u}_k$ 和 $-\\mathbf{u}_k$。速率 $s_k = \\|\\mathbf{u}_k\\|$ 从 $p(s)$ 中抽取，方向是各向同性选择的。共有 $N_p/2$ 个这样的粒子对。\n\n-   **条件 (i) - 动量**：每个单元的总速度和为 $\\sum_{k=1}^{N_p/2} (\\mathbf{u}_k + (-\\mathbf{u}_k)) = \\sum_{k=1}^{N_p/2} \\mathbf{0} = \\mathbf{0}$。**条件 (i) 满足。**\n\n-   **条件 (ii) - 二阶矩**：二阶矩张量为 $S_{ij} = \\sum_{a=1}^{N_p} v_{a,i} v_{a,j}$。对于每个粒子对 $k$，其贡献为 $u_{k,i} u_{k,j} + (-u_{k,i})(-u_{k,j}) = 2 u_{k,i} u_{k,j}$。因此，$S_{ij} = \\sum_{k=1}^{N_p/2} 2 u_{k,i} u_{k,j}$。令 $\\mathbf{u}_k = s_k \\hat{\\mathbf{n}}_k$，其中 $s_k$ 是一个随机速率，$\\hat{\\mathbf{n}}_k$ 是一个随机的各向同性单位向量。则 $S_{ij} = 2 \\sum_{k=1}^{N_p/2} s_k^2 n_{k,i} n_{k,j}$。对于有限数量的随机向量 $N_p/2$，这个和在单次实现中不会产生一个对角张量。例如，非对角项 $S_{xy} = 2 \\sum_k s_k^2 n_{k,x} n_{k,y}$ 是一系列随机变量的和，通常不为零。虽然在期望上 $\\langle S_{ij} \\rangle \\propto \\delta_{ij}$，但条件要求这对单次实现成立。**条件 (ii) 不满足。**\n\n-   **条件 (iii) - 速率分布**：该算法从 $p(s)$ 中抽取 $N_p/2$ 个速率 $\\{s_k\\}$。每个速率被分配给两个粒子。最终得到的 $N_p$ 个速率集合是 $\\{s_1, s_1, s_2, s_2, \\dots, s_{N_p/2}, s_{N_p/2}\\}$。这不是从 $p(s)$ 中独立抽取的 $N_p$ 个样本的集合。经验分布由一个大小为 $N_p/2$ 的较小样本决定。虽然系综性质（在许多单元上平均）可能是正确的，但条件适用于为模拟创建的样本。因此，单粒子速率定律仅在平均意义上得到恢复。选项的描述“仅在期望意义上满足 (iii)”是对这一局限性的准确评估。**条件 (iii) 没有严格满足。**\n\n**对 A 的结论：** 陈述“满足 (i) 但不满足 (ii)；仅在期望意义上满足 (iii)”是**正确的**。\n\n### 算法 B 的分析\n\n该算法使用六个固定的基本方向 $\\{\\pm\\hat{\\mathbf{x}}, \\pm\\hat{\\mathbf{y}}, \\pm\\hat{\\mathbf{z}}\\}$。它抽取三个独立的速率 $s_x, s_y, s_z \\sim p(s)$ 并将它们分配给不同的粒子组。\n\n-   **条件 (i) - 动量**：粒子被分成六个大小约等于 $N_p/6$ 的组。这些组被分配速度 $\\pm s_x\\hat{\\mathbf{x}}$、$\\pm s_y\\hat{\\mathbf{y}}$、$\\pm s_z\\hat{\\mathbf{z}}$。对于每个轴，都有一个具有正速度的组和一个具有负速度的组。如果相对的组大小相等（例如，如果 $6 | N_p$），总动量严格为 $\\frac{N_p}{6}(s_x\\hat{\\mathbf{x}} - s_x\\hat{\\mathbf{x}} + s_y\\hat{\\mathbf{y}} - s_y\\hat{\\mathbf{y}} + s_z\\hat{\\mathbf{z}} - s_z\\hat{\\mathbf{z}}) = \\mathbf{0}$。描述中暗示了通过配对来抵消动量。**条件 (i) 满足。**\n\n-   **条件 (ii) - 二阶矩**：二阶矩张量为 $S_{ij} = \\sum_a v_{a,i} v_{a,j}$。速度沿 $\\hat{\\mathbf{x}}$ 方向的粒子仅对 $S_{xx}$ 有贡献。$\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{z}}$ 方向同理。因此，所有非对角项均为零，$S_{xy}=S_{xz}=S_{yz}=0$。对角项为 $S_{xx} = (\\frac{N_p}{3}) s_x^2$，$S_{yy} = (\\frac{N_p}{3}) s_y^2$ 和 $S_{zz} = (\\frac{N_p}{3}) s_z^2$（假设 $3|N_p$）。为使张量是各向同性的，我们需要 $S_{xx}=S_{yy}=S_{zz}$，这意味着 $s_x^2=s_y^2=s_z^2$。由于 $s_x, s_y, s_z$ 是从分布 $p(s)$ 中独立抽取的，它们在任何特定实现中都会不同。**条件 (ii) 不满足。**\n\n-   **条件 (iii) - 速率分布**：分配给 $N_p$ 个粒子的速率只有三个不同的值：$s_x, s_y, s_z$，每个值重复 $N_p/3$ 次。这对于一个连续分布 $p(s)$ 来说是一个极其糟糕的表示。经验分布是三个狄拉克δ函数之和，这与 $p(s)$ 不匹配。**条件 (iii) 不满足。**\n\n**对 B 的结论：** 陈述“满足 (i) 但不满足 (ii) 或 (iii)”是**正确的**。\n\n### 算法 C 的分析\n\n该算法使用一组构成球面 2-设计的 $D$ 个方向 $\\{\\mathbf{n}_d\\}$。粒子被分组成大小为 $D$ 的多重态。对于每个多重态，从 $p(s)$ 中抽取一个速率 $s_g$，并分配给所有 $D$ 个粒子，速度为 $s_g\\mathbf{n}_d$。\n\n单位球面 $S^2$ 上的球面 2-设计的一个关键性质是，对于任何次数最高为 2 的多项式，其在这 $D$ 个点上的平均值等于其在整个球面上的平均值。\n对于 1 次多项式：$\\sum_{d=1}^D n_{d,i} = 0$。\n对于 2 次多项式：$\\sum_{d=1}^D n_{d,i} n_{d,j} = \\frac{D}{3} \\delta_{ij}$。\n\n-   **条件 (i) - 动量**：对于每个多重态 $g$，速度之和为 $\\sum_{d=1}^D s_g \\mathbf{n}_d = s_g \\sum_{d=1}^D \\mathbf{n}_d$。根据 1-designs（2-designs 也是 1-designs）的性质，$\\sum_d \\mathbf{n}_d = \\mathbf{0}$。因此，每个多重态的动量为零。整个单元的总动量是多重态动量之和，也为零。**条件 (i) 满足。**\n\n-   **条件 (ii) - 二阶矩**：单元的二阶矩张量为 $S_{ij} = \\sum_{g=1}^K \\sum_{d=1}^D v_{g,d,i} v_{g,d,j}$，其中 $K=N_p/D$ 是多重态的数量。速度为 $v_{g,d,i} = s_g n_{d,i}$。\n$S_{ij} = \\sum_{g=1}^K \\sum_{d=1}^D s_g^2 n_{d,i} n_{d,j} = \\sum_{g=1}^K s_g^2 \\left( \\sum_{d=1}^D n_{d,i} n_{d,j} \\right)$。\n使用 2-设计的性质，$\\sum_d n_{d,i} n_{d,j} = \\frac{D}{3} \\delta_{ij}$。\n所以，$S_{ij} = \\sum_{g=1}^K s_g^2 \\left( \\frac{D}{3} \\delta_{ij} \\right) = \\left( \\frac{D}{3} \\sum_{g=1}^K s_g^2 \\right) \\delta_{ij}$。\n这是 $C \\delta_{ij}$ 的形式，其中 $C = \\frac{D}{3} \\sum_g s_g^2$。对于每次实现，该张量都与单位矩阵成正比。**条件 (ii) 满足。**\n\n-   **条件 (iii) - 速率分布**：该算法抽取 $K=N_p/D$ 个速率 $\\{s_g\\}$，并将每个速率分配给 $D$ 个粒子。完整的速率集合是 $\\{s_1, \\dots, s_1, s_2, \\dots, s_2, \\dots \\}$，其中每个 $s_g$ 重复 $D$ 次。速率的经验分布是由一个较小的 $K$ 个独立抽样的样本构建的，而不是 $N_p$ 个。然而，抽样过程直接来自 $p(s)$，并且没有引入偏差。粒子系综的期望平均速率 $\\langle \\bar{s} \\rangle$ 和期望均方速率 $\\langle \\overline{s^2} \\rangle$ 是正确的。在“宁静启动”方法的背景下，这通常被认为是为了精确满足更关键的条件 (ii) 而做出的有效权衡。鉴于所给选项，此方法是唯一一个满足 (i) 和 (ii) 并且通过对正确分布进行抽样来生成速率而没有引入系统性偏差的方法。**条件 (iii) 满足**（在数值方案所要求的意义上）。\n\n**对 C 的结论：** 陈述“满足 (i)、(ii) 和 (iii)”是**正确的**。\n\n### 算法 D 的分析\n\n该算法也使用 2-设计来确定方向。然而，它为粒子（或粒子对）抽取独立的速率，然后减去单元的平均速度来强制动量为零。设初始速度为 $\\mathbf{v'}_a$，最终速度为 $\\mathbf{v}_a = \\mathbf{v'}_a - \\bar{\\mathbf{v'}}$。\n\n-   **条件 (i) - 动量**：最终动量为 $\\sum_a m \\mathbf{v}_a = m \\sum_a (\\mathbf{v'}_a - \\bar{\\mathbf{v'}}) = m(\\sum_a \\mathbf{v'}_a - N_p \\bar{\\mathbf{v'}}) = m(N_p \\bar{\\mathbf{v'}} - N_p \\bar{\\mathbf{v'}}) = \\mathbf{0}$。通过这最后一步，**条件 (i) 被满足**。\n\n-   **条件 (ii) - 二阶矩**：初始张量 $S'_{ij} = \\sum_a v'_{a,i}v'_{a,j}$ 不是各向同性的，因为每个方向的速率是独立的，类似于算法 A 和 B 中的问题（例如，$S'_{xx} \\neq S'_{yy}$）。最终张量是 $S_{ij} = \\sum_a v_{a,i}v_{a,j} = S'_{ij} - N_p \\bar{v'}_i \\bar{v'}_j$。校正项 $-N_p \\bar{\\mathbf{v'}}\\bar{\\mathbf{v'}}^{\\top}$ 是一个秩-1 投影算子，它本身是各向异性的。从另一个通常非各向同性的矩阵中减去一个各向异性的矩阵，结果不会是各向同性的。**条件 (ii) 不满足。**\n\n-   **条件 (iii) - 速率分布**：粒子的最终速率为 $s_a = \\|\\mathbf{v}_a\\| = \\|\\mathbf{v'}_a - \\bar{\\mathbf{v'}}\\|$。这改变了所有粒子的速率，使其偏离最初抽样得到的值。均方速率被系统性地改变了：$\\frac{1}{N_p}\\sum_a s_a^2 = \\frac{1}{N_p}\\sum_a \\|\\mathbf{v'}_a - \\bar{\\mathbf{v'}}\\|^2 = \\frac{1}{N_p}\\sum_a (s'_a)^2 - \\|\\bar{\\mathbf{v'}}\\|^2$。由于在任何单次实现中 $\\|\\bar{\\mathbf{v'}}\\|^2 > 0$，这个过程系统性地减少了总动能，并在速度分布的方差中引入了偏差。**条件 (iii) 不满足。**\n\n**对 D 的结论：** 陈述“通过构造，在减法操作后满足 (i)，但不满足 (ii) 或 (iii)”是**正确的**。\n\n### 结论\n根据分析，算法 C 是唯一满足所有三个条件的算法。它利用球面 2-设计的数学特性，在每一次实现中都能精确地消除动量并确保二阶矩张量的各向同性，这正是宁静启动的精髓所在。其生成速率的方法在统计上是无偏的，使其成为更优越的选择。", "answer": "$$\\boxed{C}$$", "id": "3489333"}]}