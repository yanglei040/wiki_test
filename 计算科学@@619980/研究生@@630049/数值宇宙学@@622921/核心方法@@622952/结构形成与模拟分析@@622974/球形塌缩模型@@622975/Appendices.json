{"hands_on_practices": [{"introduction": "为了理解宇宙结构的形成，我们首先研究其早期线性阶段，此时密度涨落还很小。本练习旨在推导并数值求解一个简单的爱因斯坦-德西特宇宙中线性增长因子 $D(a)$ 所遵循的方程。通过 [@problem_id:3498601] 的实践，你将为理解密度扰动在进入非线性演化之前的初始增长过程打下坚实的基础。", "problem": "考虑在一个平坦的、仅含物质的爱因斯坦-德西特 (Einstein–de Sitter) 背景宇宙中，小的球对称物质超密度的线性增长，这与球形塌缩模型相关。背景包含一种无压的非相对论性流体，其质量密度为 $\\rho_{\\mathrm{m}}(t)$，哈勃膨胀率为 $H(t) = \\dot{a}/a$，其中 $a$ 是标度因子。在牛顿次视界体系中，线性超密度 $\\delta(\\mathbf{x}, t)$ 遵循与引力耦合的尘埃流体的标准线性化连续性方程、欧拉方程和泊松方程，以及背景的弗里德曼方程。这些方程结合起来，为增长模式下的均匀线性增长因子 $D(a)$ 提供了一个二阶常微分方程，其定义为 $\\delta(\\mathbf{x}, a) = D(a)\\,\\delta(\\mathbf{x}, a_{\\mathrm{ini}})$。\n\n任务 A (从基本原理推导)：从无压流体的线性化流体方程和泊松方程，以及爱因斯坦-德西特情况下的弗里德曼方程出发，推导线性增长因子 $D$ 作为对数标度因子 $x \\equiv \\ln a$ 的函数的常微分方程。您的推导必须从次视界体系中线性增长的宇宙时方程开始，\n$$\n\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho_{\\mathrm{m}} \\delta = 0,\n$$\n并结合爱因斯坦-德西特恒等式 $H^2 = \\tfrac{8\\pi G}{3}\\rho_{\\mathrm{m}}$ 和 $\\rho_{\\mathrm{m}} \\propto a^{-3}$。然后变换到 $x = \\ln a$，并将所得方程完全用 $D(x)$ 及其对 $x$ 的导数表示。基于该微分方程在小 $a$ 时的渐近行为，确定在一个非常早的标度因子 $a_{\\mathrm{ini}}$ 处的一组一致的初始条件，以分离出增长模式并固定整体归一化。\n\n任务 B (数值计算与验证)：实现一个鲁棒的初值问题求解器，对 $D(x)$ 的微分方程从 $a_{\\mathrm{ini}} = 10^{-8}$ 积分到下面测试套件中抽取的一组最终标度因子 $a_{\\mathrm{end}}$。使用高阶、自适应步长的常微分方程方法，并设置严格的绝对和相对容差来控制数值误差。对于测试套件中的每个 $a_{\\mathrm{end}}$，计算 $D_{\\mathrm{num}}(a_{\\mathrm{end}})$ 并将其与您在任务 A 中推导出的解析增长模式解进行比较。报告相对误差\n$$\n\\varepsilon(a_{\\mathrm{end}}) \\equiv \\frac{\\left| D_{\\mathrm{num}}(a_{\\mathrm{end}}) - D_{\\mathrm{ana}}(a_{\\mathrm{end}}) \\right|}{\\left| D_{\\mathrm{ana}}(a_{\\mathrm{end}}) \\right|}。\n$$\n您的实现必须针对所有测试点，目标并达到 $\\varepsilon(a_{\\mathrm{end}})  10^{-6}$。\n\n测试套件：使用最终标度因子\n$$\n\\left[ 10^{-6},\\, 10^{-4},\\, 10^{-2},\\, 10^{-1},\\, 1,\\, 2 \\right]。\n$$\n\n最终输出格式：您的程序应生成单行输出，其中包含六个相对误差，顺序与测试套件相同，形式为用方括号括起来的逗号分隔列表（例如，“[e1,e2,e3,e4,e5,e6]”）。由于 $a$ 和 $D$ 是无量纲的，因此不需要单位。不涉及角度。输出值必须是实数（浮点数）。", "solution": "用户提供了一个来自物理宇宙学领域的良置问题，具体涉及结构形成的线性理论。任务是首先推导爱因斯坦-德西特宇宙中线性增长因子的主控常微分方程 (ODE) 并找到其解析解，其次，数值求解此 ODE 并对照解析结果验证其准确性。\n\n### 任务 A：推导与解析解\n\n起点是线性密度对比 $\\delta$ 在宇宙时 $t$ 中的演化方程：\n$$\n\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho_{\\mathrm{m}} \\delta = 0\n$$\n其中点号表示对 $t$ 的导数，$H$ 是哈勃参数，$G$ 是引力常数，$\\rho_{\\mathrm{m}}$ 是背景物质密度。\n\n对于一个平坦的、仅含物质的爱因斯坦-德西特 (EdS) 宇宙，第一弗里德曼方程简化为 $H^2 = \\frac{8\\pi G}{3}\\rho_{\\mathrm{m}}$。我们可以用它来替换 $4 \\pi G \\rho_{\\mathrm{m}}$ 项：\n$$\n4 \\pi G \\rho_{\\mathrm{m}} = \\frac{3}{2} H^2\n$$\n将此代入增长方程，得到：\n$$\n\\ddot{\\delta} + 2 H \\dot{\\delta} - \\frac{3}{2} H^2 \\delta = 0\n$$\n该问题要求一个以对数标度因子 $x \\equiv \\ln a$ 表示的方程。我们执行从 $t$ 到 $x$ 的变量替换。链式法则给出了时间导数算符为：\n$$\n\\frac{d}{dt} = \\frac{da}{dt} \\frac{d}{da} = \\dot{a} \\frac{d}{da} = a H \\frac{d}{da}\n$$\n此外，由于 $x = \\ln a$，我们有 $\\frac{d}{da} = \\frac{dx}{da} \\frac{d}{dx} = \\frac{1}{a} \\frac{d}{dx}$。因此：\n$$\n\\frac{d}{dt} = H \\frac{d}{dx}\n$$\n 将此应用于 $\\delta$，我们得到一阶导数：\n$$\n\\dot{\\delta} = H \\frac{d\\delta}{dx}\n$$\n二阶导数是：\n$$\n\\ddot{\\delta} = \\frac{d}{dt}\\left(H \\frac{d\\delta}{dx}\\right) = \\dot{H} \\frac{d\\delta}{dx} + H \\frac{d}{dt}\\left(\\frac{d\\delta}{dx}\\right) = \\dot{H} \\frac{d\\delta}{dx} + H^2 \\frac{d^2\\delta}{dx^2}\n$$\n对于 EdS 宇宙，物质密度按 $\\rho_{\\mathrm{m}} \\propto a^{-3}$ 变化，从弗里德曼方程可知 $H^2 \\propto \\rho_{\\mathrm{m}} \\propto a^{-3}$。因此 $H \\propto a^{-3/2}$。取时间导数，$\\dot{H} = \\frac{dH}{da}\\dot{a} = (-\\frac{3}{2}a^{-5/2})\\dot{a} = -\\frac{3}{2}a^{-5/2}(aH) = -\\frac{3}{2}a^{-3/2}H$。由于 $H \\propto a^{-3/2}$，我们有 $\\dot{H} = -\\frac{3}{2}H^2$。将此代入 $\\ddot{\\delta}$ 的表达式中：\n$$\n\\ddot{\\delta} = -\\frac{3}{2}H^2 \\frac{d\\delta}{dx} + H^2 \\frac{d^2\\delta}{dx^2}\n$$\n现在，我们将 $\\dot{\\delta}$ 和 $\\ddot{\\delta}$ 的表达式代入增长方程：\n$$\n\\left(-\\frac{3}{2}H^2 \\frac{d\\delta}{dx} + H^2 \\frac{d^2\\delta}{dx^2}\\right) + 2H \\left(H \\frac{d\\delta}{dx}\\right) - \\frac{3}{2}H^2 \\delta = 0\n$$\n两边同除以 $H^2$ (非零) 并合并各项：\n$$\n\\frac{d^2\\delta}{dx^2} + \\left(2 - \\frac{3}{2}\\right)\\frac{d\\delta}{dx} - \\frac{3}{2}\\delta = 0\n$$\n这就得到了增长因子 $D(x)$ 的最终 ODE，其中 $\\delta(\\mathbf{x}, x) \\propto D(x)$：\n$$\n\\frac{d^2 D}{dx^2} + \\frac{1}{2}\\frac{d D}{dx} - \\frac{3}{2} D = 0\n$$\n这是一个二阶线性齐次常系数常微分方程。我们寻求形式为 $D(x) = e^{\\lambda x}$ 的解。其特征方程为：\n$$\n\\lambda^2 + \\frac{1}{2}\\lambda - \\frac{3}{2} = 0\n$$\n两边乘以 2 得到 $2\\lambda^2 + \\lambda - 3 = 0$，可因式分解为 $(2\\lambda+3)(\\lambda-1)=0$。其根为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -3/2$。\n\n通解是两个独立解的线性组合：\n$$\nD(x) = c_1 e^x + c_2 e^{-3x/2}\n$$\n转换回标度因子 $a = e^x$：\n$$\nD(a) = c_1 a + c_2 a^{-3/2}\n$$\n$D_+(a) \\propto a$ 项是**增长模式**，在晚期 ($a \\to \\infty$) 占主导地位。$D_-(a) \\propto a^{-3/2}$ 项是**衰减模式**，在早期 ($a \\to 0$) 占主导地位。\n\n为了研究结构形成，我们关心的是增长模式。我们通过设置 $c_2 = 0$ 来将其分离出来。解为 $D(a) = c_1 a$。归一化由问题的定义 $\\delta(\\mathbf{x}, a) = D(a)\\,\\delta(\\mathbf{x}, a_{\\mathrm{ini}})$ 固定，这意味着 $D(a_{\\mathrm{ini}}) = 1$。应用此条件：\n$$\nD(a_{\\mathrm{ini}}) = c_1 a_{\\mathrm{ini}} = 1 \\quad \\implies \\quad c_1 = \\frac{1}{a_{\\mathrm{ini}}}\n$$\n因此，解析增长模式解是：\n$$\nD_{\\mathrm{ana}}(a) = \\frac{a}{a_{\\mathrm{ini}}} \\quad \\text{或} \\quad D_{\\mathrm{ana}}(x) = \\frac{e^x}{e^{x_{\\mathrm{ini}}}} = e^{x-x_{\\mathrm{ini}}}\n$$\n为了设置数值求解器，我们需要在 $x_{\\mathrm{ini}} = \\ln(a_{\\mathrm{ini}})$ 处的 $D(x)$ 及其导数 $D'(x) = \\frac{dD}{dx}$ 的初始条件。基于解析解 $D_{\\mathrm{ana}}(x) = e^{x-x_{\\mathrm{ini}}}$：\n$$\nD(x_{\\mathrm{ini}}) = e^{x_{\\mathrm{ini}}-x_{\\mathrm{ini}}} = e^0 = 1\n$$\n$$\nD'(x) = \\frac{d}{dx}e^{x-x_{\\mathrm{ini}}} = e^{x-x_{\\mathrm{ini}}} \\quad \\implies \\quad D'(x_{\\mathrm{ini}}) = e^{x_{\\mathrm{ini}}-x_{\\mathrm{ini}}} = 1\n$$\n在 $x_{\\mathrm{ini}}$ 处所需的初始条件是 $D(x_{\\mathrm{ini}}) = 1$ 和 $D'(x_{\\mathrm{ini}}) = 1$。\n\n### 任务 B：数值实现与验证\n\n数值任务是求解该 ODE，并与推导出的解析解进行比较。我们使用一个鲁棒的初值问题求解器。首先需要将二阶 ODE 转换为一个由两个一阶 ODE 组成的方程组。设状态向量为 $\\mathbf{Y}(x) = [y_0(x), y_1(x)]^T$，其中 $y_0 = D(x)$ 且 $y_1 = D'(x)$。该方程组为：\n$$\n\\frac{d\\mathbf{Y}}{dx} = \n\\begin{pmatrix} y_0' \\\\ y_1' \\end{pmatrix} = \n\\begin{pmatrix} y_1 \\\\ -\\frac{1}{2}y_1 + \\frac{3}{2}y_0 \\end{pmatrix}\n$$\n该系统从初始点 $x_{\\mathrm{ini}} = \\ln(a_{\\mathrm{ini}}) = \\ln(10^{-8})$ 积分到测试套件中的每个终点 $x_{\\mathrm{end}} = \\ln(a_{\\mathrm{end}})$。初始状态向量为 $\\mathbf{Y}(x_{\\mathrm{ini}}) = [1, 1]^T$。\n\n实现将使用 `scipy.integrate.solve_ivp` 函数，该函数提供高阶自适应步长方法。为了达到 $\\varepsilon(a_{\\mathrm{end}})  10^{-6}$ 的要求精度，我们将使用高阶方法（例如 `DOP853`）和严格的绝对和相对容差，例如 $10^{-12}$。\n\n对于测试套件中的每个 $a_{\\mathrm{end}}$，我们从求解器计算数值解 $D_{\\mathrm{num}}(a_{\\mathrm{end}})$。然后通过计算相对误差，将其与解析解 $D_{\\mathrm{ana}}(a_{\\mathrm{end}}) = a_{\\mathrm{end}}/a_{\\mathrm{ini}}$ 进行比较：\n$$\n\\varepsilon(a_{\\mathrm{end}}) \\equiv \\frac{\\left| D_{\\mathrm{num}}(a_{\\mathrm{end}}) - D_{\\mathrm{ana}}(a_{\\mathrm{end}}) \\right|}{\\left| D_{\\mathrm{ana}}(a_{\\mathrm{end}}) \\right|}\n$$\n最终输出将是针对指定测试点的这些相对误差的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the numerical and analytical solutions\n    for the linear growth factor in an Einstein-de Sitter universe.\n    \"\"\"\n\n    # Define the first-order ODE system for the growth factor D(x).\n    # The state vector is Y = [D, dD/dx].\n    # The independent variable is x = ln(a).\n    def ode_system(x, Y):\n        \"\"\"\n        The ODE system is dY/dx = F(x, Y).\n        dD/dx = y1\n        d^2D/dx^2 = -0.5 * dD/dx + 1.5 * D\n        \"\"\"\n        D, D_prime = Y\n        D_double_prime = 1.5 * D - 0.5 * D_prime\n        return [D_prime, D_double_prime]\n\n    # Problem parameters\n    a_ini = 1.0e-8\n    test_cases = [1.0e-6, 1.0e-4, 1.0e-2, 1.0e-1, 1.0, 2.0]\n\n    # Convert scale factors to the logarithmic variable x = ln(a)\n    x_ini = np.log(a_ini)\n    \n    # Initial conditions at x_ini that isolate the growing mode, normalized\n    # such that D(a_ini) = 1.\n    # D(x_ini) = 1, D'(x_ini) = 1\n    y_ini = [1.0, 1.0]\n\n    # Set stringent tolerances for the ODE solver to ensure high accuracy.\n    # This is required to meet the error target of  1e-6.\n    rtol = 1.0e-12\n    atol = 1.0e-12\n\n    results = []\n    for a_end in test_cases:\n        x_end = np.log(a_end)\n\n        # The integration interval in terms of x\n        t_span = (x_ini, x_end)\n        \n        # We need the solution only at the final point x_end.\n        # Using t_eval=[x_end] is an efficient way to get this.\n        # 'DOP853' is a high-order method suitable for high-precision integration.\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=t_span,\n            y0=y_ini,\n            method='DOP853',\n            rtol=rtol,\n            atol=atol,\n            t_eval=[x_end]\n        )\n\n        # Extract the numerical result for D at a_end.\n        # sol.y has shape (number_of_states, number_of_t_eval_points).\n        # Here, it will be (2, 1), and we need the first state's value.\n        D_num = sol.y[0, 0]\n\n        #\n        # Calculate the analytic solution for comparison.\n        # The growing mode solution, normalized as D(a_ini)=1, is D_ana(a) = a / a_ini.\n        D_ana = a_end / a_ini\n\n        # Calculate the relative error as specified in the problem statement.\n        relative_error = np.abs(D_num - D_ana) / np.abs(D_ana)\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3498601"}, {"introduction": "随着扰动增长，线性理论失效，我们必须分析引力坍缩的完整非线性动力学过程。[@problem_id:3498610] 中的“顶帽”模型为此提供了一个优美的解析解，它描述了在一个简化宇宙中，物质从膨胀到“转折”并最终坍缩的完整轨迹。这项练习揭示了坍缩过程中的关键时间尺度，并展示了参数化方法在解决非线性问题时的威力。", "problem": "考虑一个嵌入在 Einstein–de Sitter (EdS) 宇宙中的球对称、无压的顶帽状过密区，其质量为固定的 $M$。EdS 宇宙定义为一个空间平坦、只含物质的 Friedmann–Lemaître–Robertson–Walker (FLRW) 宇宙学模型，其物质密度参数 $\\Omega_{m}=1$，宇宙学常数 $\\Omega_{\\Lambda}=0$。在球形塌缩模型中，该过密区的物理半径 $R(t)$ 遵循牛顿引力，其径向运动方程为 $d^{2}R/dt^{2}=-G M/R^{2}$。对于足够大的初始过密度，该方程存在束缚解。\n\n从牛顿引力的径向运动能量积分出发：\n$$\\frac{1}{2}\\,\\dot{R}^{2}-\\frac{G M}{R}=E,$$ \n其中常数比能 $E  0$，请证明其束缚轨道可以表示为类似摆线的参数解：\n$$R(\\theta)=a\\left(1-\\cos\\theta\\right),\\qquad t(\\theta)=\\sqrt{\\frac{a^{3}}{G M}}\\left(\\theta-\\sin\\theta\\right),$$\n其中 $a>0$ 是一个由能量 $E$ 和质量 $M$ 决定的常数，$G$ 是引力常数，时间原点的选择使得当 $\\theta=0$ 时 $t=0$。定义“转折时间” $t_{\\rm ta}$ 为 $dR/dt=0$ 的第一个时刻，定义“塌缩时间” $t_{\\rm coll}$ 为转折后 $R(t)$ 首次回到零半径的时刻。请计算比值 $t_{\\rm coll}/t_{\\rm ta}$，结果为一个实数。无需四舍五入，也无需单位，因为最终答案是无量纲的。", "solution": "该问题要求我们首先验证一个提出的用于描述球形过密区径向运动的参数解，然后计算其塌缩时间与转折时间之比。\n\n首先，我们验证该参数解是否满足给定的能量积分。题目给出了质量为 $M$、半径为 $R(t)$ 的过密区的径向运动能量积分：\n$$ \\frac{1}{2}\\dot{R}^{2} - \\frac{G M}{R} = E $$\n其中 $\\dot{R} = dR/dt$，$E  0$ 是束缚解的常数比能。\n\n提出的参数解由以下公式给出：\n$$ R(\\theta) = a(1 - \\cos\\theta) $$\n$$ t(\\theta) = \\sqrt{\\frac{a^{3}}{G M}}(\\theta - \\sin\\theta) $$\n其中 $a$ 是一个正常数。参数 $\\theta$ 随时间演化。\n\n为了验证此解，我们必须计算 $\\dot{R}$ 并将其与 $R(\\theta)$ 一起代入能量方程。我们使用链式法则求 $\\dot{R}$：\n$$ \\dot{R} = \\frac{dR}{dt} = \\frac{dR/d\\theta}{dt/d\\theta} $$\n首先，我们求 $R$ 和 $t$ 对 $\\theta$ 的导数：\n$$ \\frac{dR}{d\\theta} = \\frac{d}{d\\theta} \\left[a(1 - \\cos\\theta)\\right] = a\\sin\\theta $$\n$$ \\frac{dt}{d\\theta} = \\frac{d}{d\\theta} \\left[\\sqrt{\\frac{a^{3}}{G M}}(\\theta - \\sin\\theta)\\right] = \\sqrt{\\frac{a^{3}}{G M}}(1 - \\cos\\theta) $$\n现在，我们计算它们的比值来求 $\\dot{R}$：\n$$ \\dot{R} = \\frac{a\\sin\\theta}{\\sqrt{\\frac{a^{3}}{G M}}(1 - \\cos\\theta)} = \\frac{a}{\\sqrt{\\frac{a^{3}}{G M}}} \\frac{\\sin\\theta}{1 - \\cos\\theta} = \\sqrt{\\frac{G M}{a}} \\frac{\\sin\\theta}{1 - \\cos\\theta} $$\n使用半角三角恒等式 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$ 和 $1 - \\cos\\theta = 2\\sin^{2}(\\theta/2)$，$\\dot{R}$ 的表达式可以简化为：\n$$ \\dot{R} = \\sqrt{\\frac{G M}{a}} \\frac{2\\sin(\\theta/2)\\cos(\\theta/2)}{2\\sin^{2}(\\theta/2)} = \\sqrt{\\frac{G M}{a}} \\frac{\\cos(\\theta/2)}{\\sin(\\theta/2)} = \\sqrt{\\frac{G M}{a}} \\cot\\left(\\frac{\\theta}{2}\\right) $$\n接下来，我们将 $R(\\theta)$ 和这个 $\\dot{R}$ 的表达式代入能量积分：\n$$ \\frac{1}{2} \\left( \\sqrt{\\frac{G M}{a}} \\cot\\left(\\frac{\\theta}{2}\\right) \\right)^{2} - \\frac{G M}{a(1 - \\cos\\theta)} = E $$\n$$ \\frac{1}{2} \\frac{G M}{a} \\cot^{2}\\left(\\frac{\\theta}{2}\\right) - \\frac{G M}{a(2\\sin^{2}(\\theta/2))} = E $$\n将余切用正弦和余弦表示：\n$$ \\frac{G M}{2a} \\frac{\\cos^{2}(\\theta/2)}{\\sin^{2}(\\theta/2)} - \\frac{G M}{2a\\sin^{2}(\\theta/2)} = E $$\n$$ \\frac{G M}{2a\\sin^{2}(\\theta/2)} \\left( \\cos^{2}(\\frac{\\theta}{2}) - 1 \\right) = E $$\n使用恒等式 $\\cos^{2}(x) - 1 = -\\sin^{2}(x)$：\n$$ \\frac{G M}{2a\\sin^{2}(\\theta/2)} \\left( -\\sin^{2}(\\frac{\\theta}{2}) \\right) = E $$\n$$ -\\frac{G M}{2a} = E $$\n这个结果表明能量 $E$ 确实是常数，并且与参数 $\\theta$（以及时间 $t$）无关。常数 $a$ 由能量和质量决定，为 $a = -GM/(2E)$。由于对于束缚轨道 $E  0$，$a$ 是正数，这与题目陈述一致。这验证了给定的参数形式是运动方程的正确解。\n\n接下来，我们计算转折时间 $t_{\\rm ta}$。转折被定义为膨胀停止、速度变为零的第一个时刻，即 $\\dot{R}=0$。从我们得到的 $\\dot{R}$ 的表达式可知：\n$$ \\dot{R} = \\sqrt{\\frac{G M}{a}} \\cot\\left(\\frac{\\theta}{2}\\right) = 0 $$\n这要求 $\\cot(\\theta/2) = 0$。初始条件是当 $\\theta=0$ 时 $t=0$，这对应于 $R=0$。在 $\\theta \\in (0, \\pi)$ 期间，壳层膨胀，此时 $\\dot{R}>0$。在 $t=0$ 之后 $\\dot{R}=0$ 首次出现时，$\\theta/2 = \\pi/2$，因此 $\\theta_{\\rm ta} = \\pi$。\n转折时间 $t_{\\rm ta}$ 是对应于 $\\theta = \\pi$ 的时间：\n$$ t_{\\rm ta} = t(\\pi) = \\sqrt{\\frac{a^{3}}{G M}}(\\pi - \\sin\\pi) = \\sqrt{\\frac{a^{3}}{G M}}(\\pi - 0) = \\pi\\sqrt{\\frac{a^{3}}{G M}} $$\n在这个时刻，半径达到其最大值 $R_{\\rm ta} = R(\\pi) = a(1 - \\cos\\pi) = 2a$。\n\n最后，我们计算塌缩时间 $t_{\\rm coll}$。这被定义为转折后半径首次回到零的时刻。我们需要找到使 $R(\\theta) = 0$ 的 $\\theta$ 值，其中 $\\theta > \\theta_{\\rm ta} = \\pi$：\n$$ R(\\theta) = a(1 - \\cos\\theta) = 0 $$\n由于 $a>0$，这意味着 $1 - \\cos\\theta = 0$，或 $\\cos\\theta = 1$。解为 $\\theta = 2k\\pi$，其中 $k$ 为任意整数。初始状态在 $k=0$（$\\theta=0$）处。转折后（$\\theta=\\pi$）半径首次回到零的时刻对应于 $k=1$，所以 $\\theta_{\\rm coll} = 2\\pi$。\n塌缩时间 $t_{\\rm coll}$ 是对应于 $\\theta = 2\\pi$ 的时间：\n$$ t_{\\rm coll} = t(2\\pi) = \\sqrt{\\frac{a^{3}}{G M}}(2\\pi - \\sin(2\\pi)) = \\sqrt{\\frac{a^{3}}{G M}}(2\\pi - 0) = 2\\pi\\sqrt{\\frac{a^{3}}{G M}} $$\n\n题目要求计算比值 $t_{\\rm coll}/t_{\\rm ta}$：\n$$ \\frac{t_{\\rm coll}}{t_{\\rm ta}} = \\frac{2\\pi\\sqrt{\\frac{a^{3}}{G M}}}{\\pi\\sqrt{\\frac{a^{3}}{G M}}} = 2 $$\n这个比值恰好是 $2$。这表明过密区塌缩回一个点奇点所花费的时间是其膨胀到最大半径所花费时间的两倍。塌缩阶段的持续时间（$t_{\\rm coll} - t_{\\rm ta}$）等于膨胀阶段的持续时间（$t_{\\rm ta}$）。", "answer": "$$\\boxed{2}$$", "id": "3498610"}, {"introduction": "为了在我们的真实宇宙中精确地模拟结构形成，我们必须将球形坍缩模型推广到包含宇宙学常数的 $\\Lambda$CDM 宇宙学框架，并使用数值方法求解。这项高级练习 [@problem_id:3498600] 要求你推导在宇宙学常数存在下的完整运动方程，并构建一个稳健的数值求解器来追踪物质从初始扰动直到最终坍缩的演化。完成这项任务标志着你已全面掌握了现代宇宙学研究中的核心物理和计算技术。", "problem": "考虑一个嵌入在膨胀的弗里德曼-勒梅特-罗伯逊-沃克（Friedmann–Lemaître–Robertson–Walker）背景中的球对称顶帽（top-hat）超密度。设背景宇宙学由现今物质密度参数 $\\Omega_{\\mathrm{m}0}$、宇宙学常数密度参数 $\\Omega_{\\Lambda 0}$ 和哈勃参数 $H_{0}$ 来表征。设尺度因子为 $a$，并定义无量纲哈勃函数 $E(a) \\equiv H(a)/H_{0}$，其中\n$$\nE(a) = \\sqrt{\\Omega_{\\mathrm{m}0}\\,a^{-3} + \\Omega_{k0}\\,a^{-2} + \\Omega_{\\Lambda 0}}, \\quad \\Omega_{k0} \\equiv 1 - \\Omega_{\\mathrm{m}0} - \\Omega_{\\Lambda 0}.\n$$\n设初始尺度因子为 $a_{i}$，在 $a=a_{i}$ 时的初始顶帽超密度为 $\\delta_{i}$。用 $R(t)$ 表示顶帽的物理半径，并定义无量纲半径变量\n$$\ny(a) \\equiv \\frac{R(a)}{R(a_{i})},\n$$\n使得 $y(a_{i}) = 1$。顶帽内的质量是守恒的，$M = \\frac{4\\pi}{3} R^{3} \\rho_{\\mathrm{b}}(a) [1+\\delta(a)]$，其中背景物质密度为 $\\rho_{\\mathrm{b}}(a) = \\rho_{\\mathrm{c}0}\\,\\Omega_{\\mathrm{m}0}\\,a^{-3}$，临界密度为 $\\rho_{\\mathrm{c}0} = 3 H_{0}^{2}/(8\\pi G)$。球对称顶帽在包含宇宙学常数的牛顿运动方程下演化，\n$$\n\\ddot{R} = -\\frac{G M}{R^{2}} + \\frac{\\Lambda}{3} R, \\quad \\Lambda = 3 H_{0}^{2} \\Omega_{\\Lambda 0},\n$$\n其中上方的点表示对宇宙时间 $t$ 的导数。\n\n您的任务是：\n1. 推导一个关于 $y(a)$、以 $a$ 为自变量的二阶常微分方程，该方程应适合作为刚性系统进行数值积分。您必须从上述运动方程和链式法则 $d/dt = a H(a) d/da$ 出发，其中 $H(a) = H_{0} E(a)$。您的最终方程必须完全用 $a$、$y$、$\\Omega_{\\mathrm{m}0}$、$\\Omega_{\\Lambda 0}$、$a_{i}$、$\\delta_{i}$ 和常数来表示。除了适用于亚水平尺度球形坍缩的牛顿处理方法外，不要假设任何特定的规范。\n2. 使用物质主导极限下的线性增长模关系，即在足够小的 $a$ 处 $f(a) \\equiv d\\ln D/d\\ln a \\approx 1$，为 $y(a)$ 和 $dy/da$ 在 $a=a_i$ 处指定物理上一致的初始条件。您的初始条件必须明确地用 $a_i$ 和 $\\delta_i$ 给出。\n3. 设计一个带有事件检测功能的自适应步长积分器，用于检测：\n   - 回转（Turnaround），定义为条件 $dy/da = 0$（等效于 $\\dot{R} = 0$）。\n   - 坍缩（Collapse），定义为条件 $y(a) = y_{\\mathrm{thr}}$，其中 $y_{\\mathrm{thr}}$ 是一个预设的小阈值，代表实际坍缩（$y_{\\mathrm{thr}} \\ll 1$）。\n   该积分器必须对坍缩附近的刚性行为具有鲁棒性，并且必须在坍缩时或在达到最大尺度因子 $a_{\\max}$（如果两个事件都未发生）时终止。如果某个事件在 $a_{\\max}$ 之前没有发生，则为相应的量报告一个哨兵值 $-1.0$。\n4. 将上述内容实现为一个完整、可运行的程序，该程序：\n   - 使用带有自适应步长的隐式刚性求解器，对自变量为 $a$ 的系统进行积分。\n   - 实现回转和坍缩的事件检测。\n   - 对每个测试输入，返回一对浮点数 $\\big[a_{\\mathrm{ta}}, a_{\\mathrm{coll}}\\big]$，其中 $a_{\\mathrm{ta}}$ 是回转尺度因子，$a_{\\mathrm{coll}}$ 是坍缩尺度因子（使用阈值），如果到 $a_{\\max}$ 仍未达到，则为 $-1.0$。\n   - 所有量均使用无量纲单位。输出中不应出现物理单位。\n   - 如果适用，任何角度都使用弧度，尽管这里没有明确要求角度。\n\n使用以下系统形式进行数值积分。引入状态向量 $u(a) = \\big(y(a), v(a)\\big)$，其中 $v(a) \\equiv dy/da$。您的系统必须具有以下形式：\n$$\n\\frac{dy}{da} = v, \\quad \\frac{dv}{da} = F\\big(a, y, v; \\Omega_{\\mathrm{m}0}, \\Omega_{\\Lambda 0}, a_{i}, \\delta_{i}\\big),\n$$\n其中 $F$ 是从第一性原理推导出来的。\n\n在 $a=a_{i}$ 处的初始条件必须是\n$$\ny(a_{i}) = 1, \\quad \\left.\\frac{dy}{da}\\right|_{a=a_{i}} = \\frac{1}{a_{i}}\\left[1 - \\frac{1}{3}\\,\\delta_{i}\\right],\n$$\n这与物质主导极限下的线性增长模 $f(a_{i}) \\approx 1$ 一致。\n\n数值细节：\n- 使用带有事件检测的自适应刚性求解器。回转事件是 $v(a)=0$ 且方向为负，坍缩事件是 $y(a)-y_{\\mathrm{thr}}=0$ 且方向为负。\n- 使用 $y_{\\mathrm{thr}} = 10^{-3}$ 作为坍缩阈值。\n- 如果某个事件在 $a_{\\max}$ 之前没有发生，则为该量报告 $-1.0$。\n- 自变量 $a$ 是无量纲的，所有其他量也是无量纲的。输出中不需要物理单位。\n\n测试套件：\n- 情况 1：$\\Omega_{\\mathrm{m}0} = 1.0$，$\\Omega_{\\Lambda 0} = 0.0$，$\\delta_{i} = 0.01$，$a_{i} = 10^{-3}$，$a_{\\max} = 1.0$。\n- 情况 2：$\\Omega_{\\mathrm{m}0} = 0.3$，$\\Omega_{\\Lambda 0} = 0.7$，$\\delta_{i} = 0.005$，$a_{i} = 10^{-3}$，$a_{\\max} = 3.0$。\n- 情况 3：$\\Omega_{\\mathrm{m}0} = 0.2$，$\\Omega_{\\Lambda 0} = 0.0$，$\\delta_{i} = 0.001$，$a_{i} = 10^{-3}$，$a_{\\max} = 10.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个情况的结果，格式为一个由方括号括起来的列表组成的逗号分隔列表，例如\n\"[ [a_ta1,a_coll1],[a_ta2,a_coll2],[a_ta3,a_coll3] ]\"，\n其中每个 $a_{\\mathrm{ta}}$ 和 $a_{\\mathrm{coll}}$ 都是一个浮点数，任何未发生的事件都用 $-1.0$ 标记。", "solution": "用户提供了一个来自物理宇宙学领域的适定问题，具体涉及球形坍缩模型的数值解。问题陈述在科学上是成立的、自洽的且内部一致的。为获得唯一解所需的所有参数和初始条件都已提供。我们将继续进行推导和数值实现。\n\n解决方案的结构如下：\n1. 推导关于尺度因子 $a$ 的无量纲半径 $y(a)$ 的二阶常微分方程（ODE）。\n2. 构建初值问题，包括一阶ODE系统和指定的初始条件。\n3. 描述数值积分策略，包括求解器的选择和回转与坍缩事件检测的实现。\n\n### 1. 运动方程的推导\n\n出发点是球对称顶帽物理半径 $R(t)$ 的牛顿运动方程，其中包含了宇宙学常数 $\\Lambda$ 的效应：\n$$\n\\ddot{R} = -\\frac{G M}{R^{2}} + \\frac{\\Lambda}{3} R\n$$\n其中上方的点表示对宇宙时间 $t$ 的导数，$G$ 是引力常数，$M$ 是半径 $R$ 内包含的质量，该质量是守恒的。\n\n质量 $M$ 可以用尺度因子为 $a_i$ 时的初始条件来表示。壳层内的密度为 $\\rho(a_i) = \\rho_{\\mathrm{b}}(a_i) (1+\\delta_i)$，其中 $\\rho_{\\mathrm{b}}(a)$ 是背景物质密度，$\\delta_i$ 是初始超密度。\n$$\nM = \\frac{4\\pi}{3} R(a_i)^3 \\rho_{\\mathrm{b}}(a_i) (1+\\delta_i)\n$$\n使用定义 $\\rho_{\\mathrm{b}}(a) = \\rho_{\\mathrm{c}0}\\,\\Omega_{\\mathrm{m}0}\\,a^{-3}$ 和 $\\rho_{\\mathrm{c}0} = 3 H_{0}^{2}/(8\\pi G)$，我们可以将质量写为：\n$$\nM = \\frac{4\\pi}{3} R(a_i)^3 \\left( \\frac{3 H_0^2}{8\\pi G} \\Omega_{\\mathrm{m}0} a_i^{-3} \\right) (1+\\delta_i) = \\frac{H_0^2 \\Omega_{\\mathrm{m}0} (1+\\delta_i) R(a_i)^3}{2 G a_i^3}\n$$\n宇宙学常数由 $\\Lambda = 3 H_{0}^{2} \\Omega_{\\Lambda 0}$ 给出。将 $M$ 和 $\\Lambda$ 的表达式代入运动方程得到：\n$$\n\\ddot{R} = -\\frac{G}{R^2} \\left( \\frac{H_0^2 \\Omega_{\\mathrm{m}0} (1+\\delta_i) R(a_i)^3}{2 G a_i^3} \\right) + \\frac{3 H_0^2 \\Omega_{\\Lambda 0}}{3} R\n$$\n$$\n\\ddot{R} = -\\frac{H_0^2 \\Omega_{\\mathrm{m}0} (1+\\delta_i)}{2 a_i^3} \\frac{R(a_i)^3}{R^2} + H_0^2 \\Omega_{\\Lambda 0} R\n$$\n我们引入无量纲半径 $y(a) \\equiv R(a)/R(a_i)$，这意味着 $R(a) = R(a_i) y(a)$。对时间求导得到 $\\ddot{R} = R(a_i) \\ddot{y}$。将其代入方程并除以 $R(a_i)$，得到关于 $y$ 的方程：\n$$\n\\ddot{y} = -\\frac{H_0^2 \\Omega_{\\mathrm{m}0} (1+\\delta_i)}{2 a_i^3 y^2} + H_0^2 \\Omega_{\\Lambda 0} y\n$$\n接下来，我们将自变量从宇宙时间 $t$ 更改为尺度因子 $a$。时间导数的链式法则是 $\\frac{d}{dt} = \\frac{da}{dt} \\frac{d}{da} = \\dot{a} \\frac{d}{da}$。由于 $H = \\dot{a}/a$，我们有 $\\dot{a} = a H(a) = a H_0 E(a)$。因此，$\\frac{d}{dt} = a H_0 E(a) \\frac{d}{da}$。\n$y$ 的一阶导数是：\n$$\n\\dot{y} = \\frac{dy}{dt} = a H_0 E(a) \\frac{dy}{da}\n$$\n二阶导数是：\n$$\n\\ddot{y} = \\frac{d\\dot{y}}{dt} = a H_0 E(a) \\frac{d}{da} \\left( a H_0 E(a) \\frac{dy}{da} \\right)\n$$\n$$\n\\ddot{y} = a H_0^2 E(a) \\left[ \\frac{d(a E(a))}{da} \\frac{dy}{da} + a E(a) \\frac{d^2y}{da^2} \\right]\n$$\n$$\n\\ddot{y} = a H_0^2 E(a) \\left[ \\left(E(a) + a \\frac{dE}{da}\\right) \\frac{dy}{da} + a E(a) \\frac{d^2y}{da^2} \\right]\n$$\n将两个 $\\ddot{y}$ 的表达式相等并消去 $H_0^2$：\n$$\na E(a) \\left[ \\left(E(a) + a \\frac{dE}{da}\\right) \\frac{dy}{da} + a E(a) \\frac{d^2y}{da^2} \\right] = -\\frac{\\Omega_{\\mathrm{m}0} (1+\\delta_i)}{2 a_i^3 y^2} + \\Omega_{\\Lambda 0} y\n$$\n现在我们求解 $\\frac{d^2y}{da^2}$。令 $v(a) \\equiv \\frac{dy}{da}$。\n$$\na^2 E(a)^2 \\frac{d^2y}{da^2} = -a E(a) \\left(E(a) + a \\frac{dE}{da}\\right) v + \\Omega_{\\Lambda 0} y - \\frac{\\Omega_{\\mathrm{m}0} (1+\\delta_i)}{2 a_i^3 y^2}\n$$\n为了简化 $v$ 的系数，我们计算项 $a \\frac{d(a E^2)}{da} / 2 = a(E^2 + a \\cdot 2 E \\frac{dE}{da})/2 = aE^2 + a^2 E \\frac{dE}{da}$。\n由 $E(a)^2 = \\Omega_{\\mathrm{m}0} a^{-3} + \\Omega_{k0} a^{-2} + \\Omega_{\\Lambda 0}$，我们有：\n$$\na E(a)^2 = \\Omega_{\\mathrm{m}0} a^{-2} + \\Omega_{k0} a^{-1} + \\Omega_{\\Lambda 0} a\n$$\n且 $2 E \\frac{dE}{da} = -3 \\Omega_{\\mathrm{m}0} a^{-4} - 2 \\Omega_{k0} a^{-3}$，这给出 $a^2 E \\frac{dE}{da} = \\frac{a^2}{2}(-3 \\Omega_{\\mathrm{m}0} a^{-4} - 2 \\Omega_{k0} a^{-3}) = -\\frac{3}{2}\\Omega_{\\mathrm{m}0}a^{-2} - \\Omega_{k0}a^{-1}$。\n$v$ 的系数涉及以下和：\n$$\n-\\left( a E(a)^2 + a^2 E \\frac{dE}{da} \\right) = - \\left( (\\Omega_{\\mathrm{m}0} a^{-2} - \\frac{3}{2}\\Omega_{\\mathrm{m}0}a^{-2}) + (\\Omega_{k0} a^{-1} - \\Omega_{k0}a^{-1}) + \\Omega_{\\Lambda 0} a \\right) = \\frac{1}{2}\\Omega_{\\mathrm{m}0}a^{-2} - \\Omega_{\\Lambda 0}a\n$$\n将此代回，我们得到 $\\frac{d^2y}{da^2}$ 的方程：\n$$\n\\frac{d^2y}{da^2} = \\frac{1}{a^2 E(a)^2} \\left[ \\left( \\frac{1}{2}\\Omega_{\\mathrm{m}0}a^{-2} - \\Omega_{\\Lambda 0}a \\right)v + \\Omega_{\\Lambda 0} y - \\frac{\\Omega_{\\mathrm{m}0}(1+\\delta_i)}{2 a_i^3 y^2} \\right]\n$$\n这是所需的 $y(a)$ 的二阶ODE。\n\n### 2. 初值问题构建\n\n为了进行数值求解，我们将这个二阶ODE转换成一个由两个一阶ODE组成的系统。设状态向量为 $u(a) = \\begin{pmatrix} y(a) \\\\ v(a) \\end{pmatrix}$，其中 $v(a) = \\frac{dy}{da}$。该系统为：\n$$\n\\frac{du}{da} = \n\\begin{pmatrix} \\frac{dy}{da} \\\\ \\frac{dv}{da} \\end{pmatrix}\n=\n\\begin{pmatrix} v \\\\ F(a, y, v) \\end{pmatrix}\n$$\n其中\n$$\nF(a, y, v) = \\frac{1}{a^2 E(a)^2} \\left[ \\left( \\frac{1}{2}\\Omega_{\\mathrm{m}0}a^{-2} - \\Omega_{\\Lambda 0}a \\right)v + \\Omega_{\\Lambda 0} y - \\frac{\\Omega_{\\mathrm{m}0}(1+\\delta_i)}{2 a_i^3 y^2} \\right]\n$$\n且 $E(a)^2 = \\Omega_{\\mathrm{m}0}a^{-3} + (1-\\Omega_{\\mathrm{m}0}-\\Omega_{\\Lambda 0})a^{-2} + \\Omega_{\\Lambda 0}$。\n\n问题指定了在 $a=a_i$ 处的初始条件。这些条件与物质主导极限下的线性增长模（$f(a_i) \\approx 1$）一致：\n- $y(a_i) = 1$\n- $v(a_i) = \\left.\\frac{dy}{da}\\right|_{a=a_i} = \\frac{1}{a_i} \\left[ 1 - \\frac{1}{3} \\delta_i \\right]$\n因此，初始状态向量为 $u(a_i) = \\left( 1, \\frac{1}{a_i} [1 - \\frac{1}{3}\\delta_i] \\right)$。\n\n### 3. 数值积分策略\n\n该ODE系统表现出刚性行为，特别是在坍缩附近（$y \\to 0$），此时与 $1/y^2$ 成正比的项导致导数变得非常大。为了进行鲁棒而高效的求解，需要一个带有自适应步长的隐式求解器。我们将使用 `scipy.integrate.solve_ivp` 中的 `Radau` 方法，该方法专为刚性问题设计。\n\n问题要求在积分过程中检测两个特定事件：\n1.  **回转**：发生在壳层达到其最大半径并开始收缩时。这对应于物理速度 $\\dot{R}$ 从正变负。由于 $\\dot{y} = a H_0 E(a) v(a)$，且 $a$ 和 $E(a)$ 均为正，这等效于 $v(a) = \\frac{dy}{da}$ 从正值穿过零变为负值。事件函数是 $v(a) = 0$，我们寻找函数递减（方向 = -1）的根。此事件是非终止性的。\n2.  **坍缩**：定义为无量纲半径 $y(a)$ 收缩到一个小的阈值 $y_{\\mathrm{thr}} = 10^{-3}$ 的点。事件函数是 $y(a) - y_{\\mathrm{thr}} = 0$。由于壳层正在坍缩，$y(a)$ 是递减的，因此我们寻找函数递减（方向 = -1）的根。此事件是终止性的，会停止积分。\n\n每个测试用例的积分将从 $a=a_i$ 进行到最大尺度因子 $a_{\\max}$。任何检测到的事件的时间（尺度因子）都会被记录下来。如果某个事件在 $a_{\\max}$ 之前未被检测到，其对应的尺度因子将报告为 $-1.0$。\n\n该实现将这些组件组合成一个单一的函数，该函数遍历所提供的测试用例，为每个用例求解初值问题，提取回转和坍缩的尺度因子，并按指定格式输出结果。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the spherical collapse model ODE for given cosmological parameters.\n    \"\"\"\n\n    test_cases = [\n        # (Omega_m0, Omega_L0, delta_i, a_i, a_max)\n        (1.0, 0.0, 0.01, 1e-3, 1.0),\n        (0.3, 0.7, 0.005, 1e-3, 3.0),\n        (0.2, 0.0, 0.001, 1e-3, 10.0),\n    ]\n\n    y_thr = 1e-3\n    results = []\n\n    for params in test_cases:\n        Omega_m0, Omega_L0, delta_i, a_i, a_max = params\n        Omega_k0 = 1.0 - Omega_m0 - Omega_L0\n\n        def spherical_collapse_ode(a, u, p):\n            \"\"\"\n            Defines the system of ODEs for the spherical collapse model.\n            u = [y, v] where y is the dimensionless radius and v = dy/da.\n            p = [Omega_m0, Omega_L0, Omega_k0, delta_i, a_i]\n            \"\"\"\n            y, v = u\n            Omega_m0_p, Omega_L0_p, Omega_k0_p, delta_i_p, a_i_p = p\n            \n            # Avoid division by zero if y is non-positive, though the solver\n            # and collapse event should prevent this.\n            if y = 0:\n                # Return large derivatives to signify a problematic state\n                return [v, -1e100]\n\n            # E(a)^2 = H(a)^2 / H0^2\n            E_sq = Omega_m0_p * a**-3 + Omega_k0_p * a**-2 + Omega_L0_p\n\n            # dv/da = F(a, y, v)\n            # F = (1/(a^2 E^2)) * [ term_v * v + term_y * y + term_const ]\n            \n            # Coefficient of v in the numerator of dv/da\n            v_coeff = 0.5 * Omega_m0_p * a**-2 - Omega_L0_p * a\n            \n            # term with y\n            y_term = Omega_L0_p * y\n\n            # term independent of v and y (inside the bracket)\n            const_term = -0.5 * Omega_m0_p * (1.0 + delta_i_p) / (a_i_p**3 * y**2)\n\n            dv_da = (v_coeff * v + y_term + const_term) / (a**2 * E_sq)\n            \n            return [v, dv_da]\n\n        # Initial conditions\n        y0 = 1.0\n        v0 = (1.0 / a_i) * (1.0 - (1.0 / 3.0) * delta_i)\n        u0 = [y0, v0]\n\n        # Event: Turnaround (dy/da = v = 0)\n        def turnaround(a, u, p):\n            return u[1]\n        turnaround.terminal = False\n        turnaround.direction = -1  # Event triggers when v goes from positive to negative\n\n        # Event: Collapse (y = y_thr)\n        def collapse(a, u, p):\n            return u[0] - y_thr\n        collapse.terminal = True\n        collapse.direction = -1   # Event triggers when y decreases through y_thr\n\n        # Integration span\n        t_span = (a_i, a_max)\n\n        # Solve the ODE\n        sol = solve_ivp(\n            fun=spherical_collapse_ode,\n            t_span=t_span,\n            y0=u0,\n            method='Radau',\n            args=([Omega_m0, Omega_L0, Omega_k0, delta_i, a_i],),\n            events=[turnaround, collapse],\n            dense_output=True,\n            atol=1e-9,  # Absolute tolerance\n            rtol=1e-9,  # Relative tolerance\n        )\n        \n        # Extract results\n        a_ta = -1.0\n        if sol.t_events[0].size > 0:\n            a_ta = sol.t_events[0][0]\n\n        a_coll = -1.0\n        if sol.t_events[1].size > 0:\n            a_coll = sol.t_events[1][0]\n        # In case the terminal event didn't trigger correctly but integration stopped\n        elif sol.status == 1 and sol.y[0, -1] = y_thr:\n            a_coll = sol.t[-1]\n\n        results.append([a_ta, a_coll])\n\n    # Format the final output string\n    str_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(str_results)}]\")\n\n\nsolve()\n```", "id": "3498600"}]}