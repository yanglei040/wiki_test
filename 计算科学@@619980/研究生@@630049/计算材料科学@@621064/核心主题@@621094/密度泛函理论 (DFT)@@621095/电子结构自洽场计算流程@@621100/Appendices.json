{"hands_on_practices": [{"introduction": "自洽场（SCF）方法的核心是一个迭代过程，旨在找到一个固定的解。本练习将演示其中最基本的一步：如何从给定的轨道和占据数构建输出密度，并将其与输入密度进行“混合”以准备下一次迭代。通过这个练习，你将具体理解密度混合的概念及其在稳定SCF收敛中的作用 [@problem_id:3486399]。", "problem": "考虑一个在密度泛函理论 (DFT) 的 Kohn–Sham 表述下的一维无相互作用电子模型，其中单体电子密度由一组正交归一的单粒子轨道及其占据数得到。设正交归一轨道为质量为 $m$、角频率为 $\\omega$ 的一维量子谐振子的前两个本征函数，采用标准归一化约定：\n$$\n\\psi_{0}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\exp\\!\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right), \\quad \\psi_{1}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\sqrt{2}\\,\\sqrt{\\frac{m \\omega}{\\hbar}}\\, x \\exp\\!\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right).\n$$\n假设占据数为 $f_{0} = 1$ 和 $f_{1} = \\frac{1}{2}$，并且进入自洽场 (SCF) 过程的输入密度是一个归一化的高斯函数，其选择使得积分后得到的总电子数与 $N = f_{0} + f_{1}$ 相同：\n$$\n\\rho_{\\text{in}}(x) = N \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}), \\quad b>0,\n$$\n其中 $N = f_{0} + f_{1}$，$\\hbar$ 是约化普朗克常数。\n\n仅使用 Kohn-Sham 表述中单体密度的标准定义以及正交归一轨道的 Slater 行列式构造方法，计算与集合 $\\{\\psi_{i}\\}$ 和 $\\{f_{i}\\}$ 相关联的输出密度 $\\rho_{\\text{out}}(x)$。然后，解释在不动点迭代中进行密度混合的原理，并使用线性混合方法（混合参数为 $\\alpha \\in (0,1)$）构建下一步迭代的混合密度 $\\rho_{\\text{next}}(x)$。以 $\\rho_{\\text{out}}(x)$ 和 $\\rho_{\\text{next}}(x)$ 的闭式解析表达式的形式给出你的最终结果。\n\n将你的最终答案表示为变量为 $x$，参数为 $m$、$\\omega$、$\\hbar$、$b$ 和 $\\alpha$ 的解析函数。无需进行数值舍入。如果给出多个表达式，请将它们写成一个单行矩阵。最终答案框中无需报告物理单位。", "solution": "该问题已经过验证，被认为是具有科学依据、提法得当且客观的。这是计算电子结构理论中的一个标准理论练习。所有必要的数据和定义均已提供，问题没有矛盾或含糊不清之处。\n\n在 Kohn-Sham 表述中，单体电子密度 $\\rho(x)$ 是根据单粒子轨道集 $\\{\\psi_i(x)\\}$ 及其对应的占据数 $\\{f_i\\}$，通过以下公式构建的：\n$$\n\\rho(x) = \\sum_{i} f_{i} |\\psi_{i}(x)|^{2}\n$$\n\n首先，我们使用给定的轨道 $\\psi_{0}(x)$ 和 $\\psi_{1}(x)$ 以及占据数 $f_{0}=1$ 和 $f_{1}=\\frac{1}{2}$ 来计算输出密度 $\\rho_{\\text{out}}(x)$。\n\n给定的正交归一轨道是：\n$$\n\\psi_{0}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right)\n$$\n$$\n\\psi_{1}(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{\\frac{1}{4}} \\sqrt{2}\\,\\sqrt{\\frac{m \\omega}{\\hbar}}\\, x \\exp\\left(-\\frac{m \\omega}{2 \\hbar} x^{2}\\right)\n$$\n为简化符号，我们定义参数 $\\gamma = \\frac{m \\omega}{\\hbar}$。轨道可以写作：\n$$\n\\psi_{0}(x) = \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right)\n$$\n$$\n\\psi_{1}(x) = \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\sqrt{2\\gamma}\\, x \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right)\n$$\n接下来，我们计算这些轨道模的平方：\n$$\n|\\psi_{0}(x)|^{2} = \\left[ \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right) \\right]^2 = \\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2})\n$$\n$$\n|\\psi_{1}(x)|^{2} = \\left[ \\left(\\frac{\\gamma}{\\pi}\\right)^{\\frac{1}{4}} \\sqrt{2\\gamma}\\, x \\exp\\left(-\\frac{\\gamma}{2} x^{2}\\right) \\right]^2 = \\sqrt{\\frac{\\gamma}{\\pi}} (2\\gamma x^{2}) \\exp(-\\gamma x^{2})\n$$\n现在，我们可以使用占据数 $f_{0}=1$ 和 $f_{1}=\\frac{1}{2}$ 来构建输出密度 $\\rho_{\\text{out}}(x)$：\n$$\n\\rho_{\\text{out}}(x) = f_{0} |\\psi_{0}(x)|^{2} + f_{1} |\\psi_{1}(x)|^{2}\n$$\n$$\n\\rho_{\\text{out}}(x) = (1) \\left(\\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2})\\right) + \\left(\\frac{1}{2}\\right) \\left(\\sqrt{\\frac{\\gamma}{\\pi}} (2\\gamma x^{2}) \\exp(-\\gamma x^{2})\\right)\n$$\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{\\gamma}{\\pi}} \\exp(-\\gamma x^{2}) + \\sqrt{\\frac{\\gamma}{\\pi}} \\gamma x^{2} \\exp(-\\gamma x^{2})\n$$\n提出公因子，我们得到：\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{\\gamma}{\\pi}} (1 + \\gamma x^{2}) \\exp(-\\gamma x^{2})\n$$\n将 $\\gamma = \\frac{m \\omega}{\\hbar}$ 代回，输出密度的最终表达式为：\n$$\n\\rho_{\\text{out}}(x) = \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right)\n$$\n该密度的总电子数为 $\\int_{-\\infty}^{\\infty} \\rho_{\\text{out}}(x) dx = f_{0} \\int |\\psi_{0}|^2 dx + f_{1} \\int |\\psi_{1}|^2 dx = f_{0}(1) + f_{1}(1) = 1 + \\frac{1}{2} = \\frac{3}{2}$，这与定义 $N = f_{0} + f_{1}$ 一致。\n\n接下来，我们讨论密度混合的原理。自洽场 (SCF) 过程是一个迭代过程，旨在寻找一个映射 $\\mathcal{F}$ 的不动点，其中 $\\rho_{\\text{out}} = \\mathcal{F}(\\rho_{\\text{in}})$。简单的不动点迭代使用第 $k$ 步的全部输出来更新第 $k+1$ 步的密度：$\\rho_{k+1} = \\rho_{\\text{out},k}$。这个过程通常不稳定且无法收敛。输出密度可能会对输入密度中的误差进行过度修正，导致在连续迭代之间出现大的、无阻尼的振荡（通常称为“电荷振荡”）。密度混合是一种数值技术，用于抑制这些振荡并稳定收敛过程。在线性混合中，下一次迭代的密度由当前迭代的输入密度和输出密度线性组合而成：\n$$\n\\rho_{\\text{next}}(x) = (1-\\alpha) \\rho_{\\text{in}}(x) + \\alpha \\rho_{\\text{out}}(x)\n$$\n混合参数 $\\alpha \\in (0,1)$ 控制步长。一个较小的 $\\alpha$ 值确保密度被谨慎地更新，这可以减弱振荡并提高达到自洽解的可能性，尽管可能会以较慢的收敛速度为代价。\n\n最后，我们使用给定的输入密度 $\\rho_{\\text{in}}(x)$、计算出的输出密度 $\\rho_{\\text{out}}(x)$ 和混合参数 $\\alpha$ 来计算混合密度 $\\rho_{\\text{next}}(x)$。\n总电子数是 $N = f_0 + f_1 = 1 + \\frac{1}{2} = \\frac{3}{2}$。输入密度为：\n$$\n\\rho_{\\text{in}}(x) = N \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) = \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2})\n$$\n使用线性混合公式，我们组合 $\\rho_{\\text{in}}(x)$ 和 $\\rho_{\\text{out}}(x)$：\n$$\n\\rho_{\\text{next}}(x) = (1-\\alpha) \\left( \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) \\right) + \\alpha \\left( \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) \\right)\n$$\n这个表达式代表了将用作后续 SCF 迭代输入的电子密度。由于指数项中的系数不同（即 $-b x^2$ 和 $-\\frac{m \\omega}{\\hbar} x^2$），这两项无法进一步简化。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) & (1-\\alpha) \\frac{3}{2} \\sqrt{\\frac{b}{\\pi}} \\exp(-b x^{2}) + \\alpha \\sqrt{\\frac{m \\omega}{\\pi \\hbar}} \\left(1 + \\frac{m \\omega}{\\hbar} x^{2}\\right) \\exp\\left(-\\frac{m \\omega}{\\hbar} x^{2}\\right) \\end{pmatrix}}\n$$", "id": "3486399"}, {"introduction": "在学习了如何混合密度之后，一个关键问题随之而来：迭代过程一定会收敛吗？本练习使用一个简化的Thomas-Fermi模型进行线性稳定性分析，揭示了系统的物理特性（如屏蔽效应）如何转化为收敛的数学条件。它让你从量化的角度理解为何简单的混合可能会发散，以及混合参数 $\\alpha$ 如何控制迭代的稳定性 [@problem_id:3486412]。", "problem": "考虑一个一维的托马斯-费米模型，该模型在零温下描述了周期性区域上自旋简并的电子气。坐标为 $x$，并采用哈特里原子单位制。全局化学势 $\\mu$ 在空间上是恒定的，局域的托马斯-费米关系为 $\\mu = v_{\\mathrm{eff}}(x) + \\frac{\\pi^{2}}{2}\\,\\rho(x)^{2}$，其中 $\\rho(x)$ 是电子密度，$v_{\\mathrm{eff}}(x)$ 是有效静电势。假设局域屏蔽的静电学由亥姆霍兹方程 $\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)v_{\\mathrm{eff}}(x) = \\gamma\\,\\rho(x)$ 描述，并具有周期性边界条件，其中 $\\kappa > 0$ 是屏蔽长度的倒数，$\\gamma > 0$ 是耦合常数。取 $\\kappa = 2.0$ 和 $\\gamma = 1.0$。设参考态为均匀密度 $\\rho_{0} = 0.4$，它满足均匀托马斯-费米条件，带有一个恒定的势偏置 $v_{\\mathrm{eff},0}$，即 $\\mu = v_{\\mathrm{eff},0} + \\frac{\\pi^{2}}{2}\\,\\rho_{0}^{2}$，其中 $v_{\\mathrm{eff},0} = \\gamma \\rho_{0}/\\kappa^{2}$。考虑一个试探输入密度 $\\rho_{\\mathrm{in}}(x) = \\rho_{0} + A\\cos(qx)$，其中 $A$ 足够小以保证线性化的合理性，波数 $q = 1.0$。通过亥姆霍兹方程构造 $v_{\\mathrm{eff}}[\\rho_{\\mathrm{in}}]$，然后在固定的 $\\mu$ 下通过托马斯-费米关系更新 $\\rho_{\\mathrm{out}}(x)$，来定义自洽场（SCF）不动点映射 $F$。\n\n仅使用振幅 $A$ 的一阶（线性）响应：\n1) 计算 $F(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x)$ 的显式形式，保留到 $A$ 的线性项，并用 $\\rho_{0}$、$q$、$\\kappa$、$\\gamma$ 和 $\\pi$ 表示输出密度的余弦振幅。\n2) 计算残差 $R(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x) - \\rho_{\\mathrm{in}}(x)$ 到相同阶数，并确定其余弦振幅。\n3) 考虑一个线性混合更新 $\\rho^{(\\mathrm{new})}(x) = (1-\\alpha)\\rho^{(\\mathrm{old})}(x) + \\alpha\\,F(\\rho^{(\\mathrm{old})})(x)$，其中混合参数 $\\alpha \\in (0,2)$。确定允许的最大值 $\\alpha_{\\max}$，使得波数为 $q$ 的余弦模式在迭代下线性收敛。将最终的数值 $\\alpha_{\\max}$ 四舍五入到四位有效数字。最终答案应为一个无量纲的单一数字。", "solution": "首先验证问题以确保其科学上合理、良定且自洽。该问题描述了用于一维托马斯-费米模型的自洽场（SCF）过程。这是计算材料科学中一个标准的、尽管是简化的框架。所有给出的方程，如托马斯-费米关系和势的屏蔽亥姆霍兹方程，都是在此背景下的标准表示。参数定义明确，任务——对SCF循环进行线性响应分析——是该领域的经典练习。因此，该问题被认为是有效的，值得进行完整解答。\n\n解答按问题陈述的要求分为三个部分进行。\n\n首先，我们对于给定的输入密度 $\\rho_{\\mathrm{in}}(x)$，确定输出密度 $\\rho_{\\mathrm{out}}(x)$。\n输入密度是围绕均匀参考态 $\\rho_0$ 的一个小微扰：\n$$\n\\rho_{\\mathrm{in}}(x) = \\rho_{0} + A\\cos(qx)\n$$\n我们将微扰表示为 $\\delta\\rho_{\\mathrm{in}}(x) = A\\cos(qx)$。\nSCF映射 $F$ 包括两个步骤。第一步是通过求解亥姆霍兹方程来计算有效势 $v_{\\mathrm{eff}}(x)$：\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)v_{\\mathrm{eff}}(x) = \\gamma\\,\\rho_{\\mathrm{in}}(x)\n$$\n我们将势表示为参考势 $v_{\\mathrm{eff},0}$ 和一个微扰 $\\delta v_{\\mathrm{eff}}(x)$ 的和：$v_{\\mathrm{eff}}(x) = v_{\\mathrm{eff},0} + \\delta v_{\\mathrm{eff}}(x)$。参考态满足 $\\kappa^{2}v_{\\mathrm{eff},0} = \\gamma\\rho_0$。将微扰形式代入亥姆霍兹方程得到：\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)(v_{\\mathrm{eff},0} + \\delta v_{\\mathrm{eff}}(x)) = \\gamma(\\rho_{0} + A\\cos(qx))\n$$\n零阶项 $\\kappa^{2}v_{\\mathrm{eff},0} = \\gamma\\rho_0$ 相互抵消，留下一个关于微扰的方程：\n$$\n\\left(-\\frac{d^{2}}{dx^{2}} + \\kappa^{2}\\right)\\delta v_{\\mathrm{eff}}(x) = \\gamma A\\cos(qx)\n$$\n我们寻找形式为 $\\delta v_{\\mathrm{eff}}(x) = v_1 \\cos(qx)$ 的解。代入这个拟设得到：\n$$\nq^{2}v_1\\cos(qx) + \\kappa^{2}v_1\\cos(qx) = \\gamma A\\cos(qx)\n$$\n求解振幅 $v_1$ 得到：\n$$\nv_1 = \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\n$$\n所以，有效势为 $v_{\\mathrm{eff}}(x) = v_{\\mathrm{eff},0} + \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\\cos(qx)$。\n\n第二步是在固定的化学势 $\\mu$ 下，使用托马斯-费米关系计算输出密度 $\\rho_{\\mathrm{out}}(x)$：\n$$\n\\rho_{\\mathrm{out}}(x) = \\sqrt{\\frac{2}{\\pi^{2}}(\\mu - v_{\\mathrm{eff}}(x))}\n$$\n使用参考态条件 $\\mu - v_{\\mathrm{eff},0} = \\frac{\\pi^{2}}{2}\\rho_{0}^{2}$，我们代入 $\\mu$ 和 $v_{\\mathrm{eff}}(x)$：\n$$\n\\rho_{\\mathrm{out}}(x) = \\sqrt{\\frac{2}{\\pi^{2}}\\left(\\frac{\\pi^{2}}{2}\\rho_{0}^{2} - \\frac{\\gamma A}{q^{2} + \\kappa^{2}}\\cos(qx)\\right)} = \\sqrt{\\rho_{0}^{2} - \\frac{2\\gamma A}{\\pi^{2}(q^{2} + \\kappa^{2})}\\cos(qx)}\n$$\n$$\n\\rho_{\\mathrm{out}}(x) = \\rho_{0}\\sqrt{1 - \\frac{2\\gamma A}{\\pi^{2}\\rho_{0}^{2}(q^{2} + \\kappa^{2})}\\cos(qx)}\n$$\n由于 $A$ 很小，我们使用泰勒展开 $\\sqrt{1 - u} \\approx 1 - \\frac{u}{2}$ 进行线性化：\n$$\n\\rho_{\\mathrm{out}}(x) \\approx \\rho_{0}\\left(1 - \\frac{1}{2} \\frac{2\\gamma A}{\\pi^{2}\\rho_{0}^{2}(q^{2} + \\kappa^{2})}\\cos(qx)\\right) = \\rho_{0} - \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\cos(qx)\n$$\n这是一阶 $A$ 精度下 $F(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x)$ 的显式形式。输出密度的余弦振幅是 $-\\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}$。\n\n第二，我们计算残差 $R(\\rho_{\\mathrm{in}})(x) = \\rho_{\\mathrm{out}}(x) - \\rho_{\\mathrm{in}}(x)$：\n$$\nR(\\rho_{\\mathrm{in}})(x) = \\left(\\rho_{0} - \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\cos(qx)\\right) - (\\rho_{0} + A\\cos(qx))\n$$\n$$\nR(\\rho_{\\mathrm{in}})(x) = \\left(- \\frac{\\gamma A}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})} - A \\right)\\cos(qx) = -A\\left(1 + \\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\right)\\cos(qx)\n$$\n残差的余弦振幅是 $-A\\left(1 + \\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\\right)$。\n\n第三，我们分析线性混合方案的收敛性以找到 $\\alpha_{\\max}$。更新规则是：\n$$\n\\rho^{(\\mathrm{new})}(x) = (1-\\alpha)\\rho^{(\\mathrm{old})}(x) + \\alpha\\,F(\\rho^{(\\mathrm{old})})(x)\n$$\n设第 $n$ 次迭代时密度的微扰为 $\\delta\\rho^{(n)}(x) = A^{(n)}\\cos(qx)$。映射 $F$ 对此微扰的作用是线性的：$\\delta\\rho_{\\mathrm{out}}^{(n)}(x) = \\lambda \\delta\\rho^{(n)}(x)$，其中本征值 $\\lambda$ 是输出振幅与输入振幅的比值：\n$$\n\\lambda = \\frac{A_{\\mathrm{out}}}{A} = -\\frac{\\gamma}{\\pi^{2}\\rho_{0}(q^{2} + \\kappa^{2})}\n$$\n微扰振幅的迭代过程是：\n$$\nA^{(\\mathrm{new})}\\cos(qx) = (1-\\alpha)A^{(\\mathrm{old})}\\cos(qx) + \\alpha (\\lambda A^{(\\mathrm{old})}\\cos(qx))\n$$\n$$\nA^{(\\mathrm{new})} = [(1-\\alpha) + \\alpha\\lambda] A^{(\\mathrm{old})} = [1 - \\alpha(1-\\lambda)] A^{(\\mathrm{old})}\n$$\n为使迭代收敛，放大因子 $g(\\alpha) = 1 - \\alpha(1-\\lambda)$ 的绝对值必须小于1：\n$$\n|g(\\alpha)| = |1 - \\alpha(1-\\lambda)|  1\n$$\n这等价于不等式 $-1  1 - \\alpha(1-\\lambda)  1$。\n首先，我们使用给定的参数计算 $\\lambda$：$\\rho_{0} = 0.4$，$\\kappa = 2.0$，$\\gamma = 1.0$ 以及 $q = 1.0$。\n$$\n\\lambda = -\\frac{1.0}{\\pi^{2}(0.4)(1.0^{2} + 2.0^{2})} = -\\frac{1.0}{\\pi^{2}(0.4)(5.0)} = -\\frac{1}{2\\pi^{2}}\n$$\n由于 $\\lambda$ 是负数，项 $1-\\lambda = 1 + \\frac{1}{2\\pi^2}$ 是正数且大于1。设 $C = 1-\\lambda$。收敛条件变为：\n$$\n-1  1 - \\alpha C  1 \\implies -2  -\\alpha C  0\n$$\n由于 $C$ 是正数，$-\\alpha C$ 小于0意味着 $\\alpha > 0$。除以 $-C$（一个负数）会反转不等号：\n$$\n\\frac{2}{C} > \\alpha > 0\n$$\n迭代在 $\\alpha \\in \\left(0, \\frac{2}{C}\\right)$ 时收敛。允许的最大值为 $\\alpha_{\\max} = \\frac{2}{C}$：\n$$\n\\alpha_{\\max} = \\frac{2}{1-\\lambda} = \\frac{2}{1 - (-\\frac{1}{2\\pi^{2}})} = \\frac{2}{1 + \\frac{1}{2\\pi^{2}}}\n$$\n这个表达式可以被简化：\n$$\n\\alpha_{\\max} = \\frac{2}{\\frac{2\\pi^{2} + 1}{2\\pi^{2}}} = \\frac{4\\pi^{2}}{2\\pi^{2} + 1}\n$$\n现在，我们计算其数值：\n$$\n\\alpha_{\\max} = \\frac{4\\pi^{2}}{2\\pi^{2} + 1} \\approx \\frac{4(9.8696044)}{2(9.8696044) + 1} \\approx \\frac{39.4784176}{19.7392088 + 1} \\approx \\frac{39.4784176}{20.7392088} \\approx 1.903573\n$$\n四舍五入到四位有效数字，我们得到 $\\alpha_{\\max} \\approx 1.904$。", "answer": "$$\n\\boxed{1.904}\n$$", "id": "3486412"}, {"introduction": "对于真实材料体系，简单的线性混合往往收敛缓慢甚至不稳定。本练习将介绍一种强大且广泛使用的SCF收敛加速方法——迭代子空间直接求逆法（DIIS）。通过一个具体的计算实例，你将学习DIIS如何利用之前迭代步的历史信息来更智能地外推出一个更优的解，从而显著提高计算效率 [@problem_id:3486427]。", "problem": "考虑密度泛函理论中 Kohn–Sham 方程的一次自洽场迭代，其中三个先前的试验密度矩阵 $\\{D_1, D_2, D_3\\}$ 及其对应的残差向量 $\\{R_1, R_2, R_3\\}$ 已在迭代子空间中被收集。残差向量 $R_i$ 被定义为（在正交归一的分子轨道基中）在满足当前试验密度的广义本征值问题时的误差，其与另一残差 $R_j$ 的内积使用希尔伯特-施密特内积 $\\langle R_i, R_j \\rangle = \\mathrm{Tr}\\!\\left(R_i^{\\dagger} R_j\\right)$ 来定义。迭代子空间直接求逆（DIIS）方法通过选择系数 $\\{c_i\\}$ 来构造一个外推密度 $D^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i D_i$，这些系数在仿射约束 $\\sum_{i=1}^{3} c_i = 1$ 下，最小化由残差内积构成的二次型。\n\n给定内积已被计算，形成对称的残差度量矩阵 $B$，其元素为 $B_{ij} = \\langle R_i, R_j \\rangle$：\n$$\nB \\;=\\;\n\\begin{pmatrix}\n0.0400  0.0150  0.0100 \\\\\n0.0150  0.0500  0.0200 \\\\\n0.0100  0.0200  0.0600\n\\end{pmatrix}.\n$$\n从第一性原理出发——即自洽场的 Kohn–Sham 变分框架、残差及其内积的定义，以及迭代子空间中残差范数的约束最小化——推导用于求解系数 $\\{c_i\\}$ 的 Pulay 迭代子空间直接求逆（DIIS）线性系统，解出精确系数 $c_1$、$c_2$ 和 $c_3$，并将得到的外推密度更新 $D^{\\mathrm{DIIS}}$ 写成一个关于 $\\{D_1, D_2, D_3\\}$ 和精确系数的单一解析表达式。最终的外推密度更新需要以精确形式表示，无需四舍五入。", "solution": "该问题要求推导并求解迭代子空间直接求逆（DIIS）方程，以找到一组最优系数 $\\{c_1, c_2, c_3\\}$，用于在自洽场（SCF）过程中外推出一个新的试验密度矩阵。\n\nDIIS 过程将外推密度矩阵 $D^{\\mathrm{DIIS}}$ 构造为一组（$n$ 个）先前试验密度矩阵 $\\{D_i\\}_{i=1}^n$ 的线性组合。在本问题中，$n=3$，因此我们有：\n$$D^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i D_i$$\n系数 $c_i$ 是通过最小化相应的外推残差向量 $R^{\\mathrm{DIIS}}$ 的范数来确定的，该向量由各个残差向量 $\\{R_i\\}_{i=1}^3$ 的相同线性组合构成：\n$$R^{\\mathrm{DIIS}} = \\sum_{i=1}^{3} c_i R_i$$\n最小化过程受制于系数之和为 1 的约束，这确保了如果 $D_i$ 被正确归一化（例如 $\\mathrm{Tr}(D_i S) = N_{electrons}$），外推密度 $D^{\\mathrm{DIIS}}$ 也将保持此归一化。该约束为：\n$$\\sum_{i=1}^{3} c_i = 1$$\n需要最小化的量是外推残差向量的范数平方，$S = \\|R^{\\mathrm{DIIS}}\\|^2$。使用给定的内积定义 $\\langle R_i, R_j \\rangle = \\mathrm{Tr}(R_i^{\\dagger} R_j)$，我们可以将 $S$ 表示为系数 $c_i$ 的二次型：\n$$S = \\left\\langle \\sum_{i=1}^{3} c_i R_i, \\sum_{j=1}^{3} c_j R_j \\right\\rangle = \\sum_{i=1}^{3} \\sum_{j=1}^{3} c_i c_j \\langle R_i, R_j \\rangle$$\n设 $B$ 为残差内积的对称矩阵，其元素为 $B_{ij} = \\langle R_i, R_j \\rangle$。设 $\\mathbf{c}$ 为系数的列向量 $(c_1, c_2, c_3)^T$。目标函数为 $S(\\mathbf{c}) = \\mathbf{c}^T B \\mathbf{c}$。\n\n为解决这个约束最小化问题，我们使用拉格朗日乘子法。我们定义一个包含约束的拉格朗日函数 $\\mathcal{L}$，其中 $\\lambda$ 是拉格朗日乘子：\n$$\\mathcal{L}(\\mathbf{c}, \\lambda) = \\mathbf{c}^T B \\mathbf{c} - \\lambda \\left(\\sum_{i=1}^{3} c_i - 1\\right)$$\n为求最小值，我们将 $\\mathcal{L}$ 对每个系数 $c_k$ 和乘子 $\\lambda$ 的偏导数设为零。为了形式更方便，我们可以将拉格朗日函数定义为 $\\mathcal{L}(\\mathbf{c}, \\lambda_L) = \\mathbf{c}^T B \\mathbf{c} + 2\\lambda_L (\\mathbf{1}^T\\mathbf{c} - 1)$，其中 $\\mathbf{1}$ 是一个全为 1 的列向量。\n平稳性条件是：\n$$\\frac{\\partial \\mathcal{L}}{\\partial c_k} = 0 \\quad \\text{for } k=1, 2, 3$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_L} = 0$$\n对 $c_k$ 的导数是：\n$$\\frac{\\partial}{\\partial c_k} \\left( \\sum_{i,j} c_i B_{ij} c_j + 2\\lambda_L \\left(\\sum_i c_i - 1\\right) \\right) = 2 \\sum_j B_{kj} c_j + 2\\lambda_L = 0$$\n这给出了三个方程：对于 $k=1, 2, 3$，有 $\\sum_j B_{kj} c_j + \\lambda_L = 0$。用矩阵形式表示为 $B\\mathbf{c} + \\lambda_L \\mathbf{1} = \\mathbf{0}$。\n对 $\\lambda_L$ 的导数恢复了约束条件：\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_L} = 2\\left( \\sum_i c_i - 1 \\right) = 0 \\implies \\sum_i c_i = 1$$\n结合这些结果，我们得到包含 $n+1$ 个方程（这里是 4 个方程）的 Pulay DIIS 线性系统：\n$$\n\\begin{pmatrix}\nB_{11}  B_{12}  B_{13}  1 \\\\\nB_{21}  B_{22}  B_{23}  1 \\\\\nB_{31}  B_{32}  B_{33}  1 \\\\\n1  1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\nc_2 \\\\\nc_3 \\\\\n\\lambda_L\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n1\n\\end{pmatrix}\n$$\n这就是推导出的线性系统。为了求解系数 $\\mathbf{c}$，我们可以进行解析求解。从 $B\\mathbf{c} = -\\lambda_L \\mathbf{1}$ 出发，并假设 $B$ 是可逆的，我们得到 $\\mathbf{c} = -\\lambda_L B^{-1} \\mathbf{1}$。\n将此代入约束 $\\mathbf{1}^T \\mathbf{c} = 1$ 中：\n$$1 = \\mathbf{1}^T (-\\lambda_L B^{-1} \\mathbf{1}) = -\\lambda_L (\\mathbf{1}^T B^{-1} \\mathbf{1})$$\n这使我们能够解出拉格朗日乘子：\n$$-\\lambda_L = \\frac{1}{\\mathbf{1}^T B^{-1} \\mathbf{1}} = \\frac{1}{\\sum_{i,j} (B^{-1})_{ij}}$$\n将此代回 $\\mathbf{c}$ 的表达式中：\n$$\\mathbf{c} = \\frac{B^{-1} \\mathbf{1}}{\\sum_{i,j} (B^{-1})_{ij}}$$\n按分量来看，每个系数 $c_k$ 的解是 $B^{-1}$ 的第 $k$ 行元素之和，再用 $B^{-1}$ 的所有元素之和进行归一化：\n$$c_k = \\frac{\\sum_j (B^{-1})_{kj}}{\\sum_{i,j} (B^{-1})_{ij}}$$\n现在，我们使用给定的矩阵 $B$ 应用此公式：\n$$B = \\begin{pmatrix} 0.0400  0.0150  0.0100 \\\\ 0.0150  0.0500  0.0200 \\\\ 0.0100  0.0200  0.0600 \\end{pmatrix}$$\n为了获得精确解，我们将小数值转换为分数。给定数值的最小公分母是 $200$。\n$$B = \\begin{pmatrix} \\frac{4}{100}  \\frac{1.5}{100}  \\frac{1}{100} \\\\ \\frac{1.5}{100}  \\frac{5}{100}  \\frac{2}{100} \\\\ \\frac{1}{100}  \\frac{2}{100}  \\frac{6}{100} \\end{pmatrix} = \\frac{1}{200} \\begin{pmatrix} 8  3  2 \\\\ 3  10  4 \\\\ 2  4  12 \\end{pmatrix}$$\n设 $B_{int} = \\begin{pmatrix} 8  3  2 \\\\ 3  10  4 \\\\ 2  4  12 \\end{pmatrix}$。则 $B^{-1} = 200 \\times B_{int}^{-1}$。\n我们首先计算 $B_{int}$ 的行列式：\n$$\\det(B_{int}) = 8(10 \\cdot 12 - 4 \\cdot 4) - 3(3 \\cdot 12 - 4 \\cdot 2) + 2(3 \\cdot 4 - 10 \\cdot 2)$$\n$$\\det(B_{int}) = 8(120-16) - 3(36-8) + 2(12-20) = 8(104) - 3(28) + 2(-8) = 832 - 84 - 16 = 732$$\n接下来，我们求 $B_{int}$ 的伴随矩阵，它是其代数余子式矩阵的转置：\n$$ \\mathrm{adj}(B_{int}) = \\begin{pmatrix} 10 \\cdot 12 - 4 \\cdot 4  -(3 \\cdot 12 - 2 \\cdot 4)  3 \\cdot 4 - 2 \\cdot 10 \\\\ -(3 \\cdot 12 - 4 \\cdot 2)  8 \\cdot 12 - 2 \\cdot 2  -(8 \\cdot 4 - 3 \\cdot 2) \\\\ 3 \\cdot 4 - 10 \\cdot 2  -(8 \\cdot 4 - 3 \\cdot 2)  8 \\cdot 10 - 3 \\cdot 3 \\end{pmatrix}^T $$\n$$ \\mathrm{adj}(B_{int}) = \\begin{pmatrix} 104  -28  -8 \\\\ -28  92  -26 \\\\ -8  -26  71 \\end{pmatrix} $$\n所以，$B_{int}^{-1} = \\frac{1}{732} \\mathrm{adj}(B_{int})$。且 $B^{-1} = \\frac{200}{732} \\mathrm{adj}(B_{int}) = \\frac{50}{183} \\mathrm{adj}(B_{int})$。\n为了求系数 $c_k$，我们需要 $B^{-1}$ 的行和。让我们求出 $\\mathrm{adj}(B_{int})$ 的行和：\n第 1 行和：$104 - 28 - 8 = 68$\n第 2 行和：$-28 + 92 - 26 = 38$\n第 3 行和：$-8 - 26 + 71 = 37$\n$c_k$ 的分子与这些和成正比。分母与所有元素的总和成正比，即这些行和的总和：$68 + 38 + 37 = 143$。\n归一化常数 $\\frac{50}{183}$ 被约掉了，所以我们有：\n$$c_1 = \\frac{68}{143}$$\n$$c_2 = \\frac{38}{143}$$\n$$c_3 = \\frac{37}{143}$$\n作为检验，$\\sum_i c_i = \\frac{68+38+37}{143} = \\frac{143}{143} = 1$。约束条件得到满足。\n将这些精确系数代入 $D^{\\mathrm{DIIS}}$ 的表达式中，即可得到最终的外推密度更新：\n$$D^{\\mathrm{DIIS}} = \\frac{68}{143} D_1 + \\frac{38}{143} D_2 + \\frac{37}{143} D_3$$\n这就是 DIIS 密度更新的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{68}{143} D_1 + \\frac{38}{143} D_2 + \\frac{37}{143} D_3}\n$$", "id": "3486427"}]}