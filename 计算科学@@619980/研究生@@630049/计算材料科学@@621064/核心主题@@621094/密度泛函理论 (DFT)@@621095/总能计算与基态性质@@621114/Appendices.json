{"hands_on_practices": [{"introduction": "从第一性原理计算得到的总能量，其最直接的应用之一就是评估材料的热力学稳定性。通过将一个化合物的总能量与其构成元素的能量进行比较，我们可以计算出内聚能和生成能。这个实践旨在通过几个具体的计算案例，巩固从量子力学总能量到宏观热力学量的基本联系，这是材料设计和发现中的一个核心技能。[@problem_id:3498173]", "problem": "给定一组通过密度泛函理论 (DFT) 计算得到的零温零压下的基态总能量，以及孤立原子的参考能量。根据零温零压下的基本热力学定义，每个体系的基态总能量等于其内能，物种 $i$ 的化学势是在体积和熵固定的情况下，内能相对于粒子数 $N_i$ 的变化。单质固体的内聚能是孤立原子结合成晶体时获得的能量。多组分晶体的形成能是晶体与其组分原子之间的能量差，这些组分原子储存在由化学势表征的外部源中。您的任务是实现一个程序，利用这些原理计算下面参数集的内聚能和形成能。\n\n仅使用以下基本依据：\n- 在零温零压下，基态总能量等于内能和焓，因此所有能量都可以直接从提供的基态总能量中获取。\n- 物种 $i$ 的化学势，记作 $\\mu_i$，表示从其源中向体系添加一个物种 $i$ 的原子所引起的能量变化。\n- 对于包含整数个化学式单元的晶胞，每个化学式单元的基态总能量等于晶胞能量除以化学式单元数。\n- 对于单质体系，每个原子的内聚能是孤立原子与晶体状态下原子之间的能量差。\n- 对于化合物 $A_x B_y C_z$，每个化学式单元的形成能是该化合物每个化学式单元的基态能量与从具有指定化学势的外部源中取出的 $x$ 个 $A$ 原子、$y$ 个 $B$ 原子和 $z$ 个 $C$ 原子的能量之差。\n- 化学势可以写成 $\\mu_i = \\mu_i^{0} + \\Delta \\mu_i$，当参考单质基态 $\\mu_i^{0}$ 时，$\\Delta \\mu_i \\le 0$。当化合物在零温零压下与源达到平衡时，该化合物每个化学式单元的基态能量等于对源化学势的适当求和。\n\n所有答案必须以电子伏特 (eV) 表示，其中内聚能以每个原子 $\\mathrm{eV}$ 报告，每个形成能以每个化学式单元 $\\mathrm{eV}$ 报告。将每个报告的浮点数四舍五入到三位小数。\n\n实现一个程序，为以下测试套件计算所要求的量。每个测试产生一个浮点数。\n\n测试套件：\n- 测试 $1$（单质内聚能，每原子）：\n  - 一个立方单质晶体，每个模拟晶胞包含 $N = 8$ 个原子，基态总能量为 $E_{\\mathrm{cell}} = -42.400\\,\\mathrm{eV}$。孤立原子参考能量为 $E_{\\mathrm{atom}}^{\\mathrm{iso}} = -0.900\\,\\mathrm{eV}$。计算每原子的内聚能，单位为 $\\mathrm{eV}$/原子。\n- 测试 $2$（二元化合物形成能，每化学式单元，源处于单质极限）：\n  - 一个二元化合物 $A B_2$ 的模拟晶胞包含 $n_{\\mathrm{fu}} = 2$ 个化学式单元。晶胞的基态总能量为 $E_{\\mathrm{cell}} = -36.000\\,\\mathrm{eV}$。单质源的化学势为 $\\mu_A^{0} = -3.000\\,\\mathrm{eV}$ 和 $\\mu_B^{0} = -4.000\\,\\mathrm{eV}$。计算当源处于单质极限时，即 $\\mu_A = \\mu_A^{0}$ 和 $\\mu_B = \\mu_B^{0}$ 时，每个化学式单元的形成能，单位为 $\\mathrm{eV}$/化学式单元。\n- 测试 $3$（二元化合物形成能，每化学式单元，在指定源偏移和平衡约束下）：\n  - 考虑与测试 $2$ 中相同的 $A B_2$ 化合物和晶胞。设源偏移为 $\\Delta \\mu_B = -1.000\\,\\mathrm{eV}$ 和一个未知的 $\\Delta \\mu_A$，其中 $\\mu_B = \\mu_B^{0} + \\Delta \\mu_B$ 和 $\\mu_A = \\mu_A^{0} + \\Delta \\mu_A$。施加热力学平衡条件，即在零压下，化合物和源具有相同的每个化学式单元的基态能量，并用此条件确定未知的 $\\Delta \\mu_A$。然后计算在这些源条件下每个化学式单元的形成能，单位为 $\\mathrm{eV}$/化学式单元。\n- 测试 $4$（三元化合物形成能，每化学式单元，源为非单质）：\n  - 一个三元化合物 $A_2 B C$ 在模拟晶胞中有 $n_{\\mathrm{fu}} = 1$ 个化学式单元，基态总能量为 $E_{\\mathrm{cell}} = -22.000\\,\\mathrm{eV}$。单质参考化学势为 $\\mu_A^{0} = -3.000\\,\\mathrm{eV}$、$\\mu_B^{0} = -4.000\\,\\mathrm{eV}$ 和 $\\mu_C^{0} = -5.000\\,\\mathrm{eV}$。源由偏移量 $\\Delta \\mu_A = -1.000\\,\\mathrm{eV}$、$\\Delta \\mu_B = -0.500\\,\\mathrm{eV}$ 和 $\\Delta \\mu_C = 0.000\\,\\mathrm{eV}$ 指定，因此 $\\mu_A = \\mu_A^{0} + \\Delta \\mu_A$、$\\mu_B = \\mu_B^{0} + \\Delta \\mu_B$ 和 $\\mu_C = \\mu_C^{0} + \\Delta \\mu_C$。计算每个化学式单元的形成能，单位为 $\\mathrm{eV}$/化学式单元。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_k$ 是测试 $k$ 的浮点数结果，四舍五入到三位小数。要求的输出类型仅为浮点数，单位如上所述。", "solution": "问题陈述经核实具有科学依据，表述清晰且客观。它基于计算材料科学中应用的热力学和固态物理学的基本原理，提供了一套明确的定义和数据。所有数据都是自洽的，足以推导出每个测试用例的唯一解。\n\n解决方案要求应用零温零压（$T=0\\,\\mathrm{K}$，$P=0\\,\\mathrm{Pa}$）下内聚能和形成能的标准定义，此时基态总能量等同于内能和焓。\n\n单质固体的内聚能 $E_{\\text{coh}}$ 衡量了从孤立原子形成晶体时获得的能量。按每个原子计算，其定义为：\n$$E_{\\text{coh}} = E_{\\text{atom}}^{\\text{iso}} - E_{\\text{atom}}^{\\text{crystal}}$$\n其中 $E_{\\text{atom}}^{\\text{iso}}$ 是孤立原子的基态能量，$E_{\\text{atom}}^{\\text{crystal}}$ 是晶体中每个原子的基态能量。\n\n化学式单元为 $A_{n_A}B_{n_B}C_{n_C}\\dots$ 的化合物的形成能 $E_{\\text{form}}$ 量化了其相对于其组分元素的一组外部源的稳定性。按每个化学式单元计算，其定义为：\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{\\text{cmpd}} - \\sum_i n_i \\mu_i$$\n其中 $E_{\\text{f.u.}}^{\\text{cmpd}}$ 是化合物每个化学式单元的基态能量，$n_i$ 是化学式单元中物种 $i$ 的原子数，$\\mu_i$ 是物种 $i$ 在其各自源中的化学势。化学势 $\\mu_i$ 由 $\\mu_i = \\mu_i^0 + \\Delta\\mu_i$ 给出，其中 $\\mu_i^0$ 是物种 $i$ 单质基态的每个原子的能量，$\\Delta\\mu_i \\leq 0$ 是化学势偏移。\n\n我们现在将这些原理应用于每个测试用例。\n\n测试 $1$：单质内聚能（每原子）。\n问题提供了模拟晶胞的基态总能量 $E_{\\mathrm{cell}} = -42.400\\,\\mathrm{eV}$，其中包含 $N = 8$ 个某种元素的原子。晶体中每个原子的能量为：\n$$E_{\\text{atom}}^{\\text{crystal}} = \\frac{E_{\\mathrm{cell}}}{N} = \\frac{-42.400\\,\\mathrm{eV}}{8} = -5.300\\,\\mathrm{eV}$$\n给定的孤立原子参考能量为 $E_{\\mathrm{atom}}^{\\mathrm{iso}} = -0.900\\,\\mathrm{eV}$。因此，每个原子的内聚能为：\n$$E_{\\text{coh}} = E_{\\text{atom}}^{\\mathrm{iso}} - E_{\\text{atom}}^{\\text{crystal}} = (-0.900\\,\\mathrm{eV}) - (-5.300\\,\\mathrm{eV}) = 4.400\\,\\mathrm{eV}$$\n\n测试 $2$：二元化合物形成能（每化学式单元），源处于单质极限。\n问题描述了一个二元化合物 $A B_2$，其模拟晶胞含有 $n_{\\mathrm{fu}} = 2$ 个化学式单元，总能量为 $E_{\\mathrm{cell}} = -36.000\\,\\mathrm{eV}$。该化合物每个化学式单元的能量为：\n$$E_{\\text{f.u.}}^{AB_2} = \\frac{E_{\\mathrm{cell}}}{n_{\\mathrm{fu}}} = \\frac{-36.000\\,\\mathrm{eV}}{2} = -18.000\\,\\mathrm{eV}$$\n源处于单质极限，意味着 $\\Delta\\mu_A=0$ 且 $\\Delta\\mu_B=0$。因此化学势为 $\\mu_A = \\mu_A^0 = -3.000\\,\\mathrm{eV}$ 和 $\\mu_B = \\mu_B^0 = -4.000\\,\\mathrm{eV}$。针对化学计量 $A_1 B_2$ 计算每个化学式单元的形成能：\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{AB_2} - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B)$$\n$$E_{\\text{form}} = -18.000\\,\\mathrm{eV} - (1 \\cdot (-3.000\\,\\mathrm{eV}) + 2 \\cdot (-4.000\\,\\mathrm{eV}))$$\n$$E_{\\text{form}} = -18.000\\,\\mathrm{eV} - (-3.000\\,\\mathrm{eV} - 8.000\\,\\mathrm{eV}) = -18.000\\,\\mathrm{eV} - (-11.000\\,\\mathrm{eV}) = -7.000\\,\\mathrm{eV}$$\n\n测试 $3$：二元化合物形成能（每化学式单元），在平衡约束下。\n此测试使用与测试 $2$ 相同的化合物 $A B_2$，因此 $E_{\\text{f.u.}}^{AB_2} = -18.000\\,\\mathrm{eV}$。问题施加了热力学平衡条件，该条件指出化合物每个化学式单元的基态能量等于其在源中各组分化学势的总和：\n$$E_{\\text{f.u.}}^{AB_2} = 1 \\cdot \\mu_A + 2 \\cdot \\mu_B$$\n根据定义，形成能是相对于这些相同的源化学势计算的：\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{AB_2} - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B)$$\n将平衡条件代入形成能的定义中，得到：\n$$E_{\\text{form}} = (1 \\cdot \\mu_A + 2 \\cdot \\mu_B) - (1 \\cdot \\mu_A + 2 \\cdot \\mu_B) = 0.000\\,\\mathrm{eV}$$\n这个结果是定义的直接推论。根据定义，一个与一组源处于平衡状态的化合物，其相对于这些源的形成能为零。化学势偏移的具体值（$\\Delta \\mu_B = -1.000\\,\\mathrm{eV}$ 以及由此产生的 $\\Delta \\mu_A = -5.000\\,\\mathrm{eV}$）被用来建立源的条件，但在这些平衡条件下，形成能根据定义恒为零。\n\n测试 $4$：三元化合物形成能（每化学式单元）。\n问题考虑一个三元化合物 $A_2 B C$，其晶胞中含有 $n_{\\mathrm{fu}} = 1$ 个化学式单元，总能量为 $E_{\\mathrm{cell}} = -22.000\\,\\mathrm{eV}$。因此，每个化学式单元的能量为 $E_{\\text{f.u.}}^{A_2BC} = E_{\\mathrm{cell}} / n_{\\mathrm{fu}} = -22.000\\,\\mathrm{eV}$。源的化学势由其相对于单质参考的偏移量指定：\n$$\\mu_A = \\mu_A^0 + \\Delta\\mu_A = -3.000\\,\\mathrm{eV} + (-1.000\\,\\mathrm{eV}) = -4.000\\,\\mathrm{eV}$$\n$$\\mu_B = \\mu_B^0 + \\Delta\\mu_B = -4.000\\,\\mathrm{eV} + (-0.500\\,\\mathrm{eV}) = -4.500\\,\\mathrm{eV}$$\n$$\\mu_C = \\mu_C^0 + \\Delta\\mu_C = -5.000\\,\\mathrm{eV} + 0.000\\,\\mathrm{eV} = -5.000\\,\\mathrm{eV}$$\n对于化学计量 $A_2 B_1 C_1$ 的形成能为：\n$$E_{\\text{form}} = E_{\\text{f.u.}}^{A_2BC} - (2 \\cdot \\mu_A + 1 \\cdot \\mu_B + 1 \\cdot \\mu_C)$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (2 \\cdot (-4.000\\,\\mathrm{eV}) + 1 \\cdot (-4.500\\,\\mathrm{eV}) + 1 \\cdot (-5.000\\,\\mathrm{eV}))$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (-8.000\\,\\mathrm{eV} - 4.500\\,\\mathrm{eV} - 5.000\\,\\mathrm{eV})$$\n$$E_{\\text{form}} = -22.000\\,\\mathrm{eV} - (-17.500\\,\\mathrm{eV}) = -4.500\\,\\mathrm{eV}$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are necessary.\n\ndef solve():\n    \"\"\"\n    Computes cohesive and formation energies based on provided DFT total energies and chemical potentials.\n    \"\"\"\n\n    # --- Test 1: Elemental cohesive energy per atom ---\n    # Given data for an elemental crystal.\n    E_cell_1 = -42.400  # eV\n    N_1 = 8             # atoms\n    E_atom_iso_1 = -0.900 # eV\n\n    # Cohesive energy is the energy of the isolated atom minus the energy per atom in the crystal.\n    E_atom_crystal_1 = E_cell_1 / N_1\n    r1 = E_atom_iso_1 - E_atom_crystal_1\n\n    # --- Test 2: Binary formation energy at elemental reservoirs ---\n    # Given data for a binary compound AB2.\n    E_cell_2 = -36.000  # eV\n    n_fu_2 = 2          # formula units\n    mu_A0_2 = -3.000    # eV\n    mu_B0_2 = -4.000    # eV\n\n    # Energy per formula unit of the compound.\n    E_fu_2 = E_cell_2 / n_fu_2\n    # Reservoirs are at the elemental limit.\n    mu_A_2 = mu_A0_2\n    mu_B_2 = mu_B0_2\n    # Stoichiometry of AB2 is x=1, y=2.\n    x_2, y_2 = 1, 2\n    # Formation energy is the compound's energy minus the weighted sum of reservoir chemical potentials.\n    r2 = E_fu_2 - (x_2 * mu_A_2 + y_2 * mu_B_2)\n\n    # --- Test 3: Binary formation energy under equilibrium ---\n    # Same compound as Test 2. The equilibrium condition dictates that the compound's\n    # energy per formula unit equals the summed chemical potentials of the components.\n    # E_fu = x*mu_A + y*mu_B\n    # The formation energy is defined as E_form = E_fu - (x*mu_A + y*mu_B).\n    # Under equilibrium, these two quantities are equal, so their difference is zero.\n    r3 = 0.0\n\n    # --- Test 4: Ternary formation energy with non-elemental reservoirs ---\n    # Given data for a ternary compound A2BC.\n    E_cell_4 = -22.000  # eV\n    n_fu_4 = 1          # formula unit\n    mu_A0_4 = -3.000    # eV\n    mu_B0_4 = -4.000    # eV\n    mu_C0_4 = -5.000    # eV\n    delta_mu_A_4 = -1.000 # eV\n    delta_mu_B_4 = -0.500 # eV\n    delta_mu_C_4 = 0.000  # eV\n\n    # Energy per formula unit of the compound.\n    E_fu_4 = E_cell_4 / n_fu_4\n    # Calculate absolute chemical potentials from the given shifts.\n    mu_A_4 = mu_A0_4 + delta_mu_A_4\n    mu_B_4 = mu_B0_4 + delta_mu_B_4\n    mu_C_4 = mu_C0_4 + delta_mu_C_4\n    # Stoichiometry of A2BC is x=2, y=1, z=1.\n    x_4, y_4, z_4 = 2, 1, 1\n    # Calculate formation energy.\n    r4 = E_fu_4 - (x_4 * mu_A_4 + y_4 * mu_B_4 + z_4 * mu_C_4)\n\n    # Collect all results.\n    results = [r1, r2, r3, r4]\n\n    # Format the final output string as a comma-separated list of floats\n    # rounded to three decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "3498173"}, {"introduction": "在确定了材料的能量之后，下一步是找到其最低能量的原子构型，即基态结构。这通常通过计算原子上的力并沿着力的方向移动原子来实现，直至所有力都趋于零。这个实践探讨了力的计算，揭示了总力由两部分组成：物理的Hellmann-Feynman力和源于不完备基组的非物理Pulay修正项。通过一个简化的解析模型，你将亲手推导并计算这两个力的分量，从而深刻理解在第一性原理计算中力的来源以及如何正确处理它们。[@problem_id:3498185]", "problem": "考虑一个一维双原子模型，在Born–Oppenheimer (BO) 近似下，用一个随原子位置刚性移动的最小局域基矢表示。该基矢是非正交的，由两个局域轨道组成，每个轨道以一个原子为中心。总能量是基态电子能量与核-核排斥能之和。使用Hartree原子单位制，其中能量单位为Hartree，长度单位为Bohr半径，力的单位为Hartree每Bohr。\n\n变分电子态由一个双分量系数向量 $c(R)$ 指定，该向量在广义归一化条件下最小化Rayleigh商。哈密顿矩阵为 $H(R)$，重叠矩阵为 $S(R)$，均为 $2 \\times 2$ 大小。核间距为 $R > 0$。令以下具有物理动机的矩阵元定义该模型：\n- 重叠函数为 $s(R) = s_0 \\exp(-\\beta R)$ 且\n$$\nS(R) = \\begin{pmatrix}\n1  s(R) \\\\\ns(R)  1\n\\end{pmatrix}.\n$$\n- 哈密顿量具有相同的在位能 $\\varepsilon$ 和与距离相关的跃迁项 $t(R) = t_0 \\exp(-\\alpha R)$：\n$$\nH(R) = \\begin{pmatrix}\n\\varepsilon  t(R) \\\\\nt(R)  \\varepsilon\n\\end{pmatrix}.\n$$\n- 核-核排斥能为 $E_{\\mathrm{nn}}(R) = \\dfrac{Z^2}{R}$，其中 $Z > 0$。\n\n基态电子能量 $E_{\\mathrm{el}}(R)$ 是通过在广义归一化约束 $c(R)^\\top S(R) c(R) = 1$ 下最小化Rayleigh商得到的。基态向量 $c(R)$ 和能量 $E_{\\mathrm{el}}(R)$ 满足一个广义本征问题，其中 $S(R)$ 是正定的。在固定的BO波函数下，作用在原子上的物理力是总能量相对于 $R$ 的负梯度。\n\n你的任务是：\n1. 从第一性原理出发，以非正交基的Rayleigh商和广义归一化约束下的定态条件为起点，推导以下表达式：\n   - Hellmann–Feynman (HF) 电子力贡献 $F_{\\mathrm{HF,el}}(R)$，其源于在固定基函数下对 $H(R)$ 关于 $R$ 求导。\n   - Pulay 电子修正项 $F_{\\mathrm{Pulay,el}}(R)$，其源于基函数对 $R$ 的依赖性以及相关的归一化约束。\n   - 结合了电子贡献和核-核贡献的总力 $F_{\\mathrm{tot}}(R)$。\n2. 实现一个程序，对于每个指定的参数集，计算：\n   - 基态能量 $E_{\\mathrm{el}}(R)$ 和相应的归一化向量 $c(R)$。\n   - 电子Hellmann–Feynman力 $F_{\\mathrm{HF,el}}(R)$。\n   - Pulay修正项 $F_{\\mathrm{Pulay,el}}(R)$。\n   - 以Hartree每Bohr为单位的总力 $F_{\\mathrm{tot}}(R)$。\n   - 一个增强/抵消指示符 $I$，由两个电子贡献乘积的符号定义：如果 $F_{\\mathrm{HF,el}}(R) \\cdot F_{\\mathrm{Pulay,el}}(R) > 0$，则 $I = 1$（增强）；如果 $F_{\\mathrm{HF,el}}(R) \\cdot F_{\\mathrm{Pulay,el}}(R) < 0$，则 $I = -1$（抵消）；否则 $I = 0$。\n\n在需要时，使用这些参数化的矩阵元及其距离导数。与距离相关的标量的导数通过直接微分获得：对于 $t(R) = t_0 \\exp(-\\alpha R)$ 和 $s(R) = s_0 \\exp(-\\beta R)$，显式计算 $\\dfrac{dt}{dR}$ 和 $\\dfrac{ds}{dR}$，并用它们来构造与上述定义一致的 $\\dfrac{dH}{dR}$ 和 $\\dfrac{dS}{dR}$。核-核力贡献是 $E_{\\mathrm{nn}}(R)$ 相对于 $R$ 的负导数。\n\n角度单位不适用。所有力必须以Hartree每Bohr表示，所有浮点输出必须四舍五入到六位小数。\n\n测试套件：\n对于以下每个测试用例，计算并输出一个包含四个条目的列表：$[F_{\\mathrm{HF,el}}(R), F_{\\mathrm{Pulay,el}}(R), F_{\\mathrm{tot}}(R), I]$，其中三个力是四舍五入到六位小数的浮点数，$I$ 是一个整数。\n\n- 测试用例1（中等重叠；部分抵消）：$\\varepsilon = -0.5$, $t_0 = -0.4$, $\\alpha = 1.2$, $s_0 = 0.2$, $\\beta = 1.0$, $Z = 1.0$, $R = 2.0$。\n- 测试用例2（更强重叠；接近抵消）：$\\varepsilon = -0.5$, $t_0 = -0.4$, $\\alpha = 1.2$, $s_0 = 0.6$, $\\beta = 1.0$, $Z = 1.0$, $R = 1.4$。\n- 测试用例3（本征值符号变化；增强）：$\\varepsilon = 0.5$, $t_0 = -0.4$, $\\alpha = 1.2$, $s_0 = 0.6$, $\\beta = 1.0$, $Z = 1.0$, $R = 1.4$。\n- 测试用例4（弱重叠极限；可忽略的Pulay项）：$\\varepsilon = -0.5$, $t_0 = -0.4$, $\\alpha = 1.2$, $s_0 = 0.5$, $\\beta = 2.0$, $Z = 1.0$, $R = 4.0$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素本身都是一个列表，按上述顺序对应一个测试用例。例如：\n\"[[f11,f12,f13,i1],[f21,f22,f23,i2],[f31,f32,f33,i3],[f41,f42,f43,i4]]\"\n其中每个 $f_{jk}$ 是具有六位小数的浮点数，每个 $i_k$ 是一个整数。", "solution": "用户提供的问题被评估为有效。它在科学上基于量子力学和计算化学的原理，特别是Born-Oppenheimer近似、广义本征值问题以及原子受力的计算。该问题定义明确，提供了所有必要的参数和方程，可以为每个测试用例确定唯一的解。语言客观且无歧义。\n\n我们首先从第一性原理推导所需的表达式。\n\n在Born-Oppenheimer近似下，双原子系统的总能量是基态电子能量 $E_{\\mathrm{el}}(R)$ 和核-核排斥能 $E_{\\mathrm{nn}}(R)$ 的和：\n$$\nE_{\\mathrm{tot}}(R) = E_{\\mathrm{el}}(R) + E_{\\mathrm{nn}}(R)\n$$\n作用在原子上的总力是总能量相对于核间距 $R$ 的负梯度：\n$$\nF_{\\mathrm{tot}}(R) = -\\frac{dE_{\\mathrm{tot}}(R)}{dR} = -\\frac{dE_{\\mathrm{el}}(R)}{dR} - \\frac{dE_{\\mathrm{nn}}(R)}{dR}\n$$\n总力由电子贡献 $F_{\\mathrm{el}}(R) = -dE_{\\mathrm{el}}(R)/dR$ 和核-核贡献 $F_{\\mathrm{nn}}(R) = -dE_{\\mathrm{nn}}(R)/dR$ 组成。\n\n首先，我们处理核-核力。给定 $E_{\\mathrm{nn}}(R) = Z^2/R$：\n$$\nF_{\\mathrm{nn}}(R) = -\\frac{d}{dR}\\left(\\frac{Z^2}{R}\\right) = \\frac{Z^2}{R^2}\n$$\n\n接下来，我们推导电子力。基态电子能量 $E_{\\mathrm{el}}(R)$ 及其对应的本征向量 $c(R)$ 是广义本征值问题的解：\n$$\nH(R)c(R) = E_{\\mathrm{el}}(R)S(R)c(R)\n$$\n其中本征向量根据 $c(R)^\\top S(R) c(R) = 1$ 进行归一化。用 $c(R)^\\top$ 左乘本征值方程，得到 $c(R)^\\top H(R) c(R) = E_{\\mathrm{el}}(R) c(R)^\\top S(R) c(R)$。通过归一化，这简化为能量期望值：\n$$\nE_{\\mathrm{el}}(R) = c(R)^\\top H(R) c(R)\n$$\n为了求电子力，我们将 $E_{\\mathrm{el}}(R)$ 对 $R$ 求导。使用乘法法则：\n$$\n\\frac{dE_{\\mathrm{el}}}{dR} = \\frac{d}{dR}(c^\\top H c) = \\left(\\frac{dc}{dR}\\right)^\\top H c + c^\\top \\frac{dH}{dR} c + c^\\top H \\left(\\frac{dc}{dR}\\right)\n$$\n由于 $H$ 是对称矩阵，有 $H=H^\\top$。我们可以使用本征值方程 $Hc=E_{\\mathrm{el}}Sc$ 来重写包含 $dc/dR$ 的项：\n$$\n\\left(\\frac{dc}{dR}\\right)^\\top H c = \\left(\\frac{dc}{dR}\\right)^\\top (E_{\\mathrm{el}}Sc) = E_{\\mathrm{el}}\\left(\\frac{dc}{dR}\\right)^\\top S c\n$$\n$$\nc^\\top H \\left(\\frac{dc}{dR}\\right) = (Hc)^\\top \\left(\\frac{dc}{dR}\\right) = (E_{\\mathrm{el}}Sc)^\\top \\left(\\frac{dc}{dR}\\right) = E_{\\mathrm{el}} c^\\top S^\\top \\left(\\frac{dc}{dR}\\right) = E_{\\mathrm{el}} c^\\top S \\left(\\frac{dc}{dR}\\right)\n$$\n将这些代回到能量导数表达式中，得到：\n$$\n\\frac{dE_{\\mathrm{el}}}{dR} = c^\\top \\frac{dH}{dR} c + E_{\\mathrm{el}}\\left[ \\left(\\frac{dc}{dR}\\right)^\\top S c + c^\\top S \\left(\\frac{dc}{dR}\\right) \\right]\n$$\n方括号中的项可以通过对归一化条件 $c^\\top S c = 1$ 求导得到：\n$$\n\\frac{d}{dR}(c^\\top S c) = 0 \\implies \\left(\\frac{dc}{dR}\\right)^\\top S c + c^\\top \\frac{dS}{dR} c + c^\\top S \\left(\\frac{dc}{dR}\\right) = 0\n$$\n$$\n\\implies \\left(\\frac{dc}{dR}\\right)^\\top S c + c^\\top S \\left(\\frac{dc}{dR}\\right) = -c^\\top \\frac{dS}{dR} c\n$$\n将此结果代入 $dE_{\\mathrm{el}}/dR$ 的表达式中：\n$$\n\\frac{dE_{\\mathrm{el}}}{dR} = c^\\top \\frac{dH}{dR} c - E_{\\mathrm{el}} c^\\top \\frac{dS}{dR} c\n$$\n总电子力为 $F_{\\mathrm{el}}(R) = -dE_{\\mathrm{el}}/dR$：\n$$\nF_{\\mathrm{el}}(R) = -c^\\top \\frac{dH}{dR} c + E_{\\mathrm{el}} c^\\top \\frac{dS}{dR} c\n$$\n根据问题陈述的要求，此表达式自然地分为两项：\nHellmann-Feynman力，源于哈密顿矩阵元对 $R$ 的显式依赖：\n$$\nF_{\\mathrm{HF,el}}(R) = -c(R)^\\top \\left(\\frac{dH(R)}{dR}\\right) c(R)\n$$\nPulay力（或修正项），源于基函数对 $R$ 的依赖性，这里通过重叠矩阵 $S(R)$ 对 $R$ 的依赖以及随之而来的本征向量 $c(R)$ 的变化来体现：\n$$\nF_{\\mathrm{Pulay,el}}(R) = E_{\\mathrm{el}}(R) c(R)^\\top \\left(\\frac{dS(R)}{dR}\\right) c(R)\n$$\n总力是这些贡献的总和：\n$$\nF_{\\mathrm{tot}}(R) = F_{\\mathrm{HF,el}}(R) + F_{\\mathrm{Pulay,el}}(R) + F_{\\mathrm{nn}}(R)\n$$\n现在，我们将这些通用公式应用于具体模型。矩阵为：\n$$\nS(R) = \\begin{pmatrix} 1  s(R) \\\\ s(R)  1 \\end{pmatrix}, \\quad H(R) = \\begin{pmatrix} \\varepsilon  t(R) \\\\ t(R)  \\varepsilon \\end{pmatrix}\n$$\n其中 $s(R) = s_0 \\exp(-\\beta R)$ 且 $t(R) = t_0 \\exp(-\\alpha R)$。\n矩阵的导数为：\n$$\n\\frac{dS}{dR} = \\begin{pmatrix} 0  -s_0\\beta e^{-\\beta R} \\\\ -s_0\\beta e^{-\\beta R}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\beta s(R) \\\\ -\\beta s(R)  0 \\end{pmatrix}\n$$\n$$\n\\frac{dH}{dR} = \\begin{pmatrix} 0  -t_0\\alpha e^{-\\alpha R} \\\\ -t_0\\alpha e^{-\\alpha R}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\alpha t(R) \\\\ -\\alpha t(R)  0 \\end{pmatrix}\n$$\n基态能量和本征向量通过求解 $\\det(H - E S) = 0$ 得到。\n$$\n(\\varepsilon - E)^2 - (t - E s)^2 = 0 \\implies \\varepsilon - E = \\pm(t - E s)\n$$\n这得到两个本征值：$E_1 = \\frac{\\varepsilon+t(R)}{1+s(R)}$ 和 $E_2 = \\frac{\\varepsilon-t(R)}{1-s(R)}$。\n给定 $t_0 < 0$ 和 $s_0 > 0$，可得 $t(R) < 0$ 和 $s(R) > 0$。较低的能量对应于成键态，即基态：\n$$\nE_{\\mathrm{el}}(R) = \\frac{\\varepsilon+t(R)}{1+s(R)}\n$$\n与此本征值对应的本征向量满足 $(\\varepsilon s - t)(c_1 - c_2) = 0$，对于非平凡情况，这意味着 $c_1=c_2$。本征向量的形式为 $\\begin{pmatrix}k  k\\end{pmatrix}^\\top$。用 $c^\\top S c = 1$ 对其进行归一化：\n$$\n\\begin{pmatrix}k  k\\end{pmatrix} \\begin{pmatrix}1  s \\\\ s  1\\end{pmatrix} \\begin{pmatrix}k \\\\ k\\end{pmatrix} = 1 \\implies k^2(2+2s) = 1 \\implies k = \\frac{1}{\\sqrt{2(1+s(R))}}\n$$\n归一化的基态本征向量为 $c(R) = \\frac{1}{\\sqrt{2(1+s(R))}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n令 $c_0(R) = \\frac{1}{\\sqrt{2(1+s(R))}}$。\n\n我们现在可以计算所需的二次型：\n$$\nc^\\top \\frac{dH}{dR} c = \\begin{pmatrix}c_0  c_0\\end{pmatrix} \\begin{pmatrix} 0  -\\alpha t \\\\ -\\alpha t  0 \\end{pmatrix} \\begin{pmatrix}c_0 \\\\ c_0\\end{pmatrix} = -2c_0^2 \\alpha t(R) = -2\\left(\\frac{1}{2(1+s)}\\right)\\alpha t = \\frac{-\\alpha t(R)}{1+s(R)}\n$$\n$$\nc^\\top \\frac{dS}{dR} c = \\begin{pmatrix}c_0  c_0\\end{pmatrix} \\begin{pmatrix} 0  -\\beta s \\\\ -\\beta s  0 \\end{pmatrix} \\begin{pmatrix}c_0 \\\\ c_0\\end{pmatrix} = -2c_0^2 \\beta s(R) = -2\\left(\\frac{1}{2(1+s)}\\right)\\beta s = \\frac{-\\beta s(R)}{1+s(R)}\n$$\n将这些代入力表达式中：\n$$\nF_{\\mathrm{HF,el}}(R) = - \\left( \\frac{-\\alpha t(R)}{1+s(R)} \\right) = \\frac{\\alpha t(R)}{1+s(R)}\n$$\n$$\nF_{\\mathrm{Pulay,el}}(R) = E_{\\mathrm{el}}(R) \\left( \\frac{-\\beta s(R)}{1+s(R)} \\right) = \\left( \\frac{\\varepsilon+t(R)}{1+s(R)} \\right) \\left( \\frac{-\\beta s(R)}{1+s(R)} \\right) = -\\frac{\\beta s(R) (\\varepsilon+t(R))}{(1+s(R))^2}\n$$\n总力为：\n$$\nF_{\\mathrm{tot}}(R) = \\frac{\\alpha t(R)}{1+s(R)} - \\frac{\\beta s(R) (\\varepsilon+t(R))}{(1+s(R))^2} + \\frac{Z^2}{R^2}\n$$\n这些是用于实现的最终表达式。增强/抵消指示符 $I$ 计算为 $\\text{sign}(F_{\\mathrm{HF,el}}(R) \\cdot F_{\\mathrm{Pulay,el}}(R))$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Hellmann-Feynman force, Pulay correction, total force, and an\n    amplification/cancellation indicator for a 1D diatomic model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon, t0, alpha, s0, beta, Z, R)\n        (-0.5, -0.4, 1.2, 0.2, 1.0, 1.0, 2.0), # TC 1\n        (-0.5, -0.4, 1.2, 0.6, 1.0, 1.0, 1.4), # TC 2\n        (0.5, -0.4, 1.2, 0.6, 1.0, 1.0, 1.4),  # TC 3\n        (-0.5, -0.4, 1.2, 0.5, 2.0, 1.0, 4.0),  # TC 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        epsilon, t0, alpha, s0, beta, Z, R = case\n\n        # Calculate distance-dependent matrix element components\n        t_R = t0 * np.exp(-alpha * R)\n        s_R = s0 * np.exp(-beta * R)\n\n        # Check for physical validity of overlap\n        if abs(s_R) >= 1.0:\n            # Overlap matrix S would not be positive definite.\n            # This case should not occur with the given parameters but is\n            # good practice to consider.\n            # For simplicity, we can assume valid inputs as per the problem.\n            pass\n\n        # Denominator term frequently used\n        one_plus_s_R = 1.0 + s_R\n\n        # Calculate the electronic Hellmann-Feynman force contribution\n        f_hf_el = (alpha * t_R) / one_plus_s_R\n\n        # Calculate the ground-state electronic energy (bonding state)\n        e_el = (epsilon + t_R) / one_plus_s_R\n\n        # Calculate the electronic Pulay force correction\n        # Derived expression: E_el * (-beta * s_R) / (1 + s_R)\n        f_pulay_el = e_el * (-beta * s_R) / one_plus_s_R\n\n        # Alternative direct calculation of Pulay force:\n        # f_pulay_el = (-beta * s_R * (epsilon + t_R)) / (one_plus_s_R**2)\n\n        # Calculate the nucleus-nucleus force contribution\n        f_nn = (Z**2) / (R**2)\n\n        # Calculate the total force\n        f_tot = f_hf_el + f_pulay_el + f_nn\n\n        # Calculate the amplification/cancellation indicator I\n        force_product = f_hf_el * f_pulay_el\n        indicator = int(np.sign(force_product))\n\n        # Store the results for the current test case, rounded as specified\n        results.append([\n            round(f_hf_el, 6),\n            round(f_pulay_el, 6),\n            round(f_tot, 6),\n            indicator\n        ])\n\n    # Format the final output string as a list of lists.\n    # The default string representation of a list of lists has spaces, which\n    # are not present in the example. We build it manually.\n    formatted_results = []\n    for res in results:\n        # f-strings for precise float formatting\n        f_hf_str = f\"{res[0]:.6f}\"\n        f_pulay_str = f\"{res[1]:.6f}\"\n        f_tot_str = f\"{res[2]:.6f}\"\n        # Indicator is an integer\n        i_str = str(res[3])\n        \n        formatted_results.append(f\"[{f_hf_str},{f_pulay_str},{f_tot_str},{i_str}]\")\n\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "3498185"}, {"introduction": "一旦找到了材料的基态结构（即原子受力为零），我们便可以探究其对微小扰动（如应变）的响应，这决定了材料的机械性能。弹性常数作为能量对应变的二阶导数，是描述这种响应的关键物理量。这个实践将指导你如何通过施加对称性匹配的应变模式来精确提取特定的弹性常数$C_{44}$，同时它引入了与Pulay力密切相关的Pulay误差（或应力）的概念，并演示了如何通过对计算参数（如平面波截断能$E_{\\text{cut}}$）进行系统性收敛测试和外推，来消除这种计算误差，从而获得精确可靠的物理结果。[@problem_id:3498179]", "problem": "考虑一个处于零外部应力下的立方晶体。总能量作为微小均匀应变张量 $\\boldsymbol{\\epsilon}$ 的函数，可以进行二次展开\n$$\nE(\\boldsymbol{\\epsilon}) = E_0 + \\frac{1}{2} V_0 \\sum_{i,j,k,l} C_{ijkl}\\,\\epsilon_{ij}\\,\\epsilon_{kl} + \\mathcal{O}\\!\\left(\\|\\boldsymbol{\\epsilon}\\|^3\\right),\n$$\n其中 $E_0$ 是未应变时的能量，$V_0$ 是平衡体积，$C_{ijkl}$ 是弹性刚度。在 Voigt 记法中，对于立方材料，独立的弹性常数为 $C_{11}$、$C_{12}$ 和 $C_{44}$。使用对称性匹配的应变来分离特定的弹性常数。具体来说，使用 $xy$ 平面内的纯剪切模式，其工程剪切应变为 $\\gamma$，由对称张量 $\\epsilon_{xy} = \\epsilon_{yx} = \\gamma/2$ 定义，所有其他分量为零。\n\n为研究基组不完备性（Pulay 误差）对曲率提取的弹性常数的影响，考虑一个人工构建但物理上一致的能量预言机，它能在选定的平面波截断能 $E_{\\text{cut}}$ 下返回总能量（每个晶胞）$E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$。该预言机由三部分构成：\n1. 由真实弹性常数构建的谐波弹性能量密度 $U_{\\text{harm}}$，\n2. 与 $E_{\\text{cut}}$ 成反比且与应变成二次关系的 Pulay 误差能量密度 $U_{\\text{Pulay}}$，\n3. 一个与 $E_{\\text{cut}}$ 无关的微小四次剪切非谐性 $U_{\\text{anh}}$，用于正则化步长效应。\n\n所有能量单位为电子伏特，体积单位为立方埃，应变为无量纲，弹性常数单位为吉帕斯卡。设转换常数为 $\\kappa = 160.21766208$ 吉帕斯卡每 $\\text{electronvolt}/\\text{Å}^3$。该预言机为\n$$\nE(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = E_0 + V_0 \\left[ U_{\\text{harm}}(\\boldsymbol{\\epsilon}) + U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) + U_{\\text{anh}}(\\boldsymbol{\\epsilon}) \\right],\n$$\n其中\n$$\nU_{\\text{harm}}(\\boldsymbol{\\epsilon}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} C_{11} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) + C_{12} \\left(\\epsilon_{xx}\\epsilon_{yy} + \\epsilon_{yy}\\epsilon_{zz} + \\epsilon_{zz}\\epsilon_{xx} \\right) + 2 C_{44} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) \\right),\n$$\n$$\nU_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} \\frac{K_{\\text{vol}}}{E_{\\text{cut}}} (\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz})^2 + 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) + \\frac{1}{2} \\frac{K_{\\text{diag}}}{E_{\\text{cut}}} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) \\right),\n$$\n$$\nU_{\\text{anh}}(\\boldsymbol{\\epsilon}) = \\frac{1}{4} H_{\\text{sh}} \\left( (2\\epsilon_{xy})^4 + (2\\epsilon_{yz})^4 + (2\\epsilon_{xz})^4 \\right).\n$$\n需要使用的常数如下：\n- $E_0 = -10.0$ 电子伏特，\n- $V_0 = 15.0$ $\\text{Å}^3$，\n- $C_{11} = 250.0$ 吉帕斯卡，\n- $C_{12} = 150.0$ 吉帕斯卡，\n- $C_{44} = 120.0$ 吉帕斯卡，\n- $K_{\\text{vol}} = 1000.0$ 吉帕斯卡$\\cdot$电子伏特，\n- $K_{\\text{sh}} = 7200.0$ 吉帕斯卡$\\cdot$电子伏特，\n- $K_{\\text{diag}} = 500.0$ 吉帕斯卡$\\cdot$电子伏特，\n- $H_{\\text{sh}} = 0.02$ 电子伏特$/\\text{Å}^3$，\n- $\\kappa = 160.21766208$ 吉帕斯卡每电子伏特$/\\text{Å}^3$。\n\n你的任务是编写一个完整的程序，该程序：\n- 使用上述常数实现预言机 $E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$。\n- 使用上述的对称性匹配纯剪切模式（工程剪切应变为 $\\gamma$），通过步长为 $\\Delta \\gamma$ 的三点中心差分公式，数值估算在 $\\gamma = 0$ 处的曲率 $\\partial^2 E / \\partial \\gamma^2$：\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} \\approx \\frac{E(\\gamma=+\\Delta \\gamma; E_{\\text{cut}}) - 2 E(\\gamma=0; E_{\\text{cut}}) + E(\\gamma=-\\Delta \\gamma; E_{\\text{cut}})}{(\\Delta \\gamma)^2}.\n$$\n- 使用体积 $V_0$ 和转换常数 $\\kappa$ 将曲率转换为 $C_{44}$ 的估算值（单位为吉帕斯卡）。\n\n在你的解答中，必须从第一性原理推导出转换为吉帕斯卡的 $C_{44}$ 的公式，但你的程序必须实现最终的表达式。\n\n测试套件和要求的输出：\n- 使用三个截断能 $E_{\\text{cut}} \\in \\{300.0, 600.0, 1200.0\\}$ 电子伏特，并取 $\\Delta \\gamma = 0.02$，生成三个 $C_{44}$ 的估算值。\n- 对这三个估算值与 $1/E_{\\text{cut}}$ 的关系进行线性最小二乘拟合，模型为 $C_{44}(E_{\\text{cut}}) = C_{44}^{(\\infty)} + A \\cdot (1/E_{\\text{cut}})$，并报告外推得到的 $C_{44}^{(\\infty)}$。\n- 此外，计算在 $E_{\\text{cut}} = 300.0$ 电子伏特和较大步长 $\\Delta \\gamma = 0.05$ 时的估算值。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n\\left[ C_{44}(300.0,\\Delta \\gamma{=}0.02),\\; C_{44}(600.0,\\Delta \\gamma{=}0.02),\\; C_{44}(1200.0,\\Delta \\gamma{=}0.02),\\; C_{44}^{(\\infty)}\\ \\text{from fit},\\; C_{44}(300.0,\\Delta \\gamma{=}0.05) \\right],\n$$\n每个条目以吉帕斯卡为单位，四舍五入到 $6$ 位小数，不含任何额外文本。不涉及角度。物理单位必须与规定完全一致。输出中的所有数值必须是浮点数。\n\n科学真实性要求：确保你的实现遵循上述定义，使用指定的常数，并忠实地应用对称性匹配的应变。不允许使用外部数据；必须直接根据此处给出的公式实现预言机。程序必须是自包含的，且不需要任何输入。", "solution": "该问题在科学上和数学上是适定的且自洽的。所有必要的常数、物理模型和数值步骤都已提供，从而可以得到唯一且可验证的解。我们将着手进行推导和实现。\n\n主要目标是通过分析立方晶体对特定剪切应变的总能量响应来确定弹性常数 $C_{44}$。我们获得一个能量预言机 $E(\\boldsymbol{\\epsilon}; E_{\\text{cut}})$，它将总能量建模为应变张量 $\\boldsymbol{\\epsilon}$ 和一个计算参数（平面波截断能 $E_{\\text{cut}}$）的函数。这个预言机包括谐波、Pulay 误差和非谐贡献。\n\n首先，我们推导在指定应变下，能量与弹性常数 $C_{44}$ 之间的关系。问题规定了在 $xy$ 平面内的一个纯剪切变形，由工程剪切应变 $\\gamma$ 定义。相应的对称应变张量 $\\boldsymbol{\\epsilon}$ 的分量为 $\\epsilon_{xy} = \\epsilon_{yx} = \\gamma/2$，所有其他分量 $\\epsilon_{ij}$ 均为零。\n\n我们将这个特定的应变张量代入给定的能量预言机各分量中：\n$E(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = E_0 + V_0 \\left[ U_{\\text{harm}}(\\boldsymbol{\\epsilon}) + U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) + U_{\\text{anh}}(\\boldsymbol{\\epsilon}) \\right]$。\n\n1.  **谐波项 $U_{\\text{harm}}$**：\n    其通用形式为 $U_{\\text{harm}}(\\boldsymbol{\\epsilon}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} C_{11} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) + C_{12} \\left(\\epsilon_{xx}\\epsilon_{yy} + \\epsilon_{yy}\\epsilon_{zz} + \\epsilon_{zz}\\epsilon_{xx} \\right) + 2 C_{44} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) \\right)$。\n    对于我们的应变，只有 $\\epsilon_{xy}$ 非零。表达式简化为：\n    $$\n    U_{\\text{harm}}(\\gamma) = \\frac{1}{\\kappa} \\left( 2 C_{44} \\epsilon_{xy}^2 \\right) = \\frac{2 C_{44}}{\\kappa} \\left(\\frac{\\gamma}{2}\\right)^2 = \\frac{C_{44}}{2\\kappa} \\gamma^2.\n    $$\n\n2.  **Pulay 误差项 $U_{\\text{Pulay}}$**：\n    其通用形式为 $U_{\\text{Pulay}}(\\boldsymbol{\\epsilon}; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( \\frac{1}{2} \\frac{K_{\\text{vol}}}{E_{\\text{cut}}} (\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz})^2 + 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\left( \\epsilon_{xy}^2 + \\epsilon_{yz}^2 + \\epsilon_{xz}^2 \\right) + \\frac{1}{2} \\frac{K_{\\text{diag}}}{E_{\\text{cut}}} \\left(\\epsilon_{xx}^2 + \\epsilon_{yy}^2 + \\epsilon_{zz}^2 \\right) \\right)$。\n    同样，只有包含 $\\epsilon_{xy}^2$ 的项保留下来：\n    $$\n    U_{\\text{Pulay}}(\\gamma; E_{\\text{cut}}) = \\frac{1}{\\kappa} \\left( 2 \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} \\epsilon_{xy}^2 \\right) = \\frac{2 K_{\\text{sh}}}{\\kappa E_{\\text{cut}}} \\left(\\frac{\\gamma}{2}\\right)^2 = \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\gamma^2.\n    $$\n\n3.  **非谐项 $U_{\\text{anh}}$**：\n    其通用形式为 $U_{\\text{anh}}(\\boldsymbol{\\epsilon}) = \\frac{1}{4} H_{\\text{sh}} \\left( (2\\epsilon_{xy})^4 + (2\\epsilon_{yz})^4 + (2\\epsilon_{xz})^4 \\right)$。\n    这简化为：\n    $$\n    U_{\\text{anh}}(\\gamma) = \\frac{1}{4} H_{\\text{sh}} \\left( 2 \\frac{\\gamma}{2} \\right)^4 = \\frac{H_{\\text{sh}}}{4} \\gamma^4.\n    $$\n\n结合这些项，总能量作为工程剪切应变 $\\gamma$ 的函数为：\n$$\nE(\\gamma; E_{\\text{cut}}) = E_0 + V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) \\gamma^2 + \\frac{H_{\\text{sh}}}{4} \\gamma^4 \\right].\n$$\n根据弹性常数的定义，对于这种剪切，单位体积的能量包含一个二次项 $\\frac{1}{2}C_{44}\\gamma^2$。因此，总能量对 $\\gamma$ 的二阶导数在 $\\gamma=0$ 处的值与 $C_{44}$ 相关：\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} = V_0 \\left( \\frac{C_{44}}{\\kappa} + \\frac{K_{\\text{sh}}}{\\kappa E_{\\text{cut}}} \\right).\n$$\n重新整理这个公式，可以得到一种从能量曲率中求得有效弹性常数的方法：\n$$\nC_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}} = \\frac{\\kappa}{V_0} \\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0}.\n$$\n问题要求使用步长为 $\\Delta\\gamma$ 的三点中心差分公式对此二阶导数进行数值估算：\n$$\n\\left.\\frac{\\partial^2 E}{\\partial \\gamma^2}\\right|_{\\gamma=0} \\approx \\frac{E(+\\Delta \\gamma; E_{\\text{cut}}) - 2 E(0; E_{\\text{cut}}) + E(-\\Delta \\gamma; E_{\\text{cut}})}{(\\Delta \\gamma)^2}.\n$$\n我们来分析分子。注意 $E(\\gamma)$ 仅依赖于 $\\gamma$ 的偶数次幂，所以 $E(+\\Delta\\gamma) = E(-\\Delta\\gamma)$。此外，$E(0; E_{\\text{cut}}) = E_0$。\n$$\nE(\\Delta\\gamma) - 2 E_0 + E(\\Delta\\gamma) = 2(E(\\Delta\\gamma) - E_0) = 2 V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) (\\Delta\\gamma)^2 + \\frac{H_{\\text{sh}}}{4} (\\Delta\\gamma)^4 \\right].\n$$\n于是，数值二阶导数为：\n$$\n\\left( \\frac{\\partial^2 E}{\\partial \\gamma^2} \\right)_{\\text{num}} = \\frac{2 V_0 \\left[ \\left( \\frac{C_{44}}{2\\kappa} + \\frac{K_{\\text{sh}}}{2\\kappa E_{\\text{cut}}} \\right) (\\Delta\\gamma)^2 + \\frac{H_{\\text{sh}}}{4} (\\Delta\\gamma)^4 \\right]}{(\\Delta\\gamma)^2} = \\frac{V_0}{\\kappa}\\left(C_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}}\\right) + \\frac{V_0 H_{\\text{sh}}}{2} (\\Delta\\gamma)^2.\n$$\n将这个数值曲率乘以 $\\kappa/V_0$，就得到数值估算的弹性常数，我们记作 $C_{44}^{\\text{est}}$：\n$$\nC_{44}^{\\text{est}}(E_{\\text{cut}}, \\Delta\\gamma) = \\frac{\\kappa}{V_0} \\left( \\frac{\\partial^2 E}{\\partial \\gamma^2} \\right)_{\\text{num}} = \\left(C_{44} + \\frac{K_{\\text{sh}}}{E_{\\text{cut}}}\\right) + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2.\n$$\n这个方程表明，与真实值 $C_{44}$ 相比，估算常数有两个误差来源：一个与 $1/E_{\\text{cut}}$ 成正比的 Pulay 误差项，以及一个与 $(\\Delta\\gamma)^2$ 成正比的有限差分截断误差。\n\n任务要求对于一个固定的 $\\Delta\\gamma$，对 $C_{44}^{\\text{est}}$ 与 $1/E_{\\text{cut}}$ 的关系进行线性最小二乘拟合。我们推导出的 $C_{44}^{\\text{est}}$ 表达式具有线性方程 $y = m x + b$ 的形式：\n$$\nC_{44}^{\\text{est}} = K_{\\text{sh}} \\cdot \\left(\\frac{1}{E_{\\text{cut}}}\\right) + \\left(C_{44} + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2\\right),\n$$\n其中 $y = C_{44}^{\\text{est}}$，$x = 1/E_{\\text{cut}}$，斜率 $m=K_{\\text{sh}}$，y 轴截距 $b = C_{44} + \\frac{\\kappa H_{\\text{sh}}}{2} (\\Delta\\gamma)^2$。在无限截断能下外推得到的值 $C_{44}^{(\\infty)}$ 是这次拟合的 y 轴截距 $b$。\n\n算法如下：\n1. 基于简化的能量表达式 $E(\\gamma; E_{\\text{cut}})$，实现一个函数 `energy_oracle(gamma, e_cut)`。\n2. 实现一个函数 `calculate_C44_est(e_cut, delta_gamma)`，它计算三个能量点 $E(+\\Delta\\gamma)$、$E(0)$ 和 $E(-\\Delta\\gamma)$，应用中心差分公式得到曲率，并使用因子 $\\kappa/V_0$ 将其转换为 $C_{44}^{\\text{est}}$。\n3. 计算三个估算值 $C_{44}^{\\text{est}}(300, 0.02)$、$C_{44}^{\\text{est}}(600, 0.02)$ 和 $C_{44}^{\\text{est}}(1200, 0.02)$。\n4. 对数据点 $(1/300, C_{44}^{\\text{est}}(300, 0.02))$、$(1/600, C_{44}^{\\text{est}}(600, 0.02))$ 和 $(1/1200, C_{44}^{\\text{est}}(1200, 0.02))$ 进行线性最小二乘拟合。拟合的截距即为 $C_{44}^{(\\infty)}$。\n5. 计算最终要求的值 $C_{44}^{\\text{est}}(300, 0.05)$。\n6. 将五个结果组合起来，并以指定格式打印。线性回归将使用 `numpy.polyfit` 函数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No other libraries are needed or permitted.\n\ndef solve():\n    \"\"\"\n    Solves the computational materials science problem as described.\n    1. Implements the energy oracle for a specific shear strain.\n    2. Uses a numerical derivative to estimate the C44 elastic constant.\n    3. Performs a series of calculations and a linear extrapolation.\n    \"\"\"\n    \n    # Define the physical constants from the problem statement.\n    E0 = -10.0  # unstrained energy in eV\n    V0 = 15.0  # equilibrium volume in A^3\n    C44_true = 120.0  # true C44 in GPa\n    K_sh = 7200.0  # Pulay error shear constant in GPa*eV\n    H_sh = 0.02  # Anharmonic shear constant in eV/A^3\n    kappa = 160.21766208  # conversion constant GPa / (eV/A^3)\n\n    def energy_oracle(gamma, e_cut):\n        \"\"\"\n        Calculates the total energy for a given engineering shear strain gamma\n        and plane-wave cutoff energy e_cut.\n        The general formula is simplified for the specific shear strain.\n        \"\"\"\n        # For shear strain, epsilon_xy = gamma/2.\n        # U_harm = (1/kappa) * (2 * C44_true * (gamma/2)**2)\n        # U_pulay = (1/kappa) * (2 * K_sh/e_cut * (gamma/2)**2)\n        # U_anh = (1/4) * H_sh * gamma**4\n        # Total energy E = E0 + V0 * (U_harm + U_pulay + U_anh)\n        \n        # Combining terms for efficiency:\n        gamma_sq = gamma**2\n        \n        energy_density_quadratic = (C44_true / (2.0 * kappa) + K_sh / (2.0 * kappa * e_cut)) * gamma_sq\n        energy_density_quartic = (H_sh / 4.0) * gamma**4\n        \n        total_energy = E0 + V0 * (energy_density_quadratic + energy_density_quartic)\n        \n        return total_energy\n\n    def calculate_c44_est(e_cut, delta_gamma):\n        \"\"\"\n        Numerically estimates C44 using the three-point central difference formula.\n        \"\"\"\n        # Calculate energy at the three required points\n        e_plus = energy_oracle(delta_gamma, e_cut)\n        e_zero = energy_oracle(0.0, e_cut)\n        # Due to symmetry (even powers of gamma), e_minus = e_plus\n        e_minus = e_plus\n\n        # Calculate the second derivative (curvature) numerically\n        curvature = (e_plus - 2.0 * e_zero + e_minus) / (delta_gamma**2)\n\n        # Convert curvature to the estimated C44 in GPa\n        c44_estimated = curvature * kappa / V0\n        \n        return c44_estimated\n\n    # Define the test cases from the problem statement.\n    e_cuts_for_fit = [300.0, 600.0, 1200.0]\n    delta_gamma_for_fit = 0.02\n    \n    # Calculate the three C44 estimates for the fit\n    c44_fit_values = [calculate_c44_est(ec, delta_gamma_for_fit) for ec in e_cuts_for_fit]\n    \n    # Perform the linear least-squares fit\n    # Model: C44_est = C44_inf + A * (1/E_cut)\n    # x-values are 1/E_cut, y-values are the calculated C44 estimates\n    x_fit = 1.0 / np.array(e_cuts_for_fit)\n    y_fit = np.array(c44_fit_values)\n    \n    # np.polyfit(x, y, 1) returns [slope, intercept] for a linear fit\n    # The extrapolated C44 at infinite cutoff is the intercept\n    slope, c44_extrapolated = np.polyfit(x_fit, y_fit, 1)\n\n    # Calculate the additional test case\n    e_cut_final = 300.0\n    delta_gamma_final = 0.05\n    c44_final_case = calculate_c44_est(e_cut_final, delta_gamma_final)\n    \n    # Assemble the final list of results in the required order\n    results = [\n        c44_fit_values[0],\n        c44_fit_values[1],\n        c44_fit_values[2],\n        c44_extrapolated,\n        c44_final_case\n    ]\n\n    # Format the final output string exactly as specified\n    # Each value rounded to 6 decimal places.\n    output_string = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    \n    print(output_string)\n\nsolve()\n```", "id": "3498179"}]}