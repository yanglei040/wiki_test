{"hands_on_practices": [{"introduction": "在玻恩-奥本海默分子动力学 (BOMD) 模拟中，原子核在固定的电子势能面上运动。为了确保数值积分的稳定性，我们必须仔细选择时间步长。此练习将引导你通过分析简谐振动模式，推导出最大稳定时间步长与系统最高振动频率之间的关键关系，这是进行可靠BOMD模拟的一项基本技能。[@problem_id:3452102]", "problem": "考虑玻恩-奥本海默分子动力学（BOMD），其中原子核在固定电子构型下计算出的电子势能面上运动。原子核的运动方程采用原子核在玻恩-奥本海默势能面上的牛顿第二定律。假设系统处于一个稳定的平衡构型附近，因此电子势可以局部地近似为谐振形式。研究原子核坐标的质量加权如何揭示限制稳定性的振动模式，以及均匀质量缩放如何改变二阶显式时间离散化的稳定性。\n\n从原子核在谐振势上的牛顿第二定律出发，执行以下操作：\n\n- 根据位移矢量和质量矩阵，推导平衡点附近的线性化运动方程。\n- 引入质量加权坐标，并证明动力学解耦为独立的谐振模式，其角频率由质量加权Hessian矩阵特征值的平方根给出。\n- 对解耦的谐振模式使用二阶显式中心差分时间离散化，进行线性稳定性分析，以推导出一个将最大稳定时间步长与最高角振动频率联系起来的判据。\n- 考虑在BOMD中进行均匀质量缩放，其中所有原子核质量乘以一个正常数因子 $s$。推导在这种缩放下的最大稳定时间步长如何变化。\n\n最后，对于一个最高角振动频率为 $\\omega_{\\max} = 4.0 \\times 10^{14} \\ \\text{s}^{-1}$ 的三原子系统，在应用均匀质量缩放因子 $s = 3.0$ 时，计算其最大稳定时间步长。将最终时间步长以飞秒（fs）为单位表示，并将答案四舍五入到四位有效数字。", "solution": "基本原理是应用于在电子玻恩-奥本海默势能面上运动的原子核的牛顿第二定律。在位置 $\\mathbf{x}_{0}$ 处的稳定平衡构型附近，势能面 $V(\\mathbf{x})$ 可近似为二次（谐振）形式。令 $\\mathbf{u}(t) = \\mathbf{x}(t) - \\mathbf{x}_{0}$ 为偏离平衡位置的位移。在 $\\mathbf{x}_{0}$ 附近的泰勒展开给出\n$$\nV(\\mathbf{x}) \\approx V(\\mathbf{x}_{0}) + \\frac{1}{2} \\mathbf{u}^{\\top} \\mathbf{K} \\mathbf{u},\n$$\n其中 $\\mathbf{K}$ 是 $V$ 在 $\\mathbf{x}_{0}$ 处计算的Hessian矩阵（二阶导数矩阵），我们忽略了线性项，因为在平衡点梯度为零。根据牛顿第二定律，原子核的运动方程为\n$$\n\\mathbf{M} \\ddot{\\mathbf{x}}(t) = - \\nabla V(\\mathbf{x}(t)),\n$$\n其中 $\\mathbf{M}$ 是原子核的对角质量矩阵，点号表示时间导数。用位移表示，方程变为\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0}.\n$$\n\n为了清晰地分析振动模式，引入质量加权坐标。定义\n$$\n\\mathbf{Q}(t) = \\mathbf{M}^{1/2} \\mathbf{u}(t),\n$$\n其中 $\\mathbf{M}^{1/2}$ 是一个对角矩阵，其元素是原子核质量的平方根。对时间求二阶导数：\n$$\n\\ddot{\\mathbf{Q}}(t) = \\mathbf{M}^{1/2} \\ddot{\\mathbf{u}}(t).\n$$\n从运动方程中代入 $\\ddot{\\mathbf{u}}(t)$：\n$$\n\\ddot{\\mathbf{Q}}(t) = - \\mathbf{M}^{1/2} \\mathbf{M}^{-1} \\mathbf{K} \\mathbf{u}(t) = - \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2} \\mathbf{Q}(t).\n$$\n定义质量加权Hessian矩阵\n$$\n\\mathbf{A} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}.\n$$\n那么，在质量加权坐标系下的运动方程是\n$$\n\\ddot{\\mathbf{Q}}(t) + \\mathbf{A} \\mathbf{Q}(t) = \\mathbf{0}.\n$$\n\n因为在稳定平衡点附近 $\\mathbf{A}$ 是实对称正定矩阵，所以它可以进行正交特征分解\n$$\n\\mathbf{A} = \\mathbf{S} \\boldsymbol{\\Lambda} \\mathbf{S}^{\\top},\n$$\n其中 $\\mathbf{S}$ 是正交矩阵，$\\boldsymbol{\\Lambda} = \\mathrm{diag}(\\lambda_{1}, \\ldots, \\lambda_{3N})$ 是特征值组成的对角矩阵。变换到简正模坐标 $\\mathbf{y}(t) = \\mathbf{S}^{\\top} \\mathbf{Q}(t)$，得到解耦的标量方程\n$$\n\\ddot{y}_{k}(t) + \\lambda_{k} y_{k}(t) = 0, \\quad k = 1, \\ldots, 3N.\n$$\n每个模式都是一个简谐振子，其角频率为\n$$\n\\omega_{k} = \\sqrt{\\lambda_{k}}.\n$$\n最高角振动频率是 $\\omega_{\\max} = \\max_{k} \\omega_{k} = \\sqrt{\\lambda_{\\max}}$，其中 $\\lambda_{\\max}$ 是 $\\mathbf{A}$ 的最大特征值。\n\n接下来，使用二阶显式中心差分格式（二阶导数由中心差分近似）对时间进行离散化。对于在时间点 $t_{n} = t_{0} + n \\Delta t$ 采样的模式 $y_{k}(t)$，记作 $y_{k,n} = y_{k}(t_{n})$。二阶导数的中心差分近似是\n$$\n\\ddot{y}_{k}(t_{n}) \\approx \\frac{y_{k,n+1} - 2 y_{k,n} + y_{k,n-1}}{\\Delta t^{2}}.\n$$\n离散方程变为\n$$\n\\frac{y_{k,n+1} - 2 y_{k,n} + y_{k,n-1}}{\\Delta t^{2}} + \\lambda_{k} y_{k,n} = 0,\n$$\n或者等价地\n$$\ny_{k,n+1} - 2 y_{k,n} + y_{k,n-1} + \\Delta t^{2} \\lambda_{k} y_{k,n} = 0.\n$$\n\n通过寻找形式为 $y_{k,n} = r^{n}$ （其中 $r \\in \\mathbb{C}$ 是常数）的解，进行线性稳定性（von Neumann）分析。代入后得到特征方程\n$$\nr^{2} - \\left(2 - \\Delta t^{2} \\lambda_{k}\\right) r + 1 = 0.\n$$\n两边同除以 $r$（假设 $r \\neq 0$）可得\n$$\nr + \\frac{1}{r} = 2 - \\Delta t^{2} \\lambda_{k}.\n$$\n对于振荡解，显式中心差分格式的稳定性要求 $|r| = 1$，即 $r = \\exp(\\mathrm{i} \\theta)$（对于某个实数 $\\theta$），这意味着\n$$\nr + \\frac{1}{r} = 2 \\cos \\theta \\in [-2, 2].\n$$\n因此，一个充分必要稳定性条件是\n$$\n-2 \\leq 2 - \\Delta t^{2} \\lambda_{k} \\leq 2,\n$$\n化简为\n$$\n0 \\leq \\Delta t^{2} \\lambda_{k} \\leq 4.\n$$\n对于上界，这给出了\n$$\n\\Delta t \\leq \\frac{2}{\\sqrt{\\lambda_{k}}} = \\frac{2}{\\omega_{k}}.\n$$\n为确保所有模式的稳定性，时间步长必须满足\n$$\n\\Delta t \\leq \\frac{2}{\\sqrt{\\lambda_{\\max}}} = \\frac{2}{\\omega_{\\max}}.\n$$\n这就是将最大稳定时间步长与最高角振动频率联系起来的判据。\n\n现在考虑BOMD中的均匀质量缩放，其中每个原子核的质量都乘以一个因子 $s > 0$。令 $\\mathbf{M}' = s \\mathbf{M}$。缩放后的质量加权Hessian矩阵是\n$$\n\\mathbf{A}' = \\mathbf{M}'^{-1/2} \\mathbf{K} \\mathbf{M}'^{-1/2} = \\left(s \\mathbf{M}\\right)^{-1/2} \\mathbf{K} \\left(s \\mathbf{M}\\right)^{-1/2} = \\frac{1}{s} \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2} = \\frac{1}{s} \\mathbf{A}.\n$$\n因此，特征值按 $\\lambda'_{k} = \\lambda_{k} / s$ 缩放，角频率按如下方式缩放\n$$\n\\omega'_{k} = \\sqrt{\\lambda'_{k}} = \\frac{1}{\\sqrt{s}} \\sqrt{\\lambda_{k}} = \\frac{\\omega_{k}}{\\sqrt{s}}.\n$$\n因此，在均匀质量缩放下，最大稳定时间步长变为\n$$\n\\Delta t'_{\\max} = \\frac{2}{\\omega'_{\\max}} = \\frac{2}{\\omega_{\\max}/\\sqrt{s}} = \\frac{2 \\sqrt{s}}{\\omega_{\\max}}.\n$$\n\n最后，为给定系统（$\\omega_{\\max} = 4.0 \\times 10^{14} \\ \\text{s}^{-1}$ 和 $s = 3.0$）计算数值：\n$$\n\\Delta t'_{\\max} = \\frac{2 \\sqrt{3.0}}{4.0 \\times 10^{14}} \\ \\text{s} = \\frac{\\sqrt{3.0}}{2} \\times 10^{-14} \\ \\text{s}.\n$$\n首先符号化计算 $\\sqrt{3.0}$，然后进行数值计算以得到最终结果：\n$$\n\\sqrt{3.0} \\approx 1.7320508075688772,\n$$\n所以\n$$\n\\Delta t'_{\\max} \\approx 0.8660254037844386 \\times 10^{-14} \\ \\text{s} = 8.660254037844386 \\times 10^{-15} \\ \\text{s}.\n$$\n使用 $1 \\ \\text{fs} = 10^{-15} \\ \\text{s}$ 将秒转换为飞秒，得到\n$$\n\\Delta t'_{\\max} \\approx 8.660254037844386 \\ \\text{fs}.\n$$\n四舍五入到四位有效数字，最大稳定时间步长为\n$$\n8.660 \\ \\text{fs}.\n$$", "answer": "$$\\boxed{8.660}$$", "id": "3452102"}, {"introduction": "在实践中，我们通常使用密度泛函理论 (DFT) 等方法来计算玻恩-奥本海默势能面。然而，由于计算资源所限，我们使用的基组往往是不完备的，这会引入一种称为Pulay应力的人为“伪力”，从而影响晶格参数等物理性质的预测准确性。本练习旨在通过一个模型问题，帮助你理解并量化Pulay应力的影响，并设计方案来获得收敛的、与玻恩-奥本海默极限一致的结果。[@problem_id:3493219]", "problem": "您的任务是量化基组不完备性（Pulay应力）如何在Born-Oppenheimer近似下改变平衡晶格常数，并设计一个能够产生与Born-Oppenheimer一致的晶胞优化计算方案。考虑一个各向同性的立方晶体，其Born-Oppenheimer势能在平衡体积附近是局域谐波的。核自由度在Born-Oppenheimer能量面上被经典地处理，并且您采用以下基于物理的模型。\n\n基本原理：\n- 在Born-Oppenheimer近似下，固定核位置的电子基态能量定义了势能面 $E_{\\mathrm{BO}}(\\mathbf{R})$。对于由体积 $V$ 参数化的各向同性压缩/膨胀，平衡体积 $V_0$ 附近的局域展开可以近似为一个具有体积模量 $B$ 的二次型。相关的热力学压力为 $p_{\\mathrm{true}}(V) = -\\partial E_{\\mathrm{true}}(V)/\\partial V$。\n- 在使用不完备基组进行晶胞优化时，由于基组对晶胞的依赖性，Hellmann-Feynman应力不再精确；这导致了Pulay应力。在本问题中，您将基组对能量的贡献建模为 $\\Delta E_{\\mathrm{basis}}(V; E_{\\mathrm{cut}}) = \\beta(E_{\\mathrm{cut}})\\, V$，其中 $E_{\\mathrm{cut}}$ 是平面波动能截断，$\\beta(E_{\\mathrm{cut}}) = c/E_{\\mathrm{cut}}^q$，其中 $c>0$ 和 $q>0$ 是已知常数。Pulay应力则为 $p_{\\mathrm{Pulay}} = -\\partial \\Delta E_{\\mathrm{basis}}/\\partial V = -\\beta(E_{\\mathrm{cut}})$。\n- 平衡晶格常数是通过在零外压下最小化焓得到的，在这个简化设置中，这等效于求解 $p_{\\mathrm{true}}(V) + p_{\\mathrm{Pulay}} = 0$ 以获得平衡体积 $V^\\star$，并通过 $a^\\star = (V^\\star)^{1/3}$ 将 $V^\\star$ 转换为立方晶格常数 $a^\\star$。\n\n您的程序必须：\n1. 仅从上述原理出发，给定 $a_0$（无限截断下的Born-Oppenheimer平衡晶格常数）、$B$（体积模量）、$c$ 和 $q$，推导出 $V^\\star$ 的平衡条件以及相应的 $a^\\star(E_{\\mathrm{cut}})$。使用物理上一致的单位：晶格常数 $a$ 单位为埃（$\\mathrm{\\AA}$），体积 $V$ 单位为 $\\mathrm{\\AA}^3$，体积模量 $B$ 单位为 $\\mathrm{eV}/\\mathrm{\\AA}^3$，能量截断 $E_{\\mathrm{cut}}$ 单位为里德堡（$\\mathrm{Ry}$），以及 $\\beta$ 单位为 $\\mathrm{eV}/\\mathrm{\\AA}^3$。\n2. 实现一个基组收敛方案，对于每个测试用例：\n   - 对于一组给定的截断值 $\\{E_{\\mathrm{cut},i}\\}$，计算预测的晶格常数列表 $a^\\star(E_{\\mathrm{cut},i})$（单位为 $\\mathrm{\\AA}$）。\n   - 对于给定的容差 $\\tau_a$（单位为 $\\mathrm{\\AA}$），确定最小截断 $E_{\\mathrm{cut}}^{\\mathrm{min}}$（单位为 $\\mathrm{Ry}$），使得 $\\lvert a^\\star(E_{\\mathrm{cut}}) - a_0 \\rvert \\le \\tau_a$。使用一个数值上稳健的方法，该方法不假设超出合理模型范围的线性关系。\n   - 通过假设在大的 $E_{\\mathrm{cut}}$ 附近，$a^\\star$ 对 $E_{\\mathrm{cut}}^{-q}$ 的主导阶依赖关系，使用两个截断值 $E_1$ 和 $E_2$ 以及已知的指数 $q$ 执行两点外推，以估计无限截断晶格常数 $a_\\infty$。\n   - 返回一个布尔值，指示 $\\lvert a_\\infty - a_0 \\rvert \\le \\tau_a$ 是否成立。\n\n测试套件：\n- 使用以下四个测试用例，每个用例由 $(a_0, B, c, q, \\{E_{\\mathrm{cut},i}\\}, \\tau_a)$ 指定：\n  - 用例A（典型金属）：$(a_0=$ $3.6$ $\\mathrm{\\AA}$, $B=$ $0.5$ $\\mathrm{eV}/\\mathrm{\\AA}^3$, $c=$ $0.05$ $\\mathrm{eV}/\\mathrm{\\AA}^3 \\cdot \\mathrm{Ry}^q$, $q=$ $2$, $\\{E_{\\mathrm{cut},i}\\}=$ $\\{30, 40, 60\\}$ $\\mathrm{Ry}$, $\\tau_a=$ $0.001$ $\\mathrm{\\AA})$。\n  - 用例B（软固体）：$(a_0=$ $4.5$ $\\mathrm{\\AA}$, $B=$ $0.1$ $\\mathrm{eV}/\\mathrm{\\AA}^3$, $c=$ $0.05$ $\\mathrm{eV}/\\mathrm{\\AA}^3 \\cdot \\mathrm{Ry}^q$, $q=$ $2$, $\\{E_{\\mathrm{cut},i}\\}=$ $\\{30, 40, 60\\}$ $\\mathrm{Ry}$, $\\tau_a=$ $0.001$ $\\mathrm{\\AA})$。\n  - 用例C（慢收敛基组）：$(a_0=$ $3.0$ $\\mathrm{\\AA}$, $B=$ $0.4$ $\\mathrm{eV}/\\mathrm{\\AA}^3$, $c=$ $0.5$ $\\mathrm{eV}/\\mathrm{\\AA}^3 \\cdot \\mathrm{Ry}^q$, $q=$ $1$, $\\{E_{\\mathrm{cut},i}\\}=$ $\\{20, 30, 50\\}$ $\\mathrm{Ry}$, $\\tau_a=$ $0.0005$ $\\mathrm{\\AA})$。\n  - 用例D（快收敛基组）：$(a_0=$ $2.5$ $\\mathrm{\\AA}$, $B=$ $0.7$ $\\mathrm{eV}/\\mathrm{\\AA}^3$, $c=$ $0.5$ $\\mathrm{eV}/\\mathrm{\\AA}^3 \\cdot \\mathrm{Ry}^q$, $q=$ $3$, $\\{E_{\\mathrm{cut},i}\\}=$ $\\{15, 25, 35\\}$ $\\mathrm{Ry}$, $\\tau_a=$ $0.0002$ $\\mathrm{\\AA})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，输出一个包含四项的列表：针对所提供截断值的预测 $a^\\star$ 值列表（单位为 $\\mathrm{\\AA}$），满足容差的最小截断 $E_{\\mathrm{cut}}^{\\mathrm{min}}$（单位为 $\\mathrm{Ry}$），从第一个和最后一个提供的截断值外推得到的 $a_\\infty$（单位为 $\\mathrm{\\AA}$），以及指示 $\\lvert a_\\infty - a_0 \\rvert \\le \\tau_a$ 是否成立的布尔标志。具体来说，最后一行必须看起来像\n$[[$ $a^\\star_{A,1}$ $,$ $a^\\star_{A,2}$ $,$ $a^\\star_{A,3}$ $]$ $,$ $E_{\\mathrm{cut},A}^{\\mathrm{min}}$ $,$ $a_{\\infty,A}$ $,$ $\\mathrm{bool}_A$ $,$ $[[$ $a^\\star_{B,1}$ $,$ $a^\\star_{B,2}$ $,$ $a^\\star_{B,3}$ $]$ $,$ $E_{\\mathrm{cut},B}^{\\mathrm{min}}$ $,$ $a_{\\infty,B}$ $,$ $\\mathrm{bool}_B$ $,$ $[[$ $a^\\star_{C,1}$ $,$ $a^\\star_{C,2}$ $,$ $a^\\star_{C,3}$ $]$ $,$ $E_{\\mathrm{cut},C}^{\\mathrm{min}}$ $,$ $a_{\\infty,C}$ $,$ $\\mathrm{bool}_C$ $,$ $[[$ $a^\\star_{D,1}$ $,$ $a^\\star_{D,2}$ $,$ $a^\\star_{D,3}$ $]$ $,$ $E_{\\mathrm{cut},D}^{\\mathrm{min}}$ $,$ $a_{\\infty,D}$ $,$ $\\mathrm{bool}_D$ $]$.", "solution": "Born-Oppenheimer (BO) 近似分离了电子和原子核的运动，将电子基态能量定义为核坐标 $\\mathbf{R}$ 的函数 $E_{\\mathrm{BO}}(\\mathbf{R})$。对于一个体积为 $V$、接近BO平衡体积 $V_0$ 的各向同性立方晶胞，一个经过充分检验的局域描述是真实能量的谐波近似，\n$$\nE_{\\mathrm{true}}(V) \\approx E_0 + \\frac{B}{2V_0}\\,(V - V_0)^2,\n$$\n其中 $B$ 为体积模量（单位为 $\\mathrm{eV}/\\mathrm{\\AA}^3$）。真实压力由热力学得出，\n$$\np_{\\mathrm{true}}(V) \\equiv -\\frac{\\partial E_{\\mathrm{true}}}{\\partial V} = -\\frac{B}{V_0}\\,(V - V_0).\n$$\n在不完备基组中，会出现一个额外的依赖于基组的能量贡献。我们将其建模为\n$$\n\\Delta E_{\\mathrm{basis}}(V; E_{\\mathrm{cut}}) = \\beta(E_{\\mathrm{cut}})\\,V, \\quad \\beta(E_{\\mathrm{cut}}) = \\frac{c}{E_{\\mathrm{cut}}^{q}},\n$$\n其中 $c>0$ 且 $q>0$。相关的Pulay应力是 $\\Delta E_{\\mathrm{basis}}$ 对 $V$ 的负导数，\n$$\np_{\\mathrm{Pulay}} = -\\frac{\\partial \\Delta E_{\\mathrm{basis}}}{\\partial V} = -\\beta(E_{\\mathrm{cut}}) = -\\frac{c}{E_{\\mathrm{cut}}^{q}}.\n$$\n在零外压下，平衡条件结合了真实压力和Pulay应力的贡献，\n$$\np_{\\mathrm{true}}(V^\\star) + p_{\\mathrm{Pulay}} = 0 \\quad \\Rightarrow \\quad -\\frac{B}{V_0}\\,(V^\\star - V_0) - \\beta(E_{\\mathrm{cut}}) = 0.\n$$\n求解平衡体积可得\n$$\nV^\\star = V_0\\left(1 - \\frac{\\beta(E_{\\mathrm{cut}})}{B}\\right) = V_0\\left(1 - \\frac{c}{B\\,E_{\\mathrm{cut}}^{q}}\\right).\n$$\n对于立方晶胞，晶格常数通过 $a = V^{1/3}$ 与体积相关。因此，在截断能 $E_{\\mathrm{cut}}$ 下预测的晶格常数为\n$$\na^\\star(E_{\\mathrm{cut}}) = \\big(V^\\star\\big)^{1/3} = a_0\\left(1 - \\frac{c}{B\\,E_{\\mathrm{cut}}^{q}}\\right)^{1/3},\n$$\n其中 $a_0 = V_0^{1/3}$ 是当 $E_{\\mathrm{cut}}\\to\\infty$ 时获得的与BO一致的晶格常数。只要 $\\beta(E_{\\mathrm{cut}}) < B$，该表达式就是物理上合理的，这能确保 $V^\\star>0$ 并避免非物理性的坍缩。\n\n对于基组收敛方案，我们设计三个组成部分：\n\n1. 直接计算 $a^\\star(E_{\\mathrm{cut},i})$：使用上述精确表达式，为每个测试截断能 $E_{\\mathrm{cut},i}$ 计算 $a^\\star$，返回以 $\\mathrm{\\AA}$ 为单位的值。\n\n2. 针对容差 $\\tau_a$ 的最小截断能 $E_{\\mathrm{cut}}^{\\mathrm{min}}$：我们寻求最小的 $E_{\\mathrm{cut}}$，使得 $\\lvert a^\\star(E_{\\mathrm{cut}}) - a_0 \\rvert \\le \\tau_a$。定义单调递减的误差函数\n$$\n\\mathrm{err}(E_{\\mathrm{cut}}) \\equiv \\left|a^\\star(E_{\\mathrm{cut}}) - a_0\\right| - \\tau_a = a_0\\left[\\left(1 - \\frac{c}{B\\,E_{\\mathrm{cut}}^{q}}\\right)^{1/3} - 1\\right]_{\\text{absolute}} - \\tau_a,\n$$\n注意到对于 $c>0$，方括号中的项为负，因此其绝对值随着 $E_{\\mathrm{cut}}$ 的增加而减小。我们使用区间法和二分法来定位阈值：\n- 从一个下界 $E_{\\mathrm{low}}$（例如，$E_{\\mathrm{low}}=$ $1$ $\\mathrm{Ry}$）开始。如果 $c=0$，则 $\\mathrm{err}(E_{\\mathrm{low}})=-\\tau_a$，任何截断能都满足容差；返回 $E_{\\mathrm{low}}$ 作为最小的实际值。\n- 否则，通过逐次加倍来增加上界 $E_{\\mathrm{high}}$，直到 $\\mathrm{err}(E_{\\mathrm{high}})\\le 0$，从而保证解存在于 $[E_{\\mathrm{low}}, E_{\\mathrm{high}}]$ 区间内。\n- 在 $[E_{\\mathrm{low}}, E_{\\mathrm{high}}]$ 上应用二分法，以在选定的数值容差内找到满足 $\\mathrm{err}(E_{\\mathrm{cut}})\\le 0$ 的最小 $E_{\\mathrm{cut}}$。由于 $\\mathrm{err}$ 是单调递减的，二分法收敛迅速且稳健。\n\n3. 对 $a_\\infty$ 进行两点外推：对于大的 $E_{\\mathrm{cut}}$，一阶二项式展开给出\n$$\na^\\star(E_{\\mathrm{cut}}) = a_0\\left(1 - \\frac{c}{B\\,E_{\\mathrm{cut}}^{q}}\\right)^{1/3} \\approx a_0\\left[1 - \\frac{1}{3}\\frac{c}{B}\\,E_{\\mathrm{cut}}^{-q}\\right] = a_0 - K\\,E_{\\mathrm{cut}}^{-q},\n$$\n其中 $K = \\frac{a_0}{3}\\frac{c}{B}$。这种对 $x = E_{\\mathrm{cut}}^{-q}$ 的线性依赖性允许进行到 $x=0$ 的两点外推。给定两个截断能 $E_1$ 和 $E_2$ 及其对应的 $y_1 = a^\\star(E_1)$ 和 $y_2 = a^\\star(E_2)$，以及 $x_1 = E_1^{-q}$，$x_2 = E_2^{-q}$，通过点 $(x_1,y_1)$ 和 $(x_2,y_2)$ 的直线的斜率为 $m = (y_2 - y_1)/(x_2 - x_1)$，其在 $x=0$ 处的截距等于\n$$\na_\\infty \\approx y_1 - m\\,x_1 = y_1 - \\frac{y_2 - y_1}{x_2 - x_1}\\,x_1.\n$$\n然后我们检验 $\\lvert a_\\infty - a_0 \\rvert \\le \\tau_a$ 以评估在指定容差内的BO一致性。\n\n边界情况与科学真实性：\n- 条件 $\\beta(E_{\\mathrm{cut}}) < B$ 是必需的，以维持物理上合理的体积并避免奇异行为。对于提供的截断能，测试套件中的值满足此条件。\n- 二分法协议保证了即使在收敛缓慢（$q$ 值小或 $c$ 值大）的情况下也能得到答案，这反映了计算材料科学中Pulay应力可能非常显著的现实情景。\n- 使用 $\\mathrm{eV}/\\mathrm{\\AA}^3$ 作为 $B$ 的单位确保了与能量模型的一致性；作为参考，$1$ $\\mathrm{eV}/\\mathrm{\\AA}^3 \\approx 160.21766208$ $\\mathrm{GPa}$，但程序完全使用指定的单位进行运算。\n\n实现的算法步骤：\n- 对于每个测试用例 $(a_0, B, c, q, \\{E_{\\mathrm{cut},i}\\}, \\tau_a)$：\n  1. 计算 $V_0 = a_0^3$，并为每个 $E_{\\mathrm{cut},i}$ 计算 $\\beta_i = c/E_{\\mathrm{cut},i}^q$、$V^\\star_i = V_0(1 - \\beta_i/B)$ 和 $a^\\star_i = (V^\\star_i)^{1/3}$。\n  2. 使用区间法和二分法，通过上述的 $a^\\star(E_{\\mathrm{cut}})$ 精确表达式找到 $E_{\\mathrm{cut}}^{\\mathrm{min}}$。\n  3. 使用与 $E_{\\mathrm{cut}}^{-q}$ 主导阶依赖关系一致的两点外推法，从第一个和最后一个截断值计算 $a_\\infty$。\n  4. 返回结果元组：$a^\\star_i$ 列表、$E_{\\mathrm{cut}}^{\\mathrm{min}}$、$a_\\infty$ 和布尔测试 $\\lvert a_\\infty - a_0 \\rvert \\le \\tau_a$。\n\n最终程序输出一个单行Python列表，该列表汇总了所有四个测试用例的结果，如指定格式所示。", "answer": "```\n[[[3.598800, 3.599325, 3.599700], 79.056942, 3.600000, True], [[4.494011, 4.496632, 4.498503], 176.776695, 4.500000, True], [[2.981308, 2.987516, 2.992508], 249.950010, 3.000000, True], [[2.499476, 2.499811, 2.499905], 44.981880, 2.500000, True]]\n```", "id": "3493219"}, {"introduction": "玻恩-奥本海默近似并非总是有效，尤其是在电子态能量接近简并的区域，例如锥形交叉点。在这些区域，电子和原子核的运动会发生强烈的耦合，导致非绝热效应。本练习将使用一个线性振动耦合模型，让你亲手推导描述这种耦合强度的非绝热耦合项，从而从根本上理解玻恩-奥本海默近似的失效机制。[@problem_id:3493269]", "problem": "考虑一个在质量加权简正坐标下，位于锥形交叉附近的分子亚系统的双态线性振动耦合 (LVC) 模型。设核坐标为 $x$ (调谐模式) 和 $y$ (耦合模式)，核动能算符为 $T_{\\mathrm{nuc}}=-\\frac{1}{2}\\left(\\frac{\\partial^{2}}{\\partial x^{2}}+\\frac{\\partial^{2}}{\\partial y^{2}}\\right)$。作用于两个透热电子基态 $|1\\rangle$ 和 $|2\\rangle$ 的透热电子哈密顿量为\n$$\n\\hat{H}_{\\mathrm{dia}}(x,y)=\\frac{1}{2}\\left(\\omega_{x}^{2}x^{2}+\\omega_{y}^{2}y^{2}\\right)\\hat{I}+\\begin{pmatrix}a\\,x  c\\,y \\\\ c\\,y  -a\\,x\\end{pmatrix},\n$$\n其中 $\\hat{I}$ 是 $2\\times 2$ 单位算符，而 $a>0$，$c>0$ 是参数化线性透热能量差 ($a\\,x$) 和透热态间耦合 ($c\\,y$) 的实常数。锥形交叉出现在原点 $x=0$, $y=0$ 处。\n\n从固定核坐标下的定态电子薛定谔方程以及与 Born-Oppenheimer (BO) 近似相关的 Born-Huang 展开出发，推导绝热电子态并计算两个绝热电子态之间的矢量非绝热导数耦合，其定义为 $\\mathbf{d}_{12}(x,y)=\\langle\\phi_{1}(x,y)|\\boldsymbol{\\nabla}_{(x,y)}\\phi_{2}(x,y)\\rangle$，其中 $\\boldsymbol{\\nabla}_{(x,y)}=(\\partial/\\partial x,\\,\\partial/\\partial y)$ 且 $|\\phi_{1}\\rangle$ 和 $|\\phi_{2}\\rangle$ 是在 $(x,y)$ 处的 $2\\times 2$ 电子哈密顿量的正交归一的绝热电子本征态。利用这些结果，确定：\n\n- 锥形交叉附近的非绝热耦合强度，取为其大小 $|\\mathbf{d}_{12}(x,y)|$。\n- BO 核运动的主导修正，由对角 Born-Oppenheimer 修正 (DBOC) 量化，其定义为核动能算符沿单个绝热势能面作用在电子基上所产生的标量势。\n\n你的最终答案必须是两个以 $a$、$c$、$x$ 和 $y$ 表示的闭合形式的解析表达式：首先是 $|\\mathbf{d}_{12}(x,y)|$，其次是下绝热势能面上的 DBOC。非绝热耦合强度的单位应为质量加权坐标的倒数，DBOC 的单位应与哈密顿量的能量单位相同。无需进行数值计算，也无需四舍五入。最终答案中只提供所要求的表达式。", "solution": "其基本出发点是固定核坐标下的定态电子薛定谔方程以及作为 Born-Oppenheimer (BO) 近似基础的 Born-Huang 展开。在固定的 $(x,y)$ 处，电子哈密顿量是 $2\\times 2$ 矩阵\n$$\n\\hat{H}_{\\mathrm{el}}(x,y)=\\frac{1}{2}\\left(\\omega_{x}^{2}x^{2}+\\omega_{y}^{2}y^{2}\\right)\\hat{I}+\\begin{pmatrix}a\\,x  c\\,y \\\\ c\\,y  -a\\,x\\end{pmatrix}.\n$$\n单位算符项仅将两个绝热能量进行等量移动，对绝热电子本征矢量及其关于核坐标的导数没有影响，因此我们只关注\n$$\n\\hat{h}(x,y)=\\begin{pmatrix}a\\,x  c\\,y \\\\ c\\,y  -a\\,x\\end{pmatrix}.\n$$\n这个实对称矩阵可以通过在透热基中的一个旋转来对角化。通过一个混合角 $\\theta(x,y)$ 来定义绝热电子本征态 $|\\phi_{+}\\rangle$ 和 $|\\phi_{-}\\rangle$（上、下绝热态）：\n$$\n|\\phi_{+}\\rangle=\\cos\\theta\\,|1\\rangle+\\sin\\theta\\,|2\\rangle,\\qquad\n|\\phi_{-}\\rangle=-\\sin\\theta\\,|1\\rangle+\\cos\\theta\\,|2\\rangle.\n$$\n混合角由旋转后基中非对角元为零的条件确定。对于一个一般的 $2\\times 2$ 实对称矩阵 $\\begin{pmatrix}\\Delta/2  W \\\\ W  -\\Delta/2\\end{pmatrix}$，对角化角满足 $\\tan(2\\theta)=2W/\\Delta$。在当前情况下，$\\Delta=2a\\,x$ 且 $W=c\\,y$，所以\n$$\n\\tan(2\\theta)=\\frac{2\\,c\\,y}{2\\,a\\,x}=\\frac{c\\,y}{a\\,x}.\n$$\n因此，\n$$\n2\\theta(x,y)=\\arctan\\!\\left(\\frac{c\\,y}{a\\,x}\\right),\\qquad \\theta(x,y)=\\frac{1}{2}\\arctan\\!\\left(\\frac{c\\,y}{a\\,x}\\right).\n$$\n\n两个绝热电子态之间的非绝热导数耦合矢量定义为\n$$\n\\mathbf{d}_{+-}(x,y)\\equiv\\langle\\phi_{+}(x,y)|\\boldsymbol{\\nabla}_{(x,y)}\\phi_{-}(x,y)\\rangle.\n$$\n在所选的实规范（实值绝热本征矢量）下，该矢量简化为混合角的梯度，其符号取决于标记方式；特别地，\n$$\n\\mathbf{d}_{+-}(x,y)=-\\boldsymbol{\\nabla}\\theta(x,y),\\qquad \\mathbf{d}_{-+}(x,y)=\\boldsymbol{\\nabla}\\theta(x,y).\n$$\n因此，两个绝热态之间的非绝热耦合强度的大小为\n$$\n|\\mathbf{d}_{12}(x,y)|=|\\boldsymbol{\\nabla}\\theta(x,y)|.\n$$\n我们计算 $\\theta(x,y)=\\frac{1}{2}\\arctan\\!\\left(\\frac{c\\,y}{a\\,x}\\right)$ 的梯度。引入 $k\\equiv \\frac{c}{a}$ 和 $u(x,y)\\equiv k\\frac{y}{x}$。则\n$$\n\\theta(x,y)=\\frac{1}{2}\\arctan\\!\\big(u(x,y)\\big),\\qquad \\boldsymbol{\\nabla}\\theta=\\frac{1}{2}\\frac{1}{1+u^{2}}\\boldsymbol{\\nabla}u.\n$$\n因为 $u=k\\,y/x$，其偏导数为\n$$\n\\frac{\\partial u}{\\partial x}=-k\\,\\frac{y}{x^{2}},\\qquad \\frac{\\partial u}{\\partial y}=k\\,\\frac{1}{x}.\n$$\n注意 $1+u^{2}=1+\\frac{k^{2}y^{2}}{x^{2}}=\\frac{x^{2}+k^{2}y^{2}}{x^{2}}$。因此，\n$$\n\\frac{\\partial \\theta}{\\partial x}=\\frac{1}{2}\\left(\\frac{x^{2}}{x^{2}+k^{2}y^{2}}\\right)\\left(-k\\,\\frac{y}{x^{2}}\\right)\n=-\\frac{1}{2}\\frac{k\\,y}{x^{2}+k^{2}y^{2}},\n$$\n$$\n\\frac{\\partial \\theta}{\\partial y}=\\frac{1}{2}\\left(\\frac{x^{2}}{x^{2}+k^{2}y^{2}}\\right)\\left(k\\,\\frac{1}{x}\\right)\n=\\frac{1}{2}\\frac{k\\,x}{x^{2}+k^{2}y^{2}}.\n$$\n因此梯度矢量为\n$$\n\\boldsymbol{\\nabla}\\theta(x,y)=\\left(-\\frac{1}{2}\\frac{k\\,y}{x^{2}+k^{2}y^{2}},\\ \\frac{1}{2}\\frac{k\\,x}{x^{2}+k^{2}y^{2}}\\right).\n$$\n其大小为\n$$\n|\\boldsymbol{\\nabla}\\theta(x,y)|=\\sqrt{\\left(\\frac{1}{2}\\frac{k\\,y}{x^{2}+k^{2}y^{2}}\\right)^{2}+\\left(\\frac{1}{2}\\frac{k\\,x}{x^{2}+k^{2}y^{2}}\\right)^{2}}\n=\\frac{1}{2}\\frac{k\\,\\sqrt{x^{2}+y^{2}}}{x^{2}+k^{2}y^{2}}.\n$$\n回到 $k=\\frac{c}{a}$ 并通过消除分母中的分数来简化，分子分母同乘以 $a^{2}$：\n$$\n|\\mathbf{d}_{12}(x,y)|=|\\boldsymbol{\\nabla}\\theta(x,y)|\n=\\frac{1}{2}\\frac{\\frac{c}{a}\\sqrt{x^{2}+y^{2}}}{x^{2}+\\frac{c^{2}}{a^{2}}y^{2}}\n=\\frac{a\\,c}{2}\\frac{\\sqrt{x^{2}+y^{2}}}{a^{2}x^{2}+c^{2}y^{2}}.\n$$\n\n接下来，我们使用对角 Born-Oppenheimer 修正 (DBOC) 来评估 BO 核运动的主导修正。在 Born-Huang 展开中，对于给定的绝热态 $|\\phi_{n}\\rangle$，核动能算符作用于电子基上会产生一个标量势项\n$$\nU_{n}^{\\mathrm{DBOC}}(x,y)=\\frac{1}{2}\\sum_{\\alpha\\in\\{x,y\\}}\\left\\langle \\frac{\\partial \\phi_{n}}{\\partial q_{\\alpha}}\\middle|\\frac{\\partial \\phi_{n}}{\\partial q_{\\alpha}}\\right\\rangle,\n$$\n其中质量加权简正坐标意味着动能中的质量为单位质量，因此每个坐标方向上的前置因子为 $\\frac{1}{2}$。利用完备性，以及在实规范下对角导数耦合为零的事实，对于一个双态系统，这简化为\n$$\nU_{-}^{\\mathrm{DBOC}}(x,y)=\\frac{1}{2}\\left(|d_{-+}^{x}|^{2}+|d_{-+}^{y}|^{2}\\right)=\\frac{1}{2}\\,|\\mathbf{d}_{-+}(x,y)|^{2}\n=\\frac{1}{2}\\,|\\boldsymbol{\\nabla}\\theta(x,y)|^{2}.\n$$\n因此，\n$$\nU_{-}^{\\mathrm{DBOC}}(x,y)=\\frac{1}{2}\\left(\\frac{a\\,c}{2}\\frac{\\sqrt{x^{2}+y^{2}}}{a^{2}x^{2}+c^{2}y^{2}}\\right)^{2}\n=\\frac{a^{2}c^{2}}{8}\\,\\frac{x^{2}+y^{2}}{\\left(a^{2}x^{2}+c^{2}y^{2}\\right)^{2}}.\n$$\n\n这些表达式显示了锥形交叉附近非绝热耦合强度的特征性 $1/r$ 发散，以及在质量加权坐标下 DBOC 标量势相应的 $1/r^{2}$ 行为，其中 $r=\\sqrt{x^{2}+y^{2}}$。所要求的输出是闭合形式的解析表达式：\n$$\n|\\mathbf{d}_{12}(x,y)|=\\frac{a\\,c}{2}\\,\\frac{\\sqrt{x^{2}+y^{2}}}{a^{2}x^{2}+c^{2}y^{2}},\\qquad\nU_{-}^{\\mathrm{DBOC}}(x,y)=\\frac{a^{2}c^{2}}{8}\\,\\frac{x^{2}+y^{2}}{\\left(a^{2}x^{2}+c^{2}y^{2}\\right)^{2}}.\n$$\n耦合强度的单位为质量加权坐标的倒数，DBOC 的单位与哈密顿量的能量单位相同。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{a\\,c}{2}\\,\\frac{\\sqrt{x^{2}+y^{2}}}{a^{2}x^{2}+c^{2}y^{2}},  \\frac{a^{2}c^{2}}{8}\\,\\frac{x^{2}+y^{2}}{\\left(a^{2}x^{2}+c^{2}y^{2}\\right)^{2}}\\end{pmatrix}}$$", "id": "3493269"}]}