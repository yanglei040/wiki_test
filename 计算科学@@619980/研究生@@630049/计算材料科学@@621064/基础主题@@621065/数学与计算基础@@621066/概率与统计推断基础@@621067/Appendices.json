{"hands_on_practices": [{"introduction": "我们从统计推断的一个基本概念开始：量化数据中包含的关于未知参数的信息量。本练习使用材料科学中的一个常见场景——缺陷计数——来探讨这一思想。通过从第一性原理推导费雪信息 (Fisher Information) 和克拉默-拉奥下界 (Cramér–Rao Lower Bound)，您将对任何无偏估计量的理论最高精度有一个具体的理解，这是评估模型质量的基石 [@problem_id:3480528]。", "problem": "在一项关于薄膜可靠性的计算材料科学研究中，假设缺陷在薄膜表面根据空间均匀的泊松点过程成核，其速率参数为每单位面积 $\\lambda$。采集了一组 $m$ 个独立的扫描电子显微镜 (SEM) 显微照片，其面积分别为 $a_{1},a_{2},\\dots,a_{m}$，在每张显微照片 $i$ 上，观测到的缺陷计数为 $x_{i}$。在泊松点过程的假设下，计数 $x_{i}$ 被建模为均值为 $\\lambda a_{i}$ 的泊松随机变量。\n\n从泊松概率质量函数、独立观测的似然函数、对数似然函数以及作为对数似然函数关于参数的负二阶导数的期望值的费雪信息的基​​本定义出发，推导包含在 $m$ 个观测值 $\\{x_{i}\\}_{i=1}^{m}$（具有已知面积 $\\{a_{i}\\}_{i=1}^{m}$）中关于 $\\lambda$ 的费雪信息 $I(\\lambda)$ 的解析表达式。然后，利用克拉默-拉奥下界 (CRLB) 的定义，推导在此模型下 $\\lambda$ 的任何无偏估计量的最小可实现方差的闭式表达式。\n\n将您的最终结果表示为解析表达式。无需四舍五入，最终表达式中不应包含单位。", "solution": "用户希望我解决这个问题。\n\n### 第 1 步：提取已知条件\n- 空间均匀的泊松点过程控制缺陷成核，速率参数为每单位面积 $\\lambda$。\n- 采集了一组 $m$ 个独立的扫描电子显微镜 (SEM) 显微照片。\n- 显微照片的面积为 $a_{1}, a_{2}, \\dots, a_{m}$。\n- 在显微照片 $i$ 上的观测缺陷计数为 $x_{i}$。\n- 计数 $x_{i}$ 是一个均值为 $\\lambda a_{i}$ 的泊松随机变量。\n- 推导观测值 $\\{x_{i}\\}_{i=1}^{m}$ 的费雪信息 $I(\\lambda)$。\n- 推导 $\\lambda$ 的任何无偏估计量的最小可实现方差的克拉默-拉奥下界 (CRLB)。\n\n### 第 2 步：使用提取的已知条件进行验证\n这个问题在科学上和数学上都是合理的。使用泊松点过程来建模缺陷是材料科学及相关领域中一种标准且成熟的方法。统计模型定义清晰：来自泊松分布的 $m$ 个独立观测值，其均值与已知面积成正比。所提出的问题——推导费雪信息和克拉默-拉奥下界——是统计推断中的标准任务，且提法恰当。该问题是自洽的、客观的，并且不违反任何基本原则。没有矛盾、歧义或信息缺失。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解决方案。\n\n推导过程按要求从基本定义开始。\n\n首先，我们为单个观测值 $x_i$ 定义概率质量函数 (PMF)。问题指出 $x_i$ 服从均值为 $\\mu_i = \\lambda a_i$ 的泊松分布。对于均值为 $\\mu$ 的泊松随机变量 $X$，其 PMF 由 $P(X=k) = \\frac{\\exp(-\\mu)\\mu^k}{k!}$ 给出。因此，对于我们的观测值 $x_i$，其 PMF 为：\n$$ P(X_i = x_i | \\lambda) = \\frac{\\exp(-\\lambda a_i) (\\lambda a_i)^{x_i}}{x_i!} $$\n我们感兴趣的参数是 $\\lambda$，而面积 $a_i$ 是已知常数。\n\n接下来，我们为这组 $m$ 个独立观测值 $\\{x_i\\}_{i=1}^{m}$ 构建似然函数 $L(\\lambda)$。由于观测值是独立的，总似然是各个概率的乘积：\n$$ L(\\lambda; \\{x_i\\}) = \\prod_{i=1}^{m} P(X_i = x_i | \\lambda) = \\prod_{i=1}^{m} \\frac{\\exp(-\\lambda a_i) (\\lambda a_i)^{x_i}}{x_i!} $$\n\n为便于数学计算，我们使用对数似然函数 $\\ell(\\lambda)$，即似然函数的自然对数：\n$$ \\ell(\\lambda) = \\ln(L(\\lambda)) = \\ln\\left(\\prod_{i=1}^{m} \\frac{\\exp(-\\lambda a_i) (\\lambda a_i)^{x_i}}{x_i!}\\right) $$\n利用对数的性质，乘积变为求和：\n$$ \\ell(\\lambda) = \\sum_{i=1}^{m} \\ln\\left(\\frac{\\exp(-\\lambda a_i) (\\lambda a_i)^{x_i}}{x_i!}\\right) = \\sum_{i=1}^{m} \\left( \\ln(\\exp(-\\lambda a_i)) + \\ln((\\lambda a_i)^{x_i}) - \\ln(x_i!) \\right) $$\n$$ \\ell(\\lambda) = \\sum_{i=1}^{m} \\left( -\\lambda a_i + x_i \\ln(\\lambda a_i) - \\ln(x_i!) \\right) $$\n我们可以将项 $\\ln(\\lambda a_i)$ 展开为 $\\ln(\\lambda) + \\ln(a_i)$：\n$$ \\ell(\\lambda) = \\sum_{i=1}^{m} \\left( -\\lambda a_i + x_i (\\ln(\\lambda) + \\ln(a_i)) - \\ln(x_i!) \\right) $$\n将各项相对于求和进行分离：\n$$ \\ell(\\lambda) = -\\lambda \\sum_{i=1}^{m} a_i + \\ln(\\lambda) \\sum_{i=1}^{m} x_i + \\sum_{i=1}^{m} x_i \\ln(a_i) - \\sum_{i=1}^{m} \\ln(x_i!) $$\n\n为了找到费雪信息，我们必须计算对数似然函数关于 $\\lambda$ 的二阶导数。首先，我们计算一阶导数（得分函数）：\n$$ \\frac{\\partial \\ell(\\lambda)}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( -\\lambda \\sum_{i=1}^{m} a_i + \\ln(\\lambda) \\sum_{i=1}^{m} x_i + \\sum_{i=1}^{m} x_i \\ln(a_i) - \\sum_{i=1}^{m} \\ln(x_i!) \\right) $$\n最后两项不依赖于 $\\lambda$，因此它们的导数为零。\n$$ \\frac{\\partial \\ell(\\lambda)}{\\partial \\lambda} = -\\sum_{i=1}^{m} a_i + \\frac{1}{\\lambda} \\sum_{i=1}^{m} x_i $$\n\n接下来，我们计算二阶导数：\n$$ \\frac{\\partial^2 \\ell(\\lambda)}{\\partial \\lambda^2} = \\frac{\\partial}{\\partial \\lambda} \\left( -\\sum_{i=1}^{m} a_i + \\frac{1}{\\lambda} \\sum_{i=1}^{m} x_i \\right) $$\n第一项是关于 $\\lambda$ 的常数。\n$$ \\frac{\\partial^2 \\ell(\\lambda)}{\\partial \\lambda^2} = -\\frac{1}{\\lambda^2} \\sum_{i=1}^{m} x_i $$\n\n费雪信息 $I(\\lambda)$ 定义为对数似然函数二阶导数的期望值的负值：\n$$ I(\\lambda) = -E\\left[\\frac{\\partial^2 \\ell(\\lambda)}{\\partial \\lambda^2}\\right] $$\n代入我们的二阶导数表达式：\n$$ I(\\lambda) = -E\\left[-\\frac{1}{\\lambda^2} \\sum_{i=1}^{m} x_i\\right] = \\frac{1}{\\lambda^2} E\\left[\\sum_{i=1}^{m} x_i\\right] $$\n根据期望的线性性质，$E\\left[\\sum_{i=1}^{m} x_i\\right] = \\sum_{i=1}^{m} E[x_i]$。问题指出 $x_i$ 是一个均值为 $\\lambda a_i$ 的泊松随机变量，所以 $E[x_i] = \\lambda a_i$。\n$$ \\sum_{i=1}^{m} E[x_i] = \\sum_{i=1}^{m} \\lambda a_i = \\lambda \\sum_{i=1}^{m} a_i $$\n将此结果代回 $I(\\lambda)$ 的表达式中：\n$$ I(\\lambda) = \\frac{1}{\\lambda^2} \\left( \\lambda \\sum_{i=1}^{m} a_i \\right) = \\frac{1}{\\lambda} \\sum_{i=1}^{m} a_i $$\n这就是费雪信息的解析表达式。\n\n最后，我们推导克拉默-拉奥下界 (CRLB)。CRLB 表明，对于参数 $\\lambda$ 的任何无偏估计量 $\\hat{\\lambda}$，其方差必须满足不等式：\n$$ \\mathrm{Var}(\\hat{\\lambda}) \\ge \\frac{1}{I(\\lambda)} $$\n因此，任何无偏估计量的最小可实现方差是费雪信息的倒数。\n$$ \\mathrm{CRLB} = \\frac{1}{I(\\lambda)} = \\frac{1}{\\frac{1}{\\lambda} \\sum_{i=1}^{m} a_i} = \\frac{\\lambda}{\\sum_{i=1}^{m} a_i} $$\n这就是 $\\lambda$ 的任何无偏估计量的最小可实现方差的闭式表达式。\n\n两个结果是费雪信息 $I(\\lambda) = \\frac{\\sum_{i=1}^{m} a_i}{\\lambda}$ 和克拉默-拉奥下界 $\\frac{\\lambda}{\\sum_{i=1}^{m} a_i}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sum_{i=1}^{m} a_i}{\\lambda} & \\frac{\\lambda}{\\sum_{i=1}^{m} a_i}\n\\end{pmatrix}\n}\n$$", "id": "3480528"}, {"introduction": "从理论极限转向实际的模型评估，本实践探讨了非线性本构模型中的参数可辨识性问题。在一个复杂的模型中，并非所有参数都能轻易地从实验数据中确定。通过一种涉及费雪信息矩阵和剖面似然的计算方法，您将学习如何诊断哪些参数是“刚性”的或“柔性”的，以及实验设计如何直接影响我们自信地校准材料模型的能力 [@problem_id:3480468]。", "problem": "给定一个一维唯象硬化定律，该定律在计算材料科学中被广泛用于描述超过初始屈服点的单调单轴塑性流动。其本构关系表示为从应变到应力的映射，其中在单调加载下，塑性应变由总应变近似。该模型为\n$$\n\\sigma(\\epsilon;\\theta) \\;=\\; \\sigma_s \\;-\\; \\big(\\sigma_s - \\sigma_0\\big)\\,e^{-b\\,\\epsilon},\n$$\n其中 $\\epsilon$ 表示应变（无量纲），$\\sigma$ 表示柯西应力（单位：兆帕），参数矢量为 $\\theta = (\\sigma_0,\\sigma_s,b)$，其中 $\\sigma_0$ 是初始流变应力（单位：兆帕），$\\sigma_s$ 是饱和应力（单位：兆帕），$b$ 是饱和速率（无量纲）。应力的测量值受到加性高斯噪声的干扰，因此观测到的应力满足\n$$\ny_i \\;=\\; \\sigma(\\epsilon_i;\\theta_{\\text{true}}) \\;+\\; \\eta_i,\\quad \\eta_i \\sim \\mathcal{N}(0,\\sigma_n^2),\n$$\n其中 $\\sigma_n$ 是测量噪声的标准差（单位：兆帕）。为了使用概率与统计推断基础进行可辨识性评估，请对单个参数使用剖面似然曲率，并对完整参数矢量使用最优实验设计准则。具体而言：\n\n- 采用高斯似然及其对数似然，并将费雪信息矩阵 (FIM) 定义为对数似然的负海森矩阵的期望值。对于上述在独立同分布高斯噪声下的模型，在 $\\theta_{\\text{true}}$ 处的 FIM 简化为\n$$\n\\mathcal{I}(\\theta_{\\text{true}}) \\;=\\; \\frac{1}{\\sigma_n^2}\\,J(\\theta_{\\text{true}})^\\top J(\\theta_{\\text{true}}),\n$$\n其中 $J(\\theta_{\\text{true}})$ 是模型 $\\sigma(\\epsilon;\\theta)$ 关于 $\\theta$ 的雅可比矩阵，在 $\\theta_{\\text{true}}$ 和设计应变 $\\{\\epsilon_i\\}$ 处求值。\n\n- 为确保可辨识性度量是无量纲的，请使用参数缩放。定义一个对角缩放矩阵 $S=\\mathrm{diag}(1/s_{\\sigma_0},1/s_{\\sigma_s},1/s_b)$，并构造缩放后的雅可比矩阵 $J_s = J(\\theta_{\\text{true}})\\,S$。缩放后的费雪信息矩阵为\n$$\n\\mathcal{I}_s(\\theta_{\\text{true}}) \\;=\\; \\frac{1}{\\sigma_n^2}\\,J_s^\\top J_s.\n$$\n从 $\\mathcal{I}_s$ 计算 D-最优性准则 $D = \\det\\big(\\mathcal{I}_s\\big)$ 和 E-最优性准则 $E = \\lambda_{\\min}\\big(\\mathcal{I}_s\\big)$，其中 $\\lambda_{\\min}$ 表示最小特征值。\n\n- 对于剖面似然曲率，将 $b$ 视为目标参数，并将 $\\sigma_0, \\sigma_s$ 视为干扰参数。给定合成的无噪声数据 $y_i = \\sigma(\\epsilon_i;\\theta_{\\text{true}})$，将固定 $b$ 值的剖面平方误差和定义为\n$$\n\\mathrm{SSE}(b) \\;=\\; \\min_{\\sigma_0,\\sigma_s}\\;\\sum_{i}\\Big(\\sigma(\\epsilon_i;\\sigma_0,\\sigma_s,b) - y_i\\Big)^2,\n$$\n相应的剖面对数似然定义为\n$$\n\\ell_p(b) \\;=\\; -\\frac{1}{2\\,\\sigma_n^2}\\,\\mathrm{SSE}(b).\n$$\n通过二阶中心有限差分计算在 $b=b_{\\text{true}}$ 处的剖面对数似然曲率\n$$\n\\kappa_b \\;=\\; -\\frac{\\ell_p(b_{\\text{true}}+h) - 2\\,\\ell_p(b_{\\text{true}}) + \\ell_p(b_{\\text{true}}-h)}{h^2},\n$$\n其中 $h>0$ 是一个小的步长。该曲率是在给定设计下对 $b$ 的无量纲局部可辨识性度量。\n\n使用以下基本原理进行推导和算法设计：\n- 独立同分布观测值的高斯似然及其对数似然的定义。\n- 高斯噪声模型的费雪信息矩阵及其与均值函数雅可比矩阵的关系。\n- 通过对目标参数的每个固定值优化干扰参数来定义剖面似然。\n- 当模型对于固定的 $b$ 在干扰参数上是线性时，使用普通最小二乘法 (OLS) 作为线性回归的解。\n\n测试套件和所需数值：\n- 真实参数 $\\theta_{\\text{true}} = (\\sigma_0,\\sigma_s,b) = (\\,300.0,\\,600.0,\\,12.0\\,)$，其中应力单位为兆帕，$b$ 是无量纲的。\n- 噪声标准差 $\\sigma_n = 5.0$（单位：兆帕）。\n- 参数缩放 $s_{\\sigma_0} = 300.0$, $s_{\\sigma_s} = 600.0$, $s_b = 12.0$，以使缩放后的费雪信息矩阵是无量纲的。\n- 用于计算 $b$ 的剖面曲率的有限差分步长 $h=0.5$（无量纲）。\n- 加载路径设计（应变数组，无量纲）：\n  1. 有限早期硬化：$\\epsilon = [\\,0.0000,\\;0.0050,\\;0.0100,\\;0.0150,\\;0.0200\\,]$。\n  2. 中程硬化：$\\epsilon = [\\,0.0000,\\;0.0200,\\;0.0500,\\;0.0800,\\;0.1000\\,]$。\n  3. 宽范围饱和：$\\epsilon = [\\,0.0000,\\;0.0200,\\;0.0500,\\;0.1000,\\;0.2000\\,]$。\n\n测试套件中每个设计的任务：\n- 计算缩放后的费雪信息矩阵 $\\mathcal{I}_s(\\theta_{\\text{true}})$、D-最优性 $D$ 和 E-最优性 $E$。\n- 使用 $h=0.5$ 计算在 $b=12.0$ 处的剖面对数似然曲率 $\\kappa_b$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个设计的结果，格式为方括号内以逗号分隔的列表，顺序为\n$$\n[\\,D_1,\\,E_1,\\,\\kappa_{b,1},\\,D_2,\\,E_2,\\,\\kappa_{b,2},\\,D_3,\\,E_3,\\,\\kappa_{b,3}\\,],\n$$\n其中下标表示设计编号（$1, 2, 3$）。所有输出必须是无单位的浮点数。", "solution": "该问题被评估为有效。它在科学上基于连续介质力学和统计推断的既定原理，在数学上是适定的，提供了所有必要的数据和条件，并以客观、无歧义的语言表述。任务定义清晰，可导向唯一、可验证的解。因此，我们可以继续进行推导和计算实现。\n\n该解答需要为三种不同的实验设计（应变路径）计算两组可辨识性度量。第一组从费雪信息矩阵 (FIM) 导出，用于评估参数矢量 $\\theta = (\\sigma_0, \\sigma_s, b)$ 的整体可辨识性。第二组是剖面似然曲率，用于评估单个参数 $b$ 的局部可辨识性，同时考虑了干扰参数 $\\sigma_0$ 和 $\\sigma_s$ 的影响。\n\n唯象硬化模型由下式给出：\n$$\n\\sigma(\\epsilon;\\theta) = \\sigma_s - (\\sigma_s - \\sigma_0)e^{-b\\epsilon}\n$$\n真实参数为 $\\theta_{\\text{true}} = (\\sigma_{0,\\text{true}}, \\sigma_{s,\\text{true}}, b_{\\text{true}}) = (300.0, 600.0, 12.0)$。测量噪声的标准差为 $\\sigma_n = 5.0$。\n\n首先，我们处理缩放后的费雪信息矩阵 $\\mathcal{I}_s$ 及其相关的最优性准则 $D$ 和 $E$ 的计算。FIM 是模型关于参数的雅可比矩阵的函数。雅可比矩阵 $J$ 的元素为 $J_{ij} = \\frac{\\partial \\sigma(\\epsilon_i;\\theta)}{\\partial \\theta_j}$。$\\sigma$ 关于参数 $\\theta = (\\sigma_0, \\sigma_s, b)$ 的偏导数是：\n$$\n\\frac{\\partial \\sigma}{\\partial \\sigma_0} = e^{-b\\epsilon}\n$$\n$$\n\\frac{\\partial \\sigma}{\\partial \\sigma_s} = 1 - e^{-b\\epsilon}\n$$\n$$\n\\frac{\\partial \\sigma}{\\partial b} = (\\sigma_s - \\sigma_0)\\epsilon e^{-b\\epsilon}\n$$\n对于每个实验设计，构造一个 $N \\times 3$ 的雅可比矩阵 $J(\\theta_{\\text{true}})$，其中 $N$ 是设计中的应变点数量。$J$ 的第 $i$ 行由在应变 $\\epsilon_i$ 和真实参数 $\\theta_{\\text{true}}$ 下计算的三个偏导数组成。\n\n为确保所得度量是无量纲的，我们使用参数缩放。缩放矩阵为 $S = \\mathrm{diag}(1/s_{\\sigma_0}, 1/s_{\\sigma_s}, 1/s_b)$，缩放因子为 $s_{\\sigma_0} = 300.0$，$s_{\\sigma_s} = 600.0$ 和 $s_b = 12.0$。缩放后的雅可比矩阵为 $J_s = J(\\theta_{\\text{true}}) S$。\n\n然后按如下方式计算缩放后的费雪信息矩阵：\n$$\n\\mathcal{I}_s(\\theta_{\\text{true}}) = \\frac{1}{\\sigma_n^2} J_s^\\top J_s\n$$\n从 $\\mathcal{I}_s$ 中，我们计算两个最优性准则：\n1.  D-最优性：$D = \\det(\\mathcal{I}_s)$，它与参数的置信椭球体积有关。较大的行列式意味着更好的整体参数可辨识性。\n2.  E-最优性：$E = \\lambda_{\\min}(\\mathcal{I}_s)$，即 $\\mathcal{I}_s$ 的最小特征值。该准则与参数估计的最坏情况方差有关，并防止边缘不可辨识性。较大的最小特征值更优。\n\n其次，我们计算剖面似然曲率 $\\kappa_b$。这需要计算剖面对数似然 $\\ell_p(b)$。对于一个固定的 $b$ 值，我们必须找到使模型预测与数据之间的平方误差和 (SSE) 最小化的 $\\sigma_0$ 和 $\\sigma_s$ 的值。数据 $y$ 被指定为无噪声的，即 $y_i = \\sigma(\\epsilon_i; \\theta_{\\text{true}})$。\n该模型可以重写以突显其在 $\\sigma_0$ 和 $\\sigma_s$ 上的线性：\n$$\n\\sigma(\\epsilon_i; \\sigma_0, \\sigma_s, b) = \\sigma_0 e^{-b\\epsilon_i} + \\sigma_s (1 - e^{-b\\epsilon_i})\n$$\n这是一个形式为 $\\mathbf{y} = X\\boldsymbol{\\beta}$ 的线性回归问题，其中 $\\mathbf{y}$ 是应力数据矢量，$\\boldsymbol{\\beta} = [\\sigma_0, \\sigma_s]^\\top$ 是干扰参数矢量，$X$ 是设计矩阵，其行为 $[e^{-b\\epsilon_i}, 1 - e^{-b\\epsilon_i}]$。$\\boldsymbol{\\beta}$ 的普通最小二乘法 (OLS) 解为 $\\hat{\\boldsymbol{\\beta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}$。\n\n对于给定的 $b$，找到最优解 $\\hat{\\boldsymbol{\\beta}}(b) = [\\hat{\\sigma}_0(b), \\hat{\\sigma}_s(b)]^\\top$ 后，剖面平方误差和为：\n$$\n\\mathrm{SSE}(b) = \\sum_{i} \\left( y_i - \\sigma(\\epsilon_i; \\hat{\\sigma}_0(b), \\hat{\\sigma}_s(b), b) \\right)^2\n$$\n剖面对数似然则为 $\\ell_p(b) = -\\frac{1}{2\\sigma_n^2} \\mathrm{SSE}(b)$。我们注意到，当 $b = b_{\\text{true}}$ 时，由于数据是无噪声的，OLS 解将是 $\\hat{\\sigma}_0 = \\sigma_{0,\\text{true}}$ 和 $\\hat{\\sigma}_s = \\sigma_{s,\\text{true}}$。这导致 $\\mathrm{SSE}(b_{\\text{true}}) = 0$，因此 $\\ell_p(b_{\\text{true}}) = 0$。\n\n在 $b=b_{\\text{true}}$ 处的曲率 $\\kappa_b$ 使用步长 $h=0.5$ 的二阶中心有限差分计算：\n$$\n\\kappa_b = -\\frac{\\ell_p(b_{\\text{true}}+h) - 2\\ell_p(b_{\\text{true}}) + \\ell_p(b_{\\text{true}}-h)}{h^2} = -\\frac{\\ell_p(b_{\\text{true}}+h) + \\ell_p(b_{\\text{true}}-h)}{h^2}\n$$\n该曲率衡量了似然函数在 $b$ 的真实值附近达到峰值的尖锐程度，表明在给定的应变路径下，从数据中辨识 $b$ 的优劣程度。曲率越高，可辨识性越好。\n\n对提供的三种应变路径设计中的每一种都执行此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes identifiability metrics for a phenomenological hardening law\n    based on Fisher information and profile likelihood.\n    \"\"\"\n\n    # --- Problem Constants ---\n    # True parameters: sigma_0, sigma_s, b\n    theta_true = np.array([300.0, 600.0, 12.0])\n    # Noise standard deviation\n    sigma_n = 5.0\n    # Finite difference step for profile curvature\n    h_b = 0.5\n    # Parameter scaling factors for dimensionless FIM\n    s_factors = np.array([300.0, 600.0, 12.0])\n    scaling_matrix = np.diag(1.0 / s_factors)\n\n    # --- Test Suite: Experimental Designs (Strain Paths) ---\n    test_cases = [\n        # Design 1: Limited early hardening\n        np.array([0.0000, 0.0050, 0.0100, 0.0150, 0.0200]),\n        # Design 2: Mid-range hardening\n        np.array([0.0000, 0.0200, 0.0500, 0.0800, 0.1000]),\n        # Design 3: Wide-range saturation\n        np.array([0.0000, 0.0200, 0.0500, 0.1000, 0.2000]),\n    ]\n\n    results = []\n    \n    sigma0_true, sigmas_true, b_true = theta_true\n\n    for eps_design in test_cases:\n        # --- Part 1: Fisher Information Matrix  Optimality Criteria ---\n        \n        # Jacobian matrix J = [d(sigma)/d(sigma_0), d(sigma)/d(sigma_s), d(sigma)/d(b)]\n        J = np.zeros((len(eps_design), 3))\n        exp_term = np.exp(-b_true * eps_design)\n        \n        # Column 1: d(sigma)/d(sigma_0)\n        J[:, 0] = exp_term\n        # Column 2: d(sigma)/d(sigma_s)\n        J[:, 1] = 1.0 - exp_term\n        # Column 3: d(sigma)/d(b)\n        J[:, 2] = (sigmas_true - sigma0_true) * eps_design * exp_term\n\n        # Scaled Jacobian\n        J_s = J @ scaling_matrix\n\n        # Scaled Fisher Information Matrix\n        I_s = (1.0 / sigma_n**2) * (J_s.T @ J_s)\n\n        # D-optimality: determinant of I_s\n        D_opt = np.linalg.det(I_s)\n\n        # E-optimality: minimum eigenvalue of I_s\n        # Use eigvalsh for symmetric matrices\n        eigenvalues = np.linalg.eigvalsh(I_s)\n        E_opt = np.min(eigenvalues)\n\n        # --- Part 2: Profile Likelihood Curvature for b ---\n\n        # Noise-free stress data\n        # y_true = sigma(eps; theta_true)\n        y_true = sigmas_true - (sigmas_true - sigma0_true) * np.exp(-b_true * eps_design)\n        \n        def get_profile_log_likelihood(b_val):\n            \"\"\"\n            Calculates the profile log-likelihood for a given b by\n            optimizing over sigma_0 and sigma_s via OLS.\n            \"\"\"\n            # Design matrix for linear regression in (sigma_0, sigma_s)\n            # X_ij = [exp(-b*eps_i), 1 - exp(-b*eps_i)]\n            X = np.zeros((len(eps_design), 2))\n            exp_term_b = np.exp(-b_val * eps_design)\n            X[:, 0] = exp_term_b\n            X[:, 1] = 1.0 - exp_term_b\n\n            # OLS solution for beta = [sigma_0, sigma_s]\n            # beta_hat = (X.T @ X)^-1 @ X.T @ y\n            try:\n                # Add a small regularization term for stability if needed, though unlikely here.\n                # C = X.T @ X + 1e-15 * np.eye(2)\n                C = X.T @ X\n                beta_hat = np.linalg.inv(C) @ X.T @ y_true\n            except np.linalg.LinAlgError:\n                # In case of singularity, return a large negative number\n                return -np.inf\n            \n            # Predicted stress values with optimal sigma_0, sigma_s\n            y_pred = X @ beta_hat\n            \n            # Sum of squared errors\n            sse = np.sum((y_true - y_pred)**2)\n            \n            # Profile log-likelihood\n            return -sse / (2.0 * sigma_n**2)\n            \n        # Calculate profile log-likelihood at b_true +- h\n        # Note: ell_p(b_true) is 0 because data is noise-free\n        ell_p_plus_h = get_profile_log_likelihood(b_true + h_b)\n        ell_p_minus_h = get_profile_log_likelihood(b_true - h_b)\n\n        # Curvature using central finite difference\n        kappa_b = -(ell_p_plus_h + ell_p_minus_h) / h_b**2\n        \n        results.extend([D_opt, E_opt, kappa_b])\n\n    # Format the final output string\n    # E.g., \"[D1,E1,kappa1,D2,E2,kappa2,...]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3480468"}, {"introduction": "真实世界的数据，特别是来自像分子动力学模拟这样的数据源，很少符合独立同分布的理想情况。最后一个实践直面在估计弹性模量等材料属性时，由离群值和时间相关噪声带来的挑战。您将实现一个稳健的M估计量来处理离群值，并计算一个能正确考虑自相关的“三明治”方差，从而掌握分析复杂模拟和实验数据所必需的现代统计工具 [@problem_id:3480531]。", "problem": "考虑一个在等间隔时间步长 $t=1,\\dots,n$ 下产生应变 $\\varepsilon_t$ 和柯西应力 $\\sigma_t$ 时间序列的小应变单轴加载分子动力学 (MD) 实验。在线性弹性区，假设本构关系为 $\\sigma_t = \\theta_0 + \\theta_1 \\varepsilon_t + u_t$，其中 $\\theta_1$ 是弹性模量，$\\theta_0$ 是一个偏移量（截距），$u_t$ 是由于热涨落和有限尺寸效应引起的平稳、均值为零、随时间变化的扰动。目标是使用基于 Huber 损失的 $M$-估计量来估计 $\\theta=(\\theta_0,\\theta_1)$，并计算时间依赖下的渐近三明治方差。\n\n使用以下基本基础：\n- 小应变下的线性弹性本构律：$\\sigma_t = \\theta_0 + \\theta_1 \\varepsilon_t + u_t$，其中 $\\varepsilon_t$ 无量纲，$\\sigma_t$ 的单位为吉帕斯卡 (GPa)。\n- $M$-估计量的定义：$\\hat\\theta$ 使得 $\\sum_{t=1}^n \\rho(u_t)$ 最小化，其中 $\\rho$ 是一个凸损失函数，这等价于求解 $\\sum_{t=1}^n g_t(\\theta)=0$，其中 $g_t(\\theta)=x_t \\psi(u_t)$，$x_t = (1,\\varepsilon_t)^\\top$，$u_t=\\sigma_t-x_t^\\top\\theta$，以及 $\\psi=\\rho'$。\n- 阈值为 $c>0$ 的 Huber 损失：若 $|u|\\le c$，则 $\\rho(u) = \\frac{1}{2}u^2$；若 $|u|>c$，则 $\\rho(u)=c|u|-\\frac{1}{2}c^2$。因此，若 $|u|\\le c$，则 $\\psi(u)=u$；若 $|u|>c$，则 $\\psi(u)=c\\,\\mathrm{sign}(u)$。并且，若 $|u|\\le c$，则 $\\psi'(u)=1$；若 $|u|>c$，则 $\\psi'(u)=0$。\n- 在弱依赖性和正则性条件下，$\\sqrt{n}(\\hat\\theta-\\theta)\\overset{d}{\\to}\\mathcal{N}(0,V)$，其三明治协方差为 $V=H^{-1}JH^{-1}$，其中 $H=\\mathbb{E}[\\psi'(u_t)x_t x_t^\\top]$，$J$ 是 $g_t(\\theta)$ 的长期协方差，它有一个使用 Bartlett 核的异方差和自相关一致性 (HAC) 估计量 (Newey–West)：$$\\hat J=\\hat\\Gamma_0 + \\sum_{\\ell=1}^{L} w_\\ell\\big(\\hat\\Gamma_\\ell + \\hat\\Gamma_\\ell^\\top\\big),\\quad w_\\ell = 1-\\frac{\\ell}{L+1},$$ 其中 $\\hat\\Gamma_\\ell=\\frac{1}{n}\\sum_{t=\\ell+1}^{n} g_t(\\hat\\theta)g_{t-\\ell}(\\hat\\theta)^\\top$，而 $\\hat H=\\frac{1}{n}\\sum_{t=1}^{n}\\psi'(u_t(\\hat\\theta))x_t x_t^\\top$。\n\n实施一个迭代重加权最小二乘程序来计算 Huber 损失的 $\\hat\\theta$：从普通最小二乘法开始，更新权重 $w_t=\\psi(u_t)/u_t$（当 $u_t=0$ 时，$w_t=1$），然后求解加权正规方程，直到参数绝对变化小于 $10^{-10}$ 或达到最大迭代次数 $100$ 次为止。\n\n您必须为以下测试套件生成合成的 MD 数据。在所有情况下，将应力单位设置为吉帕斯卡 (GPa)，应变为无量纲，并以 $\\mathrm{GPa}^2$ 为单位报告方差。扰动 $u_t$ 服从一个系数为 $\\phi$ 的 1 阶自回归过程 (AR(1))，$u_t=\\phi u_{t-1} + \\eta_t$，其中 $\\eta_t$ 是独立的随机新息。为确保 $u_t$ 的平稳标准差等于指定的 $\\sigma_u$ (单位 GPa)，设置 $\\mathrm{Var}(\\eta_t)=\\sigma_u^2(1-\\phi^2)$。对于高斯新息，使用 $\\eta_t\\sim\\mathcal{N}(0,\\sigma_u^2(1-\\phi^2))$。对于重尾新息，使用自由度为 $\\nu$ 的 Student $t$ 分布，$\\eta_t = s\\,Z_t$，$Z_t\\sim t_\\nu$，其中 $s=\\sqrt{\\sigma_u^2(1-\\phi^2)\\cdot\\frac{\\nu-2}{\\nu}}$，以使 $\\mathrm{Var}(\\eta_t)=\\sigma_u^2(1-\\phi^2)$。使用 $200$ 步的预烧期进行模拟以近似平稳性，并丢弃预烧期的数据。应变路径是在 $n$ 步内从 $0$ 到 $\\varepsilon_{\\max}$ 的线性斜坡。\n\n测试套件（每个案例都有完整规定）：\n- 案例 1：$n=500$，$\\varepsilon_{\\max}=0.01$，$\\theta_0=0.0$ GPa，$\\theta_1=70.0$ GPa，$\\phi=0.0$，$\\sigma_u=0.05$ GPa，高斯新息，Huber 阈值 $c=0.15$ GPa，HAC 带宽 $L=0$，随机种子 $101$。\n- 案例 2：$n=500$，$\\varepsilon_{\\max}=0.01$，$\\theta_0=0.0$ GPa，$\\theta_1=70.0$ GPa，$\\phi=0.6$，$\\sigma_u=0.05$ GPa，高斯新息，Huber 阈值 $c=0.15$ GPa，HAC 带宽 $L=10$，随机种子 $202$。\n- 案例 3：$n=500$，$\\varepsilon_{\\max}=0.01$，$\\theta_0=0.0$ GPa，$\\theta_1=70.0$ GPa，$\\phi=0.0$，$\\sigma_u=0.2$ GPa，自由度为 $\\nu=3$ 的 Student $t$ 新息，Huber 阈值 $c=0.10$ GPa，HAC 带宽 $L=0$，随机种子 $303$。\n- 案例 4：$n=50$，$\\varepsilon_{\\max}=0.005$，$\\theta_0=0.0$ GPa，$\\theta_1=150.0$ GPa，$\\phi=0.8$，$\\sigma_u=0.05$ GPa，高斯新息，Huber 阈值 $c=0.15$ GPa，HAC 带宽 $L=5$，随机种子 $404$。\n\n对于每个案例：\n1. 按照规定模拟 $\\varepsilon_t$ 和 $\\sigma_t$。\n2. 通过 Huber $M$-估计量计算 $\\hat\\theta=(\\hat\\theta_0,\\hat\\theta_1)$。\n3. 使用具有给定最大滞后 $L$ 的 Bartlett 核计算 HAC 三明治协方差 $\\hat V=\\hat H^{-1}\\hat J\\hat H^{-1}$。\n4. 提取并返回弹性模量估计量的方差，即 $(2,2)$ 元素 $\\hat V_{22}$，表示为 $\\mathrm{GPa}^2$ 单位的浮点数。\n\n您的程序应生成单行输出，其中包含四个案例的结果，形式为方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$）。条目必须是按顺序对应于案例 1 到 4 的四个方差 $\\hat V_{22}$。不应打印任何附加文本。", "solution": "用户请求了一个计算材料科学中涉及统计推断问题的解决方案。该问题是从模拟的分子动力学 (MD) 数据中估计材料的弹性模量，并计算此估计的方差。解决方案涉及稳健回归以及异方差和自相关一致性 (HAC) 方差估计。首先对问题陈述的正确性和完整性进行验证。\n\n**问题验证**\n\n该问题被判定为**有效**。它在科学上是合理的、适定的，并且所有必要的参数和程序都有明确定义。\n- **科学依据**：在线性应变下使用线性弹性模型（胡克定律）是固体力学的基础。将扰动项建模为平稳自回归过程 (AR(1)) 是处理 MD 模拟中热噪声的一种标准且物理上合理的方法。所采用的统计方法——用于稳健回归的 Huber $M$-估计和用于方差估计的 Newey-West HAC 估计量——在统计学和计量经济学中都是成熟的方法。所有物理参数都是现实的。\n- **适定性**：该问题为四个不同的测试案例提供了完整的规范，包括所有物理参数、统计模型参数、模拟参数（如用于可复现性的随机种子）以及计算算法细节（如收敛标准）。这确保了可以为每个案例计算出唯一且有意义的解。\n- **客观性与清晰度**：该问题以精确、技术性的语言陈述，没有歧义或主观性陈述。所有数学实体和程序都经过了形式化定义。\n\n该问题是一个精心设计的计算任务，正确地整合了材料科学、统计力学和高等统计推断的原理。\n\n**方法论**\n\n对于每个测试案例，解决方案分三个主要阶段实施：(1) 数据模拟，(2) 使用迭代重加权最小二乘法 (IRLS) 进行参数估计，以及 (3) 使用 HAC 三明治估计量进行渐近方差计算。\n\n**1. 数据模拟**\n\n生成合成数据以模拟 MD 单轴加载实验。\n- **应变路径 ($\\varepsilon_t$)**：生成一个确定性的线性应变斜坡，在 $n$ 个时间步内从 $\\varepsilon=0$ 变化到 $\\varepsilon=\\varepsilon_{\\max}$。设计矩阵 $X$ 由 1 和 $\\varepsilon_t$ 的列构成，即 $x_t^\\top = [1, \\varepsilon_t]$。\n- **扰动过程 ($u_t$)**：噪声项 $u_t$ 被模拟为一个平稳的 AR(1) 过程：$u_t = \\phi u_{t-1} + \\eta_t$。为确保平稳性，该过程从 $u_0=0$ 开始，并运行 200 个步长的预烧期，然后丢弃这些数据。新息 $\\eta_t$ 是独立同分布的随机变量。\n    - 新息的方差 $\\mathrm{Var}(\\eta_t)$ 被设置为 $\\sigma_u^2(1-\\phi^2)$，以确保 AR(1) 过程的平稳方差为 $\\mathrm{Var}(u_t) = \\sigma_u^2$。\n    - 对于高斯新息，$\\eta_t \\sim \\mathcal{N}(0, \\sigma_u^2(1-\\phi^2))$。\n    - 对于重尾新息，使用一个缩放的 Student $t$ 分布：$\\eta_t = s Z_t$，其中 $Z_t \\sim t_\\nu$，并且选择缩放因子 $s = \\sqrt{\\sigma_u^2(1-\\phi^2) (\\nu-2)/\\nu}$ 来匹配所需的方差。\n- **应力路径 ($\\sigma_t$)**：最终的应力时间序列根据线性本构关系生成：$\\sigma_t = \\theta_0 + \\theta_1 \\varepsilon_t + u_t$，使用每个案例中指定的真实参数值 $(\\theta_0, \\theta_1)$。\n\n**2. 通过 IRLS 进行 Huber M-估计**\n\n目标是找到最小化 Huber 损失之和 $\\sum_{t=1}^n \\rho(\\sigma_t - x_t^\\top\\theta)$ 的参数估计 $\\hat\\theta$。这等价于求解估计方程 $\\sum_{t=1}^n x_t \\psi(\\sigma_t - x_t^\\top\\theta) = 0$，其中 $\\psi = \\rho'$ 是 Huber 得分函数。这个非线性系统通过迭代重加权最小二乘 (IRLS) 算法求解。\n\nIRLS 算法过程如下：\n1. 使用普通最小二乘法 (OLS) 对数据 $(\\sigma_t, x_t)$ 获得初始估计 $\\hat\\theta^{(0)}$。\n2. 对于每次迭代 $k=1, 2, \\dots$：\n    a. 计算残差：$u_t^{(k-1)} = \\sigma_t - x_t^\\top\\hat\\theta^{(k-1)}$。\n    b. 计算权重：$w_t^{(k-1)} = \\psi(u_t^{(k-1)}) / u_t^{(k-1)}$。Huber 得分函数是 $\\psi(u) = \\mathrm{clip}(u, -c, c)$。对于 $|u_t| \\le c$ 的观测值，权重为 $w_t=1$（给予这些观测值与 OLS 中相同的完全权重）；对于 $|u_t| > c$ 的观测值，权重为 $w_t=c/|u_t|$（对离群值降权）。对于 $u_t=0$，极限权重为 1。\n    c. 通过求解加权正规方程来更新参数 $\\hat\\theta^{(k)}$：\n        $$ (X^\\top W^{(k-1)} X) \\hat\\theta^{(k)} = X^\\top W^{(k-1)} Y $$\n        其中 $Y$ 是应力 $\\sigma_t$ 的向量，$W^{(k-1)}$ 是权重 $w_t^{(k-1)}$ 的对角矩阵。\n3. 迭代持续进行，直到参数向量的最大绝对变化 $\\|\\hat\\theta^{(k)} - \\hat\\theta^{(k-1)}\\|_\\infty$ 小于 $10^{-10}$ 的容差，或者达到 100 次的最大迭代次数。\n\n**3. 渐近方差计算**\n\n在正则性条件下，估计量 $\\hat\\theta$ 是渐近正态的，$\\sqrt{n}(\\hat\\theta - \\theta)$ 依分布收敛于 $\\mathcal{N}(0, V)$。渐近协方差矩阵 $V$ 具有“三明治”形式，$V = H^{-1} J H^{-1}$。我们计算其经验估计 $\\hat V = \\hat H^{-1} \\hat J \\hat H^{-1}$。\n\n- **“面包”矩阵 ($\\hat H$)**：矩阵 $H = \\mathbb{E}[\\psi'(u_t)x_t x_t^\\top]$ 通过其样本模拟来估计：\n    $$ \\hat H = \\frac{1}{n} \\sum_{t=1}^n \\psi'(\\hat u_t) x_t x_t^\\top $$\n    其中 $\\hat u_t = \\sigma_t - x_t^\\top\\hat\\theta$ 是最终残差。对于 Huber 函数，$\\psi'(u)$ 是一个指示函数 $\\mathbb{I}(|u| \\le c)$。\n\n- **“肉”矩阵 ($\\hat J$)**：矩阵 $J$ 是矩条件得分 $g_t(\\theta) = x_t \\psi(u_t)$ 的长期方差。它使用 Newey and West 的异方差和自相关一致性 (HAC) 估计量和 Bartlett 核进行估计：\n    $$ \\hat J = \\hat\\Gamma_0 + \\sum_{\\ell=1}^{L} w_\\ell \\left( \\hat\\Gamma_\\ell + \\hat\\Gamma_\\ell^\\top \\right) $$\n    其中：\n    - Bartlett 权重为 $w_\\ell = 1 - \\frac{\\ell}{L+1}$。\n    - 滞后 $L$ 是指定的带宽。\n    - 样本自协方差矩阵为 $\\hat\\Gamma_\\ell = \\frac{1}{n} \\sum_{t=\\ell+1}^n g_t(\\hat\\theta) g_{t-\\ell}(\\hat\\theta)^\\top$。\n\n最终需要的量是弹性模量估计量的方差，指定为计算出的矩阵 $\\hat V$ 的 $(2,2)$ 元素。该值 $\\hat V_{22}$ 的单位按要求为 $(\\text{GPa})^2$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t as student_t\n\ndef huber_psi(u, c):\n    \"\"\"Huber score function psi(u).\"\"\"\n    return np.clip(u, -c, c)\n\ndef huber_psi_prime(u, c):\n    \"\"\"Derivative of Huber score function psi'(u).\"\"\"\n    return (np.abs(u) = c).astype(float)\n\ndef huber_weights(u, c):\n    \"\"\"IRLS weights psi(u)/u.\"\"\"\n    with np.errstate(divide='ignore', invalid='ignore'):\n        weights = huber_psi(u, c) / u\n    # The limit of psi(u)/u as u -> 0 is 1.\n    weights[u == 0] = 1.0\n    return weights\n\ndef calculate_huber_m_estimator(X, y, c, max_iter=100, tol=1e-10):\n    \"\"\"\n    Computes Huber M-estimator using Iteratively Reweighted Least Squares (IRLS).\n    \"\"\"\n    # Initial estimate using Ordinary Least Squares (OLS)\n    try:\n        theta = np.linalg.lstsq(X, y, rcond=None)[0]\n    except np.linalg.LinAlgError:\n        theta = np.linalg.pinv(X) @ y\n    \n    for _ in range(max_iter):\n        theta_old = theta.copy()\n        \n        u = y - X @ theta\n        w = huber_weights(u, c)\n        \n        # Solve weighted least squares: (X.T W X) theta = X.T W y\n        X_w = X * w[:, np.newaxis]\n        XT_X_w = X.T @ X_w\n        XT_y_w = X_w.T @ y\n        \n        try:\n            theta = np.linalg.solve(XT_X_w, XT_y_w)\n        except np.linalg.LinAlgError:\n            # Fallback to pseudo-inverse if matrix is singular\n            theta = np.linalg.pinv(XT_X_w) @ XT_y_w\n\n        if np.max(np.abs(theta - theta_old))  tol:\n            break\n            \n    return theta\n\ndef calculate_hac_variance(X, y, theta_hat, c, L):\n    \"\"\"\n    Computes the HAC sandwich covariance matrix V = H^-1 J H^-1.\n    \"\"\"\n    n, p = X.shape\n    u_hat = y - X @ theta_hat\n    \n    # --- Compute H_hat = (1/n) * sum(psi'(u_t) * x_t * x_t.T) ---\n    psi_prime_vals = huber_psi_prime(u_hat, c)\n    H_hat = (X.T * psi_prime_vals) @ X / n\n\n    # --- Compute J_hat (Newey-West) ---\n    # g_t = x_t * psi(u_t), stored as n x p matrix g_hat where each row is g_t.T\n    psi_vals = huber_psi(u_hat, c)\n    g_hat = X * psi_vals[:, np.newaxis]\n\n    # Gamma_0\n    J_hat = (g_hat.T @ g_hat) / n\n\n    if L > 0:\n        for l in range(1, L + 1):\n            w_l = 1 - l / (L + 1)\n            # Gamma_l = (1/n) * sum_{t=l+1 to n} g_t * g_{t-l}.T\n            # This is computed efficiently using vectorized operations.\n            Gamma_l = (g_hat[l:].T @ g_hat[:-l]) / n\n            J_hat += w_l * (Gamma_l + Gamma_l.T)\n            \n    # --- Compute V_hat sandwich covariance ---\n    try:\n        H_hat_inv = np.linalg.inv(H_hat)\n    except np.linalg.LinAlgError:\n        H_hat_inv = np.linalg.pinv(H_hat)\n        \n    V_hat = H_hat_inv @ J_hat @ H_hat_inv\n    \n    return V_hat\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        {'n': 500, 'eps_max': 0.01, 'theta0': 0.0, 'theta1': 70.0, 'phi': 0.0, 'sigma_u': 0.05, \n         'innov': 'gaussian', 'nu': None, 'c': 0.15, 'L': 0, 'seed': 101},\n        {'n': 500, 'eps_max': 0.01, 'theta0': 0.0, 'theta1': 70.0, 'phi': 0.6, 'sigma_u': 0.05, \n         'innov': 'gaussian', 'nu': None, 'c': 0.15, 'L': 10, 'seed': 202},\n        {'n': 500, 'eps_max': 0.01, 'theta0': 0.0, 'theta1': 70.0, 'phi': 0.0, 'sigma_u': 0.2, \n         'innov': 'student_t', 'nu': 3, 'c': 0.10, 'L': 0, 'seed': 303},\n        {'n': 50, 'eps_max': 0.005, 'theta0': 0.0, 'theta1': 150.0, 'phi': 0.8, 'sigma_u': 0.05, \n         'innov': 'gaussian', 'nu': None, 'c': 0.15, 'L': 5, 'seed': 404},\n    ]\n\n    results = []\n    burn_in_steps = 200\n\n    for case in test_cases:\n        n, eps_max = case['n'], case['eps_max']\n        theta_true = np.array([case['theta0'], case['theta1']])\n        phi, sigma_u = case['phi'], case['sigma_u']\n        innov_type, nu = case['innov'], case['nu']\n        c, L, seed = case['c'], case['L'], case['seed']\n        \n        rng = np.random.default_rng(seed)\n        \n        # 1. Simulate data\n        eps = np.linspace(0, eps_max, n)\n        X = np.vstack((np.ones(n), eps)).T\n        \n        total_len = n + burn_in_steps\n        \n        if innov_type == 'gaussian':\n            var_eta = sigma_u**2 * (1 - phi**2)\n            std_eta = np.sqrt(var_eta)\n            eta = rng.normal(0, std_eta, total_len)\n        else: # student_t\n            scale = np.sqrt(sigma_u**2 * (1 - phi**2) * ((nu - 2) / nu))\n            eta = scale * student_t.rvs(df=nu, size=total_len, random_state=rng)\n        \n        u_full = np.zeros(total_len)\n        for t in range(1, total_len):\n            u_full[t] = phi * u_full[t-1] + eta[t]\n        \n        u = u_full[burn_in_steps:]\n        sigma = X @ theta_true + u\n        \n        # 2. Compute Huber M-estimator\n        theta_hat = calculate_huber_m_estimator(X, sigma, c)\n        \n        # 3. Compute HAC sandwich covariance\n        V_hat = calculate_hac_variance(X, sigma, theta_hat, c, L)\n        \n        # 4. Extract variance of elastic modulus estimator (V_hat_22)\n        var_theta1 = V_hat[1, 1]\n        results.append(var_theta1)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3480531"}]}