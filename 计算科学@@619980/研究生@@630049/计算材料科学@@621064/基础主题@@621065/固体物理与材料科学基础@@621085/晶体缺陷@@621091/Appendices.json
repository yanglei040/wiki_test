{"hands_on_practices": [{"introduction": "位错之间的相互作用力是理解和预测材料塑性变形行为（如加工硬化）的基础。Peach-Koehler公式为我们提供了连接连续介质应力场与位错线上所受作用力的理论桥梁。通过这个实践练习[@problem_id:3441596]，您将从各向同性弹性理论的基本应力场出发，推导两条平行位错之间的相互作用力，从而巩固对位错应力场及其相互作用的理解，这是更复杂的位错动力学模拟等高级模型的基石。", "problem": "考虑一个各向同性的线性弹性晶体，其剪切模量为 $\\mu$，泊松比为 $\\nu$。两条平行的直位错沿 $z$ 轴分布，位错线方向为 $\\boldsymbol{\\xi} = \\hat{\\boldsymbol{z}}$。它们的中心分别位于 $(x,y) = (0,0)$ 和 $(x,y) = (d,0)$，其中 $d>0$ 是它们在平面内的间距。两条位错的伯格斯矢量大小均为 $b$，但通常情况下，它们的伯格斯矢量既非纯螺型也非纯刃型。设位错特征角 $\\chi \\in [0,\\pi/2]$ 定义为伯格斯矢量与位错线方向之间的夹角，因此 $\\chi = 0$ 对应螺型位错，$\\chi = \\pi/2$ 对应刃型位错。第一个位错的伯格斯矢量为 $\\boldsymbol{b} = b \\left(\\sin\\chi\\,\\hat{\\boldsymbol{x}} + \\cos\\chi\\,\\hat{\\boldsymbol{z}}\\right)$，而第二个位错的伯格斯矢量为 $\\boldsymbol{b}_2 = s\\,\\boldsymbol{b}$，其中 $s \\in \\{+1,-1\\}$ 表示同号（$s=+1$）或异号（$s=-1$）位错。\n\n施加一个大小为 $\\tau_a$ 的均匀外部分解剪应力，使得作用于每单位长度位错上的外加 Peach–Koehler 滑移力沿 $-\\hat{\\boldsymbol{x}}$ 方向，大小为 $\\tau_a b$。仅使用连续介质弹性和位错理论的基本定义，推导两条位错之间的单位长度 Peach–Koehler 力，使其成为 $d$、$s$ 和 $\\chi$ 的函数，并确定在施加应力 $\\tau_a$ 的情况下，在有限间距 $d$ 处形成力学稳定偶极子的条件。您的推导必须从各向同性弹性理论中直位错的应力场和 Peach–Koehler 力的定义出发，并且必须清楚地说明位错特征是如何影响结果的。\n\n通过相互作用力与外加滑移力之间的平衡，定义在施加应力 $\\tau_a$ 下的平衡（临界）间距 $d_c$。令 $g(\\chi,\\nu)$ 为以下封闭形式关系式中的无量纲因子：\n$$\nd_c \\;=\\; \\frac{\\mu\\,b}{2\\pi\\,\\tau_a}\\,g(\\chi,\\nu).\n$$\n将 $g(\\chi,\\nu)$ 作为您的最终答案。最终答案必须是单一的封闭形式解析表达式且无量纲。在您的解答中，还需定性地说明在何种条件下（i）可以存在稳定的偶极子，以及（ii）位错对会湮灭或分离，这些条件应是 $s$、$d$ 和 $\\chi$ 的函数。", "solution": "我们从单位长度 Peach–Koehler 力的定义开始。对于位错线方向为 $\\boldsymbol{\\xi}$、伯格斯矢量为 $\\boldsymbol{b}$ 的直位错，在应力场 $\\boldsymbol{\\sigma}$ 中，其单位长度上的 Peach–Koehler 力为\n$$\n\\boldsymbol{f} \\;=\\; (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})\\times\\boldsymbol{\\xi}.\n$$\n此处，$(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})_i = \\sum_{j}\\sigma_{ij} b_j$ 是应力张量与伯格斯矢量缩并成一个矢量的运算。\n\n由于介质是各向同性且线性弹性的，我们可以使用经过充分验证的直位错应力场。我们将第二个位错放置在 $(x,y)=(d,0)$ 处，并计算其在第一个位错位置 $(0,0)$ 处的应力场。用 $(x',y')=(x-d, y-0)$ 表示场点相对于第二个位错的相对坐标，因此在第一个位错处，$(x',y')=(-d,0)$。我们将伯格斯矢量相对于 $\\boldsymbol{\\xi}=\\hat{\\boldsymbol{z}}$ 分解为螺型分量和刃型分量：\n$$\nb_{\\text{s}} \\;=\\; b\\cos\\chi,\\qquad b_{\\text{e}} \\;=\\; b\\sin\\chi,\n$$\n并写作 $\\boldsymbol{b} = b_{\\text{e}}\\,\\hat{\\boldsymbol{x}} + b_{\\text{s}}\\,\\hat{\\boldsymbol{z}}$。源位错的伯格斯矢量为 $\\boldsymbol{b}_2 = s\\,\\boldsymbol{b}$，因此其螺型和刃型分量分别为 $s\\,b_{\\text{s}}$ 和 $s\\,b_{\\text{e}}$。\n\n对于位于原点、伯格斯矢量大小为 $b_{\\text{s}}$ 的直螺型位错（位错线沿 $\\hat{\\boldsymbol{z}}$ 方向），其在笛卡尔坐标系中的非零应力分量为\n$$\n\\sigma_{xz} \\;=\\; -\\frac{\\mu\\,b_{\\text{s}}}{2\\pi}\\,\\frac{y}{x^2+y^2},\\qquad\n\\sigma_{yz} \\;=\\; \\frac{\\mu\\,b_{\\text{s}}}{2\\pi}\\,\\frac{x}{x^2+y^2}.\n$$\n对于位于原点、伯格斯矢量大小为 $b_{\\text{e}}$ 且沿 $\\hat{\\boldsymbol{x}}$ 方向的直刃型位错（位错线沿 $\\hat{\\boldsymbol{z}}$ 方向），其非零的平面内应力分量为\n$$\n\\sigma_{xx} \\;=\\; -\\frac{\\mu\\,b_{\\text{e}}}{2\\pi(1-\\nu)}\\,\\frac{y\\,(3x^2+y^2)}{(x^2+y^2)^2},\\quad\n\\sigma_{yy} \\;=\\; \\frac{\\mu\\,b_{\\text{e}}}{2\\pi(1-\\nu)}\\,\\frac{y\\,(x^2-y^2)}{(x^2+y^2)^2},\\quad\n\\sigma_{xy} \\;=\\; \\frac{\\mu\\,b_{\\text{e}}}{2\\pi(1-\\nu)}\\,\\frac{x\\,(x^2-y^2)}{(x^2+y^2)^2}.\n$$\n根据线性叠加原理，混合型位错的应力是螺型和刃型贡献的总和，其中分别使用相应的 $b_{\\text{s}}$ 和 $b_{\\text{e}}$。在 $(x',y')=(-d,0)$ 处，唯一的非零分量是\n$$\n\\sigma_{yz}^{(s)}(x',y') \\;=\\; \\frac{\\mu\\,(s\\,b_{\\text{s}})}{2\\pi}\\,\\frac{x'}{x'^2+y'^2}\n\\;=\\; \\frac{\\mu\\,(s\\,b_{\\text{s}})}{2\\pi}\\,\\frac{-d}{d^2}\n\\;=\\; -\\,\\frac{\\mu\\,s\\,b_{\\text{s}}}{2\\pi\\,d},\n$$\n和\n$$\n\\sigma_{xy}^{(e)}(x',y') \\;=\\; \\frac{\\mu\\,(s\\,b_{\\text{e}})}{2\\pi(1-\\nu)}\\,\\frac{x'(x'^2-y'^2)}{(x'^2+y'^2)^2}\n\\;=\\; \\frac{\\mu\\,(s\\,b_{\\text{e}})}{2\\pi(1-\\nu)}\\,\\frac{(-d)\\,d^2}{d^4}\n\\;=\\; -\\,\\frac{\\mu\\,s\\,b_{\\text{e}}}{2\\pi(1-\\nu)\\,d}.\n$$\n所有其他分量在 $y'=0$ 处均为零。\n\n现在，对于承受第二个位错应力的第一个位错，我们计算 $(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})$：\n$$\n(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})_x \\;=\\; \\sigma_{xx}\\,b_x + \\sigma_{xy}\\,b_y + \\sigma_{xz}\\,b_z \\;=\\; 0,\n$$\n$$\n(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})_y \\;=\\; \\sigma_{yx}\\,b_x + \\sigma_{yy}\\,b_y + \\sigma_{yz}\\,b_z \\;=\\; \\sigma_{xy}\\,b_{\\text{e}} + \\sigma_{yz}\\,b_{\\text{s}},\n$$\n$$\n(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})_z \\;=\\; \\sigma_{zx}\\,b_x + \\sigma_{zy}\\,b_y + \\sigma_{zz}\\,b_z \\;=\\; 0,\n$$\n这里使用了对称性 $\\sigma_{yx}=\\sigma_{xy}$ 以及上文提到的零分量。因此\n$$\n\\boldsymbol{f} \\;=\\; (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})\\times\\hat{\\boldsymbol{z}}\n\\;=\\; \\big[(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{b})_y\\big]\\,\\hat{\\boldsymbol{y}}\\times\\hat{\\boldsymbol{z}}\n\\;=\\; \\big(\\sigma_{xy}\\,b_{\\text{e}} + \\sigma_{yz}\\,b_{\\text{s}}\\big)\\,\\hat{\\boldsymbol{x}}.\n$$\n代入应力分量，\n$$\nf_x(d,\\chi,s) \\;=\\; \\left(-\\,\\frac{\\mu\\,s\\,b_{\\text{e}}}{2\\pi(1-\\nu)\\,d}\\right)b_{\\text{e}} \\;+\\; \\left(-\\,\\frac{\\mu\\,s\\,b_{\\text{s}}}{2\\pi\\,d}\\right)b_{\\text{s}}\n\\;=\\; -\\,\\frac{\\mu\\,s}{2\\pi\\,d}\\left(\\frac{b_{\\text{e}}^{2}}{1-\\nu} + b_{\\text{s}}^{2}\\right).\n$$\n用特征角表示，\n$$\nb_{\\text{e}} = b\\sin\\chi,\\qquad b_{\\text{s}} = b\\cos\\chi,\n$$\n所以\n$$\nf_x(d,\\chi,s) \\;=\\; -\\,\\frac{\\mu\\,s\\,b^2}{2\\pi\\,d}\\left(\\frac{\\sin^{2}\\chi}{1-\\nu} + \\cos^{2}\\chi\\right).\n$$\n这表明，对于 $s=-1$（异号），相互作用是吸引力（$f_x > 0$，指向位于 $x=d$ 的第二个位错），而对于 $s=+1$（同号），相互作用是排斥力（$f_x < 0$，远离第二个位错）。\n\n现在考虑均匀外部分解剪应力 $\\tau_a$，其选择使得作用于每单位长度位错上的外加 Peach–Koehler 滑移力沿 $-\\hat{\\boldsymbol{x}}$ 方向，大小为 $\\tau_a b$。在有限间距处形成力学稳定偶极子的净力平衡条件要求，相互吸引力必须与外加滑移力完全平衡，因此在平衡时（对于 $s=-1$），\n$$\n\\frac{\\mu\\,b^2}{2\\pi\\,d_c}\\left(\\frac{\\sin^{2}\\chi}{1-\\nu} + \\cos^{2}\\chi\\right) \\;=\\; \\tau_a\\,b.\n$$\n解出 $d_c$ 可得\n$$\nd_c \\;=\\; \\frac{\\mu\\,b}{2\\pi\\,\\tau_a}\\left(\\frac{\\sin^{2}\\chi}{1-\\nu} + \\cos^{2}\\chi\\right).\n$$\n因此，所求的无量纲因子 $g(\\chi,\\nu)$ 是\n$$\ng(\\chi,\\nu) \\;=\\; \\cos^{2}\\chi \\;+\\; \\frac{1}{1-\\nu}\\,\\sin^{2}\\chi.\n$$\n\n定性条件：\n- 对于 $s=-1$（异号），相互作用力是吸引力。在指定的外加应力方向下，仅当 $d=d_c$ 时才能存在力学稳定的偶极子。如果 $d < d_c$，相互吸引力超过外加的抵抗力，位错对将向一起移动，并在忽略位错核心势垒的情况下，当 $d\\to 0$ 时发生湮灭。如果 $d > d_c$，外加应力占主导地位，位错对将分离（不存在束缚偶极子）。\n- 对于 $s=+1$（同号），对于所有 $d$ 和任何 $\\chi$，相互作用力都是排斥力，因此在指定的外加应力下无法形成稳定的偶极子；除非有其他障碍物或微观结构约束的干预，否则该位错对将分离。\n\n特征角 $\\chi$ 通过 $g(\\chi,\\nu)$ 调节相互作用：刃型特征（$\\chi=\\pi/2$）将吸引力增强了因子 $1/(1-\\nu)$，而螺型特征（$\\chi=0$）的贡献权重为单位1（$\\cos^{2}\\chi=1$），这与各向同性弹性理论一致。", "answer": "$$\\boxed{\\cos^{2}\\chi+\\frac{1}{1-\\nu}\\sin^{2}\\chi}$$", "id": "3441596"}, {"introduction": "晶体中的许多缺陷过程，例如位错的运动或相变，都是通过克服能量势垒而发生的热激活过程。为了对这些过程的动力学进行建模，关键在于确定最小能量路径（Minimum Energy Path, MEP）和相应的过渡态（鞍点）。这个练习[@problem_id:3441641]将指导您在一个简化的势能面上，应用“微动弹性带”（Nudged Elastic Band, NEB）这一计算材料科学中的核心算法，并结合机器学习集体变量来寻找螺位错交滑移的最小能量路径，进而计算其活化能和熵垒，从而提供对高级模拟技术和过渡态理论的实践经验。", "problem": "您的任务是构建一个完整的计算工作流，在一个简化且自洽的环境中，应用微动弹性带（Nudged Elastic Band, NEB）方法在机器学习集体变量空间中，寻找与螺位错的交滑移相关的最小能量路径，并量化在指定温度下的熵稳定化效应 $\\Delta S^\\ddagger(T)$。目标是实现一个具有数学原理的玩具模型，该模型既足够真实以实践算法思想，又保持解析上易于处理和数值上的稳定性。\n\n将使用的基本核心定义：\n- 在简化集体变量空间 $\\mathbf{s} = (u,v)$ 中的势能面 $U(\\mathbf{s})$ 是计算材料科学中一种经过充分检验的建模方法，用于表示缺陷机制的能量学。梯度 $\\nabla U(\\mathbf{s})$ 和Hessian矩阵 $\\mathbf{H}(\\mathbf{s}) = \\nabla^2 U(\\mathbf{s})$ 控制着局部稳定性和曲率。\n- 最小能量路径（Minimum energy path, MEP）是一条连接两个局部极小值点的连续曲线，路径上每一点都沿着垂直于路径的最陡下降方向，同时平衡一个维持路径离散化的弹性弹簧。微动弹性带（NEB）方法将此路径离散化为一系列“图像”（image），并使用一种组合了真实力 $-\\nabla U$ 的垂直分量和沿路径切线的平行弹簧力的合力，对这些图像进行迭代弛豫。\n- 在谐振子过渡态理论中，活化熵源于振动模式的统计。对于一组频率为 $\\{\\omega_i\\}$ 的谐振子模式，其在温度 $T$ 下的振动熵可以通过正则系综计算得出。在鞍点处，不稳定（虚频）模式在计算中被排除。\n\n机器学习集体变量映射：\n- 令 $\\mathbf{x} \\in \\mathbb{R}^d$ 表示位错核心状态的描述符向量。定义一个学习得到的双层前馈映射 $\\boldsymbol{\\phi} : \\mathbb{R}^d \\to \\mathbb{R}^2$，其形式为 $\\boldsymbol{\\phi}(\\mathbf{x}) = \\mathbf{W}_2 \\tanh(\\mathbf{W}_1 \\mathbf{x} + \\mathbf{b}_1) + \\mathbf{b}_2$，其中 $\\mathbf{W}_1 \\in \\mathbb{R}^{h \\times d}$，$\\mathbf{b}_1 \\in \\mathbb{R}^h$，$\\mathbf{W}_2 \\in \\mathbb{R}^{2 \\times h}$，以及 $\\mathbf{b}_2 \\in \\mathbb{R}^2$。您必须构建 $\\mathbf{W}_1$、$\\mathbf{b}_1$、$\\mathbf{W}_2$ 和 $\\mathbf{b}_2$，使得两个给定的描述符状态 $\\mathbf{x}^{(0)}$（初始）和 $\\mathbf{x}^{(1)}$（最终）映射到两个目标集体变量锚点，这两个锚点对应于不同的滑移面表示。具体地，强制要求 $\\boldsymbol{\\phi}(\\mathbf{x}^{(0)}) = (1,0)$ 和 $\\boldsymbol{\\phi}(\\mathbf{x}^{(1)}) = (0,1)$。使用 $h=5$ 和 $d=6$。您必须根据以下纯原理性约束来构建这些权重：\n  - 选择两个目标隐藏层向量 $\\mathbf{y}^{(0)}, \\mathbf{y}^{(1)} \\in (-1,1)^h$ 并令 $\\mathbf{z}^{(k)} = \\operatorname{arctanh}(\\mathbf{y}^{(k)})$，其中 $k \\in \\{0,1\\}$。对于每个隐藏单元 $j \\in \\{1,\\dots,h\\}$，求解两个线性约束 $w_j^\\top \\mathbf{x}^{(0)} + b_{1,j} = z^{(0)}_j$ 和 $w_j^\\top \\mathbf{x}^{(1)} + b_{1,j} = z^{(1)}_j$ 以得到 $(w_j,b_{1,j})$；因为有 $d+1$ 个未知数和 2 个方程，所以存在最小范数解。然后逐行求解 $\\mathbf{W}_2$，作为将 $\\mathbf{y}^{(0)}$ 映射到 $(1,0)$ 并将 $\\mathbf{y}^{(1)}$ 映射到 $(0,1)$ 的最小范数解。\n  - 设置 $\\mathbf{b}_2 = (0,0)$。\n\n集体变量空间中的势能面：\n- 定义一个具有中心势垒的、可解析处理的双阱势，该势模拟了两个滑移面盆地之间的交滑移：\n$$\nU(u,v; G_1,G_2,R,\\sigma,\\rho) = R \\exp\\!\\left(-\\frac{u^2 + v^2}{\\rho^2}\\right)\n- G_1 \\exp\\!\\left(-\\frac{(u-1)^2 + v^2}{\\sigma^2}\\right)\n- G_2 \\exp\\!\\left(-\\frac{u^2 + (v-1)^2}{\\sigma^2}\\right).\n$$\n这里 $G_1>0$ 和 $G_2>0$ 控制分别以 $(1,0)$ 和 $(0,1)$ 为中心的两个阱的深度，$R>0$ 控制在 $(0,0)$ 处的中心势垒的高度，而 $\\sigma>0$ 和 $\\rho>0$ 控制宽度。\n\nNEB路径构建与弛豫：\n- 将 $\\mathbf{s}^{(0)} = \\boldsymbol{\\phi}(\\mathbf{x}^{(0)})$ 和 $\\mathbf{s}^{(1)} = \\boldsymbol{\\phi}(\\mathbf{x}^{(1)})$ 之间的路径离散化为 $N$ 个图像，包括端点。通过线性插值初始化图像。对于内部图像，将路径切线计算为相邻图像之间的归一化弦向量。在每次迭代中，通过真实力 $-\\nabla U$ 的垂直分量与一个沿切线方向、依赖于局部图像间距的平行弹簧力之和来更新内部图像。弛豫之后，对能量最高的图像执行爬山图像（climbing-image）精修，方法是移除弹簧力并将真实力的平行分量反向，以收敛到鞍点。\n\n局部极小值与曲率：\n- 从 $\\mathbf{s}^{(0)}$ 开始，通过在 $U$ 上进行梯度下降来获得 $\\mathbf{s}^{(0)}$ 附近的局部极小值 $\\mathbf{s}_\\mathrm{min}$，使用固定的较小步长，并在梯度范数足够小时停止。使用高斯函数导数恒等式解析地计算 $U(u,v)$ 的Hessian矩阵 $\\mathbf{H}(\\mathbf{s})$。在鞍点 $\\mathbf{s}^\\ddagger$ 处，Hessian矩阵有一个负特征值；在计算振动模式时需将其排除。\n\n活化熵与熵稳定化：\n- 在约化普朗克常数和玻尔兹曼常数均设为1的单位制中，频率为 $\\omega>0$ 的单个谐振子模式在温度 $T>0$ 下的振动熵为\n$$\nS(\\omega,T) = \\frac{\\omega/T}{e^{\\omega/T} - 1} - \\ln\\!\\left(1 - e^{-\\omega/T}\\right).\n$$\n对于一组正频率 $\\{\\omega_i\\}$，$S(T) = \\sum_i S(\\omega_i,T)$。熵稳定化定义为活化熵\n$$\n\\Delta S^\\ddagger(T) = S_\\mathrm{saddle}(T) - S_\\mathrm{min}(T),\n$$\n其中 $S_\\mathrm{saddle}(T)$ 仅对鞍点Hessian矩阵的正频率求和，而 $S_\\mathrm{min}(T)$ 对极小值点Hessian矩阵的所有正频率求和。\n\n需要实现和计算的内容：\n- 按照指定方式构建 $\\boldsymbol{\\phi}$ 并计算 $\\mathbf{s}^{(0)}$ 和 $\\mathbf{s}^{(1)}$。\n- 在 $(u,v)$ 空间中实现NEB，弛豫能带，然后应用爬山图像精修以确定鞍点 $\\mathbf{s}^\\ddagger$。\n- 从 $\\mathbf{s}^{(0)}$ 开始最小化以找到 $\\mathbf{s}_\\mathrm{min}$，并计算势垒能量 $\\Delta E^\\ddagger = U(\\mathbf{s}^\\ddagger) - U(\\mathbf{s}_\\mathrm{min})$。\n- 计算 $\\mathbf{H}(\\mathbf{s}_\\mathrm{min})$ 和 $\\mathbf{H}(\\mathbf{s}^\\ddagger)$，提取正特征值 $\\{\\lambda_i\\}$ 并通过 $\\omega_i = \\sqrt{\\lambda_i}$ 转换为频率，然后计算 $\\Delta S^\\ddagger(T)$。\n\n单位与输出要求：\n- 能量是无量纲的，单位由 $U(u,v)$ 定义；将 $\\Delta E^\\ddagger$ 作为浮点数报告。\n- 熵必须以玻尔兹曼常数 $k_B$ 为单位报告，即在 $k_B=1$ 时是无量纲的；将 $\\Delta S^\\ddagger(T)$ 作为浮点数报告。\n- 将每个报告的浮点数四舍五入到六位小数。\n\n测试套件：\n- 使用固定的描述符向量 $\\mathbf{x}^{(0)} = (0.8,-0.3,0.5,0.0,-1.2,0.4)$ 和 $\\mathbf{x}^{(1)} = (-0.2,1.1,-0.7,0.3,0.9,-0.5)$，隐藏层目标为 $\\mathbf{y}^{(0)} = (0.5,-0.3,0.1,0.7,-0.4)$ 和 $\\mathbf{y}^{(1)} = (-0.2,0.6,-0.1,-0.5,0.3)$，并设置 $N=25$ 个图像，$k_\\mathrm{spring} = 1.0$，NEB迭代 $600$ 次，爬山迭代 $400$ 次，步长为 $0.02$。\n- 评估四个参数元组 $(G_1,G_2,R,\\sigma,\\rho,T)$ 的案例：\n  1. $(1.0,1.0,1.2,0.5,0.3,0.5)$。\n  2. $(1.0,1.0,1.0,0.5,0.25,5.0)$。\n  3. $(1.0,1.0,0.6,0.6,0.35,0.1)$。\n  4. $(1.0,0.8,1.1,0.5,0.3,1.0)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的对的列表，每一对的格式为 $[\\Delta E^\\ddagger,\\Delta S^\\ddagger(T)]$，所有内容都包含在一对方括号内。因此，对于上述四个测试案例，输出格式必须严格为\n$[[e_1,s_1],[e_2,s_2],[e_3,s_3],[e_4,s_4]]$\n每个数值条目都四舍五入到六位小数。", "solution": "我们构建了一个有原则的玩具模型和算法，它抓住了在机器学习集体变量空间中为交滑移机制应用微动弹性带（NEB）方法的精髓，并使用谐振子过渡态理论量化了熵稳定化效应 $\\Delta S^\\ddagger(T)$。\n\n步骤1：机器学习集体变量映射的构建。\n我们定义双层前馈映射 $\\boldsymbol{\\phi}(\\mathbf{x}) = \\mathbf{W}_2 \\tanh(\\mathbf{W}_1 \\mathbf{x} + \\mathbf{b}_1) + \\mathbf{b}_2$，其中隐藏层宽度 $h=5$，描述符维度 $d=6$。我们通过选择目标隐藏层输出 $\\mathbf{y}^{(0)}, \\mathbf{y}^{(1)} \\in (-1,1)^5$ 并构造 $\\mathbf{W}_1$ 和 $\\mathbf{b}_1$ 来精确地将 $\\mathbf{x}^{(0)}$ 映射到 $\\mathbf{y}^{(0)}$ 以及将 $\\mathbf{x}^{(1)}$ 映射到 $\\mathbf{y}^{(1)}$，从而强制执行约束 $\\boldsymbol{\\phi}(\\mathbf{x}^{(0)}) = (1,0)$ 和 $\\boldsymbol{\\phi}(\\mathbf{x}^{(1)}) = (0,1)$。记 $\\mathbf{z}^{(k)} = \\operatorname{arctanh}(\\mathbf{y}^{(k)})$，其中 $k \\in \\{0,1\\}$。对于每个隐藏单元索引 $j$，我们需要满足 $w_j^\\top \\mathbf{x}^{(0)} + b_{1,j} = z^{(0)}_j$ 和 $w_j^\\top \\mathbf{x}^{(1)} + b_{1,j} = z^{(1)}_j$。令 $\\Delta \\mathbf{x} = \\mathbf{x}^{(0)} - \\mathbf{x}^{(1)}$ 和 $\\Delta z_j = z^{(0)}_j - z^{(1)}_j$。一个最小范数解为\n$$\nw_j = \\frac{\\Delta z_j}{\\|\\Delta \\mathbf{x}\\|^2} \\Delta \\mathbf{x}, \\quad\nb_{1,j} = z^{(0)}_j - w_j^\\top \\mathbf{x}^{(0)}.\n$$\n这确保了两个线性约束都得到满足，然后tanh非线性函数会精确地产生 $\\mathbf{y}^{(0)}$ 和 $\\mathbf{y}^{(1)}$。\n\n接下来，逐行构造 $\\mathbf{W}_2$ 以将 $\\mathbf{y}^{(0)}$ 映射到 $(1,0)$ 并将 $\\mathbf{y}^{(1)}$ 映射到 $(0,1)$。令 $\\mathbf{A}$ 为一个 $2 \\times h$ 的矩阵，其行分别为 $\\mathbf{y}^{(0)\\top}$ 和 $\\mathbf{y}^{(1)\\top}$。对于第一个输出分量，求解 $\\mathbf{A} \\mathbf{w}_{2,1} = (1,0)$；对于第二个分量，求解 $\\mathbf{A} \\mathbf{w}_{2,2} = (0,1)$。最小范数解由Moore–Penrose伪逆给出：\n$$\n\\mathbf{w}_{2,1} = \\mathbf{A}^\\top (\\mathbf{A} \\mathbf{A}^\\top)^{-1} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{w}_{2,2} = \\mathbf{A}^\\top (\\mathbf{A} \\mathbf{A}^\\top)^{-1} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n设置 $\\mathbf{b}_2 = (0,0)$。通过这些构造，根据设计可得 $\\boldsymbol{\\phi}(\\mathbf{x}^{(0)}) = (1,0)$ 和 $\\boldsymbol{\\phi}(\\mathbf{x}^{(1)}) = (0,1)$。\n\n步骤2：势能面、梯度和Hessian矩阵。\n我们定义\n$$\nU(u,v) = R e^{-(u^2 + v^2)/\\rho^2} - G_1 e^{-((u-1)^2 + v^2)/\\sigma^2} - G_2 e^{-(u^2 + (v-1)^2)/\\sigma^2}.\n$$\n每一项都具有通用形式 $K e^{-[(u-a)^2 + (v-b)^2]/s^2}$，系数为 $K$，中心为 $(a,b)$，宽度为 $s$。梯度和Hessian矩阵是使用链式法则和高斯函数的导数推导出来的：\n- 一个高斯项对梯度的贡献是\n$$\n\\frac{\\partial}{\\partial u} (K e^{-Q/s^2}) = K e^{-Q/s^2} \\left( -\\frac{2(u-a)}{s^2} \\right), \\quad\n\\frac{\\partial}{\\partial v} (K e^{-Q/s^2}) = K e^{-Q/s^2} \\left( -\\frac{2(v-b)}{s^2} \\right),\n$$\n其中 $Q = (u-a)^2 + (v-b)^2$。\n- 对Hessian矩阵的贡献是\n$$\n\\frac{\\partial^2}{\\partial u^2} (K e^{-Q/s^2})\n= K e^{-Q/s^2} \\left( -\\frac{2}{s^2} + \\frac{4(u-a)^2}{s^4} \\right),\n$$\n$$\n\\frac{\\partial^2}{\\partial v^2} (K e^{-Q/s^2})\n= K e^{-Q/s^2} \\left( -\\frac{2}{s^2} + \\frac{4(v-b)^2}{s^4} \\right),\n$$\n$$\n\\frac{\\partial^2}{\\partial u \\partial v} (K e^{-Q/s^2})\n= K e^{-Q/s^2} \\left( \\frac{4(u-a)(v-b)}{s^4} \\right).\n$$\n将三个高斯项（系数 $K \\in \\{R,-G_1,-G_2\\}$ 及其各自的 $(a,b)$ 和 $s$）的贡献相加，即可得到 $\\nabla U$ 和 $\\mathbf{H}$。\n\n步骤3：集体变量空间中的NEB算法。\n我们将 $\\mathbf{s}^{(0)}$ 和 $\\mathbf{s}^{(1)}$ 之间的路径离散化为 $N$ 个图像，包括端点。通过线性插值进行初始化。对于每个内部图像 $i$（位置为 $\\mathbf{s}_i$），计算相邻弦向量 $\\mathbf{t}_i = \\mathbf{s}_{i+1} - \\mathbf{s}_{i-1}$ 及其单位切向量 $\\boldsymbol{\\tau}_i = \\mathbf{t}_i / \\|\\mathbf{t}_i\\|$。真实力为 $\\mathbf{F}_\\mathrm{true} = -\\nabla U(\\mathbf{s}_i)$。将其分解为相对于 $\\boldsymbol{\\tau}_i$ 的垂直和平行分量：$\\mathbf{F}_\\perp = \\mathbf{F}_\\mathrm{true} - (\\mathbf{F}_\\mathrm{true} \\cdot \\boldsymbol{\\tau}_i)\\boldsymbol{\\tau}_i$。平行弹簧力为 $\\mathbf{F}_\\parallel = k_\\mathrm{spring}(\\|\\mathbf{s}_{i+1} - \\mathbf{s}_i\\| - \\|\\mathbf{s}_i - \\mathbf{s}_{i-1}\\|)\\boldsymbol{\\tau}_i$。用固定的步长 $\\eta>0$ 更新 $\\mathbf{s}_i \\leftarrow \\mathbf{s}_i + \\eta (\\mathbf{F}_\\perp + \\mathbf{F}_\\parallel)$。在规定的迭代次数后，确定能量最高的图像索引 $j$，并执行爬山图像NEB：对于该图像，移除弹簧力并将真实力的平行分量反向以爬升势垒，即，通过 $\\mathbf{s}_j \\leftarrow \\mathbf{s}_j + \\eta [\\mathbf{F}_\\mathrm{true} - 2(\\mathbf{F}_\\mathrm{true} \\cdot \\boldsymbol{\\tau}_j)\\boldsymbol{\\tau}_j]$ 进行更新，同时像标准NEB一样弛豫其他图像。收敛后的 $\\mathbf{s}_j$ 近似于鞍点 $\\mathbf{s}^\\ddagger$。\n\n步骤4：初始状态附近的局部极小值。\n从 $\\mathbf{s}^{(0)}$ 开始，在 $U$ 上以固定步长执行梯度下降，直到梯度范数低于一个小的阈值，得到 $\\mathbf{s}_\\mathrm{min}$。计算势垒能量 $\\Delta E^\\ddagger = U(\\mathbf{s}^\\ddagger) - U(\\mathbf{s}_\\mathrm{min})$。\n\n步骤5：Hessian矩阵、振动频率和活化熵。\n使用解析公式计算Hessian矩阵 $\\mathbf{H}(\\mathbf{s}_\\mathrm{min})$ 和 $\\mathbf{H}(\\mathbf{s}^\\ddagger)$。令 $\\{\\lambda_i^\\mathrm{min}\\}$ 为极小值点的正特征值，$\\{\\lambda_i^\\ddagger\\}_{\\lambda_i^\\ddagger>0}$ 为鞍点的正特征值（不包括负的不稳定特征值）。通过 $\\omega_i^\\mathrm{min} = \\sqrt{\\lambda_i^\\mathrm{min}}$ 和 $\\omega_i^\\ddagger = \\sqrt{\\lambda_i^\\ddagger}$ 将其转换为频率。在 $\\hbar=1$ 和 $k_B=1$ 的约化单位制中，频率为 $\\omega$、温度为 $T$ 的振动熵为\n$$\nS(\\omega,T) = \\frac{\\omega/T}{e^{\\omega/T} - 1} - \\ln\\!\\left(1 - e^{-\\omega/T}\\right).\n$$\n然后\n$$\nS_\\mathrm{min}(T) = \\sum_i S(\\omega_i^\\mathrm{min},T), \\quad\nS_\\mathrm{saddle}(T) = \\sum_i S(\\omega_i^\\ddagger,T), \\quad\n\\Delta S^\\ddagger(T) = S_\\mathrm{saddle}(T) - S_\\mathrm{min}(T).\n$$\n为了在低温 $T$（即大的 $\\omega/T$）下保持数值稳定性，使用当 $e^{-\\omega/T} \\to 0$ 时 $S(\\omega,T) \\to 0$ 的渐近性质。\n\n步骤6：测试套件和输出。\n使用 $N=25$，$k_\\mathrm{spring} = 1.0$，NEB迭代 $600$ 次，爬山迭代 $400$ 次，步长 $\\eta=0.02$。描述符向量为 $\\mathbf{x}^{(0)} = (0.8,-0.3,0.5,0.0,-1.2,0.4)$ 和 $\\mathbf{x}^{(1)} = (-0.2,1.1,-0.7,0.3,0.9,-0.5)$，隐藏层目标为 $\\mathbf{y}^{(0)} = (0.5,-0.3,0.1,0.7,-0.4)$ 和 $\\mathbf{y}^{(1)} = (-0.2,0.6,-0.1,-0.5,0.3)$。评估四个参数元组 $(G_1,G_2,R,\\sigma,\\rho,T)$：\n- $(1.0,1.0,1.2,0.5,0.3,0.5)$，\n- $(1.0,1.0,1.0,0.5,0.25,5.0)$，\n- $(1.0,1.0,0.6,0.6,0.35,0.1)$，\n- $(1.0,0.8,1.1,0.5,0.3,1.0)$。\n生成格式为 $[[e_1,s_1],[e_2,s_2],[e_3,s_3],[e_4,s_4]]$ 的最终单行输出，每个浮点数四舍五入到六位小数，其中 $e_i$ 是案例 $i$ 的 $\\Delta E^\\ddagger$，$s_i$ 是案例 $i$ 的 $\\Delta S^\\ddagger(T)$。这完成了一次有原则的、将带有机器学习集体变量的NEB方法应用于类交滑移双盆势垒模型的应用，并量化了活化熵的稳定化效应。", "answer": "[[0.224157,-0.470415],[-0.019198,0.201445],[-0.384668,-0.106596],[0.122176,-0.180470]]", "id": "3441641"}, {"introduction": "随着计算能力的提升，高通量模拟产生了海量的材料数据，为数据驱动的材料科学研究开辟了新纪元。图神经网络（Graph Neural Networks, GNNs）由于其能够自然地表示原子间的连接关系，已成为构建原子尺度性质预测模型的强大工具。在这个前沿实践中[@problem_id:3441581]，您将从零开始构建一个简约的图神经网络，学习从局部原子环境描述符预测缺陷形成能，并利用SHAP（Shapley Additive exPlanations）值来解释模型，从而揭示控制缺陷性质的关键物理因素。", "problem": "您的任务是，从第一性原理出发，实现、训练并分析一个最小化的图神经网络（GNN），以从原子环境中学习晶体材料中的局部缺陷形成能，并使用 Shapley 可加性解释（SHAP）值来计算描述符归因。您的任务必须严格使用线性代数和图聚合方法来解决，不得使用任何机器学习库。所有计算必须是确定性的和可复现的。\n\n我们关注的物理量是点、线和面缺陷的缺陷形成能，记为 $E_f$。一般而言，形成能定义为 $E_f = E_{\\text{defect}} - E_{\\text{pristine}} + \\sum_i n_i \\mu_i$，其中 $E_{\\text{defect}}$ 和 $E_{\\text{pristine}}$ 分别是有缺陷和无缺陷超晶胞的总能量，$n_i$ 记录了物种 $i$ 的原子增加或减少的数量，而 $\\mu_i$ 是化学势。在此问题中，我们将 $E_f$ 建模为缺陷位点周围原子环境描述符的局部泛函，其方式与仅限于线性操作和求和聚合的图神经网络（GNN）消息传递兼容。\n\n您将实现一个针对每种化学成分的线性消息传递模型，该模型作用于以缺陷位点为中心的星形图上。对于每个图 $G = (V, E)$，其中有一个指定的中心节点 $s \\in V$ 代表缺陷位点，每个节点 $i \\in V$ 都有一个描述符向量 $\\mathbf{x}_i \\in \\mathbb{R}^3$，其分量为：\n- $x_{i,0}$：电负性差异（无量纲）。\n- $x_{i,1}$：原子尺寸错配（无量纲）。\n- $x_{i,2}$：局部解析剪切应变（无量纲）。\n\n对于给定的化学成分 $c$（其中 $c \\in \\{\\text{A}, \\text{B}, \\text{AB}\\}$），您的 GNN 使用单次线性的、带求和聚合的消息传递来生成一个聚合特征\n$$\n\\mathbf{g} = \\sum_{i \\in \\mathcal{N}_s \\cup \\{s\\}} \\mathbf{x}_i \\in \\mathbb{R}^3,\n$$\n其中 $\\mathcal{N}_s$ 是图 $G$ 中中心节点 $s$ 的邻居集合。预测的形成能与 $\\mathbf{g}$呈线性关系：\n$$\n\\hat{E}_f = \\mathbf{w}_c^\\top \\mathbf{g} + b_c,\n$$\n其中可学习参数为 $\\mathbf{w}_c \\in \\mathbb{R}^3$ 和 $b_c \\in \\mathbb{R}$。您必须通过最小化该化学成分提供的训练图上的均方误差，为每种化学成分 $c$ 训练一组独立的参数 $(\\mathbf{w}_c, b_c)$。使用带有非零正则化参数的岭回归以确保数值稳定性。所有能量均以电子伏特（eV）表示。\n\n训练后，为每种化学成分的已训练线性模型计算 Shapley 可加性解释（SHAP）值。对于基线为零向量的线性模型，具有聚合特征 $\\mathbf{g}$ 的样本的 SHAP 值按分量定义为\n$$\n\\phi_k = w_{c,k}\\, g_k \\quad \\text{for} \\quad k = 0,1,2,\n$$\n其中 $\\mathbf{w}_c = (w_{c,0}, w_{c,1}, w_{c,2})^\\top$。通过计算每个描述符索引 $k \\in \\{0,1,2\\}$ 的绝对值的平均值，来聚合每种化学成分的所有训练图上的这些 SHAP 值。对于每种化学成分，具有最大平均绝对 SHAP 值的描述符索引被认为是控制该化学成分 $E_f$ 的主导描述符。报告索引时使用基于 $0$ 的索引整数，其中 $0$ 对应电负性差异，$1$ 对应尺寸错配，$2$ 对应剪切应变。\n\n您必须依赖的基础：\n- 基于排列不变性求和的图聚合，这是消息传递 GNN 中一种标准且经过充分测试的机制。\n- 带岭正则化的线性最小二乘法，作为一种经过充分测试的参数估计数值方法。\n- 专门针对零基线线性模型的 Shapley 值定义，其结果为 $\\phi_k = w_k g_k$。\n\n训练数据集。使用以下完全指定的训练图。每个训练图都是一个以节点索引 0 为中心的星形图，边从中心连接到每个邻居。对于每个图，训练标签是 $E_f$（单位 eV）。所有描述符值都是无量纲的。\n\n化学成分 A（六个训练图）：\n1. 节点：2；边：(0,1)；特征：$x_0 = [0.10, 0.05, 0.02]$, $x_1 = [0,0,0]$；标签 $E_f = 0.48$。\n2. 节点：2；边：(0,1)；特征：$x_0 = [0.00, 0.10, 0.03]$, $x_1 = [0.00, 0.05, 0.01]$；标签 $E_f = 0.62$。\n3. 节点：2；边：(0,1)；特征：$x_0 = [0.20, 0.02, 0.00]$, $x_1 = [0.10, 0.01, 0.02]$；标签 $E_f = 0.68$。\n4. 节点：3；边：(0,1), (0,2)；特征：$x_0 = [0.05, 0.00, 0.05]$, $x_1 = [0.00, 0.05, 0.03]$, $x_2 = [0.00, 0.05, 0.02]$；标签 $E_f = 0.76$。\n5. 节点：2；边：(0,1)；特征：$x_0 = [0.15, 0.04, 0.01]$, $x_1 = [0.05, 0.02, 0.00]$；标签 $E_f = 0.59$。\n6. 节点：2；边：(0,1)；特征：$x_0 = [0.00, 0.08, 0.00]$, $x_1 = [0.00, 0.04, 0.05]$；标签 $E_f = 0.59$。\n\n化学成分 B（六个训练图）：\n1. 节点：1；边：无；特征：$x_0 = [0.05, 0.10, 0.02]$；标签 $E_f = 0.39$。\n2. 节点：2；边：(0,1)；特征：$x_0 = [0.10, 0.05, 0.04]$, $x_1 = [0.00, 0.05, 0.01]$；标签 $E_f = 0.555$。\n3. 节点：2；边：(0,1)；特征：$x_0 = [0.00, 0.08, 0.02]$, $x_1 = [0.10, 0.00, 0.03]$；标签 $E_f = 0.525$。\n4. 节点：2；边：(0,1)；特征：$x_0 = [0.20, 0.02, 0.00]$, $x_1 = [0.05, 0.03, 0.02]$；标签 $E_f = 0.675$。\n5. 节点：2；边：(0,1)；特征：$x_0 = [0.00, 0.12, 0.06]$, $x_1 = [0.00, 0.03, 0.00]$；标签 $E_f = 0.475$。\n6. 节点：2；边：(0,1)；特征：$x_0 = [0.15, 0.00, 0.01]$, $x_1 = [0.05, 0.00, 0.00]$；标签 $E_f = 0.485$。\n\n化学成分 AB（六个训练图）：\n1. 节点：1；边：无；特征：$x_0 = [0.30, 0.05, 0.02]$；标签 $E_f = 1.224$。\n2. 节点：2；边：(0,1)；特征：$x_0 = [0.20, 0.10, 0.03]$, $x_1 = [0.10, 0.05, 0.02]$；标签 $E_f = 1.54$。\n3. 节点：2；边：(0,1)；特征：$x_0 = [0.10, 0.02, 0.04]$, $x_1 = [0.05, 0.03, 0.01]$；标签 $E_f = 0.945$。\n4. 节点：2；边：(0,1)；特征：$x_0 = [0.25, 0.00, 0.00]$, $x_1 = [0.05, 0.00, 0.02]$；标签 $E_f = 1.114$。\n5. 节点：2；边：(0,1)；特征：$x_0 = [0.00, 0.15, 0.05]$, $x_1 = [0.00, 0.05, 0.00]$；标签 $E_f = 0.9$。\n6. 节点：2；边：(0,1)；特征：$x_0 = [0.15, 0.10, 0.00]$, $x_1 = [0.10, 0.00, 0.05]$；标签 $E_f = 1.305$。\n\n测试套件。训练后，评估以下四个图（将预测的能量以 eV 为单位表示，四舍五入到三位小数）：\n\n1. 化学成分 A（点缺陷；仅中心节点）：节点 1；特征：$x_0 = [0.12, 0.06, 0.01]$。\n2. 化学成分 B（线缺陷；中心节点带一个邻居）：节点 2；边：(0,1)；特征：$x_0 = [0.08, 0.04, 0.06]$, $x_1 = [0.00, 0.06, 0.02]$。\n3. 化学成分 AB（面缺陷；中心节点带两个邻居）：节点 3；边：(0,1), (0,2)；特征：$x_0 = [0.25, 0.08, 0.06]$, $x_1 = [0.05, 0.04, 0.02]$, $x_2 = [0.00, 0.08, 0.00]$。\n4. 化学成分 A（边界情况；孤立的零值中心节点）：节点 1；特征：$x_0 = [0.00, 0.00, 0.00]$。\n\n输出规范。您的程序必须生成一行输出，其中包含一个用方括号括起来的逗号分隔列表：\n- 测试套件的四个预测形成能，单位为 eV，每个都四舍五入到三位小数，\n- 随后是三个整数，分别给出化学成分 A、化学成分 B 和化学成分 AB 的主导描述符索引，这些索引是通过计算每种化学成分的训练图上的最大平均绝对 SHAP 值确定的。\n\n因此，最终格式为：\n\"[E1,E2,E3,E4,idxA,idxB,idxAB]\"\n\n所有能量单位必须是 eV，所有角度（如果存在）单位应为弧度。此数据集中没有角度。描述符索引必须是使用基于 0 的索引的整数。程序不得读取任何输入，也不得访问任何外部资源。仅使用线性代数运算和上面定义的求和聚合器来满足 GNN 约束。", "solution": "该问题要求实现一个简化的图神经网络（GNN）模型，用于预测三种不同材料化学成分（A、B 和 AB）的缺陷形成能 $E_f$。解决方案必须从第一性原理构建，利用线性代数和指定的聚合方法，而不依赖高级机器学习库。整个过程包括四个主要阶段：通过图聚合进行数据准备、通过岭回归进行模型训练、使用 Shapley 可加性解释（SHAP）进行模型分析，最后在给定的测试套件上进行预测。\n\n模型的核心是针对每种化学成分的线性消息传递方案，该方案作用于以缺陷位点（始终为节点 0）为中心的星形图上。图中的每个节点 $i$ 由一个 3 维特征向量 $\\mathbf{x}_i \\in \\mathbb{R}^3$ 来表征。\n\n**步骤 1：图聚合**\n\n对于每种化学成分 $c \\in \\{\\text{A}, \\text{B}, \\text{AB}\\}$ 及其数据集中的每个训练图 $j$，计算一个单一的聚合特征向量 $\\mathbf{g}^{(j)} \\in \\mathbb{R}^3$。问题指定了一个对图中所有节点（中心节点 $s$ 及其邻居 $\\mathcal{N}_s$）进行排列不变性求和的聚合器。因此，对于每个图 $j$，聚合特征向量为：\n$$\n\\mathbf{g}^{(j)} = \\sum_{i \\in \\mathcal{N}_s \\cup \\{s\\}} \\mathbf{x}_i^{(j)}\n$$\n对于给定化学成分的 $N$ 个训练图的数据集，此过程产生一组 $N$ 个聚合特征向量 $\\{\\mathbf{g}^{(j)}\\}_{j=1}^N$ 和一组相应的 $N$ 个真实形成能 $\\{E_f^{(j)}\\}_{j=1}^N$。这些构成了回归模型的输入。\n\n**步骤 2：通过岭回归进行模型训练**\n\n预测的形成能 $\\hat{E}_f$ 被建模为聚合特征的线性函数：\n$$\n\\hat{E}_f = \\mathbf{w}_c^\\top \\mathbf{g} + b_c\n$$\n这里，$\\mathbf{w}_c \\in \\mathbb{R}^3$ 是权重向量，$b_c \\in \\mathbb{R}$ 是偏置项。这 4 个参数 $(\\mathbf{w}_c, b_c)$ 是通过最小化岭回归目标函数为每种化学成分独立学习的。为了方便线性代数计算，我们将特征向量 $\\mathbf{g}$ 增广为 $\\tilde{\\mathbf{g}} = [\\mathbf{g}^\\top, 1]^\\top$，参数向量增广为 $\\tilde{\\mathbf{w}}_c = [\\mathbf{w}_c^\\top, b_c]^\\top$。模型于是可以紧凑地写成 $\\hat{E}_f = \\tilde{\\mathbf{w}}_c^\\top \\tilde{\\mathbf{g}}$。\n\n对于化学成分 $c$ 的一组 $N$ 个训练样本，我们构建一个大小为 $N \\times 4$ 的增广设计矩阵 $\\tilde{G}_c$，其中每一行是一个增广特征向量 $(\\tilde{\\mathbf{g}}^{(j)})^\\top$。我们还形成一个大小为 $N \\times 1$ 的目标向量 $\\mathbf{y}_c$，包含真实能量 $E_f^{(j)}$。岭回归问题旨在找到最小化损失函数的参数向量 $\\tilde{\\mathbf{w}}_c$：\n$$\nL(\\tilde{\\mathbf{w}}_c) = \\|\\tilde{G}_c \\tilde{\\mathbf{w}}_c - \\mathbf{y}_c\\|_2^2 + \\alpha \\|\\mathbf{w}_c\\|_2^2\n$$\n正则化项的强度为 $\\alpha$，仅应用于权重 $\\mathbf{w}_c$ 而不应用于偏置 $b_c$。根据指示，我们使用一个小的非零值 $\\alpha = 10^{-8}$ 来确保数值稳定性。解析解通过求解正规方程组得到：\n$$\n(\\tilde{G}_c^\\top \\tilde{G}_c + \\Lambda) \\tilde{\\mathbf{w}}_c = \\tilde{G}_c^\\top \\mathbf{y}_c\n$$\n其中 $\\Lambda$ 是一个 $4 \\times 4$ 的对角矩阵，仅对权重参数施加正则化：\n$$\n\\Lambda = \\text{diag}(\\alpha, \\alpha, \\alpha, 0)\n$$\n求解这个线性方程组得到 $\\tilde{\\mathbf{w}}_c$，即最优参数 $[\\mathbf{w}_c^\\top, b_c]^\\top$。\n\n**步骤 3：用于特征归因的 SHAP 分析**\n\n训练后，使用 SHAP 值来量化 3 个描述符中每一个的重要性。问题提供了针对零基线线性模型的专用公式，其中对于聚合特征向量 $\\mathbf{g}$ 的第 $k$ 个分量，其 SHAP 值 $\\phi_k$ 为：\n$$\n\\phi_k = w_{c,k} g_k\n$$\n对于给定的化学成分 $c$，为 $N$ 个训练图中的每一个计算这些值。为了确定该化学成分的唯一最重要描述符，我们计算所有 $N$ 个训练图上每个描述符索引 $k \\in \\{0, 1, 2\\}$ 的平均绝对 SHAP 值：\n$$\n\\bar{\\phi}_{c,k} = \\frac{1}{N} \\sum_{j=1}^{N} |w_{c,k} g_k^{(j)}|\n$$\n化学成分 $c$ 的主导描述符索引是具有最大平均绝对 SHAP 值的索引：$\\text{idx}_c = \\arg\\max_{k \\in \\{0, 1, 2\\}} \\bar{\\phi}_{c,k}$。\n\n**步骤 4：对测试数据进行预测**\n\n最后，部署训练好的模型来预测测试套件中四个图的形成能。对于每个测试图，首先使用求和规则聚合其特征向量。然后，将相应化学成分 $c$ 的模型 $(\\mathbf{w}_c, b_c)$ 应用于聚合的特征向量，以计算预测能量 $\\hat{E}_f$。最终的预测能量按要求四舍五入到三位小数。结果与主导描述符索引一起被格式化为单个字符串。", "answer": "[0.556,0.596,1.444,0.301,0,1,0]", "id": "3441581"}]}