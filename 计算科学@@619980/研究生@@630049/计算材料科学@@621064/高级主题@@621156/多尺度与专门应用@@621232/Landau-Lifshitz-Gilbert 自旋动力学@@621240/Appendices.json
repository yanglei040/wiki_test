{"hands_on_practices": [{"introduction": "在将连续介质的物理学（如微磁学）转化为计算机模拟时，第一步是将控制方程在空间上离散化。交换场是朗道-利夫希兹-吉尔伯特（LLG）方程中的一个关键组成部分，它依赖于磁化强度的空间导数，因此是一个典型的例子。这个练习将指导你从交换能泛函出发，通过变分原理推导出其在有限差分网格上的离散形式，这是构建微磁模拟代码的一项基本技能。[@problem_id:3460200] 这个过程不仅揭示了如何将连续的物理定律转化为离散的计算算子，还涉及到如何正确处理边界条件，这是任何有限元或有限差分模拟中的一个核心问题。", "problem": "考虑一个铁磁长方体，它在一个均匀、单元中心、立方的有限差分网格上被离散化，每个笛卡尔方向上的单元尺寸为 $\\Delta$。磁化场 $\\mathbf{m}(\\mathbf{r},t)$ 是一个单位矢量场。微磁交换能密度由 $A \\, |\\nabla \\mathbf{m}|^{2}$ 给出，其中 $A$ 是交换刚度。在 Landau–Lifshitz–Gilbert 动力学中，相应的交换有效场由交换能对 $\\mathbf{m}$ 的变分导数得到。\n\n从交换能泛函出发，并仅使用上述网格上的标准有限体积或有限差分近似，推导一个离散的交换场算子，该算子与逐分量作用于 $\\mathbf{m}$ 的离散拉普拉斯算子成正比。在长方体的边界上施加零法向导数边界条件 $\\partial_{n} \\mathbf{m} = 0$。你的推导应：\n- 从交换能积分及其在网格上的一致离散近似开始。\n- 使用变分论证来获得扮演拉普拉斯算子角色的离散算子。\n- 解释零法向导数边界条件如何在边界单元处被纳入，以及为什么这种实现与变分推导是一致的。\n\n最后，考虑一个位于平面边界上的边界单元，其单位外法线沿负 $x$ 方向（即在 $x=0$ 的面上，因此该单元没有 $-x$ 方向的邻居）。对于 $\\mathbf{m}$ 的一个笛卡尔分量，写出此边界单元处离散拉普拉斯算子的七点有限差分模板系数，并按 $[\\text{中心}, +x, -x, +y, -y, +z, -z]$ 的顺序列出这些系数。将你的最终答案用 $\\Delta$ 表示成一个单个的行向量。不需要进行数值计算。", "solution": "该问题要求从连续的交换能泛函出发，在有限差分网格上推导一个离散的交换场算子。推导必须采用变分论证，并纳入零法向导数边界条件。最后，必须确定在边界单元处得到的离散拉普拉斯算子的具体模板系数。\n\n占据体积 $V$ 的铁磁体的连续交换能泛函由下式给出：\n$$E_{ex} = \\int_V A |\\nabla \\mathbf{m}|^2 dV$$\n其中 $A$ 是交换刚度常数，$\\mathbf{m} = (m_x, m_y, m_z)$ 是归一化的磁化矢量场，即 $|\\mathbf{m}| = 1$。项 $|\\nabla \\mathbf{m}|^2$ 是每个分量的梯度平方和的简写：\n$$|\\nabla \\mathbf{m}|^2 = |\\nabla m_x|^2 + |\\nabla m_y|^2 + |\\nabla m_z|^2 = \\sum_{\\alpha \\in \\{x,y,z\\}} \\left( \\left(\\frac{\\partial m_\\alpha}{\\partial x}\\right)^2 + \\left(\\frac{\\partial m_\\alpha}{\\partial y}\\right)^2 + \\left(\\frac{\\partial m_\\alpha}{\\partial z}\\right)^2 \\right)$$\n\n为了在单元尺寸为 $\\Delta$ 的均匀立方网格上离散化该能量，我们可以将积分近似为所有单元上的总和。然而，对于基于导数的能量，一种更稳健的方法是离散化与相邻单元之间的连接相关的能量贡献。我们通过考虑单元 $(i,j,k)$ 和 $(i+1,j,k)$ 之间的导数来离散化项 $\\int (\\frac{\\partial m_\\alpha}{\\partial x})^2 dV$。导数近似为 $\\frac{m_{\\alpha,i+1,j,k} - m_{\\alpha,i,j,k}}{\\Delta}$。能量密度为 $(\\frac{m_{\\alpha,i+1,j,k} - m_{\\alpha,i,j,k}}{\\Delta})^2$。将此能量与一个体积元 $\\Delta^3$（例如，一个以单元之间面为中心的体积）关联，能量贡献为 $A (\\frac{m_{\\alpha,i+1,j,k} - m_{\\alpha,i,j,k}}{\\Delta})^2 \\Delta^3 = A \\Delta (m_{\\alpha,i+1,j,k} - m_{\\alpha,i,j,k})^2$。\n\n对网格中所有最近邻连接求和，总的离散交换能 $E_{ex}^{disc}$ 可以写为：\n$$E_{ex}^{disc} = A \\Delta \\sum_{\\langle p, p' \\rangle} |\\mathbf{m}_p - \\mathbf{m}_{p'}|^2$$\n其中求和是对网格中所有唯一的最近邻单元对 $\\langle p, p' \\rangle$ 进行的。为避免重复计数，一种等效的写法是，对每个单元 $p = (i,j,k)$ 及其在正轴方向上的邻居求和：\n$$E_{ex}^{disc} = A \\Delta \\sum_{i,j,k} \\left( |\\mathbf{m}_{i+1,j,k} - \\mathbf{m}_{i,j,k}|^2 + |\\mathbf{m}_{i,j+1,k} - \\mathbf{m}_{i,j,k}|^2 + |\\mathbf{m}_{i,j,k+1} - \\mathbf{m}_{i,j,k}|^2 \\right)$$\n其中 $|\\mathbf{v}|^2 = v_x^2 + v_y^2 + v_z^2$。\n\n交换有效场 $\\mathbf{H}_{ex}$ 是由能量的变分导数推导出来的。在离散情况下，单元 $p$ 处的场与 $-\\frac{\\partial E_{ex}^{disc}}{\\partial \\mathbf{m}_p}$ 成正比。我们寻找一个与此导数成正比的算子。让我们计算此导数的一个分量，针对一个内部单元 $p_0 = (i,j,k)$ 的任意分量 $\\alpha \\in \\{x,y,z\\}$。\n$$\\frac{\\partial E_{ex}^{disc}}{\\partial m_{\\alpha,p_0}} = \\frac{\\partial}{\\partial m_{\\alpha,i,j,k}} E_{ex}^{disc}$$\n$E_{ex}^{disc}$ 中依赖于 $\\mathbf{m}_{i,j,k}$ 的项是那些连接单元 $(i,j,k)$ 与其六个最近邻单元 $(i\\pm 1,j,k)$、$(i,j\\pm 1,k)$ 和 $(i,j,k\\pm 1)$ 的项。让我们将 $\\mathbf{m}_{i,j,k}$ 记为 $\\mathbf{m}_0$，其邻居记为 $\\mathbf{m}_{\\pm x}, \\mathbf{m}_{\\pm y}, \\mathbf{m}_{\\pm z}$。能量的相关部分是：\n$$E_{rel} = A \\Delta \\left( |\\mathbf{m}_{+x}-\\mathbf{m}_0|^2 + |\\mathbf{m}_0-\\mathbf{m}_{-x}|^2 + |\\mathbf{m}_{+y}-\\mathbf{m}_0|^2 + |\\mathbf{m}_0-\\mathbf{m}_{-y}|^2 + |\\mathbf{m}_{+z}-\\mathbf{m}_0|^2 + |\\mathbf{m}_0-\\mathbf{m}_{-z}|^2 \\right)$$\n对 $m_{\\alpha,0}$ 的导数是：\n$$\\frac{\\partial E_{rel}}{\\partial m_{\\alpha,0}} = A \\Delta \\left( -2(m_{\\alpha,+x}-m_{\\alpha,0}) + 2(m_{\\alpha,0}-m_{\\alpha,-x}) -2(m_{\\alpha,+y}-m_{\\alpha,0}) + 2(m_{\\alpha,0}-m_{\\alpha,-y}) -2(m_{\\alpha,+z}-m_{\\alpha,0}) + 2(m_{\\alpha,0}-m_{\\alpha,-z}) \\right)$$\n合并 $m_{\\alpha,0}$ 的项：\n$$\\frac{\\partial E_{rel}}{\\partial m_{\\alpha,0}} = 2A\\Delta \\left( 6m_{\\alpha,0} - (m_{\\alpha,+x} + m_{\\alpha,-x} + m_{\\alpha,+y} + m_{\\alpha,-y} + m_{\\alpha,+z} + m_{\\alpha,-z}) \\right)$$\n作用于标量场 $f$ 的拉普拉斯算子 $\\nabla^2$ 的标准七点有限差分近似是：\n$$(\\nabla_d^2 f)_i = \\frac{f_{i+1,j,k} + f_{i-1,j,k} + f_{i,j+1,k} + f_{i,j-1,k} + f_{i,j,k+1} + f_{i,j,k-1} - 6f_{i,j,k}}{\\Delta^2}$$\n将此与我们的导数进行比较，我们发现：\n$$\\frac{\\partial E_{ex}^{disc}}{\\partial m_{\\alpha,i,j,k}} = -2A\\Delta \\Delta^2 (\\nabla_d^2 m_\\alpha)_{i,j,k} = -2A\\Delta^3 (\\nabla_d^2 m_\\alpha)_{i,j,k}$$\n因此，单元 $p$ 处的有效场算子与 $-\\frac{\\partial E_{ex}^{disc}}{\\partial \\mathbf{m}_p}$ 成正比，而后者又与 $2A\\Delta^3 \\nabla_d^2 \\mathbf{m}_p$ 成正比。因此，离散交换场算子与逐分量作用于 $\\mathbf{m}$ 的离散拉普拉斯算子成正比。\n\n接下来，我们纳入边界条件 $\\partial_n \\mathbf{m} = 0$，其中 $\\partial_n$ 是沿外法线方向的导数。从连续泛函的变分可以看出，这是交换能最小化的一个自然边界条件：\n$$\\delta E_{ex} = 2A \\int_V (\\nabla \\mathbf{m}) \\cdot (\\nabla \\delta \\mathbf{m}) dV = \\int_S 2A (\\delta\\mathbf{m}) \\cdot (\\partial_n \\mathbf{m}) dS - \\int_V 2A (\\delta\\mathbf{m}) \\cdot (\\nabla^2 \\mathbf{m}) dV$$\n为了使体积分能够定义有效场，面积分必须为零。当边界上 $\\delta\\mathbf{m}=0$（固定边界条件）或 $\\partial_n \\mathbf{m} = 0$（自由边界条件）时，这种情况会发生。本问题施加了后者。\n在离散模型中，这个条件是使用虚拟单元来实现的。考虑一个在 $x=0$ 面上的边界单元。其外法线是 $\\mathbf{n}=-\\hat{x}$。边界条件是 $-\\frac{\\partial \\mathbf{m}}{\\partial x} = 0$，或者简写为 $\\frac{\\partial \\mathbf{m}}{\\partial x} = 0$。设该边界单元的索引为 $(0,j,k)$。该单元的一般拉普拉斯表达式需要用到不存在的邻居 $(-1,j,k)$ 处的值，这是一个虚拟单元。我们使用边界条件来定义这个虚拟单元中的值。用中心差分在边界（单元 $0$ 和 $-1$ 之间）上近似导数：\n$$\\frac{\\mathbf{m}_{0,j,k} - \\mathbf{m}_{-1,j,k}}{\\Delta} = 0 \\quad \\implies \\quad \\mathbf{m}_{-1,j,k} = \\mathbf{m}_{0,j,k}$$\n这意味着虚拟单元中的磁化被设置为等于相邻边界单元中的磁化。这与变分推导是一致的，因为来自单元 $(0,j,k)$ 和虚拟单元 $(-1,j,k)$ 之间连接的能量贡献（即 $A\\Delta|\\mathbf{m}_{0,j,k} - \\mathbf{m}_{-1,j,k}|^2$）为零。这对应于边界外没有交换力矩。\n\n最后，我们求出这个边界单元 $(0,j,k)$ 处离散拉普拉斯算子 $\\nabla_d^2$ 的模板系数。我们使用拉普拉斯算子的一般表达式，并代入虚拟单元的值。对于任意分量 $m_\\alpha$，我们将其记为 $m$：\n$$(\\nabla_d^2 m)_{0,j,k} = \\frac{m_{1,j,k} + m_{-1,j,k} + m_{0,j+1,k} + m_{0,j-1,k} + m_{0,j,k+1} + m_{0,j,k-1} - 6m_{0,j,k}}{\\Delta^2}$$\n代入 $m_{-1,j,k} = m_{0,j,k}$：\n$$(\\nabla_d^2 m)_{0,j,k} = \\frac{m_{1,j,k} + m_{0,j,k} + m_{0,j+1,k} + m_{0,j-1,k} + m_{0,j,k+1} + m_{0,j,k-1} - 6m_{0,j,k}}{\\Delta^2}$$\n合并项：\n$$(\\nabla_d^2 m)_{0,j,k} = \\frac{-5 m_{0,j,k} + m_{1,j,k} + m_{0,j+1,k} + m_{0,j-1,k} + m_{0,j,k+1} + m_{0,j,k-1}}{\\Delta^2}$$\n该算子是中心单元及其真实邻居处值的线性组合。按 $[\\text{中心}, +x, -x, +y, -y, +z, -z]$ 顺序排列的七点模板系数分别是 $m_{0,j,k}$、$m_{1,j,k}$、$m_{-1,j,k}$（它不是一个真实的单元）、$m_{0,j+1,k}$ 等的乘数。\n中心单元 $(0,j,k)$ 的系数是 $\\frac{-5}{\\Delta^2}$。\n$+x$ 邻居 $(1,j,k)$ 的系数是 $\\frac{1}{\\Delta^2}$。\n$-x$ 邻居的系数是 $0$，因为这个位置在计算域之外。\n$\\pm y$ 和 $\\pm z$ 邻居的系数都是 $\\frac{1}{\\Delta^2}$。\n\n最终的系数向量是：\n$$ \\left[ \\frac{-5}{\\Delta^2}, \\frac{1}{\\Delta^2}, 0, \\frac{1}{\\Delta^2}, \\frac{1}{\\Delta^2}, \\frac{1}{\\Delta^2}, \\frac{1}{\\Delta^2} \\right] $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{-5}{\\Delta^2}  \\frac{1}{\\Delta^2}  0  \\frac{1}{\\Delta^2}  \\frac{1}{\\Delta^2}  \\frac{1}{\\Delta^2}  \\frac{1}{\\Delta^2}\n\\end{pmatrix}\n}\n$$", "id": "3460200"}, {"introduction": "在完成了空间离散化之后，下一步是随时间积分LLG方程。LLG动力学具有独特的几何特性：磁化矢量在保持其单位长度的同时进行进动和阻尼。这个练习将介绍一种既强大又现代的数值积分方法——算子分裂法，该方法能很好地保持这种几何结构。[@problem_id:3460197] 通过分别精确求解进动和阻尼子问题，我们构建了一个在模拟铁磁共振（FMR）等振荡现象时具有更高相位精度和稳定性的积分器。这是一个极具价值的实践练习，它要求你将理论推导直接转化为可运行的代码，并将其与标准方法（如四阶龙格-库塔法）进行定量比较。", "problem": "实现一个用于 Landau–Lifshitz–Gilbert 自旋动力学的数值积分器，该积分器使用算子分裂法解析地处理进动，并隐式地处理阻尼。在一个铁磁共振 (FMR) 衰荡设定中，将其相位精度与一个标准显式格式进行比较。处理一个单位范数的单畴宏自旋。使用以下基本依据来推导您的方法。\n\n基本方程和定义：\n- 在恒定有效磁场 $\\mathbf{H}\\in\\mathbb{R}^3$ 中，单位磁化矢量 $\\mathbf{m}(t)\\in\\mathbb{R}^3$ 的 Landau–Lifshitz–Gilbert 方程的 Gilbert 形式为\n$$\n(1+\\alpha^2)\\,\\frac{d\\mathbf{m}}{dt} \\;=\\; -\\gamma\\,\\mathbf{m}\\times \\mathbf{H} \\;-\\; \\alpha\\,\\gamma\\,\\mathbf{m}\\times(\\mathbf{m}\\times \\mathbf{H}),\n$$\n其中 $\\gamma$ 是旋磁比（单位为 $\\mathrm{rad\\,s^{-1}\\,T^{-1}}$），$\\alpha\\ge 0$ 是无量纲阻尼，$\\times$ 表示矢量叉积，且对所有 $t$ 都有 $\\|\\mathbf{m}\\|=1$。\n- 定义 $\\gamma'=\\gamma/(1+\\alpha^2)$，这样方程可以写成两个矢量场的和，\n$$\n\\frac{d\\mathbf{m}}{dt} \\;=\\; \\underbrace{-\\gamma'\\,\\mathbf{m}\\times\\mathbf{H}}_{\\text{precession}} \\;+\\; \\underbrace{-\\alpha\\gamma'\\,\\mathbf{m}\\times(\\mathbf{m}\\times\\mathbf{H})}_{\\text{damping}}.\n$$\n- 在恒定磁场 $\\mathbf{H} = H_0\\,\\mathbf{h}$（其中 $H_0=\\|\\mathbf{H}\\|$ 且 $\\mathbf{h}$ 是单位矢量）中，进动频率为 $\\omega = \\gamma' H_0$（单位为 $\\mathrm{rad/s}$），铁磁共振 (FMR) 周期为 $T_{\\mathrm{per}} = 2\\pi/\\omega$。\n\n任务要求：\n1. 基于上述分解，从第一性原理推导出一个时间分裂格式，该格式应用：\n   - 一个在时间步长 $\\Delta t$ 内绕轴 $\\mathbf{h}$ 旋转角度 $\\theta=\\omega\\,\\Delta t$ 的精确进动映射（在进动子步骤中无近似），以及\n   - 一个在时间间隔 $\\tau$ 内用于阻尼子步骤的隐式更新，该更新保持单位范数且无条件稳定。展示如何将恒定 $\\mathbf{H}$ 下阻尼子步骤的隐式矢量方程简化为关于 $s = \\mathbf{h}\\cdot \\mathbf{m}_{\\mathrm{new}}$ 的标量非线性方程，并以闭式形式求解，从而得到 $\\mathbf{m}_{\\mathrm{new}}$ 的显式公式。\n2. 以对称的 Strang 类方式（半步阻尼，全步进动，半步阻尼）组合这两个子步骤，以获得一个二阶类辛分裂方法。\n3. 在代码中实现以下两者：\n   - 推导出的分裂积分器，以及\n   - 一个直接应用于上述 Gilbert 形式的基准显式四阶 Runge–Kutta (RK4) 方法（您可以在每个 RK4 步之后投影回单位球以控制范数漂移）。\n4. 模拟一次 FMR 衰荡：取恒定磁场 $\\mathbf{H}=H_0\\hat{\\mathbf{z}}$ 且 $H_00$，从一个与 $\\hat{\\mathbf{z}}$ 成一个小的极角 $\\theta_0$ 的略微倾斜的初始磁化强度 $\\mathbf{m}(0)$ 开始，演化整数个 FMR 周期。将时间 $t$ 的数值相位定义为方位角 $\\phi(t)=\\mathrm{atan2}(m_y(t),m_x(t))$（单位为弧度），并与解析相位 $\\phi_{\\mathrm{exact}}(t)=\\omega t$ (模 $2\\pi$) 进行比较。使用包裹绝对相位误差 $\\varepsilon_\\phi(t) = \\left|\\mathrm{atan2}(\\sin(\\phi(t)-\\phi_{\\mathrm{exact}}(t)),\\cos(\\phi(t)-\\phi_{\\mathrm{exact}}(t)))\\right|$（单位为弧度）。\n5. 设计一个包含以下三种情况的测试套件以评估相位精度：\n   - 情况 A (理想情况)：$\\gamma = 1.760859\\times 10^{11}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}}$，$H_0=1.0\\ \\mathrm{T}$，$\\alpha=0.02$，$\\theta_0 = 5^\\circ$（转换为弧度），总时间 $T_{\\mathrm{tot}}=20\\,T_{\\mathrm{per}}$，时间步长 $\\Delta t = T_{\\mathrm{per}}/12$。\n   - 情况 B (细化步长)：与情况 A 相同，但 $\\Delta t = T_{\\mathrm{per}}/40$。\n   - 情况 C (边界情况，无阻尼)：与情况 A 相同，但 $\\alpha=0.0$ 且 $\\Delta t = T_{\\mathrm{per}}/12$。\n   在所有情况下，$T_{\\mathrm{per}}=2\\pi/\\omega$，其中 $\\omega=\\gamma' H_0$ 且 $\\gamma'=\\gamma/(1+\\alpha^2)$，并且积分应精确运行 $20$ 个 FMR 周期，以使 $T_{\\mathrm{tot}}/\\Delta t$ 为整数。所有角度必须以弧度为单位，时间以秒为单位，磁场以特斯拉为单位。\n6. 对每种情况，计算分裂方法和 RK4 方法在最终时间的包裹绝对相位误差，并返回一个布尔值，指示分裂方法的最终相位误差是否严格小于 RK4 的。\n7. 最终输出格式：您的程序应生成单行输出，其中包含按 A、B、C 顺序排列的结果，格式为方括号内以逗号分隔的列表。例如，输出格式必须类似于 $\\texttt{[true,false,true]}$，但使用 Python 的布尔值大写形式。\n\n您的交付物必须是一个完整的、可运行的程序，该程序：\n- 实现了上述方法和比较。\n- 不使用用户输入。\n- 按规定精确打印一行包含三个布尔值的 Python 列表。", "solution": "该问题要求对用于单畴宏自旋的 Landau–Lifshitz–Gilbert (LLG) 方程，推导、实现并比较两种数值积分器。任务的核心是开发一种几何感知的分裂方法，并以标准显式 Runge-Kutta 积分器为基准，测试其相位精度。\n\nLLG 方程以 Gilbert 形式给出，它可以被重排并分解为一个进动项和一个阻尼项。设 $\\gamma' = \\gamma/(1+\\alpha^2)$，在恒定有效场 $\\mathbf{H}$ 中，单位磁化矢量 $\\mathbf{m}$ 的运动方程为：\n$$\n\\frac{d\\mathbf{m}}{dt} = \\underbrace{-\\gamma'\\,\\mathbf{m}\\times\\mathbf{H}}_{\\mathbf{f}_{\\text{prec}}(\\mathbf{m})} + \\underbrace{-\\alpha\\gamma'\\,\\mathbf{m}\\times(\\mathbf{m}\\times\\mathbf{H})}_{\\mathbf{f}_{\\text{damp}}(\\mathbf{m})}\n$$\n磁场是恒定的，$\\mathbf{H} = H_0\\mathbf{h}$，其中 $\\mathbf{h}$ 是一个单位矢量。在模拟中，我们使用 $\\mathbf{h}=\\hat{\\mathbf{z}}$。\n\n采用对称二阶 Strang 分裂格式来对该系统进行积分。在一个时间步长 $\\Delta t$ 上的形式解可近似为对应于进动流和阻尼流的算子复合：\n$$\n\\mathbf{m}(t+\\Delta t) \\approx \\mathcal{D}_{\\Delta t/2} \\circ \\mathcal{P}_{\\Delta t} \\circ \\mathcal{D}_{\\Delta t/2}(\\mathbf{m}(t))\n$$\n其中 $\\mathcal{P}_{\\Delta t}$ 是在完整时间步长 $\\Delta t$ 上的进动流算子，而 $\\mathcal{D}_{\\tau}$ 是在时间间隔 $\\tau = \\Delta t/2$ 上的阻尼流算子。我们现在将推导这些算子的精确解析形式。\n\n**1. 进动子步骤 $\\mathcal{P}_{\\Delta t}$**\n\n进动动力学由以下线性常微分方程 (ODE) 描述：\n$$\n\\frac{d\\mathbf{m}}{dt} = -\\gamma' \\mathbf{m} \\times \\mathbf{H} = \\omega (\\mathbf{h} \\times \\mathbf{m})\n$$\n其中 $\\omega = \\gamma' H_0$ 是拉莫尔进动频率。此方程描述了矢量 $\\mathbf{m}$ 围绕由 $\\mathbf{h}$ 定义的轴以恒定角速度 $\\omega$ 进行的刚性旋转。一个时间步长 $\\Delta t$ 的解析解是旋转一个角度 $\\theta = \\omega \\Delta t$。这个旋转可以使用 Rodrigues 旋转公式精确计算：\n$$\n\\mathcal{P}_{\\Delta t}(\\mathbf{m}_{\\text{in}}) = \\mathbf{m}_{\\text{in}} \\cos\\theta + (\\mathbf{h} \\times \\mathbf{m}_{\\text{in}}) \\sin\\theta + \\mathbf{h} (\\mathbf{h} \\cdot \\mathbf{m}_{\\text{in}}) (1 - \\cos\\theta)\n$$\n由于此映射是精确的旋转，它自然会保持磁化强度的范数，即 $\\|\\mathbf{m}\\|=1$。\n\n**2. 阻尼子步骤 $\\mathcal{D}_{\\tau}$**\n\n阻尼动力学由以下非线性常微分方程描述：\n$$\n\\frac{d\\mathbf{m}}{dt} = -\\alpha\\gamma'\\,\\mathbf{m}\\times(\\mathbf{m}\\times\\mathbf{H})\n$$\n使用矢量三重积恒等式 $\\mathbf{a}\\times(\\mathbf{b}\\times\\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c})-\\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$ 和 $\\|\\mathbf{m}\\|=1$，方程变为：\n$$\n\\frac{d\\mathbf{m}}{dt} = \\alpha\\gamma' \\left( \\mathbf{H} - (\\mathbf{m}\\cdot\\mathbf{H})\\mathbf{m} \\right)\n$$\n此方程描述了一个将 $\\mathbf{m}$ 移向与 $\\mathbf{H}$ 对齐的流。其运动被约束在单位球面上穿过初始磁化矢量和场矢量 $\\mathbf{H}$ 的大圆上。这种几何洞察使我们能够找到阻尼子步骤的精确解析解。\n\n设 $\\phi(t)$ 为 $\\mathbf{m}(t)$ 和 $\\mathbf{h}$ 之间的极角。我们可以将 $\\mathbf{m}(t)$ 参数化为 $\\mathbf{m}(t) = \\cos(\\phi(t))\\mathbf{h} + \\sin(\\phi(t))\\hat{\\mathbf{p}}$，其中 $\\hat{\\mathbf{p}}$ 是位于运动平面内且垂直于 $\\mathbf{h}$ 的固定单位矢量。将此代入阻尼常微分方程，得到关于角度 $\\phi(t)$ 的标量常微分方程：\n$$\n\\frac{d\\phi}{dt} = -\\alpha\\gamma'H_0 \\sin\\phi\n$$\n这是一个可分离的常微分方程。为了找到在时间间隔 $\\tau$ 上的映射，我们进行积分：\n$$\n\\int_{\\phi_{\\text{old}}}^{\\phi_{\\text{new}}} \\frac{d\\phi}{\\sin\\phi} = \\int_{0}^{\\tau} -\\alpha\\gamma'H_0 dt\n$$\n$\\csc\\phi$ 的积分是 $\\ln|\\tan(\\phi/2)|$。这导出：\n$$\n\\ln\\left(\\frac{\\tan(\\phi_{\\text{new}}/2)}{\\tan(\\phi_{\\text{old}}/2)}\\right) = -\\alpha\\gamma'H_0\\tau\n$$\n求解 $\\phi_{\\text{new}}$，我们得到显式的闭式更新规则：\n$$\n\\tan(\\phi_{\\text{new}}/2) = \\tan(\\phi_{\\text{old}}/2) \\exp(-\\alpha\\gamma'H_0\\tau)\n$$\n给定一个输入矢量 $\\mathbf{m}_{\\text{old}}$，我们首先找到其极角 $\\phi_{\\text{old}} = \\arccos(\\mathbf{m}_{\\text{old}}\\cdot\\mathbf{h})$。然后我们使用上述公式找到 $\\phi_{\\text{new}}$。新的矢量 $\\mathbf{m}_{\\text{new}}$ 在保持运动平面的前提下被重建：\n$$\n\\mathbf{m}_{\\text{new}} = \\cos(\\phi_{\\text{new}})\\mathbf{h} + \\sin(\\phi_{\\text{new}})\\frac{\\mathbf{m}_{\\text{old}} - (\\mathbf{m}_{\\text{old}}\\cdot\\mathbf{h})\\mathbf{h}}{\\|\\mathbf{m}_{\\text{old}} - (\\mathbf{m}_{\\text{old}}\\cdot\\mathbf{h})\\mathbf{h}\\|}\n$$\n这个用于阻尼流的精确解是无条件稳定的，并且通过构造保持了单位范数，满足了对阻尼子步骤积分器的所有要求。\n\n**3. 基准：四阶 Runge-Kutta (RK4) 方法**\n\n为了比较，一个标准的显式四阶 Runge-Kutta (RK4) 方法被直接应用于完整的 LLG 方程。从时间 $t_n$ 到 $t_n+\\Delta t$ 的单个 RK4 步骤是：\n$$\n\\begin{aligned}\n    \\mathbf{k}_1 = \\mathbf{f}(\\mathbf{m}_n) \\\\\n    \\mathbf{k}_2 = \\mathbf{f}(\\mathbf{m}_n + \\frac{\\Delta t}{2}\\mathbf{k}_1) \\\\\n    \\mathbf{k}_3 = \\mathbf{f}(\\mathbf{m}_n + \\frac{\\Delta t}{2}\\mathbf{k}_2) \\\\\n    \\mathbf{k}_4 = \\mathbf{f}(\\mathbf{m}_n + \\Delta t\\mathbf{k}_3) \\\\\n    \\mathbf{m}_{n+1}^* = \\mathbf{m}_n + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\n其中 $\\mathbf{f}(\\mathbf{m}) = \\mathbf{f}_{\\text{prec}}(\\mathbf{m}) + \\mathbf{f}_{\\text{damp}}(\\mathbf{m})$。RK4 方法不内在地保持 $\\mathbf{m}$ 的单位范数。因此，必须在每个时间步之后应用一个投影步骤 $\\mathbf{m}_{n+1} = \\mathbf{m}_{n+1}^* / \\|\\mathbf{m}_{n+1}^*\\|$，以防止非物理的范数漂移。\n\n**4. 相位误差计算**\n\n积分器的精度通过铁磁共振 (FMR) 衰荡模拟中的相位误差来评估。在时间 $t$，进动磁化强度的解析相位是 $\\phi_{\\text{exact}}(t) = \\omega t$。数值相位是 $\\phi_{\\text{num}}(t) = \\mathrm{atan2}(m_y(t), m_x(t))$。模拟运行时间为 $T_{\\text{tot}} = 20 T_{\\text{per}}$，因此精确的最终相位是 $\\phi_{\\text{exact}}(T_{\\text{tot}}) = 40\\pi$，这等价于 $0$ (模 $2\\pi$)。包裹绝对相位误差计算为 $\\varepsilon_\\phi = |\\mathrm{atan2}(\\sin(\\phi_{\\text{num}}-\\phi_{\\text{exact}}), \\cos(\\phi_{\\text{num}}-\\phi_{\\text{exact}}))|$。分裂积分器作为一种精确处理主要振荡部分的几何方法，预期会比通用 RK4 方法表现出显著更低的相位误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares a Landau-Lifshitz-Gilbert (LLG) splitting integrator\n    against a standard RK4 integrator for a ferromagnetic resonance ring-down problem.\n    The comparison is based on the final phase accuracy for three test cases.\n    \"\"\"\n\n    # --- Fundamental Constants ---\n    GAMMA = 1.760859e11  # Gyromagnetic ratio in rad s^-1 T^-1\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case A: Happy path with moderate damping and time step\n        {'name': 'A', 'alpha': 0.02, 'dt_frac': 12},\n        # Case B: Refined time step\n        {'name': 'B', 'alpha': 0.02, 'dt_frac': 40},\n        # Case C: Boundary case with no damping\n        {'name': 'C', 'alpha': 0.0, 'dt_frac': 12},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # --- Parameter Setup ---\n        alpha = case['alpha']\n        dt_frac = case['dt_frac']\n\n        H0 = 1.0  # Tesla\n        h_axis = np.array([0.0, 0.0, 1.0])\n        H_vec = H0 * h_axis\n\n        theta0_deg = 5.0\n        theta0_rad = np.deg2rad(theta0_deg)\n        m0 = np.array([np.sin(theta0_rad), 0.0, np.cos(theta0_rad)])\n\n        gammap = GAMMA / (1.0 + alpha**2)\n        omega = gammap * H0\n        T_per = 2.0 * np.pi / omega\n        \n        T_tot = 20.0 * T_per\n        dt = T_per / dt_frac\n        num_steps = int(round(T_tot / dt))\n\n        # --- Integrator Implementations ---\n\n        # 1. Splitting Method (Half-Damping, Full-Precession, Half-Damping)\n        def precession_step(m, angle):\n            \"\"\"Exact rotation around z-axis by a given angle.\"\"\"\n            cos_a = np.cos(angle)\n            sin_a = np.sin(angle)\n            mx_new = m[0] * cos_a - m[1] * sin_a\n            my_new = m[0] * sin_a + m[1] * cos_a\n            return np.array([mx_new, my_new, m[2]])\n\n        def damping_step(m, tau):\n            \"\"\"Exact solution of the damping sub-problem over time interval tau.\"\"\"\n            if alpha == 0.0:\n                return m\n            \n            s_old = np.clip(m @ h_axis, -1.0, 1.0)\n            \n            # If m is already aligned with H, no damping occurs.\n            if 1.0 - abs(s_old)  1e-14:\n                return np.sign(s_old) * h_axis\n\n            phi_old = np.arccos(s_old)\n            sin_phi_old = np.sin(phi_old)\n\n            lamb = alpha * gammap * H0 * tau\n            tan_phi_old_half = np.tan(phi_old / 2.0)\n            tan_phi_new_half = tan_phi_old_half * np.exp(-lamb)\n            phi_new = 2.0 * np.arctan(tan_phi_new_half)\n\n            s_new = np.cos(phi_new)\n            sin_phi_new = np.sin(phi_new)\n            \n            # Reconstruct the new vector in the same plane (m, h)\n            # m_new = s_new * h + sin_new/sin_old * (m - s_old * h)\n            m_perp_old = m - s_old * h_axis\n            m_new = s_new * h_axis + m_perp_old * (sin_phi_new / sin_phi_old)\n            \n            return m_new\n\n        def integrate_split(m_init, n_steps, dt_val):\n            m = np.copy(m_init)\n            precession_angle = omega * dt_val\n            damping_tau = dt_val / 2.0\n            for _ in range(n_steps):\n                m = damping_step(m, damping_tau)\n                m = precession_step(m, precession_angle)\n                m = damping_step(m, damping_tau)\n            return m\n\n        # 2. RK4 Method\n        def llg_rhs(m):\n            m_cross_H = np.cross(m, H_vec)\n            m_cross_m_cross_H = np.cross(m, m_cross_H)\n            rhs = -gammap * m_cross_H - alpha * gammap * m_cross_m_cross_H\n            return rhs\n\n        def integrate_rk4(m_init, n_steps, dt_val):\n            m = np.copy(m_init)\n            for _ in range(n_steps):\n                k1 = llg_rhs(m)\n                k2 = llg_rhs(m + dt_val / 2.0 * k1)\n                k3 = llg_rhs(m + dt_val / 2.0 * k2)\n                k4 = llg_rhs(m + dt_val * k3)\n                m = m + dt_val / 6.0 * (k1 + 2 * k2 + 2 * k3 + k4)\n                m /= np.linalg.norm(m)  # Re-normalize after each step\n            return m\n\n        # --- Execution and Comparison ---\n        m_final_split = integrate_split(m0, num_steps, dt)\n        m_final_rk4 = integrate_rk4(m0, num_steps, dt)\n\n        # Final phase is 40*pi, which is 0 mod 2*pi\n        phi_exact_final = 0.0\n\n        phi_split = np.arctan2(m_final_split[1], m_final_split[0])\n        phi_rk4 = np.arctan2(m_final_rk4[1], m_final_rk4[0])\n\n        d_phi_split = phi_split - phi_exact_final\n        error_split = abs(np.arctan2(np.sin(d_phi_split), np.cos(d_phi_split)))\n\n        d_phi_rk4 = phi_rk4 - phi_exact_final\n        error_rk4 = abs(np.arctan2(np.sin(d_phi_rk4), np.cos(d_phi_rk4)))\n\n        results.append(error_split  error_rk4)\n\n    # --- Print Final Output ---\n    # The output format is a Python list of booleans, converted to a string.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n```", "id": "3460197"}, {"introduction": "一个数值模拟代码只有在其结果可靠时才具有科学价值。因此，代码验证是计算科学中不可或缺的一环。本练习介绍了使用基准问题进行代码验证的概念，特别是针对磁畴壁在外场和电流驱动下运动的NIST微磁学标准问题。[@problem_id:3460254] 通过这个练习，你将学会思考哪些定量指标（如畴壁速度、沃克击穿阈值）对于验证模拟是否准确地捕捉了LLG方程的物理内涵至关重要，包括沃克击穿等复杂现象。这最终将你开发的模拟工具与真实的科学研究和验证过程联系起来。", "problem": "一个含有横向 Néel 畴壁的软铁磁纳米带，在由自旋转移矩增强的 Landau–Lifshitz–Gilbert (LLG) 方程下进行模拟。有效场源于交换作用、静磁形状各向异性以及均匀的纵向 Zeeman 场。沿纳米带施加均匀的电流密度，产生与电流密度线性相关的电子漂移速度。与此设定相关的 NIST 微磁学标准问题旨在对应用磁场和电流驱动的自旋转移矩下的畴壁运动进行代码验证。从第一性原理出发，Landau–Lifshitz–Gilbert 方程强制要求了有效场周围的进动、Gilbert 阻尼和自旋转移矩之间的力矩平衡，而对一维畴壁的集体坐标简化则得出了关于畴壁中心位置和内禀角的耦合方程。在稳态平移区（内禀角无进动），速度响应由线性力矩平衡决定，而当阻尼无法抗衡横向各向异性力矩时，在 Walker 击穿阈值处会失去稳态平移；超过击穿阈值后，内禀角会发生进动，运动变为振荡性，且时间平均速度降低。\n\n选择能够正确描述在场和电流驱动下畴壁运动的 NIST 微磁学标准问题，并指出 LLG 动力学所蕴含的关键定量验证指标和物理预期结果的选项，该选项应适用于高级代码验证：\n\nA. 在晶体各向异性可忽略但具有有限形状诱导的横向难轴各向异性的软铁磁带中，由场驱动的畴壁运动和由电流驱动的畴壁运动。在击穿阈值以下，速度与外加场呈线性关系，斜率与 $\\gamma \\Delta / \\alpha$ 成正比；速度也与通过非绝热自旋转移矩的电流呈线性关系，斜率与电子漂移速度乘以 $(\\beta / \\alpha)$ 成正比，该电子漂移速度与电流密度成比例；在零场下，当 $\\beta \\to 0$ 时，不会发生稳态漂移。Walker 击穿场与 Gilbert 阻尼和横向各向异性（难轴）场成比例，在击穿阈值以上，畴壁内禀角会发生进动，产生振荡运动和减小的时间平均速度。验证指标包括畴壁中心位置 $q(t)$、线性区内的速度斜率 $v(H)$ 和 $v(J)$、击穿起始阈值、击穿阈值以上的内禀角进动频率、从磁化分布中提取的畴壁宽度 $\\Delta$ 及其与交换作用和各向异性的一致性、$|\\mathbf{m}|=1$ 的守恒性，以及这些量的网格和时间步长收敛性。\n\nB. 场驱动运动和电流驱动运动，其中速度-场关系在低场下是二次的并且与 Gilbert 阻尼无关，Walker 击穿阈值与横向各向异性无关，电流驱动的速度与电子漂移速度直接成正比，而与非绝热参数无关。稳态运动在任何场下都能持续，没有振荡。验证仅依赖于总能量的单调减少和最终状态图像，而不依赖于如 $q(t)$ 或速度斜率等运动学指标。\n\nC. 场驱动和电流驱动的标准问题，其中稳态平移速度在击穿阈值以下与外加场成反比，击穿阈值与 $1/\\alpha$ 成比例，并且增加非绝热参数会降低电流驱动的速度。沿输运方向的周期性边界条件被优先用于抑制反射，且收敛性测试是不必要的，因为畴壁动力学与样品尺寸和离散化无关。\n\nD. 场驱动和电流驱动的标准问题，其中速度-场关系是线性的，但斜率与 $\\alpha \\gamma \\Delta$ 成正比（与阻尼成正比），电流驱动的速度与电子漂移速度乘以 $(1/\\beta)$ 成比例，当 Zeeman 能量等于交换能量时发生 Walker 击穿，且与横向各向异性无关。验证最好仅使用整个纳米带磁化强度的磁滞回线进行，而无需跟踪畴壁位置或内禀角。", "solution": "必须首先验证问题陈述的科学合理性、连贯性和完整性。\n\n### 第一步：提取已知条件\n\n问题陈述提供了关于一个微磁模拟场景的以下信息：\n1.  **系统**：一个软铁磁纳米带。\n2.  **磁构型**：它含有一个横向 Néel 畴壁。\n3.  **控制物理**：Landau–Lifshitz–Gilbert (LLG) 方程，并增加了自旋转移矩 (STT)。\n4.  **有效场贡献**：交换作用、静磁形状各向异性以及一个均匀的纵向 Zeeman 场。\n5.  **电流诱导效应**：施加了均匀的电流密度，导致电子漂移速度与电流密度成线性比例。\n6.  **背景与目的**：该场景与 NIST (美国国家标准与技术研究院) 微磁学标准问题有关，这些问题是为代码验证而设计的。关注的具体现象是由外加磁场和电流驱动的畴壁运动。\n7.  **理论框架**：\n    *   LLG 方程表示进动、Gilbert 阻尼和 STT 之间的力矩平衡。\n    *   一维畴壁的集体坐标模型 (CCM) 将动力学简化为关于畴壁中心位置及其内禀角的耦合方程。\n    *   **稳态平移区**：对于低于某个阈值的驱动，内禀角是静止的，速度响应是线性的。\n    *   **Walker 击穿**：当 Gilbert 阻尼力矩再也无法平衡来自横向各向异性的力矩时，达到此阈值。\n    *   **击穿后区域**：高于该阈值，内禀角开始进动，导致振荡运动和减小的时间平均速度。\n\n### 第二步：使用提取的已知条件进行验证\n\n所提供的问题陈述是对铁磁纳米带中一维畴壁在磁场和自旋极化电流影响下动力学的公认物理学的简洁而准确的总结。\n\n*   **科学依据充分**：该描述完全符合已建立的微磁学理论。LLG 方程、有效场贡献的性质、Slonczewski-Berger 的自旋转移矩模型、畴壁的集体坐标描述以及 Walker 击穿现象都是磁学和自旋电子学领域的基础概念。没有违反科学原理之处。\n*   **问题明确**：问题是根据所提供的物理背景，找出对 NIST 标准问题及其验证指标的正确描述。该背景是自洽的，并为评估选项提供了坚实的基础。\n*   **客观性**：语言技术性强、精确，没有主观或推测性的陈述。\n\n问题陈述被认为是有效的。它在科学上是合理的、问题明确的、客观的，并且对于评估所提供的选项是完整的。\n\n### 第三步：结论与行动\n\n问题陈述是**有效的**。现在将通过推导关键物理关系并评估每个选项来继续解答过程。\n\n### 关键物理关系的推导\n\n一维 (1D) 横向畴壁的动力学可以用一个集体坐标模型来描述，该模型有两个变量：畴壁中心位置 $q(t)$ 和壁内磁化倾斜角 $\\psi(t)$。运动方程由 LLG 方程推导而来，形式如下：\n\n$$ \\frac{dq}{dt} - \\alpha \\Delta \\frac{d\\psi}{dt} = \\frac{\\beta}{\\alpha} v_s $$\n$$ \\Delta \\frac{d\\psi}{dt} + \\alpha \\frac{dq}{dt} = \\gamma_0 \\Delta H_z + v_s + \\frac{1}{2} \\gamma_0 \\Delta H_K \\sin(2\\psi) $$\n在这些方程中，$\\alpha$ 是 Gilbert 阻尼常数，$\\Delta$ 是畴壁宽度参数，$\\beta$ 是非绝热 STT 参数，$\\gamma_0$ 是旋磁比，$H_z$ 是外加纵向磁场，$H_K$ 是横向难轴各向异性场（在纳米带中由形状各向异性引起），$v_s$ 是电子漂移速度，它与电流密度 $J$ 成正比。请注意，对于 STT 项存在不同的约定；我们采用一种常见的约定，其中与 $v_s$ 成正比的绝热力矩在第二个方程中，与 $\\beta v_s$ 成正比的非绝热力矩在第一个方程中。\n\n**1. 场驱动运动 ($v_s = 0, H_z \\ne 0$)**\n方程变为：\n$$ \\frac{dq}{dt} - \\alpha \\Delta \\frac{d\\psi}{dt} = 0 $$\n$$ \\Delta \\frac{d\\psi}{dt} + \\alpha \\frac{dq}{dt} = \\gamma_0 \\Delta H_z + \\frac{1}{2} \\gamma_0 \\Delta H_K \\sin(2\\psi) $$\n对于稳态运动（低于击穿阈值），畴壁结构是刚性的，因此 $\\frac{d\\psi}{dt} = 0$。第一个方程则意味着 $\\frac{dq}{dt} = 0$，这是不正确的。一个更直接的力平衡论证更为清晰。场施加在畴壁上的压力 $2\\mu_0 M_s H_z$，被耗散阻力所平衡，该阻力与速度 $v$ 和阻尼 $\\alpha$ 成正比。耗散阻力为 $\\frac{2\\mu_0 M_s \\alpha}{\\gamma_0 \\Delta} v$。令二者相等，得到：\n$$ 2\\mu_0 M_s H_z = \\frac{2\\mu_0 M_s \\alpha}{\\gamma_0 \\Delta} v $$\n$$ v = \\left(\\frac{\\gamma_0 \\Delta}{\\alpha}\\right) H_z $$\n因此，速度 $v$ 与外加场 $H_ z$ 呈线性关系，其斜率（迁移率）与 $\\frac{\\gamma_0 \\Delta}{\\alpha}$ 成正比。运动受到阻尼的阻碍，因此速度与 $\\alpha$ 成反比。\n\n当场 $H_z$ 强到足以将畴壁角 $\\psi$ 倾斜到其最大稳定值时，发生 Walker 击穿。这个阈值场，即 Walker 场 $H_W$，由 $H_W = \\frac{\\alpha}{2} H_K$ 给出。它与阻尼 $\\alpha$ 和横向各向异性 $H_K$ 都成正比。\n\n**2. 电流驱动运动 ($H_z=0, v_s \\ne 0$)**\n在稳态区域 ($\\frac{d\\psi}{dt} = 0$)，速度 $v = \\frac{dq}{dt}$ 是恒定的。运动方程得以简化。最被接受的结果是非绝热驱动力矩和类阻尼阻力之间的平衡，导致速度为：\n$$ v = \\frac{\\beta}{\\alpha} v_s $$\n速度与电子漂移速度 $v_s$ 呈线性关系（因此与电流密度 $J$ 也呈线性关系）。关键因素是比率 $\\frac{\\beta}{\\alpha}$。如果非绝热性为零 ($\\beta=0$)，则仅靠电流无法驱动稳态运动。\n\n当来自电流的力矩再也无法被各向异性场 $H_K$ 的恢复力矩平衡时，就会发生击穿。超过这个击穿电流，$\\psi$ 开始进动。\n\n**3. 击穿后动力学**\n对于场驱动和电流驱动的运动，超过 Walker 击穿阈值都会导致内禀角 $\\psi$ 持续进动。这导致畴壁速度 $v(t)$ 中出现一个振荡分量，并且时间平均速度 $\\langle v \\rangle$ 会显著低于在击穿点达到的峰值速度。\n\n**4. 验证指标**\n对微磁代码的严格验证（如在 NIST 标准问题中）必须涉及与这些已知的解析和物理结果进行定量比较。这包括：\n*   运动学：畴壁位置 $q(t)$，速度作为驱动的函数 $v(H)$ 和 $v(J)$，以及这些函数在线性区内的斜率。\n*   阈值：准确确定 Walker 击穿场 $H_W$ 和电流 $J_W$。\n*   内部动力学：击穿阈值以上 $\\psi$ 的进动频率。\n*   静态属性：模拟的畴壁轮廓应产生一个与输入材料参数（交换常数 $A$ 和各向异性 $K$）一致的宽度 $\\Delta$。\n*   数值完整性：必须保持磁化大小的守恒性（$|\\mathbf{m}|=1$），并且必须证明结果在离散化网格和模拟时间步长细化时是收敛的。\n\n### 逐项分析\n\n**选项 A：** 此选项与推导出的物理原理和验证要求完全一致。\n*   它正确地指出了物理系统：一个具有形状各向异性的软纳米带。\n*   它陈述了正确的线性速度-场关系，斜率与 $\\gamma \\Delta / \\alpha$ 成正比。\n*   它陈述了正确的线性速度-电流关系，比例因子为 $\\beta / \\alpha$，并正确指出如果 $\\beta \\to 0$，运动将停止。\n*   它正确地指出 Walker 击穿场与阻尼 $\\alpha$ 和横向各向异性 $H_K$ 均成比例。\n*   它正确地描述了击穿后的动力学：内禀角的进动和减小的平均速度。\n*   它提供了一个全面且适当的定量验证指标列表，包括运动学（$q(t)$, $v(H)$, $v(J)$）、阈值、内部动力学、静态属性（$\\Delta$）以及必要的数值检查（守恒和收敛）。\n**结论：正确。**\n\n**选项 B：** 此选项包含多个基本错误。\n*   速度-场关系是线性的，而非二次的。它依赖于 Gilbert 阻尼，而非独立于它。\n*   Walker 击穿阈值严重依赖于横向各向异性，而非独立于它。\n*   电流驱动的速度并非独立于非绝热参数；$\\beta$ 是驱动力的关键部分。\n*   稳态运动不会在任何场强下都持续；Walker 击穿是一个决定性特征。\n*   验证必须包括运动学指标，而不仅仅是最终状态和能量。\n**结论：不正确。**\n\n**选项 C：** 此选项的每一点都是错误的。\n*   速度与外加场成正比，而非反比。\n*   击穿阈值 $H_W$ 与 $\\alpha$ 成正比，而非 $1/\\alpha$。\n*   增加非绝热参数 $\\beta$ 会增加而非减少电流驱动的速度。\n*   在任何计算科学（包括标准问题）的背景下，声称收敛性测试是不必要的都是一个致命的缺陷。虽然周期性边界条件对于某些问题是有效的选择，但在有限条带中抑制反射通常是通过吸收边界来完成的，这使得“优先”的说法值得怀疑。\n**结论：不正确。**\n\n**选项 D：** 此选项也包含多个基本错误。\n*   速度-场斜率与 $1/\\alpha$ 成正比，而非 $\\alpha$。更高的阻尼会降低迁移率。\n*   电流驱动的速度与 $\\beta/\\alpha$ 成比例，而非 $1/\\beta$。\n*   Walker 击穿是涉及各向异性力矩的动态不稳定性，而非 Zeeman 能量和交换能量的简单相等。它并非独立于横向各向异性。\n*   对于一个专注于畴壁动力学的问题，仅使用磁滞回线进行验证是不充分的。它无法捕捉速度、内禀角进动和其他关键量。\n**结论：不正确。**\n\n基于这一严谨分析，选项 A 是唯一一个对指定的 NIST 微磁学标准问题提供了科学上正确和完整描述的选项。", "answer": "$$\\boxed{A}$$", "id": "3460254"}]}