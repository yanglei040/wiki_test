{"hands_on_practices": [{"introduction": "在任何导向分子动力学（SMD）模拟中，一个关键的实践决策是选择拉伸速度。这个选择是一个微妙的权衡：拉伸太快会引入大量的耗散功，可能使系统远离平衡态，从而违反了许多自由能计算方法（如Jarzynski恒等式）的基本假设；而拉伸太慢则会耗费过多的计算资源。本练习提供了一种基于系统弛豫时间来确定合适拉伸速度的定量方法，确保模拟在“近平衡”或准静态条件下进行，从而在计算效率和物理准确性之间取得平衡。", "problem": "考虑一个描述软材料反应坐标的一维集体变量 $\\xi$，该变量处于牵引分子动力学（SMD）模拟中。一个刚度系数为 $k_{s}$ 的谐波牵引势施加于系统，其势能最小值根据 $\\lambda(t)=\\lambda_{0}+v t$ 以恒定速率 $v$ 平移。在局部最小值附近，其基础平衡自由能可以很好地用二次形式 $U_{0}(\\xi)\\approx \\tfrac{1}{2}\\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})^{2}$ 来近似，其中曲率 $\\kappa_{0}>0$。$\\xi$ 的动力学是过阻尼的，其标量摩擦系数为 $\\gamma$，因此在高摩擦极限下，其运动方程为牵引坐标的过阻尼 Langevin 方程：\n$\\gamma\\,\\dot{\\xi}(t)=-\\partial_{\\xi}U_{0}(\\xi)-k_{s}\\big(\\xi-\\lambda(t)\\big)+\\zeta(t)$，\n其中 $\\zeta(t)$ 是代表热涨落的零均值高斯噪声。假设在最小值附近为线性响应，并关注确定性弛豫（即，分析平均动力学，忽略涨落）。\n\n1. 从上述方程和 $U_{0}(\\xi)$ 的二次近似出发，推导出一个线性常微分方程，该方程描述了在固定势阱位置下，$\\xi$ 偏离其瞬时稳态的演化。并用 $\\gamma$、$\\kappa_{0}$ 和 $k_{s}$ 表示牵引坐标的过阻尼弛豫时间 $\\tau_{\\mathrm{relax}}$。\n\n2. 对于一个由参数 $\\gamma=2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}$、$\\kappa_{0}=2.0\\times 10^{2}\\ \\mathrm{pN/nm}$ 和 $k_{s}=1.0\\times 10^{3}\\ \\mathrm{pN/nm}$ 表征的系统，计算 $\\tau_{\\mathrm{relax}}$ 的数值。\n\n3. 为了在牵引过程中维持近平衡条件，我们通过施加安全因子 $\\epsilon=0.10$ 并使用等式 $v\\,\\tau_{\\mathrm{relax}}=\\epsilon\\,\\Delta \\xi$ 来满足判据 $v\\,\\tau_{\\mathrm{relax}}\\ll \\Delta \\xi$。给定特征长度尺度 $\\Delta \\xi=1.0\\times 10^{-1}\\ \\mathrm{nm}$，确定满足此近平衡判据的最大牵引速率 $v_{\\max}$。\n\n将最终答案表示为 $v_{\\max}$ 在 $\\mathrm{nm/ps}$ 单位下的数值，四舍五入到四位有效数字。最终答案只需报告 $v_{\\max}$。", "solution": "在过阻尼区域中，研究牵引集体变量动力学的合适出发点是过阻尼 Langevin 方程，该方程体现了粘性阻力、保守力和热噪声之间的力平衡。对于一维集体变量 $\\xi$，该方程为\n$\\gamma\\,\\dot{\\xi}(t)=-\\partial_{\\xi}U_{0}(\\xi)-k_{s}\\big(\\xi-\\lambda(t)\\big)+\\zeta(t)$，\n其中 $\\gamma$ 是将速度与粘性阻力耦合的标量摩擦系数，$U_{0}(\\xi)$ 是基础保守势。在局部最小值附近，$U_{0}(\\xi)$ 可用二次形式近似为 $U_{0}(\\xi)\\approx \\tfrac{1}{2}\\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})^{2}$，其曲率 $\\kappa_{0}>0$，因此 $\\partial_{\\xi}U_{0}(\\xi)\\approx \\kappa_{0}(\\xi-\\xi_{\\mathrm{eq}})$。\n\n代入二次近似并取平均值（使得 $\\langle \\zeta(t)\\rangle=0$），得到一个关于平均坐标的线性确定性方程，为简洁起见，我们仍将其记为 $\\xi(t)$：\n$\\gamma\\,\\dot{\\xi}(t)=-\\kappa_{0}\\big(\\xi(t)-\\xi_{\\mathrm{eq}}\\big)-k_{s}\\big(\\xi(t)-\\lambda(t)\\big)$。\n整理各项得\n$\\gamma\\,\\dot{\\xi}(t)+(\\kappa_{0}+k_{s})\\,\\xi(t)=\\kappa_{0}\\,\\xi_{\\mathrm{eq}}+k_{s}\\,\\lambda(t)$。\n这是一个一阶非齐次线性常系数微分方程。其齐次部分为\n$\\gamma\\,\\dot{\\xi}_{h}(t)+(\\kappa_{0}+k_{s})\\,\\xi_{h}(t)=0$，\n其解为一个指数弛豫，\n$\\xi_{h}(t)=C\\,\\exp\\!\\big(-t/\\tau_{\\mathrm{relax}}\\big)$，\n其中时间常数 $\\tau_{\\mathrm{relax}}$ 由齐次衰减率的倒数给出：\n$\\tau_{\\mathrm{relax}}=\\dfrac{\\gamma}{\\kappa_{0}+k_{s}}$。\n这个时间常数刻画了偏离瞬时稳态的弛豫过程，它与具体的驱动协议 $\\lambda(t)$ 无关，因为齐次算子由总曲率 $\\kappa_{0}+k_{s}$ 决定。\n\n对于给定的数值参数 $\\gamma=2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}$、$\\kappa_{0}=2.0\\times 10^{2}\\ \\mathrm{pN/nm}$ 和 $k_{s}=1.0\\times 10^{3}\\ \\mathrm{pN/nm}$，曲率之和为\n$\\kappa_{0}+k_{s}=2.0\\times 10^{2}+1.0\\times 10^{3}=1.2\\times 10^{3}\\ \\mathrm{pN/nm}$。\n因此，\n$\\tau_{\\mathrm{relax}}=\\dfrac{2.0\\times 10^{4}\\ \\mathrm{pN\\cdot ps/nm}}{1.2\\times 10^{3}\\ \\mathrm{pN/nm}}=1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}$，\n即\n$\\tau_{\\mathrm{relax}}=1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}$。\n\n为确保近平衡牵引，我们施加条件 $v\\,\\tau_{\\mathrm{relax}}=\\epsilon\\,\\Delta \\xi$，其中安全因子 $\\epsilon=0.10$，且 $\\Delta \\xi=1.0\\times 10^{-1}\\ \\mathrm{nm}$。求解最大允许牵引速率得\n$v_{\\max}=\\dfrac{\\epsilon\\,\\Delta \\xi}{\\tau_{\\mathrm{relax}}}$。\n代入数值，\n$v_{\\max}=\\dfrac{1.0\\times 10^{-1}\\times 1.0\\times 10^{-1}\\ \\mathrm{nm}}{1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}}=\\dfrac{1.0\\times 10^{-2}\\ \\mathrm{nm}}{1.666666\\ldots\\times 10^{1}\\ \\mathrm{ps}}$。\n注意到 $1.666666\\ldots\\times 10^{1}=50/3$，我们得到\n$v_{\\max}=\\left(1.0\\times 10^{-2}\\right)\\times \\dfrac{3}{50}\\ \\mathrm{nm/ps}=6.0\\times 10^{-4}\\ \\mathrm{nm/ps}$。\n四舍五入到四位有效数字并以 $\\mathrm{nm/ps}$ 为单位表示，结果为\n$v_{\\max}=6.000\\times 10^{-4}\\ \\mathrm{nm/ps}$。\n\n因此，与指定的近平衡判据相符的最大牵引速率是 $6.000\\times 10^{-4}\\ \\mathrm{nm/ps}$。", "answer": "$$\\boxed{6.000\\times 10^{-4}}$$", "id": "3490247"}, {"introduction": "即使选择了合适的拉伸速度，SMD本质上仍然是一个非平衡过程，不可避免地会产生耗散功。在一个正向-反向的拉伸循环中，这种耗散在力-伸长曲线中表现为“滞后”现象，即正向和反向路径不重合，所围成的面积等于该循环中耗散的功。本练习将指导您推导滞后环面积与拉伸速度之间的关系，并进一步设计一个计算分析方案，从模拟数据中提取出系统的基本物理性质——摩擦系数 $\\zeta$。这个实践深刻地揭示了如何利用非平衡测量来探究系统的平衡或近平衡特性。", "problem": "考虑一个受到 Steered Molecular Dynamics (SMD) 拉伸的一维过阻尼坐标。控制参数（陷阱中心）以分段恒速的协议驱动：首先以速度 $v$ 正向移动位移 $L$，然后立即以相同的速度 $v$ 反向回到原点。系统是谐振的，有效刚度为 $k$，并遵循摩擦系数为 $\\zeta$ 的过阻尼动力学。在时间 $t$ 的保守势为 $U(x,t)=\\tfrac{1}{2}k\\left(x-\\lambda(t)\\right)^{2}$，其中 $\\lambda(t)$ 是外部施加的陷阱位置。假设在 $t=0$ 时系统处于初始平衡状态，且 $\\lambda(0)=0$，并且有一个持续时间为 $T=L/v$ 的正向拉伸段，紧接着是一个相同持续时间的反向段。\n\n从过阻尼朗之万方程和通过改变控制参数所做的热力学功的标准定义出发，推导出每个段的平均耗散功 $\\langle W_{\\text{diss}}\\rangle$（用 $k$、$\\zeta$、$L$ 和 $v$ 表示），且不预先假设任何极限情况。然后，通过将正向和反向段组合成一个完整的循环，将磁滞回线面积（等于封闭协议下的总耗散功）$\\mathcal{A}(v)$ 表示为 $k$、$\\zeta$、$L$ 和 $v$ 的函数。使用小 $v$ 展开来确定 $\\mathcal{A}(v)$ 如何随 $v$ 变化，并确定其主阶系数。基于此，设计一个线性回归分析，对于固定的 $L$，在小 $v$ 的情况下，从平均耗散功对速度的曲线斜率 $s$ 中提取 $\\zeta$。具体来说，定义一个在线性响应区域有效的估计量 $\\hat{\\zeta}=s/(2L)$。\n\n你的任务是实现一个完整的、可运行的程序，该程序：\n- 对于下面给出的每个测试用例参数集，使用你推导出的表达式，为每个指定的 $v$ 计算精确的平均磁滞回线面积 $\\mathcal{A}(v)$。\n- 对 $\\mathcal{A}(v)$ 与 $v$ 的关系进行普通最小二乘拟合以获得斜率 $s$，然后为该测试用例计算 $\\hat{\\zeta}=s/(2L)$。\n- 汇总所有测试用例的结果，并将其打印为单行，形式为方括号内由逗号分隔的浮点数列表。每个浮点数必须是以 pN·ps/nm 为单位的估计摩擦系数 $\\hat{\\zeta}$，并四舍五入到六位小数。\n\n所有量在整个问题中均使用以下单位：$k$ 的单位为 pN/nm，$\\zeta$ 的单位为 pN·ps/nm， $L$ 的单位为 nm，$v$ 的单位为 nm/ps，时间的单位为 ps，功的单位为 pN·nm。本问题不涉及角度。本问题中没有百分比。\n\n参数集测试套件：\n- 案例 1：$k=50$，$\\zeta=5$，$L=5$，$v\\in\\{0.02,0.04,0.06,0.08\\}$。\n- 案例 2：$k=10$，$\\zeta=1$，$L=10$，$v\\in\\{0.005,0.01,0.02\\}$。\n- 案例 3：$k=200$，$\\zeta=20$，$L=1$，$v\\in\\{0.5,1.0,2.0\\}$。\n- 案例 4：$k=30$，$\\zeta=3$，$L=0.5$，$v\\in\\{0.01,0.02,0.05,0.1\\}$。\n\n你的程序应产生单行输出，按顺序包含案例 1 到 4 的估计摩擦系数，形式为方括号内由逗号分隔的列表，每个值以 pN·ps/nm 为单位并四舍五入到六位小数（例如，“[$\\hat{\\zeta}_1,\\hat{\\zeta}_2,\\hat{\\zeta}_3,\\hat{\\zeta}_4$]” 但打印为不带单位的纯数字）。不应产生任何其他输出。", "solution": "用户提供的问题已经过评估，并被确定为**有效**。它在非平衡统计力学方面有科学依据，问题设定良好，具有完整且一致的参数集，并以客观、正式的语言表述。任务是推导在特定拉伸协议下，谐振陷阱中粒子在一个循环内的平均耗散功，然后基于推导出的表达式实现数值分析。\n\n推导过程如下。\n\n**1. 运动方程与平均位置**\n\n系统由一维坐标 $x$ 描述，其遵循过阻尼朗之万方程：\n$$ \\zeta \\frac{dx}{dt} = -\\frac{\\partial U(x,t)}{\\partial x} + \\eta(t) $$\n其中 $\\zeta$ 是摩擦系数，$\\eta(t)$ 是一个热噪声项，满足 $\\langle \\eta(t) \\rangle = 0$，势能为 $U(x,t) = \\frac{1}{2}k(x-\\lambda(t))^2$。保守力为 $-\\frac{\\partial U}{\\partial x} = -k(x-\\lambda(t))$。\n\n对朗之万方程在所有噪声实现上取平均，得到关于平均位置 $\\langle x(t) \\rangle$ 的方程：\n$$ \\zeta \\frac{d\\langle x \\rangle}{dt} = -k(\\langle x \\rangle - \\lambda(t)) $$\n这可以写成以弛豫时间 $\\tau_R = \\zeta/k$ 表示的形式：\n$$ \\frac{d\\langle x \\rangle}{dt} + \\frac{1}{\\tau_R} \\langle x \\rangle = \\frac{1}{\\tau_R} \\lambda(t) $$\n问题将平均位置与陷阱中心之间的滞后定义为 $\\delta(t) = \\langle x(t) \\rangle - \\lambda(t)$。对 $\\delta(t)$ 关于时间求导，可直接得到关于滞后的方程：\n$$ \\frac{d\\delta}{dt} = \\frac{d\\langle x \\rangle}{dt} - \\frac{d\\lambda}{dt} = \\frac{1}{\\tau_R}(\\lambda(t) - \\langle x(t) \\rangle) - \\dot{\\lambda}(t) = -\\frac{1}{\\tau_R}\\delta(t) - \\dot{\\lambda}(t) $$\n$$ \\frac{d\\delta}{dt} + \\frac{1}{\\tau_R}\\delta(t) = -\\dot{\\lambda}(t) $$\n\n**2. 平均功与耗散功**\n\n外部协议对系统所做的功由下式给出：\n$$ W = \\int \\frac{\\partial U}{\\partial\\lambda} \\dot{\\lambda}(t) dt = \\int -k(x(t)-\\lambda(t))\\dot{\\lambda}(t) dt $$\n平均功通过对噪声取平均得到：\n$$ \\langle W \\rangle = \\int -k(\\langle x(t) \\rangle - \\lambda(t))\\dot{\\lambda}(t) dt = \\int -k\\delta(t)\\dot{\\lambda}(t) dt $$\n平均耗散功为 $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle - \\Delta F$，其中 $\\Delta F$ 是系统平衡自由能的变化。对于谐振势，自由能与陷阱位置 $\\lambda$ 无关。因此，对于任何过程，$\\Delta F = 0$，且 $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle$。\n\n**3. 正向拉伸段 ($0 \\le t \\le T$)**\n\n对于正向段，陷阱以恒定速度 $v$ 从 $\\lambda=0$ 移动到 $\\lambda=L$。因此，$\\lambda(t) = vt$ 且 $\\dot{\\lambda}(t)=v$。持续时间为 $T=L/v$。系统从平衡态开始，所以 $\\langle x(0) \\rangle=0$ 且 $\\lambda(0)=0$，这意味着初始滞后 $\\delta(0)=0$。正向滞后 $\\delta_F(t)$ 的常微分方程(ODE)为：\n$$ \\frac{d\\delta_F}{dt} + \\frac{1}{\\tau_R}\\delta_F = -v $$\n在初始条件 $\\delta_F(0)=0$ 下，解为：\n$$ \\delta_F(t) = -v\\tau_R(1 - e^{-t/\\tau_R}) $$\n正向段的平均功为：\n$$ \\langle W_F \\rangle = \\int_0^T -k\\delta_F(t)v dt = kv\\int_0^T v\\tau_R(1-e^{-t/\\tau_R})dt = kv^2\\tau_R \\left[t+\\tau_Re^{-t/\\tau_R}\\right]_0^T $$\n$$ \\langle W_F \\rangle = kv^2\\tau_R \\left(T - \\tau_R(1-e^{-T/\\tau_R})\\right) $$\n代入 $T=L/v$ 和 $\\tau_R=\\zeta/k$：\n$$ \\langle W_F \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(1-e^{-kL/(v\\zeta)}\\right) $$\n\n**4. 反向拉伸段 ($T \\le t \\le 2T$)**\n\n对于反向段，陷阱以速度 $v$ 从 $\\lambda=L$ 回到 $\\lambda=0$。令 $t' = t-T$，其中 $0 \\le t' \\le T$。则 $\\lambda(t') = L-vt'$ 且 $\\dot{\\lambda}(t')=-v$。反向滞后 $\\delta_R(t')$ 的常微分方程为：\n$$ \\frac{d\\delta_R}{dt'} + \\frac{1}{\\tau_R}\\delta_R = v $$\n此段的初始条件是正向段的最终状态：$\\delta_R(t'=0) = \\delta_F(t=T) = -v\\tau_R(1-e^{-T/\\tau_R})$。解为：\n$$ \\delta_R(t') = \\left(\\delta_R(0) - v\\tau_R\\right)e^{-t'/\\tau_R} + v\\tau_R = \\left(-2v\\tau_R + v\\tau_Re^{-T/\\tau_R}\\right)e^{-t'/\\tau_R} + v\\tau_R $$\n反向段的平均功为：\n$$ \\langle W_R \\rangle = \\int_0^T -k\\delta_R(t')(-v) dt' = kv\\int_0^T \\delta_R(t') dt' $$\n计算该积分可得：\n$$ \\int_0^T \\delta_R(t')dt' = v\\tau_R \\left[ T - 2\\tau_R + 3\\tau_Re^{-T/\\tau_R} - \\tau_R e^{-2T/\\tau_R} \\right] $$\n所以功为：\n$$ \\langle W_R \\rangle = kv^2\\tau_R \\left( T - \\tau_R(2 - 3e^{-T/\\tau_R} + e^{-2T/\\tau_R}) \\right) $$\n代入 $T=L/v$ 和 $\\tau_R=\\zeta/k$：\n$$ \\langle W_R \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}\\right) $$\n\n**5. 磁滞回线面积与线性响应**\n\n闭合回路上的总耗散功，即磁滞回线面积 $\\mathcal{A}(v)$，是正向和反向段所做功的总和：\n$$ \\mathcal{A}(v) = \\langle W_F \\rangle + \\langle W_R \\rangle $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( (1-e^{-kL/(v\\zeta)}) + (2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}) \\right) $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( 3 - 4e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)} \\right) $$\n这是平均磁滞回线面积的精确表达式。\n\n为了进行分析，我们考虑小速度极限 ($v \\to 0$)。在此极限下，指数的参数 $u = kL/(v\\zeta) \\to \\infty$，因此 $e^{-u} \\to 0$。$\\mathcal{A}(v)$ 的表达式可以对小 $v$ 进行展开：\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{3\\zeta^2}{k}v^2 + \\mathcal{O}(v^2e^{-u}) $$\n主阶项是 $v$ 的线性项：\n$$ \\mathcal{A}(v) \\approx 2\\zeta L v $$\n这种线性关系在准静态或线性响应区域 ($v \\ll kL/\\zeta$) 成立。$\\mathcal{A}(v)$ 对 $v$ 在 $v=0$ 处的斜率是 $s = 2\\zeta L$。这提示我们可以基于 $\\mathcal{A}$ 对 $v$ 的实验或模拟数据的线性回归，为摩擦系数 $\\zeta$ 设计一个估计量：\n$$ \\hat{\\zeta} = \\frac{s}{2L} $$\n其中 $s$ 是通过经验确定的斜率。\n\n下面的程序实现了这一分析，它首先为一系列速度 $v$ 计算精确的磁滞回线面积 $\\mathcal{A}(v)$，然后执行普通最小二乘拟合来确定斜率 $s$ 和估计值 $\\hat{\\zeta}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Steered Molecular Dynamics problem by calculating the estimated\n    friction coefficient for several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k, zeta_true, L, list_of_v)\n    test_cases = [\n        (50.0, 5.0, 5.0, [0.02, 0.04, 0.06, 0.08]),\n        (10.0, 1.0, 10.0, [0.005, 0.01, 0.02]),\n        (200.0, 20.0, 1.0, [0.5, 1.0, 2.0]),\n        (30.0, 3.0, 0.5, [0.01, 0.02, 0.05, 0.1]),\n    ]\n\n    results = []\n    for k, zeta_true, L, v_values in test_cases:\n        # Array of pulling speeds for the current test case\n        v_points = np.array(v_values, dtype=np.float64)\n        A_points = []\n\n        # Calculate the exact mean hysteresis area A(v) for each speed v\n        for v in v_points:\n            # The argument of the exponential terms\n            u = k * L / (v * zeta_true)\n            \n            # The exact expression for the hysteresis area A(v)\n            term_in_paren = 3.0 - 4.0 * np.exp(-u) + np.exp(-2.0 * u)\n            A_v = 2.0 * zeta_true * v * L - (zeta_true**2 * v**2 / k) * term_in_paren\n            A_points.append(A_v)\n\n        A_points = np.array(A_points, dtype=np.float64)\n        \n        # Perform Ordinary Least Squares (OLS) regression to find the slope s of A(v) vs v.\n        # The slope s is given by cov(v, A) / var(v).\n        v_mean = np.mean(v_points)\n        A_mean = np.mean(A_points)\n        \n        # Using a numerically stable formula for the slope\n        numerator = np.sum((v_points - v_mean) * (A_points - A_mean))\n        denominator = np.sum((v_points - v_mean)**2)\n        \n        if denominator == 0:\n            # This case occurs if all v_points are the same.\n            # While not in the test suite, it's good practice for robustness.\n            slope_s = 0.0\n        else:\n            slope_s = numerator / denominator\n\n        # Calculate the estimated friction coefficient zeta_hat from the slope\n        zeta_hat = slope_s / (2.0 * L)\n        results.append(zeta_hat)\n\n    # Final print statement in the exact required format.\n    # The output is a single line with a comma-separated list of floats in square brackets,\n    # with each float rounded to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n\n```", "id": "3490224"}, {"introduction": "常规的SMD模拟通常采用最简单的匀速拉伸方案。然而，如果能量耗散是不可避免的，我们是否可以为给定的总模拟时间设计一个“更优”的拉伸方案来将其最小化呢？本练习引入了热力学几何这一前沿概念来回答这个问题。通过将集体变量空间赋予一个由摩擦主导的“度规”，我们可以找到一条在该空间中以恒定“热力学速度”行进的最优路径，从而最小化总耗散。这个实践将引导您推导并实现这样一个最小耗散方案，并将其与传统的匀速拉伸进行比较，让您掌握非平衡模拟中的一种先进优化技术。", "problem": "给定一个一维受控分子动力学问题，该问题在单个集体变量 $\\lambda \\in [0,1]$ 的空间中进行描述。一个谐波导向势在固定的持续时间 $\\tau$ 内施加一个预设的协议 $\\lambda(t)$，其耗散通过广义摩擦度规 $g(\\lambda)$ 在线性响应范围内进行量化，该度规编码了沿集体变量的平衡力自相关。假设瞬时超额功率为 $P_{\\mathrm{ex}}(t) = \\dot{\\lambda}(t)^2 g(\\lambda(t))$，因此总超额功为 $W_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau \\dot{\\lambda}(t)^2 g(\\lambda(t))\\, dt$。热力学长度定义为 $\\mathcal{L}[\\lambda(\\cdot)] = \\int_0^\\tau \\sqrt{\\dot{\\lambda}(t)^T g(\\lambda(t)) \\dot{\\lambda}(t)}\\, dt$，对于单调的一维协议，该定义简化为 $\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)}\\, d\\lambda$。仅从 Newton 定律、功的定义以及证明摩擦度规 $g(\\lambda)$ 是联系广义速度与超额功率的线性响应系数的涨落-耗散关系出发，推导一种有原则的方法，用于构建在 $\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$ 之间固定路径的最小耗散时间参数化。使用变分法或从统计力学中经过充分检验的事实推导出的不等式，来严格证明您的构建方法，并将最小超额功用路径泛函表示，这些泛函可以从 $g(\\lambda)$ 计算得出，而无需模拟动力学过程。然后，作为比较，在相同的条件和持续时间 $\\tau$ 下，计算恒定速度拉伸协议 $\\lambda(t)=t/\\tau$ 的超额功。所有能量必须以 $k_{\\mathrm{B}}T$ 为单位表示。\n\n您的程序必须实现推导出的公式，使用数值积分法计算以下关于度规函数 $g(\\lambda)$ 和持续时间 $\\tau$ 的测试组中所有需要的关于 $\\lambda$ 的积分：\n\n- 情况1：$g(\\lambda) = 1$，$\\tau = 1$。\n- 情况2：$g(\\lambda) = 1 + 4 \\lambda^2$，$\\tau = 1$。\n- 情况3：$g(\\lambda) = \\exp(3\\lambda)$，$\\tau = 1$。\n- 情况4：$g(\\lambda) = \\exp(3\\lambda)$，$\\tau = 2$。\n- 情况5：$g(\\lambda) = (\\lambda + 10^{-3})^{-1/2}$，$\\tau = 1$。\n\n对于每种情况，计算两个量：最小耗散超额功和恒定速度超额功，两者都以 $k_{\\mathrm{B}}T$ 为单位，并四舍五入到六位小数。您的程序应生成单行输出，其中包含按以下顺序排列的、用方括号括起来的逗号分隔列表的结果：\n$[$$W_{\\mathrm{min}}^{(1)}$, $W_{\\mathrm{cv}}^{(1)}$, $W_{\\mathrm{min}}^{(2)}$, $W_{\\mathrm{cv}}^{(2)}$, $W_{\\mathrm{min}}^{(3)}$, $W_{\\mathrm{cv}}^{(3)}$, $W_{\\mathrm{min}}^{(4)}$, $W_{\\mathrm{cv}}^{(4)}$, $W_{\\mathrm{min}}^{(5)}$, $W_{\\mathrm{cv}}^{(5)}$$]$。\n\n所有数值积分必须以足够的精度执行，以确保四舍五入到六位小数的结果是明确的。答案必须是一个完整的、可运行的程序，它能精确打印指定的单行输出，并且不需要用户输入或外部文件。", "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n- **集体变量**：单个一维变量 $\\lambda \\in [0,1]$。\n- **协议**：在固定持续时间 $\\tau$ 内的时间参数化 $\\lambda(t)$。\n- **边界条件**：$\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$。\n- **摩擦度规**：一个广义摩擦度规 $g(\\lambda)$，它将广义速度与超额功率联系起来。\n- **瞬时超额功率**：$P_{\\mathrm{ex}}(t) = \\dot{\\lambda}(t)^2 g(\\lambda(t))$。\n- **总超额功**：$W_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau \\dot{\\lambda}(t)^2 g(\\lambda(t))\\, dt$。\n- **热力学长度**：对于单调一维协议，$\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)}\\, d\\lambda$。\n- **能量单位**：所有能量必须以 $k_{\\mathrm{B}}T$ 为单位表示。\n- **任务**：\n    1. 推导一种构建最小耗散时间参数化 $\\lambda(t)$ 的方法。\n    2. 使用变分法或推导出的不等式来证明该构建方法。\n    3. 将最小超额功 $W_{\\mathrm{min}}$ 用 $g(\\lambda)$ 的路径泛函表示。\n    4. 计算恒定速度协议 $\\lambda(t)=t/\\tau$ 的超额功 $W_{\\mathrm{cv}}$。\n- **测试用例**：\n    - 情况1：$g(\\lambda) = 1$，$\\tau = 1$。\n    - 情况2：$g(\\lambda) = 1 + 4 \\lambda^2$，$\\tau = 1$。\n    - 情况3：$g(\\lambda) = \\exp(3\\lambda)$，$\\tau = 1$。\n    - 情况4：$g(\\lambda) = \\exp(3\\lambda)$，$\\tau = 2$。\n    - 情况5：$g(\\lambda) = (\\lambda + 10^{-3})^{-1/2}$，$\\tau = 1$。\n- **输出格式**：一个单行的逗号分隔值列表：$[W_{\\mathrm{min}}^{(1)}, W_{\\mathrm{cv}}^{(1)}, \\dots, W_{\\mathrm{min}}^{(5)}, W_{\\mathrm{cv}}^{(5)}]$，数值四舍五入到六位小数。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据、良态且客观。\n- **科学依据**：该问题的表述是线性响应理论和热力学几何在非平衡统计力学中的一个标准且成熟的应用，特别是在受控分子动力学的背景下。超额功和热力学长度的表达式是规范的。\n- **良态性**：该问题是一个经典的最优控制问题（具体来说，是一个重参数化问题），旨在找到一个函数 $\\lambda(t)$，使其在明确定义的边界条件下最小化给定的泛函 $W_{\\mathrm{ex}}$。存在唯一解，并且需要求出该解。\n- **客观性与清晰度**：该问题使用精确的数学和物理术语进行陈述。定义和目标均无歧义。测试用例具体，可以进行明确的数值评估。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将构建一个有原则的解决方案。\n\n## 推导与求解\n\n主要目标是找到时间参数化 $\\lambda:[0, \\tau] \\rightarrow [0, 1]$，以最小化总超额功泛函，\n$$\nW_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau g(\\lambda(t)) \\dot{\\lambda}(t)^2 \\, dt\n$$\n该参数化需满足边界条件 $\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$。此处，$\\dot{\\lambda}(t)$ 表示时间导数 $d\\lambda/dt$。\n\n我们将使用从积分的 Cauchy-Schwarz 不等式推导出的不等式来求解最小功。Cauchy-Schwarz 不等式指出，对于区间 $[a,b]$ 上的任意两个实值、平方可积的函数 $f(t)$ 和 $h(t)$，\n$$\n\\left( \\int_a^b f(t) h(t) \\, dt \\right)^2 \\le \\left( \\int_a^b f(t)^2 \\, dt \\right) \\left( \\int_a^b h(t)^2 \\, dt \\right)\n$$\n当且仅当一个函数是另一个函数的常数倍时，即对于某个常数 $c$ 有 $f(t) = c \\cdot h(t)$，等号成立。\n\n我们定义函数 $f(t) = \\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)$ 和 $h(t) = 1$，积分区间为 $[0, \\tau]$。应用该不等式：\n$$\n\\left( \\int_0^\\tau \\left(\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)\\right) \\cdot 1 \\, dt \\right)^2 \\le \\left( \\int_0^\\tau \\left(\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)\\right)^2 \\, dt \\right) \\left( \\int_0^\\tau 1^2 \\, dt \\right)\n$$\n我们来分析这个不等式中的每一项。\n\n右侧的项是总超额功 $W_{\\mathrm{ex}}$ 与总持续时间 $\\tau$ 的乘积：\n$$\n\\left( \\int_0^\\tau g(\\lambda(t)) \\dot{\\lambda}(t)^2 \\, dt \\right) \\left( \\int_0^\\tau 1 \\, dt \\right) = W_{\\mathrm{ex}} \\cdot \\tau\n$$\n\n左侧的项可以通过变量替换（从 $t$ 变为 $\\lambda$）来简化。由于 $d\\lambda = \\dot{\\lambda}(t) dt$，积分变为：\n$$\n\\int_0^\\tau \\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t) \\, dt = \\int_{\\lambda(0)}^{\\lambda(\\tau)} \\sqrt{g(\\lambda)} \\, d\\lambda = \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda\n$$\n这个积分正是 $\\lambda$ 空间中路径的热力学长度的定义，记为 $\\mathcal{L}$。\n$$\n\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda\n$$\n将这些表达式代回 Cauchy-Schwarz 不等式，我们得到：\n$$\n\\mathcal{L}^2 \\le W_{\\mathrm{ex}} \\cdot \\tau\n$$\n这为任何持续时间为 $\\tau$ 的协议 $\\lambda(t)$ 的超额功提供了一个下界：\n$$\nW_{\\mathrm{ex}} \\ge \\frac{\\mathcal{L}^2}{\\tau}\n$$\n最小可能超额功 $W_{\\mathrm{min}}$ 即为该下界，当 Cauchy-Schwarz 不等式中的等号成立时达到。这种情况发生在 $f(t) = c \\cdot h(t)$ 时，即：\n$$\n\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t) = c\n$$\n其中 $c$ 是一个常数。该条件规定了沿路径的速度（在热力学长度度规下测量，即 $\\sqrt{g(\\lambda)} \\frac{d\\lambda}{dt}$）是恒定的。常数 $c$ 可以通过在整个持续时间内对该微分方程进行积分来确定：\n$$\n\\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda = \\int_0^\\tau c \\, dt \\implies \\mathcal{L} = c \\tau \\implies c = \\frac{\\mathcal{L}}{\\tau}\n$$\n满足此条件的协议的存在证实了最小值是可以达到的。因此，最小超额功为：\n$$\nW_{\\mathrm{min}} = \\frac{\\mathcal{L}^2}{\\tau} = \\frac{1}{\\tau} \\left( \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda \\right)^2\n$$\n此表达式仅取决于摩擦度规 $g(\\lambda)$ 和总时间 $\\tau$，它们分别是可从平衡性质和实验设置中计算的量，而无需模拟非平衡过程。\n\n接下来，我们推导恒定速度协议 $\\lambda_{\\mathrm{cv}}(t) = t/\\tau$ 的超额功。对于此协议，速度是恒定的：$\\dot{\\lambda}_{\\mathrm{cv}}(t) = 1/\\tau$。\n超额功 $W_{\\mathrm{cv}}$ 是通过将此协议代入 $W_{\\mathrm{ex}}$ 的定义来计算的：\n$$\nW_{\\mathrm{cv}} = \\int_0^\\tau g(\\lambda_{\\mathrm{cv}}(t)) \\dot{\\lambda}_{\\mathrm{cv}}(t)^2 \\, dt = \\int_0^\\tau g(t/\\tau) \\left(\\frac{1}{\\tau}\\right)^2 \\, dt\n$$\n$$\nW_{\\mathrm{cv}} = \\frac{1}{\\tau^2} \\int_0^\\tau g(t/\\tau) \\, dt\n$$\n为了计算该积分，我们再次进行变量替换，令 $\\lambda = t/\\tau$。这得到 $dt = \\tau \\, d\\lambda$，$\\lambda$ 的积分限为从 $0$ 到 $1$。\n$$\nW_{\\mathrm{cv}} = \\frac{1}{\\tau^2} \\int_0^1 g(\\lambda) (\\tau \\, d\\lambda) = \\frac{1}{\\tau} \\int_0^1 g(\\lambda) \\, d\\lambda\n$$\n\n总而言之，每个测试用例需要计算的两个量是：\n1. 最小耗散超额功：$W_{\\mathrm{min}} = \\frac{1}{\\tau} \\left( \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda \\right)^2$\n2. 恒定速度超额功：$W_{\\mathrm{cv}} = \\frac{1}{\\tau} \\int_0^1 g(\\lambda) \\, d\\lambda$\n\n这些公式将使用数值积分法来实现，以计算关于 $\\lambda$ 的积分。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the steered molecular dynamics problem for five test cases.\n\n    For each case, it calculates two quantities:\n    1. W_min: The minimal-dissipation excess work, derived from thermodynamic\n       geometry principles.\n    2. W_cv: The excess work for a simple constant-velocity pulling protocol.\n\n    The results are formatted and printed as a single line, as specified.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing a lambda function for g(lambda) and the duration tau.\n    test_cases = [\n        (lambda lam: 1.0, 1.0),\n        (lambda lam: 1.0 + 4.0 * lam**2, 1.0),\n        (lambda lam: np.exp(3.0 * lam), 1.0),\n        (lambda lam: np.exp(3.0 * lam), 2.0),\n        (lambda lam: (lam + 1e-3)**(-0.5), 1.0),\n    ]\n\n    results = []\n    for g_func, tau in test_cases:\n        # --- Minimal Excess Work Calculation ---\n\n        # The integrand for the thermodynamic length L is sqrt(g(lambda)).\n        L_integrand = lambda lam: np.sqrt(g_func(lam))\n\n        # Numerically integrate to find the thermodynamic length L.\n        # quad returns the result and an error estimate; we only need the result.\n        # The integration limits are from lambda = 0 to lambda = 1.\n        L, _ = quad(L_integrand, 0, 1, epsabs=1e-12, epsrel=1e-12)\n\n        # The minimal excess work is W_min = L^2 / tau.\n        W_min = (L**2) / tau\n\n        # --- Constant-Velocity Excess Work Calculation ---\n\n        # The integrand for the constant-velocity work is g(lambda) itself.\n        g_integrand = g_func\n        \n        # Numerically integrate g(lambda) from 0 to 1.\n        integral_g, _ = quad(g_integrand, 0, 1, epsabs=1e-12, epsrel=1e-12)\n\n        # The constant-velocity work is W_cv = (integral of g) / tau.\n        W_cv = integral_g / tau\n\n        # Append the rounded results to the list for final output.\n        # We format to 6 decimal places as required.\n        results.append(f\"{W_min:.6f}\")\n        results.append(f\"{W_cv:.6f}\")\n\n    # Final print statement in the exact required format.\n    # Example: [1.000000,1.000000,2.187271,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3490292"}]}