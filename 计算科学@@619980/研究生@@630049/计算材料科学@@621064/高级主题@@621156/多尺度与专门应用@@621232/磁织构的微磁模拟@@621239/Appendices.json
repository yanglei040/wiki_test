{"hands_on_practices": [{"introduction": "在微磁学模拟中，朗道-里夫希兹-吉尔伯特（LLG）方程的动力学行为由有效场 $\\mathbf{H}_{\\text{eff}}$ 驱动。这个场是通过对系统自由能密度进行变分导数计算得出的。本练习将引导你为一种最常见的能量项——单轴各向异性——推导其对应的有效场，这是构建任何微磁学模型的基础步骤。[@problem_id:3466569]", "problem": "一个单轴铁磁体在微磁学中被建模，其单位磁化方向为 $\\mathbf{m}$，饱和磁化强度为 $M_s$。晶体易磁化轴是单位向量 $\\hat{\\mathbf{u}}$。单轴各向异性能量密度由下式给出\n$$\ne_{\\text{ani}}(\\mathbf{m}) = K_u \\left(1 - (\\mathbf{m}\\cdot\\hat{\\mathbf{u}})^2\\right),\n$$\n其中 $K_u$ 是各向异性常数。在由 Landau–Lifshitz–Gilbert (LLG) 方程控制的微磁动力学中，有效场通过变分原理从能量中获得，即来自能量密度 $e(\\mathbf{m})$ 的有效场贡献为\n$$\n\\mathbf{h} = -\\frac{1}{\\mu_0 M_s}\\,\\frac{\\partial e}{\\partial \\mathbf{m}},\n$$\n其中 $\\mu_0$ 是真空磁导率。\n\n从这个原理和给定的能量密度出发，推导出各向异性有效场 $\\mathbf{h}_{\\text{ani}}(\\mathbf{m})$ 作为 $\\mathbf{m}$、$\\hat{\\mathbf{u}}$、$K_u$、$\\mu_0$ 和 $M_s$ 的显式函数。然后，对以下特定方向\n$$\n\\mathbf{m} = \\left(\\frac{2}{3},-\\frac{1}{3},\\frac{2}{3}\\right),\\quad \\hat{\\mathbf{u}} = \\frac{1}{\\sqrt{3}}(1,1,1),\n$$\n和参数\n$$\nK_u = 6.5\\times 10^{5}\\ \\text{J/m}^3,\\quad M_s = 1.0\\times 10^{6}\\ \\text{A/m},\\quad \\mu_0 = 4\\pi\\times 10^{-7}\\ \\text{H/m}.\n$$\n计算其大小。以 $\\text{A/m}$ 为单位报告各向异性有效场的最终大小，并将您的答案四舍五入到四位有效数字。", "solution": "任务是推导单轴各向异性有效场 $\\mathbf{h}_{\\text{ani}}$ 的表达式，然后为给定的一组参数计算其大小。\n\n有效场 $\\mathbf{h}_{\\text{ani}}$ 是使用所提供的变分原理从单轴各向异性能量密度 $e_{\\text{ani}}$ 获得的：\n$$\n\\mathbf{h}_{\\text{ani}}(\\mathbf{m}) = -\\frac{1}{\\mu_0 M_s}\\,\\frac{\\partial e_{\\text{ani}}}{\\partial \\mathbf{m}}\n$$\n能量密度给定为：\n$$\ne_{\\text{ani}}(\\mathbf{m}) = K_u \\left(1 - (\\mathbf{m}\\cdot\\hat{\\mathbf{u}})^2\\right)\n$$\n其中 $K_u$ 是各向异性常数，$\\mathbf{m}$ 是单位磁化向量，$\\hat{\\mathbf{u}}$ 是沿易磁化轴的单位向量，$M_s$ 是饱和磁化强度，$\\mu_0$ 是真空磁导率。\n\n首先，我们推导 $\\mathbf{h}_{\\text{ani}}$ 的通用表达式。项 $\\frac{\\partial e_{\\text{ani}}}{\\partial \\mathbf{m}}$ 表示标量场 $e_{\\text{ani}}$ 关于向量变量 $\\mathbf{m} = (m_x, m_y, m_z)$ 的梯度。设 $\\hat{\\mathbf{u}} = (u_x, u_y, u_z)$。点积为 $\\mathbf{m}\\cdot\\hat{\\mathbf{u}} = m_x u_x + m_y u_y + m_z u_z$。\n\n能量密度可以写作：\n$$\ne_{\\text{ani}} = K_u \\left(1 - (m_x u_x + m_y u_y + m_z u_z)^2\\right)\n$$\n我们计算关于 $\\mathbf{m}$ 的每个分量的偏导数。对于 $x$ 分量 $m_x$：\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial m_x} = \\frac{\\partial}{\\partial m_x} \\left[ K_u \\left(1 - (m_x u_x + m_y u_y + m_z u_z)^2\\right) \\right]\n$$\n使用链式法则：\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial m_x} = K_u \\left( 0 - 2(m_x u_x + m_y u_y + m_z u_z) \\cdot \\frac{\\partial}{\\partial m_x}(m_x u_x + m_y u_y + m_z u_z) \\right)\n$$\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial m_x} = -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) (u_x)\n$$\n根据对称性，关于 $m_y$ 和 $m_z$ 的导数为：\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial m_y} = -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) (u_y)\n$$\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial m_z} = -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) (u_z)\n$$\n因此，梯度向量 $\\frac{\\partial e_{\\text{ani}}}{\\partial \\mathbf{m}}$ 是：\n$$\n\\frac{\\partial e_{\\text{ani}}}{\\partial \\mathbf{m}} = \\left(\\frac{\\partial e_{\\text{ani}}}{\\partial m_x}, \\frac{\\partial e_{\\text{ani}}}{\\partial m_y}, \\frac{\\partial e_{\\text{ani}}}{\\partial m_z}\\right) = -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) (u_x, u_y, u_z) = -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) \\hat{\\mathbf{u}}\n$$\n将此结果代入 $\\mathbf{h}_{\\text{ani}}$ 的表达式中：\n$$\n\\mathbf{h}_{\\text{ani}} = -\\frac{1}{\\mu_0 M_s} \\left[ -2 K_u (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) \\hat{\\mathbf{u}} \\right]\n$$\n这简化为各向异性有效场的显式表达式：\n$$\n\\mathbf{h}_{\\text{ani}} = \\frac{2 K_u}{\\mu_0 M_s} (\\mathbf{m}\\cdot\\hat{\\mathbf{u}}) \\hat{\\mathbf{u}}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们为给定的参数计算 $\\mathbf{h}_{\\text{ani}}$ 的大小。\n给定的向量是：\n$$\n\\mathbf{m} = \\left(\\frac{2}{3}, -\\frac{1}{3}, \\frac{2}{3}\\right)\n$$\n$$\n\\hat{\\mathbf{u}} = \\frac{1}{\\sqrt{3}}(1, 1, 1) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)\n$$\n首先，我们计算点积 $\\mathbf{m}\\cdot\\hat{\\mathbf{u}}$：\n$$\n\\mathbf{m}\\cdot\\hat{\\mathbf{u}} = \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{\\sqrt{3}}\\right) + \\left(-\\frac{1}{3}\\right)\\left(\\frac{1}{\\sqrt{3}}\\right) + \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} \\left(\\frac{2}{3} - \\frac{1}{3} + \\frac{2}{3}\\right) = \\frac{1}{\\sqrt{3}} \\left(\\frac{3}{3}\\right) = \\frac{1}{\\sqrt{3}}\n$$\n那么向量 $\\mathbf{h}_{\\text{ani}}$ 是：\n$$\n\\mathbf{h}_{\\text{ani}} = \\frac{2 K_u}{\\mu_0 M_s} \\left(\\frac{1}{\\sqrt{3}}\\right) \\hat{\\mathbf{u}}\n$$\n为了求这个向量的模 $|\\mathbf{h}_{\\text{ani}}|$，我们取标量前因子的绝对值，因为 $\\hat{\\mathbf{u}}$ 是一个单位向量（$|\\hat{\\mathbf{u}}|=1$）：\n$$\n|\\mathbf{h}_{\\text{ani}}| = \\left| \\frac{2 K_u}{\\sqrt{3} \\mu_0 M_s} \\right|\n$$\n常数 $K_u$、$\\mu_0$ 和 $M_s$ 都是正的，所以模是：\n$$\n|\\mathbf{h}_{\\text{ani}}| = \\frac{2 K_u}{\\sqrt{3} \\mu_0 M_s}\n$$\n现在，我们代入给定的数值：\n$K_u = 6.5\\times 10^{5}\\ \\text{J/m}^3$\n$M_s = 1.0\\times 10^{6}\\ \\text{A/m}$\n$\\mu_0 = 4\\pi\\times 10^{-7}\\ \\text{H/m}$\n$$\n|\\mathbf{h}_{\\text{ani}}| = \\frac{2 \\times (6.5 \\times 10^5)}{\\sqrt{3} \\times (4\\pi \\times 10^{-7}) \\times (1.0 \\times 10^6)}\n$$\n$$\n|\\mathbf{h}_{\\text{ani}}| = \\frac{1.3 \\times 10^6}{\\sqrt{3} \\times 4\\pi \\times 10^{-1}} = \\frac{1.3 \\times 10^7}{4\\pi\\sqrt{3}}\\ \\text{A/m}\n$$\n计算数值：\n$$\n|\\mathbf{h}_{\\text{ani}}| \\approx \\frac{1.3 \\times 10^7}{4 \\times 3.14159 \\times 1.73205} \\approx \\frac{1.3 \\times 10^7}{21.7656} \\approx 597271\\ \\text{A/m}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n|\\mathbf{h}_{\\text{ani}}| \\approx 5.973 \\times 10^5\\ \\text{A/m}\n$$", "answer": "$$\\boxed{5.973 \\times 10^5}$$", "id": "3466569"}, {"introduction": "为了在计算机上模拟连续场，我们必须将其表示在离散网格上。这个称为离散化的过程，涉及到对微分算子（如描述交换相互作用的拉普拉斯算子 $\\nabla^2$）的近似。本练习将指导你推导拉普拉斯算子的有限差分近似，并处理不同的边界条件，这是实现任何偏微分方程求解器的核心技能。[@problem_id:3466614]", "problem": "您的任务是推导并实现一个适用于笛卡尔网格上微磁学模拟中交换相互作用的离散拉普拉斯算子。从铁磁体中交换相互作用的基本能量表达式开始，即交换能量密度 $w_{\\mathrm{ex}} = A \\lvert \\nabla \\mathbf{m} \\rvert^{2}$，其中 $A$ 是交换刚度，$\\mathbf{m}(\\mathbf{r})$ 是单位磁化矢量。对有效磁场的交换贡献与磁化分量的拉普拉斯成正比；更准确地说，交换有效场为 $\\mathbf{H}_{\\mathrm{ex}} = \\frac{2A}{\\mu_{0} M_{\\mathrm{s}}} \\Delta \\mathbf{m}$，其中 $\\mu_{0}$ 是真空磁导率，$M_{\\mathrm{s}}$ 是饱和磁化强度。关注二维笛卡尔网格上 $\\mathbf{m}$ 的一个标量分量 $u(x,y)$，并构建近似 $\\Delta u$ 的离散算子。\n\n从拉普拉斯算子的定义 $\\Delta u = \\partial^{2} u / \\partial x^{2} + \\partial^{2} u / \\partial y^{2}$ 开始，为内部节点在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上推导一个二阶精确的离散近似。然后，讨论并推导在以下条件下如何选择边界模板：\n- 狄利克雷（Dirichlet）边界条件：其中 $u$ 在边界上是给定的。\n- 诺伊曼（Neumann）边界条件：其中法向导数 $\\partial u / \\partial n$ 在边界上是给定的；特别地，考虑齐次诺伊曼条件，其中 $\\partial u / \\partial n = 0$。\n\n您的推导必须从第一性原理出发，展示内部模板如何从泰勒展开中产生，以及如何采用适当的单边或鬼点策略来处理狄利克雷与诺伊曼条件下的边界节点。清晰地说明您在内部和边界节点上获得的精度阶数。\n\n完成推导后，实现一个程序，该程序：\n1. 为二维笛卡尔网格上的标量场 $u(x,y)$ 构建具有均匀间距 $\\Delta x$ 和 $\\Delta y$ 的离散拉普拉斯算子。\n2. 支持两种边界条件类型：狄利克雷和诺伊曼（齐次，即法向导数为零）。\n3. 将离散拉普拉斯算子应用于已知的解析测试函数（其连续拉普拉斯 $\\Delta u$ 精确已知），并计算在指定节点集上离散近似与解析值之间的最大绝对误差。\n\n使用以下测试套件。对于每个案例，您必须计算最大绝对误差（一个浮点数）并将其四舍五入到八位小数。如果涉及角度，必须使用弧度。输出中不需要物理单位；所有量纲均为一。\n\n- 测试案例 1 (狄利克雷，内部节点): $L_{x} = 1.0$, $L_{y} = 1.0$, $N_{x} = 51$, $N_{y} = 65$, $\\Delta x = L_{x}/(N_{x}-1)$, $\\Delta y = L_{y}/(N_{y}-1)$。使用 $u(x,y) = \\sin(\\pi x)\\sin(2\\pi y)$，它在边界上满足零狄利克雷值。解析拉普拉斯算子为 $\\Delta u = -\\left(\\pi^{2} + (2\\pi)^{2}\\right) u$。仅计算内部节点（不包括边界节点）上的最大绝对误差。\n\n- 测试案例 2 (诺伊曼，内部节点): $L_{x} = 1.0$, $L_{y} = 1.5$, $N_{x} = 50$, $N_{y} = 64$, $\\Delta x = L_{x}/(N_{x}-1)$, $\\Delta y = L_{y}/(N_{y}-1)$。使用 $u(x,y) = \\cos\\left(\\frac{\\pi x}{L_{x}}\\right)\\cos\\left(\\frac{2\\pi y}{L_{y}}\\right)$，它在 $x=0$、$x=L_{x}$、$y=0$、$y=L_{y}$ 处满足齐次诺伊曼条件。解析拉普拉斯算子为 $\\Delta u = -\\left(\\left(\\frac{\\pi}{L_{x}}\\right)^{2} + \\left(\\frac{2\\pi}{L_{y}}\\right)^{2}\\right) u$。仅计算内部节点上的最大绝对误差。\n\n- 测试案例 3 (狄利克雷，各向异性间距，内部节点): $L_{x} = 2.0$, $L_{y} = 0.5$, $N_{x} = 33$, $N_{y} = 17$, $\\Delta x = L_{x}/(N_{x}-1)$, $\\Delta y = L_{y}/(N_{y}-1)$。使用 $u(x,y) = \\sin\\left(\\frac{2\\pi x}{L_{x}}\\right)\\sin\\left(\\frac{\\pi y}{L_{y}}\\right)$，它在边界上满足零狄利克雷值。解析拉普拉斯算子为 $\\Delta u = -\\left(\\left(\\frac{2\\pi}{L_{x}}\\right)^{2} + \\left(\\frac{\\pi}{L_{y}}\\right)^{2}\\right) u$。仅计算内部节点上的最大绝对误差。\n\n- 测试案例 4 (诺伊曼，仅边界节点): $L_{x} = 1.0$, $L_{y} = 1.0$, $N_{x} = 3$, $N_{y} = 3$, $\\Delta x = L_{x}/(N_{x}-1)$, $\\Delta y = L_{y}/(N_{y}-1)$。使用 $u(x,y) = \\cos\\left(\\frac{\\pi x}{L_{x}}\\right)\\cos\\left(\\frac{\\pi y}{L_{y}}\\right)$，它满足齐次诺伊曼条件。解析拉普拉斯算子为 $\\Delta u = -\\left(\\left(\\frac{\\pi}{L_{x}}\\right)^{2} + \\left(\\frac{\\pi}{L_{y}}\\right)^{2}\\right) u$。仅计算边界节点（不包括内部节点）上的最大绝对误差。\n\n您的程序应生成单行输出，其中包含四个结果，格式为方括号内的逗号分隔列表（例如，“[$r_{1},r_{2},r_{3},r_{4}$]”），其中 $r_{i}$ 是测试案例 $i$ 的浮点误差，四舍五入到八位小数。", "solution": "任务是为二维拉普拉斯算子 $\\Delta u = \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$ 在均匀笛卡尔网格上推导并实现一个离散近似。该算子在包括微磁学在内的许多物理领域都是基础的，它出现在交换有效场 $\\mathbf{H}_{\\mathrm{ex}} \\propto \\Delta \\mathbf{m}$ 的表达式中。我们将推导在狄利克雷和齐次诺伊曼条件下，内部点和边界点的有限差分模板。\n\n设网格由点 $(x_i, y_j)$ 定义，其中 $x_i = i \\Delta x$ (对于 $i \\in \\{0, 1, \\dots, N_x-1\\}$) 和 $y_j = j \\Delta y$ (对于 $j \\in \\{0, 1, \\dots, N_y-1\\}$)。标量场 $u(x,y)$ 在网格点 $(x_i, y_j)$ 的值记为 $u_{i,j}$。\n\n### 内部节点的推导\n\n为了近似二阶偏导数 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 和 $\\frac{\\partial^{2} u}{\\partial y^{2}}$，我们使用点 $(x_i, y_j)$ 附近的泰勒级数展开。对于 $x$ 方向的依赖关系，我们有：\n$$ u(x_i + \\Delta x, y_j) = u_{i+1,j} = u_{i,j} + \\Delta x \\frac{\\partial u}{\\partial x} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} + \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4) $$\n$$ u(x_i - \\Delta x, y_j) = u_{i-1,j} = u_{i,j} - \\Delta x \\frac{\\partial u}{\\partial x} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4) $$\n将这两个方程相加可以消去奇数阶导数项：\n$$ u_{i+1,j} + u_{i-1,j} = 2u_{i,j} + (\\Delta x)^2 \\frac{\\partial^2 u}{\\partial x^2} + \\mathcal{O}((\\Delta x)^4) $$\n对二阶导数进行整理，得到二阶精确的中心差分近似：\n$$ \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{i,j} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^2} + \\mathcal{O}((\\Delta x)^2) $$\n通过对 $y$ 方向执行相同的步骤，我们发现：\n$$ \\frac{\\partial^2 u}{\\partial y^2}\\bigg|_{i,j} = \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^2} + \\mathcal{O}((\\Delta y)^2) $$\n在内部节点 $(i,j)$（其中 $1 \\le i \\le N_x-2$ 和 $1 \\le j \\le N_y-2$）处的离散拉普拉斯 $(\\Delta u)_{i,j}$ 是这两个表达式的和：\n$$ (\\Delta u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta x)^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta y)^2} $$\n这是拉普拉斯算子的标准五点模板。其精度为二阶，截断误差为 $\\mathcal{O}((\\Delta x)^2, (\\Delta y)^2)$。\n\n### 边界条件\n\n内部节点的模板不能直接应用于边界节点，因为它需要域外的点。必须根据指定的边界条件修改模板。\n\n#### 狄利克雷边界条件\n\n在狄利克雷条件下，函数 $u$ 的值在所有边界上都是给定的。例如，$u_{0,j}$、$u_{N_x-1,j}$、$u_{i,0}$ 和 $u_{i,N_y-1}$ 对于所有适用的 $i, j$ 都是已知的。对于邻近边界的内部节点，例如 $(1, j)$，五点模板需要边界节点 $(0,j)$ 的值，该值由边界条件直接给出：\n$$ (\\Delta u)_{1,j} \\approx \\frac{u_{2,j} - 2u_{1,j} + u_{0,j}}{(\\Delta x)^2} + \\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{(\\Delta y)^2} $$\n问题不要求计算狄利克雷边界*上*的拉普拉斯算子，因为测试案例只查询内部节点的误差。在许多应用中，由于边界值是固定的，因此不需要这样的计算。\n\n#### 齐次诺伊曼边界条件\n\n齐次诺伊曼条件指定函数在边界处的法向导数为零，即 $\\frac{\\partial u}{\\partial n} = 0$。对于矩形域，这意味着在垂直边界（$i=0, i=N_x-1$）上 $\\frac{\\partial u}{\\partial x} = 0$，在水平边界（$j=0, j=N_y-1$）上 $\\frac{\\partial u}{\\partial y} = 0$。\n\n为了在边界上保持二阶精度，我们采用“鬼点”法。考虑在 $i=0$ 处的左边界。$\\frac{\\partial^2 u}{\\partial x^2}$ 的中心差分模板需要一个域外的点 $u_{-1,j}$。我们可以通过使用二阶中心差分对一阶导数离散化在 $i=0$ 处的诺伊曼条件来定义这个鬼点的值：\n$$ \\frac{\\partial u}{\\partial x}\\bigg|_{0,j} = \\frac{u_{1,j} - u_{-1,j}}{2\\Delta x} + \\mathcal{O}((\\Delta x)^2) = 0 $$\n由此，我们推断出鬼点的值：$u_{-1,j} = u_{1,j}$。\n将此代入 $i=0$ 处二阶导数的标准模板中：\n$$ \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{0,j} \\approx \\frac{u_{1,j} - 2u_{0,j} + u_{-1,j}}{(\\Delta x)^2} = \\frac{u_{1,j} - 2u_{0,j} + u_{1,j}}{(\\Delta x)^2} = \\frac{2(u_{1,j} - u_{0,j})}{(\\Delta x)^2} $$\n这个在边界上对二阶导数的近似精度仍然是 $\\mathcal{O}((\\Delta x)^2)$，因为对鬼点的近似本身是二阶精确的。\n\n在左边界节点 $(0,j)$ (对于 $1 \\le j \\le N_y-2$) 处的完整离散拉普拉斯算子是：\n$$ (\\Delta u)_{0,j} \\approx \\frac{2(u_{1,j} - u_{0,j})}{(\\Delta x)^2} + \\frac{u_{0,j+1} - 2u_{0,j} + u_{0,j-1}}{(\\Delta y)^2} $$\n通过对称性，可以推导出其他边界的模板：\n- 右边界 ($i=N_x-1$): $(\\Delta u)_{N_x-1,j} \\approx \\frac{2(u_{N_x-2,j} - u_{N_x-1,j})}{(\\Delta x)^2} + \\frac{u_{N_x-1,j+1} - 2u_{N_x-1,j} + u_{N_x-1,j-1}}{(\\Delta y)^2}$\n- 下边界 ($j=0$): $(\\Delta u)_{i,0} \\approx \\frac{u_{i+1,0} - 2u_{i,0} + u_{i-1,0}}{(\\Delta x)^2} + \\frac{2(u_{i,1} - u_{i,0})}{(\\Delta y)^2}$\n- 上边界 ($j=N_y-1$): $(\\Delta u)_{i,N_y-1} \\approx \\frac{u_{i+1,N_y-1} - 2u_{i,N_y-1} + u_{i-1,N_y-1}}{(\\Delta x)^2} + \\frac{2(u_{i,N_y-2} - u_{i,N_y-1})}{(\\Delta y)^2}$\n\n在角点处，两个法向导数都为零。例如，在左下角 $(0,0)$ 处，我们有 $u_{-1,0} = u_{1,0}$ 和 $u_{0,-1} = u_{0,1}$。模板变为：\n$$ (\\Delta u)_{0,0} \\approx \\frac{2(u_{1,0} - u_{0,0})}{(\\Delta x)^2} + \\frac{2(u_{0,1} - u_{0,0})}{(\\Delta y)^2} $$\n其他三个角点也有类似的表达式。使用鬼点确保了离散拉普拉斯近似在整个域（包括边界和角点）上都是二阶精确的。\n\n至此，所需离散算子对内部和边界节点的推导完成。实现将遵循这些推导出的公式。", "answer": "[0.00399120,0.00282928,0.01258682,0.00000000]", "id": "3466614"}, {"introduction": "正确的空间离散化只是成功的一半；我们还需要一种稳定的方法来随时间演化系统。显式时间步进格式（如前向欧拉法）虽然简单，但对时间步长 $\\Delta t$ 有稳定性限制。本练习探讨了系统的物理属性和网格分辨率如何共同产生“刚性”（stiffness），从而决定了模拟的最大稳定时间步长。[@problem_id:3466579]", "problem": "考虑一个通过微磁学模拟的三维各向同性铁磁体，该模拟在空间步长为 $a$ 的均匀立方网格上进行，并采用周期性边界条件，使用二阶中心差分对拉普拉斯算子进行离散化。磁化方向场为归一化磁化强度 $\\mathbf{m}(\\mathbf{r}, t)$，满足 $|\\mathbf{m}| = 1$。材料参数包括交换刚度 $A$、饱和磁化强度 $M_s$、Landau-Lifshitz-Gilbert (LLG) 阻尼系数 $\\alpha$ 以及绝对旋磁比 $|\\gamma|$。忽略静磁和各向异性贡献，因此有效场的唯一贡献来自交换场。动力学遵循 Gilbert 形式的 Landau-Lifshitz-Gilbert (LLG) 方程，\n$$\n\\frac{\\partial \\mathbf{m}}{\\partial t} \\;=\\; -\\gamma \\mu_0 \\,\\mathbf{m} \\times \\mathbf{H}_{\\mathrm{eff}} \\;+\\; \\alpha \\,\\mathbf{m} \\times \\frac{\\partial \\mathbf{m}}{\\partial t},\n$$\n其中 $\\mu_0$ 是真空磁导率，有效场的交换贡献为\n$$\n\\mathbf{H}_{\\mathrm{ex}} \\;=\\; \\frac{2A}{\\mu_0 M_s} \\,\\nabla^2 \\mathbf{m}.\n$$\n假设存在一个空间均匀的平衡态 $\\mathbf{m}_0 = \\hat{\\mathbf{z}}$，并围绕此状态对动力学进行线性化。考虑对线性化系统应用显式前向欧拉法进行时间积分。使用网格和边界条件所支持的离散最高波数交换模式，确定保证前向欧拉法线性稳定性的最大稳定时间步长 $\\Delta t_{\\max}$。将最终答案表示为由 $A$、$M_s$、$\\alpha$、$|\\gamma|$ 和 $a$ 构成的单个闭式解析表达式。时间步长以秒为单位表示。无需进行舍入。", "solution": "用户希望找到线性化 Landau-Lifshitz-Gilbert (LLG) 方程的前向欧拉积分的最大稳定时间步长。\n\n### 步骤 1：提取给定条件\n-   **系统**：三维各向同性铁磁体，位于均匀立方网格上。\n-   **网格间距**：$a$。\n-   **边界条件**：周期性。\n-   **离散化**：拉普拉斯算子 $\\nabla^2$ 的二阶中心差分。\n-   **状态变量**：归一化磁化强度 $\\mathbf{m}(\\mathbf{r}, t)$，满足 $|\\mathbf{m}| = 1$。\n-   **材料参数**：交换刚度 $A$、饱和磁化强度 $M_s$、LLG 阻尼系数 $\\alpha$、绝对旋磁比 $|\\gamma|$。\n-   **能量贡献**：仅交换能；静磁和各向异性能被忽略。\n-   **LLG 方程 (Gilbert 形式)**：$\\frac{\\partial \\mathbf{m}}{\\partial t} = -\\gamma \\mu_0 \\,\\mathbf{m} \\times \\mathbf{H}_{\\mathrm{eff}} + \\alpha \\,\\mathbf{m} \\times \\frac{\\partial \\mathbf{m}}{\\partial t}$。问题中使用了 $\\gamma$，但指定使用绝对值 $|\\gamma|$，我们将在整个推导中使用后者。\n-   **有效场**：$\\mathbf{H}_{\\mathrm{eff}} = \\mathbf{H}_{\\mathrm{ex}} = \\frac{2A}{\\mu_0 M_s} \\,\\nabla^2 \\mathbf{m}$。\n-   **平衡态**：$\\mathbf{m}_0 = \\hat{\\mathbf{z}}$。\n-   **任务**：围绕 $\\mathbf{m}_0$ 对动力学进行线性化。\n-   **时间积分**：对线性化系统使用显式前向欧拉法。\n-   **模式**：离散最高波数交换模式。\n-   **目标**：确定最大稳定时间步长 $\\Delta t_{\\max}$，用 $A$、$M_s$、$\\alpha$、$|\\gamma|$ 和 $a$ 表示。\n\n### 步骤 2：使用提取的给定条件进行验证\n-   **科学依据**：该问题是计算材料科学中的一个标准练习，特别是在微磁学领域。LLG 方程、交换场的表达式以及数值方案的稳定性分析都是基础性的，并且表述正确。\n-   **适定性**：问题定义清晰。它指定了物理系统、控制方程、数值方法以及要分析的特定模式。这种结构使得可以推导出一个唯一且有意义的解。\n-   **客观性**：问题以精确、技术性的语言陈述，没有任何主观性。\n-   **完整性和一致性**：提供了所有必要的物理量和方程。没有矛盾之处。使用 $\\gamma$ 然后指定 $|\\gamma|$ 是一种常见的做法，以确保旋磁比为正，这不构成矛盾。\n\n### 步骤 3：结论和行动\n问题是有效的。将提供完整的解答。\n\n### 解答推导\n求解过程包括：线性化 LLG 方程，应用离散傅里叶分析来处理网格，识别最不稳定的模式，然后推导前向欧拉时间步进格式的稳定性条件。\n\n首先，我们通过求解 $\\frac{\\partial \\mathbf{m}}{\\partial t}$，将 Gilbert 形式的 LLG 方程重写为显式的 Landau-Lifshitz 形式。\n$$\n\\frac{\\partial \\mathbf{m}}{\\partial t} = -\\frac{|\\gamma| \\mu_0}{1+\\alpha^2} \\left[ \\mathbf{m} \\times \\mathbf{H}_{\\mathrm{eff}} + \\alpha \\, \\mathbf{m} \\times (\\mathbf{m} \\times \\mathbf{H}_{\\mathrm{eff}}) \\right]\n$$\n接下来，我们围绕均匀平衡态 $\\mathbf{m}_0 = \\hat{\\mathbf{z}}$ 对该方程进行线性化。令 $\\mathbf{m} = \\mathbf{m}_0 + \\delta\\mathbf{m}$。约束条件 $|\\mathbf{m}|=1$ 意味着在一阶近似下，扰动 $\\delta\\mathbf{m}$ 垂直于 $\\mathbf{m}_0$。我们将此横向扰动表示为 $\\mathbf{m}_{\\perp} = (m_x, m_y, 0)$。\n有效场为 $\\mathbf{H}_{\\mathrm{eff}} = \\frac{2A}{\\mu_0 M_s} \\nabla^2 \\mathbf{m}$。对其进行线性化得到：\n$$\n\\mathbf{H}_{\\mathrm{eff}} \\approx \\frac{2A}{\\mu_0 M_s} \\nabla^2 (\\mathbf{m}_0 + \\mathbf{m}_{\\perp}) = \\frac{2A}{\\mu_0 M_s} \\nabla^2 \\mathbf{m}_{\\perp}\n$$\n因为 $\\nabla^2 \\mathbf{m}_0 = 0$。令 $C_{ex} = \\frac{2A}{\\mu_0 M_s}$。则 $\\mathbf{H}_{\\mathrm{eff}} = C_{ex} \\nabla^2 \\mathbf{m}_{\\perp}$。\n\n我们将此代入线性化的 LLG 方程。只保留关于 $\\mathbf{m}_{\\perp}$ 的线性项：\n$$\n\\frac{\\partial \\mathbf{m}_{\\perp}}{\\partial t} = -\\frac{|\\gamma| \\mu_0}{1+\\alpha^2} \\left[ \\hat{\\mathbf{z}} \\times (C_{ex} \\nabla^2 \\mathbf{m}_{\\perp}) + \\alpha \\, \\hat{\\mathbf{z}} \\times (\\hat{\\mathbf{z}} \\times (C_{ex} \\nabla^2 \\mathbf{m}_{\\perp})) \\right]\n$$\n使用矢量恒等式 $\\mathbf{a} \\times (\\mathbf{a} \\times \\mathbf{b}) = \\mathbf{a}(\\mathbf{a} \\cdot \\mathbf{b}) - \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{a})$，并注意到 $\\hat{\\mathbf{z}} \\cdot (\\nabla^2 \\mathbf{m}_{\\perp}) = 0$ 和 $|\\hat{\\mathbf{z}}|=1$，第二项简化为 $-\\nabla^2 \\mathbf{m}_{\\perp}$。\n$$\n\\frac{\\partial \\mathbf{m}_{\\perp}}{\\partial t} = -\\frac{|\\gamma| \\mu_0 C_{ex}}{1+\\alpha^2} \\left[ \\hat{\\mathbf{z}} \\times \\nabla^2 \\mathbf{m}_{\\perp} - \\alpha \\nabla^2 \\mathbf{m}_{\\perp} \\right]\n$$\n让我们为横向分量向量 $\\mathbf{m}_{\\perp} = (m_x, m_y)^T$ 将其写成矩阵形式。\n算子 $\\hat{\\mathbf{z}} \\times$ 的作用相当于矩阵 $\\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。所以，$\\hat{\\mathbf{z}} \\times \\nabla^2 \\mathbf{m}_{\\perp}$ 对应于 $\\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\nabla^2 m_x \\\\ \\nabla^2 m_y \\end{pmatrix} = \\begin{pmatrix} -\\nabla^2 m_y \\\\ \\nabla^2 m_x \\end{pmatrix}$。\n方程变为：\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} m_x \\\\ m_y \\end{pmatrix} = -\\frac{|\\gamma| \\mu_0 C_{ex}}{1+\\alpha^2} \\left[ \\begin{pmatrix} -\\nabla^2 m_y \\\\ \\nabla^2 m_x \\end{pmatrix} - \\alpha \\begin{pmatrix} \\nabla^2 m_x \\\\ \\nabla^2 m_y \\end{pmatrix} \\right] = \\frac{|\\gamma| \\mu_0 C_{ex}}{1+\\alpha^2} \\nabla^2 \\begin{pmatrix} \\alpha  1 \\\\ -1  \\alpha \\end{pmatrix} \\begin{pmatrix} m_x \\\\ m_y \\end{pmatrix}\n$$\n系统在离散网格上进行模拟。我们在离散傅里叶空间中分析其行为。考虑一个波矢为 $\\mathbf{k}$ 的空间模式（自旋波）。在间距为 $a$ 的三维立方网格上，使用二阶中心差分格式的离散拉普拉斯算子作用于模式 $e^{i\\mathbf{k}\\cdot\\mathbf{r}}$ 时，相当于乘以一个特征值 $\\Lambda(\\mathbf{k})$：\n$$\n\\Lambda(\\mathbf{k}) = \\frac{2}{a^2} \\left[ \\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a) - 3 \\right]\n$$\n数值格式的稳定性受系统演化最快的模式限制。这对应于空间算子具有最大绝对值的特征值。对于拉普拉斯算子，这是最负的特征值 $\\Lambda_{\\max}$。这种情况发生在网格所能支持的最高波数（奈奎斯特频率）时，即 $k_x = k_y = k_z = \\pi/a$。\n$$\n\\Lambda_{\\max} = \\frac{2}{a^2} \\left[ \\cos(\\pi) + \\cos(\\pi) + \\cos(\\pi) - 3 \\right] = \\frac{2}{a^2}(-1 - 1 - 1 - 3) = -\\frac{12}{a^2}\n$$\n对于此模式，偏微分方程组（PDEs）变为关于傅里叶振幅 $\\mathbf{m}_{\\perp, \\mathbf{k}}$ 的常微分方程组（ODEs）：\n$$\n\\frac{d}{dt} \\mathbf{m}_{\\perp, \\mathbf{k}} = \\mathbf{J} \\mathbf{m}_{\\perp, \\mathbf{k}}, \\quad \\text{其中} \\quad \\mathbf{J} = \\frac{|\\gamma| \\mu_0 C_{ex} \\Lambda_{\\max}}{1+\\alpha^2} \\begin{pmatrix} \\alpha  1 \\\\ -1  \\alpha \\end{pmatrix}\n$$\n此常微分方程的前向欧拉积分格式为 $\\mathbf{m}_{\\perp, \\mathbf{k}}^{n+1} = \\mathbf{m}_{\\perp, \\mathbf{k}}^n + \\Delta t \\, \\mathbf{J} \\mathbf{m}_{\\perp, \\mathbf{k}}^n = (\\mathbf{I} + \\Delta t \\, \\mathbf{J}) \\mathbf{m}_{\\perp, \\mathbf{k}}^n$。\n为了保证线性稳定性，放大矩阵 $\\mathbf{G} = \\mathbf{I} + \\Delta t \\, \\mathbf{J}$ 的特征值的模必须不大于 1。$\\mathbf{G}$ 的特征值为 $g = 1 + \\Delta t \\lambda_J$，其中 $\\lambda_J$ 是 $\\mathbf{J}$ 的特征值。\n矩阵 $\\begin{pmatrix} \\alpha  1 \\\\ -1  \\alpha \\end{pmatrix}$ 的特征值为 $\\alpha \\pm i$。\n因此，$\\mathbf{J}$ 的特征值为：\n$$\n\\lambda_J = \\frac{|\\gamma| \\mu_0 C_{ex} \\Lambda_{\\max}}{1+\\alpha^2} (\\alpha \\pm i)\n$$\n稳定性条件是 $|1 + \\Delta t \\lambda_J| \\le 1$。我们定义一个正常数 $\\beta$：\n$$\n\\beta = -\\frac{|\\gamma| \\mu_0 C_{ex} \\Lambda_{\\max}}{1+\\alpha^2} = -\\frac{|\\gamma| \\mu_0 \\left(\\frac{2A}{\\mu_0 M_s}\\right) \\left(-\\frac{12}{a^2}\\right)}{1+\\alpha^2} = \\frac{24 A |\\gamma|}{(1+\\alpha^2) M_s a^2}\n$$\n由此，$\\mathbf{J}$ 的特征值为 $\\lambda_J = -\\beta (\\alpha \\pm i)$。\n稳定性条件变为 $|1 - \\Delta t \\beta (\\alpha \\pm i)| \\le 1$。\n$$\n| (1 - \\Delta t \\beta \\alpha) \\mp i(\\Delta t \\beta) |^2 \\le 1^2\n$$\n$$\n(1 - \\Delta t \\beta \\alpha)^2 + (\\Delta t \\beta)^2 \\le 1\n$$\n$$\n1 - 2\\Delta t \\beta \\alpha + (\\Delta t \\beta \\alpha)^2 + (\\Delta t \\beta)^2 \\le 1\n$$\n$$\n-2\\Delta t \\beta \\alpha + (\\Delta t)^2 \\beta^2 (\\alpha^2 + 1) \\le 0\n$$\n由于 $\\Delta t > 0$ 且 $\\beta > 0$，我们可以除以 $\\Delta t \\beta$：\n$$\n-2\\alpha + \\Delta t \\beta (1+\\alpha^2) \\le 0\n$$\n$$\n\\Delta t \\beta (1+\\alpha^2) \\le 2\\alpha\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = \\frac{2\\alpha}{\\beta (1+\\alpha^2)}\n$$\n现在，代入 $\\beta$ 的表达式：\n$$\n\\Delta t_{\\max} = \\frac{2\\alpha}{\\left( \\frac{24 A |\\gamma|}{(1+\\alpha^2) M_s a^2} \\right) (1+\\alpha^2)} = \\frac{2\\alpha (1+\\alpha^2) M_s a^2}{24 A |\\gamma| (1+\\alpha^2)}\n$$\n简化此表达式得到最终结果：\n$$\n\\Delta t_{\\max} = \\frac{2\\alpha M_s a^2}{24 A |\\gamma|} = \\frac{\\alpha M_s a^2}{12 A |\\gamma|}\n$$\n该表达式的单位是秒，符合要求。例如，$[M_s a^2]$ 的量纲为 $(A/m) \\cdot m^2 = A \\cdot m$，$[A |\\gamma|]$ 的量纲为 $(J/m) \\cdot (1/(s \\cdot T))$。考虑到 $J=N \\cdot m$ 且 $T=N/(A \\cdot m)$，最终单位简化为秒。", "answer": "$$\n\\boxed{\\frac{\\alpha M_s a^2}{12 A |\\gamma|}}\n$$", "id": "3466579"}]}