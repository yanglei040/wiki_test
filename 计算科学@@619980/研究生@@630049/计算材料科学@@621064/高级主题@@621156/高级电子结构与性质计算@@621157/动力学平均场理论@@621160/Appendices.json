{"hands_on_practices": [{"introduction": "在动力学平均场理论（DMFT）中，戴森方程是安德森杂质模型映射的基石。这个练习旨在通过具体的代数操作，加深你对局域格林函数 $G_{\\text{loc}}$、自能 $\\Sigma$ 和杂化函数 $\\Delta$ 之间关系的理解。通过这个练习 [@problem_id:3446486]，你将亲手验证这些核心物理量所必须满足的基本性质，例如杂化函数虚部的符号以及其高频行为，这是确保计算结果物理真实性的关键一步。", "problem": "您正在研究动力学平均场理论（DMFT）中的一个单轨道关联格点模型，该模型被映射到一个逆温度为 $\\beta$ 的 Anderson 杂质问题，其中费米子松原频率为 $i\\omega_n$，$\\omega_n=(2n+1)\\pi/\\beta$（$n$ 为整数）。杂质 Dyson 方程通过量子多体理论的基本恒等式（Dyson 方程和 Weiss 场定义），将局域格林函数 $G_{\\text{loc}}(i\\omega_n)$、自能 $\\Sigma(i\\omega_n)$、化学势 $\\mu$ 和杂化函数 $\\Delta(i\\omega_n)$ 关联起来：相互作用的杂质格林函数满足 $G_{\\text{loc}}^{-1}(i\\omega_n)=\\mathcal{G}_0^{-1}(i\\omega_n)-\\Sigma(i\\omega_n)$，其中 $\\mathcal{G}_0^{-1}(i\\omega_n)=i\\omega_n+\\mu-\\Delta(i\\omega_n)$。\n\n请仅从这些定义出发，首先推导一个用 $i\\omega_n$、$\\mu$、$\\Sigma(i\\omega_n)$ 和 $G_{\\text{loc}}(i\\omega_n)$ 表示的 $\\Delta(i\\omega_n)$ 的显式表达式。然后，对于 $\\mu=0$ 的特定情况，其中\n$$\n\\Sigma(i\\omega_n)=\\frac{U^2}{4\\,i\\omega_n},\\qquad\nG_{\\text{loc}}(i\\omega_n)=\\frac{1}{\\,i\\omega_n-\\Sigma(i\\omega_n)-\\dfrac{V^2}{i\\omega_n-\\epsilon_b}\\,},\n$$\n$U>0$，$V>0$ 和 $\\epsilon_b\\in\\mathbb{R}$ 均为参数，计算所得 $\\Delta(i\\omega_n)$ 的闭合形式。利用您的结果，从第一性原理出发验证对于所有 $n\\ge 0$，都有 $\\operatorname{Im}\\Delta(i\\omega_n)\\le 0$，并且其高频展开满足\n$$\n\\Delta(i\\omega_n)\\sim \\frac{C}{i\\omega_n}+\\mathcal{O}\\!\\left(\\frac{1}{\\omega_n^2}\\right)\n\\quad\\text{其中}\\quad C=\\sum_{\\ell}V_{\\ell}^2,\n$$\n并根据给定参数确定 $C$。请将杂化函数 $\\Delta(i\\omega_n)$ 的最终答案表示为一个单一的闭合形式解析表达式。无需四舍五入。", "solution": "该问题陈述已被验证且被认为是有效的。它在科学上基于量子多体物理学的原理，特别是动力学平均场理论（DMFT），问题良定、客观，并包含获得唯一解所需的所有必要信息。\n\n该问题要求基于 Anderson 杂质问题在 DMFT 中的基本方程进行若干推导和验证。我们将分步进行。\n\n**第一部分：杂化函数 $\\Delta(i\\omega_n)$ 的一般表达式**\n\n我们被给予了关于杂质问题的两个基本关系式：\n1.  Dyson 方程，它关联了局域相互作用格林函数 $G_{\\text{loc}}(i\\omega_n)$、Weiss 场（无相互作用格林函数）$\\mathcal{G}_0(i\\omega_n)$ 和自能 $\\Sigma(i\\omega_n)$：\n    $$G_{\\text{loc}}^{-1}(i\\omega_n) = \\mathcal{G}_0^{-1}(i\\omega_n) - \\Sigma(i\\omega_n)$$\n2.  Weiss 场的定义，用杂化函数 $\\Delta(i\\omega_n)$、化学势 $\\mu$ 和费米子松原频率 $i\\omega_n$ 表示：\n    $$\\mathcal{G}_0^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n)$$\n\n为了找到 $\\Delta(i\\omega_n)$ 的表达式，我们将第二个方程代入第一个方程：\n$$G_{\\text{loc}}^{-1}(i\\omega_n) = (i\\omega_n + \\mu - \\Delta(i\\omega_n)) - \\Sigma(i\\omega_n)$$\n现在，我们可以通过代数变换这个方程来求解 $\\Delta(i\\omega_n)$：\n$$\\Delta(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}^{-1}(i\\omega_n)$$\n这就是所要求的杂化函数的一般表达式。\n\n**第二部分：特定情况下 $\\Delta(i\\omega_n)$ 的计算**\n\n我们被给予一个具有以下条件的特定情况：\n-   化学势：$\\mu=0$。\n-   自能：$\\Sigma(i\\omega_n) = \\frac{U^2}{4\\,i\\omega_n}$。\n-   局域格林函数：$G_{\\text{loc}}(i\\omega_n) = \\frac{1}{\\,i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b}\\,}$。\n\n首先，我们求出给定的局域格林函数的逆：\n$$G_{\\text{loc}}^{-1}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n现在，我们将这个表达式以及 $\\mu=0$ 代入我们关于 $\\Delta(i\\omega_n)$ 的一般公式中：\n$$\\Delta(i\\omega_n) = i\\omega_n + 0 - \\Sigma(i\\omega_n) - \\left( i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b} \\right)$$\n$i\\omega_n$ 和 $\\Sigma(i\\omega_n)$ 项相互抵消：\n$$\\Delta(i\\omega_n) = (i\\omega_n - \\Sigma(i\\omega_n)) - (i\\omega_n - \\Sigma(i\\omega_n)) + \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n这简化为杂化函数的闭合形式表达式：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n请注意，问题中提供的 $\\Sigma(i\\omega_n)$ 的具体形式 $\\Sigma(i\\omega_n) = \\frac{U^2}{4i\\omega_n}$ 在此计算中并非必需，因为它被抵消了。题目的结构是为了找到与给定形式的局域格林函数相对应的杂化函数。\n\n**第三部分：虚部的验证**\n\n一个物理的杂化函数必须满足其相应谱密度为非负的条件。在虚频轴上，对于正的松原频率 $\\omega_n > 0$，这转化为条件 $\\operatorname{Im}\\Delta(i\\omega_n) \\le 0$。问题定义了 $\\omega_n = (2n+1)\\pi/\\beta$，其中 $n$ 为整数。对于 $n \\ge 0$，我们有 $2n+1 \\ge 1$，并且由于 $\\beta > 0$，可得 $\\omega_n > 0$。\n\n让我们计算我们得到的 $\\Delta(i\\omega_n)$ 结果的虚部：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n我们通过将分子和分母同乘以分母的复共轭 $-i\\omega_n - \\epsilon_b$ 来使分母有理化：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{(i\\omega_n - \\epsilon_b)} \\frac{(-i\\omega_n - \\epsilon_b)}{(-i\\omega_n - \\epsilon_b)} = \\frac{V^2(-i\\omega_n - \\epsilon_b)}{-(i\\omega_n)^2 + \\epsilon_b^2} = \\frac{-V^2\\epsilon_b - iV^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}$$\n将其分为实部和虚部：\n$$\\Delta(i\\omega_n) = \\left(-\\frac{V^2\\epsilon_b}{\\omega_n^2 + \\epsilon_b^2}\\right) + i \\left(-\\frac{V^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}\\right)$$\n因此，虚部为：\n$$\\operatorname{Im}\\Delta(i\\omega_n) = -\\frac{V^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}$$\n鉴于 $V>0$，我们有 $V^2>0$。如前所述，对于 $n \\ge 0$，$\\omega_n > 0$。分母 $\\omega_n^2 + \\epsilon_b^2$ 总是正的（因为 $\\omega_n \\neq 0$ 且 $\\epsilon_b$ 是实数）。因此，$\\operatorname{Im}\\Delta(i\\omega_n)$ 的整个表达式是一个正数的负值，意味着它是严格为负的。\n$$\\operatorname{Im}\\Delta(i\\omega_n)  0 \\quad \\text{对于 } n \\ge 0$$\n这满足了所要求的条件 $\\operatorname{Im}\\Delta(i\\omega_n) \\le 0$。\n\n**第四部分：高频展开**\n\n我们被要求验证高频行为 $\\Delta(i\\omega_n) \\sim \\frac{C}{i\\omega_n} + \\mathcal{O}(\\frac{1}{\\omega_n^2})$ 并确定常数 $C$。我们从 $\\Delta(i\\omega_n)$ 的表达式开始，并对大的 $\\omega_n$ 进行展开。\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n从分母中提出因子 $i\\omega_n$：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n\\left(1 - \\frac{\\epsilon_b}{i\\omega_n}\\right)} = \\frac{V^2}{i\\omega_n} \\left(1 - \\frac{\\epsilon_b}{i\\omega_n}\\right)^{-1}$$\n对于大的 $\\omega_n$，项 $|\\frac{\\epsilon_b}{i\\omega_n}|$ 远小于 $1$，所以我们可以使用几何级数展开 $(1-x)^{-1} = 1 + x + x^2 + \\dots$：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n} \\left(1 + \\frac{\\epsilon_b}{i\\omega_n} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^2}\\right)\\right)$$\n分配首项，我们得到展开式：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n} + \\frac{V^2\\epsilon_b}{(i\\omega_n)^2} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^3}\\right) = \\frac{V^2}{i\\omega_n} - \\frac{V^2\\epsilon_b}{\\omega_n^2} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^3}\\right)$$\n将此结果与指定的渐近形式 $\\Delta(i\\omega_n) \\sim \\frac{C}{i\\omega_n} + \\mathcal{O}(\\frac{1}{\\omega_n^2})$ 进行比较，我们可以清楚地看到展开式是匹配的。首项是 $\\frac{V^2}{i\\omega_n}$，次项的阶数为 $\\frac{1}{\\omega_n^2}$。\n通过直接比较，我们确定系数 $C$ 为：\n$$C = V^2$$\n这与由一组离散的浴格点产生的杂化函数的一般形式 $C = \\sum_{\\ell} V_{\\ell}^2$ 一致，在本例中，只有一个浴格点，其耦合强度为 $V$。\n\n要求的最终答案是 $\\Delta(i\\omega_n)$ 的闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{V^2}{i\\omega_n - \\epsilon_b}}\n$$", "id": "3446486"}, {"introduction": "DMFT 自洽循环中的一个核心步骤是通过希尔伯特变换，从晶格的态密度（DOS）计算出局域格林函数。这个编程练习 [@problem_id:3446460] 让你能够亲手实现这一关键计算，并直观地展示一个著名的等价关系：贝特晶格的自洽条件在无穷配位数极限下，等价于对一个半圆形态密度进行希尔伯特变换。这不仅是一个重要的计算实践，更让你深刻体会 DMFT 理论的基石——无穷维极限近似。", "problem": "考虑半满情况下贝特晶格的动力学平均场理论 (DMFT) 自洽性，其中杂化函数 $\\Delta(i\\omega_n)$ 和局域格林函数 $G_{\\text{loc}}(i\\omega_n)$ 出现在杂质戴森方程中。杂质戴森方程为\n$$\nG_{\\text{loc}}(i\\omega_n)^{-1} = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - \\Delta(i\\omega_n),\n$$\n其中 $i\\omega_n$ 是虚松原频率，$\\mu$ 是化学势，$\\Sigma(i\\omega_n)$ 是局域自能。对于半满情况，设 $\\mu = 0$。\n\n对于贝特晶格，在无限连通性（配位数）$z \\to \\infty$ 的极限下，并采用跃迁振幅的标准标度变换 $t \\mapsto t/\\sqrt{z}$，无相互作用的态密度 (DOS) 变为半带宽为 $2t$ 的半圆形，DMFT 自洽性简化为\n$$\n\\Delta(i\\omega_n) = t^2 \\, G_{\\text{loc}}(i\\omega_n).\n$$\n另外，局域格林函数也可以通过对晶格态密度 $D(\\epsilon)$ 进行希尔伯特变换来计算\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int_{-\\infty}^{+\\infty} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}.\n$$\n在无限连通性极限下，半圆形DOS为\n$$\nD_{\\text{semi}}(\\epsilon) = \\frac{1}{2\\pi t^2}\\sqrt{4t^2 - \\epsilon^2}, \\quad |\\epsilon| \\le 2t, \\quad \\text{且} \\quad D_{\\text{semi}}(\\epsilon)=0 \\text{ 在其他情况下}.\n$$\n对于有限连通性 $z \\ge 3$，一个符合实际的贝特晶格DOS模型由适用于$z$-正则随机图的Kesten–McKay分布给出，经过标度变换以保持半带宽等于$2t$：\n$$\nD_z(\\epsilon) = \\frac{z(z-1)}{2\\pi t} \\, \\frac{\\sqrt{4 - \\epsilon^2/t^2}}{z^2 - \\frac{(z-1)\\epsilon^2}{t^2}}, \\quad |\\epsilon| \\le 2t, \\quad \\text{且} \\quad D_z(\\epsilon)=0 \\text{ 在其他情况下}.\n$$\n在所有情况下，通过戴森方程获得的杂化函数为\n$$\n\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - \\left[G_{\\text{loc}}(i\\omega_n)\\right]^{-1}.\n$$\n\n您的任务是编写一个完整的程序，该程序：\n- 通过对态密度 $D(\\epsilon)$ 在 $\\epsilon \\in [-2t,2t]$ 上进行数值积分，实现 $G_{\\text{loc}}(i\\omega_n)$ 的计算，使用上述半圆形DOS $D_{\\text{semi}}(\\epsilon)$ 或有限连通性Kesten–McKay DOS $D_z(\\epsilon)$ 的表达式。\n- 在虚轴上使用一个物理上合理的实值局域自能，其定义为\n$$\n\\Sigma(i\\omega_n) = \\frac{U^2}{\\omega_n^2 + \\omega_0^2},\n$$\n其中 $U$ 和 $\\omega_0$ 是正常数。\n- 对于给定的松原指数集 $\\{n_j\\}$ 和逆温 $\\beta$，使用费米子松原频率\n$$\n\\omega_{n_j} = \\frac{\\pi}{\\beta} \\left(2n_j + 1\\right).\n$$\n- 对每个测试案例，计算在指定的松原频率上，DMFT贝特晶格自洽条件 $\\Delta(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$ 与通过DOS积分和戴森方程构建的杂化函数 $\\Delta_{\\text{Dyson}}(i\\omega_n)$ 之间的最大绝对偏差。具体来说，计算\n$$\n\\delta_{\\max} = \\max_{n_j} \\left| \\Delta_{\\text{Dyson}}(i\\omega_{n_j}) - t^2 \\, G_{\\text{loc}}(i\\omega_{n_j}) \\right|.\n$$\n此问题中的所有量都是无量纲的，因此不需要物理单位。\n\n测试套件：\n- 案例1（通过$D_{\\text{semi}}$的无限连通性基准测试）：使用半圆形DOS；参数 $t = 1.0$, $\\beta = 50.0$, $U = 2.0$, $\\omega_0 = 1.5$，松原指数 $\\{0,1,2,10,50,200\\}$。\n- 案例2（中等大小的有限$z$）：使用$z=6$的Kesten–McKay DOS；参数 $t = 1.0$, $\\beta = 50.0$, $U = 2.0$, $\\omega_0 = 1.5$，松原指数 $\\{0,1,2,10,50,200\\}$。\n- 案例3（较大的有限$z$）：使用$z=20$的Kesten–McKay DOS；参数 $t = 1.0$, $\\beta = 50.0$, $U = 2.0$, $\\omega_0 = 1.5$，松原指数 $\\{0,1,2,10,50,200\\}$。\n- 案例4（非常大的有限$z$）：使用$z=1000$的Kesten–McKay DOS；参数 $t = 1.0$, $\\beta = 50.0$, $U = 2.0$, $\\omega_0 = 1.5$，松原指数 $\\{0,1,2,10,50,200\\}$。\n\n您的程序应生成单行输出，其中包含四个案例的结果，格式为方括号括起来的逗号分隔列表，例如 $[\\delta_1,\\delta_2,\\delta_3,\\delta_4]$，其中每个 $\\delta_k$ 是对应案例计算出的 $\\delta_{\\max}$，表示为浮点数。", "solution": "该问题陈述是凝聚态物理领域，特别是动力学平均场理论 (DMFT) 框架内的一个有效的计算练习。所有给出的方程、参数和定义在科学上都是合理、一致且明确的。任务是计算一个特定的、可验证的数值，用以说明DMFT中的一个关键概念：贝特晶格的电子性质向其无限配位数极限的收敛。我们将着手提供一个完整的解决方案。\n\n问题的核心是，对于给定的局域自能 $\\Sigma(i\\omega_n)$，比较杂化函数 $\\Delta(i\\omega_n)$ 的两种不同表达式。第一个表达式 $\\Delta_{\\text{Bethe}}(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$，是贝特晶格在无限配位数 ($z \\to \\infty$) 极限下的精确DMFT自洽条件，此时无相互作用的态密度 (DOS) 是半圆形的。第二个表达式 $\\Delta_{\\text{Dyson}}(i\\omega_n)$，源于对任何系统都成立的通用杂质戴森方程：\n$$\n\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}(i\\omega_n)^{-1}\n$$\n对于这个问题，我们处于半满状态，所以化学势 $\\mu=0$。局域格林函数 $G_{\\text{loc}}(i\\omega_n)$ 是通过对给定的无相互作用DOS $D(\\epsilon)$ 进行希尔伯特变换来计算的：\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int_{-\\infty}^{+\\infty} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}\n$$\n问题要求计算几种情况下最大绝对偏差 $\\delta_{\\max} = \\max_{n_j} |\\Delta_{\\text{Dyson}}(i\\omega_{n_j}) - \\Delta_{\\text{Bethe}}(i\\omega_{n_j})|$。这个偏差量化了在使用对应于有限配位晶格的DOS时，近似的无限配位数自洽条件的成立程度。\n\n程序步骤如下：\n\n1.  **定义输入量**：对于每个测试案例，都给定了跃迁 ($t$)、逆温 ($\\beta$)、自能 ($U, \\omega_0$) 的参数以及DOS的形式。我们首先为一组松原指数 $\\{n_j\\}$ 计算必要的物理量。\n    -   费米子松原频率由 $\\omega_n = \\frac{\\pi}{\\beta}(2n+1)$ 给出。\n    -   虚轴上的局域自能由实值函数 $\\Sigma(i\\omega_n) = \\frac{U^2}{\\omega_n^2 + \\omega_0^2}$ 给出。\n\n2.  **选择态密度 (DOS)**：使用两种形式的DOS，两者都定义在区间 $\\epsilon \\in [-2t, 2t]$ 上。\n    -   对于无限配位数极限 ($z \\to \\infty$)，半圆形DOS为：\n        $$\n        D_{\\text{semi}}(\\epsilon) = \\frac{1}{2\\pi t^2}\\sqrt{4t^2 - \\epsilon^2}\n        $$\n    -   对于有限配位数 $z$，Kesten–McKay DOS为：\n        $$\n        D_z(\\epsilon) = \\frac{z(z-1)}{2\\pi t} \\, \\frac{\\sqrt{4 - \\epsilon^2/t^2}}{z^2 - \\frac{(z-1)\\epsilon^2}{t^2}}\n        $$\n\n3.  **计算局域格林函数**：对于每个松原频率 $\\omega_n$，我们通过在能量支撑域 $\\epsilon \\in [-2t, 2t]$ 上对复值被积函数进行数值积分来计算 $G_{\\text{loc}}(i\\omega_n)$。被积函数的分母是 $Z_n - \\epsilon$，其中 $Z_n = i\\omega_n - \\Sigma(i\\omega_n)$ 对于每个固定的 $n$ 是一个复常数。\n    $$\n    G_{\\text{loc}}(i\\omega_n) = \\int_{-2t}^{2t} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}\n    $$\n    这个积分可以使用能够处理复值函数的标准数值积分程序（如 `scipy.integrate.quad`）高效地计算。\n\n4.  **计算偏差**：在获得给定 $\\omega_n$ 的 $G_{\\text{loc}}(i\\omega_n)$ 后，我们计算两种杂化函数：\n    -   $\\Delta_{\\text{Bethe}}(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$\n    -   $\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - G_{\\text{loc}}(i\\omega_n)^{-1}$\n    计算绝对差 $| \\Delta_{\\text{Dyson}}(i\\omega_n) - \\Delta_{\\text{Bethe}}(i\\omega_n) |$。\n\n5.  **确定最大偏差**：对所有指定的松原指数 $\\{n_j\\}$ 重复上述步骤。计算出的绝对差中的最大值即为该测试案例的结果 $\\delta_{\\max}$。\n\n**预期的物理行为**：\n-   对于案例1（半圆形DOS），关系式 $\\Delta(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$ 由半圆形的希尔伯特变换的解析性质内在地满足。因此，计算出的 $\\delta_{\\max}$ 应该接近于零，仅受数值积分精度的限制。这个案例是验证实现正确性的一个关键基准。\n-   对于案例2、3和4，我们使用对应于有限$z$的Kesten–McKay DOS。随着$z$的增加，$D_z(\\epsilon)$ 收敛于 $D_{\\text{semi}}(\\epsilon)$。因此，我们预期计算出的偏差 $\\delta_{\\max}$ 非零，但会随着$z$的增加而系统地减小，趋近于$z \\to \\infty$情况下的近零值。这一趋势展示了有限配位贝特晶格向其平均场极限的收敛过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the maximum deviation between two forms of the hybridization function\n    in DMFT for different Bethe lattice DOS models.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'dos_type': 'semi', 't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 6,    't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 20,   't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 1000, 't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        t = case['t']\n        beta = case['beta']\n        U = case['U']\n        w0 = case['w0']\n        n_indices = case['n_indices']\n        dos_type = case['dos_type']\n        \n        t2 = t * t\n\n        # Define the Density of States (DOS) function\n        if dos_type == 'semi':\n            def dos(eps):\n                if np.abs(eps)  2 * t:\n                    return 0.0\n                return (1.0 / (2 * np.pi * t2)) * np.sqrt(4 * t2 - eps**2)\n        elif dos_type == 'km':\n            z = case['z']\n            def dos(eps):\n                if np.abs(eps)  2 * t:\n                    return 0.0\n                eps2 = eps**2\n                term1 = np.sqrt(4.0 - eps2 / t2)\n                term2 = z**2 - (z - 1.0) * eps2 / t2\n                # The denominator is non-zero for z=3 and |eps| = 2t\n                return (z * (z - 1.0) / (2 * np.pi * t)) * (term1 / term2)\n        \n        # Define the self-energy function\n        def self_energy(wn):\n            return U**2 / (wn**2 + w0**2)\n\n        deviations = []\n        for n in n_indices:\n            # Calculate Matsubara frequency\n            wn = (np.pi / beta) * (2 * n + 1)\n            \n            # Calculate self-energy for the current frequency\n            sigma = self_energy(wn)\n            \n            # Define the integrand for the Green's function calculation\n            # G_loc = integral( D(eps) / (i*wn - sigma - eps) d_eps )\n            integrand = lambda eps: dos(eps) / (1j * wn - sigma - eps)\n            \n            # Perform numerical integration to get the local Green's function\n            g_loc, _ = quad(integrand, -2 * t, 2 * t, complex_func=True)\n\n            # Calculate the two forms of the hybridization function\n            # 1. From the infinite-z Bethe lattice self-consistency condition\n            delta_bethe = t2 * g_loc\n            \n            # 2. From the general Dyson equation (mu=0)\n            delta_dyson = 1j * wn - sigma - 1.0 / g_loc\n            \n            # Calculate the absolute deviation\n            deviation = np.abs(delta_dyson - delta_bethe)\n            deviations.append(deviation)\n            \n        # Find the maximum deviation for the current test case\n        max_deviation = np.max(deviations)\n        results.append(max_deviation)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3446460"}, {"introduction": "DMFT 计算的最终目标是获得可与实验相比的物理可观测量。这个练习 [@problem_id:3446487] 聚焦于如何从收敛后的格林函数和自能中，正确地计算动能和势能，而这些量通常是在虚构的松原频率轴上得到的。它将引导你运用如 Galitskii-Migdal 公式等严谨的多体理论关系，来稳健地提取这些能量分量，从而将抽象的理论输出转化为具体的物理洞见。", "problem": "您正在动力学平均场理论 (DMFT) 框架内分析一个单带顺磁 Hubbard 模型。该晶格由无相互作用态密度 $\\,\\rho_{0}(\\epsilon)\\,$ 和化学势 $\\,\\mu\\,$ 指定。在逆温 $\\,\\beta\\,$ 下，您的 DMFT 输出是局域 Matsubara 格林函数 $\\,G_{\\text{loc}}(i\\omega_{n})\\,$、局域 Matsubara 自能 $\\,\\Sigma(i\\omega_{n})\\,$ 和收敛的杂化函数 $\\,\\Delta(i\\omega_{n})\\,$。您还可以通过 $\\,\\rho_{0}(\\epsilon)\\,$ 获得晶格色散关系，并且可以显式地或通过使用 $\\,\\rho_{0}(\\epsilon)\\,$ 的 Hilbert 变换来计算布里渊区积分。在需要时，您可以执行解析延拓以获得局域谱函数 $\\,A_{\\text{loc}}(\\omega)\\,$，但除非绝对必要，否则您希望避免这样做。\n\n仅从第一性原理出发——包括谱函数的定义和格林函数的谱表示、Dyson 方程、等时反对易关系、二次量子化中动能和相互作用能的定义，以及相互作用能与自能和格林函数乘积之间的图形关系——请选择一个计算流程，该流程在热力学上是自洽的、在数值上是稳健的，用于从 DMFT 数据中提取双占据 $\\,\\langle n_{\\uparrow}n_{\\downarrow}\\rangle\\,$ 和每格点动能，并且该流程包括对 $\\,A_{\\text{loc}}(\\omega)\\,$ 的零阶和一阶谱求和规则的正确验证。假设一个总填充数为 $\\,n=\\langle n_{\\uparrow}+n_{\\downarrow}\\rangle\\,$ 且温度有限 $\\,T=1/\\beta\\,$ 的顺磁解，并假设哈密顿量中除了 $\\,\\mu\\,$ 之外没有显式的在位单体能移。\n\n在这些假设下，以下哪个选项提供了正确且完整的步骤？\n\nA. 在 Matsubara 频率上使用图形能量关系，通过对自旋/轨道空间求迹来计算每格点相互作用能，然后通过相互作用能与 $\\,U\\,$ 的比值获得 $\\,\\langle n_{\\uparrow}n_{\\downarrow}\\rangle\\,$。使用 $\\,\\rho_{0}(\\epsilon)\\,$ 和 Dyson 方程构造 $G(\\epsilon,i\\omega_{n})=1/\\big[i\\omega_{n}+\\mu-\\Sigma(i\\omega_{n})-\\epsilon\\big]$，通过 Matsubara 频率上的晶格求和来计算每格点动能，从而避免解析延拓。如果 $\\,A_{\\text{loc}}(\\omega)\\,$ 可用，则通过对其积分来验证零阶谱求和规则，或者更稳健地，通过确认高频尾部行为 $\\,i\\omega_{n}G_{\\text{loc}}(i\\omega_{n})\\to 1\\,$ 来验证。使用与哈密顿量的等时对易子和 $\\,\\Sigma(i\\omega_{n})\\,$ 在大 $\\,i\\omega_{n}\\,$ 下的渐近行为来验证 $\\,A_{\\text{loc}}(\\omega)\\,$ 的一阶谱矩，证明在顺磁相中该矩等于 $-\\mu + U\\,n/2$。\n\nB. 对于任意 $\\,U\\,$，通过填充数推断 $\\,\\langle n_{\\uparrow}n_{\\downarrow}\\rangle=(n/2)^{2}\\,$，并将动能计算为带 Fermi 权重的局域谱函数的一阶频率矩，$\\,E_{\\text{kin}}=\\int d\\omega\\,\\omega\\,A_{\\text{loc}}(\\omega)f(\\omega)\\,$。通过检查 $\\,\\int d\\omega\\,A_{\\text{loc}}(\\omega)=n\\,$ 来验证零阶求和规则，并通过与 $\\,\\int d\\omega\\,\\omega\\,A_{\\text{loc}}(\\omega)\\,$ 比较来验证一阶矩，而不使用对易子。\n\nC. 从 Matsubara 求和 $\\,T\\sum_{n}\\text{Tr}\\big[\\Sigma(i\\omega_{n})G_{\\text{loc}}(i\\omega_{n})\\big]\\,$（无前置因子）计算相互作用能，并将 $\\,\\langle n_{\\uparrow}n_{\\downarrow}\\rangle\\,$ 设置为该值除以 $\\,U\\,$。对于任何晶格，将动能计算为 $\\,E_{\\text{kin}}=T\\sum_{n}\\Delta(i\\omega_{n})G_{\\text{loc}}(i\\omega_{n})\\,$，并通过 $\\int d\\omega\\,A_{\\text{loc}}(\\omega)=\\int d\\epsilon\\,\\rho_{0}(\\epsilon)$ 来验证谱归一化。\n\nD. 将 $\\,G_{\\text{loc}}(i\\omega_{n})\\,$ 和 $\\,\\Sigma(i\\omega_{n})\\,$ 解析延拓到实轴上，并从 $\\,\\int d\\omega\\,f(\\omega)\\,\\mathrm{Im}\\{\\Sigma(\\omega)G_{\\text{loc}}(\\omega)\\}\\,$ 计算相互作用能，不带任何数值前置因子。从 $\\,\\int d\\omega\\,f(\\omega)\\,\\omega\\,A_{\\text{loc}}(\\omega)\\,$ 计算动能。通过 $\\,\\int d\\omega\\,A_{\\text{loc}}(\\omega)=n\\,$ 验证零阶求和规则，并通过与 $-\\mu$ 比较来验证一阶矩。\n\n选择正确的选项。", "solution": "问题陈述在科学上是合理的、提法恰当、客观且内容自洽。它提出了一个在单带 Hubbard 模型中应用动力学平均场理论 (DMFT) 的标准任务，该模型是强关联电子物理学的基石。所有术语和概念都是标准的，并且该问题可以从第一性原理出发得到解答。\n\n我们首先基于所给的第一性原理，为所讨论的物理量建立正确的理论表达式。单带 Hubbard 模型哈密顿量由下式给出：\n$$ H = \\sum_{\\mathbf{k}\\sigma} \\epsilon_{\\mathbf{k}} c_{\\mathbf{k}\\sigma}^\\dagger c_{\\mathbf{k}\\sigma} + U \\sum_i n_{i\\uparrow} n_{i\\downarrow} - \\mu \\sum_{i\\sigma} n_{i\\sigma} $$\n其中 $n_{i\\sigma} = c_{i\\sigma}^\\dagger c_{i\\sigma}$。我们考虑一个顺磁解，其中自旋向上和自旋向下的物理量是相同的。我们用 $N_s$ 表示晶格格点数。\n\n**每格点动能 ($E_{\\text{kin}}$)**\n动能是哈密顿量中跃迁项的期望值。每格点动能为：\n$$ E_{\\text{kin}} = \\frac{1}{N_s} \\left\\langle \\sum_{\\mathbf{k}\\sigma} \\epsilon_{\\mathbf{k}} n_{\\mathbf{k}\\sigma} \\right\\rangle = \\frac{1}{N_s} \\sum_{\\mathbf{k}\\sigma} \\epsilon_{\\mathbf{k}} \\langle n_{\\mathbf{k}\\sigma} \\rangle $$\n动量空间占据数 $\\langle n_{\\mathbf{k}\\sigma} \\rangle$ 可以表示为对晶格格林函数 $G_\\sigma(\\mathbf{k}, i\\omega_n)$ 在 Matsubara 频率 $\\omega_n = (2n+1)\\pi T$ 上的求和：\n$$ \\langle n_{\\mathbf{k}\\sigma} \\rangle = T \\sum_n G_\\sigma(\\mathbf{k}, i\\omega_n) e^{i\\omega_n 0^+} $$\n对于顺磁系统，我们对两个自旋态（$\\sigma = \\uparrow, \\downarrow$）求和，得到一个因子 2：\n$$ E_{\\text{kin}} = \\frac{2T}{N_s} \\sum_n \\sum_{\\mathbf{k}} \\epsilon_{\\mathbf{k}} G(\\mathbf{k}, i\\omega_n) $$\n在 DMFT 中，自能 $\\Sigma(i\\omega_n)$ 是局域的（与动量无关）。Dyson 方程中的晶格格林函数为：\n$$ G(\\mathbf{k}, i\\omega_n) = \\frac{1}{i\\omega_n + \\mu - \\epsilon_{\\mathbf{k}} - \\Sigma(i\\omega_n)} $$\n将此代入 $E_{\\text{kin}}$ 的表达式，并将对 $\\mathbf{k}$ 的求和转换为对无相互作用态密度 $\\rho_0(\\epsilon)$ 的积分：\n$$ E_{\\text{kin}} = 2T \\sum_n \\int d\\epsilon \\, \\rho_0(\\epsilon) \\frac{\\epsilon}{i\\omega_n + \\mu - \\epsilon - \\Sigma(i\\omega_n)} $$\n该公式允许使用 DMFT 在 Matsubara 轴上的计算输出来直接、数值稳健地计算动能，从而避免了解析延拓。\n\n**相互作用能和双占据 ($\\langle n_{\\uparrow}n_{\\downarrow}\\rangle$)**\n根据定义，每格点相互作用能为 $E_{\\text{int}} = U \\langle n_{\\uparrow}n_{\\downarrow} \\rangle$。多体理论中的一个标准图形结果将势能与自能和格林函数联系起来：\n$$ E_{\\text{int}} = T \\sum_n \\text{Tr}[\\Sigma(i\\omega_n) G(i\\omega_n)] $$\n其中迹是针对所有自由度（格点和自旋）的。在单格点 DMFT 中，自能是局域的，$\\Sigma_{ij} = \\delta_{ij}\\Sigma_{\\text{loc}}$，因此对格点求迹会得到一个因子 $N_s$ 并涉及局域格林函数 $G_{\\text{loc}} = G_{ii}$：\n$$ E_{\\text{int}}^{\\text{per site}} = T \\sum_n \\text{Tr}_{\\text{spin}}[\\Sigma(i\\omega_n) G_{\\text{loc}}(i\\omega_n)] $$\n对于单带顺磁系统，对自旋求迹会得到一个因子 2：\n$$ E_{\\text{int}} = 2T \\sum_n \\Sigma(i\\omega_n) G_{\\text{loc}}(i\\omega_n) $$\n因此，双占据可以直接从 Matsubara 频率数据中确定：\n$$ \\langle n_{\\uparrow}n_{\\downarrow}\\rangle = \\frac{E_{\\text{int}}}{U} = \\frac{2T}{U} \\sum_n \\Sigma(i\\omega_n) G_{\\text{loc}}(i\\omega_n) $$\n\n**谱求和规则**\n局域谱函数 $A_{\\text{loc},\\sigma}(\\omega)$ 通过谱表示与局域格林函数相关：\n$$ G_{\\text{loc},\\sigma}(z) = \\int_{-\\infty}^{\\infty} d\\omega \\frac{A_{\\text{loc},\\sigma}(\\omega)}{z-\\omega} $$\n\n1.  **零阶求和规则**：谱函数的零阶矩由等时反对易关系 $\\{c_{i\\sigma}, c_{i\\sigma}^\\dagger \\} = 1$ 确定。其期望值为 $\\langle \\{c_{i\\sigma}, c_{i\\sigma}^\\dagger \\} \\rangle = 1$。这意味着谱函数的积分归一化为 1：\n    $$ \\int_{-\\infty}^{\\infty} d\\omega \\, A_{\\text{loc},\\sigma}(\\omega) = 1 $$\n    避免解析延拓的对此规则的稳健数值检验来自格林函数的大频率（$z \\to \\infty$）展开：$G_{\\text{loc},\\sigma}(z) = \\frac{1}{z} \\int A_{\\text{loc},\\sigma}(\\omega) d\\omega + O(z^{-2})$。因此，如果以下条件成立，则求和规则得到满足：\n    $$ \\lim_{n\\to\\infty} i\\omega_n G_{\\text{loc},\\sigma}(i\\omega_n) = 1 $$\n\n2.  **一阶求和规则**：谱函数的一阶矩由 $m_1 = \\int_{-\\infty}^{\\infty} d\\omega \\, \\omega A_{\\text{loc},\\sigma}(\\omega)$ 给出。使用算符恒等式 $\\int \\omega A(\\omega) d\\omega = \\langle \\{[c,H], c^\\dagger\\}\\rangle$，我们可以计算 Hubbard 哈密顿量的一阶矩。\n    $$ [c_{i\\sigma}, H] = \\sum_j t_{ij}c_{j\\sigma} + U c_{i\\sigma}n_{i,-\\sigma} - \\mu c_{i\\sigma} $$\n    反对易子为 $\\{[c_{i\\sigma}, H], c_{i\\sigma}^\\dagger\\} = \\sum_j t_{ij} \\{c_{j\\sigma}, c_{i\\sigma}^\\dagger\\} + U \\{c_{i\\sigma}n_{i,-\\sigma}, c_{i\\sigma}^\\dagger\\} - \\mu \\{c_{i\\sigma},c_{i\\sigma}^\\dagger\\}$。\n    使用 $\\{c_{j\\sigma},c_{i\\sigma}^\\dagger\\}=\\delta_{ij}$ 和 $\\{c_{i\\sigma}n_{i,-\\sigma}, c_{i\\sigma}^\\dagger\\}=n_{i,-\\sigma}\\{c_{i\\sigma},c_{i\\sigma}^\\dagger\\}=n_{i,-\\sigma}$（因为不同自旋的算符对易），我们得到：\n    $$ \\{[c_{i\\sigma}, H], c_{i\\sigma}^\\dagger\\} = t_{ii} - \\mu + U n_{i,-\\sigma} $$\n    取期望值并假设没有在位能（$t_{ii}=0$），我们得到一阶矩：\n    $$ m_1 = \\langle t_{ii} - \\mu + U n_{i,-\\sigma} \\rangle = -\\mu + U \\langle n_{-\\sigma} \\rangle $$\n    在顺磁相中，$\\langle n_{-\\sigma} \\rangle = n/2$，所以：\n    $$ m_1 = -\\mu + \\frac{Un}{2} $$\n    这个结果也可以从自能的高频展开中得到。对于大的 $z$，$\\Sigma(z) \\to \\Sigma(\\infty) = U\\langle n_{-\\sigma} \\rangle = Un/2$。局域格林函数的 Dyson 方程为 $G_{\\text{loc}}(z)^{-1} = z+\\mu-\\Sigma(z)-\\Delta(z)$，但在 DMFT 中，$\\Delta(z)$ 是从 $G_{loc}$ 本身导出的，并且高频展开 $G_{loc}(z) = \\frac{1}{z} + \\frac{m_1}{z^2} + \\dots$ 与 $G_{loc}(z)^{-1} \\approx z - m_1$ 一致。将此与 Dyson 方程的展开 $G_{loc}(z)^{-1} \\approx z+\\mu-\\Sigma(\\infty)$ 进行匹配，我们发现 $m_1 = -(\\mu - \\Sigma(\\infty)) = \\Sigma(\\infty) - \\mu = Un/2 - \\mu$。因此，检查自能的高频渐近行为提供了一种验证一阶矩的方法。\n\n**选项评估**\n\n*   **A.** 该选项建议在 Matsubara 轴上通过 $\\Sigma G$ 的迹计算相互作用能，然后除以 $U$ 得到 $\\langle n_{\\uparrow}n_{\\downarrow}\\rangle$。它使用导出的对晶格格林函数的 Matsubara 求和来计算动能。它通过 $G_{\\text{loc}}(i\\omega_n)$ 的高频极限验证零阶求和规则，并通过 $\\Sigma(i\\omega_n)$ 的高频极限将一阶矩与 $-\\mu+Un/2$ 关联来验证一阶求和规则。所有这些步骤都是正确的、完整的，并构成了一个在可能的情况下避免解析延拓的稳健工作流程。\n    **结论：正确。**\n\n*   **B.** 该选项声称 $\\langle n_{\\uparrow}n_{\\downarrow}\\rangle = (n/2)^2$。这是一个忽略了关联的平均场近似，对于任何有限的相互作用强度 $U  0$ 都是不正确的。动能公式 $E_{\\text{kin}}=\\int d\\omega\\,\\omega\\,A_{\\text{loc}}(\\omega)f(\\omega)$ 是不正确的；这个表达式与总能量有关，而非纯粹的动能。零阶求和规则的验证 $\\int d\\omega\\,A_{\\text{loc}}(\\omega)=n$ 也是不正确的；该积分应为 1（每个自旋）。\n    **结论：不正确。**\n\n*   **C.** 该选项从 $T\\sum_{n}\\text{Tr}\\big[\\Sigma(i\\omega_{n})G_{\\text{loc}}(i\\omega_{n})\\big]$ 计算相互作用能，这是正确的（假设 `Tr` 意味着自旋迹）。然而，它给出的动能为 $E_{\\text{kin}}=T\\sum_{n}\\Delta(i\\omega_{n})G_{\\text{loc}}(i\\omega_{n})$，这缺少了自旋求和带来的因子 2。此外，该过程不完整，因为它没有提到对一阶谱求和规则的验证。\n    **结论：不正确。**\n\n*   **D.** 该选项依赖于解析延拓，而问题试图避免这一点。它在实轴上计算相互作用能的公式 $\\int d\\omega\\,f(\\omega)\\,\\mathrm{Im}\\{\\Sigma(\\omega)G_{\\text{loc}}(\\omega)\\}$ 缺少了前置因子 $-2/\\pi$。动能的公式不正确，与选项 B 中一样。所述的零阶求和规则 $\\int d\\omega\\,A_{\\text{loc}}(\\omega)=n$ 是不正确的。所述的一阶矩值 $-\\mu$ 也是不正确的，因为它忽略了与相互作用相关的项 $Un/2$。\n    **结论：不正确。**\n\n基于此分析，选项 A 是唯一一个提供正确、完整且稳健的计算工作流程的选项，该流程与在 DMFT 中应用的多体理论第一性原理相一致。", "answer": "$$\\boxed{A}$$", "id": "3446487"}]}