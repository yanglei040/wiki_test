{"hands_on_practices": [{"introduction": "在许多磁性材料中，尤其是在过渡金属氧化物中，磁性源于局域轨道（如 $d$ 轨道）上强烈的电子-电子相互作用。这个基础练习 [@problem_id:3489189] 通过一个简化的氧化镍（NiO）“纸笔”模型，让我们能够直观地理解这一点。通过在原子极限下（忽略电子跃迁）进行分析，我们将直接计算哈伯德 $U$ 和洪德 $J$ 参数如何产生局域磁矩和电子能隙，从而为理解莫特物理学奠定基础。", "problem": "考虑一个用于岩盐结构氧化镍（NiO）的最小双轨道紧束缚模型，该模型能捕捉八面体配位中镍离子的低能物理。在NiO中，镍名义上处于 $d^{8}$ 电子构型，在八面体晶体场作用下，该构型分裂为一个填满的 $t_{2g}^{6}$ 轨道簇和一个部分填充的 $e_{g}^{2}$ 轨道簇。在这个最小模型中，将 $t_{2g}$ 态视为惰性，仅对每个镍位点上的两个简并 $e_{g}$ 轨道进行建模。假设一个二分晶格和保持轨道特性的最近邻跃迁，跃迁振幅为 $t$（你将不需要具体的能带色散关系）。$e_{g}$ 子空间中的在位（on-site）电子-电子相互作用由旋转不变的 Kanamori 形式描述，并限制在其密度-密度部分：\n$$\nH_{\\mathrm{int}} = U \\sum_{m} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m \\neq m', \\sigma} n_{m\\sigma} n_{m'\\sigma},\n$$\n其中 $m \\in \\{a,b\\}$ 标记两个 $e_{g}$ 轨道，$U$ 是轨道内 Hubbard 排斥，$U'$ 是轨道间排斥，$J$ 是洪德交换，并且旋转不变性条件 $U' = U - 2J$ 成立。忽略自旋翻转和电子对跃迁项，并假设在零温下，$e_{g}$ 轨道处于半填充状态（每个镍上有两个 $e_{g}$ 电子），具有共线反铁磁序。在强耦合原子极限（设 $t \\to 0$）下进行计算，因此绝缘能隙由局域多体能量学控制。\n\n仅使用基本定义和经过充分检验的关系，从第一性原理计算：\n1) 绝缘单粒子能隙 $E_{g}(U,J)$，其定义为 $E_{g} = \\mu^{+} - \\mu^{-}$，其中 $\\mu^{+} = E(N+1) - E(N)$ 且 $\\mu^{-} = E(N) - E(N-1)$，对于 $e_{g}$ 轨道中的 $N=2$ 个电子，以及\n2) 反铁磁基态中的饱和局域自旋磁矩 $\\mu_{s}(U,J)$（仅考虑自旋）。\n\n假设基态是由正值 $J$ 稳定的高自旋构型，并忽略 $e_{g}$ 二重态内部的轨道极化。以电子伏特表示 $E_{g}$，以玻尔磁子表示 $\\mu_{s}$。将你的最终答案以单行矩阵的形式给出，其中包含仅用 $U$ 和 $J$ 表示的两个表达式。不要代入任何数值。无需四舍五入。", "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n- **系统**：一个用于岩盐结构氧化镍（NiO）的最小双轨道紧束缚模型。\n- **离子构型**：镍处于 $d^{8}$ 电子构型。\n- **晶体场**：八面体晶体场将 $d$ 轨道分裂为一个填满的 $t_{2g}^{6}$ 轨道簇（视为惰性）和一个部分填充的 $e_{g}^{2}$ 轨道簇。\n- **模型空间**：仅考虑每个镍位点上的两个简并 $e_{g}$ 轨道，标记为 $m \\in \\{a,b\\}$。\n- **填充**：$e_{g}$ 轨道半填充，意味着每个镍位点有 $N=2$ 个电子。\n- **跃迁**：最近邻跃迁振幅为 $t$。问题在原子极限 $t \\to 0$ 下求解。\n- **在位相互作用哈密顿量**：Kanamori 形式，并限制在其密度-密度部分：\n$$H_{\\mathrm{int}} = U \\sum_{m} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m \\neq m', \\sigma} n_{m\\sigma} n_{m'\\sigma}$$\n- **相互作用参数**：$U$（轨道内 Hubbard 排斥），$U'$（轨道间排斥），$J$（洪德交换）。\n- **约束条件**：旋转不变性条件 $U' = U - 2J$。\n- **磁性状态**：零温下的共线反铁磁序。对于 $N=2$ 个电子，基态是由正值 $J$ 稳定的高自旋构型。\n- **轨道状态**：忽略 $e_{g}$ 二重态内部的轨道极化。\n- **待计算量1**：绝缘单粒子能隙 $E_{g}(U,J)$，定义为 $E_{g} = \\mu^{+} - \\mu^{-}$，其中 $\\mu^{+} = E(N+1) - E(N)$ 且 $\\mu^{-} = E(N) - E(N-1)$，对于 $N=2$。\n- **待计算量2**：基态中的饱和局域自旋磁矩 $\\mu_{s}(U,J)$（仅考虑自旋）。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题坚实地基于凝聚态物理中的标准模型，即 Hubbard-Kanamori 模型，这是描述过渡金属氧化物等强关联电子体系的基石。晶体场分裂、洪德耦合和莫特-哈伯德能隙等概念都是公认的。在该广泛使用的理论模型背景下，所有前提在事实上都是正确的。\n- **问题明确**：该问题提供了所有必要的定义、参数（$U, U', J$）、约束条件（$U' = U - 2J$），以及一个清晰的计算框架（原子极限 $t \\to 0$）。待计算量（$E_g$, $\\mu_s$）的定义明确。对 $N=2$ 的高自旋基态的假设消除了在确定参考态时的任何模糊性。存在一个唯一的、稳定的且有意义的解。\n- **客观性**：问题以精确、正式的语言陈述，不含主观性或个人观点。\n- **完整性**：模型是自洽的。原子极限的简化（$t \\to 0$）使得问题无需晶格或能带色散的细节即可求解。所有必需的关系都已提供。\n- **一致性**：给定的条件内部一致。Kanamori 哈密顿量，连同旋转不变性条件和对 $J > 0$ 时高自旋基态的假设，构成了一个连贯的物理图像。\n\n### 步骤3：结论与行动\n该问题有效。这是一个来自理论凝聚态物理领域的、问题明确且有科学依据的问题。可以开始求解过程。\n\n## 解法\n\n该问题设定在原子极限（$t \\to 0$）下，这意味着哈密顿量的动能项为零。系统的总能量完全由孤立镍离子 $e_g$ 轨道的在位电子-电子相互作用哈密顿量 $H_{\\mathrm{int}}$ 决定。\n\n两个 $e_g$ 轨道（标记为 $a$ 和 $b$）的相互作用哈密顿量为：\n$$H_{\\mathrm{int}} = U \\sum_{m \\in \\{a,b\\}} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m \\neq m', \\sigma} n_{m\\sigma} n_{m'\\sigma}$$\n在一个双轨道模型中，对 $m \\neq m'$ 的求和对应于单对轨道 $(a, b)$。哈密顿量简化为：\n$$H_{\\mathrm{int}} = U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow}) + U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow}) + (U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow})$$\n我们使用旋转不变性条件 $U'=U-2J$ 将所有能量用 $U$ 和 $J$ 表示。\n\n### 1) 绝缘能隙 $E_g$ 的计算\n\n能隙定义为 $E_g = \\mu^{+} - \\mu^{-}$，其中 $\\mu^{+} = E(N+1) - E(N)$ 且 $\\mu^{-} = E(N) - E(N-1)$。问题指定中性原子在 $e_g$ 壳层中有 $N=2$ 个电子。因此，我们需要计算基态能量 $E(1)$、$E(2)$ 和 $E(3)$。\n\n**$N=1$ 个电子的基态能量 $E(1)$：**\n基态由一个占据某个轨道（比如 $|a\\uparrow\\rangle$）的单电子构成。占据数为 $n_{a\\uparrow}=1$，其他均为零。$H_{\\mathrm{int}}$ 中的所有项都至少需要两个电子。因此，相互作用能为零。\n$$E(1) = 0$$\n\n**$N=2$ 个电子的基态能量 $E(2)$：**\n问题指出，对于 $N=2$，基态是高自旋构型。对于两个简并轨道中的两个电子，高自旋态是一个三重态（$S=1$），其中每个电子占据一个不同的轨道，且自旋平行。一个代表性的状态是 $|a\\uparrow, b\\uparrow\\rangle$。\n占据数为 $n_{a\\uparrow}=1$，$n_{b\\uparrow}=1$，而 $n_{a\\downarrow}=n_{b\\downarrow}=0$。\n让我们用 $H_{\\mathrm{int}}$ 计算这个状态的能量：\n- 轨道内排斥项 $U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow})$ 为 $0$，因为没有双重占据。\n- 轨道间异自旋项 $U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow})$ 为 $0$，因为电子自旋平行。\n- 轨道间同自旋项 $(U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow})$ 为 $(U' - J)(1 \\cdot 1 + 0 \\cdot 0) = U' - J$。\n所以，$N=2$ 的基态能量为：\n$$E(2) = U' - J$$\n代入 $U' = U - 2J$：\n$$E(2) = (U - 2J) - J = U - 3J$$\n\n**$N=3$ 个电子的基态能量 $E(3)$：**\n对于 $N=3$ 个电子，其基态是通过向 $N=2$ 的基态添加一个电子形成的。构型将是一个轨道中有两个电子，另一个轨道中有一个电子，例如 $|a\\uparrow, a\\downarrow, b\\uparrow\\rangle$。\n占据数为 $n_{a\\uparrow}=1$, $n_{a\\downarrow}=1$ 和 $n_{b\\uparrow}=1$。\n让我们计算这个状态的能量：\n- 轨道内排斥：$U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow}) = U(1 \\cdot 1 + 1 \\cdot 0) = U$。\n- 轨道间异自旋：$U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow}) = U'(1 \\cdot 0 + 1 \\cdot 1) = U'$。\n- 轨道间同自旋：$(U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow}) = (U' - J)(1 \\cdot 1 + 1 \\cdot 0) = U' - J$。\n总能量是这些贡献之和：\n$$E(3) = U + U' + (U' - J) = U + 2U' - J$$\n代入 $U' = U - 2J$：\n$$E(3) = U + 2(U - 2J) - J = U + 2U - 4J - J = 3U - 5J$$\n\n**计算能隙：**\n现在我们可以计算化学势和能隙。\n电子移除能（电离势）为：\n$$\\mu^{-} = E(N) - E(N-1) = E(2) - E(1) = (U - 3J) - 0 = U - 3J$$\n电子增加能（电子亲和能）为：\n$$\\mu^{+} = E(N+1) - E(N) = E(3) - E(2) = (3U - 5J) - (U - 3J) = 2U - 2J$$\n单粒子能隙是这两个能量之差：\n$$E_g = \\mu^{+} - \\mu^{-} = (2U - 2J) - (U - 3J) = 2U - 2J - U + 3J$$\n$$E_g = U + J$$\n\n### 2) 饱和局域自旋磁矩 $\\mu_s$ 的计算\n\n饱和局域自旋磁矩由局域基态的总自旋量子数 $S$ 决定。如前所述，$N=2$ 个电子的基态是高自旋构型 $|a\\uparrow, b\\uparrow\\rangle$。这是一个三重态，由两个自旋平行的自旋-$1/2$ 电子形成。\n总自旋角动量量子数为 $S = \\frac{1}{2} + \\frac{1}{2} = 1$。\n“饱和”磁矩指的是自旋磁矩沿某一量子化轴的最大投影。仅考虑自旋的磁矩由 $\\vec{\\mu}_s = - g_s \\mu_B \\vec{S} / \\hbar$ 给出，其中 $\\mu_B$ 是玻尔磁子，$g_s \\approx 2$ 是电子的 g 因子。\n在固态物理学中，一个位点上有序磁矩的大小通常表示为 $g_s S \\mu_B$。\n使用 $S=1$ 和近似值 $g_s = 2$：\n$$\\mu_s = g_s S \\mu_B = 2 \\cdot 1 \\cdot \\mu_B = 2 \\mu_B$$\n局域磁矩的大小是 $2$（以玻尔磁子为单位）。这个结果仅取决于基态的自旋构型（由问题陈述固定），而不取决于参数 $U$ 和 $J$ 的能量值。参数 $U$ 和 $J$ 决定了这个状态是基态，但它们不改变其固有的自旋量子数。\n\n所求的两个量是 $E_g = U+J$ 和 $\\mu_s = 2 \\mu_B$。", "answer": "$$\\boxed{\\begin{pmatrix} U + J & 2 \\end{pmatrix}}$$", "id": "3489189"}, {"introduction": "理解了局域磁矩的起源后，下一步是探究这些磁矩如何在晶格中相互作用，从而导致长程磁序（如铁磁性或反铁磁性）。这个练习 [@problem_id:3489162] 演示了一种核心的计算技术：将复杂的 DFT 计算结果映射到一个更简单、更直观的物理模型——海森堡模型上。我们将利用为不同磁构型计算出的总能量，拟合出决定材料磁基态和稳定性的近邻和次近邻交换耦合常数 $J_1$ 和 $J_2$。", "problem": "考虑一个简立方布拉维晶格上的经典共线海森堡模型。给定三种共线自旋构型：铁磁（FM）、I型反铁磁（AFM-I）和II型反铁磁（AFM-II）。假设单位自旋长度，因此每个格点上的自旋矢量模为 $1$，并且只考虑第一和第二近邻交换相互作用。哈密顿量定义为\n$$\nH \\;=\\; \\frac{1}{2}\\sum_{i\\neq j} J_{ij}\\,\\mathbf S_i\\cdot\\mathbf S_j \\,,\n$$\n其中，如果 $i$ 和 $j$ 是最近邻，则 $J_{ij}=J_1$；如果 $i$ 和 $j$ 是次近邻，则 $J_{ij}=J_2$；其他情况 $J_{ij}=0$。因子 $1/2$ 是为了避免重复计算键。对于由自旋极化密度泛函理论（DFT）计算的构型总能量，将每个原子的能量建模为\n$$\nE_{\\text{conf}} \\;=\\; E_0 \\;+\\; \\frac{1}{2}\\left(J_1 \\sum_{\\langle i,j\\rangle_1} s_i s_j \\;+\\; J_2 \\sum_{\\langle i,j\\rangle_2} s_i s_j\\right)\\,,\n$$\n其中 $E_0$ 是与构型无关的每个原子的能量偏移量，$s_i=\\pm 1$ 表示格点 $i$ 上的共线自旋方向，求和 $\\sum_{\\langle i,j\\rangle_1}$ 遍及从一个参考格点到其所有 $z_1$ 个最近邻的键，求和 $\\sum_{\\langle i,j\\rangle_2}$ 遍及从该格点到其所有 $z_2$ 个次近邻的键。对于简立方晶格，$z_1=6$，$z_2=12$。\n\n这三种自旋构型由一个传播矢量 $\\mathbf Q$（角度以弧度为单位）定义，对于晶格矢量 $\\mathbf R$，$s(\\mathbf R)\\in\\{+1,-1\\}$ 由 $s(\\mathbf R)=\\cos(\\mathbf Q\\cdot\\mathbf R)$ 决定：\n- FM：$\\mathbf Q_{\\text{FM}}=(0,0,0)$。\n- AFM-I：$\\mathbf Q_{\\text{I}}=(\\pi,0,0)$，它在相邻的 $(100)$ 平面之间交替自旋方向，并在每个平面内保持自旋平行。\n- AFM-II：$\\mathbf Q_{\\text{II}}=(\\pi,\\pi,\\pi)$，它在每个格点上以棋盘格模式交替自旋方向。\n\n您的任务是编写一个程序，给定三种构型 $\\{E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}}\\}$ 的每原子DFT总能量（以毫电子伏特每原子表示，缩写为 meV/atom），通过拟合上述海森堡模型来提取交换参数 $J_1$ 和 $J_2$（以 meV 为单位）。您必须也将 $E_0$ 视为一个待拟合的未知数。您应该从第一性原理出发：使用哈密顿量定义、晶格配位数和传播矢量来推导每种构型的自旋关联和，构建连接 $\\{E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}}\\}$ 与 $\\{J_1,J_2,E_0\\}$ 的线性方程组，然后求解 $\\{J_1,J_2,E_0\\}$。\n\n角度必须以弧度处理。交换参数 $J_1$ 和 $J_2$ 以及偏移量 $E_0$ 必须以毫电子伏特（meV）为单位，作为浮点数报告。\n\n测试套件。使用以下三个独立的测试用例。对于每个用例，三个输入能量 $(E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}})$（单位为 meV/atom）为：\n- 用例A（一般情况）：$E_{\\text{FM}}=-118$, $E_{\\text{I}}=-114$, $E_{\\text{II}}=-58$。\n- 用例B（边界情况 $J_1=0$）：$E_{\\text{FM}}=21$, $E_{\\text{I}}=-7$, $E_{\\text{II}}=21$。\n- 用例C（边界情况 $J_2=0$）：$E_{\\text{FM}}=22$, $E_{\\text{I}}=14$, $E_{\\text{II}}=-2$。\n\n最终输出规范。您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是包含三个浮点数 $[J_1,J_2,E_0]$（单位 meV）的列表，每个浮点数四舍五入到六位小数，并与上述测试用例的顺序相同。例如，输出格式必须为\n“[ [J1_A,J2_A,E0_A], [J1_B,J2_B,E0_B], [J1_C,J2_C,E0_C] ]”\n除了有效列表语法所需的空格外，不包含任何额外的文本或空格。请注意，数值必须以 meV 为单位，并四舍五入到六位小数。", "solution": "以下是为创建Python解决方案的思考过程。用户需要一个 Python 脚本，该脚本接收三个能量值（FM、AFM-I、AFM-II），并计算海森堡交换参数 $J_1$ 和 $J_2$，以及一个能量偏移量 $E_0$。这是一个典型的求解线性方程组逆问题的例子。\n\n第一步是根据问题描述推导线性方程组。\n每个原子的能量由以下公式给出：$E_{\\text{conf}} \\;=\\; E_0 \\;+\\; \\frac{1}{2}\\left(J_1 \\sum_{\\langle i,j\\rangle_1} s_i s_j \\;+\\; J_2 \\sum_{\\langle i,j\\rangle_2} s_i s_j\\right)$\n我们需要为三种构型中的每一种计算最近邻（NN）和次近邻（NNN）的自旋乘积和 $\\sum s_i s_j$。\n求和是针对从一个参考格点（我们称之为位于原点 $\\mathbf R_0=(0,0,0)$ 的格点0）出发的键。\n我们可以假设对于所有构型，$s_0 = s(\\mathbf R_0) = \\cos(\\mathbf Q \\cdot \\mathbf 0) = \\cos(0) = +1$。\n因此，求和简化为 $\\sum_{\\text{邻居 } j} s_j$。\n晶格是简立方的。\n最近邻（NN）：在位置 $(\\pm a, 0, 0)$、$(0, \\pm a, 0)$、$(0, 0, \\pm a)$ 处有 $z_1=6$ 个最近邻。为简单起见，我们设晶格常数 $a=1$。\n次近邻（NNN）：在 $(\\pm 1, \\pm 1, 0)$、$(\\pm 1, 0, \\pm 1)$、$(0, \\pm 1, \\pm 1)$ 等位置有 $z_2=12$ 个次近邻。\n\n**构型 1：铁磁（FM）**\n$\\mathbf Q_{\\text{FM}}=(0,0,0)$。对于任意位置为 $\\mathbf R_j$ 的邻居，$s_j = \\cos(0 \\cdot \\mathbf R_j) = \\cos(0)=1$。\n所以所有自旋都是 $+1$。\nNN 和：$\\sum_{NN} s_j = 6 \\times (+1) = 6$。\nNNN 和：$\\sum_{NNN} s_j = 12 \\times (+1) = 12$。\n$E_{\\text{FM}} = E_0 + \\frac{1}{2}(J_1 \\cdot 6 + J_2 \\cdot 12) = E_0 + 3J_1 + 6J_2$。\n\n**构型 2：I 型反铁磁（AFM-I）**\n$\\mathbf Q_{\\text{I}}=(\\pi,0,0)$。对于位置为 $\\mathbf R_j=(x_j, y_j, z_j)$ 的邻居，$s_j = \\cos(\\pi x_j)$。\nNN 和：对于邻居 $(\\pm 1, 0, 0)$，$s_j = \\cos(\\pm \\pi)=-1$。有两个这样的邻居。对于邻居 $(0, \\pm 1, 0)$ 和 $(0, 0, \\pm 1)$，$s_j=\\cos(0)=+1$。有四个这样的邻居。NN 总和 = $2 \\times (-1) + 4 \\times (+1) = 2$。\nNNN 和：邻居类型为 $(\\pm 1, \\pm 1, 0)$、$(\\pm 1, 0, \\pm 1)$、$(0, \\pm 1, \\pm 1)$。\n    - $(\\pm 1, \\pm 1, 0)$：4个邻居。$x=\\pm 1$，所以 $s_j=\\cos(\\pm\\pi)=-1$。\n    - $(\\pm 1, 0, \\pm 1)$：4个邻居。$x=\\pm 1$，所以 $s_j=\\cos(\\pm\\pi)=-1$。\n    - $(0, \\pm 1, \\pm 1)$：4个邻居。$x=0$，所以 $s_j=\\cos(0)=+1$。\n    - NNN 总和 = $4 \\times (-1) + 4 \\times (-1) + 4 \\times (+1) = -4$。\n$E_{\\text{I}} = E_0 + \\frac{1}{2}(J_1 \\cdot 2 + J_2 \\cdot (-4)) = E_0 + J_1 - 2J_2$。\n\n**构型 3：II 型反铁磁（AFM-II）**\n$\\mathbf Q_{\\text{II}}=(\\pi,\\pi,\\pi)$。对于位置为 $\\mathbf R_j=(x_j, y_j, z_j)$ 的邻居，$s_j = \\cos(\\pi(x_j+y_j+z_j))$。\nNN 和：所有邻居如 $(\\pm 1,0,0)$ 等，其坐标和 $x_j+y_j+z_j = \\pm 1$。所以 $s_j = \\cos(\\pm\\pi)=-1$。NN 总和 = $6 \\times (-1) = -6$。\nNNN 和：所有邻居如 $(\\pm 1, \\pm 1, 0)$ 等，其坐标和 $x_j+y_j+z_j$ 为 $\\pm 2$ 或 $0$。\n    - $(\\pm 1, \\pm 1, 0)$: $x+y+z \\in \\{-2, 0, 2\\}$。两个邻居 $(\\pm 1, \\mp 1, 0)$ 的坐标和为 0。两个邻居 $(\\pm 1, \\pm 1, 0)$ 的坐标和为 $\\pm 2$。\n    - 更简单地说，对于任何 NNN 矢量，分量之和是一个偶数（$0, \\pm 2$）。例如，对于 $(\\pm 1, \\pm 1, 0)$，坐标和为 $2, 0, 0, -2$。对于 $(\\pm 1, 0, \\pm 1)$，坐标和为 $2, 0, 0, -2$。对于 $(0, \\pm 1, \\pm 1)$，坐标和为 $2, 0, 0, -2$。\n    - 所以对于任何 NNN，$s_j = \\cos(\\pi \\cdot (\\text{偶数})) = \\cos(2n\\pi) = +1$。\n    - NNN 总和 = $12 \\times (+1) = 12$。\n$E_{\\text{II}} = E_0 + \\frac{1}{2}(J_1 \\cdot (-6) + J_2 \\cdot 12) = E_0 - 3J_1 + 6J_2$。\n\n**线性方程组**\n$E_{\\text{FM}} = E_0 + 3J_1 + 6J_2$\n$E_{\\text{I}}  = E_0 + J_1 - 2J_2$\n$E_{\\text{II}} = E_0 - 3J_1 + 6J_2$\n这是关于三个未知数 $J_1, J_2, E_0$ 的三元线性方程组。\n写成矩阵形式 $\\mathbf{A} \\mathbf{x} = \\mathbf{b}$：\n$ \\begin{pmatrix} 1  3  6 \\\\ 1  1  -2 \\\\ 1  -3  6 \\end{pmatrix} \\begin{pmatrix} E_0 \\\\ J_1 \\\\ J_2 \\end{pmatrix} = \\begin{pmatrix} E_{\\text{FM}} \\\\ E_{\\text{I}} \\\\ E_{\\text{II}} \\end{pmatrix} $\n注意，我矩阵中的变量顺序是 $(E_0, J_1, J_2)$。问题要求输出顺序为 $[J_1, J_2, E_0]$。我必须记得对解向量重新排序。\n我可以使用 `numpy.linalg.solve` 来解这个方程组。\n\n**符号求解方程组（用于验证）**\n(Eq1) $E_{\\text{FM}} = E_0 + 3J_1 + 6J_2$\n(Eq2) $E_{\\text{I}}  = E_0 + J_1 - 2J_2$\n(Eq3) $E_{\\text{II}} = E_0 - 3J_1 + 6J_2$\n用(Eq1)减去(Eq3)：$E_{\\text{FM}} - E_{\\text{II}} = (E_0 + 3J_1 + 6J_2) - (E_0 - 3J_1 + 6J_2) = 6J_1$。所以，$J_1 = (E_{\\text{FM}} - E_{\\text{II}}) / 6$。\n将(Eq1)与(Eq3)相加：$E_{\\text{FM}} + E_{\\text{II}} = 2E_0 + 12J_2$。\n(Eq2) * 2：$2E_{\\text{I}} = 2E_0 + 2J_1 - 4J_2$。\n将这两个新方程相减：$(E_{\\text{FM}} + E_{\\text{II}}) - 2E_{\\text{I}} = (2E_0 + 12J_2) - (2E_0 + 2J_1 - 4J_2) = 16J_2 - 2J_1$。\n$16J_2 = (E_{\\text{FM}} + E_{\\text{II}} - 2E_{\\text{I}}) + 2J_1$。\n$16J_2 = (E_{\\text{FM}} + E_{\\text{II}} - 2E_{\\text{I}}) + 2 \\frac{E_{\\text{FM}} - E_{\\text{II}}}{6} = E_{\\text{FM}} + E_{\\text{II}} - 2E_{\\text{I}} + \\frac{E_{\\text{FM}} - E_{\\text{II}}}{3}$。\n$16J_2 = \\frac{3E_{\\text{FM}} + 3E_{\\text{II}} - 6E_{\\text{I}} + E_{\\text{FM}} - E_{\\text{II}}}{3} = \\frac{4E_{\\text{FM}} + 2E_{\\text{II}} - 6E_{\\text{I}}}{3}$。\n$J_2 = \\frac{4E_{\\text{FM}} + 2E_{\\text{II}} - 6E_{\\text{I}}}{48} = \\frac{2E_{\\text{FM}} + E_{\\text{II}} - 3E_{\\text{I}}}{24}$。\n最后，从(Eq2)可得，$E_0 = E_{\\text{I}} - J_1 + 2J_2$。\n这个符号解可以用来检验数值结果。\n\n**应用于测试用例**\n用例 A：$E_{\\text{FM}}=-118, E_{\\text{I}}=-114, E_{\\text{II}}=-58$\n$J_1 = (-118 - (-58)) / 6 = -60 / 6 = -10$。\n$J_2 = (2(-118) + (-58) - 3(-114)) / 24 = (-236 - 58 + 342) / 24 = 48 / 24 = 2$。\n$E_0 = -114 - (-10) + 2(2) = -114 + 10 + 4 = -100$。\n结果：$[J_1, J_2, E_0] = [-10, 2, -100]$。\n\n用例 B：$E_{\\text{FM}}=21, E_{\\text{I}}=-7, E_{\\text{II}}=21$\n$J_1 = (21 - 21) / 6 = 0$。\n$J_2 = (2(21) + 21 - 3(-7)) / 24 = (42 + 21 + 21) / 24 = 84 / 24 = 3.5$。\n$E_0 = -7 - 0 + 2(3.5) = -7 + 7 = 0$。\n结果：$[J_1, J_2, E_0] = [0, 3.5, 0]$。\n\n用例 C：$E_{\\text{FM}}=22, E_{\\text{I}}=14, E_{\\text{II}}=-2$\n$J_1 = (22 - (-2)) / 6 = 24 / 6 = 4$。\n$J_2 = (2(22) + (-2) - 3(14)) / 24 = (44 - 2 - 42) / 24 = 0 / 24 = 0$。\n$E_0 = 14 - 4 + 2(0) = 10$。\n结果：$[J_1, J_2, E_0] = [4, 0, 10]$。\n\n手动计算结果应与 `numpy.linalg.solve` 的结果一致。代码结构将是：\n1. 定义矩阵 `A`。\n2. 定义测试用例列表 `b_vectors`。\n3. 循环遍历测试用例。\n4. 对每个用例，调用 `numpy.linalg.solve`。\n5. 将结果重新排序为 `[J1, J2, E0]`。\n6. 将结果四舍五入到六位小数。\n7. 将最终的列表之列表格式化为所需的字符串格式并打印。\n\n逻辑的最后检查：\n哈密顿量为 $H \\;=\\; \\frac{1}{2}\\sum_{i\\neq j} J_{ij}\\,\\mathbf S_i\\cdot\\mathbf S_j$。\n给定的是*每个原子*的能量。晶体的总能量是广延量。要获得每个原子的能量，我们可以取单个原子的能量及其相互作用，然后除以1。\n单个原子 $i$ 的能量是 $E_i = \\sum_{j\\neq i} J_{ij} \\mathbf{S}_i \\cdot \\mathbf{S}_j$。总能量是 $H = \\frac{1}{2}\\sum_i E_i$。\n问题给出的每个原子的能量模型为：$E_{\\text{conf}} \\;=\\; E_0 \\;+\\; \\frac{1}{2}\\left(J_1 \\sum_{\\langle i,j\\rangle_1} s_i s_j \\;+\\; J_2 \\sum_{\\langle i,j\\rangle_2} s_i s_j\\right)$。\n这与哈密顿量一致吗？\n让我们从哈密顿量中推导每个原子的总能量表达式。总能量 $H = N \\cdot E_{\\text{per-atom}}$。\n$H = \\frac{1}{2} \\sum_{i \\neq j} J_{ij} s_i s_j = \\frac{1}{2} \\sum_i \\sum_{j \\neq i} J_{ij} s_i s_j$。\n由于晶格的周期性，对于所有格点 $i$，和 $\\sum_{j \\neq i} J_{ij} s_i s_j$ 都是相同的。我们称这个值为 $E_i^{int}$。所以 $H = \\frac{1}{2} N E_i^{int}$。\n那么每个原子的能量就是 $E_{\\text{per-atom}} = H/N = \\frac{1}{2} E_i^{int} = \\frac{1}{2} \\sum_{j \\neq i} J_{ij} s_i s_j$。\n$E_{\\text{per-atom}} = \\frac{1}{2} \\left( \\sum_{j \\in NN(i)} J_1 s_i s_j + \\sum_{j \\in NNN(i)} J_2 s_i s_j \\right)$\n问题给出的公式是 $E_{\\text{conf}} = E_0 + \\frac{1}{2}\\left(J_1 \\sum_{\\langle i,j\\rangle_1} s_i s_j \\;+\\; J_2 \\sum_{\\langle i,j\\rangle_2} s_i s_j\\right)$。\n公式中的求和 $\\sum_{\\langle i,j\\rangle_1}$ 和 $\\sum_{\\langle i,j\\rangle_2}$ 是对从一个参考格点出发的键进行的。这与我的 $\\sum_{j \\in NN(i)}$ 和 $\\sum_{j \\in NNN(i)}$ 是相同的。\n所以问题中的 $E_{\\text{conf}}$ 是磁相互作用能部分，外加一个偏移量 $E_0$。\n我的推导 $E_{\\text{conf}} = E_0 + \\frac{1}{2} J_1 S_1 + \\frac{1}{2} J_2 S_2$ 与问题的公式相符，其中我的 $S_k = \\sum_{\\langle i,j\\rangle_k} s_i s_j$。\n$s_i s_j$ 是自旋方向的乘积。\n$S_k = \\sum s_i s_j$。我把它改写成 $s_i \\sum s_j$。这是正确的。\n所以推导过程是：$E = E_0 + \\frac{1}{2} s_i \\left( J_1 \\sum_{NN} s_j + J_2 \\sum_{NNN} s_j \\right)$。\n因为我们可以选择参考格点 $i$ 的自旋 $s_i=+1$，所以我的简化推导是成立的。\n$E = E_0 + \\frac{1}{2} \\left( J_1 \\sum_{NN} s_j + J_2 \\sum_{NNN} s_j \\right)$。\n我的线性方程组中的系数来自于 $\\frac{1}{2} \\sum_{NN} s_j$ 和 $\\frac{1}{2} \\sum_{NNN} s_j$。\n对于 FM：$\\frac{1}{2}(6) = 3$ 和 $\\frac{1}{2}(12) = 6$。所以 $E_{\\text{FM}} = E_0 + 3J_1 + 6J_2$。正确。\n对于 AFM-I：$\\frac{1}{2}(2) = 1$ 和 $\\frac{1}{2}(-4) = -2$。所以 $E_{\\text{I}} = E_0 + J_1 - 2J_2$。正确。\n对于 AFM-II：$\\frac{1}{2}(-6) = -3$ 和 $\\frac{1}{2}(12) = 6$。所以 $E_{\\text{II}} = E_0 - 3J_1 + 6J_2$。正确。\n整个推导过程是可靠的，并且与问题陈述一致。$E_0$ 的使用是标准做法，它代表了对每个原子的总能量的所有非磁性贡献，并假设这些贡献在这些磁构型中是恒定的。\n该问题也与*计算材料科学*领域内的特定主题*磁性材料的自旋极化电子结构*直接相关。其前提正是人们在此类研究中后处理DFT结果的方式。\n一切就绪。开始编写解决方案。\n在这个思考块之后，我将使用另一个XML块来构建最终答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef format_list_of_lists(list_of_lists):\n    \"\"\"\n    Formats a list of lists into the required string format.\n    Example: [[-10.0, 2.0, -100.0], [0.0, 3.5, 0.0]]\n    Becomes: '[[-10.0, 2.0, -100.0], [0.0, 3.5, 0.0]]'\n    The standard str() function for a list adds spaces, so we build the string manually.\n    The boilerplate print statement actually produces '[[...],[...]]' which has extra spaces which may be undesirable.\n    A more robust way is to build the string representation exactly.\n    \"\"\"\n    inner_strings = []\n    for inner_list in list_of_lists:\n        # Format each number to 6 decimal places and create a string like \"[num1,num2,num3]\"\n        # Note: round() can lead to surprises like 3.5 -> 3.499999.\n        # Format strings are generally safer for specific decimal place representation.\n        # However, the problem asks for floats rounded to six decimal places, so python round() is appropriate.\n        # After rounding, default float-to-string conversion is fine.\n        inner_strings.append(f\"[{', '.join(map(str, inner_list))}]\")\n    \n    # After review, the boilerplate `print(f\"[{','.join(map(str, results))}]\")` works fine if `results`\n    # is a list of lists, as `str(inner_list)` produces the desired `[a, b, c]` format.\n    # No custom formatting function is needed if the boilerplate is used correctly. \n    # The default string representation of a list is `[item1, item2, item3]`, including spaces.\n    # The join then produces `[...],[...],[...]`, and the f-string wraps it in `[...]`.\n    # Final format: `[[...], [...], [...]]`. This appears correct.\n    return f\"[{','.join(map(str, list_of_lists))}]\"\n\ndef solve():\n    \"\"\"\n    Solves for the Heisenberg exchange parameters J1, J2 and offset E0\n    from the total energies of FM, AFM-I, and AFM-II configurations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E_FM, E_I, E_II) in meV/atom.\n    test_cases = [\n        (-118, -114, -58),  # Case A\n        (21, -7, 21),      # Case B\n        (22, 14, -2),      # Case C\n    ]\n\n    # The per-atom energies for the three configurations are given by the system:\n    # E_FM   = E0 + 3*J1 + 6*J2\n    # E_I    = E0 + 1*J1 - 2*J2\n    # E_II   = E0 - 3*J1 + 6*J2\n    #\n    # In matrix form A * x = b, where x = [E0, J1, J2]^T:\n    #\n    # [[1,  3,  6],   [E0],   [E_FM]\n    #  [1,  1, -2], * [J1], = [E_I]\n    #  [1, -3,  6]]   [J2]]   [E_II]\n    #\n    # We solve this linear system for x = [E0, J1, J2].\n    \n    # Coefficient matrix 'A'\n    A = np.array([\n        [1, 3, 6],\n        [1, 1, -2],\n        [1, -3, 6]\n    ])\n\n    results = []\n    for case in test_cases:\n        e_fm, e_i, e_ii = case\n        \n        # Right-hand side vector 'b'\n        b = np.array([e_fm, e_i, e_ii])\n        \n        # Solve the linear system A*x = b for x\n        x = np.linalg.solve(A, b)\n        \n        # The solution vector x is [E0, J1, J2]\n        e0, j1, j2 = x[0], x[1], x[2]\n        \n        # The problem requires the output order [J1, J2, E0].\n        # The values must be floats rounded to six decimal places.\n        result = [round(j1, 6), round(j2, 6), round(e0, 6)]\n        \n        results.append(result)\n\n    # The final print statement must follow the exact format given.\n    # The provided boilerplate joins string representations of the inner lists.\n    # `str([-10.0, 2.0, -100.0])` yields `'[-10.0, 2.0, -100.0]'`.\n    # Joining with ',' and wrapping in '[]' gives '[[...],[...]]', which is a string\n    # representation of a list of lists, but is not valid python list syntax itself due\n    # to the lack of spaces after commas. Let's use a method that produces valid python list literal string.\n    # Re-evaluating the boilerplate `print(f\"[{','.join(map(str, results))}]\")`\n    # Let's see what it produces with computed values:\n    # results = [[-10.0, 2.0, -100.0], [0.0, 3.5, 0.0], [4.0, 0.0, 10.0]]\n    # map(str, results) -> '[-10.0, 2.0, -100.0]', '[0.0, 3.5, 0.0]', '[4.0, 0.0, 10.0]'\n    # ','.join(...) -> '[-10.0, 2.0, -100.0],[0.0, 3.5, 0.0],[4.0, 0.0, 10.0]'\n    # f\"[{...}]\" -> '[[-10.0, 2.0, -100.0],[0.0, 3.5, 0.0],[4.0, 0.0, 10.0]]'\n    # This string is the expected format. It represents a list of lists.\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\n\nsolve()\n```", "id": "3489162"}, {"introduction": "并非所有磁性材料都具有定义明确的整数值局域磁矩；在许多金属中，磁性是“巡游的”，源于离域导电电子的集体有序化。这个最后的练习 [@problem_id:3489229] 将第一性原理计算与宏观热力学理论联系起来。我们将使用来自约束磁矩计算的总能量数据来构建一个有效的朗道自由能多项式，通过分析该模型来确定材料的平衡磁化强度和相稳定性，并将其唯象系数与微观的斯托纳判据联系起来。", "problem": "考虑一个巡游电子系统，其自旋极化基态可以通过密度泛函理论 (DFT) 的约束自旋矩计算进行探测，其中总能量作为外加磁化强度的函数被计算。在磁化强度 $M = 0$ 的顺磁态附近，自旋反转对称性意味着自由能密度差 $\\Delta F(M)$ 可以表示为 $M$ 的偶次幂直至六阶的线性组合。在类 Stoner 模型中，接近铁磁不稳定性的程度由有效交换相互作用参数 $I$ 与费米能级处的电子态密度 $N(E_F)$ 的乘积决定，并且领先的二次项系数编码了因子 $1 - I\\,N(E_F)$，两者相差一个由能带结构细节决定的比例常数。您的任务是从 DFT 能量数据中提取有效系数，并将领先系数与 $1 - I\\,N(E_F)$ 关联起来。\n\n基本假设和定义：\n- 磁化强度 $M$ 以玻尔磁子/原子（$\\mu_B$/atom）为单位。\n- 能量差 $\\Delta E(M)$ 以毫电子伏特/原子（meV/atom）为单位，并以 $M=0$ 的能量为参考，即 $\\Delta E(0) = 0$。\n- $M=0$ 附近的自由能密度表示为基函数 $\\{M^2, M^4, M^6\\}$ 的线性组合，其未知系数将根据给定数据确定。\n- Stoner 判据取决于 $1 - I\\,N(E_F)$ 的符号，其中 $I$ 以电子伏特（eV）为单位，而 $N(E_F)$ 以 态/电子伏特/原子/自旋 为单位。\n\n从第一性原理出发，始于自由能在 $M \\mapsto -M$ 变换下的不变性、朗道展开中的序参量偶次幂概念以及巡游磁性的 Stoner 模型。推导必要的关系式以：\n1. 使用最小二乘法从 DFT 能量数据中拟合乘以 $M^2$、$M^4$ 和 $M^6$ 的系数。\n2. 确定使拟合的自由能表达式最小化的平衡磁化强度 $M_0$，包括存在铁磁性极小值（非零 $M_0$）的条件，并计算该极小值处的自由能差。\n3. 如果存在能量低于 $M=0$ 时的非零 $M_0$，则将每种情况分类为铁磁性，否则分类为顺磁性。\n4. 计算量 $1 - I\\,N(E_F)$ 以及一个由拟合的二次项系数与 $1 - I\\,N(E_F)$ 之比定义的有效比例常数。\n\n所有输出均使用上述指定单位表示。此问题不涉及角度。此问题不涉及百分比。\n\n您的程序必须为以下测试套件实现上述逻辑，该套件包含三个案例，分别探讨典型的铁磁情景、近临界情景和顺磁情景：\n\n- 测试用例 A：\n  - 磁化强度 $M$（单位 $\\mu_B$/atom）：$\\{0.0, 0.5, 1.0, 1.5, 2.0\\}$。\n  - 能量差 $\\Delta E(M)$（单位 meV/atom）：$\\{0.0, -6.84, -17.9, 6.10, 168.5\\}$。\n  - 交换参数 $I$（单位 eV）：$0.9$。\n  - 态密度 $N(E_F)$（单位 态/(eV·原子·自旋)）：$1.2$。\n\n- 测试用例 B：\n  - 磁化强度 $M$（单位 $\\mu_B$/atom）：$\\{0.0, 0.5, 1.0, 1.5\\}$。\n  - 能量差 $\\Delta E(M)$（单位 meV/atom）：$\\{0.0, 1.02, 12.1, 67.8\\}$。\n  - 交换参数 $I$（单位 eV）：$0.8$。\n  - 态密度 $N(E_F)$（单位 态/(eV·原子·自旋)）：$1.22$。\n\n- 测试用例 C：\n  - 磁化强度 $M$（单位 $\\mu_B$/atom）：$\\{0.0, 0.5, 1.0, 1.5\\}$。\n  - 能量差 $\\Delta E(M)$（单位 meV/atom）：$\\{0.0, 12.83, 55.9, 149.2\\}$。\n  - 交换参数 $I$（单位 eV）：$0.5$。\n  - 态密度 $N(E_F)$（单位 态/(eV·原子·自旋)）：$1.1$。\n\n计算要求：\n- 使用线性最小二乘法拟合乘以 $M^2$、$M^4$ 和 $M^6$ 的系数。\n- 通过求解拟合多项式的极值方程来确定非零驻点，并在存在时选择物理上的 $M_0 \\ge 0$ 的极小值。\n- 使用 $1 - I\\,N(E_F)$ 的符号来指示 Stoner 理论是否预测铁磁不稳定性，并将其与从拟合自由能获得的分类进行比较。\n\n最终输出规范：\n- 对于每个测试用例，按以下顺序输出包含八个条目的列表：\n  1. 拟合的二次项系数（单位 meV/atom per $\\mu_B^2$）。\n  2. 拟合的四次项系数（单位 meV/atom per $\\mu_B^4$）。\n  3. 拟合的六阶系数（单位 meV/atom per $\\mu_B^6$）。\n  4. 平衡磁化强度 $M_0$（单位 $\\mu_B$/atom），如果不存在铁磁极小值，则取 $M_0 = 0$。\n  5. $M_0$ 处的自由能差（单位 meV/atom）。\n  6. 一个整数指示符，如果 $1 - I\\,N(E_F) < 0$ 则等于 $1$，否则等于 $0$。\n  7. 一个整数指示符，如果拟合自由能的分类是铁磁性（非零 $M_0$ 且自由能低于 $M=0$ 时的值），则等于 $1$，否则等于 $0$。\n  8. 拟合的二次项系数与 $1 - I\\,N(E_F)$ 的比值（单位 meV/atom per $\\mu_B^2$），当分母为 $0$ 时，使用“非数值”表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表，例如：$[[\\dots],[\\dots],[\\dots]]$。不应打印其他文本或行。", "solution": "该问题要求在巡游铁磁性的 Stoner 模型和相变的 Landau 理论框架内，分析源自密度泛函理论 (DFT) 的自旋极化电子结构数据。核心任务是根据给定的能量-磁化强度数据拟合一个模型自由能函数，分析该函数的极小值以确定磁性基态，并将模型参数与 Stoner 理论中的量相关联。\n\n首先，我们建立关于磁化强度 $M$ 的自由能密度差 $\\Delta F(M)$ 的理论模型。问题指出，由于自旋反转对称性（能量在 $M \\mapsto -M$ 变换下不变），$\\Delta F(M)$ 在顺磁态 ($M=0$) 附近的展开仅包含 $M$ 的偶次幂。我们按照规定，将此展开截断至六阶：\n$$ \\Delta F(M) = A M^2 + B M^4 + C M^6 $$\n此处，$\\Delta F(M)$ 是相对于 $M=0$ 态的能量差，因此 $\\Delta F(0) = 0$，这与模型一致。系数 $A$、$B$ 和 $C$ 是待确定的材料特定参数。所提供的 DFT 数据点 $(\\Delta E_i, M_i)$ 被视为该函数的样本，其中 $\\Delta E \\equiv \\Delta F$。\n\n第一步是根据给定的数据集确定系数 $A$、$B$ 和 $C$。这是一个线性最小二乘问题。对于一组 $N$ 个数据点 $(M_i, \\Delta E_i)$（不包括平凡点 $(0, 0)$），我们寻求最小化残差平方和 $\\chi^2$：\n$$ \\chi^2 = \\sum_{i=1}^{N} \\left( \\Delta E_i - (A M_i^2 + B M_i^4 + C M_i^6) \\right)^2 $$\n这可以表示为矩阵形式。令 $\\mathbf{y}$ 为能量差向量 $[\\Delta E_1, \\dots, \\Delta E_N]^T$，$\\mathbf{c}$ 为未知系数向量 $[A, B, C]^T$，$\\mathbf{X}$ 为设计矩阵：\n$$\n\\mathbf{X} =\n\\begin{pmatrix}\nM_1^2  M_1^4  M_1^6 \\\\\nM_2^2  M_2^4  M_2^6 \\\\\n\\vdots  \\vdots  \\vdots \\\\\nM_N^2  M_N^4  M_N^6\n\\end{pmatrix}\n$$\n问题在于以最小二乘的方式求解线性系统 $\\mathbf{X} \\mathbf{c} = \\mathbf{y}$。解由正规方程 $\\mathbf{X}^T \\mathbf{X} \\mathbf{c} = \\mathbf{X}^T \\mathbf{y}$ 给出，从而得到 $\\mathbf{c} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$。这可以使用标准线性代数程序进行数值求解。\n\n其次，我们确定平衡磁化强度 $M_0$，它对应于拟合的自由能函数 $\\Delta F(M)$ 在 $M \\ge 0$ 范围内的全局最小值。通过将其对 $M$ 的导数设为零来找到 $\\Delta F(M)$ 的驻点：\n$$ \\frac{d(\\Delta F)}{dM} = 2AM + 4BM^3 + 6CM^5 = M(2A + 4BM^2 + 6CM^4) = 0 $$\n一个平凡解是 $M=0$，对应于顺磁态。非零解可从括号内的项求得，这是一个关于 $M^2$ 的二次方程。令 $x = M^2$，我们有：\n$$ 3Cx^2 + 2Bx + A = 0 $$\n$x = M^2$ 的解由二次公式给出：\n$$ x = M^2 = \\frac{-2B \\pm \\sqrt{(2B)^2 - 4(3C)(A)}}{2(3C)} = \\frac{-B \\pm \\sqrt{B^2 - 3AC}}{3C} $$\n为使解具有物理意义，$x = M^2$ 必须是正实数。对于每个这样的有效解 $x_j > 0$，我们找到一个候选磁化强度 $M_j = \\sqrt{x_j}$。要成为极小值，二阶导数必须为正：\n$$ \\frac{d^2(\\Delta F)}{dM^2} = 2A + 12BM^2 + 30CM^4 = 2A + 12Bx + 30Cx^2 > 0 $$\n通过比较所有稳定极小值（包括 $M=0$ 处的顺磁态，其中 $\\Delta F(0) = 0$）的能量值 $\\Delta F(M_j)$ 来确定基态。平衡磁化强度 $M_0$ 是对应于最低能量的 $M$ 值。如果 $M_0 > 0$ 且其对应的能量 $\\Delta F(M_0)$ 为负，则声明为铁磁基态。否则，基态是顺磁性的，我们设 $M_0 = 0$ 且 $\\Delta F(M_0) = 0$。\n\n第三，我们将我们的发现与巡游铁磁性的 Stoner 模型联系起来。铁磁不稳定性的 Stoner 判据是 $I \\cdot N(E_F) > 1$，其中 $I$ 是有效交换相互作用参数，$N(E_F)$ 是单个自旋通道在费米能级处的态密度。这等价于条件 $1 - I N(E_F)  0$。我们计算此值和一个指示符（如果为负则为1，否则为0）。问题陈述指出，朗道展开中的二次项系数 $A$ 与此量成正比：$A \\propto (1 - I N(E_F))$。这在微观参数 ($I, N(E_F)$) 和唯象朗道系数 ($A$) 之间建立了联系。因此，$A$ 的符号应指示磁稳定性：$A  0$ 意味着顺磁态不稳定，有利于铁磁性，这与 $1 - I N(E_F)  0$ 一致。我们计算比例常数作为比率 $A / (1 - I N(E_F))$。如果 $1 - I N(E_F) = 0$，则系统处于临界点，该比率未定义。\n\n最后，我们为每个测试用例组装八个所需的输出值：拟合的系数 $A, B, C$；平衡磁化强度 $M_0$ 及其能量 $\\Delta F(M_0)$；Stoner 判据满足情况的指示符；基于自由能分析的铁磁分类指示符；以及计算出的比例常数。所有单位将按照问题陈述中的规定处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the analysis for each case and prints the final results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A: Ferromagnetic\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5, 2.0],\n            \"E_data\": [0.0, -6.84, -17.9, 6.10, 168.5],\n            \"I\": 0.9,\n            \"N_ef\": 1.2\n        },\n        # Test Case B: Near-critical\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5],\n            \"E_data\": [0.0, 1.02, 12.1, 67.8],\n            \"I\": 0.8,\n            \"N_ef\": 1.22\n        },\n        # Test Case C: Paramagnetic\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5],\n            \"E_data\": [0.0, 12.83, 55.9, 149.2],\n            \"I\": 0.5,\n            \"N_ef\": 1.1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(case[\"M_data\"], case[\"E_data\"], case[\"I\"], case[\"N_ef\"])\n        results.append(result)\n\n    # Format the final output as a string representing a list of lists.\n    # Each inner list represents the results for one test case.\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef analyze_case(M_data, E_data, I, N_ef):\n    \"\"\"\n    Analyzes a single test case accordingto the problem description.\n    \n    Args:\n        M_data (list): List of magnetization points in mu_B/atom.\n        E_data (list): List of energy differences in meV/atom.\n        I (float): Exchange parameter in eV.\n        N_ef (float): Density of states in states/(eV atom spin).\n        \n    Returns:\n        list: A list of 8 result values for the case.\n    \"\"\"\n    \n    # 1. Fit coefficients A, B, C using linear least squares.\n    # We exclude the (0,0) point as it provides no information to the fit\n    # for the given model F(M) = AM^2 + BM^4 + CM^6.\n    M = np.array(M_data[1:])\n    E = np.array(E_data[1:])\n\n    # Construct the design matrix X for the linear system X*c = E\n    # where c = [A, B, C] are the coefficients to be found.\n    X = np.vstack([M**2, M**4, M**6]).T\n    \n    # Solve the least-squares problem\n    coeffs, _, _, _ = np.linalg.lstsq(X, E, rcond=None)\n    A, B, C = coeffs\n\n    # 2. Determine the equilibrium magnetization M0.\n    # Initialize ground state as paramagnetic.\n    M0 = 0.0\n    E0 = 0.0\n    \n    # Find non-zero stationary points by solving 3C*x^2 + 2B*x + A = 0 for x=M^2.\n    # We must handle the case where C is close to zero (or exactly zero).\n    if np.isclose(C, 0):\n        # The equation for M^2 becomes linear: 2B*x + A = 0\n        if not np.isclose(B, 0):\n            x = -A / (2 * B)\n            roots = [x] if x  0 else []\n        else: # B is also zero, no non-trivial solution\n            roots = []\n    else:\n        # Standard quadratic equation for x = M^2\n        discriminant = B**2 - 3 * A * C\n        if discriminant = 0:\n            sqrt_disc = np.sqrt(discriminant)\n            x1 = (-B + sqrt_disc) / (3 * C)\n            x2 = (-B - sqrt_disc) / (3 * C)\n            roots = [r for r in [x1, x2] if r  0]\n        else: # No real roots for M^2\n            roots = []\n\n    potential_minima = []\n    for x in roots:\n        # Second derivative test for a minimum\n        # d^2F/dM^2 = 2A + 12B*M^2 + 30C*M^4 = 2A + 12B*x + 30C*x^2\n        second_derivative = 2 * A + 12 * B * x + 30 * C * x**2\n        if second_derivative  0:\n            M_cand = np.sqrt(x)\n            E_cand = (A * x) + (B * x**2) + (C * x**3)\n            potential_minima.append((E_cand, M_cand))\n            \n    if potential_minima:\n        # Find the minimum with the lowest energy\n        best_E, best_M = min(potential_minima, key=lambda item: item[0])\n        \n        # A ferromagnetic ground state must have lower energy than the paramagnetic state (E=0)\n        if best_E  E0:\n            E0 = best_E\n            M0 = best_M\n\n    # 3. Classify and compute derived quantities.\n    \n    # Stoner criterion\n    stoner_factor = 1.0 - I * N_ef\n    stoner_indicator = 1 if stoner_factor  0 else 0\n    \n    # Ferromagnetic classification based on energy minimization\n    # M0  0 implies E0  0 from the logic above.\n    fm_indicator = 1 if M0  0 else 0\n    \n    # Proportionality constant k = A / (1 - I*N_ef)\n    if np.isclose(stoner_factor, 0):\n        ratio_val = 'nan'\n    else:\n        ratio_val = A / stoner_factor\n\n    return [A, B, C, M0, E0, stoner_indicator, fm_indicator, ratio_val]\n\nsolve()\n```", "id": "3489229"}]}