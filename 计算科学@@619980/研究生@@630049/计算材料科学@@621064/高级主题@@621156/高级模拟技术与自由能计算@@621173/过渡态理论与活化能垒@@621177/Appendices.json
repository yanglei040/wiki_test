{"hands_on_practices": [{"introduction": "本练习是理解过渡态理论的基础。通过一个解析的二维势能面，我们将运用微积分来定位势能面上的驻点（极小值点和鞍点）。这个过程将帮助你亲手确定连接反应物和产物路径上的过渡态，并计算活化能，从而巩固过渡态理论的核心几何概念。[@problem_id:3499288]", "problem": "一个与晶体材料中结构有序参数相关的二维势能面由函数 $$U(x,y)=a x^{2}-b y^{2}+c x^{4}+d y^{4}$$ 给出，其中 $x$ 和 $y$ 是以埃 ($\\mathrm{\\AA}$) 为单位的集体坐标，U 是以电子伏特 (eV) 为单位的能量。考虑参数集 $$a=0.30\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad c=0.20\\ \\mathrm{eV}/\\mathrm{\\AA}^{4},\\quad d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}.$$ 使用势能面上驻点（梯度为零）的第一性原理定义，并通过Hessian矩阵的特征值进行分类，确定所有驻点的位置和类型。然后，在过渡态理论 (TST) 的假设下，找出控制两个简并盆地之间最低能量路径的一阶鞍点，并计算活化能垒，其定义为该鞍点与能量较低的极小值点之间的能量差。将最终的能垒能量四舍五入到四位有效数字，并以电子伏特 (eV) 表示。", "solution": "用户希望我解决以下问题：\n一个与晶体材料中结构有序参数相关的二维势能面由函数 $$U(x,y)=a x^{2}-b y^{2}+c x^{4}+d y^{4},$$ 给出，其中 $x$ 和 $y$ 是以埃 ($\\mathrm{\\AA}$) 为单位的集体坐标，U 是以电子伏特 (eV) 为单位的能量。考虑参数集 $$a=0.30\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad c=0.20\\ \\mathrm{eV}/\\mathrm{\\AA}^{4},\\quad d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}.$$ 使用势能面上驻点（梯度为零）的第一性原理定义，并通过Hessian矩阵的特征值进行分类，确定所有驻点的位置和类型。然后，在过渡态理论 (TST) 的假设下，找出控制两个简并盆地之间最低能量路径的一阶鞍点，并计算活化能垒，其定义为该鞍点与能量较低的极小值点之间的能量差。将最终的能垒能量四舍五入到四位有效数字，并以电子伏特 (eV) 表示。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   势能面：$U(x,y)=a x^{2}-b y^{2}+c x^{4}+d y^{4}$。\n*   $x, y$ 是以埃 ($\\mathrm{\\AA}$) 为单位的坐标。\n*   $U$ 是以电子伏特 (eV) 为单位的能量。\n*   参数：$a=0.30\\ \\mathrm{eV}/\\mathrm{\\AA}^{2}$，$b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2}$，$c=0.20\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}$，$d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}$。\n*   任务 1：找到所有驻点，并通过其Hessian矩阵的特征值进行分类。\n*   任务 2：找出控制两个简并盆地之间最低能量路径的一阶鞍点。\n*   任务 3：计算活化能垒，其定义为控制鞍点与能量较低的极小值点之间的能量差。\n*   格式要求：将最终的能垒能量四舍五入到四位有效数字，并以 eV 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题基于对势能面 (PES) 的分析，这是物理化学、凝聚态物理和材料科学中的一个基本概念。使用多项式展开（类似于朗道展开）来表示势能面，寻找驻点（极小值点和鞍点），通过Hessian矩阵进行分类，以及应用过渡态理论 (TST) 寻找活化能垒，都是这些领域的标准、严谨的方法。所有单位都一致且具有物理意义。\n*   **适定性**：该问题提供了一个定义明确的数学函数和一套完整的参数。任务具体，能够导出一个唯一的、可计算的解。所提供的定义是标准的、明确的。\n*   **客观性**：该问题以精确、定量和无偏见的语言陈述。\n\n该问题科学上合理，内容自洽，适定且客观。它没有违反任何无效标准。因此，该问题是有效的。\n\n**步骤 3：结论与行动**\n\n该问题被判定为**有效**。将提供完整的解答。\n\n### 解答\n\n势能面由以下函数给出：\n$$U(x,y) = a x^{2} - b y^{2} + c x^{4} + d y^{4}$$\n\n**1. 寻找驻点**\n\n驻点是势能梯度 $\\nabla U$ 为零的位置 $(x, y)$。我们必须求解方程组 $\\frac{\\partial U}{\\partial x} = 0$ 和 $\\frac{\\partial U}{\\partial y} = 0$。\n\n首先，我们计算 $U(x,y)$ 的偏导数：\n$$\\frac{\\partial U}{\\partial x} = 2ax + 4cx^3 = 2x(a + 2cx^2)$$\n$$\\frac{\\partial U}{\\partial y} = -2by + 4dy^3 = 2y(-b + 2dy^2)$$\n\n将这些导数设为零：\n$1.$ $2x(a + 2cx^2) = 0$。当 $x=0$ 或 $a + 2cx^2 = 0$ 时，此方程成立。第二种情况意味着 $x^2 = -\\frac{a}{2c}$。由于给定的参数 $a = 0.30 > 0$ 和 $c = 0.20 > 0$，它们的比值 $-\\frac{a}{2c}$ 是负数。在这种情况下，$x$ 没有实数解。因此，唯一的实数解是 $x=0$。\n\n$2.$ $2y(-b + 2dy^2) = 0$。当 $y=0$ 或 $-b + 2dy^2 = 0$ 时，此方程成立。第二种情况意味着 $y^2 = \\frac{b}{2d}$，它有实数解 $y = \\pm\\sqrt{\\frac{b}{2d}}$。\n\n结合两个方程的解，我们得到以下驻点：\n*   点 $S_0$: $(x,y) = (0, 0)$\n*   点 $M_+$: $(x,y) = (0, \\sqrt{\\frac{b}{2d}})$\n*   点 $M_-$: $(x,y) = (0, -\\sqrt{\\frac{b}{2d}})$\n\n**2. 对驻点进行分类**\n\n为了对这些点进行分类，我们计算Hessian矩阵 $H$，其元素是 $U(x,y)$ 的二阶偏导数：\n$$H = \\begin{pmatrix} \\frac{\\partial^2 U}{\\partial x^2} & \\frac{\\partial^2 U}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 U}{\\partial y \\partial x} & \\frac{\\partial^2 U}{\\partial y^2} \\end{pmatrix}$$\n所需的二阶导数是：\n$$\\frac{\\partial^2 U}{\\partial x^2} = 2a + 12cx^2$$\n$$\\frac{\\partial^2 U}{\\partial y^2} = -2b + 12dy^2$$\n$$\\frac{\\partial^2 U}{\\partial x \\partial y} = \\frac{\\partial^2 U}{\\partial y \\partial x} = 0$$\n\n由于非对角元素为零，Hessian矩阵是一个对角矩阵。其特征值 $\\lambda_1$ 和 $\\lambda_2$ 就是其对角元素：$\\lambda_1 = 2a + 12cx^2$ 和 $\\lambda_2 = -2b + 12dy^2$。\n\n我们现在在每个驻点处计算这些特征值：\n\n*   **点 $S_0 = (0, 0)$：**\n    $\\lambda_1 = 2a + 12c(0)^2 = 2a$\n    $\\lambda_2 = -2b + 12d(0)^2 = -2b$\n    给定 $a > 0$ 和 $b > 0$，我们有 $\\lambda_1 > 0$ 和 $\\lambda_2 < 0$。一个特征值为正，一个为负的点是鞍点。鞍点的阶数是负特征值的数量，所以这是一个**一阶鞍点**。\n\n*   **点 $M_{\\pm} = (0, \\pm\\sqrt{\\frac{b}{2d}})$：**\n    对于这两个点，都有 $x=0$ 和 $y^2 = \\frac{b}{2d}$。\n    $\\lambda_1 = 2a + 12c(0)^2 = 2a$\n    $\\lambda_2 = -2b + 12d\\left(\\frac{b}{2d}\\right) = -2b + 6b = 4b$\n    给定 $a > 0$ 和 $b > 0$，我们有 $\\lambda_1 > 0$ 和 $\\lambda_2 > 0$。当两个特征值都为正时，该驻点是一个**局部极小值点**。\n\n**3. 计算活化能垒**\n\n问题描述了一个连接两个“简并盆地”的过程。这两个局部极小值点 $M_+$ 和 $M_-$ 构成了这些盆地。我们可以通过计算它们的势能 $U_{min}$ 来验证它们是简并的。\n在点 $M_{\\pm} = (0, \\pm\\sqrt{\\frac{b}{2d}})$ 处，我们有 $x=0$ 和 $y^2 = \\frac{b}{2d}$。\n$$U_{min} = a(0)^2 - b\\left(\\frac{b}{2d}\\right) + c(0)^4 + d\\left(\\frac{b}{2d}\\right)^2$$\n$$U_{min} = -\\frac{b^2}{2d} + d\\left(\\frac{b^2}{4d^2}\\right) = -\\frac{b^2}{2d} + \\frac{b^2}{4d} = -\\frac{2b^2}{4d} + \\frac{b^2}{4d} = -\\frac{b^2}{4d}$$\n由于 $M_+$ 和 $M_-$ 的能量相同，它们确实是简并的极小值点。\n\n这两个极小值点之间的最低能量路径必须通过连接它们的鞍点。我们只找到了一个鞍点 $S_0 = (0,0)$，它位于 $M_-$ 和 $M_+$ 之间沿 $y$ 轴的路径上。这是该转变的过渡态。其能量 $U_{saddle}$ 为：\n$$U_{saddle} = U(0,0) = a(0)^2 - b(0)^2 + c(0)^4 + d(0)^4 = 0$$\n\n活化能垒 $\\Delta E_{act}$ 定义为鞍点（过渡态）的能量与极小值点（反应物/产物态）的能量之差。\n$$\\Delta E_{act} = U_{saddle} - U_{min}$$\n$$\\Delta E_{act} = 0 - \\left(-\\frac{b^2}{4d}\\right) = \\frac{b^2}{4d}$$\n\n现在，我们代入给定的数值：$b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2}$ 和 $d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}$。\n$$\\Delta E_{act} = \\frac{(0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2})^2}{4 \\times (0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4})} = \\frac{0.81\\ \\mathrm{eV}^2/\\mathrm{\\AA}^{4}}{1.80\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}}$$\n$$\\Delta E_{act} = 0.45\\ \\mathrm{eV}$$\n\n问题要求答案四舍五入到四位有效数字。\n$$\\Delta E_{act} = 0.4500\\ \\mathrm{eV}$$", "answer": "$$\n\\boxed{0.4500}\n$$", "id": "3499288"}, {"introduction": "从抽象模型到真实材料，本练习将探讨面心立方（FCC）晶体中的空位扩散。我们将引入反应路径简并度的概念，这是过渡态理论指前因子中的一个关键组成部分。你将计算应变等外部因素如何破坏晶体对称性并改变扩散速率，从而架起理论与实际材料建模之间的桥梁。[@problem_id:3499324]", "problem": "您将执行一项基于过渡态理论 (TST) 的建模任务，研究面心立方晶体中的空位扩散。目标是基于对称性感知的扩散通道枚举，确定在理想、应变和成分无序条件下反应路径的简并因子。您的程序必须实现以下基于原理的定义，并为指定的测试套件计算所需的输出。\n\n假设与定义：\n- 考虑面心立方晶格上的空位扩散。在无应变的纯晶体中，最近邻跃迁沿着 $12$ 个晶体学等效的 $\\langle 110 \\rangle$ 方向进行。将这些方向表示为 $12$ 个单位向量 $\\{\\mathbf{d}_i\\}_{i=1}^{12}$ 的集合，这些向量是通过将所有按字典序排序的三元组 $(x,y,z)$ 除以 $\\sqrt{2}$ 进行归一化而构造的。这些三元组恰好包含一个零，另外两个分量等于 $\\pm 1$。字典序按 $x$、$y$、$z$ 的顺序升序排列，其中 $-1 \\lt 0 \\lt 1$，从而得到以下整数三元组的有序列表：\n  - $(-1,-1,0)$、$(-1,0,-1)$、$(-1,0,1)$、$(-1,1,0)$、$(0,-1,-1)$、$(0,-1,1)$、$(0,1,-1)$、$(0,1,1)$、$(1,-1,0)$、$(1,0,-1)$、$(1,0,1)$、$(1,1,0)$。\n  经 $\\sqrt{2}$ 归一化后，这些三元组定义了 $12$ 个单位方向 $\\mathbf{d}_i$。\n- 在小应变条件下，采用线性各向异性模型描述活化能。设通道 $i$ 的能垒为\n$$\nE_i \\;=\\; E_0 \\;+\\; \\gamma \\,\\mathbf{d}_i^{\\top}\\,\\varepsilon\\,\\mathbf{d}_i\n$$\n其中，$E_0$ 是无应变能垒，$\\gamma$ 是能量-应变耦合系数，$\\varepsilon$ 是小应变张量。所有能量都必须以电子伏特 (eV) 为单位处理。\n- 通过二元掩码 $\\{m_i\\}$ 引入成分无序或阻塞，其中 $m_i \\in \\{0,1\\}$ 表示通道 $i$ 是可用 ($m_i=1$) 还是阻塞 ($m_i=0$)。\n- 令 $k_{\\mathrm{B}}$ 表示 Boltzmann 常数，单位为电子伏特每开尔文。给定温度 $T$（单位为开尔文），定义 $\\beta = 1/(k_{\\mathrm{B}} T)$。\n\n基于第一性原理定义两种简并度量：\n1. 最低能垒组的严格简并度，\n$$\nn \\;=\\; \\sum_{i=1}^{12} m_i\\,\\Theta\\!\\left(\\tau - \\left|E_i - E_{\\min}\\right|\\right)\n$$\n其中 $E_{\\min} = \\min\\{E_i \\,:\\, m_i=1\\}$，$\\Theta(\\cdot)$ 是亥维赛阶跃函数 (Heaviside step function)，$\\tau$ 是用于判断相等性的小容差（使用 $\\tau = 10^{-9}$ eV）。在无应变的纯晶体情况下，该 $n$ 值简化为不可区分通道的对称简并计数。\n2. 热简并度或有效简并度，\n$$\nn_{\\mathrm{eff}} \\;=\\; \\sum_{i=1}^{12} m_i \\,\\exp\\!\\left[-\\,\\beta\\,(E_i - E_{\\min})\\right]\n$$\n该度量源于过渡态理论 (TST) 的速率和公式\n$\nk = \\sum_i m_i \\nu \\exp(-\\beta E_i)\n$\n（其中所有通道具有共同的尝试频率 $\\nu$），以及因式分解\n$\nk = \\nu \\, \\exp(-\\beta E_{\\min}) \\, n_{\\mathrm{eff}}.\n$\n在所有可用通道具有相同能垒的完全简并极限下，$n_{\\mathrm{eff}}$ 简化为 $n$，与经典的指前因子形式 $A = n \\nu$ 相联系。\n\n常数：\n- 所有情况均使用 $E_0 = 0.70$ eV 和 $\\gamma = 0.50$ eV。\n- 使用 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}$ eV/K。\n\n您的任务是实现一个程序，该程序能够：\n- 按规定生成 $12$ 个方向 $\\mathbf{d}_i$。\n- 对于每个测试用例，使用提供的 $\\varepsilon$、掩码和 $T$ 计算 $E_i$、$E_{\\min}$、$n$ 和 $n_{\\mathrm{eff}}$。\n- 生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。对于每个案例，按顺序输出两个数字：整数 $n$ 和浮点数 $n_{\\mathrm{eff}}$。将所有案例的这些数对连接成一个扁平列表。\n\n物理单位和数值细节：\n- 能量必须以电子伏特 (eV) 计算。\n- 温度以开尔文 (K) 为单位。\n- 能垒相等的容差为 $\\tau = 10^{-9}$ eV。\n- 不涉及角度计算。\n- 将 $n$ 作为整数输出，$n_{\\mathrm{eff}}$ 作为实数输出。输出中不包含单位。\n\n测试套件：\n- 案例 1（无应变，纯净）：\n  - $\\varepsilon = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$，对所有 $i$，$m_i = 1$，$T = 800$ K。\n- 案例 2（沿 $z$ 轴的单轴拉伸）：\n  - $\\varepsilon = \\operatorname{diag}(0, 0, 0.02)$，对所有 $i$，$m_i = 1$，$T = 800$ K。\n- 案例 3（面内双轴压缩及补偿性面外拉伸）：\n  - $\\varepsilon = \\operatorname{diag}(-0.015, -0.015, 0.03)$，对所有 $i$，$m_i = 1$，$T = 700$ K。\n- 案例 4（正交应变及成分阻塞）：\n  - $\\varepsilon = \\operatorname{diag}(0.01, -0.01, 0)$，$T = 300$ K，\n  - 掩码按上述 12 个整数三元组的字典序列出：\n    - $[1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该列表必须是四个案例的扁平化序列 $[n_1, n_{\\mathrm{eff},1}, n_2, n_{\\mathrm{eff},2}, n_3, n_{\\mathrm{eff},3}, n_4, n_{\\mathrm{eff},4}]$，顺序与上述测试套件一致。", "solution": "问题陈述经评估有效。\n\n**1. 已知条件提取**\n- **晶格与扩散：** 面心立方 (FCC) 晶格中通过最近邻跃迁进行的空位扩散。\n- **扩散方向：**12个晶体学等效的 $\\langle 110 \\rangle$ 方向，$\\{\\mathbf{d}_i\\}_{i=1}^{12}$。这些单位向量是通过将以下按字典序排序的整数三元组除以 $\\sqrt{2}$ 进行归一化得到的：\n  $(-1,-1,0)$、$(-1,0,-1)$、$(-1,0,1)$、$(-1,1,0)$、$(0,-1,-1)$、$(0,-1,1)$、$(0,1,-1)$、$(0,1,1)$、$(1,-1,0)$、$(1,0,-1)$、$(1,0,1)$、$(1,1,0)$。\n- **活化能模型：** $E_i = E_0 + \\gamma \\,\\mathbf{d}_i^{\\top}\\,\\varepsilon\\,\\mathbf{d}_i$。\n- **成分阻塞：** 一个二元掩码 $\\{m_i\\}$，其中 $m_i \\in \\{0,1\\}$，$m_i=1$ 表示通道 $i$ 可用，$m_i=0$ 表示阻塞。\n- **热能：** $\\beta = 1/(k_{\\mathrm{B}} T)$，其中 $T$ 是以开尔文为单位的温度。\n- **严格简并度 ($n$)：** $n = \\sum_{i=1}^{12} m_i\\,\\Theta(\\tau - |E_i - E_{\\min}|)$，其中 $E_{\\min} = \\min\\{E_i \\,:\\, m_i=1\\}$，$\\Theta(\\cdot)$ 是亥维赛阶跃函数 (Heaviside step function)。\n- **有效简并度 ($n_{\\mathrm{eff}}$)：** $n_{\\mathrm{eff}} = \\sum_{i=1}^{12} m_i \\,\\exp[-\\,\\beta\\,(E_i - E_{\\min})]$。\n- **常数：**\n  - $E_0 = 0.70$ eV\n  - $\\gamma = 0.50$ eV\n  - $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}$ eV/K\n  - $\\tau = 10^{-9}$ eV（能量相等的容差）\n- **测试套件：**\n  1. **案例 1：** $\\varepsilon = \\text{零矩阵}$，对所有 $i$，$m_i = 1$， $T = 800$ K。\n  2. **案例 2：** $\\varepsilon = \\operatorname{diag}(0, 0, 0.02)$，对所有 $i$，$m_i = 1$， $T = 800$ K。\n  3. **案例 3：** $\\varepsilon = \\operatorname{diag}(-0.015, -0.015, 0.03)$，对所有 $i$，$m_i = 1$， $T = 700$ K。\n  4. **案例 4：** $\\varepsilon = \\operatorname{diag}(0.01, -0.01, 0)$，$T = 300$ K，掩码 $m = [1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1]$。\n- **输出格式：** 一个扁平化列表，包含 $k=1,2,3,4$ 的 $[n_k, n_{\\mathrm{eff},k}]$ 对，形式为单个由方括号括起来的逗号分隔字符串。\n\n**2. 有效性验证**\n该问题具有科学依据，定义明确且客观。\n- **科学依据：** 该问题使用了固态物理学和材料科学中的既有概念，包括过渡态理论 (TST)、FCC 晶体中的空位扩散机制，以及弹性应变对活化能垒的影响（一个线性响应模型）。其表述是计算材料建模中常用的一种标准且具有物理意义的简化。\n- **适定性：** 所有必需的参数、常数和函数形式都已明确定义。每个测试用例的输入是完整的，输出（$n$ 和 $n_{\\mathrm{eff}}$）的计算公式是确定性的，确保了每个案例都存在唯一解。\n- **客观性与清晰度：** 问题使用精确的数学语言陈述。由于明确列出了整数三元组及其排序，方向向量 $\\mathbf{d}_i$ 的构造是明确无误的。所有术语都有清晰的定义。\n\n该问题没有任何无效性缺陷。它是一个有效的、可形式化的问题，适合通过计算求解。\n\n**3. 求解设计与实现**\n\n将通过对每个测试用例系统地应用所提供的定义来实现求解。\n\n**步骤 1：生成晶体学方向向量**\n首先，我们构造包含 $12$ 个扩散方向向量的集合 $\\{\\mathbf{d}_i\\}_{i=1}^{12}$。我们从提供的 $12$ 个整数三元组列表开始，这些三元组代表未归一化的方向。例如，第一个三元组是 $\\mathbf{v}_1 = (-1, -1, 0)$。这些向量的模长平方均为 $(-1)^2 + (-1)^2 + 0^2 = 2$ 或 $1^2+1^2+0^2=2$。通过将每个向量 $\\mathbf{v}_i$ 除以其模长 $\\sqrt{2}$ 进行归一化，得到对应的单位向量 $\\mathbf{d}_i$。这将产生一个固定的包含 $12$ 个向量的集合，并将其存储在一个数组中。指定的字典序对于在案例 4 中正确应用掩码至关重要。\n\n**步骤 2：计算活化能垒**\n对于每个测试用例，给定一个对称的 $3 \\times 3$ 应变张量 $\\varepsilon$。对于由 $i$ 索引的 $12$ 个扩散通道中的每一个，使用线性各向异性模型计算活化能 $E_i$：\n$$\nE_i \\;=\\; E_0 \\;+\\; \\gamma \\,\\mathbf{d}_i^{\\top}\\,\\varepsilon\\,\\mathbf{d}_i\n$$\n此处，$E_0=0.70$ eV 是无应变晶体中的活化能垒，$\\gamma=0.50$ eV 是耦合系数。项 $\\mathbf{d}_i^{\\top}\\,\\varepsilon\\,\\mathbf{d}_i$ 是一个二次型，它量化了应变场沿扩散路径方向 $\\mathbf{d}_i$ 所做的功。该计算将产生一组包含 $12$ 个能垒的值 $\\{E_i\\}_{i=1}^{12}$。\n\n**步骤 3：确定最低能垒和简并度量**\n对于给定的测试用例，一旦计算出能量集合 $\\{E_i\\}$，我们便开始计算简并因子 $n$ 和 $n_{\\mathrm{eff}}$。这需要掩码 $\\{m_i\\}$ 和温度 $T$。\n\n_a. 最低可用能垒, $E_{\\min}$_\n最低能垒 $E_{\\min}$ 定义为所有*可用*通道中的最低能量。我们将可用能量集合确定为 $\\{E_i \\mid m_i=1\\}$ 并找到其最小值。如果所有通道都被阻塞，$E_{\\min}$ 将是未定义的，但测试用例确保这种情况不会发生。\n\n_b. 严格简并度, $n$_\n严格简并度 $n$ 计算的是在给定的数值容差 $\\tau = 10^{-9}$ eV 内，其活化能垒等于 $E_{\\min}$ 的可用通道数量。计算遵循以下公式：\n$$\nn \\;=\\; \\sum_{i=1}^{12} m_i\\,\\Theta\\!\\left(\\tau - \\left|E_i - E_{\\min}\\right|\\right)\n$$\n这是通过遍历所有 $12$ 个通道来实现的。对于每个通道 $i$，我们检查它是否可用 ($m_i=1$) 并且其能量 $E_i$ 是否满足 $|E_i - E_{\\min}| \\le \\tau$。符合条件的通道总数即为 $n$。\n\n_c. 有效简并度, $n_{\\mathrm{eff}}$_\n有效简并度 $n_{\\mathrm{eff}}$ 是对所有可用路径的热加权计数，反映了它们在有限温度 $T$ 下对总扩散速率的相对贡献。首先，我们使用提供的 Boltzmann 常数 $k_{\\mathrm{B}}$ 计算逆热能 $\\beta = 1/(k_{\\mathrm{B}}T)$。然后，通过对所有通道求和来计算 $n_{\\mathrm{eff}}$：\n$$\nn_{\\mathrm{eff}} \\;=\\; \\sum_{i=1}^{12} m_i \\,\\exp\\!\\left[-\\,\\beta\\,(E_i - E_{\\min})\\right]\n$$\n对于每个可用通道（$m_i = 1$），我们计算其相对于最低能量路径的玻尔兹曼加权贡献。能量 $E_i > E_{\\min}$ 的通道贡献将小于 1，而能量 $E_i = E_{\\min}$ 的通道将每个贡献恰好为 1。\n\n**步骤 4：执行测试套件**\n上述计算步骤（2 和 3）被封装到一个例程中，该例程接受一个测试用例（包含 $\\varepsilon$、$\\{m_i\\}$ 和 $T$）作为输入，并返回数对 $(n, n_{\\mathrm{eff}})$。该例程对四个指定的测试用例分别执行。将得到的数对收集并扁平化为一个包含 8 个数字的列表，然后按要求格式化为最终的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates strict and effective degeneracy for vacancy diffusion\n    under various strain and compositional conditions.\n    \"\"\"\n    # Define constants as per the problem statement.\n    E0 = 0.70  # eV\n    GAMMA = 0.50  # eV\n    KB = 8.617333262145e-5  # eV/K\n    TAU = 1e-9  # eV\n\n    # Generate the 12 unnormalized 110> direction vectors in specified order.\n    integer_vectors = np.array([\n        [-1, -1, 0], [-1, 0, -1], [-1, 0, 1], [-1, 1, 0],\n        [0, -1, -1], [0, -1, 1], [0, 1, -1], [0, 1, 1],\n        [1, -1, 0], [1, 0, -1], [1, 0, 1], [1, 1, 0]\n    ])\n\n    # Normalize the vectors. Magnitude is sqrt(1^2 + 1^2 + 0^2) = sqrt(2).\n    d_vectors = integer_vectors / np.sqrt(2)\n\n    # Define the test suite.\n    test_cases = [\n        {\n            \"eps\": np.zeros((3, 3)),\n            \"mask\": np.ones(12, dtype=int),\n            \"T\": 800.0\n        },\n        {\n            \"eps\": np.diag([0.0, 0.0, 0.02]),\n            \"mask\": np.ones(12, dtype=int),\n            \"T\": 800.0\n        },\n        {\n            \"eps\": np.diag([-0.015, -0.015, 0.03]),\n            \"mask\": np.ones(12, dtype=int),\n            \"T\": 700.0\n        },\n        {\n            \"eps\": np.diag([0.01, -0.01, 0.0]),\n            \"mask\": np.array([1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1], dtype=int),\n            \"T\": 300.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        eps = case[\"eps\"]\n        mask = case[\"mask\"]\n        T = case[\"T\"]\n\n        # Step 2: Calculate Activation Barriers for all 12 channels\n        # This computes d_i^T @ eps @ d_i for all i\n        strain_energy_term = np.einsum('ij,jk,ik->i', d_vectors, eps, d_vectors)\n        energies = E0 + GAMMA * strain_energy_term\n\n        # Step 3a: Determine Minimum Available Barrier, E_min\n        # Filter energies by the mask to consider only available channels\n        available_energies = energies[mask == 1]\n        if len(available_energies) == 0:\n            # This case is not expected based on the problem description\n            # but is handled defensively.\n            results.extend([0, 0.0])\n            continue\n        \n        E_min = np.min(available_energies)\n\n        # Step 3b: Calculate Strict Degeneracy, n\n        is_min_energy = np.abs(energies - E_min) = TAU\n        is_available = mask == 1\n        n = np.sum(is_available  is_min_energy)\n        \n        # Step 3c: Calculate Effective Degeneracy, n_eff\n        beta = 1.0 / (KB * T)\n        delta_E = energies - E_min\n        # The term is exp(-beta * delta_E). Sum over available channels only.\n        n_eff = np.sum(mask * np.exp(-beta * delta_E))\n        \n        results.extend([int(n), n_eff])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.6f}' if isinstance(val, float) else str(val) for val in results)}]\")\n\nsolve()\n```", "id": "3499324"}, {"introduction": "标准的过渡态理论计算通常依赖于谐振子近似。这项高级练习旨在让你超越这一简化，将非谐效应纳入势能模型中。通过计算振动配分函数的变化以及由此产生的活化自由能垒，你将更深入地理解熵对反应速率的贡献以及谐振子模型的局限性。[@problem_id:3499291]", "problem": "要求您针对一个吸附物在二维材料上表面扩散的模型，将过渡态理论（TST）的经典谐振近似与非谐校正进行基准比较。重点是量化由于过渡态分割面上横向振动模式中的四次非谐性而导致的活化自由配分函数及相关自由能垒的偏差。\n\n考虑一个用于描述在二维晶格上扩散的经典、可分离的模型势能面，其坐标为 $x$（反应坐标）和 $y$（横向坐标）。反应物势阱被建模为一个谐振势阱，其势能为\n$$\nU_r(x,y) = \\tfrac{1}{2} k_x^{(r)} x^2 + \\tfrac{1}{2} k_y^{(r)} y^2\n$$\n其最低能量设为 $0$。过渡态（鞍点）位于 $x=0, y=0$ 处，其能量比反应物能量最低点高 $E_s = \\Delta E_0$。在过渡态分割面 $x=0$ 处，横向恢复势被建模为\n$$\nU^\\ddagger(y) = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4\n$$\n其中 $\\alpha \\ge 0$ 表征了四次非谐性的强度。在整个问题中，将 $x$ 视为鞍点处的不稳定坐标（从过渡态配分函数中排除），将 $y$ 视为稳定的横向坐标。\n\n在温度为 $T$ 的经典正则系综中进行计算，逆热能为 $\\beta = 1/(k_B T)$，其中 $k_B$ 是 Boltzmann 常数。对于此问题，使用由构型空间积分定义的构型正则配分函数\n$$\nZ_{\\mathrm{conf}, r} = \\iint_{\\mathbb{R}^2} \\exp\\!\\left[-\\beta \\, U_r(x,y)\\right] \\, dx \\, dy\n\\qquad\nZ_{\\mathrm{conf}, \\ddagger} = \\int_{\\mathbb{R}} \\exp\\!\\left[-\\beta \\, U^\\ddagger(y)\\right] \\, dy\n$$\n并将活化自由配分函数解释为 $Z^\\ddagger \\equiv Z_{\\mathrm{conf}, \\ddagger}$，即分割面上的受约束构型配分函数。谐振近似对应于在 $U^\\ddagger(y)$ 中设置 $\\alpha = 0$，而非谐模型则使用给定的 $\\alpha \\ge 0$。\n\n从经典正则配分函数和经典自由能 $F_{\\mathrm{conf}} = -k_B T \\ln Z_{\\mathrm{conf}}$ 的基本定义出发，完成以下任务：\n\n1. 在谐振极限 $\\alpha = 0$ 下，推导 $Z_{\\mathrm{conf}, r}$ 和 $Z_{\\mathrm{conf}, \\ddagger}$ 的解析表达式。然后，当 $\\alpha  0$ 时，推导一个可以通过一维数值积分计算的、$Z_{\\mathrm{conf}, \\ddagger}$ 的数值上易于处理的表达式。\n\n2. 使用这些定义，定义构型活化自由能垒\n$$\nE_{a,\\mathrm{har}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}}\\right)\n\\qquad\nE_{a,\\mathrm{anh}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}}\\right)\n$$\n以及活化自由配分函数的相对偏差\n$$\n\\delta Z^\\ddagger = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} - Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}\n$$\n注意，$E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = -k_B T \\ln\\!\\left(Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} / Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}\\right)$ 仅取决于过渡态的积分。\n\n3. 实现一个程序，对于下面测试套件中的每一组参数，计算两个输出：标量 $\\delta Z^\\ddagger$（无量纲，以小数表示）和标量 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$（单位为电子伏特）。所有数值积分都必须以足够的精度执行，以产生稳定的结果。\n\n物理单位和常数：\n- 能量单位使用电子伏特 (eV)，长度单位使用埃 (Å)，温度单位使用开尔文 (K)。\n- 使用 $k_B = 8.617333262145 \\times 10^{-5}$ eV/K。\n- 弹性常数 $k$ 的单位为 eV/Å$^2$，四次项系数 $\\alpha$ 的单位为 eV/Å$^4$。\n\n测试套件（每个案例是一个元组 $(T,\\; \\Delta E_0,\\; k_x^{(r)},\\; k_y^{(r)},\\; k_y^{(\\ddagger)},\\; \\alpha)$）：\n- 案例1（谐振参考）：$(300,\\; 0.45,\\; 0.7,\\; 0.9,\\; 0.8,\\; 0.0)$\n- 案例2（高温，中等非谐性）：$(1200,\\; 0.45,\\; 0.7,\\; 0.9,\\; 0.8,\\; 0.5)$\n- 案例3（强非谐性，较软的横向模式）：$(800,\\; 0.35,\\; 0.6,\\; 0.6,\\; 0.5,\\; 2.0)$\n- 案例4（低温，非零非谐性）：$(50,\\; 0.20,\\; 1.0,\\; 1.0,\\; 1.0,\\; 1.0)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。\n- 对于每个案例，按顺序输出两个数字：首先是 $\\delta Z^\\ddagger$（无量纲，以小数形式），然后是 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$（单位为 eV）。按给定顺序连接所有案例的结果。\n- 将每个浮点数结果四舍五入到恰好 $8$ 位小数。\n- 例如，输出格式必须形如\n  $$\n  [\\delta Z^\\ddagger_1,\\; \\Delta E_{a,1},\\; \\delta Z^\\ddagger_2,\\; \\Delta E_{a,2},\\; \\delta Z^\\ddagger_3,\\; \\Delta E_{a,3},\\; \\delta Z^\\ddagger_4,\\; \\Delta E_{a,4}]\n  $$\n  其中 $\\Delta E_{a,i} = E_{a,\\mathrm{anh}}(T_i) - E_{a,\\mathrm{har}}(T_i)$，单位为 eV。\n\n科学真实性和约束条件：\n- 假设对于所提供的温度，经典极限是有效的。\n- 确保 $\\alpha \\ge 0$，以使非谐积分是可归一化的。\n- 程序必须是完全自包含的，并且在没有用户输入的情况下执行所有计算。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。", "solution": "该问题要求基于经典过渡态理论（TST），量化一个表面扩散模型中非谐效应对活化自由能垒的影响。这包括推导经典构型配分函数的表达式，然后为指定的测试案例实现数值计算。\n\n对问题陈述的验证已确认其科学合理性、自洽性和良定性。该模型虽然简化，却是化学物理学中研究反应速率的标准且具有指导意义的工具。所有必要的参数和常数均已提供。因此，我们可以着手进行推导和求解。\n\n问题的核心是比较过渡态处横向振动模式的谐振近似与非谐模型。需要计算的量是过渡态配分函数的相对偏差 $\\delta Z^\\ddagger$ 和由此引起的活化自由能垒的变化量 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$。\n\n让我们首先推导配分函数的必要解析表达式。我们在逆温度为 $\\beta = 1/(k_B T)$ 的经典正则系综中进行计算。\n\n首先，考虑反应物态。势能由 $U_r(x,y) = \\tfrac{1}{2} k_x^{(r)} x^2 + \\tfrac{1}{2} k_y^{(r)} y^2$ 给出。经典构型配分函数 $Z_{\\mathrm{conf}, r}$ 是 Boltzmann 因子在所有可能构型 $(x,y)$ 上的积分：\n$$\nZ_{\\mathrm{conf}, r} = \\iint_{\\mathbb{R}^2} \\exp\\!\\left[-\\beta \\, U_r(x,y)\\right] \\, dx \\, dy = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_x^{(r)}}{2} x^2\\right) dx \\cdot \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_y^{(r)}}{2} y^2\\right) dy\n$$\n势能的可分离性使得二维积分可以表示为两个一维高斯积分的乘积。使用高斯积分的标准结果 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$，其中 $a_x = \\beta k_x^{(r)}/2$ 和 $a_y = \\beta k_y^{(r)}/2$，我们得到：\n$$\nZ_{\\mathrm{conf}, r} = \\sqrt{\\frac{2\\pi}{\\beta k_x^{(r)}}} \\cdot \\sqrt{\\frac{2\\pi}{\\beta k_y^{(r)}}} = \\frac{2\\pi}{\\beta \\sqrt{k_x^{(r)} k_y^{(r)}}}\n$$\n这是反应物构型配分函数的解析表达式。\n\n接下来，我们计算与过渡态分割面相关的配分函数 $Z_{\\mathrm{conf}, \\ddagger}$。它被定义为分割面（$x=0$）上稳定自由度的构型配分函数。该表面上的横向势为 $U^\\ddagger(y) = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4$。\n\n在谐振近似中，我们设置非谐系数 $\\alpha = 0$。势能变为 $U^\\ddagger(y)|_{\\alpha=0} = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2$。相应的谐振过渡态配分函数 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$ 为：\n$$\nZ_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_y^{(\\ddagger)}}{2} y^2\\right) dy\n$$\n这是另一个高斯积分，其中 $a = \\beta k_y^{(\\ddagger)}/2$。结果是：\n$$\nZ_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} = \\sqrt{\\frac{2\\pi}{\\beta k_y^{(\\ddagger)}}}\n$$\n这是过渡态处谐振配分函数的解析表达式。\n\n对于非谐情况（$\\alpha  0$），配分函数由以下积分给出：\n$$\nZ_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} = \\int_{-\\infty}^{\\infty} \\exp\\left[-\\beta \\left( \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4 \\right)\\right] dy\n$$\n该积分没有用初等函数表示的通用闭式解。然而，它是一个良态的一维积分，非常适合使用数值积分方法求解。被积函数是 $y$ 的对称（偶）函数，这意味着积分可以写成 $2 \\int_{0}^{\\infty} \\dots dy$，但现代数值积分器可以直接处理 $(-\\infty, \\infty)$ 区间。这种形式在数值上是易于处理的。\n\n我们被要求计算活化自由配分函数的相对偏差 $\\delta Z^\\ddagger$，其定义为：\n$$\n\\delta Z^\\ddagger = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} - Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}} = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}} - 1\n$$\n这需要解析计算 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$ 和数值计算 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}$，然后求它们的比值。\n\n第二个要计算的量是由于非谐性引起的活化自由能垒的变化，$E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$。使用所提供的定义：\n$$\nE_{a,\\mathrm{anh}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}}\\right)\n$$\n$$\nE_{a,\\mathrm{har}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}}\\right)\n$$\n差值为：\n$$\nE_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = \\left(\\Delta E_0 - k_B T \\ln\\!\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}}\\right) - \\left(\\Delta E_0 - k_B T \\ln\\!\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}}\\right)\n$$\n$$\n= -k_B T \\left( \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}} - \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}} \\right) = -k_B T \\ln\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} / Z_{\\mathrm{conf}, r}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} / Z_{\\mathrm{conf}, r}}\\right)\n$$\n$$\nE_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = -k_B T \\ln\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}\\right)\n$$\n正如问题陈述中正确指出的，这个差值仅取决于过渡态配分函数的比率。它可以方便地用 $\\delta Z^\\ddagger$ 表示：\n$$\nE_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = -k_B T \\ln\\left(1 + \\delta Z^\\ddagger\\right)\n$$\n这简化了计算，因为我们不需要计算 $Z_{\\mathrm{conf}, r}$，也不需要使用参数 $\\Delta E_0$、$k_x^{(r)}$ 和 $k_y^{(r)}$。\n\n对于 $\\alpha  0$，非谐项 $\\frac{1}{4}\\alpha y^4$ 对所有 $y \\ne 0$ 的势能都有正的贡献。与谐振情况相比，这导致 Boltzmann 因子 $\\exp(-\\beta U^\\ddagger(y))$ 的值更小。因此，积分 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}$ 将小于 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$。这意味着 $\\delta Z^\\ddagger$ 将为负值。结果，$\\ln(1+\\delta Z^\\ddagger)$ 将为负值，而能量差 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$ 将为正值，表明非谐性增加了自由能垒。\n\n每个测试案例的计算步骤如下：\n1. 计算 $\\beta = 1/(k_B T)$。\n2. 如果 $\\alpha=0$，则 $\\delta Z^\\ddagger$ 和能量差都恰好为 $0$。\n3. 如果 $\\alpha0$：\n    a. 计算 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} = \\sqrt{2\\pi / (\\beta k_y^{(\\ddagger)})}$。\n    b. 定义被积函数 $f(y) = \\exp[-\\beta (\\frac{1}{2} k_y^{(\\ddagger)} y^2 + \\frac{1}{4} \\alpha y^4)]$。\n    c. 使用积分程序数值计算 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} = \\int_{-\\infty}^{\\infty} f(y) dy$。\n    d. 计算 $\\delta Z^\\ddagger = Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} / Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} - 1$。\n    e. 计算能量差为 $-k_B T \\ln(1 + \\delta Z^\\ddagger)$。\n4. 按要求格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the deviation in the activation partition function and free energy\n    barrier due to quartic anharmonicity for a model of surface diffusion.\n    \"\"\"\n    \n    # Physical constant\n    # k_B in eV/K\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (T, Delta_E0, kx_r, ky_r, ky_ts, alpha)\n    # Units: T(K), Delta_E0(eV), k(eV/A^2), alpha(eV/A^4)\n    test_cases = [\n        (300, 0.45, 0.7, 0.9, 0.8, 0.0),   # Case 1 (harmonic reference)\n        (1200, 0.45, 0.7, 0.9, 0.8, 0.5),  # Case 2 (high T, moderate anharmonicity)\n        (800, 0.35, 0.6, 0.6, 0.5, 2.0),   # Case 3 (strong anharmonicity, soft mode)\n        (50, 0.20, 1.0, 1.0, 1.0, 1.0),    # Case 4 (low T, nonzero anharmonicity)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T, _, _, _, ky_ts, alpha = case\n        \n        # If alpha is zero, the model is purely harmonic.\n        # The anharmonic partition function equals the harmonic one.\n        # Thus, the deviation delta_Z and the energy difference are zero.\n        if alpha == 0.0:\n            delta_Z_val = 0.0\n            energy_diff_val = 0.0\n            results.extend([f\"{delta_Z_val:.8f}\", f\"{energy_diff_val:.8f}\"])\n            continue\n\n        # For alpha > 0, proceed with the full calculation.\n        \n        # Calculate inverse thermal energy beta in 1/eV\n        beta = 1.0 / (k_B * T)\n        \n        # 1. Calculate the harmonic partition function at the transition state (Z_har)\n        # Z_har = sqrt(2*pi / (beta * k))\n        Z_har = np.sqrt(2 * np.pi / (beta * ky_ts))\n        \n        # 2. Define the integrand for the anharmonic partition function (Z_anh)\n        # The integrand is the Boltzmann factor for the anharmonic potential.\n        def anharmonic_integrand(y, b, k, a):\n            exponent = -b * (0.5 * k * y**2 + 0.25 * a * y**4)\n            return np.exp(exponent)\n            \n        # 3. Numerically integrate to get the anharmonic partition function\n        # The integration is from -infinity to +infinity.\n        Z_anh, integral_error = quad(\n            anharmonic_integrand, -np.inf, np.inf, args=(beta, ky_ts, alpha)\n        )\n\n        # 4. Compute the relative deviation in the partition function (delta_Z)\n        # delta_Z = (Z_anh - Z_har) / Z_har\n        delta_Z_val = (Z_anh / Z_har) - 1.0\n        \n        # 5. Compute the difference in activation free energy (in eV)\n        # delta_Ea = E_anh - E_har = -k_B*T * ln(Z_anh / Z_har)\n        # This is equivalent to -k_B*T * ln(1 + delta_Z)\n        energy_diff_val = -k_B * T * np.log(1.0 + delta_Z_val)\n        \n        # Append formatted results to the list\n        results.extend([f\"{delta_Z_val:.8f}\", f\"{energy_diff_val:.8f}\"])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3499291"}]}