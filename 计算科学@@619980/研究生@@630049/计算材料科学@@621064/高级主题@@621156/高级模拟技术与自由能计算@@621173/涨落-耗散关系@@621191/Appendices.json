{"hands_on_practices": [{"introduction": "这项实践为我们提供了关键的理论基础。通过解析求解谐振子的朗之万方程，我们将能够明确地推导出粒子位置的涨落谱和其对外部作用力的响应函数。这个过程将使我们能够直接验证涨落-耗散定理，并深入理解共振现象与耗散之间的联系 [@problem_id:3452690]。", "problem": "考虑一个一维朗之万谐振子，该模型描述了一个与热浴耦合的粗粒化材料自由度的单一振动模式，其运动由以下随机微分方程决定\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t),\n$$\n其中 $m$ 是质量，$\\gamma$ 是粘性阻尼系数，$k$ 是弹簧常数，$\\xi(t)$ 是代表热涨落的平稳随机力。假设系统在温度 $T$ 下处于热平衡状态，并且 $\\xi(t)$ 是均值为零、自相关函数如下的高斯白噪声\n$$\n\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$\\langle\\cdot\\rangle$ 表示系综平均。定义傅里叶变换为 $x(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,x(t)$，并采用双边功率谱密度 (PSD) 约定 $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$，因此 $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$ 分别是 $x(t)$ 和 $v(t)=\\dot{x}(t)$ 的功率谱密度。引入一个与 $x(t)$ 共轭的弱外部探查力 $f(t)$，通过线性响应 $x(\\omega)=\\chi_{xx}(\\omega)\\,f(\\omega)$ 来定义因果线性响应函数 $\\chi_{xx}(\\omega)$。\n\n基于这些定义和朗之万动力学，完成以下任务：\n- 推导平稳功率谱密度 $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$ 的闭合解析表达式，用 $m$、$\\gamma$、$k$、$\\omega$、$k_{B}$ 和 $T$ 表示。\n- 确定响应函数 $\\chi_{xx}(\\omega)$ 的吸收部分 $\\chi''_{xx}(\\omega)$，并解释 $\\chi''_{xx}(\\omega)$ 的共振行为，包括在欠阻尼情况下其峰值频率和宽度如何依赖于 $m$、$\\gamma$ 和 $k$。\n- 根据上述约定，解释涨落耗散定理 (FDT) 如何将 $S_{xx}(\\omega)$ 和 $\\chi''_{xx}(\\omega)$联系起来，并明确您对 $\\chi''_{xx}(\\omega)$ 的符号约定。\n\n将您的最终答案以闭合形式的数对 $(S_{xx}(\\omega),\\,S_{vv}(\\omega))$ 给出。不需要进行数值计算，也无需在最终答案框中报告单位。", "solution": "该问题陈述已经过验证，被认为是统计物理学中一个有效、有科学依据且适定的问题。\n\n我们从一维谐振子的朗之万方程出发：\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t)\n$$\n其中 $\\xi(t)$ 是白噪声项，其均值为 $\\langle \\xi(t) \\rangle = 0$，自相关函数为 $\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t')$。\n\n我们首先推导功率谱密度 (PSD) $S_{xx}(\\omega)$ 和 $S_{vv}(\\omega)$。我们将傅里叶变换（定义为 $g(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,g(t)$）应用于朗之万方程。利用时间导数 $\\frac{d^n g(t)}{dt^n}$ 的傅里叶变换是 $(-i\\omega)^n g(\\omega)$ 的性质，我们得到：\n$$\n(m(-i\\omega)^2 + \\gamma(-i\\omega) + k)x(\\omega) = \\xi(\\omega)\n$$\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)x(\\omega) = \\xi(\\omega)\n$$\n求解 $x(\\omega)$，我们得到频域中位置与随机力之间的关系：\n$$\nx(\\omega) = \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma}\n$$\n接下来，我们确定随机力 $S_{\\xi\\xi}(\\omega)$ 的功率谱密度。问题通过关系 $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$ 定义了功率谱密度。我们计算傅里叶变换后的噪声的相关性：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,\\langle \\xi(t)\\,\\xi(t')\\rangle\n$$\n代入给定的 $\\xi(t)$ 的自相关函数：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,(2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'))\n$$\n$$\n= 2\\,\\gamma\\,k_{B}\\,T \\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(i(\\omega+\\omega')t)\n$$\n利用狄拉克δ函数的积分表示 $\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(iKt) = 2\\pi\\delta(K)$，我们得到：\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = 2\\,\\gamma\\,k_{B}\\,T\\,(2\\pi\\delta(\\omega+\\omega'))\n$$\n将其与定义 $\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{\\xi\\xi}(\\omega)$ 进行比较，我们确定噪声的功率谱密度为一个常数（这是白噪声的特征）：\n$$\nS_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T\n$$\n现在我们可以计算位置的功率谱密度 $S_{xx}(\\omega)$。我们计算相关性 $\\langle x(\\omega)x(\\omega') \\rangle$：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\left\\langle \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma} \\frac{\\xi(\\omega')}{k - m(\\omega')^2 - i\\omega'\\gamma} \\right\\rangle = \\frac{\\langle \\xi(\\omega)\\xi(\\omega') \\rangle}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\n代入 $\\langle \\xi(\\omega)\\xi(\\omega') \\rangle$ 的表达式：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\nδ函数 $\\delta(\\omega+\\omega')$ 强制要求 $\\omega' = -\\omega$。应用此约束条件：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(-\\omega)^2 - i(-\\omega)\\gamma)} = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m\\omega^2 + i\\omega\\gamma)}\n$$\n$$\n= \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n代入 $S_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T$：\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = 2\\pi\\delta(\\omega+\\omega') \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n根据定义 $\\langle x(\\omega)\\,x(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{xx}(\\omega)$，我们得到位置的功率谱密度：\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n为了求出速度的功率谱密度 $S_{vv}(\\omega)$，我们使用关系 $v(t)=\\dot{x}(t)$，在傅里叶空间中为 $v(\\omega) = -i\\omega x(\\omega)$。那么，\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = \\langle (-i\\omega x(\\omega))(-i\\omega' x(\\omega')) \\rangle = (-i)^2\\omega\\omega'\\langle x(\\omega)x(\\omega') \\rangle = -\\omega\\omega' \\langle x(\\omega)x(\\omega') \\rangle\n$$\n由于 $\\langle x(\\omega)x(\\omega') \\rangle$ 包含 $\\delta(\\omega+\\omega')$，我们可以用 $-\\omega$ 替换 $\\omega'$：\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = -\\omega(-\\omega) [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)] = \\omega^2 [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)]\n$$\n与定义 $\\langle v(\\omega)\\,v(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{vv}(\\omega)$ 进行比较，我们发现：\n$$\nS_{vv}(\\omega) = \\omega^2 S_{xx}(\\omega) = \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n这就完成了第一个任务。对于第二个任务，我们推导响应函数 $\\chi_{xx}(\\omega)$。我们在运动方程中加入一个弱的外部力 $f(t)$：\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t) + f(t)\n$$\n线性响应由系综平均 $\\langle x(t) \\rangle$ 描述，噪声项的平均值为零，即 $\\langle \\xi(t) \\rangle = 0$。平均响应的方程为：\n$$\nm\\,\\frac{d^2\\langle x(t) \\rangle}{dt^2}+\\gamma\\,\\frac{d\\langle x(t) \\rangle}{dt}+k\\,\\langle x(t) \\rangle = f(t)\n$$\n对此方程进行傅里叶变换得到：\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)\\langle x(\\omega) \\rangle = f(\\omega)\n$$\n响应函数 $\\chi_{xx}(\\omega)$ 由线性关系 $\\langle x(\\omega) \\rangle = \\chi_{xx}(\\omega) f(\\omega)$ 定义。因此，我们可以确定：\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - m\\omega^2 - i\\omega\\gamma}\n$$\n为了求出吸收（虚）部，我们将分子和分母同乘以分母的复共轭：\n$$\n\\chi_{xx}(\\omega) = \\frac{k - m\\omega^2 + i\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} = \\frac{k - m\\omega^2}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} + i \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n吸收部分是虚部，我们记作 $\\chi''_{xx}(\\omega)$。在我们的傅里叶变换约定下，耗散与正的虚部相关联。我们的结果是：\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n这是我的符号约定，对于 $\\omega0$ 和 $\\gamma0$，其值为正。\n在欠阻尼情况（$\\gamma \\ll 2\\sqrt{mk}$）下，$\\chi''_{xx}(\\omega)$ 表现出一个尖锐的共振峰。振子的固有频率是 $\\omega_0 = \\sqrt{k/m}$。分母 $m^2(\\omega_0^2-\\omega^2)^2 + \\gamma^2\\omega^2$ 在 $\\omega = \\omega_0$ 附近急剧变小。由于 $\\omega$ 因子的存在，$\\chi''_{xx}(\\omega)$ 的峰值并不完全在 $\\omega_0$ 处，但对于弱阻尼，它非常接近 $\\omega_0$。峰值频率 $\\omega_{res}$ 约等于 $\\omega_0 = \\sqrt{k/m}$。这个共振峰的宽度可以通过在 $\\omega_0$ 附近将线型近似为洛伦兹线型来分析。共振的半峰全宽 (FWHM) 被发现是 $\\Gamma = \\gamma/m$。因此，峰值频率取决于刚度 $k$ 和质量 $m$，而其宽度由阻尼 $\\gamma$ 和质量 $m$ 决定。\n\n最后，我们通过联系推导出的 $S_{xx}(\\omega)$ 和 $\\chi''_{xx}(\\omega)$ 来解释涨落耗散定理 (FDT)：\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n通过直接比较，我们可以看到一个简单的比例关系：\n$$\n\\frac{S_{xx}(\\omega)}{\\chi''_{xx}(\\omega)} = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\omega\\gamma} = \\frac{2\\,k_{B}\\,T}{\\omega}\n$$\n这给出了针对所选变量和约定的经典涨落耗散定理：\n$$\nS_{xx}(\\omega) = \\frac{2\\,k_{B}\\,T}{\\omega} \\chi''_{xx}(\\omega)\n$$\n该定理是统计物理学中的一个基本结果。它在两个看似不同的现象之间建立了一个定量的联系：系统在热平衡中的自发涨落（由功率谱密度 $S_{xx}(\\omega)$ 量化）和系统对微小外部扰动的耗散响应（由响应函数的吸收部分 $\\chi''_{xx}(\\omega)$ 量化）。这种联系的物理基础是，能量的耗散和热涨落都是自由度 $x$ 与热浴之间相互作用的相同潜在微观过程的表现。比例常数涉及温度 $T$，表明平衡涨落的幅度由热能标度 $k_B T$ 决定。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}  \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} \\end{pmatrix}}\n$$", "id": "3452690"}, {"introduction": "从理论转向实际应用，本练习将演示如何从分子动力学模拟中观测到的自发涨落来计算一个关键的材料属性——剪切模量。你将把基于涨落-耗散定理的公式应用于来自不同热力学系综（$NVT$、$NVE$ 和 $NPT$）的假设模拟数据，这突显了该方法在实际材料计算中的强大功能和灵活性 [@problem_id:3452662]。", "problem": "考虑一个由经典粒子通过对偶势相互作用建模的晶体固体，在不同的热力学系综下进行模拟。目标是利用涨落-耗散关系计算平衡剪切模量。\n\n假设微观维里表达式定义了瞬时剪切应力分量 $\\,\\sigma_{xy}(t)\\,$，并且剪切模量的仿射（Born）近似 $\\,G_{\\mathrm{Born}}\\,$ 是已知的。\n\n从以下基础出发：\n\n- 在固定粒子数-体积-温度（NVT）的正则系综中，配分函数和平衡统计平均表明，响应系数是亥姆霍兹（Helmholtz）自由能的二阶导数。固定体积下的剪切模量 $\\,G\\,$ 是自由能对剪切应变的二阶导数，而应力涨落的贡献通过涨落-耗散关系引入。\n\n- 对于经典系统，能量均分定理给出 $\\,\\langle K \\rangle = \\frac{N_{\\mathrm{dof}}}{2} k_B T\\,$，其中 $\\,\\langle K \\rangle\\,$ 是平均动能，$\\,N_{\\mathrm{dof}}\\,$ 是动力学自由度数，$\\,k_B\\,$ 是玻尔兹曼（Boltzmann）常数，$\\,T\\,$ 是热力学温度。\n\n- 对于在零外部剪切应力和各向同性恒压器下，固定粒子数-压强-温度（NPT）的等温等压系综，剪切应变 $\\,\\gamma\\,$ 围绕零点涨落，其方差通过涨落-耗散关系与剪切柔量相关联。\n\n定义和单位要求：\n\n- 使用 $\\,k_B = 1.380\\,649\\times 10^{-23}\\,\\mathrm{J/K}\\,$.\n\n- 剪切模量 $\\,G\\,$ 必须以帕斯卡（Pa）表示。\n\n- 瞬时剪切应力 $\\,\\sigma_{xy}\\,$ 的单位是帕斯卡，体积 $\\,V\\,$ 的单位是立方米 $\\,\\mathrm{m}^3\\,$，温度 $\\,T\\,$ 的单位是开尔文（K），动能 $\\,K\\,$ 的单位是焦耳（J），剪切应变 $\\,\\gamma\\,$ 是无量纲的。\n\n目标计算：\n\n1. 对于固定的粒子数-体积-温度（NVT），使用应力涨落公式\n   $$G = G_{\\mathrm{Born}} - \\frac{V}{k_B T} \\left\\langle \\delta \\sigma_{xy}^2 \\right\\rangle,$$\n   其中 $\\,\\langle \\delta \\sigma_{xy}^2 \\rangle\\,$ 是剪切应力涨落的方差，通过从时间序列中减去其样本均值并使用无偏样本方差来计算。\n\n2. 对于固定的粒子数-体积-能量（NVE），通过能量均分定理从动能时间序列估计 $\\,T\\,$，\n   $$T_{\\mathrm{est}} = \\frac{2 \\langle K \\rangle}{N_{\\mathrm{dof}} k_B},$$\n   然后使用与NVT情况相同的应力涨落公式，其中 $\\,T = T_{\\mathrm{est}}\\,$。\n\n3. 对于零外部剪切应力下固定的粒子数-压强-温度（NPT），使用应变涨落公式计算剪切模量，\n   $$G = \\frac{k_B T}{V \\left\\langle \\gamma^2 \\right\\rangle},$$\n   其中 $\\,\\langle \\gamma^2 \\rangle\\,$ 是 $\\,\\gamma\\,$ 的无偏样本方差。\n\n您的程序必须使用以下测试套件实现上述计算。对于每种情况，计算以帕斯卡为单位的 $\\,G\\,$，并按指定的最终输出格式汇总结果。\n\n带参数的测试套件：\n\n- 情况 $\\,1\\,$（NVT，一般情况）：\n  - $\\,V = 1.0\\times 10^{-24}\\,\\mathrm{m}^3\\,$\n  - $\\,T = 300\\,$\n  - $\\,G_{\\mathrm{Born}} = 3.0\\times 10^{10}\\,$\n  - $\\,\\sigma_{xy}(t)$ 序列 (Pa): $[\\,2.10\\times 10^{5},\\,-1.75\\times 10^{5},\\,2.95\\times 10^{5},\\,-2.60\\times 10^{5},\\,1.20\\times 10^{5},\\,-0.85\\times 10^{5},\\,3.30\\times 10^{5},\\,-2.10\\times 10^{5},\\,2.45\\times 10^{5},\\,-1.95\\times 10^{5},\\,2.70\\times 10^{5},\\,-2.40\\times 10^{5}\\,]$\n\n- 情况 $\\,2\\,$（NVE，从动能估计温度）：\n  - $\\,V = 1.0\\times 10^{-24}\\,\\mathrm{m}^3\\,$\n  - $\\,N_{\\mathrm{dof}} = 300\\,$\n  - $\\,G_{\\mathrm{Born}} = 3.0\\times 10^{10}\\,$\n  - $\\,\\sigma_{xy}(t)$ 序列 (Pa): $[\\,1.80\\times 10^{5},\\,-2.20\\times 10^{5},\\,2.50\\times 10^{5},\\,-2.80\\times 10^{5},\\,1.50\\times 10^{5},\\,-1.10\\times 10^{5},\\,3.00\\times 10^{5},\\,-2.50\\times 10^{5},\\,2.10\\times 10^{5},\\,-2.00\\times 10^{5}\\,]$\n  - $\\,K(t)$ 序列 (J): $[\\,6.30\\times 10^{-19},\\,6.10\\times 10^{-19},\\,6.25\\times 10^{-19},\\,6.18\\times 10^{-19},\\,6.35\\times 10^{-19},\\,6.05\\times 10^{-19},\\,6.22\\times 10^{-19},\\,6.29\\times 10^{-19},\\,6.15\\times 10^{-19},\\,6.27\\times 10^{-19}\\,]$\n\n- 情况 $\\,3\\,$（NPT，零剪切应力下的应变涨落）：\n  - $\\,V = 1.0\\times 10^{-24}\\,\\mathrm{m}^3\\,$\n  - $\\,T = 300\\,$\n  - $\\,\\gamma(t)$ 序列 (无量纲): $[\\,4.1\\times 10^{-4},\\,-3.8\\times 10^{-4},\\,5.0\\times 10^{-4},\\,-4.7\\times 10^{-4},\\,2.0\\times 10^{-4},\\,-1.5\\times 10^{-4},\\,4.6\\times 10^{-4},\\,-4.2\\times 10^{-4},\\,3.3\\times 10^{-4},\\,-3.1\\times 10^{-4},\\,4.9\\times 10^{-4},\\,-4.8\\times 10^{-4}\\,]$\n\n- 情况 $\\,4\\,$（NVT，应力近似恒定的边界情况）：\n  - $\\,V = 1.0\\times 10^{-24}\\,\\mathrm{m}^3\\,$\n  - $\\,T = 300\\,$\n  - $\\,G_{\\mathrm{Born}} = 3.0\\times 10^{10}\\,$\n  - $\\,\\sigma_{xy}(t)$ 序列 (Pa): $[\\,1.0\\times 10^{3},\\,1.2\\times 10^{3},\\,0.8\\times 10^{3},\\,1.1\\times 10^{3},\\,0.9\\times 10^{3},\\,1.0\\times 10^{3}\\,]$\n\n- 情况 $\\,5\\,$（NPT，大应变涨落的边缘情况）：\n  - $\\,V = 1.0\\times 10^{-24}\\,\\mathrm{m}^3\\,$\n  - $\\,T = 300\\,$\n  - $\\,\\gamma(t)$ 序列 (无量纲): $[\\,2.5\\times 10^{-3},\\,-2.8\\times 10^{-3},\\,3.1\\times 10^{-3},\\,-3.0\\times 10^{-3},\\,2.6\\times 10^{-3},\\,-2.9\\times 10^{-3},\\,3.2\\times 10^{-3},\\,-3.3\\times 10^{-3},\\,2.4\\times 10^{-3},\\,-2.7\\times 10^{-3}\\,]$\n\n算法要求：\n\n- 对于任何涨落估计，使用无偏样本方差，即对于长度为 $\\,n\\,$ 的序列，除以 $\\,n-1\\,$。\n\n- 对于NVE，使用能量均分公式根据动能序列和 $\\,N_{\\mathrm{dof}}\\,$ 计算 $\\,T_{\\mathrm{est}}\\,$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含五个案例的剪切模量结果，形式为方括号内以逗号分隔的列表（例如，$[G_1,G_2,G_3,G_4,G_5]$），其中每个 $\\,G_i\\,$ 是以帕斯卡为单位的浮点数。", "solution": "该问题是有效的，因为它在科学上基于统计力学原理，特别是应用于计算材料科学的涨落-耗散定理。所提供的用于在不同热力学系综（NVT、NVE、NPT）下从模拟中计算剪切模量的公式是标准且正确的。所有数据、常数和条件都已明确给出，在物理上和量纲上都是一致的，并且问题是适定的，对于每个测试用例都有一个唯一的、可验证的解。\n\n求解过程是对五个测试用例中的每一个，应用指定的公式和所提供的数据。计算的核心涉及计算应力或应变时间序列数据的无偏样本方差，以及在NVE情况下，根据动能估计温度。\n\n对于一个包含 $n$ 个数据点 $\\{x_1, x_2, \\dots, x_n\\}$ 的时间序列，其无偏样本方差 $s^2$ 使用以下公式计算：\n$$s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2$$\n其中 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$ 是样本均值。\n\n常数 $k_B$ 给出为 $1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。对于所有温度 $T$ 固定为 $300\\,\\mathrm{K}$ 的情况，热能为 $k_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (300\\,\\mathrm{K}) = 4.141947 \\times 10^{-21}\\,\\mathrm{J}$。\n\n### 情况 $1$：NVT 系综\n\n对于这种情况，我们使用应力涨落公式：\n$$G = G_{\\mathrm{Born}} - \\frac{V}{k_B T} \\left\\langle \\delta \\sigma_{xy}^2 \\right\\rangle$$\n问题规定 $\\left\\langle \\delta \\sigma_{xy}^2 \\right\\rangle$ 是剪切应力的无偏样本方差，我们将其表示为 $s_{\\sigma_{xy}}^2$。\n\n给定参数：\n- $V = 1.0 \\times 10^{-24}\\,\\mathrm{m}^3$\n- $T = 300\\,\\mathrm{K}$\n- $G_{\\mathrm{Born}} = 3.0 \\times 10^{10}\\,\\mathrm{Pa}$\n- $\\sigma_{xy}(t)$ 序列 (单位 Pa): $[\\,2.10 \\times 10^{5},\\,-1.75 \\times 10^{5},\\,2.95 \\times 10^{5},\\,-2.60 \\times 10^{5},\\,1.20 \\times 10^{5},\\,-0.85 \\times 10^{5},\\,3.30 \\times 10^{5},\\,-2.10 \\times 10^{5},\\,2.45 \\times 10^{5},\\,-1.95 \\times 10^{5},\\,2.70 \\times 10^{5},\\,-2.40 \\times 10^{5}\\,]$\n\n数据点数量为 $n=12$。\n$1$. 计算 $\\sigma_{xy}$ 序列的无偏样本方差 $s_{\\sigma_{xy}}^2$。\n计算得出 $s_{\\sigma_{xy}}^2 \\approx 5.48636 \\times 10^{11}\\,\\mathrm{Pa}^2$。\n$2$. 计算涨落项 $\\Delta G = \\frac{V}{k_B T} s_{\\sigma_{xy}}^2$。\n$$\\Delta G = \\frac{1.0 \\times 10^{-24}\\,\\mathrm{m}^3}{4.141947 \\times 10^{-21}\\,\\mathrm{J}} \\times (5.48636 \\times 10^{11}\\,\\mathrm{Pa}^2) \\approx 1.32461 \\times 10^{8}\\,\\mathrm{Pa}$$\n$3$. 计算剪切模量 $G$。\n$$G_1 = G_{\\mathrm{Born}} - \\Delta G = 3.0 \\times 10^{10}\\,\\mathrm{Pa} - 1.32461 \\times 10^{8}\\,\\mathrm{Pa} \\approx 2.98675 \\times 10^{10}\\,\\mathrm{Pa}$$\n\n### 情况 $2$：NVE 系综\n\n对于这种情况，我们首先估计温度 $T_{\\mathrm{est}}$，然后使用与NVT情况相同的应力涨落公式。\n\n给定参数：\n- $V = 1.0 \\times 10^{-24}\\,\\mathrm{m}^3$\n- $N_{\\mathrm{dof}} = 300$\n- $G_{\\mathrm{Born}} = 3.0 \\times 10^{10}\\,\\mathrm{Pa}$\n- $\\sigma_{xy}(t)$ 序列 (单位 Pa): $[\\,1.80 \\times 10^{5},\\,-2.20 \\times 10^{5},\\,2.50 \\times 10^{5},\\,-2.80 \\times 10^{5},\\,1.50 \\times 10^{5},\\,-1.10 \\times 10^{5},\\,3.00 \\times 10^{5},\\,-2.50 \\times 10^{5},\\,2.10 \\times 10^{5},\\,-2.00 \\times 10^{5}\\,]$\n- $K(t)$ 序列 (单位 J): $[\\,6.30 \\times 10^{-19},\\,6.10 \\times 10^{-19},\\,6.25 \\times 10^{-19},\\,6.18 \\times 10^{-19},\\,6.35 \\times 10^{-19},\\,6.05 \\times 10^{-19},\\,6.22 \\times 10^{-19},\\,6.29 \\times 10^{-19},\\,6.15 \\times 10^{-19},\\,6.27 \\times 10^{-19}\\,]$\n\n$1$. 估计温度 $T_{\\mathrm{est}} = \\frac{2 \\langle K \\rangle}{N_{\\mathrm{dof}} k_B}$。\n平均动能为 $\\langle K \\rangle = 6.216 \\times 10^{-19}\\,\\mathrm{J}$。\n$$T_{\\mathrm{est}} = \\frac{2 \\times (6.216 \\times 10^{-19}\\,\\mathrm{J})}{300 \\times (1.380649 \\times 10^{-23}\\,\\mathrm{J/K})} \\approx 300.174\\,\\mathrm{K}$$\n热能项为 $k_B T_{\\mathrm{est}} = 4.144 \\times 10^{-21}\\,\\mathrm{J}$。\n$2$. 计算 $\\sigma_{xy}$ 序列的无偏样本方差 $s_{\\sigma_{xy}}^2$。\n计算得出 $s_{\\sigma_{xy}}^2 \\approx 5.84544 \\times 10^{11}\\,\\mathrm{Pa}^2$。\n$3$. 计算涨落项 $\\Delta G = \\frac{V}{k_B T_{\\mathrm{est}}} s_{\\sigma_{xy}}^2$。\n$$\\Delta G = \\frac{1.0 \\times 10^{-24}\\,\\mathrm{m}^3}{4.144 \\times 10^{-21}\\,\\mathrm{J}} \\times (5.84544 \\times 10^{11}\\,\\mathrm{Pa}^2) \\approx 1.41058 \\times 10^{8}\\,\\mathrm{Pa}$$\n$4$. 计算剪切模量 $G$。\n$$G_2 = G_{\\mathrm{Born}} - \\Delta G = 3.0 \\times 10^{10}\\,\\mathrm{Pa} - 1.41058 \\times 10^{8}\\,\\mathrm{Pa} \\approx 2.98589 \\times 10^{10}\\,\\mathrm{Pa}$$\n\n### 情况 $3$：NPT 系综\n\n对于这种情况，我们使用应变涨落公式：\n$$G = \\frac{k_B T}{V \\left\\langle \\gamma^2 \\right\\rangle}$$\n问题规定 $\\left\\langle \\gamma^2 \\right\\rangle$ 是剪切应变的无偏样本方差，我们将其表示为 $s_{\\gamma}^2$。\n\n给定参数：\n- $V = 1.0 \\times 10^{-24}\\,\\mathrm{m}^3$\n- $T = 300\\,\\mathrm{K}$\n- $\\gamma(t)$ 序列 (无量纲): $[\\,4.1 \\times 10^{-4},\\,-3.8 \\times 10^{-4},\\,5.0 \\times 10^{-4},\\,-4.7 \\times 10^{-4},\\,2.0 \\times 10^{-4},\\,-1.5 \\times 10^{-4},\\,4.6 \\times 10^{-4},\\,-4.2 \\times 10^{-4},\\,3.3 \\times 10^{-4},\\,-3.1 \\times 10^{-4},\\,4.9 \\times 10^{-4},\\,-4.8 \\times 10^{-4}\\,]$\n\n$1$. 计算 $\\gamma$ 序列的无偏样本方差 $s_{\\gamma}^2$。\n计算得出 $s_{\\gamma}^2 \\approx 1.63758 \\times 10^{-7}$。\n$2$. 计算剪切模量 $G$。\n$$G_3 = \\frac{k_B T}{V s_{\\gamma}^2} = \\frac{4.141947 \\times 10^{-21}\\,\\mathrm{J}}{(1.0 \\times 10^{-24}\\,\\mathrm{m}^3) \\times (1.63758 \\times 10^{-7})} \\approx 2.52932 \\times 10^{10}\\,\\mathrm{Pa}$$\n\n### 情况 $4$：NVT 系综，边界情况\n\n此情况在方法上与情况1相同，只是使用了不同的应力序列。\n\n给定参数：\n- $V = 1.0 \\times 10^{-24}\\,\\mathrm{m}^3$\n- $T = 300\\,\\mathrm{K}$\n- $G_{\\mathrm{Born}} = 3.0 \\times 10^{10}\\,\\mathrm{Pa}$\n- $\\sigma_{xy}(t)$ 序列 (单位 Pa): $[\\,1.0 \\times 10^{3},\\,1.2 \\times 10^{3},\\,0.8 \\times 10^{3},\\,1.1 \\times 10^{3},\\,0.9 \\times 10^{3},\\,1.0 \\times 10^{3}\\,]$\n\n$1$. 计算 $\\sigma_{xy}$ 序列的无偏样本方差 $s_{\\sigma_{xy}}^2$。\n计算得出 $s_{\\sigma_{xy}}^2 = 20000\\,\\mathrm{Pa}^2$。\n$2$. 计算涨落项 $\\Delta G = \\frac{V}{k_B T} s_{\\sigma_{xy}}^2$。\n$$\\Delta G = \\frac{1.0 \\times 10^{-24}\\,\\mathrm{m}^3}{4.141947 \\times 10^{-21}\\,\\mathrm{J}} \\times (20000\\,\\mathrm{Pa}^2) \\approx 4828.6\\,\\mathrm{Pa}$$\n$3$. 计算剪切模量 $G$。\n$$G_4 = G_{\\mathrm{Born}} - \\Delta G = 3.0 \\times 10^{10}\\,\\mathrm{Pa} - 4828.6\\,\\mathrm{Pa} \\approx 2.999999517 \\times 10^{10}\\,\\mathrm{Pa}$$\n\n### 情况 $5$：NPT 系综，边缘情况\n\n此情况在方法上与情况3相同，只是使用了不同的应变序列。\n\n给定参数：\n- $V = 1.0 \\times 10^{-24}\\,\\mathrm{m}^3$\n- $T = 300\\,\\mathrm{K}$\n- $\\gamma(t)$ 序列 (无量纲): $[\\,2.5 \\times 10^{-3},\\,-2.8 \\times 10^{-3},\\,3.1 \\times 10^{-3},\\,-3.0 \\times 10^{-3},\\,2.6 \\times 10^{-3},\\,-2.9 \\times 10^{-3},\\,3.2 \\times 10^{-3},\\,-3.3 \\times 10^{-3},\\,2.4 \\times 10^{-3},\\,-2.7 \\times 10^{-3}\\,]$\n\n$1$. 计算 $\\gamma$ 序列的无偏样本方差 $s_{\\gamma}^2$。\n计算得出 $s_{\\gamma}^2 \\approx 8.78778 \\times 10^{-6}$。\n$2$. 计算剪切模量 $G$。\n$$G_5 = \\frac{k_B T}{V s_{\\gamma}^2} = \\frac{4.141947 \\times 10^{-21}\\,\\mathrm{J}}{(1.0 \\times 10^{-24}\\,\\mathrm{m}^3) \\times (8.78778 \\times 10^{-6})} \\approx 4.71330 \\times 10^{8}\\,\\mathrm{Pa}$$\n\n这些计算通过编程方式执行，以获得最终的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear modulus for different thermodynamic ensembles using\n    fluctuation-dissipation relations.\n    \"\"\"\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    test_cases = [\n        {\n            \"case\": 1, \"ensemble\": \"NVT\", \"V\": 1.0e-24, \"T\": 300.0,\n            \"G_Born\": 3.0e10,\n            \"sigma_xy\": np.array([2.10e5, -1.75e5, 2.95e5, -2.60e5, 1.20e5, -0.85e5,\n                                  3.30e5, -2.10e5, 2.45e5, -1.95e5, 2.70e5, -2.40e5])\n        },\n        {\n            \"case\": 2, \"ensemble\": \"NVE\", \"V\": 1.0e-24, \"N_dof\": 300,\n            \"G_Born\": 3.0e10,\n            \"sigma_xy\": np.array([1.80e5, -2.20e5, 2.50e5, -2.80e5, 1.50e5, -1.10e5,\n                                  3.00e5, -2.50e5, 2.10e5, -2.00e5]),\n            \"K\": np.array([6.30e-19, 6.10e-19, 6.25e-19, 6.18e-19, 6.35e-19,\n                           6.05e-19, 6.22e-19, 6.29e-19, 6.15e-19, 6.27e-19])\n        },\n        {\n            \"case\": 3, \"ensemble\": \"NPT\", \"V\": 1.0e-24, \"T\": 300.0,\n            \"gamma\": np.array([4.1e-4, -3.8e-4, 5.0e-4, -4.7e-4, 2.0e-4, -1.5e-4,\n                               4.6e-4, -4.2e-4, 3.3e-4, -3.1e-4, 4.9e-4, -4.8e-4])\n        },\n        {\n            \"case\": 4, \"ensemble\": \"NVT\", \"V\": 1.0e-24, \"T\": 300.0,\n            \"G_Born\": 3.0e10,\n            \"sigma_xy\": np.array([1.0e3, 1.2e3, 0.8e3, 1.1e3, 0.9e3, 1.0e3])\n        },\n        {\n            \"case\": 5, \"ensemble\": \"NPT\", \"V\": 1.0e-24, \"T\": 300.0,\n            \"gamma\": np.array([2.5e-3, -2.8e-3, 3.1e-3, -3.0e-3, 2.6e-3, -2.9e-3,\n                               3.2e-3, -3.3e-3, 2.4e-3, -2.7e-3])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        V = case[\"V\"]\n        G = 0.0\n\n        if case[\"ensemble\"] == \"NVT\":\n            T = case[\"T\"]\n            G_Born = case[\"G_Born\"]\n            sigma_xy = case[\"sigma_xy\"]\n            \n            # Calculate unbiased sample variance of shear stress\n            var_sigma_xy = np.var(sigma_xy, ddof=1)\n            \n            # Stress-fluctuation formula\n            G = G_Born - (V / (k_B * T)) * var_sigma_xy\n        \n        elif case[\"ensemble\"] == \"NVE\":\n            N_dof = case[\"N_dof\"]\n            G_Born = case[\"G_Born\"]\n            sigma_xy = case[\"sigma_xy\"]\n            K_series = case[\"K\"]\n\n            # Estimate temperature from average kinetic energy via equipartition\n            K_avg = np.mean(K_series)\n            T_est = (2 * K_avg) / (N_dof * k_B)\n\n            # Calculate unbiased sample variance of shear stress\n            var_sigma_xy = np.var(sigma_xy, ddof=1)\n\n            # Stress-fluctuation formula with estimated temperature\n            G = G_Born - (V / (k_B * T_est)) * var_sigma_xy\n\n        elif case[\"ensemble\"] == \"NPT\":\n            T = case[\"T\"]\n            gamma = case[\"gamma\"]\n\n            # Calculate unbiased sample variance of shear strain\n            var_gamma = np.var(gamma, ddof=1)\n            \n            # Strain-fluctuation formula\n            G = (k_B * T) / (V * var_gamma)\n            \n        results.append(G)\n\n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3452662"}, {"introduction": "最后一项实践旨在探索涨落-耗散定理的另一个强大应用：建立微观动力学与宏观热力学性质之间的桥梁。你将从速度自相关函数出发，利用它重建系统的振动声子谱（一种动力学的谱表示），并最终计算出材料的比热。通过这个过程，你将亲身体验从低温区的量子行为到高温区经典极限的转变 [@problem_id:3452648]。", "problem": "在计算材料科学的背景下，您的任务是利用涨落耗散关系，从平衡速度自相关函数中重构振动态密度，然后预测定容比热的温度依赖性。您应当依赖的基本原理是：平衡速度自相关函数的定义、谐振动的简正模分解，以及谐振子的量子统计力学。在平衡状态下，速度自相关函数定义为 $Z(t) = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle / \\langle \\mathbf{v}(0)^2 \\rangle$，它是一个关于时间的偶函数。在一个谐振系统中，其动力学可以用简正模的叠加来描述。涨落耗散原理将平衡相关函数与响应谱联系起来，确保了从 $Z(t)$ 中提取的光谱内容能够代表与热力学预测相关的振动密度。您必须不使用简化公式；相反，您的重构和热力学计算必须基于这些定义和原理。\n\n对于每个提供的测试用例，您的程序必须执行以下步骤：\n\n1.  使用有限个带规定权重和角频率的阻尼余弦贡献，在均匀时间网格上构建一个合成的、平稳的平衡速度自相关函数 $Z(t)$。每个测试用例指定了权重 $\\{w_i\\}$（满足 $\\sum_i w_i = 1$）、角频率 $\\{\\omega_i\\}$（单位为弧度/皮秒），以及阻尼率 $\\gamma$（单位为1/皮秒）。在 $t \\in [0, t_{\\max}]$ 上使用 $Z(t) = \\mathrm{e}^{-\\gamma t} \\sum_i w_i \\cos(\\omega_i t)$，其中 $t_{\\max}$ 和时间步长 $\\Delta t$ 在下文指定。确保 $Z(0) = 1$。\n\n2.  通过对 $Z(t)$ 应用与涨落耗散框架一致的加窗余弦变换，在均匀角频率网格上数值重构一个单边振动态密度 $g(\\omega)$。使用一种能够抑制频谱泄漏并产生非负估计的切趾窗。对 $g(\\omega)$ 进行归一化，使得 $\\int_0^{\\omega_{\\max}} g(\\omega)\\,\\mathrm{d}\\omega = 1$。\n\n3.  使用重构并归一化的 $g(\\omega)$，计算每个测试用例在两个温度 $T_{\\mathrm{low}}$ 和 $T_{\\mathrm{high}}$（均为开尔文）下，每个振动模式的定容比热 $C_V(T)$，单位为玻尔兹曼常数 $k_{\\mathrm{B}}$。将每个振动模式视为一个独立的量子谐振子，并使用物理上正确的约化普朗克常数 $\\hbar$ 和玻尔兹曼常数 $k_{\\mathrm{B}}$ 的值，在构建无量纲参数 $\\hbar \\omega / (k_{\\mathrm{B}} T)$ 时，要考虑从弧度/皮秒到弧度/秒的单位转换。同时，根据能均分原理计算高温下每个模式的经典定容比热。\n\n4.  对于每个测试用例，输出四个量：低温量子比热 $C_V(T_{\\mathrm{low}})$（单位为 $k_{\\mathrm{B}}$），高温量子比热 $C_V(T_{\\mathrm{high}})$（单位为 $k_{\\mathrm{B}}$），一个布尔值表示高温量子比热是否在经典极限的 $0.05$ 范围内，以及一个布尔值表示低温量子比热是否小于 $0.05$。\n\n重要的数值和单位规范：\n\n-   使用时间网格 $t \\in [0, t_{\\max}]$，其中 $t_{\\max} = 5.0$ 皮秒，$\\Delta t = 0.001$ 皮秒。\n-   使用角频率网格 $\\omega \\in [0, \\omega_{\\max}]$，其中 $\\omega_{\\max} = 100.0$ 弧度/皮秒，并使用均匀间距，提供至少 $2{,}000$ 个点。\n-   温度 $T_{\\mathrm{low}}$ 和 $T_{\\mathrm{high}}$ 以开尔文为单位，所有报告的比热必须以 $k_{\\mathrm{B}}$ 为单位（无量纲），而不是焦耳/开尔文。\n-   角频率必须以弧度处理；在转换为无量纲参数 $\\hbar \\omega / (k_{\\mathrm{B}} T)$ 时，确保单位的一致性。\n\n测试套件：\n\n-   用例1（单个爱因斯坦模式，无阻尼）：权重 $\\{1.0\\}$，频率 $\\{30.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 0.0$ 1/皮秒，$T_{\\mathrm{low}} = 10$ 开尔文，$T_{\\mathrm{high}} = 3000$ 开尔文。\n-   用例2（两个爱因斯坦模式，无阻尼）：权重 $\\{0.6, 0.4\\}$，频率 $\\{20.0, 50.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 0.0$ 1/皮秒，$T_{\\mathrm{low}} = 5$ 开尔文，$T_{\\mathrm{high}} = 5000$ 开尔文。\n-   用例3（两个爱因斯坦模式，有阻尼）：权重 $\\{0.5, 0.5\\}$，频率 $\\{15.0, 40.0\\}$ 弧度/皮秒，阻尼 $\\gamma = 5.0$ 1/皮秒，$T_{\\mathrm{low}} = 5$ 开尔文，$T_{\\mathrm{high}} = 5000$ 开尔文。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。该列表必须按顺序包含每个用例的：$C_V(T_{\\mathrm{low}})$，$C_V(T_{\\mathrm{high}})$，用于高温经典极限检查的布尔值，以及用于低温抑制检查的布尔值。例如，输出应类似于：\"[c1_low,c1_high,c1_high_ok,c1_low_ok,c2_low,c2_high,c2_high_ok,c2_low_ok,c3_low,c3_high,c3_high_ok,c3_low_ok]\"。", "solution": "提交的问题陈述是有效的。它在科学上基于统计力学原理，特别是涨落耗散定理，并且问题设定良好，包含一套清晰、独立的说明和参数。这项任务涉及从一个模型速度自相关函数重构振动态密度，并随后计算热力学性质，是计算材料科学中一个标准且相关的练习。所提供的参数和数值规范在物理上是现实的，在计算上是可行的。\n\n解决方案通过执行问题中概述的步骤序列来进行。该方法的核心依赖于两个基本联系：\n1.  **维纳-辛钦定理（Wiener-Khinchin theorem）**，这是涨落耗散框架的一个具体体现，它指出广义平稳随机过程的功率谱密度是其自相关函数的傅里叶变换。对于原子速度，功率谱密度与振动态密度（VDOS）成正比。\n2.  量子统计力学的原理，即无相互作用的振子系统（谐波近似）的总宏观热力学性质可以通过将单个振子的性质在振子频率分布（即VDOS）上积分来计算。\n\n详细的推导和数值实现如下。\n\n**1. 速度自相关函数（$Z(t)$）的构建**\n\n问题为 $t \\geq 0$ 的归一化、单边平衡速度自相关函数（VACF）$Z(t)$ 提供了一个模型：\n$$\nZ(t) = \\mathrm{e}^{-\\gamma t} \\sum_{i} w_i \\cos(\\omega_i t)\n$$\n在这里，$\\{\\omega_i\\}$ 代表振动简正模的角频率，$\\{w_i\\}$ 是它们在速度自相关中的各自权重（$\\sum_i w_i = 1$ 以确保 $Z(0) = 1$），而 $\\gamma$ 是一个唯象的阻尼参数，它解释了能量耗散，导致振动模式的寿命有限。此函数是在离散时间网格 $t_k = k \\Delta t$（其中 $k = 0, 1, \\dots, (t_{\\max}/\\Delta t)$）上构建的。\n\n**2. 振动态密度（$g(\\omega)$）的重构**\n\nVDOS $g(\\omega)$ 与速度涨落的功率谱成正比。由于 $Z(t)$ 是一个关于时间的实偶函数（根据其物理定义，虽然我们只为 $t \\ge 0$ 建模），其傅里叶变换简化为余弦变换：\n$$\ng(\\omega) \\propto \\int_{-\\infty}^{\\infty} Z(t) e^{-i\\omega t} \\, \\mathrm{d}t = 2 \\int_{0}^{\\infty} Z(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\n在数值计算中，信号时间从 $t=0$ 到 $t=t_{\\max}$ 是有限的，该积分被近似处理。直接截断积分会导致频谱伪影（泄漏）。为了减轻这种情况，$Z(t)$ 首先乘以一个切趾窗函数 $W(t)$，该函数在时间区间的边界处平滑地趋于零。为此选择了汉宁窗（Hann window）：\n$$\nW(t) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi t}{t_{\\max}}\\right)\\right) \\quad \\text{for } t \\in [0, t_{\\max}]\n$$\n然后，通过对加窗的VACF $Z_w(t) = Z(t)W(t)$ 进行数值余弦变换，使用梯形法则进行积分，计算出原始的、未归一化的VDOS $g_{\\text{raw}}(\\omega)$：\n$$\ng_{\\text{raw}}(\\omega) \\approx \\int_{0}^{t_{\\max}} Z_w(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\n通过剪裁可能由数值不精确性引起的任何小的负值，使所得频谱严格非负。最后，将 $g(\\omega)$ 归一化，以表示模式的概率分布：\n$$\n\\int_{0}^{\\omega_{\\max}} g(\\omega) \\, \\mathrm{d}\\omega = 1\n$$\n这是通过将 $g_{\\text{raw}}(\\omega)$ 除以其在频率域 $[0, \\omega_{\\max}]$ 上的总积分来实现的。\n\n**3. 定容比热（$C_V(T)$）的计算**\n\n每个振动模式的定容比热 $C_V(T)$ 是单个模式比热 $C_{V,\\text{SHO}}(\\omega, T)$ 由VDOS $g(\\omega)$ 加权的平均值：\n$$\nC_V(T) = \\int_{0}^{\\omega_{\\max}} C_{V,\\text{SHO}}(\\omega, T) g(\\omega) \\, \\mathrm{d}\\omega\n$$\n在温度 $T$ 下，频率为 $\\omega$ 的单个量子谐振子（SHO）的比热，以玻尔兹曼常数 $k_{\\mathrm{B}}$ 为单位，由下式给出：\n$$\n\\frac{C_{V,\\text{SHO}}(\\omega, T)}{k_{\\mathrm{B}}} = \\left(\\frac{\\hbar \\omega}{2k_{\\mathrm{B}}T}\\right)^2 \\frac{1}{\\sinh^2\\left(\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T}\\right)}\n$$\n其中 $\\hbar$ 是约化普朗克常数。无量纲参数 $x = \\hbar \\omega / (k_{\\mathrm{B}} T)$ 需要仔细的单位转换，因为 $\\omega$ 以弧度/皮秒（rad/ps）给出，必须转换为弧度/秒（$1 \\text{ rad/ps} = 10^{12} \\text{ rad/s}$），以与 $\\hbar$ 和 $k_{\\mathrm{B}}$ 的国际单位制（SI）单位保持一致。$C_V(T)$ 的最终积分是使用梯形法则在离散频率网格上进行数值计算的。\n\n**4. 高温和低温极限**\n\n计算出的比热值与两个物理极限进行比较：\n- **经典极限**：根据能均分定理，在高温下（$k_{\\mathrm{B}} T \\gg \\hbar \\omega$），一维谐振子的比热接近 $k_{\\mathrm{B}}$。因此，检查 $C_V(T_{\\mathrm{high}})/k_{\\mathrm{B}}$ 是否在 $1.0$ 的 $0.05$ 范围内。\n- **低温极限**：当 $T \\to 0$ 时，振动模式“冻结”，比热必须趋于零，这是量子理论的一个关键预测。检查 $C_V(T_{\\mathrm{low}})/k_{\\mathrm{B}}$ 是否小于 $0.05$。\n\n该实现结合了这些步骤来处理每个测试用例并生成所需的输出量。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It reconstructs the VDOS from a synthetic VACF and calculates specific heat.\n    \"\"\"\n\n    # --- Define Physical and Numerical Parameters ---\n    HBAR = constants.hbar  # Reduced Planck constant in J·s\n    KB = constants.k      # Boltzmann constant in J/K\n\n    T_MAX = 5.0      # Maximum correlation time in ps\n    DT = 0.001       # Time step in ps\n    OMEGA_MAX = 100.0  # Maximum angular frequency in rad/ps\n    N_OMEGA = 2001   # Number of points on the frequency grid\n\n    # Create the time and frequency grids\n    t_grid = np.arange(0, T_MAX + DT, DT)\n    omega_grid = np.linspace(0, OMEGA_MAX, N_OMEGA)\n\n    # --- Test Cases ---\n    test_cases = [\n        {'weights': [1.0], 'freqs': [30.0], 'gamma': 0.0, 'T_low': 10.0, 'T_high': 3000.0},\n        {'weights': [0.6, 0.4], 'freqs': [20.0, 50.0], 'gamma': 0.0, 'T_low': 5.0, 'T_high': 5000.0},\n        {'weights': [0.5, 0.5], 'freqs': [15.0, 40.0], 'gamma': 5.0, 'T_low': 5.0, 'T_high': 5000.0},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # --- Step 1: Construct Velocity Autocorrelation Function Z(t) ---\n        weights = np.array(case['weights'])\n        freqs = np.array(case['freqs'])\n        gamma = case['gamma']\n        \n        z_t = np.zeros_like(t_grid)\n        for w, f in zip(weights, freqs):\n            z_t += w * np.cos(f * t_grid)\n        z_t *= np.exp(-gamma * t_grid)\n\n        # --- Step 2: Reconstruct Vibrational Density of States g(omega) ---\n        # Apply a Hann window to Z(t) to suppress spectral leakage from signal truncation\n        hann_window = 0.5 * (1 - np.cos(2 * np.pi * t_grid / T_MAX))\n        z_t_windowed = z_t * hann_window\n\n        # Perform cosine transform via numerical integration (trapezoidal rule).\n        # This is done efficiently using NumPy broadcasting.\n        cos_matrix = np.cos(np.outer(t_grid, omega_grid))\n        integrand = z_t_windowed[:, np.newaxis] * cos_matrix\n        g_raw = integrate.trapezoid(integrand, t_grid, axis=0)\n        \n        # Ensure g(omega) is non-negative, clipping any numerical noise\n        g_raw[g_raw  0] = 0.0\n\n        # Normalize g(omega) such that its integral is 1\n        norm_const = integrate.trapezoid(g_raw, omega_grid)\n        g_omega = g_raw / norm_const if norm_const  1e-12 else np.zeros_like(omega_grid)\n\n        # --- Step 3: Compute Constant-Volume Specific Heat Cv(T) ---\n        def calculate_cv_per_mode(T, vdos, omega_grid_rps):\n            if T = 0:\n                return 0.0\n            \n            # Convert omega from rad/ps to rad/s for use with SI unit constants\n            omega_grid_rs = omega_grid_rps * 1e12\n            \n            # Dimensionless parameter x = hbar*omega / (kB*T)\n            # Handle T=0 or omega=0 cases where x might be ill-defined\n            x = np.zeros_like(omega_grid_rs)\n            valid_T = T  1e-9\n            if valid_T:\n                x = (HBAR * omega_grid_rs) / (KB * T)\n            \n            # Specific heat of a single quantum harmonic oscillator in units of kB\n            cv_sho_per_kb = np.ones_like(x)\n            non_zero_x = x  1e-9\n            \n            arg = x[non_zero_x] / 2.0\n            cv_sho_per_kb[non_zero_x] = np.power(arg, 2) / np.power(np.sinh(arg), 2)\n            \n            # Total specific heat per mode is the average over the VDOS\n            total_cv_per_kb = integrate.trapezoid(cv_sho_per_kb * vdos, omega_grid_rps)\n            return total_cv_per_kb\n\n        cv_low = calculate_cv_per_mode(case['T_low'], g_omega, omega_grid)\n        cv_high = calculate_cv_per_mode(case['T_high'], g_omega, omega_grid)\n        \n        # --- Step 4: Perform Boolean Checks ---\n        # Classical limit for Cv per mode is 1.0 kB\n        classical_limit = 1.0\n        high_temp_check = abs(cv_high - classical_limit)  0.05\n        low_temp_check = cv_low  0.05\n        \n        all_results.extend([cv_low, cv_high, high_temp_check, low_temp_check])\n\n    # --- Final Output Formatting ---\n    # Format the results into a single comma-separated string as per problem specification.\n    # Boolean values are converted to lowercase strings 'true'/'false'.\n    final_list_str = []\n    for r in all_results:\n        if isinstance(r, bool):\n            final_list_str.append(str(r).lower())\n        else:\n            final_list_str.append(str(r))\n    \n    print(f\"[{','.join(final_list_str)}]\")\n\nsolve()\n```", "id": "3452648"}]}