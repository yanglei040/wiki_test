{"hands_on_practices": [{"introduction": "本练习旨在通过将化学势的偏导数定义应用于最简单的混合物模型——理想溶液，来建立对化学势的基础理解。通过这个实践[@problem_id:3436843]，你将推导出化学势表达式，并阐明其中对数浓度项的物理来源，即它与构型熵的深刻联系。这是一个从第一性原理出发，连接宏观热力学与微观统计构型的关键步骤。", "problem": "考虑一个由组分 $A$ 和 $B$ 组成的二元置换理想固溶体，其温度为 $T$，压力为 $P$。该混合物的宏观吉布斯自由能由下式给出\n$$\nG(T,P,N_A,N_B) = \\sum_{i\\in\\{A,B\\}} N_i\\,\\mu_i^{0}(T,P) + R T \\sum_{i\\in\\{A,B\\}} N_i \\ln x_i,\n$$\n其中，$N_i$ 是组分 $i$ 的摩尔数，$\\mu_i^{0}(T,P)$ 是在相同温度 $T$ 和压力 $P$ 下纯组分 $i$ 的化学势，$R$ 是通用气体常数，$x_i = N_i/(N_A+N_B)$ 是摩尔分数。利用化学势的基本定义，即在恒定温度 $T$、压力 $P$ 以及所有其他组分的量固定的情况下，吉布斯自由能对摩尔数的偏导数，推导该混合物的化学势 $\\mu_A(T,P,x_A)$ 和 $\\mu_B(T,P,x_B)$ 的解析表达式。\n\n然后，对于特定状态 $T=1200\\,\\text{K}$ 和 $P=1\\,\\text{bar}$，纯组分化学势为 $\\mu_A^{0}(T,P) = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1}$ 和 $\\mu_B^{0}(T,P) = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1}$，且组成为 $x_A = 0.25$ 和 $x_B = 0.75$ 的情况，计算 $\\mu_A$ 和 $\\mu_B$ 的数值。\n\n最后，解释推导出的 $\\mu_i$ 表达式中组分依赖性的物理意义。在你的解释中，将该组分依赖性与适用于凝聚相的基本热力学起源联系起来。\n\n在计算中使用 $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。将最终的化学势数值以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位表示，并将答案四舍五入至四位有效数字。", "solution": "该问题陈述清晰，具有科学依据，并为完整解答提供了所有必要信息。它要求推导二元理想溶液的化学势，对特定状态进行数值计算，并解释组分依赖项的物理起源。\n\n分析按要求分三部分进行。\n\n第一部分：推导化学势表达式。\n\n混合物中组分 $i$ 的化学势定义为偏摩尔吉布斯自由能。对于组分 $A$，其表达式为：\n$$\n\\mu_A = \\left(\\frac{\\partial G}{\\partial N_A}\\right)_{T,P,N_B}\n$$\n二元理想溶液的吉布斯自由能由下式给出：\n$$\nG(T,P,N_A,N_B) = N_A\\,\\mu_A^{0}(T,P) + N_B\\,\\mu_B^{0}(T,P) + R T (N_A \\ln x_A + N_B \\ln x_B)\n$$\n其中 $x_A = \\frac{N_A}{N_A+N_B}$ 且 $x_B = \\frac{N_B}{N_A+N_B}$。\n\n为了进行偏微分，最好将对数项仅表示为摩尔数 $N_A$ 和 $N_B$ 的函数：\n$$\n\\ln x_A = \\ln\\left(\\frac{N_A}{N_A+N_B}\\right) = \\ln N_A - \\ln(N_A+N_B)\n$$\n$$\n\\ln x_B = \\ln\\left(\\frac{N_B}{N_A+N_B}\\right) = \\ln N_B - \\ln(N_A+N_B)\n$$\n将这些代入 $G$ 的表达式中：\n$$\nG = N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A(\\ln N_A - \\ln(N_A+N_B)) + N_B(\\ln N_B - \\ln(N_A+N_B)) \\right]\n$$\n可以简化为：\n$$\nG = N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A\\ln N_A + N_B\\ln N_B - (N_A+N_B)\\ln(N_A+N_B) \\right]\n$$\n现在，我们计算 $G$ 对 $N_A$ 的偏导数，同时保持 $T$、$P$ 和 $N_B$ 恒定。\n$$\n\\mu_A = \\frac{\\partial}{\\partial N_A} \\left( N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A\\ln N_A + N_B\\ln N_B - (N_A+N_B)\\ln(N_A+N_B) \\right] \\right)\n$$\n我们逐项微分：\n\\begin{enumerate}\n    \\item $\\frac{\\partial}{\\partial N_A}(N_A\\mu_A^0) = \\mu_A^0$（因为 $\\mu_A^0$ 仅是 $T$ 和 $P$ 的函数，而 $T$ 和 $P$ 保持不变）。\n    \\item $\\frac{\\partial}{\\partial N_A}(N_B\\mu_B^0) = 0$。\n    \\item $\\frac{\\partial}{\\partial N_A}(R T [N_A\\ln N_A]) = R T \\left( 1 \\cdot \\ln N_A + N_A \\cdot \\frac{1}{N_A} \\right) = R T (\\ln N_A + 1)$。\n    \\item $\\frac{\\partial}{\\partial N_A}(R T [N_B\\ln N_B]) = 0$。\n    \\item $\\frac{\\partial}{\\partial N_A}( - R T [(N_A+N_B)\\ln(N_A+N_B)] )$。使用乘积法则 $d(uv) = u'v + uv'$，其中 $u=N_A+N_B$ 且 $v=\\ln(N_A+N_B)$：\n    $$\n    -R T \\left[ \\frac{\\partial(N_A+N_B)}{\\partial N_A} \\ln(N_A+N_B) + (N_A+N_B) \\frac{\\partial(\\ln(N_A+N_B))}{\\partial N_A} \\right]\n    $$\n    $$\n    = -R T \\left[ 1 \\cdot \\ln(N_A+N_B) + (N_A+N_B) \\cdot \\frac{1}{N_A+N_B} \\cdot \\frac{\\partial(N_A+N_B)}{\\partial N_A} \\right]\n    $$\n    $$\n    = -R T \\left[ \\ln(N_A+N_B) + 1 \\right]\n    $$\n\\end{enumerate}\n合并所有项：\n$$\n\\mu_A = \\mu_A^0 + R T (\\ln N_A + 1) - R T (\\ln(N_A+N_B) + 1)\n$$\n$$\n\\mu_A = \\mu_A^0 + R T [\\ln N_A - \\ln(N_A+N_B)]\n$$\n$$\n\\mu_A = \\mu_A^0 + R T \\ln\\left(\\frac{N_A}{N_A+N_B}\\right)\n$$\n这简化为 $\\mu_A$ 的最终解析表达式：\n$$\n\\mu_A(T,P,x_A) = \\mu_A^{0}(T,P) + R T \\ln x_A\n$$\n由于吉布斯自由能表达式对于组分 $A$ 和 $B$ 具有对称性，$\\mu_B$ 的推导是类似的：\n$$\n\\mu_B(T,P,x_B) = \\mu_B^{0}(T,P) + R T \\ln x_B\n$$\n\n第二部分：化学势的数值计算。\n\n给定的参数是：\n$$\nT=1200\\,\\text{K}\n$$\n$$\nP=1\\,\\text{bar}\n$$\n$$\n\\mu_A^{0} = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_B^{0} = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\nx_A = 0.25\n$$\n$$\nx_B = 0.75\n$$\n$$\nR = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}\n$$\n首先，我们计算 $R T$ 项并将其单位转换为 $\\text{kJ}\\,\\text{mol}^{-1}$：\n$$\nR T = (8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) \\times (1200\\,\\text{K}) = 9977.3551416\\,\\text{J}\\,\\text{mol}^{-1}\n$$\n$$\nR T \\approx 9.9774\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n现在，我们计算 $\\mu_A$：\n$$\n\\mu_A = \\mu_A^0 + R T \\ln x_A = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355... \\,\\text{kJ}\\,\\text{mol}^{-1}) \\times \\ln(0.25)\n$$\n$$\n\\ln(0.25) \\approx -1.386294\n$$\n$$\n\\mu_A \\approx -37.20\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355...) \\times (-1.386294)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_A \\approx -37.20 - 13.8298\\,\\text{kJ}\\,\\text{mol}^{-1} = -51.0298\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n四舍五入至四位有效数字，$\\mu_A = -51.03\\,\\text{kJ}\\,\\text{mol}^{-1}$。\n\n接下来，我们计算 $\\mu_B$：\n$$\n\\mu_B = \\mu_B^0 + R T \\ln x_B = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355... \\,\\text{kJ}\\,\\text{mol}^{-1}) \\times \\ln(0.75)\n$$\n$$\n\\ln(0.75) \\approx -0.287682\n$$\n$$\n\\mu_B \\approx -41.50\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355...) \\times (-0.287682)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_B \\approx -41.50 - 2.8698\\,\\text{kJ}\\,\\text{mol}^{-1} = -44.3698\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n四舍五入至四位有效数字，$\\mu_B = -44.37\\,\\text{kJ}\\,\\text{mol}^{-1}$。\n\n第三部分：组分依赖性的物理意义。\n\n表达式 $\\mu_i = \\mu_i^0 + R T \\ln x_i$ 中的组分依赖性完全包含在 $R T \\ln x_i$ 这一项中。该项代表了物种 $i$ 因与其他组分混合而引起的化学势变化。其基本热力学起源是熵。\n\n问题指出该系统是理想溶液。理想溶液的一个定义性特征是混合焓为零，即 $\\Delta H_{\\text{mix}} = 0$。这意味着不同种类原子间的相互作用（$A-B$）在能量上等同于同类原子间相互作用（$A-A$ 和 $B-B$）的平均值。\n\n混合吉布斯自由能由 $\\Delta G_{\\text{mix}} = \\Delta H_{\\text{mix}} - T \\Delta S_{\\text{mix}}$ 给出。对于理想溶液，这简化为：\n$$\n\\Delta G_{\\text{mix}} = - T \\Delta S_{\\text{mix}}\n$$\n根据给定的总吉布斯自由能 $G$ 的表达式，混合吉布斯能为：\n$$\n\\Delta G_{\\text{mix}} = G - \\sum_{i} N_i \\mu_i^0 = R T \\sum_{i} N_i \\ln x_i\n$$\n通过比较 $\\Delta G_{\\text{mix}}$ 的这两个表达式，我们确定混合熵为：\n$$\n\\Delta S_{\\text{mix}} = -R \\sum_{i} N_i \\ln x_i\n$$\n这种熵是**构型熵**（或组合熵），它源于凝聚相的底层晶格或结构上不同组分空间排列的多样性。根据玻尔兹曼熵公式 $S = k_B \\ln \\Omega$，其中 $\\Omega$ 是可及微观态的数量。对于一个具有 $N_A$ 个 $A$ 类原子和 $N_B$ 个 $B$ 类原子，分布在总共 $N = N_A+N_B$ 个晶格位置上的二元置换晶体，其不同构型的数量由二项式系数 $\\Omega = \\frac{N!}{N_A! N_B!}$ 给出。对大量原子使用斯特林近似，并从基于粒子（使用 $k_B$）的基础转换到基于摩尔（使用 $R$）的基础，可以推导出宏观表达式 $\\Delta S_{\\text{mix}} = -R \\sum N_i \\ln x_i$。\n\n因此，化学势中的 $R T \\ln x_i$ 项代表了这种构型熵对偏摩尔吉布斯自由能的贡献。因为在混合物中，摩尔分数 $x_i$ 总是小于 $1$，所以 $\\ln x_i$ 项总是负的。这意味着混合会降低每个组分相对于其纯态的化学势（$\\mu_i  \\mu_i^0$）。这种由熵增加驱动的吉布斯自由能的降低，是理想溶液中组分自发混合的基本热力学驱动力。", "answer": "$$\\boxed{\\begin{pmatrix} -51.03  -44.37 \\end{pmatrix}}$$", "id": "3436843"}, {"introduction": "在多组分体系中，各组分的化学势并非相互独立，而是受到热力学基本定律的严格约束。本练习将介绍吉布斯-杜亥姆 (Gibbs-Duhem) 关系式，这是一个核心的热力学自洽性判据。通过一个具体的数值计算任务[@problem_id:3436883]，你将学会如何检验一个给定的热力学模型或一组模拟数据是否满足这一基本约束，这是评估和开发材料模型时的重要技能。", "problem": "给定二元凝聚相的两个组分化学势 $\\,\\mu_A(x,T)\\,$ 和 $\\,\\mu_B(x,T)\\,$，它们是在固定压力下，作为物种 A 的摩尔分数 $\\,x \\in (0,1)\\,$ 和以开尔文为单位的绝对温度 $\\,T\\,$ 的函数。根据平衡热力学，理论上的一致性条件是，在固定的 $\\,T\\,$ 和压力下，组分化学势对组分的导数的组分加权和必须为零。定义残差函数\n$$ r(x;T) \\equiv x\\,\\frac{\\partial \\mu_A(x,T)}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B(x,T)}{\\partial x}, $$\n该函数在固定的 $\\,T\\,$ 和压力下求值。完美的热力学一致性意味着对于所有 $\\,x\\in(0,1)\\,$，$\\,r(x;T)=0\\,$。\n\n你将对以下明确的、科学上合理的、基于摩尔吉布斯自由能的模型进行数值上的热力学一致性检验，该模型产生 $\\,\\mu_A(x,T)\\,$ 和 $\\,\\mu_B(x,T)\\,$。设普适气体常数为 $\\,R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$。设每摩尔参考（纯组分）化学势是温度的仿射函数，\n$$ \\mu_A^0(T) = a_A + b_A T,\\quad \\mu_B^0(T) = a_B + b_B T, $$\n其中常数 $\\,a_A = -50000\\,\\mathrm{J\\,mol^{-1}},\\; b_A = 12\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}},\\; a_B = -52000\\,\\mathrm{J\\,mol^{-1}},\\; b_B = 9\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$。设正规溶体相互作用参数是温度的仿射函数，\n$$ W(T) = W_0 + W_1 T, $$\n其中 $\\,W_0 = 16000\\,\\mathrm{J\\,mol^{-1}}\\,$ 且 $\\,W_1 = -3\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$。每摩尔混合物的摩尔吉布斯自由能是\n$$ g(x,T) = x\\,\\mu_A^0(T) + (1-x)\\,\\mu_B^0(T) + R T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W(T)\\,x(1-x). $$\n由此 $\\,g(x,T)\\,$，组分化学势为\n$$ \\mu_A(x,T) = \\mu_A^0(T) + R T \\ln x + W(T)\\,(1-x)^2, $$\n$$ \\mu_B(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + W(T)\\,x^2. $$\n\n你的任务是为每个指定的测试案例计算最大绝对残差\n$$ R_{\\max}(T;\\mathcal{X}) \\equiv \\max_{x \\in \\mathcal{X}} \\left| r(x;T) \\right|, $$\n该最大值是在一个给定的离散集 $\\,\\mathcal{X}\\subset(0,1)\\,$ 上计算的，结果以 $\\,\\mathrm{J\\,mol^{-1}}\\,$ 为单位。在可用时使用精确的解析导数；如果选择数值微分，请确保其足够精确以达到要求的舍入精度。\n\n测试套件（四个案例），每个案例产生一个标量 $\\,R_{\\max}\\,$：\n- 案例 1 (基线一致性模型)：$\\,T = 1000\\,\\mathrm{K}\\,,$ $\\,\\mathcal{X} = \\{ x_k \\}_{k=0}^{200}\\,$，其中 $\\,x_k = 0.01 + k\\,h\\,$ 且 $\\,h = 0.98/200\\,$。使用如上定义的 $\\,\\mu_A(x,T)\\,$ 和 $\\,\\mu_B(x,T)\\,$。\n- 案例 2 (第二组分的确定性扰动)：$\\,T = 1000\\,\\mathrm{K}\\,,$ 与案例 1 使用相同的 $\\,\\mathcal{X}\\,$。使用如上的 $\\,\\mu_A(x,T)\\,$ 并将 $\\,\\mu_B(x,T)\\,$ 替换为\n$$ \\mu_B^{\\mathrm{pert}}(x,T) = \\mu_B(x,T) + \\varepsilon\\,R T \\sin\\!\\left(200\\pi x\\right), $$\n其中 $\\,\\varepsilon = 10^{-3}\\,.$\n- 案例 3 (粗网格上的相互作用参数不匹配)：$\\,T = 1000\\,\\mathrm{K}\\,,$ 其中 $\\,\\mathcal{X} = \\{0.1,\\,0.9\\}\\,$。使用如上的 $\\,\\mu_A(x,T)\\,$，但仅在 $\\,\\mu_B(x,T)\\,$ 中将相互作用参数替换为 $\\,\\widetilde{W}(T) = W(T) + \\Delta W\\,$，其中 $\\,\\Delta W = 500\\,\\mathrm{J\\,mol^{-1}}\\,$，即\n$$ \\mu_B^{\\mathrm{mis}}(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + \\widetilde{W}(T)\\,x^2. $$\n- 案例 4 (近纯组分边缘分辨率检查)：$\\,T = 650\\,\\mathrm{K}\\,,$ 其中\n$$ \\mathcal{X} = \\{10^{-6},\\,10^{-4},\\,10^{-3},\\,10^{-2},\\,0.05,\\,0.5,\\,0.95,\\,0.99,\\,0.999,\\,0.9999,\\,0.999999\\}. $$\n\n单位和输出：\n- 以 $\\,\\mathrm{J\\,mol^{-1}}\\,$ 为单位报告每个 $\\,R_{\\max}\\,$，四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含案例 1-4 的结果，格式为用方括号括起来的逗号分隔列表，例如 $\\,\\left[\\text{res}_1,\\text{res}_2,\\text{res}_3,\\text{res}_4\\right]\\,$，其中每个条目都是一个使用标准四舍五入到六位小数的十进制数。\n\n你的程序必须是一个完整的、可运行的实现，使用此处给出的精确常数和定义执行这些计算，并按指定格式输出列表。不需要也不允许用户输入。角度单位不适用。所有最终数值结果均按规定以 $\\,\\mathrm{J\\,mol^{-1}}\\,$ 表示。", "solution": "该问题要求对二元混合物的化学势模型的热力学一致性进行数值验证。被检验的基本原理是吉布斯-杜亥姆关系，对于一个在恒定温度 $T$ 和压力 $P$ 下的二元体系，该关系表明两个组分 $\\mu_A$ 和 $\\mu_B$ 的化学势不是独立的。它们的组分导数通过以下关系式相关联：\n$$ x \\, d\\mu_A + (1-x) \\, d\\mu_B = 0 $$\n其中 $x$ 是组分 A 的摩尔分数。由于压力是固定的，全微分 $d\\mu_A$ 和 $d\\mu_B$ 仅依赖于组分变化 $dx$。这导致了以下条件：\n$$ x\\,\\frac{\\partial \\mu_A}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B}{\\partial x} = 0 $$\n其中偏导数是在恒定 $T$ 和 $P$ 下求值的。\n\n问题定义了一个残差函数 $r(x;T)$ 来量化任何与此条件的偏差：\n$$ r(x;T) \\equiv x\\,\\frac{\\partial \\mu_A(x,T)}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B(x,T)}{\\partial x} $$\n对于一个热力学自洽的模型，$r(x;T)$ 必须对所有 $x \\in (0,1)$ 恒等于零。任务是为四个不同案例，在指定的摩尔分数离散集 $\\mathcal{X}$ 上，计算此残差的最大绝对值 $R_{\\max}(T;\\mathcal{X}) = \\max_{x \\in \\mathcal{X}} |r(x;T)|$。\n\n为确保准确性，根据问题陈述的建议，我们将使用给定化学势函数的精确解析导数。\n\n普适气体常数为 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。参考化学势和正规溶体相互作用参数作为温度 $T$ 的函数给出：\n$$ \\mu_A^0(T) = a_A + b_A T, \\quad \\text{其中 } a_A = -50000\\,\\mathrm{J\\,mol^{-1}}, b_A = 12\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n$$ \\mu_B^0(T) = a_B + b_B T, \\quad \\text{其中 } a_B = -52000\\,\\mathrm{J\\,mol^{-1}}, b_B = 9\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n$$ W(T) = W_0 + W_1 T, \\quad \\text{其中 } W_0 = 16000\\,\\mathrm{J\\,mol^{-1}}, W_1 = -3\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n\n**案例 1：基线一致性模型**\n化学势由标准正规溶体模型给出：\n$$ \\mu_A(x,T) = \\mu_A^0(T) + R T \\ln x + W(T)\\,(1-x)^2 $$\n$$ \\mu_B(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + W(T)\\,x^2 $$\n在恒定 $T$ 下对 $x$ 的偏导数为：\n$$ \\frac{\\partial \\mu_A}{\\partial x} = \\frac{RT}{x} - 2W(T)(1-x) $$\n$$ \\frac{\\partial \\mu_B}{\\partial x} = -\\frac{RT}{1-x} + 2W(T)x $$\n将这些代入残差函数定义中：\n$$ r(x;T) = x \\left( \\frac{RT}{x} - 2W(T)(1-x) \\right) + (1-x) \\left( -\\frac{RT}{1-x} + 2W(T)x \\right) $$\n$$ r(x;T) = \\left( RT - 2xW(T)(1-x) \\right) + \\left( -RT + 2xW(T)(1-x) \\right) = 0 $$\n从解析上看，对于所有 $x \\in (0,1)$，残差为零。在数值上，计算应产生一个与机器浮点精度数量级相当的值，出于实际目的，该值可视为零。因此，对于案例 1，我们预期 $R_{\\max} \\approx 0$。\n\n**案例 2：第二组分的确定性扰动**\n这里，$\\mu_A$ 不变，但 $\\mu_B$ 受到扰动：\n$$ \\mu_B^{\\mathrm{pert}}(x,T) = \\mu_B(x,T) + \\varepsilon\\,R T \\sin\\!\\left(200\\pi x\\right) $$\n其中 $\\varepsilon = 10^{-3}$。扰动项的导数是 $\\frac{\\partial}{\\partial x}(\\varepsilon R T \\sin(200\\pi x)) = 200\\pi \\varepsilon R T \\cos(200\\pi x)$。残差函数变为：\n$$ r_{\\mathrm{pert}}(x;T) = \\left( x \\frac{\\partial \\mu_A}{\\partial x} + (1-x)\\frac{\\partial \\mu_B}{\\partial x} \\right) + (1-x) \\left( 200\\pi \\varepsilon R T \\cos(200\\pi x) \\right) $$\n第一项是基线模型的残差，为零。因此：\n$$ r_{\\mathrm{pert}}(x;T) = (1-x) \\left( 200\\pi \\varepsilon R T \\cos(200\\pi x) \\right) $$\n此表达式在给定的集合 $\\mathcal{X}$ 中的每个 $x$ 处求值，以找到最大绝对值。\n\n**案例 3：相互作用参数不匹配**\n在这种情况下，$\\mu_A$ 来自基线模型，但 $\\mu_B$ 是用不匹配的相互作用参数 $\\widetilde{W}(T) = W(T) + \\Delta W$ 构建的，其中 $\\Delta W = 500\\,\\mathrm{J\\,mol^{-1}}$：\n$$ \\mu_B^{\\mathrm{mis}}(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + \\widetilde{W}(T)\\,x^2 $$\n导数为 $\\frac{\\partial \\mu_B^{\\mathrm{mis}}}{\\partial x} = -\\frac{RT}{1-x} + 2\\widetilde{W}(T)x$。残差为：\n$$ r_{\\mathrm{mis}}(x;T) = x\\frac{\\partial \\mu_A}{\\partial x} + (1-x)\\frac{\\partial \\mu_B^{\\mathrm{mis}}}{\\partial x} $$\n$$ r_{\\mathrm{mis}}(x;T) = x \\left(\\frac{RT}{x} - 2W(T)(1-x) \\right) + (1-x) \\left(-\\frac{RT}{1-x} + 2\\widetilde{W}(T)x \\right) $$\n$$ r_{\\mathrm{mis}}(x;T) = \\left(RT - 2xW(T)(1-x)\\right) + \\left(-RT + 2x(1-x)\\widetilde{W}(T)\\right) $$\n$$ r_{\\mathrm{mis}}(x;T) = 2x(1-x)(\\widetilde{W}(T) - W(T)) = 2x(1-x)\\Delta W $$\n此表达式在 $x \\in \\{0.1, 0.9\\}$ 处求值以找到 $R_{\\max}$。\n\n**案例 4：近纯组分边缘分辨率检查**\n此案例使用与案例 1 中相同的热力学一致的基线模型，但在不同的温度（$T=650\\,\\mathrm{K}$）和一个包含非常接近纯组分极限（$x=0$ 和 $x=1$）的点的网格 $\\mathcal{X}$ 上。与案例 1 一样，解析残差为 $r(x;T)=0$。其目的是在这些更具挑战性的条件下检查计算的数值稳定性。由于标准浮点运算的高精度，结果预计同样实际上为零。\n\n该解决方案通过为每个案例创建一个函数来实现，该函数根据这些推导出的解析表达式计算最大绝对残差。最终结果被收集并按规定格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thermodynamic consistency residuals for a binary solution model.\n    \"\"\"\n    # Define physical constants and model parameters\n    R = 8.314462618  # J/mol/K\n    a_A = -50000.0   # J/mol\n    b_A = 12.0       # J/mol/K\n    a_B = -52000.0   # J/mol\n    b_B = 9.0        # J/mol/K\n    W_0 = 16000.0    # J/mol\n    W_1 = -3.0       # J/mol/K\n\n    def W(T):\n        \"\"\"Calculates the interaction parameter W at temperature T.\"\"\"\n        return W_0 + W_1 * T\n\n    # --- Case 1: Baseline Consistent Model ---\n    def calculate_case1():\n        \"\"\"\n        Calculates R_max for the baseline model.\n        Analytically, the residual is zero. This calculation confirms it numerically.\n        \"\"\"\n        T = 1000.0  # K\n        h = 0.98 / 200.0\n        X = np.linspace(0.01, 0.99, 201)\n        \n        Wt = W(T)\n        residuals = []\n        for x in X:\n            # r(x,T) = x * (RT/x - 2W(1-x)) + (1-x) * (-RT/(1-x) + 2Wx)\n            # which simplifies to:\n            # (RT - 2xW(1-x)) + (-RT + 2xW(1-x)) = 0\n            term1 = R * T - 2 * x * Wt * (1 - x)\n            term2 = -R * T + 2 * x * (1 - x) * Wt\n            r_val = term1 + term2\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 2: Deterministic Perturbed Second Component ---\n    def calculate_case2():\n        \"\"\"\n        Calculates R_max for the model with a perturbed chemical potential for component B.\n        \"\"\"\n        T = 1000.0  # K\n        epsilon = 1e-3\n        h = 0.98 / 200.0\n        X = np.linspace(0.01, 0.99, 201)\n\n        residuals = []\n        # Analytical residual: r(x,T) = (1-x) * epsilon * R * T * (200*pi) * cos(200*pi*x)\n        const_factor = epsilon * R * T * 200 * np.pi\n        for x in X:\n            r_val = (1 - x) * const_factor * np.cos(200 * np.pi * x)\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 3: Interaction-parameter Mismatch ---\n    def calculate_case3():\n        \"\"\"\n        Calculates R_max for the model with a mismatched interaction parameter in component B.\n        \"\"\"\n        X = np.array([0.1, 0.9])\n        delta_W = 500.0  # J/mol\n        \n        residuals = []\n        # Analytical residual: r(x,T) = 2 * x * (1-x) * delta_W\n        for x in X:\n            r_val = 2 * x * (1 - x) * delta_W\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 4: Near-pure Edge-resolution Check ---\n    def calculate_case4():\n        \"\"\"\n        Calculates R_max for the baseline model at extreme compositions.\n        Similar to Case 1, the analytical residual is zero.\n        \"\"\"\n        T = 650.0  # K\n        X = np.array([1e-6, 1e-4, 1e-3, 1e-2, 0.05, 0.5, 0.95, 0.99, 0.999, 0.9999, 0.999999])\n        \n        Wt = W(T)\n        residuals = []\n        for x in X:\n            # r(x,T) = 0 analytically.\n            term1 = R * T - 2 * x * Wt * (1 - x)\n            term2 = -R * T + 2 * x * (1 - x) * Wt\n            r_val = term1 + term2\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # Calculate results for all cases\n    results = [\n        calculate_case1(),\n        calculate_case2(),\n        calculate_case3(),\n        calculate_case4()\n    ]\n\n    # Format the results as per the problem specification and print\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3436883"}, {"introduction": "本节最后一个练习将从业界广泛应用的真实固相模型出发，演示如何在实践中计算凝聚相的化学势。这个问题[@problem_id:3436902]融合了弹性力学、晶格动力学（声子）和统计热力学的概念，要求你通过准谐振子近似（QHA）来计算一个单组分晶体的化学势。这个综合性练习反映了现代计算材料科学中用于预测材料稳定性和相图的先进方法。", "problem": "考虑一个在恒定温度和压力下，使用晶格振动和弹性静态背景建模的单组分可压缩晶体。从内能、熵和自由能的定义出发，基于第一性原理推导一个恒等式，该恒等式将单组分凝聚相的化学势与恒定温度和压力下吉布斯自由能对粒子数的变化率联系起来。然后，通过对一个模型固体独立计算该恒等式的两边，来实现一个计算测试。在该模型中，首先在谐振极限内，然后在准谐近似（QHA）内包含振动贡献，最后添加一个小的非谐校正。\n\n使用以下建模假设，每个假设都是一个经过充分检验的物理近似，可作为基础出发点：\n\n1. 热力学定义和定律：\n   - 吉布斯自由能定义为 $G = U + p V - T S$，其中 $U$ 是内能，$p$ 是压力，$V$ 是体积，$T$ 是温度，$S$ 是熵。\n   - 单组分系统的基本热力学微分为 $dU = T\\,dS - p\\,dV + \\mu\\,dN$，其中 $\\mu$ 是化学势，$N$ 是粒子数。\n   - 结合这些来获得吉布斯自由能的全微分。\n\n2. 静态弹性能：\n   - 在体积变化下，静态晶格（无热）内能围绕单位粒子的平衡比容 $v_0$ 进行二次方建模，体积模量为 $K_0$，使用标准弹性展开\n     $$U_{\\text{stat}}(V,N) = \\frac{K_0}{2 V_0} \\left(V - V_0\\right)^2,$$\n     其中 $V_0 = N v_0$。这确保了 $U_{\\text{stat}}$ 是广延的，并在平衡点附近再现一个恒定的体积模量。使用 $v_0 = 16.0\\,\\text{\\AA}^3$/粒子和 $K_0 = 100.0\\,\\text{GPa}$。使用 $1\\,\\text{GPa} = \\left(1/160.21766208\\right)\\,\\text{eV}/\\text{\\AA}^3$ 一致地转换压力，以便所有能量单位为电子伏特，体积单位为立方埃。\n\n3. 德拜模型中的谐振振动自由能：\n   - 在温度 $T$ 下的振动亥姆霍兹自由能由具有截止频率 $\\omega_D$（或等效地，德拜温度 $\\Theta_D = \\hbar \\omega_D / k_B$）的德拜态密度给出。振动自由能是\n     $$F_{\\text{vib}}(T, \\Theta_D, N) = \\int_{0}^{\\omega_D} g(\\omega) \\left[\\frac{1}{2}\\hbar \\omega + k_B T \\ln\\!\\left(1 - e^{-\\hbar \\omega/(k_B T)}\\right)\\right] d\\omega,$$\n     其中德拜态密度为 $g(\\omega) = \\frac{9N}{\\omega_D^3}\\omega^2$ (当 $0 \\le \\omega \\le \\omega_D$ 时)，否则为 $0$。用 $\\Theta_D$ 表示此积分，并根据需要进行数值计算。包括零点贡献。使用单位为电子伏特每开尔文的 $k_B$，以使最终能量单位为电子伏特。\n\n4. 准谐近似（QHA）：\n   - 在 QHA 中，德拜温度通过 Grüneisen 型标度关系依赖于体积\n     $$\\Theta_D(V,N) = \\Theta_{D0} \\left(\\frac{V}{N v_0}\\right)^{-\\gamma},$$\n     在 $V = N v_0$ 时，参考德拜温度为 $\\Theta_{D0} = 300.0\\,\\text{K}$。使用下面每个测试案例中提供的 Grüneisen 参数 $\\gamma$。\n\n5. 非谐校正：\n   - 为在微扰水平上评估非谐性，向亥姆霍兹自由能添加一个小的广延校正，形式为\n     $$\\Delta F_{\\text{anh}}(T,V,N) = a_{\\text{anh}}\\, N\\, k_B T \\left(\\frac{T}{\\Theta_D(V,N)}\\right)^2,$$\n     其中 $a_{\\text{anh}}$ 是每个测试案例给出的无量纲系数。该项以简化的方式模拟了三次非谐性的主导阶温度依赖性。\n\n6. 恒定温度和压力下的吉布斯自由能：\n   - 对于给定的 $T$、$p$ 和 $N$，定义\n     $$G(V;T,p,N) = U_{\\text{stat}}(V,N) + F_{\\text{vib}}(T,\\Theta_D(V,N),N) + \\Delta F_{\\text{anh}}(T,V,N) + p V.$$\n   - 平衡吉布斯自由能通过对体积进行最小化获得：\n     $$G(T,p,N) = \\min_{V>0} G(V;T,p,N).$$\n\n7. 以两种独立方式测试化学势：\n   - 在恒定温度和压力下使用中心差分的离散有限差分估计，\n     $$\\mu_{\\text{fd}}(T,p,N) \\approx \\frac{G(T,p,N+1) - G(T,p,N-1)}{2},$$\n     它近似于在恒定 $T$ 和 $p$ 下对 $N$ 的偏导数。\n   - 通过最小化单位粒子的吉布斯自由能密度，经由比容 $v = V/N$ 的热力学极限下的强度量估计，\n     $$g(v;T,p) = \\frac{U_{\\text{stat}}(N v,N)}{N} + \\frac{F_{\\text{vib}}(T,\\Theta_D(N v,N),N)}{N} + \\frac{\\Delta F_{\\text{anh}}(T,N v,N)}{N} + p\\,v,$$\n     且\n     $$\\mu_{\\text{th}}(T,p) = \\min_{v>0} g(v;T,p).$$\n   - 因为 $U_{\\text{stat}}$、$F_{\\text{vib}}$ 和 $\\Delta F_{\\text{anh}}$ 在构造上是广延的，并且仅通过 $V = N v$ 依赖于 $N$，所以对于足够大的 $N$，这两个估计值应在数值误差范围内一致。\n\n为每个测试参数集实现一个执行以下步骤的程序：\n- 对 $V$ 最小化 $G(V;T,p,N)$ 以获得单位为电子伏特的 $G(T,p,N)$。\n- 通过计算 $G(T,p,N+1)$ 和 $G(T,p,N-1)$ 来计算中心有限差分估计 $\\mu_{\\text{fd}}(T,p,N)$，单位为电子伏特。\n- 对 $v$ 最小化 $g(v;T,p)$ 以获得 $\\mu_{\\text{th}}(T,p)$，单位为电子伏特。\n- 报告绝对差 $|\\mu_{\\text{fd}} - \\mu_{\\text{th}}|$（单位为电子伏特）作为测试指标。\n\n物理常数和单位：\n- 使用 $k_B = 8.617333262145\\times 10^{-5}\\,\\text{eV/K}$。\n- 所有能量以电子伏特表示，所有体积以 $\\text{\\AA}^3$ 表示，压力以 $\\text{GPa}$ 表示，并使用 $1\\,\\text{GPa} = \\left(1/160.21766208\\right)\\,\\text{eV}/\\text{\\AA}^3$ 转换为 $\\text{eV}/\\text{\\AA}^3$。\n- 所有温度单位为开尔文。\n- 不出现角度单位。\n\n测试套件：\n为以下参数集提供结果，这些参数集共同测试了谐振极限、准谐效应、低温行为、有限尺寸效应和非谐校正。在每个元组中，参数顺序为 $(T, p, N, \\gamma, a_{\\text{anh}})$：\n- 案例 1：$(300, 0, 1000, 0.0, 0.0)$。\n- 案例 2：$(800, 5, 2000, 1.5, 0.0)$。\n- 案例 3：$(1, 0, 1000, 1.0, 0.0)$。\n- 案例 4：$(500, 2, 50, 1.5, 0.0)$。\n- 案例 5：$(800, 5, 1500, 1.5, 0.02)$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含按顺序排列的测试案例的绝对差，形式为逗号分隔的列表，用方括号括起来，单位为电子伏特，不打印单位，例如：\n$$\\text{[}\\mu_1,\\mu_2,\\mu_3,\\mu_4,\\mu_5\\text{]}.$$", "solution": "该问题要求推导单组分系统中化学势 $\\mu$ 的热力学恒等式，并随后使用一个特定的晶体物理模型对该恒等式进行计算测试。验证将通过两种独立的方法计算 $\\mu$ 并比较结果来执行。\n\n### 1. 第一性原理推导\n\n分析始于热力学的基本定义。吉布斯自由能 $G$ 是根据内能 $U$、压力 $p$、体积 $V$、温度 $T$ 和熵 $S$ 定义的：\n$$G = U + pV - TS$$\n通过应用乘积法则可获得全微分 $dG$：\n$$dG = dU + p\\,dV + V\\,dp - T\\,dS - S\\,dT$$\n单组分系统的基本热力学关系给出了内能 $dU$ 关于 $S$、$V$ 和粒子数 $N$ 的微分：\n$$dU = T\\,dS - p\\,dV + \\mu\\,dN$$\n其中 $\\mu$ 是化学势。\n\n将 $dU$ 的表达式代入 $dG$ 的微分式中，得到：\n$$dG = (T\\,dS - p\\,dV + \\mu\\,dN) + p\\,dV + V\\,dp - T\\,dS - S\\,dT$$\n消去 $T\\,dS$ 和 $p\\,dV$ 项可将表达式简化为：\n$$dG = -S\\,dT + V\\,dp + \\mu\\,dN$$\n这是以其自然变量 $G(T, p, N)$ 表示的吉布斯自由能的全微分。根据定义，$G$ 对其自然变量的偏导数是相应微分的系数。因此，我们可以直接将化学势确定为在恒定温度和压力下，吉布斯自由能对粒子数的偏导数：\n$$\\mu = \\left(\\frac{\\partial G}{\\partial N}\\right)_{T,p}$$\n这正是待计算验证的核心恒等式。\n\n### 2. 计算验证策略\n\n问题提出了两种独立的方法来计算模型固体的化学势，从而可以对推导出的恒等式进行稳健的测试。\n\n**方法1：有限差分近似 ($\\mu_{\\text{fd}}$)**\n该方法使用中心有限差分公式直接近似偏导数 $(\\partial G/\\partial N)_{T,p}$。对于粒子数的离散变化 $\\Delta N=1$，其由下式给出：\n$$\\mu_{\\text{fd}}(T,p,N) \\approx \\frac{G(T,p,N+1) - G(T,p,N-1)}{2}$$\n为了计算这个值，必须首先找到三种不同系统尺寸下的平衡吉布斯自由能 $G(T,p,N_c)$：$N_c = N-1$、$N$ 和 $N+1$。对于给定的一组 $(T, p, N_c)$，通过对非平衡函数 $G(V; T,p,N_c)$ 关于体积 $V$ 进行最小化来找到平衡吉布斯自由能：\n$$G(T,p,N_c) = \\min_{V>0} G(V; T,p,N_c)$$\n\n**方法2：热力学极限 ($\\mu_{\\text{th}}$)**\n该方法利用了这样一个事实：对于足够大的系统（接近热力学极限），吉布斯自由能 $G$ 是一个广延性质，意味着它是一个关于粒子数 $N$ 的一次齐次函数。根据欧拉齐次函数定理，可以得出 $G(T,p,N) = N \\cdot (\\partial G/\\partial N)_{T,p}$。将此与我们关于 $\\mu$ 的恒等式结合，我们发现：\n$$G(T,p,N) = N\\mu$$\n因此，化学势就是单位粒子的吉布斯自由能：\n$$\\mu(T,p) = \\frac{G(T,p,N)}{N} = g(T,p)$$\n单位粒子的强度吉布斯自由能 $g(T,p)$ 是通过将吉布斯自由能密度 $g(v; T,p)$ 对单位粒子的比容 $v=V/N$ 进行最小化而得到的。\n$$\\mu_{\\text{th}}(T,p) = \\min_{v>0} g(v; T,p)$$\n对于大的 $N$，$\\mu_{\\text{fd}}$ 和 $\\mu_{\\text{th}}$ 的等价性为理论框架和计算实现提供了一个强有力的一致性检验。\n\n### 3. 物理模型和能量分量\n\n需要对体积进行最小化的总吉布斯自由能是静态、振动和非谐贡献之和，再加上压力-体积项：\n$$G(V;T,p,N) = U_{\\text{stat}}(V,N) + F_{\\text{vib}}(T,V,N) + \\Delta F_{\\text{anh}}(T,V,N) + pV$$\n此处，$F_{\\text{vib}}$ 和 $\\Delta F_{\\text{anh}}$ 是亥姆霍兹自由能，它们是在固定 $(T,V)$ 条件下的适当振动贡献。\n\n**a) 静态弹性能 ($U_{\\text{stat}}$)**\n静态能量将晶体建模为弹性连续介质，能量因压缩或膨胀而储存。它由围绕平衡体积 $V_0 = N v_0$ 的二次展开给出：\n$$U_{\\text{stat}}(V,N) = \\frac{K_0}{2 N v_0} (V - N v_0)^2$$\n其中 $v_0$ 是单位粒子的平衡体积，$K_0$ 是零温零压下的体积模量。\n\n**b) 振动亥姆霍兹自由能 ($F_{\\text{vib}}$)**\n振动贡献使用德拜理论建模。亥姆霍兹自由能是振动态密度 $g(\\omega)$ 的积分：\n$$F_{\\text{vib}}(T,V,N) = \\int_{0}^{\\omega_D} g(\\omega) \\left[\\frac{1}{2}\\hbar \\omega + k_B T \\ln\\left(1 - e^{-\\hbar \\omega/(k_B T)}\\right)\\right] d\\omega$$\n利用德拜态密度 $g(\\omega) = 9N\\omega^2/\\omega_D^3$，并代入德拜温度 $\\Theta_D = \\hbar\\omega_D/k_B$，该积分可以重写。通过将积分变量更改为 $x = \\hbar\\omega/(k_B T)$，我们得到：\n$$F_{\\text{vib}}(T, \\Theta_D, N) = \\frac{9}{8} N k_B \\Theta_D + 9 N k_B T \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_{0}^{\\Theta_D/T} x^2 \\ln(1 - e^{-x}) dx$$\n第一项是零点能（ZPE），第二项是热振动，需要进行数值积分。\n\n**c) 准谐效应和非谐效应**\n准谐近似（QHA）引入了振动频率的体积依赖性，通过德拜温度的 Grüneisen 标度关系进行建模：\n$$\\Theta_D(V,N) = \\Theta_{D0} \\left(\\frac{V}{N v_0}\\right)^{-\\gamma}$$\n其中 $\\gamma$ 是 Grüneisen 参数，$\\Theta_{D0}$ 是 $V=V_0$ 时的参考德拜温度。\n还包括一个微扰非谐校正项：\n$$\\Delta F_{\\text{anh}}(T,V,N) = a_{\\text{anh}}\\, N\\, k_B T \\left(\\frac{T}{\\Theta_D(V,N)}\\right)^2$$\n\n### 4. 数值实现\n\n计算过程涉及实现能量函数，并使用数值例程进行优化和积分。\n\n**对于 $\\mu_{\\text{th}}$:**\n1.  构造单位粒子吉布斯自由能的函数 $g(v; T,p)$：\n    $$g(v; T,p) = u_{\\text{stat}}(v) + f_{\\text{vib}}(T, \\Theta_D(v)) + \\Delta f_{\\text{anh}}(T, \\Theta_D(v)) + pv$$\n    其中 $u_{stat}$、$f_{vib}$ 和 $\\Delta f_{anh}$ 是从其广延对应项派生的单位粒子能量项。例如，$u_{\\text{stat}}(v) = \\frac{K_0}{2 v_0}(v - v_0)^2$。\n2.  在一个物理合理的范围内（例如，使用 `scipy.optimize.minimize_scalar`），对 $g(v; T,p)$ 关于 $v$ 进行数值最小化。该函数的最小值 `result.fun` 即为 $\\mu_{\\text{th}}$。\n\n**对于 $\\mu_{\\text{fd}}$:**\n1.  构造总吉布斯自由能函数 $G(V; T,p,N_c)$。\n2.  对于每个粒子数 $N_c \\in \\{N-1, N, N+1\\}$，对 $G(V; T,p,N_c)$ 关于 $V$ 进行数值最小化，以找到平衡值 $G(T,p,N-1)$ 和 $G(T,p,N+1)$。\n3.  应用中心差分公式获得 $\\mu_{\\text{fd}}$。\n\n$F_{\\text{vib}}$ 热部分的积分是使用像 `scipy.integrate.quad` 这样的数值求积例程计算的。所有物理常数和单位都按照规定转换为一个一致的体系（能量为 eV，长度为 Å）。然后，绝对差 $|\\mu_{\\text{fd}} - \\mu_{\\text{th}}|$ 作为计算测试的最终指标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Computes the chemical potential of a model solid using two independent methods\n    and reports the absolute difference between them for several test cases.\n    \"\"\"\n    # Physical constants and conversion factors\n    KB_EV_K = 8.617333262145e-5  # Boltzmann constant in eV/K\n    P_CONV = 1.0 / 160.21766208  # Conversion from GPa to eV/Å^3\n    \n    # Model parameters\n    V0_PER_PARTICLE = 16.0  # Å^3\n    K0_GPA = 100.0  # GPa\n    THETA_D0_K = 300.0  # K\n\n    def vib_integrand(x):\n        \"\"\"Integrand for the thermal part of the Debye vibrational free energy.\"\"\"\n        # Integrand is x^2 * ln(1 - exp(-x))\n        if x == 0:\n            return 0.0\n        # Use np.log1p for better precision with small arguments\n        return x**2 * np.log1p(-np.exp(-x))\n\n    def calculate_F_vib(T, Theta_D, N):\n        \"\"\"Calculates the vibrational Helmholtz free energy F_vib (ZPE + thermal).\"\"\"\n        if N == 0:\n            return 0.0\n        \n        # Zero-point energy (ZPE)\n        zpe = (9.0 / 8.0) * N * KB_EV_K * Theta_D\n\n        if T  1e-6:  # Effectively T=0\n            return zpe\n\n        # Thermal contribution\n        y = Theta_D / T\n        integral_val, _ = integrate.quad(vib_integrand, 0, y)\n        \n        thermal_energy = 9.0 * N * KB_EV_K * T * (T / Theta_D)**3 * integral_val\n        \n        return zpe + thermal_energy\n\n    def get_G_vs_V(V, T, p_gpa, N, gamma, a_anh):\n        \"\"\"Calculates Gibbs free energy G(V; T, p, N) for a given volume V.\"\"\"\n        if V = 0:\n            return np.inf\n\n        # Static energy\n        V0 = N * V0_PER_PARTICLE\n        U_stat = (K0_GPA * P_CONV) / (2.0 * V0) * (V - V0)**2\n\n        # QHA for Debye temperature\n        Theta_D = THETA_D0_K * (V / V0)**(-gamma)\n        \n        if Theta_D = 0:\n            return np.inf\n\n        # Vibrational free energy\n        F_vib = calculate_F_vib(T, Theta_D, N)\n        \n        # Anharmonic correction\n        dF_anh = a_anh * N * KB_EV_K * T * (T / Theta_D)**2 if T > 1e-6 else 0.0\n\n        # Total Gibbs potential\n        return U_stat + F_vib + dF_anh + (p_gpa * P_CONV) * V\n\n    def calculate_G(T, p_gpa, N, gamma, a_anh):\n        \"\"\"Finds equilibrium G(T, p, N) by minimizing G(V; ...) over V.\"\"\"\n        if N == 0:\n            return 0.0\n        \n        obj_func = lambda V: get_G_vs_V(V, T, p_gpa, N, gamma, a_anh)\n        \n        # Set a reasonable search bracket for volume\n        search_min_V = 0.5 * N * V0_PER_PARTICLE\n        search_max_V = 1.5 * N * V0_PER_PARTICLE\n        \n        res = optimize.minimize_scalar(obj_func, bounds=(search_min_V, search_max_V), method='bounded')\n        return res.fun\n\n    def calculate_mu_fd(T, p_gpa, N, gamma, a_anh):\n        \"\"\"Calculates chemical potential via finite difference.\"\"\"\n        G_Np1 = calculate_G(T, p_gpa, N + 1, gamma, a_anh)\n        G_Nm1 = calculate_G(T, p_gpa, N - 1, gamma, a_anh)\n        return (G_Np1 - G_Nm1) / 2.0\n\n    def get_g_vs_v(v, T, p_gpa, gamma, a_anh):\n        \"\"\"Calculates Gibbs free energy per particle g(v; T, p) for a given specific volume v.\"\"\"\n        if v = 0:\n            return np.inf\n\n        # Static energy per particle\n        u_stat = (K0_GPA * P_CONV) / (2.0 * V0_PER_PARTICLE) * (v - V0_PER_PARTICLE)**2\n\n        # QHA for Debye temperature\n        Theta_D = THETA_D0_K * (v / V0_PER_PARTICLE)**(-gamma)\n        \n        if Theta_D = 0:\n            return np.inf\n\n        # F_vib per particle is computed with N=1 in calculate_F_vib\n        f_vib = calculate_F_vib(T, Theta_D, 1)\n\n        # Anharmonic correction per particle\n        df_anh = a_anh * KB_EV_K * T * (T / Theta_D)**2 if T > 1e-6 else 0.0\n\n        return u_stat + f_vib + df_anh + (p_gpa * P_CONV) * v\n\n    def calculate_mu_th(T, p_gpa, gamma, a_anh):\n        \"\"\"Calculates chemical potential via minimization of per-particle energy.\"\"\"\n        obj_func = lambda v: get_g_vs_v(v, T, p_gpa, gamma, a_anh)\n        \n        search_min_v = 0.5 * V0_PER_PARTICLE\n        search_max_v = 1.5 * V0_PER_PARTICLE\n\n        res = optimize.minimize_scalar(obj_func, bounds=(search_min_v, search_max_v), method='bounded')\n        return res.fun\n\n    test_cases = [\n        # (T, p, N, gamma, a_anh)\n        (300, 0, 1000, 0.0, 0.0),   # Harmonic limit\n        (800, 5, 2000, 1.5, 0.0),   # QHA, high T, large N\n        (1, 0, 1000, 1.0, 0.0),    # Low T limit\n        (500, 2, 50, 1.5, 0.0),     # QHA, small N (finite-size test)\n        (800, 5, 1500, 1.5, 0.02)   # Anharmonic correction\n    ]\n\n    results = []\n    for case in test_cases:\n        T, p, N, gamma, a_anh = case\n        \n        mu_fd = calculate_mu_fd(T, p, N, gamma, a_anh)\n        mu_th = calculate_mu_th(T, p, gamma, a_anh)\n        \n        diff = np.abs(mu_fd - mu_th)\n        results.append(diff)\n\n    print(f\"[{','.join(f'{r:.10e}' for r in results)}]\")\n\nsolve()\n```", "id": "3436902"}]}