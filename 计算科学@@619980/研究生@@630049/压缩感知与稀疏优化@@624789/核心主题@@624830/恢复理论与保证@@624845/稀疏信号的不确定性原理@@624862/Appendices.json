{"hands_on_practices": [{"introduction": "不确定性原理不仅是一个模糊的概念，更是一个可以被精确定量的基本限制。本练习将指导你计算一个关键量——时域和频域基之间的“互相关性”（mutual coherence）。然后，你将利用这个值来推导著名的Donoho-Stark不确定性原理，为理解稀疏信号的本质奠定坚实的数学基础。[@problem_id:3491665]", "problem": "考虑复向量空间 $\\mathbb{C}^{n}$，其标准正交基为 $I=\\{e_{0},e_{1},\\dots,e_{n-1}\\}$，其中每个 $e_{i}$ 在索引 $i$ 处为 $1$，其他位置为 $0$。令 $F=\\{f_{0},f_{1},\\dots,f_{n-1}\\}$ 表示与酉离散傅里叶变换 (DFT) 相关的离散傅里叶基，其中每个 $f_{k}\\in\\mathbb{C}^{n}$ 的分量为 $f_{k}[j] = n^{-1/2}\\exp(2\\pi \\mathrm{i} j k / n)$，对于 $j=0,1,\\dots,n-1$，并且集合 $\\{f_{k}\\}$ 构成一个正交基。$\\mathbb{C}^{n}$ 中两个正交基 $U=\\{u_{i}\\}$ 和 $V=\\{v_{j}\\}$ 之间的互相关性 $\\mu(U,V)$ 定义为\n$$\n\\mu(U,V) \\triangleq \\max_{i,j} \\left| \\langle u_{i}, v_{j} \\rangle \\right|,\n$$\n其中 $\\langle \\cdot, \\cdot \\rangle$ 是 $\\mathbb{C}^{n}$ 上的标准内积。\n\n计算互相关性 $\\mu(I,F)$，并以 $n$ 的闭式解析表达式表示。然后，从上述关于正交基、内积和互相关性的核心定义出发，解释该值如何量化在 $I$ 和 $F$ 中表示的稀疏信号的不确定性原理，特别是时域中非零系数数量与频域中非零系数数量之间的权衡关系。你最终计算出的相干性必须用含 $n$ 的符号表示；无需进行数值近似或舍入。", "solution": "所述问题形式上是合理的、自洽的，并且基于线性代数和信号处理的既定原则。所有术语都有明确的定义，任务在程序上是清晰的。因此，该问题被认为是有效的，并将提供解答。\n\n该问题包含两部分。首先，我们必须计算复向量空间 $\\mathbb{C}^{n}$ 中标准正交基 $I$ 和离散傅里叶基 $F$ 之间的互相关性 $\\mu(I,F)$。其次，我们必须解释该值如何量化支配稀疏信号表示的不确定性原理。\n\n让我们从第一部分开始：计算互相关性 $\\mu(I,F)$。\n标准正交基为 $I=\\{e_{0},e_{1},\\dots,e_{n-1}\\}$，其中每个向量 $e_{i} \\in \\mathbb{C}^{n}$ 由其分量 $e_{i}[j] = \\delta_{ij}$ 定义，对于 $j=0,1,\\dots,n-1$。此处，$\\delta_{ij}$ 是克罗内克 δ (Kronecker delta)，当 $i=j$ 时为 $1$，否则为 $0$。\n离散傅里叶基为 $F=\\{f_{0},f_{1},\\dots,f_{n-1}\\}$，其中每个向量 $f_{k} \\in \\mathbb{C}^{n}$ 由其分量 $f_{k}[j] = n^{-1/2}\\exp(2\\pi \\mathrm{i} j k / n)$ 定义，对于 $j=0,1,\\dots,n-1$。\n这两个正交基之间的互相关性定义为\n$$\n\\mu(I,F) \\triangleq \\max_{i,k} \\left| \\langle e_{i}, f_{k} \\rangle \\right|\n$$\n其中索引 $i$ 和 $k$ 的范围是从 $0$ 到 $n-1$。$\\mathbb{C}^{n}$ 上的内积 $\\langle \\cdot, \\cdot \\rangle$ 是标准复内积，由 $\\langle x, y \\rangle = \\sum_{j=0}^{n-1} x[j] \\overline{y[j]}$ 给出。\n\n为了计算 $\\mu(I,F)$，我们必须首先计算任意基向量 $e_i \\in I$ 和 $f_k \\in F$ 之间的内积 $\\langle e_{i}, f_{k} \\rangle$。\n$$\n\\langle e_{i}, f_{k} \\rangle = \\sum_{j=0}^{n-1} e_{i}[j] \\overline{f_{k}[j]}\n$$\n代入分量定义，我们得到：\n$$\n\\langle e_{i}, f_{k} \\rangle = \\sum_{j=0}^{n-1} \\delta_{ij} \\overline{\\left( n^{-1/2}\\exp\\left(\\frac{2\\pi \\mathrm{i} j k}{n}\\right) \\right)}\n$$\n$f_k[j]$ 的复共轭是 $\\overline{f_{k}[j]} = n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} j k}{n}\\right)$。由于克罗内克 δ $\\delta_{ij}$ 的存在，该求和仅在 $j=i$ 的项上非零。这将求和简化为单个项：\n$$\n\\langle e_{i}, f_{k} \\rangle = 1 \\cdot \\left( n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right) \\right) = n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right)\n$$\n接下来，我们取该复数的绝对值：\n$$\n\\left| \\langle e_{i}, f_{k} \\rangle \\right| = \\left| n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right) \\right|\n$$\n复数乘积的模等于它们模的乘积。由于 $n$ 是一个正整数，所以 $|n^{-1/2}| = n^{-1/2}$。指数项的形式为 $\\exp(\\mathrm{i}\\theta)$，其中 $\\theta$ 是一个实数。这种项的模总是 $1$，因为 $|\\exp(\\mathrm{i}\\theta)| = |\\cos(\\theta) + \\mathrm{i}\\sin(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\sin^2(\\theta)} = 1$。\n因此，对于任意选择的 $i, k \\in \\{0, 1, \\dots, n-1\\}$：\n$$\n\\left| \\langle e_{i}, f_{k} \\rangle \\right| = n^{-1/2} \\cdot 1 = \\frac{1}{\\sqrt{n}}\n$$\n互相关性是这些值在所有 $i$ 和 $k$ 上的最大值。由于值 $1/\\sqrt{n}$ 对于所有基向量对都是恒定的，最大值就是这个值本身。\n$$\n\\mu(I,F) = \\max_{i,k} \\left( \\frac{1}{\\sqrt{n}} \\right) = \\frac{1}{\\sqrt{n}}\n$$\n\n现在，对于第二部分，我们解释这个结果如何量化稀疏信号的不确定性原理。\n如果一个信号 $x \\in \\mathbb{C}^{n}$ 的大部分分量为零，则称其为稀疏的。信号的稀疏性由 $\\ell_0$ 伪范数 $\\|x\\|_0$ 衡量，它计算向量 $x$ 中非零项的数量。设 $x$ 在标准基 $I$ 中的表示为系数向量 $\\alpha$，其中 $\\alpha_i = \\langle x, e_i \\rangle$。这正是向量 $x$ 本身，所以非零“时域”系数的数量是 $\\|x\\|_0$。设 $x$ 在傅里叶基 $F$ 中的表示为系数向量 $\\beta$，其中 $\\beta_k = \\langle x, f_k \\rangle$。这是 $x$ 的离散傅里叶变换 (DFT)，通常表示为 $\\hat{x}$。非零“频域”系数的数量是 $\\|\\hat{x}\\|_0$。\n\n在此背景下，不确定性原理指出，一个非零信号不能同时在时域（基 $I$）和频域（基 $F$）中都是稀疏的。互相关性为这一原理提供了精确的、定量的表述。Donoho 和 Stark 的一个著名结果为两个不同正交基中稀疏度的乘积建立了一个下界。对于任何非零信号 $x \\in \\mathbb{C}^n$，其在基 $I$ 中的稀疏度（表示为 $\\|x\\|_0$）和在基 $F$ 中的稀疏度（表示为 $\\|\\hat{x}\\|_0$）由以下不等式关联：\n$$\n\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge \\frac{1}{\\mu(I,F)^2}\n$$\n为了证明这一点，令 $S_I = \\mathrm{supp}(x) = \\{i \\mid x_i \\neq 0\\}$ 为 $x$ 在时域中的支撑集，因此 $\\|x\\|_0 = |S_I|$。令 $S_F = \\mathrm{supp}(\\hat{x}) = \\{k \\mid \\hat{x}_k \\neq 0\\}$ 为 $\\hat{x}$ 在频域中的支撑集，因此 $\\|\\hat{x}\\|_0 = |S_F|$。\n信号 $x$ 可以在基 $F$ 中表示为 $x = \\sum_{k \\in S_F} \\hat{x}_k f_k$。\n$x$ 在时域中的分量是 $x_i = \\langle x, e_i \\rangle$。对于任何 $i \\in S_I$：\n$$\nx_i = \\left\\langle \\sum_{k \\in S_F} \\hat{x}_k f_k, e_i \\right\\rangle = \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle\n$$\n根据帕塞瓦尔恒等式 (Parseval's identity)，信号的能量在两个域中是相同的：$\\|x\\|_2^2 = \\sum_{i \\in S_I} |x_i|^2 = \\|\\hat{x}\\|_2^2 = \\sum_{k \\in S_F} |\\hat{x}_k|^2$。\n让我们考虑时域分量模的平方和：\n$$\n\\sum_{i \\in S_I} |x_i|^2 = \\sum_{i \\in S_I} \\left| \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle \\right|^2\n$$\n对关于 $k$ 的内层求和应用柯西-施瓦茨不等式 (Cauchy-Schwarz inequality)：\n$$\n\\left| \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle \\right|^2 \\le \\left( \\sum_{k \\in S_F} |\\hat{x}_k|^2 \\right) \\left( \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2 \\right) = \\|\\hat{x}\\|_2^2 \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2\n$$\n对 $i \\in S_I$ 求和并使用 $\\|x\\|_2^2 = \\|\\hat{x}\\|_2^2$：\n$$\n\\|x\\|_2^2 \\le \\sum_{i \\in S_I} \\left( \\|\\hat{x}\\|_2^2 \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2 \\right)\n$$\n因为 $x$ 非零，所以 $\\|x\\|_2^2  0$，我们可以用它来除：\n$$\n1 \\le \\sum_{i \\in S_I} \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2\n$$\n根据定义， $|\\langle f_k, e_i \\rangle| = |\\langle e_i, f_k \\rangle| \\le \\mu(I,F)$。代入这个上界：\n$$\n1 \\le \\sum_{i \\in S_I} \\sum_{k \\in S_F} \\mu(I,F)^2 = |S_I| \\cdot |S_F| \\cdot \\mu(I,F)^2 = \\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\cdot \\mu(I,F)^2\n$$\n重新整理得到所要的不等式。\n代入我们计算出的值 $\\mu(I,F) = 1/\\sqrt{n}$：\n$$\n\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge \\frac{1}{(1/\\sqrt{n})^2} = n\n$$\n这个结果 $\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge n$ 是不确定性原理的一个有力陈述。它表明，对于任何非平凡信号，非零时间系数的数量与非零频率系数的数量的乘积，其下界为信号空间的维度 $n$。如果一个信号在一个域中高度局域化（例如，$\\|x\\|_0$ 很小），那么为了满足这个不等式，它必须在另一个域中高度离散化或非局域化（即，$\\|\\hat{x}\\|_0$ 必须很大）。\n例如，如果一个信号是时域中的单个脉冲，$x=e_i$，那么 $\\|x\\|_0=1$。不确定性原理要求 $\\|\\hat{x}\\|_0 \\ge n$。实际上，$e_i$ 的 DFT 在所有频率上其分量的模都为常数 $1/\\sqrt{n}$，所以 $\\|\\hat{x}\\|_0=n$。反之，一个纯频率信号 $x=f_k$ 有 $\\|\\hat{x}\\|_0=1$，这迫使 $\\|x\\|_0 \\ge n$，并且实际上其所有时域分量的模都为 $1/\\sqrt{n}$。互相关性 $\\mu(I,F)$ 精确地设定了这种基本权衡关系的尺度。$1/\\sqrt{n}$ 的值是 $\\mathbb{C}^n$ 中任意两个正交基之间可能达到的最小相干性，这表明标准基和傅里叶基是最大程度不相干的，这反过来又导致了这种形式下最强的不确定性原理。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{n}}}\n$$", "id": "3491665"}, {"introduction": "在建立了一个理论下界之后，一个自然的问题是：这个界限能否被达到？本练习通过一个构造性的任务回答了这个问题，即构建一个恰好位于不确定性边界上的特定信号。这个过程不仅证明了该理论界限是“紧”的，而且揭示了那些在给定约束下达到“最大确定性”的信号所具有的特殊结构。[@problem_id:3491677]", "problem": "设 $n \\in \\mathbb{N}$ 为合数，设 $d \\in \\mathbb{N}$ 为 $n$ 的一个因子。定义 $m := n/d$。考虑循环索引集 $\\{0,1,\\dots,n-1\\}$ 以及在 $\\mathbb{C}^{n}$ 上的离散傅里叶变换（DFT），对于 $x \\in \\mathbb{C}^{n}$ 定义为\n$$\n\\hat{x}_{k} := \\sum_{j=0}^{n-1} x_{j} \\exp\\!\\left(-2 \\pi \\mathrm{i} \\frac{j k}{n}\\right), \\quad k \\in \\{0,1,\\dots,n-1\\}.\n$$\n向量 $x \\in \\mathbb{C}^{n}$ 的支撑集为 $\\operatorname{supp}(x) := \\{j \\in \\{0,\\dots,n-1\\} : x_{j} \\neq 0\\}$，其基数为 $|\\operatorname{supp}(x)|$。仅从上述定义和基本的等比数列求和公式出发，构造一个显式的 $x \\in \\mathbb{C}^{n}$，使得 $|\\operatorname{supp}(x)| = d$ 且 $|\\operatorname{supp}(\\hat{x})| = n/d$，并验证精确的乘积等式 $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$。不要假设或引用任何专门的不确定性原理公式；从第一性原理推导所有结论。提供乘积 $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$ 的闭式值作为你的最终答案。无需四舍五入，也不涉及单位。", "solution": "首先对问题进行验证。\n\n### 第1步：提取已知条件\n- $n \\in \\mathbb{N}$ 是一个合数。\n- $d \\in \\mathbb{N}$ 是 $n$ 的一个因子。\n- $m := n/d$。\n- 索引集为 $\\{0,1,\\dots,n-1\\}$。\n- 在 $\\mathbb{C}^{n}$ 上的离散傅里叶变换（DFT）对于 $x \\in \\mathbb{C}^{n}$ 定义为 $\\hat{x}_{k} := \\sum_{j=0}^{n-1} x_{j} \\exp(-2 \\pi \\mathrm{i} \\frac{j k}{n})$，其中 $k \\in \\{0,1,\\dots,n-1\\}$。\n- 向量 $x \\in \\mathbb{C}^{n}$ 的支撑集为 $\\operatorname{supp}(x) := \\{j \\in \\{0,\\dots,n-1\\} : x_{j} \\neq 0\\}$。\n- 任务是仅使用给定的定义和等比数列求和公式，构造一个显式的 $x \\in \\mathbb{C}^{n}$，使得 $|\\operatorname{supp}(x)| = d$ 且 $|\\operatorname{supp}(\\hat{x})| = n/d$。\n- 任务包括验证乘积等式 $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$。\n- 最终答案是该乘积的闭式值。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上和数学上是合理的。它涉及信号处理和傅里叶分析中的标准概念，即离散傅里叶变换和向量稀疏性。所提供的定义是标准的。问题是适定的，要求构造一个具有可验证性质的特定数学对象。它是自洽的，提供了所有必要的定义，并指定了允许使用的工具（第一性原理和等比数列求和公式）。问题是客观的，没有歧义、矛盾或未说明的假设。它代表了一个有效且可形式化的数学挑战。\n\n### 第3步：结论与行动\n问题有效。将提供完整的解答。\n\n目标是构造一个向量 $x \\in \\mathbb{C}^{n}$，使其支撑集大小为 $|\\operatorname{supp}(x)| = d$，其DFT的支撑集大小为 $|\\operatorname{supp}(\\hat{x})| = m = n/d$。\n\n我们通过指定其分量 $x_j$（其中 $j \\in \\{0, 1, \\dots, n-1\\}$）来定义向量 $x$。我们构造一个仅在索引是 $m=n/d$ 的倍数处非零的信号。具体来说，我们将这些非零值设为 $1$。\n设 $x$ 的分量定义如下：\n$$\nx_j :=\n\\begin{cases}\n1  \\text{如果 } j \\text{ 是 } m \\text{ 的倍数，即 } j \\in \\{0, m, 2m, \\dots, (d-1)m\\} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n这可以更正式地写成克罗内克δ函数的和：$x_j = \\sum_{l=0}^{d-1} \\delta_{j, l \\cdot m}$。\n\n首先，我们确定 $x$ 的支撑集。根据定义，$x$ 的支撑集是 $x_j \\neq 0$ 的索引 $j$ 的集合。根据我们的构造：\n$$\n\\operatorname{supp}(x) = \\{l \\cdot m \\mid l \\in \\{0, 1, \\dots, d-1\\}\\} = \\{0, m, 2m, \\dots, (d-1)m\\}\n$$\n由于 $d$ 是 $n$ 的因子，$m=n/d$ 是一个整数。这个集合中的最大索引是 $(d-1)m = (d-1)\\frac{n}{d} = n - \\frac{n}{d} = n - m$。由于 $d$ 整除 $n$ 且 $n$ 是合数，我们有 $d \\ge 2$ 或 $d=1$。如果 $d=1$，$m=n$，该集合仅为 $\\{0\\}$。如果 $d1$，则 $m  n$。在所有情况下，集合中的所有索引都是不同的，并且属于 $\\{0, 1, \\dots, n-1\\}$。该集合中的元素数量为 $d$。因此，我们验证了\n$$\n|\\operatorname{supp}(x)| = d\n$$\n\n接下来，我们计算 $x$ 的DFT，记为 $\\hat{x}$。$\\hat{x}$ 的第 $k$ 个分量由定义给出：\n$$\n\\hat{x}_k = \\sum_{j=0}^{n-1} x_j \\exp\\left(-2 \\pi \\mathrm{i} \\frac{j k}{n}\\right)\n$$\n代入我们构造的 $x$，该和仅在 $x$ 的支撑集中的索引 $j$ 处非零。我们可以将求和重新索引为对 $l$ 从 $0$ 到 $d-1$ 求和，其中 $j = l \\cdot m$：\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} x_{l \\cdot m} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{(l \\cdot m) k}{n}\\right)\n$$\n由于 $x_{l \\cdot m} = 1$ 且 $m = n/d$，这可以简化为：\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{l \\cdot (n/d) \\cdot k}{n}\\right) = \\sum_{l=0}^{d-1} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{lk}{d}\\right)\n$$\n这是一个首项为 $a=1$，公比为 $r = \\exp(-2 \\pi \\mathrm{i} \\frac{k}{d})$，共有 $d$ 项的有限等比数列。我们根据 $r$ 的值来分析这个和。\n\n情况1：$r = 1$。\n当指数是 $2 \\pi \\mathrm{i}$ 的整数倍时，会发生这种情况。\n$$\n\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) = 1 \\iff \\frac{k}{d} \\in \\mathbb{Z}\n$$\n这意味着 $k$ 必须是 $d$ 的倍数。设 $k = q \\cdot d$，其中 $q$ 为某个整数。由于 $k \\in \\{0, 1, \\dots, n-1\\}$，$q$ 的可能取值为 $\\{0, 1, \\dots, m-1\\}$，其中 $m=n/d$。对于这些 $k$ 值，公比 $r=1$，和就等于项数：\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} 1 = d\n$$\n所以，对于 $k \\in \\{0, d, 2d, \\dots, (m-1)d\\}$，我们有 $\\hat{x}_k = d \\neq 0$。\n\n情况2：$r \\neq 1$。\n当 $k$ 不是 $d$ 的倍数时，会发生这种情况。在这种情况下，我们使用等比数列求和公式：$\\sum_{l=0}^{N-1} r^l = \\frac{r^N - 1}{r - 1}$。这里，$N=d$。\n$$\n\\hat{x}_k = \\frac{\\left(\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right)\\right)^d - 1}{\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) - 1} = \\frac{\\exp(-2 \\pi \\mathrm{i} k) - 1}{\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) - 1}\n$$\n由于 $k$ 是整数，根据欧拉公式有 $\\exp(-2 \\pi \\mathrm{i} k) = \\cos(-2\\pi k) + \\mathrm{i}\\sin(-2\\pi k) = 1$。因此，分子为 $1 - 1 = 0$。分母非零，因为我们处于 $r \\neq 1$ 的情况。\n因此，对于所有不是 $d$ 的倍数的 $k$，我们有：\n$$\n\\hat{x}_k = 0\n$$\n\n结合两种情况，$\\hat{x}$ 的分量为：\n$$\n\\hat{x}_k =\n\\begin{cases}\nd  \\text{如果 } k \\text{ 是 } d \\text{ 的倍数} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n$\\hat{x}$ 的支撑集是 $\\hat{x}_k \\neq 0$ 的索引 $k$ 的集合。\n$$\n\\operatorname{supp}(\\hat{x}) = \\{k \\in \\{0, 1, \\dots, n-1\\} \\mid k \\text{ 是 } d \\text{ 的倍数}\\} = \\{q \\cdot d \\mid q \\in \\{0, 1, \\dots, m-1\\}\\}\n$$\n这个集合是 $\\{0, d, 2d, \\dots, (m-1)d\\}$。该集合中的元素数量为 $m$。因此，我们验证了\n$$\n|\\operatorname{supp}(\\hat{x})| = m = \\frac{n}{d}\n$$\n我们成功地构造了一个向量 $x$，并证明了 $|\\operatorname{supp}(x)| = d$ 且 $|\\operatorname{supp}(\\hat{x})| = n/d$。\n\n最后，我们被要求验证乘积等式并提供该乘积的值。\n$$\n|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})| = d \\cdot \\frac{n}{d} = n\n$$\n乘积恰好为 $n$。这个结果是DFT离散不确定性原理的一个特例。\n\n最终答案是这个乘积的闭式值。该乘积为 $n$。", "answer": "$$\n\\boxed{n}\n$$", "id": "3491677"}, {"introduction": "从理论推导和数学构造转向计算验证，可以极大地加深理解。本练习通过编程实验来巩固你对不确定性原理的认识。你将编写一个程序，对随机生成的“通用”稀疏信号和前一个练习中构造的特殊结构信号进行测试，从而通过经验性数据验证理论界限，并对信号结构如何影响其变换域稀疏性形成直观感受。[@problem_id:3491550]", "problem": "考虑有限维复向量空间中稀疏信号的离散不确定性原理。设 $n \\in \\mathbb{N}$，令 $F \\in \\mathbb{C}^{n \\times n}$ 表示酉离散傅里叶变换矩阵，其元素为 $F_{k,\\ell} = \\frac{1}{\\sqrt{n}} e^{-2\\pi i k \\ell / n}$，其中 $k,\\ell \\in \\{0,1,\\dots,n-1\\}$。对于任意向量 $x \\in \\mathbb{C}^n$，定义其支撑集为 $\\operatorname{supp}(x) = \\{j \\in \\{0,\\dots,n-1\\} : x_j \\ne 0\\}$，并令 $s = |\\operatorname{supp}(x)|$。令 $\\hat{x} = Fx$ 且 $t = |\\operatorname{supp}(\\hat{x})|$。傅里叶变换的离散不确定性原理断言了 $s t$ 的一个非平凡下界。\n\n您的任务是编写一个程序，对于一个合成测试（其中 $n = 512$，$U = F$，以及 $s \\in \\{4, 8, 16\\}$），在随机试验下计算 $t$ 的观测值，并将其与下界进行比较。所需的步骤如下：\n\n- 通过快速傅里叶变换实现酉离散傅里叶变换，并使用 $1/\\sqrt{n}$ 进行归一化，以使 $F$ 是酉矩阵。\n- 对于每个稀疏度级别 $s \\in \\{4, 8, 16\\}$：\n  1. 随机试验：\n     - 使用一个固定的伪随机种子，其值等于 $2025$。\n     - 执行 $50$ 次独立试验。在每次试验中，通过从 $\\{0,1,\\dots,n-1\\}$ 中无放回地均匀随机选择一个大小为 $s$ 的支撑集，来生成一个随机的 $s$-稀疏向量 $x \\in \\mathbb{C}^n$，并为其非零项赋予以独立的复高斯分布值，其实部和虚部分别服从 $\\mathcal{N}(0,1)$ 分布。\n     - 计算 $\\hat{x} = F x$ 并通过计数满足 $|\\hat{x}_k|  \\tau$ 的索引 $k$ 的数量来估计 $t$，其中数值容差为 $\\tau = 10^{-10}$。\n     - 对于每次试验，记录不等式 $s \\cdot t \\ge n$ 是否成立。\n     - 在这 $50$ 次试验中，报告观测到的最小 $t$ 值，以及对于该 $s$ 值，不等式是否在所有试验中都成立。\n  2. 边界（等式）情况：\n     - 构建一个确定性的 $s$-稀疏向量 $x \\in \\mathbb{C}^n$，其支撑集等于 $\\mathbb{Z}_n$ 的子群 $H = \\{0, n/s, 2n/s, \\dots, (s-1)n/s\\}$，并且在 $H$ 上 $x_j = 1$，其他位置 $x_j = 0$。\n     - 计算 $\\hat{x} = F x$ 并通过阈值 $|\\hat{x}_k|  \\tau$（其中 $\\tau = 10^{-10}$）来计数 $t$。\n     - 在阈值规则下，检查乘积 $s \\cdot t$ 是否（作为整数）精确等于 $n$。\n- 最终输出规范：\n  - 对于 $s \\in \\{4, 8, 16\\}$ 中的每个值（按升序排列），生成一个包含四个值的列表：\n    - 在 $50$ 次随机试验中观测到的最小 $t$ 值（一个整数）。\n    - 一个布尔值，指示 $s \\cdot t \\ge n$ 是否在所有随机试验中都成立。\n    - 为基于子群的等式构造计算出的 $t$ 值（一个整数）。\n    - 一个布尔值，指示在子群构造中是否观测到等式 $s \\cdot t = n$ 成立。\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个按升序排列的 $s$ 值，并且其本身也是一个用方括号括起来的逗号分隔列表。例如，总体格式为 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$。\n\n在您的推理和实现中使用的基础理论：\n- 矩阵 $F$ 是酉矩阵，因此对于所有 $x \\in \\mathbb{C}^n$ 都有 $\\|F x\\|_2 = \\|x\\|_2$。\n- $F$ 的每个元素的幅值以 $\\mu = 1/\\sqrt{n}$ 为界。\n- 柯西-施瓦茨不等式以及 $\\ell_{\\infty}$、$\\ell_2$ 和支撑集大小之间的关系：对于任何支撑集大小为 $t$ 的向量 $z \\in \\mathbb{C}^n$，有 $\\|z\\|_2^2 \\le t \\|z\\|_{\\infty}^2$。\n\n必须使用的测试套件参数：\n- 维度：$n = 512$。\n- 变换：$U = F$，如上定义。\n- 稀疏度：$s \\in \\{4,8,16\\}$。\n- 每个 $s$ 的随机试验次数：$50$。\n- 随机种子：$2025$。\n- 数值阈值：$\\tau = 10^{-10}$。\n\n此问题不涉及任何物理单位。根据傅里叶变换中指数的定义，角度以弧度为单位。任何地方都不得使用百分比；任何比率都必须表示为小数或分数（如果需要）。", "solution": "该问题要求对有限维空间 $\\mathbb{C}^n$ 中傅里叶变换的离散不确定性原理进行实证研究。该原理在向量 $x$ 的稀疏性与其离散傅里叶变换 $\\hat{x}$ 的稀疏性之间建立了一种基本的权衡关系。具体来说，对于一个稀疏度为 $s = |\\operatorname{supp}(x)|$ 的非零向量 $x \\in \\mathbb{C}^n$ 及其稀疏度为 $t = |\\operatorname{supp}(\\hat{x})|$ 的变换 $\\hat{x} = Fx$，Donoho-Stark 不确定性原理断言 $s \\cdot t \\ge n$。在此，$F$ 是酉离散傅里叶变换（DFT）矩阵，其元素为 $F_{k,\\ell} = \\frac{1}{\\sqrt{n}} e^{-2\\pi i k \\ell / n}$。$F$ 的酉性质意味着能量守恒，即 $\\|x\\|_2 = \\|\\hat{x}\\|_2$，但这本身并不能限制信号及其变换的“扩展”或支撑集大小。不确定性原理提供了这一关键约束。\n\n我们的任务是针对维度 $n=512$ 和信号稀疏度 $s \\in \\{4, 8, 16\\}$ 对该原理进行计算验证。对每个 $s$ 值的验证包括两个部分：一系列用于观察典型行为的随机试验，以及对一个代表达到等式条件的边界情况的特定确定性构造的分析。所有对支撑集大小的数值确定都将使用阈值 $\\tau = 10^{-10}$ 来处理浮点不精确性，即如果 $|z_j|  \\tau$，则分量 $z_j$ 被视为非零。\n\n算法流程如下：\n\n首先，我们处理随机试验。对于每个稀疏度 $s \\in \\{4, 8, 16\\}$，我们执行一组 $50$ 次独立试验。通过将伪随机数生成器的种子设置为 $2025$ 来确保可复现性。在每次试验中：\n1.  生成一个 $s$-稀疏向量 $x \\in \\mathbb{C}^n$。这是通过首先从索引 $\\{0, 1, \\dots, n-1\\}$ 中无放回地均匀随机选择一个大小为 $s$ 的支撑集来实现的。\n2.  然后，用独立的复高斯随机数填充 $x$ 在该支撑集上的 $s$ 个非零项。每个这样的数都形如 $a+ib$，其中实部 $a$ 和虚部 $b$ 是从标准正态分布 $\\mathcal{N}(0,1)$ 中独立抽取的。这种构造模拟了一个通用的、非结构化的稀疏信号。\n3.  使用快速傅里叶变换（FFT）算法高效地计算该向量的DFT，即 $\\hat{x} = Fx$，并通过 $1/\\sqrt{n}$ 进行归一化以匹配 $F$ 的酉定义。带有 `norm='ortho'` 选项的 `scipy.fft.fft` 函数可以直接执行此计算。\n4.  通过计算其分量幅值超过阈值 $\\tau=10^{-10}$ 的数量来估计所得向量 $\\hat{x}$ 的稀疏度 $t$。\n5.  对观测到的 $t$ 检验不等式 $s \\cdot t \\ge n$。对于一个通用的随机信号，我们期望其变换是离域的，意味着其能量分布在大多数频率上。因此，我们预计 $t$ 将接近 $n$，并且该不等式将以很大的余量被满足。\n在 $50$ 次试验后，我们记录观测到的最小 $t$ 值和一个布尔值，该布尔值指示不等式 $s \\cdot t \\ge n$ 是否在所有试验中都成立。\n\n其次，我们分析确定性的边界情况。这种情况表明下界 $s \\cdot t = n$ 是紧的，并且可以通过具有特定结构的信号来实现。对于每个 $s \\in \\{4, 8, 16\\}$，我们构造一个向量 $x$，其支撑集是循环群 $\\mathbb{Z}_n$ 的加法子群 $H = \\{0, n/s, 2n/s, \\dots, (s-1)n/s\\}$。$x$ 在此支撑集上的值设为 $1$，其他位置为 $0$。该支撑集的大小为 $s$。\nDFT 的一个关键性质是，支撑在某个子群上的信号，其变换反过来会支撑在对偶子群上。$H$ 的对偶子群是 $H^\\perp = \\{k \\in \\mathbb{Z}_n : k \\cdot h = 0 \\pmod{n} \\text{ for all } h \\in H\\}$，可以证明它等于 $\\{0, s, 2s, \\dots, (n/s-1)s\\}$。该对偶子群的大小恰好是 $n/s$。\n因此，对于这个特定的构造，$\\hat{x}$ 的理论稀疏度为 $t = n/s$。这导出了等式 $s \\cdot t = s \\cdot (n/s) = n$。我们为该向量计算 $\\hat{x}$，使用阈值 $\\tau$ 确定其数值稀疏度 $t$，并验证等式 $s \\cdot t = n$ 是否成立。\n\n最后，对于每个 $s$ 值，我们整理四个计算结果：随机试验中的最小 $t$ 值，表示不等式在所有试验中是否成立的布尔值，子群构造中的 $t$ 值，以及表示在该情况下等式是否成立的布尔值。然后将这些结果格式化为指定的嵌套列表结构作为最终输出。", "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Empirically investigates the discrete uncertainty principle for the Fourier transform.\n    \"\"\"\n    # Problem parameters\n    n = 512\n    s_values = [4, 8, 16]\n    num_trials = 50\n    seed = 2025\n    tau = 1e-10\n\n    # Initialize a modern pseudo-random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n\n    # List to store the results for each s\n    final_results = []\n\n    for s in s_values:\n        # --- Part 1: Randomized Trials ---\n        \n        t_random_values = []\n        all_trials_passed_inequality = True\n\n        for _ in range(num_trials):\n            # 1. Create a random s-sparse vector x\n            x = np.zeros(n, dtype=complex)\n            \n            # Choose a support of size s uniformly at random without replacement\n            support = rng.choice(n, size=s, replace=False)\n            \n            # Assign independent complex Gaussian entries on the support\n            # Real and imaginary parts are drawn from N(0,1)\n            real_parts = rng.standard_normal(s)\n            imag_parts = rng.standard_normal(s)\n            values = real_parts + 1j * imag_parts\n            x[support] = values\n\n            # 2. Compute the unitary Discrete Fourier Transform\n            # The norm='ortho' option ensures the transform is unitary (1/sqrt(n) scaling)\n            hat_x = fft.fft(x, norm='ortho')\n\n            # 3. Estimate the support size t of hat_x numerically\n            t = np.sum(np.abs(hat_x)  tau)\n            t_random_values.append(t)\n\n            # 4. Check if the uncertainty principle inequality s*t = n holds\n            if s * t  n:\n                all_trials_passed_inequality = False\n\n        # 5. Determine the minimum observed t over all trials\n        min_t_random = int(np.min(t_random_values))\n        \n        # --- Part 2: Boundary (Equality) Case ---\n\n        # 1. Construct the deterministic vector with subgroup support\n        x_subgroup = np.zeros(n, dtype=complex)\n        \n        # Support is the subgroup H = {0, n/s, 2n/s, ...}\n        # Since n is a multiple of s, n//s is an integer.\n        support_subgroup = np.arange(0, n, n // s, dtype=int)\n        x_subgroup[support_subgroup] = 1.0\n\n        # 2. Compute the unitary DFT\n        hat_x_subgroup = fft.fft(x_subgroup, norm='ortho')\n\n        # 3. Count the support size t\n        t_subgroup = int(np.sum(np.abs(hat_x_subgroup)  tau))\n\n        # 4. Check if the equality s*t = n holds\n        subgroup_passed_equality = (s * t_subgroup == n)\n\n        # Collate the four results for the current s\n        current_s_results = [\n            min_t_random,\n            all_trials_passed_inequality,\n            t_subgroup,\n            subgroup_passed_equality\n        ]\n        final_results.append(current_s_results)\n\n    # Format the final output according to the problem specification\n    # e.g., [[val,bool,val,bool],[...],[...]]\n    # The str() function on a list provides the required '[...]' formatting.\n    # Replace spaces after commas for compliance with strict list format\n    output_string = str(final_results).replace(\" \", \"\")\n    \n    print(output_string)\n\nsolve()\n```", "id": "3491550"}]}