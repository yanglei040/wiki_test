{"hands_on_practices": [{"introduction": "理解 $\\ell_0$ 最小化问题计算难度的第一步是直观感受其组合爆炸的本质。这个练习通过一个特意简化的具体实例，让你亲手计算所有可能的变量子集，并找寻最优解 [@problem_id:3463365]。通过这种方式，你将清晰地看到为什么穷举搜索在大多数情况下是不可行的，并对问题结构有更深入的认识。", "problem": "考虑基数约束的最小二乘子集选择问题：给定一个矩阵 $X \\in \\mathbb{R}^{m \\times n}$，一个向量 $y \\in \\mathbb{R}^{m}$，以及一个稀疏性预算 $k \\in \\{0,1,\\dots,n\\}$，求解\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|y - Xx\\|_{2}^{2} \\quad \\text{subject to} \\quad \\|x\\|_{0} \\le k,\n$$\n其中 $\\|x\\|_{0}$ 表示 $x$ 的非零元素的数量。这是 $\\ell_{0}$ 约束最小二乘（也称为精确子集选择）的规范表述，众所周知，该问题在一般情况下是计算上难解的，并且是对于非确定性多项式时间（NP）来说是困难问题的一个原型示例。\n\n通过解决以下具体实例，从第一性原理出发，揭示对支撑集搜索的组合性质，并计算精确的最优目标值。\n\n- 令 $m = 6$, $n = 6$, $k = 2$。\n- 令 $X = I_{6}$，即 $6 \\times 6$ 的单位矩阵。\n- 令 $y = \\begin{pmatrix} 7 \\\\ -2 \\\\ 3 \\\\ -6 \\\\ 1 \\\\ 4 \\end{pmatrix}$。\n\n任务：\n- 从定义出发论证为什么解决该问题原则上需要检查满足 $|S| \\le k$ 的支撑集 $S \\subseteq \\{1,2,\\dots,6\\}$，并明确指出在此实例中有多少个这样的支撑集，从而说明构成其难解性基础的组合搜索空间。\n- 仅使用欧几里得投影和在固定支撑集上的线性最小二乘的基本性质，确定此实例中目标函数 $\\|y - Xx\\|_{2}^{2}$ 的精确最小值。\n\n你的最终答案应该是对于给定的 $(X,y,k)$，$\\|y - Xx\\|_{2}^{2}$ 的最小值的精确实数。无需四舍五入。不要使用任何启发式或松弛方法；你的推理应严格基于问题的定义和欧几里得空间中投影的基本性质。", "solution": "该问题要求解一个基数约束的最小二乘子集选择问题的实例，其表述如下：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|y - Xx\\|_{2}^{2} \\quad \\text{subject to} \\quad \\|x\\|_{0} \\le k\n$$\n具体实例由参数 $m = 6$, $n = 6$, $k = 2$ 定义，矩阵为 $X = I_{6}$（$6 \\times 6$ 的单位矩阵），向量为 $y = \\begin{pmatrix} 7 \\\\ -2 \\\\ 3 \\\\ -6 \\\\ 1 \\\\ 4 \\end{pmatrix}$。我们必须首先解决问题的组合性质，然后计算精确的最小目标值。\n\n首先，我们分析问题的结构。约束 $\\|x\\|_{0} \\le k$ 规定解向量 $x \\in \\mathbb{R}^{n}$ 最多可以有 $k$ 个非零分量。这些非零分量的索引集合 $S = \\{j \\in \\{1, \\dots, n\\} \\mid x_j \\neq 0\\}$ 称为 $x$ 的支撑集。该约束等价于要求 $x$ 的支撑集 $S$ 的基数 $|S| \\le k$。\n\n对于任意固定的支撑集 $S$，问题变成一个关于变量 $\\{x_j\\}_{j \\in S}$ 的标准线性最小二乘问题，而对于所有 $j \\notin S$，有 $x_j=0$。令 $x_S$ 为这些变量组成的向量，令 $X_S$ 为由 $X$ 中索引在 $S$ 内的列组成的子矩阵。对于固定的 $S$，问题是 $\\min_{x_S} \\|y - X_S x_S\\|_{2}^{2}$。要解决原始问题，原则上必须为每个可能的支撑集 $S$（其中 $|S| \\le k$）找到最优解，然后选择能产生全局最小目标值的支撑集。这种对所有可能支撑集的搜索本质上是组合的，并且是该问题 NP 难度的根源。\n\n在此实例中，由于 $n=6$ 且 $k=2$，我们必须考虑所有满足 $|S| \\le 2$ 的支撑集 $S \\subseteq \\{1, 2, 3, 4, 5, 6\\}$。这样的支撑集总数是大小为 $0$、 $1$ 和 $2$ 的支撑集数量之和。该计数由二项式系数的和给出：\n$$\n\\sum_{j=0}^{k} \\binom{n}{j} = \\binom{6}{0} + \\binom{6}{1} + \\binom{6}{2}\n$$\n计算每一项：\n- 大小为 $0$ 的支撑集数量为 $\\binom{6}{0} = 1$（空集）。\n- 大小为 $1$ 的支撑集数量为 $\\binom{6}{1} = 6$。\n- 大小为 $2$ 的支撑集数量为 $\\binom{6}{2} = \\frac{6 \\times 5}{2 \\times 1} = 15$。\n需要检查的支撑集总数为 $1 + 6 + 15 = 22$。这展示了组合搜索空间，它随着 $n$ 和 $k$ 的增长而迅速增长。\n\n接下来，我们计算目标函数 $\\|y - Xx\\|_{2}^{2}$ 的精确最小值。这个实例的一个关键特征是 $X = I_6$。$I_6$ 的列是标准基向量 $e_1, \\dots, e_6$，它们是标准正交的。\n\n对于给定的支撑集 $S$，子矩阵 $X_S$ 的列也是标准正交的。最小二乘问题 $\\min_{x_S} \\|y - X_S x_S\\|_{2}^{2}$ 的解由 $x_S = (X_S^T X_S)^{-1} X_S^T y$ 给出。由于 $X_S$ 的列是标准正交的，所以 $X_S^T X_S = I_{|S|}$，即大小为 $|S|$ 的单位矩阵。解简化为 $x_S = X_S^T y$。这意味着对于索引 $j \\in S$， $x_j$ 的最优值是 $y$ 的第 $j$ 个分量，即 $x_j = (e_j)^T y = y_j$。对于索引 $j \\notin S$，我们有 $x_j=0$。\n\n因此，对于一个固定的支撑集 $S$，最优解向量是 $x^*$，其中如果 $j \\in S$，则 $x_j^* = y_j$；如果 $j \\notin S$，则 $x_j^* = 0$。\n该问题的目标函数是 $\\|y - Xx\\|_{2}^{2}$。由于 $X = I_6$，这变成了 $\\|y - I_6 x\\|_{2}^{2} = \\|y - x\\|_{2}^{2}$。\n将支撑集 $S$ 的最优解 $x^*$ 代入，目标值为：\n$$\n\\|y - x^*\\|_{2}^{2} = \\sum_{j=1}^{6} (y_j - x_j^*)^2 = \\sum_{j \\in S} (y_j - y_j)^2 + \\sum_{j \\notin S} (y_j - 0)^2 = \\sum_{j \\notin S} y_j^2\n$$\n为了找到整体的最小目标值，我们需要选择一个基数 $|S| \\le k$ 的支撑集 $S$，使得 $\\sum_{j \\notin S} y_j^2$ 最小化。这等价于最大化从总和中 *移除* 的分量平方和，即最大化 $\\sum_{j \\in S} y_j^2$，因为 $\\sum_{j \\notin S} y_j^2 = \\sum_{j=1}^{6} y_j^2 - \\sum_{j \\in S} y_j^2$ 并且 $\\sum_{j=1}^{6} y_j^2$ 是一个常数。\n\n任务简化为从 $\\{1, \\dots, 6\\}$ 中选择最多 $k=2$ 个索引，这些索引对应于 $y$ 中具有最大平方值的分量。\n给定向量为 $y = \\begin{pmatrix} 7 \\\\ -2 \\\\ 3 \\\\ -6 \\\\ 1 \\\\ 4 \\end{pmatrix}$。让我们计算其各分量的平方：\n$y_1^2 = 7^2 = 49$\n$y_2^2 = (-2)^2 = 4$\n$y_3^2 = 3^2 = 9$\n$y_4^2 = (-6)^2 = 36$\n$y_5^2 = 1^2 = 1$\n$y_6^2 = 4^2 = 16$\n\n我们要选择一个基数 $|S| \\le 2$ 的支撑集 $S$ 来最大化 $\\sum_{j \\in S} y_j^2$。由于所有的 $y_j^2 \\ge 0$，最大值将在支撑集大小恰好为 $k=2$ 时达到。我们在 $\\{49, 4, 9, 36, 1, 16\\}$ 中找出两个最大的值。它们是 $49$ 和 $36$，分别对应于索引 $j=1$ 和 $j=4$。\n\n因此，最优支撑集是 $S = \\{1, 4\\}$。\n最小目标值是 *不* 在 $S$ 中的分量的平方和。不在 $S$ 中的索引是 $\\{2, 3, 5, 6\\}$。\n最小值为：\n$$\n\\min \\|y - Xx\\|_{2}^{2} = \\sum_{j \\in \\{2,3,5,6\\}} y_j^2 = y_2^2 + y_3^2 + y_5^2 + y_6^2\n$$\n代入数值：\n$$\n(-2)^2 + 3^2 + 1^2 + 4^2 = 4 + 9 + 1 + 16 = 30\n$$\n最优解向量为 $x = \\begin{pmatrix} 7 \\\\ 0 \\\\ 0 \\\\ -6 \\\\ 0 \\\\ 0 \\end{pmatrix}$，它满足 $\\|x\\|_0 = 2 \\le k$。相应的最小平方误差是 $30$。", "answer": "$$\\boxed{30}$$", "id": "3463365"}, {"introduction": "由于 $\\ell_0$ 最小化是 NP-难的，在实践中我们常用其凸近似——$\\ell_1$ 最小化来求解。虽然 $\\ell_1$ 最小化在特定条件下（如满足约束等距性质 RIP）可以找到最稀疏解，但并非总是如此。这个练习提供了一个精巧的反例，在此例中 $\\ell_1$ 最小化得到的解与真正的最稀疏解不同，从而深刻揭示了 RIP 等理论条件在保证稀疏恢复成功中的关键作用 [@problem_id:3463377]。", "problem": "考虑由矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 和测量向量 $y \\in \\mathbb{R}^{2}$ 给出的线性系统，\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  \\tfrac{2}{5} \\\\\n0  1  \\tfrac{2}{5}\n\\end{pmatrix},\n\\qquad\ny \\;=\\; \\begin{pmatrix}\n\\tfrac{2}{5} \\\\\n\\tfrac{2}{5}\n\\end{pmatrix}.\n$$\n在压缩感知和稀疏优化的背景下，回顾以下核心定义：\n- 向量 $x \\in \\mathbb{R}^{n}$ 的 $\\ell_{0}$“范数”（基数），记作 $\\|x\\|_{0}$，是 $x$ 中非零元素的个数。\n- 向量 $x \\in \\mathbb{R}^{n}$ 的 $\\ell_{1}$ 范数，记作 $\\|x\\|_{1}$，是 $\\sum_{i=1}^{n} |x_{i}|$。\n- 对于一个矩阵 $A$，如果对于所有 $k$-稀疏向量 $x \\in \\mathbb{R}^{n}$，存在限制等距常数 $\\delta_{k} \\in [0,1)$，使得下式成立，则称该矩阵满足 $k$ 阶限制等距性质（RIP）：\n$$\n(1 - \\delta_{k}) \\, \\|x\\|_{2}^{2} \\;\\le\\; \\|A x\\|_{2}^{2} \\;\\le\\; (1 + \\delta_{k}) \\, \\|x\\|_{2}^{2}.\n$$\n\n使用这些定义作为基本依据：\n1. 通过显式构造一个在 $A$ 的零空间中的非零 $3$-稀疏向量，并解释其对限制等距常数的影响，证明矩阵 $A$ 不满足 $3$ 阶限制等距性质。\n2. 求解 $\\ell_{0}$-最小化问题 $\\min \\{\\|x\\|_{0} : A x = y\\}$ 并找出一个最稀疏解。\n3. 求解 $\\ell_{1}$-最小化问题 $\\min \\{\\|x\\|_{1} : A x = y\\}$，并证明其最小化子不同于 $\\ell_{0}$ 最小化子。\n4. 精确计算 $\\ell_{1}$ 目标函数 $\\min \\{\\|x\\|_{1} : A x = y\\}$ 的最小值。将最终答案表示为一个精确的数字（例如，一个最简分数）。无需四舍五入，也不涉及物理单位。", "solution": "该问题要求对一个由矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 和向量 $y \\in \\mathbb{R}^{2}$ 定义的稀疏优化问题进行四部分分析。\n\n首先，我们验证问题陈述。\n已知条件如下：\n- $A = \\begin{pmatrix} 1  0  \\tfrac{2}{5} \\\\ 0  1  \\tfrac{2}{5} \\end{pmatrix}$\n- $y = \\begin{pmatrix} \\tfrac{2}{5} \\\\ \\tfrac{2}{5} \\end{pmatrix}$\n- $\\|x\\|_{0}$ 是 $x$ 中非零元素的数量。\n- $\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$。\n- $k$ 阶限制等距性质 (RIP)：对于所有 $k$-稀疏向量 $x$，有 $(1 - \\delta_{k}) \\, \\|x\\|_{2}^{2} \\le \\|A x\\|_{2}^{2} \\le (1 + \\delta_{k}) \\, \\|x\\|_{2}^{2}$，其中 $\\delta_k \\in [0,1)$。\n\n该问题在科学上植根于压缩感知领域，问题陈述清晰且提供了所有必要信息，并且表述客观。所用定义均为标准定义，该问题是稀疏恢复概念的一个有效且具有说明性的例子。因此，可以推导出解决方案。\n\n第 1 部分：证明矩阵 $A$ 不满足 $3$ 阶限制等距性质。\n一个向量 $x \\in \\mathbb{R}^{3}$ 如果最多有 $3$ 个非零元素，则它是 $3$-稀疏的。由于 $\\mathbb{R}^{3}$ 中任何非零向量都满足此条件，我们需要找到一个非零向量 $x$，使得 RIP 不等式被违反。一个证明其不成立的有效方法是在 $A$ 的零空间中找到一个非零的 $k$-稀疏向量。\n\n设 $x = (x_1, x_2, x_3)^T$ 是 $A$ 的零空间中的一个向量，即 $Ax=0$。这给出了方程组：\n$$\n\\begin{cases}\nx_1 + \\frac{2}{5} x_3 = 0 \\\\\nx_2 + \\frac{2}{5} x_3 = 0\n\\end{cases}\n$$\n从这个方程组，我们得到 $x_1 = -\\frac{2}{5} x_3$ 和 $x_2 = -\\frac{2}{5} x_3$。零空间 $\\ker(A)$ 由所有形式为 $x = t(-\\frac{2}{5}, -\\frac{2}{5}, 1)^T$ 的向量组成，其中 $t \\in \\mathbb{R}$ 是任意标量。\n\n我们从这个空间中选择一个非零向量，例如，令 $t=5$。得到向量 $z = (-2, -2, 5)^T$。\n这个向量 $z$ 是非零的，所以它是一个 $3$-稀疏向量。\n对于这个向量，有 $Az = 0$，这意味着 $\\|Az\\|_2^2 = 0$。\n$z$ 的 $\\ell_2$ 范数的平方是 $\\|z\\|_2^2 = (-2)^2 + (-2)^2 + 5^2 = 4 + 4 + 25 = 33$。\n$k=3$ 时的 RIP 不等式为 $(1 - \\delta_3) \\|x\\|_2^2 \\le \\|Ax\\|_2^2$。代入我们的向量 $z$：\n$$\n(1 - \\delta_3) \\cdot 33 \\le 0\n$$\n由于 $\\|z\\|_2^2 = 33  0$，这个不等式迫使 $(1 - \\delta_3) \\le 0$，这意味着 $\\delta_3 \\ge 1$。\n限制等距性质的定义要求限制等距常数 $\\delta_k$ 在区间 $[0, 1)$ 内。由于我们已经证明，要使 $A$ 满足 $k=3$ 时的性质，需要 $\\delta_3 \\ge 1$，因此矩阵 $A$ 不满足 $3$ 阶 RIP。\n\n第 2 部分：求解 $\\ell_{0}$-最小化问题 $\\min \\{\\|x\\|_{0} : A x = y\\}$。\n我们正在寻找具有最少非零元素的 $Ax=y$ 的解。一个解 $x = (x_1, x_2, x_3)^T$ 必须满足：\n$$\n\\begin{cases}\nx_1 + \\frac{2}{5} x_3 = \\frac{2}{5} \\\\\nx_2 + \\frac{2}{5} x_3 = \\frac{2}{5}\n\\end{cases}\n$$\n我们寻求一个具有最小 $\\|x\\|_0$ 的解 $x$。\n- 是否存在 $0$-稀疏解？一个 $0$-稀疏解是 $x = (0, 0, 0)^T$。$A \\cdot 0 = 0 \\neq y$，所以不存在 $0$-稀疏解。\n- 是否存在 $1$-稀疏解？我们测试每一种可能性。\n  - 如果 $x=(x_1, 0, 0)^T$，方程变为 $x_1 = 2/5$ 和 $0 = 2/5$，这是一个矛盾。\n  - 如果 $x=(0, x_2, 0)^T$，方程变为 $0 = 2/5$ 和 $x_2 = 2/5$，这是一个矛盾。\n  - 如果 $x=(0, 0, x_3)^T$，方程变为 $\\frac{2}{5} x_3 = \\frac{2}{5}$ 和 $\\frac{2}{5} x_3 = \\frac{2}{5}$。两者都意味着 $x_3=1$。\n因此，$x_{s_0} = (0, 0, 1)^T$ 是 $Ax=y$ 的一个解。这个解的稀疏度是 $\\|x_{s_0}\\|_0 = 1$。\n由于我们找到了一个 $1$-稀疏解且不存在 $0$-稀疏解，所以 $\\|x\\|_0$ 的最小值是 $1$，一个最稀疏解是 $x_{s_0} = (0, 0, 1)^T$。\n\n第 3 部分：求解 $\\ell_{1}$-最小化问题 $\\min \\{\\|x\\|_{1} : A x = y\\}$ 并证明其最小化子不同。\n$Ax=y$ 的所有解的集合可以表示为 $x = x_p + x_h$，其中 $x_p$ 是任意一个特解，$x_h$ 是 $A$ 的零空间中的任意向量。\n从第 2 部分，我们有一个特解 $x_p = (0, 0, 1)^T$。\n从第 1 部分，零空间由向量 $x_h = t(-\\frac{2}{5}, -\\frac{2}{5}, 1)^T$ 组成，其中 $t \\in \\mathbb{R}$。\n所以，任何解都具有以下形式：\n$$\nx(t) = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + t \\begin{pmatrix} -2/5 \\\\ -2/5 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2/5 t \\\\ -2/5 t \\\\ 1+t \\end{pmatrix}\n$$\n我们想要最小化 $x(t)$ 的 $\\ell_1$ 范数：\n$$\n\\|x(t)\\|_1 = |-\\tfrac{2}{5}t| + |-\\tfrac{2}{5}t| + |1+t| = 2 \\cdot \\tfrac{2}{5}|t| + |1+t| = \\tfrac{4}{5}|t| + |1+t|\n$$\n设 $f(t) = \\frac{4}{5}|t| + |1+t|$。这个函数是凸的、分段线性的，在 $t=-1$ 和 $t=0$ 处不可微。我们分区间分析它：\n- 对于 $t \\ge 0$：$f(t) = \\frac{4}{5}t + (1+t) = \\frac{9}{5}t + 1$。这是一个增函数。它在 $[0, \\infty)$ 上的最小值在 $t=0$ 处取得，此时 $f(0)=1$。\n- 对于 $-1 \\le t  0$：$f(t) = \\frac{4}{5}(-t) + (1+t) = -\\frac{4}{5}t + 1+t = \\frac{1}{5}t + 1$。这是一个增函数。它在 $[-1, 0)$ 上的最小值在 $t=-1$ 处取得，此时 $f(-1) = \\frac{1}{5}(-1) + 1 = \\frac{4}{5}$。\n- 对于 $t  -1$：$f(t) = \\frac{4}{5}(-t) - (1+t) = -\\frac{4}{5}t - 1 - t = -\\frac{9}{5}t - 1$。这是一个减函数。\n$f(t)$ 的全局最小值在 $t=-1$ 处取得。\n通过令 $t=-1$，可以得到 $\\ell_1$-最小化解 $x_{s_1}$：\n$$\nx_{s_1} = x(-1) = \\begin{pmatrix} -2/5 (-1) \\\\ -2/5 (-1) \\\\ 1+(-1) \\end{pmatrix} = \\begin{pmatrix} 2/5 \\\\ 2/5 \\\\ 0 \\end{pmatrix}\n$$\n比较这两个最小化子：\n最稀疏解（来自 $\\ell_0$-最小化）是 $x_{s_0} = (0, 0, 1)^T$。\n$\\ell_1$-最小化解是 $x_{s_1} = (2/5, 2/5, 0)^T$。\n显然，$x_{s_0} \\neq x_{s_1}$。这表明对于这个系统，$\\ell_1$-最小化不能恢复出最稀疏解。$\\ell_1$ 解的稀疏度为 $\\|x_{s_1}\\|_0 = 2$，大于最小稀疏度 $1$。\n\n第 4 部分：计算 $\\ell_{1}$ 目标函数的最小值。\n如第 3 部分计算所得，目标函数 $f(t) = \\|x(t)\\|_1$ 的最小值在 $t=-1$ 时取得。最小值为：\n$$\nf(-1) = \\tfrac{4}{5}|-1| + |1+(-1)| = \\tfrac{4}{5}(1) + |0| = \\tfrac{4}{5}\n$$\n因此，对于任何满足 $Ax=y$ 的 $x$，$\\|x\\|_1$ 的最小值恰好是 $\\frac{4}{5}$。", "answer": "$$\\boxed{\\frac{4}{5}}$$", "id": "3463377"}]}