{"hands_on_practices": [{"introduction": "为了真正理解增广拉格朗日方法的核心优势，我们首先通过一个思想实验来探讨其与经典二次惩罚法的根本区别。这个练习将引导你从第一性原理出发，分析为何对于基追踪问题，增广拉格朗日函数 $L_{\\rho}(x,\\lambda)$ 能够在有限的惩罚参数 $\\rho$ 下通过选择合适的拉格朗日乘子 $\\lambda$ 来实现约束可行性 $A x = b$ [@problem_id:3432451]。这揭示了增广拉格朗日方法相较于二次惩罚函数 $P_{\\rho}(x)$ 在理论和实践中的关键威力，后者通常需要将 $\\rho \\to \\infty$ 才能强制满足约束。", "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 且 $b \\in \\mathbb{R}^{m}$。考虑称为基追踪 (basis pursuit) 的凸压缩感知模型，该模型旨在最小化 $f(x) = \\|x\\|_{1}$，并满足等式约束 $A x = b$。处理该等式约束的两种标准无约束代理形式是：\n$$P_{\\rho}(x) = \\|x\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},$$\n以及增广拉格朗日量 (augmented Lagrangian)\n$$L_{\\rho}(x,\\lambda) = \\|x\\|_{1} + \\lambda^{\\top}(A x - b) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},$$\n其中 $\\rho > 0$ 和 $\\lambda \\in \\mathbb{R}^{m}$ 分别是惩罚参数和拉格朗日乘子。根据凸优化、拉格朗日对偶和增广拉格朗日方法的基本定义，分析对于函数 $f(x) = \\|x\\|_{1}$，$P_{\\rho}$ 和 $L_{\\rho}$ 的极小值点之间的关系。特别地，从基本原理出发，论证如何通过选择一个合适的 $\\lambda$ 和有界的 $\\rho$ 来获得可行性 $A x = b$。\n\n在上述凸设定中，选择最准确且普遍有效的选项：\n\nA. 对于任意 $\\rho > 0$，假设存在一个原始-对偶最优对且强对偶性成立（对于 $f(x) = \\|x\\|_{1}$、等式约束以及 $A x = b$ 可行的情况，该条件成立），则存在一个 $\\lambda^{\\star}$，使得 $L_{\\rho}(x,\\lambda^{\\star})$ 的每个极小值点都是原始可行的和原始最优的。相比之下，对于 $P_{\\rho}(x)$，在有限 $\\rho$ 下，其极小值点的精确可行性通常无法保证，除非 $f$ 的一个无约束极小值点恰好满足 $A x = b$。\n\nB. 因为 $f(x) = \\|x\\|_{1}$ 是 $\\ell_{1}$ 范数，所以存在一个有限阈值 $\\bar{\\rho}$，使得对于所有 $\\rho \\ge \\bar{\\rho}$，$P_{\\rho}(x)$ 的每个极小值点都是精确可行和原始最优的，无论 $A$ 和 $b$ 如何。\n\nC. 即使选择最优的 $\\lambda$，有界的 $\\rho$ 也无法使 $L_{\\rho}(x,\\lambda)$ 的极小值点满足可行性 $A x = b$；必须取 $\\rho \\to \\infty$ 才能强制实现可行性。\n\nD. 要使 $L_{\\rho}(x,\\lambda)$ 的极小值点在有界 $\\rho$ 下可行，需要 $A$ 具有满列秩；否则极小值点必然保持不可行。\n\nE. 对于任意 $\\rho > 0$ 和任意 $\\lambda \\in \\mathbb{R}^{m}$，$L_{\\rho}(x,\\lambda)$ 的极小值点总是可行的，因为线性项 $\\lambda^{\\top}(A x - b)$ 能精确地强制执行该约束。", "solution": "该问题要求分析用于解决基追踪问题的两种常见优化公式，基追踪是一个带约束的凸优化问题。核心任务是比较二次惩罚方法和增广拉格朗日方法在强制执行原始可行性约束 $A x = b$ 方面的能力。\n\n设原始问题表示为 $(P)$：\n$$ (P) \\quad \\min_{x \\in \\mathbb{R}^n} f(x) \\quad \\text{subject to} \\quad A x = b $$\n其中 $f(x) = \\|x\\|_{1}$，$A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$。这是一个凸优化问题。问题陈述假设存在一个原始-对偶最优对 $(x^{\\star}, \\lambda^{\\star})$ 且强对偶性成立。这是一个合理的假设；例如，如果可行集 $\\{x \\in \\mathbb{R}^n \\mid A x = b\\}$ 非空，则 Slater 条件成立，这保证了强对偶性。\n\n一对 $(x^{\\star}, \\lambda^{\\star})$ 的最优性满足的 Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **原始可行性：** $A x^{\\star} = b$。\n2.  **对偶可行性**（与对偶问题 $\\max_{\\lambda} \\inf_x (\\|x\\|_1 + \\lambda^\\top(Ax-b)) $ 相关，即 $\\max_{\\lambda} -b^\\top\\lambda$ 满足 $\\|A^\\top\\lambda\\|_\\infty \\le 1$）：$\\|A^\\top \\lambda^\\star\\|_\\infty \\le 1$。虽然此条件是完整 KKT 系统的一部分，但分析目标函数的关键部分是平稳性条件。\n3.  **平稳性：** $0 \\in \\partial_x L(x^{\\star}, \\lambda^{\\star})$，其中 $L(x,\\lambda) = \\|x\\|_1 + \\lambda^\\top(Ax-b)$ 是标准拉格朗日函数。该条件为 $0 \\in \\partial f(x^{\\star}) + A^{\\top}\\lambda^{\\star}$，或等价地，$-A^{\\top}\\lambda^{\\star} \\in \\partial \\|x^{\\star}\\|_{1}$。\n\n在建立了这些基本原理之后，我们来分析给定的两个代理函数。\n\n**1. 二次惩罚方法的分析**\n二次惩罚公式旨在最小化：\n$$ P_{\\rho}(x) = \\|x\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n设 $x_{\\rho}$ 是对于某个惩罚参数 $\\rho > 0$ 时 $P_{\\rho}(x)$ 的一个极小值点。根据（针对凸函数的）费马法则，一阶最优性必要条件是 $0 \\in \\partial P_{\\rho}(x_{\\rho})$。这得出：\n$$ 0 \\in \\partial \\|x_{\\rho}\\|_{1} + \\rho A^{\\top}(A x_{\\rho} - b) $$\n这可以重写为 $- \\rho A^{\\top}(A x_{\\rho} - b) \\in \\partial \\|x_{\\rho}\\|_{1}$。\n\n现在，我们来检验对于有限的 $\\rho > 0$，$x_{\\rho}$ 是否可以是原始可行的，即 $A x_{\\rho} = b$。如果 $A x_{\\rho} = b$，则最优性条件简化为 $0 \\in \\partial \\|x_{\\rho}\\|_{1}$。$\\ell_1$ 范数的次微分是向量 $v$ 的集合，其中如果 $(x_{\\rho})_i \\neq 0$，则 $v_i = \\text{sgn}((x_{\\rho})_i)$；如果 $(x_{\\rho})_i=0$，则 $v_i \\in [-1, 1]$。条件 $0 \\in \\partial \\|x_{\\rho}\\|_{1}$ 仅在 $x_{\\rho} = 0$ 时成立。\n因此，如果一个极小值点 $x_{\\rho}$ 是可行的，它必须是 $x_{\\rho}=0$。这又要求 $A(0) = b$，即 $b=0$。在这种特殊情况下，$\\|x\\|_1$ 的无约束极小值点（即 $x=0$）是可行的，因此它解了原始问题。对于任何 $b \\neq 0$，当 $\\rho$ 有限时，$P_\\rho(x)$ 的极小值点 $x_\\rho$ 不会满足 $Ax_\\rho=b$。极小值点 $x_{\\rho}$ 代表了在最小化 $\\|x\\|_{1}$ 和最小化可行性违反度 $\\|A x - b\\|_{2}^{2}$ 之间的一种折衷。为了强制实现可行性，必须增加惩罚项的权重，这意味着取极限 $\\rho \\to \\infty$。因此，二次惩罚方法通常不是一种精确惩罚方法；它对于有限的惩罚参数无法实现精确可行性。\n\n**2. 增广拉格朗日方法的分析**\n增广拉格朗日函数是：\n$$ L_{\\rho}(x,\\lambda) = \\|x\\|_{1} + \\lambda^{\\top}(A x - b) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n乘子法的核心思想是，通过选择正确的拉格朗日乘子 $\\lambda = \\lambda^{\\star}$，即使对于有限且有界的 $\\rho$，我们也可以强制实现可行性。让我们来证明这一点。\n\n设 $(x^{\\star}, \\lambda^{\\star})$ 是一个最优的原始-对偶对。根据强对偶性，最优原始值 $p^{\\star} = \\|x^{\\star}\\|_{1}$ 等于最优对偶值 $d^{\\star} = \\inf_{x} L(x, \\lambda^{\\star})$。这意味着对于所有 $x \\in \\mathbb{R}^n$，都有 $\\|x\\|_{1} + (\\lambda^{\\star})^{\\top}(A x - b) \\ge \\|x^{\\star}\\|_{1}$。\n\n现在，考虑对于任意 $\\rho>0$ 的增广拉格朗日量 $L_{\\rho}(x, \\lambda^{\\star})$：\n$$ L_{\\rho}(x, \\lambda^{\\star}) = \\left( \\|x\\|_{1} + (\\lambda^{\\star})^{\\top}(A x - b) \\right) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n使用对偶不等式，我们有：\n$$ L_{\\rho}(x, \\lambda^{\\star}) \\ge \\|x^{\\star}\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n设 $\\tilde{x}$ 是 $L_{\\rho}(x, \\lambda^{\\star})$ 的任意一个极小值点。根据极小值点的定义，对于所有 $x$，都有 $L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le L_{\\rho}(x, \\lambda^{\\star})$。让我们在原始解 $x^{\\star}$ 处计算 $L_{\\rho}$ 的值：\n$$ L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = \\|x^{\\star}\\|_{1} + (\\lambda^{\\star})^{\\top}(A x^{\\star} - b) + \\frac{\\rho}{2}\\|A x^{\\star} - b\\|_{2}^{2} $$\n由于 $x^{\\star}$ 是可行的，所以 $A x^{\\star} - b = 0$。因此，\n$$ L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = \\|x^{\\star}\\|_{1} = p^{\\star} $$\n因为 $\\tilde{x}$ 是一个极小值点，必然有 $L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = p^{\\star}$。\n将此与我们之前的不等式结合：\n$$ p^{\\star} + \\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} \\le L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le p^{\\star} $$\n这一系列不等式仅在 $\\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} \\le 0$ 时才能成立。由于 $\\rho > 0$ 且平方范数是非负的，我们必须有 $\\|A \\tilde{x} - b\\|_{2}^{2} = 0$，这意味着 $A \\tilde{x} = b$。这证明了 $L_{\\rho}(x, \\lambda^{\\star})$ 的任何极小值点 $\\tilde{x}$ 都是原始可行的。\n\n此外，这些不等式必须作为等式成立，所以 $L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) = p^{\\star}$。由于 $\\tilde{x}$ 是可行的，\n$$ L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) = \\|\\tilde{x}\\|_{1} + (\\lambda^{\\star})^{\\top}(A \\tilde{x} - b) + \\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} = \\|\\tilde{x}\\|_{1} + 0 + 0 = \\|\\tilde{x}\\|_{1} $$\n因此，$\\|\\tilde{x}\\|_{1} = p^{\\star}$。由于 $\\tilde{x}$ 是可行的，且其目标值是最优值，所以 $\\tilde{x}$ 是一个原始最优解。这对任何 $\\rho > 0$ 都成立。\n\n现在我们评估给出的选项。\n\n**A. 对于任意 $\\rho > 0$，假设存在一个原始-对偶最优对且强对偶性成立（对于 $f(x) = \\|x\\|_{1}$、等式约束以及 $A x = b$ 可行的情况，该条件成立），则存在一个 $\\lambda^{\\star}$，使得 $L_{\\rho}(x,\\lambda^{\\star})$ 的每个极小值点都是原始可行的和原始最优的。相比之下，对于 $P_{\\rho}(x)$，在有限 $\\rho$ 下，其极小值点的精确可行性通常无法保证，除非 $f$ 的一个无约束极小值点恰好满足 $A x = b$。**\n我们对增广拉格朗日量的推导表明，如果选择最优的拉格朗日乘子 $\\lambda^{\\star}$，那么对于任何 $\\rho > 0$，$L_{\\rho}(x, \\lambda^{\\star})$ 的任何极小值点确实是原始可行和最优的。我们对二次惩罚方法的分析表明，对于有限的 $\\rho$，其极小值点通常是不可行的，除非 $\\|x\\|_1$ 的无约束极小值点（即 $x=0$）是可行的（即 $b=0$）。这个选项完美准确地总结了该理论。\n结论：**正确**。\n\n**B. 因为 $f(x) = \\|x\\|_{1}$ 是 $\\ell_{1}$ 范数，所以存在一个有限阈值 $\\bar{\\rho}$，使得对于所有 $\\rho \\ge \\bar{\\rho}$，$P_{\\rho}(x)$ 的每个极小值点都是精确可行和原始最优的，无论 $A$ 和 $b$ 如何。**\n这个陈述声称二次惩罚函数对于此问题是一个精确惩罚函数。正如我们对 $P_{\\rho}(x)$ 的分析所证明的，这是错误的。对于 $b \\neq 0$，当 $\\rho > 0$ 为任意有限值时，$P_{\\rho}(x)$ 的极小值点不可能是可行的。声称该性质“无论 $A$ 和 $b$ 如何”都成立，是尤其强烈且不正确的。精确惩罚结果通常需要非光滑的惩罚函数（如对残差的 $\\ell_1$ 惩罚，$\\|Ax-b\\|_1$），而不是平方 $\\ell_2$ 惩罚。\n结论：**不正确**。\n\n**C. 即使选择最优的 $\\lambda$，有界的 $\\rho$ 也无法使 $L_{\\rho}(x,\\lambda)$ 的极小值点满足可行性 $A x = b$；必须取 $\\rho \\to \\infty$ 才能强制实现可行性。**\n这与增广拉格朗日方法的主要理论优势相反。如上所述，最优选择 $\\lambda = \\lambda^{\\star}$ 保证了对于任何 $\\rho > 0$，其极小值点都是可行的。该陈述描述的是二次惩罚方法的行为，而不是增广拉格朗日方法的行为。\n结论：**不正确**。\n\n**D. 要使 $L_{\\rho}(x,\\lambda)$ 的极小值点在有界 $\\rho$ 下可行，需要 $A$ 具有满列秩；否则极小值点必然保持不可行。**\n我们对 $L_{\\rho}(x, \\lambda^{\\star})$ 性质的推导并未依赖于关于矩阵 $A$ 的任何假设，例如它的秩。该结果是普适的，只要强对偶性成立，就对任何 $A \\in \\mathbb{R}^{m \\times n}$ 都有效。在压缩感知的背景下，通常处理的是 $n > m$ 的欠定系统，因此 $A$ 不可能具有满列秩。该理论仍然适用。\n结论：**不正确**。\n\n**E. 对于任意 $\\rho > 0$ 和任意 $\\lambda \\in \\mathbb{R}^{m}$，$L_{\\rho}(x,\\lambda)$ 的极小值点总是可行的，因为线性项 $\\lambda^{\\top}(A x - b)$ 能精确地强制执行该约束。**\n这是一个严重的夸大。可行性性质被证明只在特定的最优选择 $\\lambda = \\lambda^{\\star}$ 下成立。对于任意的 $\\lambda \\neq \\lambda^{\\star}$，$L_{\\rho}(x, \\lambda)$ 的极小值点通常是不可行的。迭代的增广拉格朗日方法通过生成一个收敛到 $\\lambda^{\\star}$ 的乘子序列 $\\lambda_k$ 来工作；相应的极小值点序列 $x_k$ 仅在极限情况下才收敛到一个可行点。仅靠线性项本身并不能强制执行约束。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3432451"}, {"introduction": "在实现任何迭代算法时，一个核心的实际问题是如何确定何时停止。本练习将指导你推导基追踪降噪（BPDN）问题（即在 $\\|A x - b\\|_{2} \\leq \\tau$ 约束下最小化 $\\|x\\|_{1}$）的对偶问题，并利用对偶变量构建一个可计算的原始-对偶间隙 $g(x^{k}, \\tilde{y})$ [@problem_id:3432463]。这个间隙为当前解的目标值与最优值之差 $|\\|x^{k}\\|_{1} - v^{\\star}|$ 提供了一个严格的上限，从而形成一个理论坚实且在实践中至关重要的算法停止准则。", "problem": "考虑压缩感知中的约束基追踪降噪 (BPDN) 问题：在欧几里得残差约束下最小化 $\\ell_{1}$ 范数，即求解 $x \\in \\mathbb{R}^{n}$ 使得\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - b\\|_{2} \\leq \\tau,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是感知矩阵，$b \\in \\mathbb{R}^{m}$ 是测量向量，$\\tau \\geq 0$ 是残差容差。在增广拉格朗日方法 (ALM) 中，我们迭代地更新主变量和乘子，这些乘子逼近了范数约束问题下的对偶变量。从拉格朗日对偶、Fenchel 共轭和对偶范数的基本定义出发，推导一个可计算的主对偶间隙表达式，该表达式使用 ALM 乘子为 BPDN 问题构建一个对偶可行证书。然后，利用此间隙构建一个停止准则，以保证约束问题最优值的绝对误差界。\n\n考虑以下具体实例：\n- 感知矩阵为\n$$\nA = \\begin{pmatrix}\n1  0 \\\\\n0  2\n\\end{pmatrix}.\n$$\n- 测量向量为\n$$\nb = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n- 残差容差为 $\\tau = 0.5$。\n- 一个 ALM 主迭代值为\n$$\nx^{k} = \\begin{pmatrix}\n0.8 \\\\\n0\n\\end{pmatrix}.\n$$\n- 对应的 ALM 乘子为\n$$\ny^{k} = \\begin{pmatrix}\n-0.2 \\\\\n0\n\\end{pmatrix}.\n$$\n\n你的任务是：\n1. 从第一性原理出发，推导上述约束 BPDN 公式的对偶问题，并确定其对偶变量的可行性约束。\n2. 展示如何仅通过可计算的操作从 ALM 乘子 $y^{k}$ 获得一个对偶可行证书 $\\tilde{y}$，并证明由此产生的主对偶间隙 $g(x^{k}, \\tilde{y})$ 是绝对误差 $|\\|x^{k}\\|_{1} - v^{\\star}|$ 的一个上界，其中 $v^{\\star}$ 是约束问题的最优值。\n3. 利用你的推导，计算所提供实例的主对偶间隙 $g(x^{k}, \\tilde{y})$。\n\n将最终答案表示为单个实数。无需四舍五入，请提供精确值。", "solution": "该问题要求推导基追踪降噪 (BPDN) 的对偶问题，从增广拉格朗日方法 (ALM) 乘子构建对偶可行证书，证明主对偶间隙可作为误差界，并针对一个具体实例计算此间隙。\n\n主问题（我们记为 (P)）由下式给出：\n$$\nv^{\\star} = \\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - b\\|_{2} \\leq \\tau\n$$\n其中 $v^{\\star}$ 是最优值。令 $p(x) = \\|x\\|_{1}$ 为主目标函数。\n\n### 第1部分：对偶问题的推导\n\n我们使用拉格朗日对偶来推导对偶问题。通过引入松弛变量 $r \\in \\mathbb{R}^m$，该问题可以重构为：\n$$\n\\min_{x, r} \\|x\\|_{1} \\quad \\text{subject to} \\quad A x - b = r, \\quad \\|r\\|_{2} \\leq \\tau\n$$\n为了处理范数约束，我们使用指示函数来表达它。令 $K = \\{z \\in \\mathbb{R}^{m} \\mid \\|z\\|_{2} \\leq \\tau\\}$ 为半径为 $\\tau$ 的闭球。该集合的指示函数为 $I_K(r)$，如果 $r \\in K$，则其值为 $0$，否则为 $+\\infty$。问题变为：\n$$\n\\min_{x, r} \\|x\\|_{1} + I_K(r) \\quad \\text{subject to} \\quad Ax - r = b\n$$\n我们为等式约束 $Ax - r - b = 0$ 引入一个拉格朗日乘子向量 $y \\in \\mathbb{R}^{m}$。拉格朗日函数是：\n$$\n\\mathcal{L}(x, r, y) = \\|x\\|_{1} + I_K(r) + y^T (b - Ax + r)\n$$\n整理各项，我们得到：\n$$\n\\mathcal{L}(x, r, y) = (\\|x\\|_{1} - y^T A x) + (I_K(r) + y^T r) + y^T b\n$$\n拉格朗日对偶函数 $d(y)$ 是拉格朗日函数关于主变量 $x$ 和 $r$ 的下确界：\n$$\nd(y) = \\inf_{x, r} \\mathcal{L}(x, r, y) = y^T b + \\inf_{x} (\\|x\\|_{1} - (A^T y)^T x) + \\inf_{r} (I_K(r) + y^T r)\n$$\n这两个下确界可以使用 Fenchel 共轭的定义分开计算。函数 $f(z)$ 的 Fenchel 共轭是 $f^{*}(w) = \\sup_z (w^T z - f(z))$。因此，$\\inf_z (f(z) - w^T z) = -f^{*}(w)$。\n\n对于第一个下确界，其中 $f(x) = \\|x\\|_{1}$：\n$$\n\\inf_{x} (\\|x\\|_{1} - (A^T y)^T x) = -(\\|\\cdot\\|_{1})^{*}(A^T y)\n$$\n$\\ell_1$范数的共轭是在对偶范数（即 $\\ell_{\\infty}$ 范数）下的单位球的指示函数。具体来说，如果 $\\|z\\|_{\\infty} \\leq 1$，则 $(\\|\\cdot\\|_{1})^{*}(z) = 0$，否则为 $+\\infty$。为了使下确界为有限值，我们需要 $\\|A^T y\\|_{\\infty} \\leq 1$，在这种情况下，下确界为 $0$。\n\n对于第二个下确界，其中 $f(r) = I_K(r)$：\n$$\n\\inf_{r} (I_K(r) + y^T r) = \\inf_{r} (I_K(r) - (-y)^T r) = -I_K^{*}(-y)\n$$\n集合 $K$ 的指示函数的共轭是该集合的支撑函数，$\\sigma_K(z) = \\sup_{r \\in K} z^T r$。所以，$I_K^{*}(z) = \\sigma_K(z)$。\n对于集合 $K = \\{r \\mid \\|r\\|_{2} \\leq \\tau\\}$，支撑函数为 $\\sigma_K(z) = \\tau \\|z\\|_{2}$。\n因此，第二个下确界是 $-\\sigma_K(-y) = -\\tau \\|-y\\|_{2} = -\\tau \\|y\\|_{2}$。该值始终是有限的。\n\n结合这些结果，对偶函数 $d(y)$ 是：\n$$\nd(y) = \\begin{cases} y^T b - \\tau \\|y\\|_{2}  \\text{if } \\|A^T y\\|_{\\infty} \\leq 1 \\\\ -\\infty  \\text{otherwise} \\end{cases}\n$$\n对偶问题 (D) 是最大化对偶函数：\n$$\n\\max_{y \\in \\mathbb{R}^{m}} d(y) \\quad \\equiv \\quad \\max_{y \\in \\mathbb{R}^{m}} y^T b - \\tau \\|y\\|_{2} \\quad \\text{subject to} \\quad \\|A^T y\\|_{\\infty} \\leq 1\n$$\n令 $v(y) = y^T b - \\tau \\|y\\|_{2}$ 为对偶目标。对偶变量 $y$ 的可行性约束是 $\\|A^T y\\|_{\\infty} \\leq 1$。\n\n### 第2部分：对偶证书和主对偶间隙\n\n给定一个主迭代值 $x^{k}$ 和一个 ALM 乘子 $y^{k}$，我们需要构造一个对偶可行点 $\\tilde{y}$ 并用它来形成一个误差界。\n\nALM 乘子 $y^{k}$ 是真实对偶最优变量的一个估计，但不能保证其是对偶可行的，即它可能不满足 $\\|A^T y^{k}\\|_{\\infty} \\leq 1$。我们可以通过将 $y^{k}$ 投影到可行集上来构造一个对偶可行点 $\\tilde{y}$。一个简单的方法是通过缩放：\n令 $c = \\max(1, \\|A^T y^{k}\\|_{\\infty})$。我们定义对偶可行证书 $\\tilde{y}$ 为：\n$$\n\\tilde{y} = \\frac{y^{k}}{c} = \\frac{y^{k}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\n$$\n这个操作总是可计算的。为了验证 $\\tilde{y}$ 是对偶可行的，我们检查它是否满足约束条件：\n$$\n\\|A^T \\tilde{y}\\|_{\\infty} = \\left\\|A^T \\frac{y^{k}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\\right\\|_{\\infty} = \\frac{\\|A^T y^{k}\\|_{\\infty}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\n$$\n如果 $\\|A^T y^{k}\\|_{\\infty} \\leq 1$，那么 $\\max(1, \\|A^T y^{k}\\|_{\\infty}) = 1$，且 $\\|A^T \\tilde{y}\\|_{\\infty} = \\|A^T y^{k}\\|_{\\infty} \\leq 1$。\n如果 $\\|A^T y^{k}\\|_{\\infty} > 1$，那么 $\\max(1, \\|A^T y^{k}\\|_{\\infty}) = \\|A^T y^{k}\\|_{\\infty}$，且 $\\|A^T \\tilde{y}\\|_{\\infty} = \\frac{\\|A^T y^{k}\\|_{\\infty}}{\\|A^T y^{k}\\|_{\\infty}} = 1$。\n在这两种情况下，都有 $\\|A^T \\tilde{y}\\|_{\\infty} \\leq 1$，所以 $\\tilde{y}$ 是对偶可行的。\n\n对于 BPDN 问题，如果存在一个严格可行点，即存在一个 $x$ 使得 $\\|Ax - b\\|_{2}  \\tau$，则 Slater 条件成立。如果该条件成立，强对偶性就得到保证，意味着主问题的最优值 $v^{\\star}$ 等于对偶问题的最优值。对于任何主可行迭代值 $x^k$（满足 $\\|A x^{k} - b\\|_{2} \\leq \\tau$）和任何对偶可行点 $\\tilde{y}$（满足 $\\|A^T \\tilde{y}\\|_{\\infty} \\leq 1$），弱对偶性表明：\n$$\nv(\\tilde{y}) \\leq v^{\\star} \\leq p(x^{k})\n$$\n当前迭代值的目标函数的绝对误差是 $|p(x^{k}) - v^{\\star}| = p(x^{k}) - v^{\\star}$（因为 $x^{k}$ 是可行的，所以 $p(x^k) \\geq v^\\star$）。根据弱对偶不等式，我们有：\n$$\np(x^{k}) - v^{\\star} \\leq p(x^{k}) - v(\\tilde{y})\n$$\n这个差值 $g(x^{k}, \\tilde{y}) = p(x^{k}) - v(\\tilde{y})$ 被称为主对偶间隙。它是当前迭代值 $x^k$ 次优性的一个可计算上界：\n$$\ng(x^{k}, \\tilde{y}) = \\|x^{k}\\|_{1} - ( \\tilde{y}^T b - \\tau \\|\\tilde{y}\\|_{2} ) = \\|x^{k}\\|_{1} - \\tilde{y}^T b + \\tau \\|\\tilde{y}\\|_{2}\n$$\n可以基于此间隙设计一个停止准则：当 $g(x^{k}, \\tilde{y}) \\leq \\epsilon$ 时（其中 $\\epsilon  0$ 是用户定义的容差），迭代算法终止，这保证了 $\\|x^k\\|_1$ 与真实最优值 $v^\\star$ 的差距最多为 $\\epsilon$。\n\n### 第3部分：针对给定实例的计算\n\n我们有以下给定的实例：\n- $A = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$, $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $\\tau = 0.5$。\n- 主迭代值：$x^{k} = \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix}$。\n- ALM 乘子：$y^{k} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}$。\n\n首先，我们检查 $x^k$ 是否是主可行的：\n$$\nA x^k - b = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\|A x^k - b\\|_{2} = \\sqrt{(-0.2)^2 + 0^2} = \\sqrt{0.04} = 0.2\n$$\n由于 $0.2 \\leq \\tau = 0.5$，迭代值 $x^k$ 是主可行的。\n\n接下来，我们从 $y^k$ 构造对偶可行证书 $\\tilde{y}$：\n$$\nA^T = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}\n$$\n$$\nA^T y^k = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}\n$$\n$\\ell_{\\infty}$ 范数为 $\\|A^T y^k\\|_{\\infty} = \\max(|-0.2|, |0|) = 0.2$。\n缩放因子为 $c = \\max(1, \\|A^T y^k\\|_{\\infty}) = \\max(1, 0.2) = 1$。\n因此，$\\tilde{y} = \\frac{y^k}{1} = y^k = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}$。该乘子本身已经是多偶可行的。\n\n最后，我们计算主对偶间隙 $g(x^k, \\tilde{y}) = \\|x^k\\|_1 - \\tilde{y}^T b + \\tau \\|\\tilde{y}\\|_2$。我们分别计算每一项：\n- 主目标函数值：\n$$\np(x^k) = \\|x^k\\|_1 = |0.8| + |0| = 0.8\n$$\n- 来自对偶目标的项：\n$$\n\\tilde{y}^T b = \\begin{pmatrix} -0.2  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (-0.2)(1) + (0)(0) = -0.2\n$$\n- 对偶证书的范数：\n$$\n\\|\\tilde{y}\\|_2 = \\left\\| \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{(-0.2)^2 + 0^2} = 0.2\n$$\n将这些值代入间隙公式，其中 $\\tau = 0.5$：\n$$\ng(x^k, \\tilde{y}) = 0.8 - (-0.2) + (0.5)(0.2) = 0.8 + 0.2 + 0.1 = 1.1\n$$\n主对偶间隙为 $1.1$。该值提供了 $x^k$ 目标值次优性的一个上界。", "answer": "$$\\boxed{1.1}$$", "id": "3432463"}, {"introduction": "现实世界的数据往往含有噪声，这可能导致优化模型中的约束条件变得不相容（inconsistent），例如 $b \\notin \\mathrm{range}(A)$，从而使标准增广拉格朗日方法的乘子序列 $\\lambda^k$ 发散。本练习探讨了这一挑战，并提出了一种巧妙的修正方案：$\\lambda^{k+1} = \\lambda^{k} + \\rho \\, P\\,(A x^{k+1} - b)$，即对乘子更新进行投影 [@problem_id:3432484]。通过推导并求解此修正算法中乘子分量 $\\lambda_{1}^{k}$ 的精确递推关系，你将深入理解该方法如何防止发散，并掌握设计更鲁棒算法以应对实际应用复杂情况的原则。", "problem": "考虑压缩感知中的测量模型 $A x = b$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 和 $b \\in \\mathbb{R}^{m}$ 是给定数据。在有噪声存在的情况下，$b$ 可能不位于 $A$ 的值域中，即 $b \\notin \\mathrm{range}(A)$，这使得等式约束不一致，并可能导致经典增广拉格朗日更新中的拉格朗日乘子序列发散。为了研究一种原则性补救措施的效果，考虑在许多稀疏优化方案中出现且代表了增广拉格朗日方法核心机制的近端子问题：在满足线性测量约束的条件下，最小化严格凸的二次目标函数，\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2}\\|x\\|_{2}^{2} \\quad \\text{subject to} \\quad A x = b,\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 1}$ 和 $b \\in \\mathbb{R}^{2}$ 由下式指定\n$$\nA = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n惩罚参数为 $\\rho  0$。经典的增广拉格朗日函数为\n$$\n\\mathcal{L}_{\\rho}(x,\\lambda) = \\frac{1}{2}\\|x\\|_{2}^{2} + \\langle \\lambda, A x - b \\rangle + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},\n$$\n且乘子更新为 $\\lambda^{k+1} = \\lambda^{k} + \\rho(A x^{k+1} - b)$。由于 $b \\notin \\mathrm{range}(A)$，这种未经修改的更新可能会导致 $\\lambda^{k}$ 发散。\n\n一种防止因不一致分量导致发散的稳健方法是，通过到 $\\mathrm{range}(A)$ 上的正交投影算子 $P$（定义为 $P = A A^{\\dagger}$，其中 $A^{\\dagger}$ 表示 $A$ 的 Moore–Penrose 伪逆），仅沿着测量子空间更新乘子来松弛约束。在这种修改后的方案中，原始更新 $x^{k+1}$ 最小化 $\\mathcal{L}_{\\rho}(x,\\lambda^{k})$，而乘子更新为\n$$\n\\lambda^{k+1} = \\lambda^{k} + \\rho \\, P\\,(A x^{k+1} - b),\n$$\n初始值为 $\\lambda^{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n从上述基本定义出发，不使用任何快捷公式，推导控制此投影更新方案中乘子第一个分量 $\\lambda_{1}^{k}$ 的精确标量递推关系，并计算当 $k \\to \\infty$ 时 $\\lambda_{1}^{k}$ 的极限值。将您的最终答案表示为单个实数。无需四舍五入。解释您的推导过程，简要说明为什么这种修改在当前不一致的设置下可以防止发散。", "solution": "该问题陈述是数值优化领域的一个有效练习，特别关注于增广拉格朗日方法在处理具有不一致线性约束的约束优化问题时的行为。问题的所有组成部分在数学上都是明确定义的，并且前提是自洽和一致的。\n\n问题要求推导拉格朗日乘子第一个分量 $\\lambda_1^k$ 的标量递推关系，及其当 $k \\to \\infty$ 时的极限值。该优化问题为：\n$$\n\\min_{x \\in \\mathbb{R}} \\ \\frac{1}{2}\\|x\\|_{2}^{2} \\quad \\text{subject to} \\quad A x = b\n$$\n在这里，$x$ 是一个标量，因为 $A \\in \\mathbb{R}^{2 \\times 1}$。给定的数据是：\n$$\nA = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n系统 $Ax=b$ 是不一致的，因为 $\\mathrm{range}(A)$ 由形如 $\\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}$（对于任意标量 $\\alpha$）的向量组成，而 $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 不具有这种形式。\n\n修改后的增广拉格朗日方案由以下迭代更新定义：\n1. 原始更新：$x^{k+1} = \\arg\\min_{x} \\mathcal{L}_{\\rho}(x, \\lambda^{k})$\n2. 对偶更新：$\\lambda^{k+1} = \\lambda^{k} + \\rho P (A x^{k+1} - b)$\n\n其中 $\\mathcal{L}_{\\rho}(x,\\lambda) = \\frac{1}{2}\\|x\\|_{2}^{2} + \\langle \\lambda, A x - b \\rangle + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2}$，$P$ 是到 $\\mathrm{range}(A)$ 上的正交投影算子，初始值为 $\\lambda^0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n首先，我们确定投影矩阵 $P = AA^{\\dagger}$。对于一个满列秩的矩阵 $A$，其 Moore-Penrose 伪逆 $A^{\\dagger}$ 由 $A^{\\dagger} = (A^T A)^{-1} A^T$ 给出。\n我们有 $A^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n$$\nA^T A = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1\n$$\n因此，$(A^T A)^{-1} = 1$。\n伪逆是：\n$$\nA^{\\dagger} = 1 \\cdot \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n现在，我们可以计算投影算子 $P$：\n$$\nP = A A^{\\dagger} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n该矩阵将 $\\mathbb{R}^2$ 中的任何向量投影到由 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 张成的子空间上，也就是 $A$ 的值域。\n\n接下来，我们通过最小化关于 $x$ 的增广拉格朗日函数 $\\mathcal{L}_{\\rho}(x, \\lambda^k)$ 来找到原始更新 $x^{k+1}$。由于 $x$ 是一个标量，所以 $\\|x\\|_2^2 = x^2$。\n$$\n\\mathcal{L}_{\\rho}(x,\\lambda^k) = \\frac{1}{2}x^2 + (\\lambda^k)^T(Ax-b) + \\frac{\\rho}{2}\\|Ax-b\\|_2^2\n$$\n这是一个关于 $x$ 的严格凸函数。通过将其关于 $x$ 的导数设为零来找到最小值。\n$$\n\\frac{d}{dx} \\mathcal{L}_{\\rho}(x,\\lambda^k) = x + A^T \\lambda^k + \\rho A^T (Ax - b) = 0\n$$\n在第 $(k+1)$ 步求解 $x$，我们得到：\n$$\nx^{k+1} + \\rho A^T A x^{k+1} = -A^T \\lambda^k + \\rho A^T b\n$$\n$$\n(1 + \\rho A^T A) x^{k+1} = A^T(\\rho b - \\lambda^k)\n$$\n我们代入已知值：$A^T A = 1$，$A^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$，$b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。设 $\\lambda^k = \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix}$。\n$$\nA^T b = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1\n$$\n$$\nA^T \\lambda^k = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix} = \\lambda_1^k\n$$\n将这些代入 $x^{k+1}$ 的方程中：\n$$\n(1 + \\rho) x^{k+1} = \\rho(1) - \\lambda_1^k\n$$\n$$\nx^{k+1} = \\frac{\\rho - \\lambda_1^k}{1+\\rho}\n$$\n\n现在，我们分析对偶更新：$\\lambda^{k+1} = \\lambda^k + \\rho P (A x^{k+1} - b)$。\n首先，计算残差项 $A x^{k+1} - b$：\n$$\nA x^{k+1} - b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} x^{k+1} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} x^{k+1} - 1 \\\\ -1 \\end{pmatrix}\n$$\n接下来，应用投影算子 $P$：\n$$\nP(A x^{k+1} - b) = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} x^{k+1} - 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} x^{k+1} - 1 \\\\ 0 \\end{pmatrix}\n$$\n那么对偶更新方程为：\n$$\n\\begin{pmatrix} \\lambda_1^{k+1} \\\\ \\lambda_2^{k+1} \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix} + \\rho \\begin{pmatrix} x^{k+1} - 1 \\\\ 0 \\end{pmatrix}\n$$\n这个向量方程产生两个标量递推关系：\n1. $\\lambda_1^{k+1} = \\lambda_1^k + \\rho (x^{k+1} - 1)$\n2. $\\lambda_2^{k+1} = \\lambda_2^k + 0 = \\lambda_2^k$\n\n从第二个递推关系中，我们看到 $\\lambda_2^k$ 是常数。根据初始条件 $\\lambda^0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，我们有 $\\lambda_2^0 = 0$，因此对于所有 $k \\ge 0$ 都有 $\\lambda_2^k = 0$。\n\n现在我们推导所要求的 $\\lambda_1^k$ 的标量递推关系。我们将 $x^{k+1}$ 的表达式代入第一个递推关系中：\n$$\n\\lambda_1^{k+1} = \\lambda_1^k + \\rho \\left( \\frac{\\rho - \\lambda_1^k}{1+\\rho} - 1 \\right)\n$$\n简化括号中的项：\n$$\n\\frac{\\rho - \\lambda_1^k}{1+\\rho} - \\frac{1+\\rho}{1+\\rho} = \\frac{\\rho - \\lambda_1^k - 1 - \\rho}{1+\\rho} = \\frac{-1 - \\lambda_1^k}{1+\\rho}\n$$\n所以递推关系变为：\n$$\n\\lambda_1^{k+1} = \\lambda_1^k + \\rho \\left( \\frac{-1 - \\lambda_1^k}{1+\\rho} \\right) = \\lambda_1^k - \\frac{\\rho}{1+\\rho} \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^{k+1} = \\left( 1 - \\frac{\\rho}{1+\\rho} \\right) \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^{k+1} = \\left( \\frac{1+\\rho-\\rho}{1+\\rho} \\right) \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n精确的标量递推关系是：\n$$\n\\lambda_1^{k+1} = \\frac{1}{1+\\rho} \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n这是一个线性一阶递推关系。因为 $\\rho  0$，系数 $\\frac{1}{1+\\rho}$ 在区间 $(0, 1)$ 内。因此，序列 $\\{\\lambda_1^k\\}$ 收敛到一个唯一的固定点 $\\lambda_1^*$。该固定点满足：\n$$\n\\lambda_1^* = \\frac{1}{1+\\rho} \\lambda_1^* - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( 1 - \\frac{1}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( \\frac{1+\\rho-1}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( \\frac{\\rho}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* = -1\n$$\n当 $k \\to \\infty$ 时，$\\lambda_1^k$ 的极限值为 $-1$。\n\n这种修改能够防止发散，因为投影算子 $P$ 滤除了残差 $Ax-b$ 中位于 $A^T$ 零空间的分量，该分量对应于线性系统的不一致部分。标准的乘子更新 $\\lambda^{k+1} = \\lambda^k + \\rho(Ax^{k+1}-b)$ 将导致 $\\lambda_2^k$ 序列发散。具体来说，第二个分量的更新将是 $\\lambda_2^{k+1} = \\lambda_2^k + \\rho(-1)$。从 $\\lambda_2^0 = 0$ 开始，这导致 $\\lambda_2^k = -k\\rho$，它发散到 $-\\infty$。通过使用投影残差 $P(Ax^{k+1}-b)$，更新向量被强制位于 $\\mathrm{range}(A)$ 中。在这种情况下，更新向量的第二个分量始终为零，从而将相应的乘子分量 $\\lambda_2^k$ 稳定在其初始值 $0$。该方法有效地解决了投影后的（且一致的）问题 $\\min \\frac{1}{2}\\|x\\|_2^2$，约束条件为 $Ax=Pb$。这个一致问题的 KKT 条件给出 $x=1$ 和乘子 $-1$，与我们的极限值相匹配。", "answer": "$$\\boxed{-1}$$", "id": "3432484"}]}