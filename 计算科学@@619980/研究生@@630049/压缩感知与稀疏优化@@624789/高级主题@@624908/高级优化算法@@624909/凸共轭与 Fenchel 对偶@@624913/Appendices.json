{"hands_on_practices": [{"introduction": "本练习将探讨一个在统计建模中至关重要的函数——负泊松对数似然函数。通过从第一性原理推导其共轭函数，我们可以具体地看到原始问题中的定义域约束（例如计数必须为正）如何转化为对偶问题中的约束。这是理解对偶性如何揭示问题内在结构的绝佳范例。[@problem_id:3439398]", "problem": "考虑一个泊松压缩感知模型，其传感矩阵为 $A \\in \\mathbb{R}^{m \\times n}$，非负数据为 $b \\in \\mathbb{R}_{+}^{m}$。将负泊松对数似然定义为一个可分的扩展实值凸函数 $f : \\mathbb{R}^{m} \\to \\mathbb{R} \\cup \\{+\\infty\\}$，其表达式为\n$$\nf(u) \\;=\\; \\sum_{i=1}^{m} \\Big( u_i \\;-\\; b_i \\ln u_i \\Big),\n$$\n约定当任意分量 $u_i \\le 0$ 时，$f(u) = +\\infty$。令 $\\iota_{C}(\\cdot)$ 表示集合 $C$ 的指示函数，定义为：如果 $z \\in C$，则 $\\iota_{C}(z) = 0$；如果 $z \\notin C$，则 $\\iota_{C}(z) = +\\infty$。\n\n你需要使用凸共轭的基本定义和 Fenchel–Rockafellar 对偶性来分析由 $f$ 导出的对偶结构。具体而言：\n\n- 从凸共轭的定义出发，\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\mathbb{R}^{m}} \\big\\{ \\langle y, u \\rangle \\;-\\; f(u) \\big\\},\n$$\n推导出 $f^{*}(y)$ 的闭式表达式，包括其有效域。你的推导必须从第一性原理（凸共轭的定义、可分和的性质以及逐点上确界的性质）出发，不能引用任何预先记忆的变换表。\n\n- 解释有效域如何编码了形如 $y \\prec \\mathbf{1}$（即对于每个索引 $i$ 都有 $y_i  1$）的逐分量约束，并讨论该域如何作为对偶问题中的一个自然壁垒出现。\n\n- 简要地将你得到的 $f^{*}$ 表达式与通过在 $f$ 的 Fenchel 双共轭公式中进行变量代换 $s_i = \\ln(1 - y_i)$ 所获得的等价表示联系起来，从而揭示形如 $u_i \\exp(s_i)$ 和 $b_i s_i$ 的项是如何在中间优化过程中出现的，以及这与泊松模型中经常出现的指数结构有何关系。\n\n答案规格：\n- 只报告 $f^{*}(y)$ 的最终闭式表达式，使用初等函数，并在需要时使用指示函数 $\\iota_{C}(\\cdot)$ 来编码定义域。\n- 你的最终答案必须是一个单一的精确解析表达式。不要以不等式或方程作为最终答案。", "solution": "所述问题具有科学依据、是良定的、客观的，并包含足够的信息以得出严谨的解。这是凸分析中的一个标准练习，与统计信号处理中优化问题的对偶方法研究直接相关。因此，该问题被认为是有效的，下面给出完整解答。\n\n主要任务是推导函数 $f(u)$ 的凸共轭 $f^{*}(y)$，其中 $f(u)$ 定义为：\n$$\nf(u) \\;=\\; \\sum_{i=1}^{m} \\Big( u_i \\;-\\; b_i \\ln u_i \\Big)\n$$\n$f$ 的有效域为 $\\text{dom}(f) = \\{ u \\in \\mathbb{R}^{m} \\mid u_i  0, \\forall i \\}$，因为如果任意分量 $u_i \\le 0$，则 $f(u) = +\\infty$。数据向量 $b$ 的分量满足 $b_i \\ge 0$。\n\n凸共轭 $f^{*}(y)$ 由上确界定义：\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\mathbb{R}^{m}} \\big\\{ \\langle y, u \\rangle \\;-\\; f(u) \\big\\}\n$$\n代入 $f(u)$ 的表达式和内积 $\\langle y, u \\rangle = \\sum_{i=1}^{m} y_i u_i$：\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\text{dom}(f)} \\left\\{ \\sum_{i=1}^{m} y_i u_i \\;-\\; \\sum_{i=1}^{m} (u_i - b_i \\ln u_i) \\right\\}\n$$\n上确界内的目标函数关于分量 $u_i$ 是可分的。这允许我们交换上确界和求和符号：\n$$\nf^{*}(y) \\;=\\; \\sum_{i=1}^{m} \\sup_{u_i  0} \\left\\{ y_i u_i - (u_i - b_i \\ln u_i) \\right\\} \\;=\\; \\sum_{i=1}^{m} \\sup_{u_i  0} \\left\\{ (y_i - 1) u_i + b_i \\ln u_i \\right\\}\n$$\n令 $f_i^*(y_i)$ 表示此和式中的第 $i$ 项。我们通过求解 $g_i(u_i) = (y_i - 1) u_i + b_i \\ln u_i$ 在定义域 $u_i  0$ 上的上确界来分析每个 $f_i^*(y_i)$。我们根据 $b_i$ 的值分两种情况讨论。\n\n情况 1：$b_i  0$。\n为了求上确界，我们使用一阶最优性条件。$g_i(u_i)$ 关于 $u_i$ 的导数为：\n$$\n\\frac{d g_i}{d u_i} \\;=\\; y_i - 1 + \\frac{b_i}{u_i}\n$$\n令导数为零以寻找临界点：\n$$\ny_i - 1 + \\frac{b_i}{u_i} \\;=\\; 0 \\quad \\implies \\quad \\frac{b_i}{u_i} \\;=\\; 1 - y_i\n$$\n如果 $1 - y_i \\le 0$（即 $y_i \\ge 1$），则对于所有 $u_i  0$，导数 $\\frac{d g_i}{d u_i}$ 是非负的（如果 $y_i  1$ 或 $y_i=1, b_i0$，则为严格为正）。这意味着 $g_i(u_i)$ 是单调递增的，因此它在 $u_i  0$ 上的上确界是无界的：$\\sup_{u_i0} g_i(u_i) = +\\infty$。\n\n如果 $1 - y_i  0$（即 $y_i  1$），则在以下位置存在一个唯一临界点：\n$$\nu_i^* \\;=\\; \\frac{b_i}{1 - y_i}\n$$\n由于 $b_i  0$ 且 $1 - y_i  0$，我们有 $u_i^*  0$，所以该临界点在定义域内。二阶导数为 $\\frac{d^2 g_i}{d u_i^2} = -\\frac{b_i}{u_i^2}$，因为 $b_i  0$，所以二阶导数严格为负。因此，$g_i(u_i)$ 是一个严格凹函数，$u_i^*$ 是其唯一的全局最大值点。上确界的值为 $g_i(u_i^*)$：\n\\begin{align*}\nf_i^*(y_i) = (y_i - 1) u_i^* + b_i \\ln(u_i^*) \\\\\n= (y_i - 1) \\left(\\frac{b_i}{1 - y_i}\\right) + b_i \\ln\\left(\\frac{b_i}{1 - y_i}\\right) \\\\\n= -b_i + b_i (\\ln(b_i) - \\ln(1 - y_i)) \\\\\n= b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i)\n\\end{align*}\n这里，如果任何 $b_i$ 恰好是无穷小，我们遵循标准约定 $0 \\ln 0 = 0$。\n\n情况 2：$b_i = 0$。\n在这种情况下，需要最大化的函数简化为 $g_i(u_i) = (y_i - 1) u_i$。上确界在 $u_i  0$ 的范围内取。\n如果 $y_i - 1  0$（即 $y_i  1$），$g_i(u_i)$ 是一个严格递增的线性函数，所以 $\\sup_{u_i0} g_i(u_i) = +\\infty$。\n如果 $y_i - 1 \\le 0$（即 $y_i \\le 1$），$g_i(u_i)$ 是非正且递减的（如果 $y_i=1$ 则为常数）。当 $u_i \\to 0^+$ 时达到上确界，得到 $\\sup_{u_i0} g_i(u_i) = 0$。\n这可以使用集合 $(-\\infty, 1]$ 的指示函数紧凑地写作：$f_i^*(y_i) = \\iota_{(-\\infty, 1]}(y_i)$。\n\n综合这些结果，总的共轭函数 $f^*(y) = \\sum_{i=1}^m f_i^*(y_i)$ 仅在每一项 $f_i^*(y_i)$ 都为有限时才为有限。这定义了 $f^*$ 的有效域：\n$\\text{dom}(f^*) = \\{ y \\in \\mathbb{R}^m \\mid (b_i  0 \\implies y_i  1) \\text{ and } (b_i = 0 \\implies y_i \\le 1) \\}$。\n\n$f^*(y)$ 的表达式是此域上所有有限值的和：\n$$\nf^{*}(y) = \\sum_{i: b_i  0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right)\n$$\n为了得到一个对所有 $y \\in \\mathbb{R}^m$ 都有效的单一表达式，我们整合了定义域的约束。对于 $b_i  0$ 的索引，对数项自然地约束了 $y_i  1$（因为 $\\ln(z)$ 仅在 $z0$ 时有定义）。对于 $b_i=0$ 的索引，我们必须加上相应的指示函数。因此，完整的表达式为：\n$$\nf^{*}(y) = \\sum_{i: b_i  0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right) + \\sum_{i: b_i = 0} \\iota_{(-\\infty, 1]}(y_i)\n$$\n\n有效域 $\\text{dom}(f^*)$ 编码了对 $y$ 的逐分量约束。在所有观测值 $b_i  0$ 的常见实际情况中，该域简化为 $\\{ y \\in \\mathbb{R}^m \\mid y_i  1, \\forall i \\}$，这恰好是 $y \\prec \\mathbf{1}$。它作为一个“自然壁垒”出现，因为如果任何 $y_i$ 达到或超过 1，共轭函数定义中的上确界就会变为无穷大。这是对偶性的一种体现：原始函数 $f(u)$ 中在 $u_i=0$ 处的壁垒（来自 $\\ln u_i$）在对偶函数 $f^*(y)$ 中感生出一个在 $y_i=1$ 处的镜像壁垒（表现为 $-\\ln(1-y_i)$）。\n\n为了将其与双共轭联系起来，我们使用对于闭的正常凸函数 $f$ 有 $f^{**}=f$ 这一事实。\n$f(u) = f^{**}(u) = \\sup_{y} \\{ \\langle u, y \\rangle - f^*(y) \\}$。\n使用变量代换 $s_i = \\ln(1-y_i)$，这意味着 $y_i = 1 - e^{s_i}$，该优化问题可以对 $s \\in \\mathbb{R}^m$ 进行重新参数化。为简化起见，假设对所有 $i$ 都有 $b_i  0$，将 $y_i$ 和我们得到的 $f^*(y)$ 表达式代入双共轭公式：\n\\begin{align*}\nf(u) = \\sup_{s \\in \\mathbb{R}^m} \\left\\{ \\sum_i u_i (1-e^{s_i}) - \\sum_i (b_i \\ln b_i - b_i - b_i s_i) \\right\\} \\\\\n= \\sum_i (u_i - b_i \\ln b_i + b_i) + \\sup_{s \\in \\mathbb{R}^m} \\left\\{ \\sum_i (b_i s_i - u_i e^{s_i}) \\right\\}\n\\end{align*}\n如题目所要求，我们看到在关于变换后的对偶变量 $s$ 的中间优化中，出现了 $b_i s_i$ 和 $u_i \\exp(s_i)$ 这两项。这种指数结构是指数分布族的特征，泊松分布就属于该族，而这种对偶性阐释了对数似然函数与其对偶表示之间的深层联系。逐项最大化内部的可分和可以恢复出原始函数 $f(u) = \\sum_i (u_i - b_i \\ln u_i)$，从而证实了所推导的共轭函数 $f^*(y)$ 的正确性。", "answer": "$$\\boxed{\\sum_{i: b_i > 0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right) + \\sum_{i: b_i = 0} \\iota_{(-\\infty, 1]}(y_i)}$$", "id": "3439398"}, {"introduction": "在掌握了向量空间中的对偶性之后，我们将把这些概念推广到矩阵空间。这个练习旨在推导核范数最小化问题的对偶形式，这是低秩矩阵恢复理论的基石，在现代数据科学中扮演着核心角色。解决这个问题需要我们运用奇异值和矩阵内积的性质，从而加深对大规模优化问题对偶性的理解。[@problem_id:3439408]", "problem": "令 $\\mathbb{R}^{m \\times n}$ 空间赋以内积 Frobenius 内积 $\\langle X, Y \\rangle = \\operatorname{trace}(X^{\\top} Y)$ 和核范数 $\\|X\\|_{*}$（定义为 $X$ 的奇异值之和）。考虑线性测量算子 $\\mathcal{A} : \\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{p}$，其伴随算子为 $\\mathcal{A}^{*} : \\mathbb{R}^{p} \\to \\mathbb{R}^{m \\times n}$，该伴随算子是关于 Frobenius 内积和标准欧几里得内积定义的。仅使用第一性原理和已验证的事实，从凸共轭和 Fenchel 对偶的定义出发，计算 $f(X) = \\|X\\|_{*}$ 的凸共轭 $f^{*}(Y)$，然后推导矩阵压缩感知问题的 Fenchel 对偶问题\n$$\n\\min_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*} \\quad \\text{约束条件} \\quad \\mathcal{A}(X) = b .\n$$\n您的推导必须依赖于核心定义（凸共轭、伴随算子、次微分）和已验证的事实（例如奇异值分解 (SVD) 的性质和迹不等式），并且必须保持科学上的现实性和自洽性。请将最终答案表示为使用 `pmatrix` 环境排列的行矩阵形式的两个闭式解析表达式，其中第一个条目是 $f^{*}(Y)$ 的表达式，第二个条目是对偶规划的表达式（作为对 $y \\in \\mathbb{R}^{p}$ 在显式约束下的最大化问题）。不需要数值近似。不涉及物理单位。", "solution": "用户要求计算核范数的凸共轭，并推导一个矩阵压缩感知问题的 Fenchel 对偶。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 向量空间为 $\\mathbb{R}^{m \\times n}$。\n- 内积为 Frobenius 内积：$\\langle X, Y \\rangle = \\operatorname{trace}(X^{\\top} Y)$。\n- 待分析的函数为 $f(X) = \\|X\\|_{*}$，其中 $\\|X\\|_{*}$ 是核范数，定义为 $X$ 的奇异值之和。\n- 给定一个线性算子 $\\mathcal{A} : \\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{p}$。\n- 其伴随算子为 $\\mathcal{A}^{*} : \\mathbb{R}^{p} \\to \\mathbb{R}^{m \\times n}$，定义于 Frobenius 内积和标准欧几里得内积，使得对于所有 $X \\in \\mathbb{R}^{m \\times n}$ 和 $y \\in \\mathbb{R}^p$，都有 $\\langle \\mathcal{A}(X), y \\rangle_{\\mathbb{R}^p} = \\langle X, \\mathcal{A}^{*}(y) \\rangle_{\\mathbb{R}^{m \\times n}}$。\n- 原始优化问题为：$\\min_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*}$，约束条件为 $\\mathcal{A}(X) = b$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于凸分析和优化的数学领域，特别是其在压缩感知中的应用。核范数、凸共轭、Fenchel 对偶和伴随算子的概念都是标准且定义明确的。\n- **适定性：** 该问题要求根据给定的条件推导两个特定的数学表达式。已知这些表达式存在且唯一。\n- **客观性：** 问题陈述精确、量化，不含任何主观或基于意见的语言。\n- **自洽性与一致性：** 提供了所有必要的定义和背景。没有内部矛盾。\n\n该问题没有表现出验证标准中列出的任何缺陷。这是优化理论中一个标准的、非平凡的问题。\n\n**步骤3：结论与行动**\n问题有效。将继续进行求解过程。\n\n### 第1部分：核范数的凸共轭\n\n函数为 $f(X) = \\|X\\|_{*}$。其凸共轭（记为 $f^{*}(Y)$）是关于给定的 Frobenius 内积定义的：\n$$\nf^{*}(Y) = \\sup_{X \\in \\mathbb{R}^{m \\times n}} \\{ \\langle Y, X \\rangle - f(X) \\} = \\sup_{X \\in \\mathbb{R}^{m \\times n}} \\{ \\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\}\n$$\n为了计算这个上确界，我们使用 von Neumann 迹不等式。该不等式指出，对于任意两个矩阵 $A, B \\in \\mathbb{R}^{m \\times n}$，有 $\\operatorname{trace}(A^{\\top} B) \\leq \\sum_{i=1}^{\\min(m,n)} \\sigma_i(A) \\sigma_i(B)$，其中 $\\sigma_i(\\cdot)$ 表示按非增顺序排列的第 $i$ 个奇异值。等号成立当且仅当 $A$ 和 $B$ 容许同时奇异值分解，即存在正交矩阵 $U$ 和 $V$ 使得 $A = U \\Sigma_A V^{\\top}$ 和 $B = U \\Sigma_B V^{\\top}$。\n\n将此不等式应用于我们的表达式，得到：\n$$\n\\operatorname{trace}(Y^{\\top} X) \\leq \\sum_{i} \\sigma_i(Y) \\sigma_i(X)\n$$\n核范数为 $\\|X\\|_{*} = \\sum_i \\sigma_i(X)$。将这些代入共轭的定义中，得到：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\leq \\sum_{i} \\sigma_i(Y) \\sigma_i(X) - \\sum_{i} \\sigma_i(X) = \\sum_{i} (\\sigma_i(Y) - 1) \\sigma_i(X)\n$$\n我们根据 $Y$ 的奇异值来分析这个上确界的值。令 $\\|Y\\|_{op} = \\sigma_1(Y)$ 为 $Y$ 的算子范数（或谱范数），即其最大的奇异值。\n\n情况1：$\\|Y\\|_{op}  1$。\n这意味着 $\\sigma_1(Y)  1$。设 $Y$ 的奇异值分解为 $Y = U \\Sigma_Y V^{\\top}$，其中 $u_1$ 和 $v_1$ 是对应于 $\\sigma_1(Y)$ 的第一个左、右奇异向量。我们可以构造一个矩阵 $X = \\alpha u_1 v_1^{\\top}$，其中标量 $\\alpha  0$。矩阵 $X$ 只有一个非零奇异值，即 $\\alpha$。因此，$\\|X\\|_{*} = \\alpha$。内积为：\n$$\n\\operatorname{trace}(Y^{\\top} X) = \\operatorname{trace}((U \\Sigma_Y V^{\\top})^{\\top} (\\alpha u_1 v_1^{\\top})) = \\alpha \\operatorname{trace}(V \\Sigma_Y^{\\top} U^{\\top} u_1 v_1^{\\top})\n$$\n由于 $U^{\\top} u_1 = e_1$（第一个标准基向量）且 $v_1^{\\top}V = e_1^{\\top}$，我们有：\n$$\n\\operatorname{trace}(Y^{\\top} X) = \\alpha \\operatorname{trace}(V \\Sigma_Y^{\\top} e_1 e_1^{\\top} V^{\\top}) = \\alpha \\operatorname{trace}(\\Sigma_Y^{\\top} e_1 e_1^{\\top}) = \\alpha \\sigma_1(Y)\n$$\n上确界的表达式变为：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} = \\alpha \\sigma_1(Y) - \\alpha = \\alpha (\\sigma_1(Y) - 1)\n$$\n由于 $\\sigma_1(Y) - 1  0$，我们可以通过让 $\\alpha \\to \\infty$ 使这个量任意大。因此，如果 $\\|Y\\|_{op}  1$，则上确界为 $+\\infty$。\n$$\nf^{*}(Y) = +\\infty \\quad \\text{如果 } \\|Y\\|_{op}  1\n$$\n\n情况2：$\\|Y\\|_{op} \\leq 1$。\n这意味着对于所有 $i$，都有 $\\sigma_i(Y) \\leq 1$。因此，对于所有 $i$，都有 $\\sigma_i(Y) - 1 \\leq 0$。由于任何矩阵的奇异值都是非负的，即 $\\sigma_i(X) \\geq 0$，所以乘积是非正的：\n$$\n(\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0\n$$\n对所有 $i$ 求和，我们得到 $\\sum_i (\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0$。这为我们的表达式提供了一个上界：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\leq \\sum_{i} (\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0\n$$\n因此，上确界最多为 $0$。为了证明它恰好为 $0$，我们可以选择 $X=0$。对于 $X=0$，我们有 $\\|X\\|_{*} = 0$ 和 $\\operatorname{trace}(Y^{\\top} 0) = 0$，所以 $\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} = 0$。因此，上确界可以达到并且等于 $0$。\n$$\nf^{*}(Y) = 0 \\quad \\text{如果 } \\|Y\\|_{op} \\leq 1\n$$\n\n综合两种情况，核范数的凸共轭是由算子范数定义的单位球的指示函数：\n$$\nf^{*}(Y) = \\iota_{\\{ Z \\in \\mathbb{R}^{m \\times n} \\,:\\, \\|Z\\|_{op} \\leq 1 \\}}(Y) = \\begin{cases} 0  \\text{如果 } \\|Y\\|_{op} \\leq 1 \\\\ +\\infty  \\text{否则} \\end{cases}\n$$\n\n### 第2部分：矩阵压缩感知问题的 Fenchel 对偶\n\n原始问题由下式给出：\n$$\np^{*} = \\inf_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*} \\quad \\text{约束条件} \\quad \\mathcal{A}(X) = b\n$$\n我们可以通过定义以下函数，将此问题重写为 Fenchel 对偶的标准形式 $\\inf_X \\{ F(X) + G(\\mathcal{A}(X)) \\}$：\n1. $F(X) = \\|X\\|_{*}$\n2. $G(z) = \\iota_{\\{b\\}}(z)$，这是单点集 $\\{b\\} \\subset \\mathbb{R}^p$ 的指示函数。如果 $z=b$，则 $G(z) = 0$；如果 $z \\neq b$，则 $G(z) = +\\infty$。\n\n原始问题等价于 $\\inf_{X \\in \\mathbb{R}^{m \\times n}} \\{ F(X) + G(\\mathcal{A}(X)) \\}$。\nFenchel 对偶问题由下式给出：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ -F^{*}(\\mathcal{A}^{*}(y)) - G^{*}(-y) \\}\n$$\n我们需要计算凸共轭 $F^*$ 和 $G^*$。\n从第1部分可知，$F(X) = \\|X\\|_{*}$ 的共轭为：\n$$\nF^{*}(Y) = \\iota_{\\{ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\}}(Y)\n$$\n将其应用于自变量 $\\mathcal{A}^{*}(y)$，我们得到：\n$$\nF^{*}(\\mathcal{A}^{*}(y)) = \\iota_{\\{ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\}}(\\mathcal{A}^{*}(y))\n$$\n如果 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$，则该项为 $0$；否则为 $+\\infty$。\n\n接下来，我们计算 $G(z) = \\iota_{\\{b\\}}(z)$ 的共轭。$\\mathbb{R}^p$ 中的内积是标准点积 $\\langle v, z \\rangle = v^{\\top}z$。\n$$\nG^{*}(v) = \\sup_{z \\in \\mathbb{R}^{p}} \\{ v^{\\top}z - G(z) \\} = \\sup_{z \\in \\mathbb{R}^{p}} \\{ v^{\\top}z - \\iota_{\\{b\\}}(z) \\}\n$$\n$G(z)$ 的定义域是单点 $z=b$，因此上确界是在这一点上计算的：\n$$\nG^{*}(v) = v^{\\top}b\n$$\n对于对偶公式，我们需要 $G^{*}(-y)$：\n$$\nG^{*}(-y) = (-y)^{\\top}b = -y^{\\top}b = -b^{\\top}y\n$$\n将 $F^{*}$ 和 $G^{*}$ 代入对偶问题的表达式中：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ -F^{*}(\\mathcal{A}^{*}(y)) - (-b^{\\top}y) \\} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y - \\iota_{\\{ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\}}(\\mathcal{A}^{*}(y)) \\}\n$$\n项 $\\iota_{\\{ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\}}(\\mathcal{A}^{*}(y))$ 在 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$ 时为 $0$，否则为 $+\\infty$。为了最大化该表达式，我们必须避免指示函数为 $+\\infty$ 的情况，因为这会使目标函数变为 $-\\infty$。因此，最大化被隐式地限制在指示函数为有限值（即等于 $0$）的定义域上。这给了我们约束条件 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$。\n在这个可行集内，问题简化为：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y - 0 \\} \\quad \\text{约束条件} \\quad \\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1\n$$\n因此，Fenchel 对偶问题是：\n$$\n\\max_{y \\in \\mathbb{R}^{p}} b^{\\top}y \\quad \\text{约束条件} \\quad \\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1\n$$\n\n最终答案需要 $f^*(Y)$ 的表达式和对偶规划。我将它们以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\iota_{\\{ Y \\in \\mathbb{R}^{m \\times n} : \\|Y\\|_{op} \\leq 1 \\}}(Y)  \\max_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y \\mid \\| \\mathcal{A}^{*}(y) \\|_{op} \\leq 1 \\}\n\\end{pmatrix}\n}\n$$", "id": "3439408"}, {"introduction": "在学会构建对偶问题后，一个自然的问题是“它们有什么用？”。本练习将展示一个强大的应用：利用对偶问题推导“安全筛选”（safe screening）规则，从而显著加速原始问题的求解。通过这个练习，我们将看到对偶理论框架如何直接转化为实际的算法性能提升，揭示了对偶间隙和对偶变量在优化过程中的关键作用。[@problem_id:3439416]", "problem": "考虑稀疏优化中的全变分 Lasso (TV-Lasso) 分析正则化最小二乘问题，该问题为一个传感矩阵 $A \\in \\mathbb{R}^{m \\times n}$、一个差分（分析）算子 $D \\in \\mathbb{R}^{p \\times n}$、一个数据向量 $b \\in \\mathbb{R}^{m}$ 和一个正则化参数 $\\lambda  0$ 定义：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|D x\\|_{1}.\n$$\n令 $f(y) := \\frac{1}{2} \\|y - b\\|_{2}^{2}$ 对于 $y \\in \\mathbb{R}^{m}$，且 $h(w) := \\lambda \\|w\\|_{1}$ 对于 $w \\in \\mathbb{R}^{p}$。仅使用凸共轭和 Fenchel 对偶的基本定义，执行以下步骤：\n\n1. 从第一性原理（即凸共轭的定义）计算凸共轭 $f^{*}$ 和 $h^{*}$，并用它们推导出 TV-Lasso 的 Fenchel 对偶问题，其形式为关于对偶变量 $u \\in \\mathbb{R}^{m}$ 和 $z \\in \\mathbb{R}^{p}$ 的最大化问题，并带有一个显式的线性耦合约束。明确陈述对偶可行集，用关于 $z$ 的不等式约束和 $u$ 与 $z$ 之间的线性关系表示。将 $z$ 解释为与分析算子相关联的对偶流。\n\n2. 令 $x_{t} \\in \\mathbb{R}^{n}$ 为任意原始候选解，并令 $(u_{t}, z_{t})$ 为任意对偶可行对。定义原始-对偶间隙 \n$$\nG_{t} := f(A x_{t}) + h(D x_{t}) + f^{*}(u_{t}) + h^{*}(z_{t}),\n$$\n并回顾 $h^{*}$ 是对偶范数球的指示函数。仅使用 $f^{*}$ 的强凸性和基本不等式，推导出一个在对偶变量 $u$ 中的欧几里得球，该球保证包含对偶最优解 $u^{\\star}$。你的推导必须从强凸性和 Fenchel-Young 不等式的定义开始，并且在不假定任何现成的安全法则公式的情况下进行。\n\n3. 以完全简化的闭式形式，表达出以 $u_{t}$ 为中心、仅能通过 $G_{t}$ 和 $f^{*}$ 的性质证明的、包含对偶最优解的最小全局有效欧几里得球的半径 $\\rho_{t}$。\n\n你的最终答案必须是一个单一的闭式表达式。不需要数值计算，也不涉及单位。不要提供不等式或集合作为最终答案；只提供闭式形式的半径。", "solution": "该问题要求对全变分 Lasso (TV-Lasso) 问题的 Fenchel 对偶进行三部分推导，最终得到一个包含对偶最优解的球的半径表达式。\n\n原始问题由下式给出：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|D x\\|_{1}\n$$\n我们定义 $f(y) := \\frac{1}{2} \\|y - b\\|_{2}^{2}$ 和 $h(w) := \\lambda \\|w\\|_{1}$。原始问题可以写成 $\\min_{x \\in \\mathbb{R}^{n}} f(Ax) + h(Dx)$。\n\n第 1 部分：Fenchel 对偶的推导\n\n首先，我们计算 $f(y)$ 的凸共轭 $f^*(u)$。根据定义，\n$$\nf^*(u) = \\sup_{y \\in \\mathbb{R}^{m}} \\{ \\langle u, y \\rangle - f(y) \\} = \\sup_{y \\in \\mathbb{R}^{m}} \\left\\{ \\langle u, y \\rangle - \\frac{1}{2} \\|y - b\\|_{2}^{2} \\right\\}\n$$\n上确界内的表达式是关于 $y$ 的严格凹二次函数。通过将其关于 $y$ 的梯度设为零，可以找到其唯一最大值：\n$$\n\\nabla_y \\left( \\langle u, y \\rangle - \\frac{1}{2} (y - b)^T(y - b) \\right) = u - (y - b) = 0\n$$\n这给出了最大化值 $y_{\\text{opt}} = u + b$。将此代回 $f^*(u)$ 的表达式中：\n$$\nf^*(u) = \\langle u, u + b \\rangle - \\frac{1}{2} \\|(u + b) - b\\|_{2}^{2} = \\|u\\|_{2}^{2} + \\langle u, b \\rangle - \\frac{1}{2} \\|u\\|_{2}^{2} = \\frac{1}{2} \\|u\\|_{2}^{2} + \\langle u, b \\rangle\n$$\n接下来，我们计算 $h(w)$ 的凸共轭 $h^*(z)$。根据定义，\n$$\nh^*(z) = \\sup_{w \\in \\mathbb{R}^{p}} \\{ \\langle z, w \\rangle - h(w) \\} = \\sup_{w \\in \\mathbb{R}^{p}} \\{ \\langle z, w \\rangle - \\lambda \\|w\\|_{1} \\}\n$$\n我们基于 $\\ell_1$-范数的对偶范数（即 $\\ell_\\infty$-范数，$\\|z\\|_{\\infty} = \\max_i |z_i|$）分两种情况进行分析。\n情况 1: $\\|z\\|_{\\infty}  \\lambda$。存在一个索引 $k$ 使得 $|z_k|  \\lambda$。我们选择 $w = c \\cdot \\text{sgn}(z_k) e_k$，其中 $e_k$ 是第 $k$ 个标准基向量且 $c  0$。那么 $\\langle z, w \\rangle = c |z_k|$ 且 $\\|w\\|_1 = c$。该表达式变为 $c |z_k| - \\lambda c = c(|z_k| - \\lambda)$。当 $c \\to \\infty$ 时，此表达式趋于 $\\infty$。因此，$h^*(z) = \\infty$。\n情况 2: $\\|z\\|_{\\infty} \\le \\lambda$。根据 Hölder 不等式，我们有 $\\langle z, w \\rangle \\le \\|z\\|_{\\infty} \\|w\\|_{1}$。因此，$\\langle z, w \\rangle - \\lambda \\|w\\|_{1} \\le \\|z\\|_{\\infty} \\|w\\|_{1} - \\lambda \\|w\\|_{1} = (\\|z\\|_{\\infty} - \\lambda) \\|w\\|_{1}$。由于 $\\|z\\|_{\\infty} \\le \\lambda$，此量为非正数。上确界值为 $0$，在 $w=0$ 时达到。\n结合这些情况，$h^*(z)$ 是集合 $\\{z \\in \\mathbb{R}^p \\mid \\|z\\|_{\\infty} \\le \\lambda\\}$ 的指示函数：\n$$\nh^*(z) = \\iota_{\\{\\|z\\|_{\\infty} \\le \\lambda\\}}(z) = \\begin{cases} 0  \\text{if } \\|z\\|_{\\infty} \\le \\lambda \\\\ \\infty  \\text{otherwise} \\end{cases}\n$$\n为了找到 Fenchel 对偶，我们引入辅助变量并构造拉格朗日函数。该问题等价于 $\\min_{x, y, w} \\{ f(y) + h(w) \\}$ 满足约束 $y=Ax$ 和 $w=Dx$。拉格朗日函数为：\n$$\n\\mathcal{L}(x, y, w, u, z) = f(y) + h(w) + \\langle u, Ax - y \\rangle + \\langle z, Dx - w \\rangle\n$$\n$$\n\\mathcal{L}(x, y, w, u, z) = \\langle x, A^T u + D^T z \\rangle + (f(y) - \\langle u, y \\rangle) + (h(w) - \\langle z, w \\rangle)\n$$\n对偶函数是 $g(u,z) = \\inf_{x,y,w} \\mathcal{L}$。关于 $y$ 的下确界是 $-f^*(u)$，关于 $w$ 的下确界是 $-h^*(z)$。关于 $x$ 的下确界在 $A^T u + D^T z = 0$ 时为 $0$，否则为 $-\\infty$。因此，为了使对偶目标有限，我们必须有约束 $A^T u + D^T z = 0$。\n对偶问题是最大化对偶函数：\n$$\n\\max_{u, z} \\left\\{ -f^*(u) - h^*(z) \\right\\} \\quad \\text{subject to} \\quad A^T u + D^T z = 0\n$$\n代入推导出的共轭函数：\n$$\n\\max_{u \\in \\mathbb{R}^{m}, z \\in \\mathbb{R}^{p}} \\left\\{ -\\left(\\frac{1}{2}\\|u\\|_{2}^{2} + \\langle u, b \\rangle\\right) - \\iota_{\\{\\|z\\|_{\\infty} \\le \\lambda\\}}(z) \\right\\} \\quad \\text{subject to} \\quad A^T u + D^T z = 0\n$$\n指示函数可以写成一个显式约束。因此，对偶问题是：\n$$\n\\max_{u \\in \\mathbb{R}^{m}, z \\in \\mathbb{R}^{p}} \\quad -\\frac{1}{2}\\|u\\|_{2}^{2} - \\langle u, b \\rangle \\quad \\text{subject to} \\quad A^T u + D^T z = 0, \\quad \\|z\\|_{\\infty} \\le \\lambda\n$$\n对偶可行集是所有满足线性耦合约束 $A^T u + D^T z = 0$ 和不等式约束 $\\|z\\|_{\\infty} \\le \\lambda$ 的对 $(u,z) \\in \\mathbb{R}^m \\times \\mathbb{R}^p$ 的集合。变量 $z$ 是与分析项 $Dx$ 相关联的对偶变量，可以解释为对偶流。\n\n第 2 部分：对偶最优解的包含球的推导\n\n令 $P(x) = f(Ax) + h(Dx)$ 为原始目标。令 $\\mathcal{D}(u,z) = -f^*(u) - h^*(z)$ 为对偶目标。\n令 $(x^\\star, u^\\star, z^\\star)$ 为一个原始-对偶最优对。根据强对偶性，$P(x^\\star) = \\mathcal{D}(u^\\star,z^\\star)$。\n在原始候选解 $x_t$ 和对偶可行对 $(u_t, z_t)$ 处的原始-对偶间隙为：\n$$\nG_t = P(x_t) - \\mathcal{D}(u_t,z_t) = f(Ax_t) + h(Dx_t) - (-f^*(u_t) - h^*(z_t)) = f(Ax_t) + h(Dx_t) + f^*(u_t) + h^*(z_t)\n$$\n这与所提供的定义相符。由于 $(u_t, z_t)$ 是对偶可行的，所以 $h^*(z_t) = 0$。\n根据最优性的定义，$P(x_t) \\ge P(x^\\star)$。因此，间隙 $G_t$ 满足：\n$$\nG_t = P(x_t) - \\mathcal{D}(u_t,z_t) \\ge P(x^\\star) - \\mathcal{D}(u_t,z_t)\n$$\n使用强对偶性 $P(x^\\star) = \\mathcal{D}(u^\\star,z^\\star)$：\n$$\nG_t \\ge \\mathcal{D}(u^\\star,z^\\star) - \\mathcal{D}(u_t,z_t) = [-f^*(u^\\star) - h^*(z^\\star)] - [-f^*(u_t) - h^*(z_t)]\n$$\n由于 $(u_t, z_t)$ 和 $(u^\\star, z^\\star)$ 都是对偶可行的，因此 $h^*(z_t)=0$ 且 $h^*(z^\\star)=0$。该不等式简化为：\n$$\nG_t \\ge f^*(u_t) - f^*(u^\\star)\n$$\n现在，我们使用 $f^*(u) = \\frac{1}{2}\\|u\\|_2^2 + \\langle u, b \\rangle$ 的性质。其 Hessian 矩阵为 $\\nabla^2 f^*(u) = I$，是正定的。因此，$f^*$ 是 $1$-强凸的。对于一个可微的 $1$-强凸函数，对任意 $u_t, u^\\star$ 我们有：\n$$\nf^*(u_t) \\ge f^*(u^\\star) + \\langle \\nabla f^*(u^\\star), u_t - u^\\star \\rangle + \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n对偶问题可以看作是在凸集 $\\mathcal{U} = \\{ u \\mid \\exists z \\text{ with } \\|z\\|_\\infty \\le \\lambda \\text{ and } A^T u + D^T z = 0 \\}$ 上最小化 $f^*(u)$。对于凸集 $\\mathcal{U}$ 上的最小化子 $u^\\star$ 的一阶最优性条件是，对于任何其他点 $u_t \\in \\mathcal{U}$：\n$$\n\\langle \\nabla f^*(u^\\star), u_t - u^\\star \\rangle \\ge 0\n$$\n由于强凸性不等式中的梯度项是非负的，我们可以去掉它以得到一个较弱的不等式：\n$$\nf^*(u_t) \\ge f^*(u^\\star) + \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n整理可得：\n$$\nf^*(u_t) - f^*(u^\\star) \\ge \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n结合我们的两个主要不等式，我们得到：\n$$\nG_t \\ge f^*(u_t) - f^*(u^\\star) \\ge \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n这得出了最终的不等式：\n$$\n\\|u_t - u^\\star\\|_2^2 \\le 2 G_t \\quad \\implies \\quad \\|u_t - u^\\star\\|_2 \\le \\sqrt{2 G_t}\n$$\n这个结果表明，任何对偶最优解 $u^\\star$ 都必须位于以当前对偶迭代 $u_t$ 为中心、半径为 $\\sqrt{2 G_t}$ 的欧几里得球内。\n\n第 3 部分：所证球的半径\n\n根据第 2 部分的推导，仅基于间隙 $G_t$ 和 $f^*$ 的性质，保证包含对偶最优解 $u^\\star$ 的、以 $u_t$ 为中心的最小欧几里得球的半径 $\\rho_t$ 由下式给出：\n$$\n\\rho_t = \\sqrt{2 G_t}\n$$\n这个表达式提供了一个关于对偶解位置的可计算的、全局有效的界。", "answer": "$$\n\\boxed{\\sqrt{2G_t}}\n$$", "id": "3439416"}]}