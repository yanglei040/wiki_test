{"hands_on_practices": [{"introduction": "许多用于求解重叠组 LASSO 的高效算法都依赖于一种“潜变量”或“变量分裂”的表述形式。这项练习旨在将这一抽象概念具体化。通过为一个小型实例手动构建复制矩阵及相关量，你将对支撑高效优化的代数机制建立起扎实的直观理解。[@problem_id:3465480]", "problem": "考虑在压缩感知和稀疏优化中使用的潜变量表示法中的重叠组最小绝对收缩和选择算子 (LASSO) 惩罚项。设有一个参数向量 $\\beta \\in \\mathbb{R}^{p}$，其中 $p=5$，以及重叠组 $g_1=\\{1,2,3\\}$，$g_2=\\{3,4\\}$ 和 $g_3=\\{4,5\\}$。在潜变量重构中，对每个组 $g$，引入一个组限制的潜变量 $\\beta^{(g)} \\in \\mathbb{R}^{|g|}$，它存储由 $g$ 索引的 $\\beta$ 的分量的副本。通过按 $(g_1,g_2,g_3)$ 的顺序拼接 $\\beta^{(g)}$，定义堆叠的潜变量向量 $z \\in \\mathbb{R}^{\\sum_{g} |g|}$。重复映射 $D \\in \\mathbb{R}^{(\\sum_{g} |g|)\\times p}$ 由线性关系 $z = D \\beta$ 定义，其中 $D$ 的每一行选择与该行索引的潜变量副本相对应的 $\\beta$ 的分量。\n\n从上述重复映射的基本定义和潜变量构造出发，完成以下任务：\n- 明确地用 $\\beta$ 的元素写出潜变量向量 $\\beta^{(g_1)}$、$\\beta^{(g_2)}$ 和 $\\beta^{(g_3)}$。\n- 明确构造矩阵 $D$。\n- 以矩阵形式写出连接 $z$ 和 $\\beta$ 的共识约束。\n\n然后，仅使用线性代数运算，不借助任何预先给出的简化公式，推导 $D^{\\top} D$ 并计算其行列式。将行列式作为你的最终答案。如果最终结果是数字，请给出精确值；无需四舍五入。", "solution": "我们从重叠组的潜变量构造开始：对于每个组 $g \\subset \\{1,\\dots,p\\}$，我们引入一个潜变量向量 $\\beta^{(g)} \\in \\mathbb{R}^{|g|}$，它存储由 $g$ 索引的 $\\beta$ 的分量的副本。堆叠的潜变量向量形成为 $z = \\big(\\beta^{(g_1)};\\beta^{(g_2)};\\beta^{(g_3)}\\big) \\in \\mathbb{R}^{|g_1|+|g_2|+|g_3|}$，其中我们用分号表示垂直拼接。\n\n给定 $p=5$ 和组 $g_1=\\{1,2,3\\}$、$g_2=\\{3,4\\}$ 和 $g_3=\\{4,5\\}$，潜变量是 $\\beta = (\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\beta_5)^{\\top}$ 的组限制副本：\n- 对于 $g_1=\\{1,2,3\\}$，潜变量向量是\n$$\n\\beta^{(g_1)} = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix}.\n$$\n- 对于 $g_2=\\{3,4\\}$，潜变量向量是\n$$\n\\beta^{(g_2)} = \\begin{pmatrix} \\beta_3 \\\\ \\beta_4 \\end{pmatrix}.\n$$\n- 对于 $g_3=\\{4,5\\}$，潜变量向量是\n$$\n\\beta^{(g_3)} = \\begin{pmatrix} \\beta_4 \\\\ \\beta_5 \\end{pmatrix}.\n$$\n\n按 $(g_1,g_2,g_3)$ 的顺序拼接，得到堆叠的潜变量向量 $z \\in \\mathbb{R}^{7}$：\n$$\nz \\;=\\; \\begin{pmatrix}\n\\beta^{(g_1)} \\\\ \\beta^{(g_2)} \\\\ \\beta^{(g_3)}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\\\ \\beta_3 \\\\ \\beta_4 \\\\ \\beta_4 \\\\ \\beta_5\n\\end{pmatrix}.\n$$\n\n根据重复映射的定义，存在一个矩阵 $D \\in \\mathbb{R}^{7 \\times 5}$ 使得 $z = D \\beta$。$D$ 的每一行在与被复制的 $\\beta$ 的索引相对应的列中放置一个 $1$，在其他位置放置零。按照上面写出的 $z$ 中元素的顺序， $D$ 的七行是：\n- 第 1 行对应于 $\\beta_1$，\n- 第 2 行对应于 $\\beta_2$，\n- 第 3 行和第 4 行都对应于 $\\beta_3$（由于 $g_1$ 和 $g_2$ 之间的重叠），\n- 第 5 行和第 6 行都对应于 $\\beta_4$（由于 $g_2$ 和 $g_3$ 之间的重叠），\n- 第 7 行对应于 $\\beta_5$。\n\n因此，\n$$\nD \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}.\n$$\n\n将潜变量副本与原始变量联系起来的共识约束正是线性关系\n$$\nz - D \\beta \\;=\\; 0,\n$$\n等价于 $z = D \\beta$。这确保了共享坐标的所有组级别副本都等于相应的原始坐标。以坐标形式，这强制执行了诸如索引 3 的两个副本等于 $\\beta_3$，以及索引 4 的两个副本等于 $\\beta_4$ 之类的等式。\n\n接下来，我们计算 $D^{\\top} D$。根据构造，$D$ 的每一行恰好有一个元素等于 $1$，所有其他元素都为 $0$，并且当一个原始索引出现在多个组中时，就会出现重复行。因此，乘积 $D^{\\top} D$ 是一个对角矩阵，其第 $(i,i)$ 个元素等于索引 $i$ 在所有组中出现的次数。我们明确地验证这一点。\n\n设 $e_i \\in \\mathbb{R}^{5}$ 是第 $i$ 个标准基向量。$D$ 的每一行都是某个 $e_i^{\\top}$。如果一个索引 $i$ 在堆叠的潜变量向量 $z$ 中（即在各组中）出现 $c_i$ 次，那么 $D$ 就包含 $c_i$ 个 $e_i^{\\top}$ 行的副本。因此，\n$$\nD^{\\top} D \\;=\\; \\sum_{k=1}^{7} r_k^{\\top} r_k \\;=\\; \\sum_{i=1}^{5} c_i \\, e_i e_i^{\\top} \\;=\\; \\operatorname{diag}(c_1, c_2, c_3, c_4, c_5),\n$$\n其中 $r_k$ 表示 $D$ 的第 $k$ 行。\n\n从组结构中计算出现次数：\n- 索引 $1$ 仅出现在 $g_1$ 中，所以 $c_1 = 1$。\n- 索引 $2$ 仅出现在 $g_1$ 中，所以 $c_2 = 1$。\n- 索引 $3$ 出现在 $g_1$ 和 $g_2$ 中，所以 $c_3 = 2$。\n- 索引 $4$ 出现在 $g_2$ 和 $g_3$ 中，所以 $c_4 = 2$。\n- 索引 $5$ 仅出现在 $g_3$ 中，所以 $c_5 = 1$。\n\n因此，\n$$\nD^{\\top} D \\;=\\; \\operatorname{diag}(1,\\,1,\\,2,\\,2,\\,1).\n$$\n\n最后，对角矩阵的行列式是其对角元素的乘积。因此，\n$$\n\\det(D^{\\top} D) \\;=\\; 1 \\times 1 \\times 2 \\times 2 \\times 1 \\;=\\; 4.\n$$\n\n这就是所要求的标量值。", "answer": "$$\\boxed{4}$$", "id": "3465480"}, {"introduction": "理解了模型的结构之后，让我们来探索其解的性质。使用重叠组的一个关键动机是它能够选择比非重叠组 LASSO 更灵活的特征集。本练习通过一个精心设计的例子来展示这一特性，并提供应用次梯度最优性条件的实践经验，这是分析和验证解的关键。[@problem_id:3465473]", "problem": "考虑一个维度为 $p=4$ 的重叠组最小绝对收缩和选择算子 (LASSO) 问题，该问题具有平方误差数据拟合项和两个重叠组。设决策变量为 $x \\in \\mathbb{R}^{4}$，并考虑以下凸优化问题\n$$\n\\min_{x \\in \\mathbb{R}^{4}} \\;\\; \\frac{1}{2}\\|x - b\\|_{2}^{2} + \\lambda\\Big(\\|x_{G_{1}}\\|_{2} + \\|x_{G_{2}}\\|_{2}\\Big),\n$$\n其中，组为 $G_{1}=\\{1,2\\}$ 和 $G_{2}=\\{2,3,4\\}$，且 $\\lambda>0$。向量 $x_{G}$ 表示 $x$ 中仅包含索引集 $G$ 中元素的子向量。取 $\\lambda=1$，数据向量 $b \\in \\mathbb{R}^{4}$ 为\n$$\nb_{1}=0, \\quad b_{2}=3+\\frac{2}{\\sqrt{5}}, \\quad b_{3}=1+\\frac{1}{\\sqrt{5}}, \\quad b_{4}=0.\n$$\n从凸优化最优性的基本原理和重叠组惩罚项的次梯度微积分出发，分析此实例。证明唯一最小化子 $x^{\\star}$ 的支撑集等于特征的并集 $\\{2,3\\}$，而该集合无法表示为同一组系统 $\\{G_{1},G_{2}\\}$ 中不相交的完整组的并集。并确定在交集特征 2 处的精确最优次梯度坐标，即在 $x^{\\star}$ 处参与最优性条件的惩罚项次梯度的第二个分量的值。\n\n将在最优点处特征 2 上的该次梯度坐标的精确值作为最终答案。不要四舍五入；请提供一个精确的封闭形式表达式。", "solution": "用户提供的问题是一个属于重叠组 LASSO 类别的凸优化问题。该问题有科学依据、良定、客观，并包含获得唯一解所需的所有必要信息。因此，该问题被视为有效，并将提供完整的解答。\n\n该优化问题由下式给出\n$$\n\\min_{x \\in \\mathbb{R}^{4}} \\;\\; f(x) := \\frac{1}{2}\\|x - b\\|_{2}^{2} + \\lambda\\Omega(x),\n$$\n其中惩罚项为 $\\Omega(x) = \\|x_{G_{1}}\\|_{2} + \\|x_{G_{2}}\\|_{2}$。问题参数指定如下：\n- 维度: $p=4$。\n- 组: $G_{1}=\\{1,2\\}$ 和 $G_{2}=\\{2,3,4\\}$。\n- 正则化参数: $\\lambda=1$。\n- 数据向量 $b \\in \\mathbb{R}^{4}$: $b_{1}=0$, $b_{2}=3+\\frac{2}{\\sqrt{5}}$, $b_{3}=1+\\frac{1}{\\sqrt{5}}$, $b_{4}=0$。\n\n目标函数 $f(x)$ 是严格凸的，因为它是一个严格凸函数（平方欧几里得范数）和一个凸函数（组 LASSO 惩罚项）的和。因此，存在一个唯一的最小化子 $x^{\\star}$。最优性的一阶充要条件是零向量必须属于 $f(x)$ 在 $x=x^{\\star}$ 处的次微分：\n$$\n0 \\in \\partial f(x^{\\star}) = (x^{\\star} - b) + \\lambda \\partial\\Omega(x^{\\star}).\n$$\n这个条件可以重写为 $b - x^{\\star} \\in \\lambda \\partial\\Omega(x^{\\star})$。当 $\\lambda=1$ 时，这简化为 $b - x^{\\star} \\in \\partial\\Omega(x^{\\star})$。这意味着向量 $b - x^{\\star}$ 必须是惩罚项 $\\Omega(x)$ 在最优点 $x^{\\star}$ 处的一个次梯度。\n\n惩罚项 $\\Omega(x)$ 的次微分由其构成的范数项的次微分之和给出：$\\partial\\Omega(x) = \\partial_x (\\|x_{G_1}\\|_2) + \\partial_x (\\|x_{G_2}\\|_2)$。$\\partial\\Omega(x)$ 中的一个元素 $g \\in \\mathbb{R}^4$ 是形式为 $g = u + v$ 的向量，其中 $u \\in \\partial_x (\\|x_{G_1}\\|_2)$ 且 $v \\in \\partial_x (\\|x_{G_2}\\|_2)$。向量 $u$ 和 $v$ 的支撑集分别限制在 $G_1$ 和 $G_2$ 上。\n子向量 $x_G$ 的欧几里得范数的次梯度为：\n- 如果 $x_G \\neq 0$，$\\partial_x(\\|x_G\\|_2)$ 是包含向量 $u$ 的单元素集，其中 $u_G = x_G/\\|x_G\\|_2$ 且 $u_{G^c}=0$。\n- 如果 $x_G = 0$，$\\partial_x(\\|x_G\\|_2)$ 是向量 $u$ 的集合，其中 $\\|u_G\\|_2 \\le 1$ 且 $u_{G^c}=0$。\n\n问题要求我们证明最小化子的支撑集是 $\\{2, 3\\}$。让我们假设这是真的，即 $x^{\\star}_1=0$，$x^{\\star}_4=0$，并且 $x^{\\star}_2 \\neq 0, x^{\\star}_3 \\neq 0$。\n在这个假设下，对应于组的子向量是 $x^{\\star}_{G_1} = (0, x^{\\star}_2)$ 和 $x^{\\star}_{G_2} = (x^{\\star}_2, x^{\\star}_3, 0)$。两者都是非零向量。因此，惩罚项 $\\Omega(x)$ 在 $x^{\\star}$ 处是可微的，其次微分 $\\partial\\Omega(x^{\\star})$ 是一个只包含梯度 $\\nabla\\Omega(x^{\\star})$ 的单元素集。\n\n让我们计算唯一的次梯度 $g^{\\star} \\in \\partial\\Omega(x^{\\star})$。\n对于 $G_1 = \\{1,2\\}$，我们有 $x^{\\star}_{G_1}=(0, x^{\\star}_2)$。相应的次梯度分量向量 $u^{\\star}$ 在 $G_1$ 上的分量由 $x^{\\star}_{G_1} / \\|x^{\\star}_{G_1}\\|_2 = (0, x^{\\star}_2) / |x^{\\star}_2| = (0, \\text{sgn}(x^{\\star}_2))$ 给出。所以 $u^{\\star}_1=0$ 且 $u^{\\star}_2=\\text{sgn}(x^{\\star}_2)$。\n对于 $G_2 = \\{2,3,4\\}$，我们有 $x^{\\star}_{G_2}=(x^{\\star}_2, x^{\\star}_3, 0)$。相应的次梯度分量向量 $v^{\\star}$ 在 $G_2$ 上的分量由 $x^{\\star}_{G_2} / \\|x^{\\star}_{G_2}\\|_2 = (x^{\\star}_2, x^{\\star}_3, 0) / \\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}$ 给出。所以，$v^{\\star}_2 = x^{\\star}_2 / \\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}$，$v^{\\star}_3 = x^{\\star}_3 / \\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}$，并且 $v^{\\star}_4=0$。\n\n总次梯度 $g^{\\star} = u^{\\star} + v^{\\star}$ 的分量是：\n$g^{\\star}_1 = u^{\\star}_1 = 0$\n$g^{\\star}_2 = u^{\\star}_2 + v^{\\star}_2 = \\text{sgn}(x^{\\star}_2) + \\frac{x^{\\star}_2}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}}$\n$g^{\\star}_3 = v^{\\star}_3 = \\frac{x^{\\star}_3}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}}$\n$g^{\\star}_4 = v^{\\star}_4 = 0$\n\n最优性条件 $b - x^{\\star} = g^{\\star}$ 提供了一个方程组。由于 $b_2 > 0$ 且 $b_3 > 0$，我们可以合理地假设 $x^{\\star}_2 > 0$ 且 $x^{\\star}_3 > 0$。那么 $\\text{sgn}(x^{\\star}_2)=1$。\n对于活跃索引 $j \\in \\{2,3\\}$：\n1) $b_2 - x^{\\star}_2 = 1 + \\frac{x^{\\star}_2}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}}$\n2) $b_3 - x^{\\star}_3 = \\frac{x^{\\star}_3}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}}$\n\n从方程(2)中，我们可以表示出 $\\frac{1}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}} = \\frac{b_3 - x^{\\star}_3}{x^{\\star}_3}$。将其代入方程(1)中：\n$b_2 - x^{\\star}_2 = 1 + x^{\\star}_2 \\left( \\frac{b_3 - x^{\\star}_3}{x^{\\star}_3} \\right) = 1 + \\frac{b_3 x^{\\star}_2}{x^{\\star}_3} - x^{\\star}_2$\n$b_2 - 1 = \\frac{b_3 x^{\\star}_2}{x^{\\star}_3} \\implies x^{\\star}_3 = \\frac{b_3}{b_2 - 1} x^{\\star}_2$。\n\n让我们代入 $b_2$ 和 $b_3$ 的给定值：\n$b_2 - 1 = \\left(3 + \\frac{2}{\\sqrt{5}}\\right) - 1 = 2 + \\frac{2}{\\sqrt{5}} = \\frac{2\\sqrt{5}+2}{\\sqrt{5}}$。\n$b_3 = 1 + \\frac{1}{\\sqrt{5}} = \\frac{\\sqrt{5}+1}{\\sqrt{5}}$。\n比值为 $\\frac{b_3}{b_2 - 1} = \\frac{(\\sqrt{5}+1)/\\sqrt{5}}{2(\\sqrt{5}+1)/\\sqrt{5}} = \\frac{1}{2}$。\n因此，我们得到线性关系 $x^{\\star}_3 = \\frac{1}{2} x^{\\star}_2$。\n\n现在，将此关系代回方程(2)：\n$\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2} = \\sqrt{(2x^{\\star}_3)^2 + (x^{\\star}_3)^2} = \\sqrt{5(x^{\\star}_3)^2} = \\sqrt{5}x^{\\star}_3$ (因为我们假设了 $x^{\\star}_3>0$)。\n方程(2)变为 $b_3 - x^{\\star}_3 = \\frac{x^{\\star}_3}{\\sqrt{5}x^{\\star}_3} = \\frac{1}{\\sqrt{5}}$。\n解出 $x^{\\star}_3$：\n$x^{\\star}_3 = b_3 - \\frac{1}{\\sqrt{5}} = \\left(1 + \\frac{1}{\\sqrt{5}}\\right) - \\frac{1}{\\sqrt{5}} = 1$。\n由此，我们得到 $x^{\\star}_2 = 2x^{\\star}_3 = 2(1)=2$。\n我们的候选解是 $x^{\\star} = (0, 2, 1, 0)$。$x^{\\star}_2$ 和 $x^{\\star}_3$ 均为正数，这与我们之前的假设一致。\n\n我们必须验证该解是否满足非活跃索引 $j \\in \\{1,4\\}$ 的最优性条件。\n对于 $j=1$：$b_1 - x^{\\star}_1 = 0 - 0 = 0$。如前所计算，次梯度分量为 $g^{\\star}_1 = 0$。条件 $b_1 - x^{\\star}_1 = g^{\\star}_1$ 得到满足。\n对于 $j=4$：$b_4 - x^{\\star}_4 = 0 - 0 = 0$。如前所计算，次梯度分量为 $g^{\\star}_4 = 0$。条件 $b_4 - x^{\\star}_4 = g^{\\star}_4$ 得到满足。\n由于所有最优性条件都得到满足，且最小化子是唯一的，我们已经确认 $x^{\\star} = (0, 2, 1, 0)$ 是唯一解。其支撑集确实是 $\\{2, 3\\}$。\n\n问题陈述了该支撑集不能表示为组系统 $\\{G_1, G_2\\}$ 中组的并集。可能的组的并集有 $\\emptyset$、$G_1=\\{1,2\\}$、$G_2=\\{2,3,4\\}$ 和 $G_1 \\cup G_2 = \\{1,2,3,4\\}$。$x^{\\star}$ 的支撑集 $\\{2,3\\}$ 与这些集合中的任何一个都不匹配。这展示了重叠组 LASSO 如何能够选择不符合预定义组结构的特征集，而是选择参与多个重要组的特征。\n\n最后，我们需要找到在 $x^{\\star}$ 处参与最优性条件的惩罚项 $\\Omega(x)$ 次梯度的第二个分量的值。这就是向量 $g^{\\star} = b - x^{\\star}$ 的分量 $g^{\\star}_2$（因为 $\\lambda=1$）。\n这个值可以通过两种方式计算。\n首先，使用我们为次梯度分量推导出的公式：\n$g^{\\star}_2 = \\text{sgn}(x^{\\star}_2) + \\frac{x^{\\star}_2}{\\sqrt{(x^{\\star}_2)^2 + (x^{\\star}_3)^2}} = 1 + \\frac{2}{\\sqrt{2^2 + 1^2}} = 1 + \\frac{2}{\\sqrt{5}}$。\n其次，直接使用最优性条件：\n$g^{\\star}_2 = b_2 - x^{\\star}_2 = \\left(3 + \\frac{2}{\\sqrt{5}}\\right) - 2 = 1 + \\frac{2}{\\sqrt{5}}$。\n两种方法得出的结果相同。该值为所要求的精确表达式。", "answer": "$$\n\\boxed{1 + \\frac{2}{\\sqrt{5}}}\n$$", "id": "3465473"}]}