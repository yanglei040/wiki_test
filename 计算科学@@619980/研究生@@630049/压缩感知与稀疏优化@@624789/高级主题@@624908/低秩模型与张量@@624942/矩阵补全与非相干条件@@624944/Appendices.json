{"hands_on_practices": [{"introduction": "非相干性是矩阵补全理论的核心，它确保了矩阵的信息不会过度集中在少数几个条目中。第一个练习旨在建立一个基础性的理解，要求你计算一个具有最大“尖峰”的秩-1矩阵的相干性。通过处理这个极端情况 [@problem_id:3459273]，你将对高相干性的含义及其为何对恢复构成挑战获得一个具体的直观认识。", "problem": "考虑正整数 $m$ 和 $n$ 以及 $m \\times n$ 的秩为 $1$ 的矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$，其中 $e^{(m)}_{1} \\in \\mathbb{R}^{m}$ 和 $e^{(n)}_{1} \\in \\mathbb{R}^{n}$ 分别表示 $\\mathbb{R}^{m}$ 和 $\\mathbb{R}^{n}$ 中的第一个标准基向量。令奇异值分解 (SVD) 表示 $M$ 的因式分解 $M = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times r}$ 和 $V \\in \\mathbb{R}^{n \\times r}$ 的列是标准正交的，分别张成 $M$ 的列空间和行空间，$\\Sigma \\in \\mathbb{R}^{r \\times r}$ 包含奇异值，其中 $r = \\mathrm{rank}(M)$。定义到列空间和行空间上的正交投影算子为 $P_{U} = U U^{\\top}$ 和 $P_{V} = V V^{\\top}$。对于秩 $r$，子空间相对于标准基的相干性定义为\n$$\n\\mu(U) = \\frac{m}{r} \\max_{1 \\leq i \\leq m} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2}, \n\\qquad\n\\mu(V) = \\frac{n}{r} \\max_{1 \\leq j \\leq n} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2}.\n$$\n从这些定义和 $M$ 的 SVD 出发，计算矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$ 的相干性参数 $\\mu(U)$ 和 $\\mu(V)$，并简要解释为什么在矩阵补全的背景下，这些值说明了一种极端的相干性配置。将你的最终答案以包含两个值 $\\left(\\mu(U), \\mu(V)\\right)$ 的单行矩阵形式报告。不需要四舍五入，你的答案必须是精确值。", "solution": "我们从 $m \\times n$ 矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$ 开始。这是一个秩为 $1$ 的矩阵，因为它是两个非零向量的外积。对于一个秩为 $1$ 的外积 $u v^{\\top}$，其中 $u \\in \\mathbb{R}^{m}$ 和 $v \\in \\mathbb{R}^{n}$，其奇异值分解 (SVD) 由 $M = U \\Sigma V^{\\top}$ 给出，其中 $U$ 和 $V$ 各有一列，分别为 $u$ 和 $v$ 的归一化版本，而 $\\Sigma$ 包含唯一的非零奇异值，等于 $\\|u\\|_{2} \\|v\\|_{2}$。在我们的特定情况下，$u = e^{(m)}_{1}$ 和 $v = e^{(n)}_{1}$ 已经是单位范数，因此 SVD 为\n$$\nM = U \\Sigma V^{\\top}, \\quad U = e^{(m)}_{1}, \\quad V = e^{(n)}_{1}, \\quad \\Sigma = [1],\n$$\n秩 $r = 1$。列空间 $U$ 是 $\\mathrm{span}\\left(e^{(m)}_{1}\\right)$，行空间 $V$ 是 $\\mathrm{span}\\left(e^{(n)}_{1}\\right)$。\n\n到这些一维子空间上的正交投影算子是\n$$\nP_{U} = U U^{\\top} = e^{(m)}_{1} \\left(e^{(m)}_{1}\\right)^{\\top}, \n\\qquad \nP_{V} = V V^{\\top} = e^{(n)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}.\n$$\n为了计算相干性参数，我们评估投影后的标准基向量的范数平方。对于 $1 \\leq i \\leq m$，\n$$\nP_{U} e^{(m)}_{i} = \\left(e^{(m)}_{1} \\left(e^{(m)}_{1}\\right)^{\\top}\\right) e^{(m)}_{i} \n= e^{(m)}_{1} \\left\\langle e^{(m)}_{1}, e^{(m)}_{i} \\right\\rangle \n= \n\\begin{cases}\ne^{(m)}_{1},  i = 1, \\\\\n0,  i \\neq 1,\n\\end{cases}\n$$\n因此\n$$\n\\left\\|P_{U} e^{(m)}_{i}\\right\\|_{2}^{2} = \n\\begin{cases}\n1,  i = 1, \\\\\n0,  i \\neq 1.\n\\end{cases}\n$$\n所以，\n$$\n\\max_{1 \\leq i \\leq m} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2} = 1,\n$$\n并且当 $r = 1$ 时，\n$$\n\\mu(U) = \\frac{m}{r} \\max_{i} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2} = m.\n$$\n\n对于 $P_{V}$，可以进行类似的计算。对于 $1 \\leq j \\leq n$，\n$$\nP_{V} e^{(n)}_{j} = \\left(e^{(n)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}\\right) e^{(n)}_{j} \n= e^{(n)}_{1} \\left\\langle e^{(n)}_{1}, e^{(n)}_{j} \\right\\rangle \n= \n\\begin{cases}\ne^{(n)}_{1},  j = 1, \\\\\n0,  j \\neq 1,\n\\end{cases}\n$$\n因此\n$$\n\\left\\|P_{V} e^{(n)}_{j}\\right\\|_{2}^{2} = \n\\begin{cases}\n1,  j = 1, \\\\\n0,  j \\neq 1.\n\\end{cases}\n$$\n因此，\n$$\n\\max_{1 \\leq j \\leq n} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2} = 1,\n$$\n并且当 $r = 1$ 时，\n$$\n\\mu(V) = \\frac{n}{r} \\max_{j} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2} = n.\n$$\n\n这些值说明了极端的相干性，因为对于秩 $r=1$，相干性满足一般界限 $1 \\leq \\mu(U) \\leq m$ 和 $1 \\leq \\mu(V) \\leq n$。这里计算的情况达到了可能的最大值，$\\mu(U) = m$ 和 $\\mu(V) = n$，这意味着子空间与单个标准基向量最大程度地对齐。在矩阵补全中，这种极端的相干性意味着 $M$ 中的信息高度集中在列空间和行空间的单个坐标上，这正是非相干性被最严重违反的病态情况。所要求的最终答案是包含这两个值的行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} m  n \\end{pmatrix}}$$", "id": "3459273"}, {"introduction": "矩阵补全中的一个关键理论问题是：一个部分观测到的低秩矩阵，在何种情况下是核范数最小化问题的唯一解？“对偶证书”的存在为这个问题提供了答案。在这个练习 [@problem_id:3459243] 中，你将为一个简单的 $2 \\times 2$ 例子构建这样一个证书，直接接触卡罗需-库恩-塔克（KKT）最优性条件和核范数的次梯度，从而加深你对恢复保证的理解。", "problem": "考虑一个带等式约束和核范数正则化的矩阵补全问题。设真实的未知矩阵为秩一矩阵 $$X_{\\star} \\in \\mathbb{R}^{2 \\times 2}$$，由奇异值分解 (SVD) $$X_{\\star} = \\sigma\\, u v^{\\top}$$ 定义，其中 $$u = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}, \\quad v = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}, \\quad \\sigma = 2.$$ 因此，$$X_{\\star} = \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}.$$ 观测到的索引集为 $$\\Omega = \\{(1,1),(1,2),(2,1)\\},$$ 采样算子 $$\\mathcal{P}_{\\Omega}:\\mathbb{R}^{2\\times 2}\\to\\mathbb{R}^{2\\times 2}$$ 的作用为 $$(\\mathcal{P}_{\\Omega}(X))_{ij} = \\begin{cases} X_{ij},  (i,j)\\in \\Omega, \\\\ 0,  \\text{otherwise.}\\end{cases}$$ 考虑如下凸规划问题 $$\\min_{X\\in \\mathbb{R}^{2\\times 2}} \\|X\\|_{\\ast} \\quad \\text{subject to} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(X_{\\star}),$$ 其中 $$\\|X\\|_{\\ast}$$ 是核范数（奇异值之和）。令 $$T$$ 表示秩一流形在 $$X_{\\star}$$ 处的切空间，$$T = \\{u a^{\\top} + b v^{\\top}: a\\in\\mathbb{R}^{2},\\, b\\in\\mathbb{R}^{2}\\},$$ 并令 $$\\mathcal{P}_{T}$$ 和 $$\\mathcal{P}_{T^{\\perp}}$$ 分别表示到 $$T$$ 及其正交补上的正交投影，投影是关于 Frobenius 内积的。仅使用核心定义（通过 Karush–Kuhn–Tucker 条件的凸最优化、秩一矩阵点处核范数的次梯度，以及切空间及其正交补的定义），执行以下步骤：\n\n1. 显式地构造一个对偶凭证 $$Y \\in \\mathbb{R}^{2\\times 2}$$，使得 $$Y \\in \\mathrm{range}(\\mathcal{P}_{\\Omega}), \\quad \\mathcal{P}_{T}(Y) = u v^{\\top}, \\quad \\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2} \\leq 1,$$ 其中 $$\\|\\cdot\\|_{2}$$ 是谱范数。您的构造必须从 $$Y$$ 在 $$\\Omega$$ 上有支撑（即 $$Y_{22}=0$$）的要求以及次梯度 $$\\partial \\|X_{\\star}\\|_{\\ast} = \\{u v^{\\top} + W: \\mathcal{P}_{T}(W)=0,\\, \\|W\\|_{2} \\leq 1\\}$$ 的刻画出发。\n\n2. 通过确定一个拉格朗日乘子 $$\\Lambda \\in \\mathbb{R}^{2\\times 2}$$ 使得平稳性条件成立，并检查原始可行性，来验证最优性的 Karush–Kuhn–Tucker (KKT) 条件。特别地，展示您的 $$Y$$ 可以写成 $$Y = \\mathcal{P}_{\\Omega}(\\Lambda)$$（带有适当的符号约定以满足平稳性），并验证 $$\\langle Y, X_{\\star}\\rangle = \\|X_{\\star}\\|_{\\ast}$$。\n\n3. 计算量 $$\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2}$$。\n\n请以一个无单位的实数形式提供您的最终答案。无需四舍五入；给出精确值。", "solution": "我们的任务是为给定的矩阵补全问题构造一个对偶证书 $Y$，并在 Karush-Kuhn-Tucker (KKT) 条件的框架下验证其性质，最后计算其在切空间正交补上的投影的谱范数。\n\n首先，确定真实矩阵 $X_{\\star}$。给定 $\\sigma=2$ 且 $u=v=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，我们有：\n$$X_{\\star} = \\sigma u v^{\\top} = 2 \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}\\right) \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  1\\end{pmatrix}\\right) = \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}.$$\n其核范数为 $\\|X_{\\star}\\|_{\\ast} = \\sigma = 2$。观测集为 $\\Omega = \\{(1,1),(1,2),(2,1)\\}$，这意味着 $X_{\\star}$ 的 $(2,2)$ 元素未被观测。\n\n$X_{\\star}$ 是最优解的充分条件是存在一个对偶证书 $Y \\in \\mathbb{R}^{2\\times 2}$，它满足：\n1.  $Y$ 的支撑集在 $\\Omega$ 内，即 $Y_{ij}=0$ 对于 $(i,j) \\notin \\Omega$。在本例中，这意味着 $Y_{22}=0$。\n2.  $Y$ 属于 $X_{\\star}$ 处核范数的次梯度集合 $\\partial \\|X_{\\star}\\|_{\\ast}$。对于秩为1的矩阵 $X_{\\star}$，该集合为 $\\partial \\|X_{\\star}\\|_{\\ast} = \\{u v^{\\top} + W \\mid \\mathcal{P}_{T}(W)=0, \\|W\\|_{2} \\leq 1\\}$。其中 $T$ 是 $X_{\\star}$ 处的切空间。\n\n**第1步：构造对偶证书 $Y$**\n\n我们需要找到一个矩阵 $Y$ 满足 $Y = uv^\\top + W$，其中 $W$ 属于切空间的正交补 $T^\\perp$，并且 $Y_{22}=0$。\n$T^\\perp$ 由满足 $u^\\top Z = 0$ 和 $Zv = 0$ 的矩阵 $Z$ 组成。由于 $u=v$，这简化为 $u^\\top Z = 0$ 和 $Zu = 0$。与 $u$ 正交的单位向量是 $u_{\\perp} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$。因此，$T^\\perp$ 中的任何矩阵都可以写成 $c \\cdot u_{\\perp}u_{\\perp}^{\\top}$ 的形式，其中 $c$ 为标量。\n$$u_{\\perp}u_{\\perp}^{\\top} = \\frac{1}{2} \\begin{pmatrix}1 \\\\ -1\\end{pmatrix} \\begin{pmatrix}1  -1\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}.$$\n我们令 $Y = uv^{\\top} + c \\cdot u_{\\perp}u_{\\perp}^{\\top}$。我们已经知道 $uv^{\\top} = \\frac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}$。\n所以，\n$$Y = \\frac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix} + c \\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}1+c  1-c \\\\ 1-c  1+c\\end{pmatrix}.$$\n应用条件 $Y_{22}=0$：\n$$\\frac{1}{2}(1+c) = 0 \\implies c = -1.$$\n将 $c=-1$ 代入，得到对偶证书：\n$$Y = \\frac{1}{2}\\begin{pmatrix}1-1  1-(-1) \\\\ 1-(-1)  1-1\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}0  2 \\\\ 2  0\\end{pmatrix} = \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}.$$\n这个矩阵 $Y$ 满足支撑集条件，因为其 $(2,2)$ 元素为0。\n\n**第2步：验证 KKT 条件**\n我们需要验证我们构造的 $Y$ 属于 $\\partial \\|X_{\\star}\\|_{\\ast}$。根据构造，$Y = uv^{\\top} + (-1)u_{\\perp}u_{\\perp}^{\\top}$。\n我们令 $W = -u_{\\perp}u_{\\perp}^{\\top} = -\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}$。\n$W \\in T^{\\perp}$，因此 $\\mathcal{P}_{T}(W)=0$。我们还需检查其谱范数 $\\|W\\|_{2} \\leq 1$。\n$$ \\|W\\|_{2} = \\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2} = |-1| \\cdot \\|u_{\\perp}u_{\\perp}^{\\top}\\|_{2} = 1.$$\n因为 $u_{\\perp}u_{\\perp}^{\\top}$ 是到一个一维子空间的正交投影，其谱范数为1。因此 $\\|W\\|_{2}=1$ 条件满足。\n这证明了 $Y \\in \\partial \\|X_{\\star}\\|_{\\ast}$。因此，我们可以选择拉格朗日乘子 $\\Lambda = Y$，使得KKT平稳性条件 $\\mathcal{P}_{\\Omega}(\\Lambda) \\in \\partial \\|X_{\\star}\\|_{\\ast}$ 成立。\n最后，我们验证 $\\langle Y, X_{\\star}\\rangle = \\|X_{\\star}\\|_{\\ast}$：\n$$\\langle Y, X_{\\star}\\rangle = \\mathrm{Tr}(Y^{\\top}X_{\\star}) = \\mathrm{Tr}\\left(\\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix} \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}\\right) = \\mathrm{Tr}\\left(\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}\\right) = 1+1=2.$$\n这与 $\\|X_{\\star}\\|_{\\ast} = 2$ 相等。KKT条件得到满足，证明 $X_{\\star}$ 是最优解。\n\n**第3步：计算 $\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2}$**\n根据我们的分解 $Y = \\mathcal{P}_{T}(Y) + \\mathcal{P}_{T^{\\perp}}(Y)$ 和构造 $Y = uv^{\\top} + W$，我们有：\n$$\\mathcal{P}_{T^{\\perp}}(Y) = W = -u_{\\perp}u_{\\perp}^{\\top}.$$\n我们需要计算这个矩阵的谱范数：\n$$\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2} = \\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2}.$$\n如第2步中所计算，这个谱范数的值为1。\n$$\\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2} = 1.$$\n最终答案是1。", "answer": "$$\\boxed{1}$$", "id": "3459243"}, {"introduction": "真实世界中的矩阵经常表现出非均匀结构，其中某些部分比其他部分更“尖峰”或更具相干性，这违反了标准的非相干性假设。这个实践练习 [@problem_id:3459271] 介绍了一种强大的技术——加权核范数最小化——来解决这种局部相干性问题。通过实现一个计算模型，你将学习如何策略性地分配权重以抵消相干性尖峰，并探索权重、有效相干性以及成功恢复所需样本复杂度之间的直接关系。", "problem": "给定一个具有块结构奇异向量的方阵补全设定。考虑一个大小为 $n \\times n$ 的方阵和一个秩为 $r$ 的真实矩阵 $M = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{n \\times r}$ 和 $V \\in \\mathbb{R}^{n \\times r}$ 具有标准正交列。行和列索引被划分为 $B$ 个不相交的块，其大小分别为 $s_1, s_2, \\ldots, s_B$，总和为 $n$。对于每个块 $b \\in \\{1, \\ldots, B\\}$，定义 $U$ 和 $V$ 的局部块相干值为\n$$\n\\mu_b(U) \\triangleq \\frac{n}{r} \\max_{i \\in \\text{block } b} \\left\\| P_U e_i \\right\\|_2^2, \n\\quad\n\\mu_b(V) \\triangleq \\frac{n}{r} \\max_{i \\in \\text{block } b} \\left\\| P_V e_i \\right\\|_2^2,\n$$\n其中 $P_U$ 和 $P_V$ 表示到 $U$ 和 $V$ 列空间上的正交投影算子，而 $(e_i)_{i=1}^n$ 是标准基。设最坏情况下的局部相干性为 $\\mu_b \\triangleq \\max\\{\\mu_b(U), \\mu_b(V)\\}$。假设一小部分块可能是尖峰的 (大 $\\mu_b$)，而其他块是非相干的 (小 $\\mu_b$)。\n\n为了减轻局部尖峰的影响，考虑一个块加权核范数最小化程序。设 $D \\in \\mathbb{R}^{n \\times n}$ 是一个正对角矩阵，且是块常数的：对于块 $b$ 中的 $i$，有 $D_{ii} = w_b  0$。定义块加权核范数为 $\\| D X D \\|_\\ast$。恢复程序为\n$$\n\\min_{X \\in \\mathbb{R}^{n \\times n}} \\; \\| D X D \\|_\\ast \n\\quad \\text{subject to} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M),\n$$\n其中 $\\mathcal{P}_{\\Omega}$ 是采样算子，它揭示了 $M$ 在一个大小为 $m$ 的均匀随机子集 $\\Omega$ 上的元素，并使其余元素未指定。\n\n仅使用基本定义和经过充分检验的结果，您将：\n- 从标准相干性定义和已知的非加权矩阵补全的样本复杂度界限开始。\n- 推理块加权如何修改局部相干性。\n- 推导出一个关于块权重的充分条件，以中和局部尖峰。\n- 以有效相干性的形式，实例化一个可计算的充分采样条件。\n\n为了本问题的目的，将块加权的效果建模如下。如果具有块权重 $(w_b)_{b=1}^B$ 的加权矩阵 $D$ 在加权核范数 $\\| D X D \\|_\\ast$ 中对称地应用于行和列，则有效块相干性为\n$$\n\\mu_b^{\\mathrm{eff}} \\triangleq \\frac{\\mu_b}{w_b^2},\n$$\n而全局有效相干性为\n$$\n\\mu_{\\mathrm{eff}} \\triangleq \\max_{1 \\le b \\le B} \\mu_b^{\\mathrm{eff}} = \\max_{1 \\le b \\le B} \\frac{\\mu_b}{w_b^2}.\n$$\n假设一个标准充分采样条件的形式为\n$$\nm \\;\\ge\\; C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n,\n$$\n对于某个绝对常数 $C  0$ 和自然对数 $\\log(\\cdot)$。定义块权重 $(w_b)$ 相对于目标基线 $\\mu_\\star$ 中和了局部尖峰，如果 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$。\n\n您的任务是编写一个程序，为每个测试用例计算：\n- 一个布尔中和指示符，如果 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$ 则为真，否则为假。\n- 一个布尔可恢复性指示符，如果 $m \\ge \\lceil C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n \\rceil$ 则为真，否则为假。\n\n使用以下测试套件，其中所有对数均为自然对数，并且在所有情况下 $C = 5$。在每个测试用例中，元组由 $(n, r, B, (s_b)_{b=1}^B, (\\mu_b)_{b=1}^B, (w_b)_{b=1}^B, \\mu_\\star, m)$ 组成：\n\n- 测试 1 (正常路径与边界情况)：$n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 4, 4]$, $\\mu_\\star = 1$，且 $m = \\lceil C \\, r \\, 1 \\cdot n \\log n \\rceil$。数值上，$m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 2 (对尖峰块权重不足)：$n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 2, 2]$, $\\mu_\\star = 1$，且 $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 3 (均匀非相干性)：$n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 1, 1]$, $(w_b) = [1, 1, 1, 1]$, $\\mu_\\star = 1$，且 $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 4 (极端尖峰被中和)：$n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 100, 1]$, $(w_b) = [1, 1, 10, 1]$, $\\mu_\\star = 2$，且 $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 5 (小尺寸边界情况)：$n = 20$, $r = 1$, $B = 2$, $(s_b) = [10, 10]$, $(\\mu_b) = [5, 1]$, $(w_b) = [\\sqrt{5}, 1]$, $\\mu_\\star = 1$，且 $m = \\lceil 5 \\cdot 1 \\cdot 20 \\cdot \\log(20) \\rceil$。\n\n您的程序应：\n- 对于每个测试用例，计算 $\\mu_{\\mathrm{eff}} = \\max_b \\mu_b / w_b^2$。\n- 计算阈值 $T = \\lceil C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n \\rceil$。\n- 为每个测试用例输出两个布尔值：$[\\text{neutralized}, \\text{recoverable}]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果格式化为不含空格的两个元素的布尔值列表，整个集合用方括号括起来。例如：[[True,False],[False,False],[True,True]]。", "solution": "该问题探讨了矩阵补全中一个高级但实际的场景：如何处理非均匀相干性。标准矩阵补全理论假设矩阵的奇异向量是“平坦”或非相干的，这意味着信息均匀分布在所有行和列中。然而，在许多实际应用中，某些行或列（即问题的“块”）可能比其他行或列更重要或更“尖峰”，导致局部相干性很高。这会破坏标准恢复算法的性能保证。\n\n为了应对这一挑战，问题引入了“加权核范数最小化”方法。其核心思想是，不对所有矩阵元素一视同仁，而是通过一个对角权重矩阵 $D$ 对核范数进行修改，得到 $\\|DXD\\|_\\ast$。通过为具有高相干性（大 $\\mu_b$）的块分配更大的权重 $w_b$，可以有效地“中和”或“抵消”这些尖峰的影响。\n\n问题提供了一个量化模型来描述这种加权效应：一个块的有效相干性 $\\mu_b^{\\mathrm{eff}}$ 与其原始相干性 $\\mu_b$ 和权重 $w_b$ 的关系为 $\\mu_b^{\\mathrm{eff}} = \\mu_b / w_b^2$。这意味着权重对相干性的压制作用是二次方的。算法的整体难度由所有块中最大的有效相干性 $\\mu_{\\mathrm{eff}} = \\max_b \\mu_b^{\\mathrm{eff}}$ 决定。成功恢复所需的样本数量 $m$ 现在取决于这个经过加权调整后的有效相干性：$m \\ge C \\cdot r \\cdot \\mu_{\\mathrm{eff}} \\cdot n \\cdot \\log(n)$。\n\n本任务要求根据两个标准来评估一系列测试用例：\n1.  **中和（Neutralization）**：如果所选的权重 $(w_b)$ 成功地将全局有效相干性 $\\mu_{\\mathrm{eff}}$ 降低到或低于一个预设的目标基线 $\\mu_\\star$，则认为局部尖峰被成功中和。\n2.  **可恢复性（Recoverability）**：如果给定的样本数量 $m$ 满足基于 $\\mu_{\\mathrm{eff}}$ 的采样复杂度要求，则认为矩阵是可恢复的。\n\n我们将通过一个计算过程来系统地评估每个测试用例。以第一个测试用例为例：\n- **参数**: $n=200$, $r=5$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 4, 4]$, $\\mu_\\star = 1$。\n- **样本数**: $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil = \\lceil 5000 \\log(200) \\rceil$。\n\n**计算步骤**:\n1.  **计算有效块相干性**:\n    - 块 1: $\\mu_1^{\\mathrm{eff}} = 1 / 1^2 = 1$\n    - 块 2: $\\mu_2^{\\mathrm{eff}} = 1 / 1^2 = 1$\n    - 块 3: $\\mu_3^{\\mathrm{eff}} = 16 / 4^2 = 16 / 16 = 1$\n    - 块 4: $\\mu_4^{\\mathrm{eff}} = 16 / 4^2 = 16 / 16 = 1$\n2.  **确定全局有效相干性**: $\\mu_{\\mathrm{eff}} = \\max\\{1, 1, 1, 1\\} = 1$。\n3.  **中和检查**: 比较 $\\mu_{\\mathrm{eff}}$ 与 $\\mu_\\star$。$1 \\le 1$ 为真。因此，中和指示符为 `True`。权重成功地将高相干性块（$\\mu_b=16$）的效应降低到了理想水平。\n4.  **可恢复性检查**:\n    - 计算所需的样本阈值 $T = \\lceil C \\cdot r \\cdot \\mu_{\\mathrm{eff}} \\cdot n \\cdot \\log n \\rceil = \\lceil 5 \\cdot 5 \\cdot 1 \\cdot 200 \\cdot \\log(200) \\rceil = \\lceil 5000 \\log(200) \\rceil$。\n    - 比较给定的样本数 $m$ 与阈值 $T$。因为 $m$ 被定义为 $\\lceil 5000 \\log(200) \\rceil$，所以 $m \\ge T$ 成立。可恢复性指示符为 `True`。\n\n测试用例 1 的结果是 `[True, True]`。此过程将应用于所有五个测试用例，以生成最终答案。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes neutralization and recoverability indicators for a series of\n    matrix completion test cases with block-structured coherence.\n    \"\"\"\n    C = 5\n\n    test_cases = [\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 16, 16], [1, 1, 4, 4], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 16, 16], [1, 1, 2, 2], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 1, 1], [1, 1, 1, 1], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 100, 1], [1, 1, 10, 1], 2),\n        (20, 1, 2, [10, 10], [5, 1], [np.sqrt(5), 1], 1)\n    ]\n\n    m_values = [\n        np.ceil(C * 5 * 1 * 200 * np.log(200)),\n        np.ceil(C * 5 * 1 * 200 * np.log(200)),\n        np.ceil(C * 5 * 1 * 200 * np.log(200)),\n        np.ceil(C * 5 * 1 * 200 * np.log(200)),\n        np.ceil(C * 1 * 1 * 20 * np.log(20))\n    ]\n\n    results = []\n\n    for i, case in enumerate(test_cases):\n        n, r, B, s_b, mu_b, w_b, mu_star = case\n        m = m_values[i]\n        \n        effective_mu_b = [mu / (w**2) for mu, w in zip(mu_b, w_b)]\n        mu_eff = max(effective_mu_b)\n\n        is_neutralized = mu_eff = mu_star\n\n        threshold = np.ceil(C * r * mu_eff * n * np.log(n))\n\n        is_recoverable = m = threshold\n        \n        result = [is_neutralized, is_recoverable]\n        results.append(str(result).replace(\" \", \"\"))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3459271"}]}