{"hands_on_practices": [{"introduction": "掌握共轭传热（CHT）始于对基本原理的牢固理解。第一个练习 [@problem_id:3498692] 将引导我们分析一个经典的一维稳态系统，通过应用傅里叶定律和牛顿冷却定律，推导流固界面的温度和热通量。这个练习的核心在于理解和应用界面处温度连续和热通量守恒这两个关键条件，这是所有更复杂CHT问题求解的基石。", "problem": "一个一维（1D）共轭传热问题，将占据 $x < 0$ 的流体区域与占据 $0 < x < L$ 的固体区域耦合。流体具有均匀的远场温度 $T_{\\infty}$，并通过牛顿冷却定律与固体在 $x=0$ 处的界面进行热交换，传热系数为 $h$。固体在 $x=L$ 处保持恒定温度 $T_L$。假设系统处于稳态，并且流体内部沿 $x$ 方向的导热可以忽略不计。求界面处的温度 $T_{int}$ 和热通量 $q''$。", "solution": "本题要求解一个一维稳态共轭传热问题。\n\n### 第 1 步：建立固体区域的温度分布\n在固体区域 ($0 < x < L$)，一维稳态热传导方程（无热源）为：\n$$\n\\frac{d^2 T_s}{dx^2} = 0\n$$\n对该方程积分两次，得到温度分布的通解：\n$$\nT_s(x) = C_1 x + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是待定积分常数。\n\n### 第 2 步：应用边界条件和界面条件\n我们有两个边界/界面条件来确定这两个常数。\n1.  在固体右边界 $x=L$ 处，温度是固定的 $T_L$：\n    $$\n    T_s(L) = C_1 L + C_2 = T_L \\quad \\text{(1)}\n    $$\n2.  在流固界面 $x=0$ 处，从流体到界面的对流热通量必须等于从界面传入固体的导热热通量。\n    -   界面的温度为 $T_{int} = T_s(0) = C_1(0) + C_2 = C_2$。\n    -   从流体到界面的对流热通量为 $q''_{conv} = h(T_{\\infty} - T_{int}) = h(T_{\\infty} - C_2)$。\n    -   传入固体的导热热通量为 $q''_{cond} = -k_s \\frac{dT_s}{dx}\\bigg|_{x=0} = -k_s C_1$。\n    -   令 $q''_{conv} = q''_{cond}$，得到：\n    $$\n    h(T_{\\infty} - C_2) = -k_s C_1 \\quad \\text{(2)}\n    $$\n\n### 第 3 步：求解常数并确定界面温度和热通量\n我们现在有一个包含两个方程 (1) 和 (2) 的代数方程组，用于求解 $C_1$ 和 $C_2$。\n从方程 (1) 中，我们可以表示 $C_1$：\n$$\nC_1 = \\frac{T_L - C_2}{L}\n$$\n将这个表达式代入方程 (2)：\n$$\nh(T_{\\infty} - C_2) = -k_s \\left( \\frac{T_L - C_2}{L} \\right)\n$$\n现在，我们求解 $C_2$，即界面温度 $T_{int}$：\n$$\nhL(T_{\\infty} - C_2) = -k_s(T_L - C_2)\n$$\n$$\nh L T_{\\infty} - h L C_2 = -k_s T_L + k_s C_2\n$$\n$$\nh L T_{\\infty} + k_s T_L = C_2 (h L + k_s)\n$$\n因此，界面温度为：\n$$\nT_{int} = C_2 = \\frac{h L T_{\\infty} + k_s T_L}{h L + k_s}\n$$\n一旦求得 $T_{int}$，我们就可以计算通过界面的热通量 $q''$。我们可以使用对流或导热的表达式，这里使用对流表达式：\n$$\nq'' = h(T_{\\infty} - T_{int}) = h \\left( T_{\\infty} - \\frac{h L T_{\\infty} + k_s T_L}{h L + k_s} \\right)\n$$\n$$\nq'' = h \\left( \\frac{T_{\\infty}(h L + k_s) - (h L T_{\\infty} + k_s T_L)}{h L + k_s} \\right)\n$$\n$$\nq'' = h \\left( \\frac{h L T_{\\infty} + k_s T_{\\infty} - h L T_{\\infty} - k_s T_L}{h L + k_s} \\right)\n$$\n$$\nq'' = \\frac{h k_s (T_{\\infty} - T_L)}{h L + k_s}\n$$\n最终，我们得到了界面温度 $T_{int}$ 和热通量 $q''$ 的表达式。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{h L T_{\\infty} + k_s T_L}{h L + k_s} \\\\ \\frac{h k_s (T_{\\infty} - T_L)}{h L + k_s} \\end{pmatrix}} $$", "id": "3498692"}, {"introduction": "在工程应用中，我们经常遇到多尺度问题，例如带有薄涂层或薄膜的结构，其厚度远小于系统的宏观尺寸。直接对这些薄层进行精细网格划分在计算上可能代价高昂。本练习 [@problem_id:3498722] 介绍了一种强大的数学方法——匹配渐近展开，用以将薄层的物理效应等效为一个有效热阻，从而在不牺牲关键物理特性的前提下简化模型。这种降维思想是多物理场仿真中的一个核心高级技巧。", "problem": "一个刚性固体区域占据一个光滑域 $\\Omega_{s}$，其边界为 $\\Gamma$，该边界上覆盖着一层厚度为 $\\epsilon \\ll 1$ 的薄涂层。令 $\\mathbf{x}$ 表示 $\\Gamma$ 上的一个点，并引入指向涂层的局部单位外法向量 $\\mathbf{n}(\\mathbf{x})$。涂层占据细长区域 $\\{ \\mathbf{x} + n \\mathbf{n}(\\mathbf{x}) : 0  n  \\epsilon \\}$，其导热系数为常数 $k_{c}$。固体的导热系数为常数 $k_{s}$，其未知的稳态温度场 $T_{s}(\\mathbf{x})$ 由稳态热传导控制。在涂层之外，当 $n = \\epsilon$ 时，相邻流体混合良好，因此在涂层外表面温度是均匀的，等于 $T_{f}$。假设固体和涂层内部均无体积热生成，并假设沿 $\\Gamma$ 的温度切向变化发生在满足 $\\epsilon / \\ell \\to 0$ 的长度尺度 $\\ell$ 上。\n\n从稳态热传导方程和傅里叶定律出发，在涂层中使用基于拉伸法向坐标 $y = n / \\epsilon$ 的匹配渐近推理，取至 $\\epsilon$ 的主导阶，推导出一个作用于 $\\Gamma$ 上的固体温度的有效界面条件，该条件为Robin类型，即 $-k_{s}\\,\\partial T_{s} / \\partial n = (T_{s} - T_{f}) / R_{\\mathrm{eff}}$，其中有效阻力 $R_{\\mathrm{eff}}$ 在极限 $\\epsilon \\to 0$ 下仅依赖于 $k_{c}$ 和 $\\epsilon$。请将 $R_{\\mathrm{eff}}$ 的最终答案表示为单个封闭形式的符号表达式。无需进行数值计算。", "solution": "该问题要求为固体域 $\\Omega_{s}$ 中的温度场 $T_{s}$ 推导一个有效的Robin型边界条件，该固体域被一个薄层覆盖。推导将基于一个渐近分析，该分析的极限条件是涂层厚度 $\\epsilon$ 远小于沿表面 $\\Gamma$ 的温度变化的特征长度尺度 $\\ell$。\n\n在没有热源的情况下，固体（$T_{s}$）和涂层（$T_{c}$）中的稳态温度场均由拉普拉斯方程控制：\n$$ \\nabla^2 T_{s} = 0 \\quad \\text{在 } \\Omega_{s} \\text{ 中} $$\n$$ \\nabla^2 T_{c} = 0 \\quad \\text{在涂层中} $$\n\n我们分析薄涂层内的热传递。为此，我们使用一个局部坐标系，该坐标系基于表面 $\\Gamma$ 上的一个点 $\\mathbf{x}$ 和沿外法线 $\\mathbf{n}$ 的距离 $n$。关键假设是涂层很薄，即 $\\epsilon / \\ell \\to 0$。这意味着温度在法向（在长度尺度 $\\epsilon$ 上）的变化比在切向（在长度尺度 $\\ell$ 上）的变化快得多。\n\n为了将其形式化，我们引入拉伸法向坐标 $y = n / \\epsilon$，这样 $y$ 在涂层中从 $0$ 变化到 $1$。根据链式法则，关于 $n$ 的导数可以用 $y$ 来表示：\n$$ \\frac{\\partial}{\\partial n} = \\frac{\\partial y}{\\partial n} \\frac{\\partial}{\\partial y} = \\frac{1}{\\epsilon} \\frac{\\partial}{\\partial y} $$\n$$ \\frac{\\partial^2}{\\partial n^2} = \\frac{1}{\\epsilon^2} \\frac{\\partial^2}{\\partial y^2} $$\n在曲线坐标系中，完整的拉普拉斯算子是复杂的，但在极限 $\\epsilon / \\ell \\to 0$ 下，关于切向坐标的导数远小于关于法向坐标的导数。涂层中 $T_{c}$ 的拉普拉斯方程由法向的二阶导数主导。对于 $\\epsilon$ 的主导阶，方程 $\\nabla^2 T_{c} = 0$ 简化为：\n$$ \\frac{1}{\\epsilon^2} \\frac{\\partial^2 T_{c}}{\\partial y^2} \\approx 0 $$\n或者，更正式地，我们寻求一个渐近解 $T_{c} \\sim T_{c}^{(0)} + \\epsilon T_{c}^{(1)} + \\dots$。将此代入完整的拉普拉斯算子并收集 $\\epsilon^{-2}$ 阶的项，得到：\n$$ \\frac{\\partial^2 T_{c}^{(0)}}{\\partial y^2} = 0 $$\n这是一个关于涂层中主导阶温度分布 $T_{c}^{(0)}$ 的常微分方程，其中切向位置 $\\mathbf{x}$ 被视为一个参数。对 $y$ 积分两次，得到：\n$$ T_{c}^{(0)}(\\mathbf{x}, y) = A(\\mathbf{x}) y + B(\\mathbf{x}) $$\n其中 $A$ 和 $B$ 是表面 $\\Gamma$ 上位置 $\\mathbf{x}$ 的函数。\n\n我们通过应用涂层表面的边界条件来确定函数 $A(\\mathbf{x})$ 和 $B(\\mathbf{x})$。\n1.  在涂层和固体之间的界面（$n=0$，对应于 $y=0$），温度是连续的。因此，涂层的温度必须与固体表面温度 $T_{s}(\\mathbf{x})$ 相匹配：\n$$ T_{c}(\\mathbf{x}, n=0) = T_{s}(\\mathbf{x}) $$\n在主导阶上，这变为：\n$$ T_{c}^{(0)}(\\mathbf{x}, y=0) = T_{s}(\\mathbf{x}) $$\n将此代入我们对 $T_{c}^{(0)}$ 的解中：\n$$ A(\\mathbf{x}) \\cdot (0) + B(\\mathbf{x}) = T_{s}(\\mathbf{x}) \\implies B(\\mathbf{x}) = T_{s}(\\mathbf{x}) $$\n\n2.  在涂层的外表面（$n=\\epsilon$，对应于 $y=1$），温度等于均匀的流体温度 $T_{f}$：\n$$ T_{c}(\\mathbf{x}, n=\\epsilon) = T_{f} $$\n在主导阶上，这变为：\n$$ T_{c}^{(0)}(\\mathbf{x}, y=1) = T_{f} $$\n将此结果以及 $B(\\mathbf{x})$ 的结果代入我们对 $T_{c}^{(0)}$ 的解中：\n$$ A(\\mathbf{x}) \\cdot (1) + T_{s}(\\mathbf{x}) = T_{f} \\implies A(\\mathbf{x}) = T_{f} - T_{s}(\\mathbf{x}) $$\n\n现在我们得到了涂层中的完整主导阶温度分布：\n$$ T_{c}^{(0)}(\\mathbf{x}, y) = (T_{f} - T_{s}(\\mathbf{x})) y + T_{s}(\\mathbf{x}) $$\n\n最后一步是利用在固体-涂层界面 $\\Gamma$（$n=0$）处热通量的连续性。垂直于边界的热通量必须是连续的：\n$$ -k_{s} \\frac{\\partial T_{s}}{\\partial n} \\bigg|_{\\Gamma} = -k_{c} \\frac{\\partial T_{c}}{\\partial n} \\bigg|_{n=0} $$\n我们计算涂层在该界面处的温度梯度。使用拉伸坐标 $y$：\n$$ \\frac{\\partial T_{c}}{\\partial n} \\bigg|_{n=0} = \\frac{1}{\\epsilon} \\frac{\\partial T_{c}}{\\partial y} \\bigg|_{y=0} $$\n在主导阶上，我们使用 $T_{c}^{(0)}$：\n$$ \\frac{\\partial T_{c}^{(0)}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ (T_{f} - T_{s}(\\mathbf{x})) y + T_{s}(\\mathbf{x}) \\right] = T_{f} - T_{s}(\\mathbf{x}) $$\n这个导数相对于 $y$ 是常数，因此它在 $y=0$ 处的值是 $T_{f} - T_{s}(\\mathbf{x})$。\n将此代入法向梯度的表达式中：\n$$ \\frac{\\partial T_{c}}{\\partial n} \\bigg|_{n=0} \\approx \\frac{1}{\\epsilon} (T_{f} - T_{s}(\\mathbf{x})) $$\n现在我们将此结果代入通量连续性方程：\n$$ -k_{s} \\frac{\\partial T_{s}}{\\partial n} \\bigg|_{\\Gamma} = -k_{c} \\left( \\frac{T_{f} - T_{s}(\\mathbf{x})}{\\epsilon} \\right) $$\n为了匹配所需的Robin条件形式 $-k_{s}\\,\\partial T_{s} / \\partial n = (T_{s} - T_{f}) / R_{\\mathrm{eff}}$，我们重新排列右侧：\n$$ -k_{s} \\frac{\\partial T_{s}}{\\partial n} \\bigg|_{\\Gamma} = \\frac{k_{c}}{\\epsilon} (T_{s}(\\mathbf{x}) - T_{f}) $$\n这可以写成：\n$$ -k_{s} \\frac{\\partial T_{s}}{\\partial n} \\bigg|_{\\Gamma} = \\frac{T_{s}(\\mathbf{x}) - T_{f}}{\\epsilon / k_{c}} $$\n通过与目标形式直接比较，我们确定有效热阻 $R_{\\mathrm{eff}}$ 为：\n$$ R_{\\mathrm{eff}} = \\frac{\\epsilon}{k_{c}} $$\n该表达式表示薄涂层的单位面积热阻，它是在一维热流垂直于表面的假设下推导出来的，这是渐近极限 $\\epsilon / \\ell \\to 0$ 的直接结果。正如所要求的，该结果仅取决于涂层的厚度 $\\epsilon$ 及其导热系数 $k_c$。", "answer": "$$\\boxed{\\frac{\\epsilon}{k_{c}}}$$", "id": "3498722"}, {"introduction": "从解析理论到实际工程计算的跨越是 CHT 学习的关键一步。许多真实的工程系统，特别是涉及瞬态行为和复杂几何时，难以获得纯解析解。本综合性计算练习 [@problem_id:3498718] 将指导你构建一个用于分析翅片阵列瞬态传热的降阶模型（ROM）。你将通过代码实现固体的模态分析与流体的集总参数模型的耦合，并最终通过分析系统矩阵的谱横坐标来评估模型的稳定性，这完整地模拟了从物理建模到计算分析的现代工程方法。", "problem": "考虑一个平行翅片阵列的共轭传热问题，其中固体翅片与单相湍流进行热交换。任务是开发并分析一个基于固体界面模态基和流体雷诺平均纳维-斯托克斯 (RANS) 能量方程集总形式的降阶模型。从第一性原理出发，通过将固体热传导方程投影到一组有限的本征模态上，并通过牛顿冷却定律与流体能量平衡耦合，推导出一个线性时不变系统。然后，通过计算耦合算子的谱横坐标，量化降阶模型在雷诺数和普朗特数参数变化下的稳定性。\n\n假设固体翅片是均匀的，并在厚度坐标 $y \\in [0,L_s]$ 上建模为一维平板，其基底位于 $y=L_s$ 处，保持在固定温度，而界面位于 $y=0$ 处，与流体进行热交换。固体温度 $T_s(y,t)$ 的控制方程是傅里叶热传导方程，\n$$\n\\rho_s c_s \\frac{\\partial T_s}{\\partial t} = k_s \\frac{\\partial^2 T_s}{\\partial y^2},\n$$\n边界条件为 $T_s(L_s,t) = T_b$ (基底处的狄利克雷边界条件) 和\n$$\n-k_s \\left.\\frac{\\partial T_s}{\\partial y}\\right|_{y=0} = h \\left(T_s(0,t) - T_f(t)\\right),\n$$\n其中 $T_b$ 是固定的基底温度，$T_f(t)$ 是横截面平均流体温度，$h$ 是对流传热系数。\n\n引入平移后的固体温度 $\\theta_s(y,t) = T_s(y,t) - T_b$ 和流体温度 $\\theta_f(t) = T_f(t) - T_b$，使得基底边界条件变为齐次的：$\\theta_s(L_s,t) = 0$。使用一个界面模态基 $\\{\\phi_n(y)\\}_{n=0}^{m-1}$，定义为\n$$\n\\phi_n(y) = \\cos(\\mu_n y), \\quad \\mu_n = \\frac{\\frac{\\pi}{2} + n\\pi}{L_s},\n$$\n该基函数在 $y=L_s$ 处满足齐次狄利克雷条件，在 $y=0$ 处满足齐次诺伊曼条件。将固体温度表示为\n$$\n\\theta_s(y,t) = \\sum_{n=0}^{m-1} a_n(t) \\phi_n(y),\n$$\n并对固体热传导方程进行关于该基的伽辽金投影。所得的降阶模型必须包括通过边界热通量实现的界面耦合，并且必须使用在区间 $[0,L_s]$ 上的内积。\n\n对于流体，假设一个特征长度为 $L_c$ 的集总控制体，其单位流体体积与翅片表面积的交换量为 $A_s/V_f$。流体遵循一个考虑了平流和与翅片对流的横截面平均能量平衡方程，\n$$\n\\frac{d\\theta_f}{dt} = -\\frac{1}{\\tau_f} \\theta_f - \\gamma \\left(\\theta_f - \\theta_s(0,t)\\right),\n$$\n其中平流移除时间尺度 $\\tau_f = \\frac{L_c}{u}$，耦合系数 $\\gamma = \\frac{h A_s}{\\rho_f c_f V_f}$。平均流速 $u$ 通过雷诺数 $Re = \\frac{u D_h}{\\nu}$ 关联，其中 $D_h$ 是水力直径，$\\nu$ 是运动粘度。对流传热系数 $h$ 使用 Dittus-Boelter 形式的湍流努塞尔数关联式计算，\n$$\nNu = 0.023 Re^{0.8} Pr^{0.4}, \\quad h = \\frac{k_f Nu}{D_h},\n$$\n其中 $Pr$ 是普朗特数，$k_f$ 是流体的热导率。使用 $Pr = \\frac{\\nu}{\\alpha_f}$ 和热扩散率 $\\alpha_f = \\frac{k_f}{\\rho_f c_f}$ 来关联流体热导率与普朗特数；因此 $k_f = \\frac{\\mu c_f}{Pr}$，其中 $\\mu$ 是动力粘度，$\\nu = \\frac{\\mu}{\\rho_f}$。在每个测试案例中，所有物性均假设不随时间变化。\n\n从上述基本定律和定义出发，推导降阶模型方程，并为状态向量 $x = [a_0,\\ldots,a_{m-1},\\theta_f]^T$ 组装线性系统矩阵。将谱横坐标定义为该系统矩阵特征值实部的最大值。任务是为几个 $(m,Re,Pr)$ 测试案例计算此谱横坐标。\n\n使用以下物理上一致的参数，全部以国际单位制表示：\n- 固体：$L_s = 2\\times 10^{-3}\\,\\mathrm{m}$，$k_s = 205\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$\\rho_s = 2700\\,\\mathrm{kg\\,m^{-3}}$，$c_s = 900\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 流体：$\\rho_f = 1000\\,\\mathrm{kg\\,m^{-3}}$，$c_f = 4181\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s}$ (等效于 $\\mathrm{kg\\,m^{-1}\\,s^{-1}}$)，因此 $\\nu = \\frac{\\mu}{\\rho_f}$。\n- 几何：$D_h = 1.0\\times 10^{-2}\\,\\mathrm{m}$，$L_c = 1.0\\times 10^{-1}\\,\\mathrm{m}$，$\\frac{A_s}{V_f} = 800\\,\\mathrm{m^{-1}}$。\n\n实现该模型并为以下测试套件计算谱横坐标 (单位为 $\\mathrm{s^{-1}}$)：\n1. $m=1$, $Re=15000$, $Pr=7.0$。\n2. $m=3$, $Re=40000$, $Pr=3.0$。\n3. $m=5$, $Re=200000$, $Pr=0.7$。\n4. $m=3$, $Re=10000$, $Pr=10.0$。\n\n您的程序应生成单行输出，其中包含四个测试案例的谱横坐标，以 $\\mathrm{s^{-1}}$ 为单位，四舍五入到六位小数，并以逗号分隔列表的形式包含在方括号中（例如，$[r_1,r_2,r_3,r_4]$）。不允许有其他输出。\n\n定义：雷诺平均纳维-斯托克斯 (RANS)，降阶模型 (ROM)，努塞尔数 (无量纲对流传热系数)，普朗特数 (动量扩散率与热扩散率之比)。", "solution": "降阶模型的推导始于用平移后的温度 $\\theta_s(y,t)$ 和 $\\theta_f(t)$ 表示控制方程。固体热传导方程变为\n$$\n\\rho_s c_s \\frac{\\partial \\theta_s}{\\partial t} = k_s \\frac{\\partial^2 \\theta_s}{\\partial y^2}\n$$\n其边界条件为齐次狄利克雷边界条件 $\\theta_s(L_s,t) = 0$ 和界面 $y=0$ 处的对流边界条件：\n$$\n-k_s \\left.\\frac{\\partial \\theta_s}{\\partial y}\\right|_{y=0} = h \\left(\\theta_s(0,t) - \\theta_f(t)\\right)\n$$\n为了推导固体的降阶模型，我们将热方程对所提供的基函数 $\\{\\phi_k(y)\\}_{k=0}^{m-1}$ 进行伽辽金投影。通过乘以一个测试函数 $\\phi_k(y)$ 并在定义域 $y \\in [0, L_s]$ 上积分，得到方程的弱形式：\n$$\n\\int_{0}^{L_s} \\left( \\rho_s c_s \\frac{\\partial \\theta_s}{\\partial t} - k_s \\frac{\\partial^2 \\theta_s}{\\partial y^2} \\right) \\phi_k(y) dy = 0\n$$\n我们对第二项应用分部积分：\n$$\n-\\int_{0}^{L_s} k_s \\frac{\\partial^2 \\theta_s}{\\partial y^2} \\phi_k(y) dy = - \\left[ k_s \\frac{\\partial \\theta_s}{\\partial y} \\phi_k(y) \\right]_0^{L_s} + \\int_{0}^{L_s} k_s \\frac{\\partial \\theta_s}{\\partial y} \\frac{d\\phi_k}{dy} dy\n$$\n在 $y=L_s$ 处的边界项为零，因为 $\\phi_k(L_s)=\\cos(\\mu_k L_s) = \\cos(\\frac{\\pi}{2}+k\\pi) = 0$。在 $y=0$ 处，我们代入对流边界条件，注意到 $\\phi_k(0) = \\cos(0) = 1$：\n$$\n- \\left[ -k_s \\frac{\\partial \\theta_s}{\\partial y}(0,t) \\phi_k(0) \\right] = -h \\left(\\theta_s(0,t) - \\theta_f(t)\\right)\n$$\n由于所选的基函数 $\\{\\phi_n(y)\\}$ 满足 $\\phi_n'(0)=0$（齐次诺伊曼条件），因此不能直接通过分部积分来处理非齐次的对流边界条件。正确的伽辽金方法是将级数代入强形式的方程中，包括边界条件。\n将 $\\theta_s(y,t) = \\sum_{n=0}^{m-1} a_n(t) \\phi_n(y)$ 代入热传导方程：\n$$\n\\rho_s c_s \\sum_{n=0}^{m-1} \\frac{da_n}{dt} \\phi_n(y) = k_s \\sum_{n=0}^{m-1} a_n(t) \\frac{d^2\\phi_n}{dy^2} = k_s \\sum_{n=0}^{m-1} a_n(t) (-\\mu_n^2 \\phi_n(y))\n$$\n该方程在域内部成立。然而，级数展开式并不满足 $y=0$ 处的对流边界条件。因此，标准的伽辽金投影，即对PDE进行积分，是正确的途径。我们修正对边界项的处理。\n在分部积分后，投影方程变为：\n$$\n\\int_{0}^{L_s} \\rho_s c_s \\frac{\\partial \\theta_s}{\\partial t} \\phi_k dy - \\left[ k_s \\frac{\\partial \\theta_s}{\\partial y} \\phi_k \\right]_0^{L_s} + \\int_{0}^{L_s} k_s \\frac{\\partial \\theta_s}{\\partial y} \\frac{d\\phi_k}{dy} dy = 0\n$$\n代入边界条件：$\\phi_k(L_s) = 0$ 使得 $y=L_s$ 的项为零。在 $y=0$ 处，我们有 $-k_s \\frac{\\partial \\theta_s}{\\partial y} = h(\\theta_s - \\theta_f)$ 和 $\\phi_k(0)=1$。方程变为：\n$$\n\\rho_s c_s \\sum_{n=0}^{m-1} \\frac{da_n}{dt} \\int_0^{L_s} \\phi_n \\phi_k dy + \\left. k_s \\frac{\\partial \\theta_s}{\\partial y} \\right|_{y=0} \\phi_k(0) + k_s \\sum_{n=0}^{m-1} a_n \\int_0^{L_s} \\frac{d\\phi_n}{dy}\\frac{d\\phi_k}{dy} dy = 0\n$$\n$$\n\\rho_s c_s \\sum_{n=0}^{m-1} \\frac{da_n}{dt} M_{kn} - h(\\theta_s(0,t) - \\theta_f(t)) + k_s \\sum_{n=0}^{m-1} a_n K_{kn} = 0\n$$\n其中 $M_{kn}$ 和 $K_{kn}$ 是质量和刚度矩阵的元素。利用基函数的正交性（$M_{kn} = \\frac{L_s}{2}\\delta_{kn}, K_{kn} = \\frac{\\mu_k^2 L_s}{2}\\delta_{kn}$）：\n$$\n\\rho_s c_s \\frac{da_k}{dt} \\frac{L_s}{2} + k_s a_k \\frac{\\mu_k^2 L_s}{2} - h \\left( \\sum_{n=0}^{m-1} a_n - \\theta_f \\right) = 0\n$$\n重新整理得到 $da_k/dt$：\n$$\n\\frac{da_k}{dt} = - \\frac{k_s}{\\rho_s c_s} \\mu_k^2 a_k + \\frac{2h}{\\rho_s c_s L_s} \\sum_{n=0}^{m-1} a_n - \\frac{2h}{\\rho_s c_s L_s} \\theta_f\n$$\n这个方程与问题描述中的形式不符，问题描述中的边界条件引入方式有误。正确的推导是，边界条件通过对流项耦合到固体和流体方程中。让我们遵循最初的推导，它似乎旨在将所有耦合项放在右手边，但符号有误。正确的伽辽金投影应为：\n$$\n\\rho_s c_s \\frac{da_k}{dt} \\frac{L_s}{2} = -k_s a_k \\frac{\\mu_k^2 L_s}{2} - h \\left(\\sum_{n=0}^{m-1} a_n \\phi_n(0) - \\theta_f \\right) \\phi_k(0)\n$$\n由于 $\\phi_n(0)=1$ 和 $\\phi_k(0)=1$，我们得到：\n$$\n\\frac{da_k}{dt} = - \\frac{k_s}{\\rho_s c_s} \\mu_k^2 a_k - \\frac{2h}{\\rho_s c_s L_s} \\left( \\sum_{n=0}^{m-1} a_n - \\theta_f \\right)\n$$\n$$\n\\frac{da_k}{dt} = -\\alpha_s \\mu_k^2 a_k - C_s \\sum_{n=0}^{m-1} a_n + C_s \\theta_f, \\quad \\text{其中 } C_s = \\frac{2h}{\\rho_s c_s L_s}\n$$\n这与初始推导一致。\n流体方程为：\n$$\n\\frac{d\\theta_f}{dt} = \\gamma \\sum_{n=0}^{m-1} a_n - \\left(\\frac{1}{\\tau_f} + \\gamma\\right) \\theta_f\n$$\n现在我们组装完整的线性系统 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{A} \\mathbf{x}$，其状态向量为 $\\mathbf{x} = [a_0, \\dots, a_{m-1}, \\theta_f]^T$。这个 $(m+1) \\times (m+1)$ 的系统矩阵 $\\mathbf{A}$ 具有以下结构：\n对于前 $m$ 行，对应于 $da_k/dt$ (其中 $k \\in \\{0, \\dots, m-1\\}$)：\n-   当 $n \\in \\{0, \\dots, m-1\\}$ 且 $n \\neq k$ 时，$A_{k,n} = -C_s$。\n-   $A_{k,k} = -\\alpha_s \\mu_k^2 - C_s$。\n-   $A_{k,m} = C_s$。这是 $\\theta_f$ 的系数。\n\n对于最后一行 ($m$)，对应于 $d\\theta_f/dt$：\n-   当 $n \\in \\{0, \\dots, m-1\\}$ 时，$A_{m,n} = \\gamma$。这些是 $a_n$ 的系数。\n-   $A_{m,m} = -(\\frac{1}{\\tau_f} + \\gamma)$。这是 $\\theta_f$ 的系数。\n\n这个线性时不变系统的稳定性由矩阵 $\\mathbf{A}$ 的特征值决定。谱横坐标定义为 $\\sigma(\\mathbf{A}) = \\max_{i} \\{\\text{Re}(\\lambda_i)\\}$，其中 $\\{\\lambda_i\\}$ 是 $\\mathbf{A}$ 的特征值，它为稳定性提供了量化度量。负的谱横坐标表示所有模态都会衰减，系统是稳定的。任务是为给定的参数集计算此值。参数 $h$、$\\gamma$ 和 $\\tau_f$ 依赖于雷诺数和普朗特数，必须为每个测试案例分别计算。\n计算过程首先为每个测试案例确定物理参数 $u$、$\\tau_f$、$k_f$、$Nu$、$h$、$\\gamma$ 和 $C_s$。然后，构造系统矩阵 $\\mathbf{A}$，并数值计算其特征值。这些特征值实部的最大值即为所求的谱横坐标。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and solves a reduced-order model for conjugate heat transfer\n    in a fin array, then computes the spectral abscissa for stability analysis.\n    \"\"\"\n\n    # --- Physical Parameters (SI units) ---\n    # Solid properties (Aluminum)\n    L_s = 2e-3  # m, fin thickness\n    k_s = 205.0  # W/(m K), thermal conductivity\n    rho_s = 2700.0  # kg/m^3, density\n    c_s = 900.0  # J/(kg K), specific heat capacity\n    alpha_s = k_s / (rho_s * c_s)  # m^2/s, thermal diffusivity\n\n    # Fluid properties (Water)\n    rho_f = 1000.0  # kg/m^3, density\n    c_f = 4181.0  # J/(kg K), specific heat capacity\n    mu_f = 1.0e-3  # Pa s, dynamic viscosity\n    nu_f = mu_f / rho_f  # m^2/s, kinematic viscosity\n\n    # Geometric parameters\n    D_h = 1.0e-2  # m, hydraulic diameter\n    L_c = 1.0e-1  # m, characteristic length of fluid control volume\n    As_Vf_ratio = 800.0  # m^-1, fin surface area to fluid volume ratio\n\n    # --- Test Cases ---\n    test_cases = [\n        (1, 15000, 7.0),\n        (3, 40000, 3.0),\n        (5, 200000, 0.7),\n        (3, 10000, 10.0),\n    ]\n\n    results = []\n\n    for m, Re, Pr in test_cases:\n        # --- 1. Calculate dependent parameters for the given (Re, Pr) ---\n        \n        # Mean flow velocity from Reynolds number\n        u = (Re * nu_f) / D_h\n        \n        # Fluid advection time scale\n        tau_f = L_c / u\n        \n        # Fluid thermal conductivity from Prandtl number definition\n        # Pr = nu / alpha_f = (mu/rho_f) / (k_f/(rho_f * c_f)) = mu * c_f / k_f\n        k_f = (mu_f * c_f) / Pr\n        \n        # Nusselt number from Dittus-Boelter correlation\n        Nu = 0.023 * (Re**0.8) * (Pr**0.4)\n        \n        # Convective heat transfer coefficient\n        h = (k_f * Nu) / D_h\n        \n        # Fluid-side coupling coefficient for the ROM\n        gamma = (h * As_Vf_ratio) / (rho_f * c_f)\n        \n        # Solid-side coupling coefficient for the ROM\n        C_s = (2 * h) / (rho_s * c_s * L_s)\n\n        # --- 2. Construct the system matrix A ---\n        \n        # Size of the matrix A is (m+1) x (m+1)\n        A = np.zeros((m + 1, m + 1), dtype=np.float64)\n        \n        # Calculate the spatial eigenvalues for the solid basis functions\n        mu = np.array([(0.5 * np.pi + n * np.pi) / L_s for n in range(m)])\n        \n        # Populate the top-left m x m block of A (solid-solid coupling)\n        # This is a diagonal matrix plus a rank-1 matrix\n        diag_part = -alpha_s * (mu**2)\n        A[:m, :m] = np.diag(diag_part) - C_s\n        \n        # Populate the top-right m x 1 column of A (fluid-to-solid coupling)\n        A[:m, m] = C_s\n        \n        # Populate the bottom-left 1 x m row of A (solid-to-fluid coupling)\n        A[m, :m] = gamma\n        \n        # Populate the bottom-right element of A (fluid-fluid self-coupling)\n        A[m, m] = -(1.0 / tau_f + gamma)\n        \n        # --- 3. Compute eigenvalues and the spectral abscissa ---\n        \n        eigenvalues = np.linalg.eigvals(A)\n        spectral_abscissa = np.max(np.real(eigenvalues))\n        results.append(spectral_abscissa)\n\n    # --- Final Output Formatting ---\n    # Format results to six decimal places\n    results_str = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "3498718"}]}