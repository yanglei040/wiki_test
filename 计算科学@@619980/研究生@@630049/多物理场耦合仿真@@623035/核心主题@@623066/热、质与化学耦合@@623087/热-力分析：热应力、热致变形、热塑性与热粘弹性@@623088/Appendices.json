{"hands_on_practices": [{"introduction": "热应力的概念是热力学分析的基石，它源于材料热胀冷缩的天性受到约束时产生的内力。本练习 [@problem_id:3529203] 将引导你推导一个完全约束杆在均匀温升下的热应力，其挑战在于材料的杨氏模量 $E(T)$ 和热膨胀系数 $\\alpha(T)$ 均随温度变化。通过解决这个问题，你将掌握处理变物性参数时所需积分形式的本构关系，并为分析更真实的工程场景打下坚实基础。", "problem": "一根初始长度为 $L$、横截面均匀的各向同性、均匀杆，其两端被完全约束，使得其轴向位移始终为零。该杆在初始温度 $T_0$ 时处于无应力状态。随后，对其施加一个空间均匀的温度历史，使其温度单调升高至 $T_1 = T_0 + \\Delta T$。假设小应变、准静态演化和一维轴向响应。\n\n该材料表现出线性热弹性行为，其杨氏模量 $E(T)$ 和线性热膨胀系数 $\\alpha(T)$ 均与温度相关。假设在每个温度 $T$ 下，单轴本构关系为 $\\sigma(T) = E(T)\\,\\varepsilon_{\\mathrm{mech}}(T)$，且相对于 $T_0$ 的热应变为 $\\varepsilon_{\\mathrm{th}}(T) = \\int_{T_0}^{T} \\alpha(\\theta)\\,d\\theta$。在基础计算中不考虑塑性或粘弹性。\n\n仅从基本运动学（小应变下的应变叠加分解）和单轴本构关系出发，推导最终轴向柯西应力 $\\sigma(T_1)$ 关于 $E(T)$、$\\alpha(T)$、$T_0$ 和 $T_1$ 的闭式表达式。你的最终答案必须是单个解析表达式，可以包含一个积分。\n\n然后，在控制结构层面（而非数值计算层面）简要讨论在以下两种情况下结果如何变化：\n- 如果材料表现为具有温变松弛模量的线性热粘弹性固体。\n- 如果材料表现出具有温变屈服应力的热塑性。\n\n将最终应力表示为解析表达式；无需进行数值计算。在你的最终方框答案中不要包含单位。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定且自洽的。它提出了一个一维热弹性力学中的标准问题。\n\n最终轴向应力的推导源于连续介质力学的基本原理。\n\n首先，我们应用小应变下的应变叠加分解原理。在过程中的任意一点，总轴向应变 $\\varepsilon_{\\mathrm{tot}}$ 是机械应变 $\\varepsilon_{\\mathrm{mech}}$ 和热应变 $\\varepsilon_{\\mathrm{th}}$ 的和：\n$$\n\\varepsilon_{\\mathrm{tot}}(T) = \\varepsilon_{\\mathrm{mech}}(T) + \\varepsilon_{\\mathrm{th}}(T)\n$$\n问题陈述指出，杆的两端被完全约束，这意味着其总轴向位移为零。因此，在整个加热过程中，总轴向应变 $\\varepsilon_{\\mathrm{tot}}$ 必须为零：\n$$\n\\varepsilon_{\\mathrm{tot}}(T) = 0\n$$\n结合这两个方程，得到机械应变和热应变之间的关系：\n$$\n\\varepsilon_{\\mathrm{mech}}(T) = -\\varepsilon_{\\mathrm{th}}(T)\n$$\n问题给出了热应变 $\\varepsilon_{\\mathrm{th}}(T)$ 的定义，该应变是当温度从初始参考温度 $T_0$ 变化到温度 $T$ 时累积的：\n$$\n\\varepsilon_{\\mathrm{th}}(T) = \\int_{T_0}^{T} \\alpha(\\theta)\\,d\\theta\n$$\n这里，$\\alpha(\\theta)$ 是与温度相关的线性热膨胀系数。将其代入前面的关系式，我们得到机械应变作为温度函数的表达式：\n$$\n\\varepsilon_{\\mathrm{mech}}(T) = - \\int_{T_0}^{T} \\alpha(\\theta)\\,d\\theta\n$$\n轴向柯西应力 $\\sigma(T)$ 通过给定的单轴本构关系与机械应变相关，该关系考虑了与温度相关的杨氏模量 $E(T)$：\n$$\n\\sigma(T) = E(T)\\,\\varepsilon_{\\mathrm{mech}}(T)\n$$\n该关系表明，在给定温度 $T$ 下的应力由该温度下的机械应变和材料刚度决定。为了求得最终温度 $T_1$ 时的最终轴向应力 $\\sigma(T_1)$，我们在 $T=T_1$ 处对上述表达式求值：\n$$\n\\sigma(T_1) = E(T_1)\\,\\varepsilon_{\\mathrm{mech}}(T_1)\n$$\n代入 $T_1$ 时的机械应变表达式：\n$$\n\\sigma(T_1) = E(T_1) \\left( - \\int_{T_0}^{T_1} \\alpha(\\theta)\\,d\\theta \\right)\n$$\n这可以简化为热弹性情况下轴向应力的最终闭式表达式：\n$$\n\\sigma(T_1) = -E(T_1) \\int_{T_0}^{T_1} \\alpha(\\theta)\\,d\\theta\n$$\n负号表示产生了压应力，这是预料之中的，因为材料受热膨胀的趋势受到了固定约束的抵抗。\n\n关于材料行为改变的讨论：\n\n如果材料表现为线性热粘弹性固体，其本构关系将发生根本性改变。给定时刻的应力不再是当前应变的简单函数，而是依赖于整个应变历史。本构定律采用遗传积分的形式。对于热流变简单材料，这通常使用一个折合时间变量 $\\xi(t) = \\int_0^t [a_T(T(\\tau))]^{-1} d\\tau$ 来表示，其中 $a_T$ 是与温度相关的时温等效因子。在最终时刻 $t_f$（对应于温度 $T_1$）的应力将由下式给出：\n$$\n\\sigma(t_f) = \\int_0^{t_f} E_R(\\xi(t_f) - \\xi(t')) \\frac{d\\varepsilon_{\\mathrm{mech}}(t')}{dt'} dt'\n$$\n其中 $E_R$ 是松弛模量。由于 $\\dot{\\varepsilon}_{\\mathrm{mech}} = -\\dot{\\varepsilon}_{\\mathrm{th}} = -\\alpha(T)\\dot{T}$，应力变为：\n$$\n\\sigma(t_f) = -\\int_0^{t_f} E_R(\\xi(t_f) - \\xi(t')) \\alpha(T(t')) \\dot{T}(t') dt'\n$$\n关键的结构性变化是，最终应力现在是路径相关的；它依赖于温度历史 $T(t)$ 和升温速率 $\\dot{T}$，而不仅仅是初始和最终温度。\n\n如果材料表现出热塑性，该模型必须补充一个屈服准则和一个流动法则。总应变被分解为弹性、塑性和热应变三部分：$\\varepsilon_{\\mathrm{tot}} = \\varepsilon_{\\mathrm{e}} + \\varepsilon_{\\mathrm{p}} + \\varepsilon_{\\mathrm{th}}$。只要应力大小 $|\\sigma|$ 小于随温度变化的屈服应力 $Y(T)$，材料就呈弹性响应。如果压应力达到屈服极限，即 $|\\sigma(T)| = Y(T)$，塑性变形开始发生。设 $T_y$ 为开始屈服时的温度，由 $E(T_y) \\int_{T_0}^{T_y} \\alpha(\\theta)d\\theta = Y(T_y)$ 定义。在单调加热过程中，对于任何随后的温度 $T > T_y$，应力状态被约束在屈服面上演化，即 $|\\sigma(T)| = Y(T)$。假设在一个典型情景中，屈服应力随温度升高而降低，如果 $T_y  T_1$，则最终应力为 $\\sigma(T_1) = -Y(T_1)$。如果从未发生屈服（即，对于所有 $T \\in [T_0, T_1]$，都有 $|-E(T) \\int_{T_0}^T \\alpha(\\theta)d\\theta|  Y(T)$），则最终应力与纯弹性解相同。结构性变化是引入了一个界定弹性应力域的屈服面，且最终应力状态取决于是否达到了这个边界。", "answer": "$$\n\\boxed{-E(T_1) \\int_{T_0}^{T_1} \\alpha(\\theta)\\,d\\theta}\n$$", "id": "3529203"}, {"introduction": "实际工程结构中的温度场往往是不均匀的，这使得应力分析更加复杂。本练习 [@problem_id:3529201] 探讨了在空间变化的温度场 $T(x)$ 作用下，两端固定杆件中的残余应力分布。你需要从基本原理出发，建立并求解一个完整的热弹性边值问题，这个过程将加深你对本征应变（eigenstrain）概念的理解，并揭示在一维准静态且无体力的情况下应力场为恒定的重要结论。", "problem": "考虑一根细长、均匀、各向同性的弹性杆，占据区间 $x \\in [0,L]$，其中 $L = 1.2\\,\\text{m}$，横截面均匀，且体力可忽略不计。该材料的杨氏模量 $E = 200 \\times 10^{9}\\,\\text{Pa}$，线性热膨胀系数 $\\alpha = 12 \\times 10^{-6}\\,\\text{K}^{-1}$。热应变为零的参考温度为 $T_{\\mathrm{ref}} = 293\\,\\text{K}$。杆受到一个预设的空间变化的温度场\n$$\nT(x) = T_{\\mathrm{ref}} + 35\\,\\text{K} + 10\\,\\text{K}\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right),\n$$\n且其两端位移受控：$u(0) = 0$ 和 $u(L) = 0$。假设小应变、线弹性及一维轴向响应。利用特征应变（由温度引起的非弹性应变）的概念，从第一性原理出发——即小应变运动学、包含热应变的线弹性本构行为以及线动量守恒的一维形式——建立边界值问题。然后求解该问题，得到整个杆内的残余轴向应力场 $\\sigma(x)$。以 $\\text{MPa}$ 为单位表示最终应力值，并将答案四舍五入至四位有效数字。", "solution": "问题在于确定一根两端固定的细长弹性杆在经受空间变化的温度场时，其内部的轴向应力场 $\\sigma(x)$。本解答将从一维热弹性的基本原理推导而出。\n\n**1. 从第一性原理建立问题**\n\n分析基于三个核心原理：运动学、本构行为和平衡。\n\n**运动学：** 对于经历小变形的一维杆，轴向应变 $\\epsilon(x)$ 定义为轴向位移场 $u(x)$ 的空间导数。\n$$\n\\epsilon(x) = \\frac{du}{dx}\n$$\n\n**本构定律：** 根据线性热弹性理论，总应变 $\\epsilon(x)$ 是机械应变 $\\epsilon_m(x)$ 和热应变 $\\epsilon_{th}(x)$ 的叠加。\n$$\n\\epsilon(x) = \\epsilon_m(x) + \\epsilon_{th}(x)\n$$\n轴向应力 $\\sigma(x)$ 通过胡克定律与机械应变相关，其中 $E$ 是杨氏模量：\n$$\n\\sigma(x) = E \\epsilon_m(x)\n$$\n结合这些关系，连接应力、总应变和热应变的本构关系为：\n$$\n\\sigma(x) = E (\\epsilon(x) - \\epsilon_{th}(x))\n$$\n在此背景下，热应变（也称为特征应变）与温差 $\\Delta T(x) = T(x) - T_{\\mathrm{ref}}$ 成正比，比例系数为线性热膨胀系数 $\\alpha$。\n$$\n\\epsilon_{th}(x) = \\alpha (T(x) - T_{\\mathrm{ref}})\n$$\n利用给定的温度场 $T(x) = T_{\\mathrm{ref}} + 35\\,\\text{K} + 10\\,\\text{K}\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)$，热应变为：\n$$\n\\epsilon_{th}(x) = \\alpha \\left[ \\left( T_{\\mathrm{ref}} + 35 + 10\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right) \\right) - T_{\\mathrm{ref}} \\right] = \\alpha \\left( 35 + 10\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right) \\right)\n$$\n\n**平衡：** 对于没有分布体力的一维物体，线动量守恒要求内部应力在空间上是恒定的。\n$$\n\\frac{d\\sigma}{dx} = 0\n$$\n这意味着应力场 $\\sigma(x)$ 必须是一个常数，我们将其记为 $\\sigma_0$。\n$$\n\\sigma(x) = \\sigma_0\n$$\n\n**2. 边界值问题的推导与求解**\n\n我们现在综合这些原理，为位移场 $u(x)$ 建立一个可解的边界值问题。\n根据本构定律，我们可以用常数应力 $\\sigma_0$ 和热应变 $\\epsilon_{th}(x)$ 来表示总应变 $\\epsilon(x)$：\n$$\n\\epsilon(x) = \\frac{\\sigma_0}{E} + \\epsilon_{th}(x)\n$$\n代入运动学关系 $\\epsilon(x) = du/dx$ 和 $\\epsilon_{th}(x)$ 的表达式：\n$$\n\\frac{du}{dx} = \\frac{\\sigma_0}{E} + \\alpha \\left( 35 + 10\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right) \\right)\n$$\n为了求得位移场 $u(x)$，我们将上述常微分方程对 $x$ 进行积分：\n$$\nu(x) = \\int \\left[ \\frac{\\sigma_0}{E} + 35\\alpha + 10\\alpha\\,\\sin\\!\\left(\\frac{2\\pi x}{L}\\right) \\right] dx\n$$\n$$\nu(x) = \\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) x - 10\\alpha \\left(\\frac{L}{2\\pi}\\right) \\cos\\!\\left(\\frac{2\\pi x}{L}\\right) + C_1\n$$\n其中 $C_1$ 是积分常数。\n\n未知常数 $\\sigma_0$ 和 $C_1$ 通过应用给定的边界条件 $u(0) = 0$ 和 $u(L) = 0$ 来确定。\n\n应用第一个边界条件 $u(0) = 0$：\n$$\nu(0) = \\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) (0) - \\frac{10\\alpha L}{2\\pi} \\cos(0) + C_1 = 0\n$$\n$$\n0 - \\frac{5\\alpha L}{\\pi} (1) + C_1 = 0 \\implies C_1 = \\frac{5\\alpha L}{\\pi}\n$$\n将 $C_1$ 代回 $u(x)$ 的表达式中：\n$$\nu(x) = \\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) x - \\frac{5\\alpha L}{\\pi} \\cos\\!\\left(\\frac{2\\pi x}{L}\\right) + \\frac{5\\alpha L}{\\pi}\n$$\n应用第二个边界条件 $u(L) = 0$：\n$$\nu(L) = \\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) L - \\frac{5\\alpha L}{\\pi} \\cos\\!\\left(\\frac{2\\pi L}{L}\\right) + \\frac{5\\alpha L}{\\pi} = 0\n$$\n由于 $\\cos(2\\pi) = 1$：\n$$\n\\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) L - \\frac{5\\alpha L}{\\pi} (1) + \\frac{5\\alpha L}{\\pi} = 0\n$$\n$$\n\\left( \\frac{\\sigma_0}{E} + 35\\alpha \\right) L = 0\n$$\n由于杆的长度 $L$ 非零 ($L=1.2\\,\\text{m}$)，括号中的项必须为零：\n$$\n\\frac{\\sigma_0}{E} + 35\\alpha = 0\n$$\n这个方程使我们能够解出常数应力 $\\sigma_0$：\n$$\n\\sigma_0 = -35 \\alpha E\n$$\n因此，残余应力场 $\\sigma(x)$ 在整个杆内是恒定的，即 $\\sigma(x) = \\sigma_0$。这一结果表明，应力完全由温升的均匀分量决定，因为空间周期性分量产生的自平衡应变场不会对约束端产生净力。\n\n**3. 数值计算**\n\n现在我们代入给定的材料属性来计算应力的数值。\n已知：\n- 线性热膨胀系数，$\\alpha = 12 \\times 10^{-6}\\,\\text{K}^{-1}$\n- 杨氏模量，$E = 200 \\times 10^{9}\\,\\text{Pa}$\n\n常数应力 $\\sigma_0$ 为：\n$$\n\\sigma_0 = -35 \\times (12 \\times 10^{-6}\\,\\text{K}^{-1}) \\times (200 \\times 10^{9}\\,\\text{Pa})\n$$\n来自温度项 $35\\,\\text{K}$ 的单位开尔文 ($\\text{K}$) 与 $\\alpha$ 中的 $\\text{K}^{-1}$ 相抵消，得到的结果单位为帕斯卡 ($\\text{Pa}$)。\n$$\n\\sigma_0 = -35 \\times 12 \\times 200 \\times 10^{-6} \\times 10^{9}\\,\\text{Pa}\n$$\n$$\n\\sigma_0 = - (35 \\times 12 \\times 200) \\times 10^{3}\\,\\text{Pa}\n$$\n$$\n\\sigma_0 = -84000 \\times 10^{3}\\,\\text{Pa}\n$$\n$$\n\\sigma_0 = -84 \\times 10^{6}\\,\\text{Pa}\n$$\n将帕斯卡转换为兆帕斯卡 ($1\\,\\text{MPa} = 10^6\\,\\text{Pa}$):\n$$\n\\sigma_0 = -84\\,\\text{MPa}\n$$\n负号表示应力是压应力，这与受约束的杆在平均温升作用下的预期结果一致。\n题目要求答案以 $\\text{MPa}$ 表示，并四舍五入到四位有效数字。计算值恰好为 $-84\\,\\text{MPa}$。为了用四位有效数字表示，我们写作：\n$$\n\\sigma_0 = -84.00\\,\\text{MPa}\n$$\n因此，应力的最终值为 $-84.00$。", "answer": "$$\n\\boxed{-84.00}\n$$", "id": "3529201"}, {"introduction": "从解析解到数值模拟是现代工程分析的必经之路，尤其是在处理如塑性这样的高度非线性行为时。本练习 [@problem_id:3529213] 是一项具有挑战性的编程任务，要求你实现一个考虑了温度相关性的弹塑性材料模型的返回映射算法（return-mapping algorithm）。通过亲自编写代码来处理材料的屈服、硬化和热软化，你将深刻理解有限元软件中非线性本构关系状态更新的核心机制，从而将理论知识转化为强大的计算实践能力。", "problem": "您需要实现一个自洽的算法求解器，用于处理符合冯·米塞斯（J2）准则、考虑热膨胀的、具有线性各向同性硬化的小应变、各向同性、温度相关的弹塑性材料行为。该求解器必须对每个测试案例独立执行一次后向欧拉（隐式）返回映射。重点是计算增量步后更新的冯·米塞斯等效应力，计算从初始无应力、无塑性变形状态开始。所有物理过程必须在三维空间和小应变运动学框架下处理。\n\n其基本原理如下。对于小应变，总应变张量 $\\boldsymbol{\\varepsilon}$ 可加法分解为弹性、塑性和热应变三部分：\n$$\n\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{e} + \\boldsymbol{\\varepsilon}^{p} + \\boldsymbol{\\varepsilon}^{th}.\n$$\n热应变增量是各向同性的，\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{th} = \\alpha(T) \\, \\Delta T \\, \\mathbf{I},\n$$\n其中 $\\alpha(T)$ 是热膨胀系数，$\\mathbf{I}$ 是单位张量。对于线性各向同性热弹性，根据胡克定律，柯西应力为\n$$\n\\boldsymbol{\\sigma} = \\lambda(T) \\, \\text{tr}(\\boldsymbol{\\varepsilon}^{e}) \\, \\mathbf{I} + 2 G(T) \\, \\text{dev}(\\boldsymbol{\\varepsilon}^{e}),\n$$\n其中 $\\text{dev}(\\cdot)$ 是偏量算子，$G(T)$ 是剪切模量，$\\lambda(T)$ 是第一拉梅参数。拉梅参数通过以下公式与温度相关的杨氏模量 $E(T)$ 和泊松比 $\\nu$ 相关联：\n$$\nG(T) = \\frac{E(T)}{2(1+\\nu)}, \\quad K(T) = \\frac{E(T)}{3(1-2\\nu)}, \\quad \\lambda(T) = K(T) - \\frac{2}{3} G(T).\n$$\n\n塑性由包含线性各向同性硬化的冯·米塞斯屈服函数控制，\n$$\nf = q - \\sigma_{y0}(T) - H \\, \\bar{\\varepsilon}^{p},\n$$\n其中 $q = \\sqrt{\\frac{3}{2}} \\, \\lVert \\boldsymbol{s} \\rVert$ 是冯·米塞斯等效应力，$\\boldsymbol{s} = \\text{dev}(\\boldsymbol{\\sigma})$ 是偏应力，$\\sigma_{y0}(T)$ 是与温度相关的初始屈服应力，$H$ 是各向同性硬化模量，$\\bar{\\varepsilon}^{p}$ 是累积等效塑性应变。其温度依赖关系为：\n$$\nE(T) = E_0 \\left[ 1 - \\beta_E (T - T_0) \\right], \\quad \\sigma_{y0}(T) = \\sigma_{y0} \\left[ 1 - \\eta (T - T_0) \\right],\n$$\n其中 $E_0$ 和 $\\sigma_{y0}$ 在参考温度 $T_0$ 下定义，$\\beta_E$ 和 $\\eta$ 是正的温度敏感性系数。热膨胀系数被视为与温度无关，即 $\\alpha(T) = \\alpha_0$。\n\n在从步骤 $n$ 到 $n+1$ 的增量层级上，从 $\\boldsymbol{\\varepsilon}^{p}_n = \\boldsymbol{0}$ 和 $\\bar{\\varepsilon}^{p}_n = 0$ 开始，通过移除热应变增量来形成弹性试探状态：\n$$\n\\boldsymbol{\\varepsilon}^{e,\\text{trial}} = \\boldsymbol{\\varepsilon}_{n+1} - \\Delta \\boldsymbol{\\varepsilon}^{th}_{n+1} - \\boldsymbol{\\varepsilon}^{p}_n,\n$$\n从而得到试探应力\n$$\n\\boldsymbol{\\sigma}^{\\text{trial}} = \\lambda(T_{n+1}) \\, \\text{tr}(\\boldsymbol{\\varepsilon}^{e,\\text{trial}}) \\, \\mathbf{I} + 2 G(T_{n+1}) \\, \\text{dev}(\\boldsymbol{\\varepsilon}^{e,\\text{trial}}).\n$$\n其偏量部分 $\\boldsymbol{s}^{\\text{trial}}$ 定义了试探等效应力 $q^{\\text{trial}} = \\sqrt{\\frac{3}{2}} \\, \\lVert \\boldsymbol{s}^{\\text{trial}} \\rVert$。试探屈服函数为\n$$\nf^{\\text{trial}} = q^{\\text{trial}} - \\sigma_{y0}(T_{n+1}) - H \\, \\bar{\\varepsilon}^{p}_n.\n$$\n如果 $f^{\\text{trial}} \\le 0$，则响应是弹性的，更新后的等效应力为 $q_{n+1} = q^{\\text{trial}}$。如果 $f^{\\text{trial}}  0$，则执行后向欧拉正交流动返回映射（在偏量空间中为径向返回），其中塑性流动方向为 $\\boldsymbol{n} = \\boldsymbol{s}^{\\text{trial}}/ \\lVert \\boldsymbol{s}^{\\text{trial}} \\rVert$，塑性乘子 $\\Delta \\gamma$ 通过求解标量一致性条件得到。累积等效塑性应变的更新公式为\n$$\n\\Delta \\bar{\\varepsilon}^{p} = \\sqrt{\\frac{2}{3}} \\, \\Delta \\gamma,\n$$\n偏应力的更新是一个径向收缩\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} \\, \\frac{q_{n+1}}{q^{\\text{trial}}}, \\quad q_{n+1} = q^{\\text{trial}} - 2 G(T_{n+1}) \\, \\Delta \\gamma.\n$$\n\n您的程序必须使用第一性原理和上述核心定义来实现此算法处理。在塑性修正过程中，将体积应力视为不变（塑性流动不可压缩），并为每个测试案例计算最终的冯·米塞斯等效应力 $q_{n+1}$。使用以下材料参数（所有常数均视为给定数据）：\n- $E_0 = 210 \\times 10^9$ $\\text{Pa}$，$\\nu = 0.3$，$T_0 = 293$ $\\text{K}$。\n- $\\alpha_0 = 1.2 \\times 10^{-5}$ $\\text{K}^{-1}$，$\\beta_E = 2.5 \\times 10^{-4}$ $\\text{K}^{-1}$，$\\sigma_{y0} = 400 \\times 10^6$ $\\text{Pa}$，$\\eta = 1.5 \\times 10^{-3}$ $\\text{K}^{-1}$，$H = 3 \\times 10^9$ $\\text{Pa}$。\n\n测试套件由独立的单步增量组成（每个增量都从 $\\boldsymbol{\\varepsilon}^{p}_n = \\boldsymbol{0}$、$\\bar{\\varepsilon}^{p}_n = 0$ 和 $T_n = T_0$ 开始），由总应变增量张量 $\\Delta \\boldsymbol{\\varepsilon}$ 和温度增量 $\\Delta T$ 指定：\n- 案例1（正常路径，弹性单轴）：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(1 \\times 10^{-4}, 0, 0)$，$\\Delta T = 0$ $\\text{K}$。\n- 案例2（塑性偏载荷）：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(3 \\times 10^{-3}, -1.5 \\times 10^{-3}, -1.5 \\times 10^{-3})$，$\\Delta T = 0$ $\\text{K}$。\n- 案例3（仅热膨胀，各向同性）：$\\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{0}$，$\\Delta T = 200$ $\\text{K}$。\n- 案例4（纯剪切屈服边界情况）：$\\Delta \\boldsymbol{\\varepsilon}$ 仅包含非对角剪切分量，工程剪切应变 $\\gamma$ 的选择使得 $q^{\\text{trial}} = \\sigma_{y0}(T_0)$，即 $\\gamma = \\sigma_{y0}(T_0) / \\left( \\sqrt{3} \\, G(T_0) \\right)$ 且 $\\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\gamma/2$，其他分量为零，$\\Delta T = 0$ $\\text{K}$。\n- 案例5（边缘情况，中等单轴增量下的冷却）：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(2 \\times 10^{-3}, 0, 0)$，$\\Delta T = -150$ $\\text{K}$。\n\n对于每种情况，计算更新后的冯·米塞斯等效应力 $q_{n+1}$，并以兆帕（MPa）为单位表示，四舍五入到三位小数。角度单位在此不适用。您的程序应生成单行输出，其中包含五个结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是对应于测试案例 $i$ 的、以 MPa 为单位的四舍五入浮点值。\n\n在问题陈述中，不得使用任何捷径或预先推导的塑性更新公式；必须从上述基本定律和核心定义出发进行推导和实现。确保所有量和参数在科学上是一致的，在物理上是合理的。", "solution": "该问题要求为一个小应变、各向同性的热弹塑性材料模型实现一个单步后向欧拉返回映射算法。验证证实，问题陈述在科学上是合理的、自洽的且适定的，提供了所有必要的本构关系、材料参数和算法定义。为塑性情况指定的更新规则，尽管使用了塑性乘子的一个略微非标准的参数化形式，但其内部是一致的，并构成了一个封闭的方程组，必须按照问题的核心定义来遵守。我们将进行完整的求解。\n\n解法是从所提供的基本原理推导出来的。对于每个测试案例，我们从初始参考温度 $T_n = T_0 = 293 \\text{ K}$ 下的无应力状态（$\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$）和零塑性应变状态（$\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$, $\\bar{\\varepsilon}^p_n = 0$）开始。施加一个总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 和温度增量 $\\Delta T$。计算步骤 $n+1$ 的最终状态。\n\n### 1. 最终温度下的材料属性\n\n材料属性是温度相关的。最终温度为 $T_{n+1} = T_n + \\Delta T = T_0 + \\Delta T$。\n杨氏模量 $E(T_{n+1})$ 和初始屈服应力 $\\sigma_{y0}(T_{n+1})$ 计算如下：\n$$\nE(T_{n+1}) = E_0 \\left[ 1 - \\beta_E (T_{n+1} - T_0) \\right] = E_0 \\left[ 1 - \\beta_E \\Delta T \\right]\n$$\n$$\n\\sigma_{y0}(T_{n+1}) = \\sigma_{y0} \\left[ 1 - \\eta (T_{n+1} - T_0) \\right] = \\sigma_{y0} \\left[ 1 - \\eta \\Delta T \\right]\n$$\n剪切模量 $G(T_{n+1})$ 和体积模量 $K(T_{n+1})$ 从 $E(T_{n+1})$ 和恒定的泊松比 $\\nu$ 推导得出：\n$$\nG(T_{n+1}) = \\frac{E(T_{n+1})}{2(1+\\nu)}, \\quad K(T_{n+1}) = \\frac{E(T_{n+1})}{3(1-2\\nu)}\n$$\n第一拉梅参数为 $\\lambda(T_{n+1}) = K(T_{n+1}) - \\frac{2}{3} G(T_{n+1})$。\n\n### 2. 弹性试探步\n\n增量步结束时的总应变为 $\\boldsymbol{\\varepsilon}_{n+1} = \\boldsymbol{\\varepsilon}_n + \\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{0} + \\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}$。根据加法分解 $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{e} + \\boldsymbol{\\varepsilon}^{p} + \\boldsymbol{\\varepsilon}^{th}$，在考虑热膨胀后，弹性试探步假设整个增量都是弹性的。\n\n热应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{th} = \\alpha_0 \\, \\Delta T \\, \\mathbf{I}$，其中 $\\mathbf{I}$ 是二阶单位张量。\n\n弹性试探应变 $\\boldsymbol{\\varepsilon}^{e, \\text{trial}}$ 是总应变中如果响应是纯弹性的那部分所引起的应力：\n$$\n\\boldsymbol{\\varepsilon}^{e, \\text{trial}} = \\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n - \\Delta\\boldsymbol{\\varepsilon}^{th} = \\Delta\\boldsymbol{\\varepsilon} - \\boldsymbol{0} - \\alpha_0 \\Delta T \\mathbf{I}\n$$\n\n试探应力 $\\boldsymbol{\\sigma}^{\\text{trial}}$ 使用 $T_{n+1}$ 温度下的材料属性，通过胡克定律计算得出：\n$$\n\\boldsymbol{\\sigma}^{\\text{trial}} = \\lambda(T_{n+1}) \\text{tr}(\\boldsymbol{\\varepsilon}^{e, \\text{trial}}) \\mathbf{I} + 2 G(T_{n+1}) \\text{dev}(\\boldsymbol{\\varepsilon}^{e, \\text{trial}})\n$$\n其中 $\\text{tr}(\\cdot)$ 和 $\\text{dev}(\\cdot)$ 分别是迹和偏量算子。试探应力的偏量部分为 $\\boldsymbol{s}^{\\text{trial}} = 2 G(T_{n+1}) \\text{dev}(\\boldsymbol{\\varepsilon}^{e, \\text{trial}})$。\n\n### 3. 屈服准则检查\n\n试探状态的冯·米塞斯等效应力 $q^{\\text{trial}}$ 从试探偏应力 $\\boldsymbol{s}^{\\text{trial}}$ 计算得出：\n$$\nq^{\\text{trial}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}^{\\text{trial}}:\\boldsymbol{s}^{\\text{trial}}} = \\sqrt{\\frac{3}{2}} \\lVert \\boldsymbol{s}^{\\text{trial}} \\rVert_F\n$$\n其中 $\\lVert \\cdot \\rVert_F$ 表示 Frobenius 范数。\n\n评估试探屈服函数 $f^{\\text{trial}}$：\n$$\nf^{\\text{trial}} = q^{\\text{trial}} - \\sigma_{y0}(T_{n+1}) - H \\bar{\\varepsilon}^p_n\n$$\n由于每个案例都从无塑性变形状态开始，$\\bar{\\varepsilon}^p_n = 0$，因此检查简化为：\n$$\nf^{\\text{trial}} = q^{\\text{trial}} - \\sigma_{y0}(T_{n+1})\n$$\n\n### 4. 状态更新\n\n根据 $f^{\\text{trial}}$ 的值有两种可能性。\n\n**情况 A：弹性响应 ($f^{\\text{trial}} \\le 0$)**\n如果试探应力在屈服面内部或表面上，则该增量步是纯弹性的。最终应力状态即为试探状态，没有塑性应变产生。\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{trial}}, \\quad q_{n+1} = q^{\\text{trial}}, \\quad \\bar{\\varepsilon}^p_{n+1} = \\bar{\\varepsilon}^p_n = 0\n$$\n\n**情况 B：塑性响应 ($f^{\\text{trial}}  0$)**\n如果试探应力在屈服面之外，则发生塑性变形。使用后向欧拉返回映射算法将应力状态拉回到更新后的屈服面上。问题指定了一套更新规则，我们必须使用这些规则来推导塑性修正。\n\n最终状态 $(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1})$ 必须满足一致性条件 $f_{n+1} = 0$：\n$$\nf_{n+1} = q_{n+1} - \\sigma_{y0}(T_{n+1}) - H \\bar{\\varepsilon}^p_{n+1} = 0\n$$\n累积塑性应变更新为 $\\bar{\\varepsilon}^p_{n+1} = \\bar{\\varepsilon}^p_n + \\Delta\\bar{\\varepsilon}^p = \\Delta\\bar{\\varepsilon}^p$。问题为塑性乘子 $\\Delta\\gamma$ 提供了以下运动学关系：\n$$\n\\Delta\\bar{\\varepsilon}^p = \\sqrt{\\frac{2}{3}} \\Delta\\gamma\n$$\n$$\nq_{n+1} = q^{\\text{trial}} - 2 G(T_{n+1}) \\Delta\\gamma\n$$\n将这些代入一致性条件，得到一个关于未知数 $\\Delta\\gamma$ 的方程：\n$$\n(q^{\\text{trial}} - 2 G(T_{n+1}) \\Delta\\gamma) - \\sigma_{y0}(T_{n+1}) - H \\left(\\sqrt{\\frac{2}{3}} \\Delta\\gamma\\right) = 0\n$$\n对含 $\\Delta\\gamma$ 的项进行分组：\n$$\nq^{\\text{trial}} - \\sigma_{y0}(T_{n+1}) = \\left(2 G(T_{n+1}) + H \\sqrt{\\frac{2}{3}}\\right) \\Delta\\gamma\n$$\n等式左边即为试探屈服函数 $f^{\\text{trial}}$。求解 $\\Delta\\gamma$：\n$$\n\\Delta\\gamma = \\frac{f^{\\text{trial}}}{2 G(T_{n+1}) + H \\sqrt{2/3}}\n$$\n确定 $\\Delta\\gamma$ 后，将其代入更新方程以计算最终的冯·米塞斯等效应力 $q_{n+1}$：\n$$\nq_{n+1} = q^{\\text{trial}} - 2 G(T_{n+1}) \\left( \\frac{f^{\\text{trial}}}{2 G(T_{n+1}) + H \\sqrt{2/3}} \\right)\n$$\n塑性流动是等体积的，因此静水压力部分不受塑性修正的影响。偏应力被径向拉回到新的屈服面上：$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} (q_{n+1} / q^{\\text{trial}})$。最终所需的量是 $q_{n+1}$。\n\n此算法框架将被实现并应用于每个指定的测试案例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermo-elastoplastic problem for a series of test cases.\n    \"\"\"\n    # Material Parameters\n    E0 = 210e9  # Pa\n    nu = 0.3\n    T0 = 293.0  # K\n    alpha0 = 1.2e-5  # K^-1\n    beta_E = 2.5e-4  # K^-1\n    sigma_y0_ref = 400e6  # Pa\n    eta = 1.5e-3  # K^-1\n    H = 3e9  # Pa\n\n    # Helper function for temperature-dependent properties\n    def get_material_properties(T_final, delta_T):\n        \"\"\"Calculates material properties at the final temperature.\"\"\"\n        E = E0 * (1 - beta_E * delta_T)\n        sigma_y = sigma_y0_ref * (1 - eta * delta_T)\n        G = E / (2 * (1 + nu))\n        K = E / (3 * (1 - 2 * nu))\n        return {'E': E, 'G': G, 'K': K, 'sigma_y': sigma_y}\n\n    # Define test cases\n    # Case 4 requires pre-calculation for gamma\n    G0 = E0 / (2 * (1 + nu))\n    gamma_case4 = sigma_y0_ref / (np.sqrt(3) * G0)\n    \n    test_cases = [\n        # Case 1: Elastic Uniaxial\n        {'delta_eps': np.diag([1e-4, 0, 0]), 'delta_T': 0.0},\n        # Case 2: Plastic Deviatoric\n        {'delta_eps': np.diag([3e-3, -1.5e-3, -1.5e-3]), 'delta_T': 0.0},\n        # Case 3: Thermal Expansion\n        {'delta_eps': np.zeros((3, 3)), 'delta_T': 200.0},\n        # Case 4: Boundary Pure Shear\n        {'delta_eps': np.array([[0, gamma_case4 / 2, 0], [gamma_case4 / 2, 0, 0], [0, 0, 0]]), 'delta_T': 0.0},\n        # Case 5: Cooling with Uniaxial\n        {'delta_eps': np.diag([2e-3, 0, 0]), 'delta_T': -150.0},\n    ]\n\n    results = []\n    I = np.identity(3)\n\n    for case in test_cases:\n        delta_eps = case['delta_eps']\n        delta_T = case['delta_T']\n        \n        # 1. Material Properties at Final Temperature\n        T_final = T0 + delta_T\n        props = get_material_properties(T_final, delta_T)\n        G = props['G']\n        sigma_y = props['sigma_y']\n\n        # 2. Elastic Trial Step\n        # Initial state is eps_p_n = 0, so eps_n+1 = delta_eps\n        eps_th_inc = alpha0 * delta_T * I\n        eps_e_trial = delta_eps - eps_th_inc\n\n        # Decompose trial strain\n        tr_eps_e_trial = np.trace(eps_e_trial)\n        dev_eps_e_trial = eps_e_trial - (tr_eps_e_trial / 3.0) * I\n\n        # Trial stress (deviatoric part is sufficient for q_trial)\n        s_trial = 2.0 * G * dev_eps_e_trial\n        \n        # 3. Yield Criterion Check\n        norm_s_trial = np.linalg.norm(s_trial, 'fro')\n        q_trial = np.sqrt(3.0 / 2.0) * norm_s_trial\n\n        # Initial accumulated plastic strain is zero for all cases\n        # f_trial = q_trial - sigma_y - H * eps_p_bar_n\n        f_trial = q_trial - sigma_y\n\n        # 4. State Update\n        if f_trial = 0:\n            # Elastic response\n            q_final = q_trial\n        else:\n            # Plastic response: radial return\n            # Solve for plastic multiplier delta_gamma\n            delta_gamma = f_trial / (2.0 * G + H * np.sqrt(2.0 / 3.0))\n            \n            # Update equivalent stress\n            q_final = q_trial - 2.0 * G * delta_gamma\n            \n        # Convert to MPa and round\n        results.append(round(q_final / 1e6, 3))\n\n    formatted_results = f\"[{','.join(map(str, results))}]\"\n    print(formatted_results)\n\nsolve()\n\n```", "id": "3529213"}]}