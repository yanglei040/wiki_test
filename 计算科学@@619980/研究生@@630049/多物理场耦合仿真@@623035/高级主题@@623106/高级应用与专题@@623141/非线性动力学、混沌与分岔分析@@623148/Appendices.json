{"hands_on_practices": [{"introduction": "系统是如何从一个稳定的静态过渡到自持振荡的？霍普夫分岔（Hopf bifurcation）为此提供了基本答案，而时间延迟是许多多物理场系统中常见的触发因素。本练习将指导你分析推导一个延迟振子的霍普夫分岔边界，这是预测振动或不稳定性出现的关键技能。[@problem_id:3518527]", "problem": "考虑一个单自由度延迟反馈振子，该振子出现在一个带有传感器-执行器延迟的电热微谐振器的多物理场耦合仿真中。其控制律为延迟微分方程（DDE）\n$$\n\\dot{x}(t) \\;=\\; \\mu\\,x(t) \\;-\\; \\beta\\,x(t-\\tau) \\;-\\; x^{3}(t),\n$$\n其中 $\\mu$ 模拟了由热-机耦合路径引起的瞬时自激，$\\beta>0$ 量化了起稳定作用的延迟反馈，$\\tau>0$ 是反馈延迟。三次项 $-x^{3}(t)$ 模拟了由多物理场非线性引起的局部饱和。零状态 $x^{\\ast}=0$ 对所有参数都是一个平衡点。\n\n从线性化、线性DDE的指数解以及霍普夫分岔（Hopf bifurcation）的定义（即一对纯虚特征指数以非零频率穿过虚轴）等第一性原理出发，完成以下任务：\n\n- 将系统在 $x^{\\ast}=0$ 附近线性化，得到控制小扰动的线性DDE。\n- 推导形式为 $x(t)\\sim \\exp(s t)$ 的指数扰动的特征方程。\n- 施加霍普夫分岔条件 $s=i\\omega$（其中 $\\omega\\neq 0$），并推导存在纯虚根时 $\\omega$ 和 $\\tau$ 所满足的条件。\n- 在假设 $\\beta>0$ 和 $|\\mu| < \\beta$（这些假设确保了此类根的存在）下，确定在 $x^{\\ast}=0$ 处引发霍普夫分岔的最小正延迟 $\\tau=\\tau_{c}$。\n\n以 $\\mu$ 和 $\\beta$ 表示的 $\\tau_{c}$ 的单个精确符号表达式的形式给出最终答案。最终答案框中不要包含单位；无需四舍五入。", "solution": "所给问题是非线性动力学和分岔理论领域中一个适定问题。它具有科学依据，内容自洽，并要求对一个延迟微分方程进行霍普夫分岔条件的标准推导。我们可以开始求解。\n\n控制延迟微分方程（DDE）由下式给出：\n$$\n\\dot{x}(t) = \\mu\\,x(t) - \\beta\\,x(t-\\tau) - x^{3}(t)\n$$\n零状态 $x^{\\ast}=0$ 是一个平衡点，因为将 $x(t) = 0$ 代入方程对所有 $t$ 成立，得到 $\\dot{x}(t)=0$。\n\n**第1步：线性化**\n为了分析平衡点 $x^{\\ast}=0$ 的稳定性，我们在此点附近对DDE进行线性化。令 $x(t) = x^{\\ast} + \\delta x(t) = \\delta x(t)$，其中 $\\delta x(t)$ 是一个小扰动。将其代入DDE：\n$$\n\\frac{d}{dt}(\\delta x(t)) = \\mu\\,\\delta x(t) - \\beta\\,\\delta x(t-\\tau) - (\\delta x(t))^{3}\n$$\n对于小扰动，三次项 $(\\delta x(t))^{3}$ 是高阶项，可以忽略。这就得到了控制小扰动的线性DDE：\n$$\n\\dot{\\delta x}(t) = \\mu\\,\\delta x(t) - \\beta\\,\\delta x(t-\\tau)\n$$\n\n**第2步：特征方程**\n我们寻求线性DDE的形式为 $\\delta x(t) = C e^{st}$ 的指数解，其中 $C$ 是一个常数，$s$ 是一个表示特征指数（或特征值）的复数。将这个拟设代入线性DDE：\n$$\n\\frac{d}{dt}(C e^{st}) = \\mu\\,(C e^{st}) - \\beta\\,(C e^{s(t-\\tau)})\n$$\n$$\ns C e^{st} = \\mu\\,C e^{st} - \\beta\\,C e^{st} e^{-s\\tau}\n$$\n假设存在非平凡解（$C \\neq 0$），我们可以将整个方程除以 $C e^{st}$，得到系统的特征方程：\n$$\ns = \\mu - \\beta e^{-s\\tau}\n$$\n\n**第3步：霍普夫分岔条件**\n当一对共轭复特征指数以非零速度穿过虚轴时，发生霍普夫分岔。在分岔点，指数是纯虚数。我们施加条件 $s = i\\omega$，其中 $\\omega \\in \\mathbb{R}$ 且 $\\omega \\neq 0$ 是霍普夫频率。将 $s = i\\omega$ 代入特征方程：\n$$\ni\\omega = \\mu - \\beta e^{-i\\omega\\tau}\n$$\n使用欧拉公式 $e^{-i\\omega\\tau} = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$，我们得到：\n$$\ni\\omega = \\mu - \\beta (\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n$$\ni\\omega = (\\mu - \\beta\\cos(\\omega\\tau)) + i(\\beta\\sin(\\omega\\tau))\n$$\n为使此等式成立，等式两边的实部和虚部必须相等。\n\n令实部相等：\n$$\n0 = \\mu - \\beta\\cos(\\omega\\tau) \\implies \\cos(\\omega\\tau) = \\frac{\\mu}{\\beta}\n$$\n\n令虚部相等：\n$$\n\\omega = \\beta\\sin(\\omega\\tau) \\implies \\sin(\\omega\\tau) = \\frac{\\omega}{\\beta}\n$$\n\n**第4步：$\\tau_c$ 的推导**\n我们现在有一个关于未知数 $\\omega$ 和 $\\tau$ 的方程组。我们可以利用基本三角恒等式 $\\sin^2(\\theta) + \\cos^2(\\theta) = 1$ 来求解霍普夫频率 $\\omega$。将此恒等式应用于我们的方程，并令 $\\theta = \\omega\\tau$：\n$$\n\\left(\\frac{\\omega}{\\beta}\\right)^{2} + \\left(\\frac{\\mu}{\\beta}\\right)^{2} = 1\n$$\n$$\n\\frac{\\omega^{2}}{\\beta^{2}} + \\frac{\\mu^{2}}{\\beta^{2}} = 1\n$$\n$$\n\\omega^{2} + \\mu^{2} = \\beta^{2}\n$$\n求解 $\\omega^{2}$：\n$$\n\\omega^{2} = \\beta^{2} - \\mu^{2}\n$$\n为了发生霍普夫分岔，我们需要一个非零的实频率 $\\omega$，这意味着 $\\omega^{2} > 0$。这又意味着 $\\beta^{2} > \\mu^{2}$，或 $|\\beta| > |\\mu|$。因为题目给定 $\\beta > 0$，此条件变为 $\\beta > |\\mu|$，这等价于问题中 $|\\mu| < \\beta$ 的假设。该假设保证了纯振荡解的存在。我们取频率的正根，不失一般性：\n$$\n\\omega = \\sqrt{\\beta^{2} - \\mu^{2}}\n$$\n现在我们求解延迟 $\\tau$。我们有 $\\cos(\\omega\\tau)$ 和 $\\sin(\\omega\\tau)$ 的关系式。我们可以从这两个值中求出角度 $\\omega\\tau$。具体来说，从 $\\sin(\\omega\\tau) = \\frac{\\omega}{\\beta} = \\frac{\\sqrt{\\beta^{2} - \\mu^{2}}}{\\beta}$ 可知，由于 $\\beta>0$ 和 $\\omega>0$，所以 $\\sin(\\omega\\tau) > 0$。这意味着角度 $\\omega\\tau$ 必须在区间 $(0, \\pi)$ 加上 $2\\pi$ 的整数倍。\n`arccos` 函数的值域为 $[0, \\pi]$。将其应用于我们的余弦方程，得到角度的主值：\n$$\n\\omega\\tau = \\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\n这个选择与 $\\sin(\\omega\\tau) > 0$ 是一致的，因为对于自变量 $x \\in (-1, 1)$，$\\arccos(x) \\in (0, \\pi)$，并且对于任何角度 $\\theta \\in (0, \\pi)$，都有 $\\sin(\\theta) > 0$。\n延迟的通解由下式给出：\n$$\n\\omega\\tau_{k} = \\arccos\\left(\\frac{\\mu}{\\beta}\\right) + 2\\pi k, \\quad k \\in \\{0, 1, 2, \\dots\\}\n$$\n$$\n\\tau_{k} = \\frac{1}{\\omega}\\left(\\arccos\\left(\\frac{\\mu}{\\beta}\\right) + 2\\pi k\\right)\n$$\n题目要求的是最小正延迟 $\\tau_{c}$。这对应于 $k=0$ 的情况：\n$$\n\\tau_{c} = \\frac{1}{\\omega}\\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\n由于 $|\\mu|<\\beta$，反余弦函数的自变量在 $(-1, 1)$ 区间内，因此 $\\arccos(\\mu/\\beta) \\in (0, \\pi)$。又因为 $\\omega > 0$，所以可以保证 $\\tau_c$ 是正数。\n代入 $\\omega$ 的表达式：\n$$\n\\tau_{c} = \\frac{1}{\\sqrt{\\beta^{2} - \\mu^{2}}} \\arccos\\left(\\frac{\\mu}{\\beta}\\right)\n$$\n这就是在原点处引发霍普夫分岔的最小正延迟的最终表达式。", "answer": "$$\n\\boxed{\\frac{\\arccos\\left(\\frac{\\mu}{\\beta}\\right)}{\\sqrt{\\beta^{2}-\\mu^{2}}}}\n$$", "id": "3518527"}, {"introduction": "一旦振荡（即周期轨道）建立起来，其稳定性决定了它在现实中能否被观测到。弗洛凯理论（Floquet theory）与庞加莱映射（Poincaré map）的概念相结合，为这种稳定性分析提供了严谨的框架。在此实践中，你将计算一个三维系统中周期轨道的弗洛凯乘子（Floquet multipliers），它们如同特征值一样，决定了对轨道的微小扰动的最终命运。[@problem_id:3518538]", "problem": "考虑由以下耦合系统定义的三维自治流\n$$\n\\frac{dx}{dt} = \\left(\\mu - (x^2+y^2)\\right)x - \\omega y,\\quad\n\\frac{dy}{dt} = \\left(\\mu - (x^2+y^2)\\right)y + \\omega x,\\quad\n\\frac{dz}{dt} = -\\lambda\\left(z - z_0\\right),\n$$\n其中 $x$、$y$ 和 $z$ 是状态变量，$\\mu > 0$ 是一个增长参数，$\\omega > 0$ 是一个角频率（角度使用弧度制），$\\lambda \\ge 0$ 是一个弛豫率，$z_0$ 是一个常数偏移量。该流是一个最小多物理场代理，它将一个平面非线性振子（用于模拟流体-热相互作用中的通用自激动力学）与一个线性弛豫模式（用于模拟热场或化学场）耦合起来。该平面子系统是超临界 Hopf 分岔点附近的范式。\n\n根据非线性动力学的基本原理：\n\n- 周期轨道是一条闭合轨迹 $\\gamma(t)$，满足 $\\gamma(t+T)=\\gamma(t)$（对于某个周期 $T>0$），而 Poincaré 截面是在轨道上一点 $x^\\star$ 处横截于流的余维一曲面 $\\Sigma$。\n- Poincaré 返回映射 $P:\\Sigma\\to\\Sigma$ 将 $x^\\star$ 附近的一点映射到其沿流运动后与 $\\Sigma$ 的下一个交点。\n- 线性化返回映射 $DP(x^\\star)$ 捕捉了约束在 $\\Sigma$ 上的无穷小扰动在一次返回过程中的演化，其特征值是周期轨道的非平凡 Floquet 乘子。\n- 沿解 $x(t)$ 的变分（切）动力学由 $\\dot{\\Phi}(t)=J(x(t))\\Phi(t)$ 给出，其中 $J(x)=\\partial f/\\partial x$ 是流 $f$ 的雅可比矩阵，$\\Phi(0)=I$ 是单位矩阵，而单值矩阵 $\\Phi(T)$ 编码了一个周期内的线性化演化。对于自治系统，总有一个与时间平移对称性相关的中性 Floquet 乘子等于 $1$；其余的乘子由 $DP(x^\\star)$ 捕捉。\n\n任务：\n\n1. 使用给定的流，在点 $x^\\star=\\left(\\sqrt{\\mu},\\,0,\\,z_0\\right)$ 处构造一个与周期轨道 $\\gamma(t)$ 正交的 Poincaré 截面，该截面由平面定义\n$$\n\\Sigma=\\left\\{x\\in\\mathbb{R}^3:\\, n^\\top (x-x^\\star)=0\\right\\},\\quad n=\\frac{f(x^\\star)}{\\|f(x^\\star)\\|},\n$$\n其中 $f(x)=\\left(\\left(\\mu - (x^2+y^2)\\right)x - \\omega y,\\;\\left(\\mu - (x^2+y^2)\\right)y + \\omega x,\\;-\\lambda (z-z_0)\\right)$。\n\n2. 计算周期 $T=2\\pi/\\omega$。\n\n3. 对耦合的状态-变分系统积分一个周期，以获得单值矩阵 $\\Phi(T)$，其中雅可比矩阵 $J(x)$ 为\n$$\nJ(x,y,z)=\n\\begin{bmatrix}\n\\mu - 3x^2 - y^2  -2xy - \\omega  0 \\\\\n-2xy + \\omega  \\mu - x^2 - 3y^2  0 \\\\\n0  0  -\\lambda\n\\end{bmatrix}.\n$$\n\n4. 通过构造 $\\Sigma$ 的一个标准正交基 $\\{e_2,e_3\\}$，将线性化演化限制在截面 $\\Sigma$ 上，并按如下方式形成 $2\\times 2$ 的线性化返回映射 $B$：对每个基向量 $e_i$ ($i=2,3$)，通过单值矩阵 $M=\\Phi(T)$ 对其进行映射，使用正交投影算子 $P=I - nn^\\top$ 将结果投影回 $\\Sigma$，并在基 $\\{e_2,e_3\\}$ 中表示投影后的向量。得到的 $2\\times 2$ 矩阵 $B$ 近似于 $DP(x^\\star)$。\n\n5. 计算 Poincaré 返回映射的两个 Floquet 乘子，即为 $B$ 的特征值，并为每个测试案例按非递减顺序报告它们。\n\n使用以下为覆盖率而设计的参数集 $(\\mu,\\omega,\\lambda,z_0)$ 测试套件：\n\n- 案例 A（一般稳定极限环）：$(\\mu,\\omega,\\lambda,z_0)=(1.0,\\,2.0,\\,0.5,\\,0.0)$。\n- 案例 B（$z$ 方向更快的弛豫，小振幅）：$(\\mu,\\omega,\\lambda,z_0)=(0.1,\\,1.0,\\,2.0,\\,1.0)$。\n- 案例 C（中性 $z$ 模式边界情况）：$(\\mu,\\omega,\\lambda,z_0)=(0.8,\\,3.0,\\,0.0,\\,2.3)$。\n- 案例 D（接近 Hopf 分岔起始点的小振幅）：$(\\mu,\\omega,\\lambda,z_0)=(10^{-3},\\,5.0,\\,1.0,\\,-0.7)$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。该列表必须是案例 A、B、C 和 D 的 Poincaré 返回映射的两个 Floquet 乘子（在每个案例内按非递减顺序排列）按此顺序串联而成的。例如，一个有效的输出格式是\n$$\n[\\text{A}_1,\\text{A}_2,\\text{B}_1,\\text{B}_2,\\text{C}_1,\\text{C}_2,\\text{D}_1,\\text{D}_2],\n$$\n其中每个条目都是一个浮点数。", "solution": "该问题要求计算给定三维自治流的周期轨道的 Floquet 乘子。这些乘子表征了轨道的稳定性，并且是线性化 Poincaré 返回映射的特征值。\n\n微分方程组为：\n$$\n\\frac{dx}{dt} = \\left(\\mu - (x^2+y^2)\\right)x - \\omega y \\\\\n\\frac{dy}{dt} = \\left(\\mu - (x^2+y^2)\\right)y + \\omega x \\\\\n\\frac{dz}{dt} = -\\lambda\\left(z - z_0\\right)\n$$\n其中参数 $\\mu  0$、$\\omega  0$ 和 $\\lambda \\ge 0$ 是给定的。\n\n首先，我们确定周期轨道。关于 $z$ 坐标的方程 $\\dot{z} = -\\lambda(z-z_0)$ 与 $(x, y)$ 动力学是解耦的。对于任意初始条件 $z(0)$，其解为 $z(t) = z_0 + (z(0)-z_0)e^{-\\lambda t}$。周期轨道要求 $z(t)$ 是周期的，对于这种线性弛豫动力学，这仅当 $z(t)$ 是常数时才会发生。如果 $z(0)=z_0$，则可以实现这一点，这意味着对所有 $t$ 都有 $z(t) = z_0$。\n\n因此，动力学被约束在平面 $z=z_0$ 上，其中 $x$ 和 $y$ 的方程构成了 Stuart-Landau 振子，这是超临界 Hopf 分岔的范式。\n在极坐标中，$r = \\sqrt{x^2+y^2}$ 和 $\\theta = \\arctan(y/x)$，平面动力学变为：\n$$\n\\dot{r} = r(\\mu-r^2) \\\\\n\\dot{\\theta} = \\omega\n$$\n对于 $\\mu  0$，该系统在 $r = \\sqrt{\\mu}$ 处有一个稳定的极限环，其角频率为常数 $\\omega$。此轨道的周期是 $T = 2\\pi/\\omega$。通过选择一个合适的相位，完整的三维周期轨道 $\\gamma(t)$ 可以表示为：\n$$\n\\gamma(t) = \\left(\\sqrt{\\mu}\\cos(\\omega t), \\sqrt{\\mu}\\sin(\\omega t), z_0\\right)^\\top\n$$\n问题要求在点 $x^\\star = \\gamma(0) = (\\sqrt{\\mu}, 0, z_0)^\\top$ 处构造一个 Poincaré 截面。\n\n此周期轨道的稳定性由非平凡 Floquet 乘子决定，这些乘子是线性化 Poincaré 返回映射 $DP(x^\\star)$ 的特征值。问题要求通过分析单值矩阵 $\\Phi(T)$ 来计算它们，其中 $\\Phi(T)$ 是变分方程 $\\dot{\\Phi}(t) = J(\\gamma(t))\\Phi(t)$ 在 $\\Phi(0)=I$ 条件下于时间 $T$ 的解。\n\n在轨道 $\\gamma(t)$ 上求值的雅可比矩阵 $J$ 由于 $z$ 坐标的解耦而是块对角矩阵：\n$$\nJ(\\gamma(t)) =\n\\begin{bmatrix}\nJ_{xy}(t)  \\mathbf{0} \\\\\n\\mathbf{0}^\\top  -\\lambda\n\\end{bmatrix}\n$$\n其中 $J_{xy}(t)$ 是沿极限环求值的平面子系统的 $2 \\times 2$ 雅可比矩阵。因此，单值矩阵 $\\Phi(T)$ 也是块对角的：\n$$\n\\Phi(T) =\n\\begin{bmatrix}\n\\Phi_{xy}(T)  \\mathbf{0} \\\\\n\\mathbf{0}^\\top  e^{-\\lambda T}\n\\end{bmatrix}\n$$\n项 $e^{-\\lambda T}$ 来自于求解 $\\dot{\\phi}_z = -\\lambda \\phi_z$（其中 $\\phi_z(0)=1$）。该项本身就是线性化 Poincaré 映射的特征值之一，对应于 $z$ 方向的扰动。此乘子为 $\\mu_z = e^{-\\lambda T} = e^{-2\\pi\\lambda/\\omega}$。\n\n剩下的乘子来自 $2 \\times 2$ 矩阵 $\\Phi_{xy}(T)$ 的特征值。系统的自治性决定了单值矩阵 $\\Phi(T)$ 必须有一个等于 $1$ 的特征值，这对应于沿流方向的扰动（时间平移不变性）。相关的特征向量是轨道在初始点处的切向量 $\\dot{\\gamma}(0) = f(x^\\star)$。对于我们的系统，$\\dot{\\gamma}(0) = (0, \\omega\\sqrt{\\mu}, 0)^\\top$。由于该向量的 $z$ 分量为零，因此它是平面单值矩阵 $\\Phi_{xy}(T)$ 的一个特征向量。因此，$\\Phi_{xy}(T)$ 的一个特征值必须为 $1$。\n\n$\\Phi_{xy}(T)$ 的特征值之积由其行列式给出。根据 Liouville 公式，行列式与矩阵 $J_{xy}(t)$ 的迹相关：\n$$\n\\det(\\Phi_{xy}(T)) = \\exp\\left(\\int_0^T \\text{tr}(J_{xy}(t)) \\,dt\\right)\n$$\n沿轨道的 $J_{xy}(t)$ 的迹为：\n$$\n\\text{tr}(J_{xy}(t)) = (\\mu - 3x(t)^2 - y(t)^2) + (\\mu - x(t)^2 - 3y(t)^2) \\\\\n= 2\\mu - 4(x(t)^2+y(t)^2)\n$$\n在极限环上，$x(t)^2+y(t)^2 = r^2 = \\mu$。因此，\n$$\n\\text{tr}(J_{xy}(t)) = 2\\mu - 4\\mu = -2\\mu\n$$\n积分则为 $\\int_0^T (-2\\mu) \\,dt = -2\\mu T$。\n所以，$\\det(\\Phi_{xy}(T)) = e^{-2\\mu T}$。\n由于 $\\Phi_{xy}(T)$ 的特征值是 $1$ 和非平凡的平面乘子（我们称之为 $\\mu_{r}$），它们的乘积必须是行列式。因此，$1 \\cdot \\mu_{r} = e^{-2\\mu T}$。这个乘子控制着径向扰动衰减回极限环 $r=\\sqrt{\\mu}$ 的过程。\n\n周期轨道的两个非平凡 Floquet 乘子是 Poincaré 返回映射的特征值。它们对应于与流向正交的扰动。这恰好是与径向（$r$）和垂直（$z$）扰动相关的乘子。因此，这两个乘子是：\n$$\n\\mu_r = e^{-2\\mu T} = \\exp\\left(-\\frac{4\\pi\\mu}{\\omega}\\right) \\\\\n\\mu_z = e^{-\\lambda T} = \\exp\\left(-\\frac{2\\pi\\lambda}{\\omega}\\right)\n$$\n这个基于系统基本结构的原则性推导，绕过了对变分方程进行数值积分的需要。我们现在可以将这些公式应用于给定的测试案例。任务是为每个案例报告这两个乘子，并按非递减顺序排序。\n\n对于每个参数集 $(\\mu, \\omega, \\lambda, z_0)$：\n1. 计算第一个乘子 $\\mu_1 = \\exp(-4\\pi\\mu/\\omega)$。\n2. 计算第二个乘子 $\\mu_2 = \\exp(-2\\pi\\lambda/\\omega)$。\n3. 该案例的结果是值 $(\\mu_1, \\mu_2)$ 按非递减顺序排序。\n\n案例 A: $(\\mu, \\omega, \\lambda, z_0)=(1.0, 2.0, 0.5, 0.0)$\n$\\mu_1 = \\exp(-4\\pi \\cdot 1.0 / 2.0) = e^{-2\\pi} \\approx 0.001867$\n$\\mu_2 = \\exp(-2\\pi \\cdot 0.5 / 2.0) = e^{-\\pi/2} \\approx 0.207880$\n排序后：$[0.001867, 0.207880]$\n\n案例 B: $(\\mu, \\omega, \\lambda, z_0)=(0.1, 1.0, 2.0, 1.0)$\n$\\mu_1 = \\exp(-4\\pi \\cdot 0.1 / 1.0) = e^{-0.4\\pi} \\approx 0.284600$\n$\\mu_2 = \\exp(-2\\pi \\cdot 2.0 / 1.0) = e^{-4\\pi} \\approx 0.000003$\n排序后：$[0.000003, 0.284600]$\n\n案例 C: $(\\mu, \\omega, \\lambda, z_0)=(0.8, 3.0, 0.0, 2.3)$\n$\\mu_1 = \\exp(-4\\pi \\cdot 0.8 / 3.0) = e^{-3.2\\pi/3} \\approx 0.035105$\n$\\mu_2 = \\exp(-2\\pi \\cdot 0.0 / 3.0) = e^0 = 1.0$\n排序后：$[0.035105, 1.0]$\n\n案例 D: $(\\mu, \\omega, \\lambda, z_0)=(10^{-3}, 5.0, 1.0, -0.7)$\n$\\mu_1 = \\exp(-4\\pi \\cdot 0.001 / 5.0) = e^{-0.0008\\pi} \\approx 0.997490$\n$\\mu_2 = \\exp(-2\\pi \\cdot 1.0 / 5.0) = e^{-0.4\\pi} \\approx 0.284600$\n排序后：$[0.284600, 0.997490]$", "answer": "[0.001867,0.207880,0.000003,0.284600,0.035105,1.000000,0.284600,0.997490]", "id": "3518538"}, {"introduction": "混沌的标志是对初始条件的敏感依赖性，即相邻轨道呈指数级分离。最大李雅普诺夫指数（Largest Lyapunov Exponent, LLE）是量化这种分离并为混沌行为提供明确检验的主要工具。这项计算练习要求你为著名的 Lorenz 系统实现计算 LLE 的标准算法，从而使你能够描绘出其参数空间中的混沌区域。[@problem_id:3518460]", "problem": "考虑一个耦合了流体动量和热输运的浮力驱动对流降阶模型，该模型通常被称为 Lorenz 系统。该系统由以下常微分方程 (ODEs) 描述\n$$\n\\frac{dX}{dt}=\\sigma\\,(Y-X),\\qquad\n\\frac{dY}{dt}=X\\,(r-Z)-Y,\\qquad\n\\frac{dZ}{dt}=X\\,Y-b\\,Z,\n$$\n其中 $X$、$Y$ 和 $Z$ 是状态变量，而 $\\sigma$、$r$ 和 $b$ 分别是代表普朗特数、归一化瑞利参数和一个几何或耗散因子的参数。在本问题中，您将使用最大李雅普诺夫指数 (LLE) 的导数，对混沌的产生和鲁棒性相对于参数 $(\\sigma,r,b)$ 进行敏感性分析。\n\n最大李雅普诺夫指数 $\\lambda_{\\max}$ 量化了邻近轨道发散的平均指数率。对于一条轨道 $x(t)=(X(t),Y(t),Z(t))$，LLE 由线性化（切）动力学定义\n$$\n\\frac{d\\delta x}{dt}=J(x(t))\\,\\delta x,\n$$\n其中 $\\delta x$ 是一个无穷小扰动，$J(x)$ 是与 Lorenz 常微分方程相关的向量场 $f(x)$ 的雅可比矩阵。雅可比矩阵 $J(x)$ 为\n$$\nJ(x)=\n\\begin{bmatrix}\n-\\sigma  \\sigma  0 \\\\\nr-Z  -1  -X \\\\\nY  X  -b\n\\end{bmatrix}.\n$$\n最大李雅普诺夫指数由下式给出\n$$\n\\lambda_{\\max}=\\lim_{T\\to\\infty}\\frac{1}{T}\\log\\left(\\frac{\\|\\delta x(T)\\|}{\\|\\delta x(0)\\|}\\right),\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。在数值上，可以通过将状态 $x(t)$ 与切扰动 $\\delta x(t)$ 一起演化，并周期性地对 $\\delta x(t)$ 进行重新归一化，累积其增长因子的对数，然后除以总演化时间来近似这个极限。\n\n您的任务是：\n- 从上述 ODE 和雅可比矩阵出发，推导并实现一个数值程序，用以估算给定 $(\\sigma,r,b)$ 下的 $\\lambda_{\\max}$。请使用以下科学上合理的数值参数选择：一个满足 $0\\Delta t\\ll 1$ 的固定时间步长 $\\Delta t$；一个瞬态积分时间 $T_{\\mathrm{trans}}0$，以使轨道接近吸引集；以及一个用于估算 $\\lambda_{\\max}$ 的累积时间 $T_{\\mathrm{acc}}0$。使用确定性初始条件 $X(0)=Y(0)=Z(0)=1$ 和一个单位范数的初始切向量。您必须对非线性系统和切线性系统均使用显式四阶 Runge–Kutta 积分法。在每个时间步，重新归一化切向量并累积瞬时对数增长，以将累积总和除以总累积时间来估算 $\\lambda_{\\max}$。\n- 使用具有小参数增量 $h_\\sigma$、$h_r$ 和 $h_b$ 的二阶中心有限差分法，估算偏导数 $\\partial \\lambda_{\\max}/\\partial \\sigma$、$\\partial \\lambda_{\\max}/\\partial r$ 和 $\\partial \\lambda_{\\max}/\\partial b$。例如，\n$$\n\\frac{\\partial \\lambda_{\\max}}{\\partial \\sigma}\\approx \\frac{\\lambda_{\\max}(\\sigma+h_\\sigma,r,b)-\\lambda_{\\max}(\\sigma-h_\\sigma,r,b)}{2h_\\sigma},\n$$\n对于 $r$ 和 $b$ 有类似的公式。\n- 按如下方式定量解释混沌状态的鲁棒性：当且仅当 $\\lambda_{\\max}(\\sigma,r,b)0$ 且在所有单参数扰动 $\\sigma\\mapsto \\sigma\\pm h_\\sigma$、$r\\mapsto r\\pm h_r$ 和 $b\\mapsto b\\pm h_b$ 下 $\\lambda_{\\max}$ 均保持严格为正时，才宣布参数集 $(\\sigma,r,b)$ 表现出鲁棒混沌。否则，宣布其为非鲁棒的。\n\n您的程序必须使用以下固定的数值选择来实现上述过程：\n- 使用 $\\Delta t=0.01$、$T_{\\mathrm{trans}}=15.0$ 和 $T_{\\mathrm{acc}}=60.0$。\n- 对非线性 ODE 和切线性 ODE 均使用显式四阶 Runge–Kutta 格式，在 Runge–Kutta 方法的适当阶段状态下计算雅可比矩阵 $J$。\n- 在累积阶段开始前，将切向量初始化为 $\\delta x(0)=(1,1,1)/\\sqrt{3}$。\n- 计算并返回 $\\lambda_{\\max}$ 及其参数敏感性，结果四舍五入到六位小数。\n\n测试套件：\n评估以下五个参数集及其对应的有限差分增量。每个测试用例是一个元组 $(\\sigma,r,b,h_\\sigma,h_r,h_b)$：\n- 情况 1：$(10,\\,28,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$，\n- 情况 2：$(10,\\,20,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$，\n- 情况 3：$(10,\\,24.5,\\,8/3,\\,0.2,\\,0.2,\\,0.1)$，\n- 情况 4：$(10,\\,99.65,\\,8/3,\\,0.5,\\,0.5,\\,0.2)$，\n- 情况 5：$(10,\\,28,\\,2.0,\\,0.2,\\,0.2,\\,0.1)$。\n\n要求的最终输出格式：\n- 对于每个测试用例，生成一个列表 $[\\lambda_{\\max},\\partial \\lambda_{\\max}/\\partial \\sigma,\\partial \\lambda_{\\max}/\\partial r,\\partial \\lambda_{\\max}/\\partial b,\\mathrm{robust}]$，其中 $\\lambda_{\\max}$ 和所有偏导数都是四舍五入到六位小数的浮点数，而 $\\mathrm{robust}$ 是一个布尔值，指示如上定义的鲁棒混沌。\n- 您的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果；即，一个由对应五个测试用例的五个此类列表组成的列表。例如，输出应如下所示\n$$\n[\\,[\\lambda_1,\\partial_\\sigma \\lambda_1,\\partial_r \\lambda_1,\\partial_b \\lambda_1,\\mathrm{robust}_1],\\dots,[\\lambda_5,\\partial_\\sigma \\lambda_5,\\partial_r \\lambda_5,\\partial_b \\lambda_5,\\mathrm{robust}_5]\\,].\n$$\n本问题中不需要物理单位。角度没有出现，因此没有指定的单位。不使用百分比；所有答案必须按规定以浮点数或布尔值形式给出。", "solution": "该问题是有效的，因为它科学地基于非线性动力学的成熟理论，特别是 Lorenz 系统的分析。该问题是适定的，所有必要的参数、初始条件和数值方法都已明确指定。这些任务在计算上是可行的，构成了计算物理和混沌理论中的一个标准练习。\n\n该解决方案是通过对每个给定的参数集 $(\\sigma, r, b)$ 及其相应的扰动幅度 $(h_\\sigma, h_r, h_b)$ 执行一个多步骤过程来实现的。\n\n首先，我们设计一个核心函数，用于为给定参数集 $(\\sigma, r, b)$ 计算最大李雅普诺夫指数 (LLE) $\\lambda_{\\max}$。该函数封装了 Lorenz 系统及其相关切动力学的数值积分。过程如下：\n\n1.  **瞬态积分**：由常微分方程 (ODEs) 给出的 Lorenz 系统，\n    $$\n    \\frac{dX}{dt}=\\sigma(Y-X),\\quad \\frac{dY}{dt}=X(r-Z)-Y,\\quad \\frac{dZ}{dt}=XY-bZ,\n    $$\n    从初始条件 $x(0) = (X(0), Y(0), Z(0)) = (1, 1, 1)$ 开始，积分时长为 $T_{\\mathrm{trans}} = 15.0$。这使得系统的轨道能够稳定到其吸引子上，从而丢弃任何初始的瞬态行为。积分使用显式四阶 Runge-Kutta (RK4) 方法执行，时间步长为 $\\Delta t = 0.01$。\n\n2.  **LLE 累积**：在瞬态阶段之后，在一个 $T_{\\mathrm{acc}} = 60.0$ 的累积周期内估算 LLE。这涉及同时积分非线性状态向量 $x(t) = (X(t), Y(t), Z(t))$ 和一个无穷小切向量 $\\delta x(t)$。切向量的演化由线性化动力学控制：\n    $$\n    \\frac{d(\\delta x)}{dt} = J(x(t)) \\delta x(t),\n    $$\n    其中 $J(x)$ 是 Lorenz 系统向量场的雅可比矩阵：\n    $$\n    J(x) = \\begin{bmatrix} -\\sigma  \\sigma  0 \\\\ r-Z  -1  -X \\\\ Y  X  -b \\end{bmatrix}.\n    $$\n    在累积阶段开始时，切向量被初始化为一个单位范数向量 $\\delta x = (1, 1, 1) / \\sqrt{3}$。\n\n3.  **耦合 RK4 积分与重新归一化**：对于 $(x, \\delta x)$ 的耦合 ODE 系统，使用 RK4 格式逐步推进。对于从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单步，我们将状态向量和切向量视为一个增广状态向量 $y = (x, \\delta x)$。RK4 方法应用于增广系统 $\\dot{y} = (f(x), J(x)\\delta x)$。在 RK4 积分器的每个阶段，雅可比矩阵 $J$ 都在 $x$ 的相应中间状态下进行评估。在每个完整的时间步长 $\\Delta t$ 之后，演化后的切向量 $\\delta \\tilde{x}_{n+1}$ 会增长或收缩。我们计算其欧几里得范数 $\\|\\delta \\tilde{x}_{n+1}\\|$，并累积该范数的自然对数：$\\sum \\log(\\|\\delta \\tilde{x}_{n+1}\\|)$。然后在下一步之前，将切向量重新归一化为单位向量 $\\delta x_{n+1} = \\delta \\tilde{x}_{n+1} / \\|\\delta \\tilde{x}_{n+1}\\|$。这个 Gram-Schmidt 过程可以防止切向量无限增长或收缩到零，从而在捕捉其指数增长率的同时确保数值稳定性。\n\n4.  **最终 LLE 计算**：经过 $N_{\\mathrm{acc}} = T_{\\mathrm{acc}}/\\Delta t$ 步后，LLE 作为累积的对数增长率的时间平均值来计算：\n    $$\n    \\lambda_{\\max} \\approx \\frac{1}{T_{\\mathrm{acc}}} \\sum_{i=0}^{N_{\\mathrm{acc}}-1} \\log(\\|\\delta \\tilde{x}_{i+1}\\|).\n    $$\n\n其次，利用为任何参数集计算 $\\lambda_{\\max}$ 的能力，我们对每个测试用例进行敏感性和鲁棒性分析。\n对于一个中心参数集 $(\\sigma_0, r_0, b_0)$ 和增量 $(h_\\sigma, h_r, h_b)$：\n\n1.  **敏感性分析**：LLE 对每个参数的偏导数使用二阶中心有限差分格式进行估算。例如，对 $\\sigma$ 的敏感性为：\n    $$\n    \\frac{\\partial \\lambda_{\\max}}{\\partial \\sigma} \\approx \\frac{\\lambda_{\\max}(\\sigma_0+h_\\sigma, r_0, b_0) - \\lambda_{\\max}(\\sigma_0-h_\\sigma, r_0, b_0)}{2h_\\sigma}.\n    $$\n    对 $\\partial \\lambda_{\\max}/\\partial r$ 和 $\\partial \\lambda_{\\max}/\\partial b$ 使用类似的公式。这要求对每个测试用例总共计算七次 $\\lambda_{\\max}$：一次在中心参数下，另外对三个参数中的每一个进行扰动，每个参数计算两次。\n\n2.  **鲁棒性分析**：当且仅当中心参数值下的 LLE 严格为正，并且在所有六个单参数扰动（$\\sigma_0 \\pm h_\\sigma$、$r_0 \\pm h_r$、$b_0 \\pm h_b$）下 LLE 均保持严格为正时，一个参数集才被宣布为表现出“鲁棒混沌”。这需要检查所有七个计算出的 LLE 值是否都大于零。\n\n最后，对每个测试用例，收集计算出的 $\\lambda_{\\max}$ 值、其三个偏导数以及布尔值的鲁棒性标志。浮点数四舍五入到六位小数，并且所有测试用例的结果按照要求格式化为单行的列表之列表。", "answer": "[[0.905593,-0.088665,0.052608,0.000090,True],[-1.000782,0.000000,0.016335,0.000000,False],[0.158308,-0.007629,0.286392,0.000030,False],[-0.046429,0.000216,0.003923,0.123281,False],[1.077271,-0.106263,0.042790,-0.347589,True]]", "id": "3518460"}]}