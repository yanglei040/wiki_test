{"hands_on_practices": [{"introduction": "有限元方法的起点是将控制偏微分方程（PDE）的强形式转化为其等效的积分弱形式。这个实践练习将引导你完成这一关键过程，重点是如何将像罗宾（Robin）边界条件这样的自然边界条件正确地融入到系统的刚度矩阵和载荷向量中。掌握这项技能对于在模型边界上准确地模拟物理相互作用至关重要。[@problem_id:3507555]", "problem": "考虑一个标量场 $u$，它在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 中由二阶偏微分方程 (PDE) $-\\nabla \\cdot \\left(a \\nabla u\\right) = s$ 控制，其中 $a > 0$ 且 $s$ 足够光滑，$\\nabla$ 表示梯度，$\\nabla \\cdot$ 表示散度。边界 $\\partial \\Omega$ 被划分为 Dirichlet 部分 $\\Gamma_{D}$ 和 Robin 部分 $\\Gamma_{R}$。在 $\\Gamma_{R}$ 上，Robin 边界条件 $a \\, \\partial_{n} u + \\alpha \\, u = g$ 成立，其中 $\\partial_{n} u$ 是外法向导数，$\\alpha \\ge 0$ 和 $g$ 是给定的。使用有限元法 (FEM) 的 Galerkin 形式，从基本原理出发，将控制 PDE 乘以一个测试函数 $v$ 并在 $\\Omega$ 上积分，然后应用散度定理并在 $\\Gamma_{R}$ 上施加 Robin 边界条件，以获得 Robin 数据有贡献的弱形式。\n\n现在，将注意力限制在一条由一个边界三角形共享的、属于 $\\Gamma_{R}$ 的单边界边 $e$ 上。该边的长度为 $L_{e}$，并有两个端节点，其相关的 $C^{0}$ 线性形函数为 $N_{i}$ 和 $N_{j}$。假设 $a$、$\\alpha$ 和 $g$ 沿 $e$ 是常数。用弧长坐标 $s \\in [0, L_{e}]$ 参数化该边，并使用线性形函数 $N_{i}(s) = 1 - s/L_{e}$ 和 $N_{j}(s) = s/L_{e}$。推导仅由边 $e$ 上的 Robin 边界条件产生的显式 $2 \\times 2$ 局部边界刚度矩阵贡献 $K_{e}^{(R)}$ 和显式 $2 \\times 1$ 局部边界载荷向量贡献 $f_{e}^{(R)}$，并用 $\\alpha$、$g$ 和 $L_{e}$ 表示最终结果。\n\n你的最终答案必须以闭式解析表达式给出。不需要四舍五入。将刚度矩阵贡献和载荷向量贡献对以单一复合答案的形式表示。", "solution": "该问题是有效的，因为它具有科学依据、是适定的、客观的，并为有限元法中的标准推导提供了一个完整且一致的设定。\n\n我们从域 $\\Omega$ 中的控制二阶偏微分方程 (PDE) 开始：\n$$\n-\\nabla \\cdot \\left(a \\nabla u\\right) = s\n$$\nGalerkin 方法要求推导该方程的弱形式。我们将 PDE 乘以一个合适的测试函数 $v$ 并在域 $\\Omega$ 上积分：\n$$\n-\\int_{\\Omega} v \\left( \\nabla \\cdot (a \\nabla u) \\right) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\n为了降低未知场 $u$ 的导数阶数，我们应用散度定理（或 Green 第一恒等式）。一般的向量恒等式为 $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$。令 $\\phi = v$ 和 $\\mathbf{F} = a \\nabla u$。则 $\\nabla \\cdot (v (a \\nabla u)) = (\\nabla v) \\cdot (a \\nabla u) + v (\\nabla \\cdot (a \\nabla u))$。重新整理得到 $v(\\nabla \\cdot(a \\nabla u)) = \\nabla \\cdot (v(a \\nabla u)) - (\\nabla v) \\cdot (a \\nabla u)$。将此代入积分并应用散度定理 $\\int_{\\Omega} \\nabla \\cdot \\mathbf{G} \\, d\\Omega = \\int_{\\partial \\Omega} \\mathbf{G} \\cdot \\mathbf{n} \\, dS$，我们得到：\n$$\n-\\int_{\\partial\\Omega} v (a \\nabla u) \\cdot \\mathbf{n} \\, dS + \\int_{\\Omega} (\\nabla v) \\cdot (a \\nabla u) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\n认识到 $\\nabla u \\cdot \\mathbf{n}$ 是外法向导数 $\\partial_n u$，方程变为：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\partial\\Omega} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n边界 $\\partial\\Omega$ 被划分为 Dirichlet 部分 $\\Gamma_D$ 和 Robin 部分 $\\Gamma_R$。在 $\\Gamma_D$ 上，$u$ 的值是给定的，我们通常选择在 $\\Gamma_D$ 上为零的测试函数 $v$。因此，在 $\\Gamma_D$ 上的边界积分为零。边界积分简化为在 $\\Gamma_R$ 上的积分：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n现在，我们施加 Robin 边界条件 $a \\, \\partial_n u + \\alpha u = g$，它可以重写为 $a \\, \\partial_n u = g - \\alpha u$。将此代入边界积分项得到：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (g - \\alpha u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n重新整理各项，将包含未知量 $u$ 的项归到左边，将已知源项归到右边，我们得到弱形式：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega + \\int_{\\Gamma_R} \\alpha v u \\, dS = \\int_{\\Omega} v s \\, d\\Omega + \\int_{\\Gamma_R} v g \\, dS\n$$\n在有限元离散化中，场 $u$ 被近似为 $u_h = \\sum_{k} u_k N_k(x)$，其中 $u_k$ 是节点自由度，$N_k(x)$ 是基（形）函数。Galerkin 方法选择测试函数 $v$ 为基函数之一，即 $v = N_i$。对于具有节点 $i$ 和 $j$ 的单一边界边 $e \\subset \\Gamma_R$，近似的限制为 $u_h|_e = u_i N_i + u_j N_j$。问题要求的是*仅*由 Robin 边界条件产生的对单元刚度矩阵和载荷向量的贡献。这些是在 $\\Gamma_R$ 上积分的项。\n\n对刚度矩阵的贡献来自项 $\\int_{\\Gamma_R} \\alpha v u \\, dS$。对于单一边 $e$，这变为：\n$$\nK_{e}^{(R)} = \\int_{e} \\alpha \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\begin{pmatrix} N_i  N_j \\end{pmatrix} \\, dS\n$$\n对载荷向量的贡献来自项 $\\int_{\\Gamma_R} v g \\, dS$。对于单一边 $e$，这变为：\n$$\nf_{e}^{(R)} = \\int_{e} g \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\, dS\n$$\n我们已知 $\\alpha$ 和 $g$ 沿边 $e$ 是常数，该边长度为 $L_e$。边由弧长 $s \\in [0, L_e]$ 参数化，因此 $dS = ds$。线性形函数为 $N_i(s) = 1 - s/L_e$ 和 $N_j(s) = s/L_e$。\n\n我们现在计算 $2 \\times 2$ 局部边界刚度矩阵 $K_{e}^{(R)}$ 的分量：\n$(1,1)$ 分量是：\n$$\n(K_{e}^{(R)})_{ii} = \\int_{0}^{L_e} \\alpha N_i(s) N_i(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ -L_e \\frac{(1 - s/L_e)^3}{3} \\right]_0^{L_e} = \\alpha \\left( 0 - \\left(-\\frac{L_e}{3}\\right) \\right) = \\frac{\\alpha L_e}{3}\n$$\n$(2,2)$ 分量是：\n$$\n(K_{e}^{(R)})_{jj} = \\int_{0}^{L_e} \\alpha N_j(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(\\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ \\frac{s^3}{3L_e^2} \\right]_0^{L_e} = \\alpha \\left( \\frac{L_e^3}{3L_e^2} - 0 \\right) = \\frac{\\alpha L_e}{3}\n$$\n由于对称性，非对角分量 $(1,2)$ 和 $(2,1)$ 相等：\n$$\n(K_{e}^{(R)})_{ij} = (K_{e}^{(R)})_{ji} = \\int_{0}^{L_e} \\alpha N_i(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)\\left(\\frac{s}{L_e}\\right) \\, ds = \\frac{\\alpha}{L_e} \\int_{0}^{L_e} \\left(s - \\frac{s^2}{L_e}\\right) \\, ds\n$$\n$$\n= \\frac{\\alpha}{L_e} \\left[ \\frac{s^2}{2} - \\frac{s^3}{3L_e} \\right]_0^{L_e} = \\frac{\\alpha}{L_e} \\left( \\left(\\frac{L_e^2}{2} - \\frac{L_e^3}{3L_e}\\right) - 0 \\right) = \\frac{\\alpha}{L_e} \\left(\\frac{L_e^2}{2} - \\frac{L_e^2}{3}\\right) = \\frac{\\alpha L_e}{6}\n$$\n组合这些分量，局部边界刚度矩阵的贡献是：\n$$\nK_{e}^{(R)} = \\begin{pmatrix} \\frac{\\alpha L_e}{3} & \\frac{\\alpha L_e}{6} \\\\ \\frac{\\alpha L_e}{6} & \\frac{\\alpha L_e}{3} \\end{pmatrix} = \\frac{\\alpha L_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n接下来，我们计算 $2 \\times 1$ 局部边界载荷向量 $f_{e}^{(R)}$ 的分量：\n第一个分量是：\n$$\n(f_{e}^{(R)})_{i} = \\int_{0}^{L_e} g N_i(s) \\, ds = g \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right) \\, ds = g \\left[ s - \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( (L_e - \\frac{L_e^2}{2L_e}) - 0 \\right) = \\frac{g L_e}{2}\n$$\n第二个分量是：\n$$\n(f_{e}^{(R)})_{j} = \\int_{0}^{L_e} g N_j(s) \\, ds = g \\int_{0}^{L_e} \\frac{s}{L_e} \\, ds = g \\left[ \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( \\frac{L_e^2}{2L_e} - 0 \\right) = \\frac{g L_e}{2}\n$$\n组合这些分量，局部边界载荷向量的贡献是：\n$$\nf_{e}^{(R)} = \\begin{pmatrix} \\frac{g L_e}{2} \\\\ \\frac{g L_e}{2} \\end{pmatrix} = \\frac{g L_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n刚度矩阵贡献和载荷向量贡献对代表了 Robin 边界条件对边 $e$ 的局部系统的完整影响。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha L_{e}}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} & \\frac{g L_{e}}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "3507555"}, {"introduction": "推导出弱形式后，我们必须计算其中包含的积分，而这通常需要通过数值方法完成。本练习探讨了形函数的多项式阶次与高斯求积（Gauss quadrature）所需的积分精度之间的内在联系。对于有限元程序的准确性和计算效率而言，这是一个核心的考量因素。[@problem_id:3507547]", "problem": "考虑在单个四边形单元 $\\Omega_e$ 上的标量泊松方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，其中 $\\Omega_e$ 上的扩散系数 $\\kappa$ 为常数。设该单元是通过一个仿射映射 $\\mathbf{x}(\\xi,\\eta)$ 从参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 获得的，其雅可比矩阵 $\\mathbf{J}$ 为常数，且行列式 $\\det(\\mathbf{J}) \\neq 0$。该单元使用等参双二次拉格朗日形函数，即在 $\\hat{\\Omega}$ 上的 $Q_2$ 形函数，其中 $Q_2$ 表示在每个变量中次数最高为 $2$ 的多项式空间。\n\n单元刚度矩阵的各项为\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega \\,,\n$$\n其中 $N_i$ 和 $N_j$ 是通过仿射映射从 $\\hat{\\Omega}$ 拉回到 $\\Omega_e$ 的 $Q_2$ 形函数。您可以假定仿射映射的标准关系式：$\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$ 和 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$，其中 $\\hat{\\nabla}$ 表示关于 $(\\xi,\\eta)$ 的导数。\n\n确定最小的整数 $n$，使得在 $\\hat{\\Omega}$ 上每个方向有 $n$ 个点的张量积高斯-勒让德求积法则能够精确地积分每个刚度项 $K_{ij}$。您的论证必须仅基于确定 $\\hat{\\Omega}$ 上被积函数的二元多项式次数以及一维高斯-勒让德求积的精确性。将您的最终答案表示为整数 $n$（无单位）。", "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **控制方程**：标量泊松方程为 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，作用于单个四边形单元 $\\Omega_e$。\n- **材料属性**：扩散系数 $\\kappa$ 在 $\\Omega_e$ 上为常数。\n- **单元映射**：单元 $\\Omega_e$ 通过仿射映射 $\\mathbf{x}(\\xi,\\eta)$ 与参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 相关。\n- **雅可比矩阵属性**：映射的雅可比矩阵 $\\mathbf{J}$ 是常数，其行列式 $\\det(\\mathbf{J})$ 非零。\n- **有限元空间**：该单元使用等参双二次拉格朗日形函数，记为 $\\hat{\\Omega}$ 上的 $Q_2$ 形函数。$Q_2$ 空间由在每个变量 $\\xi$ 和 $\\eta$ 中次数最高为 2 的二元多项式组成。\n- **刚度矩阵定义**：单元刚度矩阵的各项由积分 $K_{ij} = \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega$ 给出。\n- **积分变换法则**：物理坐标和参考坐标中梯度之间的关系是 $\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$。微分面积微元变换为 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$。此处，$\\hat{\\nabla}$ 表示关于参考坐标 $(\\xi,\\eta)$ 的梯度算子。\n- **数值积分**：使用每个方向有 $n$ 个点的张量积高斯-勒让德求积法则来计算 $\\hat{\\Omega}$ 上的积分。\n- **目标**：确定保证每个刚度项 $K_{ij}$ 都能被精确积分的最小整数 $n$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题定义明确且科学上合理。它代表了有限元方法（FEM）领域中的一个标准分析。所有概念，包括泊松方程、仿射映射、$Q_2$ 单元和高斯-勒让德求积，都是计算工程和应用数学的基础。该问题是自包含的，提供了推导出答案所需的所有必要信息。“仿射映射”和“恒定雅可比矩阵”的说明是精确的，避免了更一般的等参映射中雅可比矩阵不为常数的复杂性。通过明确声明雅可比矩阵是恒定的，解决了将“等参”与“仿射映射”一起使用的轻微模糊性。因此，该问题是有效的。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整的解决方案。\n\n### 解答\n\n目标是找到在参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 上，能够精确积分刚度矩阵项 $K_{ij}$ 的张量积高斯-勒让德求积法则所需的最小求积点数 $n$。\n\n刚度矩阵项的表达式为\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega\n$$\n为了计算这个积分，我们使用给定的法则将其变换到参考单元 $\\hat{\\Omega}$ 上。令 $\\hat{N}_i(\\xi, \\eta)$ 表示参考单元上的形函数。物理单元上的形函数为 $N_i(\\mathbf{x}) = \\hat{N}_i(\\xi(\\mathbf{x}), \\eta(\\mathbf{x}))$。梯度变换为 $\\nabla N_i = \\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i$，面积微元变换为 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$。\n\n将这些代入 $K_{ij}$ 的积分中：\n$$\nK_{ij} \\;=\\; \\int_{\\hat{\\Omega}} \\kappa \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) \\, |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}\n$$\n参考单元上的被积函数为 $I(\\xi, \\eta) = \\kappa |\\det(\\mathbf{J})| \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$。\n\n根据问题陈述，$\\kappa$ 是一个常数。映射是仿射的，这意味着雅可比矩阵 $\\mathbf{J}$ 是常数。因此，其逆转置矩阵 $\\mathbf{J}^{-T}$ 和其行列式 $\\det(\\mathbf{J})$ 也都是常数。因此，项 $\\kappa |\\det(\\mathbf{J})|$ 是一个常标量。\n\n因此，分析简化为确定点积项 $(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$ 的多项式次数。这可以表示为二次型：\n$$\n(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) = (\\hat{\\nabla} \\hat{N}_i)^T (\\mathbf{J}^{-1} \\mathbf{J}^{-T}) (\\hat{\\nabla} \\hat{N}_j)\n$$\n令常数矩阵 $\\mathbf{C} = \\mathbf{J}^{-1} \\mathbf{J}^{-T}$ 的分量表示为 $\\begin{pmatrix} C_{11} & C_{12} \\\\ C_{21} & C_{22} \\end{pmatrix}$。表达式变为：\n$$\nC_{11} \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} + C_{12} \\left( \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta} + \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} \\right) + C_{22} \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}\n$$\n$Q_2$ 单元的形函数 $\\hat{N}_k(\\xi, \\eta)$ 是在 $\\xi$ 方向上次数最高为 2，在 $\\eta$ 方向上次数最高为 2 的多项式。令 $P_d(t)$ 表示变量 $t$ 中次数最高为 $d$ 的多项式空间。则 $\\hat{N}_k \\in P_2(\\xi) \\otimes P_2(\\eta)$。\n\n形函数的导数是：\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\xi}$：$\\xi$ 的次数减少 1，而 $\\eta$ 的次数不变。因此，$\\frac{\\partial \\hat{N}_k}{\\partial \\xi} \\in P_1(\\xi) \\otimes P_2(\\eta)$。\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\eta}$：$\\eta$ 的次数减少 1，而 $\\xi$ 的次数不变。因此，$\\frac{\\partial \\hat{N}_k}{\\partial \\eta} \\in P_2(\\xi) \\otimes P_1(\\eta)$。\n\n现在，我们确定被积函数中每个乘积项的多项式次数：\n1.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$：\n    $\\xi$ 的最高次数为 $1 + 1 = 2$。\n    $\\eta$ 的最高次数为 $2 + 2 = 4$。\n    此项属于空间 $P_2(\\xi) \\otimes P_4(\\eta)$。\n\n2.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$：\n    $\\xi$ 的最高次数为 $2 + 2 = 4$。\n    $\\eta$ 的最高次数为 $1 + 1 = 2$。\n    此项属于空间 $P_4(\\xi) \\otimes P_2(\\eta)$。\n\n3.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$ 和 $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$：\n    $\\xi$ 的最高次数为 $1 + 2 = 3$。\n    $\\eta$ 的最高次数为 $2 + 1 = 3$。\n    这些项属于空间 $P_3(\\xi) \\otimes P_3(\\eta)$。\n\n总的被积函数 $I(\\xi, \\eta)$ 是这些多项式项的线性组合。$I(\\xi, \\eta)$ 在每个变量中的最高次数是各个项次数的最大值。\n- $\\xi$ 中的最高次数：$\\max(2, 4, 3) = 4$。\n- $\\eta$ 中的最高次数：$\\max(4, 2, 3) = 4$。\n\n因此，被积函数 $I(\\xi, \\eta)$ 是一个二元多项式，其在 $\\xi$ 方向上的最高次数为 4，在 $\\eta$ 方向上的最高次数也为 4。\n\n为了使用张量积高斯-勒让德求积法则精确地积分这个多项式，我们考虑一维积分。一个 $n$ 点一维高斯-勒让德求积法则可以精确地积分最高次数为 $2n-1$ 的任何多项式。\n\n对于关于 $\\xi$ 的积分，我们必须能够精确地积分最高次数为 $p=4$ 的多项式。这要求求积点数 $n$ 满足：\n$$\n2n - 1 \\ge 4\n$$\n$$\n2n \\ge 5\n$$\n$$\nn \\ge 2.5\n$$\n因为 $n$ 必须是整数，所以可接受的最小值为 $n=3$。\n\n同样，对于关于 $\\eta$ 的积分，被积函数是一个最高次数为 4 的多项式。同样的条件适用：\n$$\n2n - 1 \\ge 4 \\implies n \\ge 2.5\n$$\n$n$ 的最小整数值同样是 3。\n\n由于问题描述的是一个在每个方向上有 $n$ 个点的张量积法则，所以相同的值 $n$ 适用于 $\\xi$ 和 $\\eta$ 两个方向。因此，保证所有刚度矩阵项都能被精确积分的最小整数 $n$ 是 3。这对应于参考单元上的一个 $3 \\times 3$ 求积网格。", "answer": "$$\\boxed{3}$$", "id": "3507547"}, {"introduction": "对于包含内部节点的更复杂单元（例如高阶单元），我们通常可以在全局组装之前简化问题。本练习介绍静态凝聚（static condensation），这是一种强大的技术，通过在单元层面消除内部自由度，可以减小最终求解的线性系统规模。这个例子展示了单元级别的代数操作如何能够带来显著的计算效率提升。[@problem_id:3507536]", "problem": "考虑一个代表热弹性或电热多物理场耦合的二维稳态扩散子问题，该问题定义在一个等参九节点双二次四边形单元 ($Q_2$) 上，其参考域为方形区域 $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$。控制偏微分方程 (PDE) 为 $-\\nabla\\cdot(k\\nabla u)=0$，其中 $k>0$ 为常数各向同性传导率，且从参考单元到物理单元的映射为单位映射。使用标准的伽辽金有限元法 (FEM)，单元刚度项定义为\n$$\nK_{ab} \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta,\n$$\n其中 $N_a$ 和 $N_b$ 是九节点双二次拉格朗日形函数。将单元中心的唯一内部节点记为 $i$，其形函数为 $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$，并将八个边界自由度（角节点和中边节点）归入一个块 $b$。单元系统可以分块为如下形式\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\\nu_i\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\nf_b \\\\\nf_i\n\\end{pmatrix},\n$$\n其中 $K_{ii}\\in\\mathbb{R}$，$K_{bi}\\in\\mathbb{R}^{8\\times 1}$，$K_{ib}\\in\\mathbb{R}^{1\\times 8}$，以及 $K_{bb}\\in\\mathbb{R}^{8\\times 8}$。从弱形式和双二次形函数的定义出发，在不引用任何关于静力凝聚的既有结论的情况下，推导如何通过精确消除内部自由度 $u_i$ 来得到作用于边界块 $u_b$ 上的凝聚算子。具体来说：\n\n- 使用 $N_i(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$ 和单位映射，从第一性原理精确计算 $K_{ii}$。\n- 对 $u_i$ 进行代数消元，以获得仅用块 $K_{bb}$、$K_{bi}$、$K_{ib}$ 和传导率 $k$ 表示的凝聚边界算子。\n\n请将您的最终答案表示为凝聚边界算子的单一闭式解析表达式，不带单位且不进行四舍五入。", "solution": "该问题陈述是有效的，因为它科学地基于应用于标准稳态扩散问题的有限元法 (FEM) 原理，是适定的且为唯一推导提供了足够的信息，并以客观、明确的语言表述。\n\n任务是通过消除内部自由度来推导九节点双二次四边形单元的凝聚边界算子。这个过程包括两个主要步骤：首先，计算与内部节点对应的刚度矩阵项 $K_{ii}$；其次，进行代数消元。\n\n单元刚度矩阵项由以下公式给出：\n$$\nK_{ab} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n问题指明，从参考域 $(\\xi, \\eta)$ 到物理域 $(x, y)$ 的映射是单位映射。这意味着变换的雅可比矩阵是单位矩阵，因此物理坐标系中的梯度算子与参考坐标系中的梯度算子相同，即 $\\nabla = \\left( \\frac{\\partial}{\\partial\\xi}, \\frac{\\partial}{\\partial\\eta} \\right)$。\n\n首先，我们计算与内部节点对应的对角项 $K_{ii}$，其形函数为 $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$。\n$K_{ii}$ 的公式为：\n$$\nK_{ii} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_i(\\xi,\\eta)\\cdot \\nabla N_i(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n我们首先计算 $N_i$ 的梯度：\n$$\n\\nabla N_i(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial\\xi} \\\\ \\frac{\\partial N_i}{\\partial\\eta} \\end{pmatrix} = \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\n接下来，我们计算点积 $\\nabla N_i \\cdot \\nabla N_i$：\n$$\n\\nabla N_i \\cdot \\nabla N_i = (-2\\xi(1-\\eta^2))^2 + (-2\\eta(1-\\xi^2))^2 = 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2\n$$\n现在，我们将此表达式代入 $K_{ii}$ 的积分中：\n$$\nK_{ii} = k \\int_{-1}^{1}\\int_{-1}^{1} \\left( 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2 \\right) \\,d\\xi\\,d\\eta\n$$\n我们可以将积分分成两部分：\n$$\nK_{ii} = 4k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta + 4k \\int_{-1}^{1}\\int_{-1}^{1} \\eta^2(1-\\xi^2)^2 \\,d\\xi\\,d\\eta\n$$\n由于被积函数和积分域的对称性，这两个积分相等。我们可以写成：\n$$\nK_{ii} = 8k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta\n$$\n该积分对于 $\\xi$ 和 $\\eta$ 是可分离的：\n$$\nK_{ii} = 8k \\left( \\int_{-1}^{1} \\xi^2 \\,d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta \\right)\n$$\n我们分别计算每个一维积分：\n第一个积分是：\n$$\n\\int_{-1}^{1} \\xi^2 \\,d\\xi = \\left[ \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\frac{1^3}{3} - \\frac{(-1)^3}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\n第二个积分是：\n$$\n\\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta = \\int_{-1}^{1} (1 - 2\\eta^2 + \\eta^4) \\,d\\eta = \\left[ \\eta - \\frac{2\\eta^3}{3} + \\frac{\\eta^5}{5} \\right]_{-1}^{1}\n$$\n$$\n= \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 - \\frac{2(-1)^3}{3} + \\frac{(-1)^5}{5} \\right) = \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 + \\frac{2}{3} - \\frac{1}{5} \\right)\n$$\n$$\n= 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15 - 10 + 3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\n将这些结果代回 $K_{ii}$ 的表达式中：\n$$\nK_{ii} = 8k \\left( \\frac{2}{3} \\right) \\left( \\frac{16}{15} \\right) = \\frac{256k}{45}\n$$\n这就完成了任务的第一部分。\n\n第二，我们对内部自由度 $u_i$ 进行代数消元。分块线性方程组如下所示：\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\ u_i\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_b \\\\ f_i\n\\end{pmatrix}\n$$\n该分块矩阵方程对应于两个方程：\n1. $K_{bb} u_b + K_{bi} u_i = f_b$\n2. $K_{ib} u_b + K_{ii} u_i = f_i$\n\n从第二个方程中，我们求解内部自由度 $u_i$：\n$$\nK_{ii} u_i = f_i - K_{ib} u_b\n$$\n由于 $K_{ii}$ 是一个非零标量（$K_{ii} = \\frac{256k}{45}$ 且 $k>0$），其逆 $K_{ii}^{-1} = \\frac{1}{K_{ii}}$ 存在。\n$$\nu_i = K_{ii}^{-1} (f_i - K_{ib} u_b)\n$$\n现在，我们将 $u_i$ 的这个表达式代入第一个方程中：\n$$\nK_{bb} u_b + K_{bi} \\left( K_{ii}^{-1} (f_i - K_{ib} u_b) \\right) = f_b\n$$\n展开各项：\n$$\nK_{bb} u_b + K_{bi} K_{ii}^{-1} f_i - K_{bi} K_{ii}^{-1} K_{ib} u_b = f_b\n$$\n为了获得关于边界自由度 $u_b$ 的凝聚系统，我们将所有含 $u_b$ 的项归到左侧：\n$$\n(K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}) u_b = f_b - K_{bi} K_{ii}^{-1} f_i\n$$\n前乘边界自由度向量 $u_b$ 的矩阵就是凝聚边界算子，通常记为块 $K_{ii}$ 的舒尔补。该算子为：\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}\n$$\n最后，我们代入先前计算出的 $K_{ii}$ 的值：\n$$\nK_{ii}^{-1} = \\left(\\frac{256k}{45}\\right)^{-1} = \\frac{45}{256k}\n$$\n得到的凝聚边界算子是：\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} \\left( \\frac{45}{256k} \\right) K_{ib} = K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}\n$$\n这就是用刚度矩阵块和传导率 $k$ 表示的凝聚算子的最终表达式。", "answer": "$$\n\\boxed{K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}}\n$$", "id": "3507536"}]}