{"hands_on_practices": [{"introduction": "第一个练习旨在为伽辽金有限元方法的核心机制打下坚实的基础。通过解决一个经典的一维扩散-反应问题，您将学习如何将一个偏微分方程转化为其弱形式，并最终构建一个离散的线性系统。该练习专注于推导单元刚度矩阵和质量矩阵，并将它们组装成全局系统矩阵，这是几乎所有有限元分析代码的核心技能 [@problem_id:3528432]。", "problem": "考虑区间 $(0,1)$ 上的标量扩散-反应偏微分方程 (PDE)，\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f,$$\n其中 $k>0$ 和 $c\\ge 0$ 是空间常系数。使用伽辽金法和有限元法 (FEM)，在 $(0,1)$ 的网格上采用连续分片线性形函数（$P_1$ 单元）。\n\n从通过加权残差法原理和分部积分得到的弱形式出发，推导长度为 $h_e$ 的任意单元上的单元级双线性形式，并计算算子 $-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u$ 在 $k$ 和 $c$ 为常数时的单元刚度矩阵和单元反应-质量矩阵。然后，考虑将 $(0,1)$ 均匀划分为三个等长单元，节点为 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$、$x_3=1$，并施加齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n为对应于节点 $x_1$ 和 $x_2$ 的两个内部自由度组装全局伽辽金系统矩阵，最终组装的矩阵完全用 $k$ 和 $c$ 表示。将最终组装的全局矩阵作为你的答案。无需四舍五入。最终表达式中不包含任何物理单位。", "solution": "该问题被认定是有效的。这是一个适定（well-posed）的数学物理边值问题，适合使用指定的有限元法求解。唯一推导所需的所有条件和数据均已提供。\n\n控制偏微分方程 (PDE) 是在域 $\\Omega = (0,1)$ 上的稳态扩散-反应方程：\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f(x)$$\n其中系数 $k$ 和 $c$ 是正常数。\n\n伽辽金法的第一步是推导弱形式。我们将 PDE 乘以一个来自合适函数空间的检验函数 $v(x)$，并在域 $\\Omega$ 上积分：\n$$\\int_{0}^{1} \\left(-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u\\right)v \\,dx = \\int_{0}^{1} f v \\,dx$$\n对二阶项应用分部积分得到：\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx}\\right) dx - \\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1} + \\int_{0}^{1} (c\\,u\\,v) \\,dx = \\int_{0}^{1} f v \\,dx$$\n检验函数 $v$ 选自试探解空间，该空间必须满足齐次形式的狄利克雷边界条件。问题指定了 $u(0)=0$ 和 $u(1)=0$。因此，我们要求 $v(0)=0$ 和 $v(1)=0$。这使得边界项 $\\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1}$ 为零。\n\n由此产生的弱形式为：求 $u$，使得对于所有有效的检验函数 $v$，\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx} + c\\,u\\,v\\right) dx = \\int_{0}^{1} f v \\,dx$$\n这可以写成抽象形式 $a(u,v) = L(v)$，其中双线性形式 $a(u,v)$ 代表左侧，线性泛函 $L(v)$ 代表右侧。\n\n接下来，我们对域和解进行离散化。解 $u(x)$ 由一个函数 $u_h(x)$ 来近似，该函数是分片线性基函数（形函数）$N_j(x)$ 的线性组合：\n$$u(x) \\approx u_h(x) = \\sum_{j} U_j N_j(x)$$\n这里，$U_j$ 是近似解的节点值。在伽辽金法中，检验函数 $v$ 从同一组基函数中选取，即对于每个节点 $i$，$v(x) = N_i(x)$。将这些代入弱形式，得到伽辽金线性方程组 $A \\mathbf{U} = \\mathbf{F}$，其中系统矩阵 $A$ 的各项由下式给出：\n$$A_{ij} = a(N_j, N_i) = \\int_{0}^{1} \\left(k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\right) dx + \\int_{0}^{1} \\left(c\\,N_j N_i\\right) dx$$\n矩阵 $A$ 可以表示为刚度矩阵 $K$ 和反应-质量矩阵 $C$ 的和：\n$$A_{ij} = K_{ij} + C_{ij}$$\n其中 $K_{ij} = \\int_{0}^{1} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx} dx$ 且 $C_{ij} = \\int_{0}^{1} c\\,N_j N_i dx$。\n\n我们现在在一个长度为 $h_e = x_b - x_a$ 的通用单元 $\\Omega_e = [x_a, x_b]$ 上推导单元级矩阵。我们使用一个局部坐标系 $\\xi \\in [0, 1]$，其中 $x(\\xi) = x_a + \\xi h_e$。微分的链式法则给出 $\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{h_e}\\frac{d}{d\\xi}$。局部坐标系中的分片线性形函数为 $N_1(\\xi) = 1-\\xi$ 和 $N_2(\\xi) = \\xi$。它们的导数是 $\\frac{dN_1}{d\\xi} = -1$ 和 $\\frac{dN_2}{d\\xi} = 1$。\n\n单元刚度矩阵 $K^e$ 的分量为：\n$$K^e_{ij} = \\int_{\\Omega_e} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\,dx = k \\int_{0}^{1} \\left(\\frac{1}{h_e}\\frac{dN_j}{d\\xi}\\right)\\left(\\frac{1}{h_e}\\frac{dN_i}{d\\xi}\\right) h_e\\,d\\xi = \\frac{k}{h_e} \\int_{0}^{1} \\frac{dN_j}{d\\xi}\\frac{dN_i}{d\\xi}\\,d\\xi$$\n计算四个分量：\n$K^e_{11} = \\frac{k}{h_e}\\int_0^1 (-1)(-1) d\\xi = \\frac{k}{h_e}$\n$K^e_{12} = \\frac{k}{h_e}\\int_0^1 (1)(-1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{21} = \\frac{k}{h_e}\\int_0^1 (-1)(1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{22} = \\frac{k}{h_e}\\int_0^1 (1)(1) d\\xi = \\frac{k}{h_e}$\n因此，单元刚度矩阵为：\n$$K^e = \\frac{k}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n\n单元反应-质量矩阵 $C^e$ 的分量为：\n$$C^e_{ij} = \\int_{\\Omega_e} c\\,N_j N_i\\,dx = c\\int_{0}^{1} N_j(\\xi)N_i(\\xi) h_e\\,d\\xi = c h_e \\int_{0}^{1} N_j(\\xi)N_i(\\xi) \\,d\\xi$$\n计算四个分量：\n$C^e_{11} = c h_e \\int_0^1 (1-\\xi)^2 d\\xi = c h_e \\left[-\\frac{(1-\\xi)^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\n$C^e_{12} = c h_e \\int_0^1 (1-\\xi)\\xi d\\xi = c h_e \\left[\\frac{\\xi^2}{2}-\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{6}$\n$C^e_{21} = C^e_{12} = \\frac{c h_e}{6}$\n$C^e_{22} = c h_e \\int_0^1 \\xi^2 d\\xi = c h_e \\left[\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\n因此，单元反应-质量矩阵为：\n$$C^e = \\frac{c h_e}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n\n总的单元系统矩阵是 $A^e = K^e + C^e$。\n\n对于具体问题，域 $(0,1)$ 被划分为三个等长单元。节点位于 $x_0=0$、$x_1=1/3$、$x_2=2/3$ 和 $x_3=1$。每个单元的长度是 $h_e = 1/3$。\n将 $h_e=1/3$ 代入单元矩阵表达式：\n$K^e = \\frac{k}{1/3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 3k \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n$C^e = \\frac{c(1/3)}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{c}{18} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$\n单元系统矩阵 $A^e$ 是：\n$$A^e = \\begin{pmatrix} 3k + \\frac{2c}{18}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  3k + \\frac{2c}{18} \\end{pmatrix} = \\begin{pmatrix} 3k + \\frac{c}{9}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  3k + \\frac{c}{9} \\end{pmatrix}$$\n\n全局系统矩阵通过将三个单元的贡献相加来组装。自由度为 $U_0, U_1, U_2, U_3$。\n单元 $1$（节点 $0, 1$）将 $A^e$ 贡献给行/列 $0, 1$ 的子矩阵。\n单元 $2$（节点 $1, 2$）将 $A^e$ 贡献给行/列 $1, 2$ 的子矩阵。\n单元 $3$（节点 $2, 3$）将 $A^e$ 贡献给行/列 $2, 3$ 的子矩阵。\n\n施加边界条件前的全局矩阵 $A_{global}$ 是一个 $4 \\times 4$ 矩阵：\n$$A_{global} = \\begin{pmatrix} A^e_{11}  A^e_{12}  0  0 \\\\ A^e_{21}  A^e_{22}+A^e_{11}  A^e_{12}  0 \\\\ 0  A^e_{21}  A^e_{22}+A^e_{11}  A^e_{12} \\\\ 0  0  A^e_{21}  A^e_{22} \\end{pmatrix}$$\n代入数值：\n$A^e_{11} = A^e_{22} = 3k + \\frac{c}{9}$\n$A^e_{12} = A^e_{21} = -3k + \\frac{c}{18}$\n$A^e_{22} + A^e_{11} = 2(3k + \\frac{c}{9}) = 6k + \\frac{2c}{9}$\n\n问题施加了齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。这固定了节点值 $U_0=0$ 和 $U_3=0$。我们关心的是未知内部自由度 $U_1$ 和 $U_2$ 的系统。该系统通过取 $A_{global}$ 中对应于行 $1$ 和 $2$ 以及列 $1$ 和 $2$ 的 $2 \\times 2$ 子矩阵得到：\n$$A_{interior} = \\begin{pmatrix} A^e_{22}+A^e_{11}  A^e_{12} \\\\ A^e_{21}  A^e_{22}+A^e_{11} \\end{pmatrix}$$\n代入矩阵项的表达式：\n$$A_{interior} = \\begin{pmatrix} 6k + \\frac{2c}{9}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  6k + \\frac{2c}{9} \\end{pmatrix}$$\n这就是两个内部自由度的最终组装的全局伽辽金系统矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6k + \\frac{2c}{9}  -3k + \\frac{c}{18} \\\\\n-3k + \\frac{c}{18}  6k + \\frac{2c}{9}\n\\end{pmatrix}\n}\n$$", "id": "3528432"}, {"introduction": "在掌握了矩阵组装的基础上，下一个练习将伽辽金方法应用于另一类同样重要的问题：特征值问题。从结构振动到波的传播，许多物理现象在数学上被描述为特征值问题。本练习将指导您离散化亥姆霍兹方程，从而得到一个广义矩阵特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$，并引入通过将计算得到的离散解与已知的精确解进行比较来进行数值验证的关键实践 [@problem_id:3528326]。", "problem": "在多物理场耦合仿真中，模态分析和算子分裂通常需要求解由耦合算子产生的标量椭圆特征问题。考虑从单位区间上的拉普拉斯算子得到的典型一维亥姆霍兹型特征问题：求非平凡的 $u$ 和 $\\lambda$，使得在 $(0,1)$ 上满足 $-u'' = \\lambda u$，并带有齐次狄利克雷边界条件 $u(0)=u(1)=0$。从通过分部积分推导并在 Sobolev 空间 $H_0^1(0,1)$ 中施加边界条件的弱形式出发，使用有限元法（FEM）和分段线性多项式空间（$P_1$）在 $(0,1)$ 上一个包含 $3$ 个单元的均匀网格上进行 Bubnov–Galerkin 离散化。组装一致刚度矩阵 $K$ 和质量矩阵 $M$，构建所得的广义矩阵特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$，并计算其最小特征值 $\\lambda_h$。连续问题的精确第一特征值为 $\\lambda_1=\\pi^2$。报告无量纲比较比率 $r=\\lambda_h/\\lambda_1$，并四舍五入到 $4$ 位有效数字。以纯数字形式表示您的答案（无单位）。", "solution": "用户提供了一个在尝试求解前需要验证的问题。\n\n### 步骤 1：提取已知条件\n- **微分方程**：$-u'' = \\lambda u$\n- **定义域**：$(0,1)$\n- **边界条件**：$u(0)=0$，$u(1)=0$（齐次狄利克雷）\n- **函数空间**：Sobolev 空间 $H_0^1(0,1)$\n- **离散化方法**：Bubnov-Galerkin 有限元法 (FEM)\n- **单元类型**：分段线性多项式（$P_1$）\n- **网格**：在 $(0,1)$ 上的含 $3$ 个单元的均匀网格\n- **要求输出**：\n    1. 一致刚度矩阵 $K$ 和质量矩阵 $M$。\n    2. 广义矩阵特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$ 的构建。\n    3. 矩阵问题的最小特征值 $\\lambda_h$。\n- **比较**：无量纲比率 $r=\\lambda_h/\\lambda_1$，其中 $\\lambda_1=\\pi^2$ 是连续问题的精确第一特征值。结果必须四舍五入到 $4$ 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学依据**：该问题是将有限元法应用于 Sturm-Liouville 特征值问题（一维亥姆霍兹方程）的典型示例。这是数值分析和计算物理学中的一个基本课题。该问题在科学上和数学上都是合理的。\n- **良态的**：该问题是良态的。连续问题具有已知、唯一且稳定的特征值和特征函数解集。离散化后的问题也是良态的，导出一个对称定广义矩阵特征值问题，其特征值为实数且为正。\n- **客观性**：语言精确、技术性强，没有任何主观性或歧义。\n- **完整性**：提供了所有必要信息。偏微分方程（PDE）、定义域、边界条件、离散化方法、单元类型和网格规格都已明确说明。\n- **其他标准**：该问题不是无关紧要、自相矛盾或无法验证的。它是应用数学中一个标准的可解问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供解答。\n\n### 解答推导\n问题是求解在区间 $(0,1)$ 上满足边界条件 $u(0)=u(1)=0$ 的特征问题 $-u'' = \\lambda u$ 的非平凡解 $(u, \\lambda)$。\n\n首先，我们推导弱形式。我们将微分方程乘以一个来自解空间 $H_0^1(0,1)$（该空间包含了边界条件 $v(0)=v(1)=0$）的检验函数 $v$，并在定义域 $\\Omega=(0,1)$ 上积分：\n$$-\\int_0^1 u''(x) v(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\n我们对左侧应用分部积分：\n$$-\\left[ u'(x)v(x) \\right]_0^1 + \\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\n由于检验函数 $v \\in H_0^1(0,1)$，我们有 $v(0)=0$ 和 $v(1)=0$。因此，边界项 $[u'v]_0^1$ 为零。问题的弱形式是：求 $u \\in H_0^1(0,1)$ 和 $\\lambda \\in \\mathbb{R}$ 使得\n$$\\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx \\quad \\forall v \\in H_0^1(0,1)$$\n这可以用双线性形式 $a(u,v) = \\int_0^1 u'(x) v'(x) \\, dx$ 和 $b(u,v) = \\int_0^1 u(x) v(x) \\, dx$ 写成 $a(u,v)=\\lambda b(u,v)$。\n\n接下来，我们进行 Bubnov-Galerkin 离散化。定义域 $(0,1)$ 被划分为 $3$ 个均匀单元，因此单元尺寸为 $h=1/3$。节点位于 $x_0=0$、$x_1=1/3$、$x_2=2/3$ 和 $x_3=1$。解空间由分段线性（$P_1$）多项式的有限维空间 $V_h \\subset H_0^1(0,1)$ 近似。由于齐次狄利克雷边界条件，边界节点 $x_0$ 和 $x_3$ 处的自由度为零。我们只有两个活动的内部节点，$x_1$ 和 $x_2$。\n\n$V_h$ 的基由两个分别与内部节点 $x_1$ 和 $x_2$ 相关联的线性“帽”函数 $\\phi_1(x)$ 和 $\\phi_2(x)$ 组成。近似解 $u_h(x)$ 是这些基函数的线性组合：\n$$u_h(x) = U_1 \\phi_1(x) + U_2 \\phi_2(x) = \\sum_{j=1}^{2} U_j \\phi_j(x)$$\n其中 $U_1$ 和 $U_2$ 是解在 $x_1$ 和 $x_2$ 处的未知节点值。\n\n在 Bubnov-Galerkin 方法中，检验函数从与试探函数相同的空间中选取，即对于 $i=1,2$，$v_h(x) = \\phi_i(x)$。将 $u_h$ 和 $v_h$ 代入弱形式，得到一个代数方程组：\n$$\\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx \\right) = \\lambda_h \\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx \\right) \\quad \\text{for } i=1,2$$\n这就是广义矩阵特征值问题 $K\\mathbf{u} = \\lambda_h M\\mathbf{u}$，其中 $\\mathbf{u} = [U_1, U_2]^T$，刚度矩阵 $K$ 和质量矩阵 $M$ 的元素为：\n$$K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx$$\n$$M_{ij} = b(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx$$\n\n我们组装这些矩阵。对于长度为 $h$ 的标准线性单元，单元刚度矩阵 $k^e$ 和单元质量矩阵 $m^e$ 分别为：\n$$k^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad m^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n在我们的例子中，$h=1/3$，所以：\n$$k^e = \\frac{1}{1/3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 3 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n$$m^e = \\frac{1/3}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n我们为两个内部自由度（对应于节点 $x_1$ 和 $x_2$）组装全局矩阵。\n刚度矩阵 $K$ 是由所有三个单元的贡献组装而成的：\n$$K = 3 \\begin{pmatrix} 1+1  -1 \\\\ -1  1+1 \\end{pmatrix} = 3 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$$\n质量矩阵 $M$ 也以类似方式组装：\n$$M = \\frac{1}{18} \\begin{pmatrix} 2+2  1 \\\\ 1  2+2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix}$$\n所得的广义矩阵特征值问题是：\n$$\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\lambda_h \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix}$$\n为求特征值 $\\lambda_h$，我们求解特征方程 $\\det(K - \\lambda_h M) = 0$。\n$$\\det\\left( \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} - \\frac{\\lambda_h}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\right) = 0$$\n$$\\det\\begin{pmatrix} 6 - \\frac{4\\lambda_h}{18}  -3 - \\frac{\\lambda_h}{18} \\\\ -3 - \\frac{\\lambda_h}{18}  6 - \\frac{4\\lambda_h}{18} \\end{pmatrix} = 0$$\n这给出了方程：\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right)^2 - \\left(-3 - \\frac{\\lambda_h}{18}\\right)^2 = 0$$\n这是一个平方差公式 $A^2 - B^2 = (A-B)(A+B) = 0$。\n情况 1：$A-B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) - \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$9 - \\frac{3\\lambda_h}{18} = 0 \\implies 9 - \\frac{\\lambda_h}{6} = 0 \\implies \\lambda_h = 54$$\n情况 2：$A+B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) + \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$3 - \\frac{5\\lambda_h}{18} = 0 \\implies 3 = \\frac{5\\lambda_h}{18} \\implies \\lambda_h = \\frac{3 \\times 18}{5} = \\frac{54}{5} = 10.8$$\n两个特征值为 $\\lambda_{h,1}=10.8$ 和 $\\lambda_{h,2}=54$。最小的特征值是 $\\lambda_h = 10.8$。\n\n最后，我们计算所需的无量纲比较比率 $r = \\lambda_h / \\lambda_1$。连续问题的精确第一特征值为 $\\lambda_1 = \\pi^2$。\n$$r = \\frac{10.8}{\\pi^2}$$\n使用 $\\pi^2 \\approx 9.8696044...$ 的值，我们得到：\n$$r \\approx \\frac{10.8}{9.8696044} \\approx 1.0942699$$\n四舍五入到 $4$ 位有效数字，我们得到 $r=1.094$。", "answer": "$$\\boxed{1.094}$$", "id": "3528326"}, {"introduction": "这项高级练习将我们的视野扩展到多物理场仿真中更复杂的场景：瞬态行为和二维域。您将探索在三角形单元上对瞬态扩散方程进行半离散化的过程。一个关键焦点是“质量集中”（mass lumping）这一实用技术，它是一种为了简化计算而引入的近似——即所谓的“变分犯罪”（variational crime），您将通过解析推导其引入的误差，来深刻理解计算效率与数值精度之间的权衡 [@problem_id:3528390]。", "problem": "考虑一个标量场 $u(x,y,t)$ 在单个二维线性三角形有限元上的瞬态扩散，该单元的顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。控制方程为扩散方程 $u_t = \\alpha \\Delta u$，其中扩散系数 $\\alpha > 0$ 在空间上为常数，并且在三角形的边界上施加齐次诺伊曼边界条件。初始条件为 $u(x,y,0) = x$。\n\n设试探空间和检验空间为同一线性有限元空间，由分别对应于顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的节点基（形函数）$\\{N_1,N_2,N_3\\}$ 张成。将节点向量记为 $\\mathbf{u}(t) = (u_1(t),u_2(t),u_3(t))^{\\mathsf{T}}$，其中 $u_i(t)$ 是 $u(x,y,t)$ 的有限元近似解的节点值。弱形式的Galerkin半离散化得到如下的常微分方程：\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) + \\alpha\\,\\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\n其中 $\\mathbf{M}$ 是（一致）单元质量矩阵，$\\mathbf{K}$ 是单元刚度矩阵。\n\n任务：\n1. 从Galerkin弱形式和给定三角形上的线性形函数出发，推导该三角形的一致单元质量矩阵 $\\mathbf{M}$ 和单元刚度矩阵 $\\mathbf{K}$ 的元素。\n2. 使用对常数场精确的节点求积法，推导线性三角形单元的对角集中质量矩阵 $\\mathbf{M}_{\\ell}$。明确写出节点权重以及给定三角形上 $\\mathbf{M}_{\\ell}$ 的最终对角元素。\n3. 对于初始条件 $u(x,y,0) = x$，构造初始节点向量 $\\mathbf{u}(0)$ 并写出以下两个半离散解：\n$$\n\\mathbf{u}_{\\mathrm{c}}(t) \\text{ 求解 } \\mathbf{M}\\,\\dot{\\mathbf{u}}_{\\mathrm{c}} + \\alpha\\,\\mathbf{K}\\,\\mathbf{u}_{\\mathrm{c}} = \\mathbf{0}, \n\\qquad\n\\mathbf{u}_{\\ell}(t) \\text{ 求解 } \\mathbf{M}_{\\ell}\\,\\dot{\\mathbf{u}}_{\\ell} + \\alpha\\,\\mathbf{K}\\,\\mathbf{u}_{\\ell} = \\mathbf{0}.\n$$\n通过模态分解，以闭式解形式表示 $\\mathbf{u}_{\\mathrm{c}}(t)$ 和 $\\mathbf{u}_{\\ell}(t)$。\n4. 定义误差场 $e(x,y,t)$ 为两个有限元解之间的差值，即 $e(x,y,t) = \\sum_{i=1}^{3} N_i(x,y)\\,\\big(u_{\\mathrm{c},i}(t) - u_{\\ell,i}(t)\\big)$。推导误差的 $L^2$ 范数的精确解析表达式，\n$$\n\\|e(\\cdot,\\cdot,t)\\|_{L^2(\\Omega)} = \\left( \\int_{\\Omega} e(x,y,t)^2 \\,\\mathrm{d}\\Omega \\right)^{1/2},\n$$\n使其成为 $\\alpha$ 和 $t$ 的函数。将最终答案表示为单个闭式解析表达式。假设这是一个无量纲的基准问题，因此最终表达式无需物理单位。无需四舍五入。", "solution": "该问题经核实具有科学依据、是适定且客观的。它是有限元法领域的一个标准问题，可以使用成熟的数学方法求解。\n\n该问题要求推导有限元矩阵，求解两个由此产生的常微分方程组(ODEs)，最后计算这两个解之差的 $L^2$ 范数。\n\n### 第1部分：质量矩阵和刚度矩阵的推导\n\n问题设定在一个二维线性三角形单元 $\\Omega$ 上，其顶点为 $v_1=(0,0)$、$v_2=(1,0)$ 和 $v_3=(0,1)$。该三角形的面积为 $A = \\frac{1}{2}(1)(1) = \\frac{1}{2}$。\n线性形函数 $N_i(x,y)$ 由性质 $N_i(v_j) = \\delta_{ij}$ 定义。对于这个特定的三角形，它们是：\n$N_1(x,y) = 1-x-y$\n$N_2(x,y) = x$\n$N_3(x,y) = y$\n\n形函数的梯度在整个单元上是常数：\n$\\nabla N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$，$\\nabla N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$\\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n一致质量矩阵 $\\mathbf{M}$ 的元素由 $M_{ij} = \\int_{\\Omega} N_i N_j \\,d\\Omega$ 给出。对于线性三角形单元，这些积分有标准的结果，即 $M_{ij} = \\frac{A}{12}(1+\\delta_{ij})$。\n使用 $A=1/2$：\n$M_{ii} = \\frac{1/2}{12}(1+1) = \\frac{1}{12}$。\n$M_{ij} (i \\neq j) = \\frac{1/2}{12}(1+0) = \\frac{1}{24}$。\n这给出了一致质量矩阵：\n$$\n\\mathbf{M} = \\frac{1}{24} \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n单元刚度矩阵 $\\mathbf{K}$ 的元素由 $K_{ij} = \\int_{\\Omega} \\nabla N_i \\cdot \\nabla N_j \\,d\\Omega$ 给出。由于梯度是常数，这简化为 $K_{ij} = (\\nabla N_i \\cdot \\nabla N_j) A$。\n$K_{11} = (\\nabla N_1 \\cdot \\nabla N_1) A = ((-1)^2 + (-1)^2) \\frac{1}{2} = 2 \\cdot \\frac{1}{2} = 1$。\n$K_{12} = (\\nabla N_1 \\cdot \\nabla N_2) A = ((-1)(1) + (-1)(0)) \\frac{1}{2} = -1 \\cdot \\frac{1}{2} = -\\frac{1}{2}$。\n$K_{13} = (\\nabla N_1 \\cdot \\nabla N_3) A = ((-1)(0) + (-1)(1)) \\frac{1}{2} = -1 \\cdot \\frac{1}{2} = -\\frac{1}{2}$。\n$K_{22} = (\\nabla N_2 \\cdot \\nabla N_2) A = (1^2 + 0^2) \\frac{1}{2} = \\frac{1}{2}$。\n$K_{23} = (\\nabla N_2 \\cdot \\nabla N_3) A = ((1)(0) + (0)(1)) \\frac{1}{2} = 0$。\n$K_{33} = (\\nabla N_3 \\cdot \\nabla N_3) A = (0^2 + 1^2) \\frac{1}{2} = \\frac{1}{2}$。\n根据对称性，刚度矩阵为：\n$$\n\\mathbf{K} = \\begin{pmatrix} 1  -1/2  -1/2 \\\\ -1/2  1/2  0 \\\\ -1/2  0  1/2 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 2  -1  -1 \\\\ -1  1  0 \\\\ -1  0  1 \\end{pmatrix}\n$$\n\n### 第2部分：集中质量矩阵\n\n节点求积使用近似式 $\\int_{\\Omega} f \\,d\\Omega \\approx \\sum_{k=1}^3 w_k f(v_k)$，其中 $w_k$ 是节点权重。为使此规则对常数场精确，我们需要满足 $\\sum w_k = A$。对于线性三角形，一个标准的选择是 $w_k = A/3$。对于我们的三角形，有 $w_k = (1/2)/3 = 1/6$。\n集中质量矩阵 $\\mathbf{M}_{\\ell}$ 是一个对角矩阵，其元素是通过应用此求积法计算 $\\int N_i N_j d\\Omega$ 得到的。\n$M_{\\ell,ij} = \\int_{\\Omega} N_i N_j \\,d\\Omega \\approx \\sum_{k=1}^3 w_k N_i(v_k) N_j(v_k)$。\n使用 $N_i(v_k)=\\delta_{ik}$：\n$M_{\\ell,ij} \\approx \\sum_{k=1}^3 w_k \\delta_{ik} \\delta_{jk} = w_i \\delta_{ij}$。\n所以，对角元素为 $M_{\\ell,ii} = w_i = 1/6$。这等价于将 $\\mathbf{M}$ 的各行求和，并将结果放在对角线上。例如，$M_{\\ell,11} = M_{11}+M_{12}+M_{13} = \\frac{1}{24}(2+1+1) = \\frac{4}{24} = \\frac{1}{6}$。\n集中质量矩阵为：\n$$\n\\mathbf{M}_{\\ell} = \\frac{1}{6} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n### 第3部分：半离散解\n\n初始条件为 $u(x,y,0) = x$。初始节点向量 $\\mathbf{u}(0)$ 是通过在顶点处计算初始条件得到的：\n$u_1(0) = u(0,0,0) = 0$\n$u_2(0) = u(1,0,0) = 1$\n$u_3(0) = u(0,1,0) = 0$\n所以，$\\mathbf{u}(0) = (0, 1, 0)^{\\mathsf{T}}$。\n\n**一致质量解 $\\mathbf{u}_{\\mathrm{c}}(t)$**\nODE系统为 $\\mathbf{M}\\,\\dot{\\mathbf{u}}_{\\mathrm{c}} + \\alpha\\,\\mathbf{K}\\,\\mathbf{u}_{\\mathrm{c}} = \\mathbf{0}$，或 $\\dot{\\mathbf{u}}_{\\mathrm{c}} = -\\alpha \\mathbf{M}^{-1}\\mathbf{K} \\mathbf{u}_{\\mathrm{c}}$。解是通过使用问题 $\\alpha\\mathbf{K}\\mathbf{v} = \\lambda_c\\mathbf{M}\\mathbf{v}$ 的广义特征向量 $\\mathbf{v}_j$ 和特征值 $\\lambda_{c,j}$ 进行模态分解找到的，这等价于寻找 $\\mathbf{M}^{-1}\\mathbf{K}$ 的特征对。\n\n$\\mathbf{K}$ 的特征值为 $\\mu \\in \\{0, 1/2, 3/2\\}$，对应的特征向量为 $\\mathbf{v}_1=(1,1,1)^{\\mathsf{T}}$、$\\mathbf{v}_2=(0,1,-1)^{\\mathsf{T}}$ 和 $\\mathbf{v}_3=(-2,1,1)^{\\mathsf{T}}$。\n对于这个特定的三角形，可以验证这些向量也是 $(\\mathbf{K}, \\mathbf{M})$ 的广义特征向量。具体来说，对于满足 $\\mathbf{K}\\mathbf{v}_j = \\mu_j \\mathbf{v}_j$ 的 $\\mathbf{v}_j$，当 $\\mu_j \\neq 0$ 时，我们有 $\\mathbf{M}\\mathbf{v}_j = \\frac{1}{24}\\mathbf{v}_j$，而 $\\mathbf{M}\\mathbf{v}_1 = \\frac{1}{6}\\mathbf{v}_1$。\n广义特征值 $\\lambda_{c,j}$ 满足 $\\alpha \\mu_j \\mathbf{v}_j = \\lambda_{c,j} (\\mathbf{M}\\mathbf{v}_j)$。\n对于 $j=1$：$\\mathbf{Kv}_1 = \\mathbf{0}$，因此 $\\lambda_{c,1}=0$。\n对于 $j=2$：$\\alpha(\\frac{1}{2})\\mathbf{v}_2 = \\lambda_{c,2}(\\frac{1}{24})\\mathbf{v}_2 \\implies \\lambda_{c,2} = 12\\alpha$。\n对于 $j=3$：$\\alpha(\\frac{3}{2})\\mathbf{v}_3 = \\lambda_{c,3}(\\frac{1}{24})\\mathbf{v}_3 \\implies \\lambda_{c,3} = 36\\alpha$。\n\n解为 $\\mathbf{u}_{\\mathrm{c}}(t) = \\sum_{j=1}^3 c_j \\mathbf{v}_j \\exp(-\\lambda_{c,j}t)$。系数 $c_j$ 由 $\\mathbf{u}(0) = \\sum c_j \\mathbf{v}_j$ 求得：\n$$\n\\begin{pmatrix} 1  0  -2 \\\\ 1  1  1 \\\\ 1  -1  1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n解此方程组得到 $c_1=1/3$，$c_2=1/2$，$c_3=1/6$。\n因此，解为：\n$$\n\\mathbf{u}_{\\mathrm{c}}(t) = \\frac{1}{3}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\\exp(-12\\alpha t) + \\frac{1}{6}\\begin{pmatrix} -2 \\\\ 1 \\\\ 1 \\end{pmatrix}\\exp(-36\\alpha t)\n$$\n\n**集中质量解 $\\mathbf{u}_{\\ell}(t)$**\nODE系统为 $\\mathbf{M}_{\\ell}\\,\\dot{\\mathbf{u}}_{\\ell} + \\alpha\\,\\mathbf{K}\\,\\mathbf{u}_{\\ell} = \\mathbf{0}$。由于 $\\mathbf{M}_{\\ell} = \\frac{1}{6}\\mathbf{I}$，该方程变为 $\\dot{\\mathbf{u}}_{\\ell} = -6\\alpha\\mathbf{K}\\mathbf{u}_{\\ell}$。\n系统矩阵为 $6\\alpha\\mathbf{K}$。其特征值是 $\\mathbf{K}$ 的特征值的 $6\\alpha$ 倍：\n$\\lambda_{\\ell,1} = 6\\alpha(0) = 0$。\n$\\lambda_{\\ell,2} = 6\\alpha(1/2) = 3\\alpha$。\n$\\lambda_{\\ell,3} = 6\\alpha(3/2) = 9\\alpha$。\n特征向量与 $\\mathbf{K}$ 的相同，所以 $\\mathbf{w}_j = \\mathbf{v}_j$。\n解为 $\\mathbf{u}_{\\ell}(t) = \\sum_{j=1}^3 d_j \\mathbf{w}_j \\exp(-\\lambda_{\\ell,j} t)$。系数 $d_j$ 由相同的初始条件 $\\mathbf{u}(0)=\\sum d_j \\mathbf{w}_j$ 求得，因此 $d_j=c_j$。\n$$\n\\mathbf{u}_{\\ell}(t) = \\frac{1}{3}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\end{pmatrix}\\exp(-3\\alpha t) + \\frac{1}{6}\\begin{pmatrix} -2 \\\\ 1 \\\\ 1 \\end{pmatrix}\\exp(-9\\alpha t)\n$$\n\n### 第4部分：误差的 $L^2$ 范数\n\n误差场为 $e(x,y,t) = \\sum_{i=1}^{3} N_i(x,y) d_i(t)$，其中 $\\mathbf{d}(t) = \\mathbf{u}_{\\mathrm{c}}(t) - \\mathbf{u}_{\\ell}(t)$。\n$L^2$ 范数的平方由下式给出：\n$$\n\\|e(\\cdot,\\cdot,t)\\|_{L^2(\\Omega)}^2 = \\int_{\\Omega} \\left(\\sum_i N_i d_i\\right) \\left(\\sum_j N_j d_j\\right) d\\Omega = \\sum_{i,j} d_i d_j \\int_{\\Omega} N_i N_j d\\Omega = \\mathbf{d}(t)^{\\mathsf{T}} \\mathbf{M} \\mathbf{d}(t)\n$$\n差分向量 $\\mathbf{d}(t)$ 为：\n$$\n\\mathbf{d}(t) = \\frac{1}{2}\\mathbf{v}_2\\left(\\exp(-12\\alpha t)-\\exp(-3\\alpha t)\\right) + \\frac{1}{6}\\mathbf{v}_3\\left(\\exp(-36\\alpha t)-\\exp(-9\\alpha t)\\right)\n$$\n让我们记 $g_2(t) = \\exp(-12\\alpha t)-\\exp(-3\\alpha t)$ 和 $g_3(t) = \\exp(-36\\alpha t)-\\exp(-9\\alpha t)$。由于 $c_2=1/2$ 和 $c_3=1/6$，我们有：\n$\\mathbf{d}(t) = c_2 g_2(t) \\mathbf{v}_2 + c_3 g_3(t) \\mathbf{v}_3$。\n将此代入范数表达式：\n$$\n\\|e\\|^2 = (c_2 g_2 \\mathbf{v}_2^{\\mathsf{T}} + c_3 g_3 \\mathbf{v}_3^{\\mathsf{T}}) \\mathbf{M} (c_2 g_2 \\mathbf{v}_2 + c_3 g_3 \\mathbf{v}_3)\n$$\n广义特征向量是 $\\mathbf{M}$-正交的，即当 $i \\neq j$ 时，$\\mathbf{v}_i^{\\mathsf{T}}\\mathbf{M}\\mathbf{v}_j=0$。因此，交叉项为零：\n$$\n\\|e\\|^2 = c_2^2 g_2(t)^2 (\\mathbf{v}_2^{\\mathsf{T}}\\mathbf{M}\\mathbf{v}_2) + c_3^2 g_3(t)^2 (\\mathbf{v}_3^{\\mathsf{T}}\\mathbf{M}\\mathbf{v}_3)\n$$\n我们计算二次型（模态质量）：\n$\\mathbf{v}_2^{\\mathsf{T}}\\mathbf{M}\\mathbf{v}_2 = \\mathbf{v}_2^{\\mathsf{T}}(\\frac{1}{24}\\mathbf{v}_2) = \\frac{1}{24}\\mathbf{v}_2^{\\mathsf{T}}\\mathbf{v}_2 = \\frac{1}{24}(0^2+1^2+(-1)^2) = \\frac{2}{24} = \\frac{1}{12}$。\n$\\mathbf{v}_3^{\\mathsf{T}}\\mathbf{M}\\mathbf{v}_3 = \\mathbf{v}_3^{\\mathsf{T}}(\\frac{1}{24}\\mathbf{v}_3) = \\frac{1}{24}\\mathbf{v}_3^{\\mathsf{T}}\\mathbf{v}_3 = \\frac{1}{24}((-2)^2+1^2+1^2) = \\frac{6}{24} = \\frac{1}{4}$。\n代入系数和模态质量：\n$$\n\\|e\\|^2 = \\left(\\frac{1}{2}\\right)^2 g_2(t)^2 \\left(\\frac{1}{12}\\right) + \\left(\\frac{1}{6}\\right)^2 g_3(t)^2 \\left(\\frac{1}{4}\\right)\n$$\n$$\n\\|e\\|^2 = \\frac{1}{4} \\frac{1}{12} g_2(t)^2 + \\frac{1}{36} \\frac{1}{4} g_3(t)^2 = \\frac{1}{48} g_2(t)^2 + \\frac{1}{144} g_3(t)^2\n$$\n$$\n\\|e\\|^2 = \\frac{1}{144} \\left(3 g_2(t)^2 + g_3(t)^2\\right)\n$$\n取平方根得到 $L^2$ 范数：\n$$\n\\|e(\\cdot,\\cdot,t)\\|_{L^2(\\Omega)} = \\frac{1}{12} \\left( 3 \\left(\\exp(-12\\alpha t)-\\exp(-3\\alpha t)\\right)^2 + \\left(\\exp(-36\\alpha t)-\\exp(-9\\alpha t)\\right)^2 \\right)^{1/2}\n$$\n这就是两个有限元解之间误差的 $L^2$ 范数的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{12} \\left( 3 \\left(\\exp(-12\\alpha t)-\\exp(-3\\alpha t)\\right)^2 + \\left(\\exp(-36\\alpha t)-\\exp(-9\\alpha t)\\right)^2 \\right)^{1/2}}\n$$", "id": "3528390"}]}