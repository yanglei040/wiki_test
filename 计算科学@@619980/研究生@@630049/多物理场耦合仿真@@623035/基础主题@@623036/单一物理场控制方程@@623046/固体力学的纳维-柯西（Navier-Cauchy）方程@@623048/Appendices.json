{"hands_on_practices": [{"introduction": "在工程实践中，为了简化计算，我们常常将三维实体简化为二维模型。这个练习旨在通过从基本的三维胡克定律出发，推导平面应力与平面应变条件下的本构关系，来巩固您对维度约减这一核心概念的理解。通过此实践，您将能清晰地辨析这两种二维近似的物理假设及其对材料有效弹性参数的影响，这是进行精确有限元分析的基础。[@problem_id:3517489]", "problem": "考虑一个正在经历小变形的各向同性、均质、线性弹性固体，该固体由 Navier–Cauchy 方程建模。该固体由三维杨氏模量 $E$ 和泊松比 $\\nu$ 表征。小应变张量定义为 $\\,\\varepsilon_{ij} = \\tfrac{1}{2}\\left(\\partial u_{i}/\\partial x_{j} + \\partial u_{j}/\\partial x_{i}\\right)\\,$，各向同性弹性的三维本构关系（胡克定律）用拉梅参数 $(\\lambda,\\mu)$ 写为 $\\,\\sigma_{ij} = \\lambda\\,\\varepsilon_{kk}\\,\\delta_{ij} + 2\\mu\\,\\varepsilon_{ij}\\,$，其中拉梅参数与 $E$ 和 $\\nu$ 的关系为 $\\,\\mu = E/\\big(2(1+\\nu)\\big)\\,$ 和 $\\,\\lambda = E\\nu/\\big((1+\\nu)(1-2\\nu)\\big)\\,$。\n\n在多物理场耦合模拟中，通常将三维固体简化为适用于薄结构（平面应力）或面外应变可忽略的长结构（平面应变）的等效二维模型。在平面应力近似中，强制 $\\,\\sigma_{33}=0\\,$ 和 $\\,\\sigma_{13}=\\sigma_{23}=0\\,$，同时允许 $\\,\\varepsilon_{33}\\neq 0\\,$；在平面应变近似中，强制 $\\,\\varepsilon_{33}=0\\,$ 和 $\\,\\varepsilon_{13}=\\varepsilon_{23}=0\\,$，同时允许 $\\,\\sigma_{33}\\neq 0\\,$。\n\n从所述的物理和数学基础出发，解析推导平面应力和平面应变条件下的面内本构关系，并解释这些约束条件如何修正面内应力和应变之间的关系。然后，通过要求简化后的平面应力面内本构关系在形式上与一个用等效二维杨氏模量 $E_{\\text{2D}}$ 和等效二维泊松比 $\\nu_{\\text{2D}}$ 表示的二维各向同性胡克定律相同，\n$$\n\\sigma_{\\alpha\\beta} \\;=\\; \\lambda_{\\text{2D}}\\,\\varepsilon_{\\gamma\\gamma}\\,\\delta_{\\alpha\\beta} \\;+\\; 2\\mu_{\\text{2D}}\\,\\varepsilon_{\\alpha\\beta}\n\\quad\\text{for}\\quad \\alpha,\\beta,\\gamma\\in\\{1,2\\},\n$$\n其中 $\\,\\mu_{\\text{2D}} = E_{\\text{2D}}/\\big(2(1+\\nu_{\\text{2D}})\\big)\\,$ 且 $\\,\\lambda_{\\text{2D}}$ 是与上述二维定律一致的二维拉梅参数，来确定用三维参数 $\\,E\\,$ 和 $\\,\\nu\\,$ 表示的 $\\,E_{\\text{2D}}\\,$ 和 $\\,\\nu_{\\text{2D}}\\,$ 的闭合形式表达式。\n\n将最终答案以符号形式表示为一个包含用 $\\,E\\,$ 和 $\\,\\nu\\,$ 表示的 $\\,E_{\\text{2D}}\\,$ 和 $\\,\\nu_{\\text{2D}}\\,$ 的单行矩阵。无需进行数值计算。", "solution": "该问题是有效的，因为它科学上基于线性弹性原理，是适定、客观且自洽的。我们可以开始解题。\n\n本分析的基础是用于均质、各向同性、线性弹性材料的三维胡克定律，用应力张量 $\\sigma_{ij}$ 和小应变张量 $\\varepsilon_{ij}$ 表示为：\n$$\n\\sigma_{ij} = \\lambda\\,\\varepsilon_{kk}\\,\\delta_{ij} + 2\\mu\\,\\varepsilon_{ij}\n$$\n此处，$\\lambda$ 和 $\\mu$ 是拉梅参数，$\\delta_{ij}$ 是克罗内克符号，重复指标使用爱因斯坦求和约定。应变张量的迹为 $\\varepsilon_{kk} = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}$。指标 $i,j,k$ 的取值范围为 1 到 3。我们将使用希腊字母指标 $\\alpha, \\beta, \\gamma$ 来表示范围为 1 到 2 的面内分量。\n\n首先，我们推导平面应变和平面应力条件下的面内本构关系。\n\n**第一部分：面内本构关系**\n\n**A. 平面应变**\n平面应变近似由约束条件 $\\varepsilon_{33}=0$、$\\varepsilon_{13}=0$ 和 $\\varepsilon_{23}=0$ 定义。\n在这些约束下，应变张量的迹简化为面内应变张量的迹：$\\varepsilon_{kk} = \\varepsilon_{11} + \\varepsilon_{22} + 0 = \\varepsilon_{\\gamma\\gamma}$，其中 $\\gamma \\in \\{1,2\\}$。\n\n应力张量的面内分量（$\\alpha, \\beta \\in \\{1,2\\}$）由下式给出：\n$$\n\\sigma_{\\alpha\\beta} = \\lambda\\,\\varepsilon_{kk}\\,\\delta_{\\alpha\\beta} + 2\\mu\\,\\varepsilon_{\\alpha\\beta}\n$$\n代入 $\\varepsilon_{kk} = \\varepsilon_{\\gamma\\gamma}$，我们得到平面应变的面内本构关系：\n$$\n\\sigma_{\\alpha\\beta} = \\lambda\\,\\varepsilon_{\\gamma\\gamma}\\,\\delta_{\\alpha\\beta} + 2\\mu\\,\\varepsilon_{\\alpha\\beta}\n$$\n该关系在形式上与三维定律相同，但被限制在二维子空间内。拉梅参数 $(\\lambda, \\mu)$ 是原始的三维参数。\n\n面外应力分量 $\\sigma_{33}$ 不为零。其值可通过在三维胡克定律中设置 $i=j=3$ 来求得：\n$$\n\\sigma_{33} = \\lambda\\,\\varepsilon_{kk}\\,\\delta_{33} + 2\\mu\\,\\varepsilon_{33} = \\lambda(\\varepsilon_{11}+\\varepsilon_{22}) + 2\\mu(0) = \\lambda\\,\\varepsilon_{\\gamma\\gamma}\n$$\n面外剪应力为 $\\sigma_{13} = 2\\mu\\varepsilon_{13} = 0$ 和 $\\sigma_{23} = 2\\mu\\varepsilon_{23} = 0$。\n\n**B. 平面应力**\n平面应力近似由约束条件 $\\sigma_{33}=0$、$\\sigma_{13}=0$ 和 $\\sigma_{23}=0$ 定义。\n根据剪应力关系 $\\sigma_{13} = 2\\mu\\varepsilon_{13}$ 和 $\\sigma_{23} = 2\\mu\\varepsilon_{23}$，约束条件 $\\sigma_{13}=0$ 和 $\\sigma_{23}=0$ 意味着 $\\varepsilon_{13}=0$ 和 $\\varepsilon_{23}=0$（因为 $\\mu \\neq 0$）。\n\n约束条件 $\\sigma_{33}=0$ 用于确定面外应变 $\\varepsilon_{33}$。根据三维胡克定律中关于 $\\sigma_{33}$ 的表达式：\n$$\n\\sigma_{33} = \\lambda\\,\\varepsilon_{kk} + 2\\mu\\,\\varepsilon_{33} = \\lambda(\\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}) + 2\\mu\\,\\varepsilon_{33} = 0\n$$\n$$\n\\lambda(\\varepsilon_{11} + \\varepsilon_{22}) + (\\lambda + 2\\mu)\\varepsilon_{33} = 0\n$$\n解出 $\\varepsilon_{33}$ 得到：\n$$\n\\varepsilon_{33} = -\\frac{\\lambda}{\\lambda + 2\\mu}(\\varepsilon_{11} + \\varepsilon_{22}) = -\\frac{\\lambda}{\\lambda + 2\\mu}\\varepsilon_{\\gamma\\gamma}\n$$\n这表明 $\\varepsilon_{33}$ 通常不为零，并与面内应变耦合。\n\n现在，我们推导面内本构关系。应变张量的迹 $\\varepsilon_{kk}$ 必须包含这个非零的 $\\varepsilon_{33}$：\n$$\n\\varepsilon_{kk} = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = \\varepsilon_{\\gamma\\gamma} - \\frac{\\lambda}{\\lambda + 2\\mu}\\varepsilon_{\\gamma\\gamma} = \\left(1 - \\frac{\\lambda}{\\lambda + 2\\mu}\\right)\\varepsilon_{\\gamma\\gamma} = \\left(\\frac{2\\mu}{\\lambda + 2\\mu}\\right)\\varepsilon_{\\gamma\\gamma}\n$$\n将这个修正后的迹代入三维胡克定律中关于面内应力分量 $\\sigma_{\\alpha\\beta}$ 的表达式：\n$$\n\\sigma_{\\alpha\\beta} = \\lambda\\,\\varepsilon_{kk}\\,\\delta_{\\alpha\\beta} + 2\\mu\\,\\varepsilon_{\\alpha\\beta} = \\lambda\\left(\\frac{2\\mu}{\\lambda + 2\\mu}\\varepsilon_{\\gamma\\gamma}\\right)\\delta_{\\alpha\\beta} + 2\\mu\\,\\varepsilon_{\\alpha\\beta}\n$$\n这就给出了平面应力的面内本构关系：\n$$\n\\sigma_{\\alpha\\beta} = \\left(\\frac{2\\lambda\\mu}{\\lambda + 2\\mu}\\right)\\varepsilon_{\\gamma\\gamma}\\,\\delta_{\\alpha\\beta} + 2\\mu\\,\\varepsilon_{\\alpha\\beta}\n$$\n在平面应力中，面内应力与面内应变之间的关系被修正了。虽然剪切模量 $\\mu$ 保持不变，但应变体积部分（第一项）的等效系数从 $\\lambda$ 变为一个等效参数 $\\lambda_{\\text{eff}} = \\frac{2\\lambda\\mu}{\\lambda + 2\\mu}$。这一修正考虑了材料在面外方向变形的自由度。\n\n**第二部分：平面应力的等效二维参数**\n\n题目要求我们通过将推导出的平面应力本构关系与形式如下的通用二维各向同性胡克定律进行匹配，来找出等效二维参数 $E_{\\text{2D}}$ 和 $\\nu_{\\text{2D}}$：\n$$\n\\sigma_{\\alpha\\beta} = \\lambda_{\\text{2D}}\\,\\varepsilon_{\\gamma\\gamma}\\,\\delta_{\\alpha\\beta} + 2\\mu_{\\text{2D}}\\,\\varepsilon_{\\alpha\\beta}\n$$\n通过将此目标形式与我们推导出的平面应力定律直接比较，我们可以确定等效的二维拉梅参数：\n$$\n\\mu_{\\text{2D}} = \\mu\n$$\n$$\n\\lambda_{\\text{2D}} = \\frac{2\\lambda\\mu}{\\lambda + 2\\mu}\n$$\n题目指出 $E_{\\text{2D}}$ 和 $\\nu_{\\text{2D}}$ 与 $\\lambda_{\\text{2D}}$ 和 $\\mu_{\\text{2D}}$ 的关系与二维弹性理论一致。剪切模量的关系给出为 $\\mu_{\\text{2D}} = \\frac{E_{\\text{2D}}}{2(1+\\nu_{\\text{2D}})}$。$\\lambda_{\\text{2D}}$ 的一致关系可通过反演二维应力-应变关系推导得出，结果为 $\\nu_{\\text{2D}} = \\frac{\\lambda_{\\text{2D}}}{\\lambda_{\\text{2D}}+2\\mu_{\\text{2D}}}$。\n\n首先，我们通过代入已确定的等效拉梅参数来求解 $\\nu_{\\text{2D}}$：\n$$\n\\nu_{\\text{2D}} = \\frac{\\lambda_{\\text{2D}}}{\\lambda_{\\text{2D}}+2\\mu_{\\text{2D}}} = \\frac{\\frac{2\\lambda\\mu}{\\lambda + 2\\mu}}{\\frac{2\\lambda\\mu}{\\lambda + 2\\mu} + 2\\mu}\n$$\n分子和分母同乘以 $(\\lambda + 2\\mu)$：\n$$\n\\nu_{\\text{2D}} = \\frac{2\\lambda\\mu}{2\\lambda\\mu + 2\\mu(\\lambda + 2\\mu)} = \\frac{2\\lambda\\mu}{4\\mu(\\lambda + \\mu)} = \\frac{\\lambda}{2(\\lambda + \\mu)}\n$$\n现在，我们使用给定的关系式将此结果用原始的三维参数 $E$ 和 $\\nu$ 表示：\n$\\mu = E/\\big(2(1+\\nu)\\big)$ 和 $\\lambda = E\\nu/\\big((1+\\nu)(1-2\\nu)\\big)$。\n让我们计算和 $\\lambda+\\mu$：\n$$\n\\lambda+\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{2(1+\\nu)} = \\frac{E}{1+\\nu}\\left(\\frac{\\nu}{1-2\\nu} + \\frac{1}{2}\\right) = \\frac{E}{1+\\nu}\\left(\\frac{2\\nu + 1-2\\nu}{2(1-2\\nu)}\\right) = \\frac{E}{2(1+\\nu)(1-2\\nu)}\n$$\n将这些代入 $\\nu_{\\text{2D}}$ 的表达式中：\n$$\n\\nu_{\\text{2D}} = \\frac{\\lambda}{2(\\lambda+\\mu)} = \\frac{\\frac{E\\nu}{(1+\\nu)(1-2\\nu)}}{2\\left(\\frac{E}{2(1+\\nu)(1-2\\nu)}\\right)} = \\frac{\\frac{E\\nu}{(1+\\nu)(1-2\\nu)}}{\\frac{E}{(1+\\nu)(1-2\\nu)}} = \\nu\n$$\n因此，等效二维泊松比与三维泊松比相同。\n\n接下来，我们确定 $E_{\\text{2D}}$。我们使用关系式 $\\mu_{\\text{2D}} = \\mu$ 和给定的公式 $\\mu_{\\text{2D}} = \\frac{E_{\\text{2D}}}{2(1+\\nu_{\\text{2D}})}$。\n$$\n\\mu = \\frac{E_{\\text{2D}}}{2(1+\\nu_{\\text{2D}})}\n$$\n由于我们已经求出 $\\nu_{\\text{2D}} = \\nu$，上式变为：\n$$\n\\mu = \\frac{E_{\\text{2D}}}{2(1+\\nu)}\n$$\n根据三维剪切模量 $\\mu$ 的定义，我们有 $\\mu = \\frac{E}{2(1+\\nu)}$。\n令 $\\mu$ 的两个表达式相等：\n$$\n\\frac{E}{2(1+\\nu)} = \\frac{E_{\\text{2D}}}{2(1+\\nu)}\n$$\n这意味着 $E_{\\text{2D}} = E$。\n等效二维杨氏模量与三维杨氏模量相同。这个结果在物理上是直观的，因为单轴应力测试（$\\sigma_{11} \\neq 0$，所有其他 $\\sigma_{ij}=0$）是一个有效的平面应力状态，而杨氏模量在此测试中的定义 $E = \\sigma_{11}/\\varepsilon_{11}$ 不受降维的影响。\n\n最终表达式为 $E_{\\text{2D}} = E$ 和 $\\nu_{\\text{2D}} = \\nu$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} E  \\nu \\end{pmatrix}\n}\n$$", "id": "3517489"}, {"introduction": "实际的固体力学问题常常涉及多物理场耦合，例如热应力和孔隙压力效应。本练习将弹性力学框架应用于一个具体的热-孔隙-力学耦合问题，要求您在给定应变状态下，计算包含热应变和孔隙压力贡献的柯西应力张量。这项实践旨在检验您综合运用本构关系处理复杂载荷条件的能力，并能通过von Mises等效应力等准则来评估材料的力学响应。[@problem_id:3517516]", "problem": "在小应变情况下，一个均匀、各向同性的线性多孔热弹性固体的特征由杨氏模量 $E$ 和泊松比 $\\nu$ 决定。该材料承受均匀温升 $\\Delta T$（其各向同性热膨胀系数为 $\\alpha$）和均匀孔隙压力 $p$（其 Biot 系数为 $b$），孔隙压力通过有效应力原理与应力耦合。在一个材料点处，总小应变张量给定为\n$$\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n1.2\\times 10^{-3}  2.0\\times 10^{-4}  -1.0\\times 10^{-4} \\\\\n2.0\\times 10^{-4}  -3.0\\times 10^{-4}  5.0\\times 10^{-4} \\\\\n-1.0\\times 10^{-4}  5.0\\times 10^{-4}  8.0\\times 10^{-4}\n\\end{pmatrix}.\n$$\n假设热特征应变为 $\\boldsymbol{\\varepsilon}^{\\ast}=\\alpha\\,\\Delta T\\,\\boldsymbol{I}$，并且总 Cauchy 应力 $\\boldsymbol{\\sigma}$ 可以写成对弹性应变 $\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{\\ast}$ 的弹性应力响应减去孔隙压力贡献 $b\\,p\\,\\boldsymbol{I}$。使用小应变的基本运动学和作为 Navier–Cauchy 方程基础的各向同性线弹性本构框架来：\n\n- 推导 Lamé 参数 $(\\lambda,\\mu)$ 关于 $(E,\\nu)$ 的表达式。\n- 计算该材料点的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$。\n- 根据 $\\boldsymbol{\\sigma}$ 计算 von Mises 等效应力 $\\sigma_{\\mathrm{vm}}$。\n\n使用以下材料和加载数据：$E=200\\,\\mathrm{GPa}$，$\\nu=0.3$，$\\alpha=12\\times 10^{-6}\\,\\mathrm{K}^{-1}$，$\\Delta T=50\\,\\mathrm{K}$，$b=0.6$，$p=5\\,\\mathrm{MPa}$。将 $\\sigma_{\\mathrm{vm}}$ 的最终答案以 $\\mathrm{MPa}$ 为单位表示，并四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 材料描述：均匀、各向同性、小应变范围内的线性多孔热弹性固体。\n- 杨氏模量：$E=200\\,\\mathrm{GPa}$\n- 泊松比：$\\nu=0.3$\n- 各向同性热膨胀系数：$\\alpha=12\\times 10^{-6}\\,\\mathrm{K}^{-1}$\n- 均匀温升：$\\Delta T=50\\,\\mathrm{K}$\n- 均匀孔隙压力：$p=5\\,\\mathrm{MPa}$\n- Biot 系数：$b=0.6$\n- 给定的总小应变张量：\n$$\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n1.2\\times 10^{-3}  2.0\\times 10^{-4}  -1.0\\times 10^{-4} \\\\\n2.0\\times 10^{-4}  -3.0\\times 10^{-4}  5.0\\times 10^{-4} \\\\\n-1.0\\times 10^{-4}  5.0\\times 10^{-4}  8.0\\times 10^{-4}\n\\end{pmatrix}\n$$\n- 热特征应变的定义：$\\boldsymbol{\\varepsilon}^{\\ast}=\\alpha\\,\\Delta T\\,\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。\n- 总 Cauchy 应力的定义：$\\boldsymbol{\\sigma}$ 是对弹性应变 $\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{\\ast}$ 的弹性应力响应减去孔隙压力贡献 $b\\,p\\,\\boldsymbol{I}$。\n- 任务：\n  1. 推导 Lamé 参数 $(\\lambda,\\mu)$ 关于 $(E,\\nu)$ 的表达式。\n  2. 计算 Cauchy 应力张量 $\\boldsymbol{\\sigma}$。\n  3. 根据 $\\boldsymbol{\\sigma}$ 计算 von Mises 等效应力 $\\sigma_{\\mathrm{vm}}$。\n- 最终答案要求：将 $\\sigma_{\\mathrm{vm}}$ 以 $\\mathrm{MPa}$ 为单位表示，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学依据**：该问题基于已建立的线性多孔热弹性理论。结合了线性各向同性弹性（Hooke 定律）、热膨胀和通过 Biot 系数的有效应力概念的本构关系，是固体力学和多物理场中的一个标准和基本模型。给定的材料属性对于像钢这样的常见工程材料是符合实际的。应变张量是对称的，这符合小应变的运动学要求。\n- **适定性**：该问题提供了唯一确定 Lamé 参数、应力张量和 von Mises 应力所需的所有必要数据和定义。任务定义清晰，并能导出一个唯一解。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或含糊不清的陈述。\n- **完整性和一致性**：所有必需的常数（$E$、$\\nu$、$\\alpha$、$\\Delta T$、$b$、$p$）和初始状态（应变张量 $\\boldsymbol{\\varepsilon}$）都已提供。设置中没有矛盾。\n\n### 步骤 3：结论和行动\n该问题有效。这是一个在连续介质力学中适定且具有科学依据的问题。将提供一个完整的解答。\n\n### 解答\n解答过程按问题陈述的要求分为三部分。首先，我们确定 Lamé 参数。其次，我们计算 Cauchy 应力张量。第三，我们计算 von Mises 等效应力。所有应力和模量值将统一使用兆帕斯卡（$\\mathrm{MPa}$）作为单位。\n\n**第 1 部分：Lamé 参数**\n对于线性、各向同性的弹性材料，Lamé 参数，即第一 Lamé 参数 $\\lambda$ 和第二 Lamé 参数 $\\mu$（也称为剪切模量 $G$），通过以下标准表达式与杨氏模量 $E$ 和泊松比 $\\nu$ 相关联：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}\n$$\n$$\n\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\n我们已知 $E=200\\,\\mathrm{GPa} = 200 \\times 10^3\\,\\mathrm{MPa}$ 和 $\\nu=0.3$。代入这些值：\n$$\n\\mu = \\frac{200 \\times 10^3\\,\\mathrm{MPa}}{2(1+0.3)} = \\frac{200 \\times 10^3\\,\\mathrm{MPa}}{2.6} = \\frac{1 \\times 10^6}{13}\\,\\mathrm{MPa}\n$$\n$$\n\\lambda = \\frac{(200 \\times 10^3\\,\\mathrm{MPa})(0.3)}{(1+0.3)(1-2 \\times 0.3)} = \\frac{60 \\times 10^3\\,\\mathrm{MPa}}{(1.3)(0.4)} = \\frac{60 \\times 10^3\\,\\mathrm{MPa}}{0.52} = \\frac{1.5 \\times 10^6}{13}\\,\\mathrm{MPa}\n$$\n\n**第 2 部分：Cauchy 应力张量**\n多孔热弹性材料的总 Cauchy 应力 $\\boldsymbol{\\sigma}$ 由本构关系给出，该关系考虑了弹性应变、热应变和孔隙压力。弹性应变 $\\boldsymbol{\\varepsilon}^{e}$ 是总应变 $\\boldsymbol{\\varepsilon}$ 和热特征应变 $\\boldsymbol{\\varepsilon}^{\\ast}$ 之间的差值：\n$$\n\\boldsymbol{\\varepsilon}^{e} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\ast}\n$$\n热应变是各向同性的：$\\boldsymbol{\\varepsilon}^{\\ast} = \\alpha \\Delta T \\boldsymbol{I}$。\n根据 $\\alpha=12\\times 10^{-6}\\,\\mathrm{K}^{-1}$ 和 $\\Delta T=50\\,\\mathrm{K}$：\n$$\n\\alpha \\Delta T = (12 \\times 10^{-6}) \\times 50 = 600 \\times 10^{-6} = 6 \\times 10^{-4}\n$$\n所以，$\\boldsymbol{\\varepsilon}^{\\ast} = 6 \\times 10^{-4} \\boldsymbol{I}$。\n那么弹性应变张量为：\n$$\n\\boldsymbol{\\varepsilon}^{e} = \\begin{pmatrix}\n1.2\\times 10^{-3}  2.0\\times 10^{-4}  -1.0\\times 10^{-4} \\\\\n2.0\\times 10^{-4}  -3.0\\times 10^{-4}  5.0\\times 10^{-4} \\\\\n-1.0\\times 10^{-4}  5.0\\times 10^{-4}  8.0\\times 10^{-4}\n\\end{pmatrix} - \\begin{pmatrix}\n6\\times 10^{-4}  0  0 \\\\\n0  6\\times 10^{-4}  0 \\\\\n0  0  6\\times 10^{-4}\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\varepsilon}^{e} = \\begin{pmatrix}\n(12-6)\\times 10^{-4}  2.0\\times 10^{-4}  -1.0\\times 10^{-4} \\\\\n2.0\\times 10^{-4}  (-3-6)\\times 10^{-4}  5.0\\times 10^{-4} \\\\\n-1.0\\times 10^{-4}  5.0\\times 10^{-4}  (8-6)\\times 10^{-4}\n\\end{pmatrix} = 10^{-4} \\begin{pmatrix}\n6  2  -1 \\\\\n2  -9  5 \\\\\n-1  5  2\n\\end{pmatrix}\n$$\n总 Cauchy 应力 $\\boldsymbol{\\sigma}$ 的本构关系由施加于弹性应变的 Hooke 定律给出，并包含一个孔隙压力的附加项：\n$$\n\\boldsymbol{\\sigma} = \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e})\\boldsymbol{I} + 2\\mu\\boldsymbol{\\varepsilon}^{e} - b p \\boldsymbol{I}\n$$\n首先，我们求弹性应变的迹：\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) = \\varepsilon_{11}^{e} + \\varepsilon_{22}^{e} + \\varepsilon_{33}^{e} = (6 - 9 + 2) \\times 10^{-4} = -1 \\times 10^{-4}\n$$\n现在，我们计算应力方程中的各项。为方便起见，我们将各向同性项归类：\n$$\n\\boldsymbol{\\sigma} = (\\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) - b p)\\boldsymbol{I} + 2\\mu\\boldsymbol{\\varepsilon}^{e}\n$$\n各向同性部分的系数为：\n$$\n\\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) - b p = \\left(\\frac{1.5 \\times 10^6}{13}\\,\\mathrm{MPa}\\right)(-1 \\times 10^{-4}) - (0.6)(5\\,\\mathrm{MPa}) = -\\frac{150}{13}\\,\\mathrm{MPa} - 3\\,\\mathrm{MPa}\n$$\n$$\n= -\\frac{150}{13}\\,\\mathrm{MPa} - \\frac{39}{13}\\,\\mathrm{MPa} = -\\frac{189}{13}\\,\\mathrm{MPa}\n$$\n第二项是：\n$$\n2\\mu\\boldsymbol{\\varepsilon}^{e} = 2\\left(\\frac{1 \\times 10^6}{13}\\,\\mathrm{MPa}\\right) \\left(10^{-4} \\begin{pmatrix}\n6  2  -1 \\\\\n2  -9  5 \\\\\n-1  5  2\n\\end{pmatrix}\\right) = \\frac{200}{13} \\begin{pmatrix}\n6  2  -1 \\\\\n2  -9  5 \\\\\n-1  5  2\n\\end{pmatrix} \\,\\mathrm{MPa}\n$$\n组合各项，以 MPa 为单位求 $\\boldsymbol{\\sigma}$ 的分量：\n$$\n\\sigma_{11} = -\\frac{189}{13} + \\frac{200 \\times 6}{13} = \\frac{-189 + 1200}{13} = \\frac{1011}{13}\n$$\n$$\n\\sigma_{22} = -\\frac{189}{13} + \\frac{200 \\times (-9)}{13} = \\frac{-189 - 1800}{13} = -\\frac{1989}{13}\n$$\n$$\n\\sigma_{33} = -\\frac{189}{13} + \\frac{200 \\times 2}{13} = \\frac{-189 + 400}{13} = \\frac{211}{13}\n$$\n$$\n\\sigma_{12} = \\sigma_{21} = \\frac{200 \\times 2}{13} = \\frac{400}{13}\n$$\n$$\n\\sigma_{13} = \\sigma_{31} = \\frac{200 \\times (-1)}{13} = -\\frac{200}{13}\n$$\n$$\n\\sigma_{23} = \\sigma_{32} = \\frac{200 \\times 5}{13} = \\frac{1000}{13}\n$$\n因此，Cauchy 应力张量为：\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{13} \\begin{pmatrix}\n1011  400  -200 \\\\\n400  -1989  1000 \\\\\n-200  1000  211\n\\end{pmatrix} \\,\\mathrm{MPa}\n$$\n\n**第 3 部分：Von Mises 等效应力**\nvon Mises 等效应力 $\\sigma_{\\mathrm{vm}}$ 定义为：\n$$\n\\sigma_{\\mathrm{vm}} = \\sqrt{\\frac{1}{2} \\left[ (\\sigma_{11}-\\sigma_{22})^2 + (\\sigma_{22}-\\sigma_{33})^2 + (\\sigma_{33}-\\sigma_{11})^2 + 6(\\sigma_{12}^2 + \\sigma_{23}^2 + \\sigma_{13}^2) \\right]}\n$$\n我们使用 $\\boldsymbol{\\sigma}$ 的分量（单位为 MPa）计算平方根内的各项：\n$$\n\\sigma_{11}-\\sigma_{22} = \\frac{1011 - (-1989)}{13} = \\frac{3000}{13}\n$$\n$$\n\\sigma_{22}-\\sigma_{33} = \\frac{-1989 - 211}{13} = -\\frac{2200}{13}\n$$\n$$\n\\sigma_{33}-\\sigma_{11} = \\frac{211 - 1011}{13} = -\\frac{800}{13}\n$$\n正应力差的平方和为：\n$$\n(\\sigma_{11}-\\sigma_{22})^2 + (\\sigma_{22}-\\sigma_{33})^2 + (\\sigma_{33}-\\sigma_{11})^2 = \\left(\\frac{3000}{13}\\right)^2 + \\left(-\\frac{2200}{13}\\right)^2 + \\left(-\\frac{800}{13}\\right)^2\n$$\n$$\n= \\frac{1}{13^2} (9 \\times 10^6 + 4.84 \\times 10^6 + 0.64 \\times 10^6) = \\frac{14.48 \\times 10^6}{169}\n$$\n剪应力平方和为：\n$$\n\\sigma_{12}^2 + \\sigma_{23}^2 + \\sigma_{13}^2 = \\left(\\frac{400}{13}\\right)^2 + \\left(\\frac{1000}{13}\\right)^2 + \\left(-\\frac{200}{13}\\right)^2\n$$\n$$\n= \\frac{1}{13^2} (160000 + 1000000 + 40000) = \\frac{1.2 \\times 10^6}{169}\n$$\n现在，我们计算 $\\sigma_{\\mathrm{vm}}^2$：\n$$\n\\sigma_{\\mathrm{vm}}^2 = \\frac{1}{2} \\left[ \\frac{14.48 \\times 10^6}{169} + 6\\left(\\frac{1.2 \\times 10^6}{169}\\right) \\right] = \\frac{1}{2 \\times 169} [14.48 \\times 10^6 + 7.2 \\times 10^6]\n$$\n$$\n\\sigma_{\\mathrm{vm}}^2 = \\frac{21.68 \\times 10^6}{338} = \\frac{10.84 \\times 10^6}{169}\n$$\n取平方根求 $\\sigma_{\\mathrm{vm}}$：\n$$\n\\sigma_{\\mathrm{vm}} = \\sqrt{\\frac{10.84 \\times 10^6}{169}} = \\frac{\\sqrt{10.84 \\times 10^6}}{13} = \\frac{1000\\sqrt{10.84}}{13}\\,\\mathrm{MPa}\n$$\n$$\n\\sigma_{\\mathrm{vm}} \\approx \\frac{1000 \\times 3.2924155}{13} \\approx \\frac{3292.4155}{13} \\approx 253.2627\\,\\mathrm{MPa}\n$$\n将结果四舍五入到四位有效数字，我们得到 $253.3\\,\\mathrm{MPa}$。", "answer": "$$\n\\boxed{253.3}\n$$", "id": "3517516"}, {"introduction": "从理论走向实践，数值方法（尤其是有限元法）是解决复杂几何和边界条件下纳维-柯西方程的关键。然而，数值近似会引入其特有的挑战，例如“体积锁定”现象。本编程练习旨在通过使用位移基的有限元方法，模拟近不可压缩材料的力学行为，从而直观地揭示体积锁定的根源及其对计算结果精度的影响。[@problem_id:3517463]", "problem": "考虑一个占据宽度为 $L$、高度为 $H$ 的矩形域的二维、小应变、线弹性体。假设静态平衡和平面应变。从线动量平衡和线性各向同性本构关系出发，使用四节点双线性四边形单元和完全 $2 \\times 2$ Gauss 积分，建立并实现一个基于位移的有限元方法 (FEM)。通过研究均布牵引荷载下水平位移的收敛性，使用该方法数值上演示并讨论近不可压缩弹性中体积锁定的起源。\n\n基本出发点：\n- 线动量平衡：$\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$，其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\boldsymbol{b}$ 是单位体积的体力。在本问题中，取 $\\boldsymbol{b} = \\boldsymbol{0}$。\n- 小应变运动学：$\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$，其中 $\\boldsymbol{u}$ 是位移矢量。\n- 线性各向同性弹性（Navier-Cauchy 形式）：$\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2\\mu \\boldsymbol{\\varepsilon}$，其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数，$\\mathrm{tr}(\\cdot)$ 表示迹，$\\boldsymbol{I}$ 是单位张量。\n- 平面应变条件及其对应的 $3 \\times 3$ 本构刚度矩阵 $D$，该矩阵关联 $\\left[\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}\\right]^{\\top}$ 和 $\\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^{\\top}$，其中 $\\gamma_{xy}$ 是工程剪切应变。\n\n场景与荷载：\n- 域：一个矩形，其 $L = 1$ m，$H = 1$ m。\n- 边界条件：左边界为固定约束，即在 $x = 0$ 处位移的两个分量均被指定为零；其余边界仅受牵引力作用，除了右边界在 $x$ 方向上施加了均布牵引力 $T_x$，且在其他地方 $T_y = 0$。\n- 材料参数：杨氏模量 $E$ 和泊松比 $\\nu$ 如下方测试套件中所指定。使用平面应变材料行为。\n- Gauss 积分：单元刚度采用完全 $2 \\times 2$ 积分。\n\n数值输出：\n- 计算右边界上的平均水平位移 $\\bar{u}_x^{\\Gamma_R}$，定义为位于边界 $x = L$ 上的所有节点的 $u_x$ 的算术平均值。\n- 所有位移值以米为单位表示。\n\n测试套件与参数值：\n- 在 $[0,L] \\times [0,H]$ 上使用 $n_x \\times n_y$ 单元的均匀网格和均布牵引力 $T_x$，进行以下六个测试用例：\n    1. $E = 10^6$ Pa, $\\nu = 0.3$, $n_x = 4$, $n_y = 4$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n    2. $E = 10^6$ Pa, $\\nu = 0.3$, $n_x = 8$, $n_y = 8$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n    3. $E = 10^6$ Pa, $\\nu = 0.3$, $n_x = 16$, $n_y = 16$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n    4. $E = 10^6$ Pa, $\\nu = 0.499$, $n_x = 4$, $n_y = 4$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n    5. $E = 10^6$ Pa, $\\nu = 0.499$, $n_x = 8$, $n_y = 8$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n    6. $E = 10^6$ Pa, $\\nu = 0.499$, $n_x = 16$, $n_y = 16$, $T_x = 10^3$ Pa, $L = 1$ m, $H = 1$ m。\n\n实现要求：\n- 使用四节点双线性四边形单元对域进行离散化。\n- 在平面应变条件下，使用标准的基于位移的公式组集总刚度矩阵。\n- 通过一致的边界积分，在右边界上施加均布牵引力 $T_x$。\n- 通过直接消元法施加本质边界条件。\n- 求解线性系统并为每个测试用例计算 $\\bar{u}_x^{\\Gamma_R}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果顺序与上述测试套件一致，例如 $\\left[\\text{结果1},\\text{结果2},\\text{结果3},\\text{结果4},\\text{结果5},\\text{结果6}\\right]$。\n- 每个条目必须是以米为单位计算的右边界平均水平位移，并表示为浮点数。", "solution": "我们从静态条件下的线动量平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ 开始，其中 $\\boldsymbol{b} = \\boldsymbol{0}$。小应变的运动学关系为 $\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\right)$，其分量为 $\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}$，$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y}$ 和 $\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right)$。使用线性各向同性本构关系（Navier-Cauchy 形式）$\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2\\mu \\boldsymbol{\\varepsilon}$，并将其特化为平面应变情况，应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\sigma_{xy}$ 通过一个 $3 \\times 3$ 的刚度矩阵 $D$ 与应变分量 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\gamma_{xy} = 2\\varepsilon_{xy}$ 线性相关。对于平面应变，刚度矩阵为\n$$\nD = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{bmatrix}\n1-\\nu  \\nu  0 \\\\\n\\nu  1-\\nu  0 \\\\\n0  0  \\frac{1-2\\nu}{2}\n\\end{bmatrix},\n$$\n这是通过将 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\frac{E}{2(1+\\nu)}$ 代入平面应变条件下的各向同性本构定律得到的。平衡方程的弱形式是通过将强形式乘以一个测试函数，在域上积分，并应用分部积分来构建的，从而得到以应变-位移矩阵和本构张量表示的标准对称双线性形式。\n\n当材料接近不可压缩时，即当 $\\nu \\to 0.5$ 且体积模量 $K = \\lambda + \\frac{2}{3}\\mu$ 变得非常大时，基于位移的低阶有限元方法 (FEM) 中会出现体积锁定现象。在该极限下，体积应变 $\\varepsilon_{vol} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ 受到严重惩罚。在平面应变条件下，$\\varepsilon_{zz} = 0$，但应力 $\\sigma_{zz}$ 不为零，并由零面外应变的条件确定。关键的数值问题是，使用双线性单元和完全积分的标准纯位移近似无法在满足近不可压缩约束的同时，正确地表示无散（等体积）应变场。这违反了混合格式中所需的 Ladyzhenskaya–Babuška–Brezzi (LBB) 相容性条件，在混合格式中，压力（或体积应变）充当拉格朗日乘子。因此，离散刚度矩阵产生了对体积变形的过高效刚度，迫使解在荷载作用下人为地抑制了位移的大小，而这些荷载本应引起真实的变形。这表现为位移预测偏低，以及随着网格细化收敛性差或非单调，这种现象被称为体积锁定。\n\n为了演示这一点，我们构建一个二维的四节点双线性四边形单元。设单元节点位于坐标 $(x_i, y_i)$，$i \\in \\{1,2,3,4\\}$。在单元的自然坐标 $(\\xi,\\eta) \\in [-1,1]^2$ 中，形函数为\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n关于 $\\xi$ 和 $\\eta$ 的导数被解析计算，并通过雅可比矩阵 $J$ 映射到空间导数，其中 $\\begin{bmatrix} \\partial N_i/\\partial x \\\\ \\partial N_i/\\partial y \\end{bmatrix} = J^{-1} \\begin{bmatrix} \\partial N_i/\\partial \\xi \\\\ \\partial N_i/\\partial \\eta \\end{bmatrix}$。双线性单元的应变-位移矩阵 $B$ 是一个 $3 \\times 8$ 矩阵：\n$$\nB =\n\\begin{bmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_3}{\\partial x}  0  \\frac{\\partial N_4}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_1}{\\partial y}  0  \\frac{\\partial N_2}{\\partial y}  0  \\frac{\\partial N_3}{\\partial y}  0  \\frac{\\partial N_4}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x} \n\\frac{\\partial N_2}{\\partial y}  \\frac{\\partial N_2}{\\partial x} \n\\frac{\\partial N_3}{\\partial y}  \\frac{\\partial N_3}{\\partial x} \n\\frac{\\partial N_4}{\\partial y}  \\frac{\\partial N_4}{\\partial x}\n\\end{bmatrix}.\n$$\n单元刚度矩阵通过 Gauss 积分得到：\n$$\nK^{(e)} = \\int_{-1}^{1} \\int_{-1}^{1} B^{\\top} D B \\, \\mathrm{det}(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta,\n$$\n该积分在 $\\xi,\\eta = \\pm 1/\\sqrt{3}$ 的 $2 \\times 2$ Gauss 点上使用单位权重进行求值。边界牵引力通过边积分施加。对于 $x=L$ 处的右边界，我们使用一致的一维 Gauss 积分在边界段上对牵引力 $T_x$ 进行积分，通过沿边界的简化形函数分配节点力。在 $x=0$ 处的本质边界条件通过直接消元法强制施加：受约束自由度的行和列被设置为 0（除了对角线上的单位值），右端项被设置为指定的位移值。\n\n每个测试用例的算法步骤：\n- 在 $[0,L] \\times [0,H]$ 上生成一个包含 $n_x \\times n_y$ 个双线性四边形单元的结构化网格。\n- 通过遍历单元并对 $K^{(e)}$ 执行 $2 \\times 2$ Gauss 积分来组集总刚度矩阵 $K$。\n- 通过沿右边界积分均布牵引力 $T_x$ 并将其加到相关边界节点的 $x$ 分量上，来组集总力矢量 $\\boldsymbol{f}$。\n- 在 $x=0$ 处施加固定约束边界条件，设置 $u_x = 0$ 和 $u_y = 0$。\n- 求解 $K \\boldsymbol{u} = \\boldsymbol{f}$ 以获得总位移矢量 $\\boldsymbol{u}$。\n- 提取 $x=L$ 处的右边界节点，取其 $u_x$ 值，并计算算术平均值 $\\bar{u}_x^{\\Gamma_R}$。\n\n我们对比了中等可压缩材料（$\\nu = 0.3$）的三种网格和近不可压缩材料（$\\nu = 0.499$）的三种网格。对于 $\\nu = 0.3$，计算出的右边界平均位移应随着网格细化表现出合理的收敛性。对于 $\\nu = 0.499$，随着网格的细化，计算出的位移明显更小且收敛性差，这说明了体积锁定现象：基于位移的全积分双线性单元在近不可压缩约束下，人为地抑制了运动学上允许的等体积变形模式，从而夸大了刚度并低估了位移。\n\n程序计算六个所要求的平均值（以米为单位），并按照测试套件的顺序，将它们打印为单个用方括号括起来的逗号分隔列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef plane_strain_D(E, nu):\n    # Plane strain constitutive matrix D (3x3)\n    coef = E / ((1 + nu) * (1 - 2 * nu))\n    D = coef * np.array([\n        [1 - nu,    nu,        0.0],\n        [nu,        1 - nu,    0.0],\n        [0.0,       0.0,       (1 - 2 * nu) / 2.0]\n    ], dtype=float)\n    return D\n\ndef shape_functions_Q4(xi, eta):\n    # Bilinear Q4 shape functions and derivatives wrt xi, eta\n    N = np.array([\n        0.25 * (1 - xi) * (1 - eta),\n        0.25 * (1 + xi) * (1 - eta),\n        0.25 * (1 + xi) * (1 + eta),\n        0.25 * (1 - xi) * (1 + eta)\n    ], dtype=float)\n    dN_dxi = np.array([\n        -0.25 * (1 - eta),\n         0.25 * (1 - eta),\n         0.25 * (1 + eta),\n        -0.25 * (1 + eta)\n    ], dtype=float)\n    dN_deta = np.array([\n        -0.25 * (1 - xi),\n        -0.25 * (1 + xi),\n         0.25 * (1 + xi),\n         0.25 * (1 - xi)\n    ], dtype=float)\n    return N, dN_dxi, dN_deta\n\ndef B_matrix(dN_dx, dN_dy):\n    # Build 3x8 B matrix for Q4 element\n    B = np.zeros((3, 8), dtype=float)\n    for i in range(4):\n        B[0, 2*i]   = dN_dx[i]\n        B[1, 2*i+1] = dN_dy[i]\n        B[2, 2*i]   = dN_dy[i]\n        B[2, 2*i+1] = dN_dx[i]\n    return B\n\ndef element_stiffness(coords, D):\n    # coords: (4,2) array of node coordinates in physical space\n    # 2x2 Gauss quadrature\n    gp = np.array([-1.0/np.sqrt(3.0), 1.0/np.sqrt(3.0)], dtype=float)\n    Ke = np.zeros((8, 8), dtype=float)\n    for xi in gp:\n        for eta in gp:\n            N, dN_dxi, dN_deta = shape_functions_Q4(xi, eta)\n            # Jacobian\n            J = np.zeros((2, 2), dtype=float)\n            # x = sum N_i coords[i,0]; y = sum N_i coords[i,1]\n            # dX/dxi = sum dN_dxi_i X_i ; dX/deta = sum dN_deta_i X_i\n            J[0, 0] = np.dot(dN_dxi, coords[:, 0])  # dx/dxi\n            J[0, 1] = np.dot(dN_deta, coords[:, 0]) # dx/deta\n            J[1, 0] = np.dot(dN_dxi, coords[:, 1])  # dy/dxi\n            J[1, 1] = np.dot(dN_deta, coords[:, 1]) # dy/deta\n            detJ = np.linalg.det(J)\n            invJ = np.linalg.inv(J)\n            # Gradients wrt x,y\n            grad = np.vstack((dN_dxi, dN_deta))  # 2x4\n            dN_dx_dy = invJ @ grad  # 2x4\n            dN_dx = dN_dx_dy[0, :]\n            dN_dy = dN_dx_dy[1, :]\n            B = B_matrix(dN_dx, dN_dy)\n            Ke += (B.T @ D @ B) * detJ  # weight=1 for 2x2\n    return Ke\n\ndef build_mesh(nx, ny, L, H):\n    # Structured grid of (nx * ny) elements, (nx+1)*(ny+1) nodes\n    xs = np.linspace(0.0, L, nx+1)\n    ys = np.linspace(0.0, H, ny+1)\n    nodes = []\n    node_id = {}\n    nid = 0\n    for j in range(ny+1):\n        for i in range(nx+1):\n            nodes.append((xs[i], ys[j]))\n            node_id[(i, j)] = nid\n            nid += 1\n    nodes = np.array(nodes, dtype=float)\n    # Element connectivity: 4 nodes [bl, br, tr, tl]\n    conn = []\n    for j in range(ny):\n        for i in range(nx):\n            bl = node_id[(i, j)]\n            br = node_id[(i+1, j)]\n            tr = node_id[(i+1, j+1)]\n            tl = node_id[(i, j+1)]\n            conn.append([bl, br, tr, tl])\n    conn = np.array(conn, dtype=int)\n    return nodes, conn, node_id\n\ndef assemble_global(nodes, conn, D, nx, ny, L, H, Tx):\n    n_nodes = nodes.shape[0]\n    ndof = 2 * n_nodes\n    K = np.zeros((ndof, ndof), dtype=float)\n    F = np.zeros(ndof, dtype=float)\n    # Assemble element stiffness\n    for e in range(conn.shape[0]):\n        elem_nodes = conn[e]\n        coords = nodes[elem_nodes, :]\n        Ke = element_stiffness(coords, D)\n        # Scatter\n        ldof = []\n        for n in elem_nodes:\n            ldof.extend([2*n, 2*n+1])\n        ldof = np.array(ldof, dtype=int)\n        K[np.ix_(ldof, ldof)] += Ke\n    # Apply right-edge traction Tx via 1D consistent boundary integration on segments\n    # Right edge nodes: i = nx, j = 0..ny\n    right_nodes = [j*(nx+1) + nx for j in range(ny+1)]\n    # Loop segments between consecutive right-edge nodes\n    # Use 2-point Gauss along the segment with linear shape functions\n    gp = np.array([-1.0/np.sqrt(3.0), 1.0/np.sqrt(3.0)], dtype=float)\n    w = np.array([1.0, 1.0], dtype=float)\n    for j in range(ny):\n        n1 = right_nodes[j]\n        n2 = right_nodes[j+1]\n        y1 = nodes[n1, 1]\n        y2 = nodes[n2, 1]\n        x1 = nodes[n1, 0]\n        x2 = nodes[n2, 0]\n        # Segment length\n        seg_len = np.sqrt((x2 - x1)**2 + (y2 - y1)**2)\n        # Jacobian for 1D mapping [-1,1] -> segment\n        J_edge = seg_len / 2.0\n        # Linear shape functions along segment\n        # Nseg = [0.5*(1 - s), 0.5*(1 + s)]\n        for k in range(2):\n            s = gp[k]\n            Nseg = np.array([0.5*(1 - s), 0.5*(1 + s)], dtype=float)\n            # Traction in x-direction only\n            fe_local = Nseg * Tx * J_edge * w[k]\n            # Assemble into global force vector: x-DOFs of n1 and n2\n            F[2*n1] += fe_local[0]\n            F[2*n2] += fe_local[1]\n            # y-DOFs unaffected since Ty=0\n    return K, F\n\ndef apply_dirichlet_bc(K, F, nodes, nx, ny):\n    # Clamp left edge (x=0): both ux=0 and uy=0\n    left_nodes = [j*(nx+1) + 0 for j in range(ny+1)]\n    for n in left_nodes:\n        # ux\n        dof = 2*n\n        K[dof, :] = 0.0\n        K[:, dof] = 0.0\n        K[dof, dof] = 1.0\n        F[dof] = 0.0\n        # uy\n        dof = 2*n + 1\n        K[dof, :] = 0.0\n        K[:, dof] = 0.0\n        K[dof, dof] = 1.0\n        F[dof] = 0.0\n    return K, F\n\ndef solve_case(E, nu, nx, ny, Tx, L, H):\n    nodes, conn, node_id = build_mesh(nx, ny, L, H)\n    D = plane_strain_D(E, nu)\n    K, F = assemble_global(nodes, conn, D, nx, ny, L, H, Tx)\n    K, F = apply_dirichlet_bc(K, F, nodes, nx, ny)\n    # Solve linear system\n    u = np.linalg.solve(K, F)\n    # Average ux along right edge\n    right_nodes = [j*(nx+1) + nx for j in range(ny+1)]\n    ux_vals = [u[2*n] for n in right_nodes]\n    avg_ux = float(np.mean(ux_vals))\n    return avg_ux\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (E, nu, nx, ny, Tx, L, H)\n    test_cases = [\n        (1e6, 0.3,   4,  4, 1e3, 1.0, 1.0),\n        (1e6, 0.3,   8,  8, 1e3, 1.0, 1.0),\n        (1e6, 0.3,  16, 16, 1e3, 1.0, 1.0),\n        (1e6, 0.499, 4,  4, 1e3, 1.0, 1.0),\n        (1e6, 0.499, 8,  8, 1e3, 1.0, 1.0),\n        (1e6, 0.499,16, 16, 1e3, 1.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, nx, ny, Tx, L, H = case\n        avg_ux = solve_case(E, nu, nx, ny, Tx, L, H)\n        results.append(avg_ux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3517463"}]}