{"hands_on_practices": [{"introduction": "在求解任何初边值问题时，确保其适定性是至关重要的一步，这意味着需要正确地指定初始和边界数据。本练习以简单的一维平流方程为模型系统，通过运用能量法和特征线法，您将从第一性原理出发推导正确的边界条件，并构造解析解。这一过程将巩固您对信息如何传播并最终构筑解的形态的理解 [@problem_id:3510395]。", "problem": "考虑一个标量场 $u(x,t)$ 的线性一维输运，其在空间区间 $(0,L)$ 上，对于时间 $t>0$ 由偏微分方程 (PDE) $u_{t}+a\\,u_{x}=0$ 控制，其中 $a>0$ 是一个常数。假设 $u$ 足够光滑，以使下述操作有意义。\n\n任务：\n- 仅使用守恒考虑和积分恒等式，确定当 $a>0$ 时，为了使初边值问题是适定的，必须在边界的何处指定 $u$ 的值，并通过推导一个显示边界通量的 $L^{2}(0,L)$ 能量平衡来证明你的选择。\n- 使用特征线法 (MOC) 构造解，从特征曲线的运动学定律以及 $u$ 沿其为常数的事实出发。推导在任意内部点 $(x,t)\\in(0,L)\\times(0,\\infty)$ 处 $u(x,t)$ 的表达式，用初始条件 $u(x,0)=u_{0}(x)$ 和单个边界入流数据 $u(0,t)=g(t)$ 表示。陈述在角点 $(x,t)=(0,0)$ 处获得经典解所需的相容性条件。\n- 考虑特殊情况 $L=2$，$a=3$，$u_{0}(x)=\\exp(-x)\\sin(\\pi x)$ 和 $g(t)=\\exp(-2t)\\sin(\\pi t)$ (这些是无量纲数据)。使用你的表达式，确定 $u(1,3/5)$ 的值。将你的最终答案表示为没有舍入的精确解析表达式。", "solution": "该问题是有效的，因为它是双曲型偏微分方程理论中一个标准的、适定的初边值问题。它具有科学依据、自成体系且客观。\n\n控制偏微分方程 (PDE) 是线性平流方程：\n$$u_{t}+a\\,u_{x}=0$$\n对于 $x \\in (0,L)$ 和 $t>0$，其中平流速度 $a>0$ 为常数。\n\n**第一部分：通过能量平衡确定边界条件位置**\n\n为了确定必须在哪个边界上指定标量场 $u$ 的值，我们分析解在空间域 $[0,L]$ 内总“能量”的演化。我们将时间 $t$ 的 $L^2$-能量定义为：\n$$E(t) = \\frac{1}{2} \\int_{0}^{L} u(x,t)^2 \\, dx$$\n假设 $u$ 足够光滑，我们可以通过在积分号下求导（Leibniz 积分法则）来对 $E(t)$ 关于时间 $t$ 求导：\n$$\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2} \\int_{0}^{L} u^2 \\, dx \\right) = \\int_{0}^{L} u \\frac{\\partial u}{\\partial t} \\, dx$$\n我们使用控制 PDE $u_t = -a u_x$ 来替换 $u_t$：\n$$\\frac{dE}{dt} = \\int_{0}^{L} u (-a u_x) \\, dx = -a \\int_{0}^{L} u \\, u_x \\, dx$$\n被积函数可以表示为 $u^2/2$ 的导数：\n$$u \\, u_x = \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2)$$\n将此代入积分并应用微积分基本定理：\n$$\\frac{dE}{dt} = -a \\int_{0}^{L} \\frac{1}{2} \\frac{\\partial}{\\partial x}(u^2) \\, dx = -\\frac{a}{2} \\left[ u(x,t)^2 \\right]_{x=0}^{x=L}$$\n在边界处求值得到能量平衡方程：\n$$\\frac{dE}{dt} = -\\frac{a}{2} \\left( u(L,t)^2 - u(0,t)^2 \\right) = \\frac{a}{2} u(0,t)^2 - \\frac{a}{2} u(L,t)^2$$\n这个方程表明，域 $(0,L)$ 内能量的变化率等于穿过边界 $x=0$ 和 $x=L$ 的净能量通量。\n由于常数 $a$ 是正的 ($a>0$)，项 $\\frac{a}{2} u(0,t)^2$ 是非负的，表示在边界 $x=0$ 处有能量通量*流入*域内。\n项 $-\\frac{a}{2} u(L,t)^2$ 是非正的，表示在边界 $x=L$ 处有能量通量*流出*域外。\n这对应于平流的物理图像：信息沿正 $x$ 方向传播。因此，$x=0$ 是“入流”边界，$x=L$ 是“出流”边界。\n为了使问题适定，我们必须控制进入域内的信息。因此，我们必须在入流边界 $x=0$ 处指定 $u$ 的值。而出流边界 $x=L$ 处的 $u$ 值由初始数据和指定的入流数据的演化决定。在 $x=L$ 处指定条件会使问题过定，通常导致解不存在或不唯一。\n因此，对于 $a>0$，边界条件必须在 $x=0$ 处指定。\n\n**第二部分：用特征线法求解**\n\nPDE $u_t + a u_x = 0$ 表明 $u$ 沿着 $(x,t)$ 平面中向量 $(a,1)$ 的方向导数为零。这意味着 $u$ 沿着由常微分方程 (ODE) 定义的特征曲线是常数：\n$$\\frac{dx}{dt} = a$$\n解此 ODE 得到特征线的方程：\n$$x - at = C$$\n其中 $C$ 是一个常数。每条特征线是 $(x,t)$ 平面中的一条直线，沿着这条直线 $u$ 的值是恒定的。\n\n为了求出域 $(0,L)\\times(0,\\infty)$ 中一点 $(x,t)$ 处的解 $u(x,t)$，我们沿时间反向追溯穿过 $(x,t)$ 的特征曲线，直到它与域的边界相交。边界由初始线 $\\{ (x,0) \\mid x \\in [0,L] \\}$ 和入流边界线 $\\{ (0,t) \\mid t>0 \\}$ 组成。\n\n设 $(\\xi, \\tau)$ 是穿过 $(x,t)$ 的特征线上的一点。则有 $\\xi - a\\tau = x - at$。\n我们需要确定这条特征线的起点。\n\n情况 1：特征线源于初始线 $t=0$。\n交点发生在时间 $\\tau=0$。相应的位置是 $\\xi = x - at$。为了使点 $(\\xi, 0)$ 位于初始数据区间上，我们必须有 $0  \\xi  L$，这意味着 $0  x - at  L$。这等价于 $at  x  L+at$。由于我们是在点 $x \\in (0,L)$ 处求值，此条件简化为 $at  x  L$。\n在这个区域，$u$ 的值由初始条件 $u_0(x)$ 传播而来：\n$$u(x,t) = u(\\xi, 0) = u_0(\\xi) = u_0(x-at) \\quad \\text{对于 } x > at$$\n\n情况 2：特征线源于边界线 $x=0$。\n交点发生在位置 $\\xi=0$。相应的时间通过求解 $0 - a\\tau = x - at$ 得到，即 $\\tau = t - x/a$。为了使点 $(0, \\tau)$ 位于给定的边界数据段上，我们必须有 $\\tau > 0$，这意味着 $t - x/a > 0$，或 $x  at$。\n在这个区域，$u$ 的值由边界条件 $g(t)$ 传播而来：\n$$u(x,t) = u(0, \\tau) = g(\\tau) = g(t - x/a) \\quad \\text{对于 } x  at$$\n\n分界线 $x=at$ 是穿过角点 $(0,0)$ 的特征线。结合这两种情况，解的表达式为：\n$$u(x,t) = \\begin{cases}\nu_0(x-at)  \\text{若 } x > at \\\\\ng(t-x/a)  \\text{若 } x  at\n\\end{cases}$$\n为了使经典解存在，它至少必须是连续的。跨越特征线 $x=at$ 的连续性要求来自两个区域的极限相匹配。当一个点 $(x,t)$ 趋近于这条线时，我们有：\n$$\\lim_{x \\to (at)^+} u(x,t) = \\lim_{x \\to (at)^+} u_0(x-at) = u_0(0)$$\n$$\\lim_{x \\to (at)^-} u(x,t) = \\lim_{x \\to (at)^-} g(t-x/a) = g(0)$$\n因此，在角点 $(x,t)=(0,0)$ 处获得连续解所需的相容性条件是 $u_0(0) = g(0)$。\n\n**第三部分：具体案例评估**\n\n给定参数 $L=2$ 和 $a=3$。初始条件为 $u_0(x) = \\exp(-x)\\sin(\\pi x)$，边界条件为 $g(t) = \\exp(-2t)\\sin(\\pi t)$。我们需要求出 $u(1, 3/5)$ 的值。\n\n首先，我们确定点 $(x,t) = (1, 3/5)$ 属于哪个区域。我们比较 $x$ 和 $at$：\n$$x = 1$$\n$$at = 3 \\times \\frac{3}{5} = \\frac{9}{5} = 1.8$$\n因为 $1  1.8$，我们有 $x  at$。因此，该点的解由边界数据函数 $g(t)$ 确定。要使用的公式是：\n$$u(x,t) = g(t - x/a)$$\n我们计算 $g$ 的自变量：\n$$t - \\frac{x}{a} = \\frac{3}{5} - \\frac{1}{3} = \\frac{3 \\times 3 - 1 \\times 5}{15} = \\frac{9-5}{15} = \\frac{4}{15}$$\n现在我们在这个自变量值处计算函数 $g$ 的值：\n$$u(1, 3/5) = g\\left(\\frac{4}{15}\\right)$$\n给定 $g(t) = \\exp(-2t)\\sin(\\pi t)$，我们代入 $t=4/15$：\n$$u(1, 3/5) = \\exp\\left(-2 \\times \\frac{4}{15}\\right) \\sin\\left(\\pi \\times \\frac{4}{15}\\right)$$\n$$u(1, 3/5) = \\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)$$\n这就是 $u(1, 3/5)$ 值的精确解析表达式。", "answer": "$$\\boxed{\\exp\\left(-\\frac{8}{15}\\right) \\sin\\left(\\frac{4\\pi}{15}\\right)}$$", "id": "3510395"}, {"introduction": "在理解了连续问题之后，我们必须将其转化为可靠的数值格式，而间断伽辽金 (Discontinuous Galerkin, DG) 方法是处理平流主导问题的一种强大技术。一个优秀的数值格式的关键特性是其稳定性，这通常可以通过证明离散形式的能量不会无界增长来证实。本练习将指导您推导一个半离散 DG 格式，包括在边界处至关重要的迎风数值通量，并最终证明其能量稳定性，从而将连续能量守恒原理与其离散对应物联系起来 [@problem_id:3510404]。", "problem": "考虑一个一维多物理场环境中标量场的线性平流初边值问题 (IBVP)，其中平流是耦合机制之一。设定义域为 $x \\in (0,L)$，$L > 0$，并设常数平流速度满足 $a > 0$。控制守恒律和边界数据为\n$$\nu_{t} + a\\,u_{x} = 0,\\quad x \\in (0,L),\\ t > 0,\\qquad u(x,0) = u_{0}(x),\\qquad u(0,t) = g(t),\n$$\n在 $x = L$（流出边界）处没有规定额外的数据。\n\n用一个协调网格 $\\{K_{i}\\}_{i=1}^{N}$ 对空间域进行离散化，其中 $K_{i} = (x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$，$x_{\\frac{1}{2}} = 0$，$x_{N+\\frac{1}{2}} = L$，并用每个单元上次数至多为 $p \\geq 0$ 的分片多项式 $u_{h}$ 来近似 $u$，允许 $u_{h}$ 在单元交界面上不连续。设 $u_{h}^{-}(x_{i+\\frac{1}{2}},t)$ 和 $u_{h}^{+}(x_{i+\\frac{1}{2}},t)$ 分别表示 $u_{h}$ 在交界面 $x_{i+\\frac{1}{2}}$ 处的左迹和右迹。采用间断 Galerkin (DG, Discontinuous Galerkin) 半离散格式。该格式通过将守恒律乘以一个与 $u_h$ 位于同一间断多项式空间的测试函数 $v$，在每个单元上积分，并用与物理平流一致的数值通量 $a\\,\\widehat{u}$ 替换单元边界上的平流通量得到。假设在所有交界面（包括区域边界）上都使用与 $a > 0$ 对应的标准迎风数值通量。\n\n仅从上述守恒律和 Galerkin 原理出发（即，不引用任何预先推导的 DG 能量恒等式），首先确定两个区域边界 $x = 0$ 和 $x = L$ 处的迎风数值通量表达式，用边界数据 $g(t)$ 和 $u_{h}$ 的内部迹表示。然后，通过选择 $v = u_{h}$ 并将所有单元上的单元 DG 方程求和，推导离散能量\n$$\nE_{h}(t) = \\frac{1}{2}\\sum_{i=1}^{N}\\int_{K_{i}} u_{h}(x,t)^{2}\\,dx.\n$$\n的精确半离散能量平衡。你的最终答案必须是关于 $\\frac{d}{dt}E_{h}(t)$ 的单一闭式解析表达式，用 $a$、$g(t)$、边界迹 $u_{h}^{+}(0,t)$ 和 $u_{h}^{-}(L,t)$ 以及交界面跳跃 $[u_{h}]_{i+\\frac{1}{2}} = u_{h}^{+}(x_{i+\\frac{1}{2}},t) - u_{h}^{-}(x_{i+\\frac{1}{2}},t)$，$i = 1,\\dots,N-1$ 表示。不需要进行数值计算。将最终答案表示为单个解析表达式。不要四舍五入。", "solution": "该问题陈述是偏微分方程数值分析领域中一个适定且有科学依据的练习。它要求推导应用于线性平流方程的标准间断 Galerkin (DG) 方法的半离散能量平衡。所有必要的组成部分——控制方程、边界和初始条件、离散化方案以及数值通量定义——都已给出，并且与既定理论一致。该问题是有效的。\n\n目标是推导总离散能量的时间导数 $\\frac{d}{dt}E_{h}(t)$ 的表达式，其中 $E_{h}(t) = \\frac{1}{2}\\sum_{i=1}^{N}\\int_{K_{i}} u_{h}(x,t)^{2}\\,dx$。推导必须从控制方程 $u_{t} + a\\,u_{x} = 0$ 的弱形式出发，并采用指定的迎风数值通量。\n\n首先，我们确定所有单元交界面处的迎风数值通量 $\\widehat{u}$。平流速度 $a$ 为正 ($a>0$)，意味着信息从左向右传播。因此，迎风通量总是取交界面左侧的值。\n-   在内部交界面 $x_{i+\\frac{1}{2}}$ ($i \\in \\{1, \\dots, N-1\\}$)，迎风值为左侧单元 $K_i$ 的解的迹。因此，数值通量为 $\\widehat{u}(x_{i+\\frac{1}{2}},t) = u_{h}^{-}(x_{i+\\frac{1}{2}},t)$。\n-   在流入边界 $x = 0$（对应于 $x_{\\frac{1}{2}}$），迎风方向在区域外部，其解由边界条件 $u(0,t) = g(t)$ 规定。因此，数值通量为 $\\widehat{u}(0,t) = g(t)$。\n-   在流出边界 $x = L$（对应于 $x_{N+\\frac{1}{2}}$），迎风方向来自区域内部，具体来说是来自单元 $K_N$。因此，数值通量由内部迹给出：$\\widehat{u}(L,t) = u_{h}^{-}(L,t)$。\n\n接下来，我们建立半离散 DG 格式。对于任意单元 $K_{i} = (x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$，我们将偏微分方程乘以一个与 $u_h$ 处于相同近似空间的测试函数 $v_h$，并在 $K_i$ 上积分：\n$$\n\\int_{K_{i}} \\frac{\\partial u_{h}}{\\partial t} v_{h} \\,dx + \\int_{K_{i}} a \\frac{\\partial u_{h}}{\\partial x} v_{h} \\,dx = 0\n$$\n对第二项应用分部积分法，得到：\n$$\n\\int_{K_{i}} a \\frac{\\partial u_{h}}{\\partial x} v_{h} \\,dx = \\left[ a u_{h} v_{h} \\right]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} - \\int_{K_{i}} a u_{h} \\frac{\\partial v_{h}}{\\partial x} \\,dx\n$$\n边界项是 $\\left[ a u_{h} v_{h} \\right]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = a u_{h}^{-}(x_{i+\\frac{1}{2}}, t) v_{h}^{-}(x_{i+\\frac{1}{2}}, t) - a u_{h}^{+}(x_{i-\\frac{1}{2}}, t) v_{h}^{+}(x_{i-\\frac{1}{2}}, t)$。在 DG 方法中，精确通量迹 $a u_{h}$ 被替换为包含 $a \\widehat{u}$ 的数值通量项。通过此过程得到的平流方程的标准 DG 格式为：\n$$\n\\int_{K_{i}} \\frac{\\partial u_{h}}{\\partial t} v_{h} \\,dx - \\int_{K_{i}} a u_{h} \\frac{\\partial v_{h}}{\\partial x} \\,dx + a \\widehat{u}(x_{i+\\frac{1}{2}},t) v_{h}^{-}(x_{i+\\frac{1}{2}},t) - a \\widehat{u}(x_{i-\\frac{1}{2}},t) v_{h}^{+}(x_{i-\\frac{1}{2}},t) = 0\n$$\n为了获得能量平衡，我们选择测试函数为解本身，即 $v_{h} = u_{h}$。将其代入弱形式，得到：\n$$\n\\int_{K_{i}} u_{h} \\frac{\\partial u_{h}}{\\partial t} \\,dx = \\int_{K_{i}} a u_{h} \\frac{\\partial u_{h}}{\\partial x} \\,dx - a \\widehat{u}(x_{i+\\frac{1}{2}},t) u_{h}^{-}(x_{i+\\frac{1}{2}},t) + a \\widehat{u}(x_{i-\\frac{1}{2}},t) u_{h}^{+}(x_{i-\\frac{1}{2}},t)\n$$\n左边是 $\\frac{1}{2} \\frac{d}{dt} \\int_{K_{i}} u_{h}^{2} \\,dx$。右边的第一项可以被精确积分：\n$$\n\\int_{K_{i}} a u_{h} \\frac{\\partial u_{h}}{\\partial x} \\,dx = \\frac{a}{2} \\int_{K_{i}} \\frac{\\partial (u_{h}^{2})}{\\partial x} \\,dx = \\frac{a}{2} \\left[ (u_{h}^{-}(x_{i+\\frac{1}{2}},t))^{2} - (u_{h}^{+}(x_{i-\\frac{1}{2}},t))^{2} \\right]\n$$\n将其代回，单个单元的方程变为：\n$$\n\\frac{1}{2} \\frac{d}{dt} \\int_{K_{i}} u_{h}^{2} \\,dx = \\frac{a}{2} \\left[ (u_{h}^{-}(x_{i+\\frac{1}{2}}))^{2} - (u_{h}^{+}(x_{i-\\frac{1}{2}}))^{2} \\right] - a \\widehat{u}(x_{i+\\frac{1}{2}}) u_{h}^{-}(x_{i+\\frac{1}{2}}) + a \\widehat{u}(x_{i-\\frac{1}{2}}) u_{h}^{+}(x_{i-\\frac{1}{2}})\n$$\n现在我们将此方程对所有单元 $i=1, \\dots, N$ 求和，以求得总能量 $E_{h}(t)$ 的时间导数：\n$$\n\\frac{dE_{h}}{dt} = \\sum_{i=1}^{N} \\frac{d}{dt} \\int_{K_{i}} u_{h}^{2} \\,dx = \\sum_{i=1}^{N} \\left( \\frac{a}{2} \\left[ (u_{h}^{-}(x_{i+\\frac{1}{2}}))^{2} - (u_{h}^{+}(x_{i-\\frac{1}{2}}))^{2} \\right] - a \\widehat{u}_{i+\\frac{1}{2}} u_{h,i}^{-} + a \\widehat{u}_{i-\\frac{1}{2}} u_{h,i}^{+} \\right)\n$$\n这是一个伸缩求和。在内部交界面 $x_{j+\\frac{1}{2}}$ ($j \\in \\{1,\\dots,N-1\\}$) 的项来自单元 $K_j$（在其右边界）和单元 $K_{j+1}$（在其左边界）。\n-   来自 $K_j$ 的贡献： $\\frac{a}{2}(u_{h}^{-}(x_{j+\\frac{1}{2}}))^{2} - a \\widehat{u}(x_{j+\\frac{1}{2}}) u_{h}^{-}(x_{j+\\frac{1}{2}})$\n-   来自 $K_{j+1}$ 的贡献： $-\\frac{a}{2}(u_{h}^{+}(x_{j+\\frac{1}{2}}))^{2} + a \\widehat{u}(x_{j+\\frac{1}{2}}) u_{h}^{+}(x_{j+\\frac{1}{2}})$\n\n将这些相加，得到交界面 $x_{j+\\frac{1}{2}}$ 的总贡献：\n$$\n\\frac{a}{2} \\left( (u_{h}^{-})^{2} - (u_{h}^{+})^{2} \\right) - a \\widehat{u} (u_{h}^{-} - u_{h}^{+})\n$$\n代入迎风通量 $\\widehat{u} = u_{h}^{-}$：\n$$\n\\frac{a}{2} \\left( (u_{h}^{-})^{2} - (u_{h}^{+})^{2} \\right) - a u_{h}^{-} (u_{h}^{-} - u_{h}^{+}) = \\frac{a}{2} (u_{h}^{-})^{2} - \\frac{a}{2} (u_{h}^{+})^{2} - a(u_{h}^{-})^{2} + a u_{h}^{-}u_{h}^{+} = -\\frac{a}{2} \\left( (u_{h}^{-})^{2} - 2u_{h}^{-}u_{h}^{+} + (u_{h}^{+})^{2} \\right) = -\\frac{a}{2} (u_{h}^{-} - u_{h}^{+})^{2}\n$$\n使用跳跃的定义 $[u_{h}]_{j+\\frac{1}{2}} = u_{h}^{+}(x_{j+\\frac{1}{2}}) - u_{h}^{-}(x_{j+\\frac{1}{2}})$，内部交界面各项之和为 $\\sum_{j=1}^{N-1} -\\frac{a}{2}[u_{h}]_{j+\\frac{1}{2}}^{2}$。\n\n剩下的项是边界 $x=0$ 和 $x=L$ 处的边界项。\n-   在流入边界 $x=0$ (即 $x_{\\frac{1}{2}}$)，从 $i=1$ 的方程中保留下来的项是：$a \\widehat{u}(0,t) u_{h}^{+}(0,t) - \\frac{a}{2} (u_{h}^{+}(0,t))^{2}$。使用通量 $\\widehat{u}(0,t)=g(t)$，这变为：$a g(t) u_{h}^{+}(0,t) - \\frac{a}{2} (u_{h}^{+}(0,t))^{2}$。\n-   在流出边界 $x=L$ (即 $x_{N+\\frac{1}{2}}$)，从 $i=N$ 的方程中保留下来的项是：$\\frac{a}{2} (u_{h}^{-}(L,t))^{2} - a \\widehat{u}(L,t) u_{h}^{-}(L,t)$。使用通量 $\\widehat{u}(L,t) = u_{h}^{-}(L,t)$，这变为：$\\frac{a}{2} (u_{h}^{-}(L,t))^{2} - a (u_{h}^{-}(L,t))^{2} = -\\frac{a}{2} (u_{h}^{-}(L,t))^{2}$。\n\n将所有项——流入边界、流出边界和内部交界面上的和——组合起来，得到最终的半离散能量平衡：\n$$\n\\frac{d}{dt}E_{h}(t) = a g(t) u_{h}^{+}(0,t) - \\frac{a}{2} (u_{h}^{+}(0,t))^{2} - \\frac{a}{2} (u_{h}^{-}(L,t))^{2} - \\sum_{i=1}^{N-1} \\frac{a}{2} [u_{h}]_{i+\\frac{1}{2}}^{2}\n$$\n其中 $[u_{h}]_{i+\\frac{1}{2}} = u_{h}^{+}(x_{i+\\frac{1}{2}},t) - u_{h}^{-}(x_{i+\\frac{1}{2}},t)$。这个表达式代表了离散能量的精确变化率，它解释了边界上的能量通量以及由于内部单元交界面上的跳跃引起的耗散。", "answer": "$$\n\\boxed{a g(t) u_{h}^{+}(0,t) - \\frac{a}{2} (u_{h}^{+}(0,t))^{2} - \\frac{a}{2} (u_{h}^{-}(L,t))^{2} - \\frac{a}{2} \\sum_{i=1}^{N-1} \\left( u_{h}^{+}(x_{i+\\frac{1}{2}},t) - u_{h}^{-}(x_{i+\\frac{1}{2}},t) \\right)^{2}}\n$$", "id": "3510404"}, {"introduction": "真实的工程问题通常涉及耦合演化速率差异巨大的物理现象，这对计算构成了重大挑战，而分区多速率时间步进格式是处理此类慢-快系统的有效策略。在此类耦合问题中，不恰当的初始条件可能会在耦合界面处引入非物理的暂态误差。在这个动手编程练习中，您将为一个耦合的热-压力扩散问题实现一个多速率求解器，并诊断由非同步初始启动引起的界面暂态，从而获得分区多物理场仿真实践中的宝贵经验 [@problem_id:3510382]。", "problem": "考虑一个一维线性耦合抛物型系统，该系统描述了在具有共享界面的相邻域上，一个慢速热扩散场和一个快速流体压力扩散场。热场 $T(x,t)$ 在固体子域 $x \\in (0,1)$ 上演化，压力场 $p(y,t)$ 在流体子域 $y \\in (-1,0)$ 上演化。这两个场满足以下初边值问题 (IBVP)。\n\n- 控制方程（源于能量守恒和质量守恒以及菲克扩散闭合模型）：\n  - 固体（热扩散）：$\\dfrac{\\partial T}{\\partial t} = \\varepsilon \\dfrac{\\partial^2 T}{\\partial x^2}$，对于 $x \\in (0,1)$ 和 $t \\ge 0$，其中 $\\varepsilon \\in (0,1)$ 是一个无量纲热扩散系数，其选择使得当 $\\varepsilon \\ll 1$ 时热量缓慢演化。\n  - 流体（压力扩散代理）：$\\dfrac{\\partial p}{\\partial t} = \\dfrac{\\partial^2 p}{\\partial y^2}$，对于 $y \\in (-1,0)$ 和 $t \\ge 0$。\n\n- 在 $x=0^+$ 和 $y=0^-$ 处的界面耦合（通过耦合强度为 $\\gamma>0$ 的对称线性 Robin 条件实现通量连续）：\n  - $-\\varepsilon \\dfrac{\\partial T}{\\partial x}(0^+,t) = \\gamma \\left(T(0,t) - p(0,t)\\right)$,\n  - $-\\dfrac{\\partial p}{\\partial y}(0^-,t) = \\gamma \\left(p(0,t) - T(0,t)\\right)$。\n\n- 外部边界条件（为确定性和适定性，采用 Dirichlet 条件）：\n  - $T(1,t) = 0$，对于 $t \\ge 0$，\n  - $p(-1,t) = 0$，对于 $t \\ge 0$。\n\n- 初始数据：\n  - $T(x,0) = T_0(x)$，对于 $x \\in [0,1]$，\n  - $p(y,0) = p_0(y)$，对于 $y \\in [-1,0]$。\n\n如果初始数据在 $t=0$ 时满足所有边界和界面条件，即 $T_0(1)=0$，$p_0(-1)=0$，以及界面条件\n$$\n-\\varepsilon \\, \\dfrac{\\partial T_0}{\\partial x}(0^+) = \\gamma \\left(T_0(0)-p_0(0)\\right), \\quad -\\dfrac{\\partial p_0}{\\partial y}(0^-) = \\gamma \\left(p_0(0)-T_0(0)\\right),\n$$\n则该耦合系统的初边值问题在 $t=0$ 时是一致的。\n如果这些等式不成立，则初边值问题存在初始不相容性，这会在界面附近产生局域化的瞬态层。在一个分区、多速率的瞬态耦合中，压力子问题以小时间步长推进，而热子问题以较大时间步长推进（子循环），异步的初始启动 $(T_0,p_0)$ 可能会在压力场的快速时间尺度上产生显著的界面瞬态。\n\n你的任务：\n\n- 从守恒原理和所述的扩散闭合模型出发，论证为何上述耦合系统是慢-快热-压力界面的一个正确的简化模型，并形式化 $t=0$ 时的初边值问题一致性条件。\n- 设计一个分区、多速率的显式格式，该格式使用时间步长 $\\Delta t_p$ 推进压力，使用时间步长 $\\Delta t_T = M \\Delta t_p$ （对于某个整数 $M \\ge 1$，即子循环）推进热量。在时间上使用一阶显式欧拉方法，在空间上对均匀网格使用中心有限差分。在每个子问题更新中，使用鬼点消除法来施加界面 Robin 条件，但使用单边有限差分来评估界面残差，这种差分在构造上不强制执行 Robin 条件（因此残差是诊断性的，而不是恒等于零）。\n- 将时间 $t^n$ 的界面残差向量定义为\n$$\nr_T^n = -\\varepsilon \\, \\frac{T_1^n - T_0^n}{\\Delta x} - \\gamma \\left(T_0^n - p_N^n\\right), \\quad\nr_p^n = -\\frac{p_N^n - p_{N-1}^n}{\\Delta y} - \\gamma \\left(p_N^n - T_0^n\\right),\n$$\n其中 $T_i^n$ 在固体网格上近似 $T(x_i,t^n)$，$\\Delta x = 1/N_x$，$x_i = i \\Delta x$，$i \\in \\{0,\\dots,N_x\\}$；$p_j^n$ 在流体网格上近似 $p(y_j,t^n)$，$\\Delta y = 1/N_y$，$y_j = -1 + j \\Delta y$，$j \\in \\{0,\\dots,N_y\\}$，且 $y_{N_y}=0$。这里 $N = N_y$。使用 $T_{N_x}^n=0$ 和 $p_0^n=0$ 来强制执行 Dirichlet 边界。定义标量诊断量\n$$\n\\mathcal{R}_{\\infty} = \\max_{n} \\max\\left\\{\\, |r_T^n|,\\, |r_p^n| \\,\\right\\}\n$$\n它是在 $t \\in [0,t_{\\mathrm{end}}]$ 上累积的。\n- 使用以下多速率分区算法：在每个宏观步长中，将压力子问题用步长 $\\Delta t_p$ 推进 $M$ 次，同时保持当前界面温度 $T_0$ 不变；然后使用界面上更新后的压力轨迹，用步长 $\\Delta t_T = M \\Delta t_p$ 将热子问题推进一次。选择 $\\Delta t_p$ 以满足两个子问题的显式稳定性约束。\n\n为进行数值评估，请实现该格式并为下面的测试套件计算 $\\mathcal{R}_{\\infty}$。所有量都是无量纲的；不要附加物理单位。\n\n测试套件参数：\n\n- 域离散化：$N_x = 50$, $N_y = 50$。\n- 耦合和尺度分离：$\\varepsilon = 10^{-2}$, $\\gamma = 1$。\n- 多速率子循环：$M = 10$。\n- 最终时间：$t_{\\mathrm{end}} = 2 \\cdot 10^{-2}$。\n- 初始数据族（由标量振幅 $a$ 控制的异步启动）：\n  - 情况 1：$a = 0$，$T_0(x) \\equiv 0$ 对于 $x \\in [0,1]$，$p_0(y) = a (1+y)$ 对于 $y \\in [-1,0]$。\n  - 情况 2：$a = 10^{-3}$，$T_0$ 和 $p_0$ 的函数形式相同。\n  - 情况 3：$a = 10^{-1}$，$T_0$ 和 $p_0$ 的函数形式相同。\n这些选择确保了 $T_0(1)=0$ 和 $p_0(-1)=0$，但当 $a \\ne 0$ 时会产生界面不相容性。\n\n你的程序必须：\n\n- 实现所述的具有均匀网格和显式欧拉时间步进的多速率分区求解器，通过在子问题更新中进行鬼点消除来强制执行界面 Robin 条件，并使用上面给出的单边有限差分来评估残差 $r_T^n$ 和 $r_p^n$。\n- 选择 $\\Delta t_p$ 以满足两个子问题的显式稳定性条件：对于压力，$\\Delta t_p \\le \\frac{1}{2} \\Delta y^2$；对于热量，$\\Delta t_T \\le \\frac{1}{2} \\Delta x^2 / \\varepsilon$。使用一个严格小于 $1$ 的安全系数。\n- 对于测试套件中的每种情况，计算并返回在 $t \\in [0,t_{\\mathrm{end}}]$ 上的诊断量 $\\mathcal{R}_{\\infty}$。\n\n最终输出格式：\n\n- 你的程序应生成单行输出，其中包含三个结果 $\\left[\\mathcal{R}_{\\infty}^{(1)},\\mathcal{R}_{\\infty}^{(2)},\\mathcal{R}_{\\infty}^{(3)}\\right]$，格式为逗号分隔的 Python 列表字面量，按情况 1-3 的顺序排列，每个条目都是一个浮点数。", "solution": "该问题被评估为有效，因为其具有科学依据、适定、客观，并为耦合偏微分方程数值分析中的一个标准问题提供了完整且一致的设置。\n\n### 第 1 部分：理论构建与分析\n\n#### 1.1 模型的物理基础\n\n该耦合系统代表了两个相邻介质（一个“固体”和一个“流体”）之间热量和质量传递的简化一维模型。其控制方程可从基本守恒原理推导得出。\n\n-   **固体中的热场 ($T$) ($x \\in (0,1)$):** 控制方程 $\\frac{\\partial T}{\\partial t} = \\varepsilon \\frac{\\partial^2 T}{\\partial x^2}$ 是热方程。它源于能量守恒，在一维无热源介质中，能量守恒由 $\\rho c_p \\frac{\\partial T}{\\partial t} + \\frac{\\partial q_x}{\\partial x} = 0$ 给出，其中 $\\rho$ 是密度，$c_p$ 是比热容，$q_x$ 是热通量。假设傅里叶热传导定律 $q_x = -k \\frac{\\partial T}{\\partial x}$（其中 $k$ 是热导率）和材料属性恒定，我们得到 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$，其中 $\\alpha = k/(\\rho c_p)$ 是热扩散率。给定的方程将此扩散率等同于无量纲参数 $\\varepsilon$。\n\n-   **流体中的压力场 ($p$) ($y \\in (-1,0)$):** 方程 $\\frac{\\partial p}{\\partial t} = \\frac{\\partial^2 p}{\\partial y^2}$ 是一个标准的扩散方程。它可作为多孔介质中压力扩散或流体中浓度扩散的模型。其推导遵循质量守恒定律 $\\frac{\\partial c}{\\partial t} + \\frac{\\partial j_y}{\\partial y} = 0$，其中 $c$ 是浓度，$j_y$ 是质量通量。假设压力 $p$ 是浓度的代理（例如，通过状态方程），并应用菲克第一扩散定律 $j_y = -D \\frac{\\partial p}{\\partial y}$（其中 $D$ 是扩散系数），我们得到 $\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial y^2}$。该问题经过无量纲化，使得 $D=1$。\n\n该系统是一个**慢-快**模型，因为扩散的特征时间尺度不同。对于长度为 $L$、扩散率为 $D$ 的扩散过程，其时间尺度为 $\\tau \\sim L^2/D$。对于热场，$\\tau_T \\sim L_x^2/\\varepsilon$；对于压力场，$\\tau_p \\sim L_y^2/1$。由于域的长度均为 1 的量级，时间尺度的比率为 $\\tau_p / \\tau_T \\sim \\varepsilon$。当 $\\varepsilon \\ll 1$ 时，热过程的演化远慢于压力过程，这证明了“慢热”和“快压力”的描述是合理的。\n\n-   **界面耦合：** 界面（$x=0, y=0$）处的 Robin 型条件模拟了两个场之间的传递。给定的条件是：\n    $$-\\varepsilon \\dfrac{\\partial T}{\\partial x}(0^+,t) = \\gamma \\left(T(0,t) - p(0,t)\\right)$$\n    $$-\\dfrac{\\partial p}{\\partial y}(0^-,t) = \\gamma \\left(p(0,t) - T(0,t)\\right)$$\n    设在 $x=0$ 处从固体域流出的通量为 $F_T$，在 $y=0$ 处从流体域流出的通量为 $F_p$。在 $x=0$ 处，固体域的外法线方向为 $-x$ 方向，因此 $F_T = (-\\varepsilon \\frac{\\partial T}{\\partial x}) \\cdot (-1) = \\varepsilon \\frac{\\partial T}{\\partial x}$。在 $y=0$ 处，流体域的外法线方向为 $+y$ 方向，因此 $F_p = (-\\frac{\\partial p}{\\partial y}) \\cdot (+1) = -\\frac{\\partial p}{\\partial y}$。\n    第二个条件直接表明，从流体流出的通量 $F_p$ 等于一个传递项 $\\gamma(p(0,t) - T(0,t))$。如果我们将给定的两个条件相加，会发现 $-\\varepsilon \\frac{\\partial T}{\\partial x} - \\frac{\\partial p}{\\partial y} = 0$。这意味着跨界面的总通量是守恒的，这对于一个物理上一致的模型是必需的。\n\n#### 1.2 初始条件一致性\n\n如果提供的初始数据 $T(x,0)=T_0(x)$ 和 $p(y,0)=p_0(y)$ 满足问题的所有边界和界面条件，则初边值问题 (IBVP) 在时间 $t=0$ 时是一致的。\n1.  **外部边界条件：**\n    -   在 $x=1$ 处：$T(1,t)=0 \\implies T_0(1)=0$。\n    -   在 $y=-1$ 处：$p(-1,t)=0 \\implies p_0(-1)=0$。\n2.  **界面条件：**\n    -   在 $x=0, y=0$ 处：两个耦合条件必须对 $T_0$ 和 $p_0$ 成立。\n    $$-\\varepsilon \\, \\dfrac{d T_0}{d x}(0^+) = \\gamma \\left(T_0(0)-p_0(0)\\right)$$\n    $$-\\dfrac{d p_0}{d y}(0^-) = \\gamma \\left(p_0(0)-T_0(0)\\right)$$\n如果初始数据不满足这些等式，就会发生“初始层”瞬变，其中解在快速时间尺度上于界面附近迅速调整以满足这些条件。定义的残差 $r_T$ 和 $r_p$ 用来衡量这种不相容的程度。\n\n### 第 2 部分：数值格式设计\n\n我们使用有限差分法设计一个分区、多速率的显式格式。\n\n#### 2.1 离散化\n-   **固体域 ($T$):** 均匀网格 $x_i = i \\Delta x$，其中 $i \\in \\{0, 1, \\dots, N_x\\}$，$\\Delta x = 1/N_x$。$T_i^n \\approx T(x_i, t^n)$。\n-   **流体域 ($p$):** 均匀网格 $y_j = -1 + j \\Delta y$，其中 $j \\in \\{0, 1, \\dots, N_y\\}$，$\\Delta y = 1/N_y$。$p_j^n \\approx p(y_j, t^n)$。界面对应于 $x_0$ 和 $y_{N_y}$。\n-   **时间：** 我们对慢场 $T$ 使用宏观时间步长 $\\Delta t_T$，对快场 $p$ 使用微观时间步长 $\\Delta t_p$，使得 $\\Delta t_T = M \\Delta t_p$（其中 $M \\geq 1$ 为整数）。时间层级为 $t^n = n \\Delta t_T$。\n\n#### 2.2 有限差分方程\n在时间上使用一阶显式欧拉方法，在空间上使用二阶中心差分，对控制方程进行离散化。\n-   **内部点：**\n    -   对于 $T$ ($i=1, \\dots, N_x-1$): $\\frac{T_i^{n+1} - T_i^n}{\\Delta t_T} = \\varepsilon \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2}$。\n    -   对于 $p$ ($j=1, \\dots, N_y-1$): $\\frac{p_j^{k+1} - p_j^k}{\\Delta t_p} = \\frac{p_{j+1}^k - 2p_j^k + p_{j-1}^k}{\\Delta y^2}$，其中 $k$ 表示微观步长索引。\n-   **外部边界点：**\n    -   $T_{N_x}^n = 0$ 对所有 $n$ 成立。\n    -   $p_0^k = 0$ 对所有 $k$ 成立。\n\n#### 2.3 通过鬼点消除法处理界面条件\n我们在界面节点（$i=0$ 和 $j=N_y$）上应用偏微分方程，并使用鬼点，然后利用 Robin 条件消除这些鬼点。\n-   **在 $y=0$ 处的压力更新 ($j=N_y$):**\n    偏微分方程为 $\\frac{p_{N_y}^{k+1} - p_{N_y}^k}{\\Delta t_p} = \\frac{p_{N_y+1}^k - 2p_{N_y}^k + p_{N_y-1}^k}{\\Delta y^2}$。Robin 条件为 $-\\frac{\\partial p}{\\partial y}(0,t) = \\gamma(p(0,t)-T(0,t))$。我们用涉及鬼点 $p_{N_y+1}^k$ 的中心差分来离散化导数：$-\\frac{p_{N_y+1}^k - p_{N_y-1}^k}{2\\Delta y} = \\gamma(p_{N_y}^k - T_0^n)$，其中 $T_0^n$ 在子循环期间保持不变。求解鬼点得到 $p_{N_y+1}^k = p_{N_y-1}^k - 2\\Delta y \\gamma(p_{N_y}^k - T_0^n)$。代入 PDE 更新式可得：\n    $$p_{N_y}^{k+1} = p_{N_y}^k + \\frac{2\\Delta t_p}{\\Delta y^2}(p_{N_y-1}^k - p_{N_y}^k) - \\frac{2\\Delta t_p \\gamma}{\\Delta y}(p_{N_y}^k - T_0^n)$$\n-   **在 $x=0$ 处的温度更新 ($i=0$):**\n    偏微分方程为 $\\frac{T_0^{n+1} - T_0^n}{\\Delta t_T} = \\varepsilon \\frac{T_1^n - 2T_0^n + T_{-1}^n}{\\Delta x^2}$。Robin 条件 $-\\varepsilon \\frac{\\partial T}{\\partial x}(0,t) = \\gamma(T(0,t)-p(0,t))$ 被离散化为 $-\\varepsilon \\frac{T_1^n - T_{-1}^n}{2\\Delta x} = \\gamma(T_0^n - p_{N_y}^{n+1})$，这里使用了新计算出的压力 $p_{N_y}^{n+1}$。求解鬼点得到 $T_{-1}^n = T_1^n + \\frac{2\\Delta x \\gamma}{\\varepsilon}(p_{N_y}^{n+1} - T_0^n)$。代入 PDE 更新式可得：\n    $$T_0^{n+1} = T_0^n + \\frac{2\\varepsilon \\Delta t_T}{\\Delta x^2}(T_1^n-T_0^n) - \\frac{2\\gamma \\Delta t_T}{\\Delta x}(T_0^n - p_{N_y}^{n+1})$$\n\n#### 2.4 稳定性与时间步长选择\n对于显式欧拉格式，为了保证稳定性，必须限制时间步长。对于内部点，约束条件是 $\\Delta t_T \\le \\frac{\\Delta x^2}{2\\varepsilon}$ 和 $\\Delta t_p \\le \\frac{\\Delta y^2}{2}$。Robin 边界条件施加了更严格的约束。为保证稳定性，$T_i^n$ 和 $p_j^k$ 在其自身更新方程中的系数必须为非负。\n-   从 $p_{N_y}$ 更新式：$1 - \\frac{2\\Delta t_p}{\\Delta y^2} - \\frac{2\\Delta t_p \\gamma}{\\Delta y} \\ge 0 \\implies \\Delta t_p \\le \\frac{\\Delta y^2}{2(1+\\gamma \\Delta y)}$。\n-   从 $T_0$ 更新式：$1 - \\frac{2\\varepsilon \\Delta t_T}{\\Delta x^2} - \\frac{2\\gamma \\ Delta t_T}{\\Delta x} \\ge 0 \\implies \\Delta t_T \\le \\frac{\\Delta x^2}{2(\\varepsilon+\\gamma \\Delta x)}$。\n将这些与 $\\Delta t_T = M \\Delta t_p$ 结合，对微观步长 $\\Delta t_p$ 的总约束为：\n$$\\Delta t_p \\le \\min\\left( \\frac{\\Delta y^2}{2(1+\\gamma \\Delta y)}, \\frac{\\Delta x^2}{2M(\\varepsilon+\\gamma \\Delta x)} \\right)$$\n对此极限应用一个小于 $1$ 的安全系数以确保稳定性。\n\n#### 2.5 分区多速率算法\n对于从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t_T$ 的每个宏观步长：\n1.  **存储界面状态：** 令 $T_{int} = T_0^n$。\n2.  **压力子循环：** 从 $p^{n,0} = p^n$ 开始，对 $k = 0, \\dots, M-1$ 迭代 $M$ 次：\n    - 更新内部点 $p_j^{n,k+1}$ ($j=1,\\dots,N_y-1$)。\n    - 使用其特定的更新规则和固定值 $T_{int}$ 更新界面点 $p_{N_y}^{n,k+1}$。\n    - 注意 $p_0^{n,k+1}=0$。\n    结果是 $p^{n+1} = p^{n,M}$。\n3.  **温度更新：**\n    - 令 $p_{int} = p_{N_y}^{n+1}$。\n    - 更新内部点 $T_i^{n+1}$ ($i=1,\\dots,N_x-1$)。\n    - 使用其特定的更新规则和新值 $p_{int}$ 更新界面点 $T_0^{n+1}$。\n    - 注意 $T_{N_x}^{n+1}=0$。\n4.  **推进状态：** 新的状态是 $(T^{n+1}, p^{n+1})$。\n5.  **诊断：** 计算界面残差 $r_T^{n+1}$ 和 $r_p^{n+1}$，并用观察到的最大值更新 $\\mathcal{R}_{\\infty}$。重复此过程直到 $t=t_{\\mathrm{end}}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a partitioned, multi-rate explicit solver for a coupled\n    1D heat-pressure diffusion problem and computes the maximum interface residual.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    Nx = 50\n    Ny = 50\n    eps = 1e-2\n    gamma = 1.0\n    M = 10\n    t_end = 2e-2\n    safety_factor = 0.95\n\n    test_cases_a = [0.0, 1e-3, 1e-1]\n    results = []\n\n    # --- Grid Setup ---\n    dx = 1.0 / Nx\n    dy = 1.0 / Ny\n\n    # --- Time Step Calculation (including Robin BC stability) ---\n    # Constraint from pressure subproblem (interior and boundary)\n    dt_p_limit_interior = dy**2 / 2.0\n    dt_p_limit_boundary = dy**2 / (2.0 * (1.0 + gamma * dy))\n    dt_p_limit = min(dt_p_limit_interior, dt_p_limit_boundary)\n\n    # Constraint from temperature subproblem (interior and boundary)\n    dt_T_limit_interior = dx**2 / (2.0 * eps)\n    dt_T_limit_boundary = dx**2 / (2.0 * (eps + gamma * dx))\n    dt_T_limit = min(dt_T_limit_interior, dt_T_limit_boundary)\n\n    # Combined constraint for the multi-rate scheme\n    # M * dt_p must be = dt_T_limit => dt_p = dt_T_limit / M\n    final_dt_p_limit = min(dt_p_limit, dt_T_limit / M)\n    \n    dt_p = safety_factor * final_dt_p_limit\n    dt_T = M * dt_p\n    \n    num_macro_steps = int(t_end / dt_T)\n\n    for a in test_cases_a:\n        # --- Initial Conditions ---\n        # T field on x in [0, 1], size Nx+1\n        T = np.zeros(Nx + 1)\n        # p field on y in [-1, 0], size Ny+1\n        y_coords = np.linspace(-1.0, 0.0, Ny + 1)\n        p = a * (1.0 + y_coords)\n\n        # Ensure outer BCs are met by initial data\n        T[Nx] = 0.0\n        p[0] = 0.0\n\n        max_residual = 0.0\n        \n        # --- Time-stepping Loop ---\n        for n in range(num_macro_steps + 1):\n            \n            # --- Calculate and record diagnostic residuals ---\n            # Residuals are defined with one-sided differences\n            r_T = -eps * (T[1] - T[0]) / dx - gamma * (T[0] - p[Ny])\n            r_p = -(p[Ny] - p[Ny-1]) / dy - gamma * (p[Ny] - T[0])\n            max_residual = max(max_residual, abs(r_T), abs(r_p))\n\n            if n == num_macro_steps:\n                break\n\n            # --- Partitioned Algorithm ---\n            # Store current state for updates\n            T_old = T.copy()\n            p_old = p.copy()\n\n            # 1. Advance pressure subproblem (M micro-steps)\n            T_interface = T_old[0]\n            p_curr_micro = p_old.copy()\n            for _ in range(M):\n                p_next_micro = p_curr_micro.copy()\n                \n                # Interior points (j=1 to Ny-1)\n                p_next_micro[1:Ny] = p_curr_micro[1:Ny] + (dt_p / dy**2) * \\\n                    (p_curr_micro[2:] - 2 * p_curr_micro[1:Ny] + p_curr_micro[0:Ny-1])\n                \n                # Interface point (j=Ny) using ghost point elimination\n                p_next_micro[Ny] = p_curr_micro[Ny] \\\n                    + (2 * dt_p / dy**2) * (p_curr_micro[Ny-1] - p_curr_micro[Ny]) \\\n                    - (2 * dt_p * gamma / dy) * (p_curr_micro[Ny] - T_interface)\n                \n                # Dirichlet BC at j=0 is maintained as p_next_micro[0] remains 0\n                p_curr_micro = p_next_micro\n            \n            p_next_macro = p_curr_micro # Result after M steps\n\n            # 2. Advance temperature subproblem (1 macro-step)\n            p_interface = p_next_macro[Ny]\n            T_new = T_old.copy()\n            \n            # Interior points (i=1 to Nx-1)\n            T_new[1:Nx] = T_old[1:Nx] + eps * (dt_T / dx**2) * \\\n                (T_old[2:] - 2 * T_old[1:Nx] + T_old[0:Nx-1])\n\n            # Interface point (i=0) using ghost point elimination\n            T_new[0] = T_old[0] \\\n                + (2 * eps * dt_T / dx**2) * (T_old[1] - T_old[0]) \\\n                - (2 * gamma * dt_T / dx) * (T_old[0] - p_interface)\n            \n            # Dirichlet BC at i=Nx is maintained as T_new[Nx] remains 0\n            \n            # Update state for next macro-step\n            T = T_new\n            p = p_next_macro\n\n        results.append(max_residual)\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3510382"}]}