{"hands_on_practices": [{"introduction": "掌握数值方法的第一步是量化其精度。本练习将使用泰勒级数展开这一基本工具，来分析二阶导数最常用的有限差分近似的局部截断误差，这是许多地球物理波动方程中的基本构件。通过本练习，您将正式地理解“精度阶”这一核心概念，并为评估和比较不同数值格式奠定基础。[@problem_id:3612404]", "problem": "在一维地震波传播模型中，位移场 $u(x)$ 的空间二阶导数出现在声波方程中，通常使用均匀网格上的有限差分法进行近似。设 $u(x)$ 是一个表示位移的标量场，并假设其在包含网格节点 $x_{i}$ 的开区间内足够光滑，至少具有四阶连续导数。在间距为 $h>0$ 的均匀网格上，用于二阶导数的标准中心二阶有限差分算子 $\\mathcal{L}_{h}$ 在节点 $x_{i}$ 处的定义为\n$$\n\\mathcal{L}_{h}u(x_{i}) \\equiv \\frac{u(x_{i}+h) - 2u(x_{i}) + u(x_{i}-h)}{h^{2}}.\n$$\n连续算子 $\\mathcal{L}$ 为 $\\mathcal{L}u(x) \\equiv u''(x)$。局部截断误差 (LTE)，记为 $\\tau(x_{i};h)$，定义为 $\\tau(x_{i};h) \\equiv \\mathcal{L}_{h}u(x_{i}) - \\mathcal{L}u(x_{i})$。以泰勒级数展开为基础，并利用大O符号的定义（其中当 $h \\to 0$ 时，$f(h) = O(h^{p})$ 表示存在常数 $C>0$ 和 $h_{0}>0$ 使得对于所有 $0  h  h_0$ 都有 $|f(h)| \\le C h^p$），推导出该格式的局部截断误差的主阶项，并确定其精度阶。", "solution": "该问题要求推导二阶导数的标准中心有限差分近似的局部截断误差 (LTE) 的主阶项。LTE，记为 $\\tau(x_{i};h)$，定义为有限差分算子 $\\mathcal{L}_{h}$ 与连续微分算子 $\\mathcal{L}$ 作用于一个足够光滑的函数 $u(x)$ 上的差值。\n\n给定的算子是：\n连续算子：$\\mathcal{L}u(x_{i}) = u''(x_{i})$。\n离散有限差分算子：\n$$\n\\mathcal{L}_{h}u(x_{i}) = \\frac{u(x_{i}+h) - 2u(x_{i}) + u(x_{i}-h)}{h^{2}}\n$$\n因此，局部截断误差为：\n$$\n\\tau(x_{i};h) = \\mathcal{L}_{h}u(x_{i}) - \\mathcal{L}u(x_{i}) = \\frac{u(x_{i}+h) - 2u(x_{i}) + u(x_{i}-h)}{h^{2}} - u''(x_{i})\n$$\n为了分析这个表达式，我们对项 $u(x_{i}+h)$ 和 $u(x_{i}-h)$ 在点 $x_{i}$ 周围进行泰勒级数展开。问题指出函数 $u(x)$ 至少具有四阶连续导数，这使我们能够将级数展开到包含四阶导数项以及一个更高阶的余项。\n\n$u(x_{i}+h)$ 在 $x_{i}$ 周围的泰勒级数展开为：\n$$\nu(x_{i}+h) = u(x_{i}) + h u'(x_{i}) + \\frac{h^{2}}{2!} u''(x_{i}) + \\frac{h^{3}}{3!} u'''(x_{i}) + \\frac{h^{4}}{4!} u^{(4)}(x_{i}) + O(h^{5})\n$$\n$u(x_{i}-h)$ 在 $x_{i}$ 周围的泰勒级数展开为：\n$$\nu(x_{i}-h) = u(x_{i}) - h u'(x_{i}) + \\frac{h^{2}}{2!} u''(x_{i}) - \\frac{h^{3}}{3!} u'''(x_{i}) + \\frac{h^{4}}{4!} u^{(4)}(x_{i}) - O(h^{5})\n$$\n我们将这些展开式代入有限差分算子的分子 $u(x_{i}+h) - 2u(x_{i}) + u(x_{i}-h)$ 中：\n\\begin{align*}\n \\left( u(x_{i}) + h u'(x_{i}) + \\frac{h^{2}}{2} u''(x_{i}) + \\frac{h^{3}}{6} u'''(x_{i}) + \\frac{h^{4}}{24} u^{(4)}(x_{i}) + O(h^{5}) \\right) \\\\\n-  2u(x_{i}) \\\\\n+  \\left( u(x_{i}) - h u'(x_{i}) + \\frac{h^{2}}{2} u''(x_{i}) - \\frac{h^{3}}{6} u'''(x_{i}) + \\frac{h^{4}}{24} u^{(4)}(x_{i}) - O(h^{5}) \\right)\n\\end{align*}\n按导数阶数组合同类项：\n- 零阶导数项：$u(x_{i}) - 2u(x_{i}) + u(x_{i}) = 0$。\n- 一阶导数项：$h u'(x_{i}) - h u'(x_{i}) = 0$。\n- 二阶导数项：$\\frac{h^{2}}{2} u''(x_{i}) + \\frac{h^{2}}{2} u''(x_{i}) = h^{2} u''(x_{i})$。\n- 三阶导数项：$\\frac{h^{3}}{6} u'''(x_{i}) - \\frac{h^{3}}{6} u'''(x_{i}) = 0$。\n- 四阶导数项：$\\frac{h^{4}}{24} u^{(4)}(x_{i}) + \\frac{h^{4}}{24} u^{(4)}(x_{i}) = \\frac{2h^{4}}{24} u^{(4)}(x_{i}) = \\frac{h^{4}}{12} u^{(4)}(x_{i})$。\n- 更高阶项：奇数次幂的项，例如涉及 $u^{(5)}(x_{i})$ 的项，将以与一阶和三阶导数项类似的方式抵消。合并级数中的下一个非零项将来自六阶导数，其阶数为 $h^6$。因此，余项为 $O(h^{6})$。\n\n分子简化为：\n$$\nu(x_{i}+h) - 2u(x_{i}) + u(x_{i}-h) = h^{2} u''(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + O(h^{6})\n$$\n现在，我们将其代回离散算子 $\\mathcal{L}_{h}u(x_{i})$ 的表达式中：\n$$\n\\mathcal{L}_{h}u(x_{i}) = \\frac{1}{h^{2}} \\left( h^{2} u''(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + O(h^{6}) \\right) = u''(x_{i}) + \\frac{h^{2}}{12} u^{(4)}(x_{i}) + O(h^{4})\n$$\n最后，我们计算局部截断误差 $\\tau(x_{i};h)$：\n$$\n\\tau(x_{i};h) = \\mathcal{L}_{h}u(x_{i}) - u''(x_{i}) = \\left( u''(x_{i}) + \\frac{h^{2}}{12} u^{(4)}(x_{i}) + O(h^{4}) \\right) - u''(x_{i})\n$$\n$$\n\\tau(x_{i};h) = \\frac{h^{2}}{12} u^{(4)}(x_{i}) + O(h^{4})\n$$\n根据这个结果，我们可以得出题目所要求的两个结论。首先，截断误差的主阶项是 $\\frac{h^{2}}{12} u^{(4)}(x_{i})$。其次，根据大O符号的定义，由于当 $h \\to 0$ 时误差由与 $h^2$ 成正比的项主导（假设 $u^{(4)}(x_{i}) \\neq 0$），局部截断误差的阶为 $h^2$，即 $\\tau(x_{i};h) = O(h^{2})$。这证实了该有限差分格式是二阶精度的。\n\n局部截断误差的主项的显式符号表达式是决定精度阶数的项。", "answer": "$$\\boxed{\\frac{h^{2}}{12} u^{(4)}(x_{i})}$$", "id": "3612404"}, {"introduction": "在理解了如何分析现有格式之后，我们可以更进一步，着手设计具有特定性质的新格式。本练习要求您构建一个高阶单边差分格式，这在精确处理模拟区域的边界条件时是一项常见任务。这个过程演示了如何主动运用误差抵消的原理来开发满足特定工程需求的数值格式。[@problem_id:3612464]", "problem": "在用于地下成像的地震波场模拟中，考虑一个一维平流输运项，该项需要在流入边界附近评估空间导数 $u'(x)$，此处仅有下游网格点可用。设 $x_i$ 为均匀网格（间距 $h0$）上邻近边界的网格节点，并假设 $u(x_i)$、$u(x_{i+1})$、$u(x_{i+2})$ 和 $u(x_{i+3})$ 的值已知。设计一个单侧三阶精度的有限差分(FD)格式，利用这四个点来近似 $u'(x_i)$。从 $u(x)$ 在 $x_i$ 点的泰勒级数展开出发，通过系统地施加条件来消除低阶截断误差项。然后，通过使用大O表示法确定截断误差中的第一个非零项，来验证其精度阶数。具体而言：\n- 推导系数 $a_0$、$a_1$、$a_2$ 和 $a_3$，使得近似式\n$$D_h u(x_i) = \\frac{1}{h}\\left(a_0\\,u(x_i) + a_1\\,u(x_{i+1}) + a_2\\,u(x_{i+2}) + a_3\\,u(x_{i+3})\\right)$$\n对于均匀网格上的 $u'(x_i)$ 具有三阶精度。\n- 确定标量常数 $c$，使得领先的截断误差具有形式\n$$D_h u(x_i) - u'(x_i) = c\\,h^{3}\\,u^{(4)}(x_i) + \\mathcal{O}\\!\\left(h^{4}\\right).$$\n将你的最终答案表示为一个包含精确系数 $(a_0,\\;a_1,\\;a_2,\\;a_3)$ 和标量 $c$ 的行向量，使用精确的分数值且不进行四舍五入。最终答案中不需要物理单位。", "solution": "问题要求使用均匀网格上的四个点 $x_i$、$x_{i+1}$、$x_{i+2}$ 和 $x_{i+3}$ 推导一个用于一阶导数 $u'(x_i)$ 的单侧三阶精度有限差分格式。网格间距为 $h$。该近似式具有以下形式：\n$$D_h u(x_i) = \\frac{1}{h}\\left(a_0\\,u(x_i) + a_1\\,u(x_{i+1}) + a_2\\,u(x_{i+2}) + a_3\\,u(x_{i+3})\\right)$$\n我们将通过对函数 $u(x)$ 在点 $x_i$ 周围进行泰勒级数展开来确定系数 $a_0, a_1, a_2, a_3$ 和领先的截断误差常数 $c$。我们假设 $u(x)$ 足够光滑，具体来说，至少是四次连续可微的（$C^4$）。\n\n$u(x_{i+k}) = u(x_i + kh)$ 在 $x_i$ 点的泰勒级数展开为：\n$$u(x_{i+1}) = u(x_i) + h\\,u'(x_i) + \\frac{h^2}{2}u''(x_i) + \\frac{h^3}{6}u'''(x_i) + \\frac{h^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^5)$$\n$$u(x_{i+2}) = u(x_i) + (2h)u'(x_i) + \\frac{(2h)^2}{2}u''(x_i) + \\frac{(2h)^3}{6}u'''(x_i) + \\frac{(2h)^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^5)$$\n$$u(x_{i+3}) = u(x_i) + (3h)u'(x_i) + \\frac{(3h)^2}{2}u''(x_i) + \\frac{(3h)^3}{6}u'''(x_i) + \\frac{(3h)^4}{24}u^{(4)}(x_i) + \\mathcal{O}(h^5)$$\n\n我们将这些展开式代入有限差分近似表达式中，并乘以 $h$：\n$$h D_h u(x_i) = a_0\\,u(x_i) + a_1\\,u(x_{i+1}) + a_2\\,u(x_{i+2}) + a_3\\,u(x_{i+3})$$\n代入级数：\n$$h D_h u(x_i) = a_0\\,u(x_i) + a_1\\left( u(x_i) + h\\,u' + \\frac{h^2}{2}u'' + \\frac{h^3}{6}u''' + \\dots \\right) \\\\ + a_2\\left( u(x_i) + 2h\\,u' + \\frac{4h^2}{2}u'' + \\frac{8h^3}{6}u''' + \\dots \\right) \\\\ + a_3\\left( u(x_i) + 3h\\,u' + \\frac{9h^2}{2}u'' + \\frac{27h^3}{6}u''' + \\dots \\right)$$\n其中 $u', u'', \\dots$ 表示在 $x_i$ 点计算的导数。\n\n接下来，我们收集包含 $u(x_i)$ 及其导数的项的系数：\n$$h D_h u(x_i) = u(x_i)\\left[a_0 + a_1 + a_2 + a_3\\right] \\\\ + h\\,u'(x_i)\\left[a_1 + 2a_2 + 3a_3\\right] \\\\ + h^2\\,u''(x_i)\\left[\\frac{1}{2}a_1 + \\frac{4}{2}a_2 + \\frac{9}{2}a_3\\right] \\\\ + h^3\\,u'''(x_i)\\left[\\frac{1}{6}a_1 + \\frac{8}{6}a_2 + \\frac{27}{6}a_3\\right] \\\\ + h^4\\,u^{(4)}(x_i)\\left[\\frac{1}{24}a_1 + \\frac{16}{24}a_2 + \\frac{81}{24}a_3\\right] + \\mathcal{O}(h^5)$$\n\n我们希望近似值 $D_h u(x_i)$ 等于 $u'(x_i)$，且误差阶数为 $\\mathcal{O}(h^3)$。这意味着 $h D_h u(x_i)$ 必须近似 $h u'(x_i)$，且误差阶数为 $\\mathcal{O}(h^4)$。为实现此目标，我们设置右侧各项的系数以匹配期望的表达式 $h u'(x_i)$。\n1.  $u(x_i)$ 的系数必须为 $0$：\n    $a_0 + a_1 + a_2 + a_3 = 0$\n2.  $h u'(x_i)$ 的系数必须为 $1$：\n    $a_1 + 2a_2 + 3a_3 = 1$\n3.  $h^2 u''(x_i)$ 的系数必须为 $0$，以消除 $D_h u(x_i)$ 中的 $\\mathcal{O}(h)$ 误差项：\n    $\\frac{1}{2}(a_1 + 4a_2 + 9a_3) = 0 \\implies a_1 + 4a_2 + 9a_3 = 0$\n4.  $h^3 u'''(x_i)$ 的系数必须为 $0$，以消除 $D_h u(x_i)$ 中的 $\\mathcal{O}(h^2)$ 误差项：\n    $\\frac{1}{6}(a_1 + 8a_2 + 27a_3) = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n\n这给出了一个关于四个系数的四元线性方程组。我们首先求解后三个方程以得到 $a_1, a_2, a_3$：\n(A) $a_1 + 2a_2 + 3a_3 = 1$\n(B) $a_1 + 4a_2 + 9a_3 = 0$\n(C) $a_1 + 8a_2 + 27a_3 = 0$\n\n方程 (B) 减去方程 (A)：\n$(a_1 + 4a_2 + 9a_3) - (a_1 + 2a_2 + 3a_3) = 0 - 1 \\implies 2a_2 + 6a_3 = -1$ (D)\n\n方程 (C) 减去方程 (B)：\n$(a_1 + 8a_2 + 27a_3) - (a_1 + 4a_2 + 9a_3) = 0 - 0 \\implies 4a_2 + 18a_3 = 0 \\implies 2a_2 + 9a_3 = 0$ (E)\n\n现在我们使用 (D) 和 (E) 求解 $a_2$ 和 $a_3$ 的方程组。方程 (E) 减去方程 (D)：\n$(2a_2 + 9a_3) - (2a_2 + 6a_3) = 0 - (-1) \\implies 3a_3 = 1 \\implies a_3 = \\frac{1}{3}$。\n\n将 $a_3 = \\frac{1}{3}$ 代入方程 (E)：\n$2a_2 + 9\\left(\\frac{1}{3}\\right) = 0 \\implies 2a_2 + 3 = 0 \\implies a_2 = -\\frac{3}{2}$。\n\n将 $a_2 = -\\frac{3}{2}$ 和 $a_3 = \\frac{1}{3}$ 代入方程 (A)：\n$a_1 + 2\\left(-\\frac{3}{2}\\right) + 3\\left(\\frac{1}{3}\\right) = 1 \\implies a_1 - 3 + 1 = 1 \\implies a_1 = 3$。\n\n最后，使用方程组的第一个方程来求解 $a_0$：\n$a_0 + a_1 + a_2 + a_3 = 0 \\implies a_0 + 3 - \\frac{3}{2} + \\frac{1}{3} = 0$。\n为了求解 $a_0$，我们使用公分母 $6$：\n$a_0 + \\frac{18}{6} - \\frac{9}{6} + \\frac{2}{6} = 0 \\implies a_0 + \\frac{11}{6} = 0 \\implies a_0 = -\\frac{11}{6}$。\n\n推导出的系数为：\n$a_0 = -\\frac{11}{6}$，$a_1 = 3$，$a_2 = -\\frac{3}{2}$，$a_3 = \\frac{1}{3}$。\n\n现在，我们确定领先的截断误差。根据我们的构造，含有 $h^2 u''$ 和 $h^3 u'''$ 的项为零。$h D_h u(x_i)$ 展开式中第一个非零误差项是与 $h^4 u^{(4)}(x_i)$ 相关的那一项。该项的系数是：\n$$C_4 = \\frac{h^4}{24}(a_1 + 16a_2 + 81a_3)$$\n代入系数的值：\n$$a_1 + 16a_2 + 81a_3 = 3 + 16\\left(-\\frac{3}{2}\\right) + 81\\left(\\frac{1}{3}\\right) = 3 - 24 + 27 = 6$$\n所以，$h D_h u(x_i)$ 展开式中的领先误差项是 $\\frac{h^4}{24} (6) u^{(4)}(x_i) = \\frac{1}{4}h^4 u^{(4)}(x_i)$。\n\n$h D_h u(x_i)$ 的完整展开式为：\n$$h D_h u(x_i) = h u'(x_i) + \\frac{1}{4} h^4 u^{(4)}(x_i) + \\mathcal{O}(h^5)$$\n两边除以 $h$ 得到 $D_h u(x_i)$ 的近似式：\n$$D_h u(x_i) = u'(x_i) + \\frac{1}{4} h^3 u^{(4)}(x_i) + \\mathcal{O}(h^4)$$\n截断误差定义为 $T_h = D_h u(x_i) - u'(x_i)$。因此，\n$$T_h = \\frac{1}{4} h^3 u^{(4)}(x_i) + \\mathcal{O}(h^4)$$\n问题给出的领先误差形式为 $c h^3 u^{(4)}(x_i)$。通过比较，我们确定常数 $c$：\n$c = \\frac{1}{4}$。\n\n系数组为 $(a_0, a_1, a_2, a_3) = \\left(-\\frac{11}{6}, 3, -\\frac{3}{2}, \\frac{1}{3}\\right)$，误差常数为 $c = \\frac{1}{4}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{11}{6}   3  -\\frac{3}{2}  \\frac{1}{3}  \\frac{1}{4}\n\\end{pmatrix}\n}\n$$", "id": "3612464"}, {"introduction": "“精度阶”是描述数值格式性能的有力指标，但它并不能完全反映格式的所有特性，尤其是在模拟波动现象时。本练习通过比较两种具有相同形式精度阶的格式，揭示了它们在数值频散特性上的显著差异。理解这种差异对于选择合适的格式以确保地球物理波场模拟的保真度至关重要。[@problem_id:3612459]", "problem": "考虑一个一维窄带声波波包，其在非均匀地壳中沿某一优先方向的包络输运可由线性平流方程 $u_{t} + a\\,u_{x} = 0$ 进行局部近似，其中 $a0$ 为恒定的群速度。设计算域在具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上离散，并定义 Courant-Friedrichs-Lewy (CFL) 数 $\\nu = a\\,\\Delta t / \\Delta x$。构造两种显式有限差分格式，它们都具有二阶全局截断误差 $\\mathcal{O}(\\Delta t^{2}, \\Delta x^{2})$，但产生不同的修正方程：\n- 格式 $\\mathrm{LW}$ (Lax–Wendroff): \n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{i+1}^{n} - 2\\,u_{i}^{n} + u_{i-1}^{n}\\right).$$\n- 格式 $\\mathrm{BW}$ (Beam–Warming 迎风格式，对于 $a0$):\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(3\\,u_{i}^{n} - 4\\,u_{i-1}^{n} + u_{i-2}^{n}\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u_{i}^{n} - 2\\,u_{i-1}^{n} + u_{i-2}^{n}\\right).$$\n从平面波拟设 $u_{i}^{n} = \\hat{u}\\,\\exp\\!\\big(i\\,k\\,i\\,\\Delta x\\big)$ 和 $\\nu$ 的定义出发，进行 von Neumann 傅里叶分析和小波数展开，推导每种格式的主阶相速度误差。具体来说，证明数值相速度具有以下形式：\n$$\\frac{c_{\\mathrm{num}}(k)}{a} = 1 + \\beta_{s}(\\nu)\\,(k\\,\\Delta x)^{2} + \\mathcal{O}\\big((k\\,\\Delta x)^{4}\\big),$$\n其中 $s\\in\\{\\mathrm{LW},\\mathrm{BW}\\}$，$\\beta_{s}(\\nu)$ 是与格式相关的系数，并解释不同的 $\\beta_{s}(\\nu)$ 如何对色散波包产生不同的相位误差，从而影响地球物理波场模拟的保真度。最后，计算这些系数之差的精确解析表达式：\n$$\\Delta\\beta(\\nu) = \\beta_{\\mathrm{BW}}(\\nu) - \\beta_{\\mathrm{LW}}(\\nu)。$$\n将最终答案表示为关于 $\\nu$ 的闭式表达式。无需舍入。", "solution": "我们从线性平流方程 $u_{t} + a\\,u_{x} = 0$ 开始，其对于波数 $k$ 的精确平面波解为 $u(x,t) = \\hat{u}\\,\\exp\\!\\big(i\\,(k\\,x - \\omega\\,t)\\big)$，精确色散关系为 $\\omega = a\\,k$，精确相速度为 $c = \\omega/k = a$。离散格式通过一个线性算子将 $u_{i}^{n}$ 更新到 $u_{i}^{n+1}$，该算子对无量纲波数 $\\theta = k\\,\\Delta x$ 的傅里叶模式的放大因子 $G(\\theta)$ 通过 $G(\\theta) = \\exp\\!\\big(-i\\,\\omega_{\\mathrm{num}}\\,\\Delta t\\big)$ 决定了数值频率。因此，对于小 $\\theta$，相速度 $c_{\\mathrm{num}}(k) = \\omega_{\\mathrm{num}}/k$ 可以从 $G(\\theta)$ 的辐角中提取，并展开为 $c_{\\mathrm{num}}(k)/a = 1 + \\beta(\\nu)\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})$。\n\n对于 Lax–Wendroff 格式，代入 $u_{i}^{n} = \\hat{u}\\,e^{i\\,i\\,\\theta}$ 得到放大因子\n$$G_{\\mathrm{LW}}(\\theta) = 1 - i\\,\\nu\\,\\sin\\theta + \\nu^{2}\\,(\\cos\\theta - 1)。$$\n对小 $\\theta$ 展开 $\\sin\\theta$ 和 $\\cos\\theta$：\n$$\\sin\\theta = \\theta - \\frac{\\theta^{3}}{6} + \\mathcal{O}(\\theta^{5}), \\quad \\cos\\theta = 1 - \\frac{\\theta^{2}}{2} + \\frac{\\theta^{4}}{24} + \\mathcal{O}(\\theta^{6}),$$\n得到\n$$G_{\\mathrm{LW}}(\\theta) = 1 - i\\,\\nu\\,\\theta - \\frac{\\nu^{2}}{2}\\,\\theta^{2} + i\\,\\frac{\\nu}{6}\\,\\theta^{3} + \\mathcal{O}(\\theta^{4})。$$\n令 $A = G_{\\mathrm{LW}} - 1 = x + i\\,y$，其中 $x = -(\\nu^{2}/2)\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})$，$y = -\\nu\\,\\theta + (\\nu/6)\\,\\theta^{3} + \\mathcal{O}(\\theta^{5})$。辐角满足 $\\arg(G) = \\Im\\ln(1 + A) = y - x\\,y - y^{3}/3 + \\mathcal{O}(\\theta^{5})$。使用 $x\\,y = (\\nu^{3}/2)\\,\\theta^{3} + \\mathcal{O}(\\theta^{5})$ 和 $y^{3} = -\\nu^{3}\\,\\theta^{3} + \\mathcal{O}(\\theta^{5})$，我们得到\n$$\\arg(G_{\\mathrm{LW}}) = -\\nu\\,\\theta + \\left(\\frac{\\nu}{6} - \\frac{\\nu^{3}}{6}\\right)\\theta^{3} + \\mathcal{O}(\\theta^{5})。$$\n由于 $G = \\exp(-i\\,\\omega_{\\mathrm{num}}\\,\\Delta t)$，我们有 $\\omega_{\\mathrm{num}}\\,\\Delta t = -\\arg(G)$，因此\n$$\\frac{\\omega_{\\mathrm{num}}\\,\\Delta t}{\\theta} = \\nu - \\frac{\\nu\\,(1 - \\nu^{2})}{6}\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})。$$\n乘以 $(\\Delta x/\\Delta t)$ 得到\n$$\\frac{c_{\\mathrm{num,LW}}(k)}{a} = 1 - \\frac{1 - \\nu^{2}}{6}\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})。$$\n因此，Lax–Wendroff 格式的相位误差系数为\n$$\\beta_{\\mathrm{LW}}(\\nu) = -\\frac{1}{6} + \\frac{\\nu^{2}}{6}。$$\n\n对于 $a0$ 的 Beam–Warming 格式，代入相同的傅里叶拟设得到\n$$G_{\\mathrm{BW}}(\\theta) = 1 - \\frac{\\nu}{2}\\left(3 - 4\\,e^{-i\\theta} + e^{-2i\\theta}\\right) + \\frac{\\nu^{2}}{2}\\left(1 - 2\\,e^{-i\\theta} + e^{-2i\\theta}\\right)。$$\n使用 $e^{-i\\theta} = \\cos\\theta - i\\,\\sin\\theta$ 和 $e^{-2 i \\theta} = \\cos(2\\theta) - i\\,\\sin(2\\theta)$，对小 $\\theta$ 进行展开：\n$$3 - 4\\,e^{-i\\theta} + e^{-2i\\theta} = 2\\,i\\,\\theta + \\frac{2}{3}\\,i\\,\\theta^{3} + \\frac{1}{2}\\,\\theta^{4} + \\mathcal{O}(\\theta^{5}),$$\n$$1 - 2\\,e^{-i\\theta} + e^{-2i\\theta} = -\\theta^{2} + i\\,\\theta^{3} + \\frac{7}{12}\\,\\theta^{4} + \\mathcal{O}(\\theta^{5})。$$\n因此，\n$$G_{\\mathrm{BW}}(\\theta) = 1 - i\\,\\nu\\,\\theta - \\frac{\\nu^{2}}{2}\\,\\theta^{2} + i\\left(-\\frac{\\nu}{3} + \\frac{\\nu^{2}}{2}\\right)\\theta^{3} + \\mathcal{O}(\\theta^{4})。$$\n令 $A = G_{\\mathrm{BW}} - 1 = x + i\\,y$，其中 $x = -(\\nu^{2}/2)\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})$，$y = -\\nu\\,\\theta + \\left(-\\frac{\\nu}{3} + \\frac{\\nu^{2}}{2}\\right)\\theta^{3} + \\mathcal{O}(\\theta^{5})$。和之前一样，\n$$\\arg(G_{\\mathrm{BW}}) = y - x\\,y - y^{3}/3 + \\mathcal{O}(\\theta^{5}) = -\\nu\\,\\theta + \\left(-\\frac{\\nu}{3} + \\frac{\\nu^{2}}{2} - \\frac{\\nu^{3}}{6}\\right)\\theta^{3} + \\mathcal{O}(\\theta^{5})。$$\n因此，\n$$\\frac{\\omega_{\\mathrm{num}}\\,\\Delta t}{\\theta} = \\nu + \\left(\\frac{\\nu}{3} - \\frac{\\nu^{2}}{2} + \\frac{\\nu^{3}}{6}\\right)\\theta^{2} + \\mathcal{O}(\\theta^{4}),$$\n所以\n$$\\frac{c_{\\mathrm{num,BW}}(k)}{a} = 1 + \\left(\\frac{1}{3} - \\frac{\\nu}{2} + \\frac{\\nu^{2}}{6}\\right)\\theta^{2} + \\mathcal{O}(\\theta^{4})。$$\n因此，Beam–Warming 格式的相位误差系数为\n$$\\beta_{\\mathrm{BW}}(\\nu) = \\frac{1}{3} - \\frac{\\nu}{2} + \\frac{\\nu^{2}}{6}。$$\n\n这两种格式通过对其离散算子进行泰勒展开，具有相同的形式截断阶 $\\mathcal{O}(\\Delta t^{2}, \\Delta x^{2})$，但它们的修正方程在主导色散阶 $\\mathcal{O}(\\theta^{2})$ 上有所不同。具体来说，当 $\\nu \\neq 1$ 时，格式 $\\mathrm{LW}$ 对小 $\\theta$ 引入相位滞后（对于小 $\\nu$，系数为负），而格式 $\\mathrm{BW}$ 在适中的 $\\nu$ 值下对小 $\\theta$ 引入相位超前，并且迎风格式在高阶项上会引入耗散。在计算地球物理学中，准确的相位对于波场干涉、偏移和反演至关重要，这些不同的 $\\beta_{s}(\\nu)$ 导致了显著不同的保真度：$\\beta_{s}$ 的符号和大小控制着波包的数值色散，改变了波的到达时间和相位相干性，尽管两种方法按大-$\\mathcal{O}$ 截断阶都是二阶的。\n\n最后，所要求的主阶相位误差系数之差为\n$$\\Delta\\beta(\\nu) = \\beta_{\\mathrm{BW}}(\\nu) - \\beta_{\\mathrm{LW}}(\\nu) = \\left(\\frac{1}{3} - \\frac{\\nu}{2} + \\frac{\\nu^{2}}{6}\\right) - \\left(-\\frac{1}{6} + \\frac{\\nu^{2}}{6}\\right) = \\frac{1 - \\nu}{2}。$$\n这个闭式表达式量化了对于给定的 $\\nu$，两种具有相同截断阶的格式如何在地球物理波场中引入不同的主阶数值色散。", "answer": "$$\\boxed{\\frac{1-\\nu}{2}}$$", "id": "3612459"}]}