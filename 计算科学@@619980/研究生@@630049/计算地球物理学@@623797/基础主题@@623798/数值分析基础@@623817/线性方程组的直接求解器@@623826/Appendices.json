{"hands_on_practices": [{"introduction": "在地球物理建模中，许多问题（例如基于有限差分法的问题）会产生具有特定稀疏模式的矩阵，特别是带状矩阵。对于直接求解器而言，在分解过程中保持这种稀疏性至关重要，因为它直接关系到计算效率。这个练习将引导你手动对一个三对角矩阵执行高斯消元，旨在揭示一个关键现象：对于某些带状矩阵，无主元选择的高斯消元不会产生任何“填充”（fill-in）。通过这个练习，你将深入理解稀疏结构如何在分解过程中得以保持，这是稀疏直接求解器高效性的基础。[@problem_id:3584574]", "problem": "考虑一个离散拉普拉斯算子，该算子源于计算地球物理学中，在一个 $5 \\times 1$ 网格上，对从二维五点模板中提取的一维剖面上的稳态扩散问题，采用中心差分近似和齐次狄利克雷边界条件得到的。这一约束产生了标准的三对角刚度矩阵 $\\mathbf{A} \\in \\mathbb{R}^{5 \\times 5}$，其对角线元素为 $2$，第一条次对角线和超对角线元素为 $-1$：\n$$\n\\mathbf{A} \\;=\\;\n\\begin{pmatrix}\n2 & -1 & 0 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 & 0 \\\\\n0 & -1 & 2 & -1 & 0 \\\\\n0 & 0 & -1 & 2 & -1 \\\\\n0 & 0 & 0 & -1 & 2\n\\end{pmatrix}.\n$$\n使用高斯消去法的基本原理和LU分解（Lower-Upper）的定义，在不进行任何形式主元选择的情况下，逐步执行消去过程，将矩阵 $\\mathbf{A}$ 转换为一个上三角矩阵。在每一步中，根据初等行变换得到的更新公式进行推理，并明确追踪演化中矩阵的稀疏模式。使用以下关于填充元的定义：填充元是指在原始矩阵 $\\mathbf{A}$ 中为结构性零，但在消去过程的任何阶段或在LU分解的因子中变为结构性非零的任何矩阵元素。\n\n从高斯消去法的核心更新规则和矩阵 $\\mathbf{A}$ 的带状结构出发，证明其带状结构为何被保持或改变，并确定所有可能出现填充元的位置。在这些条件下，计算在对 $\\mathbf{A}$ 进行完整消去过程中产生的填充元总数。用一个整数表示你的最终答案。", "solution": "经评估，该问题陈述是有效的。它在数值线性代数领域及其在计算地球物理学中的应用（特别是有限差分法）具有科学依据。该问题是适定的，提供了一个特定的矩阵、一个确定的过程（不带主元选择的高斯消去法）和一个明确的目标（计算总填充元）。所有术语都得到了精确定义，且前提条件符合事实。\n\n高斯消去法的核心是通过一系列初等行变换，将一个矩阵系统地转换为上三角形式。在消去过程的第 $k$ 步（其中 $k=1, 2, \\dots, n-1$），我们消去第 $k$ 列的次对角线元素。这是通过使用主元行 $k$ 来更新每一行 $i$（其中 $i > k$）来实现的。矩阵中一个元素 $a_{ij}$ 的更新规则由下式给出：\n$$ a_{ij}^{(k)} \\leftarrow a_{ij}^{(k-1)} - l_{ik} a_{kj}^{(k-1)} \\quad \\text{for } i > k, j \\ge k $$\n其中 $\\mathbf{A}^{(k-1)}$ 是第 $k$ 步之前的矩阵，$\\mathbf{A}^{(k)}$ 是第 $k$ 步之后的矩阵（$\\mathbf{A}^{(0)} = \\mathbf{A}$），而 $l_{ik}$ 是定义如下的乘子：\n$$ l_{ik} = \\frac{a_{ik}^{(k-1)}}{a_{kk}^{(k-1)}} $$\n填充元被定义为在原始矩阵 $\\mathbf{A}$ 中结构性为零（即 $a_{ij}=0$），但在消去过程的任何阶段 $k$ 或在LU分解 $\\mathbf{A}=\\mathbf{L}\\mathbf{U}$ 的最终因子 $\\mathbf{L}$ 和 $\\mathbf{U}$ 中变为结构性非零（$a_{ij}^{(k)} \\neq 0$）的任何元素 $(i, j)$。\n\n给定的矩阵是：\n$$ \\mathbf{A} = \\mathbf{A}^{(0)} = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ -1 & 2 & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} $$\n这是一个带状矩阵，其下带宽为 $1$，上带宽为 $1$。\n\n我们现在逐步执行消去过程。\n\n**第1步：在第 $k=1$ 列进行消去**\n我们消去元素 $a_{21}^{(0)} = -1$。主元是 $a_{11}^{(0)} = 2$。\n乘子是 $l_{21} = \\frac{a_{21}^{(0)}}{a_{11}^{(0)}} = \\frac{-1}{2}$。\n唯一需要更新的行是第 $i=2$ 行，因为对于 $i > 2$，$a_{i1}^{(0)} = 0$，这使得 $l_{i1}=0$。\n更新操作为 $R_2 \\leftarrow R_2 - l_{21} R_1 = R_2 - (-\\frac{1}{2})R_1$。\n原始行为 $R_1^{(0)} = (2, -1, 0, 0, 0)$ 和 $R_2^{(0)} = (-1, 2, -1, 0, 0)$。\n新的第 $R_2^{(1)}$ 行为：\n$$ R_2^{(1)} = (-1, 2, -1, 0, 0) + \\frac{1}{2}(2, -1, 0, 0, 0) = (-1+1, 2-\\frac{1}{2}, -1+0, 0+0, 0+0) = (0, \\frac{3}{2}, -1, 0, 0) $$\n此步之后的矩阵是：\n$$ \\mathbf{A}^{(1)} = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} $$\n位置 $(2,4)$ 和 $(2,5)$ 在 $\\mathbf{A}$ 中为零，在 $\\mathbf{A}^{(1)}$ 中仍然为零。没有发生填充。\n\n**第2步：在第 $k=2$ 列进行消去**\n我们消去 $a_{32}^{(1)} = -1$。主元是 $a_{22}^{(1)} = \\frac{3}{2}$。\n乘子是 $l_{32} = \\frac{a_{32}^{(1)}}{a_{22}^{(1)}} = \\frac{-1}{3/2} = -\\frac{2}{3}$。\n更新操作为 $R_3 \\leftarrow R_3 - l_{32} R_2^{(1)} = R_3 + \\frac{2}{3} R_2^{(1)}$。\n相关行为 $R_2^{(1)} = (0, \\frac{3}{2}, -1, 0, 0)$ 和 $R_3^{(1)} = (0, -1, 2, -1, 0)$。\n新的第 $R_3^{(2)}$ 行为：\n$$ R_3^{(2)} = (0, -1, 2, -1, 0) + \\frac{2}{3}(0, \\frac{3}{2}, -1, 0, 0) = (0, -1+1, 2-\\frac{2}{3}, -1+0, 0+0) = (0, 0, \\frac{4}{3}, -1, 0) $$\n现在的矩阵是：\n$$ \\mathbf{A}^{(2)} = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} & -1 & 0 & 0 \\\\ 0 & 0 & \\frac{4}{3} & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} $$\n位置 $(3,5)$ 之前为零，现在仍然为零。没有发生填充。\n\n**第3步：在第 $k=3$ 列进行消去**\n我们消去 $a_{43}^{(2)} = -1$。主元是 $a_{33}^{(2)} = \\frac{4}{3}$。\n乘子是 $l_{43} = \\frac{a_{43}^{(2)}}{a_{33}^{(2)}} = \\frac{-1}{4/3} = -\\frac{3}{4}$。\n更新操作为 $R_4 \\leftarrow R_4 - l_{43} R_3^{(2)} = R_4 + \\frac{3}{4} R_3^{(2)}$。\n相关行为 $R_3^{(2)} = (0, 0, \\frac{4}{3}, -1, 0)$ 和 $R_4^{(2)} = (0, 0, -1, 2, -1)$。\n新的第 $R_4^{(3)}$ 行为：\n$$ R_4^{(3)} = (0, 0, -1, 2, -1) + \\frac{3}{4}(0, 0, \\frac{4}{3}, -1, 0) = (0, 0, -1+1, 2-\\frac{3}{4}, -1+0) = (0, 0, 0, \\frac{5}{4}, -1) $$\n矩阵变为：\n$$ \\mathbf{A}^{(3)} = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} & -1 & 0 & 0 \\\\ 0 & 0 & \\frac{4}{3} & -1 & 0 \\\\ 0 & 0 & 0 & \\frac{5}{4} & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} $$\n没有新的非零元素被创建。没有发生填充。\n\n**第4步：在第 $k=4$ 列进行消去**\n我们消去 $a_{54}^{(3)} = -1$。主元是 $a_{44}^{(3)} = \\frac{5}{4}$。\n乘子是 $l_{54} = \\frac{a_{54}^{(3)}}{a_{44}^{(3)}} = \\frac{-1}{5/4} = -\\frac{4}{5}$。\n更新操作为 $R_5 \\leftarrow R_5 - l_{54} R_4^{(3)} = R_5 + \\frac{4}{5} R_4^{(3)}$。\n相关行为 $R_4^{(3)} = (0, 0, 0, \\frac{5}{4}, -1)$ 和 $R_5^{(3)} = (0, 0, 0, -1, 2)$。\n新的第 $R_5^{(4)}$ 行为：\n$$ R_5^{(4)} = (0, 0, 0, -1, 2) + \\frac{4}{5}(0, 0, 0, \\frac{5}{4}, -1) = (0, 0, 0, -1+1, 2-\\frac{4}{5}) = (0, 0, 0, 0, \\frac{6}{5}) $$\n最终的上三角矩阵 $\\mathbf{U}$ 是：\n$$ \\mathbf{U} = \\mathbf{A}^{(4)} = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} & -1 & 0 & 0 \\\\ 0 & 0 & \\frac{4}{3} & -1 & 0 \\\\ 0 & 0 & 0 & \\frac{5}{4} & -1 \\\\ 0 & 0 & 0 & 0 & \\frac{6}{5} \\end{pmatrix} $$\n在消去过程的任何阶段，都没有任何结构性零元素变为非零。\n\n现在，我们还必须检查因子 $\\mathbf{L}$ 和 $\\mathbf{U}$ 是否有填充。\n上三角因子 $\\mathbf{U}$ 是上面显示的矩阵 $\\mathbf{A}^{(4)}$。原始矩阵 $\\mathbf{A}$ 对于所有满足 $j-i > 1$ 的 $(i,j)$ 都有零元素。得到的矩阵 $\\mathbf{U}$ 对于所有满足 $j-i > 1$ 的 $(i,j)$ 也都有零元素。比较 $\\mathbf{A}$ 和 $\\mathbf{U}$ 的上三角部分的稀疏结构，我们发现没有出现新的非零元素。因此，$\\mathbf{U}$ 中没有填充。\n\n下三角因子 $\\mathbf{L}$ 是一个由乘子 $l_{ik}$ 组成的单位下三角矩阵：\n$$ \\mathbf{L} = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\\\ l_{21} & 1 & 0 & 0 & 0 \\\\ l_{31} & l_{32} & 1 & 0 & 0 \\\\ l_{41} & l_{42} & l_{43} & 1 & 0 \\\\ l_{51} & l_{52} & l_{53} & l_{54} & 1 \\end{pmatrix} $$\n根据我们逐步的分析，我们发现唯一的非零乘子是 $l_{21}$、$l_{32}$、$l_{43}$ 和 $l_{54}$。所有其他乘子 $l_{ik}$ 都为零，因为要消去的相应元素 $a_{ik}^{(k-1)}$ 已经为零。例如，$l_{31} = a_{31}^{(0)}/a_{11}^{(0)} = 0/2 = 0$。\n代入计算出的值：\n$$ \\mathbf{L} = \\begin{pmatrix} 1 & 0 & 0 & 0 & 0 \\\\ -\\frac{1}{2} & 1 & 0 & 0 & 0 \\\\ 0 & -\\frac{2}{3} & 1 & 0 & 0 \\\\ 0 & 0 & -\\frac{3}{4} & 1 & 0 \\\\ 0 & 0 & 0 & -\\frac{4}{5} & 1 \\end{pmatrix} $$\n原始矩阵 $\\mathbf{A}$ 在其严格下三角部分仅在第一条次对角线上有非零元素，即在满足 $i-j=1$ 的位置。所有满足 $i-j>1$ 的元素都为零。得到的矩阵 $\\mathbf{L}$ 在其严格下三角部分也仅在第一条次对角线上有非零元素。$\\mathbf{A}$ 的严格下三角部分中零元素的位置在 $\\mathbf{L}$ 中得到了保留。因此，在 $\\mathbf{L}$ 因子中没有填充。\n\n产生此现象的原因在于矩阵 $\\mathbf{A}$ 的带状结构。在任何步骤 $k$，对行 $i$ 的更新是 $R_i \\leftarrow R_i - l_{ik} R_k$。对于三对角矩阵，主元行 $R_k$ 仅在列 $j=k$ 和 $j=k+1$ 处有非零元素（假设 $j>k$）。要被更新的行 $R_i$ 也只有有限数量的非零元素。只有当 $a_{ij}^{(k-1)}=0$ 且 $l_{ik}\\neq 0$ 和 $a_{kj}^{(k-1)}\\neq 0$ 都成立时，才可能在 $a_{ij}^{(k)}$ 处产生一个非零值。对于三对角矩阵，$l_{ik}$ 仅在 $i=k+1$ 时非零。因此，更新仅限于 $R_{k+1}$。由于 $R_k$ 在第 $k+1$ 列之后没有非零元素，它不能在 $R_{k+1}$ 中引入超过第 $k+1$ 列的非零元素。因此，带状结构被保留了下来。\n\n由于在原始矩阵 $\\mathbf{A}$ 中的任何结构性零元素在消去过程的任何阶段或在最终因子 $\\mathbf{L}$ 和 $\\mathbf{U}$ 中都没有变为非零，因此填充元的总数为零。", "answer": "$$\\boxed{0}$$", "id": "3584574"}, {"introduction": "并非所有地球物理系统都是对称正定的。例如，在约束反演或混合有限元方法中，我们经常遇到对称不定系统，也称为鞍点问题。标准的 Cholesky 分解不适用于这些矩阵，而高斯消元可能会遇到数值不稳定性。这个练习将介绍一种稳健的方法——带对称主元选择的 $LDL^T$ 分解（如 Bunch-Kaufman 策略）。通过处理一个对角线上有零的例子，你将理解为何需要使用 $2 \\times 2$ 的主元块来维持分解的稳定性。[@problem_id:3584552]", "problem": "在离散地球物理反问题的约束正规方程形式中，经常会遇到必须通过直接方法稳健求解的对称不定系统。考虑对称不定矩阵\n$$\nA \\;=\\; \\begin{bmatrix}\n0  1  0  0\\\\\n1  0  1  0\\\\\n0  1  0  1\\\\\n0  0  1  0\n\\end{bmatrix},\n$$\n该矩阵表示鞍点离散化中出现的简化耦合结构。使用对称主元选择的下三角-对角-下三角转置 ($LDL^T$) 分解的定义，以及用于对称不定矩阵的、经过充分检验的 Bunch–Kaufman (BK) 策略，对 $A$ 进行精确的分块 $LDL^T$ 分解，并根据需要进行对称置换：\n$$\nP^T A P = L D L^T,\n$$\n其中 $P$ 是一个置换矩阵，$L$ 是单位下三角矩阵，$D$ 是分块对角矩阵，其对角块为 $1 \\times 1$ 或 $2 \\times 2$ 的对称块。\n\n从第一性原理和 BK 主元选择规则出发，明确指出所选对称主元的有序序列、相应的 $D$ 块以及产生尾随舒尔补的相关消元步骤。然后，利用矩阵乘积行列式的乘法性质，以及置换矩阵的行列式模为 1、单位下三角矩阵的行列式为 1 的事实，计算你的分解所对应的标量值 $\\det(D)$。\n\n将最终答案表示为一个精确的实数（无量纲）。无需四舍五入。", "solution": "该问题要求使用 Bunch-Kaufman 主元选择策略对给定的对称不定矩阵 $A$ 进行分块 $L D L^T$ 分解。该分解的形式为 $P^T A P = L D L^T$，其中 $P$ 是一个置换矩阵，$L$ 是一个单位下三角矩阵，$D$ 是一个分块对角矩阵，其对角块为 $1 \\times 1$ 或 $2 \\times 2$ 的对称块。随后，我们必须计算矩阵 $D$ 的行列式。\n\n给定的矩阵是：\n$$\nA = \\begin{bmatrix}\n0  1  0  0\\\\\n1  0  1  0\\\\\n0  1  0  1\\\\\n0  0  1  0\n\\end{bmatrix}\n$$\nBunch-Kaufman 算法使用一个参数 $\\alpha$，通常设置为 $\\alpha = \\frac{1+\\sqrt{17}}{8} \\approx 0.64$。在每一步 $k$ 中主元的选择取决于涉及此参数的一系列比较。\n\n**步骤 1：对 $A$ 进行分解 (k=1)**\n\n我们从完整矩阵开始，记为 $A^{(1)} = A$。我们检查第一列以选择主元。\n对角元素是 $a_{11}^{(1)} = 0$。\n第一列中最大非对角元素的绝对值是 $\\lambda_1 = \\max_{i>1} |a_{i1}^{(1)}| = \\max(|a_{21}|, |a_{31}|, |a_{41}|) = \\max(1, 0, 0) = 1$。该元素的行索引是 $r=2$。\n\n根据 Bunch-Kaufman 策略，我们首先测试当前对角元素 $a_{11}^{(1)}$ 是否适合作为 $1 \\times 1$ 主元。条件是 $|a_{11}^{(1)}| \\ge \\alpha \\lambda_1$。\n代入数值，我们检查 $|0| \\ge \\alpha \\cdot 1$ 是否成立，结果为假。因此，在位置 $(1,1)$ 处的 $1 \\times 1$ 主元是不稳定的。\n\n接下来，我们考虑交换行/列以将一个合适的 $1 \\times 1$ 主元移到 $(1,1)$ 位置，或者使用一个 $2 \\times 2$ 的主元。这个决定基于元素 $a_{rr}^{(1)} = a_{22} = 0$。我们计算第 $r=2$ 行中最大的非对角元素，记为 $\\sigma_1 = \\max_{j\\ne 2} |a_{2j}| = \\max(|a_{21}|, |a_{23}|, |a_{24}|) = \\max(1,1,0)=1$。\n交换第 $1$ 行/列和第 $r=2$ 行/列并使用 $1 \\times 1$ 主元的条件是 $|a_{rr}^{(1)}| \\ge \\alpha \\sigma_1$。\n代入数值，我们检查 $|0| \\ge \\alpha \\cdot 1$ 是否成立，结果同样为假。\n\n由于两个 $1 \\times 1$ 主元的条件都未满足，Bunch-Kaufman 算法规定必须使用一个 $2 \\times 2$ 的主元。该主元由第 1 行/列和第 $r=2$ 行/列构成。根据算法，第 2 行/列与第 $k+1=2$ 行/列交换。这是一个单位置换，因此在这一步不需要重新排序。初始置换矩阵是 $P_1 = I$。\n\n第一个主元块 $D_1$ 是 $A$ 的前导 $2 \\times 2$ 子矩阵：\n$$\nD_1 = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n我们将矩阵 $A$ 分块如下：\n$$\nA = \\begin{bmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{bmatrix} = \\begin{bmatrix} \\begin{smallmatrix} 0  1 \\\\ 1  0 \\end{smallmatrix}  \\begin{smallmatrix} 0  0 \\\\ 1  0 \\end{smallmatrix} \\\\ \\begin{smallmatrix} 0  1 \\\\ 0  0 \\end{smallmatrix}  \\begin{smallmatrix} 0  1 \\\\ 1  0 \\end{smallmatrix} \\end{bmatrix}\n$$\n分块分解的第一步产生：\n$$\nA = \\begin{bmatrix} I  0 \\\\ L_{21}  I \\end{bmatrix} \\begin{bmatrix} D_1  0 \\\\ 0  S \\end{bmatrix} \\begin{bmatrix} I  L_{21}^{T} \\\\ 0  I \\end{bmatrix}\n$$\n其中 $L_{21} = A_{21}D_1^{-1}$，舒尔补为 $S = A_{22} - A_{21}D_1^{-1}A_{12} = A_{22} - L_{21}A_{12}$。\n\n首先，我们计算 $D_1$ 的逆：\n$$\nD_1^{-1} = \\frac{1}{(0)(0)-(1)(1)} \\begin{bmatrix} 0  -1 \\\\ -1  0 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n接下来，我们计算块 $L_{21}$：\n$$\nL_{21} = A_{21}D_1^{-1} = \\begin{bmatrix} 0  1 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix}\n$$\n现在，我们计算舒尔补 $S$：\n$$\nS = A_{22} - L_{21}A_{12} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} - \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 0  0 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} - \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n\n**步骤 2：对舒尔补 $S$ 进行分解**\n\n待分解的剩余矩阵是 $A^{(2)} = S = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$。我们应用相同的 Bunch-Kaufman 逻辑。\n第一个对角元素是 $s_{11}=0$。第一列中最大的非对角元素是 $|s_{21}|=1$，所以 $\\lambda=1$ 且 $r=2$。\n$1 \\times 1$ 主元的条件 $|s_{11}| \\ge \\alpha \\lambda$ ($|0| \\ge \\alpha \\cdot 1$) 不成立。\n第 $r=2$ 行中最大的非对角元素是 $|s_{21}|=1$，所以 $\\sigma=1$。\n交换并使用 $1 \\times 1$ 主元的条件 $|s_{rr}| \\ge \\alpha \\sigma$ ($|s_{22}| \\ge \\alpha \\sigma \\implies |0| \\ge \\alpha \\cdot 1$) 也不成立。\n因此，我们必须使用一个 $2 \\times 2$ 的主元，也就是整个矩阵 $S$。这就构成了第二个主元块 $D_2$：\n$$\nD_2 = S = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n分解现已完成。不需要进一步的置换，所以总的置换矩阵是单位矩阵 $P=I$。\n\n**组装分解结果**\n\n分解 $A = L D L^T$ 是由计算出的各部分构成的。\n置换矩阵是 $P=I$。\n分块对角矩阵 $D$ 由主元块 $D_1$ 和 $D_2$ 组成：\n$$\nD = \\begin{bmatrix} D_1  0 \\\\ 0  D_2 \\end{bmatrix} = \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  1 \\\\ 0  0  1  0 \\end{bmatrix}\n$$\n单位下三角矩阵 $L$ 由单位矩阵和计算出的乘子块 $L_{21}$ 构成：\n$$\nL = \\begin{bmatrix} I  0 \\\\ L_{21}  I \\end{bmatrix} = \\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  0  0  1 \\end{bmatrix}\n$$\n为了验证结果，我们计算 $L D L^T$：\n$$\nL D L^T = \\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  0  0  1 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  1 \\\\ 0  0  1  0 \\end{bmatrix} \\begin{bmatrix} 1  0  1  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  0  0  1 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  0  0  1 \\\\ 0  0  1  0 \\end{bmatrix} = \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  1  0 \\\\ 0  1  0  1 \\\\ 0  0  1  0 \\end{bmatrix} = A\n$$\n分解是正确的。主元序列由两个 $2 \\times 2$ 的块组成。\n\n**计算 det(D)**\n\n问题要求计算 $\\det(D)$。根据行列式的性质，我们知道 $\\det(P^T A P) = \\det(L D L^T)$。\n这可以简化为 $\\det(A) = \\det(D)$，因为 $\\det(P^T)\\det(P) = (\\det(P))^2 = 1$ 并且 $\\det(L) = \\det(L^T)=1$。\n我们可以直接从 $D$ 的分块对角结构计算其行列式。分块对角矩阵的行列式是其对角块行列式的乘积。\n$$\n\\det(D) = \\det(D_1) \\cdot \\det(D_2)\n$$\n各个块的行列式是：\n$$\n\\det(D_1) = \\det \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = (0)(0) - (1)(1) = -1\n$$\n$$\n\\det(D_2) = \\det \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = (0)(0) - (1)(1) = -1\n$$\n因此，$D$ 的行列式是：\n$$\n\\det(D) = (-1) \\cdot (-1) = 1\n$$\n这个值应该等于 $\\det(A)$。沿第一行展开 $\\det(A)$ 可以证实这一点：\n$$\n\\det(A) = -1 \\cdot \\det \\begin{pmatrix} 1  1  0 \\\\ 0  0  1 \\\\ 0  1  0 \\end{pmatrix} = -1 \\cdot (1 \\cdot \\det \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}) = -1 \\cdot (1 \\cdot (-1)) = 1\n$$\n计算结果一致。对于所计算的分解，$\\det(D)$ 的标量值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3584552"}, {"introduction": "在实际的科学计算中，由于有限的机器精度，我们得到的解通常是近似解而非精确解。因此，仅仅计算出一个解是不够的；我们还必须评估其可靠性。这个练习将数值分析中的核心概念——残差、后向误差、前向误差和条件数——与地球物理反演中的实际决策联系起来。你将为一个线性系统的近似解计算这些量，并利用它们来判断该解的精度是否在可接受的公差范围内，这体现了从计算结果到科学结论的关键一步。[@problem_id:3584593]", "problem": "在单次高斯-牛顿迭代中，线性化地震走时反演需要求解一个由慢度更新的有限差分网格化所产生的小型线性系统。该系统为\n$$\nA x = b,\n$$\n其中\n$$\nA = \\begin{pmatrix}\n3  1  0 \\\\\n1  2  1 \\\\\n0  1  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n5 \\\\\n4 \\\\\n1\n\\end{pmatrix}.\n$$\n使用带部分主元法的LU分解进行直接求解，得到了近似的模型增量\n$$\n\\hat{x} = \\begin{pmatrix}\n0.999 \\\\\n2.001 \\\\\n-0.999\n\\end{pmatrix}.\n$$\n假设所有量均为无量纲，并使用矩阵和向量的无穷范数作为基本范数。计算残差向量 $r = b - A \\hat{x}$，并使用以下公式估计相对后向误差\n$$\n\\beta = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty}\\,\\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}},\n$$\n并通过标准界使用条件数 $\\kappa_{\\infty}(A)$ 来估计前向相对误差\n$$\n\\frac{\\|\\hat{x} - x\\|_{\\infty}}{\\|x\\|_{\\infty}} \\lesssim \\kappa_{\\infty}(A)\\,\\beta.\n$$\n对于此次反演，前向相对误差的地球物理可接受容差为\n$$\n\\tau = 5 \\times 10^{-3}.\n$$\n定义可接受性指标 $S$ 如下：\n$$\nS = \\begin{cases}\n1,  \\text{if } \\kappa_{\\infty}(A)\\,\\beta \\le \\tau, \\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n计算 $S$ 并将其作为最终答案。无需四舍五入，最终答案必须是一个实数。", "solution": "本题的目标是确定一个线性系统近似解的可接受性指标 $S$ 的值。$S$ 的值取决于前向相对误差的估计值是否在给定的地球物理容差 $\\tau$ 之内。该问题由线性系统 $Ax = b$ 定义，其中\n$$\nA = \\begin{pmatrix}\n3  1  0 \\\\\n1  2  1 \\\\\n0  1  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n5 \\\\\n4 \\\\\n1\n\\end{pmatrix}.\n$$\n给出了一个近似解 $\\hat{x}$：\n$$\n\\hat{x} = \\begin{pmatrix}\n0.999 \\\\\n2.001 \\\\\n-0.999\n\\end{pmatrix}.\n$$\n可接受性指标 $S$ 定义为\n$$\nS = \\begin{cases}\n1,  \\text{if } \\kappa_{\\infty}(A)\\,\\beta \\le \\tau, \\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\n其中 $\\tau=5 \\times 10^{-3}$，$\\kappa_{\\infty}(A)$ 是 $A$ 在无穷范数下的条件数，而 $\\beta$ 是相对后向误差。\n\n为了计算 $S$，我们必须首先计算 $\\beta$ 和 $\\kappa_{\\infty}(A)$。\n\n相对后向误差 $\\beta$ 由以下公式给出：\n$$\n\\beta = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty}\\,\\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}\n$$\n这需要计算残差向量 $r = b - A\\hat{x}$ 以及几个无穷范数。\n\n首先，我们计算乘积 $A\\hat{x}$：\n$$\nA\\hat{x} = \\begin{pmatrix}\n3  1  0 \\\\\n1  2  1 \\\\\n0  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n0.999 \\\\\n2.001 \\\\\n-0.999\n\\end{pmatrix}\n= \\begin{pmatrix}\n3(0.999) + 1(2.001) + 0(-0.999) \\\\\n1(0.999) + 2(2.001) + 1(-0.999) \\\\\n0(0.999) + 1(2.001) + 1(-0.999)\n\\end{pmatrix}\n= \\begin{pmatrix}\n2.997 + 2.001 \\\\\n0.999 + 4.002 - 0.999 \\\\\n2.001 - 0.999\n\\end{pmatrix}\n= \\begin{pmatrix}\n4.998 \\\\\n4.002 \\\\\n1.002\n\\end{pmatrix}.\n$$\n接下来，我们计算残差向量 $r$：\n$$\nr = b - A\\hat{x} = \\begin{pmatrix}\n5 \\\\\n4 \\\\\n1\n\\end{pmatrix} - \\begin{pmatrix}\n4.998 \\\\\n4.002 \\\\\n1.002\n\\end{pmatrix} = \\begin{pmatrix}\n0.002 \\\\\n-0.002 \\\\\n-0.002\n\\end{pmatrix}.\n$$\n现在，我们计算所需的无穷范数。向量的无穷范数是其各分量绝对值的最大值，而矩阵的无穷范数是最大绝对行和。\n$$\n\\|r\\|_{\\infty} = \\max(|0.002|, |-0.002|, |-0.002|) = 0.002.\n$$\n$$\n\\|A\\|_{\\infty} = \\max(|3|+|1|+|0|, |1|+|2|+|1|, |0|+|1|+|1|) = \\max(4, 4, 2) = 4.\n$$\n$$\n\\|\\hat{x}\\|_{\\infty} = \\max(|0.999|, |2.001|, |-0.999|) = 2.001.\n$$\n$$\n\\|b\\|_{\\infty} = \\max(|5|, |4|, |1|) = 5.\n$$\n现在我们可以计算 $\\beta$：\n$$\n\\beta = \\frac{0.002}{4(2.001) + 5} = \\frac{0.002}{8.004 + 5} = \\frac{0.002}{13.004} = \\frac{2}{13004} = \\frac{1}{6502}.\n$$\n接下来，我们确定条件数 $\\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty}$。我们已经得到 $\\|A\\|_{\\infty} = 4$。我们需要求出 $A^{-1}$。逆矩阵由公式 $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$ 给出。\n$A$ 的行列式是：\n$$\n\\det(A) = 3(2 \\cdot 1 - 1 \\cdot 1) - 1(1 \\cdot 1 - 1 \\cdot 0) + 0 = 3(1) - 1(1) = 2.\n$$\n代数余子式矩阵是：\n$$\nC = \\begin{pmatrix}\n(2\\cdot 1 - 1\\cdot 1)  -(1\\cdot 1 - 1\\cdot 0)  (1\\cdot 1 - 2\\cdot 0) \\\\\n-(1\\cdot 1 - 0\\cdot 1)  (3\\cdot 1 - 0\\cdot 0)  -(3\\cdot 1 - 1\\cdot 0) \\\\\n(1\\cdot 1 - 2\\cdot 0)  -(3\\cdot 1 - 1\\cdot 0)  (3\\cdot 2 - 1\\cdot 1)\n\\end{pmatrix}\n= \\begin{pmatrix}\n1  -1  1 \\\\\n-1  3  -3 \\\\\n1  -3  5\n\\end{pmatrix}.\n$$\n$A$ 的伴随矩阵是代数余子式矩阵的转置，即 $\\text{adj}(A) = C^T$。由于 $C$ 是对称的，所以 $\\text{adj}(A) = C$。\n$$\nA^{-1} = \\frac{1}{2}\\begin{pmatrix}\n1  -1  1 \\\\\n-1  3  -3 \\\\\n1  -3  5\n\\end{pmatrix} = \\begin{pmatrix}\n0.5  -0.5  0.5 \\\\\n-0.5  1.5  -1.5 \\\\\n0.5  -1.5  2.5\n\\end{pmatrix}.\n$$\n$A^{-1}$ 的无穷范数是最大绝对行和：\n$$\n\\|A^{-1}\\|_{\\infty} = \\max(|0.5|+|-0.5|+|0.5|, |-0.5|+|1.5|+|-1.5|, |0.5|+|-1.5|+|2.5|)\n$$\n$$\n\\|A^{-1}\\|_{\\infty} = \\max(1.5, 3.5, 4.5) = 4.5.\n$$\n现在，我们可以计算条件数：\n$$\n\\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty} = 4 \\times 4.5 = 18.\n$$\n最后，我们检查可接受性指标 $S$ 的条件。我们需要评估是否 $\\kappa_{\\infty}(A)\\beta \\le \\tau$。\n$$\n\\kappa_{\\infty}(A)\\beta = 18 \\times \\frac{1}{6502} = \\frac{18}{6502} = \\frac{9}{3251}.\n$$\n容差为 $\\tau = 5 \\times 10^{-3} = \\frac{5}{1000} = \\frac{1}{200}$。\n我们检验该不等式：\n$$\n\\frac{9}{3251} \\le \\frac{1}{200}.\n$$\n通过交叉相乘，这等价于检验 $9 \\times 200 \\le 3251 \\times 1$ 是否成立：\n$$\n1800 \\le 3251.\n$$\n这个不等式成立。因此，条件 $\\kappa_{\\infty}(A)\\beta \\le \\tau$ 得到满足。\n根据可接受性指标 $S$ 的定义，如果条件满足，则 $S=1$。\n$$\nS = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "3584593"}]}