{"hands_on_practices": [{"introduction": "在地球物理模型中，我们经常遇到包含多个时间尺度的刚性系统，这对显式时间积分方法构成了严峻的挑战。算子分裂提供了一种优雅的策略，通过将刚性部分和非刚性部分分离处理，来有效应对这一问题。本练习[@problem_id:3612316]将引导你分析一个简单的一阶李分裂格式，并揭示该方法如何通过对刚性线性部分进行精确积分，从而摆脱其对时间步长的严格限制。", "problem": "考虑标量常微分方程 (ODE) $u_{t}=\\lambda u+g(u)$，该方程模拟地球物理介质中的一个刚性衰减-反应过程，其中 $\\lambda\\ll -1$ 代表一个强的线性衰减率，$g(u)$ 是一个非线性反应项，在有界不变集 $\\mathcal{D}\\subset\\mathbb{R}$ 上二阶连续可微。在一个时间步长 $\\Delta t>0$ 上使用一阶李分裂法：首先在 $\\Delta t$ 上精确积分线性衰减子问题，然后在 $\\Delta t$ 上显式推进非线性反应子问题。\n\n仅从李分裂步骤的基本定义以及基于线性化的显式单步格式的绝对稳定性判据出发，推导显式非线性阶段的最大稳定时间步长的估计值，并用雅可比矩阵 $g'(u)$ 在 $\\mathcal{D}$ 上的幅值的上确界来表示。证明这个稳定性约束是否以及如何依赖于 $\\lambda$。\n\n然后，将问题具体化到非线性反应 $g(u)=-\\alpha u^{3}$（其中 $\\alpha>0$），假设动力学过程保持在集合 $\\mathcal{D}=\\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$ 中（对于给定的振幅界限 $U>0$）。计算李分裂法中显式阶段的最大允许时间步长 $\\Delta t_{\\max}$，并用 $\\alpha$ 和 $U$ 来表示。你的最终答案必须用秒表示。无需四舍五入，且你的最终答案必须是单个闭式解析表达式。", "solution": "题目要求分析应用于标量常微分方程 (ODE) $u_{t}=\\lambda u+g(u)$ 的一阶李分裂格式的稳定性。参数 $\\lambda \\ll -1$ 代表强的线性衰减，使得该常微分方程是刚性的。项 $g(u)$ 是一个非线性反应，并假设解 $u(t)$ 保持在一个有界不变集 $\\mathcal{D} \\subset \\mathbb{R}$ 内。\n\n首先，我们将李分裂格式形式化。在一个时间步长 $\\Delta t > 0$ 上，从 $u(t_n)$ 的近似值 $u_n$ 开始，我们分两个阶段计算 $u_{n+1} \\approx u(t_n+\\Delta t)$。\n\n阶段1：求解线性衰减子问题。\n我们在区间 $[0, \\Delta t]$ 上求解初值条件为 $v(0) = u_n$ 的常微分方程 $v_t = \\lambda v$。题目指明此积分为精确执行。其解为 $v(t) = u_n \\exp(\\lambda t)$。在 $t=\\Delta t$ 处求值得到中间值 $u^*$：\n$$u^* = u_n \\exp(\\lambda \\Delta t)$$\n\n阶段2：求解非线性反应子问题。\n我们在 $[0, \\Delta t]$ 上求解初值条件为 $w(0) = u^*$ 的常微分方程 $w_t = g(w)$。题目说明这是“显式”完成的。最基本的一阶显式方法是前向欧拉格式。应用一步前向欧拉法得到最终值 $u_{n+1}$：\n$$u_{n+1} = u^* + \\Delta t \\, g(u^*)$$\n\n问题的核心是确定由这第二个显式阶段引起的对 $\\Delta t$ 的稳定性约束。题目指定了基于线性化的绝对稳定性判据。对于应用于标量常微分方程 $w_t = f(w)$ 的显式单步法，其稳定性通过在参考解周围线性化常微分方程来分析，从而得出条件：$\\Delta t$ 乘以 $f$ 的雅可比矩阵必须位于该方法的稳定性区域内。\n\n对于前向欧拉法，复数 $z$ 的稳定性区域是复平面中由 $|1 + z| \\leq 1$ 定义的圆盘。在我们的例子中，函数是 $g(u)$，其雅可比矩阵是标量导数 $g'(u)$，变量 $z$ 对应于 $\\Delta t \\, g'(u)$。由于 $g(u)$ 是实变量的实值函数，$g'(u)$ 是实数。因此，稳定性条件变为：\n$$|1 + \\Delta t \\, g'(u)| \\leq 1$$\n对于实值 $x = \\Delta t \\, g'(u)$，该不等式等价于 $-1 \\leq 1 + x \\leq 1$，可简化为：\n$$-2 \\leq \\Delta t \\, g'(u) \\leq 0$$\n\n此条件必须对第二阶段中作为函数 $g$ 输入的任何 $u$ 值都成立。输入是 $u^* = u_n \\exp(\\lambda \\Delta t)$。由于 $u_n$ 在不变集 $\\mathcal{D}$ 中，且题目说明 $\\lambda \\ll -1$，我们有 $0  \\exp(\\lambda \\Delta t) \\ll 1$。因此， $|u^*| = |u_n| \\exp(\\lambda \\Delta t) \\leq |u_n|$。如果 $\\mathcal{D}$ 是一个以0为中心的区间，如 $\\{u \\in \\mathbb{R}: |u| \\leq U\\}$，那么 $u_n \\in \\mathcal{D}$ 意味着 $u^* \\in \\mathcal{D}$。为确保所有可能状态的稳定性，该条件必须对所有 $u \\in \\mathcal{D}$ 成立。\n\n对于所有 $u \\in \\mathcal{D}$，条件 $-2 \\leq \\Delta t \\, g'(u) \\leq 0$ 意味着两个独立的约束：\n1.  $\\Delta t \\, g'(u) \\leq 0$：由于 $\\Delta t  0$，这要求对于所有 $u \\in \\mathcal{D}$ 都有 $g'(u) \\leq 0$。这是反应项的物理特性必须满足的、使前向欧拉法始终稳定的一个必要条件。\n2.  $\\Delta t \\, g'(u) \\geq -2$：这意味着对于任何 $g'(u)  0$ 的 $u \\in \\mathcal{D}$，都有 $\\Delta t \\leq \\frac{-2}{g'(u)}$。\n\n为确保该不等式对所有 $u \\in \\mathcal{D}$ 成立，$\\Delta t$ 必须小于 $\\frac{-2}{g'(u)}$ 的最小可能值。这个最小值出现在分母 $g'(u)$ 为最负时，即当 $|g'(u)| = -g'(u)$ 达到其最大值时。令 $L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)|$。那么最严格的约束是：\n$$\\Delta t \\leq \\frac{2}{L_g}$$\n因此，最大稳定时间步长为 $\\Delta t_{\\max} = \\frac{2}{\\sup_{u \\in \\mathcal{D}} |g'(u)|}$。\n\n现在，我们来讨论这个稳定性约束是否依赖于 $\\lambda$。推导出的估计 $\\Delta t \\leq 2/L_g$ 仅依赖于非线性项 $g'(u)$ 的雅可比矩阵在不变集 $\\mathcal{D}$ 上的幅值的上确界。参数 $\\lambda$ 并未出现在这个表达式中。这展示了李分裂法处理刚性问题的一个关键优势：通过精确积分系统的刚性线性部分，消除了与其相关的稳定性约束（对于一个完全显式的方法，该约束大约为 $\\Delta t \\leq 2/|\\lambda|$）。整体稳定性仅由非刚性部分决定，从而允许使用大得多的时间步长。\n\n最后，我们将此结果具体化到给定的非线性反应 $g(u) = -\\alpha u^3$（其中 $\\alpha  0$），在不变集 $\\mathcal{D} = \\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$ 上（对于给定的 $U  0$）。\n\n首先，我们计算导数 $g'(u)$：\n$$g'(u) = \\frac{d}{du}(-\\alpha u^3) = -3\\alpha u^2$$\n由于 $\\alpha  0$ 且 $u^2 \\geq 0$，我们有对所有 $u$ 都有 $g'(u) \\leq 0$。这满足了稳定性的必要条件。\n\n接下来，我们求 $|g'(u)|$ 在集合 $\\mathcal{D}$ 上的上确界：\n$$L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)| = \\sup_{|u| \\leq U} |-3\\alpha u^2| = \\sup_{|u| \\leq U} 3\\alpha u^2$$\n函数 $3\\alpha u^2$ 是一个顶点在 $u=0$ 的开口向上的抛物线。在对称区间 $[-U, U]$ 上，其最大值在端点 $u = \\pm U$ 处取得。\n$$L_g = 3\\alpha U^2$$\n\n将此代入我们最大时间步长的表达式中，得到：\n$$\\Delta t_{\\max} = \\frac{2}{L_g} = \\frac{2}{3\\alpha U^2}$$\n题目要求答案以秒为单位表示。如果我们假设 $u$ 的单位是 $X$，时间的单位是秒 ($s$)，那么从 $u_t = g(u)$ 可知，$g(u)$ 的单位必须是 $X/s$。从 $g(u) = -\\alpha u^3$ 可知，$\\alpha$ 的单位必须是 $(X/s)/X^3 = X^{-2}s^{-1}$。$U$ 的单位是 $X$。因此，表达式 $\\frac{2}{3\\alpha U^2}$ 的单位是 $1/(X^{-2}s^{-1} \\cdot X^2) = 1/s^{-1} = s$。结果在量纲上是一致的。", "answer": "$$\\boxed{\\frac{2}{3\\alpha U^2}}$$", "id": "3612316"}, {"introduction": "构造一个算子分裂格式只是第一步；确保其数值稳定性至关重要。对于线性和常系数的偏微分方程，冯·诺依曼 (von Neumann) 稳定性分析是检验稳定性的标准工具。通过这个练习[@problem_id:3612346]，你将对一个应用于平流-扩散方程的分裂格式进行傅里叶分析，并推导出其稳定条件，从而亲身体验如何确定组合格式的稳定性边界。", "problem": "考虑线性平流-扩散方程 $u_{t} + c\\,u_{x} = \\nu\\,u_{xx}$，其中 $c \\in \\mathbb{R}$ 是一个不为零的恒定平流速度，$c \\neq 0$，$\\nu \\ge 0$ 是一个恒定的运动粘度。设空间域是周期性的，周期为 $L  0$，在恒定间距 $\\Delta x  0$ 的均匀网格 $x_{j} = j\\,\\Delta x$ 上进行离散化。考虑在单个时间步长 $\\Delta t  0$ 内应用的 Lie 分裂时间积分器，该积分器执行以下步骤：\n\n- 一个显式平流步，时间上使用前向欧拉法，空间上使用与 $c$ 的符号一致的一阶迎风离散，随后是\n- 一个隐式扩散步，时间上使用后向欧拉法，并对 $u_{xx}$ 使用二阶中心有限差分。\n\n假设采用周期性边界条件，因此离散傅里叶模式是更新算子的特征函数。对复合的单步映射（从时间层级 $n$ 经平流然后扩散到 $n+1$）进行 von Neumann 分析（傅里叶稳定性分析），并导出对于所有波数，谱放大因子的模不大于 $1$ 的充要稳定性条件。由此，确定最大允许时间步长 $\\Delta t_{\\max}$，作为一个以 $c$、$\\nu$ 和 $\\Delta x$ 表示的显式代数表达式，使得 Lie 分裂格式对所有傅里叶模式都是 von Neumann 稳定的。将您的最终答案表示为 $\\Delta t_{\\max}$ 的单个闭式表达式。不要提供数值；如果您要进行数值计算，您会将时间以秒（SI单位）表示，但在这里您必须只给出符号表达式。", "solution": "解答过程是通过分析组合的两步 Lie 分裂格式的放大因子来进行的。令 $u_j^n$ 表示在时间 $t_n = n\\Delta t$ 和空间位置 $x_j = j\\Delta x$ 的数值解。该格式通过一个我们用 $*$ 表示的中间步骤，将解从时间层级 $n$ 更新到 $n+1$。\n\n总格式为 $u^n \\xrightarrow{\\text{平流}} u^* \\xrightarrow{\\text{扩散}} u^{n+1}$。\n\n**1. 平流步分析**\n平流方程为 $u_t + c u_x = 0$。该格式在时间上使用前向欧拉法，对空间导数 $u_x$ 使用一阶迎风离散。迎风离散取决于平流速度 $c$ 的符号。\n\n令 $\\alpha = \\frac{|c|\\Delta t}{\\Delta x}$ 为 Courant 数，其为非负。\n- 如果 $c  0$，迎风差分为 $\\frac{u_j - u_{j-1}}{\\Delta x}$。前向欧拉更新为：\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) = (1-\\alpha)u_j^n + \\alpha u_{j-1}^n $$\n- 如果 $c  0$，迎风差分为 $\\frac{u_{j+1} - u_j}{\\Delta x}$。前向欧拉更新为：\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1}^n - u_j^n) = (1+\\frac{c\\Delta t}{\\Delta x})u_j^n - \\frac{c\\Delta t}{\\Delta x}u_{j+1}^n = (1-\\alpha)u_j^n + \\alpha u_{j+1}^n $$\n我们通过代入单个傅里叶模式 $u_j^n = \\hat{u}^n(k) \\exp(i k x_j) = \\hat{u}^n(k) \\exp(i j \\theta)$ 来进行 von Neumann 分析，其中 $k$ 是波数，$\\theta = k \\Delta x$ 是无量纲波数或每个网格单元的相移。平流步的放大因子 $G_A(\\theta)$ 定义为 $\\hat{u}^*(k) = G_A(\\theta) \\hat{u}^n(k)$。\n\n- 对于 $c  0$：$\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j-1)\\theta)$。除以 $\\hat{u}^n \\exp(ij\\theta)$ 得到 $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(-i\\theta)$。\n- 对于 $c  0$：$\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j+1)\\theta)$。除以 $\\hat{u}^n \\exp(ij\\theta)$ 得到 $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(i\\theta)$。\n\n放大因子的模的平方 $|G_A(\\theta)|^2$ 在两种情况下是相同的。对于 $c0$：\n$$ |G_A(\\theta)|^2 = |(1-\\alpha) + \\alpha(\\cos\\theta - i\\sin\\theta)|^2 = |(1-\\alpha(1-\\cos\\theta)) - i\\alpha\\sin\\theta|^2 $$\n$$ |G_A(\\theta)|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta $$\n$$ |G_A(\\theta)|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1 - 2\\cos\\theta + \\cos^2\\theta + \\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(2 - 2\\cos\\theta) $$\n$$ |G_A(\\theta)|^2 = 1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2) $$\n这个 $|G_A(\\theta)|^2$ 的表达式对任何 $c \\neq 0$ 都成立。\n\n**2. 扩散步分析**\n扩散方程为 $u_t = \\nu u_{xx}$。该格式在时间上使用后向欧拉法，对 $u_{xx}$ 使用二阶中心差分，即 $\\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta x)^2}$。从中间状态 $u^*$ 到最终状态 $u^{n+1}$ 的更新为：\n$$ \\frac{u_j^{n+1} - u_j^*}{\\Delta t} = \\nu \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} $$\n令 $\\beta = \\frac{\\nu\\Delta t}{(\\Delta x)^2}$ 为扩散数。由于 $\\nu \\ge 0$，我们有 $\\beta \\ge 0$。\n$$ u_j^* = u_j^{n+1} - \\beta(u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) $$\n将傅里叶模式 $u_j = \\hat{u}(k) \\exp(ij\\theta)$ 代入时间层级 $*$ 和 $n+1$：\n$$ \\hat{u}^* = \\hat{u}^{n+1} - \\beta(\\hat{u}^{n+1}\\exp(i\\theta) - 2\\hat{u}^{n+1} + \\hat{u}^{n+1}\\exp(-i\\theta)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1} (1 - \\beta(\\exp(i\\theta) + \\exp(-i\\theta) - 2)) = \\hat{u}^{n+1}(1 - \\beta(2\\cos\\theta - 2)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1}(1 + 2\\beta(1-\\cos\\theta)) $$\n扩散步的放大因子 $G_D(\\theta)$ 定义为 $\\hat{u}^{n+1}(k) = G_D(\\theta) \\hat{u}^*(k)$。\n$$ G_D(\\theta) = \\frac{1}{1 + 2\\beta(1-\\cos\\theta)} $$\n由于 $\\beta \\ge 0$ 且 $1-\\cos\\theta \\ge 0$，分母总是大于或等于 $1$。因此，对于所有 $\\theta$，都有 $|G_D(\\theta)| \\le 1$，这验证了该步骤本身是无条件稳定的。\n\n**3. 组合格式的稳定性**\n对于完整的算子分裂步，总放大因子是乘积 $G(\\theta) = G_A(\\theta) G_D(\\theta)$。稳定性条件要求对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G(\\theta)| \\le 1$。\n$$ |G(\\theta)|^2 = |G_A(\\theta)|^2 |G_D(\\theta)|^2 \\le 1 $$\n$$ \\frac{1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2)}{(1 + 2\\beta(1-\\cos\\theta))^2} \\le 1 $$\n令 $X = 1-\\cos\\theta$。对于 $\\theta \\in [-\\pi, \\pi]$，我们有 $X \\in [0, 2]$。不等式变为：\n$$ 1 - 2X(\\alpha-\\alpha^2) \\le (1+2\\beta X)^2 = 1 + 4\\beta X + 4\\beta^2 X^2 $$\n$$ -2X(\\alpha-\\alpha^2) \\le 4\\beta X + 4\\beta^2 X^2 $$\n$$ 0 \\le 4\\beta X + 4\\beta^2 X^2 + 2X(\\alpha-\\alpha^2) $$\n对于 $X=0$ (即 $\\theta=0$)，不等式为 $0 \\le 0$，这是平凡成立的。对于 $X  0$，我们可以除以 $X$：\n$$ 0 \\le 4\\beta + 4\\beta^2 X + 2(\\alpha-\\alpha^2) $$\n令 $f(X) = 4\\beta^2 X + (4\\beta + 2\\alpha - 2\\alpha^2)$。此不等式必须对所有 $X \\in (0, 2]$ 成立。函数 $f(X)$ 是关于 $X$ 的线性函数。其斜率为 $4\\beta^2 \\ge 0$，因此 $f(X)$ 是一个非减函数。$f(X)$ 在区间 $[0, 2]$ 上的最小值出现在 $X=0$ 处。因此，如果该条件在 $X=0$ 处满足，则对所有 $X$ 都满足：\n$$ 4\\beta + 2\\alpha - 2\\alpha^2 \\ge 0 $$\n$$ 2\\beta + \\alpha - \\alpha^2 \\ge 0 $$\n现在，我们代入 $\\alpha$ 和 $\\beta$ 的定义：\n$$ 2\\left(\\frac{\\nu\\Delta t}{(\\Delta x)^2}\\right) + \\frac{|c|\\Delta t}{\\Delta x} - \\left(\\frac{|c|\\Delta t}{\\Delta x}\\right)^2 \\ge 0 $$\n因为我们正在寻找一个非平凡的时间步长 $\\Delta t  0$，我们可以用 $\\Delta t$ 除以不等式两边：\n$$ \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} - \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\ge 0 $$\n我们求解 $\\Delta t$ 以找到稳定性界限：\n$$ \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\le \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} $$\n乘以 $(\\Delta x)^2$ 得到：\n$$ |c|^2 \\Delta t \\le 2\\nu + |c|\\Delta x $$\n由于 $c \\neq 0$，所以 $|c|^2  0$，我们可以用它来除：\n$$ \\Delta t \\le \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\n最大允许时间步长 $\\Delta t_{\\max}$ 是此不等式的上界。\n\n$$ \\Delta t_{\\max} = \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\n这也可以写成 $\\Delta t_{\\max} = \\frac{\\Delta x}{|c|} + \\frac{2\\nu}{|c|^2}$。这表明纯平流 CFL 条件的稳定时间步长（$\\Delta x/|c|$）被一个与粘度 $\\nu$ 成正比的项所增加。", "answer": "$$\\boxed{\\frac{2\\nu + |c|\\Delta x}{|c|^2}}$$", "id": "3612346"}, {"introduction": "算子分裂技术同样适用于偏微分方程组，例如在地震学中至关重要的声波方程。本练习[@problem_id:3612339]将应用一种类似蛙跳格式的斯特朗分裂来求解交错网格上的声波系统。除了推导更新公式，你还将分析该格式对离散能量的守恒性，这将揭示一个深刻的观点：即使数值格式是稳定的，它也未必能完美保持所有物理守恒律，这是长期模拟中必须考虑的关键因素。", "problem": "考虑一维线性声学系统，其体积模量 $K0$ 和密度 $\\rho0$ 为常数，\n$$\np_{t} + K\\,u_{x} = 0, \\qquad u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0,\n$$\n该系统定义在长度为 $L$ 的周期性区间上。设空间域在均匀交错网格上离散化，网格间距为 $\\Delta x = L/J$，其中 $J$ 为某个整数。在整数空间索引 $j \\in \\{0,1,\\dots,J-1\\}$ 处定义离散压力样本 $p_{j}^{n} \\approx p(j\\,\\Delta x, n\\,\\Delta t)$，在半整数空间索引 $j+1/2$ 处定义离散速度样本 $u_{j+1/2}^{n} \\approx u\\!\\left((j+\\tfrac{1}{2})\\,\\Delta x, n\\,\\Delta t\\right)$，其中 $j$ 具有周期性环绕。设 $\\Delta t0$ 为时间步长。引入在交错网格和非交错网格之间进行映射的中心差分算子，\n$$\n(\\delta_{x} u)_{j} := \\frac{u_{j+1/2} - u_{j-1/2}}{\\Delta x}, \\qquad (\\delta_{x} p)_{j+1/2} := \\frac{p_{j+1} - p_{j}}{\\Delta x},\n$$\n并假设周期性边界条件，从而离散分部求和成立，\n$$\n\\sum_{j=0}^{J-1} p_{j}\\,(\\delta_{x} u)_{j}\\,\\Delta x \\;=\\; - \\sum_{j=0}^{J-1} u_{j+1/2}\\,(\\delta_{x} p)_{j+1/2}\\,\\Delta x.\n$$\n将时间层 $n$ 的离散声学能量定义为\n$$\nE^{n} := \\sum_{j=0}^{J-1} \\left(\\frac{1}{2K}\\,(p_{j}^{n})^{2} + \\frac{\\rho}{2}\\,(u_{j+1/2}^{n})^{2}\\right)\\,\\Delta x.\n$$\n在一个完整时间步 $\\Delta t$ 上应用一种类蛙跳格式的Strang分裂，该分裂由三个子步骤构成：(i) 一个推进 $p$ 同时冻结 $u$ 的半步，(ii) 一个推进 $u$ 同时冻结 $p$ 的全步，以及 (iii) 另一个推进 $p$ 同时冻结 $u$ 的半步。从 $(p^{n},u^{n})$ 出发，推导中间压力 $p^{n+1/2}$、下一步速度 $u^{n+1}$ 和下一步压力 $p^{n+1}$ 的显式更新公式，用 $K$、$\\rho$、$\\Delta x$、$\\Delta t$ 和中心差分算子表示。然后，仅使用上述定义和周期性分部求和性质，计算该步骤的离散能量平衡，即 $E^{n+1}-E^{n}$ 的值，以闭式解析表达式的形式给出。你的最终答案必须包含三个更新公式以及单步离散能量变化的单一表达式。不需要进行数值计算。", "solution": "该偏微分方程组可以分裂为两个子问题。\n子问题A（$p$ 的演化）：$p_t = -K u_x$, $u_t = 0$。\n子问题B（$u$ 的演化）：$p_t = 0$, $u_t = - \\frac{1}{\\rho} p_x$。\n\n这些子问题的离散化版本是：\n子问题A：$\\frac{d p_j}{dt} = -K (\\delta_x u)_j$, $\\frac{d u_{j+1/2}}{dt} = 0$。\n子问题B：$\\frac{d p_j}{dt} = 0$, $\\frac{d u_{j+1/2}}{dt} = - \\frac{1}{\\rho} (\\delta_x p)_{j+1/2}$。\n\nStrang分裂格式使用前向欧拉步依次应用这些算子。\n\n**(i) 第一个关于 $p$ 的半步，时间步长为 $\\Delta t/2$：**\n我们将 $p$ 从时间层 $n$ 推进到 $n+1/2$，同时将 $u$ 固定在 $u^n$。步长为 $\\Delta t/2$。\n$$\np_j^{n+1/2} = p_j^n + \\frac{\\Delta t}{2} \\left( -K (\\delta_x u^n)_j \\right) = p_j^n - \\frac{K \\Delta t}{2} (\\delta_x u^n)_j\n$$\n此步之后的状态是 $(p^{n+1/2}, u^n)$。\n\n**(ii) 关于 $u$ 的全步，时间步长为 $\\Delta t$：**\n我们将 $u$ 从时间层 $n$ 推进到 $n+1$，同时将 $p$ 固定在中间值 $p^{n+1/2}$。步长为 $\\Delta t$。\n$$\nu_{j+1/2}^{n+1} = u_{j+1/2}^n + \\Delta t \\left( - \\frac{1}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} \\right) = u_{j+1/2}^n - \\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2}\n$$\n此步之后的状态是 $(p^{n+1/2}, u^{n+1})$。\n\n**(iii) 第二个关于 $p$ 的半步，时间步长为 $\\Delta t/2$：**\n我们将 $p$ 从中间层 $n+1/2$ 推进到 $n+1$，同时将 $u$ 固定在其新值 $u^{n+1}$。步长为 $\\Delta t/2$。\n$$\np_j^{n+1} = p_j^{n+1/2} + \\frac{\\Delta t}{2} \\left( -K (\\delta_x u^{n+1})_j \\right) = p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j\n$$\n最终状态是 $(p^{n+1}, u^{n+1})$。\n\n接下来，我们推导离散能量平衡，计算 $E^{n+1} - E^n$。\n$$\nE^{n+1} - E^n = \\sum_{j=0}^{J-1} \\left( \\frac{1}{2K} \\left((p_j^{n+1})^2 - (p_j^n)^2\\right) + \\frac{\\rho}{2} \\left((u_{j+1/2}^{n+1})^2 - (u_{j+1/2}^n)^2\\right) \\right) \\Delta x\n$$\n我们分别分析和中的两项。\n\n对于压力项，我们重新整理公式(i)和(iii)得到 $p_j^n = p_j^{n+1/2} + \\frac{K \\Delta t}{2} (\\delta_x u^n)_j$ 和 $p_j^{n+1} = p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j$。\n$(p_j^{n+1})^2 = (p_j^{n+1/2})^2 - K \\Delta t \\, p_j^{n+1/2} (\\delta_x u^{n+1})_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 ((\\delta_x u^{n+1})_j)^2$\n$(p_j^{n})^2 = (p_j^{n+1/2})^2 + K \\Delta t \\, p_j^{n+1/2} (\\delta_x u^n)_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 ((\\delta_x u^n)_j)^2$\n相减得到：\n$(p_j^{n+1})^2 - (p_j^n)^2 = -K \\Delta t \\, p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right)$\n\n对于速度项，使用 $a^2-b^2=(a-b)(a+b)$ 和子步骤 (ii) 的结果：\n$(u_{j+1/2}^{n+1})^2 - (u_{j+1/2}^n)^2 = (u_{j+1/2}^{n+1} - u_{j+1/2}^n)(u_{j+1/2}^{n+1} + u_{j+1/2}^n) = \\left(-\\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2}\\right) (u_{j+1/2}^{n+1} + u_{j+1/2}^n)$\n\n将这些代回 $E^{n+1} - E^n$ 的表达式中并简化：\n$E^{n+1} - E^n = \\sum_{j=0}^{J-1} \\Delta x \\left[ \\frac{1}{2K} \\left( -K \\Delta t \\, p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j + \\dots \\right) + \\frac{\\rho}{2} \\left( -\\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} (u_{j+1/2}^{n+1} + u_{j+1/2}^n) \\right) \\right]$\n$E^{n+1} - E^n = \\sum_{j=0}^{J-1} \\Delta x \\left[ -\\frac{\\Delta t}{2} p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j - \\frac{\\Delta t}{2} (u_{j+1/2}^{n+1} + u_{j+1/2}^n) (\\delta_x p^{n+1/2})_{j+1/2} + \\frac{K (\\Delta t)^2}{8} \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right) \\right]$\n\n利用分部求和性质 $\\sum_j p_j (\\delta_x u)_j \\Delta x = - \\sum_j u_{j+1/2} (\\delta_x p)_{j+1/2} \\Delta x$，我们发现前两项之和为零。\n因此，能量平衡中唯一剩下的项是：\n$$\nE^{n+1} - E^n = \\sum_{j=0}^{J-1} \\frac{K (\\Delta t)^2}{8} \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right) \\Delta x\n$$\n该表达式可以进一步写为：\n$$\nE^{n+1} - E^n = \\frac{1}{2K} \\sum_{j=0}^{J-1} \\left( (p_j^{n+1} - p_j^{n+1/2})^2 - (p_j^{n+1/2} - p_j^n)^2 \\right) \\Delta x\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_j^{n+1/2} = p_j^n - \\frac{K \\Delta t}{2} (\\delta_x u^n)_j \\\\\nu_{j+1/2}^{n+1} = u_{j+1/2}^n - \\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} \\\\\np_j^{n+1} = p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j \\\\\nE^{n+1} - E^n = \\frac{1}{2K} \\sum_{j=0}^{J-1} \\left( (p_j^{n+1} - p_j^{n+1/2})^2 - (p_j^{n+1/2} - p_j^n)^2 \\right) \\Delta x\n\\end{pmatrix}\n}\n$$", "id": "3612339"}]}