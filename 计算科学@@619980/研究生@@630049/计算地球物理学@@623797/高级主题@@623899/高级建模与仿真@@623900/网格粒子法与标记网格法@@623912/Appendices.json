{"hands_on_practices": [{"introduction": "任何显式数值模拟的成功运行都有一个基本前提：稳定性。在将粒子网格耦合方法应用于地球物理问题时，时间步长的选择必须同时满足两个条件：确保基于网格的场求解器不会发散，并保证粒子在单个时间步内不会移动得过远。这个练习 [@problem_id:3612596] 将引导您从第一性原理出发，推导出一个统一的稳定性判据，它将材料的物理性质（通过波速 $c$ 体现）、网格的空间分辨率 $\\Delta x$ 和时间步长 $\\Delta t$ 联系在一起。", "problem": "考虑一个在一维均匀交错网格上的显式弹-声场求解器，该求解器与用于物质标记点的质点网格法（PIC）粒子更新耦合。在计算地球物理学中，当使用质点网格法（PIC）和标记与网格法（MAC）策略来平流演化波场中的属性时，这种做法很常见。在足够小的空间邻域内，介质是线性的、均匀的、各向同性的，其质量密度为 $\\rho$，体积模量为 $K$。最大特征波速为 $c = \\sqrt{K/\\rho}$，网格间距为 $\\Delta x$。该场求解器在交错网格上使用空间中心、时间中心（蛙跳）显式方法来推进一阶声学变量（压力和速度）。粒子使用插值得到的速度场，通过一阶显式更新进行推进。\n\n从一阶声学系统、特征波速的定义以及显式交错网格蛙跳更新出发，推导时间步长 $\\Delta t$ 的一个保守上界，该上界需同时满足以下两个条件：\n- 显式场更新对网格所允许的所有空间傅里叶模式都稳定，并且\n- 满足粒子穿越约束，即在单个时间步内，没有粒子会穿越超过一个网格单元。\n\n您的答案必须是仅用 $c$ 和 $\\Delta x$ 表示的单个闭式解析表达式。时间步长以秒为单位表示。无需进行数值计算。", "solution": "该问题被认为是有效的，因为它具有科学依据、适定且客观。它描述了计算物理学中一个涉及耦合数值格式稳定性的标准问题。所有变量和条件都已明确定义。\n\n任务是为一个耦合的质点网格法（PIC）和有限差分场求解器系统推导时间步长 $\\Delta t$ 的一个保守上界。这需要同时满足两个独立的条件：显式场求解器的稳定性和粒子穿越约束。最终表达式必须用特征波速 $c$ 和网格间距 $\\Delta x$ 来表示。\n\n让我们分别推导每个约束的条件。\n\n**1. 显式场更新稳定性（CFL 条件）**\n\n控制方程为一阶一维线性声学系统：\n$$\n\\frac{\\partial p}{\\partial t} + K \\frac{\\partial v_x}{\\partial x} = 0\n$$\n$$\n\\rho \\frac{\\partial v_x}{\\partial t} + \\frac{\\partial p}{\\partial x} = 0\n$$\n其中 $p$ 是声压，$v_x$ 是 $x$ 方向的质点速度，$\\rho$ 是质量密度，$K$ 是体积模量。特征波速由 $c = \\sqrt{K/\\rho}$ 给出。\n\n数值方法是在交错网格上采用空间中心、时间中心（蛙跳）的显式格式。设压力 $p$ 定义在网格节点 $x_j = j \\Delta x$ 和整数时间步 $t^n = n \\Delta t$ 上。设速度 $v_x$ 定义在交错节点 $x_{j+1/2} = (j+1/2) \\Delta x$ 和半整数时间步 $t^{n+1/2} = (n+1/2) \\Delta t$ 上。该系统的有限差分近似为：\n$$\n\\frac{p_j^{n+1} - p_j^n}{\\Delta t} = -K \\frac{v_{x, j+1/2}^{n+1/2} - v_{x, j-1/2}^{n+1/2}}{\\Delta x}\n$$\n$$\n\\rho \\frac{v_{x, j+1/2}^{n+1/2} - v_{x, j+1/2}^{n-1/2}}{\\Delta t} = - \\frac{p_{j+1}^{n} - p_j^n}{\\Delta x}\n$$\n为了分析其稳定性，我们进行 von Neumann 稳定性分析。我们寻找形式为 $p_j^n = \\hat{p}(k) G^n \\exp(i k x_j)$ 和 $v_{x, j+1/2}^{n \\pm 1/2} = \\hat{v}_x(k) G^{n \\pm 1/2} \\exp(i k x_{j+1/2})$ 的解，其中 $G$ 是放大因子，$k$ 是波数。将这些解代入有限差分方程并简化，得到该格式的数值色散关系：\n$$\n\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\pm \\frac{c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n其中 $\\omega$ 是角频率，满足 $G = \\exp(-i \\omega \\Delta t)$。为使格式稳定，放大因子 $|G|$ 的模必须小于等于 1。这要求 $\\omega$ 是一个实数。为了使 $\\omega$ 为实数，用于求解 $\\omega$ 的反正弦函数的自变量必须为实数，且其模必须小于或等于1：\n$$\n\\left| \\frac{c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right| \\le 1\n$$\n该不等式必须对网格所允许的所有空间傅里叶模式 $k$ 都成立。最严格的情况（即对 $\\Delta t$ 施加最紧约束的情况）发生在使 $|\\sin(k \\Delta x / 2)|$ 项最大化的模式下。该项的最大值为 1，出现在奈奎斯特波数 $k_{max} = \\pi / \\Delta x$ 处。\n代入这个最坏情况的值，稳定性条件变为：\n$$\n\\frac{c \\Delta t}{\\Delta x} \\le 1\n$$\n这就得出了对时间步长的第一个约束，即著名的 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\Delta t \\le \\frac{\\Delta x}{c}\n$$\n\n**2. 粒子穿越约束**\n\n第二个约束是，在单个时间步内，任何粒子都不应穿越超过一个网格单元。粒子通过一阶显式更新进行平流：\n$$\nx_p(t + \\Delta t) = x_p(t) + v_p(t) \\Delta t\n$$\n其中 $x_p$ 是粒子的位置，$v_p$ 是其速度，通过从网格插值速度场 $v_x$ 得到。一个粒子在单个时间步内的位移是 $|v_p(t)| \\Delta t$。该约束要求此位移小于或等于网格单元的宽度 $\\Delta x$：\n$$\n|v_p(t)| \\Delta t \\le \\Delta x\n$$\n为确保此条件对所有粒子在所有时间都成立，我们必须考虑模拟中可能的最大粒子速度 $\\max(|v_x|)$：\n$$\n\\Delta t \\le \\frac{\\Delta x}{\\max(|v_x|)}\n$$\n\n**3. 组合的保守上界**\n\n时间步长 $\\Delta t$ 必须同时满足这两个约束。因此，它必须小于或等于两个推导出的上界中的最小值：\n$$\n\\Delta t \\le \\min\\left( \\frac{\\Delta x}{c}, \\frac{\\Delta x}{\\max(|v_x|)} \\right)\n$$\n为了确定一个仅用 $c$ 和 $\\Delta x$ 表示的单一解析表达式，我们必须评估 $c$ 和 $\\max(|v_x|)$ 之间的关系。问题陈述该求解器用于“线性、均匀、各向同性”的弹-声场。线性声学理论的一个基本原则是，粒子（或物质）的速度远小于波的传播速度。也就是说，所模拟的物理范畴满足：\n$$\n\\max(|v_x|) \\ll c\n$$\n这个不等式对两个稳定性界限有直接影响。如果 $\\max(|v_x|) \\ll c$，那么 $\\frac{1}{\\max(|v_x|)} \\gg \\frac{1}{c}$。这意味着：\n$$\n\\frac{\\Delta x}{\\max(|v_x|)} \\gg \\frac{\\Delta x}{c}\n$$\n因此，粒子穿越约束远没有场求解器（CFL）约束严格。为了同时满足这两个条件，我们必须遵守两者中更严格的那个。因此，两个上界中的最小值就是 CFL 条件。\n\n因此，同时满足这两个条件的时间步长 $\\Delta t$ 的保守上界由场更新稳定性决定：\n$$\n\\Delta t \\le \\frac{\\Delta x}{c}\n$$\n$\\Delta t$ 的最大允许值即为此上界。", "answer": "$$\\boxed{\\frac{\\Delta x}{c}}$$", "id": "3612596"}, {"introduction": "在 PIC/MAC 方法中，材料属性（如粘度或密度）由拉格朗日粒子携带，但在求解控制方程时，这些属性通常需要在欧拉网格的特定位置（例如交错网格的单元面）上确定。如何从离散的粒子信息中获得物理上一致的网格属性是一个核心挑战，简单的算术平均往往会导致错误的结果。本练习 [@problem_id:3612571] 聚焦于粘性流体模拟中的一个经典问题，通过要求数值通量与跨越材料界面的物理通量保持连续，您将推导出计算有效粘度的正确方法。", "problem": "要在 Marker-And-Cell (MAC) 交错网格上计算非均匀粘性柱中的缓慢剪切流，其中速度位于面心，压力位于单元中心。单元中心的粘度值通过在每个控制体积内进行 Particle-In-Cell (PIC) 标记点采样获得。考虑两个相邻的控制体积，它们在位置 $x_f$ 处共享一个公共垂直面，其中心分别位于 $x_L$ 和 $x_R$，到该面的距离表示为 $\\Delta x_L = x_f - x_L$ 和 $\\Delta x_R = x_R - x_f$。从标记点推断出的单元中心粘度为 $\\eta_L$ 和 $\\eta_R$，并假定在每个控制体积内为分段常数。将面法向速度表示为 $u(x)$，其在单元中心的值为 $u_L = u(x_L)$ 和 $u_R = u(x_R)$。在没有体积力和压力梯度的情况下，一维稳态斯托克斯动量平衡方程简化为粘性剪切通量在空间上是恒定的这一论述。\n\n在有限体积离散化中，我们寻求一个有效的面粘度 $\\eta_f$，使得根据跨越距离 $\\Delta x_L + \\Delta x_R$ 的两点差分 $u_L$ 和 $u_R$ 构建的离散粘性通量，与由分段常数粘度剖面产生的精确恒定粘性通量相匹配。从斯托克斯流中粘性剪切应力的定义和通量连续性要求出发，依据第一性原理推导出一个关于 $\\eta_L$、$\\eta_R$、$\\Delta x_L$ 和 $\\Delta x_R$ 的 $\\eta_f$ 的闭式表达式，该表达式能保证对于任意正值 $\\eta_L$、$\\eta_R$ 和非均匀的 $\\Delta x_L$、$\\Delta x_R$，粘性通量在跨越面时保持连续。然后，简要解释为什么 $\\eta_L$ 和 $\\eta_R$ 的算术平均值在这种情况下通常无法保持通量连续性。\n\n将你的最终答案报告为关于 $\\eta_f$、$\\eta_L$、$\\eta_R$、$\\Delta x_L$ 和 $\\Delta x_R$ 的单一显式表达式。不需要进行数值计算，也不需要四舍五入。最终答案中不要包含单位。", "solution": "用户提交了一个问题以供验证和解答。\n\n### 步骤1：提取已知条件\n- **流动类型：** 非均匀粘性柱中的缓慢剪切流。\n- **数值方案：** Marker-And-Cell (MAC) 交错网格。\n- **变量位置：** 面心速度，单元中心压力。\n- **粘度：** 单元中心值 $\\eta_{L}$ 和 $\\eta_{R}$，通过 Particle-In-Cell (PIC) 采样获得，假定在每个控制体积内为分段常数。\n- **几何结构：** 两个相邻的控制体积，中心位于 $x_{L}$ 和 $x_{R}$，在 $x_{f}$ 处共享一个垂直面。\n- **网格间距：** 定义为 $\\Delta x_{L} = x_{f} - x_{L}$ 和 $\\Delta x_{R} = x_{R} - x_{f}$ 的非均匀距离。\n- **速度：** 面法向速度函数 $u(x)$，其单元中心值为 $u_{L} = u(x_{L})$ 和 $u_{R} = u(x_{R})$。\n- **控制物理：** 在没有体积力和压力梯度的情况下的一维稳态斯托克斯动量平衡。这简化为粘性剪切通量（应力）在空间上恒定的条件。\n- **目标：** 推导有效面粘度 $\\eta_{f}$ 的闭式表达式。\n- **约束条件：** 定义为 $\\eta_{f}$ 乘以两点速度差商的离散粘性通量，必须与从分段常数粘度剖面推导出的精确恒定粘性通量相匹配。\n- **次要目标：** 解释为什么 $\\eta_{L}$ 和 $\\eta_{R}$ 的算术平均值通常是不正确的。\n\n### 步骤2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n- **科学基础：** 该问题牢固地植根于连续介质力学（斯托克斯流）原理和计算流体动力学的标准数值方法（有限体积法、MAC网格、PIC方法）。将物理问题简化为一维恒定剪切应力是离散化粘性项的一个有效且标准的起点。所有概念都是该领域的标准概念。\n- **适定性：** 该问题是适定的。它提供了一个清晰的物理约束（通量连续性）和一个明确的数学结构（分段常数属性、有限体积离散化），可以从中推导出有效粘度 $\\eta_f$ 的唯一表达式。\n- **客观性：** 语言技术性强、精确，没有任何主观性或模糊性。\n\n该问题没有表现出任何列出的缺陷。它并非科学上不合理、不可形式化、不完整、不切实际、不适定或微不足道。它代表了在粘性流数值模型中处理材料非均匀性的一个基本推导。\n\n### 步骤3：结论和行动\n问题是**有效的**。将提供解答。\n\n### 解答推导\n该问题要求推导有效面粘度 $\\eta_f$，以确保数值方案在材料界面上保持通量的物理连续性。\n\n控制物理是在没有压力梯度或体积力情况下的​​一维稳态斯托克斯动量方程，其形式为应力张量的散度为零。在一维情况下，对于剪切流，这简化为：\n$$\n\\frac{d\\tau}{dx} = 0\n$$\n其中 $\\tau$ 是粘性剪切应力。这意味着剪切应力 $\\tau$ 在整个域内必须是恒定的。我们用 $\\tau_c$ 表示这个恒定应力。牛顿流体的本构关系将剪切应力定义为：\n$$\n\\tau(x) = \\eta(x) \\frac{du}{dx}\n$$\n其中 $\\eta(x)$ 是动力粘度，$u(x)$ 是速度。\n\n由于 $\\tau(x) = \\tau_c$，我们可以将速度梯度写为：\n$$\n\\frac{du}{dx} = \\frac{\\tau_c}{\\eta(x)}\n$$\n问题指出粘度是分段常数：对于 $x \\in [x_L, x_f]$，$\\eta(x) = \\eta_L$；对于 $x \\in [x_f, x_R]$，$\\eta(x) = \\eta_R$。我们可以沿着连接单元中心与公共面的两个线段对速度梯度方程进行积分。\n\n首先，我们从左侧单元中心 $x_L$ 积分到面 $x_f$：\n$$\n\\int_{u(x_L)}^{u(x_f)} du = \\int_{x_L}^{x_f} \\frac{\\tau_c}{\\eta_L} dx\n$$\n$$\nu(x_f) - u_L = \\frac{\\tau_c}{\\eta_L} (x_f - x_L) = \\frac{\\tau_c \\Delta x_L}{\\eta_L}\n$$\n\n接下来，我们从面 $x_f$ 积分到右侧单元中心 $x_R$：\n$$\n\\int_{u(x_f)}^{u(x_R)} du = \\int_{x_f}^{x_R} \\frac{\\tau_c}{\\eta_R} dx\n$$\n$$\nu_R - u(x_f) = \\frac{\\tau_c}{\\eta_R} (x_R - x_f) = \\frac{\\tau_c \\Delta x_R}{\\eta_R}\n$$\n\n在单元中心速度格式中，面速度 $u(x_f)$ 不是一个显式变量。我们可以通过将以上两个方程相加来消去它：\n$$\n(u_R - u(x_f)) + (u(x_f) - u_L) = \\frac{\\tau_c \\Delta x_R}{\\eta_R} + \\frac{\\tau_c \\Delta x_L}{\\eta_L}\n$$\n$$\nu_R - u_L = \\tau_c \\left( \\frac{\\Delta x_L}{\\eta_L} + \\frac{\\Delta x_R}{\\eta_R} \\right)\n$$\n这使我们能够用已知的单元中心速度 $u_L$ 和 $u_R$ 以及给定的属性来表示精确的、恒定的物理通量 $\\tau_c$：\n$$\n\\tau_c = \\frac{u_R - u_L}{\\frac{\\Delta x_L}{\\eta_L} + \\frac{\\Delta x_R}{\\eta_R}}\n$$\n这就是离散格式必须匹配的“精确恒定粘性通量”。\n\n现在，我们考虑在面 $x_f$ 处的通量的有限体积离散化。这个离散通量，我们记为 $\\tau_f$，是使用有效面粘度 $\\eta_f$ 和基于两个单元中心值 $u_L$ 和 $u_R$ 的速度梯度的有限差分近似来构建的。这两点之间的总距离是 $x_R - x_L = (x_R - x_f) + (x_f - x_L) = \\Delta x_R + \\Delta x_L$。因此，离散通量定义为：\n$$\n\\tau_f = \\eta_f \\left( \\frac{u_R - u_L}{x_R - x_L} \\right) = \\eta_f \\frac{u_R - u_L}{\\Delta x_L + \\Delta x_R}\n$$\n为确保数值方案在物理上是一致的，我们强制要求离散通量等于精确通量，即 $\\tau_f = \\tau_c$：\n$$\n\\eta_f \\frac{u_R - u_L}{\\Delta x_L + \\Delta x_R} = \\frac{u_R - u_L}{\\frac{\\Delta x_L}{\\eta_L} + \\frac{\\Delta x_R}{\\eta_R}}\n$$\n假设在 $u_R \\neq u_L$ 的非静态情况下，我们可以从两边消去 $(u_R - u_L)$ 项：\n$$\n\\frac{\\eta_f}{\\Delta x_L + \\Delta x_R} = \\frac{1}{\\frac{\\Delta x_L}{\\eta_L} + \\frac{\\Delta x_R}{\\eta_R}}\n$$\n求解有效面粘度 $\\eta_f$：\n$$\n\\eta_f = (\\Delta x_L + \\Delta x_R) \\left( \\frac{1}{\\frac{\\Delta x_L \\eta_R + \\Delta x_R \\eta_L}{\\eta_L \\eta_R}} \\right)\n$$\n$$\n\\eta_f = (\\Delta x_L + \\Delta x_R) \\left( \\frac{\\eta_L \\eta_R}{\\Delta x_L \\eta_R + \\Delta x_R \\eta_L} \\right)\n$$\n这可以写成最终的闭式表达式：\n$$\n\\eta_f = \\frac{(\\Delta x_L + \\Delta x_R) \\eta_L \\eta_R}{\\Delta x_L \\eta_R + \\Delta x_R \\eta_L}\n$$\n该表达式代表两个单元中心粘度的距离加权调和平均值。\n\n最后，我们简要解释为什么简单的算术平均值通常会失败。算术平均值，可能按距离加权，将是 $\\eta_{a} = \\frac{\\Delta x_L \\eta_L + \\Delta x_R \\eta_R}{\\Delta x_L + \\Delta x_R}$。在离散通量公式中使用此粘度将得到 $\\tau_a = \\eta_a \\frac{u_R - u_L}{\\Delta x_L + \\Delta x_R} = \\frac{\\Delta x_L \\eta_L + \\Delta x_R \\eta_R}{\\Delta x_L + \\Delta x_R} \\frac{u_R - u_L}{\\Delta x_L + \\Delta x_R}$。除非 $\\eta_L = \\eta_R$，否则此通量 $\\tau_a$ 不等于精确通量 $\\tau_c$。物理原因是这两层的流动阻力是串联的。在电学类比中，速度是电势，应力是电流，而 $\\frac{\\Delta x}{\\eta}$ 是电阻，总电阻是各个电阻之和：$R_{total} = R_L + R_R = \\frac{\\Delta x_L}{\\eta_L} + \\frac{\\Delta x_R}{\\eta_R}$。推导出的有效粘度正确地反映了这种串联求和。粘度的算术平均值类似于对电导率（电阻率的倒数）进行平均，这适用于并联流动配置，而不适用于问题中描述的串联配置。因此，算术平均违反了通量恒定的物理约束。", "answer": "$$ \\boxed{ \\frac{(\\Delta x_L + \\Delta x_R)\\eta_L \\eta_R}{\\Delta x_L \\eta_R + \\Delta x_R \\eta_L} } $$", "id": "3612571"}]}