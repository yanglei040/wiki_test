{"hands_on_practices": [{"introduction": "在应用毕奥理论之前，我们必须首先确定其关键参数：毕奥系数 $\\alpha$ 和毕奥模量 $M$。本练习 [@problem_id:3503711] 将向您展示，这些参数并非抽象的数学构造，而是可以直接从岩石骨架和孔隙流体等基本、可测量的物理属性中推导出来的。通过完成这一推导与计算，您将对这些系数所代表的物理意义，特别是流体压力对岩石整体变形的贡献，建立起更深刻的直观理解。", "problem": "考虑一个各向同性、均质、完全饱和的多孔岩石，在 Biot 孔隙弹性理论的线性范围内经历小的等温变形。设多孔骨架的排液体积模量为 $K_d$，固体颗粒的体积模量为 $K_s$，孔隙流体的体积模量为 $K_f$，孔隙度为 $\\phi$。从模量、质量守恒和热力学一致性的基本定义出发：\n\n- 排液体积模量 $K_d$ 由排液静水压力试验定义，在该试验中孔隙压力保持恒定，$K_d$ 为平均总应力增量与相应体积应变增量之比。\n- 固体颗粒体积模量 $K_s$ 由无套静水压力试验定义，在该试验中施加相等的围压增量和孔隙压力增量，因此有效应力保持不变，试样像固相一样发生应变。\n- 孔隙流体体积模量 $K_f$ 由等温流体压缩性定义，它将流体密度变化与孔隙压力变化联系起来。\n- 孔隙度 $\\phi$ 是孔隙体积与总体积之比。\n- Biot 有效应力系数 $\\alpha$ 在体积响应的线性孔隙弹性本构定律中，将孔隙压力映射为平均有效应力。\n- Biot 储存模量 $M$ 在固定体积应变下，将孔隙压力映射为流体含量变化。\n\n从这些基础出发，首先通过分析无套静水压力试验，推导出用 $K_d$ 和 $K_s$ 表示的 $\\alpha$ 表达式。接下来，利用孔隙流体的质量守恒和热力学一致性的要求，推导出用 $\\alpha$、$\\phi$、$K_s$ 和 $K_f$ 表示的 $M$ 表达式。然后，根据数据 $K_d = 4$ GPa、$K_s = 36$ GPa、$K_f = 2$ GPa 和 $\\phi = 0.2$ 计算 $\\alpha$ 和 $M$ 的值。\n\n将最终数值答案以 $[\\alpha, M]$ 顺序的双元素行矩阵形式报告。将两个条目均四舍五入到四位有效数字。将 $M$ 的最终值以吉帕斯卡（GPa）为单位表示。\n\n最后，简要讨论计算值在骨架柔度以及流体与固体对储存的贡献方面的物理意义（该讨论不影响所需的数值答案）。", "solution": "### 解答推导和计算\n\n我们采用压应力和压应变（体积减小）为正的符号约定。\n\n**第一部分：Biot 有效应力系数 $\\alpha$ 的推导**\n\n体积响应的线性孔隙弹性本构定律将体积应变增量 $d\\epsilon_v$ 与平均总应力增量 $d\\sigma$ 以及孔隙压力增量 $dp_f$ 联系起来。\n$$\nd\\epsilon_v = \\frac{1}{K_d} (d\\sigma - \\alpha dp_f)\n\\quad (*)$$\n现在我们分析问题中描述的无套静水压力试验。在该试验中，试样承受相等的围压增量和孔隙压力增量。平均总应力等于围压，因此试验条件是 $d\\sigma = dp_f$。\n\n将此条件代入本构关系 $(*)$：\n$$\nd\\epsilon_v = \\frac{1}{K_d} (dp_f - \\alpha dp_f) = \\frac{1 - \\alpha}{K_d} dp_f\n$$\n在无套试验中，由于施加在块体材料上的周围压力和孔隙内的压力等量增加，多孔骨架本身不承受额外的净应力。试样总体积的变化仅仅是因为构成基质的固体颗粒被压缩。这种变形等同于由颗粒材料构成的无孔隙固体在相同静水压力作用下的变形。在静水压力变化 $dp_f$ 下，固体颗粒材料的体积应变 $d\\epsilon_s$ 由固体颗粒的体积模量 $K_s$ 定义：\n$$\nd\\epsilon_s = \\frac{1}{K_s} dp_f\n$$\n在无套试验中，总体积应变 $d\\epsilon_v$ 必须等于颗粒材料的体积应变 $d\\epsilon_s$。因此：\n$$\n\\frac{1 - \\alpha}{K_d} dp_f = \\frac{1}{K_s} dp_f\n$$\n假设 $dp_f \\neq 0$，我们可以消去此项并求解 $\\alpha$：\n$$\n1 - \\alpha = \\frac{K_d}{K_s}\n$$\n$$\n\\alpha = 1 - \\frac{K_d}{K_s}\n$$\n这就是所要求的 Biot 有效应力系数的表达式。\n\n**第二部分：Biot 储存模量 $M$ 的推导**\n\nBiot 储存模量 $M$ 通过第二个本构方程定义，该方程将流体含量增量 $d\\zeta$ 与体积应变和孔隙压力的变化联系起来：\n$$\nd\\zeta = \\alpha d\\epsilon_v + \\frac{1}{M} dp_f\n$$\n其中 $1/M$ 项定义了在恒定总体积应变 ($d\\epsilon_v = 0$) 下，单位孔隙压力增加所引起的流体含量增加，即 $1/M = (\\partial\\zeta / \\partial p_f)_{\\epsilon_v}$。\n\n从物理上看，在总体积不变的情况下，注入的流体体积必须被两种机制所容纳：(1) 压缩孔隙中已有的流体，以及 (2) 压缩固体颗粒本身以创造额外的孔隙空间。\n1.  由于流体压缩性 $1/K_f$ 产生的储存。原有孔隙体积为 $\\phi$，因此这部分贡献为 $\\phi/K_f$。\n2.  由于固体颗粒压缩性 $1/K_s$ 产生的储存。在 $d\\epsilon_v=0$ 条件下，孔隙压力的增加会压缩固体颗粒，使得孔隙体积增加。这一过程的贡献可以（通过更详细的推导）证明为 $(\\alpha - \\phi)/K_s$。\n\n综合这两个物理效应，我们得到了 $1/M$ 的标准表达式，它满足热力学一致性：\n$$\n\\frac{1}{M} = \\frac{\\alpha - \\phi}{K_s} + \\frac{\\phi}{K_f}\n$$\n这个表达式清晰地展示了总储存能力是如何由流体和固体的压缩性共同决定的。\n\n**第三部分：数值计算**\n给定数据：$K_d = 4$ GPa，$K_s = 36$ GPa，$K_f = 2$ GPa，以及 $\\phi = 0.2$。\n\n- **计算 $\\alpha$**：\n$$\n\\alpha = 1 - \\frac{K_d}{K_s} = 1 - \\frac{4}{36} = 1 - \\frac{1}{9} = \\frac{8}{9}\n$$\n换算成小数，$\\alpha \\approx 0.88888...$\n四舍五入到四位有效数字，$\\alpha = 0.8889$。\n\n- **计算 $M$**：\n我们使用表达式 $\\frac{1}{M} = \\frac{\\alpha - \\phi}{K_s} + \\frac{\\phi}{K_f}$。\n首先，求出各项的值：\n$$\n\\alpha - \\phi = \\frac{8}{9} - 0.2 = \\frac{8}{9} - \\frac{2}{10} = \\frac{8}{9} - \\frac{1}{5} = \\frac{40 - 9}{45} = \\frac{31}{45}\n$$\n现在计算 $M$ 倒数的两项：\n$$\n\\frac{\\alpha - \\phi}{K_s} = \\frac{31/45}{36} = \\frac{31}{1620} \\text{ GPa}^{-1}\n$$\n$$\n\\frac{\\phi}{K_f} = \\frac{0.2}{2} = 0.1 \\text{ GPa}^{-1}\n$$\n将各项相加：\n$$\n\\frac{1}{M} = \\frac{31}{1620} + 0.1 = \\frac{31}{1620} + \\frac{162}{1620} = \\frac{193}{1620} \\text{ GPa}^{-1}\n$$\n以小数形式表示，$\\frac{1}{M} \\approx 0.0191358... + 0.1 = 0.1191358...$ GPa$^{-1}$。\n现在，计算 $M$：\n$$\nM = \\frac{1620}{193} \\text{ GPa} \\approx 8.39378... \\text{ GPa}\n$$\n四舍五入到四位有效数字，$M = 8.394$ GPa。\n\n**第四部分：物理意义**\n\n-   $\\alpha = 0.8889$ 的值接近于1，这表明在引起多孔介质体积变形方面，孔隙流体压力几乎与平均总应力同样有效。这是固体骨架比固体颗粒本身柔性得多（$K_d \\ll K_s$）的材料的特征，此处即是如此（$4$ GPa $\\ll 36$ GPa）。\n\n-   储存模量 $M = 8.394$ GPa 量化了在保持岩石总体积不变的情况下，将一定体积的流体注入岩石所需的压力。其倒数 $1/M$ 代表比储水容量。$1/M$ 的两个组成部分是由于颗粒压缩性引起的储存（$\\frac{\\alpha-\\phi}{K_s} \\approx 0.0191$ GPa$^{-1}$）和由于流体压缩性引起的储存（$\\frac{\\phi}{K_f} = 0.1$ GPa$^{-1}$）。在这种情况下，流体压缩性项大约是颗粒压缩性项的5倍。这意味着，当流体在恒定总体积下被压入岩石时，大部分储存效应来自压缩已存在于孔隙中的流体，而不是来自压缩固体颗粒以创造更多孔隙空间。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8889 & 8.394\n\\end{pmatrix}\n}\n$$", "id": "3503711"}, {"introduction": "毕奥理论在地球物理学中的一个主要应用是预测地震波在饱和流体岩石中的传播，这取决于岩石在不排水条件下的刚度。本练习 [@problem_id:3577937] 将指导您推导不排水体积模量 $K_u$ 的表达式，并揭示该理论与岩石物理学的基石——著名的 Gassmann 方程之间的内在联系。这对于从理论上理解地震速度与岩石物理性质的关系至关重要。", "problem": "一块各向同性、均质的多孔岩石被单相流体饱和，并在与勘探地震学相关的低频范围内受到准静态各向同性加载。岩石骨架的排水响应由排水体积模量$K_d$表征，而矿物颗粒具有固体体积模量$K_s$。孔隙流体的体积模量为$K_f$，岩石孔隙度为$\\phi$。给定$K_s = 34\\,\\mathrm{GPa}$，$K_d = 14\\,\\mathrm{GPa}$，$K_f = 2.4\\,\\mathrm{GPa}$，以及$\\phi = 0.22$。\n\n从Maurice Anthony Biot的线性孔隙弹性本构框架（Biot孔隙弹性理论）以及固相和液相在低频极限下的基本混合物压缩性考虑出发，推导出饱和岩石的不排水体积模量$K_u$（用$K_s$、$K_d$、$K_f$和$\\phi$表示）。然后，独立地使用归因于Martin H. Gassmann的低频关系式（Gassmann关系式）求出饱和体积模量$K_{\\mathrm{sat}}$，并对两个结果进行数值比较以验证其一致性。\n\n将最终答案表示为$K_u$的数值（单位为 GPa），并四舍五入到4位有效数字。", "solution": "此问题被评估为有效。它在科学上基于连续介质力学和孔隙弹性力学的原理，提法恰当，数据充分且一致，陈述客观。给定的物理参数对于地质材料是符合实际的。\n\n解题过程将按要求分为三个部分：\n1.  从Biot线性孔隙弹性理论推导不排水体积模量$K_u$。\n2.  陈述饱和体积模量$K_{\\mathrm{sat}}$的Gassmann关系式，并验证其与Biot理论推导结果的一致性。\n3.  模量的数值计算。\n\n**1. 从Biot孔隙弹性理论推导**\n\n在准静态、低频极限下，各向同性、均质孔隙弹性介质的本构关系可以用总平均应力$\\sigma_m$、整体材料的体积应变$\\epsilon_v$、孔隙流体压力$p_f$和流体含量增量$\\zeta$来表示。采用压缩为正的约定，这些关系式为：\n$$ \\sigma_m = K_d \\epsilon_v + \\alpha p_f $$\n$$ \\zeta = \\alpha \\epsilon_v + \\frac{1}{M} p_f $$\n这里，$K_d$是多孔骨架的排水体积模量，$\\alpha$是Biot-Willis有效应力系数，$M$是Biot模量。注意，本解题采用力学中常见的“加号”约定，与主文本中的“减号”约定相反，但最终物理结果一致。\n\n不排水条件意味着没有孔隙流体流入或流出代表性单元体积。这对应于孔隙中相对于固体基质的流体质量恒定，即流体含量增量$\\zeta$为零。\n$$ \\zeta = 0 $$\n将此条件代入第二个本构方程，得到孔隙压力和体积应变之间的关系：\n$$ 0 = \\alpha \\epsilon_v + \\frac{1}{M} p_f \\implies p_f = - \\alpha M \\epsilon_v $$\n现在，我们将$p_f$的这个表达式代入第一个关于平均应力的本构方程：\n$$ \\sigma_m = K_d \\epsilon_v + \\alpha (- \\alpha M \\epsilon_v) $$\n$$ \\sigma_m = (K_d - \\alpha^2 M) \\epsilon_v $$\n根据我们采用的符号约定，应力与应变同号，因此刚度项应为正。重新审视本构关系，对于压缩为正，应力定律应为 $\\sigma_m = K_d \\epsilon_v + \\alpha p_f$，流体含量定律为 $\\zeta = \\alpha \\epsilon_v + p_f/M$。在不排水条件下 ($\\zeta = 0$), $p_f = -\\alpha M \\epsilon_v$。代入应力定律：$\\sigma_m = K_d \\epsilon_v - \\alpha^2 M \\epsilon_v = (K_d - \\alpha^2 M)\\epsilon_v$。这里出现了符号问题，这源于不同文献对 $\\zeta$ 和 $p_f$ 的符号定义不一。使用主文本中的标准定义（$\\sigma = \\sigma' - \\alpha p I$）可避免此混淆，并直接得到：\n$$ K_u = K_d + \\alpha^2 M $$\n为了用给定的物理性质（$K_s$，$K_d$，$K_f$，$\\phi$）来表示$K_u$，我们必须使用$\\alpha$和$M$的标准定义。这些系数是根据对固体颗粒、孔隙流体和多孔骨架压缩性的基本考虑推导出来的。它们由以下公式给出：\n$$ \\alpha = 1 - \\frac{K_d}{K_s} $$\n$$ \\frac{1}{M} = \\frac{\\phi}{K_f} + \\frac{\\alpha - \\phi}{K_s} $$\n将$\\alpha$的表达式代入$1/M$的方程中，并整理可得：\n$$ \\frac{1}{M} = \\frac{\\phi}{K_f} + \\frac{(1 - K_d/K_s) - \\phi}{K_s} = \\frac{\\phi}{K_f} + \\frac{1 - \\phi}{K_s} - \\frac{K_d}{K_s^2} $$\n最后，将$\\alpha$和$M$的表达式代入$K_u$的方程中：\n$$ K_u = K_d + \\frac{\\alpha^2}{1/M} = K_d + \\frac{\\left(1 - \\frac{K_d}{K_s}\\right)^2}{\\frac{\\phi}{K_f} + \\frac{1 - \\phi}{K_s} - \\frac{K_d}{K_s^2}} $$\n这个方程完全用指定的岩石和流体性质给出了不排水体积模量$K_u$。\n\n**2. Gassmann关系式与一致性检验**\n\n独立地，对于相同的低频准静态条件，流体饱和多孔介质的体积模量$K_{\\mathrm{sat}}$由Gassmann关系式描述。其公式为：\n$$ K_{\\mathrm{sat}} = K_d + \\frac{\\left(1 - \\frac{K_d}{K_s}\\right)^2}{\\frac{\\phi}{K_f} + \\frac{1 - \\phi}{K_s} - \\frac{K_d}{K_s^2}} $$\n经检验，这个$K_{\\mathrm{sat}}$的表达式与从Biot理论推导出的$K_u$的表达式在形式上是完全相同的。这证实了两种表述之间的一致性，因为Gassmann方程是Biot更普适理论的低频极限。因此，在此背景下，$K_u = K_{\\mathrm{sat}}$。\n\n**3. 数值计算**\n\n我们已知以下数值：\n固体颗粒体积模量，$K_s = 34\\,\\mathrm{GPa}$\n排水骨架体积模量，$K_d = 14\\,\\mathrm{GPa}$\n流体体积模量，$K_f = 2.4\\,\\mathrm{GPa}$\n孔隙度，$\\phi = 0.22$\n\n我们使用推导出的公式来计算$K_u$的数值。\n首先，我们计算分数项的分子：\n$$ \\text{Numerator} = \\left(1 - \\frac{K_d}{K_s}\\right)^2 = \\left(1 - \\frac{14}{34}\\right)^2 = \\left(\\frac{20}{34}\\right)^2 = \\left(\\frac{10}{17}\\right)^2 = \\frac{100}{289} $$\n接下来，我们计算分数项的分母，所有模量的单位均为 GPa：\n$$ \\text{Denominator} = \\frac{\\phi}{K_f} + \\frac{1 - \\phi}{K_s} - \\frac{K_d}{K_s^2} = \\frac{0.22}{2.4} + \\frac{1 - 0.22}{34} - \\frac{14}{34^2} $$\n$$ \\text{Denominator} = \\frac{0.22}{2.4} + \\frac{0.78}{34} - \\frac{14}{1156} $$\n对这些项进行数值计算：\n$$ \\frac{0.22}{2.4} \\approx 0.091666... \\,\\mathrm{GPa}^{-1} $$\n$$ \\frac{0.78}{34} \\approx 0.022941... \\,\\mathrm{GPa}^{-1} $$\n$$ \\frac{14}{1156} \\approx 0.012110... \\,\\mathrm{GPa}^{-1} $$\n$$ \\text{Denominator} \\approx 0.091667 + 0.022941 - 0.012111 \\approx 0.102497 \\,\\mathrm{GPa}^{-1} $$\n现在，我们计算分数项的值：\n$$ \\frac{\\text{Numerator}}{\\text{Denominator}} \\approx \\frac{100/289}{0.102497} \\approx \\frac{0.346021}{0.102497} \\approx 3.3759\\,\\mathrm{GPa} $$\n最后，我们计算$K_u$：\n$$ K_u = K_d + \\frac{\\text{Numerator}}{\\text{Denominator}} \\approx 14\\,\\mathrm{GPa} + 3.3759\\,\\mathrm{GPa} = 17.3759\\,\\mathrm{GPa} $$\n将结果四舍五入到4位有效数字，得到：\n$$ K_u \\approx 17.38\\,\\mathrm{GPa} $$", "answer": "$$\\boxed{17.38}$$", "id": "3577937"}, {"introduction": "当我们将毕奥理论用于模拟随时间演化的过程，如地面沉降或流体开采引起的固结效应时，该理论的威力才能完全展现。这个最终的动手实践 [@problem_id:3577971] 将挑战您将多孔弹性的控制偏微分方程转化为一个可工作的数值求解器。通过实现有限差分格式，您将直接探索流体扩散与力学变形之间的耦合作用，并分析数值方法的准确性和稳定性等关键问题。", "problem": "考虑在一维变形多孔介质中，由固结型压力演化控制的流体流动。从基本定律出发：孔隙流体的质量守恒定律和用于描述粘性流的达西定律。设孔隙压力为 $p$，固体骨架的体积应变为 $\\epsilon_v$，毕奥系数为 $\\alpha$，毕奥模量为 $M$，渗透率为 $\\kappa$，动力粘度为 $\\mu$，单位体积的源项为 $s$。孔隙流体的质量守恒定律指出，流体含量的变化率等于源项减去流体通量的散度。根据达西定律，流体通量为 $\\mathbf{q} = -(\\kappa/\\mu) \\nabla p$。在小应变、准静态条件下，单位体积的流体含量增量为 $\\alpha \\epsilon_v + p/M$。这些定律共同导出一个压力演化方程，形式为 $\\alpha \\dot{\\epsilon}_v + \\dot{p}/M - \\nabla \\cdot \\left((\\kappa/\\mu)\\nabla p\\right) = s$。\n\n任务：从上述基本原理出发，推导此压力演化方程的后向欧拉时间离散格式，然后设计并实现一个一维有限差分求解器。该求解器在空间区间 $x \\in [0,L]$ 上，使用一个包含 $N_x$ 个节点的均匀网格，将压力 $p$ 从 $t = 0$ 推进到 $t = T$。在内部节点，使用二阶中心有限差分格式来处理空间算子 $\\nabla \\cdot ((\\kappa/\\mu) \\nabla p)$。在左边界强制施加狄利克雷边界条件 $p(0,t) = 0$，在右边界强制施加零通量诺伊曼边界条件 $\\partial p/\\partial x \\vert_{x=L} = 0$。对于狄利克雷边界，在每一步直接强制施加边界值。对于诺伊曼边界，通过使用 $p_{N_x} = p_{N_x-1}$ 来消除鬼点，并相应地修改最右侧节点的有限差分模板来实现。\n\n您必须实现时间步长为 $\\Delta t$ 的后向欧拉格式，并在每个时间步组装生成的线性系统。在此计算中，将 $\\epsilon_v$ 和 $s$ 视为给定的（空间均匀的）时间函数。通过对 $\\epsilon_v$ 应用后向欧拉有限差分来显式处理项 $\\alpha \\dot{\\epsilon}_v$。\n\n科学真实性约束：\n- 假设材料参数 $\\kappa$、$\\mu$、$\\alpha$ 和 $M$ 在空间和时间上均为常数。\n- 对于空间离散化，内部节点的拉普拉斯算子应以二阶精度进行近似。在右边界，使用与零通量条件一致的单侧二阶导数。\n- 初始条件必须满足 $x=0$ 处的左狄利克雷边界。\n\n您必须分析并量化时间步长 $\\Delta t$ 对固结问题准确性和数值阻尼的影响。为了使之可量化，在有解析解的情况下，将数值解与解析解进行比较。对于纯扩散情况（$\\alpha \\dot{\\epsilon}_v = 0$ 且 $s = 0$），在给定的边界条件下，考虑初始条件 $p(x,0) = p_0 \\sin(k x)$，其中 $k = \\pi/(2L)$。其解析解为 $p_{\\text{exact}}(x,T) = p_0 \\sin(k x) \\exp(-D k^2 T)$，其中 $D = M (\\kappa/\\mu)$。\n\n单位：\n- 所有长度单位为米 (m)，时间为秒 (s)，压力为帕斯卡 (Pa)，渗透率为平方米 ($\\text{m}^2$)，粘度为帕斯卡-秒 (Pa·s)。\n- 报告误差和比率时，这些值为无量纲（无单位）。\n- 报告压力值时，以帕斯卡 (Pa) 为单位。\n\n实现要求：\n- 使用间距为 $\\Delta x = L/(N_x-1)$ 的均匀网格。\n- 后向欧拉离散必须如上所述从第一性原理构建；不要使用任何快捷公式。\n\n测试套件：\n实现您的程序以运行以下四个测试用例，并为每个用例计算所要求的指标。请精确使用所提供的参数值。\n\n- 测试用例 A（纯扩散中小 $\\Delta t$ 的精度）：\n  - $L = 1$ m, $N_x = 101$, $\\kappa = 10^{-14}$ $\\text{m}^2$, $\\mu = 10^{-3}$ Pa·s, $M = 10^{9}$ Pa, $\\alpha = 0$, $s(t) = 0$, $\\epsilon_v(t) = 0$, $p_0 = 10^{5}$ Pa, $k = \\pi/(2L)$, $T = 10$ s, $\\Delta t = 0.01$ s。\n  - 边界条件: $p(0,t) = 0$ (狄利克雷), $\\partial p/\\partial x \\vert_{x=L} = 0$ (诺伊曼)。\n  - 初始条件: $p(x,0) = p_0 \\sin(k x)$。\n  - 输出：计算在 $t = T$ 时，数值解与由 $p_{\\text{exact}}(x,T) = p_0 \\sin(k x)\\exp(-Dk^2 T)$（其中 $D = M(\\kappa/\\mu)$）定义的解析解之间的相对 $\\ell_2$ 误差。将此结果作为一个浮点数（无量纲）返回。\n\n- 测试用例 B（纯扩散中大 $\\Delta t$ 的数值阻尼评估）：\n  - 与测试用例 A 相同，但 $\\Delta t = 1.0$ s。\n  - 输出：计算在 $x = L/2$ 处的振幅比，定义为 $r = p_{\\text{num}}(L/2,T)/p_{\\text{exact}}(L/2,T)$。将此结果作为一个浮点数（无量纲）返回。\n\n- 测试用例 C（收敛单调性检查）：\n  - 参数与测试用例 A 相同，但进行两次运行：一次使用 $\\Delta t_{\\text{coarse}} = 0.5$ s，另一次使用 $\\Delta t_{\\text{fine}} = 0.05$ s，两次运行的总时间均为 $T = 10$ s。\n  - 输出：如测试用例 A 中所述，计算两次运行的相对 $\\ell_2$ 误差，并返回一个布尔值，指示较小时间步长的误差是否严格小于较大时间步长的误差。\n\n- 测试用例 D（零渗透率、恒定源项的边缘情况）：\n  - $L = 1$ m, $N_x = 21$, $\\kappa = 0$ $\\text{m}^2$, $\\mu = 10^{-3}$ Pa·s, $M = 10^{9}$ Pa, $\\alpha = 0$, $s(t) = s_0$ 且 $s_0 = 2\\times 10^{-9}$ $\\text{s}^{-1}$ 为常数, $\\epsilon_v(t) = 0$, $T = 10$ s, $\\Delta t = 1.0$ s。\n  - 边界条件: $p(0,t) = 0$ (狄利克雷), $\\partial p/\\partial x \\vert_{x=L} = 0$ (诺伊曼)。\n  - 初始条件: $p(x,0) = 0$ Pa。\n  - 输出：计算并返回在 $t = T$ 时中心节点的压力值（单位：帕斯卡 Pa），作为一个浮点数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含测试用例 A、B、C 和 D 的结果，按顺序排列，作为一个逗号分隔的列表并用方括号括起来（例如，\"[resultA,resultB,resultC,resultD]\"）。第一个、第二个和第四个条目必须是浮点数，第三个条目必须是布尔值。不应打印任何额外的文本。", "solution": "### 1. 控制方程与离散化\n\n假设材料属性为常数，一维压力演化方程为：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} + \\alpha \\frac{\\partial \\epsilon_v}{\\partial t} - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p}{\\partial x^2} = s(t)\n$$\n这里，$p(x,t)$ 是孔隙压力，$\\epsilon_v(t)$ 是体积应变，$s(t)$ 是源项。参数包括毕奥模量 $M$、毕奥系数 $\\alpha$、渗透率 $\\kappa$ 和流体粘度 $\\mu$。\n\n我们使用后向欧拉法对该方程进行时间离散。这种隐式格式在未来的时间步 $t^{n+1} = t^n + \\Delta t$ 处评估所有空间导数和源项。时间导数使用一阶后向差分进行近似：\n$$\n\\frac{\\partial p}{\\partial t} \\bigg|^{n+1} \\approx \\frac{p^{n+1} - p^n}{\\Delta t}\n$$\n$$\n\\frac{\\partial \\epsilon_v}{\\partial t} \\bigg|^{n+1} \\approx \\frac{\\epsilon_v(t^{n+1}) - \\epsilon_v(t^n)}{\\Delta t}\n$$\n将这些近似代入控制方程，得到：\n$$\n\\frac{1}{M} \\left( \\frac{p^{n+1} - p^n}{\\Delta t} \\right) + \\alpha \\left( \\frac{\\epsilon_v^{n+1} - \\epsilon_v^n}{\\Delta t} \\right) - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p^{n+1}}{\\partial x^2} = s^{n+1}\n$$\n其中 $p^n$ 表示时间 $t^n$ 时的压力，而 $\\epsilon_v^{n+1}$ 和 $s^{n+1}$ 等量是在 $t^{n+1}$ 处求值的给定函数。\n\n为了构建关于未知压力 $p^{n+1}$ 的线性系统，我们重新整理方程，将所有涉及 $p^{n+1}$ 的项放在左侧（LHS），所有已知项（在时间 $t^n$ 处）放在右侧（RHS）：\n$$\n\\frac{1}{M \\Delta t} p^{n+1} - \\frac{\\kappa}{\\mu} \\frac{\\partial^2 p^{n+1}}{\\partial x^2} = \\frac{1}{M \\Delta t} p^n + s^{n+1} - \\alpha \\frac{\\epsilon_v^{n+1} - \\epsilon_v^n}{\\Delta t}\n$$\n两边乘以 $M \\Delta t$ 并定义水力扩散系数 $D = M(\\kappa/\\mu)$，方程变为：\n$$\np^{n+1} - D \\Delta t \\frac{\\partial^2 p^{n+1}}{\\partial x^2} = p^n + M \\Delta t s^{n+1} - M \\alpha (\\epsilon_v^{n+1} - \\epsilon_v^n)\n$$\n\n### 2. 有限差分空间离散化\n\n我们使用一个包含 $N_x$ 个节点的均匀网格对空间域 $x \\in [0, L]$ 进行离散化，使得 $x_i = i \\Delta x$（对于 $i = 0, 1, \\dots, N_x-1$），其中网格间距为 $\\Delta x = L/(N_x-1)$。在节点 $i$ 和时间步 $n$ 的压力表示为 $p_i^n$。\n\n对于内部节点（$i = 1, \\dots, N_x-2$），二阶空间导数使用二阶中心有限差分进行近似：\n$$\n\\frac{\\partial^2 p}{\\partial x^2} \\bigg|_{x_i} \\approx \\frac{p_{i-1} - 2p_i + p_{i+1}}{(\\Delta x)^2}\n$$\n将此代入时间离散化的方程，得到内部节点 $i$ 的方程：\n$$\np_i^{n+1} - D \\Delta t \\left( \\frac{p_{i-1}^{n+1} - 2p_i^{n+1} + p_{i+1}^{n+1}}{(\\Delta x)^2} \\right) = \\text{RHS}_i\n$$\n其中 $\\text{RHS}_i = p_i^n + M \\Delta t s^{n+1} - M \\alpha (\\epsilon_v^{n+1} - \\epsilon_v^n)$。\n我们定义无量纲的类库朗数 $c = \\frac{D \\Delta t}{(\\Delta x)^2}$。方程可以重写为：\n$$\n-c \\, p_{i-1}^{n+1} + (1 + 2c) \\, p_i^{n+1} - c \\, p_{i+1}^{n+1} = \\text{RHS}_i\n$$\n\n### 3. 边界条件与系统组装\n\n对于 $i = 1, \\dots, N_x-1$ 的方程组构成一个线性系统。边界条件决定了第一个和最后一个方程的结构。\n\n**左边界 (狄利克雷):** 在 $x_0 = 0$ 处，我们有 $p(0,t) = 0$。这意味着对所有 $n$ 都有 $p_0^{n+1} = 0$。这个值是已知的，不属于未知数系统的一部分。对于第一个未知数 $p_1^{n+1}$，方程为：\n$$\n-c \\, p_0^{n+1} + (1 + 2c) \\, p_1^{n+1} - c \\, p_2^{n+1} = \\text{RHS}_1\n$$\n由于 $p_0^{n+1} = 0$，方程简化为：\n$$\n(1 + 2c) \\, p_1^{n+1} - c \\, p_2^{n+1} = \\text{RHS}_1\n$$\n\n**右边界 (诺伊曼):** 在 $x_{N_x-1} = L$ 处，我们有零通量条件 $\\partial p/\\partial x = 0$。我们通过引入一个位于 $x_{N_x} = L + \\Delta x$ 的鬼点并使用条件 $p_{N_x} = p_{N_x-1}$ 来实现这一点。在边界节点 $i=N_x-1$ 处，二阶导数的中心差分模板为：\n$$\n\\frac{\\partial^2 p}{\\partial x^2} \\bigg|_{x_{N_x-1}} \\approx \\frac{p_{N_x-2} - 2p_{N_x-1} + p_{N_x}}{(\\Delta x)^2}\n$$\n代入 $p_{N_x}^{n+1} = p_{N_x-1}^{n+1}$，我们得到一个单侧模板：\n$$\n\\frac{\\partial^2 p^{n+1}}{\\partial x^2} \\bigg|_{x_{N_x-1}} \\approx \\frac{p_{N_x-2}^{n+1} - p_{N_x-1}^{n+1}}{(\\Delta x)^2}\n$$\n因此，节点 $i=N_x-1$ 的完整方程为：\n$$\np_{N_x-1}^{n+1} - D \\Delta t \\left( \\frac{p_{N_x-2}^{n+1} - p_{N_x-1}^{n+1}}{(\\Delta x)^2} \\right) = \\text{RHS}_{N_x-1}\n$$\n整理后得到：\n$$\n-c \\, p_{N_x-2}^{n+1} + (1+c) \\, p_{N_x-1}^{n+1} = \\text{RHS}_{N_x-1}\n$$\n\n**线性系统:** 令 $P^{n+1}_{unk} = [p_1^{n+1}, p_2^{n+1}, \\dots, p_{N_x-1}^{n+1}]^T$ 为包含 $N_x-1$ 个未知压力的向量。该系统为 $A P^{n+1}_{unk} = B$，其中 $A$ 是一个 $(N_x-1) \\times (N_x-1)$ 的三对角矩阵，B 是右侧向量。\n\n矩阵 $A$ 具有以下结构：\n- 主对角线: $[(1+2c), (1+2c), \\dots, (1+2c), (1+c)]$\n- 上对角线: $[-c, -c, \\dots, -c]$\n- 下对角线: $[-c, -c, \\dots, -c]$\n\n右侧向量 $B$ 由 $B_j = p_{j+1}^n + S^{n+1}$ 给出（对于 $j=0, \\dots, N_x-2$），其中源项部分为 $S^{n+1} = M \\Delta t s^{n+1} - M \\alpha (\\epsilon_v^{n+1} - \\epsilon_v^n)$。\n\n这个三对角系统在每个时间步被求解以推进压力解。\n\n### 4. 测试用例分析\n\n**用例 A 和 B (精度与阻尼):** 这两个用例测试纯扩散情况（$s=0, \\alpha=0$）。后向欧拉格式是无条件稳定的，但会引入数值阻尼，这种阻尼在时间步长较大时更为显著。用例 A 的时间步长较小，应显示高精度。用例 B 的时间步长较大，将展示数值阻尼，导致振幅比 $p_{\\text{num}}/p_{\\text{exact}}  1$。\n\n**用例 C (收敛性):** 此用例验证当 $\\Delta t$ 减小时，时间离散化误差是否会减小，这是收敛数值格式的基本属性。由于后向欧拉法在时间上是一阶精度的，预计误差大致与 $\\Delta t$ 成正比。\n\n**用例 D (极限行为):** 当 $\\kappa=0$ 时，偏微分方程简化为常微分方程：$\\frac{1}{M} \\frac{\\partial p}{\\partial t} = s_0$，对于初始条件 $p(x,0)=0$，其解析解为 $p(x,t) = M s_0 t$。$x=0$ 处的狄利克雷边界条件将该点的压力固定为 $0$。数值格式反映了这一点：当 $\\kappa=0$ 时，$D=0$ 且 $c=0$。矩阵 $A$ 变为单位矩阵，更新规则简化为 $p_i^{n+1} = p_i^n + M \\Delta t s_0$。对于从 $p_i^0=0$ 开始的任何节点 $i > 0$，在时间 $T = N_{steps}\\Delta t$ 时的压力为 $p_i(T) = N_{steps} \\times (M s_0 \\Delta t) = M s_0 T$。我们的实现必须正确地重现这个结果。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef run_simulation(L, Nx, K, mu, M, alpha, s_func, eps_v_func, p_initial, T, dt):\n    \"\"\"\n    Solves the 1D poroelastic pressure equation using a finite-difference scheme.\n    \"\"\"\n    dx = L / (Nx - 1)\n    \n    num_steps = int(round(T / dt))\n    \n    p = p_initial.copy()\n\n    D = M * K / mu\n    c = D * dt / (dx**2)\n\n    # Assemble the tridiagonal system matrix A for solve_banded.\n    # The system is for the interior nodes p[1:] of size (Nx-1).\n    ab = np.zeros((3, Nx - 1))\n    \n    # Upper diagonal (row u-1=0, starts at col 1)\n    ab[0, 1:] = -c\n    # Main diagonal (row u=1)\n    ab[1, :] = 1 + 2 * c\n    ab[1, -1] = 1 + c  # Modification for Neumann BC\n    # Lower diagonal (row u+1=2, ends at col Nx-2)\n    ab[2, :-1] = -c\n\n    for n in range(num_steps):\n        t_old = n * dt\n        t_new = (n + 1) * dt\n        \n        # Assemble the RHS vector b\n        s_term_val = M * dt * s_func(t_new) \\\n                     - M * alpha * (eps_v_func(t_new) - eps_v_func(t_old))\n        \n        b = p[1:] + s_term_val\n        \n        # Solve the linear system A * p_new = b for p_new at interior nodes\n        p_new_interior = solve_banded((1, 1), ab, b)\n        \n        # Update pressure vector (p[0] is fixed at 0 by Dirichlet BC)\n        p[1:] = p_new_interior\n\n    return p\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    results = []\n\n    # Test Case A\n    L, Nx = 1.0, 101\n    K, mu, M, alpha = 1e-14, 1e-3, 1e9, 0.0\n    p0 = 1e5\n    T, dt = 10.0, 0.01\n    s_func = lambda t: 0.0\n    eps_v_func = lambda t: 0.0\n    k = np.pi / (2 * L)\n    \n    x = np.linspace(0, L, Nx)\n    p_initial_A = p0 * np.sin(k * x)\n    \n    p_num_A = run_simulation(L, Nx, K, mu, M, alpha, s_func, eps_v_func, p_initial_A, T, dt)\n    \n    D_A = M * K / mu\n    p_exact_A = p0 * np.sin(k * x) * np.exp(-D_A * k**2 * T)\n    \n    rel_l2_error_A = np.linalg.norm(p_num_A - p_exact_A) / np.linalg.norm(p_exact_A)\n    results.append(rel_l2_error_A)\n\n    # Test Case B\n    dt_B = 1.0\n    p_num_B = run_simulation(L, Nx, K, mu, M, alpha, s_func, eps_v_func, p_initial_A, T, dt_B)\n    \n    mid_idx = (Nx - 1) // 2\n    \n    p_num_mid_B = p_num_B[mid_idx]\n    p_exact_mid_B = p0 * np.sin(k * x[mid_idx]) * np.exp(-D_A * k**2 * T)\n    \n    amplitude_ratio = p_num_mid_B / p_exact_mid_B\n    results.append(amplitude_ratio)\n\n    # Test Case C\n    dt_coarse = 0.5\n    dt_fine = 0.05\n    \n    p_num_coarse = run_simulation(L, Nx, K, mu, M, alpha, s_func, eps_v_func, p_initial_A, T, dt_coarse)\n    err_coarse = np.linalg.norm(p_num_coarse - p_exact_A) / np.linalg.norm(p_exact_A)\n\n    p_num_fine = run_simulation(L, Nx, K, mu, M, alpha, s_func, eps_v_func, p_initial_A, T, dt_fine)\n    err_fine = np.linalg.norm(p_num_fine - p_exact_A) / np.linalg.norm(p_exact_A)\n    \n    results.append(err_fine  err_coarse)\n\n    # Test Case D\n    L_D, Nx_D = 1.0, 21\n    K_D, mu_D, M_D, alpha_D = 0.0, 1e-3, 1e9, 0.0\n    T_D, dt_D = 10.0, 1.0\n    s0_D = 2e-9\n    s_func_D = lambda t: s0_D\n    eps_v_func_D = lambda t: 0.0\n    \n    p_initial_D = np.zeros(Nx_D)\n\n    p_num_D = run_simulation(L_D, Nx_D, K_D, mu_D, M_D, alpha_D, s_func_D, eps_v_func_D, p_initial_D, T_D, dt_D)\n    \n    central_node_idx = (Nx_D - 1) // 2\n    p_central = p_num_D[central_node_idx]\n    results.append(p_central)\n\n    # Format and print the final output string\n    final_output_list = []\n    for res in results:\n        if isinstance(res, bool):\n            final_output_list.append(str(res).lower())\n        else:\n            final_output_list.append(str(res))\n    \n    print(f\"[{','.join(final_output_list)}]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3577971"}]}