{"hands_on_practices": [{"introduction": "岩浆在岩脉内部的流动是其运移的核心驱动力。本练习从基本的流体动力学原理出发，运用润滑近似推导出控制狭窄通道中黏性流体流量的“立方定律”。通过分析具有周期性变化的孔隙结构，您将亲自计算并理解为何岩脉宽度的不均匀性会极大地增强岩浆的等效输运效率，这是理解岩脉扩展动力学的关键一步 ([@problem_id:3608410])。", "problem": "在一个理想化为长平面裂缝的岩浆充填岩脉段中，假设动力粘度为 $\\mu$ 的牛顿熔体在沿走向坐标 $x$ 的恒定压力梯度 $\\partial p/\\partial x$ 作用下进行稳态、不可压缩的等温流动。裂缝壁在远大于局部开度 $w(x)$ 的尺度上局部平行，因此润滑近似有效且惯性可以忽略。壁面处满足无滑移条件。\n\n开度沿走向呈周期性变化，表达式为\n$$\nw(x) \\;=\\; \\bar{w}\\,\\bigl(1 + m \\cos(2\\pi x/\\lambda)\\bigr),\n$$\n其中 $0  m  1$，平均开度尺度 $\\bar{w}  0$，波长 $\\lambda  0$。定义一个波长上的空间平均为\n$$\n\\langle f \\rangle \\;=\\; \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx.\n$$\n\n任务：\n- 从稳态斯托克斯方程和平行板间的润滑近似出发，推导单位平面外厚度的局部通量 $q(x)$，用 $w(x)$ 和 $\\partial p/\\partial x$ 表示。\n- 计算空间平均开度 $\\langle w \\rangle$。\n- 对于上述余弦形状的开度，计算形状因子\n$$\nS \\;=\\; \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}\n$$\n并将 $S$ 的最终结果表示为仅含 $m$ 的闭式解析表达式。\n- 使用你推导出的通量表达式，解释 $S$ 如何控制可变开度岩脉中的空间平均通量与开度为 $\\langle w \\rangle$ 的均匀开度岩脉中通量之比，并从物理上解释为什么该比值不为1。\n\n你最终报告的答案必须仅为 $S$ 的闭式解析表达式。不需要数值计算，最终答案框中也不应报告任何单位。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **流动条件**：稳态、不可压缩、等温的牛顿熔体流动。\n- **流体性质**：动力粘度 $\\mu$。\n- **驱动力**：沿走向坐标 $x$ 的恒定压力梯度 $\\partial p/\\partial x$。\n- **几何形状**：具有局部平行壁面的长平面裂缝（岩脉）。\n- **模型**：润滑近似有效；惯性可忽略。\n- **边界条件**：壁面处无滑移。\n- **开度函数**：$w(x) = \\bar{w}(1 + m \\cos(2\\pi x/\\lambda))$，约束条件为 $0  m  1$, $\\bar{w}  0$, 且 $\\lambda  0$。\n- **空间平均的定义**：$\\langle f \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx$。\n- **任务**：\n  1.  推导单位平面外厚度的局部通量 $q(x)$。\n  2.  计算空间平均开度 $\\langle w \\rangle$。\n  3.  计算形状因子 $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$，用 $m$ 表示。\n  4.  解释 $S$ 相对于平均通量的物理意义。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于慢速粘性流动的斯托克斯方程，并通过润滑近似进行了简化。这是流体力学中的一个标准基础模型（亥尔-肖流动），并广泛应用于地球物理学中，用于模拟岩脉中的岩浆流动。其假设（牛顿流体、不可压缩性、无滑移）对于一阶模型是标准的。周期性开度是天然裂缝粗糙度或分段的有效理想化。该问题在科学上是合理的。\n- **适定性**：问题定义明确。控制方程、几何形状和边界条件都已指定，可以推导出唯一的速度剖面和通量。任务具体，数学运算（积分、平均）也是标准的。约束条件 $0  m  1$ 确保了开度 $w(x) = \\bar{w}(1 + m \\cos(2\\pi x/\\lambda))$ 始终为正，因为 $1 + m \\cos(\\cdot) \\ge 1 - m  0$，防止了裂缝闭合，这在物理上是现实的，在数学上也是方便的。\n- **客观性**：问题以精确、客观的数学语言陈述。不包含任何主观论断或意见。\n\n### 步骤3：结论与行动\n该问题是有效的。它是地球物理流体动力学中的一个标准练习，科学上合理、适定且客观。将提供完整的解答。\n\n***\n\n我们按顺序完成各项任务。\n\n**任务1：推导局部通量 $q(x)$**\n\n流动由具有恒定粘度 $\\mu$ 的不可压缩流体的稳态斯托克斯方程控制：\n$$\n\\nabla p = \\mu \\nabla^{2}\\mathbf{v}\n$$\n其中 $\\mathbf{v}$ 是速度矢量，$p$ 是压力。设 $z$ 为穿过开度的坐标，壁面位于 $z = \\pm w(x)/2$。流动主要沿 $x$ 方向，因此 $\\mathbf{v} \\approx (u(x,z), 0, 0)$。\n\n润滑近似假设流动方向上的变化长度尺度 $\\lambda$ 远大于开度尺度 $\\bar{w}$。这意味着穿过开度的速度梯度远大于沿开度的速度梯度，即 $|\\partial u / \\partial z| \\gg |\\partial u / \\partial x|$。因此，斯托克斯方程的 $x$ 分量简化为：\n$$\n\\frac{\\partial p}{\\partial x} = \\mu \\frac{\\partial^{2} u}{\\partial z^{2}}\n$$\n在任意给定位置 $x$，我们可以将 $w(x)$ 和恒定的压力梯度 $\\partial p/\\partial x$ 视为参数，并对 $z$ 进行积分以求得速度剖面 $u(z)$。\n$$\n\\frac{d^{2}u}{dz^{2}} = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x}\n$$\n对 $z$ 积分一次得到：\n$$\n\\frac{du}{dz} = \\frac{z}{\\mu} \\frac{\\partial p}{\\partial x} + C_{1}\n$$\n再次积分得到：\n$$\nu(z) = \\frac{z^{2}}{2\\mu} \\frac{\\partial p}{\\partial x} + C_{1}z + C_{2}\n$$\n积分常数 $C_{1}$ 和 $C_{2}$ 由裂缝壁上的无滑移边界条件 $u(z = \\pm w(x)/2) = 0$ 确定。\n$$\nu\\left(+\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(\\frac{w(x)}{2}\\right)^2 + C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\n$$\nu\\left(-\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(-\\frac{w(x)}{2}\\right)^2 - C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\n用第一个方程减去第二个方程得到 $C_{1}w(x) = 0$。由于 $w(x)  0$，我们必有 $C_{1}=0$。将 $C_{1}=0$ 代入第一个方程得到：\n$$\nC_{2} = -\\frac{w(x)^{2}}{8\\mu} \\frac{\\partial p}{\\partial x}\n$$\n因此，速度剖面是一个抛物线形的泊肃叶剖面：\n$$\nu(z) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right)\n$$\n单位平面外厚度的局部通量 $q(x)$ 是该速度剖面在整个开度上的积分：\n$$\nq(x) = \\int_{-w(x)/2}^{+w(x)/2} u(z) \\,dz = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-w(x)/2}^{+w(x)/2} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right) dz\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\frac{z^{3}}{3} - \\frac{w(x)^{2}}{4}z \\right]_{-w(x)/2}^{+w(x)/2}\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\left( \\frac{w(x)^{3}}{24} - \\frac{w(x)^{3}}{8} \\right) - \\left( -\\frac{w(x)^{3}}{24} + \\frac{w(x)^{3}}{8} \\right) \\right]\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ 2 \\left( \\frac{w(x)^{3}}{24} - \\frac{3w(x)^{3}}{24} \\right) \\right] = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{2w(x)^{3}}{24} \\right)\n$$\n$$\nq(x) = -\\frac{w(x)^{3}}{12\\mu} \\frac{\\partial p}{\\partial x}\n$$\n该表达式将局部通量与局部开度的三次方、流体粘度和压力梯度联系起来。这就是著名的平行板间流动的“立方定律”。\n\n**任务2：计算空间平均开度 $\\langle w \\rangle$**\n\n空间平均开度由下式给出：\n$$\n\\langle w \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} w(x) \\,dx = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) dx\n$$\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} \\left[ \\int_{0}^{\\lambda} 1 \\,dx + m \\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx \\right]\n$$\n第一个积分为 $\\int_{0}^{\\lambda} 1 \\,dx = \\lambda$。第二个积分是在余弦函数的一个完整周期上进行的，其值为零：\n$$\n\\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx = \\left[ \\frac{\\lambda}{2\\pi} \\sin\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]_{0}^{\\lambda} = \\frac{\\lambda}{2\\pi}(\\sin(2\\pi) - \\sin(0)) = 0\n$$\n因此，平均开度为：\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} [ \\lambda + m \\cdot 0 ] = \\bar{w}\n$$\n\n**任务3：计算形状因子 $S$**\n\n形状因子定义为 $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$。我们已经求得 $\\langle w \\rangle = \\bar{w}$，所以 $\\langle w \\rangle^{3} = \\bar{w}^{3}$。现在我们需要计算 $\\langle w^{3} \\rangle$。\n$$\nw(x)^{3} = \\left[ \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) \\right]^{3} = \\bar{w}^{3} \\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right)^{3}\n$$\n使用二项式展开 $(a+b)^{3} = a^{3} + 3a^{2}b + 3ab^{2} + b^{3}$，其中 $a=1$ 且 $b=m \\cos(2\\pi x/\\lambda)$：\n$$\nw(x)^{3} = \\bar{w}^{3} \\left[ 1 + 3m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + 3m^{2} \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) + m^{3} \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]\n$$\n现在，我们将此表达式在一个波长上进行平均。根据平均算子的线性性质：\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ \\langle 1 \\rangle + 3m \\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + 3m^{2} \\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + m^{3} \\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle \\right]\n$$\n我们计算三角函数项的平均值：\n- $\\langle 1 \\rangle = 1$。\n- $\\langle \\cos(2\\pi x/\\lambda) \\rangle = 0$，如任务2所示。\n- 对于 $\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle$，我们使用恒等式 $\\cos^{2}\\theta = \\frac{1 + \\cos(2\\theta)}{2}$：\n$$\n\\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{1}{2} \\langle 1 \\rangle + \\frac{1}{2} \\left\\langle \\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\n$\\cos(4\\pi x/\\lambda)$ 在区间 $[0, \\lambda]$ 上的平均值也为零。因此，$\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle = 1/2$。\n- 对于 $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle$，我们使用恒等式 $\\cos^{3}\\theta = \\frac{3\\cos\\theta + \\cos(3\\theta)}{4}$：\n$$\n\\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{3}{4}\\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + \\frac{1}{4}\\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{3}{4}\\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + \\frac{1}{4}\\left\\langle \\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\n右侧的两个平均值都为零，所以 $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle = 0$。\n\n将这些结果代回 $\\langle w^{3} \\rangle$ 的表达式中：\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ 1 + 3m(0) + 3m^{2}\\left(\\frac{1}{2}\\right) + m^{3}(0) \\right] = \\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)\n$$\n最后，我们计算形状因子 $S$：\n$$\nS = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = \\frac{\\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)}{\\bar{w}^{3}} = 1 + \\frac{3}{2}m^{2}\n$$\n\n**任务4：对 $S$ 的解释**\n\n我们定义一个常数 $C = -\\frac{1}{12\\mu} \\frac{\\partial p}{\\partial x}$。局部通量为 $q(x) = C w(x)^{3}$。由于 $C$ 是常数，空间平均通量为 $\\langle q \\rangle = \\langle C w(x)^{3} \\rangle = C \\langle w^{3} \\rangle$。\n\n现在考虑一个均匀开度的岩脉，其开度等于我们可变开度岩脉的平均开度，即 $w_{uniform} = \\langle w \\rangle$。这个均匀岩脉中的通量将是 $q_{uniform} = C w_{uniform}^{3} = C \\langle w \\rangle^{3}$。\n\n可变开度岩脉中的平均通量与等效均匀开度岩脉中通量之比为：\n$$\n\\frac{\\langle q \\rangle}{q_{uniform}} = \\frac{C \\langle w^{3} \\rangle}{C \\langle w \\rangle^{3}} = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = S\n$$\n所以，形状因子 $S$ 代表了与具有相同平均开度的均匀通道相比，由于开度变化引起的平均通量的增强。由于我们求得 $S = 1 + \\frac{3}{2}m^{2}$ 且问题陈述 $0  m  1$，因此 $S > 1$。\n\n从物理上讲，这意味着通过可变开度通道的平均流速总是大于通过具有相同平均开度的均匀通道的流速。这种偏离1的情况是由于通量与开度之间高度非线性的“立方定律”关系 $q(x) \\propto w(x)^{3}$ 造成的。对于 $w0$，函数 $f(w) = w^{3}$ 是一个凸函数。根据琴生不等式，对于任何非常数的随机变量（或空间变化函数）$w$，函数的平均值大于平均值的函数：$\\langle f(w) \\rangle  f(\\langle w \\rangle)$。在我们的问题中，即 $\\langle w^{3} \\rangle  \\langle w \\rangle^{3}$。\n\n其物理原因是，岩脉的较宽部分对总通量的贡献不成比例。在宽阔点增加开度对通量的增强作用，远比在狭窄点同等减小开度所导致的通量减少更为显著。流动会优先利用较宽段落提供的高导流通道，从而导致总平均通量高于仅使用平均开度所预测的值。", "answer": "$$\n\\boxed{1 + \\frac{3}{2}m^{2}}\n$$", "id": "3608410"}, {"introduction": "岩脉的扩展不仅取决于岩浆的流动，同样依赖于围岩的弹性响应。为了在计算模型中准确地描述岩脉的张开，我们需要对三维的弹性力学问题进行二维简化。本练习将指导您从基本本构关系出发，推导平面应力和平面应变这两种关键假设下的有效弹性模量 $E'$，并探讨它们各自对应的地质情景，这对于建立符合实际的岩脉模型至关重要 ([@problem_id:3608471])。", "problem": "一个垂直岩浆岩脉被模拟为一个位于大域中的各向同性、均匀、线弹性介质中的二维断裂。设平面内坐标轴为 $\\{x,z\\}$（$x$ 方向为张开方向，$z$ 方向为垂直深度），平面外坐标轴为 $y$（沿走向）。岩石的杨氏模量为 $E$，泊松比为 $\\nu$，拉梅参数为 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$。考虑由均匀内部岩浆压力产生的I型加载，该压力导致张开位移。能量释放率 $G$ 定义为每单位新增裂纹面积的总势能减少量，在线性弹性断裂力学（LEFM）中等于路径无关的 $J$ 积分。\n\n从三维各向同性线弹性本构关系 $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I}$ 和应变能密度 $W = \\dfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$ 出发，依次施加以下运动/应力约束：\n- 平面应力：$\\sigma_{y} = 0$，$\\tau_{xy} = 0$，$\\tau_{yz} = 0$。\n- 平面应变：$\\varepsilon_{y} = 0$，$\\gamma_{xy} = 0$，$\\gamma_{yz} = 0$。\n\n利用 $J$ 积分定义的 $G$ 以及各向同性裂纹的近尖端渐近场，证明 $G$ 可以写成 $G = \\dfrac{K_I^2}{E'}$ 的形式，其中 $K_I$ 是I型应力强度因子，$E'$ 是一个有效模量，其值取决于问题是平面应力还是平面应变。从本构关系中推导出每种情况下 $E'$ 的表达式，并根据地质边界条件和岩脉几何形状，解释在计算地球物理学中模拟岩脉弹性时，哪种假设是合适的。\n\n哪个选项正确陈述了 $E'$ 的表达式及其地质适用性？\n\nA. 平面应力：$E' = E$；适用于岩脉段沿走向较薄或靠近无牵引力的侧向边界，因此 $\\sigma_y \\approx 0$。平面应变：$E' = \\dfrac{E}{1-\\nu^2}$；适用于岩脉沿走向非常长，变化可忽略不计，且平面外变形受约束（$\\varepsilon_y \\approx 0$），例如远离端点的深部、横向延伸的岩脉。\n\nB. 平面应力：$E' = \\dfrac{E}{1-\\nu^2}$；适用于 $\\varepsilon_y \\approx 0$ 的长而横向延伸的岩脉。平面应变：$E' = E$；适用于 $\\sigma_y \\approx 0$ 的近自由表面。\n\nC. 平面应力：$E' = \\dfrac{E}{1+\\nu}$；适用于低围压下的近地表岩脉。平面应变：$E' = E$；适用于高围压下的深部岩脉。\n\nD. 平面应力：$E' = E(1-\\nu)$；适用于 $\\nu$ 很小的情况。平面应变：$E' = \\dfrac{E}{1-2\\nu}$；适用于 $\\nu \\rightarrow \\dfrac{1}{2}$ 的不可压缩岩石。[@problem_id:54]", "solution": "该问题要求从三维线弹性本构关系出发，推导平面应力和平面应变条件下的有效杨氏模量 $E'$。它还要求解释每种条件在模拟岩浆岩脉时的地质适用性。I型能量释放率 $G$ 和I型应力强度因子 $K_I$ 之间的关系为 $G = \\dfrac{K_I^2}{E'}$。这个关系是线性弹性断裂力学（LEFM）的基石，参数 $E'$ 取决于所使用的二维简化方法。\n\n起点是三维各向同性线弹性本构关系。最方便的形式是表示应变为应力函数的方程：\n$$ \\varepsilon_{ij} = \\frac{1+\\nu}{E} \\sigma_{ij} - \\frac{\\nu}{E} \\sigma_{kk} \\delta_{ij} $$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比，$\\sigma_{ij}$ 是应力张量，$\\varepsilon_{ij}$ 是应变张量，$\\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$ 是应力张量的迹，$\\delta_{ij}$ 是克罗内克符号。\n\n平面内坐标为 $\\{x,z\\}$，平面外（走向）方向为 $y$。\n\n### 平面应力推导\n\n平面应力条件的定义是，作用在法线方向为平面外方向的平面上的应力分量为零。对于 $y$ 方向为平面外方向，这转化为：\n$$ \\sigma_{yy} = 0, \\quad \\sigma_{xy} = 0, \\quad \\sigma_{yz} = 0 $$\n问题现在简化为 $x,z$ 平面上的一个二维问题。应变分量 $\\varepsilon_{xx}$ 由通用的三维定律给出：\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) \\right] $$\n应用平面应力条件 $\\sigma_{yy} = 0$：\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\sigma_{zz}) $$\n类似地，对于 $\\varepsilon_{zz}$：\n$$ \\varepsilon_{zz} = \\frac{1}{E} (\\sigma_{zz} - \\nu \\sigma_{xx}) $$\n平面外应变 $\\varepsilon_{yy}$ 通常不为零：\n$$ \\varepsilon_{yy} = -\\frac{\\nu}{E}(\\sigma_{xx}+\\sigma_{zz}) $$\n有效模量 $E'$ 在二维平面内的单轴应力状态下关联应变与应力。为了找到它，我们考虑 $\\sigma_{xx} \\neq 0$ 且所有其他应力分量（包括平面内分量 $\\sigma_{zz}$）均为零的情况。\n在这些条件下（$\\sigma_{xx} \\neq 0, \\sigma_{zz} = 0, \\sigma_{yy} = 0$），应变 $\\varepsilon_{xx}$ 变为：\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\cdot 0) = \\frac{\\sigma_{xx}}{E} $$\n这个关系式形式为 $\\sigma_{xx} = E \\varepsilon_{xx}$。与目标有效一维定律 $\\sigma = E' \\varepsilon$ 相比较，我们确定平面应力的有效模量为：\n$$ E' = E $$\n\n### 平面应变推导\n\n平面应变条件的定义是，平面外方向的应变分量为零。对于 $y$ 方向为平面外方向，这转化为：\n$$ \\varepsilon_{yy} = 0, \\quad \\gamma_{xy} = 2\\varepsilon_{xy} = 0, \\quad \\gamma_{yz} = 2\\varepsilon_{yz} = 0 $$\n对平面外法向应变使用本构关系：\n$$ \\varepsilon_{yy} = \\frac{1}{E} \\left[ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) \\right] = 0 $$\n这意味着必须存在一个非零应力 $\\sigma_{yy}$ 来阻止 $y$ 方向的应变：\n$$ \\sigma_{yy} = \\nu (\\sigma_{xx} + \\sigma_{zz}) $$\n现在，我们将 $\\sigma_{yy}$ 的这个表达式代入平面内应变 $\\varepsilon_{xx}$ 的方程中：\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu ( \\nu (\\sigma_{xx} + \\sigma_{zz}) + \\sigma_{zz}) \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ \\sigma_{xx} - \\nu^2 \\sigma_{xx} - \\nu^2 \\sigma_{zz} - \\nu \\sigma_{zz} \\right] $$\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ (1 - \\nu^2) \\sigma_{xx} - \\nu(1 + \\nu) \\sigma_{zz} \\right] $$\n为了找到有效模量 $E'$，我们再次考虑二维平面内的单轴应力状态，其中 $\\sigma_{xx} \\neq 0$ 且 $\\sigma_{zz} = 0$。注意 $\\sigma_{yy} = \\nu\\sigma_{xx} \\neq 0$。\n将 $\\sigma_{zz} = 0$ 代入推导出的 $\\varepsilon_{xx}$ 表达式中：\n$$ \\varepsilon_{xx} = \\frac{1}{E} \\left[ (1 - \\nu^2) \\sigma_{xx} - 0 \\right] = \\frac{1 - \\nu^2}{E} \\sigma_{xx} $$\n重新整理以求解 $\\sigma_{xx}$：\n$$ \\sigma_{xx} = \\frac{E}{1 - \\nu^2} \\varepsilon_{xx} $$\n与有效一维定律 $\\sigma = E' \\varepsilon$ 相比较，我们确定平面应变的有效模量为：\n$$ E' = \\frac{E}{1 - \\nu^2} $$\n\n### 地质适用性\n\n平面应力与平面应变之间的选择取决于岩脉的几何形状和周围岩体的边界条件。坐标 $y$ 代表岩脉的沿走向方向。\n\n- **平面应力适用性**：条件 $\\sigma_y \\approx 0$ (或 $\\sigma_{yy} \\approx 0$) 意味着材料在 $y$ 方向上可以自由膨胀或收缩。这对于在该方向上相对于其平面内尺寸较薄的物体是一个有效的近似。对于垂直岩脉，这适用于沿走向较短的岩脉段模型，或靠近广阔岩脉系统侧向末端的地方，在这些地方，平面外应力必须在自由边界处减小到零。\n\n- **平面应变适用性**：条件 $\\varepsilon_y \\approx 0$ (或 $\\varepsilon_{yy} \\approx 0$) 意味着沿岩脉走向没有变形。当物体在该方向上非常长，以至于中心区域的材料受到相邻材料的约束而不能变形时，就会发生这种情况。对于岩脉，当模拟位于一个非常长的、横向延伸的供给系统中间的段落，且远离其末端时，这是一个合适的假设。这样的岩脉通常被设想为位于地壳深处。\n\n### 选项评估\n\n- **选项 A**:\n  - 平面应力: $E' = E$。（正确）\n  - 适用性: “适用于岩脉段沿走向较薄或靠近无牵引力的侧向边界，因此 $\\sigma_y \\approx 0$”。（正确）\n  - 平面应变: $E' = \\dfrac{E}{1-\\nu^2}$。（正确）\n  - 适用性: “适用于岩脉沿走向非常长，变化可忽略不计，且平面外变形受约束（$\\varepsilon_y \\approx 0$），例如远离端点的深部、横向延伸的岩脉”。（正确）\n  - 结论：**正确**。该选项准确地陈述了推导的表达式及其在地质背景下的物理解释。\n\n- **选项 B**:\n  - 平面应力: $E' = \\dfrac{E}{1-\\nu^2}$。（不正确，这是平面应变的表达式）。\n  - 平面应变: $E' = E$。（不正确，这是平面应力的表达式）。\n  - 适用性也被调换了。\n  - 结论：**不正确**。\n\n- **选项 C**:\n  - 平面应力: $E' = \\dfrac{E}{1+\\nu}$。（不正确）。这个表达式与剪切模量 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 有关。\n  - 平面应变: $E' = E$。（不正确）。\n  - 结论：**不正确**。$E'$ 的数学表达式是错误的。\n\n- **选项 D**:\n  - 平面应力: $E' = E(1-\\nu)$。（不正确）。\n  - 平面应变: $E' = \\dfrac{E}{1-2\\nu}$。（不正确）。这与特定条件下的P波模量有关，而不是平面应变杨氏模量。\n  - 结论：**不正确**。$E'$ 的数学表达式是错误的。\n\n基于推导和分析，选项 A 是唯一在所有方面都正确的选项。", "answer": "$$\\boxed{A}$$", "id": "3608471"}, {"introduction": "解析解在处理复杂地质现实时往往力不从心，此时数值方法便显得不可或缺。边界元方法 (BEM) 是一种模拟岩脉等裂缝问题的强大数值工具，它仅需在裂缝边界上进行离散化，因而计算效率极高。本实践是一个编程练习，旨在引导您从零开始实现一个边界元求解器，用以计算承压裂缝的张开宽度。您不仅将构建一个实用的计算程序，还将学习如何对照解析解进行模型验证，并将其应用于非均质（分层）岩体中，从而将理论知识转化为解决实际问题的能力 ([@problem_id:3608435])。", "problem": "要求您为嵌入在弹性介质中的有限长度二维平面应变受压裂缝（岩浆填充的岩脉）实现一种边界元法。裂缝沿 $x$ 轴从 $x=-a$ 延伸至 $x=+a$，其法向张开位移为 $w(x)$。净内压为 $p(x)$（在裂缝面上为正表示压缩），介质的平面应变模量为 $E'(x)$，该模量可能沿裂缝位置变化（以模拟投影到裂缝线上的层状围岩）。在准静态、线性弹性、平面应变近似下，从基础弹性力学推导出一个离散化的边界积分方程，该方程关联了 $p(x)$ 与 $w(x)$，并使用常数单元和配置法实现一个数值求解器。然后，使用均匀介质和均匀压力下的解析解来验证该求解器。\n\n基本原理：\n- 平面应变中的线性弹性力学，其中平面应变模量定义为 $E' \\equiv E/(1-\\nu^2)$，$E$ 是杨氏模量，$\\nu$ 是泊松比。\n- 无限介质中直裂缝的I型牵引力-张开关系，可表示为一个超奇异积分方程。对于具有恒定 $E'$ 的均匀介质，该方程通过一个柯西主值积分将净压力 $p(x)$ 与张开度导数 $w'(s)$ 联系起来。\n\n离散化要求：\n- 将区间 $[-a,a]$ 离散为 $N$ 个常数张开单元，单元边界为 $x_i$ ($i=0,\\dots,N$)，其中 $x_0=-a$，$x_N=+a$，$x_i=-a + i h$，$h=2a/N$。\n- 设单元 $i$ 上的未知张开度为 $w_i$ ($i=1,\\dots,N$)，假定其在 $[x_{i-1},x_i]$ 区间内为常数。\n- 在单元中点 $x_j^c=(x_{j-1}+x_j)/2$ ($j=1,\\dots,N$) 处配置牵引力方程。\n- 在分段常数离散化中使用超奇异积分方程，使得单元 $i$ 对配置点 $x_j^c$ 处牵引力的贡献由该单元两端点处的单极点项之差表示。具体来说，对于具有恒定 $E'$ 的均匀介质，离散系统形式如下\n$$\np(x_j^c) \\;=\\; \\frac{E'}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\n- 为了模拟沿裂缝线的层状结构，允许 $E'$ 随观测点 $x$ 变化，方法是在每一行中乘上 $E'(x_j^c)$，即\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N,\n$$\n当 $E'$ 为常数时，该式可恢复为精确的均匀核函数。\n\n验证要求：\n- 对于具有恒定 $E'$ 的均匀介质，在均匀内压 $p(x)=p_0$ 作用下，其解析张开剖面为\n$$\nw_{\\mathrm{ana}}(x) \\;=\\; \\frac{4 p_0 a}{E'} \\sqrt{1 - \\left(\\frac{x}{a}\\right)^2}, \\quad x \\in (-a,a).\n$$\n- 您必须计算并报告数值解与解析解在配置点处的误差。使用相对 $\\ell^2$ 误差\n$$\n\\varepsilon_2 \\;=\\; \\sqrt{ \\frac{ \\sum_{j=1}^N \\left( w_j - w_{\\mathrm{ana}}(x_j^c) \\right)^2 }{ \\sum_{j=1}^N \\left( w_{\\mathrm{ana}}(x_j^c) \\right)^2 } }\n$$\n和相对最大误差\n$$\n\\varepsilon_\\infty \\;=\\; \\frac{ \\max_{1\\le j\\le N} \\left| w_j - w_{\\mathrm{ana}}(x_j^c) \\right| }{ \\max_{1\\le j\\le N} \\left| w_{\\mathrm{ana}}(x_j^c) \\right| }.\n$$\n\n层状情况的计算量：\n- 对于非均匀的 $E'(x)$ 和均匀内压 $p_0$，计算单位厚度的裂缝体积，\n$$\nV \\;=\\; \\int_{-a}^{a} w(x)\\, dx,\n$$\n并以平方米（$\\mathrm{m}^2$）为单位报告。对于您的分段常数 $w_i$，使用中点法则进行计算\n$$\nV \\;\\approx\\; \\sum_{i=1}^N w_i \\, h.\n$$\n\n单位与约定：\n- 长度单位使用米（$\\mathrm{m}$），压力和模量单位使用帕斯卡（$\\mathrm{Pa}$），秒（$\\mathrm{s}$）单位在此不明确需要。\n- 所有报告的误差度量 $\\varepsilon_2$ 和 $\\varepsilon_\\infty$ 都是无量纲的。裂缝体积 $V$ 必须以 $\\mathrm{m}^2$ 为单位报告。\n- 不使用角度，也无需报告。\n- 如果需要报告任何比率，请以小数形式报告（不要使用百分号）。\n\n测试套件：\n实现您的程序以解决以下三个测试用例，并将结果汇总到单行输出中。\n\n- 测试用例 A（均匀介质，精细离散化的“理想情况”）：\n  - 半长 $a = 1500\\,\\mathrm{m}$。\n  - 均匀压力 $p_0 = 3.0\\times 10^6\\,\\mathrm{Pa}$。\n  - 弹性属性：$E=60.0\\times 10^9\\,\\mathrm{Pa}$，$\\nu=0.25$，因此 $E' = E/(1-\\nu^2)$。\n  - 单元数量 $N=256$。\n  - 输出：相对 $\\ell^2$ 误差 $\\varepsilon_2$，作为浮点数。\n\n- 测试用例 B（均匀介质，粗糙离散化的边界情况）：\n  - $a$、$p_0$、$E$、$\\nu$ 与测试用例 A 相同。\n  - 单元数量 $N=32$。\n  - 输出：相对最大误差 $\\varepsilon_\\infty$，作为浮点数。\n\n- 测试用例 C（分段均匀的“层状”沿裂缝模量）：\n  - $a$ 和 $p_0$ 与测试用例 A 相同。\n  - 各处泊松比 $\\nu=0.25$。\n  - 杨氏模量 $E(x)$ 在 $x0$ 时为 $50.0\\times 10^9\\,\\mathrm{Pa}$，在 $x\\ge 0$ 时为 $100.0\\times 10^9\\,\\mathrm{Pa}$，且 $E'(x)=E(x)/(1-\\nu^2)$。\n  - 单元数量 $N=256$。\n  - 输出：单位厚度裂缝体积 $V$，以 $\\mathrm{m}^2$ 为单位，作为浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序排列的三个结果，形式为方括号内以逗号分隔的列表，即\n$$\n[$\\varepsilon_2$, $\\varepsilon_\\infty$, $V$].\n$$\n不应打印任何额外文本。", "solution": "用户提供了一个在计算地球物理学领域，特别是在岩浆动力学和岩脉扩展领域的适定问题。任务是实现一个二维边界元法（BEM）来模拟一个受压的平面应变裂缝，对其进行验证，并将其应用于非均匀材料情况。该问题陈述基于线性弹性断裂力学，是自洽的，并提供了所有必要的方程、参数和验证标准。因此，该问题是有效的，将构建一个解决方案。\n\n问题的核心是求解未知的裂缝张开位移 $w(x)$，给定内部净压力 $p(x)$ 和周围弹性介质的力学特性。这些量之间的关系由一个离散化的超奇异边界积分方程给出。\n\n提供的离散方程组为：\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\n此处，$w_i$ 代表第 $i$ 个单元的未知常数张开度，$p(x_j^c)$ 是第 $j$ 个配置点（单元中心）的已知压力，而 $E'(x_j^c)$ 是该点的平面应变模量。裂缝被离散为 $N$ 个等长单元，长度为 $h = 2a/N$，单元边界位于 $x_i$ ($i=0,\\dots,N$)处。\n\n这个包含 $N$ 个未知数的 $N$ 个方程组可以表示为一个标准的矩阵-向量方程。为便于求解，我们可以重新整理方程以分离出未知向量 $w$（其分量为 $w_i$）。对于每个配置点 $j$，我们有：\n$$\n\\frac{p(x_j^c)}{E'(x_j^c)} = \\sum_{i=1}^N w_i \\left( \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right] \\right)\n$$\n这是一个形如 $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$ 的线性系统，其中：\n- $\\mathbf{w}$ 是未知单元张开度向量 $[w_1, w_2, \\dots, w_N]^T$。\n- $\\mathbf{A}$ 是 $N \\times N$ 的影响矩阵，其元素仅取决于离散化的几何形状。元素 $A_{ji}$（第 $j$ 行，第 $i$ 列）由下式给出：\n$$\nA_{ji} = \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right]\n$$\n- $\\mathbf{b}$ 是 $N \\times 1$ 的右侧向量，它包含了载荷和材料属性。第 $j$ 个分量为：\n$$\nb_j = \\frac{p(x_j^c)}{E'(x_j^c)}\n$$\n\n数值实现过程如下：\n\n1.  **离散化与网格生成**：对于给定的半长 $a$ 和单元数 $N$，划分域 $[-a, a]$。计算单元边界 $x_i = -a + i h$（$i=0, \\dots, N$）和配置点 $x_j^c = -a + (j-0.5)h$（$j=1, \\dots, N$）。\n\n2.  **矩阵和向量组装**：\n    - 构造几何影响矩阵 $\\mathbf{A}$。其 $N^2$ 个元素的计算可以通过将配置点和单元边界分别表示为列向量和行向量，并使用广播操作来高效地进行向量化。\n    - 构造右侧向量 $\\mathbf{b}$。这需要在 $N$ 个配置点上分别计算压力 $p(x)$ 和平面应变模量 $E'(x)$。对于测试用例C，$E'(x)$ 是一个分段函数，必须为每个 $x_j^c$ 进行相应计算。\n\n3.  **求解系统**：使用标准库的线性代数求解器（如 `numpy.linalg.solve`）求解稠密线性系统 $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$，得到张开度向量 $\\mathbf{w}$。\n\n4.  **后处理**：\n    - **验证（用例 A 和 B）**：对于均匀介质，将数值解 $\\mathbf{w}$ 与在配置点上计算的解析解 $w_{\\mathrm{ana}}(x)$ 进行比较：\n      $$\n      w_{\\mathrm{ana}}(x) = \\frac{4 p_0 a}{E'} \\sqrt{1 - (x/a)^2}\n      $$\n      根据问题定义计算相对 $\\ell^2$ 误差 $\\varepsilon_2$ 和相对最大误差 $\\varepsilon_\\infty$，以量化BEM求解器的准确性。\n    - **目标量计算（用例 C）**：对于非均匀情况，计算单位厚度的总裂缝体积 $V$。使用与分段常数张开假设一致的中点法则近似，体积为：\n      $$\n      V = \\int_{-a}^{a} w(x) \\,dx \\approx \\sum_{i=1}^N w_i h\n      $$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_bem(a, p0, E_param, nu, N, output_type):\n    \"\"\"\n    Implements a Boundary Element Method for a pressurized crack.\n\n    Args:\n        a (float): Crack half-length in meters.\n        p0 (float): Uniform internal pressure in Pascals.\n        E_param (float or callable): Young's modulus in Pascals.\n                                   If float, it's constant.\n                                   If callable, it's a function E(x).\n        nu (float): Poisson's ratio.\n        N (int): Number of elements.\n        output_type (str): The quantity to compute and return.\n                           'l2_error', 'max_error', or 'volume'.\n\n    Returns:\n        float: The requested output quantity.\n    \"\"\"\n    # 1. Setup mesh\n    h = 2.0 * a / N\n    # Element boundaries (N+1 points, 0-indexed)\n    x_nodes = np.linspace(-a, a, N + 1)\n    # Collocation points (N points, element centers)\n    x_colloc = x_nodes[:-1] + h / 2.0\n\n    # 2. Define E' and p vectors\n    p_vec = np.full(N, p0)\n    \n    if callable(E_param):  # Heterogeneous case\n        E_vals = np.array([E_param(x) for x in x_colloc])\n        E_prime_vals = E_vals / (1.0 - nu**2)\n    else:  # Homogeneous case\n        E_prime_const = E_param / (1.0 - nu**2)\n        E_prime_vals = np.full(N, E_prime_const)\n\n    # 3. Construct the influence matrix A and RHS vector b\n    # The system is A * w = b, where b_j = p_j / E'(x_j^c) and\n    # A_ji = (1/(4*pi)) * [ 1/(x_i - x_j^c) - 1/(x_{i-1} - x_j^c) ]\n    # Using 0-based indexing for i, j in [0, N-1]:\n    # x_i -> x_nodes[i+1], x_{i-1} -> x_nodes[i], x_j^c -> x_colloc[j]\n    \n    x_colloc_col = x_colloc.reshape(-1, 1)    # Shape (N, 1)\n    xi_row = x_nodes[1:].reshape(1, -1)       # Shape (1, N), represents x_i\n    xi_m1_row = x_nodes[:-1].reshape(1, -1)   # Shape (1, N), represents x_{i-1}\n\n    # Broadcasting creates (N, N) matrices\n    term1_matrix = 1.0 / (xi_row - x_colloc_col)\n    term2_matrix = 1.0 / (xi_m1_row - x_colloc_col)\n\n    kernel_matrix = term1_matrix - term2_matrix\n    A = (1.0 / (4.0 * np.pi)) * kernel_matrix\n\n    b_vec = p_vec / E_prime_vals\n\n    # 4. Solve for w\n    w = np.linalg.solve(A, b_vec)\n\n    # 5. Calculate and return the required output\n    if output_type == 'l2_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        l2_error = np.linalg.norm(w - w_ana) / np.linalg.norm(w_ana)\n        return l2_error\n    \n    elif output_type == 'max_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        max_error = np.max(np.abs(w - w_ana)) / np.max(np.abs(w_ana))\n        return max_error\n        \n    elif output_type == 'volume':\n        volume = np.sum(w) * h\n        return volume\n        \n    else:\n        raise ValueError(\"Invalid output type specified.\")\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Test Case A: Homogeneous, fine discretization\n    a_A, p0_A, E_A, nu_A, N_A = 1500.0, 3.0e6, 60.0e9, 0.25, 256\n    result_A = calculate_bem(a_A, p0_A, E_A, nu_A, N_A, 'l2_error')\n    \n    # Test Case B: Homogeneous, coarse discretization\n    a_B, p0_B, E_B, nu_B, N_B = 1500.0, 3.0e6, 60.0e9, 0.25, 32\n    result_B = calculate_bem(a_B, p0_B, E_B, nu_B, N_B, 'max_error')\n    \n    # Test Case C: Layered modulus\n    a_C, p0_C, nu_C, N_C = 1500.0, 3.0e6, 0.25, 256\n    def E_func_C(x):\n        return 50.0e9 if x  0 else 100.0e9\n    result_C = calculate_bem(a_C, p0_C, E_func_C, nu_C, N_C, 'volume')\n    \n    results = [result_A, result_B, result_C]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3608435"}]}