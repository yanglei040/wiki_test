{"hands_on_practices": [{"introduction": "真实的地质构造通常表现出各向异性，这意味着地下水在不同方向上的渗透能力不同。本练习将帮助你实践达西定律的完整张量形式，这是构建任何数值模型前至关重要的一步。通过本练习，你将学会当水力梯度方向与渗透主方向不一致时，如何精确计算地下水的流速矢量。[@problem_id:3614543]", "problem": "考虑一个二维、均质、饱和含水层中的单相地下水流动。假设流体密度和粘度恒定，惯性效应可忽略不计，且流动处于稳态条件。设水力传导率是各向异性的，其主导水率方向与一个坐标系对齐，该坐标系由全局 $x$–$y$ 坐标系绕平面外轴逆时针旋转角度 $\\theta$ 得到。全局坐标系中的水力传导率张量由 $K = R \\Lambda R^{\\top}$ 给出，其中 $R$ 是旋转矩阵，$\\Lambda$ 是主导水率的对角矩阵。\n\n从饱和单相流的达西定律和二阶材料属性的张量变换出发，推导在指定配置下的全局坐标系通量，并计算其精确数值（不进行四舍五入）。使用国际单位制 (SI)。\n\n数据：\n- 旋转角度 $\\theta = \\pi/6$。\n- 旋转矩阵 $R = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}$。\n- 主水力传导率 $\\Lambda = \\operatorname{diag}(k_1, k_2)$，其中 $k_1 = 1.0 \\times 10^{-4}$，$k_2 = 4.0 \\times 10^{-5}$ (单位：米/秒)。\n- 恒定水头梯度 $\\nabla h = \\begin{pmatrix}2.0 \\times 10^{-2} \\\\ -1.0 \\times 10^{-2}\\end{pmatrix}$ (单位：无量纲/米，因为水头单位是米)。\n\n任务：\n1. 使用达西定律的基本本构关系和适当的张量旋转，推导全局坐标系中水力传导率分量关于 $\\theta$、$k_1$ 和 $k_2$ 的表达式，然后代入 $\\theta = \\pi/6$ 的情况。\n2. 通过达西定律，计算与给定 $\\nabla h$ 相关的全局坐标系通量 $\\mathbf{q}$。\n\n以米/秒为单位，精确表示最终的通量分量（不进行四舍五入）。将 $\\mathbf{q}$ 的两个分量作为最终答案。", "solution": "用户的要求是解决一个二维、各向异性、稳态的地下水流问题。\n\n### 第一步：提取已知条件\n- **物理系统**：一个二维、均质、饱和含水层。\n- **流动条件**：单相地下水流，流体密度和粘度恒定，惯性效应可忽略不计，稳态。\n- **各向异性**：主导水率与一个坐标系对齐，该坐标系由全局 $x$–$y$ 坐标系逆时针旋转角度 $\\theta$ 得到。\n- **旋转角度**：$\\theta = \\pi/6$。\n- **旋转矩阵**：$R = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}$。\n- **主水力传导率**：$\\Lambda = \\operatorname{diag}(k_1, k_2)$，其中 $k_1 = 1.0 \\times 10^{-4}$ m/s，$k_2 = 4.0 \\times 10^{-5}$ m/s。\n- **水力传导率张量 (全局坐标系)**：$K = R \\Lambda R^{\\top}$。\n- **水头梯度 (全局坐标系)**：$\\nabla h = \\begin{pmatrix}2.0 \\times 10^{-2} \\\\ -1.0 \\times 10^{-2}\\end{pmatrix}$ (无量纲)。\n- **本构定律**：各向异性介质的达西定律，$\\mathbf{q} = -K \\nabla h$。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学性**：该问题基于达西定律和材料属性的张量变换原理，这些是水文地质学和连续介质力学的基础概念。物理情景是各向异性地下水流动的标准表述。给定的数值对于典型的含水层材料是物理上合理的。\n- **适定性**：问题提供了一套完整的数据和一个明确的目标：计算通量矢量 $\\mathbf{q}$。关系式 $\\mathbf{q} = -K \\nabla h$ 确保了唯一解的存在并且可以直接计算。\n- **客观性**：问题使用精确、无歧义的科学语言陈述。\n- **完整性与一致性**：所有必要的参数（$k_1$、$k_2$、$\\theta$、$\\nabla h$）都已提供。单位采用国际单位制 (SI) 并且始终保持一致。公式不包含内部矛盾。\n- **其他缺陷**：该问题并非不切实际、不适定、故弄玄虚或无法验证。它是一个标准的、定义明确的物理问题。\n\n### 第三步：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n### 解答推导\n\n任务是计算全局坐标系通量矢量 $\\mathbf{q}$，它由各向异性介质的达西定律定义：\n$$\n\\mathbf{q} = -K \\nabla h\n$$\n其中 $\\mathbf{q}$ 是比流量矢量（通量），$K$ 是全局坐标系中的水力传导率张量，$\\nabla h$ 是全局坐标系中的水头梯度矢量。\n\n按要求，解答分为两部分。\n\n**第一部分：推导全局坐标系水力传导率张量 $K$。**\n\n全局 $x$–$y$ 坐标系中的水力传导率张量 $K$ 是通过将主导水率的对角张量 $\\Lambda$ 从其主坐标系旋转得到的。变换规则为 $K = R \\Lambda R^{\\top}$。\n\n各矩阵为：\n$$\nR = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}\n$$\n$$\n\\Lambda = \\begin{pmatrix}k_1  0 \\\\ 0  k_2\\end{pmatrix}\n$$\n$$\nR^{\\top} = \\begin{pmatrix}\\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta\\end{pmatrix}\n$$\n\n首先，我们计算乘积 $R\\Lambda$：\n$$\nR\\Lambda = \\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix} \\begin{pmatrix}k_1  0 \\\\ 0  k_2\\end{pmatrix} = \\begin{pmatrix}k_1\\cos\\theta  -k_2\\sin\\theta \\\\ k_1\\sin\\theta  k_2\\cos\\theta\\end{pmatrix}\n$$\n接下来，我们将此结果乘以 $R^{\\top}$ 来求 $K$：\n$$\nK = (R\\Lambda)R^{\\top} = \\begin{pmatrix}k_1\\cos\\theta  -k_2\\sin\\theta \\\\ k_1\\sin\\theta  k_2\\cos\\theta\\end{pmatrix} \\begin{pmatrix}\\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta\\end{pmatrix}\n$$\n执行矩阵乘法，得到 $K = \\begin{pmatrix}K_{11}  K_{12} \\\\ K_{21}  K_{22}\\end{pmatrix}$ 的分量：\n$$\nK_{11} = (k_1\\cos\\theta)(\\cos\\theta) + (-k_2\\sin\\theta)(-\\sin\\theta) = k_1\\cos^{2}\\theta + k_2\\sin^{2}\\theta\n$$\n$$\nK_{12} = (k_1\\cos\\theta)(\\sin\\theta) + (-k_2\\sin\\theta)(\\cos\\theta) = (k_1 - k_2)\\sin\\theta\\cos\\theta\n$$\n$$\nK_{21} = (k_1\\sin\\theta)(\\cos\\theta) + (k_2\\cos\\theta)(-\\sin\\theta) = (k_1 - k_2)\\sin\\theta\\cos\\theta\n$$\n$$\nK_{22} = (k_1\\sin\\theta)(\\sin\\theta) + (k_2\\cos\\theta)(\\cos\\theta) = k_1\\sin^{2}\\theta + k_2\\cos^{2}\\theta\n$$\n这给出了全局坐标系水力传导率张量分量的一般解析表达式。\n\n现在，我们代入给定的角度 $\\theta = \\pi/6$：\n- $\\sin(\\pi/6) = 1/2$\n- $\\cos(\\pi/6) = \\sqrt{3}/2$\n- $\\sin^{2}(\\pi/6) = (1/2)^2 = 1/4$\n- $\\cos^{2}(\\pi/6) = (\\sqrt{3}/2)^2 = 3/4$\n- $\\sin(\\pi/6)\\cos(\\pi/6) = (1/2)(\\sqrt{3}/2) = \\sqrt{3}/4$\n\n将这些值代入 $K$ 的分量中：\n$$\nK_{11} = k_1(\\frac{3}{4}) + k_2(\\frac{1}{4}) = \\frac{3k_1 + k_2}{4}\n$$\n$$\nK_{12} = K_{21} = (k_1 - k_2)\\frac{\\sqrt{3}}{4}\n$$\n$$\nK_{22} = k_1(\\frac{1}{4}) + k_2(\\frac{3}{4}) = \\frac{k_1 + 3k_2}{4}\n$$\n现在，我们代入主导水率的数值，$k_1 = 1.0 \\times 10^{-4}$ m/s 和 $k_2 = 4.0 \\times 10^{-5}$ m/s：\n$$\nK_{11} = \\frac{3(1.0 \\times 10^{-4}) + (4.0 \\times 10^{-5})}{4} = \\frac{3.0 \\times 10^{-4} + 0.4 \\times 10^{-4}}{4} = \\frac{3.4 \\times 10^{-4}}{4} = 0.85 \\times 10^{-4} \\text{ m/s}\n$$\n$$\nK_{12} = K_{21} = \\frac{(1.0 \\times 10^{-4} - 4.0 \\times 10^{-5})\\sqrt{3}}{4} = \\frac{(0.6 \\times 10^{-4})\\sqrt{3}}{4} = 0.15\\sqrt{3} \\times 10^{-4} \\text{ m/s}\n$$\n$$\nK_{22} = \\frac{(1.0 \\times 10^{-4}) + 3(4.0 \\times 10^{-5})}{4} = \\frac{1.0 \\times 10^{-4} + 1.2 \\times 10^{-4}}{4} = \\frac{2.2 \\times 10^{-4}}{4} = 0.55 \\times 10^{-4} \\text{ m/s}\n$$\n因此，全局坐标系中的水力传导率张量为：\n$$\nK = \\begin{pmatrix} 0.85 \\times 10^{-4}  0.15\\sqrt{3} \\times 10^{-4} \\\\ 0.15\\sqrt{3} \\times 10^{-4}  0.55 \\times 10^{-4} \\end{pmatrix} \\text{ m/s}\n$$\n\n**第二部分：计算全局坐标系通量 $\\mathbf{q}$。**\n\n我们使用达西定律 $\\mathbf{q} = -K \\nabla h$，以及计算出的张量 $K$ 和给定的梯度 $\\nabla h = \\begin{pmatrix} 2.0 \\times 10^{-2} \\\\ -1.0 \\times 10^{-2} \\end{pmatrix}$。\n设 $\\mathbf{q} = \\begin{pmatrix} q_x \\\\ q_y \\end{pmatrix}$。\n$$\n\\begin{pmatrix} q_x \\\\ q_y \\end{pmatrix} = -\\begin{pmatrix} 0.85 \\times 10^{-4}  0.15\\sqrt{3} \\times 10^{-4} \\\\ 0.15\\sqrt{3} \\times 10^{-4}  0.55 \\times 10^{-4} \\end{pmatrix} \\begin{pmatrix} 2.0 \\times 10^{-2} \\\\ -1.0 \\times 10^{-2} \\end{pmatrix}\n$$\n我们计算分量 $q_x$ 和 $q_y$：\n$$\nq_x = - \\left[ (0.85 \\times 10^{-4})(2.0 \\times 10^{-2}) + (0.15\\sqrt{3} \\times 10^{-4})(-1.0 \\times 10^{-2}) \\right]\n$$\n$$\nq_x = - \\left[ 1.7 \\times 10^{-6} - 0.15\\sqrt{3} \\times 10^{-6} \\right] = - (1.7 - 0.15\\sqrt{3}) \\times 10^{-6} = (0.15\\sqrt{3} - 1.7) \\times 10^{-6} \\text{ m/s}\n$$\n乘数为 $0.15\\sqrt{3} - 1.7 \\approx 0.2598 - 1.7 = -1.4402$。由于 $1 \\le |-1.4402|  10$，该表达式符合标准科学记数法。\n\n$$\nq_y = - \\left[ (0.15\\sqrt{3} \\times 10^{-4})(2.0 \\times 10^{-2}) + (0.55 \\times 10^{-4})(-1.0 \\times 10^{-2}) \\right]\n$$\n$$\nq_y = - \\left[ 0.3\\sqrt{3} \\times 10^{-6} - 0.55 \\times 10^{-6} \\right] = - (0.3\\sqrt{3} - 0.55) \\times 10^{-6} = (0.55 - 0.3\\sqrt{3}) \\times 10^{-6} \\text{ m/s}\n$$\n为了用标准科学记数法表示，其中首系数的绝对值在1和10之间，我们计算该系数：$0.55 - 0.3\\sqrt{3} \\approx 0.55 - 0.5196 = 0.0304$。这不在要求的范围内。我们调整指数：\n$$\nq_y = (0.55 - 0.3\\sqrt{3}) \\times 10^{-6} = (55 - 30\\sqrt{3}) \\times 10^{-8} \\text{ m/s}\n$$\n新的乘数为 $55 - 30\\sqrt{3} \\approx 55 - 51.96 = 3.04$。由于 $1 \\le |3.04|  10$，这是正确的标准科学记数法。\n\n通量矢量的最终分量是：\n$q_x = (0.15\\sqrt{3} - 1.7) \\times 10^{-6}$ m/s\n$q_y = (55 - 30\\sqrt{3}) \\times 10^{-8}$ m/s", "answer": "$$\n\\boxed{\\begin{pmatrix} (0.15\\sqrt{3} - 1.7) \\times 10^{-6}  (55 - 30\\sqrt{3}) \\times 10^{-8} \\end{pmatrix}}\n$$", "id": "3614543"}, {"introduction": "在掌握了基本物理定律后，下一步是进行空间离散化，将连续的控制方程转化为可解的代数方程组。本练习旨在解决地下水模拟中的一个核心挑战：如何精确地表示含水层中渗透率的剧烈变化。通过比较有限差分和有限元方法，以及不同的渗透率平均技术，你将深入理解选择符合物理规律的离散化方案对保证模拟精度的重要性。[@problem_id:3614550]", "problem": "您需要通过第一性原理推导和受控计算来研究，导水率的棋盘格状空间变异性如何影响稳态单相地下水流动的两种经典离散化方法的精度：一种是单元中心的双点通量有限差分法（在笛卡尔网格上通常等效于有限体积法），另一种是基于三角形的协调线性有限元法。您必须量化电导率平均和网格对齐对解质量的影响，并提出一种补救措施。\n\n基本原理。从质量守恒定律和 Darcy 定律出发。在饱和、单相、不可压缩介质中，当不存在体积储存时，质量守恒表示为 $$\\nabla \\cdot \\boldsymbol{q} = s,$$ 其中 $\\boldsymbol{q}$ 是达西通量，单位为 $\\mathrm{m}/\\mathrm{s}$，$s$ 是体积源项，单位为 $1/\\mathrm{s}$，注入时为正值。对于各向同性介质，Darcy 定律给出 $$\\boldsymbol{q} = -K(\\boldsymbol{x}) \\nabla h,$$ 其中 $K(\\boldsymbol{x})$ 是导水率，单位为 $\\mathrm{m}/\\mathrm{s}$，$h$ 是水头，单位为 $\\mathrm{m}$。将两者结合，得到散度形式的二阶椭圆边值问题 $$-\\nabla \\cdot \\left( K(\\boldsymbol{x}) \\nabla h(\\boldsymbol{x}) \\right) = s(\\boldsymbol{x}).$$ 对于本问题，将源项设为零，$$s(\\boldsymbol{x}) = 0,$$ 并施加狄利克雷边界条件 $$h(\\boldsymbol{x}) = h_D(\\boldsymbol{x}) \\text{ on } \\partial \\Omega,$$ 其中边界水头 $h_D$ 是预先设定的。\n\n域和边界数据。设域为单位正方形 $$\\Omega = [0,1] \\times [0,1] \\text{ in } \\mathrm{m},$$ 狄利克雷边界条件为 $$h_D(x,y) = 1 - x \\text{ in } \\mathrm{m}.$$ 此边界条件强制施加一个从左到右的水平水力梯度。\n\n导水率场。定义一个“棋盘格”导水率场为一个分段常数的方形瓦片场，其值在 $K_{\\mathrm{high}}$ 和 $K_{\\mathrm{low}}$ 之间在 $x$ 和 $y$ 方向上交替变化。将 $[0,1]$ 在每个方向上划分为 $m_c$ 个等长区间；因此每个方形瓦片的边长为 $$\\ell = 1/m_c \\text{ in } \\mathrm{m}.$$ 对于给定的偏移量 $(\\delta_x,\\delta_y)$，其中 $0 \\le \\delta_x, \\delta_y  \\ell$，定义 $$\\tilde{x} = (x + \\delta_x) \\bmod 1, \\quad \\tilde{y} = (y + \\delta_y) \\bmod 1,$$ 和瓦片索引 $$i = \\left\\lfloor m_c \\tilde{x} \\right\\rfloor, \\quad j = \\left\\lfloor m_c \\tilde{y} \\right\\rfloor.$$ 然后设置 $$K(x,y) = \\begin{cases} K_{\\mathrm{high}},  \\text{if } (i + j) \\bmod 2 = 0, \\\\ K_{\\mathrm{low}},  \\text{if } (i + j) \\bmod 2 = 1. \\end{cases}$$\n\n待比较的离散化方法。\n\n- 单元中心的两点通量有限差分法。考虑一个由 $N_x \\times N_y$ 个矩形单元组成的均匀笛卡尔网格，每个单元的尺寸为 $$\\Delta x = 1/N_x, \\quad \\Delta y = 1/N_y \\text{ in } \\mathrm{m}.$$ 未知量是单元中心的水头 $h_{i,j}$，其中 $i = 0,\\dots,N_x-1$, $j=0,\\dots,N_y-1$。跨单元面的通量使用两点传导系数计算，其中面上的导水率 $K_f$ 可通过算术平均 $$K_f^{\\mathrm{arith}} = \\frac{1}{2}\\left(K_L + K_R\\right)$$ 或调和平均 $$K_f^{\\mathrm{harm}} = \\left(\\frac{1}{2}\\left(\\frac{1}{K_L} + \\frac{1}{K_R}\\right)\\right)^{-1},$$ 计算，其中 $K_L$ 和 $K_R$ 是相邻两个单元的导水率。边界上的单元面使用单侧传导系数，与半个单元距离（$\\Delta x/2$ 或 $\\Delta y/2$）和单元自身的导水率保持一致。狄利克雷边界条件 $h_D$ 通过面传导系数并入右侧项。这会产生一个稀疏线性系统 $$\\mathbf{A}_{\\mathrm{FD}} \\mathbf{h}_{\\mathrm{FD}} = \\mathbf{b}_{\\mathrm{FD}}.$$\n\n- 基于直角三角形网格的协调线性有限元法。将一个均匀的 $(N_x \\times N_y)$ 方形网格通过固定的对角线细分为 $2N_x N_y$ 个直角三角形。在顶点（节点）上定义 $P_1$ 基函数。刚度矩阵通过对每个单元进行组装，其形式为 $$a(u,v) = \\int_{\\Omega} K \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\Omega,$$ 通过单元形心处的 $K$ 值来近似 $K$。通过覆写边界行和右侧项为 $h_D$ 值来强施加狄利克雷条件。这会产生 $$\\mathbf{A}_{\\mathrm{FE}} \\mathbf{h}_{\\mathrm{FE}} = \\mathbf{b}_{\\mathrm{FE}}.$$\n\n参考解。由于对于不连续的 $K$ 不存在闭式解，因此定义一个在均匀的 $(N_x^{\\mathrm{ref}} \\times N_y^{\\mathrm{ref}})$ 网格上的精细网格有限元解作为参考解，其中 $N_x^{\\mathrm{ref}}$ 和 $N_y^{\\mathrm{ref}}$ 是粗网格 $N_x$ 和 $N_y$ 的整数倍。\n\n误差度量。对于任意离散场 $\\hat{h}$ 和参考场 $h^{\\mathrm{ref}}$，通过黎曼和定义连续 $\\mathrm{L}^2$ 误差范数的离散近似。对于单元中心 $(x_{i+1/2},y_{j+1/2})$ 处的有限差分未知量，且单元面积均匀为 $\\Delta x \\Delta y$，定义 $$E_{\\mathrm{FD}} = \\left( \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\left( \\hat{h}_{i,j} - h^{\\mathrm{ref}}(x_{i+1/2}, y_{j+1/2}) \\right)^2 \\, \\Delta x \\Delta y \\right)^{1/2} \\text{ in } \\mathrm{m}.$$ 对于节点 $(x_p,y_p)$ 处的有限元节点未知量，近似为 $$E_{\\mathrm{FE}} = \\left( \\sum_{p=1}^{N_{\\mathrm{nodes}}} \\left( \\hat{h}_p - h^{\\mathrm{ref}}(x_p, y_p) \\right)^2 \\, w \\right)^{1/2} \\text{ in } \\mathrm{m},$$ 节点权重均匀为 $$w = \\frac{|\\Omega|}{N_{\\mathrm{nodes}}} = \\frac{1}{N_{\\mathrm{nodes}}} \\text{ in } \\mathrm{m}^2.$$\n\n测试。使用以下参数化测试，每个测试使用相同的粗网格和参考网格：\n\n- 有限差分和有限元的粗网格：$$N_x = N_y = 16.$$\n- 参考有限元网格：$$N_x^{\\mathrm{ref}} = N_y^{\\mathrm{ref}} = 64.$$\n- 棋盘格瓦片数量：$$m_c = 8.$$\n\n需要运行三个测试：\n\n- 测试 A（对齐，高对比度）：$$K_{\\mathrm{high}} = 10^{-3} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad K_{\\mathrm{low}} = 10^{-6} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad (\\delta_x,\\delta_y) = (0,0).$$\n- 测试 B（未对齐，高对比度）：$$K_{\\mathrm{high}} = 10^{-3} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad K_{\\mathrm{low}} = 10^{-6} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad (\\delta_x,\\delta_y) = \\left(\\frac{1}{2 m_c}, 0\\right).$$\n- 测试 C（对齐，低对比度）：$$K_{\\mathrm{high}} = 10^{-4} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad K_{\\mathrm{low}} = 10^{-5} \\text{ in } \\mathrm{m}/\\mathrm{s}, \\quad (\\delta_x,\\delta_y) = (0,0).$$\n\n对于每个测试，计算三个误差：\n\n- $$E_{\\mathrm{FD}}^{\\mathrm{arith}}$$ 使用有限差分法中的算术平均面电导率，\n- $$E_{\\mathrm{FD}}^{\\mathrm{harm}}$$ 使用有限差分法中的调和平均面电导率，\n- $$E_{\\mathrm{FE}}$$ 用于粗网格有限元解。\n\n最终输出格式。您的程序必须生成单行输出，包含一个 Python 风格的列表，其中有 9 个浮点数（单位为米），顺序如下 $$\\left[ E_{\\mathrm{FD}}^{\\mathrm{arith}}(\\text{A}), E_{\\mathrm{FD}}^{\\mathrm{harm}}(\\text{A}), E_{\\mathrm{FE}}(\\text{A}), E_{\\mathrm{FD}}^{\\mathrm{arith}}(\\text{B}), E_{\\mathrm{FD}}^{\\mathrm{harm}}(\\text{B}), E_{\\mathrm{FE}}(\\text{B}), E_{\\mathrm{FD}}^{\\mathrm{arith}}(\\text{C}), E_{\\mathrm{FD}}^{\\mathrm{harm}}(\\text{C}), E_{\\mathrm{FE}}(\\text{C}) \\right],$$ 不得包含额外文本。所有报告值必须以 $\\mathrm{m}$ 为单位。\n\n您的程序必须是一个完整、可运行的实现，能够构建两种离散化方案，组装并求解所得到的线性系统，构建参考有限元解，在所需位置评估参考解，按规定计算 $\\mathrm{L}^2$ 误差，并以要求的确切格式打印列表。不允许用户输入；所有参数均按上述规定固定。", "solution": "用户提供了一个适定的计算地球物理学问题，具体涉及单相地下水流的数值模拟。该任务要求在不连续的棋盘格模式导水率场 $K(\\boldsymbol{x})$ 存在的情况下，比较两种标准离散化方案——单元中心有限差分（FD）法和协调线性有限元（FE）法。问题的核心在于量化当 $K$ 不连续时，椭圆算子 $-\\nabla \\cdot (K \\nabla h)$ 的离散化所引入的数值误差，以及不同的数值处理方法如何影响其精度。\n\n该问题是有效的，因为它在科学上基于质量守恒和 Darcy 定律的原理，在数学上是适定的，并且所有参数和条件都已明确定义。我们将进行完整的求解。\n\n求解方法包括以下原则性步骤：\n1.  **参考解**：由于无法获得解析解，需要一个高精度的数值解作为真实解的代理。我们将按照规定，使用有限元法在精细网格（$N_x^{\\mathrm{ref}} = N_y^{\\mathrm{ref}} = 64$）上计算此参考解。得到的逐片线性场 $h^{\\mathrm{ref}}$ 可以通过重心插值在域内任意点进行求值。我们将为此使用 `scipy.interpolate.LinearNDInterpolator`。\n\n2.  **有限元（FE）实现**：我们将实现一个标准的 $P_1$ 协调有限元法。域 $\\Omega = [0,1]^2$ 首先通过创建一个 $N_x \\times N_y$ 的方形网格进行网格划分，然后用一条一致的对角线将每个正方形细分为两个直角三角形。\n    -   控制方程 $-\\nabla \\cdot (K \\nabla h) = 0$ 的弱形式是 $a(h, v) = 0$，对所有有效的测试函数 $v$ 成立，其中双线性形式为 $a(u,v) = \\int_{\\Omega} K(\\boldsymbol{x}) \\nabla u \\cdot \\nabla v \\, d\\Omega$。\n    -   离散问题是 $\\mathbf{A}_{\\mathrm{FE}} \\mathbf{h}_{\\mathrm{FE}} = \\mathbf{b}_{\\mathrm{FE}}$。刚度矩阵 $\\mathbf{A}_{\\mathrm{FE}}$ 通过遍历每个三角形单元 $e$，计算局部的 $3 \\times 3$ 刚度矩阵 $\\mathbf{A}_e$，并将其条目加到全局矩阵中来组装。\n    -   局部刚度矩阵的条目由 $(\\mathbf{A}_e)_{ij} = \\int_e K_e \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, d\\Omega$ 给出，其中 $\\phi_i$ 是线性基函数。由于 $\\nabla \\phi_i$ 在每个单元上是常数，这简化为 $(\\mathbf{A}_e)_{ij} = K_e (\\nabla \\phi_i \\cdot \\nabla \\phi_j) \\mathrm{Area}(e)$。根据问题要求，单元上的电导率 $K_e$ 通过其在单元形心处的值来近似为常数。\n    -   狄利克雷边界条件 $h(\\boldsymbol{x}) = 1-x$ 通过直接修改 $\\mathbf{A}_{\\mathrm{FE}}$ 的行和 $\\mathbf{b}_{\\mathrm{FE}}$ 中对应于所有边界节点的条目来“强”施加。\n\n3.  **有限差分（FD）实现**：在均匀的 $N_x \\times N_y$ 笛卡尔网格上实现一个单元中心、两点通量近似的有限差分格式。\n    -   将控制方程在一个大小为 $\\Delta x \\times \\Delta y$ 的控制体积（单元）$(i,j)$ 上积分，并应用散度定理，得到 $\\int_{\\partial C_{ij}} \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, dS = 0$。这表明跨单元边界的净通量为零。\n    -   跨四个面中每一个面的通量都使用两点格式近似。例如，单元 $(i,j)$ 和 $(i+1,j)$ 之间的东侧面通量为 $q_E \\approx - K_f \\frac{h_{i+1,j} - h_{i,j}}{\\Delta x}$，其中 $h_{i,j}$ 是单元 $(i,j)$ 中心的水头，$K_f$ 是面上的导水率。\n    -   关键的选择是平均相邻单元的导水率 $K_L$ 和 $K_R$ 以获得 $K_f$ 的方法。我们将实现两种方法：\n        -   **算术平均**：$K_f^{\\mathrm{arith}} = \\frac{1}{2}(K_L + K_R)$。已知此方法对于高对比度介质不准确。\n        -   **调和平均**：$K_f^{\\mathrm{harm}} = \\left(\\frac{1}{2}\\left(\\frac{1}{K_L} + \\frac{1}{K_R}\\right)\\right)^{-1}$。这是从考虑流过串联的两个层推导出来的，并且已知对于垂直于分层的一维流动，这是正确的有效导水率。它对于不连续的 $K$ 通常更准确。\n    -   对于边界上的面，使用单侧传导系数，将已知的狄利克雷水头值并入右侧向量 $\\mathbf{b}_{\\mathrm{FD}}$。从单元中心到边界的距离是 $\\Delta x/2$ 或 $\\Delta y/2$。\n    -   得到的线性方程组是 $\\mathbf{A}_{\\mathrm{FD}} \\mathbf{h}_{\\mathrm{FD}} = \\mathbf{b}_{\\mathrm{FD}}$。\n\n4.  **误差计算**：每个近似解（$\\hat{h}$）的精度都通过指定的离散 $\\mathrm{L}^2$ 误差范数与参考解（$h^{\\mathrm{ref}}$）进行度量。\n    -   对于 FD：$E_{\\mathrm{FD}} = \\left( \\sum_{i,j} (\\hat{h}_{i,j} - h^{\\mathrm{ref}}(x_{i+1/2}, y_{j+1/2}))^2 \\Delta x \\Delta y \\right)^{1/2}$。\n    -   对于 FE：$E_{\\mathrm{FE}} = \\left( \\sum_{p} (\\hat{h}_p - h^{\\mathrm{ref}}(x_p, y_p))^2 / N_{\\mathrm{nodes}} \\right)^{1/2}$。\n\n5.  **测试执行**：执行三个指定的测试用例（A、B、C）。这些用例改变了导水率对比度和离散化网格与棋盘格导水率场的对齐方式。对齐方式对于 FD 尤其重要，因为将网格错位，使单元面与 $K$ 的跳跃重合，预计将凸显算术平均和调和平均之间的差异。将收集并呈现九个由此产生的误差值。为保证数值稳定性和效率，所有线性系统都使用 `scipy.sparse` 构建为稀疏矩阵，并用 `scipy.sparse.linalg.spsolve` 求解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nfrom scipy.interpolate import LinearNDInterpolator\n\ndef get_K(coords, mc, K_high, K_low, delta_x, delta_y):\n    \"\"\"\n    Computes hydraulic conductivity K for a checkerboard field.\n    \n    Args:\n        coords (np.ndarray): (N, 2) array of (x, y) coordinates.\n        mc (int): Number of checkerboard tiles in each dimension.\n        K_high (float): High conductivity value.\n        K_low (float): Low conductivity value.\n        delta_x (float): Offset in x-direction.\n        delta_y (float): Offset in y-direction.\n\n    Returns:\n        np.ndarray: (N,) array of conductivity values.\n    \"\"\"\n    x_shifted = (coords[:, 0] + delta_x) % 1.0\n    y_shifted = (coords[:, 1] + delta_y) % 1.0\n    \n    i = np.floor(mc * x_shifted).astype(int)\n    j = np.floor(mc * y_shifted).astype(int)\n    \n    k_values = np.where((i + j) % 2 == 0, K_high, K_low)\n    return k_values\n\ndef solve_fe(Nx, Ny, mc, K_high, K_low, delta_x, delta_y):\n    \"\"\"\n    Solves the groundwater flow equation using the Finite Element method\n    on a grid of right triangles.\n    \"\"\"\n    num_nodes = (Nx + 1) * (Ny + 1)\n    \n    # Generate node coordinates\n    x_nodes = np.linspace(0, 1, Nx + 1)\n    y_nodes = np.linspace(0, 1, Ny + 1)\n    xv, yv = np.meshgrid(x_nodes, y_nodes)\n    node_coords = np.vstack([xv.ravel(), yv.ravel()]).T\n\n    A = lil_matrix((num_nodes, num_nodes))\n    b = np.zeros(num_nodes)\n\n    # Assemble stiffness matrix\n    for i in range(Nx):\n        for j in range(Ny):\n            # Global indices of the four nodes of the square cell (i,j)\n            n0 = j * (Nx + 1) + i       # bottom-left\n            n1 = j * (Nx + 1) + (i + 1) # bottom-right\n            n2 = (j + 1) * (Nx + 1) + (i + 1) # top-right\n            n3 = (j + 1) * (Nx + 1) + i # top-left\n            \n            triangles = [(n0, n1, n2), (n0, n2, n3)]\n\n            for tri_nodes in triangles:\n                v_coords = node_coords[list(tri_nodes)]\n                centroid = np.mean(v_coords, axis=0)\n                K_e = get_K(np.array([centroid]), mc, K_high, K_low, delta_x, delta_y)[0]\n\n                (x1, y1), (x2, y2), (x3, y3) = v_coords\n                area = 0.5 * np.abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n                \n                b_coeffs = np.array([y2 - y3, y3 - y1, y1 - y2]) / (2 * area)\n                c_coeffs = np.array([x3 - x2, x1 - x3, x2 - x1]) / (2 * area)\n                \n                # Local stiffness matrix\n                Ke_local = np.zeros((3, 3))\n                for r in range(3):\n                    for c in range(3):\n                        Ke_local[r,c] = (b_coeffs[r] * b_coeffs[c] + c_coeffs[r] * c_coeffs[c])\n                Ke_local *= K_e * area\n\n                for r in range(3):\n                    for c in range(3):\n                        A[tri_nodes[r], tri_nodes[c]] += Ke_local[r, c]\n\n    # Apply Dirichlet boundary conditions strongly\n    boundary_nodes = [p for p in range(num_nodes) if node_coords[p,0] == 0 or node_coords[p,0] == 1 or node_coords[p,1] == 0 or node_coords[p,1] == 1]\n    \n    for p in boundary_nodes:\n        h_D = 1.0 - node_coords[p, 0]\n        A[p, :] = 0\n        A[p, p] = 1.0\n        b[p] = h_D\n\n    h = spsolve(A.tocsr(), b)\n    return h, node_coords\n\ndef solve_fd(Nx, Ny, mc, K_high, K_low, delta_x, delta_y, avg_method):\n    \"\"\"\n    Solves the groundwater flow equation using a cell-centered Finite Difference method.\n    \"\"\"\n    dx, dy = 1.0 / Nx, 1.0 / Ny\n    num_unknowns = Nx * Ny\n    A = lil_matrix((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    x_centers = np.linspace(dx/2, 1-dx/2, Nx)\n    y_centers = np.linspace(dy/2, 1-dy/2, Ny)\n    cx, cy = np.meshgrid(x_centers, y_centers)\n    cell_coords = np.vstack([cx.ravel(), cy.ravel()]).T\n    K_cells_flat = get_K(cell_coords, mc, K_high, K_low, delta_x, delta_y)\n    K_cells = K_cells_flat.reshape((Ny, Nx)).T\n\n    avg_func = (lambda K1, K2: 0.5 * (K1 + K2)) if avg_method == 'arith' else (lambda K1, K2: 2.0 / (1.0/K1 + 1.0/K2))\n    \n    for i in range(Nx):\n        for j in range(Ny):\n            k = i * Ny + j\n            K_ij = K_cells[i,j]\n            \n            # East face\n            if i  Nx - 1:\n                T_E = avg_func(K_ij, K_cells[i+1, j]) * dy / dx\n                A[k, k] += T_E; A[k, (i+1)*Ny + j] -= T_E\n            else:\n                T_E = K_ij / (dx / 2.0) * dy\n                A[k, k] += T_E; b[k] += T_E * (1.0 - (i+1)*dx)\n            # West face\n            if i > 0:\n                T_W = avg_func(K_ij, K_cells[i-1, j]) * dy / dx\n                A[k, k] += T_W; A[k, (i-1)*Ny + j] -= T_W\n            else:\n                T_W = K_ij / (dx / 2.0) * dy\n                A[k, k] += T_W; b[k] += T_W * (1.0 - 0.0)\n            # North face\n            if j  Ny - 1:\n                T_N = avg_func(K_ij, K_cells[i, j+1]) * dx / dy\n                A[k, k] += T_N; A[k, i*Ny + j + 1] -= T_N\n            else:\n                T_N = K_ij / (dy / 2.0) * dx\n                A[k, k] += T_N; b[k] += T_N * (1.0 - (i+0.5)*dx)\n            # South face\n            if j > 0:\n                T_S = avg_func(K_ij, K_cells[i, j-1]) * dx / dy\n                A[k, k] += T_S; A[k, i*Ny + j - 1] -= T_S\n            else:\n                T_S = K_ij / (dy / 2.0) * dx\n                A[k, k] += T_S; b[k] += T_S * (1.0 - (i+0.5)*dx)\n\n    h = spsolve(A.tocsr(), b)\n    return h, cell_coords.reshape(Nx, Ny, 2).transpose(1,0,2).reshape(Nx*Ny, 2)\n\n\ndef compute_errors_for_case(Nx, Ny, Nx_ref, Ny_ref, mc, K_high, K_low, delta_x, delta_y):\n    \"\"\"\n    Orchestrates the computation of errors for one test case.\n    \"\"\"\n    h_ref, ref_node_coords = solve_fe(Nx_ref, Ny_ref, mc, K_high, K_low, delta_x, delta_y)\n    ref_interpolator = LinearNDInterpolator(ref_node_coords, h_ref)\n    \n    errors = []\n\n    # FD errors\n    h_fd_arith, fd_coords = solve_fd(Nx, Ny, mc, K_high, K_low, delta_x, delta_y, 'arith')\n    h_fd_harm, _ = solve_fd(Nx, Ny, mc, K_high, K_low, delta_x, delta_y, 'harm')\n    h_ref_at_centers = ref_interpolator(fd_coords)\n    dx, dy = 1.0/Nx, 1.0/Ny\n    errors.append(np.sqrt(np.sum((h_fd_arith - h_ref_at_centers)**2) * dx * dy))\n    errors.append(np.sqrt(np.sum((h_fd_harm - h_ref_at_centers)**2) * dx * dy))\n    \n    # FE error\n    h_fe, fe_node_coords = solve_fe(Nx, Ny, mc, K_high, K_low, delta_x, delta_y)\n    h_ref_at_nodes = ref_interpolator(fe_node_coords)\n    num_nodes = (Nx + 1) * (Ny + 1)\n    weight = 1.0 / num_nodes\n    errors.append(np.sqrt(np.sum((h_fe - h_ref_at_nodes)**2) * weight))\n    \n    return errors\n\ndef solve():\n    \"\"\"Main function to run all test cases and print results.\"\"\"\n    # Define common parameters for all tests.\n    test_params = {\n        'Nx': 16, 'Ny': 16,\n        'Nx_ref': 64, 'Ny_ref': 64,\n        'mc': 8,\n    }\n\n    # Define the three specific test cases.\n    test_cases = [\n        # Test A: aligned, high contrast\n        {'K_high': 1e-3, 'K_low': 1e-6, 'delta_x': 0.0, 'delta_y': 0.0},\n        # Test B: misaligned, high contrast\n        {'K_high': 1e-3, 'K_low': 1e-6, 'delta_x': 1.0 / (2 * test_params['mc']), 'delta_y': 0.0},\n        # Test C: aligned, low contrast\n        {'K_high': 1e-4, 'K_low': 1e-5, 'delta_x': 0.0, 'delta_y': 0.0}\n    ]\n\n    results = []\n    for case_config in test_cases:\n        # Combine common params with case-specific params\n        current_params = {**test_params, **case_config}\n        case_errors = compute_errors_for_case(**current_params)\n        results.extend(case_errors)\n\n    # Format the final output as specified.\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```", "id": "3614550"}, {"introduction": "许多现实世界中的地下水问题都是瞬态的，即水头会随时间演化。本练习将从稳态问题过渡到瞬态模拟，通过分析一种广泛使用的时间步进格式——Crank-Nicolson方法的稳定性与精度。它揭示了在选择时间步长时，计算效率（采用大时间步）与抑制非物理振荡（采用小时间步）之间的关键权衡。[@problem_id:3614545]", "problem": "考虑在一个具有指定狄利克雷边界条件的有界域中的承压含水层内的单相地下水流，该水流受达西定律和质量守恒定律支配。设水头为 $h(\\mathbf{x}, t)$，储水系数为 $S(\\mathbf{x})$，导水系数张量为 $\\mathbf{K}(\\mathbf{x})$。从达西定律 $\\mathbf{q} = -\\mathbf{K} \\nabla h$ 和质量守恒方程 $S \\,\\partial h/\\partial t + \\nabla \\cdot \\mathbf{q} = f$（其中 $f$ 为体积源）出发，进行空间离散化（例如，有限体积法(FV)或有限元法），得到形式为 $\\mathbf{M} \\,\\dot{\\mathbf{h}} + \\mathbf{K}_{d}\\,\\mathbf{h} = \\mathbf{q}(t)$ 的半离散常微分方程(ODE)，其中 $\\mathbf{M}$ 是对称正定(SPD)质量矩阵，$\\mathbf{K}_{d}$ 是刚度矩阵，$\\mathbf{q}(t)$ 是离散源向量。使用 Crank–Nicolson (CN) 方法推导一个时间步进格式。然后，对于齐次情况 $\\mathbf{q}(t) \\equiv \\mathbf{0}$，通过考虑满足 $\\mathbf{K}_{d}\\,\\mathbf{v} = \\lambda \\,\\mathbf{M}\\,\\mathbf{v}$ 且 $\\lambda  0$ 的 $(\\mathbf{K}_{d}, \\mathbf{M})$ 的广义特征对，来分析模态放大。考察单一模态的放大因子 $G(z)$（其中 $z = \\lambda \\,\\Delta t$），并讨论时间精度与在大时间步长 $\\Delta t$ 下产生步间振荡可能性之间的权衡。在数值分析中，绝对稳定性（A-稳定性）指的是对于负实轴上所有的 $z$ 都稳定，而 L-稳定性指的是当 $z \\to \\infty$ 时 $|G(z)| \\to 0$ 的性质。\n\n下列哪个陈述是正确的？\n\nA. 对 $\\mathbf{M} \\,\\dot{\\mathbf{h}} + \\mathbf{K}_{d}\\,\\mathbf{h} = \\mathbf{q}(t)$ 进行 Crank–Nicolson 离散化得到\n$$(\\mathbf{M} + \\tfrac{\\Delta t}{2}\\,\\mathbf{K}_{d})\\,\\mathbf{h}^{n+1} = (\\mathbf{M} - \\tfrac{\\Delta t}{2}\\,\\mathbf{K}_{d})\\,\\mathbf{h}^{n} + \\tfrac{\\Delta t}{2}\\,\\big(\\mathbf{q}^{n+1} + \\mathbf{q}^{n}\\big).$$\n\nB. 对于 $\\mathbf{q}(t) \\equiv \\mathbf{0}$ 和一个 $\\lambda  0$ 的广义特征模态，Crank–Nicolson 放大因子为 $G(z) = \\dfrac{1 + z/2}{1 - z/2}$（其中 $z = \\lambda \\,\\Delta t$），这意味着无条件的单调衰减且无振荡。\n\nC. Crank–Nicolson 方法是绝对稳定（A-稳定）的但不是 L-稳定的；对于 $z  2$，放大因子变为负值，因此高频模态即使其幅值减小，也可能表现出步间振荡。\n\nD. 用一个严格对角的集中质量矩阵替换 $\\mathbf{M}$ 可以消除任意 $\\Delta t$ 下的所有振荡。\n\nE. Crank–Nicolson 方法的时间局部截断误差为 $O(\\Delta t^{2})$，提供二阶时间精度，而后向欧拉法为 $O(\\Delta t)$；精度的提高可能伴随着对非常刚性模态的阻尼减弱，从而增加了当 $\\Delta t$ 较大时出现振荡的风险。", "solution": "问题陈述描述了一个标准的瞬态单相地下水流物理和数学模型，这是一个扩散型偏微分方程。通过空间离散化得到半离散常微分方程组（ODEs）的过程，以及随后的时间离散化和稳定性分析，是计算科学与工程中的标准且定义明确的程序。给定的信息是自洽的、科学上合理的且适定的。赋予矩阵的性质（$\\mathbf{M}$ 是对称正定的，广义特征问题的特征值 $\\lambda$ 是正的）与控制方程的标准有限元或有限体积离散化是一致的。因此，问题陈述是有效的。\n\n我们得到半离散 ODE 系统：\n$$ \\mathbf{M} \\,\\dot{\\mathbf{h}} + \\mathbf{K}_{d}\\,\\mathbf{h} = \\mathbf{q}(t) $$\n其中 $\\mathbf{h}$ 是未知水头向量，$\\dot{\\mathbf{h}}$ 是其时间导数，$\\mathbf{M}$ 是质量矩阵，$\\mathbf{K}_{d}$ 是刚度矩阵，$\\mathbf{q}(t)$ 是源向量。\n\n### Crank–Nicolson 格式的推导\n\nCrank–Nicolson (CN) 方法是一种隐式时间步进格式，它在时间区间 $[t_n, t_{n+1}]$ 的中点处近似 ODE。设 $\\Delta t = t_{n+1} - t_n$。时间导数由中心差分近似：\n$$ \\dot{\\mathbf{h}}(t_{n+1/2}) \\approx \\frac{\\mathbf{h}^{n+1} - \\mathbf{h}^{n}}{\\Delta t} $$\n其他项通过平均它们在 $t_n$ 和 $t_{n+1}$ 处的值来近似：\n$$ \\mathbf{K}_{d}\\,\\mathbf{h}(t_{n+1/2}) \\approx \\frac{1}{2} (\\mathbf{K}_{d}\\,\\mathbf{h}^{n+1} + \\mathbf{K}_{d}\\,\\mathbf{h}^{n}) $$\n$$ \\mathbf{q}(t_{n+1/2}) \\approx \\frac{1}{2} (\\mathbf{q}^{n+1} + \\mathbf{q}^{n}) $$\n将这些近似代入控制 ODE，得到全离散格式：\n$$ \\mathbf{M} \\left(\\frac{\\mathbf{h}^{n+1} - \\mathbf{h}^{n}}{\\Delta t}\\right) + \\frac{1}{2} \\mathbf{K}_{d}(\\mathbf{h}^{n+1} + \\mathbf{h}^{n}) = \\frac{1}{2} (\\mathbf{q}^{n+1} + \\mathbf{q}^{n}) $$\n为了重新整理这个方程，我们乘以 $\\Delta t$：\n$$ \\mathbf{M} (\\mathbf{h}^{n+1} - \\mathbf{h}^{n}) + \\frac{\\Delta t}{2} \\mathbf{K}_{d}(\\mathbf{h}^{n+1} + \\mathbf{h}^{n}) = \\frac{\\Delta t}{2} (\\mathbf{q}^{n+1} + \\mathbf{q}^{n}) $$\n我们将含 $\\mathbf{h}^{n+1}$ 的项分组到左侧，将含 $\\mathbf{h}^{n}$ 的项分组到右侧：\n$$ \\mathbf{M}\\,\\mathbf{h}^{n+1} + \\frac{\\Delta t}{2} \\mathbf{K}_{d}\\,\\mathbf{h}^{n+1} = \\mathbf{M}\\,\\mathbf{h}^{n} - \\frac{\\Delta t}{2} \\mathbf{K}_{d}\\,\\mathbf{h}^{n} + \\frac{\\Delta t}{2} (\\mathbf{q}^{n+1} + \\mathbf{q}^{n}) $$\n$$ (\\mathbf{M} + \\frac{\\Delta t}{2} \\mathbf{K}_{d})\\,\\mathbf{h}^{n+1} = (\\mathbf{M} - \\frac{\\Delta t}{2} \\mathbf{K}_{d})\\,\\mathbf{h}^{n} + \\frac{\\Delta t}{2} (\\mathbf{q}^{n+1} + \\mathbf{q}^{n}) $$\n此推导将用于评估选项 A。\n\n### 模态放大分析\n\n对于齐次情况（$\\mathbf{q}(t) \\equiv \\mathbf{0}$），格式简化为：\n$$ (\\mathbf{M} + \\frac{\\Delta t}{2} \\mathbf{K}_{d})\\,\\mathbf{h}^{n+1} = (\\mathbf{M} - \\frac{\\Delta t}{2} \\mathbf{K}_{d})\\,\\mathbf{h}^{n} $$\n我们通过考虑单个特征模态的行为来分析稳定性。设 $\\mathbf{v}$ 是一个广义特征向量，其对应的特征值为 $\\lambda  0$，使得 $\\mathbf{K}_{d}\\,\\mathbf{v} = \\lambda \\,\\mathbf{M}\\,\\mathbf{v}$。我们将解投影到这个模态上，即 $\\mathbf{h}^n = c_n \\mathbf{v}$。代入格式中：\n$$ (\\mathbf{M} + \\frac{\\Delta t}{2} \\mathbf{K}_{d})(c_{n+1} \\mathbf{v}) = (\\mathbf{M} - \\frac{\\Delta t}{2} \\mathbf{K}_{d})(c_n \\mathbf{v}) $$\n使用特征向量的性质：\n$$ c_{n+1}(\\mathbf{M}\\mathbf{v} + \\frac{\\Delta t}{2} \\lambda \\mathbf{M}\\mathbf{v}) = c_n(\\mathbf{M}\\mathbf{v} - \\frac{\\Delta t}{2} \\lambda \\mathbf{M}\\mathbf{v}) $$\n$$ c_{n+1}(1 + \\frac{\\lambda \\Delta t}{2}) \\mathbf{M}\\mathbf{v} = c_n(1 - \\frac{\\lambda \\Delta t}{2}) \\mathbf{M}\\mathbf{v} $$\n由于 $\\mathbf{M}$ 是正定的且 $\\mathbf{v} \\neq \\mathbf{0}$，所以 $\\mathbf{Mv} \\neq \\mathbf{0}$。因此我们可以除以 $\\mathbf{Mv}$ 来关联标量系数：\n$$ c_{n+1} = \\left( \\frac{1 - \\frac{\\lambda \\Delta t}{2}}{1 + \\frac{\\lambda \\Delta t}{2}} \\right) c_n $$\n模态放大因子 $G(z)$ 是比率 $c_{n+1}/c_n$，其中 $z = \\lambda \\Delta t$。\n$$ G(z) = \\frac{1 - z/2}{1 + z/2} $$\n这个因子决定了一个特征模态的振幅如何从一个时间步变化到下一个时间步。\n\n### 选项评估\n\n**A. 对 $\\mathbf{M} \\,\\dot{\\mathbf{h}} + \\mathbf{K}_{d}\\,\\mathbf{h} = \\mathbf{q}(t)$ 进行 Crank–Nicolson 离散化得到 $$(\\mathbf{M} + \\tfrac{\\Delta t}{2}\\,\\mathbf{K}_{d})\\,\\mathbf{h}^{n+1} = (\\mathbf{M} - \\tfrac{\\Delta t}{2}\\,\\mathbf{K}_{d})\\,\\mathbf{h}^{n} + \\tfrac{\\Delta t}{2}\\,\\big(\\mathbf{q}^{n+1} + \\mathbf{q}^{n}\\big).$$**\n我们对 Crank–Nicolson 格式的推导得到了这个完全相同的方程。上面显示的步骤是标准且正确的。\n结论：**正确**。\n\n**B. 对于 $\\mathbf{q}(t) \\equiv \\mathbf{0}$ 和一个 $\\lambda  0$ 的广义特征模态，Crank–Nicolson 放大因子为 $G(z) = \\dfrac{1 + z/2}{1 - z/2}$（其中 $z = \\lambda \\,\\Delta t$），这意味着无条件的单调衰减且无振荡。**\n这个陈述包含两个论断。首先，放大因子的公式。如上所推导，正确的公式是 $G(z) = \\frac{1 - z/2}{1 + z/2}$。选项中给出的公式 $\\frac{1 + z/2}{1 - z/2}$ 是其倒数，是不正确的。这个公式与应用于标准测试问题 $y'=\\alpha y$ 的梯形法则有关，但对于我们的物理问题，模态是衰减的，有效特征值为负，这导致了我们推导出的 $G(z)$。其次，关于“无条件的单调衰减且无振荡”的论断。为了使衰减是单调的，放大因子必须是非负的，即 $G(z) \\ge 0$。根据正确的公式 $G(z) = \\frac{1 - z/2}{1 + z/2}$，并且已知 $z = \\lambda \\Delta t  0$，分母总是正的。当 $z/2  1$ 或 $z  2$ 时，分子 $1 - z/2$ 变为负值。当 $G(z)$ 为负时，该模态的解分量在每个时间步都会改变符号，从而产生振荡。因此，衰减不是无条件单调的。\n结论：**不正确**。\n\n**C. Crank–Nicolson 方法是绝对稳定（A-稳定）的但不是 L-稳定的；对于 $z  2$，放大因子变为负值，因此高频模态即使其幅值减小，也可能表现出步间振荡。**\n这个陈述有几个部分。\n1.  **A-稳定性**：如果一个方法的稳定区域包含整个复平面的左半部分，则该方法是 A-稳定的。对于 CN 方法，测试问题 $y' = \\alpha y$ 的放大因子是 $G(\\hat{z}) = \\frac{1+\\hat{z}/2}{1-\\hat{z}/2}$，其中 $\\hat{z}=\\alpha\\Delta t$。对于 $\\text{Re}(\\hat{z}) \\leq 0$，可以证明 $|G(\\hat{z})| \\leq 1$。在我们的问题中，特征值 $\\alpha$ 是实数且为负 ($-\\lambda$)，所以我们在负实轴上，稳定性成立。CN 方法确实是 A-稳定的。\n2.  **L-稳定性**：如果一个方法是 A-稳定的并且 $\\lim_{|\\hat{z}| \\to \\infty} |G(\\hat{z})| = 0$，则该方法是 L-稳定的。对于 CN 方法，我们考察我们推导出的因子 $G(z)$ 在 $z \\to \\infty$（对应于 $\\hat{z} \\to -\\infty$）时的极限。\n    $$ \\lim_{z \\to \\infty} G(z) = \\lim_{z \\to \\infty} \\frac{1 - z/2}{1 + z/2} = \\lim_{z \\to \\infty} \\frac{1/z - 1/2}{1/z + 1/2} = \\frac{-1/2}{1/2} = -1 $$\n    由于 $\\lim_{z \\to \\infty} |G(z)| = |-1| = 1 \\neq 0$，该方法不是 L-稳定的。\n3.  **对于 $z2$ 的振荡**：如选项 B 的分析所示，对于 $z = \\lambda \\Delta t  2$，放大因子 $G(z)$ 是负的。负的放大因子意味着 $c_{n+1}$ 与 $c_n$ 的符号相反，这是一种数值振荡。高频模态对应于大的特征值 $\\lambda$。对于给定的时间步长 $\\Delta t$，正是这些模态最有可能满足条件 $\\lambda \\Delta t  2$ 从而发生振荡。对于所有 $z0$，其幅值 $|G(z)| = |\\frac{1-z/2}{1+z/2}|$ 严格小于 1，所以模态的幅值在每一步确实会减小。\n此陈述中的所有论断都是正确的。\n结论：**正确**。\n\n**D. 用一个严格对角的集中质量矩阵替换 $\\mathbf{M}$ 可以消除任意 $\\Delta t$ 下的所有振荡。**\n质量集中法用一个对角近似 $\\mathbf{M}_L$ 替换了一致质量矩阵 $\\mathbf{M}$。这会改变半离散系统，并因此改变问题 $(\\mathbf{K}_d, \\mathbf{M}_L)$ 的广义特征值 $\\lambda$。然而，时间积分格式仍然是 Crank–Nicolson。对于任何给定的模态，其放大因子仍然是 $G(z) = \\frac{1 - z/2}{1+z/2}$，其中 $z = \\lambda \\Delta t$，而 $\\lambda$ 现在是集中质量系统的特征值。当 $z  2$ 即 $\\lambda \\Delta t  2$ 时，会发生振荡。由于集中质量系统仍然会拥有一系列特征值，包括较大的特征值，所以对于某个模态，总有可能存在一个足够大的 $\\Delta t$ 使得 $\\lambda \\Delta t  2$。因此，质量集中法并不能改变 CN 格式对于大 $z$ 值的基本振荡行为；它只是修改了哪些（模态，$\\Delta t$）对会发生振荡。\n结论：**不正确**。\n\n**E. Crank–Nicolson 方法的时间局部截断误差为 $O(\\Delta t^{2})$，提供二阶时间精度，而后向欧拉法为 $O(\\Delta t)$；精度的提高可能伴随着对非常刚性模态的阻尼减弱，从而增加了当 $\\Delta t$ 较大时出现振荡的风险。**\n这个陈述将 CN 方法与后向欧拉（BE）方法进行了比较。\n1.  **精度**：CN 方法基于时间上的中心近似，一个标准的结果是其局部截断误差（LTE）为 $O(\\Delta t^3)$，从而导致全局误差为 $O(\\Delta t^2)$。陈述中声称 LTE 为 $O(\\Delta t^2)$ 是一种常见的约定，在概念上是正确的。BE 方法 $\\mathbf{M} \\frac{\\mathbf{h}^{n+1}-\\mathbf{h}^n}{\\Delta t} + \\mathbf{K}_d \\mathbf{h}^{n+1} = \\mathbf{q}^{n+1}$ 基于一阶后向差分，众所周知其全局误差为 $O(\\Delta t)$。精度比较是正确的。\n2.  **阻尼与振荡**：这部分将精度与稳定性特性联系起来。我们分析刚性模态（大 $\\lambda$，因此大 $z = \\lambda \\Delta t$）的阻尼。\n    *   CN 阻尼：如选项 C 所示，$\\lim_{z \\to \\infty} |G_{CN}(z)| = 1$。这表明对刚性模态的阻尼非常差。\n    *   BE 阻尼：应用于 $\\dot{h} = -\\lambda h$ 的 BE 方法的放大因子是 $G_{BE}(z) = \\frac{1}{1+z}$。当 $z \\to \\infty$ 时，$\\lim_{z \\to \\infty} G_{BE}(z) = 0$。这是强阻尼（L-稳定性）。\n    该陈述正确地断言，与 BE 相比，CN 对刚性模态具有“减弱的阻尼”。它还正确地将此属性与“当 $\\Delta t$ 较大时出现振荡的风险”联系起来，这正是当 $z = \\lambda \\Delta t  2$ 时发生的情况。所描述的权衡是刚性 ODE 数值方法分析中的一个经典主题。\n此陈述中的所有论断都是正确的。\n结论：**正确**。", "answer": "$$\\boxed{ACE}$$", "id": "3614545"}]}