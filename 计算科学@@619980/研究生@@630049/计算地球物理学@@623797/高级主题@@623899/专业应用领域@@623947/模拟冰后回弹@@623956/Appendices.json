{"hands_on_practices": [{"introduction": "我们的第一个实践练习将处理冰后期反弹的核心引擎：粘弹性松弛。通过使用简单的麦克斯韦模型计算地表位移，您将对地球地幔属性（粘度 $\\eta$ 和剪切模量 $\\mu$）如何控制均衡调整的时间尺度有一个切身的感受。这个练习 [@problem_id:3610916] 为理解更复杂的模型奠定了基础，将抽象的物理方程与可量化的地质过程联系起来。", "problem": "考虑冰后期反弹，其被建模为代表地球上地幔的 Maxwell 粘弹性半空间对时间 $t=0$ 时表面载荷瞬时变化的准静态垂直响应。假设地幔表现为剪切粘度为 $\\eta$、剪切模量为 $\\mu$ 的线性 Maxwell 固体，并忽略惯性项，因此平衡由力平衡和协调性决定。冰载荷的移除或施加可以理想化为表面压力的一个均匀阶跃变化 $p_{0}$，这导致由均衡平衡决定的有限平衡垂直位移 $w_{\\infty}$。对于平衡点附近的小扰动，线性粘弹性对应原理意味着与平衡态的标量失配会以特征 Maxwell 时间 $\\tau$ 指数弛豫，该时间仅取决于地幔流变性质。\n\n从 (i) 准静态线性动量平衡，(ii) 表面的线性应变协调性，以及 (iii) 关联偏应力和应变率的 Maxwell 本构定律出发，推导在 $t=0$ 时载荷发生阶跃变化后，控制表面垂直位移 $w(t)$ 的标量初值问题，并求出位移历史 $w(t)$ 作为 $t$、$\\eta$、$\\mu$ 和 $w_{\\infty}$ 的函数。然后，使用参数 $\\eta = 1 \\times 10^{21} \\,\\mathrm{Pa\\,s}$，$\\mu = 7 \\times 10^{10} \\,\\mathrm{Pa}$，$w_{\\infty} = 10 \\,\\mathrm{m}$ 和 $t = 3000 \\,\\mathrm{yr}$，数值计算位移 $w(t)$。时间使用国际单位制（$\\mathrm{s}$），并将最终数值答案四舍五入到四位有效数字。最终位移以米表示。", "solution": "目标是求出在 $t=0$ 时受到表面压力 $p_{0}$ 瞬时阶跃变化的粘弹性 Maxwell 半空间表面的垂直位移历史 $w(t)$。我们使用适用于准静态粘弹性变形的基本原理来建立该问题。\n\n首先，我们回顾在没有惯性情况下的准静态线性动量平衡方程，\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{g} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\rho$ 是密度，$\\boldsymbol{g}$ 是重力加速度。在自由表面上，施加的表面压力 $p_0$ 的阶跃变化会瞬时改变边界牵引力。加载后的表面垂直位移 $w(t)$ 随着地幔向均衡平衡位移 $w_{\\infty}$ 进行粘弹性弛豫而演化，在该平衡位移下，净浮力恢复力恰好平衡所施加的表面载荷变化。\n\n为模拟粘弹性响应，我们采用关于偏应力和应变的 Maxwell 本构定律。对于单一弛豫模式，以适用的一维标量形式，偏应力 $\\sigma$ 和应变 $\\epsilon$ 之间的 Maxwell 关系可以写作\n$$\n\\dot{\\epsilon} = \\frac{\\dot{\\sigma}}{\\mu} + \\frac{\\sigma}{\\eta},\n$$\n其中 $\\mu$ 是弹性剪切模量，$\\eta$ 是剪切粘度，上方的点表示对时间的导数。这等同于在施加变形下应力弛豫的 Maxwell 元件（弹簧和阻尼器串联）的标准形式。\n\n表面的垂直位移 $w(t)$ 源于地幔中弹性剪切变形和粘性流动的组合。对于在平衡点附近线性化的均匀轴对称响应，我们可以将瞬时位移与其平衡对应物之间的标量失配写为\n$$\n\\delta w(t) \\equiv w_{\\infty} - w(t).\n$$\n因为 $w_{\\infty}$ 是通过均衡恢复力平衡阶跃载荷 $p_0$ 的静态位移，所以 $\\delta w$ 与尚待弛豫的偏应力成正比。在线性弹簧表示中，我们写作\n$$\n\\sigma(t) = k \\,\\delta w(t),\n$$\n其中 $k$ 是一个有效标量刚度，概括了半空间中的几何和弹性耦合。表面的应变率与位移变化率成正比，即 $\\dot{\\epsilon} \\propto \\dot{w}$。在线性化的单模近似下，我们将几何因子吸收到 $k$ 中，从而 Maxwell 定律变为 $\\delta w(t)$ 的一个标量演化方程。\n\n对 $\\sigma(t) = k \\,\\delta w(t)$ 求导并代入 Maxwell 关系式，得到\n$$\n\\dot{\\epsilon} = \\frac{k \\,\\dot{\\delta w}}{\\mu} + \\frac{k \\,\\delta w}{\\eta}.\n$$\n在表面，协调性意味着 $\\dot{\\epsilon} \\propto -\\dot{\\delta w}$，因为增加 $w$ 会减小失配 $\\delta w$。通过线性重缩放将比例常数吸收到 $k$ 中，该演化过程简化为失配的规范一阶弛豫方程：\n$$\n\\dot{\\delta w}(t) = -\\frac{1}{\\tau} \\,\\delta w(t),\n$$\n其中特征 Maxwell 时间为\n$$\n\\tau = \\frac{\\eta}{\\mu}.\n$$\n这个结果也可以通过粘弹性对应原理严格推导出来，方法是将弹性格林函数中的弹性剪切模量替换为 Maxwell 弛豫模量，并取阶跃载荷极限；对于单个 Maxwell 模式，结果是时间常数为 $\\tau$ 的指数弛豫。\n\n求解初值问题 $\\dot{\\delta w} = -\\delta w/\\tau$，其初始条件为 $\\delta w(0) = w_{\\infty} - w(0)$，并认识到在 $t=0^{+}$ 时对阶跃载荷的瞬时弹性响应是有界的，而粘弹性弛豫将 $w$ 驱动至 $w_{\\infty}$，我们得到\n$$\n\\delta w(t) = \\delta w(0) \\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right).\n$$\n对于一个规范的阶跃加载（或卸载）实验，经过归一化使得 $t=0^{+}$ 时的失配等于 $w_{\\infty}$，位移历史呈现标准形式\n$$\nw(t) = w_{\\infty} \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right).\n$$\n\n现在我们根据给定参数计算 $w(t)$ 的数值。Maxwell 时间为\n$$\n\\tau = \\frac{\\eta}{\\mu} = \\frac{1 \\times 10^{21} \\,\\mathrm{Pa\\,s}}{7 \\times 10^{10} \\,\\mathrm{Pa}} = \\frac{1}{7} \\times 10^{11} \\,\\mathrm{s} = 1.42857142857 \\times 10^{10} \\,\\mathrm{s}.\n$$\n时间 $t$ 必须转换为秒。一个儒略年等于 $365.25 \\times 24 \\times 3600 = 31{,}557{,}600 \\,\\mathrm{s}$。因此，\n$$\nt = 3000 \\,\\mathrm{yr} = 3000 \\times 31{,}557{,}600 \\,\\mathrm{s} = 9.46728 \\times 10^{10} \\,\\mathrm{s}.\n$$\n计算无量纲比值\n$$\n\\frac{t}{\\tau} = \\frac{9.46728 \\times 10^{10}}{1.42857142857 \\times 10^{10}} \\approx 6.627096.\n$$\n那么\n$$\n\\exp\\!\\left(-\\frac{t}{\\tau}\\right) = \\exp(-6.627096) \\approx 0.001324,\n$$\n因此\n$$\nw(t) = 10 \\,\\mathrm{m} \\times \\left(1 - 0.001324\\right) \\approx 9.98676 \\,\\mathrm{m}.\n$$\n四舍五入到四位有效数字，位移为\n$$\nw(t) \\approx 9.987 \\,\\mathrm{m}.\n$$", "answer": "$$\\boxed{9.987}$$", "id": "3610916"}, {"introduction": "在理解了松弛的解析形式之后，我们现在转向如何在计算上模拟这些过程。这个练习 [@problem_id:3610979] 探讨了为我们的模拟选择时间步长 $\\Delta t$ 的实际挑战，即在计算效率和数值精度之间取得平衡。我们将推导出一个控制模拟松弛过程误差的条件，这是任何计算科学家都应具备的关键技能。", "problem": "一个粘弹性冰后期反弹模型可以理想化为两个独立的线性松弛模式的叠加，其松弛时间分别为 $\\tau_{1}$ 和 $\\tau_{2}$。在 $t=0$ 时刻瞬时卸载后，垂直抬升表示为 $U(t) = x_{1}(t) + x_{2}(t)$，其中每个模态的贡献满足常微分方程 (ODE) $x_{i}'(t) = -\\frac{1}{\\tau_{i}} x_{i}(t)$，对于 $i \\in \\{1,2\\}$。初始抬升 $U(0) = U_{0}$ 被分配到两个模态中，即 $x_{1}(0) = \\alpha_{1} U_{0}$ 和 $x_{2}(0) = \\alpha_{2} U_{0}$，其中 $\\alpha_{1} + \\alpha_{2} = 1$ 且 $\\alpha_{i} \\in (0,1)$。考虑使用应用于该 ODE 系统的一阶显式前向欧拉法，以均匀时间步长 $\\Delta t$ 对该系统进行时间推进。\n\n从线性松弛的精确解和局部截断误差 (LTE) 的定义出发，推导出一个关于 $\\Delta t$ 的条件，该条件保证在 $t=0$ 时抬升 $U$ 的每步 LTE 的上界为一个给定分数 $\\varepsilon$ 乘以 $U_{0}$，即 $|{\\text{LTE}}_{U}(0)| \\leq \\varepsilon U_{0}$。给定参数 $\\tau_{1} = 300\\ \\text{yr}$，$\\tau_{2} = 3000\\ \\text{yr}$，$\\alpha_{1} = 0.6$ 和 $\\alpha_{2} = 0.4$，使用此界限计算两种精度水平 $\\varepsilon_{1} = 10^{-3}$ 和 $\\varepsilon_{2} = 10^{-2}$ 下的最大容许时间步长 $\\Delta t$。\n\n将两个时间步长都以年为单位表示，并将答案四舍五入到三位有效数字。将您的最终答案以行矩阵的形式给出，其中包含按顺序对应的 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$ 的两个值。", "solution": "该问题要求推导一个关于时间步长 $\\Delta t$ 的条件，用于粘弹性松弛模型的一阶显式前向欧拉积分。该条件是，在第一个时间步长中，总抬升的局部截断误差 (LTE) 的上界为初始抬升的给定分数。\n\n总垂直抬升由两个独立模态的和给出，$U(t) = x_{1}(t) + x_{2}(t)$。每个模态遵循一个线性松弛微分方程：\n$$\nx_{i}'(t) = -\\frac{1}{\\tau_{i}} x_{i}(t) \\quad \\text{for } i \\in \\{1,2\\}\n$$\n初始条件为 $x_{1}(0) = \\alpha_{1} U_{0}$ 和 $x_{2}(0) = \\alpha_{2} U_{0}$。\n\n首先，我们确定每个模态的精确解。该 ODE 是一个一阶线性齐次方程，其解是一个指数衰减函数：\n$$\nx_{i, \\text{exact}}(t) = x_{i}(0) \\exp\\left(-\\frac{t}{\\tau_{i}}\\right) = \\alpha_{i} U_{0} \\exp\\left(-\\frac{t}{\\tau_{i}}\\right)\n$$\n在时间 $t$ 的精确总抬升是两个模态精确解的和：\n$$\nU_{\\text{exact}}(t) = x_{1, \\text{exact}}(t) + x_{2, \\text{exact}}(t) = \\alpha_{1} U_{0} \\exp\\left(-\\frac{t}{\\tau_{1}}\\right) + \\alpha_{2} U_{0} \\exp\\left(-\\frac{t}{\\tau_{2}}\\right)\n$$\n\n接下来，我们将一阶显式前向欧拉法应用于该系统。对于方程 $y' = f(y)$，大小为 $\\Delta t$ 的单步数值更新法则是 $y_{n+1} = y_{n} + \\Delta t f(y_{n})$。对于我们的系统，这变为：\n$$\nx_{i, n+1} = x_{i, n} + \\Delta t \\left(-\\frac{1}{\\tau_{i}} x_{i, n}\\right) = x_{i, n} \\left(1 - \\frac{\\Delta t}{\\tau_{i}}\\right)\n$$\n从精确初始条件 $x_i(0)$ 开始，经过一个时间步长后，总抬升的数值解 $U_{\\text{num}}(\\Delta t)$ 为：\n$$\nU_{\\text{num}}(\\Delta t) = x_{1, \\text{num}}(\\Delta t) + x_{2, \\text{num}}(\\Delta t) = x_{1}(0)\\left(1 - \\frac{\\Delta t}{\\tau_{1}}\\right) + x_{2}(0)\\left(1 - \\frac{\\Delta t}{\\tau_{2}}\\right)\n$$\n代入初始条件 $x_i(0) = \\alpha_i U_0$：\n$$\nU_{\\text{num}}(\\Delta t) = \\alpha_{1} U_{0}\\left(1 - \\frac{\\Delta t}{\\tau_{1}}\\right) + \\alpha_{2} U_{0}\\left(1 - \\frac{\\Delta t}{\\tau_{2}}\\right)\n$$\n\n局部截断误差 (LTE) 是假设在步长开始时解是精确的情况下，一步之后的精确解与一步之后的数值解之差。对于 $t=0$ 时的总抬升 $U$，LTE 为：\n$$\n\\text{LTE}_{U}(0) = U_{\\text{exact}}(\\Delta t) - U_{\\text{num}}(\\Delta t)\n$$\n代入精确解和数值解的表达式：\n$$\n\\text{LTE}_{U}(0) = \\left( \\alpha_{1} U_{0} \\exp\\left(-\\frac{\\Delta t}{\\tau_{1}}\\right) + \\alpha_{2} U_{0} \\exp\\left(-\\frac{\\Delta t}{\\tau_{2}}\\right) \\right) - \\left( \\alpha_{1} U_{0}\\left(1 - \\frac{\\Delta t}{\\tau_{1}}\\right) + \\alpha_{2} U_{0}\\left(1 - \\frac{\\Delta t}{\\tau_{2}}\\right) \\right)\n$$\n提出因子 $U_0$ 并按模态分组：\n$$\n\\text{LTE}_{U}(0) = U_{0} \\sum_{i=1}^{2} \\alpha_{i} \\left[ \\exp\\left(-\\frac{\\Delta t}{\\tau_{i}}\\right) - \\left(1 - \\frac{\\Delta t}{\\tau_{i}}\\right) \\right]\n$$\n为了推导关于 $\\Delta t$ 的显式条件，我们使用指数函数的泰勒级数展开，$\\exp(-z) = 1 - z + \\frac{z^2}{2!} - \\frac{z^3}{3!} + \\dots$。对于 $z = \\Delta t / \\tau_i$，方括号中的项变为：\n$$\n\\exp\\left(-\\frac{\\Delta t}{\\tau_{i}}\\right) - 1 + \\frac{\\Delta t}{\\tau_{i}} = \\left(1 - \\frac{\\Delta t}{\\tau_{i}} + \\frac{1}{2}\\left(\\frac{\\Delta t}{\\tau_{i}}\\right)^2 + O((\\Delta t)^3)\\right) - 1 + \\frac{\\Delta t}{\\tau_{i}} = \\frac{1}{2}\\left(\\frac{\\Delta t}{\\tau_{i}}\\right)^2 + O((\\Delta t)^3)\n$$\n对于小的 $\\Delta t$，我们可以使用主阶项来近似 LTE：\n$$\n\\text{LTE}_{U}(0) \\approx U_{0} \\sum_{i=1}^{2} \\alpha_{i} \\left[ \\frac{1}{2}\\left(\\frac{\\Delta t}{\\tau_{i}}\\right)^2 \\right] = \\frac{U_{0} (\\Delta t)^2}{2} \\left( \\frac{\\alpha_1}{\\tau_1^2} + \\frac{\\alpha_2}{\\tau_2^2} \\right)\n$$\n由于 $\\alpha_i > 0$，LTE 是正的，因此 $|\\text{LTE}_{U}(0)| = \\text{LTE}_{U}(0)$。问题要求 $|\\text{LTE}_{U}(0)| \\leq \\varepsilon U_{0}$。使用我们的近似：\n$$\n\\frac{U_{0} (\\Delta t)^2}{2} \\left( \\frac{\\alpha_1}{\\tau_1^2} + \\frac{\\alpha_2}{\\tau_2^2} \\right) \\leq \\varepsilon U_{0}\n$$\n假设 $U_0 \\neq 0$，我们可以消去 $U_0$ 并求解 $\\Delta t$：\n$$\n(\\Delta t)^2 \\leq \\frac{2\\varepsilon}{\\frac{\\alpha_1}{\\tau_1^2} + \\frac{\\alpha_2}{\\tau_2^2}}\n$$\n最大容许时间步长 $\\Delta t$ 在此不等式的上界处获得：\n$$\n\\Delta t = \\sqrt{\\frac{2\\varepsilon}{\\frac{\\alpha_1}{\\tau_1^2} + \\frac{\\alpha_2}{\\tau_2^2}}}\n$$\n现在我们代入给定的参数值：$\\tau_{1} = 300\\ \\text{yr}$，$\\tau_{2} = 3000\\ \\text{yr}$，$\\alpha_{1} = 0.6$ 和 $\\alpha_{2} = 0.4$。\n首先，我们计算分母项：\n$$\n\\frac{\\alpha_1}{\\tau_1^2} + \\frac{\\alpha_2}{\\tau_2^2} = \\frac{0.6}{300^2} + \\frac{0.4}{3000^2} = \\frac{0.6}{9 \\times 10^4} + \\frac{0.4}{9 \\times 10^6}\n$$\n为了合并这些项，我们使用一个公分母：\n$$\n= \\frac{0.6 \\times 100}{9 \\times 10^6} + \\frac{0.4}{9 \\times 10^6} = \\frac{60}{9 \\times 10^6} + \\frac{0.4}{9 \\times 10^6} = \\frac{60.4}{9 \\times 10^6} \\text{ yr}^{-2}\n$$\n现在我们可以为两个给定的精度水平计算 $\\Delta t$。\n\n对于 $\\varepsilon_{1} = 10^{-3}$：\n$$\n\\Delta t_1 = \\sqrt{\\frac{2 \\times 10^{-3}}{\\frac{60.4}{9 \\times 10^6}}} = \\sqrt{\\frac{18 \\times 10^3}{60.4}} = \\sqrt{298.0132...} \\approx 17.26306\\ \\text{yr}\n$$\n四舍五入到三位有效数字，$\\Delta t_1 \\approx 17.3\\ \\text{yr}$。\n\n对于 $\\varepsilon_{2} = 10^{-2}$：\n$$\n\\Delta t_2 = \\sqrt{\\frac{2 \\times 10^{-2}}{\\frac{60.4}{9 \\times 10^6}}} = \\sqrt{\\frac{18 \\times 10^4}{60.4}} = \\sqrt{2980.132...} \\approx 54.59059\\ \\text{yr}\n$$\n四舍五入到三位有效数字，$\\Delta t_2 \\approx 54.6\\ \\text{yr}$。\n\n对于 $\\varepsilon_1=10^{-3}$，最大容许时间步长约为 $17.3$ 年；对于 $\\varepsilon_2=10^{-2}$，最大容许时间步长约为 $54.6$ 年。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n17.3 & 54.6\n\\end{pmatrix}\n}\n$$", "id": "3610979"}, {"introduction": "我们最后的实践练习将松弛的物理原理与现实世界的复杂性（如随时间变化的冰荷载和球形几何）相结合。在这个编码挑战 [@problem_id:3611010] 中，您将通过积分冰川消融历史的影响，构建一个完整的前向模型来计算特定位置的地表抬升。这个练习模拟了地球物理学家在建模冰后期反弹时的实际工作流程，将理论知识转化为强大的预测工具。", "problem": "您的任务是计算一个球对称、线性、粘弹性地球表面单个测站上，由球谐系数表示的随时间变化的表面载荷所引起的瞬时径向抬升位移。目标是通过将一个按阶数制表的载荷格林函数与分段常数的冰川消融历史进行卷积，从而严格推导并实现对指定观测时间的抬升进行数值评估，然后使用实球谐函数将谐波系数投影到测站位置。所有角度必须以弧度处理。所有最终位移值必须以米表示。\n\n基本出发点。在线性时不变物理系统中，对源的因果响应是一个卷积。对于球谐函数的阶 $l$ 和级 $m$，径向位移系数 $u_{lm}(t)$ 对载荷系数 $\\hat{L}_{lm}(t)$ 变化的响应，是通过与阶-$l$ 载荷格林函数 $G_l(t)$ 的因果卷积来实现的：\n$$\nu_{lm}(t) \\;=\\; \\int_{0}^{t} G_l(t - \\tau)\\, d\\hat{L}_{lm}(\\tau).\n$$\n对于分段常数的载荷历史，测度 $d\\hat{L}_{lm}(\\tau)$ 简化为在跳跃时间点的一系列阶跃变化之和，因此该积分简化为有限项的阶跃响应评估之和。位于余纬 $\\theta$ 和经度 $\\phi$ 的测站的抬升量是通过使用实球谐函数进行球谐合成得到的。我们将注意力限制在 $m=0$ 的纬向谐波上，对于这类谐波，测站的位移贡献为\n$$\nu(t,\\theta) \\;=\\; u_{l0}(t)\\, Y_{l0}(\\theta),\n$$\n其中 $Y_{l0}(\\theta)$ 是阶为 $l$ 的实纬向球谐函数，定义为\n$$\nY_{l0}(\\theta) \\;=\\; \\sqrt{\\frac{2l+1}{4\\pi}}\\;P_l(\\cos\\theta),\n$$\n并且 $P_l(x)$ 是在 $x=\\cos\\theta$ 处求值的阶为 $l$ 的勒让德多项式。球谐函数是无量纲的；当 $u_{l0}(t)$ 以米为单位时，$u(t,\\theta)$ 的抬升量也以米为单位。\n\n数值评估要求。您必须通过将在 $T$ 之前发生的所有载荷跳跃的贡献相加来计算观测时间 $T$ 时的 $u_{l0}(T)$，每个贡献都由在每个跳跃后经过的时间处求值的制表阶跃响应 $G_l(\\Delta t)$ 加权，然后通过 $Y_{l0}(\\theta)$ 投影到测站上。对于在时间 $t_k$ 发生的大小为 $\\Delta \\hat{L}_{l0}(t_k)$ 的跳跃，其在 $T$ 时的贡献是 $\\Delta \\hat{L}_{l0}(t_k)\\,G_l(T - t_k)$。如果 $T - t_k$ 不是一个制表时间，您必须在最近的制表时间之间对 $G_l$ 进行线性插值。如果 $T - t_k$ 超出制表范围，您必须使用最后一个制表值。如果 $T - t_k = 0$，则使用第一个制表值。角度必须以弧度处理。最终输出必须是以米为单位的径向抬升，表示为浮点数。\n\n单位与约定。对于 $G_l(t)$ 的制表和插值，时间必须以千年（kyr）为单位处理，角度必须以弧度为单位，位移必须以米为单位。载荷系数变化 $\\Delta \\hat{L}_{l0}(t_k)$ 是无量纲的归一化值。制表的 $G_l(t)$ 的单位是米/单位归一化载荷变化。\n\n测试套件。为三个独立的测试用例实现计算，这些用例共同探测了典型、插值和边界行为。在每种情况下，您必须：\n- 使用指定的函数形式和参数，在从 $t=0$ 到 $t=T$ 的均匀时间网格上，以间距 $\\Delta t_G$ 构建制表的 $G_l(t)$。\n- 在观测时间 $T$ 累加跳跃贡献。\n- 乘以在指定测站余纬处求值的 $Y_{l0}(\\theta)$。\n\n您必须使用以下三个测试用例：\n\n1. 用例1（通用的两步历史，理想路径）：\n   - 阶 $l$：$2$，级 $m=0$。\n   - 测站余纬：$45$ 度（转换为弧度）。\n   - 观测时间：$T = 10.0$ kyr。\n   - 载荷跳跃：在 $t_0 = 0.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_0) = +1.0$；在 $t_1 = 5.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_1) = -1.0$。\n   - 制表阶跃响应 $G_2(t)$ 定义在 $[0,T]$ 上，间距为 $\\Delta t_G = 1.0$ kyr，由下式给出\n     $$\n     G_2(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.4\\,\\text{m},\\,1.0\\,\\text{m},\\,3.0\\,\\text{kyr})$。\n\n2. 用例2（带插值的粗略制表，多个负跳跃）：\n   - 阶 $l$：$2$，级 $m=0$。\n   - 测站余纬：$60$ 度（转换为弧度）。\n   - 观测时间：$T = 10.0$ kyr。\n   - 载荷跳跃：在 $t_0 = 2.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_0) = -0.8$；在 $t_1 = 4.0$ kyr 时，$\\Delta \\hat{L}_{20}(t_1) = -0.2$。\n   - 制表阶跃响应 $G_2(t)$ 定义在 $[0,T]$ 上，间距为 $\\Delta t_G = 2.0$ kyr，由下式给出\n     $$\n     G_2(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.5\\,\\text{m},\\,1.1\\,\\text{m},\\,2.5\\,\\text{kyr})$。\n\n3. 用例3（观测时间的边界情况，常数响应）：\n   - 阶 $l$：$1$，级 $m=0$。\n   - 测站余纬：$30$ 度（转换为弧度）。\n   - 观测时间：$T = 5.0$ kyr。\n   - 载荷跳跃：在 $t_0 = 5.0$ kyr 时，$\\Delta \\hat{L}_{10}(t_0) = +0.5$。\n   - 制表阶跃响应 $G_1(t)$ 定义在 $[0,T]$ 上，间距为 $\\Delta t_G = 1.0$ kyr，由下式给出\n     $$\n     G_1(t) \\;=\\; G_{\\infty} \\;-\\; \\left(G_{\\infty} - G_{0}\\right)\\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n     $$\n     参数为 $(G_{0},\\,G_{\\infty},\\,\\tau) = (0.7\\,\\text{m},\\,0.7\\,\\text{m},\\,1.0\\,\\text{kyr})$，这将得到对所有 $t$ 恒定的 $G_1(t)=0.7$ m。\n\n输出规范。您的程序应生成单行输出，其中包含三个用例的结果，格式为用方括号括起来的逗号分隔列表，单位为米，每个结果四舍五入到六位小数，按用例1、用例2、用例3的顺序排列。例如：\n\"[result_case1,result_case2,result_case3]\"。", "solution": "### 解决方案\n\n为了计算每个测试用例的径向抬升，我们遵循问题陈述中概述的三个主要步骤。我们编写一个 Python 脚本来实现这个过程，该脚本利用 `numpy` 进行高效的数值计算，并利用 `scipy.special.eval_legendre` 来评估勒让德多项式。\n\n**第 1 步：制表格林函数**\n\n对于每个用例，我们首先在时间区间 $[0, T]$ 上生成阶跃响应（格林函数）$G_l(t)$ 的一个制表。我们使用指定的间距 $\\Delta t_G$ 创建一个均匀的时间网格。在每个网格点上，我们使用给定的麦克斯韦模型松弛函数来计算 $G_l(t)$ 的值：\n$$ G_l(t) = G_{\\infty} - (G_{\\infty} - G_{0})\\exp(-t/\\tau) $$\n这个表存储了地球对单位阶跃载荷的响应如何随时间演变。\n\n**第 2 步：计算谐波位移系数 $u_{l0}(T)$**\n\n接下来，我们通过对所有过去载荷变化的贡献求和来计算在观测时间 $T$ 的总谐波位移 $u_{l0}(T)$。对于在时间 $t_k$ 发生的每个载荷跳跃 $\\Delta \\hat{L}_{l0}(t_k)$，其对 $T$ 时刻位移的贡献是 $\\Delta \\hat{L}_{l0}(t_k) \\times G_l(T - t_k)$。\n\n经过的时间 $\\Delta t = T - t_k$ 可能不直接落在我们制表的点上。根据问题的规则，我们使用线性插值来找到 $G_l(\\Delta t)$ 的值。`numpy.interp` 函数完美地处理了这些要求：\n-   它在制表点之间进行线性插值。\n-   如果 $\\Delta t$ 超出表的范围，它会使用最近的端点值（常数外插）。\n-   如果 $\\Delta t=0$，它会返回表的第一个值 $G_l(0)$。\n\n我们将所有载荷跳跃的贡献相加，得到最终的谐波系数 $u_{l0}(T)$。\n\n**第 3 步：投影到测站位置**\n\n最后，我们将谐波位移 $u_{l0}(T)$ 转换为测站 $(\\theta, \\phi)$ 处的物理抬升 $u(T, \\theta)$。对于纬向谐波（$m=0$），这通过乘以实球谐函数 $Y_{l0}(\\theta)$ 来完成：\n$$ u(T, \\theta) = u_{l0}(T) \\times Y_{l0}(\\theta) $$\n其中\n$$ Y_{l0}(\\theta) = \\sqrt{\\frac{2l+1}{4\\pi}} P_l(\\cos\\theta) $$\n我们使用 `scipy.special.eval_legendre` 计算勒让德多项式 $P_l(\\cos\\theta)$，其中测站余纬 $\\theta$ 必须首先转换为弧度。\n\n**实现与计算**\n\n以下是实现上述逻辑的 Python 代码。该代码依次处理三个测试用例，计算每个用例的最终抬升，并将结果格式化为所需的输出。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_legendre\n\ndef solve():\n    \"\"\"\n    Solves the post-glacial rebound problem for three test cases\n    and prints the results in the specified format.\n    \"\"\"\n\n    def calculate_uplift(l, theta_deg, T, load_jumps, G_params, dt_G):\n        \"\"\"\n        Computes the instantaneous radial uplift for a single test case.\n        \"\"\"\n        G0, G_inf, tau = G_params\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Step 1: Build the tabulated Green's function G_l(t).\n        num_points = int(round(T / dt_G)) + 1\n        t_table = np.linspace(0.0, T, num_points)\n        \n        def G_func(t):\n            if tau == 0:\n                # If relaxation time is zero, response is instantaneous.\n                # G(0) is G0, G(t>0) is G_inf.\n                # In Case 3, G0 == G_inf, so this is just a constant.\n                return np.where(t == 0, G0, G_inf)\n            return G_inf - (G_inf - G0) * np.exp(-t / tau)\n        \n        G_table = G_func(t_table)\n        \n        # Step 2: Calculate the harmonic displacement coefficient u_l0(T).\n        u_l0_T = 0.0\n        for t_k, delta_L in load_jumps:\n            elapsed_time = T - t_k\n            G_val = np.interp(elapsed_time, t_table, G_table)\n            u_l0_T += delta_L * G_val\n            \n        # Step 3: Project to station location to get final uplift u(T, theta).\n        x = np.cos(theta_rad)\n        P_l_x = eval_legendre(l, x)\n        Y_l0 = np.sqrt((2 * l + 1) / (4 * np.pi)) * P_l_x\n        \n        uplift = u_l0_T * Y_l0\n        \n        return uplift\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'l': 2, 'theta_deg': 45.0, 'T': 10.0,\n            'load_jumps': [(0.0, 1.0), (5.0, -1.0)],\n            'G_params': (0.4, 1.0, 3.0), 'dt_G': 1.0\n        },\n        {\n            'l': 2, 'theta_deg': 60.0, 'T': 10.0,\n            'load_jumps': [(2.0, -0.8), (4.0, -0.2)],\n            'G_params': (0.5, 1.1, 2.5), 'dt_G': 2.0\n        },\n        {\n            'l': 1, 'theta_deg': 30.0, 'T': 5.0,\n            'load_jumps': [(5.0, 0.5)],\n            'G_params': (0.7, 0.7, 1.0), 'dt_G': 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_uplift(**case)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```\n\n执行此代码，我们得到每个用例的径向抬升值，四舍五入到六位小数后，按顺序排列在一个列表中。", "answer": "$$\\boxed{[0.014495,0.084357,0.148096]}$$", "id": "3611010"}]}