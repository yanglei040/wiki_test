{"hands_on_practices": [{"introduction": "对地震波传播的深刻理解始于其控制物理定律。第一个实践将带您回到这些基本原理。通过从第一性原理出发，为一个简单的双层介质推导弹性波方程 [@problem_id:3614112]，您将巩固对材料属性（如 $\\rho$、$\\lambda$ 和 $\\mu$）如何控制波传播行为，以及界面处的物理连续性如何转化为数学边界条件的理解。", "problem": "考虑一个二维、平面应变、各向同性、线性弹性的非均匀介质，该介质由两个均匀半空间组成，两个半空间由位于 $y=0$ 的水平界面隔开。区域 $\\Omega_{1}$ 是上半空间 $\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$，其常数质量密度为 $\\rho_{1}$，第一拉梅参数为 $\\lambda_{1}$，剪切模量为 $\\mu_{1}$。区域 $\\Omega_{2}$ 是下半空间 $\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$，其常数质量密度为 $\\rho_{2}$，第一拉梅参数为 $\\lambda_{2}$，剪切模量为 $\\mu_{2}$。令 $\\mathbf{u}(x,y,t)$ 表示位移场。假设没有体力。介质参数如下：\n- $\\rho_{1} = 2200$ kg/m$^{3}$，$\\lambda_{1} = 5.0\\times 10^{9}$ 帕，$\\mu_{1} = 3.0\\times 10^{9}$ 帕，\n- $\\rho_{2} = 2700$ kg/m$^{3}$，$\\lambda_{2} = 3.0\\times 10^{10}$ 帕，$\\mu_{2} = 3.0\\times 10^{10}$ 帕。\n\n任务：\n1) 从线性动量平衡、线性化运动学和各向同性胡克定律出发，推导每个区域 $\\Omega_{i}$ ($i\\in\\{1,2\\}$) 中 $\\mathbf{u}(x,y,t)$ 的强形式控制偏微分方程 (PDE)。方程应以空间微分算子表示，并明确其对各区域常数参数 $\\rho_{i}$、$\\lambda_{i}$ 和 $\\mu_{i}$ 的依赖关系。\n2) 阐述界面 $y=0$ 处物理上正确的传播条件，使用关于位移和柯西牵引矢量的跳跃条件来表达。\n3) 仅使用给定的 $\\rho_{i}$、$\\lambda_{i}$ 和 $\\mu_{i}$，计算每个区域 $\\Omega_{i}$ 的局部压缩波波速 $v_{p,i}$ 和剪切波波速 $v_{s,i}$。将速度以米/秒为单位表示，并将答案四舍五入至四位有效数字。\n\n答案规格：以行矩阵的形式提供最终数值答案，顺序为 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$。速度以米/秒为单位。四舍五入至四位有效数字。最终答案的矩阵内只能包含数字，不带单位。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **介质描述**：二维、平面应变、各向同性、线性弹性、非均匀。\n- **几何结构**：由位于 $y=0$ 的水平界面隔开的两个均匀半空间。\n- **区域 $\\Omega_{1}$**：上半空间，$\\{(x,y)\\in\\mathbb{R}^{2}: y>0\\}$。\n  - 质量密度：$\\rho_{1} = 2200$ kg/m$^{3}$\n  - 第一拉梅参数：$\\lambda_{1} = 5.0\\times 10^{9}$ 帕\n  - 剪切模量：$\\mu_{1} = 3.0\\times 10^{9}$ 帕\n- **区域 $\\Omega_{2}$**：下半空间，$\\{(x,y)\\in\\mathbb{R}^{2}: y<0\\}$。\n  - 质量密度：$\\rho_{2} = 2700$ kg/m$^{3}$\n  - 第一拉梅参数：$\\lambda_{2} = 3.0\\times 10^{10}$ 帕\n  - 剪切模量：$\\mu_{2} = 3.0\\times 10^{10}$ 帕\n- **场变量**：位移场 $\\mathbf{u}(x,y,t)$。\n- **假设**：无体力。\n- **任务**：\n  1. 推导每个区域 $\\Omega_{i}$ 中 $\\mathbf{u}(x,y,t)$ 的强形式控制偏微分方程。\n  2. 阐述界面 $y=0$ 处的传播条件。\n  3. 计算每个区域的压缩波波速 $v_{p,i}$ 和剪切波波速 $v_{s,i}$。\n- **答案规格**：一个行矩阵 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2})$，速度单位为米/秒，四舍五入至四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行有效性评估。\n- **科学依据**：该问题是弹性动力学和地震学中的一个经典设置，基于连续介质力学的基本原理：线性动量平衡、线性化运动学和各向同性材料的胡克定律。所提供的材料参数（$\\rho_{i}$、$\\lambda_{i}$、$\\mu_{i}$）对于地壳岩石是物理上现实的。该问题在科学上是合理的。\n- **适定性**：这三个任务定义明确，并能导出唯一且有意义的解。波动方程的推导、界面条件的阐述以及波速的计算都是该领域的标准程序。\n- **客观性**：该问题使用来自连续介质力学和波动物理学的精确、无歧义和标准术语进行陈述。\n- **完整性与一致性**：该问题提供了完成所有指定任务所需的所有材料参数（$\\rho_{i}$、$\\lambda_{i}$、$\\mu_{i}$）。所提供的信息中没有矛盾之处。\n\n### 第 3 步：结论与行动\n该问题是**有效的**，因为它在科学上合理、适定、客观且自洽。现在开始求解过程。\n\n---\n\n### 解答\n通过完成三个指定的任务来解决该问题。\n\n#### 1. 控制偏微分方程的推导\n\n弹性波动方程的推导从连续介质力学的三个基本原理开始。我们先对一个具有参数 $\\rho$、$\\lambda$ 和 $\\mu$ 的通用均匀区域进行推导，然后将其特化到区域 $\\Omega_{1}$ 和 $\\Omega_{2}$。\n\n1.  **线性动量平衡（柯西第一运动定律）**：在没有体力的情况下，线性动量平衡表示为：\n    $$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n    其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\rho$ 是质量密度，$\\mathbf{u}$ 是位移矢量，$t$ 是时间。\n\n2.  **线性化运动学（应变-位移关系）**：线性化（或小）应变张量 $\\boldsymbol{\\varepsilon}$ 与位移场 $\\mathbf{u}$ 的关系如下：\n    $$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] $$\n\n3.  **本构定律（各向同性胡克定律）**：对于线性、各向同性的弹性材料，应力张量 $\\boldsymbol{\\sigma}$ 与应变张量 $\\boldsymbol{\\varepsilon}$ 的关系如下：\n    $$ \\boldsymbol{\\sigma} = \\lambda (\\text{tr}(\\boldsymbol{\\varepsilon})) \\mathbf{I} + 2\\mu\\boldsymbol{\\varepsilon} $$\n    其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\mathbf{I}$ 是二阶单位张量。应变张量的迹等于位移的散度，即 $\\text{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$。\n\n我们现在组合这三个方程。首先，将应变-位移关系代入本构定律：\n$$ \\boldsymbol{\\sigma} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + 2\\mu \\left( \\frac{1}{2} \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right] \\right) = \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf.u})^T \\right] $$\n接下来，将这个应力表达式代入动量平衡方程：\n$$ \\nabla \\cdot \\left( \\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I} + \\mu \\left[ \\nabla\\mathbf{u} + (\\nabla\\mathbf.u})^T \\right] \\right) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n将散度算子应用于括号内的项。由于 $\\lambda$ 和 $\\mu$ 在每个区域内是常数：\n$$ \\nabla \\cdot (\\lambda (\\nabla \\cdot \\mathbf{u}) \\mathbf{I}) = \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) $$\n$$ \\nabla \\cdot (\\mu[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]) = \\mu \\nabla \\cdot (\\nabla\\mathbf{u}) + \\mu \\nabla \\cdot ((\\nabla\\mathbf{u})^T) $$\n使用矢量微积分恒等式 $\\nabla \\cdot (\\nabla\\mathbf{u}) = \\nabla^2\\mathbf{u}$（矢量拉普拉斯算子）和 $\\nabla \\cdot ((\\nabla\\mathbf{u})^T) = \\nabla(\\nabla \\cdot \\mathbf{u})$，方程变为：\n$$ \\lambda \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2\\mathbf{u} + \\mu \\nabla(\\nabla \\cdot \\mathbf.u}) = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n合并各项，我们得到强形式的控制偏微分方程，即 Navier 运动方程：\n$$ (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n该方程在每个均匀区域内成立。对于两个区域 $\\Omega_{i}$ ($i \\in \\{1, 2\\}$)，偏微分方程为：\n- 在区域 $\\Omega_{1}$ ($y>0$) 中：\n$$ (\\lambda_{1} + \\mu_{1}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{1} \\nabla^2 \\mathbf{u} = \\rho_{1} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n- 在区域 $\\Omega_{2}$ ($y<0$) 中：\n$$ (\\lambda_{2} + \\mu_{2}) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu_{2} \\nabla^2 \\mathbf{u} = \\rho_{2} \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n\n#### 2. 界面 $y=0$ 处的传播条件\n\n两个半空间假设在界面 $y=0$ 处是完美结合的。这意味着存在两个物理条件：\n1.  **位移的连续性**：位移矢量必须跨界面连续，以确保不出现间隙或重叠。这意味着从区域 $\\Omega_{1}$ 取极限计算的位移矢量 $\\mathbf{u}$ 必须等于从区域 $\\Omega_{2}$ 取极限计算的位移矢量。在数学上，这表示为：\n    $$ \\mathbf{u}(x, y=0^+, t) = \\mathbf{u}(x, y=0^-, t) \\quad \\text{for all } x, t $$\n    使用跨界面的跳跃符号 $[\\![ \\psi ]\\!] = \\psi_{1} - \\psi_{2}$，该条件为在 $y=0$ 处 $[\\![ \\mathbf{u} ]\\!] = \\mathbf{0}$。\n\n2.  **牵引力的连续性**：根据牛顿第三定律，区域 $\\Omega_1$ 施加于区域 $\\Omega_2$ 的力必须与区域 $\\Omega_2$ 施加于区域 $\\Omega_1$ 的力大小相等、方向相反。这导致柯西牵引矢量 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ 跨界面是连续的。指向界面 $y=0$ 的单位法向量（从 $\\Omega_2$ 指向 $\\Omega_1$）是 $\\mathbf{n} = (0, 1)^T$。牵引力连续性条件是：\n    $$ \\boldsymbol{\\sigma}_{1}(x, y=0^+, t) \\mathbf{n} = \\boldsymbol{\\sigma}_{2}(x, y=0^-, t) \\mathbf{n} \\quad \\text{for all } x, t $$\n    这里，$\\boldsymbol{\\sigma}_{1}$ 和 $\\boldsymbol{\\sigma}_{2}$ 是各自区域中的应力张量。用跳跃符号表示，即在 $y=0$ 处 $[\\![ \\boldsymbol{\\sigma}\\mathbf{n} ]\\!] = \\mathbf{0}$。牵引矢量的分量为 $t_x = \\sigma_{xy}$ 和 $t_y = \\sigma_{yy}$，因此该条件意味着剪切应力 $\\sigma_{xy}$ 和法向应力 $\\sigma_{yy}$ 均跨界面连续。\n\n#### 3. 波速的计算\n\n在各向同性、线性弹性介质中，压缩波波速 ($v_p$) 和剪切波波速 ($v_s$) 由以下公式给出：\n$$ v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} $$\n$$ v_s = \\sqrt{\\frac{\\mu}{\\rho}} $$\n我们使用给定的参数将这些公式应用于每个区域。\n\n- **区域 $\\Omega_{1}$**：\n  - $\\rho_1 = 2200$ kg/m$^3$\n  - $\\lambda_1 = 5.0 \\times 10^9$ 帕\n  - $\\mu_1 = 3.0 \\times 10^9$ 帕\n  \n  $$ v_{p,1} = \\sqrt{\\frac{\\lambda_1 + 2\\mu_1}{\\rho_1}} = \\sqrt{\\frac{5.0 \\times 10^9 + 2(3.0 \\times 10^9)}{2200}} = \\sqrt{\\frac{11.0 \\times 10^9}{2200}} = \\sqrt{5 \\times 10^6} \\approx 2236.0679.. \\text{ m/s} $$\n  四舍五入至四位有效数字，$v_{p,1} = 2236$ m/s。\n\n  $$ v_{s,1} = \\sqrt{\\frac{\\mu_1}{\\rho_1}} = \\sqrt{\\frac{3.0 \\times 10^9}{2200}} = \\sqrt{\\frac{15}{11} \\times 10^6} \\approx 1167.748... \\text{ m/s} $$\n  四舍五入至四位有效数字，$v_{s,1} = 1168$ m/s。\n\n- **区域 $\\Omega_{2}$**：\n  - $\\rho_2 = 2700$ kg/m$^3$\n  - $\\lambda_2 = 3.0 \\times 10^{10}$ 帕\n  - $\\mu_2 = 3.0 \\times 10^{10}$ 帕\n\n  $$ v_{p,2} = \\sqrt{\\frac{\\lambda_2 + 2\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10} + 2(3.0 \\times 10^{10})}{2700}} = \\sqrt{\\frac{9.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{3} \\times 10^8} \\approx 5773.5026.. \\text{ m/s} $$\n  四舍五入至四位有效数字，$v_{p,2} = 5774$ m/s。\n  \n  $$ v_{s,2} = \\sqrt{\\frac{\\mu_2}{\\rho_2}} = \\sqrt{\\frac{3.0 \\times 10^{10}}{2700}} = \\sqrt{\\frac{1}{9} \\times 10^8} = \\frac{1}{3} \\times 10^4 = 3333.333... \\text{ m/s} $$\n  四舍五入至四位有效数字，$v_{s,2} = 3333$ m/s。\n\n计算出的波速为 $(v_{p,1}, v_{s,1}, v_{p,2}, v_{s,2}) = (2236, 1168, 5774, 3333)$ m/s。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2236  1168  5774  3333\n\\end{pmatrix}\n}\n$$", "id": "3614112"}, {"introduction": "虽然完整的波动方程是全面的，但高频近似（射线理论）在某些情况下能提供宝贵的解析洞察。在此练习中 [@problem_id:3614152]，您将应用费马原理（Fermat's principle）——波动物理学的基石——来确定地震射线在具有连续速度梯度介质中的路径。这个实践展示了变分法和微扰方法的威力，能够求解射线弯曲并预测走时，让您直观地了解非均匀性如何塑造波的路径。", "problem": "考虑在非均匀介质中的二维、各向同性、高频声波传播，其由程函方程控制，波速为 $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$，其中 $v_{0} > 0$ 是常数，$\\alpha$ 是一个小的常数，在所考虑的传播距离上满足 $|\\alpha X| \\ll 1$。设波源位于 $\\left(0,0\\right)$，接收器位于 $\\left(X,Y\\right)$，其中 $X>0$ 且 $Y \\in \\mathbb{R}$。在高频极限下，根据费马原理，射线遵循使走时平稳的路径。沿路径 $\\gamma$ 的走时为 $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$，其中 $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ 是慢度，$\\mathrm{d}\\ell$ 是欧几里得线元。\n\n在 $\\alpha$ 的一阶近似下，使用费马原理和变分法来：\n- 推导一阶射线弯曲，表示为沿路径相对于 $x$ 轴的局部射线角 $\\theta(x)$，假设射线在从 $0$ 到 $X$ 的范围内 $x$ 是单调的。\n- 推导从 $\\left(0,0\\right)$ 到 $\\left(X,Y\\right)$ 的一阶单程走时 $T$。\n\n你可以使用以下事实：(i) 程函方程为 $\\left|\\nabla T\\right| = s$，(ii) 射线方向与 $T$ 的梯度相切，以及 (iii) 费马原理意味着对于固定端点之间的路径变化，$T$ 是平稳的。角度以弧度表示，走时以秒表示。请将你的最终答案以一对封闭形式的解析表达式 $\\left(\\theta(x), T\\right)$ 给出。不需要数值，且仅保留到 $\\alpha$ 的一阶项。", "solution": "用户提供了一个问题陈述，在尝试求解之前必须对其进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **波速：** 介质的波速由 $v(x,y) = v_{0} \\left(1 + \\alpha x\\right)$ 给出。\n-   **常数：** $v_{0} > 0$ 是一个常数。$\\alpha$ 是一个小常数。\n-   **近似条件：** 对于相关的传播距离 $X$，有 $|\\alpha X| \\ll 1$。\n-   **波源和接收器：** 波源在 $(0,0)$，接收器在 $(X,Y)$，其中 $X > 0$ 且 $Y \\in \\mathbb{R}$。\n-   **控制原理：** 高频波传播由程函方程和费马原理控制。\n-   **走时泛函：** $T[\\gamma] = \\int_{\\gamma} s(\\mathbf{r}) \\,\\mathrm{d}\\ell$，其中 $s(\\mathbf{r}) = 1/v(\\mathbf{r})$ 是慢度，$\\mathrm{d}\\ell$ 是欧几里得线元。\n-   **约束：** 射线路径在 $x$ 从 $x=0$ 到 $x=X$ 的范围内是单调的。\n-   **目标：**\n    1.  推导一阶射线弯曲，表示为相对于 $x$ 轴的局部射线角 $\\theta(x)$。\n    2.  推导从 $(0,0)$ 到 $(X,Y)$ 的一阶单程走时 $T$。\n-   **输出格式：** 以一对封闭形式的解析表达式 $(\\theta(x), T)$ 给出最终答案，项保留到 $\\alpha$ 的一阶。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题基于非均匀介质中波传播的基本原理，即程函方程和费马最短时间原理。速度模型 $v(x,y) = v_0(1+\\alpha x)$ 代表了一个简单的、物理上现实的线性梯度，这是地球物理学和声学中用于分析研究的标准模型。所有概念在物理学中都已得到充分确立。\n-   **适定性：** 问题提供了两个固定端点和一个明确定义的速度场。它要求求解路径和走时，在给定的近似条件下，可以使用变分法唯一确定。要求在一个小参数 $\\alpha$ 上做到一阶，这是一个标准的、适定的微扰问题。\n-   **目标：** 问题使用精确的数学语言和定义进行陈述。没有主观或含糊的术语。\n-   **完整性：** 问题是自洽的。它提供了速度函数、边界条件（波源和接收器位置）、要应用的物理原理（费马原理）以及所需的近似阶数。明确说明了 $x$ 的单调性假设，这使得将路径参数化为 $y(x)$ 是合理的。\n-   **一致性和可行性：** 所给条件是相互一致的。条件 $|\\alpha X| \\ll 1$ 确保了一阶泰勒展开在感兴趣的域上是有效的。该设置在物理上是合理的。\n\n**步骤 3：结论与行动**\n\n该问题被判定为**有效**。这是理论地震学和波传播中的一个标准问题，它科学合理、适定且完整。将推导求解过程。\n\n### 推导\n\n通过将变分法应用于费马原理来找到解。从 $(0,0)$ 到 $(X,Y)$ 的路径 $y(x)$ 的走时 $T$ 由以下泛函给出：\n$$T[y] = \\int \\frac{\\mathrm{d}\\ell}{v(x,y)} = \\int_0^X \\frac{\\sqrt{1 + (y'(x))^2}}{v_0(1+\\alpha x)} \\mathrm{d}x$$\n被积函数是拉格朗日量 $L(x, y', y) = s(x) \\sqrt{1 + (y')^2}$，其中 $s(x) = \\frac{1}{v_0(1+\\alpha x)}$ 是慢度。由于 $L$ 不显式依赖于 $y$，欧拉-拉格朗日方程 $\\frac{\\partial L}{\\partial y} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$ 简化为 $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\frac{\\partial L}{\\partial y'} = 0$。这意味着 $\\frac{\\partial L}{\\partial y'}$ 沿射线路径是一个常数。这个常数是射线参数，记为 $p$。\n\n$$\\frac{\\partial L}{\\partial y'} = \\frac{1}{v_0(1+\\alpha x)} \\frac{y'}{\\sqrt{1+(y')^2}} = p$$\n局部射线角 $\\theta(x)$ 与斜率的关系为 $y'(x) = \\tan(\\theta(x))$。代入此关系，我们得到：\n$$\\frac{\\tan(\\theta(x))}{v(x) \\sqrt{1+\\tan^2(\\theta(x))}} = \\frac{\\sin(\\theta(x))}{v(x)} = p$$\n这是垂直变化介质（此处为在 $x$ 方向上变化）的斯涅尔定律的微分形式。设 $\\theta_0 = \\theta(0)$ 为波源处的初始出射角。在 $x=0$ 处，$v(0)=v_0$，因此 $p = \\frac{\\sin(\\theta_0)}{v_0}$。因此，沿路径的角度满足：\n$$\\sin(\\theta(x)) = v(x) p = v_0(1+\\alpha x) \\frac{\\sin(\\theta_0)}{v_0} = \\sin(\\theta_0)(1+\\alpha x)$$\n\n为了找到路径和角度，我们使用微扰方法。设路径为 $y(x) = y^{(0)}(x) + y^{(1)}(x) + \\dots$，其中 $y^{(0)}$ 对应于 $\\alpha=0$ 的情况（一条直线）。\n未扰动路径为 $y^{(0)}(x) = \\frac{Y}{X}x$。此路径的角度是恒定的：$\\theta^{(0)} = \\arctan(Y/X)$。\n设真实的出射角为 $\\theta_0 = \\theta^{(0)} + \\delta\\theta_0$，其中 $\\delta\\theta_0$ 是 $\\alpha$ 的量级。\n在 $\\alpha$ 的一阶近似下，我们有：\n$$y'(x) = \\tan(\\theta(x)) = \\frac{\\sin(\\theta(x))}{\\sqrt{1-\\sin^2(\\theta(x))}} \\approx \\frac{\\sin(\\theta_0)(1+\\alpha x)}{\\sqrt{1-\\sin^2(\\theta_0)(1+2\\alpha x)}}$$\n展开到 $\\alpha$ 的一阶：\n$\\sin(\\theta_0) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)})$。\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0 \\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0 \\cos(\\theta^{(0)})$。\n分母是 $\\cos(\\theta(x))$。在一阶近似下，$\\cos(\\theta(x)) \\approx \\cos(\\theta^{(0)})$。\n因此，$y'(x) \\approx \\frac{\\sin(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\cos(\\theta^{(0)})}{\\cos(\\theta^{(0)})} = \\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0$。\n通过对 $y'(x)$ 积分来找到路径：\n$$Y = \\int_0^X y'(x) \\mathrm{d}x \\approx \\int_0^X \\left(\\tan(\\theta^{(0)})(1+\\alpha x) + \\delta\\theta_0\\right) \\mathrm{d}x$$\n$$Y \\approx \\left[ x\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha x^2 \\tan(\\theta^{(0)}) + x\\delta\\theta_0 \\right]_0^X = X\\tan(\\theta^{(0)}) + \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0$$\n由于 $Y = X\\tan(\\theta^{(0)})$，我们有：\n$$0 \\approx \\frac{1}{2}\\alpha X^2 \\tan(\\theta^{(0)}) + X\\delta\\theta_0 \\implies \\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$$\n现在我们求局部角 $\\theta(x)$。设 $\\theta(x) = \\theta^{(0)} + \\delta\\theta(x)$。\n$\\sin(\\theta(x)) \\approx \\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)})$。\n根据斯涅尔定律，$\\sin(\\theta(x)) = \\sin(\\theta_0)(1+\\alpha x)$。在一阶近似下：\n$\\sin(\\theta_0)(1+\\alpha x) \\approx (\\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)}))(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) + \\delta\\theta_0\\cos(\\theta^{(0)})$。\n代入 $\\delta\\theta_0 = -\\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})$：\n$\\sin(\\theta_0)(1+\\alpha x) \\approx \\sin(\\theta^{(0)}) + \\alpha x \\sin(\\theta^{(0)}) - \\frac{1}{2}\\alpha X \\tan(\\theta^{(0)})\\cos(\\theta^{(0)}) = \\sin(\\theta^{(0)})\\left(1 + \\alpha x - \\frac{1}{2}\\alpha X\\right)$。\n令 $\\sin(\\theta(x))$ 的两个表达式相等：\n$\\sin(\\theta^{(0)}) + \\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\sin(\\theta^{(0)})\\left(1 + \\alpha\\left(x - \\frac{X}{2}\\right)\\right)$。\n$\\delta\\theta(x)\\cos(\\theta^{(0)}) \\approx \\alpha \\sin(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right) \\implies \\delta\\theta(x) = \\alpha \\tan(\\theta^{(0)})\\left(x - \\frac{X}{2}\\right)$。\n代入 $\\tan(\\theta^{(0)}) = Y/X$，一阶射线角为：\n$$\\theta(x) = \\theta^{(0)} + \\delta\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X}\\left(x - \\frac{X}{2}\\right)$$\n\n接下来，我们推导走时 $T$。根据费马原理，一阶走时微扰可以通过沿未扰动路径 $\\gamma_0$ 积分慢度微扰来计算。\n$T = T_0 + \\delta T$。\n未扰动走时为 $T_0 = \\frac{\\text{路径 } \\gamma_0 \\text{ 的长度}}{v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}$。\n慢度为 $s(x) = \\frac{1}{v_0(1+\\alpha x)} \\approx \\frac{1}{v_0}(1-\\alpha x)$。\n慢度微扰为 $\\delta s(x) = s(x) - s_0 = \\frac{1}{v_0}(1-\\alpha x) - \\frac{1}{v_0} = -\\frac{\\alpha x}{v_0}$。\n走时微扰为 $\\delta T = \\int_{\\gamma_0} \\delta s(x) \\mathrm{d}\\ell$。\n未扰动路径 $\\gamma_0$ 是一条直线。我们可以用 $x$ 对其进行参数化：$\\mathrm{d}\\ell = \\sqrt{1+(y^{(0)\\prime})^2} \\mathrm{d}x = \\sqrt{1 + (Y/X)^2} \\mathrm{d}x = \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x$。\n$$\\delta T = \\int_0^X \\left(-\\frac{\\alpha x}{v_0}\\right) \\frac{\\sqrt{X^2+Y^2}}{X} \\mathrm{d}x = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\int_0^X x \\mathrm{d}x$$\n$$\\delta T = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\left[\\frac{x^2}{2}\\right]_0^X = -\\frac{\\alpha \\sqrt{X^2+Y^2}}{v_0 X} \\frac{X^2}{2} = -\\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0}$$\n总走时为 $T = T_0 + \\delta T$：\n$$T = \\frac{\\sqrt{X^2+Y^2}}{v_0} - \\frac{\\alpha X \\sqrt{X^2+Y^2}}{2v_0} = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$$\n\n局部射线角 $\\theta(x)$ 和走时 $T$ 在 $\\alpha$ 一阶近似下的最终表达式为：\n$\\theta(x) = \\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right)$\n$T = \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)$\n这些构成了所要求的一对结果。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\arctan\\left(\\frac{Y}{X}\\right) + \\alpha \\frac{Y}{X} \\left(x - \\frac{X}{2}\\right) & \\frac{\\sqrt{X^2+Y^2}}{v_0}\\left(1 - \\frac{\\alpha X}{2}\\right)\n\\end{pmatrix}\n}\n$$", "id": "3614152"}, {"introduction": "最后的这个实践通过一个计算实验，将波动理论与其在地震解释中的实际应用联系起来。您将研究一个微妙但关键的现象：无法直接分辨的薄地质层如何系统性地影响振幅随偏移距（AVO）分析。通过实现一个基于物理的反射模型并对合成数据进行反演 [@problem_id:3614101]，您将量化由这种亚波长非均匀性引入的偏差，从而获得一个清晰的范例，展示数值模拟如何作为实验室来检验地球物理方法背后的假设。", "problem": "您需要研究在一维分层声学介质中，亚波长非均质性如何对振幅随偏移距变化（AVO）分析产生偏差。这需要通过比较薄层模型的反演结果与均匀分层等效介质模型的反演结果来实现。研究应在计算地球物理学和非均质介质中地震波传播的框架内进行，其尺度为层厚远小于主导地震波长。目标是使用物理上一致的平面波公式计算合成的反射振幅随角度变化的道集，假设一个双项 AVO 模型来反演等效波阻抗差，并量化由一个薄的亚波长层相对于相应的均匀双层基准模型所引入的偏差。\n\n使用以下基本原理：\n- 在密度为 $\\rho$、压缩波速为 $v$ 的流体中，压力 $p(\\mathbf{x},t)$ 的线性声波方程为 $ \\nabla^2 p - \\frac{1}{v^2}\\frac{\\partial^2 p}{\\partial t^2} = 0$。\n- 对于角频率为 $\\omega$ 的时谐平面波，压力场允许形如 $p(\\mathbf{x},t) = \\Re\\{ \\tilde{p}(\\mathbf{x}) e^{-i \\omega t} \\}$ 的解，其中 $\\tilde{p}(\\mathbf{x})$ 满足亥姆霍兹型关系。对于一个水平慢度为 $p$（单位为 $\\mathrm{s/m}$）的平面波，在速度为 $v$ 的介质层中，垂直波数为 $k_z = \\omega \\sqrt{v^{-2} - p^2} = \\frac{\\omega}{v} q$，其中 $q = \\sqrt{1 - (p v)^2}$。\n- 在流体层之间的每个界面上，边界条件强制要求压力和法向质点速度连续。对于斜入射到流体中的平面波，其特征法向声阻抗为 $Z_n = \\frac{\\rho v}{q}$。\n- 对于一个厚度为 $h$、特征法向阻抗为 $Z_n$ 的流体层，其底部由一个负载阻抗 $Z_L$ 终止，其顶部的输入阻抗由标准传输线递归公式给出：$Z_{\\mathrm{in}} = Z_n \\, \\frac{Z_L + i Z_n \\tan \\phi}{Z_n + i Z_L \\tan \\phi}$，其中 $\\phi = \\omega \\frac{h}{v} q$ 是相位厚度。在上方流体半空间（特征法向阻抗 $Z_{\\mathrm{top}}$）与下方负载 $Z_{\\mathrm{in}}$ 之间的界面处，净平面波反射系数 $R$ 为 $R = \\frac{Z_{\\mathrm{in}} - Z_{\\mathrm{top}}}{Z_{\\mathrm{in}} + Z_{\\mathrm{top}}}$。\n- 水平慢度由顶部介质的斯涅尔定律定义：$p = \\frac{\\sin \\theta_0}{v_0}$，其中 $\\theta_0$ 是顶部半空间的入射角，$v_0$ 是其压缩波速。\n\n您必须：\n1. 模拟一个三层系统的平面波反射振幅随角度变化的关系 $R(\\theta_0)$，该系统由一个顶部半空间（层索引为 $0$）、一个有限厚度的薄层（层索引为 $1$）和一个底部半空间（层索引为 $2$）组成。采用窄带近似：使用中心频率 $f_0$（角频率为 $\\omega_0 = 2 \\pi f_0$），并取在 $\\omega_0$ 处的复平面波反射系数的实部作为可观测振幅。使用斜入射传输线递归公式，将薄层与底部半空间合并，视为从顶部半空间看来的一个负载。假设所有层都是声学流体。\n2. 在一组入射角 $\\{\\theta_k\\}$（角度以度为单位）上构建 AVO 道集。对于每个 $\\theta_k$，计算 $p_k = \\sin(\\theta_k \\cdot \\pi/180)/v_0$，然后如上计算 $R(\\theta_k)$，并将观测振幅定义为 $\\Re\\{R(\\theta_k;\\omega_0)\\}$。\n3. 对所有角度的道集数据进行最小二乘法反演，以拟合双项 AVO 截距-梯度模型 $R(\\theta) \\approx A + B \\sin^2 \\theta$，从而求解截距 $A$ 和梯度 $B$。将反演得到的“等效波阻抗差”定义为 $\\Delta Z_{\\mathrm{eff}}/ \\bar{Z} \\equiv 2 A$（无量纲）。\n4. 对于“分层等效介质”基准模型，移除薄层，仅考虑两个半空间（顶部和底部）。使用相同的斜入射流体-流体反射框架计算半空间 $0$ 和半空间 $2$ 之间的角度相关反射系数 $R_{\\mathrm{base}}(\\theta)$（对于两个半空间，这简化为没有有限厚度相位的波阻抗失配）。通过最小二乘法拟合相同的双项模型 $R_{\\mathrm{base}}(\\theta) \\approx A_{\\mathrm{base}} + B_{\\mathrm{base}} \\sin^2 \\theta$，并将基准等效波阻抗差定义为 $\\Delta Z_{\\mathrm{base}}/\\bar{Z} \\equiv 2 A_{\\mathrm{base}}$。\n5. 将非均质性引起的 AVO 偏差量化为绝对差值 $E \\equiv \\left| \\left(\\Delta Z_{\\mathrm{eff}}/\\bar{Z}\\right) - \\left(\\Delta Z_{\\mathrm{base}}/\\bar{Z}\\right) \\right|$（无量纲）。对于每个测试用例，这是一个标量值。\n\n物理单位和数值约定：\n- 压缩波速 $v_j$ 必须以 $\\mathrm{m/s}$ 为单位。\n- 密度 $\\rho_j$ 必须以 $\\mathrm{kg/m^3}$ 为单位。\n- 厚度 $h_j$ 必须以 $\\mathrm{m}$ 为单位。\n- 频率 $f_0$ 必须以 $\\mathrm{Hz}$ 为单位。\n- 入射角 $\\theta$ 必须以度为单位；三角函数计算必须在弧度下进行。\n- 最终误差 $E$ 是无量纲的；以十进制数报告。\n\n科学真实性假设：\n- 使用的入射角不应超过模型中的最小临界角，以确保对所有层都有 $p v_j  1$（无倏逝波）。\n- 在选定的中心频率 $f_0$ 下，薄层厚度是亚波长的，以代表亚波长非均质性。\n\n您必须实现和评估的测试套件：\n- 情况 1（正常路径，软薄夹层）：$v_0 = 2200\\,\\mathrm{m/s}$，$\\rho_0 = 2200\\,\\mathrm{kg/m^3}$；薄层：$v_1 = 1800\\,\\mathrm{m/s}$，$\\rho_1 = 2000\\,\\mathrm{kg/m^3}$，$h_1 = 5\\,\\mathrm{m}$；底部半空间：$v_2 = 2600\\,\\mathrm{m/s}$，$\\rho_2 = 2300\\,\\mathrm{kg/m^3}$；中心频率 $f_0 = 30\\,\\mathrm{Hz}$；入射角 $\\theta \\in \\{0^\\circ, 10^\\circ, 20^\\circ, 30^\\circ\\}$。\n- 情况 2（边界，无非均质性）：与情况 1 相同，但薄层厚度 $h_1 = 0\\,\\mathrm{m}$。\n- 情况 3（硬薄夹层，更强对比度）：$v_0 = 2500\\,\\mathrm{m/s}$，$\\rho_0 = 2200\\,\\mathrm{kg/m^3}$；薄层：$v_1 = 3000\\,\\mathrm{m/s}$，$\\rho_1 = 2600\\,\\mathrm{kg/m^3}$，$h_1 = 8\\,\\mathrm{m}$；底部半空间：$v_2 = 2400\\,\\mathrm{m/s}$，$\\rho_2 = 2100\\,\\mathrm{kg/m^3}$；中心频率 $f_0 = 35\\,\\mathrm{Hz}$；入射角 $\\theta \\in \\{0^\\circ, 5^\\circ, 15^\\circ, 25^\\circ, 30^\\circ\\}$。\n- 情况 4（频率效应，更长波长）：与情况 1 相同，但中心频率 $f_0 = 10\\,\\mathrm{Hz}$ 且薄层厚度 $h_1 = 5\\,\\mathrm{m}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试套件的四个偏差值 $E$，格式为方括号内以逗号分隔的列表，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_k$ 都是一个十进制数。不得打印任何其他文本。", "solution": "此问题的目标是量化在振幅随偏移距变化（AVO）分析中由亚波长非均质性引入的偏差。为实现此目标，我们将一个包含薄中间层的一维三层声学模型的 AVO 反演结果，与一个省略了该薄层的简化双层基准模型的结果进行比较。该分析在分层流体介质中平面波传播的框架内进行。\n\n物理模型基于时谐声波方程。对于角频率为 $\\omega$、水平慢度为 $p$ 的平面波，在分层介质中的传播可以方便地使用与传输线的类比来描述。关键量是随角度变化的各层（$j$）的特征法向声阻抗，定义为：\n$$\nZ_{n,j} = \\frac{\\rho_j v_j}{q_j}\n$$\n其中 $\\rho_j$ 是流体密度，$v_j$ 是压缩波速，$q_j$ 是慢度矢量的垂直分量，由 $\\omega/v_j$ 归一化：\n$$\nq_j = \\sqrt{1 - (p v_j)^2}\n$$\n根据斯涅尔定律，水平慢度 $p$ 在所有层中是恒定的，并由顶部介质（层 $0$）的入射角 $\\theta_0$ 决定：\n$$\np = \\frac{\\sin\\theta_0}{v_0}\n$$\n不产生倏逝波的条件要求对所有层 $j$ 都有 $p v_j  1$。\n\n第一步是计算三层系统的平面波反射系数。该系统由一个顶部半空间（层 $0$）、一个有限厚度为 $h_1$ 的薄层（层 $1$）和一个底部半空间（层 $2$）组成。层 $1$ 和层 $2$ 的组合可以被视为一个单一系统，其属性是从层 $0$ 和层 $1$ 之间的界面来看的。底部半空间充当薄层的负载阻抗，$Z_L = Z_{n,2}$。然后，使用传输线递归公式可以找到层 $1$ 顶部的输入阻抗 $Z_{\\mathrm{in}}$：\n$$\nZ_{\\mathrm{in}} = Z_{n,1} \\frac{Z_L + i Z_{n,1} \\tan \\phi_1}{Z_{n,1} + i Z_L \\tan \\phi_1}\n$$\n其中 $i = \\sqrt{-1}$ 是虚数单位，$\\phi_1$ 是该层随角度变化的相位厚度：\n$$\n\\phi_1 = \\omega \\frac{h_1}{v_{1}} q_1 = k_{z,1} h_1\n$$\n此处，$k_{z,1}$ 是层 $1$ 中的垂直波数。从层 $0$ 入射到此复合系统上的波的总反射系数 $R(\\theta_0)$ 由顶部半空间与下方结构的输入阻抗之间的阻抗差给出：\n$$\nR(\\theta_0) = \\frac{Z_{\\mathrm{in}} - Z_{n,0}}{Z_{\\mathrm{in}} + Z_{n,0}}\n$$\n由于相移项 $\\tan\\phi_1$ 的存在，$Z_{\\mathrm{in}}$ 通常是一个复数，因此反射系数 $R(\\theta_0)$ 也是复数。问题规定，可观测的地震振幅是该系数在中心角频率 $\\omega_0 = 2 \\pi f_0$ 处计算的实部：$r_{\\mathrm{eff}}(\\theta_0) = \\Re\\{R(\\theta_0; \\omega_0)\\}$。为离散角度 $\\{\\theta_k\\}$ 计算的这组振幅构成了薄层模型的合成 AVO 道集。\n\n第二步是构建基准模型。该模型仅由顶部半空间（层 $0$）和底部半空间（层 $2$）组成，相当于将薄层厚度设为零，$h_1=0$。在这种情况下，相位厚度 $\\phi_1 = 0$，$\\tan\\phi_1 = 0$，输入阻抗公式简化为 $Z_{\\mathrm{in}} = Z_L = Z_{n,2}$。因此，基准反射系数 $R_{\\mathrm{base}}(\\theta_0)$ 是一个实值函数（对于非倏逝波），由两个半空间之间的直接阻抗差给出：\n$$\nR_{\\mathrm{base}}(\\theta_0) = \\frac{Z_{n,2} - Z_{n,0}}{Z_{n,2} + Z_{n,0}}\n$$\n对同一组角度 $\\{\\theta_k\\}$ 重复此计算，以生成基准 AVO 道集 $\\{r_{\\mathrm{base}}(\\theta_k)\\}$。\n\n第三步是分别对两个合成道集进行 AVO 反演。我们使用线性化的双项 AVO 近似公式 $R(\\theta) \\approx A + B \\sin^2\\theta$。对于每个道集——等效（薄层）道集和基准道集——我们都使用线性最小二乘法求解截距 $A$ 和梯度 $B$。这涉及到求解矩阵系统 $\\mathbf{M}\\mathbf{x} = \\mathbf{r}$，其中 $\\mathbf{r}$ 是计算出的反射振幅向量，$\\mathbf{x} = [A, B]^T$ 是未知系数向量，$\\mathbf{M}$ 是设计矩阵，其每一行是 $[1, \\sin^2\\theta_k]$，对应道集中的每个角度。最小二乘解为 $\\mathbf{x} = (\\mathbf{M}^T\\mathbf{M})^{-1}\\mathbf{M}^T\\mathbf{r}$。此过程得出薄层模型的截距 $A_{\\mathrm{eff}}$ 和基准模型的截距 $A_{\\mathrm{base}}$。\n\n最后，量化 AVO 偏差。AVO 截距 $A$ 与法向入射反射系数相关，该系数约等于相对波阻抗差，即 $A \\approx \\frac{1}{2} \\frac{\\Delta Z}{\\bar{Z}}$。问题将反演得到的“等效波阻抗差”定义为 $2A$。由薄层引入的偏差 $E$ 则是从薄层模型推导出的等效波阻抗差与从基准双层模型推导出的等效波阻抗差之间的绝对差值：\n$$\nE = \\left| (2 A_{\\mathrm{eff}}) - (2 A_{\\mathrm{base}}) \\right| = 2 |A_{\\mathrm{eff}} - A_{\\mathrm{base}}|\n$$\n\n整个算法通过迭代每个测试用例来执行。对于每个用例，我们定义物理属性和入射角集合。然后，我们计算两个 AVO 道集，执行两次独立的最小二乘反演以找到 $A_{\\mathrm{eff}}$ 和 $A_{\\mathrm{base}}$，并计算最终偏差 $E$。这提供了一个定量度量，说明亚波长层的存在如何改变 AVO 截距这一地震解释中的关键参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the AVO bias introduced by a sub-wavelength thin layer for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, soft thin interbed)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 5.0,\n            \"f0\": 30.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n        # Case 2 (boundary, no heterogeneity)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 0.0,\n            \"f0\": 30.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n        # Case 3 (hard thin interbed, stronger contrast)\n        {\n            \"v\": (2500.0, 3000.0, 2400.0), \"rho\": (2200.0, 2600.0, 2100.0), \"h1\": 8.0,\n            \"f0\": 35.0, \"angles\": [0.0, 5.0, 15.0, 25.0, 30.0]\n        },\n        # Case 4 (frequency effect, longer wavelength)\n        {\n            \"v\": (2200.0, 1800.0, 2600.0), \"rho\": (2200.0, 2000.0, 2300.0), \"h1\": 5.0,\n            \"f0\": 10.0, \"angles\": [0.0, 10.0, 20.0, 30.0]\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        v = case[\"v\"]\n        rho = case[\"rho\"]\n        h1 = case[\"h1\"]\n        f0 = case[\"f0\"]\n        angles_deg = np.array(case[\"angles\"])\n\n        # Calculate AVO intercept for the thin-bed model\n        A_eff = calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed=True)\n\n        # Calculate AVO intercept for the baseline (two-layer) model\n        A_base = calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed=False)\n\n        # Quantify the bias\n        bias = 2 * abs(A_eff - A_base)\n        results.append(bias)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_avo_intercept(v, rho, h1, f0, angles_deg, is_thin_bed):\n    \"\"\"\n    Computes the AVO intercept 'A' for a given model configuration.\n\n    Args:\n        v (tuple): P-wave speeds (v0, v1, v2) in m/s.\n        rho (tuple): Densities (rho0, rho1, rho2) in kg/m^3.\n        h1 (float): Thickness of the thin layer in m.\n        f0 (float): Central frequency in Hz.\n        angles_deg (np.ndarray): Array of incidence angles in degrees.\n        is_thin_bed (bool): If True, use the 3-layer model. If False, use the 2-layer baseline.\n\n    Returns:\n        float: The AVO intercept parameter 'A'.\n    \"\"\"\n    v0, v1, v2 = v\n    rho0, rho1, rho2 = rho\n    omega0 = 2.0 * np.pi * f0\n    angles_rad = np.deg2rad(angles_deg)\n\n    r_gather = []\n    for theta0_rad in angles_rad:\n        # Horizontal slowness p\n        p = np.sin(theta0_rad) / v0\n\n        # Calculate q and normal impedances for all layers\n        # Using np.sqrt with complex numbers to handle potential (though avoided) evanescent cases gracefully\n        q0 = np.sqrt(1 - (p * v0)**2 + 0j)\n        q1 = np.sqrt(1 - (p * v1)**2 + 0j)\n        q2 = np.sqrt(1 - (p * v2)**2 + 0j)\n\n        Z_n0 = (rho0 * v0) / q0\n        Z_n1 = (rho1 * v1) / q1\n        Z_n2 = (rho2 * v2) / q2\n\n        if is_thin_bed:\n            if h1 == 0.0:\n                # If thickness is zero, it's equivalent to the baseline case\n                Z_in = Z_n2\n            else:\n                # Phase thickness for layer 1\n                phi1 = omega0 * (h1 / v1) * q1\n                # Input impedance at the top of layer 1 using transmission line formula\n                numerator = Z_n2 + 1j * Z_n1 * np.tan(phi1)\n                denominator = Z_n1 + 1j * Z_n2 * np.tan(phi1)\n                Z_in = Z_n1 * (numerator / denominator)\n        else: # Baseline model\n            Z_in = Z_n2\n\n        # Reflection coefficient at the top interface\n        R = (Z_in - Z_n0) / (Z_in + Z_n0)\n        \n        # Observable amplitude is the real part\n        r_gather.append(np.real(R))\n\n    # AVO inversion by least squares\n    # R(theta) = A + B * sin^2(theta)\n    r_vector = np.array(r_gather)\n    \n    # Design matrix M for the linear system M * x = r_vector\n    # where x = [A, B]^T\n    M = np.vstack([np.ones(len(angles_rad)), np.sin(angles_rad)**2]).T\n\n    # Solve for [A, B] using least squares\n    A, _ = np.linalg.lstsq(M, r_vector, rcond=None)[0]\n\n    return A\n\nsolve()\n```", "id": "3614101"}]}