{"hands_on_practices": [{"introduction": "表面波分析的核心是描述波数 $k$ 与角频率 $\\omega$ 之间关系的频散曲线。本练习提供一个假想但形式上合理的频散关系，旨在强化两个基本概念：相速度 $c(\\omega)$ 和群速度 $U(\\omega)$。通过从给定的 $k(\\omega)$ 关系中推导并计算这些速度，你将能加深对单个频率波峰传播（相速度）与整个波包能量传播（群速度）之间区别的理解，并学会如何判断频散是正常的还是异常的。", "problem": "一个垂直分层的弹性半空间支持瑞利型表面波，其波数-频率色散关系在选定频带内可由关系式 $k(\\omega)=a\\,\\omega+b\\,\\omega^{3}$ 很好地近似。这里，$k$ 是波数，$\\omega$ 是角频率，$a$ 和 $b$ 是正常数，分别包含了该结构的有效长波长和短波长贡献。你可以假设线性、平稳性，并且表面波在远场可由平面波相位 $k(\\omega)\\,x-\\omega\\,t$ 很好地描述。使用以下参数值：$a=5.0\\times 10^{-4}\\ \\text{s/m}$ 和 $b=3.0\\times 10^{-9}\\ \\text{s}^{3}/\\text{m}$。考虑测量频带内的两个角频率：$\\omega_{1}=20\\ \\text{rad/s}$ 和 $\\omega_{2}=80\\ \\text{rad/s}$。\n\n从连接相位传播和能量传输与色散关系的基本定义出发，推导相速度 $c(\\omega)$ 和群速度 $U(\\omega)$ 关于 $a$、$b$ 和 $\\omega$ 的表达式。然后，计算在 $\\omega_{1}$ 和 $\\omega_{2}$ 处的 $c(\\omega)$ 和 $U(\\omega)$。最后，根据 $c(\\omega)$ 在此频带上的单调行为，判断色散在表面波意义上是正常色散还是反常色散。\n\n将最终的相速度和群速度以米每秒表示，并将每个计算出的速度四舍五入到四位有效数字。你最终报告的答案必须是一个单行矩阵，包含四个条目，顺序为 $c(\\omega_{1})$、$U(\\omega_{1})$、$c(\\omega_{2})$、$U(\\omega_{2})$。", "solution": "该问题要求针对给定的色散关系推导和评估相速度与群速度，并描述色散类型。瑞利型表面波的色散关系表述为 $k(\\omega)=a\\,\\omega+b\\,\\omega^{3}$，其中 $k$ 是波数，$\\omega$ 是角频率，$a$ 和 $b$ 是正常数。\n\n首先，我们推导相速度 $c(\\omega)$ 和群速度 $U(\\omega)$ 的表达式。\n\n单色平面波的相位由 $\\phi(x,t) = kx - \\omega t$ 给出。相速度 $c$ 是等相位点传播的速度。将 $\\phi(x,t)$ 设为常数并对时间 $t$ 求导，得到 $k\\frac{dx}{dt} - \\omega = 0$。因此，相速度定义为：\n$$c(\\omega) = \\frac{dx}{dt} = \\frac{\\omega}{k(\\omega)}$$\n将给定的色散关系 $k(\\omega) = a\\omega + b\\omega^3$ 代入此定义，我们得到相速度的表达式：\n$$c(\\omega) = \\frac{\\omega}{a\\omega + b\\omega^3}$$\n由于对于物理波的传播有 $\\omega > 0$，我们可以通过将分子和分母同除以 $\\omega$ 来简化此表达式：\n$$c(\\omega) = \\frac{1}{a + b\\omega^2}$$\n\n群速度 $U$ 代表波包振幅整体形状的速度，也就是波能量传输的速度。它由角频率对波数的导数定义：\n$$U(\\omega) = \\frac{d\\omega}{dk}$$\n通常先计算 $k$ 对 $\\omega$ 的导数，然后取其倒数会更方便。从给定的色散关系 $k(\\omega) = a\\omega + b\\omega^3$ 中，我们求得其导数：\n$$\\frac{dk}{d\\omega} = \\frac{d}{d\\omega}(a\\omega + b\\omega^3) = a + 3b\\omega^2$$\n群速度则是该表达式的倒数：\n$$U(\\omega) = \\left(\\frac{dk}{d\\omega}\\right)^{-1} = \\frac{1}{a + 3b\\omega^2}$$\n\n接下来，我们使用给定的参数值 $a = 5.0 \\times 10^{-4} \\ \\text{s/m}$ 和 $b = 3.0 \\times 10^{-9} \\ \\text{s}^3/\\text{m}$，计算在两个指定的角频率 $\\omega_1 = 20 \\ \\text{rad/s}$ 和 $\\omega_2 = 80 \\ \\text{rad/s}$ 处的 $c(\\omega)$ 和 $U(\\omega)$。\n\n对于 $\\omega_1 = 20 \\ \\text{rad/s}$：\n频率的平方是 $\\omega_1^2 = (20)^2 = 400 \\ \\text{rad}^2/\\text{s}^2$。\n相速度 $c(\\omega_1)$ 为：\n$$c(20) = \\frac{1}{(5.0 \\times 10^{-4}) + (3.0 \\times 10^{-9})(400)} = \\frac{1}{5.0 \\times 10^{-4} + 1.2 \\times 10^{-6}} = \\frac{1}{500 \\times 10^{-6} + 1.2 \\times 10^{-6}} = \\frac{1}{501.2 \\times 10^{-6}} \\approx 1995.211 \\ \\text{m/s}$$\n四舍五入到四位有效数字，$c(\\omega_1) = 1995 \\ \\text{m/s}$。\n\n群速度 $U(\\omega_1)$ 为：\n$$U(20) = \\frac{1}{(5.0 \\times 10^{-4}) + 3(3.0 \\times 10^{-9})(400)} = \\frac{1}{5.0 \\times 10^{-4} + 3.6 \\times 10^{-6}} = \\frac{1}{500 \\times 10^{-6} + 3.6 \\times 10^{-6}} = \\frac{1}{503.6 \\times 10^{-6}} \\approx 1985.703 \\ \\text{m/s}$$\n四舍五入到四位有效数字，$U(\\omega_1) = 1986 \\ \\text{m/s}$。\n\n对于 $\\omega_2 = 80 \\ \\text{rad/s}$：\n频率的平方是 $\\omega_2^2 = (80)^2 = 6400 \\ \\text{rad}^2/\\text{s}^2$。\n相速度 $c(\\omega_2)$ 为：\n$$c(80) = \\frac{1}{(5.0 \\times 10^{-4}) + (3.0 \\times 10^{-9})(6400)} = \\frac{1}{5.0 \\times 10^{-4} + 1.92 \\times 10^{-5}} = \\frac{1}{50 \\times 10^{-5} + 1.92 \\times 10^{-5}} = \\frac{1}{51.92 \\times 10^{-5}} \\approx 1926.040 \\ \\text{m/s}$$\n四舍五入到四位有效数字，$c(\\omega_2) = 1926 \\ \\text{m/s}$。\n\n群速度 $U(\\omega_2)$ 为：\n$$U(80) = \\frac{1}{(5.0 \\times 10^{-4}) + 3(3.0 \\times 10^{-9})(6400)} = \\frac{1}{5.0 \\times 10^{-4} + 5.76 \\times 10^{-5}} = \\frac{1}{50 \\times 10^{-5} + 5.76 \\times 10^{-5}} = \\frac{1}{55.76 \\times 10^{-5}} \\approx 1793.400 \\ \\text{m/s}$$\n四舍五入到四位有效数字，$U(\\omega_2) = 1793 \\ \\text{m/s}$。\n\n最后，我们确定色散的类型。在表面波的背景下，如果相速度随频率增加而减小，则色散被分类为“正常色散”；如果相速度随频率增加而增加，则为“反常色散”。为了确定这一点，我们考察 $c(\\omega)$ 对 $\\omega$ 的导数：\n$$c(\\omega) = (a + b\\omega^2)^{-1}$$\n$$\\frac{dc}{d\\omega} = \\frac{d}{d\\omega}(a + b\\omega^2)^{-1} = -1(a + b\\omega^2)^{-2} \\frac{d}{d\\omega}(a + b\\omega^2) = - (a + b\\omega^2)^{-2} (2b\\omega) = \\frac{-2b\\omega}{(a + b\\omega^2)^2}$$\n鉴于 $b > 0$ 且我们考虑的是物理频率 $\\omega > 0$，分子 $-2b\\omega$ 总是负的。分母 $(a + b\\omega^2)^2$ 总是正的。因此，对于所有 $\\omega > 0$，都有 $\\frac{dc}{d\\omega} < 0$。这表明相速度 $c(\\omega)$ 是角频率 $\\omega$ 的单调递减函数。这种高频（短波长）分量比低频（长波长）分量传播得慢的行为，被定义为表面波的正常色散。我们的数值结果与此结论一致，因为对于 $\\omega_1 < \\omega_2$，有 $c(\\omega_1) = 1995 \\ \\text{m/s} > c(\\omega_2) = 1926 \\ \\text{m/s}$。\n\n最终所需的四个速度结果，四舍五入到四位有效数字，分别是：\n$c(\\omega_1) = 1995 \\ \\text{m/s}$\n$U(\\omega_1) = 1986 \\ \\text{m/s}$\n$c(\\omega_2) = 1926 \\ \\text{m/s}$\n$U(\\omega_2) = 1793 \\ \\text{m/s}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1995 & 1986 & 1926 & 1793\n\\end{pmatrix}\n}\n$$", "id": "3615717"}, {"introduction": "从一个给定的频散关系转向从第一性原理推导它，是理解波现象物理本质的关键一步。本练习将引导你解决弹性动力学中的一个经典问题：通过推导并求解久期方程（secular equation）来确定均匀弹性半空间中的瑞利波（Rayleigh wave）速度。这项任务将解析推导与实际的数值求根算法相结合，这是计算地球物理学中的一项核心技能[@problem_id:3615731]，它揭示了介质的弹性参数（如泊松比 $\\nu$）如何决定表面波的传播速度。", "problem": "考虑一个占据 $z \\ge 0$ 的均匀、各向同性、弹性半空间，其在 $z = 0$ 处具有无牵引边界。令 $\\rho$ 表示质量密度，$\\lambda$ 和 $\\mu$ 为拉梅参数，$\\alpha = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$ 为压缩波（P波或纵波）波速，$\\beta = \\sqrt{\\mu/\\rho}$ 为剪切波（S波或横波）波速。令 $\\nu$ 表示泊松比，其定义为 $\\nu = \\lambda / \\left(2(\\lambda + \\mu)\\right)$。瑞利面波是弹性动力学方程的一个解，其相速度为 $c_R$，振幅随深度衰减，并满足表面的无牵引边界条件。\n\n从纳维弹性动力学方程和无牵引边界条件出发，采用一种势表示法，将该边值问题简化为关于瑞利波相速度的久期方程。仅使用基本定义和控制方程的标准推演，推导出一个关于瑞利波速比平方 $\\xi = (c_R/\\beta)^2$ 和参数 $\\gamma = \\beta^2/\\alpha^2$ 的无量纲久期方程，其中 $\\gamma$ 用泊松比 $\\nu$ 表示。通过分析此久期方程，证明当 $\\nu$ 在物理实际值范围 $[0, 0.5)$ 内变化时，瑞利波速 $c_R$ 介于大约 $0.87 \\, \\beta$ 和 $0.95 \\, \\beta$ 之间，并解释其对 $\\nu$ 的依赖关系。\n\n然后，通过求解推导出的瑞利久期方程，数值计算 $\\nu = 0.25$ 时的 $c_R$。对于数值计算，实现一个鲁棒的求根算法，以识别物理上可接受的根 $\\xi \\in (0, 1)$，并返回 $c_R = \\beta \\sqrt{\\xi}$。将 $c_R$ 以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到两位小数。\n\n使用以下测试套件来评估和报告您的计算：\n- 测试用例 1：$\\nu = 0.25$, $\\beta = 2000 \\, \\mathrm{m/s}$。返回瑞利波速 $c_R$，单位为 $\\mathrm{m/s}$（四舍五入到两位小数）。\n- 测试用例 2：$\\nu = 0.00$, $\\beta = 2500 \\, \\mathrm{m/s}$。返回无量纲比值 $r = c_R/\\beta$（四舍五入到六位小数）。\n- 测试用例 3：$\\nu = 0.45$, $\\beta = 2500 \\, \\mathrm{m/s}$。返回无量纲比值 $r = c_R/\\beta$（四舍五入到六位小数）。\n- 测试用例 4：对前三个用例进行边界验证测试，返回一个布尔值，指示每个计算出的比值 $r$ 是否满足 $0.87 \\le r \\le 0.95$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序必须完全如下：$[用例1的c_R, 用例2的r, 用例1的r, 用例3的r, 用例4的边界检查]$。例如，输出格式必须与 $[1990.12,0.874321,0.919400,0.949000,True]$ 完全一致，并使用您的程序计算出的相应值。", "solution": "该问题是有效的，因为它提出了一个弹性动力学中标准的、适定的问题，该问题具有科学依据且内部一致。\n\n目标是推导均匀、各向同性、弹性半空间中瑞利波的久期方程，分析其解，并针对特定的材料属性计算瑞利波速 $c_R$。\n\n**1. 控制方程与势表示法**\n\n均匀、各向同性、弹性固体的运动由纳维弹性动力学方程控制：\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n其中 $\\mathbf{u}$ 是位移矢量，$\\rho$ 是质量密度，$\\lambda$ 和 $\\mu$ 是拉梅参数。使用亥姆霍兹分解，位移矢量可以表示为标量势 $\\phi$ 和矢量势 $\\boldsymbol{\\psi}$ 的形式：$\\mathbf{u} = \\nabla \\phi + \\nabla \\times \\boldsymbol{\\psi}$。这将运动方程解耦为两个波动方程：\n$$\n\\nabla^2 \\phi = \\frac{1}{\\alpha^2} \\frac{\\partial^2 \\phi}{\\partial t^2} \\quad \\text{和} \\quad \\nabla^2 \\boldsymbol{\\psi} = \\frac{1}{\\beta^2} \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2}\n$$\n其中 $\\alpha = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ 是P波波速，$\\beta = \\sqrt{\\mu/\\rho}$ 是S波波速。我们考虑限制在 $x$-$z$ 平面（矢状面）内的运动，因此矢量势简化为 $\\boldsymbol{\\psi} = (0, \\psi, 0)$。\n\n**2. 面波设解**\n\n我们寻求一个表示在 $x$ 方向上传播，相速度为 $c_R$，波数为 $k$，且其振幅随深度 $z \\ge 0$ 呈指数衰减的波的解。假设势函数具有以下形式：\n$$\n\\phi(x, z, t) = A(z) e^{i(kx - \\omega t)}\n$$\n$$\n\\psi(x, z, t) = B(z) e^{i(kx - \\omega t)}\n$$\n其中 $\\omega = k c_R$。将这些代入波动方程，得到关于 $A(z)$ 和 $B(z)$ 的常微分方程：\n$$\n\\frac{d^2A}{dz^2} - k^2(1 - c_R^2/\\alpha^2)A = 0\n$$\n$$\n\\frac{d^2B}{dz^2} - k^2(1 - c_R^2/\\beta^2)B = 0\n$$\n为使波的振幅在 $z \\to \\infty$ 时衰减，$A$ 和 $B$ 的系数必须为正。这要求 $c_R  \\beta  \\alpha$。令 $q^2 = k^2(1 - c_R^2/\\alpha^2)$ 和 $s^2 = k^2(1 - c_R^2/\\beta^2)$。在无穷深度处消失的解为：\n$$\nA(z) = A_0 e^{-qz} \\quad \\text{和} \\quad B(z) = B_0 e^{-sz}\n$$\n其中 $A_0$ 和 $B_0$ 是常数。\n\n**3. 边界条件与久期方程**\n\n位移分量为 $u_x = \\frac{\\partial \\phi}{\\partial x} - \\frac{\\partial \\psi}{\\partial z}$ 和 $u_z = \\frac{\\partial \\phi}{\\partial z} + \\frac{\\partial \\psi}{\\partial x}$。代入势函数的解：\n$$\nu_x = (ik A_0 e^{-qz} + s B_0 e^{-sz}) e^{i(kx - \\omega t)}\n$$\n$$\nu_z = (-q A_0 e^{-qz} + ik B_0 e^{-sz}) e^{i(kx - \\omega t)}\n$$\n$z=0$ 处的表面是无牵引的，意味着应力分量 $\\sigma_{zz}$ 和 $\\sigma_{xz}$ 为零。应力-应变关系为 $\\sigma_{zz} = \\lambda (\\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_z}{\\partial z}) + 2\\mu \\frac{\\partial u_z}{\\partial z}$ 和 $\\sigma_{xz} = \\mu (\\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x})$。计算在 $z=0$ 处的应力并令其为零，得到一个关于 $A_0$ 和 $B_0$ 的线性方程组：\n$$\n\\begin{pmatrix}\n(2\\beta^2 - c_R^2)  -2i\\beta^2 s/k \\\\\n2iq/k  (2 - c_R^2/\\beta^2)\n\\end{pmatrix}\n\\begin{pmatrix} A_0 \\\\ B_0 \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n为了得到非平凡解（$A_0, B_0 \\neq 0$），系数矩阵的行列式必须为零：\n$$\n(2\\beta^2 - c_R^2)(2 - c_R^2/\\beta^2) - (-2i\\beta^2 s/k)(2iq/k) = 0\n$$\n$$\n\\frac{1}{\\beta^2}(2\\beta^2 - c_R^2)^2 - 4\\beta^2 (s/k)(q/k) = 0\n$$\n令 $\\xi = (c_R/\\beta)^2$。方程变为：\n$$\n(2-\\xi)^2 - 4 \\sqrt{1-c_R^2/\\alpha^2} \\sqrt{1-c_R^2/\\beta^2} = 0\n$$\n引入参数 $\\gamma = \\beta^2/\\alpha^2$，我们得到瑞利久期方程：\n$$\n(2-\\xi)^2 = 4 \\sqrt{1-\\gamma\\xi} \\sqrt{1-\\xi}\n$$\n两边平方以消除根式，得到：\n$$\n(2-\\xi)^4 = 16 (1-\\gamma\\xi)(1-\\xi)\n$$\n展开并化简，再除以平凡根 $\\xi=0$，我们得到一个关于 $\\xi$ 的三次多项式：\n$$\n\\xi^3 - 8\\xi^2 + (24-16\\gamma)\\xi + 16(\\gamma-1) = 0\n$$\n参数 $\\gamma$ 与泊松比 $\\nu = \\lambda/(2(\\lambda+\\mu))$ 的关系为：\n$$\n\\gamma = \\frac{\\beta^2}{\\alpha^2} = \\frac{\\mu}{\\lambda+2\\mu} = \\frac{1-2\\nu}{2(1-\\nu)}\n$$\n对于各向同性材料，物理上实际的泊松比范围是 $\\nu \\in [-1, 0.5)$，但对于大多数材料，其范围是 $\\nu \\in [0, 0.5)$。当 $\\nu$ 从 $0$ 变化到 $0.5$ 时，$\\gamma$ 从 $0.5$ 减小到 $0$。\n\n**4. 分析与数值解**\n我们分析三次方程在 $\\nu$ 的极限值下的根：\n- 对于 $\\nu=0$（例如陶瓷泡沫），$\\gamma = 1/2$。方程变为 $\\xi^3 - 8\\xi^2 + 16\\xi - 8 = 0$。在 $\\xi \\in (0, 1)$ 中物理上有意义的根约为 $\\xi \\approx 0.7645$，这给出 $c_R/\\beta = \\sqrt{\\xi} \\approx 0.874$。\n- 对于 $\\nu \\to 0.5$（不可压缩材料，如橡胶），$\\gamma \\to 0$。方程变为 $\\xi^3 - 8\\xi^2 + 24\\xi - 16 = 0$。根约为 $\\xi \\approx 0.91275$，这给出 $c_R/\\beta = \\sqrt{\\xi} \\approx 0.955$。\n该分析证实了当 $\\nu$ 从 $0$ 增加到 $0.5$ 时，比值 $c_R/\\beta$ 从约 $0.87$ 单调增加到约 $0.95$。\n\n对于任何给定的 $\\nu$，我们首先计算 $\\gamma$。然后，我们数值求解关于 $\\xi$ 的三次方程。像Brent方法这样的鲁棒方法适合于寻找在区间 $(0, 1)$ 内的唯一根。函数 $f(\\xi) = \\xi^3 - 8\\xi^2 + (24-16\\gamma)\\xi + 16(\\gamma-1)$ 在此区间上是连续的且变号，保证了根的存在。一旦找到 $\\xi$，瑞利波速为 $c_R = \\beta\\sqrt{\\xi}$，比值为 $r = \\sqrt{\\xi}$。\n\n测试用例的计算过程如下：\n- 对每个用例 $(\\nu, \\beta)$，我们计算 $\\gamma = (1-2\\nu)/(2(1-\\nu))$。\n- 我们数值求解 $\\xi^3 - 8\\xi^2 + (24-16\\gamma)\\xi + 16(\\gamma-1)=0$ 在 $\\xi \\in (0, 1)$ 内的根。\n- 我们计算比值 $r = \\sqrt{\\xi}$。\n- 对于用例1，我们计算 $c_R = \\beta \\cdot r$。\n- 对于用例2和3，我们使用 $r$ 的值。\n- 对于用例4，我们验证所有计算出的比值（$r_1, r_2, r_3$）是否落在 $[0.87, 0.95]$ 范围内。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef calculate_rayleigh_ratio(nu: float) - float:\n    \"\"\"\n    Calculates the Rayleigh wave speed to S-wave speed ratio (c_R / beta)\n    by solving the Rayleigh secular equation.\n\n    The problem is solved for the squared ratio xi = (c_R/beta)^2, which is a\n    root of the cubic equation:\n    xi^3 - 8*xi^2 + (24 - 16*gamma)*xi + 16*(gamma - 1) = 0\n    where gamma = (beta/alpha)^2 is related to Poisson's ratio nu.\n\n    Args:\n        nu: Poisson's ratio, must be in the range [0, 0.5).\n\n    Returns:\n        The ratio r = c_R / beta.\n    \"\"\"\n    # The problem is defined for nu in [0, 0.5).\n    # If nu is 0.5, gamma is 0. If nu > 0.5, gamma is negative, which is unphysical.\n    if not 0.0 = nu  0.5:\n        raise ValueError(\"Poisson's ratio nu must be in the range [0, 0.5)\")\n\n    # Calculate gamma = (beta/alpha)^2 from Poisson's ratio nu\n    gamma = (1.0 - 2.0 * nu) / (2.0 * (1.0 - nu))\n\n    # Define the Rayleigh cubic equation for xi = (c_R/beta)^2\n    # f(xi) = xi^3 - 8*xi^2 + (24 - 16*gamma)*xi + 16*(gamma - 1)\n    def rayleigh_cubic(xi):\n        return xi**3 - 8.0 * xi**2 + (24.0 - 16.0 * gamma) * xi + 16.0 * (gamma - 1.0)\n\n    # The physically admissible root for xi must be in the interval (0, 1)\n    # because c_R must be less than beta. The function is known to have a unique\n    # root in this interval for the physical range of gamma.\n    # We use brentq, a robust root-finding algorithm, given a bracketing interval.\n    try:\n        xi_root = brentq(rayleigh_cubic, 0.0, 1.0)\n    except ValueError:\n        # This case should not be reached for valid nu.\n        raise RuntimeError(\"Could not find a root in the interval (0, 1).\")\n    \n    # The ratio r = c_R / beta is the square root of xi\n    r = np.sqrt(xi_root)\n    return r\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results in the\n    specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (Poisson's ratio nu, S-wave speed beta in m/s)\n    test_cases = [\n        (0.25, 2000.0), # Case 1\n        (0.00, 2500.0), # Case 2\n        (0.45, 2500.0), # Case 3\n    ]\n\n    # --- Calculations for each case ---\n    # Case 1: nu = 0.25, beta = 2000 m/s\n    nu1, beta1 = test_cases[0]\n    r1 = calculate_rayleigh_ratio(nu1)\n    c_R1 = beta1 * r1\n\n    # Case 2: nu = 0.00, beta = 2500 m/s\n    nu2, _ = test_cases[1]\n    r2 = calculate_rayleigh_ratio(nu2)\n\n    # Case 3: nu = 0.45, beta = 2500 m/s\n    nu3, _ = test_cases[2]\n    r3 = calculate_rayleigh_ratio(nu3)\n\n    # Case 4: Bound Verification Test\n    ratios_for_check = [r1, r2, r3]\n    bound_check_result = all(0.87 = r = 0.95 for r in ratios_for_check)\n\n    # --- Format results for the final output string ---\n    # The required output order is:\n    # [c_R for case 1, r for case 2, r for case 1, r for case 3, bound case 4]\n    \n    # 1. c_R for case 1, rounded to two decimal places\n    res1 = f\"{c_R1:.2f}\"\n\n    # 2. r for case 2, rounded to six decimal places\n    res2 = f\"{r2:.6f}\"\n\n    # 3. r for case 1, rounded to six decimal places\n    res3 = f\"{r1:.6f}\"\n\n    # 4. r for case 3, rounded to six decimal places\n    res4 = f\"{r3:.6f}\"\n    \n    # 5. Boolean result for bound verification test\n    res5 = str(bound_check_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{res1},{res2},{res3},{res4},{res5}]\")\n\nsolve()\n```", "id": "3615731"}, {"introduction": "真实地球介质并非理想弹性体，非弹性衰减普遍存在，这为表面波频散分析带来了新的复杂性。本项高级练习旨在连接理想弹性理论与受衰减影响的真实数据，引入了因果性（causality）这一重要物理约束，它通过克拉默斯-克朗尼希关系（Kramers–Kronig relations）将频散与衰减联系起来。通过对比忽略内禀频散的“朴素”反演和考虑了因果性校正的反演，你将定量地看到物理模型不完整如何导致反演结果产生系统性偏差，从而体会到在高保真度层析成像中考虑粘弹性效应的重要性[@problem_id:3615778]。", "problem": "设计并实现一个程序，展示在线性粘弹性半空间中，通过克拉默斯-克朗尼希关系强制施加色散和衰减之间的因果性，如何影响面波色散分析和剪切波速度剖面的反演。您的程序必须是完全自包含的，并且必须从第一性原理实现以下物理和计算元素。\n\n给定以下建模假设和任务。\n\n1) 基本原理：从线性粘弹性理论和复剪切模量的定义出发。使用因果性的标准线性固体（Zener）本构方程来描述剪切应力和应变，\n$$\n\\sigma(t) + \\tau_{\\sigma} \\,\\dot{\\sigma}(t) = G \\,\\big(\\epsilon(t) + \\tau_{\\epsilon} \\,\\dot{\\epsilon}(t)\\big),\n$$\n其中 $\\sigma(t)$ 是剪切应力，$\\epsilon(t)$ 是剪切应变， $G$ 是松弛剪切模量，$\\tau_{\\sigma}$ 是应力松弛时间，$\\tau_{\\epsilon}$ 是应变延迟时间。在角频率域中，角频率 $\\omega = 2\\pi f$，这意味着复剪切模量 $G^{\\ast}(\\omega)$ 的形式为\n$$\nG^{\\ast}(\\omega) = G \\,\\frac{1 + i \\omega \\tau_{\\epsilon}}{1 + i \\omega \\tau_{\\sigma}}.\n$$\n由于标准线性固体是一个线性时不变且具有因果性的系统， $G^{\\ast}(\\omega)$ 的实部和虚部遵循克拉默斯-克朗尼希关系。使用此因果模型来强制实现色散与衰减之间的一致性。\n\n2) 定义与推论：对于密度为 $\\rho$ 的均匀粘弹性介质中的剪切体波，复剪切波速度为\n$$\nv^{\\ast}(\\omega) = \\sqrt{\\frac{G^{\\ast}(\\omega)}{\\rho}}.\n$$\n将松弛（零频）剪切波速定义为 $v_{0} = \\sqrt{\\frac{G}{\\rho}}$。依赖于频率的内禀（体波）色散因子，它乘以任何弹性结构预测值，是归一化复速度的实部，\n$$\n\\Phi(\\omega) = \\operatorname{Re}\\left(\\frac{v^{\\ast}(\\omega)}{v_{0}}\\right) = \\operatorname{Re}\\left(\\sqrt{\\frac{1 + i \\omega \\tau_{\\epsilon}}{1 + i \\omega \\tau_{\\sigma}}}\\right).\n$$\n使用 $\\Phi(\\omega)$ 来施加与衰减具有因果一致性的色散。由相同因果模型所蕴含的剪切波品质因子（品质因子，$Q$）由复模量定义为\n$$\nQ_{S}^{-1}(\\omega) = \\frac{\\operatorname{Im}\\,G^{\\ast}(\\omega)}{\\operatorname{Re}\\,G^{\\ast}(\\omega)} = \\frac{\\omega(\\tau_{\\epsilon} - \\tau_{\\sigma})}{1 + \\omega^{2}\\tau_{\\epsilon}\\tau_{\\sigma}}.\n$$\n此 $Q_{S}(f)$ 完全由 $(\\tau_{\\epsilon},\\tau_{\\sigma})$ 和 $G$ 决定，并且由于因果性，通过构造与 $\\Phi(\\omega)$ 一致。\n\n3) 面波正演模型（结构色散）：考虑一个水平分层的半空间，其剪切波速度剖面为双参数模型\n$$\nV_{S}(z) = \\begin{cases}\nV_{S1},  0 \\le z  h\\\\\nV_{S2},  z \\ge h,\n\\end{cases}\n$$\n密度 $\\rho$ 随深度保持不变。使用以下深度敏感度核函数来模拟面波对频率依赖的结构平均效应：\n$$\nK(z;\\, \\omega) \\propto 2k(\\omega)\\, e^{-2 k(\\omega) z}, \\quad k(\\omega) = \\frac{\\omega}{c_{\\mathrm{ref}}},\n$$\n其中 $k(\\omega)$ 是使用固定的参考相速度 $c_{\\mathrm{ref}}$ 计算的波数，您必须将其设置为 $c_{\\mathrm{ref}} = \\alpha \\,V_{S2}$，其中瑞利因子 $\\alpha = 0.92$（无量纲）。瑞利波相速度的结构（弹性）预测是一个加权平均值，\n$$\nc_{\\mathrm{struct}}(\\omega) = \\alpha \\left[ w_{1}(\\omega) V_{S1} + w_{2}(\\omega) V_{S2} \\right],\n$$\n权重由核函数确定，\n$$\nw_{1}(\\omega) = \\frac{\\int_{0}^{h} K(z;\\,\\omega)\\,dz}{\\int_{0}^{\\infty} K(z;\\,\\omega)\\,dz} = 1 - e^{-2k(\\omega) h}, \\qquad\nw_{2}(\\omega) = e^{-2k(\\omega) h}.\n$$\n\n4) 包含粘弹性色散的观测值：观测到的（内禀色散的）瑞利波相速度通过将结构预测值乘以内禀色散因子来建模，\n$$\nc_{\\mathrm{obs}}(\\omega) = \\Phi(\\omega)\\, c_{\\mathrm{struct}}(\\omega).\n$$\n这明确地将结构色散（深度敏感性）与内禀粘弹性色散分开，后者与 $Q_{S}(\\omega)$ 具有因果一致性。\n\n5) $V_{S}(z)$ 的反演与演示：在有限频带上给定 $c_{\\mathrm{obs}}(\\omega)$，通过线性最小二乘法在两种情景下反演 $(V_{S1}, V_{S2})$：\n- 朴素（非因果）反演：忽略内禀色散，直接用 $c_{\\mathrm{struct}}(\\omega)$ 拟合 $c_{\\mathrm{obs}}(\\omega)$。\n- 强制因果性反演：首先通过 $c_{\\mathrm{obs}}(\\omega)/\\Phi(\\omega)$ 去除内禀色散，然后用校正后的数据拟合 $c_{\\mathrm{struct}}(\\omega)$。\n报告朴素反演与强制因果性反演在误差（以米/秒为单位）方面的差异。\n\n6) 频率、单位和数值要求：\n- 使用 $f$（赫兹），$z$ 和 $h$（米），$V_{S}$ 和 $c$（米/秒），$\\rho$（千克/立方米），以及 $\\tau_{\\epsilon}, \\tau_{\\sigma}$（秒）。\n- 使用从 $f_{\\min} = 0.5$ 赫兹到 $f_{\\max} = 20$ 赫兹的 $N=20$ 个对数间隔采样的频带。\n- 将所有最终误差以米/秒为单位表示为浮点数。\n\n7) 测试套件：使用以下三个测试案例。在每个案例中，设置 $\\rho = 2000\\,\\mathrm{kg/m^{3}}$，$\\alpha = 0.92$，$h = 50\\,\\mathrm{m}$，$V_{S1} = 600\\,\\mathrm{m/s}$，$V_{S2} = 1200\\,\\mathrm{m/s}$。对于标准线性固体，定义比率 $r = \\tau_{\\epsilon}/\\tau_{\\sigma}  1$ 和松弛峰值频率 $f_{0}$，通过 $\\omega_{0} = 2\\pi f_{0} = 1/\\sqrt{\\tau_{\\epsilon}\\tau_{\\sigma}}$。从 $(r, f_{0})$ 确定\n$$\n\\tau_{\\sigma} = \\frac{1}{\\omega_{0}\\sqrt{r}}, \\qquad \\tau_{\\epsilon} = r \\,\\tau_{\\sigma}.\n$$\n使用：\n- 案例 A（弱衰减）：$r = 1.005$，$f_{0} = 3\\,\\mathrm{Hz}$。\n- 案例 B（中等衰减）：$r = 1.05$，$f_{0} = 5\\,\\mathrm{Hz}$。\n- 案例 C（强衰减）：$r = 1.2$，$f_{0} = 8\\,\\mathrm{Hz}$。\n\n8) 输出规范：对于每个案例，执行两种反演，并计算两个参数的均方根误差如下\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{( \\widehat{V}_{S1} - V_{S1})^{2} + ( \\widehat{V}_{S2} - V_{S2})^{2}}{2}} \\quad \\text{in meters per second}.\n$$\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序如下\n$$\n[\\mathrm{RMS}_{\\text{naive,A}}, \\mathrm{RMS}_{\\text{causal,A}}, \\mathrm{RMS}_{\\text{naive,B}}, \\mathrm{RMS}_{\\text{causal,B}}, \\mathrm{RMS}_{\\text{naive,C}}, \\mathrm{RMS}_{\\text{causal,C}}].\n$$\n所有六个数字都必须是浮点数，单位为米/秒。\n\n科学真实性与一致性：所有计算必须遵循上述线性粘弹性模型和结构核函数。不要假设任何与 $Q_{S}(f)$ 无关的特定色散。强制因果性意味着相同的 $(\\tau_{\\epsilon},\\tau_{\\sigma})$ 通过单一的复模量 $G^{\\ast}(\\omega)$ 同时决定了衰减 $Q_{S}(f)$ 和色散因子 $\\Phi(\\omega)$。\n\n您的最终程序必须是独立运行的，不需要任何输入，并且确定性地执行。只打印所需的单行输出。", "solution": "该问题已被验证，并被确定为计算地球物理学中一个适定（well-posed）、有科学依据的练习。它提供了一个清晰且一致的框架，用于演示强制因果性的粘弹性色散对面波反演的影响。所有必要的物理模型、数学方程和数值参数都得到了明确定义，从而可以得到一个确定性且可验证的解。\n\n该解决方案首先基于一个复合模型生成合成面波色散数据，该模型既包括来自层状地球的结构色散，也包括来自因果粘弹性流变学的内禀色散。随后，将两种反演程序应用于这些数据，以恢复地球的剪切波速度结构。它们在准确性上的差异突显了考虑内禀、因果色散的重要性。\n\n**1. 物理和计算模型**\n\n该问题结合了面波的两种色散来源：由于速度随深度变化引起的结构色散，以及由于传播介质的粘弹性性质引起的内禀色散。\n\n**1.1. 内禀粘弹性色散**\n材料的流变学特性由标准线性固体（SLS）模型描述，这是一个因果且线性时不变的系统。在频域中，这由复剪切模量 $G^{\\ast}(\\omega)$ 捕捉：\n$$\nG^{\\ast}(\\omega) = G \\,\\frac{1 + i \\omega \\tau_{\\epsilon}}{1 + i \\omega \\tau_{\\sigma}}\n$$\n其中 $G$ 是松弛剪切模量，$\\omega$ 是角频率，$\\tau_{\\epsilon}$ 是应变延迟时间，$\\tau_{\\sigma}$ 是应力松弛时间。问题通过比率 $r = \\tau_{\\epsilon}/\\tau_{\\sigma}$ 和一个特征频率 $f_0$ 来定义这些时间常数，由此我们推导出 $\\omega_{0} = 2\\pi f_{0}$，$\\tau_{\\sigma} = 1/(\\omega_{0}\\sqrt{r})$，以及 $\\tau_{\\epsilon} = r \\tau_{\\sigma}$。\n\n在密度为 $\\rho$ 的均匀介质中，复剪切波速度为 $v^{\\ast}(\\omega) = \\sqrt{G^{\\ast}(\\omega) / \\rho}$。内禀色散，即波速对频率的依赖性，通过定义一个无量纲色散因子 $\\Phi(\\omega)$ 与结构效应分离开来。该因子是复速度除以松弛（零频）速度 $v_0 = \\sqrt{G/\\rho}$ 进行归一化后的实部：\n$$\n\\Phi(\\omega) = \\operatorname{Re}\\left(\\frac{v^{\\ast}(\\omega)}{v_{0}}\\right) = \\operatorname{Re}\\left(\\sqrt{\\frac{1 + i \\omega \\tau_{\\epsilon}}{1 + i \\omega \\tau_{\\sigma}}}\\right)\n$$\n这个函数 $\\Phi(\\omega)$ 量化了与材料衰减（由同一 $G^{\\ast}(\\omega)$ 导出的品质因子 $Q_S(\\omega)$ 描述）有因果关系的内禀速度随频率的变化。\n\n**1.2. 结构色散**\n地球模型是一个覆盖在基底上的单层半空间：\n$$\nV_{S}(z) = \\begin{cases}\nV_{S1},  0 \\le z  h\\\\\nV_{S2},  z \\ge h,\n\\end{cases}\n$$\n在给定频率下，面波的相速度对一定深度范围内的剪切波速度很敏感。这通过加权平均进行建模，权重由深度敏感度核函数 $K(z; \\omega)$ 导出。问题指定了一个指数核函数 $K(z; \\omega) \\propto \\exp(-2 k(\\omega) z)$，其中波数 $k(\\omega) = \\omega/c_{\\mathrm{ref}}$ 使用参考相速度 $c_{\\mathrm{ref}} = \\alpha V_{S2}$（$\\alpha=0.92$）计算。\n\n将此核函数在层内和半空间上积分，分别得到 $V_{S1}$ 和 $V_{S2}$ 的权重 $w_1(\\omega)$ 和 $w_2(\\omega)$：\n$$\nw_{1}(\\omega) = 1 - e^{-2k(\\omega) h}, \\qquad\nw_{2}(\\omega) = e^{-2k(\\omega) h}.\n$$\n纯粹的结构（弹性）相速度则为：\n$$\nc_{\\mathrm{struct}}(\\omega) = \\alpha \\left[ w_{1}(\\omega) V_{S1} + w_{2}(\\omega) V_{S2} \\right].\n$$\n这个方程构成了反演的基础。\n\n**1.3. 合成观测数据**\n合成的“观测”相速度 $c_{\\mathrm{obs}}(\\omega)$ 是结构预测值与内禀色散因子的乘积，在一个从 $f_{\\min}=0.5\\,\\mathrm{Hz}$到 $f_{\\max}=20\\,\\mathrm{Hz}$ 的对数频率网格上计算：\n$$\nc_{\\mathrm{obs}}(\\omega) = \\Phi(\\omega) \\, c_{\\mathrm{struct}}(\\omega)\n$$\n这模拟了在一个同时存在结构色散和内禀色散的世界中，仪器会测量到的结果。\n\n**2. 反演方法**\n\n目标是在一组频率 $\\omega_j$ 上给定数据 $c_{\\mathrm{obs}}(\\omega)$，反演出模型参数 $m = [V_{S1}, V_{S2}]^T$。结构模型可以写成一个线性方程组。两边除以 $\\alpha$，我们得到：\n$$\n\\frac{c_{\\mathrm{struct}}(\\omega_j)}{\\alpha} = w_{1}(\\omega_j) V_{S1} + w_{2}(\\omega_j) V_{S2}\n$$\n对于 $N$ 个频率，这是一个线性系统 $d = Gm$，其中 $d$ 是长度为 $N$ 的数据向量，$G$ 是 $N \\times 2$ 的设计（或雅可比）矩阵，$m$ 是 $2 \\times 1$ 的模型参数向量。$G$ 的列是权重 $[w_1(\\omega_j)]$ 和 $[w_2(\\omega_j)]$。标准的线性最小二乘解是 $\\hat{m} = (G^T G)^{-1} G^T d$。\n\n关键区别在于如何从观测值 $c_{\\mathrm{obs}}(\\omega_j)$ 构造数据向量 $d$。\n\n**2.1. 朴素（非因果）反演**\n这种方法错误地假设仅结构模型就能解释数据，即 $c_{\\mathrm{obs}}(\\omega) \\approx c_{\\mathrm{struct}}(\\omega)$。因此，用于最小二乘系统的数据向量被取为：\n$$\nd_{\\mathrm{naive}, j} = \\frac{c_{\\mathrm{obs}}(\\omega_j)}{\\alpha}\n$$\n该反演求解一个模型 $[\\widehat{V}_{S1, \\text{naive}}, \\widehat{V}_{S2, \\text{naive}}]$，该模型能最好地拟合未经校正、包含内禀色散的数据。由于没有考虑 $\\Phi(\\omega)$，反演得到的速度将会有偏差。\n\n**2.2. 强制因果性反演**\n这种方法正确地认识到 $c_{\\mathrm{obs}}$ 包含内禀色散。它首先通过除以因果色散因子 $\\Phi(\\omega)$ 来“校正”数据，以分离出结构分量：\n$$\n\\frac{c_{\\mathrm{obs}}(\\omega)}{\\Phi(\\omega)} = c_{\\mathrm{struct}}(\\omega)\n$$\n因此，用于最小二乘系统的数据向量是：\n$$\nd_{\\mathrm{causal}, j} = \\frac{1}{\\alpha} \\left( \\frac{c_{\\mathrm{obs}}(\\omega_j)}{\\Phi(\\omega_j)} \\right)\n$$\n由于这个校正后的数据向量完美匹配线性模型所需的形式（$c_{\\mathrm{struct}}/\\alpha$），对 $[\\widehat{V}_{S1, \\text{causal}}, \\widehat{V}_{S2, \\text{causal}}]$ 的反演有望以最小的误差恢复真实参数 $V_{S1}$ 和 $V_{S2}$，误差仅受机器精度限制。\n\n**3. 误差计算与实现**\n对于每个测试案例（A, B, C），都执行两种反演。计算均方根（RMS）误差以量化每个反演模型的准确性：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{( \\widehat{V}_{S1} - V_{S1})^{2} + ( \\widehat{V}_{S2} - V_{S2})^{2}}{2}}\n$$\n该程序为指定的三个测试案例中的每一个都实现了整个工作流程，从参数计算和数据生成到两种反演以及最终的误差计算。结果表明，随着衰减的增加（从案例A到C），内禀色散变得更加显著，朴素反演的误差显著增大，而强制因果性反演则保持准确。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Demonstrates the effect of enforcing causality in surface-wave dispersion analysis.\n\n    This function implements the entire workflow described in the problem statement:\n    1. Sets up the physical model (two-layer Earth, Standard Linear Solid rheology).\n    2. Defines three test cases with varying levels of viscoelastic attenuation.\n    3. For each case:\n       a. Generates synthetic 'observed' surface-wave phase velocity data that includes\n          both structural dispersion and causal intrinsic dispersion.\n       b. Performs a 'naive' inversion for the velocity profile, ignoring intrinsic dispersion.\n       c. Performs a 'causality-enforced' inversion that correctly accounts for and\n          removes intrinsic dispersion before inverting for the structure.\n       d. Calculates the RMS error for both inversion results.\n    4. Prints the six resulting RMS errors in the specified format.\n    \"\"\"\n\n    # 6) Frequencies, units, and numerical requirements\n    N = 20\n    f_min = 0.5  # Hz\n    f_max = 20.0 # Hz\n    frequencies = np.logspace(np.log10(f_min), np.log10(f_max), N)\n    omega = 2 * np.pi * frequencies\n\n    # 7) Test suite: Common parameters\n    rho = 2000.0  # kg/m^3\n    alpha = 0.92  # dimensionless Rayleigh factor\n    h = 50.0      # m\n    V_S1_true = 600.0  # m/s\n    V_S2_true = 1200.0 # m/s\n\n    test_cases = [\n        # Case A (weak attenuation)\n        (1.005, 3.0),\n        # Case B (moderate attenuation)\n        (1.05, 5.0),\n        # Case C (strong attenuation)\n        (1.2, 8.0),\n    ]\n\n    results = []\n\n    for r, f0 in test_cases:\n        # --- 1. Forward Model: Generate Synthetic Data ---\n\n        # 1)  2) Calculate intrinsic dispersion factor Phi(omega)\n        # From (r, f0), determine tau_sigma and tau_epsilon\n        omega0 = 2 * np.pi * f0\n        tau_sigma = 1 / (omega0 * np.sqrt(r))\n        tau_epsilon = r * tau_sigma\n\n        # G*(\\omega) / G = (1 + i\\omega\\tau_epsilon) / (1 + i\\omega\\tau_sigma)\n        # Phi(\\omega) = Re(sqrt(G*(\\omega)/G))\n        complex_term_num = 1 + 1j * omega * tau_epsilon\n        complex_term_den = 1 + 1j * omega * tau_sigma\n        phi = np.real(np.sqrt(complex_term_num / complex_term_den))\n\n        # 3) Calculate structural dispersion weights w1(omega), w2(omega)\n        # The kernel depends on a reference velocity, which the problem states to\n        # set using the true V_S2.\n        c_ref = alpha * V_S2_true\n        k = omega / c_ref\n        w2 = np.exp(-2 * k * h)\n        w1 = 1.0 - w2\n        \n        # Calculate the true structural phase velocity\n        c_struct_true = alpha * (w1 * V_S1_true + w2 * V_S2_true)\n\n        # 4) Calculate the final synthetic 'observed' data\n        c_obs = phi * c_struct_true\n\n        # --- 2. Inversion for V_S(z) ---\n\n        # The linear model is c_struct/alpha = w1*V_S1 + w2*V_S2\n        # Set up the design matrix G. Its columns are the weights.\n        G = np.vstack((w1, w2)).T  # Shape (N, 2)\n\n        # 5a) Naive (non-causal) inversion\n        # The data vector is c_obs/alpha, incorrectly assumed to be c_struct/alpha\n        d_naive = c_obs / alpha\n        m_naive, _, _, _ = np.linalg.lstsq(G, d_naive, rcond=None)\n        V_S1_naive, V_S2_naive = m_naive\n\n        # 5b) Causality-enforced inversion\n        # Correct the data by dividing out the intrinsic dispersion factor\n        c_corrected = c_obs / phi\n        d_causal = c_corrected / alpha\n        m_causal, _, _, _ = np.linalg.lstsq(G, d_causal, rcond=None)\n        V_S1_causal, V_S2_causal = m_causal\n\n        # --- 3. Error Calculation ---\n        \n        # 8) Output specification: RMS error\n        rms_naive = np.sqrt(0.5 * ((V_S1_naive - V_S1_true)**2 + (V_S2_naive - V_S2_true)**2))\n        rms_causal = np.sqrt(0.5 * ((V_S1_causal - V_S1_true)**2 + (V_S2_causal - V_S2_true)**2))\n        \n        results.extend([rms_naive, rms_causal])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3615778"}]}