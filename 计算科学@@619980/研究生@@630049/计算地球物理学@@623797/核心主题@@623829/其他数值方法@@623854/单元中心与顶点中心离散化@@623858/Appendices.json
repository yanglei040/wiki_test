{"hands_on_practices": [{"introduction": "在数值模拟中，一个常见的陷阱是对材料属性使用不恰当的平均方法。本练习通过一个具有高反差电导率跳跃的一维稳态流问题，清晰地揭示了为什么算术平均会导致物理上不正确的结果 [@problem_id:3579264]。这是一个基础性练习，旨在强调需要从底层物理原理（例如串联电阻概念，它自然地导向了调和平均）出发来推导数值格式。", "problem": "考虑一个占据区间 $[0,1]$ 的复合各向同性介质中的一维、稳态、单相流，其横截面积为单位面积 $A=1$。标量势 $u(x)$ 满足线性本构关系（Darcy 或 Fourier 类型），其通量 $q(x)$ 与 $u(x)$ 的梯度及材料导率 $k(x)$ 成正比。守恒定律意味着在稳态下，通量在空间上是恒定的。该介质由两层组成：位于 $x \\in [0,1/2]$ 的左层，其导率为常数 $k_L$；以及位于 $x \\in [1/2,1]$ 的右层，其导率为常数 $k_R$。施加 Dirichlet 边界条件 $u(0) = 1$ 和 $u(1) = 0$。\n\n考虑两种离散化的观点：\n\n1. 在一种以顶点为中心的离散化方法中，顶点位于 $x=0$ 和 $x=1$。穿过连接这两个顶点的单条边的通量采用两点通量法进行近似，其边的导率定义为相邻层导率的算术平均值，$k_{\\mathrm{edge}}^{\\mathrm{arith}} = (k_L + k_R)/2$。此格式预测的通量大小为 $|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\, |u(1) - u(0)| / 1$。\n\n2. 物理上正确的通量大小 $|q_{\\mathrm{phys}}|$ 可通过在两层上强制执行稳态守恒和本构关系的连续介质模型得出。\n\n使用第一性原理，推导出 $|q_{\\mathrm{arith}}|$$ 和 $|q_{\\mathrm{phys}}|$ 的闭式表达式，然后计算在高对比度情况下（$k_L = 1$ 且 $k_R = 10^{6}$）的比值 $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$。请以纯数（无量纲）形式给出您的最终答案 $r$，并四舍五入到四位有效数字。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于稳态输运现象的原理，具有充分且一致的边界条件，是适定的，并且是客观表述的。该问题将一个精确的解析解与一个常见的数值近似进行比较，这是计算物理学中一个标准且有意义的练习。\n\n首先，我们推导由以顶点为中心的离散化方法预测的通量大小 $|q_{\\mathrm{arith}}|$ 的表达式。问题将此通量近似定义为：\n$$\n|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\frac{|u(1) - u(0)|}{1}\n$$\n边的导率 $k_{\\mathrm{edge}}^{\\mathrm{arith}}$ 被设定为相邻层导率的算术平均值：\n$$\nk_{\\mathrm{edge}}^{\\mathrm{arith}} = \\frac{k_L + k_R}{2}\n$$\nDirichlet 边界条件为 $u(0) = 1$ 和 $u(1) = 0$。势差为 $|u(1) - u(0)| = |0 - 1| = 1$。区域的总长度为 $L=1$。将这些值代入 $|q_{\\mathrm{arith}}|$ 的公式，得到：\n$$\n|q_{\\mathrm{arith}}| = \\left(\\frac{k_L + k_R}{2}\\right) \\frac{1}{1} = \\frac{k_L + k_R}{2}\n$$\n\n接下来，我们推导物理上正确的通量大小 $|q_{\\mathrm{phys}}|$ 的表达式。这是从连续介质模型中获得的。其控制方程是守恒定律和本构关系。\n对于一维稳态流，守恒定律规定通量 $q(x)$ 在整个区域内是恒定的。我们用 $q$ 表示这个恒定的通量。\n本构关系（例如，Darcy 定律或 Fourier 定律）将通量与势梯度联系起来：\n$$\nq = -k(x) \\frac{du}{dx}\n$$\n其中 $A=1$ 是单位横截面积。负号表示流动从高势区流向低势区。\n\n我们可以对介质的两层积分这个方程。\n对于左层，$x \\in [0, 1/2]$，导率为 $k(x) = k_L$。我们从 $x=0$ 积分到 $x=1/2$：\n$$\n\\int_{u(0)}^{u(1/2)} du = \\int_{0}^{1/2} -\\frac{q}{k_L} dx\n$$\n$$\nu(1/2) - u(0) = -\\frac{q}{k_L} \\left(\\frac{1}{2} - 0\\right) = -\\frac{q}{2k_L}\n$$\n对于右层，$x \\in [1/2, 1]$，导率为 $k(x) = k_R$。我们从 $x=1/2$ 积分到 $x=1$：\n$$\n\\int_{u(1/2)}^{u(1)} du = \\int_{1/2}^{1} -\\frac{q}{k_R} dx\n$$\n$$\nu(1) - u(1/2) = -\\frac{q}{k_R} \\left(1 - \\frac{1}{2}\\right) = -\\frac{q}{2k_R}\n$$\n我们得到了一个由两个方程组成的方程组。我们可以通过将它们相加来消去未知的界面势 $u(1/2)$：\n$$\n(u(1/2) - u(0)) + (u(1) - u(1/2)) = -\\frac{q}{2k_L} - \\frac{q}{2k_R}\n$$\n$$\nu(1) - u(0) = -q \\left(\\frac{1}{2k_L} + \\frac{1}{2k_R}\\right)\n$$\n现在，我们求解通量 $q$：\n$$\nq = -\\frac{u(1) - u(0)}{\\frac{1}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)}\n$$\n代入边界条件 $u(0)=1$ 和 $u(1)=0$：\n$$\nq = -\\frac{0 - 1}{\\frac{1}{2}\\left(\\frac{k_R + k_L}{k_L k_R}\\right)} = \\frac{1}{\\frac{k_L + k_R}{2k_L k_R}} = \\frac{2k_L k_R}{k_L + k_R}\n$$\n通量为正，表明流动方向为正 $x$ 方向，正如预期的那样。其大小为：\n$$\n|q_{\\mathrm{phys}}| = \\frac{2k_L k_R}{k_L + k_R}\n$$\n这个表达式对应于总阻力是两层串联阻力之和，$R_{total} = R_L + R_R = \\frac{L_L}{k_L A} + \\frac{L_R}{k_R A} = \\frac{1/2}{k_L} + \\frac{1/2}{k_R}$。有效导率是 $k_L$ 和 $k_R$ 的调和平均值。\n\n现在我们计算比值 $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$。\n$$\nr = \\frac{\\frac{k_L + k_R}{2}}{\\frac{2k_L k_R}{k_L + k_R}} = \\frac{(k_L + k_R)(k_L + k_R)}{2 \\cdot (2k_L k_R)} = \\frac{(k_L + k_R)^2}{4k_L k_R}\n$$\n对于这个一维串联流动问题，这个比值代表了在数值格式中使用导率的算术平均值（而不是物理上正确的调和平均值）所引入的误差。\n\n最后，我们代入给定的数值 $k_L = 1$ 和 $k_R = 10^6$ 来计算 $r$。\n$$\nr = \\frac{(1 + 10^6)^2}{4(1)(10^6)} = \\frac{(1,000,001)^2}{4,000,000}\n$$\n$$\nr = \\frac{1,000,002,000,001}{4,000,000} = 250000.50000025\n$$\n问题要求将结果四舍五入到四位有效数字。该数为 $2.5000050000025 \\times 10^5$。前四位有效数字是 $2, 5, 0, 0$。第五位有效数字是 $0$，所以我们不对第四位进行进位。该数四舍五入到四位有效数字是 $250,000$。为了明确地用四位有效数字表示，我们使用科学记数法。\n$$\nr \\approx 2.500 \\times 10^5\n$$\n这个巨大的 $r$ 值突显了在高导率对比度介质中，使用算术平均来近似通量会带来严重的误差。", "answer": "$$\n\\boxed{2.500 \\times 10^5}\n$$", "id": "3579264"}, {"introduction": "在物理一致性的基础上，本练习探讨了现实世界模拟中的一个普遍挑战：处理复杂的非正交网格 [@problem_id:3579382]。它探索了在以单元为中心的有限体积格式中，应用于倾斜网格上的朴素通量近似如何破坏离散算子的对称性——这是一个非常重要的性质。本练习的目标是推导出一个能恢复对称性的修正“传输率”，从而加深对调和平均及其与物理原理联系的理解。", "problem": "考虑二维空间中的稳态扩散方程，该方程由守恒律 $\\nabla \\cdot \\boldsymbol{q} = 0$ 和傅里叶定律 $\\boldsymbol{q} = -k \\nabla u$ 控制，其中 $k$ 为分段常数的各向同性传导率。在一个单元中心有限体积法（FVM）中，考虑两个相邻的多边形控制体 $V_{1}$ 和 $V_{2}$，其形心分别位于 $\\boldsymbol{x}_{1}$ 和 $\\boldsymbol{x}_{2}$。它们共享一个内面 $f$，其面积（在二维中为边长）为 $A_{f}$，单位法向量为 $\\hat{\\boldsymbol{n}}_{f}$，方向从 $V_{1}$ 指向 $V_{2}$。设从形心沿 $\\hat{\\boldsymbol{n}}_{f}$ 方向到面平面的有向距离为 $d_{1f} > 0$ 和 $d_{2f} > 0$，定义为 $d_{1f} = \\hat{\\boldsymbol{n}}_{f} \\cdot (\\boldsymbol{x}_{f} - \\boldsymbol{x}_{1})$ 和 $d_{2f} = \\hat{\\boldsymbol{n}}_{f} \\cdot (\\boldsymbol{x}_{2} - \\boldsymbol{x}_{f})$，其中 $\\boldsymbol{x}_{f}$ 是面 $f$ 的形心。在歪斜网格上，$\\boldsymbol{x}_{2} - \\boldsymbol{x}_{1}$ 与 $\\hat{\\boldsymbol{n}}_{f}$ 不共线，因此通常 $d_{1f} \\neq d_{2f}$。\n\n在单元中心离散化中，一种常见但有缺陷的面组合方式是，仅使用局部距离为每一行分配单侧的、面法向通量贡献，即在 $V_{1}$ 所在的行中，$a_{12}^{\\text{naive}} = k_{2} A_{f} / d_{2f}$，在 $V_{2}$ 所在的行中，$a_{21}^{\\text{naive}} = k_{1} A_{f} / d_{1f}$。每当 $d_{1f} \\neq d_{2f}$ 或 $k_{1} \\neq k_{2}$ 时，这种做法会破坏对称正定算子所要求的非对角线对称性。举一个具体的反例，取 $k_{1} = k_{2} = 1$, $A_{f} = 1$, $d_{1f} = 0.3$ 以及 $d_{2f} = 0.7$；此时 $a_{12}^{\\text{naive}} \\neq a_{21}^{\\text{naive}}$。假设所有量都经过无量纲化处理，因此最终结果中不出现单位。\n\n从在每个控制体上积分的守恒律以及穿过面 $f$ 的法向通量的连续性出发，推导一个修正的两点面传导率 $T_{f}$。该传导率通过强制 $a_{12} = a_{21} = T_{f}$ 来恢复共享面 $f$ 的对称性，并且仅用 $A_{f}$、$k_{1}$、$k_{2}$、$d_{1f}$ 和 $d_{2f}$ 表示。你的最终答案必须是 $T_{f}$ 的一个单一的、闭合形式的解析表达式。不要提供不等式或方程式；只提供表达式本身。", "solution": "用户希望为一个使用单元中心有限体积法离散化的稳态扩散问题，推导对称的两点面传导率。\n\n首先验证问题。\n\n### 步骤 1：提取已知条件\n- **控制方程**：\n  - 守恒律：$\\nabla \\cdot \\boldsymbol{q} = 0$。\n  - 本构律（傅里叶定律）：$\\boldsymbol{q} = -k \\nabla u$。\n- **材料属性**：$k$ 是分段常数的各向同性传导率。\n- **离散化背景**：单元中心有限体积法（FVM）。\n- **几何设置**：\n  - 两个相邻的控制体 $V_1$ 和 $V_2$。\n  - 单元形心位于 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$。\n  - 共享面积为 $A_f$ 的内面 $f$。\n  - 指向面 $f$ 的单位法向量 $\\hat{\\boldsymbol{n}}_f$，从 $V_1$ 指向 $V_2$。\n  - 面形心位于 $\\boldsymbol{x}_f$。\n  - 从形心到面的有向法向距离：$d_{1f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_1) > 0$ 和 $d_{2f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_2 - \\boldsymbol{x}_f) > 0$。\n- **目标**：推导一个修正的两点面传导率 $T_f$，使得得到的离散化对于面 $f$ 是对称的（即，在问题的符号约定下，$a_{12} = a_{21} = T_f$）。$T_f$ 的表达式必须用 $A_f$、$k_1$、$k_2$、$d_{1f}$ 和 $d_{2f}$ 来表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题很好地基于偏微分方程数值方法的原理，特别是用于扩散问题的有限体积法。传导率、控制体、面通量以及网格非正交性的挑战等概念是该领域的基础。控制方程是标准的物理学原理。\n- **适定性**：要求是基于一组清晰的物理和几何约束，推导一个特定的数学表达式。可以确定一个唯一且有意义的传导率表达式。\n- **客观性**：该问题以精确、客观的数学和技术语言陈述。没有主观或模棱两可的术语。\n\n### 步骤 3：结论和行动\n问题是有效的。这是一个关于计算物理和工程中数值格式推导的标准且定义明确的练习。将提供一个解答。\n\n### 对称传导率的推导\n\n目标是确定由控制体 $V_1$ 和 $V_2$ 共享的面 $f$ 上的通量 $F_f$，将其表示为单元中心值 $u_1$ 和 $u_2$ 的函数。该通量以 $F_f = T_f(u_1 - u_2)$ 的形式表示，其中 $T_f$ 是我们寻求推导的传导率。\n\n从 $V_1$ 到 $V_2$ 穿过面 $f$ 的总通量 $F_f$ 由通量矢量 $\\boldsymbol{q}$ 的法向分量在面上的积分给出：\n$$F_f = \\int_f \\boldsymbol{q} \\cdot \\hat{\\boldsymbol{n}}_f \\, dS$$\n假设通量在整个面上是均匀的，我们可以将其近似为：\n$$F_f \\approx A_f (\\boldsymbol{q}|_f \\cdot \\hat{\\boldsymbol{n}}_f)$$\n使用傅里叶定律 $\\boldsymbol{q} = -k \\nabla u$，这变为：\n$$F_f \\approx -A_f (k \\nabla u)|_f \\cdot \\hat{\\boldsymbol{n}}_f = -A_f k_f \\frac{\\partial u}{\\partial n}\\bigg|_f$$\n其中 $k_f$ 是面上的传导率，$\\frac{\\partial u}{\\partial n}|_f$ 是 $u$ 在面上的法向导数。\n\n两点通量近似的核心是将势在面上的值 $u_f$ 及其法向导数与单元中心值 $u_1$ 和 $u_2$ 联系起来。我们假设在面附近的区域，势 $u$ 沿着垂直于面的方向呈一维变化。\n\n设 $u_f$ 是面形心 $\\boldsymbol{x}_f$ 处的势值。我们可以从两个角度表达通量：从单元 $V_1$ 到面 $f$，以及从面 $f$ 到单元 $V_2$。\n\n1.  **从 $V_1$ 到 $f$ 的通量**：在 $V_1$ 内部、面上的法向导数可以用基于法向距离 $d_{1f}$ 的有限差分来近似。该区域的传导率为 $k_1$。\n    $$F_f \\approx -A_f k_1 \\frac{u_f - u_1}{d_{1f}} = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f)$$\n    在这里，一个正的势差 $(u_1 > u_f)$ 正确地驱动了一个沿 $\\hat{\\boldsymbol{n}}_f$ 方向的正通量。\n\n2.  **从 $f$ 到 $V_2$ 的通量**：类似地，在 $V_2$ 内部、面上的法向导数可以用法向距离 $d_{2f}$ 和传导率 $k_2$ 来近似。\n    $$F_f \\approx -A_f k_2 \\frac{u_2 - u_f}{d_{2f}} = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\n    在这里，一个正的势差 $(u_f > u_2)$ 正确地驱动了一个从面进入 $V_2$ 的正通量。\n\n对于面上没有源或汇的稳态扩散，通量必须是连续的。因此，我们将 $F_f$ 的两个表达式相等：\n$$A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\n我们可以消去面面积 $A_f$ 并求解未知的面势 $u_f$：\n$$\\frac{k_1}{d_{1f}} u_1 - \\frac{k_1}{d_{1f}} u_f = \\frac{k_2}{d_{2f}} u_f - \\frac{k_2}{d_{2f}} u_2$$\n$$\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 = u_f \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right)$$\n$$u_f = \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\n这表明 $u_f$ 是 $u_1$ 和 $u_2$ 的加权平均，权重是“半传导率” $\\frac{k_1}{d_{1f}}$ 和 $\\frac{k_2}{d_{2f}}$。\n\n现在，我们将这个 $u_f$ 的表达式代入其中一个通量方程（例如，第一个），以消除中间变量 $u_f$，从而获得一个仅用 $u_1$ 和 $u_2$ 表示的通量表达式。\n$$F_f = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_1}{d_{1f}} \\left( u_1 - \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right)$$\n为了简化括号中的项：\n$$u_1 - u_f = \\frac{u_1 \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right) - \\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 \\right)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\n分子简化为：\n$$\\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_1 \\right) - \\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 \\right) = \\frac{k_2}{d_{2f}}(u_1 - u_2)$$\n将此代回 $F_f$ 的表达式中：\n$$F_f = A_f \\frac{k_1}{d_{1f}} \\left( \\frac{\\frac{k_2}{d_{2f}}(u_1 - u_2)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) (u_1 - u_2)$$\n乘以 $(u_1 - u_2)$ 的项就是传导率 $T_f$：\n$$T_f = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1 d_{2f} + k_2 d_{1f}}{d_{1f} d_{2f}}} \\right)$$\n简化此表达式可得到对称传导率的最终形式：\n$$T_f = \\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}$$\n这个表达式对于交换下标 1 和 2 是对称的。如果我们交换 $k_1 \\leftrightarrow k_2$ 和 $d_{1f} \\leftrightarrow d_{2f}$，表达式保持不变。这确保了系统矩阵中相应的非对角线元素相等，从而得到一个对称算子。这个结果也可以解释为两个串联热阻之和的倒数，$T_f = \\left(\\frac{d_{1f}}{k_1 A_f} + \\frac{d_{2f}}{k_2 A_f}\\right)^{-1}$，这是由面积 $A_f$ 缩放的半单元传导率的调和平均值。", "answer": "$$\\boxed{\\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}}$$", "id": "3579382"}, {"introduction": "在掌握了内部交界面上的通量近似之后，最后一个关键步骤是处理区域边界。本练习深入探讨了在一维以单元为中心的格式中施加狄利克雷（Dirichlet）边界条件的两种常用技术：“虚拟单元”法和“罚”方法 [@problem_id:3579306]。除了推导过程，本练习还鼓励对最终线性系统的性质进行更深入的分析，例如对称性和条件数，这些性质直接影响数值求解器的效率和稳健性。", "problem": "考虑稳态一维扩散方程 $- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d} u}{\\mathrm{d}x} \\right) = f(x)$，该方程定义在区间 $[0, L]$ 上，其中电导率 $\\kappa > 0$ 为常数，边界条件为狄利克雷（Dirichlet）边界条件 $u(0) = u_{L}$ 和 $u(L) = u_{R}$。使用均匀的、以单元为中心的有限体积离散化方法，该方法包含 $N$ 个宽度为 $h = L/N$ 的控制体，单元中心位于 $x_{i} = \\left(i - \\frac{1}{2}\\right) h$，$i = 1, \\dots, N$。以单元为中心的未知量为 $u_{i} \\approx u(x_{i})$。\n\n1. 从每个控制体上的通量平衡和面法向梯度的二阶中心近似出发，推导内部单元的离散方程。然后，对于与左边界相邻的单元，展示如何通过两种不同的方法来施加狄利克雷边界条件：\n   - 虚拟单元法：在 $x_{0} = -\\frac{h}{2}$ 和 $x_{N+1} = L + \\frac{h}{2}$ 处引入带有未知量 $u_{0}$ 和 $u_{N+1}$ 的虚拟单元中心。使用跨边界的线性重构来强制施加 $u(0) = u_{L}$ 和 $u(L) = u_{R}$，并推导 $u_{0}$ 和 $u_{N+1}$ 关于 $u_{1}$、$u_{N}$、$u_{L}$ 和 $u_{R}$ 的显式表达式。利用这些关系，写出第一个和最后一个控制体的离散方程，并指出这些行中得到的矩阵模板。\n   - 罚函数法：不引入虚拟未知量，用形如 $\\frac{\\alpha}{h} (u_{1} - u_{L})$ 和 $\\frac{\\alpha}{h} (u_{N} - u_{R})$ 的罚项来增广第一个和最后一个控制体的残差，其中 $\\alpha > 0$ 是一个罚参数。推导这些罚项对离散矩阵和右端项引入的修正。\n\n2. 分析并比较这两种方法对离散线性系统矩阵的对称性及其作为 $N$ 和 $h$ 的函数的条件数的影响。特别地，讨论每种方法是否产生对称正定矩阵，以及在固定 $\\kappa$ 和固定 $\\alpha$ 的情况下，每种方法的谱条件数如何随 $N$ 变化。\n\n你的最终答案必须是关于左侧虚拟单元值 $u_{0}$ 的一个封闭形式解析表达式，用相邻的单元中心未知量 $u_{1}$ 和给定的狄利克雷边界值 $u_{L}$ 来表示。无需进行数值取整。", "solution": "该问题要求推导和分析两种不同的有限体积方法，用于实现一维稳态扩散方程的狄利克雷边界条件。\n\n控制方程为：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\kappa \\frac{\\mathrm{d} u}{\\mathrm{d}x} \\right) = f(x) \\quad \\text{for } x \\in [0, L]\n$$\n其中电导率 $\\kappa > 0$ 为常数，边界条件为 $u(0) = u_{L}$ 和 $u(L) = u_{R}$。\n\n区域被离散为 $N$ 个均匀的控制体（单元）$V_i$，每个宽度为 $h = L/N$。单元中心位于 $x_{i} = \\left(i - \\frac{1}{2}\\right) h$，$i = 1, \\dots, N$。因此，未知量 $u_i \\approx u(x_i)$ 的控制体 $V_i$ 是区间 $[(i-1)h, ih]$。单元 $V_i$ 的面位于 $x_{i-1/2} = (i-1)h$ 和 $x_{i+1/2} = ih$。通量定义为 $F(x) = -\\kappa \\frac{\\mathrm{d}u}{\\mathrm{d}x}$。\n\n### 1. 离散方程的推导\n\n**内部单元**\n\n我们对一个通用的内部控制体 $V_i = [x_{i-1/2}, x_{i+1/2}]$（$i=2, \\dots, N-1$）积分控制方程：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} - \\frac{\\mathrm{d}F}{\\mathrm{d}x} \\mathrm{d}x = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) \\mathrm{d}x\n$$\n对左侧应用微积分基本定理，得到通量平衡方程：\n$$\nF(x_{i+1/2}) - F(x_{i-1/2}) = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) \\mathrm{d}x \\approx f(x_i) h\n$$\n其中源项使用中点法则进行近似，记为 $f_i = f(x_i)$。\n\n题目指定对单元面上的梯度使用二阶中心近似。在面 $x_{i+1/2}$（单元中心 $x_i$ 和 $x_{i+1}$ 之间的中点）处的梯度近似为：\n$$\n\\left. \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\right|_{x_{i+1/2}} \\approx \\frac{u_{i+1} - u_i}{x_{i+1} - x_i} = \\frac{u_{i+1} - u_i}{h}\n$$\n那么面上的通量近似为：\n$$\nF(x_{i+1/2}) \\approx -\\kappa \\frac{u_{i+1} - u_i}{h} \\quad \\text{和} \\quad F(x_{i-1/2}) \\approx -\\kappa \\frac{u_{i} - u_{i-1}}{h}\n$$\n将这些代入通量平衡方程，得到内部单元的离散方程：\n$$\n-\\kappa \\frac{u_{i+1} - u_i}{h} - \\left(-\\kappa \\frac{u_i - u_{i-1}}{h}\\right) = f_i h\n$$\n$$\n\\frac{\\kappa}{h} (-u_{i-1} + 2u_i - u_{i+1}) = f_i h\n$$\n这就得到了线性系统矩阵内部各行著名的中心差分模板 $[-\\kappa, 2\\kappa, -\\kappa]$（按 $1/h$ 缩放）。\n\n**虚拟单元法**\n\n对于与边界相邻的单元，我们引入虚拟单元。对于单元 $V_1 = [0, h]$，在 $x_0 = -h/2$ 处放置一个虚拟单元中心。对于单元 $V_N = [(N-1)h, L]$，在 $x_{N+1} = L+h/2$ 处放置一个虚拟单元中心。\n\n对于第一个单元（$i=1$），通量平衡为 $F(x_{3/2}) - F(x_{1/2}) = f_1 h$。\n右侧通量为 $F(x_{3/2}) \\approx -\\kappa \\frac{u_2 - u_1}{h}$。\n在边界 $x_{1/2}=0$ 处的左侧通量使用虚拟单元未知量 $u_0$ 进行近似：\n$$\nF(x_{1/2}) = F(0) \\approx -\\kappa \\frac{u_1 - u_0}{x_1 - x_0} = -\\kappa \\frac{u_1 - u_0}{h}\n$$\n单元1的离散方程是：\n$$\n-\\kappa \\frac{u_2 - u_1}{h} - \\left(-\\kappa \\frac{u_1 - u_0}{h} \\right) = f_1 h \\implies \\frac{\\kappa}{h} (-u_0 + 2u_1 - u_2) = f_1 h\n$$\n狄利克雷边界条件 $u(0)=u_L$ 通过线性重构来施加。由于边界 $x=0$ 是单元中心 $x_1=h/2$ 和虚拟单元中心 $x_0=-h/2$ 之间的中点，线性插值得到 $u(0) \\approx \\frac{u_0 + u_1}{2}$。将其设为边界值：\n$$\n\\frac{u_0 + u_1}{2} = u_L \\implies u_0 = 2u_L - u_1\n$$\n将 $u_0$ 的这个表达式代入单元1的离散方程中：\n$$\n\\frac{\\kappa}{h} (-(2u_L - u_1) + 2u_1 - u_2) = f_1 h \\implies \\frac{\\kappa}{h} (3u_1 - u_2) = f_1 h + \\frac{2\\kappa}{h} u_L\n$$\n类似地，对于最后一个单元（$i=N$），我们得到 $u_{N+1} = 2u_R - u_N$，离散方程变为：\n$$\n\\frac{\\kappa}{h} (-u_{N-1} + 3u_N) = f_N h + \\frac{2\\kappa}{h} u_R\n$$\n得到的第一行的矩阵模板是 $[\\frac{3\\kappa}{h}, -\\frac{\\kappa}{h}, 0, \\dots]$，最后一行的矩阵模板是 $[\\dots, 0, -\\frac{\\kappa}{h}, \\frac{3\\kappa}{h}]$。\n\n**罚函数法**\n\n这种方法避免了使用虚拟单元。我们从一个基础离散系统开始，并对其进行增广。一个自然的基础系统是假设边界处通量为零（齐次诺伊曼条件）的系统，其矩阵是对称的。单元1的基础方程（假设 $F(0)=0$）是 $F(x_{3/2}) - 0 = f_1 h$，这给出 $\\frac{\\kappa}{h}(u_1 - u_2) = f_1 h$。该方程的残差为 $R_1 = \\frac{\\kappa}{h}(u_1 - u_2) - f_1 h$。\n用罚项 $\\frac{\\alpha}{h}(u_1-u_L)$（其中 $\\alpha > 0$）来增广该残差。将增广后的残差设为零：\n$$\n\\frac{\\kappa}{h}(u_1 - u_2) - f_1 h + \\frac{\\alpha}{h}(u_1 - u_L) = 0\n$$\n$$\n\\left(\\frac{\\kappa+\\alpha}{h}\\right)u_1 - \\frac{\\kappa}{h}u_2 = f_1 h + \\frac{\\alpha}{h}u_L\n$$\n这修正了线性系统的第一行。矩阵对角线项变为 $A_{11} = \\frac{\\kappa+\\alpha}{h}$，右端项增加了 $\\frac{\\alpha}{h}u_L$。\n对于最后一个单元（$i=N$），类似的推导得出：\n$$\n-\\frac{\\kappa}{h}u_{N-1} + \\left(\\frac{\\kappa+\\alpha}{h}\\right)u_N = f_N h + \\frac{\\alpha}{h}u_R\n$$\n这将项 $A_{NN}$ 修正为 $\\frac{\\kappa+\\alpha}{h}$，并增广了右端项。\n\n### 2. 分析与比较\n\n**系统矩阵的对称性**\n- **虚拟单元法：** 矩阵 $A_{gc}$ 是三对角的。内部行的模板为 $\\frac{\\kappa}{h}[-1, 2, -1]$。第一行为 $[\\frac{3\\kappa}{h}, -\\frac{\\kappa}{h}, \\dots]$，第二行为 $[-\\frac{\\kappa}{h}, \\frac{2\\kappa}{h}, \\dots]$。由于 $A_{12} = A_{21} = -\\frac{\\kappa}{h}$，且所有非对角线项都类似，该矩阵是**对称的**。\n- **罚函数法：** 矩阵 $A_p$ 也是三对角的。内部模板为 $\\frac{1}{h}[-\\kappa, 2\\kappa, -\\kappa]$。第一行为 $[\\frac{\\kappa+\\alpha}{h}, -\\frac{\\kappa}{h}, \\dots]$。第二行以 $[-\\frac{\\kappa}{h}, \\frac{2\\kappa}{h}, \\dots]$ 开始。由于 $A_{12} = A_{21} = -\\frac{\\kappa}{h}$，这个矩阵也是**对称的**。\n\n**正定性**\n如果对于所有非零向量 $\\mathbf{v}$，二次型 $\\mathbf{v}^T A \\mathbf{v} > 0$，则该对称矩阵是正定的。\n- **虚拟单元法：** 矩阵部分的二次型（按 $h/\\kappa$ 缩放）可以表示为 $\\mathbf{v}^T A_{gc} \\mathbf{v} \\propto v_1^2 + (v_1-v_2)^2 + \\dots + (v_{N-1}-v_N)^2 + v_N^2$。这是一个平方和，仅当所有 $v_i=0$ 时才为零。因此，该矩阵是**对称正定的（SPD）**。\n- **罚函数法：** 二次型 $\\mathbf{v}^T A_p \\mathbf{v}$ 可以表示为 $\\frac{1}{h} \\left[ \\kappa \\sum_{i=1}^{N-1} (v_i-v_{i+1})^2 + \\alpha(v_1^2+v_N^2) \\right]$。由于 $\\kappa > 0$ 和 $\\alpha > 0$，这是一个非负项的和。它仅当所有项都为零时才为零，这意味着 $v_1=\\dots=v_N=0$。因此，该矩阵也是**对称正定的（SPD）**。\n\n**条件数**\n谱条件数为 $\\text{cond}(A) = \\lambda_{max}/\\lambda_{min}$。我们分析其在 $N \\to \\infty$（$h \\to 0$）时的阶。\n- **虚拟单元法：** 该矩阵是标准离散一维拉普拉斯算子的低秩扰动。对于这类矩阵，最小特征值的行为是 $\\lambda_{min} \\sim O(h^2)$，而最大特征值的行为是 $\\lambda_{max} \\sim O(1)$（对于未缩放的矩阵）。因此，条件数的变化阶数为：\n$$\n\\text{cond}(A_{gc}) \\sim \\frac{O(1)}{O(h^2)} = O(h^{-2}) = O(N^2)\n$$\n这种随网格点数呈二次方变化的阶数对于二阶椭圆方程的二阶精确离散格式是典型的。\n\n- **罚函数法：** 对于一个固定的罚参数 $\\alpha$，分析有所不同。该矩阵可以看作是诺伊曼问题的离散化，在边界上受到罚项的扰动。诺伊曼问题的最小特征值为零。罚项使这个特征值偏离零。罚函数矩阵 $A_p$ 的最小特征值可以被证明有一个与 $h$ 无关的常数下界，因此对于未缩放的矩阵，$\\lambda_{min} \\sim O(h)$。最大特征值为 $\\lambda_{max} \\sim O(1)$。因此，条件数的变化阶数为：\n$$\n\\text{cond}(A_p) = \\text{cond}(A_p) \\sim \\frac{O(1)}{O(h)} = O(h^{-1}) = O(N)\n$$\n对于固定的 $\\alpha$，罚函数法导致条件数随 $N$ 呈线性变化，这优于虚拟单元法的二次方变化。然而，罚函数法的精度取决于 $\\alpha$ 的选择，一个非常大的 $\\alpha$（例如 $\\alpha \\sim 1/h$）将恢复 $O(N^2)$ 的条件数。\n\n总之，两种方法都产生对称正定（SPD）矩阵。罚函数法（对于固定的 $\\alpha$）比虚拟单元法提供更好的条件数特性。\n\n左侧虚拟单元值 $u_0$ 的具体表达式由边界 $x=0$ 处的线性重构推导得出。\n$$\nu(0) = u_L \\approx \\frac{u(x_0) + u(x_1)}{2} = \\frac{u_0 + u_1}{2}\n$$\n解出 $u_0$ 可得：\n$$\nu_0 = 2u_L - u_1\n$$", "answer": "$$\n\\boxed{2 u_{L} - u_{1}}\n$$", "id": "3579306"}]}