{"hands_on_practices": [{"introduction": "掌握数值通量的第一步是理解迎风格式。对于双曲守恒律，信息沿特征线单向传播，一个稳定的数值格式必须尊重这一物理特性。本练习 ([@problem_id:3611967]) 将指导你为最简单的线性平流方程推导迎风通量，这是构建更复杂数值方法的基石。", "problem": "考虑均匀介质中被动示踪剂的一维线性平流，其模型为守恒律 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。在一个有限体积法 (FVM) 中，使用均匀网格，其单元中心为 $x_{i}$，单元界面为 $x_{i \\pm 1/2}$，单元宽度 $\\Delta x > 0$，时间步长 $\\Delta t > 0$ 为常数。将时间层 $n$ 时单元 $i$ 内的单元平均值记为 $\\bar{u}_{i}^{n}$。从守恒律的积分形式和跨单元界面的数值通量的定义出发，用相容的数值通量 $F_{i \\pm 1/2}^{n}$ 来推导 $\\bar{u}_{i}^{n+1}$ 的单步有限体积更新格式。然后，通过分析单元界面处的局部黎曼问题，并施加与 $a$ 符号一致的迎风格式，得到界面数值通量 $F_{i+1/2}^{n}$ 的一个不依赖于分段讨论的单一闭式解析表达式。你的最终答案需要用 $a$、$\\bar{u}_{i}^{n}$ 和 $\\bar{u}_{i+1}^{n}$ 明确表示。无需进行数值计算，也无需四舍五入。在推导过程中需给出有限体积更新格式，但最终答案只报告所要求的界面通量表达式。", "solution": "出发点是守恒律 $u_{t} + (f(u))_{x} = 0$，其中对于恒定的平流速度 $a$，物理通量为 $f(u) = a\\,u$。在一个控制体积（单元）$I_{i} = [x_{i-1/2}, x_{i+1/2}]$ 上积分，并使用微积分基本定理，我们得到\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,\\mathrm{d}x\\right) + \\frac{1}{\\Delta x}\\left(f(u(x_{i+1/2},t)) - f(u(x_{i-1/2},t))\\right) = 0.\n$$\n\n定义单元平均值 $\\bar{u}_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,\\mathrm{d}x$，并用相容的数值通量 $F_{i\\pm 1/2}(t)$ 替换物理界面通量，我们有\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\bar{u}_{i}(t) + \\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right) = 0.\n$$\n\n采用一阶精度的显式时间离散（例如，前向欧拉法）可得\n\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\n\n剩下的问题是确定一个相容的、单调的数值通量 $F_{i+1/2}^{n}$，该通量能根据 $a$ 的符号实现迎风格式。\n\n对于线性平流，在界面 $x_{i+1/2}$ 处的局部黎曼问题，其左状态为 $u_{L} = \\bar{u}_{i}^{n}$，右状态为 $u_{R} = \\bar{u}_{i+1}^{n}$，信息以速度 $a$ 传播。精确解是自相似的，并且沿着特征线 $x - a t = \\text{const}$ 是常数。因此，在 $x_{i+1/2}$ 处的界面状态 $u^{*}$ 为\n\n$$\nu^{*} =\n\\begin{cases}\nu_{L}, & \\text{if } a > 0, \\\\\nu_{R}, & \\text{if } a < 0,\n\\end{cases}\n$$\n\n相应的物理通量为 $f(u^{*}) = a\\,u^{*}$。这是标准的迎风选择，可以使用通量分裂的方法来书写，从而避免显式的分情况讨论。定义平流速度的正部和负部，\n\n$$\na^{+} = \\frac{1}{2}\\left(a + |a|\\right), \\qquad a^{-} = \\frac{1}{2}\\left(a - |a|\\right),\n$$\n\n使得 $a = a^{+} + a^{-}$ 且 $a^{+} \\ge 0$, $a^{-} \\le 0$。当 $a \\ge 0$ 时，$a^{+} = a$ 且 $a^{-} = 0$；当 $a \\le 0$ 时，$a^{+} = 0$ 且 $a^{-} = a$。那么，线性平流的 Godunov 迎风通量可以表示为\n\n$$\nF_{i+1/2}^{n} = a^{+}\\,\\bar{u}_{i}^{n} + a^{-}\\,\\bar{u}_{i+1}^{n}.\n$$\n\n消去 $a^{+}$ 和 $a^{-}$，可以得到一个用 $a$、$\\bar{u}_{i}^{n}$ 和 $\\bar{u}_{i+1}^{n}$ 表示的单一闭式解析表达式：\n\n$$\nF_{i+1/2}^{n} = \\frac{1}{2}\\left[a\\left(\\bar{u}_{i}^{n} + \\bar{u}_{i+1}^{n}\\right) - |a|\\left(\\bar{u}_{i+1}^{n} - \\bar{u}_{i}^{n}\\right)\\right].\n$$\n\n该表达式与物理通量 $f(u) = a\\,u$ 相容，是单调的，并且再现了正确的迎风选择：如果 $a > 0$，则 $|a| = a$，于是 $F_{i+1/2}^{n} = a\\,\\bar{u}_{i}^{n}$；如果 $a  0$，则 $|a| = -a$，于是 $F_{i+1/2}^{n} = a\\,\\bar{u}_{i+1}^{n}$。因此，所需的有限体积更新格式为\n\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right),\n$$\n\n其中界面 $x_{i+1/2}$ 处的迎风数值通量由上面推导出的闭式表达式给出。", "answer": "$$\\boxed{\\frac{1}{2}\\left[a\\left(\\bar{u}_{i}^{n} + \\bar{u}_{i+1}^{n}\\right) - |a|\\left(\\bar{u}_{i+1}^{n} - \\bar{u}_{i}^{n}\\right)\\right]}$$", "id": "3611967"}, {"introduction": "现实世界中的地球物理流动通常是高度非线性的，会导致激波等复杂现象。本练习 ([@problem_id:3612032]) 采用经典的伯格斯方程（Burgers' equation）作为模型，要求你求解一个黎曼问题并确定相应的戈杜诺夫（Godunov）通量。通过这个过程，你将实践如何将激波的物理准则（如Rankine–Hugoniot条件和熵条件）应用于数值计算中。", "problem": "考虑一维无粘伯格斯方程，这是一个用于模拟计算地球物理学中平流输运的典型非线性守恒律，\n$$\nu_{t} + f(u)_{x} = 0,\n$$\n其通量函数为\n$$\nf(u) = \\frac{u^{2}}{2}.\n$$\n在有限体积法 (FVM) 中，戈杜诺夫方法的界面数值通量通过在界面处（即 $x/t = 0$）由精确自相似黎曼解所选状态下的物理通量值来定义。对于具有初始数据\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x  0,\n\\end{cases}\n$$\n的黎曼问题，设 $u_{L} = 2$ 且 $u_{R} = 0$。仅使用基本守恒定律、由朗肯–雨果尼奥条件定义的激波速度，以及严格凸通量中非线性波的熵可采纳条件，确定精确的波类型并计算相应的戈杜诺夫数值通量\n$$\nF(u_{L},u_{R})\n$$\n在界面处的值。最终答案仅报告 $F(u_{L},u_{R})$ 的值，表示为一个无单位、不进行四舍五入的实数。", "solution": "该问题要求计算无粘伯格斯方程的戈杜诺夫数值通量 $F(u_{L}, u_{R})$，这是一个形式为 $u_{t} + (f(u))_{x} = 0$ 的非线性守恒律，其通量函数为 $f(u) = \\frac{u^{2}}{2}$。初始数据是一个黎曼问题，其中 $u_{L} = 2$ 且 $u_{R} = 0$。\n\n首先，我们分析通量函数的性质。通量 $f(u) = \\frac{u^{2}}{2}$ 是严格凸的，因为它的二阶导数对于所有 $u$ 都满足 $f''(u) = 1  0$。信息的特征传播速度由 $a(u) = f'(u) = u$ 给出。\n\n黎曼问题的解取决于左右两个状态的特征速度 $a(u_{L})$ 和 $a(u_{R})$ 之间的关系。\n对于给定的状态 $u_{L}=2$ 和 $u_{R}=0$：\n-   左侧的特征速度为 $a(u_{L}) = u_{L} = 2$。\n-   右侧的特征速度为 $a(u_{R}) = u_{R} = 0$。\n\n由于 $a(u_{L})  a(u_{R})$（具体来说，$2  0$），特征线是汇聚的。这表明解将包含一个间断，即一个激波。解不是光滑的稀疏波，稀疏波会在 $a(u_{L})  a(u_{R})$ 的情况下出现。\n\n这个激波的速度，记为 $s$，由朗肯-雨果尼奥条件确定，该条件表达了跨越间断的守恒律：\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\n代入给定值和通量函数：\n$$\ns = \\frac{f(0) - f(2)}{0 - 2} = \\frac{\\frac{0^{2}}{2} - \\frac{2^{2}}{2}}{-2} = \\frac{0 - 2}{-2} = 1\n$$\n激波的速度为 $s=1$。\n\n为了使激波在物理上是可采纳的，它必须满足熵条件。对于严格凸通量，这是拉克斯熵条件，它要求特征线必须从两侧进入激波：\n$$\na(u_{L})  s  a(u_{R})\n$$\n代入我们已有的值：\n$$\nu_{L}  s  u_{R}\n$$\n$$\n2  1  0\n$$\n条件得到满足。因此，该黎曼问题的解是一个以速度 $s=1$ 传播的单一、稳定的激波。\n\n黎曼问题的解 $u(x,t)$ 是自相似变量 $\\xi = x/t$ 的函数。对于单个激波，解是分段常数：\n$$\nu(x,t) = u(\\xi) = \\begin{cases} u_{L}  \\text{if } \\xi  s \\\\ u_{R}  \\text{if } \\xi  s \\end{cases}\n$$\n代入我们的 $u_L$、$u_R$ 和 $s$ 的值：\n$$\nu(x,t) = u(x/t) = \\begin{cases} 2  \\text{if } x/t  1 \\\\ 0  \\text{if } x/t  1 \\end{cases}\n$$\n戈杜诺夫数值通量 $F(u_{L}, u_{R})$ 定义为在单元界面处（对应于位置 $x = 0$）的状态下物理通量的值。在自相似平面中，这是直线 $\\xi = x/t = 0$。\n\n我们必须确定在 $\\xi = 0$ 处的状态 $u$。根据上面的解结构，由于 $0  1$，$\\xi = 0$ 的值落在 $\\xi  s$ 的区域内。因此，界面处的状态是 $u(x/t = 0) = u_{L} = 2$。\n\n戈杜诺夫数值通量就是在此状态下计算的物理通量：\n$$\nF(u_{L}, u_{R}) = f(u(x/t=0)) = f(u_{L}) = f(2)\n$$\n使用通量函数的定义，我们计算最终值：\n$$\nF(u_{L}, u_{R}) = \\frac{2^{2}}{2} = \\frac{4}{2} = 2\n$$\n因此，对于给定的黎曼问题，戈杜诺夫数值通量为 $2$。", "answer": "$$\\boxed{2}$$", "id": "3612032"}, {"introduction": "一阶格式虽然稳定但数值耗散过大，会抹平解的尖锐特征。为了在不引入非物理解振荡的前提下提高精度，总变差减小（Total Variation Diminishing, TVD）的MUSCL方法被广泛使用。本练习 ([@problem_id:3611977]) 让你通过具体计算和比较不同的通量限制器（如minmod, Superbee, 和MC），来量化地理解它们在抑制振荡与减少耗散之间的权衡。", "problem": "考虑含沙水流中被动标量浓度的一维线性平流，其模型为守恒律 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数。在间距为 $\\Delta x$ 的均匀网格上，一个有限体积格式通过界面数值通量 $F_{i\\pm 1/2}$ 来推进单元平均值 $\\bar{u}_{i}$，这些通量由每个单元内的分段线性重构构建。在守恒律单调上游中心格式 (Monotone Upstream-centered Schemes for Conservation Laws, MUSCL) 框架中，单元 $i$ 内的重构使用一个受限斜率 $s_{i}$ 来定义右侧界面上的左状态，$u_{i+1/2}^{-} = \\bar{u}_{i} + \\frac{1}{2}s_{i}$，然后将其提供给 $a0$ 的迎风通量。为了强制实现总变差递减 (Total Variation Diminishing, TVD) 特性，$s_{i}$ 是通过对单边差分 $\\Delta_{i-1/2} = \\bar{u}_{i} - \\bar{u}_{i-1}$ 和 $\\Delta_{i+1/2} = \\bar{u}_{i+1} - \\bar{u}_{i}$ 应用一个限制器得到的。\n\n给定单元平均值为 $\\{\\bar{u}_{i-1},\\,\\bar{u}_{i},\\,\\bar{u}_{i+1}\\} = \\{1.0,\\,1.2,\\,1.5\\}$。使用 minmod、Superbee 和单调中心 (Monotonized Central, MC) 限制器的标准定义，计算每个限制器在单元 $i$ 中的受限斜率 $s_{i}$。然后，定义无量纲数值耗散指数 $I = 1 - \\frac{s_{i}}{\\Delta_{i+1/2}}$，该指数用于量化因限制而被移除的未受限前向差分 $\\Delta_{i+1/2}$ 的比例。在此单元中，评估 minmod、MC 和 Superbee 限制器的 $I$ 值，并按 (minmod, MC, Superbee) 的顺序将这三个值以单行矩阵的形式报告。无需四舍五入；将最终值表示为精确分数。答案是无量纲的，应不带单位给出。", "solution": "该问题在科学上和数学上是适定的，提供了足够的信息来确定所要求的量。我们的任务是计算在守恒律单调上游中心格式 (MUSCL) 框架中使用的三种标准总变差递减 (TVD) 限制器的无量纲数值耗散指数 $I$。\n\n单元 $i$ 中的受限斜率，记为 $s_i$，是由后向差分 $\\Delta_{i-1/2}$ 和前向差分 $\\Delta_{i+1/2}$ 构建的。它们的定义如下：\n$$ \\Delta_{i-1/2} = \\bar{u}_{i} - \\bar{u}_{i-1} $$\n$$ \\Delta_{i+1/2} = \\bar{u}_{i+1} - \\bar{u}_{i} $$\n其中 $\\bar{u}_{i-1}$、$\\bar{u}_{i}$ 和 $\\bar{u}_{i+1}$ 是单元平均浓度。\n\n给定单元平均值为 $\\{\\bar{u}_{i-1},\\,\\bar{u}_{i},\\,\\bar{u}_{i+1}\\} = \\{1.0,\\,1.2,\\,1.5\\}$。\n首先，我们计算单边差分：\n$$ \\Delta_{i-1/2} = 1.2 - 1.0 = 0.2 $$\n$$ \\Delta_{i+1/2} = 1.5 - 1.2 = 0.3 $$\n由于两个差分都为正，局部数据是单调的，我们不在极值点附近。\n\n受限斜率 $s_i$ 是这两个差分的函数。无量纲数值耗散指数定义为：\n$$ I = 1 - \\frac{s_{i}}{\\Delta_{i+1/2}} $$\n我们现在将为三种指定的限制器中的每一种计算斜率 $s_i$ 和指数 $I$。\n\n1.  **Minmod 限制器**\n    minmod 限制器定义为：\n    $$ \\text{minmod}(a, b) = \\begin{cases} \\min(a, b)  \\text{if } a  0, b  0 \\\\ \\max(a, b)  \\text{if } a  0, b  0 \\\\ 0  \\text{if } ab \\le 0 \\end{cases} $$\n    受限斜率为 $s_{i}^{\\text{minmod}} = \\text{minmod}(\\Delta_{i-1/2}, \\Delta_{i+1/2})$。\n    当 $\\Delta_{i-1/2} = 0.2$ 和 $\\Delta_{i+1/2} = 0.3$ 时，两者都为正，我们有：\n    $$ s_{i}^{\\text{minmod}} = \\min(0.2, 0.3) = 0.2 $$\n    minmod 限制器的耗散指数为：\n    $$ I_{\\text{minmod}} = 1 - \\frac{s_{i}^{\\text{minmod}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.2}{0.3} = 1 - \\frac{2}{3} = \\frac{1}{3} $$\n\n2.  **单调中心 (MC) 限制器**\n    单调中心（或 van Leer）限制器在我们这里的斜率计算中定义为：\n    $$ s_{i}^{\\text{MC}} = \\text{minmod}(2\\Delta_{i-1/2}, \\frac{1}{2}(\\Delta_{i-1/2} + \\Delta_{i+1/2}), 2\\Delta_{i+1/2}) $$\n    由于所有参数都将是正的，minmod 函数简化为取其参数的最小值。\n    参数为：\n    $2\\Delta_{i-1/2} = 2 \\times 0.2 = 0.4$\n    $\\frac{1}{2}(\\Delta_{i-1/2} + \\Delta_{i+1/2}) = \\frac{1}{2}(0.2 + 0.3) = \\frac{0.5}{2} = 0.25$\n    $2\\Delta_{i+1/2} = 2 \\times 0.3 = 0.6$\n    受限斜率是这些值的最小值：\n    $$ s_{i}^{\\text{MC}} = \\min(0.4, 0.25, 0.6) = 0.25 $$\n    MC 限制器的耗散指数为：\n    $$ I_{\\text{MC}} = 1 - \\frac{s_{i}^{\\text{MC}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.25}{0.3} = 1 - \\frac{25}{30} = 1 - \\frac{5}{6} = \\frac{1}{6} $$\n\n3.  **Superbee 限制器**\n    Superbee 限制器定义为：\n    $$ s_{i}^{\\text{Superbee}} = \\max(\\text{minmod}(2\\Delta_{i-1/2}, \\Delta_{i+1/2}), \\text{minmod}(\\Delta_{i-1/2}, 2\\Delta_{i+1/2})) $$\n    由于所有参数都为正，这可以简化为：\n    $$ s_{i}^{\\text{Superbee}} = \\max(\\min(2\\Delta_{i-1/2}, \\Delta_{i+1/2}), \\min(\\Delta_{i-1/2}, 2\\Delta_{i+1/2})) $$\n    我们计算内部项：\n    $\\min(2\\Delta_{i-1/2}, \\Delta_{i+1/2}) = \\min(2 \\times 0.2, 0.3) = \\min(0.4, 0.3) = 0.3$\n    $\\min(\\Delta_{i-1/2}, 2\\Delta_{i+1/2}) = \\min(0.2, 2 \\times 0.3) = \\min(0.2, 0.6) = 0.2$\n    受限斜率是这两个结果的最大值：\n    $$ s_{i}^{\\text{Superbee}} = \\max(0.3, 0.2) = 0.3 $$\n    Superbee 限制器的耗散指数为：\n    $$ I_{\\text{Superbee}} = 1 - \\frac{s_{i}^{\\text{Superbee}}}{\\Delta_{i+1/2}} = 1 - \\frac{0.3}{0.3} = 1 - 1 = 0 $$\n\nminmod、MC 和 Superbee 限制器的耗散指数 $I$ 的值分别为 $\\frac{1}{3}$、$\\frac{1}{6}$ 和 $0$。问题要求将这些值以单行矩阵的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3}  \\frac{1}{6}  0\n\\end{pmatrix}\n}\n$$", "id": "3611977"}]}