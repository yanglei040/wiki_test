{"hands_on_practices": [{"introduction": "为了有效地使用有限差分法，我们必须首先理解其局限性。截断误差的概念量化了离散算子对连续导数的逼近程度。第一个练习 [@problem_id:3593422] 提供了一个基础训练，要求你使用泰勒级数分析，从第一性原理出发推导此误差，从而揭示中心差分格式为何具有二阶精度。", "problem": "在计算地球物理学中，材料属性的空间梯度通常使用有限差分在均匀网格上进行估计。设一维剖面上的标量场 $f(x)$ 在等间距点 $x_i$ 上采样，网格间距为 $h>0$，并假设 $f\\in C^{5}$ 在包含 $x_i$ 的区间上成立。考虑在 $x_i$ 处的空间导数的中心差分近似，其定义为\n$$\nD_{c}f(x_i) \\equiv \\frac{f(x_i+h)-f(x_i-h)}{2h}.\n$$\n从关于 $x_i$ 的泰勒定理出发，并仅使用所述的光滑性假设，推导 $D_c f(x_i)$ 的主阶截断误差，形式为关于 $h$ 的幂的渐近级数。然后，在该截断误差中，识别并计算乘以 $h^{2}$ 的显式系数，用 $f^{(3)}(x_i)$ 表示。请以单一闭式解析表达式的形式给出最终答案。无需四舍五入。", "solution": "该问题要求推导一阶导数的中心差分近似的截断误差，并确定主阶项的系数。该问题提法恰当，科学上合理，并包含了得到唯一解所需的所有信息。\n\n设标量场表示为 $f(x)$。我们已知 $f(x)$ 在包含目标点 $x_i$ 的区间上是五次连续可微的，即 $f \\in C^5$。网格间距为正常数 $h > 0$。一阶导数的中心差分算子定义为：\n$$\nD_{c}f(x_i) = \\frac{f(x_i+h)-f(x_i-h)}{2h}\n$$\n截断误差我们记为 $\\tau(x_i, h)$，是有限差分算子提供的近似值与导数的精确值 $f'(x_i)$ 之间的差。\n$$\n\\tau(x_i, h) = D_{c}f(x_i) - f'(x_i)\n$$\n为了找到 $\\tau(x_i, h)$ 的表达式，我们使用泰勒定理将函数 $f(x_i+h)$ 和 $f(x_i-h)$ 在点 $x_i$ 附近展开。给定的条件 $f \\in C^5$ 确保了泰勒级数展开是有效的，并且直到五阶的导数都存在且连续。\n\n$f(x_i+h)$ 关于 $x_i$ 的泰勒展开式为：\n$$\nf(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + O(h^5)\n$$\n代入阶乘值，我们得到：\n$$\nf(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + O(h^5)\n$$\n类似地，$f(x_i-h)$ 关于 $x_i$ 的泰勒展开式可以通过将 $h$ 替换为 $-h$ 得到：\n$$\nf(x_i-h) = f(x_i) + (-h) f'(x_i) + \\frac{(-h)^2}{2!} f''(x_i) + \\frac{(-h)^3}{3!} f^{(3)}(x_i) + \\frac{(-h)^4}{4!} f^{(4)}(x_i) + O(h^5)\n$$\n$$\nf(x_i-h) = f(x_i) - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + O(h^5)\n$$\n接下来，我们计算差值 $f(x_i+h) - f(x_i-h)$，以构成中心差分算子的分子：\n$$\nf(x_i+h) - f(x_i-h) = \\left( f(x_i) + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\dots \\right) - \\left( f(x_i) - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\dots \\right)\n$$\n我们按照在 $x_i$ 处求值的相应导数对各项进行分组：\n*   $f(x_i)$: $f(x_i) - f(x_i) = 0$\n*   $f'(x_i)$: $h f'(x_i) - (-h f'(x_i)) = 2h f'(x_i)$\n*   $f''(x_i)$: $\\frac{h^2}{2} f''(x_i) - \\frac{h^2}{2} f''(x_i) = 0$\n*   $f^{(3)}(x_i)$: $\\frac{h^3}{6} f^{(3)}(x_i) - \\left(-\\frac{h^3}{6} f^{(3)}(x_i)\\right) = 2 \\frac{h^3}{6} f^{(3)}(x_i) = \\frac{h^3}{3} f^{(3)}(x_i)$\n\n所有偶数阶导数项都抵消了，而奇数阶导数项则加倍。为了推导渐近级数，我们将其扩展到下一个非零项，该项涉及 $f^{(5)}(x_i)$，其存在性由 $C^5$ 光滑性条件保证。包含 $f^{(5)}(x_i)$ 的项是 $2 \\frac{h^5}{5!} f^{(5)}(x_i) = \\frac{h^5}{60} f^{(5)}(x_i)$。\n\n差值的级数结果是：\n$$\nf(x_i+h) - f(x_i-h) = 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + O(h^7)\n$$\n现在，我们将其代回 $D_c f(x_i)$ 的定义中：\n$$\nD_c f(x_i) = \\frac{1}{2h} \\left( 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + O(h^7) \\right)\n$$\n分配因子 $\\frac{1}{2h}$，我们得到：\n$$\nD_c f(x_i) = f'(x_i) + \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + O(h^6)\n$$\n此表达式表明，中心差分算子近似于真实导数 $f'(x_i)$ 加上一系列关于 $h$ 的偶次幂的误差项。\n\n然后通过减去 $f'(x_i)$ 得到截断误差 $\\tau(x_i, h)$：\n$$\n\\tau(x_i, h) = D_c f(x_i) - f'(x_i) = \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + O(h^6)\n$$\n这就是截断误差的渐近级数。主阶截断误差是该级数中的第一项和最低次幂项，即 $\\frac{h^2}{6} f^{(3)}(x_i)$。该方法的精度阶数是此主阶项中 $h$ 的幂，即 $2$。\n\n问题特别要求截断误差中乘以 $h^2$ 的显式系数。从推导出的 $\\tau(x_i, h)$ 的渐近级数中，包含 $h^2$ 的项是：\n$$\n\\frac{h^2}{6} f^{(3)}(x_i)\n$$\n因此，乘以 $h^2$ 的系数是 $\\frac{1}{6} f^{(3)}(x_i)$。", "answer": "$$\\boxed{\\frac{f^{(3)}(x_i)}{6}}$$", "id": "3593422"}, {"introduction": "在实践中，选择数值算子并不仅仅是为了最大化形式上的精度，它是一种权衡的艺术。更高阶的算子虽然对平滑信号更精确，但也可能危险地放大高频噪声。这个练习 [@problem_id:3593473] 将你置于地震数据分析师的角色，要求你基于傅里叶分析，权衡信号分辨率和噪声稳健性这两个相互竞争的需求，从而选择最优的有限差分算子。", "problem": "一维地震剖面 $s(x)$ 以 $\\Delta x = 10\\,\\mathrm{m}$ 的均匀间距采样。您希望计算沿 $x$ 轴的空间导数 $\\partial s/\\partial x$ 以估计反射层的倾角。已知（通过处理和采集设计）该地震信号是带限的，其空间波数内容在 $k_s = \\frac{\\pi}{2\\Delta x}$ 以上可以忽略不计，这对应于最小波长 $\\lambda_{\\min} = 4\\Delta x = 40\\,\\mathrm{m}$。附加噪声可以建模为平稳白噪声，其频谱在奈奎斯特波数 $k_N = \\frac{\\pi}{\\Delta x}$ 以下是平坦的。\n\n您将使用形式精度阶数为 $p \\in \\{2,4,6,8\\}$ 的中心有限差分格式来近似 $\\partial s/\\partial x$。假设对每个 $p$ 都使用标准的中心反对称格式，并考虑它们通过波数空间中的符号（传递函数）对离散谱的作用。您的目标是在分辨率（对最高信号波数的忠实微分）和稳健性（限制近奈奎斯特噪声的放大）之间取得平衡，并以线性时不变算子的傅里叶分析第一性原理为指导。\n\n在设计中，施加以下两个约束：\n1) 分辨率：在最高相关信号波数 $k_s$ 处，即在 $\\theta_t = k_s \\Delta x = \\frac{\\pi}{2}$ 处，离散导数的幅度响应应在 $10\\%$ 内近似于理想连续导数的幅度 $|k_s|$，也就是说，在 $\\theta_t$ 处的相对误差必须 $\\le 10\\%$。\n2) 稳健性：在噪声主导频带的一个代表性高频点 $\\theta_h = 0.9\\pi$ 处，离散导数算子的幅度必须满足 $|H(\\theta_h)| \\le \\frac{0.75}{\\Delta x}$，以避免过度的噪声放大。\n\n哪种形式精度阶数 $p$ 的选择最能同时满足这两个约束？\n\nA. $p=2$（二阶中心差分）\n\nB. $p=4$（四阶中心差分）\n\nC. $p=6$（六阶中心差分）\n\nD. $p=8$（八阶中心差分）", "solution": "用户希望我验证问题陈述，如果有效，则通过第一性原理推导答案并评估每个选项来解决问题。\n\n### 问题验证\n\n**第 1 步：提取给定条件**\n\n*   地震剖面：$s(x)$，采样间距为 $\\Delta x = 10\\,\\mathrm{m}$。\n*   任务：近似计算空间导数 $\\partial s/\\partial x$。\n*   信号带限：空间波数内容在 $k_s = \\frac{\\pi}{2\\Delta x}$ 以上可忽略不计。这对应于最小波长 $\\lambda_{\\min} = 4\\Delta x = 40\\,\\mathrm{m}$。\n*   噪声模型：平稳白噪声，频谱在奈奎斯特波数 $k_N = \\frac{\\pi}{\\Delta x}$ 以下是平坦的。\n*   近似方法：使用标准中心反对称格式的中心有限差分格式，形式精度阶数为 $p \\in \\{2,4,6,8\\}$。\n*   约束 1 (分辨率)：在目标归一化波数 $\\theta_t = k_s \\Delta x = \\frac{\\pi}{2}$ 处，离散导数幅度响应与理想导数幅度相比的相对误差必须小于或等于 $10\\%$。\n*   约束 2 (稳健性)：在高频归一化波数 $\\theta_h = 0.9\\pi$ 处，离散导数算子的幅度 $|H(\\theta_h)|$ 必须小于或等于 $\\frac{0.75}{\\Delta x}$。\n*   问题：哪种精度阶数 $p$ 最能同时满足这两个约束？\n\n**第 2 步：使用提取的给定条件进行验证**\n\n*   **科学依据：** 该问题是数值微分算子傅里叶分析的标准练习，这是计算物理、工程和信号处理中的一个基本主题。所有概念——波数、奈奎斯特频率、有限差分、传递函数（符号）、信噪比考虑——都是公认且正确应用的。关系式 $k_s = \\frac{\\pi}{2\\Delta x}$ 正确对应于 $\\lambda_{\\min} = \\frac{2\\pi}{k_s} = \\frac{2\\pi}{\\pi/(2\\Delta x)} = 4\\Delta x$。\n*   **适定性：** 问题定义清晰，有量化约束。它要求在一组有限的选项中选择“最佳”选项，根据约束条件，这可以通过标准的工程设计原则（如简约性）得出一个确定的答案。\n*   **客观性：** 问题以精确、客观和技术性的语言陈述，没有歧义或主观声明。\n\n**第 3 步：结论和行动**\n\n问题陈述是有效的。它在科学上是合理的、适定的和客观的。我将继续进行求解。\n\n### 求解推导\n\n分析在傅里叶域中进行。连续空间导数算子 $\\frac{\\partial}{\\partial x}$ 在傅里叶域中相当于乘以 $i k$，其中 $k$ 是空间波数。理想的传递函数是 $H_{ideal}(k) = ik$，其幅度为 $|H_{ideal}(k)| = |k|$。\n\n我们使用归一化波数 $\\theta = k \\Delta x$，其范围从 $0$ 到 $\\pi$（奈奎斯特频率 $k_N = \\pi/\\Delta x$）。用 $\\theta$ 表示的理想算子的传递函数是 $H_{ideal}(\\theta) = i\\frac{\\theta}{\\Delta x}$，其幅度为 $|H_{ideal}(\\theta)| = \\frac{\\theta}{\\Delta x}$。\n\n用于一阶导数的中心反对称有限差分算子具有以下一般形式：\n$$ \\frac{df}{dx}\\bigg|_{x_j} \\approx \\frac{1}{\\Delta x} \\sum_{m=1}^{M} c_m (f_{j+m} - f_{j-m}) $$\n其中 $p=2M$ 是精度阶数。该离散算子的传递函数（或符号）$H_{eff}(\\theta)$ 是通过其对复指数 $e^{ikx_j} = e^{i\\theta j}$ 的作用找到的：\n$$ H_{eff}(\\theta) = \\frac{1}{\\Delta x} \\sum_{m=1}^{M} c_m (e^{im\\theta} - e^{-im\\theta}) = \\frac{2i}{\\Delta x} \\sum_{m=1}^{M} c_m \\sin(m\\theta) $$\n该有效传递函数的幅度为：\n$$ |H_{eff}(\\theta)| = \\frac{2}{\\Delta x} \\left| \\sum_{m=1}^{M} c_m \\sin(m\\theta) \\right| $$\n对于所使用的标准格式，当 $\\theta \\in [0, \\pi]$ 时，该和为非负。我们定义归一化幅度响应为 $\\tilde{H}_p(\\theta) = |H_{eff}(\\theta)| \\Delta x$。理想的归一化响应是 $\\tilde{H}_{ideal}(\\theta) = \\theta$。\n\n指定阶数 $p$ 的归一化幅度响应如下：\n*   **p=2 (M=1):** $c_1 = \\frac{1}{2}$.\n    $$ \\tilde{H}_2(\\theta) = \\sin(\\theta) $$\n*   **p=4 (M=2):** $c_1 = \\frac{2}{3}$, $c_2 = -\\frac{1}{12}$.\n    $$ \\tilde{H}_4(\\theta) = \\frac{4}{3}\\sin(\\theta) - \\frac{1}{6}\\sin(2\\theta) $$\n*   **p=6 (M=3):** $c_1 = \\frac{3}{4}$, $c_2 = -\\frac{3}{20}$, $c_3 = \\frac{1}{60}$.\n    $$ \\tilde{H}_6(\\theta) = \\frac{3}{2}\\sin(\\theta) - \\frac{3}{10}\\sin(2\\theta) + \\frac{1}{30}\\sin(3\\theta) $$\n*   **p=8 (M=4):** $c_1 = \\frac{4}{5}$, $c_2 = -\\frac{1}{5}$, $c_3 = \\frac{4}{105}$, $c_4 = -\\frac{1}{280}$.\n    $$ \\tilde{H}_8(\\theta) = \\frac{8}{5}\\sin(\\theta) - \\frac{2}{5}\\sin(2\\theta) + \\frac{8}{105}\\sin(3\\theta) - \\frac{1}{140}\\sin(4\\theta) $$\n\n现在，我们对每个阶数 $p$ 评估这两个约束。\n\n**约束 1：分辨率**\n该约束针对最大信号波数 $\\theta_t = \\frac{\\pi}{2}$ 处的相对误差。\n$$ \\text{相对误差} = \\left| \\frac{\\tilde{H}_p(\\theta_t) - \\tilde{H}_{ideal}(\\theta_t)}{\\tilde{H}_{ideal}(\\theta_t)} \\right| = \\left| \\frac{\\tilde{H}_p(\\pi/2) - \\pi/2}{\\pi/2} \\right| \\le 0.10 $$\n理想值为 $\\tilde{H}_{ideal}(\\pi/2) = \\frac{\\pi}{2} \\approx 1.5708$。我们需要 $\\tilde{H}_p(\\pi/2) \\ge 0.90 \\times \\frac{\\pi}{2} \\approx 1.4137$。\n我们计算每个 $p$ 的 $\\tilde{H}_p(\\pi/2)$：\n*   $p=2$: $\\tilde{H}_2(\\pi/2) = \\sin(\\pi/2) = 1$.\n    误差 = $|1 - \\pi/2|/(\\pi/2) \\approx 0.363 = 36.3\\%$。不满足约束。\n*   $p=4$: $\\tilde{H}_4(\\pi/2) = \\frac{4}{3}\\sin(\\pi/2) - \\frac{1}{6}\\sin(\\pi) = \\frac{4}{3} \\approx 1.3333$.\n    误差 = $|4/3 - \\pi/2|/(\\pi/2) \\approx 0.151 = 15.1\\%$。不满足约束。\n*   $p=6$: $\\tilde{H}_6(\\pi/2) = \\frac{3}{2}\\sin(\\pi/2) - \\frac{3}{10}\\sin(\\pi) + \\frac{1}{30}\\sin(3\\pi/2) = \\frac{3}{2} - \\frac{1}{30} = \\frac{44}{30} = \\frac{22}{15} \\approx 1.4667$.\n    误差 = $|22/15 - \\pi/2|/(\\pi/2) \\approx 0.066 = 6.6\\%$。**满足约束。**\n*   $p=8$: $\\tilde{H}_8(\\pi/2) = \\frac{8}{5}\\sin(\\pi/2) - \\frac{2}{5}\\sin(\\pi) + \\frac{8}{105}\\sin(3\\pi/2) - \\frac{1}{140}\\sin(2\\pi) = \\frac{8}{5} - \\frac{8}{105} = \\frac{160}{105} = \\frac{32}{21} \\approx 1.5238$.\n    误差 = $|32/21 - \\pi/2|/(\\pi/2) \\approx 0.030 = 3.0\\%$。**满足约束。**\n\n根据分辨率约束，只有阶数 $p=6$ 和 $p=8$ 是可接受的。\n\n**约束 2：稳健性**\n该约束针对高噪声频率 $\\theta_h = 0.9\\pi$ 处的算子幅度。\n$$ |H_{eff}(\\theta_h)| \\le \\frac{0.75}{\\Delta x} \\implies \\tilde{H}_p(\\theta_h) \\le 0.75 $$\n我们需要以下三角函数值：$\\sin(0.9\\pi) \\approx 0.3090$, $\\sin(1.8\\pi) \\approx -0.5878$, $\\sin(2.7\\pi) \\approx -0.8090$, $\\sin(3.6\\pi) \\approx -0.9511$。\n我们计算每个 $p$ 的 $\\tilde{H}_p(0.9\\pi)$：\n*   $p=2$: $\\tilde{H}_2(0.9\\pi) = \\sin(0.9\\pi) \\approx 0.309$。\n    这 $\\le 0.75$。**满足约束。**\n*   $p=4$: $\\tilde{H}_4(0.9\\pi) = \\frac{4}{3}(0.3090) - \\frac{1}{6}(-0.5878) \\approx 0.4120 + 0.0980 = 0.510$。\n    这 $\\le 0.75$。**满足约束。**\n*   $p=6$: $\\tilde{H}_6(0.9\\pi) = \\frac{3}{2}(0.3090) - \\frac{3}{10}(-0.5878) + \\frac{1}{30}(-0.8090) \\approx 0.4635 + 0.1763 - 0.0270 = 0.6128$。\n    这 $\\le 0.75$。**满足约束。**\n*   $p=8$: $\\tilde{H}_8(0.9\\pi) = \\frac{8}{5}(0.3090) - \\frac{2}{5}(-0.5878) + \\frac{8}{105}(-0.8090) - \\frac{1}{140}(-0.9511) \\approx 0.4944 + 0.2351 - 0.0616 + 0.0068 = 0.6747$。\n    这 $\\le 0.75$。**满足约束。**\n\n所有四个阶数都满足稳健性约束。\n\n**综合并选择最佳选项**\n\n要“最好地满足两个约束”，算子必须通过两个约束。\n*   $p=2$：不满足约束 1。\n*   $p=4$：不满足约束 1。\n*   $p=6$：满足约束 1 和约束 2。\n*   $p=8$：满足约束 1 和约束 2。\n\n我们必须在 $p=6$ 和 $p=8$ 之间做出选择。问题要求选择*最能*满足约束的阶数。这意味着应用一个设计原则。在工程和计算实践中，一个常见的原则是简约性（或奥卡姆剃刀原理）：选择满足所有规格的最简单（即阶数最低、计算成本最低）的设计。更高阶的格式更宽，增加了计算成本并使边界处理复杂化。\n\n*   $p=6$ 是满足分辨率和稳健性要求的最低阶算子。\n*   $p=8$ 提供更高的分辨率（误差为 $3.0\\%$ 对比 $6.6\\%$），但代价是在高频噪声上更具侵略性（放大率为 $0.675$ 对比 $0.613$），相对于稳健性限制 $0.75$ 留下的安全裕度更小。它也是一个更复杂且计算成本更高的算子。\n\n鉴于目标是“平衡分辨率和稳健性”，并且在没有指示要将分辨率置于一切之上的情况下，最明智的选择是能够工作的最简单的那个。因此，$p=6$ 算子是最佳选择。\n\n### 逐项分析\n\n*   **A. $p=2$（二阶中心差分）**：此算子不满足分辨率约束（约束 1），因为其在最高信号频率处的幅度相对误差约为 $36\\%$，远大于 $10\\%$ 的容差。**不正确**。\n*   **B. $p=4$（四阶中心差分）**：此算子也不满足分辨率约束（约束 1）。其在最高信号频率处的相对误差约为 $15\\%$，超过了 $10\\%$ 的容差。**不正确**。\n*   **C. $p=6$（六阶中心差分）**：此算子满足两个约束。其分辨率误差约为 $6.6\\%$（$\\le 10\\%$），其高频噪声放大率约为 $0.613$（$\\le 0.75$）。它是实现这一目标的最低阶（最简单）算子，代表了最平衡和高效的设计选择。**正确**。\n*   **D. $p=8$（八阶中心差分）**：此算子满足两个约束，分辨率误差约为 $3.0\\%$，高频噪声放大率约为 $0.675$。虽然它比 $p=6$ 的情况提供了更好的分辨率，但它更复杂，并且更接近噪声放大极限。遵循选择最简单的足够好的设计的原则，$p=6$ 算子是“最佳”选择。**不正确**。", "answer": "$$\\boxed{C}$$", "id": "3593473"}]}