{"hands_on_practices": [{"introduction": "标准最速下降法的收敛性能往往会随着计算网格的加密而恶化，这在实际计算中是不可接受的。本练习将引导你探索一个深刻而强大的概念：通过使用一个能反映网格几何特征的非欧几里得内积来重新定义“最速”下降方向 [@problem_id:3617265]。你将通过有限元方法中的“质量集中”（mass lumping）技术来构建这样一个离散内积，并理解为何基于此内积的最速下降法能够表现出网格无关性（mesh-independent behavior），这是设计稳健且可扩展的地球物理反演算法的关键一步。", "problem": "考虑计算地球物理学中表示稳定地下水流的一维扩散模型，其定义域为 $[0,1]$，在 $x=0$ 和 $x=1$ 处具有齐次 Dirichlet 边界条件。在一个具有节点 $x_0=0$、$x_1=\\epsilon$、$x_2=1-\\epsilon$ 和 $x_3=1$ 的不规则网格上，使用连续分片线性有限元进行离散化，其中 $\\epsilon \\in (0,\\tfrac{1}{2})$。单元长度为 $h_1=\\epsilon$、$h_2=1-2\\epsilon$ 和 $h_3=\\epsilon$。两个内部未知量是节点 $x_1$ 和 $x_2$ 处的节点值，用向量 $u \\in \\mathbb{R}^2$ 表示。\n\n设离散内积定义为 $\\langle u,v\\rangle_h=\\sum_{i=1}^2 w_i u_i v_i$，其中 $w_i$ 是未知的正权重。您的目标是确保当 $u$ 和 $v$ 由有限元基函数近似时，$\\langle \\cdot,\\cdot\\rangle_h$ 是连续 $L^2$ 内积 $\\int_0^1 u v \\, dx$ 的一个相容近似。也就是说，离散内积必须由连续 $L^2$ 积的质量集中产生。\n\n假设源项为常数 $f(x)=f_0$，其中 $f_0>0$。代数方程右端的项为 $b_i=\\int_0^1 f_0 \\,\\phi_i(x)\\,dx$，其中 $\\phi_i$ 是与两个内部节点 $x_1$ 和 $x_2$ 相关联的常规节点帽函数。考虑离散二次泛函 $J(u)=\\tfrac{1}{2}u^\\top K u - b^\\top u$，其中 $K$ 是由有限元离散化产生的对称正定刚度矩阵，而 $b\\in\\mathbb{R}^2$ 是如上定义的载荷向量。关于离散内积 $\\langle \\cdot,\\cdot\\rangle_h$，在点 $u$ 处的最速下降方向被定义为在所有以 $\\langle \\cdot,\\cdot\\rangle_h$ 度量的单位范数方向中，使 $J$ 的一阶减小量最大的方向。\n\n任务：\n- 确定权重 $w_1$ 和 $w_2$，使得 $\\langle \\cdot,\\cdot\\rangle_h$ 在此网格上成为一个相容的质量集中 $L^2$ 内积。\n- 从初始猜测 $u^{(0)}=0$ 开始，计算第一次迭代时最速下降方向 $p^{(0)}$ 的两个分量大小之比 $\\rho(\\epsilon)=\\frac{|p^{(0)}_1|}{|p^{(0)}_2|}$，其中最速下降方向是相对于您的离散内积 $\\langle \\cdot,\\cdot\\rangle_h$ 计算的。\n\n将您关于 $\\rho(\\epsilon)$ 的最终答案表示为一个实数（无单位）。无需四舍五入。", "solution": "用户需要一个计算地球物理学问题的详细解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **模型：** 稳定地下水流的一维扩散模型。\n- **定义域：** $[0,1]$。\n- **边界条件 (BCs)：** 在 $x=0$ 和 $x=1$ 处的齐次 Dirichlet 边界条件。\n- **离散化：** 连续分片线性有限元。\n- **网格节点：** $x_0=0$，$x_1=\\epsilon$，$x_2=1-\\epsilon$，$x_3=1$，其中 $\\epsilon \\in (0,\\frac{1}{2})$。\n- **单元长度：** $h_1=\\epsilon$，$h_2=1-2\\epsilon$，$h_3=\\epsilon$。\n- **未知量：** $u = [u_1, u_2]^\\top \\in \\mathbb{R}^2$，表示内部节点 $x_1$ 和 $x_2$ 处的节点值。\n- **离散内积：** $\\langle u,v\\rangle_h=\\sum_{i=1}^2 w_i u_i v_i$，其中 $w_i$ 是未知的正权重。这必须是连续 $L^2$ 内积 $\\int_0^1 u v \\, dx$ 的一个相容的质量集中近似。\n- **源项：** $f(x)=f_0$，一个常数，且 $f_0>0$。\n- **载荷向量：** $b_i=\\int_0^1 f_0 \\,\\phi_i(x)\\,dx$，其中 $\\phi_i$ 是节点 $x_1$ 和 $x_2$ 的节点帽函数。\n- **泛函：** $J(u)=\\frac{1}{2}u^\\top K u - b^\\top u$，其中 $K$ 是对称正定刚度矩阵。\n- **最速下降方向：** $p$ 在所有以 $\\langle \\cdot,\\cdot\\rangle_h$ 内积度量的单位范数方向中，使 $J$ 的一阶减小量最大。\n- **初始猜测：** $u^{(0)}=0$。\n- **任务：**\n  1. 确定权重 $w_1$ 和 $w_2$。\n  2. 计算第一次迭代时最速下降方向 $p^{(0)}$ 的比值 $\\rho(\\epsilon)=\\frac{|p^{(0)}_1|}{|p^{(0)}_2|}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上和数学上都是合理的。它描述了有限元方法（FEM）在一个二阶边值问题上的标准应用，以及一个用于求解所得线性系统的优化过程（最速下降法）。\n\n- **科学依据：**该问题使用了有限元方法、数值线性代数和优化的既定原理。一维扩散方程是包括地球物理学在内的许多STEM领域的基本模型。\n- **适定性：**该问题提供了所有必要的信息以确定权重和指定的比值。质量集中和使用一般内积的最速下降法的概念是明确定义的。问题设置的对称性确保了最终的比值是明确的，即使“质量集中”有多种标准定义。\n- **客观性：**该问题使用精确的数学语言陈述，没有主观性或模糊性。\n- **完整性：**该问题是自洽的。网格、基函数（默认为标准线性“帽”函数）、内积和目标泛函的定义都是充分的。\n- **一致性：**给定的信息中没有矛盾。条件 $\\epsilon \\in (0, \\frac{1}{2})$ 确保了所有单元长度为正，并且节点顺序得以保持 ($x_0  x_1  x_2  x_3$)。\n\n该问题不违反任何无效性标准。虽然由于问题的对称性，最终答案很简单，但其推导过程需要正确应用数值分析中的几个不平凡的概念。\n\n**步骤 3：结论和行动**\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n问题分为两部分：首先，确定离散内积的权重 $w_1$ 和 $w_2$；其次，计算初始最速下降方向各分量的比值。\n\n**第一部分：确定权重 $w_1$ 和 $w_2$**\n\n离散内积 $\\langle u,v\\rangle_h = \\sum_{i=1}^2 w_i u_i v_i$ 被指定为连续 $L^2$ 内积 $\\int_0^1 u(x)v(x)dx$ 的一个相容的、质量集中的近似。在有限元背景下，函数 $u(x)$ 近似为 $u(x) \\approx \\sum_j u_j \\phi_j(x)$。连续内积变为：\n$$ \\int_0^1 u(x)v(x)dx \\approx \\int_0^1 \\left(\\sum_i u_i \\phi_i(x)\\right) \\left(\\sum_j v_j \\phi_j(x)\\right) dx = \\sum_{i,j} u_i v_j \\int_0^1 \\phi_i(x)\\phi_j(x)dx = u^\\top M v $$\n其中 $M$ 是相容质量矩阵，其元素为 $M_{ij} = \\int_0^1 \\phi_i(x)\\phi_j(x)dx$。\n\n质量集中用对角矩阵 $M_L$ 来近似满矩阵 $M$。离散内积是根据这个集中矩阵定义的，因此 $u^\\top W v = u^\\top M_L v$，意味着 $W=M_L$ 并且 $w_i = (M_L)_{ii}$。\n\n对于连续分片线性单元，一种标准的、有物理动机且广泛使用的质量集中方法是将对角线元素定义为相应基函数的积分。这等效于使用节点求积法则来近似定义质量矩阵的积分。\n$$ w_i = \\int_0^1 \\phi_i(x) dx $$\n几何上，这个积分表示“帽”基函数 $\\phi_i(x)$ 下的面积。与节点 $x_i$ 相关联的帽函数 $\\phi_i$ 在区间 $(x_{i-1}, x_{i+1})$ 上非零，并由长度为 $h_{i-1} = x_i-x_{i-1}$ 和 $h_i = x_{i+1}-x_i$ 的两个单元上的两个三角形部分组成。面积是这两个三角形面积之和，每个三角形的高度为1：\n$$ w_i = \\frac{1}{2} \\times (\\text{base}_1) \\times 1 + \\frac{1}{2} \\times (\\text{base}_2) \\times 1 = \\frac{1}{2}(h_{i-1} + h_i) $$\n网格节点为 $x_0=0$，$x_1=\\epsilon$，$x_2=1-\\epsilon$ 和 $x_3=1$。单元长度为 $h_1=x_1-x_0=\\epsilon$，$h_2=x_2-x_1=1-2\\epsilon$ 和 $h_3=x_3-x_2=\\epsilon$。\n\n对于内部节点 $x_1$ 处的权重 $w_1$：\n相邻单元是单元1（长度为 $h_1=\\epsilon$）和单元2（长度为 $h_2=1-2\\epsilon$）。\n$$ w_1 = \\int_0^1 \\phi_1(x) dx = \\frac{1}{2}(h_1 + h_2) = \\frac{1}{2}(\\epsilon + (1-2\\epsilon)) = \\frac{1-\\epsilon}{2} $$\n\n对于内部节点 $x_2$ 处的权重 $w_2$：\n相邻单元是单元2（长度为 $h_2=1-2\\epsilon$）和单元3（长度为 $h_3=\\epsilon$）。\n$$ w_2 = \\int_0^1 \\phi_2(x) dx = \\frac{1}{2}(h_2 + h_3) = \\frac{1}{2}((1-2\\epsilon) + \\epsilon) = \\frac{1-\\epsilon}{2} $$\n因此，权重为 $w_1 = w_2 = \\frac{1-\\epsilon}{2}$。\n\n**第二部分：计算比值 $\\rho(\\epsilon)$**\n\n最速下降法旨在最小化泛函 $J(u) = \\frac{1}{2}u^\\top K u - b^\\top u$。下降方向 $p$ 被选为在归一化约束下使下降量最大的方向。关于标准欧几里得内积，$J(u)$ 的梯度是 $\\nabla J(u) = Ku - b$。\n\n关于由对角矩阵 $W = \\text{diag}(w_1, w_2)$ 定义的内积 $\\langle \\cdot, \\cdot \\rangle_h$，在点 $u$ 处的最速下降方向 $p$ 由负预处理梯度给出：\n$$ p = -W^{-1} \\nabla J(u) $$\n我们从初始猜测 $u^{(0)}=0$ 开始。此时的梯度为：\n$$ g^{(0)} = \\nabla J(u^{(0)}) = K u^{(0)} - b = K(0) - b = -b $$\n因此，第一次迭代时的最速下降方向 $p^{(0)}$ 为：\n$$ p^{(0)} = -W^{-1}g^{(0)} = -W^{-1}(-b) = W^{-1}b $$\n由于 $W$ 是一个对角矩阵，$W = \\begin{pmatrix} w_1  0 \\\\ 0  w_2 \\end{pmatrix}$，其逆矩阵是 $W^{-1} = \\begin{pmatrix} 1/w_1  0 \\\\ 0  1/w_2 \\end{pmatrix}$。\n方向向量 $p^{(0)}$ 的分量是：\n$$ p^{(0)}_1 = \\frac{b_1}{w_1} \\quad \\text{和} \\quad p^{(0)}_2 = \\frac{b_2}{w_2} $$\n接下来，我们计算载荷向量 $b$ 的分量。其定义为 $b_i = \\int_0^1 f(x) \\phi_i(x) dx$。鉴于源项是常数 $f(x)=f_0$：\n$$ b_i = \\int_0^1 f_0 \\phi_i(x) dx = f_0 \\int_0^1 \\phi_i(x) dx $$\n从第一部分，我们确定了 $\\int_0^1 \\phi_i(x) dx = w_i$。因此，载荷向量分量和权重之间存在直接关系：\n$$ b_1 = f_0 w_1 \\quad \\text{和} \\quad b_2 = f_0 w_2 $$\n现在我们可以计算最速下降方向 $p^{(0)}$ 的分量：\n$$ p^{(0)}_1 = \\frac{b_1}{w_1} = \\frac{f_0 w_1}{w_1} = f_0 $$\n$$ p^{(0)}_2 = \\frac{b_2}{w_2} = \\frac{f_0 w_2}{w_2} = f_0 $$\n问题要求计算比值 $\\rho(\\epsilon) = \\frac{|p^{(0)}_1|}{|p^{(0)}_2|}$。\n$$ \\rho(\\epsilon) = \\frac{|f_0|}{|f_0|} $$\n鉴于 $f_0  0$，我们有 $|f_0| = f_0$。\n$$ \\rho(\\epsilon) = \\frac{f_0}{f_0} = 1 $$\n这个结果与 $\\epsilon$ 无关。网格的对称性（$h_1=h_3$）和源项的对称性（$f(x)$ 是常数）导致了权重的对称性（$w_1=w_2$）和载荷向量分量的对称性（$b_1=b_2$），这又导致了初始最速下降方向的分量相同。", "answer": "$$\n\\boxed{1}\n$$", "id": "3617265"}, {"introduction": "在地球物理建模中，我们的正演模型永远无法完美地描述复杂的真实地球。本练习引入了一种前沿的稳健优化（robust optimization）框架，以明确地处理有界的模型误差 [@problem_id:3617243]。其核心思想不再是最小化简单的模型预测与观测数据之间的残差，而是最小化在所有给定范数界限内的可能模型误差中最坏情况（worst-case）下的残差。这引导我们进入一个“最小-最大”（min-max）问题，本练习将带你推导这个稳健目标函数及其梯度，让你掌握在面对不确定性时获得更可靠反演结果的方法。", "problem": "在地震参数估计中，假设需要从数据 $\\mathbf{d} \\in \\mathbb{R}^{p}$ 估计模型向量 $\\mathbf{m} \\in \\mathbb{R}^{n}$，其中预测数据由一个可微的正演映射 $F(\\mathbf{m})$ 给出。考虑一个稳健的公式，其中预测数据带有一个附加的建模误差 $\\delta F$，该误差未知，但在欧几里得范数下受限于一个半径 $\\eta  0$。稳健失配定义为\n$$\nJ(\\mathbf{m}) \\equiv \\max_{\\|\\delta F\\|_{2} \\leq \\eta} \\frac{1}{2}\\,\\|F(\\mathbf{m}) + \\delta F - \\mathbf{d}\\|_{2}^{2}.\n$$\n从欧几里得范数和柯西-施瓦茨不等式的定义出发，并使用 $F(\\mathbf{m})$ 关于当前迭代点 $\\mathbf{m}_{k}$ 的一阶线性化，解决以下问题：\n\n1. 对于固定的残差 $\\mathbf{r}(\\mathbf{m}) \\equiv F(\\mathbf{m}) - \\mathbf{d}$，精确计算关于 $\\delta F$ 的内部最大化，并用 $\\|\\mathbf{r}(\\mathbf{m})\\|_{2}$ 和 $\\eta$ 表示 $J(\\mathbf{m})$ 的闭式表达式。同时，找出达到最大值的最大化子 $\\delta F^{\\star}$。\n\n2. 令 $J_{F}(\\mathbf{m}_{k})$ 表示 $F$ 在 $\\mathbf{m}_{k}$ 处的雅可比矩阵，并考虑一阶近似 $F(\\mathbf{m}) \\approx F(\\mathbf{m}_{k}) + J_{F}(\\mathbf{m}_{k})(\\mathbf{m} - \\mathbf{m}_{k})$。利用第1部分的结果和链式法则，推导近似梯度 $\\nabla J(\\mathbf{m}_{k})$，用 $\\mathbf{r}_{k} \\equiv F(\\mathbf{m}_{k}) - \\mathbf{d}$ 和 $J_{F}(\\mathbf{m}_{k})$ 表示。\n\n3. 特化到 $\\mathbb{R}^{2}$ 中的线性恒等正演映射 $F(\\mathbf{m}) = \\mathbf{m}$，其中当前模型为 $\\mathbf{m}_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，数据为 $\\mathbf{d} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$，建模误差半径为 $\\eta = 1$。利用第2部分得到的梯度，构建最速下降方向 $-\\nabla J(\\mathbf{m}_{0})$，并沿此方向执行精确线搜索，以最小化 $\\alpha \\geq 0$ 上的稳健目标函数 $J(\\mathbf{m}_{0} - \\alpha \\nabla J(\\mathbf{m}_{0}))$。报告精确的最优步长 $\\alpha^{\\star}$，以一个数字的形式给出。不要四舍五入。", "solution": "该问题经验证是自洽的，科学上基于优化理论和线性代数，并且是适定的。所有必需的数据和定义均已提供。该问题是可形式化且客观的。我现在将开始提供完整的解法。\n\n该问题分为三个部分。我们将按顺序进行解答。\n\n### 第1部分：内部最大化的计算\n\n稳健失配函数定义为\n$$\nJ(\\mathbf{m}) \\equiv \\max_{\\|\\delta F\\|_{2} \\leq \\eta} \\frac{1}{2}\\,\\|F(\\mathbf{m}) + \\delta F - \\mathbf{d}\\|_{2}^{2}\n$$\n其中 $\\eta  0$。对于一个固定的模型向量 $\\mathbf{m}$，我们定义残差向量为 $\\mathbf{r}(\\mathbf{m}) \\equiv F(\\mathbf{m}) - \\mathbf{d}$。需要对 $\\delta F$ 进行最大化的表达式是 $\\frac{1}{2}\\|\\mathbf{r}(\\mathbf{m}) + \\delta F\\|_{2}^{2}$。最大化此表达式等价于最大化其宗量，即欧几里得范数的平方 $\\|\\mathbf{r}(\\mathbf{m}) + \\delta F\\|_{2}^{2}$。\n\n让我们展开范数的平方：\n$$\n\\|\\mathbf{r}(\\mathbf{m}) + \\delta F\\|_{2}^{2} = (\\mathbf{r}(\\mathbf{m}) + \\delta F)^{T}(\\mathbf{r}(\\mathbf{m}) + \\delta F) = \\mathbf{r}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m}) + 2\\mathbf{r}(\\mathbf{m})^{T}\\delta F + \\delta F^{T}\\delta F\n$$\n这可以写成：\n$$\n\\|\\mathbf{r}(\\mathbf{m}) + \\delta F\\|_{2}^{2} = \\|\\mathbf{r}(\\mathbf{m})\\|_{2}^{2} + 2\\mathbf{r}(\\mathbf{m})^{T}\\delta F + \\|\\delta F\\|_{2}^{2}\n$$\n对于固定的 $\\mathbf{m}$，项 $\\|\\mathbf{r}(\\mathbf{m})\\|_{2}^{2}$ 是一个常数。为了最大化该表达式，我们必须在约束 $\\|\\delta F\\|_{2} \\leq \\eta$ 下选择 $\\delta F$。\n\n根据柯西-施瓦茨不等式，项 $\\mathbf{r}(\\mathbf{m})^{T}\\delta F$ 是有界的：\n$$\n|\\mathbf{r}(\\mathbf{m})^{T}\\delta F| \\leq \\|\\mathbf{r}(\\mathbf{m})\\|_{2} \\|\\delta F\\|_{2}\n$$\n$\\mathbf{r}(\\mathbf{m})^{T}\\delta F$ 的最大值是 $\\|\\mathbf{r}(\\mathbf{m})\\|_{2} \\|\\delta F\\|_{2}$，在 $\\delta F$ 与 $\\mathbf{r}(\\mathbf{m})$ 共线且同向时达到。也就是说，$\\delta F$ 必须具有 $\\delta F = c \\mathbf{r}(\\mathbf{m})$ 的形式，其中标量 $c \\geq 0$。\n\n让我们分析待最大化的函数 $f(\\delta F) = \\|\\mathbf{r}(\\mathbf{m})\\|_{2}^{2} + 2\\mathbf{r}(\\mathbf{m})^{T}\\delta F + \\|\\delta F\\|_{2}^{2}$。当 $\\delta F$ 被选择为与 $\\mathbf{r}(\\mathbf{m})$ 方向一致并具有最大可能的模长时，$2\\mathbf{r}(\\mathbf{m})^{T}\\delta F$ 和 $\\|\\delta F\\|_{2}^{2}$ 这两项都达到最大值。约束条件是 $\\|\\delta F\\|_{2} \\leq \\eta$。因此，最大值必须出现在可行集的边界上，即当 $\\|\\delta F\\|_{2} = \\eta$ 时。\n\n因此，最大化子 $\\delta F^{\\star}$ 必须是一个长度为 $\\eta$ 且与 $\\mathbf{r}(\\mathbf{m})$ 平行的向量。假设 $\\mathbf{r}(\\mathbf{m}) \\neq \\mathbf{0}$，这个向量是唯一的：\n$$\n\\delta F^{\\star} = \\eta \\frac{\\mathbf{r}(\\mathbf{m})}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\n$$\n如果 $\\mathbf{r}(\\mathbf{m}) = \\mathbf{0}$，则需要最大化的项是 $\\frac{1}{2}\\|\\delta F\\|_{2}^{2}$，它在 $\\|\\delta F\\|_{2} = \\eta$ 时最大化。在这种情况下，任何满足 $\\|\\delta F^{\\star}\\|_{2} = \\eta$ 的向量 $\\delta F^{\\star}$ 都是最大化子。\n\n将 $\\delta F^{\\star}$ 代回范数平方的表达式中：\n$$\n\\max_{\\|\\delta F\\|_{2} \\leq \\eta} \\|\\mathbf{r}(\\mathbf{m}) + \\delta F\\|_{2}^{2} = \\left\\|\\mathbf{r}(\\mathbf{m}) + \\eta \\frac{\\mathbf{r}(\\mathbf{m})}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\\right\\|_{2}^{2} = \\left\\|\\left(1 + \\frac{\\eta}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\\right)\\mathbf{r}(\\mathbf{m})\\right\\|_{2}^{2}\n$$\n$$\n= \\left(1 + \\frac{\\eta}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\\right)^{2} \\|\\mathbf{r}(\\mathbf{m})\\|_{2}^{2} = \\left(\\frac{\\|\\mathbf{r}(\\mathbf{m})\\|_{2} + \\eta}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\\right)^{2} \\|\\mathbf{r}(\\mathbf{m})\\|_{2}^{2} = (\\|\\mathbf{r}(\\mathbf{m})\\|_{2} + \\eta)^{2}\n$$\n这个公式对于 $\\mathbf{r}(\\mathbf{m}) = \\mathbf{0}$ 的情况也成立。因此，稳健失配的闭式表达式为：\n$$\nJ(\\mathbf{m}) = \\frac{1}{2}(\\|\\mathbf{r}(\\mathbf{m})\\|_{2} + \\eta)^{2} = \\frac{1}{2}(\\|F(\\mathbf{m}) - \\mathbf{d}\\|_{2} + \\eta)^{2}\n$$\n\n### 第2部分：近似梯度的推导\n\n我们寻求 $J(\\mathbf{m})$ 关于 $\\mathbf{m}$ 的梯度，并在点 $\\mathbf{m}_{k}$ 处求值。我们使用链式法则。令 $u(\\mathbf{m}) = \\|F(\\mathbf{m}) - \\mathbf{d}\\|_{2} = \\|\\mathbf{r}(\\mathbf{m})\\|_{2}$。则 $J(\\mathbf{m}) = \\frac{1}{2}(u(\\mathbf{m}) + \\eta)^{2}$。\n\n梯度为 $\\nabla J(\\mathbf{m}) = \\frac{dJ}{du} \\nabla u(\\mathbf{m})$。\n第一项是：\n$$\n\\frac{dJ}{du} = \\frac{1}{2} \\cdot 2(u(\\mathbf{m}) + \\eta) = u(\\mathbf{m}) + \\eta = \\|\\mathbf{r}(\\mathbf{m})\\|_{2} + \\eta\n$$\n第二项是残差的欧几里得范数的梯度，$\\nabla u(\\mathbf{m}) = \\nabla \\|\\mathbf{r}(\\mathbf{m})\\|_{2}$。假设 $\\mathbf{r}(\\mathbf{m}) \\neq \\mathbf{0}$：\n$$\n\\nabla \\|\\mathbf{r}(\\mathbf{m})\\|_{2} = \\nabla (\\mathbf{r}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m}))^{1/2} = \\frac{1}{2}(\\mathbf{r}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m}))^{-1/2} \\nabla(\\mathbf{r}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m}))\n$$\n范数平方的梯度是 $\\nabla(\\mathbf{r}^{T}\\mathbf{r}) = 2 J_{\\mathbf{r}}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m})$，其中 $J_{\\mathbf{r}}(\\mathbf{m})$ 是 $\\mathbf{r}(\\mathbf{m})$ 关于 $\\mathbf{m}$ 的雅可比矩阵。\n由于 $\\mathbf{r}(\\mathbf{m}) = F(\\mathbf{m}) - \\mathbf{d}$，其雅可比矩阵是 $J_{\\mathbf{r}}(\\mathbf{m}) = J_{F}(\\mathbf{m})$，即正演映射 $F$ 的雅可比矩阵。\n因此，\n$$\n\\nabla \\|\\mathbf{r}(\\mathbf{m})\\|_{2} = \\frac{1}{2\\|\\mathbf{r}(\\mathbf{m})\\|_{2}} (2 J_{F}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m})) = \\frac{J_{F}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m})}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\n$$\n合并各项，$J(\\mathbf{m})$ 的梯度是：\n$$\n\\nabla J(\\mathbf{m}) = (\\|\\mathbf{r}(\\mathbf{m})\\|_{2} + \\eta) \\frac{J_{F}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m})}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}} = \\left(1 + \\frac{\\eta}{\\|\\mathbf{r}(\\mathbf{m})\\|_{2}}\\right) J_{F}(\\mathbf{m})^{T}\\mathbf{r}(\\mathbf{m})\n$$\n在迭代点 $\\mathbf{m}_{k}$ 处，令 $\\mathbf{r}_{k} \\equiv F(\\mathbf{m}_{k}) - \\mathbf{d}$，我们得到所需的梯度：\n$$\n\\nabla J(\\mathbf{m}_{k}) = \\left(1 + \\frac{\\eta}{\\|\\mathbf{r}_{k}\\|_{2}}\\right) J_{F}(\\mathbf{m}_{k})^{T}\\mathbf{r}_{k}\n$$\n在像最速下降法这样的迭代优化方案中，使用 $F(\\mathbf{m})$ 在 $\\mathbf{m}_k$ 附近的一阶线性化为此梯度的使用提供了理论基础，因为它用一个在 $\\mathbf{m}_k$ 处的梯度恰好是我们推导出的梯度的函数来近似 $J(\\mathbf{m})$。\n\n### 第3部分：具体案例与精确线搜索\n\n给定以下信息：\n- 正演映射: $F(\\mathbf{m}) = \\mathbf{m}$。这是一个在 $\\mathbb{R}^{2}$ 中的线性映射。\n- 初始模型: $\\mathbf{m}_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 数据: $\\mathbf{d} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n- 建模误差半径: $\\eta = 1$。\n\n首先，我们计算在 $\\mathbf{m}_{0}$ 处的梯度。\n$F(\\mathbf{m}) = \\mathbf{m}$ 的雅可比矩阵对于所有 $\\mathbf{m}$ 都是单位矩阵 $I$。所以，$J_{F}(\\mathbf{m}_{0}) = I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n在 $\\mathbf{m}_{0}$ 处的残差是：\n$$\n\\mathbf{r}_{0} = F(\\mathbf{m}_{0}) - \\mathbf{d} = \\mathbf{m}_{0} - \\mathbf{d} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}\n$$\n残差的欧几里得范数是：\n$$\n\\|\\mathbf{r}_{0}\\|_{2} = \\sqrt{2^{2} + 0^{2}} = 2\n$$\n使用第2部分的公式，梯度 $\\nabla J(\\mathbf{m}_{0})$ 是：\n$$\n\\nabla J(\\mathbf{m}_{0}) = \\left(1 + \\frac{\\eta}{\\|\\mathbf{r}_{0}\\|_{2}}\\right) J_{F}(\\mathbf{m}_{0})^{T}\\mathbf{r}_{0} = \\left(1 + \\frac{1}{2}\\right) I^{T} \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}\n$$\n最速下降方向是 $\\mathbf{p} = -\\nabla J(\\mathbf{m}_{0}) = \\begin{pmatrix} -3 \\\\ 0 \\end{pmatrix}$。\n\n接下来，我们进行精确线搜索，以找到最小化 $J(\\mathbf{m}_{0} + \\alpha \\mathbf{p})$ 的最优步长 $\\alpha^{\\star} \\geq 0$。我们将模型定义为 $\\alpha$ 的函数：\n$$\n\\mathbf{m}(\\alpha) = \\mathbf{m}_{0} + \\alpha \\mathbf{p} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\alpha \\begin{pmatrix} -3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 3\\alpha \\\\ 1 \\end{pmatrix}\n$$\n要最小化的目标函数是 $J(\\alpha) = J(\\mathbf{m}(\\alpha))$。我们计算作为 $\\alpha$ 函数的残差：\n$$\n\\mathbf{r}(\\alpha) = F(\\mathbf{m}(\\alpha)) - \\mathbf{d} = \\mathbf{m}(\\alpha) - \\mathbf{d} = \\begin{pmatrix} 1 - 3\\alpha \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 - 3\\alpha \\\\ 0 \\end{pmatrix}\n$$\n此残差的范数是：\n$$\n\\|\\mathbf{r}(\\alpha)\\|_{2} = \\sqrt{(2 - 3\\alpha)^{2} + 0^{2}} = |2 - 3\\alpha|\n$$\n现在我们用 $\\alpha$ 来表示目标函数：\n$$\nJ(\\alpha) = \\frac{1}{2}(\\|\\mathbf{r}(\\alpha)\\|_{2} + \\eta)^{2} = \\frac{1}{2}(|2 - 3\\alpha| + 1)^{2}\n$$\n我们需要找到 $\\alpha^{\\star} = \\arg\\min_{\\alpha \\geq 0} J(\\alpha)$。最小化 $J(\\alpha)$ 等价于最小化幂的底数 $|2 - 3\\alpha| + 1$，因为平方函数和因子 $\\frac{1}{2}$ 对于非负宗量是单调的。这又等价于最小化 $|2 - 3\\alpha|$。\n函数 $|2 - 3\\alpha|$ 是一个V形函数，其最小值为 $0$。当绝对值内的表达式为零时，达到此最小值：\n$$\n2 - 3\\alpha = 0 \\implies 3\\alpha = 2 \\implies \\alpha = \\frac{2}{3}\n$$\n由于这个 $\\alpha$ 的值是非负的（$\\frac{2}{3} \\geq 0$），所以它就是最优步长。目标函数的最小值在此点出现。\n精确的最优步长是 $\\alpha^{\\star} = \\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3617243"}]}