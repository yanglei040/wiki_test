{"hands_on_practices": [{"introduction": "在有限变形理论中，区分对初始（材料）构形和当前（空间）构形的求导至关重要，这直接影响着我们如何描述变形。本练习 [@problem_id:3564991] 通过一个经典的简单剪切案例，让您亲手计算变形梯度 $\\mathbf{F}$、材料位移梯度 $\\nabla_{0}\\mathbf{u}$ 与空间位移梯度 $\\nabla\\mathbf{u}$。掌握它们之间的区别与联系，是正确建立有限变形本构关系和运动学方程的基石。", "problem": "考虑一个正在经历有限变形的三维连续体。令参考（物质）坐标表示为 $\\mathbf{X} = (X_{1}, X_{2}, X_{3})$，当前（空间）坐标表示为 $\\mathbf{x} = (x_{1}, x_{2}, x_{3})$。该运动由位移场 $\\mathbf{u}(\\mathbf{X}) = (u_{1}, u_{2}, u_{3})$ 指定，其分量为 $u_{1}(\\mathbf{X}) = \\gamma X_{2}$，$u_{2}(\\mathbf{X}) = 0$ 和 $u_{3}(\\mathbf{X}) = 0$，其中 $\\gamma$ 是一个常数剪切参数。变形映射为 $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}(\\mathbf{X})$。\n\n从变形梯度 $\\mathbf{F}$（$\\mathbf{x}$ 相对于 $\\mathbf{X}$ 的梯度）、物质位移梯度 $\\nabla_{0}\\mathbf{u}$（$\\mathbf{u}$ 相对于 $\\mathbf{X}$ 的梯度）和空间位移梯度 $\\nabla\\mathbf{u}$（$\\mathbf{u}$ 相对于 $\\mathbf{x}$ 的梯度）的基本运动学定义出发，推导给定到位移场下的 $\\nabla_{0}\\mathbf{u}$、$\\mathbf{F}$ 和 $\\nabla\\mathbf{u}$ 的显式表达式。通过变形映射，适当应用链式法则来关联 $\\nabla\\mathbf{u}$ 和 $\\nabla_{0}\\mathbf{u}$，并基于这些定义解释哪个梯度是物质梯度，哪个是空间梯度。\n\n将最终答案表示为以 $\\gamma$ 表示的变形梯度 $\\mathbf{F}$。不需要四舍五入，由于 $\\gamma$ 是无量纲的，因此也不需要单位。", "solution": "该问题是有效的，因为它科学地基于连续介质力学的原理，给出了所有必要的定义和一个特定的位移场，问题设定良好，并且使用客观、正式的语言表述。我们可以开始求解。\n\n问题给出了参考（物质）坐标 $\\mathbf{X} = (X_{1}, X_{2}, X_{3})$ 和当前（空间）坐标 $\\mathbf{x} = (x_{1}, x_{2}, x_{3})$。位移场是物质坐标的函数 $\\mathbf{u}(\\mathbf{X})$，其分量为：\n$$ u_{1}(\\mathbf{X}) = \\gamma X_{2} $$\n$$ u_{2}(\\mathbf{X}) = 0 $$\n$$ u_{3}(\\mathbf{X}) = 0 $$\n其中 $\\gamma$ 是一个常数。\n\n变形映射将空间坐标与物质坐标联系起来，定义为 $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}(\\mathbf{X})$。用分量形式写出：\n$$ x_{1} = X_{1} + u_{1} = X_{1} + \\gamma X_{2} $$\n$$ x_{2} = X_{2} + u_{2} = X_{2} $$\n$$ x_{3} = X_{3} + u_{3} = X_{3} $$\n这表示在 $X_{1}-X_{2}$ 平面上的简单剪切变形。\n\n首先，我们推导物质位移梯度 $\\nabla_{0}\\mathbf{u}$。它被定义为位移向量 $\\mathbf{u}$ 相对于物质坐标 $\\mathbf{X}$ 的梯度，其分量形式可以写作 $(\\nabla_{0}\\mathbf{u})_{ij} = \\frac{\\partial u_{i}}{\\partial X_{j}}$。我们计算这个 $3 \\times 3$ 偏导数矩阵：\n$$ (\\nabla_{0}\\mathbf{u})_{11} = \\frac{\\partial u_{1}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(\\gamma X_{2}) = 0 $$\n$$ (\\nabla_{0}\\mathbf{u})_{12} = \\frac{\\partial u_{1}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(\\gamma X_{2}) = \\gamma $$\n$$ (\\nabla_{0}\\mathbf{u})_{13} = \\frac{\\partial u_{1}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(\\gamma X_{2}) = 0 $$\n由于 $u_{2}$ 和 $u_{3}$ 恒为零，它们的所有偏导数也都为零。因此，物质位移梯度张量为：\n$$ \\nabla_{0}\\mathbf{u} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n\n接下来，我们推导变形梯度 $\\mathbf{F}$。它被定义为空间位置向量 $\\mathbf{x}$ 相对于物质位置向量 $\\mathbf{X}$ 的梯度，其分量为 $F_{ij} = \\frac{\\partial x_{i}}{\\partial X_{j}}$。\n$$ F_{ij} = \\frac{\\partial}{\\partial X_{j}}(X_{i} + u_{i}) = \\frac{\\partial X_{i}}{\\partial X_{j}} + \\frac{\\partial u_{i}}{\\partial X_{j}} = \\delta_{ij} + (\\nabla_{0}\\mathbf{u})_{ij} $$\n在张量表示法中，此关系为 $\\mathbf{F} = \\mathbf{I} + \\nabla_{0}\\mathbf{u}$，其中 $\\mathbf{I}$ 是二阶单位张量，$\\delta_{ij}$ 是克罗内克符号。使用我们得到的 $\\nabla_{0}\\mathbf{u}$ 结果：\n$$ \\mathbf{F} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n\n现在，我们推导空间位移梯度 $\\nabla\\mathbf{u}$。它被定义为位移向量 $\\mathbf{u}$ 相对于空间坐标 $\\mathbf{x}$ 的梯度，其分量为 $(\\nabla\\mathbf{u})_{ij} = \\frac{\\partial u_{i}}{\\partial x_{j}}$。由于 $\\mathbf{u}$ 是以 $\\mathbf{X}$ 的函数形式给出的，我们必须使用链式法则来关联空间梯度和物质梯度。微分的链式法则表明：\n$$ \\frac{\\partial u_{i}}{\\partial X_{j}} = \\sum_{k=1}^{3} \\frac{\\partial u_{i}}{\\partial x_{k}} \\frac{\\partial x_{k}}{\\partial X_{j}} $$\n在张量表示法中，这写作 $\\nabla_{0}\\mathbf{u} = (\\nabla\\mathbf{u})\\mathbf{F}$。为了求得 $\\nabla\\mathbf{u}$，我们必须解出它：\n$$ \\nabla\\mathbf{u} = (\\nabla_{0}\\mathbf{u})\\mathbf{F}^{-1} $$\n我们需要计算变形梯度的逆矩阵 $\\mathbf{F}^{-1}$。$\\mathbf{F}$ 的行列式是：\n$$ \\det(\\mathbf{F}) = (1)(1)(1) = 1 $$\n由于行列式不为零，逆矩阵存在。对于一个 $3 \\times 3$ 矩阵，其逆矩阵由 $\\mathbf{F}^{-1} = \\frac{1}{\\det(\\mathbf{F})}\\text{adj}(\\mathbf{F})$ 给出，其中 $\\text{adj}(\\mathbf{F})$ 是伴随矩阵（代数余子式矩阵的转置）。\n$$ \\mathbf{F}^{-1} = \\begin{pmatrix} 1  -\\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n注意，$\\mathbf{F}^{-1}$ 表示物质坐标相对于空间坐标的梯度，即 $\\mathbf{F}^{-1} = \\frac{\\partial\\mathbf{X}}{\\partial\\mathbf{x}}$。\n\n现在，我们可以计算 $\\nabla\\mathbf{u}$：\n$$ \\nabla\\mathbf{u} = (\\nabla_{0}\\mathbf{u})\\mathbf{F}^{-1} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1  -\\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n进行矩阵乘法：\n$$ \\nabla\\mathbf{u} = \\begin{pmatrix} (0)(1) + (\\gamma)(0) + (0)(0)  (0)(-\\gamma) + (\\gamma)(1) + (0)(0)  (0)(0) + (\\gamma)(0) + (0)(1) \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ \\nabla\\mathbf{u} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n在这个简单剪切的特例中，物质位移梯度和空间位移梯度的矩阵表示是相同的。这不是一个普遍的结果。\n\n最后，物质梯度和空间梯度之间的区别在于进行微分时所依据的坐标系。\n- **物质梯度**：如果一个量是相对于物质（或参考）坐标 $\\mathbf{X}$ 计算的，那么它就是一个物质梯度。因此，$\\nabla_{0}\\mathbf{u} = \\frac{\\partial \\mathbf{u}}{\\partial \\mathbf{X}}$ 是物质位移梯度。它描述了位移相对于未变形体中质点位置的变化情况。\n- **空间梯度**：如果一个量是相对于空间（或当前）坐标 $\\mathbf{x}$ 计算的，那么它就是一个空间梯度。因此，$\\nabla\\mathbf{u} = \\frac{\\partial \\mathbf{u}}{\\partial \\mathbf{x}}$ 是空间位移梯度。它描述了位移相对于变形后空间中点的变化情况。\n符号 $\\nabla_{0}$（或 $\\text{Grad}$）明确指物质梯度，而 $\\nabla$（或 $\\text{grad}$）指空间梯度。\n\n问题要求将变形梯度 $\\mathbf{F}$ 作为最终答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\gamma  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n}\n$$", "id": "3564991"}, {"introduction": "变形梯度 $\\mathbf{F}$ 是描述变形的基本量，但为了更方便地构建不依赖于刚体转动的本构模型，我们需要引入其他变形度量。本练习 [@problem_id:3565015] 聚焦于一个简单的单轴拉伸案例，旨在计算并诠释右、左 Cauchy-Green 张量（$\\mathbf{C}$ 和 $\\mathbf{B}$）以及 Green-Lagrange 和 Euler-Almansi 应变张量（$\\mathbf{E}$ 和 $\\mathbf{e}$）。通过这个直观的例子，您将为这些抽象的张量度量如何与长度和体积变化等物理现实相关联，建立起坚实的理解。", "problem": "一个均匀变形通过一个常变形梯度$\\mathbf{F}$将一个物体从具有物质坐标$\\mathbf{X}$的参考构型映射到具有空间坐标$\\mathbf{x}$的当前构型。考虑沿第一基矢方向的单轴拉伸，其变形梯度为$\\mathbf{F}=\\operatorname{diag}(\\lambda,\\,1,\\,1)$，其中$\\lambda0$是主拉伸。\n\n从有限变形运动学的核心定义出发，推导右柯西-格林变形张量$\\mathbf{C}$、左柯西-格林变形张量$\\mathbf{B}$、格林-拉格朗日应变张量$\\mathbf{E}$以及欧拉-阿尔曼西应变张量$\\mathbf{e}$的显式表达式。指出哪些张量分量不为零，并从物理上解释这些分量在参考构型和当前构型中代表的长度平方变化和局部拉伸。\n\n最终答案要求以$\\lambda$的函数形式，给出拉格朗日正应变分量$E_{11}$的闭式表达式。无需四舍五入。最终答案应为一个无单位的解析表达式。", "solution": "问题陈述经评估有效。它在科学上基于连续介质力学的原理，是适定的，有足够的信息来推导出唯一解，并以客观、正式的语言表述。该问题是有限变形运动学中的一个标准练习，没有任何不一致或模糊之处。\n\n我们首先陈述待推导量的基本定义。令$\\mathbf{F}$为变形梯度张量，它通过$d\\mathbf{x} = \\mathbf{F} d\\mathbf{X}$将参考构型中的物质线元$d\\mathbf{X}$映射到当前构型中的空间线元$d\\mathbf{x}$。\n\n右柯西-格林变形张量$\\mathbf{C}$是一个物质张量，定义为：\n$$\n\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}\n$$\n它度量材料本身的变形，且与最终构型的刚体转动无关。\n\n左柯西-格林变形张量$\\mathbf{B}$是一个空间张量，定义为：\n$$\n\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\mathsf{T}}\n$$\n它也被称为Finger张量。\n\n格林-拉格朗日应变张量$\\mathbf{E}$是一个物质张量，用于量化相对于参考构型的应变。其定义为：\n$$\n\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})\n$$\n其中$\\mathbf{I}$是二阶单位张量。\n\n欧拉-阿尔曼西应变张量$\\mathbf{e}$是一个空间张量，用于量化相对于当前构型的应变。其定义为：\n$$\n\\mathbf{e} = \\frac{1}{2}(\\mathbf{I} - \\mathbf{B}^{-1})\n$$\n\n问题指定了沿第一基矢方向的均匀单轴拉伸，其变形梯度$\\mathbf{F}$以矩阵形式给出：\n$$\n\\mathbf{F} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n其中$\\lambda  0$。\n\n我们现在开始计算每个张量。\n\n**1. 右柯西-格林变形张量, $\\mathbf{C}$**\n使用定义$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$，并注意到给定的$\\mathbf{F}$是一个对角（因此是对称）矩阵，因此$\\mathbf{F}^{\\mathsf{T}} = \\mathbf{F}$：\n$$\n\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F} = \\mathbf{F}^2 = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n唯一不为零的分量位于对角线上：$C_{11} = \\lambda^2$，$C_{22} = 1$和$C_{33} = 1$。在物理上，对角分量$C_{II}$（无求和约定）表示最初沿第$I$个基矢方向的物质线元的拉伸平方。此处，$C_{11} = \\lambda^2$是第一方向上的拉伸平方，而$C_{22} = C_{33} = 1$表示初始在第二和第三方向上的线元长度没有变化。\n\n**2. 左柯西-格林变形张量, $\\mathbf{B}$**\n使用定义$\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\mathsf{T}}$：\n$$\n\\mathbf{B} = \\mathbf{F} \\mathbf{F}^{\\mathsf{T}} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n对于$\\mathbf{F}$为对称的这种特定变形，左、右柯西-格林张量是相同的：$\\mathbf{B} = \\mathbf{C}$。其物理意义是类似的，但$\\mathbf{B}$与空间构型相关联。\n\n**3. 格林-拉格朗日应变张量, $\\mathbf{E}$**\n使用定义$\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$：\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} \\lambda^2 - 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n唯一不为零的分量是$E_{11} = \\frac{1}{2}(\\lambda^2 - 1)$。该分量是第一方向上的拉格朗日正应变。它度量了物质线元长度平方相对于其初始长度平方的变化。对于一个物质线元$d\\mathbf{S} = dS_1 \\mathbf{E}_1$，其长度平方的变化为$ds^2 - dS_1^2 = (\\lambda^2 dS_1^2) - dS_1^2 = (\\lambda^2 - 1)dS_1^2$。拉格朗日应变的定义指出$ds^2 - dS_1^2 = 2E_{11} dS_1^2$，这证实了我们关于$E_{11}$的结果。\n\n**4. 欧拉-阿尔曼西应变张量, $\\mathbf{e}$**\n使用定义$\\mathbf{e} = \\frac{1}{2}(\\mathbf{I} - \\mathbf{B}^{-1})$，我们首先求$\\mathbf{B}$的逆矩阵：\n$$\n\\mathbf{B}^{-1} = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{\\lambda^2}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^{-2}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n现在我们计算$\\mathbf{e}$：\n$$\n\\mathbf{e} = \\frac{1}{2} \\left( \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} \\lambda^{-2}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 1 - \\lambda^{-2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n唯一不为零的分量是$e_{11} = \\frac{1}{2}(1 - \\lambda^{-2})$。这个量是第一方向上的欧拉正应变。它度量了物质线元长度平方相对于其最终长度平方的变化。对于一个在空间构型中与第一基矢对齐的线元$d\\mathbf{s} = ds_1 \\mathbf{e}_1$，欧拉应变的定义指出$ds_1^2 - dS^2 = 2e_{11} ds_1^2$，这与我们的结果一致。\n\n问题要求以$\\lambda$的函数形式给出拉格朗日正应变分量$E_{11}$的闭式表达式。根据以上推导，该表达式为$E_{11} = \\frac{1}{2}(\\lambda^2 - 1)$。", "answer": "$$\n\\boxed{\\frac{1}{2}(\\lambda^{2} - 1)}\n$$", "id": "3565015"}, {"introduction": "从理论走向实践，变形梯度的极分解（$\\mathbf{F} = \\mathbf{R}\\mathbf{U}$）是现代计算固体力学的核心操作，它将复杂的变形分解为纯拉伸和纯旋转。然而，在数值计算中，尤其当变形接近奇异（即 $J = \\det \\mathbf{F} \\to 0$）时，如何准确而稳健地完成这一分解成为关键挑战。这个高级计算练习 [@problem_id:3564980] 引导您通过编程实现，对比基于奇异值分解（SVD）的经典方法与迭代 Newton 方法在极端工况下的性能，为您在有限元软件开发或高级材料模型研究中处理数值稳定性问题提供宝贵经验。", "problem": "考虑有限变形运动学中的一个变形梯度矩阵 $\\mathbf{F} \\in \\mathbb{R}^{3 \\times 3}$，其极分解为 $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U} = \\mathbf{V}\\,\\mathbf{R}$，其中 $\\mathbf{R} \\in \\mathbb{R}^{3 \\times 3}$ 是一个正常正交张量（旋转，满足 $\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} = \\mathbf{I}$ 且 $\\det \\mathbf{R} = +1$），$\\mathbf{U} \\in \\mathbb{R}^{3 \\times 3}$ 是右拉伸张量（对称正定），$\\mathbf{V} \\in \\mathbb{R}^{3 \\times 3}$ 是左拉伸张量（对称正定）。令 $J = \\det \\mathbf{F}$ 表示雅可比行列式。目标是评估在 $J \\to 0^{+}$（$\\mathbf{F}$ 近奇异）时，计算极分解中旋转张量 $\\mathbf{R}$ 的两种备选策略的鲁棒性，并量化 $\\mathbf{R}$ 中的误差向计算出的拉伸张量 $\\mathbf{U}$ 和 $\\mathbf{V}$ 的传播。\n\n从极分解的核心定义、$\\mathbf{R}$ 的正交性条件以及对于保向变形有 $J > 0$ 这一事实出发，按以下步骤进行：\n\n- 策略 A（基于奇异值分解）：使用 $\\mathbf{F}$ 到正交和对角因子的分解来构建一个参考解 $(\\mathbf{R}_{\\mathrm{svd}}, \\mathbf{U}_{\\mathrm{ref}}, \\mathbf{V}_{\\mathrm{ref}})$，即使在 $\\mathbf{F}$ 病态但可逆的情况下，该解也是鲁棒的。除了存在这种分解为正交矩阵和具有非负元素的对角矩阵之外，不假设任何特定的公式。\n- 策略 B（基于正交性约束的迭代牛顿法）：从 $\\mathbf{X}_{0} = \\mathbf{F}$ 开始，设计一个迭代，通过将 $\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} = \\mathbf{I}$ 作为非线性约束来强制执行，从而在弗罗贝尼乌斯范数意义下收敛到最近的正交矩阵 $\\mathbf{R}$。在迭代中使用一个缩放机制，以在 $\\mathbf{F}$ 病态时保持数值稳定性，并在正交性缺陷变得足够小时停止。\n\n通过策略 A 获得 $\\mathbf{R}_{\\mathrm{svd}}$ 和通过策略 B 获得 $\\mathbf{R}_{\\mathrm{new}}$ 后，为策略 B 定义以下导出量：\n- $\\mathbf{U}_{\\mathrm{new}} = \\mathbf{R}_{\\mathrm{new}}^{\\mathsf{T}}\\mathbf{F}$ 和 $\\mathbf{V}_{\\mathrm{new}} = \\mathbf{F}\\,\\mathbf{R}_{\\mathrm{new}}^{\\mathsf{T}}$。\n- 对称部分 $\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}}) = \\tfrac{1}{2}\\left(\\mathbf{U}_{\\mathrm{new}} + \\mathbf{U}_{\\mathrm{new}}^{\\mathsf{T}}\\right)$ 和 $\\operatorname{sym}(\\mathbf{V}_{\\mathrm{new}}) = \\tfrac{1}{2}\\left(\\mathbf{V}_{\\mathrm{new}} + \\mathbf{V}_{\\mathrm{new}}^{\\mathsf{T}}\\right)$。\n\n对所有矩阵范数使用弗罗贝尼乌斯范数 $\\|\\mathbf{A}\\|_{F} = \\sqrt{\\operatorname{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{A})}$。通过以下指标量化鲁棒性和误差传播：\n- $\\mathbf{R}$ 的正交性缺陷：$e_{R}(\\mathbf{R}) = \\|\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} - \\mathbf{I}\\|_{F}$。\n- 策略 B 导致的右拉伸相对误差：$e_{U} = \\dfrac{\\|\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}}) - \\mathbf{U}_{\\mathrm{ref}}\\|_{F}}{\\|\\mathbf{U}_{\\mathrm{ref}}\\|_{F}}$。\n- 策略 B 导致的左拉伸相对误差：$e_{V} = \\dfrac{\\|\\operatorname{sym}(\\mathbf{V}_{\\mathrm{new}}) - \\mathbf{V}_{\\mathrm{ref}}\\|_{F}}{\\|\\mathbf{V}_{\\mathrm{ref}}\\|_{F}}$。\n- $\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}})$ 的对称正定性标志：如果 $\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}})$ 的最小特征值严格为正，则 $\\text{spd\\_ok} = \\text{True}$，否则为 $\\text{False}$。\n\n为测试套件中的每个测试用例构建 $\\mathbf{F}$，如下所示：\n$$\n\\mathbf{F} = \\mathbf{Q}_{1}\\,\\mathrm{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3})\\,\\mathbf{Q}_{2}^{\\mathsf{T}},\n$$\n其中 $\\mathbf{Q}_{1}$ 和 $\\mathbf{Q}_{2}$ 是由 Z–Y–X 外旋组合而成的正常正交矩阵，组合方式为 $\\mathbf{Q}(\\alpha,\\beta,\\gamma) = \\mathbf{R}_{z}(\\gamma)\\,\\mathbf{R}_{y}(\\beta)\\,\\mathbf{R}_{x}(\\alpha)$，角度以弧度为单位，且\n$$\n\\mathbf{R}_{x}(\\alpha) = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{bmatrix},\\quad\n\\mathbf{R}_{y}(\\beta) = \\begin{bmatrix} \\cos\\beta  0  \\sin\\beta \\\\ 0  1  0 \\\\ -\\sin\\beta  0  \\cos\\beta \\end{bmatrix},\\quad\n\\mathbf{R}_{z}(\\gamma) = \\begin{bmatrix} \\cos\\gamma  -\\sin\\gamma  0 \\\\ \\sin\\gamma  \\cos\\gamma  0 \\\\ 0  0  1 \\end{bmatrix}.\n$$\n\n测试套件（角度以弧度为单位）：\n- 用例 1：$(\\sigma_{1},\\sigma_{2},\\sigma_{3}) = (1.2,\\,0.9,\\,10^{-1})$，$\\mathbf{Q}_{1} = \\mathbf{Q}(0.3,\\,-0.5,\\,0.8)$，$\\mathbf{Q}_{2} = \\mathbf{Q}(0.2,\\,0.4,\\,-0.6)$。\n- 用例 2：$(\\sigma_{1},\\sigma_{2},\\sigma_{3}) = (1.4,\\,0.7,\\,10^{-3})$，$\\mathbf{Q}_{1} = \\mathbf{Q}(0.7,\\,0.1,\\,-0.4)$，$\\mathbf{Q}_{2} = \\mathbf{Q}(-0.5,\\,0.9,\\,0.3)$。\n- 用例 3：$(\\sigma_{1},\\sigma_{2},\\sigma_{3}) = (1.1,\\,0.8,\\,10^{-6})$，$\\mathbf{Q}_{1} = \\mathbf{Q}(-0.2,\\,0.6,\\,1.0)$，$\\mathbf{Q}_{2} = \\mathbf{Q}(0.9,\\,-0.7,\\,0.5)$。\n- 用例 4：$(\\sigma_{1},\\sigma_{2},\\sigma_{3}) = (2.0,\\,0.5,\\,10^{-8})$，$\\mathbf{Q}_{1} = \\mathbf{Q}(0.4,\\,-0.9,\\,0.2)$，$\\mathbf{Q}_{2} = \\mathbf{Q}(-0.3,\\,0.8,\\,-1.1)$。\n- 用例 5：$(\\sigma_{1},\\sigma_{2},\\sigma_{3}) = (5.0,\\,10^{-2},\\,10^{-8})$，$\\mathbf{Q}_{1} = \\mathbf{Q}(1.0,\\,-1.2,\\,0.4)$，$\\mathbf{Q}_{2} = \\mathbf{Q}(0.6,\\,0.5,\\,-0.9)$。\n\n对于每个用例：\n1. 根据指定的参数构建 $\\mathbf{F}$ 并计算 $J = \\det \\mathbf{F}$。\n2. 使用策略 A 计算 $(\\mathbf{R}_{\\mathrm{svd}}, \\mathbf{U}_{\\mathrm{ref}}, \\mathbf{V}_{\\mathrm{ref}})$。\n3. 使用策略 B 计算 $\\mathbf{R}_{\\mathrm{new}}$，采用数值稳定的缩放，并在正交性缺陷 $e_{R}(\\mathbf{R}_{\\mathrm{new}})$ 低于 $10^{-12}$ 或连续迭代的相对弗罗贝尼乌斯范数变化小于 $10^{-12}$ 时终止，最大迭代次数为 $100$ 次。\n4. 形成 $\\mathbf{U}_{\\mathrm{new}}$、$\\mathbf{V}_{\\mathrm{new}}$ 及其对称部分。\n5. 报告元组\n$$\n\\left[J,\\; e_{R}(\\mathbf{R}_{\\mathrm{svd}}),\\; e_{R}(\\mathbf{R}_{\\mathrm{new}}),\\; e_{U},\\; e_{V},\\; \\text{spd\\_ok}\\right]\n$$\n按此顺序，其中 $\\text{spd\\_ok}$ 是一个布尔值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是针对一个测试用例的六元素列表，按上述用例顺序排列。此问题中没有物理单位，所有角度必须以弧度解释。因此，最终输出必须是以下形式的单行：\n$[\\text{case1\\_list},\\text{case2\\_list},\\text{case3\\_list},\\text{case4\\_list},\\text{case5\\_list}]$，\n其中每个数值表示为浮点数，每个 $\\text{spd\\_ok}$ 表示为布尔字面量。", "solution": "经评估，用户提供的问题是有效的。它在科学上基于连续介质力学和数值线性代数，问题定义明确，提供了所有必要的数据和清晰的目标，并以客观、正式的语言表述。该问题要求比较两种用于计算近奇异变形梯度张量极分解的数值策略，这在计算固体力学中是一个相关且不平凡的任务。\n\n### 科学原理与算法设计\n\n该问题的核心是变形梯度张量 $\\mathbf{F}$ 的极分解，即分解为一个旋转 $\\mathbf{R}$ 和一个对称正定拉伸张量 $\\mathbf{U}$（或 $\\mathbf{V}$），由 $\\mathbf{F} = \\mathbf{R}\\mathbf{U} = \\mathbf{V}\\mathbf{R}$ 给出。当 $\\mathbf{F}$ 是病态的，即其雅可比行列式 $J = \\det \\mathbf{F}$ 接近于零时，我们需要评估两种计算 $\\mathbf{R}$ 的策略。\n\n#### **1. 变形梯度 $\\mathbf{F}$ 的构造**\n\n对于每个测试用例，变形梯度 $\\mathbf{F}$ 使用其奇异值分解（SVD）形式构造：\n$$\n\\mathbf{F} = \\mathbf{Q}_{1}\\,\\mathbf{\\Sigma}\\,\\mathbf{Q}_{2}^{\\mathsf{T}}\n$$\n这里，$\\mathbf{\\Sigma} = \\mathrm{diag}(\\sigma_{1}, \\sigma_{2}, \\sigma_{3})$ 是一个奇异值对角矩阵，$\\mathbf{Q}_{1}, \\mathbf{Q}_{2}$ 是正常正交矩阵（旋转）。这些旋转矩阵是通过组合 Z-Y-X 外旋构建的，即 $\\mathbf{Q}(\\alpha,\\beta,\\gamma) = \\mathbf{R}_{z}(\\gamma)\\,\\mathbf{R}_{y}(\\beta)\\,\\mathbf{R}_{x}(\\alpha)$，使用所提供的关于笛卡尔坐标轴的旋转定义。\n\n#### **2. 策略 A：基于 SVD 的参考解**\n\n该策略利用 $\\mathbf{F}$ 的 SVD 直接构建极分解的各个分量。$\\mathbf{F}$ 的 SVD 由下式给出：\n$$\n\\mathbf{F} = \\mathbf{W}\\mathbf{\\Sigma}_{\\mathrm{svd}}\\mathbf{Z}^{\\mathsf{T}}\n$$\n其中 $\\mathbf{W}$ 和 $\\mathbf{Z}$ 是正交矩阵，$\\mathbf{\\Sigma}_{\\mathrm{svd}}$ 是包含 $\\mathbf{F}$ 奇异值（按降序排列）的对角矩阵。通过将其与极分解 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 进行比较，我们可以确定旋转和拉伸张量。\n\n旋转张量 $\\mathbf{R}$ 和右拉伸张量 $\\mathbf{U}$ 可以表示为：\n$$\n\\mathbf{R} = \\mathbf{W}\\mathbf{Z}^{\\mathsf{T}}\n$$\n$$\n\\mathbf{U} = \\mathbf{Z}\\mathbf{\\Sigma}_{\\mathrm{svd}}\\mathbf{Z}^{\\mathsf{T}}\n$$\n由于问题指定了保向变形（$J = \\det \\mathbf{F}  0$），且奇异值为正，我们必须有 $\\det(\\mathbf{W}\\mathbf{Z}^{\\mathsf{T}}) = +1$。因此，这样构造的 $\\mathbf{R}$ 是一个正常的旋转。这种方法被认为是计算极分解最鲁棒的方式，并作为我们的参考解。\n\n参考量计算如下：\n- $\\mathbf{R}_{\\mathrm{svd}} = \\mathbf{W}\\mathbf{Z}^{\\mathsf{T}}$\n- $\\mathbf{U}_{\\mathrm{ref}} = \\mathbf{Z}\\mathbf{\\Sigma}_{\\mathrm{svd}}\\mathbf{Z}^{\\mathsf{T}}$\n- $\\mathbf{V}_{\\mathrm{ref}} = \\mathbf{W}\\mathbf{\\Sigma}_{\\mathrm{svd}}\\mathbf{W}^{\\mathsf{T}}$ (因为 $\\mathbf{V} = \\mathbf{R}\\mathbf{U}\\mathbf{R}^{\\mathsf{T}}$)\n\n这些公式确保了 $\\mathbf{U}_{\\mathrm{ref}}$ 和 $\\mathbf{V}_{\\mathrm{ref}}$ 是完全对称的，符合其定义。\n\n#### **3. 策略 B：基于迭代的牛顿法**\n\n该策略通过迭代地强制执行正交条件 $\\mathbf{R}^{\\mathsf{T}}\\mathbf{R} = \\mathbf{I}$ 来寻找旋转 $\\mathbf{R}$。一个经典且鲁棒的迭代方法是 Newton-Schulz 方法的缩放版本。从 $\\mathbf{R}_{0} = \\mathbf{F}$ 开始，迭代过程如下：\n$$\n\\mathbf{R}_{k+1} = \\frac{1}{2}\\left(\\mu_k \\mathbf{R}_k + \\frac{1}{\\mu_k}\\mathbf{R}_k^{-\\mathsf{T}}\\right)\n$$\n缩放因子 $\\mu_k$ 对于数值稳定性至关重要，特别是当 $\\mathbf{R}_k$ 病态时（因为 $\\mathbf{R}_0=\\mathbf{F}$ 就是病态的）。一个实用且有效的缩放因子选择是，旨在平衡更新中两项的范数：\n$$\n\\mu_k = \\left( \\frac{\\|\\mathbf{R}_k^{-1}\\|_F}{\\|\\mathbf{R}_k\\|_F} \\right)^{1/2}\n$$\n一旦迭代值足够接近正交，该迭代将表现出二次收敛。主要挑战是在每一步计算矩阵的逆 $\\mathbf{R}_k^{-1}$，如果 $\\mathbf{R}_k$ 近奇异，这个计算可能不准确。这正是本问题所测试的情景。\n\n当满足以下条件之一时，迭代终止：\n1. 正交性缺陷 $e_R(\\mathbf{R}_{k+1}) = \\|\\mathbf{R}_{k+1}^{\\mathsf{T}}\\mathbf{R}_{k+1} - \\mathbf{I}\\|_{F}$ 低于 $10^{-12}$ 的容差。\n2. 连续迭代的相对变化 $\\|\\mathbf{R}_{k+1} - \\mathbf{R}_k\\|_F / \\|\\mathbf{R}_k\\|_F$ 小于 $10^{-12}$。\n3. 达到最大迭代次数 $100$ 次。\n\n#### **4. 误差量化**\n\n一旦计算出 $\\mathbf{R}_{\\mathrm{svd}}$ 和 $\\mathbf{R}_{\\mathrm{new}}$，我们便根据策略 A 的参考解来评估策略 B 的性能。\n\n- 计算雅可比行列式 $J = \\det \\mathbf{F}$。\n- 对 $\\mathbf{R}_{\\mathrm{svd}}$ 和 $\\mathbf{R}_{\\mathrm{new}}$ 评估正交性缺陷 $e_R$。\n- 从 $\\mathbf{R}_{\\mathrm{new}}$ 计算 $\\mathbf{U}_{\\mathrm{new}} = \\mathbf{R}_{\\mathrm{new}}^{\\mathsf{T}}\\mathbf{F}$ 和 $\\mathbf{V}_{\\mathrm{new}} = \\mathbf{F}\\mathbf{R}_{\\mathrm{new}}^{\\mathsf{T}}$。由于 $\\mathbf{R}_{\\mathrm{new}}$ 的近似性，这些量不保证是对称的。\n- 因此，我们取其对称部分：$\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}})$ 和 $\\operatorname{sym}(\\mathbf{V}_{\\mathrm{new}})$。\n- 相对误差 $e_U$ 和 $e_V$ 量化了从策略 B 导出的拉伸张量的对称部分与策略 A 的参考拉伸张量的匹配程度。\n- 最后，通过验证计算出的拉伸 $\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}})$ 的最小特征值是否严格为正，来检查其对称正定性。这是拉伸张量的一个关键物理和数学要求。使用专门的、稳定的算法为对称矩阵 $\\operatorname{sym}(\\mathbf{U}_{\\mathrm{new}})$ 计算特征值。\n\n这一全面的分析将揭示通过迭代方案计算旋转 $\\mathbf{R}$ 时的数值误差如何传播到拉伸张量中，尤其是在近奇异这一具有挑战性的情况下。", "answer": "[[0.108, 4.215501869384469e-16, 2.809971987515093e-16, 1.7042436814238515e-16, 1.7042436814238515e-16, True],[0.00098, 4.015694206587425e-16, 1.5544415891398822e-15, 6.702758123284904e-16, 6.702758123284904e-16, True],[8.8e-07, 3.869305333917835e-16, 5.093170329971936e-15, 2.1287957731777085e-15, 2.1287957731777085e-15, True],[1e-07, 3.491689725945328e-16, 1.0186340659943872e-13, 1.341147043350174e-14, 1.341147043350174e-14, True],[5.0e-09, 3.197442310920455e-16, 4.416801389816001e-12, 1.7852101962386546e-13, 8.847525389658253e-06, True]]", "id": "3564980"}]}