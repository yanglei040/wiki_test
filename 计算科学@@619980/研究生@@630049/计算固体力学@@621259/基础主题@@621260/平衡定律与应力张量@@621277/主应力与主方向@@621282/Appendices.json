{"hands_on_practices": [{"introduction": "二维平面应力状态是分析薄板或结构表面应力的基本模型。本练习将引导你从特征值问题的基本定义出发，为一个给定的二维应力张量计算其主应力与主方向 [@problem_id:3590570]。通过解决这个问题，你将巩固对主方向（即牵引力与作用面垂直，剪应力为零的方向）这一物理概念如何直接转化为固体力学中的数学特征值问题的理解。", "problem": "在一个材料点上，使用柯西应力张量分析一个处于平面应力状态下的薄正交各向异性板。在与材料轴对齐的固定笛卡尔基中，应力张量的非零分量为 $\\,\\sigma_{xx}=75\\,\\text{MPa},\\,\\sigma_{yy}=25\\,\\text{MPa},\\,\\sigma_{xy}=-20\\,\\text{MPa}\\,$，根据对称性有 $\\,\\sigma_{xy}=\\sigma_{yx}\\,$。仅使用面力定义 $\\,\\boldsymbol{t}(\\boldsymbol{n})=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,$、主方向的特征（即面力与法线共线，或剪切面力为零）以及柯西应力张量的性质，推导此二维状态下的主应力和主方向。\n\n任务：\n- 从 $\\,\\boldsymbol{t}(\\boldsymbol{n}) \\parallel \\boldsymbol{n}\\,$ 所蕴含的特征值问题出发，求出主应力的闭式解析表达式，以及它们对应的从 $x$ 轴测量的角度表示的主方向。\n- 通过对 $2\\times 2$ 柯西应力张量进行显式的矩阵特征分解，来独立地验证你的结果。\n- 使用应力不变量交叉检验主应力。\n\n将最终结果以一个单行矩阵的形式给出，该矩阵包含四个条目，顺序如下：两个主应力 $\\,\\sigma_{1},\\sigma_{2}\\,$（以 $\\text{MPa}$ 为单位），然后是两个主方向角 $\\,\\theta_{1},\\theta_{2}\\,$（以度为单位），其中 $\\,\\theta_{1}\\,$ 是最大主应力方向相对于 $x$ 轴的方向角，取值范围在 $(-90^{\\circ},90^{\\circ})$ 内，$\\,\\theta_{2}\\,$ 是最小主应力方向的方向角。无需四舍五入；请提供精确的闭式表达式。在适当的情况下，通过包含因子 $\\,180/\\pi\\,$ 来明确地以度为单位表示角度。", "solution": "这个问题是有效的，因为它在计算固体力学领域提出了一个具有所有必要数据且适定的、有科学依据的问题。\n\n材料点的平面应力状态由柯西应力张量 $\\boldsymbol{\\sigma}$ 描述。在给定的笛卡尔基 ($x, y$) 中，该张量可以表示为矩阵：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx}  \\sigma_{xy} \\\\ \\sigma_{yx}  \\sigma_{yy} \\end{pmatrix} = \\begin{pmatrix} 75  -20 \\\\ -20  25 \\end{pmatrix} \\, \\text{MPa}\n$$\n根据定义，主方向（由单位法向量 $\\boldsymbol{n}$ 表示）是一个面力向量 $\\boldsymbol{t}(\\boldsymbol{n}) = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 与法向量 $\\boldsymbol{n}$ 共线的方向。在这种情况下，面力向量的大小就是主应力，记为 $\\lambda$。此关系表示为：\n$$\n\\boldsymbol{\\sigma}\\boldsymbol{n} = \\lambda\\boldsymbol{n}\n$$\n这是标准的特征值问题。它可以重写为：\n$$\n(\\boldsymbol{\\sigma} - \\lambda\\boldsymbol{I})\\boldsymbol{n} = \\boldsymbol{0}\n$$\n其中 $\\boldsymbol{I}$ 是 $2 \\times 2$ 单位矩阵，$\\boldsymbol{0}$ 是零向量。为了使主方向 $\\boldsymbol{n}$ 存在非平凡解，系数矩阵的行列式必须为零。这给出了特征方程：\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda\\boldsymbol{I}) = 0\n$$\n代入 $\\boldsymbol{\\sigma}$ 的分量：\n$$\n\\det \\begin{pmatrix} 75 - \\lambda  -20 \\\\ -20  25 - \\lambda \\end{pmatrix} = 0\n$$\n展开行列式，我们得到一个关于主应力 $\\lambda$ 的二次方程：\n$$\n(75 - \\lambda)(25 - \\lambda) - (-20)(-20) = 0\n$$\n$$\n1875 - 75\\lambda - 25\\lambda + \\lambda^2 - 400 = 0\n$$\n$$\n\\lambda^2 - 100\\lambda + 1475 = 0\n$$\n我们使用二次求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 来解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{100 \\pm \\sqrt{(-100)^2 - 4(1)(1475)}}{2(1)} = \\frac{100 \\pm \\sqrt{10000 - 5900}}{2} = \\frac{100 \\pm \\sqrt{4100}}{2}\n$$\n$$\n\\lambda = \\frac{100 \\pm 10\\sqrt{41}}{2} = 50 \\pm 5\\sqrt{41}\n$$\n两个主应力就是这两个根。按照惯例，最大主应力 $\\sigma_1$ 是代数值较大的那个，最小主应力 $\\sigma_2$ 是较小的那个。\n$$\n\\sigma_1 = 50 + 5\\sqrt{41} \\, \\text{MPa}\n$$\n$$\n\\sigma_2 = 50 - 5\\sqrt{41} \\, \\text{MPa}\n$$\n\n接下来，我们通过求解与每个主应力（特征值）$\\lambda$ 相关的特征向量 $\\boldsymbol{n}$ 来找到主方向。主方向可以用一个从正 $x$ 轴逆时针测量的角度 $\\theta$ 来描述，因此 $\\boldsymbol{n} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$。\n\n对于最大主应力 $\\sigma_1 = 50 + 5\\sqrt{41}$：\n$$\n(\\boldsymbol{\\sigma} - \\sigma_1\\boldsymbol{I})\\boldsymbol{n}_1 = \\boldsymbol{0}\n$$\n$$\n\\begin{pmatrix} 75 - (50 + 5\\sqrt{41})  -20 \\\\ -20  25 - (50 + 5\\sqrt{41}) \\end{pmatrix} \\begin{pmatrix} n_{1x} \\\\ n_{1y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 25 - 5\\sqrt{41}  -20 \\\\ -20  -25 - 5\\sqrt{41} \\end{pmatrix} \\begin{pmatrix} n_{1x} \\\\ n_{1y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行，我们得到：\n$$\n(25 - 5\\sqrt{41})n_{1x} - 20n_{1y} = 0\n$$\n主角度 $\\theta_1$ 的正切是法向量分量的比值，即 $\\tan\\theta_1 = \\frac{n_{1y}}{n_{1x}}$：\n$$\n\\tan\\theta_1 = \\frac{25 - 5\\sqrt{41}}{20} = \\frac{5 - \\sqrt{41}}{4}\n$$\n因此角度 $\\theta_1$ 为 $\\theta_1 = \\arctan\\left(\\frac{5 - \\sqrt{41}}{4}\\right)$。由于 $\\sqrt{41} > 5$，自变量为负，这使得 $\\theta_1$ 位于区间 $(-90^{\\circ}, 0^{\\circ})$ 内，满足了 $\\theta_1$ 在 $(-90^{\\circ}, 90^{\\circ})$ 内的要求。\n\n对于最小主应力 $\\sigma_2 = 50 - 5\\sqrt{41}$，其方向 $\\boldsymbol{n}_2$ 可以用类似的方法求得：\n$$\n(\\boldsymbol{\\sigma} - \\sigma_2\\boldsymbol{I})\\boldsymbol{n}_2 = \\boldsymbol{0}\n$$\n$$\n\\begin{pmatrix} 75 - (50 - 5\\sqrt{41})  -20 \\\\ -20  25 - (50 - 5\\sqrt{41}) \\end{pmatrix} \\begin{pmatrix} n_{2x} \\\\ n_{2y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 25 + 5\\sqrt{41}  -20 \\\\ -20  -25 + 5\\sqrt{41} \\end{pmatrix} \\begin{pmatrix} n_{2x} \\\\ n_{2y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行：\n$$\n(25 + 5\\sqrt{41})n_{2x} - 20n_{2y} = 0\n$$\n$$\n\\tan\\theta_2 = \\frac{n_{2y}}{n_{2x}} = \\frac{25 + 5\\sqrt{41}}{20} = \\frac{5 + \\sqrt{41}}{4}\n$$\n主方向是相互正交的，所以 $\\theta_2 = \\theta_1 + 90^\\circ$。我们可以验证这一点：$\\tan\\theta_2 = \\tan(\\theta_1+90^\\circ) = -\\cot\\theta_1 = -1/\\tan\\theta_1$。\n$$\n-\\frac{1}{\\tan\\theta_1} = -\\frac{1}{\\frac{5 - \\sqrt{41}}{4}} = \\frac{-4}{5 - \\sqrt{41}} = \\frac{-4(5 + \\sqrt{41})}{(5 - \\sqrt{41})(5 + \\sqrt{41})} = \\frac{-4(5 + \\sqrt{41})}{25 - 41} = \\frac{-4(5 + \\sqrt{41})}{-16} = \\frac{5 + \\sqrt{41}}{4} = \\tan\\theta_2\n$$\n正交性得到确认。为了按要求以度为单位表示角度，我们乘以转换因子 $\\frac{180}{\\pi}$。\n$$\n\\theta_1 = \\frac{180}{\\pi}\\arctan\\left(\\frac{5 - \\sqrt{41}}{4}\\right)\n$$\n$$\n\\theta_2 = \\frac{180}{\\pi}\\arctan\\left(\\frac{5 + \\sqrt{41}}{4}\\right)\n$$\n\n第二个任务是通过执行矩阵特征分解来验证结果。上述整个过程正是求解矩阵 $\\boldsymbol{\\sigma}$ 的特征值（$\\lambda$）和特征向量（$\\boldsymbol{n}$）的解析方法。主应力是特征值，主方向是特征向量的方向。因此，该计算已经完成，并由其自身定义所验证。\n\n第三个任务是使用应力不变量进行交叉检验。对于二维应力状态，第一和第二不变量是：\n$I_1 = \\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{xx} + \\sigma_{yy}$\n$I_2 = \\det(\\boldsymbol{\\sigma}) = \\sigma_{xx}\\sigma_{yy} - \\sigma_{xy}^2$\n特征方程为 $\\lambda^2 - I_1\\lambda + I_2 = 0$。\n使用给定的应力分量：\n$I_1 = 75 + 25 = 100$\n$I_2 = (75)(25) - (-20)^2 = 1875 - 400 = 1475$\n这给出了特征方程 $\\lambda^2 - 100\\lambda + 1475 = 0$，与我们的推导相符。\n\n在任何坐标系中，包括主坐标系，不变量必须是相同的。在主基中，应力张量是对角的，对角线上的元素是主应力。因此：\n$I_1 = \\sigma_1 + \\sigma_2$\n$I_2 = \\sigma_1 \\sigma_2$\n使用我们计算出的主应力：\n$I_1 = (50 + 5\\sqrt{41}) + (50 - 5\\sqrt{41}) = 100$\n$I_2 = (50 + 5\\sqrt{41})(50 - 5\\sqrt{41}) = 50^2 - (5\\sqrt{41})^2 = 2500 - 25(41) = 2500 - 1025 = 1475$\n从 $xy$ 基中的分量计算出的不变量与从主应力计算出的不变量相匹配。这为我们的结果提供了成功的交叉检验。\n\n最终结果：\n最大主应力：$\\sigma_1 = 50 + 5\\sqrt{41} \\, \\text{MPa}$\n最小主应力：$\\sigma_2 = 50 - 5\\sqrt{41} \\, \\text{MPa}$\n最大主方向角：$\\theta_1 = \\frac{180}{\\pi}\\arctan\\left(\\frac{5 - \\sqrt{41}}{4}\\right)$ 度\n最小主方向角：$\\theta_2 = \\frac{180}{\\pi}\\arctan\\left(\\frac{5 + \\sqrt{41}}{4}\\right)$ 度", "answer": "$$\n\\boxed{\\begin{pmatrix} 50 + 5\\sqrt{41} & 50 - 5\\sqrt{41} & \\frac{180}{\\pi}\\arctan\\left(\\frac{5 - \\sqrt{41}}{4}\\right) & \\frac{180}{\\pi}\\arctan\\left(\\frac{5 + \\sqrt{41}}{4}\\right) \\end{pmatrix}}\n$$", "id": "3590570"}, {"introduction": "在二维分析的基础上，我们现在转向更具普遍性的三维应力状态，这对于分析块状材料至关重要。本练习要求你通过求解特征三次方程来找到一个三维张量的主应力，并利用应力不变量来验证结果 [@problem_id:3590598]。这项实践不仅将你的计算能力扩展到三维空间，还展示了应力不变量的强大作用——这些量不随坐标系的旋转而改变，反映了应力状态的内在物理属性。", "problem": "一个均匀连续体在一个物质点处受到对称柯西应力张量 $\\boldsymbol{\\sigma}$（单位为兆帕）的作用，其表达式为\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}90 & 40 & 0\\\\ 40 & 60 & 0\\\\ 0 & 0 & 30\\end{bmatrix}.\n$$\n从第一性原理出发，使用应力不变量的定义，即它们是由行列式 $\\det\\!\\left(\\boldsymbol{\\sigma}-\\lambda \\mathbf{I}\\right)=0$（其中 $\\mathbf{I}$ 是单位张量，$\\lambda$ 是一个标量）生成的特征多项式的系数，来：\n- 构建特征多项式，并确定 $\\boldsymbol{\\sigma}$ 的第一、第二和第三不变量 $I_1$、$I_2$、$I_3$。\n- 求解关于 $\\lambda$ 的特征多项式，以获得 $\\boldsymbol{\\sigma}$ 的主应力。\n- 通过用计算出的主应力重构 $I_1$、$I_2$ 和 $I_3$，并将它们与之前的值进行比较，来验证结果的一致性。\n\n提供精确值，不要四舍五入。应力单位使用兆帕，不变量单位使用兆帕的相应次幂。在最终的方框答案中，仅以单行向量的形式列出无量纲的数值，顺序为 $\\left(I_1, I_2, I_3, \\lambda_1, \\lambda_2, \\lambda_3\\right)$，且满足 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$。", "solution": "问题要求从特征多项式出发，求出给定柯西应力张量的不变量和主应力。该过程包括三个主要步骤：构建多项式以求出不变量，求解多项式以求出主应力，以及验证两组结果之间的一致性。\n\n给定的对称柯西应力张量为：\n$$\n\\boldsymbol{\\sigma}=\\begin{bmatrix}90 & 40 & 0\\\\ 40 & 60 & 0\\\\ 0 & 0 & 30\\end{bmatrix} \\text{ MPa}\n$$\n\n主应力（记为 $\\lambda$）是应力张量 $\\boldsymbol{\\sigma}$ 的特征值。它们是特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是 $3 \\times 3$ 的单位矩阵。\n\n首先，我们构建矩阵 $(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I})$：\n$$\n\\boldsymbol{\\sigma} - \\lambda \\mathbf{I} = \\begin{bmatrix}\n90-\\lambda & 40 & 0 \\\\\n40 & 60-\\lambda & 0 \\\\\n0 & 0 & 30-\\lambda\n\\end{bmatrix}\n$$\n\n接下来，我们计算该矩阵的行列式：\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (90-\\lambda) \\begin{vmatrix} 60-\\lambda & 0 \\\\ 0 & 30-\\lambda \\end{vmatrix} - 40 \\begin{vmatrix} 40 & 0 \\\\ 0 & 30-\\lambda \\end{vmatrix} + 0 \\begin{vmatrix} 40 & 60-\\lambda \\\\ 0 & 0 \\end{vmatrix}\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (90-\\lambda)\\left[(60-\\lambda)(30-\\lambda) - 0\\right] - 40\\left[40(30-\\lambda) - 0\\right]\n$$\n使用沿第三行的代数余子式展开进行计算更为直接：\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (30-\\lambda) \\begin{vmatrix} 90-\\lambda & 40 \\\\ 40 & 60-\\lambda \\end{vmatrix}\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (30-\\lambda) \\left[ (90-\\lambda)(60-\\lambda) - (40)(40) \\right]\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (30-\\lambda) \\left[ (5400 - 90\\lambda - 60\\lambda + \\lambda^2) - 1600 \\right]\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = (30-\\lambda) \\left[ \\lambda^2 - 150\\lambda + 3800 \\right]\n$$\n展开此表达式得到特征多项式：\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = 30\\lambda^2 - 4500\\lambda + 114000 - \\lambda^3 + 150\\lambda^2 - 3800\\lambda\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = -\\lambda^3 + (30+150)\\lambda^2 + (-4500-3800)\\lambda + 114000\n$$\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = -\\lambda^3 + 180\\lambda^2 - 8300\\lambda + 114000\n$$\n$3 \\times 3$ 张量的特征多项式标准形式为 $\\lambda^3 - I_1\\lambda^2 + I_2\\lambda - I_3 = 0$。为了匹配此形式，我们将方程 $\\det(\\boldsymbol{\\sigma} - \\lambda \\mathbf{I}) = 0$ 乘以 $-1$：\n$$\n\\lambda^3 - 180\\lambda^2 + 8300\\lambda - 114000 = 0\n$$\n通过将此多项式的系数与标准形式进行比较，我们确定第一（$I_1$）、第二（$I_2$）和第三（$I_3$）应力不变量：\n$$\nI_1 = 180\n$$\n$$\nI_2 = 8300\n$$\n$$\nI_3 = 114000\n$$\n这些不变量的单位由应力单位（MPa）导出：$I_1$ 的单位是 MPa，$I_2$ 的单位是 (MPa)$^2$，$I_3$ 的单位是 (MPa)$^3$。题目要求的是无量纲的数值。\n\n现在，我们求解关于 $\\lambda$ 的特征方程以求出主应力。使用因式分解形式最有效：\n$$\n(30-\\lambda) (\\lambda^2 - 150\\lambda + 3800) = 0\n$$\n从第一个因式可以立即看出一个根：\n$$\n30 - \\lambda = 0 \\implies \\lambda = 30\n$$\n另外两个根通过求解二次方程得到：\n$$\n\\lambda^2 - 150\\lambda + 3800 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=1$，$b=-150$，$c=3800$：\n$$\n\\lambda = \\frac{-(-150) \\pm \\sqrt{(-150)^2 - 4(1)(3800)}}{2(1)}\n$$\n$$\n\\lambda = \\frac{150 \\pm \\sqrt{22500 - 15200}}{2}\n$$\n$$\n\\lambda = \\frac{150 \\pm \\sqrt{7300}}{2}\n$$\n化简平方根：$\\sqrt{7300} = \\sqrt{100 \\times 73} = 10\\sqrt{73}$。\n$$\n\\lambda = \\frac{150 \\pm 10\\sqrt{73}}{2} = 75 \\pm 5\\sqrt{73}\n$$\n三个主应力是 $\\lambda = 30$、$\\lambda = 75 + 5\\sqrt{73}$ 和 $\\lambda = 75 - 5\\sqrt{73}$。我们必须按 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$ 的顺序排列它们。\n因为 $8^2 = 64$ 且 $9^2 = 81$，所以 $\\sqrt{73}$ 在 8 和 9 之间。\n$5\\sqrt{73}$ 大约是 $5 \\times 8.54 \\approx 42.7$。\n所以，$75 + 5\\sqrt{73} \\approx 75 + 42.7 = 117.7$。\n而 $75 - 5\\sqrt{73} \\approx 75 - 42.7 = 32.3$。\n因此，排序后的主应力（单位为 MPa）是：\n$$\n\\lambda_1 = 75 + 5\\sqrt{73}\n$$\n$$\n\\lambda_2 = 75 - 5\\sqrt{73}\n$$\n$$\n\\lambda_3 = 30\n$$\n\n最后，我们通过用计算出的主应力 $\\lambda_1, \\lambda_2, \\lambda_3$ 重构不变量 $I_1, I_2, I_3$ 来验证一致性。用主应力表示的不变量定义如下：\n$I_1 = \\lambda_1 + \\lambda_2 + \\lambda_3$\n$I_2 = \\lambda_1\\lambda_2 + \\lambda_2\\lambda_3 + \\lambda_3\\lambda_1$\n$I_3 = \\lambda_1\\lambda_2\\lambda_3$\n\n我们来计算这些值：\n对于 $I_1$：\n$$\nI_1 = (75 + 5\\sqrt{73}) + (75 - 5\\sqrt{73}) + 30 = 75 + 75 + 30 = 180\n$$\n这与从特征多项式中求得的 $I_1$ 值相符。\n\n对于 $I_2$：\n$$\n\\lambda_1\\lambda_2 = (75 + 5\\sqrt{73})(75 - 5\\sqrt{73}) = 75^2 - (5\\sqrt{73})^2 = 5625 - 25(73) = 5625 - 1825 = 3800\n$$\n$$\n\\lambda_2\\lambda_3 + \\lambda_3\\lambda_1 = \\lambda_3(\\lambda_1 + \\lambda_2) = 30((75 + 5\\sqrt{73}) + (75 - 5\\sqrt{73})) = 30(150) = 4500\n$$\n$$\nI_2 = 3800 + 4500 = 8300\n$$\n这与从特征多项式中求得的 $I_2$ 值相符。\n\n对于 $I_3$：\n$$\nI_3 = \\lambda_1\\lambda_2\\lambda_3 = (3800)(30) = 114000\n$$\n这与从特征多项式中求得的 $I_3$ 值相符。\n\n一致性得到验证。所要求的量是 $I_1, I_2, I_3, \\lambda_1, \\lambda_2, \\lambda_3$ 的无量纲数值。\n$I_1 = 180$\n$I_2 = 8300$\n$I_3 = 114000$\n$\\lambda_1 = 75 + 5\\sqrt{73}$\n$\\lambda_2 = 75 - 5\\sqrt{73}$\n$\\lambda_3 = 30$\n\n最终答案以行向量的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 180 & 8300 & 114000 & 75 + 5\\sqrt{73} & 75 - 5\\sqrt{73} & 30 \\end{pmatrix}}\n$$", "id": "3590598"}, {"introduction": "在计算固体力学中，数值算法取代了手动计算，因此确保这些算法的准确性对于可靠的模拟至关重要。最后一个练习要求你设计一个单元测试套件，通过一系列典型的应力状态（如单轴拉伸、纯剪切和静水压力）来验证一个计算主应力与主方向的程序 [@problem_id:3590517]。这项任务将理论与计算实践相结合，教你如何系统地验证数值代码、处理数值公差以及正确管理简并特征值（例如在静水压力下）等特殊情况，这些都是计算工程师必备的关键技能。", "problem": "考虑一个三维柯西应力张量，定义为一个实的、对称的 $3\\times3$ 矩阵 $\\boldsymbol{\\sigma}$。在计算固体力学中，主应力和主方向通过求解 $\\boldsymbol{\\sigma}$ 的特征值问题得到，其中主应力是特征值，主方向是相关的单位特征向量。$\\boldsymbol{\\sigma}$ 的对称性源于角动量守恒，这确保了 $\\boldsymbol{\\sigma}$ 具有实特征值和一组标准正交的特征向量基。任务是设计并实现一个程序，使用一组规范应力状态的单元测试套件，来验证用于计算主应力和主方向的特征分解实现。测试套件中所有的应力大小均以帕斯卡（$\\text{Pa}$）为单位指定，所有计算出的主应力也必须以帕斯卡（$\\text{Pa}$）表示。本问题不要求计算角度。\n\n您的程序必须实现以下逻辑：\n- 给定一个对称的 $3\\times3$ 应力张量 $\\boldsymbol{\\sigma}$，计算其特征值和标准正交特征向量，并将特征值按降序排列 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$，相应地重排特征向量。每个特征向量必须归一化为单位长度，并且其符号是任意的（即 $\\mathbf{n}$ 和 $-\\mathbf{n}$ 表示相同的主方向）。\n- 比较主应力时，使用绝对公差 $10^{-6}$ 和相对公差 $10^{-12}$。对于方向比较，使用单位向量对齐公差，定义为 $1 - |\\mathbf{n}\\cdot\\mathbf{n}_{\\text{ref}}| \\le 10^{-12}$，这考虑了特征向量的任意符号。\n- 正确处理简并情况：当特征值重复时，相应特征空间内的特征向量不是唯一的。在这种情况下，仅验证特征值和下文所述的任何必需的子空间属性，而不验证特征向量的具体方向。\n\n构建并验证以下规范应力状态：\n1. $x$方向的单轴拉伸：\n   $$\\boldsymbol{\\sigma}_{\\text{uni}} = \\begin{bmatrix} 150\\times10^6 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\ \\text{Pa}.$$\n   期望的主应力为 $[150\\times10^6, 0, 0]\\ \\text{Pa}$。与 $150\\times10^6\\ \\text{Pa}$ 对应的主方向必须与 $\\mathbf{e}_1 = [1, 0, 0]^T$ 对齐。其余两个主方向张成与 $\\mathbf{e}_1$ 正交的平面，并且不是唯一确定的，因此无需检查它们的具体方向。\n2. 与 $x$ 和 $y$ 轴对齐的双轴状态：\n   $$\\boldsymbol{\\sigma}_{\\text{bi}} = \\begin{bmatrix} 120\\times10^6 & 0 & 0 \\\\ 0 & 80\\times10^6 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\ \\text{Pa}.$$\n   期望的主应力为 $[120\\times10^6, 80\\times10^6, 0]\\ \\text{Pa}$，主方向分别与 $\\mathbf{e}_1$、$\\mathbf{e}_2$ 和 $\\mathbf{e}_3$ 对齐（符号任意）。\n3. 具有不同法向应力的三轴状态：\n   $$\\boldsymbol{\\sigma}_{\\text{tri}} = \\begin{bmatrix} 200\\times10^6 & 0 & 0 \\\\ 0 & 100\\times10^6 & 0 \\\\ 0 & 0 & 60\\times10^6 \\end{bmatrix}\\ \\text{Pa}.$$\n   期望的主应力为 $[200\\times10^6, 100\\times10^6, 60\\times10^6]\\ \\text{Pa}$，主方向分别与 $\\mathbf{e}_1$、$\\mathbf{e}_2$ 和 $\\mathbf{e}_3$ 对齐（符号任意）。\n4. $xy$平面内的纯剪切：\n   $$\\boldsymbol{\\sigma}_{\\text{shear}} = \\begin{bmatrix} 0 & 40\\times10^6 & 0 \\\\ 40\\times10^6 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\ \\text{Pa}.$$\n   期望的主应力为 $[40\\times10^6, 0, -40\\times10^6]\\ \\text{Pa}$。主方向是单位向量，分别为：与 $40\\times10^6\\ \\text{Pa}$ 关联的 $\\mathbf{n}_{+} = \\frac{1}{\\sqrt{2}}[1, 1, 0]^T$，与 $0\\ \\text{Pa}$ 关联的 $\\mathbf{n}_{0} = [0, 0, 1]^T$，以及与 $-40\\times10^6\\ \\text{Pa}$ 关联的 $\\mathbf{n}_{-} = \\frac{1}{\\sqrt{2}}[1, -1, 0]^T$，每个向量的符号都可以是任意的。\n5. 静水压力：\n   $$\\boldsymbol{\\sigma}_{\\text{hyd}} = 50\\times10^6 \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\\ \\text{Pa}.$$\n   期望的主应力为 $[50\\times10^6, 50\\times10^6, 50\\times10^6]\\ \\text{Pa}$。主方向是任意的，只要它们构成一个标准正交基即可；因此，只需验证特征值。\n\n每个案例的验证标准：\n- 计算主应力和主方向，并验证主应力在指定公差范围内与期望值匹配。\n- 仅在主方向由应力状态唯一确定时，才根据指定的参考方向进行验证；否则，如前所述跳过方向检查。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表值为布尔值。测试用例按上述顺序列出。例如，输出格式必须与 $[r_1,r_2,r_3,r_4,r_5]$ 完全一样，其中每个 $r_i$ 为 $True$ 或 $False$，表示相应的测试用例是否通过了所有必需的验证。", "solution": "该问题要求为应用于 $3\\times3$ 对称柯西应力张量 $\\boldsymbol{\\sigma}$ 的特征分解算法创建一个验证套件。此任务的核心在于连续介质力学和线性代数的基本原理。材料在某点的主应力是应力张量 $\\boldsymbol{\\sigma}$ 的特征值，主方向是对应的单位特征向量。\n\n其控制关系是特征值问题：\n$$\n\\boldsymbol{\\sigma}\\mathbf{n} = \\lambda\\mathbf{n}\n$$\n其中 $\\lambda$ 表示一个主应力（一个特征值），$\\mathbf{n}$ 是相关的主方向（一个单位特征向量）。解 $(\\lambda, \\mathbf{n})$ 通过首先求解特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0$ 的根来找到，这些根就是特征值 $\\lambda_1, \\lambda_2, \\lambda_3$。因为 $\\boldsymbol{\\sigma}$ 是一个实的对称矩阵，所以其特征值保证为实数，并且其特征向量构成一个标准正交基。\n\n验证程序将为提供的每个规范应力状态实现以下步骤：\n\n1.  **特征分解**：对于给定的应力张量 $\\boldsymbol{\\sigma}$，我们将计算其特征值和特征向量。像 NumPy 这样的健壮数值库非常适合此任务。`numpy.linalg.eigh` 函数专为实对称（或复厄米）矩阵设计，能高效地返回实特征值和由相应标准正交特征向量组成的矩阵。\n\n2.  **排序**：问题指定主应力按降序排列：$\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3$。`numpy.linalg.eigh` 函数返回的特征值是升序的。因此，我们必须获得将特征值按降序排列的排序置换，并应用相同的置换来重排相关的特征向量。\n\n3.  **主应力验证**：计算并排序后的主应力 $[\\lambda_1, \\lambda_2, \\lambda_3]$ 必须与期望值进行比较。验证必须考虑到潜在的浮点误差。指定的条件是一个组合的绝对和相对公差检查，对于计算值 $c$ 和期望值 $e$，该检查由以下公式给出：\n    $$\n    |\\,c - e\\,| \\le \\text{atol} + \\text{rtol} \\cdot |\\,e\\,|\n    $$\n    其中绝对公差 $\\text{atol} = 10^{-6}$，相对公差 $\\text{rtol} = 10^{-12}$。此检查将对三个主应力中的每一个执行。\n\n4.  **主方向验证**：当主方向是唯一确定的（即其对应的特征值是非简并的）时，计算出的单位特征向量 $\\mathbf{n}_{\\text{comp}}$ 必须与期望的单位特征向量 $\\mathbf{n}_{\\text{ref}}$ 进行验证。由于特征向量的定义仅在其符号上是任意的（$\\mathbf{n}$ 和 $-\\mathbf{n}$ 都是有效的），因此比较必须对这种任意符号不敏感。指定的验证标准通过检查共线性来实现这一点：\n    $$\n    1 - |\\mathbf{n}_{\\text{comp}} \\cdot \\mathbf{n}_{\\text{ref}}| \\le 10^{-12}\n    $$\n    点积 $\\mathbf{n}_{\\text{comp}} \\cdot \\mathbf{n}_{\\text{ref}}$ 给出两个单位向量之间夹角的余弦值。其绝对值 $|\\mathbf{n}_{\\text{comp}} \\cdot \\mathbf{n}_{\\text{ref}}|$ 考虑了向量是平行或反平行的两种情况。如果这个值接近 $1$，则向量是共线的。\n\n5.  **处理简并性**：如果两个或三个特征值相同（简并情况），则相应的特征向量不是唯一的。简并特征空间内特征向量的任何线性组合也是一个有效的特征向量。问题正确地指明了如何处理这些情况：\n    *   对于单轴拉伸（$\\boldsymbol{\\sigma}_{\\text{uni}}$），两个主应力为零（$\\lambda_2 = \\lambda_3 = 0$）。仅验证唯一特征值 $\\lambda_1 = 150 \\times 10^6\\ \\text{Pa}$ 的主方向。\n    *   对于静水压力（$\\boldsymbol{\\sigma}_{\\text{hyd}}$），所有三个主应力都相等（$\\lambda_1 = \\lambda_2 = \\lambda_3 = 50 \\times 10^6\\ \\text{Pa}$）。任何标准正交基都是一组有效的主方向。因此，只验证主应力；不执行方向检查。\n\n对于一个给定的测试用例，当且仅当所有必需的应力比较和所有必需的方向比较都通过时，整体验证才算通过。程序将对五个指定的规范应力状态中的每一个执行此逻辑，并为每个案例报告一个布尔结果（$True$ 或 $False$）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates an eigendecomposition implementation for principal stresses\n    and directions using a unit-test suite of canonical stress states.\n    \"\"\"\n\n    # Define validation tolerances as specified in the problem.\n    STRESS_ATOL = 1e-6\n    STRESS_RTOL = 1e-12\n    DIRECTION_TOL = 1e-12\n\n    # Define the canonical stress states and their expected solutions.\n    test_cases = [\n        {\n            \"name\": \"Uniaxial tension\",\n            \"sigma\": np.array([\n                [150e6, 0.0, 0.0],\n                [0.0,   0.0, 0.0],\n                [0.0,   0.0, 0.0]\n            ]),\n            \"expected_stresses\": np.array([150e6, 0.0, 0.0]),\n            # For degenerate eigenvalues, only check the unique direction.\n            \"direction_checks\": {0: np.array([1.0, 0.0, 0.0])}\n        },\n        {\n            \"name\": \"Biaxial state\",\n            \"sigma\": np.array([\n                [120e6, 0.0,   0.0],\n                [0.0,   80e6,  0.0],\n                [0.0,   0.0,   0.0]\n            ]),\n            \"expected_stresses\": np.array([120e6, 80e6, 0.0]),\n            # All eigenvalues are distinct, so all directions are unique.\n            \"direction_checks\": {\n                0: np.array([1.0, 0.0, 0.0]),\n                1: np.array([0.0, 1.0, 0.0]),\n                2: np.array([0.0, 0.0, 1.0])\n            }\n        },\n        {\n            \"name\": \"Triaxial state\",\n            \"sigma\": np.array([\n                [200e6, 0.0,   0.0],\n                [0.0,   100e6, 0.0],\n                [0.0,   0.0,   60e6]\n            ]),\n            \"expected_stresses\": np.array([200e6, 100e6, 60e6]),\n            # All eigenvalues are distinct.\n            \"direction_checks\": {\n                0: np.array([1.0, 0.0, 0.0]),\n                1: np.array([0.0, 1.0, 0.0]),\n                2: np.array([0.0, 0.0, 1.0])\n            }\n        },\n        {\n            \"name\": \"Pure shear\",\n            \"sigma\": np.array([\n                [0.0,   40e6, 0.0],\n                [40e6,  0.0,  0.0],\n                [0.0,   0.0,  0.0]\n            ]),\n            \"expected_stresses\": np.array([40e6, 0.0, -40e6]),\n            # All eigenvalues are distinct.\n            \"direction_checks\": {\n                0: np.array([1.0 / np.sqrt(2), 1.0 / np.sqrt(2), 0.0]),\n                1: np.array([0.0, 0.0, 1.0]),\n                2: np.array([1.0 / np.sqrt(2), -1.0 / np.sqrt(2), 0.0])\n            }\n        },\n        {\n            \"name\": \"Hydrostatic pressure\",\n            \"sigma\": np.array([\n                [50e6, 0.0,  0.0],\n                [0.0,  50e6, 0.0],\n                [0.0,  0.0,  50e6]\n            ]),\n            \"expected_stresses\": np.array([50e6, 50e6, 50e6]),\n            # All eigenvalues are degenerate; directions are arbitrary.\n            \"direction_checks\": {}\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        sigma = case[\"sigma\"]\n        expected_stresses = case[\"expected_stresses\"]\n        direction_checks = case[\"direction_checks\"]\n        \n        # Assume the case passes until a check fails.\n        is_valid = True\n        \n        try:\n            # Compute eigenvalues and eigenvectors.\n            # `eigh` is for symmetric matrices and returns results in ascending order.\n            eigenvalues, eigenvectors = np.linalg.eigh(sigma)\n            \n            # Sort eigenvalues and eigenvectors in descending order.\n            sorted_indices = np.argsort(eigenvalues)[::-1]\n            computed_stresses = eigenvalues[sorted_indices]\n            computed_directions = eigenvectors[:, sorted_indices]\n            \n            # 1. Validate principal stresses (eigenvalues).\n            stresses_ok = np.allclose(computed_stresses, expected_stresses,\n                                      rtol=STRESS_RTOL, atol=STRESS_ATOL)\n            if not stresses_ok:\n                is_valid = False\n            \n            # 2. Validate principal directions (eigenvectors) if required.\n            if is_valid:\n                for index, expected_direction in direction_checks.items():\n                    computed_direction = computed_directions[:, index]\n                    \n                    # The alignment check accounts for arbitrary sign: 1 - |v1 . v2| = tol\n                    alignment_error = 1.0 - np.abs(np.dot(computed_direction, expected_direction))\n                    \n                    if alignment_error > DIRECTION_TOL:\n                        is_valid = False\n                        break # A single direction failure invalidates the case.\n\n        except np.linalg.LinAlgError:\n            # Eigendecomposition failed, so the validation fails.\n            is_valid = False\n\n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3590517"}]}