{"hands_on_practices": [{"introduction": "本练习旨在巩固对静态平衡基本原理的理解，即将局部动量守恒定律应用于整个物体。您将通过对一个承受非均匀体力与表面力的三角形单元进行分析，来实践如何从局部平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\mathbf{0}$ 出发，通过高斯散度定理推导出全局力平衡的积分形式。这项实践将帮助您掌握评估体积分和面积分以强制执行全局平衡的计算技能，这是连接连续介质力学理论与实际工程问题的关键一步 ([@problem_id:3547556])。", "problem": "考虑一个棱柱形的平面应力三角形有限元，它占据 $x$–$y$ 平面上的一个直角三角形区域，顶点为 $(0,0)$、$(L,0)$ 和 $(0,H)$，并在 $z$ 方向上均匀拉伸，具有恒定的厚度 $t$。假设为静态构型（无惯性），无体力偶，且所有场都足够光滑。单位体积的体力仅沿 $x$ 方向作用，由 $b_x(x,y) = b_0 + b_1 x$ 给出，其中 $b_0$ 的单位为 $\\mathrm{N}\\,\\mathrm{m}^{-3}$，$b_1$ 的单位为 $\\mathrm{N}\\,\\mathrm{m}^{-4}$。唯一不为零的给定面力是均匀的，作用在连接 $(L,0)$ 和 $(0,H)$ 的斜边上；其恒定矢量值为 $\\boldsymbol{\\bar{t}} = q\\,\\boldsymbol{e}_x$，其中 $q$ 是未知的。所有其他边界段均无面力作用。\n\n从局部线性动量平衡出发，仅使用基本定律和定义（包括通过柯西公式定义的面力），确定标量 $q$ 的唯一值，该值能使单元满足全局力平衡。将 $q$ 的最终答案用 $L$、$H$、$t$、$b_0$ 和 $b_1$ 的符号形式表示。将最终的 $q$ 以帕斯卡（Pa）为单位表示。不要代入数值，也不要调用任何预封装的有限元公式。答案必须是单一的闭式解析表达式。", "solution": "该问题要求找到一个恒定的面力分量 $q$ 的值，以确保棱柱体的全局力平衡。解必须从基本原理出发，从局部线性动量平衡开始推导。\n\n对于处于静态平衡状态且无惯性效应的物体，局部线性动量平衡由柯西第一运动定律表示：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\mathbf{0}\n$$\n此处，$\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{b}$ 是单位体积的体力矢量。为获得全局平衡条件，我们将此局部方程在物体的整个体积 $V$ 上积分：\n$$\n\\int_V (\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b}) \\, dV = \\mathbf{0}\n$$\n根据积分的线性性质，这可以分为两项：\n$$\n\\int_V \\nabla \\cdot \\boldsymbol{\\sigma} \\, dV + \\int_V \\boldsymbol{b} \\, dV = \\mathbf{0}\n$$\n对第一项应用高斯散度定理，将应力张量散度的体积分转换成在物体表面 $S$ 上的面积分：\n$$\n\\int_S (\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}) \\, dS + \\int_V \\boldsymbol{b} \\, dV = \\mathbf{0}\n$$\n其中 $\\boldsymbol{n}$ 是面元 $dS$ 的外法向单位矢量。表面上的牵引力矢量 $\\boldsymbol{t}$ 由柯西公式定义为 $\\boldsymbol{t} = \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}$。代入此定义可得到全局力平衡方程：\n$$\n\\int_V \\boldsymbol{b} \\, dV + \\int_S \\boldsymbol{t} \\, dS = \\mathbf{0}\n$$\n该方程表明，作用在物体上的总体力与总面力的矢量和必须为零。我们将分析此矢量方程的 $x$ 分量，因为问题中所有给定的力都沿 $x$ 轴作用。\n$$\n\\int_V b_x \\, dV + \\int_S t_x \\, dS = 0\n$$\n现在，我们根据给定的问题几何形状和载荷计算每个积分项。\n\n首先，我们计算 $x$ 方向的合体力，即 $\\int_V b_x \\, dV$。该物体是一个棱柱体，在 $x$-$y$ 平面上的一个直角三角形区域 $A$ 上具有均匀的厚度 $t$。$A$ 的顶点为 $(0,0)$、$(L,0)$ 和 $(0,H)$。单位体积的体力由 $\\boldsymbol{b} = (b_0 + b_1 x)\\boldsymbol{e}_x$ 给出，因此其 $x$ 分量为 $b_x(x) = b_0 + b_1 x$。体积分是：\n$$\n\\int_V b_x \\, dV = \\int_0^t \\left( \\iint_A (b_0 + b_1 x) \\, dA \\right) \\, dz\n$$\n由于被积函数和区域 $A$ 与 $z$ 无关，对 $z$ 的积分得到一个因子 $t$：\n$$\n\\int_V b_x \\, dV = t \\iint_A (b_0 + b_1 x) \\, dx \\, dy\n$$\n三角形区域 $A$ 由 $x=0$、$y=0$ 和连接 $(L,0)$ 与 $(0,H)$ 的直线界定，该直线的方程为 $y = H(1 - x/L)$。我们建立二重积分如下：\n$$\n\\iint_A (b_0 + b_1 x) \\, dx \\, dy = \\int_0^L \\int_0^{H(1 - x/L)} (b_0 + b_1 x) \\, dy \\, dx\n$$\n对 $y$ 积分：\n$$\n\\int_0^L (b_0 + b_1 x) [y]_0^{H(1-x/L)} \\, dx = \\int_0^L (b_0 + b_1 x) H(1 - \\frac{x}{L}) \\, dx\n$$\n化简为：\n$$\nH \\int_0^L \\left(b_0 + \\left(b_1 - \\frac{b_0}{L}\\right)x - \\frac{b_1}{L}x^2\\right) \\, dx\n$$\n对 $x$ 积分：\n$$\nH \\left[ b_0 x + \\left(b_1 - \\frac{b_0}{L}\\right)\\frac{x^2}{2} - \\frac{b_1}{L}\\frac{x^3}{3} \\right]_0^L = H \\left( b_0 L + \\left(b_1 - \\frac{b_0}{L}\\right)\\frac{L^2}{2} - \\frac{b_1}{L}\\frac{L^3}{3} \\right)\n$$\n$$\n= H \\left( b_0 L + \\frac{b_1 L^2}{2} - \\frac{b_0 L}{2} - \\frac{b_1 L^2}{3} \\right) = H \\left( \\frac{b_0 L}{2} + \\frac{b_1 L^2}{6} \\right) = \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\n因此，$x$ 方向上的总体力为：\n$$\n\\int_V b_x \\, dV = t \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\n\n接下来，我们计算 $x$ 方向的合面力，即 $\\int_S t_x \\, dS$。问题说明，除了斜面外，所有边界段上的面力都为零。在这个斜面上，给定的面力是一个均匀矢量 $\\boldsymbol{\\bar{t}} = q\\,\\boldsymbol{e}_x$。因此，其 $x$ 分量为 $t_x = q$，其中 $q$ 是一个常数。面积分变为：\n$$\n\\int_S t_x \\, dS = \\int_{S_{\\text{slanted}}} q \\, dS = q \\int_{S_{\\text{slanted}}} dS = q \\cdot \\text{Area}(S_{\\text{slanted}})\n$$\n斜面 $S_{\\text{slanted}}$ 是一个矩形，其厚度为 $t$，长度等于底面三角形的斜边。连接 $(L,0)$ 和 $(0,H)$ 的斜边长度为 $\\sqrt{(L-0)^2 + (0-H)^2} = \\sqrt{L^2 + H^2}$。斜面的面积为：\n$$\n\\text{Area}(S_{\\text{slanted}}) = t \\sqrt{L^2 + H^2}\n$$\n所以，$x$ 方向上的总面力为：\n$$\n\\int_S t_x \\, dS = q t \\sqrt{L^2 + H^2}\n$$\n\n最后，我们将这两个结果代入 $x$ 方向的全局平衡方程：\n$$\nt \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right) + q t \\sqrt{L^2 + H^2} = 0\n$$\n我们求解未知标量 $q$。假设 $t \\neq 0$，我们可以消去厚度 $t$：\n$$\nq \\sqrt{L^2 + H^2} = - \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\n分离出 $q$ 可得：\n$$\nq = - \\frac{LH}{2 \\sqrt{L^2 + H^2}} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\n将括号内的项合并，得到一个单一的分数表达式：\n$$\nq = - \\frac{LH}{2 \\sqrt{L^2 + H^2}} \\left( \\frac{3b_0 + b_1 L}{3} \\right) = - \\frac{LH(3b_0 + b_1L)}{6\\sqrt{L^2 + H^2}}\n$$\n该表达式给出了 $q$ 的唯一值，单位为力每面积（帕斯卡），这是维持单元全局静态平衡所必需的。", "answer": "$$\n\\boxed{- \\frac{LH(3b_0 + b_1L)}{6\\sqrt{L^2 + H^2}}}\n$$", "id": "3547556"}, {"introduction": "在尝试求解一个复杂的边值问题之前，一个关键的步骤是检验所给定的载荷是否满足物理上的一致性。这个思想实验将引导您运用全局平衡定律，即作用在物体上的总合力与总合力矩必须为零，来判断一个给定的体力场和边界牵引场是否构成一个可解的静力学问题。通过对一个圆形域进行分析，您将学会如何通过积分运算来检验这些必要条件，从而掌握在进行复杂分析或数值模拟前进行初步可行性评估的重要技能 ([@problem_id:3547540])。", "problem": "考虑一个单连通的平面棱柱体，其单位厚度，占据圆盘 $\\Omega = \\{(x,y)\\in\\mathbb{R}^2:\\, x^2+y^2\\le R^2\\}$，其光滑边界 $\\partial\\Omega$ 由极角 $\\theta\\in[0,2\\pi)$ 参数化。该物体在惯性参考系中处于静力构型，惯性效应可忽略不计，且无分布力偶作用。存在一个空间均匀的单位面积体力 $\\boldsymbol{b}(\\boldsymbol{x})$，并且沿 $\\partial\\Omega$ 给定了一个单位长度的面力 $\\bar{\\boldsymbol{t}}(\\boldsymbol{x})$。在全文中，设极坐标标准正交基为 $(\\mathbf{e}_r(\\theta),\\mathbf{e}_\\theta(\\theta))$，其中 $\\mathbf{e}_r(\\theta)=\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y$ 且 $\\mathbf{e}_\\theta(\\theta)=-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y$。\n\n数据：\n- 半径 $R=3$。\n- 体力 $\\boldsymbol{b}(\\boldsymbol{x})=b_0\\,\\mathbf{e}_x$，其中 $b_0=-1$。\n- 边界面力 $\\bar{\\boldsymbol{t}}(\\theta)=\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)$，其中 $\\alpha=5$ 且 $\\lambda=2$。\n\n仅使用线性动量守恒、角动量守恒和柯西应力原理（以及面力的定义和面上力与应力的关系），评估是否存在一个对称的柯西应力场 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$，使得该应力场在 $\\Omega$ 内与给定的体力处于局部静力平衡，并在 $\\partial\\Omega$ 上再现给定的边界面力。在您的评估中，请考虑这些定律在 $\\Omega$ 和 $\\partial\\Omega$ 上所蕴含的全局一致性条件。\n\n哪个选项是正确的？\n\nA. 一个与给定的 $\\boldsymbol{b}$ 和 $\\bar{\\boldsymbol{t}}$ 一致的对称柯西应力场 $\\boldsymbol{\\sigma}$ 可以存在，因为在 $\\Omega$ 上的全局力和力矩平衡都由给定的场满足。\n\nB. 不存在这样的 $\\boldsymbol{\\sigma}$，因为由 $\\bar{\\boldsymbol{t}}$ 在 $\\partial\\Omega$ 上产生的绕原点的合力矩非零，且不能被 $\\boldsymbol{b}$ 平衡。\n\nC. 不存在这样的 $\\boldsymbol{\\sigma}$，因为对于给定的 $\\boldsymbol{b}$ 和 $\\bar{\\boldsymbol{t}}$，在 $\\mathbf{e}_x$ 方向上的合力非零。\n\nD. 不存在这样的 $\\boldsymbol{\\sigma}$，因为一个非零的切向面力分量 $\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)$ 与角动量守恒所要求的 $\\boldsymbol{\\sigma}$ 的对称性相矛盾。\n\n注意：您必须基于第一性原理和控制律的全局推论来做出判断；不要假设任何本构关系。任何数学结论都必须仅从所述定律和定义得出，不借助数值求解器（如有限元法(FEM)）或相关偏微分方程(PDE)边值问题的未经证明的存在性定理。", "solution": "从经典柯西连续介质在静力平衡且无分布力偶情况下的基本守恒定律开始：\n\n1. 线性动量守恒（局部形式）：在 $\\Omega$ 中 $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\mathbf{0}$。\n2. 柯西面力公式（局部形式）：在任何具有单位法向量 $\\boldsymbol{n}$ 的有向面上 $\\boldsymbol{t}(\\boldsymbol{n})=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$，特别是在边界 $\\partial\\Omega$ 上，其外法向量为 $\\boldsymbol{n}=\\mathbf{e}_r(\\theta)$，给定的面力必须满足在 $\\partial\\Omega$ 上 $\\boldsymbol{\\sigma}\\,\\boldsymbol{n}=\\bar{\\boldsymbol{t}}$。\n3. 角动量守恒意味着在没有分布力偶的情况下，柯西应力 $\\boldsymbol{\\sigma}$ 是对称的：$\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$。\n\n将局部线性动量守恒在 $\\Omega$ 上积分，并使用散度定理以及边界条件 $\\boldsymbol{\\sigma}\\boldsymbol{n}=\\bar{\\boldsymbol{t}}$，可以得到静力平衡的全局力平衡方程：\n$$\n\\int_{\\Omega}\\boldsymbol{b}\\,dA+\\oint_{\\partial\\Omega}\\bar{\\boldsymbol{t}}\\,ds=\\mathbf{0}.\n$$\n类似地，将角动量守恒在 $\\Omega$ 上积分，并使用 $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$，可得到绕原点的全局力矩平衡方程：\n$$\n\\int_{\\Omega}\\boldsymbol{x}\\times\\boldsymbol{b}\\,dA+\\oint_{\\partial\\Omega}\\boldsymbol{x}\\times\\bar{\\boldsymbol{t}}\\,ds=\\mathbf{0}.\n$$\n\n现在我们根据给定的数据来评估这些全局平衡方程。\n\n用极角 $\\theta\\in[0,2\\pi)$ 参数化 $\\partial\\Omega$：\n- 边界上的位置向量：$\\boldsymbol{x}(\\theta)=R\\,\\mathbf{e}_r(\\theta)$。\n- 弧长微分：$ds=R\\,d\\theta$。\n\n在 $\\partial\\Omega$ 上给定的面力为\n$$\n\\bar{\\boldsymbol{t}}(\\theta)=\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta),\n$$\n其中 $\\alpha=5$，$\\lambda=2$，$R=3$。\n\n首先将 $\\bar{\\boldsymbol{t}}(\\theta)$ 转换为笛卡尔分量以评估合力：\n$$\n\\mathbf{e}_r(\\theta)=\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y,\\quad\n\\mathbf{e}_\\theta(\\theta)=-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y.\n$$\n因此，\n$$\n\\bar{\\boldsymbol{t}}(\\theta)\n=\\alpha\\cos\\theta\\left(\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y\\right)\n+\\lambda\\sin\\theta\\left(-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y\\right),\n$$\n所以笛卡尔分量为\n$$\n\\bar{t}_x(\\theta)\n=\\alpha\\cos^2\\theta-\\lambda\\sin^2\\theta,\\quad\n\\bar{t}_y(\\theta)\n=\\alpha\\cos\\theta\\sin\\theta+\\lambda\\sin\\theta\\cos\\theta.\n$$\n\n全局力平衡。\n边界合力为\n$$\n\\boldsymbol{F}_{\\partial\\Omega}\n=\\oint_{\\partial\\Omega}\\bar{\\boldsymbol{t}}\\,ds\n=R\\int_{0}^{2\\pi}\\bar{\\boldsymbol{t}}(\\theta)\\,d\\theta.\n$$\n计算分量：\n$$\nF^{\\partial\\Omega}_x\n=R\\int_{0}^{2\\pi}\\left(\\alpha\\cos^2\\theta-\\lambda\\sin^2\\theta\\right)\\,d\\theta\n=R\\left(\\alpha\\int_{0}^{2\\pi}\\cos^2\\theta\\,d\\theta-\\lambda\\int_{0}^{2\\pi}\\sin^2\\theta\\,d\\theta\\right)\n=R\\left(\\alpha\\pi-\\lambda\\pi\\right)=\\pi R(\\alpha-\\lambda),\n$$\n因为 $\\int_{0}^{2\\pi}\\cos^2\\theta\\,d\\theta=\\int_{0}^{2\\pi}\\sin^2\\theta\\,d\\theta=\\pi$。\n类似地，\n$$\nF^{\\partial\\Omega}_y\n=R\\int_{0}^{2\\pi}\\left(\\alpha\\cos\\theta\\sin\\theta+\\lambda\\sin\\theta\\cos\\theta\\right)\\,d\\theta\n=R(\\alpha+\\lambda)\\int_{0}^{2\\pi}\\sin\\theta\\cos\\theta\\,d\\theta=0.\n$$\n\n体力合力为\n$$\n\\boldsymbol{F}_{\\Omega}=\\int_{\\Omega}\\boldsymbol{b}\\,dA\n=b_0\\,\\mathbf{e}_x\\int_{\\Omega}dA\n=b_0\\,\\pi R^2\\,\\mathbf{e}_x,\n$$\n没有 $\\mathbf{e}_y$ 分量。\n\n因此，总合力为\n$$\n\\boldsymbol{F}_{\\text{tot}}=\\boldsymbol{F}_{\\Omega}+\\boldsymbol{F}_{\\partial\\Omega}\n=\\left[\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0\\right]\\mathbf{e}_x + 0\\cdot\\mathbf{e}_y.\n$$\n代入 $R=3$，$\\alpha=5$，$\\lambda=2$，$b_0=-1$：\n$$\n\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0\n=\\pi\\cdot 3\\cdot(5-2)+\\pi\\cdot 9\\cdot(-1)\n=9\\pi-9\\pi=0,\n$$\n所以合力为零：$\\boldsymbol{F}_{\\text{tot}}=\\mathbf{0}$。\n\n绕原点的全局力矩平衡（平面外分量）。\n计算边界力矩：\n$$\n\\boldsymbol{M}_{\\partial\\Omega}\n=\\oint_{\\partial\\Omega}\\boldsymbol{x}\\times\\bar{\\boldsymbol{t}}\\,ds\n=R\\int_{0}^{2\\pi}\\big(R\\,\\mathbf{e}_r(\\theta)\\times\\bar{\\boldsymbol{t}}(\\theta)\\big)\\,d\\theta\n=R^2\\int_{0}^{2\\pi}\\left[\\mathbf{e}_r(\\theta)\\times\\left(\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)\\right)\\right]\\,d\\theta.\n$$\n使用 $\\mathbf{e}_r(\\theta)\\times\\mathbf{e}_r(\\theta)=\\mathbf{0}$ 和 $\\mathbf{e}_r(\\theta)\\times\\mathbf{e}_\\theta(\\theta)=\\mathbf{e}_z$：\n$$\n\\boldsymbol{M}_{\\partial\\Omega}\n=R^2\\int_{0}^{2\\pi}\\lambda\\sin\\theta\\,\\mathbf{e}_z\\,d\\theta\n=\\lambda R^2\\left(\\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta\\right)\\mathbf{e}_z\n=\\lambda R^2\\cdot 0\\cdot \\mathbf{e}_z=\\mathbf{0}.\n$$\n绕原点的体力矩为\n$$\n\\boldsymbol{M}_{\\Omega}\n=\\int_{\\Omega}\\boldsymbol{x}\\times\\boldsymbol{b}\\,dA\n=\\int_{\\Omega}(x\\,\\mathbf{e}_x+y\\,\\mathbf{e}_y)\\times(b_0\\,\\mathbf{e}_x)\\,dA\n=\\int_{\\Omega}\\left(0\\,\\mathbf{e}_x+0\\,\\mathbf{e}_y+(x\\cdot 0-y\\cdot b_0)\\,\\mathbf{e}_z\\right)\\,dA\n=-b_0\\left(\\int_{\\Omega}y\\,dA\\right)\\mathbf{e}_z=\\mathbf{0},\n$$\n根据圆盘 $\\Omega$ 关于 $x$ 轴的对称性，这给出 $\\int_{\\Omega}y\\,dA=0$。\n\n因此，合力矩为零：\n$$\n\\boldsymbol{M}_{\\text{tot}}=\\boldsymbol{M}_{\\Omega}+\\boldsymbol{M}_{\\partial\\Omega}=\\mathbf{0}.\n$$\n\n由于给定的 $\\boldsymbol{b}$ 和 $\\bar{\\boldsymbol{t}}$ 同时满足全局力和全局力矩平衡，这些数据与静力平衡是一致的。对 $\\boldsymbol{\\sigma}$ 的对称性要求源于局部角动量守恒，但这并不排除切向面力的存在；一个对称的应力张量可以通过 $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\boldsymbol{n}$（其中 $\\boldsymbol{n}=\\mathbf{e}_r(\\theta)$）产生剪切（切向）边界面力，只要 $\\boldsymbol{\\sigma}$ 的剪切分量存在。在 $\\lambda\\neq 0$ 和 $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$ 之间没有矛盾。\n\n逐项分析：\n- 选项 A：正确。如上所示，对于给定的 $R$, $\\alpha$, $\\lambda$, $b_0$，$\\boldsymbol{F}_{\\text{tot}}=\\mathbf{0}$ 且 $\\boldsymbol{M}_{\\text{tot}}=\\mathbf{0}$。这些全局条件是局部定律和边界条件的必然结果，并且给定的场满足这些条件。不存在对应力对称性的违反。\n- 选项 B：不正确。边界合力矩为零，因为来自 $\\bar{\\boldsymbol{t}}$ 的唯一非零贡献项涉及 $\\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta=0$，并且体力矩由于对称性也为零。\n- 选项 C：不正确。在 $\\mathbf{e}_x$ 方向上的合力为 $\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0=0$（使用给定值）；因此，力平衡得到满足。\n- 选项 D：不正确。非零的切向面力分量与 $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$ 并不矛盾；对称应力在法向量不共线的边界上会产生剪切面力，而局部角动量守恒强制要求应力对称，而不是要求不存在切向面力。\n\n因此，正确的评估是选项 A。", "answer": "$$\\boxed{A}$$", "id": "3547540"}, {"introduction": "在计算固体力学中，确保数值求解器准确地实现了控制方程至关重要。本实践将指导您应用“制造解方法”（Method of Manufactured Solutions, MMS），这是一种用于代码验证的黄金标准技术。您将从一个解析的应力场出发，反向推导出相应的体力项来构造一个具有已知精确解的基准问题，进而评估数值近似在满足局部平衡方程和柯西公式定义的牵引边界条件方面的误差 ([@problem_id:3547591])。这项编码实践对于培养严谨的计算模型验证能力，以及深刻理解数值解与物理现实之间的联系具有核心价值。", "problem": "要求您设计并实现一个制造解基准，用于评估计算固体力学中表面牵引力评估和静力平衡强制的一致性。该基准由解析的应力场和体力场构建，并评估当应力通过双线性插值进行离散化（模拟低阶有限元法 (FEM) 的应力后处理）时产生的误差。该基准必须实现为一个完整的、可运行的程序，该程序能生成单行输出，汇总给定测试套件的结果。\n\n本任务的基本原理和定义如下：\n\n- 在无惯性力情况下的静力平衡：线性动量平衡由下式给出：$$\\nabla\\cdot\\boldsymbol{\\sigma} + \\boldsymbol{b} = \\mathbf{0},$$ 其中 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$ 是柯西应力张量，$\\boldsymbol{b}(\\boldsymbol{x})$ 是单位体积的体力。\n- 柯西牵引力矢量公式：$$\\boldsymbol{t}(\\boldsymbol{n}) = \\boldsymbol{\\sigma}\\,\\boldsymbol{n},$$ 其中 $\\boldsymbol{n}$ 是表面的外法线单位矢量。\n- 域为单位正方形 $$\\Omega = [0,1]\\times[0,1],$$ 其边界段上的外法线单位矢量由下式给出：$$\\boldsymbol{n} = (-1,0) \\text{ on } x=0,\\quad \\boldsymbol{n} = (1,0) \\text{ on } x=1,\\quad \\boldsymbol{n} = (0,-1) \\text{ on } y=0,\\quad \\boldsymbol{n} = (0,1) \\text{ on } y=1.$$\n- 制造解方法选择一个解析应力场 $$\\boldsymbol{\\sigma}(\\boldsymbol{x})$$，并定义 $$\\boldsymbol{b}(\\boldsymbol{x}) = -\\nabla\\cdot\\boldsymbol{\\sigma}(\\boldsymbol{x})$$ 以保证精确满足静力平衡。\n\n必须一致地使用物理单位。坐标 $x$ 和 $y$ 的单位是米，$\\boldsymbol{\\sigma}$ 的单位是帕斯卡，$\\boldsymbol{b}$ 的单位是牛顿/立方米。牵引力 $\\boldsymbol{t}$ 的单位是帕斯卡。所有误差度量必须以这些单位报告：牵引力误差以帕斯卡为单位，平衡残差以牛顿/立方米为单位。\n\n需实现的近似和误差评估步骤：\n\n- 使用均匀的 $N\\times N$ 双线性四边形单元网格对单位正方形进行离散化，网格间距为 $$h_x = h_y = \\frac{1}{N}。$$\n- 将“类有限元”近似应力场 $\\boldsymbol{\\sigma}_h(x,y)$ 定义为每个单元四个角点处节点应力值的双线性插值，使用标准的双线性形函数 $$N_1(\\xi,\\eta) = (1-\\xi)(1-\\eta),\\;N_2(\\xi,\\eta) = \\xi(1-\\eta),\\;N_3(\\xi,\\eta) = \\xi\\eta,\\;N_4(\\xi,\\eta) = (1-\\xi)\\eta,$$ 其中 $$\\xi = \\frac{x-x_0}{h_x},\\;\\eta = \\frac{y-y_0}{h_y}$$ 是当前单元中的局部坐标。\n- 通过对双线性插值函数进行解析求导来计算散度 $$\\nabla\\cdot\\boldsymbol{\\sigma}_h = \\begin{bmatrix} \\frac{\\partial \\sigma_{11,h}}{\\partial x} + \\frac{\\partial \\sigma_{12,h}}{\\partial y} \\\\ \\frac{\\partial \\sigma_{12,h}}{\\partial x} + \\frac{\\partial \\sigma_{22,h}}{\\partial y} \\end{bmatrix}$$（使用 $N_i(\\xi,\\eta)$ 的导数，其中 $\\partial \\xi/\\partial x = 1/h_x$ 且 $\\partial \\eta/\\partial y = 1/h_y$）。\n- 将 $\\partial\\Omega$ 上的精确牵引力定义为 $$\\boldsymbol{t}_{\\text{exact}} = \\boldsymbol{\\sigma}\\,\\boldsymbol{n},$$ 近似牵引力定义为 $$\\boldsymbol{t}_h = \\boldsymbol{\\sigma}_h\\,\\boldsymbol{n}。$$\n- 在每条边长度为 $h = 1/N$ 的边界段上使用复合高斯积分（两点高斯）来评估边界积分，并在每个单元内使用张量积两点高斯积分来评估域积分。使用这些积分法则计算均方根 (RMS) 误差：\n    - 牵引力 RMS 误差：$$E_t = \\sqrt{\\frac{1}{L}\\int_{\\partial\\Omega} \\|\\boldsymbol{t}_h - \\boldsymbol{t}_{\\text{exact}}\\|^2\\,\\mathrm{d}s},\\quad L = 4,$$ 以帕斯卡表示。\n    - 平衡残差 RMS：$$E_r = \\sqrt{\\frac{1}{A}\\int_{\\Omega} \\|\\nabla\\cdot\\boldsymbol{\\sigma}_h + \\boldsymbol{b}\\|^2\\,\\mathrm{d}\\Omega},\\quad A = 1,$$ 以牛顿/立方米表示。\n\n通过使用相应精确场的 RMS 进行归一化来定义相对 RMS 误差：\n- 牵引力相对 RMS 误差：$$R_t = \\frac{E_t}{\\sqrt{\\frac{1}{L}\\int_{\\partial\\Omega} \\|\\boldsymbol{t}_{\\text{exact}}\\|^2\\,\\mathrm{d}s}}。$$\n- 平衡残差相对 RMS 误差：$$R_r = \\frac{E_r}{\\sqrt{\\frac{1}{A}\\int_{\\Omega} \\|\\boldsymbol{b}\\|^2\\,\\mathrm{d}\\Omega}},$$ 特殊情况是，如果分母为零，则改用绝对阈值判断平衡：$$E_r  10^{-10}\\;\\text{Newton per cubic meter}。$$\n\n测试套件：\n\n对于每个测试用例，提供解析应力场分量 $\\sigma_{11}(x,y)$、$\\sigma_{22}(x,y)$、$\\sigma_{12}(x,y)$，设置 $\\sigma_{21}=\\sigma_{12}$，并设置 $$\\boldsymbol{b}(x,y) = -\\nabla\\cdot\\boldsymbol{\\sigma}(x,y)。$$ 使用指定的网格分辨率 $N$。\n\n- 用例 $1$（多项式，中等变化，“理想路径”）：$$\\sigma_{11} = 2x + 3y,\\;\\sigma_{22} = -x + y^2,\\;\\sigma_{12} = xy,\\;N=8.$$\n- 用例 $2$（振荡，更高频率）：令 $$k = 4\\pi。$$ 则 $$\\sigma_{11} = \\sin(kx) + y,\\;\\sigma_{22} = \\cos(ky) + x,\\;\\sigma_{12} = \\tfrac{1}{2}\\sin(kx)\\sin(ky),\\;N=32.$$\n- 用例 $3$（恒定应力，边界条件边缘情况，体力为零）：$$\\sigma_{11} = 5,\\;\\sigma_{22} = -2,\\;\\sigma_{12} = 1,\\;N=4.$$\n- 用例 $4$（边界附近有陡峭梯度）：$$\\sigma_{11} = e^x + y^3,\\;\\sigma_{22} = e^y + x^2,\\;\\sigma_{12} = x^2 y,\\;N=16.$$\n\n验收标准和输出：\n\n- 对于每个测试用例，计算 $(E_t,\\;E_r,\\;P_t,\\;P_r)$，其中 $E_t$ 是以帕斯卡为单位的牵引力 RMS 误差，$E_r$ 是以牛顿/立方米为单位的平衡残差 RMS。如果 $$R_t  0.05,$$ 则将 $P_t$ 定义为布尔值 $\\text{True}$；如果分母非零且 $$R_r  0.05$$，则将 $P_r$ 定义为布尔值 $\\text{True}$；否则，如果 $\\boldsymbol{b}$ 的 RMS 为零，则设置 $$P_r = (E_r  10^{-10})。$$\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个条目。每个条目必须是 $$[E_t,E_r,P_t,P_r]$$ 格式的列表。例如，$$[[e_{t,1},e_{r,1},p_{t,1},p_{r,1}],[e_{t,2},e_{r,2},p_{t,2},p_{r,2}],\\ldots].$$\n\n问题陈述中的所有数学量均以国际单位制 (SI) 表示。不使用角度。答案必须是指定单位的数值浮点数和布尔值。代码必须按所述实现基于积分的积分方法、双线性插值和散度计算。不允许使用外部文件或输入。", "solution": "用户提供了一个问题，要求为计算固体力学设计并实现一个制造解基准。在进行求解之前，该过程涉及验证问题陈述的科学合理性和完整性。\n\n### 步骤 1：问题验证\n\n根据既定标准对问题陈述进行严格评估。\n\n**1. 提取已知条件：**\n- **控制方程：** 静力平衡 $\\nabla\\cdot\\boldsymbol{\\sigma} + \\boldsymbol{b} = \\mathbf{0}$ 和柯西牵引力公式 $\\boldsymbol{t}(\\boldsymbol{n}) = \\boldsymbol{\\sigma}\\,\\boldsymbol{n}$。\n- **域：** 单位正方形 $\\Omega = [0,1]\\times[0,1]$，其四个边界上具有指定的外法线矢量。\n- **方法论：** 制造解方法，即对于选定的解析应力场 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$，有 $\\boldsymbol{b}(\\boldsymbol{x}) = -\\nabla\\cdot\\boldsymbol{\\sigma}(\\boldsymbol{x})$。\n- **离散化：** 一个均匀的 $N\\times N$ 双线性四边形单元网格。应力场通过在每个单元内使用双线性插值来近似为 $\\boldsymbol{\\sigma}_h$。\n- **数值积分：** 对所有边界和域积分使用复合两点高斯积分。\n- **误差度量：** 牵引力 ($E_t$) 和平衡残差 ($E_r$) 的均方根 (RMS) 误差，以及它们的相对误差 ($R_t, R_r$)。\n- **验收标准：** 相对误差 ($R_t, R_r$) 的阈值为 $0.05$，用于确定通过/失败的布尔值 ($P_t, P_r$)。对于体力恒为零的情况，指定了一个特殊的绝对阈值 ($E_r  10^{-10}$)。\n- **测试套件：** 提供了四个不同的用例，每个用例都有特定的解析应力张量场 $\\boldsymbol{\\sigma}(x,y)$ 和网格分辨率 $N$。\n- **单位：** 所有量均以国际单位制 (SI) 指定（米、帕斯卡、牛顿）。\n- **输出格式：** 最终结果采用特定的单行字符串格式。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地基于连续介质力学的基本原理和标准数值方法（有限元法概念、数值积分），这些方法用于计算工程中的验证。它在科学上和数学上都是合理的。\n- **适定性：** 问题是适定的。对于每个测试用例，输入是明确的，计算序列（体力推导、插值、数值积分、误差计算）是确定性的，从而导致一个唯一的、可计算的结果。\n- **客观性：** 问题是用精确、客观的语言表述的。所有术语都有数学定义，评估标准是定量的且无歧义。\n- **完整性和一致性：** 问题是自洽的。它提供了完整解决方案所需的所有必要解析函数、参数 ($N$)、数值程序（积分法则）和定义。根据定义，制造解方法确保了应力场和体力之间的一致性。\n- **可行性：** 所提供的应力场是光滑解析函数，指定的网格分辨率是适中的。所需的计算在标准编程环境下是数值稳定的和计算上可行的。\n- **清晰度：** 问题结构清晰，没有含糊或未定义的术语。\n\n**3. 结论和行动：**\n该问题被认为是**有效的**。这是一个在计算固体力学中定义明确、严谨且相关的问题。我现在将着手构建解决方案。\n\n### 步骤 2：解决方案设计\n\n解决方案将使用 Python 实现，并遵守指定的库。解决方案的核心在于对每个测试用例系统地应用所述的数值程序。\n\n**1. 解析预备工作：**\n对于每个测试用例，体力分量 $b_x$ 和 $b_y$ 是根据给定的应力张量 $\\boldsymbol{\\sigma}$，使用公式 $\\boldsymbol{b} = -\\nabla\\cdot\\boldsymbol{\\sigma} = -(\\frac{\\partial \\sigma_{ij}}{\\partial x_j})$ 解析推导出来的。\n- **用例 1：** $\\boldsymbol{\\sigma} = \\begin{pmatrix} 2x + 3y  xy \\\\ xy  -x + y^2 \\end{pmatrix}$。得出 $\\boldsymbol{b} = \\begin{pmatrix} -(2+x) \\\\ -3y \\end{pmatrix}$。\n- **用例 2：** 对于 $k=4\\pi$，$\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sin(kx) + y  \\frac{1}{2}\\sin(kx)\\sin(ky) \\\\ \\frac{1}{2}\\sin(kx)\\sin(ky)  \\cos(ky) + x \\end{pmatrix}$。得出 $\\boldsymbol{b} = \\begin{pmatrix} -k\\cos(kx) - \\frac{k}{2}\\sin(kx)\\cos(ky) \\\\ k\\sin(ky) - \\frac{k}{2}\\cos(kx)\\sin(ky) \\end{pmatrix}$。\n- **用例 3：** $\\boldsymbol{\\sigma} = \\begin{pmatrix} 5  1 \\\\ 1  -2 \\end{pmatrix}$。得出 $\\boldsymbol{b} = \\mathbf{0}$。\n- **用例 4：** $\\boldsymbol{\\sigma} = \\begin{pmatrix} e^x + y^3  x^2 y \\\\ x^2 y  e^y + x^2 \\end{pmatrix}$。得出 $\\boldsymbol{b} = \\begin{pmatrix} -(e^x+x^2) \\\\ -(2xy+e^y) \\end{pmatrix}$。\n这些关于 $\\boldsymbol{\\sigma}$ 和 $\\boldsymbol{b}$ 的解析函数将被直接实现。\n\n**2. 数值积分设置：**\n使用两点高斯积分法则。参考区间 $[-1, 1]$ 的点和权重为 $\\zeta_{1,2} = \\mp 1/\\sqrt{3}$ 和 $w_{1,2} = 1$。这些将被映射到每个单元用于域积分，以及映射到每个边界段用于线积分。必须包括变换的雅可比行列式。\n- 对于边长为 $h$ 的正方形单元，面积元为 $\\mathrm{d}A = (h/2)^2 \\mathrm{d}\\zeta\\mathrm{d}\\eta$。一个高斯点的积分贡献是 $w_i w_j \\cdot f(\\mathbf{x}_{ij}) \\cdot (h^2/4)$。\n- 对于长度为 $h$ 的边界段，长度元为 $\\mathrm{d}s = (h/2) \\mathrm{d}\\zeta$。积分贡献是 $w_i \\cdot f(\\mathbf{x}_i) \\cdot (h/2)$。\n\n**3. 离散场计算：**\n对于每个单元，近似应力场 $\\boldsymbol{\\sigma}_h$ 通过双线性插值四个单元节点的精确应力值来定义。该场的散度 $\\nabla\\cdot\\boldsymbol{\\sigma}_h$ 是通过对双线性形函数进行解析求导来计算的。\n给定一个从单元中节点值 $f_1, f_2, f_3, f_4$ 插值得到的标量场 $f_h$（局部坐标为 $\\xi=(x-x_0)/h, \\eta=(y-y_0)/h$），其导数为：\n$$ \\frac{\\partial f_h}{\\partial x} = \\frac{1}{h}\\left[ (f_2-f_1)(1-\\eta) + (f_3-f_4)\\eta \\right] $$\n$$ \\frac{\\partial f_h}{\\partial y} = \\frac{1}{h}\\left[ (f_4-f_1)(1-\\xi) + (f_3-f_2)\\xi \\right] $$\n将这些公式应用于 $\\boldsymbol{\\sigma}_h$ 的每个分量，以计算每个单元内高斯点处的 $\\nabla\\cdot\\boldsymbol{\\sigma}_h$。在边界上，$\\boldsymbol{\\sigma}_h$ 简化为段的两个节点之间的线性插值函数。\n\n**4. 误差计算循环：**\n实现的核心将遍历单元和边界段，以累加用于 RMS 误差计算的范数的平方。\n\n- **平衡残差 ($E_r$)：**\n  - 遍历所有 $N \\times N$ 个单元。\n  - 在每个单元中，遍历 $2 \\times 2$ 个高斯点。\n  - 在每个高斯点，计算 $\\boldsymbol{v} = \\nabla\\cdot\\boldsymbol{\\sigma}_h + \\boldsymbol{b}$。\n  - 将 $\\|\\boldsymbol{v}\\|^2 \\cdot (\\text{权重因子})$ 添加到误差积分的运行总和中。\n  - 类似地，计算 $\\|\\boldsymbol{b}\\|^2$ 的积分以进行归一化。\n  - 循环结束后，根据总和计算 $E_r$ 和 $R_r$。\n\n- **牵引力误差 ($E_t$)：**\n  - 遍历域的四个边界。\n  - 对于每个边界，遍历其 $N$ 个段。\n  - 在每个段上，遍历 $2$ 个高斯点。\n  - 在每个高斯点，计算 $\\boldsymbol{d} = \\boldsymbol{t}_h - \\boldsymbol{t}_{\\text{exact}} = (\\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma})\\boldsymbol{n}$。\n  - 将 $\\|\\boldsymbol{d}\\|^2 \\cdot (\\text{权重因子})$ 添加到误差总和中。\n  - 类似地，计算 $\\|\\boldsymbol{t}_{\\text{exact}}\\|^2$ 的积分以进行归一化。\n  - 循环结束后，计算 $E_t$ 和 $R_t$。\n\n**5. 最终评估：**\n通过将相对误差 $R_t$ 和 $R_r$ 与 $0.05$ 的阈值进行比较来确定通过/失败的布尔值 $P_t$ 和 $P_r$，并对 $\\|\\boldsymbol{b}\\|_{RMS} = 0$ 的情况进行指定的特殊处理。\n\n这种结构化的方法确保了问题陈述的所有要求都得到准确和高效的满足。最终的代码将把这个逻辑封装在一个自包含的、可执行的脚本中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the manufactured-solution benchmark for all test cases.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    # Each case provides analytic functions for stress components, their derivatives\n    # to compute the body force, and the grid resolution N.\n\n    k = 4 * np.pi\n    test_cases = [\n        # Case 1: Polynomial stress field\n        {\n            \"N\": 8,\n            \"sigma11\": lambda x, y: 2 * x + 3 * y,\n            \"sigma22\": lambda x, y: -x + y**2,\n            \"sigma12\": lambda x, y: x * y,\n            \"b_x\": lambda x, y: -(2 + x),\n            \"b_y\": lambda x, y: -3 * y,\n        },\n        # Case 2: Oscillatory stress field\n        {\n            \"N\": 32,\n            \"sigma11\": lambda x, y: np.sin(k * x) + y,\n            \"sigma22\": lambda x, y: np.cos(k * y) + x,\n            \"sigma12\": lambda x, y: 0.5 * np.sin(k * x) * np.sin(k * y),\n            \"b_x\": lambda x, y: -(k * np.cos(k * x) + 0.5 * k * np.sin(k * x) * np.cos(k * y)),\n            \"b_y\": lambda x, y: -(0.5 * k * np.cos(k * x) * np.sin(k * y) - k * np.sin(k * y)),\n        },\n        # Case 3: Constant stress field (zero body force)\n        {\n            \"N\": 4,\n            \"sigma11\": lambda x, y: 5.0,\n            \"sigma22\": lambda x, y: -2.0,\n            \"sigma12\": lambda x, y: 1.0,\n            \"b_x\": lambda x, y: 0.0,\n            \"b_y\": lambda x, y: 0.0,\n        },\n        # Case 4: Exponential/polynomial stress field\n        {\n            \"N\": 16,\n            \"sigma11\": lambda x, y: np.exp(x) + y**3,\n            \"sigma22\": lambda x, y: np.exp(y) + x**2,\n            \"sigma12\": lambda x, y: x**2 * y,\n            \"b_x\": lambda x, y: -(np.exp(x) + x**2),\n            \"b_y\": lambda x, y: -(2 * x * y + np.exp(y)),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(case)\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    # The default str() for a list includes spaces, which we avoid by custom formatting.\n    result_strings = []\n    for res in results:\n        # Format: [float, float, bool, bool] with no spaces\n        result_strings.append(f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\")\n    print(f\"[{','.join(result_strings)}]\")\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case to compute error metrics and pass/fail criteria.\n    \"\"\"\n    N = case_data[\"N\"]\n    h = 1.0 / N\n    s11_f, s22_f, s12_f = case_data[\"sigma11\"], case_data[\"sigma22\"], case_data[\"sigma12\"]\n    bx_f, by_f = case_data[\"b_x\"], case_data[\"b_y\"]\n\n    # Gaussian quadrature points and weights for the interval [-1, 1]\n    gauss_points_1d = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n    gauss_weights_1d = [1.0, 1.0]\n\n    # --- Equilibrium Residual Calculation (Domain Integral) ---\n    sum_err_r_sq = 0.0\n    sum_norm_b_sq = 0.0\n    domain_area = 1.0\n\n    for i in range(N):\n        for j in range(N):\n            x0, y0 = i * h, j * h\n            \n            # Get exact stress at the 4 nodes of the cell (counter-clockwise)\n            s_nodes = {\n                's11': np.array([s11_f(x0, y0), s11_f(x0 + h, y0), s11_f(x0 + h, y0 + h), s11_f(x0, y0 + h)]),\n                's22': np.array([s22_f(x0, y0), s22_f(x0 + h, y0), s22_f(x0 + h, y0 + h), s22_f(x0, y0 + h)]),\n                's12': np.array([s12_f(x0, y0), s12_f(x0 + h, y0), s12_f(x0 + h, y0 + h), s12_f(x0, y0 + h)]),\n            }\n\n            for gp_xi, w_xi in zip(gauss_points_1d, gauss_weights_1d):\n                for gp_eta, w_eta in zip(gauss_points_1d, gauss_weights_1d):\n                    # Map from reference element [-1,1]x[-1,1] to physical cell\n                    # Local coordinates xi, eta are in [0,1]\n                    xi = (1.0 + gp_xi) / 2.0\n                    eta = (1.0 + gp_eta) / 2.0\n                    x, y = x0 + xi * h, y0 + eta * h\n\n                    # Calculate derivatives of interpolated stress components\n                    # d(f_h)/dx = (1/h) * [(f2-f1)(1-eta) + (f3-f4)eta]\n                    # d(f_h)/dy = (1/h) * [(f4-f1)(1-xi) + (f3-f2)xi]\n                    def get_derivs(f_nodes):\n                        df_dx = (1/h) * ((f_nodes[1] - f_nodes[0]) * (1 - eta) + (f_nodes[2] - f_nodes[3]) * eta)\n                        df_dy = (1/h) * ((f_nodes[3] - f_nodes[0]) * (1 - xi) + (f_nodes[2] - f_nodes[1]) * xi)\n                        return df_dx, df_dy\n\n                    ds11_dx, ds11_dy = get_derivs(s_nodes['s11'])\n                    ds22_dx, ds22_dy = get_derivs(s_nodes['s22'])\n                    ds12_dx, ds12_dy = get_derivs(s_nodes['s12'])\n\n                    # Divergence of approximate stress\n                    div_s_h_x = ds11_dx + ds12_dy\n                    div_s_h_y = ds12_dx + ds22_dy\n\n                    # Exact body force\n                    b_x, b_y = bx_f(x, y), by_f(x, y)\n\n                    # Integrand for equilibrium residual\n                    residual_x = div_s_h_x + b_x\n                    residual_y = div_s_h_y + b_y\n                    \n                    dV = (h/2.0) * (h/2.0) * w_xi * w_eta # Area element\n                    sum_err_r_sq += (residual_x**2 + residual_y**2) * dV\n                    sum_norm_b_sq += (b_x**2 + b_y**2) * dV\n\n    # Final RMS values for residual\n    E_r = np.sqrt(sum_err_r_sq / domain_area)\n    rms_b = np.sqrt(sum_norm_b_sq / domain_area)\n    \n    if rms_b  1e-12: # Special case for zero body force\n        P_r = E_r  1e-10\n    else:\n        R_r = E_r / rms_b\n        P_r = R_r  0.05\n\n    # --- Traction Error Calculation (Boundary Integral) ---\n    sum_err_t_sq = 0.0\n    sum_norm_t_sq = 0.0\n    boundary_length = 4.0\n    \n    boundaries = {\n        'bottom': {'n': np.array([0, -1]), 'fixed_coord': 'y', 'val': 0.0},\n        'right':  {'n': np.array([1, 0]),  'fixed_coord': 'x', 'val': 1.0},\n        'top':    {'n': np.array([0, 1]),  'fixed_coord': 'y', 'val': 1.0},\n        'left':   {'n': np.array([-1, 0]), 'fixed_coord': 'x', 'val': 0.0},\n    }\n\n    for name, b_info in boundaries.items():\n        n = b_info['n']\n        for i in range(N):\n            # Define segment endpoints\n            p0, p1 = i * h, (i + 1) * h\n            if b_info['fixed_coord'] == 'x':\n                x_val = b_info['val']\n                nodes = [(x_val, p0), (x_val, p1)]\n            else: # fixed_coord == 'y'\n                y_val = b_info['val']\n                nodes = [(p0, y_val), (p1, y_val)]\n            \n            # Get exact stress at segment endpoints\n            s11_nodes = np.array([s11_f(n[0], n[1]) for n in nodes])\n            s22_nodes = np.array([s22_f(n[0], n[1]) for n in nodes])\n            s12_nodes = np.array([s12_f(n[0], n[1]) for n in nodes])\n\n            for gp, w in zip(gauss_points_1d, gauss_weights_1d):\n                p_local = (1 + gp) / 2.0 # local coord [0,1]\n                \n                # Physical coordinate of Gauss point\n                if b_info['fixed_coord'] == 'x':\n                    x, y = b_info['val'], p0 + p_local * h\n                else:\n                    x, y = p0 + p_local * h, b_info['val']\n                    \n                # Linearly interpolated stress at Gauss point\n                s11_h = s11_nodes[0] * (1 - p_local) + s11_nodes[1] * p_local\n                s22_h = s22_nodes[0] * (1 - p_local) + s22_nodes[1] * p_local\n                s12_h = s12_nodes[0] * (1 - p_local) + s12_nodes[1] * p_local\n                \n                # Approximate traction\n                t_h_x = s11_h * n[0] + s12_h * n[1]\n                t_h_y = s12_h * n[0] + s22_h * n[1]\n\n                # Exact stress and traction\n                s11, s22, s12 = s11_f(x, y), s22_f(x, y), s12_f(x, y)\n                t_exact_x = s11 * n[0] + s12 * n[1]\n                t_exact_y = s12 * n[0] + s22 * n[1]\n                \n                # Integrands\n                err_t_x = t_h_x - t_exact_x\n                err_t_y = t_h_y - t_exact_y\n                \n                ds = (h / 2.0) * w # Length element\n                sum_err_t_sq += (err_t_x**2 + err_t_y**2) * ds\n                sum_norm_t_sq += (t_exact_x**2 + t_exact_y**2) * ds\n\n    # Final RMS values for traction\n    E_t = np.sqrt(sum_err_t_sq / boundary_length)\n    rms_t_exact = np.sqrt(sum_norm_t_sq / boundary_length)\n\n    if rms_t_exact  1e-12:\n        P_t = E_t  1e-10\n    else:\n        R_t = E_t / rms_t_exact\n        P_t = R_t  0.05\n        \n    return [E_t, E_r, bool(P_t), bool(P_r)]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3547591"}]}