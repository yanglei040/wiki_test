{"hands_on_practices": [{"introduction": "等几何分析 (IGA) 的核心在于其强大的基函数，即 B 样条。在深入研究复杂的分析应用之前，掌握这些基函数的基本性质至关重要。本练习将引导您使用标准的 Cox-de Boor 递归公式，亲手计算在特定参数点上的 B 样条基函数值。这个计算过程是理解 B 样条局部支撑、递归定义和单位分解等关键特性的基础，也是进行任何等几何计算的第一步。[@problem_id:3575735]", "problem": "考虑在计算固体力学中使用的一维等几何离散，其逼近空间由定义在开节点矢量 $\\Xi=\\{0,0,0,0.5,1,1,1\\}$ 上的二次基样条（B样条）基构成。在等几何分析（IGA）中，这种空间通常用于逼近位移场，如果需要，可通过权值从这些B样条基导出非均匀有理B样条（NURBS）。从通过 Cox–de Boor 递归和分段常数零次函数的B样条基核心定义出发，计算在参数位置 $u=0.25$ 处，所有能产生非零值的索引 $i$ 所对应的非零二次B样条基函数值 $N_{i,2}(u)$。请将您的最终答案以单行矩阵的形式报告，并按非零函数的索引 $i$ 的升序排列。请提供精确值，无需四舍五入。这些基函数值没有物理单位。", "solution": "问题陈述需经过验证。\n\n### 步骤1：提取已知条件\n- **领域：** 计算固体力学，等几何分析 (IGA)。\n- **逼近空间：** B样条基。\n- **多项式次数：** $p=2$ (二次)。\n- **节点矢量：** $\\Xi=\\{0,0,0,0.5,1,1,1\\}$。\n- **参数求值点：** $u=0.25$。\n- **任务：** 计算在 $u=0.25$ 处所有非零的B样条基函数值 $N_{i,2}(u)$。\n- **方法：** Cox–de Boor 递归。\n- **输出格式：** 一个单行矩阵，包含精确值，按索引 $i$ 升序排列。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于B样条的数学理论，这是计算机辅助设计 (CAD) 和等几何分析的核心组成部分。Cox–de Boor 递归是计算B样条基函数的标准算法。所提供的节点矢量是一个有效的开节点矢量。该问题在科学上和数学上都是合理的。\n- **适定性：** 该问题是适定的。次数、节点矢量和求值点都已指定，从而得到一组唯一且可计算的基函数值。\n- **客观性：** 该问题以精确、客观、无歧义的数学语言陈述。\n- **完整性与一致性：** 该问题提供了所有必要的信息。节点数 $m=7$ 和次数 $p=2$ 正确地定义了基函数的数量 $n = m - p - 1 = 7 - 2 - 1 = 4$。开节点矢量的结构，即两端各有 $p+1=3$ 个重复节点，与在定义域端点处进行插值的B样条的标准实践相一致。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答\n问题要求计算二次 ($p=2$) B样条基函数在参数坐标 $u=0.25$ 处的值。B样条基由开节点矢量 $\\Xi=\\{\\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6, \\xi_7\\} = \\{0, 0, 0, 0.5, 1, 1, 1\\}$ 定义。\n\n对于一个次数为 $p$、节点矢量长度为 $m$ 的B样条，其基函数的数量 $n$ 由 $n = m - p - 1$ 给出。此处，$m=7$ 且 $p=2$，因此有 $n=7-2-1=4$ 个基函数：$N_{1,2}(u)$、$N_{2,2}(u)$、$N_{3,2}(u)$ 和 $N_{4,2}(u)$。\n\n这些函数的求值是使用 Cox–de Boor 递归公式进行的。对于 $p > 0$，公式为：\n$$\nN_{i,p}(u) = \\frac{u - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(u) + \\frac{\\xi_{i+p+1} - u}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(u)\n$$\n递归从次数 $p=0$ 的基本情况开始：\n$$\nN_{i,0}(u) = \\begin{cases} 1  \\text{if } \\xi_i \\le u  \\xi_{i+1} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n按照惯例，分母为零的任何项 (例如 $\\frac{0}{0}$) 都被视为零。\n\n一个基函数 $N_{i,p}(u)$ 具有局部支集，并且仅在区间 $[\\xi_i, \\xi_{i+p+1})$ 内非零。对于给定的参数坐标 $u \\in [\\xi_j, \\xi_{j+1})$，唯一可能非零的 $p$ 次基函数是 $N_{j-p,p}, \\dots, N_{j,p}$。\n\n在本例中，$u=0.25$ 位于节点区间 $[\\xi_3, \\xi_4) = [0, 0.5)$ 内。因此，我们设 $j=3$。对于次数 $p=2$，在 $u=0.25$ 处唯一可能非零的基函数是 $N_{3-2,2}(u)$、$N_{3-1,2}(u)$ 和 $N_{3,2}(u)$，即 $N_{1,2}(u)$、$N_{2,2}(u)$ 和 $N_{3,2}(u)$。函数 $N_{4,2}(u)$ 为零，因为其支集是 $[\\xi_4, \\xi_7) = [0.5, 1)$，该区间不包含 $u=0.25$。\n\n我们继续进行递归计算。\n\n**步骤1：零次基函数 ($p=0$)**\n我们在 $u=0.25$ 处计算 $N_{i,0}(u)$ 的值。由于 $u=0.25$ 在区间 $[\\xi_3, \\xi_4) = [0, 0.5)$ 内，唯一非零的零次基函数是：\n$$\nN_{3,0}(0.25) = 1\n$$\n所有其他的 $N_{i,0}(0.25)$ 均为 $0$。\n\n**步骤2：一次基函数 ($p=1$)**\n我们计算在 $u=0.25$ 处必要的一次基函数的值。\n- $N_{1,1}(0.25) = \\frac{0.25 - \\xi_1}{\\xi_2 - \\xi_1} N_{1,0}(0.25) + \\frac{\\xi_3 - 0.25}{\\xi_3 - \\xi_2} N_{2,0}(0.25)$。\n分母 $\\xi_2-\\xi_1=0-0=0$ 和 $\\xi_3-\\xi_2=0-0=0$。因此，两项都为零。\n$N_{1,1}(0.25) = 0$。\n\n- $N_{2,1}(0.25) = \\frac{0.25 - \\xi_2}{\\xi_3 - \\xi_2} N_{2,0}(0.25) + \\frac{\\xi_4 - 0.25}{\\xi_4 - \\xi_3} N_{3,0}(0.25)$。\n第一个分母为 $\\xi_3-\\xi_2=0-0=0$，所以第一项为零。\n第二项是 $\\frac{0.5 - 0.25}{0.5 - 0} N_{3,0}(0.25) = \\frac{0.25}{0.5} \\times 1 = 0.5$。\n$N_{2,1}(0.25) = 0.5$。\n\n- $N_{3,1}(0.25) = \\frac{0.25 - \\xi_3}{\\xi_4 - \\xi_3} N_{3,0}(0.25) + \\frac{\\xi_5 - 0.25}{\\xi_5 - \\xi_4} N_{4,0}(0.25)$。\n$N_{4,0}(0.25)=0$，所以第二项为零。\n第一项是 $\\frac{0.25 - 0}{0.5 - 0} N_{3,0}(0.25) = \\frac{0.25}{0.5} \\times 1 = 0.5$。\n$N_{3,1}(0.25) = 0.5$。\n\n- $N_{4,1}(0.25) = \\frac{0.25 - \\xi_4}{\\xi_5 - \\xi_4} N_{4,0}(0.25) + \\frac{\\xi_6 - 0.25}{\\xi_6 - \\xi_5} N_{5,0}(0.25)$。\n$N_{4,0}(0.25)$ 和 $N_{5,0}(0.25)$ 均为 $0$。\n$N_{4,1}(0.25) = 0$。\n\n**步骤3：二次基函数 ($p=2$)**\n我们现在计算在 $u=0.25$ 处的最终二次基函数值。\n\n- $N_{1,2}(0.25) = \\frac{0.25 - \\xi_1}{\\xi_3 - \\xi_1} N_{1,1}(0.25) + \\frac{\\xi_4 - 0.25}{\\xi_4 - \\xi_2} N_{2,1}(0.25)$。\n第一个分母为 $\\xi_3-\\xi_1=0-0=0$，所以第一项为零。\n第二项是 $\\frac{0.5 - 0.25}{0.5 - 0} N_{2,1}(0.25) = \\frac{0.25}{0.5} \\times 0.5 = 0.5 \\times 0.5 = 0.25$。\n$$N_{1,2}(0.25) = 0.25 = \\frac{1}{4}$$\n\n- $N_{2,2}(0.25) = \\frac{0.25 - \\xi_2}{\\xi_4 - \\xi_2} N_{2,1}(0.25) + \\frac{\\xi_5 - 0.25}{\\xi_5 - \\xi_3} N_{3,1}(0.25)$。\n第一项是 $\\frac{0.25 - 0}{0.5 - 0} N_{2,1}(0.25) = \\frac{0.25}{0.5} \\times 0.5 = 0.5 \\times 0.5 = 0.25$。\n第二项是 $\\frac{1 - 0.25}{1 - 0} N_{3,1}(0.25) = \\frac{0.75}{1} \\times 0.5 = 0.75 \\times 0.5 = 0.375$。\n$N_{2,2}(0.25) = 0.25 + 0.375 = 0.625$。\n$$N_{2,2}(0.25) = 0.625 = \\frac{5}{8}$$\n\n- $N_{3,2}(0.25) = \\frac{0.25 - \\xi_3}{\\xi_5 - \\xi_3} N_{3,1}(0.25) + \\frac{\\xi_6 - 0.25}{\\xi_6 - \\xi_4} N_{4,1}(0.25)$。\n$N_{4,1}(0.25)=0$，所以第二项为零。\n第一项是 $\\frac{0.25 - 0}{1 - 0} N_{3,1}(0.25) = \\frac{0.25}{1} \\times 0.5 = 0.25 \\times 0.5 = 0.125$。\n$$N_{3,2}(0.25) = 0.125 = \\frac{1}{8}$$\n\n如前所述，$N_{4,2}(0.25)=0$。\n\nB样条基函数的一个关键性质是单位分解性，即在定义域内任意一点，所有基函数之和等于 $1$。让我们对我们的结果进行验证：\n$$ \\sum_{i=1}^{4} N_{i,2}(0.25) = N_{1,2}(0.25) + N_{2,2}(0.25) + N_{3,2}(0.25) + N_{4,2}(0.25) $$\n$$ = \\frac{1}{4} + \\frac{5}{8} + \\frac{1}{8} + 0 = \\frac{2}{8} + \\frac{5}{8} + \\frac{1}{8} = \\frac{8}{8} = 1 $$\n单位分解性得到满足，证实了我们计算的正确性。\n\n在 $u=0.25$ 处的非零基函数值对应于索引 $i=1,2,3$。按索引 $i$ 升序排列，这些值为：\n$N_{1,2}(0.25) = \\frac{1}{4}$\n$N_{2,2}(0.25) = \\frac{5}{8}$\n$N_{3,2}(0.25) = \\frac{1}{8}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{5}{8}  \\frac{1}{8} \\end{pmatrix}}\n$$", "id": "3575735"}, {"introduction": "等几何分析超越传统有限元方法的一大优势，在于其能够精确表示复杂的几何形状，例如圆弧、椭圆等，而无需进行网格近似。这一能力通过非均匀有理 B 样条 (NURBS) 得以实现。本练习将向您展示 NURBS 的威力，指导您构建一个二次 NURBS 曲线来精确描述四分之一圆弧，并通过代数推导验证其几何的精确性。这个实践将深刻揭示“等几何”概念的精髓：分析所用的几何模型与设计 (CAD) 时的几何模型完全一致。[@problem_id:3575812]", "problem": "在计算固体力学的等几何分析（IGA）背景下，弯曲边界的精确几何表示至关重要，以防止几何离散误差污染数值解。考虑构建一条二次非均匀有理B样条（NURBS）曲线，该曲线精确表示第一象限中从点 $(1,0)$ 到点 $(0,1)$ 的四分之一单位圆。\n\n给定控制点 $\\mathbf{P}_{0}=(1,0)$、$\\mathbf{P}_{1}=(1,1)$ 和 $\\mathbf{P}_{2}=(0,1)$，以及权重 $w_{0}=1$、$w_{1}=1/\\sqrt{2}$ 和 $w_{2}=1$。参数坐标为 $\\xi \\in [0,1]$，次数为 $p=2$，开放节点矢量为 $\\Xi=(0,0,0,1,1,1)$。\n\n从B样条基函数的Cox–de Boor定义和作为有理B样条的非均匀有理B样条（NURBS）曲线的基本定义出发，为上述数据构建相应的二次NURBS参数化 $\\mathbf{x}(\\xi)$。然后，仅使用这些基础定义和代数简化，通过直接推导验证此参数化是四分之一单位圆的精确表示，即证明对于所有 $\\xi \\in [0,1]$，欧几里得范数 $\\|\\mathbf{x}(\\xi)\\|$ 是一个等于半径的常数。\n\n提供 $\\|\\mathbf{x}(\\xi)\\|$ 作为 $\\xi$ 的函数的简化闭式表达式。最终表达式中不需要进行数值舍入，也不应包含任何单位。", "solution": "用户希望我解决一个与等几何分析（IGA）和NURBS曲线相关的问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   逐字提取所有给定信息。\n    *   检查其科学合理性、自洽性、完整性、客观性以及是否适定。该问题似乎是IGA和计算机辅助设计（CAD）中的一个标准教科书示例，因此应该是有效的。\n\n2.  **如果问题有效，则着手解决。**\n    *   **步骤 A：定义B样条基函数。**\n        *   次数为 $p=2$。\n        *   节点矢量为 $\\Xi = (0, 0, 0, 1, 1, 1)$。我们将节点表示为 $\\xi_i$。所以，$\\xi_0=0, \\xi_1=0, \\xi_2=0, \\xi_3=1, \\xi_4=1, \\xi_5=1$。\n        *   控制点数为 $n+1 = 3$，所以 $n=2$。节点数为 $m+1 = 6$，所以 $m=5$。规则 $m=n+p+1$ 成立：$5 = 2+2+1$。\n        *   我需要计算 $i=0, 1, 2$ 时的基函数 $N_{i,p}(\\xi)$。\n        *   Cox-de Boor 递推公式为：\n            $N_{i,0}(\\xi) = \\begin{cases} 1  \\text{if } \\xi_i \\le \\xi  \\xi_{i+1} \\\\ 0  \\text{otherwise} \\end{cases}$\n            $N_{i,p}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(\\xi) + \\frac{\\xi_{i+p+1} - \\xi}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(\\xi)$。\n        *   我必须小心处理 $0/0$ 的约定，它被定义为 $0$。\n\n    *   **计算 $p=2$ 和 $\\Xi=(0,0,0,1,1,1)$ 的B样条基函数。**\n        *   唯一的非零区间是 $\\xi \\in [0, 1)$。\n        *   $p=0$ 时的基函数：\n            $N_{0,0}(\\xi), N_{1,0}(\\xi), N_{2,0}(\\xi), N_{3,0}(\\xi), N_{4,0}(\\xi)$。\n            $\\xi_0=\\xi_1=\\xi_2=0$, $\\xi_3=\\xi_4=\\xi_5=1$。\n            区间为 $[\\xi_i, \\xi_{i+1})$。\n            $[\\xi_2, \\xi_3) = [0, 1)$。只有 $N_{2,0}(\\xi)=1$ 在 $\\xi \\in [0,1)$ 上成立。所有其他的都为0，除了在单点上，这对积分不重要，但对于求值来说，保持正确性很重要。问题使用了开放节点矢量，所以曲线定义在 $\\xi \\in [0, 1]$ 上。\n        *   $p=1$ 时的基函数：\n            $N_{i,1}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+1} - \\xi_i} N_{i,0}(\\xi) + \\frac{\\xi_{i+2} - \\xi}{\\xi_{i+2} - \\xi_{i+1}} N_{i+1,0}(\\xi)$。\n            让我们计算 $i=0, 1, 2, 3$。\n            $N_{0,1}(\\xi)$: $\\xi_0=0, \\xi_1=0$。第一项是 $0/0$，所以为 $0$。$\\xi_2=0, \\xi_1=0$。第二项有 $N_{1,0}(\\xi)$，它为 0。所以 $N_{0,1}=0$。\n            $N_{1,1}(\\xi)$: $\\xi_1=0, \\xi_2=0$。第一项是 $0/0$，所以为 $0$。第二项是 $\\frac{\\xi_3-\\xi}{\\xi_3-\\xi_2} N_{2,0}(\\xi) = \\frac{1-\\xi}{1-0} \\cdot 1 = 1-\\xi$ 对于 $\\xi \\in [0,1)$。\n            $N_{2,1}(\\xi)$: $\\frac{\\xi-\\xi_2}{\\xi_3-\\xi_2} N_{2,0}(\\xi) = \\frac{\\xi-0}{1-0} \\cdot 1 = \\xi$ 对于 $\\xi \\in [0,1)$。$\\xi_3=1, \\xi_4=1$。第二项是 $0/0$，所以为 $0$。\n            $N_{3,1}(\\xi)$: $\\xi_3=1, \\xi_4=1$。第一项有 $N_{3,0}(\\xi)$，它为 0。第二项是 $0/0$。所以 $N_{3,1}=0$。\n            所以，非零的线性基函数是 $N_{1,1}(\\xi) = 1-\\xi$ 和 $N_{2,1}(\\xi) = \\xi$。这是一次伯恩斯坦多项式。\n\n        *   $p=2$ 时的基函数：\n            $N_{i,2}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+2} - \\xi_i} N_{i,1}(\\xi) + \\frac{\\xi_{i+3} - \\xi}{\\xi_{i+3} - \\xi_{i+1}} N_{i+1,1}(\\xi)$。\n            $i=0$: $N_{0,2}(\\xi) = \\frac{\\xi - \\xi_0}{\\xi_2 - \\xi_0} N_{0,1}(\\xi) + \\frac{\\xi_3 - \\xi}{\\xi_3 - \\xi_1} N_{1,1}(\\xi)$。\n            $\\xi_0=0, \\xi_1=0, \\xi_2=0, \\xi_3=1$。\n            第一项有 $N_{0,1}(\\xi)=0$。$\\frac{\\xi - \\xi_0}{\\xi_2 - \\xi_0}$ 项是 $0/0$，所以整个第一项为 $0$。\n            第二项是 $\\frac{1-\\xi}{1-0} N_{1,1}(\\xi) = (1-\\xi)(1-\\xi) = (1-\\xi)^2$。\n            所以，$N_{0,2}(\\xi) = (1-\\xi)^2$。这是一个二次伯恩斯坦多项式。\n            $i=1$: $N_{1,2}(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_3 - \\xi_1} N_{1,1}(\\xi) + \\frac{\\xi_4 - \\xi}{\\xi_4 - \\xi_2} N_{2,1}(\\xi)$。\n            $\\xi_1=0, \\xi_2=0, \\xi_3=1, \\xi_4=1$。\n            第一项：$\\frac{\\xi - 0}{1 - 0} N_{1,1}(\\xi) = \\xi (1-\\xi)$。\n            第二项：$\\frac{1 - \\xi}{1 - 0} N_{2,1}(\\xi) = (1-\\xi) \\xi$。\n            所以，$N_{1,2}(\\xi) = \\xi(1-\\xi) + (1-\\xi)\\xi = 2\\xi(1-\\xi)$。这也是一个二次伯恩斯坦多项式。\n            $i=2$: $N_{2,2}(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_4 - \\xi_2} N_{2,1}(\\xi) + \\frac{\\xi_5 - \\xi}{\\xi_5 - \\xi_3} N_{3,1}(\\xi)$。\n            $\\xi_2=0, \\xi_3=1, \\xi_4=1, \\xi_5=1$。\n            第一项：$\\frac{\\xi - 0}{1 - 0} N_{2,1}(\\xi) = \\xi \\cdot \\xi = \\xi^2$。\n            第二项有 $N_{3,1}(\\xi)=0$。$\\frac{\\xi_5 - \\xi}{\\xi_5 - \\xi_3}$ 项是 $0/0$，所以整个第二项为 $0$。\n            所以，$N_{2,2}(\\xi) = \\xi^2$。这也是一个二次伯恩斯坦多项式。\n\n        *   所以B样条基函数是二次伯恩斯坦多项式：\n            $N_{0,2}(\\xi) = (1-\\xi)^2$\n            $N_{1,2}(\\xi) = 2\\xi(1-\\xi)$\n            $N_{2,2}(\\xi) = \\xi^2$\n        *   这是预料之中的，因为节点矢量 $\\Xi=(0,0,0,1,1,1)$ 对应于贝塞尔曲线。\n\n    *   **步骤 B：构建NURBS曲线参数化。**\n        *   NURBS曲线定义为 $\\mathbf{x}(\\xi) = \\sum_{i=0}^{n} R_{i,p}(\\xi) \\mathbf{P}_i$。\n        *   有理基函数为 $R_{i,p}(\\xi) = \\frac{N_{i,p}(\\xi) w_i}{\\sum_{j=0}^{n} N_{j,p}(\\xi) w_j}$。\n        *   问题给出：\n            $\\mathbf{P}_{0}=(1,0)$、$\\mathbf{P}_{1}=(1,1)$、$\\mathbf{P}_{2}=(0,1)$。\n            $w_{0}=1$、$w_{1}=1/\\sqrt{2}$、$w_{2}=1$。\n            $p=2$。\n            B样条基函数为 $N_{0,2}(\\xi) = (1-\\xi)^2$、$N_{1,2}(\\xi) = 2\\xi(1-\\xi)$、$N_{2,2}(\\xi) = \\xi^2$。\n\n        *   首先，计算有理基函数的分母，也就是权重函数 $W(\\xi)$：\n            $W(\\xi) = \\sum_{j=0}^{2} N_{j,2}(\\xi) w_j$\n            $W(\\xi) = N_{0,2}(\\xi)w_0 + N_{1,2}(\\xi)w_1 + N_{2,2}(\\xi)w_2$\n            $W(\\xi) = (1-\\xi)^2 \\cdot 1 + 2\\xi(1-\\xi) \\cdot \\frac{1}{\\sqrt{2}} + \\xi^2 \\cdot 1$\n            $W(\\xi) = 1 - 2\\xi + \\xi^2 + \\sqrt{2}\\xi(1-\\xi) + \\xi^2$\n            $W(\\xi) = 1 - 2\\xi + 2\\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2$\n            $W(\\xi) = (2-\\sqrt{2})\\xi^2 + (\\sqrt{2}-2)\\xi + 1$。\n            我们来复核一下。\n            $W(\\xi) = (1-2\\xi+\\xi^2) + \\sqrt{2}(\\xi-\\xi^2) + \\xi^2 = 1 - 2\\xi + 2\\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2 = \\xi^2(2-\\sqrt{2}) + \\xi(\\sqrt{2}-2) + 1$。这看起来是正确的。\n\n        *   现在，构建曲线 $\\mathbf{x}(\\xi) = (x(\\xi), y(\\xi))$。\n            $\\mathbf{x}(\\xi) = \\frac{\\sum_{i=0}^{2} N_{i,2}(\\xi) w_i \\mathbf{P}_i}{W(\\xi)}$\n            分子是：\n            $\\mathbf{N}(\\xi) = N_{0,2}(\\xi)w_0\\mathbf{P}_0 + N_{1,2}(\\xi)w_1\\mathbf{P}_1 + N_{2,2}(\\xi)w_2\\mathbf{P}_2$\n            $\\mathbf{N}(\\xi) = (1-\\xi)^2 \\cdot 1 \\cdot (1,0) + 2\\xi(1-\\xi) \\cdot \\frac{1}{\\sqrt{2}} \\cdot (1,1) + \\xi^2 \\cdot 1 \\cdot (0,1)$\n            让我们得到分量 $x(\\xi)$ 和 $y(\\xi)$。\n            $x_{num}(\\xi) = (1-\\xi)^2 \\cdot 1 + \\frac{2}{\\sqrt{2}}\\xi(1-\\xi) \\cdot 1 + \\xi^2 \\cdot 0$\n            $x_{num}(\\xi) = (1-2\\xi+\\xi^2) + \\sqrt{2}(\\xi-\\xi^2) = 1 - 2\\xi + \\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2$\n            $x_{num}(\\xi) = (1-\\sqrt{2})\\xi^2 + (\\sqrt{2}-2)\\xi + 1$。\n            这个分子看起来有点复杂。我们先简化分母。\n            $W(\\xi) = (1-\\xi)^2 + \\sqrt{2}\\xi(1-\\xi) + \\xi^2$。\n            让我们尝试另一种简化方法。\n            $W(\\xi) = 1 - 2\\xi + 2\\xi^2 + \\sqrt{2}(\\xi-\\xi^2) = 1 - 2\\xi + 2\\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2$。\n            $W(\\xi) = (2-\\sqrt{2})\\xi^2 - (2-\\sqrt{2})\\xi + 1$。\n            是的，这样更好。\n\n            现在回到分子的分量。\n            $x_{num}(\\xi) = (1-\\xi)^2 \\cdot 1 + 2\\xi(1-\\xi) \\frac{1}{\\sqrt{2}} \\cdot 1 = (1-2\\xi+\\xi^2) + \\sqrt{2}(\\xi-\\xi^2) = 1 - 2\\xi + \\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2 = \\xi^2(1-\\sqrt{2}) + \\xi(\\sqrt{2}-2) + 1$。\n\n            $y_{num}(\\xi) = (1-\\xi)^2 \\cdot 0 + 2\\xi(1-\\xi) \\frac{1}{\\sqrt{2}} \\cdot 1 + \\xi^2 \\cdot 1$\n            $y_{num}(\\xi) = \\sqrt{2}(\\xi-\\xi^2) + \\xi^2 = \\sqrt{2}\\xi - \\sqrt{2}\\xi^2 + \\xi^2 = \\xi^2(1-\\sqrt{2}) + \\sqrt{2}\\xi$。\n\n            所以曲线参数化为：\n            $x(\\xi) = \\frac{x_{num}(\\xi)}{W(\\xi)} = \\frac{1 - 2\\xi + \\xi^2 + \\sqrt{2}\\xi - \\sqrt{2}\\xi^2}{(2-\\sqrt{2})\\xi^2 - (2-\\sqrt{2})\\xi + 1}$\n            $y(\\xi) = \\frac{y_{num}(\\xi)}{W(\\xi)} = \\frac{\\sqrt{2}\\xi - \\sqrt{2}\\xi^2 + \\xi^2}{(2-\\sqrt{2})\\xi^2 - (2-\\sqrt{2})\\xi + 1}$\n\n    *   **步骤 C：验证 $\\|\\mathbf{x}(\\xi)\\| = 1$。**\n        *   目标是证明 $\\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2 = 1$。\n        *   这意味着我需要证明 $x_{num}(\\xi)^2 + y_{num}(\\xi)^2 = W(\\xi)^2$。\n        *   让我们展开这些项。这看起来像是一场代数噩梦。一定有更简单的途径，或者我犯了个错误。\n\n        *   我们来查阅文献。使用二次NURBS表示四分之一圆的参数化通常以新参数（比如 $\\theta$）的三角函数形式给出。我需要坚持使用给定的参数 $\\xi$。\n        *   标准形式通常为：\n            $x(\\xi) = \\frac{1-\\xi^2}{1+\\xi^2}$、$y(\\xi) = \\frac{2\\xi}{1+\\xi^2}$。这是针对不同的一组控制点、权重和节点矢量的。该参数化来自圆的有理参数化。这不是问题所要求的。它要求我从给定的设置推导。\n\n        *   让我们重新验证分母 $W(\\xi) = 1 + (\\sqrt{2}-2)\\xi + (2-\\sqrt{2})\\xi^2$。\n            令 $\\omega = 1/\\sqrt{2}$。则 $W(\\xi) = (1-\\xi)^2 + 2\\omega\\xi(1-\\xi) + \\xi^2$。\n            $x_{num}(\\xi) = (1-\\xi)^2 + 2\\omega\\xi(1-\\xi)$。\n            $y_{num}(\\xi) = 2\\omega\\xi(1-\\xi) + \\xi^2$。\n            等等，这是错的。控制点坐标去哪了？\n            $\\mathbf{x}(\\xi) = \\frac{w_0 N_0 \\mathbf{P}_0 + w_1 N_1 \\mathbf{P}_1 + w_2 N_2 \\mathbf{P}_2}{w_0 N_0 + w_1 N_1 + w_2 N_2}$。\n            $\\mathbf{P}_0=(1,0), \\mathbf{P}_1=(1,1), \\mathbf{P}_2=(0,1)$。\n            $w_0=1, w_1=\\omega, w_2=1$。\n            $N_0 = (1-\\xi)^2, N_1 = 2\\xi(1-\\xi), N_2 = \\xi^2$。\n\n            分子向量：\n            $\\mathbf{N}(\\xi) = 1 \\cdot (1-\\xi)^2 \\cdot (1,0) + \\omega \\cdot 2\\xi(1-\\xi) \\cdot (1,1) + 1 \\cdot \\xi^2 \\cdot (0,1)$\n            $\\mathbf{N}(\\xi) = ((1-\\xi)^2 + 2\\omega\\xi(1-\\xi), 2\\omega\\xi(1-\\xi) + \\xi^2)$\n            这就是我之前得到的。\n            $x_{num}(\\xi) = (1-\\xi)^2 + 2\\omega\\xi(1-\\xi)$\n            $y_{num}(\\xi) = 2\\omega\\xi(1-\\xi) + \\xi^2$\n\n            分母标量：\n            $W(\\xi) = 1 \\cdot (1-\\xi)^2 + \\omega \\cdot 2\\xi(1-\\xi) + 1 \\cdot \\xi^2$\n            $W(\\xi) = (1-2\\xi+\\xi^2) + 2\\omega(\\xi-\\xi^2) + \\xi^2$\n            $W(\\xi) = 1 - 2\\xi + 2\\xi^2 + 2\\omega\\xi - 2\\omega\\xi^2$\n            $W(\\xi) = 1 + (2\\omega-2)\\xi + (2-2\\omega)\\xi^2$。\n            因为 $\\omega = 1/\\sqrt{2}$，所以 $2\\omega = \\sqrt{2}$。\n            $W(\\xi) = 1 + (\\sqrt{2}-2)\\xi + (2-\\sqrt{2})\\xi^2$。\n            这是正确的。\n\n            分子分量：\n            $x_{num}(\\xi) = (1-2\\xi+\\xi^2) + \\sqrt{2}(\\xi-\\xi^2) = 1 + (\\sqrt{2}-2)\\xi + (1-\\sqrt{2})\\xi^2$。\n            $y_{num}(\\xi) = \\sqrt{2}(\\xi-\\xi^2) + \\xi^2 = \\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2$。\n            这些也是正确的。\n\n            代数运算是不可避免的。我们来仔细做一下。\n            我们需要证明 $x_{num}^2 + y_{num}^2 = W^2$。\n            $W(\\xi) = (1+(\\sqrt{2}-2)\\xi) + (2-\\sqrt{2})\\xi^2$\n            $x_{num}(\\xi) = (1+(\\sqrt{2}-2)\\xi) + (1-\\sqrt{2})\\xi^2$\n            $y_{num}(\\xi) = \\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2$\n\n            我们来看。$x_{num}(\\xi)$ 和 $W(\\xi)$ 有一个共同部分。\n            令 $A = 1+(\\sqrt{2}-2)\\xi$。\n            $W(\\xi) = A + (2-\\sqrt{2})\\xi^2$\n            $x_{num}(\\xi) = A + (1-\\sqrt{2})\\xi^2$\n            $y_{num}(\\xi) = \\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2$\n\n            我们想证明 $(A + (1-\\sqrt{2})\\xi^2)^2 + (\\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2)^2 = (A + (2-\\sqrt{2})\\xi^2)^2$。\n            LHS = $A^2 + 2A(1-\\sqrt{2})\\xi^2 + (1-\\sqrt{2})^2\\xi^4 + 2\\xi^2 + 2\\sqrt{2}\\xi(1-\\sqrt{2})\\xi^2 + (1-\\sqrt{2})^2\\xi^4$\n            这看起来不对。\n            $y_{num}(\\xi)^2 = (\\sqrt{2}\\xi)^2 + 2(\\sqrt{2}\\xi)(1-\\sqrt{2})\\xi^2 + ((1-\\sqrt{2})\\xi^2)^2 = 2\\xi^2 + 2(\\sqrt{2}-2)\\xi^3 + (1-\\sqrt{2})^2\\xi^4$。\n\n            让我们重新展开所有内容。\n            $W = 1 + (\\sqrt{2}-2)\\xi + (2-\\sqrt{2})\\xi^2$\n            $x_{num} = 1 + (\\sqrt{2}-2)\\xi + (1-\\sqrt{2})\\xi^2$\n            $y_{num} = \\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2$\n\n            $W^2 = [ (1 + (\\sqrt{2}-2)\\xi) + (2-\\sqrt{2})\\xi^2 ]^2$\n            $W^2 = (1 + (\\sqrt{2}-2)\\xi)^2 + 2(1 + (\\sqrt{2}-2)\\xi)(2-\\sqrt{2})\\xi^2 + (2-\\sqrt{2})^2\\xi^4$\n            $W^2 = 1 + 2(\\sqrt{2}-2)\\xi + (\\sqrt{2}-2)^2\\xi^2 + 2(2-\\sqrt{2})\\xi^2(1 + (\\sqrt{2}-2)\\xi) + (2-\\sqrt{2})^2\\xi^4$\n            $(\\sqrt{2}-2)^2 = 2 - 4\\sqrt{2} + 4 = 6-4\\sqrt{2}$\n            $(2-\\sqrt{2})^2 = 4 - 4\\sqrt{2} + 2 = 6-4\\sqrt{2}$\n            所以 $(\\sqrt{2}-2)^2 = (2-\\sqrt{2})^2$。\n            $W^2 = 1 + (2\\sqrt{2}-4)\\xi + (6-4\\sqrt{2})\\xi^2 + (4-2\\sqrt{2})\\xi^2 + 2(\\sqrt{2}-2)(2-\\sqrt{2})\\xi^3 + (6-4\\sqrt{2})\\xi^4$\n            $2(\\sqrt{2}-2)(2-\\sqrt{2}) = -2(2-\\sqrt{2})^2 = -2(6-4\\sqrt{2}) = -12+8\\sqrt{2}$。哦，等等。$(\\sqrt{2}-2) = -(2-\\sqrt{2})$。\n            $2(\\sqrt{2}-2)(2-\\sqrt{2}) = -2(2-\\sqrt{2})^2 = -2(6-4\\sqrt{2}) = 8\\sqrt{2}-12$。\n            $W^2 = 1 + (2\\sqrt{2}-4)\\xi + (6-4\\sqrt{2}+4-2\\sqrt{2})\\xi^2 + (8\\sqrt{2}-12)\\xi^3 + (6-4\\sqrt{2})\\xi^4$\n            $W^2 = 1 + (2\\sqrt{2}-4)\\xi + (10-6\\sqrt{2})\\xi^2 + (8\\sqrt{2}-12)\\xi^3 + (6-4\\sqrt{2})\\xi^4$\n\n            现在 $x_{num}^2 + y_{num}^2$。\n            $x_{num}^2 = [ (1 + (\\sqrt{2}-2)\\xi) + (1-\\sqrt{2})\\xi^2 ]^2$\n            $x_{num}^2 = (1+(\\sqrt{2}-2)\\xi)^2 + 2(1+(\\sqrt{2}-2)\\xi)(1-\\sqrt{2})\\xi^2 + (1-\\sqrt{2})^2\\xi^4$\n            $x_{num}^2 = 1 + (2\\sqrt{2}-4)\\xi + (6-4\\sqrt{2})\\xi^2 + 2(1-\\sqrt{2})\\xi^2 + 2(\\sqrt{2}-2)(1-\\sqrt{2})\\xi^3 + (1-2\\sqrt{2}+2)\\xi^4$\n            $(1-\\sqrt{2})^2 = 3-2\\sqrt{2}$。\n            $2(\\sqrt{2}-2)(1-\\sqrt{2}) = 2(\\sqrt{2}-2-2+2\\sqrt{2}) = 2(3\\sqrt{2}-4) = 6\\sqrt{2}-8$。\n            $x_{num}^2 = 1+(2\\sqrt{2}-4)\\xi + (6-4\\sqrt{2}+2-2\\sqrt{2})\\xi^2 + (6\\sqrt{2}-8)\\xi^3 + (3-2\\sqrt{2})\\xi^4$\n            $x_{num}^2 = 1+(2\\sqrt{2}-4)\\xi + (8-6\\sqrt{2})\\xi^2 + (6\\sqrt{2}-8)\\xi^3 + (3-2\\sqrt{2})\\xi^4$。\n\n            $y_{num}^2 = (\\sqrt{2}\\xi + (1-\\sqrt{2})\\xi^2)^2 = (\\sqrt{2}\\xi)^2 + 2(\\sqrt{2}\\xi)(1-\\sqrt{2})\\xi^2 + (1-\\sqrt{2})^2\\xi^4$\n            $y_{num}^2 = 2\\xi^2 + 2(\\sqrt{2}-2)\\xi^3 + (3-2\\sqrt{2})\\xi^4$。\n\n            $x_{num}^2 + y_{num}^2 = 1+(2\\sqrt{2}-4)\\xi + (8-6\\sqrt{2})\\xi^2 + (6\\sqrt{2}-8)\\xi^3 + (3-2\\sqrt{2})\\xi^4$\n                                $+ 2\\xi^2 + (2\\sqrt{2}-4)\\xi^3 + (3-2\\sqrt{2})\\xi^4$\n            $x_{num}^2 + y_{num}^2 = 1 + (2\\sqrt{2}-4)\\xi + (10-6\\sqrt{2})\\xi^2 + (6\\sqrt{2}-8+2\\sqrt{2}-4)\\xi^3 + (3-2\\sqrt{2}+3-2\\sqrt{2})\\xi^4$\n            $x_{num}^2 + y_{num}^2 = 1 + (2\\sqrt{2}-4)\\xi + (10-6\\sqrt{2})\\xi^2 + (8\\sqrt{2}-12)\\xi^3 + (6-4\\sqrt{2})\\xi^4$。\n\n            这正是 $W^2$。\n            $W^2 = 1 + (2\\sqrt{2}-4)\\xi + (10-6\\sqrt{2})\\xi^2 + (8\\sqrt{2}-12)\\xi^3 + (6-4\\sqrt{2})\\xi^4$。\n            太好了，匹配上了。代数运算很繁琐，但结果是正确的。\n            所以，$x_{num}(\\xi)^2 + y_{num}(\\xi)^2 = W(\\xi)^2$。\n            这意味着 $\\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2 = \\frac{x_{num}(\\xi)^2 + y_{num}(\\xi)^2}{W(\\xi)^2} = \\frac{W(\\xi)^2}{W(\\xi)^2} = 1$。\n            所以，对于所有 $\\xi \\in [0,1]$，$\\|\\mathbf{x}(\\xi)\\| = \\sqrt{1} = 1$。\n            问题要求 $\\|\\mathbf{x}(\\xi)\\|$ 的简化闭式表达式。简化的表达式就是 $1$。\n\n    *   **最终结构和审查。**\n        *   从验证开始。这个问题是一个标准的教科书示例，它有科学依据、适定、客观、完整且可行。它是有效的。\n        *   清晰地列出解题步骤。\n            1.  陈述Cox-de Boor递推公式。\n            2.  为给定的节点矢量 $\\Xi=(0,0,0,1,1,1)$ 推导二次B样条基函数。证明它们可以简化为二次伯恩斯坦多项式：$N_{0,2}=(1-\\xi)^2$、$N_{1,2}=2\\xi(1-\\xi)$、$N_{2,2}=\\xi^2$。\n            3.  陈述NURBS曲线的定义。\n            4.  构建有理基函数 $R_{i,2}(\\xi)$。这涉及到计算分母函数 $W(\\xi)$。\n            5.  构建向量值函数 $\\mathbf{x}(\\xi)=(x(\\xi), y(\\xi))$。写出 $x(\\xi)$ 和 $y(\\xi)$ 的显式表达式。\n            6.  计算欧几里得范数的平方，$\\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2$。\n            7.  通过证明 $x_{num}(\\xi)^2 + y_{num}(\\xi)^2 = W(\\xi)^2$ 来证明 $\\|\\mathbf{x}(\\xi)\\|^2 = 1$。清晰地列出代数展开。\n            8.  得出结论 $\\|\\mathbf{x}(\\xi)\\| = 1$。\n            9.  最终答案是 $\\|\\mathbf{x}(\\xi)\\|$ 的表达式，即 $1$。\n\n    *   **复核B样条基函数的推导。**\n        节点矢量 $\\Xi = \\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5\\} = \\{0,0,0,1,1,1\\}$。次数 $p=2$。控制点数 $n+1=3 \\implies n=2$。\n        $m=n+p+1 \\implies m=2+2+1=5$。确实，有 $6$ 个节点 $\\xi_0, \\dots, \\xi_5$。\n        唯一的非零区间是 $[\\xi_2, \\xi_3) = [0,1)$。\n        $p=0$:\n        $N_{2,0}(\\xi) = 1$ 对于 $\\xi \\in [0,1)$，否则为 $0$。\n        $p=1$:\n        $N_{1,1}(\\xi) = \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_2}N_{2,0}(\\xi) = \\frac{1-\\xi}{1-0} \\cdot 1 = 1-\\xi$。另一项为零，因为 $\\xi_2-\\xi_1=0$。\n        $N_{2,1}(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_3-\\xi_2}N_{2,0}(\\xi) = \\frac{\\xi-0}{1-0} \\cdot 1 = \\xi$。另一项为零，因为 $\\xi_4-\\xi_3=0$。\n        这些是正确的。\n        $p=2$:\n        $N_{0,2}(\\xi) = \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_1}N_{1,1}(\\xi) = \\frac{1-\\xi}{1-0}(1-\\xi)=(1-\\xi)^2$。另一项为零，因为 $N_{0,1}=0$（由于 $\\xi_1-\\xi_0=0$ 和 $\\xi_2-\\xi_1=0$）。正确。\n        $N_{1,2}(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_3-\\xi_1}N_{1,1}(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_2}N_{2,1}(\\xi) = \\frac{\\xi-0}{1-0}(1-\\xi) + \\frac{1-\\xi}{1-0}\\xi = \\xi(1-\\xi) + \\xi(1-\\xi) = 2\\xi(1-\\xi)$。正确。\n        $N_{2,2}(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_4-\\xi_2}N_{2,1}(\\xi) = \\frac{\\xi-0}{1-0}\\xi = \\xi^2$。另一项为零，因为 $N_{3,1}=0$（由于 $\\xi_4-\\xi_3=0$ 和 $\\xi_5-\\xi_4=0$）。正确。\n        基函数是正确的。\n\n    *   **再次检查代数。** 展开很丑陋。也许有更优雅的方法。\n        让我们用基函数重写分量。\n        $x_{num} = w_0 N_0 + w_1 N_1$\n        $y_{num} = w_1 N_1 + w_2 N_2$\n        $W = w_0 N_0 + w_1 N_1 + w_2 N_2$\n        等等，不对。控制点很重要。\n        $x_{num} = w_0 N_0 P_{0x} + w_1 N_1 P_{1x} + w_2 N_2 P_{2x} = 1 \\cdot N_0 \\cdot 1 + w_1 N_1 \\cdot 1 + 1 \\cdot N_2 \\cdot 0 = N_0 + w_1 N_1$。\n        $y_{num} = w_0 N_0 P_{0y} + w_1 N_1 P_{1y} + w_2 N_2 P_{2y} = 1 \\cdot N_0 \\cdot 0 + w_1 N_1 \\cdot 1 + 1 \\cdot N_2 \\cdot 1 = w_1 N_1 + N_2$。\n        $W = N_0 + w_1 N_1 + N_2$。\n        这里 $w_1 = 1/\\sqrt{2}$。哦，这样简洁多了。\n        我们需要证明 $(N_0 + w_1 N_1)^2 + (w_1 N_1 + N_2)^2 = (N_0 + w_1 N_1 + N_2)^2$ 吗？\n        让我们检查一下。\n        LHS = $N_0^2 + 2w_1 N_0 N_1 + w_1^2 N_1^2 + w_1^2 N_1^2 + 2w_1 N_1 N_2 + N_2^2$\n        LHS = $N_0^2 + N_2^2 + 2w_1 N_1(N_0+N_2) + 2w_1^2 N_1^2$。\n        RHS = $( (N_0+N_2) + w_1 N_1 )^2 = (N_0+N_2)^2 + 2w_1 N_1 (N_0+N_2) + w_1^2 N_1^2$。\n        RHS = $N_0^2 + 2N_0 N_2 + N_2^2 + 2w_1 N_1 (N_0+N_2) + w_1^2 N_1^2$。\n\n        所以要使 LHS = RHS，我们需要证明：\n        $N_0^2 + N_2^2 + 2w_1 N_1(N_0+N_2) + 2w_1^2 N_1^2 = N_0^2 + 2N_0 N_2 + N_2^2 + 2w_1 N_1 (N_0+N_2) + w_1^2 N_1^2$。\n        这简化为：$2w_1^2 N_1^2 = 2 N_0 N_2 + w_1^2 N_1^2$。\n        进一步简化为：$w_1^2 N_1^2 = 2 N_0 N_2$。\n        这是一个已知的用二次NURBS表示圆弧的恒等式，称为“圆锥属性”。我们来检查它是否对我们的基函数和权重成立。\n        $w_1 = 1/\\sqrt{2}$，所以 $w_1^2 = 1/2$。\n        $N_0 = (1-\\xi)^2$。\n        $N_1 = 2\\xi(1-\\xi)$。\n        $N_2 = \\xi^2$。\n\n        LHS: $w_1^2 N_1^2 = \\frac{1}{2} (2\\xi(1-\\xi))^2 = \\frac{1}{2} (4\\xi^2(1-\\xi)^2) = 2\\xi^2(1-\\xi)^2$。\n        RHS: $2 N_0 N_2 = 2 (1-\\xi)^2 \\xi^2 = 2\\xi^2(1-\\xi)^2$。\n        \n        LHS = RHS。恒等式成立。\n        这提供了一个比对 $\\xi$ 的多项式进行暴力展开更优雅的证明。我将在解法中使用这种符号方法。它按要求直接从定义中推导出来。\n\n        所以流程是：\n        1. 验证。\n        2. 推导B样条基函数 $N_0, N_1, N_2$。\n        3. 用符号 $N_i$、$w_i$ 和 $P_i$ 形式化地表示NURBS曲线分量的分子（$x_{num}, y_{num}$）和分母（$W$）。\n           $x_{num} = N_{0,2} + w_1 N_{1,2}$\n           $y_{num} = w_1 N_{1,2} + N_{2,2}$\n           $W = N_{0,2} + w_1 N_{1,2} + N_{2,2}$\n        4. 陈述目标是证明 $x_{num}^2 + y_{num}^2 = W^2$。\n        5. 对两边进行符号展开。\n           LHS = $(N_{0,2} + w_1 N_{1,2})^2 + (w_1 N_{1,2} + N_{2,2})^2$\n           RHS = $(N_{0,2} + w_1 N_{1,2} + N_{2,2})^2$\n        6. 证明等式成立当且仅当 $w_1^2 N_{1,2}^2 = 2 N_{0,2} N_{2,2}$。\n        7. 将推导出的 $N_{i,2}$ 表达式和给定的 $w_1$ 值代入此条件以进行验证。\n        8. 得出结论，由于该条件成立，因此 $x_{num}^2 + y_{num}^2 = W^2$，所以 $\\|\\mathbf{x}(\\xi)\\|^2 = 1$，即 $\\|\\mathbf{x}(\\xi)\\| = 1$。\n        9. 最终答案是 $1$。\n\n这是一个更好、更简洁、更有见地的解法。它展示了对底层数学结构的理解，而不仅仅是代数运算。它完全满足了提示中“仅使用这些基础定义和代数简化”的要求。它表明结果不是系数的巧合，而是一种结构属性。\n\n我需要确保每个数学符号都在LaTeX中。\n例如，控制点 $\\mathbf{P}_i$，权重 $w_i$，参数 $\\xi$，次数 $p=2$，节点矢量 $\\Xi$，基函数 $N_{i,p}(\\xi)$ 和 $R_{i,p}(\\xi)$，曲线 $\\mathbf{x}(\\xi)$，分量 $x(\\xi)$ 和 $y(\\xi)$，欧几里得范数 $\\|\\cdot\\|$。所有数字也必须在LaTeX中，如 $1$、$0$、$1/\\sqrt{2}$。\n\n问题是有效的。\n1.  **科学或事实不健全**：否。这是CAD/CAGD和IGA中的经典问题。\n2.  **非形式化或不相关**：否。这是一个与指定主题直接相关的形式化数学问题。\n3.  **不完整或矛盾的设置**：否。所有必要的数据（控制点、权重、节点矢量、次数）都已提供并且是一致的。\n4.  **不切实际或不可行**：否。该数据是表示四分之一圆的标准数据。\n5.  **不适定或结构不良**：否。问题要求进行验证，这有一个明确的“是/否”答案和一个推导过程。\n6.  **伪深刻、琐碎或同义反复**：否。它需要从第一性原理进行非平凡的推导。\n7.  **超出科学可验证性**：否。这是一个数学证明。\n\n结论是问题有效。我将采用优雅的符号解法。\n最终答案是 $\\|\\mathbf{x}(\\xi)\\|$ 的闭式表达式，即 $1$。所以我只需将数字1框起来。\n最后检查问题陈述：“提供 $\\|\\mathbf{x}(\\xi)\\|$ 作为 $\\xi$ 的函数的简化闭式表达式”。\n我的结果是 $\\|\\mathbf{x}(\\xi)\\| = 1$。这是一个关于 $\\xi$ 的函数，一个常数函数。这是最简的闭式表达式。所以答案是正确的。\n流程看起来很可靠。开始写吧。", "answer": "$$\n\\boxed{1}\n$$", "id": "3575812"}, {"introduction": "在拥有精确的几何表示之后，下一步便是进行分析并根据需要提高解的精度。在传统有限元中，这通常通过网格加密来完成；在等几何分析中，我们有更优雅的 refine (细化) 技术，例如节点插入 (knot insertion)。节点插入允许我们在不改变曲线或曲面几何形状的前提下，增加基函数的数量（即增加自由度），从而实现 $h$-细化。本练习将让您实践对前述圆弧进行节点插入的标准算法，即 Boehm 算法，这是掌握 IGA 中模型细化和自适应分析的关键技能。[@problem_id:3575751]", "problem": "考虑一条平面二次（$p=2$）非均匀有理B样条（NURBS）曲线，该曲线用于在曲线梁理想化中精确表示一个半径为$R=2$的四分之一圆弧。该曲线定义在夹持节点矢量 $\\Xi=\\{0,0,0,1,1,1\\}$ 上，其控制点为 $P_0=(2,0)$、$P_1=(2,2)$、$P_2=(0,2)$，对应的权值为 $w_0=1$、$w_1=\\frac{1}{\\sqrt{2}}$、$w_2=1$。从NURBS曲线在 $\\mathbb{R}^2$ 中作为定义在齐次坐标系下的多项式B样条曲线的有理投影这一定义出发，并利用标准的B样条节点插入过程（应用于齐次控制点），在参数 $\\xi=0.5$ 处执行一次节点插入。\n\n仅使用这些原理，精确推导新的节点矢量并计算更新后的控制点和权值集合（无数值舍入）。将最终结果表示为一个单行矩阵，该矩阵首先列出新节点矢量的所有条目，然后按顺序 $i=0,1,2,3$ 列出更新后的控制点和权值的元组 $(x_i,y_i,w_i)$。所有数学实体必须以精确的符号形式表示。不要进行舍入。最终答案必须是单个解析表达式。", "solution": "该问题要求在给定的二次非均匀有理B样条（NURBS）曲线上执行一次节点插入，并确定由此产生的新节点矢量、控制点和权值。\n\n### 步骤1：提取已知条件\n- **曲线类型**：平面二次NURBS曲线\n- **次数**：$p=2$\n- **几何形状**：半径为$R=2$的四分之一圆弧\n- **节点矢量**：$\\Xi=\\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$\n- **控制点**：$P_0=(2,0)$、$P_1=(2,2)$、$P_2=(0,2)$\n- **权值**：$w_0=1$、$w_1=\\frac{1}{\\sqrt{2}}$、$w_2=1$\n- **任务**：在参数 $\\xi=0.5$ 处执行一次节点插入。\n- **方法**：使用NURBS在齐次坐标中的定义和标准的B样条节点插入算法。\n- **输出**：一个包含新节点矢量以及新控制点和权值 $(x_i, y_i, w_i)$ 的单行矩阵。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述描述了计算机辅助几何设计（CAGD）和等几何分析（IGA）领域中一个标准且定义明确的过程。具有给定控制点和权值的二次NURBS曲线确实表示一个半径为$R=2$的四分之一圆弧。控制点的数量（$n+1=3$）和节点矢量的大小（$m+1=6$）通过关系式 $m=n+p+1$（在此为 $5=2+2+1$）与次数（$p=2$）相符。节点插入算法是样条理论中一个基本且适定的操作。所有提供的信息都是自洽、一致且科学合理的。因此，该问题被认为是有效的。\n\n### 步骤3：求解\nNURBS曲线的节点插入过程通过在其对应的齐次空间B样条表示上进行操作来最清晰地执行。\n\n**第1部分：齐次表示**\n$\\mathbb{R}^2$ 中的NURBS曲线是 $\\mathbb{R}^3$ 齐次空间中B样条曲线的投影。齐次控制点 $P_i^w$ 是通过将控制点 $P_i=(x_i, y_i)$ 的笛卡尔坐标乘以其各自的权值 $w_i$，并将权值作为最后一个坐标分量附加而形成的：$P_i^w = (w_i x_i, w_i y_i, w_i)$。\n\n给定的控制点和权值是：\n$P_0=(2,0)$，权值为 $w_0=1$\n$P_1=(2,2)$，权值为 $w_1=\\frac{1}{\\sqrt{2}}$\n$P_2=(0,2)$，权值为 $w_2=1$\n\n对应的齐次控制点是：\n$P_0^w = (1 \\cdot 2, 1 \\cdot 0, 1) = (2, 0, 1)$\n$P_1^w = (\\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}}) = (\\frac{2}{\\sqrt{2}}, \\frac{2}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}) = (\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}})$\n$P_2^w = (1 \\cdot 0, 1 \\cdot 2, 1) = (0, 2, 1)$\n\n这些是次数为 $p=2$、节点矢量为 $\\Xi=\\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$ 的多项式B样条曲线的控制点。\n\n**第2部分：节点插入算法**\n我们将新节点 $\\bar{\\xi}=0.5$ 插入到节点矢量 $\\Xi$ 中。首先，我们必须确定 $\\bar{\\xi}$ 所在的节点区间 $[\\xi_k, \\xi_{k+1})$。节点矢量为 $\\Xi=\\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5\\} = \\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$。由于 $\\xi_2=0 \\leq 0.5  \\xi_3=1$，所以索引为 $k=2$。\n\n插入一个节点会使控制点的数量增加一个。原始曲线有 $n+1=3$ 个控制点。新曲线将有 $(n+1)+1=4$ 个控制点，我们将其表示为 $\\hat{P}_0^w, \\hat{P}_1^w, \\hat{P}_2^w, \\hat{P}_3^w$。\n\n新控制点 $\\hat{P}_j$ 的公式（Boehm算法）是：\n$\\hat{P}_j = P_j$ for $j \\le k-p$\n$\\hat{P}_j = (1-\\alpha_j)P_{j-1} + \\alpha_j P_j$ for $k-p+1 \\le j \\le k$\n$\\hat{P}_j = P_{j-1}$ for $j \\ge k+1$\n\n这里，$\\alpha_j = \\frac{\\bar{\\xi} - \\xi_j}{\\xi_{j+p} - \\xi_j}$。我们将此公式应用于齐次控制点 $P_i^w$。当 $p=2$ 和 $k=2$ 时：\n- 对于 $j \\le k-p = 2-2=0$：$\\hat{P}_0^w = P_0^w$。\n- 对于 $j \\ge k+1 = 3$：$\\hat{P}_3^w = P_{3-1}^w = P_2^w$。\n- 对于 $k-p+1 \\le j \\le k$，即 $1 \\le j \\le 2$，我们计算新的点：\n\n对于 $j=1$：\n$\\alpha_1 = \\frac{\\bar{\\xi} - \\xi_1}{\\xi_{1+p} - \\xi_1} = \\frac{0.5 - \\xi_1}{\\xi_3 - \\xi_1} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2}$。\n$\\hat{P}_1^w = (1-\\alpha_1)P_0^w + \\alpha_1 P_1^w = \\frac{1}{2}P_0^w + \\frac{1}{2}P_1^w$。\n$\\hat{P}_1^w = \\frac{1}{2}(2, 0, 1) + \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) = (1, 0, \\frac{1}{2}) + (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) = (1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2}+\\frac{\\sqrt{2}}{4}) = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$。\n\n对于 $j=2$：\n$\\alpha_2 = \\frac{\\bar{\\xi} - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{0.5 - \\xi_2}{\\xi_4 - \\xi_2} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2}$。\n$\\hat{P}_2^w = (1-\\alpha_2)P_1^w + \\alpha_2 P_2^w = \\frac{1}{2}P_1^w + \\frac{1}{2}P_2^w$。\n$\\hat{P}_2^w = \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) + \\frac{1}{2}(0, 2, 1) = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) + (0, 1, \\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, 1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{4}+\\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$。\n\n因此，新的齐次控制点集合是：\n$\\hat{P}_0^w = (2, 0, 1)$\n$\\hat{P}_1^w = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{P}_2^w = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{P}_3^w = (0, 2, 1)$\n\n**第3部分：投影回笛卡尔坐标**\n为了获得新的笛卡尔控制点 $\\hat{P}_j=(\\hat{x}_j, \\hat{y}_j)$ 和权值 $\\hat{w}_j$，我们将齐次点 $\\hat{P}_j^w=(X_j, Y_j, W_j)$ 投影回去：$\\hat{w}_j = W_j$ 且 $(\\hat{x}_j, \\hat{y}_j) = (\\frac{X_j}{W_j}, \\frac{Y_j}{W_j})$。\n\n- 对于 $\\hat{P}_0^w=(2,0,1)$：\n$\\hat{w}_0 = 1$\n$\\hat{P}_0 = (\\frac{2}{1}, \\frac{0}{1}) = (2,0)$。\n\n- 对于 $\\hat{P}_1^w=(\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$：\n$\\hat{w}_1 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_1 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$\n$\\hat{y}_1 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = \\frac{\\sqrt{2}}{2} \\cdot \\frac{4}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\frac{4\\sqrt{2}-4}{4-2} = 2\\sqrt{2}-2$。\n$\\hat{P}_1 = (2, 2\\sqrt{2}-2)$。\n\n- 对于 $\\hat{P}_2^w=(\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$：\n$\\hat{w}_2 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_2 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = 2\\sqrt{2}-2$\n$\\hat{y}_2 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$。\n$\\hat{P}_2 = (2\\sqrt{2}-2, 2)$。\n\n- 对于 $\\hat{P}_3^w=(0,2,1)$：\n$\\hat{w}_3 = 1$\n$\\hat{P}_3 = (\\frac{0}{1}, \\frac{2}{1}) = (0,2)$。\n\n**第4部分：最终结果**\n新的节点矢量 $\\hat{\\Xi}$ 是通过将 $\\bar{\\xi}=0.5$ 插入到 $\\Xi$ 中形成的：\n$\\hat{\\Xi} = \\{\\,0,\\,0,\\,0,\\,0.5,\\,1,\\,1,\\,1\\,\\} = \\{\\,0,\\,0,\\,0,\\,\\frac{1}{2},\\,1,\\,1,\\,1\\,\\}$。\n\n新的控制点和权值，表示为元组 $(\\hat{x}_i, \\hat{y}_i, \\hat{w}_i)$，是：\n对于 $i=0$：$(2, 0, 1)$\n对于 $i=1$：$(2, 2\\sqrt{2}-2, \\frac{2+\\sqrt{2}}{4})$\n对于 $i=2$：$(2\\sqrt{2}-2, 2, \\frac{2+\\sqrt{2}}{4})$\n对于 $i=3$：$(0, 2, 1)$\n\n根据要求，将这些结果收集到一个单行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  \\frac{1}{2}  1  1  1  2  0  1  2  2\\sqrt{2}-2  \\frac{2+\\sqrt{2}}{4}  2\\sqrt{2}-2  2  \\frac{2+\\sqrt{2}}{4}  0  2  1\n\\end{pmatrix}\n}\n$$", "id": "3575751"}]}