{"hands_on_practices": [{"introduction": "拓扑优化的基础是能够根据给定的材料布局预测结构的性能。本练习将通过将固体各向同性材料惩罚（SIMP）模型与有限元法（FEM）相结合，为您提供计算结构柔度（即我们的目标函数）的动手实践。通过完成刚度矩阵的组装和求解位移，您将具体理解材料密度如何直接影响结构的刚度并最终决定其性能 [@problem_id:3607228]。", "problem": "考虑一个平面应力下的线性弹性悬臂梁结构，该结构由单个双线性四边形（四节点）有限元离散化。该悬臂梁占据一个矩形区域，节点位于 $(0,0)$, $(L,0)$, $(L,H)$ 和 $(0,H)$，其中 $L=2\\,\\text{m}$ 且 $H=2\\,\\text{m}$。左边缘的节点 $(0,0)$ 和 $(0,H)$ 被固定，因此它们的水平和垂直位移均为零。在右上角节点 $(L,H)$ 处施加一个大小为 $F=1000\\,\\text{N}$ 的垂直向下点荷载，无其他外部荷载。使用平面应力模型，厚度 $t=0.01\\,\\text{m}$，泊松比 $\\nu=0$，并采用固体各向同性材料惩罚模型（SIMP）来描述各向同性刚度，其中杨氏模量为 $E(\\rho)=E_{\\min}+\\rho^{p}(E_{0}-E_{\\min})$。取 $E_{0}=2\\times 10^{9}\\,\\text{Pa}$，$E_{\\min}=0\\,\\text{Pa}$，$p=2$，单元密度 $\\rho=\\frac{1}{2}$。该双线性四边形单元通过标准等参映射从参考正方形 $[-1,1]\\times[-1,1]$ 映射而来；对于此矩形几何形状，雅可比行列式为常数，等于 $\\det(J)=\\frac{LH}{4}=1\\,\\text{m}^{2}$。使用 $2\\times 2$ 高斯求積法，积分点为 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$，每个点的权重为单位1，来组装单元刚度矩阵。从本构律、应变-位移关系和等参有限元列式的定义出发，在给定的荷载和边界条件下，为单个单元组装离散柔度 $$J(\\rho)=\\sum_{e} u_{e}^{T} k_{e}(\\rho)\\,u_{e}$$，其中 $u_{e}$ 是单元的节点位移，$k_{e}(\\rho)$ 是 SIMP 模型下的单元刚度。计算给定数据下 $J(\\rho)$ 的数值。最终能量以焦耳为单位表示，并将答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **结构配置：** 悬臂梁，单个双线性四边形（四节点）有限元。\n- **几何形状：** 矩形，节点位于 $(0,0)$, $(L,0)$, $(L,H)$, $(0,H)$。\n- **尺寸：** $L=2\\,\\text{m}$, $H=2\\,\\text{m}$。\n- **边界条件 (BCs)：** 节点 $(0,0)$ 和 $(0,H)$ 被固定（水平和垂直位移为零）。\n- **荷载：** 在节点 $(L,H)$ 处施加一个大小为 $F=1000\\,\\text{N}$ 的垂直向下点荷载。无其他外部荷载。\n- **力学模型：** 线性弹性，平面应力。\n- **单元厚度：** $t=0.01\\,\\text{m}$。\n- **泊松比：** $\\nu=0$。\n- **材料模型：** 固体各向同性材料惩罚模型（SIMP）。\n- **杨氏模量：** $E(\\rho)=E_{\\min}+\\rho^{p}(E_{0}-E_{\\min})$。\n- **SIMP 参数：** $E_{0}=2\\times 10^{9}\\,\\text{Pa}$, $E_{\\min}=0\\,\\text{Pa}$, $p=2$, $\\rho=\\frac{1}{2}$。\n- **有限元 (FE) 列式：**\n  - 从参考正方形 $[-1,1]\\times[-1,1]$ 进行等参映射。\n  - 雅可比行列式 $\\det(J)=\\frac{LH}{4}=1\\,\\text{m}^{2}$。\n  - $2\\times 2$ 高斯求积，积分点为 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\} \\times \\{\\pm 1/\\sqrt{3}\\}$，权重为单位1。\n- **目标：** 计算柔度 $J(\\rho)=\\sum_{e} u_{e}^{T} k_{e}(\\rho)\\,u_{e}$ 的数值，单位为焦耳，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题是有限元法在线性弹性问题中的一个标准应用，并结合了成熟的 SIMP 模型。所有概念都是计算固体力学的基础。该问题在科学上是合理的。\n2.  **适定性：** 该问题提供了所有必要的数据、边界条件和材料属性，以唯一地确定位移场，进而确定柔度。设置是自洽和一致的。\n3.  **客观性：** 问题陈述使用了精确、明确的技术语言。没有主观或基于意见的元素。\n\n### 步骤 3：结论与行动\n此问题是**有效的**。将提供完整的解答。\n\n### 解答\n该问题要求计算悬臂梁单单元模型的柔度 $J(\\rho)$。柔度定义为 $J(\\rho) = \\mathbf{U}^T \\mathbf{K} \\mathbf{U}$，其中 $\\mathbf{U}$ 是全局节点位移向量，$\\mathbf{K}$ 是全局刚度矩阵。对于处于平衡状态的线性弹性系统，有 $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$，其中 $\\mathbf{F}$ 是全局力向量。因此，柔度也等于外力所做的功，$J(\\rho) = \\mathbf{U}^T \\mathbf{F}$。\n\n首先，我们定义节点编号和自由度（DoFs）。设节点编号如下：\n- 节点 1：$(0,0)$，自由度为 $(u_1, u_2)$\n- 节点 2：$(L,0)$，自由度为 $(u_3, u_4)$\n- 节点 3：$(L,H)$，自由度为 $(u_5, u_6)$\n- 节点 4：$(0,H)$，自由度为 $(u_7, u_8)$\n\n全局位移向量为 $\\mathbf{U} = [u_1, u_2, u_3, u_4, u_5, u_6, u_7, u_8]^T$。\n\n边界条件规定节点 $1$ 和 $4$ 被固定：\n$u_1 = u_2 = 0$\n$u_7 = u_8 = 0$\n\n外部荷载是在节点 $3$ 处向下的力 $F$。全局力向量为：\n$\\mathbf{F} = [F_1, F_2, 0, 0, 0, -F, F_7, F_8]^T$，其中 $F_1, F_2, F_7, F_8$ 是未知的反作用力。\n\n方程组 $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$ 可以简化为只包含自由自由度，即 $(u_3, u_4, u_5, u_6)$。我们定义简化的位移和力向量：\n$\\mathbf{U}_{\\text{free}} = [u_3, u_4, u_5, u_6]^T$\n$\\mathbf{F}_{\\text{free}} = [0, 0, 0, -F]^T$\n\n需要求解的系统是 $\\mathbf{K}_{\\text{free}} \\mathbf{U}_{\\text{free}} = \\mathbf{F}_{\\text{free}}$，其中 $\\mathbf{K}_{\\text{free}}$ 是 $\\mathbf{K}$ 中对应于自由自由度的 $4\\times4$ 子矩阵。\n\n接下来，我们计算材料属性。惩罚后的杨氏模量 $E$ 为：\n$$E(\\rho) = E_{\\min}+\\rho^{p}(E_{0}-E_{\\min}) = 0 + \\left(\\frac{1}{2}\\right)^{2}(2 \\times 10^9 - 0) = \\frac{1}{4} E_0 = 0.5 \\times 10^9\\,\\text{Pa}$$\n\n对于泊松比 $\\nu=0$ 的平面应力问题，本构矩阵 $\\mathbf{D}$ 为：\n$$\\mathbf{D} = \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix} = E \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}$$\n通过标准的有限元程序计算单元刚度矩阵 $\\mathbf{K}$ 并求解简化的线性系统 $\\mathbf{K}_{\\text{free}}\\mathbf{U}_{\\text{free}} = \\mathbf{F}_{\\text{free}}$ 是一个冗长的过程。可以证明，对于这个具有 $\\nu=0$ 的特定问题，在节点3处施加的力 $F_6 = -F$ 所对应的位移为：\n$$u_6 = -\\frac{14F}{3tE}$$\n柔度等于外力所做的功。由于在自由度上只有力分量 $F_6$ 非零，我们有：\n$$J(\\rho) = u_6 F_6 = \\left(-\\frac{14F}{3tE}\\right) (-F) = \\frac{14F^2}{3tE}$$\n现在，我们代入数值：\n$F = 1000\\,\\text{N}$\n$t = 0.01\\,\\text{m}$\n$E = E(\\rho) = 0.5 \\times 10^9\\,\\text{Pa}$\n$$tE = (0.01\\,\\text{m})(0.5 \\times 10^9\\,\\text{N/m}^2) = 5 \\times 10^6\\,\\text{N/m}$$\n$$J = \\frac{14 \\times (1000)^2}{3 \\times (5 \\times 10^6)} = \\frac{14 \\times 10^6}{15 \\times 10^6} = \\frac{14}{15}\\,\\text{J}$$\n数值为：\n$$J = \\frac{14}{15} \\approx 0.933333... \\,\\text{J}$$\n四舍五入到四位有效数字，我们得到 $0.9333\\,\\text{J}$。", "answer": "$$\\boxed{0.9333}$$", "id": "3607228"}, {"introduction": "一旦我们能够评估一个设计的柔度，下一步就是系统地改进它。本练习将引导您完成一次拓扑优化中的核心算法——最优性准则（OC）法——的迭代。您将利用给定的灵敏度信息来更新材料密度，从而学习该算法如何在满足严格体积约束的同时，智能地将材料重新分配到最有效的位置 [@problem_id:3607239]。", "problem": "考虑一个线性弹性悬臂梁，该悬臂梁被离散为 $4$ 个等体积的有限元，采用固体各向同性材料惩罰模型 (SIMP) 进行柔度最小化。设计变量为单元密度 $\\{\\rho_i\\}_{i=1}^{4}$，其上下界为 $0  \\rho_{\\min} \\le \\rho_i \\le 1$。目标是在全局体积分数约束下最小化柔度 $C(\\boldsymbol{\\rho})$。假设为平面应力、小应变和线性弹性。SIMP 材料插值模型为 $E(\\rho_i) = \\rho_i^{p} E_0$，其中惩罰指数 $p \\ge 1$，当前迭代点 $\\boldsymbol{\\rho}^{k}$ 处的柔度灵敏度由伴随法给出。体积约束为 $\\sum_{i=1}^{4} v_i \\rho_i \\le V^{\\star}$，其中各单元体积相等，即 $v_i = 1$。\n\n从约束优化问题的 Karush–Kuhn–Tucker (KKT) 条件出发，并使用关于 $\\boldsymbol{\\rho}^{k}$ 的经典柔度倒数局部近似，推导单次迭代的最优性准则 (OC) 更新格式。然后，对于以下特定数据，执行一次 OC 更新，强制执行移动限制和边界约束，并通过在更新后满足体积约束来确定拉格朗日乘子。\n\n使用以下数据：\n- 当前密度：$\\boldsymbol{\\rho}^{k} = [\\,0.7,\\,0.4,\\,0.3,\\,0.6\\,]$。\n- 在 $\\boldsymbol{\\rho}^{k}$ 处计算的柔度灵敏度：$\\left[\\frac{\\partial C}{\\partial \\rho_1},\\,\\frac{\\partial C}{\\partial \\rho_2},\\,\\frac{\\partial C}{\\partial \\rho_3},\\,\\frac{\\partial C}{\\partial \\rho_4}\\right] = [\\,-4.0,\\,-0.5,\\,-0.2,\\,-3.0\\,]$。\n- 惩罰指数：$p = 3$（已在给定的灵敏度中考虑）。\n- 目标体积分数：$v_f^{\\star} = 0.5$，因此目标体积为 $V^{\\star} = v_f^{\\star} \\times 4$。\n- 移动限制：$m = 0.1$，因此每个更新后的密度必须满足 $\\rho_i^{k} - m \\le \\rho_i^{k+1} \\le \\rho_i^{k} + m$。\n- 边界：$\\rho_{\\min} = 0.001$ 和 $\\rho_{\\max} = 1$。\n- 单元体积：所有 $i$ 的 $v_i = 1$。\n\n请从第一性原理出发，明确陈述推导出的 OC 更新公式，然后通过确定拉格朗日乘子来计算更新后的密度 $\\boldsymbol{\\rho}^{k+1}$，使得在施加移动限制和边界约束后满足 $\\sum_{i=1}^{4} \\rho_i^{k+1} = V^{\\star}$。将每个更新后的密度四舍五入到四位有效数字。以单行向量的形式报告最终更新的密度。", "solution": "所提出的问题是计算固体力学领域中一个明确定义的练习，具体属于拓扑优化范畴。该问题科学地建立在线性弹性和约束优化的原理之上，并为最优性准则 (OC) 方法的单次迭代提供了所有必要的数据和条件。该问题是自洽、一致的，并且对于所要求的更新步骤，存在唯一解。因此，该问题被认为是有效的，可以寻求完整解答。\n\n该优化问题是一个线性弹性结构的柔度最小化问题，可表述为：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  C(\\boldsymbol{\\rho}) = \\mathbf{F}^T \\mathbf{U} \\\\\n\\text{subject to} \\quad  \\mathbf{K}(\\boldsymbol{\\rho}) \\mathbf{U} = \\mathbf{F} \\\\\n G(\\boldsymbol{\\rho}) = \\sum_{i=1}^{N} v_i \\rho_i - V^{\\star} \\le 0 \\\\\n \\boldsymbol{\\rho}_{\\min} \\le \\boldsymbol{\\rho} \\le \\boldsymbol{\\rho}_{\\max}\n\\end{aligned}\n$$\n其中 $C$ 是柔度，$\\boldsymbol{\\rho}$ 是单元密度向量，$\\mathbf{U}$ 是全局位移向量，$\\mathbf{F}$ 是全局力向量，$\\mathbf{K}$ 是全局刚度矩阵，$v_i$ 是单元 $i$ 的体积，$V^{\\star}$ 是允许的最大总材料体积。向量 $\\boldsymbol{\\rho}_{\\min}$ 和 $\\boldsymbol{\\rho}_{\\max}$ 分别包含密度的下界和上界。\n\n该问题的拉格朗日函数，仅考虑体积约束，为：\n$$\n\\mathcal{L}(\\boldsymbol{\\rho}, \\lambda) = C(\\boldsymbol{\\rho}) + \\lambda \\left( \\sum_{i=1}^{N} v_i \\rho_i - V^{\\star} \\right)\n$$\n其中 $\\lambda \\ge 0$ 是体积约束的拉格朗日乘子。Karush-Kuhn-Tucker (KKT) 最优性条件指出，在最优解 $\\boldsymbol{\\rho}^*$ 处：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\rho_i} = \\frac{\\partial C}{\\partial \\rho_i} + \\lambda v_i = 0\n$$\n对于所有未处于边界的设计变量 $\\rho_i$ 成立。这可以重新排列以定义灵敏度数 $B_i$：\n$$\nB_i \\equiv -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i} = \\lambda\n$$\n此条件意味着，在最优状态下，对于所有未处于其上下界的单元，单位材料体积的柔度变化是恒定的。OC 方法是一个迭代过程，旨在驱动设计变量满足此条件。\n\n直接求解这个系统是困难的，因为灵敏度 $\\frac{\\partial C}{\\partial \\rho_i}$ 是所有 $\\rho_j$ 的复杂非线性函数。因此，我们在每次迭代 $k$ 时，基于目标函数的近似来构建一个子问题。问题指定使用柔度的经典倒数近似。这涉及在当前设计点 $\\boldsymbol{\\rho}^k$ 周围，对柔度 $C$ 关于倒数变量 $x_i = 1/\\rho_i$进行一阶泰勒级数展开：\n$$\nC(\\boldsymbol{x}) \\approx \\tilde{C}(\\boldsymbol{x}) = C(\\boldsymbol{x}^k) + \\sum_{i=1}^N \\frac{\\partial C}{\\partial x_i}\\bigg|_{\\boldsymbol{x}^k} (x_i - x_i^k)\n$$\n使用链式法则，$\\frac{\\partial C}{\\partial x_i} = \\frac{\\partial C}{\\partial \\rho_i} \\frac{d\\rho_i}{dx_i} = \\frac{\\partial C}{\\partial \\rho_i} (-\\rho_i^2)$。将此代入展开式并换回 $\\rho_i$ 变量，我们得到：\n$$\n\\tilde{C}(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}^k) + \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\left( \\frac{1}{\\rho_i} - \\frac{1}{\\rho_i^k} \\right)\n$$\n迭代 $k+1$ 的优化子问题是在体积约束有效（即 $\\sum_i v_i \\rho_i = V^{\\star}$）的条件下，最小化此近似柔度 $\\tilde{C}(\\boldsymbol{\\rho})$。\n省略常数项，子问题为：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\frac{1}{\\rho_i} \\\\\n\\text{subject to} \\quad  \\sum_{i=1}^N v_i \\rho_i - V^{\\star} = 0\n\\end{aligned}\n$$\n此子问题的拉格朗日函数为：\n$$\n\\mathcal{L}_{\\text{sub}}(\\boldsymbol{\\rho}, \\lambda) = \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\frac{1}{\\rho_i} + \\lambda \\left(\\sum_{i=1}^N v_i \\rho_i - V^{\\star}\\right)\n$$\n此子问题的 KKT 条件是 $\\frac{\\partial \\mathcal{L}_{\\text{sub}}}{\\partial \\rho_i} = 0$：\n$$\n\\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\left(-\\frac{1}{\\rho_i^2}\\right) + \\lambda v_i = 0\n$$\n$$\n\\frac{(\\rho_i^k)^2}{\\rho_i^2} \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} + \\lambda v_i = 0 \\implies \\frac{(\\rho_i^k)^2}{\\rho_i^2} \\left( -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) = \\lambda\n$$\n代入灵敏度数 $B_i^k = -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i}\\big|_{\\boldsymbol{\\rho}^k}$，我们得到：\n$$\nB_i^k \\frac{(\\rho_i^k)^2}{\\rho_i^2} = \\lambda\n$$\n求解新的密度 $\\rho_i^{k+1}$ 得到 OC 更新公式：\n$$\n\\rho_i^{k+1} = \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\n$$\n这就是推导出的 OC 更新公式。现在，我们将其应用于具体的问题数据。\n\n给定的数据是：\n- 当前密度：$\\boldsymbol{\\rho}^{k} = [\\,0.7,\\,0.4,\\,0.3,\\,0.6\\,]$\n- 柔度灵敏度：$\\frac{\\partial \\mathbf{C}}{\\partial \\boldsymbol{\\rho}}\\big|_{\\boldsymbol{\\rho}^k} = [\\,-4.0,\\,-0.5,\\,-0.2,\\,-3.0\\,]$\n- 单元体积：$v_i = 1$ for $i \\in \\{1, 2, 3, 4\\}$\n- 目标体积：$V^{\\star} = v_f^{\\star} \\times N = 0.5 \\times 4 = 2.0$\n- 移动限制：$m = 0.1$\n- 密度边界：$\\rho_{\\min} = 0.001$, $\\rho_{\\max} = 1$\n\n首先，计算灵敏度数 $B_i^k$：\n$$\nB_i^k = -\\frac{1}{v_i}\\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} = -\\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k}\n$$\n$B_1^k = -(-4.0) = 4.0$\n$B_2^k = -(-0.5) = 0.5$\n$B_3^k = -(-0.2) = 0.2$\n$B_4^k = -(-3.0) = 3.0$\n\n原始更新值，记为 $\\rho_i^{\\text{new}}$，是：\n$$\n\\rho_i^{\\text{new}} = \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\n$$\n此更新必须受到移动限制和物理边界的约束。对于每个单元，新的密度 $\\rho_i^{k+1}$ 必须位于 $[\\rho_i^{\\text{lower}}, \\rho_i^{\\text{upper}}]$ 区间内，其中：\n$\\rho_i^{\\text{lower}} = \\max(\\rho_i^k - m, \\rho_{\\min})$\n$\\rho_i^{\\text{upper}} = \\min(\\rho_i^k + m, \\rho_{\\max})$\n\n计算每个单元的这些边界：\n- $\\rho_1$: $[\\max(0.7-0.1, 0.001), \\min(0.7+0.1, 1)] = [\\max(0.6, 0.001), \\min(0.8, 1)] = [0.6, 0.8]$\n- $\\rho_2$: $[\\max(0.4-0.1, 0.001), \\min(0.4+0.1, 1)] = [\\max(0.3, 0.001), \\min(0.5, 1)] = [0.3, 0.5]$\n- $\\rho_3$: $[\\max(0.3-0.1, 0.001), \\min(0.3+0.1, 1)] = [\\max(0.2, 0.001), \\min(0.4, 1)] = [0.2, 0.4]$\n- $\\rho_4$: $[\\max(0.6-0.1, 0.001), \\min(0.6+0.1, 1)] = [\\max(0.5, 0.001), \\min(0.7, 1)] = [0.5, 0.7]$\n\n完整的更新规则是：\n$$\n\\rho_i^{k+1}(\\lambda) = \\max\\left(\\rho_i^{\\text{lower}}, \\min\\left(\\rho_i^{\\text{upper}}, \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\\right)\\right)\n$$\n必须确定拉格朗日乘子 $\\lambda$，以使体积约束得到满足：\n$$\n\\sum_{i=1}^4 v_i \\rho_i^{k+1}(\\lambda) = \\sum_{i=1}^4 \\rho_i^{k+1}(\\lambda) = V^{\\star} = 2.0\n$$\n这是一个关于 $\\lambda$ 的非线性方程，通常使用数值求根方法（如二分法）求解。总体积是 $\\lambda$ 的单调递减函数。\n\n让我们测试一个 $\\lambda$ 的值。一个常见的初始猜测可以基于平均灵敏度，但在这里，考虑到问题的离散性，我们可以分析条件。让我们做一个有根据的猜测，设 $\\lambda=1.0$。\n我们计算当 $\\lambda=1.0$ 时的原始更新值 $\\rho_i^{\\text{new}}$：\n- $\\rho_1^{\\text{new}} = 0.7 \\sqrt{4.0 / 1.0} = 0.7 \\times 2.0 = 1.4$\n- $\\rho_2^{\\text{new}} = 0.4 \\sqrt{0.5 / 1.0} \\approx 0.4 \\times 0.7071 = 0.2828$\n- $\\rho_3^{\\text{new}} = 0.3 \\sqrt{0.2 / 1.0} \\approx 0.3 \\times 0.4472 = 0.1342$\n- $\\rho_4^{\\text{new}} = 0.6 \\sqrt{3.0 / 1.0} \\approx 0.6 \\times 1.7321 = 1.0392$\n\n现在，我们应用当前迭代的上下界：\n- $\\rho_1^{k+1}$: $\\rho_1^{\\text{new}} = 1.4 > \\rho_1^{\\text{upper}} = 0.8$。所以，$\\rho_1^{k+1} = 0.8$。\n- $\\rho_2^{k+1}$: $\\rho_2^{\\text{new}} = 0.2828  \\rho_2^{\\text{lower}} = 0.3$。所以，$\\rho_2^{k+1} = 0.3$。\n- $\\rho_3^{k+1}$: $\\rho_3^{\\text{new}} = 0.1342  \\rho_3^{\\text{lower}} = 0.2$。所以，$\\rho_3^{k+1} = 0.2$。\n- $\\rho_4^{k+1}$: $\\rho_4^{\\text{new}} = 1.0392 > \\rho_4^{\\text{upper}} = 0.7$。所以，$\\rho_4^{k+1} = 0.7$。\n\n当选择 $\\lambda=1.0$ 时，所有单元的密度都饱和于其各自的移动限制边界。我们检查使用这些更新后的密度是否满足体积约束：\n$$\nV^{k+1} = \\sum_{i=1}^4 \\rho_i^{k+1} = 0.8 + 0.3 + 0.2 + 0.7 = 2.0\n$$\n这恰好是目标体积 $V^{\\star}$。由于体积函数是单调的，这个 $\\lambda$ 的解是唯一的。因此，拉格朗日乘子是 $\\lambda = 1.0$，计算出的密度是此次迭代的最终更新密度。\n\n按要求四舍五入到四位有效数字，更新后的密度为：\n$\\rho_1^{k+1} = 0.8000$\n$\\rho_2^{k+1} = 0.3000$\n$\\rho_3^{k+1} = 0.2000$\n$\\rho_4^{k+1} = 0.7000$\n\n最终更新的密度向量是 $\\boldsymbol{\\rho}^{k+1} = [\\,0.8000,\\,0.3000,\\,0.2000,\\,0.7000\\,]$。\n这个结果符合物理直觉：单元 1 和 4 具有最负的柔度灵敏度（即单位密度对刚度的贡献最大），因此它们的密度增加了。单元 2 和 3 的灵敏度较低，它们的密度降低以满足体积约束。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000  0.3000  0.2000  0.7000\n\\end{pmatrix}\n}\n$$", "id": "3607239"}, {"introduction": "基础的拓扑优化有时会产生带有不良特征的设计，例如“棋盘格”模式或难以制造的中间密度区域。本练习介绍了正则化的概念，这是一种用于确保结果更平滑、更实用的技术。您将计算一个全变分惩罚项的梯度，亲身体验它如何修改优化方向，以抑制相邻单元之间的密度急剧变化 [@problem_id:3607259]。", "problem": "在拓扑优化中使用的一维杆采用固体各向同性材料惩罚法 (SIMP) 进行建模。设计场是单元密度向量 $\\boldsymbol{\\rho} = (\\rho_{1}, \\rho_{2}, \\dots, \\rho_{N})$，其中 $0 \\le \\rho_{i} \\le 1$。为抑制振荡设计，柔度目标函数中增加了一个平滑全变分项。对于一维均匀网格，平滑全变分泛函离散化为\n$$\nR_{\\varepsilon}(\\boldsymbol{\\rho}) = \\sum_{i=1}^{N-1} \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}},\n$$\n其中 $\\varepsilon > 0$ 是一个可微性参数。增广目标函数为 $J(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}) + \\beta \\, R_{\\varepsilon}(\\boldsymbol{\\rho})$，其中 $C(\\boldsymbol{\\rho})$ 是柔度，$\\beta > 0$ 是一个惩罚权重。\n\n从 $R_{\\varepsilon}(\\boldsymbol{\\rho})$ 的定义出发，利用基本原理（$\\partial \\rho/\\partial x$ 的有限差分建模、链式法则以及一次变分的线性性），推导内部索引 $i \\in \\{2, \\dots, N-1\\}$ 处的偏导数 $\\partial R_{\\varepsilon}/\\partial \\rho_{i}$ 关于相邻密度 $\\rho_{i-1}$、$\\rho_{i}$、$\\rho_{i+1}$ 和参数 $\\varepsilon$ 的表达式。然后，对于一个特定的内部单元 $i$，计算仅由正则化引起的梯度增量，\n$$\n\\Delta g_{i} \\equiv \\beta \\, \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}},\n$$\n已知数据如下\n- $\\rho_{i-1} = 0.15$，$\\rho_{i} = 0.40$，$\\rho_{i+1} = 0.55$，\n- $\\varepsilon = 0.05$，\n- $\\beta = 2.0$。\n\n将您的 $\\Delta g_{i}$ 答案四舍五入到四位有效数字。以焦耳为单位表示最终值。", "solution": "该问题要求推导平滑全变分泛函的偏导数，然后进行数值计算。该过程分为两部分：符号推导和数值计算。\n\n平滑全变分泛函 $R_{\\varepsilon}(\\boldsymbol{\\rho})$ 由一维网格上各单元的求和给出：\n$$\nR_{\\varepsilon}(\\boldsymbol{\\rho}) = \\sum_{j=1}^{N-1} \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}}\n$$\n该表达式表示连续泛函 $\\int \\sqrt{(\\frac{\\partial \\rho}{\\partial x})^2 + \\varepsilon^2} dx$ 的有限差分离散，其中差分 $\\rho_{j+1} - \\rho_{j}$ 近似了空间导数 $\\frac{\\partial \\rho}{\\partial x}$。\n\n我们需要求解内部索引 $i$（其中 $i \\in \\{2, \\dots, N-1\\}$）处的偏导数 $\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$。由于微分算子是线性的，我们可以对求和进行逐项求导：\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sum_{j=1}^{N-1} \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}} \\right) = \\sum_{j=1}^{N-1} \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}} \\right)\n$$\n对于一个内部索引 $i$，设计变量 $\\rho_i$ 只出现在求和式中的两项里：$j=i-1$ 的项和 $j=i$ 的项。所有其他项关于 $\\rho_i$ 的偏导数都为零。这两个相关项是 $j=i-1$ 和 $j=i$。所有其他项关于 $\\rho_i$ 的导数均为零。\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}} \\right) + \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}} \\right)\n$$\n使用链式法则分别对这两项求导：\n$$\n\\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}} \\right) = \\frac{2(\\rho_{i} - \\rho_{i-1})}{2\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}}} = \\frac{\\rho_{i} - \\rho_{i-1}}{\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}}}\n$$\n$$\n\\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}} \\right) = \\frac{2(\\rho_{i+1} - \\rho_{i})(-1)}{2\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}} = -\\frac{\\rho_{i+1} - \\rho_{i}}{\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}}\n$$\n将这两项结合起来，得到内部索引 $i$ 的偏导数的最终表达式：\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\rho_{i} - \\rho_{i-1}}{\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}}} - \\frac{\\rho_{i+1} - \\rho_{i}}{\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}}\n$$\n现在，我们使用给定的数值来计算梯度增量 $\\Delta g_i = \\beta \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$。\n已知数据：\n- $\\rho_{i-1} = 0.15$\n- $\\rho_{i} = 0.40$\n- $\\rho_{i+1} = 0.55$\n- $\\varepsilon = 0.05$\n- $\\beta = 2.0$\n\n首先，计算两个差值：\n- $\\rho_i - \\rho_{i-1} = 0.40 - 0.15 = 0.25$\n- $\\rho_{i+1} - \\rho_i = 0.55 - 0.40 = 0.15$\n\n接下来，计算两个分母（平方根项）：\n- $\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}} = \\sqrt{(0.25)^{2} + (0.05)^{2}} = \\sqrt{0.0625 + 0.0025} = \\sqrt{0.065}$\n- $\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}} = \\sqrt{(0.15)^{2} + (0.05)^{2}} = \\sqrt{0.0225 + 0.0025} = \\sqrt{0.025}$\n\n现在计算偏导数。为了获得更高的精度，我们避免中间步骤的四舍五入：\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{0.25}{\\sqrt{0.065}} - \\frac{0.15}{\\sqrt{0.025}} \\approx 0.98058067 - 0.94868329 = 0.03189738\n$$\n最后，计算梯度增量 $\\Delta g_i$：\n$$\n\\Delta g_i = \\beta \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} \\approx 2.0 \\times 0.03189738 = 0.06379476\n$$\n四舍五入到四位有效数字，我们得到 $0.06379$。", "answer": "$$\\boxed{0.06379}$$", "id": "3607259"}]}