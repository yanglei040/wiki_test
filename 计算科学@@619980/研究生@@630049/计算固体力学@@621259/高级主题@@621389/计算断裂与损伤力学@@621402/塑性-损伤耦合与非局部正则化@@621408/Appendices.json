{"hands_on_practices": [{"introduction": "这个首个练习旨在建立对非局部正则化工作原理的基础理解。通过为一个简单、给定的塑性应变场求解亥姆霍兹方程，您将分析推导出非局部滤波器产生的平滑效应。理解这一效应对于后续掌握如何抑制病态应变局部化至关重要。[@problem_id:3589075]", "problem": "考虑一根长度为 $L$ 的一维（1D）棱柱杆，在小应变运动学下占据空间区间 $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$，其中轴向应变由轴向位移 $u(x)$ 给出，即 $\\varepsilon(x) = \\frac{du}{dx}$。假设由于中心位于 $x = 0$ 处的薄弱截面，塑性在一个半宽度为 $a$ 的对称区间内发展，使得局部等效塑性应变 $q(x)$ 是一个帽形函数，\n$$\nq(x) = \\begin{cases}\n\\varepsilon_{0}, & |x| \\leq a, \\\\\n0, & a  |x| \\leq \\frac{L}{2},\n\\end{cases}\n$$\n其参数为 $L > 0$，$0  a  \\frac{L}{2}$ 和 $\\varepsilon_{0} > 0$。为了对损伤驱动的局部化进行正则化，采用亥姆霍兹型非局部正则化处理等效塑性应变，该正则化由滤波场 $\\bar{q}(x)$ 定义，$\\bar{q}(x)$ 是一个带有内禀长度尺度 $\\ell > 0$ 的二阶微分算子的解。非局部等效塑性应变 $\\bar{q}(x)$ 通过最小化一个由梯度罚项增强的二次自由能泛函来定义，并受制于 $x = \\pm \\frac{L}{2}$ 处的自然无通量边界条件。\n\n损伤遵循一个由非局部等效塑性应变驱动的标准各向同性连续介质损伤力学（CDM）指数演化法则，\n$$\nd(x) = 1 - \\exp\\left(-\\frac{\\bar{q}(x)}{\\varepsilon_{f}}\\right),\n$$\n其中 $\\varepsilon_{f} > 0$ 是一个材料参数。\n\n从非局部滤波器的变分定义和相关的欧拉-拉格朗日条件出发，推导当前一维设定下 $\\bar{q}(x)$ 的控制常微分方程和边界条件。利用关于 $x = 0$ 的对称性，求解 $\\bar{q}(x)$，并确定杆中心 $x = 0$ 处的损伤值。将 $d(0)$ 的最终答案表示为包含 $L$、$a$、$\\ell$、$\\varepsilon_{0}$ 和 $\\varepsilon_{f}$ 的单个闭式解析表达式。最终答案是无量纲的，必须精确给出；不要进行任何数值取整。", "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于连续介质损伤力学和非局部正则化的原理，是适定的、客观的。它提出了一个计算固体力学中标准的、可解的问题。\n\n非局部等效塑性应变 $\\bar{q}(x)$ 定义为一个由梯度罚项增强的二次泛函的最小化子。对于一维域 $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$，该泛函 $\\mathcal{F}(\\bar{q})$ 由下式给出：\n$$\n\\mathcal{F}(\\bar{q}) = \\frac{1}{2} \\int_{-L/2}^{L/2} \\left[ (\\bar{q}(x) - q(x))^2 + \\ell^2 \\left(\\frac{d\\bar{q}}{dx}\\right)^2 \\right] dx\n$$\n提供驻值条件 $\\delta\\mathcal{F} = 0$ 的欧拉-拉格朗日方程是通过计算 $\\mathcal{F}$ 相对于 $\\bar{q}(x)$ 的一次变分推导出来的。变分为：\n$$\n\\delta\\mathcal{F} = \\int_{-L/2}^{L/2} \\left[ (\\bar{q} - q) \\delta\\bar{q} + \\ell^2 \\frac{d\\bar{q}}{dx} \\frac{d(\\delta\\bar{q})}{dx} \\right] dx = 0\n$$\n对第二项进行分部积分得到：\n$$\n\\int_{-L/2}^{L/2} \\ell^2 \\frac{d\\bar{q}}{dx} \\frac{d(\\delta\\bar{q})}{dx} dx = \\left[ \\ell^2 \\frac{d\\bar{q}}{dx} \\delta\\bar{q} \\right]_{-L/2}^{L/2} - \\int_{-L/2}^{L/2} \\ell^2 \\frac{d^2\\bar{q}}{dx^2} \\delta\\bar{q} \\, dx\n$$\n问题指定了自然无通量边界条件，$\\frac{d\\bar{q}}{dx}\\left(\\pm\\frac{L}{2}\\right) = 0$。这些条件使得边界项 $\\left[ \\ell^2 \\frac{d\\bar{q}}{dx} \\delta\\bar{q} \\right]_{-L/2}^{L/2}$ 为零。变分陈述简化为：\n$$\n\\int_{-L/2}^{L/2} \\left[ (\\bar{q} - q) - \\ell^2 \\frac{d^2\\bar{q}}{dx^2} \\right] \\delta\\bar{q} \\, dx = 0\n$$\n为了使该积分对于任意变分 $\\delta\\bar{q}$ 都为零，方括号中的项必须为零。这给出了控制亥姆霍兹常微分方程（ODE）：\n$$\n\\bar{q}(x) - \\ell^2 \\frac{d^2\\bar{q}}{dx^2} = q(x)\n$$\n整理成标准形式，我们得到：\n$$\n\\frac{d^2\\bar{q}}{dx^2} - \\frac{1}{\\ell^2}\\bar{q}(x) = -\\frac{1}{\\ell^2}q(x)\n$$\n域、局部场 $q(x)$ 以及边界条件都关于 $x=0$ 对称。因此，解 $\\bar{q}(x)$ 也必须是一个偶函数，即 $\\bar{q}(x) = \\bar{q}(-x)$。可微偶函数的一个性质是它们在对称中心的导数为零，因此 $\\frac{d\\bar{q}}{dx}(0) = 0$。因此，我们可以在半域 $x \\in \\left[0, \\frac{L}{2}\\right]$ 上求解该问题，边界条件为 $\\frac{d\\bar{q}}{dx}(0) = 0$ 和 $\\frac{d\\bar{q}}{dx}\\left(\\frac{L}{2}\\right) = 0$。\n\n该问题在半域上的两个区域内分段求解。\n区域 1：$x \\in [0, a]$，其中 $q(x) = \\varepsilon_{0}$。常微分方程为：\n$$\n\\frac{d^2\\bar{q}_1}{dx^2} - \\frac{1}{\\ell^2}\\bar{q}_1(x) = -\\frac{\\varepsilon_{0}}{\\ell^2}\n$$\n通解是特解 $\\bar{q}_{p} = \\varepsilon_0$ 和齐次解之和。因此，$\\bar{q}_1(x) = \\varepsilon_{0} + C_1 \\cosh\\left(\\frac{x}{\\ell}\\right) + C_2 \\sinh\\left(\\frac{x}{\\ell}\\right)$。应用对称条件 $\\frac{d\\bar{q}_1}{dx}(0) = 0$：\n$$\n\\frac{d\\bar{q}_1}{dx} = \\frac{C_1}{\\ell}\\sinh\\left(\\frac{x}{\\ell}\\right) + \\frac{C_2}{\\ell}\\cosh\\left(\\frac{x}{\\ell}\\right) \\implies \\frac{d\\bar{q}_1}{dx}(0) = \\frac{C_2}{\\ell} = 0 \\implies C_2=0\n$$\n因此，区域 1 中的解为 $\\bar{q}_1(x) = \\varepsilon_{0} + C_1 \\cosh\\left(\\frac{x}{\\ell}\\right)$。\n\n区域 2：$x \\in \\left(a, \\frac{L}{2}\\right]$，其中 $q(x) = 0$。常微分方程是齐次的：\n$$\n\\frac{d^2\\bar{q}_2}{dx^2} - \\frac{1}{\\ell^2}\\bar{q}_2(x) = 0\n$$\n通解为 $\\bar{q}_2(x) = C_3 \\cosh\\left(\\frac{x}{\\ell}\\right) + C_4 \\sinh\\left(\\frac{x}{\\ell}\\right)$。\n\n常数 $C_1$、$C_3$ 和 $C_4$ 由 $x=\\frac{L}{2}$ 处的边界条件和 $x=a$ 处的连续性条件确定。\n1.  $x=\\frac{L}{2}$ 处的边界条件：$\\frac{d\\bar{q}_2}{dx}\\left(\\frac{L}{2}\\right) = 0$。\n    $\\frac{C_3}{\\ell}\\sinh\\left(\\frac{L}{2\\ell}\\right) + \\frac{C_4}{\\ell}\\cosh\\left(\\frac{L}{2\\ell}\\right) = 0 \\implies C_4 = -C_3 \\tanh\\left(\\frac{L}{2\\ell}\\right)$。\n2.  $\\bar{q}$ 在 $x=a$ 处的连续性：$\\bar{q}_1(a) = \\bar{q}_2(a)$。\n    $\\varepsilon_0 + C_1 \\cosh\\left(\\frac{a}{\\ell}\\right) = C_3 \\cosh\\left(\\frac{a}{\\ell}\\right) + C_4 \\sinh\\left(\\frac{a}{\\ell}\\right)$。\n3.  $\\frac{d\\bar{q}}{dx}$ 在 $x=a$ 处的连续性：$\\frac{d\\bar{q}_1}{dx}(a) = \\frac{d\\bar{q}_2}{dx}(a)$。\n    $\\frac{C_1}{\\ell}\\sinh\\left(\\frac{a}{\\ell}\\right) = \\frac{C_3}{\\ell}\\sinh\\left(\\frac{a}{\\ell}\\right) + \\frac{C_4}{\\ell}\\cosh\\left(\\frac{a}{\\ell}\\right)$。\n\n将 (1) 中的 $C_4$ 代入 (3)：\n$C_1\\sinh\\left(\\frac{a}{\\ell}\\right) = C_3\\sinh\\left(\\frac{a}{\\ell}\\right) - C_3 \\tanh\\left(\\frac{L}{2\\ell}\\right)\\cosh\\left(\\frac{a}{\\ell}\\right) = C_3 \\frac{\\sinh\\left(\\frac{a}{\\ell}\\right)\\cosh\\left(\\frac{L}{2\\ell}\\right) - \\cosh\\left(\\frac{a}{\\ell}\\right)\\sinh\\left(\\frac{L}{2\\ell}\\right)}{\\cosh\\left(\\frac{L}{2\\ell}\\right)}$。\n使用 $\\sinh(A-B)$ 的恒等式，我们得到 $C_1\\sinh\\left(\\frac{a}{\\ell}\\right) = -C_3 \\frac{\\sinh\\left(\\frac{L}{2\\ell} - \\frac{a}{\\ell}\\right)}{\\cosh\\left(\\frac{L}{2\\ell}\\right)}$。\n\n我们尝试另一条代换路径。从(2)和(3)可得：\n$C_3-C_1 = \\frac{C_4 \\sinh(a/\\ell) - \\varepsilon_0}{\\cosh(a/\\ell)}$ 且 $C_3-C_1 = \\frac{C_4 \\cosh(a/\\ell)}{\\sinh(a/\\ell)}$。\n这并不更简单。回到原来正确的代换路径。\n从 (2) 可得，$\\varepsilon_0 = (C_3-C_1)\\cosh\\left(\\frac{a}{\\ell}\\right) + C_4\\sinh\\left(\\frac{a}{\\ell}\\right)$。\n从 (3) 可得，$0 = (C_3-C_1)\\sinh\\left(\\frac{a}{\\ell}\\right) + C_4\\cosh\\left(\\frac{a}{\\ell}\\right)$。\n从第二个方程，我们得到 $C_3-C_1 = -C_4 \\coth\\left(\\frac{a}{\\ell}\\right)$。\n代入第一个方程：$\\varepsilon_0 = -C_4 \\coth\\left(\\frac{a}{\\ell}\\right)\\cosh\\left(\\frac{a}{\\ell}\\right) + C_4\\sinh\\left(\\frac{a}{\\ell}\\right) = -C_4 \\left( \\frac{\\cosh^2(a/\\ell)}{\\sinh(a/\\ell)} - \\sinh(a/\\ell) \\right) = -C_4 \\frac{\\cosh^2(a/\\ell) - \\sinh^2(a/\\ell)}{\\sinh(a/\\ell)} = -\\frac{C_4}{\\sinh(a/\\ell)}$。\n所以 $C_4 = -\\varepsilon_0 \\sinh(a/\\ell)$。\n从 $C_3-C_1 = -C_4 \\coth(a/\\ell)$，我们得到 $C_3-C_1 = \\varepsilon_0 \\sinh(a/\\ell) \\frac{\\cosh(a/\\ell)}{\\sinh(a/\\ell)} = \\varepsilon_0 \\cosh(a/\\ell)$。\n从 (1) 可得，$C_3 \\sinh\\left(\\frac{L}{2\\ell}\\right) = -C_4 \\cosh\\left(\\frac{L}{2\\ell}\\right) = \\varepsilon_0 \\sinh(a/\\ell) \\cosh\\left(\\frac{L}{2\\ell}\\right)$。\n$C_3 = \\varepsilon_0 \\frac{\\sinh(a/\\ell) \\cosh(L/2\\ell)}{\\sinh(L/2\\ell)}$。\n然后 $C_1 = C_3 - \\varepsilon_0 \\cosh(a/\\ell) = \\varepsilon_0 \\frac{\\sinh(a/\\ell) \\cosh(L/2\\ell)}{\\sinh(L/2\\ell)} - \\varepsilon_0 \\cosh(a/\\ell)$。\n$C_1 = \\varepsilon_0 \\frac{\\sinh(a/\\ell)\\cosh(L/2\\ell) - \\cosh(a/\\ell)\\sinh(L/2\\ell)}{\\sinh(L/2\\ell)} = -\\varepsilon_0 \\frac{\\sinh(L/2\\ell - a/\\ell)}{\\sinh(L/2\\ell)}$。\n这证实了之前对 $C_1$ 的结果。\n\n在中心 $x=0$ 处的非局部等效塑性应变值为：\n$$\n\\bar{q}(0) = \\bar{q}_1(0) = \\varepsilon_{0} + C_1 \\cosh(0) = \\varepsilon_{0} + C_1\n$$\n代入推导出的 $C_1$ 表达式：\n$$\n\\bar{q}(0) = \\varepsilon_{0} - \\varepsilon_{0} \\frac{\\sinh\\left(\\frac{L}{2\\ell} - \\frac{a}{\\ell}\\right)}{\\sinh\\left(\\frac{L}{2\\ell}\\right)} = \\varepsilon_{0} \\left[ 1 - \\frac{\\sinh\\left(\\frac{L-2a}{2\\ell}\\right)}{\\sinh\\left(\\frac{L}{2\\ell}\\right)} \\right]\n$$\n最后，杆中心处的损伤 $d(0)$ 由指数演化法则给出：\n$$\nd(x) = 1 - \\exp\\left(-\\frac{\\bar{q}(x)}{\\varepsilon_{f}}\\right)\n$$\n代入 $\\bar{q}(0)$ 的表达式：\n$$\nd(0) = 1 - \\exp\\left( -\\frac{\\varepsilon_0}{\\varepsilon_f} \\left[ 1 - \\frac{\\sinh\\left(\\frac{L-2a}{2\\ell}\\right)}{\\sinh\\left(\\frac{L}{2\\ell}\\right)} \\right] \\right)\n$$\n这就是杆中心处损伤的最终闭式解析表达式。", "answer": "$$\n\\boxed{1 - \\exp\\left(-\\frac{\\varepsilon_0}{\\varepsilon_f} \\left(1 - \\frac{\\sinh\\left(\\frac{L-2a}{2\\ell}\\right)}{\\sinh\\left(\\frac{L}{2\\ell}\\right)}\\right)\\right)}\n$$", "id": "3589075"}, {"introduction": "在基本概念之上，本实践将探索非局部场与组件物理边界之间的相互作用。您将分析一个线性变化的塑性应变案例，推导零通量边界条件如何影响正则化场，并进而影响材料在边缘处的屈服行为。这项练习有助于深化对非局部模型在有限域内表现的理解。[@problem_id:3589054]", "problem": "考虑一根占据区间 $x \\in [0,L]$ 的一维杆，承受单调加载，产生一个空间变化的等效塑性应变场 $\\,\\kappa(x)\\,$。为了正则化损伤驱动变量并减轻病态的网格敏感性，采用广泛使用的亥姆霍兹型非局部正则化方法，该方法通过线性二阶偏微分方程（PDE）定义了一个非局部内变量 $\\,\\bar{\\kappa}(x)\\,$\n$$\n\\bar{\\kappa}(x) - \\ell^{2} \\frac{d^{2}\\bar{\\kappa}}{dx^{2}}(x) = \\kappa(x)\\quad \\text{for}\\; x \\in (0,L),\n$$\n边界条件为齐次诺伊曼边界条件\n$$\n\\frac{d\\bar{\\kappa}}{dx}(0) = 0,\\qquad \\frac{d\\bar{\\kappa}}{dx}(L) = 0,\n$$\n这在梯度增强的表述中表示边界上的微牵引力（或微通量）为零。假设一个物理上一致的线性源场\n$$\n\\kappa(x) = \\varepsilon_{0} + g\\,x,\n$$\n其中 $\\varepsilon_{0} > 0$ 是基准等效塑性应变，$g$ 是一个恒定的塑性应变梯度。设标量各向同性损伤变量定义为\n$$\nd(x) = 1 - \\exp\\!\\big(-\\beta\\,\\bar{\\kappa}(x)\\big),\n$$\n其中 $\\beta > 0$ 是一个损伤敏感性参数，因此损伤-塑性耦合根据以下公式降低屈服应力\n$$\n\\sigma_{y}(x) = \\big(1 - d(x)\\big)\\,\\sigma_{y0} = \\exp\\!\\big(-\\beta\\,\\bar{\\kappa}(x)\\big)\\,\\sigma_{y0},\n$$\n其中 $\\sigma_{y0} > 0$ 是未损伤时的屈服应力。从这些基础出发，并施加边界条件，推导边界屈服应力比\n$$\n\\frac{\\sigma_{y}(0)}{\\sigma_{y0}}\n$$\n的闭式表达式，该表达式用参数 $L$、$\\ell$、$\\varepsilon_{0}$、$g$ 和 $\\beta$ 表示。你的最终答案必须是一个单一的闭式解析表达式。答案是无量纲的；不要包含单位。如果在推导过程中引入任何中间恒等式，必须从第一性原理出发对其进行充分论证。", "solution": "用户要求我解决一个计算固体力学问题，具体是找出一个边界屈服应力比的闭式表达式。我需要首先验证问题的完整性，如果问题有效，则提供一个严格的、分步的推导，并对所有数学实体遵循严格的 LaTeX 格式。\n\n### 第 1 步：提取已知条件\n- **控制偏微分方程：** $\\bar{\\kappa}(x) - \\ell^{2} \\frac{d^{2}\\bar{\\kappa}}{dx^{2}}(x) = \\kappa(x)$，对于 $x \\in (0,L)$。\n- **边界条件 (BCs)：** $\\frac{d\\bar{\\kappa}}{dx}(0) = 0$ 和 $\\frac{d\\bar{\\kappa}}{dx}(L) = 0$。\n- **源场：** $\\kappa(x) = \\varepsilon_{0} + g\\,x$，其中 $\\varepsilon_{0}  0$ 且 $g$ 为常数。\n- **损伤变量：** $d(x) = 1 - \\exp(-\\beta\\,\\bar{\\kappa}(x))$，其中 $\\beta  0$。\n- **屈服应力：** $\\sigma_{y}(x) = \\exp(-\\beta\\,\\bar{\\kappa}(x))\\,\\sigma_{y0}$，其中 $\\sigma_{y0}  0$。\n- **目标：** 推导比值 $\\frac{\\sigma_{y}(0)}{\\sigma_{y0}}$ 的表达式。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了一个标准的、简化的一维梯度增强损伤模型，这是计算力学中处理应变局部化的一种常用正则化技术。控制方程是亥姆霍兹型偏微分方程，源项是一个简单的线性函数，损伤法则是标准的指数形式。该问题是适定的，构成一个带有两个边界条件的线性二阶非齐次常微分方程，这保证了唯一解的存在。语言客观且数学上精确。所有参数都已定义，没有内部矛盾或信息缺失。该问题是应用数学和连续介质力学领域的一个有效练习。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将提供完整的推导过程。\n\n目标是求出比值 $\\frac{\\sigma_{y}(0)}{\\sigma_{y0}}$。根据给定的屈服应力退化关系，该比值为：\n$$\n\\frac{\\sigma_{y}(0)}{\\sigma_{y0}} = \\exp(-\\beta\\,\\bar{\\kappa}(0))\n$$\n为了确定这个值，我们必须首先求解控制边值问题的解 $\\bar{\\kappa}(x)$，然后在 $x=0$ 处对其求值。\n\n控制方程是一个线性非齐次二阶常微分方程（ODE）。我们可以将其重写为标准形式：\n$$\n\\frac{d^{2}\\bar{\\kappa}}{dx^{2}}(x) - \\frac{1}{\\ell^{2}}\\bar{\\kappa}(x) = -\\frac{1}{\\ell^{2}}\\kappa(x) = -\\frac{1}{\\ell^{2}}(\\varepsilon_{0} + g\\,x)\n$$\n通解 $\\bar{\\kappa}(x)$ 是齐次解 $\\bar{\\kappa}_{h}(x)$ 和一个特解 $\\bar{\\kappa}_{p}(x)$ 的和。\n\n**1. 齐次解**\n齐次常微分方程为：\n$$\n\\frac{d^{2}\\bar{\\kappa}_{h}}{dx^{2}} - \\frac{1}{\\ell^{2}}\\bar{\\kappa}_{h} = 0\n$$\n其特征方程为 $r^{2} - \\frac{1}{\\ell^{2}} = 0$，根为 $r = \\pm\\frac{1}{\\ell}$。通用的齐次解可以用双曲函数表示，这对于在有限域上应用边界条件很方便：\n$$\n\\bar{\\kappa}_{h}(x) = A \\cosh\\left(\\frac{x}{\\ell}\\right) + B \\sinh\\left(\\frac{x}{\\ell}\\right)\n$$\n其中 $A$ 和 $B$ 是待定常数。\n\n**2. 特解**\n源项（常微分方程的右侧）是关于 $x$ 的线性多项式。因此，我们可以使用待定系数法寻找一个具有相同形式的特解 $\\bar{\\kappa}_{p}(x)$：\n$$\n\\bar{\\kappa}_{p}(x) = C_{1}x + C_{0}\n$$\n其导数为 $\\frac{d\\bar{\\kappa}_{p}}{dx} = C_{1}$ 和 $\\frac{d^{2}\\bar{\\kappa}_{p}}{dx^{2}} = 0$。将它们代入非齐次常微分方程：\n$$\n0 - \\frac{1}{\\ell^{2}}(C_{1}x + C_{0}) = -\\frac{1}{\\ell^{2}}(\\varepsilon_{0} + g\\,x)\n$$\n两边乘以 $-\\ell^{2}$：\n$$\nC_{1}x + C_{0} = g\\,x + \\varepsilon_{0}\n$$\n通过比较 $x$ 各次幂的系数，我们得到 $C_{1} = g$ 和 $C_{0} = \\varepsilon_{0}$。因此，特解与局部场相同：\n$$\n\\bar{\\kappa}_{p}(x) = g\\,x + \\varepsilon_{0} = \\kappa(x)\n$$\n\n**3. 通解与边界条件的应用**\n通解为 $\\bar{\\kappa}(x) = \\bar{\\kappa}_{h}(x) + \\bar{\\kappa}_{p}(x)$：\n$$\n\\bar{\\kappa}(x) = A \\cosh\\left(\\frac{x}{\\ell}\\right) + B \\sinh\\left(\\frac{x}{\\ell}\\right) + \\varepsilon_{0} + g\\,x\n$$\n为了确定常数 $A$ 和 $B$，我们应用齐次诺伊曼边界条件。首先，我们求 $\\bar{\\kappa}(x)$ 的导数：\n$$\n\\frac{d\\bar{\\kappa}}{dx}(x) = \\frac{A}{\\ell} \\sinh\\left(\\frac{x}{\\ell}\\right) + \\frac{B}{\\ell} \\cosh\\left(\\frac{x}{\\ell}\\right) + g\n$$\n在 $x=0$ 处应用第一个边界条件：\n$$\n\\frac{d\\bar{\\kappa}}{dx}(0) = \\frac{A}{\\ell} \\sinh(0) + \\frac{B}{\\ell} \\cosh(0) + g = 0\n$$\n由于 $\\sinh(0)=0$ 且 $\\cosh(0)=1$，上式简化为：\n$$\n\\frac{B}{\\ell} + g = 0 \\implies B = -g\\ell\n$$\n在 $x=L$ 处应用第二个边界条件：\n$$\n\\frac{d\\bar{\\kappa}}{dx}(L) = \\frac{A}{\\ell} \\sinh\\left(\\frac{L}{\\ell}\\right) + \\frac{B}{\\ell} \\cosh\\left(\\frac{L}{\\ell}\\right) + g = 0\n$$\n代入 $B = -g\\ell$ 的值：\n$$\n\\frac{A}{\\ell} \\sinh\\left(\\frac{L}{\\ell}\\right) + \\frac{-g\\ell}{\\ell} \\cosh\\left(\\frac{L}{\\ell}\\right) + g = 0\n$$\n$$\n\\frac{A}{\\ell} \\sinh\\left(\\frac{L}{\\ell}\\right) = g \\cosh\\left(\\frac{L}{\\ell}\\right) - g = g \\left(\\cosh\\left(\\frac{L}{\\ell}\\right) - 1\\right)\n$$\n解出 $A$：\n$$\nA = g\\ell \\frac{\\cosh\\left(\\frac{L}{\\ell}\\right) - 1}{\\sinh\\left(\\frac{L}{\\ell}\\right)}\n$$\n这个 $A$ 的表达式可以使用双曲半角恒等式 $\\cosh(z) = 2\\cosh^{2}(\\frac{z}{2}) - 1$ 和 $\\sinh(z) = 2\\sinh(\\frac{z}{2})\\cosh(\\frac{z}{2})$ 来简化。分子变为 $\\cosh(\\frac{L}{\\ell}) - 1 = 2\\sinh^{2}(\\frac{L}{2\\ell})$。分母为 $\\sinh(\\frac{L}{\\ell}) = 2\\sinh(\\frac{L}{2\\ell})\\cosh(\\frac{L}{2\\ell})$。代入这些恒等式得到：\n$$\nA = g\\ell \\frac{2\\sinh^{2}\\left(\\frac{L}{2\\ell}\\right)}{2\\sinh\\left(\\frac{L}{2\\ell}\\right)\\cosh\\left(\\frac{L}{2\\ell}\\right)} = g\\ell \\frac{\\sinh\\left(\\frac{L}{2\\ell}\\right)}{\\cosh\\left(\\frac{L}{2\\ell}\\right)} = g\\ell \\tanh\\left(\\frac{L}{2\\ell}\\right)\n$$\n\n**4. 最终计算**\n我们需要求出 $\\bar{\\kappa}(0)$ 的值。使用通解：\n$$\n\\bar{\\kappa}(0) = A \\cosh(0) + B \\sinh(0) + \\varepsilon_{0} + g(0)\n$$\n上式简化为：\n$$\n\\bar{\\kappa}(0) = A(1) + B(0) + \\varepsilon_{0} = A + \\varepsilon_{0}\n$$\n代入推导出的 $A$ 的表达式：\n$$\n\\bar{\\kappa}(0) = \\varepsilon_{0} + g\\ell \\tanh\\left(\\frac{L}{2\\ell}\\right)\n$$\n最后，我们将此结果代入屈服应力比的表达式中：\n$$\n\\frac{\\sigma_{y}(0)}{\\sigma_{y0}} = \\exp(-\\beta\\,\\bar{\\kappa}(0)) = \\exp\\left(-\\beta \\left(\\varepsilon_{0} + g\\ell \\tanh\\left(\\frac{L}{2\\ell}\\right)\\right)\\right)\n$$\n这就是用给定参数表示的边界屈服应力比的闭式表达式。", "answer": "$$\n\\boxed{\\exp\\left(-\\beta \\left(\\varepsilon_{0} + g\\ell \\tanh\\left(\\frac{L}{2\\ell}\\right)\\right)\\right)}\n$$", "id": "3589054"}, {"introduction": "最后的这项实践将所有理论概念整合到一个完整的计算模型中。您将设计并实现一个算子分裂交错求解格式来解决耦合的塑性-损伤问题。通过这项练习，您将在离散化控制方程以及处理局部塑性更新与非局部损伤演化之间的相互作用方面，获得宝贵的实践经验。[@problem_id:3589093]", "problem": "考虑一根长度为 $L$ 的一维小应变杆，承受位移控制的单调加载，其边界位移给定为 $u(0)=0$ 和 $u(L)=U(t)$，其中 $t$ 表示参数化加载过程的伪时间。该杆具有均匀的横截面积和均匀的弹性模量 $E$。材料表现出率无关的一维塑性，伴有各向同性硬化，以及一个标量损伤变量 $d(x)\\in[0,1)$，该变量会同时降低刚度和屈服应力。通过一个 Helmholtz 型梯度损伤方程引入非局部正则化。目标是设计并实现一个算子分裂交错求解方案，该方案在一维网格上离散，在荷载增量步上交替更新塑性场和损伤场，并报告一组参数测试套件的特定响应量。\n\n从以下基本和核心定义开始：\n- 小应变运动学：轴向应变定义为 $\\varepsilon(x)=\\dfrac{du}{dx}$，并且在此问题的等应变（Voigt）假设下，应变被视为空间均匀的 $\\varepsilon(t)=\\dfrac{U(t)}{L}$。\n- Cauchy 应力定义为 $\\sigma(x)=E(1-d(x))\\left(\\varepsilon - \\varepsilon^{p}(x)\\right)$，其中 $\\varepsilon^{p}(x)$ 是塑性应变。\n- 伴有各向同性硬化的率无关一维塑性采用一个屈服函数 $f=\\lvert\\sigma\\rvert - \\sigma_{y}(d,\\alpha)$，其中累积塑性应变为 $\\alpha(x)$，损伤退化的屈服应力为 $\\sigma_{y}(d,\\alpha)=\\left(1-k_{d}\\,d\\right)\\left(\\sigma_{y0}+H\\,\\alpha\\right)$。此处，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是各向同性硬化模量，$k_{d}\\in[0,1]$ 是塑性-损伤耦合系数。\n- 在单调拉伸条件下，一维的相关联流动法则导致塑性应变增量 $d\\varepsilon^{p}=d\\lambda$，其中 $d\\lambda\\ge 0$ 是塑性乘子增量，累积塑性应变更新为 $d\\alpha=d\\lambda$。\n- Kuhn-Tucker 条件和一致性条件确保当 $f\\le 0$ 时为弹性响应，否则进行塑性修正以强制 $f=0$。\n- 损伤的非局部正则化被表述为一个 Helmholtz 方程 $(\\mathcal{I}-\\ell^{2}\\,\\Delta)\\, d = \\gamma(x)\\,Y$，带有齐次 Neumann 边界条件 $\\dfrac{dd}{dx}(0)=0$ 和 $\\dfrac{dd}{dx}(L)=0$。此处 $\\ell$ 是内禀长度（损伤正则化长度尺度），$\\Delta$ 是拉普拉斯算子，$\\gamma(x)$ 是一个空间非均匀性因子，$Y$ 是一个损伤驱动能量释放率的代理量，选择为弹性应变能密度 $Y=\\dfrac{1}{2}\\,E\\,(1-d)\\left(\\varepsilon-\\varepsilon^{p}\\right)^{2}$，该代理量使用最新的塑性更新和前一步的损伤进行评估，以在交错格式中保持右端项的线性。\n\n为每个荷载增量 $n\\to n+1$ 设计一个算子分裂和交错求解方案：\n- 塑性子问题（局部的，在 $x$ 上是逐点的）：将 $d$ 冻结在增量步 $n$ 的值上，计算试探应力 $\\sigma_{\\text{tr}}=E(1-d^{n})\\left(\\varepsilon^{n+1}-\\varepsilon^{p,n}\\right)$ 和单调拉伸的试探屈服函数 $f_{\\text{tr}}=\\sigma_{\\text{tr}}-\\left(1-k_{d}\\,d^{n}\\right)\\left(\\sigma_{y0}+H\\,\\alpha^{n}\\right)$。如果 $f_{\\text{tr}}\\le 0$，则设置 $\\varepsilon^{p,n+1}=\\varepsilon^{p,n}$、$\\alpha^{n+1}=\\alpha^{n}$ 和 $\\sigma^{n+1}=\\sigma_{\\text{tr}}$。否则，通过从条件 $f=0$ 确定塑性增量 $d\\lambda$ 来强制执行一致性条件。从一致性条件中推导出一个关于 $E$、$H$、$k_{d}$、$d^{n}$、$\\sigma_{y0}$ 和当前变量的 $d\\lambda$ 的闭式表达式，并相应地更新 $\\varepsilon^{p,n+1}$、$\\alpha^{n+1}$ 和 $\\sigma^{n+1}$。\n- 损伤子问题（非局部的，全局的）：固定塑性变量 $\\varepsilon^{p,n+1}$ 和 $\\alpha^{n+1}$，计算驱动量 $Y^{n+1}=\\dfrac{1}{2}E(1-d^{n})\\left(\\varepsilon^{n+1}-\\varepsilon^{p,n+1}\\right)^{2}$，并求解线性系统 $(\\mathcal{I}-\\ell^{2}\\,\\Delta)\\, d^{n+1}=\\gamma(x)\\,Y^{n+1}$，其中边界条件为齐次 Neumann 条件。通过逐点投影 $d^{n+1}\\leftarrow\\max\\left(d^{n},\\min\\left(d^{n+1},d_{\\max}\\right)\\right)$ 来强制损伤的不可逆性和有界性，其中 $d_{\\max}  1$ 以避免刚度完全丧失。\n\n空间离散化与算法要求：\n- 使用 $N$ 个等距节点对杆进行离散化，$x_{i}=i\\,\\Delta x$，其中 $i\\in\\{0,1,\\dots,N-1\\}$，$\\Delta x=\\dfrac{L}{N-1}$。使用拉普拉斯算子的有限差分法离散，并通过镜像虚拟节点实现齐次 Neumann 边界条件：\n  - 对于内部节点 $i\\in\\{1,\\dots,N-2\\}$，使用 $\\Delta d_{i}\\approx\\dfrac{d_{i-1}-2\\,d_{i}+d_{i+1}}{\\Delta x^{2}}$。\n  - 对于零梯度的边界节点 $i=0$ 和 $i=N-1$，使用 $\\Delta d_{0}\\approx\\dfrac{2\\,(d_{1}-d_{0})}{\\Delta x^{2}}$ 和 $\\Delta d_{N-1}\\approx\\dfrac{2\\,(d_{N-2}-d_{N-1})}{\\Delta x^{2}}$。\n- 组装线性系统 $(\\mathbf{I}-\\ell^{2}\\,\\mathbf{L})\\,\\mathbf{d}^{n+1}=\\boldsymbol{\\gamma}\\odot\\mathbf{Y}^{n+1}$，其中 $\\mathbf{L}$ 是离散拉普拉斯矩阵，$\\boldsymbol{\\gamma}$ 是空间非均匀性因子的向量，$\\odot$ 表示逐点相乘。\n- 使用一个具有 $N_{\\text{steps}}$ 个增量的加载斜坡，且 $U^{n}=\\dfrac{n}{N_{\\text{steps}}}\\,U_{\\text{final}}$，因此 $\\varepsilon^{n}=\\dfrac{U^{n}}{L}$。\n- 初始化 $\\varepsilon^{p,0}=\\mathbf{0}$、$\\alpha^{0}=\\mathbf{0}$ 和 $d^{0}=\\mathbf{0}$。在加载结束时，计算并报告：\n  - 空间平均应力 $\\overline{\\sigma}=\\dfrac{1}{N}\\sum_{i=0}^{N-1}E\\,(1-d_{i}^{N_{\\text{steps}}})\\left(\\varepsilon^{N_{\\text{steps}}}-\\varepsilon_{i}^{p,N_{\\text{steps}}}\\right)$，以帕斯卡（Pa）为单位表示。\n  - 中点节点的损伤 $d_{\\text{mid}}=d_{i^{*}}^{N_{\\text{steps}}}$，其中 $i^{*}=\\lfloor\\dfrac{N-1}{2}\\rfloor$，以小数表示。\n  - 空间平均累积塑性应变 $\\overline{\\alpha}=\\dfrac{1}{N}\\sum_{i=0}^{N-1}\\alpha_{i}^{N_{\\text{steps}}}$，以小数表示。\n\n将上述算子分裂算法实现为一个完整的、可运行的程序。您的实现必须不接受任何输入，必须直接编码以下三个测试用例，并生成一行输出，其中包含结果，格式为逗号分隔的方括号三元组列表 $[\\,[\\overline{\\sigma}_{1},d_{\\text{mid},1},\\overline{\\alpha}_{1}],\\,[\\overline{\\sigma}_{2},d_{\\text{mid},2},\\overline{\\alpha}_{2}],\\,[\\overline{\\sigma}_{3},d_{\\text{mid},3},\\overline{\\alpha}_{3}]\\,]$。这三个测试用例如下：\n\n- 测试用例 1（通用正常路径，均匀非均匀性）：\n  - $E=2.00\\times 10^{11}\\,\\text{Pa}$，$H=1.00\\times 10^{9}\\,\\text{Pa}$，$\\sigma_{y0}=3.00\\times 10^{8}\\,\\text{Pa}$，$k_{d}=0.50$，$\\gamma_{0}=1.00\\times 10^{-10}\\,\\text{Pa}^{-1}$，$\\ell=2.00\\times 10^{-2}\\,\\text{m}$，$L=1.00\\,\\text{m}$，$U_{\\text{final}}=2.00\\times 10^{-3}\\,\\text{m}$，$N=51$，$N_{\\text{steps}}=20$，$d_{\\max}=9.90\\times 10^{-1}$，$\\gamma(x)=\\gamma_{0}$。\n- 测试用例 2（边界条件检查：零硬化，近乎局部的正则化，均匀非均匀性）：\n  - $E=2.00\\times 10^{11}\\,\\text{Pa}$，$H=0.00\\,\\text{Pa}$，$\\sigma_{y0}=1.00\\times 10^{8}\\,\\text{Pa}$，$k_{d}=0.20$，$\\gamma_{0}=1.00\\times 10^{-12}\\,\\text{Pa}^{-1}$，$\\ell=1.00\\times 10^{-3}\\,\\text{m}$，$L=1.00\\,\\text{m}$，$U_{\\text{final}}=6.00\\times 10^{-4}\\,\\text{m}$，$N=21$，$N_{\\text{steps}}=30$，$d_{\\max}=9.90\\times 10^{-1}$，$\\gamma(x)=\\gamma_{0}$。\n- 测试用例 3（边缘情况：通过高斯凹口实现的强耦合和集中非均匀性）：\n  - $E=2.00\\times 10^{11}\\,\\text{Pa}$，$H=5.00\\times 10^{8}\\,\\text{Pa}$，$\\sigma_{y0}=2.50\\times 10^{8}\\,\\text{Pa}$，$k_{d}=1.00$，$\\gamma_{0}=5.00\\times 10^{-10}\\,\\text{Pa}^{-1}$，$\\ell=5.00\\times 10^{-2}\\,\\text{m}$，$L=1.00\\,\\text{m}$，$U_{\\text{final}}=1.50\\times 10^{-3}\\,\\text{m}$，$N=101$，$N_{\\text{steps}}=30$，$d_{\\max}=9.50\\times 10^{-1}$，以及 $\\gamma(x)=\\gamma_{0}\\left(1+A\\exp\\left(-\\dfrac{(x-L/2)^{2}}{2\\,w^{2}}\\right)\\right)$，其中 $A=20.0$ 和 $w=5.00\\times 10^{-2}\\,\\text{m}$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $[[\\overline{\\sigma}_{1},d_{\\text{mid},1},\\overline{\\alpha}_{1}],[\\overline{\\sigma}_{2},d_{\\text{mid},2},\\overline{\\alpha}_{2}],[\\overline{\\sigma}_{3},d_{\\text{mid},3},\\overline{\\alpha}_{3}]]$，其中 $\\overline{\\sigma}_{i}$ 的单位必须是 $\\text{Pa}$，$d_{\\text{mid},i}$ 和 $\\overline{\\alpha}_{i}$ 必须是小数（无量纲）。", "solution": "用户提供了一个计算固体力学领域的问题陈述，具体涉及使用非局部正则化方法模拟一维杆中的塑性与损伤耦合现象。任务是验证该问题，如果问题有效，则设计并实现指定的算子分裂数值方案。\n\n### 第 1 步：提取已知条件\n\n- **问题域**：一根长度为 $L$ 的一维杆。\n- **加载**：单调位移控制，其中 $u(0)=0$ 和 $u(L)=U(t)$。\n- **运动学**：小应变，$\\varepsilon(x) = \\frac{du}{dx}$。等应变假设：$\\varepsilon(t) = \\frac{U(t)}{L}$，空间均匀。\n- **本构关系（应力）**：$\\sigma(x)=E(1-d(x))\\left(\\varepsilon - \\varepsilon^{p}(x)\\right)$。\n- **状态变量**：塑性应变 $\\varepsilon^{p}(x)$，累积塑性应变 $\\alpha(x)$，标量损伤 $d(x)\\in[0,1)$。\n- **塑性模型**：率无关，各向同性硬化。\n  - 屈服函数：$f=\\lvert\\sigma\\rvert - \\sigma_{y}(d,\\alpha)$。\n  - 损伤退化的屈服应力：$\\sigma_{y}(d,\\alpha)=\\left(1-k_{d}\\,d\\right)\\left(\\sigma_{y0}+H\\,\\alpha\\right)$。\n  - 塑性-损伤耦合系数：$k_{d}\\in[0,1]$。\n  - 初始屈服应力：$\\sigma_{y0}$。\n  - 硬化模量：$H$。\n- **塑性流动法则**：相关联，$d\\varepsilon^{p}=d\\lambda$，以及对于累积塑性应变，$d\\alpha=d\\lambda$，对于单调拉伸 $d\\lambda \\ge 0$。\n- **非局部损伤模型**：Helmholtz 型梯度损伤方程 $(\\mathcal{I}-\\ell^{2}\\,\\Delta)\\, d = \\gamma(x)\\,Y$。\n  - 内禀长度尺度：$\\ell$。\n  - 拉普拉斯算子：$\\Delta = \\frac{d^2}{dx^2}$。\n  - 空间非均匀性因子：$\\gamma(x)$。\n  - 损伤驱动能量释放率：$Y=\\dfrac{1}{2}\\,E\\,(1-d)\\left(\\varepsilon-\\varepsilon^{p}\\right)^{2}$，在交错方案中，使用前一步的损伤 $d^n$ 进行评估。\n- **损伤的边界条件**：齐次 Neumann，$\\frac{dd}{dx}(0)=0$ 和 $\\frac{dd}{dx}(L)=0$。\n- **交错方案**：在每个增量步 $n \\to n+1$：\n  1.  **塑性子问题（局部）**：对于固定的 $d^n$，计算 $\\varepsilon^{p,n+1}, \\alpha^{n+1}, \\sigma^{n+1}$。需要推导塑性乘子增量 $d\\lambda$ 的闭式表达式。\n  2.  **损伤子问题（非局部）**：对于固定的 $\\varepsilon^{p,n+1}$，计算 $Y^{n+1}$ 并求解 Helmholtz 方程以得到 $d^{n+1}$。\n  3.  **损伤投影**：强制不可逆性和饱和：$d^{n+1}\\leftarrow\\max\\left(d^{n},\\min\\left(d^{n+1},d_{\\max}\\right)\\right)$，其中 $d_{\\max}  1$。\n- **空间离散化**：\n  - $N$ 个节点，$x_{i}=i\\,\\Delta x$，$i\\in\\{0, \\dots, N-1\\}$，$\\Delta x = \\frac{L}{N-1}$。\n  - 拉普拉斯算子的有限差分法：\n    - 内部（$i\\in\\{1,\\dots,N-2\\}$）：$\\Delta d_{i}\\approx\\dfrac{d_{i-1}-2\\,d_{i}+d_{i+1}}{\\Delta x^{2}}$。\n    - 边界（$i=0$）：$\\Delta d_{0}\\approx\\dfrac{2\\,(d_{1}-d_{0})}{\\Delta x^{2}}$。\n    - 边界（$i=N-1$）：$\\Delta d_{N-1}\\approx\\dfrac{2\\,(d_{N-2}-d_{N-1})}{\\Delta x^{2}}$。\n- **荷载离散化**：\n  - $N_{\\text{steps}}$ 个增量。\n  - 总施加位移：$U^{n}=\\dfrac{n}{N_{\\text{steps}}}\\,U_{\\text{final}}$。\n  - 总应变：$\\varepsilon^{n}=\\dfrac{U^{n}}{L}$。\n- **初始化**：$\\varepsilon^{p,0}=\\mathbf{0}$，$\\alpha^{0}=\\mathbf{0}$，$d^{0}=\\mathbf{0}$。\n- **要求的输出**：\n  1.  平均应力：$\\overline{\\sigma}=\\dfrac{1}{N}\\sum_{i=0}^{N-1}E\\,(1-d_{i}^{N_{\\text{steps}}})\\left(\\varepsilon^{N_{\\text{steps}}}-\\varepsilon_{i}^{p,N_{\\text{steps}}}\\right)$。\n  2.  中点损伤：$d_{\\text{mid}}=d_{i^{*}}^{N_{\\text{steps}}}$，其中 $i^{*}=\\lfloor\\dfrac{N-1}{2}\\rfloor$。\n  3.  平均累积塑性应变：$\\overline{\\alpha}=\\dfrac{1}{N}\\sum_{i=0}^{N-1}\\alpha_{i}^{N_{\\text{steps}}}$。\n- **测试用例**：为 $E, H, \\sigma_{y0}, k_d, \\gamma_0, \\ell, L, U_{\\text{final}}, N, N_{\\text{steps}}, d_{\\max}$ 以及 $\\gamma(x)$ 的函数形式提供了三组参数。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n- **科学依据**：该问题坚实地植根于连续介质力学、塑性理论和损伤力学。用于正则化的梯度损伤模型（Helmholtz 方程）是一种标准且成熟的技术，用以减轻应变软化材料模拟中的病态网格敏感性。算子分裂（交错）方案是求解此类耦合问题的常用且有效数值策略。所有定义和方程都是该领域的标准表示。\n- **适定的**：该问题是适定的。在位移控制下，局部塑性模型与非局部损伤模型的组合通常会得到唯一且稳定的解。等应变假设将问题简化为一组伪时间上的常微分方程，这些方程通过损伤方程在空间上耦合。所提供的参数在物理上是合理的。\n- **客观性**：问题以精确、客观和数学化的语言陈述。没有主观或基于意见的成分。所有术语都得到了明确的定义。\n\n问题陈述提供了一套完整且一致的定义、控制方程、边界条件、数值方案和参数。为拉普拉斯算子指定的有限差分公式，包括对 Neumann 边界条件的处理，是显式的，可以直接实现。虽然由此产生的离散拉普拉斯矩阵是非对称的，但这是指定公式的直接结果，必须被视为问题的要求，而非缺陷。该问题是一个有效且定义明确的计算力学任务。\n\n### 第 3 步：结论与行动\n\n该问题是有效的。将提供一个完整的解决方案。\n\n### 解的推导\n\n求解过程遵循一个算子分裂方案，用于从伪时间步 $n$ 到 $n+1$ 的每个荷载增量。总施加应变是均匀的，由 $\\varepsilon^{n+1} = \\frac{(n+1) U_{\\text{final}}}{N_{\\text{steps}} L}$ 给出。每个空间节点 $i$ 的状态变量，即 $\\varepsilon^{p,n+1}_i$、$\\alpha^{n+1}_i$ 和 $d^{n+1}_i$，从它们在第 $n$ 步的值进行更新。\n\n**1. 塑性子问题（局部更新）**\n\n对于每个节点 $i$，将损伤变量冻结在前一步的值上，即 $d_i^n$，我们确定塑性更新。\n假设塑性应变没有变化，计算试探弹性应力：\n$$ \\sigma_{\\text{tr},i}^{n+1} = E(1-d_i^n)(\\varepsilon^{n+1} - \\varepsilon_i^{p,n}) $$\n增量步开始时的屈服应力为：\n$$ \\sigma_{y,i}^n = (1-k_d d_i^n)(\\sigma_{y0} + H \\alpha_i^n) $$\n对于单调拉伸（$\\sigma0$），试探屈服函数为 $f_{\\text{tr},i} = \\sigma_{\\text{tr},i}^{n+1} - \\sigma_{y,i}^n$。\n\n如果 $f_{\\text{tr},i} \\le 0$，则该步为弹性。状态变量的塑性分量不发生改变：\n$$ \\varepsilon_i^{p,n+1} = \\varepsilon_i^{p,n} $$\n$$ \\alpha_i^{n+1} = \\alpha_i^{n} $$\n$$ \\sigma_i^{n+1} = \\sigma_{\\text{tr},i}^{n+1} $$\n\n如果 $f_{\\text{tr},i}  0$，则发生塑性流动。我们必须找到塑性乘子增量 $d\\lambda_i$，以强制在该步结束时满足一致性条件 $f_i^{n+1}=0$。\n更新如下：\n$$ \\varepsilon_i^{p,n+1} = \\varepsilon_i^{p,n} + d\\lambda_i $$\n$$ \\alpha_i^{n+1} = \\alpha_i^{n} + d\\lambda_i $$\n该步结束时的应力和屈服应力为：\n$$ \\sigma_i^{n+1} = E(1-d_i^n)(\\varepsilon^{n+1} - \\varepsilon_i^{p,n+1}) = E(1-d_i^n)(\\varepsilon^{n+1} - \\varepsilon_i^{p,n} - d\\lambda_i) = \\sigma_{\\text{tr},i}^{n+1} - E(1-d_i^n)d\\lambda_i $$\n$$ \\sigma_{y,i}^{n+1} = (1-k_d d_i^n)(\\sigma_{y0} + H \\alpha_i^{n+1}) = (1-k_d d_i^n)(\\sigma_{y0} + H (\\alpha_i^{n} + d\\lambda_i)) = \\sigma_{y,i}^n + (1-k_d d_i^n)H d\\lambda_i $$\n一致性条件 $\\sigma_i^{n+1} = \\sigma_{y,i}^{n+1}$ 给出：\n$$ \\sigma_{\\text{tr},i}^{n+1} - E(1-d_i^n)d\\lambda_i = \\sigma_{y,i}^n + (1-k_d d_i^n)H d\\lambda_i $$\n重新整理以求解 $d\\lambda_i$：\n$$ \\sigma_{\\text{tr},i}^{n+1} - \\sigma_{y,i}^n = [E(1-d_i^n) + H(1-k_d d_i^n)] d\\lambda_i $$\n左侧是试探屈服函数 $f_{\\text{tr},i}$。这得出了塑性乘子增量的闭式表达式：\n$$ d\\lambda_i = \\frac{f_{\\text{tr},i}}{E(1-d_i^n) + H(1-k_d d_i^n)} $$\n\n**2. 损伤子问题（非局部更新）**\n\n将塑性应变 $\\varepsilon_i^{p,n+1}$ 固定为前一个子问题的值，我们求解损伤场 $d_i^{n+1}$。\n首先，计算每个节点的损伤驱动能量释放率。按照规定，这里使用前一步的损伤 $d_i^n$，以维持关于 $d_i^{n+1}$ 的线性问题：\n$$ Y_i^{n+1} = \\frac{1}{2} E (1-d_i^n) (\\varepsilon^{n+1} - \\varepsilon_i^{p,n+1})^2 $$\nHelmholtz 方程为 $(\\mathcal{I}-\\ell^2\\,\\Delta) d = \\gamma(x) Y$。我们使用所提供的有限差分格式来离散该方程。设 $\\mathbf{d}$ 和 $\\mathbf{Y}$ 为节点值的向量。我们组装线性系统：\n$$ (\\mathbf{I} - \\ell^2 \\mathbf{L}) \\mathbf{d}^{n+1} = \\boldsymbol{\\gamma} \\odot \\mathbf{Y}^{n+1} $$\n其中 $\\mathbf{I}$ 是单位矩阵，$\\mathbf{L}$ 是离散拉普拉斯矩阵，$\\odot$ 是逐元素乘积。\n矩阵 $\\mathbf{L}$ 的维度为 $N \\times N$。设 $c = 1/\\Delta x^2$。$\\mathbf{L}$ 的非零项为：\n- 对于内部行 $i \\in \\{1, \\dots, N-2\\}$：$L_{i,i-1}=c$，$L_{i,i}=-2c$，$L_{i,i+1}=c$。\n- 对于第一行（$i=0$）：$L_{0,0}=-2c$，$L_{0,1}=2c$。\n- 对于最后一行（$i=N-1$）：$L_{N-1,N-2}=2c$，$L_{N-1,N-1}=-2c$。\n\n构建系统矩阵 $\\mathbf{A} = \\mathbf{I} - \\ell^2 \\mathbf{L}$。右端项向量为 $\\mathbf{b}_i = \\gamma(x_i) Y_i^{n+1}$。我们求解线性系统 $\\mathbf{A} \\mathbf{d}_{\\text{sol}}^{n+1} = \\mathbf{b}$ 以得到解向量 $\\mathbf{d}_{\\text{sol}}^{n+1}$。\n\n最后，损伤更新必须满足不可逆性（$d$ 不能减小）和最大值约束。这通过一个投影来强制执行：\n$$ d_i^{n+1} = \\max(d_i^n, \\min(d_{\\text{sol},i}^{n+1}, d_{\\max})) $$\n\n**3. 算法总结与输出计算**\n\n完整的算法遍历所有荷载步，并依次应用这两个子问题。\n\n**初始化**：\n- 设置 $N, L, \\Delta x$ 以及材料/控制参数。\n- 初始化节点数组：$\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$，$\\boldsymbol{\\alpha} = \\mathbf{0}$，$\\mathbf{d} = \\mathbf{0}$。\n- 构建系统矩阵 $\\mathbf{A} = \\mathbf{I} - \\ell^2 \\mathbf{L}$。\n\n**迭代循环**：对于 $n$ 从 $0$ 到 $N_{\\text{steps}}-1$：\n1.  计算新步的总应变，$\\varepsilon^{n+1}$。\n2.  存储当前损伤状态：$\\mathbf{d}^n \\leftarrow \\mathbf{d}$。\n3.  **塑性步**：\n    - 计算所有节点的试探应力 $\\boldsymbol{\\sigma}_{\\text{tr}}$ 和试探屈服函数 $\\mathbf{f}_{\\text{tr}}$。\n    - 识别屈服节点，其中 $f_{\\text{tr},i}  0$。\n    - 对于屈服节点，计算 $d\\lambda_i$ 并更新 $\\varepsilon_i^p$ 和 $\\alpha_i$。\n4.  **损伤步**：\n    - 使用更新后的 $\\boldsymbol{\\varepsilon}^p$ 和存储的 $\\mathbf{d}^n$ 计算损伤驱动力 $\\mathbf{Y}^{n+1}$。\n    - 构建右端项向量 $\\mathbf{b} = \\boldsymbol{\\gamma} \\odot \\mathbf{Y}^{n+1}$。\n    - 求解 $\\mathbf{A} \\mathbf{d}_{\\text{sol}} = \\mathbf{b}$ 得到 $\\mathbf{d}_{\\text{sol}}$。\n    - 更新损伤：$\\mathbf{d} \\leftarrow \\max(\\mathbf{d}^n, \\min(\\mathbf{d}_{\\text{sol}}, d_{\\max}))$。\n\n**最终处理**：循环结束后：\n1.  计算最终的节点应力：$\\sigma_i = E(1-d_i)(\\varepsilon^{N_{\\text{steps}}} - \\varepsilon_i^p)$。\n2.  计算平均应力：$\\overline{\\sigma} = \\frac{1}{N}\\sum_i \\sigma_i$。\n3.  找到中点损伤：$d_{\\text{mid}} = d_{\\lfloor(N-1)/2\\rfloor}$。\n4.  计算平均累积塑性应变：$\\overline{\\alpha} = \\frac{1}{N}\\sum_i \\alpha_i$。\n\n实现将针对三个指定的测试用例遵循此逻辑。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        {\n            # Test case 1 (general happy path, uniform heterogeneity)\n            \"E\": 2.00e11, \"H\": 1.00e9, \"sigma_y0\": 3.00e8, \"k_d\": 0.50,\n            \"gamma_0\": 1.00e-10, \"ell\": 2.00e-2, \"L\": 1.00, \"U_final\": 2.00e-3,\n            \"N\": 51, \"N_steps\": 20, \"d_max\": 0.99,\n            \"gamma_func\": lambda x, L, gamma_0, A, w: gamma_0\n        },\n        {\n            # Test case 2 (boundary condition check: vanishing hardening, near-local regularization, uniform heterogeneity)\n            \"E\": 2.00e11, \"H\": 0.00, \"sigma_y0\": 1.00e8, \"k_d\": 0.20,\n            \"gamma_0\": 1.00e-12, \"ell\": 1.00e-3, \"L\": 1.00, \"U_final\": 6.00e-4,\n            \"N\": 21, \"N_steps\": 30, \"d_max\": 0.99,\n            \"gamma_func\": lambda x, L, gamma_0, A, w: gamma_0\n        },\n        {\n            # Test case 3 (edge case: strong coupling and concentrated heterogeneity via a Gaussian notch)\n            \"E\": 2.00e11, \"H\": 5.00e8, \"sigma_y0\": 2.50e8, \"k_d\": 1.00,\n            \"gamma_0\": 5.00e-10, \"ell\": 5.00e-2, \"L\": 1.00, \"U_final\": 1.50e-3,\n            \"N\": 101, \"N_steps\": 30, \"d_max\": 0.95,\n            \"gamma_func\": lambda x, L, gamma_0, A, w: gamma_0 * (1 + A * np.exp(-(x - L/2)**2 / (2 * w**2))),\n            \"A\": 20.0, \"w\": 0.05\n        }\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        result = run_simulation(case)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    result_strings = [f\"[{s},{d},{a}]\" for s, d, a in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\ndef run_simulation(params):\n    \"\"\"\n    Executes the operator-splitting simulation for a single test case.\n    \"\"\"\n    E = params[\"E\"]\n    H = params[\"H\"]\n    sigma_y0 = params[\"sigma_y0\"]\n    k_d = params[\"k_d\"]\n    gamma_0 = params[\"gamma_0\"]\n    ell = params[\"ell\"]\n    L = params[\"L\"]\n    U_final = params[\"U_final\"]\n    N = params[\"N\"]\n    N_steps = params[\"N_steps\"]\n    d_max = params[\"d_max\"]\n    gamma_func = params[\"gamma_func\"]\n    A = params.get(\"A\", 0)\n    w = params.get(\"w\", 1)\n\n    # Spatial discretization\n    x = np.linspace(0, L, N)\n    dx = L / (N - 1)\n    \n    # Initialize state variables\n    p_strain = np.zeros(N)  # plastic strain\n    p_alpha = np.zeros(N)   # accumulated plastic strain\n    damage = np.zeros(N)    # damage\n    \n    # Construct the gamma vector\n    gamma = gamma_func(x, L, gamma_0, A, w) * np.ones(N)\n\n    # Construct the discrete Laplacian matrix L\n    L_mat = np.zeros((N, N))\n    dx2 = dx**2\n    # Interior nodes\n    for i in range(1, N - 1):\n        L_mat[i, i - 1] = 1.0 / dx2\n        L_mat[i, i] = -2.0 / dx2\n        L_mat[i, i + 1] = 1.0 / dx2\n    # Boundary nodes (Neumann)\n    L_mat[0, 0] = -2.0 / dx2\n    L_mat[0, 1] = 2.0 / dx2\n    L_mat[N - 1, N - 2] = 2.0 / dx2\n    L_mat[N - 1, N - 1] = -2.0 / dx2\n\n    # Construct the system matrix A = I - l^2 * L\n    A_mat = np.identity(N) - ell**2 * L_mat\n\n    # Load stepping loop\n    for n in range(N_steps):\n        eps_total = (n + 1) / N_steps * U_final / L\n\n        # --- Plasticity Subproblem (Local) ---\n        d_prev_step = damage.copy()\n        \n        # Trial stress and yield function (vectorized)\n        sigma_tr = E * (1 - d_prev_step) * (eps_total - p_strain)\n        sigma_y = (1 - k_d * d_prev_step) * (sigma_y0 + H * p_alpha)\n        f_tr = sigma_tr - sigma_y\n        \n        # Identify nodes that yield\n        plastic_nodes = f_tr > 0\n        \n        if np.any(plastic_nodes):\n            # Denominator for plastic multiplier increment\n            denom = E * (1 - d_prev_step[plastic_nodes]) + H * (1 - k_d * d_prev_step[plastic_nodes])\n            d_lambda = f_tr[plastic_nodes] / denom\n            \n            # Update plastic variables only for yielding nodes\n            p_strain[plastic_nodes] += d_lambda\n            p_alpha[plastic_nodes] += d_lambda\n        \n        # --- Damage Subproblem (Nonlocal) ---\n        # Damage driving force (uses d from previous step)\n        Y = 0.5 * E * (1 - d_prev_step) * (eps_total - p_strain)**2\n        \n        # Right-hand side of Helmholtz equation\n        b = gamma * Y\n        \n        # Solve for damage\n        d_sol = np.linalg.solve(A_mat, b)\n        \n        # Projection for irreversibility and max damage\n        damage = np.maximum(d_prev_step, np.minimum(d_sol, d_max))\n\n    # --- Post-processing ---\n    eps_final = U_final / L\n    sigma_final = E * (1 - damage) * (eps_final - p_strain)\n    sigma_avg = np.mean(sigma_final)\n    \n    mid_node_idx = (N - 1) // 2\n    d_mid = damage[mid_node_idx]\n    \n    alpha_avg = np.mean(p_alpha)\n\n    return sigma_avg, d_mid, alpha_avg\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "3589093"}]}