{"hands_on_practices": [{"introduction": "要有效解决体积锁定问题，首先必须从运动学上理解变形的本质。本练习旨在通过从第一性原理推导将应变张量分解为体积部分和偏量部分的投影算子，为后续的讨论奠定坚实的数学基础。掌握这种分解是区分材料体积变化（在近不可压缩材料中受到高度约束）和形状变化（应保持不受影响）的关键 [@problem_id:3609956]。", "problem": "近不可压缩性中体积锁定的一个核心原因，是基于位移的低阶有限元中体积变形模式与偏应变变形模式的不当耦合。为分析此现象背后的运动学，考虑由运动学关系 $\\,\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)\\,$ 定义的小应变张量，Frobenius 内积 $\\,\\boldsymbol{A}:\\boldsymbol{B} = \\sum_{i,j} A_{ij} B_{ij}\\,$，以及对称二阶张量空间分解为一个由单位张量生成的一维子空间及其正交补。\n\n1) 仅利用小应变张量的对称性和关于 Frobenius 内积的正交分解，构造唯一的四阶投影张量 $\\,\\mathbb{P}^{\\mathrm{vol}}\\,$ 和 $\\,\\mathbb{P}^{\\mathrm{dev}}\\,$，它们分别将任意对称张量 $\\,\\boldsymbol{A}\\,$ 映射到其球量（体积）部分和偏量部分。使用克罗内克符号 (Kronecker delta) 以指数表示法推导它们的显式分量。你不能假设它们的形式；相反，必须通过对由 $\\,\\boldsymbol{I}\\,$ 及其正交补生成的子空间施加各向同性、幂等性和正交性来确定它们。\n\n2) 证明这些投影算子满足 $\\,\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}=\\mathbb{P}^{\\mathrm{vol}}\\,$, $\\,\\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{P}^{\\mathrm{dev}}\\,$, $\\,\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{O}\\,$ 和 $\\,\\mathbb{P}^{\\mathrm{vol}}+\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{I}^{\\mathrm{sym}}\\,$，其中 $\\,\\mathbb{I}^{\\mathrm{sym}}\\,$ 是对称四阶单位张量。简要解释这种分解如何隔离在近不可压缩极限 $\\,\\operatorname{tr}\\boldsymbol{\\varepsilon}\\approx 0\\,$ 下受约束的运动学，并阐明其与有限元法 (FEM) 中基于位移的公式中的体积锁定的联系。\n\n3) 设给定的小应变张量为\n$$\n\\boldsymbol{\\varepsilon} \\;=\\;\n\\begin{pmatrix}\n3  2  -1 \\\\\n2  1  0 \\\\\n-1  0  -2\n\\end{pmatrix}.\n$$\n应用你的偏应变投影算子计算偏应变 $\\,\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}\\,$。然后计算 Frobenius 范数的平方 $\\,\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\,$。以一个无单位的精确数形式给出你的最终答案。不要四舍五入。", "solution": "该问题被评估为有效，因为它在科学上基于连续介质力学和计算固体力学，是适定的、客观的且内部一致的。它是一个关于张量代数及其在理解有限元法 (FEM) 中数值伪影方面的应用的经典但非平凡的练习。\n\n解答按要求分为三个部分。\n\n第 1 部分：投影张量的构造\n\n我们首先考虑三维 ($d=3$) 空间中的对称二阶张量空间，这是一个 6 维向量空间。任何此类张量 $\\boldsymbol{A}$ 都可以唯一地分解为一个球量（体积）部分 $\\boldsymbol{A}^{\\mathrm{vol}}$ 和一个偏量部分 $\\boldsymbol{A}^{\\mathrm{dev}}$，使得 $\\boldsymbol{A} = \\boldsymbol{A}^{\\mathrm{vol}} + \\boldsymbol{A}^{\\mathrm{dev}}$。\n\n体积部分 $\\boldsymbol{A}^{\\mathrm{vol}}$ 被定义为属于由二阶单位张量 $\\boldsymbol{I}$ 生成的一维子空间。因此，$\\boldsymbol{A}^{\\mathrm{vol}}$ 必须具有 $\\boldsymbol{A}^{\\mathrm{vol}} = c\\boldsymbol{I}$ 的形式，其中 $c$ 是某个标量。偏量部分 $\\boldsymbol{A}^{\\mathrm{dev}}$ 属于该子空间关于 Frobenius 内积的正交补。正交性条件为 $\\boldsymbol{A}^{\\mathrm{dev}}:\\boldsymbol{I} = 0$。由于张量 $\\boldsymbol{X}$ 的迹由 $\\operatorname{tr}(\\boldsymbol{X}) = \\boldsymbol{X}:\\boldsymbol{I}$ 给出，该条件等价于 $\\operatorname{tr}(\\boldsymbol{A}^{\\mathrm{dev}}) = 0$。\n\n张量 $\\boldsymbol{A}^{\\mathrm{vol}}$ 是 $\\boldsymbol{A}$ 在由 $\\boldsymbol{I}$ 生成的子空间上的正交投影。使用内积空间中正交投影的标准公式，我们有：\n$$\n\\boldsymbol{A}^{\\mathrm{vol}} = \\frac{\\boldsymbol{A}:\\boldsymbol{I}}{\\boldsymbol{I}:\\boldsymbol{I}} \\boldsymbol{I}\n$$\n我们计算此表达式的各分量。分子是 $\\boldsymbol{A}$ 的迹：\n$$\n\\boldsymbol{A}:\\boldsymbol{I} = A_{ij}\\delta_{ij} = A_{ii} = \\operatorname{tr}(\\boldsymbol{A})\n$$\n分母是单位张量范数的平方：\n$$\n\\boldsymbol{I}:\\boldsymbol{I} = \\delta_{ij}\\delta_{ij} = \\delta_{ii} = 3\n$$\n将这些代回，我们得到 $\\boldsymbol{A}$ 的体积部分的表达式：\n$$\n\\boldsymbol{A}^{\\mathrm{vol}} = \\frac{\\operatorname{tr}(\\boldsymbol{A})}{3}\\boldsymbol{I}\n$$\n我们正在寻找四阶体积投影张量 $\\mathbb{P}^{\\mathrm{vol}}$，使得 $\\boldsymbol{A}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}:\\boldsymbol{A}$。用指数表示法，即 $(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}A_{kl}$。\n从我们推导的表达式中，我们有：\n$$\n(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = \\left(\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{A})\\right)\\delta_{ij} = \\frac{1}{3} (A_{mm})\\delta_{ij}\n$$\n为了匹配 $(\\mathbb{P}^{\\mathrm{vol}})_{ijkl}A_{kl}$ 的形式，我们使用克罗内克符号 (Kronecker delta) 来写出迹：$A_{mm} = \\delta_{kl}A_{kl}$。\n$$\n(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = \\frac{1}{3} \\delta_{ij}(\\delta_{kl}A_{kl}) = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{kl}\\right)A_{kl}\n$$\n通过比较各项，我们确定体积投影张量的分量：\n$$\n(\\mathbb{P}^{\\mathrm{vol}})_{ijkl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\n偏量部分通过减法定义：$\\boldsymbol{A}^{\\mathrm{dev}} = \\boldsymbol{A} - \\boldsymbol{A}^{\\mathrm{vol}}$。因此，相应的偏量投影张量 $\\mathbb{P}^{\\mathrm{dev}}$ 是 $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$，其中 $\\mathbb{I}^{\\mathrm{sym}}$ 是对称四阶单位张量。$\\mathbb{I}^{\\mathrm{sym}}$ 对任何对称张量 $\\boldsymbol{A}$ 的作用是返回 $\\boldsymbol{A}$ 本身。其分量由下式给出：\n$$\n(\\mathbb{I}^{\\mathrm{sym}})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n因此，偏量投影张量的分量是：\n$$\n(\\mathbb{P}^{\\mathrm{dev}})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\n\n第 2 部分：投影算子性质及与体积锁定的联系\n\n现在我们使用指数表示法和双点积法则 $(\\mathbb{A}:\\mathbb{B})_{ijkl} = A_{ijmn}B_{mnkl}$ 来证明所需的性质。\n\n1.  $\\mathbb{P}^{\\mathrm{vol}}$ 的幂等性：$\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}=\\mathbb{P}^{\\mathrm{vol}}$\n    $$\n    (\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}})_{ijkl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijmn}(\\mathbb{P}^{\\mathrm{vol}})_{mnkl} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{mn}\\right)\\left(\\frac{1}{3}\\delta_{mn}\\delta_{kl}\\right) = \\frac{1}{9}\\delta_{ij}\\delta_{kl}(\\delta_{mn}\\delta_{mn}) = \\frac{1}{9}\\delta_{ij}\\delta_{kl}(\\delta_{mm})\n    $$\n    由于 $\\delta_{mm} = 3$，上式变为 $\\frac{3}{9}\\delta_{ij}\\delta_{kl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}$。该性质得证。\n\n2.  正交性：$\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{O}$\n    我们使用性质 $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$。\n    $$\n    \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{vol}}:(\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}) = \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}\n    $$\n    第二项根据前一个证明为 $\\mathbb{P}^{\\mathrm{vol}}$。对于第一项：\n    $$\n    (\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}})_{ijkl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijmn}(\\mathbb{I}^{\\mathrm{sym}})_{mnkl} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{mn}\\right)\\left(\\frac{1}{2}(\\delta_{mk}\\delta_{nl} + \\delta_{ml}\\delta_{nk})\\right) = \\frac{1}{6}\\delta_{ij}(\\delta_{mn}\\delta_{mk}\\delta_{nl} + \\delta_{mn}\\delta_{ml}\\delta_{nk})\n    $$\n    $$\n    = \\frac{1}{6}\\delta_{ij}(\\delta_{nk}\\delta_{nl} + \\delta_{lk}\\delta_{nk}) = \\frac{1}{6}\\delta_{ij}(\\delta_{kl} + \\delta_{kl}) = \\frac{1}{3}\\delta_{ij}\\delta_{kl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}\n    $$\n    所以，$\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{P}^{\\mathrm{vol}}$。因此，$\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{O}$。该性质得证。\n\n3.  $\\mathbb{P}^{\\mathrm{dev}}$ 的幂等性：$\\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{P}^{\\mathrm{dev}}$\n    $$\n    \\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}} = (\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}):(\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}) = \\mathbb{I}^{\\mathrm{sym}}:\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{I}^{\\mathrm{sym}}:\\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} + \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}\n    $$\n    由于 $\\mathbb{I}^{\\mathrm{sym}}$ 是单位张量，所以 $\\mathbb{I}^{\\mathrm{sym}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{I}^{\\mathrm{sym}}$。我们已经证明了 $\\mathbb{I}^{\\mathrm{sym}}:\\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}$ 和 $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{P}^{\\mathrm{vol}}$，以及 $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}$。\n    代入这些结果得到：$\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}} + \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{dev}}$。该性质得证。\n\n4.  完备性：$\\mathbb{P}^{\\mathrm{vol}}+\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{I}^{\\mathrm{sym}}$\n    这由 $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$ 的定义本身所保证。\n\n与体积锁定的联系：\n在近不可压缩弹性理论中，材料强烈抵抗体积变化，从而导致运动学约束 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$。这种分解至关重要，因为它隔离了受约束的运动学模式。体积应变为 $\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}:\\boldsymbol{\\varepsilon} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I}$，因此不可压缩性约束等价于要求 $\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} \\approx \\boldsymbol{0}$。\n在基于位移的低阶有限元公式（例如，线性三角形或四面体单元）中，位移场 $\\boldsymbol{u}$ 很简单，这反过来又将应变场 $\\boldsymbol{\\varepsilon}$ 限制为在单元上是常数（或线性）。约束 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 0$ 必须在整个单元内得到满足。对于一个低阶单元，这一个方程可能对有限的可用运动学自由度施加过强的约束。这会“锁定”单元，使其人为地变得刚硬，因为简单的插值位移场要处处满足 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 0$ 的唯一方法是采取平凡的零变形状态。因此，在不可压缩性约束下，该单元无法表示有效的形状改变（偏）变形，例如纯剪切。这种现象被称为体积锁定。\n\n第 3 部分：应用于给定的应变张量\n\n给定的小应变张量为：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 3  2  -1 \\\\ 2  1  0 \\\\ -1  0  -2 \\end{pmatrix}\n$$\n首先，我们计算偏应变 $\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\mathrm{vol}}$。我们需要 $\\boldsymbol{\\varepsilon}$ 的迹：\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 3 + 1 + (-2) = 2\n$$\n体积应变为：\n$$\n\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I} = \\frac{2}{3}\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 2/3  0  0 \\\\ 0  2/3  0 \\\\ 0  0  2/3 \\end{pmatrix}\n$$\n现在，我们从总应变中减去它以求得偏应变：\n$$\n\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\begin{pmatrix} 3  2  -1 \\\\ 2  1  0 \\\\ -1  0  -2 \\end{pmatrix} - \\begin{pmatrix} 2/3  0  0 \\\\ 0  2/3  0 \\\\ 0  0  2/3 \\end{pmatrix} = \\begin{pmatrix} 3 - \\frac{2}{3}  2  -1 \\\\ 2  1 - \\frac{2}{3}  0 \\\\ -1  0  -2 - \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{3}  2  -1 \\\\ 2  \\frac{1}{3}  0 \\\\ -1  0  -\\frac{8}{3} \\end{pmatrix}\n$$\n最后，我们计算偏应变 Frobenius 范数的平方，$\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$，即其各分量平方之和：\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\left(\\frac{7}{3}\\right)^2 + (2)^2 + (-1)^2 + (2)^2 + \\left(\\frac{1}{3}\\right)^2 + (0)^2 + (-1)^2 + (0)^2 + \\left(-\\frac{8}{3}\\right)^2\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\frac{49}{9} + 4 + 1 + 4 + \\frac{1}{9} + 0 + 1 + 0 + \\frac{64}{9}\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\left(\\frac{49}{9} + \\frac{1}{9} + \\frac{64}{9}\\right) + (4 + 1 + 4 + 1)\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\frac{114}{9} + 10 = \\frac{38}{3} + 10 = \\frac{38}{3} + \\frac{30}{3} = \\frac{68}{3}\n$$", "answer": "$$\\boxed{\\frac{68}{3}}$$", "id": "3609956"}, {"introduction": "在理解了应变的分解之后，我们通过一个清晰的解析实例来揭示体积锁定的具体表现。本练习将一个精确的不可压缩弹性解与一个简化的、表现出锁定效应的有限元解进行对比 [@problem_id:3609974]。通过这个对比，您将亲眼见证，在近不可压缩极限下（即拉梅参数 $\\lambda \\to \\infty$），不恰当的单元列式如何导致其响应变得异常刚硬，从而直观地理解体积锁定的病态性质。", "problem": "考虑单位正方形域 $\\Omega = (0,1)\\times(0,1)$ 上的小应变、平面应变、线性弹性问题，其位移矢量场为 $u = (u_x,u_y)$，柯西应力张量为 $\\sigma$。该材料是各向同性的，剪切模量为 $\\mu>0$，拉梅参数为 $\\lambda>0$；不可压缩极限对应于通过拉格朗日乘子压力 $p$ 施加运动学约束 $\\nabla\\cdot u = 0$，并将本构关系写为 $\\sigma = -p I + 2\\mu\\,\\epsilon(u)$，其中 $\\epsilon(u) = \\frac{1}{2}\\left(\\nabla u + \\nabla u^{\\top}\\right)$ 是小应变张量，$I$ 是单位张量。在标准的纯位移格式中，本构关系写为 $\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon(u))\\,I + 2\\mu\\,\\epsilon(u)$。\n\n通过运动学边界条件 $u_y(x,1) = -\\delta$ 和 $u_y(x,0) = 0$（对于给定的 $\\delta>0$）施加一个竖向均匀压缩。侧边是无面力的；也就是说，在 $x=0$ 和 $x=1$ 处，施加 $\\sigma\\,n = 0$，其中 $n$ 是外单位法向量。\n\n第一部分（精确不可压缩基线）：使用基于压力的不可压缩格式（通过 $p$ 强制执行约束 $\\nabla\\cdot u = 0$），推导满足平衡、上述运动学边界条件和侧边无面力条件的 $(u,p)$ 的精确解。根据此精确解，计算顶边 $y=1$ 上的均匀竖向反作用面力 $\\bar{t}_y^{\\text{exact}}$（即 $\\sigma_{yy}$ 沿 $y=1$ 的常数值）。\n\n第二部分（四节点四边形单元锁定情景）：考虑在此单单元网格上使用纯位移四节点四边形 ($Q1$) 有限元法 (FEM)，并施加相同的竖向运动学边界条件。为了模拟在近不可压缩条件下，粗糙的纯位移网格中侧向膨胀被伪抑制的常见锁定效应，在侧边 $x=0$ 和 $x=1$ 上施加 $u_x=0$。使用纯位移本构关系 $\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon(u))\\,I + 2\\mu\\,\\epsilon(u)$，计算顶边上得到的均匀竖向反作用面力 $\\bar{t}_y^{\\text{Q1}}$。\n\n第三部分（定量比较）：构造由下式定义的比率 $R(\\lambda,\\mu)$\n$$\nR(\\lambda,\\mu) \\;=\\; \\frac{|\\bar{t}_y^{\\text{Q1}}|}{|\\bar{t}_y^{\\text{exact}}|},\n$$\n并将其简化为仅含 $\\lambda$ 和 $\\mu$ 的闭式表达式。这个无量纲比率量化了接近不可压缩极限时体积锁定的特征——过刚现象。请提供 $R(\\lambda,\\mu)$ 的简化解析表达式作为您的最终答案。无需四舍五入，最终表达式中不应包含任何单位。", "solution": "该问题要求对一个不可压缩弹性问题的精确解与一个表现出体积锁定的相应有限元解进行定量比较。分析分为三个部分。\n\n### 第一部分：精确不可压缩基线解\n\n小应变、平面应变、不可压缩弹性材料的控制方程是平衡方程和不可压缩性约束：\n$$\n\\nabla \\cdot \\sigma = 0\n$$\n$$\n\\nabla \\cdot u = 0\n$$\n将柯西应力张量 $\\sigma$ 与位移场 $u = (u_x, u_y)$ 联系起来的本构关系涉及一个拉格朗日乘子压力 $p$：\n$$\n\\sigma = -p I + 2\\mu\\,\\epsilon(u)\n$$\n其中 $\\mu > 0$ 是剪切模量，$I$ 是单位张量，$\\epsilon(u) = \\frac{1}{2}(\\nabla u + \\nabla u^{\\top})$ 是小应变张量。\n\n边界条件为：\n1.  底边 ($y=0$): $u_y(x,0) = 0$。\n2.  顶边 ($y=1$): $u_y(x,1) = -\\delta$，对于某个 $\\delta > 0$。\n3.  侧边 ($x=0, 1$): 无面力，即 $\\sigma n = 0$，其中 $n$ 是外法向量。\n\n鉴于均匀的竖向压缩，我们寻求一个解，其中竖向位移 $u_y$ 仅是 $y$ 的函数。边界条件表明一个线性分布：\n$$\nu_y(x,y) = -\\delta y\n$$\n这个选择满足 $u_y(x,0)=0$ 和 $u_y(x,1)=-\\delta$。\n\n现在，我们使用不可压缩性约束 $\\nabla \\cdot u = 0$：\n$$\n\\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = 0 \\implies \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial}{\\partial y}(-\\delta y) = 0 \\implies \\frac{\\partial u_x}{\\partial x} = \\delta\n$$\n对 $x$ 积分得到：\n$$\nu_x(x,y) = \\delta x + C(y)\n$$\n其中 $C(y)$ 是 $y$ 的任意函数。\n\n接下来，我们计算应变张量 $\\epsilon(u)$ 的分量：\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\delta\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\delta\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}\\left(C'(y) + 0\\right) = \\frac{1}{2}C'(y)\n$$\n\n平衡方程 $\\nabla \\cdot \\sigma = 0$ 可以通过代入本构关系写成斯托克斯流方程的形式：$-\\nabla p + \\mu \\nabla^2 u = 0$。其分量形式为：\n$x$ 分量：\n$$\n-\\frac{\\partial p}{\\partial x} + \\mu \\left(\\frac{\\partial^2 u_x}{\\partial x^2} + \\frac{\\partial^2 u_x}{\\partial y^2}\\right) = 0 \\implies -\\frac{\\partial p}{\\partial x} + \\mu \\left(0 + C''(y)\\right) = 0 \\implies \\frac{\\partial p}{\\partial x} = \\mu C''(y)\n$$\n$y$ 分量：\n$$\n-\\frac{\\partial p}{\\partial y} + \\mu \\left(\\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial y^2}\\right) = 0 \\implies - \\frac{\\partial p}{\\partial y} + \\mu(0+0) = 0 \\implies \\frac{\\partial p}{\\partial y} = 0\n$$\n$y$ 分量方程意味着压力 $p$ 仅是 $x$ 的函数，即 $p=p(x)$。将此代入 $x$ 分量方程，我们得到 $\\frac{dp}{dx} = \\mu C''(y)$。由于左边仅依赖于 $x$ 而右边仅依赖于 $y$，两者必须等于一个常数，设为 $K$。\n$$\n\\frac{dp}{dx} = K \\implies p(x) = Kx + P_0\n$$\n$$\n\\mu C''(y) = K \\implies C'(y) = \\frac{K}{\\mu} y + A_1\n$$\n其中 $P_0$ 和 $A_1$ 是积分常数。\n\n现在我们在侧边上应用无面力边界条件。在 $x=0$ 处，$n=(-1,0)$；在 $x=1$ 处，$n=(1,0)$。条件是 $\\sigma_{xx}(0,y)=0$, $\\sigma_{xy}(0,y)=0$ 以及 $\\sigma_{xx}(1,y)=0$, $\\sigma_{xy}(1,y)=0$。\n\n应力分量为：\n$$\n\\sigma_{xx} = -p + 2\\mu\\epsilon_{xx} = -(Kx+P_0) + 2\\mu\\delta\n$$\n$$\n\\sigma_{xy} = 2\\mu\\epsilon_{xy} = \\mu C'(y) = \\mu\\left(\\frac{K}{\\mu}y + A_1\\right) = Ky + \\mu A_1\n$$\n应用 $\\sigma_{xx}(0,y)=0$：\n$$\n-P_0 + 2\\mu\\delta = 0 \\implies P_0 = 2\\mu\\delta\n$$\n应用 $\\sigma_{xx}(1,y)=0$：\n$$\n-(K+P_0) + 2\\mu\\delta = 0 \\implies -K - (2\\mu\\delta) + 2\\mu\\delta = 0 \\implies K=0\n$$\n当 $K=0$ 时，压力是恒定的：$p(x) = P_0 = 2\\mu\\delta$。\n现在，应用 $\\sigma_{xy}(0,y)=0$：\n$$\nKy + \\mu A_1 = 0 \\implies (0)y + \\mu A_1 = 0 \\implies A_1 = 0\n$$\n在 $x=1$ 处的条件自动满足。因此，所有常数都已确定。位移分量 $u_x$ 是 $u_x(x,y) = \\delta x + A_2$，其中 $A_2$ 是一个对应于刚体运动的常数，不影响应力。我们可以设置 $A_2=-\\delta/2$ 以使得 $\\int_0^1 u_x(x,0)dx=0$，但这对于求解应力不是必需的。\n\n应力状态在整个域内是均匀的：\n$$\n\\sigma_{xx} = -(2\\mu\\delta) + 2\\mu\\delta = 0\n$$\n$$\n\\sigma_{yy} = -p + 2\\mu\\epsilon_{yy} = -(2\\mu\\delta) + 2\\mu(-\\delta) = -4\\mu\\delta\n$$\n$$\n\\sigma_{xy} = (0)y + \\mu(0) = 0\n$$\n顶边 $y=1$ 上的竖向反作用面力是沿该边的 $\\sigma_{yy}$ 值。\n$$\n\\bar{t}_y^{\\text{exact}} = \\sigma_{yy}|_{y=1} = -4\\mu\\delta\n$$\n\n### 第二部分：四节点四边形单元锁定情景\n\n在这一部分，我们考虑一个占据域 $\\Omega$ 的单个四节点双线性四边形 ($Q1$) 有限元。位移场 $(u_x, u_y)$ 由节点位移插值得到。边界条件现在应用于节点。\n-   $u_y(x,0)=0 \\implies u_{y1}=0, u_{y2}=0$\n-   $u_y(x,1)=-\\delta \\implies u_{y3}=-\\delta, u_{y4}=-\\delta$\n-   $u_x=0$ on lateral edges ($x=0,1$) $\\implies u_{x1}=u_{x4}=0$ and $u_{x2}=u_{x3}=0$.\n所有四个节点的 x-位移均为零：$u_{x1}=u_{x2}=u_{x3}=u_{x4}=0$。\n\n单位正方形上 $Q1$ 单元的位移场由下式给出：\n$$\nu(x,y) = \\sum_{i=1}^4 N_i(x,y) u_i\n$$\n其中 $u_i = (u_{xi}, u_{yi})$ 是节点位移，形函数为：\n$N_1=(1-x)(1-y)$, $N_2=x(1-y)$, $N_3=xy$, $N_4=(1-x)y$.\n\n根据指定的节点位移：\n$$\nu_x(x,y) = \\sum N_i(x,y) u_{xi} = 0\n$$\n$$\nu_y(x,y) = N_1(0) + N_2(0) + N_3(-\\delta) + N_4(-\\delta) = -xy\\delta - (1-x)y\\delta = -y\\delta(x + 1 - x) = -y\\delta\n$$\n单元内的位移场为 $u = (0, -\\delta y)$。\n\n现在，我们根据该位移场计算应变分量：\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = 0\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\delta\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = 0\n$$\n体积应变为 $\\operatorname{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} = 0 - \\delta = -\\delta$。\n\n在这一部分，我们使用纯位移本构关系：\n$$\n\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon)\\,I + 2\\mu\\,\\epsilon\n$$\n其中 $\\lambda > 0$ 是另一个拉梅参数。\n应力分量为：\n$$\n\\sigma_{xx} = \\lambda(-\\delta) + 2\\mu(0) = -\\lambda\\delta\n$$\n$$\n\\sigma_{yy} = \\lambda(-\\delta) + 2\\mu(-\\delta) = -(\\lambda+2\\mu)\\delta\n$$\n$$\n\\sigma_{xy} = 2\\mu(0) = 0\n$$\n应力场是均匀的。顶边 $y=1$ 上的竖向反作用面力为：\n$$\n\\bar{t}_y^{\\text{Q1}} = \\sigma_{yy}|_{y=1} = -(\\lambda+2\\mu)\\delta\n$$\n\n### 第三部分：定量比较\n\n我们构造比率 $R(\\lambda,\\mu) = \\frac{|\\bar{t}_y^{\\text{Q1}}|}{|\\bar{t}_y^{\\text{exact}}|}$。\n我们有 $|\\bar{t}_y^{\\text{exact}}| = |-4\\mu\\delta| = 4\\mu\\delta$，因为 $\\mu, \\delta > 0$。\n我们有 $|\\bar{t}_y^{\\text{Q1}}| = |-(\\lambda+2\\mu)\\delta| = (\\lambda+2\\mu)\\delta$，因为 $\\lambda, \\mu, \\delta > 0$。\n\n该比率为：\n$$\nR(\\lambda,\\mu) = \\frac{(\\lambda+2\\mu)\\delta}{4\\mu\\delta}\n$$\n因子 $\\delta$ 被消去：\n$$\nR(\\lambda,\\mu) = \\frac{\\lambda+2\\mu}{4\\mu} = \\frac{\\lambda}{4\\mu} + \\frac{2\\mu}{4\\mu} = \\frac{\\lambda}{4\\mu} + \\frac{1}{2}\n$$\n这个比率量化了锁定的有限元模型对刚度的过高估计。当材料接近不可压缩极限（$\\lambda \\to \\infty$）时，该比率 $R(\\lambda,\\mu)$ 趋于无穷大，这是体积锁定的标志。", "answer": "$$\\boxed{\\frac{\\lambda}{4\\mu} + \\frac{1}{2}}$$", "id": "3609974"}, {"introduction": "理论分析和解析实例揭示了体积锁定的存在，而本实践练习将带您进入实际的数值编程，学习一种经典的解决方法——选择性减缩积分（Selective Reduced Integration, SRI）。您将通过编写有限元代码，对比全积分和选择性减缩积分在模拟近不可压缩悬臂梁弯曲问题时的表现 [@problem_id:3609948]。这个练习不仅能让您掌握一种有效的锁定缓解技术，还能深化对数值积分方案如何影响单元性能的理解。", "problem": "考虑一个二维小应变线性弹性模型，该模型模拟了平面应变状态下的悬臂梁，并使用四节点双线性四边形有限元进行离散化。该梁的长度为 $L$ 米，高度为 $H$ 米，平面外厚度为 $b$ 米。左边缘（$x=0$）被完全夹紧，在自由端（$x=L$）最接近中点高度（$y=H/2$）的节点上施加一个大小为 $P$ 牛顿的垂直向下点荷载。目标是通过比较体积刚度的完全积分与选择性减缩积分，来量化近不可压缩性中的体积闭锁，并计算尖端挠度的相对误差，以小数表示。\n\n基本原理：\n- 小应变运动学：无穷小应变张量定义为 $ \\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$，其中 $\\mathbf{u}$ 是位移场。在二维平面应变设置中，工程应变向量为 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy} = 2 \\varepsilon_{xy}$。\n- 各向同性线性弹性（Lamé 参数）：Cauchy 应力为 $ \\sigma = 2 \\mu \\, \\varepsilon + \\lambda \\, \\text{tr}(\\varepsilon) \\, I$。体积模量 $K$ 和剪切模量 $\\mu$ 通过 $ \\lambda = K - \\tfrac{2}{3} \\mu$ 与 Lamé 参数 $\\lambda$ 相关联。在二维平面应变公式中，使用工程应变向量时，作用于 $[\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}]^T$ 的本构矩阵 $C_{\\text{full}}$ 是\n$$\nC_{\\text{full}} = \\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}.\n$$\n- 选择性减缩积分：将 $C_{\\text{full}}$ 分解为 $C_{\\text{full}} = C_{\\text{dev}} + C_{\\text{vol}}$，其中\n$$\nC_{\\text{dev}} = \\begin{bmatrix}\n2\\mu  0  0 \\\\\n0  2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}, \\quad\nC_{\\text{vol}} = \\begin{bmatrix}\n\\lambda  \\lambda  0 \\\\\n\\lambda  \\lambda  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n使用完全的 $2\\times 2$ Gauss 求积对 $C_{\\text{dev}}$ 进行积分，并使用单元中心的一个 Gauss 点（单点求积）对 $C_{\\text{vol}}$ 进行积分，以减少体积闭锁，同时避免畸变模式的沙漏现象。\n\n梁的参考尖端挠度：\n- 对于承受尖端荷载 $P$ 的细长悬臂梁，其中点高度处的垂直尖端挠度的解析参考值由 Euler–Bernoulli 表达式给出\n$$\n\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I},\n$$\n其中杨氏模量 $E$ 和泊松比 $\\nu$ 由 $K$ 和 $\\mu$ 通过 $ E = \\frac{9 K \\mu}{3 K + \\mu}$ 和 $ \\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$ 得出，截面二次矩为 $ I = \\frac{b H^3}{12}$。以米为单位表示 $\\delta_{\\text{ref}}$。\n\n有限元近似细节：\n- 在平面应变中使用四节点双线性四边形（Q4）等参单元。根据形函数相对于物理坐标的导数，使用等参映射的雅可比矩阵构建应变-位移矩阵 $B$。单元刚度为\n$$\nK_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega,\n$$\n其中 $b$ 是平面外厚度，对于完全积分情况，$C$ 为 $C_{\\text{full}}$；对于选择性减缩积分情况，$C$ 为如上所述积分的分离的 $C_{\\text{dev}}$ 和 $C_{\\text{vol}}$。组装全局刚度矩阵，在左边缘（$x=0$）对 $u_x$ 和 $u_y$ 应用零位移的本质边界条件，在自由端中点高度节点上施加负 $y$ 方向的点荷载 $P$，然后求解所得的线性系统以获得节点位移。\n\n关注量与误差度量：\n- 令 $\\delta_{\\text{FE,full}}$ 为使用完全积分计算的自由端中点高度节点的垂直位移大小，令 $\\delta_{\\text{FE,sel}}$ 为使用选择性减缩积分计算的相应大小。计算相对误差，以小数表示，公式如下：\n$$\ne_{\\text{full}} = \\frac{\\delta_{\\text{FE,full}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}, \\quad\ne_{\\text{sel}} = \\frac{\\delta_{\\text{FE,sel}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}.\n$$\n不允许使用百分号。\n\n测试集：\n- 使用以下参数集，所有物理量均采用国际单位制（SI）：\n    - 情况 1：$L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=4$, $N_y=4$, $\\mu=1.0\\times 10^9$, $K/\\mu = 10$。\n    - 情况 2：$L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=4$, $N_y=4$, $\\mu=1.0\\times 10^9$, $K/\\mu = 1000$。\n    - 情况 3：$L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=8$, $N_y=8$, $\\mu=1.0\\times 10^9$, $K/\\mu = 1000$。\n    - 情况 4：$L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=2$, $N_y=2$, $\\mu=1.0\\times 10^9$, $K/\\mu = 100$。\n\n对于每种情况，您的程序必须计算如上定义的 $e_{\\text{full}}$ 和 $e_{\\text{sel}}$。最终输出格式必须是包含形如 $[[e_{\\text{full,1}},e_{\\text{sel,1}}],[e_{\\text{full,2}},e_{\\text{sel,2}}],[e_{\\text{full,3}},e_{\\text{sel,3}}],[e_{\\text{full,4}},e_{\\text{sel,4}}]]$ 的列表的列表的单行。输出中不允许有任何额外文本。所有角度（如果出现）必须以弧度为单位。所有挠度必须以米为单位计算，所有力必须以牛顿为单位计算。相对误差必须是小数（浮点数）。", "solution": "在尝试任何解决方案之前，需对问题进行验证。\n\n### 步骤1：提取已知条件\n- **模型**：二维小应变线性弹性，平面应变。\n- **几何**：悬臂梁，长度为 $L$，高度为 $H$，平面外厚度为 $b$。\n- **边界条件**：左边缘（$x=0$）完全夹紧（$u_x=0, u_y=0$）。\n- **荷载**：在自由端（$x=L$）最接近中点高度（$y \\approx H/2$）的节点上施加大小为 $P$ 的垂直向下点荷载。\n- **运动学**：无穷小应变张量 $\\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$。工程应变向量为 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy} = 2 \\varepsilon_{xy}$。\n- **本构定律**：各向同性线性弹性，$ \\sigma = 2 \\mu \\, \\varepsilon + \\lambda \\, \\text{tr}(\\varepsilon) \\, I$。\n- **本构矩阵（平面应变）**：\n$$\nC_{\\text{full}} = \\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}\n$$\n- **选择性减缩积分 (SRI) 分解**：$C_{\\text{full}} = C_{\\text{dev}} + C_{\\text{vol}}$，其中\n$$\nC_{\\text{dev}} = \\begin{bmatrix}\n2\\mu  0  0 \\\\\n0  2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix}, \\quad\nC_{\\text{vol}} = \\begin{bmatrix}\n\\lambda  \\lambda  0 \\\\\n\\lambda  \\lambda  0 \\\\\n0  0  0\n\\end{bmatrix}\n$$\n- **积分方案**：对于 SRI，使用完全的 $2 \\times 2$ Gauss 求积对 $C_{\\text{dev}}$ 进行积分，使用单点求积在单元中心对 $C_{\\text{vol}}$ 进行积分。对于完全积分，使用 $2 \\times 2$ Gauss 求积对 $C_{\\text{full}}$ 进行积分。\n- **参考挠度**：Euler–Bernoulli 理论给出 $\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I}$，其中 $I = \\frac{b H^3}{12}$。\n- **材料参数关系**：$E = \\frac{9 K \\mu}{3 K + \\mu}$，$\\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$，以及 $\\lambda = K - \\tfrac{2}{3} \\mu$。\n- **有限元离散化**：四节点双线性四边形（Q4）等参单元，沿长度方向有 $N_x$ 个单元，沿高度方向有 $N_y$ 个单元。\n- **单元刚度**：$K_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega$。\n- **关注量**：$\\delta_{\\text{FE,full}}$（完全积分挠度），$\\delta_{\\text{FE,sel}}$（SRI 挠度）。\n- **误差度量**：$e_{\\text{full}} = \\frac{\\delta_{\\text{FE,full}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}$，$e_{\\text{sel}} = \\frac{\\delta_{\\text{FE,sel}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}$。\n- **测试集**：\n    - 情况 1：$L=1.0, H=0.2, b=0.1, P=1000.0, N_x=4, N_y=4, \\mu=10^9, K/\\mu=10$。\n    - 情况 2：$L=1.0, H=0.2, b=0.1, P=1000.0, N_x=4, N_y=4, \\mu=10^9, K/\\mu=1000$。\n    - 情况 3：$L=1.0, H=0.2, b=0.1, P=1000.0, N_x=8, N_y=8, \\mu=10^9, K/\\mu=1000$。\n    - 情况 4：$L=1.0, H=0.2, b=0.1, P=1000.0, N_x=2, N_y=2, \\mu=10^9, K/\\mu=100$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据、良态且客观。\n1.  **科学合理性**：该问题是有限元法（FEM）在线性弹性中的标准应用，线性弹性是固体力学的基础理论。近不可压缩材料中的体积闭锁现象是一个有据可查的数值伪影，而选择性减缩积分是缓解该问题的经典技术。所提供的材料属性、运动学和单元公式的方程在计算力学中是标准的。本构矩阵的分解虽然是几种可能性中的特定选择，但是是实现像 SRI 这样的 B-bar 类方法的有效且常被讨论的方法。\n2.  **良态性**：该问题是良态的。具有指定边界条件和荷载的悬臂梁设置在线性弹性中允许唯一解。参数和目标都已明确定义，从而可以计算出一组唯一的误差值。\n3.  **完整性与一致性**：问题陈述是自洽的，提供了完整实现所需的所有必要物理参数、几何数据、材料定律、数值程序和定义。测试用例已完全指定。不存在矛盾之处。\n\n### 步骤3：结论与行动\n问题有效。将制定一个合理的解决方案。\n\n### 解决方案\n该问题要求实现一个二维有限元代码，以分析平面应变条件下的悬臂梁，并量化体积闭锁的影响。我们将比较标准完全积分方案和选择性减缩积分方案的结果。\n\n#### 基于原理的设计\n该解决方案基于计算固体力学的以下原理构建：\n\n1.  **等参有限元公式**：我们使用四节点四边形（Q4）单元。每个单元的几何形状从一个标准的方形父域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 映射到物理域 $(x, y)$，使用的双线性形函数与用于插值位移场的形函数相同。这是等参概念的精髓。对于 $i=1, 2, 3, 4$，形函数 $N_i(\\xi, \\eta)$ 如下：\n    $$\n    N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)\n    $$\n2.  **应变-位移矩阵（$B$）**：应变场通过应变-位移矩阵 $B$ 与节点位移相关联。对于一个具有8个自由度（DOFs）的 Q4 单元，$B$ 是一个 $3 \\times 8$ 的矩阵。其分量由形函数的空间导数导出。由于形函数在自然坐标系中定义，因此使用链式法则，其中涉及坐标映射的雅可比矩阵 $J$ 的逆矩阵：\n    $$\n    \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{bmatrix} = J^{-1} \\begin{bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{bmatrix}\n    $$\n    然后将矩阵 $B$ 组装为 $B = [B_1, B_2, B_3, B_4]$，其中每个节点 $i$ 的子矩阵 $B_i$ 为：\n    $$\n    B_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}\n    $$\n3.  **数值积分**：单元刚度矩阵 $K_e$ 通过在单元体积上积分来计算。该积分使用 Gauss 求积进行数值计算。\n    $$\n    K_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega = b \\int_{-1}^{1}\\int_{-1}^{1} B(\\xi, \\eta)^T C B(\\xi, \\eta) \\det(J(\\xi, \\eta)) \\, d\\xi \\, d\\eta\n    $$\n    该积分通过在特定 Gauss 点上计算被积函数的加权和来近似。对于一个 $2 \\times 2$ 的求积法则，有四个点位于 $(\\xi_j, \\eta_j) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，权重为 $w_j = 1$。\n\n4.  **体积闭锁与选择性减缩积分 (SRI)**：对于近不可压缩材料（$\\nu \\to 0.5$，或等效地 $K/\\mu \\gg 1$），体积模量 $K$ 和 Lamé 参数 $\\lambda$ 变得非常大。必须满足不可压缩条件 $\\text{tr}(\\varepsilon) = \\varepsilon_{xx} + \\varepsilon_{yy} \\approx 0$。在标准的 Q4 单元中，应变场不是恒定的。完全积分（$2 \\times 2$ 求积）在四个点上强制执行不可压缩约束，这对于单元的运动学自由度来说过于严格。这种“过度约束”使得单元人为地过刚，这种现象称为体积闭锁。\n\n    SRI 通过“放松”不可压缩约束来缓解此问题。刚度矩阵被分为一个完全积分的偏量部分（$K_{e, \\text{dev}}$）和一个减缩积分的体积部分（$K_{e, \\text{vol}}$）。\n    -   $K_{e, \\text{dev}} = b \\int_{\\Omega_e} B^T C_{\\text{dev}} B \\, d\\Omega$ 使用完全的 $2 \\times 2$ Gauss 求积法则进行评估。这保留了单元精确表示剪切和其他畸变的能力，并防止了伪零能模式（沙漏）。\n    -   $K_{e, \\text{vol}} = b \\int_{\\Omega_e} B^T C_{\\text{vol}} B \\, d\\Omega$ 使用单元中心 $(\\xi, \\eta) = (0, 0)$ 处的一个 Gauss 点（权重 $w = 4$）进行评估。这仅在单元上平均地强制执行不可压缩约束，使其能够更自由地弯曲而不会产生大的能量惩罚。\n\n5.  **组装与求解**：单元刚度矩阵被组装成一个全局刚度矩阵 $K$。通过修改 $K$ 和全局力向量 $F$ 来施加边界条件。在 $x=0$ 处的夹紧条件意味着将该边缘上节点对应的自由度设置为零。将点荷载 $P$ 添加到 $F$ 中相应的条目。求解得到的线性系统 $K U = F$ 以获得节点位移向量 $U$。\n\n#### 计算步骤\n对于每个测试用例：\n1.  **预处理**：给定 $L, H, b, P, N_x, N_y, \\mu, K/\\mu$：\n    -   计算 $K = \\mu \\cdot (K/\\mu)$。\n    -   计算杨氏模量 $E = \\frac{9 K \\mu}{3 K + \\mu}$ 和泊松比 $\\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$。\n    -   计算 Lamé 参数 $\\lambda = K - \\frac{2}{3} \\mu$。\n    -   计算截面二次矩 $I = \\frac{b H^3}{12}$。\n    -   计算参考尖端挠度 $\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I}$。\n    -   构建材料矩阵 $C_{\\text{full}}$、$C_{\\text{dev}}$ 和 $C_{\\text{vol}}$。\n    -   为 $N_x \\times N_y$ 网格生成结构化节点网格和单元连接列表。\n\n2.  **有限元求解器（运行两次：一次用于完全积分，一次用于 SRI）**：\n    -   初始化全局刚度矩阵 $K$ 和力向量 $F$ 为零。\n    -   遍历网格中的所有单元。对于每个单元：\n        -   计算单元刚度矩阵 $K_e$。\n            -   对于完全积分：对项 $B^T C_{\\text{full}} B$ 使用 $2 \\times 2$ Gauss 求积。\n            -   对于选择性减缩积分：将使用 $2 \\times 2$ 求积积分的偏量部分（$B^T C_{\\text{dev}} B$）和使用 $1$ 点求积积分的体积部分（$B^T C_{\\text{vol}} B$）相加。\n        -   根据单元的节点连接将 $K_e$ 组装到全局矩阵 $K$ 中。\n    -   施加点荷载：找到位于 $(x, y) = (L, H/2)$ 的节点，确定其垂直自由度索引，并将 $F$ 中相应的条目设置为 $-P$。\n    -   施加边界条件：识别夹紧边缘（$x=0$）上的所有自由度，并修改 $K$ 和 $F$ 以强制零位移（例如，通过将 $K$ 的对角线条目设置为 1，相应的行/列设置为 0，并强制右侧项为 0）。\n    -   求解线性系统 $K U = F$ 以获得位移向量 $U$。\n    -   提取加载节点的垂直位移 $u_y$。其大小为 $\\delta_{\\text{FE}} = |u_y| = -u_y$。\n\n3.  **后处理**：\n    -   使用计算出的挠度 $\\delta_{\\text{FE,full}}$ 和 $\\delta_{\\text{FE,sel}}$，计算相对于 $\\delta_{\\text{ref}}$ 的相对误差 $e_{\\text{full}}$ 和 $e_{\\text{sel}}$。\n    -   为每个测试用例收集配对 $[e_{\\text{full}}, e_{\\text{sel}}]$。\n\n该过程对问题陈述中提供的四个测试用例中的每一个都进行了实现，并将结果汇总为所需的输出格式。", "answer": "[[-0.916124765958215, -0.01639144426553805],[-0.9984920235967657, -0.007673523530062402],[-0.9996160566895311, -0.0019230571638640723],[-0.9930777937397086, -0.08204642953835619]]", "id": "3609948"}]}