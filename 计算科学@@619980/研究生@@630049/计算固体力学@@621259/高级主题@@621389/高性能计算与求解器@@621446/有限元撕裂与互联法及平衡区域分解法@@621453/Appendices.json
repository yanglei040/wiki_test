{"hands_on_practices": [{"introduction": "FETI 和 BDDC 方法的可扩展性在很大程度上依赖于粗糙空间的正确构建，它负责全局信息的交换。这个实践的核心是研究一个关键的代数工具：投影算子。通过从第一性原理推导此算子，您将深入理解它如何强制实现与粗糙模态的正交性，并分析在有限精度计算下其数值稳定性的表现。", "problem": "考虑一个线性弹性体的非重叠有限元区域分解，其中界面相容性通过拉格朗日乘子在对偶空间中强制施加。在有限元撕裂与连接法 (FETI) 和平衡区域分解法 (BDD) 的对偶格式中，界面算子是（对称半正定的）对偶舒尔补 $F \\in \\mathbb{R}^{n \\times n}$，并且该算子在与粗糙空间（在 $F$-内积意义下）正交的子空间上是正定的。设 $Z \\in \\mathbb{R}^{n \\times m}$ 是界面模式粗糙空间（例如，刚体模式）的一个满列秩基，使得 $Z^{T} F Z \\in \\mathbb{R}^{m \\times m}$ 是可逆的。目标是构造一个作用于对偶变量的线性投影算子 $P \\in \\mathbb{R}^{n \\times n}$，该算子能消除粗糙分量，并在 $F$-内积意义下强制与粗糙模式正交。\n\n从能量正交性的第一性原理和由 $F$ 决定的内积空间中斜投影的定义性质出发，推导投影算子 $P$ 的显式代数表达式，该算子将向量投影到 $\\mathrm{Range}(Z)$ 的 $F$-正交补空间上。证明这个 $P$ 强制实现了粗糙模式正交性，即对于任意对偶向量 $\\lambda \\in \\mathbb{R}^{n}$，其粗糙分量被消除，并且投影后的向量与粗糙空间 $F$-正交。然后，通过分析 $F$-正交性条件对 $Z^{T} F Z$ 逆矩阵的有限精度计算的敏感性，来评估舍入误差下的数值稳定性。\n\n对于一个具体测试，使用\n$$\nF \\;=\\; \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix},\n\\qquad\nZ \\;=\\; \\begin{pmatrix}\n1 \\\\ -1 \\\\ 2\n\\end{pmatrix}.\n$$\n计算精确投影算子 $P$，并验证其相对于由 $Z$ 定义的粗糙空间的消除性和正交性。接下来，定义一个近似投影算子 $P_{r}$，方法是将 $(Z^{T} F Z)^{-1}$ 替换为其舍入值 $a_{r}$，该值由精确标量 $(Z^{T} F Z)^{-1}$ 按标准科学记数法四舍五入到三位有效数字得到，并设\n$$\nP_{r} \\;=\\; I \\;-\\; Z \\, a_{r} \\, Z^{T} F.\n$$\n通过计算标量\n$$\n\\epsilon \\;=\\; \\left\\| Z^{T} F P_{r} \\right\\|_{2}\n$$\n来量化此舍入操作对粗糙正交性的破坏程度。\n将 $\\epsilon$ 的值作为最终答案报告。将最终数值答案四舍五入至四位有效数字。无需物理单位。", "solution": "该问题要求推导一个投影算子 $P$，该算子在一个特定的内积下强制实现与粗糙空间的正交性，然后分析其数值稳定性并进行具体的数值计算。\n\n首先对问题进行验证。\n**步骤 1：提取已知条件**\n- 界面算子：$F \\in \\mathbb{R}^{n \\times n}$，对称半正定，并在与粗糙空间 $F$-正交的子空间上是正定的。\n- 粗糙空间基：$Z \\in \\mathbb{R}^{n \\times m}$，具有满列秩。\n- 粗糙问题矩阵：$Z^{T} F Z$ 是可逆的。\n- 投影算子：$P \\in \\mathbb{R}^{n \\times n}$ 将向量投影到 $\\mathrm{Range}(Z)$ 的 $F$-正交补空间上。\n- 具体测试用例：\n  $$\n  F \\;=\\; \\begin{pmatrix}\n  4  1  0 \\\\\n  1  3  1 \\\\\n  0  1  2\n  \\end{pmatrix},\n  \\qquad\n  Z \\;=\\; \\begin{pmatrix}\n  1 \\\\ -1 \\\\ 2\n  \\end{pmatrix}.\n  $$\n- 近似投影算子：$P_{r} = I - Z a_{r} Z^{T} F$，其中 $a_{r}$ 是将 $(Z^{T} F Z)^{-1}$ 四舍五入到三位有效数字得到的值。\n- 误差度量：$\\epsilon = \\| Z^{T} F P_{r} \\|_{2}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，属于偏微分方程数值方法（区域分解）这一成熟领域。这是一个适定问题，为理论推导和数值计算提供了所有必要的信息。给定的矩阵 $F$ 是对称的。可以证明其特征值均为正，因此它是正定的，这与给定的性质一致。矩阵 $Z$ 具有满列秩。对于给定的数据，乘积 $Z^T F Z$ 是标量 $9$，它是可逆的。该问题是客观、完整、一致且数学上可验证的。\n\n**步骤 3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n**第 1 部分：投影算子 $P$ 的推导**\n设 $\\mathbb{R}^n$ 是对偶变量空间。问题在该空间上定义了一个内积（或半内积，因为 $F$ 是半正定的），形式为 $\\langle u, v \\rangle_F = u^T F v$，对于任意 $u, v \\in \\mathbb{R}^n$。粗糙空间是子空间 $\\mathcal{Z} = \\mathrm{Range}(Z) = \\{ Z\\alpha \\mid \\alpha \\in \\mathbb{R}^m \\}$。\n\n我们寻求一个投影到 $\\mathcal{Z}$ 的 $F$-正交补空间（记为 $\\mathcal{Z}^{\\perp_F}$）上的投影算子 $P$。任何向量 $\\lambda \\in \\mathbb{R}^n$ 都可以分解为一个在 $\\mathcal{Z}$ 中的分量和一个在 $\\mathcal{Z}^{\\perp_F}$ 中的分量：\n$$ \\lambda = \\lambda_{\\mathcal{Z}} + \\lambda_{\\perp_F} $$\n其中 $\\lambda_{\\mathcal{Z}} \\in \\mathcal{Z}$ 且 $\\lambda_{\\perp_F} \\in \\mathcal{Z}^{\\perp_F}$。投影算子 $P$ 作用于 $\\lambda$ 上，得到其在 $F$-正交补空间中的分量：$P\\lambda = \\lambda_{\\perp_F}$。\n\n由于 $\\lambda_{\\mathcal{Z}} \\in \\mathcal{Z}$，它可以写成 $\\lambda_{\\mathcal{Z}} = Z\\alpha$ 的形式，其中 $\\alpha \\in \\mathbb{R}^m$ 是某个系数向量。投影后的向量则为 $\\lambda_{\\perp_F} = \\lambda - \\lambda_{\\mathcal{Z}} = \\lambda - Z\\alpha$。\n\n$\\lambda_{\\perp_F}$ 的定义性质是它与粗糙空间 $\\mathcal{Z}$ 中的每一个向量都 $F$-正交。如果 $\\lambda_{\\perp_F}$ 与 $\\mathcal{Z}$ 的所有基向量（即 $Z$ 的列向量）都 $F$-正交，则此条件满足。该条件表示为：\n$$ \\langle Z\\beta, \\lambda - Z\\alpha \\rangle_F = 0, \\quad \\forall \\beta \\in \\mathbb{R}^m $$\n使用内积的定义将其写出：\n$$ (Z\\beta)^T F (\\lambda - Z\\alpha) = 0 $$\n$$ \\beta^T Z^T F (\\lambda - Z\\alpha) = 0 $$\n由于这对所有 $\\beta \\in \\mathbb{R}^m$ 都必须成立，所以向量项必须为零：\n$$ Z^T F (\\lambda - Z\\alpha) = 0 $$\n$$ Z^T F \\lambda - Z^T F Z \\alpha = 0 $$\n$$ Z^T F Z \\alpha = Z^T F \\lambda $$\n问题陈述矩阵 $Z^T F Z$ 是可逆的。因此我们可以解出 $\\alpha$：\n$$ \\alpha = (Z^T F Z)^{-1} Z^T F \\lambda $$\n将这个 $\\alpha$ 的表达式代回 $\\lambda_{\\mathcal{Z}}$ 的公式中，得到 $\\lambda$ 在粗糙空间上的投影：\n$$ \\lambda_{\\mathcal{Z}} = Z\\alpha = Z (Z^T F Z)^{-1} Z^T F \\lambda $$\n因此，到粗糙空间上的投影算子（我们称之为 $P_{\\mathcal{Z}}$）是 $P_{\\mathcal{Z}} = Z (Z^T F Z)^{-1} Z^T F$。这是一个斜投影算子。\n\n所求的投影算子 $P$ 是投影到补空间上的，因此由 $P = I - P_{\\mathcal{Z}}$ 给出。\n$$ P = I - Z (Z^T F Z)^{-1} Z^T F $$\n\n**第 2 部分：性质证明**\n我们必须证明对于任意 $\\lambda \\in \\mathbb{R}^{n}$：\n1. 粗糙分量被消除。粗糙空间中的任何向量 $v = Z\\gamma$ 都会被投影到零。\n   $$\n   P v = P (Z\\gamma) = \\left(I - Z (Z^T F Z)^{-1} Z^T F\\right) (Z\\gamma) = Z\\gamma - Z (Z^T F Z)^{-1} (Z^T F Z) \\gamma = Z\\gamma - Z I_m \\gamma = Z\\gamma - Z\\gamma = 0\n   $$\n   该性质得证。\n\n2. 投影后的向量 $P\\lambda$ 与粗糙空间 $\\mathcal{Z}$ 是 $F$-正交的。我们检查对于任意 $\\gamma \\in \\mathbb{R}^m$ 是否有 $\\langle Z\\gamma, P\\lambda \\rangle_F = 0$。这等价于检查是否有 $Z^T F (P\\lambda) = 0$。\n   $$\n   Z^T F (P\\lambda) = Z^T F \\left(I - Z (Z^T F Z)^{-1} Z^T F\\right) \\lambda = \\left(Z^T F - (Z^T F Z) (Z^T F Z)^{-1} Z^T F\\right) \\lambda = (Z^T F - I_m Z^T F) \\lambda = (Z^T F - Z^T F) \\lambda = 0\n   $$\n   该性质得证。\n\n**第 3 部分：数值稳定性评估**\n投影结果的 $F$-正交性依赖于精确的抵消 $Z^T F - (Z^T F Z) (Z^T F Z)^{-1} Z^T F = 0$。在有限精度算法中，我们计算一个近似逆，记为 $\\tilde{G} \\approx G = (Z^T F Z)^{-1}$。近似投影算子为 $\\tilde{P} = I - Z \\tilde{G} Z^T F$。正交性条件的残差为：\n$$ Z^T F \\tilde{P} = Z^T F - (Z^T F Z) \\tilde{G} Z^T F = (Z^T F Z)G Z^T F - (Z^T F Z) \\tilde{G} Z^T F = (Z^T F Z) (G - \\tilde{G}) Z^T F = - (Z^T F Z) (\\delta G) Z^T F $$\n其中 $\\delta G = \\tilde{G} - G$ 是逆矩阵的误差。这表明正交性的损失与粗糙矩阵 $Z^T F Z$ 的逆矩阵的误差成正比，并且还被 $Z^T F Z$ 本身左乘。这种破坏的量级将对粗糙矩阵的条件数 $\\kappa(Z^T F Z)$ 敏感。一个大的条件数会放大逆矩阵计算中的微小舍入误差，导致 $F$-正交性的显著损失。\n\n**第 4 部分：具体数值计算**\n给定矩阵：\n$$\nF \\;=\\; \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix},\n\\qquad\nZ \\;=\\; \\begin{pmatrix}\n1 \\\\ -1 \\\\ 2\n\\end{pmatrix}.\n$$\n首先，我们计算投影算子的各个组成部分。\n$$\nF Z = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(-1) + 0(2) \\\\ 1(1) + 3(-1) + 1(2) \\\\ 0(1) + 1(-1) + 2(2) \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\\\ 3 \\end{pmatrix}\n$$\n$$\nZ^T F = (FZ)^T = \\begin{pmatrix} 3  0  3 \\end{pmatrix}\n$$\n接下来，我们计算标量形式的粗糙问题矩阵 $Z^T F Z$：\n$$\nZ^T F Z = \\begin{pmatrix} 3  0  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\end{pmatrix} = 3(1) + 0(-1) + 3(2) = 9\n$$\n精确的逆是 $(Z^T F Z)^{-1} = \\frac{1}{9}$。\n精确的投影算子是 $P = I - \\frac{1}{9} Z Z^T F$。\n\n问题要求使用逆的舍入值。精确值为 $a = \\frac{1}{9} = 0.1111... = 1.111... \\times 10^{-1}$。\n将其四舍五入到三位有效数字得到近似值 $a_r$：\n$$\na_r = 1.11 \\times 10^{-1} = 0.111\n$$\n近似投影算子是 $P_r = I - Z a_r Z^T F$。\n\n我们需要通过计算 $\\epsilon = \\| Z^T F P_r \\|_{2}$ 来量化正交性的破坏程度。\n首先计算行向量 $Z^T F P_r$：\n$$\nZ^T F P_r = Z^T F (I - Z a_r Z^T F) = Z^T F - (Z^T F Z) a_r Z^T F\n$$\n代入已知值：\n$$\nZ^T F P_r = Z^T F - (9) a_r Z^T F = (1 - 9 a_r) Z^T F\n$$\n标量前置因子是：\n$$\n1 - 9 a_r = 1 - 9(0.111) = 1 - 0.999 = 0.001\n$$\n所以，行向量是：\n$$\nZ^T F P_r = 0.001 \\times \\begin{pmatrix} 3  0  3 \\end{pmatrix} = \\begin{pmatrix} 0.003  0  0.003 \\end{pmatrix}\n$$\n最后，我们计算其欧几里得（$L_2$）范数：\n$$\n\\epsilon = \\| \\begin{pmatrix} 0.003  0  0.003 \\end{pmatrix} \\|_2 = \\sqrt{0.003^2 + 0^2 + 0.003^2}\n$$\n$$\n\\epsilon = \\sqrt{2 \\times (0.003)^2} = \\sqrt{2} \\times 0.003\n$$\n使用值 $\\sqrt{2} \\approx 1.41421356...$：\n$$\n\\epsilon \\approx 1.41421356 \\times 0.003 = 0.0042426408...\n$$\n将最终答案四舍五入到四位有效数字，得到：\n$$\n\\epsilon \\approx 0.004243\n$$", "answer": "$$\\boxed{0.004243}$$", "id": "3565928"}, {"introduction": "在实际的大规模计算中，子区域问题通常通过迭代方法进行非精确求解，这与理想的理论公式有所不同。本练习旨在弥合理论与实践之间的差距。您将推导出一个关键的理论界，它量化了子区域求解的精度（由容差 $\\tau$ 控制）与全局预处理系统收敛性能（由条件数度量）之间的直接关系。", "problem": "考虑在有界单连通多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的小应变线性弹性平衡问题，边界 $\\partial \\Omega$ 上施加齐次狄利克雷边界条件。该问题涉及体力密度 $\\boldsymbol{f}$、柯西应力 $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ 和运动应变 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$，其中 $\\mathbb{C}$ 是各向同性材料的四阶弹性张量，其拉梅参数 $(\\lambda,\\mu)$ 满足 $\\mu > 0$ 和 $\\lambda + \\mu > 0$。其弱形式为：寻求 $\\boldsymbol{u} \\in [H_{0}^{1}(\\Omega)]^{2}$，使得\n$$\n\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\,\\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\Omega \\quad \\text{对所有 } \\boldsymbol{v} \\in [H_{0}^{1}(\\Omega)]^{2} \\text{ 成立}。\n$$\n在尺寸为 $h$ 的拟一致网格上进行协调有限元离散，可得到一个对称正定（SPD）的刚度矩阵 $\\boldsymbol{K} \\in \\mathbb{R}^{n \\times n}$，使得离散平衡方程为 $\\boldsymbol{K}\\boldsymbol{u}=\\boldsymbol{f}$。\n\n将 $\\Omega$ 划分为 $N$ 个不重叠的子域 $\\{\\Omega_{i}\\}_{i=1}^{N}$，其特征直径为 $H$，并考虑一种对偶-原始有限元撕裂与连接（FETI-DP）界面格式。该格式通过在对偶界面自由度上施加拉格朗日乘子和在粗糙空间上施加原始约束来强制实现连续性。由此产生的对偶空间中的SPD界面问题可表示为\n$$\n\\boldsymbol{S}\\boldsymbol{\\lambda} = \\boldsymbol{g},\n$$\n其中 $\\boldsymbol{S}$ 是由子域上的局部狄利克雷问题导出的组装舒尔补算子，$\\boldsymbol{g}$ 是对偶右端向量。一个平衡区域分解（BDD）类型的预条件子 $\\boldsymbol{M}$ 由局部逆 $\\boldsymbol{K}_{i}^{-1}$、缩放和一个精确粗糙校正构建而成，从而得到预处理算子\n$$\n\\boldsymbol{P} := \\boldsymbol{M}^{1/2}\\boldsymbol{S}\\boldsymbol{M}^{1/2}.\n$$\n对于此类方法，一个经过充分检验的关于精确预条件子的界给出了谱条件数\n$$\n\\kappa_{0} := \\frac{\\lambda_{\\max}(\\boldsymbol{P})}{\\lambda_{\\min}(\\boldsymbol{P})} \\leq C\\left(1 + \\ln\\!\\left(\\frac{H}{h}\\right)\\right)^{2},\n$$\n其中常数 $C$ 对于形状规则的子域和适当的粗糙空间，独立于 $h$ 和 $H$。\n\n在实践中，每个局部子域的逆 $\\boldsymbol{K}_{i}^{-1}$ 是通过一个迭代求解器非精确地施加的。该求解器在统一的局部能量范数相对容差 $\\tau \\in (0,1)$ 下终止，生成一个算子 $\\widehat{\\boldsymbol{K}}_{i}^{-1}$，使得对于子域迹算子值域内的所有子域界面向量 $\\boldsymbol{z}$，\n$$\n\\left| \\left( \\left(\\boldsymbol{K}_{i}^{-1} - \\widehat{\\boldsymbol{K}}_{i}^{-1}\\right)\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}} \\right| \\leq \\tau \\left( \\boldsymbol{K}_{i}^{-1}\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}},\n$$\n其中 $(\\boldsymbol{x},\\boldsymbol{y})_{\\boldsymbol{K}_{i}} := \\boldsymbol{x}^{\\top}\\boldsymbol{K}_{i}\\boldsymbol{y}$。由 $\\{\\widehat{\\boldsymbol{K}}_{i}^{-1}\\}$ 和相同的粗糙校正组装而成的全局非精确预条件子 $\\widehat{\\boldsymbol{M}}$ 是SPD的，但随着内部求解的改变，每次迭代都会变化，因此需要使用灵活的克雷洛夫方法，如灵活共轭梯度法（FCG），以在使用可变预处理时保持收敛性。\n\n假设精确粗糙校正和缩放保持不变，上述局部容差模型可以得到 $\\widehat{\\boldsymbol{M}}$ 和 $\\boldsymbol{M}$ 之间的一致谱等价性，并因此得到精确和非精确预处理算子之间的一致谱等价性。请从第一性原理出发，以弱形式、子域舒尔补和上述能量范数容差模型为起点，推导有效条件数 $\\kappa_{\\mathrm{eff}} := \\lambda_{\\max}(\\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{S}\\widehat{\\boldsymbol{M}}^{1/2}) / \\lambda_{\\min}(\\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{S}\\widehat{\\boldsymbol{M}}^{1/2})$ 的一个用 $\\kappa_{0}$ 和 $\\tau$ 表示的紧上界。\n\n然后，考虑一个二维正方形域 $\\Omega$，它被分割成 $N=16$ 个相等的正方形子域，且 $H/h = 8$，取 $C = 2$。设目标有效条件数为 $\\kappa^{*} = 30$。使用您推导出的界，计算使得 $\\kappa_{\\mathrm{eff}} \\leq \\kappa^{*}$ 成立的最大容许容差 $\\tau_{\\max}$。将您的答案四舍五入到四位有效数字。将 $\\tau_{\\max}$ 表示为一个无量纲量。", "solution": "用户提供了一个在计算固体力学领域中科学上有效且适定的问题，具体涉及非精确区域分解方法的分析。我将开始进行求解。\n\n问题分为两部分：第一，推导非精确预处理系统的有效条件数 $\\kappa_{\\mathrm{eff}}$ 的一个紧上界，该界用精确条件数 $\\kappa_{0}$ 和局部求解器容差 $\\tau$ 表示；第二，应用此界来计算一个特定的最大容差 $\\tau_{\\max}$。\n\n### 第一部分：有效条件数界的推导\n\n目标是找到 $\\kappa_{\\mathrm{eff}} := \\lambda_{\\max}(\\widehat{\\boldsymbol{P}})/\\lambda_{\\min}(\\widehat{\\boldsymbol{P}})$ 的一个上界，其中 $\\widehat{\\boldsymbol{P}} = \\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{S}\\widehat{\\boldsymbol{M}}^{1/2}$ 是非精确预处理算子。推导过程首先在精确预条件子 $\\boldsymbol{M}$ 和非精确预条件子 $\\widehat{\\boldsymbol{M}}$ 之间建立一个谱关系，然后利用这个关系来界定 $\\widehat{\\boldsymbol{P}}$ 的特征值。\n\n1.  **分析局部容差条件**\n\n子域求解的非精确性由能量范数相对容差 $\\tau$ 控制。对于每个子域 $\\Omega_i$，近似逆 $\\widehat{\\boldsymbol{K}}_{i}^{-1}$ 满足：\n$$\n\\left| \\left( \\left(\\boldsymbol{K}_{i}^{-1} - \\widehat{\\boldsymbol{K}}_{i}^{-1}\\right)\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}} \\right| \\leq \\tau \\left( \\boldsymbol{K}_{i}^{-1}\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}}\n$$\n其中 $(\\boldsymbol{x},\\boldsymbol{y})_{\\boldsymbol{K}_{i}} := \\boldsymbol{x}^{\\top}\\boldsymbol{K}_{i}\\boldsymbol{y}$。我们展开两侧，假设矩阵 $\\boldsymbol{K}_{i}$ 和 $\\widehat{\\boldsymbol{K}}_{i}^{-1}$ 是对称的，这对于这些方法是标准的。\n右侧 (RHS) 为：\n$$\n\\tau \\left( \\boldsymbol{K}_{i}^{-1}\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}} = \\tau (\\boldsymbol{K}_{i}^{-1}\\boldsymbol{z})^{\\top} \\boldsymbol{K}_{i} \\boldsymbol{z} = \\tau \\boldsymbol{z}^{\\top} \\boldsymbol{K}_{i}^{-1} \\boldsymbol{K}_{i} \\boldsymbol{z} = \\tau \\boldsymbol{z}^{\\top}\\boldsymbol{z}\n$$\n左侧 (LHS) 绝对值内的项为：\n$$\n\\left( (\\boldsymbol{K}_{i}^{-1} - \\widehat{\\boldsymbol{K}}_{i}^{-1})\\boldsymbol{z}, \\boldsymbol{z} \\right)_{\\boldsymbol{K}_{i}} = ((\\boldsymbol{K}_{i}^{-1} - \\widehat{\\boldsymbol{K}}_{i}^{-1})\\boldsymbol{z})^{\\top} \\boldsymbol{K}_{i} \\boldsymbol{z} = \\boldsymbol{z}^{\\top}(\\boldsymbol{K}_{i}^{-1} - \\widehat{\\boldsymbol{K}}_{i}^{-1})\\boldsymbol{K}_{i}\\boldsymbol{z} = \\boldsymbol{z}^{\\top}(\\boldsymbol{I} - \\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i})\\boldsymbol{z}\n$$\n因此，容差条件变为：\n$$\n|\\boldsymbol{z}^{\\top}(\\boldsymbol{I} - \\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i})\\boldsymbol{z}| \\leq \\tau \\boldsymbol{z}^{\\top}\\boldsymbol{z}\n$$\n这等价于双边不等式：\n$$\n-\\tau \\boldsymbol{z}^{\\top}\\boldsymbol{z} \\leq \\boldsymbol{z}^{\\top}\\boldsymbol{z} - \\boldsymbol{z}^{\\top}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}\\boldsymbol{z} \\leq \\tau \\boldsymbol{z}^{\\top}\\boldsymbol{z}\n$$\n重新整理得到算子 $\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}$ 的二次型的界：\n$$\n(1 - \\tau) \\boldsymbol{z}^{\\top}\\boldsymbol{z} \\leq \\boldsymbol{z}^{\\top}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}\\boldsymbol{z} \\leq (1 + \\tau) \\boldsymbol{z}^{\\top}\\boldsymbol{z}\n$$\n这表明算子 $\\boldsymbol{K}_{i}^{1/2}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}^{1/2}$ (其与 $\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}$ 相似且对称) 的特征值包含在区间 $[1-\\tau, 1+\\tau]$ 内。这对对称算子 $\\boldsymbol{K}_{i}^{1/2}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}^{1/2}$ 意味着以下谱不等式：\n$$\n(1-\\tau)\\boldsymbol{I} \\preceq \\boldsymbol{K}_{i}^{1/2}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{K}_{i}^{1/2} \\preceq (1+\\tau)\\boldsymbol{I}\n$$\n通过变量替换 $\\boldsymbol{y} = \\boldsymbol{K}_{i}^{1/2}\\boldsymbol{x}$，这等价于逆算子本身的谱等价性：\n$$\n(1-\\tau)\\boldsymbol{x}^{\\top}\\boldsymbol{K}_{i}^{-1}\\boldsymbol{x} \\leq \\boldsymbol{x}^{\\top}\\widehat{\\boldsymbol{K}}_{i}^{-1}\\boldsymbol{x} \\leq (1+\\tau)\\boldsymbol{x}^{\\top}\\boldsymbol{K}_{i}^{-1}\\boldsymbol{x}\n$$\n对任意在适当空间中的向量 $\\boldsymbol{x}$ 均成立。\n\n2.  **全局预条件子等价性**\n\n全局预条件子 $\\boldsymbol{M}$ 和 $\\widehat{\\boldsymbol{M}}$ 分别由局部逆算子 $\\{\\boldsymbol{K}_i^{-1}\\}$ 和 $\\{\\widehat{\\boldsymbol{K}}_i^{-1}\\}$ 组装而成，再加上一个相同的粗糙校正项。加性组装过程保持了谱界。因此，局部等价关系可扩展到全局预条件子：\n$$\n(1-\\tau)\\boldsymbol{v}^{\\top}\\boldsymbol{M}\\boldsymbol{v} \\leq \\boldsymbol{v}^{\\top}\\widehat{\\boldsymbol{M}}\\boldsymbol{v} \\leq (1+\\tau)\\boldsymbol{v}^{\\top}\\boldsymbol{M}\\boldsymbol{v}\n$$\n对对偶空间中的任意向量 $\\boldsymbol{v}$ 均成立。这可以紧凑地写为 $(1-\\tau)\\boldsymbol{M} \\preceq \\widehat{\\boldsymbol{M}} \\preceq (1+\\tau)\\boldsymbol{M}$。\n\n3.  **界定非精确预处理算子的特征值**\n\n精确和非精确预处理算子分别为 $\\boldsymbol{P} = \\boldsymbol{M}^{1/2}\\boldsymbol{S}\\boldsymbol{M}^{1/2}$ 和 $\\widehat{\\boldsymbol{P}} = \\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{S}\\widehat{\\boldsymbol{M}}^{1/2}$。我们通过一个合同变换将它们联系起来：\n$$\n\\widehat{\\boldsymbol{P}} = \\widehat{\\boldsymbol{M}}^{1/2} \\boldsymbol{M}^{-1/2} (\\boldsymbol{M}^{1/2}\\boldsymbol{S}\\boldsymbol{M}^{1/2}) \\boldsymbol{M}^{-1/2} \\widehat{\\boldsymbol{M}}^{1/2} = (\\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{M}^{-1/2}) \\boldsymbol{P} (\\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{M}^{-1/2})^{\\top}\n$$\n设 $\\lambda$ 为 $\\widehat{\\boldsymbol{P}}$ 的一个特征值。相应的瑞利商为：\n$$\n\\lambda = \\frac{\\boldsymbol{y}^{\\top}\\widehat{\\boldsymbol{P}}\\boldsymbol{y}}{\\boldsymbol{y}^{\\top}\\boldsymbol{y}} = \\frac{\\boldsymbol{y}^{\\top}(\\widehat{\\boldsymbol{M}}^{1/2}\\boldsymbol{M}^{-1/2}) \\boldsymbol{P} (\\boldsymbol{M}^{-1/2}\\widehat{\\boldsymbol{M}}^{1/2})\\boldsymbol{y}}{\\boldsymbol{y}^{\\top}\\boldsymbol{y}}\n$$\n令 $\\boldsymbol{x} = (\\boldsymbol{M}^{-1/2}\\widehat{\\boldsymbol{M}}^{1/2})\\boldsymbol{y}$。则 $\\boldsymbol{y} = (\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{M}^{1/2})\\boldsymbol{x}$。\n$$\n\\lambda = \\frac{\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x}}{\\boldsymbol{x}^{\\top}(\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{M}^{1/2})(\\boldsymbol{M}^{1/2}\\widehat{\\boldsymbol{M}}^{-1/2})\\boldsymbol{x}} = \\frac{\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x}}{\\boldsymbol{x}^{\\top}\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{M}\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{x}}\n$$\n根据预条件子的等价性 $(1-\\tau)\\boldsymbol{M} \\preceq \\widehat{\\boldsymbol{M}} \\preceq (1+\\tau)\\boldsymbol{M}$，我们可以界定分母中的算子。对该关系取逆可得：\n$$\n\\frac{1}{1+\\tau}\\boldsymbol{M}^{-1} \\preceq \\widehat{\\boldsymbol{M}}^{-1} \\preceq \\frac{1}{1-\\tau}\\boldsymbol{M}^{-1}\n$$\n将此应用于分母的算子 $\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{M}\\widehat{\\boldsymbol{M}}^{-1/2}$（其与 $\\boldsymbol{M}\\widehat{\\boldsymbol{M}}^{-1}$ 相似），其特征值被界定在 $[1/(1+\\tau), 1/(1-\\tau)]$ 内。因此：\n$$\n\\frac{1}{1+\\tau}\\boldsymbol{x}^{\\top}\\boldsymbol{x} \\leq \\boldsymbol{x}^{\\top}\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{M}\\widehat{\\boldsymbol{M}}^{-1/2}\\boldsymbol{x} \\leq \\frac{1}{1-\\tau}\\boldsymbol{x}^{\\top}\\boldsymbol{x}\n$$\n现在我们可以界定特征值 $\\lambda$：\n$$\n\\lambda_{\\max}(\\widehat{\\boldsymbol{P}}) = \\max_{\\boldsymbol{x}} \\frac{\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x}}{\\boldsymbol{x}^{\\top}(\\widehat{\\boldsymbol{M}}^{-1}\\boldsymbol{M})\\boldsymbol{x}} \\leq \\frac{\\max (\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x})}{\\min (\\boldsymbol{x}^{\\top}(\\widehat{\\boldsymbol{M}}^{-1}\\boldsymbol{M})\\boldsymbol{x})} = \\frac{\\lambda_{\\max}(\\boldsymbol{P})\\boldsymbol{x}^{\\top}\\boldsymbol{x}}{\\frac{1}{1+\\tau}\\boldsymbol{x}^{\\top}\\boldsymbol{x}} = (1+\\tau)\\lambda_{\\max}(\\boldsymbol{P})\n$$\n$$\n\\lambda_{\\min}(\\widehat{\\boldsymbol{P}}) = \\min_{\\boldsymbol{x}} \\frac{\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x}}{\\boldsymbol{x}^{\\top}(\\widehat{\\boldsymbol{M}}^{-1}\\boldsymbol{M})\\boldsymbol{x}} \\geq \\frac{\\min (\\boldsymbol{x}^{\\top}\\boldsymbol{P}\\boldsymbol{x})}{\\max (\\boldsymbol{x}^{\\top}(\\widehat{\\boldsymbol{M}}^{-1}\\boldsymbol{M})\\boldsymbol{x})} = \\frac{\\lambda_{\\min}(\\boldsymbol{P})\\boldsymbol{x}^{\\top}\\boldsymbol{x}}{\\frac{1}{1-\\tau}\\boldsymbol{x}^{\\top}\\boldsymbol{x}} = (1-\\tau)\\lambda_{\\min}(\\boldsymbol{P})\n$$\n\n4.  **界定有效条件数**\n\n有效条件数 $\\kappa_{\\mathrm{eff}}$ 是 $\\widehat{\\boldsymbol{P}}$ 的最大特征值与最小特征值之比。使用上面推导出的界：\n$$\n\\kappa_{\\mathrm{eff}} = \\frac{\\lambda_{\\max}(\\widehat{\\boldsymbol{P}})}{\\lambda_{\\min}(\\widehat{\\boldsymbol{P}})} \\leq \\frac{(1+\\tau)\\lambda_{\\max}(\\boldsymbol{P})}{(1-\\tau)\\lambda_{\\min}(\\boldsymbol{P})} = \\frac{1+\\tau}{1-\\tau} \\frac{\\lambda_{\\max}(\\boldsymbol{P})}{\\lambda_{\\min}(\\boldsymbol{P})}\n$$\n注意到 $\\kappa_{0} = \\lambda_{\\max}(\\boldsymbol{P}) / \\lambda_{\\min}(\\boldsymbol{P})$，我们得到该界的最终表达式：\n$$\n\\kappa_{\\mathrm{eff}} \\leq \\frac{1+\\tau}{1-\\tau} \\kappa_{0}\n$$\n\n### 第二部分：最大容差的计算\n\n题目要求我们找到对于给定的参数，使得 $\\kappa_{\\mathrm{eff}} \\leq \\kappa^{*}$ 成立的最大容许容差 $\\tau_{\\max}$。必须使用推导出的界来保证此条件。\n问题为精确条件数 $\\kappa_{0}$ 提供了一个界：\n$$\n\\kappa_{0} \\leq C\\left(1 + \\ln\\left(\\frac{H}{h}\\right)\\right)^{2}\n$$\n为确保对于任何实现这些参数的具体网格，$\\kappa_{\\mathrm{eff}} \\leq \\kappa^{*}$ 都成立，我们必须使用 $\\kappa_0$ 的最坏情况，也就是其上界。我们将此界记为 $\\kappa_{0, \\text{bound}}$。\n给定 $C=2$ 和 $H/h=8$：\n$$\n\\kappa_{0, \\text{bound}} = 2\\left(1 + \\ln(8)\\right)^{2} = 2\\left(1 + 3\\ln(2)\\right)^{2}\n$$\n对 $\\kappa_{\\mathrm{eff}}$ 的要求变为：\n$$\n\\kappa_{\\mathrm{eff}} \\leq \\frac{1+\\tau}{1-\\tau} \\kappa_{0} \\leq \\frac{1+\\tau}{1-\\tau} \\kappa_{0, \\text{bound}} \\leq \\kappa^{*}\n$$\n我们必须对最右侧的不等式求解 $\\tau$：\n$$\n\\frac{1+\\tau}{1-\\tau} \\leq \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}}\n$$\n由于 $\\tau \\in (0,1)$，因此 $1-\\tau > 0$。我们可以直接相乘而不改变不等号方向。\n$$\n1+\\tau \\leq \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}}(1-\\tau) = \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}} - \\tau \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}}\n$$\n$$\n\\tau \\left(1 + \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}}\\right) \\leq \\frac{\\kappa^{*}}{\\kappa_{0, \\text{bound}}} - 1\n$$\n$$\n\\tau \\left(\\frac{\\kappa_{0, \\text{bound}} + \\kappa^{*}}{\\kappa_{0, \\text{bound}}}\\right) \\leq \\frac{\\kappa^{*} - \\kappa_{0, \\text{bound}}}{\\kappa_{0, \\text{bound}}}\n$$\n$$\n\\tau \\leq \\frac{\\kappa^{*} - \\kappa_{0, \\text{bound}}}{\\kappa^{*} + \\kappa_{0, \\text{bound}}}\n$$\n因此，最大容许容差 $\\tau_{\\max}$ 为：\n$$\n\\tau_{\\max} = \\frac{\\kappa^{*} - \\kappa_{0, \\text{bound}}}{\\kappa^{*} + \\kappa_{0, \\text{bound}}}\n$$\n现在，我们代入数值：$\\kappa^{*} = 30$ 和 $\\kappa_{0, \\text{bound}} = 2(1 + \\ln(8))^{2}$。\n首先，计算 $\\kappa_{0, \\text{bound}}$：\n$$\n\\ln(8) \\approx 2.0794415\n$$\n$$\n\\kappa_{0, \\text{bound}} \\approx 2(1 + 2.0794415)^{2} = 2(3.0794415)^{2} \\approx 2(9.48296) \\approx 18.96592\n$$\n现在计算 $\\tau_{\\max}$：\n$$\n\\tau_{\\max} \\approx \\frac{30 - 18.96592}{30 + 18.96592} = \\frac{11.03408}{48.96592} \\approx 0.225345\n$$\n四舍五入到四位有效数字，我们得到 $\\tau_{\\max} \\approx 0.2253$。", "answer": "$$\\boxed{0.2253}$$", "id": "3565918"}, {"introduction": "当应用于具有显著材料非均匀性的问题时，标准的、固定的粗糙空间可能不足以保证算法的鲁棒性。这个实践将引导您探索一种先进的自适应策略，这是现代 BDDC 方法的一个标志。通过一个简化的谱模型，您将学习如何利用局部广义特征值问题来识别并添加“坏”的界面模式到粗糙空间，从而确保方法在面对材料属性剧烈变化时的收敛性。", "problem": "您需要实现并分析一种自适应的、基于边和面上局部广义特征值问题的、具有预设阈值 $ \\tau $ 的“基于约束的均衡区域分解 (BDDC)”粗空间，该模型应用于一个具有分层刚度的三维 ($3$D) 通道。目标是预测所需的最小附加原始约束数量，以保证预处理算子的条件数 $ \\kappa $ 满足 $ \\kappa \\le \\tau $。最终程序必须为一组给定的测试用例计算这个数量，这些测试用例指定了子域刚度分布和每个界面组件上的基线谱内容。\n\n从线性弹性的变分形式和经典的子结构框架开始：全局有限元平衡方程为 $ \\mathbf{K} \\mathbf{u} = \\mathbf{f} $，其中 $ \\mathbf{K} $ 是由各子域组装而成的对称正定刚度矩阵。在消去子域内部自由度后，界面舒尔补系统以界面迹 $ \\mathbf{u}_{\\Gamma} $ 的形式表示。在 BDDC 预条件子中，通过在选定的界面泛函上强制施加连续性约束来引入一个粗（原始）空间。在自适应 BDDC 中，通过在每个界面组件 $ c $（边或面）上求解一个比较“跳跃”能量和“连续”能量的局部广义特征值问题来选择额外的约束，这通常可用舒尔补能量内积来表示。具体来说，对于每个组件 $ c $，求解一个形式如下的广义特征值问题\n$$\n\\mathbf{S}_c^{\\Delta} \\boldsymbol{\\psi} = \\lambda \\, \\mathbf{S}_c^{\\Pi} \\boldsymbol{\\psi},\n$$\n其中 $ \\mathbf{S}_c^{\\Delta} $ 度量了不连续模式的能量惩罚，而 $ \\mathbf{S}_c^{\\Pi} $ 度量了相应连续对应部分的能量贡献。特征值 $ \\lambda $ 大于阈值 $ \\tau $ 的模式被选为要添加的原始约束，从而保证全局预处理算子的条件数有一个由 $ \\tau $ 的常数倍所限制的上界；在下文指定的简化模型中，此常数被视为 $ 1 $。因此，“为所有 $ \\lambda > \\tau $ 的局部模式添加约束”这一选择规则可确保 $ \\kappa \\le \\tau $。\n\n为使计算具体且自洽，同时保留科学真实性，我们采用以下简化但广泛使用的谱缩放模型：对于一个三维分层通道，其中每个子域 $ i $ 具有均匀的杨氏模量 $ E_i $（单位为帕斯卡），相邻子域 $ i $ 和 $ j $ 之间的界面组件 $ c $ 上的局部广义特征值可以近似为\n$$\n\\lambda_{c,k} \\approx \\rho_c \\, \\mu_{c,k}, \\quad \\text{其中} \\quad \\rho_c = \\frac{\\max(E_i,E_j)}{\\min(E_i,E_j)},\n$$\n其中 $ \\{ \\mu_{c,k} \\}_k $ 是在相同几何界面上、单位对比度的均匀介质（即 $ E_i = E_j $）的基线特征值，而 $ \\rho_c $ 是与 $ c $ 相关的刚度对比度。该模型捕捉了在分层结构中，材料对比度对有问题的界面模式的放大作用，并且与已有的自适应 BDDC/FETI 理论一致，在这些理论中，局部瑞利商随系数跳跃而缩放。您应假设所提供的每个 $ \\mu_{c,k} $ 已经排除了始终存在的角点约束；因此，“附加约束”仅指标准角点集之外的自适应约束。\n\n任务。对于下方的每个测试用例：\n- 对于每个连接相邻子域 $ (i,j) $ 的界面组件 $ c $，使用所提供的子域杨氏模量 $ \\{ E_i \\} $ 计算对比度 $ \\rho_c $。\n- 使用给定的基线谱 $ \\{ \\mu_{c,k} \\}_k $，构建近似的局部特征值 $ \\lambda_{c,k} = \\rho_c \\, \\mu_{c,k} $。\n- 将严格超过阈值 $ \\tau $ 的所有 $ \\lambda_{c,k} $ 的总数确定为最小附加约束数。等于 $ \\tau $ 的特征值不需要添加约束。\n- 为每个测试用例返回一个整数：所有界面组件上附加约束的总数。\n\n物理单位。杨氏模量值 $ E_i $ 以帕斯卡为单位。输出中不要求任何带物理单位的量；只返回约束的整数计数。\n\n角度单位。不涉及角度。\n\n最终输出格式。您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔的整数列表，列表中的结果应与下方测试用例的顺序一致。例如，如果有三个测试用例，计算出的计数分别为 $ a $、$ b $ 和 $ c $，则输出必须是 $ [a,b,c] $。\n\n测试套件。实现您的程序以解决以下五个测试用例：\n\n- 测试用例 $ 1 $ (均匀通道，无对比度):\n  - 子域与模量 (帕斯卡): $ E = [10^9, 10^9, 10^9] $.\n  - 界面组件 $ c $ (相邻对) 与基线谱:\n    - 对 $ (0,1) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.5, 0.2 \\} $.\n    - 对 $ (1,2) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.4, 0.1 \\} $.\n  - 阈值: $ \\tau = 0.6 $.\n\n- 测试用例 $ 2 $ (中间层具有高刚度的三层通道):\n  - 子域与模量 (帕斯卡): $ E = [10^9, 10^{12}, 10^9] $.\n  - 界面组件与基线谱与测试用例 $ 1 $ 相同。\n  - 阈值: $ \\tau = 300 $.\n\n- 测试用例 $ 3 $ (与测试用例2相同，临界阈值):\n  - 子域与模量 (帕斯卡): $ E = [10^9, 10^{12}, 10^9] $.\n  - 界面组件与基线谱与测试用例 $ 1 $ 相同。\n  - 阈值: $ \\tau = 400 $.\n\n- 测试用例 $ 4 $ (顶层/底层具有不同刚度的 2x1x2 排列):\n  - 子域与模量 (帕斯卡): $ E = [10^6, 10^6, 10^9, 10^9] $.\n  - 界面组件与基线谱:\n    - 对 $ (0,2) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.3, 0.25, 0.1 \\} $.\n    - 对 $ (1,3) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.3, 0.25, 0.1 \\} $.\n    - 对 $ (0,1) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.6, 0.55, 0.4 \\} $.\n    - 对 $ (2,3) $: $ \\{ \\mu_{c,k} \\} = \\{ 0.6, 0.55, 0.4 \\} $.\n  - 阈值: $ \\tau = 0.5 $.\n\n- 测试用例 $ 5 $ (与测试用例4相同，非常宽松的阈值):\n  - 子域与模量 (帕斯卡): $ E = [10^6, 10^6, 10^9, 10^9] $.\n  - 界面组件与基线谱与测试用例 $ 4 $ 相同。\n  - 阈值: $ \\tau = 10^4 $.\n\n您的程序必须硬编码上述测试套件，应用所描述的模型和选择规则，并按指定格式将最终结果打印为单行。", "solution": "我们从每个子域具有均匀、各向同性材料属性的小应变状态下的线性弹性理论开始。有限元半离散系统可以写为 $ \\mathbf{K} \\mathbf{u} = \\mathbf{f} $，其中 $ \\mathbf{K} $ 是对称正定的。在子结构化公式中，每个子域的内部自由度被静态凝聚，从而在全局界面迹 $ \\mathbf{u}_{\\Gamma} $ 上产生舒尔补系统，\n$$\n\\mathbf{S} \\, \\mathbf{u}_{\\Gamma} = \\mathbf{g},\n$$\n其中 $ \\mathbf{S} $ 在由 $ \\mathbf{K} $ 导出的能量内积中是对称正定的。基于约束的均衡区域分解 (BDDC) 通过在一个界面泛函子集（例如，角点、边/面上的平均值）上强制施加原始连续性，并将其余部分拆分为局部求解的对偶部分，来构造预条件子。预条件子的效率由预处理算子的条件数 $ \\kappa $ 来衡量。\n\n自适应 BDDC 通过比较不连续和连续能量度量的局部广义特征值问题来识别“坏”的界面模式，从而丰富原始空间。在每个界面组件 $ c $（边或面）上，定义算子 $ \\mathbf{S}_c^{\\Delta} $ 和 $ \\mathbf{S}_c^{\\Pi} $，分别表示跳跃模式的能量和其对应连续模式的能量，然后求解\n$$\n\\mathbf{S}_c^{\\Delta} \\boldsymbol{\\psi} = \\lambda \\, \\mathbf{S}_c^{\\Pi} \\boldsymbol{\\psi}.\n$$\n与模式 $ \\boldsymbol{\\psi} $ 相关的局部瑞利商是 $ \\lambda = \\dfrac{\\langle \\boldsymbol{\\psi}, \\mathbf{S}_c^{\\Delta} \\boldsymbol{\\psi} \\rangle}{\\langle \\boldsymbol{\\psi}, \\mathbf{S}_c^{\\Pi} \\boldsymbol{\\psi} \\rangle} $。自适应 BDDC 和有限元撕裂与互联 (FETI) 方法的既有理论表明，当使用与所有特征值超过阈值 $ \\tau $ 的特征向量相关的约束来扩充原始空间时，预处理后的全局算子的条件数满足 $ \\kappa \\le C \\, \\tau $ 形式的界，其中 $ C $ 是一个良性常数，弱依赖于形状正则性和缩放选择。在我们的模型中以及为了此预测任务的目的，我们设置 $ C = 1 $，因此选择所有 $ \\lambda > \\tau $ 的局部模式可保证 $ \\kappa \\le \\tau $。\n\n为了将局部谱与分层三维通道中的材料非均匀性联系起来，考虑一对相邻子域 $ (i,j) $，其均匀杨氏模量分别为 $ E_i $ 和 $ E_j $。对于均匀介质（$ E_i = E_j $），固定几何界面上的界面广义特征值用 $ \\{ \\mu_{c,k} \\}_k $ 表示。当存在刚度跳跃时，跳跃模式的局部能量会按对比度的比例放大。一个广泛使用且经过充分检验的近似是\n$$\n\\lambda_{c,k} \\approx \\rho_c \\, \\mu_{c,k}, \\quad \\text{其中} \\quad \\rho_c = \\frac{\\max(E_i,E_j)}{\\min(E_i,E_j)}.\n$$\n这源于舒尔补项相对于分段常数系数的缩放行为，以及观察到瑞利商与跳跃能量中的主导系数线性缩放，而分母与代表性的连续能量缩放，从而产生一个跨界面系数比的因子。该模型保留了模式的顺序，因为乘以一个正常数 $ \\rho_c $ 不会改变 $ \\mu_{c,k} $ 之间的相对大小。\n\n自适应选择规则。使用上述近似，为了使所有剩余的非约束模式都满足 $ \\lambda_{c,k} \\le \\tau $，在界面 $ c $ 上需要添加的最小约束数等于满足 $ \\lambda_{c,k} > \\tau $ 的 $ k $ 的数量，即集合 $ \\{ k : \\rho_c \\, \\mu_{c,k} > \\tau \\} $ 的基数。对所有界面组件 $ c $ 求和，即可得到附加约束的总数。特征值为 $ \\lambda_{c,k} = \\tau $ 的模式不被添加，因为它们已经满足不等式 $ \\lambda \\le \\tau $。最小性是成立的，因为当最大的 $ \\lambda $ 模式被移除时，剩余的最大特征值单调递减，并且在乘法缩放模型下，精确移除那些满足 $ \\rho_c \\mu_{c,k} > \\tau $ 的模式是强制所有剩余 $ \\lambda \\le \\tau $ 的充要条件。\n\n算法。对于每个测试用例：\n1. 对于每个连接子域 $ (i,j) $ 的界面组件 $ c $，计算 $ \\rho_c = \\dfrac{\\max(E_i,E_j)}{\\min(E_i,E_j)} $。\n2. 对于 $ c $ 上的每个基线特征值 $ \\mu_{c,k} $，计算 $ \\lambda_{c,k} = \\rho_c \\, \\mu_{c,k} $。\n3. 统计那些满足 $ \\lambda_{c,k} > \\tau $ 的特征值。对所有 $ c $ 求和，以获得附加约束的总数。\n4. 返回此总数作为该测试用例的结果。\n\n现在我们将此算法应用于每个给定的测试用例。\n\n- 测试用例 $ 1 $:\n  - $ E = [10^9, 10^9, 10^9] $。对于 $ (0,1) $ 和 $ (1,2) $ 两对， $ \\rho_c = 1 $。\n  - 对 $ (0,1) $: $ \\lambda = \\{ 1 \\cdot 0.5, 1 \\cdot 0.2 \\} = \\{ 0.5, 0.2 \\} $。当 $ \\tau = 0.6 $ 时，没有一个超过 $ \\tau $。计数 $ 0 $。\n  - 对 $ (1,2) $: $ \\lambda = \\{ 0.4, 0.1 \\} $，没有一个超过 $ \\tau $。计数 $ 0 $。\n  - 附加约束总数: $ 0 $。\n\n- 测试用例 $ 2 $:\n  - $ E = [10^9, 10^{12}, 10^9] $。对于 $ (0,1) $ 和 $ (1,2) $ 两对， $ \\rho_c = \\dfrac{10^{12}}{10^9} = 10^3 $。\n  - 对 $ (0,1) $: $ \\lambda = \\{ 10^3 \\cdot 0.5, 10^3 \\cdot 0.2 \\} = \\{ 500, 200 \\} $。当 $ \\tau = 300 $ 时，只有 $ 500 > 300 $。计数 $ 1 $。\n  - 对 $ (1,2) $: $ \\lambda = \\{ 10^3 \\cdot 0.4, 10^3 \\cdot 0.1 \\} = \\{ 400, 100 \\} $。只有 $ 400 > 300 $。计数 $ 1 $。\n  - 附加约束总数: $ 2 $。\n\n- 测试用例 $ 3 $:\n  - 与测试用例 $ 2 $ 相同的 $ E $ 和 $ \\rho_c = 10^3 $。\n  - 对 $ (0,1) $: $ \\lambda = \\{ 500, 200 \\} $。当 $ \\tau = 400 $ 时，只有 $ 500 > 400 $。计数 $ 1 $。\n  - 对 $ (1,2) $: $ \\lambda = \\{ 400, 100 \\} $。这里 $ 400 = \\tau $ 不计数，$ 100 < \\tau $。计数 $ 0 $。\n  - 附加约束总数: $ 1 $。\n\n- 测试用例 $ 4 $:\n  - $ E = [10^6, 10^6, 10^9, 10^9] $。\n  - 对 $ (0,2) $: $ \\rho = \\dfrac{10^9}{10^6} = 10^3 $。$ \\lambda = \\{ 300, 250, 100 \\} $。当 $ \\tau = 0.5 $ 时，所有三个都超过。计数 $ 3 $。\n  - 对 $ (1,3) $: 与上面相同。计数 $ 3 $。\n  - 对 $ (0,1) $: $ \\rho = 1 $，$ \\lambda = \\{ 0.6, 0.55, 0.4 \\} $。超过 $ 0.5 $ 的是 $ 0.6 $ 和 $ 0.55 $。计数 $ 2 $。\n  - 对 $ (2,3) $: 与前一个相同。计数 $ 2 $。\n  - 附加约束总数: $ 3 + 3 + 2 + 2 = 10 $。\n\n- 测试用例 $ 5 $:\n  - 与测试用例 $ 4 $ 相同的 $ E $ 和界面。\n  - 阈值 $ \\tau = 10^4 $。测试用例 $ 4 $ 的所有 $ \\lambda $ 值最大为 $ 300 $，因此没有一个超过 $ 10^4 $。附加约束总数: $ 0 $。\n\n因此，按顺序，预期的输出是整数列表 $ [0, 2, 1, 10, 0] $。程序应使用所描述的算法计算这些值，并以 $ [0,2,1,10,0] $ 的精确格式将其作为单行打印。\n\n这种基于原理的设计将计算过程与控制自适应 BDDC 的基于能量的广义特征值问题直接联系起来，使用了与系数跳跃敏感性一致的对比度驱动缩放，并为每个测试用例产生一个可量化和可验证的整数输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef count_added_constraints(E, interfaces, tau):\n    \"\"\"\n    Count the minimal number of added adaptive BDDC constraints to ensure kappa = tau,\n    under the spectral scaling model lambda = rho * mu for each interface component.\n    \n    Parameters:\n        E : list of floats\n            Young's modulus per subdomain (Pa).\n        interfaces : list of dicts\n            Each dict has:\n                'pair': (i, j) subdomain indices adjacent at the interface component.\n                'mu': list of baseline eigenvalues for the component in a homogeneous medium.\n        tau : float\n            Eigenvalue threshold.\n    Returns:\n        int : total number of added constraints across all interface components.\n    \"\"\"\n    total = 0\n    for comp in interfaces:\n        i, j = comp['pair']\n        Ei, Ej = E[i], E[j]\n        # Contrast ratio\n        rho = max(Ei, Ej) / min(Ei, Ej)\n        # Count modes that exceed tau after scaling\n        for mu in comp['mu']:\n            lam = rho * mu\n            if lam > tau:\n                total += 1\n    return total\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            'E': [1e9, 1e9, 1e9],\n            'interfaces': [\n                {'pair': (0, 1), 'mu': [0.5, 0.2]},\n                {'pair': (1, 2), 'mu': [0.4, 0.1]},\n            ],\n            'tau': 0.6\n        },\n        # Test Case 2\n        {\n            'E': [1e9, 1e12, 1e9],\n            'interfaces': [\n                {'pair': (0, 1), 'mu': [0.5, 0.2]},\n                {'pair': (1, 2), 'mu': [0.4, 0.1]},\n            ],\n            'tau': 300.0\n        },\n        # Test Case 3\n        {\n            'E': [1e9, 1e12, 1e9],\n            'interfaces': [\n                {'pair': (0, 1), 'mu': [0.5, 0.2]},\n                {'pair': (1, 2), 'mu': [0.4, 0.1]},\n            ],\n            'tau': 400.0\n        },\n        # Test Case 4\n        {\n            'E': [1e6, 1e6, 1e9, 1e9],\n            'interfaces': [\n                {'pair': (0, 2), 'mu': [0.3, 0.25, 0.1]},\n                {'pair': (1, 3), 'mu': [0.3, 0.25, 0.1]},\n                {'pair': (0, 1), 'mu': [0.6, 0.55, 0.4]},\n                {'pair': (2, 3), 'mu': [0.6, 0.55, 0.4]},\n            ],\n            'tau': 0.5\n        },\n        # Test Case 5\n        {\n            'E': [1e6, 1e6, 1e9, 1e9],\n            'interfaces': [\n                {'pair': (0, 2), 'mu': [0.3, 0.25, 0.1]},\n                {'pair': (1, 3), 'mu': [0.3, 0.25, 0.1]},\n                {'pair': (0, 1), 'mu': [0.6, 0.55, 0.4]},\n                {'pair': (2, 3), 'mu': [0.6, 0.55, 0.4]},\n            ],\n            'tau': 1e4\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case['E']\n        interfaces = case['interfaces']\n        tau = case['tau']\n        result = count_added_constraints(E, interfaces, tau)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3565891"}]}