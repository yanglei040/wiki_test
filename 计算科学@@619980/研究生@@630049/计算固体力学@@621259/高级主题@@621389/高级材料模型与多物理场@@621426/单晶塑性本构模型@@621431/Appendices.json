{"hands_on_practices": [{"introduction": "在深入研究复杂的计算模型之前，首先建立对模型中物理量之间关系的直观理解至关重要。本实践旨在通过量纲分析，从基于位错运动的基本关系中推导出一个特征时间尺度。这个练习 ([@problem_id:3552438]) 链接了微观尺度上的物理量（如位错密度和柏氏矢量）与宏观本构响应，有助于加深对模型参数物理意义的理解。", "problem": "一个具有单一活动滑移系的单晶体承受 Cauchy 应力张量 $\\boldsymbol{\\sigma}$，使得滑移系上的分切应力为 $\\tau = \\boldsymbol{s} \\cdot \\boldsymbol{\\sigma} \\, \\boldsymbol{m}$，其中 $\\boldsymbol{s}$ 是滑移方向的单位向量，$\\boldsymbol{m}$ 是滑移面的单位法向量。假设该系统上的塑性滑移速率遵循基于位错的 Orowan 关系 $\\dot{\\gamma} = \\rho \\, b \\, v$，其中 $\\rho$ 是总的可动位错线密度，$b$ 是 Burgers 向量的大小，$v$ 是沿滑移方向的平均位错速度。假设一个应力控制的迁移率定律 $v(\\tau,g) = M \\, g \\, \\varphi(\\tau/g)$，其中 $g$ 是当前的滑移阻力（与切应力具有相同的物理量纲），$M$ 是一个常数迁移率系数，$\\varphi$ 是一个无量纲函数，满足 $\\varphi(1)=1$ 且仅依赖于比值 $\\tau/g$。\n\n从这些陈述出发，仅使用单位一致性和标度论证，构建一个特征时间尺度 $t_{\\star}$，使得无量纲滑移速率 $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$ 简化为 $\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})$，其中 $\\widehat{\\tau} = \\tau/g$。推导 $t_{\\star}$ 关于 $\\rho$、$b$、$M$ 和 $g$ 的显式表达式。将任何时间尺度以秒表示。最终答案必须是 $t_{\\star}$ 的单一闭合形式解析表达式。", "solution": "该问题要求为一个单晶塑性模型推导一个特征时间尺度 $t_{\\star}$。推导需基于单位一致性和标度论证，并从所提供的本构关系出发。\n\n首先，我们陈述给定的物理定律。给定滑移系上的塑性滑移速率 $\\dot{\\gamma}$ 由 Orowan 关系描述：\n$$\n\\dot{\\gamma} = \\rho \\, b \\, v\n$$\n其中 $\\rho$ 是可动位错密度，$b$ 是 Burgers 向量的大小，$v$ 是平均位错速度。\n\n位错速度 $v$ 本身是分切应力 $\\tau$ 和滑移阻力 $g$ 的函数。给定的迁移率定律是：\n$$\nv(\\tau, g) = M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n此处，$M$ 是迁移率系数，$\\varphi$ 是归一化应力 $\\tau/g$ 的无量纲函数。\n\n目标是找到一个特征时间尺度 $t_{\\star}$，使得定义为 $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$ 的无量纲滑移速率可以纯粹地表示为无量纲应力 $\\widehat{\\tau} = \\tau/g$ 的函数。具体来说，目标关系是：\n$$\n\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})\n$$\n它可以写作：\n$$\n\\dot{\\gamma} \\, t_{\\star} = \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n为了找到 $t_{\\star}$ 的表达式，我们可以将给定的定律相互代入。我们首先将位错速度 $v$ 的表达式代入 Orowan 关系中的 $\\dot{\\gamma}$：\n$$\n\\dot{\\gamma} = \\rho \\, b \\, \\left(M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\\right)\n$$\n这个方程可以通过组合项来重新整理：\n$$\n\\dot{\\gamma} = (\\rho \\, b \\, M \\, g) \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n现在，我们将这个推导出的 $\\dot{\\gamma}$ 表达式与目标无量纲形式进行比较。目标形式可以重新整理以表示 $\\dot{\\gamma}$：\n$$\n\\dot{\\gamma} = \\frac{1}{t_{\\star}} \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n要使这两个 $\\dot{\\gamma}$ 的表达式对于任何非平凡函数 $\\varphi$ 都等效，乘以函数 $\\varphi(\\tau/g)$ 的系数必须相等。因此，我们可以令相应的项相等：\n$$\n\\rho \\, b \\, M \\, g = \\frac{1}{t_{\\star}}\n$$\n\n对此方程求解特征时间尺度 $t_{\\star}$，得到所需的表达式：\n$$\nt_{\\star} = \\frac{1}{\\rho \\, b \\, M \\, g}\n$$\n\n为确保此结果的正确性，我们进行量纲分析以确认 $t_{\\star}$ 确实具有时间的单位。令 $[X]$ 表示物理量 $X$ 以质量（$M_{\\text{dim}}$）、长度（$L$）和时间（$T$）为基本量纲的物理量纲。\n\n*   滑移速率 $\\dot{\\gamma}$ 是剪应变率，而剪应变是无量纲的。因此，$[\\dot{\\gamma}] = T^{-1}$。\n*   位错密度 $\\rho$ 是单位体积内的位错线长度。因此，$[\\rho] = L/L^3 = L^{-2}$。\n*   Burgers 向量的大小 $b$ 是一个长度。因此，$[b] = L$。\n*   位错速度 $v$ 是单位时间内的长度。因此，$[v] = L T^{-1}$。\n*   Orowan 关系在量纲上是一致的：$[\\dot{\\gamma}] = [\\rho][b][v] \\implies T^{-1} = (L^{-2})(L)(L T^{-1}) = T^{-1}$。\n*   分切应力 $\\tau$ 和滑移阻力 $g$ 具有应力（力/面积）的量纲。力的量纲是 $M_{\\text{dim}} L T^{-2}$，所以应力的量纲是 $M_{\\text{dim}} L^{-1} T^{-2}$。因此，$[\\tau] = [g] = M_{\\text{dim}} L^{-1} T^{-2}$。\n*   函数 $\\varphi$ 及其参数 $\\tau/g$ 都是无量纲的。\n*   从迁移率定律 $v = M g \\varphi(\\tau/g)$，我们可以找到迁移率系数 $M$ 的量纲：\n    $$[M] = \\frac{[v]}{[g]} = \\frac{L T^{-1}}{M_{\\text{dim}} L^{-1} T^{-2}} = M_{\\text{dim}}^{-1} L^2 T$$\n*   现在，我们检查我们推导的 $t_{\\star}$ 表达式的量纲：\n    $$[t_{\\star}] = \\frac{1}{[\\rho][b][M][g]} = \\frac{1}{(L^{-2})(L)(M_{\\text{dim}}^{-1} L^{2} T)(M_{\\text{dim}} L^{-1} T^{-2})}$$\n    合并分母中每个基本量纲的指数：\n    *   质量 ($M_{\\text{dim}}$): $-1 + 1 = 0$\n    *   长度 ($L$): $-2 + 1 + 2 - 1 = 0$\n    *   时间 ($T$): $1 - 2 = -1$\n    所以，分母的量纲是 $[ \\rho \\, b \\, M \\, g ] = T^{-1}$。\n*   因此，$t_{\\star}$ 的量纲是：\n    $$[t_{\\star}] = \\frac{1}{T^{-1}} = T$$\n这证实了推导出的 $t_{\\star}$ 表达式具有时间的物理量纲。在国际单位制（SI）中，其单位是秒。题目要求“将任何时间尺度以秒表示”，通过推导出一个量纲上为时间的表达式，这个要求得到了满足。\n\n提供的条件 $\\varphi(1)=1$ 可以作为一个额外的检验。当 $\\tau=g$ 时，我们有 $\\widehat{\\tau} = 1$。目标形式给出 $\\widehat{\\dot{\\gamma}} = \\varphi(1) = 1$，这意味着 $\\dot{\\gamma} t_{\\star} = 1$，或者 $\\dot{\\gamma} = 1/t_{\\star}$。根据本构定律，当 $\\tau=g$ 时，速度为 $v = M g \\varphi(1) = M g$。于是滑移速率为 $\\dot{\\gamma} = \\rho b v = \\rho b M g$。将这两个 $\\dot{\\gamma}$ 的结果相等，得到 $1/t_{\\star} = \\rho b M g$，这再次得出 $t_{\\star} = 1/(\\rho b M g)$。这加强了结果的有效性。\n\n最终表达式仅依赖于材料参数 $\\rho$、$b$、$M$ 和内部状态变量 $g$，符合要求。", "answer": "$$\n\\boxed{\\frac{1}{\\rho \\, b \\, M \\, g}}\n$$", "id": "3552438"}, {"introduction": "计算力学研究的一个基石是通过与已知的解析解进行比较来验证代码的正确性。本实践将指导您推导并实现一个简化单滑移模型的解析解，用于验证简单剪切载荷下的材料响应。通过完成这项任务 ([@problem_id:3552456])，您将获得实现和验证本构模型的宝贵经验，为后续开发更复杂的模型奠定坚实的基础。", "problem": "考虑一个承受简剪切的单晶体的小应变、率无关、单滑移本构模型。目标是在单调加载下，通过一个解析闭式解来验证一个计算实现。材料响应被限制在小应变范围内，应力为柯西应力 (Cauchy stress)。使用以下基本原理和定义。\n\n1. 运动学和弹性：在大小为 $\\gamma$ 的工程简剪切作用下，小应变张量的非零分量为 $e_{xy} = \\gamma/2$。对于剪切模量为 $G$ 的各向同性线弹性，剪切应力为 $\\sigma_{xy} = 2 G e^{e}_{xy}$，其中 $e^{e}_{xy}$ 是弹性剪切应变。在纯剪切加载中，由于 $e_{xy} = e^{e}_{xy} + e^{p}_{xy}$，该式可简化为 $\\sigma_{xy} = G \\gamma - 2 G e^{p}_{xy}$。\n\n2. 滑移引起的塑性应变：对于一个单位滑移方向为 $m$、单位滑移面法线为 $n$（其中 $m \\perp n$）的单滑移系，塑性应变张量为 $e^{p} = \\gamma_{p} \\operatorname{sym}(m \\otimes n)$，其中 $\\gamma_{p}$ 是塑性滑移量，$\\operatorname{sym}(m \\otimes n) = \\frac{1}{2} \\left(m \\otimes n + n \\otimes m\\right)$。因此，塑性剪切应变分量为 $e^{p}_{xy} = \\gamma_{p} S_{xy}$，其中 $S_{xy} = \\frac{m_{x} n_{y} + m_{y} n_{x}}{2}$。\n\n3. 分解剪切应力：滑移系上的分解剪切应力为 $\\tau = m \\cdot \\sigma \\cdot n = m_{i} \\sigma_{ij} n_{j}$。对于纯剪切应力 $\\sigma_{xy}$，该式简化为 $\\tau = 2 S_{xy} \\sigma_{xy}$。\n\n4. 流动法则和硬化：带有线性各向同性硬化的率无关流动法则是 $|\\tau| = \\tau_{0} + h \\, \\gamma_{p}^{\\mathrm{eq}}$，其中 $\\tau_{0}$ 是初始临界分解剪切应力， $h$ 是硬化模量，对于单滑移，$\\gamma_{p}^{\\mathrm{eq}} = |\\gamma_{p}|$。在单调加载下，$\\gamma_{p}$ 的符号与 $\\tau$ 的符号匹配，并且当满足屈服准则时，滑移条件被激活。\n\n任务：从上述基础出发，推导并实现关于 $\\sigma_{xy}$ 的解析分段解，该解是施加的工程剪切应变 $\\gamma$、剪切模量 $G$、滑移方向 $(m, n)$、初始临界分解剪切应力 $\\tau_{0}$ 和硬化模量 $h$ 的函数。\n\n要求：\n- 通过强制分解剪切应力与流动法则的平衡，推导屈服剪切应变 $\\gamma_{y}$ 和塑性滑移 $\\gamma_{p}$ 作为输入参数的函数。\n- 对于在施加应力下滑移系不承受分解剪切应力（$S_{xy} = 0$）的加载情况，确保解析解简化为纯弹性响应。\n- 在一个程序中实现推导出的分段公式，为下面的每个测试用例计算 $\\sigma_{xy}$。\n\n物理和数值单位：\n- 所有应力必须以帕斯卡（Pascals）表示。\n- 工程剪切应变 $\\gamma$ 是无量纲的。\n- 最终输出必须以帕斯卡表示，为浮点数。\n\n测试套件：\n使用以下参数集，以国际单位制（SI）表示。在所有情况下，材料剪切模量为 $G = 25 \\times 10^{9}$ Pa，初始临界分解剪切应力为 $\\tau_{0} = 50 \\times 10^{6}$ Pa。滑移方向和法线以 $\\mathbb{R}^{3}$ 中的单位向量给出，$h$ 的单位是帕斯卡。\n1. 情况 A（屈服后，正剪切）：$h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.01$。\n2. 情况 B（屈服前）：$h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.001$。\n3. 情况 C（理想塑性，屈服后）：$h = 0$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.05$。\n4. 情况 D（在此加载状态下，滑移方向不活动）：$h = 200 \\times 10^{6}$ Pa, $m = \\left(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0\\right)$, $n = \\left(\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2}, 0\\right)$, $\\gamma = 0.01$。\n5. 情况 E（屈服后，负剪切）：$h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = -0.01$。\n\n程序输出规范：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$]”）。\n- 该列表必须按 A、B、C、D、E 的顺序包含五个情况的 $\\sigma_{xy}$ 计算值，单位为帕斯卡。", "solution": "问题陈述经评估有效。它在科学上基于连续介质力学和晶体塑性理论的原理，问题设定良好，目标明确，数据充分，并使用客观、正式的语言进行表述。所提供的参数和条件是自洽且物理上合理的。因此，我们可以进行推导和求解。\n\n目标是推导剪切应力 $\\sigma_{xy}$ 作为所施加工程剪切应变 $\\gamma$ 的函数的解析分段表达式。该推导基于所提供的一套在小应变条件下率无关单滑移模型的本构方程。\n\n控制方程如下：\n1.  总应变 $e_{xy}$分解为弹性 $e^e_{xy}$ 和塑性 $e^p_{xy}$ 部分：$e_{xy} = e^e_{xy} + e^p_{xy}$。总剪切应变由 $e_{xy} = \\gamma / 2$ 给出。\n2.  弹性应力-应变关系（剪切胡克定律）：$\\sigma_{xy} = 2 G e^e_{xy}$，其中 $G$ 是剪切模量。结合应变分解，我们得到 $\\sigma_{xy} = 2 G (e_{xy} - e^p_{xy}) = G \\gamma - 2 G e^p_{xy}$。\n3.  由滑移产生的塑性应变：塑性剪切应变分量 $e^p_{xy}$ 通过 $e^p_{xy} = \\gamma_p S_{xy}$ 与特定滑移系上的塑性滑移量 $\\gamma_p$ 相关，其中 $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$ 是由滑移方向向量 $m$ 和滑移面法向向量 $n$ 推导出的简剪切几何因子。\n4.  分解剪切应力：驱动滑移的应力是分解剪切应力 $\\tau$，对于纯剪切应力状态 $\\sigma_{xy}$，其由 $\\tau = 2 S_{xy} \\sigma_{xy}$ 给出。\n5.  屈服准则和流动法则（Kuhn-Tucker 条件）：仅当分解剪切应力达到临界值时才会发生塑性滑移。对于线性各向同性硬化，这由 $|\\tau| = \\tau_0 + h \\gamma_p^{\\mathrm{eq}}$ 给出，其中 $\\tau_0$ 是初始临界分解剪切应力， $h$ 是硬化模量，对于单滑移，$\\gamma_p^{\\mathrm{eq}} = |\\gamma_p|$。如果 $|\\tau|  \\tau_0 + h |\\gamma_p|$，则滑移不活动（$\\gamma_p=0$）。对于单调加载，塑性滑移的符号遵循分解剪切应力的符号：$\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$。\n\n我们现在可以通过考虑弹性和塑性区域来推导分段解。\n\n**1. 弹性区域**\n在弹性区域，没有塑性滑移，因此 $\\gamma_p = 0$。\n- 根据方程（3），塑性应变为零：$e^p_{xy} = 0$。\n- 根据方程（2），应力-应变关系是线性的：$\\sigma_{xy} = G \\gamma$。\n- 此时分解剪切应力为 $\\tau = 2 S_{xy} \\sigma_{xy} = 2 S_{xy} G \\gamma$。\n只要未满足屈服准则，即 $|\\tau| \\le \\tau_0$，该区域就成立。代入 $\\tau$ 的表达式：\n$$|2 S_{xy} G \\gamma| \\le \\tau_0$$\n$$|\\gamma| \\le \\frac{\\tau_0}{2 G |S_{xy}|}$$\n这定义了屈服剪切应变 $\\gamma_y$：\n$$\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$$\n因此，对于施加的剪切应变 $|\\gamma| \\le \\gamma_y$，材料响应是纯弹性的，且 $\\sigma_{xy} = G \\gamma$。\n\n如果 $S_{xy}=0$，会出现一个特殊情况。在这种情况下，对于任何施加的应力，分解剪切应力 $\\tau = 2 S_{xy} \\sigma_{xy} = 0$。由于 $\\tau_0 > 0$，屈服准则 $|\\tau| \\ge \\tau_0$ 永远无法满足。因此，$\\gamma_p$ 始终为零，响应对于所有 $\\gamma$ 值都是纯弹性的：$\\sigma_{xy} = G \\gamma$。\n\n**2. 塑性区域**\n当 $|\\gamma| > \\gamma_y$（且 $S_{xy} \\neq 0$）时，发生塑性滑移。方程组必须联立求解。对于单调加载，屈服条件是激活的：\n$$|\\tau| = \\tau_0 + h |\\gamma_p|$$\n让我们建立符号约定。对于从零应力状态开始的单调加载，我们可以假设 $\\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(\\gamma)$。分解剪切应力的符号是 $\\operatorname{sgn}(\\tau) = \\operatorname{sgn}(2 S_{xy} \\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$。流动法则要求 $\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$。\n因此，$\\gamma_p = |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$。\n\n应力表达式（方程2）可以使用方程（3）展开：\n$$\\sigma_{xy} = G \\gamma - 2 G S_{xy} \\gamma_p = G \\gamma - 2 G S_{xy} \\left( |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma) \\right)$$\n$$\\sigma_{xy} = G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p|$$\n激活的屈服准则可以写为 $\\tau = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\tau)$。代入 $\\tau = 2 S_{xy} \\sigma_{xy}$ 和 $\\operatorname{sgn}(\\tau)$：\n$$2 S_{xy} \\sigma_{xy} = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$$\n两边除以 $2S_{xy}$ 得到 $\\sigma_{xy}$ 的第二个表达式：\n$$\\sigma_{xy} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)}{2 S_{xy}} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\n将两个 $\\sigma_{xy}$ 的表达式相等：\n$$G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p| = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\n为了解出 $|\\gamma_p|$，我们可以将整个方程乘以 $\\operatorname{sgn}(\\gamma)$（因为 $|\\operatorname{sgn}(\\gamma)|=1$）：\n$$G |\\gamma| - 2 G |S_{xy}| |\\gamma_p| = \\frac{\\tau_0 + h |\\gamma_p|}{2 |S_{xy}|}$$\n$$2 G |S_{xy}| |\\gamma| - 4 G S_{xy}^2 |\\gamma_p| = \\tau_0 + h |\\gamma_p|$$\n$$|\\gamma_p| (h + 4 G S_{xy}^2) = 2 G |S_{xy}| |\\gamma| - \\tau_0$$\n$$|\\gamma_p| = \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2}$$\n这个 $|\\gamma_p|$ 的表达式在 $|\\gamma| > \\gamma_y$ 时有效。请注意，在屈服点，即 $|\\gamma|=\\gamma_y=\\tau_0/(2G|S_{xy}|)$，分子变为零，正确地得到 $|\\gamma_p|=0$。\n\n最后，我们将 $|\\gamma_p|$ 代回更简单的 $\\sigma_{xy}$ 表达式中：\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\tau_0 + h \\left( \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2} \\right) \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 (h + 4 G S_{xy}^2) + h (2 G |S_{xy}| |\\gamma| - \\tau_0)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 h + 4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma| - h \\tau_0}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma|}{h + 4 G S_{xy}^2} \\right]$$\n从括号内的分子中提取公因式 $2G|S_{xy}|$：\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{2 G |S_{xy}| (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\operatorname{sgn}(\\gamma) \\frac{G (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2}$$\n使用 $\\gamma = |\\gamma| \\operatorname{sgn}(\\gamma)$，我们得到塑性区域的最终表达式：\n$$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\n**分段解总结**\n\n1.  计算几何因子 $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$。\n2.  如果 $S_{xy} = 0$，则响应始终是弹性的：\n    $$\\sigma_{xy} = G \\gamma$$\n3.  如果 $S_{xy} \\neq 0$，计算屈服剪切应变 $\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$。\n    a.  如果 $|\\gamma| \\le \\gamma_y$ （弹性区域）：\n        $$\\sigma_{xy} = G \\gamma$$\n    b.  如果 $|\\gamma| > \\gamma_y$ （塑性区域）：\n        $$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\n实现将对每个测试用例遵循此逻辑。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear stress for a single crystal under simple shear\n    based on an analytical single-slip constitutive model.\n    \"\"\"\n    G = 25.0e9  # Shear modulus in Pa\n    tau0 = 50.0e6  # Initial critical resolved shear stress in Pa\n\n    # Test cases: (h, m, n, gamma)\n    test_cases = [\n        # Case A: Post-yield, positive shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.01),\n        # Case B: Pre-yield\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.001),\n        # Case C: Perfect plasticity, post-yield\n        (0.0, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.05),\n        # Case D: Inactive slip orientation\n        (200.0e6, np.array([np.sqrt(2)/2, np.sqrt(2)/2, 0.0]), np.array([np.sqrt(2)/2, -np.sqrt(2)/2, 0.0]), 0.01),\n        # Case E: Post-yield, negative shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), -0.01)\n    ]\n\n    results = []\n\n    for h, m, n, gamma in test_cases:\n        # 1. Calculate the geometric factor S_xy\n        # S_xy = (m_x * n_y + m_y * n_x) / 2\n        S_xy = 0.5 * (m[0] * n[1] + m[1] * n[0])\n\n        sigma_xy = 0.0\n\n        # 2. Check if the slip system is active for this loading\n        # np.isclose is used for robust floating-point comparison\n        if np.isclose(S_xy, 0.0):\n            # Purely elastic response if the resolved shear stress is always zero\n            sigma_xy = G * gamma\n        else:\n            # 3. Calculate yield shear strain\n            abs_S_xy = np.abs(S_xy)\n            gamma_y = tau0 / (2.0 * G * abs_S_xy)\n\n            # 4. Determine if loading is elastic or plastic\n            if np.abs(gamma) = gamma_y:\n                # a. Elastic regime\n                sigma_xy = G * gamma\n            else:\n                # b. Plastic regime\n                sign_gamma = np.sign(gamma)\n                \n                # Numerator of the analytical solution for the plastic regime\n                numerator = G * (2.0 * abs_S_xy * tau0 * sign_gamma + h * gamma)\n                \n                # Denominator of the analytical solution for the plastic regime\n                denominator = h + 4.0 * G * S_xy**2\n                \n                sigma_xy = numerator / denominator\n\n        results.append(sigma_xy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3552456"}, {"introduction": "在掌握了基本的模型验证技术后，我们现在可以利用晶体塑性模型来探究材料行为中更真实、更细致的方面。这项高级实践 ([@problem_id:3552467]) 旨在研究滑移系的选择（一个关键的建模决策）如何影响对屈服行为和晶格旋转的预测。这个练习展示了晶体塑性模型在材料科学研究中的实际应用，并强调了理解模型假设的重要性。", "problem": "要求您通过测量在指定加载路径下各向异性屈服轨迹和晶格旋转的变化，来量化单晶塑性预测中滑移系组选择的敏感性。该晶体为面心立方（FCC）结构，并比较两种滑移系组：(i) 由$12$个八面体$\\{111\\}\\langle 110\\rangle$滑移系组成的主滑移系组，以及 (ii) 在主滑移系组基础上增加了$6$个立方$\\{100\\}\\langle 110\\rangle$滑移系的扩展滑移系组。\n\n从以下基本原理和核心定义出发：\n- 小应变运动学，速度梯度加法分解为：$\\mathbf{L} = \\dot{\\mathbf{F}} \\mathbf{F}^{-1} = \\mathbf{D} + \\mathbf{W}$，其中 $\\mathbf{D}$ 是变形率张量，$\\mathbf{W}$ 是自旋张量。\n- 小应变下弹性和塑性部分的加法分解：$\\mathbf{D} = \\mathbf{D}^{e} + \\mathbf{D}^{p}$，其中塑性部分由滑移系 $s = 1,\\dots,N$ 上的滑移定义为 $\\mathbf{L}^{p} = \\sum_{s=1}^{N} \\dot{\\gamma}_{s} \\,\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s}$，因此 $\\mathbf{D}^{p} = \\mathrm{sym}(\\mathbf{L}^{p}) = \\dfrac{1}{2}\\sum_{s=1}^{N} \\dot{\\gamma}_{s}\\left(\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s} + \\mathbf{n}_{s} \\otimes \\mathbf{s}_{s}\\right)$ 且塑性自旋为 $\\mathbf{W}^{p} = \\mathrm{skw}(\\mathbf{L}^{p}) = \\dfrac{1}{2}\\sum_{s=1}^{N} \\dot{\\gamma}_{s}\\left(\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s} - \\mathbf{n}_{s} \\otimes \\mathbf{s}_{s}\\right)$。\n- 各向同性线弹性的胡克定律：$\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\mathbf{D} - \\mathbf{D}^{p})$，其中 $\\mathbb{C}$ 由杨氏模量 $E$ 和泊松比 $\\nu$ 构造，表达式为 $\\dot{\\boldsymbol{\\sigma}} = 2\\mu(\\mathbf{D} - \\mathbf{D}^{p}) + \\lambda \\,\\mathrm{tr}(\\mathbf{D} - \\mathbf{D}^{p})\\,\\mathbf{I}$，其中 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- 滑移系 $s$ 上的分解剪应力：$\\tau_{s} = \\mathbf{s}_{s}\\cdot\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s} = \\mathbf{s}_{s}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s}$。\n- 幂律形式的粘塑性流动法则：$\\dot{\\gamma}_{s} = \\dot{\\gamma}_{0}\\,\\mathrm{sign}(\\tau_{s})\\left(\\dfrac{|\\tau_{s}|}{g_{s}}\\right)^{n}$，其中 $g_{s}$ 是滑移系 $s$ 的临界分解剪应力，$\\dot{\\gamma}_{0}$ 是参考剪切速率，$n$ 是速率敏感性指数。\n- 在施加零刚体自旋（$\\mathbf{W}=\\mathbf{0}$）的宏观加载下，晶格自旋等于负的塑性自旋：$\\mathbf{W}^{e} = \\mathbf{W} - \\mathbf{W}^{p} = -\\mathbf{W}^{p}$，且晶格取向 $\\mathbf{R}$ 遵循 $\\dot{\\mathbf{R}} = \\mathbf{W}^{e}\\,\\mathbf{R}$。\n\n任务：\n1) 各向异性屈服轨迹半径。对于给定的取向 $\\mathbf{R}$ 和给定的应力方向张量 $\\mathbf{D}_{\\theta}$（不是一个速率，而是一个应力方向模板），定义屈服函数 $\\phi(\\boldsymbol{\\sigma}) = \\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)$。屈服面由 $\\phi(\\boldsymbol{\\sigma})=1$ 定义。对于一个方向 $\\mathbf{D}_{\\theta}$，屈服轨迹半径 $A(\\theta)$ 是满足 $\\phi(A(\\theta)\\mathbf{D}_{\\theta})=1$ 的最小正标量，可简化为\n$$\nA(\\theta) = \\dfrac{1}{\\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\mathbf{D}_{\\theta}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)}.\n$$\n使用以下由角度 $\\theta$（以弧度为单位）参数化的平面应力、偏应力方向张量族：\n$$\n\\mathbf{D}_{\\theta} = \\begin{bmatrix} \\cos\\theta  \\sin\\theta  0 \\\\ \\sin\\theta  -\\cos\\theta  0 \\\\ 0  0  0 \\end{bmatrix}.\n$$\n对两种滑移系组，计算 $\\theta \\in \\{0, \\tfrac{\\pi}{8}, \\tfrac{\\pi}{4}, \\tfrac{3\\pi}{8}, \\tfrac{\\pi}{2}\\}$ 时的 $A(\\theta)$。通过平均相对绝对差来量化两个屈服轨迹之间的差异：\n$$\n\\Delta_{\\mathrm{YL}} = \\dfrac{1}{5}\\sum_{\\theta}\\dfrac{|A_{12}(\\theta) - A_{18}(\\theta)|}{\\dfrac{1}{2}\\left(A_{12}(\\theta) + A_{18}(\\theta)\\right)}.\n$$\n将 $\\Delta_{\\mathrm{YL}}$ 报告为无量纲浮点数。\n\n2) 单轴应变下的晶格旋转。沿实验室 $\\mathbf{e}_{1}$ 方向施加单轴工程应变路径，通过规定恒定的变形率 $\\mathbf{D} = \\mathrm{diag}(0.01,0,0)\\,\\mathrm{s}^{-1}$，在 $T=1\\,\\mathrm{s}$ 内达到 $0.01$ 的总工程应变。设宏观自旋为零 $\\mathbf{W} = \\mathbf{0}$，初始柯西应力为 $\\boldsymbol{\\sigma}(t=0)=\\mathbf{0}$。使用具有 $N=1000$ 个大小为 $\\Delta t = 0.001\\,\\mathrm{s}$ 的均匀步长的显式时间步进方法，演化应力 和晶格取向 $\\mathbf{R}(t)$。在每一步：\n- 使用当前晶格取向，将晶体滑移方向 $\\mathbf{s}_{s}^{c}$ 和法线 $\\mathbf{n}_{s}^{c}$ 从晶体坐标系转换到实验室坐标系：$\\mathbf{s}_{s} = \\mathbf{R}\\,\\mathbf{s}_{s}^{c}$ 和 $\\mathbf{n}_{s} = \\mathbf{R}\\,\\mathbf{n}_{s}^{c}$。\n- 根据当前 $\\boldsymbol{\\sigma}$ 计算 $\\dot{\\gamma}_{s}$，并更新 $\\mathbf{D}^{p}$ 和 $\\mathbf{W}^{p}$。\n- 根据胡克定律，通过 $\\boldsymbol{\\sigma} \\leftarrow \\boldsymbol{\\sigma} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}$ 更新 $\\boldsymbol{\\sigma}$。\n- 通过 $\\mathbf{R} \\leftarrow \\mathrm{qorth}\\left(\\mathbf{R} + \\Delta t\\,\\mathbf{W}^{e}\\mathbf{R}\\right)$ 更新 $\\mathbf{R}$，其中 $\\mathrm{qorth}$ 将矩阵投影到最近的正规正交矩阵（以强制 $\\mathbf{R}\\in\\mathrm{SO}(3)$）。\n设最终晶格旋转角为 $\\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}}$ 的旋转角，根据主角公式 $\\theta_{\\mathrm{lat}} = \\arccos\\left(\\dfrac{\\mathrm{tr}(\\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}})-1}{2}\\right)$ 计算，并以度为单位报告。为两种滑移系组计算 $\\theta_{\\mathrm{lat}}$，并报告其绝对差 $\\Delta_{\\mathrm{ROT}} = |\\theta_{\\mathrm{lat}}^{(12)} - \\theta_{\\mathrm{lat}}^{(18)}|$（以度为单位）。\n\n滑移系与参数：\n- $12$ 个主滑移系是 FCC 八面体 $\\{111\\}\\langle 110\\rangle$ 系，其单位法向量和滑移方向的构造满足 $\\mathbf{s}_{s}^{c}\\perp \\mathbf{n}_{s}^{c}$，两者均在晶体坐标系中定义。\n- 扩展的 $18$ 滑移系组在上述基础上增加了 $6$ 个立方 $\\{100\\}\\langle 110\\rangle$ 系，同样具有单位向量且满足 $\\mathbf{s}_{s}^{c}\\perp \\mathbf{n}_{s}^{c}$。\n- 材料常数：使用杨氏模量 $E = 210000\\,\\mathrm{MPa}$，泊松比 $\\nu = 0.30$。\n- 粘塑性常数：参考剪切速率 $\\dot{\\gamma}_{0} = 0.001\\,\\mathrm{s}^{-1}$，速率敏感性指数 $n = 20$。\n- 临界分解剪应力 $g_{s}$：对于 $12$ 个主滑移系，使用 $g_{\\mathrm{pri}}$；对于新增的 $6$ 个立方滑移系，使用 $g_{\\mathrm{sec}}$。\n\n晶体取向：\n- 设初始晶格取向 $\\mathbf{R}_{0}$ 由 Z-Y-X 欧拉角 $(\\psi_{Z},\\psi_{Y},\\psi_{X})$（以度为单位）构建，即 $\\mathbf{R}_{0} = \\mathbf{R}_{Z}(\\psi_{Z})\\,\\mathbf{R}_{Y}(\\psi_{Y})\\,\\mathbf{R}_{X}(\\psi_{X})$，其中每个 $\\mathbf{R}_{\\cdot}(\\cdot)$ 是绕相应轴的标准右手旋转。\n\n测试套件：\n为以下三组参数提供结果，每组参数定义一个测试用例：\n- 用例 1：欧拉角 $(35,20,15)$ 度，$g_{\\mathrm{pri}} = 60\\,\\mathrm{MPa}$，$g_{\\mathrm{sec}} = 40\\,\\mathrm{MPa}$。\n- 用例 2：欧拉角 $(20,70,10)$ 度，$g_{\\mathrm{pri}} = 60\\,\\mathrm{MPa}$，$g_{\\mathrm{sec}} = 58\\,\\mathrm{MPa}$。\n- 用例 3：欧拉角 $(60,25,75)$ 度，$g_{\\mathrm{pri}} = 70\\,\\mathrm{MPa}$，$g_{\\mathrm{sec}} = 45\\,\\mathrm{MPa}$。\n\n角度单位和应力单位：\n- 输入中的所有角度均以度为单位；报告的晶格旋转差 $\\Delta_{\\mathrm{ROT}}$ 也必须以度为单位，并四舍五入到六位小数。\n- 所有应力单位均为兆帕斯卡（MPa）。屈服轨迹半径 $A(\\theta)$ 的单位为 MPa，但所要求的各向异性屈服轨迹差 $\\Delta_{\\mathrm{YL}}$ 是无量纲的；报告时请四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含六个结果，格式为逗号分隔的 Python 风格列表，顺序如下：\n$[\\Delta_{\\mathrm{YL}}^{(1)}, \\Delta_{\\mathrm{ROT}}^{(1)}, \\Delta_{\\mathrm{YL}}^{(2)}, \\Delta_{\\mathrm{ROT}}^{(2)}, \\Delta_{\\mathrm{YL}}^{(3)}, \\Delta_{\\mathrm{ROT}}^{(3)}]$，\n每个浮点数四舍五入到六位小数。不应打印任何其他文本。", "solution": "该问题经确认为科学上合理、良定且完整。所有必要的物理定律、本构模型、参数和数值程序均已提供。该问题是计算晶体塑性学中的一个标准练习。我们将继续进行求解。\n\n该解决方案需要实现一个单晶塑性模型，以量化材料响应预测对活动滑移系组的敏感性。比较在以下两者之间进行：一个由 $12$ 个八面体 $\\{111\\}\\langle 110\\rangle$ 滑移系组成的主滑移系组，和一个为面心立方（FCC）晶体额外增加了 $6$ 个立方 $\\{100\\}\\langle 110\\rangle$ 滑移系的扩展 $18$ 滑移系组。该分析包含针对三个不同测试用例的两个部分。\n\n首先，必须在晶体参考系中定义滑移系。一个滑移系由一对单位向量定义：滑移面法线 $\\mathbf{n}_{s}^{c}$ 和滑移方向 $\\mathbf{s}_{s}^{c}$，其中 $\\mathbf{s}_{s}^{c} \\perp \\mathbf{n}_{s}^{c}$。\n- $12$ 个主八面体滑移系是通过从 $\\{111\\}$ 法线族和 $\\langle 110 \\rangle$ 方向族中找出所有相互正交的唯一配对来生成的。例如，对于平面法线 $\\mathbf{n}^{c} = \\frac{1}{\\sqrt{3}}[1,1,1]^{\\mathsf{T}}$，来自 $\\langle 110 \\rangle$ 族的三个正交滑移方向是 $\\frac{1}{\\sqrt{2}}[1,-1,0]^{\\mathsf{T}}$、$\\frac{1}{\\sqrt{2}}[0,1,-1]^{\\mathsf{T}}$ 和 $\\frac{1}{\\sqrt{2}}[-1,0,1]^{\\mathsf{T}}$。对四个唯一的 $\\{111\\}$ 平面重复此过程，可得到 $12$ 个滑移系。\n- $6$ 个次立方滑移系由 $\\{100\\}$ 法线和 $\\langle 110\\rangle$ 方向类似地生成。例如，对于 $\\mathbf{n}^{c} = [1,0,0]^{\\mathsf{T}}$，两个正交的滑移方向是 $\\frac{1}{\\sqrt{2}}[0,1,1]^{\\mathsf{T}}$ 和 $\\frac{1}{\\sqrt{2}}[0,1,-1]^{\\mathsf{T}}$。对三个 $\\{100\\}$ 平面重复此过程，可得到 $6$ 个滑移系。\n\n晶格相对于实验室坐标系的初始取向由一个旋转矩阵 $\\mathbf{R}_0$ 给出，该矩阵由 Z-Y-X 欧拉角 $(\\psi_Z, \\psi_Y, \\psi_X)$（以度为单位）构建：$\\mathbf{R}_0 = \\mathbf{R}_Z(\\psi_Z)\\mathbf{R}_Y(\\psi_Y)\\mathbf{R}_X(\\psi_X)$。\n\n**第 1 部分：各向异性屈服轨迹**\n\n屈服轨迹表示应力空间中弹性行为的边界。对于速率相关的晶体塑性，它由恒定的塑性耗散水平定义，或者像这里一样，由分解剪应力的临界值定义。在特定应力方向 $\\mathbf{D}_{\\theta}$ 上的屈服轨迹半径 $A(\\theta)$ 计算如下：\n$$\nA(\\theta) = \\dfrac{1}{\\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\mathbf{D}_{\\theta}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)}\n$$\n其中 $g_s$ 是滑移系 $s$ 的临界分解剪应力 (CRSS)。滑移向量 $\\mathbf{s}_s$ 和 $\\mathbf{n}_s$ 是使用初始取向从晶体坐标系转换到实验室坐标系的晶体坐标系向量：$\\mathbf{s}_s = \\mathbf{R}_0 \\mathbf{s}_s^c$ 和 $\\mathbf{n}_s = \\mathbf{R}_0 \\mathbf{n}_s^c$。应力方向张量 $\\mathbf{D}_{\\theta}$ 由下式给出：\n$$\n\\mathbf{D}_{\\theta} = \\begin{bmatrix} \\cos\\theta  \\sin\\theta  0 \\\\ \\sin\\theta  -\\cos\\theta  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n对 $12$ 滑移系组 ($A_{12}$) 和 $18$ 滑移系组 ($A_{18}$) 计算 $\\theta \\in \\{0, \\tfrac{\\pi}{8}, \\tfrac{\\pi}{4}, \\tfrac{3\\pi}{8}, \\tfrac{\\pi}{2}\\}$ 时的 $A(\\theta)$。两个所得屈服轨迹之间的差异由平均相对绝对差 $\\Delta_{\\mathrm{YL}}$ 量化：\n$$\n\\Delta_{\\mathrm{YL}} = \\dfrac{1}{5}\\sum_{\\theta}\\dfrac{|A_{12}(\\theta) - A_{18}(\\theta)|}{\\frac{1}{2}(A_{12}(\\theta) + A_{18}(\\theta))}\n$$\n\n**第 2 部分：单轴应变下的晶格旋转**\n\n此任务涉及对本构方程进行数值时间积分，以模拟晶体对指定变形路径的响应。施加一个恒定的变形率 $\\mathbf{D} = \\mathrm{diag}(0.01, 0, 0)\\,\\mathrm{s}^{-1}$ 和零宏观自旋 $(\\mathbf{W}=\\mathbf{0})$，总时间为 $T=1\\,\\mathrm{s}$。模拟从无应力状态 $\\boldsymbol{\\sigma}(0)=\\mathbf{0}$ 和初始取向 $\\mathbf{R}(0)=\\mathbf{R}_0$ 开始。\n\n使用步数为 $N=1000$、步长为 $\\Delta t = 0.001\\,\\mathrm{s}$ 的显式前向欧拉格式来演化柯西应力 $\\boldsymbol{\\sigma}$ 和晶格取向 $\\mathbf{R}$。在每个时间步 $t_i$：\n1.  获取实验室坐标系中的当前滑移系：$\\mathbf{s}_{s}(t_i) = \\mathbf{R}(t_i)\\mathbf{s}_{s}^{c}$ 和 $\\mathbf{n}_{s}(t_i) = \\mathbf{R}(t_i)\\mathbf{n}_{s}^{c}$。\n2.  计算每个滑移系上的分解剪应力：$\\tau_{s}(t_i) = \\mathbf{s}_{s}(t_i)^{\\mathsf{T}}\\boldsymbol{\\sigma}(t_i)\\mathbf{n}_{s}(t_i)$。\n3.  使用幂律粘塑性流动法则计算滑移速率 $\\dot{\\gamma}_s$：$\\dot{\\gamma}_{s} = \\dot{\\gamma}_{0}\\,\\mathrm{sign}(\\tau_{s})\\left(\\frac{|\\tau_{s}|}{g_{s}}\\right)^{n}$。\n4.  组装塑性速度梯度 $\\mathbf{L}^p = \\sum_{s} \\dot{\\gamma}_{s} (\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s})$。其对称和反对称部分分别产生塑性变形率 $\\mathbf{D}^p$ 和塑性自旋 $\\mathbf{W}^p$。\n5.  使用胡克定律求得应力率 $\\dot{\\boldsymbol{\\sigma}}$：$\\dot{\\boldsymbol{\\sigma}} = 2\\mu(\\mathbf{D} - \\mathbf{D}^{p}) + \\lambda \\,\\mathrm{tr}(\\mathbf{D} - \\mathbf{D}^{p})\\,\\mathbf{I}$，其中 $\\mu$ 和 $\\lambda$ 是由杨氏模量 $E$ 和泊松比 $\\nu$ 导出的拉梅参数。\n6.  晶格自旋为 $\\mathbf{W}^{e} = \\mathbf{W} - \\mathbf{W}^{p} = -\\mathbf{W}^{p}$。\n7.  更新状态变量：\n    $$\n    \\boldsymbol{\\sigma}(t_{i+1}) = \\boldsymbol{\\sigma}(t_i) + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}(t_i)\n    $$\n    $$\n    \\mathbf{R}(t_{i+1}) = \\mathrm{qorth}\\left(\\mathbf{R}(t_i) + \\Delta t\\,\\mathbf{W}^{e}(t_i)\\mathbf{R}(t_i)\\right)\n    $$\n函数 $\\mathrm{qorth}(\\mathbf{A})$ 找到与 $\\mathbf{A}$ 最近的正规正交矩阵，这对于保持旋转矩阵 $\\mathbf{R}$ 的性质至关重要。这可以通过奇异值分解 (SVD) 可靠地实现。如果 $\\mathbf{A} = \\mathbf{U}\\Sigma\\mathbf{V}^\\mathsf{T}$，则最近的旋转矩阵是 $\\mathbf{R} = \\mathbf{U} \\mathrm{diag}(1, 1, \\det(\\mathbf{U}\\mathbf{V}^\\mathsf{T})) \\mathbf{V}^\\mathsf{T}$。\n\n经过 $N$ 步后，晶格的总旋转由矩阵 $\\mathbf{R}_{\\mathrm{rel}} = \\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}}$ 捕获。此旋转的角度 $\\theta_{\\mathrm{lat}}$ 使用迹公式以度为单位计算：\n$$\n\\theta_{\\mathrm{lat}} = \\arccos\\left(\\frac{\\mathrm{tr}(\\mathbf{R}_{\\mathrm{rel}})-1}{2}\\right) \\times \\frac{180}{\\pi}\n$$\n对 $12$ 滑移系组和 $18$ 滑移系组都执行此过程，得到 $\\theta_{\\mathrm{lat}}^{(12)}$ 和 $\\theta_{\\mathrm{lat}}^{(18)}$。最终的度量是绝对差 $\\Delta_{\\mathrm{ROT}} = |\\theta_{\\mathrm{lat}}^{(12)} - \\theta_{\\mathrm{lat}}^{(18)}|$。\n\n对所提供的三个测试用例中的每一个重复这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svd\n\n# Due to version constraints, matrix_power is not used to ensure compatibility.\n# For numpy1.9.0, scipy.linalg.expm can be an alternative, but not needed here.\n\ndef get_slip_systems():\n    \"\"\"Generates FCC slip systems.\"\"\"\n    # 12 primary {111}110> octahedral systems\n    oct_normals = [[1, 1, 1], [1, -1, 1], [-1, 1, 1], [1, 1, -1]]\n    oct_slips = [[1, -1, 0], [1, 0, -1], [0, 1, -1], [1, 1, 0], [1, 0, 1], [0, 1, 1]]\n    \n    systems_12 = []\n    for n in oct_normals:\n        for s in oct_slips:\n            if np.dot(n, s) == 0:\n                n_norm = np.array(n) / np.linalg.norm(n)\n                s_norm = np.array(s) / np.linalg.norm(s)\n                systems_12.append((s_norm, n_norm))\n\n    # 6 secondary {100}110> cubic systems\n    cube_normals = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\n    cube_slips = [[0, 1, 1], [0, 1, -1], [1, 0, 1], [1, 0, -1], [1, 1, 0], [1, -1, 0]]\n    \n    systems_6 = []\n    for n in cube_normals:\n        for s in cube_slips:\n            if np.dot(n, s) == 0:\n                n_norm = np.array(n) / np.linalg.norm(n)\n                s_norm = np.array(s) / np.linalg.norm(s)\n                systems_6.append((s_norm, n_norm))\n    \n    return systems_12, systems_6\n\ndef euler_to_rotation_matrix(psi_z, psi_y, psi_x):\n    \"\"\"Computes rotation matrix from Z-Y-X Euler angles (in degrees).\"\"\"\n    psi_z_rad, psi_y_rad, psi_x_rad = np.deg2rad([psi_z, psi_y, psi_x])\n    \n    cos_z, sin_z = np.cos(psi_z_rad), np.sin(psi_z_rad)\n    cos_y, sin_y = np.cos(psi_y_rad), np.sin(psi_y_rad)\n    cos_x, sin_x = np.cos(psi_x_rad), np.sin(psi_x_rad)\n    \n    Rz = np.array([[cos_z, -sin_z, 0], [sin_z, cos_z, 0], [0, 0, 1]])\n    Ry = np.array([[cos_y, 0, sin_y], [0, 1, 0], [-sin_y, 0, cos_y]])\n    Rx = np.array([[1, 0, 0], [0, cos_x, -sin_x], [0, sin_x, cos_x]])\n    \n    return Rz @ Ry @ Rx\n\ndef qorth(A):\n    \"\"\"Projects matrix A to the nearest proper orthogonal matrix in SO(3).\"\"\"\n    U, _, Vh = svd(A)\n    R = U @ Vh\n    if np.linalg.det(R)  0:\n        U[:, -1] *= -1\n        R = U @ Vh\n    return R\n\ndef solve_case(params):\n    \"\"\"Solves one test case for both metrics.\"\"\"\n    euler_angles, g_pri, g_sec = params\n    \n    # Material and model parameters\n    E = 210000.0  # MPa\n    nu = 0.30\n    gamma0_dot = 0.001  # s^-1\n    n_exp = 20.0\n    mu = E / (2 * (1 + nu))\n    lambda_lame = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    systems_12, systems_6 = get_slip_systems()\n    systems_18 = systems_12 + systems_6\n    \n    g_12 = np.full(12, g_pri)\n    g_18 = np.concatenate([np.full(12, g_pri), np.full(6, g_sec)])\n\n    R0 = euler_to_rotation_matrix(*euler_angles)\n\n    # --- Part 1: Yield Locus Difference ---\n    thetas = [0, np.pi/8, np.pi/4, 3*np.pi/8, np.pi/2]\n    A_12 = []\n    A_18 = []\n\n    for slip_systems, g_s, A_list in [(systems_12, g_12, A_12), (systems_18, g_18, A_18)]:\n        lab_systems = [(R0 @ s_c, R0 @ n_c) for s_c, n_c in slip_systems]\n        for theta in thetas:\n            D_theta = np.array([[np.cos(theta), np.sin(theta), 0],\n                                [np.sin(theta), -np.cos(theta), 0],\n                                [0, 0, 0]])\n            \n            max_val = 0.0\n            for i, (s, n) in enumerate(lab_systems):\n                tau_norm = np.abs(s.T @ D_theta @ n)\n                val = tau_norm / g_s[i]\n                if val > max_val:\n                    max_val = val\n            \n            A_list.append(1.0 / max_val if max_val > 1e-12 else 0)\n\n    delta_yl_sum = 0.0\n    for i in range(len(thetas)):\n        a12, a18 = A_12[i], A_18[i]\n        delta_yl_sum += np.abs(a12 - a18) / (0.5 * (a12 + a18))\n    delta_yl = delta_yl_sum / len(thetas)\n\n    # --- Part 2: Lattice Rotation Difference ---\n    D = np.array([[0.01, 0, 0], [0, 0, 0], [0, 0, 0]])\n    dt = 0.001\n    N_steps = 1000\n    \n    theta_lat_vals = []\n    for slip_systems, g_s in [(systems_12, g_12), (systems_18, g_18)]:\n        sigma = np.zeros((3, 3))\n        R = R0.copy()\n        \n        slip_systems_c = [(s_c, n_c) for s_c, n_c in slip_systems]\n\n        for _ in range(N_steps):\n            lab_systems = [(R @ s_c, R @ n_c) for s_c, n_c in slip_systems_c]\n            \n            Lp = np.zeros((3, 3))\n            for i, (s, n) in enumerate(lab_systems):\n                tau = s.T @ sigma @ n\n                if np.abs(tau) > 1e-12:\n                    gamma_dot = gamma0_dot * np.sign(tau) * (np.abs(tau) / g_s[i])**n_exp\n                    Lp += gamma_dot * np.outer(s, n)\n            \n            Dp = 0.5 * (Lp + Lp.T)\n            Wp = 0.5 * (Lp - Lp.T)\n            \n            D_elastic_rate = D - Dp\n            sigma_dot = (lambda_lame * np.trace(D_elastic_rate)) * np.eye(3) + 2 * mu * D_elastic_rate\n            \n            We = -Wp\n            \n            sigma += sigma_dot * dt\n            R = qorth(R + (We @ R) * dt)\n\n        R_final = R\n        R_rel = R_final @ R0.T\n        \n        trace_val = np.clip((np.trace(R_rel) - 1.0) / 2.0, -1.0, 1.0)\n        theta_lat = np.rad2deg(np.arccos(trace_val))\n        theta_lat_vals.append(theta_lat)\n\n    delta_rot = np.abs(theta_lat_vals[0] - theta_lat_vals[1])\n    \n    return delta_yl, delta_rot\n\ndef solve():\n    test_cases = [\n        ((35, 20, 15), 60.0, 40.0),\n        ((20, 70, 10), 60.0, 58.0),\n        ((60, 25, 75), 70.0, 45.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        delta_yl, delta_rot = solve_case(case)\n        all_results.extend([delta_yl, delta_rot])\n\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "3552467"}]}