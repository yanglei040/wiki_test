{"hands_on_practices": [{"introduction": "在工程实践中，我们通常使用杨氏模量 $E_i$、泊松比 $\\nu_{ij}$ 和剪切模量 $G_{ij}$ 等工程常数来描述各向异性材料的力学性能。然而，在有限元分析等计算力学模拟中，我们需要的是完整的刚度矩阵 $\\mathbf{C}$。本练习将指导你完成从工程常数到刚度矩阵的关键转换，并通过计算验证材料稳定性的基本要求——刚度矩阵的正定性。这项实践是实现任何各向异性材料模型的基石，可帮助你深入理解材料参数、本构关系及其数值实现之间的联系 [@problem_id:3580525]。", "problem": "给定一个三维小应变下的线性弹性正交各向异性固体。在Voigt表示法中，本构关系为$\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$, 其中$\\,\\mathbf{C}\\,$是对称的$\\,6\\times 6\\,$刚度矩阵，柔度矩阵$\\,\\mathbf{S}\\,$满足$\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$. 某一点的正交各向异性材料由九个工程常数表征：三个杨氏模量$\\,E_1,E_2,E_3\\,$, 三个泊松比$\\,\\nu_{12},\\nu_{23},\\nu_{31}\\,$ (为确保柔度矩阵的对称性，倒数泊松比受限于$\\,\\nu_{21} = \\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{32} = \\nu_{23}\\,E_3/E_2\\,$, $\\,\\nu_{13} = \\nu_{31}\\,E_1/E_3\\,$), 以及三个剪切模量$\\,G_{12},G_{23},G_{31}\\,$. 在标准工程剪切应变约定下，采用Voigt排序$\\,\\{11,22,33,23,13,12\\}\\,$的柔度矩阵$\\,\\mathbf{S}\\,$具有与正交各向异性一致的块对角结构，并且必须根据给定的工程常数进行组装。仅使用基本的线性弹性原理和矩阵理论，为每个测试用例执行以下操作：\n\n1. 根据提供的工程常数组装$\\,\\mathbf{S}\\,$，确保强制执行互易关系$\\,\\nu_{ji} = \\nu_{ij} E_j / E_i\\,$，从而使$\\,\\mathbf{S}\\,$对称。\n2. 通过数值求逆显式计算刚度矩阵$\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$.\n3. 使用$\\,10^{-10}\\,$的绝对数值公差检查$\\,\\mathbf{S}\\,$和$\\,\\mathbf{C}\\,$中各元素的对称性。\n4. 通过验证对称化矩阵$\\,(\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$的所有特征值严格大于$\\,10^{-9}\\,$吉帕斯卡(GPa)的正定性公差，来检查$\\,\\mathbf{C}\\,$的正定性。\n5. 报告$\\,\\mathbf{C}\\,$的最小特征值(单位为GPa)，四舍五入到$\\,6\\,$位小数。\n\n所有类刚度量$\\,E_i\\,$和$\\,G_{ij}\\,$均以吉帕斯卡(GPa)为单位，泊松比是无量纲的，柔度矩阵的元素单位应视为反吉帕斯卡(GPa$^{-1}$)，刚度矩阵的元素单位为吉帕斯卡(GPa)。不涉及角度。每个测试用例的输出必须是一个列表$[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}]$，其中布尔值表示对称性和正定性检查的结果，最后一个条目是$\\,\\mathbf{C}\\,$的最小特征值(单位为GPa)，四舍五入。\n\n测试套件(共$\\,3\\,$个不同案例)：\n\n- 案例$\\,1\\,$ (高度正交各向异性，类似纤维增强材料)：\n  - $\\,E_1 = 150.0\\,$ GPa, $\\,E_2 = 10.0\\,$ GPa, $\\,E_3 = 10.0\\,$ GPa\n  - $\\,\\nu_{12} = 0.25\\,$, $\\,\\nu_{23} = 0.30\\,$, $\\,\\nu_{31} = 0.02\\,$\n  - $\\,G_{12} = 5.5\\,$ GPa, $\\,G_{23} = 3.8\\,$ GPa, $\\,G_{31} = 5.2\\,$ GPa\n\n- 案例$\\,2\\,$ (准各向同性基准)：\n  - $\\,E_1 = E_2 = E_3 = 210.0\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.30\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{210.0}{2(1+0.30)}\\,$ GPa\n\n- 案例$\\,3\\,$ (类似近不可压缩材料)：\n  - $\\,E_1 = E_2 = E_3 = 3.5\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.49\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{3.5}{2(1+0.49)}\\,$ GPa\n\n您的程序必须为每个案例计算$\\,\\mathbf{S}\\,$和$\\,\\mathbf{C}\\,$矩阵，执行检查，并生成一行输出，该输出包含$\\,3\\,$个子列表(每个案例一个)，格式完全如下：\n$[ [b_{11},b_{12},b_{13},f_1], [b_{21},b_{22},b_{23},f_2], [b_{31},b_{32},b_{33},f_3] ]$\n其中$\\,b_{ij}\\,$是布尔值，$\\,f_i\\,$是浮点数(单位为GPa)，四舍五入到$\\,6\\,$位小数。除了这单行输出外，不得打印任何其他文本。", "solution": "我们从线性弹性关系$\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$及其逆关系$\\,\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}\\,$开始，其中$\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$. 对于一个在工程剪切应变约定下，采用Voigt表示法$\\,\\{11,22,33,23,13,12\\}\\,$的正交各向异性材料，其柔度矩阵$\\,\\mathbf{S}\\,$在法向分量和剪切分量之间是块对角的。剪切柔度由剪切模量的倒数直接给出，即$\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, $\\,S_{66}=1/G_{12}\\,$，所有其他剪切非对角线元素因正交各向异性而为零。\n\n对于法向$\\,3\\times 3\\,$块，具有倒数泊松比关系的正交各向异性强制其对称性。具体来说，为确保$\\,\\mathbf{S}\\,$对称，我们强制执行$\\,\\nu_{21} = \\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{32} = \\nu_{23}\\,E_3/E_2\\,$和$\\,\\nu_{13} = \\nu_{31}\\,E_1/E_3\\,$. 有了这些，法向部分的元素为$\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$, $\\,S_{12} = S_{21} = -\\nu_{12}/E_1\\,$, $\\,S_{13} = S_{31} = -\\nu_{13}/E_1$ (等价于 $-\\nu_{31}/E_3$), $\\,S_{23} = S_{32} = -\\nu_{23}/E_2\\,$ (等价于 $-\\nu_{32}/E_3$)。这些是弹性力学中经过充分验证的公式，将工程常数与柔度联系起来。然后通过将法向$\\,3\\times 3\\,$块放置在左上角，并将剪切柔度放置在对角线位置$\\,44\\,$, $\\,55\\,$和$\\,66\\,$上，来组装完整的$\\,6\\times 6\\,$柔度矩阵$\\,\\mathbf{S}\\,$.\n\n构建好$\\,\\mathbf{S}\\,$后，刚度矩阵$\\,\\mathbf{C}\\,$可通过$\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$得到，这可以通过标准矩阵求逆进行数值计算。根据物理原理，得到的$\\,\\mathbf{C}\\,$应该是对称的；在数值上，我们使用$\\,10^{-10}\\,$的绝对公差来测试$\\,\\mathbf{S}\\,$和$\\,\\mathbf{C}\\,$与其转置矩阵的差异，以检验其对称性。\n\n对于正定性，在线性弹性稳定性中，刚度矩阵$\\,\\mathbf{C}\\,$必须是对称正定的，这意味着所有特征值都严格为正。在数值上，我们使用适用于Hermitian矩阵的算法来评估对称化矩阵$\\,(\\mathbf{C} + \\mathbf{C}^\\mathsf{T})/2\\,$的特征值，并验证最小特征值超过一个小的公差$\\,10^{-9}\\,$吉帕斯卡，以考虑舍入误差。这为每个测试用例生成一个布尔值$\\,\\text{is\\_C\\_positive\\_definite}\\,$. 我们还报告最小特征值本身，单位为吉帕斯卡，四舍五入到$\\,6\\,$位小数。\n\n所有给定的$\\,E_i\\,$和$\\,G_{ij}\\,$都以吉帕斯卡(GPa)为单位，因此作为倒数计算的柔度矩阵元素单位为反吉帕斯卡(GPa$^{-1}$)，而刚度矩阵元素单位为吉帕斯卡(GPa)。泊松比是无量纲的。因为在这种正交各向异性形式中，$\\,\\mathbf{S}\\,$在其剪切分量上是块对角的，且$\\,G_{ij}\\,$严格为正，所以稳定性检查主要归结为法向块的贡献，但在数值上我们评估完整的$\\,6\\times 6\\,$矩阵，以考虑求逆后的耦合效应。\n\n应用于每个案例的算法如下：\n- 输入$\\,E_1,E_2,E_3,\\nu_{12},\\nu_{23},\\nu_{31},G_{12},G_{23},G_{31}\\,$ (除了无量纲的泊松比外，所有单位均为GPa)。\n- 计算$\\,\\nu_{13}=\\nu_{31}E_1/E_3\\,$ (其他倒数泊松比不需要显式计算，因为填充矩阵时使用了对称性)。\n- 通过放置以下元素来组装$\\,\\mathbf{S}\\,$:\n  - $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$,\n  - $\\,S_{12}=S_{21}=-\\nu_{12}/E_1\\,$, $\\,S_{13}=S_{31}=-\\nu_{13}/E_1\\,$, $\\,S_{23}=S_{32}=-\\nu_{23}/E_2\\,$,\n  - $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, $\\,S_{66}=1/G_{12}\\,$,\n  其他位置为零。\n- 计算$\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$并为进行特征分析而将$\\,\\mathbf{C}\\,$对称化为$\\,\\mathbf{C}_\\text{sym} = (\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$.\n- 检查$\\,\\|\\mathbf{S}-\\mathbf{S}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$和$\\,\\|\\mathbf{C}-\\mathbf{C}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$以设置对称性布尔值。\n- 计算$\\,\\mathbf{C}_\\text{sym}\\,$的特征值，如果最小特征值大于$\\,10^{-9}\\,$，则设置正定性布尔值，并记录该最小特征值，四舍五入到$\\,6\\,$位小数。\n\n测试套件包含问题描述中指定的$\\,3\\,$个案例。对于准各向同性案例，剪切模量通过$\\,G = E/[2(1+\\nu)]\\,$为给定的$\\,E\\,$和$\\,\\nu\\,$进行一致性设置，以确保内部一致性。最终程序为$\\,3\\,$个案例输出一行列表$\\,\\big[\\,[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}], \\ldots\\big]\\,$，其中最小特征值以吉帕斯卡为单位，按要求四舍五入到$\\,6\\,$位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_compliance(E1, E2, E3, nu12, nu23, nu31, G12, G23, G31):\n    \"\"\"\n    Assemble the 6x6 orthotropic compliance matrix S (Voigt order 11,22,33,23,13,12)\n    using engineering shear strains. Units: E and G in GPa, S in 1/GPa.\n    Enforce reciprocity: nu_ij/E_i = nu_ji/E_j.\n    \"\"\"\n    S = np.zeros((6, 6), dtype=float)\n\n    # Normal block (3x3)\n    S[0, 0] = 1.0 / E1\n    S[1, 1] = 1.0 / E2\n    S[2, 2] = 1.0 / E3\n\n    # From nu12/E1 = nu21/E2\n    S[0, 1] = S[1, 0] = -nu12 / E1\n    # From nu13/E1 = nu31/E3\n    S[0, 2] = S[2, 0] = -nu31 / E3\n    # From nu23/E2 = nu32/E3\n    S[1, 2] = S[2, 1] = -nu23 / E2\n\n    # Shear compliances (engineering shear)\n    S[3, 3] = 1.0 / G23\n    S[4, 4] = 1.0 / G31\n    S[5, 5] = 1.0 / G12\n\n    return S\n\ndef is_symmetric(M, atol=1e-10):\n    return np.allclose(M, M.T, atol=atol, rtol=0.0)\n\ndef stiffness_from_compliance(S):\n    # Invert compliance to get stiffness\n    return np.linalg.inv(S)\n\ndef min_eigenvalue_and_pd(C, pd_tol=1e-9):\n    # Symmetrize to avoid numerical asymmetry effects\n    Csym = 0.5 * (C + C.T)\n    # Use eigvalsh for symmetric/Hermitian matrices\n    evals = np.linalg.eigvalsh(Csym)\n    lam_min = float(np.min(evals))\n    is_pd = lam_min > pd_tol\n    return lam_min, is_pd\n\ndef format_value(val):\n    \"\"\"Format booleans/floats/lists with commas and no spaces, recursively.\"\"\"\n    if isinstance(val, list):\n        return \"[\" + \",\".join(format_value(x) for x in val) + \"]\"\n    if isinstance(val, bool):\n        return \"True\" if val else \"False\"\n    if isinstance(val, float):\n        # Use default string conversion for float\n        return str(val)\n    if isinstance(val, (int, np.integer)):\n        return str(int(val))\n    # Fallback for numpy bool_\n    if hasattr(val, \"item\"):\n        return format_value(val.item())\n    return str(val)\n\ndef solve():\n    # Define the test cases from the problem statement (all moduli in GPa).\n    # Case 1: Highly orthotropic\n    case1 = {\n        \"E1\": 150.0, \"E2\": 10.0, \"E3\": 10.0,\n        \"nu12\": 0.25, \"nu23\": 0.30, \"nu31\": 0.02,\n        \"G12\": 5.5, \"G23\": 3.8, \"G31\": 5.2\n    }\n\n    # Case 2: Quasi-isotropic baseline\n    E_iso = 210.0\n    nu_iso = 0.30\n    G_iso = E_iso / (2.0 * (1.0 + nu_iso))\n    case2 = {\n        \"E1\": E_iso, \"E2\": E_iso, \"E3\": E_iso,\n        \"nu12\": nu_iso, \"nu23\": nu_iso, \"nu31\": nu_iso,\n        \"G12\": G_iso, \"G23\": G_iso, \"G31\": G_iso\n    }\n\n    # Case 3: Near-incompressible-like\n    E_nc = 3.5\n    nu_nc = 0.49\n    G_nc = E_nc / (2.0 * (1.0 + nu_nc))\n    case3 = {\n        \"E1\": E_nc, \"E2\": E_nc, \"E3\": E_nc,\n        \"nu12\": nu_nc, \"nu23\": nu_nc, \"nu31\": nu_nc,\n        \"G12\": G_nc, \"G23\": G_nc, \"G31\": G_nc\n    }\n\n    test_cases = [case1, case2, case3]\n\n    results = []\n    for params in test_cases:\n        # Based on problem definition, nu31 is an input. We must compute the other dependent nu_ij\n        # to fill the S matrix, or use the symmetry relations directly.\n        # S_ij = -nu_ij/E_i = -nu_ji/E_j. So -nu12/E1, -nu13/E1 but also -nu31/E3.\n        # S[0,2] = -nu13/E1. nu13 = nu31*E1/E3. So S[0,2] = -nu31/E3.\n        # My implementation of assemble_compliance uses the symmetric property directly.\n        S = assemble_compliance(**params)\n        C = stiffness_from_compliance(S)\n\n        S_sym = is_symmetric(S, atol=1e-10)\n        C_sym = is_symmetric(C, atol=1e-10)\n\n        lam_min, is_pd = min_eigenvalue_and_pd(C, pd_tol=1e-9)\n        # Round the minimal eigenvalue to 6 decimals as required\n        lam_min_rounded = round(lam_min, 6)\n\n        results.append([S_sym, C_sym, is_pd, lam_min_rounded])\n\n    # Final print statement in the exact required format: a single line with no extra spaces.\n    print(format_value(results))\n\nsolve()\n```", "id": "3580525"}, {"introduction": "我们已经知道如何在材料的自然坐标系中构建刚度矩阵 $\\mathbf{C}$，但如果我们的分析是在一个不同的全局坐标系中进行的，情况会怎样呢？材料的内在属性是客观的，但其张量表示形式却依赖于所选的坐标系。本练习将演示如何将刚度张量变换到一个新的坐标系下，并揭示这种旋转如何在表观上引入法向与剪切分量之间的耦合——这种耦合在材料自身的坐标系中是不存在的。这个过程对于有限元分析至关重要，因为在分析中材料轴向通常与单元或全局坐标轴不一致 [@problem_id:3580567]。", "problem": "考虑一个均质线性弹性固体，其材料对称性相对于一个局部笛卡尔坐标系是正交各向异性的。设其本构关系在局部材料坐标系中由四阶弹性张量 $\\,\\mathbf{C}\\,$ 给出，满足 $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$，其中 $\\,\\boldsymbol{\\sigma}\\,$ 是Cauchy应力，$\\,\\boldsymbol{\\varepsilon}\\,$ 是无穷小应变。全局坐标系通过一个真正的正交旋转 $\\,\\mathbf{Q}\\in \\mathrm{SO}(3)\\,$ 与正交各向异性轴未对齐。您必须使用Bond矩阵推导Voigt标记法下的转换刚度矩阵，并量化所诱导的耦合项。\n\n您的推导必须从以下基本依据出发：\n- 小应变范围内的线弹性，满足 $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$。\n- 四阶张量在旋转 $\\,\\mathbf{Q}\\,$ 下的转换法则，由 $\\,\\mathbf{C}^{\\prime}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl}\\, \\mathbf{C}_{ijkl}\\,$ 给出。\n- 使用工程剪切应变的Voigt标记法定义，其中Voigt应力向量为 $\\,\\mathbf{s} = [\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]^{\\mathsf{T}}\\,$，Voigt应变向量为 $\\,\\mathbf{e} = [\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},2\\varepsilon_{23},2\\varepsilon_{13},2\\varepsilon_{12}]^{\\mathsf{T}}\\,$。\n\n任务：\n1. 从第一性原理出发，构建在旋转 $\\,\\mathbf{Q}\\,$ 下分别转换Voigt应力和Voigt应变的Bond矩阵 $\\,\\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,$ 和 $\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})\\,$，不要使用任何闭式简化公式。利用 $\\,\\mathbf{Q}\\,$ 对对称二阶张量的作用以及使用工程剪切分量的Voigt映射定义，通过它们对Voigt基张量的影响来逐列构建这些矩阵。\n2. 证明Voigt标记法中的转换刚度满足 $\\,\\mathbf{C}^{\\prime} = \\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,\\mathbf{C}\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})^{-1}\\,$。\n3. 使用工程常数 $\\,E_{1},E_{2},E_{3},\\nu_{12},\\nu_{13},\\nu_{23},G_{12},G_{13},G_{23}\\,$ 在局部材料坐标系中构建正交各向异性柔度矩阵 $\\,\\mathbf{S}\\,$。通过设置 $\\,\\nu_{21} = \\nu_{12}\\,E_{2}/E_{1}\\,$, $\\,\\nu_{31} = \\nu_{13}\\,E_{3}/E_{1}\\,$ 和 $\\,\\nu_{32} = \\nu_{23}\\,E_{3}/E_{2}\\,$ 来强制主对称性，然后得到 $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$。\n4. 将诱导耦合项定义为 $\\,\\mathbf{C}^{\\prime}\\,$ 的法向-剪切非对角块，即在Voigt索引下所有满足 $\\,i\\in\\{1,2,3\\}\\,$ 和 $\\,j\\in\\{4,5,6\\}\\,$ 的项 $\\,C^{\\prime}_{ij}\\,$。通过上块元素绝对值之和 $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$ 来量化总诱导耦合。\n\n物理单位和数值格式：\n- 所有模量 $\\,E_{k}\\,$ 和 $\\,G_{ij}\\,$ 必须以吉帕斯卡 (GPa) 为单位指定，您的输出也必须以吉帕斯卡 (GPa) 表示。\n- 所有用于定义旋转的角度必须以度为单位指定，并在内部转换为弧度。\n- 最终输出必须是实数 (浮点数)。\n\n测试套件：\n在程序中实现您的推导，并为以下四个测试用例评估总诱导耦合。对于每个用例，构建 $\\,\\mathbf{S}\\,$, 求逆得到 $\\,\\mathbf{C}\\,$, 从 $\\,\\mathbf{Q}\\,$ 构建 $\\,\\mathbf{B}_{\\sigma}\\,$ 和 $\\,\\mathbf{B}_{\\varepsilon}\\,$, 形成 $\\,\\mathbf{C}^{\\prime}\\,$, 并计算耦合总和 $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$ (以GPa为单位)，结果四舍五入到六位小数。\n\n- 测试用例 1 (正常情况，对齐的正交各向异性)：$\\,E_{1}=150\\,\\mathrm{GPa}\\,$, $\\,E_{2}=12\\,\\mathrm{GPa}\\,$, $\\,E_{3}=12\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=6\\,\\mathrm{GPa}\\,$, $\\,G_{13}=5\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$，以及 $\\,\\mathbf{Q}=\\mathbf{I}\\,$ (单位旋转)。预期行为：零耦合。\n- 测试用例 2 (平面内未对齐)：模量与测试用例 1 相同，$\\,\\mathbf{Q}\\,$ 为绕全局 3 轴旋转 $\\,45^{\\circ}\\,$。\n- 测试用例 3 (各向同性极限，边界情况)：$\\,E_{1}=E_{2}=E_{3}=100\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=\\nu_{13}=\\nu_{23}=0.25\\,$, $\\,G_{12}=G_{13}=G_{23}=E/(2(1+\\nu))=40\\,\\mathrm{GPa}\\,$，$\\,\\mathbf{Q}\\,$ 是绕轴 $\\,\\mathbf{a}=[1,1,1]^{\\mathsf{T}}/\\sqrt{3}\\,$ 旋转 $\\,40^{\\circ}\\,$。预期行为：零耦合 (在数值公差范围内)。\n- 测试用例 4 (强各向异性，复合未对齐)：$\\,E_{1}=50\\,\\mathrm{GPa}\\,$, $\\,E_{2}=10\\,\\mathrm{GPa}\\,$, $\\,E_{3}=5\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=8\\,\\mathrm{GPa}\\,$, $\\,G_{13}=6\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$，$\\,\\mathbf{Q}\\,$ 是先后绕全局 1 轴旋转 $\\,30^{\\circ}\\,$、绕全局 2 轴旋转 $\\,20^{\\circ}\\,$、绕全局 3 轴旋转 $\\,10^{\\circ}\\,$ 的复合旋转。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的结果，结果为以逗号分隔的列表，用方括号括起，单位为GPa，四舍五入到六位小数。例如：$\\,\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]\\,$。", "solution": "该问题要求推导和实现线性弹性正交各向异性材料在坐标系旋转下的刚度矩阵转换法则。目标是量化诱导的法向-剪切耦合。本解答将通过处理问题陈述中概述的四个任务来系统地展开。\n\n### 任务1 & 2：构建Bond矩阵并证明转换法则\n\n对称二阶张量（如Cauchy应力 $\\boldsymbol{\\sigma}$）从局部材料坐标系到旋转后的全局坐标系的转换由 $\\boldsymbol{\\sigma}' = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^{\\mathsf{T}}$ 给出，其中 $\\mathbf{Q} \\in \\mathrm{SO}(3)$ 是正交旋转矩阵。其分量形式为 $\\sigma'_{pq} = Q_{pi} Q_{qj} \\sigma_{ij}$。\n\nVoigt标记法提供了从对称二阶张量到 $6 \\times 1$ 向量的映射。问题指定了以下映射：\n- 应力向量：$\\mathbf{s} = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}$\n- 应变向量（含工程剪切分量）：$\\mathbf{e} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, 2\\varepsilon_{23}, 2\\varepsilon_{13}, 2\\varepsilon_{12}]^{\\mathsf{T}}$\n\nBond矩阵 $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$ 和 $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$ 是这些Voigt向量的 $6 \\times 6$ 转换矩阵，定义为 $\\mathbf{s}' = \\mathbf{B}_{\\sigma} \\mathbf{s}$ 和 $\\mathbf{e}' = \\mathbf{B}_{\\varepsilon} \\mathbf{e}$。我们通过将转换后向量 ($\\mathbf{s}', \\mathbf{e}'$) 的分量与原始向量 ($\\mathbf{s}, \\mathbf{e}$) 的分量相关联来构建这些矩阵。例如，$\\mathbf{B}_{\\sigma}$ 的第一列是通过设置单位应力 $\\sigma_{11}=1$（其他分量为零）并计算转换后的应力向量 $\\mathbf{s}'$ 来获得的。\n\n以 $\\sigma'_{11}$ 为例：\n$\\sigma'_{11} = Q_{1i} Q_{1j} \\sigma_{ij} = Q_{11}^2\\sigma_{11} + Q_{12}^2\\sigma_{22} + Q_{13}^2\\sigma_{33} + 2Q_{12}Q_{13}\\sigma_{23} + 2Q_{11}Q_{13}\\sigma_{13} + 2Q_{11}Q_{12}\\sigma_{12}$\n注意到 $\\mathbf{e}$ 中的因子2，类似的展开式对 $\\varepsilon'_{11}$ 给出：\n$\\varepsilon'_{11} = Q_{11}^2\\varepsilon_{11} + Q_{12}^2\\varepsilon_{22} + Q_{13}^2\\varepsilon_{33} + Q_{12}Q_{13}(2\\varepsilon_{23}) + Q_{11}Q_{13}(2\\varepsilon_{13}) + Q_{11}Q_{12}(2\\varepsilon_{12})$\n通过比较系数，我们可以看到 $\\mathbf{B}_{\\sigma}$ 和 $\\mathbf{B}_{\\varepsilon}$ 的元素之间的关系。这个过程可以系统地完成，从而构建出完整的矩阵。$\\mathbf{B}_{\\sigma}$ 和 $\\mathbf{B}_{\\varepsilon}$ 之间的关系可以通过一个对角矩阵 $\\mathbf{R} = \\mathrm{diag}(1, 1, 1, 2, 2, 2)$ 来简洁地描述，使得 $\\mathbf{B}_{\\varepsilon} = \\mathbf{R}^{-1} \\mathbf{B}_{\\sigma} \\mathbf{R}$。\n\n在局部坐标系中，本构关系为 $\\mathbf{s} = \\mathbf{C} \\mathbf{e}$。在全局坐标系中，我们有 $\\mathbf{s}' = \\mathbf{C}' \\mathbf{e}'$。代入转换关系：\n$\\mathbf{B}_{\\sigma} \\mathbf{s} = \\mathbf{C}' (\\mathbf{B}_{\\varepsilon} \\mathbf{e})$\n将 $\\mathbf{s} = \\mathbf{C} \\mathbf{e}$ 代入左侧：\n$\\mathbf{B}_{\\sigma} (\\mathbf{C} \\mathbf{e}) = \\mathbf{C}' \\mathbf{B}_{\\varepsilon} \\mathbf{e}$\n由于这对任意应变向量 $\\mathbf{e}$ 都成立，我们得到：\n$\\mathbf{B}_{\\sigma} \\mathbf{C} = \\mathbf{C}' \\mathbf{B}_{\\varepsilon}$\n两边右乘 $\\mathbf{B}_{\\varepsilon}^{-1}$，便可证明转换法则：\n$\\mathbf{C}^{\\prime} = \\mathbf{B}_{\\sigma} \\mathbf{C} \\mathbf{B}_{\\varepsilon}^{-1}$\n\n### 任务3 & 4：实现与计算\n\n对于每个测试用例，我们首先根据给定的工程常数构建正交各向异性柔度矩阵 $\\mathbf{S}$。主对称性（例如，$\\nu_{ij}/E_i = \\nu_{ji}/E_j$）是自动满足的。然后，通过数值求逆得到刚度矩阵 $\\mathbf{C} = \\mathbf{S}^{-1}$。\n\n接下来，根据给定的旋转（单位旋转、单轴旋转或复合旋转）构建旋转矩阵 $\\mathbf{Q}$。利用 $\\mathbf{Q}$，我们从第一性原理构建Bond矩阵 $\\mathbf{B}_{\\sigma}$ 和 $\\mathbf{B}_{\\varepsilon}$。随后，我们应用已证明的转换法则计算旋转后的刚度矩阵 $\\mathbf{C}'$。\n\n最后，我们通过对 $\\mathbf{C}'$ 的法向-剪切耦合块（即 $i \\in \\{1,2,3\\}, j \\in \\{4,5,6\\}$ 的元素）的绝对值求和，来量化总的诱导耦合。对于未旋转的正交各向异性情况和任何旋转下的各向同性情况，该耦合项预期为零（在数值精度范围内）。对于旋转后的各向异性材料，该耦合项通常为非零值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the material rotation problem for the given test cases.\n    \"\"\"\n\n    def construct_ortho_compliance(E1, E2, E3, nu12, nu13, nu23, G12, G13, G23):\n        \"\"\"Constructs the 6x6 orthotropic compliance matrix S.\"\"\"\n        S = np.zeros((6, 6))\n        # Reciprocity relations: nu_ij/E_i = nu_ji/E_j\n        nu21 = nu12 * E2 / E1\n        nu31 = nu13 * E3 / E1 # Note: problem gives nu13, nu23 as inputs\n        nu32 = nu23 * E3 / E2\n\n        S[0, 0] = 1 / E1\n        S[1, 1] = 1 / E2\n        S[2, 2] = 1 / E3\n\n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n\n        S[3, 3] = 1 / G23\n        S[4, 4] = 1 / G13\n        S[5, 5] = 1 / G12\n        return S\n\n    def get_rotation_matrix_from_axis_angle(axis, angle_rad):\n        \"\"\"Creates a 3x3 rotation matrix using Rodrigues' formula.\"\"\"\n        axis = np.asarray(axis)\n        axis = axis / np.linalg.norm(axis)\n        K = np.array([[0, -axis[2], axis[1]],\n                      [axis[2], 0, -axis[0]],\n                      [-axis[1], axis[0], 0]])\n        R = np.eye(3) + np.sin(angle_rad) * K + (1 - np.cos(angle_rad)) * np.dot(K, K)\n        return R\n\n    def construct_bond_matrices(Q):\n        \"\"\"Constructs the Bond matrices B_sigma and B_epsilon from a rotation matrix Q.\"\"\"\n        B_sigma = np.zeros((6, 6))\n        B_epsilon = np.zeros((6, 6))\n        \n        voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n\n        for I in range(6):\n            for J in range(6):\n                i, j = voigt_map[I]\n                k, l = voigt_map[J]\n\n                if I < 3:\n                    if J < 3:\n                        B_sigma[I, J] = Q[i, k]**2\n                        B_epsilon[I, J] = Q[i, k]**2\n                    else:\n                        B_sigma[I, J] = 2 * Q[i, k] * Q[i, l]\n                        B_epsilon[I, J] = Q[i, k] * Q[i, l]\n                else:\n                    if J < 3:\n                        B_sigma[I, J] = Q[i, k] * Q[j, k]\n                        B_epsilon[I, J] = 2 * Q[i, k] * Q[j, k]\n                    else:\n                        B_sigma[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n                        B_epsilon[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n        return B_sigma, B_epsilon\n\n    test_cases = [\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'identity'}},\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'axis_angle', 'axis': [0, 0, 1], 'angle_deg': 45}},\n        {'mat': {'E1': 100, 'E2': 100, 'E3': 100, 'nu12': 0.25, 'nu13': 0.25, 'nu23': 0.25, \n                 'G12': 40, 'G13': 40, 'G23': 40}, \n         'rot': {'type': 'axis_angle', 'axis': [1, 1, 1], 'angle_deg': 40}},\n        {'mat': {'E1': 50, 'E2': 10, 'E3': 5, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 8, 'G13': 6, 'G23': 4}, \n         'rot': {'type': 'composite', 'angles_deg': [30, 20, 10]}},\n    ]\n\n    results = []\n    for case in test_cases:\n        S = construct_ortho_compliance(**case['mat'])\n        C = np.linalg.inv(S)\n\n        rot_params = case['rot']\n        if rot_params['type'] == 'identity':\n            Q = np.eye(3)\n        elif rot_params['type'] == 'axis_angle':\n            angle_rad = np.deg2rad(rot_params['angle_deg'])\n            Q = get_rotation_matrix_from_axis_angle(rot_params['axis'], angle_rad)\n        elif rot_params['type'] == 'composite':\n            angle_x_rad = np.deg2rad(rot_params['angles_deg'][0])\n            angle_y_rad = np.deg2rad(rot_params['angles_deg'][1])\n            angle_z_rad = np.deg2rad(rot_params['angles_deg'][2])\n            \n            Qx = get_rotation_matrix_from_axis_angle([1, 0, 0], angle_x_rad)\n            Qy = get_rotation_matrix_from_axis_angle([0, 1, 0], angle_y_rad)\n            Qz = get_rotation_matrix_from_axis_angle([0, 0, 1], angle_z_rad)\n            \n            Q = Qz @ Qy @ Qx\n\n        B_sigma, B_epsilon = construct_bond_matrices(Q)\n        C_prime = B_sigma @ C @ np.linalg.inv(B_epsilon)\n        coupling_block = C_prime[0:3, 3:6]\n        total_coupling = np.sum(np.abs(coupling_block))\n        \n        results.append(total_coupling)\n\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3580567"}, {"introduction": "材料的刚度张量不仅联系着应力与应变，它还控制着材料的稳定性以及波在介质中的传播方式。本高阶练习将引入声学张量 $\\mathbb{Q}(\\mathbf{n})$——一个由刚度张量派生而来的重要工具，并展示如何利用其性质来预测材料失稳（如剪切带的形成）的发生。通过检验强椭圆性条件的失效，即寻找声学张量的非正特征值，我们可以确定材料中可能形成局部化失稳的方向 $\\mathbf{n}$，从而为各向异性材料的失效分析提供强有力的预测工具 [@problem_id:3580511]。", "problem": "考虑一个正交各向异性线性弹性固体，其材料轴与笛卡尔坐标轴对齐。令 $\\sigma_{ij}$ 表示柯西应力，$\\epsilon_{kl}$ 表示无穷小应变，$C_{ijkl}$ 表示四阶刚度张量。在小应变情况下，本构关系由 $\\,\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}\\,$ 给出。对于增量波传播和局部化分析，与单位法向 $\\,\\mathbf{n}\\in\\mathbb{R}^3\\,$ 相关的声学张量 (AT) $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 通过缩并 $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$ 定义。强椭圆性条件成立当且仅当对于任意单位向量 $\\,\\mathbf{n}\\,$，$\\,\\mathbb{Q}(\\mathbf{n})\\,$ 是正定的，这等价于勒让德-阿达马条件 $\\,a_i\\,C_{ijkl}\\,n_j\\,n_l\\,a_k > 0\\,$ 对所有非零向量 $\\,\\mathbf{a},\\mathbf{n}\\in\\mathbb{R}^3\\,$ 成立。当 $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 的至少一个特征值对于某个 $\\,\\mathbf{n}\\,$ 变为非正时，就检测到强椭圆性的丧失（局部化的开始）。\n\n正交各向异性刚度可以通过工程常数指定：杨氏模量 $\\,E_1,E_2,E_3\\,$、泊松比 $\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$（具有倒易关系 $\\,\\nu_{21}=\\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{31}=\\nu_{13}\\,E_3/E_1\\,$, $\\,\\nu_{32}=\\nu_{23}\\,E_3/E_2\\,$）和剪切模量 $\\,G_{12},G_{13},G_{23}\\,$。在Voigt表示法中，$\\,6\\times 6\\,$ 的柔度矩阵 $\\,\\mathbf{S}\\,$ 的对角线元素为 $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$, $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{13}\\,$, $\\,S_{66}=1/G_{12}\\,$，对称的非对角线元素为 $\\,S_{12}=-\\nu_{12}/E_1\\,$, $\\,S_{13}=-\\nu_{13}/E_1\\,$, $\\,S_{23}=-\\nu_{23}/E_2\\,$，其中 $\\,S_{21}=-\\nu_{21}/E_2\\,$, $\\,S_{31}=-\\nu_{31}/E_3\\,$, $\\,S_{32}=-\\nu_{32}/E_3\\,$ 由倒易关系确定。在Voigt表示法中，刚度为 $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$。您的推导和计算必须基于这些定义，不得引入未经证实的简化。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 根据给定的工程常数构建正交各向异性柔度矩阵 $\\,\\mathbf{S}\\,$，强制执行泊松比的倒易关系，并计算Voigt刚度 $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$。\n- 根据 $\\,\\mathbf{C}^{\\mathrm{V}}\\,$ 和剪切模量 $\\,G_{12},G_{13},G_{23}\\,$，通过基本缩并 $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$，为任意单位向量 $\\,\\mathbf{n}=[n_1,n_2,n_3]^\\top\\,$ 计算声学张量 $\\,\\mathbb{Q}(\\mathbf{n})\\,$。此计算针对与坐标轴对齐的正交各向异性材料，且不应假设任何各向同性的简化方法。\n- 使用球面角 $\\,\\theta\\in[0,\\pi]\\,$ 和 $\\,\\phi\\in[0,2\\pi)\\,$（以弧度为单位），在 $\\,N_\\theta=41\\,$ 和 $\\,N_\\phi=81\\,$ 的均匀网格上对单位球面上的方向 $\\,\\mathbf{n}\\,$ 进行采样，其中 $\\,n_1=\\sin\\theta\\cos\\phi\\,$, $\\,n_2=\\sin\\theta\\sin\\phi\\,$, $\\,n_3=\\cos\\theta\\,$。\n- 对于下面的每个测试用例，计算在采样方向上 $\\,\\mathbb{Q}(\\mathbf{n})\\,$ 的最小特征值，确定达到该最小值的方向 $\\,\\mathbf{n}\\,$，并在最小特征值为非正时标记强椭圆性丧失。\n\n科学真实性：所有模量均以吉帕斯卡（GPa）为单位指定。在高等计算固体力学中，软化状态下各向异性介质的有效切线刚度可能包含非正的剪切模量；因此，您必须严格通过声学张量的特征值来评估强椭圆性，不得丢弃此类情况。\n\n角度：所有角度必须以弧度处理。\n\n单位：所有刚度项和特征值必须以吉帕斯卡（GPa）表示。您的程序必须以吉帕斯卡（GPa）报告特征值。\n\n测试参数集（每个元组列出 $\\,E_1,E_2,E_3\\,$，单位为GPa；$\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$，无量纲；以及 $\\,G_{12},G_{13},G_{23}\\,$，单位为GPa）：\n- 测试 $\\,1\\,$ (理想情况，强椭圆性)：$$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(50,35,25).$$\n- 测试 $\\,2\\,$ (近边界平面内剪切软化)：$$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(1.0,35,25).$$\n- 测试 $\\,3\\,$ (在 $\\,1$–$\\,2\\,$ 平面内具有软化切线的边界情况)：$$(E_1,E_2,E_3)=(20,180,160),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.15,0.10,0.08),\\quad (G_{12},G_{13},G_{23})=(-0.5,60,60).$$\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个形如 $\\,[$min\\_eigenvalue\\_in\\_GPa$,\\,n_x,\\,n_y,\\,n_z,$loss\\_boolean$]\\,$ 的列表，其顺序与上述测试集相同。例如，最终输出必须看起来像 $\\,[[\\cdots],[\\cdots],[\\cdots]]\\,$，且只包含浮点数和布尔值。\n\n所有特征值均以吉帕斯卡（GPa）作答。角度必须以弧度处理。最终程序必须完全独立，无需任何输入。", "solution": "本问题的核心是通过找到材料声学张量 $\\mathbb{Q}(\\mathbf{n})$ 在所有空间方向 $\\mathbf{n}$ 上的最小特征值，来检验其强椭圆性。强椭圆性的丧失预示着材料可能出现局部化失稳。以下是详细的计算步骤：\n\n1.  **构建柔度与刚度矩阵**：\n    首先，根据给定的工程常数（杨氏模量 $E_i$、泊松比 $\\nu_{ij}$、剪切模量 $G_{ij}$）构建 $6 \\times 6$ 的柔度矩阵 $\\mathbf{S}$。对于正交各向异性材料，该矩阵的非零元素由标准公式给出，其对称性由麦克斯韦倒易关系（如 $\\nu_{ij}/E_i = \\nu_{ji}/E_j$）保证。\n    $$\n    \\mathbf{S} = \\begin{pmatrix}\n    1/E_1  & -\\nu_{12}/E_1  & -\\nu_{13}/E_1  & 0  & 0  & 0 \\\\\n    -\\nu_{12}/E_1  & 1/E_2  & -\\nu_{23}/E_2  & 0  & 0  & 0 \\\\\n    -\\nu_{13}/E_1  & -\\nu_{23}/E_2  & 1/E_3  & 0  & 0  & 0 \\\\\n    0  & 0  & 0  & 1/G_{23}  & 0  & 0 \\\\\n    0  & 0  & 0  & 0  & 1/G_{13}  & 0 \\\\\n    0  & 0  & 0  & 0  & 0  & 1/G_{12}\n    \\end{pmatrix}\n    $$\n    随后，通过数值求逆得到Voigt表示法下的刚度矩阵 $\\mathbf{C}^\\mathrm{V} = \\mathbf{S}^{-1}$。\n\n2.  **构建声学张量 $\\mathbb{Q}(\\mathbf{n})$**：\n    声学张量 $\\mathbb{Q}(\\mathbf{n})$ 是一个 $3 \\times 3$ 的对称矩阵，其分量 $Q_{ik}$ 由缩并 $Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l$ 定义，其中 $\\mathbf{n}=[n_1, n_2, n_3]^\\top$ 是单位方向向量。对于与坐标轴对齐的正交各向异性材料，$\\mathbb{Q}(\\mathbf{n})$ 的分量可以方便地用Voigt刚度常数写出：\n    - $Q_{11} = C^\\mathrm{V}_{11} n_1^2 + C^\\mathrm{V}_{66} n_2^2 + C^\\mathrm{V}_{55} n_3^2$\n    - $Q_{22} = C^\\mathrm{V}_{66} n_1^2 + C^\\mathrm{V}_{22} n_2^2 + C^\\mathrm{V}_{44} n_3^2$\n    - $Q_{33} = C^\\mathrm{V}_{55} n_1^2 + C^\\mathrm{V}_{44} n_2^2 + C^\\mathrm{V}_{33} n_3^2$\n    - $Q_{12} = (C^\\mathrm{V}_{12} + C^\\mathrm{V}_{66}) n_1 n_2$\n    - $Q_{13} = (C^\\mathrm{V}_{13} + C^\\mathrm{V}_{55}) n_1 n_3$\n    - $Q_{23} = (C^\\mathrm{V}_{23} + C^\\mathrm{V}_{44}) n_2 n_3$\n    注意，这里的 $C^\\mathrm{V}_{44}, C^\\mathrm{V}_{55}, C^\\mathrm{V}_{66}$ 分别对应于 $G_{23}, G_{13}, G_{12}$，但仅在柔度矩阵对角的情况下。当柔度矩阵的上3x3块非对角时，求逆会使得刚度矩阵的剪切部分不再是简单的倒数，因此必须使用完整的 $\\mathbf{C}^\\mathrm{V}$ 矩阵。然而，对于正交各向异性，$\\mathbf{S}$ 和 $\\mathbf{C}^\\mathrm{V}$ 都是块对角的，所以 $C^\\mathrm{V}_{44}=G_{23}$, $C^\\mathrm{V}_{55}=G_{13}$, $C^\\mathrm{V}_{66}=G_{12}$。\n\n3.  **数值搜索最小特征值**：\n    为了检验强椭圆性，必须找到 $\\min_{\\|\\mathbf{n}\\|=1} \\lambda_{\\min}(\\mathbb{Q}(\\mathbf{n}))$，其中 $\\lambda_{\\min}$ 表示最小特征值。我们通过在单位球面上进行离散采样来近似求解这个问题。使用球面坐标 $\\mathbf{n}(\\theta, \\phi) = (\\sin\\theta\\cos\\phi, \\sin\\theta\\sin\\phi, \\cos\\theta)^\\top$，在指定的 $\\theta$ 和 $\\phi$ 网格上，为每个方向 $\\mathbf{n}$ 构建 $\\mathbb{Q}(\\mathbf{n})$ 并计算其最小特征值。通过遍历所有采样点，找到全局最小特征值及其对应的方向。\n\n4.  **评估强椭圆性**：\n    如果计算出的全局最小特征值是非正的 ($\\le 0$)，则材料丧失强椭圆性。程序会记录该最小值、对应的方向向量 $\\mathbf{n}$ 以及一个布尔值来表示强椭圆性是否丧失。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum eigenvalue of the acoustic tensor for given orthotropic\n    materials to check for loss of strong ellipticity.\n    \"\"\"\n    test_cases = [\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (50.0, 35.0, 25.0)),\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (1.0, 35.0, 25.0)),\n        ((20.0, 180.0, 160.0), (0.15, 0.10, 0.08), (-0.5, 60.0, 60.0)),\n    ]\n\n    N_theta = 41\n    N_phi = 81\n\n    final_results = []\n\n    for E_vals, nu_vals, G_vals in test_cases:\n        E1, E2, E3 = E_vals\n        nu12, nu13, nu23 = nu_vals\n        G12, G13, G23 = G_vals\n\n        S = np.zeros((6, 6))\n        \n        S[0, 0] = 1.0 / E1\n        S[1, 1] = 1.0 / E2\n        S[2, 2] = 1.0 / E3\n        S[3, 3] = 1.0 / G23\n        S[4, 4] = 1.0 / G13\n        S[5, 5] = 1.0 / G12\n        \n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n\n        C_V = np.linalg.inv(S)\n        C11, C22, C33 = C_V[0, 0], C_V[1, 1], C_V[2, 2]\n        C12, C13, C23 = C_V[0, 1], C_V[0, 2], C_V[1, 2]\n        C44, C55, C66 = C_V[3, 3], C_V[4, 4], C_V[5, 5]\n\n        min_global_eig = float('inf')\n        best_n_vector = None\n\n        thetas = np.linspace(0, np.pi, N_theta)\n        phis = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n\n        for theta in thetas:\n            for phi in phis:\n                n1 = np.sin(theta) * np.cos(phi)\n                n2 = np.sin(theta) * np.sin(phi)\n                n3 = np.cos(theta)\n\n                Q = np.zeros((3, 3))\n                \n                Q[0, 0] = C11 * n1**2 + C66 * n2**2 + C55 * n3**2\n                Q[1, 1] = C66 * n1**2 + C22 * n2**2 + C44 * n3**2\n                Q[2, 2] = C55 * n1**2 + C44 * n2**2 + C33 * n3**2\n                \n                Q[0, 1] = Q[1, 0] = (C12 + C66) * n1 * n2\n                Q[0, 2] = Q[2, 0] = (C13 + C55) * n1 * n3\n                Q[1, 2] = Q[2, 1] = (C23 + C44) * n2 * n3\n                \n                eigenvalues = np.linalg.eigvalsh(Q)\n                min_local_eig = eigenvalues[0]\n\n                if min_local_eig < min_global_eig:\n                    min_global_eig = min_local_eig\n                    best_n_vector = [n1, n2, n3]\n\n        loss_of_ellipticity = min_global_eig <= 0.0\n\n        case_result = [min_global_eig, best_n_vector[0], best_n_vector[1], best_n_vector[2], loss_of_ellipticity]\n        final_results.append(case_result)\n\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3580511"}]}