{"hands_on_practices": [{"introduction": "本章的第一个实践是一项基本技能检验。在实施复杂的数值算法之前，我们必须能够准确地评估给定应力状态下的屈服函数，以判断材料是否会发生塑性变形。此练习旨在巩固对组合硬化模型中 von Mises 屈服准则的理解，这是所有弹塑性分析的基础。[@problem_id:2570547]", "problem": "在一个小应变、率无关、关联von Mises塑性模型（带有组合线性各向同性和线性运动硬化）的单个高斯积分点上，弹性预测步骤产生如下的试探柯西应力张量（单位为兆帕，MPa）和已有的背应力张量（单位也为MPa）：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{trial}}=\\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\alpha}=\\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix}.\n$$\n初始屈服应力为 $\\,\\sigma_{y0}=65\\,$ MPa。各向同性硬化是线性的，模量为 $\\,H_{\\mathrm{iso}}=120\\,$ MPa，增量步开始时的累积等效塑性应变为 $\\,\\bar{\\varepsilon}^{p}=0.05\\,$，因此各向同性硬化变量由 $\\,R=H_{\\mathrm{iso}}\\,\\bar{\\varepsilon}^{p}\\,$ 给出。利用偏应力、偏应力第二不变量以及组合各向同性与运动硬化的von Mises等效应力（通过背应力平移偏应力得到）的定义，计算试探状态下的屈服函数值 $\\,f\\,$，并根据 $\\,f\\,$ 的符号判断该状态是弹性的还是塑性的。最终的 $\\,f\\,$ 值以MPa为单位表示，并四舍五入到四位有效数字。", "solution": "本题要求在组合线性各向同性和线性运动硬化的塑性模型背景下，对给定的试探应力状态计算 von Mises 屈服函数 $f$ 的值。屈服函数的符号将决定在该增量步下材料的响应是弹性的还是塑性的。\n\n组合硬化的 von Mises 屈服函数定义为：\n$$\nf(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, R) = \\sigma_{\\mathrm{eq}}(\\boldsymbol{s} - \\boldsymbol{\\alpha}) - (\\sigma_{y0} + R) \\le 0\n$$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\boldsymbol{s}$ 是其偏量部分，$\\boldsymbol{\\alpha}$ 是背应力张量（运动硬化），$\\sigma_{y0}$ 是初始屈服应力，而 $R$ 是各向同性硬化变量。等效应力 $\\sigma_{\\mathrm{eq}}$ 基于有效应力张量 $\\boldsymbol{\\xi} = \\boldsymbol{s} - \\boldsymbol{\\alpha}$ 定义为：\n$$\n\\sigma_{\\mathrm{eq}}(\\boldsymbol{\\xi}) = \\sqrt{\\frac{3}{2} \\boldsymbol{\\xi} : \\boldsymbol{\\xi}}\n$$\n其中 $\\boldsymbol{\\xi}:\\boldsymbol{\\xi} = \\mathrm{tr}(\\boldsymbol{\\xi}^T \\boldsymbol{\\xi})$ 是双点积。对于指定的线性各向同性硬化模型，变量 $R$ 由 $R = H_{\\mathrm{iso}}\\bar{\\varepsilon}^{p}$ 给出，其中 $H_{\\mathrm{iso}}$ 是各向同性硬化模量，$\\bar{\\varepsilon}^{p}$ 是累积等效塑性应变。\n\n任务是计算该函数在试探状态下的值，试探状态由上标“trial”表示。给定数据如下：\n试探柯西应力张量：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{trial}}=\\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n增量步开始时的背应力张量：\n$$\n\\boldsymbol{\\alpha}=\\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n材料参数和状态变量：\n初始屈服应力 $\\sigma_{y0}=65$ MPa。\n各向同性硬化模量 $H_{\\mathrm{iso}}=120$ MPa。\n累积等效塑性应变 $\\bar{\\varepsilon}^{p}=0.05$。\n\n计算过程分为几个步骤。\n\n首先，我们计算试探偏应力张量 $\\boldsymbol{s}^{\\mathrm{trial}}$。这需要计算平均应力 $\\sigma_m^{\\mathrm{trial}}$，其值为应力张量迹的三分之一。\n$$\n\\sigma_m^{\\mathrm{trial}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{trial}}) = \\frac{1}{3}(160 + 120 + 80) = \\frac{360}{3} = 120 \\, \\mathrm{MPa}\n$$\n试探偏应力张量则为 $\\boldsymbol{s}^{\\mathrm{trial}} = \\boldsymbol{\\sigma}^{\\mathrm{trial}} - \\sigma_m^{\\mathrm{trial}}\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。\n$$\n\\boldsymbol{s}^{\\mathrm{trial}} = \\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix} - 120\\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n40  30  0\\\\\n30  0  0\\\\\n0  0  -40\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n作为必要的检查，$\\boldsymbol{s}^{\\mathrm{trial}}$ 的迹为 $40 + 0 - 40 = 0$，确认了它是一个偏张量。\n\n其次，我们计算试探状态下的有效应力张量 $\\boldsymbol{\\xi} = \\boldsymbol{s}^{\\mathrm{trial}} - \\boldsymbol{\\alpha}$。注意，背应力张量 $\\boldsymbol{\\alpha}$ 本身就是偏张量；其迹为 $10 - 5 - 5 = 0$。\n$$\n\\boldsymbol{\\xi} = \\begin{pmatrix}\n40  30  0\\\\\n30  0  0\\\\\n0  0  -40\n\\end{pmatrix} - \\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix} = \\begin{pmatrix}\n30  25  0\\\\\n25  5  0\\\\\n0  0  -35\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n\n第三，我们计算 von Mises 等效应力 $\\sigma_{\\mathrm{eq}}$。这涉及到双点积 $\\boldsymbol{\\xi} : \\boldsymbol{\\xi}$。由于 $\\boldsymbol{\\xi}$ 是对称的，$\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = \\sum_{i,j} \\xi_{ij}^2$。\n$$\n\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = (30)^2 + (25)^2 + (0)^2 + (25)^2 + (5)^2 + (0)^2 + (0)^2 + (0)^2 + (-35)^2\n$$\n$$\n\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = 900 + 625 + 625 + 25 + 1225 = 3400 \\, \\mathrm{MPa}^2\n$$\n现在，等效应力为：\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}(\\boldsymbol{\\xi} : \\boldsymbol{\\xi})} = \\sqrt{\\frac{3}{2}(3400)} = \\sqrt{3 \\times 1700} = \\sqrt{5100} \\, \\mathrm{MPa}\n$$\n数值上，$\\sigma_{\\mathrm{eq}} \\approx 71.41428$ MPa。\n\n第四，我们确定当前的屈服应力 $\\sigma_y$，它定义了屈服面的大小。对于线性各向同性硬化，屈服应力的增量 $R$ 为：\n$$\nR = H_{\\mathrm{iso}}\\barvarepsilon^{p} = 120 \\, \\mathrm{MPa} \\times 0.05 = 6 \\, \\mathrm{MPa}\n$$\n当前屈服应力是初始屈服应力与此硬化贡献之和：\n$$\n\\sigma_y = \\sigma_{y0} + R = 65 \\, \\mathrm{MPa} + 6 \\, \\mathrm{MPa} = 71 \\, \\mathrm{MPa}\n$$\n\n最后，我们可以计算试探状态下屈服函数 $f$ 的值。\n$$\nf = \\sigma_{\\mathrm{eq}} - \\sigma_y = \\sqrt{5100} - 71 \\approx 71.41428 - 71 = 0.41428 \\, \\mathrm{MPa}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\nf \\approx 0.4143 \\, \\mathrm{MPa}\n$$\n由于 $f > 0$，试探应力状态位于屈服面之外。这表明该增量步的正确响应包含塑性变形。纯弹性的假设是无效的，必须应用返回映射算法将应力状态拉回到更新后的屈服面上。然而，本题只要求计算 $f$ 的值并判断状态。结论是该状态为塑性状态。", "answer": "$$\\boxed{0.4143}$$", "id": "2570547"}, {"introduction": "这项练习是连接理论与实际应用的桥梁，它展示了组合硬化模型在模拟材料循环加载行为方面的优势。通过推导在循环加载下的稳定滞回圈特征，本练习让学生直接参与硬化演化方程的积分与分析过程。这有助于深入理解材料的长期响应，并掌握分析循环塑性问题的关键技能。[@problem_id:3549542]", "problem": "一根一维小应变弹塑性杆承受一个应变控制的、关于非零平均值对称幅值的时程周期性加载：\n- 总应变被规定为 $ \\varepsilon(t) = \\varepsilon_{m} + \\varepsilon_{a} \\sin(\\omega t) $，其中 $ \\varepsilon_{m} \\neq 0 $ 且 $ \\varepsilon_{a} > 0 $。\n- 本构模型为组合的各向同性-随动硬化模型，包含以下要素：\n  - 屈服函数 $ f = |\\sigma - \\alpha| - \\left( \\sigma_{y0} + R \\right) \\le 0 $，其中 $ \\sigma $ 是柯西应力，$ \\alpha $ 是背应力，$ R $ 是各向同性硬化变量，$ \\sigma_{y0} $ 是初始屈服应力。\n  - 弹性为线性，模量为 $ E $。\n  - 一维关联形式的塑性流动：$ d\\varepsilon_{p} = \\lambda \\, \\operatorname{sign}(\\sigma - \\alpha) $，其中塑性乘子 $ \\lambda \\ge 0 $，累积塑性应变增量 $ dp = |d\\varepsilon_{p}| $。\n  - Armstrong–Frederick 型随动硬化：$ d\\alpha = c \\, d\\varepsilon_{p} - \\gamma \\, \\alpha \\, dp $，其中 $ c > 0 $ 且 $ \\gamma > 0 $。\n  - Voce 型各向同性硬化：$ dR = b \\left( Q - R \\right) dp $，其中 $ b > 0 $ 且 $ Q > 0 $。\n\n经过足够多的循环后，响应达到一个时程周期性状态（稳定循环），在此状态下，每个半循环内塑性应变累积一个恒定的增量 $ \\Delta p $（由于对称幅值，拉伸和压缩过程中的增量相同）。从上述模型定义出发，并假设在每个半循环内加载是单调的，且流动方向 $ n = \\operatorname{sign}(\\sigma - \\alpha) = \\pm 1 $ 固定，完成以下任务：\n\n- 推导背应力稳定半程幅值 $ A_{\\alpha} $ 的闭式表达式，其定义为一个稳定周期内两个应变反向点处背应力值之差的一半。结果仅用 $ c $、$ \\gamma $ 和 $ \\Delta p $ 表示。\n- 以类似方式定义并推导各向同性硬化变量的稳定半程幅值 $ A_{R} $。\n- 根据演化方程和周期性，简要论证 $ A_{\\alpha} $ 和 $ A_{R} $ 为何不依赖于平均应变偏移 $ \\varepsilon_{m} $。\n\n然后，为了进行数值验证，使用以下参数值：\n- $ c = 3.0 \\times 10^{4} \\ \\text{MPa} $，$ \\gamma = 50 $，$ b = 12 $，$ Q = 200 \\ \\text{MPa} $，\n- 稳定半循环塑性应变增量 $ \\Delta p = 4.0 \\times 10^{-3} $，\n并计算稳定背应力幅值 $ A_{\\alpha} $ 的数值。最终数值答案以兆帕（MPa）为单位，并四舍五入到四位有效数字。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 总应变历史：$ \\varepsilon(t) = \\varepsilon_{m} + \\varepsilon_{a} \\sin(\\omega t) $，其中 $ \\varepsilon_{m} \\neq 0 $ 且 $ \\varepsilon_{a} > 0 $。\n- 屈服函数：$ f = |\\sigma - \\alpha| - \\left( \\sigma_{y0} + R \\right) \\le 0 $，其中 $ \\sigma $ 是柯西应力，$ \\alpha $ 是背应力，$ R $ 是各向同性硬化变量，$ \\sigma_{y0} $ 是初始屈服应力。\n- 弹性：线性，模量为 $ E $。\n- 塑性流动法则：$ d\\varepsilon_{p} = \\lambda \\, \\operatorname{sign}(\\sigma - \\alpha) $，其中塑性乘子 $ \\lambda \\ge 0 $。\n- 累积塑性应变增量：$ dp = |d\\varepsilon_{p}| $。\n- 随动硬化 (Armstrong–Frederick)：$ d\\alpha = c \\, d\\varepsilon_{p} - \\gamma \\, \\alpha \\, dp $，其中 $ c > 0 $ 且 $ \\gamma > 0 $。\n- 各向同性硬化 (Voce)：$ dR = b \\left( Q - R \\right) dp $，其中 $ b > 0 $ 且 $ Q > 0 $。\n- 条件：达到稳定时程周期性状态。\n- 条件：在每个半循环内，塑性应变累积一个恒定的增量 $ \\Delta p $，该增量在拉伸和压缩半循环中相同。\n- 条件：每个半循环内单调加载，意味着流动方向 $ n = \\operatorname{sign}(\\sigma - \\alpha) = \\pm 1 $ 是恒定的。\n- 定义：稳定背应力幅值 $ A_{\\alpha} = \\frac{1}{2}(\\alpha_{\\max} - \\alpha_{\\min}) $。\n- 定义：稳定各向同性硬化幅值 $ A_{R} = \\frac{1}{2}(R_{\\max} - R_{\\min}) $。\n- 用于验证的数值参数：$ c = 3.0 \\times 10^{4} \\ \\text{MPa} $，$ \\gamma = 50 $，$ b = 12 $，$ Q = 200 \\ \\text{MPa} $，$ \\Delta p = 4.0 \\times 10^{-3} $。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n- **科学性：** 该问题描述了计算固体力学中的一个标准本构模型（组合的非线性各向同性-随动硬化）和一个经典的循环加载场景。Armstrong–Frederick 和 Voce 硬化法则是公认的模型。这是科学上合理的。\n- **适定性：** 所有必要的本构方程、变量和条件（稳定周期性状态、每个半循环恒定的 $ \\Delta p $）均已提供。问题的结构旨在为幅值找到一个唯一的稳定解。\n- **客观性：** 该问题使用精确的数学和工程术语表述，没有主观或含糊的语言。\n\n### 步骤3：结论与行动\n问题是有效的。将进行严谨的求解。\n\n### 背应力幅值 $ A_{\\alpha} $ 的推导\n背应力 $ \\alpha $ 的演化由以下常微分方程（ODE）控制：\n$$ d\\alpha = c \\, d\\varepsilon_{p} - \\gamma \\, \\alpha \\, dp $$\n我们考虑一个由两个半循环组成的稳定循环，每个半循环对应的累积塑性应变为 $ \\Delta p $。\n\n**半循环1（例如，拉伸过程）：**\n设流动方向为 $ n = \\operatorname{sign}(\\sigma - \\alpha) = +1 $。在这种情况下，$ d\\varepsilon_{p} = dp $。ODE 变为：\n$$ \\frac{d\\alpha}{dp} = c - \\gamma \\alpha $$\n这是一个一阶线性常微分方程。我们可以通过整理和积分来求解：\n$$ \\frac{d\\alpha}{c - \\gamma \\alpha} = dp \\implies -\\frac{1}{\\gamma} \\ln|c - \\gamma \\alpha| = p + C_1 $$\n解的形式为 $ \\alpha(p) = \\frac{c}{\\gamma} + K \\exp(-\\gamma p) $。\n设该半循环始于背应力达到其最小值 $ \\alpha_{\\min} $ 的点，且此半循环的累积塑性应变为 $ p=0 $。\n$$ \\alpha(0) = \\alpha_{\\min} = \\frac{c}{\\gamma} + K \\implies K = \\alpha_{\\min} - \\frac{c}{\\gamma} $$\n在该半循环结束时（$ p = \\Delta p $），背应力达到其最大值 $ \\alpha_{\\max} $。\n$$ \\alpha_{\\max} = \\alpha(\\Delta p) = \\frac{c}{\\gamma} + \\left( \\alpha_{\\min} - \\frac{c}{\\gamma} \\right) \\exp(-\\gamma \\Delta p) \\quad (1) $$\n\n**半循环2（例如，压缩过程）：**\n设流动方向为 $ n = \\operatorname{sign}(\\sigma - \\alpha) = -1 $。在这种情况下，$ d\\varepsilon_{p} = -dp $。ODE 变为：\n$$ \\frac{d\\alpha}{dp} = -c - \\gamma \\alpha $$\n解的形式为 $ \\alpha(p) = -\\frac{c}{\\gamma} + K' \\exp(-\\gamma p) $。\n该半循环始于背应力达到其最大值 $ \\alpha_{\\max} $ 的点。我们将此半循环的累积塑性应变重置为 $ p=0 $。\n$$ \\alpha(0) = \\alpha_{\\max} = -\\frac{c}{\\gamma} + K' \\implies K' = \\alpha_{\\max} + \\frac{c}{\\gamma} $$\n在该半循环结束时（$ p = \\Delta p $），由于稳定循环的周期性，背应力返回其最小值 $ \\alpha_{\\min} $。\n$$ \\alpha_{\\min} = \\alpha(\\Delta p) = -\\frac{c}{\\gamma} + \\left( \\alpha_{\\max} + \\frac{c}{\\gamma} \\right) \\exp(-\\gamma \\Delta p) \\quad (2) $$\n\n我们现在得到了一个关于 $ \\alpha_{\\min} $ 和 $ \\alpha_{\\max} $ 的两个线性方程组成的方程组 $(1)$ 和 $(2)$。为了求得幅值 $ A_{\\alpha} = \\frac{1}{2}(\\alpha_{\\max} - \\alpha_{\\min}) $，我们将方程 $(2)$ 从方程 $(1)$ 中减去：\n$$ \\alpha_{\\max} - \\alpha_{\\min} = \\left[ \\frac{c}{\\gamma} - \\left(-\\frac{c}{\\gamma}\\right) \\right] + \\left[ \\left( \\alpha_{\\min} - \\frac{c}{\\gamma} \\right) - \\left( \\alpha_{\\max} + \\frac{c}{\\gamma} \\right) \\right] \\exp(-\\gamma \\Delta p) $$\n$$ (\\alpha_{\\max} - \\alpha_{\\min}) = \\frac{2c}{\\gamma} + \\left( (\\alpha_{\\min} - \\alpha_{\\max}) - \\frac{2c}{\\gamma} \\right) \\exp(-\\gamma \\Delta p) $$\n代入 $ 2A_{\\alpha} = \\alpha_{\\max} - \\alpha_{\\min} $：\n$$ 2A_{\\alpha} = \\frac{2c}{\\gamma} + \\left( -2A_{\\alpha} - \\frac{2c}{\\gamma} \\right) \\exp(-\\gamma \\Delta p) $$\n$$ 2A_{\\alpha} = \\frac{2c}{\\gamma} - 2A_{\\alpha} \\exp(-\\gamma \\Delta p) - \\frac{2c}{\\gamma} \\exp(-\\gamma \\Delta p) $$\n将含有 $ A_{\\alpha} $ 的项归类：\n$$ 2A_{\\alpha} \\left( 1 + \\exp(-\\gamma \\Delta p) \\right) = \\frac{2c}{\\gamma} \\left( 1 - \\exp(-\\gamma \\Delta p) \\right) $$\n求解 $ A_{\\alpha} $：\n$$ A_{\\alpha} = \\frac{c}{\\gamma} \\frac{1 - \\exp(-\\gamma \\Delta p)}{1 + \\exp(-\\gamma \\Delta p)} $$\n此表达式可以通过双曲正切函数的定义进行简化，$ \\tanh(x) = \\frac{\\exp(x) - \\exp(-x)}{\\exp(x) + \\exp(-x)} = \\frac{1 - \\exp(-2x)}{1 + \\exp(-2x)} $。\n$$ A_{\\alpha} = \\frac{c}{\\gamma} \\tanh\\left(\\frac{\\gamma \\Delta p}{2}\\right) $$\n\n### 各向同性硬化幅值 $ A_{R} $ 的推导\n各向同性硬化变量 $ R $ 的演化由以下方程控制：\n$$ dR = b(Q - R)dp $$\n由于 $ b > 0 $ 且我们假设过程从初始状态 $ R_0 \\le Q $ 开始，因此项 $ (Q - R) $ 是非负的。根据定义，累积塑性应变增量 $ dp $ 总是非负的。因此，$ dR \\ge 0 $ 总是成立。这意味着 $ R $ 是一个关于时间（或总累积塑性应变 $ p $）的单调不减函数。\n在一个周期为 $ T $ 的时程周期性（稳定）状态下，任何状态变量 $ X(t) $ 必须满足 $ X(t+T) = X(t) $。对于各向同性硬化变量，这意味着对于任何起始时间 $ t_0 $，$ R(t_0+T) = R(t_0) $。\n一个周期内 $ R $ 的总变化为零：\n$$ \\Delta R_{\\text{cycle}} = R(t_0+T) - R(t_0) = \\int_{t_0}^{t_0+T} dR = 0 $$\n然而，我们已经确定 $ dR \\ge 0 $。一个非负函数的积分等于零，当且仅当该函数在其积分域非零的任何地方都为零。在我们的情况中，发生了塑性流动，因此在循环的某些部分 $ dp > 0 $。\n$$ \\int_{\\text{cycle}} b(Q-R)dp = 0 $$\n为了使该积分在 $ \\int_{\\text{cycle}} dp = 2 \\Delta p > 0 $ 的情况下为零，只要 $ dp > 0 $，被积函数就必须为零。由于 $ b>0 $，这要求 $ Q - R = 0 $，即在所有塑性变形阶段 $ R = Q $。\n当没有塑性流动（$ dp=0 $）时，$ dR=0 $，因此 $ R $ 保持不变。\n因此，在稳定周期性状态下，各向同性硬化变量必须是恒定的，并等于其饱和值 $ Q $。\n$$ R(t) = Q \\quad \\text{对于稳定状态下的所有 } t $$\n这意味着 $ R_{\\max} = R_{\\min} = Q $。因此，稳定半程幅值为：\n$$ A_{R} = \\frac{1}{2}(R_{\\max} - R_{\\min}) = \\frac{1}{2}(Q - Q) = 0 $$\n\n### 关于不依赖于平均应变 $ \\varepsilon_{m} $ 的论证\n推导出的幅值表达式为 $ A_{\\alpha} = \\frac{c}{\\gamma} \\tanh\\left(\\frac{\\gamma \\Delta p}{2}\\right) $ 和 $ A_{R} = 0 $。\n这两个表达式都不包含平均应变 $ \\varepsilon_m $。这种独立性是硬化定律结构的直接结果。$ \\alpha $ 和 $ R $ 的演化方程都是率形式的方程，仅依赖于塑性应变增量（$ d\\varepsilon_p $、$ dp $）和状态变量的当前值（$ \\alpha $、$ R $），而不依赖于总应变 $ \\varepsilon $ 或应力 $ \\sigma $。\n幅值 $ A_{\\alpha} $ 和 $ A_{R} $ 表征了 $ \\sigma-\\varepsilon $ 平面中滞回环的大小，而平均应变 $ \\varepsilon_m $（以及相应的平均应力 $ \\sigma_m $）决定了其位置。幅值的计算依赖于在两个塑性应变半循环上对率方程进行积分并施加周期性条件。由于问题指定了两个半循环的循环塑性应变增量 $ \\Delta p $ 是对称的，因此得到的幅值仅依赖于此增量和控制硬化演化的材料参数（$ A_{\\alpha} $ 的 $ c $、$ \\gamma $；$ A_{R} $ 的 $ b $、$ Q $）。平均应变 $ \\varepsilon_m $ 仅影响状态变量振荡的中心值，而不影响其振荡的幅值。\n\n### 数值验证计算\n我们被要求使用提供的参数计算 $ A_{\\alpha} $ 的数值：\n$ c = 3.0 \\times 10^{4} \\ \\text{MPa} $，$ \\gamma = 50 $，$ \\Delta p = 4.0 \\times 10^{-3} $。\n公式为：\n$$ A_{\\alpha} = \\frac{c}{\\gamma} \\tanh\\left(\\frac{\\gamma \\Delta p}{2}\\right) $$\n首先，我们计算比率 $ \\frac{c}{\\gamma} $：\n$$ \\frac{c}{\\gamma} = \\frac{3.0 \\times 10^{4} \\ \\text{MPa}}{50} = 600 \\ \\text{MPa} $$\n接下来，我们计算双曲正切函数的参数：\n$$ \\frac{\\gamma \\Delta p}{2} = \\frac{50 \\times (4.0 \\times 10^{-3})}{2} = \\frac{0.20}{2} = 0.1 $$\n现在，将这些值代入 $ A_{\\alpha} $ 的表达式中：\n$$ A_{\\alpha} = 600 \\ \\text{MPa} \\times \\tanh(0.1) $$\n使用计算器计算 $ \\tanh(0.1) $：\n$$ \\tanh(0.1) \\approx 0.0996679946 $$\n最后，我们计算 $ A_{\\alpha} $：\n$$ A_{\\alpha} \\approx 600 \\times 0.0996679946 \\ \\text{MPa} \\approx 59.80079676 \\ \\text{MPa} $$\n根据要求将结果四舍五入到四位有效数字：\n$$ A_{\\alpha} \\approx 59.80 \\ \\text{MPa} $$", "answer": "$$\\boxed{59.80}$$", "id": "3549542"}, {"introduction": "这是本章的综合性顶石实践，它将前面学到的所有概念融会贯通。从第一性原理出发构建一个完整的数值模拟，是对理论理解的最终考验。本练习将指导你实现一个包含“返回映射”算法的应力更新程序，并在复杂的非比例加载路径下验证其是否满足基本的 Karush-Kuhn-Tucker (KKT) 条件，从而为你提供一个强大的计算分析工具。[@problem_id:3549555]", "problem": "构建一个完整、可运行的程序，用于在三维空间中对包含组合等向-随动硬化的小应变关联 $J_2$ 塑性模型的 Karush-Kuhn-Tucker (KKT) 一致性条件 $\\dot{\\lambda} \\ge 0$、$f \\le 0$ 和 $\\dot{\\lambda} f = 0$ 进行数值验证。验证必须沿一条非平凡、非比例的应变路径执行，该路径具有急剧的方向变化（路径中的拐角），以确保路径遍历弹性域边界附近。\n\n使用以下基本原理来指导推导和算法：\n- 小应变运动学：无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 可加法分解为 $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{e} + \\boldsymbol{\\varepsilon}^{p}$，其中 $\\boldsymbol{\\varepsilon}^{e}$ 是弹性应变，$\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变。\n- 线性各向同性弹性：柯西应力 $\\boldsymbol{\\sigma} = 2 G\\, \\text{dev}(\\boldsymbol{\\varepsilon}^{e}) + 3 K\\, \\text{sph}(\\boldsymbol{\\varepsilon}^{e})$，其中 $G = \\dfrac{E}{2(1+\\nu)}$ 是剪切模量，$K = \\dfrac{E}{3(1-2\\nu)}$ 是体积模量，$\\text{dev}(\\cdot)$ 是偏量投影，$\\text{sph}(\\cdot)$ 是球量投影 $\\text{sph}(\\mathbf{A}) = \\dfrac{1}{3}\\,\\text{tr}(\\mathbf{A})\\,\\mathbf{I}$。\n- 包含组合硬化的 $J_2$ 屈服条件：定义用于随动硬化的背应力张量 $\\boldsymbol{\\alpha}$ 和等向硬化变量 $R = H_{\\text{iso}}\\,p$，其中 $p$ 是等效塑性应变，$H_{\\text{iso}}$ 和 $H_{\\text{kin}}$ 是常数模量。屈服函数为 $f(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, R) = \\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sqrt{\\dfrac{2}{3}}\\left(\\sigma_{y0} + R\\right)$，其中 $\\boldsymbol{s} = \\text{dev}(\\boldsymbol{\\sigma})$，$\\sigma_{y0}$ 是初始屈服应力，$\\|\\cdot\\|$ 是 Frobenius 范数。\n- 关联流动法则和硬化演化：塑性应变偏量沿屈服面的法向 $\\boldsymbol{N}$ 演化，并且 $\\boldsymbol{\\alpha}$ 随 $\\boldsymbol{\\varepsilon}^{p}$ 线性演化。\n\n您的程序必须实现一个从这些原理推导出的鲁棒的增量式应力更新算法，不依赖任何外部提供的简化公式。它必须在每个应变增量步中计算：\n- 试探弹性响应。\n- 当试探状态违反屈服准则时进行塑性修正，通过返回映射算法强制保持一致性，并满足离散形式的 KKT 条件，即在微小的数值容差范围内满足 $\\Delta \\lambda \\ge 0$、$f_{n+1} \\le 0$ 和 $\\Delta \\lambda \\, f_{n+1} = 0$。\n\n物理单位和数值约定：\n- 应力单位为 $\\text{MPa}$，应变为无量纲。\n- 不涉及角度，因此不需要角度单位。\n- $f$ 的容差必须以 $\\text{MPa}$ 指定，$\\Delta \\lambda$ 的容差为无量纲。\n\n设计一个包含3个测试用例的测试套件，覆盖以下情况：\n- 一个具有非比例加载的通用情况，其特点是应变路径中有多个拐角，产生屈服和反向加载（由随动硬化引起的 Bauschinger 型效应）。\n- 一个整个路径保持严格弹性的边界条件情况。\n- 一个路径接近屈服面并在屈服后通过交替增量在其附近徘徊的边缘情况。\n\n对于所有情况，使用科学上真实的材料参数。对于每个用例，请指定：\n- 杨氏模量 $E$（单位 MPa），泊松比 $\\nu$，初始屈服应力 $\\sigma_{y0}$（单位 MPa），等向硬化模量 $H_{\\text{iso}}$（单位 MPa），以及随动硬化模量 $H_{\\text{kin}}$（单位 MPa）。\n- 一个定义为 $3 \\times 3$ 应变增量 $\\Delta \\boldsymbol{\\varepsilon}_k$ 列表的非比例应变路径，其中至少包含2个加载方向的拐角。\n\n数值验证：\n- 在每个增量步 $k$，计算该步结束时的 $\\Delta \\lambda_k$ 和更新后的屈服函数 $f_{k}$。\n- 检查离散形式的 KKT 条件：$\\Delta \\lambda_k \\ge 0$，$f_{k} \\le \\tau_f$ 和 $|\\Delta \\lambda_k\\, f_{k}| \\le \\tau_c$，其中 $\\tau_f$ 和 $\\tau_c$ 是用户定义的容差，$\\tau_f$ 的单位是 $\\text{MPa}$，$\\tau_c$ 的单位是 $\\text{MPa}$。\n- 使用 $\\tau_f = 10^{-6}$ 和 $\\tau_c = 10^{-6}$，以及 $\\Delta \\lambda$ 的非负性容差为 $10^{-12}$。\n\n答案格式：\n- 对于每个测试用例，仅当该用例中的所有增量步都在指定容差内满足所有三个 KKT 检查时，才返回布尔值 $ \\text{True} $。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result1,result2,result3]$）。\n\n要实现的测试套件参数值：\n- 用例 1（通用非比例加载，带拐角和屈服-反转）：$E = 210000$ $\\text{MPa}$，$\\nu = 0.30$，$\\sigma_{y0} = 250$ $\\text{MPa}$，$H_{\\text{iso}} = 1000$ $\\text{MPa}$，$H_{\\text{kin}} = 15000$ $\\text{MPa}$。应变路径段：\n  - $20$ 个增量步：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.00020, 0, 0)$，\n  - $10$ 个增量步：$xy$ 平面剪切，$\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.00060$，\n  - $15$ 个增量步：$xx$ 方向反向轴向加载，$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(-0.00015, 0, 0)$，\n  - $10$ 个增量步：$yz$ 平面剪切，$\\Delta \\varepsilon_{yz} = \\Delta \\varepsilon_{zy} = 0.00050$。\n- 用例 2（严格弹性）：$E = 70000$ $\\text{MPa}$，$\\nu = 0.33$，$\\sigma_{y0} = 300$ $\\text{MPa}$，$H_{\\text{iso}} = 5000$ $\\text{MPa}$，$H_{\\text{kin}} = 20000$ $\\text{MPa}$。应变路径段：\n  - $30$ 个增量步：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.000001, 0, 0)$，\n  - $30$ 个增量步：$xy$ 平面剪切，$\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.000001$。\n- 用例 3（边缘情况：通过交替增量和拐角在屈服点附近徘徊）：$E = 210000$ $\\text{MPa}$，$\\nu = 0.30$，$\\sigma_{y0} = 250$ $\\text{MPa}$，$H_{\\text{iso}} = 2000$ $\\text{MPa}$，$H_{\\text{kin}} = 10000$ $\\text{MPa}$。应变路径段：\n  - $5$ 个增量步：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.00080, 0, 0)$，\n  - $20$ 个 $xy$ 平面交替剪切增量：对于 $k = 1, 2, \\dots, 20$，如果 $k$ 是奇数，则设置 $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.00010$；如果 $k$ 是偶数，则设置 $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = -0.00010$，\n  - $10$ 个增量步：$\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(-0.00005, 0, 0)$，\n  - $10$ 个增量步：$yz$ 平面剪切，$\\Delta \\varepsilon_{yz} = \\Delta \\varepsilon_{zy} = 0.00006$。\n\n您的程序必须使用这些确切的参数集和路径，应用所描述的算法，并按指定格式输出单行结果：一个包含3个布尔值的列表。", "solution": "该问题要求构建并数值验证一个用于小应变关联 $J_2$ 塑性（包含组合线性等向和随动硬化）的应力更新算法。验证将通过检查非比例应变路径下的 Karush-Kuhn-Tucker (KKT) 条件来执行。\n\n### 1. 基本原理\n\n本构模型由以下方程组定义：\n\n1.  **应变加法分解**：总应变张量 $\\boldsymbol{\\varepsilon}$ 分解为弹性部分 $\\boldsymbol{\\varepsilon}^e$ 和塑性部分 $\\boldsymbol{\\varepsilon}^p$：\n    $$ \\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p $$\n\n2.  **线性各向同性弹性**：柯西应力张量 $\\boldsymbol{\\sigma}$ 通过胡克定律与弹性应变 $\\boldsymbol{\\varepsilon}^e$ 相关联：\n    $$ \\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e = 2G\\,\\text{dev}(\\boldsymbol{\\varepsilon}^e) + K\\,\\text{tr}(\\boldsymbol{\\varepsilon}^e)\\mathbf{I} $$\n    其中 $G$ 是剪切模量，$K$ 是体积模量。$\\text{dev}(\\cdot)$ 是偏量算子，$\\text{tr}(\\cdot)$ 是迹算子。\n\n3.  **$J_2$ 屈服条件**：当屈服函数 $f$ 为非负时，开始发生塑性变形。对于组合硬化，屈服函数为：\n    $$ f(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, p) = \\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + R) $$\n    其中 $\\boldsymbol{s} = \\text{dev}(\\boldsymbol{\\sigma})$ 是偏应力，$\\boldsymbol{\\alpha}$ 是背应力张量（随动硬化），$R$ 是等向硬化变量。范数 $\\|\\cdot\\|$ 是 Frobenius 范数。\n\n4.  **关联流动法则**：塑性应变的演化方向垂直于屈服面：\n    $$ \\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\dot{\\lambda} \\boldsymbol{N} $$\n    其中 $\\dot{\\lambda} \\ge 0$ 是塑性一致性参数，$\\boldsymbol{N} = \\frac{\\boldsymbol{s} - \\boldsymbol{\\alpha}}{\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\|}$ 是应力空间中屈服面的法向量。注意 $\\boldsymbol{\\varepsilon}^p$ 是纯偏量的，即 $\\text{tr}(\\boldsymbol{\\varepsilon}^p) = 0$。\n\n5.  **硬化法则**：\n    - **等向硬化**：屈服面的尺寸随等效塑性应变 $p$ 演化。\n      $$ R = H_{\\text{iso}}p $$\n      等效塑性应变率 $\\dot{p}$ 定义为 $\\dot{p} = \\sqrt{\\frac{2}{3}\\dot{\\boldsymbol{\\varepsilon}}^p : \\dot{\\boldsymbol{\\varepsilon}}^p} = \\sqrt{\\frac{2}{3}}\\dot{\\lambda}$。\n    - **随动硬化**：屈服面的中心根据线性 (Prager) 法则演化：\n      $$ \\dot{\\boldsymbol{\\alpha}} = \\frac{2}{3}H_{\\text{kin}}\\dot{\\boldsymbol{\\varepsilon}}^p $$\n\n6.  **KKT 条件**：这些是加载/卸载条件：\n    $$ \\dot{\\lambda} \\ge 0, \\quad f \\le 0, \\quad \\dot{\\lambda}f = 0 $$\n\n### 2. 增量式应力更新算法\n\n将连续方程在一个离散的时间（或载荷）步（从 $t_n$ 到 $t_{n+1}$）上进行积分。我们使用后向欧拉（完全隐式）格式，该格式是无条件稳定的。第 $n$ 步的状态变量（$\\boldsymbol{\\varepsilon}_n^p$, $\\boldsymbol{\\alpha}_n$, $p_n$）是已知的，总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 是给定的。\n\n**第1步：弹性预测（试探状态）**\n首先，我们假设整个增量是弹性的。塑性状态变量保持不变。\n- 试探塑性应变：$\\boldsymbol{\\varepsilon}_{n+1}^{p, \\text{trial}} = \\boldsymbol{\\varepsilon}_n^p$\n- 试探背应力：$\\boldsymbol{\\alpha}_{n+1}^{\\text{trial}} = \\boldsymbol{\\alpha}_n$\n- 试探等效塑性应变：$p_{n+1}^{\\text{trial}} = p_n \\implies R_{n+1}^{\\text{trial}} = H_{\\text{iso}} p_n$\n\n试探应力由更新后的总应变 $\\boldsymbol{\\varepsilon}_{n+1} = \\boldsymbol{\\varepsilon}_n + \\Delta\\boldsymbol{\\varepsilon}$ 计算得出：\n$$ \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_n^p) = \\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon} $$\n用于实现的张量分量形式：\n$$ \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\boldsymbol{\\sigma}_n + 2G\\,\\text{dev}(\\Delta\\boldsymbol{\\varepsilon}) + K\\,\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})\\mathbf{I} $$\n\n**第2步：屈服检查**\n我们在试探状态下评估屈服函数：\n$$ f_{n+1}^{\\text{trial}} = \\|\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) $$\n- 如果 $f_{n+1}^{\\text{trial}} \\le 0$，则假设正确。该步是弹性的。$n+1$ 步的状态即为试探状态。该增量的塑性乘子 $\\Delta\\lambda$ 为 0。\n- 如果 $f_{n+1}^{\\text{trial}} > 0$，则状态位于屈服面之外。发生塑性变形，需要进行修正。\n\n**第3步：塑性修正（返回映射）**\n对于塑性步，最终状态 $(\\boldsymbol{\\sigma}_{n+1}, \\boldsymbol{\\alpha}_{n+1}, p_{n+1})$ 必须位于更新后的屈服面上，因此 $f_{n+1} = 0$。使用后向欧拉格式，离散的演化方程为：\n- 塑性应变增量：$\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\varepsilon}_{n+1}^p - \\boldsymbol{\\varepsilon}_n^p = \\Delta\\lambda \\boldsymbol{N}_{n+1}$\n- 等效塑性应变：$p_{n+1} = p_n + \\Delta p = p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$\n- 背应力：$\\boldsymbol{\\alpha}_{n+1} = \\boldsymbol{\\alpha}_n + \\Delta\\boldsymbol{\\alpha} = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\lambda\\boldsymbol{N}_{n+1}$\n\n$n+1$ 步的应力与试探应力相关：\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\lambda\\boldsymbol{N}_{n+1} $$\n设相对偏应力为 $\\boldsymbol{\\xi} = \\boldsymbol{s} - \\boldsymbol{\\alpha}$。在最终状态下：\n$$ \\boldsymbol{\\xi}_{n+1} = \\boldsymbol{s}_{n+1} - \\boldsymbol{\\alpha}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\lambda\\boldsymbol{N}_{n+1}) - (\\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\lambda\\boldsymbol{N}_{n+1}) $$\n$$ \\boldsymbol{\\xi}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n) - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda \\boldsymbol{N}_{n+1} $$\n令 $\\boldsymbol{\\xi}_{n+1}^{\\text{trial}} = \\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n$，并注意到 $\\boldsymbol{N}_{n+1}$ 的方向必须与 $\\boldsymbol{\\xi}_{n+1}$ 相同，因此也与 $\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}$ 相同，我们可以设置 $\\boldsymbol{N}_{n+1} = \\boldsymbol{\\xi}_{n+1}^{\\text{trial}} / \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\|$。该方程变为范数之间的标量关系：\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda $$\n屈服条件 $f_{n+1} = 0$ 要求：\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + R_{n+1}) = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}} p_{n+1}) = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}(p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda)) $$\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) + \\frac{2}{3}H_{\\text{iso}}\\Delta\\lambda $$\n将 $\\|\\boldsymbol{\\xi}_{n+1}\\|$ 的两个表达式相等：\n$$ \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) + \\frac{2}{3}H_{\\text{iso}}\\Delta\\lambda $$\n注意到 $f_{n+1}^{\\text{trial}} = \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n)$，我们求解 $\\Delta\\lambda$：\n$$ f_{n+1}^{\\text{trial}} = \\left( 2G + \\frac{2}{3}H_{\\text{kin}} + \\frac{2}{3}H_{\\text{iso}} \\right) \\Delta\\lambda $$\n$$ \\Delta\\lambda = \\frac{f_{n+1}^{\\text{trial}}}{2G + \\frac{2}{3}(H_{\\text{iso}} + H_{\\text{kin}})} $$\n由于 $f_{n+1}^{\\text{trial}} > 0$，因此 $\\Delta\\lambda > 0$，满足第一个 KKT 条件。\n\n**第4步：状态更新**\n一旦 $\\Delta\\lambda$ 已知，所有状态变量都会被更新：\n1.  计算法向量 $\\boldsymbol{N}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n) / \\|\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n\\|$。\n2.  计算塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\boldsymbol{N}_{n+1}$。\n3.  更新塑性应变：$\\boldsymbol{\\varepsilon}_{n+1}^p = \\boldsymbol{\\varepsilon}_n^p + \\Delta\\boldsymbol{\\varepsilon}^p$。\n4.  更新等效塑性应变：$p_{n+1} = p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$。\n5.  更新背应力：$\\boldsymbol{\\alpha}_{n+1} = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\boldsymbol{\\varepsilon}^p$。\n6.  更新应力：$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\Delta\\boldsymbol{\\varepsilon}^p$。\n\n### 3. KKT 条件的数值验证\n\n在每个增量步 $k$ 结束时，我们使用计算出的步长值 $\\Delta\\lambda_k$ 和最终的屈服函数值 $f_k = f(\\boldsymbol{\\sigma}_k, \\boldsymbol{\\alpha}_k, p_k)$ 来验证离散的 KKT 条件：\n1.  **一致性参数非负性**：$\\Delta\\lambda_k \\ge 0$（使用容差进行验证：$\\Delta\\lambda_k \\ge -10^{-12}$）。\n2.  **屈服条件容许性**：$f_k \\le 0$（使用容差进行验证：$f_k \\le \\tau_f = 10^{-6}$）。\n3.  **互补条件**：$\\Delta\\lambda_k f_k = 0$（使用容差进行验证：$|\\Delta\\lambda_k f_k| \\le \\tau_c = 10^{-6}$）。\n\n仅当一个测试用例的应变路径中的每个增量步都满足所有三个条件时，该用例才被认为是有效的（'True'）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global tolerances for KKT checks\nTOL_F = 1e-6  # Tolerance for yield function f = TOL_F\nTOL_C = 1e-6  # Tolerance for consistency product |dL*f| = TOL_C\nTOL_LAMBDA = -1e-12  # Tolerance for dL >= 0\n\ndef deviatoric(tensor):\n    \"\"\"Computes the deviatoric part of a 3x3 tensor.\"\"\"\n    return tensor - (1/3) * np.trace(tensor) * np.identity(3)\n\ndef frobenius_norm(tensor):\n    \"\"\"Computes the Frobenius norm of a 3x3 tensor.\"\"\"\n    return np.sqrt(np.sum(tensor**2))\n\ndef run_simulation(E, nu, sig_y0, H_iso, H_kin, strain_path):\n    \"\"\"\n    Runs a simulation for a given material and strain path, validating KKT conditions.\n    \"\"\"\n    # Initialize material parameters from E and nu\n    G = E / (2 * (1 + nu))  # Shear modulus\n    K = E / (3 * (1 - 2 * nu)) # Bulk modulus\n    \n    # Combined hardening modulus for denominator in dL calculation\n    H_comb = 2 * G + (2/3) * (H_iso + H_kin)\n\n    # Initialize state variables at t=0\n    strain = np.zeros((3, 3))\n    stress = np.zeros((3, 3))\n    strain_p = np.zeros((3, 3))  # Plastic strain\n    alpha = np.zeros((3, 3))      # Backstress (kinematic hardening)\n    p = 0.0                      # Equivalent plastic strain (for isotropic hardening)\n\n    for delta_strain in strain_path:\n        # Update total strain\n        strain += delta_strain\n        \n        # 1. Trial State (Elastic Predictor)\n        # Compute trial stress increment and total trial stress\n        delta_stress_trial = 2 * G * deviatoric(delta_strain) + K * np.trace(delta_strain) * np.identity(3)\n        stress_trial = stress + delta_stress_trial\n        s_trial = deviatoric(stress_trial)\n\n        # Trial relative stress deviator\n        xi_trial = s_trial - alpha\n        norm_xi_trial = frobenius_norm(xi_trial)\n\n        # Yield stress at the beginning of the increment (from state 'n')\n        sig_y_n = sig_y0 + H_iso * p\n        \n        # Evaluate trial yield function\n        f_trial = norm_xi_trial - np.sqrt(2/3) * sig_y_n\n\n        # 2. Yield Check\n        if f_trial = TOL_F:  # Elastic step or within tolerance\n            # Update state to trial state\n            stress = stress_trial\n            # No change in plastic variables\n            \n            delta_lambda = 0.0\n            f_n1 = f_trial\n\n        else:  # Plastic step\n            # 3. Plastic Corrector (Return Mapping)\n            # Calculate consistency parameter\n            delta_lambda = f_trial / H_comb\n            \n            # Normal to the yield surface\n            N = xi_trial / norm_xi_trial\n            \n            # 4. Update State Variables\n            delta_strain_p = delta_lambda * N\n            strain_p += delta_strain_p\n            \n            p += np.sqrt(2/3) * delta_lambda\n            \n            alpha += (2/3) * H_kin * delta_strain_p\n            \n            # Correct the stress\n            stress = stress_trial - 2 * G * delta_strain_p\n            \n            # Recalculate yield function at the end of the step for verification\n            s_n1 = deviatoric(stress)\n            sig_y_n1 = sig_y0 + H_iso * p\n            f_n1 = frobenius_norm(s_n1 - alpha) - np.sqrt(2/3) * sig_y_n1\n\n        # 5. KKT Validation\n        check1 = delta_lambda >= TOL_LAMBDA\n        check2 = f_n1 = TOL_F\n        check3 = abs(delta_lambda * f_n1) = TOL_C\n        \n        if not (check1 and check2 and check3):\n            return False  # KKT conditions failed for this increment\n\n    return True # All increments passed KKT checks\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for validating the plasticity model.\n    \"\"\"\n    # Case 1: General non-proportional loading\n    strain_path_1 = []\n    # Segment 1: Axial loading in x-direction\n    for _ in range(20):\n        strain_path_1.append(np.array([[0.00020, 0, 0], [0, 0, 0], [0, 0, 0]]))\n    # Segment 2: Shear in xy-plane\n    d_eps_shear_xy = np.array([[0, 0.00060, 0], [0.00060, 0, 0], [0, 0, 0]])\n    for _ in range(10):\n        strain_path_1.append(d_eps_shear_xy)\n    # Segment 3: Reverse axial loading in x-direction\n    for _ in range(15):\n        strain_path_1.append(np.array([[-0.00015, 0, 0], [0, 0, 0], [0, 0, 0]]))\n    # Segment 4: Shear in yz-plane\n    d_eps_shear_yz = np.array([[0, 0, 0], [0, 0, 0.00050], [0, 0.00050, 0]])\n    for _ in range(10):\n        strain_path_1.append(d_eps_shear_yz)\n    \n    case1 = (210000.0, 0.30, 250.0, 1000.0, 15000.0, strain_path_1)\n\n    # Case 2: Strictly elastic path\n    strain_path_2 = []\n    # Segment 1: Small axial loading\n    for _ in range(30):\n        strain_path_2.append(np.array([[0.000001, 0, 0], [0, 0, 0], [0, 0, 0]]))\n    # Segment 2: Small shear loading\n    d_eps_shear_xy_2 = np.array([[0, 0.000001, 0], [0.000001, 0, 0], [0, 0, 0]])\n    for _ in range(30):\n        strain_path_2.append(d_eps_shear_xy_2)\n    \n    case2 = (70000.0, 0.33, 300.0, 5000.0, 20000.0, strain_path_2)\n\n    # Case 3: Near-yield path with corners and alternating increments\n    strain_path_3 = []\n    # Segment 1: Axial loading to near yield\n    for _ in range(5):\n        strain_path_3.append(np.array([[0.00080, 0, 0], [0, 0, 0], [0, 0, 0]]))\n    # Segment 2: Alternating shear increments\n    d_eps_shear_xy_3_pos = np.array([[0, 0.00010, 0], [0.00010, 0, 0], [0, 0, 0]])\n    d_eps_shear_xy_3_neg = -d_eps_shear_xy_3_pos\n    for k in range(1, 21):\n        strain_path_3.append(d_eps_shear_xy_3_pos if k % 2 != 0 else d_eps_shear_xy_3_neg)\n    # Segment 3: Small reverse axial load\n    for _ in range(10):\n        strain_path_3.append(np.array([[-0.00005, 0, 0], [0, 0, 0], [0, 0, 0]]))\n    # Segment 4: Shear in yz-plane\n    d_eps_shear_yz_3 = np.array([[0, 0, 0], [0, 0, 0.00006], [0, 0.00006, 0]])\n    for _ in range(10):\n        strain_path_3.append(d_eps_shear_yz_3)\n    \n    case3 = (210000.0, 0.30, 250.0, 2000.0, 10000.0, strain_path_3)\n\n    test_cases = [case1, case2, case3]\n    \n    results = []\n    for E, nu, sig_y0, H_iso, H_kin, strain_path in test_cases:\n        result = run_simulation(E, nu, sig_y0, H_iso, H_kin, strain_path)\n        results.append(result)\n        \n    # The final print statement must match the format \"[result1,result2,result3]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3549555"}]}