{"hands_on_practices": [{"introduction": "在显式与隐式方法之间做出选择，其核心往往在于显式求解器固有的时间步长限制。本练习将通过一个动手推导，帮助你深入理解这一限制。通过分析一个在一维非均匀网格中传播的波，你将直接应用CFL条件来确定所需的自适应时间步长，从而巩固对网格尺寸和材料属性如何主导显式模拟稳定性的理解。", "problem": "一根总长度为 $L = L_1 + L_2$ 的一维棱柱形弹性杆，为进行显式动力学分析而被离散化。其网格在左侧区域 $0 \\le x  L_1$ 较粗，在右侧区域 $L_1 \\le x \\le L$ 则被加密。左侧区域具有恒定的杨氏模量 $E_1$、质量密度 $\\rho_1$ 和均匀的单元尺寸 $h_1$。右侧区域具有恒定的杨氏模量 $E_2$、质量密度 $\\rho_2$ 和均匀的单元尺寸 $h_2$，且 $h_2  h_1$。除此之外，该杆不受任何外加载荷和阻尼的影响。\n\n在时间 $t=0$ 时，一个小的振幅纵向脉冲在 $x=0$ 处产生并向右传播。假设采用线性运动学，一维纵向波速 $c(x)$ 满足 $c(x) = \\sqrt{E(x)/\\rho(x)}$，并且由于阻抗匹配（即选择材料对以使透射占主导地位），在 $x=L_1$ 处的反射可以忽略不计。显式时间积分器是应用于杆的半离散化运动方程的标准二阶中心差分法。您选择显式动力学而非隐式动力学来解析短波长的瞬态响应，并试图通过在波前从粗网格区域传播到加密网格区域时自适应地改变全局时间步长 $\\Delta t$，来为承载脉冲的单元维持一个统一的 Courant-Friedrichs-Lewy (CFL) 数。\n\n设目标 Courant-Friedrichs-Lewy 数为一个常数 $0  \\alpha  1$。设 $c_1 = \\sqrt{E_1/\\rho_1}$ 和 $c_2 = \\sqrt{E_2/\\rho_2}$ 分别表示左侧和右侧区域的波速。波前位置为 $x(t)$，以局部波速移动，界面穿越时间为 $t^{\\ast} = L_1 / c_1$。自适应显式策略设置全局时间步长 $\\Delta t(t)$，使得当前承载波前的单元集中的 CFL 数等于 $\\alpha$。\n\n请从第一性原理出发，不使用任何预先给定的稳定性捷径，推导自适应时间步长函数 $\\Delta t(t)$ 的解析表达式，该表达式应以 $t$、$\\alpha$、$h_1$、$h_2$、$c_1$、$c_2$ 和 $L_1$ 表示。将您的最终结果表示为单个闭式表达式，使用 Heaviside 阶跃函数 $H(\\cdot)$ 来表示在 $t^{\\ast}$ 时的变化。最终答案以秒为单位表示。无需进行数值计算，您的最终答案必须是单一的解析表达式。", "solution": "首先对问题进行验证，以确保其具有科学依据、是良定的且客观的。\n\n**步骤 1：提取已知条件**\n- 一根总长度为 $L = L_1 + L_2$ 的一维棱柱形弹性杆。\n- 区域被离散化为两个部分：\n    1.  左侧区域 ($0 \\le x  L_1$)：杨氏模量 $E_1$，质量密度 $\\rho_1$，均匀单元尺寸 $h_1$。\n    2.  右侧区域 ($L_1 \\le x \\le L$)：杨氏模量 $E_2$，质量密度 $\\rho_2$，均匀单元尺寸 $h_2$。\n- 右侧区域的网格被加密，因此 $h_2  h_1$。\n- 系统不受外加载荷和阻尼的影响。\n- 在时间 $t=0$ 时，一个小的振幅纵向脉冲在 $x=0$ 处产生并向右传播。\n- 分析假设采用线性运动学。\n- 一维纵向波速由 $c(x) = \\sqrt{E(x)/\\rho(x)}$ 给出。在两个区域中，恒定的波速分别为 $c_1 = \\sqrt{E_1/\\rho_1}$ 和 $c_2 = \\sqrt{E_2/\\rho_2}$。\n- 界面 $x=L_1$ 处的反射被认为可以忽略不计。\n- 时间积分格式为标准二阶中心差分法。\n- 自适应时间步长策略旨在通过改变全局时间步长 $\\Delta t(t)$，为承载波前的单元维持一个恒定的 Courant-Friedrichs-Lewy (CFL) 数 $\\alpha$（其中 $0  \\alpha  1$）。\n- 波前在时间 $t^{\\ast} = L_1 / c_1$ 穿过界面。\n- 任务是使用 Heaviside 阶跃函数 $H(\\cdot)$ 推导自适应时间步长函数 $\\Delta t(t)$ 的解析表达式。\n\n**步骤 2：验证**\n该问题在科学上基于波传播和偏微分方程（PDE）数值方法的成熟理论，特别是波动方程的有限元或有限差分解。CFL 稳定性、中心差分格式、波速和网格属性等概念在计算力学中是标准内容。问题是良定的，提供了所有必要信息和明确的目标。语言精确且客观。可忽略反射的简化假设是一种标准技术，用于分离出所关注的现象，在本例中即变化的网格和材料属性对自适应时间步长的影响。所指定的自适应策略虽然是理想化的，但却是明确的，并允许有唯一解。因此，该问题被认为是有效的。\n\n**步骤 3：求解推导**\n推导过程从波动方程显式时间积分的数值稳定性基本原理出发。\n\n一维弹性杆中纵向波传播的控制偏微分方程是波动方程：\n$$ \\frac{\\partial^2 u}{\\partial t^2} = c(x)^2 \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $u(x, t)$ 是位置 $x$ 和时间 $t$ 处的轴向位移，而 $c(x)$ 是局部波速。\n\n经过空间离散化（例如，使用带有线性单元和集中质量矩阵的有限元法），该偏微分方程被转化为一个二阶常微分方程（ODE）组：\n$$ \\mathbf{M} \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\mathbf{d}(t) = \\mathbf{0} $$\n其中 $\\mathbf{M}$ 是对角质量矩阵，$\\mathbf{K}$ 是刚度矩阵，$\\mathbf{d}(t)$ 是节点位移向量。\n\n问题指定使用二阶中心差分法进行时间积分。这种显式格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定。该条件源于这样一个原理：对于一个收敛的数值解，偏微分方程的物理依赖域必须包含在离散格式的数值依赖域之内。\n\n对于一维问题，这意味着波在一个时间步长内传播的距离 $c \\Delta t$ 不得超过空间单元的特征长度 $h$。这确保了信息在数值上的传播速度不会快于其物理传播速度，否则会导致不稳定性。因此，稳定性条件为：\n$$ c \\Delta t \\le h $$\n这可以用无量纲的 Courant 数（或 CFL 数）来表示，为每个单元定义为：\n$$ \\text{CFL} = \\frac{c \\Delta t}{h} $$\n中心差分格式的稳定性要求是 $\\text{CFL} \\le 1$。\n\n问题指出，采用一种自适应策略来为承载波前的单元维持一个恒定的目标 CFL 数 $\\alpha$，其中 $0  \\alpha  1$。因此，时间步长 $\\Delta t$ 根据该特定单元的属性来设置：\n$$ \\alpha = \\frac{c_{wavefront} \\Delta t}{h_{wavefront}} \\implies \\Delta t = \\alpha \\frac{h_{wavefront}}{c_{wavefront}} $$\n\n我们现在将此自适应规则应用于传播的脉冲。脉冲在 $t=0$ 时从 $x=0$ 开始。杆由两个具有不同属性的区域组成。\n\n**区域 1 ($0 \\le x  L_1$):**\n- 单元尺寸：$h = h_1$\n- 波速：$c = c_1$\n只要波前位于该区域，时间步长 $\\Delta t(t)$ 就根据这些属性设置。我们将此时间步长称为 $\\Delta t_1$。\n$$ \\Delta t_1 = \\alpha \\frac{h_1}{c_1} $$\n波前以速度 $c_1$ 传播，因此其位置为 $x(t) = c_1 t$。波前在时间间隔 $0 \\le t  t^{\\ast}$ 内保持在区域 1 中，其中 $t^{\\ast}$ 是它到达界面 $x=L_1$ 的时间。该时间由 $L_1 = c_1 t^{\\ast}$ 给出，因此 $t^{\\ast} = L_1/c_1$。\n\n**区域 2 ($L_1 \\le x \\le L$):**\n- 单元尺寸：$h = h_2$\n- 波速：$c = c_2$\n一旦波前在 $t=t^{\\ast}$ 时穿过界面，它就进入区域 2 并以速度 $c_2$ 传播。对于所有 $t \\ge t^{\\ast}$，时间步长 $\\Delta t(t)$ 根据区域 2 的属性设置。我们将此时间步长称为 $\\Delta t_2$。\n$$ \\Delta t_2 = \\alpha \\frac{h_2}{c_2} $$\n\n综合这些发现，自适应时间步长 $\\Delta t(t)$ 是一个关于时间的分段常数函数：\n$$\n\\Delta t(t) =\n\\begin{cases}\n\\Delta t_1 = \\alpha \\frac{h_1}{c_1}  \\text{若 } 0 \\le t  t^{\\ast} \\\\\n\\Delta t_2 = \\alpha \\frac{h_2}{c_2}  \\text{若 } t \\ge t^{\\ast}\n\\end{cases}\n$$\n其中 $t^{\\ast} = L_1/c_1$。\n\n最后一步是使用 Heaviside 阶跃函数 $H(\\tau)$ 将此分段函数表示为单个闭式表达式，其定义为：\n$$\nH(\\tau) =\n\\begin{cases}\n0  \\text{若 } \\tau  0 \\\\\n1  \\text{若 } \\tau \\ge 0\n\\end{cases}\n$$\n一个通用的分段函数 $f(t) = A$ 对于 $t  t^{\\ast}$ 和 $f(t) = B$ 对于 $t \\ge t^{\\ast}$ 可以写为 $f(t) = A + (B - A) H(t - t^{\\ast})$。\n将此应用于我们的函数 $\\Delta t(t)$，我们有：\n- $A = \\Delta t_1 = \\alpha \\frac{h_1}{c_1}$\n- $B = \\Delta t_2 = \\alpha \\frac{h_2}{c_2}$\n- 转换发生在 $t^{\\ast} = L_1/c_1$。\n\n因此，自适应时间步长 $\\Delta t(t)$ 为：\n$$ \\Delta t(t) = \\alpha \\frac{h_1}{c_1} + \\left( \\alpha \\frac{h_2}{c_2} - \\alpha \\frac{h_1}{c_1} \\right) H(t - t^{\\ast}) $$\n代入 $t^{\\ast} = L_1/c_1$ 并提出公因子 $\\alpha$，我们得到最终的解析表达式：\n$$ \\Delta t(t) = \\alpha \\left( \\frac{h_1}{c_1} + \\left( \\frac{h_2}{c_2} - \\frac{h_1}{c_1} \\right) H\\left(t - \\frac{L_1}{c_1}\\right) \\right) $$\n该表达式给出了全局时间步长（以秒为单位）作为时间 $t$ 和系统给定参数的函数值。", "answer": "$$\n\\boxed{\\alpha \\left( \\frac{h_1}{c_1} + \\left( \\frac{h_2}{c_2} - \\frac{h_1}{c_1} \\right) H\\left(t - \\frac{L_1}{c_1}\\right) \\right)}\n$$", "id": "3598266"}, {"introduction": "探索了显式方法的局限性之后，我们现在转向隐式格式的强大功能与灵活性。本练习聚焦于广泛应用的广义$\\alpha$方法，演示如何智能地选择其参数，以在保证无条件稳定性的同时，精确控制数值耗散。对于那些主要关注结构稳定性而非精细波传播过程的问题，这项练习是理解为何隐式方法通常是首选的关键。", "problem": "一个具有质量矩阵 $\\mathbf{M}$、阻尼矩阵 $\\mathbf{C}$ 和刚度矩阵 $\\mathbf{K}$ 的线性弹性结构需要进行时间积分。对于半离散的运动方程 $\\mathbf{M}\\,\\mathbf{a}(t)+\\mathbf{C}\\,\\mathbf{v}(t)+\\mathbf{K}\\,\\mathbf{d}(t)=\\mathbf{f}(t)$（其中 $\\mathbf{d}$、$\\mathbf{v}$ 和 $\\mathbf{a}$ 分别是位移、速度和加速度），您必须在显式中心差分更新和隐式广义-$\\alpha$ 更新之间进行选择。由于该系统是刚度主导的，并且您希望避免显式中心差分法所带来的受稳定性限制的苛刻时间步长，因此您选择了一种带有算法耗散的隐式广义-$\\alpha$ 方法，该方法能选择性地阻尼虚假的高频响应。\n\n从牛顿第二定律和 Newmark 族运动学更新关系出发，考虑在中间阶段施加广义-$\\alpha$ 平衡，\n$$\n\\mathbf{M}\\,\\mathbf{a}_{n+\\alpha_m}+\\mathbf{C}\\,\\mathbf{v}_{n+\\alpha_f}+\\mathbf{K}\\,\\mathbf{d}_{n+\\alpha_f}=\\mathbf{f}_{n+\\alpha_f},\n$$\n其中，对于任意量 $\\mathbf{x}\\in\\{\\mathbf{a},\\mathbf{v},\\mathbf{d},\\mathbf{f}\\}$，插值形式为 $\\mathbf{x}_{n+\\alpha}=(1-\\alpha)\\,\\mathbf{x}_n+\\alpha\\,\\mathbf{x}_{n+1}$。运动学更新为 Newmark 类型，\n$$\n\\mathbf{d}_{n+1}=\\mathbf{d}_n+\\Delta t\\,\\mathbf{v}_n+\\Delta t^2\\left[\\left(\\tfrac{1}{2}-\\beta\\right)\\mathbf{a}_n+\\beta\\,\\mathbf{a}_{n+1}\\right],\\qquad\n\\mathbf{v}_{n+1}=\\mathbf{v}_n+\\Delta t\\left[(1-\\gamma)\\mathbf{a}_n+\\gamma\\,\\mathbf{a}_{n+1}\\right].\n$$\n施加以下设计要求：\n- 对于光滑解，要求二阶精度。\n- 对于线性系统，要求无条件稳定。\n- 在无穷大归一化频率下，指定谱半径等于 $\\rho_{\\infty}=0.3$，以控制高频算法耗散。\n\n使用单自由度（single-degree-of-freedom, SDOF）线性振子作为稳定性和一致性分析的工具，确定一组满足所有三个要求的参数 $(\\alpha_m,\\alpha_f,\\gamma,\\beta)$，并通过明确检验您的参数所满足的稳定性和一致性条件来证明该选择的合理性。将您的最终参数按 $(\\alpha_m,\\alpha_f,\\gamma,\\beta)$ 的顺序表示为精确的有理数。以单个行向量的形式提供您的最终答案。不需要单位。如果您选择在中间步骤中使用小数值，最终答案仍必须是精确的（无舍入）。", "solution": "该问题要求确定广义-$\\alpha$ 时间积分方法的参数 $(\\alpha_m, \\alpha_f, \\gamma, \\beta)$，这些参数需满足三个设计要求：二阶精度、线性系统无条件稳定以及在无穷大频率下指定的谱半径 $\\rho_{\\infty}=0.3$。\n\n广义-$\\alpha$ 方法的控制方程如下：\n在中间阶段施加平衡：\n$$ \\mathbf{M}\\,\\mathbf{a}_{n+\\alpha_m}+\\mathbf{C}\\,\\mathbf{v}_{n+\\alpha_f}+\\mathbf{K}\\,\\mathbf{d}_{n+\\alpha_f}=\\mathbf{f}_{n+\\alpha_f} $$\n中间时刻 $t_{n+\\alpha}$ 的状态插值如下：\n$$ \\mathbf{x}_{n+\\alpha}=(1-\\alpha)\\,\\mathbf{x}_n+\\alpha\\,\\mathbf{x}_{n+1} $$\n运动学更新遵循 Newmark 族：\n$$ \\mathbf{d}_{n+1}=\\mathbf{d}_n+\\Delta t\\,\\mathbf{v}_n+\\Delta t^2\\left[\\left(\\tfrac{1}{2}-\\beta\\right)\\mathbf{a}_n+\\beta\\,\\mathbf{a}_{n+1}\\right] $$\n$$ \\mathbf{v}_{n+1}=\\mathbf{v}_n+\\Delta t\\left[(1-\\gamma)\\mathbf{a}_n+\\gamma\\,\\mathbf{a}_{n+1}\\right] $$\n\n这种特定的表述是广义-$\\alpha$ 方法的常见实现形式之一。满足设计要求的参数 $(\\alpha_m, \\alpha_f, \\gamma, \\beta)$ 之间的关系是已经确立的。为了避免文献中不同记法约定引起的歧义，我们将首先推导 Chung  Hulbert (1993) 原始公式的参数，然后将其转换为问题陈述中提供的公式。\n\n设 $(\\hat{\\alpha}_m, \\hat{\\alpha}_f, \\hat{\\gamma}, \\hat{\\beta})$ 为 Chung  Hulbert (C-H) 公式中的参数，该公式使用插值 $\\mathbf{x}_{n+1-\\alpha} = (1-\\alpha)\\mathbf{x}_{n+1} + \\alpha\\mathbf{x}_n$。问题公式的参数 $(\\alpha_m, \\alpha_f, \\gamma, \\beta)$ 与 C-H 参数的关系如下：\n$\\alpha_m = 1 - \\hat{\\alpha}_m$\n$\\alpha_f = 1 - \\hat{\\alpha}_f$\n$\\gamma = \\hat{\\gamma}$\n$\\beta = \\hat{\\beta}$\n\nC-H 参数是根据期望的无穷大频率谱半径 $\\rho_{\\infty}$ 定义的，以满足二阶精度、无条件稳定性和最优高频耗散。标准关系式为：\n1. $\\hat{\\alpha}_m = \\frac{2\\rho_{\\infty}-1}{\\rho_{\\infty}+1}$\n2. $\\hat{\\alpha}_f = \\frac{\\rho_{\\infty}}{\\rho_{\\infty}+1}$\n3. $\\hat{\\gamma} = \\frac{1}{2} - \\hat{\\alpha}_m + \\hat{\\alpha}_f$\n4. $\\hat{\\beta} = \\frac{1}{4}(1 - \\hat{\\alpha}_m + \\hat{\\alpha}_f)^2$\n\n给定 $\\rho_{\\infty} = 0.3$，即 $\\frac{3}{10}$。\n\n首先，我们计算 C-H 参数 $(\\hat{\\alpha}_m, \\hat{\\alpha}_f)$：\n$$ \\hat{\\alpha}_m = \\frac{2(\\frac{3}{10})-1}{\\frac{3}{10}+1} = \\frac{\\frac{6}{10}-\\frac{10}{10}}{\\frac{3}{10}+\\frac{10}{10}} = \\frac{-\\frac{4}{10}}{\\frac{13}{10}} = -\\frac{4}{13} $$\n$$ \\hat{\\alpha}_f = \\frac{\\frac{3}{10}}{\\frac{3}{10}+1} = \\frac{\\frac{3}{10}}{\\frac{13}{10}} = \\frac{3}{13} $$\n\n接下来，我们计算 Newmark 参数 $(\\hat{\\gamma}, \\hat{\\beta})$：\n$$ \\hat{\\gamma} = \\frac{1}{2} - \\left(-\\frac{4}{13}\\right) + \\frac{3}{13} = \\frac{1}{2} + \\frac{7}{13} = \\frac{13}{26} + \\frac{14}{26} = \\frac{27}{26} $$\n$$ \\hat{\\beta} = \\frac{1}{4}\\left(1 - \\left(-\\frac{4}{13}\\right) + \\frac{3}{13}\\right)^2 = \\frac{1}{4}\\left(1 + \\frac{7}{13}\\right)^2 = \\frac{1}{4}\\left(\\frac{20}{13}\\right)^2 = \\frac{1}{4} \\frac{400}{169} = \\frac{100}{169} $$\n\n最后，我们将这些参数转换为问题陈述中给出的公式：\n$$ \\alpha_m = 1 - \\hat{\\alpha}_m = 1 - \\left(-\\frac{4}{13}\\right) = 1 + \\frac{4}{13} = \\frac{17}{13} $$\n$$ \\alpha_f = 1 - \\hat{\\alpha}_f = 1 - \\frac{3}{13} = \\frac{10}{13} $$\n$$ \\gamma = \\hat{\\gamma} = \\frac{27}{26} $$\n$$ \\beta = \\hat{\\beta} = \\frac{100}{169} $$\n因此，指定方法的完整参数集为 $(\\alpha_m, \\alpha_f, \\gamma, \\beta) = (\\frac{17}{13}, \\frac{10}{13}, \\frac{27}{26}, \\frac{100}{169})$。\n\n现在，我们必须通过明确检查其是否满足设计要求来证明此选择的合理性。\n\n**1. 二阶精度：**\n对于问题中给出的公式，如果参数满足一致性条件，则可达到二阶精度：\n$$ \\gamma = \\frac{1}{2} + \\alpha_m - \\alpha_f $$\n让我们用我们计算出的参数来检查这个条件：\n$$ \\frac{1}{2} + \\alpha_m - \\alpha_f = \\frac{1}{2} + \\frac{17}{13} - \\frac{10}{13} = \\frac{1}{2} + \\frac{7}{13} = \\frac{13}{26} + \\frac{14}{26} = \\frac{27}{26} $$\n我们计算出的 $\\gamma$ 值为 $\\frac{27}{26}$。该条件得到满足，证实了该方法是二阶精度的。\n\n**2. 无条件稳定性：**\n对于广义-$\\alpha$ 方法，如果 Newmark 参数满足 $\\gamma \\ge \\frac{1}{2}$ 和 $\\beta \\ge \\frac{\\gamma}{2}$，则通常可以保证线性系统的无条件稳定性。\n让我们检查这些条件：\n- 第一个条件：$\\gamma \\ge \\frac{1}{2}$。\n  我们的 $\\gamma = \\frac{27}{26} \\approx 1.038$。由于 $\\frac{27}{26} > 1$，它当然大于 $\\frac{1}{2}$。此条件满足。\n- 第二个条件：$\\beta \\ge \\frac{\\gamma}{2}$。\n  我们的 $\\beta = \\frac{100}{169}$。我们检查是否 $\\frac{100}{169} \\ge \\frac{1}{2} \\cdot \\frac{27}{26} = \\frac{27}{52}$。\n  为了比较这两个分数，我们进行交叉相乘：\n  $100 \\times 52 = 5200$。\n  $169 \\times 27 = 4563$。\n  由于 $5200 > 4563$，不等式 $\\frac{100}{169} \\ge \\frac{27}{52}$ 成立。此条件也满足。\nNewmark 参数的两个稳定性条件都得到满足，从而确保了无条件稳定性。\n\n**3. 指定的谱半径：**\n用于 $\\hat{\\alpha}_m$ 和 $\\hat{\\alpha}_f$ 的参数关系式正是从该方法的放大矩阵在无穷大频率极限下的分析中推导出来的。通过使用这些公式并代入 $\\rho_{\\infty}=0.3$ 来构建参数，根据定义，所得算法保证具有此谱半径。这控制了施加于虚假高频模式的数值阻尼量。\n\n所选参数 $(\\frac{17}{13}, \\frac{10}{13}, \\frac{27}{26}, \\frac{100}{169})$ 满足所有三项设计要求。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{17}{13}  \\frac{10}{13}  \\frac{27}{26}  \\frac{100}{169} \\end{pmatrix} } $$", "id": "3598277"}, {"introduction": "最后的这项练习将我们从一般性原理带入一个具体而富有挑战性的应用：内聚断裂。在此类问题中，材料软化可能导致“突弹”(snap-back)等结构失稳现象，此时标准的隐式方法会因刚度矩阵失去正定性而失效。通过推导突弹的判据，你将明白为何显式方法，尽管其时间步长很小，却成为追踪完整但不稳定响应路径的必要选择。", "problem": "考虑一个一维杆，其体刚度与一个遵循双线性牵引力-分离律的内聚界面串联。杆端位移被指定为时间的函数，惯性虽小但非零，因此分析师可以选择准静态隐式更新（例如，对平衡方程使用牛顿法）或显式中心差分更新。目标是从第一性原理出发，推导出一个数学上合理的准则，用于在内聚软化开始并可能引发回弹（snap-back）时，在裂纹萌生附近从隐式时间积分切换到显式时间积分。\n\n假设使用以下模型和定义。\n\n- 体材料是线性弹性的，其杨氏模量为 $E$（单位 $\\mathrm{Pa}$），横截面积为 $A$（单位 $\\mathrm{m}^2$），长度为 $L$（单位 $\\mathrm{m}$）。其力-位移关系为 $F_{\\mathrm{bulk}} = K_b \\,\\Delta_b$，其中 $K_b = \\dfrac{E A}{L}$（单位 $\\mathrm{N/m}$），$\\Delta_b$ 是体材料伸长量（单位 $\\mathrm{m}$），$F_{\\mathrm{bulk}}$ 是内轴向力（单位 $\\mathrm{N}$）。\n\n- 内聚界面的特征是双线性牵引力-分离律，其最大牵引力为 $\\sigma_{\\max}$（单位 $\\mathrm{Pa}$），峰值分离量为 $\\delta_0$（单位 $\\mathrm{m}$），最终分离量为 $\\delta_f$（单位 $\\mathrm{m}$），且 $0  \\delta_0  \\delta_f$。令 $\\delta$ 为当前分离量（单位 $\\mathrm{m}$）。内聚牵引力 $t(\\delta)$（单位 $\\mathrm{Pa}$）及其切线 $K_t^{\\mathrm{(trac)}}(\\delta) = \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$（单位 $\\mathrm{Pa/m}$）为\n  - 对于 $0 \\le \\delta \\le \\delta_0$：$t(\\delta) = \\left(\\dfrac{\\sigma_{\\max}}{\\delta_0}\\right) \\delta$，其 $K_t^{\\mathrm{(trac)}}(\\delta) = \\dfrac{\\sigma_{\\max}}{\\delta_0}$。\n  - 对于 $\\delta_0  \\delta \\le \\delta_f$：$t(\\delta) = \\sigma_{\\max} \\left( 1 - \\dfrac{\\delta - \\delta_0}{\\delta_f - \\delta_0} \\right)$，其 $K_t^{\\mathrm{(trac)}}(\\delta) = - \\dfrac{\\sigma_{\\max}}{\\delta_f - \\delta_0}$。\n  界面对应的力级别的割线刚度和切线刚度（单位 $\\mathrm{N/m}$）为\n  $\n  K_s = A \\dfrac{t(\\delta)}{\\delta}, \\quad K_t = A K_t^{\\mathrm{(trac)}}(\\delta).\n  $\n\n- 串联耦合强制要求一个共同的内力 $F$（单位 $\\mathrm{N}$）和总端部位移 $\\Delta$（单位 $\\mathrm{m}$），满足 $F = F_{\\mathrm{bulk}} = A\\, t(\\delta)$ 和 $\\Delta = \\Delta_b + \\delta$。\n\n从平衡和线性化的基本原理出发，推导出一个标量切换准则。该准则使用体刚度 $K_b$、内聚切线刚度 $K_t$ 和内聚割线刚度 $K_s$ 表示，用于标记在软化开始附近准静态隐式更新的算法困难的起点。该准则必须通过分析位移控制的平衡方程在增量加载下的局部可解性来证明，并且必须简化为一个由 $K_b$、$K_t$ 和 $K_s$ 构成的无量纲指数，其符号变化表示结构响应中的一个转折点（回弹）。\n\n然后，将此准则实现为一个程序，对每个提供的测试用例进行评估，判断是选择显式更新（$1$）还是保持隐式更新（$0$）。使用以下参数元组的测试套件 $(E, A, L, \\sigma_{\\max}, \\delta_0, \\delta_f, \\delta)$，所有量均采用上述指定的单位：\n\n- 案例 1（典型的萌生附近软化，强体材料）：($210\\times 10^9$, $1.0\\times 10^{-4}$, $2.0\\times 10^{-1}$, $5.0\\times 10^{6}$, $1.0\\times 10^{-5}$, $5.0\\times 10^{-5}$, $1.2\\times 10^{-5}$)。\n\n- 案例 2（软化，弱体材料）：($210\\times 10^9$, $1.0\\times 10^{-4}$, $2.0$, $5.0\\times 10^{6}$, $1.0\\times 10^{-5}$, $5.0\\times 10^{-5}$, $1.2\\times 10^{-5}$)。\n\n- 案例 3（转折点处的边界情况）：($210\\times 10^9$, $1.0\\times 10^{-4}$, $2.1\\times 10^{-1}$, $5.0\\times 10^{6}$, $1.0\\times 10^{-5}$, $1.5\\times 10^{-5}$, $1.2\\times 10^{-5}$)。\n\n- 案例 4（峰前，弹性内聚响应）：($210\\times 10^9$, $1.0\\times 10^{-4}$, $2.0\\times 10^{-1}$, $5.0\\times 10^{6}$, $1.0\\times 10^{-5}$, $5.0\\times 10^{-5}$, $8.0\\times 10^{-6}$)。\n\n- 案例 5（深度软化，大界面面积）：($210\\times 10^9$, $5.0\\times 10^{-4}$, $5.0\\times 10^{-1}$, $6.0\\times 10^{6}$, $8.0\\times 10^{-6}$, $1.6\\times 10^{-5}$, $1.2\\times 10^{-5}$)。\n\n您的程序必须为每个案例计算 $K_b$、$K_s$ 和 $K_t$，评估推导出的无量纲指数，并输出一行包含5个整数的列表，按案例1到5的顺序排列：打印值为$\\left[0,1\\right]$的决策，其中 $1$ 表示“切换到显式”，$0$ 表示“保持隐式”。\n\n最终输出格式要求：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5\\right]$），其中每个 $\\mathrm{result}_i$ 是如上定义的整数 $0$ 或 $1$。", "solution": "该问题要求推导一个准则，用于在分析带内聚界面的一维杆时，从准静态隐式求解策略切换到显式动态求解策略。当内聚软化过程中出现结构失稳，特别是回弹（snap-back）时，隐式方法可能出现算法失效，这是进行切换的动因。推导过程遵循平衡和运动协调的基本原理。\n\n系统由一个线性弹性体单元和一个非线性内聚界面串联而成。串联连接意味着两个条件：\n$1$. 力 $F$ 在整个系统中是均匀的：$F = F_{\\mathrm{bulk}} = F_{\\mathrm{cohesive}}$。\n$2$. 总位移 $\\Delta$ 是各部件位移之和：$\\Delta = \\Delta_b + \\delta$，其中 $\\Delta_b$ 是体材料的伸长量，$\\delta$ 是内聚界面的分离量。\n\n各部件的本构关系已给出。\n对于体单元，力-位移关系是线性的：\n$$F = K_b \\Delta_b$$\n其中 $K_b = \\dfrac{E A}{L}$ 是体刚度。\n\n对于内聚界面，力 $F$ 与内聚牵引力 $t(\\delta)$ 和横截面积 $A$ 相关：\n$$F = A \\, t(\\delta)$$\n牵引力 $t(\\delta)$ 遵循一个取决于分离量 $\\delta$ 的双线性定律。\n\n我们的目标是在给定的总位移 $\\Delta$ 下分析结构响应。选择一个描述系统状态的单一自变量是有利的。内聚分离量 $\\delta$ 是自然的选择，因为它主导了非线性行为。我们可以将总位移 $\\Delta$ 表示为 $\\delta$ 的函数。\n\n从体本构关系可知，体伸长量为 $\\Delta_b = \\dfrac{F}{K_b}$。代入内聚力关系，我们得到：\n$$\\Delta_b(\\delta) = \\dfrac{A \\, t(\\delta)}{K_b}$$\n总位移 $\\Delta$ 于是由下式给出：\n$$\\Delta(\\delta) = \\Delta_b(\\delta) + \\delta = \\dfrac{A \\, t(\\delta)}{K_b} + \\delta$$\n该方程表示系统的平衡路径，将控制参数 $\\Delta$ 与内部状态变量 $\\delta$ 联系起来。\n\n在准静态、位移控制的分析中，我们增量地增加总位移 $\\Delta$ 并求解相应的平衡状态 $\\delta$。此过程的局部可解性和稳定性取决于无穷小增量 $\\mathrm{d}\\Delta$ 与相应增量 $\\mathrm{d}\\delta$ 之间的关系。这个关系可以通过对 $\\Delta(\\delta)$ 关于 $\\delta$ 求导得到：\n$$\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = \\dfrac{\\mathrm{d}}{\\mathrm{d}\\delta} \\left[ \\dfrac{A \\, t(\\delta)}{K_b} + \\delta \\right] = \\dfrac{A}{K_b} \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta} + 1$$\n我们识别出 $A \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$ 项是内聚界面的切线刚度，题目已给出为 $K_t = A K_t^{\\mathrm{(trac)}}(\\delta) = A \\dfrac{\\mathrm{d}t}{\\mathrm{d}\\delta}$。代入此定义，我们得到：\n$$\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = \\dfrac{K_t}{K_b} + 1 = \\dfrac{K_b + K_t}{K_b}$$\n在位移控制下，稳定的平衡路径是指总位移 $\\Delta$ 的增加对应于内部分离量 $\\delta$ 的增加。这要求 $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} > 0$。由于对于物理材料，$K_b = \\dfrac{EA}{L}$ 总是正的，这个条件等价于：\n$$K_b + K_t > 0$$\n当 $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta} = 0$ 时，达到一个临界点或极限点。这对应于 $\\delta$ vs. $\\Delta$ 曲线上的垂直切线，或 $\\Delta$ vs. $\\delta$ 曲线上的水平切线。该极限点由下式定义：\n$$K_b + K_t = 0$$\n如果路径继续越过此点，我们有 $\\dfrac{\\mathrm{d}\\Delta}{\\mathrm{d}\\delta}  0$。这表示发生了回弹失稳：为了沿平衡路径前进，当内部分离量 $\\delta$ 继续增加时，总位移 $\\Delta$ 必须减小。一个标准的位移控制牛顿-拉夫逊求解器，其假设控制参数和状态变量之间存在单调关系，在跨越这样一个极限点时将无法收敛。显式动态求解器通过随时间步进积分运动方程，不依赖于切线刚度矩阵的求逆，因此可以追踪不稳定的峰后路径，只要时间步长足够小。\n\n因此，从准静态隐式切换到显式动态方案的条件是这种回弹失稳的开始。该准则是：\n$$\\text{当 } K_b + K_t  0 \\text{ 时切换到显式}$$\n这只在内聚界面处于软化区域时才会发生，此时其切线刚度 $K_t$ 为负。该不等式可以重写为 $K_b  -K_t$ 或 $K_b  |K_t|$。这是一个物理上直观的结果：如果体材料相对于内聚软化速率（大的负 $K_t$）足够柔顺（小的 $K_b$），就会发生回弹。如果体材料非常刚硬，它可以控制变形并防止驱动动态回弹的储存弹性能的突然释放。\n\n问题要求一个涉及 $K_b$、$K_t$ 和内聚割线刚度 $K_s$ 的无量纲指数。推导出的条件 $K_b + K_t = 0$ 定义了转折点。我们可以构建一个指数，其符号变化对应于此条件。让我们定义指数 $\\eta$ 为：\n$$\\eta = \\dfrac{K_b + K_t}{K_s}$$\n其中 $K_s = A \\dfrac{t(\\delta)}{\\delta}$。由于我们关心的是断裂的萌生和扩展，我们考虑 $\\delta > 0$ 和 $t(\\delta) > 0$ 的状态，这确保了 $K_s > 0$。因此，指数 $\\eta$ 的符号与其分子 $K_b + K_t$ 的符号相同。切换准则可以重述为：\n$$\\text{当 } \\eta  0 \\text{ 时切换到显式}$$\n此公式满足问题描述中的所有约束。\n\n程序的决策规则如下：对于给定的一组参数 $(E, A, L, \\sigma_{\\max}, \\delta_0, \\delta_f, \\delta)$:\n$1$. 计算体刚度 $K_b = \\dfrac{E A}{L}$。\n$2$. 根据 $\\delta$ 的值确定内聚切线刚度 $K_t$：\n   - 如果 $0 \\le \\delta \\le \\delta_0$：$K_t = A \\left( \\dfrac{\\sigma_{\\max}}{\\delta_0} \\right)$。\n   - 如果 $\\delta_0  \\delta \\le \\delta_f$：$K_t = -A \\left( \\dfrac{\\sigma_{\\max}}{\\delta_f - \\delta_0} \\right)$。\n$3$. 计算和 $K_b + K_t$。\n$4$. 如果 $K_b + K_t  0$，决策是切换到显式方案（输出 $1$）。否则，保持隐式方案是安全的（输出 $0$）。边界情况 $K_b + K_t = 0$ 属于“保持隐式”类别，因为失稳尚未显现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of deciding whether to switch from an implicit to an explicit\n    time integration scheme for a 1D bar with a cohesive interface.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (typical near-initiation softening, strong bulk)\n        (210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5),\n        # Case 2 (softening with weak bulk)\n        (210e9, 1.0e-4, 2.0, 5.0e6, 1.0e-5, 5.0e-5, 1.2e-5),\n        # Case 3 (boundary case at the turning point)\n        (210e9, 1.0e-4, 2.1e-1, 5.0e6, 1.0e-5, 1.5e-5, 1.2e-5),\n        # Case 4 (pre-peak, elastic cohesive response)\n        (210e9, 1.0e-4, 2.0e-1, 5.0e6, 1.0e-5, 5.0e-5, 8.0e-6),\n        # Case 5 (deep softening, large interface area)\n        (210e9, 5.0e-4, 5.0e-1, 6.0e6, 8.0e-6, 1.6e-5, 1.2e-5),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, A, L, sigma_max, delta_0, delta_f, delta = case\n        \n        # Calculate bulk stiffness Kb\n        # Kb = (E * A) / L\n        K_b = (E * A) / L\n        \n        # Calculate cohesive tangent stiffness Kt\n        # Kt depends on the current separation delta\n        if delta  0 or delta > delta_f:\n            # This case is outside the defined model, but for completeness,\n            # we can assume no stiffness or handle as an error.\n            # Here, we'll assume it doesn't happen based on problem constraints.\n            # For this problem let's assume Kt=0 for delta > delta_f\n            K_t = 0.0\n        elif delta = delta_0:\n            # Loading/elastic regime (positive tangent stiffness)\n            # K_t = A * (sigma_max / delta_0)\n            K_t = A * (sigma_max / delta_0)\n        else: # delta_0  delta = delta_f\n            # Softening regime (negative tangent stiffness)\n            # K_t = - A * (sigma_max / (delta_f - delta_0))\n            K_t = -A * (sigma_max / (delta_f - delta_0))\n            \n        # The stability criterion for a displacement-controlled system is K_b + K_t.\n        # Snap-back instability occurs if K_b + K_t  0.\n        # At this point, an implicit quasi-static solver will face convergence issues.\n        # It is advisable to switch to an explicit dynamic solver to trace the unstable path.\n        \n        # Decision: 1 for \"switch to explicit\", 0 for \"remain implicit\"\n        if K_b + K_t  0:\n            decision = 1\n        else:\n            decision = 0\n            \n        results.append(decision)\n\n    # Print results in the specified format: [result1,result2,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598283"}]}