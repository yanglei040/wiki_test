{"hands_on_practices": [{"introduction": "本练习旨在巩固从基本原理推导应变-位移关系的核心技能。我们将从连续介质力学中应变的对称梯度定义出发，结合有限元中的位移插值，推导出与单个节点相关的应变-位移矩阵（$B$ 矩阵）的分块形式。掌握这一推导过程是理解并为任何类型的单元构建 $B$ 矩阵的基础。", "problem": "在计算固体力学中，考虑平面应变假设下的二维（$2$D）小应变运动学设定。设位移场为 $\\mathbf{u}(x,y) = (u(x,y), v(x,y))^{\\mathsf T}$，并根据基本原理，将小应变张量定义为位移的对称梯度，即 $\\boldsymbol{\\varepsilon} = \\mathrm{sym}\\,\\nabla \\mathbf{u} = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}})$。在平面应变的 Voigt 映射中，将应变向量定义为 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$，其中 $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$。假设使用标量形函数 $N_i(x,y)$ 和节点自由度 $\\mathbf{d}_i = [u_i, v_i]^{\\mathsf T}$ 对位移场进行标准的有限元插值，使得 $u(x,y) \\approx \\sum_i N_i(x,y)\\,u_i$ 且 $v(x,y) \\approx \\sum_i N_i(x,y)\\,v_i$。\n\n仅从给定的定义 $\\boldsymbol{\\varepsilon} = \\mathrm{sym}\\,\\nabla \\mathbf{u}$ 和平面应变的 Voigt 映射出发，推导 Voigt 形式下的应变-位移关系 $\\boldsymbol{\\varepsilon}_v = \\mathbf{B}\\,\\mathbf{d}$，其中 $\\mathbf{d}$ 集合了所有节点自由度，并显式地求出与单个节点 $i$ 相关联的 $3\\times 2$ 分块矩阵 $\\mathbf{B}_i$。将 $\\mathbf{B}_i$ 完全用形函数 $N_i(x,y)$ 的空间导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 表示。\n\n你的最终答案必须是 $3\\times 2$ 分块矩阵 $\\mathbf{B}_i$ 的一个单一、闭合形式的解析表达式。", "solution": "该问题是成立的。这是计算固体力学领域中一个标准的、良定的推导，其基础是连续介质力学和有限元法的既定原理。所有定义和条件都是自洽、一致且科学合理的。\n\n目标是在平面应变假设下，为一个二维有限元模型中的单个节点 $i$ 推导与其相关的 $3 \\times 2$ 应变-位移分块矩阵（记为 $\\mathbf{B}_i$）的显式形式。该关系由 $\\boldsymbol{\\varepsilon}_v = \\mathbf{B}\\,\\mathbf{d}$ 给出，其中 $\\boldsymbol{\\varepsilon}_v$ 是 Voigt 记法下的应变向量，$\\mathbf{d}$ 是节点自由度的全局向量。\n\n我们从给定的位移场两个分量 $u(x,y)$ 和 $v(x,y)$ 的有限元插值开始，该插值用标量形函数 $N_i(x,y)$ 和节点位移分量 $u_i$ 和 $v_i$ 表示：\n$$\nu(x,y) = \\sum_i N_i(x,y) u_i\n$$\n$$\nv(x,y) = \\sum_i N_i(x,y) v_i\n$$\n求和遍及单元中的所有节点。节点 $i$ 的节点位移向量是 $\\mathbf{d}_i = [u_i, v_i]^{\\mathsf T}$。\n\n小应变张量 $\\boldsymbol{\\varepsilon}$ 的分量由位移梯度的对称部分定义。对于二维问题，相关分量为：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right)\n$$\n问题指定使用平面应变的 Voigt 映射，其中应变向量为 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf T}$。工程剪应变 $\\gamma_{xy}$ 定义为 $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$。代入 $\\varepsilon_{xy}$ 的定义可得：\n$$\n\\gamma_{xy} = 2 \\left[ \\frac{1}{2} \\left( \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\right) \\right] = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\n$$\n接下来，我们计算插值位移场所需的空间导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sum_i N_i(x,y) u_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial y} u_i\n$$\n$$\n\\frac{\\partial v}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sum_i N_i(x,y) v_i \\right) = \\sum_i \\frac{\\partial N_i}{\\partial x} v_i\n$$\n注意，节点位移 $u_i$ 和 $v_i$ 相对于空间坐标 $(x,y)$ 是常数。\n\n现在，我们将这些导数代入 Voigt 应变向量 $\\boldsymbol{\\varepsilon}_v$ 分量的表达式中：\n$$\n\\varepsilon_{xx} = \\sum_i \\frac{\\partial N_i}{\\partial x} u_i\n$$\n$$\n\\varepsilon_{yy} = \\sum_i \\frac{\\partial N_i}{\\partial y} v_i\n$$\n$$\n\\gamma_{xy} = \\left( \\sum_i \\frac{\\partial N_i}{\\partial y} u_i \\right) + \\left( \\sum_i \\frac{\\partial N_i}{\\partial x} v_i \\right) = \\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n$$\n我们可以将这三个方程写成一个关于 $\\boldsymbol{\\varepsilon}_v$ 的单一矩阵-向量方程：\n$$\n\\boldsymbol{\\varepsilon}_v = \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\sum_i \\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\sum_i \\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\sum_i \\left( \\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i \\right)\n\\end{pmatrix}\n$$\n求和的线性性质允许我们将其重写为对每个节点贡献的求和：\n$$\n\\boldsymbol{\\varepsilon}_v = \\sum_i\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\n求和号内的表达式是来自节点 $i$ 自由度对应变的贡献。我们寻求找到矩阵 $\\mathbf{B}_i$，使得这一贡献可以写成 $\\mathbf{B}_i \\mathbf{d}_i$ 的形式，其中 $\\mathbf{d}_i = [u_i, v_i]^{\\mathsf T}$。\n$$\n\\mathbf{B}_i \\mathbf{d}_i =\n\\mathbf{B}_i \\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} u_i \\\\\n\\frac{\\partial N_i}{\\partial y} v_i \\\\\n\\frac{\\partial N_i}{\\partial y} u_i + \\frac{\\partial N_i}{\\partial x} v_i\n\\end{pmatrix}\n$$\n我们可以通过观察将右侧表示为矩阵形式：\n$$\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\frac{\\partial N_i}{\\partial x}) u_i + (0) v_i \\\\\n(0) u_i + (\\frac{\\partial N_i}{\\partial y}) v_i \\\\\n(\\frac{\\partial N_i}{\\partial y}) u_i + (\\frac{\\partial N_i}{\\partial x}) v_i\n\\end{pmatrix}\n$$\n这与所需的形式相匹配。因此，与节点 $i$ 相关联的 $3 \\times 2$ 分块矩阵 $\\mathbf{B}_i$ 为：\n$$\n\\mathbf{B}_i =\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n$$\n正如所要求的那样，该矩阵仅包含形函数 $N_i(x,y)$ 的空间导数。然后通过水平地组装这些分块矩阵来构造完整的应变-位移矩阵 $\\mathbf{B}$：$\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\dots]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x}  & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix}\n}\n$$", "id": "3553225"}, {"introduction": "在掌握了 $B$ 矩阵的一般构造方法 [@problem_id:3553225] 之后，本练习将其应用于一个具体的单元：二维线性三角形单元。你将从零开始为该单元构建完整的 $B$ 矩阵，并基于其线性形函数的特性，从第一性原理分析为何该单元被称为“常应变三角形”(CST)。此练习将揭示低阶单元的一个重要固有局限性，即无法精确模拟弯曲等需要应变梯度才能描述的变形模式。", "problem": "考虑一个用于小应变平面问题的有限元方法（FEM）中的二维线性三角形有限元（通常称为常应变三角形）。设三个节点的笛卡尔坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。该单元具有通常的线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，每个都是关于 $x$ 和 $y$ 的线性多项式，满足克罗内克-德尔塔（Kronecker-delta）节点插值特性 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 和单位分解特性 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。位移场插值为 $u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ 和 $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$，其中 $u_{i}$ 和 $v_{i}$ 分别是节点 $i$ 在 $x$ 和 $y$ 方向上的节点位移分量。小应变向量定义为 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}=\\begin{pmatrix}\\partial u/\\partial x & \\partial v/\\partial y & \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}^{\\mathsf{T}}$。根据单元应变-位移矩阵的定义，$\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$，其中 $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$。\n\n仅从上述形函数的基本性质和小应变的定义出发，完成以下任务：\n\n1) 构建与给定节点坐标一致的线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，并计算它们的常梯度 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$。\n\n2) 组装单元应变-位移矩阵 $\\mathbf{B}$，使得 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$，并以标准顺序 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x} & \\varepsilon_{y} & \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}$ 和 $\\mathbf{d}=\\begin{pmatrix}u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3}\\end{pmatrix}^{\\mathsf{T}}$ 书写。\n\n3) 仅使用第一性原理，解释为什么矩阵 $\\mathbf{B}$ 在单元域上是常数，并推断其后果：即该单元在任何节点位移向量下都产生均匀（恒定）的应变场，因此不能表示需要空间变化的法向应变的纯弯曲状态。通过描述该单元能产生的最一般位移场并对其进行微分来构建你的论证。\n\n提供最终的 $\\mathbf{B}$ 矩阵，其元素为精确有理数。不要四舍五入。你最终的方框答案必须是单个不带单位的矩阵 $\\mathbf{B}$。", "solution": "问题陈述经核实具有科学依据、问题明确且客观。它代表了有限元方法理论中一个标准的、基础的练习。所有提供的数据都是自洽和一致的。我们开始求解。\n\n该问题要求构建线性三角形单元的应变-位移矩阵 $\\mathbf{B}$，并对其性质进行第一性原理解释。将按要求分三部分进行。\n\n**第1部分：形函数及其梯度的构建**\n\n二维单元的线性形函数 $N_{i}(x,y)$ 具有一般形式：\n$$N_{i}(x,y) = \\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$$\n每个形函数的三个系数是通过在三个节点上强制执行克罗内克-德尔塔（Kronecker-delta）特性 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 来确定的。给定的节点坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。\n\n对于形函数 $N_{1}(x,y)$：\n1. $N_{1}(x_{1},y_{1})=N_{1}(0,0) = \\alpha_{10} = 1$\n2. $N_{1}(x_{2},y_{2})=N_{1}(3,0) = \\alpha_{10} + 3\\alpha_{11} = 1 + 3\\alpha_{11} = 0 \\implies \\alpha_{11} = -1/3$\n3. $N_{1}(x_{3},y_{3})=N_{1}(1,2) = \\alpha_{10} + \\alpha_{11} + 2\\alpha_{12} = 1 - 1/3 + 2\\alpha_{12} = 0 \\implies 2/3 + 2\\alpha_{12} = 0 \\implies \\alpha_{12} = -1/3$\n因此，$N_{1}(x,y) = 1 - \\frac{1}{3}x - \\frac{1}{3}y$。\n\n对于形函数 $N_{2}(x,y)$：\n1. $N_{2}(x_{1},y_{1})=N_{2}(0,0) = \\alpha_{20} = 0$\n2. $N_{2}(x_{2},y_{2})=N_{2}(3,0) = \\alpha_{20} + 3\\alpha_{21} = 3\\alpha_{21} = 1 \\implies \\alpha_{21} = 1/3$\n3. $N_{2}(x_{3},y_{3})=N_{2}(1,2) = \\alpha_{20} + \\alpha_{21} + 2\\alpha_{22} = 1/3 + 2\\alpha_{22} = 0 \\implies \\alpha_{22} = -1/6$\n因此，$N_{2}(x,y) = \\frac{1}{3}x - \\frac{1}{6}y$。\n\n对于形函数 $N_{3}(x,y)$：\n1. $N_{3}(x_{1},y_{1})=N_{3}(0,0) = \\alpha_{30} = 0$\n2. $N_{3}(x_{2},y_{2})=N_{3}(3,0) = \\alpha_{30} + 3\\alpha_{31} = 3\\alpha_{31} = 0 \\implies \\alpha_{31} = 0$\n3. $N_{3}(x_{3},y_{3})=N_{3}(1,2) = \\alpha_{30} + \\alpha_{31} + 2\\alpha_{32} = 2\\alpha_{32} = 1 \\implies \\alpha_{32} = 1/2$\n因此，$N_{3}(x,y) = \\frac{1}{2}y$。\n\n单位分解条件 $\\sum_{i=1}^{3}N_{i}=1$ 得到满足：\n$$ \\left(1 - \\frac{1}{3}x - \\frac{1}{3}y\\right) + \\left(\\frac{1}{3}x - \\frac{1}{6}y\\right) + \\left(\\frac{1}{2}y\\right) = 1 + \\left(-\\frac{1}{3}+\\frac{1}{3}\\right)x + \\left(-\\frac{1}{3}-\\frac{1}{6}+\\frac{1}{2}\\right)y = 1 $$\n形函数的梯度通过直接微分计算。由于形函数是关于 $x$ 和 $y$ 的线性多项式，它们的梯度是常数。\n$$ \\frac{\\partial N_{1}}{\\partial x} = -\\frac{1}{3}, \\quad \\frac{\\partial N_{1}}{\\partial y} = -\\frac{1}{3} $$\n$$ \\frac{\\partial N_{2}}{\\partial x} = \\frac{1}{3}, \\quad \\frac{\\partial N_{2}}{\\partial y} = -\\frac{1}{6} $$\n$$ \\frac{\\partial N_{3}}{\\partial x} = 0, \\quad \\frac{\\partial N_{3}}{\\partial y} = \\frac{1}{2} $$\n\n**第2部分：应变-位移矩阵 $\\mathbf{B}$ 的组装**\n\n位移场 $(u, v)$ 使用形函数从节点位移 $(u_i, v_i)$ 插值得到：\n$$ u(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) u_{i} = N_{1}u_{1} + N_{2}u_{2} + N_{3}u_{3} $$\n$$ v(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) v_{i} = N_{1}v_{1} + N_{2}v_{2} + N_{3}v_{3} $$\n小应变分量定义为：\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n通过代入插值的位移场，我们得到应变：\n$$ \\varepsilon_{x} = \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} u_{i} = \\frac{\\partial N_{1}}{\\partial x}u_{1} + \\frac{\\partial N_{2}}{\\partial x}u_{2} + \\frac{\\partial N_{3}}{\\partial x}u_{3} $$\n$$ \\varepsilon_{y} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} v_{i} = \\frac{\\partial N_{1}}{\\partial y}v_{1} + \\frac{\\partial N_{2}}{\\partial y}v_{2} + \\frac{\\partial N_{3}}{\\partial y}v_{3} $$\n$$ \\gamma_{xy} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) + \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_{i}}{\\partial y} u_{i} + \\frac{\\partial N_{i}}{\\partial x} v_{i} \\right) $$\n这些表达式可以写成矩阵形式 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$，其中 $\\mathbf{d} = \\begin{pmatrix} u_{1} & v_{1} & u_{2} & v_{2} & u_{3} & v_{3} \\end{pmatrix}^{\\mathsf{T}}$：\n$$\n\\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_{1}}{\\partial x} & 0 & \\frac{\\partial N_{2}}{\\partial x} & 0 & \\frac{\\partial N_{3}}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_{1}}{\\partial y} & 0 & \\frac{\\partial N_{2}}{\\partial y} & 0 & \\frac{\\partial N_{3}}{\\partial y} \\\\\n\\frac{\\partial N_{1}}{\\partial y} & \\frac{\\partial N_{1}}{\\partial x} & \\frac{\\partial N_{2}}{\\partial y} & \\frac{\\partial N_{2}}{\\partial x} & \\frac{\\partial N_{3}}{\\partial y} & \\frac{\\partial N_{3}}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ v_{1} \\\\ u_{2} \\\\ v_{2} \\\\ u_{3} \\\\ v_{3} \\end{pmatrix}\n$$\n因此，矩阵 $\\mathbf{B}$ 被确定。代入第1部分计算的常梯度，得到该单元的最终结果：\n$$ \\mathbf{B} = \\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix} $$\n\n**第3部分：第一性原理解释**\n\n线性三角形单元的常应变行为是其形函数线性的直接结果。\n\n1.  **为什么 $\\mathbf{B}$ 是常数：** 矩阵 $\\mathbf{B}$ 完全由形函数的一阶偏导数 $\\frac{\\partial N_{i}}{\\partial x}$ 和 $\\frac{\\partial N_{i}}{\\partial y}$ 组成。根据定义，此类单元的形函数 $N_i(x, y)$ 是形如 $\\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$ 的线性多项式。这样一个函数对 $x$ 或 $y$ 的偏导数是一个常数（分别为 $\\alpha_{i1}$ 或 $\\alpha_{i2}$）。由于 $\\mathbf{B}$ 矩阵中的每个元素都是这些常梯度之一（或零），因此整个矩阵 $\\mathbf{B}$ 在单元域上是常数。其值仅取决于定义几何形状的节点坐标，而不取决于单元内的位置 $(x, y)$。\n\n2.  **后果（常应变和无法模拟弯曲）：**\n    位移场 $u(x,y)$ 和 $v(x,y)$ 是线性形函数的线性组合。线性多项式的线性组合结果仍然是线性多项式。因此，该单元能表示的最一般位移场形式为：\n    $$ u(x,y) = c_{1} + c_{2}x + c_{3}y $$\n    $$ v(x,y) = c_{4} + c_{5}x + c_{6}y $$\n    其中系数 $c_{k}$ 是由节点位移决定的常数。\n    通过对该位移场进行微分获得应变：\n    $$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x} = c_{2} $$\n    $$ \\varepsilon_{y} = \\frac{\\partial v}{\\partial y} = c_{6} $$\n    $$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = c_{3} + c_{5} $$\n    应变分量在整个单元内是常数。这就是为什么该单元被称为常应变三角形（CST）。\n\n    然而，纯弯曲的根本特征是线性变化的应变场。例如，在 $x-y$ 平面内弯曲的梁，其法向应变 $\\varepsilon_x$ 是 $y$ 的线性函数，如 $\\varepsilon_{x}(y) = \\kappa y$，其中 $\\kappa$ 是曲率。一个常数应变场要成为一个非常数的线性函数，只有当常数项和斜率都为零时才可能，但这对应的是无变形的平凡情况。CST单元根据其构造，在其域内只能为每个应变分量产生唯一的、恒定的值。因此，它在结构上无法表示纯弯曲状态所必需的应变梯度。由这类单元组成的集合只能通过应力的分段常数“阶梯”来近似弯矩，这是一种很差的表示方法，并会导致剪切闭锁等数值病态问题。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{3} & 0 & \\frac{1}{3} & 0 & 0 & 0 \\\\\n0 & -\\frac{1}{3} & 0 & -\\frac{1}{6} & 0 & \\frac{1}{2} \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & -\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{2} & 0\n\\end{pmatrix}\n}\n$$", "id": "2635801"}, {"introduction": "本练习将探讨一个更高级的议题，它涉及有限元分析中的数值积分及其对单元行为的影响。我们将聚焦于四节点双线性四边形单元 ($Q4$ 单元) 中一个被称为“沙漏模式”的关键数值问题。通过为一个特定的沙漏位移模式计算应变能，你将亲身验证减缩积分方案为何可能导致零能量模式，从而影响计算结果的稳定性和准确性。", "problem": "考虑二维小应变弹性力学中的一个等参双线性四节点四边形 (Q4) 有限元，其在物理坐标系下占据方形域 $\\Omega = \\{(x,y) \\,|\\, -1 \\leq x \\leq 1, -1 \\leq y \\leq 1\\}$。该等参映射为恒等映射，因此自然坐标 $(\\xi,\\eta)$ 与物理坐标 $(x,y)$ 重合，且雅可比矩阵 $\\mathbf{J}$ 等于单位矩阵。该材料在平面应变条件下是各向同性线弹性的，其 Lamé 参数为 $\\lambda > 0$ 和 $\\mu > 0$，因此本构（材料）矩阵为\n$$\n\\mathbf{D} = \\begin{pmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{pmatrix}.\n$$\n设四个节点按 $\\boldsymbol{x}_{1}=(-1,-1)$、$\\boldsymbol{x}_{2}=(1,-1)$、$\\boldsymbol{x}_{3}=(1,1)$、$\\boldsymbol{x}_{4}=(-1,1)$ 的顺序排列，其标准双线性形函数为\n$$\nN_{1}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_{2}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_{3}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_{4}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n位移场通过插值得到 $\\boldsymbol{u}(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,\\boldsymbol{u}_{i}$，其中节点位移向量被选为表示一个典型的沙漏模式：\n$$\n\\boldsymbol{u}_{1} = \\begin{pmatrix} a \\\\ 0 \\end{pmatrix}, \\quad\n\\boldsymbol{u}_{2} = \\begin{pmatrix} -a \\\\ 0 \\end{pmatrix}, \\quad\n\\boldsymbol{u}_{3} = \\begin{pmatrix} a \\\\ 0 \\end{pmatrix}, \\quad\n\\boldsymbol{u}_{4} = \\begin{pmatrix} -a \\\\ 0 \\end{pmatrix},\n$$\n其中 $a \\neq 0$ 是一个给定的幅值。\n\n从上述小应变定义 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}})$ 和插值公式出发，构建 Q4 单元的应变-位移矩阵 $\\boldsymbol{B}(\\xi,\\eta)$。在单点 Gauss 位置 $(\\xi,\\eta)=(0,0)$ 和四个两点 Gauss 位置 $(\\xi,\\eta)=(\\pm c, \\pm c)$（其中 $c = 1/\\sqrt{3}$）处计算 $\\boldsymbol{B}$，并用这些值来计算单元应变能\n$$\nU = \\tfrac{1}{2} \\int_{\\Omega} \\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{D} \\, \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega\n$$\n在两种求积方案下进行：\n- 在 $(0,0)$ 点权重为 $4$ 的减缩单点积分法则，\n- 在 $(\\pm c, \\pm c)$ 各点权重为单位权重的标准每方向两点（即 $2 \\times 2$）积分法则。\n\n确定比值 $U_{1\\times 1} / U_{2\\times 2}$。最终答案以无单位的纯数字表示，无需四舍五入。", "solution": "首先验证问题，以确保其科学基础扎实、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- **单元与域**：一个等参双线性四节点四边形 (Q4) 单元，位于域 $\\Omega = \\{(x,y) \\,|\\, -1 \\leq x \\leq 1, -1 \\leq y \\leq 1\\}$。\n- **坐标**：自然坐标 $(\\xi,\\eta)$ 与物理坐标 $(x,y)$ 重合，因此等参映射为恒等映射，雅可比矩阵 $\\mathbf{J}$ 是单位矩阵，且 $|\\det \\mathbf{J}|=1$。\n- **材料**：各向同性线弹性，平面应变条件，Lamé 参数 $\\lambda > 0$ 和 $\\mu > 0$。\n- **本构矩阵**：$\\mathbf{D} = \\begin{pmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & \\mu \\end{pmatrix}$。\n- **节点坐标**：$\\boldsymbol{x}_{1}=(-1,-1)$, $\\boldsymbol{x}_{2}=(1,-1)$, $\\boldsymbol{x}_{3}=(1,1)$, $\\boldsymbol{x}_{4}=(-1,1)$。\n- **形函数**：$N_{1}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta)$, $N_{4}(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta)$。\n- **位移场**：$\\boldsymbol{u}(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,\\boldsymbol{u}_{i}$。\n- **节点位移**：$\\boldsymbol{u}_{1} = \\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$, $\\boldsymbol{u}_{2} = \\begin{pmatrix} -a \\\\ 0 \\end{pmatrix}$, $\\boldsymbol{u}_{3} = \\begin{pmatrix} a \\\\ 0 \\end{pmatrix}$, $\\boldsymbol{u}_{4} = \\begin{pmatrix} -a \\\\ 0 \\end{pmatrix}$，其中 $a \\neq 0$。\n- **应变定义**：小应变，$\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}})$。\n- **应变能**：$U = \\tfrac{1}{2} \\int_{\\Omega} \\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{D} \\, \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega$。\n- **求积法则**：\n  1. $1 \\times 1$：在 $(\\xi,\\eta)=(0,0)$ 的单点，总权重为 $4$。\n  2. $2 \\times 2$：在 $(\\xi,\\eta)=(\\pm c, \\pm c)$ 的四个点，其中 $c = 1/\\sqrt{3}$，每个点的权重为 $1$。\n- **目标**：确定比值 $U_{1\\times 1} / U_{2\\times 2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是固体有限元分析中的一个标准练习。它描述了一个定义明确的物理系统（线弹性体）和一个标准的数值程序（采用特定求积法则的有限元法）。所提供的数据是完整、一致且科学合理的。规定的沙漏位移模式是研究减缩积分单元行为的经典案例。问题提法恰当、客观，没有歧义或矛盾。\n\n### 步骤 3：结论与行动\n问题有效。详细解答如下。\n\n位移场 $\\boldsymbol{u}(\\xi,\\eta) = (u_x(\\xi,\\eta), u_y(\\xi,\\eta))^{\\mathsf{T}}$ 是通过形函数从节点位移插值得到的。节点位移向量由 $\\boldsymbol{d} = (u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y})^{\\mathsf{T}} = (a, 0, -a, 0, a, 0, -a, 0)^{\\mathsf{T}}$ 给出。\n\n位移场的分量为：\n$$\nu_x(\\xi,\\eta) = \\sum_{i=1}^4 N_i(\\xi,\\eta) u_{ix} = N_1 a + N_2 (-a) + N_3 a + N_4 (-a) = a(N_1 - N_2 + N_3 - N_4)\n$$\n$$\nu_y(\\xi,\\eta) = \\sum_{i=1}^4 N_i(\\xi,\\eta) u_{iy} = 0\n$$\n代入形函数，我们计算 $(N_1 - N_2 + N_3 - N_4)$ 项：\n$$\nN_1 - N_2 = \\tfrac{1}{4}(1-\\eta)(1-\\xi - (1+\\xi)) = -\\tfrac{1}{2}\\xi(1-\\eta)\n$$\n$$\nN_3 - N_4 = \\tfrac{1}{4}(1+\\eta)(1+\\xi - (1-\\xi)) = \\tfrac{1}{2}\\xi(1+\\eta)\n$$\n$$\nN_1 - N_2 + N_3 - N_4 = -\\tfrac{1}{2}\\xi(1-\\eta) + \\tfrac{1}{2}\\xi(1+\\eta) = \\tfrac{1}{2}\\xi(-1+\\eta+1+\\eta) = \\xi\\eta\n$$\n因此，位移场为 $\\boldsymbol{u}(\\xi,\\eta) = (a\\xi\\eta, 0)^{\\mathsf{T}}$。\n\n对于二维平面应变，采用 Voigt 记法的应变向量为 $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$。由于映射是恒等映射，关于 $(x,y)$ 的导数与关于 $(\\xi,\\eta)$ 的导数相同。\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(a\\xi\\eta) = a\\eta\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(0) = 0\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u_x}{\\partial \\eta} + \\frac{\\partial u_y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\eta}(a\\xi\\eta) + \\frac{\\partial}{\\partial \\xi}(0) = a\\xi\n$$\n所以，应变场为 $\\boldsymbol{\\varepsilon}(\\xi, \\eta) = \\begin{pmatrix} a\\eta \\\\ 0 \\\\ a\\xi \\end{pmatrix}$。\n\n另一种方法是，我们构建应变-位移矩阵 $\\boldsymbol{B}$。应变由 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\boldsymbol{d}$ 给出。矩阵 $\\boldsymbol{B}$ 由每个节点 $i$ 的块矩阵 $\\boldsymbol{B}_i$ 组成：$\\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\boldsymbol{B}_3, \\boldsymbol{B}_4]$，其中\n$$\n\\boldsymbol{B}_i(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\eta} & \\frac{\\partial N_i}{\\partial \\xi} \\end{pmatrix}\n$$\n形函数的导数为：\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\tfrac{1}{4}(1-\\eta)$, $\\frac{\\partial N_1}{\\partial \\eta} = -\\tfrac{1}{4}(1-\\xi)$\n$\\frac{\\partial N_2}{\\partial \\xi} = \\tfrac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\tfrac{1}{4}(1+\\xi)$\n$\\frac{\\partial N_3}{\\partial \\xi} = \\tfrac{1}{4}(1+\\eta)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\tfrac{1}{4}(1+\\xi)$\n$\\frac{\\partial N_4}{\\partial \\xi} = -\\tfrac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\tfrac{1}{4}(1-\\xi)$\n将这些组合起来，得到完整的 $\\boldsymbol{B}(\\xi,\\eta)$ 矩阵。\n\n总应变能为 $U = \\tfrac{1}{2} \\int_{-1}^1 \\int_{-1}^1 \\boldsymbol{\\varepsilon}(\\xi,\\eta)^{\\mathsf{T}} \\mathbf{D} \\boldsymbol{\\varepsilon}(\\xi,\\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta$。\n被积函数是应变能密度，我们记作 $2W(\\xi,\\eta) = \\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{D} \\boldsymbol{\\varepsilon}$。\n$$\n2W(\\xi,\\eta) = \\begin{pmatrix} a\\eta & 0 & a\\xi \\end{pmatrix} \\begin{pmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & \\mu \\end{pmatrix} \\begin{pmatrix} a\\eta \\\\ 0 \\\\ a\\xi \\end{pmatrix}\n$$\n$$\n2W(\\xi,\\eta) = \\begin{pmatrix} a\\eta & 0 & a\\xi \\end{pmatrix} \\begin{pmatrix} (\\lambda + 2\\mu)a\\eta \\\\ \\lambda a\\eta \\\\ \\mu a\\xi \\end{pmatrix} = (\\lambda + 2\\mu)(a\\eta)^2 + \\mu(a\\xi)^2 = a^2 [(\\lambda+2\\mu)\\eta^2 + \\mu\\xi^2]\n$$\n\n我们现在使用两种指定的求积法则来计算应变能。\n\n1.  **单点 ($1 \\times 1$) 求积**\n    该法则是将被积函数在 $(\\xi, \\eta) = (0,0)$ 处求值，并乘以总权重 $4$。积分域在每个方向上都是从 $-1$ 到 $1$，面积为 $4$。\n    $$\n    U_{1\\times1} = \\frac{1}{2} \\times \\left( \\text{weight} \\times 2W(0,0) \\right) = \\frac{1}{2} \\times 4 \\times 2W(0,0) = 4W(0,0)\n    $$\n    或者，$U_{1\\times1} \\approx \\frac{1}{2} \\times \\text{权重} \\times \\left. (\\boldsymbol{\\varepsilon}^{\\mathsf{T}} \\mathbf{D} \\boldsymbol{\\varepsilon}) \\right|_{(\\xi,\\eta)=(0,0)}$。\n    在 $(\\xi, \\eta) = (0,0)$ 处，应变向量为 $\\boldsymbol{\\varepsilon}(0,0) = \\begin{pmatrix} a(0) \\\\ 0 \\\\ a(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n    对于此求积点，这是一个零能模式。因此，应变能密度为零：\n    $$\n    \\boldsymbol{\\varepsilon}(0,0)^{\\mathsf{T}} \\mathbf{D} \\boldsymbol{\\varepsilon}(0,0) = 0\n    $$\n    因此，用单点积分法则计算的应变能为：\n    $$\n    U_{1\\times1} = 0\n    $$\n\n2.  **每方向两点 ($2 \\times 2$) 求积**\n    该法则使用四个 Gauss 点 $(\\xi_q, \\eta_q) = (\\pm c, \\pm c)$，其中 $c=1/\\sqrt{3}$，每个点的权重为 $w_q=1$。\n    $$\n    U_{2\\times2} = \\frac{1}{2} \\sum_{q=1}^4 w_q \\left( \\boldsymbol{\\varepsilon}(\\xi_q, \\eta_q)^{\\mathsf{T}} \\mathbf{D} \\boldsymbol{\\varepsilon}(\\xi_q, \\eta_q) \\right) = \\sum_{q=1}^4 w_q W(\\xi_q, \\eta_q)\n    $$\n    这四个点是 $(c,c)$, $(c,-c)$, $(-c,-c)$ 和 $(-c,c)$。对于所有这些点，都有 $\\xi_q^2 = c^2$ 和 $\\eta_q^2 = c^2$。\n    让我们计算在任意一个这些点上的应变能密度：\n    $$\n    2W(\\pm c, \\pm c) = a^2 [(\\lambda+2\\mu)(\\pm c)^2 + \\mu(\\pm c)^2] = a^2 [(\\lambda+2\\mu)c^2 + \\mu c^2] = a^2 c^2 (\\lambda + 3\\mu)\n    $$\n    在所有四个 Gauss 点上，能量密度是相同的。\n    由于所有四个点的权重 $w_q=1$，总能量是每个点能量的总和：\n    $$\n    U_{2\\times2} = \\frac{1}{2} \\sum_{q=1}^4 [a^2 c^2 (\\lambda + 3\\mu)] = \\frac{1}{2} \\times 4 \\times [a^2 c^2 (\\lambda + 3\\mu)] = 2 a^2 c^2 (\\lambda + 3\\mu)\n    $$\n    代入 $c = 1/\\sqrt{3}$，则 $c^2=1/3$：\n    $$\n    U_{2\\times2} = 2 a^2 \\left(\\frac{1}{3}\\right) (\\lambda + 3\\mu) = \\frac{2}{3} a^2 (\\lambda + 3\\mu)\n    $$\n\n最后，我们计算比值 $U_{1\\times 1} / U_{2\\times 2}$。\n我们得到 $U_{1\\times1} = 0$。\n问题说明 $a \\neq 0$，$\\lambda>0$ 且 $\\mu>0$，这确保了 $U_{2\\times2} = \\frac{2}{3} a^2 (\\lambda + 3\\mu) > 0$。\n因此，比值为：\n$$\n\\frac{U_{1\\times 1}}{U_{2\\times 2}} = \\frac{0}{\\frac{2}{3} a^2 (\\lambda + 3\\mu)} = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "3553228"}]}