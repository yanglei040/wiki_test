{"hands_on_practices": [{"introduction": "高斯-勒让德求积法是有限元分析中数值积分的基石。为了高效而准确地选择积分方案，我们必须首先从第一性原理理解其核心特性。本练习将引导你推导高斯求积的精确度阶数，并将其应用于一个具体的多项式，从而揭示积分点数量与可被精确积分的多项式阶数之间的内在联系。[@problem_id:3585301]", "problem": "在计算固体力学的等参有限元设置中，常使用高斯-勒让德求积法，通过在母域 $[-1,1]$ 上的积分来计算单元矩阵。考虑在 $[-1,1]$ 上的多项式被积函数 $p(\\xi) = 1 + \\xi + \\xi^{4} + \\xi^{5}$。仅从以下基本性质出发：勒让德多项式系 $\\{P_{k}(\\xi)\\}_{k=0}^{\\infty}$ 在 $[-1,1]$ 上关于单位权重是正交的（即，当 $i \\neq j$ 时，$\\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi)\\,d\\xi = 0$），并且 $n$ 点高斯-勒让德求积使用的节点是 $P_{n}(\\xi)$ 的 $n$ 个不同实根，且权重为正。请完成以下任务：\n\n1. 利用正交性以及选择 $P_{n}(\\xi)$ 的根作为节点的特性，推导 $n$ 点高斯-勒让德求积在 $[-1,1]$ 上能够精确积分的最高多项式次数。您的推导不能事先假定此次数，而应从正交结构和 $P_{n}(\\xi)$ 在求积节点处为零的性质逻辑地得出。\n\n2. 使用第1部分的结果，确定使高斯-勒让德法则能精确计算积分 $\\int_{-1}^{1} p(\\xi)\\,d\\xi$ 所需的最小求积点数 $n$。\n\n3. 对于这个最小的 $n$，通过对一组足够的低次单项式强制精确性，明确地构造出节点和权重，然后计算 $p(\\xi)$ 的求积值以验证其精确性。将积分的最终值表示为一个精确的有理数。\n\n将您的最终答案表示为一个行矩阵，依次包含最小点数和积分的精确值，即 $\\begin{pmatrix} n  I \\end{pmatrix}$，其中 $I = \\int_{-1}^{1} p(\\xi)\\,d\\xi$。不需要四舍五入，也不需要单位。", "solution": "该问题是适定的，有科学依据，并为获得唯一解提供了所有必要信息。因此，问题陈述是有效的。我们按要求分三部分进行。\n\n第1部分：精确积分的最高多项式次数的推导。\n一个 $n$ 点高斯-勒让德求积法则将区间 $[-1, 1]$ 上的积分近似为\n$$\n\\int_{-1}^{1} f(\\xi)\\,d\\xi \\approx \\sum_{i=1}^{n} w_i f(\\xi_i)\n$$\n其中 $\\xi_i$ 是 $n$ 次勒让德多项式 $P_n(\\xi)$ 的 $n$ 个不同根（节点），$w_i$ 是相关的正权重。我们希望找到一个任意多项式 $q(\\xi)$ 的最高次数 $d$，使得该近似是精确的。\n\n设 $q(\\xi)$ 是一个多项式。根据多项式除法算法，我们可以将 $q(\\xi)$ 除以 $P_n(\\xi)$，得到唯一的商多项式 $k(\\xi)$ 和唯一的余多项式 $r(\\xi)$：\n$$\nq(\\xi) = k(\\xi) P_n(\\xi) + r(\\xi)\n$$\n余式的次数严格小于除式的次数，所以 $\\deg(r) \\le n-1$。商式的次数为 $\\deg(k) = \\deg(q) - \\deg(P_n) = \\deg(q) - n$。\n\n$q(\\xi)$ 的精确积分为\n$$\nI(q) = \\int_{-1}^{1} q(\\xi)\\,d\\xi = \\int_{-1}^{1} \\left( k(\\xi) P_n(\\xi) + r(\\xi) \\right) d\\xi = \\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi + \\int_{-1}^{1} r(\\xi)\\,d\\xi\n$$\n该积分的求积近似为\n$$\nQ_n(q) = \\sum_{i=1}^{n} w_i q(\\xi_i)\n$$\n根据定义，求积节点 $\\xi_i$ 是 $P_n(\\xi)$ 的根，因此对所有 $i \\in \\{1, 2, \\dots, n\\}$ 都有 $P_n(\\xi_i) = 0$。在这些节点上计算 $q(\\xi)$ 的值得到：\n$$\nq(\\xi_i) = k(\\xi_i) P_n(\\xi_i) + r(\\xi_i) = k(\\xi_i) \\cdot 0 + r(\\xi_i) = r(\\xi_i)\n$$\n因此，求积和简化为：\n$$\nQ_n(q) = \\sum_{i=1}^{n} w_i r(\\xi_i) = Q_n(r)\n$$\n如果 $I(q) = Q_n(q)$，则求积对于 $q(\\xi)$ 是精确的，这意味着：\n$$\n\\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi + I(r) = Q_n(r)\n$$\n$n$ 个权重 $w_i$ 可以被唯一确定，使得 $n$ 点求积法则对所有次数最高为 $n-1$ 的多项式都是精确的。这是插值型求积的一个基本性质。由于 $\\deg(r) \\le n-1$，因此可以得出 $I(r) = Q_n(r)$。\n在此基础上，$q(\\xi)$ 的精确性条件简化为：\n$$\n\\int_{-1}^{1} k(\\xi) P_n(\\xi)\\,d\\xi = 0\n$$\n勒让德多项式集 $\\{P_j(\\xi)\\}_{j=0}^{\\infty}$ 构成了 $[-1, 1]$ 上多项式空间关于单位权函数的一个正交基。任何多项式，包括 $k(\\xi)$，都可以表示为勒让德多项式的线性组合。设 $\\deg(k) = m$。则对于某些系数 $c_j$，有 $k(\\xi) = \\sum_{j=0}^{m} c_j P_j(\\xi)$。该积分变为：\n$$\n\\int_{-1}^{1} \\left( \\sum_{j=0}^{m} c_j P_j(\\xi) \\right) P_n(\\xi)\\,d\\xi = \\sum_{j=0}^{m} c_j \\int_{-1}^{1} P_j(\\xi) P_n(\\xi)\\,d\\xi\n$$\n由于正交性质，对于所有 $j  n$，都有 $\\int_{-1}^{1} P_j(\\xi) P_n(\\xi)\\,d\\xi = 0$。因此，如果求和仅对小于 $n$ 的索引 $j$ 进行，则该积分为零，这在 $m = \\deg(k) \\le n-1$ 时成立。\n我们得到条件 $\\deg(k) = \\deg(q) - n \\le n-1$，这意味着 $\\deg(q) \\le 2n-1$。\n因此，一个 $n$ 点高斯-勒让德求积对所有次数最高为 $2n-1$ 的多项式都是精确的。\n\n第2部分：对 $p(\\xi)$ 的最小求积点数。\n给定的被积函数为 $p(\\xi) = 1 + \\xi + \\xi^{4} + \\xi^{5}$。这是一个 $5$ 次多项式。根据第1部分，为使求积精确，我们要求精确积分的最高次数 $2n-1$ 至少为该多项式的次数 $5$。\n$$\n2n-1 \\ge 5\n$$\n$$\n2n \\ge 6\n$$\n$$\nn \\ge 3\n$$\n因此，最小整数求积点数为 $n=3$。\n\n第3部分：构造 $3$ 点法则并计算积分。\n当 $n=3$ 时，该法则对次数最高为 $2(3)-1 = 5$ 的多项式是精确的。我们需要通过对一个多项式基强制精确性来找到 $3$ 个节点（$\\xi_1, \\xi_2, \\xi_3$）和 $3$ 个权重（$w_1, w_2, w_3$）。我们使用单项式 $\\{1, \\xi, \\xi^2, \\xi^3, \\xi^4, \\xi^5 \\}$。\n由于勒让德多项式和区间 $[-1, 1]$ 的对称性，节点和权重也是对称的：$\\xi_2=0$，$\\xi_3=-\\xi_1$ 且 $w_3=w_1$。\n\n1.  对于 $f(\\xi) = 1 = \\xi^0$：$\\int_{-1}^{1} 1\\,d\\xi = 2$。求积：$w_1+w_2+w_3 = 2w_1+w_2=2$。\n2.  对于 $f(\\xi) = \\xi$：$\\int_{-1}^{1} \\xi\\,d\\xi = 0$。求积：$w_1\\xi_1+w_2(0)+w_1(-\\xi_1) = 0$，由对称性可知此式成立。\n3.  对于 $f(\\xi) = \\xi^2$：$\\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{2}{3}$。求积：$w_1\\xi_1^2+w_2(0)^2+w_1(-\\xi_1)^2 = 2w_1\\xi_1^2 = \\frac{2}{3} \\implies w_1\\xi_1^2 = \\frac{1}{3}$。\n4.  对于 $f(\\xi) = \\xi^3$：$\\int_{-1}^{1} \\xi^3\\,d\\xi = 0$。求积：$w_1\\xi_1^3+w_2(0)^3+w_1(-\\xi_1)^3 = 0$，由对称性可知此式成立。\n5.  对于 $f(\\xi) = \\xi^4$：$\\int_{-1}^{1} \\xi^4\\,d\\xi = \\frac{2}{5}$。求积：$w_1\\xi_1^4+w_2(0)^4+w_1(-\\xi_1)^4 = 2w_1\\xi_1^4 = \\frac{2}{5} \\implies w_1\\xi_1^4 = \\frac{1}{5}$。\n\n我们得到方程组：\n(a) $2w_1+w_2=2$\n(b) $w_1\\xi_1^2 = \\frac{1}{3}$\n(c) $w_1\\xi_1^4 = \\frac{1}{5}$\n\n将 (c) 除以 (b)：$\\frac{w_1\\xi_1^4}{w_1\\xi_1^2} = \\frac{1/5}{1/3} \\implies \\xi_1^2 = \\frac{3}{5}$。\n节点是 $\\xi_1 = -\\sqrt{\\frac{3}{5}}$，$\\xi_2 = 0$ 和 $\\xi_3 = \\sqrt{\\frac{3}{5}}$。\n将 $\\xi_1^2$ 代入 (b)：$w_1(\\frac{3}{5}) = \\frac{1}{3} \\implies w_1 = \\frac{5}{9}$。\n因此，$w_1=w_3=\\frac{5}{9}$。\n将 $w_1$ 代入 (a)：$2(\\frac{5}{9}) + w_2 = 2 \\implies w_2 = 2 - \\frac{10}{9} = \\frac{8}{9}$。\n\n这个 $3$ 点高斯-勒让德法则由以下节点和权重定义：\n节点：$\\{\\xi_1, \\xi_2, \\xi_3\\} = \\{-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}\\}$\n权重：$\\{w_1, w_2, w_3\\} = \\{\\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\}$\n\n现在我们求积分 $I = \\int_{-1}^{1} p(\\xi)\\,d\\xi$ 的值，并用求积法进行验证。\n首先，计算精确积分：\n$$\nI = \\int_{-1}^{1} (1 + \\xi + \\xi^{4} + \\xi^{5}) \\,d\\xi\n$$\n在对称区间上，奇次幂项的积分为零。\n$$\nI = \\int_{-1}^{1} (1 + \\xi^{4}) \\,d\\xi = \\left[ \\xi + \\frac{\\xi^5}{5} \\right]_{-1}^{1} = \\left(1 + \\frac{1}{5}\\right) - \\left(-1 - \\frac{1}{5}\\right) = 2 \\left(1 + \\frac{1}{5}\\right) = 2 \\left(\\frac{6}{5}\\right) = \\frac{12}{5}\n$$\n其次，进行求积计算：\n$Q_3(p) = \\frac{5}{9}p(-\\sqrt{\\frac{3}{5}}) + \\frac{8}{9}p(0) + \\frac{5}{9}p(\\sqrt{\\frac{3}{5}})$。\n$p(0) = 1+0+0+0 = 1$。\n$p(\\sqrt{\\frac{3}{5}}) = 1 + \\sqrt{\\frac{3}{5}} + (\\frac{3}{5})^2 + (\\frac{3}{5})^2\\sqrt{\\frac{3}{5}} = 1 + \\frac{9}{25} + \\sqrt{\\frac{3}{5}}(1+\\frac{9}{25}) = \\frac{34}{25} + \\frac{34}{25}\\sqrt{\\frac{3}{5}}$。\n$p(-\\sqrt{\\frac{3}{5}}) = 1 - \\sqrt{\\frac{3}{5}} + (\\frac{3}{5})^2 - (\\frac{3}{5})^2\\sqrt{\\frac{3}{5}} = 1 + \\frac{9}{25} - \\sqrt{\\frac{3}{5}}(1+\\frac{9}{25}) = \\frac{34}{25} - \\frac{34}{25}\\sqrt{\\frac{3}{5}}$。\n$$\nQ_3(p) = \\frac{5}{9}\\left[ \\left(\\frac{34}{25} - \\frac{34}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{34}{25} + \\frac{34}{25}\\sqrt{\\frac{3}{5}}\\right) \\right] + \\frac{8}{9}(1)\n$$\n$$\nQ_3(p) = \\frac{5}{9}\\left[ 2 \\cdot \\frac{34}{25} \\right] + \\frac{8}{9} = \\frac{5}{9} \\frac{68}{25} + \\frac{8}{9} = \\frac{1}{9} \\frac{68}{5} + \\frac{8}{9} = \\frac{68}{45} + \\frac{40}{45} = \\frac{108}{45}\n$$\n化简该分数可得 $\\frac{108}{45} = \\frac{12 \\cdot 9}{5 \\cdot 9} = \\frac{12}{5}$。\n求积值与精确积分值相匹配，验证了我们的推导。最小点数为 $n=3$，积分的精确值为 $I=\\frac{12}{5}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  \\frac{12}{5}\n\\end{pmatrix}\n}\n$$", "id": "3585301"}, {"introduction": "在掌握了高斯求积的理论基础后，下一步是将其应用于有限元方法的核心任务：计算单元矩阵和向量。本练习模拟了一个典型场景，即计算双线性四边形单元在体力源作用下的等效节点荷载向量。通过分析被积函数的阶数，你将验证为何标准的 $2 \\times 2$ 高斯求积能够为这一特定问题提供精确解，从而加深对理论与实践结合的理解。[@problem_id:3585231]", "problem": "考虑一个二维标量扩散类问题，该问题通过一个等参双线性四边形单元（通常表示为$Q1$单元）进行离散。设单元节点的物理坐标为 $\\{(x_{i},y_{i})\\}_{i=1}^{4}$，按逆时针顺序排列。从具有局部坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的参考方形域到物理单元的等参映射由下式给出\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n其标准双线性形函数为\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n设单位面积的体源在物理坐标中是仿射的，\n$$\nq(x,y)=\\alpha\\,x+\\beta\\,y+\\gamma,\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是常数。等效节点载荷向量 $\\boldsymbol{f}_{e}\\in\\mathbb{R}^{4}$ 由弱形式定义为\n$$\nf_{i}=\\int_{\\Omega_{e}}N_{i}(x,y)\\,q(x,y)\\,\\mathrm{d}\\Omega,\\qquad i=1,2,3,4.\n$$\n使用等参映射，该积分可以在参考方形域上写为\n$$\nf_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $\\mathbf{J}(\\xi,\\eta)$ 是映射的雅可比矩阵，$\\det\\mathbf{J}(\\xi,\\eta)$ 是其行列式。\n\n任务：\n- 使用 $[-1,1]^{2}$ 上的标准 $2\\times 2$ 高斯求积法则计算节点等效载荷向量 $\\boldsymbol{f}_{e}$，即使用点 $(\\xi_{k},\\eta_{k})\\in\\{(-s,-s),(+s,-s),(+s,+s),(-s,+s)\\}$，其中 $s=1/\\sqrt{3}$，且每个方向上的权重均为单位1。\n- 用 $\\alpha$、$\\beta$、$\\gamma$、节点坐标 $\\{(x_{i},y_{i})\\}_{i=1}^{4}$、在高斯点处求值的形函数以及在高斯点处求值的雅可比行列式来明确写出你的结果。\n- 然后，根据多项式精确性的第一性原理，验证对于任何双线性四边形几何形状和任何如上所述的仿射 $q(x,y)$，该 $2\\times 2$ 求积都能得到 $\\boldsymbol{f}_{e}$ 的精确值。\n\n为了使您的最终表达式紧凑，您可以使用简写 $N_{ik}=N_{i}(\\xi_{k},\\eta_{k})$，$x_{k}=x(\\xi_{k},\\eta_{k})$，$y_{k}=y(\\xi_{k},\\eta_{k})$ 和 $J_{k}=\\det\\mathbf{J}(\\xi_{k},\\eta_{k})$，其中 $k=1,2,3,4$，且 $(\\xi_{k},\\eta_{k})$ 按上面列出的顺序排列。将您的最终答案表示为一个 $1\\times 4$ 的行矩阵，其中包含此求积形式下 $\\boldsymbol{f}_{e}$ 的四个分量。不需要进行数值计算或四舍五入，也无需报告单位。最终答案必须是指定的单个封闭形式的解析表达式。", "solution": "首先对问题进行严格的验证过程。\n\n### 第1步：提取已知条件\n问题陈述中提供的数据、变量和条件如下：\n- **单元类型**：一个二维等参双线性四边形单元，表示为$Q1$单元。\n- **节点坐标**：单元节点的物理坐标为 $\\{(x_{i},y_{i})\\}_{i=1}^{4}$，按逆时针顺序排列。\n- **参考域**：局部坐标 $(\\xi,\\eta)$ 定义在参考方形域 $[-1,1]\\times[-1,1]$ 上。\n- **等参映射**：\n  - $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$\n  - $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$\n- **形函数**：标准的双线性形函数为：\n  - $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$\n  - $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$\n  - $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$\n  - $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$\n- **源项**：单位面积的体源是一个仿射函数 $q(x,y)=\\alpha\\,x+\\beta\\,y+\\gamma$，其中 $\\alpha$、$\\beta$、$\\gamma$ 是常数。\n- **节点载荷向量**：等效节点载荷向量 $\\boldsymbol{f}_{e}\\in\\mathbb{R}^{4}$ 的第 $i$ 个分量由积分 $f_{i}=\\int_{\\Omega_{e}}N_{i}(x,y)\\,q(x,y)\\,\\mathrm{d}\\Omega$ 定义。\n- **变换后的积分**：在参考方形域上的积分为 $f_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n- **数值求积**：将使用 $2\\times 2$ 高斯求积法则。\n  - 求积点：$(\\xi_{k},\\eta_{k})\\in\\{(-s,-s),(+s,-s),(+s,+s),(-s,+s)\\}$，分别对应 $k=1,2,3,4$，其中 $s=1/\\sqrt{3}$。\n  - 求积权重：每个方向上的权重均为单位1，因此每个二维点的权重为 $1$。\n- **简写符号**：$N_{ik}=N_{i}(\\xi_{k},\\eta_{k})$，$x_{k}=x(\\xi_{k},\\eta_{k})$，$y_{k}=y(\\xi_{k},\\eta_{k})$，以及 $J_{k}=\\det\\mathbf{J}(\\xi_{k},\\eta_{k})$。\n\n### 第2步：使用提取的已知条件进行验证\n在有限元法（FEM）的标准理论框架内，该问题是良定义的。\n- **科学依据**：所有概念，包括等参映射、双线性形函数、源项的弱形式积分和高斯求积，都是计算力学和数值分析中的基本且正确的原理。\n- **良定的**：问题是明确的，并提供了计算所要求量和进行验证所需的所有必要信息。数值积分载荷向量存在唯一解。\n- **客观性**：语言是精确和数学化的。没有主观或基于观点的陈述。\n- **完整性**：问题是自洽的。几何形状、源项和数值方法都已指定。\n- **一致性**：所提供的数据或定义中没有内部矛盾。验证精确性的任务是一个标准的练习，它突出了所选数值方案对于此特定被积函数的一个重要性质。\n\n### 第3步：结论与行动\n该问题是**有效的**。这是计算固体力学领域中一个良定的标准练习。现在开始求解过程。\n\n### 解答\n\n任务有两部分：首先，使用指定的求积法则计算节点等效载荷向量 $\\boldsymbol{f}_{e}$；其次，验证该数值积分是精确的。\n\n#### 第1部分：节点载荷向量的计算\n\n等效节点载荷向量的第 $i$ 个分量 $f_i$ 由在参考单元上的积分给出：\n$$\nf_{i}=\\int_{-1}^{1}\\int_{-1}^{1}N_{i}(\\xi,\\eta)\\,q\\!\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n我们被要求使用 $2\\times 2$ 高斯求积法则来计算这个积分。该法则将函数 $g(\\xi, \\eta)$ 在域 $[-1,1]^2$ 上的积分近似为函数在四个特定求积点处值的加权和：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} g(\\xi,\\eta) \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\sum_{k=1}^{4} w_{k} g(\\xi_{k},\\eta_{k})\n$$\n在这个问题中，求积点为 $(\\xi_k, \\eta_k)$，其中 $k=1,2,3,4$ 且 $s=1/\\sqrt{3}$：\n- $(\\xi_1, \\eta_1) = (-s, -s)$\n- $(\\xi_2, \\eta_2) = (s, -s)$\n- $(\\xi_3, \\eta_3) = (s, s)$\n- $(\\xi_4, \\eta_4) = (-s, s)$\n\n权重被指定为单位权重，即对所有 $k=1,2,3,4$ 都有 $w_k = 1$。被积函数是 $g(\\xi,\\eta) = N_{i}(\\xi,\\eta)\\,q(x(\\xi,\\eta),y(\\xi,\\eta))\\,\\det\\mathbf{J}(\\xi,\\eta)$。\n\n应用求积法则，分量 $f_i$ 近似为：\n$$\nf_{i} \\approx \\sum_{k=1}^{4} (1) \\cdot N_{i}(\\xi_{k},\\eta_{k})\\,q\\!\\big(x(\\xi_{k},\\eta_{k}),y(\\xi_{k},\\eta_{k})\\big)\\,\\det\\mathbf{J}(\\xi_{k},\\eta_{k})\n$$\n使用指定的简写符号：\n- $N_{ik} = N_{i}(\\xi_{k},\\eta_{k})$\n- $x_{k} = x(\\xi_{k},\\eta_{k}) = \\sum_{j=1}^{4}N_{j}(\\xi_{k},\\eta_{k})x_{j}$\n- $y_{k} = y(\\xi_{k},\\eta_{k}) = \\sum_{j=1}^{4}N_{j}(\\xi_{k},\\eta_{k})y_{j}$\n- $J_{k} = \\det\\mathbf{J}(\\xi_{k},\\eta_{k})$\n\n并代入源项 $q(x,y) = \\alpha x + \\beta y + \\gamma$，我们得到：\n$$\nq(x_k, y_k) = \\alpha x_k + \\beta y_k + \\gamma\n$$\n$f_i$ 的表达式变为：\n$$\nf_{i} \\approx \\sum_{k=1}^{4} N_{ik} \\, (\\alpha x_{k} + \\beta y_k + \\gamma) \\, J_{k}\n$$\n可以为每个分量 $i=1,2,3,4$ 整合此表达式，以构成节点载荷向量 $\\boldsymbol{f}_{e} = \\begin{pmatrix} f_1  f_2  f_3  f_4 \\end{pmatrix}$。这提供了所要求的显式形式。\n\n#### 第2部分：精确性验证\n\n我们必须验证 $2\\times 2$ 高斯求积能够得到积分的精确值。$[-1,1]^2$ 上的张量积 $n$ 点高斯求积法则能够精确地积分任何在每个变量 $\\xi$ 和 $\\eta$ 上次数最高为 $2n-1$ 的多项式。对于 $2\\times 2$ 法则，$n=2$，因此它对于 $\\xi$ 中次数最高为 $2(2)-1=3$ 且 $\\eta$ 中次数最高为 $3$ 的多项式是精确的。\n\n为了证明精确性，我们必须分析被积函数 $I_i(\\xi, \\eta) = N_{i}(\\xi,\\eta)\\,q(x(\\xi,\\eta),y(\\xi,\\eta))\\,\\det\\mathbf{J}(\\xi,\\eta)$ 关于局部坐标 $\\xi$ 和 $\\eta$ 的多项式次数。\n\n1.  **形函数 $N_i(\\xi, \\eta)$**：形函数 $N_i(\\xi,\\eta) = \\frac{1}{4}(1\\pm\\xi)(1\\pm\\eta)$ 是双线性的。它们是关于 $\\xi$ 的1次多项式和关于 $\\eta$ 的1次多项式。我们用空间 $P_{11}$ 表示此类多项式。\n\n2.  **源项 $q(x(\\xi,\\eta),y(\\xi,\\eta))$**：物理坐标 $x$ 和 $y$ 由等参映射 $x(\\xi,\\eta)=\\sum_{j=1}^4 N_j(\\xi,\\eta)x_j$ 和 $y(\\xi,\\eta)=\\sum_{j=1}^4 N_j(\\xi,\\eta)y_j$ 给出。由于这是双线性形函数 $N_j$ 的线性组合，因此 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 本身也是关于 $\\xi$ 和 $\\eta$ 的双线性多项式（即它们属于 $P_{11}$）。\n    源项是 $q(x,y) = \\alpha x + \\beta y + \\gamma$。当用局部坐标表示时，$q(\\xi,\\eta) = \\alpha x(\\xi,\\eta) + \\beta y(\\xi,\\eta) + \\gamma$。作为 $P_{11}$ 中函数的线性组合，$q(\\xi,\\eta)$ 也是一个关于 $\\xi$ 和 $\\eta$ 的双线性多项式，因此它也属于 $P_{11}$。\n\n3.  **雅可比行列式 $\\det\\mathbf{J}(\\xi, \\eta)$**：变换的雅可比矩阵为 $\\mathbf{J} = \\begin{pmatrix} \\partial x / \\partial \\xi  \\partial y / \\partial \\xi \\\\ \\partial x / \\partial \\eta  \\partial y / \\partial \\eta \\end{pmatrix}$。\n    形函数的导数具有 $\\partial N_j/\\partial\\xi = c_j(1\\pm\\eta)$ 和 $\\partial N_j/\\partial\\eta = d_j(1\\pm\\xi)$ 的形式，其中 $c_j, d_j$ 是常数。\n    - 项 $\\partial x/\\partial\\xi = \\sum_j (\\partial N_j/\\partial\\xi)x_j$ 和 $\\partial y/\\partial\\xi = \\sum_j (\\partial N_j/\\partial\\xi)y_j$ 是关于 $\\eta$ 线性的，关于 $\\xi$ 是常数。\n    - 项 $\\partial x/\\partial\\eta = \\sum_j (\\partial N_j/\\partial\\eta)x_j$ 和 $\\partial y/\\partial\\eta = \\sum_j (\\partial N_j/\\partial\\eta)y_j$ 是关于 $\\xi$ 线性的，关于 $\\eta$ 是常数。\n    行列式为 $\\det\\mathbf{J} = (\\partial x / \\partial \\xi)(\\partial y / \\partial \\eta) - (\\partial y / \\partial \\xi)(\\partial x / \\partial \\eta)$。\n    让我们将这些分量表示为多项式：\n    - $\\partial x/\\partial \\xi = A_1+B_1\\eta$\n    - $\\partial y/\\partial \\xi = C_1+D_1\\eta$\n    - $\\partial x/\\partial \\eta = A_2+B_2\\xi$\n    - $\\partial y/\\partial \\eta = C_2+D_2\\xi$\n    其中系数 $A_1, B_1, \\dots, D_2$ 是取决于节点坐标的常数。\n    那么，行列式是：\n    $$\n    \\det\\mathbf{J}(\\xi,\\eta) = (A_1+B_1\\eta)(C_2+D_2\\xi) - (C_1+D_1\\eta)(A_2+B_2\\xi)\n    $$\n    展开这个乘积得到一个包含 $1$、$\\xi$、$\\eta$ 和 $\\xi\\eta$ 项的多项式。因此，$\\det\\mathbf{J}(\\xi,\\eta)$ 是一个关于 $\\xi$ 和 $\\eta$ 的双线性多项式，属于 $P_{11}$。这对于由节点坐标定义的任何一般（非退化）四边形几何形状都成立。\n\n4.  **总被积函数**：被积函数 $I_i(\\xi, \\eta)$ 是三个函数的乘积，每个函数都是 $P_{11}$ 中的双线性多项式：\n    $$\n    I_i(\\xi, \\eta) = \\underbrace{N_{i}(\\xi,\\eta)}_{\\in P_{11}} \\times \\underbrace{q(\\xi,\\eta)}_{\\in P_{11}} \\times \\underbrace{\\det\\mathbf{J}(\\xi,\\eta)}_{\\in P_{11}}\n    $$\n    一个关于 $\\xi$ 的 $m_1$ 次多项式与另一个关于 $\\xi$ 的 $m_2$ 次多项式的乘积是关于 $\\xi$ 的 $m_1+m_2$ 次多项式。\n    $I_i$ 中 $\\xi$ 的最高次数是 $1+1+1=3$。\n    $I_i$ 中 $\\eta$ 的最高次数是 $1+1+1=3$。\n    因此，被积函数 $I_i(\\xi, \\eta)$ 是一个关于 $\\xi$ 最高为3次且关于 $\\eta$ 最高为3次的多项式。\n\n由于 $2\\times 2$ 高斯求积法则能够精确积分在每个变量上次数最高为3的所有多项式，因此对于这个特定问题，数值近似实际上是精确的。在第1部分中使用“$\\approx$”只是引入求积法则的一种形式；对于本特定情况，它可以被等号替换。因此，计算出的向量是精确的载荷向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{k=1}^{4} J_{k} N_{1k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{2k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{3k} (\\alpha x_{k} + \\beta y_{k} + \\gamma)  \\sum_{k=1}^{4} J_{k} N_{4k} (\\alpha x_{k} + \\beta y_{k} + \\gamma) \\end{pmatrix}}\n$$", "id": "3585231"}, {"introduction": "在计算固体力学中，数值效率和解的准确性之间常常需要权衡。“缩减积分”是一种常用的加速计算技术，但它也可能引入非物理的数值失稳，即“沙漏模式”。本练习通过对比全积分和缩减积分方案下单元刚度矩阵的谱（特征值），让你亲手揭示欠积分所导致的伪零能模式，这是理解和避免有限元模型中常见数值陷阱的关键一步。[@problem_id:3585291]", "problem": "考虑在线性弹性平面应变问题中，有限元法（FEM）里的一个单独的四节点双线性四边形（常称为 $Q1$）有限元。该单元在物理坐标中占据一个单位正方形，其顶点位于 $(0,0)$、$(1,0)$、$(1,1)$ 和 $(0,1)$，并具有恒定的厚度 $t0$。材料是均匀、各向同性、线性弹性的，其杨氏模量为 $E0$，泊松比为 $\\nu$，满足 $0  \\nu  \\frac{1}{2}$。平面内位移场通过定义在标准单元正方形 $[-1,1]\\times[-1,1]$ 上的标准双线性形函数进行插值。对于这个单位正方形，从母坐标 $(\\xi,\\eta)$到物理坐标 $(x,y)$ 的等参映射是仿射的，且雅可比行列式 $\\det J=\\frac{1}{4}$。\n\n从线性弹性力学的基本原理出发：单元刚度矩阵 $K_{e}$ 源于总应变能 $U=\\frac{t}{2}\\int_{\\Omega_{e}} \\varepsilon^{T} D\\, \\varepsilon \\,\\mathrm{d}\\Omega$ 的二次型形式，其中 $\\varepsilon=B\\,d$ 是通过应变-位移矩阵 $B$ 和节点位移向量 $d\\in\\mathbb{R}^{8}$ 表示的线性化应变，而 $D$ 是平面应变问题的对称正定 $3\\times 3$ 本构矩阵。因此，\n$$\nK_{e}=t\\int_{\\Omega_{e}} B^{T} D\\, B\\, \\mathrm{d}\\Omega.\n$$\n使用高斯积分（GQ），通过两种方式集成 $K_{e}$：\n(i) 减缩 $1\\times 1$ 法则，在母空间单点 $(\\xi,\\eta)=(0,0)$ 求值，权重为 $w=4$；以及\n(ii) 完全 $2\\times 2$ 法则，在母空间点 $(\\pm \\frac{1}{\\sqrt{3}},\\pm \\frac{1}{\\sqrt{3}})$ 求值，每个点的权重为 $w=1$。\n对于这两种法则，都应包括雅可比行列式因子 $\\det J=\\frac{1}{4}$，并假设单位正方形的映射是精确的，因此雅可比矩阵是常数。\n\n计算并比较这两个单元刚度矩阵的谱（特征值及其代数重数）。识别出刚体模态以及因减缩积分而出现的任何额外零能模态。作为最终答案，报告相对于 $2\\times 2$ 积分法则，$1\\times 1$ 积分法则引入的额外零特征值的数量。请以单个整数形式提供最终答案。最终答案无需四舍五入，也无需物理单位。[@problem_id:135]", "solution": "用户要求我确定，对于平面应变下的四节点双线性四边形（$Q1$）单元，与使用完全 $2 \\times 2$ 高斯积分（GQ）法则相比，使用减缩 $1 \\times 1$ GQ 法则时，额外产生的零能模态（即刚度矩阵的零特征值）的数量。\n\n首先对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **单元**：用于平面应变的四节点双线性四边形（$Q1$）。\n-   **物理坐标**：顶点位于 $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$（一个单位正方形）。\n-   **母坐标**：在标准单元正方形 $[-1,1]\\times[-1,1]$ 上的双线性形函数。\n-   **材料属性**：均匀、各向同性、线性弹性，杨氏模量 $E>0$，泊松比 $0  \\nu  1/2$。\n-   **厚度**：恒定， $t>0$。\n-   **刚度矩阵公式**：$K_{e} = t \\int_{\\Omega_{e}} B^{T} D B \\, \\mathrm{d}\\Omega$。\n-   **运动学**：应变 $\\varepsilon = B d$，其中 $d \\in \\mathbb{R}^{8}$ 是节点位移向量。\n-   **本构矩阵**：$D$ 是用于平面应变的对称正定 $3 \\times 3$ 矩阵。\n-   **映射**：等参映射，具有恒定的雅可比行列式 $\\det J = 1/4$。\n-   **积分法则**：\n    -   (i) 减缩 $1 \\times 1$ GQ：单点 $(\\xi,\\eta)=(0,0)$，权重 $w=4$。\n    -   (ii) 完全 $2 \\times 2$ GQ：四个点 $(\\pm \\frac{1}{\\sqrt{3}},\\pm \\frac{1}{\\sqrt{3}})$，每个点的权重为 $w=1$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是计算固体力学中的一个标准基础练习，特别是有限元法（FEM）。所有概念，包括 $Q1$ 单元、平面应变弹性、数值积分以及沙漏现象，都是完善建立的科学原理。\n-   **适定性**：问题陈述清晰，包含了推导出唯一、确定性整数答案所需的所有信息。\n-   **客观性**：语言精确、技术性强，没有任何主观性。\n\n该问题是自洽的、科学上合理的且适定的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供详细的解答。\n\n### 解答推导\n\n有限元的刚度矩阵由下式给出：\n$$ K_{e} = t \\int_{\\Omega_{e}} B^{T} D B \\, \\mathrm{d}A $$\n其中 $t$ 是单元厚度，$B$ 是应变-位移矩阵，$D$ 是材料本构矩阵。积分区域是单元的面积 $\\Omega_e$。使用从母坐标 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 到物理坐标 $(x,y)$ 的等参映射，该积分变为：\n$$ K_{e} = t \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi, \\eta)^{T} D B(\\xi, \\eta) \\det(J) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\n问题陈述 $\\det(J) = 1/4$ 是常数。$K_e$ 的零特征值数量等于其零空间的维数。一个节点位移向量 $d$ 位于 $K_e$ 的零空间中，当且仅当它对应一个零能模态，即 $d^T K_e d = 0$。\n$$ d^T K_e d = t \\int_{-1}^{1} \\int_{-1}^{1} d^T B^{T} D B d \\, \\mathrm{d}\\xi \\mathrm{d}\\eta_e \\det(J) = t \\det(J) \\int_{-1}^{1} \\int_{-1}^{1} \\varepsilon(\\xi, \\eta)^{T} D \\varepsilon(\\xi, \\eta) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta = 0 $$\n其中 $\\varepsilon = B d$。由于材料是弹性的（$t>0, E>0, 0\\nu1/2$），本构矩阵 $D$ 是对称正定的。这意味着被积函数 $\\varepsilon^T D \\varepsilon$ 总是非负的。要使积分为零，被积函数必须在整个积分域内为零。\n\n对于具有仿射映射（如此处的平行四边形）的 $Q1$ 单元，应变-位移矩阵 $B(\\xi, \\eta)$ 是 $\\xi$ 和 $\\eta$ 的线性函数。因此，被积函数 $B(\\xi, \\eta)^{T} D B(\\xi, \\eta)$ 是一个矩阵，其元素是关于 $\\xi$ 和 $\\eta$ 的二次多项式。\n\n**情况 (ii)：完全 $2 \\times 2$ 高斯积分**\n\n$2 \\times 2$ GQ 法则使用 4 个点，能对每个变量次数最高为 $2(2)-1=3$ 的多项式进行精确积分。由于我们的被积函数是二次的，该法则是精确的。设此矩阵为 $K_{e, \\text{full}}$。积分近似变为一个等式：\n$$ d^T K_{e, \\text{full}} d = t \\det(J) \\sum_{i=1}^{4} w_i \\left( \\varepsilon(\\xi_i, \\eta_i)^T D \\varepsilon(\\xi_i, \\eta_i) \\right) = 0 $$\n其中积分点为 $(\\xi_i, \\eta_i) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，权重为 $w_i=1$。由于 $D$ 是正定的，这个和为零当且仅当每一项都为零。\n$$ \\varepsilon(\\xi_i, \\eta_i)^T D \\varepsilon(\\xi_i, \\eta_i) = 0 \\quad \\implies \\quad \\varepsilon(\\xi_i, \\eta_i) = B(\\xi_i, \\eta_i) d = 0 \\quad \\text{for } i=1,2,3,4. $$\n应变向量 $\\varepsilon = [\\varepsilon_x, \\varepsilon_y, \\gamma_{xy}]^T$ 的分量本身是 $\\xi$ 和 $\\eta$ 的线性函数。例如，$\\varepsilon_x(\\xi, \\eta)=c_0+c_1\\xi+c_2\\eta$。如果一个线性函数在所有四个高斯点上都为零，那么它必定处处恒等于零。\n因此，对于完全积分的单元，一个模态 $d$ 是零能模态，当且仅当它在任何地方都产生零应变，即对于所有 $(\\xi, \\eta)$ 都有 $\\varepsilon(\\xi, \\eta) \\equiv 0$。\n唯一能产生零应变的位移场是刚体运动。对于一个二维物体，有 3 种这样的运动：\n1.  沿 $x$ 方向的平动。\n2.  沿 $y$ 方向的平动。\n3.  绕垂直于该平面的轴的无穷小转动。\n\n这 3 个模态张成了 $K_{e, \\text{full}}$ 的零空间。由于 $K_{e, \\text{full}}$ 是一个 $8 \\times 8$ 矩阵，其秩为 $8-3=5$。完全积分刚度矩阵的零特征值数量为 3。\n\n**情况 (i)：减缩 $1 \\times 1$ 高斯积分**\n\n$1 \\times 1$ GQ 法则使用单点 $(\\xi, \\eta)=(0,0)$，权重为 $w=4$。该法则只能精确积分次数最高为 $2(1)-1=1$ 的多项式，因此对于我们的二次被积函数，它是一个近似。设此矩阵为 $K_{e, \\text{red}}$。\n$$ K_{e, \\text{red}} = t \\cdot \\det(J) \\cdot w \\cdot B(0,0)^T D B(0,0) = t \\cdot \\frac{1}{4} \\cdot 4 \\cdot B(0,0)^T D B(0,0) = t B(0,0)^T D B(0,0) $$\n一个模态 $d$ 是零能模态，如果 $d^T K_{e, \\text{red}} d = 0$，这意味着：\n$$ t (B(0,0) d)^T D (B(0,0) d) = 0 $$\n由于 $t>0$ 且 $D$ 是正定的，这要求 $\\varepsilon(0,0) = B(0,0) d = 0$。应变必须 *仅在单元中心* 为零。这比完全积分单元的条件弱得多。\n\n为了找到零空间的维数，我们需要 $K_{e, \\text{red}}$ 的秩。$K_{e, \\text{red}}$ 的秩等于 $B(0,0)$ 的秩。应变-位移矩阵为：\n$$ B(\\xi, \\eta) = \\frac{1}{2} \\begin{pmatrix} -(1-\\eta)  0  (1-\\eta)  0  (1+\\eta)  0  -(1+\\eta)  0 \\\\ 0  -(1-\\xi)  0  -(1+\\xi)  0  (1+\\xi)  0  (1-\\xi) \\\\ -(1-\\xi)  -(1-\\eta)  -(1+\\xi)  (1-\\eta)  (1+\\xi)  (1+\\eta)  (1-\\xi)  -(1+\\eta) \\end{pmatrix} $$\n在 $(\\xi, \\eta) = (0,0)$ 处求值：\n$$ B(0,0) = \\frac{1}{2} \\begin{pmatrix} -1  0  1  0  1  0  -1  0 \\\\ 0  -1  0  -1  0  1  0  1 \\\\ -1  -1  -1  1  1  1  1  -1 \\end{pmatrix} $$\n这是一个 $3 \\times 8$ 矩阵。它的秩最多为 3。可以证明 $B(0,0)$ 的三行是线性无关的。因此，$\\text{rank}(B(0,0))=3$。\n$K_{e, \\text{red}}$ 的秩也是 3。\n$K_{e, \\text{red}}$ 的零空间的维数由其零度给出，即 $8 - \\text{rank}(K_{e, \\text{red}}) = 8 - 3 = 5$。\n所以，减缩积分刚度矩阵的零特征值数量为 5。\n\n这 5 个零能模态包括 3 个刚体运动（它们处处应变为零，因此在中心处也为零）和 2 个额外模态。这些额外模态在中心处应变为零，但在其他地方应变为非零。它们是伪模态，即非物理模态，被称为“沙漏”模态。\n\n**比较与最终答案**\n\n- 完全（$2 \\times 2$）积分的零特征值数量：3（对应于刚体模态）。\n- 减缩（$1 \\times 1$）积分的零特征值数量：5（对应于 3 个刚体模态和 2 个沙漏模态）。\n\n相对于 $2 \\times 2$ 积分法则，$1 \\times 1$ 积分法则引入的额外零特征值的数量是其差值：\n$$ 5 - 3 = 2 $$", "answer": "$$ \\boxed{2} $$", "id": "3585291"}]}