{"hands_on_practices": [{"introduction": "要真正掌握自然坐标中的形函数，最好的起点是研究最简单但又非平凡的情况：一维二次单元。这个练习将指导您使用拉格朗日多项式，从第一性原理出发构建这些形函数。通过确保形函数在节点上满足克罗内克-德尔塔($\\delta_{ij}$)性质，我们能确保插值场在节点处精确地等于节点值，这是有限元方法的核心要求。完成这个练习将为您打下坚实的基础，并让您熟悉验证单位分解(partition of unity)等关键性质的过程。", "problem": "在计算固体力学中，考虑一个一维二次等参有限元，其自然坐标为 $\\xi \\in [-1,1]$，节点位置在 $\\xi_{1}=-1$，$\\xi_{2}=0$ 和 $\\xi_{3}=1$。使用拉格朗日插值多项式的定义，构造形函数 $N_{1}(\\xi)$、$N_{2}(\\xi)$ 和 $N_{3}(\\xi)$，使其为次数最多为 2 的多项式，并满足克罗内克-德尔塔性质 $N_{i}(\\xi_{j})=\\delta_{ij}$。然后，对于任意节点值 $u_{1}$、$u_{2}$ 和 $u_{3}$，使用有限元插值定义 $u^{h}(\\xi)=\\sum_{i=1}^{3}N_{i}(\\xi)\\,u_{i}$，验证对于 $j\\in\\{1,2,3\\}$ 的节点插值性质 $u^{h}(\\xi_{j})=u_{j}$。\n\n最后，定义单位分解函数 $S(\\xi)=N_{1}(\\xi)+N_{2}(\\xi)+N_{3}(\\xi)$。请以最简形式给出 $S(\\xi)$ 作为最终答案。无需数值取整，也不涉及物理单位。请将最终答案表示为单一的闭式解析表达式。", "solution": "用户提供了一个计算固体力学领域的有效问题陈述。该问题具有科学依据，论述清晰且客观。我们将提供完整的解答。\n\n该问题要求为一维二次有限元构造形函数，验证插值性质，并计算这些形函数的和，即所谓的单位分解函数。\n\n该单元在自然坐标系 $\\xi \\in [-1, 1]$ 中定义，有三个节点，分别位于 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$。\n\n首先，我们使用拉格朗日插值多项式构造形函数 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$。对于一组 $n$ 个不同的点 $\\{\\xi_k\\}_{k=1}^n$，第 $i$ 个拉格朗日基多项式的一般形式由下式给出：\n$$L_i(\\xi) = \\prod_{j=1, j \\neq i}^{n} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$$\n形函数 $N_i(\\xi)$ 定义为在节点 $\\xi_i$ 处值为 $1$、在所有其他节点 $\\xi_j$（其中 $j \\neq i$）处值为 $0$ 的拉格朗日多项式。这与拉格朗日基多项式完全对应，即 $N_i(\\xi) = L_i(\\xi)$。对于我们的三节点单元（$n=3$），我们有：\n\n对于与节点 $\\xi_1=-1$ 相关的 $N_1(\\xi)$：\n$$N_1(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_1 - \\xi_2} \\cdot \\frac{\\xi - \\xi_3}{\\xi_1 - \\xi_3} = \\frac{\\xi - 0}{-1 - 0} \\cdot \\frac{\\xi - 1}{-1 - 1} = \\frac{\\xi}{-1} \\cdot \\frac{\\xi - 1}{-2} = \\frac{1}{2}\\xi(\\xi - 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$$\n\n对于与节点 $\\xi_2=0$ 相关的 $N_2(\\xi)$：\n$$N_2(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_2 - \\xi_1} \\cdot \\frac{\\xi - \\xi_3}{\\xi_2 - \\xi_3} = \\frac{\\xi - (-1)}{0 - (-1)} \\cdot \\frac{\\xi - 1}{0 - 1} = \\frac{\\xi + 1}{1} \\cdot \\frac{\\xi - 1}{-1} = -(\\xi+1)(\\xi-1) = -(\\xi^2 - 1) = 1 - \\xi^2$$\n\n对于与节点 $\\xi_3=1$ 相关的 $N_3(\\xi)$：\n$$N_3(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_3 - \\xi_1} \\cdot \\frac{\\xi - \\xi_2}{\\xi_3 - \\xi_2} = \\frac{\\xi - (-1)}{1 - (-1)} \\cdot \\frac{\\xi - 0}{1 - 0} = \\frac{\\xi + 1}{2} \\cdot \\frac{\\xi}{1} = \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$$\n\n根据构造，这些形函数满足克罗内克-德尔塔性质 $N_i(\\xi_j) = \\delta_{ij}$。\n\n接下来，我们验证有限元近似 $u^h(\\xi) = \\sum_{i=1}^{3} N_i(\\xi) u_i = N_1(\\xi)u_1 + N_2(\\xi)u_2 + N_3(\\xi)u_3$ 的节点插值性质。我们必须证明对于 $j \\in \\{1, 2, 3\\}$，有 $u^h(\\xi_j) = u_j$。\n\n对于 $j=1$（在节点 $\\xi_1 = -1$ 处）：\n$$u^h(\\xi_1) = N_1(\\xi_1)u_1 + N_2(\\xi_1)u_2 + N_3(\\xi_1)u_3$$\n使用克罗内克-德尔塔性质（$N_1(\\xi_1)=1$，$N_2(\\xi_1)=0$，$N_3(\\xi_1)=0$）：\n$$u^h(-1) = (1)u_1 + (0)u_2 + (0)u_3 = u_1$$\n\n对于 $j=2$（在节点 $\\xi_2 = 0$ 处）：\n$$u^h(\\xi_2) = N_1(\\xi_2)u_1 + N_2(\\xi_2)u_2 + N_3(\\xi_2)u_3$$\n使用克罗内克-德尔塔性质（$N_1(\\xi_2)=0$，$N_2(\\xi_2)=1$，$N_3(\\xi_2)=0$）：\n$$u^h(0) = (0)u_1 + (1)u_2 + (0)u_3 = u_2$$\n\n对于 $j=3$（在节点 $\\xi_3 = 1$ 处）：\n$$u^h(\\xi_3) = N_1(\\xi_3)u_1 + N_2(\\xi_3)u_2 + N_3(\\xi_3)u_3$$\n使用克罗内克-德尔塔性质（$N_1(\\xi_3)=0$，$N_2(\\xi_3)=0$，$N_3(\\xi_3)=1$）：\n$$u^h(1) = (0)u_1 + (0)u_2 + (1)u_3 = u_3$$\n因此，节点插值性质得到验证。\n\n最后，我们求单位分解函数 $S(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi)$ 的最简形式。我们将推导出的形函数相加：\n$$S(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(1 - \\xi^2\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)$$\n我们按 $\\xi$ 的幂次对各项进行分组：\n$$S(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\xi^2 + \\frac{1}{2}\\xi^2\\right) + \\left(-\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\right) + 1$$\n简化系数：\n$$S(\\xi) = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1$$\n$$S(\\xi) = (0)\\xi^2 + (0)\\xi + 1$$\n$$S(\\xi) = 1$$\n形函数之和对于所有 $\\xi \\in [-1, 1]$ 都等于 $1$。这就是单位分解性质，它确保了单元能够精确表示一个常数场。$S(\\xi)$ 的最简形式是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3599831"}, {"introduction": "在掌握了一维形函数之后，我们将把这些概念扩展到二维空间，并使用一种对于三角形单元特别优雅的坐标系——重心坐标。本练习将挑战您为一个六节点二次三角形单元(T6单元)推导形函数。您将不再仅仅依赖公式，而是通过识别每个形函数必须为零的“零线”来巧妙地构造它们，这是一种更深刻、更具几何直观性的方法。通过这个实践，您可以体会到不同坐标系如何简化不同几何形状的分析，并加深对二维插值原理的理解。", "problem": "考虑一个用于计算固体力学的有限元法（FEM）中的二维三角形等参有限元。设自然（重心）坐标用 $L_1$、$L_2$ 和 $L_3$ 表示，它们满足 $L_1 + L_2 + L_3 = 1$ 且在三角形内部 $L_i \\ge 0$，其中 $L_i$ 等于与顶点相关的面积坐标。一个六节点二次三角形（通常表示为 $T6$）的节点位于三个顶点和三条边的中点。在重心坐标系中，节点位置如下：\n- 顶点节点：$(L_1,L_2,L_3) = (1,0,0)$、$(0,1,0)$、$(0,0,1)$，\n- 边中点节点：$(L_1,L_2,L_3) = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$、$\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$、$\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$。\n\n从重心坐标的定义和在三角形上二次完备性的拉格朗日插值要求出发，推导与上述节点相关联的六个二次拉格朗日形函数 $\\{N_1,N_2,N_3,N_{12},N_{23},N_{31}\\}$ 的显式解析表达式。每个形函数必须是 $(L_1,L_2,L_3)$ 的总次数为二的多项式，必须满足对所有六个节点的克罗内克-δ 节点性质 $N_a(\\text{node }b) = \\delta_{ab}$，以及单位分解性质 $\\sum_{a} N_a = 1$。\n\n然后，通过在相应的节点重心坐标处计算每个形函数的值，来验证所有六个节点的节点插值属性。\n\n你的最终答案必须将六个推导出的形函数以重心坐标的闭合形式表达式，按照 $[N_1, N_2, N_3, N_{12}, N_{23}, N_{31}]$ 的顺序，表示为单个行向量。无需数值舍入，也不涉及任何单位。", "solution": "该问题已经过验证，具有科学依据、提法恰当且客观。这是有限元法（FEM）中关于推导特定单元类型的形函数的标准问题。所有必需的数据和条件均已提供，且没有矛盾。我们可以继续进行解答。\n\n目标是推导六节点二次三角形的六个二次拉格朗日形函数 $\\{N_1, N_2, N_3, N_{12}, N_{23}, N_{31}\\}$。推导将基于克罗内克-δ 性质，即形函数 $N_a$ 在其对应的节点 $a$ 处必须为 1，而在所有其他节点处必须为 0。形函数被要求是重心坐标 $L_1$、$L_2$ 和 $L_3$ 的总次数为二的多项式。\n\nT6 单元的六个节点位于以下重心坐标 $(L_1, L_2, L_3)$ 处：\n- 节点 1（顶点）：$(1,0,0)$\n- 节点 2（顶点）：$(0,1,0)$\n- 节点 3（顶点）：$(0,0,1)$\n- 节点 12（边中点）：$(\\frac{1}{2},\\frac{1}{2},0)$\n- 节点 23（边中点）：$(0,\\frac{1}{2},\\frac{1}{2})$\n- 节点 31（边中点）：$(\\frac{1}{2},0,\\frac{1}{2})$\n\n构建拉格朗日多项式的一个有效方法是从其零点开始。形函数 $N_a$ 在所有节点 $b \\neq a$ 处必须为零。\n\n**1. 顶点节点形函数 ($N_1, N_2, N_3$) 的推导**\n\n让我们推导与顶点节点 1 相关联的形函数 $N_1$。根据克罗内克-δ 性质，$N_1$ 在节点 1 处必须为 $1$，在节点 2、3、12、23 和 31 处必须为 $0$。\n\n$N_1$ 必须为零的节点位置是：\n- 节点 2: $(0,1,0)$\n- 节点 3: $(0,0,1)$\n- 节点 23: $(0,\\frac{1}{2},\\frac{1}{2})$\n\n这三个节点都位于由方程 $L_1 = 0$ 定义的直线上。因此，$N_1$ 的多项式必须包含因子 $L_1$。\n\n$N_1$ 必须为零的其余节点是：\n- 节点 12: $(\\frac{1}{2},\\frac{1}{2},0)$\n- 节点 31: $(\\frac{1}{2},0,\\frac{1}{2})$\n\n这两个节点都位于由方程 $L_1 = \\frac{1}{2}$（可写为 $L_1 - \\frac{1}{2} = 0$）定义的直线上。因此，$N_1$ 也必须包含因子 $(L_1 - \\frac{1}{2})$。\n\n结合这些因子，我们可以提出 $N_1$ 的形式，作为这两个线性因子的乘积：\n$$N_1(L_1, L_2, L_3) = C \\cdot L_1 \\left(L_1 - \\frac{1}{2}\\right)$$\n该表达式是 $L_1$ 的二次多项式，并且根据构造，它在五个所需节点处为零。常数 $C$ 通过施加条件 $N_1=1$ 于节点 1（其中 $(L_1, L_2, L_3) = (1,0,0)$）来确定。\n$$N_1(1,0,0) = C \\cdot 1 \\left(1 - \\frac{1}{2}\\right) = C \\cdot \\frac{1}{2} = 1$$\n解出 $C$ 得 $C=2$。将其代回 $N_1$ 的表达式中：\n$$N_1 = 2 \\cdot L_1 \\left(L_1 - \\frac{1}{2}\\right) = L_1 (2L_1 - 1)$$\n根据对称性，其他两个顶点节点 $N_2$ 和 $N_3$ 的形函数可以直接写出：\n$$N_2 = L_2 (2L_2 - 1)$$\n$$N_3 = L_3 (2L_3 - 1)$$\n\n**2. 边中点节点形函数 ($N_{12}, N_{23}, N_{31}$) 的推导**\n\n接下来，让我们推导顶点 1 和 2 之间的边中点节点的形函数 $N_{12}$。$N_{12}$ 在节点 12 处必须为 $1$，在所有其他节点处必须为 $0$。\n\n$N_{12}$ 必须为零的节点是 1、2、3、23 和 31。\n- 节点 2、3 和 23 位于直线 $L_1 = 0$ 上。\n- 节点 1、3 和 31 位于直线 $L_2 = 0$ 上。\n\n为使 $N_{12}$ 在所有这些点上都为零，其多项式表示必须包含因子 $L_1$ 和 $L_2$。我们提出以下形式：\n$$N_{12}(L_1, L_2, L_3) = C \\cdot L_1 L_2$$\n该表达式是一个二次多项式。它在直线 $L_1=0$（边 2-3）和直线 $L_2=0$（边 1-3）上为零，因此在节点 1、2、3、23 和 31 处的计算结果正确地为零。常数 $C$ 由条件 $N_{12}=1$ 于节点 12（其中 $(L_1, L_2, L_3) = (\\frac{1}{2},\\frac{1}{2},0)$）确定。\n$$N_{12}\\left(\\frac{1}{2},\\frac{1}{2},0\\right) = C \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = C \\cdot \\frac{1}{4} = 1$$\n这得到 $C=4$。该形函数为：\n$$N_{12} = 4 L_1 L_2$$\n根据对称性，其他边中点节点 $N_{23}$ 和 $N_{31}$ 的形函数为：\n$$N_{23} = 4 L_2 L_3$$\n$$N_{31} = 4 L_3 L_1$$\n\n**3. 节点性质和单位分解的验证**\n\n推导出的形函数为：\n$N_1 = L_1(2L_1 - 1)$\n$N_2 = L_2(2L_2 - 1)$\n$N_3 = L_3(2L_3 - 1)$\n$N_{12} = 4 L_1 L_2$\n$N_{23} = 4 L_2 L_3$\n$N_{31} = 4 L_3 L_1$\n\n**克罗内克-δ 性质验证：** 让我们以 $N_1$ 和 $N_{12}$ 为例进行验证。\n对于 $N_1 = L_1(2L_1-1)$:\n- 在节点 1 $(1,0,0)$: $N_1 = 1(2(1)-1) = 1$。\n- 在节点 2 $(0,1,0)$: $N_1 = 0(2(0)-1) = 0$。\n- 在节点 3 $(0,0,1)$: $N_1 = 0(2(0)-1) = 0$。\n- 在节点 12 $(\\frac{1}{2},\\frac{1}{2},0)$: $N_1 = \\frac{1}{2}(2(\\frac{1}{2})-1) = 0$。\n- 在节点 23 $(0,\\frac{1}{2},\\frac{1}{2})$: $N_1 = 0(2(0)-1) = 0$。\n- 在节点 31 $(\\frac{1}{2},0,\\frac{1}{2})$: $N_1 = \\frac{1}{2}(2(\\frac{1}{2})-1) = 0$。\n性质对 $N_1$ 成立。根据对称性，它也对 $N_2$ 和 $N_3$ 成立。\n\n对于 $N_{12} = 4L_1L_2$:\n- 在节点 1 $(1,0,0)$: $N_{12} = 4(1)(0) = 0$。\n- 在节点 2 $(0,1,0)$: $N_{12} = 4(0)(1) = 0$。\n- 在节点 3 $(0,0,1)$: $N_{12} = 4(0)(0) = 0$。\n- 在节点 12 $(\\frac{1}{2},\\frac{1}{2},0)$: $N_{12} = 4(\\frac{1}{2})(\\frac{1}{2}) = 1$。\n- 在节点 23 $(0,\\frac{1}{2},\\frac{1}{2})$: $N_{12} = 4(0)(\\frac{1}{2}) = 0$。\n- 在节点 31 $(\\frac{1}{2},0,\\frac{1}{2})$: $N_{12} = 4(\\frac{1}{2})(0) = 0$。\n性质对 $N_{12}$ 成立。根据对称性，它也对 $N_{23}$ 和 $N_{31}$ 成立。\n\n**单位分解验证：** 我们必须检查是否 $\\sum_{a} N_a = 1$。\n$$ \\sum_{a} N_a = N_1 + N_2 + N_3 + N_{12} + N_{23} + N_{31} $$\n$$ \\sum_{a} N_a = L_1(2L_1-1) + L_2(2L_2-1) + L_3(2L_3-1) + 4L_1L_2 + 4L_2L_3 + 4L_3L_1 $$\n$$ \\sum_{a} N_a = (2L_1^2 - L_1) + (2L_2^2 - L_2) + (2L_3^2 - L_3) + 4L_1L_2 + 4L_2L_3 + 4L_3L_1 $$\n让我们重新排列各项：\n$$ \\sum_{a} N_a = (2L_1^2 + 2L_2^2 + 2L_3^2 + 4L_1L_2 + 4L_2L_3 + 4L_3L_1) - (L_1 + L_2 + L_3) $$\n我们可以从第一个括号中提出因子 2：\n$$ \\sum_{a} N_a = 2(L_1^2 + L_2^2 + L_3^2 + 2L_1L_2 + 2L_2L_3 + 2L_3L_1) - (L_1 + L_2 + L_3) $$\n认识到第一项是 $2(L_1+L_2+L_3)^2$ 的展开式：\n$$ \\sum_{a} N_a = 2(L_1+L_2+L_3)^2 - (L_1+L_2+L_3) $$\n利用重心坐标的基本性质 $L_1+L_2+L_3 = 1$：\n$$ \\sum_{a} N_a = 2(1)^2 - 1 = 2-1 = 1 $$\n单位分解性质得到满足。所有推导出的函数都是正确的。\n\n最终答案是按指定顺序排列的六个形函数的集合。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nL_1(2L_1 - 1)  L_2(2L_2 - 1)  L_3(2L_3 - 1)  4L_1L_2  4L_2L_3  4L_3L_1\n\\end{pmatrix}\n}\n$$", "id": "3599866"}, {"introduction": "构建形函数本身并非最终目的，它们的性质直接决定了有限元分析的实际计算过程。本练习将理论与实践联系起来，探讨形函数的数学形式如何决定计算单元刚度矩阵所需的数值积分方案。您将分析一个四节点四边形(Q4)单元的刚度矩阵被积函数$B^T C B$的多项式次数，并依此确定为保证精确积分所需的最小高斯积分点数。这项实践揭示了形函数理论与有限元方法数值效率和准确性之间的深刻联系，解释了为什么我们必须关注这些基础函数的数学细节。", "problem": "考虑一个二维线性弹性问题中的等参四节点双线性四边形（Q4）有限元，其本构矩阵 $C$ 为常数，且从参考正方形 $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ 到物理单元 $\\Omega_{e}$ 的映射为仿射映射。仿射映射的假设意味着雅可比行列式 $J$ 是一个正的常数，且雅可比矩阵 $J$ 与 $(\\xi,\\eta)$ 无关。令标准的双线性形函数为 $N_{1}(\\xi,\\eta)$、$N_{2}(\\xi,\\eta)$、$N_{3}(\\xi,\\eta)$ 和 $N_{4}(\\xi,\\eta)$，令应变-位移矩阵 $B(\\xi,\\eta)$ 由空间导数 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$ 定义，这些空间导数是通过链式法则从自然导数 $\\partial N_{i}/\\partial \\xi$ 和 $\\partial N_{i}/\\partial \\eta$ 得到的。\n\n从等参公式和参考域上双线性形函数定义的基本原理出发，确定单元刚度积分\n$$\n\\int_{\\Omega_{e}} B^{T} C B\\, d\\Omega,\n$$\n的被积函数中关于 $(\\xi,\\eta)$ 的最高多项式次数，当通过映射将其表示在自然坐标系中时（因此，在自然坐标系中的被积函数为 $B^{T} C B\\, J$）。然后，推导出精确积分这个二元多项式所需的最小张量积高斯-勒让德求积法则（每个自然坐标方向上的点数）。\n\n请以一个行矩阵的形式提供你的最终答案，其中包含三个条目：多项式次数、以及在 $\\xi$ 和 $\\eta$ 方向上所需的最小高斯点数，按此顺序排列。无需进行数值舍入。", "solution": "问题要求在给定仿射映射的情况下，求出等参四节点双线性四边形单元的单元刚度矩阵被积函数的最高多项式次数，以及精确积分该函数所需的最小高斯-勒让德求积法则。解答将从基本原理推导得出。\n\n令自然坐标为 $(\\xi, \\eta)$，其中 $-1 \\le \\xi \\le 1$ 且 $-1 \\le \\eta \\le 1$。四个节点的双线性形函数 $N_i(\\xi, \\eta)$ 由下式给出：\n$$\n\\begin{aligned}\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n这些函数是双线性的，意味着它们在每个坐标变量上分别是线性的。\n\n第一步是计算形函数相对于自然坐标的导数。以 $N_1$ 为例：\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(-1 + \\eta)\n$$\n$$\n\\frac{\\partial N_{1}}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(-1 + \\xi)\n$$\n通过检查所有四个形函数，我们发现一个普遍规律：$\\frac{\\partial N_{i}}{\\partial \\xi}$ 仅是 $\\eta$ 的线性函数，而 $\\frac{\\partial N_{i}}{\\partial \\eta}$ 仅是 $\\xi$ 的线性函数。因此，这些导数在一个自然坐标上是1次多项式，在另一个自然坐标上是0次多项式。\n\n物理坐标导数 $(\\partial/\\partial x, \\partial/\\partial y)$ 与自然坐标导数 $(\\partial/\\partial \\xi, \\partial/\\partial \\eta)$ 之间的关系由坐标变换的雅可比矩阵 $\\mathbf{J}$ 给出。\n$$\n\\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\mathbf{J} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix}, \\quad \\text{其中} \\quad \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n问题指出，从参考单元到物理单元的映射是仿射的。仿射映射的一个关键特性是其雅可比矩阵 $\\mathbf{J}$ 是常数（与位置 $(\\xi, \\eta)$ 无关）。因此，逆雅可比矩阵 $\\mathbf{J}^{-1}$ 和雅可比行列式 $J = \\det(\\mathbf{J})$ 也都是常数。\n\n形函数的空间导数通过逆关系得到：\n$$\n\\begin{pmatrix} \\frac{\\partial N_{i}}{\\partial x} \\\\ \\frac{\\partial N_{i}}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_{i}}{\\partial \\xi} \\\\ \\frac{\\partial N_{i}}{\\partial \\eta} \\end{pmatrix}\n$$\n设逆雅可比矩阵的常数项为 $J^{-1}_{kl}$。则我们有：\n$$\n\\frac{\\partial N_{i}}{\\partial x} = J^{-1}_{11} \\frac{\\partial N_{i}}{\\partial \\xi} + J^{-1}_{12} \\frac{\\partial N_{i}}{\\partial \\eta}\n$$\n$$\n\\frac{\\partial N_{i}}{\\partial y} = J^{-1}_{21} \\frac{\\partial N_{i}}{\\partial \\xi} + J^{-1}_{22} \\frac{\\partial N_{i}}{\\partial \\eta}\n$$\n由于 $\\frac{\\partial N_{i}}{\\partial \\xi}$ 是关于 $\\eta$ 的 1 次多项式，$\\frac{\\partial N_{i}}{\\partial \\eta}$ 是关于 $\\xi$ 的 1 次多项式，且 $J^{-1}_{kl}$ 是常数，因此空间导数 $\\frac{\\partial N_{i}}{\\partial x}$ 和 $\\frac{\\partial N_{i}}{\\partial y}$ 是一个 $\\xi$ 的函数和一个 $\\eta$ 的函数的线性组合。具体来说，每个空间导数都是形如 $a\\xi + b\\eta + c$ 的一般线性多项式。\n\n应变-位移矩阵 $B$ 将应变向量 $\\boldsymbol{\\epsilon} = \\{\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}\\}^T$ 与节点位移向量 $\\mathbf{d}$ 联系起来。对于一个二维问题，它是一个 $3 \\times 8$ 矩阵，其元素由形函数的空间导数构成。一个典型的结构是：\n$$\nB(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\dots  \\frac{\\partial N_4}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_1}{\\partial y}  \\dots  0  \\frac{\\partial N_4}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x}  \\dots  \\frac{\\partial N_4}{\\partial y}  \\frac{\\partial N_4}{\\partial x}\n\\end{pmatrix}\n$$\n由于每个元素 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$ 都是关于 $(\\xi, \\eta)$ 的 1 次多项式，因此矩阵 $B(\\xi,\\eta)$ 的每个非零元素都是关于 $(\\xi, \\eta)$ 的 1 次多项式。\n\n在自然坐标系中的单元刚度积分为 $\\int_{-1}^{1} \\int_{-1}^{1} B^{T} C B\\, J \\,d\\xi\\,d\\eta$。被积函数是矩阵乘积 $B^{T} C B J$。\n- $B$ 是一个 $3 \\times 8$ 矩阵，其元素是最高次数为 1 的多项式。\n- $C$ 是一个常数 $3 \\times 3$ 矩阵。\n- $J$ 是一个常数标量。\n乘积 $B^T C B$ 得到一个 $8 \\times 8$ 矩阵。该矩阵的任意元素是来自 $B$ 的元素和来自 $C$ 的常数乘积之和。此和中的一个典型项形如 $(\\text{B的元素}) \\times (\\text{常数}) \\times (\\text{B的元素})$。由于 $B$ 的每个元素都是关于 $\\xi$ 和 $\\eta$ 的线性多项式，它们的乘积是一个二次多项式。例如，$(a_1\\xi + b_1\\eta + c_1)(a_2\\xi + b_2\\eta + c_2)$ 会产生最高为 $\\xi^2$、$\\eta^2$ 和 $\\xi\\eta$ 的项。\n因此，矩阵 $B^T C B$ 的每个元素都是一个总次数最高为 2 的二元多项式。$\\xi$ 的最高次幂是 2，$\\eta$ 的最高次幂是 2。由于 $J$ 是一个常数，被积函数 $B^T C B J$ 是一个矩阵，其元素是总次数为 2 的多项式。问题将被积函数视为一个标量，这可以解释为积分前所得单元刚度矩阵的任意一个元素。例如，待积分矩阵的第 $(i,j)$ 个元素是一个总次数为 2 的多项式。关于 $(\\xi,\\eta)$ 的最高多项式次数为 2。\n\n接下来，我们确定用于精确积分的最小高斯-勒让德求积法则。一个 $n$ 点高斯-勒让德法则可以精确积分最高次数为 $2n-1$ 的多项式。对于正方形域上的张量积法则，我们独立考虑每个方向。\n为了对 $\\xi$ 进行积分，我们必须处理 $\\xi$ 的最高多项式次数。如前所述，对于任意固定的 $\\eta$，被积函数是关于 $\\xi$ 的 2 次多项式。令 $p_\\xi$ 为 $\\xi$ 的次数，所以 $p_\\xi = 2$。我们需要找到满足以下条件的最小整数 $n_\\xi$：\n$$\n2n_{\\xi} - 1 \\ge p_\\xi = 2\n$$\n$$\n2n_{\\xi} \\ge 3 \\implies n_{\\xi} \\ge 1.5\n$$\n满足此条件的最小整数是 $n_{\\xi} = 2$。\n\n类似地，对于任意固定的 $\\xi$，被积函数是关于 $\\eta$ 的 2 次多项式。令 $p_\\eta = 2$。我们需要找到满足以下条件的最小整数 $n_\\eta$：\n$$\n2n_{\\eta} - 1 \\ge p_\\eta = 2\n$$\n$$\n2n_{\\eta} \\ge 3 \\implies n_{\\eta} \\ge 1.5\n$$\n满足此条件的最小整数是 $n_{\\eta} = 2$。\n\n因此，精确积分刚度矩阵所需的最小张量积高斯-勒让德求积法则是 $2 \\times 2$ 法则，即在 $\\xi$ 方向上有 2 个点，在 $\\eta$ 方向上有 2 个点。\n\n所要求的三个值是：\n1.  被积函数的最高多项式次数：$2$。\n2.  $\\xi$ 方向上所需的最小高斯点数：$2$。\n3.  $\\eta$ 方向上所需的最小高斯点数：$2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  2  2\n\\end{pmatrix}\n}\n$$", "id": "3599878"}]}