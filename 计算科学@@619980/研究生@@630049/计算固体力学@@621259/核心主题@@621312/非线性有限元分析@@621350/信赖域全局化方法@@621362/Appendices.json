{"hands_on_practices": [{"introduction": "本练习通过一个物理系统——超弹性杆——将理论与实践联系起来。你将从第一性原理推导出控制非线性方程，然后计算信赖域方法的两个基本构成要素：理想化的 Gauss-Newton 步和保守的 Cauchy 步。这项实践旨在巩固连续介质力学模型与数值求解算法核心组件之间的联系 [@problem_id:3608056]。", "problem": "考虑一根长为 $L$、横截面积恒为 $A$ 的直棱柱双节点杆，由一维超弹性材料制成，其柯西应力-应变定律为 $\\sigma(\\epsilon) = E \\left(1 + \\alpha \\epsilon \\right)\\epsilon$。假设小应变运动学，轴向应变为 $\\epsilon = u/L$，其中 $u$ 是右节点的轴向位移；左节点是固定的。通过在右节点处增加一个关于规定位移 $\\bar{u}$、刚度为 $k_{p}$ 的二次罚势来弱施加位移控制，因此右节点的平衡由总势能的驻定性得出。设材料和几何参数为 $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 100$，$A = 1.00 \\times 10^{-4}\\,\\mathrm{m}^{2}$，$L = 1.00\\,\\mathrm{m}$。位移控制参数为 $k_{p} = 5.00 \\times 10^{7}\\,\\mathrm{N/m}$ 和 $\\bar{u} = 4.00 \\times 10^{-3}\\,\\mathrm{m}$。考虑一个试算位形 $u^{(k)} = 3.00 \\times 10^{-3}\\,\\mathrm{m}$。\n\n使用小应变运动学、超弹性本构响应和虚功原理的基本原理，为消去左节点的简化系统建立标量非线性残差 $F(u)$ 及其雅可比矩阵 $J(u) = \\mathrm{d}F/\\mathrm{d}u$。数值计算 $F\\!\\left(u^{(k)}\\right)$ 和 $J\\!\\left(u^{(k)}\\right)$。\n\n在半径为 $\\Delta = 2.50 \\times 10^{-4}\\,\\mathrm{m}$ 的信赖域框架内，将非线性方程 $F(u) = 0$ 视为一个非线性最小二乘问题 $\\min_{s} \\tfrac{1}{2}\\|F\\!\\left(u^{(k)}\\right) + J\\!\\left(u^{(k)}\\right) s\\|^{2}$。计算：\n- 沿最速下降方向最小化二次模型且满足半径为 $\\Delta$ 的信赖域约束的柯西步 $s_{\\mathrm{C}}$，以及\n- 高斯-牛顿步 $s_{\\mathrm{GN}}$。\n\n以米为单位表示这两个步长。将您的答案四舍五入到四位有效数字。以单行矩阵 $\\begin{pmatrix} s_{\\mathrm{C}}  s_{\\mathrm{GN}} \\end{pmatrix}$ 的形式提供最终答案。", "solution": "用户希望我解决这个问题。\n根据初步验证过程，该问题被认为是有效的。所有提供的数据在科学上是一致的，并且该问题在计算固体力学和数值优化的背景下是适定的。\n\n求解过程分为以下几个步骤：\n1.  推导系统的总势能。\n2.  从势能推导非线性残差力向量和雅可比矩阵（切线刚度）。\n3.  在给定的试算位移下对残差和雅可比矩阵进行数值评估。\n4.  在信赖域框架内计算高斯-牛顿步和柯西步。\n\n**1. 总势能**\n系统的总势能 $\\Pi$ 是杆中储存的内部应变能 $W_{\\mathrm{int}}$ 和外部加载系统（在本例中是一个罚弹簧）的势能 $W_{\\mathrm{ext}}$ 之和。\n$$\n\\Pi(u) = W_{\\mathrm{int}}(u) + W_{\\mathrm{ext}}(u)\n$$\n应变 $\\epsilon$ 在整个杆上是均匀的，由小应变运动学关系 $\\epsilon = u/L$ 给出，其中 $u$ 是右节点的轴向位移，$L=1.00\\,\\mathrm{m}$ 是杆的长度。\n\n内部应变能 $W_{\\mathrm{int}}$ 是应变能密度 $\\psi(\\epsilon)$ 在杆的体积 $V = AL$ 上的积分。应变能密度通过对给定的一维柯西应力-应变定律 $\\sigma(\\epsilon) = E(1 + \\alpha \\epsilon)\\epsilon$ 积分得到：\n$$\n\\psi(\\epsilon) = \\int_0^\\epsilon \\sigma(\\tilde{\\epsilon}) \\, \\mathrm{d}\\tilde{\\epsilon} = \\int_0^\\epsilon E(\\tilde{\\epsilon} + \\alpha \\tilde{\\epsilon}^2) \\, \\mathrm{d}\\tilde{\\epsilon} = \\frac{1}{2} E \\epsilon^2 + \\frac{1}{3} E \\alpha \\epsilon^3\n$$\n于是，总内部应变能为：\n$$\nW_{\\mathrm{int}}(u) = V \\cdot \\psi(\\epsilon(u)) = AL \\left( \\frac{1}{2} E \\left(\\frac{u}{L}\\right)^2 + \\frac{1}{3} E \\alpha \\left(\\frac{u}{L}\\right)^3 \\right) = \\frac{AE}{2L} u^2 + \\frac{AE\\alpha}{3L^2} u^3\n$$\n外部势能 $W_{\\mathrm{ext}}$ 来自二次罚项，该项强制位移 $u$ 接近规定值 $\\bar{u}$：\n$$\nW_{\\mathrm{ext}}(u) = \\frac{1}{2} k_p (u - \\bar{u})^2\n$$\n将这些组合起来，得到单自由度系统的总势能：\n$$\n\\Pi(u) = \\frac{AE}{2L} u^2 + \\frac{AE\\alpha}{3L^2} u^3 + \\frac{1}{2} k_p (u - \\bar{u})^2\n$$\n\n**2. 残差和雅可比矩阵**\n在势能的驻点处达到平衡，即势能对广义坐标 $u$ 的一阶导数为零。非线性残差 $F(u)$ 定义为该导数，代表节点上的不平衡力。\n$$\nF(u) = \\frac{\\mathrm{d}\\Pi}{\\mathrm{d}u} = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left( \\frac{AE}{2L} u^2 + \\frac{AE\\alpha}{3L^2} u^3 + \\frac{1}{2} k_p (u - \\bar{u})^2 \\right) = \\frac{AE}{L} u + \\frac{AE\\alpha}{L^2} u^2 + k_p(u-\\bar{u})\n$$\n雅可比矩阵 $J(u)$ 是残差对 $u$ 的导数，对应于系统在位移 $u$ 处的切线刚度。\n$$\nJ(u) = \\frac{\\mathrm{d}F}{\\mathrm{d}u} = \\frac{AE}{L} + \\frac{2AE\\alpha}{L^2} u + k_p\n$$\n\n**3. 数值评估**\n我们有以下给定参数：\n$E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 100$，$A = 1.00 \\times 10^{-4}\\,\\mathrm{m}^{2}$，$L = 1.00\\,\\mathrm{m}$。\n$k_p = 5.00 \\times 10^{7}\\,\\mathrm{N/m}$，$\\bar{u} = 4.00 \\times 10^{-3}\\,\\mathrm{m}$。\n试算位形为 $u^{(k)} = 3.00 \\times 10^{-3}\\,\\mathrm{m}$。\n\n首先，我们计算 $F(u)$ 和 $J(u)$ 的系数：\n$$\n\\frac{AE}{L} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{m}^2)(2.10 \\times 10^{11}\\,\\mathrm{Pa})}{1.00\\,\\mathrm{m}} = 2.10 \\times 10^7\\,\\mathrm{N/m}\n$$\n$$\n\\frac{AE\\alpha}{L^2} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{m}^2)(2.10 \\times 10^{11}\\,\\mathrm{Pa})(100)}{(1.00\\,\\mathrm{m})^2} = 2.10 \\times 10^9\\,\\mathrm{N/m^2}\n$$\n现在，我们在 $u_k = u^{(k)} = 3.00 \\times 10^{-3}\\,\\mathrm{m}$ 处评估残差 $F_k = F(u^{(k)})$：\n$$\nF_k = (2.10 \\times 10^7) (3.00 \\times 10^{-3}) + (2.10 \\times 10^9) (3.00 \\times 10^{-3})^2 + (5.00 \\times 10^7)(3.00 \\times 10^{-3} - 4.00 \\times 10^{-3})\n$$\n$$\nF_k = 6.30 \\times 10^4 + (2.10 \\times 10^9) (9.00 \\times 10^{-6}) + (5.00 \\times 10^7)(-1.00 \\times 10^{-3})\n$$\n$$\nF_k = 63000 + 18900 - 50000 = 31900\\,\\mathrm{N}\n$$\n接下来，我们评估雅可比矩阵 $J_k = J(u^{(k)})$：\n$$\nJ_k = (2.10 \\times 10^7) + 2(2.10 \\times 10^9)(3.00 \\times 10^{-3}) + (5.00 \\times 10^7)\n$$\n$$\nJ_k = 2.10 \\times 10^7 + 1.26 \\times 10^7 + 5.00 \\times 10^7 = 8.36 \\times 10^7\\,\\mathrm{N/m}\n$$\n\n**4. 信赖域步长计算**\n信赖域子问题涉及最小化 $\\frac{1}{2}\\|F(u)\\|^2$ 的二次模型，对于单变量，这即是 $\\frac{1}{2} F(u)^2$。问题陈述提供了要最小化的线性化最小二乘模型：\n$$\n\\min_{s} \\phi(s) = \\frac{1}{2} (F_k + J_k s)^2 \\quad \\text{约束条件为} \\quad |s| \\le \\Delta\n$$\n其中 $\\Delta = 2.50 \\times 10^{-4}\\,\\mathrm{m}$ 是信赖域半径。\n\n**高斯-牛顿步 ($s_{\\mathrm{GN}}$)**\n高斯-牛顿步是二次模型 $\\phi(s)$ 的无约束最小化子。我们通过将导数 $\\phi'(s)$ 设置为零来找到它：\n$$\n\\phi'(s) = (F_k + J_k s) J_k = 0 \\implies s_{\\mathrm{GN}} = -\\frac{F_k}{J_k}\n$$\n代入数值：\n$$\ns_{\\mathrm{GN}} = -\\frac{31900\\,\\mathrm{N}}{8.36 \\times 10^7\\,\\mathrm{N/m}} = -3.815789... \\times 10^{-4}\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，$s_{\\mathrm{GN}} = -3.816 \\times 10^{-4}\\,\\mathrm{m}$。\n\n**柯西步 ($s_{\\mathrm{C}}$)**\n柯西步是在最速下降方向上最小化二次模型，并受限于信赖域约束。对于一维问题，最速下降方向与牛顿方向一致。其过程是首先沿着最速下降射线找到无约束最小值，即 $s_{\\mathrm{GN}}$。然后，我们应用信赖域约束。\n我们将高斯-牛顿步的大小与信赖域半径 $\\Delta$ 进行比较：\n$$\n|s_{\\mathrm{GN}}| \\approx 3.816 \\times 10^{-4}\\,\\mathrm{m} \\quad \\text{和} \\quad \\Delta = 2.50 \\times 10^{-4}\\,\\mathrm{m}\n$$\n由于 $|s_{\\mathrm{GN}}| > \\Delta$，无约束最小化子位于信赖域之外。二次模型是凸的 ($J_k^2 > 0$)，因此其在信赖域内的最小值必须位于边界上。因此，柯西步是在最速下降方向（即 $s_{\\mathrm{GN}}$ 的方向）上长度为 $\\Delta$ 的步长。\n$$\ns_{\\mathrm{C}} = \\Delta \\cdot \\mathrm{sgn}(s_{\\mathrm{GN}}) = (2.50 \\times 10^{-4}\\,\\mathrm{m}) \\cdot \\mathrm{sgn}(-3.816 \\times 10^{-4}) = -2.50 \\times 10^{-4}\\,\\mathrm{m}\n$$\n四舍五入到四位有效数字，$s_{\\mathrm{C}} = -2.500 \\times 10^{-4}\\,\\mathrm{m}$。\n\n最终答案要求以米为单位给出步长 $s_{\\mathrm{C}}$ 和 $s_{\\mathrm{GN}}$，四舍五入到四位有效数字，并以行矩阵的形式呈现。\n\n$s_{\\mathrm{C}} = -2.500 \\times 10^{-4}\\,\\mathrm{m}$\n$s_{\\mathrm{GN}} = -3.816 \\times 10^{-4}\\,\\mathrm{m}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -2.500 \\times 10^{-4}  -3.816 \\times 10^{-4} \\end{pmatrix}}\n$$", "id": "3608056"}, {"introduction": "在确定了 Cauchy 步（一个安全的、保证下降的方向）和 Newton 步（我们模型的无约束最优点）之后，一个关键问题随之而来：我们如何最好地组合它们以形成一个试探步？狗腿法 (dogleg method) 通过在这两点之间构建一条路径，提供了一个优雅而高效的答案。此问题旨在让你理解其决策逻辑，即如何根据信赖域的大小来决定最终步长在该路径上的位置 [@problem_id:3608044]。", "problem": "考虑一个计算固体力学中的非线性、准静态有限元平衡问题，其中当前迭代 $u_k$ 处的离散平衡是通过将残差向量 $r(u_k)$ 驱动至零来实现的。为了全局化 Newton 方法，使用了一个信赖域框架，其二次模型为 $$m_k(p) = f(u_k) + g_k^\\top p + \\tfrac{1}{2}\\, p^\\top B_k\\, p,$$ 其中 $f$ 是一个可微的价值函数（例如，势能或残差平方价值函数），$g_k = \\nabla f(u_k)$ 是该价值函数的梯度，而 $B_k$ 是 $f$ 的 Hessian 矩阵的一个对称正定（SPD）近似（例如，一致切线刚度或 Gauss–Newton Hessian）。信赖域子问题旨在求解 $$\\min_{p \\in \\mathbb{R}^n} \\; m_k(p) \\quad \\text{subject to} \\quad \\|p\\|_2 \\le \\Delta_k,$$ 其中 $\\|\\cdot\\|_2$ 是欧几里得范数，$\\Delta_k > 0$ 是第 $k$ 次迭代时的信赖域半径。\n\ndogleg 方法通过 Cauchy 步 $p_C$ 构建了一条从原点到 Newton 步 $p_N$ 的分段线性路径。Newton 步 $p_N$ 由线性系统 $$B_k\\, p_N = -\\, g_k,$$ 的解定义，而 Cauchy 步 $p_C$ 定义为 $m_k(p)$ 沿着最速下降射线 $p(\\tau) = -\\, \\tau\\, g_k$ 在约束 $\\|p\\|_2 \\le \\Delta_k$ 下的最小化子，即 $$p_C = -\\, \\tau^\\star\\, g_k, \\quad \\tau^\\star \\in \\arg\\min_{\\tau \\ge 0,\\; \\tau \\|g_k\\|_2 \\le \\Delta_k}\\; m_k(-\\,\\tau\\, g_k).$$ dogleg 路径是从 $0$ 到 $p_C$ 的线段与从 $p_C$ 到 $p_N$ 的线段的并集，而 dogleg 步 $p_{\\text{DL}}$ 是沿着这条路径选择的，以满足信赖域约束。\n\n从这些定义以及以下基本事实出发：(i) SPD 的 $B_k$ 意味着 $m_k(\\cdot)$ 是严格凸的，其无约束最小化子是 $p_N$；(ii) Cauchy 步 $p_C$ 位于射线 $-g_k$ 上，并且要么与无约束线搜索的最小化子重合，要么是其在信赖域边界处的截断。推导 dogleg 步的决策逻辑，并确定在何种条件下 dogleg 步等于 $p_N$、等于 $p_C$，或者位于 dogleg 路径的第二段上并经过缩放以满足 $\\|p\\|_2 = \\Delta_k$。\n\n选择所有正确的陈述。\n\nA. 如果 $\\|p_N\\|_2 \\le \\Delta_k$，则 $p_{\\text{DL}} = p_N$。\n\nB. 如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2 = \\Delta_k$，则 $p_{\\text{DL}} = p_C$。\n\nC. 如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2  \\Delta_k$，则 $p_{\\text{DL}}$ 位于线段 $\\{\\, p_C + \\theta\\, (p_N - p_C) : \\theta \\in (0,1)\\,\\}$ 上，其唯一的 $\\theta$ 值使得 $\\|p_C + \\theta\\, (p_N - p_C)\\|_2 = \\Delta_k$。\n\nD. 如果 $\\|p_N\\|_2 \\le \\Delta_k$ 但 $g_k^\\top p_N > 0$，则 $p_{\\text{DL}} = p_C$，因为 Newton 步对于 $m_k(\\cdot)$ 是一个上升方向。\n\nE. 如果 $B_k$ 是不定的，则对于所有 $\\Delta_k > 0$，$p_{\\text{DL}} = p_C$，因为在固体力学的非凸情况下，dogleg 方法会避免使用 Newton 步。\n\n选择在此计算固体力学的信赖域全局化设置中，正确描述 dogleg 步分类的选项。", "solution": "问题陈述描述了一种在计算固体力学背景下，用于全局化类 Newton 迭代的标准 dogleg 信赖域方法。该问题是适定的、有科学依据的、且内部一致的。所提供的二次模型 $m_k(p)$、Newton 步 $p_N$ 和 Cauchy 步 $p_C$ 的定义在数值优化领域是标准的。关键假设，即 Hessian 近似 $B_k$ 是对称正定（SPD）的，至关重要，并将在整个推导过程中使用。让我们进行分析。\n\ndogleg 方法通过将步长 $p$ 的搜索限制在一条分段线性的“dogleg”路径上，来寻求信赖域子问题的近似解：\n$$ \\min_{p \\in \\mathbb{R}^n} \\; m_k(p) \\quad \\text{subject to} \\quad \\|p\\|_2 \\le \\Delta_k $$\n这条路径记为 $\\mathcal{P}_{DL}$，从原点构建到 Cauchy 点 $p_C$，然后再从 Cauchy 点构建到 Newton 点 $p_N$。\n\nNewton 步 $p_N = -B_k^{-1} g_k$ 是二次模型 $m_k(p)$ 的无约束最小化子，因为模型的梯度 $\\nabla m_k(p) = g_k + B_k p$ 在 $p=p_N$ 时为零。由于 $B_k$ 是 SPD 的，$m_k(p)$ 是一个严格凸的二次函数，而 $p_N$ 是其唯一的全局最小值点。\n\nCauchy 步 $p_C = -\\tau^\\star g_k$ 是 $m_k(p)$ 沿着最速下降方向 $-g_k$ 在信赖域约束下的最小化子。沿此直线的无约束最小化子是 $p_{C,uc} = -\\tau_{uc} g_k$，其中 $\\tau_{uc} = \\frac{g_k^\\top g_k}{g_k^\\top B_k g_k} = \\frac{\\|g_k\\|_2^2}{g_k^\\top B_k g_k}$。由于 $B_k$ 是 SPD 的，对于 $g_k \\ne 0$ 有 $g_k^\\top B_k g_k > 0$，所以 $\\tau_{uc} > 0$。Cauchy 步 $p_C$ 则是 $p_{C,uc}$ 和达到信赖域边界的步长中较短的一个：$\\|p_C\\|_2 = \\min(\\|p_{C,uc}\\|_2, \\Delta_k)$。根据其定义，Cauchy 步总是满足信赖域约束，即 $\\|p_C\\|_2 \\le \\Delta_k$。\n\ndogleg 路径的一个关键性质是，当沿着路径从原点向 Newton 步 $p_N$ 移动时，模型函数值 $m_k(p)$ 是单调递减的。这是因为第一段是沿着最速下降方向，而第二段是从 Cauchy 点（沿最速下降线的约束最小化子）向全局最小化子 $p_N$ 移动。因此，最优的 dogleg 步 $p_{\\text{DL}}$ 是路径 $\\mathcal{P}_{DL}$ 上离原点最远但仍满足信赖域约束 $\\|p\\|_2 \\le \\Delta_k$ 的点。\n\n现在我们可以通过考虑 $p_N$ 相对于信赖域的位置来推导决策逻辑。\n\n**情况 1：Newton 步在信赖域内部。**\n这对应于条件 $\\|p_N\\|_2 \\le \\Delta_k$。在这种情况下，从原点到 $p_N$ 的整个 dogleg 路径都位于信赖域内。由于 $p_N$ 是 $m_k(p)$ 的全局最小化子，并且它是可达的（即，它位于路径上并满足约束），因此它是步长的最优选择。\n因此，如果 $\\|p_N\\|_2 \\le \\Delta_k$，则 $p_{\\text{DL}} = p_N$。\n\n**情况 2：Newton 步在信赖域外部。**\n这对应于条件 $\\|p_N\\|_2 > \\Delta_k$。在这种情况下，完整的 Newton 步不是一个可行的解。由于沿着 dogleg 路径向 $p_N$ 移动时模型值会改善，最优步 $p_{\\text{DL}}$ 必须位于信赖域的边界上，即 $\\|p_{\\text{DL}}\\|_2 = \\Delta_k$。我们必须确定 dogleg 路径与这个边界相交的位置。这取决于 Cauchy 步的长度 $\\|p_C\\|_2$。\n\n*   **子情况 2a：Cauchy 步位于信赖域边界上。**\n    当沿着最速下降方向的最小值在边界处或边界之外达到时，会发生这种情况，意味着 $\\|p_{C,uc}\\|_2 \\ge \\Delta_k$。根据定义，这得出 $\\|p_C\\|_2 = \\Delta_k$。dogleg 路径的第一段，从原点到 $p_C$，结束于边界上。第二段上（从 $p_C$ 到 $p_N$）的任何点都必须位于开放信赖域 $\\|p\\|_2 > \\Delta_k$ 之外。由于我们寻求的是路径上位于边界内部或边界上最好的步长，并且路径只有通过向原点后退才能重新进入信赖域，因此路径上最远的可行点是 $p_C$。\n    因此，如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2 = \\Delta_k$，则 $p_{\\text{DL}} = p_C$。\n\n*   **子情况 2b：Cauchy 步严格位于信赖域内部。**\n    当沿着最速下降方向的最小值在到达边界之前达到时，会发生这种情况，意味着 $\\|p_{C,uc}\\|_2  \\Delta_k$。这得出 $p_C = p_{C,uc}$，因此 $\\|p_C\\|_2  \\Delta_k$。dogleg 路径从原点开始，穿过 $p_C$（严格在信赖域内部），然后向 $p_N$（在信赖域外部）延伸。由于路径是连续的，它必须与信赖域边界 $\\|p\\|_2 = \\Delta_k$ 相交。这个交点必须出现在连接 $p_C$ 和 $p_N$ 的路径的第二段上。dogleg 步 $p_{\\text{DL}}$ 就是这个交点。它可以写成 $p_{\\text{DL}} = p_C + \\theta(p_N - p_C)$，对于某个 $\\theta \\in (0, 1)$，其中 $\\theta$ 的选择是为了满足 $\\|p_C + \\theta(p_N - p_C)\\|_2 = \\Delta_k$。求解这个关于 $\\theta$ 的二次方程可以得到所需的步长。因为路径在 $p_C$ 点开始于圆内，在 $p_N$ 点结束于圆外，所以在朝向 $p_N$ 的方向上存在一个唯一的交点。\n    因此，如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2  \\Delta_k$，则 $p_{\\text{DL}}$ 是连接 $p_C$ 和 $p_N$ 的线段上位于信赖域边界上的唯一一点。\n\n现在我们来评估每个选项。\n\n**A. 如果 $\\|p_N\\|_2 \\le \\Delta_k$，则 $p_{\\text{DL}} = p_N$。**\n这与我们对情况 1 的推导相符。完整的 Newton 步是模型的无约束最小化子，并且由于它是可行的，因此是最佳可能步。\n**结论：正确。**\n\n**B. 如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2 = \\Delta_k$，则 $p_{\\text{DL}} = p_C$。**\n这与我们对子情况 2a 的推导相符。Cauchy 步已经位于边界上，并且是路径上保持在可行区域内的最远点。\n**结论：正确。**\n\n**C. 如果 $\\|p_N\\|_2 > \\Delta_k$ 且 $\\|p_C\\|_2  \\Delta_k$，则 $p_{\\text{DL}}$ 位于线段 $\\{\\, p_C + \\theta\\, (p_N - p_C) : \\theta \\in (0,1)\\,\\}$ 上，其唯一的 $\\theta$ 值使得 $\\|p_C + \\theta\\, (p_N - p_C)\\|_2 = \\Delta_k$。**\n这与我们对子情况 2b 的推导相符。路径在 $p_C$ 和 $p_N$ 之间穿过信赖域边界，这个交点就是所求的步。\n**结论：正确。**\n\n**D. 如果 $\\|p_N\\|_2 \\le \\Delta_k$ 但 $g_k^\\top p_N > 0$，则 $p_{\\text{DL}} = p_C$，因为 Newton 步对于 $m_k(\\cdot)$ 是一个上升方向。**\n这个陈述包含一个与问题设置相矛盾的前提。问题假设 $B_k$ 是 SPD。Newton 步是 $p_N = -B_k^{-1} g_k$。我们考察 $g_k^\\top p_N$ 的值：\n$$ g_k^\\top p_N = g_k^\\top (-B_k^{-1} g_k) = - g_k^\\top B_k^{-1} g_k $$\n由于 $B_k$ 是 SPD 的，其逆 $B_k^{-1}$ 也是 SPD 的。对于任何非零梯度 $g_k$（我们假设如此，否则迭代已经收敛），二次型 $g_k^\\top B_k^{-1} g_k$ 是严格为正的。因此，$g_k^\\top p_N  0$。在给定假设下，条件 $g_k^\\top p_N > 0$ 在数学上是不可能的。$m_k(p)$ 在 $p=0$ 处沿 $p_N$ 方向的方向导数是 $g_k^\\top p_N$，该值为负，意味着 $p_N$ 是一个下降方向，而不是上升方向。该选项基于一个错误的前提。\n**结论：不正确。**\n\n**E. 如果 $B_k$ 是不定的，则对于所有 $\\Delta_k > 0$，$p_{\\text{DL}} = p_C$，因为在固体力学的非凸情况下，dogleg 方法会避免使用 Newton 步。**\n这个陈述的前提，“$B_k$ 是不定的”，直接与问题陈述的核心假设“$B_k$ 是一个对称正定（SPD）近似”相矛盾。整个 dogleg 方法的推导，包括 $p_N$ 作为凸模型唯一最小化子的定义和性质，都依赖于 $B_k$ 是 SPD 的。问题要求是基于所提供的定义“推导 dogleg 步的决策逻辑”。引入一个违反这些定义的条件使得分析超出了问题的范围。尽管其他信赖域方法被设计用来处理不定 Hessian 矩阵，但这个特定的公式并非如此。\n**结论：不正确。**\n\n总结：选项 A、B 和 C 在 SPD Hessian 近似的假设下，根据标准算法正确描述了 dogleg 步选择的三种可能结果。", "answer": "$$\\boxed{ABC}$$", "id": "3608044"}, {"introduction": "计算出试探步后，算法必须评估其质量并决定如何继续。本练习侧重于这一关键的反馈循环，要求你计算比率 $\\rho$，该比率用于比较目标函数的实际减少量与模型预测的减少量。然后，你将根据此比率应用标准策略来接受或拒绝该步长，并动态调整下一次迭代的信赖域半径 [@problem_id:3608057]。", "problem": "在超弹性的非线性有限元平衡求解中，考虑使用信赖域全局化方法，在当前牛顿迭代点 $u$ 处最小化离散总势能 $\\phi(u)$。信赖域方法使用在 $u$ 处由 $\\phi$ 的一阶和二阶导数构建的二次模型 $m(p)$，定义为\n$$\nm(p) \\equiv \\phi(u) + g^{\\top} p + \\tfrac{1}{2} p^{\\top} B p,\n$$\n其中 $g = \\nabla \\phi(u)$，$B \\approx \\nabla^{2} \\phi(u)$ 是海森矩阵的一个对称正定近似。\n\n在当前迭代点，假设以下数据可用：\n- 目标函数值：$\\phi(u) = 10.5$ 和 $\\phi(u+p) = 9.62$。\n- 梯度：$g = \\begin{pmatrix} 6 \\\\ -2 \\end{pmatrix}$。\n- 海森矩阵近似：$B = \\begin{pmatrix} 8  1 \\\\ 1  2 \\end{pmatrix}$。\n- 建议步长：$p = \\begin{pmatrix} -0.1 \\\\ 0.2 \\end{pmatrix}$。\n- 当前信赖域半径：$\\Delta_k = 0.25$。\n\n使用比率 $\\rho$ 等于实际下降量除以预测下降量的基本定义，计算 $\\rho$。其中实际下降量由 $\\phi(u) - \\phi(u+p)$ 给出，预测下降量定义为 $m(0) - m(p)$。\n\n然后，根据以下具有参数 $(\\eta_1,\\eta_2,\\gamma_{\\text{dec}},\\gamma_{\\text{inc}}) = (0.1, 0.9, 0.5, 2.0)$ 和边界邻近因子 $\\tau_b = 0.8$ 的完全指定的接受与更新策略，确定下一个信赖域半径 $\\Delta_{k+1}$：\n- 如果 $\\rho \\ge \\eta_1$，则接受该步；否则拒绝。\n- 如果 $\\rho  \\eta_1$，则设置 $\\Delta_{k+1} = \\gamma_{\\text{dec}} \\Delta_k$。\n- 否则，如果 $\\rho \\ge \\eta_2$ 且 $\\|p\\|_2 \\ge \\tau_b \\Delta_k$，则设置 $\\Delta_{k+1} = \\gamma_{\\text{inc}} \\Delta_k$。\n- 否则设置 $\\Delta_{k+1} = \\Delta_k$。\n\n将最终答案以包含 $\\rho$ 和 $\\Delta_{k+1}$ 的行向量形式报告，四舍五入到四位有效数字，不带单位。", "solution": "该问题要求计算与数值优化的信赖域方法相关的两个量：质量比 $\\rho$ 和更新后的信赖域半径 $\\Delta_{k+1}$。\n\n首先，我们计算比率 $\\rho$，其定义为目标函数的实际下降量除以二次模型预测的下降量。\n\n实际下降量，记为 $\\text{ared}$，是势能函数 $\\phi$ 的变化量：\n$$\n\\text{ared} = \\phi(u) - \\phi(u+p)\n$$\n使用给定值 $\\phi(u) = 10.5$ 和 $\\phi(u+p) = 9.62$：\n$$\n\\text{ared} = 10.5 - 9.62 = 0.88\n$$\n\n预测下降量，记为 $\\text{pred}$，是二次模型 $m(p)$ 的变化量：\n$$\n\\text{pred} = m(0) - m(p)\n$$\n二次模型定义为 $m(p) = \\phi(u) + g^{\\top} p + \\tfrac{1}{2} p^{\\top} B p$。在 $p=0$ 处，模型值为 $m(0) = \\phi(u)$。因此，预测下降量为：\n$$\n\\text{pred} = \\phi(u) - \\left( \\phi(u) + g^{\\top} p + \\tfrac{1}{2} p^{\\top} B p \\right) = -g^{\\top} p - \\tfrac{1}{2} p^{\\top} B p\n$$\n我们使用所提供的数据计算此表达式中的两项：\n$g = \\begin{pmatrix} 6 \\\\ -2 \\end{pmatrix}$，$p = \\begin{pmatrix} -0.1 \\\\ 0.2 \\end{pmatrix}$，以及 $B = \\begin{pmatrix} 8  1 \\\\ 1  2 \\end{pmatrix}$。\n\n线性项是 $g^{\\top} p$：\n$$\ng^{\\top} p = \\begin{pmatrix} 6  -2 \\end{pmatrix} \\begin{pmatrix} -0.1 \\\\ 0.2 \\end{pmatrix} = (6)(-0.1) + (-2)(0.2) = -0.6 - 0.4 = -1.0\n$$\n\n二次项是 $p^{\\top} B p$。首先，我们计算乘积 $B p$：\n$$\nB p = \\begin{pmatrix} 8  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} -0.1 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} (8)(-0.1) + (1)(0.2) \\\\ (1)(-0.1) + (2)(0.2) \\end{pmatrix} = \\begin{pmatrix} -0.8 + 0.2 \\\\ -0.1 + 0.4 \\end{pmatrix} = \\begin{pmatrix} -0.6 \\\\ 0.3 \\end{pmatrix}\n$$\n现在，我们计算 $p^{\\top} (B p)$：\n$$\np^{\\top} B p = \\begin{pmatrix} -0.1  0.2 \\end{pmatrix} \\begin{pmatrix} -0.6 \\\\ 0.3 \\end{pmatrix} = (-0.1)(-0.6) + (0.2)(0.3) = 0.06 + 0.06 = 0.12\n$$\n将这些值代回预测下降量的表达式中：\n$$\n\\text{pred} = -(-1.0) - \\tfrac{1}{2}(0.12) = 1.0 - 0.06 = 0.94\n$$\n\n现在我们可以计算比率 $\\rho$：\n$$\n\\rho = \\frac{\\text{ared}}{\\text{pred}} = \\frac{0.88}{0.94} = \\frac{44}{47} \\approx 0.9361702...\n$$\n四舍五入到四位有效数字，我们得到 $\\rho \\approx 0.9362$。\n\n接下来，我们使用提供的更新策略和参数 $(\\eta_1, \\eta_2, \\gamma_{\\text{dec}}, \\gamma_{\\text{inc}}) = (0.1, 0.9, 0.5, 2.0)$ 及 $\\tau_b = 0.8$ 来确定下一个信赖域半径 $\\Delta_{k+1}$。当前半径为 $\\Delta_k = 0.25$。\n\n更新规则如下：\n1. 如果 $\\rho \\ge \\eta_1$ 则接受该步；否则拒绝。\n2. 如果 $\\rho  \\eta_1$，则设置 $\\Delta_{k+1} = \\gamma_{\\text{dec}} \\Delta_k$。\n3. 否则，如果 $\\rho \\ge \\eta_2$ 且 $\\|p\\|_2 \\ge \\tau_b \\Delta_k$，则设置 $\\Delta_{k+1} = \\gamma_{\\text{inc}} \\Delta_k$。\n4. 否则，设置 $\\Delta_{k+1} = \\Delta_k$。\n\n首先，我们检查步长是否被接受。我们有 $\\rho \\approx 0.9362$ 且 $\\eta_1 = 0.1$。因为 $0.9362 \\ge 0.1$，该步被接受。这意味着针对 $\\rho  \\eta_1$ 的第一条更新规则（规则2）不适用。\n\n我们继续下一个条件（规则3）：$\\rho \\ge \\eta_2$ 且 $\\|p\\|_2 \\ge \\tau_b \\Delta_k$。\n该条件的第一部分是 $\\rho \\ge \\eta_2$。由于 $\\eta_2 = 0.9$，我们有 $0.9362 \\ge 0.9$，这是成立的。\n第二部分是 $\\|p\\|_2 \\ge \\tau_b \\Delta_k$。我们需要计算这个不等式的两边。\n步长 $p$ 的欧几里得范数是：\n$$\n\\|p\\|_2 = \\sqrt{(-0.1)^2 + (0.2)^2} = \\sqrt{0.01 + 0.04} = \\sqrt{0.05} \\approx 0.2236\n$$\n边界邻近阈值为：\n$$\n\\tau_b \\Delta_k = (0.8)(0.25) = 0.2\n$$\n比较这两个值，我们检查 $0.2236 \\ge 0.2$ 是否成立。这是成立的。\n\n由于规则3中的两个条件都成立，我们应用此规则来更新信赖域半径：\n$$\n\\Delta_{k+1} = \\gamma_{\\text{inc}} \\Delta_k\n$$\n使用给定值 $\\gamma_{\\text{inc}} = 2.0$ 和 $\\Delta_k = 0.25$：\n$$\n\\Delta_{k+1} = 2.0 \\times 0.25 = 0.5\n$$\n“否则”条件（规则4）未被触发。\n\n最终值为 $\\rho \\approx 0.9362$ 和 $\\Delta_{k+1} = 0.5$。问题要求答案四舍五入到四位有效数字。因此，$\\rho$ 是 $0.9362$，$\\Delta_{k+1}$ 表示为 $0.5000$。\n\n最终答案是包含这两个值的行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.9362  0.5000 \\end{pmatrix}}\n$$", "id": "3608057"}]}