{"hands_on_practices": [{"introduction": "在我们深入探讨如何消除自旋-自旋耦合之前，首先必须从第一性原理理解它对谱图的影响。这项练习将引导您推导一个简单的双自旋系统的能级，并展示单个共振信号如何分裂成一个双峰。这为理解自旋去偶奠定了坚实的理论基础 [@problem_id:3723362]。", "problem": "考虑一个孤立的双自旋、自旋-$1/2$ AX体系，该体系处于核磁共振（NMR）环境中。其中自旋标记为 $I$ 和 $S$，对应于有机分子中两个不同的原子核，它们处于沿 $z$ 轴方向的静态磁场 $B_0$ 中。假设为弱耦合，即 $|\\omega_{I} - \\omega_{S}| \\gg 2\\pi J$，其中 $\\omega_{I}$ 和 $\\omega_{S}$ 分别是自旋 $I$ 和 $S$ 未受扰动的拉莫尔角频率，而 $J$ 是以赫兹（s$^{-1}$）为单位的各向同性标量耦合常数。系统中存在各向同性自旋-自旋耦合，并且在高场下久期近似有效。\n\n从第一性原理出发，使用该体系的适当自旋哈密顿量，推导四个乘积态 $|m_{I}, m_{S}\\rangle$（其中 $m_{I}, m_{S} \\in \\{+1/2, -1/2\\}$）的能级。然后，根据磁偶极选择定则和弱耦合假设，确定自旋 $I$ 的两个允许跃迁角频率。\n\n用符号 $\\omega_{I}$ 和 $J$ 表示这两个角频率的最终解析结果。您的答案必须是包含这两个角频率的单一解析表达式，形式为行矩阵。角频率以弧度/秒为单位表示。请勿代入数值。无需四舍五入。", "solution": "该问题是有效的，因为它具有科学依据、问题陈述清晰且客观。它描述了核磁共振中一个标准的双自旋AX体系，这是波谱分析中的一个基本课题。符号推导所需的所有必要参数和条件均已提供。\n\n我们首先建立孤立的双自旋、自旋-$1/2$ AX体系的自旋哈密顿量。该体系包含两个自旋，标记为 $I$ 和 $S$，处于沿 $z$ 轴方向的静态磁场 $\\vec{B_0} = B_0 \\hat{k}$ 中。总哈密顿量 $\\hat{H}$ 是塞曼相互作用项 $\\hat{H}_Z$ 和标量耦合项 $\\hat{H}_J$ 的和。\n\n塞曼哈密顿量描述了自旋与外部磁场的相互作用，$\\hat{H}_Z = -\\gamma_I \\hbar B_0 \\hat{I}_z - \\gamma_S \\hbar B_0 \\hat{S}_z$。按照核磁共振领域的惯例，我们定义拉莫尔角频率为一个正值 $\\omega_k = |\\gamma_k B_0|$。对于绝大多数用于核磁共振的原子核（如 $^{1}$H, $^{13}$C），旋磁比 $\\gamma$ 为正，因此哈密顿量可以写作：\n$$\n\\hat{H}_Z = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z\n$$\n其中 $\\omega_I$ 和 $\\omega_S$ 是正的拉莫尔角频率。\n\n标量耦合哈密顿量描述了由电子介导的两个自旋之间的相互作用：\n$$\n\\hat{H}_J = h J (\\hat{\\vec{I}} \\cdot \\hat{\\vec{S}}) = h J (\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y + \\hat{I}_z\\hat{S}_z)\n$$\n其中 $J$ 是以赫兹（Hz）为单位的标量耦合常数，而 $h=2\\pi\\hbar$ 是普朗克常数。\n\n总哈密顿量为 $\\hat{H} = \\hat{H}_Z + \\hat{H}_J$。\n$$\n\\hat{H} = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z + h J (\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y + \\hat{I}_z\\hat{S}_z)\n$$\n问题指出久期近似是有效的。该近似在高场条件下是合理的，此时塞曼相互作用占主导地位，即 $|\\omega_{I} - \\omega_{S}|$ 远大于 $2\\pi J$。在此极限下，与 $\\hat{H}_Z$ 不对易的非久期项，特别是“翻转-翻转”项 $\\hat{I}_x\\hat{S}_x + \\hat{I}_y\\hat{S}_y = \\frac{1}{2}(\\hat{I}_+\\hat{S}_- + \\hat{I}_-\\hat{S}_+)$，被忽略。久期哈密顿量为能级提供一阶修正，它只保留了耦合相互作用的 $z$ 分量部分：\n$$\n\\hat{H}_{\\text{secular}} = -\\omega_I \\hbar \\hat{I}_z - \\omega_S \\hbar \\hat{S}_z + h J \\hat{I}_z \\hat{S}_z\n$$\n为求能级，我们必须求出此哈密顿量的本征值。为了方便计算，我们通过考虑算符 $\\hat{\\mathcal{H}} = \\hat{H}_{\\text{secular}}/\\hbar$ 来使用角频率单位（弧度/秒）：\n$$\n\\hat{\\mathcal{H}} = -\\omega_I \\hat{I}_z - \\omega_S \\hat{S}_z + 2\\pi J \\hat{I}_z \\hat{S}_z\n$$\n该双自旋体系的基矢是4个乘积态 $|m_I, m_S\\rangle$ 的集合，其中 $m_I, m_S \\in \\{+1/2, -1/2\\}$。这些状态通常用 $\\alpha$ 表示自旋向上（$m=+1/2$），用 $\\beta$ 表示自旋向下（$m=-1/2$）。这4个状态是：\n$|1\\rangle = |\\alpha\\alpha\\rangle = |+1/2, +1/2\\rangle$\n$|2\\rangle = |\\alpha\\beta\\rangle = |+1/2, -1/2\\rangle$\n$|3\\rangle = |\\beta\\alpha\\rangle = |-1/2, +1/2\\rangle$\n$|4\\rangle = |\\beta\\beta\\rangle = |-1/2, -1/2\\rangle$\n\n因为久期哈密顿量只包含 $\\hat{I}_z$ 和 $\\hat{S}_z$ 算符，所以这些乘积态是 $\\hat{\\mathcal{H}}$ 的精确本征态。通过将 $\\hat{\\mathcal{H}}$ 应用于每个状态，可以求得能量本征值（单位为 rad/s）$E/\\hbar$：\n$$\n\\frac{E(m_I, m_S)}{\\hbar} = \\langle m_I, m_S | \\hat{\\mathcal{H}} | m_I, m_S \\rangle = -\\omega_I m_I - \\omega_S m_S + 2\\pi J m_I m_S\n$$\n计算4个状态各自的能量：\n1.  $E_1/\\hbar$（对于 $|\\alpha\\alpha\\rangle$）：$m_I=+1/2, m_S=+1/2$\n    $$ \\frac{E_1}{\\hbar} = -\\omega_I(1/2) - \\omega_S(1/2) + 2\\pi J(1/2)(1/2) = -\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J $$\n2.  $E_2/\\hbar$（对于 $|\\alpha\\beta\\rangle$）：$m_I=+1/2, m_S=-1/2$\n    $$ \\frac{E_2}{\\hbar} = -\\omega_I(1/2) - \\omega_S(-1/2) + 2\\pi J(1/2)(-1/2) = -\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J $$\n3.  $E_3/\\hbar$（对于 $|\\beta\\alpha\\rangle$）：$m_I=-1/2, m_S=+1/2$\n    $$ \\frac{E_3}{\\hbar} = -\\omega_I(-1/2) - \\omega_S(1/2) + 2\\pi J(-1/2)(1/2) = +\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J $$\n4.  $E_4/\\hbar$（对于 $|\\beta\\beta\\rangle$）：$m_I=-1/2, m_S=-1/2$\n    $$ \\frac{E_4}{\\hbar} = -\\omega_I(-1/2) - \\omega_S(-1/2) + 2\\pi J(-1/2)(-1/2) = +\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J $$\n\n接下来，我们确定自旋 $I$ 的允许跃迁角频率。我们考虑吸收跃迁（从低能态到高能态）。根据磁偶极选择定则，对于自旋 $I$ 的跃迁，要求 $\\Delta m_I = \\pm 1$ 且 $\\Delta m_S = 0$。这意味着在自旋 $I$ 发生跃迁时，自旋 $S$ 的状态保持不变。\n\n自旋 $I$ 可能发生两种这样的跃迁：\n1.  当自旋 $S$ 处于 $\\alpha$ 态（$m_S = +1/2$）时的跃迁。这是从状态 $|\\alpha\\alpha\\rangle$（状态1，较低能）到状态 $|\\beta\\alpha\\rangle$（状态3，较高能）的跃迁。跃迁角频率 $\\omega_{I,1}$ 由能量差给出：\n    $$ \\omega_{I,1} = \\frac{E_3 - E_1}{\\hbar} = \\left(\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J\\right) - \\left(-\\frac{1}{2}\\omega_I - \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J\\right) $$\n    $$ \\omega_{I,1} = \\omega_I - \\pi J $$\n2.  当自旋 $S$ 处于 $\\beta$ 态（$m_S = -1/2$）时的跃迁。这是从状态 $|\\alpha\\beta\\rangle$（状态2，较低能）到状态 $|\\beta\\beta\\rangle$（状态4，较高能）的跃迁。跃迁角频率 $\\omega_{I,2}$ 为：\n    $$ \\omega_{I,2} = \\frac{E_4 - E_2}{\\hbar} = \\left(\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S + \\frac{1}{2}\\pi J\\right) - \\left(-\\frac{1}{2}\\omega_I + \\frac{1}{2}\\omega_S - \\frac{1}{2}\\pi J\\right) $$\n    $$ \\omega_{I,2} = \\omega_I + \\pi J $$\n\n因此，自旋 $I$ 的谱图由一个以 $\\omega_I$ 为中心的双峰组成，裂分值为 $2\\pi J$ (rad/s)，或 $J$ (Hz)。自旋 $I$ 的两个允许跃迁角频率是 $\\omega_I - \\pi J$ 和 $\\omega_I + \\pi J$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\omega_I - \\pi J & \\omega_I + \\pi J\n\\end{pmatrix}\n}\n$$", "id": "3723362"}, {"introduction": "去偶实验的成功与否及其结果的解读，很大程度上取决于所研究的自旋体系是弱耦合还是强耦合。这项实践练习介绍了一个关键参数 $|\\Delta \\nu|/|J|$，光谱学家可以利用它根据化学位移和耦合常数来预测自旋体系的性质。这是在规划真实的双共振实验时至关重要的第一步 [@problem_id:3723358]。", "problem": "在一次质子核磁共振（NMR）实验中，一个双自旋体系在取代苯的芳香区通过双共振（选择性辐照）进行探测。波谱仪在 $500\\,\\text{MHz}$ 的质子频率下运行。两个邻位芳香质子，标记为 $H_a$ 和 $H_b$，其化学位移分别为 $\\delta_a = 7.262\\,\\text{ppm}$ 和 $\\delta_b = 7.274\\,\\text{ppm}$。它们的标量耦合常数为 $J_{ab} = 7.8\\,\\text{Hz}$。为了评估强耦合是否会妨碍有意义的选择性去耦，请仅使用拉莫尔频率和化学位移的基本定义，以及波谱仪的工作频率，估算 $H_a$–$H_b$ 对的比值 $|\\Delta \\omega|/|2\\pi J|$。\n\n假设 $H_a$ 和 $H_b$ 之间的角频率偏移由静磁场 $B_0$ 下的化学位移差决定，并且耦合常数 $J$ 以赫兹为单位报告。根据这些数据，提供 $|\\Delta \\omega|/|2\\pi J|$ 的数值。将您的最终答案表示为一个无量纲数，并四舍五入到三位有效数字。", "solution": "题目陈述已经过评估，被认为是有效的。它具有科学依据、问题明确、客观，并包含所有必要信息，可以无歧义地推导出唯一解。所提供的值对于取代芳香族化合物的质子核磁共振实验是物理上现实的。\n\n目标是为一个由质子 $H_a$ 和 $H_b$ 组成的双自旋体系计算无量纲比值 $|\\Delta \\omega|/|2\\pi J|$。量 $\\Delta \\omega$ 表示两个质子拉莫尔角频率的差值，$J$ 是它们的标量耦合常数。\n\n根据化学位移的基本定义，原子核的拉莫尔频率 $\\nu$（单位为赫兹，$\\text{Hz}$）与波谱仪的工作频率 $\\nu_{spec}$ 以及原子核的化学位移 $\\delta$（单位为百万分率，$\\text{ppm}$）相关。化学位移测量的是原子核相对于标准参考频率的共振频率。两个原子核 $a$ 和 $b$ 之间的共振频率差 $\\Delta \\nu$ 可以直接通过它们的化学位移差 $\\Delta \\delta = \\delta_a - \\delta_b$ 和波谱仪频率 $\\nu_{spec}$ 计算得出。\n\n原子核 $i$ 的频率由 $\\nu_i = (\\text{参考频率}) + \\delta_i \\nu_{spec} 10^{-6}$ 给出。因此，质子 $H_a$ 和 $H_b$ 之间的频率差为：\n$$ \\Delta \\nu = \\nu_a - \\nu_b = (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6} $$\n这个频率差 $\\Delta \\nu$ 的单位是 $\\text{Hz}$。\n\n问题要求的是角频率的差值 $\\Delta \\omega$。角频率 $\\omega$（单位为弧度/秒）和频率 $\\nu$（单位为赫兹）之间的关系是 $\\omega = 2\\pi\\nu$。因此，角频率的差值为：\n$$ \\Delta \\omega = 2\\pi \\Delta \\nu = 2\\pi (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6} $$\n\n我们被要求找出比值 $|\\Delta \\omega|/|2\\pi J|$。代入 $\\Delta \\omega$ 的表达式：\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|2\\pi (\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6}|}{|2\\pi J_{ab}|} $$\n分子和分母中的因子 $2\\pi$ 相互抵消，表达式简化为：\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|(\\delta_a - \\delta_b) \\nu_{spec} \\times 10^{-6}|}{|J_{ab}|} = \\frac{|\\Delta \\nu|}{|J_{ab}|} $$\n这个简化后的比值，常写作 $|\\Delta \\nu / J|$，是确定两个自旋之间耦合程度（弱耦合与强耦合）的标准度量。\n\n给定的值为：\n波谱仪频率：$\\nu_{spec} = 500\\,\\text{MHz} = 500 \\times 10^6\\,\\text{Hz}$\n$H_a$ 的化学位移：$\\delta_a = 7.262\\,\\text{ppm}$\n$H_b$ 的化学位移：$\\delta_b = 7.274\\,\\text{ppm}$\n标量耦合常数：$J_{ab} = 7.8\\,\\text{Hz}$\n\n首先，我们计算化学位移的差值 $\\Delta \\delta$：\n$$ \\Delta \\delta = \\delta_a - \\delta_b = 7.262 - 7.274 = -0.012\\,\\text{ppm} $$\n其绝对值为 $|\\Delta \\delta| = 0.012\\,\\text{ppm}$。\n\n接下来，我们计算以赫兹为单位的频率差的绝对值 $|\\Delta \\nu|$：\n$$ |\\Delta \\nu| = |\\Delta \\delta| \\times \\nu_{spec} \\times 10^{-6} $$\n$$ |\\Delta \\nu| = (0.012) \\times (500 \\times 10^6\\,\\text{Hz}) \\times 10^{-6} $$\n$$ |\\Delta \\nu| = 0.012 \\times 500\\,\\text{Hz} = 6.0\\,\\text{Hz} $$\n\n最后，我们使用计算出的 $|\\Delta \\nu|$ 和给定的 $|J_{ab}|$ 来计算所求的无量纲比值：\n$$ \\frac{|\\Delta \\omega|}{|2\\pi J|} = \\frac{|\\Delta \\nu|}{|J_{ab}|} = \\frac{6.0\\,\\text{Hz}}{7.8\\,\\text{Hz}} $$\n$$ \\frac{|\\Delta \\nu|}{|J_{ab}|} \\approx 0.7692307... $$\n按照题目要求，将结果四舍五入到三位有效数字，得到 $0.769$。这个值小于约 $10$，表明 $H_a-H_b$ 体系是强耦合的，这证实了题目中关于评估强耦合效应对选择性去耦实验影响的前提。", "answer": "$$\\boxed{0.769}$$", "id": "3723358"}, {"introduction": "现代波谱学在很大程度上依赖于模拟来理解复杂的现象。这项练习提供了一个从头开始构建自旋去偶实验完整数值模拟的框架，该模拟基于刘维尔-冯·诺依曼方程。通过使用不同的参数运行此模拟，学生可以直接观察到辐射如何将多重峰坍缩为单峰，并探索在峰和离峰条件下的不同效应 [@problem_id:3723368]。", "problem": "要求您实现一个 $A\\!X$ 类型的双自旋 $1/2$ 系统在双共振下经历选择性自旋去偶的数值模拟，并预测在对自旋 $A$ 进行选择性连续波辐照时观测到的自旋 $X$ 的谱图。该模拟必须基于第一性原理，通过根据基本量子动力学演化含时密度矩阵，然后计算可观测信号及其傅里叶变换来获得共振频率。\n\n从刘维尔-冯·诺依曼方程 $d\\rho/dt = -i[\\hat{H}(t),\\rho(t)]$ 出发，假设在强场弱耦合近似下，标量耦合哈密顿量仅保留久期项。在一个双旋转坐标系（每个自旋一个坐标系）中，其中偏移量以赫兹（Hz）表示，相对于每个自旋的发射机参考频率，构建在自旋 $A$ 上施加连续波辐照的不含时哈密顿量：\n$$\n\\hat{H} = 2\\pi\\Delta\\nu_A\\hat{I}_z^{(A)} + 2\\pi\\Delta\\nu_X\\hat{I}_z^{(X)} + 2\\pi J\\hat{I}_z^{(A)}\\hat{I}_z^{(X)} + 2\\pi\\omega_1\\hat{I}_x^{(A)}\n$$\n其中 $\\Delta\\nu_A$ 和 $\\Delta\\nu_X$ 是以赫兹为单位的化学位移偏移， $J$ 是以赫兹为单位的耦合常数， $\\omega_1$ 是沿 $x$ 轴施加于自旋 $A$ 的射频 (RF) 章动频率（以赫兹为单位）。自旋算符为 $\\hat{I}_\\alpha^{(A)} = \\tfrac{1}{2}\\hat{\\sigma}_\\alpha\\otimes \\hat{\\mathbb{1}}$ 和 $\\hat{I}_\\alpha^{(X)} = \\hat{\\mathbb{1}}\\otimes \\tfrac{1}{2}\\hat{\\sigma}_\\alpha$ ，其中 $\\alpha\\in\\{x,y,z\\}$ ， $\\hat{\\sigma}_\\alpha$ 是 Pauli 矩阵， $\\hat{\\mathbb{1}}$ 是单位矩阵。\n\n将系统初始化于仅限于自旋 $X$ 的热平衡状态，$\\rho_{\\text{eq}}\\propto \\hat{I}_z^{(X)}$ ，并对自旋 $X$ 施加一个绕 $y$ 轴的瞬时 $90^\\circ$ 脉冲以产生横向磁化强度。初始状态为\n$$\n\\rho(0) = \\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)\\,\\rho_{\\text{eq}}\\,\\left(\\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)\\right)^\\dagger,\\quad \\text{with}\\quad \\hat{R}_y^{(X)}(\\theta) = \\exp\\!\\big(-i\\,\\theta\\,\\hat{I}_y^{(X)}\\big).\n$$\n通过计算幺正传播子 $\\hat{U}=\\exp(-i\\hat{H}\\Delta t)$ 并迭代 $\\rho(t+\\Delta t)=\\hat{U}\\rho(t)\\hat{U}^\\dagger$ ，在哈密顿量 $\\hat{H}$ 的作用下，使用均匀时间步长 $\\Delta t$ 来演化 $\\rho(t)$ 。将自旋 $X$ 的复数自由感应衰减 (FID) 计算为\n$$\ns(t) = \\operatorname{Tr}\\!\\left[\\rho(t)\\left(\\hat{I}_x^{(X)} + i\\,\\hat{I}_y^{(X)}\\right)\\right].\n$$\n为获得谱图，对 $s(t)$ 乘以一个指数切趾窗函数 $\\exp(-t/T_2^{\\text{win}})$ 后进行离散傅里叶变换，以确保数值稳定性和逼真的线型。使用标准的离散傅里叶变换频率轴（单位：周/秒），将共振频率以赫兹表示。\n\n您的任务是实现此模拟，并对每个指定的测试用例，检测高于给定阈值的自旋 $X$ 的正频率谱峰，并返回峰值频率列表（以赫兹为单位，四舍五入到一位小数）。角度必须以弧度处理；在构建 $\\hat{H}$ 时，所有频率量必须在内部以弧度/秒处理，但最终报告的峰位必须以赫兹为单位。使用科学上合理的参数，并确保物理一致性。\n\n模拟参数（除非另有说明，否则在所有测试用例中共享）：\n- 时间点数 $N=8192$。\n- 时间步长 $\\Delta t = 2.0\\times 10^{-4}\\ \\text{s}$ （即采样率 $f_s=5000\\ \\text{Hz}$）。\n- 切趾窗函数常数 $T_2^{\\text{win}} = 0.4\\ \\text{s}$。\n\n实现以下包含四组不同参数集的测试套件，每组参数以 $(\\Delta\\nu_A,\\Delta\\nu_X,J,\\omega_1)$ 的形式给出，单位均为赫兹：\n1. $(30.0,\\ 120.0,\\ 14.0,\\ 0.0)$: 无辐照（预期为基线双峰）。\n2. $(0.0,\\ 120.0,\\ 14.0,\\ 200.0)$: 对 $A$ 进行强共振辐照（预期发生去偶）。\n3. $(40.0,\\ 120.0,\\ 14.0,\\ 40.0)$: 离共振中等强度辐照（部分去偶）。\n4. $(0.0,\\ 120.0,\\ 14.0,\\ 2.0)$: 极弱辐照（接近基线双峰）。\n\n寻峰要求：\n- 仅考虑正频率（即 $\\nu \\ge 0$）。\n- 使用最大谱振幅 $0.25$ 倍的相对振幅阈值来保留谱峰。\n- 通过将每个点与其紧邻的点进行比较来识别局部最大值。\n- 报告每个案例中保留的峰值频率的排序列表，单位为赫兹，四舍五入到一位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素本身是对应测试用例检测到的峰值频率列表。例如：“[[f11,f12],[f21],[f31,f32],[f41,f42]]”，其中所有 $f_{ij}$ 都是以赫兹为单位并四舍五入到一位小数的浮点数。", "solution": "用户要求基于刘维尔-冯·诺依曼方程实现选择性自旋去偶实验的数值模拟，这是一个在计算化学和物理学中有效且适定的问题。该问题在科学上基于核磁共振 (NMR) 波谱学和量子动力学的原理。它提供了所有必要的参数、方程和一个明确的目标，从而可以得出一个唯一且可验证的解。\n\n### 1. 理论框架：双自旋系统的量子动力学\n\n模拟基于系统密度矩阵 $\\rho(t)$ 的时间演化，该演化由刘维尔-冯·诺依曼方程（其中 $\\hbar=1$）决定：\n$$\n\\frac{d\\rho(t)}{dt} = -i[\\hat{H}(t), \\rho(t)]\n$$\n对于一个不含时哈密顿量 $\\hat{H}$，其解由密度矩阵在幺正变换下的演化给出：\n$$\n\\rho(t) = \\hat{U}(t) \\rho(0) \\hat{U}(t)^\\dagger , \\quad \\text{where} \\quad \\hat{U}(t) = \\exp(-i\\hat{H}t)\n$$\n该问题设置在一个双旋转坐标系中，此坐标系下哈密顿量不含时，从而简化了数值积分。我们以离散时间步长 $\\Delta t$ 演化该系统，单步传播子为 $\\hat{U} = \\exp(-i\\hat{H}\\Delta t)$。\n\n### 2. 实现步骤\n\n#### 2.1. 基矢与自旋算符\n系统由两个自旋1/2的粒子 $A$ 和 $X$ 组成。希尔伯特空间是一个 $4$ 维复向量空间，由单个自旋空间的张量积构成，即 $\\mathcal{H} = \\mathcal{H}_A \\otimes \\mathcal{H}_X$。我们使用标准乘积基 $\\{|\\alpha_A\\alpha_X\\rangle, |\\alpha_A\\beta_X\\rangle, |\\beta_A\\alpha_X\\rangle, |\\beta_A\\beta_X\\rangle\\}$。\n\n自旋算符被构建为 $4 \\times 4$ 矩阵。它们基于 Pauli 矩阵 $\\hat{\\sigma}_\\alpha$ 和 $2 \\times 2$ 单位矩阵 $\\hat{\\mathbb{1}}$ 定义：\n$$\n\\hat{\\sigma}_x = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad \\hat{\\sigma}_y = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}, \\quad \\hat{\\sigma}_z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad \\hat{\\mathbb{1}} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n自旋角动量算符为 $\\hat{I}_\\alpha = \\frac{1}{2}\\hat{\\sigma}_\\alpha$。双自旋系统的算符则使用克罗内克积 ($\\otimes$) 构建：\n$$\n\\hat{I}_\\alpha^{(A)} = \\hat{I}_\\alpha \\otimes \\hat{\\mathbb{1}}, \\quad \\hat{I}_\\alpha^{(X)} = \\hat{\\mathbb{1}} \\otimes \\hat{I}_\\alpha\n$$\n例如，$\\hat{I}_z^{(A)} = \\frac{1}{2}\\hat{\\sigma}_z \\otimes \\hat{\\mathbb{1}}$ 和 $\\hat{I}_x^{(X)} = \\hat{\\mathbb{1}} \\otimes \\frac{1}{2}\\hat{\\sigma}_x$。\n\n#### 2.2. 哈密顿量构建\n对于每个具有参数 $(\\Delta\\nu_A, \\Delta\\nu_X, J, \\omega_1)$ 的测试用例，构建哈密顿矩阵。输入参数的单位是赫兹 (Hz)，因此必须通过乘以 $2\\pi$ 将其转换为角频率（弧度/秒）。哈密顿量为：\n$$\n\\hat{H} = 2\\pi\\Delta\\nu_A \\hat{I}_z^{(A)} + 2\\pi\\Delta\\nu_X \\hat{I}_z^{(X)} + 2\\pi J \\hat{I}_z^{(A)}\\hat{I}_z^{(X)} + 2\\pi\\omega_1 \\hat{I}_x^{(A)}\n$$\n这个矩阵将是一个 $4 \\times 4$ 的厄米矩阵。\n\n#### 2.3. 初始状态制备\n系统从热平衡状态开始，此时密度矩阵与沿 z 轴的净磁化强度成正比。问题指定观测自旋 $X$，因此我们只考虑它的贡献： $\\rho_{\\text{eq}} \\propto \\hat{I}_z^{(X)}$。对自旋 $X$ 施加一个沿旋转坐标系 y 轴的理想 $90^\\circ$ 脉冲。该脉冲将磁化强度从 z 轴旋转到 x 轴。用于演化的初始状态 $\\rho(0)$ 通过应用旋转超算符获得：\n$$\n\\rho(0) = \\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right) \\rho_{\\text{eq}} \\left(\\hat{R}_y^{(X)}\\left(\\frac{\\pi}{2}\\right)\\right)^\\dagger\n$$\n其中 $\\hat{R}_y^{(X)}(\\theta) = \\exp(-i\\theta\\hat{I}_y^{(X)})$。此旋转对算符 $\\hat{I}_z^{(X)}$ 的作用是将其转换为 $-\\hat{I}_x^{(X)}$。由于整体符号和比例常数不影响最终谱图中的峰位，我们可以将初始状态简化为 $\\rho(0) = \\hat{I}_x^{(X)}$。\n\n#### 2.4. 时间演化与信号检测\n时间演化以 $\\Delta t$ 的时长进行 $N$ 步迭代模拟。\n1.  **传播子计算**：使用矩阵指数函数（例如 `scipy.linalg.expm`）一次性计算出单个时间步长的幺正传播子 $\\hat{U} = \\exp(-i\\hat{H}\\Delta t)$。\n2.  **迭代演化**：从 $\\rho_0 = \\rho(0)$ 开始，每个后续状态计算为 $\\rho_{k+1} = \\hat{U}\\rho_k\\hat{U}^\\dagger$。\n3.  **信号计算**：在每个时间步 $t_k = k \\Delta t$，计算复数自由感应衰减 (FID) 信号 $s(t_k)$。这对应于自旋 $X$ 的横向升算符 $\\hat{I}_+^{(X)} = \\hat{I}_x^{(X)} + i\\hat{I}_y^{(X)}$ 的期望值：\n    $$\n    s(t_k) = \\operatorname{Tr}\\left[\\rho(t_k)\\left(\\hat{I}_x^{(X)} + i\\hat{I}_y^{(X)}\\right)\\right]\n    $$\n这个过程产生一个长度为 $N$ 的复值时域信号 $s(t)$。\n\n#### 2.5. 谱分析与寻峰\n1.  **切趾处理**：将计算出的 FID $s(t)$ 乘以一个指数窗函数 $\\exp(-t/T_2^{\\text{win}})$，以减少有限采集时间带来的截断伪影，并模拟逼真的洛伦兹线型展宽。\n2.  **傅里叶变换**：对经过切趾处理的 FID 进行离散傅里叶变换 (DFT)，将信号从时域转换到频域，从而得到谱图。使用 `fftshift` 函数将零频率置于结果数组的中心。\n3.  **频率轴**：生成相应的频率轴。对于一个有 $N$ 个点且时间步长为 $\\Delta t$ 的信号，频率范围从 $-f_s/2$ 到 $f_s/2$，其中 $f_s=1/\\Delta t$ 是采样频率。\n4.  **寻峰**：\n    *   分析仅限于谱的正频率部分（$\\nu \\ge 0$）。\n    *   取复数谱的模（绝对值）以获得振幅谱。\n    *   如果在频率 $\\nu_p$ 处的谱振幅是局部最大值（即大于其紧邻的两个点）并且超过正频率区域最大振幅的 $0.25$ 倍，则在该频率处识别出一个峰。\n    *   收集所有检测到的此类峰的频率，按要求排序并四舍五入到一位小数。\n\n将此完整过程应用于问题陈述中指定的四个测试用例，以生成最终结果。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Simulates a selective spin decoupling experiment for a two-spin 1/2 AX system.\n    \"\"\"\n    \n    # --- Simulation Parameters ---\n    N = 8192  # Number of time points\n    dt = 2.0e-4  # Time step in seconds\n    T2_win = 0.4  # Apodization window constant in seconds\n    \n    # --- Test Cases (d_nu_A, d_nu_X, J, omega_1) in Hz ---\n    test_cases = [\n        (30.0, 120.0, 14.0, 0.0),   # Case 1: No irradiation\n        (0.0, 120.0, 14.0, 200.0),  # Case 2: Strong on-resonance irradiation\n        (40.0, 120.0, 14.0, 40.0),   # Case 3: Off-resonance moderate irradiation\n        (0.0, 120.0, 14.0, 2.0),    # Case 4: Weak on-resonance irradiation\n    ]\n\n    # --- Define Spin Operators ---\n    # Pauli matrices (as I = 1/2 * sigma)\n    I_x = 0.5 * np.array([[0, 1], [1, 0]], dtype=np.complex128)\n    I_y = 0.5 * np.array([[0, -1j], [1j, 0]], dtype=np.complex128)\n    I_z = 0.5 * np.array([[1, 0], [0, -1]], dtype=np.complex128)\n    Id = np.identity(2, dtype=np.complex128)\n\n    # Two-spin operators using Kronecker product\n    I_x_A = np.kron(I_x, Id)\n    I_y_A = np.kron(I_y, Id)\n    I_z_A = np.kron(I_z, Id)\n    \n    I_x_X = np.kron(Id, I_x)\n    I_y_X = np.kron(Id, I_y)\n    I_z_X = np.kron(Id, I_z)\n\n    # Detection operator for spin X\n    I_plus_X = I_x_X + 1j * I_y_X\n\n    # --- Initial State ---\n    # rho(0) is proportional to I_x(X) after a 90-degree-y pulse on I_z(X)\n    rho_0 = I_x_X\n\n    # --- Time axis for apodization ---\n    time_axis = np.arange(N) * dt\n    apodization_window = np.exp(-time_axis / T2_win)\n\n    # --- Frequency axis for spectrum ---\n    freq_axis = np.fft.fftshift(np.fft.fftfreq(N, d=dt))\n    \n    all_results = []\n\n    for case in test_cases:\n        d_nu_A, d_nu_X, J, omega_1 = case\n        \n        # --- Construct Hamiltonian (in rad/s) ---\n        H = (2 * np.pi * d_nu_A * I_z_A +\n             2 * np.pi * d_nu_X * I_z_X +\n             2 * np.pi * J * np.dot(I_z_A, I_z_X) +\n             2 * np.pi * omega_1 * I_x_A)\n\n        # --- Calculate Propagator ---\n        U = expm(-1j * H * dt)\n        U_dagger = U.conj().T\n\n        # --- Time Evolution and FID Calculation ---\n        fid = np.zeros(N, dtype=np.complex128)\n        rho_current = rho_0.copy()\n        \n        for k in range(N):\n            # Calculate observable for current time step\n            fid[k] = np.trace(np.dot(rho_current, I_plus_X))\n            # Evolve density matrix for next time step\n            rho_current = np.dot(U, np.dot(rho_current, U_dagger))\n\n        # --- Signal Processing ---\n        # Apply apodization\n        fid_apodized = fid * apodization_window\n        \n        # Fourier transform\n        spectrum = np.fft.fftshift(np.fft.fft(fid_apodized))\n        amplitudes = np.abs(spectrum)\n\n        # --- Peak Picking ---\n        # Consider only positive frequencies\n        pos_freq_mask = freq_axis >= 0\n        pos_freqs = freq_axis[pos_freq_mask]\n        pos_amps = amplitudes[pos_freq_mask]\n        \n        if pos_amps.size == 0:\n            all_results.append([])\n            continue\n\n        max_amplitude = np.max(pos_amps)\n        threshold = 0.25 * max_amplitude\n        \n        peak_frequencies = []\n        # Find local maxima above threshold\n        for i in range(1, len(pos_amps) - 1):\n            if pos_amps[i] > threshold and pos_amps[i] > pos_amps[i-1] and pos_amps[i] > pos_amps[i+1]:\n                peak_frequencies.append(pos_freqs[i])\n        \n        # Round and sort results for the current case\n        rounded_peaks = sorted([round(f, 1) for f in peak_frequencies])\n        all_results.append(rounded_peaks)\n\n    # --- Final Output Formatting ---\n    # Using str() on a list of lists and removing spaces for exact format\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "3723368"}]}