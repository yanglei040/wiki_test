{"hands_on_practices": [{"introduction": "在密度泛函理论（DFT）计算中，一个核心步骤是选择交换相关泛函。本练习旨在通过一个量化模型，帮助您理解为何这一选择至关重要，特别是混合泛函中精确交换成分的比例如何系统性地影响预测的振动频率。通过这个实践[@problem_id:3698588]，您将清晰地看到理论概念（如自相互作用误差）与实际可观测的谱学特性之间的联系。", "problem": "您的任务是设计并实现一个程序，该程序通过从坚实的物理原理出发，对不同密度泛函理论(DFT)交换相关近似下的红外(IR)羰基伸缩振动频率进行预测建模。请使用Born-Oppenheimer近似和势能面极小点附近的谐振子近似作为您的基本出发点，并基于力常数（定义为势能相对于键长位移的曲率）以及振动频率与折合质量之间的关系进行推导。您的目标是构建一个定量模型，该模型能够捕捉由自相互作用误差引起的系统性过结合，以及杂化泛函中一部分精确交换对该误差的缓解作用。该程序必须计算并比较羰基在以下泛函下的红外波数（单位为$\\mathrm{cm}^{-1}$）：Perdew–Burke–Ernzerhof (PBE)、Becke, $3$-parameter, Lee–Yang–Parr (B3LYP)和PBE0，并额外报告两个边界情况下的值以测试模型行为。\n\n需使用的建模指令和常数：\n- 假设单个羰基键被视为一个双原子振子，其中碳的质量为$12$原子质量单位（atomic mass unit (amu)），氧的质量为$16$原子质量单位。\n- 使用原子质量单位$1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$。\n- 使用光速$c = 2.99792458\\times 10^{10}\\,\\mathrm{cm/s}$。\n- 取参考（目标，无自相互作用误差）羰基波数为$\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$，该值代表了在没有系统性过结合的情况下，典型有机羰基的伸缩振动频率。\n- 定义碳和氧的折合质量$\\mu$，并从这些基础出发，通过适当的推导，将预测的谐振波数$\\tilde{\\nu}$与力常数曲率$k$和$\\mu$联系起来。\n- 通过一个单调递减的偏置项来模拟精确交换分数$\\alpha$对曲率的影响，该偏置项代表当$\\alpha = 0$时的残余过结合，并随着$\\alpha$的增加而减小。使用以下形式的曲率模型：\n  - $k(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\dfrac{\\alpha}{\\alpha_{0}}\\right)\\right]$,\n  其中$k_{\\mathrm{ref}}$是与$\\tilde{\\nu}_{\\mathrm{ref}}$一致的曲率，$\\delta_{0} = 0.12$是零精确交换时的分数过结合幅度，$\\alpha_{0} = 0.10$表征了随精确交换增加而发生的衰减。\n- 计算以下精确交换分数$\\alpha$测试组的预测红外波数（单位为$\\mathrm{cm}^{-1}$）：\n  - PBE: $\\alpha = 0.00$\n  - B3LYP: $\\alpha = 0.20$\n  - PBE0: $\\alpha = 0.25$\n  - 边界情况（更高杂化成分）: $\\alpha = 0.50$\n  - 边界情况（类Hartree–Fock极限）: $\\alpha = 1.00$\n- 所有最终的波数结果均以$\\mathrm{cm}^{-1}$为单位表示，并四舍五入到一位小数。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\dots]$）。该列表必须完全按照上述指定顺序包含为测试组计算的五个波数。不应打印任何其他文本。", "solution": "所述问题具有坚实的科学基础，提法严谨且内部一致。所有必需的物理常数、模型参数和理论框架都已提供，以构建一个唯一的、可验证的解决方案。其底层模型是一个基于物理动机的、尽管是唯象的表示，用于描述密度泛函理论(DFT)中自相互作用误差对振动频率的影响，这是计算化学中的一个标准课题。因此，该问题是有效的，可以构建解决方案。\n\n目标是计算在不同DFT交换相关泛函下，羰基（被建模为双原子谐振子）的预测红外(IR)伸缩振动波数$\\tilde{\\nu}$。每个泛函的影响由其精确交换的分数$\\alpha$来参数化。\n\n分析始于谐振子的基本关系式。角频率$\\omega$与力常数$k$（势能面的曲率）和折合质量$\\mu$的关系如下：\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n振动频率$\\nu$为$\\nu = \\omega / (2\\pi)$。在波谱学中，通常使用波数$\\tilde{\\nu}$，其定义为$\\tilde{\\nu} = \\nu/c$，其中$c$是光速。结合这些定义，得到振动波数的核心方程：\n$$\n\\tilde{\\nu} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}}\n$$\n问题将羰基(C=O)建模为一个双原子体系。给定的质量为$m_C = 12\\,\\mathrm{amu}$和$m_O = 16\\,\\mathrm{amu}$。折合质量$\\mu$计算如下：\n$$\n\\mu = \\frac{m_C m_O}{m_C + m_O} = \\frac{(12\\,\\mathrm{amu})(16\\,\\mathrm{amu})}{12\\,\\mathrm{amu} + 16\\,\\mathrm{amu}} = \\frac{192}{28}\\,\\mathrm{amu} = \\frac{48}{7}\\,\\mathrm{amu}\n$$\n虽然题目给出了将原子质量单位转换为千克的常数（$1\\,\\mathrm{amu} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$），但我们可以通过首先确定与指定参考波数$\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$相对应的参考力常数$k_{\\mathrm{ref}}$，来设计一个更为简洁的解法。该参考值代表了理想的、无自相互作用误差的结果。\n\n重排波数方程，我们可以用力常数$k$来表示$\\tilde{\\nu}$、$c$和$\\mu$：\n$$\nk = (2\\pi c \\tilde{\\nu})^2 \\mu\n$$\n因此，参考力常数为：\n$$\nk_{\\mathrm{ref}} = (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2 \\mu\n$$\n问题假设了一个关于预测力常数$k(\\alpha)$的模型，该模型是精确交换分数$\\alpha$的函数。此模型捕捉了与纯广义梯度近似(GGA)泛函（其中$\\alpha=0$）相关的系统性过结合（即更大的力常数），以及随着精确交换的混入其减小的趋势：\n$$\nk(\\alpha) = k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]\n$$\n此处，$\\delta_{0} = 0.12$代表在$\\alpha=0$时力常数的分数高估值，而$\\alpha_{0} = 0.10$是一个衰减常数，表征了这种高估随$\\alpha$增加被修正的速度。\n\n现在，通过将$k(\\alpha)$的表达式代入基本波数方程，可以写出预测的波数$\\tilde{\\nu}(\\alpha)$：\n$$\n\\tilde{\\nu}(\\alpha) = \\frac{1}{2\\pi c}\\sqrt{\\frac{k(\\alpha)}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}\\left[1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)\\right]}{\\mu}}\n$$\n我们可以将此表达式分解为：\n$$\n\\tilde{\\nu}(\\alpha) = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\n根据定义，括号中的项即为参考波数$\\tilde{\\nu}_{\\mathrm{ref}}$。这导出了一个简化的、计算上直接的最终表达式，它巧妙地避免了以千克为单位显式计算$\\mu$或以国际单位制(SI)计算$k_{\\mathrm{ref}}$的需要：\n$$\n\\tilde{\\nu}(\\alpha) = \\tilde{\\nu}_{\\mathrm{ref}} \\sqrt{1 + \\delta_{0}\\exp\\!\\left(-\\frac{\\alpha}{\\alpha_{0}}\\right)}\n$$\n使用给定的值$\\tilde{\\nu}_{\\mathrm{ref}} = 1715\\,\\mathrm{cm}^{-1}$、$\\delta_{0} = 0.12$和$\\alpha_{0} = 0.10$，我们可以计算指定$\\alpha$值测试组的波数。\n\n测试组为：\n1.  PBE: $\\alpha = 0.00$\n    $$\n    \\tilde{\\nu}(0.00) = 1715 \\sqrt{1 + 0.12 \\exp(0)} = 1715 \\sqrt{1.12} \\approx 1815.018\\,\\mathrm{cm}^{-1}\n    $$\n2.  B3LYP: $\\alpha = 0.20$\n    $$\n    \\tilde{\\nu}(0.20) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.20}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2}} \\approx 1728.828\\,\\mathrm{cm}^{-1}\n    $$\n3.  PBE0: $\\alpha = 0.25$\n    $$\n    \\tilde{\\nu}(0.25) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.25}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-2.5}} \\approx 1723.411\\,\\mathrm{cm}^{-1}\n    $$\n4.  边界情况（更高杂化成分）: $\\alpha = 0.50$\n    $$\n    \\tilde{\\nu}(0.50) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{0.50}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-5}} \\approx 1715.693\\,\\mathrm{cm}^{-1}\n    $$\n5.  边界情况（类Hartree-Fock极限）: $\\alpha = 1.00$\n    $$\n    \\tilde{\\nu}(1.00) = 1715 \\sqrt{1 + 0.12 \\exp\\left(-\\frac{1.00}{0.10}\\right)} = 1715 \\sqrt{1 + 0.12 e^{-10}} \\approx 1715.005\\,\\mathrm{cm}^{-1}\n    $$\n这些结果必须为最终输出四舍五入到一位小数。以下程序实现了此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted IR wavenumbers for a carbonyl group based on a model\n    of DFT self-interaction error as a function of exact exchange fraction.\n    \"\"\"\n    \n    # Define model parameters and the reference value from the problem statement.\n    nu_ref_cm_inv = 1715.0  # Reference wavenumber in cm^-1\n    delta_0 = 0.12          # Zero-exchange fractional overbinding magnitude\n    alpha_0 = 0.10          # Decay constant for exact exchange correction\n\n    # Define the test suite of exact exchange fractions (alpha)\n    # The order corresponds to PBE, B3LYP, PBE0, high-hybrid, HF-limit.\n    alpha_values = [\n        0.00,  # PBE\n        0.20,  # B3LYP\n        0.25,  # PBE0\n        0.50,  # Boundary case 1\n        1.00   # Boundary case 2\n    ]\n\n    results = []\n    \n    # The core model equation relates the predicted wavenumber to the reference\n    # wavenumber and the fraction of exact exchange, alpha.\n    # nu_pred(alpha) = nu_ref * sqrt(1 + delta_0 * exp(-alpha / alpha_0))\n    for alpha in alpha_values:\n        # Calculate the argument of the square root\n        correction_term = delta_0 * np.exp(-alpha / alpha_0)\n        \n        # Calculate the predicted wavenumber\n        nu_pred = nu_ref_cm_inv * np.sqrt(1 + correction_term)\n        \n        # Round the result to one decimal place as required\n        rounded_result = round(nu_pred, 1)\n        results.append(rounded_result)\n\n    # Format the final output as a comma-separated list in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "3698588"}, {"introduction": "除了泛函之外，基组的选择是DFT计算中的另一个关键决策。本练习[@problem_id:3698611]将探讨基组的完备性如何影响光谱预测的准确性。您将通过一个简化的误差模型，分析基组的缺陷如何独立地导致振动频率和红外强度的计算误差，从而体会为获得可靠结果而选择合适基组的重要性。", "problem": "您必须编写一个完整的程序，在谐波近似的框架内，使用两种不同的轨道基组比较预测的一氧化碳伸缩振动频率和红外强度，并在密度泛函理论 (DFT) 振动分析中，定量地归因与基组相关的误差的主要来源。该程序必须实现以下模型，为提供的测试套件计算所要求的量，并以指定的单行格式生成最终结果。\n\n使用以下基本和核心定义。\n\n1) Born–Oppenheimer 分离与谐波近似：在平衡键长附近，双原子分子的势能近似为键位移坐标的二次函数。在平衡几何构型下评估的 Hessian 矩阵（势能对键长的二阶导数）即为力常数。在谐波近似下，振动角频率由下式给出\n$$\\omega = \\sqrt{\\frac{k}{\\mu}},$$\n其中 $k$ 是谐波力常数，$\\mu$ 是折合质量。\n\n2) 波数转换：可观测的谐波波数（以倒易厘米为单位）为\n$$\\tilde{\\nu} = \\frac{\\omega}{2\\pi c} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}},$$\n其中 $c$ 是以 $\\mathrm{cm\\,s^{-1}}$ 为单位的光速。所有波数都必须以 $\\mathrm{cm^{-1}}$ 表示。\n\n3) 双谐波近似下的红外 (IR) 强度：基频振动跃迁的积分强度与永久偶极矩对简正坐标的导数的平方成正比。对于具有单一简正模式的双原子分子，质量加权的简正坐标 $Q$ 通过 $Q=\\sqrt{\\mu}\\,\\Delta r$（相差一个不重要的相位）与键长 $r$ 相关。因此，\n$$\\left(\\frac{\\partial \\mu}{\\partial Q}\\right) = \\frac{1}{\\sqrt{\\mu}}\\left(\\frac{\\partial \\mu}{\\partial r}\\right),$$\n因此，在固定的 $\\mu$ 下，红外强度的任何基组误差都源于 $\\partial\\mu/\\partial r$ 的误差。为消除单位依赖性并确保目标值为无量纲，定义归一化红外强度为以下比率：\n$$I_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2,$$\n这是无量纲的。\n\n4) 基组误差模型：将基组不完备性误差表示为相对于一个固定的高水平参考值的力常数和偶极矩导数的相对微扰：\n$$k_{\\mathrm{pred}} = k_{\\mathrm{ref}}\\left(1 + \\delta_k\\right),\\qquad \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{pred}} = \\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}}\\left(1 + \\delta_d\\right),$$\n其中 $\\delta_k$ 和 $\\delta_d$ 是与所选基组相关的无量纲相对误差。\n\n所有计算中要使用的常数和参考值：\n\n- 原子质量单位：$u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$。\n- 原子质量：$m_{\\mathrm{C}} = 12.000000\\ u$，$m_{\\mathrm{O}} = 15.99491461957\\ u$。\n- 折合质量：$\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$，单位为 $\\mathrm{kg}$。\n- 光速：$c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$。\n- 参考 CO 谐波波数：$\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$。\n- 由波数和折合质量隐式定义的参考力常数：\n$$k_{\\mathrm{ref}} = \\mu \\left(2\\pi c \\tilde{\\nu}_{\\mathrm{ref}}\\right)^2\\ \\mathrm{N\\,m^{-1}}.$$\n- 参考偶极矩导数（为使模型完整，此值在归一化强度中被抵消）：$\\left(\\frac{\\partial \\mu}{\\partial r}\\right)_{\\mathrm{ref}} = 0.20$（单位为一致的任意单位）；仅使用比率。\n\n对于给定的配对 $\\left(\\delta_k,\\delta_d\\right)$，计算：\n- 预测的谐波波数，以倒易厘米为单位，\n$$\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}},$$\n四舍五入到小数点后两位，并以 $\\mathrm{cm^{-1}}$ 表示。\n- 归一化红外强度 $I_{\\mathrm{rel}}=\\left(1+\\delta_d\\right)^2$，四舍五入到小数点后五位（无量纲）。\n- 绝对波数误差 $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$，以 $\\mathrm{cm^{-1}}$ 为单位，四舍五入到小数点后两位。\n- 绝对归一化强度偏差 $|I_{\\mathrm{rel}}-1|$（无量纲），四舍五入到小数点后五位。\n\n为确定每个可观测量与基组相关的误差的主要来源，将总误差分解为分别微扰每个主要物理量所产生的贡献：\n- 频率敏感度：计算仅微扰 $k$ 时的波数 $\\tilde{\\nu}_{k\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}$，以及仅微扰 $\\partial\\mu/\\partial r$ 时的波数 $\\tilde{\\nu}_{d\\text{-only}}=\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}=\\tilde{\\nu}_{\\mathrm{ref}}$。定义贡献量 $\\Delta\\tilde{\\nu}_{k}=|\\tilde{\\nu}_{k\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ 和 $\\Delta\\tilde{\\nu}_{d}=|\\tilde{\\nu}_{d\\text{-only}}-\\tilde{\\nu}_{\\mathrm{ref}}|$，并设置一个布尔标志以判断力常数贡献是否占主导地位：$\\mathrm{isKdom} = \\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d}$。\n- 强度敏感度：计算 $I_{\\mathrm{rel},k\\text{-only}}=1$ 和 $I_{\\mathrm{rel},d\\text{-only}}=\\left(1+\\delta_d\\right)^2$，然后定义 $\\Delta I_k=|I_{\\mathrm{rel},k\\text{-only}}-1|$ 和 $\\Delta I_d=|I_{\\mathrm{rel},d\\text{-only}}-1|$，并设置一个布尔标志以判断偶极矩导数贡献是否占主导地位：$\\mathrm{isDdom} = \\Delta I_d \\ge \\Delta I_k$。\n\n测试套件。评估以下五个案例：\n- 案例 1 (6-31G(d)): $\\delta_k=-0.05$, $\\delta_d=-0.10$。\n- 案例 2 (相关一致性极化价三重zeta, cc-pVTZ): $\\delta_k=-0.01$, $\\delta_d=-0.03$。\n- 案例 3 (理想/无误差): $\\delta_k=0.00$, $\\delta_d=0.00$。\n- 案例 4 (仅力常数误差): $\\delta_k=+0.02$, $\\delta_d=0.00$。\n- 案例 5 (仅偶极矩导数误差): $\\delta_k=0.00$, $\\delta_d=+0.15$。\n\n此外，通过提供绝对误差的比率，报告案例1和案例2中两种基组之间的定量比较：\n- 绝对波数误差的比率，$R_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|}$，四舍五入到小数点后五位。\n- 绝对归一化强度偏差的比率，$R_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|}$，四舍五入到小数点后五位。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个列表，其元素按顺序为五个案例各自的结果，后跟包含两个元素的比较列表。每个案例的结果本身必须是一个包含六个条目的列表，顺序如下：\n[$\\tilde{\\nu}_{\\mathrm{pred}}$ (单位 $\\mathrm{cm^{-1}}$，保留两位小数), $I_{\\mathrm{rel}}$ (保留五位小数), $|\\tilde{\\nu}_{\\mathrm{pred}}-\\tilde{\\nu}_{\\mathrm{ref}}|$ (单位 $\\mathrm{cm^{-1}}$，保留两位小数), $|I_{\\mathrm{rel}}-1|$ (保留五位小数), $\\mathrm{isKdom}$ (布尔值), $\\mathrm{isDdom}$ (布尔值)]。\n\n具体来说，打印的行应看起来像一个有效的、带有嵌套方括号的逗号分隔列表，例如：\n[[nu1,I1,dnu1,dI1,True,True],[nu2,I2,dnu2,dI2,True,True],...,[Rnu,RI]]\n\n所有波数都必须以 $\\mathrm{cm^{-1}}$ 为单位，并四舍五入到小数点后两位。所有归一化强度和比率都必须是无量纲小数，并四舍五入到小数点后五位。不使用角度。百分比必须表示为小数（例如，百分之十表示为 0.10）。不应打印任何额外文本。", "solution": "用户提供了一个定义明确的计算问题，该问题基于理论光谱学的原理。该问题在科学上是合理的、自洽的，并要求实现一个清晰的物理模型。所有必要的常数、参考值和解析表达式均已提供。目标明确，可以计算出唯一且可验证的解。因此，该问题被认为是有效的。\n\n解决方案首先建立必要的物理常数和派生的参考值。随后，对于每个指定的基组误差参数 $(\\delta_k, \\delta_d)$ 案例，计算一系列量：预测的振动波数、归一化的红外强度、它们各自与参考值的偏差，以及指示每个可观测量主要误差来源的标志。最后，对两个特定基组之间的误差进行定量比较。\n\n首先，我们定义物理常数和参考值。\n原子质量单位为 $u = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$。\n原子质量为 $m_{\\mathrm{C}} = 12.000000\\ u$ 和 $m_{\\mathrm{O}} = 15.99491461957\\ u$。\n一氧化碳分子的折合质量 $\\mu$ 计算如下：\n$$\n\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}} = \\frac{(12.000000)(15.99491461957)}{12.000000 + 15.99491461957} u \\approx 6.856209\\ u\n$$\n转换为国际单位制 (SI units)，$\\mu \\approx 1.138500 \\times 10^{-26}\\ \\mathrm{kg}$。\n光速为 $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$。\n参考谐波波数为 $\\tilde{\\nu}_{\\mathrm{ref}} = 2143.27\\ \\mathrm{cm^{-1}}$。\n\n参考力常数 $k_{\\mathrm{ref}}$ 由谐振子模型隐式定义：\n$$\n\\tilde{\\nu}_{\\mathrm{ref}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\n$$\n解出 $k_{\\mathrm{ref}}$ 得 $k_{\\mathrm{ref}} = \\mu (2\\pi c \\tilde{\\nu}_{\\mathrm{ref}})^2$。虽然这个值可以进行数值计算，但如下所示，使用比率来处理更为简洁和精确。\n\n问题的核心在于评估相对误差 $\\delta_k$ 和 $\\delta_d$ 对预测的可观测量的影响。预测的力常数为 $k_{\\mathrm{pred}} = k_{\\mathrm{ref}}(1 + \\delta_k)$。\n\n预测的谐波波数 $\\tilde{\\nu}_{\\mathrm{pred}}$ 由下式给出：\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{pred}}}{\\mu}} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}(1+\\delta_k)}{\\mu}}\n$$\n通过代入 $\\tilde{\\nu}_{\\mathrm{ref}}$ 的表达式，上式可简化为：\n$$\n\\tilde{\\nu}_{\\mathrm{pred}} = \\left(\\frac{1}{2\\pi c}\\sqrt{\\frac{k_{\\mathrm{ref}}}{\\mu}}\\right) \\sqrt{1+\\delta_k} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}\n$$\n这种简化形式避免了对 $k_{\\mathrm{ref}}$ 和 $\\mu$ 的显式计算，从而降低了浮点精度损失的风险。\n\n预测的归一化红外强度 $I_{\\mathrm{rel}}$ 取决于偶极矩导数的相对误差 $\\delta_d$：\n$$\nI_{\\mathrm{rel}} = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{pred}}}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = \\left(\\frac{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}(1+\\delta_d)}{(\\partial\\mu/\\partial r)_{\\mathrm{ref}}}\\right)^2 = (1+\\delta_d)^2\n$$\n\n对于每个案例，我们必须计算四个主要量：\n1. 预测波数 $\\tilde{\\nu}_{\\mathrm{pred}}$，四舍五入到小数点后两位。\n2. 归一化红外强度 $I_{\\mathrm{rel}}$，四舍五入到小数点后五位。\n3. 绝对波数误差 $|\\tilde{\\nu}_{\\mathrm{pred}} - \\tilde{\\nu}_{\\mathrm{ref}}|$，四舍五入到小数点后两位。\n4. 绝对归一化强度偏差 $|I_{\\mathrm{rel}}-1|$，四舍五入到小数点后五位。\n\n接下来，我们进行敏感度分析。目标是确定力常数 ($k$) 的误差还是偶极矩导数 ($d$) 的误差是每个可观测量的主要误差来源。\n\n对于波数，误差贡献定义为：\n$\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{k\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$，其中 $\\tilde{\\nu}_{k\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k}$。\n$\\Delta\\tilde{\\nu}_{d} = |\\tilde{\\nu}_{d\\text{-only}} - \\tilde{\\nu}_{\\mathrm{ref}}|$，其中 $\\tilde{\\nu}_{d\\text{-only}} = \\tilde{\\nu}_{\\mathrm{ref}}$。\n因此，$\\Delta\\tilde{\\nu}_{k} = |\\tilde{\\nu}_{\\mathrm{ref}}\\sqrt{1+\\delta_k} - \\tilde{\\nu}_{\\mathrm{ref}}|$ 且 $\\Delta\\tilde{\\nu}_{d} = 0$。\n布尔标志为 $\\mathrm{isKdom} = (\\Delta\\tilde{\\nu}_{k} \\ge \\Delta\\tilde{\\nu}_{d})$。由于 $\\Delta\\tilde{\\nu}_{k}$ 是一个绝对值，因此总是非负的，而 $\\Delta\\tilde{\\nu}_{d}$ 总是 $0$，所以这个条件总是为真。这正确地反映了在这个解耦模型中，只有力常数影响频率。\n\n对于归一化强度，误差贡献为：\n$\\Delta I_k = |I_{\\mathrm{rel},k\\text{-only}}-1|$，其中 $I_{\\mathrm{rel},k\\text{-only}} = (1+0)^2=1$。\n$\\Delta I_d = |I_{\\mathrm{rel},d\\text{-only}}-1|$，其中 $I_{\\mathrm{rel},d\\text{-only}} = (1+\\delta_d)^2$。\n因此，$\\Delta I_k = 0$ 且 $\\Delta I_d = |(1+\\delta_d)^2 - 1|$。\n布尔标志为 $\\mathrm{isDdom} = (\\Delta I_d \\ge \\Delta I_k)$。由于 $\\Delta I_d$ 是一个绝对值，因此总是非负的，而 $\\Delta I_k$ 总是 $0$，所以这个条件也总是为真。这正确地反映了在此模型中，只有偶极矩导数影响红外强度。\n\n最后，我们计算案例1 $(\\delta_k^{(1)}, \\delta_d^{(1)})$ 与案例2 $(\\delta_k^{(2)}, \\delta_d^{(2)})$ 的绝对误差比率。\n绝对波数误差的比率为：\n$$\nR_{\\nu} = \\frac{|\\tilde{\\nu}_{\\mathrm{pred}}^{(1)} - \\tilde{\\nu}_{\\mathrm{ref}}|}{|\\tilde{\\nu}_{\\mathrm{pred}}^{(2)} - \\tilde{\\nu}_{\\mathrm{ref}}|} = \\frac{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(1)}} - 1|}{\\tilde{\\nu}_{\\mathrm{ref}}|\\sqrt{1+\\delta_k^{(2)}} - 1|} = \\frac{|\\sqrt{1+\\delta_k^{(1)}} - 1|}{|\\sqrt{1+\\delta_k^{(2)}} - 1|}\n$$\n绝对归一化强度偏差的比率为：\n$$\nR_{I} = \\frac{|I_{\\mathrm{rel}}^{(1)}-1|}{|I_{\\mathrm{rel}}^{(2)}-1|} = \\frac{|(1+\\delta_d^{(1)})^2-1|}{|(1+\\delta_d^{(2)})^2-1|}\n$$\n这些比率需四舍五入到小数点后五位。\n\n程序将对五个测试案例执行这些计算，为每个案例收集六个指定结果，计算两个最终的比率指标，并根据问题规范将所有结果格式化为单行输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted spectroscopic properties and error contributions for CO\n    based on a DFT error model.\n    \"\"\"\n    \n    # Define constants and reference values from the problem statement.\n    NU_REF_CM = 2143.27  # Reference wavenumber in cm^-1\n\n    # Define the test suite. Each tuple is (delta_k, delta_d).\n    test_cases = [\n        (-0.05, -0.10),   # Case 1: 6-31G(d)\n        (-0.01, -0.03),   # Case 2: cc-pVTZ\n        (0.00, 0.00),     # Case 3: Ideal/no error\n        (0.02, 0.00),     # Case 4: Force-constant-only error\n        (0.00, 0.15),     # Case 5: Dipole-derivative-only error\n    ]\n\n    all_case_results = []\n    case_abs_errors = []\n\n    for delta_k, delta_d in test_cases:\n        # --- Core Calculations ---\n        # The predicted wavenumber simplifies to nu_ref * sqrt(1 + delta_k).\n        nu_pred = NU_REF_CM * np.sqrt(1 + delta_k)\n        \n        # The normalized IR intensity.\n        i_rel = (1 + delta_d)**2\n        \n        # --- Error and Deviation Calculations ---\n        # Absolute wavenumber error.\n        d_nu = abs(nu_pred - NU_REF_CM)\n        \n        # Absolute normalized intensity deviation.\n        d_i = abs(i_rel - 1)\n        \n        # Store unrounded absolute errors for Cases 1 and 2 for the final ratio calculation.\n        case_abs_errors.append((d_nu, d_i))\n\n        # --- Sensitivity Analysis ---\n        # Wavenumber sensitivity.\n        # As derived, a change in dipole derivative (d) does not affect the wavenumber.\n        delta_nu_k = abs(NU_REF_CM * np.sqrt(1 + delta_k) - NU_REF_CM)\n        delta_nu_d = 0.0\n        is_k_dom = delta_nu_k >= delta_nu_d # Will always be True\n\n        # Intensity sensitivity.\n        # As derived, a change in force constant (k) does not affect the normalized intensity.\n        delta_i_k = 0.0\n        delta_i_d = abs((1 + delta_d)**2 - 1)\n        is_d_dom = delta_i_d >= delta_i_k # Will always be True\n\n        # --- Rounding for Output ---\n        nu_pred_rounded = round(nu_pred, 2)\n        i_rel_rounded = round(i_rel, 5)\n        d_nu_rounded = round(d_nu, 2)\n        d_i_rounded = round(d_i, 5)\n\n        # Collect results for the current case.\n        case_result = [\n            nu_pred_rounded, \n            i_rel_rounded, \n            d_nu_rounded, \n            d_i_rounded, \n            is_k_dom, \n            is_d_dom\n        ]\n        all_case_results.append(case_result)\n        \n    # --- Quantitative Comparison (Case 1 vs Case 2) ---\n    # Retrieve the unrounded absolute errors for Case 1 and Case 2.\n    d_nu1, d_i1 = case_abs_errors[0]\n    d_nu2, d_i2 = case_abs_errors[1]\n    \n    # Calculate ratios. Denominators are non-zero for Case 2.\n    r_nu = d_nu1 / d_nu2\n    r_i = d_i1 / d_i2\n    \n    # Round ratios and form the comparison list.\n    comparison_results = [round(r_nu, 5), round(r_i, 5)]\n\n    # --- Final Output Formatting ---\n    # Construct the final list containing all case results and the comparison.\n    final_list = all_case_results + [comparison_results]\n\n    # Convert each sublist to a string and remove spaces for compactness.\n    list_strs = [str(item).replace(\" \", \"\") for item in final_list]\n    \n    # Join the string representations of the lists with commas and enclose in brackets.\n    # The final element (comparison list) must be added after the case results.\n    # The f-string joins the first 5 elements and then appends the 6th.\n    case_strs = ','.join(list_strs[:-1])\n    comp_str = list_strs[-1]\n    final_output_string = f\"[{case_strs},{comp_str}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "3698611"}, {"introduction": "在理解了泛函和基组的影响之后，这个综合性练习将模拟一个典型的计算化学工作流程。本实践[@problem_id:3698598]指导您处理原始的DFT计算输出（如力常数和偶极矩导数），应用标准的经验校正因子来修正系统误差，并将最终的理论预测与实验数据进行比较。这将巩固您的理解：计算预测是分析和验证这一更大过程中的一个环节。", "problem": "您需要实现一个程序，该程序通过结合谐振近似和双谐波红外（IR）强度模型，来形式化密度泛函理论（DFT）预测醛的羰基伸缩谱带的工作流程，然后使用适用于杂化泛函和极化基组的频率标度因子与实验结果进行比较。完全在羰基的局域模式图像内进行工作，并假设核运动遵循 Born–Oppenheimer 近似和谐振近似。对 C=O 局域模式使用双原子折合质量模型，并通过分子偶极矩对沿 C=O 伸缩方向的质量加权简正坐标的导数来处理红外强度。该标度因子反映了众所周知的系统性问题，即杂化泛函和极化基组会高估谐振频率。您必须以明确指定的单位和指定的舍入方式生成结果。\n\n每个测试用例的输入参数如下：\n- 沿 C=O 伸缩坐标的谐波力常数 $k$，单位为 $\\mathrm{N\\ m^{-1}}$。\n- 碳和氧的原子质量 $m_{\\mathrm{C}}$ 和 $m_{\\mathrm{O}}$，单位均为原子质量单位 (amu)。\n- 偶极矩对 C=O 键长的导数 $\\mathrm{d}\\mu/\\mathrm{d}r$，单位为德拜每埃 $\\left(\\mathrm{D\\ \\AA^{-1}}\\right)$。\n- 适用于杂化泛函和极化基组的无量纲频率标度因子 $s$。\n- 实验测得的 C=O 伸缩波数 $\\tilde{\\nu}_{\\mathrm{exp}}$，单位为 $\\mathrm{cm^{-1}}$。\n\n您必须使用的常数：\n- 原子质量单位到千克的转换：$1\\ \\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$。\n- 光速：$c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$。\n- 双谐波近似中的红外强度转换：当 $\\partial \\mu/\\partial Q$ 以 $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$ 表示时，积分强度（单位为 $\\mathrm{km\\ mol^{-1}}$）为 $I = 42.255 \\left(\\partial \\mu/\\partial Q\\right)^{2}$。\n\n每个测试用例的任务：\n1. 使用谐振子关系式，即力常数和折合质量之间的关系，计算未标度的谐振 C=O 伸缩波数，单位为 $\\mathrm{cm^{-1}}$。然后应用标度因子 $s$ 获得标度后的预测波数 $\\tilde{\\nu}_{\\mathrm{scaled}}$，单位为 $\\mathrm{cm^{-1}}$。将最终波数表示为 $\\mathrm{cm^{-1}}$，并四舍五入到三位小数。\n2. 计算绝对偏差 $|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}|$，单位为 $\\mathrm{cm^{-1}}$，并四舍五入到三位小数。\n3. 将局域 C=O 伸缩简正坐标 $Q$ 视为由双原子折合质量（以 amu 为单位）进行质量加权，根据 $\\mathrm{d}\\mu/\\mathrm{d}r$ 和折合质量计算 $\\partial \\mu/\\partial Q$，然后计算红外强度 $I$，单位为 $\\mathrm{km\\ mol^{-1}}$，并四舍五入到三位小数。\n\n角度单位不适用。所有涉及物理量的答案必须以指定单位表示。您的程序必须为以下测试套件计算结果（每个元组列出 $(k,\\ m_{\\mathrm{C}},\\ m_{\\mathrm{O}},\\ \\mathrm{d}\\mu/\\mathrm{d}r,\\ s,\\ \\tilde{\\nu}_{\\mathrm{exp}})$）：\n\n- 案例 A（甲醛，杂化泛函与极化基组）：(1300.0, 12.000000, 15.999000, 7.0000, 0.9613, 1746.0)\n- 案例 B（$^{13}\\mathrm{C}$-甲醛同位素体，相同的电子结构级别）：(1300.0, 13.003355, 15.999000, 7.0000, 0.9613, 1710.0)\n- 案例 C（乙醛）：(1250.0, 12.000000, 15.999000, 7.5000, 0.9613, 1720.0)\n- 案例 D（苯甲醛）：(1200.0, 12.000000, 15.999000, 8.5000, 0.9613, 1700.0)\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个元素本身是包含三个浮点数的列表，顺序为 $[\\tilde{\\nu}_{\\mathrm{scaled}},\\ |\\tilde{\\nu}_{\\mathrm{scaled}}-\\tilde{\\nu}_{\\mathrm{exp}}|,\\ I]$，每个浮点数都四舍五入到三位小数。例如：\"[[x1,y1,z1],[x2,y2,z2],...]\"。", "solution": "我们在 Born–Oppenheimer 近似的框架下进行计算，该近似允许分离电子运动和核运动，并对平衡点附近的核运动采用谐振近似。在羰基的局域模式图像中，我们将 C=O 伸缩振动建模为一个双原子振子，其特征是力常数和折合质量。在双谐波近似中，红外（IR）强度由偶极矩对质量加权简正坐标的导数决定。\n\n1. 根据力常数和折合质量计算谐振波数。\n在谐振近似下，类双原子模式的经典运动方程给出角频率\n$$\n\\omega = \\sqrt{\\frac{k}{\\mu}},\n$$\n其中 $k$ 是力常数，单位为 $\\mathrm{N\\ m^{-1}}$，$ \\mu$ 是折合质量，单位为 $\\mathrm{kg}$。对于质量为 $m_{\\mathrm{C}}$ 和 $m_{\\mathrm{O}}$ 的原子，其折合质量为\n$$\n\\mu = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}.\n$$\n因为输入的质量以原子质量单位 (amu) 给出，我们首先计算以 amu 为单位的折合质量：\n$$\n\\mu_{\\mathrm{amu}} = \\frac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}},\n$$\n然后通过 $1\\ \\mathrm{amu} = 1.66053906660\\times 10^{-27}\\ \\mathrm{kg}$ 将其转换为 $\\mathrm{kg}$：\n$$\n\\mu = \\mu_{\\mathrm{amu}} \\times \\left(1.66053906660\\times 10^{-27}\\right)\\ \\mathrm{kg}.\n$$\n谐振波数（单位为 $\\mathrm{cm^{-1}}$）通过将线性频率除以光速（单位为 $\\mathrm{cm\\ s^{-1}}$）得到：\n$$\n\\tilde{\\nu}_{\\mathrm{harm}} = \\frac{\\omega}{2\\pi c} = \\frac{1}{2\\pi c}\\sqrt{\\frac{k}{\\mu}},\n$$\n其中 $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$。为了校正杂化泛函与极化基组（例如，B3LYP 与裂价加极化基组）造成的系统性高估，我们应用经验标度因子 $s$ 来获得预测的标度波数\n$$\n\\tilde{\\nu}_{\\mathrm{scaled}} = s\\ \\tilde{\\nu}_{\\mathrm{harm}}.\n$$\n\n2. 与实验值的绝对偏差。\n给定实验波数 $\\tilde{\\nu}_{\\mathrm{exp}}$（单位为 $\\mathrm{cm^{-1}}$），绝对偏差为\n$$\n\\Delta = \\left|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}\\right|.\n$$\n\n3. 双谐波近似中的红外强度。\n在双谐波近似中，简正模式的积分红外强度与偶极矩对质量加权简正坐标 $Q$ 的导数的平方成正比。对于局域双原子模式，我们可以将质量加权坐标表示为\n$$\nQ = \\sqrt{\\mu_{\\mathrm{amu}}}\\ \\Delta r,\n$$\n其中 $\\Delta r$ 是键长位移，单位为 $\\mathrm{\\AA}$，$\\mu_{\\mathrm{amu}}$ 是折合质量，单位为 amu（在此上下文中为无量纲）。给定偶极矩对键长的导数 $\\mathrm{d}\\mu/\\mathrm{d}r$（单位为 $\\mathrm{D\\ \\AA^{-1}}$），我们得到\n$$\n\\frac{\\partial \\mu}{\\partial Q} = \\frac{1}{\\sqrt{\\mu_{\\mathrm{amu}}}}\\ \\frac{\\mathrm{d}\\mu}{\\mathrm{d}r},\n$$\n单位为 $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$。积分摩尔吸收系数（强度）（单位为 $\\mathrm{km\\ mol^{-1}}$）则为\n$$\nI = 42.255 \\left(\\frac{\\partial \\mu}{\\partial Q}\\right)^2,\n$$\n其中因子 $42.255$ 整合了适当的基本常数、单位转换以及在谐波极限中进行取向平均的因子，这与将 $\\partial \\mu/\\partial Q$ 以 $\\mathrm{D\\ \\AA^{-1}\\ amu^{-1/2}}$ 表示是一致的。\n\n4. 算法步骤。\n对于每个测试用例：\n- 计算 $\\mu_{\\mathrm{amu}} = \\dfrac{m_{\\mathrm{C}} m_{\\mathrm{O}}}{m_{\\mathrm{C}} + m_{\\mathrm{O}}}$。\n- 将 $\\mu_{\\mathrm{amu}}$ 乘以 $1.66053906660\\times 10^{-27}$，转换为 $\\mu$（单位为 $\\mathrm{kg}$）。\n- 使用 $c = 2.99792458\\times 10^{10}\\ \\mathrm{cm\\ s^{-1}}$ 计算 $\\tilde{\\nu}_{\\mathrm{harm}} = \\dfrac{1}{2\\pi c}\\sqrt{\\dfrac{k}{\\mu}}$。\n- 计算 $\\tilde{\\nu}_{\\mathrm{scaled}} = s\\ \\tilde{\\nu}_{\\mathrm{harm}}$ 和绝对偏差 $\\Delta = \\left|\\tilde{\\nu}_{\\mathrm{scaled}} - \\tilde{\\nu}_{\\mathrm{exp}}\\right|$。\n- 计算 $\\partial \\mu/\\partial Q = \\left(\\mathrm{d}\\mu/\\mathrm{d}r\\right)/\\sqrt{\\mu_{\\mathrm{amu}}}$ 和 $I = 42.255\\left(\\partial \\mu/\\partial Q\\right)^2$。\n- 将 $\\tilde{\\nu}_{\\mathrm{scaled}}$、$\\Delta$ 和 $I$ 四舍五入到三位小数。\n\n5. 单位和舍入。\n- 以 $\\mathrm{cm^{-1}}$ 为单位报告 $\\tilde{\\nu}_{\\mathrm{scaled}}$ 和 $\\Delta$，均四舍五入到三位小数。\n- 以 $\\mathrm{km\\ mol^{-1}}$ 为单位报告 $I$，四舍五入到三位小数。\n- 输出格式为单行字符串，编码一个列表的列表：每个内部列表是 $[\\tilde{\\nu}_{\\mathrm{scaled}},\\ \\Delta,\\ I]$，对应一个测试用例，顺序与提供的测试套件相同。\n\n这些步骤将基本力学模型（力、质量和谐振运动）与光谱可观测量联系起来，并包含了在使用杂化 DFT 和极化基组时典型的经验校正。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_scaled_wavenumber_and_intensity(k_N_per_m, mC_amu, mO_amu, dmu_dr_D_per_A, scale_factor, nu_exp_cm1):\n    # Physical constants\n    amu_to_kg = 1.66053906660e-27  # kg per amu\n    c_cm_per_s = 2.99792458e10     # speed of light in cm/s\n    two_pi = 2.0 * np.pi\n\n    # Reduced mass in amu and kg\n    mu_amu = (mC_amu * mO_amu) / (mC_amu + mO_amu)\n    mu_kg = mu_amu * amu_to_kg\n\n    # Harmonic angular frequency (rad/s) and wavenumber (cm^-1)\n    omega = np.sqrt(k_N_per_m / mu_kg)\n    nu_harm_cm1 = omega / (two_pi * c_cm_per_s)\n\n    # Apply scaling factor\n    nu_scaled_cm1 = scale_factor * nu_harm_cm1\n\n    # Absolute deviation from experiment\n    deviation_cm1 = abs(nu_scaled_cm1 - nu_exp_cm1)\n\n    # IR intensity in km/mol using double-harmonic approximation\n    # Convert derivative to mass-weighted coordinate derivative\n    dmu_dQ = dmu_dr_D_per_A / np.sqrt(mu_amu)  # D / (A * sqrt(amu))\n    intensity_km_per_mol = 42.255 * (dmu_dQ ** 2)\n\n    return nu_scaled_cm1, deviation_cm1, intensity_km_per_mol\n\ndef format_results(results, decimals=3):\n    # Format nested list with fixed decimals\n    formatted_cases = []\n    fmt = f\"{{:.{decimals}f}}\"\n    for triple in results:\n        a, b, c = triple\n        formatted_cases.append(f\"[{fmt.format(a)},{fmt.format(b)},{fmt.format(c)}]\")\n    return \"[\" + \",\".join(formatted_cases) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (k [N/m], mC [amu], mO [amu], dmu/dr [D/Å], s [dimensionless], nu_exp [cm^-1])\n    test_cases = [\n        (1300.0, 12.000000, 15.999000, 7.0000, 0.9613, 1746.0),     # Case A: formaldehyde\n        (1300.0, 13.003355, 15.999000, 7.0000, 0.9613, 1710.0),     # Case B: 13C-formaldehyde\n        (1250.0, 12.000000, 15.999000, 7.5000, 0.9613, 1720.0),     # Case C: acetaldehyde\n        (1200.0, 12.000000, 15.999000, 8.5000, 0.9613, 1700.0),     # Case D: benzaldehyde\n    ]\n\n    results = []\n    for case in test_cases:\n        k, mC, mO, dmu_dr, s, nu_exp = case\n        nu_scaled, deviation, intensity = compute_scaled_wavenumber_and_intensity(\n            k, mC, mO, dmu_dr, s, nu_exp\n        )\n        results.append((nu_scaled, deviation, intensity))\n\n    # Final print statement in the exact required format.\n    print(format_results(results, decimals=3))\n\nsolve()\n```", "id": "3698598"}]}