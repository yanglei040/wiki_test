{"hands_on_practices": [{"introduction": "掌握定量光谱学始于对比尔-朗伯定律的深刻理解。本练习旨在引导您从基本物理原理出发，推导出这一基本关系，将宏观的吸光度测量值（$A$）与微观的光衰减过程联系起来。通过应用所推导的定律计算分析物的浓度，您将巩固对吸光度、摩尔吸光系数（$\\epsilon$）、光程（$l$）和浓度（$c$）之间相互作用的掌握，同时也将学会审视这一定律在实际应用中的线性范围限制 [@problem_id:3726853]。", "problem": "一种在电磁波谱紫外区具有单一主导 $\\pi \\rightarrow \\pi^{*}$ 电子跃迁的有机分析物，使用紫外-可见（UV-Vis）吸收光谱法在波长 $280\\ \\mathrm{nm}$ 处，于光程长度 $l = 1.0\\ \\mathrm{cm}$ 的石英比色皿中进行测量。光谱仪报告的十进吸光度为 $A = 0.75$，该分析物在 $280\\ \\mathrm{nm}$ 处的已列表的摩尔十进吸收系数为 $\\epsilon = 5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1}$。请从支配电磁辐射在均匀吸收介质中衰减的第一性原理和十进吸光度的定义出发，推导出用于确定分析物浓度 $c$ 的适当关系式，并对 $c$ 进行数值计算。在您的推理中，请阐明吸光度与浓度之间保持线性比例关系的物理条件，并评估所测量的吸光度是否落在溶液中紫外-可见测量的通常可靠线性范围内。最终浓度以毫摩尔（mM）表示，并将您的答案四舍五入到四位有效数字。", "solution": "题目要求从第一性原理推导比尔-朗伯定律，评估其在给定条件下的适用性，并计算分析物的浓度。\n\n电磁辐射穿过均匀吸收介质时发生衰减的基本原理是：辐射强度在穿过微分光程长度 $dx$ 时的微分减小量 $dI$，与入射强度 $I$ 和吸收物质的浓度 $c$ 成正比。这可以表示为微分方程：\n$$\ndI = -k' I c \\, dx\n$$\n其中 $k'$ 是吸收物质在特定波长下的一个特征比例常数。负号表示辐射穿过介质时强度降低。\n\n为了求出在有限光程长度 $l$ 上的总衰减，我们必须对该方程进行积分。我们重排方程以分离变量 $I$ 和 $x$：\n$$\n\\frac{dI}{I} = -k' c \\, dx\n$$\n我们对左边从样品池前端（$x=0$）的初始强度 $I_0$ 到样品池末端（$x=l$）的透射强度 $I_t$ 进行积分。假设浓度 $c$ 在整个均匀溶液中是恒定的，我们可以在对右边积分时将其视为常数：\n$$\n\\int_{I_0}^{I_t} \\frac{dI}{I} = \\int_{0}^{l} -k' c \\, dx = -k' c \\int_{0}^{l} dx\n$$\n计算积分得到：\n$$\n[\\ln(I)]_{I_0}^{I_t} = -k' c [x]_{0}^{l}\n$$\n$$\n\\ln(I_t) - \\ln(I_0) = -k' c (l - 0)\n$$\n$$\n\\ln\\left(\\frac{I_t}{I_0}\\right) = -k' c l\n$$\n比值 $\\frac{I_t}{I_0}$ 被定义为透射比 $T$。然而，光谱测量通常使用吸光度的概念。十进吸光度 $A$ 定义为透射比的以10为底的负对数：\n$$\nA = -\\log_{10}(T) = -\\log_{10}\\left(\\frac{I_t}{I_0}\\right) = \\log_{10}\\left(\\frac{I_0}{I_t}\\right)\n$$\n为了将我们推导的方程与十进吸光度关联起来，我们使用对数的换底公式：$\\ln(x) = \\ln(10) \\log_{10}(x)$。将其应用于我们的积分方程：\n$$\n\\ln(10) \\log_{10}\\left(\\frac{I_t}{I_0}\\right) = -k' c l\n$$\n代入 $A = -\\log_{10}\\left(\\frac{I_t}{I_0}\\right)$ 的定义：\n$$\n\\ln(10) (-A) = -k' c l\n$$\n$$\nA = \\frac{k'}{\\ln(10)} c l\n$$\n这个方程显示了吸光度 $A$ 与浓度 $c$ 和光程长度 $l$ 之间的线性关系。项 $\\frac{k'}{\\ln(10)}$ 将物质的内在吸收特性以及自然对数和常用对数之间的转换因子合并为一个单一常数。该项被定义为摩尔十进吸收系数 $\\epsilon$：\n$$\n\\epsilon \\equiv \\frac{k'}{\\ln(10)}\n$$\n将 $\\epsilon$ 代入方程，得到著名的比尔-朗伯定律：\n$$\nA = \\epsilon c l\n$$\n这就是确定分析物浓度所需的关系式。\n\n比尔-朗伯定律所表达的线性比例关系在特定条件下成立：\n$1$. 入射辐射必须是单色的，因为 $\\epsilon$ 是波长的函数。如果光谱仪的光谱带宽相对于吸收光谱的特征而言较宽，则可能出现偏差。\n$2$. 溶液必须是稀溶液（通常 $c  0.01 \\, \\mathrm{M}$）。在较高浓度下，分子间相互作用会改变分析物的吸收能力，导致偏离线性关系。\n$3$. 吸收物质不得发生化学变化，例如缔合、解离或与溶剂反应，因为这会改变吸收实体的性质和浓度。\n$4$. 样品必须是均匀的，并且不应有来自悬浮颗粒的光散射。\n$5$. 仪器测量必须没有明显的杂散光，杂散光尤其会影响高吸光度值下的准确性。\n\n题目中给出的测量吸光度为 $A = 0.75$。对于定量紫外-可见光谱法，最可靠的测量通常在约 $0.1$ 到 $1.0$ 的吸光度范围内获得。当 $A \\approx 0.1$ 以下时，由于 $I_0$ 和 $I_t$ 之间的差异很小，信噪比通常较差。当 $A \\approx 1.0$ 以上（对应于 $10\\%$ 的透射比）时，到达检测器的光非常少，任何杂散光都可能成为检测信号的重要部分，导致与线性关系的负偏差。因此，测量值 $A = 0.75$ 完全落在可靠定量分析的最佳线性范围内。\n\n为了计算浓度 $c$，我们重排比尔-朗伯定律：\n$$\nc = \\frac{A}{\\epsilon l}\n$$\n我们已知以下数值：\n吸光度，$A = 0.75$（无量纲）。\n摩尔十进吸收系数，$\\epsilon = 5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1}$。\n光程长度，$l = 1.0\\ \\mathrm{cm}$。\n\n将这些值代入方程：\n$$\nc = \\frac{0.75}{(5600\\ \\mathrm{M}^{-1}\\mathrm{cm}^{-1})(1.0\\ \\mathrm{cm})} = \\frac{0.75}{5600}\\ \\mathrm{M}\n$$\n$$\nc \\approx 0.00013392857\\ \\mathrm{M}\n$$\n题目要求最终浓度以毫摩尔（mM）表示。我们使用关系式 $1\\ \\mathrm{M} = 1000\\ \\mathrm{mM}$ 进行单位转换：\n$$\nc \\approx 0.00013392857\\ \\mathrm{mol\\ L^{-1}} \\times \\frac{1000\\ \\mathrm{mmol}}{1\\ \\mathrm{mol}} = 0.13392857\\ \\mathrm{mM}\n$$\n最后，根据要求将答案四舍五入到四位有效数字：\n$$\nc \\approx 0.1339\\ \\mathrm{mM}\n$$", "answer": "$$\\boxed{0.1339}$$", "id": "3726853"}, {"introduction": "尽管比尔-朗伯定律为光吸收提供了一个简洁的理想模型，但真实的测量过程常常受到仪器不完美性的影响。本练习聚焦于其中一个最常见的非理想因素：杂散光。您将通过建立一个物理模型，来分析光谱仪中非测量波段的杂散辐射如何导致测量吸光度的系统性偏差（尤其是在高浓度下），并推导真实吸光度（$A_{\\text{true}}$）与测量吸光度（$A_{\\text{meas}}$）之间的关系 [@problem_id:3726921]。这项练习对于培养评估分光光度数据有效性的批判性技能至关重要。", "problem": "一台紫外-可见（UV-Vis）吸收光谱仪用于鉴定电磁波谱中在 $\\lambda_{0} = 280\\,\\mathrm{nm}$ 附近有强 $\\pi \\rightarrow \\pi^*$ 跃迁的有机生色团。该仪器使用一个具有有限杂散光抑制比的单色器，该比率 $\\mathcal{R}$ 定义为当没有样品存在时，到达检测器的带内辐射功率与带外杂散辐射功率之比。在此类仪器中，杂散光会在检测器上产生一个与样品无关的附加强度。该生色团溶液遵循比尔-朗伯定律，其真实吸光度由 $A_{\\text{true}} = \\varepsilon(\\lambda_{0})\\,b\\,c$ 给出，其中 $\\varepsilon(\\lambda_{0})$ 是摩尔吸光系数， $b$ 是光程长度， $c$ 是浓度。吸光度定义为 $A = -\\log_{10}(T)$，其中透射比 $T$ 是透射辐射功率与入射辐射功率之比。\n\n从这些定义出发，并基于物理模型——即在 $\\lambda_{0}$ 处测得的检测器强度是经样品衰减的带内强度与一个和入射强度成正比（比例系数为 $1/\\mathcal{R}$）的杂散分量之和——推导表观（测量）吸光度 $A_{\\text{meas}}$ 关于 $A_{\\text{true}}$ 和 $\\mathcal{R}$ 的表达式。\n\n然后，对于一个溶液，其 $\\varepsilon(\\lambda_{0}) = 1.2 \\times 10^{4}\\,\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$，$b = 1.00\\,\\mathrm{cm}$，$c = 2.5 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$，在一台 $\\mathcal{R} = 5.0 \\times 10^{4}$ 的仪器上测量，计算在 $\\lambda_{0}$ 处的 $A_{\\text{meas}}$ 的数值。将您的答案四舍五入至$4$位有效数字。最终的吸光度值以纯数（无单位）形式表示。", "solution": "该问题要求推导由具有有限杂散光的光谱仪测量的表观吸光度 $A_{\\text{meas}}$ 的表达式，并针对给定的样品和仪器配置计算其数值。\n\n首先，我们建立测量的物理模型。设 $P_{0, \\lambda_0}$ 代表在分析波长 $\\lambda_0$ 处入射到样品池上的带内光的辐射功率。设 $P_{s,0}$ 代表同样入射到样品池上的所有带外光（即杂散光）的辐射功率。\n\n当进行参考测量（使用空白样）时，到达检测器的总辐射功率 $P_{\\text{ref}}$ 是带内分量和杂散分量之和，假设空白样对所有辐射都是完全透明的。\n$$P_{\\text{ref}} = P_{0, \\lambda_0} + P_{s,0}$$\n\n当样品放入光束中时，它根据比尔-朗伯定律吸收带内光。样品在 $\\lambda_0$ 处的真实透射比为 $T_{\\text{true}} = 10^{-A_{\\text{true}}}$，其中 $A_{\\text{true}}$ 是真实吸光度。因此，透射过样品的带内光的辐射功率为 $P_{0, \\lambda_0} \\cdot T_{\\text{true}} = P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}}$。\n\n杂散光处于样品被假定为不吸收的波长，因此未经衰减地通过。因此，到达检测器的杂散辐射功率仍然是 $P_{s,0}$。用样品测量的总辐射功率 $P_{\\text{meas}}$ 是透射的带内功率和未衰减的杂散功率之和：\n$$P_{\\text{meas}} = (P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}}) + P_{s,0}$$\n\n仪器测量的表观透射比 $T_{\\text{meas}}$ 是用样品测量的总功率与用参比测量的总功率之比：\n$$T_{\\text{meas}} = \\frac{P_{\\text{meas}}}{P_{\\text{ref}}} = \\frac{P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}} + P_{s,0}}{P_{0, \\lambda_0} + P_{s,0}}$$\n\n问题给出了杂散光抑制比 $\\mathcal{R}$ 的定义，即带内辐射功率与带外杂散辐射功率之比：\n$$\\mathcal{R} = \\frac{P_{0, \\lambda_0}}{P_{s,0}}$$\n根据这个关系，我们可以将杂散功率表示为 $P_{s,0} = \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}$。\n\n将 $P_{s,0}$ 的这个表达式代入 $T_{\\text{meas}}$ 的方程，可以消去明确的功率项：\n$$T_{\\text{meas}} = \\frac{P_{0, \\lambda_0} \\cdot 10^{-A_{\\text{true}}} + \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}}{P_{0, \\lambda_0} + \\frac{P_{0, \\lambda_0}}{\\mathcal{R}}}$$\n我们可以从分子和分母中提出因子 $P_{0, \\lambda_0}$ 并消掉它：\n$$T_{\\text{meas}} = \\frac{P_{0, \\lambda_0} \\left(10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}\\right)}{P_{0, \\lambda_0} \\left(1 + \\frac{1}{\\mathcal{R}}\\right)} = \\frac{10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}}{1 + \\frac{1}{\\mathcal{R}}}$$\n表观吸光度 $A_{\\text{meas}}$ 定义为 $A_{\\text{meas}} = -\\log_{10}(T_{\\text{meas}})$。应用此定义，得到最终的推导表达式：\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{10^{-A_{\\text{true}}} + \\frac{1}{\\mathcal{R}}}{1 + \\frac{1}{\\mathcal{R}}}\\right)$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须计算 $A_{\\text{meas}}$ 的数值。首先，我们使用比尔-朗伯定律 $A_{\\text{true}} = \\varepsilon(\\lambda_{0})bc$ 计算真实吸光度 $A_{\\text{true}}$。给定的值为 $\\varepsilon(\\lambda_{0}) = 1.2 \\times 10^{4}\\,\\mathrm{L\\,mol^{-1}\\,cm^{-1}}$，$b = 1.00\\,\\mathrm{cm}$，和 $c = 2.5 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$。\n$$A_{\\text{true}} = (1.2 \\times 10^{4}) \\times (1.00) \\times (2.5 \\times 10^{-4})$$\n$$A_{\\text{true}} = (1.2 \\times 2.5) \\times (10^{4} \\times 10^{-4}) = 3.0$$\n真实吸光度为 $A_{\\text{true}} = 3.0$。\n\n现在，我们将 $A_{\\text{true}} = 3.0$ 和给定的杂散光抑制比 $\\mathcal{R} = 5.0 \\times 10^{4}$ 代入推导出的 $A_{\\text{meas}}$ 表达式中：\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{10^{-3.0} + \\frac{1}{5.0 \\times 10^{4}}}{1 + \\frac{1}{5.0 \\times 10^{4}}}\\right)$$\n我们计算这些数值项：\n$$10^{-3.0} = 0.001$$\n$$\\frac{1}{5.0 \\times 10^{4}} = 2.0 \\times 10^{-5} = 0.00002$$\n代入这些值：\n$$A_{\\text{meas}} = -\\log_{10}\\left(\\frac{0.001 + 0.00002}{1 + 0.00002}\\right) = -\\log_{10}\\left(\\frac{0.00102}{1.00002}\\right)$$\n进行计算：\n$$A_{\\text{meas}} = -\\log_{10}(0.0010199796...)$$\n$$A_{\\text{meas}} = 2.9914401...$$\n根据题目要求，将结果四舍五入到4位有效数字：\n$$A_{\\text{meas}} \\approx 2.991$$", "answer": "$$\\boxed{2.991}$$", "id": "3726921"}, {"introduction": "本章的最后一个练习将带您进入更复杂的真实世界场景，即化学体系本身是动态的。当溶液中存在多种光谱重叠且处于平衡状态的物质时，总吸光度是它们各自贡献的线性叠加。这项高级练习将光谱学、化学平衡和数值方法联系起来，您将通过求解一个超定线性方程组，学习如何从重叠的光谱中“解卷积”出单个组分（如单体和二聚体）的浓度 [@problem_id:3726854]。通过首先构建一个合成数据集然后对其进行解卷积，您将亲身体验到如何对复杂系统进行建模，并从混合光谱数据中提取定量的化学信息。", "problem": "一种发色有机溶质在溶液中表现出浓度依赖性的自缔合行为，形成二聚体，该二聚体扰乱了其在电磁波谱紫外-可见光区域的电子吸收带。您将把多个波长下的吸收光谱建模为单体和聚集体贡献的线性叠加，并通过基于第一性原理关系的光谱解卷积来恢复聚集分数。\n\n使用以下基本原理，不使用简化公式：\n- 比尔-朗伯定律：对于每个波长 $\\lambda$，吸光度 $A(\\lambda)$ 是所有吸收物种贡献的光程加权总和。具体来说，$A(\\lambda)$ 与光程长度以及在 $\\lambda$ 处浓度加权的摩尔吸光系数成正比。\n- 质量作用定律和物种守恒：对于二聚化平衡 $2\\,\\mathrm{M} \\rightleftharpoons \\mathrm{D}$，其平衡缔合常数为 $K$ (单位为 $\\mathrm{M}^{-1}$)。在总分析浓度为 $C_{\\mathrm{t}}$ 时，单体浓度 $[\\mathrm{M}]$ 和二聚体浓度 $[\\mathrm{D}]$ 同时满足质量作用关系和守恒关系。\n\n任务：\n1. 在一组波长 $\\{\\lambda_i\\}_{i=1}^n$ 上构建一个线性光谱模型，方法是将测量的吸光度向量表示为两个固定基准光谱（单体和聚集体）的线性组合，并按其浓度和光程长度进行缩放。\n2. 给定在这些波长下单体和聚集体的固定基准摩尔吸光系数以及光程长度，通过将比尔-朗伯定律应用于在指定的总浓度 $C_{\\mathrm{t}}$ 和缔合常数 $K$ 下由质量作用定律所隐含的平衡组分，生成合成的“测量”吸光度向量。\n3. 在不使用平衡关系来推断组分的情况下，在每个总浓度下通过求解一个覆盖所有波长的线性最小二乘问题，从每个吸光度向量中估计 $[\\mathrm{M}]$ 和 $[\\mathrm{D}]$。\n4. 根据解卷积得到的浓度，计算聚集分数 $f_{\\mathrm{agg}}$，其定义为 $f_{\\mathrm{agg}} = \\dfrac{2\\,[\\mathrm{D}]}{C_{\\mathrm{t}}}$ (无单位)。将 $f_{\\mathrm{agg}}$ 表示为四舍五入到六位小数的小数分数（不带百分号）。\n\n物理参数和单位：\n- 波长网格（纳米）：$[\\;300,\\;310,\\;320,\\;330,\\;340,\\;350,\\;360,\\;370,\\;380,\\;390\\;]$。\n- 光程长度 $l$（厘米）：$l = 1.000$。\n- 单体摩尔吸光系数向量 $\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$ (单位 $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$)，与波长网格对齐：$[\\;1000,\\;2000,\\;5000,\\;12000,\\;22000,\\;30000,\\;26000,\\;18000,\\;9000,\\;3000\\;]$。\n- 二聚体（聚集体）摩尔吸光系数向量 $\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$ (单位 $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$)，同样对齐：$[\\;200,\\;500,\\;1500,\\;4000,\\;8000,\\;15000,\\;25000,\\;38000,\\;42000,\\;35000\\;]$。\n- 缔合常数 $K$ (单位 $\\mathrm{M}^{-1}$): $K = 5000$。\n\n测试组（覆盖低、中、高聚集区域）：\n- 情况1: $C_{\\mathrm{t}} = 5\\times 10^{-6}\\ \\mathrm{M}$。\n- 情况2: $C_{\\mathrm{t}} = 5\\times 10^{-5}\\ \\mathrm{M}$。\n- 情况3: $C_{\\mathrm{t}} = 2\\times 10^{-4}\\ \\mathrm{M}$。\n- 情况4: $C_{\\mathrm{t}} = 1\\times 10^{-3}\\ \\mathrm{M}$。\n\n为每种情况生成合成吸光度（用作解卷积的“测量”输入）：\n- 对于每个给定的 $C_{\\mathrm{t}}$ 和 $K$，确定唯一的非负平衡组分 $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$，该组分在 $C_{\\mathrm{t}}$ 下满足二聚化的质量作用定律和物种守恒关系。\n- 使用给定的 $\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$、$\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$、计算出的 $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$ 和光程长度 $l$，通过在每个 $\\lambda_i$ 处应用比尔-朗伯定律，形成吸光度向量 $\\mathbf{A}$，其条目为 $A(\\lambda_i)$。\n\n解卷积要求：\n- 对于每种情况，通过对所有波长求解由基准光谱和光程长度定义的超定线性系统，与相应的“测量”吸光度向量进行最小二乘拟合，来估计 $\\left([\\mathrm{M}], [\\mathrm{D}]\\right)$，而不调用平衡关系。\n- 从解卷积得到的浓度计算 $f_{\\mathrm{agg}} = \\dfrac{2\\,[\\mathrm{D}]}{C_{\\mathrm{t}}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述顺序列出的四种情况对应的四个 $f_{\\mathrm{agg}}$ 值，四舍五入到六位小数，以逗号分隔并用方括号括起来。例如，格式必须与 $[\\;x_1,\\;x_2,\\;x_3,\\;x_4\\;]$ 完全一样，其中每个 $x_i$ 是一个四舍五入到六位的小数。\n\n角度单位不适用。所有浓度必须以 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 为单位，光程长度以 $\\mathrm{cm}$ 为单位，摩尔吸光系数以 $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{cm}^{-1}$ 为单位，波长以 $\\mathrm{nm}$ 为单位，吸光度无量纲。所要求的答案 $f_{\\mathrm{agg}}$ 是无单位的小数分数。", "solution": "该问题需要一个涉及化学平衡、分光光度法和线性代数的多步骤分析，以确定在不同浓度下溶液中聚集物种的分数。整个过程是首先计算理论平衡组分，然后用它来生成合成光谱数据，最后对这些数据进行解卷积，以恢复组分和所需的聚集分数。\n\n### 第1部分：确定平衡组分\n\n该系统涉及单体物种 $\\mathrm{M}$ 到二聚体物种 $\\mathrm{D}$ 的二聚化平衡，反应式如下：\n$$ 2\\,\\mathrm{M} \\rightleftharpoons \\mathrm{D} $$\n\n此平衡的质量作用定律由缔合常数 $K$ 给出：\n$$ K = \\frac{[\\mathrm{D}]}{[\\mathrm{M}]^2} \\quad (1) $$\n其中 $[\\mathrm{M}]$ 和 $[\\mathrm{D}]$ 分别是单体和二聚体的摩尔浓度。\n\n在分析浓度为 $C_{\\mathrm{t}}$ 时，总溶质的质量守恒由下式给出：\n$$ C_{\\mathrm{t}} = [\\mathrm{M}] + 2\\,[\\mathrm{D}] \\quad (2) $$\n$[\\mathrm{D}]$ 的系数 $2$ 说明了每个二聚体包含两个单体单元。\n\n为了找到给定 $C_{\\mathrm{t}}$ 和 $K$ 下的平衡浓度，我们求解方程组 $(1)$ 和 $(2)$。我们可以从方程 $(1)$ 中将 $[\\mathrm{D}]$ 表示为 $[\\mathrm{D}] = K\\,[\\mathrm{M}]^2$，并将其代入方程 $(2)$：\n$$ C_{\\mathrm{t}} = [\\mathrm{M}] + 2\\,(K\\,[\\mathrm{M}]^2) $$\n将其重新排列为关于 $[\\mathrm{M}]$ 的二次方程标准形式（$ax^2+bx+c=0$）：\n$$ (2K)\\,[\\mathrm{M}]^2 + (1)\\,[\\mathrm{M}] - C_{\\mathrm{t}} = 0 $$\n$[\\mathrm{M}]$ 的解可以通过二次公式求得，$[\\mathrm{M}] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$。此处，$a = 2K$, $b = 1$, 且 $c = -C_{\\mathrm{t}}$。\n$$ [\\mathrm{M}] = \\frac{-1 \\pm \\sqrt{1^2 - 4(2K)(-C_{\\mathrm{t}})}}{2(2K)} = \\frac{-1 \\pm \\sqrt{1 + 8KC_{\\mathrm{t}}}}{4K} $$\n由于浓度必须是物理上非负的量，我们选择正根：\n$$ [\\mathrm{M}] = \\frac{-1 + \\sqrt{1 + 8KC_{\\mathrm{t}}}}{4K} \\quad (3) $$\n一旦确定了 $[\\mathrm{M}]$，就可以从质量守恒方程 $(2)$ 中计算出 $[\\mathrm{D}]$：\n$$ [\\mathrm{D}] = \\frac{C_{\\mathrm{t}} - [\\mathrm{M}]}{2} \\quad (4) $$\n这些方程允许为任何给定的 $C_{\\mathrm{t}}$ 和 $K$ 计算唯一的非负平衡组分 $([\\mathrm{M}], [\\mathrm{D}])$。\n\n### 第2部分：生成合成吸光度数据\n\n比尔-朗伯定律将溶液的吸光度与吸收物种的浓度联系起来。对于在给定波长 $\\lambda$ 下的单体和二聚体混合物，总吸光度 $A(\\lambda)$ 是它们各自贡献的总和：\n$$ A(\\lambda) = l \\cdot (\\varepsilon_{\\mathrm{M}}(\\lambda)[\\mathrm{M}] + \\varepsilon_{\\mathrm{D}}(\\lambda)[\\mathrm{D}]) $$\n其中 $l$ 是光程长度，$\\varepsilon_{\\mathrm{M}}(\\lambda)$ 和 $\\varepsilon_{\\mathrm{D}}(\\lambda)$ 是单体和二聚体在该波长下的摩尔吸光系数。\n\n这个关系可以对一组 $n$ 个波长 $\\{\\lambda_i\\}_{i=1}^n$ 以向量形式表示。设 $\\mathbf{A}$ 为 $n \\times 1$ 的吸光度向量，$\\boldsymbol{\\varepsilon}_{\\mathrm{M}}$ 和 $\\boldsymbol{\\varepsilon}_{\\mathrm{D}}$ 为 $n \\times 1$ 的摩尔吸光系数向量。那么合成的“测量”吸光度向量通过以下方式生成：\n$$ \\mathbf{A} = l \\cdot ([\\mathrm{M}] \\boldsymbol{\\varepsilon}_{\\mathrm{M}} + [\\mathrm{D}] \\boldsymbol{\\varepsilon}_{\\mathrm{D}}) \\quad (5) $$\n对于每个测试案例，我们使用第1部分计算出的平衡浓度 $([\\mathrm{M}], [\\mathrm{D}])$ 来生成相应的吸光度向量 $\\mathbf{A}$。\n\n### 第3部分：通过线性最小二乘法进行光谱解卷积\n\n反问题是从测量的吸收光谱中确定浓度。方程 $(5)$ 的光谱模型可以重写为一个线性系统：\n$$ \\mathbf{A} = \\begin{bmatrix} l \\cdot \\boldsymbol{\\varepsilon}_{\\mathrm{M}}  l \\cdot \\boldsymbol{\\varepsilon}_{\\mathrm{D}} \\end{bmatrix} \\begin{bmatrix} [\\mathrm{M}]_{\\text{est}} \\\\ [\\mathrm{D}]_{\\text{est}} \\end{bmatrix} $$\n这是一个形如 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$ 的线性方程组，其中：\n- $\\mathbf{y}$ 是 $n \\times 1$ 的测量吸光度向量 $\\mathbf{A}$。\n- $\\mathbf{X}$ 是 $n \\times 2$ 的设计矩阵，其列是光程缩放的基准光谱。我们称之为 $\\mathbf{E}$：$\\mathbf{E} = l \\cdot \\begin{bmatrix} \\boldsymbol{\\varepsilon}_{\\mathrm{M}}  \\boldsymbol{\\varepsilon}_{\\mathrm{D}} \\end{bmatrix}$。\n- $\\boldsymbol{\\beta}$ 是待估计的 $2 \\times 1$ 未知浓度向量，$\\mathbf{C}_{\\text{est}} = \\begin{bmatrix} [\\mathrm{M}]_{\\text{est}} \\\\ [\\mathrm{D}]_{\\text{est}} \\end{bmatrix}$。\n\n由于波长数量 ($n=10$) 多于未知浓度数量 ($2$)，该系统是超定的。问题指定通过最小化残差平方和（即通过线性最小二乘法）来求解 $\\mathbf{C}_{\\text{est}}$。这旨在寻找使 $\\| \\mathbf{A} - \\mathbf{E}\\mathbf{C}_{\\text{est}} \\|^2$ 最小化的向量 $\\mathbf{C}_{\\text{est}}$。此问题的解由正规方程给出：\n$$ (\\mathbf{E}^\\top\\mathbf{E})\\mathbf{C}_{\\text{est}} = \\mathbf{E}^\\top\\mathbf{A} $$\n求解 $\\mathbf{C}_{\\text{est}}$ 可得：\n$$ \\mathbf{C}_{\\text{est}} = (\\mathbf{E}^\\top\\mathbf{E})^{-1}\\mathbf{E}^\\top\\mathbf{A} $$\n对每个生成的吸光度向量执行此过程，以找到估计浓度 $([\\mathrm{M}]_{\\text{est}}, [\\mathrm{D}]_{\\text{est}})$。由于合成数据是由相同模型生成的且无噪声，解卷积应产生与原始平衡浓度在机器精度范围内相等的估计浓度。\n\n### 第4部分：计算聚集分数\n\n最后一步是计算聚集分数 $f_{\\mathrm{agg}}$，其定义为存在于二聚体聚集体中的总单体单元的分数。由于每摩尔二聚体含有两摩尔单体单元，聚集体形式的单体单元浓度为 $2\\,[\\mathrm{D}]$。系统中所有单体单元的总浓度为 $C_{\\mathrm{t}}$。因此，$f_{\\mathrm{agg}}$ 定义为：\n$$ f_{\\mathrm{agg}} = \\frac{2 \\cdot [\\mathrm{D}]_{\\text{est}}}{C_{\\mathrm{t}}} $$\n对四个测试案例中的每一个，都使用解卷积得到的二聚体浓度 $[\\mathrm{D}]_{\\text{est}}$ 进行此计算，并按要求将结果四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromophore aggregation problem by calculating equilibrium compositions,\n    generating synthetic spectra, performing least-squares deconvolution, and\n    computing the aggregated fraction for several total concentrations.\n    \"\"\"\n\n    # --- Physical Parameters and Constants ---\n    # Path length in cm\n    l = 1.000\n    # Association constant in M^-1\n    K = 5000.0\n\n    # Monomer molar absorptivity vector (L mol^-1 cm^-1)\n    eps_M = np.array([\n        1000, 2000, 5000, 12000, 22000, 30000, 26000, 18000, 9000, 3000\n    ], dtype=float)\n\n    # Dimer molar absorptivity vector (L mol^-1 cm^-1)\n    eps_D = np.array([\n        200, 500, 1500, 4000, 8000, 15000, 25000, 38000, 42000, 35000\n    ], dtype=float)\n\n    # Test cases: total analytical concentration Ct in M (mol/L)\n    test_cases_Ct = [\n        5e-6,\n        5e-5,\n        2e-4,\n        1e-3,\n    ]\n\n    # --- Deconvolution Setup ---\n    # The spectroscopic model is A = l * (eps_M*[M] + eps_D*[D]).\n    # This can be written in matrix form A = E * C, where C = [[M], [D]].\n    # The matrix E has columns corresponding to the path-length-scaled basis spectra.\n    # E is an n x 2 matrix, where n is the number of wavelengths.\n    E_matrix = l * np.vstack((eps_M, eps_D)).T\n\n    results_f_agg = []\n\n    for Ct in test_cases_Ct:\n        # --- Step 1: Calculate Equilibrium Concentrations (\"True\" values) ---\n        # The equilibrium composition is determined by solving the quadratic equation:\n        # 2*K*[M]^2 + [M] - Ct = 0\n        # The positive root for [M] is: [M] = (-1 + sqrt(1 + 8*K*Ct)) / (4*K)\n        discriminant = 1.0 + 8.0 * K * Ct\n        true_M = (-1.0 + np.sqrt(discriminant)) / (4.0 * K)\n        \n        # Calculate [D] from the mass balance equation: Ct = [M] + 2*[D]\n        true_D = (Ct - true_M) / 2.0\n\n        # --- Step 2: Generate Synthetic Absorbance Vector ---\n        # The absorbance vector A is generated using the Beer-Lambert law\n        # and the true equilibrium concentrations.\n        A_synthetic = l * (true_M * eps_M + true_D * eps_D)\n\n        # --- Step 3: Perform Spectral Deconvolution ---\n        # Solve the overdetermined linear system A = E * C for the concentration\n        # vector C = [[M_est], [D_est]] using linear least squares.\n        # np.linalg.lstsq returns a tuple; the solution vector is the first element.\n        C_estimated = np.linalg.lstsq(E_matrix, A_synthetic, rcond=None)[0]\n        est_M = C_estimated[0]\n        est_D = C_estimated[1]\n        \n        # --- Step 4: Compute Aggregated Fraction ---\n        # The aggregated fraction is defined as f_agg = 2 * [D] / Ct.\n        # We use the deconvolved (estimated) dimer concentration.\n        f_agg = (2.0 * est_D) / Ct\n        \n        results_f_agg.append(f_agg)\n\n    # Format the final output as specified.\n    # Each value rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results_f_agg]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3726854"}]}