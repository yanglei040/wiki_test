{"hands_on_practices": [{"introduction": "紫外-可见光谱为了解分子的电子结构提供了一个窗口。本练习将基础的量子力学“箱中粒子”模型与共轭多烯的可观测性质联系起来。通过计算延长共轭体系所预期的吸收波长位移，您将对分子结构如何决定颜色和电子跃迁能量获得更深刻的定量理解 [@problem_id:3719614]。", "problem": "一位有机化学家试图使用一维箱中粒子模型来解释共轭多烯的紫外-可见（UV-Vis）吸收峰最大值。考虑有$N_{\\pi}$个电子被限制在长度为$L$（等于共轭链的长度）的一维无限深势阱中，每个能级容纳两个电子（由于自旋简并），并且最低能量的允许光学跃迁近似为从最高已占分子轨道（HOMO）到最低未占分子轨道（LUMO）的跃迁。从不含时薛定谔方程和一维无限深势阱中粒子的能级定义出发，推导HOMO-LUMO跃迁能量以及相应吸收波长$\\lambda$的表达式，该表达式应以$L$、$N_{\\pi}$、电子质量$m_{e}$、光速$c$和普朗克常数$h$表示。\n\n利用此框架，模拟丁二烯（$N_{\\pi} = 4$）和己三烯（$N_{\\pi} = 6$）的最低能量$\\pi \\rightarrow \\pi^{*}$跃迁。将箱长$L$取为共轭链的长度，其值通过将多烯骨架上相应的碳-碳键长相加得到，使用$l_{\\mathrm{C{=}C}} = 1.34$ Å 和 $l_{\\mathrm{C{-}C}} = 1.47$ Å。因此，对于丁二烯，使用 $L_{\\mathrm{but}} = 2 l_{\\mathrm{C{=}C}} + 1 l_{\\mathrm{C{-}C}}$；对于己三烯，使用 $L_{\\mathrm{hex}} = 3 l_{\\mathrm{C{=}C}} + 2 l_{\\mathrm{C{-}C}}$。计算预测的吸收波长$\\lambda_{\\mathrm{but}}$和$\\lambda_{\\mathrm{hex}}$，然后计算红移$\\Delta \\lambda = \\lambda_{\\mathrm{hex}} - \\lambda_{\\mathrm{but}}$。\n\n使用 $h = 6.62607015 \\times 10^{-34}$ J·s、$c = 2.99792458 \\times 10^{8}$ m·s$^{-1}$ 和 $m_{e} = 9.10938356 \\times 10^{-31}$ kg。以纳米为单位表示最终的红移$\\Delta \\lambda$。将最终答案四舍五入至四位有效数字。\n\n为了给您的讨论提供背景信息，丁二烯和己三烯的典型实验$\\lambda_{\\max}$值分别约为$217$ nm和$258$ nm，但在计算$\\Delta \\lambda$时请勿使用这些值；它们仅用于在您完成计算后进行定性比较。", "solution": "所述问题具有科学依据、提法明确且客观。它展示了箱中粒子模型在近似共轭多烯电子吸收光谱中的一个标准应用，这是入门量子化学中的一个经典问题。所有必要的数据、常数和条件均已提供，在该模型的背景下，不存在内部矛盾或违反物理原理的情况。因此，该问题是有效的，并将提供解答。\n\n分析始于质量为$m$的粒子被限制在长度为$L$（从$x=0$到$x=L$）的一维盒子中的不含时薛定谔方程。势能$V(x)$在箱内为$0$，在箱外为无穷大。该方程为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\n其中$\\hbar$是约化普朗克常数（$h/(2\\pi)$），$\\psi(x)$是本征函数（波函数），$E$是本征值（能量）。边界条件为$\\psi(0)=0$和$\\psi(L)=0$。\n\n此方程的解给出了粒子的量子化能级，在本例中是质量为$m_e$的电子：\n$$\nE_n = \\frac{n^2 h^2}{8 m_e L^2}\n$$\n其中$n$是主量子数，可以是任何正整数（$n = 1, 2, 3, \\ldots$），$h$是普朗克常数。\n\n在具有$N_{\\pi}$个$\\pi$电子的共轭多烯的自由电子模型中，我们假设这些电子占据可用的能级。根据泡利不相容原理，每个能级最多可以容纳两个自旋相反的电子。电子将从最低能量（$n=1$）开始填充能级。因此，对于$N_{\\pi}$个电子，已占能级的数量为$N_{\\pi}/2$。\n\n最高已占分子轨道（HOMO）对应于量子数为$n_{\\mathrm{HOMO}}$的能级。这是被电子填充的最高能级。\n$$\nn_{\\mathrm{HOMO}} = \\frac{N_{\\pi}}{2}\n$$\n最低未占分子轨道（LUMO）对应于下一个可用能级，其量子数为$n_{\\mathrm{LUMO}}$。\n$$\nn_{\\mathrm{LUMO}} = n_{\\mathrm{HOMO}} + 1 = \\frac{N_{\\pi}}{2} + 1\n$$\n在紫外-可见光谱中观察到的最低能量电子跃迁，即$\\pi \\rightarrow \\pi^{*}$跃迁，对应于一个电子从HOMO被激发到LUMO。此跃迁的能量$\\Delta E$是这两个能级之间的能量差：\n$$\n\\Delta E = E_{\\mathrm{LUMO}} - E_{\\mathrm{HOMO}} = E_{\\frac{N_{\\pi}}{2}+1} - E_{\\frac{N_{\\pi}}{2}}\n$$\n代入$E_n$的表达式：\n$$\n\\Delta E = \\frac{h^2}{8 m_e L^2} \\left[ \\left(\\frac{N_{\\pi}}{2} + 1\\right)^2 - \\left(\\frac{N_{\\pi}}{2}\\right)^2 \\right]\n$$\n展开平方项并化简：\n$$\n\\left(\\frac{N_{\\pi}}{2} + 1\\right)^2 - \\left(\\frac{N_{\\pi}}{2}\\right)^2 = \\left( \\frac{N_{\\pi}^2}{4} + N_{\\pi} + 1 \\right) - \\frac{N_{\\pi}^2}{4} = N_{\\pi} + 1\n$$\n因此，跃迁能量的表达式为：\n$$\n\\Delta E = \\frac{h^2 (N_{\\pi} + 1)}{8 m_e L^2}\n$$\n吸收光子的能量通过普朗克-爱因斯坦关系$\\Delta E = h\\nu = hc/\\lambda$与其波长$\\lambda$相关，其中$c$是光速。求解$\\lambda$：\n$$\n\\lambda = \\frac{hc}{\\Delta E} = \\frac{hc}{\\frac{h^2 (N_{\\pi} + 1)}{8 m_e L^2}}\n$$\n这可以简化为吸收波长的通用表达式：\n$$\n\\lambda = \\frac{8 m_e c L^2}{h (N_{\\pi} + 1)}\n$$\n现在，我们使用所提供的数据$l_{\\mathrm{C{=}C}} = 1.34$ Å 和 $l_{\\mathrm{C{-}C}} = 1.47$ Å，将此推导出的表达式应用于丁二烯和己三烯。首先，将这些长度转换为国际单位制单位（米）：\n$l_{\\mathrm{C{=}C}} = 1.34 \\times 10^{-10}$ m\n$l_{\\mathrm{C{-}C}} = 1.47 \\times 10^{-10}$ m\n\n对于丁二烯（$N_{\\pi} = 4$），箱长$L_{\\mathrm{but}}$为：\n$$\nL_{\\mathrm{but}} = 2 l_{\\mathrm{C{=}C}} + 1 l_{\\mathrm{C{-}C}} = 2(1.34 \\times 10^{-10} \\text{ m}) + 1(1.47 \\times 10^{-10} \\text{ m}) = (2.68 + 1.47) \\times 10^{-10} \\text{ m} = 4.15 \\times 10^{-10} \\text{ m}\n$$\n对于己三烯（$N_{\\pi} = 6$），箱长$L_{\\mathrm{hex}}$为：\n$$\nL_{\\mathrm{hex}} = 3 l_{\\mathrm{C{=}C}} + 2 l_{\\mathrm{C{-}C}} = 3(1.34 \\times 10^{-10} \\text{ m}) + 2(1.47 \\times 10^{-10} \\text{ m}) = (4.02 + 2.94) \\times 10^{-10} \\text{ m} = 6.96 \\times 10^{-10} \\text{ m}\n$$\n提供的物理常数为：\n$h = 6.62607015 \\times 10^{-34}$ J·s\n$c = 2.99792458 \\times 10^{8}$ m·s$^{-1}$\n$m_e = 9.10938356 \\times 10^{-31}$ kg\n\n现在，计算丁二烯的吸收波长$\\lambda_{\\mathrm{but}}$：\n$$\n\\lambda_{\\mathrm{but}} = \\frac{8 m_e c (L_{\\mathrm{but}})^2}{h (N_{\\pi} + 1)} = \\frac{8(9.10938356 \\times 10^{-31})(2.99792458 \\times 10^8)(4.15 \\times 10^{-10})^2}{(6.62607015 \\times 10^{-34})(4 + 1)}\n$$\n$$\n\\lambda_{\\mathrm{but}} = \\frac{(2.184906... \\times 10^{-22})(1.72225 \\times 10^{-19})}{(6.62607015 \\times 10^{-34})(5)} = \\frac{3.76307... \\times 10^{-41}}{3.313035... \\times 10^{-33}} = 1.13579... \\times 10^{-7} \\text{ m}\n$$\n换算成纳米，即为 $\\lambda_{\\mathrm{but}} = 113.579...$ nm。\n\n接下来，计算己三烯的吸收波长$\\lambda_{\\mathrm{hex}}$：\n$$\n\\lambda_{\\mathrm{hex}} = \\frac{8 m_e c (L_{\\mathrm{hex}})^2}{h (N_{\\pi} + 1)} = \\frac{8(9.10938356 \\times 10^{-31})(2.99792458 \\times 10^8)(6.96 \\times 10^{-10})^2}{(6.62607015 \\times 10^{-34})(6 + 1)}\n$$\n$$\n\\lambda_{\\mathrm{hex}} = \\frac{(2.184906... \\times 10^{-22})(4.84416 \\times 10^{-19})}{(6.62607015 \\times 10^{-34})(7)} = \\frac{1.05862... \\times 10^{-40}}{4.638249... \\times 10^{-33}} = 2.28242... \\times 10^{-7} \\text{ m}\n$$\n换算成纳米，即为 $\\lambda_{\\mathrm{hex}} = 228.242...$ nm。\n\n最后，计算红移$\\Delta \\lambda$，即己三烯和丁二烯的吸收波长之差：\n$$\n\\Delta \\lambda = \\lambda_{\\mathrm{hex}} - \\lambda_{\\mathrm{but}} = 228.242... \\text{ nm} - 113.579... \\text{ nm} = 114.663... \\text{ nm}\n$$\n将最终结果四舍五入到四位有效数字得到$114.7$。用更高的精度重新计算得到$114.649$ nm。四舍五入到四位有效数字得到$114.6$ nm。让我们仔细重新计算：\n$\\lambda_{\\mathrm{but}} = 1.13593 \\times 10^{-7}$ m。\n$\\lambda_{\\mathrm{hex}} = 2.28242 \\times 10^{-7}$ m。\n$\\Delta \\lambda = (2.28242 - 1.13593) \\times 10^{-7}$ m = $1.14649 \\times 10^{-7}$ m = $114.649$ nm。\n四舍五入到四位有效数字得到$114.6$ nm。\n\n计算出的$\\lambda_{\\mathrm{but}} \\approx 114$ nm 和 $\\lambda_{\\mathrm{hex}} \\approx 228$ nm 的值在定性上与波长随共轭长度增加而增加的趋势一致。然而，它们在定量上低估了$\\lambda_{\\max}$的实验值（丁二烯为$217$ nm，己三烯为$258$ nm）。这种差异是意料之中的，因为自由电子模型是一个粗略的近似，它忽略了电子-电子排斥，假设箱内势能恒定，并使用了简化的箱长定义。要达到定量的准确性，需要更复杂的模型。\n\n所要求的计算是红移$\\Delta \\lambda$。\n$$\n\\Delta \\lambda = 114.649... \\text{ nm}\n$$\n四舍五入到四位有效数字，结果是$114.6$ nm。", "answer": "$$\n\\boxed{114.6}\n$$", "id": "3719614"}, {"introduction": "比尔-朗伯定律 $A = \\epsilon l c$ 是定量紫外-可见光谱分析的基石，但其实际应用受到实验不确定性的限制。本练习聚焦于分析科学的一个关键方面：误差传播。您将分析吸光度、摩尔吸光系数，尤其是现代微量测量技术中光程的不确定性，是如何共同影响最终浓度估算值的，这是评估任何定量测量可靠性的关键技能 [@problem_id:3719627]。", "problem": "进行了一项紫外-可见（UV-Vis）光谱学的微量实验，以估算溶剂中一种芳香族有机溶质的浓度。在选定的波长下，使用一种基于液滴的微量比色皿测量吸光度，其液柱高度定义了光程。由于弯月面曲率和液滴放置，微量几何结构导致了光程的不确定性。获得并表征了以下数据：\n\n- 测量的吸光度：$A = 0.350$，标准不确定度 $u_{A} = 0.005$（吸光度是无量纲的）。\n- 摩尔吸光系数：$\\epsilon = 1.25 \\times 10^{4} \\ \\mathrm{L \\ mol^{-1} \\ cm^{-1}}$，标准不确定度 $u_{\\epsilon} = 0.03 \\, \\epsilon$（来自与认证参考物质的校准；视为与 $A$ 和 $l$ 无关）。\n- 标称光程：$l = 0.100 \\ \\mathrm{cm}$，标准不确定度 $u_{l} = 0.001 \\ \\mathrm{cm}$（源于微量液滴几何形状和比色皿公差）。\n\n从比尔-朗伯关系式和吸光度的定义出发，用 $A$、$\\epsilon$ 和 $l$ 表示浓度 $c$，然后在 $A$、$\\epsilon$ 和 $l$ 相互独立的假设下，使用一阶不确定度传播推导出 $c$ 的合成标准不确定度。利用 $c$ 对 $l$ 的数学依赖关系，解释微量比色皿中的光程不确定性如何影响浓度估算的不确定性。\n\n计算浓度的合成标准不确定度，并以 $\\mathrm{mol \\ L^{-1}}$ 为单位表示您的最终数值答案。将您的答案四舍五入至三位有效数字。", "solution": "比尔-朗伯定律通过以下公式将吸光度与浓度联系起来\n$$\nA = \\epsilon \\, l \\, c,\n$$\n其中 $A$ 是无量纲的吸光度，$\\epsilon$ 是摩尔吸光系数，单位为 $\\mathrm{L \\ mol^{-1} \\ cm^{-1}}$，$l$ 是光程，单位为 $\\mathrm{cm}$，$c$ 是浓度，单位为 $\\mathrm{mol \\ L^{-1}}$。求解 $c$ 可得\n$$\nc = \\frac{A}{\\epsilon \\, l}.\n$$\n该关系式表明，$c$ 与 $\\epsilon$ 和 $l$ 成反比，与 $A$ 成正比。\n\n为了量化由 $A$、$\\epsilon$ 和 $l$ 的不确定性引起的 $c$ 的不确定性，我们使用一阶（线性）不确定度传播。对于具有标准不确定度 $u_{A}$、$u_{\\epsilon}$ 和 $u_{l}$ 的独立变量的函数 $c = f(A,\\epsilon,l)$，其合成标准不确定度 $u_{c}$ 由下式给出\n$$\nu_{c}^{2} = \\left( \\frac{\\partial c}{\\partial A} \\right)^{2} u_{A}^{2} + \\left( \\frac{\\partial c}{\\partial \\epsilon} \\right)^{2} u_{\\epsilon}^{2} + \\left( \\frac{\\partial c}{\\partial l} \\right)^{2} u_{l}^{2}.\n$$\n根据 $c = A / (\\epsilon l)$ 计算偏导数，\n$$\n\\frac{\\partial c}{\\partial A} = \\frac{1}{\\epsilon \\, l}, \\quad\n\\frac{\\partial c}{\\partial \\epsilon} = -\\frac{A}{\\epsilon^{2} \\, l} = -\\frac{c}{\\epsilon}, \\quad\n\\frac{\\partial c}{\\partial l} = -\\frac{A}{\\epsilon \\, l^{2}} = -\\frac{c}{l}.\n$$\n代入后，\n$$\nu_{c}^{2} = \\left( \\frac{1}{\\epsilon \\, l} \\right)^{2} u_{A}^{2} + \\left( \\frac{c}{\\epsilon} \\right)^{2} u_{\\epsilon}^{2} + \\left( \\frac{c}{l} \\right)^{2} u_{l}^{2}.\n$$\n以相对形式表示此式更为方便。由于 $c = A / (\\epsilon l)$，我们得到\n$$\n\\left( \\frac{u_{c}}{c} \\right)^{2} = \\left( \\frac{u_{A}}{A} \\right)^{2} + \\left( \\frac{u_{\\epsilon}}{\\epsilon} \\right)^{2} + \\left( \\frac{u_{l}}{l} \\right)^{2}.\n$$\n这表明，对于独立的输入量，$c$ 的相对方差是 $A$、$\\epsilon$ 和 $l$ 的相对方差之和。特别地，因为 $c$ 与 $l$ 成反比，光程不确定性的大小以 $\\left(u_{l}/l\\right)^{2}$ 的形式对 $c$ 的相对方差做出加性贡献。由于液滴几何形状，微量比色皿的 $l$ 通常具有较大的相对不确定度，因此即使 $u_{l}$ 的绝对值很小，一个很小的 $l$ 也会使 $u_{l}/l$ 变得显著，从而增大了 $c$ 的不确定性。\n\n我们现在使用给定的数值计算 $c$ 和 $u_{c}$。\n\n首先，计算 $c$：\n$$\nc = \\frac{A}{\\epsilon \\, l} = \\frac{0.350}{\\left(1.25 \\times 10^{4} \\ \\mathrm{L \\ mol^{-1} \\ cm^{-1}}\\right)\\left(0.100 \\ \\mathrm{cm}\\right)}.\n$$\n数值上，\n$$\n\\epsilon \\, l = \\left(1.25 \\times 10^{4}\\right)\\left(0.100\\right) = 1.25 \\times 10^{3},\n$$\n所以\n$$\nc = \\frac{0.350}{1.25 \\times 10^{3}} = 2.80 \\times 10^{-4} \\ \\mathrm{mol \\ L^{-1}}.\n$$\n\n接下来，计算相对标准不确定度：\n$$\n\\frac{u_{A}}{A} = \\frac{0.005}{0.350} = 0.014285714\\ldots,\n$$\n$$\n\\frac{u_{\\epsilon}}{\\epsilon} = 0.03,\n$$\n$$\n\\frac{u_{l}}{l} = \\frac{0.001}{0.100} = 0.01.\n$$\n相对合成标准不确定度为\n$$\n\\left( \\frac{u_{c}}{c} \\right) = \\sqrt{ \\left(0.014285714\\ldots\\right)^{2} + \\left(0.03\\right)^{2} + \\left(0.01\\right)^{2} }.\n$$\n计算平方和：\n$$\n\\left(0.014285714\\ldots\\right)^{2} \\approx 0.0002040816, \\quad\n\\left(0.03\\right)^{2} = 0.0009, \\quad\n\\left(0.01\\right)^{2} = 0.0001,\n$$\n$$\n\\text{sum} \\approx 0.0002040816 + 0.0009 + 0.0001 = 0.0012040816.\n$$\n因此，\n$$\n\\frac{u_{c}}{c} \\approx \\sqrt{0.0012040816} \\approx 0.0347.\n$$\n最后，\n$$\nu_{c} = c \\times \\left( \\frac{u_{c}}{c} \\right) \\approx \\left(2.80 \\times 10^{-4} \\ \\mathrm{mol \\ L^{-1}}\\right) \\times 0.0347 \\approx 9.716 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}.\n$$\n按要求四舍五入至三位有效数字，\n$$\nu_{c} \\approx 9.72 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}.\n$$\n\n总之，因为 $c$ 与 $l$ 成反比，$l$ 的相对不确定度会线性地传递给 $c$ 的相对不确定度。微量比色皿的光程不确定性，即使绝对值很小，当 $l$ 也很小时，也可能成为一个不可忽略的贡献因素；在此例中，它为相对方差贡献了一个加性项 $\\left(u_{l}/l\\right)^{2}$，从而增加了浓度估算的合成标准不确定度。", "answer": "$$\\boxed{9.72 \\times 10^{-6} }$$", "id": "3719627"}, {"introduction": "除了简单的定量分析，紫外-可见光谱还是研究化学平衡和测定基本物理化学常数的强大工具。这项高级练习将指导您完成测定一种指示剂染料酸解离常数（$\\mathrm{p}K_a$）的全过程。通过从第一性原理推导模型并将其与光谱滴定数据进行拟合，您将掌握如何运用吸光度测量来揭示一个分子体系重要的热力学性质 [@problem_id:3719603]。", "problem": "水中的一种酚类染料表现出其质子化形式和去质子化形式之间的酸碱平衡，这两种形式都能在紫外-可见光区域吸收光线。任务是设计一个使用紫外-可见光谱法 (UV-Vis) 的实验来确定以 $\\mathrm{p}K_a$ 表示的酸解离常数，并通过从第一性原理推导一个基于物理的模型并将其与数据拟合，从而根据测量的吸光度对酸度 ($\\mathrm{pH}$) 的数据计算 $\\mathrm{p}K_a$。\n\n您必须从适用于有机化合物光谱鉴定的基本且经过充分检验的基础开始推导：吸光度的定义和比尔-朗伯定律、一元酸的酸碱平衡质量作用定律，以及酸度 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 的定义。除了这些基础之外，您不得使用或假设任何目标公式。具体来说，从以下几点开始：独立吸收物质的吸光度可加性、吸光度与浓度和摩尔吸光系数的比例关系，以及由质量作用定律定义的共轭碱与酸的浓度比。从这些出发点，推导出在固定总染料浓度和固定光程下，吸光度对 $\\mathrm{pH}$ 的依赖关系。然后，描述一个能够产生您推导的模型所需的吸光度对 $\\mathrm{pH}$ 数据的实验，并定量说明确保科学有效性所需的考虑因素，包括染料浓度范围、光程、缓冲液选择和 $\\mathrm{pH}$ 范围、离子强度控制、波长选择以及数据质量检查。最后，实现一个算法，通过将您的模型与给定的吸光度对 $\\mathrm{pH}$ 数据进行拟合来估计 $\\mathrm{p}K_a$。\n\n您的程序必须实现以下算法任务：\n- 从指定原理推导一个模型，该模型将一元酚类染料在固定总浓度 $c_T$ 和光程 $l$ 下的双态酸碱平衡中，在波长 $\\lambda$ 处测量的吸光度 $A$ 与 $\\mathrm{pH}$ 联系起来；该模型必须明确考虑酸和碱形式在波长 $\\lambda$ 处的摩尔吸光系数以及由质量作用定律决定的平衡分数。\n- 对于在单一波长下测量的数据，将模型参数与吸光度对 $\\mathrm{pH}$ 数据进行拟合以估计 $\\mathrm{p}K_a$，同时允许该波长下酸和碱形式的摩尔吸光系数为未知数。\n- 对于在多个波长下测量的数据，执行一个全局拟合，该拟合在所有波长中使用单一的 $\\mathrm{p}K_a$，同时允许酸和碱形式具有特定于波长的摩尔吸光系数，并估计全局 $\\mathrm{p}K_a$。\n- 使用具有物理上合理边界的非线性最小二乘法，从数据中选择合理的初始猜测值，并产生数值稳定的估计。\n\n本问题中所有涉及物理量的答案都必须用适当的单位表示；例如，光程必须以 $\\mathrm{cm}$ 为单位，浓度以 $\\mathrm{M}$ 为单位，波长以 $\\mathrm{nm}$ 为单位，吸光度无单位。最终的数值输出必须是每个测试用例的估计 $\\mathrm{p}K_a$ 值，表示为无单位的浮点数，四舍五入到三位小数。本问题中没有角度测量。不需要百分比。\n\n测试套件规范：\n- 测试用例 $1$（单波长，吸光系数差异大）：\n  - 光程 $l = 1.000\\ \\mathrm{cm}$。\n  - 总染料浓度 $c_T = 2.5 \\times 10^{-5}\\ \\mathrm{M}$。\n  - 真实 $\\mathrm{p}K_a = 8.55$。\n  - 波长 $\\lambda = 525\\ \\mathrm{nm}$。\n  - 酸形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{HA}} = 18000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - 碱形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{A^-}} = 6000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - $\\mathrm{pH}$ 值：从 $6.50$ 到 $10.50$，增量为 $0.25$。\n  - 对吸光度添加标准差为 $\\sigma = 0.002$（无单位）的独立高斯噪声，使用随机种子 $12345$。\n- 测试用例 $2$（单波长，吸光系数相近）：\n  - 光程 $l = 1.000\\ \\mathrm{cm}$。\n  - 总染料浓度 $c_T = 1.5 \\times 10^{-5}\\ \\mathrm{M}$。\n  - 真实 $\\mathrm{p}K_a = 7.20$。\n  - 波长 $\\lambda = 510\\ \\mathrm{nm}$。\n  - 酸形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{HA}} = 12000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - 碱形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{A^-}} = 11000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - $\\mathrm{pH}$ 值：从 $6.00$ 到 $9.00$，增量为 $0.30$。\n  - 对吸光度添加标准差为 $\\sigma = 0.0015$ 的独立高斯噪声，使用随机种子 $54321$。\n- 测试用例 $3$（单波长，$\\mathrm{p}K_a$ 接近 $\\mathrm{pH}$ 范围下限）：\n  - 光程 $l = 1.000\\ \\mathrm{cm}$。\n  - 总染料浓度 $c_T = 1.0 \\times 10^{-5}\\ \\mathrm{M}$。\n  - 真实 $\\mathrm{p}K_a = 6.10$。\n  - 波长 $\\lambda = 500\\ \\mathrm{nm}$。\n  - 酸形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{HA}} = 14000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - 碱形式在 $\\lambda$ 处的摩尔吸光系数：$\\varepsilon_{\\mathrm{A^-}} = 4000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - $\\mathrm{pH}$ 值：从 $5.80$ 到 $8.80$，增量为 $0.25$。\n  - 对吸光度添加标准差为 $\\sigma = 0.002$ 的独立高斯噪声，使用随机种子 $202310$。\n- 测试用例 $4$（多波长全局拟合）：\n  - 光程 $l = 1.000\\ \\mathrm{cm}$。\n  - 总染料浓度 $c_T = 2.0 \\times 10^{-5}\\ \\mathrm{M}$。\n  - 真实 $\\mathrm{p}K_a = 8.00$。\n  - 波长 $\\lambda \\in \\{480, 520, 560\\}\\ \\mathrm{nm}$。\n  - 酸形式摩尔吸光系数：$\\varepsilon_{\\mathrm{HA}}(480) = 8000\\ \\mathrm{M^{-1}\\ cm^{-1}}$, $\\varepsilon_{\\mathrm{HA}}(520) = 15000\\ \\mathrm{M^{-1}\\ cm^{-1}}$, $\\varepsilon_{\\mathrm{HA}}(560) = 10000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - 碱形式摩尔吸光系数：$\\varepsilon_{\\mathrm{A^-}}(480) = 20000\\ \\mathrm{M^{-1}\\ cm^{-1}}$, $\\varepsilon_{\\mathrm{A^-}}(520) = 5000\\ \\mathrm{M^{-1}\\ cm^{-1}}$, $\\varepsilon_{\\mathrm{A^-}}(560) = 8000\\ \\mathrm{M^{-1}\\ cm^{-1}}$。\n  - $\\mathrm{pH}$ 值：从 $6.00$ 到 $10.50$，增量为 $0.50$。\n  - 对吸光度添加标准差为 $\\sigma = 0.002$ 的独立高斯噪声，使用随机种子 $777$。\n\n您的程序必须：\n- 为每个测试用例使用指定的真实参数和噪声特性构建合成的吸光度数据。\n- 将推导的模型与每个测试用例拟合以估计 $\\mathrm{p}K_a$。\n- 生成一行输出，其中包含测试用例 $1$ 到 $4$ 的估计 $\\mathrm{p}K_a$ 值，按顺序排列，作为一个逗号分隔的列表，用方括号括起来，四舍五入到三位小数（例如，$[\\mathrm{p}K_{a,1},\\mathrm{p}K_{a,2},\\mathrm{p}K_{a,3},\\mathrm{p}K_{a,4}]$）。数值是无单位的。", "solution": "该问题要求推导酚类染料吸光度随 $\\mathrm{pH}$ 变化的模型，描述获取必要数据的实验设计，并实现一种数值算法，以从合成数据中估计染料的酸解离常数 $\\mathrm{p}K_a$。\n\n### 1. 从第一性原理推导吸光度-pH模型\n\n我们从规定的基本原理开始：比尔-朗伯定律、酸碱平衡的质量作用定律，以及 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 的定义。\n\n一种一元酚类染料，表示为 $\\mathrm{HA}$，在水溶液中发生酸碱平衡：\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^+ + \\mathrm{A}^-\n$$\n其中 $\\mathrm{HA}$ 是质子化（酸）形式，$\\mathrm{A}^-$ 是去质子化（共轭碱）形式。\n\n**1.1. 酸碱平衡：**\n酸解离常数 $K_a$ 由此平衡的质量作用定律定义：\n$$\nK_a = \\frac{[\\mathrm{H}^+][\\mathrm{A}^-]}{[\\mathrm{HA}]}\n$$\n其中 $[\\cdot]$ 表示摩尔浓度。量 $\\mathrm{p}K_a$ 和 $\\mathrm{pH}$ 定义为：\n$$\n\\mathrm{p}K_a = -\\log_{10}(K_a)\n$$\n$$\n\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^+])\n$$\n重排 $K_a$ 表达式并取以 10 为底的负对数，得到 Henderson-Hasselbalch 方程：\n$$\n\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left(\\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]}\\right)\n$$\n该方程将碱和酸形式的浓度比与 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 联系起来。由此，我们可以将浓度比表示为：\n$$\n\\frac{[\\mathrm{A}^-]}{[\\mathrm{HA}]} = 10^{\\mathrm{pH} - \\mathrm{p}K_a}\n$$\n\n**1.2. 质量平衡：**\n对于固定的染料总浓度 $c_T$，质量平衡方程为：\n$$\nc_T = [\\mathrm{HA}] + [\\mathrm{A}^-]\n$$\n\n**1.3. 物质浓度作为 pH 的函数：**\n我们现在可以将 $\\mathrm{HA}$ 和 $\\mathrm{A}^-$ 的浓度表示为 $c_T$、$\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 的函数。从浓度比表达式中，我们有 $[\\mathrm{A}^-] = [\\mathrm{HA}] \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}$。将其代入质量平衡方程：\n$$\nc_T = [\\mathrm{HA}] + [\\mathrm{HA}] \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a} = [\\mathrm{HA}]\\left(1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}\\right)\n$$\n解出 $[\\mathrm{HA}]$：\n$$\n[\\mathrm{HA}] = \\frac{c_T}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}}\n$$\n因此，对于 $[\\mathrm{A}^-]$：\n$$\n[\\mathrm{A}^-] = c_T - [\\mathrm{HA}] = c_T - \\frac{c_T}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} = \\frac{c_T \\cdot \\left(1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}\\right) - c_T}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} = \\frac{c_T \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}}\n$$\n\n**1.4. 比尔-朗伯定律的应用：**\n比尔-朗伯定律指出，吸光度 $A$ 与吸收物质的浓度和光程 $l$ 成正比。对于独立吸收物质的混合物，在给定波长 $\\lambda$ 下的总吸光度是各个吸光度的总和：\n$$\nA(\\lambda) = A_{\\mathrm{HA}}(\\lambda) + A_{\\mathrm{A}^-}(\\lambda)\n$$\n其中 $A_{\\mathrm{HA}}$ 和 $A_{\\mathrm{A}^-}$ 分别是酸和碱形式的吸光度。将比尔-朗伯定律应用于每种物质：\n$$\nA(\\lambda) = \\varepsilon_{\\mathrm{HA}}(\\lambda)[\\mathrm{HA}]l + \\varepsilon_{\\mathrm{A}^-}(\\lambda)[\\mathrm{A}^-]l\n$$\n这里，$\\varepsilon_{\\mathrm{HA}}(\\lambda)$ 和 $\\varepsilon_{\\mathrm{A}^-}(\\lambda)$ 是酸和碱形式在波长 $\\lambda$ 处的摩尔吸光系数（单位为 $\\mathrm{M^{-1} cm^{-1}}$），$l$ 是光程（单位为 $\\mathrm{cm}$）。\n\n**1.5. 最终模型：**\n将 $[\\mathrm{HA}]$ 和 $[\\mathrm{A}^-]$ 的表达式代入吸光度方程，得到关联总吸光度与 $\\mathrm{pH}$ 的最终模型：\n$$\nA(\\mathrm{pH}, \\lambda) = l \\left( \\varepsilon_{\\mathrm{HA}}(\\lambda)\\frac{c_T}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} + \\varepsilon_{\\mathrm{A}^-}(\\lambda)\\frac{c_T \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} \\right)\n$$\n这个方程可以通过提取公因式来简化：\n$$\nA(\\mathrm{pH}, \\lambda) = l c_T \\left( \\frac{\\varepsilon_{\\mathrm{HA}}(\\lambda) + \\varepsilon_{\\mathrm{A}^-}(\\lambda) \\cdot 10^{\\mathrm{pH} - \\mathrm{p}K_a}}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}} \\right)\n$$\n这个S型模型描述了在特定波长 $\\lambda$ 下吸光度作为 $\\mathrm{pH}$ 的函数。通过将此模型与实验数据拟合，可以确定的参数是染料的 $\\mathrm{p}K_a$ 及其两种形式的摩尔吸光系数 $\\varepsilon_{\\mathrm{HA}}(\\lambda)$ 和 $\\varepsilon_{\\mathrm{A}^-}(\\lambda)$。\n\n### 2. 实验设计\n\n为了获取拟合此模型所需的数据，必须进行精心设计的紫外-可见分光光度滴定实验。\n\n1.  **染料浓度 ($c_T$)**：必须选择总染料浓度 $c_T$，以确保吸光度值 $A$ 位于分光光度计的线性动态范围内（通常为 $A \\in [0.1, 1.5]$）。考虑到染料的典型摩尔吸光系数（$\\varepsilon \\approx 10^4 - 10^5 \\ \\mathrm{M^{-1} cm^{-1}}$）和标准光程 $l = 1.000 \\ \\mathrm{cm}$，浓度范围在 $c_T = 10^{-5} \\ \\mathrm{M}$ 到 $10^{-4} \\ \\mathrm{M}$ 是合适的。应使用单一的染料储备溶液来制备所有样品，以确保 $c_T$ 保持恒定。\n\n2.  **缓冲体系和 pH 范围**：必须制备一系列缓冲溶液以精确控制染料溶液的 $\\mathrm{pH}$。缓冲液在感兴趣的波长范围内必须是透明的。每个溶液的 $\\mathrm{pH}$ 必须用校准过的 pH 计精确测量。pH 范围应至少跨越 $\\mathrm{p}K_a \\pm 2$ 个单位（例如，对于预期 $\\mathrm{p}K_a \\approx 8.5$ 的酚，从 $\\mathrm{pH} = 6$ 到 $\\mathrm{pH} = 11$），以观察到对应于几乎纯酸（$\\mathrm{pH} \\ll \\mathrm{p}K_a$）和碱（$\\mathrm{pH} \\gg \\mathrm{p}K_a$）形式的吸光度平台。\n\n3.  **离子强度控制**：热力学酸解离常数 $K_a$ 是根据活度而非浓度定义的。它们之间的关系受溶液离子强度的影响。为了确定一个一致的表观 $\\mathrm{p}K_a$，应通过添加高浓度（例如 $0.1 \\ \\mathrm{M}$）的惰性盐如 $\\mathrm{KCl}$ 或 $\\mathrm{NaCl}$ 来保持所有样品的离子强度恒定。\n\n4.  **波长选择**：应在一个或多个波长下进行测量。确定 $\\mathrm{p}K_a$ 的最佳波长是酸和碱形式之间摩尔吸光系数差异 $|\\varepsilon_{\\mathrm{HA}} - \\varepsilon_{\\mathrm{A}^-}|$ 最大的波长。这使得滴定过程中吸光度的变化最大化，从而提高了拟合的信噪比。在多个波长收集数据并进行全局拟合（其中 $\\mathrm{p}K_a$ 是共享参数）可以得到更稳健可靠的估计。在等吸收点（其中 $\\varepsilon_{\\mathrm{HA}} = \\varepsilon_{\\mathrm{A}^-}$）进行测量是一个有用的诊断工具，因为如果系统是简单的双态平衡，吸光度应随 $\\mathrm{pH}$ 保持不变。\n\n5.  **分光光度计和数据采集**：为保证稳定性，首选双光束分光光度计。对于每次 $\\mathrm{pH}$ 测量，应使用含有相同 pH 的缓冲溶液（不含染料）的参比比色皿来校正任何背景吸收或散射。温度必须受控并保持恒定，因为 $K_a$ 是温度依赖的。\n\n### 3. 算法实现\n\n$\\mathrm{p}K_a$ 和摩尔吸光系数的估计是一个非线性最小二乘拟合问题。\n\n-   **模型函数**：推导出的方程 $A(\\mathrm{pH}, \\lambda)$ 是要与实验数据 $(A_i, \\mathrm{pH}_i)$ 拟合的模型。对于单个波长，要拟合的参数是 $(\\mathrm{p}K_a, \\varepsilon_{\\mathrm{HA}}, \\varepsilon_{\\mathrm{A}^-})$。$l$ 和 $c_T$ 的值是已知的常数。\n\n-   **非线性最小二乘法**：诸如 `scipy.optimize.curve_fit` 中可用的 Levenberg-Marquardt 等算法适用于此任务。它最小化残差平方和 $SS_{res} = \\sum_i (A_{i,obs} - A_{i,model})^2$。\n\n-   **初始猜测**：拟合的收敛性和正确性取决于提供合理的初始参数估计 ($p_0$)：\n    -   $\\varepsilon_{\\mathrm{HA}}$：可以从低 $\\mathrm{pH}$ 处的吸光度平台估计，$A_{acid} \\approx \\varepsilon_{\\mathrm{HA}} l c_T$。\n    -   $\\varepsilon_{\\mathrm{A}^-}$：可以从高 $\\mathrm{pH}$ 处的吸光度平台估计，$A_{base} \\approx \\varepsilon_{\\mathrm{A}^-} l c_T$。\n    -   $\\mathrm{p}K_a$：可以估计为吸光度是两个平台平均值时的 $\\mathrm{pH}$，$A = (A_{acid} + A_{base})/2$。\n\n-   **参数边界**：为确保物理真实性，拟合期间应对参数强制执行边界。摩尔吸光系数必须为非负值：$\\varepsilon_{\\mathrm{HA}} \\ge 0$ 和 $\\varepsilon_{\\mathrm{A}^-} \\ge 0$。$\\mathrm{p}K_a$ 可以被限制在一个合理的范围内，例如实验的 $\\mathrm{pH}$ 范围。\n\n-   **全局拟合（多波长）**：对于在多个波长（$\\lambda_1, \\lambda_2, \\ldots$）收集的数据，执行全局拟合。所有数据集同时进行拟合。$\\mathrm{p}K_a$ 是一个单一的全局参数，对所有数据集通用。每个波长 $\\lambda_j$ 都有其自己的一对摩尔吸光系数 $(\\varepsilon_{\\mathrm{HA}}(\\lambda_j), \\varepsilon_{\\mathrm{A}^-}(\\lambda_j))$。这将参数总数增加到 $1 + 2N_{\\lambda}$（其中 $N_{\\lambda}$ 是波长数），但增加的数据冗余度可以得到更稳健的 $\\mathrm{p}K_a$ 估计。实现时需要构建输入数据和模型函数，以处理与一个公共参数相关的多个参数集。\n\n所提供的 Python 代码实现了该算法，为指定的测试用例生成合成数据，然后应用拟合程序来估计 $\\mathrm{p}K_a$。对于单波长和多波长情况，都使用了一个统一的拟合函数，该函数将单波长问题视为 $N_{\\lambda}=1$ 的全局拟合。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves for the pKa of a phenolic dye from simulated UV-Vis data\n    for four different test cases, including single and multi-wavelength fits.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (single wavelength, well-separated absorptivities)\n        {\n            \"l\": 1.000,  # cm\n            \"c_T\": 2.5e-5,  # M\n            \"true_pKa\": 8.55,\n            \"wavelengths\": [525],  # nm\n            \"eps_HA\": [18000],  # M^-1 cm^-1\n            \"eps_A\": [6000],   # M^-1 cm^-1\n            \"ph_range\": (6.50, 10.50),\n            \"ph_step\": 0.25,\n            \"noise_sigma\": 0.002,\n            \"seed\": 12345,\n        },\n        # Test case 2 (single wavelength, nearly equal absorptivities)\n        {\n            \"l\": 1.000,\n            \"c_T\": 1.5e-5,\n            \"true_pKa\": 7.20,\n            \"wavelengths\": [510],\n            \"eps_HA\": [12000],\n            \"eps_A\": [11000],\n            \"ph_range\": (6.00, 9.00),\n            \"ph_step\": 0.30,\n            \"noise_sigma\": 0.0015,\n            \"seed\": 54321,\n        },\n        # Test case 3 (single wavelength, pKa near lower boundary of pH span)\n        {\n            \"l\": 1.000,\n            \"c_T\": 1.0e-5,\n            \"true_pKa\": 6.10,\n            \"wavelengths\": [500],\n            \"eps_HA\": [14000],\n            \"eps_A\": [4000],\n            \"ph_range\": (5.80, 8.80),\n            \"ph_step\": 0.25,\n            \"noise_sigma\": 0.002,\n            \"seed\": 202310,\n        },\n        # Test case 4 (multi-wavelength global fit)\n        {\n            \"l\": 1.000,\n            \"c_T\": 2.0e-5,\n            \"true_pKa\": 8.00,\n            \"wavelengths\": [480, 520, 560],\n            \"eps_HA\": [8000, 15000, 10000],\n            \"eps_A\": [20000, 5000, 8000],\n            \"ph_range\": (6.00, 10.50),\n            \"ph_step\": 0.50,\n            \"noise_sigma\": 0.002,\n            \"seed\": 777,\n        },\n    ]\n\n    estimated_pKas = []\n\n    for case in test_cases:\n        l = case[\"l\"]\n        c_T = case[\"c_T\"]\n        wavelengths = case[\"wavelengths\"]\n        num_wls = len(wavelengths)\n        eps_HA_true = np.array(case[\"eps_HA\"])\n        eps_A_true = np.array(case[\"eps_A\"])\n        \n        # pH vector\n        ph_values = np.arange(case[\"ph_range\"][0], case[\"ph_range\"][1] + case[\"ph_step\"] / 2.0, case[\"ph_step\"])\n        num_phs = len(ph_values)\n        \n        # Prepare data structured for global fitting\n        # Independent variables: a (2, N) array of [pH, wavelength_index]\n        ph_fit = np.tile(ph_values, num_wls)\n        wl_idx_fit = np.repeat(np.arange(num_wls), num_phs)\n        x_data = np.vstack((ph_fit, wl_idx_fit))\n\n        # Generate absorbance data\n        rng = np.random.default_rng(case[\"seed\"])\n        y_data_true = np.zeros(num_phs * num_wls)\n\n        for i in range(num_wls):\n            start, end = i * num_phs, (i + 1) * num_phs\n            term = 10**(ph_values - case[\"true_pKa\"])\n            y_data_true[start:end] = l * c_T * (eps_HA_true[i] + eps_A_true[i] * term) / (1 + term)\n\n        y_data_noisy = y_data_true + rng.normal(0, case[\"noise_sigma\"], size=y_data_true.shape)\n\n        # Unified model function for both single- and multi-wavelength fitting\n        def model_global(x, pKa, *eps_all):\n            ph, wl_indices = x[0], x[1].astype(int)\n            \n            eps_HA_params = np.array(eps_all[0::2])\n            eps_A_params = np.array(eps_all[1::2])\n\n            eps_HA = eps_HA_params[wl_indices]\n            eps_A = eps_A_params[wl_indices]\n            \n            term = 10**(ph - pKa)\n            absorbance = l * c_T * (eps_HA + eps_A * term) / (1 + term)\n            return absorbance\n\n        # Initial guesses\n        p0 = []\n        bounds_lower = []\n        bounds_upper = []\n\n        # Guess pKa from wavelength with largest absorbance change\n        abs_diffs = []\n        for i in range(num_wls):\n            start, end = i * num_phs, (i + 1) * num_phs\n            wl_data = y_data_noisy[start:end]\n            abs_diffs.append(np.abs(wl_data[-1] - wl_data[0]))\n        \n        best_wl_idx = np.argmax(abs_diffs)\n        start, end = best_wl_idx * num_phs, (best_wl_idx + 1) * num_phs\n        best_wl_data = y_data_noisy[start:end]\n        \n        A_min_obs = best_wl_data[0]\n        A_max_obs = best_wl_data[-1]\n\n        # The absorbance might increase or decrease with pH\n        if A_min_obs > A_max_obs:\n            A_min_obs, A_max_obs = A_max_obs, A_min_obs\n\n        A_mid = (A_min_obs + A_max_obs) / 2.0\n        pKa_guess_idx = np.argmin(np.abs(best_wl_data - A_mid))\n        pKa_guess = ph_values[pKa_guess_idx]\n        \n        p0.append(pKa_guess)\n        bounds_lower.append(case[\"ph_range\"][0] - 1.0)\n        bounds_upper.append(case[\"ph_range\"][1] + 1.0)\n        \n        # Guess epsilons for each wavelength\n        for i in range(num_wls):\n            start, end = i * num_phs, (i + 1) * num_phs\n            wl_data = y_data_noisy[start:end]\n            A_acid_guess = wl_data[0]\n            A_base_guess = wl_data[-1]\n\n            eps_HA_guess = A_acid_guess / (l * c_T)\n            eps_A_guess = A_base_guess / (l * c_T)\n\n            p0.extend([eps_HA_guess, eps_A_guess])\n            bounds_lower.extend([0, 0])\n            bounds_upper.extend([np.inf, np.inf])\n\n        # Perform the fit\n        try:\n            params, _ = curve_fit(\n                model_global,\n                x_data,\n                y_data_noisy,\n                p0=p0,\n                bounds=(bounds_lower, bounds_upper)\n            )\n            estimated_pKa = params[0]\n        except RuntimeError:\n            # Fallback if fit fails\n            estimated_pKa = np.nan\n            \n        estimated_pKas.append(estimated_pKa)\n\n    # Format the final output\n    formatted_results = [f\"{pKa:.3f}\" for pKa in estimated_pKas]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3719603"}]}