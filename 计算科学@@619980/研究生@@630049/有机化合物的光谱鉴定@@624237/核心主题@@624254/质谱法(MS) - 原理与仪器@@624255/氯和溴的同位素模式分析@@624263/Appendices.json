{"hands_on_practices": [{"introduction": "在质谱分析中，一个常见的场景是鉴定一个同时含有一个氯原子和一个溴原子的化合物。这项练习将计算其 $M+2$ 峰的强度，该强度源于两种不同的同位素组合。通过这个实践，你将巩固一个基本原则：对于导致相同观测质量的互斥事件，其总概率是各事件概率之和 [@problem_id:3709377]。", "problem": "一未知、价键饱和的中性有机分子，仅由碳、氢、氮、氧、氯和溴组成，通过电子电离质谱法（EI-MS）进行分析，产生奇电子分子离子 $\\left[\\text{M}\\right]^{+\\bullet}$。$m/z$ 附近的分子离子簇仅表现出由卤素引起的 $+2$ 单位间距，且 $\\left[\\text{M}\\right]^{+\\bullet}$ 的标称单同位素 $m/z$ 为奇数。已知该分子（从补充的结构分析中）含有恰好1个氯原子和恰好1个溴原子。假设对于单同位素组成，所有非卤素元素均以 $^{12}\\text{C}$、$^{1}\\text{H}$、$^{14}\\text{N}$ 和 $^{16}\\text{O}$ 的形式存在，并忽略这些元素的重同位素对 $M$、$M+2$ 和 $M+4$ 离子簇的贡献。\n\n基本同位素事实：自然同位素丰度为，$^{35}\\text{Cl}$ 的分数丰度为 $f_{\\text{Cl}}=0.7576$，$‌^{37}\\text{Cl}$ 的分数丰度为 $1-f_{\\text{Cl}}=0.2424$，$‌^{79}\\text{Br}$ 的分数丰度为 $f_{\\text{Br}}=0.5065$，$‌^{81}\\text{Br}$ 的分数丰度为 $1-f_{\\text{Br}}=0.4935$。您可以假设不同卤素原子上的同位素取代是统计独立的，并且卤素取代是局部离子簇中 $+2$ 和 $+4$ 间距的唯一来源。\n\n从这些基本定义和事实出发，并引用价键饱和有机分子的奇偶质量规则（氮规则），从第一性原理推导 $\\left[\\text{M}\\right]^{+\\bullet}$ 离子簇出现在 $M+2$ 处的归一化概率（等同于归一化相对强度），该现象完全是由于这个含1个氯和1个溴的分子中的卤素同位素取代所致。将最终答案表示为小数，并四舍五入至4位有效数字。最终答案无需单位。", "solution": "经评估，该问题陈述在科学上是合理的、提法恰当、客观且自洽的。它提出了一个质谱分析中的标准情景，可以从第一性原理解决。包括应用氮规则在内的前提，均与既定的化学原理一致。所提供的同位素丰度在事实上是正确的，并且简化的假设被明确陈述，适合用于分离所测试的特定概念。因此，该问题是有效的。\n\n问题要求计算在质荷比为 $M+2$ 处观测到分子离子峰的归一化概率，其中 $M$ 是分子的标称单同位素质量。该分子含有恰好一个氯原子和一个溴原子。分子离子簇的同位素模式由氯和溴同位素的自然丰度决定。\n\n让我们根据提供的信息定义相关同位素的分数丰度：\n$^{35}\\text{Cl}$ 的分数丰度为 $f_{^{35}\\text{Cl}} = 0.7576$。\n$^{37}\\text{Cl}$ 的分数丰度为 $f_{^{37}\\text{Cl}} = 1 - f_{^{35}\\text{Cl}} = 1 - 0.7576 = 0.2424$。\n$^{79}\\text{Br}$ 的分数丰度为 $f_{^{79}\\text{Br}} = 0.5065$。\n$^{81}\\text{Br}$ 的分数丰度为 $f_{^{81}\\text{Br}} = 1 - f_{^{79}\\text{Br}} = 1 - 0.5065 = 0.4935$。\n\n问题陈述指出，可以忽略除氯和溴以外的元素（例如，来自 $^{13}\\text{C}$）对同位素簇的贡献。这将分析简化为仅考虑卤素同位素的组合。\n\n单同位素峰，记为 $M$，对应于含有每种元素最轻、最常见同位素的分子离子。对于卤素，它们是 $^{35}\\text{Cl}$ 和 $^{79}\\text{Br}$。假设统计独立性，这种特定同位素组合的概率 $P(M)$ 是各个同位素丰度的乘积：\n$$P(M) = P(^{35}\\text{Cl}, ^{79}\\text{Br}) = f_{^{35}\\text{Cl}} \\times f_{^{79}\\text{Br}}$$\n\n$M+2$ 峰对应于比单同位素物种重2个原子质量单位的分子离子。对于一个含有一个氯原子和一个溴原子的分子，这可以通过两种互斥的方式发生：\n1.  分子含有 $^{37}\\text{Cl}$（质量增加 $37-35=2$）和 $^{79}\\text{Br}$（与参考相比无变化）。\n2.  分子含有 $^{35}\\text{Cl}$（与参考相比无变化）和 $^{81}\\text{Br}$（质量增加 $81-79=2$）。\n\n观测到 $M+2$ 峰的总概率 $P(M+2)$ 是这两个事件概率的总和：\n$$P(M+2) = P(^{37}\\text{Cl}, ^{79}\\text{Br}) + P(^{35}\\text{Cl}, ^{81}\\text{Br})$$\n$$P(M+2) = (f_{^{37}\\text{Cl}} \\times f_{^{79}\\text{Br}}) + (f_{^{35}\\text{Cl}} \\times f_{^{81}\\text{Br}})$$\n\n$M+4$ 峰对应于质量增加4个原子质量单位。当分子同时含有两种较重的同位素时发生：$^{37}\\text{Cl}$（质量增加2）和 $^{81}\\text{Br}$（质量增加2）。这种组合的概率 $P(M+4)$ 是：\n$$P(M+4) = P(^{37}\\text{Cl}, ^{81}\\text{Br}) = f_{^{37}\\text{Cl}} \\times f_{^{81}\\text{Br}}$$\n\n“归一化概率”是特定结果的概率相对于所有可能结果概率总和的比值。在这种情况下，所有可能结果的集合包括 $M$、$M+2$ 和 $M+4$ 峰。让我们计算这些概率的总和 $P_{\\text{total}}$：\n$$P_{\\text{total}} = P(M) + P(M+2) + P(M+4)$$\n$$P_{\\text{total}} = (f_{^{35}\\text{Cl}} f_{^{79}\\text{Br}}) + (f_{^{37}\\text{Cl}} f_{^{79}\\text{Br}} + f_{^{35}\\text{Cl}} f_{^{81}\\text{Br}}) + (f_{^{37}\\text{Cl}} f_{^{81}\\text{Br}})$$\n对各项进行因式分解：\n$$P_{\\text{total}} = f_{^{79}\\text{Br}}(f_{^{35}\\text{Cl}} + f_{^{37}\\text{Cl}}) + f_{^{81}\\text{Br}}(f_{^{35}\\text{Cl}} + f_{^{37}\\text{Cl}})$$\n$$P_{\\text{total}} = (f_{^{35}\\text{Cl}} + f_{^{37}\\text{Cl}})(f_{^{79}\\text{Br}} + f_{^{81}\\text{Br}})$$\n由于 $f_{^{35}\\text{Cl}} + f_{^{37}\\text{Cl}} = 1$ 且 $f_{^{79}\\text{Br}} + f_{^{81}\\text{Br}} = 1$，总概率为：\n$$P_{\\text{total}} = 1 \\times 1 = 1$$\n这证实了在问题的假设下，所考虑的同位素组合集合涵盖了所有可能性。因此，计算出的值 $P(M+2)$ 已经是归一化概率。该值也等同于分子离子簇中 $M+2$ 峰的归一化相对强度。\n\n现在，我们将数值代入 $P(M+2)$ 的表达式中：\n$$P(M+2) = (f_{^{37}\\text{Cl}} \\times f_{^{79}\\text{Br}}) + (f_{^{35}\\text{Cl}} \\times f_{^{81}\\text{Br}})$$\n$$P(M+2) = (0.2424 \\times 0.5065) + (0.7576 \\times 0.4935)$$\n分别计算这两项：\n$$0.2424 \\times 0.5065 = 0.1227936$$\n$$0.7576 \\times 0.4935 = 0.3739176$$\n将这些值相加，得到 $M+2$ 峰的总概率：\n$$P(M+2) = 0.1227936 + 0.3739176 = 0.4967112$$\n\n问题要求将答案四舍五入到4位有效数字。\n$$P(M+2) \\approx 0.4967$$\n\n这就是由于卤素同位素取代，分子离子簇出现在 $M+2$ 处的归一化概率。", "answer": "$$\\boxed{0.4967}$$", "id": "3709377"}, {"introduction": "在掌握了基础的图谱计算后，这个问题将带你探索一个含有三个卤素原子的更复杂的分子。我们将聚焦于 $M+6$ 峰，它是一个强大的诊断工具。计算其相对强度将展示，更高质量数的同位素峰如何为确定分子中卤素原子的总数提供明确信息 [@problem_id:3709348]。", "problem": "电子电离（EI）质谱法观测到的一个未知有机分子离子，已知是三卤代的，含有三个卤素原子，每个卤素原子是氯或溴。在同位素模式分析中，标称质量为 $M+6$ 的峰对于三卤代框架具有诊断意义，因为每个重卤素同位素相对于同一元素的轻同位素的取代都会导致 $+2$ 原子质量单位的增量。对于氯，轻同位素是 $^{35}\\text{Cl}$，重同位素是 $^{37}\\text{Cl}$；对于溴，轻同位素是 $^{79}\\text{Br}$，重同位素是 $^{81}\\text{Br}$。假设以下自然同位素丰度（在每个卤素位点上被视为同位素选择的独立概率）：$^{35}\\text{Cl}$ 的分数丰度为 $p_{\\text{Cl}}=0.75780$，$‌^{37}\\text{Cl}$ 的分数丰度为 $q_{\\text{Cl}}=0.24220$；$^{79}\\text{Br}$ 的分数丰度为 $p_{\\text{Br}}=0.50690$，$‌^{81}\\text{Br}$ 的分数丰度为 $q_{\\text{Br}}=0.49310$。忽略非卤素原子的同位素对 $M+6$ 区域的贡献，并假设标称质量间距主要由卤素同位素取代决定。\n\n从独立同位素选择的第一性原理出发，以及 $M$ 定义为全轻同位素组成、$M+6$ 定义为恰好含有三个重卤素同位素的组成，推导组成为 $\\text{ClBr}_{2}$ 的三卤代分子离子的 $M+6$ 峰强度与 $M$ 峰强度的概率比 $R$，并计算其数值。将最终答案表示为四舍五入到四位有效数字的小数。", "solution": "问题陈述要求推导和计算组成为 $\\text{ClBr}_{2}$ 的三卤代分子离子的 $M+6$ 峰强度与 $M$ 峰强度的概率比 $R$。\n\n首先，对问题陈述进行验证。\n已知条件如下：\n- 分子离子组成：$\\text{ClBr}_{2}$（一个氯原子，两个溴原子；共3个卤素原子）。\n- 同位素丰度：\n  - 氯：$p_{\\text{Cl}} = P(^{35}\\text{Cl}) = 0.75780$，$q_{\\text{Cl}} = P(^{37}\\text{Cl}) = 0.24220$。\n  - 溴：$p_{\\text{Br}} = P(^{79}\\text{Br}) = 0.50690$，$q_{\\text{Br}} = P(^{81}\\text{Br}) = 0.49310$。\n- 定义：\n  - $M$ 峰：对应于全轻同位素组成（$^{35}\\text{Cl}$，$^{79}\\text{Br}$）。\n  - $M+6$ 峰：对应于恰好含有三个重卤素同位素的组成（$^{37}\\text{Cl}$，$^{81}\\text{Br}$）。\n- 假设：\n  - 每个卤素位点上的同位素选择是独立的。\n  - 非卤素原子的同位素贡献被忽略。\n\n该问题在科学上基于质谱法和同位素分布的原理。所提供的同位素丰度在事实上是正确的（$0.75780 + 0.24220 = 1.00000$ 且 $0.50690 + 0.49310 = 1.00000$）。该问题陈述清晰、客观，并包含唯一解所需的所有必要信息，没有任何矛盾。因此，它被认为是有效的。\n\n对于给定的同位素体，质谱峰的相对强度 $I$ 与该特定同位素组合在分子中出现的概率 $P$ 成正比。因此，所求比率 $R$ 是 $M+6$ 同位素体的概率 $P(M+6)$ 与 $M$ 同位素体的概率 $P(M)$ 之比。\n$$R = \\frac{I_{M+6}}{I_M} = \\frac{P(M+6)}{P(M)}$$\n问题指出，每个原子的同位素选择是独立的。因此，特定同位素体的总概率是各个同位素概率的乘积。\n\n$M$ 峰对应于仅包含最轻同位素的分子。对于组成 $\\text{ClBr}_{2}$，这是物种 $^{35}\\text{Cl}(^{79}\\text{Br})_{2}$。该同位素体的概率 $P(M)$ 是：\n$$P(M) = P(^{35}\\text{Cl}) \\times P(^{79}\\text{Br}) \\times P(^{79}\\text{Br})$$\n使用给定的分数丰度：\n$$P(M) = p_{\\text{Cl}} \\cdot p_{\\text{Br}}^{2}$$\n\n$M+6$ 峰对应于所有三个卤素原子都是重同位素的分子。这是一致的，因为每个重同位素（$^{37}\\text{Cl}$ 或 $^{81}\\text{Br}$）相对于其较轻的对应物增加了 $+2$ amu，所以三个这样的取代导致质量位移为 $3 \\times (+2) = +6$ amu。对于组成 $\\text{ClBr}_{2}$，这是物种 $^{37}\\text{Cl}(^{81}\\text{Br})_{2}$。该同位素体的概率 $P(M+6)$ 是：\n$$P(M+6) = P(^{37}\\text{Cl}) \\times P(^{81}\\text{Br}) \\times P(^{81}\\text{Br})$$\n使用给定的分数丰度：\n$$P(M+6) = q_{\\text{Cl}} \\cdot q_{\\text{Br}}^{2}$$\n\n然后通过将 $P(M+6)$ 除以 $P(M)$ 来推导比率 $R$：\n$$R = \\frac{q_{\\text{Cl}} q_{\\text{Br}}^{2}}{p_{\\text{Cl}} p_{\\text{Br}}^{2}}$$\n这可以改写为：\n$$R = \\left(\\frac{q_{\\text{Cl}}}{p_{\\text{Cl}}}\\right) \\left(\\frac{q_{\\text{Br}}}{p_{\\text{Br}}}\\right)^{2}$$\n\n我们现在代入问题中提供的数值：\n$$p_{\\text{Cl}} = 0.75780$$\n$$q_{\\text{Cl}} = 0.24220$$\n$$p_{\\text{Br}} = 0.50690$$\n$$q_{\\text{Br}} = 0.49310$$\n\n将这些值代入 $R$ 的表达式中：\n$$R = \\left(\\frac{0.24220}{0.75780}\\right) \\left(\\frac{0.49310}{0.50690}\\right)^{2}$$\n计算表达式：\n$$R \\approx (0.3196093956...) \\times (0.9727756954...)^{2}$$\n$$R \\approx (0.3196093956...) \\times (0.946292275...)$$\n$$R \\approx 0.302425301...$$\n\n问题要求将最终数值表示为四舍五入到四位有效数字的小数。对计算出的值进行四舍五入得到：\n$$R \\approx 0.3024$$\n这就是针对指定分子离子的 $M+6$ 峰强度与 $M$ 峰强度的推导出的概率比。", "answer": "$$\\boxed{0.3024}$$", "id": "3709348"}, {"introduction": "这项最终实践将从计算单个图谱转向解决一个真实的分析挑战：对卤代化合物混合物的重叠质谱进行解卷积。你将基于理论同位素模式构建一个计算模型，并用它来确定未知混合物的组成。这项练习弥合了基本原理与现代数据驱动的化学分析应用之间的鸿沟 [@problem_id:3709432]。", "problem": "您的任务是为卤代有机化合物的同位素模式构建一个计算模型，并从高分辨率质谱（HRMS）的重叠峰中估计混合物组成。该场景涉及有机化合物质谱鉴定中氯和溴的同位素模式分析。其关键物理基础是，分子离子附近的实验质谱由一系列离散的峰组成，这些峰位于质荷比（m/z）位置上，以$2$个原子质量单位为增量分隔，这对应于重同位素$^{37}\\text{Cl}$和$^{81}\\text{Br}$的存在，并且强度在共存物质之间是可加的。\n\n从以下基本且广为接受的事实出发：\n- 氯的自然同位素丰度为：$^{35}\\text{Cl}$ 是 $p^{\\text{Cl}}_{35} = 0.7578$，$^{37}\\text{Cl}$ 是 $p^{\\text{Cl}}_{37} = 0.2422$。\n- 溴的自然同位素丰度为：$^{79}\\text{Br}$ 是 $p^{\\text{Br}}_{79} = 0.5069$，$^{81}\\text{Br}$ 是 $p^{\\text{Br}}_{81} = 0.4931$。\n- 对于一个含有$n$个氯原子的化合物，其含有$k$个重同位素$^{37}\\text{Cl}$的分布（在峰位$M+2k$处）遵循二项分布定律，其概率质量为$\\binom{n}{k} (p^{\\text{Cl}}_{37})^k (p^{\\text{Cl}}_{35})^{n-k}$，溴的情况也类似。\n- 对于混合卤素含量，其模式由氯和溴计数的独立二项分布的离散卷积给出，得到的峰概率总和为$1$。\n\n考虑以下可能对质谱有贡献的候选物质，每种物质最多含有$2$个卤素原子：\n- 物质 $1$：一氯代物，含有$1$个氯原子和$0$个溴原子。\n- 物质 $2$：一溴代物，含有$0$个氯原子和$1$个溴原子。\n- 物质 $3$：二氯代物，含有$2$个氯原子和$0$个溴原子。\n- 物质 $4$：二溴代物，含有$0$个氯原子和$2$个溴原子。\n- 物质 $5$：氯溴代物，含有$1$个氯原子和$1$个溴原子。\n\n假设一个离散谱由一个强度向量 $\\mathbf{y}$ 表示，该向量有$3$个区间，对应于$M$、$M+2$和$M+4$处的峰，并且每个候选物质都有一个理论上的$3$区间概率向量 $\\mathbf{s}_i$，该向量根据上述同位素定律构建。设未知的非负混合权重为 $\\mathbf{w} = [w_1,w_2,w_3,w_4,w_5]^\\top$，代表五种候选物质的贡献，并假设加性叠加，即观测到的强度向量满足 $\\mathbf{y} \\approx \\sum_{i=1}^{5} w_i \\mathbf{s}_i$。\n\n您的任务是编写一个程序，该程序：\n- 构建一个 $3 \\times 5$ 的设计矩阵 $\\mathbf{A}$，其列是按上述顺序排列的五种物质的理论模式 $\\mathbf{s}_i$。\n- 对每个提供的测试用例，解决非负最小二乘问题以估计 $\\mathbf{w}$：\n  $$\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{y} \\right\\|_2^2,$$\n  然后对解进行归一化以获得混合物分数：\n  $$\\tilde{\\mathbf{w}} = \\frac{\\mathbf{w}}{\\sum_{i=1}^{5} w_i},$$\n  约定如果 $\\sum_{i=1}^{5} w_i = 0$，则 $\\tilde{\\mathbf{w}}$ 为零向量。\n- 返回估计的混合物分数 $\\tilde{\\mathbf{w}}$，四舍五入到$6$位小数。\n\n所有强度值都是无单位的小数，必须按此方式处理和报告。此问题中不涉及角度；不需要角度单位。同位素模式必须根据所述的自然丰度和同位素取代的独立性推导得出。除了基本的二项分布和卷积原理外，不要使用任何捷径公式。\n\n测试套件：\n- 测试用例 $1$（理想情况；一氯代物和一溴代物重叠）：\n  $$\\mathbf{y}_1 = [\\,0.65744,\\,0.34256,\\,0\\,].$$\n- 测试用例 $2$（边界情况；纯二溴代物）：\n  $$\\mathbf{y}_2 = [\\,0.25694761,\\,0.49990478,\\,0.24314761\\,].$$\n- 测试用例 $3$（可辨识性压力测试；二氯代物和氯溴代物的等量混合物）：\n  $$\\mathbf{y}_3 = [\\,0.47919483,\\,0.43176034,\\,0.08904483\\,].$$\n- 测试用例 $4$（边缘情况；纯一氯代物）：\n  $$\\mathbf{y}_4 = [\\,0.7578,\\,0.2422,\\,0\\,].$$\n\n答案规格：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表，用方括号括起来，按测试用例的顺序列出结果。每个结果本身是一个包含$5$个浮点数的列表，代表物种 $[\\,\\text{一氯代物},\\,\\text{一溴代物},\\,\\text{二氯代物},\\,\\text{二溴代物},\\,\\text{氯溴代物}\\,]$ 的估计混合物分数 $\\tilde{\\mathbf{w}}$，四舍五入到$6$位小数。例如，输出可能如下所示：\n  $$[\\, [\\,a_1,a_2,a_3,a_4,a_5\\,], [\\,b_1,b_2,b_3,b_4,b_5\\,], [\\,c_1,c_2,c_3,c_4,c_5\\,], [\\,d_1,d_2,d_3,d_4,d_5\\,] \\,],$$\n  其中 $a_i$、$b_i$、$c_i$ 和 $d_i$ 是小数。", "solution": "该问题要求根据给定的低维质谱数据，估计五种卤代有机物的混合物分数。解决方案涉及基于理论同位素模式构建一个线性模型，然后解决一个约束优化问题。\n\n基本科学原理是：在含有多个相同卤素原子的分子中，同位素遵循二项分布；在含有不同卤素的分子中，这些分布进行卷积。设重氯同位素$^{37}\\text{Cl}$的自然丰度为 $p^{\\text{Cl}}_{37} = 0.2422$，重溴同位素$^{81}\\text{Br}$的丰度为 $p^{\\text{Br}}_{81} = 0.4931$。相应的轻同位素丰度为 $p^{\\text{Cl}}_{35} = 1 - p^{\\text{Cl}}_{37} = 0.7578$ 和 $p^{\\text{Br}}_{79} = 1 - p^{\\text{Br}}_{81} = 0.5069$。\n\n一个含有$n_{\\text{Cl}}$个氯原子和$n_{\\text{Br}}$个溴原子的分子会呈现出一簇同位素峰。实验谱被简化为3个强度区间，分别对应于分子离子（$M$）、$M+2$和$M+4$。这些对应于分别含有$k=0$、$k=1$和$k=2$个重同位素（$^{37}\\text{Cl}$ 或 $^{81}\\text{Br}$）。对于每种物质 $i$，我们必须计算其理论上的$3$元素概率向量 $\\mathbf{s}_i = [P(k=0), P(k=1), P(k=2)]^\\top$。\n\n在$n_{\\text{Cl}}$个总氯原子中，含有$k_{\\text{Cl}}$个重同位素$^{37}\\text{Cl}$的概率遵循二项分布定律：\n$$P(k_{\\text{Cl}}; n_{\\text{Cl}}) = \\binom{n_{\\text{Cl}}}{k_{\\text{Cl}}} (p^{\\text{Cl}}_{37})^{k_{\\text{Cl}}} (p^{\\text{Cl}}_{35})^{n_{\\text{Cl}}-k_{\\text{Cl}}}$$\n类似的公式适用于溴。对于混合卤素物质，总共含有$k$个重同位素的概率由各个二项分布的离散卷积给出：\n$$P(k; n_{\\text{Cl}}, n_{\\text{Br}}) = \\sum_{j=0}^{k} P(j; n_{\\text{Cl}}) \\cdot P(k-j; n_{\\text{Br}})$$\n\n我们现在为五种候选物质中的每一种计算模式向量 $\\mathbf{s}_i$。\n\n1.  **物质 1：一氯代物** ($n_{\\text{Cl}}=1, n_{\\text{Br}}=0$)\n    $P(k=0) = \\binom{1}{0}(p^{\\text{Cl}}_{37})^0(p^{\\text{Cl}}_{35})^1 = 0.7578$\n    $P(k=1) = \\binom{1}{1}(p^{\\text{Cl}}_{37})^1(p^{\\text{Cl}}_{35})^0 = 0.2422$\n    $P(k=2) = 0$\n    $\\mathbf{s}_1 = [0.7578, 0.2422, 0]^\\top$\n\n2.  **物质 2：一溴代物** ($n_{\\text{Cl}}=0, n_{\\text{Br}}=1$)\n    $P(k=0) = \\binom{1}{0}(p^{\\text{Br}}_{81})^0(p^{\\text{Br}}_{79})^1 = 0.5069$\n    $P(k=1) = \\binom{1}{1}(p^{\\text{Br}}_{81})^1(p^{\\text{Br}}_{79})^0 = 0.4931$\n    $P(k=2) = 0$\n    $\\mathbf{s}_2 = [0.5069, 0.4931, 0]^\\top$\n\n3.  **物质 3：二氯代物** ($n_{\\text{Cl}}=2, n_{\\text{Br}}=0$)\n    $P(k=0) = \\binom{2}{0}(p^{\\text{Cl}}_{37})^0(p^{\\text{Cl}}_{35})^2 = (0.7578)^2 = 0.57426084$\n    $P(k=1) = \\binom{2}{1}(p^{\\text{Cl}}_{37})^1(p^{\\text{Cl}}_{35})^1 = 2(0.2422)(0.7578) = 0.36706752$\n    $P(k=2) = \\binom{2}{2}(p^{\\text{Cl}}_{37})^2(p^{\\text{Cl}}_{35})^0 = (0.2422)^2 = 0.05866084$\n    $\\mathbf{s}_3 = [0.57426084, 0.36706752, 0.05866084]^\\top$\n\n4.  **物质 4：二溴代物** ($n_{\\text{Cl}}=0, n_{\\text{Br}}=2$)\n    $P(k=0) = \\binom{2}{0}(p^{\\text{Br}}_{81})^0(p^{\\text{Br}}_{79})^2 = (0.5069)^2 = 0.25694761$\n    $P(k=1) = \\binom{2}{1}(p^{\\text{Br}}_{81})^1(p^{\\text{Br}}_{79})^1 = 2(0.4931)(0.5069) = 0.49990478$\n    $P(k=2) = \\binom{2}{2}(p^{\\text{Br}}_{81})^2(p^{\\text{Br}}_{79})^0 = (0.4931)^2 = 0.24314761$\n    $\\mathbf{s}_4 = [0.25694761, 0.49990478, 0.24314761]^\\top$\n\n5.  **物质 5：氯溴代物** ($n_{\\text{Cl}}=1, n_{\\text{Br}}=1$)\n    我们应用卷积公式：\n    $P(k=0) = P(0; n_{\\text{Cl}}=1)P(0; n_{\\text{Br}}=1) = p^{\\text{Cl}}_{35} \\cdot p^{\\text{Br}}_{79} = 0.7578 \\cdot 0.5069 = 0.38416302$\n    $P(k=1) = P(1; n_{\\text{Cl}}=1)P(0; n_{\\text{Br}}=1) + P(0; n_{\\text{Cl}}=1)P(1; n_{\\text{Br}}=1) = p^{\\text{Cl}}_{37} \\cdot p^{\\text{Br}}_{79} + p^{\\text{Cl}}_{35} \\cdot p^{\\text{Br}}_{81} = 0.2422 \\cdot 0.5069 + 0.7578 \\cdot 0.4931 = 0.49645656$\n    $P(k=2) = P(1; n_{\\text{Cl}}=1)P(1; n_{\\text{Br}}=1) = p^{\\text{Cl}}_{37} \\cdot p^{\\text{Br}}_{81} = 0.2422 \\cdot 0.4931 = 0.11943622$\n    $\\mathbf{s}_5 = [0.38416302, 0.49645656, 0.11943622]^\\top$\n\n这五个向量构成了 $3 \\times 5$ 设计矩阵 $\\mathbf{A} = [\\mathbf{s}_1, \\mathbf{s}_2, \\mathbf{s}_3, \\mathbf{s}_4, \\mathbf{s}_5]$ 的列。观测到的强度向量 $\\mathbf{y}$ 被建模为这些模式的线性组合：$\\mathbf{y} \\approx \\mathbf{A}\\mathbf{w}$，其中 $\\mathbf{w} = [w_1, w_2, w_3, w_4, w_5]^\\top$ 是非负权重向量。\n\n为了从给定的 $\\mathbf{y}$ 估计 $\\mathbf{w}$，我们解决非负最小二乘（NNLS）问题：\n$$\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{y} \\right\\|_2^2$$\n这是一个标准的凸优化问题，其解提供了估计的绝对贡献 $w_i$。\n\n最后，对权重进行归一化以获得相对混合物分数 $\\tilde{\\mathbf{w}}$：\n$$\\tilde{\\mathbf{w}} = \\frac{\\mathbf{w}}{\\sum_{i=1}^{5} w_i}$$\n如果权重之和为零（即 $\\mathbf{w}=\\mathbf{0}$），则归一化向量 $\\tilde{\\mathbf{w}}$ 为零向量。然后将所得向量的分量四舍五入到$6$位小数。对每个提供的测试用例，都以计算方式实现这整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs the theoretical isotopic patterns for halogenated compounds,\n    and solves for mixture compositions from test spectra using non-negative\n    least squares.\n    \"\"\"\n\n    # Define the natural isotopic abundances as per the problem statement.\n    p_cl35 = 0.7578\n    p_cl37 = 0.2422\n    p_br79 = 0.5069\n    p_br81 = 0.4931\n\n    # --- Step 1: Build the design matrix A ---\n\n    # Each column s_i of A is the theoretical 3-bin isotopic pattern for a species.\n    # The bins correspond to M, M+2, M+4 (0, 1, or 2 heavy isotopes).\n\n    # s_1: monochloro (1 Cl, 0 Br)\n    s1 = np.array([\n        p_cl35,  # k=0: 35Cl\n        p_cl37,  # k=1: 37Cl\n        0.0      # k=2\n    ])\n\n    # s_2: monobromo (0 Cl, 1 Br)\n    s2 = np.array([\n        p_br79,  # k=0: 79Br\n        p_br81,  # k=1: 81Br\n        0.0      # k=2\n    ])\n\n    # s_3: dichloro (2 Cl, 0 Br)\n    s3 = np.array([\n        p_cl35**2,                    # k=0: 35Cl, 35Cl\n        2 * p_cl35 * p_cl37,          # k=1: 35Cl, 37Cl\n        p_cl37**2                     # k=2: 37Cl, 37Cl\n    ])\n\n    # s_4: dibromo (0 Cl, 2 Br)\n    s4 = np.array([\n        p_br79**2,                    # k=0: 79Br, 79Br\n        2 * p_br79 * p_br81,          # k=1: 79Br, 81Br\n        p_br81**2                     # k=2: 81Br, 81Br\n    ])\n\n    # s_5: chlorobromo (1 Cl, 1 Br) - discrete convolution\n    s5 = np.array([\n        p_cl35 * p_br79,              # k=0: (35Cl, 79Br)\n        p_cl37 * p_br79 + p_cl35 * p_br81,  # k=1: (37Cl, 79Br) or (35Cl, 81Br)\n        p_cl37 * p_br81               # k=2: (37Cl, 81Br)\n    ])\n\n    # The 3x5 design matrix A\n    A = np.stack([s1, s2, s3, s4, s5], axis=1)\n\n    # --- Step 2: Define test cases ---\n    test_cases = [\n        np.array([0.65744, 0.34256, 0]),\n        np.array([0.25694761, 0.49990478, 0.24314761]),\n        np.array([0.47919483, 0.43176034, 0.08904483]),\n        np.array([0.7578, 0.2422, 0])\n    ]\n\n    results = []\n    # --- Step 3: Solve for each test case ---\n    for y in test_cases:\n        # Solve the nonnegative least squares problem: min ||Ax - y||_2^2 for x >= 0\n        w, _ = nnls(A, y)\n\n        # Normalize the weights to get mixture fractions\n        w_sum = np.sum(w)\n        if w_sum > 0:\n            w_tilde = w / w_sum\n        else:\n            w_tilde = np.zeros_like(w)\n\n        # Round to 6 decimal places and store as a list\n        w_rounded = np.round(w_tilde, 6)\n        results.append(list(w_rounded))\n\n    # Final print statement in the exact required format.\n    # str() of a list of lists matches the desired output style.\n    print(str(results).replace(\"],\", \"], \"))\n\nsolve()\n```", "id": "3709432"}]}