{"hands_on_practices": [{"introduction": "最基本的有限尺寸效应源于周期性边界盒自身的几何形状。本练习将指导您确定计算径向分布函数 $g(r)$ 的最大有效范围，以确保您的结构分析结果不会被周期性映象所污染 ([@problem_id:3412734])。掌握这种几何约束是在任何分子模拟中进行可靠数据分析的关键第一步。", "problem": "在一个边长为 $L$ 的立方盒子中，使用分子动力学在三维周期性边界条件 (PBC) 下模拟一个数密度为 $\\rho$ 的简单、均匀、各向同性的流体。用于估计径向分布函数 (RDF) $g(r)$ 的粒子对间距是使用最小镜像约定 (MIC) 计算的：对于任意具有位置矢量 $\\mathbf{r}_{i}$ 和 $\\mathbf{r}_{j}$ 的粒子对，通过恰当选择整数三元组 $\\mathbf{n}$，其分离矢量被映射为 $\\mathbf{s}=\\mathbf{r}_{j}-\\mathbf{r}_{i}-\\mathbf{n}L$，其中 $\\mathbf{s}$ 的每个分量都位于区间 $(-L/2,L/2]$ 内。$g(r)$ 的一个估计量是通过以下方式形成的：将分离矢量的大小 $|\\mathbf{s}|$ 统计到中心位于半径 $r_{k}=k\\,\\Delta r$（其中 $k\\geq 1$ 为整数）、径向宽度均匀为 $\\Delta r$ 的球壳中，然后通过理想气体球壳体积因子 $4\\pi r^{2}\\Delta r$ 和数密度 $\\rho$ 进行归一化。\n\n从第一性原理出发，即：(i) $g(r)$ 的定义，即间距为 $r$ 处的局域粒子对密度与理想气体粒子对密度之比；(ii) $\\mathbb{R}^{3}$ 中球壳的欧几里得几何；(iii) PBC 和 MIC 的几何作用，即将粒子对分离矢量映射到立方体 $[-L/2,L/2]^{3}$ 中；以及 (iv) 归一化中使用的球壳体积必须与采样分离矢量的几何区域完全对应的要求，请确定最大容许的直方图中心 $r_{\\max}$，使得对于直到（并包括）中心位于 $r_{\\max}$ 的每一个统计箱，$g(r)$ 的估计量都没有因 MIC 立方体边界对球壳的截断或各向异性裁剪而产生的镜像伪影。\n\n假设当球壳与 MIC 立方体边界相交时，不进行部分立体角校正，并要求每个被计入的球壳都必须完全包含在 MIC 立方体内。请用 $L$ 和 $\\Delta r$ 的闭式解析表达式表示您的最终结果。不需要进行数值计算，也不需要四舍五入。仅提供 $r_{\\max}$ 的表达式。", "solution": "题目要求确定在分子动力学模拟中计算径向分布函数 $g(r)$ 时，最大容许的直方图统计箱中心，记为 $r_{\\max}$。如题目所述，$g(r)$ 估计量的有效性取决于采样体积的几何完整性。推导将从所给定的第一性原理出发。\n\n(i) 径向分布函数 $g(r)$ 定义为在间距 $r$ 处的局域粒子数密度与理想气体的体数密度 $\\rho$ 之比。其估计量是通过统计大小落入球壳内的粒子对数量来构建的。\n\n(ii) 该估计量将粒子对间距按直方图统计到宽度均匀为 $\\Delta r$ 的球壳中。一个以半径 $r_k = k\\,\\Delta r$（$k \\ge 1$ 为整数）为中心的特定统计箱，包含区间 $[r_k - \\Delta r/2, r_k + \\Delta r/2)$ 内的间距 $r$。这个理想球壳的体积通常近似为 $V_k \\approx 4\\pi r_k^2 \\Delta r$，该体积用于粒子对计数的归一化。\n\n(iii) 该模拟在边长为 $L$ 的立方盒子中采用三维周期性边界条件 (PBC)。最小镜像约定 (MIC) 用于计算任意两个粒子间的分离矢量 $\\mathbf{s}$。该约定将真实的分离矢量映射到一个中心的 Wigner-Seitz 原胞中，对于立方晶格，该原胞是一个以原点为中心、边长为 $L$ 的立方体。因此，所有计算出的分离矢量 $\\mathbf{s}$ 都包含在 MIC 立方体内，该立方体可以表示为点集 $(s_x, s_y, s_z)$，其中每个分量都位于区间 $(-L/2, L/2]$ 内。我们将此立方体记为 $C_L = [-L/2, L/2]^3$。\n\n(iv) 题目强制要求用于归一化的球壳体积必须与采样粒子对间距的几何区域完全对应。由于归一化因子 $4\\pi r_k^2 \\Delta r$ 假设了一个完整、不间断的球壳，因此只有当整个对应的球壳被完全采样时，一个统计箱对 $g(r)$ 的贡献才被认为是无伪影的。因为所有采样的分离矢量 $\\mathbf{s}$ 都必须位于 MIC 立方体 $C_L$ 内，所以这个要求转化为一个严格的几何约束：整个球壳必须完全包含在立方体 $C_L$ 内。\n\n让我们将这个几何约束形式化。考虑与中心在 $r_k$ 的直方图统计箱相关联的球壳。该球壳由内半径 $r_{\\text{inner}} = r_k - \\Delta r/2$ 和外半径 $r_{\\text{outer}} = r_k + \\Delta r/2$ 定义。为了使整个球壳都包含在 MIC 立方体 $C_L$ 内，由外半径 $r_{\\text{outer}}$ 定义的球体必须完全包含在 $C_L$ 内。\n\n一个以原点为中心、半径为 $R$ 的球体，当且仅当其球面上的每一点都在立方体 $C_L = [-L/2, L/2]^3$ 内部或边界上时，它才被完全包含在该立方体内。球面上的点到原点的距离为 $R$。立方体 $C_L$ 的边界由位于 $x=\\pm L/2$，$y=\\pm L/2$ 和 $z=\\pm L/2$ 的六个平面组成。从原点到立方体边界上任意点的最短距离是到这些面中任意一个面中心（例如点 $(L/2, 0, 0)$）的距离，即 $L/2$。因此，为了使球体完全包含在立方体内，其半径 $R$ 必须小于或等于这个最小距离。条件是：\n$$R \\le \\frac{L}{2}$$\n\n将此条件应用于中心在 $r_k$ 的统计箱的球壳，我们必须确保其外边界对应的球体包含在立方体内。此外球体的半径为 $r_{\\text{outer}} = r_k + \\Delta r/2$。因此，该统计箱无伪影的条件是：\n$$r_k + \\frac{\\Delta r}{2} \\le \\frac{L}{2}$$\n\n任何中心在 $r_k$ 的统计箱要被认为是有效的，都必须满足这个不等式。题目要求的是最大容许的直方图中心 $r_{\\max}$。这是统计箱中心 $r_k$ 在满足约束条件时可以取到的最大值。我们可以通过整理不等式来找到这个值：\n$$r_k \\le \\frac{L}{2} - \\frac{\\Delta r}{2}$$\n$$r_k \\le \\frac{L - \\Delta r}{2}$$\n\n满足此条件的统计箱中心 $r_k$ 的最大值正是允许范围的上界。因此，最大容许的直方图中心是：\n$$r_{\\max} = \\frac{L - \\Delta r}{2}$$\n\n任何中心 $r_k > r_{\\max}$ 的统计箱，其外半径将为 $r_k + \\Delta r/2 > L/2$，导致其对应的球壳被 MIC 立方体的面所截断。这将违反归一化体积与实际采样体积相对应的条件，从而在 $g(r)$ 的估计量中引入有限尺寸伪影。", "answer": "$$\\boxed{\\frac{L - \\Delta r}{2}}$$", "id": "3412734"}, {"introduction": "为了使模拟在计算上可行，我们通常会截断相互作用势，但这会给能量等热力学性质带来系统误差。本练习将引导您从第一性原理出发，推导 Lennard-Jones 流体所必需的校正项，并区分标准的“尾部校正”与固有的有限尺寸误差 ([@problem_id:3412735])。这项技能对于从模拟中准确报告能量至关重要。", "problem": "考虑一个均匀的单组分Lennard–Jones (LJ)流体，其数密度为 $\\rho$，处于一个边长为 $L$ 的立方模拟盒子中，采用周期性边界条件和最小镜像约定。对势为 $u(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$。在分子动力学模拟中，势在球形截断半径 $r_{c}$ 处被直接截断（未经平移），且满足 $r_{c}\\leq L/2$。假设在超出最大相关结构长度后，径向分布函数等于1，即对于 $r\\geq r_{c}$ 成立，并且在大 $L$ 体系中对于 $r\\geq L/2$ 也成立。从无限均匀流体中单个粒子的平均势能的定义出发，推导必须加到原始截断模拟能量（用截断半径 $r_{c}$ 计算）上的校正项，并将其分解为两个可加部分：(i) 从 $r_{c}$ 到 $L/2$ 的解析截断尾部，和 (ii) 考虑在最小镜像约定下超出 $L/2$ 的缺失相互作用的有限尺寸贡献。你的推导必须从第一性原理出发，包括用 $g(r)$ 和对势表示的势能的统计力学表达式，并依此进行显式的径向积分。\n\n以约化LJ单位表示每个粒子的两个校正项，即以约化密度 $\\rho^{*}=\\rho\\sigma^{3}$、约化截断半径 $r_{c}^{*}=r_{c}/\\sigma$ 和约化盒子长度 $L^{*}=L/\\sigma$ 来报告 $\\Delta u_{\\text{cut}}/\\varepsilon$ 和 $\\Delta u_{\\text{FS}}/\\varepsilon$。将你的最终结果以单行矩阵形式给出，其第一项为 $\\Delta u_{\\text{cut}}/\\varepsilon$，第二项为 $\\Delta u_{\\text{FS}}/\\varepsilon$。无需进行数值计算。如果进行了任何简化，必须在代数上是精确的。不要在最终矩阵内包含单位；所要求的约化单位归一化已指定了它们。", "solution": "该问题要求为一个在带有周期性边界条件(PBC)和最小镜像约定(MIC)的立方盒子中模拟的Lennard-Jones (LJ)流体推导两个单粒子势能校正项。推导必须从第一性原理出发。\n\n在数密度为 $\\rho$ 的无限、均匀流体中，单个粒子的平均势能 $u_{\\text{inf}}$ 由以下统计力学表达式给出：\n$$\nu_{\\text{inf}} = \\frac{1}{2}\\rho \\int_{0}^{\\infty} u(r) g(r) 4\\pi r^2 dr\n$$\n其中 $u(r)$ 是对势，$g(r)$ 是径向分布函数。因子 $\\frac{1}{2}$ 是为了避免对粒子对的双重计数。\n\n在分子动力学模拟中，当势在截断半径 $r_c$ 处被截断时，原始的单粒子势能 $u_{\\text{raw}}$ 是通过仅对截至该距离的相互作用求和来计算的。该量的系综平均为：\n$$\nu_{\\text{raw}} = \\frac{1}{2}\\rho \\int_{0}^{r_c} u(r) g(r) 4\\pi r^2 dr\n$$\n\n将原始能量校正为理想无限系统能量所需的总校正量 $\\Delta u$ 是这两个表达式之差：\n$$\n\\Delta u = u_{\\text{inf}} - u_{\\text{raw}} = \\frac{1}{2}\\rho \\int_{r_c}^{\\infty} u(r) g(r) 4\\pi r^2 dr\n$$\n\n问题陈述我们应假设对于 $r \\geq r_c$，$g(r)=1$。这个用于长程校正的标准近似简化了积分：\n$$\n\\Delta u \\approx 2\\pi\\rho \\int_{r_c}^{\\infty} u(r) r^2 dr\n$$\n\n问题要求将这个总校正分解为两个可加部分：\n1.  截断尾部校正 $\\Delta u_{\\text{cut}}$，用于校正从 $r_c$ 到 $L/2$ 范围内被忽略的相互作用。距离 $L/2$ 是可以内切于立方模拟盒子的最大球体的半径，它代表了在最小镜像约定下中心粒子的最大相互作用范围。\n2.  有限尺寸校正 $\\Delta u_{\\text{FS}}$，用于解释在无限系统中存在但在最小镜像约定下的有限周期系统中缺失的、超出 $L/2$ 的相互作用。\n\n基于此分解，我们可以在 $r=L/2$ 处分割 $\\Delta u$ 的积分：\n$$\n\\Delta u_{\\text{cut}} = 2\\pi\\rho \\int_{r_c}^{L/2} u(r) r^2 dr\n$$\n$$\n\\Delta u_{\\text{FS}} = 2\\pi\\rho \\int_{L/2}^{\\infty} u(r) r^2 dr\n$$\n问题中给出的条件 $r_c \\leq L/2$ 确保了 $\\Delta u_{\\text{cut}}$ 的积分范围是良定义的。\n\nLennard-Jones 势由 $u(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$ 给出。我们首先需要求出 $u(r)r^2$ 的不定积分：\n$$\n\\int u(r) r^2 dr = \\int 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right] r^2 dr\n$$\n$$\n= 4\\varepsilon \\int \\left(\\sigma^{12}r^{-10} - \\sigma^{6}r^{-4}\\right) dr\n$$\n$$\n= 4\\varepsilon \\left[ \\frac{\\sigma^{12}r^{-9}}{-9} - \\frac{\\sigma^{6}r^{-3}}{-3} \\right] + C\n$$\n我们定义原函数 $I(r)$：\n$$\nI(r) = 4\\varepsilon \\left[ \\frac{\\sigma^{6}}{3r^{3}} - \\frac{\\sigma^{12}}{9r^{9}} \\right]\n$$\n\n现在我们可以计算这两个校正项。\n\n首先，是截断尾部校正 $\\Delta u_{\\text{cut}}$：\n$$\n\\Delta u_{\\text{cut}} = 2\\pi\\rho \\left[ I(r) \\right]_{r_c}^{L/2} = 2\\pi\\rho \\left( I(L/2) - I(r_c) \\right)\n$$\n$$\n\\Delta u_{\\text{cut}} = 2\\pi\\rho \\left( 4\\varepsilon \\left[ \\frac{\\sigma^{6}}{3(L/2)^{3}} - \\frac{\\sigma^{12}}{9(L/2)^{9}} \\right] - 4\\varepsilon \\left[ \\frac{\\sigma^{6}}{3r_c^{3}} - \\frac{\\sigma^{12}}{9r_c^{9}} \\right] \\right)\n$$\n我们需要用约化单位 $\\rho^{*} = \\rho\\sigma^{3}$、$r_{c}^{*} = r_{c}/\\sigma$ 和 $L^{*} = L/\\sigma$ 来表示 $\\Delta u_{\\text{cut}}/\\varepsilon$。\n$$\n\\frac{\\Delta u_{\\text{cut}}}{\\varepsilon} = 8\\pi\\rho \\left( \\left[ \\frac{\\sigma^{6}}{3(L^3/8)} - \\frac{\\sigma^{12}}{9(L^9/512)} \\right] - \\left[ \\frac{\\sigma^{6}}{3r_c^{3}} - \\frac{\\sigma^{12}}{9r_c^{9}} \\right] \\right)\n$$\n$$\n\\frac{\\Delta u_{\\text{cut}}}{\\varepsilon} = 8\\pi\\rho\\sigma^{3} \\left( \\left[ \\frac{8\\sigma^{3}}{3L^{3}} - \\frac{512\\sigma^{9}}{9L^{9}} \\right] - \\left[ \\frac{\\sigma^{3}}{3r_c^{3}} - \\frac{\\sigma^{9}}{9r_c^{9}} \\right] \\right)\n$$\n代入约化单位：\n$$\n\\frac{\\Delta u_{\\text{cut}}}{\\varepsilon} = 8\\pi\\rho^{*} \\left( \\left[ \\frac{8}{3(L/\\sigma)^{3}} - \\frac{512}{9(L/\\sigma)^{9}} \\right] - \\left[ \\frac{1}{3(r_c/\\sigma)^{3}} - \\frac{1}{9(r_c/\\sigma)^{9}} \\right] \\right)\n$$\n$$\n\\frac{\\Delta u_{\\text{cut}}}{\\varepsilon} = 8\\pi\\rho^{*} \\left( \\left( \\frac{8}{3(L^{*})^{3}} - \\frac{512}{9(L^{*})^{9}} \\right) - \\left( \\frac{1}{3(r_{c}^{*})^{3}} - \\frac{1}{9(r_{c}^{*})^{9}} \\right) \\right)\n$$\n\n其次，是有限尺寸校正 $\\Delta u_{\\text{FS}}$：\n$$\n\\Delta u_{\\text{FS}} = 2\\pi\\rho \\int_{L/2}^{\\infty} u(r) r^2 dr = 2\\pi\\rho \\left[ I(r) \\right]_{L/2}^{\\infty}\n$$\n由于 $\\lim_{r\\to\\infty} I(r) = 0$，这变为：\n$$\n\\Delta u_{\\text{FS}} = 2\\pi\\rho \\left( 0 - I(L/2) \\right) = -2\\pi\\rho I(L/2)\n$$\n$$\n\\Delta u_{\\text{FS}} = -2\\pi\\rho \\left( 4\\varepsilon \\left[ \\frac{\\sigma^{6}}{3(L/2)^{3}} - \\frac{\\sigma^{12}}{9(L/2)^{9}} \\right] \\right)\n$$\n除以 $\\varepsilon$ 并转换为约化单位：\n$$\n\\frac{\\Delta u_{\\text{FS}}}{\\varepsilon} = -8\\pi\\rho \\left[ \\frac{\\sigma^{6}}{3(L^3/8)} - \\frac{\\sigma^{12}}{9(L^9/512)} \\right]\n$$\n$$\n\\frac{\\Delta u_{\\text{FS}}}{\\varepsilon} = -8\\pi\\rho\\sigma^{3} \\left[ \\frac{8\\sigma^{3}}{3L^{3}} - \\frac{512\\sigma^{9}}{9L^{9}} \\right]\n$$\n$$\n\\frac{\\Delta u_{\\text{FS}}}{\\varepsilon} = -8\\pi\\rho^{*} \\left[ \\frac{8}{3(L/\\sigma)^{3}} - \\frac{512}{9(L/\\sigma)^{9}} \\right]\n$$\n$$\n\\frac{\\Delta u_{\\text{FS}}}{\\varepsilon} = -8\\pi\\rho^{*} \\left( \\frac{8}{3(L^{*})^{3}} - \\frac{512}{9(L^{*})^{9}} \\right) = 8\\pi\\rho^{*} \\left( \\frac{512}{9(L^{*})^{9}} - \\frac{8}{3(L^{*})^{3}} \\right)\n$$\n这两个推导出的表达式是问题所要求的组分。将它们表示为行矩阵即可得到最终答案。\n第一项是 $\\frac{\\Delta u_{\\text{cut}}}{\\varepsilon} = 8\\pi\\rho^{*} \\left( \\frac{8}{3(L^{*})^{3}} - \\frac{512}{9(L^{*})^{9}} - \\frac{1}{3(r_{c}^{*})^{3}} + \\frac{1}{9(r_{c}^{*})^{9}} \\right)$。\n第二项是 $\\frac{\\Delta u_{\\text{FS}}}{\\varepsilon} = 8\\pi\\rho^{*} \\left( \\frac{512}{9(L^{*})^{9}} - \\frac{8}{3(L^{*})^{3}} \\right)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 8\\pi\\rho^{*} \\left( \\frac{8}{3(L^{*})^{3}} - \\frac{512}{9(L^{*})^{9}} - \\frac{1}{3(r_{c}^{*})^{3}} + \\frac{1}{9(r_{c}^{*})^{9}} \\right)  8\\pi\\rho^{*} \\left( \\frac{512}{9(L^{*})^{9}} - \\frac{8}{3(L^{*})^{3}} \\right) \\end{pmatrix}}\n$$", "id": "3412735"}, {"introduction": "对于由长程力主导的性质（例如介电常数），有限尺寸效应更为深远，并且严重依赖于所施加的边界条件。这项高级实践要求您首先推导出不同静电环境下涨落的理论公式，然后通过有限尺寸标度分析，从一系列不同尺寸的模拟结果中外推出真正的热力学极限值 ([@problem_id:3412779])。该练习融合了理论、数据分析和编程，是研究介电材料的一项基石技术。", "problem": "考虑一个在周期性边界条件（PBC）下模拟的各向同性极性流体的经典分子动力学系统。宏观静电介电常数（用 $\\epsilon$ 表示）可以通过模拟盒子总偶极矩矢量 $\\mathbf{M}$ 的平衡涨落来估计。然而，有限尺寸效应以及模拟盒子外部边界条件的选择会影响偶极矩涨落与 $\\epsilon$ 之间的关系。具体来说，对于边长为 $L$ 的立方体盒子，两种常用的外部边界条件是导电边界（锡箔）和真空边界。在这两种情况下，总偶极矩方差 $\\langle \\mathbf{M}^2 \\rangle$ 与 $\\epsilon$ 之间的有效关系是不同的，这是因为由形状相关的退极化因子决定的退极化场。\n\n任务：从线性响应理论（LRT）、静电本构关系和涨落-耗散定理（FDT）的基本原理出发，推导在导电边界（锡箔）和真空边界这两种条件下，立方体盒子中各向同性系统的偶极矩方差 $\\langle \\mathbf{M}^2 \\rangle$ 与介电常数 $\\epsilon$ 之间的关系。假设立方体盒子的形状因子与等于 $1/3$ 的退极化因子一致，并且外部介质要么是导电的（有效退极化为零），要么是真空。使用约化单位制，其中玻尔兹曼常数 $k_{\\mathrm{B}} = 1$ 且温度 $T$ 是无量纲的，因此所有报告的 $\\epsilon$ 值都是无量纲的。\n\n有限尺寸标度方案：假设在尺寸为 $L$ 的盒子中估计的表观介电常数的有限尺寸依赖性对于足够大的 $L$ 是解析的，并遵循以下领先阶标度关系\n$$\n\\epsilon(L) \\approx \\epsilon(\\infty) + \\frac{A}{L},\n$$\n其中 $A$ 是一个取决于微观细节但与 $L$ 无关的未知系数，而 $\\epsilon(\\infty)$ 是热力学极限下的介电常数。给定几个不同 $L$ 的 $\\langle \\mathbf{M}^2 \\rangle$ 测量值，使用您推导的关系式分别计算锡箔和真空边界条件下的 $\\epsilon(L)$，然后通过对 $\\epsilon(L)$ 与 $1/L$ 进行最小二乘线性拟合来估计 $\\epsilon(\\infty)$。如果测试用例中只有一个盒子尺寸 $L$ 可用，则返回单个 $\\epsilon(L)$ 值作为 $\\epsilon(\\infty)$ 的最佳可用估计值。\n\n实现一个完整、可运行的程序，该程序：\n- 对于每个提供的测试用例，输入温度 $T$（无量纲）、盒子边长列表 $L$（无量纲长度单位），以及锡箔和真空边界条件下测得的相应 $\\langle \\mathbf{M}^2 \\rangle$ 值列表。\n- 使用您从第一性原理推导出的关系式，分别为锡箔和真空边界条件计算 $\\epsilon(L)$。\n- 对 $\\epsilon(L)$ 与 $1/L$ 进行最小二乘线性回归，以估计每种边界条件下的 $\\epsilon(\\infty)$。如果只有一个 $L$ 可用，则直接使用该值作为 $\\epsilon(\\infty)$ 的估计值。\n- 以单行形式输出所有测试用例的外推介电常数，格式为方括号括起来的逗号分隔列表，顺序为：$[\\epsilon_{\\mathrm{tf}}^{(\\infty)}\\text{ 案例 1}, \\epsilon_{\\mathrm{vac}}^{(\\infty)}\\text{ 案例 1}, \\epsilon_{\\mathrm{tf}}^{(\\infty)}\\text{ 案例 2}, \\epsilon_{\\mathrm{vac}}^{(\\infty)}\\text{ 案例 2}, \\ldots]$，其中 $\\epsilon_{\\mathrm{tf}}^{(\\infty)}$ 表示锡箔外推值，$\\epsilon_{\\mathrm{vac}}^{(\\infty)}$ 表示真空外推值。所有浮点数四舍五入到三位小数。\n\n使用以下测试套件。所有量均采用 $k_{\\mathrm{B}}=1$ 的约化单位，长度无量纲。对于每个案例，$T$ 是温度，$L$ 是盒子尺寸列表，$\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{tf}}$ 和 $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{vac}}$ 分别是锡箔和真空边界条件下测得的总偶极矩方差。\n\n测试套件：\n1. 案例 A（中等极性，多个尺寸）：\n   - $T = 1$\n   - $L = [10, 20]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{tf}} = [4894.014500075782, 37719.72151277919]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{vac}} = [625.0, 4975.0]$\n2. 案例 B（单一尺寸边界情况）：\n   - $T = 1$\n   - $L = [8]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{tf}} = [641.6445]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{vac}} = [233.6970]$\n3. 案例 C（弱极性，在不同L下为常数）：\n   - $T = 1$\n   - $L = [12, 24]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{tf}} = [206.2255, 1649.8060]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{vac}} = [176.7647, 1414.1190]$\n4. 案例 D（强极性，两个尺寸）：\n   - $T = 1$\n   - $L = [20, 50]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{tf}} = [114591.55902616464, 1772139.6000]$\n   - $\\langle \\mathbf{M}^2 \\rangle_{\\mathrm{vac}} = [5457.692811531652, 85303.0000]$\n\n最终输出格式：\n- 您的程序应生成单行结果，格式为方括号括起来的逗号分隔列表，浮点数四舍五入到三位小数。例如：$[\\epsilon_{\\mathrm{tf}}^{(\\infty)}\\text{ 案例 1}, \\epsilon_{\\mathrm{vac}}^{(\\infty)}\\text{ 案例 1}, \\ldots]$。", "solution": "该问题被认为是有效的，因为它科学地基于统计力学和电磁学原理，问题陈述清晰，目标明确，数据充分，并且没有任何在问题验证标准中列出的可使其无效的缺陷。\n\n任务是推导在两种不同的宏观边界条件（导电（锡箔）和真空）下，模拟盒子的总偶极矩均方值 $\\langle \\mathbf{M}^2 \\rangle$ 与静电介电常数 $\\epsilon$ 之间的关系。然后，我们使用这些关系从有限尺寸的模拟数据中估计热力学极限下的介电常数 $\\epsilon(\\infty)$。推导将基于线性响应理论（LRT）和经典静电学。我们将在约化单位制下进行计算，其中玻尔兹曼常数 $k_{\\mathrm{B}} = 1$。同时采用一种单位体系（高斯/cgs），在该体系中，电位移矢量 $\\mathbf{D}$ 与电场 $\\mathbf{E}$ 和极化强度 $\\mathbf{P}$ 的关系为 $\\mathbf{D} = \\mathbf{E} + 4\\pi\\mathbf{P}$。本构关系为 $\\mathbf{D} = \\epsilon \\mathbf{E}$，这意味着 $\\mathbf{P} = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E}$。\n\n根据线性响应理论，一个可观测量 $A$ 对一个通过相互作用哈密顿量 $H' = -BF$ 与可观测量 $B$ 耦合的微小外场 $F$ 的响应由 $\\Delta \\langle A \\rangle = \\beta \\langle AB \\rangle_0 F$ 给出，其中 $\\beta = 1/(k_B T)$，$\\langle \\cdot \\rangle_0$ 表示在未受扰动系综中的平均值。对于我们的问题，可观测量是模拟盒子的总偶极矩 $\\mathbf{M}$，它与一个外部施加的均匀电场 $\\mathbf{E}_0$ 共轭。相互作用哈密顿量为 $H' = - \\mathbf{M} \\cdot \\mathbf{E}_0$。\n\n因此，沿电场 $\\mathbf{E}_0$ 方向的感应平均偶极矩 $\\langle \\mathbf{M} \\rangle$ 可由涨落-耗散定理给出。对于各向同性系统，其中 $\\langle M_x^2 \\rangle_0 = \\langle M_y^2 \\rangle_0 = \\langle M_z^2 \\rangle_0 = \\frac{1}{3}\\langle \\mathbf{M}^2 \\rangle_0$ 且自发极化 $\\langle \\mathbf{M} \\rangle_0 = 0$：\n$$ \\langle \\mathbf{M} \\rangle = \\frac{\\beta}{3} \\langle \\mathbf{M}^2 \\rangle_0 \\mathbf{E}_0 $$\n宏观极化强度为 $\\mathbf{P} = \\langle \\mathbf{M} \\rangle / V$，其中 $V=L^3$ 是立方体盒子的体积。\n$$ \\mathbf{P} = \\frac{\\beta \\langle \\mathbf{M}^2 \\rangle_0}{3V} \\mathbf{E}_0 $$\n这个方程将微观涨落 $\\langle \\mathbf{M}^2 \\rangle_0$ 与由外场 $\\mathbf{E}_0$ 引起的宏观响应 $\\mathbf{P}$ 联系起来。\n\n下一步是使用连续介质静电学，以一种依赖于宏观边界条件的方式将 $\\mathbf{P}$ 与 $\\mathbf{E}_0$ 联系起来。关键在于，介电样品内部的局部麦克斯韦场 $\\mathbf{E}$ 通常不等于外场 $\\mathbf{E}_0$。它们之间的关系取决于样品的形状和周围介质的介电特性。内部场由以下公式给出：\n$$ \\mathbf{E} = \\mathbf{E}_0 - \\mathbf{E}_{\\text{dep}} $$\n其中 $\\mathbf{E}_{\\text{dep}}$ 是退极化场。对于一个嵌入在介电常数为 $\\epsilon'$ 的介质中、具有均匀极化强度 $\\mathbf{P}$ 的样品，其退极化场为 $\\mathbf{E}_{\\text{dep}} = 4\\pi N \\frac{\\mathbf{P}}{\\epsilon'}$，其中 $N$ 是依赖于几何形状的退极化因子。对于球体，$N=1/3$。我们采用这个值作为各向同性系统中立方体盒子的近似值。\n\n我们现在将LRT的结果与两种指定边界条件的静电学理论结合起来。\n\n**1. 导电（锡箔）边界条件**\n这种情况对应于样品被导电介质包围，因此 $\\epsilon' \\to \\infty$。退极化场 $\\mathbf{E}_{\\text{dep}} = 4\\pi N \\frac{\\mathbf{P}}{\\epsilon'}$ 为零。这意味着样品内部的平均麦克斯韦场与外场相同：$\\mathbf{E} = \\mathbf{E}_0$。\n\n我们现在可以令两个关于极化强度 $\\mathbf{P}$ 的表达式相等：\n根据静电学：$\\mathbf{P} = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E} = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E}_0$。\n根据LRT：$\\mathbf{P} = \\frac{\\beta \\langle \\mathbf{M}^2 \\rangle_{\\text{tf}}}{3V} \\mathbf{E}_0$。\n\n令 $\\mathbf{E}_0$ 的系数相等：\n$$ \\frac{\\epsilon-1}{4\\pi} = \\frac{\\beta \\langle \\mathbf{M}^2 \\rangle_{\\text{tf}}}{3V} $$\n使用问题给定的单位，$\\beta=1/T$ 和 $V=L^3$，我们可以求解在尺寸为 $L$ 的盒子中测得的表观介电常数 $\\epsilon_{\\text{tf}}(L)$：\n$$ \\epsilon_{\\text{tf}}(L) = 1 + \\frac{4\\pi \\langle \\mathbf{M}^2 \\rangle_{\\text{tf}}}{3 T L^3} $$\n\n**2. 真空边界条件**\n这种情况对应于样品被真空包围，因此 $\\epsilon' = 1$。退极化因子为 $N=1/3$。内部场为 $\\mathbf{E} = \\mathbf{E}_0 - 4\\pi N \\mathbf{P} = \\mathbf{E}_0 - \\frac{4\\pi}{3}\\mathbf{P}$。\n\n将此代入关于 $\\mathbf{P}$ 的静电关系式：\n$$ \\mathbf{P} = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E} = \\frac{\\epsilon-1}{4\\pi} \\left( \\mathbf{E}_0 - \\frac{4\\pi}{3}\\mathbf{P} \\right) $$\n$$ \\mathbf{P} = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E}_0 - \\frac{\\epsilon-1}{3}\\mathbf{P} $$\n$$ \\mathbf{P} \\left( 1 + \\frac{\\epsilon-1}{3} \\right) = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E}_0 $$\n$$ \\mathbf{P} \\left( \\frac{\\epsilon+2}{3} \\right) = \\frac{\\epsilon-1}{4\\pi}\\mathbf{E}_0 $$\n这给出了一个用 $\\mathbf{E}_0$ 表示 $\\mathbf{P}$ 的静电学表达式：\n$$ \\mathbf{P} = \\frac{3}{\\epsilon+2} \\frac{\\epsilon-1}{4\\pi} \\mathbf{E}_0 $$\n现在，我们将其与LRT表达式 $\\mathbf{P} = \\frac{\\beta \\langle \\mathbf{M}^2 \\rangle_{\\text{vac}}}{3V} \\mathbf{E}_0$ 等同起来：\n$$ \\frac{\\beta \\langle \\mathbf{M}^2 \\rangle_{\\text{vac}}}{3V} = \\frac{3}{\\epsilon+2} \\frac{\\epsilon-1}{4\\pi} $$\n重新整理后得到著名的克劳修斯-莫索提关系，它将宏观的 $\\epsilon$ 与微观涨落联系起来：\n$$ \\frac{\\epsilon(L)-1}{\\epsilon(L)+2} = \\frac{4\\pi \\beta \\langle \\mathbf{M}^2 \\rangle_{\\text{vac}}}{9V} $$\n我们定义一个量 $X(L) = \\frac{4\\pi \\langle \\mathbf{M}^2 \\rangle_{\\text{vac}}}{9 T L^3}$。方程为 $\\frac{\\epsilon_{\\text{vac}}(L)-1}{\\epsilon_{\\text{vac}}(L)+2} = X(L)$。求解 $\\epsilon_{\\text{vac}}(L)$：\n$$ \\epsilon_{\\text{vac}}(L) - 1 = X(L) (\\epsilon_{\\text{vac}}(L) + 2) $$\n$$ \\epsilon_{\\text{vac}}(L) (1 - X(L)) = 1 + 2X(L) $$\n$$ \\epsilon_{\\text{vac}}(L) = \\frac{1 + 2X(L)}{1 - X(L)} $$\n\n**有限尺寸外推**\n问题提供了一个标度关系式 $\\epsilon(L) \\approx \\epsilon(\\infty) + A/L$。这描述了 $\\epsilon(L)$ 和 $1/L$ 之间的线性关系。我们的任务是通过线性最小二乘拟合找到截距 $\\epsilon(\\infty)$。\n对于一组数据点 $(x_i, y_i) = (1/L_i, \\epsilon(L_i))$，我们拟合一条直线 $y = mx + c$。截距 $c$ 就是我们对 $\\epsilon(\\infty)$ 的估计值。如果只有一个数据点 $(L_1, \\epsilon(L_1))$ 可用，那么对无限尺寸极限的最佳估计就是 $\\epsilon(L_1)$ 本身。\n\n步骤如下：\n1. 对于每个测试用例和每种边界条件（锡箔和真空），使用推导出的公式计算一系列表观介电常数 $\\epsilon(L_i)$。\n2. 构成数据对 $(1/L_i, \\epsilon(L_i))$。\n3. 如果数据点多于一个，则进行线性回归以找到截距 $\\epsilon(\\infty)$。如果只有一个点，则设 $\\epsilon(\\infty) = \\epsilon(L_1)$。\n4. 报告每个测试用例得到的 $\\epsilon_{\\text{tf}}^{(\\infty)}$ 和 $\\epsilon_{\\text{vac}}^{(\\infty)}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the molecular dynamics finite-size effect problem for dielectric constants.\n    \"\"\"\n    test_cases = [\n        # Case A (moderately polar, multiple sizes)\n        {\n            \"T\": 1.0,\n            \"L\": [10.0, 20.0],\n            \"M2_tf\": [4894.014500075782, 37719.72151277919],\n            \"M2_vac\": [625.0, 4975.0],\n        },\n        # Case B (single-size edge case)\n        {\n            \"T\": 1.0,\n            \"L\": [8.0],\n            \"M2_tf\": [641.6445],\n            \"M2_vac\": [233.6970],\n        },\n        # Case C (weakly polar, constant in L)\n        {\n            \"T\": 1.0,\n            \"L\": [12.0, 24.0],\n            \"M2_tf\": [206.2255, 1649.8060],\n            \"M2_vac\": [176.7647, 1414.1190],\n        },\n        # Case D (strongly polar, two sizes)\n        {\n            \"T\": 1.0,\n            \"L\": [20.0, 50.0],\n            \"M2_tf\": [114591.55902616464, 1772139.6],\n            \"M2_vac\": [5457.692811531652, 85303.0],\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T = case[\"T\"]\n        L_list = np.array(case[\"L\"])\n        M2_tf_list = np.array(case[\"M2_tf\"])\n        M2_vac_list = np.array(case[\"M2_vac\"])\n        \n        # --- Tin-Foil Boundary Condition ---\n        eps_tf_L = []\n        for L, M2_tf in zip(L_list, M2_tf_list):\n            V = L**3\n            eps = 1.0 + (4.0 * np.pi * M2_tf) / (3.0 * T * V)\n            eps_tf_L.append(eps)\n        \n        # --- Vacuum Boundary Condition ---\n        eps_vac_L = []\n        for L, M2_vac in zip(L_list, M2_vac_list):\n            V = L**3\n            X = (4.0 * np.pi * M2_vac) / (9.0 * T * V)\n            if 1.0 - X == 0:\n                eps = float('inf')\n            else:\n                eps = (1.0 + 2.0 * X) / (1.0 - X)\n            eps_vac_L.append(eps)\n\n        # --- Finite-Size Extrapolation ---\n        n_points = len(L_list)\n        \n        if n_points == 1:\n            eps_tf_inf = eps_tf_L[0]\n            eps_vac_inf = eps_vac_L[0]\n        else:\n            x_inv_L = 1.0 / L_list\n            \n            # Linear regression: y = A*x + B, where B is the intercept epsilon_infinity\n            \n            # Tin-foil\n            coeffs_tf = np.polyfit(x_inv_L, eps_tf_L, 1)\n            eps_tf_inf = coeffs_tf[1]\n            \n            # Vacuum\n            coeffs_vac = np.polyfit(x_inv_L, eps_vac_L, 1)\n            eps_vac_inf = coeffs_vac[1]\n\n        results.append(eps_tf_inf)\n        results.append(eps_vac_inf)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```", "id": "3412779"}]}