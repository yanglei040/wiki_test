{"hands_on_practices": [{"introduction": "力场的核心是势能函数，它将分子的构象与其能量联系起来。这些函数由多个项组成，其中最基本的是“成键”项，用于描述共价键、键角和二面角的能量。此练习将重点放在最简单的成键相互作用上：键长伸缩。通过将化学键近似为简谐振子，我们可以计算出将其从平衡位置拉伸或压缩所需的能量，这是理解分子柔性和振动的基础 [@problem_id:3397816]。", "problem": "在经典的分子动力学（MD）中，使用诸如Assisted Model Building with Energy Refinement（AMBER）、Chemistry at Harvard Macromolecular Mechanics（CHARMM）和Optimized Potentials for Liquid Simulations All-Atom（OPLS-AA）等可加和的生物分子和通用力场族时，分子内键合能表示为在平衡点附近对独立内坐标的求和。考虑一个甲烷分子，其碳-氢键在其平衡长度附近的行为，可以用分子内势在平衡键长处的二阶泰勒展开来描述。设平衡碳-氢键长为$b_0=1.09~\\text{\\AA}$，势在平衡点处的曲率（二阶导数）为$k_b=340~\\text{kcal mol}^{-1}\\ \\text{\\AA}^{-2}$。假设一个碳-氢键被准静态地拉伸到$1.12~\\text{\\AA}$，而所有其他内坐标保持其平衡值，并假设内坐标之间的交叉耦合项可以忽略不计，正如标准可加和力场中的情况一样。\n\n仅使用由平衡点附近的二阶泰勒展开所隐含的谐振子近似以及上述定义，确定仅由此单个键的拉伸引起的分子内键合能的变化。用$\\text{kcal mol}^{-1}$单位表示您的答案，并将最终结果四舍五入至三位有效数字。", "solution": "该问题要求计算甲烷分子中单个碳-氢键从其平衡长度被拉伸时，分子内键合能的变化。问题明确指出，此计算应基于势能的二阶泰勒展开，这等同于谐振子近似。\n\n令与键长$b$相关的势能用函数$V(b)$表示。$V(b)$在平衡键长$b_0$附近的泰勒级数展开式为：\n$$V(b) = V(b_0) + \\frac{dV}{db}\\bigg|_{b=b_0} (b - b_0) + \\frac{1}{2!} \\frac{d^2V}{db^2}\\bigg|_{b=b_0} (b - b_0)^2 + \\frac{1}{3!} \\frac{d^3V}{db^3}\\bigg|_{b=b_0} (b - b_0)^3 + \\dots$$\n\n问题说明要使用二阶泰勒展开，这意味着我们在位移$(b - b_0)$的二次项之后截断级数。\n$$V(b) \\approx V(b_0) + \\frac{dV}{db}\\bigg|_{b=b_0} (b - b_0) + \\frac{1}{2} \\frac{d^2V}{db^2}\\bigg|_{b=b_0} (b - b_0)^2$$\n\n根据定义，平衡位置$b_0$是势能最低点。因此，在该位置键上的力为零，这意味着势能对键长的一阶导数在$b_0$处为零：\n$$\\frac{dV}{db}\\bigg|_{b=b_0} = 0$$\n\n将此条件代入截断的泰勒展开式中，简化了势能的表达式：\n$$V(b) \\approx V(b_0) + \\frac{1}{2} \\frac{d^2V}{db^2}\\bigg|_{b=b_0} (b - b_0)^2$$\n\n问题提供了曲率的值，即势在平衡点处的二阶导数。这是键伸缩的谐振力常数，记为$k_b$：\n$$k_b = \\frac{d^2V}{db^2}\\bigg|_{b=b_0}$$\n\n使用这个记号，势能为：\n$$V(b) \\approx V(b_0) + \\frac{1}{2} k_b (b - b_0)^2$$\n\n我们被要求计算当键从其平衡长度$b_0$拉伸到新长度$b$时，分子内键合能的变化量$\\Delta E$。这个变化量是拉伸后长度的势能与平衡时势能之差：\n$$\\Delta E = V(b) - V(b_0)$$\n\n代入$V(b)$的谐振子近似：\n$$\\Delta E = \\left( V(b_0) + \\frac{1}{2} k_b (b - b_0)^2 \\right) - V(b_0)$$\n$$\\Delta E = \\frac{1}{2} k_b (b - b_0)^2$$\n\n这个方程表示偏离平衡位置的谐振子所储存的能量。问题提供了所需的值：\n平衡键长为$b_0 = 1.09~\\text{\\AA}$。\n拉伸后的键长为$b = 1.12~\\text{\\AA}$。\n曲率（力常数）为$k_b = 340~\\text{kcal mol}^{-1}\\ \\text{\\AA}^{-2}$。\n\n首先，我们计算偏离平衡位置的位移$(b - b_0)$：\n$$b - b_0 = 1.12~\\text{\\AA} - 1.09~\\text{\\AA} = 0.03~\\text{\\AA}$$\n\n现在，我们将$k_b$和$(b - b_0)$的值代入$\\Delta E$的表达式中：\n$$\\Delta E = \\frac{1}{2} (340~\\text{kcal mol}^{-1}\\ \\text{\\AA}^{-2}) (0.03~\\text{\\AA})^2$$\n$$\\Delta E = (170~\\text{kcal mol}^{-1}\\ \\text{\\AA}^{-2}) (0.0009~\\text{\\AA}^2)$$\n$$\\Delta E = 0.153~\\text{kcal mol}^{-1}$$\n\n单位$\\text{\\AA}^2$相互抵消，使得能量的单位为所需的$\\text{kcal mol}^{-1}$。问题要求结果四舍五入至三位有效数字。计算出的值$0.153$已经表示为三位有效数字。\n\n假设其他内坐标保持其平衡值且交叉耦合项可忽略不计，这与对单个内坐标使用简谐势是一致的，正如在许多可加和力场中的标准做法一样。", "answer": "$$\\boxed{0.153}$$", "id": "3397816"}, {"introduction": "除了将原子连接在一起的成键相互作用外，非键相互作用决定了分子如何识别、折叠和聚集。静电相互作用是其中一个关键组成部分，它源于原子上不均匀的电荷分布。此练习演示了如何使用库仑定律和分子动力学模拟中常用的单位转换因子来计算两个原子之间的静电能，这对于理解从药物-靶标结合到蛋白质稳定性的所有过程至关重要 [@problem_id:3397830]。", "problem": "在经典的非极化生物分子动力学力场（如 AMBER、CHARMM 或 OPLS 系列）中，两个点部分电荷之间的静电相互作用是通过库仑定律来建模的，其单位表示形式便于模拟。考虑由一个加性力场分配了部分电荷的两个原子：一个电荷为 $q_1=+0.5\\,e$，另一个电荷为 $q_2=-0.5\\,e$，其中 $e$ 表示元电荷。它们在相对介电常数为 $\\epsilon_r=1$ 的介质中相距 $r=5.0\\,\\text{\\AA}$。从库仑定律出发，并使用标准的分子动力学单位转换前置因子 $1/(4\\pi\\epsilon_0)=332.0637\\,\\text{kcal}\\,\\text{\\AA}\\,\\text{mol}^{-1}\\,e^{-2}$，计算以 $\\text{kcal}\\,\\text{mol}^{-1}$ 为单位的成对静电相互作用能。将您的答案四舍五入到四位有效数字，并以 $\\text{kcal}\\,\\text{mol}^{-1}$ 为单位表示。", "solution": "该问题要求计算在给定相对介电常数的介质中，两个具有给定部分电荷、相隔特定距离的原子之间的成对静电相互作用能。计算必须使用分子动力学（MD）模拟中常见的标准约定和单位转换前置因子。\n\n首先，对问题进行验证。\n\n**第一步：提取已知条件**\n- 第一个原子的电荷：$q_1 = +0.5\\,e$\n- 第二个原子的电荷：$q_2 = -0.5\\,e$\n- 元电荷：$e$\n- 分离距离：$r = 5.0\\,\\text{\\AA}$\n- 介质的相对介电常数：$\\epsilon_r = 1$\n- MD 单位转换前置因子：$C = \\frac{1}{4\\pi\\epsilon_0} = 332.0637\\,\\text{kcal}\\,\\text{\\AA}\\,\\text{mol}^{-1}\\,e^{-2}$\n- 要求的最终单位：$\\text{kcal}\\,\\text{mol}^{-1}$\n- 要求的精度：四舍五入到四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题有科学依据，因为它基于物理学的基本原理——库仑定律。其背景是经典的生物分子力场（AMBER、CHARMM、OPLS），这是计算化学和分子动力学中一个成熟的核心课题。所提供的部分电荷（$q_1$、$q_2$）和距离（$r$）的值对于分子系统是物理上现实的。使用相对介电常数 $\\epsilon_r=1$ 是许多非极化力场中的一个标准约定，表示在类真空有效介质中的相互作用，其中介电屏蔽通常通过隐式方式或其他项来处理。给定的前置因子（$332.0637\\,\\text{kcal}\\,\\text{\\AA}\\,\\text{mol}^{-1}\\,e^{-2}$）是在电荷表示为元电荷 $e$ 的倍数且距离以埃（$\\text{\\AA}$）为单位时，用于获得以 $\\text{kcal}\\,\\text{mol}^{-1}$ 为单位的能量的正确且标准的转换因子。该问题提法恰当，包含了获得唯一解所需的所有信息，并且没有歧义、矛盾或主观性语言。\n\n**第三步：结论与行动**\n该问题被认为是有效的。将提供一个解决方案。\n\n在均匀介质中，相距为 $r$ 的两个点电荷 $q_1$ 和 $q_2$ 之间的静电势能 $U$ 由库仑定律描述：\n$$\nU = \\frac{1}{4\\pi\\epsilon} \\frac{q_1 q_2}{r}\n$$\n其中 $\\epsilon$ 是介质的介电常数。介电常数通过关系式 $\\epsilon = \\epsilon_r \\epsilon_0$ 与真空介电常数 $\\epsilon_0$ 和介质的相对介电常数 $\\epsilon_r$ 相关联。将此代入能量方程可得：\n$$\nU = \\frac{1}{4\\pi\\epsilon_r\\epsilon_0} \\frac{q_1 q_2}{r}\n$$\n在分子动力学模拟的背景下，电荷通常以元电荷 $e$ 的无量纲倍数给出。设 $q_1 = z_1 e$ 和 $q_2 = z_2 e$，其中 $z_1$ 和 $z_2$ 是力场提供的部分电荷值。题目给出 $z_1 = +0.5$ 和 $z_2 = -0.5$。\n\n能量表达式变为：\n$$\nU = \\frac{1}{4\\pi\\epsilon_0} \\frac{(z_1 e)(z_2 e)}{\\epsilon_r r}\n$$\n为了简化计算并使用一套方便的单位——能量以千卡/摩尔（$\\text{kcal}\\,\\text{mol}^{-1}$）计，距离以埃（$\\text{\\AA}$）计，电荷以 $e$ 为单位——我们使用一个预先计算好的转换因子 $C$。该因子结合了物理常数（$1/(4\\pi\\epsilon_0)$、$e^2$、阿伏伽德罗常数 $N_A$）和必要的单位转换因子（焦耳到千卡，米到埃）。题目提供的这个因子是：\n$$\nC = 332.0637\\,\\text{kcal}\\,\\text{\\AA}\\,\\text{mol}^{-1}\\,e^{-2}\n$$\n然后使用以下在 MD 软件中为标准公式的公式计算能量：\n$$\nU = C \\frac{z_1 z_2}{\\epsilon_r r}\n$$\n其中 $z_1$ 和 $z_2$ 是无量纲的电荷值，$r$ 是以 $\\text{\\AA}$ 为单位的距离，$\\epsilon_r$ 是无量纲的相对介电常数。常数 $C$ 的单位被设计用来产生以 $\\text{kcal}\\,\\text{mol}^{-1}$ 为单位的能量。\n\n我们将给定的值代入此公式：\n- $z_1 = +0.5$\n- $z_2 = -0.5$\n- $r = 5.0\\,\\text{\\AA}$\n- $\\epsilon_r = 1$\n- $C = 332.0637\\,\\text{kcal}\\,\\text{\\AA}\\,\\text{mol}^{-1}\\,e^{-2}$\n\n能量 $U$ 的计算如下：\n$$\nU = 332.0637 \\cdot \\frac{(+0.5)(-0.5)}{(1)(5.0)}\n$$\n首先，计算电荷的乘积和分母：\n$$\nz_1 z_2 = (+0.5)(-0.5) = -0.25\n$$\n$$\n\\epsilon_r r = (1)(5.0) = 5.0\n$$\n现在，将这些值代回能量方程：\n$$\nU = 332.0637 \\cdot \\frac{-0.25}{5.0}\n$$\n$$\nU = 332.0637 \\cdot (-0.05)\n$$\n$$\nU = -16.603185\\,\\text{kcal}\\,\\text{mol}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。计算值为 $-16.603185$。前四位有效数字是 $1$、$6$、$6$ 和 $0$。第五位有效数字是 $3$。由于 $3$ 小于 $5$，我们不对第四位数字进行进位。\n因此，四舍五入后的能量为：\n$$\nU \\approx -16.60\\,\\text{kcal}\\,\\text{mol}^{-1}\n$$\n负号表示吸引相互作用，这与两个异号点电荷的情况相符。", "answer": "$$\n\\boxed{-16.60}\n$$", "id": "3397830"}, {"introduction": "非键相互作用的第二个主要部分是范德华力，它解释了非极性原子之间的短期吸引和排斥。在力场中，这通常由Lennard-Jones (LJ)势来建模。然而，不同的力场族（如OPLS和CHARMM）虽然描述相同的物理现象，但使用了在数学上不同但等效的LJ势函数形式。这项练习阐明了这些约定上的差异，并教你如何在不同力场的参数之间进行转换，这是一项在比较或组合不同来源的模拟结果时至关重要的实用技能 [@problem_id:3397867]。", "problem": "在分子动力学力场中，单中心范德华相互作用通常用 Lennard-Jones 势来模拟。OPLS (Optimized Potentials for Liquid Simulations) 力场族使用的形式为 $U_{\\text{OPLS}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$，而 CHARMM (Chemistry at HARvard Macromolecular Mechanics) 力场族使用的形式为 $U_{\\text{CHARMM}}(r) = \\epsilon\\left[\\left(\\frac{R_{\\min}}{r}\\right)^{12} - 2\\left(\\frac{R_{\\min}}{r}\\right)^{6}\\right]$。此处，$r$ 是原子间距，$\\epsilon$ 是势阱深度，$\\sigma$ 是 OPLS 的尺寸参数，而 $R_{\\min}$ 是势能达到最小值时 CHARMM 所用的距离。在 CHARMM 参数文件中，通常会为每种原子类型列出 $R_{\\min}/2$ 的值。\n\n请仅从上述两种势能形式出发，并利用“一致的映射必须保持势能最小值的位置和深度不变”这一事实，推导出单一原子类型的 OPLS 参数 $(\\sigma,\\epsilon)$ 与 CHARMM 参数 $(R_{\\min}/2,\\epsilon)$ 之间的映射关系。然后，对于一个 OPLS 参数为 $\\sigma = 3.55\\,\\text{\\AA}$ 且 $\\epsilon$ 为任意正值（应保持为符号形式）的碳原子类型，计算 $R_{\\min}/2$ 的数值，单位为埃（ångström）。\n\n报告您的最终数值，以埃为单位，并四舍五入到四位有效数字。", "solution": "这两种给定的 Lennard-Jones 形式是短程非键相互作用的标准且经过充分检验的表示方法。一个一致的参数映射必须保持两个特征不变：势能最小值的位置和势阱的深度。\n\n首先，考虑 OPLS 形式，\n$$\nU_{\\text{OPLS}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right].\n$$\n最小值出现在其关于 $r$ 的导数为零的位置。计算\n$$\n\\frac{dU_{\\text{OPLS}}}{dr} = 4\\epsilon\\left[-12\\,\\sigma^{12}\\,r^{-13} + 6\\,\\sigma^{6}\\,r^{-7}\\right].\n$$\n令 $\\frac{dU_{\\text{OPLS}}}{dr} = 0$ 可得\n$$\n-12\\,\\sigma^{12}\\,r^{-13} + 6\\,\\sigma^{6}\\,r^{-7} = 0 \\quad\\Rightarrow\\quad 6\\,\\sigma^{6}\\,r^{-7}\\left(-2\\,\\sigma^{6}\\,r^{-6} + 1\\right) = 0,\n$$\n因此非平凡解满足\n$$\n-2\\,\\sigma^{6}\\,r^{-6} + 1 = 0 \\quad\\Rightarrow\\quad r^{6} = 2\\,\\sigma^{6} \\quad\\Rightarrow\\quad r = 2^{1/6}\\sigma.\n$$\n因此，OPLS 势在 $r_{\\min}^{\\text{OPLS}} = 2^{1/6}\\sigma$ 处达到其最小值。最小值处的深度为\n$$\nU_{\\text{OPLS}}(r_{\\min}^{\\text{OPLS}}) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{2^{1/6}\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{2^{1/6}\\sigma}\\right)^{6}\\right]\n= 4\\epsilon\\left[\\left(2^{-1/6}\\right)^{12} - \\left(2^{-1/6}\\right)^{6}\\right]\n= 4\\epsilon\\left[2^{-2} - 2^{-1}\\right] = 4\\epsilon\\left[\\frac{1}{4} - \\frac{1}{2}\\right] = -\\epsilon.\n$$\n\n接下来，考虑 CHARMM 形式，\n$$\nU_{\\text{CHARMM}}(r) = \\epsilon\\left[\\left(\\frac{R_{\\min}}{r}\\right)^{12} - 2\\left(\\frac{R_{\\min}}{r}\\right)^{6}\\right].\n$$\n计算其导数：\n$$\n\\frac{dU_{\\text{CHARMM}}}{dr} = \\epsilon\\left[-12\\,R_{\\min}^{12}\\,r^{-13} + 12\\,R_{\\min}^{6}\\,r^{-7}\\right]\n= 12\\epsilon\\,R_{\\min}^{6}\\,r^{-13}\\left(-R_{\\min}^{6} + r^{6}\\right).\n$$\n令 $\\frac{dU_{\\text{CHARMM}}}{dr} = 0$ 可得 $r^{6} = R_{\\min}^{6}$，因此最小值在 $r_{\\min}^{\\text{CHARMM}} = R_{\\min}$ 处。最小值处的深度为\n$$\nU_{\\text{CHARMM}}(R_{\\min}) = \\epsilon\\left[1 - 2\\right] = -\\epsilon.\n$$\n\n同时保持最小值的位置和深度不变意味着\n$$\nr_{\\min}^{\\text{OPLS}} = r_{\\min}^{\\text{CHARMM}} \\quad\\text{and}\\quad \\epsilon_{\\text{OPLS}} = \\epsilon_{\\text{CHARMM}}.\n$$\n因此，尺寸参数之间的映射关系为\n$$\nR_{\\min} = 2^{1/6}\\,\\sigma,\n$$\n而存储在参数/拓扑文件中的每个原子的 CHARMM 参数为\n$$\n\\frac{R_{\\min}}{2} = \\frac{2^{1/6}\\,\\sigma}{2} = 2^{-5/6}\\,\\sigma.\n$$\n\n现在，对于给定的 OPLS 参数 $\\sigma = 3.55\\,\\text{\\AA}$，对 $R_{\\min}/2$ 进行数值计算：\n$$\n\\frac{R_{\\min}}{2} = 2^{-5/6}\\,\\sigma = \\frac{2^{1/6}\\times 3.55\\,\\text{\\AA}}{2}.\n$$\n使用 $2^{1/6} \\approx 1.122462048$，我们得到\n$$\nR_{\\min} \\approx 1.122462048 \\times 3.55\\,\\text{\\AA} \\approx 3.98474027\\,\\text{\\AA},\n$$\n因此\n$$\n\\frac{R_{\\min}}{2} \\approx \\frac{3.98474027\\,\\text{\\AA}}{2} \\approx 1.992370135\\,\\text{\\AA}.\n$$\n四舍五入到四位有效数字，结果是 $1.992\\,\\text{\\AA}$。", "answer": "$$\\boxed{1.992}$$", "id": "3397867"}]}