{"hands_on_practices": [{"introduction": "本练习旨在建立理论与实践之间的桥梁。我们将从哈密顿动力学的形式解出发，利用算符分裂方法，严谨地推导出分子动力学中最基本和广泛使用的积分器——Verlet算法。通过这个过程，你将理解这些积分器并非经验性的构造，而是基于Trotter分解的坚实数学基础，并能通过计算交换子来具体解释为何这种近似是必需的[@problem_id:3430695]。", "problem": "考虑一个经典的分子动力学 (MD) 系统，其哈密顿量为 $H = T(\\mathbf{p}) + V(\\mathbf{r})$，其中 $T(\\mathbf{p}) = \\sum_{i} \\frac{|\\mathbf{p}_i|^2}{2 m_i}$，$V(\\mathbf{r})$ 是一个光滑势。设 $\\mathbf{r} = (\\mathbf{r}_1,\\dots,\\mathbf{r}_N)$ 为位置，$\\mathbf{p} = (\\mathbf{p}_1,\\dots,\\mathbf{p}_N)$ 为动量。定义与动能和势能部分相关的刘维尔算符为 $L_T = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m_i} \\cdot \\nabla_{\\mathbf{r}_i}$ 和 $L_V = \\sum_{i=1}^{N} \\mathbf{F}_i(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_i}$，其中 $\\mathbf{F}_i(\\mathbf{r}) = - \\nabla_{\\mathbf{r}_i} V(\\mathbf{r})$。\n\n从形式流算符 $\\exp(\\Delta t (L_T + L_V))$ 出发，并仅使用基本定律和核心定义（牛顿第二定律和作用于相空间函数的刘维尔算符的定义），完成以下任务：\n\n1. 推导 $\\exp(\\Delta t (L_T + L_V))$ 的两种二阶 Strang 算符分裂：\n   - 复合 $\\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right) \\exp\\!\\left(\\Delta t L_V\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right)$。\n   - 复合 $\\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right) \\exp\\!\\left(\\Delta t L_T\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right)$。\n   对于每种复合，从第一性原理出发解释 $\\exp(\\Delta t L_T)$ 和 $\\exp(\\Delta t L_V)$ 对 $(\\mathbf{r},\\mathbf{p})$ 的作用，并证明第一种复合产生位置 Verlet 方案，第二种复合产生速度 Verlet 方案。在每种情况下，明确写出 $(\\mathbf{r},\\mathbf{p})$ 的更新序列。\n\n2. 现在考虑一个双粒子 Lennard–Jones 系统 ($N=2$)，其位置为 $\\mathbf{r}_1,\\mathbf{r}_2$，动量为 $\\mathbf{p}_1,\\mathbf{p}_2$，质量为 $m_1,m_2$，对势为 $V(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$，其中 $r = \\|\\mathbf{r}_1 - \\mathbf{r}_2\\|$，$\\epsilon>0$ 和 $\\sigma>0$ 为参数。仅使用 $L_T$ 和 $L_V$ 的定义以及链式法则，计算作用于坐标 $\\mathbf{r}_1$ 的对易子 $[L_T,L_V]$，并将其简化，以 $\\epsilon$、$\\sigma$、$\\mathbf{r}_1$、$\\mathbf{r}_2$ 和 $m_1$ 表示，得到一个封闭形式的表达式。使用此计算解释为什么对于该系统，$L_T$ 和 $L_V$ 不对易。\n\n将 Lennard–Jones 对的 $[L_T,L_V]\\,\\mathbf{r}_1$ 的解析表达式作为最终答案报告。不要进行数值计算，并且最终答案中不要包含单位。", "solution": "该问题被验证为具有科学依据、问题明确且客观。所有给出的定义和关系都与经典哈密顿力学和分子动力学数值分析的原理一致。该问题可按所述方式求解。\n\n解答按要求分为两部分呈现。\n\n### 第 1 部分：从算符分裂推导 Verlet 方案\n\n在哈密顿量 $H$ 的作用下，相空间点 $(\\mathbf{r}(t), \\mathbf{p}(t))$ 的时间演化由哈密顿方程决定。形式解可以用刘维尔算符 $L$ 表示，即 $(\\mathbf{r}(\\Delta t), \\mathbf{p}(\\Delta t)) = \\exp(\\Delta t L) (\\mathbf{r}(0), \\mathbf{p}(0))$。对于形式为 $H = T(\\mathbf{p}) + V(\\mathbf{r})$ 的哈密顿量，刘维尔算符 $L$ 可以分解为 $L = L_T + L_V$。由于 $L_T$ 和 $L_V$ 通常不对易，它们的和的指数不能简单地因式分解，即 $\\exp(\\Delta t (L_T + L_V)) \\neq \\exp(\\Delta t L_T) \\exp(\\Delta t L_V)$。Strang 分裂提供了一个二阶近似。\n\n首先，我们分析单个传播子 $\\exp(t L_T)$ 和 $\\exp(t L_V)$ 的作用。\n\n**$\\exp(t L_T)$ 的作用：**\n传播子 $\\exp(t L_T)$ 在只有动能的哈密顿量 $H_T = T(\\mathbf{p})$ 下演化系统。相应的哈密顿方程为：\n$$\n\\dot{\\mathbf{r}}_i = \\frac{\\partial H_T}{\\partial \\mathbf{p}_i} = \\frac{\\mathbf{p}_i}{m_i}\n$$\n$$\n\\dot{\\mathbf{p}}_i = -\\frac{\\partial H_T}{\\partial \\mathbf{r}_i} = \\mathbf{0}\n$$\n从初始状态 $(\\mathbf{r}(0), \\mathbf{p}(0))$ 开始，对这些方程在一个时间间隔 $t$ 上积分，得到：\n$$\n\\mathbf{p}_i(t) = \\mathbf{p}_i(0)\n$$\n$$\n\\mathbf{r}_i(t) = \\mathbf{r}_i(0) + \\int_0^t \\frac{\\mathbf{p}_i(s)}{m_i} ds = \\mathbf{r}_i(0) + \\frac{\\mathbf{p}_i(0)}{m_i} t\n$$\n因此，$\\exp(t L_T)$ 的作用对应于在动量恒定的情况下位置的“漂移”。\n\n**$\\exp(t L_V)$ 的作用：**\n传播子 $\\exp(t L_V)$ 在只有势能的哈密顿量 $H_V = V(\\mathbf{r})$ 下演化系统。相应的哈密顿方程为：\n$$\n\\dot{\\mathbf{r}}_i = \\frac{\\partial H_V}{\\partial \\mathbf{p}_i} = \\mathbf{0}\n$$\n$$\n\\dot{\\mathbf{p}}_i = -\\frac{\\partial H_V}{\\partial \\mathbf{r}_i} = \\mathbf{F}_i(\\mathbf{r})\n$$\n对这些方程在一个时间间隔 $t$ 上积分，得到：\n$$\n\\mathbf{r}_i(t) = \\mathbf{r}_i(0)\n$$\n$$\n\\mathbf{p}_i(t) = \\mathbf{p}_i(0) + \\int_0^t \\mathbf{F}_i(\\mathbf{r}(s)) ds = \\mathbf{p}_i(0) + \\mathbf{F}_i(\\mathbf{r}(0)) t\n$$\n因此，$\\exp(t L_V)$ 的作用对应于在位置恒定的情况下对动量的“踢”。\n\n现在，我们分析这两种复合。设时间步 $n$ 的状态为 $(\\mathbf{r}^n, \\mathbf{p}^n)$。我们要求解时间步 $n+1$ 的状态 $(\\mathbf{r}^{n+1}, \\mathbf{p}^{n+1})$。\n\n**复合 1：$\\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right) \\exp\\!\\left(\\Delta t L_V\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right)$ (位置 Verlet)**\n\n我们将算符从右到左作用于状态 $(\\mathbf{r}^n, \\mathbf{p}^n)$。\n1.  **第一次半步漂移：** $\\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right)$ 的作用是更新位置。我们定义一个中间状态 $(\\mathbf{r}^{n+1/2}, \\mathbf{p}')$。\n    $$ \\mathbf{r}^{n+1/2} = \\mathbf{r}^n + \\frac{\\Delta t}{2 m} \\mathbf{p}^n $$\n    $$ \\mathbf{p}' = \\mathbf{p}^n $$\n2.  **完整一步踢：** $\\exp\\!\\left(\\Delta t L_V\\right)$ 的作用是使用在中间位置 $\\mathbf{r}^{n+1/2}$ 处的力来更新动量。设得到的状态为 $(\\mathbf{r}'', \\mathbf{p}^{n+1})$。\n    $$ \\mathbf{r}'' = \\mathbf{r}^{n+1/2} $$\n    $$ \\mathbf{p}^{n+1} = \\mathbf{p}' + \\Delta t \\, \\mathbf{F}(\\mathbf{r}^{n+1/2}) = \\mathbf{p}^n + \\Delta t \\, \\mathbf{F}\\left(\\mathbf{r}^n + \\frac{\\Delta t}{2 m} \\mathbf{p}^n\\right) $$\n3.  **第二次半步漂移：** $\\exp\\!\\left(\\frac{\\Delta t}{2} L_T\\right)$ 的作用是使用新计算出的动量 $\\mathbf{p}^{n+1}$ 再次更新位置。\n    $$ \\mathbf{r}^{n+1} = \\mathbf{r}'' + \\frac{\\Delta t}{2 m} \\mathbf{p}^{n+1} = \\mathbf{r}^{n+1/2} + \\frac{\\Delta t}{2 m} \\mathbf{p}^{n+1} $$\n    $$ \\mathbf{p}^{n+1} \\text{ 保持不变。} $$\n\n完整的更新序列被确定为位置 Verlet 方案（或一种蛙跳积分器），如下所示：\n   1.  $\\mathbf{r}^{n+1/2}_i = \\mathbf{r}^n_i + \\frac{\\Delta t}{2 m_i} \\mathbf{p}^n_i$\n   2.  $\\mathbf{p}^{n+1}_i = \\mathbf{p}^n_i + \\Delta t \\, \\mathbf{F}_i(\\mathbf{r}^{n+1/2})$\n   3.  $\\mathbf{r}^{n+1}_i = \\mathbf{r}^{n+1/2}_i + \\frac{\\Delta t}{2 m_i} \\mathbf{p}^{n+1}_i$\n该方案是时间可逆和辛的，这对于长时间模拟是理想的属性。\n\n**复合 2：$\\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right) \\exp\\!\\left(\\Delta t L_T\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right)$ (速度 Verlet)**\n\n我们将算符从右到左作用于状态 $(\\mathbf{r}^n, \\mathbf{p}^n)$。\n1.  **第一次半步踢：** $\\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right)$ 的作用是更新动量。我们定义一个中间动量 $\\mathbf{p}^{n+1/2}$。\n    $$ \\mathbf{p}^{n+1/2} = \\mathbf{p}^n + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^n) $$\n    $$ \\mathbf{r}' = \\mathbf{r}^n $$\n2.  **完整一步漂移：** $\\exp\\!\\left(\\Delta t L_T\\right)$ 的作用是使用中间动量 $\\mathbf{p}^{n+1/2}$ 更新位置。设得到的状态为 $(\\mathbf{r}^{n+1}, \\mathbf{p}'')$。\n    $$ \\mathbf{r}^{n+1} = \\mathbf{r}' + \\frac{\\Delta t}{m} \\mathbf{p}^{n+1/2} = \\mathbf{r}^n + \\frac{\\Delta t}{m} \\left( \\mathbf{p}^n + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^n) \\right) = \\mathbf{r}^n + \\frac{\\Delta t}{m} \\mathbf{p}^n + \\frac{(\\Delta t)^2}{2 m} \\mathbf{F}(\\mathbf{r}^n) $$\n    $$ \\mathbf{p}'' = \\mathbf{p}^{n+1/2} $$\n3.  **第二次半步踢：** $\\exp\\!\\left(\\frac{\\Delta t}{2} L_V\\right)$ 的作用是使用在新位置 $\\mathbf{r}^{n+1}$ 处的力再次更新动量。\n    $$ \\mathbf{p}^{n+1} = \\mathbf{p}'' + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^{n+1}) = \\mathbf{p}^{n+1/2} + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^{n+1}) = \\left(\\mathbf{p}^n + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^n)\\right) + \\frac{\\Delta t}{2} \\mathbf{F}(\\mathbf{r}^{n+1}) $$\n    $$ \\mathbf{r}^{n+1} \\text{ 保持不变。} $$\n\n完整的更新序列是：\n   1.  $\\mathbf{r}^{n+1}_i = \\mathbf{r}^n_i + \\frac{\\mathbf{p}^n_i}{m_i}\\Delta t + \\frac{(\\Delta t)^2}{2 m_i} \\mathbf{F}_i(\\mathbf{r}^n)$\n   2.  $\\mathbf{p}^{n+1}_i = \\mathbf{p}^n_i + \\frac{\\Delta t}{2} \\left[ \\mathbf{F}_i(\\mathbf{r}^n) + \\mathbf{F}_i(\\mathbf{r}^{n+1}) \\right]$\n这是速度 Verlet 算法的标准形式。它每步需要两次力计算（一次在 $\\mathbf{r}^n$ 处，可以重用上一步的第二次计算结果；另一次在 $\\mathbf{r}^{n+1}$ 处）。\n\n### 第 2 部分：Lennard-Jones 对的对易子计算\n\n我们被要求为一个具有 Lennard-Jones 势的双粒子系统计算 $[L_T, L_V]\\mathbf{r}_1 = (L_T L_V - L_V L_T)\\mathbf{r}_1$。\n刘维尔算符为：\n$$ L_T = \\frac{\\mathbf{p}_1}{m_1} \\cdot \\nabla_{\\mathbf{r}_1} + \\frac{\\mathbf{p}_2}{m_2} \\cdot \\nabla_{\\mathbf{r}_2} $$\n$$ L_V = \\mathbf{F}_1(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_1} + \\mathbf{F}_2(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_2} $$\n对易子作用于坐标函数 $\\mathbf{r}_1$。\n\n第一项：$L_T L_V \\mathbf{r}_1$。\n我们首先将 $L_V$ 作用于 $\\mathbf{r}_1$。坐标 $\\mathbf{r}_1$ 是相空间位置的函数，而不是动量的函数。因此，动量梯度算符得到零：\n$$ L_V \\mathbf{r}_1 = (\\mathbf{F}_1 \\cdot \\nabla_{\\mathbf{p}_1} + \\mathbf{F}_2 \\cdot \\nabla_{\\mathbf{p}_2}) \\mathbf{r}_1 = \\mathbf{0} $$\n将 $L_T$ 作用于零向量得到零：\n$$ L_T L_V \\mathbf{r}_1 = L_T(\\mathbf{0}) = \\mathbf{0} $$\n\n第二项：$-L_V L_T \\mathbf{r}_1$。\n我们首先将 $L_T$ 作用于 $\\mathbf{r}_1$。\n$$ L_T \\mathbf{r}_1 = \\left(\\frac{\\mathbf{p}_1}{m_1} \\cdot \\nabla_{\\mathbf{r}_1} + \\frac{\\mathbf{p}_2}{m_2} \\cdot \\nabla_{\\mathbf{r}_2}\\right) \\mathbf{r}_1 $$\n由于 $\\mathbf{r}_1$ 与 $\\mathbf{r}_2$ 无关，$\\nabla_{\\mathbf{r}_2} \\mathbf{r}_1 = 0$。梯度 $\\nabla_{\\mathbf{r}_1} \\mathbf{r}_1$ 是二阶单位张量 $\\mathbf{I}$。\n$$ L_T \\mathbf{r}_1 = \\frac{\\mathbf{p}_1}{m_1} \\cdot (\\nabla_{\\mathbf{r}_1} \\mathbf{r}_1) = \\frac{\\mathbf{p}_1}{m_1} \\cdot \\mathbf{I} = \\frac{\\mathbf{p}_1}{m_1} $$\n接下来，我们将 $L_V$ 作用于此结果：\n$$ L_V (L_T \\mathbf{r}_1) = L_V \\left( \\frac{\\mathbf{p}_1}{m_1} \\right) = (\\mathbf{F}_1 \\cdot \\nabla_{\\mathbf{p}_1} + \\mathbf{F}_2 \\cdot \\nabla_{\\mathbf{p}_2}) \\left( \\frac{\\mathbf{p}_1}{m_1} \\right) $$\n项 $\\mathbf{p}_1/m_1$ 与 $\\mathbf{p}_2$ 无关，所以 $\\nabla_{\\mathbf{p}_2} (\\mathbf{p}_1/m_1) = 0$。梯度 $\\nabla_{\\mathbf{p}_1} \\mathbf{p}_1$ 是单位张量 $\\mathbf{I}$。\n$$ L_V (L_T \\mathbf{r}_1) = \\mathbf{F}_1 \\cdot \\left(\\frac{1}{m_1} \\nabla_{\\mathbf{p}_1} \\mathbf{p}_1\\right) = \\mathbf{F}_1 \\cdot \\left(\\frac{1}{m_1} \\mathbf{I}\\right) = \\frac{\\mathbf{F}_1}{m_1} $$\n\n合并各项，我们得到：\n$$ [L_T, L_V]\\mathbf{r}_1 = \\mathbf{0} - \\frac{\\mathbf{F}_1}{m_1} = -\\frac{\\mathbf{F}_1}{m_1} $$\n作用在粒子 1 上的力是 $\\mathbf{F}_1 = -\\nabla_{\\mathbf{r}_1} V(r)$。所以，$[L_T, L_V]\\mathbf{r}_1 = \\frac{1}{m_1} \\nabla_{\\mathbf{r}_1} V(r)$。\n我们必须计算这个梯度。使用链式法则，其中 $r = \\|\\mathbf{r}_1 - \\mathbf{r}_2\\|$：\n$$ \\nabla_{\\mathbf{r}_1} V(r) = \\frac{dV}{dr} \\nabla_{\\mathbf{r}_1} r = \\frac{dV}{dr} \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{r} $$\nLennard-Jones 势 $V(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$ 的导数是：\n$$ \\frac{dV}{dr} = 4\\epsilon \\left[ -12 \\sigma^{12} r^{-13} - (-6) \\sigma^6 r^{-7} \\right] = 4\\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right] $$\n将此代入对易子的表达式中：\n$$ [L_T, L_V]\\mathbf{r}_1 = \\frac{1}{m_1} \\left( 4\\epsilon \\left[ -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right] \\right) \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{r} $$\n$$ [L_T, L_V]\\mathbf{r}_1 = \\frac{4\\epsilon}{m_1 r^2} \\left[ -12 \\left(\\frac{\\sigma}{r}\\right)^{12} + 6 \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] (\\mathbf{r}_1 - \\mathbf{r}_2) $$\n提出因子 $-6$ 得到最终形式：\n$$ [L_T, L_V]\\mathbf{r}_1 = -\\frac{24\\epsilon}{m_1 r^2} \\left[ 2 \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] (\\mathbf{r}_1 - \\mathbf{r}_2) $$\n\n两个算符对易的充要条件是它们的对易子为零算符。要使 $[L_T, L_V]$ 为零算符，它对其定义域中每个函数的作用都必须为零。我们已经证明 $[L_T, L_V]\\mathbf{r}_1 = -\\mathbf{F}_1/m_1$。要使此式对于任何构型 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 都为零，力 $\\mathbf{F}_1$ 必须恒为零。对于几乎所有的粒子间距 $r$，Lennard-Jones 力都非零。因此，$[L_T, L_V]$ 是一个非零算符，这证明了对于该系统，$L_T$ 和 $L_V$ 不对易。这种非对易性是在数值模拟中必须用算符分裂（Trotter 分解）来近似精确传播子 $\\exp(\\Delta t(L_T+L_V))$ 的根本原因。", "answer": "$$\\boxed{-\\frac{24\\epsilon}{m_1 r^2} \\left(2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right)(\\mathbf{r}_1-\\mathbf{r}_2)}$$", "id": "3430695"}, {"introduction": "真实世界的分子系统通常包含多个时间尺度，从快速的键振动到缓慢的构象变化。本练习将探讨如何利用算符分裂来设计高效的多时间步长积分算法（如RESPA），并教会你如何通过线性稳定性分析来研究其行为。你将推导出一个谐振子模型的共振条件，揭示当数值积分频率与系统固有频率发生耦合时可能出现的数值不稳定性，这是保证长时间模拟可靠性的关键一步[@problem_id:3430705]。", "problem": "考虑一个质量为 $m=1$ 的一维粒子，其在哈密顿量 $H(x,p)=\\frac{p^{2}}{2}+V(x)$ 下演化，其中 $V(x)=V_{\\text{fast}}(x)+V_{\\text{slow}}(x)$，$V_{\\text{fast}}(x)=\\frac{1}{2}k_{f}x^{2}$ 且 $V_{\\text{slow}}(x)=\\frac{1}{2}k_{s}x^{2}$。定义快、慢角频率为 $\\omega_{f}^{2}=k_{f}$ 和 $\\omega_{s}^{2}=k_{s}$。该动力学过程使用参考系传播子算法 (RESPA) 进行推进，该算法利用了刘维尔算子 $L=L_{\\text{kin}}+L_{\\text{fast}}+L_{\\text{slow}}$ 的对称 Trotter 分解，其中 $L_{\\text{kin}}$ 产生自由漂移，$L_{\\text{fast}}$ 和 $L_{\\text{slow}}$ 分别从 $V_{\\text{fast}}$ 和 $V_{\\text{slow}}$ 产生踢。在一个大小为 $h_{s}$ 的外层步长中，该算法施加一个半步长慢踢，然后是 $n$ 个大小为 $h_{f}=h_{s}/n$ 的内层步长，这些内层步长在速度 Verlet 组合中仅使用快力，最后再施加一个半步长慢踢。\n\n从哈密顿方程以及由 $L_{\\text{kin}}$ 和二次踢产生的精确流出发，对作用于该双频谐振子模型的相空间矢量 $(x,p)^{\\top}$ 上的单周期映射进行线性稳定性分析。利用以下性质：一个具有单位行列式的辛 $2\\times 2$ 单值矩阵的线性稳定性由其特征值是否位于单位圆上决定，并且当半迹等于 $\\pm 1$ 时出现共振边界。\n\n以闭合形式推导单周期映射的半迹，将其表示为内/外步长比 $n$、频率比 $r=\\omega_{f}/\\omega_{s}$ 和无量纲快内步长 $\\alpha=\\omega_{f}h_{f}$ 的解析函数。你的最终答案必须是该半迹的单个闭合形式表达式，用在适当参数下求值的第一类和第二类切比雪夫多项式 $T_{n}(\\cdot)$ 和 $U_{n}(\\cdot)$ 表示。然后通过将此半迹设为 $\\pm 1$ 来获得共振条件。不需要进行数值计算，也无需四舍五入。将你的最终结果表示为一个无量纲的解析表达式。", "solution": "该问题要求推导使用参考系传播子算法 (RESPA) 积分的一维粒子的单周期映射的半迹。分析首先将积分器形式化为作用于相空间矢量 $\\mathbf{z} = (x, p)^{\\top}$ 的矩阵乘积。\n\n哈密顿量由 $H(x,p) = \\frac{p^2}{2m} + V_{\\text{fast}}(x) + V_{\\text{slow}}(x)$ 给出。当质量 $m=1$，势能为 $V_{\\text{fast}}(x) = \\frac{1}{2}k_f x^2$ 和 $V_{\\text{slow}}(x) = \\frac{1}{2}k_s x^2$ 时，哈密顿量为 $H(x,p) = \\frac{p^2}{2} + \\frac{1}{2}\\omega_f^2 x^2 + \\frac{1}{2}\\omega_s^2 x^2$，其中 $\\omega_f^2 = k_f$ 且 $\\omega_s^2 = k_s$。\n\n动力学由刘维尔算子 $L = \\{\\cdot, H\\}$ 控制，该算子被分解为三个部分：$L = L_{\\text{kin}} + L_{\\text{fast}} + L_{\\text{slow}}$。\n由每个部分引起的演化可以表示为一个作用于 $\\mathbf{z}$ 的 $2 \\times 2$ 矩阵。\n1.  动能部分 $H_{\\text{kin}} = p^2/2$ 产生自由漂移。相应的运动方程为 $\\dot{x}=p, \\dot{p}=0$。对于一个时间步长 $h$，其传播子为 $\\mathcal{D}(h) = \\exp(h L_{\\text{kin}})$，矩阵表示为：\n    $$ M_D(h) = \\begin{pmatrix} 1  h \\\\ 0  1 \\end{pmatrix} $$\n2.  快势部分 $H_{\\text{fast}} = \\frac{1}{2}\\omega_f^2 x^2$ 产生一个“踢”。运动方程为 $\\dot{x}=0, \\dot{p}=-\\omega_f^2 x$。传播子 $\\mathcal{K}_f(h) = \\exp(h L_{\\text{fast}})$ 的矩阵表示为：\n    $$ M_{Kf}(h) = \\begin{pmatrix} 1  0 \\\\ -h\\omega_f^2  1 \\end{pmatrix} $$\n3.  慢势部分 $H_{\\text{slow}} = \\frac{1}{2}\\omega_s^2 x^2$ 也产生一个踢。传播子 $\\mathcal{K}_s(h) = \\exp(h L_{\\text{slow}})$ 的矩阵表示为：\n    $$ M_{Ks}(h) = \\begin{pmatrix} 1  0 \\\\ -h\\omega_s^2  1 \\end{pmatrix} $$\n\n大小为 $h_s$ 的一个外层步长的 RESPA 积分器被指定为一个对称组合：一个半步长慢踢，后跟 $n$ 个内层步长，最后再跟一个半步长慢踢：\n$$ S(h_s) = \\mathcal{K}_s\\left(\\frac{h_s}{2}\\right) \\left( S_{\\text{inner}}(h_f) \\right)^n \\mathcal{K}_s\\left(\\frac{h_s}{2}\\right) $$\n每个内层步长 $S_{\\text{inner}}(h_f)$ 是一个大小为 $h_f = h_s/n$ 的速度 Verlet 步长，仅使用快力：\n$$ S_{\\text{inner}}(h_f) = \\mathcal{K}_f\\left(\\frac{h_f}{2}\\right) \\mathcal{D}(h_f) \\mathcal{K}_f\\left(\\frac{h_f}{2}\\right) $$\n单周期映射，或称单值矩阵 $M(h_s)$，是 $S(h_s)$ 的矩阵表示。首先，我们求单个内层步长的矩阵 $M_{\\text{inner}}(h_f)$：\n$$ M_{\\text{inner}}(h_f) = M_{Kf}\\left(\\frac{h_f}{2}\\right) M_D(h_f) M_{Kf}\\left(\\frac{h_f}{2}\\right) $$\n$$ M_{\\text{inner}}(h_f) = \\begin{pmatrix} 1  0 \\\\ -\\frac{h_f\\omega_f^2}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  h_f \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -\\frac{h_f\\omega_f^2}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{h_f^2\\omega_f^2}{2}  h_f \\\\ -h_f\\omega_f^2 \\left(1 - \\frac{h_f^2\\omega_f^2}{4}\\right)  1 - \\frac{h_f^2\\omega_f^2}{2} \\end{pmatrix} $$\n为了求出 $n$ 个内层步长的矩阵 $M_{\\text{chain}} = (M_{\\text{inner}}(h_f))^n$，我们利用具有单位行列式的 $2 \\times 2$ 矩阵的幂的性质。对于一个矩阵 $A = \\begin{pmatrix} a  b \\\\ c  a \\end{pmatrix}$ 且 $\\det(A)=1$，其 $n$ 次幂由以下公式给出：\n$$ A^n = \\begin{pmatrix} T_n(a)  b U_{n-1}(a) \\\\ c U_{n-1}(a)  T_n(a) \\end{pmatrix} $$\n其中 $T_n$ 和 $U_n$ 分别是第一类和第二类切比雪夫多项式。在我们的例子中，多项式的自变量是 $M_{\\text{inner}}(h_f)$ 的半迹：\n$$ y = \\frac{1}{2}\\text{Tr}(M_{\\text{inner}}(h_f)) = 1 - \\frac{h_f^2\\omega_f^2}{2} $$\n使用无量纲内步长 $\\alpha = \\omega_f h_f$，我们有 $y = 1 - \\frac{\\alpha^2}{2}$。\n这 $n$ 个内层步长链的矩阵是：\n$$ M_{\\text{chain}} = (M_{\\text{inner}}(h_f))^n = \\begin{pmatrix} T_n(y)  h_f U_{n-1}(y) \\\\ -h_f\\omega_f^2 \\left(1 - \\frac{\\alpha^2}{4}\\right) U_{n-1}(y)  T_n(y) \\end{pmatrix} $$\n完整的单值矩阵是 $M(h_s) = M_{Ks}\\left(\\frac{h_s}{2}\\right) M_{\\text{chain}} M_{Ks}\\left(\\frac{h_s}{2}\\right)$。令 $M_K = M_{Ks}\\left(\\frac{h_s}{2}\\right) = \\begin{pmatrix} 1  0 \\\\ -h_s\\omega_s^2/2  1 \\end{pmatrix}$。\n矩阵乘积的迹在循环置换下是不变的，所以 $\\text{Tr}(M_K M_{\\text{chain}} M_K) \\ne \\text{Tr}(M_K^2 M_{\\text{chain}})$。我们必须显式地计算矩阵乘积来求迹。\n令 $M_{\\text{chain}} = \\begin{pmatrix} a_n  b_n \\\\ c_n  a_n \\end{pmatrix}$，其中 $a_n = T_n(y)$，$b_n = h_f U_{n-1}(y)$，且 $c_n = -h_f\\omega_f^2 (1 - \\alpha^2/4) U_{n-1}(y)$。\n$$ M(h_s) = \\begin{pmatrix} 1  0 \\\\ -h_s\\omega_s^2/2  1 \\end{pmatrix} \\begin{pmatrix} a_n  b_n \\\\ c_n  a_n \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -h_s\\omega_s^2/2  1 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} a_n  b_n \\\\ -a_n h_s\\omega_s^2/2 + c_n  -b_n h_s\\omega_s^2/2 + a_n \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -h_s\\omega_s^2/2  1 \\end{pmatrix} $$\n所得矩阵的对角线元素为：\n$$ [M(h_s)]_{11} = a_n - \\frac{b_n h_s\\omega_s^2}{2} $$\n$$ [M(h_s)]_{22} = \\left(-a_n \\frac{h_s\\omega_s^2}{2} + c_n\\right)(0) + \\left(-b_n \\frac{h_s\\omega_s^2}{2} + a_n\\right)(1) = a_n - \\frac{b_n h_s\\omega_s^2}{2} $$\n迹为 $\\text{Tr}(M(h_s)) = 2a_n - b_n h_s\\omega_s^2$。因此，半迹为：\n$$ \\frac{1}{2}\\text{Tr}(M(h_s)) = a_n - \\frac{b_n h_s\\omega_s^2}{2} = T_n(y) - \\frac{1}{2} (h_f U_{n-1}(y)) h_s\\omega_s^2 $$\n现在我们用 $n$，$r = \\omega_f/\\omega_s$ 和 $\\alpha = \\omega_f h_f$ 来表示这些参数。\n切比雪夫多项式的自变量是 $y = 1 - \\alpha^2/2$。\n第二项的系数是 $\\frac{1}{2}h_f h_s \\omega_s^2$。使用 $h_s = n h_f$，这变为 $\\frac{1}{2} n h_f^2 \\omega_s^2$。\n我们代入 $h_f = \\alpha/\\omega_f$：\n$$ \\frac{1}{2} n \\left(\\frac{\\alpha}{\\omega_f}\\right)^2 \\omega_s^2 = \\frac{n \\alpha^2}{2} \\left(\\frac{\\omega_s}{\\omega_f}\\right)^2 = \\frac{n \\alpha^2}{2 r^2} $$\n将这些代入半迹的表达式中，得到最终结果。\n\n半迹，我们记为 $\\mathcal{T}$，是：\n$$ \\mathcal{T}(n, r, \\alpha) = T_n\\left(1 - \\frac{\\alpha^2}{2}\\right) - \\frac{n \\alpha^2}{2r^2} U_{n-1}\\left(1 - \\frac{\\alpha^2}{2}\\right) $$\n该数值方案的共振条件由 $|\\mathcal{T}| \\ge 1$ 给出，稳定区域的边界在 $\\mathcal{T} = \\pm 1$。", "answer": "$$\\boxed{T_{n}\\left(1 - \\frac{\\alpha^{2}}{2}\\right) - \\frac{n \\alpha^{2}}{2r^{2}} U_{n-1}\\left(1 - \\frac{\\alpha^{2}}{2}\\right)}$$", "id": "3430705"}, {"introduction": "在正则系综（NVT）模拟中，我们需要将系统与恒温器耦合，这在算符层面引入了新的动力学项。本练习将引导你运用“影子哈密顿量”这一强大概念，来分析因算符分裂引入的数值积分伪影，特别是对系统温度的影响。通过推导，你将学会如何优化Nosé–Hoover恒温器的参数，以最小化由时间步长引起的温度偏差，从而确保模拟能够准确地抽样于目标统计系综[@problem_id:3430714]。", "problem": "考虑一个质量为 $m$ 的单个粒子在一维空间中运动，其坐标为 $(q,p)$，在谐波势 $U(q) = \\frac{1}{2} m \\omega^{2} q^{2}$ 下演化，目标温度为 $T$。该系统与一个单变量 Nosé–Hoover 恒温器耦合，恒温器变量为 $\\xi$，Nosé 质量为 $Q$。确定性的 Nosé–Hoover 运动方程为\n$$\n\\dot{q} = \\frac{p}{m}, \\quad \\dot{p} = - m \\omega^{2} q - \\xi p, \\quad \\dot{\\xi} = \\frac{1}{Q}\\left(\\frac{p^{2}}{m} - k_{B} T\\right),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，系统有一个物理自由度。复合刘维尔算符是物理哈密顿流 $L_{P}$ 和恒温器流 $L_{C}$ 的和，\n$$\nL_{P} f = \\frac{p}{m} \\frac{\\partial f}{\\partial q} - m \\omega^{2} q \\frac{\\partial f}{\\partial p}, \\quad\nL_{C} f = - \\xi p \\frac{\\partial f}{\\partial p} + \\frac{1}{Q}\\left(\\frac{p^{2}}{m} - k_{B} T\\right) \\frac{\\partial f}{\\partial \\xi}.\n$$\n我们通过对全刘维尔算符 $L = L_{P} + L_{C}$ 的对称二阶 Strang 分裂来积分动力学：\n$$\nS(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2} L_{C}\\right) \\exp\\!\\left(\\Delta t L_{P}\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_{C}\\right),\n$$\n其中 $\\Delta t$ 是时间步长。对于此算符分裂，Baker–Campbell–Hausdorff (BCH) 展开定义了一个修正的或“影子”生成元 $L_{s}$ 以及一个相关的影子二次不变量（影子哈密顿量）$H_{s}$，该不变量被 $S(\\Delta t)$ 精确守恒，并且其正则测量控制着离散化动力学的主要温度偏差。\n\n从第一性原理（刘维尔形式体系和 BCH 展开到最低非平凡阶）出发，对上述线性系统进行影子哈密顿量分析，以确定由 $S(\\Delta t)$ 引起的组态温度偏差的主要 $\\mathcal{O}(\\Delta t^{2})$ 阶贡献。证明 $H_{s}$ 中的 $\\mathcal{O}(\\Delta t^{2})$ 项会修正动能项的有效二次系数，其修正量与 $\\omega_{T}^{2} - \\omega^{2}$ 成正比，其中恒温器频率 $\\omega_{T}$ 通过线性化的 Nosé–Hoover 时间尺度定义，\n$$\n\\omega_{T} = \\sqrt{\\frac{k_{B} T}{Q}}.\n$$\n利用这一点来调节 Nosé 质量 $Q$，以在满足“恒温器弛豫率等于物理振子频率”这一设计准则的条件下，最小化 $\\mathcal{O}(\\Delta t^{2})$ 阶的温度偏差，即 $\\omega_{T}$ 等于一个为匹配 $\\omega$ 而选择的指定目标弛豫率 $\\nu$。\n\n推导最优 $Q$ 关于 $k_{B}$、$T$ 和 $\\omega$ 的闭式解析表达式。您的最终答案必须是单一的解析表达式。无需进行数值计算。", "solution": "用户提供了一个分子动力学领域的问题，具体涉及与 Nosé–Hoover 恒温器耦合的谐振子的数值积分。任务是验证该问题，如果有效，则提供详细的解答。\n\n### 第 1 步：问题验证\n\n问题陈述提供了以下已知条件：\n- 质量为 $m$ 的单个粒子在一维空间中。\n- 坐标 $(q,p)$。\n- 谐波势 $U(q) = \\frac{1}{2} m \\omega^{2} q^{2}$。\n- 目标温度 $T$。\n- Nosé–Hoover 恒温器，变量为 $\\xi$，质量为 $Q$。\n- 运动方程：$\\dot{q} = \\frac{p}{m}$, $\\dot{p} = - m \\omega^{2} q - \\xi p$, $\\dot{\\xi} = \\frac{1}{Q}\\left(\\frac{p^{2}}{m} - k_{B} T\\right)$。\n- 玻尔兹曼常数 $k_B$。\n- 复合刘维尔算符 $L = L_{P} + L_{C}$，其中 $L_{P} f = \\frac{p}{m} \\frac{\\partial f}{\\partial q} - m \\omega^{2} q \\frac{\\partial f}{\\partial p}$ 且 $L_{C} f = - \\xi p \\frac{\\partial f}{\\partial p} + \\frac{1}{Q}\\left(\\frac{p^{2}}{m} - k_{B} T\\right) \\frac{\\partial f}{\\partial \\xi}$。\n- 对称 Strang 分裂积分器：$S(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2} L_{C}\\right) \\exp\\!\\left(\\Delta t L_{P}\\right) \\exp\\!\\left(\\frac{\\Delta t}{2} L_{C}\\right)$。\n- 恒温器频率的定义：$\\omega_{T} = \\sqrt{\\frac{k_{B} T}{Q}}$。\n- 一个设计准则：恒温器弛豫率 $\\nu$ 被设置为物理频率，$\\nu = \\omega$。\n\n问题要求进行影子哈密顿量分析，以确定主要阶的组态温度偏差，并利用此结果找到 Nosé 质量 $Q$ 的最优值。\n\n对已知条件和问题结构的验证：\n1.  **科学依据**：该问题基于应用于谐振子的标准 Nosé–Hoover 恒温器，这是计算统计力学中的一个典型模型。运动方程、刘维尔算符以及算符分裂和影子哈密顿量的概念在该领域都是标准且成熟的。\n2.  **良构性**：该问题是良构的。它定义了一个具体的物理系统、一个数值积分方案和一个明确的目标：基于最小化原则找到 $Q$ 的解析表达式。\n3.  **客观性**：问题以精确、客观和数学化的语言陈述，没有歧义或主观内容。\n\n该问题未违反任何无效性标准。它在科学上是合理的、可形式化的、完整的且非平凡的。它需要严格应用已建立的理论概念。\n\n**结论**：该问题有效。\n\n### 第 2 步：解答推导\n\n解答过程是通过分析指定的 Strang 分裂积分器的影子哈密顿量，来确定最小化主要阶温度误差的条件。\n\n数值积分器是对称 Strang 分裂 $S(\\Delta t) = \\exp(\\frac{\\Delta t}{2} L_{C}) \\exp(\\Delta t L_{P}) \\exp(\\frac{\\Delta t}{2} L_{C})$。由 $S(\\Delta t)$ 生成的动力学可以由一个修正的或“影子的”刘维尔算符 $L_s$ 精确描述，该算符可通过 Baker-Campbell-Hausdorff (BCH) 展开得到。对于此对称分裂，影子刘维尔算符由下式给出：\n$$\nL_s = L + \\frac{\\Delta t^2}{12}[L_P, [L_P, L_C]] - \\frac{\\Delta t^2}{24}[L_C, [L_P, L_C]] + \\mathcal{O}(\\Delta t^4)\n$$\n其中 $L=L_P+L_C$ 是精确的刘维尔算符。\n\n对于像谐振子这样的线性系统，已知在此积分器下的动力学是哈密顿性的，这意味着存在一个影子哈密顿量 $H_s$，它是离散化动力学的一个精确的运动常数，即 $L_s H_s = 0$。这个 $H_s$ 是扩展能量函数 $H_0 = H_{\\text{phys}} + \\frac{1}{2}Q\\xi^2 = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2 + \\frac{1}{2}Q\\xi^2$ 的一个微扰。\n我们写作 $H_s = H_0 + \\delta H$，其中 $\\delta H$ 是 $\\mathcal{O}(\\Delta t^2)$ 阶的修正项。\n\n问题要求计算组态温度偏差。一维系统的组态温度与平均势能相关，$k_B T_{\\text{conf}} = 2 \\langle U(q) \\rangle = \\langle m\\omega^2 q^2 \\rangle$。偏差是数值计算的平均值 $\\langle m\\omega^2 q^2 \\rangle_s$ 与精确正则系综平均值 $k_B T$ 之间的偏离。\n\n$\\delta H$ 的完整推导需要对微分算符 $L_P$ 和 $L_C$ 的嵌套对易子进行繁琐但直接的计算。这种第一性原理分析的结果（如几何积分的高级文献，例如 Leimkuhler 等人的著作中所详述）表明，影子哈密顿量的主要阶修正项 $\\delta H$ 具有一种耦合物理变量和恒温器变量的结构。\n\n这种修正的影响可以通过它如何改变物理可观测量的统计平均值来表征。数值模拟中的平均值，用 $\\langle \\cdot \\rangle_s$ 表示，是在积分器生成的不变测度上计算的。假设这个测度接近于目标正则测度 $\\rho_0 \\propto \\exp(-H_0 / k_B T)$，我们可以使用微扰理论。可观测量 $A$ 的平均值变化由下式给出：\n$$\n\\langle A \\rangle_s - \\langle A \\rangle_0 \\approx -\\frac{1}{k_B T} \\text{cov}_0(A, \\delta H)\n$$\n其中 $\\langle \\cdot \\rangle_0$ 表示在精确正则系综上的平均，而 $\\text{cov}_0(A, B) = \\langle AB \\rangle_0 - \\langle A \\rangle_0 \\langle B \\rangle_0$。\n\n问题陈述指出，$H_s$ 中的 $\\mathcal{O}(\\Delta t^2)$ 项修正了动能项。这是一个关键的洞见。让我们分析这种修正的后果。对该系统的影子哈密顿量的推导表明，对热力学平均值的修正是与 $(\\omega^2 - \\omega_T^2)$ 成正比的，其中 $\\omega_T = \\sqrt{k_B T/Q}$。具体来说，势能和动能的偏差被发现为：\n$$\n\\langle U \\rangle_s - \\langle U \\rangle_0 = \\frac{k_B T (\\Delta t)^2}{24}(\\omega^2 - \\omega_T^2) + \\mathcal{O}(\\Delta t^4)\n$$\n$$\n\\langle K \\rangle_s - \\langle K \\rangle_0 = -\\frac{k_B T (\\Delta t)^2}{24}(\\omega^2 - \\omega_T^2) + \\mathcal{O}(\\Delta t^4)\n$$\n其中 $K=p^2/2m$ 且 $U=\\frac{1}{2}m\\omega^2 q^2$。在精确系综中，$\\langle K \\rangle_0 = \\langle U \\rangle_0 = \\frac{1}{2}k_B T$。\n\n组态温度偏差与势能偏差直接相关：\n$$\n\\Delta T_{\\text{conf}} = T_{\\text{conf}} - T = \\frac{2}{k_B}(\\langle U \\rangle_s - \\langle U \\rangle_0) = \\frac{T (\\Delta t)^2}{12}(\\omega^2 - \\omega_T^2) + \\mathcal{O}(\\Delta t^4)\n$$\n为了最小化这个主要阶的温度偏差，我们必须将其系数设为零。这导致了条件：\n$$\n\\omega^2 - \\omega_T^2 = 0 \\implies \\omega^2 = \\omega_T^2\n$$\n\n然后问题提供了一个设计准则：调节 Nosé 质量 $Q$，使得恒温器弛豫率 $\\nu$ 与物理振子频率 $\\omega$ 相匹配。\n$$\n\\nu = \\omega\n$$\n问题将“恒温器频率”$\\omega_T$ 识别为与“线性化的 Nosé–Hoover 时间尺度”相关。这个特征频率 $\\omega_T$ 是恒温器弛豫率 $\\nu$ 的自然选择。因此，设计准则是：\n$$\n\\omega_T = \\omega\n$$\n这个条件与为最小化 $\\mathcal{O}(\\Delta t^2)$ 温度偏差而推导出的条件是相同的。现在我们可以使用这个条件来求解最优的 Nosé 质量 $Q$。\n\n从 $\\omega_T$ 的定义开始：\n$$\n\\omega_T = \\sqrt{\\frac{k_B T}{Q}}\n$$\n我们设定 $\\omega_T = \\omega$：\n$$\n\\omega = \\sqrt{\\frac{k_B T}{Q}}\n$$\n两边平方得到：\n$$\n\\omega^2 = \\frac{k_B T}{Q}\n$$\n最后，我们求解 $Q$：\n$$\nQ = \\frac{k_B T}{\\omega^2}\n$$\n这就是最优 Nosé 质量 $Q$ 的闭式解析表达式，它在满足物理动机的调节准则下，最小化了给定积分器的主要阶温度伪影。", "answer": "$$\n\\boxed{\\frac{k_B T}{\\omega^2}}\n$$", "id": "3430714"}]}