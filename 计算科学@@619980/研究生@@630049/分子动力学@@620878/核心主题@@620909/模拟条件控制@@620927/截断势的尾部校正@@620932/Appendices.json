{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，这个练习将帮助我们掌握计算截断势能的尾部校正所需的核心数学技能。在这个问题中 [@problem_id:3450952]，我们将推导一个简化的吸引势（$u(r) = -C_6 r^{-6}$）的能量校正，并分析校正值如何随截断半径的变化而缩放。这个练习为我们理解更复杂的势和实际应用奠定了坚实的基础。", "problem": "考虑一个大的、均匀的、各向同性的单原子流体，其数密度为 $\\rho$，通过分子动力学（MD）进行模拟。对相互作用由一个球对称势 $u(r)$ 描述，该势在有限的截断半径 $r_c$ 处被截断，因此在模拟中忽略了 $r > r_c$ 的相互作用。由于截断而导致的每个粒子势能的缺失贡献通常通过一个尾部校正来估计，该校正假设对于 $r > r_c$，径向分布函数 $g(r) \\approx 1$。\n\n从第一性原理出发——即，用 $u(r)$ 和 $g(r)$ 表示的均匀流体中每个粒子势能的一般表达式——在标准假设 $g(r) \\approx 1$（对于 $r > r_c$）下，当 $u(r) = -C_6 r^{-6}$ 且 $C_6 > 0$ 时，推导每个粒子势能的截断误差的主导项。将你的结果表示为 $\\rho$、$C_6$ 和 $r_c$ 的解析函数。\n\n然后，分析如果截断半径从 $r_c$ 增加一倍到 $2 r_c$，这个截断误差会如何变化。计算当 $r_c$ 增加一倍时，截断误差的量值变化的乘法因子。将此因子表示为一个纯数。不需要四舍五入，最终答案中不应包含单位。", "solution": "该问题被验证为具有科学依据、提法恰当、客观且完整。它代表了统计力学中与分子模拟相关的一个标准计算。我现在开始推导。\n\n在一个数密度为 $\\rho$ 的大的、均匀的、各向同性的流体中，每个粒子的势能（我们表示为 $\\langle U \\rangle$）可以表示为对势 $u(r)$ 和径向分布函数 $g(r)$ 的积分。径向分布函数 $g(r)$ 给出在距离一个参考粒子 $r$ 处找到另一个粒子的概率，此概率是相对于理想气体的概率。每个粒子势能的表达式为：\n$$ \\langle U \\rangle = \\frac{1}{2} \\rho \\int_{0}^{\\infty} u(r) g(r) 4 \\pi r^2 dr $$\n因子 $\\frac{1}{2}$ 是为了校正对相互作用的双重计算。\n\n在分子动力学模拟中，为了降低计算成本，势通常在截断半径 $r_c$ 处被截断。在模拟中计算的势能 $\\langle U \\rangle_{\\text{sim}}$ 只包括此半径内的相互作用：\n$$ \\langle U \\rangle_{\\text{sim}} = 2 \\pi \\rho \\int_{0}^{r_c} u(r) g(r) r^2 dr $$\n截断误差（或尾部校正）是被忽略的距离 $r > r_c$ 的相互作用对能量的贡献。我们将此误差表示为 $\\Delta U_{\\text{tail}}$：\n$$ \\Delta U_{\\text{tail}} = \\langle U \\rangle - \\langle U \\rangle_{\\text{sim}} = 2 \\pi \\rho \\int_{r_c}^{\\infty} u(r) g(r) r^2 dr $$\n问题为计算此积分提供了两个关键信息：\n1. 对势是长程吸引范德华相互作用，$u(r) = -C_6 r^{-6}$，其中 $C_6$ 是一个正常数。\n2. 对于超出截断半径的距离 $r > r_c$，假设流体是无结构的，意味着径向分布函数近似为1：$g(r) \\approx 1$。\n\n将这些代入截断误差的表达式中，得到：\n$$ \\Delta U_{\\text{tail}} \\approx 2 \\pi \\rho \\int_{r_c}^{\\infty} (-C_6 r^{-6}) (1) r^2 dr $$\n我们可以将常数从积分中提出：\n$$ \\Delta U_{\\text{tail}} = -2 \\pi \\rho C_6 \\int_{r_c}^{\\infty} r^{-4} dr $$\n现在，我们计算这个定积分：\n$$ \\int_{r_c}^{\\infty} r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\left[ -\\frac{1}{3r^3} \\right]_{r_c}^{\\infty} $$\n在积分上下限处计算该表达式：\n$$ \\left( \\lim_{r \\to \\infty} -\\frac{1}{3r^3} \\right) - \\left( -\\frac{1}{3r_c^3} \\right) = 0 - \\left( -\\frac{1}{3r_c^3} \\right) = \\frac{1}{3r_c^3} $$\n将此结果代回到 $\\Delta U_{\\text{tail}}$ 的表达式中，我们得到每个粒子势能中截断误差主导项的解析函数：\n$$ \\Delta U_{\\text{tail}}(r_c) = -2 \\pi \\rho C_6 \\left( \\frac{1}{3r_c^3} \\right) = -\\frac{2 \\pi \\rho C_6}{3 r_c^3} $$\n由于 $\\rho$、$C_6$ 和 $r_c$ 均为正值，这个校正是负的，正如对吸引势所预期的那样。\n\n接下来，我们分析如果截断半径从 $r_c$ 增加一倍到 $2 r_c$，这个截断误差会如何变化。设新的截断半径为 $r_c' = 2 r_c$。新的截断误差 $\\Delta U_{\\text{tail}}(r_c')$ 可以通过在我们推导的表达式中用 $2 r_c$ 替换 $r_c$ 来找到：\n$$ \\Delta U_{\\text{tail}}(2r_c) = -\\frac{2 \\pi \\rho C_6}{3 (2r_c)^3} $$\n化简分母：\n$$ \\Delta U_{\\text{tail}}(2r_c) = -\\frac{2 \\pi \\rho C_6}{3 (8 r_c^3)} = \\frac{1}{8} \\left( -\\frac{2 \\pi \\rho C_6}{3 r_c^3} \\right) $$\n经观察，括号中的项是原始的截断误差 $\\Delta U_{\\text{tail}}(r_c)$。因此：\n$$ \\Delta U_{\\text{tail}}(2r_c) = \\frac{1}{8} \\Delta U_{\\text{tail}}(r_c) $$\n问题要求的是截断误差量值变化的乘法因子。原始误差的量值为 $|\\Delta U_{\\text{tail}}(r_c)|$。新误差的量值为 $|\\Delta U_{\\text{tail}}(2r_c)|$。\n$$ |\\Delta U_{\\text{tail}}(2r_c)| = \\left| \\frac{1}{8} \\Delta U_{\\text{tail}}(r_c) \\right| = \\frac{1}{8} |\\Delta U_{\\text{tail}}(r_c)| $$\n因此，当截断半径增加一倍时，截断误差的量值减小为原来的 $\\frac{1}{8}$。", "answer": "$$\\boxed{\\frac{1}{8}}$$", "id": "3450952"}, {"introduction": "在掌握了基本方法之后，我们可以将其应用于更完整和现实的场景。这个练习 [@problem_id:3451011] 要求我们为完整的 Lennard-Jones 势推导能量和压力的尾部校正。通过同时处理吸引项和排斥项，并引入压力校正的计算，我们可以更全面地理解在分子动力学模拟中如何补偿长程相互作用。", "problem": "考虑一个通过分子动力学（MD）研究的宏观均匀且各向同性的单原子流体，其相互作用由对加性Lennard-Jones势 $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$ 描述。在有限范围的模拟中，势能在截断距离 $r_c>0$ 处被截断，这忽略了分离距离 $r\\ge r_c$ 时的贡献。尾部校正通过在标准近似（即径向分布函数（RDF）$g(r)$ 在 $r\\ge r_c$ 时满足 $g(r)\\approx 1$）下对 $r_c$ 以外的完整势进行积分，来恢复缺失的贡献。\n\n仅从以下经过充分检验的、适用于具有对相互作用的均匀流体的表达式出发：\n- 单位粒子的位形势能，$U/N=2\\pi\\rho\\int_{0}^{\\infty}r^2u(r)g(r)\\,dr$，以及\n- 压力的维里状态方程，$P=\\rho k_B T-\\frac{2\\pi}{3}\\rho^2\\int_{0}^{\\infty}r^3 u'(r)g(r)\\,dr$，\n\n其中 $u'(r)=\\frac{du}{dr}$，推导因在 $r_c$ 处截断Lennard-Jones势而产生的单位粒子能量和压力的尾部校正。具体来说，求出以下各项的闭式解析表达式：\n- 单位粒子的能量尾部校正 $U_{\\text{tail}}/N=2\\pi\\rho\\int_{r_c}^{\\infty}r^2u(r)\\,dr$，以及\n- 压力尾部校正 $P_{\\text{tail}}=-\\frac{2\\pi}{3}\\rho^2\\int_{r_c}^{\\infty}r^3u'(r)\\,dr$。\n\n用 $\\epsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 符号化地执行所有步骤。然后，在 $r_c\\gg\\sigma$ 的极限下，分析 $U_{\\text{tail}}/N$ 和 $P_{\\text{tail}}$ 随数密度 $\\rho$ 和截断距离 $r_c$ 的标度关系，确定对 $r_c$ 的主阶依赖关系以及每项校正的符号。将两个尾部校正表达式的最终答案用 $\\epsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 符号化地表示。不要代入数值，也不要在最终表达式中包含单位。", "solution": "用户要求推导Lennard-Jones流体分子动力学模拟中势能和压力的尾部校正，并分析其标度性质。\n\n首先，对问题陈述进行验证。\n**步骤1：提取已知条件**\n- **系统**：宏观均匀且各向同性的单原子流体。\n- **势**：对加性Lennard-Jones势，$u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^6\\right]$。\n- **模拟条件**：势能在截断距离 $r_c > 0$ 处被截断。\n- **近似**：对于分子间分离距离 $r \\ge r_c$，径向分布函数 $g(r) \\approx 1$。\n- **单位粒子位形能量表达式**：$\\frac{U}{N}=2\\pi\\rho\\int_{0}^{\\infty}r^2u(r)g(r)\\,dr$。\n- **压力表达式**：$P=\\rho k_B T-\\frac{2\\pi}{3}\\rho^2\\int_{0}^{\\infty}r^3 u'(r)g(r)\\,dr$，其中 $u'(r)=\\frac{du}{dr}$。\n- **能量尾部校正定义**：$\\frac{U_{\\text{tail}}}{N}=2\\pi\\rho\\int_{r_c}^{\\infty}r^2u(r)\\,dr$。\n- **压力尾部校正定义**：$P_{\\text{tail}}=-\\frac{2\\pi}{3}\\rho^2\\int_{r_c}^{\\infty}r^3u'(r)\\,dr$。\n- **要求任务**：\n    1. 推导 $\\frac{U_{\\text{tail}}}{N}$ 和 $P_{\\text{tail}}$ 的闭式解析表达式。\n    2. 在 $r_c \\gg \\sigma$ 的极限下，分析这些校正随数密度 $\\rho$ 和截断距离 $r_c$ 的标度关系。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，建立在统计力学和分子模拟的标准框架内。Lennard-Jones势、能量和压力的表达式，以及对于大 $r$ 值时 $g(r) \\approx 1$ 的近似，都是该领域的标准要素。该问题是适定的，提供了执行所要求的推导所需的所有必要信息，这些推导涉及对良态函数的定积分求值。术语精确且标准。该问题是一个基础性的、非平凡的计算，考验核心知识。未发现与科学合理性、完整性、一致性或清晰度相关的缺陷。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n**尾部校正的推导**\n\n任务是计算当对势在 $r_c$ 处截断时被忽略的位形能量和压力的长程校正。这些校正的计算方法是，假设在截断距离之外粒子呈均匀分布（$g(r)=1$），将势及其相关的维里项从 $r_c$ 积分到无穷大。\n\n**1. 单位粒子的能量尾部校正 ($U_{\\text{tail}}/N$)**\n\n单位粒子的能量尾部校正表达式为：\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty}r^2 u(r) \\,dr\n$$\nLennard-Jones势为 $u(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$。将其代入积分：\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty} r^2 \\left( 4\\epsilon\\left[ \\sigma^{12}r^{-12} - \\sigma^6r^{-6} \\right] \\right) \\,dr\n$$\n将常数因子提出：\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr\n$$\n我们现在逐项进行积分：\n$$\n\\int \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^6\\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\n\\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(-\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\\right) - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\n当 $r \\to \\infty$ 时，极限为 $0$。因此，积分的计算结果为：\n$$\n0 - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\n$$\n将此结果代回能量校正的表达式中：\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n提出公因子，得到最终表达式：\n$$\n\\frac{U_{\\text{tail}}}{N} = \\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)\n$$\n\n**2. 压力尾部校正 ($P_{\\text{tail}}$)**\n\n压力尾部校正的表达式为：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 u'(r) \\,dr\n$$\n首先，我们必须求出Lennard-Jones势的导数，$u'(r) = \\frac{du}{dr}$：\n$$\nu(r) = 4\\epsilon\\left(\\sigma^{12}r^{-12} - \\sigma^6r^{-6}\\right)\n$$\n$$\nu'(r) = \\frac{d}{dr}\\left[4\\epsilon\\left(\\sigma^{12}r^{-12} - \\sigma^6r^{-6}\\right)\\right] = 4\\epsilon\\left(\\sigma^{12}(-12)r^{-13} - \\sigma^6(-6)r^{-7}\\right)\n$$\n$$\nu'(r) = 4\\epsilon\\left(-12\\sigma^{12}r^{-13} + 6\\sigma^6r^{-7}\\right) = 24\\epsilon\\left(-\\frac{2\\sigma^{12}}{r^{13}} + \\frac{\\sigma^6}{r^7}\\right)\n$$\n现在，将 $u'(r)$ 代入 $P_{\\text{tail}}$ 的积分中：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 \\left(24\\epsilon\\left(-2\\sigma^{12}r^{-13} + \\sigma^6r^{-7}\\right)\\right) \\,dr\n$$\n将常数因子提出：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 (24\\epsilon) \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -16\\pi\\rho^2\\epsilon \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr\n$$\n我们进行积分：\n$$\n\\int \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -2\\sigma^{12}\\frac{r^{-9}}{-9} + \\sigma^6\\frac{r^{-3}}{-3} = \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\n\\left[ \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(\\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\\right) - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\n当 $r \\to \\infty$ 时，极限为 $0$。积分的计算结果为：\n$$\n0 - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9}\n$$\n将此结果代回压力校正的表达式中：\n$$\nP_{\\text{tail}} = -16\\pi\\rho^2\\epsilon \\left( \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9} \\right) = 16\\pi\\rho^2\\epsilon \\left( \\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n提出公因子，得到最终表达式：\n$$\nP_{\\text{tail}} = \\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)\n$$\n\n**3. 在 $r_c \\gg \\sigma$ 极限下的标度分析**\n\n对于大的截断距离，比值 $\\frac{\\sigma}{r_c}$ 很小。我们分析校正项的主阶行为。\n\n**能量校正的标度关系：**\n表达式为 $\\frac{U_{\\text{tail}}}{N} = \\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)$。\n- **对 $\\rho$ 的依赖性**：单位粒子的能量校正与数密度成正比，$\\frac{U_{\\text{tail}}}{N} \\propto \\rho$。\n- **对 $r_c$ 的依赖性**：在 $r_c \\gg \\sigma$ 的极限下，$\\left(\\frac{\\sigma}{r_c}\\right)^6 \\to 0$。括号中的表达式趋近于 $-1$。因此，主阶依赖关系为：\n$$\n\\frac{U_{\\text{tail}}}{N} \\approx -\\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3}\n$$\n能量校正与 $r_c^{-3}$ 成标度关系。\n- **符号**：由于 $\\left(\\frac{\\sigma}{r_c}\\right)^6 \\ll 1$，项 $\\left(\\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1\\right)$ 是负的。所有其他量（$\\rho, \\epsilon, \\sigma, r_c$）都是正的。因此，能量校正 $\\frac{U_{\\text{tail}}}{N}$ 是**负的**。这在物理上是正确的，因为截断势能忽略了长程吸引尾部，这会人为地增加系统的势能。该校正降低了能量。\n\n**压力校正的标度关系：**\n表达式为 $P_{\\text{tail}} = \\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)$。\n- **对 $\\rho$ 的依赖性**：压力校正与数密度的平方成正比，$P_{\\text{tail}} \\propto \\rho^2$。\n- **对 $r_c$ 的依赖性**：在 $r_c \\gg \\sigma$ 的极限下，项 $\\left(\\frac{\\sigma}{r_c}\\right)^6 \\to 0$。括号中的表达式趋近于 $-1$。主阶依赖关系为：\n$$\nP_{\\text{tail}} \\approx -\\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3}\n$$\n压力校正与 $r_c^{-3}$ 成标度关系。\n- **符号**：由于 $\\left(\\frac{\\sigma}{r_c}\\right)^6 \\ll 1$，项 $\\left(\\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right)$ 是负的。所有其他量（$\\rho, \\epsilon, \\sigma, r_c$）都是正的。因此，压力校正 $P_{\\text{tail}}$ 是**负的**。这在物理上是正确的：截断势能忽略了长程吸引力，这种吸引力起到内聚作用，会降低系统的总压力。因此，截断模拟会高估压力，需要一个负的校正项来补偿。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right) \\\\ \\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^6 - 1 \\right) \\end{pmatrix} } $$", "id": "3451011"}, {"introduction": "理论推导依赖于一个关键的近似，即在截断半径之外径向分布函数 $g(r) \\approx 1$。最后的这个动手实践 [@problem_id:3450980] 将理论与计算实践相结合，旨在检验这一近似的有效性。我们将首先推导能量密度的标度关系，然后设计一个计算基准测试，通过引入一个非理想的 $g(r)$ 来量化理论预测与“真实”数值结果之间的偏差。", "problem": "考虑一个数密度为 $\\rho$ 的均匀、各向同性流体，其粒子间通过球对称、对加性势能 $u(r)$ 相互作用，该势能在大距离 $r$ 处衰减为 $u(r)\\sim -C_6 r^{-6}$。在分子动力学 (MD) 中，通常为了降低计算成本，在有限的截断半径 $r_c$ 处截断势能 $u(r)$。截断操作忽略了距离 $r>r_c$ 的粒子对的贡献，这会产生缺失的势能。对于均匀流体，单位体积势能可以通过对分布函数 $g(r)$ 对距离进行积分来表示。当应用截断时，缺失的能量密度由 $r\\ge r_c$ 上的积分捕获。\n\n从均匀各向同性流体势能的基本定义以及与径向分布函数 (RDF) $g(r)$ 的关系出发，在 $r>r_c$ 时使用近似 $g(r)=1$ 并且在大距离 $r$ 处使用 $u(r)\\sim -C_6 r^{-6}$ 的条件下，推导缺失的单位体积势能对截断半径 $r_c$ 的领头阶依赖关系。您的推导必须从均匀流体的位形能量密度关于 $g(r)$ 和 $u(r)$ 的标准表达式开始，并通过数学上合理的步骤进行，不得引用任何预先推导的尾部校正公式。\n\n然后，设计并实现一个计算基准测试，该测试在一组 $r_c$ 值上进行变化，并量化当 $g(r)\\neq 1$ 时与所推导的标度关系的偏差。通过为 $r\\ge r_c$ 设定 $g(r)=1+h(r)$ 来模拟截断半径以外的偏差，其中 $h(r)$ 是一个受控的、衰减的振荡函数：\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big),\\quad r\\ge r_c,\n$$\n其中振幅为 $A$，相关长度为 $\\xi$，波数为 $k$。此 $h(r)$ 严格用于 $r\\ge r_c$ 的情况，而对于 $r < r_c$ 的情况则为零。", "solution": "此问题要求分两部分作答：首先，形式上推导在截断对势中势能的领头阶尾部校正；其次，设计并实现一个计算基准测试，用以量化存在结构相关性时与此领头阶理论的偏差。\n\n### 第一部分：领头阶尾部校正的推导\n\n在体积 $V$ 中含有 $N$ 个粒子的均匀、各向同性流体的位形势能 $U$ 可以用对相互作用势 $u(r)$ 和径向分布函数 $g(r)$ 来表示。距离一个中心粒子 $r$ 处、厚度为 $dr$ 的球壳中的粒子数为 $\\rho g(r) 4\\pi r^2 dr$，其中 $\\rho = N/V$ 是数密度。这些粒子对中的每一对都对势能贡献 $u(r)$。将所有粒子对的贡献相加，并除以 2 以校正重复计数，总势能由下式给出：\n$$\nU = \\frac{1}{2} N \\int_0^\\infty u(r) \\rho g(r) 4\\pi r^2 dr\n$$\n单位体积势能，即能量密度，可通过除以体积 $V$ 得到：\n$$\n\\frac{U}{V} = \\frac{1}{2} \\frac{N}{V} \\rho \\int_0^\\infty u(r) g(r) 4\\pi r^2 dr = 2\\pi\\rho^2 \\int_0^\\infty u(r) g(r) r^2 dr\n$$\n在分子模拟中，势能通常在截断距离 $r_c$ 处被截断。这意味着分离距离 $r > r_c$ 的粒子对对能量的贡献被忽略了。我们记这个缺失的势能密度为 $\\Delta U/V$，它由从 $r_c$ 到无穷大的积分给出：\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) g(r) r^2 dr\n$$\n为了推导对 $r_c$ 的领头阶依赖关系，我们引入两个对大分离距离 $r$ 有效的标准近似，这个范围包括了积分域 $r \\ge r_c$（假设 $r_c$ 足够大）：\n1. 相互作用势的衰减形式为色散相互作用的领头项：$u(r) \\approx -C_6 r^{-6}$。\n2. 在大分离距离下，粒子间的相关性消失，因此径向分布函数趋近于 1：$g(r) \\approx 1$。\n\n将这些近似代入缺失能量密度的表达式中，可得：\n$$\n\\frac{\\Delta U}{V} \\approx 2\\pi\\rho^2 \\int_{r_c}^\\infty (-C_6 r^{-6}) (1) r^2 dr\n$$\n我们可以将常数项提取出来，并计算这个基本积分：\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr\n$$\n该积分为：\n$$\n\\int_{r_c}^\\infty r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\lim_{b \\to \\infty} \\left( -\\frac{1}{3b^3} \\right) - \\left( -\\frac{1}{3r_c^3} \\right) = 0 + \\frac{1}{3r_c^3} = \\frac{1}{3}r_c^{-3}\n$$\n将此结果代回，我们得到领头阶尾部校正的最终表达式：\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\left( \\frac{1}{3}r_c^{-3} \\right) = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3}\n$$\n此推导确定了对于大的 $r_c$，缺失的能量密度与 $r_c^{-3}$ 成标度关系。问题要求考虑关系式 $\\Delta U/V \\approx s\\, r_c^{-3}$。通过比较，我们确定理论比例常数（斜率）为：\n$$\ns_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6\n$$\n\n### 第二部分：结构相关效应的计算分析\n\n上述推导依赖于 $r > r_c$ 时 $g(r)=1$ 的近似。实际上，结构相关性依然存在，这意味着 $g(r)$ 可能偏离 1。题目给出了一个描述这种偏差的模型：\n$$\ng(r) = 1 + h(r), \\quad \\text{for } r \\ge r_c\n$$\n其中\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big)\n$$\n那么，实际的缺失能量密度为：\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) (1+h(r)) r^2 dr\n$$\n使用 $u(r) = -C_6 r^{-6}$，我们可以将积分分成两部分：\n$$\n\\frac{\\Delta U}{V} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr - 2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4}h(r) dr\n$$\n第一项是领头阶贡献，我们已经解析地计算过它：\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{g=1} = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3} = s_{\\text{th}} r_c^{-3}\n$$\n第二项是由结构相关性引起的校正，我们将其记为 $(\\Delta U/V)_h$：\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{h} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big) dr\n$$\n该积分没有简单的闭式解，必须进行数值计算。对于给定的 $r_c$，总的缺失能量密度是这两项之和。\n\n对每个测试用例，计算算法按以下步骤进行：\n1.  计算理论斜率 $s_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6$。\n2.  对所提供集合中的每个截断半径 $r_{c,i}$，计算总的缺失能量密度 $y_i = \\Delta U/V(r_{c,i})$。\n    - 领头项为 $I_{1,i} = s_{\\text{th}} r_{c,i}^{-3}$。\n    - 校正项 $I_{2,i} = (\\Delta U/V)_h$ 是通过从 $r_{c,i}$ 到 $\\infty$ 对其定义表达式进行数值积分来计算的。被积函数呈指数衰减，性质良好，使得数值求积既高效又准确。\n    - 总能量为 $y_i = I_{1,i} + I_{2,i}$。\n3.  现在我们有了一组数据点 $(x_i, y_i)$，其中 $x_i = r_{c,i}^{-3}$。我们希望将这些数据拟合到模型 $y = s_{\\text{fit}} x$。对于过原点的线性回归，斜率 $s_{\\text{fit}}$ 的最小二乘估计由下式给出：\n    $$\n    s_{\\text{fit}} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2}\n    $$\n4.  最后，计算拟合斜率与理论斜率之间的绝对相对偏差。这个值量化了在一系列截断值范围内拟合 $r_c^{-3}$ 标度关系时，由 $g(r)=1$ 近似引入的系统误差。\n    $$\n    \\text{Deviation} = \\frac{|s_{\\text{fit}} - s_{\\text{th}}|}{|s_{\\text{th}}|}\n    $$\n所提供的 Python 代码实现了该算法，以确定四个测试用例中每个用例的偏差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the deviation from theoretical scaling for tail corrections\n    in truncated potentials due to structural correlations.\n    \"\"\"\n    # Test cases: (rho, C6, A, xi, k, list_of_rc)\n    test_cases = [\n        (0.85, 1.0, 0.0, 1.0, 1.0, [1.2, 1.5, 2.0, 3.0]),\n        (0.85, 1.0, 0.1, 1.2, 4.0, [1.2, 1.5, 2.0, 3.0]),\n        (1.2, 0.75, 0.25, 0.8, 3.0, [1.0, 1.3, 1.8, 2.5]),\n        (0.30, 2.0, 0.05, 2.5, 1.0, [5.0, 7.0, 10.0, 15.0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, C6, A, xi, k, rcs = case\n\n        # 1. Calculate the theoretical slope s_th based on the g(r)=1 approximation.\n        # s_th corresponds to the proportionality constant in Delta_U/V = s * r_c^(-3).\n        s_th = -(2.0 / 3.0) * np.pi * rho**2 * C6\n\n        # Lists to store values for the least squares fit\n        y_values = []  # Total missing energy density, Delta_U/V\n        x_values = []  # r_c^(-3)\n\n        for rc in rcs:\n            # The independent variable for the fit is x = r_c^(-3)\n            x = np.power(rc, -3.0)\n            x_values.append(x)\n\n            # 2. Calculate the total missing energy density y = Delta_U/V(rc).\n            # This is split into a leading term (I1) and a corrective term (I2).\n\n            # The leading term (I1) is the analytical result assuming g(r)=1.\n            I1 = s_th * x\n\n            # The corrective term (I2) arises from the deviation h(r) = g(r) - 1.\n            # It is computed via numerical integration.\n            I2 = 0.0\n            if A != 0.0:\n                # Integrand for the corrective term (excluding constant prefactors).\n                # h(r) = A * exp(-(r-rc)/xi) * cos(k*(r-rc))\n                # Full integrand is r^(-4) * h(r)\n                integrand = lambda r: np.power(r, -4.0) * A * np.exp(-(r - rc) / xi) * np.cos(k * (r - rc))\n                \n                # Perform numerical integration from rc to infinity.\n                integral_val, _ = quad(integrand, rc, np.inf)\n                \n                # Multiply by the constant prefactor.\n                prefactor = -2.0 * np.pi * rho**2 * C6\n                I2 = prefactor * integral_val\n            \n            # The total missing energy density is the sum of the two terms.\n            y = I1 + I2\n            y_values.append(y)\n\n        # 3. Perform a least squares fit with zero intercept for y = s_fit * x.\n        x_arr = np.array(x_values)\n        y_arr = np.array(y_values)\n        \n        # The formula for the slope (s_fit) is dot(x,y) / dot(x,x).\n        s_fit = np.dot(x_arr, y_arr) / np.dot(x_arr, x_arr)\n        \n        # 4. Calculate the absolute relative deviation.\n        if s_th == 0:\n            # This case is not expected with the given test data, but is good practice.\n            # If s_th is 0, the deviation is infinite if s_fit is not 0.\n            deviation = np.inf if s_fit != 0 else 0.0\n        else:\n            deviation = np.abs(s_fit - s_th) / np.abs(s_th)\n        \n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3450980"}]}