{"hands_on_practices": [{"introduction": "这项练习是一项基础性的理论实践。它回顾了电介质界面附近单个电荷的经典静电学问题 [@problem_id:3444065]。通过从第一性原理出发推导自能，我们能够具体地理解界面极化如何引起相互作用能，而这正是非均匀系统模拟中许多人为效应的根源。", "problem": "考虑一个分子动力学（MD）模拟，其中一个单点电荷 $q$ 嵌入在一个占据 $z>0$ 的线性的、均匀的、各向同性的介电半空间中，其绝对电容率为 $\\epsilon_1$。占据 $z0$ 的半空间是另一个线性的、均匀的、各向同性的介电质，其绝对电容率为 $\\epsilon_2$。平面界面位于 $z=0$，没有自由的界面电荷，且系统是静态的。该点电荷位于位置 $\\mathbf{r}_0=(0,0,d)$，其中 $d>0$。\n\n您的目标是，从静电学的第一性原理出发，并且不使用快捷公式，推导由于界面极化而产生的点电荷的静电自能（即，与 $q$ 和其感应的表面极化电荷相互作用相关的能量）。使用与静电学中麦克斯韦方程所蕴含的边界条件相一致的镜像法。从定义 $\\nabla \\times \\mathbf{E}=\\mathbf{0}$、$\\nabla \\cdot \\mathbf{D}=\\rho_{\\mathrm{free}}$ 和 $\\mathbf{D}=\\epsilon \\mathbf{E}$，以及标量势 $\\phi$（满足 $\\mathbf{E}=-\\nabla \\phi$）开始。假设每种介质的电容率恒定，且界面是平坦且无限的。在 $z=0$ 处强制 $\\mathbf{E}$ 的切向分量连续和 $\\mathbf{D}$ 的法向分量连续（自由表面电荷密度为零）。\n\n将自能 $U_{\\mathrm{self}}$ 定义为电荷 $q$ 与仅由界面极化响应产生的、位于该电荷位置的感应电势（即，不包括直接的库仑自电势）乘积的一半。使用与边界条件一致的镜像电荷构造，推导出 $U_{\\mathrm{self}}$ 关于 $q$、$d$、$\\epsilon_1$ 和 $\\epsilon_2$ 的显式解析表达式。\n\n最后，讨论极限情况 $\\epsilon_2 \\to \\infty$ 和 $\\epsilon_2 \\to \\epsilon_1$，并解释在每种极限下 $U_{\\mathrm{self}}$ 的物理符号和大小趋势。最终能量以焦耳（SI 单位）表示。最终答案必须是 $U_{\\mathrm{self}}$ 作为 $q$、$d$、$\\epsilon_1$ 和 $\\epsilon_2$ 的函数的单个闭式解析表达式。", "solution": "该问题要求推导位于两个介电介质平面界面附近的单个点电荷 $q$ 的静电自能。电荷位于 $\\mathbf{r}_0 = (0,0,d)$，处于占据 $z>0$ 半空间、电容率为 $\\epsilon_1$ 的介质中。另一个电容率为 $\\epsilon_2$ 的介质占据 $z0$ 的半空间。自能被定义为抵抗来自界面感应极化电荷的静电力所做的功。\n\n这是一个静电学中的经典边值问题，可以使用镜像法求解。其基础方程是静电学的麦克斯韦方程。由于电场 $\\mathbf{E}$ 是静态的，其旋度为零，$\\nabla \\times \\mathbf{E} = \\mathbf{0}$，这允许我们定义一个标量势 $\\phi$ 使得 $\\mathbf{E} = -\\nabla \\phi$。$\\phi$ 的控制方程是高斯定律，$\\nabla \\cdot \\mathbf{D} = \\rho_{\\mathrm{free}}$，其中 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 是电位移场，$\\rho_{\\mathrm{free}}$ 是自由电荷密度。结合这些，我们得到每个区域的泊松方程：\n对于 $z>0$，$\\nabla^2 \\phi_1 = -\\frac{\\rho_{\\mathrm{free}}}{\\epsilon_1}$\n对于 $z0$，$\\nabla^2 \\phi_2 = -\\frac{\\rho_{\\mathrm{free}}}{\\epsilon_2}$\n\n在我们的情况中，唯一的自由电荷是位于 $\\mathbf{r}_0 = (0,0,d)$ 的点电荷 $q$，因此 $\\rho_{\\mathrm{free}} = q\\delta(x)\\delta(y)\\delta(z-d)$。因此，对于 $z>0$，$\\nabla^2 \\phi_1 = -\\frac{q}{\\epsilon_1}\\delta(x)\\delta(y)\\delta(z-d)$，而对于没有自由电荷的 $z0$ 区域，$\\nabla^2 \\phi_2 = 0$（拉普拉斯方程）。\n\n在 $z=0$ 的界面处，没有自由表面电荷，其边界条件为：\n$1$. $\\mathbf{E}$ 的切向分量连续：$\\mathbf{E}_{1,t} = \\mathbf{E}_{2,t}$。这意味着标量势的连续性：$\\phi_1(x,y,0) = \\phi_2(x,y,0)$。\n$2$. $\\mathbf{D}$ 的法向分量连续：$D_{1,n} = D_{2,n}$。由于 $\\mathbf{D} = \\epsilon \\mathbf{E} = -\\epsilon\\nabla\\phi$，且法向为 $\\hat{\\mathbf{z}}$，该条件为 $\\epsilon_1 \\frac{\\partial \\phi_1}{\\partial z} \\Big|_{z=0} = \\epsilon_2 \\frac{\\partial \\phi_2}{\\partial z} \\Big|_{z=0}$。\n\n镜像法通过用一组放置在感兴趣区域之外的虚拟点电荷（镜像电荷）来替代复杂的感应表面电荷分布，从而提出一种解法。\n\n对于区域 1 ($z>0$)：势 $\\phi_1$ 被构造为位于 $(0,0,d)$ 的真实电荷 $q$ 和位于介质 2 中 $(0,0,-d)$ 的镜像电荷 $q'$ 所产生的电势之和。位于 $z=-d$ 的镜像电荷的存在并不违反 $z>0$ 区域的泊松方程，因为它在该区域之外。使用柱坐标 $(\\rho, \\varphi, z)$，其中 $\\rho = \\sqrt{x^2+y^2}$，电势为：\n$$ \\phi_1(\\rho,z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + (z-d)^2}} + \\frac{q'}{\\sqrt{\\rho^2 + (z+d)^2}} \\right) $$\n\n对于区域 2 ($z0$)：势 $\\phi_2$ 被构造为好像它是由位于真实电荷位置 $(0,0,d)$ 的单个有效电荷 $q''$ 产生的。该源在区域 2 之外，因此对于 $z0$，拉普拉斯方程 $\\nabla^2 \\phi_2 = 0$ 得到满足。注意，该介质中的电势由 $1/\\epsilon_2$ 缩放。\n$$ \\phi_2(\\rho,z) = \\frac{1}{4\\pi\\epsilon_2} \\left( \\frac{q''}{\\sqrt{\\rho^2 + (z-d)^2}} \\right) $$\n\n现在，我们在 $z=0$ 处应用边界条件来确定未知的镜像电荷 $q'$ 和 $q''$。\n\n根据电势的连续性，$\\phi_1(\\rho,0) = \\phi_2(\\rho,0)$:\n$$ \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + d^2}} + \\frac{q'}{\\sqrt{\\rho^2 + d^2}} \\right) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{\\rho^2 + d^2}} $$\n这简化为我们的第一个方程：\n$$ \\frac{1}{\\epsilon_1} (q + q') = \\frac{1}{\\epsilon_2} q'' \\quad (1) $$\n\n根据 $\\mathbf{D}$ 的法向分量的连续性，我们首先计算关于 $z$ 的偏导数：\n$$ \\frac{\\partial \\phi_1}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q \\frac{-(z-d)}{(\\rho^2 + (z-d)^2)^{3/2}} + q' \\frac{-(z+d)}{(\\rho^2 + (z+d)^2)^{3/2}} \\right] $$\n在 $z=0$ 处：\n$$ \\frac{\\partial \\phi_1}{\\partial z} \\Big|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\frac{qd - q'd}{(\\rho^2 + d^2)^{3/2}} $$\n对于 $\\phi_2$：\n$$ \\frac{\\partial \\phi_2}{\\partial z} = \\frac{1}{4\\pi\\epsilon_2} \\left[ q'' \\frac{-(z-d)}{(\\rho^2 + (z-d)^2)^{3/2}} \\right] $$\n在 $z=0$ 处：\n$$ \\frac{\\partial \\phi_2}{\\partial z} \\Big|_{z=0} = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''d}{(\\rho^2 + d^2)^{3/2}} $$\n应用边界条件 $\\epsilon_1 \\frac{\\partial \\phi_1}{\\partial z}|_{z=0} = \\epsilon_2 \\frac{\\partial \\phi_2}{\\partial z}|_{z=0}$：\n$$ \\epsilon_1 \\left( \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2+d^2)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{d q''}{4\\pi\\epsilon_2(\\rho^2+d^2)^{3/2}} \\right) $$\n这简化为我们的第二个方程：\n$$ q - q' = q'' \\quad (2) $$\n\n我们现在求解线性方程组 $(1)$ 和 $(2)$ 来得到 $q'$ 和 $q''$。将 $(2)$ 代入 $(1)$：\n$$ \\frac{1}{\\epsilon_1}(q + q') = \\frac{1}{\\epsilon_2}(q - q') $$\n$$ \\epsilon_2(q + q') = \\epsilon_1(q - q') $$\n$$ \\epsilon_2 q + \\epsilon_2 q' = \\epsilon_1 q - \\epsilon_1 q' $$\n$$ q'(\\epsilon_1 + \\epsilon_2) = q(\\epsilon_1 - \\epsilon_2) $$\n$$ q' = q \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) $$\n\n问题要求自能 $U_{\\mathrm{self}}$，其定义为电荷 $q$ 与其所在位置由感应电荷产生的电势乘积的 $\\frac{1}{2}$。由感应表面极化产生的电势 $\\phi_{\\mathrm{ind}}$ 等效于区域 1 中镜像电荷 $q'$ 产生的电势。我们需要在真实电荷的位置 $\\mathbf{r}_0 = (0,0,d)$ 处计算该电势。\n由位于 $\\mathbf{r}'=(0,0,-d)$ 的镜像电荷 $q'$ 产生的电势为：\n$$ \\phi_{\\mathrm{ind}}(\\mathbf{r}) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q'}{|\\mathbf{r}-\\mathbf{r}'|} $$\n在 $\\mathbf{r}_0$ 处计算：\n$$ \\phi_{\\mathrm{ind}}(\\mathbf{r}_0) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q'}{|(0,0,d)-(0,0,-d)|} = \\frac{1}{4\\pi\\epsilon_1} \\frac{q'}{2d} $$\n代入 $q'$ 的表达式：\n$$ \\phi_{\\mathrm{ind}}(\\mathbf{r}_0) = \\frac{1}{8\\pi\\epsilon_1 d} \\left( q \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) = \\frac{q}{8\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) $$\n自能定义为 $U_{\\mathrm{self}} = \\frac{1}{2} q \\phi_{\\mathrm{ind}}(\\mathbf{r}_0)$:\n$$ U_{\\mathrm{self}} = \\frac{1}{2} q \\left[ \\frac{q}{8\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) \\right] $$\n$$ U_{\\mathrm{self}} = \\frac{q^2}{16\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right) $$\n\n最后，我们分析极限情况。\n情况 1：$\\epsilon_2 \\to \\infty$。这代表与理想导体的界面。\n项 $\\left(\\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\\right) = \\left(\\frac{\\epsilon_1/\\epsilon_2 - 1}{\\epsilon_1/\\epsilon_2 + 1}\\right) \\to -1$。\n自能变为 $U_{\\mathrm{self}} = -\\frac{q^2}{16\\pi\\epsilon_1 d}$。负号表示电荷与导电平面之间存在吸引力。在此情况下，镜像电荷为 $q' = -q$，符合预期。\n\n情况 2：$\\epsilon_2 \\to \\epsilon_1$。这代表一个没有界面的均匀介质。\n项 $\\left(\\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\\right) \\to \\left(\\frac{\\epsilon_1 - \\epsilon_1}{\\epsilon_1 + \\epsilon_1}\\right) = 0$。\n自能变为 $U_{\\mathrm{self}} = 0$。这在物理上是正确的，因为没有界面来感应极化，因此没有相关的相互作用能。镜像电荷 $q'$ 为零。\n\n$U_{\\mathrm{self}}$ 的符号取决于 $(\\epsilon_1 - \\epsilon_2)$ 的符号。如果 $\\epsilon_2 > \\epsilon_1$（电荷在极化率较低的介质中），$U_{\\mathrm{self}}$ 为负，表示被吸引到界面。如果 $\\epsilon_2  \\epsilon_1$（电荷在极化率较高的介质中），$U_{\\mathrm{self}}$ 为正，表示被界面排斥。能量的大小与电容率的差异成正比。", "answer": "$$\n\\boxed{\\frac{q^2}{16\\pi\\epsilon_1 d} \\left( \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right)}\n$$", "id": "3444065"}, {"introduction": "基于界面极化的概念，本实践旨在解决三维周期性边界条件下平板模拟中的一个常见人为效应。我们将从导电边界条件下周期性单元的平均电位移场为零这一基本假设出发，推导广泛使用的偶极矩校正项 [@problem_id:3444105]。这项练习将宏观静电学原理与精确模拟表面和界面所必需的实用校正直接联系起来。", "problem": "一项分子动力学模拟将一个平面液-汽界面建模为一个电中性薄板，其厚度远小于横向尺寸。该薄板被放置在一个尺寸为 $L_x$、$L_y$ 和 $L_z$ 的矩形周期性晶胞中，$L_z$ 的选择足够大以包含一个显式的真空区域。该系统使用三维周期性边界条件和标准三维Ewald求和方法进行模拟，并在无穷远处采用导电（锡箔）边界条件。由于界面不对称性，模拟晶胞在表面法线方向上具有一个非零的总电偶极矩分量 $M_z \\neq 0$，而根据对称性，横向分量可以忽略不计。模拟晶胞外部的电介质是真空，其真空介电常数为 $\\varepsilon_0$。\n\n仅从宏观麦克斯韦电动力学和核心定义出发，特别是电位移场与极化强度之间的关系 $ \\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P} $，以及真空中均匀场的静电能量密度 $u = \\tfrac{1}{2}\\varepsilon_0 |\\mathbf{E}|^2$，假设带有导电外部边界的三维周期性边界条件使得晶胞内的平均电位移场为零，即 $\\langle \\mathbf{D} \\rangle = \\mathbf{0}$。取晶胞平均极化强度为 $\\mathbf{P} = \\mathbf{M}/V$，其中 $V = L_x L_y L_z$ 且 $\\mathbf{M} = (0,0,M_z)$。请从第一性原理推导出能量校正 $U_{\\mathrm{corr}}(L_x,L_y,L_z;M_z,\\varepsilon_0)$ 的表达式。该校正项必须加到三维Ewald静电能上，以通过消除薄板与其沿表面法线方向的周期性镜像之间的伪相互作用，来获得二维薄板极限。\n\n然后，通过引入表面偶极子密度 $\\mu_s = M_z/(L_x L_y)$，表达单位面积的校正，并说明在固定的 $L_x$ 和 $L_y$ 下，该校正随真空层厚度 $L_z$ 的主要标度关系。您的最终答案必须是关于 $U_{\\mathrm{corr}}(L_x,L_y,L_z;M_z,\\varepsilon_0)$ 的单个国际单位制 (SI) 闭式解析表达式。不需要进行数值计算。", "solution": "该问题要求我们从宏观电动力学的第一性原理出发，推导用于修正平面界面模拟中偶极矩伪影的能量项。该系统是一个在三维周期性边界条件（3D-PBC）下，采用导电（锡箔）边界条件的电中性薄板。\n\n1.  推导的核心假设是，对于导电边界条件，模拟晶胞内的平均电位移场 $\\langle \\mathbf{D} \\rangle$ 为零：\n    $$ \\langle \\mathbf{D} \\rangle = \\mathbf{0} $$\n\n2.  根据电位移场 $\\mathbf{D}$、电场 $\\mathbf{E}$ 和极化强度 $\\mathbf{P}$ 的定义关系 $\\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P}$，我们可以对整个晶胞进行体积平均：\n    $$ \\langle \\mathbf{D} \\rangle = \\varepsilon_0 \\langle \\mathbf{E} \\rangle + \\langle \\mathbf{P} \\rangle $$\n\n3.  结合以上两点，我们得到平均电场 $\\langle \\mathbf{E} \\rangle$ 与平均极化强度 $\\langle \\mathbf{P} \\rangle$ 的关系：\n    $$ \\varepsilon_0 \\langle \\mathbf{E} \\rangle + \\langle \\mathbf{P} \\rangle = \\mathbf{0} \\implies \\langle \\mathbf{E} \\rangle = -\\frac{\\langle \\mathbf{P} \\rangle}{\\varepsilon_0} $$\n\n4.  晶胞的平均极化强度是总偶极矩 $\\mathbf{M}$ 除以体积 $V$，即 $\\langle \\mathbf{P} \\rangle = \\mathbf{M}/V$。代入上式可得：\n    $$ \\langle \\mathbf{E} \\rangle = -\\frac{\\mathbf{M}}{\\varepsilon_0 V} $$\n    这代表了由于在3D-PBC下模拟一个具有净偶极矩的系统而产生的人工（非物理）均匀背景电场。\n\n5.  该人工电场在整个模拟晶胞中储存了静电能，这正是我们需要校正的伪相互作用能。均匀电场的能量密度为 $u = \\frac{1}{2}\\varepsilon_0 |\\mathbf{E}|^2$。因此，总校正能量 $U_{\\mathrm{corr}}$ 等于此能量密度乘以晶胞体积 $V$：\n    $$ U_{\\mathrm{corr}} = u \\cdot V = \\left( \\frac{1}{2}\\varepsilon_0 |\\langle \\mathbf{E} \\rangle|^2 \\right) V $$\n\n6.  将 $\\langle \\mathbf{E} \\rangle$ 的表达式代入：\n    $$ U_{\\mathrm{corr}} = \\frac{1}{2}\\varepsilon_0 V \\left| -\\frac{\\mathbf{M}}{\\varepsilon_0 V} \\right|^2 = \\frac{1}{2}\\varepsilon_0 V \\frac{|\\mathbf{M}|^2}{(\\varepsilon_0 V)^2} = \\frac{|\\mathbf{M}|^2}{2 \\varepsilon_0 V} $$\n\n7.  对于问题中给定的情况，$\\mathbf{M} = (0, 0, M_z)$ 且 $V = L_x L_y L_z$。代入后得到最终的校正能量表达式：\n    $$ U_{\\mathrm{corr}}(L_x, L_y, L_z; M_z, \\varepsilon_0) = \\frac{M_z^2}{2 \\varepsilon_0 L_x L_y L_z} $$\n    这个正的能量项需要加到通过标准3D Ewald方法计算出的总能量上，以抵消周期性镜像之间非物理的吸引作用。\n\n对于单位面积的校正，我们将 $U_{\\mathrm{corr}}$ 除以表面积 $A = L_x L_y$。引入表面偶极子密度 $\\mu_s = M_z/A$：\n$$ u_{\\mathrm{corr}} = \\frac{U_{\\mathrm{corr}}}{A} = \\frac{M_z^2}{2 \\varepsilon_0 (L_x L_y)^2 L_z} = \\frac{\\mu_s^2}{2 \\varepsilon_0 L_z} $$\n这表明校正能与真空层厚度 $L_z$ 成反比，符合物理预期：随着周期性薄板间距的增加，它们之间的伪相互作用会减弱。", "answer": "$$\\boxed{\\frac{M_z^2}{2 \\varepsilon_0 L_x L_y L_z}}$$", "id": "3444105"}, {"introduction": "本实践将我们的重点转移到另一个相关的人为效应：Ewald 加和方法中固有的自相互作用项。我们将使用充电自由能计算的模拟数据，来诊断并校正 Ewald 自能项对系统物理性质的影响 [@problem_id:3444100]。这项数值练习演示了如何对模拟数据进行后处理以提取真实的环境响应，这是涉及充电过程的计算研究中的一项关键技能。", "problem": "考虑在采用埃瓦尔德求和的周期性边界条件下的分子动力学（MD）模拟中，为单个粒子充电的自由能。在高斯屏蔽的埃瓦尔德构造中，携带电荷 $q$ 的单个粒子的静电自由能可以分解为 $F(q) = F_{\\text{env}}(q) + F_{\\text{self}}(q)$，其中 $F_{\\text{env}}(q)$ 捕捉了环境响应，$F_{\\text{self}}(q)$ 是与埃瓦尔德分解相关的高斯自相互作用项。在 $q = 0$ 附近，假设环境贡献允许泰勒展开 $F_{\\text{env}}(q) = \\phi_0 q + \\tfrac{1}{2} \\kappa q^2 + \\mathcal{O}(q^3)$，其中 $\\phi_0$ 是一个偏移势，$\\kappa$ 是环境曲率（两者都独立于埃瓦尔德参数 $\\alpha$）。在将库仑前因子设为1的约化静电单位中，埃瓦尔德自相互作用项的形式为 $F_{\\text{self}}(q) = -\\alpha/\\sqrt{\\pi} \\, q^2$，其中 $\\alpha$ 是埃瓦尔德高斯屏蔽参数。\n\n您的任务是检验由炼金术变换产生的充电自由能，并从第一性原理出发，展示自相互作用项如何影响 $F(q)$ 的曲率。然后，使用数值诊断方法，从合成数据集中提取在 $q = 0$ 处的二阶导数 $\\partial^2 F/\\partial q^2$，并应用自相互作用项曲率校正来估计 $\\kappa$。最后，通过将校正后的曲率与用于生成数据的已知环境曲率进行比较，来评估校正的质量。\n\n您必须使用的基本原理：\n- 采用高斯屏蔽的库仑埃瓦尔德求和方法，为单个粒子引入了一个形式为 $F_{\\text{self}}(q) = -\\alpha/\\sqrt{\\pi} \\, q^2$ 的显式自相互作用自由能贡献（在约化单位下）。\n- 在 $q = 0$ 附近的线性响应中，环境贡献为 $F_{\\text{env}}(q) = \\phi_0 q + \\tfrac{1}{2} \\kappa q^2 + \\mathcal{O}(q^3)$。\n- 在间距为 $h$ 的均匀网格上，于 $q = 0$ 处的标准对称三点中心差分公式为 $F''(0) \\approx \\left[F(h) - 2 F(0) + F(-h)\\right]/h^2$。\n\n需要实施的计算方案：\n- 对于每个提供的数据集，使用对称三点中心差分法，根据最接近 $q = 0$ 且等间距为 $h$ 的三个点，计算在 $q = 0$ 处测量曲率的数值估计值，记为 $K_{\\text{meas}}$。\n- 计算由 $F_{\\text{self}}(q)$ 蕴含的自相互作用项曲率贡献 $K_{\\text{self}}$，并通过从 $K_{\\text{meas}}$ 中移除自相互作用项的贡献，来获得环境的校正后曲率估计值 $K_{\\text{corr}}$。\n- 将 $K_{\\text{corr}}$ 与用于生成该数据集的已知环境曲率 $\\kappa_{\\text{true}}$ 进行比较，并报告其绝对偏差是否在给定的容差 $\\tau$ 之内。\n\n所有能量和曲率必须以千焦每摩尔每平方基本电荷为单位表示，即单位为 $\\text{kJ mol}^{-1} \\, e^{-2}$。您必须将 $q$ 视为以基本电荷为单位的无量纲量。\n\n测试套件：\n- 情况A（具有非零高斯屏蔽的均匀线性响应）：\n  - 参数：$\\alpha = 0.35$, $\\kappa_{\\text{true}} = 12.0$, $\\phi_0 = -1.6$, $c_0 = 2.4$, $\\delta = 0.0$。\n  - 网格：$q \\in \\{-1.0, -0.5, 0.0, 0.5, 1.0\\}$，在 $q = 0$ 附近的均匀间距为 $h = 0.5$。\n  - 合成数据模型：$F(q) = c_0 + \\phi_0 q + \\tfrac{1}{2} \\kappa_{\\text{true}} q^2 + \\delta q^4 + F_{\\text{self}}(q)$。\n- 情况B（具有零高斯屏蔽的均匀线性响应）：\n  - 参数：$\\alpha = 0.0$, $\\kappa_{\\text{true}} = 8.0$, $\\phi_0 = 0.0$, $c_0 = 0.0$, $\\delta = 0.0$。\n  - 网格：$q \\in \\{-0.5, 0.0, 0.5\\}$，间距为 $h = 0.5$。\n  - 合成数据模型：与上述函数形式相同。\n- 情况C（用于测试诊断灵敏度的非线性环境响应）：\n  - 参数：$\\alpha = 0.2$, $\\kappa_{\\text{true}} = 15.0$, $\\phi_0 = 1.0$, $c_0 = -1.0$, $\\delta = 5.0$。\n  - 网格：$q \\in \\{-1.0, -0.5, 0.0, 0.5, 1.0\\}$，在 $q = 0$ 附近的间距为 $h = 0.5$。\n  - 合成数据模型：与上述函数形式相同。\n\n容差和通过/失败诊断：\n- 使用 $\\tau = 1.0 \\times 10^{-9}$（单位 $\\text{kJ mol}^{-1} \\, e^{-2}$）来评估 $|K_{\\text{corr}} - \\kappa_{\\text{true}}| \\le \\tau$ 是否成立。\n\n要求的输出和格式：\n- 对每种情况，按顺序计算并输出三个值：$K_{\\text{meas}}$、$K_{\\text{corr}}$ 以及一个布尔值，该布尔值指示校正后的曲率是否在容差 $\\tau$ 内与 $\\kappa_{\\text{true}}$ 匹配。\n- 您的程序应生成单行输出，其中包含所有三种情况的结果，这些结果以逗号分隔列表的形式串联，并用方括号括起来（例如，$[K_{\\text{meas}}^{(A)},K_{\\text{corr}}^{(A)},\\text{pass}^{(A)},K_{\\text{meas}}^{(B)},K_{\\text{corr}}^{(B)},\\text{pass}^{(B)},K_{\\text{meas}}^{(C)},K_{\\text{corr}}^{(C)},\\text{pass}^{(C)}]$）。\n- 所有报告的曲率单位必须是 $\\text{kJ mol}^{-1} \\, e^{-2}$。", "solution": "该问题要求我们验证分子动力学模拟中炼金术充电自由能曲线 $F(q)$ 曲率的校正方案。该曲率受到埃瓦尔德求和方法固有的人为自相互作用项的影响。我们将首先建立总测量曲率、真实环境曲率和自相互作用曲率之间的理论关系。然后，我们将实施一个数值方案，从合成数据中计算这些量，并评估校正的准确性。\n\n**1. 理论框架**\n\n为带电荷 $q$ 的单个粒子充电的总自由能由两部分贡献之和给出：环境响应 $F_{\\text{env}}(q)$ 和埃瓦尔德自相互作用 $F_{\\text{self}}(q)$。\n$$\nF(q) = F_{\\text{env}}(q) + F_{\\text{self}}(q)\n$$\n\n假设在 $q=0$ 附近，环境贡献遵循线性响应模型，由泰勒展开表示：\n$$\nF_{\\text{env}}(q) = \\phi_0 q + \\frac{1}{2} \\kappa q^2 + \\mathcal{O}(q^3)\n$$\n此处，$\\kappa$ 是环境自由能响应的内在曲率，这是我们旨在估计的量。\n\n对于高斯屏蔽的电荷分布，其埃瓦尔德自相互作用贡献在约化静电单位中给出为：\n$$\nF_{\\text{self}}(q) = -\\frac{\\alpha}{\\sqrt{\\pi}} q^2\n$$\n其中 $\\alpha$ 是埃瓦尔德屏蔽参数。\n\n结合这些项，总自由能为：\n$$\nF(q) = \\phi_0 q + \\frac{1}{2} \\kappa q^2 - \\frac{\\alpha}{\\sqrt{\\pi}} q^2 + \\mathcal{O}(q^3)\n$$\n\n自由能对电荷的二阶导数，在 $q=0$ 处求值，定义了曲率。让我们对 $F(q)$ 求两次导数：\n$$\n\\frac{\\partial F}{\\partial q} = \\phi_0 + \\kappa q - \\frac{2\\alpha}{\\sqrt{\\pi}} q + \\mathcal{O}(q^2)\n$$\n$$\n\\frac{\\partial^2 F}{\\partial q^2} = \\kappa - \\frac{2\\alpha}{\\sqrt{\\pi}} + \\mathcal{O}(q)\n$$\n\n在 $q=0$ 处求值，我们得到精确的总曲率，我们称之为 $K_{\\text{total}}$：\n$$\nK_{\\text{total}} = \\frac{\\partial^2 F}{\\partial q^2}\\bigg|_{q=0} = \\kappa - \\frac{2\\alpha}{\\sqrt{\\pi}}\n$$\n\n该方程表明，总曲率是环境曲率 $\\kappa$ 和我们定义为 $K_{\\text{self}}$ 的自相互作用项曲率之和。\n$$\nK_{\\text{self}} = \\frac{\\partial^2 F_{\\text{self}}}{\\partial q^2} = \\frac{\\partial^2}{\\partial q^2} \\left( -\\frac{\\alpha}{\\sqrt{\\pi}} q^2 \\right) = -\\frac{2\\alpha}{\\sqrt{\\pi}}\n$$\n因此，我们有以下基本关系：\n$$\nK_{\\text{total}} = \\kappa + K_{\\text{self}}\n$$\n这为校正提供了基础。如果可以测量总曲率 $K_{\\text{total}}$，并且知道 $K_{\\text{self}}$ 的解析形式，那么就可以通过减法恢复真实的环境曲率 $\\kappa$：\n$$\n\\kappa = K_{\\text{total}} - K_{\\text{self}}\n$$\n\n**2. 数值方案与分析**\n\n在实践中，$K_{\\text{total}}$ 并非解析已知，而是通过 $F(q)$ 的离散数据点进行数值估计。问题指定使用对称三点中心差分公式来估计在 $q=0$ 处的二阶导数。我们将此数值估计记为 $K_{\\text{meas}}$。\n$$\nK_{\\text{meas}} \\approx \\frac{F(h) - 2F(0) + F(-h)}{h^2}\n$$\n其中 $h$ 是电荷网格的间距。\n\n合成数据由以下模型生成：\n$$\nF(q) = c_0 + \\phi_0 q + \\frac{1}{2} \\kappa_{\\text{true}} q^2 + \\delta q^4 - \\frac{\\alpha}{\\sqrt{\\pi}} q^2\n$$\n该模型对应于理论框架，其中 $\\phi_0$ 是线性项系数，$\\kappa = \\kappa_{\\text{true}}$，以及一个高阶项 $\\delta q^4$。让我们分析对于这个特定函数形式，数值导数的准确性。\n\n将模型代入有限差分公式：\n- $F(h) = c_0 + \\phi_0 h + \\left(\\frac{1}{2} \\kappa_{\\text{true}} - \\frac{\\alpha}{\\sqrt{\\pi}}\\right)h^2 + \\delta h^4$\n- $F(0) = c_0$\n- $F(-h) = c_0 - \\phi_0 h + \\left(\\frac{1}{2} \\kappa_{\\text{true}} - \\frac{\\alpha}{\\sqrt{\\pi}}\\right)h^2 + \\delta h^4$\n\n求和并代入：\n$F(h) - 2F(0) + F(-h) = \\left[ c_0 + \\phi_0 h + \\dots \\right] - 2c_0 + \\left[ c_0 - \\phi_0 h + \\dots \\right]$\n$= (\\phi_0 h - \\phi_0 h) + (c_0 - 2c_0 + c_0) + 2\\left(\\frac{1}{2} \\kappa_{\\text{true}} - \\frac{\\alpha}{\\sqrt{\\pi}}\\right)h^2 + 2\\delta h^4$\n$= \\left(\\kappa_{\\text{true}} - \\frac{2\\alpha}{\\sqrt{\\pi}}\\right)h^2 + 2\\delta h^4$\n\n除以 $h^2$ 得到数值测量的曲率：\n$$\nK_{\\text{meas}} = \\frac{\\left(\\kappa_{\\text{true}} - \\frac{2\\alpha}{\\sqrt{\\pi}}\\right)h^2 + 2\\delta h^4}{h^2} = \\left(\\kappa_{\\text{true}} - \\frac{2\\alpha}{\\sqrt{\\pi}}\\right) + 2\\delta h^2\n$$\n回想一下 $K_{\\text{self}} = -2\\alpha/\\sqrt{\\pi}$，我们可以写出：\n$$\nK_{\\text{meas}} = \\kappa_{\\text{true}} + K_{\\text{self}} + 2\\delta h^2\n$$\n值 $2\\delta h^2$ 是对于一个具有非零四阶导数的函数，有限差分公式的截断误差。\n\n计算方案要求我们通过从测量值中减去已知的自相互作用项贡献，来计算校正后的曲率 $K_{\\text{corr}}$：\n$$\nK_{\\text{corr}} = K_{\\text{meas}} - K_{\\text{self}}\n$$\n代入我们对 $K_{\\text{meas}}$ 的表达式：\n$$\nK_{\\text{corr}} = (\\kappa_{\\text{true}} + K_{\\text{self}} + 2\\delta h^2) - K_{\\text{self}} = \\kappa_{\\text{true}} + 2\\delta h^2\n$$\n这个关键结果表明，校正后的曲率 $K_{\\text{corr}}$ 将与真实环境曲率 $\\kappa_{\\text{true}}$ 完全相等，当且仅当四阶项 $\\delta$ 为零。当 $\\delta \\neq 0$ 时，偏差 $|K_{\\text{corr}} - \\kappa_{\\text{true}}|$ 将等于 $|2\\delta h^2|$，这反映了数值微分方法的内在误差，而非自能校正原理本身的失败。\n\n**3. 应用于测试案例**\n\n我们现在将此程序应用于所提供的测试案例。对于所有情况， $q=0$ 附近的网格间距为 $h=0.5$。容差为 $\\tau = 1.0 \\times 10^{-9}$。\n\n**情况A：** $\\alpha = 0.35$, $\\kappa_{\\text{true}} = 12.0$, $\\delta = 0.0$。\n1.  计算 $K_{\\text{self}} = -2 \\times 0.35 / \\sqrt{\\pi} \\approx -0.39498454$。\n2.  计算 $K_{\\text{meas}}$。由于 $\\delta=0$，所以 $K_{\\text{meas}} = \\kappa_{\\text{true}} + K_{\\text{self}} = 12.0 - 0.39498454 = 11.60501546$。\n3.  计算 $K_{\\text{corr}} = K_{\\text{meas}} - K_{\\text{self}} = 11.60501546 - (-0.39498454) = 12.0$。\n4.  检查偏差：$|12.0 - 12.0| = 0.0 \\le \\tau$。测试通过。\n\n**情况B：** $\\alpha = 0.0$, $\\kappa_{\\text{true}} = 8.0$, $\\delta = 0.0$。\n1.  计算 $K_{\\text{self}} = -2 \\times 0.0 / \\sqrt{\\pi} = 0.0$。\n2.  计算 $K_{\\text{meas}}$。由于 $\\delta=0$，所以 $K_{\\text{meas}} = \\kappa_{\\text{true}} + K_{\\text{self}} = 8.0 + 0.0 = 8.0$。\n3.  计算 $K_{\\text{corr}} = K_{\\text{meas}} - K_{\\text{self}} = 8.0 - 0.0 = 8.0$。\n4.  检查偏差：$|8.0 - 8.0| = 0.0 \\le \\tau$。测试通过。这个案例表明，当没有埃瓦尔德自相互作用项（$\\alpha=0$）时，测量的曲率直接反映了环境。\n\n**情况C：** $\\alpha = 0.2$, $\\kappa_{\\text{true}} = 15.0$, $\\delta = 5.0$。\n1.  计算 $K_{\\text{self}} = -2 \\times 0.2 / \\sqrt{\\pi} \\approx -0.22570545$。\n2.  计算 $K_{\\text{meas}}$。由于 $\\delta \\neq 0$，存在截断误差：$K_{\\text{meas}} = \\kappa_{\\text{true}} + K_{\\text{self}} + 2\\delta h^2 = 15.0 - 0.22570545 + 2 \\times 5.0 \\times (0.5)^2 = 14.77429455 + 2.5 = 17.27429455$。\n3.  计算 $K_{\\text{corr}} = K_{\\text{meas}} - K_{\\text{self}} = 17.27429455 - (-0.22570545) = 17.5$。\n4.  检查偏差：$|17.5 - 15.0| = 2.5 > \\tau$。测试失败。这个失败正确地指出了在存在强环境非线性（$q^4$ 项）时数值诊断的局限性，而校正程序并未考虑这一点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of correcting charging free energy curvature for Ewald self-interaction.\n    \n    This function processes a set of test cases, each defined by parameters for a \n    synthetic free energy model. For each case, it:\n    1. Generates synthetic free energy data points around q=0.\n    2. Computes the measured curvature (K_meas) using a three-point finite difference.\n    3. Calculates the analytical curvature contribution from the Ewald self-term (K_self).\n    4. Obtains the corrected environment curvature (K_corr) by subtracting K_self from K_meas.\n    5. Compares K_corr to the known true curvature (kappa_true) to assess the correction's accuracy.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"params\": {\"alpha\": 0.35, \"kappa_true\": 12.0, \"phi0\": -1.6, \"c0\": 2.4, \"delta\": 0.0},\n            \"h\": 0.5,\n        },\n        {\n            \"name\": \"Case B\",\n            \"params\": {\"alpha\": 0.0, \"kappa_true\": 8.0, \"phi0\": 0.0, \"c0\": 0.0, \"delta\": 0.0},\n            \"h\": 0.5,\n        },\n        {\n            \"name\": \"Case C\",\n            \"params\": {\"alpha\": 0.2, \"kappa_true\": 15.0, \"phi0\": 1.0, \"c0\": -1.0, \"delta\": 5.0},\n            \"h\": 0.5,\n        }\n    ]\n\n    # Tolerance for comparing corrected curvature to the true value.\n    tolerance = 1.0e-9\n\n    results = []\n    \n    # Synthetic free energy model\n    def F(q, p):\n        \"\"\"\n        Calculates the synthetic total free energy F(q) based on the model:\n        F(q) = c0 + phi0*q + (1/2)*kappa_true*q^2 + delta*q^4 - (alpha/sqrt(pi))*q^2\n        \"\"\"\n        return (p[\"c0\"] + p[\"phi0\"] * q + 0.5 * p[\"kappa_true\"] * q**2 + p[\"delta\"] * q**4 \n                - (p[\"alpha\"] / np.sqrt(np.pi)) * q**2)\n\n    for case in test_cases:\n        params = case[\"params\"]\n        h = case[\"h\"]\n        kappa_true = params[\"kappa_true\"]\n        alpha = params[\"alpha\"]\n\n        # 1. Generate the free energy values at q = -h, 0, h\n        f_h = F(h, params)\n        f_0 = F(0, params)\n        f_mh = F(-h, params)\n        \n        # 2. Compute the measured curvature (K_meas) using the symmetric three-point central difference formula.\n        K_meas = (f_h - 2 * f_0 + f_mh) / (h**2)\n        \n        # 3. Compute the self-term curvature contribution (K_self).\n        # This is the analytical second derivative of F_self(q) = -alpha/sqrt(pi) * q^2,\n        # which is -2*alpha/sqrt(pi).\n        K_self = -2 * alpha / np.sqrt(np.pi)\n        \n        # 4. Compute the corrected curvature (K_corr) for the environment.\n        K_corr = K_meas - K_self\n        \n        # 5. Assess the quality of the correction.\n        # Check if the absolute deviation between the corrected and true curvature is within tolerance.\n        is_pass = abs(K_corr - kappa_true) = tolerance\n        \n        # Append the results for this case to the final list.\n        results.extend([K_meas, K_corr, is_pass])\n\n    # Final print statement in the exact required format.\n    # The boolean `is_pass` is automatically converted to 'True' or 'False' string by `map(str, ...)`.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3444100"}]}