{"hands_on_practices": [{"introduction": "这个练习将反应场方法的基础植根于基本静电学。通过推导势能的主导阶修正项，你将从第一性原理层面理解介电连续体如何修正成对相互作用。随后的数值比较将让你对这个修正项相对于直接库仑相互作用的量级有一个切实的感受。", "problem": "考虑在分子动力学中用于静电相互作用的一种标准球形截断实现的反应场（RF）方法。两个点电荷位于半径为 $R_c$ 的球形空腔内部，空腔外部区域被建模为一个静态相对介电常数为 $\\epsilon_{\\mathrm{rf}}$ 的均匀、各向同性的介电连续体。对于间距 $r \\leq R_c$，有效对势可以写作 $r/R_c$ 的主导阶，形式为一个库仑项加上一个关于 $r$ 的二次方校正项，即 $V(r) \\propto \\frac{1}{r} + k_{\\mathrm{rf}} r^2$ 的形式，其中 $k_{\\mathrm{rf}}$ 是一个由空腔外的介电响应以及在 $r=R_c$ 处的球形边界条件决定的常数。\n\n从物质中的静电学出发，使用静态极限下的Maxwell方程组、本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$、球形介电界面上的边界条件（静电势的连续性和电位移场法向分量的连续性），并结合在 $r \\ll R_c$ 时有效的多极展开，推导出 $k_{\\mathrm{rf}}$ 关于 $\\epsilon_{\\mathrm{rf}}$ 和 $R_c$ 的表达式。然后，对于 $\\epsilon_{\\mathrm{rf}} = 78$（近似于环境条件下的体相液态水）和 $R_c = 1.0\\,\\mathrm{nm}$，以 $\\mathrm{nm}^{-3}$ 为单位数值计算 $k_{\\mathrm{rf}}$。\n\n最后，在 $r = R_c/2$ 处，通过构建比值\n$$\\frac{k_{\\mathrm{rf}} r^2}{1/r}$$\n来比较二次校正项 $k_{\\mathrm{rf}} r^2$ 的量值与库仑项 $1/r$ 的量值。\n将此比值作为你的最终答案。将你的最终答案四舍五入到四位有效数字。该比值为无量纲量，请勿在最终答案中包含任何单位。", "solution": "该问题要求推导反应场（RF）方法中有效对势的一个系数 $k_{\\mathrm{rf}}$，然后计算一个涉及该系数的特定比值。\n\n### 第一步：问题验证\n\n**1. 提取已知条件：**\n- 系统：两个点电荷位于半径为 $R_c$ 的球形空腔内部。\n- 外部介质：一个静态相对介电常数为 $\\epsilon_{\\mathrm{rf}}$ 的均匀、各向同性的介电连续体。\n- 势能形式：对于间距 $r \\leq R_c$，有效对势由 $V(r) \\propto \\frac{1}{r} + k_{\\mathrm{rf}} r^2$ 给出。\n- 推导工具：静态极限下的Maxwell方程组（$\\nabla \\cdot \\mathbf{D} = \\rho$, $\\nabla \\times \\mathbf{E} = 0$）、本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$、球形介电界面的边界条件，以及在 $r \\ll R_c$ 时有效的多极展开。\n- 数值：$\\epsilon_{\\mathrm{rf}} = 78$，$R_c = 1.0\\,\\mathrm{nm}$。\n- 最终任务：计算在 $r = R_c/2$ 时的比值 $\\frac{k_{\\mathrm{rf}} r^2}{1/r}$ 并四舍五入到四位有效数字。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题基于 Onsager 反应场模型，这是经典静电学和分子模拟中用于模拟溶剂效应的一个成熟且标准的理论框架。所引用的原理（Maxwell方程组、介电理论、多极展开、边值问题）是物理学的基础。提供的数值对于模拟水溶液体系是物理上现实的。该问题在科学上是合理的。\n- **适定性：**该问题要求进行特定的推导和随后的计算。推导路径已经概述，并基于标准的静电理论，能够得到 $k_{\\mathrm{rf}}$ 的唯一表达式。计算是明确的。该问题是适定的。\n- **客观性：**问题以精确的技术语言陈述，没有任何主观或模糊的术语。\n- **结论：**该问题是有效的，因为它是自洽的、有科学依据且适定的。\n\n### 第二步：推导 $k_{\\mathrm{rf}}$ 的表达式\n\n空腔内的静电势 $\\Phi_{\\mathrm{in}}$ 是电荷自身产生的电势 $\\Phi_{\\mathrm{charges}}$ 与周围介电介质极化产生的电势 $\\Phi_{\\mathrm{reac}}$（反应场势）之和。\n该问题可以通过考虑一个电荷体系 $\\{q_k\\}$（位于半径为 $R_c$ 的球形空腔内的位置 $\\{\\mathbf{r}_k\\}$）来解决。空腔内部的介质是真空（相对介电常数 $\\epsilon_{\\mathrm{in}} = 1$），外部介质的相对介电常数为 $\\epsilon_{\\mathrm{rf}}$。\n\n在静态情况下，电场是保守场，$\\mathbf{E} = -\\nabla \\Phi$。控制方程是泊松方程，在无电荷区域简化为拉普拉斯方程 $\\nabla^2 \\Phi = 0$。\n\n反应场势 $\\Phi_{\\mathrm{reac}}$ 在空腔内部满足拉普拉斯方程。在原点处正则的通解可以写成球谐函数 $Y_{lm}(\\theta, \\phi)$ 的多极展开式：\n$$ \\Phi_{\\mathrm{reac}}(\\mathbf{x}) = \\sum_{l=0}^\\infty \\sum_{m=-l}^l A_{lm} |\\mathbf{x}|^l Y_{lm}(\\theta, \\phi) $$\n空腔外部的总电势必须在无穷远处为零，其表达式为：\n$$ \\Phi_{\\mathrm{out}}(\\mathbf{x}) = \\sum_{l=0}^\\infty \\sum_{m=-l}^l B_{lm} |\\mathbf{x}|^{-(l+1)} Y_{lm}(\\theta, \\phi) $$\n空腔内部的总电势为 $\\Phi_{\\mathrm{in}}(\\mathbf{x}) = \\Phi_{\\mathrm{charges}}(\\mathbf{x}) + \\Phi_{\\mathrm{reac}}(\\mathbf{x})$。对于所有 $k$，当 $|\\mathbf{x}| > |\\mathbf{r}_k|$ 时，我们可以展开 $\\Phi_{\\mathrm{charges}}$：\n$$ \\Phi_{\\mathrm{charges}}(\\mathbf{x}) = \\frac{1}{4\\pi\\epsilon_0} \\sum_k \\frac{q_k}{|\\mathbf{x}-\\mathbf{r}_k|} = \\frac{1}{\\epsilon_0} \\sum_{l,m} \\frac{1}{2l+1} \\frac{Q_{lm}}{|\\mathbf{x}|^{l+1}} Y_{lm}(\\theta, \\phi) $$\n其中 $Q_{lm} = \\sum_k q_k |\\mathbf{r}_k|^l Y_{lm}^*(\\Omega_k)$ 是电荷分布的多极矩。\n\n问题指出我们只关心 $r \\ll R_c$ 时的主导阶。这表明我们只需要多极展开中的偶极项（$l=1$）。$l=1$ 的反应场势对应于空腔中心附近的均匀电场。对位于空腔中心的偶极矩 $\\mathbf{M} = \\sum_k q_k \\mathbf{r}_k$ 求解边值问题，得到空腔内的均匀反应场 $\\mathbf{E}_{\\mathrm{RF}}$：\n$$ \\mathbf{E}_{\\mathrm{RF}} = \\frac{1}{4\\pi\\epsilon_0} \\frac{2(\\epsilon_{\\mathrm{rf}}-1)}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{\\mathbf{M}}{R_c^3} $$\n与此均匀场对应的反应场势为 $\\Phi_{\\mathrm{reac}}(\\mathbf{x}) = -\\mathbf{E}_{\\mathrm{RF}} \\cdot \\mathbf{x}$。电荷分布与其自身反应场相互作用的能量为：\n$$ U_{\\mathrm{RF}} = \\frac{1}{2}\\sum_k q_k \\Phi_{\\mathrm{reac}}(\\mathbf{r}_k) = -\\frac{1}{2}\\sum_k q_k (\\mathbf{E}_{\\mathrm{RF}} \\cdot \\mathbf{r}_k) = -\\frac{1}{2} \\mathbf{E}_{\\mathrm{RF}} \\cdot \\left(\\sum_k q_k \\mathbf{r}_k\\right) = -\\frac{1}{2} \\mathbf{E}_{\\mathrm{RF}} \\cdot \\mathbf{M} $$\n代入 $\\mathbf{E}_{\\mathrm{RF}}$ 的表达式：\n$$ U_{\\mathrm{RF}} = -\\frac{1}{2} \\left( \\frac{1}{4\\pi\\epsilon_0} \\frac{2(\\epsilon_{\\mathrm{rf}}-1)}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{\\mathbf{M}}{R_c^3} \\right) \\cdot \\mathbf{M} = -\\frac{1}{4\\pi\\epsilon_0} \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{M^2}{R_c^3} $$\n这是系统的总反应场能量。为了找到两个电荷 $q_i$ 和 $q_j$ 之间的有效对势，我们考虑 $\\mathbf{M} = q_i \\mathbf{r}_i + q_j \\mathbf{r}_j$。那么 $M^2 = q_i^2 r_i^2 + q_j^2 r_j^2 + 2q_i q_j \\mathbf{r}_i \\cdot \\mathbf{r}_j$。总相互作用能包含自能项（与 $q_i^2$ 和 $q_j^2$ 成正比）和对相互作用项。对相互作用能的反应场贡献是交叉项：\n$$ V_{ij}^{\\mathrm{RF}} = -\\frac{1}{4\\pi\\epsilon_0} \\frac{2(\\epsilon_{\\mathrm{rf}}-1)}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{q_i q_j (\\mathbf{r}_i \\cdot \\mathbf{r}_j)}{R_c^3} $$\n总对势能是直接库仑相互作用与此反应场项之和：\n$$ V_{ij}(\\mathbf{r}_i, \\mathbf{r}_j) = \\frac{q_i q_j}{4\\pi\\epsilon_0 |\\mathbf{r}_i - \\mathbf{r}_j|} - \\frac{q_i q_j}{4\\pi\\epsilon_0} \\frac{2(\\epsilon_{\\mathrm{rf}}-1)}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{\\mathbf{r}_i \\cdot \\mathbf{r}_j}{R_c^3} $$\n该势能依赖于绝对位置 $\\mathbf{r}_i, \\mathbf{r}_j$，而不仅仅是它们的相对间距 $r=|\\mathbf{r}_i - \\mathbf{r}_j|$。为了获得一个仅依赖于 $r$ 的“有效对势”，我们使用恒等式 $\\mathbf{r}_i \\cdot \\mathbf{r}_j = \\frac{1}{2}(r_i^2 + r_j^2 - r^2)$。代入可得：\n$$ V_{ij} = \\frac{q_i q_j}{4\\pi\\epsilon_0 r} - \\frac{q_i q_j}{4\\pi\\epsilon_0} \\frac{2(\\epsilon_{\\mathrm{rf}}-1)}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{1}{R_c^3} \\left[ \\frac{1}{2}(r_i^2 + r_j^2 - r^2) \\right] $$\n$$ V_{ij} = \\frac{q_i q_j}{4\\pi\\epsilon_0 r} + \\frac{q_i q_j}{4\\pi\\epsilon_0} \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{r^2}{R_c^3} - \\frac{q_i q_j}{4\\pi\\epsilon_0} \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{r_i^2+r_j^2}{R_c^3} $$\n获得对加性势的标准做法是舍去那些依赖于 $r_i$ 和 $r_j$ 相对于空腔中心绝对位置的项。这个近似产生了有效对势：\n$$ V(r) = \\frac{C}{r} + C \\left( \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{1}{R_c^3} \\right) r^2 $$\n其中 $C$ 是一个与 $q_i q_j/(4\\pi\\epsilon_0)$ 成正比的常数。\n问题陈述势的形式为 $V(r) \\propto \\frac{1}{r} + k_{\\mathrm{rf}} r^2$。通过比较这两种形式，我们确定系数 $k_{\\mathrm{rf}}$ 为：\n$$ k_{\\mathrm{rf}} = \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{1}{R_c^3} $$\n\n### 第三步：比值的数值计算\n\n问题要求计算在 $r = R_c/2$ 处，二次校正项与库仑项的比值：\n$$ \\text{Ratio} = \\frac{k_{\\mathrm{rf}} r^2}{1/r} = k_{\\mathrm{rf}} r^3 $$\n代入 $r = R_c/2$：\n$$ \\text{Ratio} = k_{\\mathrm{rf}} \\left( \\frac{R_c}{2} \\right)^3 = k_{\\mathrm{rf}} \\frac{R_c^3}{8} $$\n现在我们代入推导出的 $k_{\\mathrm{rf}}$ 表达式：\n$$ \\text{Ratio} = \\left( \\frac{\\epsilon_{\\mathrm{rf}}-1}{2\\epsilon_{\\mathrm{rf}}+1} \\frac{1}{R_c^3} \\right) \\frac{R_c^3}{8} $$\n对空腔半径 $R_c$ 的依赖性被消掉了：\n$$ \\text{Ratio} = \\frac{\\epsilon_{\\mathrm{rf}}-1}{8(2\\epsilon_{\\mathrm{rf}}+1)} $$\n现在，我们代入给定的相对介电常数值 $\\epsilon_{\\mathrm{rf}} = 78$：\n$$ \\text{Ratio} = \\frac{78-1}{8(2 \\times 78 + 1)} = \\frac{77}{8(156 + 1)} = \\frac{77}{8(157)} = \\frac{77}{1256} $$\n进行除法运算：\n$$ \\text{Ratio} \\approx 0.06130573248... $$\n按要求将结果四舍五入到四位有效数字：\n$$ \\text{Ratio} \\approx 0.06131 $$\n在这些条件下，对于一对间距为截断半径一半的粒子，这个无量纲比值量化了偶极反应场校正相对于直接库仑相互作用的相对重要性。", "answer": "$$\\boxed{0.06131}$$", "id": "3441050"}, {"introduction": "在分子动力学中实现截断势的一个关键方面是避免在截断半径处出现能量和力的不连续性，因为这会破坏能量守恒。这个练习旨在解决此问题，要求你推导一个修正项，以确保势能和力在截断点都能平滑地趋于零。这是开发稳定且精确的模拟力场时常用的一项基本技术。", "problem": "在半径为 $R_{c}$ 的球形截断的分子动力学中，一种处理长程静电作用的常用方法是采用反应场表示法，将周围介质视为具有相对介电常数的均匀电介质，并通过一个单位为长度$^{-3}$的反应场系数 $k_{\\mathrm{rf}}$ 来概括。在截断球内 ($r \\leq R_{c}$)，两个点电荷的未校正对势可以写为 $V_{0}(r) = \\frac{1}{r} + k_{\\mathrm{rf}} r^{2}$，这里使用的是约化静电单位，其中库仑前因子和电荷乘积均设为1。为了改善能量守恒并避免在截断处的非连续性，添加一个线性校正项 $P(r) = A + B r$，使得总势 $V(r) = V_{0}(r) + P(r)$ 满足边界条件 $V(R_{c}) = 0$ 和 $V'(R_{c}) = 0$，其中 ' 表示对 r 求导。从势能和力的定义出发，并在 $r = R_{c}$ 处施加这些边界条件，推导出线性校正项 $A + B r$，并给出 $A$ 和 $B$ 关于 $R_{c}$ 和 $k_{\\mathrm{rf}}$ 的显式解析表达式。将最终答案表示为闭式表达式；不需要进行数值计算。", "solution": "该问题提供了一个在分子动力学模拟中校正对静电势的框架，以确保其本身及其一阶导数（与力相关）在截断半径 $R_{c}$ 处为零。这是避免能量漂移和力不连续性的标准程序。\n\n首先，我们必须验证问题的陈述。\n已知条件是：\n1.  对于 $r \\leq R_{c}$ 的未校正对势：$V_{0}(r) = \\frac{1}{r} + k_{\\mathrm{rf}} r^{2}$\n2.  线性校正项：$P(r) = A + B r$\n3.  总势：$V(r) = V_{0}(r) + P(r)$\n4.  势的边界条件：$V(R_{c}) = 0$\n5.  势的导数的边界条件：$V'(R_{c}) = 0$\n\n该问题具有科学依据，因为它描述了公认的带有势移位校正的反应场方法，这是计算化学和物理学中的常用技术。定义清晰且客观。这是一个适定问题，提供了两个边界条件来确定两个未知常数 $A$ 和 $B$。问题本身是自洽的，没有矛盾或信息缺失。因此，我们断定该问题是有效的，并开始推导。\n\n总势 $V(r)$ 是未校正势 $V_{0}(r)$ 和线性校正项 $P(r)$ 的和：\n$$\nV(r) = V_{0}(r) + P(r) = \\left(\\frac{1}{r} + k_{\\mathrm{rf}} r^{2}\\right) + (A + B r)\n$$\n我们可以将其写为：\n$$\nV(r) = \\frac{1}{r} + k_{\\mathrm{rf}} r^{2} + A + B r\n$$\n\n接下来，我们求势相对于粒子间距离 $r$ 的一阶导数，记为 $V'(r)$。该量的负值，即 $-V'(r)$，对应于粒子间的力。\n$$\nV'(r) = \\frac{d}{dr} \\left( \\frac{1}{r} + k_{\\mathrm{rf}} r^{2} + A + B r \\right)\n$$\n逐项进行微分：\n$$\nV'(r) = -\\frac{1}{r^{2}} + 2 k_{\\mathrm{rf}} r + B\n$$\n\n现在，我们在截断半径 $r = R_{c}$ 处应用这两个边界条件。\n\n第一个边界条件是 $V'(R_{c}) = 0$。这个条件确保了粒子间的力在截断距离处平滑地变为零。\n将 $r = R_{c}$ 代入 $V'(r)$ 的表达式中：\n$$\nV'(R_{c}) = -\\frac{1}{R_{c}^{2}} + 2 k_{\\mathrm{rf}} R_{c} + B = 0\n$$\n这个方程可以重新整理以直接求解常数 $B$：\n$$\nB = \\frac{1}{R_{c}^{2}} - 2 k_{\\mathrm{rf}} R_{c}\n$$\n\n第二个边界条件是 $V(R_{c}) = 0$。这个条件确保了势能本身在截断处为零，这是移位势的常见约定。\n将 $r = R_{c}$ 代入 $V(r)$ 的表达式中：\n$$\nV(R_{c}) = \\frac{1}{R_{c}} + k_{\\mathrm{rf}} R_{c}^{2} + A + B R_{c} = 0\n$$\n这个方程提供了 $A$ 和 $B$ 之间的关系。我们可以解出 $A$：\n$$\nA = -\\frac{1}{R_{c}} - k_{\\mathrm{rf}} R_{c}^{2} - B R_{c}\n$$\n现在，我们将推导出的 $B$ 的表达式代入这个关于 $A$ 的方程中：\n$$\nA = -\\frac{1}{R_{c}} - k_{\\mathrm{rf}} R_{c}^{2} - \\left(\\frac{1}{R_{c}^{2}} - 2 k_{\\mathrm{rf}} R_{c}\\right) R_{c}\n$$\n将括号中的 $R_{c}$ 项展开：\n$$\nA = -\\frac{1}{R_{c}} - k_{\\mathrm{rf}} R_{c}^{2} - \\left(\\frac{R_{c}}{R_{c}^{2}} - 2 k_{\\mathrm{rf}} R_{c}^{2}\\right)\n$$\n$$\nA = -\\frac{1}{R_{c}} - k_{\\mathrm{rf}} R_{c}^{2} - \\frac{1}{R_{c}} + 2 k_{\\mathrm{rf}} R_{c}^{2}\n$$\n最后，我们合并同类项以获得 $A$ 的显式表达式：\n$$\nA = \\left(-\\frac{1}{R_{c}} - \\frac{1}{R_{c}}\\right) + \\left(-k_{\\mathrm{rf}} R_{c}^{2} + 2 k_{\\mathrm{rf}} R_{c}^{2}\\right)\n$$\n$$\nA = -\\frac{2}{R_{c}} + k_{\\mathrm{rf}} R_{c}^{2}\n$$\n\n因此，线性校正项 $P(r) = A + B r$ 的系数为：\n$$\nA = k_{\\mathrm{rf}} R_{c}^{2} - \\frac{2}{R_{c}}\n$$\n$$\nB = \\frac{1}{R_{c}^{2}} - 2 k_{\\mathrm{rf}} R_{c}\n$$\n这些表达式仅用给定的参数 $R_{c}$ 和 $k_{\\mathrm{rf}}$ 提供了所需的常数 $A$ 和 $B$。", "answer": "$$\n\\boxed{\\begin{pmatrix} k_{\\mathrm{rf}} R_{c}^{2} - \\frac{2}{R_{c}}  \\frac{1}{R_{c}^{2}} - 2 k_{\\mathrm{rf}} R_{c} \\end{pmatrix}}\n$$", "id": "3441030"}, {"introduction": "这项综合性练习将理论与实践在一个模拟环境中结合起来。你将需要推导并实现一个复杂的切换函数，以平滑地混合不同的静电模型，然后运行分子动力学模拟来观察其效果。通过分析得到的振动谱，你将直接看到不同的静电处理方式如何影响分子体系的动力学性质。", "problem": "考虑一个采用球形截断的分子动力学（MD）模拟中两个点电荷之间的成对静电相互作用。在介电连续体（RF）的反应场方法中，截断半径以外的区域被建模为介电介质。在无限介电极限（导电边界）下，截断范围内的反应场力与粒子间距呈线性关系，并在截断处精确地消失为零。本任务要求您推导并实现一个平滑的力切换函数，该函数以一种保证在指定的切换窗口内具有二阶连续可导性的方式，将裸库仑力与反应场力混合。然后，您将使用一个简单的一维相对坐标 MD 模型，对这种混合方法对振动光谱的影响进行基准测试。\n\n从第一性原理和以下基本事实出发：\n- 牛顿第二定律：对于两个质量为 $m_1$ 和 $m_2$ 的物体之间的相对坐标 $r(t)$，其折合质量方程为 $\\mu \\,\\ddot{r}(t) = F(r)$，其中折合质量为 $\\mu = \\dfrac{m_1 m_2}{m_1 + m_2}$，$F(r)$ 是沿质心连线的净对力。\n- 库仑力：两个相距为 $r$ 的电荷 $q_1$ 和 $q_2$ 之间的库仑力为 $F_{\\mathrm{C}}(r) = k_e \\dfrac{q_1 q_2}{r^2}$，方向沿质心连线，其中 $k_e = \\dfrac{1}{4\\pi \\varepsilon_0}$。\n- 在具有无限外部介电（导电边界）的反应场方法中，半径为 $r_c$ 的球形腔内的反应场力为 $F_{\\mathrm{RF}}(r) = k_e q_1 q_2 \\left(\\dfrac{1}{r^2} - \\dfrac{r}{r_c^3}\\right)$（当 $r \\le r_c$ 时），而 $F_{\\mathrm{RF}}(r) = 0$（当 $r \\ge r_c$ 时）。该力在 $r = r_c$ 处为零。\n\n您必须：\n1) 在区间 $[r_s, r_c]$ 上推导一个最小阶多项式切换函数 $s(r)$，以确保混合力\n$$\nF_{\\mathrm{blend}}(r) =\n\\begin{cases}\nF_{\\mathrm{C}}(r),  r \\le r_s, \\\\\ns(r)\\,F_{\\mathrm{C}}(r) + \\bigl(1 - s(r)\\bigr)\\,F_{\\mathrm{RF}}(r),  r_s  r  r_c, \\\\\nF_{\\mathrm{RF}}(r),  r \\ge r_c,\n\\end{cases}\n$$\n具有 $C^2$ 连续性，需满足边界条件 $s(r_s) = 1$, $s(r_c) = 0$, $s'(r_s) = 0$, $s'(r_c) = 0$, $s''(r_s) = 0$ 及 $s''(r_c) = 0$。您的推导必须从边界条件出发，并明确给出该多项式。\n\n2) 为一个带有附加谐振键势 $U_{\\mathrm{bond}}(r) = \\dfrac{1}{2} k_b \\left(r - r_0\\right)^2$ 的类双原子系统的相对坐标动力学实现两种力模型：\n- 模型 A（仅库仑力切换）：\n$$\nF_A(r) =\n\\begin{cases}\nF_{\\mathrm{C}}(r),  r \\le r_s, \\\\\ns(r)\\,F_{\\mathrm{C}}(r),  r_s  r  r_c, \\\\\n0,  r \\ge r_c,\n\\end{cases}\n$$\n总力为 $F^{\\mathrm{tot}}_A(r) = F_A(r) - \\dfrac{dU_{\\mathrm{bond}}}{dr}$。\n- 模型 B（库仑力到反应场力混合）：\n$$\nF_B(r) =\n\\begin{cases}\nF_{\\mathrm{C}}(r),  r \\le r_s, \\\\\ns(r)\\,F_{\\mathrm{C}}(r) + \\bigl(1 - s(r)\\bigr)\\,F_{\\mathrm{RF}}(r),  r_s  r  r_c, \\\\\n0,  r \\ge r_c,\n\\end{cases}\n$$\n总力为 $F^{\\mathrm{tot}}_B(r) = F_B(r) - \\dfrac{dU_{\\mathrm{bond}}}{dr}$。\n在两个模型中，均使用您在第 1 部分推导出的相同多项式 $s(r)$。\n\n3) 对于下述每个指定的测试用例，使用速度 Verlet 算法对 $\\mu \\ddot{r}(t) = F^{\\mathrm{tot}}(r)$ 进行积分，初始条件为 $r(0) = r_0 + A$ 和 $\\dot{r}(0) = 0$，总时间为 $T$，均匀时间步长为 $\\Delta t$。记录轨迹 $r(t_n)$，并通过对 $r(t_n)$ 的去均值和汉宁窗加权信号进行离散傅里叶变换来计算振动光谱。确定主导频率 $f_{\\max}$（单边功率谱最大值的位置，不包括零频分量）。对模型 A 和模型 B 都执行此操作，得到 $f_{\\max}^{(A)}$ 和 $f_{\\max}^{(B)}$，并报告频移 $\\Delta f = f_{\\max}^{(B)} - f_{\\max}^{(A)}$。\n\n使用以下常量和单位约定：\n- 真空介电常数 $\\varepsilon_0$（SI单位），基本电荷 $e$（库仑），库仑常数 $k_e$（$\\mathrm{N\\,m^2\\,C^{-2}}$），阿伏伽德罗常数 $N_A$（$\\mathrm{mol^{-1}}$），原子质量单位 $u$（$\\mathrm{kg}$）。\n- 距离单位必须为纳米（nanometers），并在程序内部转换为米（meters）。时间单位必须为皮秒（picoseconds），并转换为秒（seconds）。质量单位为原子质量单位（atomic mass units），并转换为千克（kilograms）。力常数 $k_b$ 以 $\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 给出，必须转换为 $\\mathrm{N\\,m^{-1}}$。电荷以基本电荷 $e$ 的倍数给出。\n- 所有报告的频率均以太赫兹（terahertz, THz）表示，其数值上等于皮秒的倒数，即 $\\mathrm{THz} = \\mathrm{ps}^{-1}$。\n\n测试套件（每个元组列出 $(m_1, m_2, q_1, q_2, k_b, r_0, r_s, r_c, A, \\Delta t, T)$）：\n- 案例 1：$(16, 16, +1, -1, 2000, 0.90, 0.80, 1.00, 0.01, 0.0002, 5.0)$。\n- 案例 2：$(16, 16, +1, -1, 2000, 0.30, 1.60, 2.00, 0.01, 0.0002, 5.0)$。\n- 案例 3：$(12, 12, +1, +1, 1500, 0.95, 0.98, 1.00, 0.01, 0.0002, 5.0)$。\n\n以上所有数值条目均应按先前指定的单位进行解释。\n\n输出规格：\n- 对于每个案例，计算以太赫兹为单位的 $\\Delta f$。您的程序应生成单行输出，其中包含三个结果，以逗号分隔列表的形式包含在方括号中，每个值四舍五入到三位小数，并按案例 1、2 和 3 的顺序排列。例如：$[x_1,x_2,x_3]$。", "solution": "用户提供的问题经评估为**有效**。该问题在科学上是合理的、自洽的且定义明确的。问题中描述的量和关系，如牛顿第二定律、库仑定律、反应场力、速度 Verlet 积分算法以及通过傅里叶变换进行的光谱分析，在计算物理和计算化学领域都是标准且正确的。模拟所需的所有参数均已提供。任务是推导一个切换函数，在分子动力学模拟中实现两种不同的力模型，并分析由此产生的振动动力学差异。\n\n### 第 1 部分：切换函数的推导\n\n主要目标是构建一个切换函数 $s(r)$，在指定范围 $[r_s, r_c]$ 内提供两种力表达式之间的平滑过渡。平滑度由 $C^2$ 连续性要求定义，意味着该函数及其一阶和二阶导数必须是连续的。在切换区域 $r_s  r  r_c$ 中，混合力由 $F_{\\mathrm{blend}}(r) = s(r)F_{\\mathrm{C}}(r) + (1 - s(r))F_{\\mathrm{RF}}(r)$ 给出。\n\n为确保在切换区域边界处的 $C^2$ 连续性，混合力 $F_{\\mathrm{blend}}(r)$ 及其一阶和二阶导数必须在 $r=r_s$ 和 $r=r_c$ 处与相邻的力表达式匹配。\n\n在 $r=r_s$ 处，我们要求 $F_{\\mathrm{blend}}(r_s) = F_{\\mathrm{C}}(r_s)$，$F'_{\\mathrm{blend}}(r_s) = F'_{\\mathrm{C}}(r_s)$ 和 $F''_{\\mathrm{blend}}(r_s) = F''_{\\mathrm{C}}(r_s)$。对 $F_{\\mathrm{blend}}$ 求导并进行项的等价替换，可得到关于 $s(r)$ 的条件：\n1.  $s(r_s) = 1$\n2.  $s'(r_s) = 0$\n3.  $s''(r_s) = 0$\n\n在 $r=r_c$ 处，我们要求 $F_{\\mathrm{blend}}(r_c) = F_{\\mathrm{RF}}(r_c)$，$F'_{\\mathrm{blend}}(r_c) = F'_{\\mathrm{RF}}(r_c)$ 和 $F''_{\\mathrm{blend}}(r_c) = F''_{\\mathrm{RF}}(r_c)$。这同样可得到以下条件：\n4.  $s(r_c) = 0$\n5.  $s'(r_c) = 0$\n6.  $s''(r_c) = 0$\n\n我们寻求一个满足这六个边界条件的最小阶多项式。一个有六个约束条件的多项式必须至少有六个系数，对应于五次多项式。为了简化代数运算，我们定义一个归一化坐标 $x$，将区间 $[r_s, r_c]$ 映射到 $[0, 1]$：\n$$\nx(r) = \\frac{r - r_s}{r_c - r_s}\n$$\n关于 $s(r)$ 的条件转化为关于新多项式 $P(x) = s(r(x))$ 的条件：\n$P(0) = 1$, $P'(0) = 0$, $P''(0) = 0$\n$P(1) = 0$, $P'(1) = 0$, $P''(1) = 0$\n导数通过链式法则相关联，例如 $s'(r) = P'(x) \\frac{dx}{dr} = P'(x) \\frac{1}{r_c - r_s}$。由于 $\\frac{1}{r_c - r_s}$ 是一个非零常数，所以 $s^{(n)}(r)|_{r=r_{s,c}} = 0$ 意味着 $P^{(n)}(x)|_{x=0,1} = 0$。\n\n我们为 $P(x)$ 提出一个五次多项式：\n$$\nP(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + c_2 x^2 + c_1 x + c_0\n$$\n应用在 $x=0$ 处的条件：\n- $P(0) = c_0 = 1$\n- $P'(x) = 5c_5 x^4 + 4c_4 x^3 + 3c_3 x^2 + 2c_2 x + c_1 \\implies P'(0) = c_1 = 0$\n- $P''(x) = 20c_5 x^3 + 12c_4 x^2 + 6c_3 x + 2c_2 \\implies P''(0) = 2c_2 = 0 \\implies c_2 = 0$\n\n至此，$P(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + 1$。应用在 $x=1$ 处的条件：\n- $P(1) = c_5 + c_4 + c_3 + 1 = 0$\n- $P'(1) = 5c_5 + 4c_4 + 3c_3 = 0$\n- $P''(1) = 20c_5 + 12c_4 + 6c_3 = 0$\n\n这构成了一个关于剩余系数 $c_3, c_4, c_5$ 的三元线性方程组。解此方程组得：\n$$\nc_3 = -10, \\quad c_4 = 15, \\quad c_5 = -6\n$$\n因此，归一化坐标下的多项式为：\n$$\nP(x) = -6x^5 + 15x^4 - 10x^3 + 1\n$$\n最终的切换函数 $s(r)$ 可通过代回 $x = (r-r_s)/(r_c-r_s)$ 得到。\n\n### 第 2 部分：模拟方法\n\n双粒子系统的动力学被简化为一个一维问题，由相对坐标 $r(t)$ 的运动方程决定：\n$$\n\\mu \\ddot{r}(t) = F^{\\mathrm{tot}}(r)\n$$\n其中 $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$ 是折合质量，$F^{\\mathrm{tot}}(r)$ 是一维总力。总力是谐振键合力 $F_{\\mathrm{bond}}(r) = -\\frac{d}{dr} U_{\\mathrm{bond}} = -k_b(r-r_0)$ 和静电力之和，静电力在两种模型中定义不同。\n\n**模型 A（仅库仑力切换）：**\n静电力 $F_A(r)$ 是裸库仑力 $F_{\\mathrm{C}}(r) = k_e \\frac{q_1 q_2}{r^2}$ 在截断距离 $r_c$ 处平滑地切换到零。总力为：\n$$\nF^{\\mathrm{tot}}_A(r) =\n\\begin{cases}\nF_{\\mathrm{C}}(r) - k_b(r-r_0),  r \\le r_s \\\\\ns(r) F_{\\mathrm{C}}(r) - k_b(r-r_0),  r_s  r  r_c \\\\\n-k_b(r-r_0),  r \\ge r_c\n\\end{cases}\n$$\n\n**模型 B（库仑力到反应场力混合）：**\n静电力 $F_B(r)$ 是库仑力与反应场力 $F_{\\mathrm{RF}}(r) = k_e q_1 q_2 \\left(\\frac{1}{r^2} - \\frac{r}{r_c^3}\\right)$ 的混合。总力为：\n$$\nF^{\\mathrm{tot}}_B(r) =\n\\begin{cases}\nF_{\\mathrm{C}}(r) - k_b(r-r_0),  r \\le r_s \\\\\n\\left[ s(r)F_{\\mathrm{C}}(r) + (1-s(r))F_{\\mathrm{RF}}(r) \\right] - k_b(r-r_0),  r_s  r  r_c \\\\\n-k_b(r-r_0),  r \\ge r_c\n\\end{cases}\n$$\n请注意，当 $r \\ge r_c$ 时，静电力为零，因为根据问题陈述，$F_{\\mathrm{RF}}(r) = 0$。\n\n运动方程使用速度 Verlet 算法进行数值积分，这是一种在分子动力学中广泛使用的时间可逆和辛积分器。对于时间步长 $\\Delta t$，位置 $r$ 和速度 $v$ 按以下方式更新：\n1.  $v(t + \\frac{\\Delta t}{2}) = v(t) + \\frac{1}{2} a(t) \\Delta t$\n2.  $r(t + \\Delta t) = r(t) + v(t + \\frac{\\Delta t}{2}) \\Delta t$\n3.  $a(t + \\Delta t) = F^{\\mathrm{tot}}(r(t + \\Delta t)) / \\mu$\n4.  $v(t + \\Delta t) = v(t + \\frac{\\Delta t}{2}) + \\frac{1}{2} a(t + \\Delta t) \\Delta t$\n\n模拟对所有物理量均使用国际单位制（SI units），以确保物理上的一致性并避免转换错误。\n\n### 第 3 部分：光谱分析\n\n振动光谱从粒子间距离的时间序列 $r(t_n)$ 中提取。步骤如下：\n1.  **去均值：** 从信号中减去轨迹的平均值 $\\langle r \\rangle$，以分离振荡分量：$r'(t_n) = r(t_n) - \\langle r \\rangle$。此举可从光谱中移除大的零频（DC）分量。\n2.  **加窗：** 将去均值后的信号乘以一个汉宁窗函数。这会将信号的开头和结尾逐渐衰减到零，从而减少因信号时间有限而产生的光谱泄漏伪影。\n3.  **傅里叶变换：** 使用实数快速傅里叶变换（FFT）计算加窗信号的单边功率谱。\n4.  **峰值识别：** 主导振动频率 $f_{\\max}$ 被确定为对应于功率谱最大值的频率，不包括零频分量。\n\n对由模型 A 和模型 B 生成的轨迹都执行此过程，得到频率 $f_{\\max}^{(A)}$ 和 $f_{\\max}^{(B)}$。最终报告的量是频率偏移 $\\Delta f = f_{\\max}^{(B)} - f_{\\max}^{(A)}$，以太赫兹（THz）为单位报告。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import rfft, rfftfreq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the simulation and analysis for each case and prints the final results.\n    \"\"\"\n    \n    # --- Physical Constants (SI Units) ---\n    constants = {\n        'U_TO_KG': 1.66053906660e-27,   # Atomic mass unit to kg\n        'E_TO_C': 1.602176634e-19,     # Elementary charge to Coulomb\n        'NA': 6.02214076e23,           # Avogadro's number (mol^-1)\n        'KE': 8.9875517923e9           # Coulomb's constant (N m^2 C^-2)\n    }\n\n    # --- Test Cases ---\n    # Tuple format: (m1, m2, q1, q2, k_b, r_0, r_s, r_c, A, dt, T)\n    # Units: u, u, e, e, kJ/mol/nm^2, nm, nm, nm, nm, ps, ps\n    test_cases = [\n        (16.0, 16.0, 1.0, -1.0, 2000.0, 0.90, 0.80, 1.00, 0.01, 0.0002, 5.0),\n        (16.0, 16.0, 1.0, -1.0, 2000.0, 0.30, 1.60, 2.00, 0.01, 0.0002, 5.0),\n        (12.0, 12.0, 1.0, 1.0, 1500.0, 0.95, 0.98, 1.00, 0.01, 0.0002, 5.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_f = calculate_delta_f(case, constants)\n        results.append(f\"{delta_f:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_delta_f(case_params, constants):\n    \"\"\"\n    Calculates the frequency shift Delta f = f_max(B) - f_max(A) for a single test case.\n    All internal calculations are performed in SI units.\n    \"\"\"\n    # --- Unpack parameters and convert to SI units ---\n    m1_u, m2_u, q1_e, q2_e, kb_spec, r0_nm, rs_nm, rc_nm, A_nm, dt_ps, T_ps = case_params\n    \n    U_TO_KG = constants['U_TO_KG']\n    E_TO_C = constants['E_TO_C']\n    NA = constants['NA']\n    KE = constants['KE']\n\n    mu = (m1_u * m2_u) / (m1_u + m2_u) * U_TO_KG\n    q1q2 = (q1_e * E_TO_C) * (q2_e * E_TO_C)\n    kb = kb_spec * (1000.0 / NA) / (1e-9)**2  # kJ/mol/nm^2 -> N/m\n    r0 = r0_nm * 1e-9\n    rs = rs_nm * 1e-9\n    rc = rc_nm * 1e-9\n    A = A_nm * 1e-9\n    dt = dt_ps * 1e-12\n    T = T_ps * 1e-12\n    \n    # --- Define force models ---\n\n    def switching_function(r, rs_loc, rc_loc):\n        if r = rs_loc:\n            return 1.0\n        if r >= rc_loc:\n            return 0.0\n        x = (r - rs_loc) / (rc_loc - rs_loc)\n        # P(x) = -6x^5 + 15x^4 - 10x^3 + 1\n        return -6.0 * x**5 + 15.0 * x**4 - 10.0 * x**3 + 1.0\n\n    def total_force_A(r):\n        force_bond = -kb * (r - r0)\n        \n        force_elec = 0.0\n        if r > 1e-14: # Avoid singularity at r=0\n            f_coulomb = KE * q1q2 / r**2\n            if r = rs:\n                force_elec = f_coulomb\n            elif r  rc:\n                s_val = switching_function(r, rs, rc)\n                force_elec = s_val * f_coulomb\n        return force_bond + force_elec\n\n    def total_force_B(r):\n        force_bond = -kb * (r - r0)\n        \n        force_elec = 0.0\n        if r > 1e-14: # Avoid singularity\n            f_coulomb = KE * q1q2 / r**2\n            # Reaction field force with conducting boundary\n            f_rf = f_coulomb - (KE * q1q2 * r / rc**3)\n            \n            if r = rs:\n                force_elec = f_coulomb\n            elif r  rc:\n                s_val = switching_function(r, rs, rc)\n                force_elec = s_val * f_coulomb + (1.0 - s_val) * f_rf\n        return force_bond + force_elec\n\n    # --- Run simulations and analyze spectra ---\n    r_initial = r0 + A\n    v_initial = 0.0\n\n    traj_A = run_simulation(total_force_A, mu, r_initial, v_initial, T, dt)\n    f_max_A = analyze_spectrum(traj_A, dt)\n\n    traj_B = run_simulation(total_force_B, mu, r_initial, v_initial, T, dt)\n    f_max_B = analyze_spectrum(traj_B, dt)\n\n    # Convert final result from Hz to THz for reporting\n    delta_f_THz = (f_max_B - f_max_A) / 1e12\n    return delta_f_THz\n\ndef run_simulation(force_func, mass, r_init, v_init, T, dt):\n    \"\"\"\n    Runs a 1D MD simulation using the Velocity Verlet algorithm.\n    Returns the trajectory of the relative coordinate r.\n    \"\"\"\n    num_steps = int(round(T / dt))\n    r = r_init\n    v = v_init\n    \n    trajectory = np.zeros(num_steps)\n    \n    force = force_func(r)\n    acc = force / mass\n    \n    for i in range(num_steps):\n        trajectory[i] = r\n        \n        v_half = v + 0.5 * acc * dt\n        r = r + v_half * dt\n        force = force_func(r)\n        acc = force / mass\n        v = v_half + 0.5 * acc * dt\n        \n    return trajectory\n\ndef analyze_spectrum(trajectory, dt):\n    \"\"\"\n    Computes the dominant vibrational frequency from a trajectory using FFT.\n    \"\"\"\n    n_samples = len(trajectory)\n    if n_samples  2:\n        return 0.0\n    \n    signal = trajectory - np.mean(trajectory)\n    windowed_signal = signal * np.hanning(n_samples)\n    \n    yf = rfft(windowed_signal)\n    xf = rfftfreq(n_samples, dt)\n    \n    power_spectrum = np.abs(yf)**2\n    \n    # Exclude the DC component at index 0\n    if len(power_spectrum) > 1:\n        max_power_idx = np.argmax(power_spectrum[1:]) + 1\n        dominant_freq = xf[max_power_idx]\n    else:\n        dominant_freq = 0.0\n        \n    return dominant_freq\n\nsolve()\n```", "id": "3441052"}]}