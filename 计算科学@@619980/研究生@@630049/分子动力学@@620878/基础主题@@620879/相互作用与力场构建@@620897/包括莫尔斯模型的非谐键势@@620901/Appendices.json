{"hands_on_practices": [{"introduction": "在分子建模中，一个关键步骤是利用高保真数据（通常来自量子化学计算）来参数化势能函数。本练习旨在挑战您思考如何从一个精简但物理意义明确的数据集中，稳健地确定莫尔斯势的三个参数（$D_e$、$a$ 和 $r_e$）。这项实践将加深您对势函数形态与其物理可观测量之间联系的理解[@problem_id:3395888]。", "problem": "分子动力学 (MD) 力场中的一个双原子键将由摩尔斯非谐势表示，其约定为能量在最小值处为零，解离能为渐近极限，因此势能函数为 $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2,$$ 其中 $$V(r_e)=0$$ 且 $$V(\\infty)=D_e$$。您从电子结构计算中获得了三个高质量的量：(i) 最小值处的曲率，定义为 $$k_e=V''(r_e),$$ 通过围绕平衡结构的简正模式分析获得；(ii) 一个标记为大拉伸的能量点，即对于一个具有显著伸长的几何构型 $$r_sr_e$$，有 $$E_s=V(r_s)$$；以及 (iii) 解离能 $$D_e,$$ 定义为最小值与解离极限之间的能量差。假设电子结构能量处于相同的绝对参考系上，使得最小值在 $$r=r_e$$ 處始终为零。下面哪个方案正确地使用了这三个输入来唯一确定 $$\\left(D_e,a,r_e\\right)$$，并为数值稳健性提供了合理的论证？\n\nA. 使用曲率通过 $$a=\\sqrt{\\dfrac{k_e}{2D_e}}$$ 来确定范围参数；然后通过强制拉伸点的能量 $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2$$ 来恢复平衡距离，解得 $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right),$$ 选择单调吸引分支，其中 $0  \\sqrt{E_s/D_e}  1$。保持 $$D_e$$ 等于所提供的解离能。稳健性论证：最小值附近的曲率独立于 $$r_e$$ 约束了 $$a$$，远离平衡点的拉伸点打破了困扰纯粹近平衡拟合中 $$a$$ 和 $$r_e$$ 之间的强相关性，用 $$D_e$$ 固定渐近线强制了物理行为；选择的 $$E_s$$ 不要太接近 $$0$$ 或 $$D_e$$，可以避免对数病态问题。\n\nB. 使用线性关系 $$a=\\dfrac{k_e}{D_e}$$ 从曲率确定范围参数；然后通过写入 $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$ 来使用拉伸点能量，并求解平衡距离为 $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right)$$。保持 $$D_e$$ 等于所提供的解离能。稳健性论证：对 $$a$$ 使用线性映射避免了平方误差，而单个对数使灵敏度保持在较低水平。\n\nC. 通过非线性最小二乘法将 $$a$$ 和 $$D_e$$ 拟合到两个拉伸点 $$\\left(r_{s1},E_{s1}\\right)$$ 和 $$\\left(r_{s2},E_{s2}\\right)$$，同时将 $$r_e$$ 固定在使计算能量最小化的几何构型上。仅将曲率 $$k_e$$ 用作后验一致性检查，并在必要时进行调整。稳健性论证：两个远点锚定了渐近线和尾部形状，而最小能量点的几何构型可直接从电子结构扫描中获得。\n\nD. 设定 $$D_e=E_s$$ 并假设 $$r_e=r_s$$，因为最小值在计算的几何构型上定义了能量零点。然后通过使用 $$k_e\\approx V''(r_s)$$ 的有限差分法估计 $$r_s$$ 周围的曲率，并强制 $$a=\\sqrt{k_e/(2D_e)}$$。稳健性论证：将最小值和拉伸点置于同一位置减少了参数相关性，并且根据构造，解离能等于观测到的远拉伸能量。", "solution": "用户要求对关于摩尔斯势参数化的问题陈述进行严格验证，然后给出完整解法并评估所提供的选项。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n\n问题陈述提供了以下明确信息：\n1.  **势能函数**：摩尔斯势，$$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$。\n2.  **能量约定**：势能在最小值处为零，$$V(r_e)=0$$，解离能为渐近极限，$$V(\\infty)=D_e$$。\n3.  **来自电子结构计算的输入数据**：\n    (i) 最小值处的曲率，$$k_e=V''(r_e)$$。\n    (ii) 一个大拉伸处的能量点，$$E_s=V(r_s)$$，其中几何构型为 $$r_sr_e$$。\n    (iii) 解离能，$$D_e$$。\n4.  **能量参考**：能量最小值始终为零，$$V(r_e)=0$$。\n5.  **目标**：找到一个能正确使用这三个输入来唯一确定参数 $$\\left(D_e,a,r_e\\right)$$ 的方案，并为数值稳健性提供合理的论证。\n\n**步骤2：使用提取的已知条件进行验证**\n\n根据所需标准对问题进行评估：\n-   **科学依据**：摩尔斯势是描述双原子分子势能的一个标准且具有物理意义的模型，广泛用于光谱学和分子动力学。量 $$D_e$$（解离能）、$$r_e$$（平衡键长）和 $$k_e$$（最小值处的谐性力常数）是化学键的基本性质。该问题牢固地植根于物理化学和计算物理学的既定原理。\n-   **适定性**：该问题要求一个确定三个参数（$$D_e$$、$$a$$ 和 $$r_e$$）的方案。它提供了三个不同的信息：一个 $$D_e$$ 的值，一个 $$k_e$$ 的值，以及一个能量-距离对 $$(r_s, E_s)$$。问题暗示输入的 $$D_e$$ 值将直接用于参数 $$D_e$$，剩下两个未知数 $$a$$ 和 $$r_e$$ 由剩下的两个约束条件 $$k_e=V''(r_e)$$ 和 $$E_s=V(r_s)$$ 来确定。对于两个方程和两个未知数，该系统原则上是可解的。唯一性和数值稳健性的问题是参数拟合中的标准考虑因素，这使得该问题结构良好。\n-   **客观性**：该问题使用精确、无歧义的科学语言陈述。所有术语，如“最小值处的曲率”和“解离能”，在该领域内都有清晰、普遍接受的定义。\n\n该问题没有表现出科学或事实上的不健全性，不是隐喻性的，不是不完整或矛盾的，没有假定不切实际的条件，不是病态的，也并非微不足道。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。这项任务是化学物理学中一个标准的参数化练习，既需要正确的数学推导，也需要对数值稳定性的理解。我现在将进行求解。\n\n**正确方案的推导**\n\n目标是在给定 $$D_e$$、$$k_e=V''(r_e)$$ 和一个点 $$(r_s, E_s)$$（其中 $$r_s  r_e$$）的情况下，确定摩尔斯势 $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$ 的参数 $$a$$ 和 $$r_e$$。\n\n首先，我们建立曲率 $$k_e$$ 和势参数之间的关系。这需要计算 $$V(r)$$ 对 $$r$$ 的二阶导数。\n\n一阶导数是：\n$$ V'(r) = \\frac{d}{dr} \\left[ D_e\\left(1-e^{-a(r-r_e)}\\right)^2 \\right] $$\n$$ V'(r) = D_e \\cdot 2\\left(1-e^{-a(r-r_e)}\\right) \\cdot \\frac{d}{dr}\\left(1-e^{-a(r-r_e)}\\right) $$\n$$ V'(r) = 2D_e\\left(1-e^{-a(r-r_e)}\\right) \\left(-e^{-a(r-r_e)} \\cdot (-a)\\right) $$\n$$ V'(r) = 2aD_e \\left(1-e^{-a(r-r_e)}\\right)e^{-a(r-r_e)} = 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) $$\n在最小值 $$r=r_e$$ 处，我们有 $$V'(r_e)=2aD_e(e^0 - e^0) = 0$$，这与平衡点一致。\n\n二阶导数是：\n$$ V''(r) = \\frac{d}{dr} \\left[ 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) \\right] $$\n$$ V''(r) = 2aD_e \\left(-a e^{-a(r-r_e)} - (-2a) e^{-2a(r-r_e)}\\right) $$\n$$ V''(r) = 2a^2D_e \\left(2e^{-2a(r-r_e)} - e^{-a(r-r_e)}\\right) $$\n\n最小值处的曲率 $$k_e$$ 是 $$V''(r_e)$$：\n$$ k_e = V''(r_e) = 2a^2D_e \\left(2e^0 - e^0\\right) = 2a^2D_e(2-1) = 2a^2D_e $$\n从这个精确关系中，我们可以解出参数 $$a$$：\n$$ a^2 = \\frac{k_e}{2D_e} $$\n由于 $$a$$ 是代表势阱宽度的物理参数，它必须为正。因此，我们取主根：\n$$ a = \\sqrt{\\frac{k_e}{2D_e}} $$\n这个方程使用提供的两个高质量输入 $$k_e$$ 和 $$D_e$$ 来确定参数 $$a$$。\n\n接下来，我们使用第三个输入，即能量点 $$(r_s, E_s)$$，来确定剩下的参数 $$r_e$$。定义方程是：\n$$ E_s = V(r_s) = D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\n我们求解 $$r_e$$。参数 $$a$$ 在上一步中已被视为已知。\n$$ \\frac{E_s}{D_e} = \\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\n两边取平方根得到：\n$$ \\pm\\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\n我们必须选择正确的符号。问题陈述 $$r_sr_e$$，这意味着键被拉伸。对于正参数 $$a$$，指数 $$-a(r_s-r_e)$$ 是负的。因此，$$0  e^{-a(r_s-r_e)}  1$$。这意味着 $$1-e^{-a(r_s-r_e)}$$ 这一项是正的。因此，我们必须取正根：\n$$ \\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\n此外，由于 $$r_s$$ 是束缚势上的一个点，$$0  E_s  D_e$$，这确保了 $$0  \\sqrt{E_s/D_e}  1$$，并且后续的对数将是对一个正数取值。\n\n重新整理以求解指数项：\n$$ e^{-a(r_s-r_e)} = 1 - \\sqrt{\\frac{E_s}{D_e}} $$\n两边取自然对数：\n$$ -a(r_s-r_e) = \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\n最后，求解 $$r_e$$：\n$$ r_s - r_e = -\\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\n$$ r_e = r_s + \\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\n这个结果根据输入提供了一个 $$r_e$$ 的唯一公式。因此，该方案是解析确定的。\n\n**选项评估**\n\n**选项 A：**\n描述的方案是：\n1.  $$a=\\sqrt{\\dfrac{k_e}{2D_e}}$$\n2.  $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right)$$，条件为 $$0  \\sqrt{E_s/D_e}  1$$。\n3.  $$D_e$$ 取自输入。\n\n这个方案与上面的推导完全匹配。选项中提供的论证也是合理的。关系式 $$k_e=2a^2D_e$$ 确实在不参考 $$r_e$$ 的情况下约束了 $$a$$。使用远离最小值 ($$r_e$$) 的数据点 $$(r_s, E_s)$$ 是一种避免参数相关性的标准技术，这种相关性在仅拟合近平衡数据时会出现。最后，数值稳健性的分析是正确的：如果对数函数的参数趋近于零，函数就会出现病态，这种情况发生在 $$E_s \\to D_e$$ 时。如果 $$E_s \\to 0$$，数据点提供的信息与来自 $$k_e$$ 的信息是冗余的，这是一个虽不那么严重但仍然相关的问题。\n- **结论**：正确。\n\n**选项 B：**\n描述的方案是：\n1.  $$a=\\dfrac{k_e}{D_e}$$\n2.  $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$\n3.  $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right)$$\n\n这个选项有根本性的缺陷。$$a$$、$$k_e$$ 和 $$D_e$$ 之间的关系是 $$k_e = 2a^2D_e$$，而不是 $$k_e = aD_e$$。所提出的 $$a$$ 的公式在数学上是错误的。此外，势能被表述为 $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$，这在括号项上缺少平方，与问题陈述中提供的摩尔斯势的定义相矛盾。$$r_e$$ 的表达式是从这个不正确的势能形式推导出来的。整个方案都基于不正确的数学关系。\n- **结论**：错误。\n\n**选项 C：**\n描述的方案是：\n1.  通过非线性最小二乘法将 $$a$$ 和 $$D_e$$ 拟合到**两个**拉伸点。\n2.  将 $$r_e$$ 固定在计算确定的最小值处。\n3.  仅将 $$k_e$$ 用作后验检查。\n\n这个方案与问题陈述不一致。问题提供了一个拉伸点 $$(r_s, E_s)$$，而不是两个。它还提供了 $$D_e$$ 和 $$k_e$$ 作为用于参数化的高质量输入，而不是作为检查或待拟合的值。此选项描述了一个完全不同的参数化过程，忽略了指定的输入。\n- **结论**：错误。\n\n**选项 D：**\n描述的方案是：\n1.  设定 $$D_e=E_s$$ 和 $$r_e=r_s$$。\n2.  估计 $$k_e \\approx V''(r_s)$$。\n3.  使用 $$a=\\sqrt{k_e/(2D_e)}$$。\n\n这个方案基于物理上和数学上荒谬的前提。\n-   $$D_e=E_s$$：解离能 $$D_e$$ 是无限分离时的能量，是束缚态可能的最大势能。$$E_s$$ 是在有限分离距离 $$r_s$$ 处的能量。对于任何有限的拉伸，$$E_s  D_e$$。将它们相等是一个根本性错误。\n-   $$r_e=r_s$$：$$r_e$$ 是能量最小的平衡键长 ($$V(r_e)=0$$)。$$r_s$$ 是一个“显著伸长”的点，其能量 $$E_s  0$$。将它们等同是与问题设置和物理现实的直接矛盾。\n-   $$k_e\\approx V''(r_s)$$：$$k_e$$ 定义为*最小值处* ($$r_e$$) 的曲率，而不是在拉伸位置 $$r_s$$。摩尔斯势的曲率不是恒定的。\n\n所提供的论证是无稽之谈，因为它建立在这些谬误之上。\n- **结论**：错误。", "answer": "$$\\boxed{A}$$", "id": "3395888"}, {"introduction": "有了参数化的势函数后，下一步便是在模拟中使用它。一个关键选择是积分时间步长，它受限于系统中最快的运动。本练习将演示如何从势函数在平衡点的曲率推导出时间步长的上限，为确保分子动力学模拟的数值稳定性提供了一条基本准则[@problem_id:3395859]。", "problem": "考虑在分子动力学 (MD) 模拟中，一个由莫尔斯势 $U(r) = D_e \\left(1 - \\exp\\!\\left(-a \\left(r - r_e\\right)\\right)\\right)^{2}$ 建模的单双原子键，其中 $D_e$ 是解离能，$a$ 是范围参数，$r_e$ 是平衡键长。令 $x = r - r_e$ 表示偏离平衡位置的位移，$m$ 表示成键对的折合质量。假设使用速度-Verlet 积分法，并采用标准的小振幅精度要求，即时间步长 $\\Delta t$ 必须满足 $\\Delta t\\,\\omega \\ll 1$，其中 $\\omega$ 是与轨迹相关的最快局部振动角频率。通过强制执行 $\\Delta t\\,\\omega_{\\max} = \\eta$ 来实现这一要求，其中 $\\eta$ 是一个选定的无量纲安全因子。\n\n仅从牛顿第二定律和莫尔斯势的定义出发，推导关于 $x=0$ 的小振幅振动角频率，并用它来获得最大时间步长 $\\Delta t_{\\max}$ 关于 $m$、$D_e$、$a$ 和 $\\eta$ 的解析表达式。然后，使用以下符合物理实际的参数，数值计算 $\\Delta t_{\\max}$：\n- $D_e = 4.5\\,\\mathrm{eV}$，\n- $a = 2.0\\,\\mathrm{\\AA}^{-1}$，\n- $m = 0.923\\,\\mathrm{amu}$，\n- $\\eta = 0.10$。\n\n使用精确换算关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$，$1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，以及 $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。将 $\\Delta t_{\\max}$ 的最终数值答案以飞秒为单位表示，并四舍五入到四位有效数字。\n\n最后，基于莫尔斯势的二阶导数 $U''(x)$，简要论证当振动振幅在键拉伸侧 ($x0$) 与键压缩侧 ($x0$) 增加时，容许的时间步长 $\\Delta t$ 预计会如何变化。对于此定性分析部分，不要计算任何额外的数值。", "solution": "该问题陈述具有科学依据，提法恰当且客观。它是一个计算物理学中的标准练习，围绕莫尔斯势、牛顿定律和分子动力学中的数值稳定性准则展开。所有必要的参数均已提供，所需的推导和计算都是形式化的。因此，该问题是有效的。\n\n解答按要求分三部分进行：首先，推导小振幅振动频率；其次，推导和数值计算最大时间步长；第三，对时间步长与振动振幅的依赖关系进行定性分析。\n\n莫尔斯势作为位移 $x = r - r_e$ 的函数，由下式给出：\n$$U(x) = D_e \\left(1 - \\exp(-ax)\\right)^2$$\n作用在折合质量 $m$ 上的力是 $F(x) = -dU/dx$。对于围绕平衡点 $x=0$ 的小振幅振荡，该系统表现为简谐振子。势能可以在 $x=0$ 附近通过泰勒级数展开进行近似：\n$$U(x) = U(0) + U'(0)x + \\frac{1}{2}U''(0)x^2 + \\mathcal{O}(x^3)$$\n在平衡位置，势能处于最小值，因此 $U(0) = 0$ 且力 $F(0)=-U'(0)=0$。对于小位移，势能是谐和的：\n$$U(x) \\approx \\frac{1}{2}kx^2$$\n其中等效弹簧常数 $k$ 由势能在平衡位置的二阶导数给出，$k = U''(0)$。\n\n首先，我们求一阶导数 $U'(x)$：\n$$U'(x) = \\frac{d}{dx} \\left[ D_e \\left(1 - 2\\exp(-ax) + \\exp(-2ax)\\right) \\right] = 2aD_e \\left(\\exp(-ax) - \\exp(-2ax)\\right)$$\n接下来，我们求二阶导数 $U''(x)$：\n$$U''(x) = \\frac{d}{dx} \\left[ 2aD_e \\left(\\exp(-ax) - \\exp(-2ax)\\right) \\right] = 2a^2D_e \\left(2\\exp(-2ax) - \\exp(-ax)\\right)$$\n在 $x=0$ 处求值，得到弹簧常数 $k$：\n$$k = U''(0) = 2a^2D_e \\left(2\\exp(0) - \\exp(0)\\right) = 2a^2D_e(2 - 1) = 2a^2D_e$$\n那么，小振幅（最高）振动角频率 $\\omega_{\\max}$ 为：\n$$\\omega_{\\max} = \\sqrt{\\frac{k}{m}} = \\sqrt{\\frac{2a^2D_e}{m}} = a\\sqrt{\\frac{2D_e}{m}}$$\n速度-Verlet 积分器的稳定性条件实现为 $\\Delta t_{\\max}\\omega_{\\max} = \\eta$。求解最大时间步长 $\\Delta t_{\\max}$，得到解析表达式：\n$$\\Delta t_{\\max} = \\frac{\\eta}{\\omega_{\\max}} = \\frac{\\eta}{a\\sqrt{\\frac{2D_e}{m}}} = \\frac{\\eta}{a}\\sqrt{\\frac{m}{2D_e}}$$\n现在我们对此表达式进行数值计算。给定的参数必须转换为国际单位制（SI）基本单位：\n$D_e = 4.5\\,\\mathrm{eV} = 4.5 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) = 7.209794853 \\times 10^{-19}\\,\\mathrm{J}$\n$a = 2.0\\,\\mathrm{\\AA}^{-1} = 2.0 \\times (1.0 \\times 10^{-10}\\,\\mathrm{m})^{-1} = 2.0 \\times 10^{10}\\,\\mathrm{m}^{-1}$\n$m = 0.923\\,\\mathrm{amu} = 0.923 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.532777558... \\times 10^{-27}\\,\\mathrm{kg}$\n$\\eta = 0.10$\n\n将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\\Delta t_{\\max} = \\frac{0.10}{2.0 \\times 10^{10}\\,\\mathrm{m}^{-1}} \\sqrt{\\frac{1.532777... \\times 10^{-27}\\,\\mathrm{kg}}{2 \\times (7.209794853 \\times 10^{-19}\\,\\mathrm{J})}}$$\n$$\\Delta t_{\\max} = (5.0 \\times 10^{-12}\\,\\mathrm{m}) \\sqrt{1.063004... \\times 10^{-9}\\,\\mathrm{s}^2 \\cdot \\mathrm{m}^{-2}}$$\n$$\\Delta t_{\\max} = (5.0 \\times 10^{-12}\\,\\mathrm{m}) \\times (3.260374... \\times 10^{-5}\\,\\mathrm{s} \\cdot \\mathrm{m}^{-1})$$\n$$\\Delta t_{\\max} = 1.630187... \\times 10^{-16}\\,\\mathrm{s}$$\n要将其以飞秒（$1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$）表示：\n$$\\Delta t_{\\max} = (1.630187... \\times 10^{-16}\\,\\mathrm{s}) \\times \\frac{1\\,\\mathrm{fs}}{10^{-15}\\,\\mathrm{s}} = 0.1630187...\\,\\mathrm{fs}$$\n四舍五入到四位有效数字，数值答案是 $0.1630\\,\\mathrm{fs}$。\n\n最后，进行定性论证。容许的时间步长 $\\Delta t$ 与局部频率成反比，$\\Delta t(x) \\propto 1/\\omega(x)$。局部频率由势能的局部曲率决定，$\\omega(x) \\approx \\sqrt{U''(x)/m}$。因此，$\\Delta t(x) \\propto 1/\\sqrt{U''(x)}$。\n- 键拉伸侧 ($x0$)：随着 $x$ 增大，曲率 $U''(x) = 2a^2D_e \\left(2\\exp(-2ax) - \\exp(-ax)\\right)$ 减小，因为势能“软化”并接近解离平台。较小的 $U''(x)$ 意味着较低的局部频率，这允许使用一个较大的容许时间步长 $\\Delta t$。\n- 键压缩侧 ($x0$)：随着 $x$ 变得更负，项 $-ax$ 变得很大且为正。指数项 $\\exp(-2ax)$ 和 $\\exp(-ax)$ 迅速增长，其中 $\\exp(-2ax)$ 项占主导地位。这导致曲率 $U''(x)$ 急剧增加，代表了势能的陡峭排斥壁。大得多的 $U''(x)$ 意味着高得多的局部频率，这要求一个较小的容许时间步长 $\\Delta t$。\n因此，在键拉伸期间，容许的 $\\Delta t$ 预计会增加，而在键压缩期间则会急剧减小。模拟的总体时间步长必须保守地选择，以解析遇到的最高频率，该频率出现在最大压缩点。", "answer": "$$\\boxed{0.1630}$$", "id": "3395859"}, {"introduction": "我们为何要使用非谐势？本练习将探讨其最重要的物理效应之一：热膨胀。通过计算热系综中的平均键长，您将直接观察到莫尔斯势的不对称性如何导致键长在非零温度下增加，而这正是谐振子模型完全无法描述的现象[@problem_id:3395887]。", "problem": "考虑一个在分子动力学（MD）中使用的，由非谐莫尔斯势控制的经典双原子键坐标。势能是键长 $r$（核间距）的函数，由 $U_{M}(r)$ 给出。在温度 $T$ 下的正则系综中，每个构型的概率密度与 $\\exp(-\\beta U_{M}(r))$ 成正比，其中 $\\beta = 1/(k_{B} T)$，$k_{B}$ 是玻尔兹曼常数。正则平均键长由键长域上两个积分的比值定义。您的任务是针对几组指定的参数集，数值计算这个正则平均值，然后量化其相对于平衡键长的非谐位移。\n\n从基础的统计力学原理出发：正则概率密度与 $\\exp(-\\beta U(r))$ 成正比，以及系综平均的定义，即构型空间上的归一化积分。仅使用这些原理和给定的势函数作为您推导和算法设计的基础。\n\n莫尔斯势为\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a\\,(r - r_{e})}\\right)^{2},\n$$\n其中 $D_{e}$ 是势阱深度，$a$ 设定了势阱的逆长度标度，$r_{e}$ 是平衡键长。正则平均键长为\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}.\n$$\n\n重要的物理和数值考量：\n- 在没有额外约束的情况下，对于莫尔斯势，对 $r$ 积分到 $+\\infty$ 是不可归一化的，因为当 $r \\to \\infty$ 时，$U_{M}(r) \\to D_{e}$，这导致玻尔兹曼因子不趋于零。在实际的分子动力学中，解离或有限的分子环境限制了可及的 $r$。为了在远低于解离尺度的温度 $T$ 下获得一个明确定义的、具有物理意义的束缚态平均值，需将积分限制在一个有限区间 $[r_{\\min}, r_{\\max}]$ 内。该区间通过玻尔兹曼权重容差和上限值自适应地选择：\n  - 定义容差 $\\tau = 10^{-12}$ 和右侧上限 $L_{\\text{cap}} = 10\\,\\text{\\AA}$。\n  - 计算能量阈值 $U_{\\text{th}} = -k_{B} T \\ln \\tau$。\n  - 找到 $r_{\\text{L}} \\in (0, r_{e})$ 使得 $U_{M}(r_{\\text{L}}) = U_{\\text{th}}$，并设置 $r_{\\min} = \\max(0, r_{\\text{L}})$。\n  - 尝试在 $(r_{e}, r_{e} + L_{\\text{cap}})$ 区间内找到 $r_{\\text{R}}$ 使得 $U_{M}(r_{\\text{R}}) = U_{\\text{th}}$。如果存在这样的 $r_{\\text{R}}$，则设置 $r_{\\max} = r_{\\text{R}}$；否则，设置 $r_{\\max} = r_{e} + L_{\\text{cap}}$。\n  - 这样就构建了一个适用于束缚态占主导地位的温度 $T$ 下的受限正则平均。您的数值方法应能稳健地处理 $U_{\\text{th}}  D_{e}$ 和 $U_{\\text{th}} \\ge D_{e}$ 两种情况。\n\n程序要求：\n- 使用 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n- 单位：\n  - 能量 $D_{e}$ 必须以焦耳（Joules）为单位。\n  - 温度 $T$ 必须以开尔文（Kelvin）为单位。\n  - 长度 $r$ 和 $r_{e}$ 必须以埃（$\\text{\\AA}$）为单位。\n  - 逆长度参数 $a$ 必须以 $\\text{\\AA}^{-1}$ 为单位。\n- 计算在 $[r_{\\min}, r_{\\max}]$ 上的受限正则平均值 $\\langle r \\rangle$ 和非谐位移 $\\Delta = \\langle r \\rangle - r_{e}$。将 $\\langle r \\rangle$ 和 $\\Delta$ 均以埃（Angstroms）表示。\n- 数值积分必须足够精确，以满足高阶研究生水平的分析要求；请使用带有严格容差的自适应求积方法。\n\n测试套件：\n对于以下每一组参数 $(D_{e}, a, r_{e}, T)$，计算 $\\langle r \\rangle$ 和 $\\Delta$：\n1. $D_{e} = 8.000 \\times 10^{-19}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 300\\,\\mathrm{K}$。\n2. $D_{e} = 8.000 \\times 10^{-20}\\,\\mathrm{J}$, $a = 1.5\\,\\text{\\AA}^{-1}$, $r_{e} = 1.5\\,\\text{\\AA}$, $T = 600\\,\\mathrm{K}$。\n3. $D_{e} = 1.1215 \\times 10^{-18}\\,\\mathrm{J}$, $a = 4.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 50\\,\\mathrm{K}$。\n4. $D_{e} = 4.8065 \\times 10^{-20}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.2\\,\\text{\\AA}$, $T = 1000\\,\\mathrm{K}$。\n\n算法输出：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。\n- 对于每个测试用例，该列表应按顺序包含以埃为单位的正则平均值 $\\langle r \\rangle$，然后是以埃为单位的位移 $\\Delta$。因此，对于四个测试用例，输出必须包含八个浮点数：\n$$\n[\\langle r \\rangle_{1}, \\Delta_{1}, \\langle r \\rangle_{2}, \\Delta_{2}, \\langle r \\rangle_{3}, \\Delta_{3}, \\langle r \\rangle_{4}, \\Delta_{4}]\n$$\n所有长度均以埃为单位。", "solution": "问题陈述已经过严格验证，被认为是一个有效的科学问题。它在科学上基于经典统计力学的原理，在数学上是适定的，具有明确且完整的给定条件，并以客观、正式的语言表述。其中没有矛盾、模糊或事实错误。该任务是计算物理学中一个标准但并非无足轻重的练习。因此，我们可以着手解决。\n\n问题要求计算一个双原子分子的正则平均键长 $\\langle r \\rangle$，其势能 $U_{M}(r)$ 由莫尔斯势描述。该势的非谐性，即其与简单二次（谐振）形式的偏离，导致平均键长相对于势能最小值点 $r_{e}$ 发生随温度变化的位移。我们的目标是计算这个平均键长及相应的位移 $\\Delta = \\langle r \\rangle - r_{e}$。\n\n基本原理是，在温度为 $T$ 的正则系综中，系统处于键长 $r$ 的概率密度 $p(r)$ 与玻尔兹曼因子 $e^{-\\beta U(r)}$ 成正比，其中 $\\beta = 1/(k_{B}T)$，$k_{B}$ 是玻尔兹曼常数。\n$$\np(r) = \\frac{e^{-\\beta U_{M}(r)}}{Z}\n$$\n归一化常数 $Z$，即此一维构型空间的配分函数，由玻尔兹曼因子在所有可能键长上的积分给出：\n$$\nZ = \\int e^{-\\beta U_{M}(r)} \\, dr\n$$\n任何可观测量 $A(r)$ 的正则平均值则通过其概率加权积分计算得出：\n$$\n\\langle A \\rangle = \\int A(r) p(r) \\, dr = \\frac{\\int A(r) e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\n对于本问题，可观测量是键长本身，即 $A(r) = r$。因此，我们必须计算：\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\n莫尔斯势由以下公式给出：\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2}\n$$\n其中 $D_{e}$ 是解离能（势阱深度），$a$ 是控制势阱宽度的参数，$r_{e}$ 是对应于最小能量 $U_{M}(r_e) = 0$ 的平衡键长。\n\n一个关键问题来自积分的定义域。当 $r \\to \\infty$ 时，$e^{-a(r-r_e)}$ 项趋于 0，因此 $U_{M}(r) \\to D_{e}$。被积函数 $e^{-\\beta U_{M}(r)}$ 趋于一个非零常数 $e^{-\\beta D_{e}}$。一个函数在无穷域上若趋于一个正常数，其积分是发散的。这反映了物理现实：在没有其他约束的情况下，存在有限的解离概率。该问题通过为束缚态定义一个受限的正则平均来规避此问题。这在温度 $T$ 满足 $k_{B}T \\ll D_{e}$ 的情况下是物理上合理的，因为能量接近或高于 $D_{e}$ 的态极不可能出现。积分域被截断为一个区间 $[r_{\\min}, r_{\\max}]$，在该区间的边界上，玻尔兹曼因子根据给定的容差 $\\tau = 10^{-12}$ 而变得极小。\n\n确定积分边界 $[r_{\\min}, r_{\\max}]$ 的算法如下：\n1.  计算能量阈值 $U_{\\text{th}} = -k_{B} T \\ln \\tau$。这是玻尔兹曼权重 $e^{-\\beta U}$ 下降到容差 $\\tau$ 时的能量。注意 $U_{\\text{th}} = -\\frac{1}{\\beta} \\ln \\tau$。\n2.  为找到积分限，我们求解方程 $U_{M}(r) = U_{\\text{th}}$ 以得到 $r$：\n    $$\n    D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2} = U_{\\text{th}}\n    $$\n    $$\n    1 - e^{-a(r - r_{e})} = \\pm \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    e^{-a(r - r_{e})} = 1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    r = r_{e} - \\frac{1}{a} \\ln \\left(1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\\right)\n    $$\n3.  这会产生两个潜在的解。‘+’ 号对应于势阱的内壁（$r  r_{e}$），‘-’ 号对应于势阱的外壁（$r > r_{e}$）。\n    -   左边界 $r_{\\text{L}}$ 使用 ‘+’ 号求得：$r_{\\text{L}} = r_{e} - \\frac{1}{a} \\ln \\left(1 + \\sqrt{U_{\\text{th}}/D_{e}}\\right)$。该解总是实数且小于 $r_e$。我们设置 $r_{\\min} = \\max(0, r_{\\text{L}})$，因为键长不能为负。\n    -   右边界 $r_{\\text{R}}$ 与 ‘-’ 号相关：$r_{\\text{R}} = r_{e} - \\frac{1}{a} \\ln \\left(1 - \\sqrt{U_{\\text{th}}/D_{e}}\\right)$。\n4.  $r_{\\max}$ 的确定取决于 $U_{\\text{th}}$ 是否小于 $D_{e}$：\n    -   **情况 1：$U_{\\text{th}}  D_{e}$**。$\\sqrt{U_{\\text{th}}/D_{e}}$ 项小于 1，因此对数的参数为正，存在一个实数解 $r_{\\text{R}} > r_{e}$。根据问题的约束，我们必须将此值限制在 $r_{e} + L_{\\text{cap}}$，其中 $L_{\\text{cap}} = 10\\,\\text{\\AA}$。因此，$r_{\\max} = \\min(r_{\\text{R}}, r_{e} + L_{\\text{cap}})$。\n    -   **情况 2：$U_{\\text{th}} \\ge D_{e}$**。$\\sqrt{U_{\\text{th}}/D_{e}}$ 项大于等于 1，使得对数的参数为非正数。不存在 $r_{\\text{R}}$ 的实数解。在这种情况下（高温或浅势阱），玻尔兹曼权重在外壁上永远不会降到容差 $\\tau$ 以下。遵循问题的明确指示，我们使用硬上限：$r_{\\max} = r_{e} + L_{\\text{cap}}$。\n\n在确定了积分限 $[r_{\\min}, r_{\\max}]$ 后，我们可以定义需要数值计算的两个定积分：\n$$\nN = \\int_{r_{\\min}}^{r_{\\max}} r \\, e^{-\\beta U_{M}(r)} \\, dr\n$$\n$$\nZ = \\int_{r_{\\min}}^{r_{\\max}} e^{-\\beta U_{M}(r)} \\, dr\n$$\n平均键长即为 $\\langle r \\rangle = N/Z$，非谐位移为 $\\Delta = \\langle r \\rangle - r_{e}$。由于莫尔斯势的非对称形状（对于 $r > r_{e}$ 的区域比 $r  r_{e}$ 的区域更平缓），我们预期对于任何 $T > 0$，$\\langle r \\rangle$ 都会大于 $r_{e}$，从而导致一个正的位移 $\\Delta$。\n\n计算将使用自适应求积方法来实现，以确保对这些性状良好但可能存在尖峰的函数进行高精度数值积分。上述定义的逻辑将应用于测试套件中的每个参数集。所有单位必须保持一致；我们将按照规定，对能量使用焦耳，对温度使用开尔文，对长度使用埃。", "answer": "$$\\boxed{[1.002591, 0.002591, 1.524953, 0.024953, 1.000155, 0.000155, 1.302196, 0.102196]}$$", "id": "3395887"}]}