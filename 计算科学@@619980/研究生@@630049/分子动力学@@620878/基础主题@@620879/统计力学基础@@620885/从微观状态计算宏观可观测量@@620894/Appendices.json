{"hands_on_practices": [{"introduction": "在热力学中，温度是一个核心概念，但在微观的分子动力学模拟中，我们直接拥有的只是粒子的位置和动量。本练习旨在从这些基本的微观状态出发，探索如何定义和计算宏观的温度。我们将首先运用能量均分定理，从粒子动量中推导出“动能温度”；接着，我们将基于正则系综的原理，从粒子间的相互作用力推导出“位形温度”，揭示系统构象与热能之间更深层次的联系。这项实践不仅巩固了温度的统计力学基础，也强调了同一宏观量可以有不同的微观估计量，这对于检验模拟是否达到平衡至关重要。", "problem": "考虑一个经典的分子动力学 (MD) 系统，该系统由 $N$ 个点粒子组成，在三维空间中，其位置为 $\\{\\mathbf{r}_i\\}_{i=1}^{N}$，动量为 $\\{\\mathbf{p}_i\\}_{i=1}^{N}$，质量为 $\\{m_i\\}_{i=1}^{N}$。哈密顿量为 $H = K + U$，其中动能为 $K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i}$，势能为 $U(\\{\\mathbf{r}_i\\})$。该系统在周期性边界条件下进行模拟，且质心 (COM) 动量被约束为零。假设系统处于温度为 $T$ 的正则系综中，且宏观可观测量由瞬时微观状态估计。\n\n从适用于此背景的第一性原理出发，具体包括：\n- 哈密顿力学以及正则系综中相空间平均的定义，以及\n- 二次自由度的能量均分定理，\n\n执行以下操作：\n1. 推导一个显式的瞬时动能温度估计量 $T_{\\mathrm{K}}$，该表达式纯粹用动量 $\\{\\mathbf{p}_i\\}$、质量 $\\{m_i\\}$ 和无约束自由度的数量来表示。不要假设质量相同。\n2. 仅使用正则系综的构型平均定义和严格的数学推导（例如，高斯定理或在构型空间上的分部积分），推导一个显式的瞬时构型温度估计量 $T_{\\mathrm{C}}$，用 $\\nabla U$ 和 $\\nabla^2 U$ 来表示。\n3. 将 $U$ 具体化为三维空间中的对加性 Lennard–Jones 势，\n$$\nU(\\{\\mathbf{r}_i\\}) = \\sum_{1 \\leq i  j \\leq N} v(r_{ij}), \\quad v(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right], \\quad r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|,\n$$\n并为 $N = 2$，$\\mathbf{r}_1 = (\\sigma, 0, 0)$，$\\mathbf{r}_2 = (2\\sigma, 0, 0)$ 的特定微观状态，求出瞬时构型温度 $T_{\\mathrm{C}}$ 的闭式表达式。\n提供第 (1) 和 (2) 部分要求的显式解析表达式，以及第 (3) 部分计算出的最终表达式。所有温度均以开尔文表示。如果需要任何数值近似，请将答案四舍五入到四位有效数字；否则，提供精确的闭式表达式。", "solution": "问题陈述有效。它在科学上基于经典统计力学和分子动力学的原理，问题清晰、客观且内部一致。我们按要求进行推导。\n\n问题的第一部分要求推导瞬时动能温度估计量 $T_{\\mathrm{K}}$。在正则系综中，能量均分定理指出，对于处于温度 $T$ 的热平衡状态的经典系统，哈密顿量中任何以二次方形式出现的自由度所关联的平均能量为 $\\frac{1}{2} k_B T$，其中 $k_B$ 是玻尔兹曼常数。在三维空间中，$N$ 个粒子系统的动能由下式给出：\n$$K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\sum_{i=1}^{N} \\left( \\frac{p_{ix}^2}{2 m_i} + \\frac{p_{iy}^2}{2 m_i} + \\frac{p_{iz}^2}{2 m_i} \\right)$$\n这个表达式是 $3N$ 个二次项的和，每个动量分量对应一项。动能的系综平均为 $\\langle K \\rangle$。根据能量均分定理，每个二次动量项的平均能量为 $\\langle \\frac{p_{i\\alpha}^2}{2 m_i} \\rangle = \\frac{1}{2} k_B T$，其中 $\\alpha \\in \\{x, y, z\\}$。问题指明质心 (COM) 动量被约束为零：\n$$\\mathbf{P}_{\\mathrm{COM}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\mathbf{0}$$\n这对动量分量构成了 3 个标量约束（即 $\\sum_{i=1}^{N} p_{ix} = 0$，$\\sum_{i=1}^{N} p_{iy} = 0$，$\\sum_{i=1}^{N} p_{iz} = 0$）。因此，动能项中独立的、无约束的二次自由度数量不是 $3N$，而是 $N_{\\mathrm{DOF}} = 3N - 3$。总平均动能是这些独立自由度平均能量的总和：\n$$\\langle K \\rangle = (3N - 3) \\times \\frac{1}{2} k_B T$$\n瞬时温度估计量是通过假设宏观可观测量的值等于其系综平均值来获得的。设 $T_{\\mathrm{K}}$ 为此瞬时动能温度。我们将瞬时动能 $K_{\\mathrm{inst}}$ 设为其期望值：\n$$K_{\\mathrm{inst}} = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\frac{3N-3}{2} k_B T_{\\mathrm{K}}$$\n求解 $T_{\\mathrm{K}}$ 得到所求的估计量：\n$$T_{\\mathrm{K}} = \\frac{2K_{\\mathrm{inst}}}{(3N - 3)k_B} = \\frac{1}{(3N - 3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i}$$\n\n问题的第二部分要求推导瞬时构型温度估计量 $T_{\\mathrm{C}}$。这是从正则系综中势能函数 $U(\\{\\mathbf{r}_i\\})$ 的性质推导出来的。一个仅依赖于粒子位置 $\\{\\mathbf{r}_i\\}$ 的可观测量 $A(\\{\\mathbf{r}_i\\})$ 的系综平均由下式给出：\n$$\\langle A \\rangle = \\frac{\\int A(\\{\\mathbf{r}_i\\}) \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}{\\int \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}$$\n其中 $\\beta = 1/(k_B T)$，积分是在 $3N$ 维构型空间上进行的。设 $\\nabla = (\\nabla_{\\mathbf{r}_1}, \\dots, \\nabla_{\\mathbf{r}_N})$ 为该空间中的梯度算符。我们考虑将散度定理（分部积分）应用于矢量场 $\\mathbf{V} = (\\nabla U) \\exp(-\\beta U)$ 所得到的恒等式。其散度为：\n$$\\nabla \\cdot \\mathbf{V} = (\\nabla^2 U) \\exp(-\\beta U) + (\\nabla U) \\cdot \\nabla[\\exp(-\\beta U)]$$\n使用链式法则，$\\nabla[\\exp(-\\beta U)] = -\\beta (\\nabla U) \\exp(-\\beta U)$，我们得到：\n$$\\nabla \\cdot [(\\nabla U) \\exp(-\\beta U)] = \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U)$$\n其中 $|\\nabla U|^2 = (\\nabla U) \\cdot (\\nabla U) = \\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2$ 且 $\\nabla^2 U = \\nabla \\cdot (\\nabla U) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U$。将此散度在整个构型空间体积 $\\Omega$ 上积分，并应用散度定理，得到一个边界积分，对于周期性或受限系统，该积分为零。因此：\n$$0 = \\int_{\\Omega} \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U) d^{3N}\\mathbf{r}$$\n这意味着 $\\int (\\nabla^2 U) \\exp(-\\beta U) d^{3N}\\mathbf{r} = \\beta \\int |\\nabla U|^2 \\exp(-\\beta U) d^{3N}\\mathbf{r}$，用系综平均表示为 $\\langle \\nabla^2 U \\rangle = \\beta \\langle |\\nabla U|^2 \\rangle$。代入 $\\beta = 1/(k_B T)$ 得到 $k_B T = \\frac{\\langle |\\nabla U|^2 \\rangle}{\\langle \\nabla^2 U \\rangle}$。瞬时构型温度估计量 $T_{\\mathrm{C}}$ 是通过去掉系综平均得到的：\n$$T_{\\mathrm{C}} = \\frac{|\\nabla U|^2}{k_B \\nabla^2 U} = \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U}$$\n\n第三部分要求将 $T_{\\mathrm{C}}$ 具体化到一个由 Lennard-Jones 势 $v(r)$ 相互作用的 $N=2$ 的粒子系统，并用于一个特定构型。对于一个双粒子系统，$U(\\mathbf{r}_1, \\mathbf{r}_2) = v(r_{12})$，其中 $r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2|$。设 $r=r_{12}$。所需的项是：\n$$|\\nabla U|^2 = |\\nabla_{\\mathbf{r}_1} U|^2 + |\\nabla_{\\mathbf{r}_2} U|^2 = 2(v'(r))^2$$\n$$\\nabla^2 U = \\nabla_{\\mathbf{r}_1}^2 U + \\nabla_{\\mathbf{r}_2}^2 U = 2\\left(v''(r) + \\frac{2}{r} v'(r)\\right)$$\n这给出了双粒子系统 $k_B T_{\\mathrm{C}}$ 的表达式：\n$$k_B T_{\\mathrm{C}} = \\frac{2(v'(r))^2}{2(v''(r) + \\frac{2}{r} v'(r))} = \\frac{(v'(r))^2}{v''(r) + \\frac{2}{r} v'(r)}$$\nLennard-Jones 势为 $v(r) = 4 \\varepsilon [ (\\frac{\\sigma}{r})^{12} - (\\frac{\\sigma}{r})^{6} ]$。其导数为：\n$$v'(r) = \\frac{24\\varepsilon}{r}\\left[-2\\left(\\frac{\\sigma}{r}\\right)^{12} + \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n$$v''(r) = \\frac{4\\varepsilon}{r^2}\\left[156\\left(\\frac{\\sigma}{r}\\right)^{12} - 42\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n给定的微观状态为 $\\mathbf{r}_1 = (\\sigma, 0, 0)$ 和 $\\mathbf{r}_2 = (2\\sigma, 0, 0)$，因此距离为 $r = |\\mathbf{r}_1 - \\mathbf{r}_2| = \\sigma$。我们在 $r=\\sigma$ 处计算导数：\n$$v'(\\sigma) = \\frac{24\\varepsilon}{\\sigma}[-2(1)^{12} + (1)^6] = -\\frac{24\\varepsilon}{\\sigma}$$\n$$v''(\\sigma) = \\frac{4\\varepsilon}{\\sigma^2}[156(1)^{12} - 42(1)^6] = \\frac{456\\varepsilon}{\\sigma^2}$$\n将这些代入 $k_B T_{\\mathrm{C}}$ 的表达式中：\n$$k_B T_{\\mathrm{C}} = \\frac{\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)^2}{\\frac{456\\varepsilon}{\\sigma^2} + \\frac{2}{\\sigma}\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)} = \\frac{\\frac{576\\varepsilon^2}{\\sigma^2}}{\\frac{456\\varepsilon}{\\sigma^2} - \\frac{48\\varepsilon}{\\sigma^2}} = \\frac{576\\varepsilon^2/\\sigma^2}{408\\varepsilon/\\sigma^2} = \\frac{576}{408}\\varepsilon$$\n该分数可化简为 $\\frac{576}{408} = \\frac{24 \\times 24}{24 \\times 17} = \\frac{24}{17}$。\n所以，$k_B T_{\\mathrm{C}} = \\frac{24}{17}\\varepsilon$。温度的最终表达式为：\n$$T_{\\mathrm{C}} = \\frac{24\\varepsilon}{17k_B}$$\n至此完成了问题的三个部分。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{(3N-3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i}  \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U}  \\frac{24\\varepsilon}{17k_B}\n\\end{pmatrix}\n}\n$$", "id": "3423095"}, {"introduction": "在掌握了如何从微观态计算温度这样的静态属性后，我们转向输运性质，例如扩散系数。然而，在周期性边界条件下进行的模拟会引入人为的关联，从而影响我们对输运过程的测量。本练习旨在解决其中最主要的一种系统性误差。我们将深入探讨溶质粒子与其周期性镜像之间相互作用所引起的流体动力学效应，并基于斯托克斯流理论推导扩散系数的主导有限尺寸修正项。这项实践对于精确计算输运性质至关重要，它教会我们如何校正由模拟设置引入的系统误差，从而获得与宏观无限大体系相对应的准确结果。", "problem": "一个单个球形溶质在边长为 $L$ 的立方盒子中，在周期性边界条件 (PBC) 下，通过分子动力学 (MD) 模拟在一个牛顿不可压缩溶剂中扩散。溶剂的温度为 $T$，剪切粘度为 $\\eta$。你从溶质均方根位移的长时斜率测量得到一个有限尺寸的自扩散系数 $D(L)$。宏观可观测量 $D(L)$ 通过线性响应和流体动力学源于微观动力学。\n\n从适用于此情景的基本原理出发，即扩散的爱因斯坦关系、涨落-耗散定理 (FDT) 以及 Navier-Stokes 方程的 Stokes 流动极限，推导立方周期性复制流体中自迁移率的主阶有限尺寸修正，并用它来获得无限系统自扩散系数 $D_{\\infty}$ 关于 $D(L)$、$T$、$\\eta$ 和 $L$ 的表达式。你可以使用已知的立方周期性阵列的无量纲晶格求和常数 $\\xi = 2.837297$，该常数由 Stokes 极限下 Oseen 张量的 Ewald 求和得出。\n\n然后，对于以下科学上真实的参数：\n- 盒子边长 $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$，\n- 温度 $T = 298.0\\,\\mathrm{K}$，\n- 剪切粘度 $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$，\n- 测得的有限尺寸扩散系数 $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$，\n- 玻尔兹曼常数 $k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$，\n\n计算无限系统自扩散系数 $D_{\\infty}$。将你的答案四舍五入到四位有效数字。以 $\\mathrm{m^2/s}$ 为单位表示最终的扩散系数。", "solution": "该问题有效。这是一个计算统计力学领域中适定的、有科学依据的问题，要求推导和应用周期性系统中扩散系数的主阶有限尺寸修正。所有必需的信息均已提供，且参数在物理上是真实的。\n\n问题在于将在边长为 $L$ 的立方盒子中测得的扩散系数 $D(L)$ 与无限大系统中的扩散系数 $D_{\\infty}$ 联系起来。这个关系可以通过考虑周期性边界条件对扩散溶质与溶剂之间流体动力学相互作用的影响来推导。\n\n我们从爱因斯坦关系开始，它将扩散系数 $D$ 与粒子的迁移率 $\\mu$ 和热能 $k_B T$ 联系起来：\n$$D = \\mu k_B T$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。此关系对有限尺寸系统和无限系统均成立：\n$$D(L) = \\mu(L) k_B T$$\n$$D_{\\infty} = \\mu_{\\infty} k_B T$$\n因此，任务简化为找到有限系统中的迁移率 $\\mu(L)$ 与无限系统中的迁移率 $\\mu_{\\infty}$ 之间的关系。\n\n迁移率 $\\mu$ 是衡量粒子速度响应外力的一个量度。对于一个受到恒定外力 $\\mathbf{F}_{\\text{ext}}$ 的粒子，它会达到一个与力成正比的终端速度 $\\mathbf{v}$：$\\mathbf{v} = \\mu \\mathbf{F}_{\\text{ext}}$。这个比例常数就是迁移率。涨落-耗散定理 (FDT) 为这种线性响应关系提供了微观基础，并将其与平衡涨落联系起来，但这个问题的核心在于一个流体动力学的论证。\n\n在粘度为 $\\eta$ 的无限、不可压缩牛顿流体中，一个受到力 $\\mathbf{F}$ 的点状粒子以速度 $\\mathbf{v}$ 运动。这个运动在周围的流体中感生出一个速度场 $\\mathbf{u}(\\mathbf{r})$。在低雷诺数极限下（Stokes 流），这由 Stokes 方程描述。作用于原点的点力 $\\mathbf{F}$ 产生一个由 Oseen 张量 $\\mathbf{T}(\\mathbf{r})$ 给出的速度场：\n$$\\mathbf{u}(\\mathbf{r}) = \\mathbf{T}(\\mathbf{r}) \\cdot \\mathbf{F}$$\n其中\n$$\\mathbf{T}_{ij}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\left( \\delta_{ij} + \\frac{r_i r_j}{r^2} \\right)$$\n其中 $\\mathbf{r}$ 是一个位置矢量，其大小为 $r$，分量为 $r_i, r_j$。\n\n粒子本身的迁移率 $\\mu_{\\infty}$ 与其所受到的摩擦力有关。对于一个半径为 $a$ 的球形粒子，Stokes 定律给出了摩擦系数 $\\zeta_{\\infty} = 6 \\pi \\eta a$，迁移率为 $\\mu_{\\infty} = 1/\\zeta_{\\infty}$。虽然我们的推导是针对点粒子的，但迁移率的概念仍然成立。\n\n在具有周期性边界条件 (PBC) 的系统中，粒子不仅与周围的流体相互作用，还与自身的周期性镜像相互作用。作用于原点粒子的力 $\\mathbf{F}$ 会从位于晶格矢量 $L\\mathbf{n}$（其中 $\\mathbf{n}$ 是整数矢量 $(n_x, n_y, n_z)$）的所有镜像处感生出速度场。在粒子位置（$\\mathbf{r}=\\mathbf{0}$）的流体速度受到其所有镜像（$\\mathbf{n} \\neq \\mathbf{0}$）产生的流场的影响。这就是流体动力学回流。\n\n粒子的速度 $\\mathbf{v}(L)$ 是其在无限介质中的速度 $\\mathbf{v}_{\\infty} = \\mu_{\\infty} \\mathbf{F}$ 减去这个回流速度 $\\mathbf{v}_{\\text{backflow}}$：\n$$\\mathbf{v}(L) = \\mu_{\\infty}\\mathbf{F} - \\mathbf{v}_{\\text{backflow}}$$\n回流速度是作用在每个镜像粒子上的力 $\\mathbf{F}$ 所感生的速度场在中心粒子位置处的总和：\n$$\\mathbf{v}_{\\text{backflow}} = \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\cdot \\mathbf{F}$$\n此处，求和遍及所有非零整数矢量 $\\mathbf{n}$。\n\n综合这些，周期性系统中粒子的速度为：\n$$\\mathbf{v}(L) = \\left( \\mu_{\\infty}\\mathbf{I} - \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right) \\cdot \\mathbf{F}$$\n其中 $\\mathbf{I}$ 是单位张量。括号中的项是有限系统中的有效迁移率张量 $\\mathbf{M}(L)$。对于立方晶格，对称性要求该张量是各向同性的，即 $\\mathbf{M}(L) = \\mu(L)\\mathbf{I}$。标量迁移率 $\\mu(L)$ 是其迹的三分之一：\n$$\\mu(L) = \\frac{1}{3} \\text{Tr}(\\mathbf{M}(L)) = \\mu_{\\infty} - \\frac{1}{3} \\text{Tr}\\left( \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right)$$\n\n我们需要计算 Oseen 张量的迹：\n$$\\text{Tr}(\\mathbf{T}(\\mathbf{r})) = \\sum_{i=1}^{3} \\mathbf{T}_{ii}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\sum_{i=1}^{3} \\left( \\delta_{ii} + \\frac{r_i^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} \\left( 3 + \\frac{r_1^2+r_2^2+r_3^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} (3 + 1) = \\frac{1}{2 \\pi \\eta r}$$\n将此代入 $\\mu(L)$ 的表达式中：\n$$\\mu(L) = \\mu_{\\infty} - \\frac{1}{3} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{2 \\pi \\eta |L\\mathbf{n}|} = \\mu_{\\infty} - \\frac{1}{6 \\pi \\eta L} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$$\n和 $\\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$ 是一个无量纲的晶格和，它依赖于周期性晶胞的几何形状。对于简单立方晶格，这个和使用 Ewald 求和技术来处理其条件收敛性，其值由常数 $\\xi$ 给出。问题提供了它的值：$\\xi = 2.837297$。\n\n因此，对迁移率的主阶有限尺寸修正是：\n$$\\mu(L) = \\mu_{\\infty} - \\frac{\\xi}{6 \\pi \\eta L}$$\n这表明，由于周期性镜像引起的感生阻力，有限周期系统中的迁移率相比于无限系统有所降低。\n\n现在，我们使用爱因斯坦关系将其转换回扩散系数的表达式：\n$$\\frac{D(L)}{k_B T} = \\frac{D_{\\infty}}{k_B T} - \\frac{\\xi}{6 \\pi \\eta L}$$\n乘以 $k_B T$，我们得到扩散系数之间的关系：\n$$D(L) = D_{\\infty} - \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\n这就是著名的 Dünweg-Kremer 自扩散系数修正。\n\n问题要求用其他量表示 $D_{\\infty}$ 的表达式。重排方程，我们得到：\n$$D_{\\infty} = D(L) + \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\n推导到此完成。\n\n接下来，我们使用提供的参数计算 $D_{\\infty}$ 的数值。\n参数如下：\n- $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$\n- $T = 298.0\\,\\mathrm{K}$\n- $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $\\xi = 2.837297$\n\n首先，我们计算修正项 $\\Delta D = \\frac{k_B T \\xi}{6 \\pi \\eta L}$。所有值都采用国际单位制（SI）单位，因此结果的单位将是 $\\mathrm{m^2/s}$。\n分子是 $k_B T \\xi$：\n$$k_B T \\xi = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (298.0\\,\\mathrm{K}) \\times (2.837297) \\approx 1.167345 \\times 10^{-20}\\,\\mathrm{J}$$\n分母是 $6 \\pi \\eta L$：\n$$6 \\pi \\eta L = 6\\pi \\times (8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}) \\times (3.000 \\times 10^{-9}\\,\\mathrm{m}) \\approx 5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}$$\n修正项是：\n$$\\Delta D = \\frac{1.167345 \\times 10^{-20}\\,\\mathrm{J}}{5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}} \\approx 2.321437 \\times 10^{-10}\\,\\mathrm{m^2/s} = 0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\n现在，我们将其加到测得的扩散系数 $D(L)$ 上：\n$$D_{\\infty} = D(L) + \\Delta D = (1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}) + (0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s})$$\n$$D_{\\infty} \\approx 2.1321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\n问题要求将答案四舍五入到四位有效数字。\n$$D_{\\infty} \\approx 2.132 \\times 10^{-9}\\,\\mathrm{m^2/s}$$", "answer": "$$\\boxed{2.132 \\times 10^{-9}}$$", "id": "3423093"}, {"introduction": "在我们理解了体系的体相性质之后，现在我们进入更复杂的界面现象研究。本练习将通过两种不同的理论方法，探索如何计算液-气界面的关键性质——表面张力。我们将对比基于界面压力张量各向异性的“机械路径”和通过计算界面面积微小变化所对应的自由能代价的“热力学路径”，并揭示它们在有限尺寸效应上的差异。更重要的是，这项实践引入了毛细波的概念，并演示了其热涨落如何导致一种独特的、必须被精确处理的有限尺寸效应。通过这个综合性问题，你不仅能掌握计算表面张力的两种基本方法，还能深入理解界面物理的精妙之处，并学会如何在非均相体系中分析和校正尺寸依赖的系统误差。", "problem": "您将编写一个完整、可运行的程序，该程序针对分子动力学中的一个模型平面液-气界面，通过两种微观路径计算表面张力，并分离出有限尺寸的毛细波贡献。这两种路径是：(i) 通过压力张量各向异性的机械路径，以及 (ii) 通过在微小面积形变下由微观能量变化构建的自由能微扰的热力学测试面积路径。您将把这些路径应用于一个包含三个方形横向系统尺寸的小型测试套件，并报告每个案例的结果以及无限系统的外推值。\n\n从以下基本原理和核心定义开始：\n- 对于处于平衡态的平面界面，每个界面的表面张力的机械定义由压力各向异性沿界面法向坐标的积分给出，$\\gamma = \\int_{-\\infty}^{\\infty} [P_N(z) - P_T(z)] \\, dz$，其中 $P_N(z)$ 是局域压力张量的法向分量，$P_T(z)$ 是两个切向分量的算术平均值。在一个高度为 $L_z$、包含两个平面界面的周期性模拟盒子中，对整个盒子进行积分会得到两个界面的总和，而每个界面的表面张力则通过将积分值除以界面数 $n_i = 2$ 得到。\n- 在恒定 $NVT$（粒子数、体积和温度固定）系综下的热力学测试面积方法中，由分数应变 $\\epsilon$ 引起的微小平面内面积增加所对应的自由能变化 $\\Delta F$ 可以通过微观势能变化 $\\Delta U$ 计算得到：$\\Delta F = -k_B T \\ln \\left\\langle e^{-\\beta \\Delta U} \\right\\rangle$，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数。对于足够小的 $\\epsilon$，二阶累积量展开可得 $\\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U)$，每个界面的表面张力估计为 $\\gamma \\approx \\Delta F / (2 A \\epsilon)$，其中 $A$ 是一个界面的横向面积，因子 $2$ 是因为盒子里有两个界面。\n- 在周期性边界条件下，毛细波哈密顿量 $\\mathcal{H}[h] = \\frac{\\gamma}{2}\\int d^2\\mathbf{r} \\, |\\nabla h(\\mathbf{r})|^2$ 会导致对在边长为 $L$ 的有限方形盒子（即 $A=L^2$）中通过测试面积自由能得到的表观表面张力产生一个有限尺寸修正。对允许的傅里叶模式（在长度 $a$ 处有微观截断）的毛细波配分函数进行标准分析，会得到一个依赖于 $L$ 的自由能贡献，该贡献产生了测试面积估计的主要有限尺寸偏差\n$$\n\\Delta \\gamma_{\\mathrm{cw}}(L) \\equiv \\gamma_{\\mathrm{TA}}(L) - \\gamma_{\\infty} \\approx - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right),\n$$\n其中 $\\gamma_{\\infty}$ 是无限系统表面张力。对于具有完整局域应力解析的平面界面，机械路径通过积分压力各向异性得到，并且不包含这种熵性的毛细模式截断偏差；因此，在固定的热力学状态下，它返回与 $L$ 无关的 $\\gamma_{\\infty}$。\n\n您的程序将不读取任何输入。它必须生成与上述原理一致的合成微观数据，计算宏观可观测量，并以要求的格式输出结果。您必须使用以下物理和数值参数：\n- 玻尔兹曼常数：$k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$。\n- 温度：$T = 300 \\,\\mathrm{K}$，因此 $\\beta = 1/(k_B T)$。\n- 真实无限系统表面张力：$\\gamma_{\\infty} = 0.005 \\,\\mathrm{N/m}$。\n- 毛细模式的微观截断长度：$a = 0.5 \\,\\mathrm{nm}$。\n- 基础法向压力：$P_0 = 1.0 \\times 10^{5} \\,\\mathrm{Pa}$。\n- 模拟盒子高度：$L_z = 12 \\,\\mathrm{nm}$。\n- 因周期性产生的界面数量：$n_i = 2$。\n- 分子尺度的本征界面宽度：$w_0 = 0.3 \\,\\mathrm{nm}$。\n- 用于测试面积微扰的平面内应变：$\\epsilon = 0.01$。\n- 每个案例使用一个包含 $M = 100$ 个微观能量微扰样本的确定性系综。\n\n按如下方式为每个测试案例构建微观数据：\n1. 横向盒子为方形，其边长 $L \\in \\{ 2\\,\\mathrm{nm}, 4\\,\\mathrm{nm}, 8\\,\\mathrm{nm} \\}$，因此单个界面的面积为 $A = L^2$。测试套件按所述顺序包含这三个案例。这涵盖了一个小系统边缘情况、一个中等尺度情况和一个较大的横向情况。\n2. 机械路径数据：沿 $z$ 轴定义两个界面中心，分别为 $z_1 = L_z/4$ 和 $z_2 = 3L_z/4$。定义经毛细波展宽的宽度\n$$\nw(L) = \\sqrt{w_0^2 + \\frac{k_B T}{2\\pi \\gamma_{\\infty}} \\ln\\!\\left(\\frac{L}{a}\\right)}.\n$$\n构建一个在 $[0, L_z]$ 上均匀分布的离散化网格 $z_j$，从 $j=0$ 到 $j=5000$（共 $5001$ 个点）。将局域压力分量定义为\n$$\nP_N(z_j) = P_0, \\quad\nP_T(z_j) = P_0 - \\delta p(z_j; L),\n$$\n其中压力各向异性为\n$$\n\\delta p(z; L) = S(L)\\left[\\exp\\!\\left(-\\frac{(z - z_1)^2}{2 w(L)^2}\\right) + \\exp\\!\\left(-\\frac{(z - z_2)^2}{2 w(L)^2}\\right)\\right],\n$$\n并选择振幅\n$$\nS(L) = \\frac{\\gamma_{\\infty}}{\\sqrt{2\\pi} \\, w(L)},\n$$\n以使 $\\delta p$ 在整个盒子上的积分等于 $2 \\gamma_{\\infty}$。使用梯形法则进行数值积分，计算每个界面的机械表面张力\n$$\n\\gamma_{\\mathrm{mech}}(L) = \\frac{1}{n_i}\\int_{0}^{L_z} \\left[P_N(z) - P_T(z)\\right] \\, dz,\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。\n3. 测试面积路径数据：对于每个案例，目标是每个界面的有限尺寸偏置表面张力\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) = \\gamma_{\\infty} + \\Delta \\gamma_{\\mathrm{cw}}(L), \\quad \\Delta \\gamma_{\\mathrm{cw}}(L) = - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right).\n$$\n设微观能量变化的方差与以下公式成比例\n$$\n\\mathrm{Var}(\\Delta U) = \\sigma^2(L) = c_U \\, k_B T \\, A \\, \\epsilon^2,\n$$\n其中无量纲常数 $c_U = 0.1$。通过取 $M/2$ 个等于 $\\mu(L) + \\sigma(L)$ 的值和 $M/2$ 个等于 $\\mu(L) - \\sigma(L)$ 的值，构建一个包含 $M$ 个样本的确定性系综，其中均值 $\\mu(L)$ 的选择是为了满足针对两个界面的目标自由能变化的二阶累积量关系：\n$$\n\\mu(L) \\equiv \\langle \\Delta U \\rangle = 2 A \\epsilon \\, \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) + \\frac{\\beta}{2}\\sigma^2(L).\n$$\n计算样本均值和方差，并评估\n$$\n\\Delta F_{\\mathrm{est}}(L) = \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U).\n$$\n然后计算每个界面的测试面积表面张力估计值\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\frac{\\Delta F_{\\mathrm{est}}(L)}{2 A \\epsilon},\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。同时，通过移除毛细波偏差，计算有限尺寸修正后的测试面积估计值\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\mathrm{TA}}(L) - \\Delta \\gamma_{\\mathrm{cw}}(L),\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。\n4. 使用三个 $L$ 值下的三个测试面积估计值 $\\gamma_{\\mathrm{TA}}(L)$，对线性模型\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\gamma_{\\infty}^{\\mathrm{fit}} - C^{\\mathrm{fit}} \\, x(L),\n\\quad \\text{with} \\quad x(L) = \\frac{\\ln(L/a)}{L^2},\n$$\n进行最小二乘拟合，以估计截距 $\\gamma_{\\infty}^{\\mathrm{fit}}$ 和正系数 $C^{\\mathrm{fit}}$。仅报告以 $\\mathrm{N/m}$ 为单位的 $\\gamma_{\\infty}^{\\mathrm{fit}}$。\n\n不涉及角度单位。所有报告的表面张力必须以 $\\mathrm{N/m}$ 为单位，表示为不带单位字符串的普通浮点数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，按顺序包含以下 $10$ 个条目：\n- 对于 $L = 2\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 对于 $L = 4\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 对于 $L = 8\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 最后，是外推的无限尺寸估计值 $[\\gamma_{\\infty}^{\\mathrm{fit}}]$。\n\n因此，打印出的行必须具有以下结构\n$[\\gamma_{\\mathrm{mech}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{mech}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{mech}}(8\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(8\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(8\\,\\mathrm{nm}),\\gamma_{\\infty}^{\\mathrm{fit}}]$，所有条目均为浮点数。", "solution": "该问题是有效的。它提出了一个科学上合理、自洽且良定的计算任务，其根植于统计力学和分子动力学的原理。所有必要的数据、常数和理论模型都已明确提供。该问题构成了一个验证性练习，用于测试有关表面张力及其有限尺寸效应的既定理论关系的实现。\n\n解决方案通过对一个包含三个横向系统尺寸的测试套件，直接模拟所提供的理论模型来展开。我们将通过两条不同的路径——机械路径和热力学测试面积方法——计算表面张力 $\\gamma$，并在毛细波理论的背景下分析结果。\n\n首先，我们用国际单位制（SI）基本单位定义所有的物理常数和模型参数。这些参数包括玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$、温度 $T = 300 \\,\\mathrm{K}$、真实无限系统表面张力 $\\gamma_{\\infty} = 0.005 \\,\\mathrm{N/m}$、微观截断长度 $a = 0.5 \\times 10^{-9} \\,\\mathrm{m}$、盒子高度 $L_z = 12 \\times 10^{-9} \\,\\mathrm{m}$、界面数 $n_i=2$、本征界面宽度 $w_0 = 0.3 \\times 10^{-9} \\,\\mathrm{m}$，以及测试面积应变 $\\epsilon = 0.01$。计算是针对三个方形系统进行的，其横向尺寸分别为 $L \\in \\{2, 4, 8\\} \\times 10^{-9} \\,\\mathrm{m}$。\n\n计算的第一部分处理通向表面张力的机械路径。对于平面界面，$\\gamma$ 由积分的压力各向异性给出。对于包含 $n_i$ 个界面的模拟盒子，每个界面的表面张力为\n$$\n\\gamma_{\\mathrm{mech}}(L) = \\frac{1}{n_i}\\int_{0}^{L_z} \\left[P_N(z) - P_T(z)\\right] \\, dz.\n$$\n该问题为局域压力分量指定了一个合成模型，$P_N(z_j) = P_0$ 和 $P_T(z_j) = P_0 - \\delta p(z_j; L)$，其中 $P_0$ 是一个恒定的背景压力。因此，压力各向异性 $P_N(z) - P_T(z)$ 就是 $\\delta p(z; L)$。该剖面被建模为以 $z_1 = L_z/4$ 和 $z_2 = 3L_z/4$ 为中心的两个高斯函数的和：\n$$\n\\delta p(z; L) = S(L)\\left[\\exp\\!\\left(-\\frac{(z - z_1)^2}{2 w(L)^2}\\right) + \\exp\\!\\left(-\\frac{(z - z_2)^2}{2 w(L)^2}\\right)\\right].\n$$\n高斯函数的宽度 $w(L)$ 解释了毛细波展宽，由 $w(L) = \\sqrt{w_0^2 + \\frac{k_B T}{2\\pi \\gamma_{\\infty}} \\ln(L/a)}$ 给出。振幅 $S(L) = \\frac{\\gamma_{\\infty}}{\\sqrt{2\\pi} \\, w(L)}$ 经过专门选择，使得一个高斯剖面在整个区域上的解析积分恰好为 $\\gamma_{\\infty}$。因此，$\\delta p(z; L)$ 在包含两个此类剖面的盒子上的积分为 $2\\gamma_{\\infty}$。除以 $n_i=2$ 解析地得到 $\\gamma_{\\mathrm{mech}}(L) = \\gamma_{\\infty}$。程序将通过在沿 $z$ 轴的 $5001$ 个点的精细网格上使用梯形法则进行数值积分来验证这一点。\n\n计算的第二部分实现热力学测试面积路径。该方法通过亥姆霍兹自由能变化 $\\Delta F$ 来估计表面张力，该变化是在面积发生微小分数增加 $\\epsilon$ 时产生的。每个界面的表面张力为 $\\gamma_{\\mathrm{TA}} = \\Delta F / (2A\\epsilon)$。我们使用二阶累积量展开 $\\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U)$，其中 $\\Delta U$ 是微观势能变化。该问题规定了一个合成数据生成方案，旨在重现毛细波理论中已知的有限尺寸效应。尺寸为 $L$ 的有限系统的目标表面张力为\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) = \\gamma_{\\infty} + \\Delta \\gamma_{\\mathrm{cw}}(L), \\quad \\text{where} \\quad \\Delta \\gamma_{\\mathrm{cw}}(L) = - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right).\n$$\n为实现此目的，我们为 $\\Delta U$ 构建一个确定性微观系综，其均值 $\\langle \\Delta U \\rangle = \\mu(L)$ 和方差 $\\mathrm{Var}(\\Delta U) = \\sigma^2(L)$ 由以下公式给出：\n$$\n\\sigma^2(L) = c_U \\, k_B T \\, A \\, \\epsilon^2 \\quad \\text{and} \\quad \\mu(L) = 2 A \\epsilon \\, \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) + \\frac{\\beta}{2}\\sigma^2(L).\n$$\n通过将这些代入累积量展开，我们发现 $\\Delta F_{\\mathrm{est}}(L) = 2A\\epsilon\\,\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L)$。因此，计算出的测试面积表面张力将为 $\\gamma_{\\mathrm{TA}}(L) = \\Delta F_{\\mathrm{est}}(L) / (2 A \\epsilon) = \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L)$。程序将为每个 $L$ 计算此值。我们还通过减去理论毛细波贡献来计算修正后的表面张力：$\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\mathrm{TA}}(L) - \\Delta \\gamma_{\\mathrm{cw}}(L)$。根据构造，这应恢复真实的无限系统值，$\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\infty}$。\n\n最后，执行外推到无限系统极限的操作。毛细波理论预测，表观表面张力 $\\gamma_{\\mathrm{TA}}(L)$ 与变量 $x(L) = \\frac{\\ln(L/a)}{L^2}$ 之间存在线性关系。模型为\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\gamma_{\\infty}^{\\mathrm{fit}} - C^{\\mathrm{fit}} \\, x(L).\n$$\n我们将对三个数据点 $(\\gamma_{\\mathrm{TA}}(L), x(L))$ 进行线性最小二乘拟合，以确定截距，该截距对应于外推的无限系统表面张力 $\\gamma_{\\infty}^{\\mathrm{fit}}$。由于我们的合成数据 $\\gamma_{\\mathrm{TA}}(L)$ 被构造成完美地位于理论直线 $\\gamma_{\\infty} - \\frac{k_B T}{4\\pi}x(L)$ 上，因此拟合的截距 $\\gamma_{\\infty}^{\\mathrm{fit}}$ 预计在数值上与 $\\gamma_{\\infty}$ 相同。\n\n程序将对三种系统尺寸分别执行这些步骤，收集所得的十个值（每个 $L$ 对应的 $\\gamma_{\\mathrm{mech}}$、$\\gamma_{\\mathrm{TA}}$、$\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}$，以及 $\\gamma_{\\infty}^{\\mathrm{fit}}$），并以指定格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface tension via mechanical and thermodynamic routes,\n    analyzes finite-size effects, and performs an infinite-system extrapolation.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement in SI units.\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    T = 300.0           # Temperature (K)\n    GAMMA_INF = 0.005   # True infinite-system surface tension (N/m)\n    A_CUTOFF = 0.5e-9   # Microscopic cutoff length (m)\n    P0 = 1.0e5          # Base normal pressure (Pa)\n    L_Z = 12.0e-9       # Simulation cell height (m)\n    N_INTERFACES = 2    # Number of interfaces\n    W0 = 0.3e-9         # Intrinsic interfacial width (m)\n    EPSILON = 0.01      # In-plane strain\n    M_SAMPLES = 100     # Number of energy-perturbation samples\n    C_U = 0.1           # Dimensionless constant for energy variance\n\n    L_VALUES_NM = [2.0, 4.0, 8.0]\n    L_VALUES = [l * 1e-9 for l in L_VALUES_NM] # Lateral box sizes (m)\n    \n    results = []\n    gamma_ta_values_for_fit = []\n    x_fit_values = []\n\n    # Loop through each lateral box size\n    for L in L_VALUES:\n        # --- Mechanical Route Calculation ---\n        \n        # Capillary-broadened width\n        w_L_sq = W0**2 + (K_B * T) / (2 * np.pi * GAMMA_INF) * np.log(L / A_CUTOFF)\n        w_L = np.sqrt(w_L_sq)\n        \n        # Amplitude S(L)\n        S_L = GAMMA_INF / (np.sqrt(2 * np.pi) * w_L)\n        \n        # Discretized z-grid\n        z_grid = np.linspace(0, L_Z, 5001)\n        z1 = L_Z / 4.0\n        z2 = 3.0 * L_Z / 4.0\n        \n        # Pressure anisotropy profile\n        gauss1 = np.exp(-((z_grid - z1)**2) / (2 * w_L_sq))\n        gauss2 = np.exp(-((z_grid - z2)**2) / (2 * w_L_sq))\n        delta_p = S_L * (gauss1 + gauss2)\n        \n        # Pressure difference P_N - P_T = delta_p\n        pressure_difference = delta_p\n        \n        # Numerical integration using trapezoidal rule\n        integral_val = np.trapz(pressure_difference, z_grid)\n        \n        # Surface tension per interface\n        gamma_mech = integral_val / N_INTERFACES\n        results.append(gamma_mech)\n        \n        # --- Test-Area Route Calculation ---\n        \n        A = L**2 # Area of one interface\n        \n        # Capillary-wave finite-size correction term\n        delta_gamma_cw = - (K_B * T) / (4 * np.pi * L**2) * np.log(L / A_CUTOFF)\n        \n        # Target finite-size biased surface tension\n        gamma_ta_target = GAMMA_INF + delta_gamma_cw\n        \n        # Variance of microscopic energy changes\n        var_delta_u = C_U * K_B * T * A * EPSILON**2\n        \n        # Beta\n        beta = 1.0 / (K_B * T)\n        \n        # Mean of microscopic energy changes\n        mean_delta_u = 2 * A * EPSILON * gamma_ta_target + (beta / 2.0) * var_delta_u\n        \n        # The problem specifies a deterministic ensemble with this mean and variance.\n        # We can use these moments directly for the cumulant expansion.\n        delta_U_avg = mean_delta_u\n        delta_U_var = var_delta_u\n        \n        # Estimated free energy change\n        delta_F_est = delta_U_avg - (beta / 2.0) * delta_U_var\n        \n        # Test-area surface tension\n        gamma_ta = delta_F_est / (2 * A * EPSILON)\n        results.append(gamma_ta)\n        \n        # Finite-size-corrected test-area estimate\n        gamma_ta_corr = gamma_ta - delta_gamma_cw\n        results.append(gamma_ta_corr)\n        \n        # Store values for the final extrapolation fit\n        gamma_ta_values_for_fit.append(gamma_ta)\n        x_fit_values.append(np.log(L / A_CUTOFF) / L**2)\n\n    # --- Infinite-System Size Extrapolation ---\n    \n    # The model is: gamma_TA(L) = gamma_inf_fit - C_fit * x(L)\n    # This is a linear fit y = c + m*x, where:\n    # y = gamma_TA(L)\n    # x = x(L)\n    # c = gamma_inf_fit (intercept)\n    # m = -C_fit (slope)\n    \n    x_fit = np.array(x_fit_values)\n    y_fit = np.array(gamma_ta_values_for_fit)\n    \n    # Set up the design matrix for least-squares A*p = y\n    # A has columns [x, 1] to fit p=[slope, intercept]\n    A_fit = np.vstack([x_fit, np.ones(len(x_fit))]).T\n    \n    # Perform linear least-squares fit\n    # The model is y = m*x + c. lstsq returns [m, c].\n    m, c = np.linalg.lstsq(A_fit, y_fit, rcond=None)[0]\n    \n    gamma_inf_fit = c  # The intercept is the extrapolated value\n    results.append(gamma_inf_fit)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3423109"}]}