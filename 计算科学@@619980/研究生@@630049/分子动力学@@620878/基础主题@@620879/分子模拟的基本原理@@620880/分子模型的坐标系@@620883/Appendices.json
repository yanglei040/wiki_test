{"hands_on_practices": [{"introduction": "我们如何用最少数量的变量来精确描述一个分子的形状？这个练习将通过一个简单的三原子分子，引导你探索内部自由度（对于非线性分子是 $3N-6$）、坐标集的最小性，以及规范自由度（整体平移和旋转）的物理意义。掌握这些概念是构建任何分子模型和理解其构象空间的基础 [@problem_id:3406081]。", "problem": "考虑一个三原子分子，其标记原子为 $1, 2, 3$，笛卡尔坐标为 $\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3 \\in \\mathbb{R}^3$。定义内坐标 $r_{12} = \\lVert \\mathbf{R}_1 - \\mathbf{R}_2 \\rVert$，$r_{23} = \\lVert \\mathbf{R}_3 - \\mathbf{R}_2 \\rVert$，以及原子 $2$ 处的键角 $\\theta$ 为向量 $\\mathbf{R}_1 - \\mathbf{R}_2$ 和 $\\mathbf{R}_3 - \\mathbf{R}_2$ 之间的夹角。从欧几里得几何和三维空间中刚性运动的概念出发，分析集合 $(r_{12}, r_{23}, \\theta)$ 是否是一个最小内坐标集，它在整体平移和旋转的意义下唯一地确定了分子形状。通过刻画使 $(r_{12}, r_{23}, \\theta)$ 保持不变的变换，来识别此描述中固有的规范自由度，并讨论任何唯一性需要谨慎处理的特殊情况。\n\n选择所有正确的陈述：\n\nA. 对于任何具有标记原子的非共线三原子构型，内坐标 $(r_{12}, r_{23}, \\theta)$ 在全局刚性运动的意义下唯一地确定了分子形状；等价地说，共享这些值的任何两个笛卡尔实现都通过一次平移和一次正常旋转（proper rotation）相关联。\n\nB. 坐标集 $(r_{12}, r_{23}, \\theta)$ 不是最小的；必须包含 $r_{13}$ 来消除如果只使用一个角度时仍然存在的离散镜像模糊性。\n\nC. 从笛卡尔坐标计算自由度，并除去全局平移和旋转的规范群，表明一个非线性三原子分子有 $3$ 个内自由度，因此 $(r_{12}, r_{23}, \\theta)$ 是最小的。\n\nD. 剩余的规范自由度只有全局平移；全局旋转通过选择角度 $\\theta$ 而被固定，因此在这个坐标集中旋转不是一个规范自由度。\n\nE. 在线性极限 $\\theta = 0$ 或 $\\theta = \\pi$ 时，通过将 $\\mathbf{R}_2$ 置于原点并将 $\\mathbf{R}_1$ 置于 $x$ 轴上的典则规范固定来重构笛卡尔坐标，会留下一个绕 $x$ 轴的未确定的方位角旋转，这反映了构型的一个增强的稳定子群（stabilizer）；尽管如此，内坐标仍然在全局刚性运动的意义下确定了形状。", "solution": "用户希望我验证并解决一个关于三原子分子内坐标的问题。\n\n### 步骤 1：提取已知条件\n- **系统**：一个具有标记原子 $1, 2, 3$ 的三原子分子。\n- **笛卡尔坐标**：$\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3 \\in \\mathbb{R}^3$。\n- **内坐标**：\n  - 键长 $r_{12} = \\lVert \\mathbf{R}_1 - \\mathbf{R}_2 \\rVert$。\n  - 键长 $r_{23} = \\lVert \\mathbf{R}_3 - \\mathbf{R}_2 \\rVert$。\n  - 键角 $\\theta$ 是向量 $\\mathbf{R}_1 - \\mathbf{R}_2$ 和 $\\mathbf{R}_3 - \\mathbf{R}_2$ 之间的夹角。角度 $\\theta$ 通常定义在 $[0, \\pi]$ 范围内。\n- **任务**：\n  1. 分析集合 $(r_{12}, r_{23}, \\theta)$ 是否是一个最小内坐标集，它在整体平移和旋转的意义下唯一地确定了分子形状。\n  2. 刻画此描述中固有的规范自由度。\n  3. 讨论任何特殊情况。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实不健全性**：问题陈述在科学上是健全的。笛卡尔坐标、键长和键角的定义在分子物理和化学中是标准的。刚性运动（平移和旋转）、自由度和规范自由度的概念是描述分子构型的基础。\n2.  **不可形式化或不相关**：该问题可以使用欧几里得几何和群论的概念高度形式化，并且与分子坐标系的主题直接相关。\n3.  **不完整或矛盾的设置**：问题是自洽的。所提供的定义足以进行完整分析。没有矛盾之处。\n4.  **不切实际或不可行**：该设置描述了一个标准、理想化的三原子分子模型。它在物理上和数学上都是现实的。\n5.  **不适定或结构不良**：问题是适定的。它要求分析坐标系的属性（最小性、唯一性），这有一个确定的答案。\n6.  **伪深刻、琐碎或同义反复**：问题并非琐碎。它需要对构型空间、商空间以及坐标系中的潜在奇点有仔细的理解。\n7.  **超出科学可验证性**：这些主张可以使用数学几何严格证明或证伪。\n\n### 步骤 3：结论和行动\n问题陈述是**有效的**。可以进行分析。\n\n### 坐标系分析\n\n一个有 $N$ 个原子的分子由 $3N$ 个笛卡尔坐标描述。对于这个三原子分子，$N=3$，所以我们从 $\\mathbb{R}^9$ 中的 $3 \\times 3 = 9$ 个笛卡尔坐标开始。分子的“形状”是其几何结构，与其在空间中的位置和方向无关。这些对应于全局平移（3个自由度）和全局旋转（对于非线性分子有3个自由度）的“规范”自由度。这些变换的群是特殊欧几里得群 $SE(3)$。\n\n因此，描述非线性分子形状的内自由度数量为 $3N - 6$。对于三原子分子（$N=3$），这个数量是 $3(3) - 6 = 3$。这是内构型空间或“形状空间”的维度。\n\n提议的坐标集是 $(r_{12}, r_{23}, \\theta)$。它包含 $3$ 个参数。\n\n### 逐项分析\n\n**A. 对于任何具有标记原子的非共线三原子构型，内坐标 $(r_{12}, r_{23}, \\theta)$ 在全局刚性运动的意义下唯一地确定了分子形状；等价地说，共享这些值的任何两个笛卡尔实现都通过一次平移和一次正常旋转（proper rotation）相关联。**\n\n内坐标 $(r_{12}, r_{23}, \\theta)$ 定义了一个以原子 $1, 2, 3$ 的位置为顶点的三角形。两条边的长度直接由 $r_{12}$ 和 $r_{23}$ 给出，这两条边之间的夹角是 $\\theta$。根据余弦定理，第三条边 $r_{13} = \\lVert \\mathbf{R}_1 - \\mathbf{R}_3 \\rVert$ 的长度是确定的：\n$$r_{13}^2 = r_{12}^2 + r_{23}^2 - 2 r_{12} r_{23} \\cos\\theta$$\n因此，指定 $(r_{12}, r_{23}, \\theta)$ 等价于指定三条边的长度 $(r_{12}, r_{23}, r_{13})$。根据欧几里得几何的边-边-边（SSS）或边-角-边（SAS）全等定理，这个三角形的形状是唯一确定的。\n\n三维空间中任何两个边长相同的三角形都是全等的。在 $\\mathbb{R}^3$ 中，全等意味着一个三角形可以通过等距变换映射到另一个三角形，等距变换是平移和正交变换（$O(3)$ 的一个元素）的复合。$O(3)$ 群包括正常旋转（行列式为 $+1$，属于 $SO(3)$）和非正常旋转（行列式为 $-1$，例如反射）。\n\n该陈述声称唯一性是在*正常*旋转和平移的意义下，即通过 $SE(3)$ 的一个元素进行变换。这等价于询问一个三原子分子是否是手性的。如果一个构型的镜像不能通过正常旋转与原始构型重合，则该构型是手性的。三原子分子必然是平面的。任何平面图形都是非手性的。它的镜像总是可以通过在 $\\mathbb{R}^3$ 中的正常旋转与原始图形重合。例如，通过分子平面的反射是恒等变换，而通过一个垂直于分子平面的平面的反射可以被证明等价于绕分子平面内的一个轴旋转 $\\pi$ 弧度。因此，具有相同内坐标 $(r_{12}, r_{23}, \\theta)$ 的分子的任何两个笛卡尔实现都通过平移和正常旋转相关联。该陈述是正确的。\n\n**关于A的结论：正确**\n\n**B. 坐标集 $(r_{12}, r_{23}, \\theta)$ 不是最小的；必须包含 $r_{13}$ 来消除如果只使用一个角度时仍然存在的离散镜像模糊性。**\n\n该陈述提出了两个主张。首先，它声称该集合不是最小的。如前所述，非线性三原子分子的内自由度数量为 $3$。对于非共线分子，集合 $(r_{12}, r_{23}, \\theta)$ 有 $3$ 个独立参数。因此，它是一个最小集。包含 $r_{13}$ 会使该集合变得冗余（过完备），因为 $r_{13}$ 是其他三个坐标的函数。其次，它声称存在“离散镜像模糊性”。正如对选项A的分析，三原子分子是平面的，因此是非手性的。不存在镜像模糊性；定义的形状在正常刚性运动的意义下是唯一的。这个问题对于手性分子（至少需要4个原子）是相关的，其中需要像二面角这样的坐标来区分对映异构体，但对于三原子系统则不相关。\n\n**关于B的结论：不正确**\n\n**C. 从笛卡尔坐标计算自由度，并除去全局平移和旋转的规范群，表明一个非线性三原子分子有 $3$ 个内自由度，因此 $(r_{12}, r_{23}, \\theta)$ 是最小的。**\n\n该陈述提出了计算内自由度数量的标准论证。从 $N=3$ 个原子开始，我们有 $3N=9$ 个笛卡尔坐标。分子形状在刚性运动（3次平移，3次旋转）的 $6$ 维李群 $SE(3)$ 下是不变的。因此，分子形状空间（对于非线性分子）的维度是 $3N-6 = 3(3)-6 = 3$。如果一个坐标集由这个数量的独立参数组成，那么它就是最小的。集合 $(r_{12}, r_{23}, \\theta)$ 包含 $3$ 个参数，在非共线情况下是局部独立的。该集合是最小的这一结论是正确的。\n\n**关于C的结论：正确**\n\n**D. 剩余的规范自由度只有全局平移；全局旋转通过选择角度 $\\theta$ 而被固定，因此在这个坐标集中旋转不是一个规范自由度。**\n\n这个陈述有根本性的错误。内坐标 $(r_{12}, r_{23}, \\theta)$ 根据其定义，是由向量差构建的标量。它们在全局平移（$\\mathbf{R}_i \\to \\mathbf{R}_i + \\mathbf{a}$）和全局旋转（$\\mathbf{R}_i \\to Q\\mathbf{R}_i$ 对于 $Q \\in SO(3)$）下都显然是不变的。角度 $\\theta$ 本身就是内坐标之一；它并不能“固定”分子在空间中的整体取向。整个分子框架可以任意旋转而不改变 $r_{12}$、$r_{23}$ 或 $\\theta$。旋转不变性是这个坐标集的一个定义属性，意味着旋转是一种规范自由度。\n\n**关于D的结论：不正确**\n\n**E. 在线性极限 $\\theta = 0$ 或 $\\theta = \\pi$ 时，通过将 $\\mathbf{R}_2$ 置于原点并将 $\\mathbf{R}_1$ 置于 $x$ 轴上的典则规范固定来重构笛卡尔坐标，会留下一个绕 $x$ 轴的未确定的方位角旋转，这反映了构型的一个增强的稳定子群（stabilizer）；尽管如此，内坐标仍然在全局刚性运动的意义下确定了形状。**\n\n让我们分析线性构型，其中 $\\theta=0$ 或 $\\theta=\\pi$。在这种情况下，所有三个原子都位于一条直线上。改变构型的旋转自由度数量只有 $2$ 个，因为绕分子轴的旋转不会改变原子位置。这就是所提到的“增强的稳定子群”：对于线性物体，使其保持不变的旋转对称群是 $SO(2)$，而对于非线性物体，它是平凡群。这意味着形状空间的维度是 $3N-5=4$。然而，这里的问题是关于坐标集描述形状的能力，而不是其对动力学的适用性。\n\n让我们执行规范固定：1. 将 $\\mathbf{R}_2$ 置于原点：$\\mathbf{R}_2 = (0, 0, 0)$。这固定了 3 个平移自由度。2. 将 $\\mathbf{R}_1$ 置于正 $x$ 轴上：$\\mathbf{R}_1 = (r_{12}, 0, 0)$。这固定了 2 个旋转自由度。第三个旋转自由度是绕 $1-2$ 键轴（即 $x$ 轴）的方位角旋转。对于非线性分子（$\\theta \\in (0, \\pi)$），原子 $3$ 不在此轴上。我们可以通过例如要求原子 $3$ 位于 $xy$ 平面的上半部分（$z_3=0, y_3>0$）来固定这最后一个旋转自由度。对于线性分子（$\\theta=0$ 或 $\\theta=\\pi$），原子 $3$ 也位于 $x$ 轴上。它的位置是 $\\mathbf{R}_3 = (r_{23} \\cos\\theta, 0, 0)$。绕 $x$ 轴的旋转不会移动原子 $3$。因此，这个旋转自由度是“未确定的”，或者更准确地说，是简并的；规范固定过程是奇异的。该陈述正确地指出了这一现象。\n\n第二部分声称，“内坐标仍然在全局刚性运动的意义下确定了形状”。给定 $(r_{12}, r_{23}, \\theta=\\pi)$，我们知道原子 $3$ 与 $1$ 和 $2$ 共线，且 $2$ 在中间。形状是一条总长度为 $r_{12}+r_{23}$ 的线段。这是一个唯一确定的几何形状。这个线性分子的任何笛卡尔实现都可以通过平移和旋转与任何其他实现重合。坐标系在这一点的奇异性（对于动力学来说是一个弱点）并不妨碍它指定静态几何。该陈述的两个部分都是正确的。\n\n**关于E的结论：正确**", "answer": "$$\\boxed{ACE}$$", "id": "3406081"}, {"introduction": "在静态描述的基础上，本练习将深入探讨动力学问题。它将演示如何用内坐标表达一个分子的动能，这直接引出了用于振动分析的 Wilson GF 矩阵方法。通过为一个线性三原子分子推导其动力学矩阵并计算振动频率，你将亲身体会到坐标系的选择和原子质量如何直接决定分子的内在动态行为 [@problem_id:3406082]。", "problem": "一个线性的、对称的三原子分子 $\\mathrm{A{-}B{-}A}$，其平衡构型沿 $x$ 轴排列，中心原子 $\\mathrm{B}$ 位于原点，端点原子 $\\mathrm{A}$ 位于大小相等、方向相反的位置上。端点原子质量均为 $m$，中心原子质量为 $M$。仅考虑两个键伸缩内坐标，对于小位移，它们定义为 $q_{1}$ 等于 $\\mathrm{A}_{1}{-}\\mathrm{B}$ 键长的瞬时变化量，$q_{2}$ 等于 $\\mathrm{B}{-}\\mathrm{A}_{2}$ 键长的瞬时变化量。假设无弯曲运动，并忽略转动和平动，除非内坐标运动学要求。\n\n使用经典力学的基本定义，按以下步骤进行：\n\n- 从笛卡尔动能 $T = \\frac{1}{2}\\sum_{i} m_{i} \\dot{\\boldsymbol{r}}_{i}\\cdot \\dot{\\boldsymbol{r}}_{i}$ 和内坐标速度与笛卡尔速度在小位移下的线性运动学关系出发，该关系由矩阵 $\\mathbf{B}$ 表示，定义为 $\\dot{\\boldsymbol{q}} = \\mathbf{B}\\,\\dot{\\boldsymbol{x}}$，其中 $\\dot{\\boldsymbol{x}}$ 拼接了笛卡尔速度分量。推导出显式的 $2\\times 2$ 矩阵 $\\mathbf{G}$，使得用内坐标表示的动能为 $T = \\frac{1}{2}\\,\\dot{\\boldsymbol{q}}^{\\mathsf{T}} \\mathbf{G}\\, \\dot{\\boldsymbol{q}}$。你必须只用 $m$ 和 $M$ 来表示 $\\mathbf{G}$。\n\n- 在谐振近似下，取内坐标下的势能为 $V = \\frac{1}{2}\\,\\boldsymbol{q}^{\\mathsf{T}} \\mathbf{F}\\, \\boldsymbol{q}$，其中 $\\mathbf{F} = k\\,\\mathbf{I}_{2}$，$k$ 是一个正的力常数，$\\mathbf{I}_{2}$ 是 $2\\times 2$ 单位矩阵。从拉格朗日量和欧拉-拉格朗日方程出发，证明在这些内坐标下，小振幅振动角频率的平方是 $\\mathbf{G}^{-1}\\mathbf{F}$ 的特征值，这符合 Wilson $\\mathbf{G}$-矩阵和 $\\mathbf{F}$-矩阵方法 (GF) 的意义。\n\n- 以闭合形式计算 $\\mathbf{G}^{-1}\\mathbf{F}$ 的两个特征值中较大的一个，即较大的角频率平方，作为 $m$，$M$ 和 $k$ 的符号表达式。\n\n将最终答案表示为单个闭合形式的解析表达式。不需要数值计算。最终答案中不要包含单位。不需要四舍五入。", "solution": "首先验证该问题，以确保其科学上成立、提法恰当且客观。\n\n**步骤 1：提取已知条件**\n- 系统：一个线性的、对称的三原子分子 $\\mathrm{A{-}B{-}A}$。\n- 构型：分子位于 $x$ 轴上。中心原子 $\\mathrm{B}$ 位于原点。端点原子 $\\mathrm{A}$ 位于大小相等、方向相反的位置。\n- 质量：每个端点原子 $\\mathrm{A}$ 的质量为 $m$。中心原子 $\\mathrm{B}$ 的质量为 $M$。\n- 内坐标：考虑两个键伸缩坐标，用于小位移。$q_{1}$ 是 $\\mathrm{A}_{1}{-}\\mathrm{B}$ 键长的变化量。$q_{2}$ 是 $\\mathrm{B}{-}\\mathrm{A}_{2}$ 键长的变化量。\n- 约束：无弯曲运动。忽略转动和平动，除非内坐标运动学要求（意味着线性动量守恒）。\n- 动能（笛卡尔坐标）：定义为 $T = \\frac{1}{2}\\sum_{i} m_{i} \\dot{\\boldsymbol{r}}_{i}\\cdot \\dot{\\boldsymbol{r}}_{i}$。\n- 动能（内坐标）：问题定义了一个矩阵 $\\mathbf{G}$，使得 $T = \\frac{1}{2}\\,\\dot{\\boldsymbol{q}}^{\\mathsf{T}} \\mathbf{G}\\, \\dot{\\boldsymbol{q}}$。\n- 势能（内坐标）：$V = \\frac{1}{2}\\,\\boldsymbol{q}^{\\mathsf T} \\mathbf{F}\\, \\boldsymbol{q}$，其中 $\\mathbf{F} = k\\,\\mathbf{I}_{2}$，$k > 0$，$\\mathbf{I}_{2}$ 是 $2\\times 2$ 单位矩阵。\n- 任务：\n  1. 推导 $2\\times 2$ 矩阵 $\\mathbf{G}$，用 $m$ 和 $M$ 表示。\n  2. 使用拉格朗日形式，证明振动角频率的平方 $\\omega^2$ 是 $\\mathbf{G}^{-1}\\mathbf{F}$ 的特征值。\n  3. 计算 $\\mathbf{G}^{-1}\\mathbf{F}$ 的两个特征值中较大的一个。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是经典分子动力学中的一个标准练习，特别是使用 Wilson GF 矩阵方法的振动分析。它在科学上是合理的，提法恰当且客观。已知条件是完整且一致的。动能矩阵 $\\mathbf{G}$ 的定义是非标准的；在 Wilson 形式中，动能通常写为 $T = \\frac{1}{2}\\dot{\\boldsymbol{q}}^{\\mathsf T} \\mathbf{G}_{\\text{Wilson}}^{-1} \\dot{\\boldsymbol{q}}$。因此，问题中的 $\\mathbf{G}$ 是标准 Wilson $\\mathbf{G}$-矩阵的逆矩阵，即 $\\mathbf{G} = \\mathbf{G}_{\\text{Wilson}}^{-1}$。这是一个有效的数学对象，并且问题在此定义下是自洽的。\n\n**步骤 3：结论与行动**\n问题有效。将提供一个完整的、有理有据的解答。\n\n**第 1 部分：动能矩阵 $\\mathbf{G}$ 的推导**\n\n设三个原子索引为 1 ($\\mathrm{A}_{1}$)，2 ($\\mathrm{B}$) 和 3 ($\\mathrm{A}_{2}$)。它们的质量分别为 $m_1=m$，$m_2=M$ 和 $m_3=m$。设它们沿 $x$ 轴偏离平衡位置的小位移分别为 $x_1$，$x_2$ 和 $x_3$。在这些笛卡尔坐标系中的动能为：\n$$T = \\frac{1}{2}m\\dot{x}_1^2 + \\frac{1}{2}M\\dot{x}_2^2 + \\frac{1}{2}m\\dot{x}_3^2$$\n内坐标 $q_1$ 和 $q_2$ 定义为键长的变化。对于小位移，它们是笛卡尔位移的线性组合：\n$$q_1 = x_2 - x_1$$\n$$q_2 = x_3 - x_2$$\n对时间求导，得到速度之间的关系：\n$$\\dot{q}_1 = \\dot{x}_2 - \\dot{x}_1$$\n$$\\dot{q}_2 = \\dot{x}_3 - \\dot{x}_2$$\n问题指出分子的整体平动被忽略。这是通过质心保持静止的条件来强制执行的，意味着总线性动量为零：\n$$m\\dot{x}_1 + M\\dot{x}_2 + m\\dot{x}_3 = 0$$\n我们必须用内坐标速度 $\\dot{q}_1$，$\\dot{q}_2$ 来表示笛卡尔速度 $\\dot{x}_1$，$\\dot{x}_2$，$\\dot{x}_3$。根据 $\\dot{q}_1$ 和 $\\dot{q}_2$ 的定义：\n$$\\dot{x}_1 = \\dot{x}_2 - \\dot{q}_1$$\n$$\\dot{x}_3 = \\dot{x}_2 + \\dot{q}_2$$\n将这些代入零动量条件：\n$$m(\\dot{x}_2 - \\dot{q}_1) + M\\dot{x}_2 + m(\\dot{x}_2 + \\dot{q}_2) = 0$$\n$$(2m+M)\\dot{x}_2 - m\\dot{q}_1 + m\\dot{q}_2 = 0$$\n解出 $\\dot{x}_2$：\n$$\\dot{x}_2 = \\frac{m}{2m+M}(\\dot{q}_1 - \\dot{q}_2)$$\n现在我们求 $\\dot{x}_1$ 和 $\\dot{x}_3$：\n$$\\dot{x}_1 = \\frac{m}{2m+M}(\\dot{q}_1 - \\dot{q}_2) - \\dot{q}_1 = \\frac{m\\dot{q}_1 - m\\dot{q}_2 - (2m+M)\\dot{q}_1}{2m+M} = \\frac{-(m+M)\\dot{q}_1 - m\\dot{q}_2}{2m+M}$$\n$$\\dot{x}_3 = \\frac{m}{2m+M}(\\dot{q}_1 - \\dot{q}_2) + \\dot{q}_2 = \\frac{m\\dot{q}_1 - m\\dot{q}_2 + (2m+M)\\dot{q}_2}{2m+M} = \\frac{m\\dot{q}_1 + (m+M)\\dot{q}_2}{2m+M}$$\n现在，我们将这些表达式代回动能方程 $2T = m\\dot{x}_1^2 + M\\dot{x}_2^2 + m\\dot{x}_3^2$。\n设 $\\mu_T = 2m+M$。\n$$2T = \\frac{m}{\\mu_T^2} \\left[ -(m+M)\\dot{q}_1 - m\\dot{q}_2 \\right]^2 + \\frac{M}{\\mu_T^2} \\left[ m\\dot{q}_1 - m\\dot{q}_2 \\right]^2 + \\frac{m}{\\mu_T^2} \\left[ m\\dot{q}_1 + (m+M)\\dot{q}_2 \\right]^2$$\n展开平方项：\n$$2T\\mu_T^2 = m\\left[ (m+M)^2\\dot{q}_1^2 + m^2\\dot{q}_2^2 + 2m(m+M)\\dot{q}_1\\dot{q}_2 \\right] + M\\left[ m^2\\dot{q}_1^2 + m^2\\dot{q}_2^2 - 2m^2\\dot{q}_1\\dot{q}_2 \\right] + m\\left[ m^2\\dot{q}_1^2 + (m+M)^2\\dot{q}_2^2 + 2m(m+M)\\dot{q}_1\\dot{q}_2 \\right]$$\n收集 $\\dot{q}_1^2$, $\\dot{q}_2^2$, 和 $\\dot{q}_1\\dot{q}_2$ 的系数：\n- $\\dot{q}_1^2$ 的系数: $m(m+M)^2 + Mm^2 + m^3 = m(m^2+2mM+M^2) + m^2M + m^3 = 2m^3 + 3m^2M + mM^2 = m(2m^2 + 3mM + M^2) = m(2m+M)(m+M) = m\\mu_T(m+M)$.\n- $\\dot{q}_2^2$ 的系数: $m^3 + Mm^2 + m(m+M)^2$。根据对称性，这也是 $m\\mu_T(m+M)$。\n- $\\dot{q}_1\\dot{q}_2$ 的系数: $2m^2(m+M) - 2m^2M + 2m^2(m+M) = 4m^2(m+M) - 2m^2M = 4m^3 + 4m^2M - 2m^2M = 4m^3 + 2m^2M = 2m^2(2m+M) = 2m^2\\mu_T$。\n所以，$2T\\mu_T^2 = m\\mu_T(m+M)\\dot{q}_1^2 + m\\mu_T(m+M)\\dot{q}_2^2 + 2m^2\\mu_T\\dot{q}_1\\dot{q}_2$。\n除以 $\\mu_T$：\n$$2T\\mu_T = m(m+M)(\\dot{q}_1^2 + \\dot{q_2}^2) + 2m^2\\dot{q}_1\\dot{q}_2$$\n$$2T = \\frac{m(m+M)}{2m+M}\\dot{q}_1^2 + \\frac{m(m+M)}{2m+M}\\dot{q}_2^2 + \\frac{2m^2}{2m+M}\\dot{q}_1\\dot{q}_2$$\n动能以 $T = \\frac{1}{2}\\dot{\\boldsymbol{q}}^{\\mathsf{T}}\\mathbf{G}\\dot{\\boldsymbol{q}}$ 的形式给出，对于对称矩阵 $\\mathbf{G}$，展开为 $2T = G_{11}\\dot{q}_1^2 + G_{22}\\dot{q}_2^2 + 2G_{12}\\dot{q}_1\\dot{q}_2$。通过比较系数，我们确定 $\\mathbf{G}$ 的元素：\n$$G_{11} = G_{22} = \\frac{m(m+M)}{2m+M}$$\n$$G_{12} = G_{21} = \\frac{m^2}{2m+M}$$\n因此，矩阵 $\\mathbf{G}$ 是：\n$$\\mathbf{G} = \\frac{m}{2m+M} \\begin{pmatrix} m+M  m \\\\ m  m+M \\end{pmatrix}$$\n\n**第 2 部分：源于拉格朗日量的特征值问题**\n\n系统的拉格朗日量 $L$ 为 $L = T - V$。使用给定的 $T$ 和 $V$ 的矩阵形式：\n$$L = \\frac{1}{2}\\dot{\\boldsymbol{q}}^{\\mathsf{T}}\\mathbf{G}\\dot{\\boldsymbol{q}} - \\frac{1}{2}\\boldsymbol{q}^{\\mathsf{T}}\\mathbf{F}\\boldsymbol{q}$$\n欧拉-拉格朗日方程为 $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_i}\\right) - \\frac{\\partial L}{\\partial q_i} = 0$ for $i=1,2$。\n我们来计算偏导数：\n$$\\frac{\\partial L}{\\partial \\dot{q}_i} = \\sum_{j=1}^{2} G_{ij}\\dot{q}_j \\quad \\implies \\quad \\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_i}\\right) = \\sum_{j=1}^{2} G_{ij}\\ddot{q}_j$$\n$$\\frac{\\partial L}{\\partial q_i} = -\\sum_{j=1}^{2} F_{ij}q_j$$\n欧拉-拉格朗日方程变为：\n$$\\sum_{j=1}^{2} G_{ij}\\ddot{q}_j + \\sum_{j=1}^{2} F_{ij}q_j = 0$$\n以矩阵形式，这是一个微分方程组：\n$$\\mathbf{G}\\ddot{\\boldsymbol{q}} + \\mathbf{F}\\boldsymbol{q} = \\mathbf{0}$$\n为了找到振动的简正模式，我们寻找形式为 $\\boldsymbol{q}(t) = \\boldsymbol{q}_0 e^{i\\omega t}$ 的解，其中 $\\boldsymbol{q}_0$ 是一个恒定的振幅向量，$\\omega$ 是角频率。二次时间导数为 $\\ddot{\\boldsymbol{q}}(t) = -\\omega^2 \\boldsymbol{q}_0 e^{i\\omega t} = -\\omega^2 \\boldsymbol{q}(t)$。\n将此代入运动方程：\n$$\\mathbf{G}(-\\omega^2\\boldsymbol{q}) + \\mathbf{F}\\boldsymbol{q} = \\mathbf{0}$$\n$$(\\mathbf{F} - \\omega^2\\mathbf{G})\\boldsymbol{q} = \\mathbf{0}$$\n这是一个广义特征值问题。对于非平凡解（$\\boldsymbol{q} \\neq \\mathbf{0}$），系数矩阵的行列式必须为零：$\\det(\\mathbf{F} - \\omega^2\\mathbf{G}) = 0$。\n矩阵 $\\mathbf{G}$ 是可逆的，因为它的行列式 $\\det(\\mathbf{G}) = \\left(\\frac{m}{2m+M}\\right)^2 [(m+M)^2 - m^2] = \\left(\\frac{m}{2m+M}\\right)^2 (M^2+2mM) = \\frac{m^2 M(M+2m)}{(2m+M)^2} \\neq 0$ (对于正质量 $m, M$)。我们可以用 $\\mathbf{G}^{-1}$ 左乘运动方程：\n$$\\mathbf{G}^{-1}(\\mathbf{F} - \\omega^2\\mathbf{G})\\boldsymbol{q} = \\mathbf{0}$$\n$$(\\mathbf{G}^{-1}\\mathbf{F} - \\omega^2\\mathbf{G}^{-1}\\mathbf{G})\\boldsymbol{q} = \\mathbf{0}$$\n$$(\\mathbf{G}^{-1}\\mathbf{F} - \\omega^2\\mathbf{I})\\boldsymbol{q} = \\mathbf{0}$$\n这是矩阵 $\\mathbf{G}^{-1}\\mathbf{F}$ 的一个标准特征值方程。它证明了角频率的平方 $\\omega^2$ 是矩阵 $\\mathbf{G}^{-1}\\mathbf{F}$ 的特征值。\n\n**第 3 部分：计算较大的特征值**\n\n我们需要计算 $\\mathbf{G}^{-1}\\mathbf{F}$ 的特征值。首先，我们求 $\\mathbf{G}^{-1}$。\n$$\\mathbf{G}^{-1} = \\frac{1}{\\det(\\mathbf{G})} \\begin{pmatrix} G_{22}  -G_{12} \\\\ -G_{21}  G_{11} \\end{pmatrix} = \\frac{(2m+M)^2}{m^2M(2m+M)} \\frac{m}{2m+M} \\begin{pmatrix} m+M  -m \\\\ -m  m+M \\end{pmatrix}$$\n$$\\mathbf{G}^{-1} = \\frac{1}{mM} \\begin{pmatrix} m+M  -m \\\\ -m  m+M \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{m}+\\frac{1}{M}  -\\frac{1}{M} \\\\ -\\frac{1}{M}  \\frac{1}{m}+\\frac{1}{M} \\end{pmatrix}$$\n这就是标准的 Wilson $\\mathbf{G}$-矩阵，$\\mathbf{G}_{\\text{Wilson}}$。\n矩阵 $\\mathbf{F}$ 给出为 $\\mathbf{F} = k\\mathbf{I}_2 = \\begin{pmatrix} k  0 \\\\ 0  k \\end{pmatrix}$。\n乘积 $\\mathbf{G}^{-1}\\mathbf{F}$ 是：\n$$\\mathbf{G}^{-1}\\mathbf{F} = \\mathbf{G}_{\\text{Wilson}}(k\\mathbf{I}_2) = k\\mathbf{G}_{\\text{Wilson}} = k \\begin{pmatrix} \\frac{1}{m}+\\frac{1}{M}  -\\frac{1}{M} \\\\ -\\frac{1}{M}  \\frac{1}{m}+\\frac{1}{M} \\end{pmatrix}$$\n该矩阵的特征值是 $\\omega^2$ 的值。设 $\\lambda = \\omega^2$。$k\\mathbf{A}$ 的特征值是 $\\mathbf{A}$ 的特征值的 $k$ 倍。所以我们求出 $\\mathbf{G}_{\\text{Wilson}}$ 的特征值再乘以 $k$。\n设 $\\lambda'$ 是 $\\mathbf{G}_{\\text{Wilson}}$ 的一个特征值。特征方程为 $\\det(\\mathbf{G}_{\\text{Wilson}} - \\lambda'\\mathbf{I}) = 0$。\n设 $a = \\frac{1}{m}+\\frac{1}{M}$ 和 $b = -\\frac{1}{M}$。\n$$\\det \\begin{pmatrix} a-\\lambda'  b \\\\ b  a-\\lambda' \\end{pmatrix} = 0$$\n$$(a-\\lambda')^2 - b^2 = 0 \\implies a-\\lambda' = \\pm b \\implies \\lambda' = a \\mp b$$\n$\\mathbf{G}_{\\text{Wilson}}$ 的两个特征值是：\n$$\\lambda'_1 = a - b = \\left(\\frac{1}{m}+\\frac{1}{M}\\right) - \\left(-\\frac{1}{M}\\right) = \\frac{1}{m} + \\frac{2}{M}$$\n$$\\lambda'_2 = a + b = \\left(\\frac{1}{m}+\\frac{1}{M}\\right) + \\left(-\\frac{1}{M}\\right) = \\frac{1}{m}$$\n$\\mathbf{G}^{-1}\\mathbf{F}$ 的特征值是 $\\omega^2 = k\\lambda'$。\n$$\\omega_1^2 = k\\lambda'_1 = k\\left(\\frac{1}{m} + \\frac{2}{M}\\right)$$\n$$\\omega_2^2 = k\\lambda'_2 = \\frac{k}{m}$$\n我们需要找到这两个特征值中较大的一个。由于 $m$，$M$ 和 $k$ 是正的物理量，$\\frac{2}{M}$ 是一个正项。因此：\n$$\\frac{1}{m} + \\frac{2}{M} > \\frac{1}{m}$$\n这意味着 $k\\left(\\frac{1}{m} + \\frac{2}{M}\\right) > \\frac{k}{m}$。\n较大的角频率平方是 $\\omega_1^2$。\n这个特征值对应于分子的非对称伸缩模式。\n较大特征值的最终表达式是 $k\\left(\\frac{1}{m} + \\frac{2}{M}\\right)$。", "answer": "$$\n\\boxed{k\\left(\\frac{1}{m} + \\frac{2}{M}\\right)}\n$$", "id": "3406082"}, {"introduction": "现代分子模拟通常在周期性边界条件下进行，并常常允许模拟盒子本身进行动态变化以维持恒定压力。最后一个练习将我们的视角从单个分子扩展到整个模拟体系，将盒子的几何形状视为额外的广义坐标。通过这个练习，你将学会如何正确计算这样一个包含可变晶胞的系统的总自由度，这是正确实现和理解恒压（NPT）系综模拟的关键一步 [@problem_id:3406096]。", "problem": "考虑一个由 $N$ 个点状粒子组成的系统，其位置为 $\\{\\mathbf{r}_i\\}_{i=1}^N$，处于一个遵循周期性边界条件（PBC）的三维周期性晶胞中。周期性晶胞由一个 $3\\times 3$ 的矩阵 $\\mathbf{h}$ 表示，其列向量是晶格矢量。引入缩放（分数）坐标 $\\{\\mathbf{s}_i\\}_{i=1}^N$，使得 $\\mathbf{r}_i=\\mathbf{h}\\,\\mathbf{s}_i$，其中 $\\mathbf{s}_i$ 的每个分量被限制在区间 $[0,1)$ 内（在 PBC 下以 1 为模）。假设粒子坐标之间没有完整约束（没有刚性键），并且不固定质心，也不预先移除任何整体的平移或转动自由度。\n\n比较以下两种情况：\n\n1. 固定晶胞情况：$\\mathbf{h}$ 不随时间变化，且不属于动力学变量；广义坐标取为粒子坐标（在 $\\mathbf{h}$ 固定的情况下，你可以等效地使用 $\\{\\mathbf{r}_i\\}$ 或 $\\{\\mathbf{s}_i\\}$）。\n2. 完全可变恒压器情况：晶胞矩阵 $\\mathbf{h}(t)$ 被视为一组额外的广义坐标，并且其形状和体积（三斜晶胞）可以涨落。为了避免因晶格基矢变化下分解式 $\\mathbf{r}_i=\\mathbf{h}\\,\\mathbf{s}_i$ 的非唯一性而导致的重复计数，施加一个规范固定约定，即 $\\mathbf{h}$ 是一个对角线元素为正的上三角矩阵。\n\n从拉格朗日力学中广义坐标的定义出发，并识别出由映射 $\\mathbf{r}_i=\\mathbf{h}\\,\\mathbf{s}_i$ 产生的冗余，确定在每种情况下系统有多少个独立的广义坐标，以及在所述规范下，从固定晶胞情况转变为完全可变恒压器情况时增加了多少坐标。选择正确并精确陈述计数的选项。\n\nA. 固定晶胞：$3N$。可变恒压器：$3N+9$。增加的坐标数：$9$。\n\nB. 固定晶胞：$3N$。可变恒压器：$3N+6$。增加的坐标数：$6$。\n\nC. 固定晶胞：$3N-3$（移除整体平移）。可变恒压器：$3N+3$。增加的坐标数：$6$。\n\nD. 固定晶胞：$3N$。可变恒压器：$3N+1$（只有体积涨落）。增加的坐标数：$1$。\n\nE. 固定晶胞：$3N$。可变恒压器：$3N+5$（一个来自 $\\det\\mathbf{h}>0$ 的约束）。增加的坐标数：$5$。", "solution": "问题要求在涉及周期性边界条件的两种不同情况下，一个 $N$ 粒子系统的独立广义坐标数量。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 由 $N$ 个点状粒子组成的系统，其位置为 $\\{\\mathbf{r}_i\\}_{i=1}^N$。\n- 由一个 $3 \\times 3$ 矩阵 $\\mathbf{h}$ 定义的三维周期性晶胞。\n- 缩放（分数）坐标 $\\{\\mathbf{s}_i\\}_{i=1}^N$ 通过 $\\mathbf{r}_i=\\mathbf{h}\\,\\mathbf{s}_i$ 与笛卡尔坐标相关联。\n- $\\mathbf{s}_i$ 的每个分量都在区间 $[0,1)$ 内（以 1 为模）。\n- 粒子坐标之间没有完整约束。\n- 不固定质心，也不预先移除整体的平移或转动自由度。\n- 情况 1 (固定晶胞)：$\\mathbf{h}$ 是常数。广义坐标是粒子坐标。\n- 情况 2 (完全可变恒压器)：$\\mathbf{h}(t)$ 是一组广义坐标。晶胞是三斜的，形状和体积可以涨落。\n- 情况 2 的规范固定：$\\mathbf{h}$ 是一个对角线元素为正的上三角矩阵。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、定义明确的且客观的。\n- **科学依据：** 使用晶胞矩阵 $\\mathbf{h}$ 和缩放坐标 $\\mathbf{s}_i$ 来描述周期性系统是计算凝聚态物理和分子动力学中的标准表述（例如，在 Parrinello-Rahman 动力学的背景下）。广义坐标的概念是拉格朗日力学的基础。对晶胞矩阵进行规范固定的程序是处理模拟晶胞旋转冗余的标准且正确的技术。\n- **定义明确：** 问题清晰地定义了两种情况，并要求计算每种情况下的一个特定量（独立广义坐标的数量）。约束和假设（例如，“不固定质心”、“h 是上三角矩阵”）都是明确的，从而导出一个唯一且定义明确的答案。\n- **客观性：** 语言是正式且无歧义的。所有术语在物理学和数学中都有精确的含义。\n\n该问题没有违反任何无效性标准。这是一个应用于分子模拟的理论力学中的有效、正式的问题。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。我将继续进行推导和求解。\n\n### 推导\n\n一个力学系统的独立广义坐标数量等于其自由度数，也就是其构型空间的维度。我们需要为所述的两种情况分别确定这个数量。\n\n**情况 1：固定晶胞情况**\n在这种情况下，模拟晶胞矩阵 $\\mathbf{h}$ 是一个常数。动力学变量是粒子坐标。问题陈述我们可以使用笛卡尔坐标 $\\{\\mathbf{r}_i\\}$ 或缩放坐标 $\\{\\mathbf{s}_i\\}$。由于 $\\mathbf{h}$ 是一个常数可逆矩阵，关系式 $\\mathbf{r}_i = \\mathbf{h}\\mathbf{s}_i$ 是一个固定的线性变换。因此，无论我们使用 $\\{\\mathbf{r}_i\\}$ 还是 $\\{\\mathbf{s}_i\\}$，独立坐标的数量都是相同的。\n\n系统由 $N$ 个在三维空间中的粒子组成。每个粒子 $i$ 有一个位置矢量，可以用 3 个独立分量（例如 $x_i, y_i, z_i$）来描述。问题明确指出，我们不应固定质心或预先移除任何其他的集体自由度。\n\n因此，广义坐标的总数是所有粒子坐标的总和：\n$$ \\text{坐标数量} = N \\times (\\text{每个粒子的坐标数}) = N \\times 3 = 3N $$\n所以，对于固定晶胞情况，有 $3N$ 个独立的广义坐标。\n\n**情况 2：完全可变恒压器情况**\n在这种情况下，除了粒子坐标外，晶胞矩阵 $\\mathbf{h}(t)$ 的分量也被视为广义坐标。系统的总构型由缩放粒子坐标集 $\\{\\mathbf{s}_i\\}$ 和晶胞矩阵 $\\mathbf{h}$ 共同描述。\n\n粒子坐标 $\\{\\mathbf{s}_i\\}$ 贡献了 $3N$ 个自由度，就像在固定晶胞情况中一样。关键部分是计算来自涨落的晶胞矩阵 $\\mathbf{h}$ 的额外独立坐标的数量。\n\n一个通用的 $3 \\times 3$ 矩阵有 $3 \\times 3 = 9$ 个分量。然而，晶胞的物理状态（其体积和形状）与其在空间中的整体取向无关。取向对应于 3 个转动自由度。因此，直接计数为 9 会重复计算物理上不同的晶胞构型。\n\n问题描述了一种解决这种冗余的标准方法：“规范固定约定”。矩阵 $\\mathbf{h}$ 被约束为对角线元素为正的上三角矩阵。让我们写出这样一个矩阵：\n$$ \\mathbf{h} = \\begin{pmatrix} h_{11}  h_{12}  h_{13} \\\\ 0  h_{22}  h_{23} \\\\ 0  0  h_{33} \\end{pmatrix} $$\n独立分量是非零元素：$h_{11}, h_{12}, h_{13}, h_{22}, h_{23}, h_{33}$。通过计数，我们发现有 6 个这样的分量。条件 $h_{11} > 0$, $h_{22} > 0$ 和 $h_{33} > 0$ 是不等式约束，它们定义了这些坐标的有效域，确保了正体积（$\\det(\\mathbf{h}) > 0$）和唯一的基矢取向选择。它们不减少独立变量的数量。\n\n因此，晶胞矩阵 $\\mathbf{h}$ 贡献了 6 个独立的广义坐标。\n\n对于完全可变恒压器情况，独立广义坐标的总数是来自粒子和晶胞的贡献之和：\n$$ \\text{坐标数量} = (\\text{来自粒子}) + (\\text{来自晶胞}) = 3N + 6 $$\n\n**增加的坐标**\n从固定晶胞情况转变为完全可变恒压器情况时增加的坐标数量是它们各自计数之差：\n$$ \\text{增加的坐标数} = (3N + 6) - 3N = 6 $$\n\n### 逐项分析\n\n**A. 固定晶胞：$3N$。可变恒压器：$3N+9$。增加的坐标数：$9$。**\n- 固定晶胞的计数 $3N$ 是正确的。\n- 可变恒压器的计数 $3N+9$ 是不正确的。它没有考虑到晶胞的旋转冗余，这种冗余通过指定的规范固定条件被移除，将晶胞的自由度从 9 减少到 6。\n- 因此，增加的坐标数量也是不正确的。\n- **结论：不正确。**\n\n**B. 固定晶胞：$3N$。可变恒压器：$3N+6$。增加的坐标数：$6$。**\n- 如推导所示，固定晶胞的计数 $3N$ 是正确的。\n- 可变恒压器的计数 $3N+6$ 是正确的。它正确地确定了 $3N$ 个粒子坐标，并加上了来自上三角晶胞矩阵 $\\mathbf{h}$ 的 6 个独立坐标。\n- 增加的坐标数量 6 也是正确的。\n- **结论：正确。**\n\n**C. 固定晶胞：$3N-3$（移除整体平移）。可变恒压器：$3N+3$。增加的坐标数：$6$。**\n- 固定晶胞的计数 $3N-3$ 是不正确的。它与“不固定质心或预先移除任何整体的平移...自由度”的明确指示相矛盾。广义坐标的数量是 $3N$。\n- 此选项中的其他数字都基于这个错误的前提。\n- **结论：不正确。**\n\n**D. 固定晶胞：$3N$。可变恒压器：$3N+1$（只有体积涨落）。增加的坐标数：$1$。**\n- 固定晶胞的计数 $3N$ 是正确的。\n- 可变恒压器的计数 $3N+1$ 是不正确的。这个计数对应于一个各向同性恒压器，其中只有晶胞体积是变量（增加 1 个自由度）。问题指定的是“完全可变恒压器情况”，具有一个可以在“形状和体积”上涨落的“三斜晶胞”，这需要 6 个自由度来描述晶胞。\n- **结论：不正确。**\n\n**E. 固定晶胞：$3N$。可变恒压器：$3N+5$（一个来自 $\\det\\mathbf{h}>0$ 的约束）。增加的坐标数：$5$。**\n- 固定晶胞的计数 $3N$ 是正确的。\n- 可变恒压器的计数 $3N+5$ 是不正确的。它误解了条件 $\\det(\\mathbf{h}) > 0$（由 $h_{ii} > 0$ 导出）的性质。这是一个对坐标域的不等式约束，而不是一个消除自由度的约束方程（$f(q_1, ..., q_n) = 0$）。晶胞的独立变量数量仍然是 6。\n- **结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "3406096"}]}