{"hands_on_practices": [{"introduction": "代数多重网格（AMG）方法的第一步是分析问题的代数结构，以区分“强连接”和“弱连接”。这个练习将引导你应用经典的 Ruge–Stüben 强度定义，对一个源于一维拉普拉斯算子的标准矩阵进行计算。通过这个基础实践，你将牢固掌握如何根据矩阵的非对角元来量化变量之间的耦合强度。[@problem_id:3449289]", "problem": "考虑由 $A=\\operatorname{tridiag}(-1,2,-1)$ 定义的矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$，它是一个对称正定 M 矩阵，该矩阵源于在均匀网格上对带齐次狄利克雷边界条件的一维泊松算子进行标准的二阶有限差分-离散化。令连接强度阈值为 $\\theta=0.25$。使用经典的 Ruge–Stüben 对于 M 矩阵的连接强度定义：对于每一行 $i$，一个非对角索引 $j \\neq i$ 是 $i$ 的强邻居，当且仅当 $a_{ij}  0$ 并且\n$$\n- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr).\n$$\n任务：\n1. 对于每一行 $i \\in \\{1,2,3,4,5\\}$，确定强邻居集合 $N^{s}_{i}(\\theta)$，并根据矩阵 $A$ 的元素和上述定义直接证明你的结果。\n2. 设 $G$ 是无向强度图，当且仅当 $i \\in N^{s}_{j}(\\theta)$ 或 $j \\in N^{s}_{i}(\\theta)$ 时，在 $\\{i,j\\}$ 之间放置一条无向边。设 $B$ 表示 $G$ 的邻接矩阵。计算谱半径 $\\rho(B)$，并将你的最终答案表示为一个精确值（不进行四舍五入）。\n你的最终答案必须是等于 $\\rho(B)$ 的单个实数，不带单位。", "solution": "该问题要求我们进行一个与代数多重网格（AMG）方法中连接强度概念相关的两部分分析。首先，我们必须确定给定矩阵的强邻居集合。其次，我们必须基于这些连接构建一个图，并计算其邻接矩阵的谱半径。\n\n给定矩阵为 $A \\in \\mathbb{R}^{5 \\times 5}$，具体为 $A=\\operatorname{tridiag}(-1,2,-1)$。将其显式写出，我们有：\n$$\nA = \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}\n$$\n连接强度阈值给定为 $\\theta=0.25$。\n对于行 $i$ 的强邻居 $j$（其中 $j \\neq i$）的定义有两个方面：\n1. 非对角元素 $a_{ij}$ 必须为负，即 $a_{ij}  0$。\n2. 该元素的大小必须满足不等式：$- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr)$。\n\n**第1部分：确定强邻居集合 $N^{s}_{i}(\\theta)$**\n\n我们将分别分析每一行 $i \\in \\{1, 2, 3, 4, 5\\}$。\n\n对于行 $i=1$：\n唯一的负非对角元素是 $a_{12}=-1$。\n我们计算该行中负非对角元素的最大绝对值：\n$\\max_{k \\neq 1} (-a_{1k}) = \\max(-a_{12}, -a_{13}, \\dots) = \\max(1, 0, \\dots) = 1$。\n一个邻居 $j$ 成为强邻居的阈值条件是 $-a_{1j} \\ge \\theta \\times 1 = 0.25$。\n对于 $j=2$，我们有 $-a_{12} = -(-1) = 1$。因为 $1 \\ge 0.25$，所以到节点 $2$ 的连接是强的。\n因此，行 $1$ 的强邻居集合是 $N^{s}_{1}(\\theta) = \\{2\\}$。\n\n对于行 $i=2$：\n负非对角元素是 $a_{21}=-1$ 和 $a_{23}=-1$。\n最大绝对值为 $\\max_{k \\neq 2} (-a_{2k}) = \\max(-a_{21}, -a_{23}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{2j} \\ge 0.25 \\times 1 = 0.25$。\n对于 $j=1$：$-a_{21} = 1$，$\\ge 0.25$。\n对于 $j=3$：$-a_{23} = 1$，$\\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{2}(\\theta) = \\{1, 3\\}$。\n\n对于行 $i=3$：\n负非对角元素是 $a_{32}=-1$ 和 $a_{34}=-1$。\n最大绝对值为 $\\max_{k \\neq 3} (-a_{3k}) = \\max(-a_{32}, -a_{34}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{3j} \\ge 0.25$。\n对于 $j=2$：$-a_{32} = 1 \\ge 0.25$。\n对于 $j=4$：$-a_{34} = 1 \\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{3}(\\theta) = \\{2, 4\\}$。\n\n对于行 $i=4$：\n负非对角元素是 $a_{43}=-1$ 和 $a_{45}=-1$。\n最大绝对值为 $\\max_{k \\neq 4} (-a_{4k}) = \\max(-a_{43}, -a_{45}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{4j} \\ge 0.25$。\n对于 $j=3$：$-a_{43} = 1 \\ge 0.25$。\n对于 $j=5$：$-a_{45} = 1 \\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{4}(\\theta) = \\{3, 5\\}$。\n\n对于行 $i=5$：\n唯一的负非对角元素是 $a_{54}=-1$。\n最大绝对值为 $\\max_{k \\neq 5} (-a_{5k}) = \\max(-a_{54}) = 1$。\n阈值条件是 $-a_{5j} \\ge 0.25$。\n对于 $j=4$：$-a_{54} = 1 \\ge 0.25$。该连接是强的。\n因此，$N^{s}_{5}(\\theta) = \\{4\\}$。\n\n总而言之，对于 $\\theta = 0.25$，矩阵 $A$ 中所有非零的非对角连接都被分类为强连接。\n\n**第2部分：计算谱半径 $\\rho(B)$**\n\n无向强度图 $G$ 在 $\\{i,j\\}$ 之间有一条边，当且仅当 $i \\in N^{s}_{j}(\\theta)$ 或 $j \\in N^{s}_{i}(\\theta)$。根据我们在第1部分中的发现：\n- 边 $\\{1,2\\}$：$2 \\in N^{s}_{1}(\\theta)$（且 $1 \\in N^{s}_{2}(\\theta)$）。所以存在一条边。\n- 边 $\\{2,3\\}$：$3 \\in N^{s}_{2}(\\theta)$（且 $2 \\in N^{s}_{3}(\\theta)$）。所以存在一条边。\n- 边 $\\{3,4\\}$：$4 \\in N^{s}_{3}(\\theta)$（且 $3 \\in N^{s}_{4}(\\theta)$）。所以存在一条边。\n- 边 $\\{4,5\\}$：$5 \\in N^{s}_{4}(\\theta)$（且 $4 \\in N^{s}_{5}(\\theta)$）。所以存在一条边。\n不存在其他连接。例如，对于 $\\{1,3\\}$，$3 \\notin N^{s}_{1}(\\theta)$ 且 $1 \\notin N^{s}_{3}(\\theta)$。\n得到的图 $G$ 是一个有 $5$ 个顶点的路径图，可以画成 $1-2-3-4-5$。\n\n这个图 $G$ 的邻接矩阵 $B$ 是一个 $5 \\times 5$ 矩阵，其中如果顶点 $i$ 和 $j$ 之间存在一条边，则 $B_{ij} = 1$，否则 $B_{ij} = 0$。\n$$\nB = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\n这是一个对称三对角矩阵。一个形如 $\\operatorname{tridiag}(c,a,b)$ 的 $n \\times n$ 三对角矩阵的特征值 $\\lambda_k$ 由公式 $\\lambda_k = a + 2\\sqrt{bc}\\cos\\left(\\frac{k\\pi}{n+1}\\right)$ 给出，其中 $k=1, 2, \\dots, n$。\n对于我们的矩阵 $B$，我们有 $n=5$，$a=0$，$b=c=1$。特征值为：\n$$\n\\lambda_k = 0 + 2\\sqrt{1 \\cdot 1} \\cos\\left(\\frac{k\\pi}{5+1}\\right) = 2 \\cos\\left(\\frac{k\\pi}{6}\\right), \\quad k=1,2,3,4,5.\n$$\n我们来计算这些特征值：\n- 对于 $k=1$：$\\lambda_1 = 2 \\cos\\left(\\frac{\\pi}{6}\\right) = 2 \\left(\\frac{\\sqrt{3}}{2}\\right) = \\sqrt{3}$。\n- 对于 $k=2$：$\\lambda_2 = 2 \\cos\\left(\\frac{2\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{3}\\right) = 2 \\left(\\frac{1}{2}\\right) = 1$。\n- 对于 $k=3$：$\\lambda_3 = 2 \\cos\\left(\\frac{3\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{2}\\right) = 2(0) = 0$。\n- 对于 $k=4$：$\\lambda_4 = 2 \\cos\\left(\\frac{4\\pi}{6}\\right) = 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 2 \\left(-\\frac{1}{2}\\right) = -1$。\n- 对于 $k=5$：$\\lambda_5 = 2 \\cos\\left(\\frac{5\\pi}{6}\\right) = 2 \\left(-\\frac{\\sqrt{3}}{2}\\right) = -\\sqrt{3}$。\n\n$B$ 的特征值集合是 $\\{\\sqrt{3}, 1, 0, -1, -\\sqrt{3}\\}$。\n谱半径 $\\rho(B)$ 是特征值的最大绝对值：\n$$\n\\rho(B) = \\max_{k} |\\lambda_k| = \\max\\left\\{|\\sqrt{3}|, |1|, |0|, |-1|, |-\\sqrt{3}|\\right\\} = \\max\\{\\sqrt{3}, 1, 0\\} = \\sqrt{3}.\n$$\n邻接矩阵 $B$ 的谱半径是 $\\sqrt{3}$。", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3449289"}, {"introduction": "经典的连接强度定义虽然直观，但它仅依赖于矩阵的非零元素，有时会忽略物理上重要但代数上“隐藏”的间接耦合。本练习通过一个简单的例子揭示了这一局限性，并引入了一种更强大的方法——基于光滑测试向量的代数距离，来识别这些间接强连接。掌握这种方法对于构建能够精确近似代数光滑误差分量的插值算子至关重要。[@problem_id:3449351]", "problem": "考虑标量扩散模型问题 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，该问题定义在一个一维域上，具有齐次狄利克雷边界条件，并通过在三个内部网格点上使用标准的二阶中心有限差分进行离散化。得到的线性系统为 $A u = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个对称正定 (SPD) 矩阵，具有 M-矩阵形式（正对角元，非正非对角元）：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n您将分析连接强度，并在代数多重网格 (AMG) 的背景下确定插值选择，显式地捕捉跨越零非对角元的间接耦合。\n\n1. 使用归功于 Ruge–Stüben 方法的经典连接强度定义，如果 $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$，则节点 $j \\neq i$ 是 $i$ 的强邻居。计算当 $\\theta = 0.25$ 时，对于 $i \\in \\{1,2,3\\}$ 的经典强度集 $S_{i}^{\\mathrm{RS}}$。\n\n2. 使用两个代表扩散问题的低能误差分量的测试向量，在 $A$ 的图上定义一个代数距离连接强度：\n$$\nv^{(1)} = (1,\\,1,\\,1)^{\\top}, \\qquad v^{(2)} = (0,\\,1,\\,2)^{\\top}.\n$$\n对于每个存在的边 $(i,j)$ 且 $a_{ij} \\neq 0$，定义局部失配\n$$\nm_{ij} \\;=\\; \\left( \\sum_{t=1}^{2} \\big(v_{i}^{(t)} - v_{j}^{(t)}\\big)^{2} \\right)^{1/2}.\n$$\n对于非边对 $(1,3)$ 且 $a_{13} = 0$，将间接代数距离 $d_{13}$ 定义为在 $A$ 的图上沿最短路径的边失配之和，即\n$$\nd_{13} \\;=\\; \\min_{\\text{paths } 1 \\to 3} \\sum_{\\text{edges }(p,q)\\text{ on path}} m_{pq}.\n$$\n使用阈值 $\\tau = 2$，如果 $d_{ij} \\le \\tau$，则声明 $(i,j)$ 是代数强连接。计算 $m_{12}$、$m_{23}$、$d_{13}$，并说明在此标准下 $(1,3)$ 是否为代数强连接。\n\n3. 假设粗集为 $C = \\{1,\\,3\\}$，细集为 $F = \\{2\\}$。基于上述代数距离评估为细节点 $2$ 选择插值：使用局部最小二乘插值，并约束其能重现常数近零空间分量。具体来说，通过最小化以下函数来确定权重 $w_{21}$ 和 $w_{23}$：\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\n在重现约束 $w_{21} + w_{23} = 1$ 的条件下。计算细节点 $2$ 相对于粗节点 $1$ 的插值权重 $w_{21}$ 的精确值。请以精确值的形式提供最终答案，无需四舍五入，也无需单位。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤1：提取已知条件\n\n问题陈述中的已知条件如下：\n- **模型问题**：一维域上的标量扩散方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，具有齐次狄利克雷边界条件。\n- **离散化**：在三个内部网格点上采用标准二阶中心有限差分。\n- **系统矩阵**：$A \\in \\mathbb{R}^{3 \\times 3}$ 由下式给出\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n$$\n- **第1部分（经典连接强度）**：\n    - **定义**：如果 $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$，则节点 $j \\neq i$ 是 $i$ 的强邻居。\n    - **参数**：$\\theta = 0.25$。\n    - **任务**：计算 $i \\in \\{1,2,3\\}$ 的经典强度集 $S_{i}^{\\mathrm{RS}}$。\n- **第2部分（代数距离连接强度）**：\n    - **测试向量**：$v^{(1)} = (1,\\,1,\\,1)^{\\top}$ 和 $v^{(2)} = (0,\\,1,\\,2)^{\\top}$。\n    - **局部失配定义**：对于边 $(i,j)$ 且 $a_{ij} \\neq 0$，$m_{ij} \\;=\\; \\left( \\sum_{t=1}^{2} \\big(v_{i}^{(t)} - v_{j}^{(t)}\\big)^{2} \\right)^{1/2}$。\n    - **间接距离定义**：对于非边对 $(1,3)$，$d_{13} \\;=\\; \\min_{\\text{paths } 1 \\to 3} \\sum_{\\text{edges }(p,q)\\text{ on path}} m_{pq}$。\n    - **强度标准**：如果一对 $(i,j)$ 的距离 $d_{ij} \\le \\tau$，则其为代数强连接，阈值 $\\tau = 2$。\n    - **任务**：计算 $m_{12}$、$m_{23}$、$d_{13}$，并确定 $(1,3)$ 是否为代数强连接。\n- **第3部分（插值）**：\n    - **粗/细集**：粗集 $C = \\{1,\\,3\\}$ 和细集 $F = \\{2\\}$。\n    - **目标函数**：最小化 $J(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}$。\n    - **约束条件**：$w_{21} + w_{23} = 1$。\n    - **任务**：计算插值权重 $w_{21}$ 的精确值。\n\n### 步骤2：使用提取的已知条件进行验证\n\n对问题进行验证检查。\n- **科学依据**：该问题设置在偏微分方程数值解的背景下，具体使用了代数多重网格 (AMG) 方法。矩阵 $A$ 是一维负拉普拉斯算子的标准有限差分格式。经典的 Ruge-Stüben 连接强度、基于测试向量的代数距离以及最小二乘插值等概念都是 AMG 领域基础且成熟的技术。所选的测试向量代表常数函数和线性函数，它们是扩散算子的近零空间（低能）模态。该问题在科学和数学上都是合理的。\n- **适定性**：所有定义、参数和矩阵都已明确提供。问题的每个部分都要求根据所提供的信息计算一个特定的、可计算的量。第3部分中的约束最小化问题是一个具有唯一解的标准二次优化问题。该问题是自洽且适定的。\n- **客观性**：问题陈述使用了精确的数学术语，没有主观或含糊的语言。\n\n### 步骤3：结论与行动\n\n该问题被判定为**有效**。这是一个数值线性代数中的标准、定义明确的练习。我们现在开始解答。\n\n### 详细解答\n\n**第1部分：经典连接强度**\n\n我们使用定义 $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$ 和 $\\theta = 0.25$ 来计算 $i \\in \\{1, 2, 3\\}$ 的强度集 $S_{i}^{\\mathrm{RS}}$。\n矩阵为 $A = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}$。\n\n_对于节点 $i=1$_：\n非对角元为 $a_{12} = -1$ 和 $a_{13} = 0$。它们的相反数为 $-a_{12} = 1$ 和 $-a_{13} = 0$。\n这些值的最大值为 $\\max_{k \\neq 1}(-a_{1k}) = \\max(1, 0) = 1$。\n强连接的阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=2$：$-a_{12} = 1 \\ge 0.25$。因此，节点 $2$ 是节点 $1$ 的强邻居。\n- 对于 $j=3$：$-a_{13} = 0  0.25$。因此，节点 $3$ 是节点 $1$ 的弱邻居。\n节点 $1$ 的强度集为 $S_{1}^{\\mathrm{RS}} = \\{2\\}$。\n\n_对于节点 $i=2$_：\n非对角元为 $a_{21} = -1$ 和 $a_{23} = -1$。它们的相反数为 $-a_{21} = 1$ 和 $-a_{23} = 1$。\n这些值的最大值为 $\\max_{k \\neq 2}(-a_{2k}) = \\max(1, 1) = 1$。\n阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=1$：$-a_{21} = 1 \\ge 0.25$。因此，节点 $1$ 是节点 $2$ 的强邻居。\n- 对于 $j=3$：$-a_{23} = 1 \\ge 0.25$。因此，节点 $3$ 是节点 $2$ 的强邻居。\n节点 $2$ 的强度集为 $S_{2}^{\\mathrm{RS}} = \\{1, 3\\}$。\n\n_对于节点 $i=3$_：\n与节点 $1$ 对称，非对角元为 $a_{31} = 0$ 和 $a_{32} = -1$。它们的相反数为 $-a_{31} = 0$ 和 $-a_{32} = 1$。\n最大值为 $\\max_{k \\neq 3}(-a_{3k}) = \\max(0, 1) = 1$。\n阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=1$：$-a_{31} = 0  0.25$。因此，节点 $1$ 是节点 $3$ 的弱邻居。\n- 对于 $j=2$：$-a_{32} = 1 \\ge 0.25$。因此，节点 $2$ 是节点 $3$ 的强邻居。\n节点 $3$ 的强度集为 $S_{3}^{\\mathrm{RS}} = \\{2\\}$。\n\n**第2部分：代数距离连接强度**\n\n首先，我们为存在的边 $(i,j)$（其中 $a_{ij} \\neq 0$）计算局部失配 $m_{ij}$。$A$ 的图有边 $(1,2)$ 和 $(2,3)$。测试向量为 $v^{(1)} = (1, 1, 1)^{\\top}$ 和 $v^{(2)} = (0, 1, 2)^{\\top}$。\n\n_计算 $m_{12}$_：\n向量分量为 $v_1^{(1)}=1$, $v_2^{(1)}=1$ 和 $v_1^{(2)}=0$, $v_2^{(2)}=1$。\n$$\nm_{12} = \\left( (v_{1}^{(1)} - v_{2}^{(1)})^{2} + (v_{1}^{(2)} - v_{2}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (0-1)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_计算 $m_{23}$_：\n向量分量为 $v_2^{(1)}=1$, $v_3^{(1)}=1$ 和 $v_2^{(2)}=1$, $v_3^{(2)}=2$。\n$$\nm_{23} = \\left( (v_{2}^{(1)} - v_{3}^{(1)})^{2} + (v_{2}^{(2)} - v_{3}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (1-2)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_计算 $d_{13}$_：\n间接距离 $d_{13}$ 是失配的最短路径和。在 $A$ 的图上，从节点 $1$到节点 $3$ 的唯一路径是 $1 \\to 2 \\to 3$。\n$$\nd_{13} = m_{12} + m_{23} = 1 + 1 = 2.\n$$\n\n_对 $(1,3)$ 的强度评估_：\n代数强连接的条件是 $d_{ij} \\le \\tau$，其中 $\\tau=2$。\n由于 $d_{13} = 2$，我们有 $d_{13} \\le 2$。因此，尽管 $a_{13}=0$，对 $(1,3)$ 仍被认为是代数强连接。\n\n**第3部分：插值权重计算**\n\n我们需要找到权重 $w_{21}$ 和 $w_{23}$，以最小化目标函数\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\n在约束条件 $w_{21} + w_{23} = 1$ 下。我们可以用 $w_{21}$ 表示 $w_{23}$ 为 $w_{23} = 1 - w_{21}$，并将其代入目标函数：\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - (1 - w_{21}) \\, v_{3}^{(t)} \\right)^{2}.\n$$\n重新整理括号内的项，得到：\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( (v_{2}^{(t)} - v_{3}^{(t)}) - w_{21}(v_{1}^{(t)} - v_{3}^{(t)}) \\right)^{2}.\n$$\n现在，我们为每个测试向量 $v^{(t)}$ 计算该表达式的值。\n\n_对于 $t=1$_: $v^{(1)}=(1,1,1)^{\\top}$。\n分量差为 $v_2^{(1)} - v_3^{(1)} = 1 - 1 = 0$ 和 $v_1^{(1)} - v_3^{(1)} = 1 - 1 = 0$。\n求和中 $t=1$ 的项为 $(0 - w_{21} \\cdot 0)^2 = 0$。这是预料之中的，因为约束 $w_{21}+w_{23}=1$ 确保了对常数向量 $v^{(1)}$ 的精确重现。\n\n_对于 $t=2$_: $v^{(2)}=(0,1,2)^{\\top}$。\n分量差为 $v_2^{(2)} - v_3^{(2)} = 1 - 2 = -1$ 和 $v_1^{(2)} - v_3^{(2)} = 0 - 2 = -2$。\n求和中 $t=2$ 的项为 $\\left( -1 - w_{21}(-2) \\right)^{2} = (-1 + 2w_{21})^2$。\n\n目标函数简化为：\n$$\nJ(w_{21}) = 0 + (-1 + 2w_{21})^2 = (-1 + 2w_{21})^2.\n$$\n为了最小化这个关于 $w_{21}$ 的二次函数，我们找到使平方项为零的 $w_{21}$ 的值。\n$$\n-1 + 2w_{21} = 0\n$$\n$$\n2w_{21} = 1\n$$\n$$\nw_{21} = \\frac{1}{2}.\n$$\n细节点 $2$ 相对于粗节点 $1$ 的插值权重值为 $\\frac{1}{2}$。这对应于标准的线性插值，对于这个简单的一维问题，通过此代数过程可以恢复该插值。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3449351"}, {"introduction": "在确定了用于插值的粗网格邻居后，我们需要計算相应的插值权重，这通常通过求解一个局部最小二乘问题来实现。然而，当用于拟合的测试向量接近线性相关时，这个最小二乘问题可能是病态的，导致插值权重不稳定且不可靠。这个练习模拟了这样一个场景，并演示了一种实用的解决方案——基于连接强度的列缩放技术，来改善问题的条件数并获得鲁棒的插值权重。[@problem_id:3449303]", "problem": "考虑一个标量二阶扩散离散化问题，其在细网格节点 $i$ 处的局部代数多重网格 (AMG) 插值构造产生一个对角线元素为正、非对角线元素为非正的矩阵（一个 $M$-矩阵）。假设 $i$ 的粗网格邻域由两个粗网格节点 $j_{1}$ 和 $j_{2}$ 组成。给定三个代表性光滑测试向量 $\\{t^{(m)}\\}_{m=1}^{3}$，其值限制在索引 $\\{i,j_{1},j_{2}\\}$ 上，分别为\n- $t^{(1)}$: $t^{(1)}_{i} = 10$, $t^{(1)}_{j_{1}} = 10$, $t^{(1)}_{j_{2}} = 1.01$，\n- $t^{(2)}$: $t^{(2)}_{i} = 20$, $t^{(2)}_{j_{1}} = 20$, $t^{(2)}_{j_{2}} = 2.02$，\n- $t^{(3)}$: $t^{(3)}_{i} = 30$, $t^{(3)}_{j_{1}} = 30$, $t^{(3)}_{j_{2}} = 3.02$。\n\n这些值为插值权重 $w \\in \\mathbb{R}^{2}$ 提供了最小二乘设计矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$ 和数据向量 $b \\in \\mathbb{R}^{3}$，如下所示\n$$\nA = \\begin{pmatrix}\nt^{(1)}_{j_{1}}  t^{(1)}_{j_{2}} \\\\\nt^{(2)}_{j_{1}}  t^{(2)}_{j_{2}} \\\\\nt^{(3)}_{j_{1}}  t^{(3)}_{j_{2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n10  1.01 \\\\\n20  2.02 \\\\\n30  3.02\n\\end{pmatrix},\n\\qquad\nb = \\begin{pmatrix}\nt^{(1)}_{i} \\\\\nt^{(2)}_{i} \\\\\nt^{(3)}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n10 \\\\ 20 \\\\ 30\n\\end{pmatrix}.\n$$\n\n假设节点 $i$ 处的局部算子项满足 $-a_{ij_{1}} = 1.0$ 和 $-a_{ij_{2}} = 0.1$，并设连接强度定义为\n$$\ns_{ij} = \\frac{-a_{ij}}{\\max_{k \\neq i}(-a_{ik})}.\n$$\n因此，$s_{ij_{1}} = 1$ 且 $s_{ij_{2}} = 0.1$。为了稳定这个病态的最小二乘问题，使用对角矩阵 $D = \\operatorname{diag}\\!\\left(1/\\sqrt{s_{ij_{1}}}, \\, 1/\\sqrt{s_{ij_{2}}}\\right) = \\operatorname{diag}\\!\\left(1, \\sqrt{10}\\right)$ 对 $A$ 应用基于强度的列缩放，使得缩放后的设计矩阵为 $A' = A D$，缩放后的最小二乘未知数为 $y \\in \\mathbb{R}^{2}$，原始插值权重可通过 $w = D y$ 恢复。\n\n使用 2-范数（谱）条件数定义 $\\kappa_{2}(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别表示最大和最小奇异值，计算：\n1. 未缩放的设计矩阵的条件数 $\\kappa_{2}(A)$。\n2. 基于强度缩放后的条件数 $\\kappa_{2}(A')$。\n\n然后，求解缩放后的正规方程得到 $y$ 并恢复 $w = D y$。最后，报告缩放前后的两个条件数。将报告的两个条件数均四舍五入到四位有效数字。在最终数值答案中不提供单位。", "solution": "评估问题陈述的有效性。\n\n### 第一步：提取已知条件\n\n-   该问题描述了在细网格节点 $i$ 处，具有两个粗网格邻居 $j_1$ 和 $j_2$ 的局部代数多重网格 (AMG) 插值。\n-   底层的离散化矩阵是一个 $M$-矩阵。\n-   提供了三个光滑测试向量 $\\{t^{(m)}\\}_{m=1}^{3}$，其在局部节点子集 $\\{i, j_1, j_2\\}$ 上的值为：\n    -   $t^{(1)}: t^{(1)}_{i} = 10, t^{(1)}_{j_{1}} = 10, t^{(1)}_{j_{2}} = 1.01$\n    -   $t^{(2)}: t^{(2)}_{i} = 20, t^{(2)}_{j_{1}} = 20, t^{(2)}_{j_{2}} = 2.02$\n    -   $t^{(3)}: t^{(3)}_{i} = 30, t^{(3)}_{j_{1}} = 30, t^{(3)}_{j_{2}} = 3.02$\n-   最小二乘设计矩阵 $A$ 和数据向量 $b$ 定义为：\n    $$\n    A = \\begin{pmatrix}\n    t^{(1)}_{j_{1}}  t^{(1)}_{j_{2}} \\\\\n    t^{(2)}_{j_{1}}  t^{(2)}_{j_{2}} \\\\\n    t^{(3)}_{j_{1}}  t^{(3)}_{j_{2}}\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    10  1.01 \\\\\n    20  2.02 \\\\\n    30  3.02\n    \\end{pmatrix},\n    \\qquad\n    b = \\begin{pmatrix}\n    t^{(1)}_{i} \\\\\n    t^{(2)}_{i} \\\\\n    t^{(3)}_{i}\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    10 \\\\\n    20 \\\\\n    30\n    \\end{pmatrix}.\n    $$\n-   给定了局部算子项：$-a_{ij_{1}} = 1.0$ 和 $-a_{ij_{2}} = 0.1$。\n-   连接强度定义为 $s_{ij} = \\frac{-a_{ij}}{\\max_{k \\neq i}(-a_{ik})}$。\n-   计算出的强度为 $s_{ij_{1}} = 1$ 和 $s_{ij_{2}} = 0.1$。\n-   为基于强度的列缩放定义了对角缩放矩阵 $D$：$D = \\operatorname{diag}\\!\\left(1/\\sqrt{s_{ij_{1}}}, \\, 1/\\sqrt{s_{ij_{2}}}\\right) = \\operatorname{diag}\\!\\left(1, \\sqrt{10}\\right)$。\n-   缩放后的设计矩阵为 $A' = A D$。\n-   条件数是二范数（谱）条件数：$\\kappa_{2}(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$。\n-   任务是计算 $\\kappa_{2}(A)$、$\\kappa_{2}(A')$、求解插值权重 $w$，并报告两个四舍五入到四位有效数字的条件数。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学依据：** 该问题牢固地植根于数值线性代数领域，特别是代数多重网格方法中用于数值求解偏微分方程的方法。M-矩阵、连接强度、用于插值的最小二乘法以及矩阵条件数等概念都是标准且成熟的。\n-   **适定性：** 矩阵 $A$ 是一个 $3 \\times 2$ 矩阵。其列向量 $c_1 = (10, 20, 30)^T$ 和 $c_2 = (1.01, 2.02, 3.02)^T$ 是线性无关的，因此 $A$ 是列满秩的。所以，最小二乘问题有唯一解，奇异值非零，这使得条件数是良定义的。\n-   **客观性：** 问题陈述使用了精确的数学定义和数值，没有任何主观或模棱两可的语言。\n-   **完整性和一致性：** 提供了所有必要的数据和定义。虽然测试向量 $t^{(1)}$ 和 $t^{(2)}$ 是线性相关的 ($t^{(2)} = 2t^{(1)}$)，但这只是在最小二乘系统中引入了一个冗余方程，并不构成矛盾或使问题无效。$A$ 的列向量近似线性相关是故意的，旨在创建一个病态系统，这正是本练习的教学要点。\n\n### 第三步：结论与行动\n\n该问题在科学上是合理的、适定的且自洽的。它代表了数值分析中一个有效且标准的练习。可以开始求解过程。\n\n### 求解\n\n第一步是计算未缩放的设计矩阵 $A$ 的条件数。条件数 $\\kappa_2(A)$ 是 $A$ 的最大奇异值与最小奇异值之比，即 $\\sigma_{\\max}(A)/\\sigma_{\\min}(A)$。奇异值是 $A^T A$ 的特征值的平方根。\n\n令 $B = A^T A$。\n$$\nB = \\begin{pmatrix} 10  20  30 \\\\ 1.01  2.02  3.02 \\end{pmatrix} \\begin{pmatrix} 10  1.01 \\\\ 20  2.02 \\\\ 30  3.02 \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} 10^2+20^2+30^2  10(1.01)+20(2.02)+30(3.02) \\\\ 10.1+40.4+90.6  1.01^2+2.02^2+3.02^2 \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} 100+400+900  10.1+40.4+90.6 \\\\ 10.1+40.4+90.6  1.0201+4.0804+9.1204 \\end{pmatrix} = \\begin{pmatrix} 1400  141.1 \\\\ 141.1  14.2209 \\end{pmatrix}\n$$\n$B$ 的特征值 $\\lambda$ 是特征方程 $\\det(B - \\lambda I) = 0$ 的根。\n$$ \\lambda^2 - \\operatorname{tr}(B) \\lambda + \\det(B) = 0 $$\n迹为 $\\operatorname{tr}(B) = 1400 + 14.2209 = 1414.2209$。\n行列式为 $\\det(B) = (1400)(14.2209) - (141.1)^2 = 19909.26 - 19909.21 = 0.05$。\n特征值之比 $\\lambda_{\\max}/\\lambda_{\\min}$ 是条件数的平方，即 $\\kappa_2(A)^2$。对于一个高度病态的矩阵，这个比值可以很好地用 $\\operatorname{tr}(B)^2 / \\det(B)$ 来近似。\n$$ \\kappa_2(A)^2 \\approx \\frac{(\\operatorname{tr}(B))^2}{\\det(B)} = \\frac{(1414.2209)^2}{0.05} \\approx \\frac{2000041.006}{0.05} \\approx 40000820.12 $$\n$$ \\kappa_2(A) \\approx \\sqrt{40000820.12} \\approx 6324.6193 $$\n四舍五入到四位有效数字，$\\kappa_2(A) \\approx 6325$。\n\n接下来，我们计算缩放后矩阵 $A' = AD$ 的条件数。\n$$ A' = A D = \\begin{pmatrix} 10  1.01 \\\\ 20  2.02 \\\\ 30  3.02 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{10} \\end{pmatrix} = \\begin{pmatrix} 10  1.01\\sqrt{10} \\\\ 20  2.02\\sqrt{10} \\\\ 30  3.02\\sqrt{10} \\end{pmatrix} $$\n令 $B' = (A')^T A' = D^T A^T A D$。\n$$ B' = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{10} \\end{pmatrix} \\begin{pmatrix} 1400  141.1 \\\\ 141.1  14.2209 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{10} \\end{pmatrix} = \\begin{pmatrix} 1400  141.1\\sqrt{10} \\\\ 141.1\\sqrt{10}  142.209 \\end{pmatrix} $$\n迹为 $\\operatorname{tr}(B') = 1400 + 142.209 = 1542.209$。\n行列式为 $\\det(B') = (1400)(142.209) - (141.1\\sqrt{10})^2 = 199092.6 - (19909.21)(10) = 199092.6 - 199092.1 = 0.5$。\n我们对 $\\kappa_2(A')^2$ 使用相同的近似：\n$$ \\kappa_2(A')^2 \\approx \\frac{(\\operatorname{tr}(B'))^2}{\\det(B')} = \\frac{(1542.209)^2}{0.5} \\approx \\frac{2378410.006}{0.5} \\approx 4756820.012 $$\n$$ \\kappa_2(A') \\approx \\sqrt{4756820.012} \\approx 2181.0135 $$\n四舍五入到四位有效数字，$\\kappa_2(A') \\approx 2181$。\n\n最后，我们求解缩放后的正规方程 $(A')^T A' y = (A')^T b$ 来找到 $y$，然后得到 $w=Dy$。\n首先，计算右侧项 $(A')^T b = D^T A^T b$。\n$$ A^T b = \\begin{pmatrix} 10  20  30 \\\\ 1.01  2.02  3.02 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 20 \\\\ 30 \\end{pmatrix} = \\begin{pmatrix} 100+400+900 \\\\ 10.1+40.4+90.6 \\end{pmatrix} = \\begin{pmatrix} 1400 \\\\ 141.1 \\end{pmatrix} $$\n$$ (A')^T b = D^T (A^T b) = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{10} \\end{pmatrix} \\begin{pmatrix} 1400 \\\\ 141.1 \\end{pmatrix} = \\begin{pmatrix} 1400 \\\\ 141.1\\sqrt{10} \\end{pmatrix} $$\n缩放后的正规方程为：\n$$ \\begin{pmatrix} 1400  141.1\\sqrt{10} \\\\ 141.1\\sqrt{10}  142.209 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 1400 \\\\ 141.1\\sqrt{10} \\end{pmatrix} $$\n通过观察该方程组，我们可以发现解为 $y_1 = 1$ 和 $y_2 = 0$。\n我们来验证一下：\n第一个方程：$1400(1) + 141.1\\sqrt{10}(0) = 1400$。这是正确的。\n第二个方程：$141.1\\sqrt{10}(1) + 142.209(0) = 141.1\\sqrt{10}$。这也是正确的。\n所以，$y = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n原始插值权重 $w$ 可通过 $w = Dy$ 恢复。\n$$ w = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{10} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n这个解 $w = (1, 0)^T$ 对应于对第一个粗网格变量的精确插值，因为 $Aw - b = 0$。出现这种情况是因为数据向量 $b$ 与矩阵 $A$ 的第一列相同。\n\n问题要求提供两个条件数，并四舍五入到四位有效数字。\n缩放前的条件数：$\\kappa_2(A) \\approx 6325$。\n缩放后的条件数：$\\kappa_2(A') \\approx 2181$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6325  2181\n\\end{pmatrix}\n}\n$$", "id": "3449303"}]}