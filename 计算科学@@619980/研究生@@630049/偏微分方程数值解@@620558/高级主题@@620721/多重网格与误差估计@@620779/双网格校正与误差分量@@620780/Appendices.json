{"hands_on_practices": [{"introduction": "为了掌握双网格法的精髓，我们最好先从其核心部分——粗网格校正——入手。本练习将通过一个具体的小规模矩阵计算，引导你一步步走完计算残差、限制到粗网格、求解粗网格问题并插值回传校正量的全过程。这个实践旨在建立一个对粗网格校正机制的坚实、可触的理解，让你在不涉及平滑等其他复杂环节的情况下，清晰地看到其工作原理 [@problem_id:3458899]。", "problem": "考虑一个在具有 $n_h = 3$ 个内部点的均匀细网格上离散化的线性椭圆型偏微分方程 (PDE) 的一维狄利克雷问题。令细网格刚度矩阵 $A_h \\in \\mathbb{R}^{3 \\times 3}$ 为标准三对角矩阵\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n给定当前的细网格迭代解\n$$\nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\n$$\n以及细网格右端项\n$$\nf_h \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用两网格校正法，其中包括精确粗网格求解、由下式定义的全加权限制算子 $R \\in \\mathbb{R}^{1 \\times 3}$\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix},\n$$\n以及由下式定义的线性插值延长算子 $P \\in \\mathbb{R}^{3 \\times 1}$\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}.\n$$\n通过 Galerkin 定义 $A_H \\;=\\; R\\,A_h\\,P \\in \\mathbb{R}^{1 \\times 1}$ 构建粗网格算子。定义细网格残差 $r_h \\;=\\; f_h - A_h u_h^{(k)}$，将其限制到粗网格 $r_H \\;=\\; R\\,r_h$，通过求解 $A_H e_H \\;=\\; r_H$ 计算精确的粗网格误差 $e_H \\in \\mathbb{R}$，然后计算校正后的细网格迭代解 $u_h^{(k+1)} \\;=\\; u_h^{(k)} + P e_H$。\n\n仅从这些定义出发，计算 $e_H$ 和 $u_h^{(k+1)}$ 的显式值。将您的最终答案表示为一个包含两个条目的单行矩阵，其中第一个条目是标量 $e_H$，第二个条目是 $3 \\times 1$ 的列向量 $u_h^{(k+1)}$。无需四舍五入，您的答案应为精确值。", "solution": "我们从两网格校正的基本定义出发。细网格残差定义为\n$$\nr_h \\;=\\; f_h \\;-\\; A_h\\,u_h^{(k)}.\n$$\n给定 $A_h$ 和 $u_h^{(k)}$，我们首先计算 $A_h\\,u_h^{(k)}$。令\n$$\nA_h \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}, \n\\quad \nu_h^{(k)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}.\n$$\n则\n$$\nA_h\\,u_h^{(k)} \\;=\\; \n\\begin{pmatrix}\n2 \\cdot 1 + (-1) \\cdot 0 + 0 \\cdot (-1) \\\\\n(-1) \\cdot 1 + 2 \\cdot 0 + (-1) \\cdot (-1) \\\\\n0 \\cdot 1 + (-1) \\cdot 0 + 2 \\cdot (-1)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n-1 + 1 \\\\\n-2\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\\\\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\n因此残差为\n$$\nr_h \\;=\\; f_h - A_h\\,u_h^{(k)} \n\\;=\\; \n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \n- \n\\begin{pmatrix} 2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}.\n$$\n\n接下来，使用全加权限制算子 $R$ 将残差限制到粗网格：\n$$\nR \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix},\n\\qquad\nr_H \\;=\\; R\\,r_h.\n$$\n因此\n$$\nr_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} -2 \\\\ 1 \\\\ 2 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{4} \\cdot (-2) \\;+\\; \\tfrac{1}{2} \\cdot 1 \\;+\\; \\tfrac{1}{4} \\cdot 2\n\\;=\\; -\\tfrac{1}{2} \\;+\\; \\tfrac{1}{2} \\;+\\; \\tfrac{1}{2}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\n通过 Galerkin 定义 $A_H \\;=\\; R\\,A_h\\,P$ 构建粗网格算子 $A_H$。对于\n$$\nP \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n$$\n我们首先计算 $A_h\\,P$：\n$$\nA_h\\,P \\;=\\; \n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n2 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 0 \\cdot \\tfrac{1}{2} \\\\\n(-1) \\cdot \\tfrac{1}{2} + 2 \\cdot 1 + (-1) \\cdot \\tfrac{1}{2} \\\\\n0 \\cdot \\tfrac{1}{2} + (-1) \\cdot 1 + 2 \\cdot \\tfrac{1}{2}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 - 1 \\\\\n- \\tfrac{1}{2} + 2 - \\tfrac{1}{2} \\\\\n-1 + 1\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{pmatrix}.\n$$\n因此，\n$$\nA_H \\;=\\; R\\,(A_h\\,P) \\;=\\; \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2}  \\tfrac{1}{4} \\end{pmatrix}\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n\\;=\\; \\tfrac{1}{2}.\n$$\n\n精确求解粗网格问题 $A_H e_H \\;=\\; r_H$：\n$$\n\\tfrac{1}{2}\\, e_H \\;=\\; \\tfrac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\ne_H \\;=\\; 1.\n$$\n\n将粗网格误差延长至细网格，并校正细网格迭代解：\n$$\nP\\,e_H \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix} \\cdot 1\n\\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix},\n\\qquad\nu_h^{(k+1)} \\;=\\; u_h^{(k)} + P\\,e_H \n\\;=\\; \n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n+\n\\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\\\ \\tfrac{1}{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}.\n$$\n\n因此，计算出的粗网格误差为 $e_H \\;=\\; 1$，校正后的细网格迭代解为 $u_h^{(k+1)} \\;=\\; \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix}$，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} 1  \\begin{pmatrix} \\tfrac{3}{2} \\\\ 1 \\\\ -\\tfrac{1}{2} \\end{pmatrix} \\end{pmatrix}}$$", "id": "3458899"}, {"introduction": "粗网格校正善于处理光滑（低频）误差，但对高频误差却无能为力。这就引出了双网格法的另一个关键组成部分：平滑算子。本练习将通过局部傅里叶分析（LFA）来深入探讨平滑算子的作用，展示如何通过优化其参数，使其最高效地完成其特定任务——衰减那些粗网格无法表示的高频误差分量 [@problem_id:3458866]。", "problem": "考虑偏微分方程(PDE)的边值问题 $-u''(x)=f(x)$，定义在区间 $(0,1)$ 上，并带有齐次狄利克雷边界条件 $u(0)=u(1)=0$。在网格尺寸为 $h=\\frac{1}{n+1}$ 的均匀网格上，使用标准的二阶中心有限差分格式对该算子进行离散化，其中 $x_j=jh$, $j=1,\\dots,n$。这导出一个线性系统 $A_h u_h = f_h$，其中 $A_h$ 是具有模板 $\\frac{1}{h^2}[-1,2,-1]$ 的三对角矩阵。考虑加权雅可比松弛迭代 $u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)})$，其中 $D_h$ 是 $A_h$ 的对角部分，$\\omega>0$ 是松弛参数。\n\n在粗网格间距为 $2h$ 的双网格方法中，光滑子的作用是衰减那些在粗网格上无法表示的高频误差分量。使用局部傅里叶分析 (LFA)，该方法假设网格是无限且均匀的，并逐个模式地分析误差演化。将光滑因子 $\\mu_{\\text{smooth}}(\\omega)$ 定义为误差传播算子的傅里叶符号在与粗网格空间互补的高频集上的幅值的上确界。取高频集为 $\\{\\theta\\in[\\pi/2,\\pi]\\}$（角度以弧度为单位），这对应于在间距为 $2h$ 的粗网格上无法表示的模式。\n\n从第一性原理出发（离散算子模板、加权雅可比迭代的定义以及平移不变算子的傅里叶表示），推导 $\\mu_{\\text{smooth}}(\\omega)$ 的解析表达式，并确定在 $\\omega>0$ 上使其最小化的值 $\\omega^{\\star}$。然后计算得到的最小光滑因子 $\\mu_{\\text{smooth}}(\\omega^{\\star})$。\n\n将您的最终答案以单行矩阵 $\\begin{pmatrix}\\omega^{\\star}  \\mu_{\\text{smooth}}(\\omega^{\\star})\\end{pmatrix}$ 的形式给出。不需要进行数值取整。", "solution": "用户希望找到应用于一维泊松方程的加权雅可比光滑子的最优松弛参数 $\\omega^{\\star}$ 和相应的最小光滑因子 $\\mu_{\\text{smooth}}(\\omega^{\\star})$。我们将按照指定使用局部傅里叶分析 (LFA)。\n\n首先，我们确定加权雅可比迭代的误差传播算子。该迭代由下式给出：\n$$ u_h^{(k+1)} = u_h^{(k)} + \\omega D_h^{-1}(f_h - A_h u_h^{(k)}) $$\n设 $u_h$ 是离散系统 $A_h u_h = f_h$ 的精确解。第 $k$ 次迭代的误差为 $e_h^{(k)} = u_h - u_h^{(k)}$。将 $u_h^{(k)} = u_h - e_h^{(k)}$ 和 $f_h = A_h u_h$ 代入迭代公式，我们得到：\n$$ u_h - e_h^{(k+1)} = (u_h - e_h^{(k)}) + \\omega D_h^{-1}(A_h u_h - A_h (u_h - e_h^{(k)})) $$\n$$ u_h - e_h^{(k+1)} = u_h - e_h^{(k)} + \\omega D_h^{-1}(A_h e_h^{(k)}) $$\n$$ -e_h^{(k+1)} = -e_h^{(k)} + \\omega D_h^{-1} A_h e_h^{(k)} $$\n$$ e_h^{(k+1)} = (I - \\omega D_h^{-1} A_h) e_h^{(k)} $$\n误差传播算子，或称为光滑子，是 $S_h(\\omega) = I - \\omega D_h^{-1} A_h$。\n\n接下来，我们应用局部傅里叶分析 (LFA)。LFA 分析离散算子对形如 $v_\\theta(x_j) = \\exp(i \\theta j)$ 的傅里叶模式的作用，其中 $x_j=jh$ 是网格点，$\\theta \\in [-\\pi, \\pi]$ 是缩放频率。一个线性、平移不变的算子作用于这样的模式，其效果是将其乘以一个标量，该标量称为傅里叶符号或放大因子。\n$L_h v_\\theta(x_j) = \\widehat{L_h}(\\theta) v_\\theta(x_j)$。\n\n我们需要找到算子 $S_h(\\omega)$ 的符号。这需要 $A_h$ 和 $D_h$ 的符号。\n算子 $A_h$ 由模板 $\\frac{1}{h^2}[-1, 2, -1]$ 给出。将其应用于 $v_\\theta(x_j)$：\n$$ (A_h v_\\theta)_j = \\frac{1}{h^2} [-v_\\theta(x_{j-1}) + 2v_\\theta(x_j) - v_\\theta(x_{j+1})] $$\n$$ = \\frac{1}{h^2} [-\\exp(i\\theta(j-1)) + 2\\exp(i\\theta j) - \\exp(i\\theta(j+1))] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [-\\exp(-i\\theta) + 2 - \\exp(i\\theta)] $$\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [2 - 2\\cos(\\theta)] $$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$ = \\frac{\\exp(i\\theta j)}{h^2} [4\\sin^2(\\theta/2)] $$\n因此，$A_h$ 的符号是 $\\widehat{A_h}(\\theta) = \\frac{4}{h^2}\\sin^2(\\theta/2)$。\n\n算子 $D_h$ 是 $A_h$ 的对角部分。从模板可知，对角线元素是 $\\frac{2}{h^2}$。所以，$D_h = \\frac{2}{h^2}I$。$D_h$ 的符号是一个常数：$\\widehat{D_h}(\\theta) = \\frac{2}{h^2}$。因此，其逆的符号是 $\\widehat{D_h^{-1}}(\\theta) = \\frac{h^2}{2}$。\n\n现在我们可以找到光滑子 $S_h(\\omega)$ 的符号：\n$$ \\widehat{S_h}(\\omega, \\theta) = \\widehat{I}(\\theta) - \\omega \\widehat{D_h^{-1}}(\\theta) \\widehat{A_h}(\\theta) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - \\omega \\left(\\frac{h^2}{2}\\right) \\left(\\frac{4}{h^2}\\sin^2(\\theta/2)\\right) $$\n$$ \\widehat{S_h}(\\omega, \\theta) = 1 - 2\\omega \\sin^2(\\theta/2) $$\n这个表达式是频率为 $\\theta$ 的误差模式的放大因子。\n\n光滑因子 $\\mu_{\\text{smooth}}(\\omega)$ 定义为放大因子在高频集上的幅值的上确界。问题指定此高频集为 $\\theta \\in [\\pi/2, \\pi]$。\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} |1 - 2\\omega \\sin^2(\\theta/2)| $$\n为了计算这个上确界，我们来分析当 $\\theta \\in [\\pi/2, \\pi]$ 时项 $z = \\sin^2(\\theta/2)$ 的取值范围。函数 $\\sin(\\phi)$ 在 $\\phi \\in [0, \\pi/2]$ 上是递增的。当 $\\theta$ 从 $\\pi/2$ 变化到 $\\pi$ 时，其参数 $\\theta/2$ 从 $\\pi/4$ 变化到 $\\pi/2$。\n当 $\\theta = \\pi/2$ 时，$z = \\sin^2(\\pi/4) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{1}{2}$。\n当 $\\theta = \\pi$ 时，$z = \\sin^2(\\pi/2) = 1^2 = 1$。\n由于 $\\sin^2(\\theta/2)$ 在此区间上是单调递增函数，所以 $z$ 的取值范围是 $[1/2, 1]$。\n\n问题现在简化为求解：\n$$ \\mu_{\\text{smooth}}(\\omega) = \\sup_{z \\in [1/2, 1]} |1 - 2\\omega z| $$\n函数 $g(z) = 1 - 2\\omega z$ 是关于 $z$ 的线性函数。其绝对值在闭区间 $[1/2, 1]$ 上的上确界必定在端点之一处取得。\n当 $z = 1/2$ 时：$|g(1/2)| = |1 - 2\\omega(1/2)| = |1 - \\omega|$。\n当 $z = 1$ 时：$|g(1)| = |1 - 2\\omega(1)| = |1 - 2\\omega|$。\n因此，光滑因子是这两个值的最大值：\n$$ \\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |1 - 2\\omega|) $$\n\n我们最后的任务是找到使 $\\mu_{\\text{smooth}}(\\omega)$ 最小化的值 $\\omega^{\\star}$。两个函数最大值的最小值通常在两个函数相等时出现。我们令两个幅值相等：\n$$ |1 - \\omega| = |1 - 2\\omega| $$\n此等式成立的条件是 $1 - \\omega = 1 - 2\\omega$ 或 $1 - \\omega = -(1 - 2\\omega)$。\n情况1：$1 - \\omega = 1 - 2\\omega \\implies \\omega = 0$。这不是一个有意义的松弛参数，并且被问题陈述中的 $\\omega>0$ 所排除。\n情况2：$1 - \\omega = -(1 - 2\\omega) \\implies 1 - \\omega = -1 + 2\\omega \\implies 2 = 3\\omega \\implies \\omega = \\frac{2}{3}$。\n\n这个值 $\\omega = 2/3$ 是最优参数 $\\omega^{\\star}$ 的候选值。为了确认它是一个最小值，我们可以观察 $\\mu_{\\text{smooth}}(\\omega) = \\max(|1 - \\omega|, |2\\omega - 1|)$ 的行为。对于 $\\omega  2/3$, $|1-\\omega| > |2\\omega-1|$，所以 $\\mu_{\\text{smooth}}(\\omega) = 1-\\omega$，这是一个递减函数。对于 $\\omega > 2/3$, $|2\\omega-1| > |1-\\omega|$，所以 $\\mu_{\\text{smooth}}(\\omega) = 2\\omega-1$，这是一个递增函数。因此，该函数在 $\\omega = 2/3$ 处达到其最小值。\n所以，最优松弛参数是 $\\omega^{\\star} = \\frac{2}{3}$。\n\n最小光滑因子是 $\\mu_{\\text{smooth}}(\\omega)$ 在 $\\omega^{\\star}$ 处的值：\n$$ \\mu_{\\text{smooth}}(\\omega^{\\star}) = \\mu_{\\text{smooth}}(2/3) = \\max\\left(\\left|1 - \\frac{2}{3}\\right|, \\left|1 - 2\\left(\\frac{2}{3}\\right)\\right|\\right) $$\n$$ = \\max\\left(\\left|\\frac{1}{3}\\right|, \\left|1 - \\frac{4}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\left|-\\frac{1}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\frac{1}{3}\\right) = \\frac{1}{3} $$\n最小光滑因子是 $\\mu_{\\text{smooth}}(\\omega^{\\star}) = \\frac{1}{3}$。\n\n最终答案是序对 $(\\omega^{\\star}, \\mu_{\\text{smooth}}(\\omega^{\\star}))$。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}} $$", "id": "3458866"}, {"introduction": "现在我们已经分别理解了粗网格校正和平滑，是时候观察一个完整的双网格循环了。本练习将追踪一个由清晰的低频和高频模式组成的初始误差，观察它在预平滑、粗网格校正和后平滑等各个阶段的变化。通过这个实践，你将清晰地看到这两个组件如何协同工作——平滑算子有效压制高频误差，而粗网格校正显著减小低频误差——从而高效地降低总误差 [@problem_id:3458890]。", "problem": "考虑一维泊松方程的模型问题，其在具有周期性边界条件、包含 $n=8$ 个点且间距为 $h = 1/8$ 的均匀细网格上进行离散化。细网格离散算子 $A$ 是标准的二阶差分（离散拉普拉斯算子），它作用于网格函数 $\\{u_{j}\\}_{j=0}^{7}$ 的方式如下：\n$$\n(Au)_{j} = \\frac{1}{h^{2}}\\big(2u_{j} - u_{j-1} - u_{j+1}\\big),\n$$\n其中索引是周期性的。设双网格循环使用一个前光滑步骤和一个后光滑步骤，两者都由权重为 $\\omega = 2/3$ 的加权雅可比法给出，即误差传播光滑算子为\n$$\nS = I - \\omega D^{-1}A,\n$$\n其中 $D$ 是 $A$ 的对角部分。对于粗网格校正，使用为粗网格索引 $I=0,1,2,3$ 定义的全加权限制算子 $R:\\mathbb{R}^{8}\\to\\mathbb{R}^{4}$：\n$$\n(Rv)_{I} = \\frac{1}{4}v_{2I-1} + \\frac{1}{2}v_{2I} + \\frac{1}{4}v_{2I+1},\n$$\n其中索引是周期性的。以及由下式定义的线性插值延长算子 $P:\\mathbb{R}^{4}\\to\\mathbb{R}^{8}$：\n$$\n(Pw)_{2I} = w_{I}, \\qquad (Pw)_{2I+1} = \\frac{1}{2}\\big(w_{I} + w_{I+1}\\big),\n$$\n其中粗网格索引是周期性的。设粗网格算子为标准伽辽金选择 $A_{c} = R A P$。双网格循环分三个阶段更新误差 $e$：前光滑 $e^{1} = S e^{0}$，粗网格校正 $e^{2} = \\big(I - P A_{c}^{-1} R A\\big)e^{1}$，以及后光滑 $e^{3} = S e^{2}$。\n\n取初始细网格误差为低频余弦模和高频余弦模的叠加，\n$$\ne^{0}_{j} = \\cos\\!\\Big(\\frac{\\pi}{4}\\,j\\Big) + \\cos(\\pi j), \\qquad j=0,1,\\dots,7.\n$$\n仅使用上述定义和从 $A$ 的周期性离散傅里叶表示导出的基本原理，计算一次双网格循环后产生的欧几里得范数 $\\|e^{1}\\|_{2}$、$\\|e^{2}\\|_{2}$ 和 $\\|e^{3}\\|_{2}$。将您的最终答案表示为一个单行矩阵，其中三个条目均为精确解析形式。无需单位，也无需四舍五入。", "solution": "用户希望计算一维泊松方程的双网格循环三个阶段中误差向量的欧几里得范数。该问题定义明确，所有算子和参数均已指定。由于网格是均匀的且边界条件是周期性的，因此本分析的首选方法是离散傅里叶分析。所涉及的算子在傅里叶域中具有简单的表示。\n\n首先，我们识别初始误差 $e^{0}_{j} = \\cos(\\frac{\\pi}{4}\\,j) + \\cos(\\pi j)$ 的分量。均匀网格有 $n=8$ 个点。我们可以用标准实值离散傅里叶模 $c^{(k)}_{j} = \\cos(\\frac{2\\pi k j}{n})$ 来表示误差。\n第一项是 $\\cos(\\frac{\\pi}{4}j) = \\cos(\\frac{2\\pi \\cdot 1 \\cdot j}{8})$，对应于模 $c^{(1)}$。这是一个低频（光滑）模。\n第二项是 $\\cos(\\pi j) = \\cos(\\frac{2\\pi \\cdot 4 \\cdot j}{8})$，对应于模 $c^{(4)}$。这是网格上的最高频模。\n因此，初始误差为 $e^0 = c^{(1)} + c^{(4)}$。\n\n在包含 $n$ 个点的网格上，离散余弦模是正交的。一个模 $c^{(k)}$ 的欧几里得范数的平方由下式给出：\n$$\n\\|c^{(k)}\\|_2^2 = \\sum_{j=0}^{n-1} \\cos^2\\left(\\frac{2\\pi k j}{n}\\right) =\n\\begin{cases}\nn  \\text{若 } k=0 \\text{ 或 } k=n/2 \\\\\nn/2  \\text{若 } 0  k  n/2\n\\end{cases}\n$$\n对于我们的网格 $n=8$：\n$\\|c^{(1)}\\|_2^2 = 8/2 = 4$。\n$\\|c^{(4)}\\|_2^2 = 8$。\n模 $c^{(1)}$ 和 $c^{(4)}$ 是正交的，所以 $\\|e^0\\|_2^2 = \\|c^{(1)}\\|_2^2 + \\|c^{(4)}\\|_2^2 = 4 + 8 = 12$。\n\n算子 $A$、$S$ 和粗网格校正算子 $C = I - P A_{c}^{-1} R A$ 线性作用于误差。我们可以分析它们对每个模的影响。对于周期性边界条件，一个傅里叶模 $v_j = \\exp(i\\theta j)$（其中 $\\theta = \\frac{2\\pi k}{n}$）是任何线性平移不变算子的特征向量。相应的特征值被称为算子的符号。\n\n离散拉普拉斯算子 $A$ 的符号是 $\\hat{A}(\\theta) = \\frac{1}{h^2}(2 - e^{-i\\theta} - e^{i\\theta}) = \\frac{2(1-\\cos\\theta)}{h^2} = \\frac{4\\sin^2(\\theta/2)}{h^2}$。\n$A$ 的对角部分是 $D = \\frac{2}{h^2}I$。权重为 $\\omega=2/3$ 的加权雅可比光滑子 $S = I - \\omega D^{-1}A$ 的符号是：\n$\\hat{S}(\\theta) = 1 - \\omega (\\frac{2}{h^2})^{-1} \\hat{A}(\\theta) = 1 - \\frac{2}{3} \\frac{h^2}{2} \\frac{4\\sin^2(\\theta/2)}{h^2} = 1 - \\frac{4}{3}\\sin^2(\\theta/2)$。\n由于 $S$ 是一个实对称算子，它通过因子 $\\hat{S}(2\\pi k/n)$ 缩放实模 $c^{(k)}$。\n\n**步骤 1：前光滑得到 $e^1 = S e^0$**\n$e^1 = S(c^{(1)} + c^{(4)}) = S c^{(1)} + S c^{(4)} = \\hat{S}(2\\pi/8) c^{(1)} + \\hat{S}(8\\pi/8) c^{(4)} = \\hat{S}(\\pi/4) c^{(1)} + \\hat{S}(\\pi) c^{(4)}$。\n\n我们计算光滑因子：\n$\\hat{S}(\\pi/4) = 1 - \\frac{4}{3}\\sin^2(\\pi/8) = 1 - \\frac{4}{3}\\left(\\frac{1-\\cos(\\pi/4)}{2}\\right) = 1 - \\frac{2}{3}\\left(1-\\frac{\\sqrt{2}}{2}\\right) = 1 - \\frac{2-\\sqrt{2}}{3} = \\frac{1+\\sqrt{2}}{3}$。\n$\\hat{S}(\\pi) = 1 - \\frac{4}{3}\\sin^2(\\pi/2) = 1 - \\frac{4}{3}(1) = -\\frac{1}{3}$。\n\n所以，$e^1 = \\frac{1+\\sqrt{2}}{3} c^{(1)} - \\frac{1}{3} c^{(4)}$。\n由于 $c^{(1)}$ 和 $c^{(4)}$ 是正交的，范数为：\n$\\|e^1\\|_2^2 = \\left(\\frac{1+\\sqrt{2}}{3}\\right)^2 \\|c^{(1)}\\|_2^2 + \\left(-\\frac{1}{3}\\right)^2 \\|c^{(4)}\\|_2^2 = \\frac{1+2+2\\sqrt{2}}{9} \\cdot 4 + \\frac{1}{9} \\cdot 8 = \\frac{4(3+2\\sqrt{2})+8}{9} = \\frac{12+8\\sqrt{2}+8}{9} = \\frac{20+8\\sqrt{2}}{9}$。\n$\\|e^1\\|_2 = \\sqrt{\\frac{20+8\\sqrt{2}}{9}} = \\frac{\\sqrt{4(5+2\\sqrt{2})}}{3} = \\frac{2\\sqrt{5+2\\sqrt{2}}}{3}$。\n\n**步骤 2：粗网格校正得到 $e^2 = C e^1$**\n粗网格校正算子 $C = I - P A_{c}^{-1} R A$ 会耦合傅里叶模。一个低频模 $k$ 会与一个高频模 $n/2-k$ 发生混叠。\n对于我们的误差分量：\n- 高频模 $c^{(4)}$（即 $k=4=n/2$）与模 $k'=n/2-k = 4-4=0$ 发生混叠。全加权限制算子 $R$ 的一个关键属性是它会湮没最高频模：$R c^{(4)} = 0$。因此，$RAc^{(4)} = 0$ 且 $C c^{(4)} = (I - PA_c^{-1}RA)c^{(4)} = c^{(4)}$。\n- 低频模 $c^{(1)}$（$k=1$）与模 $c^{(3)}$（$k'=4-1=3$）发生混叠。$C$ 对输入向量 $\\alpha c^{(1)}$ 的作用会产生一个同时包含 $c^{(1)}$ 和 $c^{(3)}$ 分量的输出。傅里叶分析表明，对于输入 $f_1 c^{(1)}$，输出为 $f'_1 c^{(1)} + f'_3 c^{(3)}$，其中 $(f'_1, f'_3)^T = \\widehat{CGC}(\\pi/4) (f_1, 0)^T$。符号矩阵为 $\\widehat{CGC}(\\theta) = \\begin{pmatrix} \\sin^2(\\theta/2)  -\\cos^2(\\theta/2) \\\\ -\\sin^2(\\theta/2)  \\cos^2(\\theta/2) \\end{pmatrix}$。\n\n对于 $\\theta=\\pi/4$ 以及来自 $e^1$ 的 $c^{(1)}$ 的输入系数 $\\alpha = \\frac{1+\\sqrt{2}}{3}$，输出系数为：\n$\\begin{pmatrix} f'_1 \\\\ f'_3 \\end{pmatrix} = \\begin{pmatrix} \\sin^2(\\pi/8)  -\\cos^2(\\pi/8) \\\\ -\\sin^2(\\pi/8)  \\cos^2(\\pi/8) \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha\\sin^2(\\pi/8) \\\\ -\\alpha\\sin^2(\\pi/8) \\end{pmatrix}$。\n我们来计算系数值：\n$\\alpha\\sin^2(\\pi/8) = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{1-\\cos(\\pi/4)}{2} = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{1-\\sqrt{2}/2}{2} = \\frac{1+\\sqrt{2}}{3} \\cdot \\frac{2-\\sqrt{2}}{4} = \\frac{2-\\sqrt{2}+2\\sqrt{2}-2}{12} = \\frac{\\sqrt{2}}{12}$。\n\n所以，$C$ 对 $e^1$ 各分量的作用是：\n$C\\left(\\frac{1+\\sqrt{2}}{3}c^{(1)}\\right) = \\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)}$。\n$C\\left(-\\frac{1}{3}c^{(4)}\\right) = -\\frac{1}{3} c^{(4)}$。\n$e^2 = \\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)} - \\frac{1}{3} c^{(4)}$。\n模 $c^{(1)}$、$c^{(3)}$ 和 $c^{(4)}$ 是相互正交的。\n$\\|e^2\\|_2^2 = \\left(\\frac{\\sqrt{2}}{12}\\right)^2\\|c^{(1)}\\|_2^2 + \\left(-\\frac{\\sqrt{2}}{12}\\right)^2\\|c^{(3)}\\|_2^2 + \\left(-\\frac{1}{3}\\right)^2\\|c^{(4)}\\|_2^2$。\n$\\|c^{(3)}\\|_2^2 = n/2 = 4$。\n$\\|e^2\\|_2^2 = \\frac{2}{144} \\cdot 4 + \\frac{2}{144} \\cdot 4 + \\frac{1}{9} \\cdot 8 = \\frac{8}{144} + \\frac{8}{144} + \\frac{8}{9} = \\frac{1}{18} + \\frac{1}{18} + \\frac{16}{18} = \\frac{18}{18}=1$。\n所以，$\\|e^2\\|_2 = 1$。\n\n**步骤 3：后光滑得到 $e^3 = S e^2$**\n$e^3 = S e^2 = S\\left(\\frac{\\sqrt{2}}{12} c^{(1)} - \\frac{\\sqrt{2}}{12} c^{(3)} - \\frac{1}{3} c^{(4)}\\right)$。\n$e^3 = \\frac{\\sqrt{2}}{12} \\hat{S}(\\pi/4) c^{(1)} - \\frac{\\sqrt{2}}{12} \\hat{S}(3\\pi/4) c^{(3)} - \\frac{1}{3} \\hat{S}(\\pi) c^{(4)}$。\n\n我们已经有 $\\hat{S}(\\pi/4) = \\frac{1+\\sqrt{2}}{3}$ 和 $\\hat{S}(\\pi) = -\\frac{1}{3}$。我们需要计算 $\\hat{S}(3\\pi/4)$：\n$\\hat{S}(3\\pi/4) = 1 - \\frac{4}{3}\\sin^2(3\\pi/8) = 1 - \\frac{4}{3}\\left(\\frac{1-\\cos(3\\pi/4)}{2}\\right) = 1 - \\frac{2}{3}\\left(1+\\frac{\\sqrt{2}}{2}\\right) = 1 - \\frac{2+\\sqrt{2}}{3} = \\frac{1-\\sqrt{2}}{3}$。\n\n$e^3$ 中各模的系数是：\n- 对于 $c^{(1)}$: $\\frac{\\sqrt{2}}{12} \\cdot \\frac{1+\\sqrt{2}}{3} = \\frac{\\sqrt{2}+2}{36}$。\n- 对于 $c^{(3)}$: $-\\frac{\\sqrt{2}}{12} \\cdot \\frac{1-\\sqrt{2}}{3} = -\\frac{\\sqrt{2}-2}{36} = \\frac{2-\\sqrt{2}}{36}$。\n- 对于 $c^{(4)}$: $-\\frac{1}{3} \\cdot (-\\frac{1}{3}) = \\frac{1}{9}$。\n\n$e^3 = \\frac{2+\\sqrt{2}}{36} c^{(1)} + \\frac{2-\\sqrt{2}}{36} c^{(3)} + \\frac{1}{9} c^{(4)}$。\n根据正交性，我们计算范数：\n$\\|e^3\\|_2^2 = \\left(\\frac{2+\\sqrt{2}}{36}\\right)^2\\|c^{(1)}\\|_2^2 + \\left(\\frac{2-\\sqrt{2}}{36}\\right)^2\\|c^{(3)}\\|_2^2 + \\left(\\frac{1}{9}\\right)^2\\|c^{(4)}\\|_2^2$。\n$\\|e^3\\|_2^2 = \\left(\\frac{4+2+4\\sqrt{2}}{1296}\\right)(4) + \\left(\\frac{4+2-4\\sqrt{2}}{1296}\\right)(4) + \\frac{1}{81}(8)$。\n$\\|e^3\\|_2^2 = \\frac{4}{1296} ( (6+4\\sqrt{2}) + (6-4\\sqrt{2}) ) + \\frac{8}{81} = \\frac{4}{1296}(12) + \\frac{8}{81} = \\frac{48}{1296} + \\frac{8}{81}$。\n由于 $1296 = 16 \\times 81$，我们有 $\\frac{48}{1296} = \\frac{3 \\times 16}{16 \\times 81} = \\frac{3}{81}$。\n$\\|e^3\\|_2^2 = \\frac{3}{81} + \\frac{8}{81} = \\frac{11}{81}$。\n因此，$\\|e^3\\|_2 = \\sqrt{\\frac{11}{81}} = \\frac{\\sqrt{11}}{9}$。\n\n计算出的三个范数是 $\\|e^1\\|_2 = \\frac{2\\sqrt{5+2\\sqrt{2}}}{3}$、$\\|e^2\\|_2 = 1$ 和 $\\|e^3\\|_2 = \\frac{\\sqrt{11}}{9}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\sqrt{5+2\\sqrt{2}}}{3}  1  \\frac{\\sqrt{11}}{9} \\end{pmatrix}}\n$$", "id": "3458890"}]}