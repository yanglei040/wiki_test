{"hands_on_practices": [{"introduction": "高阶插值在固定模板上应用于包含间断的函数时，可能会在间断附近产生伪振荡（吉布斯现象）。本质无振荡（ENO）格式通过从一组候选模板中智能地选择最光滑的一个来避免此问题。本练习将引导您完成 ENO 选择算法的具体步骤，使用差商来量化光滑度并为重构选择最佳模板。[@problem_id:3385596]", "problem": "考虑标量线性平流偏微分方程 (PDE) $u_t + a u_x = 0$，其中波速为常数 $a>0$。在间距为 $h=1$ 的均匀网格上，令 $x_j=j$，可用的点值为 $u_{-2}, u_{-1}, u_0, u_1, u_2$，其中 $u_j=u(x_j)$。你需要使用基于点值和均差的三阶基本无振荡 (Essentially Non-Oscillatory, ENO) 重构方法，在界面 $x_{i+1/2}$ 处（对于 $i=0$）近似计算左偏重构值 $u_{i+1/2}^{-}$。ENO 模板必须通过在每一步比较相关均差的绝对值来显式选择，从迎风方向上最靠近界面的点开始。\n\n使用以下数据：$u_{-2}=1$，$u_{-1}=2$，$u_0=3$，$u_1=20$，$u_2=25$。假设 $a>0$，因此在 $x_{1/2}$ 处重构的迎风方向为左侧。在选定的 ENO 模板上使用均差构造二次插值多项式，并在 $x_{1/2}$ 处求值。请提供 $u_{1/2}^{-}$ 的数值结果作为最终答案。无需四舍五入；给出精确值。", "solution": "**3. 问题验证：**\n\n**步骤 1：提取已知条件**\n- 偏微分方程 (PDE): $u_t + a u_x = 0$。\n- 波速: $a>0$。这一点至关重要，因为它决定了“迎风”方向。\n- 网格: 均匀网格，间距 $h=1$。\n- 网格点: $x_j = j$。\n- 给定点值: $u_{-2}=1$, $u_{-1}=2$, $u_0=3$, $u_1=20$, $u_2=25$。\n- 目标: 在界面 $x_{i+1/2}$（对于 $i=0$）处近似计算左偏重构值 $u_{i+1/2}^{-}$。因此，需要求解 $u_{1/2}^{-}$。\n- 方法: 三阶基本无振荡 (ENO) 重构。\n- 模板选择规则: 从迎风方向上最靠近界面的点开始，通过显式比较相关均差的绝对值来选择。\n- 最终任务: 在选定的 ENO 模板上构造二次插值多项式，并在 $x_{1/2}$ 处求值。提供其数值。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学上是否成立？** 是。该问题是偏微分方程数值方法中的一个标准练习，特别是针对双曲守恒律。线性平流方程是一个模型问题。ENO 重构是一种成熟的、数学上可靠的技术。所提供的数据仅用于计算。\n- **是否适定？** 是。该问题提供了所有必要的数据和一个清晰的、确定性的算法（ENO 模板选择），可以得到唯一的解。目标明确：计算 $u_{1/2}^{-}$。\n- **是否客观？** 是。语言精确，没有主观性。指令是算法性的。\n- **缺陷检查清单：**\n    1. **科学上不成立：** 否。该问题基于标准的数值分析原理。\n    2. **无法形式化/不相关：** 否。这是指定领域内的一个形式化且相关的问题。\n    3. **不完整/矛盾：** 否。所有必要的值 ($u_j$) 和常数 ($h=1$) 都已给出。条件 $a>0$ 一致地将 $x_{i+1/2}$ 处重构的迎风方向定义为左侧。\n    4. **不现实/不可行：** 否。数据值虽然显示出大的跳跃（$u_0$ 和 $u_1$ 之间的“不连续性”），但这正是 ENO 方法设计用来处理的数据类型。这些值是简单的整数。\n    5. **不适定/结构不良：** 否。ENO 模板选择算法是确定性的，它会导出一个唯一的插值多项式，从而得到一个唯一的 $u_{1/2}^{-}$ 值。\n    6. **伪深刻/琐碎：** 否。它需要一个涉及均差和多项式求值的多步计算。它既不琐碎，也不是人为地复杂。这是一个标准的作业水平问题。\n    7. **无法通过科学方法验证：** 否。结果是一个可以被独立计算和验证的数字。\n\n**步骤 3：结论和行动**\n- **结论：** 问题是 **有效的**。\n- **行动：** 进入求解阶段。\n\n**4. 求解计划：**\n\n目标是找到三阶 ENO 重构值 $u_{1/2}^{-}$。“三阶”意味着局部误差为 $3$ 阶，这是通过一个二次（$2$ 次）重构多项式实现的。一个二次多项式需要 $3$ 个点。\n\n**步骤 1：建立坐标系并确定目标。**\n- 我们在界面 $x_{i+1/2}$ 处进行重构，其中 $i=0$，即 $x_{1/2}$。\n- 网格点为 $x_j=j$，所以界面位于 $x_{1/2} = (x_0 + x_1)/2 = (0+1)/2 = 0.5$。\n- 我们需要计算左偏重构值 $u_{1/2}^{-}$。由于波速 $a>0$，信息从左向右传播。因此，迎风方向来自左侧，采用左偏重构是合适的。此重构与单元 $I_0 = [x_{-1/2}, x_{1/2}]$ 相关联。\n\n**步骤 2：计算必要的均差。**\n- 牛顿均差 $u[x_j, \\dots, x_{j+k}]$ 是递归定义的。对于间距为 $h$ 的均匀网格，定义可以简化。这里 $h=1$。\n- 给定数据点：\n  $u_{-2}=1$ 于 $x_{-2}=-2$\n  $u_{-1}=2$ 于 $x_{-1}=-1$\n  $u_{0}=3$ 于 $x_{0}=0$\n  $u_{1}=20$ 于 $x_{1}=1$\n  $u_{2}=25$ 于 $x_{2}=2$\n- 一阶均差，$u[x_j, x_{j+1}] = \\frac{u_{j+1} - u_j}{x_{j+1} - x_j}$：\n  $u[x_{-2}, x_{-1}] = \\frac{u_{-1} - u_{-2}}{1} = \\frac{2 - 1}{1} = 1$\n  $u[x_{-1}, x_{0}] = \\frac{u_{0} - u_{-1}}{1} = \\frac{3 - 2}{1} = 1$\n  $u[x_{0}, x_{1}] = \\frac{u_{1} - u_{0}}{1} = \\frac{20 - 3}{1} = 17$\n  $u[x_{1}, x_{2}] = \\frac{u_{2} - u_{1}}{1} = \\frac{25 - 20}{1} = 5$\n- 二阶均差，$u[x_j, x_{j+1}, x_{j+2}] = \\frac{u[x_{j+1}, x_{j+2}] - u[x_j, x_{j+1}]}{x_{j+2} - x_j}$：\n  $u[x_{-2}, x_{-1}, x_{0}] = \\frac{u[x_{-1}, x_{0}] - u[x_{-2}, x_{-1}]}{x_{0} - x_{-2}} = \\frac{1 - 1}{2} = 0$\n  $u[x_{-1}, x_{0}, x_{1}] = \\frac{u[x_{0}, x_{1}] - u[x_{-1}, x_{0}]}{x_{1} - x_{-1}} = \\frac{17 - 1}{2} = \\frac{16}{2} = 8$\n  $u[x_{0}, x_{1}, x_{2}] = \\frac{u[x_{1}, x_{2}] - u[x_{0}, x_{1}]}{x_{2} - x_{0}} = \\frac{5 - 17}{2} = \\frac{-12}{2} = -6$\n\n**步骤 3：为三阶（2 次多项式）重构执行 ENO 模板选择。**\n三阶重构使用一个二次多项式，这需要一个包含 3 个点的模板。ENO 算法通过选择局部最平滑的数据来迭代地构建此模板。对于 $i=0$ 时的左偏值 $u_{i+1/2}^{-}$，过程如下：\n\n1.  **初始模板（1 个点）：** 过程从迎风单元中最靠近界面的点开始，即 $x_i = x_0$。初始模板为 $S_1 = \\{x_0\\}$。\n\n2.  **扩展到 2 点模板：** 我们必须向 $S_1$ 添加一个相邻点。候选模板为 $S_{\\text{left}} = \\{x_{-1}, x_0\\}$ 和 $S_{\\text{right}} = \\{x_0, x_1\\}$。为了选择，我们比较相关的一阶均差的绝对值：\n    $|u[x_{-1}, x_0]| = |1| = 1$\n    $|u[x_0, x_1]| = |17| = 17$\n    由于 $|u[x_{-1}, x_0]|  |u[x_0, x_1]|$，左侧的数据更平滑。我们选择向左的模板，$S_2 = \\{x_{-1}, x_0\\}$。\n\n3.  **扩展到 3 点模板：** 现在我们向 $S_2$ 添加一个相邻点。候选模板为 $S'_{\\text{left}} = \\{x_{-2}, x_{-1}, x_0\\}$ 和 $S'_{\\text{right}} = \\{x_{-1}, x_0, x_1\\}$。为了选择，我们比较相关的二阶均差的绝对值：\n    $|u[x_{-2}, x_{-1}, x_0]| = |0| = 0$\n    $|u[x_{-1}, x_0, x_1]| = |8| = 8$\n    由于 $|u[x_{-2}, x_{-1}, x_0]|  |u[x_{-1}, x_0, x_1]|$，我们再次选择向左的模板。\n\n最终的 3 点 ENO 模板是 $S_{ENO_3} = \\{x_{-2}, x_{-1}, x_0\\}$。\n\n**步骤 4：构造插值多项式并求值。**\n重构值是在所选模板上插值函数值的唯一二次多项式 $P(x)$ 在界面 $x_{1/2}$ 处的求值结果。模板点为 $x_{-2}=-2, x_{-1}=-1, x_0=0$，对应的数据值为 $u_{-2}=1, u_{-1}=2, u_0=3$。\n\n我们使用牛顿形式的插值多项式，它建立在均差之上：\n$P(x) = u[x_{-2}] + u[x_{-2}, x_{-1}](x - x_{-2}) + u[x_{-2}, x_{-1}, x_{0}](x - x_{-2})(x - x_{-1})$\n\n所需的系数是：\n$u[x_{-2}] = u_{-2} = 1$\n$u[x_{-2}, x_{-1}] = 1$\n$u[x_{-2}, x_{-1}, x_{0}] = 0$\n\n将这些值代入多项式形式：\n$P(x) = 1 + 1 \\cdot (x - (-2)) + 0 \\cdot (x - (-2))(x - (-1))$\n$P(x) = 1 + (x + 2)$\n$P(x) = x + 3$\n得到的插值函数是一个线性多项式，这是二次项为零的二次多项式的特例。这与二阶均差为零是一致的，表明数据点 $\\{(-2,1), (-1,2), (0,3)\\}$ 是共线的。\n\n通过在界面 $x_{1/2} = 1/2$ 处对此多项式求值，可得到重构值 $u_{1/2}^{-}$：\n$u_{1/2}^{-} = P(1/2) = \\frac{1}{2} + 3 = \\frac{1}{2} + \\frac{6}{2} = \\frac{7}{2}$\n\n因此，三阶 ENO 重构给出的值为 $7/2$。", "answer": "$$\\boxed{\\frac{7}{2}}$$", "id": "3385596"}, {"introduction": "加权本质无振荡（WENO）格式是 ENO 的一种改进，它通过加权平均组合所有候选模板，而不是只选择一个。实现这一点的关键是根据每个模板的“光滑”程度分配权重，这需要一个光滑度的定量度量。本练习专注于计算姜-舒（Jiang-Shu）光滑度指示子 $\\beta_k$，这是用于评估每个模板上重构多项式光滑度的数学工具。[@problem_id:3385559]", "problem": "考虑一维标量双曲守恒律 $u_t + f(u)_x = 0$，该方程在一个均匀网格上通过有限体积法进行离散化，网格中心为 $x_i$，网格宽度为 $\\Delta x$。在加权基本无振荡 (WENO) 重构中，多个候选模板在一个目标网格上生成局部重构多项式，其光滑性通过 Jiang–Shu 光滑度因子来衡量，以形成非线性权。令局部坐标为 $\\xi = (x - x_i) / \\Delta x \\in [-\\frac{1}{2}, \\frac{1}{2}]$，并假设三个候选模板 $S_0$、$S_1$、$S_2$ 在网格 $i$ 上得到如下二次重构多项式：\n$$\np_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\,\\xi + \\frac{1}{50}\\,\\xi^{2}, \\quad\np_{1}(\\xi) = 1 - \\frac{1}{20}\\,\\xi + \\frac{3}{20}\\,\\xi^{2}, \\quad\np_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\,\\xi - \\frac{1}{25}\\,\\xi^{2}.\n$$\n从候选多项式的 Jiang–Shu 光滑度因子是通过在目标网格上对适当缩放的多项式导数的平方进行积分得到的这一定义出发，推导每个 $p_k$ 的显式光滑度因子 $\\beta_k$，并计算 $\\beta_0, \\beta_1, \\beta_2$ 这三个值。根据此因子确定哪个模板被认为更光滑（即具有最小 $\\beta_k$ 值的模板）。以精确的分数形式表示你的最终数值结果。按顺序提供三个光滑度因子，以及最光滑模板的索引 $k \\in \\{0,1,2\\}$，形式为单个行矩阵。", "solution": "题目要求计算三个给定的二次重构多项式 $p_k(\\xi)$ 的 Jiang–Shu 光滑度因子 $\\beta_k$，并确定最光滑的模板。\n\n首先，我们必须确定光滑度因子的精确公式。题目陈述其通过“在目标网格上对适当缩放的多项式导数的平方进行积分”得到。在加权基本无振荡 (WENO) 格式的背景下，对于一个 $r-1$ 次的多项式，Jiang–Shu 光滑度因子 $\\beta_k$ 定义为：\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{x_{i-1/2}}^{x_{i+1/2}} (\\Delta x)^{2l-1} \\left( \\frac{d^l p_k(x)}{dx^l} \\right)^2 dx\n$$\n题目以局部坐标 $\\xi = (x - x_i) / \\Delta x$ 提供了多项式，其中积分区间，即网格 $i$ 从 $x_{i-1/2} = x_i - \\frac{\\Delta x}{2}$ 到 $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$，对应于 $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$。我们必须将积分转换到这个坐标系中。链式法则给出了关于 $x$ 和 $\\xi$ 的导数之间的关系：\n$$\n\\frac{d^l}{dx^l} = \\left(\\frac{1}{\\Delta x}\\right)^l \\frac{d^l}{d\\xi^l}\n$$\n微分元变换为 $dx = \\Delta x \\, d\\xi$。将这些代入 $\\beta_k$ 的定义中：\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} (\\Delta x)^{2l-1} \\left( \\left(\\frac{1}{\\Delta x}\\right)^l \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 (\\Delta x \\, d\\xi)\n$$\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} (\\Delta x)^{2l-1} \\frac{1}{(\\Delta x)^{2l}} \\left( \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 (\\Delta x \\, d\\xi) = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} \\left( \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 d\\xi\n$$\n给定的多项式是二次的，对应于三阶重构 ($r=3$)。因此，我们对最高为 $l=r-1=2$ 阶的导数求和。公式简化为：\n$$\n\\beta_k = \\int_{-1/2}^{1/2} \\left( \\frac{d p_k(\\xi)}{d\\xi} \\right)^2 d\\xi + \\int_{-1/2}^{1/2} \\left( \\frac{d^2 p_k(\\xi)}{d\\xi^2} \\right)^2 d\\xi\n$$\n现在我们将此公式应用于每个给定的多项式。\n\n对于模板 $S_0$，多项式为 $p_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\xi + \\frac{1}{50}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_0}{d\\xi} = \\frac{1}{5} + \\frac{1}{25}\\xi\n$$\n$$\n\\frac{d^2p_0}{d\\xi^2} = \\frac{1}{25}\n$$\n我们计算 $\\beta_0$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{5} + \\frac{1}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{25} + \\frac{2}{125}\\xi + \\frac{1}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{25}\\xi + \\frac{1}{125}\\xi^2 + \\frac{1}{1875}\\xi^3 \\right]_{-1/2}^{1/2}\n$$\n$$\n= 2 \\left( \\frac{1}{25}\\left(\\frac{1}{2}\\right) + \\frac{1}{1875}\\left(\\frac{1}{8}\\right) \\right) = \\frac{1}{25} + \\frac{1}{7500} = \\frac{300}{7500} + \\frac{1}{7500} = \\frac{301}{7500}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{25} \\right)^2 d\\xi = \\frac{1}{625} \\int_{-1/2}^{1/2} d\\xi = \\frac{1}{625} [\\xi]_{-1/2}^{1/2} = \\frac{1}{625}\n$$\n所以，$\\beta_0 = \\frac{301}{7500} + \\frac{1}{625} = \\frac{301}{7500} + \\frac{12}{7500} = \\frac{313}{7500}$。\n\n对于模板 $S_1$，多项式为 $p_{1}(\\xi) = 1 - \\frac{1}{20}\\xi + \\frac{3}{20}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_1}{d\\xi} = -\\frac{1}{20} + \\frac{3}{10}\\xi\n$$\n$$\n\\frac{d^2p_1}{d\\xi^2} = \\frac{3}{10}\n$$\n我们计算 $\\beta_1$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( -\\frac{1}{20} + \\frac{3}{10}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{400} - \\frac{3}{100}\\xi + \\frac{9}{100}\\xi^2 \\right) d\\xi\n$$\n利用区间的对称性：\n$$\n= \\int_{-1/2}^{1/2} \\left( \\frac{1}{400} + \\frac{9}{100}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{400}\\xi + \\frac{3}{100}\\xi^3 \\right]_{-1/2}^{1/2}\n$$\n$$\n= 2 \\left( \\frac{1}{400}\\left(\\frac{1}{2}\\right) + \\frac{3}{100}\\frac{1}{8} \\right) = 2 \\left( \\frac{1}{800} + \\frac{3}{800} \\right) = 2 \\left( \\frac{4}{800} \\right) = \\frac{8}{800} = \\frac{1}{100}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{3}{10} \\right)^2 d\\xi = \\frac{9}{100} \\int_{-1/2}^{1/2} d\\xi = \\frac{9}{100}\n$$\n所以，$\\beta_1 = \\frac{1}{100} + \\frac{9}{100} = \\frac{10}{100} = \\frac{1}{10}$。\n\n对于模板 $S_2$，多项式为 $p_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\xi - \\frac{1}{25}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_2}{d\\xi} = \\frac{1}{100} - \\frac{2}{25}\\xi\n$$\n$$\n\\frac{d^2p_2}{d\\xi^2} = -\\frac{2}{25}\n$$\n我们计算 $\\beta_2$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{100} - \\frac{2}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{10000} - \\frac{1}{1250}\\xi + \\frac{4}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{10000}\\xi + \\frac{4}{1875}\\xi^3 \\right]_{-1/2}^{1/2}\n$$\n$$\n= 2 \\left( \\frac{1}{20000} + \\frac{4}{1875 \\cdot 8} \\right) = 2 \\left( \\frac{1}{20000} + \\frac{1}{3750} \\right) = \\frac{1}{10000} + \\frac{1}{1875} = \\frac{3}{30000} + \\frac{16}{30000} = \\frac{19}{30000}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( -\\frac{2}{25} \\right)^2 d\\xi = \\frac{4}{625} \\int_{-1/2}^{1/2} d\\xi = \\frac{4}{625}\n$$\n所以，$\\beta_2 = \\frac{19}{30000} + \\frac{4}{625} = \\frac{19}{30000} + \\frac{4 \\cdot 48}{625 \\cdot 48} = \\frac{19}{30000} + \\frac{192}{30000} = \\frac{211}{30000}$。\n\n最后，我们比较这些光滑度因子。$\\beta_k$ 的值越小，表示网格上的多项式越光滑。\n$$\n\\beta_0 = \\frac{313}{7500}, \\quad \\beta_1 = \\frac{1}{10}, \\quad \\beta_2 = \\frac{211}{30000}\n$$\n为了比较这些分数，我们将它们通分，公分母为 $30000$：\n$$\n\\beta_0 = \\frac{313 \\times 4}{7500 \\times 4} = \\frac{1252}{30000}\n$$\n$$\n\\beta_1 = \\frac{1 \\times 3000}{10 \\times 3000} = \\frac{3000}{30000}\n$$\n$$\n\\beta_2 = \\frac{211}{30000}\n$$\n比较分子，我们得到 $211  1252  3000$。因此，光滑度因子的顺序是 $\\beta_2  \\beta_0  \\beta_1$。最小值是 $\\beta_2$，这意味着模板 $S_2$ 提供了最光滑的重构多项式。该模板的索引是 $k=2$。\n\n最终结果为 $\\beta_0 = \\frac{313}{7500}$，$\\beta_1 = \\frac{1}{10}$，$\\beta_2 = \\frac{211}{30000}$，最光滑的模板索引为 $k=2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{313}{7500}  \\frac{1}{10}  \\frac{211}{30000}  2 \\end{pmatrix}}\n$$", "id": "3385559"}, {"introduction": "光滑度指示子用于生成最终的非线性 WENO 权重。一个大的光滑度指示子（表明模板可能跨越了间断）将导致一个接近于零的权重，从而有效地将其贡献从最终重构中移除。本练习在一个包含急剧跳跃的数据集上，生动地展示了这种强大的抑制机制，说明了 WENO 如何在光滑区域保持高精度，同时在没有振荡的情况下清晰地捕捉间断。[@problem_id:3385570]", "problem": "考虑标量双曲守恒律 $u_t + f(u)_x = 0$，该方程在间距为 $\\Delta x$ 的均匀网格上进行离散。其中，界面 $x_{i+1/2}$ 处的数值通量通过从迎风偏置三点模板中选取候选多项式重构的凸组合来近似。在 Jiang 和 Shu (JS) 的加权基本无振荡 (WENO) 框架中，非线性权通过放大其光滑度指示因子来抑制跨间断模板的贡献。\n\n给定在模板指数 $\\{i-2,i-1,i,i+1,i+2\\}$ 上的物理通量 $f(u)$ 的逐点节点样本，此时数据在 $x_{i+1}$ 和 $x_{i+2}$ 之间包含一个单独的跳跃：\n$$\nf_{i-2} = 1.0,\\quad f_{i-1} = 1.1,\\quad f_{i} = 1.2,\\quad f_{i+1} = 1.3,\\quad f_{i+2} = 5.0.\n$$\n在界面 $x_{i+1/2}$ 处使用标准的五阶有限差分WENO-JS重构，其理想线性权为 $d_0 = 0.1$, $d_1 = 0.6$, $d_2 = 0.3$，非线性权公式中使用一个小的正参数 $\\epsilon = 10^{-6}$ 以避免除以零，次幂为 $p = 2$。从WENO-JS光滑度指示因子的基本定义及其在确定非线性权中的作用出发，分别计算模板 $\\{i-2,i-1,i\\}$、$\\{i-1,i,i+1\\}$ 和 $\\{i,i+1,i+2\\}$ 的三个非线性权 $w_0$、$w_1$ 和 $w_2$。然后，通过报告抑制因子\n$$ S := \\frac{w_2}{d_2}, $$\n来量化对跨间断模板的抑制程度，该因子衡量非线性权 $w_2$ 相对于其理想权 $d_2$ 的大小。\n\n将最终答案的所有条目四舍五入到四位有效数字。不需要物理单位。如果出现角度，用弧度表示。", "solution": "用户要求计算一个五阶加权基本无振荡 (WENO) 重构的非线性权，并量化一个跨间断模板的抑制程度。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 一个标量双曲守恒律：$u_t + f(u)_x = 0$。\n- 在界面 $x_{i+1/2}$ 处的五阶有限差分WENO-JS重构。\n- 物理通量的逐点节点样本：$f_{i-2} = 1.0$, $f_{i-1} = 1.1$, $f_i = 1.2$, $f_{i+1} = 1.3$, $f_{i+2} = 5.0$。\n- 数据在网格点 $x_{i+1}$ 和 $x_{i+2}$ 之间包含一个跳跃。\n- 在 $x_{i+1/2}$ 处重构的三个三点模板为 $S_0 = \\{i-2, i-1, i\\}$, $S_1 = \\{i-1, i, i+1\\}$, 和 $S_2 = \\{i, i+1, i+2\\}$。\n- 理想线性权为 $d_0 = 0.1$, $d_1 = 0.6$, 和 $d_2 = 0.3$。\n- 参数 $\\epsilon = 10^{-6}$ 用于防止除以零。\n- 非线性权的次幂为 $p = 2$。\n- 任务是计算非线性权 $w_0$, $w_1$, $w_2$ 和抑制因子 $S := w_2 / d_2$。\n- 最终答案应四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了成熟的WENO-JS数值方法在双曲守恒律中的一个标准应用。所提供的数据、参数、定义和模板与经典的五阶有限差分WENO格式在界面 $x_{i+1/2}$ 处的重构一致，假设迎风方向为从左到右（例如，对于正特征速度）。该问题是自洽的、适定的和客观的。没有科学或逻辑上的缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 详细解答\n界面 $x_{i+1/2}$ 处通量的五阶WENO重构是通过三个三阶多项式重构的凸组合得到的。每个重构的贡献由一个非线性权决定，该权重取决于其对应模板中数据的光滑度。\n\n三个模板是：\n- $S_0$：使用通量值 $\\{f_{i-2}, f_{i-1}, f_i\\}$\n- $S_1$：使用通量值 $\\{f_{i-1}, f_i, f_{i+1}\\}$\n- $S_2$：使用通量值 $\\{f_i, f_{i+1}, f_{i+2}\\}$\n\n该过程包括三个主要步骤：\n1.  计算每个模板 $S_k$ 的光滑度指示因子 $\\beta_k$。\n2.  从光滑度指示因子计算非线性权 $w_k$。\n3.  计算抑制因子 $S$。\n\n**1. 光滑度指示因子 ($\\beta_k$) 的计算**\n在界面 $x_{i+1/2}$ 处，标准的Jiang-Shu (JS) 五阶有限差分格式的光滑度指示因子由下式给出：\n$$\n\\beta_0 = \\frac{13}{12}(f_{i-2} - 2f_{i-1} + f_i)^2 + \\frac{1}{4}(f_{i-2} - 4f_{i-1} + 3f_i)^2\n$$\n$$\n\\beta_1 = \\frac{13}{12}(f_{i-1} - 2f_i + f_{i+1})^2 + \\frac{1}{4}(f_{i-1} - f_{i+1})^2\n$$\n$$\n\\beta_2 = \\frac{13}{12}(f_i - 2f_{i+1} + f_{i+2})^2 + \\frac{1}{4}(3f_i - 4f_{i+1} + f_{i+2})^2\n$$\n使用给定的通量值 $f_{i-2}=1.0, f_{i-1}=1.1, f_i=1.2, f_{i+1}=1.3, f_{i+2}=5.0$：\n\n对于 $\\beta_0$:\n- $f_{i-2} - 2f_{i-1} + f_i = 1.0 - 2(1.1) + 1.2 = 1.0 - 2.2 + 1.2 = 0.0$\n- $f_{i-2} - 4f_{i-1} + 3f_i = 1.0 - 4(1.1) + 3(1.2) = 1.0 - 4.4 + 3.6 = 0.2$\n- $\\beta_0 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(0.2)^2 = \\frac{1}{4}(0.04) = 0.01$\n\n对于 $\\beta_1$:\n- $f_{i-1} - 2f_i + f_{i+1} = 1.1 - 2(1.2) + 1.3 = 1.1 - 2.4 + 1.3 = 0.0$\n- $f_{i-1} - f_{i+1} = 1.1 - 1.3 = -0.2$\n- $\\beta_1 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(-0.2)^2 = \\frac{1}{4}(0.04) = 0.01$\n\n对于 $\\beta_2$:\n- $f_i - 2f_{i+1} + f_{i+2} = 1.2 - 2(1.3) + 5.0 = 1.2 - 2.6 + 5.0 = 3.6$\n- $3f_i - 4f_{i+1} + f_{i+2} = 3(1.2) - 4(1.3) + 5.0 = 3.6 - 5.2 + 5.0 = 3.4$\n- $\\beta_2 = \\frac{13}{12}(3.6)^2 + \\frac{1}{4}(3.4)^2 = \\frac{13}{12}(12.96) + \\frac{1}{4}(11.56) = 14.04 + 2.89 = 16.93$\n\n正如预期的那样，跨越间断的模板 $S_2$ 的光滑度指示因子 $\\beta_2$ 比光滑区域中的模板的 $\\beta_0$ 和 $\\beta_1$ 大几个数量级。\n\n**2. 非线性权 ($w_k$) 的计算**\n非线性权 $w_k$ 使用以下公式计算：\n$$\nw_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} \\quad \\text{其中} \\quad \\alpha_k = \\frac{d_k}{(\\beta_k + \\epsilon)^p}\n$$\n给定参数为 $d_0=0.1, d_1=0.6, d_2=0.3$，$\\epsilon=10^{-6}$ 和 $p=2$。\n\n首先，我们计算未归一化的权重 $\\alpha_k$：\n- $\\alpha_0 = \\frac{d_0}{(\\beta_0 + \\epsilon)^2} = \\frac{0.1}{(0.01 + 10^{-6})^2} = \\frac{0.1}{(0.010001)^2} \\approx \\frac{0.1}{0.000100020001} \\approx 999.80002$\n- $\\alpha_1 = \\frac{d_1}{(\\beta_1 + \\epsilon)^2} = \\frac{0.6}{(0.01 + 10^{-6})^2} = \\frac{0.6}{(0.010001)^2} \\approx \\frac{0.6}{0.000100020001} \\approx 5998.80012$\n- $\\alpha_2 = \\frac{d_2}{(\\beta_2 + \\epsilon)^2} = \\frac{0.3}{(16.93 + 10^{-6})^2} = \\frac{0.3}{(16.930001)^2} \\approx \\frac{0.3}{286.62493386} \\approx 0.001046661$\n\n接下来，我们计算未归一化权重的总和：\n$$\n\\sum_{j=0}^{2} \\alpha_j = \\alpha_0 + \\alpha_1 + \\alpha_2 \\approx 999.80002 + 5998.80012 + 0.001046661 \\approx 6998.601187\n$$\n现在，我们可以找到归一化的非线性权 $w_k$：\n- $w_0 = \\frac{\\alpha_0}{\\sum_j \\alpha_j} = \\frac{999.80002}{6998.601187} \\approx 0.14285713$\n- $w_1 = \\frac{\\alpha_1}{\\sum_j \\alpha_j} = \\frac{5998.80012}{6998.601187} \\approx 0.85714287$\n- $w_2 = \\frac{\\alpha_2}{\\sum_j \\alpha_j} = \\frac{0.001046661}{6998.601187} \\approx 1.49553 \\times 10^{-7}$\n\n四舍五入到四位有效数字：\n- $w_0 \\approx 0.1429$\n- $w_1 \\approx 0.8571$\n- $w_2 \\approx 1.496 \\times 10^{-7}$\n\n权重的总和为 $w_0+w_1+w_2 \\approx 0.1429 + 0.8571 + 1.496 \\times 10^{-7} \\approx 1.0000$，这是正确的。对应于非光滑模板的权重 $w_2$ 几乎为零，这证明了其基本无振荡的特性。\n\n**3. 抑制因子 ($S$) 的计算**\n跨间断模板 $S_2$ 的抑制因子 $S$ 定义为其非线性权 $w_2$ 与其理想线性权 $d_2$ 的比值。\n$$\nS = \\frac{w_2}{d_2}\n$$\n使用计算出的 $w_2$ 值和给定的 $d_2 = 0.3$：\n$$\nS = \\frac{1.49553 \\times 10^{-7}}{0.3} \\approx 4.98510 \\times 10^{-7}\n$$\n四舍五入到四位有效数字：\n$$\nS \\approx 4.985 \\times 10^{-7}\n$$\n这个极小的值量化了对包含间断的模板的剧烈抑制。\n\n四舍五入到四位有效数字的最终答案是：\n$w_0 = 0.1429$\n$w_1 = 0.8571$\n$w_2 = 1.496 \\times 10^{-7}$\n$S = 4.985 \\times 10^{-7}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1429  0.8571  1.496 \\times 10^{-7}  4.985 \\times 10^{-7} \\end{pmatrix}}\n$$", "id": "3385570"}]}