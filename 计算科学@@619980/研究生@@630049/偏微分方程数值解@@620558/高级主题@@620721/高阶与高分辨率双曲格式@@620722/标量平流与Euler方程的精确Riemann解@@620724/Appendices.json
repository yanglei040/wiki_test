{"hands_on_practices": [{"introduction": "这第一个实践是基础性的。它聚焦于最简单的双曲守恒律——线性平流方程。通过推导戈杜诺夫（Godunov）数值通量，你将具体理解单元界面上的黎曼问题精确解如何决定有限体积格式中的通量[@problem_id:3387985]。这项练习还能锻炼你将分段的物理条件转化为单一、优雅的数学公式的能力。", "problem": "考虑线性标量平流方程 $q_{t} + a\\, q_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，初始数据为黎曼初始数据：当 $x  0$ 时，$q(x,0) = q_{L}$；当 $x > 0$ 时，$q(x,0) = q_{R}$。对于守恒律 $q_{t} + f(q)_{x} = 0$，精确 Godunov 数值通量的定义是在界面 $x=0$ 处对自相似黎曼解求值的物理通量。请使用特征线法和此定义，推导在 $x=0$ 处对所有 $t>0$ 的通量函数 $f(q) = a\\, q$ 的精确 Godunov 通量。将您的最终结果表示为一个仅依赖于 $a$、$|a|$、$q_{L}$ 和 $q_{R}$ 的单一闭式解析表达式。不要提供分段定义的答案。您的最终答案必须是一个无单位的单一解析表达式。", "solution": "该问题涉及线性标量平流方程，这是一种形式为 $q_{t} + f(q)_{x} = 0$ 的守恒律。在这种特殊情况下，通量函数为 $f(q) = a\\,q$，其中 $a \\in \\mathbb{R}$ 是一个恒定的平流速度。因此方程为：\n$$\nq_{t} + (a\\,q)_{x} = 0\n$$\n由于 $a$ 是常数，这可以简化为我们熟悉的线性平流形式：\n$$\nq_{t} + a\\,q_{x} = 0\n$$\n该问题是带有黎曼初始数据的，它由两个在 $x=0$ 处被一个间断分隔的恒定状态组成：\n$$\nq(x,0) = \\begin{cases} q_{L}  \\text{if } x  0 \\\\ q_{R}  \\text{if } x > 0 \\end{cases}\n$$\n这个初值问题的解可以使用特征线法求得。特征曲线由常微分方程 $\\frac{dx}{dt} = a$ 定义，积分后得到直线 $x(t) = x_0 + at$，其中 $x_0$ 是特征线在 $t=0$ 时的位置。沿着这些特征线，控制偏微分方程意味着 $\\frac{dq}{dt} = q_t + \\frac{dx}{dt} q_x = q_t + a q_x = 0$。这意味着 $q$ 的值在每条特征线上都是恒定的。\n\n对于 $t > 0$，任意点 $(x,t)$ 处 $q$ 的值由该特征线起源的初始点 $x_0$ 处的初值决定。从 $x = x_0 + at$，我们得到 $x_0 = x - at$。因此，解由 $q(x,t) = q(x_0, 0) = q(x - at, 0)$ 给出。\n\n应用给定的黎曼初始数据，我们确定解 $q(x,t)$：\n$$\nq(x,t) = \\begin{cases} q_{L}  \\text{if } x - at  0 \\iff x/t  a \\\\ q_{R}  \\text{if } x - at > 0 \\iff x/t > a \\end{cases}\n$$\n这个解表示一个以速度 $a$ 传播的单间断，或称接触波。解的值在直线 $x=at$ 的左侧为 $q_L$，在其右侧为 $q_R$。该解是自相似的，意味着它仅依赖于比率 $\\xi = x/t$。\n\n问题要求在界面 $x=0$ 处的精确 Godunov 数值通量 $f^G(q_L, q_R)$。根据定义，这是在界面位置使用精确黎曼解的状态 $q$ 计算出的物理通量 $f(q)$。在数学上，对于 $t>0$：\n$$\nf^G(q_L, q_R) = f(q(0, t))\n$$\n为了找到 $q(0, t)$，我们考察自相似解在 $x/t = 0$ 处的情况。$q(0,t)$ 的值取决于平流速度 $a$ 的符号。\n\n情况1：$a > 0$。\n平流从左向右。在界面 $x=0$ 处，我们有 $x/t = 0$。由于 $a>0$，条件 $x/t  a$ 得到满足（即 $0  a$）。因此，界面处的状态是左状态：\n$$\nq(0, t) = q_{L}\n$$\n于是 Godunov 通量为：\n$$\nf^G = f(q_L) = a\\,q_L\n$$\n\n情况2：$a  0$。\n平流从右向左。在界面 $x=0$ 处，我们同样有 $x/t=0$。由于 $a0$，条件 $x/t > a$ 得到满足（即 $0 > a$）。因此，界面处的状态是右状态：\n$$\nq(0, t) = q_{R}\n$$\n于是 Godunov 通量为：\n$$\nf^G = f(q_R) = a\\,q_R\n$$\n\n情况3：$a = 0$。\n偏微分方程变为 $q_t = 0$，意味着解是静止的。间断点保持在 $x=0$。对于任何 $q$ 值，通量为 $f(q) = 0 \\cdot q = 0$。因此，界面处的通量为零。\n$$\nf^G = 0\n$$\n这种情况与前面的两个发现是一致的，因为如果 $a=0$，那么 $a\\,q_L = 0$ 且 $a\\,q_R=0$。\n\n总之，Godunov 通量由以下分段表达式给出：\n$$\nf^G = \\begin{cases} a\\,q_L  \\text{if } a > 0 \\\\ a\\,q_R  \\text{if } a  0 \\\\ 0  \\text{if } a=0 \\end{cases}\n$$\n问题要求一个关于 $a$、$|a|$、$q_L$ 和 $q_R$ 的单一闭式解析表达式。我们可以利用绝对值函数的性质构造这样一个表达式。我们可以将关于 $a$ 的条件表达如下：\n$q_L$ 的系数在 $a>0$ 时应为 $a$，否则为 $0$。这可以写成 $\\frac{1}{2}(a+|a|)$。\n- 如果 $a>0$，$\\frac{1}{2}(a+a) = a$。\n- 如果 $a0$，$\\frac{1}{2}(a-a) = 0$。\n- 如果 $a=0$，$\\frac{1}{2}(0+0) = 0$。\n\n$q_R$ 的系数在 $a0$ 时应为 $a$，否则为 $0$。这可以写成 $\\frac{1}{2}(a-|a|)$。\n- 如果 $a>0$，$\\frac{1}{2}(a-a) = 0$。\n- 如果 $a0$，$\\frac{1}{2}(a-(-a)) = a$。\n- 如果 $a=0$，$\\frac{1}{2}(0-0) = 0$。\n\n结合这些，我们可以将通量写成 $q_L$ 和 $q_R$ 与这些系数的线性组合：\n$$\nf^G = \\frac{1}{2}(a+|a|)q_L + \\frac{1}{2}(a-|a|)q_R\n$$\n这个表达式对所有 $a \\in \\mathbb{R}$ 都正确地复现了分段定义。我们可以通过合并包含 $a$ 和 $|a|$ 的项来重新排列这个表达式：\n$$\nf^G = \\frac{1}{2}a\\,q_L + \\frac{1}{2}|a|\\,q_L + \\frac{1}{2}a\\,q_R - \\frac{1}{2}|a|\\,q_R\n$$\n$$\nf^G = \\frac{1}{2}a(q_L + q_R) + \\frac{1}{2}|a|(q_L - q_R)\n$$\n这就是所求的 Godunov 通量的单一闭式解析表达式，通常被称为线性平流的迎风通量。", "answer": "$$\n\\boxed{\\frac{1}{2}a(q_L + q_R) + \\frac{1}{2}|a|(q_L - q_R)}\n$$", "id": "3387985"}, {"introduction": "现在我们从标量方程进阶到支配气体动力学的欧拉方程组。这个练习将完整的黎曼问题简化为一个只存在接触间断的特殊情况[@problem_id:3388002]。通过分析这一场景，你将学会运用朗肯-雨贡尼奥（Rankine-Hugoniot）跳跃关系来验证波的性质，并理解接触间断的独特属性——速度和压力连续，而密度不连续。", "problem": "考虑理想气体的一维可压缩欧拉方程，其守恒形式为\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\\n\\rho u \\\\\nE\n\\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\n(E+p)u\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\n其中 $x$ 是空间坐标，$t$ 是时间，$\\rho$ 是质量密度，$u$ 是速度，$p$ 是压力，$E$ 是单位体积的总能量。理想气体状态方程（EOS）为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$，其中绝热指数 $\\gamma > 1$ 为常数。黎曼问题包含一个在 $x=0$ 处的单个间断的初始条件：\n$$\n(\\rho(x,0),u(x,0),p(x,0)) =\n\\begin{cases}\n(\\rho_{L},u_{L},p_{L}),  x0, \\\\\n(\\rho_{R},u_{R},p_{R}),  x>0,\n\\end{cases}\n$$\n其中下标 $L$ 和 $R$ 分别表示左、右状态。假设 $p_{L} = p_{R}$ 且 $u_{L} = u_{R}$，但 $\\rho_{L} \\neq \\rho_{R}$，并且两侧的状态方程参数 $\\gamma$ 相同。\n\n从守恒律和跨越移动间断的朗肯-雨贡纽跳跃条件出发，并且仅使用欧拉系统的特征场的基本性质（不借助预先推导的黎曼求解器公式），完成以下任务：\n\n1. 证明该黎曼问题的精确解由一个单一的、纯粹的接触间断组成，并且没有产生声波（压缩波或膨胀波）。\n\n2. 计算该接触间断的速度 $s_{c}$，以及在接触间断左右两侧紧邻的中间状态下的原始变量，分别表示为 $(\\rho_{*,L},u_{*},p_{*})$ 和 $(\\rho_{*,R},u_{*},p_{*})$。\n\n使用 LaTeX 的 $\\texttt{pmatrix}$ 环境，将你的最终答案表示为单行矩阵，顺序如下\n$$\n\\left(s_{c},\\,p_{*},\\,u_{*},\\,\\rho_{*,L},\\,\\rho_{*,R}\\right).\n$$\n不需要进行数值近似或四舍五入，应提供精确的符号表达式。最终答案中无需报告物理单位。", "solution": "该问题要求解一维可压缩欧拉方程的特定黎曼问题的精确解。我们必须首先验证问题陈述的有效性。\n\n### 第一步：提取已知条件\n控制方程为守恒形式的一维欧拉方程：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0\n$$\n其状态向量 $\\mathbf{U}$ 和通量向量 $\\mathbf{F}(\\mathbf{U})$ 由下式给出：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ (E+p)u \\end{pmatrix}\n$$\n变量为密度 $\\rho$、速度 $u$、压力 $p$ 和单位体积总能量 $E$。\n该方程组由理想气体状态方程（EOS）封闭：\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)\n$$\n其中 $\\gamma > 1$ 是常数绝热指数。\n初始条件是一个在 $x=0$ 处有间断的黎曼问题：\n$$\n(\\rho(x,0), u(x,0), p(x,0)) =\n\\begin{cases}\n(\\rho_{L}, u_{L}, p_{L}),  x  0 \\\\\n(\\rho_{R}, u_{R}, p_{R}),  x > 0\n\\end{cases}\n$$\n给定了一组特定的初始条件：\n$$\np_{L} = p_{R}, \\quad u_{L} = u_{R}, \\quad \\rho_{L} \\neq \\rho_{R}\n$$\n任务是：\n1. 证明解由一个单一的接触间断组成，没有声波。\n2. 计算该间断的速度 $s_c$ 以及中间状态 $(\\rho_{*,L}, u_*, p_*)$ 和 $(\\rho_{*,R}, u_*, p_*)$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及流体动力学的基石——欧拉方程。这是一个适定问题，描述了一个标准的、尽管简化了的黎曼问题，这是双曲型偏微分方程研究中的一个基本概念。问题是客观的，使用精确的数学语言陈述。它是自洽且一致的，没有缺失信息或矛盾的约束条件。特定的初始条件 $p_L=p_R, u_L=u_R$ 被选择用来分离一个特定的物理现象（接触间断），这是一个有效且有启发性的练习，而不是一个无关紧要的过度简化。因此，该问题是有效的。\n\n### 第三步：进行求解\n\n欧拉黎曼问题的解是自相似的，依赖于变量 $\\xi = x/t$。解由从原点发出的波所分隔的常数状态组成。欧拉系统有三个特征速度（通量雅可比矩阵 $\\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ 的特征值）：$\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$，其中 $c = \\sqrt{\\gamma p / \\rho}$ 是声速。它们对应于三族波。\n- 第 $1$-波和第 $3$-波是真正非线性的，对应于声学现象（激波或稀疏波）。跨越这些波时，所有原始变量 $(\\rho, u, p)$ 通常都会改变。\n- 第 $2$-波是线性退化的，对应于一个接触间断。跨越接触间断时，压力 $p$ 和速度 $u$ 是连续的，而密度 $\\rho$（以及因此的温度和熵）可以是不连续的。\n\n一般解的结构包括：初始左状态 $(\\rho_L, u_L, p_L)$ 通过一个 $1$-波连接到一个中间状态 $(\\rho_{*,L}, u_*, p_*)$。然后，这个状态通过一个接触间断连接到第二个中间状态 $(\\rho_{*,R}, u_*, p_*)$。最后，这个第二个中间状态通过一个 $3$-波连接到初始右状态 $(\\rho_R, u_R, p_R)$。速度 $u_*$ 和压力 $p_*$ 在 $1$-波和 $3$-波之间的区域（“星区”）是恒定的。\n\n解决黎曼问题的核心是通过匹配跨波的状态来找到 $u_*$ 和 $p_*$ 的值。跨越 $1$-波和 $3$-波的速度和压力的变化是压力跳跃的函数。如果跨波的压力跳跃为零，则该波的强度为零，并且没有原始变量会跨越它而改变（接触间断除外，在接触间断处，即使压力变化为零，密度仍然可以跳跃）。\n\n让我们检验一下没有声波产生的假设。这意味着中间星区的压力与初始压力相同，即 $p_* = p_L = p_R$。\n如果 $p_* = p_L$，则 $1$-波的强度为零。因此，速度不会跨越此波而改变，所以 $u_* = u_L$。\n如果 $p_* = p_R$，则 $3$-波的强度为零。因此，速度不会跨越此波而改变，所以 $u_* = u_R$。\n为了使解保持一致，我们必须有 $u_L = u_R$。问题陈述恰好给出了这个条件：$u_L = u_R$ 和 $p_L = p_R$。\n\n因此，这个假设是自洽的。在 $p_L = p_R$ 和 $u_L = u_R$ 的条件下，中间压力和速度必须是 $p_* = p_L = p_R$ 和 $u_* = u_L = u_R$。$1$-波和 $3$-波的强度为零，意味着它们在解中不存在。解的结构简化为初始左状态和初始右状态仅由中间波分隔，该中间波必须是接触间断。这直接回答了问题的第一个部分。\n\n问题简化为两个常数状态 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$，由一个单一间断分隔。设此间断的速度为 $s_c$。为了验证这个结构并找到速度，我们应用朗肯-雨贡纽（RH）跳跃条件。该条件指出，对于以速度 $s$ 移动的间断，通量的跳跃必须等于速度乘以守恒量的跳跃：\n$$\ns_c (\\mathbf{U}_R - \\mathbf{U}_L) = \\mathbf{F}(\\mathbf{U}_R) - \\mathbf{F}(\\mathbf{U}_L)\n$$\n其中，跳跃的“左”和“右”状态是初始条件 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$。让我们在RH方程中使用给定的条件 $u_L = u_R = u$ 和 $p_L = p_R = p$。\n\n1.  **质量守恒：**\n    $$\n    s_c(\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L = \\rho_R u - \\rho_L u = u(\\rho_R - \\rho_L)\n    $$\n    由于 $\\rho_L \\neq \\rho_R$，我们可以除以 $(\\rho_R - \\rho_L)$，得到：\n    $$\n    s_c = u\n    $$\n    所以间断的速度就是流体速度 $u=u_L=u_R$。这与特征速度 $\\lambda_2 = u$ 相匹配。\n\n2.  **动量守恒：**\n    $$\n    s_c(\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L)\n    $$\n    代入 $s_c=u$, $u_L=u_R=u$, 和 $p_L=p_R=p$：\n    $$\n    u(\\rho_R u - \\rho_L u) = (\\rho_R u^2 + p) - (\\rho_L u^2 + p)\n    $$\n    $$\n    u^2(\\rho_R - \\rho_L) = u^2(\\rho_R - \\rho_L)\n    $$\n    此方程恒等成立。\n\n3.  **能量守恒：**\n    总能量为 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$。\n    RH 条件是：\n    $$\n    s_c(E_R - E_L) = (E_R + p_R)u_R - (E_L + p_L)u_L\n    $$\n    代入 $s_c=u$, $u_L=u_R=u$, 和 $p_L=p_R=p$：\n    $$\n    u(E_R - E_L) = (E_R + p)u - (E_L + p)u\n    $$\n    $$\n    u(E_R - E_L) = u(E_R - E_L)\n    $$\n    此方程也恒等成立。\n\n对于一个以速度 $s_c = u_L = u_R$ 传播的间断，RH 条件完全满足，在该间断上，压力和速度是连续的，而密度是不连续的。这就是接触间断的定义。这正式证明了解由一个单一的接触间断组成。\n\n现在我们计算所要求的量：$s_c, p_*, u_*, \\rho_{*,L}, \\rho_{*,R}$。\n- **接触间断速度, $s_c$**：如上推导，$s_c = u_L$。\n- **中间压力, $p_*$**：压力在接触间断上是连续的，并且不受零强度声波的影响。因此，$p_* = p_L = p_R$。\n- **中间速度, $u_*$**：速度在接触间断上是连续的，并且不受零强度声波的影响。因此，$u_* = u_L = u_R$。\n- **中间密度, $\\rho_{*,L}$**：这是接触间断左侧的密度。由于 $1$-波的强度为零，接触间断左侧的状态与初始左状态相同。因此，$\\rho_{*,L} = \\rho_L$。\n- **中间密度, $\\rho_{*,R}$**：这是接触间断右侧的密度。由于 $3$-波的强度为零，接触间断右侧的状态与初始右状态相同。因此，$\\rho_{*,R} = \\rho_R$。\n\n最终结果是：\n$s_c = u_L$\n$p_* = p_L$\n$u_* = u_L$\n$\\rho_{*,L} = \\rho_L$\n$\\rho_{*,R} = \\rho_R$\n\n这些结果将按指定顺序呈现在一个单行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nu_L  p_L  u_L  \\rho_L  \\rho_R\n\\end{pmatrix}\n}\n$$", "id": "3388002"}, {"introduction": "最后的实践将理论付诸于实践，挑战你构建一个欧拉方程精确黎曼求解器的核心部分。主要困难在于求解一个关于“星区”压力 $p^{\\ast}$ 的非线性方程。在这个问题中[@problem_id:3388048]，你将利用波动函数的单调性，设计一个完整的包含区间套和二分法的数值策略，以保证收敛并正确处理如真空形成等具有挑战性的物理现象。", "problem": "考虑一个针对多方理想气体的一维可压缩欧拉方程，其比热比为 $\\gamma$。该问题以黎曼问题的形式提出，具有左态 $(\\rho_L,u_L,p_L)$ 和右态 $(\\rho_R,u_R,p_R)$，其中 $\\rho$ 是密度， $u$ 是速度， $p$ 是压力。在自相似变量下，其精确解由一系列基本波构成，这些波通过一个具有共同压力 $p^\\ast$ 和速度 $u^\\ast$ 的中间态（或称星区态），连接左态和右态。星区压力 $p^\\ast$ 被隐式地定义为一个形如 $\\Phi(p)=0$ 的标量非线性方程的唯一实根，其中 $\\Phi(p)$ 由左、右波曲线 $f_L(p)$ 和 $f_R(p)$ 以及速度跳跃 $u_R-u_L$ 构建。\n\n从守恒形式的欧拉方程、理想气体状态方程以及令星区速度相等的中间态构造出发，推导一种区间套和二分法策略。该策略需利用 $f_L(p)+f_R(p)$ 的单调性，以保证在 $p^\\ast$ 存在时收敛到该值，并在数据导致 $p^\\ast$ 趋于零时检测到真空的形成。您的策略必须：\n- 建立初始下界 $p_{\\mathrm{low}}$ 和上界 $p_{\\mathrm{high}}$，使得 $\\Phi(p_{\\mathrm{low}})\\le 0$ 和 $\\Phi(p_{\\mathrm{high}})\\ge 0$，并解释为什么在没有真空出现时这是可能的。\n- 在区间 $[p_{\\mathrm{low}},p_{\\mathrm{high}}]$ 上使用二分迭代，以在指定的容差范围内收敛到 $p^\\ast$。\n- 包含一个逻辑上合理的判据，该判据根据左、右声速和速度跳跃来检测真空的形成，并在该情况下返回 $p^\\ast=0$。\n- 分析在近真空状态下该区间限定方法的鲁棒性，并解释单调性如何防止伪收敛或振荡。\n\n将上述区间套和二分法策略实现为一个完整的、可运行的程序。对于下述每个测试用例，计算并返回小数点后十位的 $p^\\ast$。所有量均使用无量纲单位，并以无量纲单位输出压力。角度单位不适用。二分法的最终容差必须为压力单位下的 $10^{-12}$。\n\n使用以下测试套件：\n- 案例 A (典型激波管): $\\rho_L=1.0$, $u_L=0.0$, $p_L=1.0$; $\\rho_R=0.125$, $u_R=0.0$, $p_R=0.1$; $\\gamma=1.4$。\n- 案例 B (强激波): $\\rho_L=1.0$, $u_L=0.0$, $p_L=1000.0$; $\\rho_R=1.0$, $u_R=0.0$, $p_R=0.01$; $\\gamma=1.4$。\n- 案例 C (真空形成): $\\rho_L=1.0$, $u_L=-3.0$, $p_L=0.1$; $\\rho_R=1.0$, $u_R=3.0$, $p_R=0.1$; $\\gamma=1.4$。\n- 案例 D (近真空阈值): $\\rho_L=1.0$, $p_L=0.1$; $\\rho_R=1.0$, $p_R=0.1$; $\\gamma=1.4$; 定义左、右声速 $a_L=\\sqrt{\\gamma p_L/\\rho_L}$ 和 $a_R=\\sqrt{\\gamma p_R/\\rho_R}$，阈值 $T=2(a_L+a_R)/(\\gamma-1)$，选择 $\\varepsilon=10^{-8}$，并设置 $u_L=-(T-\\varepsilon)/2$，$u_R=(T-\\varepsilon)/2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个 $p^\\ast$ 均按上述案例的顺序格式化为小数点后十位的十进制数（例如 $[p_A,p_B,p_C,p_D]$）。", "solution": "该问题要求推导并实现一种数值策略，用于在黎曼问题的一维欧拉方程精确解中求解星区压力 $p^\\ast$。该策略必须基于区间套和二分法的求根方法。\n\n该解法的基础是这样一个条件：在分隔左行波和右行波的中间“星区”内，流体速度 $u^\\ast$ 和压力 $p^\\ast$ 是恒定的。速度 $u^\\ast$ 可以表示为星区压力 $p^\\ast$ 和初始左态 ($L$) 或右态 ($R$) 的函数。令这两个表达式相等，$u^\\ast_L(p^\\ast) = u^\\ast_R(p^\\ast)$，即可得到一个关于 $p^\\ast$ 的单一非线性标量方程。\n\n设初始左、右态分别为 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$，比热比为 $\\gamma$。在状态 $k \\in \\{L, R\\}$ 中的声速为 $a_k = \\sqrt{\\gamma p_k / \\rho_k}$。从左态计算得到的星区速度为 $u^\\ast_L(p) = u_L - f_L(p)$，从右态计算得到的速度为 $u^\\ast_R(p) = u_R + f_R(p)$。函数 $f_L(p)$ 和 $f_R(p)$ 的形式取决于波是激波还是稀疏波。\n\n对于具有初始数据 $(\\rho_k, u_k, p_k)$ 的通用状态 $k \\in \\{L, R\\}$，将星区压力 $p$ 与穿过波的速度变化关联起来的函数 $f_k(p)$ 定义如下：\n\n如果 $p > p_k$，则波为激波。根据朗肯-雨贡纽跳跃条件可得：\n$$f_k(p) = (p - p_k) \\left[ \\frac{A_k}{p + B_k} \\right]^{1/2}$$\n其中 $A_k = \\frac{2}{(\\gamma+1)\\rho_k}$ 且 $B_k = \\frac{\\gamma-1}{\\gamma+1}p_k$。\n\n如果 $p \\le p_k$，则波为稀疏波。根据等熵关系和黎曼不变量可得：\n$$f_k(p) = \\frac{2a_k}{\\gamma-1} \\left[ \\left(\\frac{p}{p_k}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right]$$\n此表达式在 $p_k > 0$ 时有效。如果 $p_k=0$，则不使用稀疏波表达式，因为只有激波能从零压力状态产生。所有问题数据都满足 $p_k>0$。\n\n星区压力 $p^\\ast$ 是方程 $u^\\ast_L(p) = u^\\ast_R(p)$ 的根，该方程可重写为：\n$$u_L - f_L(p) = u_R + f_R(p)$$\n整理各项得到非线性方程 $\\Phi(p) = 0$，其中：\n$$\\Phi(p) = f_L(p) + f_R(p) + u_R - u_L = 0$$\n函数 $f_L(p)$ 和 $f_R(p)$ 在 $p \\ge 0$ 时是连续且严格单调递增的。因此，它们的和 $\\Phi(p)$ 也是一个连续且严格单调递增的函数。这一性质至关重要，因为它保证了如果存在一个解 $p^\\ast \\ge 0$，那么这个解是唯一的。这种单调性使得二分法在寻找根时格外鲁棒。\n\n求解策略如下：\n\n**1. 真空形成判据**\n如果初始状态以足够快的速度相互分离，就会出现真空（$p^\\ast=0$）。我们可以通过在压力的物理下限 $p=0$ 处计算 $\\Phi(p)$ 的值来建立一个精确的条件。要形成真空，两边都必须产生稀疏波，因此当 $p \\to 0$ 时，我们使用稀疏波的公式来计算 $f_k(p)$。\n$$f_k(0) = \\lim_{p \\to 0^+} \\frac{2a_k}{\\gamma-1} \\left[ \\left(\\frac{p}{p_k}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right] = -\\frac{2a_k}{\\gamma-1}$$\n将此代入 $\\Phi(p)$ 的表达式中：\n$$\\Phi(0) = f_L(0) + f_R(0) + u_R - u_L = -\\frac{2a_L}{\\gamma-1} - \\frac{2a_R}{\\gamma-1} + u_R - u_L$$\n由于 $\\Phi(p)$ 是单调递增的，如果 $\\Phi(0) \\ge 0$，则根 $p^\\ast$ 必须满足 $p^\\ast \\le 0$。因为压力不能为负，唯一符合物理实际的解是 $p^\\ast = 0$。因此，真空形成的条件是：\n$$u_R - u_L \\ge \\frac{2}{\\gamma-1}(a_L + a_R)$$\n如果此不等式成立，我们立即设置 $p^\\ast=0$ 并终止算法。\n\n**2. 限定根的区间**\n如果不满足真空条件，则 $\\Phi(0)  0$，这意味着根 $p^\\ast$ 是正的。我们必须找到一个区间 $[p_{\\mathrm{low}}, p_{\\mathrm{high}}]$ 将根包含在内，即 $\\Phi(p_{\\mathrm{low}}) \\le 0$ 且 $\\Phi(p_{\\mathrm{high}}) \\ge 0$。\n-   **下界**：由于 $\\Phi(0)  0$，我们可以选择 $p_{\\mathrm{low}} = 0$。$\\Phi(p)$ 的单调性确保了对于所有 $0 \\le p  p^\\ast$，都有 $\\Phi(p)  0$。\n-   **上界**：我们需要找到一个 $p_{\\mathrm{high}}$ 使得 $\\Phi(p_{\\mathrm{high}}) \\ge 0$。当 $p$ 很大时，函数 $f_k(p)$ 近似按 $\\sqrt{p}$ 增长，所以当 $p \\to \\infty$ 时 $\\Phi(p) \\to \\infty$。这保证了上界的存在。一种鲁棒的寻找方法是从一个初始猜测值开始，例如 $p_{guess} = \\max(p_L, p_R)$（如果两者都为 $0$，则取一个小的正数），然后检查 $\\Phi(p_{guess})$ 的符号。如果 $\\Phi(p_{guess})  0$，意味着 $p^\\ast > p_{guess}$，因此我们重复地将猜测值加倍（$p_{guess} \\leftarrow 2 \\cdot p_{guess}$），直到 $\\Phi(p_{guess}) \\ge 0$。然后可以将这个值设为 $p_{\\mathrm{high}}$。这种迭代搜索保证会终止。\n\n**3. 二分迭代**\n在将根限定于 $[p_{\\mathrm{low}}, p_{\\mathrm{high}}]$ 区间后，二分法按以下步骤进行：\n1.  设定所需容差 $\\tau$ (此处为 $\\tau = 10^{-12}$)。\n2.  当 $(p_{\\mathrm{high}} - p_{\\mathrm{low}}) > \\tau$ 时：\n    a. 计算中点 $p_{\\mathrm{mid}} = (p_{\\mathrm{low}} + p_{\\mathrm{high}}) / 2$。\n    b. 计算 $\\Phi(p_{\\mathrm{mid}})$ 的值。\n    c. 如果 $\\Phi(p_{\\mathrm{mid}})  0$，根位于区间的上半部分。更新下界：$p_{\\mathrm{low}} = p_{\\mathrm{mid}}$。\n    d. 如果 $\\Phi(p_{\\mathrm{mid}}) \\ge 0$，根位于区间的下半部分。更新上界：$p_{\\mathrm{high}} = p_{\\mathrm{mid}}$。\n3.  星区压力的最终近似值为 $p^\\ast = (p_{\\mathrm{low}} + p_{\\mathrm{high}}) / 2$。\n\n**4. 鲁棒性分析**\n该策略的鲁棒性直接源于 $\\Phi(p)$ 的单调性。\n-   **保证收敛**：单调性确保了根的唯一性。二分算法系统地将搜索区间减半，保证收敛到这个唯一的根，没有任何过冲或振荡的风险，而如果函数不是良态的，这些问题可能会困扰像牛顿法这样的方法。\n-   **近真空状态**：即使当 $p^\\ast$ 是一个非常小的正数时，该策略也是鲁棒的。问题的案例D就是为此设计的，其中 $u_R - u_L$ 仅略小于真空阈值。在这种情况下，$\\Phi(0)$ 是一个小的负数（在案例D的构造中为 $-\\varepsilon$）。我们的算法能正确推断出 $p^\\ast > 0$。区间限定从 $[0, p_{\\mathrm{high}}]$ 开始，并将成功地包围这个小的正根。然后，二分法将以预定的精度收敛到它。对于小的 $p>0$，稀疏波函数 $f_k(p) \\propto p^{(\\gamma-1)/(2\\gamma)}$ 的良定义行为（对于 $\\gamma>1$，指数为正）防止了在 $p=0$ 附近的数值不稳定性。对真空情况 $\\Phi(0)\\ge 0$ 进行初始的显式检查，对于区分 $p^\\ast=0$ 的情况和 $p^\\ast \\to 0^+$ 的情况至关重要，从而确保在所有工况下的正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the star pressure for several Riemann problem test cases using a\n    bracketing-and-bisection solver.\n    \"\"\"\n\n    def compute_p_star(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma, tol=1e-12):\n        \"\"\"\n        Calculates the star pressure p_star for a given Riemann problem.\n\n        Args:\n            rho_L, u_L, p_L (float): Density, velocity, pressure of the left state.\n            rho_R, u_R, p_R (float): Density, velocity, pressure of the right state.\n            gamma (float): Ratio of specific heats.\n            tol (float): Tolerance for the bisection solver.\n\n        Returns:\n            float: The computed star pressure p_star.\n        \"\"\"\n\n        # Step 0: Validate inputs\n        if p_L  0 or rho_L = 0 or p_R  0 or rho_R = 0:\n            raise ValueError(\"Pressure must be non-negative and density must be positive.\")\n\n        # Step 1: Calculate sound speeds and check for vacuum\n        a_L = np.sqrt(gamma * p_L / rho_L)\n        a_R = np.sqrt(gamma * p_R / rho_R)\n        \n        du = u_R - u_L\n        \n        # Vacuum formation condition\n        vacuum_threshold = 2.0 / (gamma - 1.0) * (a_L + a_R)\n        if du >= vacuum_threshold:\n            return 0.0\n\n        # Step 2: Define the wave function f_k(p) and the main function Phi(p)\n        g1 = (gamma - 1.0) / (2.0 * gamma)\n        \n        def f_k(p, rho_k, p_k, a_k):\n            \"\"\"\n            Calculates the wave function for a given state k and pressure p.\n            \"\"\"\n            if p > p_k:  # Shock wave\n                A_k = 2.0 / ((gamma + 1.0) * rho_k)\n                B_k = (gamma - 1.0) / (gamma + 1.0) * p_k\n                return (p - p_k) * np.sqrt(A_k / (p + B_k))\n            else:  # Rarefaction wave\n                return (2.0 * a_k / (gamma - 1.0)) * ((p / p_k)**g1 - 1.0)\n\n        def phi_function(p):\n            \"\"\"\n            The root-finding function Phi(p) = f_L(p) + f_R(p) + du = 0.\n            \"\"\"\n            val_L = f_k(p, rho_L, p_L, a_L)\n            val_R = f_k(p, rho_R, p_R, a_R)\n            return val_L + val_R + du\n\n        # Step 3: Bracketing the root\n        p_low = 0.0\n        # Initial guess for the upper bound\n        p_high_guess = max(1e-6, p_L, p_R)\n        \n        # Increase upper bound until it brackets the root\n        while phi_function(p_high_guess)  0.0:\n            p_high_guess *= 2.0\n        p_high = p_high_guess\n\n        # Step 4: Bisection iteration\n        while (p_high - p_low) > tol:\n            p_mid = 0.5 * (p_low + p_high)\n            if p_mid == p_low or p_mid == p_high: # Reached machine precision\n                break\n            \n            phi_val = phi_function(p_mid)\n\n            if phi_val  0.0:\n                p_low = p_mid\n            else:\n                p_high = p_mid\n\n        p_star = 0.5 * (p_low + p_high)\n        return p_star\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (canonical shock tube)\n        (1.0, 0.0, 1.0, 0.125, 0.0, 0.1, 1.4),\n        # Case B (strong shock)\n        (1.0, 0.0, 1000.0, 1.0, 0.0, 0.01, 1.4),\n        # Case C (vacuum formation)\n        (1.0, -3.0, 0.1, 1.0, 3.0, 0.1, 1.4),\n        # Case D (near-vacuum threshold)\n        {\n            \"rho_L\": 1.0, \"p_L\": 0.1,\n            \"rho_R\": 1.0, \"p_R\": 0.1,\n            \"gamma\": 1.4, \"epsilon\": 1e-8\n        }\n    ]\n    \n    # Calculate velocities for Case D\n    case_d_params = test_cases[3]\n    gamma_d = case_d_params[\"gamma\"]\n    a_L_d = np.sqrt(gamma_d * case_d_params[\"p_L\"] / case_d_params[\"rho_L\"])\n    a_R_d = np.sqrt(gamma_d * case_d_params[\"p_R\"] / case_d_params[\"rho_R\"])\n    T_d = 2.0 * (a_L_d + a_R_d) / (gamma_d - 1.0)\n    eps_d = case_d_params[\"epsilon\"]\n    u_L_d = -(T_d - eps_d) / 2.0\n    u_R_d = (T_d - eps_d) / 2.0\n    \n    # Final list of test cases with all parameters\n    final_test_cases = [\n        test_cases[0],\n        test_cases[1],\n        test_cases[2],\n        (case_d_params[\"rho_L\"], u_L_d, case_d_params[\"p_L\"],\n         case_d_params[\"rho_R\"], u_R_d, case_d_params[\"p_R\"],\n         gamma_d)\n    ]\n\n    results = []\n    for case in final_test_cases:\n        rho_L, u_L, p_L, rho_R, u_R, p_R, gamma = case\n        p_star = compute_p_star(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma)\n        results.append(f\"{p_star:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3388048"}]}