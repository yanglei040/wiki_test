{"hands_on_practices": [{"introduction": "本练习提供了一种具体的方式来理解双曲交叉多项式空间的范围。通过确定包含所有给定总次数多项式所需的最小规模，我们可以深入了解双曲交叉指标集的几何结构及其近似能力 [@problem_id:3445907]。这个实践有助于巩固指标集的抽象定义与其所张成的函数空间之间的联系。", "problem": "考虑超立方体 $[-1,1]^{d}$ 上的张量积切比雪夫多项式基，其中 $d \\in \\mathbb{N}$ 是固定的。对于 $k \\in \\mathbb{N}_{0}$，令 $T_{k}(x)$ 表示单变量的第一类 $k$ 次切比雪夫多项式，并考虑由多重指标 $k=(k_{1},\\dots,k_{d}) \\in \\mathbb{N}_{0}^{d}$ 索引的多元基元素 $\\prod_{i=1}^{d} T_{k_{i}}(x_{i})$。对于 $N \\in \\mathbb{N}$，定义双曲交叉指标集\n$$\n\\mathcal{H}_{N} \\,=\\, \\left\\{ k \\in \\mathbb{N}_{0}^{d} \\;:\\; \\prod_{i=1}^{d} (k_{i}+1) \\leq N \\right\\},\n$$\n及相关的双曲交叉多项式空间\n$$\nV_{N} \\,=\\, \\operatorname{span}\\left\\{\\prod_{i=1}^{d} T_{k_{i}}(x_{i}) \\;:\\; k \\in \\mathcal{H}_{N}\\right\\}.\n$$\n令 $\\mathbb{P}_{p}^{(d)}$ 表示由多重指标 $\\alpha \\in \\mathbb{N}_{0}^{d}$ 满足 $|\\alpha|_{1}=\\sum_{i=1}^{d} \\alpha_{i} \\leq p$ 的单项式 $x^{\\alpha}=\\prod_{i=1}^{d} x_{i}^{\\alpha_{i}}$ 张成的所有 $d$ 元多项式的全次数多项式空间，其中 $p \\in \\mathbb{N}_{0}$ 是给定的。\n\n仅使用关于双曲交叉的基本定义、事实“$T_{k}(x)$ 是一个 $k$ 次多项式”以及“对于每个 $n \\in \\mathbb{N}_{0}$，集合 $\\{T_{0},\\dots,T_{n}\\}$ 张成次数至多为 $n$ 的单变量多项式空间”，确定最小整数 $N_{\\min}(d,p)$，使得只要 $N \\geq N_{\\min}(d,p)$，$V_{N}$ 就包含 $\\mathbb{P}_{p}^{(d)}$。\n\n你的最终答案必须是关于 $d$ 和 $p$ 的单个闭式解析表达式。无需进行数值舍入。", "solution": "用户希望我解决一个关于双曲交叉近似的问题。\n\n问题要求找到最小整数 $N_{\\min}(d,p)$，使得对于所有 $N \\geq N_{\\min}(d,p)$，双曲交叉多项式空间 $V_N$ 包含全次数多项式空间 $\\mathbb{P}_p^{(d)}$。\n\n第一步是建立两个多项式空间 $\\mathbb{P}_p^{(d)}$ 和 $V_N$ 之间的关系。空间 $\\mathbb{P}_p^{(d)}$ 定义为所有次数之和 $|\\alpha|_1 = \\sum_{i=1}^d \\alpha_i$ 至多为 $p$ 的单项式 $x^{\\alpha}$ 的张成空间。空间 $V_N$ 定义为一组张量积切比雪夫多项式的张成空间。为了比较这些空间，我们必须用一个共同的基来表示它们。张量积切比雪夫基是自然的选择。\n\n如果一个多元多项式 $P(x_1, \\dots, x_d)$ 是 $|\\alpha|_1 \\le p$ 的单项式 $x^\\alpha$ 的线性组合，并且至少有一个 $|\\alpha|_1=p$ 的单项式具有非零系数，则称其总次数为 $p$。空间 $\\mathbb{P}_p^{(d)}$ 是所有总次数至多为 $p$ 的多项式的集合。\n\n问题陈述，对于单变量，切比雪夫多项式集合 $\\{T_0(x), \\dots, T_n(x)\\}$ 张成次数至多为 $n$ 的多项式空间。一个张量积切比雪夫基函数 $\\prod_{i=1}^d T_{k_i}(x_i)$ 本身就是一个多项式。由于每个 $T_{k_i}(x_i)$ 是一个 $k_i$ 次多项式，所以乘积 $\\prod_{i=1}^d T_{k_i}(x_i)$ 是一个总次数为 $\\sum_{i=1}^d k_i = |k|_1$ 的多项式。\n\n这意味着在 $\\{\\prod_{i=1}^d T_{k_i}(x_i) : |k|_1 \\le p\\}$ 的张成空间中的任何多项式都必须属于 $\\mathbb{P}_p^{(d)}$。反之，任何总次数至多为 $p$ 的多项式都可以唯一地写成总次数至多为 $p$ 的张量积切比雪夫多项式的线性组合。因此，空间 $\\mathbb{P}_p^{(d)}$ 等价地由多重指标 $k$ 满足 $|k|_1 \\le p$ 的切比雪夫基函数集合张成。\n我们定义全次数指标集：\n$$\n\\mathcal{T}_{p} \\,=\\, \\left\\{ k \\in \\mathbb{N}_{0}^{d} \\;:\\; \\sum_{i=1}^{d} k_{i} \\leq p \\right\\}.\n$$\n然后，我们可以将 $\\mathbb{P}_{p}^{(d)}$ 写为：\n$$\n\\mathbb{P}_{p}^{(d)} \\,=\\, \\operatorname{span}\\left\\{\\prod_{i=1}^{d} T_{k_{i}}(x_{i}) \\;:\\; k \\in \\mathcal{T}_{p}\\right\\}.\n$$\n双曲交叉空间由下式给出：\n$$\nV_{N} \\,=\\, \\operatorname{span}\\left\\{\\prod_{i=1}^{d} T_{k_{i}}(x_{i}) \\;:\\; k \\in \\mathcal{H}_{N}\\right\\},\n$$\n其中 $\\mathcal{H}_{N} = \\{ k \\in \\mathbb{N}_{0}^{d} : \\prod_{i=1}^{d} (k_{i}+1) \\leq N \\}$。\n\n$V_N$ 包含 $\\mathbb{P}_p^{(d)}$ 的条件等价于要求 $\\mathbb{P}_p^{(d)}$ 的基函数集合是 $V_N$ 的基函数集合的子集。这可以转化为相应指标集的包含关系：\n$$\n\\mathcal{T}_{p} \\subseteq \\mathcal{H}_{N}.\n$$\n对于最小的 $N_{\\min}(d,p)$ 和所有 $N \\ge N_{\\min}(d,p)$，这个包含关系都必须成立。条件 $\\mathcal{T}_{p} \\subseteq \\mathcal{H}_{N}$ 意味着对于每个多重指标 $k \\in \\mathcal{T}_{p}$，它也必须在 $\\mathcal{H}_{N}$ 中。也就是说，对于每个满足 $\\sum_{i=1}^d k_i \\le p$ 的 $k=(k_1, \\dots, k_d) \\in \\mathbb{N}_0^d$，不等式 $\\prod_{i=1}^d (k_i+1) \\le N$ 必须成立。\n\n为确保这对所有 $k \\in \\mathcal{T}_p$ 都成立，$N$ 的值必须至少与乘积 $\\prod_{i=1}^d (k_i+1)$ 对任何 $k \\in \\mathcal{T}_p$ 所能取的最大值一样大。使之成立的最小整数 $N$ 正是这个最大值。\n因此，我们必须找到：\n$$\nN_{\\min}(d,p) = \\max_{k \\in \\mathcal{T}_{p}} \\left\\{ \\prod_{i=1}^{d} (k_{i}+1) \\right\\} = \\max_{\\substack{k_1,\\dots,k_d \\ge 0 \\\\ \\sum_{i=1}^d k_i \\le p \\\\ k_i \\in \\mathbb{N}_0}} \\prod_{i=1}^{d} (k_{i}+1).\n$$\n为了解决这个优化问题，我们引入新的整数变量 $j_i = k_i+1$。由于 $k_i \\ge 0$，我们有 $j_i \\ge 1$。目标函数变为 $\\prod_{i=1}^d j_i$。约束条件 $\\sum_{i=1}^d k_i \\le p$ 变为 $\\sum_{i=1}^d (j_i-1) \\le p$，可简化为 $\\sum_{i=1}^d j_i \\le p+d$。\n\n问题现在是最大化乘积 $\\prod_{i=1}^d j_i$，约束条件为 $\\sum_{i=1}^d j_i \\le p+d$ 和 $j_i \\in \\{1, 2, 3, \\ldots\\}$。由于每个 $j_i \\ge 1$，乘积是每个 $j_i$ 的严格递增函数。因此，当和 $\\sum_{i=1}^d j_i$ 最大化时，即当 $\\sum_{i=1}^d j_i = p+d$ 时，将获得最大乘积。\n\n我们现在需要找到和为常数 $S = p+d$ 且乘积最大化的正整数 $j_1, \\dots, j_d$。一个源于算术几何平均不等式（AM-GM）的著名结果是，对于固定的和，当这些数尽可能接近时，它们的乘积最大化。\n令 $S = p+d$。我们对 $S$ 进行 $d$ 的整数除法：\n$$\np+d = q \\cdot d + r,\n$$\n其中 $q = \\lfloor \\frac{p+d}{d} \\rfloor$ 是商，$r = (p+d) \\pmod d$ 是余数，满足 $0 \\le r  d$。\n为了使整数 $j_i$ 尽可能相等，我们必须选择其中 $r$ 个为 $q+1$，剩下的 $d-r$ 个为 $q$。和为 $r(q+1) + (d-r)q = rq + r + dq - rq = dq+r = p+d$，满足约束条件。\n\n因此，乘积的最大值为：\n$$\nN_{\\min}(d,p) = (q+1)^r q^{d-r}.\n$$\n我们可以用 $p$ 和 $d$ 来表示 $q$ 和 $r$。令 $q_p = \\lfloor p/d \\rfloor$ 和 $r_p = p \\pmod d$。我们有 $p = q_p d + r_p$。\n那么 $p+d = (q_p d + r_p) + d = (q_p+1) d + r_p$。\n将此与 $p+d=qd+r$ 比较，我们可以确定 $q = q_p+1$ 和 $r=r_p$。\n将这些代入最大乘积的表达式中：\n$$\nN_{\\min}(d,p) = ((q_p+1)+1)^{r_p} (q_p+1)^{d-r_p} = (q_p+2)^{r_p} (q_p+1)^{d-r_p}.\n$$\n用 $p$ 和 $d$ 的定义替换 $q_p$ 和 $r_p$，我们得到最终的闭式表达式：\n$$\nN_{\\min}(d,p) = \\left(\\lfloor \\frac{p}{d} \\rfloor + 2\\right)^{p \\pmod d} \\left(\\lfloor \\frac{p}{d} \\rfloor + 1\\right)^{d - (p \\pmod d)}.\n$$\n这里，$p \\pmod d$ 表示 $p$ 除以 $d$ 的整数除法的余数，它是一个在 $\\{0, 1, \\dots, d-1\\}$ 中的整数。", "answer": "$$\\boxed{\\left(\\left\\lfloor \\frac{p}{d} \\right\\rfloor + 2\\right)^{p \\pmod d} \\left(\\left\\lfloor \\frac{p}{d} \\right\\rfloor + 1\\right)^{d - (p \\pmod d)}}$$", "id": "3445907"}, {"introduction": "使用双曲交叉近似的主要动机是其在高维空间中的卓越效率，本练习旨在量化这一概念。我们将分析一个特定的张量积函数，并比较各向同性截断和双曲交叉截断的近似误差衰减率 [@problem_id:3445927]。该分析精确地揭示了对于具有有界混合导数的函数，双曲交叉方法如何规避维度灾难。", "problem": "考虑$d$维平环 $\\mathbb{T}^{d} = [0,1]^{d}$，其具有周期性边界条件，其中$d \\ge 2$。令$r > 0$并定义一维周期函数$g : \\mathbb{T}^{1} \\to \\mathbb{C}$，其傅里叶级数为\n$$\ng(x) = \\sum_{k \\in \\mathbb{Z}} a_{k} \\,\\exp(2\\pi i k x), \\qquad a_{k} := (1+|k|)^{-(r+1)}.\n$$\n通过张量积定义$d$元函数$f : \\mathbb{T}^{d} \\to \\mathbb{C}$\n$$\nf(x_{1},\\dots,x_{d}) := \\prod_{i=1}^{d} g(x_{i}).\n$$\n您可以将傅里叶-索博列夫特性视为已知：一个周期函数$h$属于索博列夫空间$H^{s}(\\mathbb{T}^{m})$，当且仅当其傅里叶系数$\\widehat{h}(k)$满足$\\sum_{k \\in \\mathbb{Z}^{m}} (1+|k|^{2})^{s} |\\widehat{h}(k)|^{2}  \\infty$，且到傅里叶模式集上的$L^{2}(\\mathbb{T}^{m})$正交投影误差等于被省略的傅里叶系数平方和的平方根。\n\n对于$N \\in \\mathbb{N}$，定义各向同性截断指标集\n$$\nK_{N} := \\{ k \\in \\mathbb{Z}^{d} : \\max_{1 \\le i \\le d} |k_{i}| \\le N \\},\n$$\n且对于$T \\ge \\mathrm{e}$，定义双曲交叉指标集\n$$\nH_{T} := \\left\\{ k \\in \\mathbb{Z}^{d} : \\prod_{i=1}^{d} (1+|k_{i}|) \\le T \\right\\}.\n$$\n令$\\Pi_{S} f$表示$f$在由有限集$S \\subset \\mathbb{Z}^{d}$中的指标所对应的傅里叶模式张成的空间上的$L^{2}(\\mathbb{T}^{d})$正交投影。对于$M$个傅里叶模式的预算，通过选择$N$和$T$使得$\\# K_{N} \\asymp M$和$\\# H_{T} \\asymp M$，分别定义各向同性误差$E_{\\mathrm{iso}}(M)$和双曲交叉误差$E_{\\mathrm{hc}}(M)$为\n$$\nE_{\\mathrm{iso}}(M) := \\| f - \\Pi_{K_{N}} f \\|_{L^{2}(\\mathbb{T}^{d})}, \n\\qquad\nE_{\\mathrm{hc}}(M) := \\| f - \\Pi_{H_{T}} f \\|_{L^{2}(\\mathbb{T}^{d})}.\n$$\n从索博列夫空间的傅里叶特性以及基于积分检验的格点计数和级数尾部的体积比较估计出发，推导代数衰减指数\n$$\n\\alpha_{\\mathrm{iso}}(d,r) := \\lim_{M \\to \\infty} \\frac{- \\ln E_{\\mathrm{iso}}(M)}{\\ln M},\n\\qquad\n\\alpha_{\\mathrm{hc}}(d,r) := \\lim_{M \\to \\infty} \\frac{- \\ln E_{\\mathrm{hc}}(M)}{\\ln M},\n$$\n并因此确定该比率的简化符号表达式\n$$\n\\frac{\\alpha_{\\mathrm{iso}}(d,r)}{\\alpha_{\\mathrm{hc}}(d,r)}.\n$$\n您的最终答案必须是这个仅含$d$的单封闭形式表达式。不需要进行数值舍入。", "solution": "用户要求我按照严格的程序解决问题。我必须首先验证问题陈述，如果有效，则提供一个完整、有理有据的解答。\n\n### 第1步：提取已知条件\n-   **定义域：** $d$维平环 $\\mathbb{T}^{d} = [0,1]^{d}$，$d \\ge 2$。\n-   **一维函数：** $g : \\mathbb{T}^{1} \\to \\mathbb{C}$ 由 $g(x) = \\sum_{k \\in \\mathbb{Z}} a_{k} \\,\\exp(2\\pi i k x)$ 给出。\n-   **一维傅里叶系数：** 对于$r > 0$，有$a_{k} := (1+|k|)^{-(r+1)}$。\n-   **d元函数：** $f : \\mathbb{T}^{d} \\to \\mathbb{C}$ 由张量积 $f(x_{1},\\dots,x_{d}) := \\prod_{i=1}^{d} g(x_{i})$ 给出。\n-   **索博列夫空间特性：** 函数$h \\in H^{s}(\\mathbb{T}^{m})$ 当且仅当其傅里叶系数$\\widehat{h}(k)$满足 $\\sum_{k \\in \\mathbb{Z}^{m}} (1+|k|^{2})^{s} |\\widehat{h}(k)|^{2}  \\infty$。\n-   **投影误差：** 在傅里叶模式集$S$上的$L^{2}(\\mathbb{T}^{m})$正交投影误差为 $\\|h - \\Pi_{S} h \\|_{L^{2}} = \\left( \\sum_{k \\in \\mathbb{Z}^{m} \\setminus S} |\\widehat{h}(k)|^{2} \\right)^{1/2}$。\n-   **各向同性指标集：** 对于$N \\in \\mathbb{N}$，有$K_{N} := \\{ k \\in \\mathbb{Z}^{d} : \\max_{1 \\le i \\le d} |k_{i}| \\le N \\}$。\n-   **双曲交叉指标集：** 对于$T \\ge \\mathrm{e}$，有$H_{T} := \\{ k \\in \\mathbb{Z}^{d} : \\prod_{i=1}^{d} (1+|k_{i}|) \\le T \\}$。\n-   **逼近误差：** $E_{\\mathrm{iso}}(M) := \\| f - \\Pi_{K_{N}} f \\|_{L^{2}(\\mathbb{T}^{d})}$，其中$\\# K_{N} \\asymp M$；以及 $E_{\\mathrm{hc}}(M) := \\| f - \\Pi_{H_{T}} f \\|_{L^{2}(\\mathbb{T}^{d})}$，其中$\\# H_{T} \\asymp M$。\n-   **衰减指数：** $\\alpha_{\\mathrm{iso}}(d,r) := \\lim_{M \\to \\infty} \\frac{- \\ln E_{\\mathrm{iso}}(M)}{\\ln M}$ 以及 $\\alpha_{\\mathrm{hc}}(d,r) := \\lim_{M \\to \\infty} \\frac{- \\ln E_{\\mathrm{hc}}(M)}{\\ln M}$。\n-   **目标：** 推导比率$\\frac{\\alpha_{\\mathrm{iso}}(d,r)}{\\alpha_{\\mathrm{hc}}(d,r)}$的符号表达式。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行分析。\n-   **科学依据：** 该问题是高维逼近理论（数值分析的一个子领域）中的一个标准练习。所有概念，包括索博列夫空间、傅里叶级数、张量积函数以及通过各向同性和双曲交叉指标集进行的逼近，都是成熟的数学构造。\n-   **适定性：** 问题陈述清晰，具有精确的数学定义。它要求推导明确定义的渐近收敛率及其比率，存在唯一解。\n-   **明确性：** 问题陈述使用正式、无歧义的数学语言编写。\n-   **合理性、完整性、一致性：** 前提在数学上是合理的。通过傅里叶系数定义函数`f`与索博列夫空间的框架是一致的。所提供的定义和条件足以解决问题。条件$d \\ge 2$、$r>0$和$T \\ge \\mathrm{e}$是适当的，不会引入矛盾。\n-   **相关性：** 该问题直接关系到稀疏网格和双曲交叉逼近的分析，这些是高维偏微分方程数值解的核心。\n-   **无其他缺陷：** 问题并非无关紧要、隐喻性或不可证伪。它需要严格的数学推导。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。将提供完整解答。\n\n### 解答\n解答过程首先确定函数$f$的傅里叶系数，然后分析其在各向同性和混合索博列夫意义下的光滑性。这些光滑性属性直接决定了两种逼近方案的收敛速度，由此我们可以求得所需的指数$\\alpha_{\\mathrm{iso}}$和$\\alpha_{\\mathrm{hc}}$。\n\n**1. 张量积函数的傅里叶系数**\n函数$f(x)$被定义为$d$个相同的一维函数$g(x_i)$的张量积。对于$k = (k_1, \\dots, k_d) \\in \\mathbb{Z}^d$的傅里叶系数$\\widehat{f}(k)$是相应的一维傅里叶系数的乘积：\n$$\n\\widehat{f}(k) = \\int_{\\mathbb{T}^d} f(x) \\exp(-2\\pi i k \\cdot x) \\,dx = \\int_{[0,1]^d} \\left(\\prod_{j=1}^d g(x_j)\\right) \\left(\\prod_{j=1}^d \\exp(-2\\pi i k_j x_j)\\right) \\,dx_1 \\dots dx_d\n$$\n$$\n= \\prod_{j=1}^d \\left( \\int_0^1 g(x_j) \\exp(-2\\pi i k_j x_j) \\,dx_j \\right) = \\prod_{j=1}^d \\widehat{g}(k_j)\n$$\n已知$\\widehat{g}(k_j) = a_{k_j} = (1+|k_j|)^{-(r+1)}$，因此$f$的傅里叶系数为：\n$$\n\\widehat{f}(k) = \\prod_{j=1}^d (1+|k_j|)^{-(r+1)}.\n$$\n\n**2. 各向同性逼近率**\n各向同性截断方案的收敛速度由$f$的各向同性索博列夫正则性决定。函数$f$属于索博列夫空间$H^s(\\mathbb{T}^d)$，如果其$H^s$-范数是有限的，根据所给的特性，这意味着：\n$$\n\\|f\\|_{H^s}^2 = \\sum_{k \\in \\mathbb{Z}^d} (1+|k|^2)^s |\\widehat{f}(k)|^2  \\infty,\n$$\n其中$|k|^2 = \\sum_{j=1}^d k_j^2$。代入$|\\widehat{f}(k)|^2$的表达式：\n$$\n\\|f\\|_{H^s}^2 = \\sum_{k \\in \\mathbb{Z}^d} (1+\\sum_{j=1}^d k_j^2)^s \\prod_{j=1}^d (1+|k_j|)^{-2(r+1)}.\n$$\n为了确定该级数收敛的最大$s$值，我们分析其渐近行为。收敛性受限于项的最慢衰减，这发生在坐标轴上。例如，考虑$k = (k_1, 0, \\dots, 0)$且$|k_1| \\to \\infty$的轴。对于这些指标，级数的一般项行为如下：\n$$\n(1+k_1^2)^s (1+|k_1|)^{-2(r+1)} \\cdot \\prod_{j=2}^d (1+0)^{-2(r+1)} \\asymp |k_1|^{2s} |k_1|^{-2(r+1)} = |k_1|^{2s - 2(r+1)}.\n$$\n对$k_1 \\in \\mathbb{Z}$的求和收敛当且仅当指数小于$-1$。这是一维p级数判别法。\n$$\n2s - 2(r+1)  -1 \\implies 2s  2r+1 \\implies s  r + \\frac{1}{2}.\n$$\n因此，$f \\in H^s(\\mathbb{T}^d)$ 对于所有 $s  r+1/2$ 成立。极限索博列夫正则性为 $s_{\\mathrm{eff}} = r+1/2$。\n\n对于使用集合$K_N$的各向同性逼近方案，基函数的数量（自由度）为$M = \\#K_N = (2N+1)^d \\asymp N^d$。这意味着$N \\asymp M^{1/d}$。对于来自$H^s$的$L^2$逼近误差的标准结果是$\\|f - \\Pi_{K_N}f\\|_{L^2} \\asymp N^{-s}$。结合这些，我们得到以$M$表示的误差：\n$$\nE_{\\mathrm{iso}}(M) \\asymp N^{-s_{\\mathrm{eff}}} \\asymp (M^{1/d})^{-s_{\\mathrm{eff}}} = M^{-s_{\\mathrm{eff}}/d}.\n$$\n代入$s_{\\mathrm{eff}} = r+1/2$，渐近误差为：\n$$\nE_{\\mathrm{iso}}(M) \\asymp M^{-(r+1/2)/d}.\n$$\n根据$\\alpha_{\\mathrm{iso}}$的定义，如果$E(M) \\asymp M^{-\\alpha}$，那么$\\alpha = \\lim_{M \\to \\infty} \\frac{-\\ln(C M^{-\\alpha})}{\\ln M} = \\alpha$。因此，\n$$\n\\alpha_{\\mathrm{iso}}(d,r) = \\frac{r+1/2}{d}.\n$$\n\n**3. 双曲交叉逼近率**\n双曲交叉方案的收敛速度由$f$的混合索博列夫正则性决定。具有平方可积的$s$阶混合导数的函数空间，记为$H^s_{\\mathrm{mix}}(\\mathbb{T}^d)$，其特征是以下级数的收敛性：\n$$\n\\sum_{k \\in \\mathbb{Z}^d} \\left(\\prod_{j=1}^d (1+k_j^2)^s\\right) |\\widehat{f}(k)|^2  \\infty.\n$$\n代入$|\\widehat{f}(k)|^2$并对大的$|k_j|$使用渐近等价关系$(1+k_j^2) \\asymp (1+|k_j|)^2$，条件变为：\n$$\n\\sum_{k \\in \\mathbb{Z}^d} \\prod_{j=1}^d (1+|k_j|)^{2s} (1+|k_j|)^{-2(r+1)}  \\infty\n$$\n$$\n\\sum_{k \\in \\mathbb{Z}^d} \\prod_{j=1}^d (1+|k_j|)^{2(s-r-1)}  \\infty.\n$$\n这个和是可分离的：\n$$\n\\left( \\sum_{m \\in \\mathbb{Z}} (1+|m|)^{2(s-r-1)} \\right)^d  \\infty.\n$$\n整个表达式是有限的，当且仅当一维和收敛。再次根据p级数判别法，这要求指数小于$-1$：\n$$\n2(s-r-1)  -1 \\implies 2s - 2r - 2  -1 \\implies 2s  2r+1 \\implies s  r + \\frac{1}{2}.\n$$\n因此，$f$具有极限混合索博列夫正则性$s_{\\mathrm{mix}} = r+1/2$。\n\n对于双曲交叉逼近，基函数的数量为$M = \\#H_T \\asymp T (\\ln T)^{d-1}$。逼近$H^s_{\\mathrm{mix}}(\\mathbb{T}^d)$中函数的$L^2$误差的标准结果是$E_{\\mathrm{hc}}(M) \\asymp M^{-s}$（不计对数因子）。也就是说，$E_{\\mathrm{hc}}(M) \\asymp M^{-s_{\\mathrm{mix}}} (\\ln M)^{\\beta}$，其中$\\beta$为某个幂。\n代数衰减指数$\\alpha_{\\mathrm{hc}}$由$M$的主幂次决定：\n$$\n\\alpha_{\\mathrm{hc}}(d,r) = \\lim_{M \\to \\infty} \\frac{-\\ln(C M^{-s_{\\mathrm{mix}}} (\\ln M)^{\\beta})}{\\ln M} = \\lim_{M \\to \\infty} \\frac{s_{\\mathrm{mix}}\\ln M - \\beta\\ln(\\ln M) - \\ln C}{\\ln M} = s_{\\mathrm{mix}}.\n$$\n代入$s_{\\mathrm{mix}} = r+1/2$：\n$$\n\\alpha_{\\mathrm{hc}}(d,r) = r + \\frac{1}{2}.\n$$\n这个速率与维度$d$无关，这是双曲交叉/稀疏网格方法对此类张量积函数的关键优势。\n\n**4. 衰减指数之比**\n最后，我们计算两个指数的比率。与函数光滑性相关的参数$r$将被消去。\n$$\n\\frac{\\alpha_{\\mathrm{iso}}(d,r)}{\\alpha_{\\mathrm{hc}}(d,r)} = \\frac{(r+1/2)/d}{r+1/2}.\n$$\n因为$r>0$，所以项$r+1/2$严格为正，我们可以从分子和分母中消去它：\n$$\n\\frac{\\alpha_{\\mathrm{iso}}(d,r)}{\\alpha_{\\mathrm{hc}}(d,r)} = \\frac{1}{d}.\n$$\n这个结果量化了影响各向同性逼近方案的“维度灾难”，其收敛速度以$1/d$恶化，而双曲交叉方案对于此类张量积函数的收敛速度与维度无关。", "answer": "$$\n\\boxed{\\frac{1}{d}}\n$$", "id": "3445927"}, {"introduction": "从理论转向实践，Smolyak 算法是构建稀疏网格求积法则的主要工具，但其稳定性并非必然。本问题探讨了一个关键的实际问题：可能出现的负求积权重，这会降低数值稳定性 [@problem_id:3445937]。通过分析一个简单的两层结构，您将确定确保所有权重非负所需满足的条件，这是实现稳健方法的关键一步。", "problem": "考虑在单位正方形上，由偏微分方程（PDE）的弱形式产生的双线性形式的数值逼近问题。设目标是通过一个由一维规则构造的二维Smolyak求积来逼近在$[0,1]^{2}$上的积分。Smolyak构造使用基于$C([0,1])$上的一族一维线性泛函$\\{Q_{\\ell}\\}_{\\ell \\geq 1}$构建的层次增量。\n\n假设使用以下一维族：\n- 层级$\\ell = 1$是闭式Newton–Cotes（NC）梯形法则，记作$Q_{1}$，其节点为$\\{0,1\\}$，权重为$\\{ \\tfrac{1}{2}, \\tfrac{1}{2} \\}$。\n- 层级$\\ell = 2$选自一个单参数族的闭式、等距、三节点公式，记作$Q_{2}^{\\alpha}$，其节点为$\\{0,\\tfrac{1}{2},1\\}$，对称权重为$\\{\\tfrac{\\alpha}{2}, 1-\\alpha, \\tfrac{\\alpha}{2}\\}$，其中参数$\\alpha \\in (0,1]$。该族对常数和线性函数保持精确性，并在$\\alpha = \\tfrac{1}{3}$时包含辛普森法则。\n\n定义层次增量$\\Delta Q_{1} := Q_{1}$和$\\Delta Q_{2} := Q_{2}^{\\alpha} - Q_{1}$。层级$L=2$的二维Smolyak求积由这些增量构建如下：\n$$\nA(2,2) \\;=\\; \\sum_{|\\boldsymbol{\\ell}|_{1} \\leq L + d - 1} \\;\\bigotimes_{j=1}^{2} \\Delta Q_{\\ell_{j}} \\;=\\; \\Delta Q_{1} \\otimes \\Delta Q_{1} \\;+\\; \\Delta Q_{1} \\otimes \\Delta Q_{2} \\;+\\; \\Delta Q_{2} \\otimes \\Delta Q_{1},\n$$\n其中$d=2$且$|\\boldsymbol{\\ell}|_{1} = \\ell_{1} + \\ell_{2}$。\n\n已知$A(2,2)$中的负求积权重会降低稳定性，并可能损害PDE算子稀疏网格离散化的收敛性。请以闭式形式确定参数$\\alpha$的最小值，使得上述构造的二维Smolyak法则$A(2,2)$在其完整节点集上的所有权重均为非负。请以单个精确数值（无单位）的形式提供最终答案。", "solution": "用户希望找到参数$\\alpha$的最小值，以确保一个特定的二维Smolyak求积法则的所有求积权重都是非负的。\n\n### 步骤 1：问题验证\n\n首先根据指定标准对问题进行验证。\n\n**1. 提取已知条件：**\n-   **定义域：** 积分在单位正方形$[0,1]^2$上进行。\n-   **一维求积法则：** 定义了$C([0,1])$上的一族一维线性泛函$\\{Q_{\\ell}\\}_{\\ell \\geq 1}$。\n    -   $Q_1$：层级$\\ell=1$的法则是梯形法则，节点为$\\{0,1\\}$，权重为$\\{\\frac{1}{2}, \\frac{1}{2}\\}$。对于函数$f(x)$，这意味着$Q_1(f) = \\frac{1}{2}f(0) + \\frac{1}{2}f(1)$。\n    -   $Q_2^{\\alpha}$：层级$\\ell=2$的法则是来自一个三节点公式族，节点为$\\{0, \\frac{1}{2}, 1\\}$，对称权重为$\\{\\frac{\\alpha}{2}, 1-\\alpha, \\frac{\\alpha}{2}\\}$。参数$\\alpha$的范围是$(0,1]$。对于函数$f(x)$，这意味着$Q_2^{\\alpha}(f) = \\frac{\\alpha}{2}f(0) + (1-\\alpha)f(\\frac{1}{2}) + \\frac{\\alpha}{2}f(1)$。\n-   **层次增量：**\n    -   $\\Delta Q_1 := Q_1$。\n    -   $\\Delta Q_2 := Q_2^{\\alpha} - Q_1$。\n-   **二维Smolyak求积法则：** 层级$L=2$，维度$d=2$的法则由以下公式给出：\n    $$A(2,2) = \\sum_{|\\boldsymbol{\\ell}|_{1} \\leq L + d - 1} \\bigotimes_{j=1}^{2} \\Delta Q_{\\ell_{j}} = \\Delta Q_1 \\otimes \\Delta Q_1 + \\Delta Q_1 \\otimes \\Delta Q_2 + \\Delta Q_2 \\otimes \\Delta Q_1$$\n    其中$|\\boldsymbol{\\ell}|_1 = \\ell_1 + \\ell_2$。求和索引$\\ell_j$从1开始，因此条件$|\\boldsymbol{\\ell}|_1 \\leq 2+2-1=3$产生多重索引$(1,1)$、$(1,2)$和$(2,1)$。\n-   **目标：** 找到$\\alpha \\in (0,1]$的最小值，使得求积法则$A(2,2)$的所有权重均为非负。\n\n**2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题牢固地植根于数值分析领域，特别是使用Smolyak算法构造稀疏网格求积法则。层次增量、求积法则的张量积以及正权重对数值稳定性的重要性等概念都是标准且成熟的。\n-   **适定性：** 该问题为求积法则$A(2,2)$提供了完整且无歧义的定义，并有一个明确的目标。参数$\\alpha$被限制在一个特定的区间内。问题的结构保证了其具有唯一且有意义的解。\n-   **客观性：** 问题使用精确的数学语言陈述，没有任何主观或有偏见的术语。\n\n**3. 结论与行动：**\n该问题是有效的，因为它具有科学依据、适定且客观。它不包含任何矛盾、歧义或不成立的前提。因此，我将继续进行完整解答。\n\n### 步骤 2：求解推导\n\n求解过程首先确定Smolyak法则$A(2,2)$的权重（作为$\\alpha$的函数），然后找到满足所有权重非负约束的最小$\\alpha$。\n\n**1. 用函数求值表示一维层次增量：**\n设$f(x)$是定义在$[0,1]$上的函数。\n层级1的增量为：\n$$ \\Delta Q_1(f) = Q_1(f) = \\frac{1}{2}f(0) + \\frac{1}{2}f(1) $$\n该算子在节点集$\\{0, 1\\}$上的权重为$\\{\\frac{1}{2}, \\frac{1}{2}\\}$。\n\n层级2的增量为：\n$$ \\Delta Q_2(f) = Q_2^{\\alpha}(f) - Q_1(f) $$\n$$ \\Delta Q_2(f) = \\left( \\frac{\\alpha}{2}f(0) + (1-\\alpha)f(\\frac{1}{2}) + \\frac{\\alpha}{2}f(1) \\right) - \\left( \\frac{1}{2}f(0) + \\frac{1}{2}f(1) \\right) $$\n对每个求值点合并项：\n$$ \\Delta Q_2(f) = \\left(\\frac{\\alpha}{2} - \\frac{1}{2}\\right)f(0) + (1-\\alpha)f(\\frac{1}{2}) + \\left(\\frac{\\alpha}{2} - \\frac{1}{2}\\right)f(1) $$\n$$ \\Delta Q_2(f) = \\frac{\\alpha-1}{2}f(0) + (1-\\alpha)f(\\frac{1}{2}) + \\frac{\\alpha-1}{2}f(1) $$\n该算子在节点集$\\{0, \\frac{1}{2}, 1\\}$上的权重为$\\{\\frac{\\alpha-1}{2}, 1-\\alpha, \\frac{\\alpha-1}{2}\\}$。\n\n**2. 确定二维Smolyak法则的节点集和权重：**\nSmolyak求积法则$A(2,2)$是张量积法则的线性组合。最终法则中一个点$(x_i, y_j)$的权重是其在求和中每一项的权重之和：\n$$ A(2,2) = (\\Delta Q_1 \\otimes \\Delta Q_1) + (\\Delta Q_1 \\otimes \\Delta Q_2) + (\\Delta Q_2 \\otimes \\Delta Q_1) $$\n$A(2,2)$的完整节点集是各个张量积法则节点集的并集。设$X_1 = \\{0,1\\}$和$X_2 = \\{0, \\frac{1}{2}, 1\\}$。$A(2,2)$的节点集是$(X_1 \\times X_1) \\cup (X_1 \\times X_2) \\cup (X_2 \\times X_1)$。这得到点集$\\{(0,0), (0,1), (1,0), (1,1), (0,\\frac{1}{2}), (1,\\frac{1}{2}), (\\frac{1}{2},0), (\\frac{1}{2},1)\\}$。点$(\\frac{1}{2},\\frac{1}{2})$不包含在这个稀疏网格中。\n\n设$w(x_i, y_j)$表示节点$(x_i, y_j)$处的最终权重。我们利用对称性计算每种类型节点的权重。设$w_1(x)$是$\\Delta Q_1$的权重函数，$w_2(x)$是$\\Delta Q_2$的权重函数。一个点$(x_i, y_j)$在张量积法则$\\Delta Q_k \\otimes \\Delta Q_m$中的权重是$w_k(x_i) \\cdot w_m(y_j)$。\n\n-   **角节点：** 例如$(0,0)$。根据对称性，所有四个角节点$(0,0), (0,1), (1,0), (1,1)$将具有相同的权重。\n    -   来自$\\Delta Q_1 \\otimes \\Delta Q_1$的权重：$w_1(0) \\cdot w_1(0) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$。\n    -   来自$\\Delta Q_1 \\otimes \\Delta Q_2$的权重：$w_1(0) \\cdot w_2(0) = \\frac{1}{2} \\cdot \\frac{\\alpha-1}{2} = \\frac{\\alpha-1}{4}$。\n    -   来自$\\Delta Q_2 \\otimes \\Delta Q_1$的权重：$w_2(0) \\cdot w_1(0) = \\frac{\\alpha-1}{2} \\cdot \\frac{1}{2} = \\frac{\\alpha-1}{4}$。\n    -   总权重 $w(0,0) = \\frac{1}{4} + \\frac{\\alpha-1}{4} + \\frac{\\alpha-1}{4} = \\frac{1 + \\alpha - 1 + \\alpha - 1}{4} = \\frac{2\\alpha-1}{4}$。\n\n-   **边中点节点：** 例如$(0, \\frac{1}{2})$。根据对称性，节点$(0,\\frac{1}{2})$和$(1,\\frac{1}{2})$将有一个权重值，而$(\\frac{1}{2},0)$和$(\\frac{1}{2},1)$将有另一个权重值（结果证明是相同的）。\n    -   对于点$(0, \\frac{1}{2})$：\n        -   $\\Delta Q_1$和$\\Delta Q_1 \\otimes \\Delta Q_1$的节点集不包含坐标$\\frac{1}{2}$，因此$w_1(\\frac{1}{2}) = 0$。来自$\\Delta Q_1 \\otimes \\Delta Q_1$的贡献为$w_1(0) \\cdot w_1(\\frac{1}{2}) = \\frac{1}{2} \\cdot 0 = 0$。\n        -   来自$\\Delta Q_1 \\otimes \\Delta Q_2$的权重：$w_1(0) \\cdot w_2(\\frac{1}{2}) = \\frac{1}{2} \\cdot (1-\\alpha) = \\frac{1-\\alpha}{2}$。\n        -   来自$\\Delta Q_2 \\otimes \\Delta Q_1$的权重：$w_2(0) \\cdot w_1(\\frac{1}{2}) = \\frac{\\alpha-1}{2} \\cdot 0 = 0$。\n        -   总权重 $w(0,\\frac{1}{2}) = 0 + \\frac{1-\\alpha}{2} + 0 = \\frac{1-\\alpha}{2}$。\n    -   对于点$(\\frac{1}{2}, 0)$，根据对称性：\n        -   来自$\\Delta Q_1 \\otimes \\Delta Q_1$的权重：$w_1(\\frac{1}{2}) \\cdot w_1(0) = 0 \\cdot \\frac{1}{2} = 0$。\n        -   来自$\\Delta Q_1 \\otimes \\Delta Q_2$的权重：$w_1(\\frac{1}{2}) \\cdot w_2(0) = 0 \\cdot \\frac{\\alpha-1}{2} = 0$。\n        -   来自$\\Delta Q_2 \\otimes \\Delta Q_1$的权重：$w_2(\\frac{1}{2}) \\cdot w_1(0) = (1-\\alpha) \\cdot \\frac{1}{2} = \\frac{1-\\alpha}{2}$。\n        -   总权重 $w(\\frac{1}{2},0) = 0 + 0 + \\frac{1-\\alpha}{2} = \\frac{1-\\alpha}{2}$。\n\n-   **中心节点：** $(\\frac{1}{2}, \\frac{1}{2})$\n    -   坐标$\\frac{1}{2}$不在$\\Delta Q_1$的节点集中，所以$w_1(\\frac{1}{2}) = 0$。\n    -   任何包含$\\Delta Q_1$的张量积项在这一点上的权重都为零。\n    -   来自$\\Delta Q_1 \\otimes \\Delta Q_1$的权重：$w_1(\\frac{1}{2}) \\cdot w_1(\\frac{1}{2}) = 0 \\cdot 0 = 0$。\n    -   来自$\\Delta Q_1 \\otimes \\Delta Q_2$的权重：$w_1(\\frac{1}{2}) \\cdot w_2(\\frac{1}{2}) = 0 \\cdot (1-\\alpha) = 0$。\n    -   来自$\\Delta Q_2 \\otimes \\Delta Q_1$的权重：$w_2(\\frac{1}{2}) \\cdot w_1(\\frac{1}{2}) = (1-\\alpha) \\cdot 0 = 0$。\n    -   总权重 $w(\\frac{1}{2},\\frac{1}{2}) = 0$。这是非负的。\n\n**3. 求解$\\alpha$的最小值：**\n为确保所有权重非负，我们必须对$\\alpha \\in (0,1]$满足以下不等式：\n1.  对角节点：$w(0,0) = \\frac{2\\alpha-1}{4} \\geq 0 \\implies 2\\alpha - 1 \\geq 0 \\implies \\alpha \\geq \\frac{1}{2}$。\n2.  对边中点节点：$w(0,\\frac{1}{2}) = \\frac{1-\\alpha}{2} \\geq 0 \\implies 1-\\alpha \\geq 0 \\implies \\alpha \\leq 1$。\n\n问题陈述$\\alpha \\in (0,1]$，因此第二个条件$\\alpha \\leq 1$已经满足。\n第一个条件要求$\\alpha \\geq \\frac{1}{2}$。\n为同时满足所有条件，$\\alpha$必须在区间$[\\frac{1}{2}, 1]$内。\n此区间内$\\alpha$的最小值为$\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3445937"}]}