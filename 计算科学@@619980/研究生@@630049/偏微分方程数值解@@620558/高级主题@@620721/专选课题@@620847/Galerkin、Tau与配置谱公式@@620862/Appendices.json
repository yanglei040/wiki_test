{"hands_on_practices": [{"introduction": "在信任任何数值求解器之前，我们必须验证其正确性。构造解方法（Method of Manufactured Solutions, MMS）是实现这一目标的一项强大技术，它让我们能够为任何偏微分方程（PDE）创建具有已知精确解的测试问题。通过该练习 [@problem_id:3397996]，您将亲手实践这一过程：为一个椭圆型偏微分方程选择一个平滑解，并反向推导出相应的源项和边界条件，从而为验证谱伽辽金法、tau法或配置法的实现构建一个基准测试。", "problem": "考虑在区间 $[-1,1]$ 上定义的一维、变系数、二阶椭圆算子\n$$\n\\mathcal{L}u(x) \\;=\\; -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)\\,u'(x)\\Big) \\;+\\; c(x)\\,u(x),\n$$\n其光滑正系数为 $a(x)=2+x$，光滑非负系数为 $c(x)=1+x^2$。在人造解方法中，选择一个光滑的目标解\n$$\nu(x) \\;=\\; \\exp(x) \\;+\\; \\sin\\!\\Big(\\frac{\\pi x}{2}\\Big).\n$$\n您的任务是：\n- 推导源项 $f(x)$，使得强形式 $\\mathcal{L}u(x)=f(x)$ 在 $[-1,1]$ 上恒成立。\n- 通过指定 $u(-1)$ 和 $u(1)$ 来推导一致的狄利克雷边界条件。\n- 为了验证使用勒让德多项式的谱伽辽金、tau和配置方法的正确性，请在标准的 $L^2([-1,1])$ 归一化下，计算源项 $f(x)$ 的第一个勒让德系数。具体来说，当 $P_1(x)=x$ 且系数定义为\n$$\n\\widehat{f}_1 \\;=\\; \\frac{2\\cdot 1 + 1}{2}\\int_{-1}^{1} f(x)\\,P_1(x)\\,\\mathrm{d}x \\;=\\; \\frac{3}{2}\\int_{-1}^{1} f(x)\\,x\\,\\mathrm{d}x,\n$$\n时，确定 $\\widehat{f}_1$ 的一个闭式解析表达式。\n\n请从乘法法则和正交性原理开始，给出所有推导过程。请用初等函数和常数以精确形式表示 $\\widehat{f}_1$ 的最终答案（不要进行数值取整）。", "solution": "该问题是有效的，因为它在数学上是适定的，在科学上基于微分方程和数值分析理论，并提供了所有必要的信息来推导出一个没有歧义或矛盾的唯一解。\n\n任务是为人造解推导源项 $f(x)$，确定相应的边界条件，并计算源项的第一个勒让德系数。\n\n### 任务1：推导源项 $f(x)$\n微分算子由下式给出\n$$\n\\mathcal{L}u(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)\\,u'(x)\\Big) + c(x)\\,u(x),\n$$\n系数为 $a(x) = 2+x$ 和 $c(x) = 1+x^2$。人造解为 $u(x) = \\exp(x) + \\sin(\\frac{\\pi x}{2})$。源项 $f(x)$ 由方程 $\\mathcal{L}u(x) = f(x)$ 定义。\n\n首先，我们计算 $u(x)$ 的一阶导数：\n$$\nu'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\exp(x) + \\sin\\left(\\frac{\\pi x}{2}\\right)\\right) = \\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right).\n$$\n接下来，我们构造乘积 $a(x)u'(x)$：\n$$\na(x)u'(x) = (2+x)\\left(\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right)\\right).\n$$\n现在，我们使用乘法法则 $\\frac{\\mathrm{d}}{\\mathrm{d}x}(gh) = g'h + gh'$ 对这个乘积关于 $x$ 求导：\n\\begin{align*}\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)u'(x)\\Big) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(2+x) \\cdot \\left(\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right)\\right) + (2+x) \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right)\\right) \\\\\n= 1 \\cdot \\left(\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right)\\right) + (2+x) \\left(\\exp(x) - \\frac{\\pi^2}{4}\\sin\\left(\\frac{\\pi x}{2}\\right)\\right) \\\\\n= \\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) + (2+x)\\exp(x) - (2+x)\\frac{\\pi^2}{4}\\sin\\left(\\frac{\\pi x}{2}\\right) \\\\\n= (1+2+x)\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) - \\left(\\frac{\\pi^2}{2}+\\frac{\\pi^2 x}{4}\\right)\\sin\\left(\\frac{\\pi x}{2}\\right) \\\\\n= (3+x)\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) - \\frac{\\pi^2}{4}(2+x)\\sin\\left(\\frac{\\pi x}{2}\\right).\n\\end{align*}\n算子的第二部分是 $c(x)u(x)$：\n$$\nc(x)u(x) = (1+x^2)\\left(\\exp(x) + \\sin\\left(\\frac{\\pi x}{2}\\right)\\right) = (1+x^2)\\exp(x) + (1+x^2)\\sin\\left(\\frac{\\pi x}{2}\\right).\n$$\n结合这些结果，得到源项 $f(x)$：\n\\begin{align*}\nf(x) = -\\left((3+x)\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) - \\frac{\\pi^2}{4}(2+x)\\sin\\left(\\frac{\\pi x}{2}\\right)\\right) + (1+x^2)\\exp(x) + (1+x^2)\\sin\\left(\\frac{\\pi x}{2}\\right) \\\\\n= (-3-x+1+x^2)\\exp(x) - \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) + \\left(\\frac{\\pi^2}{4}(2+x) + 1+x^2\\right)\\sin\\left(\\frac{\\pi x}{2}\\right) \\\\\n= (x^2-x-2)\\exp(x) - \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right) + \\left(x^2 + \\frac{\\pi^2}{4}x + 1 + \\frac{\\pi^2}{2}\\right)\\sin\\left(\\frac{\\pi x}{2}\\right).\n\\end{align*}\n\n### 任务2：推导狄利克雷边界条件\n狄利克雷边界条件通过计算人造解 $u(x)$ 在区间 $[-1, 1]$ 端点处的值得到：\n$$\nu(-1) = \\exp(-1) + \\sin\\left(-\\frac{\\pi}{2}\\right) = \\frac{1}{e} - 1.\n$$\n$$\nu(1) = \\exp(1) + \\sin\\left(\\frac{\\pi}{2}\\right) = e + 1.\n$$\n\n### 任务3：计算勒让德系数 $\\widehat{f}_1$\n$f(x)$ 的第一个勒让德系数定义为：\n$$\n\\widehat{f}_1 = \\frac{3}{2}\\int_{-1}^{1} f(x)P_1(x)\\,\\mathrm{d}x = \\frac{3}{2}\\int_{-1}^{1} f(x)x\\,\\mathrm{d}x.\n$$\n由于 $f(x) = \\mathcal{L}u(x)$，我们有：\n$$\n\\int_{-1}^{1} f(x)x\\,\\mathrm{d}x = \\int_{-1}^{1} \\mathcal{L}u(x) \\cdot x\\,\\mathrm{d}x = \\int_{-1}^{1} \\left(-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)u'(x)\\Big) + c(x)u(x)\\right)x\\,\\mathrm{d}x.\n$$\n我们可以对第一项使用分部积分法。设测试函数为 $v(x) = x$。\n$$\n\\int_{-1}^{1} -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big(a(x)u'(x)\\Big) v(x)\\,\\mathrm{d}x = \\left[-a(x)u'(x)v(x)\\right]_{-1}^{1} + \\int_{-1}^{1} a(x)u'(x)v'(x)\\,\\mathrm{d}x.\n$$\n当 $v(x) = x$ 且 $v'(x) = 1$ 时，系数的积分变为：\n$$\n\\int_{-1}^{1} f(x)x\\,\\mathrm{d}x = \\left[-a(x)u'(x)x\\right]_{-1}^{1} + \\int_{-1}^{1} \\left(a(x)u'(x) \\cdot 1 + c(x)u(x)x\\right)\\,\\mathrm{d}x.\n$$\n我们分别计算边界项和积分项。\n\n边界项为：\n\\begin{align*}\n\\left[-a(x)u'(x)x\\right]_{-1}^{1} = -a(1)u'(1)(1) - (-a(-1)u'(-1)(-1)) \\\\\n= -a(1)u'(1) - a(-1)u'(-1).\n\\end{align*}\n我们有 $a(x) = 2+x$，所以 $a(1)=3$ 和 $a(-1)=1$。\n我们有 $u'(x) = \\exp(x) + \\frac{\\pi}{2}\\cos(\\frac{\\pi x}{2})$，所以：\n$u'(1) = \\exp(1) + \\frac{\\pi}{2}\\cos(\\frac{\\pi}{2}) = e$。\n$u'(-1) = \\exp(-1) + \\frac{\\pi}{2}\\cos(-\\frac{\\pi}{2}) = e^{-1}$。\n因此，边界项为 $-3e - 1 \\cdot e^{-1} = -3e - e^{-1}$。\n\n积分项为 $I = \\int_{-1}^{1} \\left(a(x)u'(x) + c(x)u(x)x\\right)\\,\\mathrm{d}x$：\n\\begin{align*}\nI = \\int_{-1}^{1} \\left( (2+x)\\left(\\exp(x) + \\frac{\\pi}{2}\\cos\\left(\\frac{\\pi x}{2}\\right)\\right) + (1+x^2)\\left(\\exp(x) + \\sin\\left(\\frac{\\pi x}{2}\\right)\\right)x \\right) \\,\\mathrm{d}x \\\\\n= \\int_{-1}^{1} \\left( (2+x)\\exp(x) + (x+x^3)\\exp(x) + \\pi\\cos\\left(\\frac{\\pi x}{2}\\right) + \\frac{\\pi}{2}x\\cos\\left(\\frac{\\pi x}{2}\\right) + (x+x^3)\\sin\\left(\\frac{\\pi x}{2}\\right) \\right) \\,\\mathrm{d}x \\\\\n= \\int_{-1}^{1} \\left( (x^3+2x+2)\\exp(x) + \\pi\\cos\\left(\\frac{\\pi x}{2}\\right) + \\frac{\\pi}{2}x\\cos\\left(\\frac{\\pi x}{2}\\right) + (x+x^3)\\sin\\left(\\frac{\\pi x}{2}\\right) \\right) \\,\\mathrm{d}x.\n\\end{align*}\n我们计算在对称区间 $[-1, 1]$ 上各部分的积分：\n1. $\\int_{-1}^{1} (x^3+2x+2)\\exp(x)\\,\\mathrm{d}x$。我们使用公式 $\\int p(x)\\exp(x)dx = [p(x) - p'(x) + p''(x) - \\ldots]\\exp(x)$。\n当 $p(x) = x^3+2x+2$ 时，$p'(x)=3x^2+2$，$p''(x)=6x$，$p'''(x)=6$。\n积分为 $\\left[ (x^3+2x+2) - (3x^2+2) + 6x - 6 \\right]\\exp(x) = [x^3-3x^2+8x-6]\\exp(x)$。\n从 $-1$ 到 $1$ 计算定积分：$[1-3+8-6]e - [-1-3-8-6]e^{-1} = 0 \\cdot e - (-18)e^{-1} = 18e^{-1}$。\n2. $\\int_{-1}^{1} \\pi\\cos\\left(\\frac{\\pi x}{2}\\right)\\,\\mathrm{d}x = \\left[\\pi \\frac{2}{\\pi}\\sin\\left(\\frac{\\pi x}{2}\\right)\\right]_{-1}^{1} = 2(\\sin(\\frac{\\pi}{2}) - \\sin(-\\frac{\\pi}{2})) = 2(1 - (-1)) = 4$。\n3. $\\int_{-1}^{1} \\frac{\\pi}{2}x\\cos\\left(\\frac{\\pi x}{2}\\right)\\,\\mathrm{d}x = 0$，因为被积函数是奇函数。\n4. $\\int_{-1}^{1} (x+x^3)\\sin\\left(\\frac{\\pi x}{2}\\right)\\,\\mathrm{d}x$。被积函数是偶函数。令 $k=\\pi/2$。\n积分为 $2\\int_{0}^{1} (x+x^3)\\sin(kx)\\,\\mathrm{d}x = 2(\\int_{0}^{1} x\\sin(kx)\\,\\mathrm{d}x + \\int_{0}^{1} x^3\\sin(kx)\\,\\mathrm{d}x)$。\n使用分部积分法：\n$\\int_{0}^{1} x\\sin(kx)\\,\\mathrm{d}x = \\left[\\frac{\\sin(kx)}{k^2} - \\frac{x\\cos(kx)}{k}\\right]_{0}^{1} = \\frac{\\sin(k)}{k^2} - \\frac{\\cos(k)}{k} = \\frac{1}{k^2} = \\frac{4}{\\pi^2}$。\n$\\int_{0}^{1} x^3\\sin(kx)\\,\\mathrm{d}x = \\left[\\left(\\frac{3x^2}{k^2}-\\frac{6}{k^4}\\right)\\sin(kx) - \\left(\\frac{x^3}{k}-\\frac{6x}{k^3}\\right)\\cos(kx)\\right]_{0}^{1} = \\left(\\frac{3}{k^2}-\\frac{6}{k^4}\\right)\\sin(k) - \\left(\\frac{1}{k}-\\frac{6}{k^3}\\right)\\cos(k) = \\frac{3}{k^2}-\\frac{6}{k^4} = 3\\left(\\frac{4}{\\pi^2}\\right) - 6\\left(\\frac{16}{\\pi^4}\\right) = \\frac{12}{\\pi^2} - \\frac{96}{\\pi^4}$。\n和为 $2\\left(\\frac{4}{\\pi^2} + \\frac{12}{\\pi^2} - \\frac{96}{\\pi^4}\\right) = 2\\left(\\frac{16}{\\pi^2} - \\frac{96}{\\pi^4}\\right) = \\frac{32}{\\pi^2} - \\frac{192}{\\pi^4}$。\n将所有积分部分相加：$I = 18e^{-1} + 4 + 0 + (\\frac{32}{\\pi^2} - \\frac{192}{\\pi^4})$。\n\n$\\int_{-1}^{1} f(x)x\\,\\mathrm{d}x$ 的总值是边界项和积分项贡献之和：\n$$\n\\int_{-1}^{1} f(x)x\\,\\mathrm{d}x = (-3e - e^{-1}) + (18e^{-1} + 4 + \\frac{32}{\\pi^2} - \\frac{192}{\\pi^4}) = -3e + 17e^{-1} + 4 + \\frac{32}{\\pi^2} - \\frac{192}{\\pi^4}.\n$$\n最后，我们乘以 $\\frac{3}{2}$ 得到 $\\widehat{f}_1$：\n$$\n\\widehat{f}_1 = \\frac{3}{2}\\left(-3e + 17e^{-1} + 4 + \\frac{32}{\\pi^2} - \\frac{192}{\\pi^4}\\right) = -\\frac{9}{2}e + \\frac{51}{2}e^{-1} + 6 + \\frac{48}{\\pi^2} - \\frac{288}{\\pi^4}.\n$$", "answer": "$$\n\\boxed{6 - \\frac{9}{2}\\exp(1) + \\frac{51}{2}\\exp(-1) + \\frac{48}{\\pi^2} - \\frac{288}{\\pi^4}}\n$$", "id": "3397996"}, {"introduction": "谱方法的核心在于用一组有限的正交多项式级数来逼近一个函数，而系数的计算方式是区分不同谱方法的关键。此练习 [@problem_id:3398051] 旨在通过编程实践，让您直观地理解两种主要的系数获取方式——节点插值（配置法的基础）与正交投影（伽辽金法的基础）——之间的本质区别。通过比较这两种方法得到的切比雪夫系数，您将亲自量化和观察由插值引起的“混叠误差”，从而深化对谱逼近理论的理解。", "problem": "设 $[-1,1]$ 为计算域，并设 $\\{x_j\\}_{j=0}^N$ 为 Chebyshev–Gauss–Lobatto 节点，定义为 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$，其中整数 $N \\ge 0$。考虑一个光滑标量函数 $f:[-1,1]\\to\\mathbb{R}$。基于样本点 $f_j = f(x_j)$，构造重心形式的、次数至多为 $N$ 的 Lagrange 插值多项式为\n$$\np_N(x) = \\frac{\\displaystyle\\sum_{j=0}^N \\frac{w_j f_j}{x - x_j}}{\\displaystyle\\sum_{j=0}^N \\frac{w_j}{x - x_j}},\n$$\n其中重心权重 $\\{w_j\\}_{j=0}^N$ 由基本 Lagrange 多项式导出，具体为 $w_j = \\left(\\prod_{m\\ne j}(x_j - x_m)\\right)^{-1}$，并针对 Chebyshev–Gauss–Lobatto 节点的选择进行了特化。第一类 Chebyshev 多项式 $\\{T_k\\}_{k=0}^\\infty$ 定义为 $T_k(\\cos\\theta) = \\cos(k\\theta)$，适用于所有实数 $\\theta$（角度以弧度为单位）。对于任意次数至多为 $N$ 的多项式 $q_N(x)$，我们可将其在 Chebyshev 基中展开为\n$$\nq_N(x) = \\sum_{k=0}^N a_k T_k(x),\n$$\n其系数 $\\{a_k\\}_{k=0}^N$ 是唯一的。\n\n定义与 Chebyshev 多项式相关的加权内积为\n$$\n\\langle u, v \\rangle = \\int_{-1}^1 \\frac{u(x)\\, v(x)}{\\sqrt{1-x^2}}\\, dx,\n$$\n由此可得正交性\n$$\n\\int_{-1}^1 \\frac{T_m(x)\\, T_n(x)}{\\sqrt{1-x^2}}\\, dx = \n\\begin{cases}\n\\pi,  & n=m=0,\\\\\n\\frac{\\pi}{2}, & n=m\\ge 1,\\\\\n0,  & n\\ne m.\n\\end{cases}\n$$\n$f$ 在 $\\text{span}\\{T_0,\\dots,T_N\\}$ 上的正交投影具有系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$，满足\n$$\na_0^{(\\mathrm{proj})} = \\frac{1}{\\pi}\\int_{-1}^1 \\frac{f(x)}{\\sqrt{1-x^2}}\\, dx,\\qquad\na_k^{(\\mathrm{proj})} = \\frac{2}{\\pi}\\int_{-1}^1 \\frac{f(x)\\, T_k(x)}{\\sqrt{1-x^2}}\\, dx,\\quad k\\ge 1.\n$$\n\n任务：对以下每个测试用例，执行以下操作。\n- 使用 Chebyshev–Gauss–Lobatto 样本点 $\\{f_j\\}_{j=0}^N$ 构造重心插值多项式 $p_N(x)$。然后，通过求解在 Chebyshev–Gauss–Lobatto 节点上对 Chebyshev 基求值得到的方阵线性系统，并利用恒等式 $T_k(x_j)=\\cos\\!\\left(\\frac{\\pi k j}{N}\\right)$，计算 $p_N(x)$ 的 Chebyshev 系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$。\n- 使用 $M$ 点 Gauss–Chebyshev 法则，对权重 $1/\\sqrt{1-x^2}$ 进行高精度数值积分，从而计算正交投影系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$。其中节点为 $x_j^{(\\mathrm{GC})}=\\cos\\!\\left(\\frac{(2j-1)\\pi}{2M}\\right)$（$j=1,\\dots,M$），权重均为 $\\omega_j=\\frac{\\pi}{M}$，得到\n$$\na_0^{(\\mathrm{proj})} \\approx \\frac{1}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\qquad\na_k^{(\\mathrm{proj})} \\approx \\frac{2}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right)\\, \\cos\\!\\left(k\\, \\frac{(2j-1)\\pi}{2M}\\right),\\quad k\\ge 1.\n$$\n- 报告最大绝对系数差异\n$$\nE_\\infty = \\max_{0\\le k\\le N}\\left|a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}\\right|.\n$$\n\n您的程序应为以下测试套件实现上述操作（角度以弧度为单位）：\n- 测试 1：$f(x) = \\sin(\\pi x)$，其中 $N=32$。\n- 测试 2：$f(x) = T_{10}(x) = \\cos\\!\\left(10\\, \\arccos x\\right)$，其中 $N=10$。\n- 测试 3：$f(x) = x$，其中 $N=1$。\n- 测试 4：$f(x) = e^{3x}$，其中 $N=48$。\n\n覆盖性设计：\n- 测试 1 是一个光滑、非多项式的“顺利路径”用例。\n- 测试 2 是一个精确多项式边缘用例，当 $N\\ge 10$ 时，插值和投影必须匹配。\n- 测试 3 是一个最小次数边界用例。\n- 测试 4 是一个高度光滑的解析用例，其高阶系数快速衰减但非零。\n\n答案规格：\n- 对每个测试用例，计算 $E_\\infty$ 作为一个实数（浮点数）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[r_1,r_2,r_3,r_4]”），其中每个 $r_i$ 是对应于测试 $i$ 的 $E_\\infty$。", "solution": "该问题定义明确、科学上可靠且前后一致。它提出了一个标准的数值分析任务，涉及比较通过两种不同方法（插值和投影）获得的 Chebyshev 系数。所有数学公式和概念在谱方法领域都是标准的。因此，该问题被认为是 **有效的**。\n\n该解决方案通过为每个测试用例实现问题陈述中描述的计算步骤来进行。任务的核心是计算两组 Chebyshev 系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$ 和 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$，然后找出它们之间的最大绝对差。\n\n### 步骤 1：计算插值系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$\n\n系数 $\\{a_k^{(\\mathrm{interp})}\\}_{k=0}^N$ 用于多项式 $p_N(x) = \\sum_{k=0}^N a_k^{(\\mathrm{interp})} T_k(x)$，该多项式在 $N+1$ 个 Chebyshev–Gauss–Lobatto (CGL) 节点 $\\{x_j\\}_{j=0}^N$ 上对函数 $f(x)$ 进行插值。插值条件为 $p_N(x_j) = f(x_j)$，其中 $j=0, \\dots, N$。代入 $p_N(x)$ 的 Chebyshev 展开式并使用恒等式 $T_k(x_j) = \\cos\\left(\\frac{\\pi kj}{N}\\right)$，我们得到线性系统：\n$$\nf(x_j) = \\sum_{k=0}^N a_k^{(\\mathrm{interp})} \\cos\\left(\\frac{\\pi kj}{N}\\right), \\quad j=0, \\dots, N.\n$$\n这是第一类离散余弦变换 (DCT-I) 的一种表述。问题要求解此系统以获得系数 $a_k^{(\\mathrm{interp})}$。我们可以不显式地构造和求逆矩阵，而是使用著名的逆 DCT-I 公式，直接给出系数：\n$$\na_k^{(\\mathrm{interp})} = \\frac{2}{N \\bar{c}_k} \\sum_{j=0}^{N} \\frac{f(x_j)}{\\bar{c}_j} \\cos\\left(\\frac{\\pi jk}{N}\\right), \\quad k=0, \\dots, N.\n$$\n这里，$\\bar{c}_k$ 是定义的权重，$\\bar{c}_0 = \\bar{c}_N = 2$，对于 $1 \\le k \\le N-1$ 则 $\\bar{c}_k = 1$。相同的定义也适用于 $\\bar{c}_j$。此公式被用来计算 $\\{a_k^{(\\mathrm{interp})}\\}$。\n\n### 步骤 2：计算投影系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$\n\n系数 $\\{a_k^{(\\mathrm{proj})}\\}_{k=0}^N$ 对应于函数 $f(x)$ 在 Chebyshev 多项式基 $\\{T_k(x)\\}_{k=0}^N$ 上的正交投影。它们是 $f(x)$ 的“真实”Chebyshev 系数，由以下积分定义：\n$$\na_0^{(\\mathrm{proj})} = \\frac{1}{\\pi}\\int_{-1}^1 \\frac{f(x)}{\\sqrt{1-x^2}}\\, dx, \\qquad\na_k^{(\\mathrm{proj})} = \\frac{2}{\\pi}\\int_{-1}^1 \\frac{f(x)\\, T_k(x)}{\\sqrt{1-x^2}}\\, dx,\\quad k\\ge 1.\n$$\n按照规定，这些积分使用高精度的 $M$ 点第一类 Gauss-Chebyshev 求积法则进行近似。该近似的公式如下：\n$$\na_0^{(\\mathrm{proj})} \\approx \\frac{1}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\qquad\na_k^{(\\mathrm{proj})} \\approx \\frac{2}{M}\\sum_{j=1}^M f\\!\\left(x_j^{(\\mathrm{GC})}\\right)\\, T_k\\!\\left(x_j^{(\\mathrm{GC})}\\right),\\quad k\\ge 1,\n$$\n其中 $x_j^{(\\mathrm{GC})}=\\cos\\left(\\frac{(2j-1)\\pi}{2M}\\right)$ 是 Gauss-Chebyshev 节点。为确保“高精度”，求积点数 $M$ 的选择要远大于任何测试用例中的 $N$。这里使用 $M=2048$，这使得求积误差与所测量的差异相比可以忽略不计。\n\n### 步骤 3：计算最大绝对差异 $E_\\infty$\n\n差异 $E_\\infty$ 是对混叠误差的度量，该误差的产生是由于插值多项式的系数包含了原始函数高阶模式的贡献。它被计算为两个系数向量之差的无穷范数：\n$$\nE_\\infty = \\max_{0\\le k\\le N}\\left|a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}\\right|.\n$$\n\n### 测试用例分析\n\n- **测试 1 ($f(x) = \\sin(\\pi x), N=32$) 和测试 4 ($f(x) = e^{3x}, N=48$)：** 对于这些光滑、解析、非多项式的函数，当 $k \\to \\infty$ 时，真实的 Chebyshev 系数 $a_k^{(\\mathrm{proj})}$ 会快速衰减。差异 $a_k^{(\\mathrm{interp})} - a_k^{(\\mathrm{proj})}$ 是由混叠引起的，即高频系数（例如 $a_{2N \\pm k}^{(\\mathrm{proj})}$）被折叠到低频系数上。预计会有一个虽小但非零的误差 $E_\\infty$。\n- **测试 2 ($f(x) = T_{10}(x), N=10$) 和测试 3 ($f(x) = x = T_1(x), N=1$)：** 在这些情况下，函数 $f(x)$ 是一个 $D$ 次多项式，而我们使用的插值次数 $N \\ge D$。一个 $D$ 次多项式的 Lagrange 插值多项式就是该多项式本身。因此，$p_N(x) = f(x)$，它们的 Chebyshev 系数必须相同：$a_k^{(\\mathrm{interp})} = a_k^{(\\mathrm{proj})}$。对于足够低次数的多项式被积函数，Gauss-Chebyshev 求积是精确的，这里选择的 $M$ 满足此条件。因此，对于这些情况，预计 $E_\\infty$ 为零，或者是一个与机器浮点精度相当的非常小的数。\n\n实现过程对每个提供的测试用例都遵循了这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    # Define test case functions\n    def f_test1(x):\n        \"\"\"Test 1: f(x) = sin(pi*x)\"\"\"\n        return np.sin(np.pi * x)\n\n    def f_test2(x):\n        \"\"\"Test 2: f(x) = T_10(x)\"\"\"\n        # Clip input to arccos's domain to handle potential floating point errors at endpoints\n        x_safe = np.clip(x, -1.0, 1.0)\n        return np.cos(10 * np.arccos(x_safe))\n\n    def f_test3(x):\n        \"\"\"Test 3: f(x) = x, which is T_1(x)\"\"\"\n        return x\n\n    def f_test4(x):\n        \"\"\"Test 4: f(x) = exp(3x)\"\"\"\n        return np.exp(3 * x)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (f_test1, 32),\n        (f_test2, 10),\n        (f_test3, 1),\n        (f_test4, 48),\n    ]\n\n    # Number of quadrature points for projection. Chosen to be large for high accuracy.\n    M_QUADRATURE = 2048\n\n    def compute_interp_coeffs(f, N):\n        \"\"\"\n        Computes the Chebyshev coefficients a_k^{(interp)} of the polynomial\n        interpolant of f at the N+1 Chebyshev-Gauss-Lobatto nodes.\n        This is done by solving the linear system p_N(x_j) = f(x_j) using\n        the inverse Discrete Cosine Transform of Type I (DCT-I).\n        \"\"\"\n        if N == 0:\n            return np.array([f(1.0)])\n        \n        j = np.arange(N + 1)\n        x_cgl = np.cos(np.pi * j / N)\n        f_vals = f(x_cgl)\n        \n        c_bar_j = np.ones(N + 1)\n        c_bar_j[0] = c_bar_j[N] = 2.0\n        f_vals_weighted = f_vals / c_bar_j\n        \n        a_interp = np.zeros(N + 1)\n        for k in range(N + 1):\n            cos_transform = np.cos(np.pi * j * k / N)\n            summation = np.sum(f_vals_weighted * cos_transform)\n            \n            c_bar_k = 2.0 if k == 0 or k == N else 1.0\n            a_interp[k] = (2.0 / N) * summation / c_bar_k\n            \n        return a_interp\n\n    def compute_proj_coeffs(f, N, M):\n        \"\"\"\n        Computes the Chebyshev coefficients a_k^{(proj)} of the orthogonal\n        projection of f. The integrals are approximated using an M-point\n        Gauss-Chebyshev quadrature rule.\n        \"\"\"\n        j_gc = np.arange(1, M + 1)\n        theta_gc = (2 * j_gc - 1) * np.pi / (2 * M)\n        x_gc = np.cos(theta_gc)\n        f_vals_gc = f(x_gc)\n        \n        a_proj = np.zeros(N + 1)\n        \n        # k = 0 case\n        a_proj[0] = np.mean(f_vals_gc)\n        \n        # k >= 1 cases\n        for k in range(1, N + 1):\n            cos_transform = np.cos(k * theta_gc)\n            a_proj[k] = (2.0 / M) * np.sum(f_vals_gc * cos_transform)\n            \n        return a_proj\n\n    results = []\n    for f, N in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        a_interp = compute_interp_coeffs(f, N)\n        a_proj = compute_proj_coeffs(f, N, M_QUADRATURE)\n        \n        e_inf = np.max(np.abs(a_interp - a_proj))\n        results.append(e_inf)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3398051"}, {"introduction": "谱tau方法通过用边界条件方程替换掉一部分弱形式的模态方程来施加边界约束，但选择替换哪些方程至关重要。这个练习 [@problem_id:3397978] 通过一个典型的反例，揭示了错误放置约束的严重后果。您将分析一个不正确的tau方法实现，并证明它如何导致系统丢失微分算子的关键信息，最终产生伪特征值，从而深刻理解标准tau方法设计的精妙之处和内在逻辑。", "problem": "考虑区间 $[-1,1]$ 上的 Sturm–Liouville 特征值问题：\n$$-u''(x) = \\lambda\\, u(x), \\quad u(-1)=0, \\quad u(1)=0,$$\n该问题将使用 Chebyshev 谱 τ 方法进行近似，使用前 $N+1$ 个 Chebyshev 多项式 $\\{T_k(x)\\}_{k=0}^{N}$，其中在 $[-1,1]$ 上，$T_k(x) = \\cos(k \\arccos x)$。设 $N=3$，因此近似空间由 $\\{T_0, T_1, T_2, T_3\\}$ 张成，并设近似解为\n$$u_3(x) = \\sum_{k=0}^{3} a_k\\, T_k(x)。$$\n\n根据谱 τ 方法的定义，我们构建残差\n$$R(x) = -u_3''(x) - \\lambda\\, u_3(x),$$\n并强制要求 $R(x)$ 与一组选定的测试模态（在 Chebyshev 模态意义上）正交，同时通过用边界方程替换两个模态方程来施加两个边界条件。对于二阶问题，数学上标准的 τ 配置方法是对最低的两个模态 $T_0$ 和 $T_1$ 强制正交，并用边界条件替换 $T_2$ 和 $T_3$ 的方程。与此相反，考虑一种不正确的 τ 配置方法，它用边界条件替换 $\\{T_0, T_1\\}$ 的方程，并仅对最高的两个模态 $\\{T_2, T_3\\}$ 强制 $R(x)$ 的正交性。\n\n从上述定义和恒等式 $T_0(x)=1$, $T_1(x)=x$, $T_2(x)=2x^2-1$, $T_3(x)=4x^3-3x$，以及端点值 $T_k(1)=1$ 和 $T_k(-1)=(-1)^k$ 出发，推导由这种不正确的 τ 配置产生的代数系统，并证明它恰好移除了携带微分算子作用的模态方程，从而对系统过度约束，以至于对于任何 $\\lambda \\neq 0$，它要么只允许平凡解，要么只对一个伪特征值允许非平凡解。\n\n您的最终答案应该是这个不正确配置的 τ 系统所允许的伪特征值。请将此值以实数形式提供。无需四舍五入。", "solution": "用户要求我分析 Chebyshev 谱 τ 方法在给定 Sturm-Liouville 问题上的一个不正确应用，并找出由此产生的伪特征值。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **微分方程：** $-u''(x) = \\lambda\\, u(x)$，在区间 $[-1,1]$ 上。\n- **边界条件：** $u(-1)=0$ 和 $u(1)=0$。\n- **近似空间：** 由前 $N+1=4$ 个 Chebyshev 多项式 $\\{T_0(x), T_1(x), T_2(x), T_3(x)\\}$ 张成的空间。\n- **近似解：** $u_3(x) = \\sum_{k=0}^{3} a_k\\, T_k(x)$。\n- **残差：** $R(x) = -u_3''(x) - \\lambda\\, u_3(x)$。\n- **不正确的 τ 配置：**\n  1. 对应于 $T_0$ 和 $T_1$ 的模态方程被两个边界条件替换。\n  2. 残差 $R(x)$ 被要求与测试模态 $T_2$ 和 $T_3$ 正交。\n- **给定的恒等式：**\n  - $T_0(x)=1$, $T_1(x)=x$, $T_2(x)=2x^2-1$, $T_3(x)=4x^3-3x$。\n  - $T_k(1)=1$ 和 $T_k(-1)=(-1)^k$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**是。该问题是偏微分方程数值分析中一个明确定义的练习，特别关注谱方法的实现细节和潜在陷阱。Sturm-Liouville 问题和 Chebyshev 多项式是标准的数学工具。\n- **适定性：**是。该过程尽管从实践角度被描述为“不正确”，但其定义是明确的。任务是遵循此过程并推导一个特定量（伪特征值），这是一个可解的数学问题。\n- **客观性：**是。该问题使用精确的数学语言，没有主观或含糊的陈述。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n### 详细解法\n\n问题的核心是推导由指定的不正确 τ 方法产生的代数系统。设近似解为 $u_3(x) = \\sum_{k=0}^{3} a_k T_k(x)$。\n\n第一步是在 Chebyshev 基中表示二阶导数 $u_3''(x)$。对于 Chebyshev 级数 $u(x) = \\sum_{k=0}^{N} a_k T_k(x)$ 的二阶导数系数，一个标准结果是 $u''(x) = \\sum_{k=0}^{N-2} c_k^{(2)} T_k(x)$，其中系数 $c_k^{(2)}$ 由以下公式给出：\n$$c_k^{(2)} = \\frac{1}{\\bar{c}_k} \\sum_{p=k+2, \\, p+k \\text{ even}}^{N} p(p^2 - k^2) a_p$$\n其中 $\\bar{c}_0=2$ 且对于 $k>0$ 有 $\\bar{c}_k=1$。\n\n在我们的情况下，$N=3$，因此二阶导数是一个次数最多为 1 的多项式，这意味着它是 $T_0(x)$ 和 $T_1(x)$ 的线性组合。\n$$u_3''(x) = c_0^{(2)} T_0(x) + c_1^{(2)} T_1(x)$$\n我们来计算系数 $c_0^{(2)}$ 和 $c_1^{(2)}$。\n\n对于 $k=0$：\n$$c_0^{(2)} = \\frac{1}{2} \\sum_{p=2, \\, p \\text{ even}}^{3} p(p^2 - 0^2) a_p = \\frac{1}{2} \\left[ 2(2^2 - 0^2) a_2 \\right] = \\frac{1}{2}(8a_2) = 4a_2$$\n\n对于 $k=1$：\n$$c_1^{(2)} = \\frac{1}{1} \\sum_{p=3, \\, p \\text{ odd}}^{3} p(p^2 - 1^2) a_p = 3(3^2 - 1^2) a_3 = 3(8)a_3 = 24a_3$$\n\n因此，二阶导数是：\n$$u_3''(x) = 4a_2 T_0(x) + 24a_3 T_1(x)$$\n\n现在，我们构建残差 $R(x) = -u_3''(x) - \\lambda u_3(x)$：\n$$R(x) = -(4a_2 T_0(x) + 24a_3 T_1(x)) - \\lambda \\sum_{k=0}^{3} a_k T_k(x)$$\n按基函数 $T_k(x)$ 对各项进行分组：\n$$R(x) = (-4a_2 - \\lambda a_0) T_0(x) + (-24a_3 - \\lambda a_1) T_1(x) - \\lambda a_2 T_2(x) - \\lambda a_3 T_3(x)$$\n谱方法要求将残差在测试基中的系数设为零。“不正确”的方案强制对 $T_2$ 和 $T_3$ 正交。这意味着在 $R(x)$ 的展开式中，$T_2(x)$ 和 $T_3(x)$ 的系数必须为零。\n1. 与 $T_2(x)$ 正交：$-\\lambda a_2 = 0$\n2. 与 $T_3(x)$ 正交：$-\\lambda a_3 = 0$\n\n这两个方程替换了 $T_0$ 和 $T_1$ 的模态方程。边界条件被用来构成余下的两个方程。\n3. 边界条件 $u_3(1)=0$：\n$$u_3(1) = \\sum_{k=0}^{3} a_k T_k(1) = \\sum_{k=0}^{3} a_k (1) = a_0 + a_1 + a_2 + a_3 = 0$$\n4. 边界条件 $u_3(-1)=0$：\n$$u_3(-1) = \\sum_{k=0}^{3} a_k T_k(-1) = \\sum_{k=0}^{3} a_k (-1)^k = a_0 - a_1 + a_2 - a_3 = 0$$\n\n这给出了一个关于系数 $(a_0, a_1, a_2, a_3)$ 的四元齐次线性方程组：\n$$\\begin{cases}\n    a_0 + a_1 + a_2 + a_3 = 0 \\\\\n    a_0 - a_1 + a_2 - a_3 = 0 \\\\\n    -\\lambda a_2 = 0 \\\\\n    -\\lambda a_3 = 0\n\\end{cases}$$\n\n如问题所述，此方法的缺陷现在显而易见。微分算子 $-d^2/dx^2$ 对高阶模态（$T_2, T_3$）的作用完全由残差中低阶模态（$T_0, T_1$）的系数捕获，即 $-4a_2$ 和 $-24a_3$ 项。通过用边界条件替换 $T_0$ 和 $T_1$ 的模态方程，算子的“刚度矩阵”贡献被丢弃了。余下的正交条件 $-\\lambda a_2=0$ 和 $-\\lambda a_3=0$ 只包含算子的“质量矩阵”部分，从而使系统完全解耦，并破坏了特征值问题的结构。\n\n我们寻求系数向量 $\\mathbf{a} = (a_0, a_1, a_2, a_3)^T$ 的非平凡解。这样的解存在的充要条件是系统矩阵的行列式为零。该系统可以写成 $M(\\lambda) \\mathbf{a} = \\mathbf{0}$，其中：\n$$M(\\lambda) = \\begin{pmatrix}\n1  & 1  & 1  & 1 \\\\\n1  & -1 & 1  & -1 \\\\\n0  & 0  & -\\lambda & 0 \\\\\n0  & 0  & 0  & -\\lambda\n\\end{pmatrix}$$\n\n我们计算该矩阵的行列式：\n$$\\det(M(\\lambda)) = (1) \\det \\begin{pmatrix} -1 & 1 & -1 \\\\ 0 & -\\lambda & 0 \\\\ 0 & 0 & -\\lambda \\end{pmatrix} - (1) \\det \\begin{pmatrix} 1 & 1 & -1 \\\\ 0 & -\\lambda & 0 \\\\ 0 & 0 & -\\lambda \\end{pmatrix}$$\n这比需要的计算要复杂。沿第四行进行余子式展开要简单得多：\n$$\\det(M(\\lambda)) = (-\\lambda) \\det \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & -1 & 1 \\\\ 0 & 0 & -\\lambda \\end{pmatrix}$$\n现在，沿第三行展开这个 $3 \\times 3$ 行列式：\n$$\\det(M(\\lambda)) = (-\\lambda) \\left( (-\\lambda) \\det \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right)$$\n$$\\det(M(\\lambda)) = \\lambda^2 \\left( (1)(-1) - (1)(1) \\right) = \\lambda^2(-2) = -2\\lambda^2$$\n为了存在非平凡解，必须有 $\\det(M(\\lambda))=0$。\n$$-2\\lambda^2 = 0 \\implies \\lambda = 0$$\n因此，这个不正确构建的系统允许非平凡解的唯一特征值是 $\\lambda=0$。对于任何 $\\lambda \\neq 0$，该系统强制 $a_2=0$ 和 $a_3=0$，这又强制 $a_0=0$ 和 $a_1=0$，导致平凡解 $u_3(x)=0$。\n\n此 Sturm-Liouville 问题的真实特征值为 $\\lambda_n = (n\\pi/2)^2$，其中整数 $n \\ge 1$（例如，$\\lambda_1 = \\pi^2/4 \\approx 2.467$）。这些特征值都是严格为正的。因此，由这个有缺陷的数值方案产生的 $\\lambda=0$ 是一个伪特征值。", "answer": "$$\\boxed{0}$$", "id": "3397978"}]}