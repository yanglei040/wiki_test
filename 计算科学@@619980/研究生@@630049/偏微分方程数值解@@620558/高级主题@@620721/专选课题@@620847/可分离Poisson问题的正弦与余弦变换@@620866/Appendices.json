{"hands_on_practices": [{"introduction": "变换方法在求解泊松方程中的威力源于离散拉普拉斯算子的特殊结构。第一个练习将引导你从第一性原理出发，推导一维算子的特征值 [@problem_id:3443413]。通过验证离散正弦函数确实是其特征向量，你将对离散正弦变换（DST）为何能如此有效地对角化该问题获得基础性的理解。", "problem": "考虑区间 $[0,1]$ 上的一个均匀剖分，其包含 $n+2$ 个点 $x_j=jh$，其中 $j=0,1,\\dots,n+1$ 且 $h=1/(n+1)$。施加齐次狄利克雷边界条件 $u_0=0$ 和 $u_{n+1}=0$，并考虑作用于内部未知量 $\\mathbf{u}=(u_1,\\dots,u_n)^{\\top}$ 的离散负拉普拉斯（二阶差分）算子 $A$：\n$$(A\\mathbf{u})_j=\\frac{-u_{j-1}+2u_j-u_{j+1}}{h^2},\\quad j=1,\\dots,n,$$\n其中边界值 $u_0$ 和 $u_{n+1}$ 固定为零。从线性算子的特征值和特征向量的定义出发，并仅使用线性性、三角恒等式以及满足齐次狄利克雷条件的可分离模式的特征等基本事实，确定由 $k\\in\\{1,2,\\dots,n\\}$ 索引的 $A$ 的特征值 $\\lambda_k$ 的闭式表达式。将你的推导与离散正弦变换（DST）在对角化 $A$ 中的作用联系起来，但不要假定任何预先制定的变换对。\n\n请用一个包含 $h$、$n$ 和 $k$ 的单一解析表达式给出 $\\lambda_k$ 的最终答案。不需要数值近似，也不涉及单位。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第一步：提取已知条件\n- 域剖分：区间 $[0, 1]$ 被 $n+2$ 个点 $x_j=jh$ 剖分，其中 $j=0, 1, \\dots, n+1$。\n- 步长：$h=1/(n+1)$。\n- 边界条件：齐次狄利克雷条件 $u_0=0$ 和 $u_{n+1}=0$。\n- 未知数：内部值的向量 $\\mathbf{u}=(u_1, u_2, \\dots, u_n)^{\\top}$。\n- 算子：离散负拉普拉斯（二阶差分）算子 $A$ 通过其对 $\\mathbf{u}$ 的作用定义为\n$$(A\\mathbf{u})_j = \\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2}, \\quad \\text{其中 } j=1, 2, \\dots, n。$$\n- 任务：确定 $A$ 的特征值 $\\lambda_k$ 的闭式表达式，其中 $k \\in \\{1, 2, \\dots, n\\}$。\n- 方法论约束：推导必须从特征值和特征向量的定义出发，仅使用基本原理。结果应与离散正弦变换（DST）相关联，但不假定其属性。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题是数值分析中的一个基本课题，特别是在求解偏微分方程的有限差分法中。离散拉普拉斯算子是一个标准的、经过深入研究的数学对象。该问题具有科学合理性。\n- **适定性**：该问题要求解一个特定的 $n \\times n$ 矩阵的特征值。一个 $n \\times n$ 矩阵总有一组 $n$ 个特征值（计算重数），因此解存在且唯一。该问题是适定的。\n- **客观性**：该问题以精确、形式化的数学语言陈述，没有主观性或歧义。\n\n问题陈述是自洽的、一致的，并遵循既定的科学和数学原理。它不违反任何无效性标准。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n线性算子 $A$ 的特征值 $\\lambda$ 和相应的特征向量 $\\mathbf{v} \\neq \\mathbf{0}$ 由方程 $A\\mathbf{v} = \\lambda\\mathbf{v}$ 定义。对于给定的离散负拉普拉斯算子 $A$，该方程可以对一个特征向量 $\\mathbf{v} = (v_1, v_2, \\dots, v_n)^{\\top}$ 按分量写出：\n$$ (A\\mathbf{v})_j = \\frac{-v_{j-1} + 2v_j - v_{j+1}}{h^2} = \\lambda v_j, \\quad \\text{其中 } j=1, 2, \\dots, n。$$\n算子的定义使用了边界值 $v_0$ 和 $v_{n+1}$，它们与原始变量 $u$ 一样，必须满足齐次狄利克雷条件 $v_0 = 0$ 和 $v_{n+1} = 0$。\n\n问题提示我们考虑满足这些边界条件的可分离模式。其连续模拟是 $[0,1]$ 上的施图姆-刘维尔问题 $-u''(x) = \\lambda u(x)$，且 $u(0)=u(1)=0$，其特征函数形式为 $\\sin(k\\pi x)$。这启发我们为特征向量 $\\mathbf{v}$ 的分量提出一个离散模拟：\n$$ v_j = C \\sin(\\alpha x_j) = C \\sin(\\alpha j h) $$\n其中 $C$ 和 $\\alpha$ 为某常数。由于特征向量的定义允许一个标量倍数，我们可以设置 $C=1$。\n\n我们必须首先确保此形式满足边界条件：\n1.  对于 $j=0$：$v_0 = \\sin(\\alpha \\cdot 0 \\cdot h) = \\sin(0) = 0$。此条件自动满足。\n2.  对于 $j=n+1$：$v_{n+1} = \\sin(\\alpha(n+1)h) = 0$。给定 $h=1/(n+1)$，这变为 $\\sin(\\alpha(n+1)\\frac{1}{n+1}) = \\sin(\\alpha) = 0$。\n\n条件 $\\sin(\\alpha)=0$ 意味着 $\\alpha$ 必须是 $\\pi$ 的整数倍。设 $\\alpha = k\\pi$，其中 $k$ 为某个整数。因此，所提出的特征向量分量为：\n$$ v_j^{(k)} = \\sin(k\\pi j h) $$\n我们需要找到 $n$ 个线性无关的特征向量。让我们研究整数 $k$ 的选择：\n- 如果 $k=0$，$v_j^{(0)} = \\sin(0) = 0$ 对所有 $j$ 成立，这是平凡的零向量，不是特征向量。\n- 对于 $k \\in \\{1, 2, \\dots, n\\}$，向量 $\\mathbf{v}^{(k)}$ 是非平凡的，并且已知是线性无关的。\n- 如果 $k=n+1$，$v_j^{(n+1)} = \\sin((n+1)\\pi j h) = \\sin(\\pi j (n+1)/(n+1)) = \\sin(j\\pi) = 0$ 对所有整数 $j$ 成立。这同样是零向量。\n- 对于 $k$ 的其他整数值，这些向量会变得冗余（例如，$\\mathbf{v}^{(k)} = -\\mathbf{v}^{(-k)}$ 和 $\\mathbf{v}^{(k)} = (-1)^{m} \\mathbf{v}^{(k+m(n+1))}$）。\n\n因此，通过选择 $k=1, 2, \\dots, n$，我们可以生成所有 $n$ 个不同的特征向量。现在，我们将第 $k$ 个特征向量的形式 $v_j = \\sin(k\\pi jh)$ 代入特征值方程。设 $\\lambda_k$ 为对应于特征向量 $\\mathbf{v}^{(k)}$ 的特征值。\n$$ \\frac{-\\sin(k\\pi(j-1)h) + 2\\sin(k\\pi jh) - \\sin(k\\pi(j+1)h)}{h^2} = \\lambda_k \\sin(k\\pi jh) $$\n让我们关注分子。使用和差化积恒等式 $\\sin(A-B) + \\sin(A+B) = 2\\sin(A)\\cos(B)$，我们可以简化 $\\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h)$ 这一项。设 $A = k\\pi jh$ 和 $B = k\\pi h$。\n$$ \\sin(k\\pi jh - k\\pi h) + \\sin(k\\pi jh + k\\pi h) = 2\\sin(k\\pi jh)\\cos(k\\pi h) $$\n特征值方程左侧的分子变为：\n$$ 2\\sin(k\\pi jh) - \\big( \\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h) \\big) = 2\\sin(k\\pi jh) - 2\\sin(k\\pi jh)\\cos(k\\pi h) $$\n$$ = 2\\sin(k\\pi jh) \\big( 1 - \\cos(k\\pi h) \\big) $$\n将此代回特征值方程：\n$$ \\frac{2\\sin(k\\pi jh) (1 - \\cos(k\\pi h))}{h^2} = \\lambda_k \\sin(k\\pi jh) $$\n由于 $\\mathbf{v}^{(k)}$ 是一个非零向量，我们可以找到一个 $j$ 使得 $\\sin(k\\pi jh) \\neq 0$。因此，我们可以将方程两边同时除以 $\\sin(k\\pi jh)$ 来求解特征值 $\\lambda_k$：\n$$ \\lambda_k = \\frac{2(1 - \\cos(k\\pi h))}{h^2} $$\n为了得到一个更常见的形式，我们使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$。当 $\\theta = k\\pi h$ 时，可得：\n$$ \\lambda_k = \\frac{2(2\\sin^2(k\\pi h/2))}{h^2} = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right) $$\n问题要求用 $h$、$n$ 和 $k$ 表示该表达式。我们可以使用定义 $h=1/(n+1)$ 将正弦函数的参数用 $n$ 来表示。\n$$ \\lambda_k = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right) $$\n该表达式对每个 $k = 1, 2, \\dots, n$ 都有效。\n\n最后，我们将此结果与离散正弦变换（DST）联系起来。第 $k$ 个特征向量的分量是 $v_j^{(k)} = \\sin(k \\pi j h) = \\sin\\left(\\frac{k j \\pi}{n+1}\\right)$。矩阵 $S$ 的 $(j,k)$ 项与此值成正比，即 $S_{jk} = \\sqrt{\\frac{2}{n+1}}\\sin\\left(\\frac{kj\\pi}{n+1}\\right)$，是离散正弦变换（具体来说是 DST-I）的矩阵。该矩阵 $S$ 的列是离散拉普拉斯矩阵 $A$ 的标准正交化特征向量。这样一个特征基的存在意味着矩阵 $A$ 可被 DST 矩阵 $S$ 对角化。也就是说，$S^{-1}AS = \\Lambda$ 或 $S^{\\top}AS = \\Lambda$，其中 $\\Lambda$ 是一个对角矩阵，其对角线元素为特征值 $\\lambda_k$。这就是为什么基于变换的方法在求解涉及均匀网格上离散拉普拉斯算子的线性系统时效率极高的根本原因。该变换将方程组解耦为变换域中的 $n$ 个独立的标量方程，这些方程可以轻易求解。", "answer": "$$\n\\boxed{\\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right)}\n$$", "id": "3443413"}, {"introduction": "在确立了正弦变换能够对角化离散拉普拉斯算子之后，一个关键问题随之而来：得到的数值解有多精确？本练习将引导你进行详细的误差分析，将离散解与其连续对应物联系起来 [@problem_id:3443469]。通过逐模式地剖析误差并计算主误差常数，你将对离散化误差的概念以及支配方法收敛性的因素有更深刻的理解。", "problem": "考虑单位区间上具有齐次狄利克雷边界条件的一维泊松边值问题：求函数 $u:[0,1]\\to\\mathbb{R}$ 使得\n$$\n-u''(x)=f(x),\\quad x\\in(0,1),\\qquad u(0)=u(1)=0,\n$$\n其中 $f\\in C^{\\infty}([0,1])$。令 $N\\in\\mathbb{N}$，$h=1/N$，且对 $j=0,1,\\dots,N$，有 $x_j=jh$。令 $u^{h}\\in\\mathbb{R}^{N-1}$ 表示通过标准二阶中心有限差分格式结合离散正弦变换 (DST) 得到的离散解：对 $j=1,\\dots,N-1$，\n$$\n\\frac{-u^{h}_{j-1}+2u^{h}_{j}-u^{h}_{j+1}}{h^{2}}=f(x_j),\\qquad u^{h}_0=u^{h}_N=0.\n$$\n你将通过利用正弦基诱导的变量分离，从第一性原理分析误差 $e^{h}_j=u^{h}_j-u(x_j)$。\n\n任务：\n\n$1.$ 从 $(0,1)$ 上连续狄利克雷拉普拉斯算子的 Sturm–Liouville 特征对，以及具有齐次狄利克雷条件的三对角二阶差分矩阵的特征对出发，分别推导 $u$ 和 $u^{h}$ 的连续和离散正弦展开。仅使用傅里叶正弦级数和特征值问题的核心定义来证明，对于 $k=1,\\dots,N-1$，由 $v^{(k)}_j=\\sin(k\\pi x_j)$ 定义的离散特征向量 $v^{(k)}$ 能将离散算子对角化，并具有特征值\n$$\n\\lambda_k^{h}=\\frac{4}{h^{2}}\\sin^{2}\\!\\Big(\\frac{k\\pi h}{2}\\Big).\n$$\n\n$2.$ 使用任务1中的展开，给出网格点上逐模的误差表示，该表示清晰地分开了系数近似的影响和有限差分色散（即特征值不匹配）的影响。假设 $f\\in C^{4}([0,1])$ 以确保你使用的所有级数和极限交换都是合理的，并从中心差分的截断误差出发，论证网格误差满足一个 $O(h^{2})$ 的估计。\n\n$3.$ 为了显式地量化 $O(h^{2})$ 离散化误差常数，特化到单模右端项 $f(x)=\\sin(\\pi x)$。仅使用你已建立的定义和恒等式，证明分量为 $s_j=\\sin(\\pi x_j)$ 的离散向量 $s$ 是离散算子的一个特征向量。然后，推导当 $h\\to 0$ 时，最大范数网格误差的主阶渐近展开\n$$\n\\max_{1\\le j\\le N-1}\\big|u^{h}_j-u(x_j)\\big| = C\\,h^{2}+O(h^{4}).\n$$\n给出系数 $C$ 的精确值，作为一个实数。无需四舍五入。", "solution": "本题要求使用特征函数展开来分析一维泊松方程的有限差分误差。这些任务引导我们从连续和离散算子的基本特征对出发，得出一个特定情况下误差的精确渐近表达式。\n\n### 任务1：连续和离散正弦展开\n\n我们首先为连续问题及其离散近似建立特征展开。\n\n**连续问题：**\n连续问题是在 $(0,1)$ 上的 $-u''(x)=f(x)$，且有 $u(0)=u(1)=0$。这是一个关于算子 $L = -d^2/dx^2$ 且带有齐次狄利克雷边界条件的 Sturm-Liouville 问题。相关的特征值问题是\n$$\n-u''(x) = \\lambda u(x), \\qquad u(0)=u(1)=0.\n$$\n该微分方程的通解是 $u(x) = A\\cos(\\sqrt{\\lambda}x) + B\\sin(\\sqrt{\\lambda}x)$。边界条件 $u(0)=0$ 意味着 $A=0$。条件 $u(1)=0$ 意味着 $B\\sin(\\sqrt{\\lambda})=0$。为了得到非平凡解（$B \\neq 0$），必须有 $\\sin(\\sqrt{\\lambda})=0$，这意味着 $\\sqrt{\\lambda} = k\\pi$，其中 $k$ 是任意整数 $k \\in \\mathbb{N} = \\{1, 2, 3, \\dots\\}$。\n因此，特征值为 $\\lambda_k = (k\\pi)^2$，相应的特征函数为 $\\phi_k(x) = \\sin(k\\pi x)$，其中 $k=1, 2, \\dots$。\n\n这些特征函数构成了 $L^2(0,1)$ 的一个完备正交基。我们可以将解 $u(x)$ 和源项 $f(x)$ 在这个基中展开（即，作为傅里叶正弦级数）：\n$$\nu(x) = \\sum_{k=1}^{\\infty} \\hat{u}_k \\sin(k\\pi x), \\qquad f(x) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x).\n$$\n将这些展开式代入微分方程 $-u''(x) = f(x)$：\n$$\n-\\frac{d^2}{dx^2}\\left(\\sum_{k=1}^{\\infty} \\hat{u}_k \\sin(k\\pi x)\\right) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x)\n$$\n$$\n\\sum_{k=1}^{\\infty} \\hat{u}_k (k\\pi)^2 \\sin(k\\pi x) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x).\n$$\n根据正弦函数的正交性，我们可以对每个模态 $k$ 的系数进行等同：\n$$\n\\hat{u}_k (k\\pi)^2 = \\hat{f}_k \\implies \\hat{u}_k = \\frac{\\hat{f}_k}{(k\\pi)^2} = \\frac{\\hat{f}_k}{\\lambda_k}.\n$$\n因此，连续解的展开式为 $u(x)=\\sum_{k=1}^{\\infty} \\frac{\\hat{f}_k}{\\lambda_k}\\sin(k\\pi x)$。\n\n**离散问题：**\n有限差分方程构成一个线性系统 $A_h u^h = f^h$，其中 $A_h$ 是一个 $(N-1)\\times(N-1)$ 的矩阵，由 $A_h = \\frac{1}{h^2} \\text{tridiag}(-1, 2, -1)$ 给出。题目要求我们证明分量为 $v^{(k)}_j = \\sin(k\\pi x_j) = \\sin(k\\pi jh)$（其中 $j=1, \\dots, N-1$）的向量 $v^{(k)}$ 是 $A_h$ 的特征向量。让我们对一个固定的 $k \\in \\{1,\\dots,N-1\\}$，将 $A_h$ 应用于 $v^{(k)}$。所得向量的第 $j$ 个分量是：\n$$\n(A_h v^{(k)})_j = \\frac{1}{h^2} \\left( -v^{(k)}_{j-1} + 2v^{(k)}_j - v^{(k)}_{j+1} \\right)\n$$\n$$\n= \\frac{1}{h^2} \\left( -\\sin(k\\pi(j-1)h) + 2\\sin(k\\pi jh) - \\sin(k\\pi(j+1)h) \\right).\n$$\n使用三角恒等式 $\\sin(A-B)+\\sin(A+B)=2\\sin A \\cos B$，并令 $A=k\\pi jh$ 和 $B=k\\pi h$，我们得到：\n$$\n\\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h) = 2\\sin(k\\pi jh)\\cos(k\\pi h).\n$$\n将此代入 $(A_h v^{(k)})_j$ 的表达式中：\n$$\n(A_h v^{(k)})_j = \\frac{1}{h^2} \\left( 2\\sin(k\\pi jh) - 2\\sin(k\\pi jh)\\cos(k\\pi h) \\right) = \\frac{2(1-\\cos(k\\pi h))}{h^2} \\sin(k\\pi jh).\n$$\n现在，使用半角恒等式 $1-\\cos\\theta=2\\sin^2(\\theta/2)$：\n$$\n(A_h v^{(k)})_j = \\frac{2(2\\sin^2(k\\pi h/2))}{h^2} \\sin(k\\pi jh) = \\left( \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right) \\right) v^{(k)}_j.\n$$\n这证实了 $v^{(k)}$ 是 $A_h$ 的一个特征向量，其特征值为 $\\lambda_k^h = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right)$，符合要求。\n\n特征向量 $\\{v^{(k)}\\}_{k=1}^{N-1}$ 构成了 $\\mathbb{R}^{N-1}$ 的一个正交基。我们可以展开离散解 $u^h$ 和离散源项 $f^h = (f(x_1), \\dots, f(x_{N-1}))^T$：\n$$\nu^h = \\sum_{k=1}^{N-1} \\hat{u}_k^h v^{(k)}, \\qquad f^h = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\n这里，$\\hat{u}_k^h$ 和 $\\hat{f}_k^h$ 是在这个基下的系数（即离散正弦变换系数）。代入系统 $A_h u^h = f^h$ 中：\n$$\nA_h \\left(\\sum_{k=1}^{N-1} \\hat{u}_k^h v^{(k)}\\right) = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)} \\implies \\sum_{k=1}^{N-1} \\hat{u}_k^h (A_h v^{(k)}) = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\n$$\n\\sum_{k=1}^{N-1} \\hat{u}_k^h \\lambda_k^h v^{(k)} = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\n根据线性无关性，有 $\\hat{u}_k^h \\lambda_k^h = \\hat{f}_k^h$，所以 $\\hat{u}_k^h = \\frac{\\hat{f}_k^h}{\\lambda_k^h}$。\n离散解为 $u^h_j = \\sum_{k=1}^{N-1} \\frac{\\hat{f}_k^h}{\\lambda_k^h}\\sin(k\\pi x_j)$。\n\n### 任务2：误差表示与精度阶\n\n在网格点 $x_j$ 处的误差为 $e_j^h = u_j^h - u(x_j)$。暂时忽略混叠和级数截断效应，第 $k$ 个模态的误差可以通过比较系数来分析：\n$$\n\\hat{e}_k \\approx \\hat{u}_k^h - \\hat{u}_k = \\frac{\\hat{f}_k^h}{\\lambda_k^h} - \\frac{\\hat{f}_k}{\\lambda_k} = \\frac{\\hat{f}_k^h\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h}.\n$$\n我们可以重写此式以分离误差的来源：\n$$\n\\frac{\\hat{f}_k^h\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h} = \\frac{(\\hat{f}_k^h-\\hat{f}_k)\\lambda_k + \\hat{f}_k\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h} = \\frac{\\hat{f}_k^h-\\hat{f}_k}{\\lambda_k^h} + \\hat{f}_k \\frac{\\lambda_k-\\lambda_k^h}{\\lambda_k\\lambda_k^h}.\n$$\n这个表示清晰地将误差分离为两个部分：\n$1.$ **系数近似误差**：包含 $\\hat{f}_k^h - \\hat{f}_k$ 的项，其产生原因在于离散傅里叶系数（通过离散正弦变换DST，一个求和得到）是连续傅里叶系数（一个积分）的近似。这是一种求积误差。\n$2.$ **色散误差**：包含 $\\lambda_k - \\lambda_k^h$ 的项，其产生原因在于离散特征值 $\\lambda_k^h$ 是连续特征值 $\\lambda_k = (k\\pi)^2$ 的一个近似。这种差异被称为色散。\n\n要建立 $O(h^2)$ 的全局误差估计，使用截断误差更为直接。截断误差 $\\tau_j$ 是将精确解 $u(x)$ 代入离散算子后得到的残差：\n$$\n\\tau_j = \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2} - f(x_j).\n$$\n由于 $-u''(x) = f(x)$，这变为 $\\tau_j = \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2} + u''(x_j)$。\n根据泰勒定理，对于 $u \\in C^4([0,1])$，我们有：\n$$\nu(x_j \\pm h) = u(x_j) \\pm h u'(x_j) + \\frac{h^2}{2}u''(x_j) \\pm \\frac{h^3}{6}u'''(x_j) + \\frac{h^4}{24}u''''(x_j) + O(h^5).\n$$\n对 $u(x_j+h)$ 和 $u(x_j-h)$ 的展开式求和：\n$$\nu(x_{j+1}) + u(x_{j-1}) = 2u(x_j) + h^2 u''(x_j) + \\frac{h^4}{12}u''''(x_j) + O(h^6).\n$$\n整理后得到二阶导数的标准中心差分公式：\n$$\n\\frac{u(x_{j+1}) - 2u(x_j) + u(x_{j-1})}{h^2} = u''(x_j) + \\frac{h^2}{12}u''''(x_j) + O(h^4).\n$$\n将此代入 $\\tau_j$ 的表达式中：\n$$\n\\tau_j = - \\left(u''(x_j) + \\frac{h^2}{12}u''''(x_j) + O(h^4)\\right) + u''(x_j) = -\\frac{h^2}{12}u''''(x_j) + O(h^4).\n$$\n误差向量 $e^h = (e_1^h, \\dots, e_{N-1}^h)^T$ 满足方程 $A_h e^h = -\\tau^h$，其中 $\\tau^h = (\\tau_1, \\dots, \\tau_{N-1})^T$。因此，$e^h = -A_h^{-1}\\tau^h$。取最大范数：\n$$\n\\|e^h\\|_{\\infty} \\le \\|A_h^{-1}\\|_{\\infty} \\|\\tau^h\\|_{\\infty}.\n$$\n算子 $A_h$ 是离散拉普拉斯算子，其逆矩阵有界，$\\|A_h^{-1}\\|_{\\infty} \\le 1/8$。由于 $f \\in C^4$，则 $u \\in C^6$，所以 $u''''$ 在 $[0,1]$ 上有界。令 $M_4 = \\max_{x\\in[0,1]} |u''''(x)|$。\n$$\n\\|\\tau^h\\|_{\\infty} = \\max_{1\\le j \\le N-1} \\left|-\\frac{h^2}{12}u''''(x_j) + O(h^4)\\right| = \\frac{h^2}{12}M_4 + O(h^4).\n$$\n因此，网格误差满足以下估计：\n$$\n\\|e^h\\|_{\\infty} = \\max_{1\\le j\\le N-1} |e^h_j| \\le \\frac{1}{8} \\left(\\frac{h^2}{12}M_4 + O(h^4)\\right) = O(h^2).\n$$\n\n### 任务3：单模的误差常数\n\n我们特化到 $f(x) = \\sin(\\pi x)$ 的情况，这是连续算子的第一个特征函数（$k=1$）。\n\n精确解 $u(x)$ 满足 $-u''(x) = \\sin(\\pi x)$。我们通过观察可以看出 $u(x) = C_1 \\sin(\\pi x)$ 是一个候选解。代入后得到 $-C_1(-\\pi^2\\sin(\\pi x)) = \\sin(\\pi x)$，所以 $C_1\\pi^2=1$，这意味着 $C_1=1/\\pi^2$。精确解是：\n$$\nu(x) = \\frac{1}{\\pi^2}\\sin(\\pi x).\n$$\n在网格点上的值为 $u(x_j) = \\frac{1}{\\pi^2}\\sin(\\pi x_j)$。\n\n离散问题是 $A_h u^h = f^h$，其中右端项向量的分量为 $f_j^h = f(x_j) = \\sin(\\pi x_j)$。这个向量恰好是第一个离散特征向量，即 $f^h = v^{(1)}$。\n该系统为 $A_h u^h = v^{(1)}$。由于 $v^{(1)}$ 是 $A_h$ 的一个特征向量，解 $u^h$ 必须是 $v^{(1)}$ 的一个倍数。令 $u^h = c \\cdot v^{(1)}$。\n代入方程：$A_h(c \\cdot v^{(1)}) = c(A_h v^{(1)}) = c\\lambda_1^h v^{(1)}$。我们要求 $c\\lambda_1^h v^{(1)} = v^{(1)}$，这意味着 $c=1/\\lambda_1^h$。因此离散解为：\n$$\nu^h_j = \\frac{1}{\\lambda_1^h}\\sin(\\pi x_j).\n$$\n每个网格点上的误差是：\n$$\ne^h_j = u^h_j - u(x_j) = \\frac{1}{\\lambda_1^h}\\sin(\\pi x_j) - \\frac{1}{\\pi^2}\\sin(\\pi x_j) = \\left(\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2}\\right)\\sin(\\pi x_j).\n$$\n为了找到最大误差的主阶行为，我们必须求出当 $h \\to 0$ 时前置因子的渐近展开。我们有 $\\lambda_1 = \\pi^2$ 和 $\\lambda_1^h = \\frac{4}{h^2}\\sin^2(\\frac{\\pi h}{2})$。让我们对小的 $h$ 展开 $\\lambda_1^h$。\n使用泰勒级数 $\\sin(z) = z - \\frac{z^3}{6} + \\frac{z^5}{120} - O(z^7)$：\n$$\n\\sin^2(z) = \\left(z - \\frac{z^3}{6} + O(z^5)\\right)^2 = z^2 - \\frac{z^4}{3} + O(z^6).\n$$\n令 $z=\\frac{\\pi h}{2}$，我们有：\n$$\n\\lambda_1^h = \\frac{4}{h^2} \\left( \\left(\\frac{\\pi h}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\pi h}{2}\\right)^4 + O(h^6) \\right) = \\frac{4}{h^2} \\left( \\frac{\\pi^2 h^2}{4} - \\frac{\\pi^4 h^4}{48} + O(h^6) \\right) = \\pi^2 - \\frac{\\pi^4}{12}h^2 + O(h^4).\n$$\n现在我们展开前置因子 $\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2}$：\n$$\n\\frac{1}{\\lambda_1^h} = \\frac{1}{\\pi^2 - \\frac{\\pi^4}{12}h^2 + O(h^4)} = \\frac{1}{\\pi^2}\\left(\\frac{1}{1 - \\frac{\\pi^2}{12}h^2 + O(h^4)}\\right).\n$$\n使用几何级数展开 $\\frac{1}{1-y} = 1+y+y^2+\\dots$：\n$$\n\\frac{1}{\\lambda_1^h} = \\frac{1}{\\pi^2}\\left(1 + \\frac{\\pi^2}{12}h^2 + O(h^4)\\right) = \\frac{1}{\\pi^2} + \\frac{1}{12}h^2 + O(h^4).\n$$\n因此前置因子为：\n$$\n\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2} = \\left(\\frac{1}{\\pi^2} + \\frac{1}{12}h^2 + O(h^4)\\right) - \\frac{1}{\\pi^2} = \\frac{1}{12}h^2 + O(h^4).\n$$\n最大范数网格误差为：\n$$\n\\max_{1\\le j\\le N-1}\\big|u^{h}_j-u(x_j)\\big| = \\max_{1\\le j\\le N-1}\\left|\\left(\\frac{1}{12}h^2 + O(h^4)\\right)\\sin(\\pi x_j)\\right|.\n$$\n当 $h \\to 0$ 时，我们有 $\\max_{1\\le j\\le N-1}|\\sin(\\pi x_j)| \\to \\sin(\\pi/2) = 1$。更精确地说，如果 $N$ 是偶数，最大值是 $1$；如果 $N$ 是奇数，最大值是 $\\cos(\\pi h/2) = 1 - O(h^2)$。无论哪种情况：\n$$\n\\max_{1\\le j\\le N-1}\\big|e^{h}_j\\big| = \\left(\\frac{1}{12}h^2 + O(h^4)\\right)(1 - O(h^2)) = \\frac{1}{12}h^2 + O(h^4).\n$$\n将其与给定形式 $\\max_{j}|e^h_j| = C\\,h^2 + O(h^4)$ 比较，我们确定常数 $C$。\n系数的精确值为 $C=\\frac{1}{12}$。", "answer": "$$\n\\boxed{\\frac{1}{12}}\n$$", "id": "3443469"}, {"introduction": "当解决高维问题时，这些变换方法的真正威力才得以显现。最后一个练习要求你应用可分离性原理，构建一个高效的二维泊松方程求解器 [@problem_id:3443478]。通过使用连续的一维变换来实现求解器，你将把对角化的理论概念转化为一个实用而强大的计算工具，并获得关于快速泊松求解器算法结构的实践经验。", "problem": "考虑一个矩形上的可分离泊松问题，其具有齐次狄利克雷边界条件：求 $u(x,y)$ 使得\n$$ -\\frac{\\partial^2 u}{\\partial x^2}(x,y) - \\frac{\\partial^2 u}{\\partial y^2}(x,y) = f(x,y), \\quad (x,y) \\in (0,L_x)\\times(0,L_y), $$\n其中 $u(x,y)=0$ 在矩形边界上。使用均匀张量积网格对区域内部进行离散化，该网格在 $x$ 和 $y$ 方向上分别有 $N_x$ 和 $N_y$ 个内部点，网格间距分别为 $h_x = \\frac{L_x}{N_x+1}$ 和 $h_y = \\frac{L_y}{N_y+1}$。令 $u_{j,i} \\approx u(x_i,y_j)$ 表示内部节点 $x_i = i h_x$（$i=1,\\dots,N_x$）和 $y_j = j h_y$（$j=1,\\dots,N_y$）处的网格函数。使用中心二阶有限差分，作用于内部网格函数 $u$ 上的离散拉普拉斯算子 $\\Delta_h$ 为\n$$ (\\Delta_h u)_{j,i} = \\frac{u_{j,i-1} - 2 u_{j,i} + u_{j,i+1}}{h_x^2} + \\frac{u_{j-1,i} - 2 u_{j,i} + u_{j+1,i}}{h_y^2}, $$\n按照约定，内部索引范围之外的值设为零，以强制施加齐次狄利克雷边界条件。离散问题为：求内部网格函数 $u$ 使得\n$$ -\\Delta_h u = f_h, $$\n其中 $f_h$ 是 $f$ 在内部网格上的采样。\n\n一个经过充分检验的事实是，对应于带有齐次狄利克雷边界条件的二阶导数的一维离散算子，可由I型离散正弦变换（DST）对角化，其特征值为\n$$ \\lambda^{(x)}_k = \\frac{4}{h_x^2} \\sin^2\\!\\left(\\frac{k\\pi}{2(N_x+1)}\\right), \\quad k=1,\\dots,N_x, $$\n并且在 $y$ 方向上类似，特征值为\n$$ \\lambda^{(y)}_\\ell = \\frac{4}{h_y^2} \\sin^2\\!\\left(\\frac{\\ell\\pi}{2(N_y+1)}\\right), \\quad \\ell=1,\\dots,N_y. $$\n根据可分离性，二维算子 $-\\Delta_h$ 可以通过沿行和列应用一维变换来对角化。\n\n你的任务是基于沿行和列分别应用的一维变换，实现一个二维求解器来求解 $-\\Delta_h u = f_h$。你必须：\n- 从上述定义和事实出发，推导如何使用具有标准正交归一化的I型离散正弦变换（DST）对角化二维算子，并由此获得计算变换后解系数的谱公式。\n- 通过仅沿最后一个轴执行一维变换，然后置换轴以将另一个空间维度移到最后位置，并重复此过程来实现二维变换的应用。这样做是为了在每次变换调用中保持连续的内存访问（缓存效率）。你可以使用来自标准科学计算库、具有显式类型和归一化参数的离散正弦变换（DST）和离散余弦变换（DCT），但不得使用任何直接的二维变换例程。\n- 实现一个函数，该函数通过如上所述对边界进行零填充，来计算带有齐次狄利克雷边界条件的内部离散拉普拉斯算子 $\\Delta_h$。使用此函数从已知的（采样的）精确内部解 $u$ 生成右端项 $f_h$，以便可以将数值求解器的输出与精确离散解进行比较。\n- 除了基于正弦变换的泊松求解器，还需为给定类型和归一化的二维离散余弦变换（DCT）实现类似的两遍辅助函数，同样通过在两遍之间进行置换步骤，并沿最后一个轴进行变换。\n\n角度必须以弧度为单位。不存在物理单位。所有数值答案必须按下面指定的方式报告为浮点数或布尔值。\n\n测试套件：\n实现你的程序以评估以下五个测试用例，并按规定格式生成输出。\n\n$1$. 齐次狄利克雷，矩形网格（理想情况）：\n- 参数：$N_x=32$，$N_y=20$，$L_x=1$，$L_y=1$，精确内部解 $u(x,y) = \\sin(3\\pi x/L_x)\\sin(5\\pi y/L_y)$。\n- 通过在内部节点上采样 $u$ 来构造 $u_{j,i}$，计算 $f_h = -\\Delta_h u$，求解 $-\\Delta_h \\tilde{u} = f_h$，并返回相对离散 $\\ell^2$ 误差\n$$ \\frac{\\| \\tilde{u} - u \\|_2}{\\|u\\|_2}, $$\n其中范数是内部网格值上的欧几里得范数。\n\n$2$. 齐次狄利克雷，不等边长的矩形域：\n- 参数：$N_x=29$，$N_y=37$，$L_x=2.0$，$L_y=0.5$，精确内部解 $u(x,y) = \\sin(2\\pi x/L_x)\\sin(9\\pi y/L_y)$。\n- 返回相对离散 $\\ell^2$ 误差，定义同案例1。\n\n$3$. 齐次狄利克雷，$N_x=1$ 的边界情况：\n- 参数：$N_x=1$，$N_y=17$，$L_x=1.0$，$L_y=1.0$，精确内部解 $u(x,y) = \\sin(\\pi x/L_x)\\sin(7\\pi y/L_y)$。\n- 返回相对离散 $\\ell^2$ 误差，定义同案例1。\n\n$4$. DST 的两遍变换等效性：\n- 使用固定的种子生成一个固定的随机数组 $A \\in \\mathbb{R}^{23\\times 17}$。用两种方法计算具有标准正交归一化的二维 DST-I：\n  （a）沿最后一个轴应用一维变换，交换轴，然后再次沿最后一个轴进行变换；以及\n  （b）直接沿轴1进行变换，然后沿轴0进行变换，不进行交换。\n- 如果两个结果之间的最大绝对差小于或等于 $10^{-10}$，则返回布尔值 $true$，否则返回 $false$。\n\n$5$. DCT 的两遍变换等效性：\n- 使用与案例4中相同的固定种子生成一个固定的随机数组 $B \\in \\mathbb{R}^{16\\times 10}$。使用与案例4中相同的两种方法计算具有标准正交归一化的二维 DCT-II。\n- 如果两个结果之间的最大绝对差小于或等于 $10^{-10}$，则返回布尔值 $true$，否则返回 $false$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含按测试用例1到5的顺序排列的结果，结果为逗号分隔的列表，并用方括号括起来，例如，格式为\n$[r_1,r_2,r_3,b_4,b_5]$,\n其中 $r_1$、$r_2$ 和 $r_3$ 是浮点数，$b_4$、$b_5$ 是表示为 $True$ 或 $False$ 的布尔值。", "solution": "用户提供的问题已经过分析，并被认为是有效的。它具有科学依据、良定性、客观性，并包含唯一解所需的所有必要信息。我现在将提供一个完整的解决方案。\n\n### 谱方法泊松求解器的推导\n\n问题是在具有齐次狄利克雷边界条件的矩形网格上求解离散泊松方程 $-\\Delta_h u = f_h$。设网格函数 $u$ 由一个 $N_y \\times N_x$ 矩阵 $U = [u_{j,i}]$ 表示，其中 $j \\in \\{1, \\dots, N_y\\}$ 是行索引，$i \\in \\{1, \\dots, N_x\\}$ 是列索引。右端项 $f_h$ 同样由一个矩阵 $F = [f_{j,i}]$ 表示。\n\n离散拉普拉斯算子 $\\Delta_h$ 是可分离的，这意味着它可以表示为沿每个坐标方向作用的一维算子之和：\n$$ \\Delta_h = D_{xx} + D_{yy} $$\n其中 $(D_{xx} U)_{j,i} = \\frac{u_{j,i-1} - 2u_{j,i} + u_{j,i+1}}{h_x^2}$ 作用于 $U$ 的行，而 $(D_{yy} U)_{j,i} = \\frac{u_{j-1,i} - 2u_{j,i} + u_{j+1,i}}{h_y^2}$ 作用于列。\n\n设 $A_x$ 是表示 $x$ 方向二阶导数的一维有限差分算子的 $N_x \\times N_x$ 矩阵，而 $A_y$ 是 $y$ 方向对应的 $N_y \\times N_y$ 矩阵。这些是对称三对角矩阵：\n$$ A_x = \\frac{1}{h_x^2} \\begin{pmatrix} -2  1   \\\\ 1  -2  1  \\\\  \\ddots  \\ddots  \\ddots \\\\   1  -2 \\end{pmatrix}_{N_x \\times N_x} $$\n$A_y$ 也类似。$D_{xx}$ 的作用对应于右乘 $A_x$，$D_{yy}$ 的作用对应于左乘 $A_y$。离散泊松方程的矩阵形式为：\n$$ -(A_y U + U A_x) = F $$\n\n问题陈述中提到，一维算子可由I型离散正弦变换（DST-I）对角化。设 $S_x$ 和 $S_y$ 分别是大小为 $N_x \\times N_x$ 和 $N_y \\times N_y$ 的标准正交DST-I变换矩阵。其元素由 $(S_x)_{k,i} = \\sqrt{\\frac{2}{N_x+1}} \\sin\\left(\\frac{ki\\pi}{N_x+1}\\right)$ 给出（$k,i=1,\\dots,N_x$），$S_y$ 也类似。这些矩阵是对称的（$S_x^T = S_x$）和正交的（$S_x S_x = I_x$，其中 $I_x$ 是 $N_x \\times N_x$ 的单位矩阵）。\n\n算子 $-A_x$ 和 $-A_y$ 由 $S_x$ 和 $S_y$ 对角化：\n$$ -A_x = S_x \\Lambda_x S_x \\quad \\text{和} \\quad -A_y = S_y \\Lambda_y S_y $$\n其中 $\\Lambda_x$ 和 $\\Lambda_y$ 是包含问题陈述中提供的特征值的对角矩阵：\n$$ (\\Lambda_x)_{k,k} = \\lambda_k^{(x)} = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{k\\pi}{2(N_x+1)}\\right), \\quad k=1,\\dots,N_x $$\n$$ (\\Lambda_y)_{\\ell,\\ell} = \\lambda_\\ell^{(y)} = \\frac{4}{h_y^2} \\sin^2\\left(\\frac{\\ell\\pi}{2(N_y+1)}\\right), \\quad \\ell=1,\\dots,N_y $$\n\n为求解该矩阵方程，我们对其应用二维DST-I。设 $\\hat{U} = S_y U S_x$ 是变换后的解，$\\hat{F} = S_y F S_x$ 是变换后的右端项。我们在方程左边预乘 $S_y$ 右边后乘 $S_x$：\n$$ S_y ((-A_y U) + (U (-A_x))) S_x = S_y F S_x $$\n$$ (S_y (-A_y)) U S_x + S_y U ((-A_x) S_x) = \\hat{F} $$\n代入对角化形式：\n$$ (S_y (S_y \\Lambda_y S_y)) U S_x + S_y U ((S_x \\Lambda_x S_x) S_x) = \\hat{F} $$\n利用正交性（$S_y S_y = I_y$，$S_x S_x = I_x$）：\n$$ (I_y \\Lambda_y S_y) U S_x + S_y U (S_x \\Lambda_x I_x) = \\hat{F} $$\n$$ \\Lambda_y (S_y U S_x) + (S_y U S_x) \\Lambda_x = \\hat{F} $$\n这得到了谱域中的方程：\n$$ \\Lambda_y \\hat{U} + \\hat{U} \\Lambda_x = \\hat{F} $$\n由于 $\\Lambda_x$ 和 $\\Lambda_y$ 是对角矩阵，这是一个关于变换后矩阵 $\\hat{U}$ 的系数 $\\hat{U}_{\\ell,k}$ 的逐元素代数方程：\n$$ \\lambda_\\ell^{(y)} \\hat{U}_{\\ell,k} + \\hat{U}_{\\ell,k} \\lambda_k^{(x)} = \\hat{F}_{\\ell,k} $$\n$$ (\\lambda_\\ell^{(y)} + \\lambda_k^{(x)}) \\hat{U}_{\\ell,k} = \\hat{F}_{\\ell,k} $$\n因此，变换后系数的解为：\n$$ \\hat{U}_{\\ell,k} = \\frac{\\hat{F}_{\\ell,k}}{\\lambda_\\ell^{(y)} + \\lambda_k^{(x)}} $$\n\n### 算法实现\n\n求解过程包括以下步骤：\n1.  给定右端项网格函数 $F$，计算其二维DST-I，$\\hat{F} = S_y F S_x$。\n2.  构造二维算子的特征值矩阵，$(\\Lambda_{2D})_{\\ell,k} = \\lambda_\\ell^{(y)} + \\lambda_k^{(x)}$。\n3.  通过逐元素相除计算变换后的解系数 $\\hat{U}$：$\\hat{U} = \\hat{F} ./ \\Lambda_{2D}$。\n4.  对 $\\hat{U}$ 应用二维DST-I的逆变换来计算最终解 $U$。对于标准正交DST-I，其逆变换就是其本身：$U = S_y \\hat{U} S_x$。\n\n二维变换被实现为两遍一维变换。按照要求，为了缓存效率，使用了一种基于置换的方法。对于一个 $N_y \\times N_x$ 的数组 `data`，二维变换的计算方法如下：\n1.  沿最后一个轴（`axis=-1`）应用一维变换。\n2.  转置结果矩阵（`data.T`）。\n3.  沿新的最后一个轴再次应用一维变换。\n4.  将结果转置回来。\n\n该过程将在辅助函数 `dst1_2d_permute`（用于DST-I）和 `dct2_2d_permute`（用于DCT-II）中实现。\n\n对于测试用例1-3，右端项 $f_h$ 是通过 $f_h = -\\Delta_h u$ 从一个已知的精确解 $u$ 生成的。离散拉普拉斯算子 $\\Delta_h$ 的实现方式是，首先用一层零来填充 $N_y \\times N_x$ 的内部网格函数 $u$，以创建一个 $(N_y+2) \\times (N_x+2)$ 的数组，这代表了齐次狄利克雷边界条件。然后将中心有限差分公式应用于此填充后的数组，以计算内部网格上的拉普拉斯算子。\n\n对于测试用例4和5，将检验基于置换的二维变换与先沿 `axis=1` 再沿 `axis=0` 直接应用一维变换的等效性，以验证两遍辅助函数的实现。\n\n最终的数值解 $\\tilde{u}$ 将通过计算相对离散 $\\ell^2$ 误差 $\\frac{\\| \\tilde{u} - u \\|_2}{\\|u\\|_2}$ 与已知的精确离散解 $u$ 进行比较。对于所选的精确解，它们是离散算子的特征函数，因此该误差预计接近机器精度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import fft\n\ndef discrete_laplacian(u, hx, hy):\n    \"\"\"\n    Computes the discrete Laplacian of an interior grid function u\n    with homogeneous Dirichlet boundary conditions.\n    \n    Args:\n        u (np.ndarray): A 2D numpy array of shape (Ny, Nx) representing the grid function.\n        hx (float): Grid spacing in the x-direction.\n        hy (float): Grid spacing in the y-direction.\n        \n    Returns:\n        np.ndarray: A 2D numpy array of shape (Ny, Nx) representing the discrete Laplacian of u.\n    \"\"\"\n    Ny, Nx = u.shape\n    u_padded = np.zeros((Ny + 2, Nx + 2))\n    u_padded[1:-1, 1:-1] = u\n    \n    lap_u = (u_padded[1:-1, 0:-2] - 2 * u_padded[1:-1, 1:-1] + u_padded[1:-1, 2:]) / (hx**2)\n    lap_u += (u_padded[0:-2, 1:-1] - 2 * u_padded[1:-1, 1:-1] + u_padded[2:, 1:-1]) / (hy**2)\n    \n    return lap_u\n\ndef dst1_2d_permute(data):\n    \"\"\"Computes 2D DST-I using 1D transforms on last axis with permutation.\"\"\"\n    temp = fft.dst(data, type=1, axis=-1, norm='ortho')\n    temp = fft.dst(temp.T, type=1, axis=-1, norm='ortho')\n    return temp.T\n\ndef dct2_2d_permute(data):\n    \"\"\"Computes 2D DCT-II using 1D transforms on last axis with permutation.\"\"\"\n    temp = fft.dct(data, type=2, axis=-1, norm='ortho')\n    temp = fft.dct(temp.T, type=2, axis=-1, norm='ortho')\n    return temp.T\n\ndef poisson_solve_dst(f_h, Lx, Ly):\n    \"\"\"\n    Solves the discrete Poisson equation -Delta_h u = f_h using the DST.\n    \n    Args:\n        f_h (np.ndarray): A 2D array of shape (Ny, Nx) for the right-hand side.\n        Lx (float): Length of the domain in x-direction.\n        Ly (float): Length of the domain in y-direction.\n        \n    Returns:\n        np.ndarray: The solution grid function u of shape (Ny, Nx).\n    \"\"\"\n    Ny, Nx = f_h.shape\n    hx = Lx / (Nx + 1)\n    hy = Ly / (Ny + 1)\n    \n    f_hat = dst1_2d_permute(f_h)\n    \n    k = np.arange(1, Nx + 1).reshape(1, -1)\n    l = np.arange(1, Ny + 1).reshape(-1, 1)\n\n    lambda_x = (4 / hx**2) * np.sin(k * np.pi / (2 * (Nx + 1)))**2\n    lambda_y = (4 / hy**2) * np.sin(l * np.pi / (2 * (Ny + 1)))**2\n    \n    lambda_2d = lambda_y + lambda_x\n    \n    u_hat = f_hat / lambda_2d\n    \n    u_solution = dst1_2d_permute(u_hat)\n    \n    return u_solution\n\ndef run_poisson_test(params):\n    \"\"\"Runs a single Poisson solver test case.\"\"\"\n    Nx, Ny, Lx, Ly, m, n = params\n    \n    hx = Lx / (Nx + 1)\n    hy = Ly / (Ny + 1)\n    \n    # Handle the 1D case for meshgrid\n    if Nx == 1:\n        x = np.array([hx])\n    else:\n        x = np.arange(1, Nx + 1) * hx\n    \n    if Ny == 1:\n        y = np.array([hy])\n    else:\n        y = np.arange(1, Ny + 1) * hy\n        \n    xx, yy = np.meshgrid(x, y)\n    \n    u_exact = np.sin(m * np.pi * xx / Lx) * np.sin(n * np.pi * yy / Ly)\n\n    f_h = -discrete_laplacian(u_exact, hx, hy)\n    \n    u_tilde = poisson_solve_dst(f_h, Lx, Ly)\n    \n    norm_diff = np.linalg.norm(u_tilde - u_exact)\n    norm_exact = np.linalg.norm(u_exact)\n    \n    if norm_exact == 0:\n        return 0.0 if norm_diff == 0 else np.inf\n        \n    return norm_diff / norm_exact\n\ndef test_dst_equivalence():\n    \"\"\"Tests equivalence of two methods for 2D DST-I.\"\"\"\n    np.random.seed(42)\n    A = np.random.rand(23, 17)\n    \n    res_permute = dst1_2d_permute(A)\n    \n    temp_direct = fft.dst(A, type=1, axis=1, norm='ortho')\n    res_direct = fft.dst(temp_direct, type=1, axis=0, norm='ortho')\n    \n    max_diff = np.max(np.abs(res_permute - res_direct))\n    return max_diff = 1e-10\n\ndef test_dct_equivalence():\n    \"\"\"Tests equivalence of two methods for 2D DCT-II.\"\"\"\n    np.random.seed(42)\n    B = np.random.rand(16, 10)\n    \n    res_permute = dct2_2d_permute(B)\n    \n    temp_direct = fft.dct(B, type=2, axis=1, norm='ortho')\n    res_direct = fft.dct(temp_direct, type=2, axis=0, norm='ortho')\n    \n    max_diff = np.max(np.abs(res_permute - res_direct))\n    return max_diff = 1e-10\n\ndef solve():\n    \"\"\"Main function to run all test cases and print results.\"\"\"\n    test_cases = [\n        # Poisson solver tests: (Nx, Ny, Lx, Ly, m, n)\n        (32, 20, 1.0, 1.0, 3, 5),\n        (29, 37, 2.0, 0.5, 2, 9),\n        (1, 17, 1.0, 1.0, 1, 7),\n    ]\n\n    results = []\n    \n    # Cases 1, 2, 3\n    for case_params in test_cases:\n        error = run_poisson_test(case_params)\n        results.append(error)\n        \n    # Case 4\n    results.append(test_dst_equivalence())\n    \n    # Case 5\n    results.append(test_dct_equivalence())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3443478"}]}