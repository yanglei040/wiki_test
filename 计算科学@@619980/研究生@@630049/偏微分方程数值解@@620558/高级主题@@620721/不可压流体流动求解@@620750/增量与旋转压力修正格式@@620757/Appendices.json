{"hands_on_practices": [{"introduction": "压力修正法的核心在于将速度和压力的求解解耦，其关键步骤是通过求解一个泊松方程来更新压力。本练习 [@problem_id:3408423] 将带您亲手推导这个核心的压力泊松方程，并处理在周期性区域上求解时必须满足的相容性条件。通过为一个设定好的速度场求解压力，您将深入理解从运动学约束（即不可压缩条件）到动力学更新（即压力梯度力）的完整流程。", "problem": "考虑在二维周期性环面 $\\Omega = [0,2\\pi]^{2}$ 上，通过增量压力修正格式进行时间推进的不可压缩纳维-斯托克斯方程，两个方向上均采用周期性边界条件。设在时间层 $n+1$ 的预测中间速度场为 $\\boldsymbol{u}^{*}(x,y)$，速度修正为 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi$，其中 $\\Delta t > 0$ 是时间步长，$\\phi$ 是压力增量。修正后的速度必须满足不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。\n\n从上述定义和不可压缩性约束出发，推导在 $\\Omega$ 上关于压力增量 $\\phi$ 的泊松方程，并陈述在周期性区域上其可解性所需的必要相容性（零均值）条件。然后，对于给定的人工中间速度\n$$\n\\boldsymbol{u}^{*}(x,y) = \n\\begin{pmatrix}\na \\cos(2x)\\,\\sin(y) + b \\sin(x)\\,\\cos(3y) \\\\\nc \\sin(2x)\\,\\cos(y) + d \\cos(x)\\,\\sin(3y)\n\\end{pmatrix},\n$$\n（其中 $a$、$b$、$c$、$d$ 为实参数），计算散度源项 $s(x,y) = \\nabla \\cdot \\boldsymbol{u}^{*}(x,y)$，显式验证 $s$ 在 $\\Omega$ 上满足零均值相容性条件，并使用零均值规范 $\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$ 求解关于 $\\phi$ 的泊松问题。\n\n请以 $a$、$b$、$c$、$d$ 和 $\\Delta t$ 的单个显式表达式形式给出 $\\phi(x,y)$ 的最终答案。无需进行数值计算。", "solution": "问题陈述已解析和验证。所有给定条件逐字记录如下：\n区域：$\\Omega = [0,2\\pi]^{2}$，具有周期性边界条件。\n速度修正：$\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi$。\n时间步长：$\\Delta t > 0$。\n不可压缩性约束：$\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。\n中间速度：\n$$\n\\boldsymbol{u}^{*}(x,y) = \n\\begin{pmatrix}\na \\cos(2x)\\,\\sin(y) + b \\sin(x)\\,\\cos(3y) \\\\\nc \\sin(2x)\\,\\cos(y) + d \\cos(x)\\,\\sin(3y)\n\\end{pmatrix}\n$$\n其中 $a, b, c, d$ 是实参数。\n规范条件：$\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$。\n\n该问题具有科学依据、适定、客观，并包含足够的信息。这是流体动力学中偏微分方程数值解的一个标准练习。因此，该问题被视为有效，并将提供解答。\n\n首先，我们推导压力增量 $\\phi$ 的泊松方程。我们从速度修正公式开始：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi\n$$\n修正后的速度场 $\\boldsymbol{u}^{n+1}$ 必须是无散的，满足不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。对速度修正方程应用散度算子，得到：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi)\n$$\n利用散度算子的线性性质，我们得到：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{*} - \\Delta t \\nabla \\cdot (\\nabla \\phi)\n$$\n代入不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ 并注意到梯度的散度是拉普拉斯算子，即 $\\nabla \\cdot (\\nabla \\phi) = \\nabla^2 \\phi$，我们得到：\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{*} - \\Delta t \\nabla^2 \\phi\n$$\n重新整理此方程，得到压力增量 $\\phi$ 的泊松方程：\n$$\n\\nabla^2 \\phi = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*}\n$$\n为使该椭圆型偏微分方程在周期性区域 $\\Omega$ 上有解，必须满足一个相容性条件。该条件通过在整个区域上对此方程进行积分得到：\n$$\n\\int_{\\Omega} \\nabla^2 \\phi \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega\n$$\n使用散度定理，左侧可以转换成一个边界积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla \\phi) \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega} (\\nabla \\phi) \\cdot \\boldsymbol{n} \\, \\mathrm{d}S\n$$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial \\Omega$ 的外单位法向量。由于环面 $\\Omega = [0, 2\\pi]^2$ 上的周期性边界条件，区域相对面上的积分相互抵消，导致 $\\int_{\\partial \\Omega} (\\nabla \\phi) \\cdot \\boldsymbol{n} \\, \\mathrm{d}S = 0$。\n因此，相容性条件变为：\n$$\n\\int_{\\Omega} \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega = 0\n$$\n由于 $\\Delta t > 0$ 是一个常数，这简化为中间速度场散度的零均值条件：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega = 0\n$$\n接下来，我们为给定的中间速度场计算散度源项 $s(x,y) = \\nabla \\cdot \\boldsymbol{u}^{*}(x,y)$。设 $u^*$ 和 $v^*$ 是 $\\boldsymbol{u}^{*}$ 的分量：\n$$\nu^{*}(x,y) = a \\cos(2x)\\sin(y) + b \\sin(x)\\cos(3y)\n$$\n$$\nv^{*}(x,y) = c \\sin(2x)\\cos(y) + d \\cos(x)\\sin(3y)\n$$\n散度为 $s(x,y) = \\frac{\\partial u^{*}}{\\partial x} + \\frac{\\partial v^{*}}{\\partial y}$。我们计算其偏导数：\n$$\n\\frac{\\partial u^{*}}{\\partial x} = -2a \\sin(2x)\\sin(y) + b \\cos(x)\\cos(3y)\n$$\n$$\n\\frac{\\partial v^{*}}{\\partial y} = -c \\sin(2x)\\sin(y) + 3d \\cos(x)\\cos(3y)\n$$\n将它们相加得到源项：\n$$\ns(x,y) = -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y)\n$$\n现在，我们必须显式验证该源项在 $\\Omega = [0,2\\pi]^2$ 上满足相容性条件：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} s(x,y) \\, \\mathrm{d}x \\, \\mathrm{d}y = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left[ -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y) \\right] \\, \\mathrm{d}x \\, \\mathrm{d}y\n$$\n我们可以拆分该积分：\n$$\n= -(2a+c) \\left(\\int_{0}^{2\\pi} \\sin(2x) \\, \\mathrm{d}x \\right) \\left(\\int_{0}^{2\\pi} \\sin(y) \\, \\mathrm{d}y \\right) + (b+3d) \\left(\\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x \\right) \\left(\\int_{0}^{2\\pi} \\cos(3y) \\, \\mathrm{d}y \\right)\n$$\n对于任何非零整数 $k$，$\\sin(kx)$ 或 $\\cos(kx)$ 在一个完整周期 $[0, 2\\pi]$ 上的积分为零。在我们的例子中，这些整数是 $k=1, 2, 3$。\n$$\n\\int_{0}^{2\\pi} \\sin(2x) \\, \\mathrm{d}x = 0, \\quad \\int_{0}^{2\\pi} \\sin(y) \\, \\mathrm{d}y = 0\n$$\n$$\n\\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x = 0, \\quad \\int_{0}^{2\\pi} \\cos(3y) \\, \\mathrm{d}y = 0\n$$\n因此，总积分为 $0$，相容性条件得到满足。\n\n最后，我们求解关于 $\\phi$ 的泊松问题：\n$$\n\\nabla^2 \\phi = \\frac{s(x,y)}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y) \\right]\n$$\n根据源项的形式，我们寻求一个形如下式的解：\n$$\n\\phi(x,y) = A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y)\n$$\n其中 $A$ 和 $B$ 是待定常数。我们计算这个试探解的拉普拉斯算子：\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2}\n$$\n$$\n\\frac{\\partial^2}{\\partial x^2} \\left[A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) \\right] = -4A \\sin(2x)\\sin(y) - B \\cos(x)\\cos(3y)\n$$\n$$\n\\frac{\\partial^2}{\\partial y^2} \\left[A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) \\right] = -A \\sin(2x)\\sin(y) - 9B \\cos(x)\\cos(3y)\n$$\n将它们相加得到：\n$$\n\\nabla^2 \\phi = (-4A-A)\\sin(2x)\\sin(y) + (-B-9B)\\cos(x)\\cos(3y)\n$$\n$$\n\\nabla^2 \\phi = -5A \\sin(2x)\\sin(y) - 10B \\cos(x)\\cos(3y)\n$$\n通过将此表达式的系数与泊松方程进行比较，我们发现：\n$$\n-5A = -\\frac{2a+c}{\\Delta t} \\implies A = \\frac{2a+c}{5\\Delta t}\n$$\n$$\n-10B = \\frac{b+3d}{\\Delta t} \\implies B = -\\frac{b+3d}{10\\Delta t}\n$$\n通解为 $\\phi(x,y) = A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) + C_{0}$，其中 $C_{0}$ 为某个常数。我们使用零均值规范条件 $\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$ 来确定 $C_{0}$。\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left[ \\left(\\frac{2a+c}{5\\Delta t}\\right) \\sin(2x)\\sin(y) - \\left(\\frac{b+3d}{10\\Delta t}\\right) \\cos(x)\\cos(3y) + C_{0} \\right] \\, \\mathrm{d}x \\, \\mathrm{d}y = 0\n$$\n如前所述，三角函数项在整个区域上的积分为零。这剩下：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} C_{0} \\, \\mathrm{d}x \\, \\mathrm{d}y = C_{0} (2\\pi)^2 = 4\\pi^2 C_{0} = 0 \\implies C_{0} = 0\n$$\n因此，$\\phi$ 的唯一解是：\n$$\n\\phi(x,y) = \\frac{2a+c}{5\\Delta t} \\sin(2x)\\sin(y) - \\frac{b+3d}{10\\Delta t} \\cos(x)\\cos(3y)\n$$", "answer": "$$\n\\boxed{\\frac{2a+c}{5 \\Delta t}\\sin(2x)\\sin(y) - \\frac{b+3d}{10 \\Delta t}\\cos(x)\\cos(3y)}\n$$", "id": "3408423"}, {"introduction": "在数值求解流体动力学方程时，保证算法的稳定性至关重要，它直接决定了模拟能否顺利进行。当压力修正法中的对流项采用显式处理时，时间步长的选择会受到著名的Courant-Friedrichs-Lewy (CFL)条件的限制。本练习 [@problem_id:3408401] 通过冯·诺依曼稳定性分析，让您推导出这一关键的时间步长限制，从而加深对显式格式稳定性和数值弥散的理解。", "problem": "考虑速度场 $\\mathbf{u}(\\mathbf{x},t)$ 和运动压力 $p(\\mathbf{x},t)$ 的不可压缩纳维-斯托克斯方程，\n$$\n\\partial_{t}\\mathbf{u} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nabla p - \\nu \\Delta \\mathbf{u} = \\mathbf{0}, \\quad \\nabla\\cdot\\mathbf{u} = 0,\n$$\n该方程构建在一个 $d$ 维周期性区域上，每个笛卡尔方向上的均匀网格间距为 $\\{h_{j}\\}_{j=1}^{d}$。考虑一种压力修正格式（增量或旋转变体），其中扩散项和压力梯度项被隐式处理，而对流项在暂定速度步中被显式处理。将对流项在一个非零的恒定平均流 $\\mathbf{U} \\in \\mathbb{R}^{d}$ 周围进行线性化，使得扰动速度 $\\mathbf{v}$ 满足线性对流算子 $(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$。假设采用以下数值方法：\n\n- 显式对流更新在时间上使用前向欧拉法。\n- 在 $x_{j}$ 方向上，$(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$ 的空间离散使用与 $U_{j}$ 符号一致的一阶迎风差分，并按分量应用于 $\\mathbf{v}$。\n- 到无散子空间的投影步通过带有周期性边界条件的泊松求解来精确计算。\n\n对 $\\mathbf{v}$ 的无散分量，执行线性化显式对流更新的冯·诺依曼（傅里叶）稳定性分析，同时考虑到后续的压力投影是一个 $L^{2}$-正交投影。推导时间步长 $\\Delta t$ 需满足的条件，以确保对所有波数，傅里叶模态放大因子的模最多为1。将允许的最大时间步长 $\\Delta t_{\\max}$ 表示为以 $\\{U_{j}\\}_{j=1}^{d}$ 和 $\\{h_{j}\\}_{j=1}^{d}$ 为变量的单一闭式解析表达式。你的最终答案必须是单一的解析表达式。不要四舍五入。明确说明对于通用维度 $d$ 的结果。", "solution": "用户希望对线性化的不可压缩纳维-斯托克斯方程的压力修正格式进行冯·诺依曼稳定性分析。\n\n### 第一步：提取已知条件\n- **控制方程**: 扰动速度 $\\mathbf{v}$ 和运动压力 $p'$ 的线性化不可压缩纳维-斯托克斯方程：\n  $$ \\partial_{t}\\mathbf{v} + (\\mathbf{U}\\cdot\\nabla)\\mathbf{v} + \\nabla p' - \\nu \\Delta \\mathbf{v} = \\mathbf{0}, \\quad \\nabla\\cdot\\mathbf{v} = 0 $$\n- **域**: $d$ 维周期性区域。\n- **离散化**: 均匀网格，间距为 $\\{h_{j}\\}_{j=1}^{d}$。\n- **数值格式**: 压力修正格式（增量或旋转变体）。\n- **时间积分**: 显式对流项使用前向欧拉法处理。扩散项和压力梯度项被隐式处理。\n- **对流离散**: 线性化对流项 $(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$ 对每个分量 $U_{j}\\partial_{x_j}\\mathbf{v}$ 使用一阶迎风差分进行离散。\n- **投影步**: 到无散子空间的投影是精确的，并且是一个 $L^2$-正交投影。\n- **分析任务**: 对 $\\mathbf{v}$ 的无散分量进行冯·诺依曼（傅里叶）稳定性分析。\n- **目标**: 推导时间步长 $\\Delta t$ 的条件，并以 $\\{U_{j}\\}_{j=1}^{d}$ 和 $\\{h_{j}\\}_{j=1}^{d}$ 为变量，求出允许的最大时间步长 $\\Delta t_{\\max}$ 的单一闭式表达式。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据、良定且客观。它是偏微分方程数值方法领域的一个标准问题，特别是在计算流体力学中。所做的假设（线性化、特定的离散格式、周期性边界条件）是进行冯·诺依曼稳定性分析的标准假设。该问题是自洽的，并提供了进行分析所需的所有信息。没有矛盾、歧义或事实性错误。\n\n### 第三步：结论与行动\n问题有效。将提供一个完整、有理有据的解答。\n\n### 解题推导\n压力修正格式包含两个主要步骤。首先，计算一个暂定速度，然后，将该速度投影到无散空间上。问题要求对速度的无散分量的“显式对流更新”进行稳定性分析。该格式可以写成：\n1.  **暂定速度步**：计算一个临时速度场 $\\mathbf{v}^{*}$。由于只有对流项使用前向欧拉法进行显式处理，为进行稳定性分析而分离出的这一步为：\n    $$ \\mathbf{v}^* = \\mathbf{v}^n - \\Delta t [(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}} $$\n    其中 $[(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}}$ 是空间离散算子。对于此显式稳定性分析，忽略了隐式项，因为它们的包含（例如，使用后向欧拉法）只会增强稳定性。\n\n2.  **投影步**：通过将 $\\mathbf{v}^*$ 投影到无散向量场空间上，得到新的速度 $\\mathbf{v}^{n+1}$。\n    $$ \\mathbf{v}^{n+1} = \\mathbb{P}(\\mathbf{v}^*) $$\n    其中 $\\mathbb{P}$ 是到无散子空间上的 $L^2$-正交投影算子。\n\n结合这些步骤，更新规则是：\n$$ \\mathbf{v}^{n+1} = \\mathbb{P}\\left(\\mathbf{v}^n - \\Delta t [(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}}\\right) $$\n\n我们通过考虑时间步 $n$ 处速度场的单个傅里叶模态来进行冯·诺依曼稳定性分析：\n$$ \\mathbf{v}^n(\\mathbf{x}) = \\hat{\\mathbf{v}}^n(\\mathbf{k}) e^{i\\mathbf{k}\\cdot\\mathbf{x}} $$\n其中 $\\mathbf{k}$ 是波矢量。问题指定我们分析“无散分量”的稳定性，这意味着我们假设初始速度模态 $\\hat{\\mathbf{v}}^n(\\mathbf{k})$ 是无散的。在傅里叶空间中，散度算子 $\\nabla\\cdot$ 对应于乘以 $i\\mathbf{k}\\cdot$。因此，无散速度满足 $i\\mathbf{k}\\cdot\\hat{\\mathbf{v}}^n(\\mathbf{k})=0$。\n\n接下来，我们求离散对流算子 $(\\mathbf{U}\\cdot\\nabla)_{\\text{disc}} = \\sum_{j=1}^d U_j (\\partial_{x_j})_{\\text{disc}}$ 的傅里叶符号。算子 $(\\partial_{x_j})_{\\text{disc}}$ 是一阶迎风差分。其形式取决于 $U_j$ 的符号：\n-   如果 $U_j > 0$，我们使用后向差分：$(\\partial_{x_j})_{\\text{disc}}f(\\mathbf{x}) = \\frac{f(\\mathbf{x}) - f(\\mathbf{x} - h_j\\mathbf{e}_j)}{h_j}$。\n-   如果 $U_j  0$，我们使用前向差分：$(\\partial_{x_j})_{\\text{disc}}f(\\mathbf{x}) = \\frac{f(\\mathbf{x} + h_j\\mathbf{e}_j) - f(\\mathbf{x})}{h_j}$。\n\n令 $\\theta_j = k_j h_j$ 为 $j$ 方向的相角。将差分算子应用于模态 $e^{i\\mathbf{k}\\cdot\\mathbf{x}}$ 得到它们的傅里叶符号：\n-   后向差分的符号：$\\frac{1 - e^{-i\\theta_j}}{h_j}$。\n-   前向差分的符号：$\\frac{e^{i\\theta_j} - 1}{h_j}$。\n\n作用于 $\\mathbf{v}$ 的完整平流算子 $[(\\mathbf{U}\\cdot\\nabla)]_{\\text{disc}}$ 的傅里叶符号 $\\hat{\\mathcal{L}}(\\mathbf{k})$ 是每个速度分量的标量乘数：\n$$ \\hat{\\mathcal{L}}(\\mathbf{k}) = \\sum_{j=1, U_j0}^d U_j \\frac{1-e^{-i\\theta_j}}{h_j} + \\sum_{j=1, U_j0}^d U_j \\frac{e^{i\\theta_j}-1}{h_j} $$\n我们可以写出 $U_j = |U_j|\\text{sgn}(U_j)$。对于 $U_j0$，该项是 $\\frac{|U_j|}{h_j}(1-e^{-i\\theta_j})$。对于 $U_j0$，该项是 $\\frac{-|U_j|}{h_j}(e^{i\\theta_j}-1) = \\frac{|U_j|}{h_j}(1-e^{i\\theta_j})$。\n这可以紧凑地表示为 $\\frac{|U_j|}{h_j}(1-e^{-i\\theta_j\\text{sgn}(U_j)})$。对所有方向 $j$ 求和：\n$$ \\hat{\\mathcal{L}}(\\mathbf{k}) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - e^{-i\\theta_j\\text{sgn}(U_j)}) $$\n$\\hat{\\mathcal{L}}(\\mathbf{k})$ 的实部和虚部分别是：\n$$ \\text{Re}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1-\\cos(\\theta_j)) $$\n$$ \\text{Im}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}\\text{sgn}(U_j)\\sin(\\theta_j) = \\sum_{j=1}^d \\frac{U_j}{h_j}\\sin(\\theta_j) $$\n\n在傅里叶空间中，投影算子 $\\mathbb{P}$ 由矩阵 $\\hat{\\mathbb{P}}(\\mathbf{k}) = \\mathbf{I} - \\frac{\\mathbf{k}\\otimes\\mathbf{k}}{|\\mathbf{k}|^2}$ 表示，其中 $\\mathbf{I}$ 是单位矩阵。傅里叶变换后的更新规则是：\n$$ \\hat{\\mathbf{v}}^{n+1}(\\mathbf{k}) = \\hat{\\mathbb{P}}(\\mathbf{k})\\left( \\hat{\\mathbf{v}}^n(\\mathbf{k}) - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k}) \\hat{\\mathbf{v}}^n(\\mathbf{k}) \\right) = (1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})) \\hat{\\mathbb{P}}(\\mathbf{k}) \\hat{\\mathbf{v}}^n(\\mathbf{k}) $$\n由于我们正在分析无散分量的稳定性，$\\hat{\\mathbf{v}}^n(\\mathbf{k})$ 位于无散子空间中，这意味着 $\\mathbf{k}\\cdot\\hat{\\mathbf{v}}^n(\\mathbf{k})=0$。根据投影算子 $\\hat{\\mathbb{P}}(\\mathbf{k})$ 的定义，这蕴含了 $\\hat{\\mathbb{P}}(\\mathbf{k})\\hat{\\mathbf{v}}^n(\\mathbf{k}) = \\hat{\\mathbf{v}}^n(\\mathbf{k})$。\n无散模态的更新方程简化为：\n$$ \\hat{\\mathbf{v}}^{n+1}(\\mathbf{k}) = (1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})) \\hat{\\mathbf{v}}^n(\\mathbf{k}) $$\n放大因子是标量 $G(\\mathbf{k}) = 1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$。为了保证稳定性，对于所有可能的波矢量 $\\mathbf{k}$，即对于所有 $\\theta_j \\in [-\\pi, \\pi]$，其模必须不大于1：\n$$ |G(\\mathbf{k})|^2 = |1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})|^2 \\le 1 $$\n令 $z = \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$。稳定性条件 $|1-z| \\le 1$ 要求 $z$ 位于复平面上以 $(1,0)$ 为中心、半径为 $1$ 的圆内。\n我们来分析 $\\hat{\\mathcal{L}}(\\mathbf{k})$ 的值的轨迹。当 $\\theta_j$ 变化时，每一项 $\\frac{|U_j|}{h_j}(1 - e^{-i\\theta_j\\text{sgn}(U_j)})$ 在复平面上描绘一个以 $\\frac{|U_j|}{h_j}$ 为中心、半径为 $\\frac{|U_j|}{h_j}$ 的圆。完整的符号 $\\hat{\\mathcal{L}}(\\mathbf{k})$ 是这些复数的和。\n稳定性分析要求我们找到最严格的条件，这对应于 $\\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$ 轨迹上离稳定区域圆心 $(1,0)$ 最远的点。这是实部最大的点。\n$\\hat{\\mathcal{L}}(\\mathbf{k})$ 的实部是 $\\text{Re}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1-\\cos(\\theta_j))$。当对所有 $j=1, \\dots, d$ 都有 $\\cos(\\theta_j) = -1$ 时，此表达式达到最大值。这发生在所有 $j$ 的高频模态 $\\theta_j = \\pi$ 处。\n在这个“最坏情况”的波矢量下，符号变为：\n$$ \\hat{\\mathcal{L}}_{\\text{worst}} = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - \\cos(\\pi)) + i \\sum_{j=1}^d \\frac{U_j}{h_j}\\sin(\\pi) $$\n$$ \\hat{\\mathcal{L}}_{\\text{worst}} = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - (-1)) + 0 = 2\\sum_{j=1}^d \\frac{|U_j|}{h_j} $$\n这个值是纯实数。该点的稳定性条件是：\n$$ |1 - \\Delta t \\hat{\\mathcal{L}}_{\\text{worst}}| \\le 1 $$\n$$ |1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j}| \\le 1 $$\n由于 $\\Delta t$、 $|U_j|$ 和 $h_j$ 都是非负的，所以项 $2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j}$ 是非负的。该不等式等价于：\n$$ -1 \\le 1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 1 $$\n不等式的右侧，$1 - 2\\Delta t \\sum \\dots \\le 1$，意味着 $-2\\Delta t \\sum \\dots \\le 0$，这总是成立的。\n左侧给出了稳定性约束：\n$$ -1 \\le 1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} $$\n$$ 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 2 $$\n$$ \\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 1 $$\n这就是稳定性条件，被称为多维平流方程使用一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 条件。当等式成立时，得到允许的最大时间步长 $\\Delta t_{\\max}$：\n$$ \\Delta t_{\\max} = \\frac{1}{\\sum_{j=1}^d \\frac{|U_j|}{h_j}} $$\n这个条件不仅是必要的（因为它来自一个特定的模态），而且是充分的。这可以通过注意到 $\\hat{\\mathcal{L}}(\\mathbf{k})$ 所有可能值的轨迹都包含在以 $C = \\sum_{j=1}^d \\frac{|U_j|}{h_j}$ 为中心、半径为 $C$ 的圆内来证明。条件 $\\Delta t C \\le 1$ 确保了缩放后的轨迹 $\\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$ 完全包含在稳定性圆盘 $|z-1|\\le 1$ 内。", "answer": "$$ \\boxed{\\left( \\sum_{j=1}^{d} \\frac{|U_{j}|}{h_{j}} \\right)^{-1}} $$", "id": "3408401"}]}