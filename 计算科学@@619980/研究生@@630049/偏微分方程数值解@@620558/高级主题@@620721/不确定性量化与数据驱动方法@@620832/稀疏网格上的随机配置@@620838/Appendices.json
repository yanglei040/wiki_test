{"hands_on_practices": [{"introduction": "Smolyak稀疏网格方法的核心思想是通过组合一系列低维张量积法则来构建一个高效的高维求积法则。选择哪些张量积组合是该方法的关键，而这一选择正是由“容许指标集”所决定的。本练习将通过一个具体实例，指导您构建一种最常用的容许指标集——总次数指标集 (total-degree index set)，从而掌握稀疏网格构造的组合学基础。[@problem_id:3447814]", "problem": "考虑一个在三个随机维度上具有随机输入的参数化椭圆偏微分方程 (PDE)，其中空间算子和强迫项是固定的，随机性通过参数向量 $\\boldsymbol{\\xi} \\in \\Gamma \\subset \\mathbb{R}^{3}$ 引入。使用分层一维规则构建稀疏网格上的随机配置法，并通过一个由多指标容许集引导的Smolyak型选择来组合张量积子空间。总次数约束规定了多指标集，其多指标的分量之和最多为一个给定的水平。\n\n设容许集定义为\n$$\n\\Lambda^{\\mathrm{TD}}(q,d) := \\left\\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : \\sum_{j=1}^{d} \\alpha_{j} \\le q \\right\\},\n$$\n其中 $d=3$ 且 $q=4$。每个张量积子空间的各向异性水平是与 $\\boldsymbol{\\alpha}$ 的分量相对应的一维分层水平，即 $\\ell_{j} = \\alpha_{j}$ 对 $j \\in \\{1,2,3\\}$ 成立，此时各向异性由总次数（各向同性）约束控制，因此所有方向在求和中权重相等。\n\n从分层水平和容许指标集的核心定义出发，构建 $\\Lambda^{\\mathrm{TD}}(4,3)$ 以及每个 $\\boldsymbol{\\alpha} \\in \\Lambda^{\\mathrm{TD}}(4,3)$ 对应的各向异性水平 $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha}) = (\\alpha_{1},\\alpha_{2},\\alpha_{3})$。然后，计算 $\\Lambda^{\\mathrm{TD}}(4,3)$ 的基数，即容许多指标的总数。\n\n将你的最终答案以单个实数值的形式给出。无需四舍五入。", "solution": "问题要求为随机维度 $d=3$ 和水平 $q=4$ 构建总次数多指标容许集 $\\Lambda^{\\mathrm{TD}}(q,d)$，并计算其基数。\n\n容许集定义为：\n$$\n\\Lambda^{\\mathrm{TD}}(q,d) := \\left\\{ \\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{d} : \\sum_{j=1}^{d} \\alpha_{j} \\le q \\right\\}\n$$\n在这个特定情况下，给定的参数为 $d=3$ 和 $q=4$。因此，该集合为：\n$$\n\\Lambda^{\\mathrm{TD}}(4,3) = \\left\\{ \\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\alpha_3) \\in \\mathbb{N}_{0}^{3} : \\alpha_1 + \\alpha_2 + \\alpha_3 \\le 4 \\right\\}\n$$\n其中 $\\mathbb{N}_{0}$ 表示非负整数集 $\\{0, 1, 2, \\dots\\}$。\n\n问题要求完成三个任务：\n1.  构建集合 $\\Lambda^{\\mathrm{TD}}(4,3)$。\n2.  确定每个 $\\boldsymbol{\\alpha}$ 对应的相关各向异性水平 $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha}) = (\\alpha_1, \\alpha_2, \\alpha_3)$。根据定义，水平向量 $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha})$ 与多指标 $\\boldsymbol{\\alpha}$ 本身是相同的。因此，构建多指标集等价于构建水平向量集。\n3.  计算该集合的基数 $|\\Lambda^{\\mathrm{TD}}(4,3)|$。\n\n为了计算基数，我们需要找到不等式 $\\alpha_1 + \\alpha_2 + \\alpha_3 \\le 4$ 的非负整数解的数量。这是一个经典的组合问题，可以用“隔板法”解决。\n\n我们引入一个非负整数松弛变量 $\\alpha_4 \\ge 0$，将不等式转化为等式：\n$$\n\\alpha_1 + \\alpha_2 + \\alpha_3 + \\alpha_4 = 4\n$$\n现在，不等式的非负整数解 $(\\alpha_1, \\alpha_2, \\alpha_3)$ 的数量等于等式的非负整数解 $(\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4)$ 的数量。\n\n这等价于将 $k=4$ 个不可区分的物品（“星”）分配到 $n=4$ 个可区分的箱子（变量 $\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4$）中。实现这一目标的方法数由多重集系数公式给出：\n$$\n\\binom{k+n-1}{n-1} = \\binom{k+n-1}{k}\n$$\n代入 $k=4$ 和 $n=4$，我们得到：\n$$\n|\\Lambda^{\\mathrm{TD}}(4,3)| = \\binom{4+4-1}{4-1} = \\binom{7}{3}\n$$\n现在我们计算二项式系数的值：\n$$\n\\binom{7}{3} = \\frac{7!}{3!(7-3)!} = \\frac{7!}{3!4!} = \\frac{7 \\times 6 \\times 5 \\times 4!}{ (3 \\times 2 \\times 1) \\times 4!} = \\frac{7 \\times 6 \\times 5}{6} = 35\n$$\n因此，集合 $\\Lambda^{\\mathrm{TD}}(4,3)$ 的基数是 $35$。\n\n为了完成问题的构建部分，我们可以根据其分量之和 $S = \\alpha_1 + \\alpha_2 + \\alpha_3$ 对多指标 $\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\alpha_3)$ 进行分组并系统地列出它们。\n\n对于 $S=0$：\n有 $1$ 个多指标： $(0,0,0)$。\n\n对于 $S=1$：\n有 $\\binom{1+3-1}{3-1} = \\binom{3}{2} = 3$ 个多指标：\n$(1,0,0)$, $(0,1,0)$, $(0,0,1)$。\n\n对于 $S=2$：\n有 $\\binom{2+3-1}{3-1} = \\binom{4}{2} = 6$ 个多指标：\n$(2,0,0)$, $(0,2,0)$, $(0,0,2)$, $(1,1,0)$, $(1,0,1)$, $(0,1,1)$。\n\n对于 $S=3$：\n有 $\\binom{3+3-1}{3-1} = \\binom{5}{2} = 10$ 个多指标：\n$(3,0,0)$, $(0,3,0)$, $(0,0,3)$, $(2,1,0)$, $(2,0,1)$, $(1,2,0)$, $(0,2,1)$, $(1,0,2)$, $(0,1,2)$, $(1,1,1)$。\n\n对于 $S=4$：\n有 $\\binom{4+3-1}{3-1} = \\binom{6}{2} = 15$ 个多指标：\n$(4,0,0)$, $(0,4,0)$, $(0,0,4)$, $(3,1,0)$, $(3,0,1)$, $(1,3,0)$, $(0,3,1)$, $(1,0,3)$, $(0,1,3)$, $(2,2,0)$, $(2,0,2)$, $(0,2,2)$, $(2,1,1)$, $(1,2,1)$, $(1,1,2)$。\n\n多指标的总数是每个可能的和 $S$ 的计数之和：\n$$\n|\\Lambda^{\\mathrm{TD}}(4,3)| = 1 + 3 + 6 + 10 + 15 = 35\n$$\n这个枚举证实了通过隔板法得到的结果。集合 $\\Lambda^{\\mathrm{TD}}(4,3)$ 由这 $35$ 个多指标组成。如前所述，相关的各向异性水平集 $\\boldsymbol{\\ell}(\\boldsymbol{\\alpha})$ 与该多指标集相同。要求的最终答案是该集合的基数。", "answer": "$$\\boxed{35}$$", "id": "3447814"}, {"introduction": "在理解了如何定义稀疏网格的蓝图之后，我们现在将其应用于一个实际问题中，以展示其强大的功能。本练习将引导您走过一个完整的流程：从一个简单的参数化偏微分方程出发，使用随机配置方法来计算其关键输出量（quantity of interest）的期望值。通过这个过程，您将把抽象的网格构造理论与一个具体的科学计算应用联系起来。[@problem_id:3447872]", "problem": "考虑以下定义在空间域 $x \\in (0,1)$ 上的参数化偏微分方程 (PDE) 模型，其具有齐次狄利克雷 (Dirichlet) 边界条件。设参数向量为 $\\boldsymbol{y} = (y_1,y_2) \\in \\Gamma := [-1,1]^2$，并定义在 $\\Gamma$ 上的积测度密度为 $\\rho(\\boldsymbol{y}) = \\frac{1}{4}$。该偏微分方程为\n$$\n-\\frac{d}{dx}\\left( a(\\boldsymbol{y}) \\frac{du(x;\\boldsymbol{y})}{dx} \\right) = 1, \\quad u(0;\\boldsymbol{y}) = 0, \\quad u(1;\\boldsymbol{y}) = 0,\n$$\n其参数化系数为\n$$\na(\\boldsymbol{y}) := 3 + y_1 + y_2,\n$$\n它在 $\\Gamma$ 上是严格为正的。定义感兴趣量\n$$\nQ\\big(u(\\boldsymbol{y})\\big) := \\int_{0}^{1} u(x;\\boldsymbol{y})\\,dx.\n$$\n$Q$ 的均值记为 $\\mathbb{E}[Q]$，其表达式为\n$$\n\\mathbb{E}[Q] = \\int_{\\Gamma} Q\\big(u(\\boldsymbol{y})\\big)\\,\\rho(\\boldsymbol{y})\\,d\\boldsymbol{y}.\n$$\n\n你需要使用稀疏网格上的随机配置法来计算 $\\mathbb{E}[Q]$，该方法通过在维度 $d=2$、总阶数 $L=2$ 的 Smolyak 求积构造实现，并基于以下定义在 $[-1,1]$ 上的（针对勒贝格 (Lebesgue) 测度）一维求积法则构建：\n\n1. 1 阶法则 $Q_1$ 由单个节点 $y=0$ 构成，其权重为 $w=2$。\n2. 2 阶法则 $Q_2$ 是两点高斯-勒让德 (Gauss–Legendre) 法则，节点为 $y=\\pm a$，$a = 1/\\sqrt{3}$，每个节点的权重为 $w=1$。\n\n从分层差分构建阶数为 $L=2$ 的二维 Smolyak 求积，并应用它来近似 $\\mathbb{E}[Q]$。具体而言：\n\n1. 解析求解该 PDE 以获得 $u(x;\\boldsymbol{y})$ 作为 $x$ 和 $\\boldsymbol{y}$ 的函数，然后推导出 $Q\\big(u(\\boldsymbol{y})\\big)$ 关于 $\\boldsymbol{y}$ 的显式表达式。\n2. 根据给定的一维法则，在二维、阶数 $L=2$ 的情况下，从 Smolyak 构造的定义出发，推导用于 $\\Gamma$ 上积分的稀疏网格节点和权重。请仔细地将积测度密度 $\\rho(\\boldsymbol{y})$ 整合到适用于计算均值的求积权重中。\n3. 计算对 $\\mathbb{E}[Q]$ 的基于配置的稀疏网格求积近似值。\n\n将最终结果表示为单个闭式解析表达式。不要进行四舍五入，请提供精确值。", "solution": "### 解题推导\n\n解答过程分三个阶段：首先，我们解析求解 PDE 以找到感兴趣量 (QoI) 的显式表达式；其次，我们构建指定的 Smolyak 求积法则；第三，我们应用该法则来近似 QoI 的期望值。\n\n**1. 感兴趣量的解析表达式**\n\nPDE 方程为：\n$$-\\frac{d}{dx}\\left( a(\\boldsymbol{y}) \\frac{du(x;\\boldsymbol{y})}{dx} \\right) = 1$$\n由于系数 $a(\\boldsymbol{y})$ 不依赖于空间变量 $x$，我们可以对该方程关于 $x$ 进行两次积分。\n第一次积分：\n$$-a(\\boldsymbol{y}) \\frac{du}{dx} = x + C_1$$\n两边除以 $-a(\\boldsymbol{y})$：\n$$\\frac{du}{dx} = -\\frac{1}{a(\\boldsymbol{y})}(x + C_1)$$\n第二次积分：\n$$u(x;\\boldsymbol{y}) = -\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}x^2 + C_1x + C_2\\right)$$\n我们应用齐次狄利克雷边界条件 $u(0;\\boldsymbol{y}) = 0$ 和 $u(1;\\boldsymbol{y}) = 0$ 来确定积分常数 $C_1$ 和 $C_2$。\n从 $u(0;\\boldsymbol{y})=0$ 可得：\n$$-\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}(0)^2 + C_1(0) + C_2\\right) = 0 \\implies C_2 = 0$$\n从 $u(1;\\boldsymbol{y})=0$ 可得：\n$$-\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}(1)^2 + C_1(1)\\right) = 0 \\implies \\frac{1}{2} + C_1 = 0 \\implies C_1 = -\\frac{1}{2}$$\n将常数代回，位移 $u(x;\\boldsymbol{y})$ 的解析解为：\n$$u(x;\\boldsymbol{y}) = -\\frac{1}{a(\\boldsymbol{y})} \\left(\\frac{1}{2}x^2 - \\frac{1}{2}x\\right) = \\frac{x-x^2}{2a(\\boldsymbol{y})}$$\n接下来，我们计算感兴趣量 $Q\\big(u(\\boldsymbol{y})\\big)$：\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\int_{0}^{1} u(x;\\boldsymbol{y})\\,dx = \\int_{0}^{1} \\frac{x-x^2}{2a(\\boldsymbol{y})}\\,dx$$\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\frac{1}{2a(\\boldsymbol{y})} \\left[ \\frac{1}{2}x^2 - \\frac{1}{3}x^3 \\right]_{0}^{1} = \\frac{1}{2a(\\boldsymbol{y})} \\left( \\frac{1}{2} - \\frac{1}{3} \\right) = \\frac{1}{2a(\\boldsymbol{y})} \\left( \\frac{1}{6} \\right) = \\frac{1}{12a(\\boldsymbol{y})}$$\n代入 $a(\\boldsymbol{y}) = 3 + y_1 + y_2$ 的表达式，我们得到作为 $\\boldsymbol{y}$ 的显式函数的 QoI：\n$$Q\\big(u(\\boldsymbol{y})\\big) = \\frac{1}{12(3 + y_1 + y_2)}$$\n我们将此函数记为 $f(\\boldsymbol{y}) \\equiv f(y_1, y_2)$。\n\n**2. Smolyak 求积法则的构建**\n\n任务是近似计算 $\\mathbb{E}[Q] = \\int_{[-1,1]^2} f(\\boldsymbol{y}) \\rho(\\boldsymbol{y}) d\\boldsymbol{y}$，其中 $\\rho(\\boldsymbol{y})=1/4$。这可以写成：\n$$\\mathbb{E}[Q] = \\frac{1}{4} \\int_{-1}^{1} \\int_{-1}^{1} f(y_1, y_2) \\,dy_1 \\,dy_2$$\n我们将使用 Smolyak 稀疏网格来近似勒贝格测度上的积分。在 $d$ 维、阶数 $L$ 的 Smolyak 求积算子 $\\mathcal{A}_{L,d}$ 是由一维法则 $Q_i$ 构建的。一种基于分层差分 $\\Delta_i = Q_i - Q_{i-1}$（其中 $Q_0=0$）的标准构造方法由下式给出：\n$$\\mathcal{A}_{L,d} = \\sum_{|\\boldsymbol{i}|_1 \\leq L+d-1} \\bigotimes_{j=1}^d \\Delta_{i_j}$$\n对于本问题，$L=2$ 且 $d=2$，因此索引集为 $\\{ \\boldsymbol{i}=(i_1, i_2) \\in \\mathbb{N}^2 \\mid i_1+i_2 \\le 2+2-1=3 \\}$。\n所需的项为 $|\\boldsymbol{i}|_1=2$ 和 $|\\boldsymbol{i}|_1=3$ 的情况（因为 $i_j \\ge 1$）：\n- $|\\boldsymbol{i}|_1=2$: $\\boldsymbol{i}=(1,1)$。项：$\\Delta_1 \\otimes \\Delta_1$。\n- $|\\boldsymbol{i}|_1=3$: $\\boldsymbol{i}=(1,2)$ 和 $\\boldsymbol{i}=(2,1)$。项：$\\Delta_1 \\otimes \\Delta_2$ 和 $\\Delta_2 \\otimes \\Delta_1$。\n算子为 $\\mathcal{A}_{2,2} = (\\Delta_1 \\otimes \\Delta_1) + (\\Delta_1 \\otimes \\Delta_2) + (\\Delta_2 \\otimes \\Delta_1)$。\n代入分层差分 $\\Delta_1 = Q_1$ 和 $\\Delta_2 = Q_2 - Q_1$：\n$$\\mathcal{A}_{2,2} = (Q_1 \\otimes Q_1) + (Q_1 \\otimes (Q_2 - Q_1)) + ((Q_2 - Q_1) \\otimes Q_1)$$\n$$\\mathcal{A}_{2,2} = Q_1 \\otimes Q_1 + Q_1 \\otimes Q_2 - Q_1 \\otimes Q_1 + Q_2 \\otimes Q_1 - Q_1 \\otimes Q_1$$\n$$\\mathcal{A}_{2,2} = (Q_1 \\otimes Q_2) + (Q_2 \\otimes Q_1) - (Q_1 \\otimes Q_1)$$\n这就是维度 $d=2$、阶数 $L=2$ 的 Smolyak 求积法则。让我们将此法则应用于函数 $f(\\boldsymbol{y})$。\n- $Q_1[g] = 2g(0)$.\n- $Q_2[g] = g(-a) + g(a)$, 其中 $a=1/\\sqrt{3}$.\n张量积项为：\n- $(Q_1 \\otimes Q_1)[f] = Q_1[Q_1[f(y_1, y_2)]_{y_2}]_{y_1} = Q_1[2f(y_1, 0)]_{y_1} = 2(2f(0,0)) = 4f(0,0)$.\n- $(Q_1 \\otimes Q_2)[f] = Q_1[Q_2[f(y_1, y_2)]_{y_2}]_{y_1} = Q_1[f(y_1, -a) + f(y_1, a)]_{y_1} = 2(f(0, -a) + f(0, a))$.\n- $(Q_2 \\otimes Q_1)[f] = Q_2[Q_1[f(y_1, y_2)]_{y_2}]_{y_1} = Q_2[2f(y_1, 0)]_{y_1} = 2(f(-a, 0) + f(a, 0))$.\n将这些项组合起来，得到 Smolyak 法则：\n$$\\mathcal{A}_{2,2}[f] = 2(f(0, -a) + f(0, a)) + 2(f(-a, 0) + f(a, 0)) - 4f(0,0)$$\n用于勒贝格积分的稀疏网格由以下节点和权重组成：\n- 节点：$(0, -1/\\sqrt{3})$, $(0, 1/\\sqrt{3})$, $(-1/\\sqrt{3}, 0)$, $(1/\\sqrt{3}, 0)$。每个节点的权重为 $2$。\n- 节点：$(0,0)$。该节点的权重为 $-4$。\n\n**3. 均值 QoI 近似的计算**\n\n我们现在在稀疏网格节点上计算 $f(y_1, y_2) = \\frac{1}{12(3 + y_1 + y_2)}$ 的值，其中 $a=1/\\sqrt{3}$。\n- $f(0,0) = \\frac{1}{12(3 + 0 + 0)} = \\frac{1}{36}$.\n- $f(a,0) = f(1/\\sqrt{3}, 0) = \\frac{1}{12(3 + 1/\\sqrt{3})}$.\n- $f(-a,0) = f(-1/\\sqrt{3}, 0) = \\frac{1}{12(3 - 1/\\sqrt{3})}$.\n- $f(0,a) = f(0, 1/\\sqrt{3}) = \\frac{1}{12(3 + 1/\\sqrt{3})}$.\n- $f(0,-a) = f(0, -1/\\sqrt{3}) = \\frac{1}{12(3 - 1/\\sqrt{3})}$.\n\n将这些值代入求积公式 $\\mathcal{A}_{2,2}[f]$：\n$$\\mathcal{A}_{2,2}[f] = 2\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 2\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) - 4\\left(\\frac{1}{36}\\right)$$\n$$\\mathcal{A}_{2,2}[f] = 4\\left(\\frac{1}{12(3 - 1/\\sqrt{3})}\\right) + 4\\left(\\frac{1}{12(3 + 1/\\sqrt{3})}\\right) - \\frac{4}{36}$$\n$$\\mathcal{A}_{2,2}[f] = \\frac{1}{3}\\left(\\frac{1}{3 - 1/\\sqrt{3}} + \\frac{1}{3 + 1/\\sqrt{3}}\\right) - \\frac{1}{9}$$\n我们通过通分来简化括号中的项：\n$$\\frac{1}{3 - 1/\\sqrt{3}} + \\frac{1}{3 + 1/\\sqrt{3}} = \\frac{(3 + 1/\\sqrt{3}) + (3 - 1/\\sqrt{3})}{(3 - 1/\\sqrt{3})(3 + 1/\\sqrt{3})} = \\frac{6}{3^2 - (1/\\sqrt{3})^2} = \\frac{6}{9 - 1/3} = \\frac{6}{26/3} = \\frac{18}{26} = \\frac{9}{13}$$\n将此结果代回 $\\mathcal{A}_{2,2}[f]$ 的表达式中：\n$$\\mathcal{A}_{2,2}[f] = \\frac{1}{3}\\left(\\frac{9}{13}\\right) - \\frac{1}{9} = \\frac{3}{13} - \\frac{1}{9} = \\frac{3 \\cdot 9 - 13 \\cdot 1}{117} = \\frac{27 - 13}{117} = \\frac{14}{117}$$\n这是积分 $\\int_{[-1,1]^2} f(\\boldsymbol{y}) d\\boldsymbol{y}$ 的近似值。期望值 $\\mathbb{E}[Q]$ 的近似值为：\n$$\\mathbb{E}[Q] \\approx \\frac{1}{4} \\mathcal{A}_{2,2}[f] = \\frac{1}{4} \\left(\\frac{14}{117}\\right) = \\frac{7}{2 \\cdot 117} = \\frac{7}{234}$$\n这就是最终的闭式解析结果。", "answer": "$$\n\\boxed{\\frac{7}{234}}\n$$", "id": "3447872"}, {"introduction": "我们刚刚练习中使用的标准稀疏网格对所有参数维度同等看待，但这在许多实际问题中并非最高效的策略。为了提高计算效率，自适应方法应运而生。本练习将向您介绍“分层盈余”(hierarchical surpluses)这一核心概念，它在高维近似中充当局部误差的指示器。通过亲手计算这些盈余，您将深刻理解自适应算法是如何识别并优先处理最重要的参数维度，从而构建出更为精确和高效的稀疏网格。[@problem_id:3447815]", "problem": "考虑一个一维参数响应函数 $f(y)$，它源于一个带有单个不确定输入 $y \\in [-1,1]$ 的仿射参数化的强制线性偏微分方程 (PDE)。假设从 $y$ 到目标量的映射是解析的，并且为了本练习的目的，设 $f(y) = \\exp(y)$。在使用嵌套 Clenshaw–Curtis (CC) 横坐标点的稀疏网格随机配置法中，区间 $[-1,1]$ 上的 $\\ell$ 级节点集嵌套如下：\n- 1 级：$\\{0\\}$，\n- 2 级：$\\{-1,0,1\\}$，\n- 3 级：$\\{-1,-1/\\sqrt{2},0,1/\\sqrt{2},1\\}$。\n\n定义 $\\ell$ 级节点 $y$ 处的分层余量为 $s_{\\ell}(y) = f(y) - I_{\\ell-1}[f](y)$，其中 $I_{\\ell-1}[f]$ 是使用从 1 级到 $\\ell-1$ 级的所有节点构建的唯一插值多项式。\n\n任务：\n1. 构建 $I_{0}[f]$ 并计算 $s_{1}(0)$。\n2. 构建 $I_{1}[f]$ 并计算 $s_{2}(-1)$ 和 $s_{2}(1)$。\n3. 使用 2 级节点 $\\{-1,0,1\\}$ 构建 $I_{2}[f]$ 并计算 $s_{3}(-1/\\sqrt{2})$ 和 $s_{3}(1/\\sqrt{2})$。\n4. 使用计算出的余量，确定在 1、2 和 3 级所有新增节点中最大的分层余量绝对值。\n\n将最大的分层余量绝对值作为精确解析表达式报告为您的最终答案。无需四舍五入，不涉及物理单位。在您的解题过程中简要解释在稀疏网格配置设置中，余量的大小如何指导加密决策。", "solution": "该问题要求计算函数 $f(y) = \\exp(y)$ 在一系列嵌套 Clenshaw-Curtis 网格上的分层余量，并找出最大的余量绝对值。$\\ell$ 级节点 $y$ 处的分层余量定义为 $s_{\\ell}(y) = f(y) - I_{\\ell-1}[f](y)$，其中 $I_{\\ell-1}[f]$ 是使用截至 $\\ell-1$ 级的所有节点构建的插值多项式。函数为 $f(y) = \\exp(y)$，定义域为 $y \\in [-1,1]$。\n\n该过程分为四个任务。\n\n**任务 1：构建 $I_{0}[f]$ 并计算 $s_{1}(0)$**\n插值多项式 $I_{0}[f]$ 是使用从 1 级到 0 级的节点构建的，这是一个空集。按照惯例，空节点集上的插值多项式为零多项式。\n因此，$I_{0}[f](y) = 0$。\n在 $\\ell=1$ 级新增的单个节点是 $y_1 = 0$。\n此节点的分层余量为：\n$$s_{1}(0) = f(0) - I_{0}[f](0) = \\exp(0) - 0 = 1$$\n\n**任务 2：构建 $I_{1}[f]$ 并计算 $s_{2}(-1)$ 和 $s_{2}(1)$**\n插值多项式 $I_{1}[f]$ 是使用 1 级的节点，即集合 $\\{0\\}$ 构建的。在 $y=0$ 处对 $f(y)$ 进行插值的 0 次多项式是一个与该点函数值相匹配的常数函数。\n插值点为 $(0, f(0)) = (0, \\exp(0)) = (0,1)$。\n因此，插值多项式为 $I_{1}[f](y) = 1$。\n在 $\\ell=2$ 级新增的节点是 $\\{-1, 1\\}$。我们计算这些节点上的余量：\n对于 $y=-1$：\n$$s_{2}(-1) = f(-1) - I_{1}[f](-1) = \\exp(-1) - 1$$\n对于 $y=1$：\n$$s_{2}(1) = f(1) - I_{1}[f](1) = \\exp(1) - 1$$\n\n**任务 3：构建 $I_{2}[f]$ 并计算 $s_{3}(-1/\\sqrt{2})$ 和 $s_{3}(1/\\sqrt{2})$**\n插值多项式 $I_{2}[f]$ 是使用 1 级和 2 级的节点构建的。这些节点集的并集是 2 级节点集 $\\{-1, 0, 1\\}$。我们需要找到穿过点 $(-1, f(-1))$, $(0, f(0))$ 和 $(1, f(1))$ 的次数最多为 2 的唯一多项式。\n这些点是 $(-1, \\exp(-1))$, $(0, 1)$ 和 $(1, \\exp(1))$。\n设插值多项式为 $I_{2}[f](y) = ay^2 + by + c$。\n使用点 $(0,1)$：\n$$I_{2}[f](0) = c = 1$$\n使用点 $(1, \\exp(1))$ 和 $(-1, \\exp(-1))$：\n\\begin{align*} a(1)^2 + b(1) + 1 = \\exp(1) \\implies a+b = \\exp(1) - 1 \\\\ a(-1)^2 + b(-1) + 1 = \\exp(-1) \\implies a-b = \\exp(-1) - 1 \\end{align*}\n这是一个关于 $a$ 和 $b$ 的二元线性方程组。两方程相加得到：\n$$2a = \\exp(1) + \\exp(-1) - 2 \\implies a = \\frac{\\exp(1) + \\exp(-1)}{2} - 1 = \\cosh(1) - 1$$\n第一个方程减去第二个方程得到：\n$$2b = \\exp(1) - \\exp(-1) \\implies b = \\frac{\\exp(1) - \\exp(-1)}{2} = \\sinh(1)$$\n因此插值多项式为 $I_{2}[f](y) = (\\cosh(1)-1)y^2 + \\sinh(1)y + 1$。\n在 $\\ell=3$ 级新增的节点是 $\\{-1/\\sqrt{2}, 1/\\sqrt{2}\\}$。我们计算这些点上的余量。\n对于 $y = 1/\\sqrt{2}$：\n\\begin{align*} s_{3}\\left(\\frac{1}{\\sqrt{2}}\\right) = f\\left(\\frac{1}{\\sqrt{2}}\\right) - I_{2}[f]\\left(\\frac{1}{\\sqrt{2}}\\right) \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\left[ (\\cosh(1)-1)\\left(\\frac{1}{\\sqrt{2}}\\right)^2 + \\sinh(1)\\left(\\frac{1}{\\sqrt{2}}\\right) + 1 \\right] \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\left[ \\frac{1}{2}(\\cosh(1)-1) + \\frac{1}{\\sqrt{2}}\\sinh(1) + 1 \\right] \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{2} - \\frac{1}{\\sqrt{2}}\\sinh(1) - 1 \\\\ = \\exp\\left(\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) - \\frac{1}{\\sqrt{2}}\\sinh(1) - \\frac{1}{2} \\end{align*}\n对于 $y = -1/\\sqrt{2}$：\n\\begin{align*} s_{3}\\left(-\\frac{1}{\\sqrt{2}}\\right) = f\\left(-\\frac{1}{\\sqrt{2}}\\right) - I_{2}[f]\\left(-\\frac{1}{\\sqrt{2}}\\right) \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\left[ (\\cosh(1)-1)\\left(-\\frac{1}{\\sqrt{2}}\\right)^2 + \\sinh(1)\\left(-\\frac{1}{\\sqrt{2}}\\right) + 1 \\right] \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\left[ \\frac{1}{2}(\\cosh(1)-1) - \\frac{1}{\\sqrt{2}}\\sinh(1) + 1 \\right] \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{2} + \\frac{1}{\\sqrt{2}}\\sinh(1) - 1 \\\\ = \\exp\\left(-\\frac{1}{\\sqrt{2}}\\right) - \\frac{1}{2}\\cosh(1) + \\frac{1}{\\sqrt{2}}\\sinh(1) - \\frac{1}{2} \\end{align*}\n\n**任务 4：确定最大的分层余量绝对值**\n我们比较在每个级别的新增节点上计算出的余量的绝对值。\n- 1 级余量：$|s_1(0)| = |1| = 1$。\n- 2 级余量：\n  - $|s_2(-1)| = |\\exp(-1) - 1| = 1 - \\exp(-1)$。由于 $\\exp(-1) \\approx 0.368$，该值约为 $0.632$。\n  - $|s_2(1)| = |\\exp(1) - 1| = \\exp(1) - 1$。由于 $\\exp(1) \\approx 2.718$，该值约为 $1.718$。\n- 3 级余量：$s_3$ 的表达式代表了二次多项式的插值误差。对于像 $\\exp(y)$ 这样的解析函数，随着插值多项式次数的增加，这个误差会迅速减小。$s_3(\\pm 1/\\sqrt{2})$ 的量级明显小于 2 级余量的量级。例如，$I_2[f](y)$ 的插值误差由 $\\frac{f'''(\\xi)}{3!}y(y^2-1) = \\frac{\\exp(\\xi)}{6}y(y^2-1)$ 给出。在 $y=1/\\sqrt{2}$ 处，对于某个 $\\xi \\in (-1, 1/\\sqrt{2})$，该误差为 $-\\frac{\\exp(\\xi)}{12\\sqrt{2}}$，这是一个很小的值。\n比较计算出的值：\n$$ |s_2(1)| = \\exp(1) - 1 \\approx 1.718 $$\n$$ |s_1(0)| = 1 $$\n$$ |s_2(-1)| = 1 - \\exp(-1) \\approx 0.632 $$\n$|s_3(\\pm 1/\\sqrt{2})|$ 的值还要更小。在所有计算出的余量中，最大的绝对值显然是 $|s_2(1)| = \\exp(1) - 1$。\n\n在自适应稀疏网格配置法中，分层余量的大小是一个关键的误差指示器。在网格构建的每个阶段，都会在新增的节点上计算余量。较大的余量值表示当前多项式逼近效果不佳的区域（或在高维情况下，方向）。自适应算法利用此信息，在表现出最大余量的维度中优先添加新的网格点（及相应的基函数）。这种策略确保计算精力集中在最需要减少整体逼近误差的地方，从而实现比非自适应方法高效得多的收敛。", "answer": "$$\\boxed{\\exp(1) - 1}$$", "id": "3447815"}]}