{"hands_on_practices": [{"introduction": "我们从一个基准问题开始。本练习使用一个典型的模型问题——一维泊松方程——来研究最简单的对角预条件子，即雅可比方法。通过精确推导其特征值，你将揭示这种方法在处理特定结构化矩阵时的一个根本性局限 [@problem_id:3412279]，从而理解为何需要更先进的技术。", "problem": "考虑一维泊松方程 $-u''(x) = f(x)$，其定义在区间 $(0,1)$ 上，并满足狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。用 $n$ 个内网格点对该区间进行离散，网格点位置为 $x_i = i h$，其中 $i=1,2,\\dots,n$，且 $h = \\frac{1}{n+1}$。对 $-u''(x)$ 使用标准的二阶中心有限差分近似，可以得到一个线性系统 $A \\, \\mathbf{u} = \\mathbf{b}$，其中 $\\mathbf{u} \\in \\mathbb{R}^{n}$，而 $A \\in \\mathbb{R}^{n \\times n}$ 是一个三对角矩阵，其元素为 $A_{ii} = \\frac{2}{h^{2}}$ 和 $A_{i,i\\pm1} = -\\frac{1}{h^{2}}$。令 $D$ 表示 $A$ 的对角部分。定义雅可比预处理算子为 $D^{-1} A$。\n\n从第一性原理出发——即 $A$ 的有限差分构造以及线性算子的特征值和特征向量的定义——推导 $A$ 和 $D^{-1} A$ 的特征值。然后，使用这些特征值来评估雅可比预处理对渐近二范数条件数的影响。具体来说，计算以下表达式的精确值：\n$$\n\\lim_{n \\to \\infty} \\frac{\\kappa_{2}\\!\\left(D^{-1} A\\right)}{\\kappa_{2}(A)} \\, ,\n$$\n其中 $\\kappa_{2}$ 表示对称正定矩阵的二范数条件数，定义为最大特征值与最小特征值之比。\n\n将最终答案表示为单个实数。无需四舍五入。", "solution": "问题陈述需要进行验证。\n\n### 步骤 1：提取已知条件\n-   **方程**：一维泊松方程 $-u''(x) = f(x)$，在区间 $(0,1)$ 上。\n-   **边界条件**：狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n-   **离散化**：$n$ 个内网格点，位置为 $x_i = i h$，$i=1,2,\\dots,n$，其中网格间距为 $h = \\frac{1}{n+1}$。\n-   **有限差分近似**：对 $-u''(x)$ 采用标准的二阶中心有限差分。\n-   **线性系统**：$A \\, \\mathbf{u} = \\mathbf{b}$，其中 $\\mathbf{u} \\in \\mathbb{R}^{n}$ 且 $A \\in \\mathbb{R}^{n \\times n}$。\n-   **矩阵 A**：三对角矩阵，其元素为 $A_{ii} = \\frac{2}{h^{2}}$ 和 $A_{i,i\\pm1} = -\\frac{1}{h^{2}}$。\n-   **预处理器**：$D$ 定义为 $A$ 的对角部分。\n-   **预处理算子**：$D^{-1} A$。\n-   **条件数**：对于一个对称正定矩阵 $M$，$\\kappa_{2}(M)$ 定义为其最大特征值与最小特征值之比，即 $\\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)}$。\n-   **目标**：计算极限 $\\lim_{n \\to \\infty} \\frac{\\kappa_{2}(D^{-1} A)}{\\kappa_{2}(A)}$ 的精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于偏微分方程数值分析的基本原理。泊松方程的有限差分离散化是该领域的经典例子。问题设置是自洽的，提供了所有必要的定义和数据。矩阵 $A$ 是一个著名的对称正定（SPD）矩阵，因此其特征值是实数且为正，其条件数是良定义的。对角矩阵 $D$ 的元素为正，因此是可逆的。预处理矩阵 $D^{-1}A$ 是 $D^{-1} = \\frac{h^2}{2}I$（一个 SPD 矩阵）和 $A$（一个 SPD 矩阵）的乘积。正如我们将看到的，$D^{-1}A$ 是 $A$ 的一个标量倍，因此也是 SPD。该问题是良构的、客观的，并且没有违反任何无效标准。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个完整且有理有据的解答。\n\n行动方案是推导矩阵 $A$ 和预处理矩阵 $D^{-1}A$ 的特征值，计算它们各自的条件数，并评估它们比率的极限。\n\n首先，我们确定矩阵 $A$ 的特征值。矩阵 $A$ 由负二阶导数算子的有限差分近似定义。对于在点 $x_j$ 上定义的网格函数 $v_j$，特征值问题 $A\\mathbf{v} = \\lambda \\mathbf{v}$ 对应于以下差分方程组：\n$$\n\\frac{1}{h^2}(-v_{j-1} + 2v_j - v_{j+1}) = \\lambda v_j, \\quad \\text{for } j = 1, 2, \\dots, n.\n$$\n狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$ 意味着特征向量 $\\mathbf{v}$ 的分量满足 $v_0 = 0$ 和 $v_{n+1}=0$。该差分方程可以改写为：\n$$\n2v_j - (v_{j-1} + v_{j+1}) = (\\lambda h^2) v_j.\n$$\n我们寻找形式为 $v_j = \\sin(j\\theta)$ 的解，其中 $\\theta$ 是某个参数。这种形式自动满足边界条件 $v_0=0$。将此代入差分方程，得到：\n$$\n2\\sin(j\\theta) - (\\sin((j-1)\\theta) + \\sin((j+1)\\theta)) = (\\lambda h^2) \\sin(j\\theta).\n$$\n使用三角和差化积恒等式 $\\sin(\\alpha - \\beta) + \\sin(\\alpha + \\beta) = 2\\sin(\\alpha)\\cos(\\beta)$，表达式简化为：\n$$\n2\\sin(j\\theta) - 2\\sin(j\\theta)\\cos(\\theta) = (\\lambda h^2) \\sin(j\\theta).\n$$\n对于一个非平凡特征向量，$\\sin(j\\theta)$ 不恒为零，所以我们可以用它来除，从而得到关于特征值 $\\lambda$ 的关系式：\n$$\n2(1 - \\cos(\\theta)) = \\lambda h^2.\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$，上式变为：\n$$\n4\\sin^2\\left(\\frac{\\theta}{2}\\right) = \\lambda h^2.\n$$\n第二个边界条件 $v_{n+1}=0$ 要求 $\\sin((n+1)\\theta) = 0$。这意味着 $(n+1)\\theta = k\\pi$，其中 $k$ 为整数。为了得到 $n$ 个线性无关的特征向量，我们取 $k = 1, 2, \\dots, n$。这将参数 $\\theta$ 量化为值 $\\theta_k = \\frac{k\\pi}{n+1}$。\n代入这些 $\\theta_k$ 的值，得到 $A$ 的 $n$ 个不同特征值：\n$$\n\\lambda_k(A) = \\frac{4}{h^2} \\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad \\text{for } k=1, 2, \\dots, n.\n$$\n由于当 $x \\in (0, \\pi/2]$ 时，$\\sin^2(x) > 0$，所有特征值均为正，这证实了 $A$ 是正定的。\n\n条件数 $\\kappa_2(A)$ 是最大特征值与最小特征值之比。正弦函数在 $[0, \\pi/2]$ 上是单调递增的。$k=1, \\dots, n$ 时，参数 $\\frac{k\\pi}{2(n+1)}$ 在此范围内。\n最小特征值 $\\lambda_{\\min}(A)$ 对应于 $k=1$：\n$$\n\\lambda_{\\min}(A) = \\lambda_1(A) = \\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n最大特征值 $\\lambda_{\\max}(A)$ 对应于 $k=n$：\n$$\n\\lambda_{\\max}(A) = \\lambda_n(A) = \\frac{4}{h^2} \\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right).\n$$\n因此，$A$ 的条件数为：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} = \\frac{\\frac{4}{h^2} \\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)}.\n$$\n\n接下来，我们分析预处理矩阵 $D^{-1}A$。矩阵 $D$ 是 $A$ 的对角部分。根据问题陈述，$A$ 的所有对角元素都相同：$A_{ii} = \\frac{2}{h^2}$。因此，$D$ 是单位矩阵 $I_n$ 的一个标量倍：\n$$\nD = \\frac{2}{h^2} I_n.\n$$\n其逆矩阵就是：\n$$\nD^{-1} = \\left(\\frac{2}{h^2} I_n\\right)^{-1} = \\frac{h^2}{2} I_n.\n$$\n预处理矩阵为：\n$$\nD^{-1}A = \\left(\\frac{h^2}{2} I_n\\right) A = \\frac{h^2}{2} A.\n$$\n由于 $D^{-1}A$ 是 $A$ 的一个标量倍，它的特征向量与 $A$ 的特征向量相同。如果 $\\mathbf{v}_k$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda_k(A)$，那么：\n$$\n(D^{-1}A)\\mathbf{v}_k = \\left(\\frac{h^2}{2}A\\right)\\mathbf{v}_k = \\frac{h^2}{2}(A\\mathbf{v}_k) = \\frac{h^2}{2}\\lambda_k(A)\\mathbf{v}_k.\n$$\n$D^{-1}A$ 的特征值（我们记为 $\\mu_k$）是 $\\mu_k = \\frac{h^2}{2}\\lambda_k(A)$。\n$D^{-1}A$ 的极端特征值为：\n$$\n\\lambda_{\\min}(D^{-1}A) = \\mu_1 = \\frac{h^2}{2}\\lambda_{\\min}(A).\n$$\n$$\n\\lambda_{\\max}(D^{-1}A) = \\mu_n = \\frac{h^2}{2}\\lambda_{\\max}(A).\n$$\n预处理矩阵 $D^{-1}A$ 的条件数为：\n$$\n\\kappa_2(D^{-1}A) = \\frac{\\lambda_{\\max}(D^{-1}A)}{\\lambda_{\\min}(D^{-1}A)} = \\frac{\\frac{h^2}{2}\\lambda_{\\max}(A)}{\\frac{h^2}{2}\\lambda_{\\min}(A)} = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} = \\kappa_2(A).\n$$\n这表明，对于由常系数一维泊松问题产生的特定矩阵 $A$，雅可比预处理器对条件数没有影响。原因在于 $A$ 的对角线是常数，这使得预处理器只是对系统进行简单的缩放。\n\n最后，我们计算所求的极限。我们需要计算的是：\n$$\n\\lim_{n \\to \\infty} \\frac{\\kappa_{2}(D^{-1} A)}{\\kappa_{2}(A)}.\n$$\n既然我们已经确定对于任何 $n \\ge 1$ 都有 $\\kappa_2(D^{-1}A) = \\kappa_2(A)$，那么这个比率恒等于 $1$：\n$$\n\\frac{\\kappa_{2}(D^{-1} A)}{\\kappa_{2}(A)} = 1.\n$$\n常数序列的极限就是常数本身。因此：\n$$\n\\lim_{n \\to \\infty} \\frac{\\kappa_{2}(D^{-1} A)}{\\kappa_{2}(A)} = \\lim_{n \\to \\infty} 1 = 1.\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3412279"}, {"introduction": "在雅可比方法分析的基础上，我们现在转向一个更强大的技术：对称逐次超松弛（SSOR）预条件。本练习要求你使用局部模态分析方法，探讨松弛因子 $\\omega$ 如何影响预条件后算子的谱分布 [@problem_id:3412246]。这个理论练习将展示如何通过仔细的参数选择，显著提升预条件子的效率。", "problem": "考虑区间 $(0,1)$ 上的一维泊松方程 $-u''(x) = f(x)$，其具有齐次狄利克雷边界条件 $u(0) = u(1) = 0$。在一个具有 $n$ 个内点和网格宽度 $h = \\frac{1}{n+1}$ 的均匀网格上，使用标准的二阶中心有限差分法，得到的线性系统为 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定三对角矩阵，其元素由 $A_{ii} = \\frac{2}{h^2}$ 和 $A_{i,i\\pm 1} = -\\frac{1}{h^2}$ 给出。为了进行预处理，使用雅可比分裂 $A = D - L - U$，其中 $D = \\frac{2}{h^2} I$，$L$ 是严格下三角部分，其元素为 $L_{i,i-1} = \\frac{1}{h^2}$，$U$ 是严格上三角部分，其元素为 $U_{i,i+1} = \\frac{1}{h^2}$。对于松弛参数 $\\omega \\in (0,2)$，定义对称逐次超松弛 (SSOR) 预条件子 $M_{\\mathrm{SSOR}}(\\omega)$ 为\n$$\nM_{\\mathrm{SSOR}}(\\omega) = (D - \\omega L) D^{-1} (D - \\omega U).\n$$\n请注意，在实践中经常使用 $M_{\\mathrm{SSOR}}(\\omega)$ 的一个正常数倍，但这种缩放不影响预处理系统的谱条件数。对称正定矩阵 $B$ 的谱条件数定义为 $\\kappa(B) = \\frac{\\lambda_{\\max}(B)}{\\lambda_{\\min}(B)}$，其中 $\\lambda_{\\max}(B)$ 和 $\\lambda_{\\min}(B)$ 分别表示 $B$ 的最大和最小特征值。\n\n利用 $A$ 是由一个常系数最近邻模板生成以及针对托普利茨算子的标准基于符号的局部模态分析，推导预处理算子 $M_{\\mathrm{SSOR}}(\\omega)^{-1} A$ 的特征值作为模态角 $\\theta \\in (0,\\pi)$ 函数的依赖于模态的表达式，并用此为具有 $n$ 个内点的有限狄利克雷问题的 $M_{\\mathrm{SSOR}}(\\omega)^{-1} A$ 的条件数构造一个显式上界。然后，分析松弛参数 $\\omega$ 如何影响此上界，并确定在极限意义下使该界最小化的 $\\omega \\in (0,2)$ 的值，以及相应的最小界本身。将您的最终答案表示为一个包含以下内容对：\n- 极限最优松弛参数 $\\omega$，以及\n- 在该极限下 $\\kappa(M_{\\mathrm{SSOR}}(\\omega)^{-1} A)$ 可达到的最小上界。\n无需四舍五入，您应提供精确值。将您的最终对报告为单行矩阵。", "solution": "用户要求对一维泊松方程的有限差分离散化所用的对称逐次超松弛 (SSOR) 预条件子进行分析。\n\n### 步骤 1：提取已知条件\n-   **方程**：$-u''(x) = f(x)$ on $(0,1)$。\n-   **边界条件**：$u(0) = u(1) = 0$。\n-   **离散化**：在具有 $n$ 个内点的均匀网格上采用二阶中心有限差分。\n-   **网格宽度**：$h = \\frac{1}{n+1}$。\n-   **线性系统**：$A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵。\n-   **矩阵 A 的元素**：$A_{ii} = \\frac{2}{h^2}$，$A_{i,i\\pm 1} = -\\frac{1}{h^2}$。\n-   **矩阵分裂**：$A = D - L - U$，其中 $D = \\frac{2}{h^2} I$，$L$ 是严格下三角部分，其元素为 $L_{i,i-1} = \\frac{1}{h^2}$，$U$ 是严格上三角部分，其元素为 $U_{i,i+1} = \\frac{1}{h^2}$。注意，按照这个定义，$A=D-L-U$ 是正确的。一个标准的分裂是 $A=D-L-L^T$，其中 $L$ 是 $A$ 的严格下三角部分的*负值*。鉴于问题陈述 $A_{i,i\\pm 1} = -1/h^2$ 以及 $L_{i,i-1}=1/h^2$、$U_{i,i+1}=1/h^2$，关系式应为 $A=D-L-U$。让我们继续使用所提供的定义。\n-   **SSOR 预条件子**：$M_{\\mathrm{SSOR}}(\\omega) = (D - \\omega L) D^{-1} (D - \\omega U)$，对于 $\\omega \\in (0,2)$。\n-   **分析方法**：针对托普利茨算子的基于符号的局部模态分析。\n-   **任务**：\n    1.  推导预处理算子 $M_{\\mathrm{SSOR}}(\\omega)^{-1} A$ 的特征值作为模态角 $\\theta$ 的函数。\n    2.  构造条件数 $\\kappa(M_{\\mathrm{SSOR}}(\\omega)^{-1} A)$ 的显式上界。\n    3.  确定使此界最小化的极限最优松弛参数 $\\omega$ 并找到相应的最小界。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是数值线性代数和偏微分方程数值解中的一个标准课题。所用方法和概念（有限差分、SSOR、局部模态分析）都是成熟的。\n-   **良态**：问题陈述清晰，并提供了进行指定分析技术所需的所有定义。在局部模态分析的框架内存在唯一解。\n-   **客观性**：语言精确且数学化。\n\n该问题陈述是一个自洽且数学上严谨的练习。使用基于符号的分析的指令为求解提供了一条清晰的路径，尽管众所周知这种方法对于有限的非循环矩阵是一种忽略边界效应的近似。该问题是应用此特定分析技术的有效测试。\n\n### 步骤 3：结论与行动\n问题被认为是有效的。我现在将进行求解。\n\n### 求解推导\n\n我们通过检验离散算子对傅里叶模态 $v_j = \\exp(i j \\theta)$ 的作用来进行基于符号的局部模态分析（也称为局部傅里叶分析），其中 $j$ 是网格索引，$\\theta \\in (0, \\pi)$ 是模态角。一个算子的符号是该算子作用于模态后乘以模态的因子。\n\n1.  **矩阵算子的符号**：\n    -   **算子 A**：$A$ 的模板是 $\\frac{1}{h^2}(-1, 2, -1)$。将其应用于 $v_j$：\n        $A v_j = \\frac{1}{h^2} (-v_{j-1} + 2v_j - v_{j+1}) = \\frac{1}{h^2} (-\\exp(-i\\theta) + 2 - \\exp(i\\theta)) v_j = \\frac{1}{h^2}(2 - 2\\cos\\theta) v_j$。\n        $A$ 的符号是 $\\hat{A}(\\theta) = \\frac{2}{h^2}(1 - \\cos\\theta) = \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2})$。\n    -   **算子 D**：$D = \\frac{2}{h^2}I$。符号是一个常数：$\\hat{D}(\\theta) = \\frac{2}{h^2}$。\n    -   **算子 L**：$L$ 的模板是 $\\frac{1}{h^2}(1, 0, 0)$，作用于索引 $j-1$。\n        $L v_j = \\frac{1}{h^2} v_{j-1} = \\frac{1}{h^2} \\exp(-i\\theta) v_j$。\n        $L$ 的符号是 $\\hat{L}(\\theta) = \\frac{1}{h^2}\\exp(-i\\theta)$。\n    -   **算子 U**：$U$ 的模板是 $\\frac{1}{h^2}(0, 0, 1)$，作用于索引 $j+1$。\n        $U v_j = \\frac{1}{h^2} v_{j+1} = \\frac{1}{h^2} \\exp(i\\theta) v_j$。\n        $U$ 的符号是 $\\hat{U}(\\theta) = \\frac{1}{h^2}\\exp(i\\theta)$。\n\n2.  **SSOR 预条件子的符号**：\n    算子的乘积或和的符号是它们各自符号的乘积或和。\n    $\\hat{M}_{\\mathrm{SSOR}}(\\omega)(\\theta) = (\\hat{D}(\\theta) - \\omega \\hat{L}(\\theta)) (\\hat{D}(\\theta))^{-1} (\\hat{D}(\\theta) - \\omega \\hat{U}(\\theta))$。\n    $\\hat{M}_{\\mathrm{SSOR}}(\\omega)(\\theta) = (\\frac{2}{h^2} - \\frac{\\omega}{h^2}\\exp(-i\\theta)) (\\frac{h^2}{2}) (\\frac{2}{h^2} - \\frac{\\omega}{h^2}\\exp(i\\theta))$\n    $= \\frac{1}{h^2}(2 - \\omega\\exp(-i\\theta)) (\\frac{1}{2}) (2 - \\omega\\exp(i\\theta))$\n    $= \\frac{1}{2h^2} (4 - 2\\omega\\exp(i\\theta) - 2\\omega\\exp(-i\\theta) + \\omega^2)$\n    $= \\frac{1}{2h^2} (4 - 4\\omega\\cos\\theta + \\omega^2)$。\n\n3.  **预处理算子的特征值**：\n    $M_{\\mathrm{SSOR}}(\\omega)^{-1} A$ 的特征值由符号的比率近似，即 $\\lambda(\\theta) = \\hat{A}(\\theta) / \\hat{M}_{\\mathrm{SSOR}}(\\omega)(\\theta)$。\n    $\\lambda(\\theta) = \\frac{\\frac{2}{h^2}(1 - \\cos\\theta)}{\\frac{1}{2h^2}(4 - 4\\omega\\cos\\theta + \\omega^2)} = \\frac{4(1 - \\cos\\theta)}{4 - 4\\omega\\cos\\theta + \\omega^2}$。\n    这就是特征值依赖于模态的表达式。\n\n4.  **条件数界**：\n    谱条件数为 $\\kappa = \\lambda_{\\max} / \\lambda_{\\min}$。我们需要找到 $\\lambda(\\theta)$ 在 $\\theta \\in [\\theta_1, \\theta_n]$ 上的最大值和最小值，其中 $\\theta_k = \\frac{k\\pi}{n+1}$，$k=1, \\dots, n$。令 $c = \\cos\\theta$。对于 $\\theta \\in (0,\\pi)$，$c$ 从 $1$ 减小到 $-1$。\n    令 $g(c) = \\frac{4(1-c)}{4-4\\omega c + \\omega^2}$。关于 $c$ 的导数是：\n    $g'(c) = \\frac{-4(4-4\\omega c + \\omega^2) - 4(1-c)(-4\\omega)}{(4-4\\omega c + \\omega^2)^2} = \\frac{-16+16\\omega c -4\\omega^2 + 16\\omega - 16\\omega c}{(4-4\\omega c + \\omega^2)^2}$\n    $g'(c) = \\frac{16\\omega - 4\\omega^2 - 16}{(4-4\\omega c + \\omega^2)^2} = \\frac{-4(\\omega^2 - 4\\omega + 4)}{(4-4\\omega c + \\omega^2)^2} = \\frac{-4(2-\\omega)^2}{(4-4\\omega c + \\omega^2)^2}$。\n    对于 $\\omega \\in (0,2)$，$(2-\\omega)^2  0$ 且分母为正。因此，$g'(c)  0$，这意味着 $g(c)$ 是 $c$ 的严格递减函数。\n    由于 $c=\\cos\\theta$ 在 $(0, \\pi)$ 上是 $\\theta$ 的递减函数，因此 $\\lambda(\\theta) = g(\\cos\\theta)$ 是 $\\theta$ 的递增函数。\n    因此，最小特征值对应于最小的模态角 $\\theta_1 = \\frac{\\pi}{n+1}$，最大特征值对应于最大的模态角 $\\theta_n = \\frac{n\\pi}{n+1} = \\pi - \\theta_1$。\n    $\\lambda_{\\min} = \\lambda(\\theta_1) = \\frac{4(1-\\cos\\theta_1)}{4 - 4\\omega\\cos\\theta_1 + \\omega^2}$。\n    $\\lambda_{\\max} = \\lambda(\\theta_n) = \\frac{4(1-\\cos\\theta_n)}{4 - 4\\omega\\cos\\theta_n + \\omega^2} = \\frac{4(1+\\cos\\theta_1)}{4 + 4\\omega\\cos\\theta_1 + \\omega^2}$。\n    条件数界为 $\\kappa(\\omega, n) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$：\n    $\\kappa(\\omega, n) = \\frac{1+\\cos\\theta_1}{1-\\cos\\theta_1} \\cdot \\frac{4 - 4\\omega\\cos\\theta_1 + \\omega^2}{4 + 4\\omega\\cos\\theta_1 + \\omega^2}$。\n\n5.  **界的最小化**：\n    我们希望找到 $\\omega \\in (0,2)$ 来最小化这个界。令 $c_1 = \\cos\\theta_1 = \\cos(\\frac{\\pi}{n+1})$。第一项 $\\frac{1+c_1}{1-c_1} = \\frac{1+\\cos\\theta_1}{1-\\cos\\theta_1} = \\cot^2(\\frac{\\theta_1}{2})$ 与 $\\omega$ 无关。我们需要最小化第二项：\n    $f(\\omega) = \\frac{\\omega^2 - 4c_1\\omega + 4}{\\omega^2 + 4c_1\\omega + 4}$。\n    其导数为 $f'(\\omega) = \\frac{8c_1(\\omega^2-4)}{(\\omega^2 + 4c_1\\omega + 4)^2}$。\n    由于 $n \\ge 1$，$\\theta_1 \\in (0, \\pi/2)$，所以 $c_1 = \\cos\\theta_1  0$。对于 $\\omega \\in (0,2)$，我们有 $\\omega^2-4  0$。因此，$f'(\\omega)  0$。\n    函数 $f(\\omega)$ 在 $\\omega \\in (0,2)$ 上是严格递减的。当 $\\omega$ 趋于区间的右端点，即 $\\omega \\to 2$ 时，接近下确界（最小值）。\n    因此，极限最优松弛参数是 $\\omega = 2$。\n    为了找到可达到的最小界，我们在 $\\omega \\to 2$ 的极限下计算 $\\kappa(\\omega, n)$：\n    $\\lim_{\\omega \\to 2} \\kappa(\\omega, n) = \\cot^2(\\frac{\\theta_1}{2}) \\cdot \\lim_{\\omega \\to 2} \\frac{\\omega^2 - 4c_1\\omega + 4}{\\omega^2 + 4c_1\\omega + 4}$\n    $= \\cot^2(\\frac{\\theta_1}{2}) \\cdot \\frac{2^2 - 4c_1(2) + 4}{2^2 + 4c_1(2) + 4} = \\cot^2(\\frac{\\theta_1}{2}) \\cdot \\frac{8 - 8c_1}{8 + 8c_1}$\n    $= \\cot^2(\\frac{\\theta_1}{2}) \\cdot \\frac{1 - c_1}{1 + c_1} = \\cot^2(\\frac{\\theta_1}{2}) \\cdot \\frac{1 - \\cos\\theta_1}{1 + \\cos\\theta_1}$。\n    使用半角恒等式 $1-\\cos\\theta_1 = 2\\sin^2(\\frac{\\theta_1}{2})$ 和 $1+\\cos\\theta_1 = 2\\cos^2(\\frac{\\theta_1}{2})$，我们得到：\n    $\\frac{1 - \\cos\\theta_1}{1 + \\cos\\theta_1} = \\tan^2(\\frac{\\theta_1}{2})$。\n    所以，最小界是 $\\cot^2(\\frac{\\theta_1}{2}) \\cdot \\tan^2(\\frac{\\theta_1}{2}) = 1$。\n    这个结果对任何 $n$ 都成立，因此在极限 $n \\to \\infty$ 下也成立。\n\n    极限最优松弛参数是 $\\omega=2$，对应的条件数最小上界是 $1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1\n\\end{pmatrix}\n}\n$$", "id": "3412246"}, {"introduction": "理论分析为我们提供了指导，但实际性能往往取决于具体的实现细节。本练习将从一维理论转向二维计算问题，研究未知数的排序方式——自然排序与红黑排序——如何影响SSOR预条件子的性能 [@problem_id:3412295]。这个动手编程任务将巩固你对代数结构与算法选择之间相互作用的理解。", "problem": "考虑单位正方形 $(0,1)^2$ 上的二维泊松方程 $-\\Delta u = f$，其带有齐次狄利克雷边界条件。使用标准的中心有限差分格式，在 $n \\times n$ 个内部点的均匀网格上对算子 $-\\Delta$ 进行离散化，得到一个对称正定线性系统 $A_n u = b$，其中 $A_n \\in \\mathbb{R}^{N \\times N}$ 且 $N = n^2$。矩阵 $A_n$ 具有众所周知的五点模板结构，并且可以通过克罗内克和 $A_n = I_n \\otimes T_n + T_n \\otimes I_n$ 从一维三对角矩阵 $T_n \\in \\mathbb{R}^{n \\times n}$ 构建。其中，$T_n$ 的对角线元素为 $2/h^2$，第一条次对角线和超对角线上的元素为 $-1/h^2$，$h = 1/(n+1)$，$I_n$ 是 $n \\times n$ 的单位矩阵，$\\otimes$ 表示克罗内克积。\n\n定义自然字典序，将网格点 $(i,j)$（其中 $i,j \\in \\{0,1,\\dots,n-1\\}$）映射到线性索引 $k = i n + j$。定义红黑排序，该排序是一个置换，首先列出所有 $(i+j)$ 为偶数（红色）的索引，然后是所有 $(i+j)$ 为奇数（黑色）的索引。对于任何排序，定义矩阵分裂 $A = D - L - U$，其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是 $-A$ 的严格下三角和严格上三角部分，因此 $L$ 和 $U$ 的元素均为非负。带松弛因子 $\\omega \\in (0,2)$ 的对称逐次超松弛（SSOR）预条件子是一个对称正定矩阵，它与执行一次前向逐次超松弛（SOR）扫描和一次后向 SOR 扫描相关联。令 $M_{\\omega}$ 表示该 SSOR 预条件子。\n\n对于给定的排序和松弛因子 $\\omega$，预处理谱是满足 $A x = \\lambda M_{\\omega} x$ 的广义特征值 $\\lambda$ 的集合。该广义谱与对称预处理算子 $M_{\\omega}^{-1/2} A M_{\\omega}^{-1/2}$ 的普通谱以及左预处理算子 $M_{\\omega}^{-1} A$ 的谱一致。\n\n任务：\n- 为每个指定的 $n$ 构建 $A_n$。\n- 对每个 $n$ 和 $\\omega$，在自然排序下构建 $M_{\\omega}$，并计算 $(A_n, M_{\\omega})$ 的最小和最大广义特征值，以及它们的比率（广义特征值问题的条件数），定义为 $\\kappa_{\\mathrm{nat}} = \\lambda_{\\max}/\\lambda_{\\min}$。\n- 构建红黑置换，在红黑排序下形成置换后的系统 $A_{n,\\mathrm{rb}}$，相应地构建 $M_{\\omega,\\mathrm{rb}}$，并计算 $(A_{n,\\mathrm{rb}}, M_{\\omega,\\mathrm{rb}})$ 的最小和最大广义特征值及其比率 $\\kappa_{\\mathrm{rb}} = \\lambda_{\\max}/\\lambda_{\\min}$。\n- 对每个测试用例，将输出聚合为一个三元组 $[\\kappa_{\\mathrm{nat}}, \\kappa_{\\mathrm{rb}}, \\kappa_{\\mathrm{nat}}/\\kappa_{\\mathrm{rb}}]$，其中第三个条目量化了红黑排序相对于自然排序的改进因子。\n\n使用以下参数值测试套件：\n- 用例 1：$n = 8$，$\\omega = 1.0$。\n- 用例 2：$n = 8$，$\\omega = 1.5$。\n- 用例 3：$n = 16$，$\\omega = 1.9$。\n- 用例 4：$n = 4$，$\\omega = 1.2$。\n\n您的程序必须：\n- 为每个用例计算三个浮点数。\n- 将报告的每个浮点数四舍五入到六位小数。\n- 生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表。每个用例的三元组本身也是一个用方括号括起来的逗号分隔列表，顺序与测试套件相同。例如，输出格式必须为 $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$，所有数值条目均四舍五入到六位小数。\n\n输出不涉及物理单位或角度单位。不应使用百分比；比率必须以小数形式报告。", "solution": "我们从二维泊松方程的离散模型开始。在齐次狄利克雷边界条件下，$(0,1)^2$ 上的连续算子 $-\\Delta$ 会产生一个对称正定算子。使用中心有限差分法，在间距为 $h = 1/(n+1)$ 的 $n \\times n$ 内部点均匀网格上进行离散化，会生成具有标准五点模板的矩阵 $A_n \\in \\mathbb{R}^{N \\times N}$，其中 $N = n^2$。一个稳定且广泛使用的构建方法是通过克罗内克和\n$$\nA_n = I_n \\otimes T_n + T_n \\otimes I_n,\n$$\n其中 $I_n$ 是 $n \\times n$ 单位矩阵，$T_n \\in \\mathbb{R}^{n \\times n}$ 是一个三对角矩阵，其对角线元素为 $2/h^2$，紧邻的非对角线元素为 $-1/h^2$。该矩阵 $A_n$ 是对称正定的。\n\n为讨论对称逐次超松弛（SSOR）预条件子，我们回顾矩阵分裂\n$$\nA = D - L - U,\n$$\n其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是 $-A$ 的严格下三角和严格上三角部分，因此 $L$ 和 $U$ 的元素均为非负。用于求解 $A x = b$ 的逐次超松弛（SOR）迭代（松弛因子为 $\\omega \\in (0,2)$）包含一个使用 $(D - \\omega L)$ 的前向三角扫描和一个使用 $(D - \\omega U)$ 的后向三角扫描。SSOR 预条件子 $M_{\\omega}$ 是通过组合前向和后向 SOR 步骤并进行适当缩放而形成的对称正定矩阵。从 SOR 的基本定义出发，一个标准的推导给出了 SSOR 预条件子\n$$\nM_{\\omega} = \\frac{1}{\\omega (2 - \\omega)} (D - \\omega L) D^{-1} (D - \\omega U).\n$$\n这可以通过将前向 SOR 步骤解释为求解 $(D - \\omega L) y = r$，后向 SOR 步骤解释为求解 $(D - \\omega U) z = D y$，然后组合并缩放以获得一个近似于 $A$ 且保持共轭梯度兼容性的对称正定算子来得出。对于 $0  \\omega  2$，$M_{\\omega}$ 是对称正定的。\n\n当使用左预条件子 $M_{\\omega}$ 时，我们研究广义特征值问题\n$$\nA x = \\lambda M_{\\omega} x,\n$$\n其特征值 $\\lambda$ 等于对称预处理算子 $M_{\\omega}^{-1/2} A M_{\\omega}^{-1/2}$ 的特征值，也等于 $M_{\\omega}^{-1} A$ 的谱。因为 $A$ 是对称正定的，$M_{\\omega}$ 也是对称正定的，所以广义特征值是实数且为正，广义特征值问题的条件数为\n$$\n\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}.\n$$\n较小的 $\\kappa$ 值表示谱更紧密地聚集，这对克雷洛夫方法有利。\n\n排序会影响严格三角分量 $L$ 和 $U$，从而影响 SSOR 预条件子。在自然字典序中，索引沿一个方向递增，然后是下一个方向；在红黑排序中，根据 $(i+j)$ 的奇偶性用两种颜色对网格进行着色，将所有红色节点排在前面，然后是所有黑色节点。红黑排序使网格图的邻接模式块对角化，这反过来又改变了 $L$ 和 $U$ 的结构，并通常改善了椭圆问题 SSOR 预条件子的谱特性。\n\n算法步骤：\n- 使用克罗内克和 $A_n = I_n \\otimes T_n + T_n \\otimes I_n$ 构建 $A_n$。\n- 在自然排序下，形成 $D = \\operatorname{diag}(A)$，$L = -\\operatorname{tril}(A,-1)$，$U = -\\operatorname{triu}(A,1)$，并计算\n$$\nM_{\\omega} = \\frac{1}{\\omega (2 - \\omega)} (D - \\omega L) D^{-1} (D - \\omega U).\n$$\n- 求解广义特征值问题 $A x = \\lambda M_{\\omega} x$ 以获得 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$；计算 $\\kappa_{\\mathrm{nat}} = \\lambda_{\\max}/\\lambda_{\\min}$。\n- 通过列出所有 $(i+j)$ 为偶数的索引，然后是所有 $(i+j)$ 为奇数的索引，来构建红黑置换。将此置换应用于 $A_n$ 以获得 $A_{n,\\mathrm{rb}}$，并从置换后的 $A_{n,\\mathrm{rb}}$ 通过相同的 SSOR 公式构建 $M_{\\omega,\\mathrm{rb}}$。\n- 求解广义特征值问题 $A_{n,\\mathrm{rb}} x = \\lambda M_{\\omega,\\mathrm{rb}} x$ 以获得 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$；计算 $\\kappa_{\\mathrm{rb}} = \\lambda_{\\max}/\\lambda_{\\min}$。\n- 对每个测试用例，报告三元组 $[\\kappa_{\\mathrm{nat}}, \\kappa_{\\mathrm{rb}}, \\kappa_{\\mathrm{nat}}/\\kappa_{\\mathrm{rb}}]$，每个浮点数四舍五入到六位小数。\n\n数值考虑：\n- 矩阵是稀疏且对称正定的；使用稀疏线性代数以提高效率和数值稳定性。\n- 在实践中，由于浮点舍入误差，通过 $(M_{\\omega} + M_{\\omega}^{\\top})/2$ 显式地对称化 $M_{\\omega}$ 有助于确保广义对称特征值求解器所需的对称性。\n- 最小和最大广义特征值可以使用对称特征求解器对广义问题 $A x = \\lambda M x$ 进行计算，其中 $A$ 对称，$M$ 对称正定，从而高效地返回极值特征值。\n\n下面的实现构建了矩阵，执行了广义特征值计算，并为指定的测试套件打印了所要求的输出。", "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags, identity, kron, tril, triu, csr_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef build_2d_poisson(n: int) - csr_matrix:\n    \"\"\"\n    Build the 2D Poisson (negative Laplacian) matrix with Dirichlet boundary conditions\n    on an n x n grid of interior points using the 5-point stencil.\n    A = kron(I, T) + kron(T, I), where T is 1D tridiagonal with [ -1, 2, -1 ] scaled by 1/h^2.\n    \"\"\"\n    h = 1.0 / (n + 1)\n    main = (2.0 / (h * h)) * np.ones(n)\n    off = (-1.0 / (h * h)) * np.ones(n - 1)\n    T = diags([off, main, off], offsets=[-1, 0, 1], format='csr')\n    I = identity(n, format='csr')\n    A = kron(I, T) + kron(T, I)\n    return A.tocsr()\n\ndef ssor_preconditioner(A: csr_matrix, omega: float) - csr_matrix:\n    \"\"\"\n    Construct the SSOR preconditioner M_omega = 1/(omega(2-omega)) * (D - omega L) * D^{-1} * (D - omega U),\n    where A = D - L - U with L = -tril(A,-1), U = -triu(A,1).\n    \"\"\"\n    if not (0.0  omega  2.0):\n        raise ValueError(\"omega must be in (0,2) for SSOR preconditioner.\")\n    # Diagonal and strictly lower/upper parts\n    diagA = A.diagonal()\n    D = diags(diagA, format='csr')\n    L = -tril(A, k=-1).tocsr()\n    U = -triu(A, k=1).tocsr()\n    # Inverse of diagonal\n    D_inv = diags(1.0 / diagA, format='csr')\n    # Assemble SSOR\n    S1 = (D - omega * L).tocsr()\n    S2 = (D - omega * U).tocsr()\n    denom = omega * (2.0 - omega)\n    M = (S1 @ D_inv @ S2) * (1.0 / denom)\n    # Ensure symmetry numerically\n    M = ((M + M.T) * 0.5).tocsr()\n    return M\n\ndef red_black_permutation(n: int) - np.ndarray:\n    \"\"\"\n    Construct red-black ordering permutation indices for an n x n grid.\n    Red: (i+j) even; Black: (i+j) odd. Return permutation list mapping\n    old indices to new order [reds, blacks].\n    \"\"\"\n    red = []\n    black = []\n    for i in range(n):\n        for j in range(n):\n            idx = i * n + j\n            if ((i + j) % 2) == 0:\n                red.append(idx)\n            else:\n                black.append(idx)\n    return np.array(red + black, dtype=int)\n\ndef generalized_extremal_eigs(A: csr_matrix, M: csr_matrix) - tuple[float, float]:\n    \"\"\"\n    Compute smallest and largest generalized eigenvalues of A x = lambda M x.\n    A must be symmetric; M must be symmetric positive definite.\n    \"\"\"\n    # Smallest algebraic eigenvalue\n    lam_min = eigsh(A, k=1, M=M, which='SA', return_eigenvectors=False, tol=1e-10)[0]\n    # Largest algebraic eigenvalue\n    lam_max = eigsh(A, k=1, M=M, which='LA', return_eigenvectors=False, tol=1e-10)[0]\n    # Guard against any tiny negative due to roundoff\n    lam_min = float(lam_min)\n    lam_max = float(lam_max)\n    if lam_min = 0:\n        lam_min = max(lam_min, 1e-14)\n    return lam_min, lam_max\n\ndef compute_condition_numbers(n: int, omega: float) - tuple[float, float, float]:\n    \"\"\"\n    For given n and omega, compute condition numbers for natural ordering and red-black ordering SSOR\n    preconditioned generalized eigenvalue problems, and their improvement ratio.\n    Returns (kappa_nat, kappa_rb, improvement).\n    \"\"\"\n    # Build A for natural ordering\n    A_nat = build_2d_poisson(n)\n    # SSOR for natural ordering\n    M_nat = ssor_preconditioner(A_nat, omega)\n    lam_min_nat, lam_max_nat = generalized_extremal_eigs(A_nat, M_nat)\n    kappa_nat = lam_max_nat / lam_min_nat\n\n    # Red-black permuted system\n    perm = red_black_permutation(n)\n    # Apply permutation to A: A_rb = P^T A P, achieved by indexing rows and cols\n    A_rb = A_nat[perm, :][:, perm]\n    # SSOR for red-black ordered matrix\n    M_rb = ssor_preconditioner(A_rb, omega)\n    lam_min_rb, lam_max_rb = generalized_extremal_eigs(A_rb, M_rb)\n    kappa_rb = lam_max_rb / lam_min_rb\n\n    improvement = kappa_nat / kappa_rb\n    return kappa_nat, kappa_rb, improvement\n\ndef format_results(results: list[tuple[float, float, float]]) - str:\n    \"\"\"\n    Format the list of triples into the required single-line string with six decimal places\n    and no extra spaces: [[a,b,c],[...],...]\n    \"\"\"\n    parts = []\n    for triple in results:\n        a, b, c = triple\n        parts.append(f\"[{a:.6f},{b:.6f},{c:.6f}]\")\n    return f\"[{','.join(parts)}]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (n, omega)\n    test_cases = [\n        (8, 1.0),\n        (8, 1.5),\n        (16, 1.9),\n        (4, 1.2),\n    ]\n\n    results = []\n    for n, omega in test_cases:\n        kappa_nat, kappa_rb, improvement = compute_condition_numbers(n, omega)\n        results.append((kappa_nat, kappa_rb, improvement))\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3412295"}]}