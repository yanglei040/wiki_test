{"hands_on_practices": [{"introduction": "GMRES方法的核心是Arnoldi过程，它为Krylov子空间构建了一个标准正交基。在深入分析其收敛行为之前，亲手实践Arnoldi过程的计算步骤至关重要。本练习将引导你对一个具体的非对称矩阵执行Arnoldi迭代，从而揭示该算法的内部工作机制，并让你观察到“精确击穿”（exact breakdown）这一关键现象，它标志着一个不变子空间的发现 [@problem_id:3411908]。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个非对称上三角矩阵\n$$\nA=\\begin{bmatrix}\n2  10  0\\\\\n0  3  1\\\\\n0  0  4\n\\end{bmatrix},\n$$\n并考虑线性系统 $A x = b$，该系统可能源于偏微分方程（PDE）的有限维离散化。设初始猜测为 $x_0=0$，右端项为 $b=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$，因此初始残差为 $r_0=b-A x_0=b$。使用带有欧几里得内积和经典格拉姆-施密特正交化的 Arnoldi 过程，从 $v_1=r_0/\\|r_0\\|_2$ 开始，执行恰好两个 Arnoldi 步骤，构造标准正交基向量 $v_1$, $v_2$, $v_3$ 和 $(3 \\times 2)$ 的上海森堡矩阵 $\\underline{H}_2$。在您的构造中，明确计算正交化过程中使用的所有投影系数和归一化常数，并组装 $V_3=\\begin{bmatrix}v_1  v_2  v_3\\end{bmatrix}$ 和 $\\underline{H}_2$。如果发生精确崩溃，请解释它如何影响 $v_3$ 的定义和 $\\underline{H}_2$ 的结构，并提供一个显式的标准正交补全来定义与 Arnoldi 关系 $A V_2 = V_3 \\underline{H}_2$ 一致的 $v_3$。作为您的最终答案，请以精确形式给出 $\\underline{H}_2$ 的标量次对角线元素 $h_{32}$。不要对答案进行四舍五入。", "solution": "该问题要求对给定的线性系统使用 Arnoldi 过程构造一个标准正交基和一个海森堡矩阵。首先，该问题经过验证，是适定的且科学上合理的，包含了唯一解过程所需的所有必要信息。\n\nArnoldi 过程是一种迭代方法，它为克雷洛夫子空间 $\\mathcal{K}_m(A, v_1) = \\operatorname{span}\\{v_1, Av_1, \\ldots, A^{m-1}v_1\\}$ 构造一个标准正交基 $\\{v_1, v_2, \\ldots, v_m\\}$。该过程还生成一个上海森堡矩阵 $\\underline{H}_{m-1} \\in \\mathbb{R}^{m \\times (m-1)}$，其元素是来自格拉姆-施密特正交化的系数。其主导关系是 $AV_{m-1} = V_m \\underline{H}_{m-1}$，其中 $V_k = \\begin{bmatrix} v_1  \\cdots  v_k \\end{bmatrix}$。\n\n算法流程如下。对于 $j=1, 2, \\ldots, m-1$:\n1. 计算 $w = Av_j$。\n2. 对于 $i=1, \\ldots, j$，计算投影系数 $h_{ij} = v_i^T w$。\n3. 计算待正交化的向量：$\\tilde{v}_{j+1} = w - \\sum_{i=1}^j h_{ij}v_i$。\n4. 计算归一化常数 $h_{j+1,j} = \\|\\tilde{v}_{j+1}\\|_2$。\n5. 如果 $h_{j+1,j} = 0$，发生精确崩溃；停止。否则，令 $v_{j+1} = \\tilde{v}_{j+1}/h_{j+1,j}$。\n\n给定矩阵 $A=\\begin{bmatrix} 2  10  0\\\\ 0  3  1\\\\ 0  0  4 \\end{bmatrix}$，右端向量 $b=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$，以及初始猜测 $x_0=0$。\n\n**第 0 步：初始化**\n初始残差为 $r_0 = b - Ax_0 = b = \\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$。\nArnoldi 过程的起始向量是 $v_1 = r_0 / \\|r_0\\|_2$。\n$r_0$ 的欧几里得范数为 $\\|r_0\\|_2 = \\sqrt{1^2+1^2+1^2} = \\sqrt{3}$。\n因此，第一个标准正交基向量是 $v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$。\n\n**第 1 步：构造 $v_2$ 和 $\\underline{H}_2$ 的第一列**\n首先，我们计算乘积 $w_1 = Av_1$：\n$$ w_1 = \\begin{bmatrix} 2  10  0\\\\ 0  3  1\\\\ 0  0  4 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}2+10\\\\3+1\\\\4\\end{pmatrix} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} $$\n接下来，我们将 $w_1$ 与 $v_1$ 正交化。投影系数 $h_{11}$ 为：\n$$ h_{11} = v_1^T w_1 = \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1  1  1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} \\right) = \\frac{1}{3}(12+4+4) = \\frac{20}{3} $$\n未归一化的下一个向量 $\\tilde{v}_2$ 为：\n$$ \\tilde{v}_2 = w_1 - h_{11}v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} - \\frac{20}{3} \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} = \\frac{1}{3\\sqrt{3}}\\left(3\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} - 20\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}\\right) = \\frac{1}{3\\sqrt{3}}\\begin{pmatrix}36-20\\\\12-20\\\\12-20\\end{pmatrix} = \\frac{1}{3\\sqrt{3}}\\begin{pmatrix}16\\\\-8\\\\-8\\end{pmatrix} = \\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n归一化常数 $h_{21}$ 是 $\\tilde{v}_2$ 的范数：\n$$ h_{21} = \\|\\tilde{v}_2\\|_2 = \\left\\| \\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right\\|_2 = \\frac{8}{3\\sqrt{3}} \\sqrt{2^2+(-1)^2+(-1)^2} = \\frac{8}{3\\sqrt{3}}\\sqrt{6} = \\frac{8\\sqrt{2}}{3} $$\n由于 $h_{21} \\neq 0$，没有发生崩溃。我们归一化 $\\tilde{v}_2$ 得到 $v_2$：\n$$ v_2 = \\frac{\\tilde{v}_2}{h_{21}} = \\frac{\\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix}}{\\frac{8\\sqrt{2}}{3}} = \\frac{1}{\\sqrt{3}\\sqrt{2}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n\n**第 2 步：构造 $v_3$ 和 $\\underline{H}_2$ 的第二列**\n我们计算乘积 $w_2 = Av_2$：\n$$ w_2 = \\begin{bmatrix} 2  10  0\\\\ 0  3  1\\\\ 0  0  4 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right) = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}4-10\\\\-3-1\\\\-4\\end{pmatrix} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} $$\n接下来，我们将 $w_2$ 与 $\\{v_1, v_2\\}$ 正交化。投影系数为：\n$$ h_{12} = v_1^T w_2 = \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1  1  1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} \\right) = \\frac{-6-4-4}{\\sqrt{18}} = \\frac{-14}{3\\sqrt{2}} = -\\frac{7\\sqrt{2}}{3} $$\n$$ h_{22} = v_2^T w_2 = \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2  -1  -1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} \\right) = \\frac{1}{6}(-12+4+4) = \\frac{-4}{6} = -\\frac{2}{3} $$\n未归一化的向量 $\\tilde{v}_3$ 为：\n$$ \\tilde{v}_3 = w_2 - h_{12}v_1 - h_{22}v_2 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} - \\left(-\\frac{7\\sqrt{2}}{3}\\right)\\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} - \\left(-\\frac{2}{3}\\right)\\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n$$ \\tilde{v}_3 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} + \\frac{7\\sqrt{2}}{3\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} + \\frac{2}{3\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n为了合并这些项，我们使用公因子 $\\frac{1}{3\\sqrt{6}}$。注意 $\\frac{7\\sqrt{2}}{3\\sqrt{3}} = \\frac{7\\sqrt{2}\\sqrt{2}}{3\\sqrt{3}\\sqrt{2}} = \\frac{14}{3\\sqrt{6}}$。\n$$ \\tilde{v}_3 = \\frac{1}{3\\sqrt{6}} \\left( 3\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} + 14\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} + 2\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right) = \\frac{1}{3\\sqrt{6}} \\begin{pmatrix}-18+14+4\\\\-12+14-2\\\\-12+14-2\\end{pmatrix} = \\frac{1}{3\\sqrt{6}}\\begin{pmatrix}0\\\\0\\\\0\\end{pmatrix} = 0 $$\n得到的向量 $\\tilde{v}_3$ 是零向量。这标志着 Arnoldi 过程发生了精确崩溃。\n\n**精确崩溃分析**\n次对角线元素 $h_{32}$ 是归一化常数，即 $\\tilde{v}_3$ 的范数：\n$$ h_{32} = \\|\\tilde{v}_3\\|_2 = \\|0\\|_2 = 0 $$\n精确崩溃（$h_{j+1,j}=0$）意味着克雷洛夫子空间“停滞”；其维度为 $j$。在这里，对于所有 $m \\geq 2$，$\\mathcal{K}_m(A, v_1)$ 的维度都是 2。这是因为空间 $\\mathcal{K}_2(A, v_1) = \\operatorname{span}\\{v_1, v_2\\}$ 是一个 A-不变子空间。条件 $\\tilde{v}_3=0$ 等价于 $Av_2 = h_{12}v_1 + h_{22}v_2$，这证明了这种不变性。\n\nArnoldi 关系是 $AV_2 = V_3\\underline{H}_2$。由于 $h_{32}=0$，第二列的关系 $Av_2 = h_{12}v_1 + h_{22}v_2 + h_{32}v_3$ 简化为 $Av_2 = h_{12}v_1 + h_{22}v_2$，这与 $v_3$ 无关。\n问题要求我们通过显式的标准正交补全来定义 $v_3$。我们必须找到一个同时与 $v_1$ 和 $v_2$ 正交的单位向量 $v_3$。设 $v_3=(x,y,z)^T$。\n$ v_1^T v_3 = \\frac{1}{\\sqrt{3}}(x+y+z) = 0 \\implies x+y+z=0 $\n$ v_2^T v_3 = \\frac{1}{\\sqrt{6}}(2x-y-z) = 0 \\implies 2x-y-z=0 $\n将这两个方程相加得到 $3x=0$，所以 $x=0$。这意味着 $y+z=0$，或 $z=-y$。\n该向量必须具有 $\\begin{pmatrix}0\\\\y\\\\-y\\end{pmatrix}$ 的形式。为了成为单位向量，其范数必须为 1：\n$ \\| \\begin{pmatrix}0\\\\y\\\\-y\\end{pmatrix} \\|_2 = \\sqrt{0^2+y^2+(-y)^2} = \\sqrt{2y^2} = |y|\\sqrt{2} = 1 \\implies |y|=\\frac{1}{\\sqrt{2}} $。\n我们选择 $y=\\frac{1}{\\sqrt{2}}$，这给出了一个可能的补全：$v_3 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}0\\\\1\\\\-1\\end{pmatrix}$。\n\n**最终构造的矩阵**\n标准正交基向量为：\n$v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$, $v_2 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix}$, $v_3 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}0\\\\1\\\\-1\\end{pmatrix}$。\n矩阵 $V_3$ 为：\n$$ V_3=\\begin{bmatrix}v_1  v_2  v_3\\end{bmatrix} = \\begin{bmatrix} \\frac{1}{\\sqrt{3}}  \\frac{2}{\\sqrt{6}}  0 \\\\ \\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{6}}  \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{6}}  -\\frac{1}{\\sqrt{2}} \\end{bmatrix} $$\n从计算出的系数组装成 $(3 \\times 2)$ 的上海森堡矩阵 $\\underline{H}_2$：\n$$ \\underline{H}_2 = \\begin{pmatrix} h_{11}  h_{12} \\\\ h_{21}  h_{22} \\\\ 0  h_{32} \\end{pmatrix} = \\begin{pmatrix} \\frac{20}{3}  -\\frac{7\\sqrt{2}}{3} \\\\ \\frac{8\\sqrt{2}}{3}  -\\frac{2}{3} \\\\ 0  0 \\end{pmatrix} $$\n我们关注的次对角线元素是 $h_{32}$，其值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3411908"}, {"introduction": "在求解线性系统时，一个常见的误区是认为小的残差范数意味着解的误差也很小，即计算解已接近真实解。然而，对于由偏微分方程离散化产生的许多高度非正规系统，这种直觉可能是错误的。本练习旨在通过计算一个经典非正规矩阵的误差放大因子 $\\left\\|A^{-1}\\right\\|_2$，让你量化并理解为何误差范数可能比残差范数大几个数量级 [@problem_id:3411893]。", "problem": "考虑线性系统 $A x = b$，该系统源于对一维常系数线性平流方程 $u_{t} + c\\,u_{x} = f$ 在双单元均匀网格上采用一阶迎风空间离散和齐次狄利克雷边界条件进行后向欧拉时间离散。对于大小为 $\\Delta t$ 的单个时间步长和网格间距 $\\Delta x$，所得到的 $2 \\times 2$ 系统矩阵可以写成 $A = I + N$ 的形式，其中 $I$ 是单位矩阵，$N$ 是严格上三角矩阵，其 $(N)_{12} = M$，所有其他元素均为零，其中 $M = c\\,\\Delta t/\\Delta x > 0$。对于大的 $M$，该矩阵 $A$ 是高度非正规的。\n\n设 $x$ 为精确解，$x_{k}$ 为由克雷洛夫子空间方法（如广义最小残差法 GMRES）产生的第 $k$ 次迭代解。记残差为 $r_{k} = b - A x_{k}$，误差为 $e_{k} = x - x_{k}$。对于任何非奇异矩阵，基本关系给出 $A e_{k} = r_{k}$，因此 $e_{k} = A^{-1} r_{k}$。\n\n通过舒尔分解定义非正规度：如果 $A = Q T Q^{*}$，其中 $Q$ 是酉矩阵，$T = \\Lambda + N_{\\text{schur}}$ 是上三角矩阵（$\\Lambda$ 是对角矩阵，$N_{\\text{schur}}$ 是严格上三角矩阵），则设 $\\delta(A) = \\|N_{\\text{schur}}\\|_{2}$。对于当前的 $2 \\times 2$ 矩阵，$A$ 本身已经是上三角矩阵，因此 $\\delta(A) = \\|N\\|_{2} = M$。\n\n假设经过 $k$ 次迭代后，残差为 $r_{k} = \\begin{pmatrix} 0 \\\\ \\varepsilon \\end{pmatrix}$，其中 $\\varepsilon = 10^{-6}$，其范数很小。量化残差范数和误差范数之间可能差距的放大因子由算子范数 $\\|A^{-1}\\|_{2}$ 给出，因为 $\\|e_{k}\\|_{2} \\leq \\|A^{-1}\\|_{2} \\,\\|r_{k}\\|_{2}$。\n\n仅使用上述结构性事实和 $\\delta(A)$ 的定义，推导 $\\|A^{-1}\\|_{2}$ 关于 $M = \\delta(A)$ 的解析表达式，然后在 $M = 10^{6}$ 处计算该表达式的值。报告残差到误差放大因子的估计值 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$，结果四舍五入到四位有效数字。在最终报告的值中不要包含任何单位。", "solution": "该问题陈述已经过严格验证，被认为是数值线性代数中一个有效且适定的问题。它具有科学依据、内容自洽且客观。不存在矛盾、歧义或不合理的假设。因此，我们可以开始求解。\n\n该问题要求推导残差到误差放大因子 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$ 的解析表达式，并计算其在特定情况下的数值。矩阵 $A$ 是为一个 $2 \\times 2$ 系统定义的，形式为 $A = I + N$，其中 $I$ 是单位矩阵，$N$ 是一个严格上三角矩阵。\n\n根据问题描述，我们有：\n$I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n矩阵 $N$ 是严格上三角矩阵，其 $(N)_{12} = M$，所有其他元素均为零。因此，\n$N = \\begin{pmatrix} 0 & M \\\\ 0 & 0 \\end{pmatrix}$\n所以系统矩阵 $A$ 为：\n$$A = I + N = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & M \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix}$$\n问题指出，非正规度为 $\\delta(A) = M$。\n\n为了找到放大因子 $\\|A^{-1}\\|_{2}$，我们首先计算 $A$ 的逆矩阵。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵由 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$ 给出。\n对于我们的矩阵 $A$，有 $a=1, b=M, c=0, d=1$。行列式为 $\\det(A) = (1)(1) - (M)(0) = 1$。\n逆矩阵是：\n$$A^{-1} = \\frac{1}{1} \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix}$$\n\n接下来，我们计算 $A^{-1}$ 的2-范数。任何矩阵 $B$ 的2-范数（记为 $\\|B\\|_{2}$）是矩阵乘积 $B^*B$ 的最大特征值的平方根，其中 $B^*$ 是 $B$ 的共轭转置。这里，$B = A^{-1}$。由于 $A^{-1}$ 的所有元素都是实数，其共轭转置就是其转置。\n$$(A^{-1})^* = (A^{-1})^T = \\begin{pmatrix} 1 & 0 \\\\ -M & 1 \\end{pmatrix}$$\n现在，我们构造乘积 $(A^{-1})^*A^{-1}$：\n$$(A^{-1})^*A^{-1} = \\begin{pmatrix} 1 & 0 \\\\ -M & 1 \\end{pmatrix} \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(0)(0) & (1)(-M)+(0)(1) \\\\ (-M)(1)+(1)(0) & (-M)(-M)+(1)(1) \\end{pmatrix} = \\begin{pmatrix} 1 & -M \\\\ -M & M^2+1 \\end{pmatrix}$$\n该矩阵的特征值 $\\lambda$ 是其特征方程 $\\det((A^{-1})^*A^{-1} - \\lambda I) = 0$ 的根。\n$$\\det\\begin{pmatrix} 1-\\lambda & -M \\\\ -M & M^2+1-\\lambda \\end{pmatrix} = 0$$\n$$(1-\\lambda)(M^2+1-\\lambda) - (-M)(-M) = 0$$\n$$M^2 + 1 - \\lambda - \\lambda M^2 - \\lambda + \\lambda^2 - M^2 = 0$$\n$$\\lambda^2 - (M^2+2)\\lambda + 1 = 0$$\n我们使用二次方程求根公式来解这个关于 $\\lambda$ 的方程：\n$$\\lambda = \\frac{-[-(M^2+2)] \\pm \\sqrt{[-(M^2+2)]^2 - 4(1)(1)}}{2(1)} = \\frac{M^2+2 \\pm \\sqrt{(M^2+2)^2 - 4}}{2}$$\n$$\\lambda = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2+4 - 4}}{2} = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2}}{2}$$\n由于给定 $M>0$，我们可以从平方根中提出因子 $M^2$：\n$$\\lambda = \\frac{M^2+2 \\pm \\sqrt{M^2(M^2+4)}}{2} = \\frac{M^2+2 \\pm M\\sqrt{M^2+4}}{2}$$\n两个特征值是 $\\lambda_1 = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$ 和 $\\lambda_2 = \\frac{M^2+2 - M\\sqrt{M^2+4}}{2}$。\n2-范数的平方 $\\|A^{-1}\\|_{2}^2$ 是这两个特征值中较大的一个，即 $\\lambda_{max}$。\n$$\\lambda_{max} = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$$\n因此，问题的第一部分得到解决：$\\|A^{-1}\\|_{2}$ 关于 $M = \\delta(A)$ 的解析表达式是：\n$$\\|A^{-1}\\|_{2} = \\sqrt{\\frac{M^2+2 + M\\sqrt{M^2+4}}{2}}$$\n第二部分是在 $M = 10^6$ 处计算该表达式的值。设 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$。\n$$G_{\\text{est}} = \\sqrt{\\frac{(10^6)^2+2 + 10^6\\sqrt{(10^6)^2+4}}{2}} = \\sqrt{\\frac{10^{12}+2 + 10^6\\sqrt{10^{12}+4}}{2}}$$\n对于像 $M=10^6$ 这样非常大的 $M$ 值，我们可以分析表达式的行为。项 $\\sqrt{M^2+4}$ 非常接近 $M$。使用二项式展开，$\\sqrt{M^2+4} = M\\sqrt{1+4/M^2} \\approx M(1 + \\frac{1}{2}\\frac{4}{M^2}) = M + \\frac{2}{M}$。\n将此代入 $\\lambda_{max}$ 的表达式中：\n$$\\lambda_{max} \\approx \\frac{M^2+2 + M(M+2/M)}{2} = \\frac{M^2+2+M^2+2}{2} = M^2+2$$\n所以，$\\|A^{-1}\\|_2 \\approx \\sqrt{M^2+2} \\approx M$。\n对于 $M=10^6$，$G_{\\text{est}}$ 的值预计会非常接近 $10^6$。\n精确的数值计算给出：\n$$G_{\\text{est}} \\approx 1000000.000001$$\n用科学记数法表示，这是 $1.000000000001 \\times 10^6$。\n问题要求将此值四舍五入到四位有效数字。\n$$G_{\\text{est}} \\approx 1.000 \\times 10^6$$\n这个结果突显了在具有高度非正规矩阵的系统中，即使残差很小，也可能存在巨大的误差放大。范数为 $\\|r_k\\|_2 = \\varepsilon = 10^{-6}$ 的小残差 $r_k$ 可能对应一个误差 $e_k$，其范数 $\\|e_k\\|_2$ 可大至 $\\|A^{-1}\\|_2\\|r_k\\|_2 \\approx (10^6)(10^{-6}) = 1$。误差范数可以是1的数量级，这意味着尽管残差非常小，计算出的解 $x_k$ 可能没有一位正确数字。", "answer": "$$\\boxed{1.000 \\times 10^6}$$", "id": "3411893"}, {"introduction": "我们已经看到了非正规性在实践中所带来的“残差-误差”陷阱，现在我们转向用于预测收敛性的理论工具。数值范围（field of values）$W(A)$ 为GMRES的收敛性提供了一个理论上界，但对于非正规矩阵，这些界限可能极其悲观以至于失去实用价值。本练习将通过计算一个高度非正规矩阵的数值范围，并推导其对应的Elman收敛界，来揭示这些理论界限的局限性 [@problem_id:3411886]。", "problem": "考虑一个由强逆风一维对流-扩散离散化产生的线性系统，其局部的二乘二分块为\n$$\nA=\\begin{bmatrix}1  100 \\\\ 0  1\\end{bmatrix}.\n$$\n仅从核心定义出发，按以下步骤进行。\n\n1. 使用值域（也称为数值范围）的定义，\n$$\nW(A)=\\{\\, v^{*} A v : v\\in\\mathbb{C}^{2},\\ \\|v\\|_{2}=1 \\,\\},\n$$\n显式地计算 $W(A)$ 作为复平面的一个子集。\n\n2. 使用定义\n$$\n\\nu(A)=\\min\\{\\, |z| : z\\in W(A)\\,\\},\n$$\n确定 $\\nu(A)$。\n\n3. 使用谱范数的定义，\n$$\n\\|A\\|_{2}=\\sqrt{\\lambda_{\\max}(A^{*}A)},\n$$\n以精确的闭合形式计算 $\\|A\\|_{2}$。\n\n4. 使用基于值域的标准 Elman 界来求解广义最小残差法(GMRES)，确定 GMRES 应用于 $A x=b$（具有任意初始残差）时所保证的单步残差缩减因子。然后，将此保证与 GMRES 在此矩阵 $A$ 上使用精确算术的实际情况进行比较，并根据第 1-3 部分的基本定义解释任何差异。\n\n作为最终答案，报告由 Elman 界预测的保证单步残差缩减因子。无需四舍五入。", "solution": "将按顺序遵循指定的四个部分来解决此问题。每个计算都将基于所提供的定义。\n\n### 第 1 部分：值域 $W(A)$ 的计算\n\n矩阵 $A = \\begin{bmatrix} 1 & 100 \\\\ 0 & 1 \\end{bmatrix}$ 的值域（或数值范围）定义为 $W(A) = \\{ v^* A v : v \\in \\mathbb{C}^2, \\|v\\|_2 = 1 \\}$。设 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 是 $\\mathbb{C}^2$ 中的一个向量，其欧几里得范数为 $\\|v\\|_2 = 1$，即 $|v_1|^2 + |v_2|^2 = 1$。\n\n我们计算二次型 $v^* A v$：\n$$\nv^* A v = \\begin{pmatrix} \\overline{v_1} & \\overline{v_2} \\end{pmatrix} \\begin{pmatrix} 1 & 100 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\overline{v_1} & \\overline{v_2} \\end{pmatrix} \\begin{pmatrix} v_1 + 100v_2 \\\\ v_2 \\end{pmatrix}\n$$\n$$\n= \\overline{v_1}(v_1 + 100v_2) + \\overline{v_2}v_2 = |v_1|^2 + 100\\overline{v_1}v_2 + |v_2|^2\n$$\n使用条件 $|v_1|^2 + |v_2|^2 = 1$，该表达式简化为：\n$$\nv^* A v = 1 + 100\\overline{v_1}v_2\n$$\n因此，值域是集合 $W(A) = \\{ 1 + 100z : z = \\overline{v_1}v_2, |v_1|^2 + |v_2|^2 = 1 \\}$。\n\n我们必须确定复数 $z = \\overline{v_1}v_2$ 所有可能值的集合。设 $v_1 = r_1 e^{i\\theta_1}$ 和 $v_2 = r_2 e^{i\\theta_2}$，其中 $r_1, r_2 \\ge 0$ 且 $r_1^2 + r_2^2 = 1$。\n那么 $z = r_1 r_2 e^{i(\\theta_2 - \\theta_1)}$。由于角度 $(\\theta_2 - \\theta_1)$ 可以是 $[0, 2\\pi)$ 中的任何值，因此 $z$ 的值集合是一个以原点为中心，半径等于乘积 $r_1 r_2$ 最大可能值的圆盘。\n对于某个 $\\phi \\in [0, \\pi/2]$，设 $r_1 = \\cos\\phi$ 和 $r_2 = \\sin\\phi$。乘积为 $r_1 r_2 = \\cos\\phi \\sin\\phi = \\frac{1}{2}\\sin(2\\phi)$。该乘积的最大值为 $\\frac{1}{2}$，当 $\\phi = \\pi/4$ 时取得，对应于 $r_1 = r_2 = 1/\\sqrt{2}$。\n因此，$z = \\overline{v_1}v_2$ 的值集合是闭圆盘 $\\{ z \\in \\mathbb{C} : |z| \\le \\frac{1}{2} \\}$。\n\n因此，$100z$ 的值集合是闭圆盘 $\\{ w \\in \\mathbb{C} : |w| \\le 50 \\}$。\n值域 $W(A)$ 是通过将此圆盘平移 $1$ 得到的。\n$$\nW(A) = \\{ 1 + w : w \\in \\mathbb{C}, |w| \\le 50 \\} = \\{ \\zeta \\in \\mathbb{C} : |\\zeta - 1| \\le 50 \\}\n$$\n所以，$W(A)$ 是复平面中以 $1$ 为中心、半径为 $50$ 的闭圆盘。\n\n### 第 2 部分：$\\nu(A)$ 的确定\n\n量 $\\nu(A)$ 定义为值域中任意点的最小模：\n$$\n\\nu(A) = \\min\\{ |z| : z \\in W(A) \\}\n$$\n这是原点到集合 $W(A)$ 的距离。集合 $W(A)$ 是圆盘 $|\\zeta - 1| \\le 50$。圆盘的中心是 $c=1$，半径是 $R=50$。原点到中心的距离是 $|c|=1$。由于这个距离小于半径 ($1  50$)，原点 $z=0$ 包含在圆盘 $W(A)$ 内。\n因此，$W(A)$ 中点的最小模为 $0$。\n$$\n\\nu(A) = 0\n$$\n\n### 第 3 部分：谱范数 $\\|A\\|_2$ 的计算\n\n谱范数 $\\|A\\|_2$ 定义为 $\\|A\\|_2 = \\sqrt{\\lambda_{\\max}(A^*A)}$，其中 $\\lambda_{\\max}(A^*A)$ 是矩阵 $A^*A$ 的最大特征值。\n首先，我们计算 $A^*A$：\n$$\nA^* = \\begin{pmatrix} 1  0 \\\\ 100  1 \\end{pmatrix}\n$$\n$$\nA^*A = \\begin{pmatrix} 1  0 \\\\ 100  1 \\end{pmatrix} \\begin{pmatrix} 1  100 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  100 \\\\ 100  100^2 + 1 \\end{pmatrix} = \\begin{pmatrix} 1  100 \\\\ 100  10001 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A^*A - \\lambda I) = 0$ 来求 $A^*A$ 的特征值：\n$$\n\\det\\begin{pmatrix} 1-\\lambda  100 \\\\ 100  10001-\\lambda \\end{pmatrix} = (1-\\lambda)(10001-\\lambda) - 100^2 = 0\n$$\n$$\n\\lambda^2 - 10002\\lambda + 10001 - 10000 = 0\n$$\n$$\n\\lambda^2 - 10002\\lambda + 1 = 0\n$$\n使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{-(-10002) \\pm \\sqrt{(-10002)^2 - 4(1)(1)}}{2} = \\frac{10002 \\pm \\sqrt{100040004 - 4}}{2}\n$$\n$$\n\\lambda = \\frac{10002 \\pm \\sqrt{100040000}}{2} = \\frac{10002 \\pm 100\\sqrt{10004}}{2}\n$$\n简化平方根下的项：$10004 = 4 \\times 2501$。\n$$\n\\lambda = \\frac{10002 \\pm 100\\sqrt{4 \\times 2501}}{2} = \\frac{10002 \\pm 200\\sqrt{2501}}{2} = 5001 \\pm 100\\sqrt{2501}\n$$\n最大特征值为 $\\lambda_{\\max}(A^*A) = 5001 + 100\\sqrt{2501}$。\n谱范数是此值的平方根：\n$$\n\\|A\\|_2 = \\sqrt{5001 + 100\\sqrt{2501}}\n$$\n\n### 第 4 部分：GMRES Elman 界与差异\n\n基于值域的单步 GMRES 残差缩减的标准界通常由下式给出：\n$$\n\\frac{\\|r_1\\|_2}{\\|r_0\\|_2} \\le \\sqrt{1 - \\frac{\\nu(A)^2}{\\|A\\|_2^2}}\n$$\n此表达式作为单步缩减因子的上界。使用前面部分计算的值：\n\\begin{itemize}\n    \\item $\\nu(A) = 0$ (来自第 2 部分)\n    \\item $\\|A\\|_2 = \\sqrt{5001 + 100\\sqrt{2501}}$ (来自第 3 部分)\n\\end{itemize}\n将这些值代入界公式，我们得到保证的单步残差缩减因子：\n$$\n\\text{保证因子} = \\sqrt{1 - \\frac{0^2}{(\\sqrt{5001 + 100\\sqrt{2501}})^2}} = \\sqrt{1 - 0} = 1\n$$\n保证缩减因子为 $1$ 意味着该方法在单步中可能无法在减小残差范数方面取得任何进展；也就是说，可能出现停滞。\n\n现在，我们将此保证与 GMRES 的实际行为进行比较。\n实际的单步缩减由 $\\frac{\\|r_1\\|_2}{\\|r_0\\|_2} = \\sqrt{1 - \\frac{|v^*Av|^2}{\\|Av\\|_2^2}}$ 给出，其中 $v = r_0/\\|r_0\\|_2$。当项 $\\frac{|v^*Av|^2}{\\|Av\\|_2^2}$ 最小化时，出现最坏情况（最大）的缩减因子。如第 2 部分所示，可以找到一个向量 $v$ 使得 $v^*Av = 0$。对于这个向量，缩减因子为 $\\sqrt{1-0} = 1$。因此，最坏情况下的单步行为与悲观的界相符。\n\n然而，这个比较是不完整的，并且忽略了关键的差异。收敛界的主要功能是预测整体的收敛行为。每一步的 Elman 界为 $1$ 表明 GMRES 可能永远不会收敛。与此形成鲜明对比的是，对于任何 $N \\times N$ 矩阵，GMRES 保证在最多 $N$ 步内找到精确解（在精确算術中）。对于给定的 $2 \\times 2$ 矩阵 $A$，GMRES 必须在最多 $k=2$ 步内收敛，这意味着对于任何初始残差 $r_0$，都有 $\\|r_2\\|_2 = 0$（除非 $r_0$ 是一个特征向量，此时 $\\|r_1\\|_2=0$）。\n因此，差异是巨大的：界预测了可能完全失败，而算法保证在两步内完美成功。\n\n这种差异的原因在于矩阵 $A$ 的严重非正规性。值域 $W(A)$ 是 $A$ 的谱的一个非常差的近似，其谱仅包含一个点 $\\sigma(A)=\\{1\\}$。GMRES 是一种基于多项式的方法，其性能与多项式在谱上能变得多小密切相关。对于高度非正规的矩阵，矩阵多项式的范数 $\\|p(A)\\|$ 可能远大于 $|p(z)|$ 在谱上甚至值域上的最大值。依赖于 $W(A)$ 的 Elman 界未能捕捉到确保有限步终止的潜在代数结构。$\\nu(A)=0$ 和 $\\|A\\|_2 \\gg 1$ 是非正规性的产物，这使得这个特定的界对于预测 GMRES 在此矩阵上的实际优异性能毫无用处。\n\n由 Elman 界预测的保证单步残差缩减因子是从公式计算出的值。\n$$\n\\text{因子} = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3411886"}]}