{"hands_on_practices": [{"introduction": "共轭梯度（CG）方法是求解物理和工程模拟中常见的对称正定（SPD）线性系统的首选迭代求解器。这个练习将指导您对一个离散的泊松方程应用共轭梯度法的前两次迭代。通过这种方式，您将亲身体验如何构建和使用 $A$-正交搜索方向来有效地最小化误差，从而理解该方法的核心机制。[@problem_id:3338514]", "problem": "在计算流体力学的不可压缩流投影方法中，每个时间步的压力场是通过求解具有齐次狄利克雷边界条件的离散泊松方程得到的。考虑在单位区间上具有零狄利克雷边界条件的一维模型问题，该问题在包含$n=5$个内部点的均匀网格上离散化，从而得到一个具有标准三点模板的稀疏对称正定线性系统 $A x = b$。使用无量纲化的离散算子，该算子将网格间距因子吸收到右侧项中，因此系数矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 是一个三对角矩阵，其主对角线上的元素为 $2$，第一子对角线和第一超对角线上的元素为 $-1$，即：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}.\n$$\n假设在第一个内部节点上施加一个局部化的力，因此右侧项为 $b = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix}^{T}$，并选择初始猜测值 $x_{0} = \\begin{pmatrix} 0  0  0  0  0 \\end{pmatrix}^{T}$。\n\n从 Krylov 子空间迭代法和共轭梯度（CG）法的基本原理出发——即 $A$ 是对称正定的，残差为 $r_{k} = b - A x_{k}$，搜索方向是 $A$-共轭的，并且每一步都沿着仿射子空间最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{T} A x - b^{T} x$——推导应用于此系统的 CG 法的前两次迭代。具体来说，构造 $p_{0}$，通过沿 $p_{0}$ 执行线搜索最小化来计算步长 $\\alpha_{0}$，更新 $x_{1}$ 和 $r_{1}$，通过强制 $p_{1}$ 与 $p_{0}$ 的 $A$-共轭性来推导系数 $\\beta_{0}$，然后计算 $\\alpha_{1}$、$x_{2}$ 和 $r_{2}$。\n\n按以下方式报告最终结果：\n- 提供 $x_{2}$ 的五个分量，后跟 $\\|r_{2}\\|_{2}$ 的值，所有值均为精确有理数。\n- 将最终答案表示为单行，使用括号，按顺序列出 $x_{2}$ 的条目，然后将 $\\|r_{2}\\|_{2}$ 作为最后一项，不带单位。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、良定性、客观性，并包含推导唯一解所需的所有必要信息。所描述的线性系统和共轭梯度（CG）法是数值线性代数和计算科学中的标准课题。\n\n任务是计算共轭梯度（CG）法求解线性系统 $A x = b$ 的前两次迭代，其中矩阵 $A$、右侧向量 $b$ 和初始猜测值 $x_0$ 由下式给出：\n$$ A = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n矩阵 $A$ 是对称正定的，这是 CG 方法的先决条件。CG 算法迭代地构造一个近似解序列 $x_k$，以最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^T A x - b^T x$。\n\n**初始化 ($k=0$)**\n\n首先，我们计算初始残差 $r_0$。残差定义为 $r_k = b - A x_k$。\n对于 $k=0$，我们有：\n$$ r_0 = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n初始搜索方向 $p_0$ 设置为等于初始残差：\n$$ p_0 = r_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第一次迭代 ($k=0$)**\n\n第一步是计算最优步长 $\\alpha_0$，它使得 $\\phi(x_0 + \\alpha_0 p_0)$ 最小化。这个条件等价于使新残差 $r_1$ 与搜索方向 $p_0$ 正交，即 $r_1^T p_0 = 0$。由于 $r_1 = r_0 - \\alpha_0 A p_0$，我们有 $(r_0 - \\alpha_0 A p_0)^T p_0 = 0$，这给出了 $\\alpha_0$ 的公式：\n$$ \\alpha_0 = \\frac{r_0^T p_0}{p_0^T A p_0} $$\n由于 $p_0 = r_0$，这可以简化为 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$。首先，我们计算分子：\n$$ r_0^T r_0 = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1 $$\n接下来，我们计算矩阵-向量乘积 $A p_0$：\n$$ A p_0 = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n现在，我们计算 $\\alpha_0$ 的分母：\n$$ p_0^T A p_0 = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2 $$\n因此，步长 $\\alpha_0$ 是：\n$$ \\alpha_0 = \\frac{1}{2} $$\n现在我们可以更新解向量 $x_1$：\n$$ x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n以及残差向量 $r_1$：\n$$ r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 1 \\\\ 0 - (-\\frac{1}{2}) \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第二次迭代 ($k=1$)**\n\n首先，我们确定新的搜索方向 $p_1 = r_1 + \\beta_0 p_0$。选择系数 $\\beta_0$ 以强制 $p_1$ 和 $p_0$ 之间 $A$-共轭，即 $p_1^T A p_0 = 0$。\n$$ (r_1 + \\beta_0 p_0)^T A p_0 = 0 \\implies r_1^T A p_0 + \\beta_0 p_0^T A p_0 = 0 $$\n求解 $\\beta_0$：\n$$ \\beta_0 = - \\frac{r_1^T A p_0}{p_0^T A p_0} $$\n我们有前一步得到的向量 $r_1$、$A p_0$ 和值 $p_0^T A p_0=2$。分子是：\n$$ r_1^T A p_0 = \\begin{pmatrix} 0  1/2  0  0  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = -\\frac{1}{2} $$\n因此，$\\beta_0$ 是：\n$$ \\beta_0 = - \\frac{-1/2}{2} = \\frac{1}{4} $$\n一个常见的替代公式是 $\\beta_0 = (r_1^T r_1) / (r_0^T r_0)$。我们来验证一下：$r_1^T r_1 = (1/2)^2 = 1/4$ 且 $r_0^T r_0 = 1$，得到 $\\beta_0 = 1/4$，这是一致的。\n\n现在我们构造新的搜索方向 $p_1$：\n$$ p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n接下来，我们计算步长 $\\alpha_1$：\n$$ \\alpha_1 = \\frac{r_1^T r_1}{p_1^T A p_1} $$\n分子是 $r_1^T r_1 = 1/4$。对于分母，我们首先需要 $A p_1$：\n$$ A p_1 = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(\\frac{1}{4}) - 1(\\frac{1}{2}) \\\\ -1(\\frac{1}{4}) + 2(\\frac{1}{2}) \\\\ 0 - 1(\\frac{1}{2}) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n那么，分母是：\n$$ p_1^T A p_1 = \\begin{pmatrix} 1/4  1/2  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = (\\frac{1}{4})(0) + (\\frac{1}{2})(\\frac{3}{4}) = \\frac{3}{8} $$\n所以步长 $\\alpha_1$ 是：\n$$ \\alpha_1 = \\frac{1/4}{3/8} = \\frac{1}{4} \\cdot \\frac{8}{3} = \\frac{2}{3} $$\n我们更新解以得到 $x_2$：\n$$ x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3/6 + 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2/3 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n最后，我们计算新的残差 $r_2$：\n$$ r_2 = r_1 - \\alpha_1 A p_1 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{2}{3} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1/2 \\\\ -1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n问题要求 $x_2$ 的五个分量和 $r_2$ 的欧几里得范数，记为 $\\|r_2\\|_2$。\n$x_2$ 的分量是 $\\frac{2}{3}$、$\\frac{1}{3}$、$0$、$0$、$0$。\n$r_2$ 的范数是：\n$$ \\|r_2\\|_2 = \\sqrt{0^2 + 0^2 + (1/3)^2 + 0^2 + 0^2} = \\sqrt{\\frac{1}{9}} = \\frac{1}{3} $$\n最终结果由 $x_2$ 的五个分量和 $\\|r_2\\|_2$ 的值组成。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3}  0  0  0  \\frac{1}{3} \\end{pmatrix}} $$", "id": "3338514"}, {"introduction": "当矩阵非对称时，共轭梯度法不再适用，此时便需要通用最小残差（GMRES）方法。本练习将引导您执行单步GMRES迭代，通过构建克雷洛夫子空间的一组标准正交基，并求解一个微型最小二乘问题来寻找最佳近似解，从而揭示GMRES的核心思想。[@problem_id:3338495]", "problem": "在计算流体动力学（CFD）中，输运-扩散算子的隐式时间积分和线性化会产生形如 $A x = b$ 的线性系统，该系统必须得到高效求解。Krylov子空间迭代法通过在由系统矩阵的重复应用所生成的空间中最小化残差来构造近似解。考虑由 $3 \\times 3$ 矩阵\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n0  3  1 \\\\\n0  0  2\n\\end{pmatrix}\n$$\n和右端项\n$$\nb = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}\n$$\n定义的线性系统，其初始近似解为 $x_{0} = \\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$。使用广义最小残差（GMRES）方法，执行恰好一次迭代（即，构造一维Krylov子空间并基于使用欧几里得内积的Arnoldi过程计算相应的GMRES更新）以获得 $x_{1}$。然后，计算残差 $r_{1} = b - A x_{1}$ 的欧几里得范数。\n\n请以精确形式表示最终的残差范数，无需四舍五入。不需要物理单位。", "solution": "该问题定义明确，要求应用广义最小残差（GMRES）方法进行一次迭代。我们已知矩阵 $A$、右端向量 $b$ 和初始近似解 $x_0$。我们必须计算一次迭代后的残差的欧几里得范数 $\\|r_1\\|_2$。\n\nGMRES方法从仿射空间 $x_0 + \\mathcal{K}_m(A, r_0)$ 中生成一个近似解 $x_m$，其中 $\\mathcal{K}_m(A, r_0)$ 是第 $m$ 个Krylov子空间。选择解 $x_m$ 以最小化残差的欧几里得范数 $\\|b - A x_m\\|_2$。我们执行一次迭代的步骤，其中 $m=1$。\n\n首先，我们计算初始残差 $r_0$。\n$$\nr_0 = b - A x_0\n$$\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$，项 $A x_0$ 是零向量。因此，初始残差等于 $b$：\n$$\nr_0 = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们计算 $r_0$ 的欧几里得范数：\n$$\n\\|r_0\\|_2 = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\nGMRES方法使用Arnoldi过程为Krylov子空间 $\\mathcal{K}_1(A, r_0) = \\text{span}\\{r_0\\}$ 构建一个标准正交基。对于 $m=1$，这个基由单个向量 $v_1$ 组成，它是归一化的初始残差。\n$$\nv_1 = \\frac{r_0}{\\|r_0\\|_2} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n更新后的近似解 $x_1$ 具有形式 $x_1 = x_0 + z_1$，其中 $z_1 \\in \\mathcal{K}_1(A, r_0)$。这意味着 $z_1$ 可以写成 $v_1$ 的标量倍数，即对于某个标量 $y_1 \\in \\mathbb{R}$，有 $z_1 = y_1 v_1$。GMRES方法通过求解一个最小二乘问题来找到最优的 $y_1$。\n近似解为 $x_1 = x_0 + y_1 v_1$。\n相应的残差为 $r_1 = b - A x_1 = b - A(x_0 + y_1 v_1) = (b - A x_0) - y_1 A v_1 = r_0 - y_1 A v_1$。\n选择系数 $y_1$ 以最小化 $\\|r_1\\|_2 = \\|r_0 - y_1 A v_1\\|_2$。这是一个经典的线性最小二乘问题，我们正在由 $A v_1$ 张成的子空间中寻找向量 $r_0$ 的最佳近似。解 $y_1 A v_1$ 是 $r_0$ 在 $A v_1$ 上的正交投影。这导出了正规方程：\n$$\n(A v_1)^T (r_0 - y_1 A v_1) = 0\n$$\n解出 $y_1$ 得：\n$$\ny_1 = \\frac{(A v_1)^T r_0}{(A v_1)^T (A v_1)} = \\frac{(A v_1)^T r_0}{\\|A v_1\\|_2^2}\n$$\n我们计算必要的组成部分。首先，向量 $A v_1$：\n$$\nA v_1 = \\begin{pmatrix} 4  1  0 \\\\ 0  3  1 \\\\ 0  0  2 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n现在，我们计算 $y_1$ 表达式的分子：\n$$\n(A v_1)^T r_0 = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5  4  2 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{3}}(5 \\cdot 1 + 4 \\cdot 1 + 2 \\cdot 1) = \\frac{11}{\\sqrt{3}}\n$$\n接下来，我们计算分母：\n$$\n\\|A v_1\\|_2^2 = \\left\\| \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} \\right\\|_2^2 = \\frac{1}{(\\sqrt{3})^2} (5^2 + 4^2 + 2^2) = \\frac{1}{3}(25 + 16 + 4) = \\frac{45}{3} = 15\n$$\n现在我们可以计算 $y_1$：\n$$\ny_1 = \\frac{11/\\sqrt{3}}{15} = \\frac{11}{15\\sqrt{3}}\n$$\n我们现在可以找到新的近似解 $x_1$：\n$$\nx_1 = x_0 + y_1 v_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{11}{15\\sqrt{3}} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{15 \\cdot 3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n问题要求计算残差 $r_1 = b - A x_1$ 的欧几里得范数。让我们计算 $r_1$：\n$$\nA x_1 = \\begin{pmatrix} 4  1  0 \\\\ 0  3  1 \\\\ 0  0  2 \\end{pmatrix} \\left( \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{45} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n$$\nr_1 = b - A x_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{55}{45} \\\\ 1 - \\frac{44}{45} \\\\ 1 - \\frac{22}{45} \\end{pmatrix} = \\begin{pmatrix} \\frac{45-55}{45} \\\\ \\frac{45-44}{45} \\\\ \\frac{45-22}{45} \\end{pmatrix} = \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{pmatrix}\n$$\n最后，我们计算 $r_1$ 的欧几里得范数：\n$$\n\\|r_1\\|_2 = \\left\\| \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{pmatrix} \\right\\|_2 = \\frac{1}{45} \\sqrt{(-10)^2 + 1^2 + 23^2}\n$$\n平方根内的项是：\n$(-10)^2 = 100$\n$1^2 = 1$\n$23^2 = 529$\n将它们相加得到 $100 + 1 + 529 = 630$。所以，\n$$\n\\|r_1\\|_2 = \\frac{\\sqrt{630}}{45}\n$$\n为简化表达式，我们对数字 $630$ 进行因式分解：\n$$\n630 = 63 \\times 10 = (9 \\times 7) \\times (2 \\times 5) = 3^2 \\times 70\n$$\n因此，$\\sqrt{630} = \\sqrt{3^2 \\times 70} = 3\\sqrt{70}$。\n将此代入范数的表达式中：\n$$\n\\|r_1\\|_2 = \\frac{3\\sqrt{70}}{45} = \\frac{\\sqrt{70}}{15}\n$$\n这是GMRES一次迭代后残差的欧几里得范数的最终精确值。", "answer": "$$\n\\boxed{\\frac{\\sqrt{70}}{15}}\n$$", "id": "3338495"}, {"introduction": "GMRES的收敛性并不仅仅由矩阵的特征值决定。这个发人深省的练习将挑战您构建一个矩阵，使得GMRES在第一步迭代中完全停滞不前，这种现象被称为“停滞”。通过探索矩阵的非正规性这一概念，您将更深刻地理解迭代方法的精妙之处，以及为何简单的特征值分析有时会产生误导。[@problem_id:3338518]", "problem": "考虑一个源于计算流体力学的线性对流-扩散算子的半离散双单元模型，该模型产生一个形如 $A x = b$ 的线性系统，其中 $A \\in \\mathbb{R}^{2 \\times 2}$。在对流主导的情况下，由于上风偏置耦合，离散化矩阵通常是强非正规的。设构造的矩阵 $A$ 的特征值为 $1$ 和 $2$，其非正规性由一个非对角耦合参数控制。您将分析广义最小残差 (GMRES) 方法，以揭示由非正规性引起的停滞现象，并通过若尔当范式或伪谱来解释这一现象。\n\n任务：\n- 构造一个显式的非正规矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$，其特征值为 $1$ 和 $2$，该矩阵模拟一个双单元对流-扩散耦合。使用定义“在 $\\mathbb{R}^{2}$ 的欧几里得内积中，当且仅当 $A A^{\\top} = A^{\\top} A$ 时，$A$ 是正规的”来证明您构造的 $A$ 是非正规的。\n- 选择右端项 $b \\in \\mathbb{R}^{2}$ 和初始猜测值 $x_{0} \\in \\mathbb{R}^{2}$，使得初始残差 $r_{0} = b - A x_{0}$ 在欧几里得内积中与其像 $A r_{0}$ 正交。\n- 仅使用克雷洛夫子空间和 GMRES 的核心定义：$k$ 阶克雷洛夫子空间是 $\\mathcal{K}_{k}(A, r_{0}) = \\operatorname{span}\\{r_{0}, A r_{0}, \\dots, A^{k-1} r_{0}\\}$，并且 GMRES 选择 $x_{k} \\in x_{0} + \\mathcal{K}_{k}(A, r_{0})$ 以最小化 $\\|b - A x_{k}\\|_{2}$。\n- 基于若尔当标准型或伪谱的推理，解释为何尽管谱是良性的，这种非正规性仍会导致 GMRES 残差在初始迭代中停滞。您的解释必须将 $A$ 的代数结构（例如，与具有病态相似变换的对角若尔当范式的相似性）或伪谱的大小与 GMRES 残差的短期行为联系起来。\n- 对于您的显式构造，计算一步 GMRES 残差范数比 $\\rho_{1} = \\|r_{1}\\|_{2}/\\|r_{0}\\|_{2}$，其中 $r_{1}$ 是在精确算术下从 $x_{0}$ 开始进行一次 GMRES 迭代后的残差。将您关于 $\\rho_{1}$ 的最终答案表示为一个无单位的纯数字。无需四舍五入。\n\n答案格式要求：您的最终答案必须是等于 $\\rho_{1}$ 计算值的单个实数，无单位。", "solution": "该问题要求构造一个非正规的 $2 \\times 2$ 矩阵 $A$，以展示广义最小残差 (GMRES) 方法的一种特定失效模式，即停滞。分析过程包括构建矩阵、选择具有特定属性的初始残差向量、解释停滞的原因，并计算一步残差范数缩减因子。\n\n首先，我们构造一个特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 2$ 的矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$。上三角矩阵是模拟对流主导现象和显式设置特征值的自然选择。设矩阵形式如下：\n$$\nA = \\begin{pmatrix} 1  \\gamma \\\\ 0  2 \\end{pmatrix}\n$$\n三角矩阵的特征值是其对角线元素，因此它们确实是 $1$ 和 $2$。参数 $\\gamma \\in \\mathbb{R}$ 控制矩阵 $A$ 的非正规性。一个矩阵是正规的，如果它与其转置可交换，即 $A A^{\\top} = A^{\\top} A$。我们计算这两个乘积：\n$$\nA A^{\\top} = \\begin{pmatrix} 1  \\gamma \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ \\gamma  2 \\end{pmatrix} = \\begin{pmatrix} 1 + \\gamma^2  2\\gamma \\\\ 2\\gamma  4 \\end{pmatrix}\n$$\n$$\nA^{\\top} A = \\begin{pmatrix} 1  0 \\\\ \\gamma  2 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma \\\\ \\gamma  \\gamma^2 + 4 \\end{pmatrix}\n$$\n要使 $A$ 为正规矩阵，必须有 $A A^{\\top} = A^{\\top} A$，这要求 $1 + \\gamma^2 = 1$、$2\\gamma = \\gamma$ 和 $4 = \\gamma^2+4$。这三个方程都意味着 $\\gamma = 0$。因此，对于任何非零值 $\\gamma$，矩阵 $A$ 都是非正规的。\n\n接下来，我们必须选择一个右端项 $b \\in \\mathbb{R}^2$ 和一个初始猜测值 $x_0 \\in \\mathbb{R}^2$，使得初始残差 $r_0 = b - Ax_0$ 与其在 $A$ 下的像正交，即 $r_0^{\\top} (A r_0) = 0$。最简单的方法是设 $x_0 = 0$，这样就有 $r_0 = b$。我们必须找到一个满足此正交条件的非零向量 $r_0 = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$。\n条件是 $r_0^{\\top} A r_0 = 0$：\n$$\n\\begin{pmatrix} u  v \\end{pmatrix} \\begin{pmatrix} 1  \\gamma \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} u  v \\end{pmatrix} \\begin{pmatrix} u + \\gamma v \\\\ 2v \\end{pmatrix} = u(u + \\gamma v) + 2v^2 = u^2 + \\gamma u v + 2v^2 = 0\n$$\n为了找到一个非平凡解（其中 $u$ 和 $v$ 不全为零），我们可以假设 $v \\neq 0$ 并除以 $v^2$ 来获得关于比率 $t = u/v$ 的二次方程：\n$$\nt^2 + \\gamma t + 2 = 0\n$$\n为了使这个二次方程有实数解 $t$，判别式必须为非负：$\\Delta = \\gamma^2 - 4(1)(2) = \\gamma^2 - 8 \\ge 0$。这对我们选择 $\\gamma$ 施加了一个约束：我们必须有 $|\\gamma| \\ge \\sqrt{8} = 2\\sqrt{2}$。为了使计算简单，我们选择 $\\gamma=3$，这满足此条件。对于 $\\gamma=3$，关于 $t$ 的方程变为：\n$$\nt^2 + 3t + 2 = 0 \\implies (t+1)(t+2) = 0\n$$\n这给出了两个可能的比率：$t = -1$ 或 $t = -2$。我们选择 $t = u/v = -1$。设 $v=1$ 得到 $u=-1$。因此，一个合适的初始残差是：\n$$\nr_0 = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n根据这个选择，我们设置初始猜测值 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 和右端项 $b = r_0 = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。我们的特定矩阵是 $A = \\begin{pmatrix} 1  3 \\\\ 0  2 \\end{pmatrix}$。\n\nGMRES 的停滞现象可以通过分析第一次迭代来解释。GMRES 寻找一个解 $x_k \\in x_0 + \\mathcal{K}_k(A, r_0)$，其中 $\\mathcal{K}_k(A, r_0) = \\operatorname{span}\\{r_0, Ar_0, \\dots, A^{k-1}r_0\\}$，该解最小化残差的 2-范数 $\\|b-Ax_k\\|_2$。\n对于第一步 ($k=1$)，我们寻找 $x_1 = x_0 + c_0 r_0$（对于某个标量 $c_0 \\in \\mathbb{R}$），以最小化 $\\|b - A(x_0 + c_0 r_0)\\|_2$。这等价于最小化新残差 $r_1$ 的范数：\n$$\n\\|r_1\\|_2 = \\|(b - A x_0) - c_0 A r_0\\|_2 = \\|r_0 - c_0 A r_0\\|_2\n$$\n这是一个关于 $c_0$ 的线性最小二乘问题。最小化此范数的 $c_0$ 值，是使新残差 $r_1$ 与更新量所在的空间 $A\\mathcal{K}_1(A,r_0) = \\text{span}\\{Ar_0\\}$ 正交的值。因此，我们必须有 $(r_1)^{\\top} (A r_0) = 0$：\n$$\n(r_0 - c_0 A r_0)^{\\top} (A r_0) = 0 \\implies r_0^{\\top}(A r_0) - c_0 (A r_0)^{\\top}(A r_0) = 0\n$$\n求解 $c_0$ 得：\n$$\nc_0 = \\frac{r_0^{\\top}(A r_0)}{\\|A r_0\\|_2^2}\n$$\n根据我们对 $r_0$ 的显式构造，分子 $r_0^{\\top}(A r_0)$ 为零。因此，$c_0 = 0$。\n这意味着解的更新量为零：$x_1 = x_0 + 0 \\cdot r_0 = x_0$。因此，残差不变：$r_1 = b - A x_1 = b - A x_0 = r_0$。这构成了第一次迭代中的完全停滞。\n\n这一现象是 $A$ 的非正规性的直接后果。对于一个正规矩阵，其数值范围（或值域）$W(A) = \\{ v^{\\top}Av / v^{\\top}v : v \\in \\mathbb{R}^n, v \\neq 0 \\}$ 是其特征值的凸包。对于我们的矩阵 $A$，特征值是 $1$ 和 $2$，所以如果 $A$ 是正规的，$W(A)$ 将是区间 $[1, 2]$。在这种情况下，对于任何非零向量 $v$，$v^{\\top}Av$ 永远不可能为零。然而，由于 $A$ 是非正规的，其数值范围大于其特征值的凸包。我们的构造找到了一个向量 $r_0$，使得 $r_0^{\\top}Ar_0 = 0$，这证明了 $0 \\in W(A)$。正是这种方向的存在，即数值范围远离特征值延伸（以至于包含 $0$），才导致了所观察到的病态行为。众所周知，对于数值范围包含原点的矩阵，GMRES 的性能很差，而我们对 $r_0$ 的选择恰好将算法引向了这个陷阱。若尔当范式分析会显示，$A$ 的特征向量是病态的（对于大的 $\\gamma$ 几乎平行），这是强非正规性的另一种表现，会导致矩阵幂的瞬态增长和 GMRES 的不良性能。\n\n最后，我们计算一步 GMRES 残差范数比 $\\rho_1 = \\|r_1\\|_2 / \\|r_0\\|_2$。如上所述，对于我们构造的问题，$c_0 = 0$，这导致 $r_1 = r_0$。因此：\n$$\n\\rho_1 = \\frac{\\|r_1\\|_2}{\\|r_0\\|_2} = \\frac{\\|r_0\\|_2}{\\|r_0\\|_2} = 1\n$$\n这证实了在第一步中残差范数完全没有减小。", "answer": "$$ \\boxed{1} $$", "id": "3338518"}]}