{"hands_on_practices": [{"introduction": "掌握有限元方法的第一步是深刻理解其基石——形函数（或基函数）的构造。本练习将引导你完成一个基础但至关重要的任务：在一个具体的三角形单元上，从零开始推导一个三次拉格朗日基函数。你将利用重心坐标这一优雅的工具，它能将复杂的多元多项式问题转化为简洁的形式，从而清晰地揭示拉格朗日插值基函数的核心性质 [@problem_id:3413665]。", "problem": "考虑三角形有限元 $T \\subset \\mathbb{R}^{2}$，其顶点为 $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$ 和 $\\boldsymbol{v}_{3}=(1,3)$。该有限元用于标准Lagrange有限元族中，以离散化偏微分方程（PDE）。设 $\\lambda_{1}$, $\\lambda_{2}$ 和 $\\lambda_{3}$ 表示 $T$ 上的重心（面积）坐标，由关系式 $\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$ 和 $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$ 定义，其中 $\\boldsymbol{x}=(x,y)\\in T$。\n\n对于 $T$ 上的三次Lagrange有限元，节点集由三个顶点、每条边上对应于重心坐标对 $(\\frac{1}{3},\\frac{2}{3})$ 和 $(\\frac{2}{3},\\frac{1}{3})$ 的六个边内部点，以及一个重心坐标为 $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$ 的内部点组成。请仅从单纯形上的重心坐标定义和节点Lagrange插值的定义性质（即，一个基函数在其关联节点处等于 $1$，在所有其他节点处等于 $0$）出发，推导唯一的的多项式 $\\varphi_{\\mathrm{int}}\\in \\mathbb{P}_{3}(T)$（$T$ 上总次数最多为 $3$ 的二元多项式空间），该多项式是与内部节点 $(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3})$ 关联的节点基函数，并将 $\\varphi_{\\mathrm{int}}$ 显式地表示为用笛卡尔坐标 $(x,y)$ 表示的单个闭式多项式。\n\n您的最终答案必须是一个用 $(x,y)$ 表示的单闭式解析表达式。无需四舍五入。", "solution": "所给问题具有科学依据、是适定且客观的。它代表了有限元方法理论中的一个标准练习。存在唯一解，并且可以从给定的定义和条件中推导出来。\n\n任务是找到与三次Lagrange三角形单元的内部节点相关联的节点基函数 $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$。$\\mathbb{P}_{3}(T)$ 是总次数最多为 $3$ 的二元多项式空间。节点基函数的定义性质是，它在其关联节点处等于 $1$，在节点集中的所有其他节点处等于 $0$。\n\n**步骤 1：用重心坐标构造基函数。**\n重心坐标 $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$ 是笛卡尔坐标 $(x,y)$ 的线性函数。在约束条件 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$ 下，$(\\lambda_1, \\lambda_2, \\lambda_3)$ 中的 $k$ 次多项式对应于 $(x,y)$ 中的 $k$ 次多项式。\n\n一个三次Lagrange单元的节点集由 $10$ 个点组成。这些节点的重心坐标为 $(\\frac{i}{3}, \\frac{j}{3}, \\frac{k}{3})$，其中 $i,j,k$ 是非负整数且满足 $i+j+k=3$。\n问题将节点指定为：\n- $3$ 个顶点：$(1,0,0)$, $(0,1,0)$, $(0,0,1)$。\n- $6$ 个边上点：$(\\frac{2}{3}, \\frac{1}{3}, 0)$, $(\\frac{1}{3}, \\frac{2}{3}, 0)$, $(0, \\frac{2}{3}, \\frac{1}{3})$, $(0, \\frac{1}{3}, \\frac{2}{3})$, $(\\frac{1}{3}, 0, \\frac{2}{3})$, $(\\frac{2}{3}, 0, \\frac{1}{3})$。\n- $1$ 个内部点：$(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$。\n\n基函数 $\\varphi_{\\mathrm{int}}$ 在除内部节点 $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$ 之外的所有节点上都必须等于 $0$。注意到，这其他 $9$ 个节点都位于三角形 $T$ 的边界上。$T$ 的边界由至少有一个重心坐标为零的线定义，即点集满足 $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$。\n\n由于 $\\varphi_{\\mathrm{int}}$ 是一个在集合 $\\lambda_{1}\\lambda_{2}\\lambda_{3} = 0$ 上为零的多项式，它必须能被多项式 $\\lambda_{1}\\lambda_{2}\\lambda_{3}$ 整除。因此，$\\varphi_{\\mathrm{int}}$ 可以写成以下形式：\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = C \\cdot \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\n其中 $C$ 为某个常数。乘积 $\\lambda_{1}\\lambda_{2}\\lambda_{3}$ 是一个 $3$ 次多项式。由于 $\\varphi_{\\mathrm{int}} \\in \\mathbb{P}_{3}(T)$，因子 $C$ 必须是一个常数（$0$ 次多项式）。\n\n为了确定常数 $C$，我们使用条件 $\\varphi_{\\mathrm{int}}=1$ 在其关联节点处，即重心坐标为 $(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$ 的内部节点。\n$$ \\varphi_{\\mathrm{int}}\\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right) = C \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{3}\\right) = 1 $$\n$$ C \\cdot \\frac{1}{27} = 1 \\implies C = 27 $$\n因此，用重心坐标表示的基函数是：\n$$ \\varphi_{\\mathrm{int}}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = 27 \\lambda_{1} \\lambda_{2} \\lambda_{3} $$\n\n**步骤 2：将重心坐标转换为笛卡尔坐标。**\n点 $\\boldsymbol{x}=(x,y)$ 与其关于顶点 $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,1)$ 和 $\\boldsymbol{v}_{3}=(1,3)$ 的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 之间的关系由下式给出：\n$$ \\boldsymbol{x} = \\lambda_{1}\\boldsymbol{v}_{1} + \\lambda_{2}\\boldsymbol{v}_{2} + \\lambda_{3}\\boldsymbol{v}_{3} $$\n$$ \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 $$\n代入顶点坐标：\n$$ \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\lambda_1 \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\lambda_2 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} + \\lambda_3 \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} $$\n这产生一个关于 $\\lambda_2$ 和 $\\lambda_3$ 的二元方程组：\n$$ x = 2\\lambda_2 + \\lambda_3 $$\n$$ y = \\lambda_2 + 3\\lambda_3 $$\n我们求解这个方程组。由第二个方程，$\\lambda_2 = y - 3\\lambda_3$。将此代入第一个方程：\n$$ x = 2(y - 3\\lambda_3) + \\lambda_3 = 2y - 6\\lambda_3 + \\lambda_3 = 2y - 5\\lambda_3 $$\n$$ 5\\lambda_3 = 2y - x \\implies \\lambda_3(x,y) = \\frac{1}{5}(2y-x) $$\n现在我们求 $\\lambda_2$：\n$$ \\lambda_2 = y - 3\\left(\\frac{1}{5}(2y-x)\\right) = y - \\frac{6}{5}y + \\frac{3}{5}x = \\frac{5y-6y}{5} + \\frac{3x}{5} = \\frac{3x-y}{5} $$\n所以，$\\lambda_2(x,y) = \\frac{1}{5}(3x-y)$。\n最后，我们用 $\\lambda_1 = 1-\\lambda_2-\\lambda_3$ 来求 $\\lambda_1$：\n$$ \\lambda_1 = 1 - \\frac{1}{5}(3x-y) - \\frac{1}{5}(2y-x) = \\frac{1}{5}(5 - (3x-y) - (2y-x)) $$\n$$ \\lambda_1 = \\frac{1}{5}(5 - 3x + y - 2y + x) = \\frac{1}{5}(5 - 2x - y) $$\n所以，坐标变换为：\n$$ \\lambda_{1}(x,y) = \\frac{1}{5}(5 - 2x - y) $$\n$$ \\lambda_{2}(x,y) = \\frac{1}{5}(3x - y) $$\n$$ \\lambda_{3}(x,y) = \\frac{1}{5}(2y - x) $$\n\n**步骤 3：将 $\\varphi_{\\mathrm{int}}$ 表示为 $(x,y)$ 的多项式。**\n我们将 $\\lambda_1$, $\\lambda_2$ 和 $\\lambda_3$ 的表达式代入 $\\varphi_{\\mathrm{int}}$ 的重心坐标形式中：\n$$ \\varphi_{\\mathrm{int}}(x,y) = 27 \\left( \\frac{1}{5}(5 - 2x - y) \\right) \\left( \\frac{1}{5}(3x - y) \\right) \\left( \\frac{1}{5}(2y - x) \\right) $$\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125} (5 - 2x - y)(3x - y)(2y - x) $$\n现在，我们展开这三个线性因子的乘积。首先，我们乘以后两个因子：\n$$ (3x - y)(2y - x) = 6xy - 3x^2 - 2y^2 + xy = -3x^2 + 7xy - 2y^2 $$\n接下来，我们将这个结果与第一个因子 $(5 - 2x - y)$ 相乘：\n$$ (5 - 2x - y)(-3x^2 + 7xy - 2y^2) = 5(-3x^2 + 7xy - 2y^2) - 2x(-3x^2 + 7xy - 2y^2) - y(-3x^2 + 7xy - 2y^2) $$\n$$ = (-15x^2 + 35xy - 10y^2) + (6x^3 - 14x^2y + 4xy^2) + (3x^2y - 7xy^2 + 2y^3) $$\n我们按次数和字典序合并同类项：\n- 三次项 ($x^3, x^2y, xy^2, y^3$)：$6x^3 + (-14+3)x^2y + (4-7)xy^2 + 2y^3 = 6x^3 - 11x^2y - 3xy^2 + 2y^3$\n- 二次项 ($x^2, xy, y^2$)：$-15x^2 + 35xy - 10y^2$\n- 一次项和常数项：没有。\n\n合并所有项，展开后的多项式为：\n$$ 6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2 $$\n最后，我们乘以常数因子 $\\frac{27}{125}$ 得到 $\\varphi_{\\mathrm{int}}(x,y)$ 的表达式。\n\n$$ \\varphi_{\\mathrm{int}}(x,y) = \\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2) $$\n这是 $\\mathbb{P}_{3}(T)$ 中满足所需节点性质的唯一多项式。", "answer": "$$\n\\boxed{\\frac{27}{125}(6x^3 - 11x^2y - 3xy^2 + 2y^3 - 15x^2 + 35xy - 10y^2)}\n$$", "id": "3413665"}, {"introduction": "在实践中，为每个不同形状的单元单独构造基函数是低效的。一个更通用、更强大的方法是在一个简单的“参考单元”上定义基函数，然后通过映射将其转换到任意形状的“物理单元”上。本练习旨在让你掌握这种被称为“等参映射”的核心技术，并进一步探讨一个关键问题：从参考单元到物理单元的几何变形如何影响数值方法的稳定性？[@problem_id:3413676]。通过推导稳定性常数，你将理解单元畸变（distortion）与插值误差之间的深刻联系。", "problem": "考虑参考二维单纯形（参考三角形）$\\hat{T}$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。令 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 表示 $\\hat{T}$ 上的重心坐标，因此 $\\lambda_{1} + \\lambda_{2} + \\lambda_{3} = 1$ 且在 $\\hat{T}$ 上每个 $\\lambda_{i} \\geq 0$。次数为 $k=2$ 的 Lagrange 多项式族（记为 $P_{2}$）的节点集由三个顶点和三条边的中点组成。\n\n1) 仅使用重心坐标和 Lagrange 插值的定义属性（Kronecker-delta 节点条件和多项式次数约束），构造以下显式公式：\n- 与顶点 $1$（节点处 $\\lambda_{1}=1$ 且 $\\lambda_{2}=\\lambda_{3}=0$）相关的二次 Lagrange 基函数，以及\n- 与连接顶点 $1$ 和 $2$ 的边上的中点（节点处 $\\lambda_{1}=\\lambda_{2}=\\frac{1}{2}$ 且 $\\lambda_{3}=0$）相关的二次 Lagrange 基函数。\n\n2) 考虑一个弯曲的物理三角形单元 $E \\subset \\mathbb{R}^{2}$，它是通过使用相同的 $P_{2}$ 基函数构造的 $2$ 次等参映射 $F:\\hat{T}\\to E$ 得到的，即 $F(\\hat{x})=\\sum_{a=1}^{6} N_{a}(\\hat{x}) X_{a}$，其中 $N_{a}$ 是 $\\hat{T}$ 上的二次 Lagrange 基函数，$X_{a}\\in \\mathbb{R}^{2}$ 是对应的几何控制点。令 $A(\\hat{x})=\\nabla F(\\hat{x})$ 为雅可比矩阵，并令 $J(\\hat{x})=\\det A(\\hat{x})$ 表示雅可比行列式。对于每个 $\\hat{x}\\in \\hat{T}$，分别用 $s_{\\min}(A(\\hat{x}))$ 和 $s_{\\max}(A(\\hat{x}))$ 表示 $A(\\hat{x})$ 的最小和最大奇异值。假设 $F$ 在 $\\hat{T}$ 上是单射的，$A(\\hat{x})$ 对所有 $\\hat{x}\\in \\hat{T}$ 都是非奇异的，并且保持定向，即对所有 $\\hat{x}\\in \\hat{T}$ 都有 $J(\\hat{x})0$。定义极值\n$$\nJ_{-}=\\inf_{\\hat{x}\\in \\hat{T}} J(\\hat{x}),\\quad J_{+}=\\sup_{\\hat{x}\\in \\hat{T}} J(\\hat{x}),\\quad s_{-}=\\inf_{\\hat{x}\\in \\hat{T}} s_{\\min}(A(\\hat{x})),\\quad s_{+}=\\sup_{\\hat{x}\\in \\hat{T}} s_{\\max}(A(\\hat{x})).\n$$\n令 $I_{2}^{\\hat{T}}$ 表示 $\\hat{T}$ 上的 $P_{2}$ 节点插值算子，而 $I_{2}^{E}$ 表示通过 $F$ 拉回定义的 $E$ 上的相应 $P_{2}$ 节点插值算子。仅使用链式法则、变量替换和由 $F$ 导出的范数等价性，推导最小常数 $C_{\\mathrm{stab}}$ 的显式表达式（仅依赖于 $J_{-}$、$J_{+}$、$s_{-}$、$s_{+}$ 以及 $I_{2}^{\\hat{T}}$ 的 $H^{1}$-稳定性常数 $C_{\\mathrm{ref}}$），使得对于所有 $u\\in H^{1}(E)$，\n$$\n|I_{2}^{E} u|_{H^{1}(E)} \\leq C_{\\mathrm{stab}}\\, |u|_{H^{1}(E)}.\n$$\n讨论 $J(\\hat{x})$ 的符号和畸变（$s_{\\min}$、$s_{\\max}$ 和 $J$ 的巨大变化）如何影响稳定性，但将最终的 $C_{\\mathrm{stab}}$ 表示为关于 $C_{\\mathrm{ref}}$、$J_{-}$、$J_{+}$、$s_{-}$ 和 $s_{+}$ 的单一闭式解析表达式。\n\n将您的最终答案以单行向量的形式提供，包含：\n- 顶点 $1$ 的基函数，\n- 边 $(1,2)$ 中点的基函数，以及\n- 稳定性常数 $C_{\\mathrm{stab}}$。\n\n无需四舍五入，也不应包含任何单位。您的最终答案必须是指定的单一闭式解析表达式。", "solution": "该问题被评估为有效，因为它在有限元方法的理论中有科学依据，是适定的和客观的。它包含了严谨求解所需的所有必要信息和定义。\n\n该问题由两部分组成。第一部分要求在参考三角形上构造两个特定的二次 Lagrange 基函数。第二部分要求推导一个等参单元的插值稳定性常数。\n\n**第一部分：Lagrange 基函数的构造**\n\n参考三角形 $\\hat{T}$ 的顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。点 $\\hat{x}=(x, y) \\in \\hat{T}$ 的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 定义为 $\\hat{x} = \\lambda_1 (0,0) + \\lambda_2(1,0) + \\lambda_3(0,1)$，这得到 $(x,y) = (\\lambda_2, \\lambda_3)$。结合属性 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$，我们有显式关系 $\\lambda_2=x$、$\\lambda_3=y$ 和 $\\lambda_1 = 1-x-y$。\n\n二次（$P_2$）Lagrange 族的节点集由三个顶点和三条边的中点组成。这六个节点的重心坐标是：\n- 顶点 1 ($V_1$): $n_1 = (1,0,0)$\n- 顶点 2 ($V_2$): $n_2 = (0,1,0)$\n- 顶点 3 ($V_3$): $n_3 = (0,0,1)$\n- 边 1-2 的中点: $n_4 = (1/2, 1/2, 0)$\n- 边 2-3 的中点: $n_5 = (0, 1/2, 1/2)$\n- 边 1-3 的中点: $n_6 = (1/2, 0, 1/2)$\n\n与节点 $n_i$ 相关的 Lagrange 基函数 $N_i$ 是一个次数为 $k=2$ 的多项式，满足 Kronecker-delta 属性：$N_i(n_j) = \\delta_{ij}$，其中当 $i=j$ 时 $\\delta_{ij}$ 为 $1$，当 $i \\neq j$ 时为 $0$。\n\n**与顶点 1 相关的基函数（$N_1$）**\n这个函数记为 $N_1$，必须是一个二次多项式，满足 $N_1(n_1) = 1$ 并且对于 $j \\in \\{2, 3, 4, 5, 6\\}$，$N_1(n_j) = 0$。为了构造这样一个多项式，我们找出通过 $N_1$ 必须为零的节点的直线。\n- 节点 $n_2, n_3, n_5$ 都位于由方程 $\\lambda_1 = 0$ 定义的直线上。\n- 节点 $n_4, n_6$ 都位于由方程 $\\lambda_1 = 1/2$ 定义的直线上。\n一个在这五个节点上为零的多项式可以通过定义这两条线的线性表达式的乘积来构成：\n$$P(\\lambda_1,\\lambda_2,\\lambda_3) = C \\cdot \\lambda_1 \\cdot \\left(\\lambda_1 - \\frac{1}{2}\\right)$$\n这是一个次数为 $2$ 的多项式。常数 $C$ 由条件 $N_1(n_1)=1$ 确定。在节点 $n_1$ 处，我们有 $(\\lambda_1, \\lambda_2, \\lambda_3) = (1,0,0)$。\n$$P(n_1) = C \\cdot 1 \\cdot \\left(1 - \\frac{1}{2}\\right) = \\frac{C}{2}$$\n设 $P(n_1)=1$ 得到 $C=2$。因此，基函数是：\n$$N_1 = 2\\lambda_1\\left(\\lambda_1 - \\frac{1}{2}\\right) = \\lambda_1(2\\lambda_1 - 1)$$\n\n**与边 1-2 中点相关的基函数（$N_4$）**\n这个函数 $N_4$ 与节点 $n_4=(1/2, 1/2, 0)$ 相关，并且必须满足 $N_4(n_4)=1$ 且对于 $j \\in \\{1, 2, 3, 5, 6\\}$，$N_4(n_j)=0$。我们再次寻找通过零节点的直线。\n- 节点 $n_2, n_3, n_5$ 都位于直线 $\\lambda_1 = 0$ 上。\n- 节点 $n_1, n_3, n_6$ 都位于直线 $\\lambda_2 = 0$ 上。\n一个在这五个节点上为零的二次多项式可以通过以下乘积构成：\n$$P(\\lambda_1,\\lambda_2,\\lambda_3) = C \\cdot \\lambda_1 \\cdot \\lambda_2$$\n常数 $C$ 由条件 $N_4(n_4)=1$ 确定。在节点 $n_4$ 处，我们有 $(\\lambda_1, \\lambda_2, \\lambda_3) = (1/2, 1/2, 0)$。\n$$P(n_4) = C \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{C}{4}$$\n设 $P(n_4)=1$ 得到 $C=4$。因此，基函数是：\n$$N_4 = 4\\lambda_1\\lambda_2$$\n\n**第二部分：稳定性常数的推导**\n\n令 $u \\in H^1(E)$。它到参考单元的拉回是 $\\hat{u}(\\hat{x}) = u(F(\\hat{x}))$。插值算子之间的关系为 $(I_2^E u) \\circ F = I_2^{\\hat{T}} \\hat{u}$。我们想要找到最小的常数 $C_{\\mathrm{stab}}$，使得 $|I_2^E u|_{H^1(E)} \\leq C_{\\mathrm{stab}} |u|_{H^1(E)}$。$H^1$-半范数由 $|v|_{H^1(\\Omega)}^2 = \\int_\\Omega |\\nabla v|^2 dV$ 给出。\n\n我们关联 $E$ 和 $\\hat{T}$ 上的梯度。对于任何函数 $\\hat{v}(\\hat{x}) = v(F(\\hat{x}))$，链式法则给出 $\\nabla_{\\hat{x}}\\hat{v} = (\\nabla_{\\hat{x}}F)^T \\nabla_x v = A^T \\nabla_x v$。因此，$\\nabla_x v = (A^T)^{-1} \\nabla_{\\hat{x}}\\hat{v}$。积分的变量替换是 $dx = J(\\hat{x}) d\\hat{x}$。\n\n首先，我们来表示 $E$ 上插值函数的半范数：\n$$|I_2^E u|_{H^1(E)}^2 = \\int_E |\\nabla_x (I_2^E u)|^2 dx = \\int_{\\hat{T}} |\\nabla_x ((I_2^E u)\\circ F)|^2 J(\\hat{x}) d\\hat{x}$$\n使用与 $\\hat{v} = (I_2^E u)\\circ F = I_2^{\\hat{T}} \\hat{u}$ 的梯度关系：\n$$|I_2^E u|_{H^1(E)}^2 = \\int_{\\hat{T}} |(A^T)^{-1} \\nabla_{\\hat{x}} (I_2^{\\hat{T}}\\hat{u})|^2 J(\\hat{x}) d\\hat{x}$$\n向量 $(A^T)^{-1}w$ 的欧几里得范数的平方受矩阵的算子范数平方乘以 $|w|^2$ 的限制：$|(A^T)^{-1}w|^2 \\leq \\|(A^T)^{-1}\\|^2 |w|^2$。矩阵的算子范数是其最大奇异值。$(A^T)^{-1}$ 的奇异值是 $A$ 的奇异值的倒数，所以 $\\|(A^T)^{-1}\\| = 1/s_{\\min}(A)$。\n$$|I_2^E u|_{H^1(E)}^2 \\leq \\int_{\\hat{T}} \\frac{1}{s_{\\min}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}(I_2^{\\hat{T}}\\hat{u})|^2 J(\\hat{x}) d\\hat{x}$$\n通过各项的上确界来界定，$J(\\hat{x}) \\leq J_+$ 且 $1/s_{\\min}(A(\\hat{x})) \\leq 1/s_{-}$：\n$$|I_2^E u|_{H^1(E)}^2 \\leq \\frac{J_{+}}{s_{-}^2} \\int_{\\hat{T}} |\\nabla_{\\hat{x}}(I_2^{\\hat{T}}\\hat{u})|^2 d\\hat{x} = \\frac{J_{+}}{s_{-}^2} |I_2^{\\hat{T}}\\hat{u}|_{H^1(\\hat{T})}^2$$\n使用给定的参考插值的稳定性，即 $|I_2^{\\hat{T}}\\hat{u}|_{H^1(\\hat{T})} \\leq C_{\\mathrm{ref}} |\\hat{u}|_{H^1(\\hat{T})}$，我们得到：\n$$|I_2^E u|_{H^1(E)}^2 \\leq C_{\\mathrm{ref}}^2 \\frac{J_{+}}{s_{-}^2} |\\hat{u}|_{H^1(\\hat{T})}^2$$\n\n接下来，我们将 $|\\hat{u}|_{H^1(\\hat{T})}^2$ 与 $|u|_{H^1(E)}^2$ 联系起来。我们从 $|u|_{H^1(E)}^2$ 的定义开始：\n$$|u|_{H^1(E)}^2 = \\int_E |\\nabla_x u|^2 dx = \\int_{\\hat{T}} |(A^T)^{-1} \\nabla_{\\hat{x}}\\hat{u}|^2 J(\\hat{x}) d\\hat{x}$$\n为了获得下界，我们使用这样一个性质：对于任何向量 $w$，都有 $|Mw|^2 \\geq (\\sigma_{\\min}(M))^2 |w|^2$，其中 $\\sigma_{\\min}(M)$ 是 $M$ 的最小奇异值。$(A^T)^{-1}$ 的最小奇异值是 $1/s_{\\max}(A)$。\n$$|(A^T)^{-1} \\nabla_{\\hat{x}}\\hat{u}|^2 \\geq \\frac{1}{s_{\\max}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}\\hat{u}|^2$$\n将其代入积分，并用各项的下确界来界定，$J(\\hat{x}) \\geq J_{-}$ 且 $1/s_{\\max}(A(\\hat{x})) \\geq 1/s_{+}$：\n$$|u|_{H^1(E)}^2 \\geq \\int_{\\hat{T}} \\frac{J(\\hat{x})}{s_{\\max}(A(\\hat{x}))^2} |\\nabla_{\\hat{x}}\\hat{u}|^2 d\\hat{x} \\geq \\frac{J_{-}}{s_{+}^2} \\int_{\\hat{T}} |\\nabla_{\\hat{x}}\\hat{u}|^2 d\\hat{x} = \\frac{J_{-}}{s_{+}^2} |\\hat{u}|_{H^1(\\hat{T})}^2$$\n重新整理这个不等式，我们得到 $|\\hat{u}|_{H^1(\\hat{T})}^2$ 的一个上界：\n$$|\\hat{u}|_{H^1(\\hat{T})}^2 \\leq \\frac{s_{+}^2}{J_{-}} |u|_{H^1(E)}^2$$\n\n最后，将此结果代回到 $|I_2^E u|_{H^1(E)}^2$ 的不等式中：\n$$|I_2^E u|_{H^1(E)}^2 \\leq C_{\\mathrm{ref}}^2 \\frac{J_{+}}{s_{-}^2} \\left( \\frac{s_{+}^2}{J_{-}} |u|_{H^1(E)}^2 \\right) = C_{\\mathrm{ref}}^2 \\frac{J_{+} s_{+}^2}{J_{-} s_{-}^2} |u|_{H^1(E)}^2$$\n对两边取平方根，得到稳定性不等式：\n$$|I_2^E u|_{H^1(E)} \\leq \\left( C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}} \\right) |u|_{H^1(E)}$$\n因此，稳定性常数为 $C_{\\mathrm{stab}} = C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}}$。\n\n假设 $J(\\hat{x})0$至关重要。如果 $J(\\hat{x})$ 变号或为零，$J_{-}$ 可能为零或负值，导致 $C_{\\mathrm{stab}}$ 变为无穷大或无定义。这反映了退化或翻转单元的稳定性丧失。单元相对于参考形状的畸变由比率 $\\frac{s_{+}}{s_{-}}$ 和 $\\frac{J_{+}}{J_{-}}$ 捕捉。理想的（仿射）映射具有恒定的 $A$ 和 $J$，因此这些比率为 $1$。大的比率表示显著的拉伸、剪切或尺寸变化，会直接增加 $C_{\\mathrm{stab}}$，从而降低插值的稳定性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1}(2\\lambda_{1}-1)  4\\lambda_{1}\\lambda_{2}  C_{\\mathrm{ref}} \\frac{s_{+}}{s_{-}} \\sqrt{\\frac{J_{+}}{J_{-}}}\n\\end{pmatrix}\n}\n$$", "id": "3413676"}, {"introduction": "前一个练习揭示了单元几何与其插值稳定性之间的普遍关系，而本练习则通过一个具体的病态案例，让你直观地感受这种关系的重要性。我们将分析一族被称为“薄片”或“ Sliver”的四面体单元，当它们变得越来越“扁平”时，其几何质量会急剧恶化。通过精确计算形状正则性常数，你将定量地揭示为何低质量的网格单元会对有限元方法的稳定性和精度造成灾难性的影响 [@problem_id:3413693]。", "problem": "考虑在有限元法 (FEM) 中用于数值求解偏微分方程 (PDE) 的四面体上的线性拉格朗日 ($P_1$) 有限元插值算子。设 $K(\\varepsilon)$ 是 $\\mathbb{R}^{3}$ 中的一个四面体，其顶点为 $v_{1}=(0,0,0)$、$v_{2}=(1,0,0)$、$v_{3}=(0,1,0)$ 和 $v_{4}=(1/2,1/2,\\varepsilon)$，其中 $\\varepsilon \\in (0,1]$。四面体 $K$ 的形状正则性常数 $\\gamma_{K}$ 定义为 $\\gamma_{K} = h_{K}/\\rho_{K}$，其中 $h_{K}$ 是 $K$ 的最大边长，$\\rho_{K}$ 是 $K$ 的内切球半径，由 $\\rho_{K} = 3|K|/|\\partial K|$ 给出，其中 $|K|$ 是体积，$|\\partial K|$ 是表面积。\n\n从四面体的体积、表面积和内切球半径的几何定义出发，推导 $\\gamma_{K(\\varepsilon)}$ 关于 $\\varepsilon$ 的精确符号表达式。使用标准的仿射单元映射理论以及 $P_{1}$ 基函数梯度的缩放性质，论证当 $\\varepsilon \\to 0$ 时，$K(\\varepsilon)$ 上节点插值算子的 $H^{1}$-半范数稳定性常数为何必须与 $\\gamma_{K(\\varepsilon)}$ 成正比增长，并构造一个由 $K(\\varepsilon)$ 的全等副本组成的网格序列（其中 $\\varepsilon$ 趋于 $0$）来展示插值稳定性的退化。\n\n最后，计算极限\n$$L \\;=\\; \\lim_{\\varepsilon \\to 0} \\varepsilon \\,\\gamma_{K(\\varepsilon)}.$$\n将 $L$ 作为最终答案。无需四舍五入。答案必须是一个实数。", "solution": "我们从几何定义开始。对于一个四面体 $K$，其形状正则性常数为 $\\gamma_{K} = h_{K}/\\rho_{K}$，内切球半径为 $\\rho_{K} = 3|K|/|\\partial K|$，其中 $|K|$ 是体积，$|\\partial K|$ 是总表面积。对于给定的顶点为 $v_{1}=(0,0,0)$、$v_{2}=(1,0,0)$、$v_{3}=(0,1,0)$ 和 $v_{4}=(1/2,1/2,\\varepsilon)$ 的四面体 $K(\\varepsilon)$，我们计算 $|K(\\varepsilon)|$、$|\\partial K(\\varepsilon)|$ 和 $h_{K(\\varepsilon)}$。\n\n首先，底面是由顶点 $v_{1}$、$v_{2}$、$v_{3}$ 构成的三角形，位于平面 $z=0$ 上。其面积为\n$$A_{0} = \\frac{1}{2}.$$\n四面体相对于此底面的高是 $v_{4}$ 到平面 $z=0$ 的垂直距离，即 $\\varepsilon$。因此体积为\n$$|K(\\varepsilon)| = \\frac{1}{3} A_{0} \\varepsilon = \\frac{\\varepsilon}{6}.$$\n\n接下来，使用三角形面积的叉积公式计算三个侧面的面积。对于顶点为 $p,q,r$ 的三角形，其面积为 $\\frac{1}{2}\\| (q-p) \\times (r-p) \\|$。\n\n1. 顶点为 $v_{1}$、$v_{2}$、$v_{4}$ 的面：\n取 $p=v_{1}$，$q=v_{2}$，$r=v_{4}$。则\n$$q-p = (1,0,0), \\qquad r-p = \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\n叉积为\n$$(q-p) \\times (r-p) = (1,0,0) \\times \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) = \\left(0,-\\varepsilon,\\frac{1}{2}\\right),$$\n其范数为\n$$\\left\\| (q-p)\\times(r-p) \\right\\| = \\sqrt{\\varepsilon^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\n因此面积为\n$$A_{12,4} = \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\n\n2. 顶点为 $v_{1}$、$v_{3}$、$v_{4}$ 的面：\n取 $p=v_{1}$，$q=v_{3}$，$r=v_{4}$，所以\n$$q-p = (0,1,0), \\qquad r-p = \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\n叉积：\n$$(q-p) \\times (r-p) = (0,1,0) \\times \\left(\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) = \\left(\\varepsilon,0,-\\frac{1}{2}\\right),$$\n范数\n$$\\sqrt{\\varepsilon^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\varepsilon^{2} + \\frac{1}{4}},$$\n面积\n$$A_{13,4} = \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}}.$$\n\n3. 顶点为 $v_{2}$、$v_{3}$、$v_{4}$ 的面：\n取 $p=v_{2}$，$q=v_{3}$，$r=v_{4}$，得到\n$$q-p = (-1,1,0), \\qquad r-p = \\left(-\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right).$$\n叉积：\n$$(q-p) \\times (r-p) = (-1,1,0) \\times \\left(-\\frac{1}{2},\\frac{1}{2},\\varepsilon\\right) = \\left(\\varepsilon,\\varepsilon,0\\right),$$\n范数\n$$\\left\\| (q-p)\\times(r-p) \\right\\| = \\sqrt{\\varepsilon^{2} + \\varepsilon^{2}} = \\varepsilon \\sqrt{2},$$\n面积\n$$A_{23,4} = \\frac{1}{2}\\varepsilon \\sqrt{2}.$$\n\n因此，总表面积为\n$$|\\partial K(\\varepsilon)| = A_{0} + A_{12,4} + A_{13,4} + A_{23,4} = \\frac{1}{2} + \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{1}{2}\\varepsilon \\sqrt{2},$$\n化简为\n$$|\\partial K(\\varepsilon)| = \\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{\\sqrt{2}}{2}\\varepsilon.$$\n\n内切球半径由下式给出\n$$\\rho_{K(\\varepsilon)} = \\frac{3|K(\\varepsilon)|}{|\\partial K(\\varepsilon)|} = \\frac{3\\left(\\frac{\\varepsilon}{6}\\right)}{\\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{\\sqrt{2}}{2}\\varepsilon} = \\frac{\\varepsilon/2}{\\frac{1}{2} + \\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\frac{\\sqrt{2}}{2}\\varepsilon} = \\frac{\\varepsilon}{1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}}.$$\n\n接下来，计算最大边长 $h_{K(\\varepsilon)}$。底边的长度分别为 $|v_{2}-v_{1}|=1$、 $|v_{3}-v_{1}|=1$ 和 $|v_{3}-v_{2}|=\\sqrt{2}$。从 $v_{4}$ 到三个底面顶点的边的长度相同，为\n$$\\left\\| v_{4}-v_{1} \\right\\| = \\left\\| v_{4}-v_{2} \\right\\| = \\left\\| v_{4}-v_{3} \\right\\| = \\sqrt{\\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\varepsilon^2} = \\sqrt{\\frac{1}{2} + \\varepsilon^{2}}.$$\n由于 $\\varepsilon \\in (0,1]$，我们有 $\\sqrt{\\frac{1}{2} + \\varepsilon^{2}} \\leq \\sqrt{\\frac{1}{2}+1} = \\sqrt{\\frac{3}{2}}  \\sqrt{2}$。因此，\n$$h_{K(\\varepsilon)} = \\sqrt{2}.$$\n\n因此，形状正则性常数为\n$$\\gamma_{K(\\varepsilon)} = \\frac{h_{K(\\varepsilon)}}{\\rho_{K(\\varepsilon)}} = \\frac{\\sqrt{2}}{\\frac{\\varepsilon}{1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}}} = \\frac{\\sqrt{2}\\left(1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}\\right)}{\\varepsilon}.$$\n\n现在，我们将此几何量与 $P_{1}$ 插值稳定性联系起来。对于仿射元， $P_{1}$ 节点基函数的梯度与从一个固定参考四面体进行仿射映射的雅可比矩阵的逆矩阵成比例缩放，而 $K(\\varepsilon)$ 上插值算子的 $H^{1}$-半范数稳定性由一个与雅可比逆矩阵的算子范数成正比的常数控制，并最终由形状正则性参数 $\\gamma_{K(\\varepsilon)}$ 控制。这是有限元理论中一个经过充分检验的结果：对于四面体上的 $P_{1}$ 元，存在一个依赖于参考元的常数 $C_{\\mathrm{ref}}$，使得\n$$\\left\\| \\nabla I_{K(\\varepsilon)} u \\right\\|_{L^{2}(K(\\varepsilon))} \\;\\leq\\; C_{\\mathrm{ref}} \\,\\gamma_{K(\\varepsilon)} \\,\\left\\| \\nabla u \\right\\|_{L^{2}(K(\\varepsilon))} \\quad \\text{for all sufficiently smooth } u.$$\n因此，当 $\\varepsilon \\to 0$ 时，稳定性与 $\\gamma_{K(\\varepsilon)}$ 成比例地退化。\n\n为了通过一个病态网格来展示退化，考虑一个由 $K(\\varepsilon)$ 的全等副本构成的网格序列，其中 $\\varepsilon$ 递减。例如，构造一个由 $M$ 个四面体 $K(\\varepsilon_{j})$ 组成的网格 $\\mathcal{T}_{M}$，其中 $\\varepsilon_{j} = j^{-2}$，$j=1,\\dots,M$。全局插值稳定性常数由最差的单元决定，其量级为 $\\max_{j} \\gamma_{K(\\varepsilon_{j})} = \\gamma_{K(\\varepsilon_{\\min})}$，其中 $\\varepsilon_{\\min}=M^{-2}$，从而产生 $M^{2}$ 量级的增长。这表明当趋近于近共面构型（小 $\\varepsilon$）时，尖削四面体会导致严重的稳定性退化。\n\n最后，计算所求的极限\n$$L = \\lim_{\\varepsilon \\to 0} \\varepsilon \\,\\gamma_{K(\\varepsilon)} = \\lim_{\\varepsilon \\to 0} \\varepsilon \\cdot \\frac{\\sqrt{2}\\left(1 + 2\\sqrt{\\varepsilon^{2} + \\frac{1}{4}} + \\varepsilon \\sqrt{2}\\right)}{\\varepsilon} = \\sqrt{2} \\left(1 + 2\\sqrt{0 + \\frac{1}{4}} + 0\\right).$$\n由于 $\\sqrt{\\frac{1}{4}} = \\frac{1}{2}$，我们得到\n$$L = \\sqrt{2} \\cdot \\left(1 + 2\\left(\\frac{1}{2}\\right)\\right) = \\sqrt{2} \\cdot (1 + 1) = 2\\sqrt{2}.$$\n这证实了对于此类尖削四面体族，其增长率与 $1/\\varepsilon$ 成线性关系，首项系数为 $2\\sqrt{2}$。", "answer": "$$\\boxed{2\\sqrt{2}}$$", "id": "3413693"}]}