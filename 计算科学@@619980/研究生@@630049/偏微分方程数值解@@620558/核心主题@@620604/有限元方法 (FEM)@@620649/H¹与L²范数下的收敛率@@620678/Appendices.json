{"hands_on_practices": [{"introduction": "将抽象的收敛阶理论与可触摸的计算结果联系起来，是数值分析学习中的关键一步。本练习将指导您通过编写一个简单的有限元求解器，经验性地验证线性元在$H^1$和$L^2$范数下的最优收敛阶。通过分析误差与网格尺寸的双对数图，您可以直观地观察并确认理论预测的收敛行为[@problem_id:3374906]。", "problem": "考虑在区间 $\\Omega=(0,1)$ 上的标量二阶偏微分方程 (PDE) $-u''(x)=f(x)$，其具有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。设精确解为一个制造解函数 $u(x)=\\sin(k\\pi x)$，其中频率参数 $k\\in\\mathbb{N}$ 为整数，并通过 $f(x)=-u''(x)=(k\\pi)^2\\sin(k\\pi x)$ 定义右端项。目标是通过对误差与网格尺寸进行对数-对数斜率分析，凭经验确认线性协调有限元法 (FEM) 在 Sobolev 空间 $H^1(\\Omega)$ 范数和 Lebesgue 空间 $L^2(\\Omega)$ 范数下的代数收敛率。\n\n从 Sobolev 空间 $H_0^1(\\Omega)$ 中的弱形式出发，在一系列网格尺寸为 $h=1/N$（其中 $N\\in\\mathbb{N}$）的均匀网格上，使用标准的连续分段线性（帽函数）逼近。对于每个网格，组装并求解由伽辽金法得到的离散线性系统。计算精确解 $u$ 与有限元逼近解 $u_h$ 之间在 $H^1(\\Omega)$ 范数和 $L^2(\\Omega)$ 范数下的误差。$L^2(\\Omega)$ 范数定义为 $\\|v\\|_{L^2(\\Omega)}=\\left(\\int_\\Omega |v(x)|^2\\,dx\\right)^{1/2}$，$H^1(\\Omega)$ 范数定义为 $\\|v\\|_{H^1(\\Omega)}=\\left(\\|v\\|_{L^2(\\Omega)}^2+\\|v'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$。使用高阶高斯求积以足够高的精度计算必要的积分。\n\n按如下方式实现对数-对数斜率分析。对于一系列尺寸为 $h_j$ 的均匀网格，计算误差 $E_{H^1}(h_j)=\\|u-u_h\\|_{H^1(\\Omega)}$ 和 $E_{L^2}(h_j)=\\|u-u_h\\|_{L^2(\\Omega)}$，其中 $j=1,\\dots,m$，$m\\in\\mathbb{N}$ 是加密级别的数量。在最小二乘意义下，对 $(\\log h_j,\\log E(h_j))$ 拟合一条直线；该直线的斜率即为经验收敛率。对两种范数重复此过程。\n\n您的程序必须：\n- 使用制造解 $u(x)=\\sin(k\\pi x)$ 及相应的源项 $f(x)=(k\\pi)^2\\sin(k\\pi x)$。\n- 使用具有 $N$ 个单元的均匀网格和线性基函数，从第一性原理出发组装刚度矩阵和载荷向量。\n- 强施加齐次狄利克雷边界条件。\n- 在每个网格单元上使用足够精确的高斯求积，计算 $\\|u-u_h\\|_{L^2(\\Omega)}$ 和 $\\|u-u_h\\|_{H^1(\\Omega)}$。\n- 对 $(\\log h,\\log E)$ 进行最小二乘线性回归，以提取两种范数的经验斜率。\n\n测试套件：\n- 情况A（标准情况）：频率 $k=1$，初始单元数 $N_0=8$，加密级别数 $m=5$（在每个级别将 $h$ 减半，即 $N$ 加倍）。\n- 情况B（从粗到细的覆盖）：频率 $k=3$，初始单元数 $N_0=4$，加密级别数 $m=5$。\n- 情况C（更高频率内容）：频率 $k=5$，初始单元数 $N_0=16$，加密级别数 $m=4$。\n\n对于每种情况，输出一对实数 $[p_{H^1},p_{L^2}]$，其中 $p_{H^1}$ 是 $H^1(\\Omega)$ 范数的经验对数-对数斜率，$p_{L^2}$ 是 $L^2(\\Omega)$ 范数的经验对数-对数斜率。所有实数必须四舍五入打印到小数点后三位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由列表组成的逗号分隔列表，每个测试用例一个列表，顺序为A、B、C，例如 $[[p_{H^1}^{(A)},p_{L^2}^{(A)}],[p_{H^1}^{(B)},p_{L^2}^{(B)}],[p_{H^1}^{(C)},p_{L^2}^{(C)}]]$。\n- 不应打印任何额外文本。", "solution": "该问题要求对应用于一维泊松方程的线性有限元法（FEM）的收敛率进行经验性验证。该分析将通过求解一个制造解，然后计算误差范数与网格尺寸在对数-对数坐标下的斜率来执行。\n\n控制性偏微分方程（PDE）为：\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in \\Omega=(0,1) $$\n具有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。问题指定了一个制造解 $u(x)=\\sin(k\\pi x)$，其中 $k \\in \\mathbb{N}$ 是一个整数频率参数。右端项，或称源项 $f(x)$，通过将精确解代入PDE来确定：\n$$ f(x) = -u''(x) = - \\frac{d^2}{dx^2}(\\sin(k\\pi x)) = (k\\pi)^2 \\sin(k\\pi x) $$\n\n有限元求解始于问题的弱形式。我们将PDE乘以一个来自 Sobolev 空间 $H_0^1(\\Omega)$ 的检验函数 $v(x)$，该空间是函数及其一阶导数均平方可积且在边界 $x=0$ 和 $x=1$ 处为零的函数空间。在定义域 $\\Omega$ 上积分得到：\n$$ -\\int_0^1 u''(x)v(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\n对左侧应用分部积分得到：\n$$ \\left[-u'(x)v(x)\\right]_0^1 + \\int_0^1 u'(x)v'(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\n由于 $v \\in H_0^1(\\Omega)$，因此 $v(0)=v(1)=0$，边界项消失。这导出了弱形式：求 $u \\in H_0^1(\\Omega)$ 使得\n$$ a(u,v) = L(v) \\quad \\forall v \\in H_0^1(\\Omega) $$\n其中双线性形式 $a(u,v)$ 和线性泛函 $L(v)$ 定义为：\n$$ a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx $$\n$$ L(v) = \\int_0^1 f(x)v(x) \\,dx $$\n\n对于有限元离散化，我们将定义域 $\\Omega=(0,1)$ 划分为一个包含 $N$ 个单元的均匀网格，每个单元长度为 $h=1/N$。节点位于 $x_i = ih$，其中 $i=0, 1, \\dots, N$。我们在一个有限维子空间 $V_h \\subset H_0^1(\\Omega)$ 中寻求近似解 $u_h$。对于本问题，$V_h$ 是该网格上在 $x=0$ 和 $x=1$ 处为零的连续分段线性函数的空间。$V_h$ 的一组基由“帽”函数集合 $\\{\\phi_i(x)\\}_{i=1}^{N-1}$ 给出，其中 $\\phi_i(x)$ 是在节点 $x_i$ 处为1，在所有其他节点 $x_j$ 处为0的唯一线性函数。\n\n有限元逼近解 $u_h(x)$ 写为这些基函数的线性组合：\n$$ u_h(x) = \\sum_{j=1}^{N-1} U_j \\phi_j(x) $$\n其中 $U_j$ 是未知系数，代表近似解在内部节点 $x_j$ 处的值。伽辽金法要求弱形式对离散空间 $V_h$ 中的所有检验函数都成立，即对每个基函数 $\\phi_i$：\n$$ a(u_h, \\phi_i) = L(\\phi_i) \\quad \\text{for } i=1, \\dots, N-1 $$\n代入 $u_h$ 的展开式得到一个线性方程组：\n$$ \\sum_{j=1}^{N-1} U_j a(\\phi_j, \\phi_i) = L(\\phi_i) $$\n这可以写成矩阵形式 $AU=F$，其中：\n- $A$ 是 $(N-1) \\times (N-1)$ 的刚度矩阵，其元素为 $A_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x)\\phi_j'(x) \\,dx$。\n- $F$ 是 $(N-1) \\times 1$ 的载荷向量，其元素为 $F_i = L(\\phi_i) = \\int_0^1 f(x)\\phi_i(x) \\,dx$。\n- $U$ 是未知系数向量 $[U_1, \\dots, U_{N-1}]^T$。\n\n对于具有分段线性基函数的均匀网格，刚度矩阵的元素可以解析计算。导数 $\\phi_i'(x)$ 是分段常数：在 $(x_{i-1}, x_i)$ 上为 $1/h$，在 $(x_i, x_{i+1})$ 上为 $-1/h$。这产生了一个对称三对角刚度矩阵：\n$$ A_{ij} = \\begin{cases} 2/h  \\text{if } i=j \\\\ -1/h  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases} $$\n载荷向量的元素 $F_i = \\int_{x_{i-1}}^{x_{i+1}} (k\\pi)^2 \\sin(k\\pi x) \\phi_i(x) \\,dx$ 必须数值计算。这是通过使用高斯求积对每个单元的贡献求和来完成的，以确保高精度。\n\n求解线性系统 $AU=F$ 得到节点值 $U$ 后，完整的有限元解 $u_h(x)$ 就已知了。误差为 $e(x) = u(x) - u_h(x)$。我们计算两种范数下的误差：\n- $L^2$-范数：$\\|e\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u(x)-u_h(x))^2 \\,dx\\right)^{1/2}$。\n- $H^1$-范数：$\\|e\\|_{H^1(\\Omega)} = \\left(\\|e\\|_{L^2(\\Omega)}^2 + \\|e'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$，其中 $\\|e'\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u'(x)-u_h'(x))^2 \\,dx\\right)^{1/2}$。\n\n这些积分通过使用高阶高斯求积逐个单元计算。在每个单元 $[x_j, x_{j+1}]$ 上，函数 $g(x)$ 的积分通过变换到参考单元 $[-1,1]$ 并使用在特定求积点处函数值的加权和来逼近。\n\n为了找到经验收敛率，我们计算一系列逐渐加密的网格的误差。设 $h_j$ 是加密级别 $j$ 处的网格尺寸，设 $E(h_j)$ 是相应的误差（$E_{H^1}$ 或 $E_{L^2}$）。如果误差呈代数收敛，即 $E(h) \\approx C h^p$（对于某个常数 $C$ 和收敛率 $p$），那么取对数可得 $\\log(E) \\approx \\log(C) + p \\log(h)$。这是 $\\log(E)$ 和 $\\log(h)$ 之间的线性关系，其中斜率是收敛率 $p$。我们对点集 $(\\log(h_j), \\log(E(h_j)))$ 进行最小二乘线性回归以确定斜率 $p$。\n\n对于线性有限元，理论预测表明，只要解足够光滑且网格足够细，$H^1$-范数的收敛率是 $p=1$，$L^2$-范数的收敛率是 $p=2$。该程序实现了这整个过程，以验证给定测试用例的这些收敛率。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM convergence study for the specified test cases.\n    \"\"\"\n\n    # Test cases: (k, N_initial, num_refinements)\n    test_cases = [\n        (1, 8, 5),  # Case A\n        (3, 4, 5),  # Case B\n        (5, 16, 4), # Case C\n    ]\n\n    all_results = []\n    for k, N0, m in test_cases:\n        p_h1, p_l2 = run_convergence_study(k, N0, m)\n        all_results.append([f\"{p_h1:.3f}\", f\"{p_l2:.3f}\"])\n\n    # Format the final output string as per requirements\n    list_of_strings = [f\"[{item[0]},{item[1]}]\" for item in all_results]\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\ndef run_convergence_study(k, N0, num_refinements):\n    \"\"\"\n    Performs a convergence study for a given frequency k, initial mesh size N0,\n    and a number of refinement levels.\n\n    Args:\n        k (int): Frequency parameter for the manufactured solution.\n        N0 (int): Initial number of elements.\n        num_refinements (int): Number of mesh refinement steps.\n\n    Returns:\n        tuple: A pair of floats (p_h1, p_l2) representing the convergence\n               rates for the H1 and L2 norms.\n    \"\"\"\n    hs = []\n    errors_l2 = []\n    errors_h1 = []\n\n    for i in range(num_refinements):\n        N = N0 * (2**i)\n        h = 1.0 / N\n        l2_err, h1_err = solve_fem_1d(k, N)\n\n        hs.append(h)\n        errors_l2.append(l2_err)\n        errors_h1.append(h1_err)\n\n    log_hs = np.log(hs)\n    log_errs_l2 = np.log(errors_l2)\n    log_errs_h1 = np.log(errors_h1)\n\n    # Perform least-squares fit to find the slope (convergence rate)\n    p_l2 = np.polyfit(log_hs, log_errs_l2, 1)[0]\n    p_h1 = np.polyfit(log_hs, log_errs_h1, 1)[0]\n\n    return p_h1, p_l2\n\ndef solve_fem_1d(k, N):\n    \"\"\"\n    Solves the 1D Poisson problem -u''=f on (0,1) with u(0)=u(1)=0 using linear FEM.\n\n    Args:\n        k (int): Frequency parameter of the manufactured solution.\n        N (int): Number of mesh elements.\n\n    Returns:\n        tuple: A pair of floats (l2_error, h1_error).\n    \"\"\"\n    h = 1.0 / N\n    num_unknowns = N - 1\n\n    # Define exact solution, its derivative, and the source function\n    u_exact = lambda x: np.sin(k * np.pi * x)\n    u_prime_exact = lambda x: k * np.pi * np.cos(k * np.pi * x)\n    f_source = lambda x: (k * np.pi)**2 * np.sin(k * np.pi * x)\n\n    # Assemble stiffness matrix A\n    diag = np.full(num_unknowns, 2.0 / h)\n    off_diag = np.full(num_unknowns - 1, -1.0 / h)\n    A = np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # Gaussian quadrature setup (5 points is sufficient for high accuracy)\n    NUM_QUAD_POINTS = 5\n    xi_q, w_q = np.polynomial.legendre.leggauss(NUM_QUAD_POINTS)\n\n    # Assemble load vector F\n    F = np.zeros(num_unknowns)\n    # Local basis functions on reference element [-1, 1]\n    phi_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for j in range(N):  # Loop over elements\n        x_left = j * h\n        f_loc = np.zeros(2)\n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            f_val = f_source(x_q_phys)\n            for i in range(2):\n                f_loc[i] += f_val * phi_ref[i](xi_q[q_idx]) * (h / 2) * w_q[q_idx]\n\n        # Add local contributions to global vector\n        if j > 0:\n            F[j - 1] += f_loc[0]\n        if j  N - 1:\n            F[j] += f_loc[1]\n\n    # Solve linear system AU = F\n    U_sol = np.linalg.solve(A, F)\n\n    # Full solution vector including boundary nodes\n    U_h = np.concatenate(([0.0], U_sol, [0.0]))\n\n    # Compute L2 and H1 error norms\n    l2_error_sq = 0.0\n    h1_seminorm_error_sq = 0.0\n\n    for j in range(N):  # Loop over elements to compute error integrals\n        x_left = j * h\n        U_j, U_jp1 = U_h[j], U_h[j + 1]\n        u_h_prime_const = (U_jp1 - U_j) / h\n        \n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            \n            # Evaluate exact solution and its derivative\n            u_ex = u_exact(x_q_phys)\n            u_prime_ex = u_prime_exact(x_q_phys)\n\n            # Evaluate FEM solution and its derivative\n            u_h_val = U_j * phi_ref[0](xi_q[q_idx]) + U_jp1 * phi_ref[1](xi_q[q_idx])\n            \n            # Accumulate squared errors\n            jacobian = h / 2\n            l2_error_sq += (u_ex - u_h_val)**2 * jacobian * w_q[q_idx]\n            h1_seminorm_error_sq += (u_prime_ex - u_h_prime_const)**2 * jacobian * w_q[q_idx]\n\n    l2_error = np.sqrt(l2_error_sq)\n    h1_error = np.sqrt(l2_error_sq + h1_seminorm_error_sq)\n\n    return l2_error, h1_error\n\nsolve()\n```", "id": "3374906"}, {"introduction": "获得理论上的最优收敛阶，前提是离散格式被精确地计算。然而，在有限元实践中，刚度矩阵和质量矩阵的组装通常依赖于数值积分，这引入了所谓的“变分犯罪”。本练习旨在探讨这一核心问题，要求您推导为保证最优收敛阶，数值积分法则必须精确求解的多项式最低次数[@problem_id:3374918]。这揭示了计算精度与理论收敛性之间的深刻联系。", "problem": "考虑一个在有界凸区域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）上的反应扩散边值问题：求 $u \\in H_{0}^{1}(\\Omega)$ 使得\n$$\na(u,v) \\equiv \\int_{\\Omega} \\left( \\nabla u \\cdot \\nabla v + u\\,v \\right)\\,dx \\;=\\; \\ell(v) \\equiv \\int_{\\Omega} f\\,v\\,dx \\quad \\text{对所有 } v \\in H_{0}^{1}(\\Omega),\n$$\n其中 $f \\in L^{2}(\\Omega)$ 且对于一个固定的整数 $p \\geq 1$，有 $u \\in H^{p+1}(\\Omega)$。设 $\\{\\mathcal{T}_{h}\\}_{h}$ 为 $\\Omega$ 上的一族形状规则、拟一致的单纯形网格，网格尺寸为 $h$。设 $V_{h} \\subset H_{0}^{1}(\\Omega)$ 为标准的拉格朗日有限元空间，由 $\\mathcal{T}_{h}$ 上的总次数至多为 $p$ 的连续分片多项式函数构成。\n\n一个相容离散方法通过在每个单元 $K \\in \\mathcal{T}_{h}$ 上对双线性形式进行欠积分来定义：\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\Big( Q_{s}^{K}\\big( \\nabla u_{h} \\cdot \\nabla v_{h} \\big) \\;+\\; Q_{m}^{K}\\big( u_{h}\\,v_{h} \\big) \\Big),\n$$\n其中离散载荷取为精确值，即 $\\ell_{h}(v_{h}) = \\ell(v_{h})$，离散问题旨在求解 $u_{h} \\in V_{h}$ 使得\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\ell(v_{h}) \\quad \\text{对所有 } v_{h} \\in V_{h}.\n$$\n此处，对每个单元 $K$，$Q_{s}^{K}$ 和 $Q_{m}^{K}$ 分别表示单元上的求积法则，它们对 $K$ 上总次数分别至多为 $r_{s}$ 和 $r_{m}$ 的多项式是精确的。假设所有单元都使用相同的对 $(r_{s},r_{m})$，并且这些求积法则在多项式空间上满足标准范数等价界的意义下是稳定的。\n\n仅使用弱形式的基本定义、拉格朗日有限元基的多项式次数结构以及基于Strang引理的相容性论证（不得在没有论证的情况下引用任何现成的估计式），推导出最紧凑的单元多项式精确次数 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$（仅作为 $p$ 的函数），以保证以下条件成立：离散双线性形式与 $V_{h} \\times V_{h}$ 上的精确双线性形式一致，这又进而保持了当 $h \\to 0$ 时的最优收敛率 $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$ 和 $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$。\n\n将您的最终答案表示为包含两个表达式 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$ 的单行矩阵。无需四舍五入。答案中不要包含单位。", "solution": "该问题要求推导在有限元离散化中使用的数值求积法则的最小多项式精确次数 $r_{s}^{\\star}(p)$ 和 $r_{m}^{\\star}(p)$。条件是这些次数必须恰好足以确保离散双线性形式 $a_{h}(\\cdot, \\cdot)$ 在限制于有限元空间 $V_{h} \\times V_{h}$ 时与精确双线性形式 $a(\\cdot, \\cdot)$ 完全相同。而此条件又被陈述为最优收敛率的保证。\n\n我们首先将问题陈述中给出的核心条件形式化：\n$$\na_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h}) \\quad \\text{对所有 } v_{h}, w_{h} \\in V_{h}.\n$$\n通过将双线性形式写成在所有单元 $K \\in \\mathcal{T}_{h}$ 上的和，我们得到：\n$$\na(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx + \\int_{K} v_{h} w_{h} \\,dx \\right)\n$$\n$$\na_{h}(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) + Q_{m}^{K}(v_{h} w_{h}) \\right)\n$$\n为了使等式 $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ 对所有 $v_{h}, w_{h} \\in V_{h}$ 成立，一个充分条件是该等式在每个单元 $K \\in \\mathcal{T}_{h}$ 上逐项成立。这要求：\n1. 对所有 $v_{h}, w_{h} \\in V_{h}$，有 $Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) = \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx$。\n2. 对所有 $v_{h}, w_{h} \\in V_{h}$，有 $Q_{m}^{K}(v_{h} w_{h}) = \\int_{K} v_{h} w_{h} \\,dx$。\n\n在继续之前，我们按照问题框架的要求，简要论证为何此条件能保持最优收敛率。与 $a(\\cdot, \\cdot)$ 相关的能量范数下的误差 $e = u-u_{h}$ 可以使用Strang第一引理进行界定。假设离散形式 $a_{h}$ 在 $V_{h}$ 上是强制的，该引理提供了一个形如下式的估计：\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\left( \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} + \\sup_{w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(u, w_{h}) - \\ell(w_{h})|}{\\|w_{h}\\|_{H^{1}(\\Omega)}} + \\sup_{v_{h}, w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(v_{h}, w_{h}) - a_{h}(v_{h}, w_{h})|}{\\|v_{h}\\|_{H^{1}(\\Omega)} \\|w_{h}\\|_{H^{1}(\\Omega)}} \\right).\n$$\n在我们的问题中，离散载荷是精确的，$\\ell_h = \\ell$，这意味着 $a(u, w_h) = \\ell(w_h)$，所以第二项（载荷相容性误差）消失。条件 $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ 对所有 $v_{h}, w_{h} \\in V_h$ 成立，使得第三项（双线性形式相容性误差）完全消失。因此，误差估计简化为Céa引理：\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)}.\n$$\n对于具有正则性 $u \\in H^{p+1}(\\Omega)$ 的解和次数为 $p$ 的多项式构成的有限元空间 $V_{h}$，标准逼近理论保证了最佳逼近误差为 $\\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$。因此，我们的条件确保了 $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$。\n\n最优的$L^{2}$范数估计是通过Aubin-Nitsche对偶论证得到的。该论证依赖于$H^{1}$范数估计。如果我们在 $V_{h} \\times V_{h}$ 上强制要求 $a_{h} \\equiv a$，标准的对偶证明过程无需修改即可进行，从而得到 $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$，前提是对偶问题具有足够的椭圆正则性（这一点由 $\\Omega$ 的凸性保证）。\n\n现在我们来确定所需的最小精确次数 $r_{s}^{\\star}$ 和 $r_{m}^{\\star}$。\n有限元空间 $V_{h}$ 由这样的函数组成：它们在任意单元 $K \\in \\mathcal{T}_{h}$ 上的限制是总次数至多为 $p$ 的多项式。我们将 $K$ 上的这类多项式空间记为 $\\mathcal{P}_{p}(K)$。因此，对于任意 $v_{h}, w_{h} \\in V_{h}$，它们在 $K$ 上的限制 $v_{h}|_{K}$ 和 $w_{h}|_{K}$ 都属于 $\\mathcal{P}_{p}(K)$。\n\n刚度项积分 $Q_{s}^{K}$ 的分析：\n被积函数是 $\\nabla v_{h} \\cdot \\nabla w_{h}$。\n如果 $v_{h} \\in \\mathcal{P}_{p}(K)$，其梯度 $\\nabla v_{h}$ 是一个向量，其分量是总次数至多为 $p-1$ 的多项式。点积 $\\nabla v_{h} \\cdot \\nabla w_{h}$ 涉及这些分量的乘积之和。一个次数至多为 $p-1$ 的多项式与另一个次数至多为 $p-1$ 的多项式相乘，得到的多项式次数至多为 $(p-1) + (p-1) = 2p-2$。\n因此，被积函数 $\\nabla v_{h} \\cdot \\nabla w_{h}$ 是一个总次数至多为 $2p-2$ 的多项式。求积法则 $Q_{s}^{K}$ 被定义为对总次数至多为 $r_{s}$ 的多項式是精确的。为了使条件(1)对所有 $v_{h}, w_{h} \\in V_{h}$ 成立，$Q_{s}^{K}$ 必须能精确积分所有形如 $\\nabla v_h \\cdot \\nabla w_h$ 的多项式。我们需要积分的最高次多项式的次数是 $2p-2$。因此，我们必须有 $r_{s} \\geq 2p-2$。所以，所需的最紧凑（或最小）精确次数为\n$$\nr_{s}^{\\star}(p) = 2p-2.\n$$\n\n质量项积分 $Q_{m}^{K}$ 的分析：\n被积函数是 $v_{h} w_{h}$。\n由于 $v_{h}|_{K}$ 和 $w_{h}|_{K}$ 都是 $\\mathcal{P}_{p}(K)$ 中的多项式，它们的乘积 $v_{h} w_{h}$ 是一个总次数至多为 $p + p = 2p$ 的多项式。\n求积法则 $Q_{m}^{K}$ 被定义为对总次数至多为 $r_{m}$ 的多项式是精确的。为了使条件(2)对所有 $v_{h}, w_{h} \\in V_{h}$ 成立，$Q_{m}^{K}$ 必须能精确积分所有形如 $v_h w_h$ 的多项式。我们需要积分的最高次多项式的次数是 $2p$。因此，我们必须有 $r_{m} \\geq 2p$。所以，所需的最紧凑（或最小）精确次数为\n$$\nr_{m}^{\\star}(p) = 2p.\n$$\n\n这些是保证离散双线性形式在有限元空间上与精确形式完全相同的最小求积精确次数，并且正如通过Strang引理和Aubin-Nitsche论证所表明的，这是保持最优收斂阶的充分条件。最终答案是数对 $(r_{s}^{\\star}(p), r_{m}^{\\star}(p))$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2p - 2  2p\n\\end{pmatrix}\n}\n$$", "id": "3374918"}, {"introduction": "在许多实际工程问题中，由于几何（如凹角）或材料特性的原因，偏微分方程的解并非处处光滑，这导致标准有限元方法的收敛性下降。本练习将引导您分析一个带有凹角的典型泊松问题，其解在角点附近存在奇性。您将学习如何通过设计一种径向加密的“分级网格”来抵消奇性对精度的影响，并推导出恢复最优收敛阶所需的最佳网格加密参数[@problem_id:3374917]。", "problem": "考虑平面扇形域 $\\Omega = \\{(r,\\theta): 0  r  R,\\; 0  \\theta  \\omega\\}$，其开口角为 $\\omega \\in (\\pi,2\\pi)$，这在原点处产生一个凹角。设 $u$ 是在 $\\Omega$ 中定义的泊松偏微分方程 (PDE) $-\\Delta u = f$ 的解，且在边界 $\\partial\\Omega$ 上满足 $u=0$。其中，$f \\in C^{\\infty}(\\overline{\\Omega})$ 的选取使得在 $r=0$ 附近，解可以分解为 $u(r,\\theta) = u_{\\mathrm{s}}(r,\\theta) + u_{\\mathrm{r}}(r,\\theta)$，其中 $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$，$\\lambda = \\pi/\\omega \\in (1/2, 1)$，且 $u_{\\mathrm{r}} \\in H^{2}(\\Omega)$ 是足够光滑的。此处，$H^{1}(\\Omega)$ 表示一阶导数平方可积的平方可积函数构成的索博列夫空间，$L^{2}(\\Omega)$ 表示平方可积函数空间。\n\n考虑在一族各向同性的三角剖分上使用协调分片线性有限元方法 (FEM)，该三角剖分在角向上是拟一致的，并使用参数 $\\beta>0$ 通过节点半径 $r_{i} = R\\left(\\frac{i}{M}\\right)^{\\beta}$（其中 $i=0,1,\\dots,M$，$M$ 为径向层数）向 $r=0$ 处进行径向加密。假设角向扇区数 $K$ 与 $M$ 成比例，即 $K \\simeq c\\,M$（其中 $c>0$ 为一固定常数），因此单元总数 $N$ 满足 $N \\simeq C\\,M^{2}$（其中常数 $C>0$ 独立于 $M$）。设 $h(r)$ 表示由该加密方式在半径 $r$ 处产生的局部单元直径。\n\n从分片线性单元的标准局部插值估计出发，\n- 对于 $H^{1}(\\Omega)$ 误差，有 $|\\nabla(u - I_{h}u)| \\lesssim h(r)\\,|D^{2}u|$，以及\n- 对于 $L^{2}(\\Omega)$ 误差，有 $|u - I_{h}u| \\lesssim h(r)^{2}\\,|D^{2}u|$，\n并利用 $r=0$ 附近的奇异结构 $|D^{2}u_{\\mathrm{s}}(r,\\theta)| \\simeq r^{\\lambda-2}$ 以及极坐标积分，推导加密参数 $\\beta$ 应满足的条件，以使有限元方法能够恢复与光滑解相关的近最优收敛阶，即作为单元总数 $N$ 的函数，在 $H^{1}(\\Omega)$ 范数下达到一阶收敛，在 $L^{2}(\\Omega)$ 范数下达到二阶收敛。\n\n请用一个关于奇异性指数 $\\lambda$ 的单一闭式表达式给出最小允许值 $\\beta_{\\min}$。无需四舍五入。最终答案必须是单一的解析表达式。", "solution": "该问题要求找到径向加密网格的最小加密参数 $\\beta_{\\min}$，使得求解带凹角区域上的泊松问题的协调分片线性有限元方法 (FEM) 能够达到最优收敛阶。解的正则性因角点的存在而降低，其含有一个奇异部分 $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$，其中 $\\lambda = \\pi/\\omega \\in (1/2, 1)$。误差分析必须考虑这种奇异性。\n\n有限元解 $u_h$ 的总误差可由精确解 $u$ 的插值误差来界定。根据关于 $H^1(\\Omega)$ 范数的 Céa 引理和关于 $L^2(\\Omega)$ 范数的对偶论证，收敛阶取决于有限元空间逼近解 $u$ 的能力。问题给出了我们将要使用的局部插值误差估计。由于解被分解为 $u = u_{\\mathrm{s}} + u_{\\mathrm{r}}$，其中 $u_{\\mathrm{r}} \\in H^2(\\Omega)$，因此在任何合理形状的网格上，正则部分 $u_{\\mathrm{r}}$ 的收敛阶都将是最优的。总体收敛阶受限于奇异部分 $u_{\\mathrm{s}}$ 的逼近效果。因此，我们专注于 $u_{\\mathrm{s}}$ 的误差。\n\n首先，我们刻画给定网格的局部单元直径 $h(r)$。节点半径为 $r_i = R(i/M)^{\\beta}$，其中 $i=0, \\dots, M$。在 $r_{i-1}$ 和 $r_i$ 之间的层中，单元的径向尺寸为 $h_{r,i} = r_i - r_{i-1}$。对 $i \\gg 1$ 使用一阶近似：\n$h_{r,i} = R M^{-\\beta} (i^{\\beta} - (i-1)^{\\beta}) \\approx R M^{-\\beta} (\\beta i^{\\beta-1})$。\n该层中的半径 $r$ 约等于 $r_i$，因此 $i \\approx M(r/R)^{1/\\beta}$。将此代入 $h_{r,i}$ 的表达式，可得出作为 $r$ 的函数的径向网格尺寸：\n$h_r(r) \\approx R \\beta M^{-1} (r/R)^{1-1/\\beta}$。\n角向扇区数 $K$ 与 $M$ 成比例 ($K \\simeq cM$)，因此切向网格尺寸为 $h_{\\theta}(r) \\approx r\\omega/K \\simeq (r\\omega/c) M^{-1}$。\n局部单元直径 $h(r)$ 是这些尺寸中的最大值。在 $r=0$ 的奇异点附近，对于 $r \\ll R$ 和 $\\beta  0$，由于 $1-1/\\beta  1$（假设 $\\beta > 1$），我们有 $r^{1-1/\\beta} > r$。因此，径向尺寸 $h_r(r)$ 通常大于切向尺寸 $h_{\\theta}(r)$，所以我们可以用 $h(r) \\sim M^{-1}r^{1-1/\\beta}$ 来近似有效局部直径。\n\n接下来，我们分析 $H^1(\\Omega)$ 误差收敛性。目标是达到 $O(N^{-1/2})$ 的收敛阶，其中 $N \\simeq CM^2$ 是单元总数。这对应于 $O(M^{-1})$ 的收敛阶。通过对局部插值误差进行积分，可以估计奇异部分 $u_{\\mathrm{s}}$ 的 $H^1(\\Omega)$ 半范数误差的平方：\n$\\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\|\\nabla(u_{\\mathrm{s}} - I_h u_{\\mathrm{s}})\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|^2 dA$。\n使用给定的奇异行为 $|D^2 u_{\\mathrm{s}}| \\sim r^{\\lambda-2}$、推导出的网格尺寸 $h(r) \\sim M^{-1}r^{1-1/\\beta}$ 以及面积元 $dA = r dr d\\theta$，我们得到：\n$$ \\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2})^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-2} \\int_0^R r^{2(1-1/\\beta)} r^{2(\\lambda-2)} r^1 \\, dr = M^{-2} \\int_0^R r^{2 - 2/\\beta + 2\\lambda - 4 + 1} \\, dr $$\n$$ = M^{-2} \\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr $$\n为了使总误差为 $O(M^{-1})$，误差的平方必须为 $O(M^{-2})$。这要求积分 $\\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr$ 是一个独立于 $M$ 的有界常数。为使积分在 $r=0$ 处收敛，$r$ 的指数必须大于 $-1$：\n$2\\lambda - 2/\\beta - 1  -1 \\implies 2\\lambda  2/\\beta \\implies \\lambda  1/\\beta \\implies \\beta  1/\\lambda$。\n如果此条件成立，则积分是有限的，且 $H^1$ 误差如期望收敛。\n\n现在，我们分析 $L^2(\\Omega)$ 误差收敛性。目标是 $O(N^{-1})$，即 $O(M^{-2})$。使用给定的局部估计来估计 $L^2(\\Omega)$ 误差的平方：\n$\\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\|u_{\\mathrm{s}} - I_h u_{\\mathrm{s}}\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} (h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|)^2 dA$。\n代入 $h(r)$、$|D^2 u_s|$ 和 $dA$ 的表达式：\n$$ \\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R \\left( (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2}) \\right)^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-4} \\int_0^R (r^{2(1-1/\\beta)} r^{\\lambda-2})^2 r \\, dr = M^{-4} \\int_0^R (r^{2 - 2/\\beta + \\lambda - 2})^2 r \\, dr $$\n$$ = M^{-4} \\int_0^R (r^{\\lambda - 2/\\beta})^2 r \\, dr = M^{-4} \\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr $$\n为了使总 $L^2$ 误差为 $O(M^{-2})$，误差的平方必须为 $O(M^{-4})$。这要求积分 $\\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr$ 是一个有界常数。在 $r=0$ 处的收敛性要求指数大于 $-1$：\n$2\\lambda - 4/\\beta + 1  -1 \\implies 2\\lambda + 2  4/\\beta \\implies \\lambda + 1  2/\\beta \\implies \\beta  \\frac{2}{\\lambda+1}$。\n\n为了恢复两种最优收敛阶，关于 $\\beta$ 的两个条件都必须满足：\n$1. \\quad \\beta  1/\\lambda$\n$2. \\quad \\beta  2/(\\lambda+1)$\n我们必须确定在给定的 $\\lambda \\in (1/2, 1)$ 范围内，这两个条件中哪一个更严格。我们来比较 $1/\\lambda$ 和 $2/(\\lambda+1)$ 的值。考虑它们的差：\n$$ \\frac{1}{\\lambda} - \\frac{2}{\\lambda+1} = \\frac{(\\lambda+1) - 2\\lambda}{\\lambda(\\lambda+1)} = \\frac{1-\\lambda}{\\lambda(\\lambda+1)} $$\n由于 $\\lambda \\in (1/2, 1)$，分子 $1-\\lambda$ 为正，分母 $\\lambda(\\lambda+1)$ 也为正。因此，差值为正，这意味着：\n$$ \\frac{1}{\\lambda}  \\frac{2}{\\lambda+1} $$\n条件 $\\beta  1/\\lambda$ 比 $\\beta  2/(\\lambda+1)$ 更严格。满足前者则自动满足后者。因此，要达到两种期望的收敛阶，条件是 $\\beta  1/\\lambda$。\n问题要求的是最小允许值 $\\beta_{\\min}$，它是允许的 $\\beta$ 值集合的下确界。这对应于所推导不等式的边界。\n\n最小允许值为 $\\beta_{\\min} = 1/\\lambda$。在此边界值上，$H^1$ 误差估计中可能会出现一个对数因子，即 $\\|\\nabla(u-u_h)\\|_{L^2} \\sim N^{-1/2}\\sqrt{\\log N}$，这与问题中使用的“近最优”一词相符。", "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$", "id": "3374917"}]}