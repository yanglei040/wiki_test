{"hands_on_practices": [{"introduction": "本练习将引导您完成使用伽辽金方法将连续边值问题转化为离散线性系统的基本过程。通过在一个粗糙网格上为亥姆霍兹型方程构建刚度矩阵，您将亲眼见证双线性形式的抽象性质（如对称性和矫顽性）如何直接转化为最终矩阵的具体属性（如对称性和正定性）。这个实践巩固了连续数学理论与我们最终求解的离散代数系统之间的关键联系。[@problem_id:3462584]", "problem": "考虑开区间$\\Omega=(0,1)$上的二阶标量椭圆边值问题：求$u:\\Omega\\to\\mathbb{R}$，使得对$x\\in\\Omega$有$-u''(x)+\\gamma\\,u(x)=f(x)$，并带有齐次狄利克雷边界条件$u(0)=0$和$u(1)=0$，其中$\\gamma>0$为给定常数，$f\\in L^{2}(\\Omega)$为给定源项。其弱形式为：求$u\\in H_{0}^{1}(\\Omega)$，使得对所有$v\\in H_{0}^{1}(\\Omega)$，有$a(u,v)=\\ell(v)$，其中双线性形式$a(\\cdot,\\cdot)$和线性泛函$\\ell(\\cdot)$定义为$a(u,v)=\\int_{0}^{1}u'(x)v'(x)\\,\\mathrm{d}x+\\gamma\\int_{0}^{1}u(x)v(x)\\,\\mathrm{d}x$以及$\\ell(v)=\\int_{0}^{1}f(x)v(x)\\,\\mathrm{d}x$。与伽辽金原理相关的加权余量法寻求$u_{h}\\in V_{h}$，使得对所有$w_{h}\\in W_{h}$，有$a(u_{h},w_{h})=\\ell(w_{h})$，且$W_{h}=V_{h}$。\n\n设试验空间$V_{h}$是$H_{0}^{1}(\\Omega)$的子空间，由均匀网格上的分片线性、全局连续函数构成，网格节点为$x_{0}=0$，$x_{1}=\\frac{1}{3}$，$x_{2}=\\frac{2}{3}$，$x_{3}=1$。设$V_{h}=\\operatorname{span}\\{\\varphi_{1},\\varphi_{2}\\}$，其中$\\varphi_{1}$和$\\varphi_{2}$是与内节点$x_{1}$和$x_{2}$相关的标准帽函数，其显式表达式为\n$\\varphi_{1}(x)=\\begin{cases}\\frac{x}{h},  0\\leq x\\leq h,\\\\\\frac{2h-x}{h},  h\\leq x\\leq 2h,\\\\0,  \\text{其他情况},\\end{cases}\\quad \\varphi_{2}(x)=\\begin{cases}\\frac{x-h}{h},  h\\leq x\\leq 2h,\\\\\\frac{3h-x}{h},  2h\\leq x\\leq 3h,\\\\0,  \\text{其他情况},\\end{cases}$\n其中$h=\\frac{1}{3}$。设测试空间$W_{h}$等于$V_{h}$，因此该方法为标准伽辽金法。\n\n任务：\n- 根据定义推导在节点基$\\{\\varphi_{1},\\varphi_{2}\\}$下表示$a(\\cdot,\\cdot)$在$V_{h}$和$W_{h}$上的刚度矩阵$A\\in\\mathbb{R}^{2\\times 2}$，即$A_{ij}=a(\\varphi_{j},\\varphi_{i})$，其中$i,j\\in\\{1,2\\}$。\n- 利用$a(\\cdot,\\cdot)$在$H_{0}^{1}(\\Omega)$上的连续性（有界性）和矫顽性（椭圆性）的定义，讨论这些性质如何决定矩阵$A$的谱特性，如对称性和正定性，以及这些性质如何与$A$的离散谱（特征值）相关联。\n- 对于特定参数值$\\gamma=4$，计算矩阵$A$的最小特征值。最终答案需表示为精确值，无需四舍五入。", "solution": "任务分为三个部分：推导刚度矩阵$A$，基于双线性形式$a(\\cdot,\\cdot)$的性质讨论其谱特性，以及计算在特定参数值下$A$的最小特征值。\n\n### 第一部分：刚度矩阵$A$的推导\n\n刚度矩阵$A \\in \\mathbb{R}^{2\\times 2}$由其元素$A_{ij} = a(\\varphi_{j}, \\varphi_{i})$定义（$i,j \\in \\{1,2\\}$），其中$\\{\\varphi_{1}, \\varphi_{2}\\}$是试验函数空间$V_h$的节点基。双线性形式由下式给出\n$$a(u,v)=\\int_{0}^{1}u'(x)v'(x)\\,\\mathrm{d}x+\\gamma\\int_{0}^{1}u(x)v(x)\\,\\mathrm{d}x$$\n网格尺寸为$h=\\frac{1}{3}$，节点位于$x_0=0$，$x_1=h$，$x_2=2h$和$x_3=3h=1$。基函数$\\varphi_1(x)$和$\\varphi_2(x)$是分别以内节点$x_1$和$x_2$为中心的标准分片线性“帽”函数。\n\n基函数的导数是分片常数：\n$$ \\varphi_{1}'(x)=\\begin{cases} 1/h,  x \\in (0,h) \\\\ -1/h,  x \\in (h,2h) \\\\ 0,  \\text{其他情况} \\end{cases} \\quad \\text{以及} \\quad \\varphi_{2}'(x)=\\begin{cases} 1/h,  x \\in (h,2h) \\\\ -1/h,  x \\in (2h,3h) \\\\ 0,  \\text{其他情况} \\end{cases} $$\n\n我们现在计算矩阵$A$的四个元素。\n\n**元素 $A_{11}$：**\n$A_{11} = a(\\varphi_1, \\varphi_1) = \\int_{0}^{1} (\\varphi_1'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (\\varphi_1(x))^2\\,\\mathrm{d}x$。\n第一个积分为：\n$$ \\int_{0}^{1} (\\varphi_1'(x))^2\\,\\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{1}{h}\\right)^2\\,\\mathrm{d}x + \\int_{h}^{2h} \\left(-\\frac{1}{h}\\right)^2\\,\\mathrm{d}x = \\frac{1}{h^2} \\cdot h + \\frac{1}{h^2} \\cdot h = \\frac{2}{h} $$\n第二个积分为：\n$$ \\int_{0}^{1} (\\varphi_1(x))^2\\,\\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{x}{h}\\right)^2\\,\\mathrm{d}x + \\int_{h}^{2h} \\left(\\frac{2h-x}{h}\\right)^2\\,\\mathrm{d}x = \\frac{1}{h^2}\\left[\\frac{x^3}{3}\\right]_0^h + \\frac{1}{h^2}\\left[-\\frac{(2h-x)^3}{3}\\right]_h^{2h} = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3} $$\n因此，$A_{11} = \\frac{2}{h} + \\gamma \\frac{2h}{3}$。\n\n**元素 $A_{22}$：**\n根据网格的对称性和基函数的定义（$\\varphi_2$是$\\varphi_1$的空间平移），$A_{22} = a(\\varphi_2, \\varphi_2)$的计算是相同的。\n$A_{22} = \\int_{0}^{1} (\\varphi_2'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (\\varphi_2(x))^2\\,\\mathrm{d}x = \\frac{2}{h} + \\gamma \\frac{2h}{3}$。\n\n**元素 $A_{21}$：**\n$A_{21} = a(\\varphi_1, \\varphi_2) = \\int_{0}^{1} \\varphi_1'(x)\\varphi_2'(x)\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} \\varphi_1(x)\\varphi_2(x)\\,\\mathrm{d}x$。\n$\\varphi_1'$和$\\varphi_2'$的支集仅在区间$(h, 2h)$上重叠。\n$$ \\int_{0}^{1} \\varphi_1'(x)\\varphi_2'(x)\\,\\mathrm{d}x = \\int_{h}^{2h} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,\\mathrm{d}x = -\\frac{1}{h^2} \\int_{h}^{2h}\\,\\mathrm{d}x = -\\frac{h}{h^2} = -\\frac{1}{h} $$\n$\\varphi_1$和$\\varphi_2$的支集也仅在$(h, 2h)$上重叠。\n$$ \\int_{0}^{1} \\varphi_1(x)\\varphi_2(x)\\,\\mathrm{d}x = \\int_{h}^{2h} \\left(\\frac{2h-x}{h}\\right)\\left(\\frac{x-h}{h}\\right)\\,\\mathrm{d}x = \\frac{1}{h^2} \\int_{h}^{2h} (-x^2 + 3hx - 2h^2)\\,\\mathrm{d}x $$\n$$ = \\frac{1}{h^2} \\left[-\\frac{x^3}{3} + \\frac{3hx^2}{2} - 2h^2x\\right]_h^{2h} = \\frac{1}{h^2} \\left( \\left(-\\frac{8h^3}{3} + 6h^3 - 4h^3\\right) - \\left(-\\frac{h^3}{3} + \\frac{3h^3}{2} - 2h^3\\right) \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{6} \\right) = \\frac{h}{6} $$\n因此，$A_{21} = -\\frac{1}{h} + \\gamma \\frac{h}{6}$。\n\n**元素 $A_{12}$：**\n$A_{12} = a(\\varphi_2, \\varphi_1)$。由于双线性形式$a(u,v)$是对称的，即$a(u,v) = a(v,u)$，因此$A_{12} = A_{21}$。\n\n组装矩阵$A$：\n$$ A = \\begin{pmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{h} + \\frac{2\\gamma h}{3}  -\\frac{1}{h} + \\frac{\\gamma h}{6} \\\\ -\\frac{1}{h} + \\frac{\\gamma h}{6}  \\frac{2}{h} + \\frac{2\\gamma h}{3} \\end{pmatrix} $$\n代入$h=\\frac{1}{3}$：\n$$ \\frac{2}{h} = 6, \\quad \\frac{2\\gamma h}{3} = \\frac{2\\gamma}{9}, \\quad -\\frac{1}{h} = -3, \\quad \\frac{\\gamma h}{6} = \\frac{\\gamma}{18} $$\n刚度矩阵为：\n$$ A = \\begin{pmatrix} 6 + \\frac{2\\gamma}{9}  -3 + \\frac{\\gamma}{18} \\\\ -3 + \\frac{\\gamma}{18}  6 + \\frac{2\\gamma}{9} \\end{pmatrix} $$\n\n### 第二部分：$A$的性质及其与谱的关系\n\n无穷维空间$H_0^1(\\Omega)$上的连续双线性形式$a(\\cdot,\\cdot)$的性质直接转化为有限维向量空间$\\mathbb{R}^2$上的离散刚度矩阵$A$的性质。\n\n**对称性：**\n双线性形式$a(u,v) = \\int u'v' + \\gamma \\int uv$是对称的，因为对所有$u,v \\in H_0^1(\\Omega)$都有$a(u,v) = a(v,u)$。刚度矩阵$A$继承了此性质：\n$$ A_{ij} = a(\\varphi_j, \\varphi_i) = a(\\varphi_i, \\varphi_j) = A_{ji} $$\n因此，$A$是一个对称矩阵。我们的显式计算也证实了这一点。实对称矩阵的一个关键谱特性是其所有特征值都是实数。\n\n**正定性：**\n该双线性形式在$H_0^1(\\Omega)$上是矫顽的，即存在一个常数$\\alpha  0$，使得对所有$u \\in H_0^1(\\Omega)$，都有$a(u,u) \\ge \\alpha\\|u\\|_{H^1(\\Omega)}^2$。对于我们的形式，当$\\gamma  0$时：\n$$ a(u,u) = \\int_{0}^{1} (u'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (u(x))^2\\,\\mathrm{d}x $$\n由于$\\gamma0$，对于任何非零函数$u \\in H_0^1(\\Omega)$，都有$a(u,u)  0$。\n连续空间上的这种矫顽性蕴含了离散矩阵$A$的正定性。为了说明这一点，考虑一个任意的非零系数向量$\\mathbf{c} = (c_1, c_2)^T \\in \\mathbb{R}^2$。该向量通过$u_h(x) = c_1\\varphi_1(x) + c_2\\varphi_2(x)$定义了一个非零函数$u_h \\in V_h$。由于$\\{\\varphi_1, \\varphi_2\\}$是线性无关的，$\\mathbf{c} \\neq \\mathbf{0}$意味着$u_h \\not\\equiv 0$。\n现在考察二次型$\\mathbf{c}^T A \\mathbf{c}$：\n$$ \\mathbf{c}^T A \\mathbf{c} = \\sum_{i=1}^2 \\sum_{j=1}^2 c_i A_{ij} c_j = \\sum_{i=1}^2 \\sum_{j=1}^2 c_i a(\\varphi_j, \\varphi_i) c_j $$\n根据$a(\\cdot,\\cdot)$的双线性：\n$$ \\mathbf{c}^T A \\mathbf{c} = a\\left(\\sum_{j=1}^2 c_j\\varphi_j, \\sum_{i=1}^2 c_i\\varphi_i\\right) = a(u_h, u_h) $$\n由于$u_h$是$H_0^1(\\Omega)$中的一个非零函数，$a(\\cdot,\\cdot)$的矫顽性保证了$a(u_h, u_h)  0$。因此，对所有$\\mathbf{c} \\neq \\mathbf{0}$，都有$\\mathbf{c}^T A \\mathbf{c}  0$。这就是正定矩阵的定义。\n\n**谱特性：**\n矩阵$A$是对称且正定的。这对它的谱（其特征值集合）有直接影响：\n1.  $A$的所有特征值都是实数（由于对称性）。\n2.  $A$的所有特征值都是严格为正的（由于正定性）。\n设$\\lambda$是$A$的一个特征值，其对应的特征向量为$\\mathbf{c}$。那么$A\\mathbf{c} = \\lambda\\mathbf{c}$。与$\\mathbf{c}$做点积得到$\\mathbf{c}^T A \\mathbf{c} = \\lambda \\mathbf{c}^T \\mathbf{c} = \\lambda \\|\\mathbf{c}\\|_2^2$。由于对于非零特征向量，$\\mathbf{c}^T A \\mathbf{c}  0$且$\\|\\mathbf{c}\\|_2^2  0$，可得$\\lambda  0$。$A$的谱包含在$(0, \\infty)$内。\n\n### 第三部分：当$\\gamma = 4$时求最小特征值\n\n我们被要求计算当$\\gamma = 4$时矩阵$A$的最小特征值。将此值代入我们推导出的矩阵中：\n$$ A = \\begin{pmatrix} 6 + \\frac{2(4)}{9}  -3 + \\frac{4}{18} \\\\ -3 + \\frac{4}{18}  6 + \\frac{2(4)}{9} \\end{pmatrix} = \\begin{pmatrix} 6 + \\frac{8}{9}  -3 + \\frac{2}{9} \\\\ -3 + \\frac{2}{9}  6 + \\frac{8}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{62}{9}  -\\frac{25}{9} \\\\ -\\frac{25}{9}  \\frac{62}{9} \\end{pmatrix} $$\n特征值$\\lambda$是特征方程$\\det(A - \\lambda I) = 0$的根：\n$$ \\det \\begin{pmatrix} \\frac{62}{9} - \\lambda  -\\frac{25}{9} \\\\ -\\frac{25}{9}  \\frac{62}{9} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(\\frac{62}{9} - \\lambda\\right)^2 - \\left(-\\frac{25}{9}\\right)^2 = 0 $$\n$$ \\left(\\frac{62}{9} - \\lambda\\right)^2 = \\left(\\frac{25}{9}\\right)^2 $$\n对两边取平方根，得到两种可能：\n$$ \\frac{62}{9} - \\lambda = \\frac{25}{9} \\quad \\text{或} \\quad \\frac{62}{9} - \\lambda = -\\frac{25}{9} $$\n分别求解$\\lambda$：\n情况1：\n$$ \\lambda_1 = \\frac{62}{9} - \\frac{25}{9} = \\frac{37}{9} $$\n情况2：\n$$ \\lambda_2 = \\frac{62}{9} + \\frac{25}{9} = \\frac{87}{9} = \\frac{29}{3} $$\n两个特征值为$\\lambda_1 = \\frac{37}{9}$和$\\lambda_2 = \\frac{29}{3}$。为了找到最小值，我们比较它们：\n$\\frac{29}{3} = \\frac{87}{9}$。\n因为$\\frac{37}{9}  \\frac{87}{9}$，所以最小特征值为$\\frac{37}{9}$。", "answer": "$$\n\\boxed{\\frac{37}{9}}\n$$", "id": "3462584"}, {"introduction": "本问题深入探讨了加权余量法的基本定义，弥合了原始偏微分方程（强形式）与基于积分的弱形式之间的概念鸿沟。您将首先计算“余量”，即当近似解代入偏微分方程时产生的误差。通过对该余量进行加权并应用分部积分，您将发现作为伽辽金原理基石的弱形式是如何从要求余量与测试空间正交这一条件中自然产生的。[@problem_id:3462644]", "problem": "考虑定义在区间 $[0,h]$ 上的一维二阶线性椭圆偏微分方程 $-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x)$，其中 $h0$ 是单个内部有限元的长度，$a(x)$ 是一个严格正系数。假设 $a(x)$ 是可微的，并设 $a(x)=a_0+a_1 x$，其中 $a_00$ 和 $a_1\\in\\mathbb{R}$ 是常数，设 $f(x)=f_0$ 是一个常数源项。设在有限元方法 (FEM) 中，$u(x)$ 被线性有限元场 $u_h(x)=N_1(x)\\,u_1+N_2(x)\\,u_2$ 近似，其中 $u_1,u_2\\in\\mathbb{R}$ 是节点自由度，$[0,h]$ 上的标准形函数为 $N_1(x)=1-\\frac{x}{h}$ 和 $N_2(x)=\\frac{x}{h}$。考虑伽辽金原理，其中检验（权重）函数 $w_h$ 与试验函数取自同一空间，并将单元上的单元级强形式残差定义为 $R_e(u_h)=-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$。\n\n从加权残差法的基本定义和分部积分的微积分恒等式出发，完成以下任务：\n\n- 计算单元 $[0,h]$ 上 $R_e(u_h)$ 的显式表达式。\n- 计算加权残差积分 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$。\n- 使用分部积分，展示 $\\int_{0}^{h} w_h\\,R_e(u_h)\\,dx$ 如何分解为一个边界通量项和与弱形式相关的双线性形式，并因此证明，在跨单元全局组装过程中内部边界项相消后，所得到的刚度组装与从弱形式中获得的结果一致。\n\n请将您的最终答案表示为 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$ 的单个闭式解析表达式，用 $a_0$、$a_1$、$f_0$、$h$、$u_1$ 和 $u_2$ 表示。无需进行数值代入。最终答案中不要包含任何单位。", "solution": "该问题要求对一维线性椭圆方程进行基于加权残差法的三部分分析。首先，我们计算线性有限元近似下强形式残差的显式形式。其次，我们使用第一个形函数作为权重函数来计算加权残差积分。第三，我们展示应用于强形式的加权残差法与标准弱形式（或变分）提法之间的联系。\n\n设微分方程为\n$$-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x) \\quad \\text{for } x \\in [0,h]$$\n其中 $a(x) = a_0 + a_1 x$ 且 $f(x) = f_0$。有限元近似为 $u_h(x) = N_1(x)u_1 + N_2(x)u_2$，其中单元 $[0,h]$ 上的线性形函数为 $N_1(x) = 1 - \\frac{x}{h}$ 和 $N_2(x) = \\frac{x}{h}$。\n\n**第一部分：计算单元级强形式残差 $R_e(u_h)$ 的显式表达式**\n\n单元级强形式残差定义为 $R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$。首先，我们计算近似解 $u_h(x)$ 的导数：\n$$u_h(x) = \\left(1-\\frac{x}{h}\\right)u_1 + \\frac{x}{h}u_2$$\n$$\\frac{d u_h}{dx} = -\\frac{1}{h}u_1 + \\frac{1}{h}u_2 = \\frac{u_2 - u_1}{h}$$\n导数 $\\frac{d u_h}{dx}$ 在单元上是常数。接下来，我们计算项 $a(x)\\frac{d u_h}{dx}$：\n$$a(x)\\frac{d u_h}{dx} = (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right)$$\n现在我们对该表达式关于 $x$ 求导：\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\frac{d}{dx}\\left[ (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right) \\right]$$\n由于 $\\frac{u_2 - u_1}{h}$ 是一个常数，我们可以将其提出：\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\left(\\frac{u_2 - u_1}{h}\\right) \\frac{d}{dx}(a_0 + a_1 x) = \\left(\\frac{u_2 - u_1}{h}\\right) a_1$$\n最后，我们组装强形式残差 $R_e(u_h)$：\n$$R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) - f(x) = -a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$$\n这就是单元上强形式残差的显式表达式。注意，由于试验函数是线性的且系数 $a(x)$ 是线性的，因此它在整个单元上是常数。\n\n**第二部分：计算加权残差积分 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$**\n\n伽辽金方法要求残差与检验函数正交，这些检验函数与试验函数取自同一空间。这里，我们使用检验函数 $w_h(x) = N_1(x) = 1 - \\frac{x}{h}$。我们计算该积分：\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] dx$$\n包含残差的项 $-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$ 关于积分变量 $x$ 是常数。因此我们可以将其移到积分号外：\n$$= \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx$$\n我们现在计算形函数 $N_1(x)$ 在单元域上的积分：\n$$\\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx = \\left[x - \\frac{x^2}{2h}\\right]_0^h = \\left(h - \\frac{h^2}{2h}\\right) - (0) = h - \\frac{h}{2} = \\frac{h}{2}$$\n将此结果代回，我们得到加权残差积分的最终表达式：\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\left(\\frac{h}{2}\\right)$$\n$$= -a_1\\left(\\frac{u_2 - u_1}{h}\\right)\\frac{h}{2} - f_0\\frac{h}{2} = -\\frac{a_1}{2}(u_2 - u_1) - \\frac{f_0 h}{2}$$\n$$= \\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}$$\n\n**第三部分：分解为边界项和双线性项以及与弱形式的关系**\n\n我们从加权残差法的基本陈述开始，对于一个来自试验空间的通用检验函数 $w_h(x)$：\n$$\\int_{0}^{h} w_h(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} w_h(x) \\left[-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)\\right] dx = 0$$\n这可以写成：\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = \\int_{0}^{h} w_h(x) f(x) dx$$\n我们对左侧积分应用分部积分，使用公式 $\\int v \\, du' = [vu] - \\int v' \\, u$。设 $v = w_h(x)$ 且 $u' = \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)$。则 $v' = \\frac{dw_h}{dx}$ 且 $u = a(x)\\,\\frac{d u_h}{dx}$。\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = - \\left( \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h - \\int_0^h \\frac{d w_h}{dx} a(x) \\frac{d u_h}{dx} dx \\right)$$\n$$= \\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h$$\n将此代回加权残差方程得到：\n$$\\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = \\int_0^h w_h(x) f(x) dx$$\n这个方程展示了分解过程。我们可以识别出以下各项：\n1.  **双线性形式：** 项 $\\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx$ 是双线性形式 $B(u_h, w_h)$。当试验函数和检验函数用基函数（$u_h = \\sum_j N_j u_j$，$w_h = N_i$）展开时，该项产生单元刚度矩阵，其元素为 $K_{ij} = \\int_0^h a(x) \\frac{dN_i}{dx}\\frac{dN_j}{dx}dx$。\n2.  **边界通量项：** 项 $\\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = w_h(h) a(h) \\left.\\frac{du_h}{dx}\\right|_{x=h} - w_h(0) a(0) \\left.\\frac{du_h}{dx}\\right|_{x=0}$ 表示来自单元边界的贡献。量 $q_h(x) = -a(x) \\frac{du_h}{dx}$ 是数值通量。\n3.  **线性形式：** 项 $\\int_0^h w_h(x) f(x) dx$ 是线性形式 $L(w_h)$，它产生单元载荷向量 $F_i = \\int_0^h N_i(x) f(x) dx$。\n\n方程 $B(u_h, w_h) = L(w_h) + \\text{边界项}$ 正是该问题在单元层面上的弱形式。对加权强形式残差应用分部积分是推导弱形式提法的标准程序，这在计算上是有利的，因为它降低了对试验函数可微性的阶数要求。\n\n从弱形式产生的刚度组装是直接从双线性形式 $B(u_h, w_h)$ 导出的。我们的推导表明，这个双线性形式是在对加权强形式残差陈述进行一次分部积分后自然产生的。关键点在于，在有限元系统的全局组装过程中，相邻内部单元的边界通量项会相互抵消。对于单元 $(e)$ 和单元 $(e+1)$ 共享的一个节点，来自单元 $(e)$ 的项是 $-w_h(x_{node}) q_h(x_{node}^-)$，而来自单元 $(e+1)$ 的项是 $+w_h(x_{node}) q_h(x_{node}^+)$。由弱解所保证的通量连续性，$q_h(x_{node}^-) = q_h(x_{node}^+)$，确保了这些项在所有内部节点处相加为零。因此，一旦通过分部积分和单元间抵消妥善处理了边界项，从弱形式导出的刚度组装确实与从强形式获得的结果一致。", "answer": "$$\\boxed{\\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}}$$", "id": "3462644"}, {"introduction": "本实践将伽辽金方法从静态问题扩展到瞬态扩散现象，展示了空间离散化如何导出一个常微分方程组。您将比较两种处理质量矩阵的常见方法：直接源于伽辽金公式的“一致”质量矩阵，以及计算上更简便的“集总”质量矩阵。此分析将揭示这些离散化选择对显式时间积分方案的稳定性极限产生的深远影响，这是实际模拟中的一个关键考量。[@problem_id:3462580]", "problem": "考虑区间 $\\left[0,L\\right]$ 上具有齐次狄利克雷边界条件的一维扩散方程（一种抛物型偏微分方程）\n$$\nu_{t}(x,t)-\\alpha\\,u_{xx}(x,t)=0,\\quad x\\in(0,L),\\; t0,\\qquad u(0,t)=u(L,t)=0,\n$$\n其中 $\\alpha0$ 是一个常数扩散系数。使用加权余量法和 Galerkin 原理（试探空间与检验空间相同），在均匀网格上使用连续分片线性基函数，推导基于有限元法 (FEM) 的半离散有限元系统。设内部节点有 $N$ 个，因此网格尺寸为 $h=L/(N+1)$。这将得到一个常微分方程组\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{U}}(t)+\\alpha\\,\\mathbf{K}\\,\\mathbf{U}(t)=\\mathbf{0},\n$$\n其中 $\\mathbf{U}(t)\\in\\mathbb{R}^{N}$ 汇集了节点值，$\\mathbf{M}\\in\\mathbb{R}^{N\\times N}$ 是（对称、正定的）质量矩阵，$\\mathbf{K}\\in\\mathbb{R}^{N\\times N}$ 是（对称、半正定的）刚度矩阵。一致质量矩阵直接由 Galerkin 构造产生，而集中质量矩阵是通过对一致质量矩阵进行行和对角近似得到的。\n\n使用分量为 $v^{(j)}_{i}=\\sin\\!\\left(i\\,\\theta_{j}\\right)$（其中 $i=1,\\dots,N$ 且 $\\theta_{j}=\\frac{j\\pi}{N+1}$）的离散正弦基 $\\mathbf{v}^{(j)}$，分析广义特征值问题\n$$\n\\mathbf{K}\\,\\mathbf{v}^{(j)}=\\lambda_{j}\\,\\mathbf{M}\\,\\mathbf{v}^{(j)}\n$$\n对于一致质量矩阵和集中质量矩阵两种情况。从基本原理出发，针对两种质量矩阵处理方式，推导谱 $\\{\\lambda_{j}\\}$ 关于 $h$ 和 $\\theta_{j}$ 的闭式表达式。然后，使用应用于半离散系统 $\\dot{\\mathbf{U}}(t)=-\\alpha\\,\\mathbf{M}^{-1}\\mathbf{K}\\,\\mathbf{U}(t)$ 的前向欧拉显式时间步进法，通过线性绝对稳定性条件，确定每种情况下的最大稳定时间步长 $\\Delta t_{\\max}$。最后，计算这些最大稳定时间步长之比在 $N$ 趋于无穷大时的极限，\n$$\n\\lim_{N\\to\\infty}\\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}},\n$$\n并将此极限作为你的唯一最终答案。将最终答案表示为一个无量纲数。无需四舍五入。", "solution": "### 推导\n控制偏微分方程的弱形式是通过乘以一个在 $x=0$ 和 $x=L$ 处为零的检验函数 $v(x)$ 并在定义域 $[0, L]$ 上积分得到的。\n$$ \\int_0^L v u_t \\,dx - \\alpha \\int_0^L v u_{xx} \\,dx = 0 $$\n对第二项应用分部积分并使用齐次狄利克雷边界条件，得到：\n$$ \\int_0^L v u_t \\,dx + \\alpha \\int_0^L v_x u_x \\,dx = 0 $$\n有限元近似为 $u_h(x,t) = \\sum_{j=1}^N U_j(t) \\phi_j(x)$，其中 $\\phi_j(x)$ 是在均匀网格上的标准分片线性（帽状）基函数，节点为 $x_i = i h$，$i=0, \\dots, N+1$。函数 $\\phi_j(x)$ 在节点 $x_j$ 处为 1，在所有其他节点处为 0。\nGalerkin 方法将检验函数 $v(x)$ 设为基函数 $\\phi_i(x)$，$i=1, \\dots, N$。将近似解代入弱形式，得到半离散系统：\n$$ \\sum_{j=1}^N \\left( \\int_0^L \\phi_i \\phi_j \\,dx \\right) \\dot{U}_j(t) + \\alpha \\sum_{j=1}^N \\left( \\int_0^L \\phi_i' \\phi_j' \\,dx \\right) U_j(t) = 0 $$\n这就是系统 $\\mathbf{M}\\,\\dot{\\mathbf{U}}(t)+\\alpha\\,\\mathbf{K}\\,\\mathbf{U}(t)=\\mathbf{0}$，其矩阵项为：\n刚度矩阵: $K_{ij} = \\int_0^L \\phi_i' \\phi_j' \\,dx$。\n一致质量矩阵: $M_{c,ij} = \\int_0^L \\phi_i \\phi_j \\,dx$。\n\n基函数及其导数为：\n$\\phi_j(x) = \\begin{cases} (x-x_{j-1})/h  x \\in [x_{j-1}, x_j] \\\\ (x_{j+1}-x)/h  x \\in [x_j, x_{j+1}] \\\\ 0  \\text{otherwise} \\end{cases}$，且 $\\phi_j'(x) = \\begin{cases} 1/h  x \\in (x_{j-1}, x_j) \\\\ -1/h  x \\in (x_j, x_{j+1}) \\\\ 0  \\text{otherwise} \\end{cases}$。\n\n计算积分得到众所周知的三对角矩阵：\n$$ K_{ii} = \\int_{x_{i-1}}^{x_i} (1/h)^2 dx + \\int_{x_i}^{x_{i+1}} (-1/h)^2 dx = \\frac{2}{h} $$\n$$ K_{i,i\\pm 1} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i' \\phi_{i\\pm 1}' dx = -\\frac{1}{h} $$\n$$ M_{c,ii} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i^2 dx = \\frac{2h}{3} $$\n$$ M_{c,i,i\\pm 1} = \\int_{x_{i-1}}^{x_{i+1}} \\phi_i \\phi_{i\\pm 1} dx = \\frac{h}{6} $$\n因此，这两个 $N \\times N$ 矩阵为：\n$$ \\mathbf{K} = \\frac{1}{h} \\begin{pmatrix} 2  -1  \\\\ -1  2  -1 \\\\  \\ddots  \\ddots  \\ddots \\\\   -1  2 \\end{pmatrix}, \\quad \\mathbf{M}_c = \\frac{h}{6} \\begin{pmatrix} 4  1  \\\\ 1  4  1 \\\\  \\ddots  \\ddots  \\ddots \\\\   1  4 \\end{pmatrix} $$\n集中质量矩阵 $\\mathbf{M}_l$ 是通过将 $\\mathbf{M}_c$ 的行求和并将和放在对角线上得到的。对于内部行 $i \\in [2, N-1]$，和为 $h/6 + 4h/6 + h/6 = h$。对于第一行和最后一行 ($i=1, N$)，和为 $4h/6 + h/6 = 5h/6$。\n$$ \\mathbf{M}_l = \\text{diag}\\left(\\frac{5h}{6}, h, \\dots, h, \\frac{5h}{6}\\right) $$\n广义特征值问题为 $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j \\mathbf{M} \\mathbf{v}^{(j)}$。特征值 $\\lambda_j$ 是矩阵 $\\mathbf{M}^{-1}\\mathbf{K}$ 的特征值。\n\n首先，我们求出 $\\mathbf{K}$ 和 $\\mathbf{M}_c$ 相对于基 $\\mathbf{v}^{(j)}$ 的特征值。$\\mathbf{K}\\mathbf{v}^{(j)}$ 的第 $i$ 个分量是：\n$$ (\\mathbf{K}\\mathbf{v}^{(j)})_i = \\frac{1}{h}(-v_{i-1}^{(j)} + 2v_i^{(j)} - v_{i+1}^{(j)}) = \\frac{1}{h}(-\\sin((i-1)\\theta_j) + 2\\sin(i\\theta_j) - \\sin((i+1)\\theta_j)) $$\n使用恒等式 $\\sin(A-B)+\\sin(A+B) = 2\\sin A\\cos B$，我们得到：\n$$ (\\mathbf{K}\\mathbf{v}^{(j)})_i = \\frac{1}{h}(2v_i^{(j)} - 2v_i^{(j)}\\cos\\theta_j) = \\frac{2}{h}(1-\\cos\\theta_j)v_i^{(j)} = \\frac{4}{h}\\sin^2\\left(\\frac{\\theta_j}{2}\\right) v_i^{(j)} $$\n所以，$\\mathbf{v}^{(j)}$ 是 $\\mathbf{K}$ 的特征向量，对应的特征值为 $\\mu_j = \\frac{4}{h}\\sin^2(\\frac{\\theta_j}{2})$。\n\n类似地，对于一致质量矩阵 $\\mathbf{M}_c$：\n$$ (\\mathbf{M}_c\\mathbf{v}^{(j)})_i = \\frac{h}{6}(v_{i-1}^{(j)} + 4v_i^{(j)} + v_{i+1}^{(j)}) = \\frac{h}{6}(2v_i^{(j)}\\cos\\theta_j + 4v_i^{(j)}) = \\frac{h}{3}(2+\\cos\\theta_j)v_i^{(j)} $$\n所以，$\\mathbf{v}^{(j)}$ 是 $\\mathbf{M}_c$ 的特征向量，对应的特征值为 $\\nu_j = \\frac{h}{3}(2+\\cos\\theta_j)$。\n\n**一致质量矩阵情况下的特征值**\n对于 $\\mathbf{M}=\\mathbf{M}_c$，广义特征值问题 $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j^{\\text{consistent}}\\mathbf{M}_c\\mathbf{v}^{(j)}$ 变为 $\\mu_j \\mathbf{v}^{(j)} = \\lambda_j^{\\text{consistent}} \\nu_j \\mathbf{v}^{(j)}$。\n$$ \\lambda_j^{\\text{consistent}} = \\frac{\\mu_j}{\\nu_j} = \\frac{\\frac{4}{h}\\sin^2(\\frac{\\theta_j}{2})}{\\frac{h}{3}(2+\\cos\\theta_j)} = \\frac{12}{h^2}\\frac{\\sin^2(\\frac{\\theta_j}{2})}{2+(1-2\\sin^2(\\frac{\\theta_j}{2}))} = \\frac{12}{h^2}\\frac{\\sin^2(\\frac{\\theta_j}{2})}{3-2\\sin^2(\\frac{\\theta_j}{2})} $$\n\n**集中质量矩阵情况下的特征值**\n对于大的 $N$，矩阵 $\\mathbf{M}_l$ 是 $h\\mathbf{I}$ 的一个秩-2扰动。$\\mathbf{M}_l^{-1}\\mathbf{K}$ 的最大特征值收敛于 $(h\\mathbf{I})^{-1}\\mathbf{K} = h^{-1}\\mathbf{K}$ 的最大特征值。因此，我们分析简化集中系统 $\\mathbf{M}_l \\approx h\\mathbf{I}$ 的广义特征值问题以找到极限行为。\n对于 $\\mathbf{M}=h\\mathbf{I}$，广义特征值问题是 $\\mathbf{K}\\mathbf{v}^{(j)} = \\lambda_j^{\\text{lumped}}(h\\mathbf{I})\\mathbf{v}^{(j)}$，这给出 $\\mu_j \\mathbf{v}^{(j)} = h\\lambda_j^{\\text{lumped}}\\mathbf{v}^{(j)}$。\n$$ \\lambda_j^{\\text{lumped}} = \\frac{\\mu_j}{h} = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_j}{2}\\right) $$\n\n**稳定性分析**\n应用于 $\\dot{\\mathbf{U}} = -\\alpha \\mathbf{M}^{-1}\\mathbf{K} \\mathbf{U}$ 的前向欧拉法是稳定的，如果对 $\\mathbf{M}^{-1}\\mathbf{K}$ 的所有特征值 $\\lambda_j$ 都有 $|1-\\alpha\\Delta t \\lambda_j| \\le 1$。由于 $\\mathbf{K}$ 是半正定的，$\\mathbf{M}$ 是正定的，所以 $\\lambda_j \\ge 0$。该条件简化为 $\\alpha\\Delta t \\lambda_j \\le 2$。这对所有 $j$ 都必须成立，因此我们需要 $\\Delta t \\le \\frac{2}{\\alpha\\lambda_{\\max}}$，其中 $\\lambda_{\\max} = \\max_{j} \\lambda_j$。最大稳定时间步长为 $\\Delta t_{\\max} = \\frac{2}{\\alpha\\lambda_{\\max}}$。\n\n为了找到 $\\lambda_{\\max}$，我们求 $\\lambda_j$ 在 $j=1, \\dots, N$ 上的最大值。\n项 $\\sin^2(\\theta_j/2) = \\sin^2(\\frac{j\\pi}{2(N+1)})$ 对于 $j \\in [1, N]$ 是单调递增的。\n来自 $\\lambda_j^{\\text{consistent}}$ 的函数 $f(s) = s/(3-2s)$ 对于 $s \\in [0, 1/2]$ 也是单调递增的，因为 $f'(s)=3/(3-2s)^20$。\n因此，两种情况下的最大特征值都出现在 $j=N$ 处。\n对于 $j=N$，$\\theta_N = \\frac{N\\pi}{N+1} = \\pi - \\frac{\\pi}{N+1}$。所以 $\\sin^2(\\frac{\\theta_N}{2}) = \\sin^2(\\frac{\\pi}{2}-\\frac{\\pi}{2(N+1)}) = \\cos^2(\\frac{\\pi}{2(N+1)})$。\n\n最大特征值：\n$$ \\lambda_{\\max}^{\\text{lumped}} = \\frac{4}{h^2}\\cos^2\\left(\\frac{\\pi}{2(N+1)}\\right) $$\n$$ \\lambda_{\\max}^{\\text{consistent}} = \\frac{12}{h^2}\\frac{\\cos^2(\\frac{\\pi}{2(N+1)})}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n\n最大稳定时间步长：\n$$ \\Delta t_{\\max}^{\\text{lumped}} = \\frac{2}{\\alpha\\lambda_{\\max}^{\\text{lumped}}} = \\frac{2h^2}{4\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{h^2}{2\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n$$ \\Delta t_{\\max}^{\\text{consistent}} = \\frac{2}{\\alpha\\lambda_{\\max}^{\\text{consistent}}} = \\frac{2h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{12\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{6\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n\n**比值与极限**\n最大稳定时间步长的比值为：\n$$ \\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}} = \\frac{\\frac{h^2}{2\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})}}{\\frac{h^2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))}{6\\alpha\\cos^2(\\frac{\\pi}{2(N+1)})}} = \\frac{6}{2(3-2\\cos^2(\\frac{\\pi}{2(N+1)}))} = \\frac{3}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} $$\n我们现在计算当 $N \\to \\infty$ 时的极限。当 $N \\to \\infty$ 时，余弦的自变量 $\\frac{\\pi}{2(N+1)} \\to 0$。由于当 $x \\to 0$ 时 $\\cos(x) \\to 1$，我们有：\n$$ \\lim_{N\\to\\infty} \\frac{\\Delta t_{\\max}^{\\text{lumped}}}{\\Delta t_{\\max}^{\\text{consistent}}} = \\lim_{N\\to\\infty} \\frac{3}{3-2\\cos^2(\\frac{\\pi}{2(N+1)})} = \\frac{3}{3-2(1)^2} = \\frac{3}{1} = 3 $$\n这个结果表明，对于细网格，使用集中质量矩阵的显式时间步进格式所允许的时间步长是使用一致质量矩阵所允许的三倍。", "answer": "$$\\boxed{3}$$", "id": "3462580"}]}