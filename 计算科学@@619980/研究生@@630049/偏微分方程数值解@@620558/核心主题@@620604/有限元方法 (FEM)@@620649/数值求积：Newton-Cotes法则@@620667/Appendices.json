{"hands_on_practices": [{"introduction": "本章的第一个实践将带您回到原点，推导最简单的闭式牛顿-科茨公式——梯形法则。这个练习是基础性的，它通过要求您推导权重和对误差项进行形式化分析，来巩固插值型求积的核心概念。这对于理解数值积分中精度的定义和量化至关重要。", "problem": "设 $f \\in C^{2}([a,b])$，其中 $a  b$。$n=1$ 的闭式牛顿-科特斯公式（梯形法则）形式为 $\\int_{a}^{b} f(x)\\,dx \\approx w_{0}f(a) + w_{1}f(b)$，其误差项为 $E(f) = C f''(\\xi)$，$\\xi \\in (a,b)$。求权重 $w_0, w_1$ 和误差常数 $C$。将结果表示为行向量 $(w_0, w_1, C)$。", "solution": "该问题要求确定 $n=1$ 闭合 Newton-Cotes 公式（梯形法则）的权重，推导其积分误差表示，并计算著名误差公式中的常数。最终答案将以包含两个权重和误差常数的行向量形式呈现。\n\n**第一部分：确定权重 $w_{0}$ 和 $w_{1}$**\n\n求积法则 $Q[f] = w_{0}f(a)+w_{1}f(b)$ 要求对所有次数至多为 1 的多项式都精确。我们将此类多项式的空间记为 $\\mathcal{P}_{1}$。根据积分和求积法则的线性性质，我们只需对 $\\mathcal{P}_{1}$ 的一组基强制其精确即可。一组方便的基是 $\\{1, x\\}$。\n\n对于基函数 $p_{0}(x) = 1$：\n精确积分为 $\\int_{a}^{b} 1 \\,dx = x \\big|_{a}^{b} = b-a$。\n求积公式给出 $Q[p_{0}] = w_{0}p_{0}(a) + w_{1}p_{0}(b) = w_{0}(1) + w_{1}(1) = w_{0} + w_{1}$。\n为使法则精确，我们必须有：\n$$\nw_{0} + w_{1} = b-a\n$$\n\n对于基函数 $p_{1}(x) = x$：\n精确积分为 $\\int_{a}^{b} x \\,dx = \\frac{x^{2}}{2} \\bigg|_{a}^{b} = \\frac{b^{2}-a^{2}}{2}$。\n求积公式给出 $Q[p_{1}] = w_{0}p_{1}(a) + w_{1}p_{1}(b) = w_{0}a + w_{1}b$。\n为使法则精确，我们必须有：\n$$\naw_{0} + bw_{1} = \\frac{b^{2}-a^{2}}{2} = \\frac{(b-a)(b+a)}{2}\n$$\n\n我们现在得到一个关于 $w_{0}$ 和 $w_{1}$ 的二元线性方程组：\n1. $w_{0} + w_{1} = b-a$\n2. $aw_{0} + bw_{1} = \\frac{(b-a)(b+a)}{2}$\n\n由方程 (1)，我们得到 $w_{1} = (b-a) - w_{0}$。将其代入方程 (2)：\n$$\naw_{0} + b((b-a) - w_{0}) = \\frac{(b-a)(b+a)}{2}\n$$\n$$\naw_{0} + b(b-a) - bw_{0} = \\frac{(b-a)(b+a)}{2}\n$$\n$$\nw_{0}(a-b) = \\frac{(b-a)(b+a)}{2} - b(b-a)\n$$\n在等式右边提出公因式 $(b-a)$：\n$$\n-w_{0}(b-a) = (b-a)\\left(\\frac{b+a}{2} - b\\right)\n$$\n因为给定 $a  b$，所以 $b-a \\neq 0$，因此我们可以将两边同除以 $(b-a)$：\n$$\n-w_{0} = \\frac{a+b-2b}{2} = \\frac{a-b}{2}\n$$\n$$\nw_{0} = \\frac{b-a}{2}\n$$\n现在，我们用 $w_{1} = (b-a) - w_{0}$ 求出 $w_{1}$：\n$$\nw_{1} = (b-a) - \\frac{b-a}{2} = \\frac{b-a}{2}\n$$\n因此，权重为 $w_{0} = \\frac{b-a}{2}$ 和 $w_{1} = \\frac{b-a}{2}$。\n\n**第二部分：推导误差核函数 $K(t)$**\n\n误差泛函为 $E(f) = \\int_{a}^{b} f(x)\\,dx - Q[f]$。由于该法则对次数至多为 1 的多项式精确，根据 Peano 核定理，误差可以表示为 $E(f) = \\int_{a}^{b} f''(t)K(t)\\,dt$，其中核函数 $K(t)$ 由 $K(t) = E_{x}[(x-t)_{+}]$ 给出。下标 $x$ 表示泛函 $E$ 作用于其自变量时，是将其视为变量 $x$ 的函数。\n\n对于 $t \\in [a,b]$，核函数 $K(t)$ 为：\n$$\nK(t) = \\int_{a}^{b} (x-t)_{+}\\,dx - \\left(w_{0}(a-t)_{+} + w_{1}(b-t)_{+}\\right)\n$$\n其中 $(z)_{+} = \\max(z,0)$。\n\n我们来计算积分项。因为 $t \\in [a,b]$，当 $x \\le t$ 时函数 $(x-t)_{+}$ 为零，当 $x > t$ 时等于 $x-t$。\n$$\n\\int_{a}^{b} (x-t)_{+}\\,dx = \\int_{t}^{b} (x-t)\\,dx = \\left[\\frac{(x-t)^{2}}{2}\\right]_{t}^{b} = \\frac{(b-t)^{2}}{2} - 0 = \\frac{(b-t)^{2}}{2}\n$$\n接下来，我们计算泛函的求积部分。对于 $t \\in [a,b]$，我们有 $t \\ge a$，这意味着 $a-t \\le 0$，所以 $(a-t)_{+} = 0$。我们也有 $t \\le b$，这意味着 $b-t \\ge 0$，所以 $(b-t)_{+} = b-t$。\n使用我们求得的权重，$w_{0} = w_{1} = \\frac{b-a}{2}$：\n$$\nw_{0}(a-t)_{+} + w_{1}(b-t)_{+} = \\frac{b-a}{2}(0) + \\frac{b-a}{2}(b-t) = \\frac{(b-a)(b-t)}{2}\n$$\n结合这些结果，得到核函数：\n$$\nK(t) = \\frac{(b-t)^{2}}{2} - \\frac{(b-a)(b-t)}{2} = \\frac{b-t}{2}\\left((b-t) - (b-a)\\right) = \\frac{b-t}{2}(a-t)\n$$\n因此，核函数的显式形式为 $K(t) = \\frac{1}{2}(t-a)(t-b)$。\n\n**第三部分：推导误差常数 $C$**\n\n我们有误差表达式 $E(f) = \\int_{a}^{b} f''(t)K(t)\\,dt$。问题要求证明 $E(f) = C f''(\\xi)$ 对于某个 $\\xi \\in (a,b)$ 成立，并求出常数 $C$。\n我们考察核函数 $K(t) = \\frac{1}{2}(t-a)(t-b)$ 在区间 $(a,b)$ 上的符号。对于任何 $t \\in (a,b)$，我们有 $t-a > 0$ 和 $t-b  0$。因此，对于所有 $t \\in (a,b)$，$K(t)  0$。\n因为 $f \\in C^{2}([a,b])$，其二阶导数 $f''(t)$ 在 $[a,b]$ 上连续。核函数 $K(t)$ 是一个在 $(a,b)$ 上不变号的可积函数。因此，我们可以应用积分中值定理，该定理指出存在一个值 $\\xi \\in (a,b)$ 使得：\n$$\n\\int_{a}^{b} f''(t)K(t)\\,dt = f''(\\xi)\\int_{a}^{b} K(t)\\,dt\n$$\n将此与期望的表达式 $E(f) = C f''(\\xi)$ 进行比较，我们确定常数 $C$ 就是核函数的定积分：\n$$\nC = \\int_{a}^{b} K(t)\\,dt = \\int_{a}^{b} \\frac{1}{2}(t-a)(t-b)\\,dt\n$$\n我们来计算这个积分。\n$$\nC = \\frac{1}{2}\\int_{a}^{b} (t^{2} - (a+b)t + ab)\\,dt = \\frac{1}{2}\\left[\\frac{t^{3}}{3} - (a+b)\\frac{t^{2}}{2} + abt\\right]_{a}^{b}\n$$\n$$\nC = \\frac{1}{2}\\left[\\left(\\frac{b^{3}}{3} - \\frac{(a+b)b^{2}}{2} + ab^{2}\\right) - \\left(\\frac{a^{3}}{3} - \\frac{(a+b)a^{2}}{2} + a^{2}b\\right)\\right]\n$$\n$$\nC = \\frac{1}{2}\\left[\\frac{b^{3}-a^{3}}{3} - \\frac{a+b}{2}(b^{2}-a^{2}) + ab(b-a)\\right]\n$$\n提出公因式 $(b-a)$：\n$$\nC = \\frac{b-a}{2}\\left[\\frac{b^{2}+ab+a^{2}}{3} - \\frac{(a+b)^{2}}{2} + ab\\right]\n$$\n将各项通分，分母为 $6$：\n$$\nC = \\frac{b-a}{12}\\left[2(b^{2}+ab+a^{2}) - 3(a+b)^{2} + 6ab\\right]\n$$\n$$\nC = \\frac{b-a}{12}\\left[2b^{2}+2ab+2a^{2} - 3(a^{2}+2ab+b^{2}) + 6ab\\right]\n$$\n$$\nC = \\frac{b-a}{12}\\left[2b^{2}+2ab+2a^{2} - 3a^{2}-6ab-3b^{2} + 6ab\\right]\n$$\n合并括号内的同类项：\n$$\nC = \\frac{b-a}{12}\\left[-a^{2} + 2ab - b^{2}\\right] = \\frac{b-a}{12}\\left[-(a^{2}-2ab+b^{2})\\right]\n$$\n$$\nC = \\frac{b-a}{12}\\left[-(a-b)^{2}\\right] = -\\frac{b-a}{12}(b-a)^{2} = -\\frac{(b-a)^{3}}{12}\n$$\n最终答案所需的各部分为 $w_{0} = \\frac{b-a}{2}$，$w_{1} = \\frac{b-a}{2}$，以及 $C = -\\frac{(b-a)^{3}}{12}$。\n最终答案是行向量 $(w_0, w_1, C)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{b-a}{2}  \\frac{b-a}{2}  -\\frac{(b-a)^{3}}{12} \\end{pmatrix}}\n$$", "id": "3426583"}, {"introduction": "在掌握了基本法则之后，我们可以系统地提升其精度。本练习将演示一种强大的技术——理查森外推法，它利用了复合梯形法则 [@problem_id:3426583] 的误差展开式。通过组合不同步长的计算结果，我们可以消除主导误差项，从而构建一个更高阶的数值方法，这也为辛普森法则等方法的来源提供了深刻见解。", "problem": "考虑一个出现在一维偏微分方程（PDE）弱形式中的光滑被积函数 $f \\in C^{5}([a,b])$。任务是使用 Newton–Cotes 法则来计算双线性形式积分 $I = \\int_{a}^{b} f(x)\\,dx$。设子区间大小均匀的复合梯形法则（步长 $h = \\frac{b-a}{N}$）记为\n$$\nT(h) = h \\left( \\frac{f(a) + f(b)}{2} + \\sum_{k=1}^{N-1} f(a + k h) \\right),\n$$\n类似地，$T(h/2)$ 表示在相同区间 $[a,b]$ 上使用步长 $h/2$ 计算的复合梯形法则。\n\n设计一个单步 Richardson 外推，通过组合 $T(h)$ 和 $T(h/2)$ 来生成 $I$ 的一个估计值 $Q(h)$，使其误差为 $O(h^{4})$。你的设计必须：\n- 选择常数 $\\alpha$ 和 $\\beta$ 来构成线性组合 $Q(h) = \\alpha\\,T(h/2) + \\beta\\,T(h)$。\n- 以 Euler–Maclaurin 求和公式为基本依据，证明你的选择为何能消去 $T(h)$ 误差展开式中的首项 $O(h^{2})$，从而达到 $O(h^{4})$ 的精度。\n- 提供用 $T(h/2)$ 和 $T(h)$ 表示的 $Q(h)$ 的最终闭合形式表达式。\n\n将你的最终答案表示为单个闭合形式的解析表达式。无需进行四舍五入。", "solution": "该问题要求设计一个单步 Richardson 外推来提高复合梯形法则的精度。其目标是组合两个估计值 $T(h)$ 和 $T(h/2)$，以产生一个具有更高精度阶的新估计值 $Q(h)$。此过程的理论依据依赖于 Euler–Maclaurin 求和公式。\n\n首先，我们建立复合梯形法则 $T(h)$ 的渐近误差展开式。Euler–Maclaurin 公式提供了一个积分与其对应求和之间的关系。对于区间 $[m, n]$ 上的一个足够光滑的函数 $g$，该公式可以表示为：\n$$\n\\sum_{k=m}^{n} g(k) = \\int_{m}^{n} g(t) dt + \\frac{g(m)+g(n)}{2} + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(n) - g^{(2j-1)}(m) \\right) + R_p\n$$\n其中 $B_{2j}$ 是 Bernoulli 数。\n\n为了将此应用于我们的积分 $I = \\int_{a}^{b} f(x)\\,dx$，我们进行变量替换 $x = a + th$，其中 $h = \\frac{b-a}{N}$。当 $t$ 从 $0$ 变到 $N$ 时，$x$ 从 $a$ 变到 $b$。积分变为 $I = h \\int_{0}^{N} f(a+th) dt$。令 $g(t) = f(a+th)$。\n复合梯形法则由下式给出：\n$$\nT(h) = h \\left( \\frac{f(a) + f(b)}{2} + \\sum_{k=1}^{N-1} f(a + k h) \\right) = h \\left( \\frac{g(0) + g(N)}{2} + \\sum_{k=1}^{N-1} g(k) \\right)\n$$\n这可以重写为 $\\frac{T(h)}{h} = \\sum_{k=0}^{N} g(k) - \\frac{g(0) + g(N)}{2}$。\n重新整理 Euler–Maclaurin 公式，我们得到：\n$$\n\\sum_{k=0}^{N} g(k) - \\frac{g(0) + g(N)}{2} = \\int_{0}^{N} g(t) dt + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(N) - g^{(2j-1)}(0) \\right) + R_p\n$$\n代入我们关于 $\\frac{T(h)}{h}$ 和 $\\int_{0}^{N} g(t) dt = \\frac{I}{h}$ 的表达式：\n$$\n\\frac{T(h)}{h} = \\frac{I}{h} + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(N) - g^{(2j-1)}(0) \\right) + R_p'\n$$\n$g(t)$ 的导数通过链式法则与 $f(x)$ 的导数相关：$g^{(k)}(t) = h^k f^{(k)}(a+th)$。\n因此，$g^{(2j-1)}(N) = h^{2j-1}f^{(2j-1)}(b)$ 且 $g^{(2j-1)}(0) = h^{2j-1}f^{(2j-1)}(a)$。\n将这些代回并将整个方程乘以 $h$，我们得到：\n$$\nT(h) = I + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} h^{2j} \\left( f^{(2j-1)}(b) - f^{(2j-1)}(a) \\right) + O(h^{2p+2})\n$$\n条件 $f \\in C^{5}([a,b])$ 确保了我们可以将展开式写到 $O(h^4)$ 项，并有一个良定义的余项。我们定义与 $h$ 无关的常数 $C_2$ 和 $C_4$：\n$C_2 = \\frac{B_2}{2!} \\left( f'(b) - f'(a) \\right)$\n$C_4 = \\frac{B_4}{4!} \\left( f'''(b) - f'''(a) \\right)$\n因此，梯形法则的误差展开式为：\n$$\nT(h) = I + C_2 h^2 + C_4 h^4 + O(h^6)\n$$\n这个关于 $h$ 的偶数次幂的展开式是 Richardson 外推法的基础。\n\n现在，我们写出步长为 $h$ 和步长为 $h/2$ 时的展开式：\n$$\nT(h) = I + C_2 h^2 + C_4 h^4 + O(h^6) \\quad (1)\n$$\n$$\nT(h/2) = I + C_2 \\left(\\frac{h}{2}\\right)^2 + C_4 \\left(\\frac{h}{2}\\right)^4 + O(h^6) = I + \\frac{1}{4} C_2 h^2 + \\frac{1}{16} C_4 h^4 + O(h^6) \\quad (2)\n$$\n我们试图构造一个线性组合 $Q(h) = \\alpha\\,T(h/2) + \\beta\\,T(h)$，来为 $I$ 提供一个更好的估计。将展开式 $(1)$ 和 $(2)$ 代入此形式：\n$$\nQ(h) = \\alpha \\left(I + \\frac{1}{4} C_2 h^2 + \\frac{1}{16} C_4 h^4 \\right) + \\beta \\left(I + C_2 h^2 + C_4 h^4 \\right) + O(h^6)\n$$\n$$\nQ(h) = (\\alpha + \\beta)I + \\left( \\frac{\\alpha}{4} + \\beta \\right) C_2 h^2 + \\left( \\frac{\\alpha}{16} + \\beta \\right) C_4 h^4 + O(h^6)\n$$\n为了使 $Q(h)$ 成为 $I$ 的更精确近似，我们对系数 $\\alpha$ 和 $\\beta$ 施加两个条件：\n1. $I$ 的系数必须为 $1$，以保证估计是一致的：\n   $$ \\alpha + \\beta = 1 $$\n2. 首项误差项 $C_2 h^2$ 的系数必须为 $0$，以消去此项：\n   $$ \\frac{\\alpha}{4} + \\beta = 0 $$\n现在我们有了一个关于 $\\alpha$ 和 $\\beta$ 的二元线性方程组。从第二个方程，我们得到 $\\beta = -\\frac{\\alpha}{4}$。将其代入第一个方程：\n$$\n\\alpha - \\frac{\\alpha}{4} = 1 \\implies \\frac{3}{4}\\alpha = 1 \\implies \\alpha = \\frac{4}{3}\n$$\n然后，我们求出 $\\beta$：\n$$\n\\beta = 1 - \\alpha = 1 - \\frac{4}{3} = -\\frac{1}{3}\n$$\n使用这些 $\\alpha$ 和 $\\beta$ 的值，外推估计值 $Q(h)$ 为：\n$$\nQ(h) = \\frac{4}{3}T(h/2) - \\frac{1}{3}T(h)\n$$\n这个新估计值的误差由其展开式中的下一个非零项决定。$C_2 h^2$ 项根据构造为零。$I$ 项的系数为 $1$。因此误差为：\n$$\nQ(h) - I = \\left( \\frac{\\alpha}{16} + \\beta \\right) C_4 h^4 + O(h^6)\n$$\n我们来计算新的首项系数：\n$$\n\\frac{\\alpha}{16} + \\beta = \\frac{4/3}{16} - \\frac{1}{3} = \\frac{1}{12} - \\frac{1}{3} = \\frac{1-4}{12} = -\\frac{3}{12} = -\\frac{1}{4}\n$$\n所以 $Q(h)$ 的误差是：\n$$\nQ(h) - I = -\\frac{1}{4} C_4 h^4 + O(h^6)\n$$\n这证实了误差是 $O(h^4)$ 阶，符合要求。所得公式即为 Simpson 法则，这里是通过对梯形法则进行 Richardson 外推得到的。\n\n用 $T(h)$ 和 $T(h/2)$ 表示的改进估计值 $Q(h)$ 的最终表达式为：\n$$\nQ(h) = \\frac{4}{3}T(h/2) - \\frac{1}{3}T(h)\n$$\n这可以写成一个单一的闭合形式。", "answer": "$$\n\\boxed{\\frac{4}{3}T\\left(\\frac{h}{2}\\right) - \\frac{1}{3}T(h)}\n$$", "id": "3426550"}, {"introduction": "数值方法的真正威力体现在能够自动调整以满足预设精度的自适应算法中。本练习将从理论误差分析转向实际应用，要求您为辛普森法则设计一个后验误差估计器。这是自适应求积程序的核心部件，它使得算法能够智能地在需要的地方加密网格，以满足给定的容差要求。", "problem": "在为线性标量偏微分方程 (PDE) 构建一维有限元矩阵时，您必须使用闭式 Newton–Cotes 法则来近似计算在当前区间 $\\left[x_0,x_2\\right]\\subset [A,B]$ 上的形如 $\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x$ 的积分。考虑在区间 $\\left[x_0,x_2\\right]$ 上使用复合 Simpson 法则，粗步长为 $h:=x_2-x_0$，即使用节点 $x_0$、$x_1:=\\tfrac{x_0+x_2}{2}$ 和 $x_2$ 的单区间 Simpson 近似 $S_h$。现在通过将 $\\left[x_0,x_2\\right]$ 分割成 $2$ 个长度为 $h/2$ 的半区间来加密该区间，并在每个子区间上应用 Simpson 法则，从而得到加密后的复合近似 $S_{h/2}$ 和可计算的差值 $D := S_{h/2}-S_h$。\n\n假设 $f$ 足够光滑，使得在长度为 $h$ 的区间上的 Simpson 法则误差与 $h^5$ 乘以 $f^{(4)}$ 在该区间内某一点的取值成正比。为加密后的近似 $S_{h/2}$ 构建一个仅依赖于 $D$ 的一致局部后验误差估计子，然后基于用户为 $[A,B]$ 上的全积分指定的绝对容差 $\\varepsilon0$ 推导出一个接受准则。对于当前区间，采用标准的局部容差分配 $\\tau := \\varepsilon\\,\\frac{x_2-x_0}{B-A}$。您的接受准则应具有“如果 $\\lvert D\\rvert \\leq \\text{threshold}(\\varepsilon,x_2-x_0,B-A)$，则接受加密后的区间”的形式。请提供该阈值作为 $\\varepsilon$、$x_2-x_0$ 和 $B-A$ 的函数的显式闭式表达式。\n\n您的最终答案必须是单个解析表达式。无需单位，也无需四舍五入。", "solution": "我们从闭式 Newton–Cotes Simpson 法则一个经过充分检验的事实出发：对于一个足够光滑的被积函数 $f$，在长度为 $h$ 的区间上的单区间 Simpson 近似满足\n$$\n\\int_{a}^{b} f(x)\\,\\mathrm{d}x - S_h = E_h = -\\frac{(b-a)^5}{2880}\\,f^{(4)}(\\xi),\n$$\n其中某个 $\\xi\\in[a,b]$。因此，局部截断误差的量级为 $E_h=\\mathcal{O}(h^5)$，其常数与 $f^{(4)}$ 有关。\n\n在长度为 $h:=x_2-x_0$ 的区间 $\\left[x_0,x_2\\right]$ 上，粗略的 Simpson 近似 $S_h$ 的误差为\n$$\nE_h := \\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - S_h = -\\frac{h^5}{2880}\\,f^{(4)}(\\xi_h).\n$$\n将区间加密为 $2$ 个长度为 $h/2$ 的半区间，并在每个子区间上应用 Simpson 法则，得到加密后的复合近似 $S_{h/2}$。其总误差是两个子区间误差之和。在 $f^{(4)}$ 光滑的条件下，对于每个长度为 $h/2$ 的子区间，误差为 $-\\frac{(h/2)^5}{2880}f^{(4)}$。因此，总误差满足\n$$\nE_{h/2} := \\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - S_{h/2} \\approx 2 \\left( -\\frac{(h/2)^5}{2880}f^{(4)}(\\xi_{h/2}) \\right) = 2 \\cdot \\frac{1}{32} \\left(-\\frac{h^5}{2880}f^{(4)}(\\xi_{h/2})\\right) \\approx \\frac{1}{16} E_h,\n$$\n这里我们利用了 $f^{(4)}$ 在区间内变化不大的假设。因此，主阶关系为 $E_{h/2}\\approx \\tfrac{1}{16}E_h$。\n\n现在考虑可计算的差值\n$$\nD := S_{h/2}-S_h = \\bigl(\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - E_{h/2}\\bigr) - \\bigl(\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - E_h\\bigr) = E_h - E_{h/2}.\n$$\n使用 $E_{h/2}\\approx \\tfrac{1}{16}E_h$，我们得到主阶近似\n$$\nD \\approx E_h - \\frac{1}{16}E_h = \\frac{15}{16}\\,E_h.\n$$\n解出 $E_h$ 和 $E_{h/2}$ 可得\n$$\nE_h \\approx \\frac{16}{15}\\,D,\\qquad E_{h/2} \\approx \\frac{1}{16}\\,E_h \\approx \\frac{1}{15}\\,D.\n$$\n因此，对于加密后的复合 Simpson 近似 $S_{h/2}$，一个一致的局部后验误差估计子是\n$$\n\\eta := \\left|\\frac{1}{15}\\,D\\right| = \\frac{1}{15}\\,\\lvert S_{h/2}-S_h\\rvert.\n$$\n\n假设用户为 $[A,B]$ 上的全积分指定了绝对容差 $\\varepsilon0$。自适应求积的标准容差分配方法会为区间 $\\left[x_0,x_2\\right]$ 分配局部容差\n$$\n\\tau := \\varepsilon\\,\\frac{x_2-x_0}{B-A}.\n$$\n为接受加密后的区间，我们要求估计的加密后误差不超过其局部分配的容差：\n$$\n\\eta \\le \\tau \\quad \\Longleftrightarrow \\quad \\frac{1}{15}\\,\\lvert S_{h/2}-S_h\\rvert \\le \\varepsilon\\,\\frac{x_2-x_0}{B-A}.\n$$\n等价地，这给出了一个形如下式的接受准则\n$$\n\\lvert D\\rvert \\le \\underbrace{15\\,\\varepsilon\\,\\frac{x_2-x_0}{B-A}}_{\\text{threshold}(\\varepsilon,x_2-x_0,B-A)}.\n$$\n\n因此，所要求的显式阈值函数为 $15\\,\\varepsilon\\,\\dfrac{x_2-x_0}{B-A}$。", "answer": "$$\\boxed{15\\,\\varepsilon\\,\\frac{x_2 - x_0}{B - A}}$$", "id": "3426571"}]}