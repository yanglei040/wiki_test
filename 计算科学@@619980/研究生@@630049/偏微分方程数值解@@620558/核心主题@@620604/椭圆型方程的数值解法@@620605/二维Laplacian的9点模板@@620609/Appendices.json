{"hands_on_practices": [{"introduction": "9点格式的优越性不仅在于它使用了更多的邻近点，更关键的是其精心设计的权重可以实现比标准5点格式更高的精度。这个练习将引导你使用泰勒级数展开，从第一性原理出发，推导出在通用矩形网格上逼近拉普拉斯算子的9点格式的权重。通过这个过程，你将理解如何构造一个在$h_x = h_y$的特殊情况下能够为调和函数提供四阶精度的紧致高阶格式，这是数值方法设计中的一项基本功 [@problem_id:3454092]。", "problem": "考虑在间距为 $h_x > 0$ 和 $h_y > 0$ 的矩形笛卡尔网格上近似二维拉普拉斯算子 $\\Delta u = u_{xx} + u_{yy}$。设该近似由一个以网格点 $(x_i,y_j)$ 为中心的对称 $9$ 点格式构成，使用中心点、四个轴向邻点和四个对角邻点的网格值。假设该格式具有以下形式：\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right),\n$$\n其中 $a$、$b_x$、$b_y$ 和 $c$ 是可能依赖于 $h_x$ 和 $h_y$ 但不依赖于 $u$ 的权重。从泰勒级数展开和拉普拉斯算子的定义出发，推导权重 $a$、$b_x$、$b_y$ 和 $c$ 的显式表达式，使得：\n- 对于任意光滑函数 $u$，算子 $\\mathcal{L}_{9}[u]$ 与 $\\Delta u$ 相容（即，在主阶上精确地再现 $\\Delta u$），\n- 对于矩形网格上的一般光滑函数 $u$，截断误差为二阶精度（即 $\\mathcal{O}(h_x^{2} + h_y^{2})$），\n- 当 $h_x = h_y$ 时，主截断误差与 $\\Delta(\\Delta u)$ 成正比，使得离散化对于满足 $\\Delta u = 0$ 的调和函数达到四阶精度。\n\n请按 $(a, b_x, b_y, c)$ 的顺序，将四个不同的权重作为单个解析表达式给出最终答案。不需要数值近似或四舍五入。首次出现时需明确定义您使用的任何缩写，例如，偏微分方程 (Partial Differential Equation, PDE)。", "solution": "所述问题具有科学依据、适定、客观，并包含足够的信息以获得唯一解。这是偏微分方程（PDE）数值方法领域的一个标准问题。因此，该问题是有效的，我将进行完整的推导。\n\n目标是为 $9$ 点格式算子 $\\mathcal{L}_{9}[u]$ 找到权重 $a$、$b_x$、$b_y$ 和 $c$，使其近似二维拉普拉斯算子 $\\Delta u = u_{xx} + u_{yy}$。该格式由下式给出：\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right)\n$$\n为了确定这些权重，我们将每一项 $u_{i+p,j+q}$ 在中心点 $(x_i, y_j) = (i h_x, j h_y)$ 附近展开为泰勒级数，其中 $u_{i,j} = u(x_i, y_j)$。我们假设函数 $u(x,y)$ 足够光滑。在 $(x_i, y_j)$ 处的偏导数用下标表示，例如 $u_{x} = \\frac{\\partial u}{\\partial x}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。\n\n邻点的泰勒级数展开，为该格式分组后如下：\n\\begin{align*}\nu_{i+1,j} + u_{i-1,j} = 2u_{i,j} + h_x^2 u_{xx} + \\frac{h_x^4}{12} u_{xxxx} + \\frac{h_x^6}{360} u_{xxxxxx} + \\mathcal{O}(h_x^8) \\\\\nu_{i,j+1} + u_{i,j-1} = 2u_{i,j} + h_y^2 u_{yy} + \\frac{h_y^4}{12} u_{yyyy} + \\frac{h_y^6}{360} u_{yyyyyy} + \\mathcal{O}(h_y^8)\n\\end{align*}\n对于对角邻点，其和为：\n\\begin{align*}\nu_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} \\\\\n= 4u_{i,j} + 2(h_x^2 u_{xx} + h_y^2 u_{yy}) + \\frac{1}{6}(h_x^4 u_{xxxx} + 6h_x^2 h_y^2 u_{xxyy} + h_y^4 u_{yyyy}) \\\\\n+ \\frac{1}{180}(h_x^6 u_{xxxxxx} + 15h_x^4 h_y^2 u_{xxxxyy} + 15h_x^2 h_y^4 u_{xxyyyy} + h_y^6 u_{yyyyyy}) + \\mathcal{O}(h^8)\n\\end{align*}\n\n将这些展开式代入 $\\mathcal{L}_{9}[u]$ 的表达式中，并按 $u$ 的导数收集项：\n\\begin{align*}\n\\mathcal{L}_{9}[u] = (a + 2b_x + 2b_y + 4c)u_{i,j} \\\\\n+ (b_x h_x^2 + 2c h_x^2)u_{xx} + (b_y h_y^2 + 2c h_y^2)u_{yy} \\\\\n+ \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c(h_x^2 h_y^2)u_{xxyy} \\\\\n+ \\mathcal{O}(h^6)\n\\end{align*}\n\n现在我们施加问题中给出的条件。\n第一个条件是 $\\mathcal{L}_{9}[u]$ 必须与 $\\Delta u = u_{xx} + u_{yy}$ 相容。这意味着 $\\mathcal{L}_{9}[u]$ 展开式中主导导数项的系数必须与 $\\Delta u$ 的系数相匹配，并且低阶项必须为零。\n\\begin{enumerate}\n    \\item $u$ 的系数：$a + 2b_x + 2b_y + 4c = 0$\n    \\item $u_{xx}$ 的系数：$b_x h_x^2 + 2c h_x^2 = 1 \\implies b_x + 2c = \\frac{1}{h_x^2}$\n    \\item $u_{yy}$ 的系数：$b_y h_y^2 + 2c h_y^2 = 1 \\implies b_y + 2c = \\frac{1}{h_y^2}$\n\\end{enumerate}\n这三个方程关联了四个未知权重。我们可以用 $c$ 来表示 $a$、$b_x$ 和 $b_y$：\n由(2)式，$b_x = \\frac{1}{h_x^2} - 2c$。\n由(3)式，$b_y = \\frac{1}{h_y^2} - 2c$。\n将这些代入(1)式：\n$a + 2\\left(\\frac{1}{h_x^2} - 2c\\right) + 2\\left(\\frac{1}{h_y^2} - 2c\\right) + 4c = 0$\n$a + \\frac{2}{h_x^2} - 4c + \\frac{2}{h_y^2} - 4c + 4c = 0$\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c$。\n\n使用这些系数，截断误差 $\\mathcal{T} = \\mathcal{L}_{9}[u] - \\Delta u$ 的主导项由四阶导数给出：\n$\\mathcal{T} = \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)$。\n代入 $b_x$ 和 $b_y$ 的表达式：\n$u_{xxxx}$ 的系数：$\\frac{h_x^4}{12}\\left(\\frac{1}{h_x^2} - 2c\\right) + \\frac{ch_x^4}{6} = \\frac{h_x^2}{12} - \\frac{2ch_x^4}{12} + \\frac{2ch_x^4}{12} = \\frac{h_x^2}{12}$。\n$u_{yyyy}$ 的系数：$\\frac{h_y^4}{12}\\left(\\frac{1}{h_y^2} - 2c\\right) + \\frac{ch_y^4}{6} = \\frac{h_y^2}{12} - \\frac{2ch_y^4}{12} + \\frac{2ch_y^4}{12} = \\frac{h_y^2}{12}$。\n所以，主截断误差为：\n$$\n\\mathcal{T} = \\frac{h_x^2}{12} u_{xxxx} + \\frac{h_y^2}{12} u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)\n$$\n这个误差的阶为 $\\mathcal{O}(h_x^2 + h_y^2)$，满足问题的第二个条件。\n\n第三个条件提供了确定 $c$ 的方法。当 $h_x = h_y = h$ 时，主截断误差必须与施加于 $u$ 的双调和算子 $\\Delta(\\Delta u) = u_{xxxx} + 2u_{xxyy} + u_{yyyy}$ 成正比。\n在 $\\mathcal{T}$ 的表达式中令 $h_x = h_y = h$：\n$$\n\\mathcal{T}|_{h_x=h_y=h} = \\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c(h,h) h^4 u_{xxyy} + \\mathcal{O}(h^4)\n$$\n为了使其与 $\\Delta(\\Delta u)$ 成正比，我们必须有：\n$$\n\\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c h^4 u_{xxyy} = K (u_{xxxx} + 2u_{xxyy} + u_{yyyy})\n$$\n对于某个比例因子 $K$。令偏导数的系数相等：\n- $u_{xxxx}$：$\\frac{h^2}{12} = K$\n- $u_{yyyy}$：$\\frac{h^2}{12} = K$\n- $u_{xxyy}$：$c h^4 = 2K$\n\n从这些关系中，我们发现 $K = \\frac{h^2}{12}$，从而得到 $c h^4 = 2\\left(\\frac{h^2}{12}\\right) = \\frac{h^2}{6}$。这意味着对于方形网格，$c = \\frac{1}{6h^2}$。\n通过这个选择，截断误差变为 $\\mathcal{T}|_h = \\frac{h^2}{12} \\Delta (\\Delta u) + \\mathcal{O}(h^4)$。对于调和函数，其中 $\\Delta u = 0$，可得 $\\Delta(\\Delta u) = \\Delta(0) = 0$。$\\mathcal{O}(h^2)$ 误差项消失，近似达到四阶精度，符合要求。\n\n为了找到对于一般 $h_x, h_y$ 的表达式，我们需要一个 $c(h_x, h_y)$ 的形式，当 $h_x=h_y=h$ 时，该形式能化简为 $c = \\frac{1}{6h^2}$。构造此类高阶格式的一个标准方法是使截断误差具有理想的结构。我们尝试将我们的误差项与拉普拉斯算子高阶导数的紧凑表示相匹配。考虑算子 $(I + \\frac{h_x^2}{12}\\partial_{xx} + \\frac{h_y^2}{12}\\partial_{yy})\\Delta u$：\n$$\n\\left(I + \\frac{h_x^2}{12}\\frac{\\partial^2}{\\partial x^2} + \\frac{h_y^2}{12}\\frac{\\partial^2}{\\partial y^2}\\right)\\Delta u = \\Delta u + \\frac{h_x^2}{12}(u_{xxxx} + u_{xxyy}) + \\frac{h_y^2}{12}(u_{xxyy} + u_{yyyy})\n$$\n这个表达式会要求修改偏微分方程的右侧。我们的格式仅是 $\\Delta u$ 的近似，所以我们需要匹配误差项。\n一个更直接和标准的对 $c$ 的推广方法是要求 $\\mathcal{T}$ 中四阶导数项的系数具有特定比例。选择 $c = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2}$ 可以为截断误差实现一个理想的结构。让我们验证这个选择。\n如果 $h_x=h_y=h$，则 $c = \\frac{h^2+h^2}{12 h^2 h^2} = \\frac{2h^2}{12h^4} = \\frac{1}{6h^2}$。这与我们对方形网格的发现一致。\n因此我们确定 $c$ 的表达式为：\n$$\nc = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2} = \\frac{1}{12}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)\n$$\n现在我们可以找到其他权重的确定表达式：\n$b_x = \\frac{1}{h_x^2} - 2c = \\frac{1}{h_x^2} - \\frac{2(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = \\frac{1}{h_x^2} - \\frac{h_x^2+h_y^2}{6 h_x^2 h_y^2} = \\frac{6h_y^2 - (h_x^2+h_y^2)}{6 h_x^2 h_y^2} = \\frac{5h_y^2 - h_x^2}{6 h_x^2 h_y^2}$。\n这也可以写作 $b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$。\n\n根据对称性，交换 $h_x$ 和 $h_y$：\n$b_y = \\frac{5h_x^2 - h_y^2}{6 h_x^2 h_y^2}$，或 $b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$。\n\n最后，对于 $a$：\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{4(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{h_x^2+h_y^2}{3 h_x^2 h_y^2}$\n将各项通分到公分母 $3h_x^2 h_y^2$ 上：\n$a = \\frac{-6h_y^2 - 6h_x^2 + h_x^2 + h_y^2}{3 h_x^2 h_y^2} = \\frac{-5h_x^2 - 5h_y^2}{3 h_x^2 h_y^2} = -\\frac{5}{3}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)$。\n\n根据问题的约束条件，这四个权重已被唯一确定。\n\n最终的表达式是：\n$a = -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)$\n$b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$\n$b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$\n$c = \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right) & \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2} & \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2} & \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2} \\end{pmatrix}}\n$$", "id": "3454092"}, {"introduction": "理论推导揭示了9点格式的高阶精度，但其在实践中的另一个重要优势是改善了旋转各向同性。连续的拉普拉斯算子是完全旋转不变的，但离散格式会引入依赖于网格方向的误差。本练习要求你通过编写程序，并使用“人造解”方法，来定量地比较5点和9点格式在不同旋转角度下的表现，从而直观地验证9点格式在保持旋转不变性方面的显著改进 [@problem_id:3454095]。", "problem": "考虑由 $\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$ 定义的二维拉普拉斯算子。在一个方形域上，使用间距为 $h$ 的均匀笛卡尔网格，可以用有限差分模板来近似 $\\Delta u$。传统的$5$点模板使用轴对齐的邻点，而旋转改进的$9$点模板则包含了对角邻点。连续的拉普拉斯算子是旋转不变的，这意味着对于任何角度 $\\phi$，$\\Delta u$ 的值仅取决于波矢量的模长，而与其方向无关。离散模板会引入方向各向异性，这可以通过人造解来探测。\n\n仅从拉普拉斯算子的定义、均匀网格上的中心有限差分概念以及网格点周围的泰勒展开出发，推导离散近似：(i) 仅使用轴对齐邻点（$5$点模板），以及 (ii) 同时使用轴对齐和对角邻点（旋转改进的$9$点模板）。然后，使用人造解\n$$\nu(x,y) = \\cos\\!\\left(\\alpha\\,(x\\cos\\phi + y\\sin\\phi)\\right),\n$$\n量化 $\\Delta u$ 的离散近似误差如何依赖于旋转角 $\\phi$，并比较两种模板之间的角度依赖性。连续参考值通过对 $u(x,y)$ 解析地应用 $\\Delta$ 算子得到。\n\n您的程序必须：\n- 在方形域 $[0,1]\\times[0,1]$ 上构建具有 $N\\times N$ 个点和间距 $h = \\frac{1}{N-1}$ 的均匀网格。\n- 对于给定的 $\\alpha$ 和 $\\phi$（角度单位为弧度），计算人造解 $u(x,y)$。\n- 在所有内部点（即具有所有必需邻点的点）上应用两种离散拉普拉斯模板。\n- 计算解析参考值 $\\Delta u$ 和每种模板的误差场。\n- 对于每个测试用例，报告相对 $\\ell^2$误差和相对 $\\ell^\\infty$误差，两者均相对于解析参考值 $\\Delta u$ 的范数定义（即，误差范数与内部网格上参考范数之比）。\n- 此外，报告误差改进因子，定义为$5$点模板误差与$9$点模板误差之比（两种范数均需计算），以量化旋转不变性的相对改进。\n\n角度单位为弧度。不涉及物理单位。\n\n测试套件：\n- 情况 1：$(N,\\alpha,\\phi) = (33,\\,5,\\,0)$。\n- 情况 2：$(N,\\alpha,\\phi) = (33,\\,5,\\,\\pi/4)$。\n- 情况 3：$(N,\\alpha,\\phi) = (33,\\,5,\\,\\pi/2)$。\n- 情况 4：$(N,\\alpha,\\phi) = (33,\\,25,\\,\\pi/4)$。\n- 情况 5：$(N,\\alpha,\\phi) = (65,\\,5,\\,\\pi/8)$。\n- 情况 6：$(N,\\alpha,\\phi) = (65,\\,25,\\,3\\pi/8)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由方括号括起来的、以逗号分隔的各用例结果列表。每个用例的结果本身是一个包含六个浮点数的列表，顺序为\n$[\\text{L2\\_5},\\,\\text{L2\\_9},\\,\\text{Linf\\_5},\\,\\text{Linf\\_9},\\,\\text{L2\\_ratio},\\,\\text{Linf\\_ratio}]$，\n其中 $\\text{L2\\_ratio} = \\text{L2\\_5}/\\text{L2\\_9}$ 且 $\\text{Linf\\_ratio} = \\text{Linf\\_5}/\\text{Linf\\_9}$。例如，整体输出应类似于\n$[[e_{11},e_{12},e_{13},e_{14},e_{15},e_{16}],[e_{21},e_{22},e_{23},e_{24},e_{25},e_{26}],\\dots]$，\n六个用例的顺序与上面列出的完全一致。", "solution": "用户希望我扮演一位严谨的STEM教授。我将首先正式验证问题陈述。\n\n### 步骤1：提取给定信息\n\n- **算子：** 二维拉普拉斯算子，$\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$。\n- **域和网格：** 在方形域 $[0,1] \\times [0,1]$ 上的一个具有 $N \\times N$ 个点的均匀笛卡尔网格。网格间距为 $h = \\frac{1}{N-1}$。\n- **近似模板：**\n    1. 一个仅使用轴对齐邻点的 $5$点模板。\n    2. 一个同时使用轴对齐和对角邻点的旋转改进的 $9$点模板。\n- **推导方法：** 模板需使用中心有限差分和泰勒展开从拉普拉斯算子的定义推导得出。\n- **人造解：** 函数 $u(x,y) = \\cos(\\alpha(x\\cos\\phi + y\\sin\\phi))$ 用于测试模板。$\\phi$ 是以弧度为单位的旋转角。\n- **解析参考值：** 人造解的精确拉普拉斯值 $\\Delta u(x,y)$，通过解析计算得出。\n- **误差度量：** 程序必须为每个模板计算：\n    - 相对 $\\ell^2$误差：$\\|\\Delta_h u - \\Delta u\\|_2 / \\|\\Delta u\\|_2$。\n    - 相对 $\\ell^\\infty$误差：$\\|\\Delta_h u - \\Delta u\\|_\\infty / \\|\\Delta u\\|_\\infty$。\n    - 所有范数均在网格的内部点上计算。\n- **改进因子：** 程序还必须计算：\n    - $\\text{L2\\_ratio} = (5\\text{点模板的相对 } \\ell^2 \\text{ 误差}) / (9\\text{点模板的相对 } \\ell^2 \\text{ 误差})$。\n    - $\\text{Linf\\_ratio} = (5\\text{点模板的相对 } \\ell^\\infty \\text{ 误差}) / (9\\text{点模板的相对 } \\ell^\\infty \\text{ 误差})$。\n- **测试用例：**\n    - 情况 1：$(N,\\alpha,\\phi) = (33,\\,5,\\,0)$。\n    - 情况 2：$(N,\\alpha,\\phi) = (33,\\,5,\\,\\pi/4)$。\n    - 情况 3：$(N,\\alpha,\\phi) = (33,\\,5,\\,\\pi/2)$。\n    - 情况 4：$(N,\\alpha,\\phi) = (33,\\,25,\\,\\pi/4)$。\n    - 情况 5：$(N,\\alpha,\\phi) = (65,\\,5,\\,\\pi/8)$。\n    - 情况 6：$(N,\\alpha,\\phi) = (65,\\,25,\\,3\\pi/8)$。\n- **输出格式：** 一个单行字符串，表示一个列表的列表，其中每个内部列表包含六个浮点数：$[\\text{L2\\_5}, \\text{L2\\_9}, \\text{Linf\\_5}, \\text{Linf\\_9}, \\text{L2\\_ratio}, \\text{Linf\\_ratio}]$。\n\n### 步骤2：使用提取的给定信息进行验证\n\n- **科学上合理：** 该问题牢固地植根于偏微分方程数值分析的经典理论。有限差分、截断误差的泰勒级数分析以及人造解方法都是该领域中标准且基础的技术。\n- **适定性：** 问题定义清晰。从第一性原理推导模板是一个标准的练习。计算任务明确指定了所有必需的参数（$N, \\alpha, \\phi$）、域、分析度量和测试用例。可以确定一组唯一且有意义的数值结果。\n- **客观性：** 语言正式、精确，没有任何主观或模棱两可的术语。所有量和过程都有明确的数学定义。\n\n该问题没有任何缺陷。它在科学上不是不合理的、不可形式化的、不完整的、矛盾的、不切实际的或不适定的。它代表了一个实质性且有启发性的数值方法练习。\n\n### 步骤3：结论与行动\n\n该问题是**有效的**。将提供完整的解决方案。\n\n### 求解与推导\n\n解决方案包括三个主要部分：有限差分模板的推导、人造解的拉普拉斯算子的解析计算，以及数值比较的实现。\n\n**1. 有限差分模板的推导**\n\n我们试图在网格点 $(x_i, y_j)$ 处近似 $\\Delta u = u_{xx} + u_{yy}$，其中 $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$ 且 $u_{yy} = \\frac{\\partial^2 u}{\\partial y^2}$。我们使用 $u$ 在 $(x_i, y_j) \\equiv (i,j)$ 点的泰勒级数展开。\n\n**1.1. 5点模板**\n$u_{xx}$ 的标准二阶中心差分近似由 $u(x_i \\pm h, y_j)$ 的泰勒展开式导出：\n$$u_{i\\pm1, j} = u_{i,j} \\pm h u_x + \\frac{h^2}{2} u_{xx} \\pm \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + O(h^5)$$\n将 $u_{i+1,j}$ 和 $u_{i-1,j}$ 的展开式相加，可以消去奇数阶导数项：\n$$u_{i+1,j} + u_{i-1,j} = 2u_{i,j} + h^2 u_{xx} + \\frac{h^4}{12}u_{xxxx} + O(h^6)$$\n整理后得到 $u_{xx}$：\n$$\\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{(i,j)} = \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} - \\frac{h^2}{12}u_{xxxx} + O(h^4)$$\n对于 $u_{yy}$ 也存在类似的表达式。将它们相加得到5点离散拉普拉斯算子 $\\Delta_5$：\n$$\\Delta_5 u_{i,j} = \\frac{u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4u_{i,j}}{h^2}$$\n该模板对应于系数 $\\frac{1}{h^2}\\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & -4 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$。截断误差 $T_5 = \\Delta_5 u - \\Delta u$ 为：\n$$T_5 = \\frac{h^2}{12}(u_{xxxx} + u_{yyyy}) + O(h^4)$$\n误差项依赖于沿网格轴的四阶导数，使其具有各向异性。\n\n**1.2. 旋转改进的9点模板**\n为了创建一个“旋转改进的”模板，我们引入对角邻点。我们可以定义一个仅使用对角邻点的离散拉普拉斯算子 $\\Delta_\\times$：\n$$S_D = u_{i+1,j+1} + u_{i-1,j+1} + u_{i-1,j-1} + u_{i+1,j-1}$$\n$S_D$ 在 $(i,j)$ 点周围的泰勒展开为：\n$$S_D = 4u_{i,j} + 2h^2(u_{xx} + u_{yy}) + \\frac{h^4}{6}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + O(h^6)$$\n由此，我们定义对角拉普拉斯近似：\n$$\\Delta_\\times u_{i,j} = \\frac{S_D - 4u_{i,j}}{2h^2} = (u_{xx} + u_{yy}) + \\frac{h^2}{12}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + O(h^4)$$\n该对角算子的截断误差为 $T_\\times = \\frac{h^2}{12}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + O(h^4)$。\n\n现在我们构造一个5点（轴对齐）算子和对角算子的线性组合 $\\Delta_9 = A\\Delta_5 + (1-A)\\Delta_\\times$，并选择权重 $A$ 来改善主阶误差项的性质。组合算子的截断误差是：\n$$T_9 = A T_5 + (1-A) T_\\times = \\frac{h^2}{12} \\left[ A(u_{xxxx} + u_{yyyy}) + (1-A)(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) \\right] + O(h^4)$$\n$$T_9 = \\frac{h^2}{12} \\left[ u_{xxxx} + u_{yyyy} + 6(1-A)u_{xxyy} \\right] + O(h^4)$$\n旋转不变的双调和算子是 $\\Delta^2 u = \\Delta(\\Delta u) = u_{xxxx} + 2u_{xxyy} + u_{yyyy}$。为了使主误差项与 $\\Delta^2 u$ 成比例，我们需要 $u_{xxyy}$ 的系数为 $2$。\n$$6(1-A) = 2 \\implies 6 - 6A = 2 \\implies 6A = 4 \\implies A = \\frac{2}{3}$$\n取 $A = 2/3$，9点算子为 $\\Delta_9 = \\frac{2}{3}\\Delta_5 + \\frac{1}{3}\\Delta_\\times$。其截断误差为：\n$$T_9 = \\frac{h^2}{12}(u_{xxxx} + 2u_{xxyy} + u_{yyyy}) + O(h^4) = \\frac{h^2}{12}\\Delta^2 u + O(h^4)$$\n这个误差项在主阶上是各向同性的，因为它依赖于不变算子 $\\Delta^2$。模板的显式形式是：\n$$\\Delta_9 u_{i,j} = \\frac{2}{3} \\left( \\frac{S_A - 4u_{i,j}}{h^2} \\right) + \\frac{1}{3} \\left( \\frac{S_D - 4u_{i,j}}{2h^2} \\right) = \\frac{4(S_A - 4u_{i,j}) + (S_D - 4u_{i,j})}{6h^2}$$\n$$\\Delta_9 u_{i,j} = \\frac{4S_A + S_D - 20u_{i,j}}{6h^2}$$\n其中 $S_A = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}$。这对应于模板系数 $\\frac{1}{6h^2}\\begin{pmatrix} 1 & 4 & 1 \\\\ 4 & -20 & 4 \\\\ 1 & 4 & 1 \\end{pmatrix}$。\n\n**2. 人造解的解析拉普拉斯算子**\n人造解是 $u(x,y) = \\cos(\\alpha(x\\cos\\phi + y\\sin\\phi))$。令 $k_x = \\alpha\\cos\\phi$ 和 $k_y = \\alpha\\sin\\phi$。则函数为 $u(x,y) = \\cos(k_x x + k_y y)$。我们计算其偏导数：\n$$\\frac{\\partial u}{\\partial x} = -k_x \\sin(k_x x + k_y y) \\implies \\frac{\\partial^2 u}{\\partial x^2} = -k_x^2 \\cos(k_x x + k_y y) = -k_x^2 u(x,y)$$\n$$\\frac{\\partial u}{\\partial y} = -k_y \\sin(k_x x + k_y y) \\implies \\frac{\\partial^2 u}{\\partial y^2} = -k_y^2 \\cos(k_x x + k_y y) = -k_y^2 u(x,y)$$\n因此，解析拉普拉斯算子为：\n$$\\Delta u = u_{xx} + u_{yy} = -(k_x^2 + k_y^2)u(x,y)$$\n由于 $k_x^2 + k_y^2 = (\\alpha\\cos\\phi)^2 + (\\alpha\\sin\\phi)^2 = \\alpha^2(\\cos^2\\phi + \\sin^2\\phi) = \\alpha^2$，结果为：\n$$\\Delta u(x,y) = -\\alpha^2 u(x,y)$$\n这证实了 $u(x,y)$ 是连续拉普拉斯算子的一个特征函数，其特征值为 $-\\alpha^2$，该值与角度 $\\phi$ 无关，符合旋转不变性的预期。\n\n**3. 误差分析与实现**\n程序将实现所推导的模板并计算指定的误差范数。对于平面波解 $u(x,y)$，在任何内部点应用离散模板 $\\Delta_h$ 会得到 $u(x,y)$ 的一个倍数，即 $\\Delta_h u = \\lambda_h u$，其中 $\\lambda_h$ 是离散特征值。误差场为 $(\\Delta_h - \\Delta)u = (\\lambda_h - \\lambda)u$。因此，误差的范数与 $|\\lambda_h - \\lambda|$ 成正比。\n- 对于5点模板，特征值的误差为 $\\lambda_5 - \\lambda \\approx \\frac{h^2}{12}(k_x^4 + k_y^4) = \\frac{h^2 \\alpha^4}{12}(\\cos^4\\phi + \\sin^4\\phi)$。\n- 对于9点模板，误差为 $\\lambda_9 - \\lambda \\approx \\frac{h^2}{12}(k_x^2+k_y^2)^2 = \\frac{h^2 \\alpha^4}{12}$。\n\n因此，误差大小之比预计约为 $(\\cos^4\\phi + \\sin^4\\phi)$。该项的值从 $1$（当 $\\phi=0, \\pi/2$ 时）变化到 $1/2$（当 $\\phi=\\pi/4$ 时），这表明5点模板的误差大小具有强烈的各向异性，而9点模板的主误差则不是。数值计算将验证这一行为。", "answer": "```python\nimport numpy as np\n\ndef compute_errors(N, alpha, phi):\n    \"\"\"\n    Computes approximation errors for the 5-point and 9-point Laplacian stencils.\n\n    Args:\n        N (int): Number of grid points in each dimension.\n        alpha (float): Wavenumber of the manufactured solution.\n        phi (float): Rotation angle in radians of the manufactured solution.\n\n    Returns:\n        list: A list containing six floats:\n              [rel_l2_5, rel_l2_9, rel_linf_5, rel_linf_9, l2_ratio, linf_ratio].\n    \"\"\"\n    # 1. Construct grid and evaluate solution\n    h = 1.0 / (N - 1)\n    x = np.linspace(0.0, 1.0, N)\n    xx, yy = np.meshgrid(x, x)\n\n    k_x = alpha * np.cos(phi)\n    k_y = alpha * np.sin(phi)\n\n    u = np.cos(k_x * xx + k_y * yy)\n\n    # 2. Compute analytical Laplacian\n    lap_u_analytical = -alpha**2 * u\n    \n    # 3. Define interior slices for computation\n    # The stencils use neighbors up to (i±1, j±1), so the resulting field\n    # of approximations is defined on an (N-2)x(N-2) grid of interior points.\n    interior_slice = np.s_[1:-1, 1:-1]\n    \n    # 4. Apply the 5-point stencil\n    # Δ_5 u_ij = (u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4u_{i,j}) / h^2\n    lap_u_5pt = (u[2:, 1:-1] + u[:-2, 1:-1] + u[1:-1, 2:] + u[1:-1, :-2] - 4 * u[interior_slice]) / h**2\n\n    # 5. Apply the 9-point stencil\n    # Δ_9 u_ij = (4*S_A + S_D - 20*u_{ij}) / (6*h^2)\n    # S_A is sum of axis-aligned neighbors\n    # S_D is sum of diagonal neighbors\n    \n    # Neighbors aligned to the computation grid for vectorization\n    u_s  = u[ :-2, 1:-1] # South (i-1, j)\n    u_n  = u[2:  , 1:-1] # North (i+1, j)\n    u_w  = u[1:-1,  :-2] # West (i, j-1)\n    u_e  = u[1:-1, 2:  ] # East (i, j+1)\n    \n    u_sw = u[ :-2,  :-2] # South-West (i-1, j-1)\n    u_se = u[ :-2, 2:  ] # South-East (i-1, j+1)\n    u_nw = u[2:  ,  :-2] # North-West (i+1, j-1)\n    u_ne = u[2:  , 2:  ] # North-East (i+1, j+1)\n\n    s_a = u_n + u_s + u_e + u_w\n    s_d = u_ne + u_nw + u_se + u_sw\n    \n    lap_u_9pt = (4 * s_a + s_d - 20 * u[interior_slice]) / (6 * h**2)\n\n    # 6. Compute error fields on the interior\n    lap_u_analytical_interior = lap_u_analytical[interior_slice]\n    error_5 = lap_u_5pt - lap_u_analytical_interior\n    error_9 = lap_u_9pt - lap_u_analytical_interior\n\n    # 7. Compute norms of errors and analytical reference\n    # L2 norm (Frobenius norm for 2D arrays)\n    l2_err_5 = np.linalg.norm(error_5)\n    l2_err_9 = np.linalg.norm(error_9)\n    l2_ref = np.linalg.norm(lap_u_analytical_interior)\n    \n    # L-infinity norm (max absolute value)\n    linf_err_5 = np.linalg.norm(error_5, ord=np.inf)\n    linf_err_9 = np.linalg.norm(error_9, ord=np.inf)\n    linf_ref = np.linalg.norm(lap_u_analytical_interior, ord=np.inf)\n\n    # 8. Compute relative errors\n    rel_l2_5 = l2_err_5 / l2_ref if l2_ref > 0 else 0.0\n    rel_l2_9 = l2_err_9 / l2_ref if l2_ref > 0 else 0.0\n    rel_linf_5 = linf_err_5 / linf_ref if linf_ref > 0 else 0.0\n    rel_linf_9 = linf_err_9 / linf_ref if linf_ref > 0 else 0.0\n\n    # 9. Compute improvement factor ratios\n    l2_ratio = rel_l2_5 / rel_l2_9 if rel_l2_9 > 0 else np.nan\n    linf_ratio = rel_linf_5 / rel_linf_9 if rel_linf_9 > 0 else np.nan\n\n    return [rel_l2_5, rel_l2_9, rel_linf_5, rel_linf_9, l2_ratio, linf_ratio]\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        (33, 5, 0),\n        (33, 5, np.pi / 4),\n        (33, 5, np.pi / 2),\n        (33, 25, np.pi / 4),\n        (65, 5, np.pi / 8),\n        (65, 25, 3 * np.pi / 8),\n    ]\n\n    all_results = []\n    for N, alpha, phi in test_cases:\n        result = compute_errors(N, alpha, phi)\n        all_results.append(result)\n\n    # Format the output as a string representing a list of lists.\n    # e.g., [[val1, val2, ...], [val1, val2, ...]]\n    output_str = \"[\" + \",\".join([str(res) for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3454095"}, {"introduction": "除了精度和各向同性，一个优秀的数值格式还应具备保证解的物理意义的性质，例如单调性，它与离散极值原理密切相关。然而，并非所有满足一致性的格式都是“好”的格式。这个练习将通过一个反例，让你构造一个非单调的9点格式，并展示它如何在一个简单的边值问题中产生非物理的振荡解，这是设计稳健数值方法时必须吸取的重要教训 [@problem_id:3454096]。", "problem": "考虑一族在间距为 $h$ 的均匀笛卡尔网格上的九点有限差分算子，其旨在逼近负二维拉普拉斯算子 $-\\Delta u = -(\\partial_{xx} u + \\partial_{yy} u)$。在内部网格点 $(i,j)$ 处，定义算子\n$$\nA_{h} u_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} \\;-\\; \\alpha\\,[u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}] \\;-\\; \\beta\\,[u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}] \\Big),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是与 $h$ 无关的实常数，且九点模板包括中心节点、四个主方向邻点和四个对角邻点。假设在计算网格的外部边界上施加狄利克雷边界条件，因此边界值是已知的，并在内部节点的离散方程中贡献于右端项。\n\na) 通过在点 $(i,j)$ 附近进行二阶泰勒展开，推导当 $h \\to 0$ 时，为使 $A_{h} u_{i,j}$ 成为 $-\\Delta u(x_{i},y_{j})$ 的一个二阶精度逼近，$\\alpha$、$\\beta$ 和 $\\gamma$ 必须满足的相容性条件。您的推导必须从 $u_{i\\pm 1,j}$、$u_{i,j\\pm 1}$ 和 $u_{i\\pm 1,j\\pm 1}$ 的泰勒展开开始，并系统地消去零阶项以避免伪反应项的贡献。\n\nb) 使用(a)部分中的相容性条件，选择一个特定的对 $(\\alpha,\\beta)$，它满足这些条件但违反了单调性（即产生的刚度矩阵不是一个单调矩阵（M-矩阵））。明确说明为什么您的选择在非对角系数的符号方面是非单调的。然后，在一个 $3\\times 3$ 的网格上（一个内部节点被八个边界节点包围），施加狄利克雷边界数据，将四个角点（对角）边界节点的值设为 $u=1$，并将四个边中点（主方向）边界节点的值设为 $u=0$。考虑齐次方程 $-\\Delta u = 0$，以便唯一的右端项贡献来自于模板中的边界数据。在单个内部节点处计算所得的离散方程，并计算您的非单调九点算子所产生的内部值 $u_{i,j}$。将您的最终答案表示为一个精确的有理数。无需四舍五入。", "solution": "该问题要求推导一族九点有限差分模板的相容性条件，然后使用该族中的一个非单调实例进行特定计算。\n\n**a) 部分：相容性条件**\n\n该算子由下式给出\n$$\nA_{h} u_{i,j} = \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big)\n$$\n其中 $\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}$ 且 $\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}$。令中心点 $(x_i, y_j)$ 表示为 $(x, y)$，并设 $u$ 及其导数均在该点求值。我们对函数 $u$ 在邻近点进行泰勒级数展开。\n\n四个主方向邻点的和为：\n\\begin{align*}\nu(x+h, y) + u(x-h, y) + u(x, y+h) + u(x, y-h) = \\left( u + h u_x + \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n+ \\left( u - h u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n+ \\left( u + h u_y + \\frac{h^2}{2} u_{yy} + \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n+ \\left( u - h u_y + \\frac{h^2}{2} u_{yy} - \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n= 4u + h^2(u_{xx} + u_{yy}) + \\frac{h^4}{12}(u_{xxxx} + u_{yyyy}) + O(h^6)\n\\end{align*}\n由于对称性，奇数阶导数项相互抵消。\n\n四个对角邻点的和 $\\sum_{\\sigma,\\tau \\in \\{-1,1\\}} u(x+\\sigma h, y+\\tau h)$ 也用类似方法展开。一般对角点的泰勒展开为：\n$$\nu(x+\\sigma h, y+\\tau h) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} (\\sigma h \\partial_x + \\tau h \\partial_y)^k u\n$$\n对 $\\sigma, \\tau \\in \\{-1, 1\\}$ 的四种组合求和，会使所有含 $\\sigma$ 或 $\\tau$ 奇次方的项消失。例如，$\\sum \\sigma = 0$, $\\sum \\sigma \\tau = 0$, $\\sum \\sigma^3 = 0$ 等。不为零的和为 $\\sum 1 = 4$, $\\sum \\sigma^2 = 4$, $\\sum \\tau^2 = 4$, $\\sum \\sigma^2 \\tau^2 = 4$, $\\sum \\sigma^4 = 4$, $\\sum \\tau^4 = 4$。\n该和的展开式为：\n\\begin{align*}\n\\sum_{\\sigma,\\tau} u(x+\\sigma h, y+\\tau h) = 4u + \\frac{h^2}{2!} \\sum_{\\sigma,\\tau} (\\sigma^2 u_{xx} + 2\\sigma\\tau u_{xy} + \\tau^2 u_{yy}) \\\\\n\\quad + \\frac{h^4}{4!} \\sum_{\\sigma,\\tau} (\\sigma^4 u_{xxxx} + 4\\sigma^3\\tau u_{xxxy} + 6\\sigma^2\\tau^2 u_{xxyy} + 4\\sigma\\tau^3 u_{xyyy} + \\tau^4 u_{yyyy}) + O(h^6) \\\\\n= 4u + \\frac{h^2}{2} (4u_{xx} + 4u_{yy}) + \\frac{h^4}{24} (4u_{xxxx} + 24u_{xxyy} + 4u_{yyyy}) + O(h^6) \\\\\n= 4u + 2h^2(u_{xx} + u_{yy}) + \\frac{h^4}{6}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + O(h^6)\n\\end{align*}\n\n现在，我们将这些和代入 $A_h u_{i,j}$ 的表达式中：\n\\begin{align*}\nh^2 A_h u_{i,j} = \\gamma u - \\alpha \\left[ 4u + h^2(u_{xx} + u_{yy}) + O(h^4) \\right] - \\beta \\left[ 4u + 2h^2(u_{xx} + u_{yy}) + O(h^4) \\right] \\\\\n= (\\gamma - 4\\alpha - 4\\beta)u - (\\alpha + 2\\beta)h^2(u_{xx} + u_{yy}) - (\\text{terms of order } h^4 \\text{ and higher})\n\\end{align*}\n除以 $h^2$，我们得到：\n$$\nA_h u_{i,j} = \\frac{\\gamma - 4\\alpha - 4\\beta}{h^2}u - (\\alpha + 2\\beta)(u_{xx} + u_{yy}) + O(h^2)\n$$\n为使 $A_h u_{i,j}$ 成为 $-\\Delta u = -(u_{xx} + u_{yy})$ 的一个相容逼近，必须满足以下条件：\n1.  $u$ 的零阶项系数必须为零。这可以防止出现伪反应项，并且是相容性的要求。\n$$\n\\gamma - 4\\alpha - 4\\beta = 0 \\implies \\gamma = 4(\\alpha + \\beta)\n$$\n2.  拉普拉斯项 $(u_{xx} + u_{yy})$ 的系数必须是 $-1$。\n$$\n-(\\alpha + 2\\beta) = -1 \\implies \\alpha + 2\\beta = 1\n$$\n这两个方程是该算子成为 $-\\Delta u$ 的二阶精度逼近的相容性条件。\n\n**b) 部分：非单调算子与计算**\n\n由此有限差分算子产生的刚度矩阵是单调的（一个M-矩阵），如果其对角线元素为正，且所有非对角线元素为非正。在对应于节点 $(i,j)$ 的矩阵行中，乘以 $u_{k,l}$ 的项是 $A_{h} u_{i,j}$ 表达式中 $u_{k,l}$ 的系数。\n- $u_{i,j}$ 的系数（对角元）是 $\\frac{\\gamma}{h^2}$。\n- 主方向邻点的系数（非对角元）是 $-\\frac{\\alpha}{h^2}$。\n- 对角邻点的系数（非对角元）是 $-\\frac{\\beta}{h^2}$。\n\n为满足单调性，我们要求非对角元非正，即 $-\\frac{\\alpha}{h^2} \\le 0$ 和 $-\\frac{\\beta}{h^2} \\le 0$。这意味着 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$。违反其中任一条件都会使格式非单调。\n\n我们需要选择一对 $(\\alpha, \\beta)$，它满足相容性条件 $\\alpha + 2\\beta = 1$ 但违反单调性。我们选择一个负的 $\\beta$ 值。一个简单的选择是 $\\beta = -1/2$。\n将其代入相容性条件：\n$$\n\\alpha + 2(-\\frac{1}{2}) = 1 \\implies \\alpha - 1 = 1 \\implies \\alpha = 2\n$$\n这得到一对 $(\\alpha, \\beta) = (2, -1/2)$。这对参数满足 $\\alpha+2\\beta = 1$。由于 $\\beta = -1/2  0$，单调性条件被违反。与对角邻点对应的非对角矩阵项为 $-\\beta/h^2 = -(-1/2)/h^2 = 1/(2h^2) > 0$。\n\n现在我们用第一个相容性条件来求 $\\gamma$：\n$$\n\\gamma = 4(\\alpha + \\beta) = 4(2 - \\frac{1}{2}) = 4(\\frac{3}{2}) = 6\n$$\n因此，我们的非单调算子由参数 $\\alpha=2$, $\\beta=-1/2$, 和 $\\gamma=6$ 定义。\n\n现在我们考虑一个只有一个内部节点 $(i,j)$ 的 $3 \\times 3$ 网格。离散方程为 $A_h u_{i,j} = 0$，因为我们正在逼近 $-\\Delta u = 0$。\n$$\n\\frac{1}{h^2}\\Big( \\gamma u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big) = 0\n$$\n两边乘以 $h^2$ 并解出 $u_{i,j}$：\n$$\n\\gamma u_{i,j} = \\alpha \\sum_{\\text{cardinal}} u + \\beta \\sum_{\\text{diagonal}} u\n$$\n边界条件为四个主方向邻点处 $u=0$，四个对角邻点处 $u=1$。\n因此，各项和为：\n$$\n\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} = 0 + 0 + 0 + 0 = 0\n$$\n$$\n\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} = 1 + 1 + 1 + 1 = 4\n$$\n将这些值和参数 $\\alpha=2, \\beta=-1/2, \\gamma=6$ 代入 $u_{i,j}$ 的方程中：\n$$\n6 \\, u_{i,j} = (2)(0) + (-\\frac{1}{2})(4)\n$$\n$$\n6 \\, u_{i,j} = 0 - 2 = -2\n$$\n$$\nu_{i,j} = \\frac{-2}{6} = -\\frac{1}{3}\n$$\n内部值为 $-1/3$。这个结果超出了边界数据的值域 $[0,1]$，这表明离散极值原理被违反了，这是算子非单调性的直接后果。", "answer": "$$\n\\boxed{-\\frac{1}{3}}\n$$", "id": "3454096"}]}