{"hands_on_practices": [{"introduction": "尽管全隐式格式在稳定性方面表现出色，但在处理包含不同物理过程（如对流和扩散）的方程时，混合使用隐式和显式处理（即IMEX格式）通常更高效。本练习将引导你分析一种常见的IMEX格式，它对扩散项使用隐式处理，而对对流项使用显式处理。通过执行冯·诺伊曼稳定性分析，你将亲手推导该格式的放大因子，并确定其稳定性条件。这项实践的核心价值在于揭示了即使方程中的一部分被隐式处理，显式处理另一部分仍可能引入稳定性约束，这对于理解和设计复杂问题的高效数值格式至关重要 [@problem_id:3406598]。", "problem": "考虑标量场 $u(x,t)$ 在周期性空间域 $x \\in [0,L]$ 上的线性平流扩散方程 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，扩散系数 $\\nu \\ge 0$。设空间网格是均匀的，间距为 $h = L/N$，网格点为 $x_{j} = jh$（其中 $j$ 为整数），并考虑离散时间层 $t^{n} = n\\,\\Delta t$。定义二阶中心有限差分算子\n- 一阶导数 $D_{0}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$，\n- 二阶导数 $D_{2}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$。\n研究隐式-显式（IMEX）时间离散格式，该格式用前向欧拉法显式处理平流项，用后向欧拉法隐式处理扩散项：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} \\;=\\; \\nu\\,D_{2}u_{j}^{n+1}.\n$$\n假设空间周期性，并通过代入单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ 进行冯·诺依曼傅里叶分析，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数。引入无量纲平流库朗数 $c = \\dfrac{a\\,\\Delta t}{h}$ 和扩散数 $r = \\dfrac{\\nu\\,\\Delta t}{h^{2}}$。推导由 $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$ 定义的放大因子 $G_{\\text{IMEX}}(\\theta)$ 的封闭形式表达式。然后，通过对所有 $\\theta \\in [-\\pi,\\pi]$ 施加冯·诺依曼稳定性条件 $|G_{\\text{IMEX}}(\\theta)| \\le 1$，确定能保证所有傅里叶模态稳定性的最小非负扩散数 $r$ 作为 $c$ 的函数。将结果与在上述 IMEX 方法中令 $a = 0$ 得到的纯隐式扩散格式进行定性比较。\n\n最终答案请提供最小扩散数作为 $c$ 的函数（记为 $r_{\\min}(c)$）的精确封闭形式表达式。不需要进行数值近似，最终答案中也无需报告单位。", "solution": "该问题要求对线性平流扩散方程的隐式-显式（IMEX）时间离散格式进行分析。分析将分三步进行：首先，使用冯·诺依曼分析法推导放大因子；其次，确定稳定性条件和最小扩散数 $r_{\\min}(c)$；最后，与纯隐式格式进行定性比较。\n\n一维平流扩散方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx}\n$$\n其中 $u(x,t)$ 是标量场，$a$ 是平流速度，$\\nu$ 是扩散系数。空间域是周期性的。\n\n该问题定义了一种空间半离散格式，对一阶和二阶导数均使用二阶中心有限差分。IMEX 时间步进格式用前向欧拉法显式处理平流项，用后向欧拉法隐式处理扩散项：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} = \\nu\\,D_{2}u_{j}^{n+1}\n$$\n此处，$u_j^n \\approx u(x_j, t^n)$，$\\Delta t$ 是时间步长，差分算子定义为 $D_{0}u_{j}^{n} = \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$ 和 $D_{2}u_{j}^{n} = \\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$。\n\n为了进行冯·诺依曼稳定性分析，我们将单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ 代入格式中，其中 $\\theta = k h$ 是对应于波数 $k$ 的无量纲波数。放大因子由关系式 $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$ 定义。\n\n首先，我们求出作用于该模态的差分算子的傅里叶表示：\n$$\nD_{0}u_{j}^{n} = \\frac{\\hat{u}^{n}\\exp(i(j+1)\\theta) - \\hat{u}^{n}\\exp(i(j-1)\\theta)}{2h} = \\frac{\\hat{u}^{n}\\exp(ij\\theta)}{2h}(\\exp(i\\theta) - \\exp(-i\\theta)) = \\frac{2i\\sin(\\theta)}{2h}\\hat{u}^{n}\\exp(ij\\theta) = \\frac{i\\sin(\\theta)}{h}u_{j}^{n}\n$$\n$$\nD_{2}u_{j}^{n+1} = \\frac{\\hat{u}^{n+1}\\exp(i(j+1)\\theta) - 2\\hat{u}^{n+1}\\exp(ij\\theta) + \\hat{u}^{n+1}\\exp(i(j-1)\\theta)}{h^2} = \\frac{\\hat{u}^{n+1}\\exp(ij\\theta)}{h^2}(\\exp(i\\theta) - 2 + \\exp(-i\\theta))\n$$\n使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，上式可简化为：\n$$\nD_{2}u_{j}^{n+1} = \\frac{2\\cos(\\theta) - 2}{h^2}\\hat{u}^{n+1}\\exp(ij\\theta) = \\frac{-2(1-\\cos(\\theta))}{h^2}u_{j}^{n+1}\n$$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nD_{2}u_{j}^{n+1} = \\frac{-4\\sin^2(\\theta/2)}{h^2}u_{j}^{n+1}\n$$\n将这些表达式代入 IMEX 格式，并消去公因子 $\\exp(ij\\theta)$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n}}{\\Delta t} + a\\left(\\frac{i\\sin(\\theta)}{h}\\right)\\hat{u}^{n} = \\nu\\left(\\frac{-4\\sin^2(\\theta/2)}{h^2}\\right)\\hat{u}^{n+1}\n$$\n整理各项，将 $\\hat{u}^{n+1}$ 和 $\\hat{u}^{n}$ 分别组合在一起：\n$$\n\\hat{u}^{n+1}\\left(\\frac{1}{\\Delta t} + \\nu\\frac{4\\sin^2(\\theta/2)}{h^2}\\right) = \\hat{u}^{n}\\left(\\frac{1}{\\Delta t} - a\\frac{i\\sin(\\theta)}{h}\\right)\n$$\n整个方程乘以 $\\Delta t$：\n$$\n\\hat{u}^{n+1}\\left(1 + \\frac{4\\nu\\Delta t}{h^2}\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}\\left(1 - i\\frac{a\\Delta t}{h}\\sin(\\theta)\\right)\n$$\n引入无量纲库朗数 $c = \\frac{a\\Delta t}{h}$ 和扩散数 $r = \\frac{\\nu\\Delta t}{h^2}$：\n$$\n\\hat{u}^{n+1}\\left(1 + 4r\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}(1 - ic\\sin(\\theta))\n$$\n因此，放大因子 $G_{\\text{IMEX}}(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$ 为：\n$$\nG_{\\text{IMEX}}(\\theta) = \\frac{1 - ic\\sin(\\theta)}{1 + 4r\\sin^2(\\theta/2)}\n$$\n冯·诺依曼稳定性条件要求对所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G_{\\text{IMEX}}(\\theta)| \\le 1$。我们分析其模的平方：\n$$\n|G_{\\text{IMEX}}(\\theta)|^2 = \\frac{|1 - ic\\sin(\\theta)|^2}{|1 + 4r\\sin^2(\\theta/2)|^2} = \\frac{1^2 + (-c\\sin(\\theta))^2}{(1 + 4r\\sin^2(\\theta/2))^2} = \\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2}\n$$\n稳定性条件变为：\n$$\n\\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2} \\le 1\n$$\n由于分母是实数且为正（对于 $r \\ge 0$），我们可以将其乘到不等式右边得到：\n$$\n1 + c^2\\sin^2(\\theta) \\le \\left(1 + 4r\\sin^2(\\theta/2)\\right)^2 = 1 + 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n两边减去 $1$ 得到：\n$$\nc^2\\sin^2(\\theta) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n使用倍角恒等式 $\\sin(\\theta) = 2\\sin(\\theta/2)\\cos(\\theta/2)$：\n$$\nc^2\\left(4\\sin^2(\\theta/2)\\cos^2(\\theta/2)\\right) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n如果 $\\sin(\\theta/2) = 0$（即 $\\theta=0$），不等式为 $0 \\le 0$，恒成立。对于 $\\sin(\\theta/2) \\neq 0$ 的情况，我们可以用正量 $4\\sin^2(\\theta/2)$ 去除不等式两边：\n$$\nc^2\\cos^2(\\theta/2) \\le 2r + 4r^2\\sin^2(\\theta/2)\n$$\n为了找到对 $r$ 最严格的条件，令 $S = \\sin^2(\\theta/2)$。当 $\\theta$ 遍历 $[-\\pi, \\pi]$ 时，$S$ 遍历 $[0, 1]$。使用 $\\cos^2(\\theta/2) = 1 - S$，不等式变为：\n$$\nc^2(1 - S) \\le 2r + 4r^2S\n$$\n这个不等式必须对所有 $S \\in [0, 1]$ 都成立。我们整理各项以分离出 $S$：\n$$\nc^2 - 2r \\le c^2S + 4r^2S = (c^2 + 4r^2)S\n$$\n我们定义一个函数 $F(S) = (c^2 + 4r^2)S - (c^2 - 2r)$。我们需要对所有 $S \\in [0, 1]$ 都有 $F(S) \\ge 0$。$S$ 的系数 $m = c^2 + 4r^2$ 代表了这个关于 $S$ 的线性函数的斜率。由于 $r \\ge 0$，斜率 $m$ 总是非负的。\n对于区间上的一个非减线性函数，其最小值在区间的左端点处取得。因此，要确保对所有 $S \\in [0, 1]$ 都有 $F(S) \\ge 0$，我们只需在 $S=0$ 处施加该条件：\n$$\nF(0) \\ge 0 \\implies (c^2+4r^2)(0) - (c^2 - 2r) \\ge 0\n$$\n$$\n-(c^2 - 2r) \\ge 0 \\implies 2r - c^2 \\ge 0\n$$\n这给出了稳定性条件：\n$$\nr \\ge \\frac{c^2}{2}\n$$\n因此，对于任意给定的库朗数 $c$，保证稳定性的最小非负扩散数是 $r_{\\min}(c) = \\frac{c^2}{2}$。\n\n为了进行定性比较，考虑纯隐式扩散格式，它对应于在 IMEX 方法中设置 $a=0$。如果 $a=0$，则库朗数 $c=0$。放大因子变为：\n$$\nG_{\\text{diffusion}}(\\theta) = G_{\\text{IMEX}}(\\theta)|_{c=0} = \\frac{1}{1 + 4r\\sin^2(\\theta/2)}\n$$\n由于 $r \\ge 0$ 且 $\\sin^2(\\theta/2) \\ge 0$，分母总是大于或等于 1。因此，对所有 $\\theta$ 和任意 $r \\ge 0$，都有 $|G_{\\text{diffusion}}(\\theta)| \\le 1$。这意味着扩散方程的纯隐式离散（时间后向差分，空间中心差分，BTCS）是无条件稳定的。\n\n相比之下，IMEX 格式只是条件稳定的。对平流项的显式处理引入了不稳定的可能性。在傅里叶空间中，平流项的前向欧拉离散贡献了因子 $1 - ic\\sin(\\theta)$，其模为 $\\sqrt{1+c^2\\sin^2\\theta} \\ge 1$。仅此一项就会导致无条件不稳定。对扩散项的隐式处理提供了一个阻尼因子 $(1 + 4r\\sin^2(\\theta/2))^{-1}$。稳定性条件 $r \\ge c^2/2$ 量化了为抵消由显式平流（由 $c$ 度量）引起的放大效应所需的最小隐式扩散量（由 $r$ 度量），以确保净放大因子的模不超过 1。该条件可以用物理参数改写为 $\\frac{\\nu\\Delta t}{h^2} \\ge \\frac{1}{2}(\\frac{a\\Delta t}{h})^2$，简化后为 $\\Delta t \\le \\frac{2\\nu}{a^2}$。这是一个依赖于物理系数的时间步长限制，是显式或部分显式方法的一个标志。", "answer": "$$\n\\boxed{\\frac{c^{2}}{2}}\n$$", "id": "3406598"}, {"introduction": "在确保数值格式稳定之后，下一个关键问题是精度和效率。一个理想的数值方法应该在时间和空间离散误差之间取得平衡，以避免某一种误差占据主导，从而浪费计算资源。本练习将指导你通过渐近误差分析，为热方程的一个标准隐式格式推导时间步长 $\\Delta t$ 和空间步长 $h$ 之间的最优缩放关系。通过要求主导时间误差和空间误差分量的大小相等，你将确定一个使误差均衡的精确常数，这一过程对于掌握如何为实现高效计算而进行参数选择至关重要 [@problem_id:3406599]。", "problem": "考虑空间区间 $[0,1]$ 上的齐次一维热偏微分方程 (PDE) $u_{t}=\\kappa u_{xx}$，其具有齐次狄利克雷边界条件和光滑初始数据 $u(x,0)=\\sin(\\pi x)$。设其精确解为 $u(x,t)=\\sin(\\pi x)\\exp(-\\kappa \\pi^{2} t)$，适用于任何 $t \\ge 0$。使用网格尺寸为 $h$ 的均匀网格对空间域进行离散化，并使用标准的二阶中心有限差分算子来近似 $u_{xx}$。使用时间步长为 $\\Delta t$ 的全隐式后向欧拉法，将时间推进到一个固定的时间范围 $T>0$。关注与 $\\sin(\\pi x)$ 相关的单个离散傅里叶正弦模态，并假设其光滑性足以支持关于该模态的泰勒展开和线性化。\n\n从该模态的离散拉普拉斯特征值以及由线方法产生的相应线性常微分方程的后向欧拉放大因子的定义出发，推导在时间 $T$ 的全局逐点误差的主阶渐近模型，该模型为一个与 $\\Delta t$ 成正比的时间项贡献和一个与 $h^{2}$ 成正比的空间项贡献之和。仅使用第一性原理，例如 $\\ln(1+z)$ 和 $\\sin(z)$ 的泰勒级数，以及特征模态的精确解形式。然后，通过强制实施尺度关系 $\\Delta t=C h^{2}$ 并要求主阶时间和空间误差贡献的量值相等（以平衡误差），确定常数 $C$ 作为一个以 $\\kappa$ 表示的闭式表达式。\n\n你的最终答案必须是 $C$ 的显式表达式。不要提供不等式或方程。不需要进行数值四舍五入。", "solution": "该问题要求在尺度关系 $\\Delta t = C h^{2}$ 下，为热方程的数值解平衡主阶时间和空间误差的常数 $C$。求解过程需要对全局误差进行仔细的渐近分析。\n\n控制偏微分方程 (PDE) 是一维热方程：\n$$u_{t} = \\kappa u_{xx}$$\n在定义域 $x \\in [0, 1]$ 上，具有齐次狄利克雷边界条件 $u(0, t) = u(1, t) = 0$ 和初始条件 $u(x, 0) = \\sin(\\pi x)$。该初值问题的精确解为 $u(x, t) = \\sin(\\pi x) \\exp(-\\kappa \\pi^{2} t)$。\n\n首先，我们使用均匀网格 $x_j = j h$（其中 $j = 0, 1, \\dots, N$，$h = 1/N$）对空间域进行离散化。在 $x_j$ 处的空间二阶导数 $u_{xx}$ 由二阶标准中心有限差分算子近似：\n$$u_{xx}(x_j, t) \\approx \\frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{h^2}$$\n将此应用于该偏微分方程，得到一个常微分方程组 (ODEs)，这种技术被称为线方法。设 $u_j(t)$ 是 $u(x_j, t)$ 的近似。半离散化系统为：\n$$\\frac{du_j}{dt} = \\kappa \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}$$\n初始条件 $\\sin(\\pi x)$ 是连续拉普拉斯算子的一个特征函数。其离散对应项 $v_j = \\sin(\\pi x_j) = \\sin(j \\pi h)$ 是离散拉普拉斯矩阵的一个特征向量。我们来求其对应的特征值，记为 $\\lambda_h$。\n将离散算子应用于 $v_j$：\n$$\\frac{v_{j+1} - 2v_j + v_{j-1}}{h^2} = \\frac{\\sin((j+1)\\pi h) - 2\\sin(j\\pi h) + \\sin((j-1)\\pi h)}{h^2}$$\n使用三角恒等式 $\\sin(A+B) + \\sin(A-B) = 2\\sin(A)\\cos(B)$，我们得到：\n$$\\frac{2\\sin(j\\pi h)\\cos(\\pi h) - 2\\sin(j\\pi h)}{h^2} = \\left(\\frac{2(\\cos(\\pi h) - 1)}{h^2}\\right) \\sin(j\\pi h)$$\n因此，特征值为 $\\lambda_h = \\frac{2(\\cos(\\pi h) - 1)}{h^2}$。\n该模态的振幅（我们称之为 $U(t)$）所满足的常微分方程变为 $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$。\n\n接下来，我们分析由这种空间离散化引入的误差。我们将 $\\lambda_h$ 按 $h$ 展开为泰勒级数。使用 $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - O(z^6)$ 的级数展开式：\n$$\\lambda_h = \\frac{2}{h^2} \\left( \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - O(h^6)\\right) - 1 \\right) = \\frac{2}{h^2} \\left( -\\frac{\\pi^2 h^2}{2} + \\frac{\\pi^4 h^4}{24} - O(h^6) \\right)$$\n$$\\lambda_h = -\\pi^2 + \\frac{\\pi^4 h^2}{12} - O(h^4)$$\n对于模态 $\\sin(\\pi x)$，连续算子 $-\\frac{\\partial^2}{\\partial x^2}$ 的特征值是 $\\pi^2$，因此 $u_{xx}$ 的特征值是 $-\\pi^2$。空间离散化引入的误差为 $\\lambda_h - (-\\pi^2) \\approx \\frac{\\pi^4 h^2}{12}$。\n\n现在，我们对常微分方程 $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$ 应用时间步长为 $\\Delta t$ 的全隐式后向欧拉法。设 $U^n$ 是 $U(n\\Delta t)$ 的近似值。\n$$\\frac{U^{n+1} - U^n}{\\Delta t} = \\kappa \\lambda_h U^{n+1}$$\n解出 $U^{n+1}$，我们得到 $U^{n+1} = \\frac{1}{1 - \\kappa \\lambda_h \\Delta t} U^n$。一个时间步长的放大因子是 $g_{BE} = (1 - \\kappa \\lambda_h \\Delta t)^{-1}$。\n经过 $n_{steps} = T/\\Delta t$ 步后，时间 $T$ 时振幅的数值解为 $U(T) \\approx (g_{BE})^{T/\\Delta t} U(0)$。\n\n在时间 $T$ 时，精确解的振幅是 $\\exp(-\\kappa \\pi^2 T)$。\n数值解的振幅是 $( (1 - \\kappa \\lambda_h \\Delta t)^{-1} )^{T/\\Delta t}$。\n为了分析误差，我们比较这两个量的对数。\n精确振幅因子的对数是 $-\\kappa \\pi^2 T$。\n数值振幅因子的对数是：\n$$ \\ln\\left( (g_{BE})^{T/\\Delta t} \\right) = \\frac{T}{\\Delta t} \\ln(g_{BE}) = -\\frac{T}{\\Delta t} \\ln(1 - \\kappa \\lambda_h \\Delta t)$$\n使用泰勒级数 $\\ln(1-z) = -z - \\frac{z^2}{2} - O(z^3)$，其中 $z = \\kappa \\lambda_h \\Delta t$：\n$$-\\frac{T}{\\Delta t} \\left( -(\\kappa \\lambda_h \\Delta t) - \\frac{(\\kappa \\lambda_h \\Delta t)^2}{2} - O((\\Delta t)^3) \\right) = T \\kappa \\lambda_h + \\frac{T}{2} (\\kappa \\lambda_h)^2 \\Delta t + O((\\Delta t)^2)$$\n现在我们代入 $\\lambda_h$ 的展开式：\n$$T \\kappa \\left(-\\pi^2 + \\frac{\\pi^4 h^2}{12} + O(h^4)\\right) + \\frac{T}{2} \\left(\\kappa \\left(-\\pi^2 + O(h^2)\\right)\\right)^2 \\Delta t + O((\\Delta t)^2)$$\n$$ = -T \\kappa \\pi^2 + T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t + \\text{h.o.t.}$$\n精确振幅的对数是 $-T \\kappa \\pi^2$。振幅对数的误差是其差值：\n$$\\text{Error}_{\\ln} \\approx \\left( T \\kappa \\frac{\\pi^4 h^2}{12} \\right) + \\left( \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\n与 $h^2$ 成正比的项源于空间离散化，与 $\\Delta t$ 成正比的项源于时间离散化。\n\n在时间 $T$ 的全局逐点误差是 $E_j(T) = u(x_j, T) - u_j^N$，其中 $N=T/\\Delta t$。\n$$E_j(T) = \\sin(\\pi x_j) \\left( \\exp(-\\kappa \\pi^2 T) - \\left(g_{BE}\\right)^{T/\\Delta t} \\right)$$\n设 $A_{exact} = \\exp(-\\kappa \\pi^2 T)$ 和 $A_{num} = (g_{BE})^{T/\\Delta t}$。我们有 $\\ln(A_{num}) \\approx \\ln(A_{exact}) + \\text{Error}_{\\ln}$。\n因此 $A_{num} \\approx A_{exact} \\exp(\\text{Error}_{\\ln})$。对于小误差，$\\exp(\\text{Error}_{\\ln}) \\approx 1 + \\text{Error}_{\\ln}$。\n所以 $A_{num} \\approx A_{exact} (1 + \\text{Error}_{\\ln})$。\n振幅的误差是 $A_{exact} - A_{num} \\approx -A_{exact} \\cdot \\text{Error}_{\\ln}$。\n逐点误差是：\n$$E_j(T) \\approx -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\left( T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\n这给出了全局误差的主阶渐近模型。括号中的第一项是空间误差贡献，第二项是时间误差贡献。\n\n问题要求平衡这两个贡献的量值。\n$$ \\left| \\text{空间贡献} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} \\right| $$\n$$ \\left| \\text{时间贡献} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right| $$\n假设 $x_j \\in (0,1)$，$T>0$，$\\kappa>0$，我们可以令其正数部分相等：\n$$ \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} = \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t $$\n消去两边公因子（非零）：\n$$ \\kappa \\frac{\\pi^4 h^2}{12} = \\frac{\\kappa^2 \\pi^4 \\Delta t}{2} $$\n进一步通过消去 $\\kappa$ 和 $\\pi^4$ 来简化：\n$$ \\frac{h^2}{12} = \\frac{\\kappa \\Delta t}{2} $$\n问题强制实施尺度关系 $\\Delta t = C h^2$。将其代入方程中：\n$$ \\frac{h^2}{12} = \\frac{\\kappa (C h^2)}{2} $$\n我们从两边消去 $h^2$（因为 $h \\neq 0$）：\n$$ \\frac{1}{12} = \\frac{\\kappa C}{2} $$\n最后，我们求解常数 $C$：\n$$ \\kappa C = \\frac{2}{12} = \\frac{1}{6} $$\n$$ C = \\frac{1}{6\\kappa} $$\n这个 $C$ 值平衡了给定数值方案和问题的主阶空间和时间截断误差。", "answer": "$$\\boxed{\\frac{1}{6\\kappa}}$$", "id": "3406599"}, {"introduction": "理论精度高的格式在面对非光滑初始数据时，有时会产生非物理的振荡，这是一个常见的实际挑战。例如，二阶精度的Crank-Nicolson格式就存在这个问题，因为它无法有效衰减初始误差中的高频成分。本练习探讨一种巧妙的“启动”策略：先用几步具有强耗散特性（L-稳定性）的一阶向后欧拉法来平滑初始解，然后切换到高精度的Crank-Nicolson法（A-稳定性）进行后续计算。通过分析这种变格式策略，你将深入理解不同隐式格式的阻尼特性，并学会如何设计鲁棒且高精度的算法来解决实际工程与科学计算中的难题 [@problem_id:3406590]。", "problem": "考虑一维热方程，这是一个典型的抛物型偏微分方程（PDE），\n$$\nu_t = \\nu u_{xx}, \\quad x \\in (0,1), \\quad t>0,\n$$\n其边界条件为齐次狄利克雷边界条件，初始数据 $u(x,0)=u_0(x)$ 是平方可积但不一定光滑的。设在空间上使用标准的二阶中心有限差分法（FDM），网格为均匀网格，网格尺寸为 $h$，得到半离散常微分方程（ODE）\n$$\n\\frac{d}{dt} \\mathbf{u}(t) = A \\mathbf{u}(t),\n$$\n其中 $A$ 是从带有狄利克雷边界条件的拉普拉斯算子得到的刚度矩阵，该矩阵是对称负定的，其特征值 $\\lambda_j  0$ 的量级为 $|\\lambda_j| = \\mathcal{O}(h^{-2})$。考虑在时间上使用 $\\theta$ 方法，时间步长为均匀的 $\\Delta t$，\n$$\n\\left(I - \\theta \\,\\Delta t \\, A\\right)\\mathbf{u}^{n+1} = \\left(I + (1-\\theta)\\,\\Delta t \\, A\\right)\\mathbf{u}^{n},\n$$\n并将其应用于该半离散系统。我们研究一种可变$\\theta$策略：前 $m$ 步取 $\\theta=1$（全隐式向后欧拉法），之后的所有步数取 $\\theta=1/2$（Crank–Nicolson方法）。假设 $m$ 是一个与 $\\Delta t$ 和 $h$ 无关的固定整数，并且精确解的抛物平滑特性使得当 $t0$ 时 $u(\\cdot,t)$ 在空间上是光滑的。\n\n使用标量测试方程 $y'(t)=\\lambda y(t)$（其中 $\\lambda0$）来表示单个刚性模式，并利用抛物半群 $e^{tA}$ 的经典平滑性质，分析这种可变$\\theta$策略如何影响：\n- 对由非光滑初始数据产生的初始高频分量（初始层）的阻尼，以及\n- 在固定的最终时间 $T0$ 时，该方法的整体时间精度。\n\n在这些假设下，以下哪个陈述最为准确？\n\nA. 固定数量的初始向后欧拉步（$\\theta=1$）能强力阻尼与大的负特征值相关的高频分量，而随后的Crank–Nicolson步（$\\theta=1/2$）在解变得光滑后，在时间 $t=T$ 处能产生二阶时间精度；因此，该组合策略既能阻尼初始层，又能保持二阶精度。\n\nB. 因为向后欧拉法只有一阶精度，所以在开始时使用任何次数的 $\\theta=1$ 都会迫使整个计算在时间 $t=T$ 处的全局精度为一阶，无论之后采取了多少步Crank–Nicolson法。\n\nC. 初始的向后欧拉步会增加最高频率模式的振幅，然后由Crank–Nicolson法进行修正；尽管如此，在 $t=T$ 处的整体精度仍为二阶。\n\nD. 对于标量测试方程，对于大的负 $\\Delta t\\,\\lambda$ 值，向后欧拉法（$\\theta=1$）和Crank–Nicolson法（$\\theta=1/2$）具有相同的放大因子，因此从 $\\theta=1$ 切换到 $\\theta=1/2$ 不会影响初始层的阻尼。\n\nE. 为了在存在非光滑初始数据的情况下恢复二阶精度，启动步骤必须是显式的；以 $\\theta=1$ 开始既不能改善阻尼，也不能恢复二阶精度。", "solution": "问题陈述已经过验证，被认为是合理、适定且科学正确的。\n\n该问题要求分析一种用于热方程数值解的可变时间步长策略。具体来说，该策略使用几步一阶向后欧拉法（$\\theta=1$），然后对所有后续步骤使用二阶Crank–Nicolson法（$\\theta=1/2$）。我们需要评估此策略在两个方面的影响：对来自非光滑数据的初始高频分量的阻尼，以及在固定的最终时间 $T  0$ 处的整体时间精度。\n\n让我们使用所提供的框架分别分析这两个方面。\n\n**1. 高频分量的阻尼**\n\n半离散系统 $\\frac{d}{dt}\\mathbf{u}(t) = A\\mathbf{u}(t)$ 是刚性的。刚性源于矩阵 $A$ 的特征值 $\\lambda_j$ 的量级跨度很大，其中 $|\\lambda_j|_{max} = \\mathcal{O}(h^{-2})$。大幅值的特征值对应于高频空间模式。非光滑的初始数据 $u_0(x)$ 在这些高频特征模上会有显著的投影。一个好的数值格式必须能快速阻尼这些分量，以模仿热方程的物理平滑特性。\n\n时间步进格式在这些模式上的行为可以通过标量测试方程 $y'(t) = \\lambda y(t)$ 来分析，其中 $\\lambda  0$ 代表 $A$ 的一个特征值。更新规则为 $y^{n+1} = R(z) y^n$，其中 $z = \\lambda \\Delta t$，$R(z)$ 是该方法的放大因子。对于 $\\theta$ 方法，放大因子为：\n$$\nR(z) = \\frac{1 + (1-\\theta)z}{1 - \\theta z}\n$$\n我们关心的是 $R(z)$ 在高频模式下的行为，这对应于 $z \\to -\\infty$。\n\n- **向后欧拉法（$\\theta=1$）：** 用于前 $m$ 步。\n放大因子为 $R_{BE}(z) = \\frac{1}{1-z}$。当 $z \\to -\\infty$ 时，我们有：\n$$\n\\lim_{z \\to -\\infty} R_{BE}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0\n$$\n这种对于无限刚性分量，放大因子趋于零的性质被称为L-稳定性。这意味着向后欧拉法能非常强烈地阻尼高频分量。这对于处理富含此类分量的初始非光滑数据是非常理想的。\n\n- **Crank–Nicolson法（$\\theta=1/2$）：** 用于 $n \\ge m$ 的步。\n放大因子为 $R_{CN}(z) = \\frac{1 + z/2}{1 - z/2}$。当 $z \\to -\\infty$ 时，我们有：\n$$\n\\lim_{z \\to -\\infty} R_{CN}(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = -1\n$$\n这意味着Crank–Nicolson法不阻尼高频分量；它在每个时间步保持其振幅，同时反转其符号。如果存在此类分量，这会导致数值解中出现持续的高频振荡。此性质被称为A-稳定性，它比L-稳定性弱。\n\n因此，初始阶段使用几步向后欧拉法的策略至关重要。它能有效地阻尼由非光滑数据引起的初始高频误差，从而在数值上“平滑”解。几步之后，解变得光滑，高频分量可以忽略不计，此时可以切换到更精确的Crank-Nicolson法，而不用担心振荡伪影。\n\n**2. 整体时间精度**\n\n向后欧拉法在时间上是一阶精度的（局部截断误差 $\\tau_{BE} = \\mathcal{O}(\\Delta t^2)$），而Crank–Nicolson法是二阶精度的（$\\tau_{CN} = \\mathcal{O}(\\Delta t^3)$）。一个简单的分析可能会认为，使用任意数量的一阶步骤都会将整个计算的全局精度降低到一阶。\n\n然而，对于抛物型问题，需要更精细的分析。关键在于精确解算子 $e^{tA}$ 的平滑性质。对于 $t  0$，即使 $u_0$ 不光滑，解 $u(t) = e^{tA}u_0$ 也是光滑的。$u(t)$ 的时间导数在 $t=0$ 时是奇异的，但在 $t0$ 时变得有界。例如，对于 $t0$，有 $\\|A^k u(t)\\| \\le C_k t^{-k} \\|u_0\\|$。\n\n局部截断误差项依赖于这些导数。向后欧拉步的一阶误差发生在早期时间 $t_n = n\\Delta t$（对于 $n=0, \\dots, m-1$）。虽然在这些初始时刻局部截断误差常数很大，但这些误差本身在向前传播时会被格式所阻尼。抛物方程的平滑性质意味着在开始时引入的误差在稍后的时间 $T$ 处的影响会减小。\n\n一个严格的分析（由 Rannacher 等人开创）表明，对于固定数量的初始步数 $m$（与 $\\Delta t$ 和 $h$ 无关），在固定的最终时间 $T  m\\Delta t$ 处的全局误差主要由积分主体部分所用方法的精度决定。来自少数启动步骤的一阶误差不会污染整体的二阶精度。在时间 $T$ 处的全局误差表现为 $\\mathcal{O}(\\Delta t^2)$。\n\n因此，这种组合策略成功地利用了两种方法的优点：向后欧拉法的强阻尼特性处理初始的非光滑性，以及Crank–Nicolson法的高精度用于后续已平滑解的演化，从而得到一种既稳健又具有二阶精度的方法。\n\n**选项评估：**\n\n- **A.** 该陈述声称，初始的BE步能阻尼高频分量，随后的CN步能产生二阶精度，且组合策略能同时实现这两个目标。我们的分析证实了这两点。BE步由于其L-稳定性提供了必要的阻尼。由于抛物型问题的平滑性质，整体精度得以保持在 $\\mathcal{O}(\\Delta t^2)$。**正确。**\n\n- **B.** 该陈述声称，任何BE的使用都会迫使全局精度为一阶。这是一个常见的误解，它忽略了抛物线平滑的特定背景。如分析所示，初始步骤的一阶误差在稍后的时间 $T$ 不会主导全局误差。**不正确。**\n\n- **C.** 该陈述声称BE步会*增加*高频模式的振幅。这在事实上是错误的。如放大因子 $R_{BE}(z) = 1/(1-z)$ 所示，对于 $\\text{Re}(z) \\le 0$，其模长始终小于或等于1，并且对于大的负 $z$ 值，它趋近于0。它是一种阻尼方法。**不正确。**\n\n- **D.** 该陈述声称BE和CN对于大的负 $\\Delta t \\lambda$ 具有相同的放大因子。我们计算得出 $\\lim_{z \\to -\\infty} R_{BE}(z) = 0$ 和 $\\lim_{z \\to -\\infty} R_{CN}(z) = -1$。它们并不相同。这些极限之间的差异正是该启动策略有效的原因。**不正确。**\n\n- **E.** 该陈述提出了多个错误的主张。首先，它建议启动必须是显式的；对于刚性问题，由于稳定性限制，这将是灾难性的。其次，它声称 $\\theta=1$（BE）不能改善阻尼，这与事实恰恰相反——其L-稳定性是其阻尼的关键优势。第三，它声称BE不能恢复二阶精度，这再次与该启动策略的既定理论相矛盾。**不正确。**\n\n最终结论：唯一准确的陈述是A。", "answer": "$$\\boxed{A}$$", "id": "3406590"}]}