{"hands_on_practices": [{"introduction": "我们将从数值分析的基石——冯·诺依曼稳定性分析——开始我们的动手实践探索。本练习聚焦于经典的Lax-Friedrichs格式，该格式通过引入空间平均项，巧妙地稳定了一种原本不稳定的方法。通过推导其放大因子和稳定性条件[@problem_id:3394452]，你将对数值耗散如何抑制高频误差获得根本性的理解，这是设计稳健数值方法的关键概念。", "problem": "考虑线性常系数一阶双曲平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数，该方程在均匀网格上离散，空间步长为 $\\,\\Delta x\\,$，时间步长为 $\\,\\Delta t\\,$。定义库朗数 $\\lambda = a\\,\\Delta t/\\Delta x$。考虑经典的 Lax–Friedrichs 格式\n$$\nu_{j}^{n+1} = \\tfrac{1}{2}\\big(u_{j+1}^{n} + u_{j-1}^{n}\\big) - \\tfrac{\\lambda}{2}\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big),\n$$\n其中 $j \\in \\mathbb{Z}$ 是空间节点的索引，$n \\in \\mathbb{N}$ 是时间层的索引。使用 von Neumann 稳定性的定义（即对形如 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ 的傅里叶模态进行分析，其中波数 $\\theta \\in [-\\pi,\\pi]$），推导放大因子 $G(\\theta,\\lambda)$，并确定最大的库朗数 $\\lambda_{\\max}$，使得该格式在 von Neumann 意义下是稳定的，即满足 $\\sup_{\\theta \\in [-\\pi,\\pi]} |G(\\theta,\\lambda)| \\le 1$。假设 $a > 0$，因此 $\\lambda \\ge 0$。作为推导的一部分，请解释平均项 $\\tfrac{1}{2}(u_{j+1}^{n} + u_{j-1}^{n})$ 如何对网格解析的高频模态起到阻尼作用。请给出最终答案，即单个实数 $\\lambda_{\\max}$。无需四舍五入。", "solution": "问题陈述被评估为有效。它提出了一个在偏微分方程数值分析领域中适定的、有科学依据的、标准的问题。所有必要信息，包括控制方程、数值格式和稳定性的定义，都已明确且一致地给出。任务是执行 von Neumann 稳定性分析，这是给定背景下的典型方法。\n\n分析过程分为三部分：第一，推导放大因子 $G(\\theta, \\lambda)$；第二，应用稳定性条件求出 $\\lambda_{\\max}$；第三，解释平均项的作用。\n\n为推导放大因子，我们将单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ 代入 Lax–Friedrichs 格式：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\big(u_{j+1}^{n} + u_{j-1}^{n}\\big) - \\frac{\\lambda}{2}\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big)\n$$\n将傅里叶模态代入各项可得：\n$u_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i j \\theta)$\n$u_{j+1}^{n} = \\hat{u}^{n}\\exp(i (j+1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta)$\n$u_{j-1}^{n} = \\hat{u}^{n}\\exp(i (j-1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)$\n\n将这些代入格式中得到：\n$$\n\\hat{u}^{n+1}\\exp(i j \\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) + \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right) - \\frac{\\lambda}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) - \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right)\n$$\n放大因子定义为 $G(\\theta, \\lambda) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$。将整个方程除以 $\\hat{u}^{n}\\exp(i j \\theta)$ 得到：\n$$\nG(\\theta, \\lambda) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\lambda}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{1}{2}(\\exp(i \\theta) + \\exp(-i \\theta))$ 和 $\\sin(\\theta) = \\frac{1}{2i}(\\exp(i \\theta) - \\exp(-i \\theta))$，我们简化 $G(\\theta, \\lambda)$ 的表达式：\n$$\nG(\\theta, \\lambda) = \\cos(\\theta) - i\\lambda\\sin(\\theta)\n$$\n这就是 Lax-Friedrichs 格式的放大因子。\n\n接下来，我们应用 von Neumann 稳定性条件，该条件要求对于任何波数 $\\theta \\in [-\\pi, \\pi]$，放大因子的模都不能超过 1：\n$$\n|G(\\theta, \\lambda)| \\le 1\n$$\n我们计算 $G(\\theta, \\lambda)$ 的模的平方，它是一个复数，实部为 $\\cos(\\theta)$，虚部为 $-\\lambda\\sin(\\theta)$：\n$$\n|G(\\theta, \\lambda)|^2 = (\\cos(\\theta))^2 + (-\\lambda\\sin(\\theta))^2 = \\cos^2(\\theta) + \\lambda^2\\sin^2(\\theta)\n$$\n因此，稳定性条件为：\n$$\n\\cos^2(\\theta) + \\lambda^2\\sin^2(\\theta) \\le 1\n$$\n使用恒等式 $\\cos^2(\\theta) = 1 - \\sin^2(\\theta)$，我们可以将不等式重写为：\n$$\n1 - \\sin^2(\\theta) + \\lambda^2\\sin^2(\\theta) \\le 1\n$$\n$$\n(\\lambda^2 - 1)\\sin^2(\\theta) \\le 0\n$$\n对于任意实数波数 $\\theta$，项 $\\sin^2(\\theta)$ 总是非负的（即 $\\sin^2(\\theta) \\ge 0$）。\n如果 $\\sin^2(\\theta) = 0$（对于 $\\theta = 0, \\pm\\pi$），不等式变为 $0 \\le 0$，这对任意 $\\lambda$ 值都平凡成立。\n如果 $\\sin^2(\\theta) > 0$（对于所有其他 $\\theta \\in [-\\pi, \\pi]$），我们必须满足条件 $\\lambda^2 - 1 \\le 0$，以使整个乘积为非正数。\n这意味着 $\\lambda^2 \\le 1$。\n问题指定 $a > 0$，$\\Delta t > 0$ 和 $\\Delta x > 0$，因此库朗数 $\\lambda = a \\Delta t/\\Delta x$ 是非负的，$\\lambda \\ge 0$。\n将 $\\lambda^2 \\le 1$ 与 $\\lambda \\ge 0$ 结合，得到稳定性约束：\n$$\n0 \\le \\lambda \\le 1\n$$\n对于所有 $\\theta$ 都满足此条件的最大库朗数 $\\lambda$ 值为 $\\lambda_{\\max} = 1$。这是该格式的 CFL (Courant-Friedrichs-Lewy) 条件。\n\n最后，我们讨论平均项 $\\frac{1}{2}(u_{j+1}^{n} + u_{j-1}^{n})$ 的作用。该项引入了数值耗散（或人工粘性），正是它稳定了格式。该偏微分方程的不稳定的前向时间中心空间 (FTCS) 格式是 $u_{j}^{n+1} = u_{j}^{n} - \\frac{\\lambda}{2}(u_{j+1}^{n} - u_{j-1}^{n})$。Lax-Friedrichs 格式用空间平均值 $\\frac{1}{2}(u_{j+1}^{n} + u_{j-1}^{n})$ 替换了 $u_{j}^{n}$ 项。\n\n从放大因子的角度来看，FTCS 格式的放大因子为 $G_{FTCS} = 1 - i\\lambda\\sin(\\theta)$，导致 $|G_{FTCS}|^2 = 1 + \\lambda^2\\sin^2(\\theta) > 1$（对于 $\\sin(\\theta) \\neq 0$），这是无条件不稳定的。Lax-Friedrichs 中的平均项将 $G_{FTCS}$ 实部的‘1’替换为 $\\cos(\\theta)$。这导致 $|G_{LF}|^2 = \\cos^2(\\theta) + \\lambda^2\\sin^2(\\theta)$。由于 $\\cos^2(\\theta) \\le 1$，这一项抵消了虚部带来的增长。对于任何具有 $\\sin(\\theta) \\neq 0$ 和稳定库朗数 $\\lambda < 1$ 的模态，我们有 $|G_{LF}|^2 < \\cos^2(\\theta) + \\sin^2(\\theta) = 1$。这表明所有非恒定模态都被阻尼，这是抑制高频数值振荡的关键特性。\n\n从修正偏微分方程的角度来看，我们可以使用泰勒级数展开来分析该格式。$u_j^n$ 项被近似为：\n$$\n\\frac{1}{2}\\left(u(x_j+\\Delta x, t_n) + u(x_j-\\Delta x, t_n)\\right) \\approx \\frac{1}{2}\\left(u + u_x\\Delta x + \\frac{u_{xx}}{2}\\Delta x^2 + u - u_x\\Delta x + \\frac{u_{xx}}{2}\\Delta x^2 \\right) = u + \\frac{\\Delta x^2}{2}u_{xx}\n$$\n将此代入完整格式的泰勒展开式表明，Lax-Friedrichs 格式不是原始偏微分方程 $u_t+a u_x=0$ 的相容近似，而是平流-扩散方程的相容近似：\n$$\nu_t + a u_x = \\frac{\\Delta x^2}{2\\Delta t} u_{xx}\n$$\n右侧项代表数值扩散，其扩散系数为 $\\nu = \\frac{\\Delta x^2}{2\\Delta t}$。众所周知，扩散方程对高频模态的阻尼作用强于对低频模态的阻尼作用。由平均项引入的人工粘性正是阻尼那些否则会增长并使解不稳定的高频数值误差的原因。阻尼量由 $1 - |G|^2 = (1-\\lambda^2)\\sin^2(\\theta)$ 给出，对于波数为 $\\theta=\\pm\\pi/2$（波长为 $4\\Delta x$）的模态（一个高频分量），该阻尼量达到最大。", "answer": "$$\\boxed{1}$$", "id": "3394452"}, {"introduction": "在掌握了简单全离散格式的分析之后，我们现在转向更灵活、应用更广泛的“线方法”（Method of Lines, MOL）框架。本实践将挑战你分析一个组合格式的稳定性，其中空间导数使用中心差分进行离散，时间推进则采用高阶的RK4方法。这项任务要求你将空间算子的傅里叶分析与常微分方程积分器的绝对稳定域概念相结合[@problem_id:3394389]，这是为输运现象开发稳定高阶格式的一项关键技能。", "problem": "考虑周期性域上的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 是一个常数平流速度。假设空间在间距为 $\\Delta x$ 的均匀网格上使用标准的二阶中心有限差分对空间导数进行离散化，时间推进采用经典的显式$4$阶$4$级龙格-库塔方法（通常记为“经典 RK$4$”）。假设初始数据足够光滑且周期性边界条件成立，从而离散傅里叶分析适用。\n\n从第一性原理出发，利用中心有限差分算子的离散傅里叶符号的定义以及龙格-库塔方法绝对稳定区域的定义（即该方法的稳定性函数 $R(z)$ 满足 $|R(z)| \\leq 1$ 的复数 $z$ 的集合），完成以下任务：\n\n- 推导空间算子的半离散特征值作为离散傅里叶波数的函数。\n- 在不假设任何 $R(z)$ 的预制公式的情况下，推导经典RK$4$方法的稳定性函数 $R(z)$。\n- 通过求解精确边界条件 $|R(i y)| = 1$，确定包含在经典RK$4$方法绝对稳定区域内的虚轴上最大区间 $\\{ i y : |y| \\leq y_{\\star} \\}$。\n- 利用此结果得到确保完全离散格式对网格上所有可分辨傅里叶模式线性稳定的最大允许时间步长 $\\Delta t_{\\max}$。\n\n将您的最终答案表示为关于 $\\Delta x$ 和 $a$ 的封闭形式符号表达式。不要引入任何数值近似；无需四舍五入。最终答案应为 $\\Delta t_{\\max}$ 的单个解析表达式（不带单位）。", "solution": "该问题是有效的，因为它具有科学依据、提法明确、客观，并包含获得唯一解所需的所有信息。我们按照问题陈述中概述的步骤进行。\n\n控制偏微分方程是线性平流方程 $u_{t} + a\\,u_{x} = 0$，可以重写为 $u_{t} = -a\\,u_{x}$。空间域是周期性的，平流速度 $a$ 是一个非零实常数。\n\n**1. 半离散特征值分析**\n\n空间导数 $u_x$ 在间距为 $\\Delta x$ 的均匀网格上使用标准的二阶中心有限差分进行离散化。设 $U_j(t)$ 是网格点 $x_j = j \\Delta x$ 处 $u(x_j, t)$ 的数值近似。半离散方程为：\n$$ \\frac{dU_j}{dt} = -a \\frac{U_{j+1}(t) - U_{j-1}(t)}{2 \\Delta x} $$\n这是一个常微分方程组（ODEs），可以写成向量形式 $\\frac{d\\boldsymbol{U}}{dt} = L\\boldsymbol{U}$，其中 $L$ 是空间离散化算子。为了找到 $L$ 的特征值，我们通过考虑单个傅里叶模式作为解来进行离散傅里叶分析：\n$$ U_j(t) = \\hat{U}(t, k) \\exp(i k x_j) = \\hat{U}(t, k) \\exp(i k j \\Delta x) $$\n其中 $k$ 是波数。将此代入半离散方程中得到：\n$$ \\frac{d\\hat{U}}{dt} \\exp(i k j \\Delta x) = -a \\frac{\\hat{U} \\exp(i k (j+1) \\Delta x) - \\hat{U} \\exp(i k (j-1) \\Delta x)}{2 \\Delta x} $$\n两边同除以 $\\hat{U} \\exp(i k j \\Delta x)$（假设 $\\hat{U} \\neq 0$）：\n$$ \\frac{1}{\\hat{U}} \\frac{d\\hat{U}}{dt} = -a \\frac{\\exp(i k \\Delta x) - \\exp(-i k \\Delta x)}{2 \\Delta x} $$\n使用欧拉公式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们得到：\n$$ \\frac{d\\hat{U}}{dt} = -a \\frac{2i \\sin(k \\Delta x)}{2 \\Delta x} \\hat{U} = \\left( -i \\frac{a}{\\Delta x} \\sin(k \\Delta x) \\right) \\hat{U} $$\n这是一个关于傅里叶系数 $\\hat{U}$ 的一阶常微分方程，形式为 $\\frac{d\\hat{U}}{dt} = \\lambda \\hat{U}$。因此，半离散算子 $L$ 的特征值 $\\lambda$ 由下式给出：\n$$ \\lambda(k) = -i \\frac{a}{\\Delta x} \\sin(k \\Delta x) $$\n令 $\\xi = k \\Delta x$ 为标度化波数，对于网格上可分辨的模式，其位于区间 $[-\\pi, \\pi]$ 内，则特征值为：\n$$ \\lambda(\\xi) = -i \\frac{a}{\\Delta x} \\sin(\\xi), \\quad \\xi \\in [-\\pi, \\pi] $$\n这些特征值是纯虚数。\n\n**2. 经典RK4方法的稳定性函数**\n\n用于求解常微分方程 $y' = f(y)$ 的经典$4$阶$4$级龙格-库塔（RK$4$）方法如下：\n\\begin{align*}\n k_1 = f(y_n) \\\\\n k_2 = f(y_n + \\frac{\\Delta t}{2} k_1) \\\\\n k_3 = f(y_n + \\frac{\\Delta t}{2} k_2) \\\\\n k_4 = f(y_n + \\Delta t k_3) \\\\\n y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{align*}\n为了找到稳定性函数 $R(z)$，我们将该方法应用于线性测试方程 $y' = \\lambda y$，其中 $f(y)=\\lambda y$。令 $z = \\lambda \\Delta t$。\n\\begin{align*}\n k_1 = \\lambda y_n \\\\\n k_2 = \\lambda(y_n + \\frac{\\Delta t}{2} (\\lambda y_n)) = \\lambda y_n (1 + \\frac{z}{2}) \\\\\n k_3 = \\lambda(y_n + \\frac{\\Delta t}{2} k_2) = \\lambda(y_n + \\frac{\\Delta t}{2} \\lambda y_n(1+\\frac{z}{2})) = \\lambda y_n (1 + \\frac{z}{2} + \\frac{z^2}{4}) \\\\\n k_4 = \\lambda(y_n + \\Delta t k_3) = \\lambda(y_n + \\Delta t \\lambda y_n(1 + \\frac{z}{2} + \\frac{z^2}{4})) = \\lambda y_n (1 + z + \\frac{z^2}{2} + \\frac{z^3}{4})\n\\end{align*}\n将这些代入 $y_{n+1}$ 的更新公式中：\n$$ y_{n+1} = y_n + \\frac{\\Delta t}{6} \\left[ \\lambda y_n + 2\\lambda y_n(1+\\frac{z}{2}) + 2\\lambda y_n(1+\\frac{z}{2}+\\frac{z^2}{4}) + \\lambda y_n(1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) \\right] $$\n$$ y_{n+1} = y_n \\left( 1 + \\frac{z}{6} \\left[ 1 + 2(1+\\frac{z}{2}) + 2(1+\\frac{z}{2}+\\frac{z^2}{4}) + (1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) \\right] \\right) $$\n简化方括号中的表达式：\n$$ [\\dots] = 1 + (2+z) + (2+z+\\frac{z^2}{2}) + (1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) = 6 + 3z + z^2 + \\frac{z^3}{4} $$\n因此，\n$$ y_{n+1} = y_n \\left( 1 + \\frac{z}{6} \\left( 6 + 3z + z^2 + \\frac{z^3}{4} \\right) \\right) = y_n \\left( 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} \\right) $$\n稳定性函数 $R(z) = y_{n+1}/y_n$ 是 $\\exp(z)$ 的泰勒级数展开式，截断到4阶项：\n$$ R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} $$\n\n**3. 虚轴稳定区间**\n\n绝对稳定区域是满足 $|R(z)| \\le 1$ 的复数 $z$ 的集合。我们需要找到包含在该区域内的虚轴上的最大区间 $\\{iy : |y| \\le y_\\star\\}$。这需要找到使 $|R(iy)| = 1$ 的非零 $y$ 值。\n令 $z = iy$。稳定性函数变为：\n$$ R(iy) = 1 + iy + \\frac{(iy)^2}{2} + \\frac{(iy)^3}{6} + \\frac{(iy)^4}{24} = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right) + i\\left(y - \\frac{y^3}{6}\\right) $$\n模的平方为：\n$$ |R(iy)|^2 = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right)^2 + \\left(y - \\frac{y^3}{6}\\right)^2 $$\n展开各项：\n$$ |R(iy)|^2 = \\left(1 - y^2 + \\frac{y^4}{4} + \\frac{y^4}{12} - \\frac{y^6}{24} + \\frac{y^8}{576}\\right) + \\left(y^2 - \\frac{y^4}{3} + \\frac{y^6}{36}\\right) $$\n合并 $y$ 的同次幂项：\n$$ |R(iy)|^2 = 1 + y^4\\left(\\frac{1}{4} + \\frac{1}{12} - \\frac{1}{3}\\right) + y^6\\left(-\\frac{1}{24} + \\frac{1}{36}\\right) + \\frac{y^8}{576} $$\n$y^4$ 的系数是 $\\frac{3+1-4}{12} = 0$。$y^6$ 的系数是 $\\frac{-3+2}{72} = -\\frac{1}{72}$。\n该表达式简化为：\n$$ |R(iy)|^2 = 1 - \\frac{y^6}{72} + \\frac{y^8}{576} $$\n令 $|R(iy)|^2 = 1$ 以找到稳定区域的边界：\n$$ 1 - \\frac{y^6}{72} + \\frac{y^8}{576} = 1 \\implies \\frac{y^8}{576} = \\frac{y^6}{72} $$\n对于非零的 $y$，我们可以两边同除以 $y^6$：\n$$ y^2 = \\frac{576}{72} = 8 $$\n解为 $y = \\pm\\sqrt{8} = \\pm 2\\sqrt{2}$。对于 $|y| < 2\\sqrt{2}$，我们有 $y^2 < 8$，这使得 $|R(iy)|^2 = 1 + \\frac{y^6}{576}(y^2 - 8) < 1$。因此，沿虚轴的稳定区间为 $[-i2\\sqrt{2}, i2\\sqrt{2}]$，我们得到 $y_\\star = 2\\sqrt{2}$。\n\n**4. 最大允许时间步长**\n\n为使完全离散格式稳定，对于半离散算子的所有特征值 $\\lambda$，量 $z = \\lambda \\Delta t$ 必须位于 RK$4$ 方法的绝对稳定区域内。\n$$ z(\\xi) = \\lambda(\\xi) \\Delta t = -i \\frac{a \\Delta t}{\\Delta x} \\sin(\\xi) $$\n由于这些值是纯虚数，稳定性条件要求它们位于我们刚找到的虚轴稳定区间内：\n$$ |z(\\xi)| \\le y_\\star \\quad \\forall \\xi \\in [-\\pi, \\pi] $$\n$$ \\left| -i \\frac{a \\Delta t}{\\Delta x} \\sin(\\xi) \\right| \\le 2\\sqrt{2} $$\n$$ \\frac{|a| \\Delta t}{\\Delta x} |\\sin(\\xi)| \\le 2\\sqrt{2} $$\n这个不等式必须对所有支持的波数都成立，因此我们必须考虑 $|\\sin(\\xi)|$ 取最大值的“最坏情况”。在区间 $\\xi \\in [-\\pi, \\pi]$ 上，$|\\sin(\\xi)|$ 的最大值为 $1$（在 $\\xi = \\pm \\pi/2$ 时取到）。\n因此，稳定性条件变为：\n$$ \\frac{|a| \\Delta t}{\\Delta x} \\cdot 1 \\le 2\\sqrt{2} $$\n求解时间步长 $\\Delta t$：\n$$ \\Delta t \\le \\frac{2\\sqrt{2} \\Delta x}{|a|} $$\n最大允许时间步长 $\\Delta t_{\\max}$ 是此不等式的上界。\n$$ \\Delta t_{\\max} = \\frac{2\\sqrt{2} \\Delta x}{|a|} $$\n这是此特定数值格式的库朗-弗里德里希斯-列维（CFL）条件。", "answer": "$$\\boxed{\\frac{2\\sqrt{2} \\Delta x}{|a|}}$$", "id": "3394389"}, {"introduction": "一个稳定的格式是必要的，但并非总是足够的；对于许多物理问题，确保数值方法遵循基本的守恒律同等重要。本练习将我们的焦点从稳定性转移到离散守恒原理上。通过比较一个通量差分形式的有限体积格式和一个半拉格朗日格式[@problem_id:3394397]，你将揭示为何前者能够内在地保证质量守恒而后者则可能不然，并学习如何通过一个简单有效的修正来强制实现这一关键属性。", "problem": "考虑在周期性区域 $x \\in [0,L]$ 上、具有恒定速度 $a \\neq 0$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$。设该区域被划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体积（单元），其中心为 $\\{x_{i}\\}_{i=1}^{N}$。用 $u_{i}^{n}$ 表示 $u(x,t)$ 在时间 $t^{n}$ 于单元 $i$ 上的单元平均值，并将时间 $t^{n}$ 的离散总质量定义为 $M^{n} = \\Delta x \\sum_{i=1}^{N} u_{i}^{n}$。\n\n1) 从控制体积的积分守恒律和周期性边界条件出发，解释为什么任何以通量差分形式写出的相容有限体积（FV）离散格式都必须精确守恒离散总质量 $M^{n}$。特别地，论证标准迎风有限体积方法（其数值通量根据 $a$ 的符号相容地选择）对所有 $n$ 都保持 $M^{n}$ 守恒。\n\n2) 考虑一种半拉格朗日（SL）更新方法，该方法通过从单元中心 $x_i$ 沿特征线向后追溯到出发点 $x_{i}^{\\mathrm{d}} = x_{i} - a\\,\\Delta t$，并从已知的离散数据中插值 $u(\\cdot,t^{n})$，来计算单元中心的临时值 $\\tilde{u}_{i}^{n+1}$。以守恒律为根本依据，解释为什么即使其对应的连续方程守恒真实质量，这种基于逐点插值的SL步骤通常也无法守恒离散总质量 $\\tilde{M}^{n+1} = \\Delta x \\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1}$。\n\n3) 为了在保留SL输运步骤的同时强制实现精确的离散质量守恒，请提出了一个统一应用于所有单元的单一全局乘法修正因子 $\\alpha \\in \\mathbb{R}$，使得修正后的更新 $u_{i}^{n+1} = \\alpha\\,\\tilde{u}_{i}^{n+1}$ 在周期性网格上满足 $M^{n+1} = M^{n}$。请用 $\\{u_{i}^{n}\\}_{i=1}^{N}$ 和 $\\{\\tilde{u}_{i}^{n+1}\\}_{i=1}^{N}$ 推导出 $\\alpha$ 的闭式表达式。\n\n你的最终答案必须仅为标量 $\\alpha$ 的闭式表达式。不要包含任何额外的评注。如果你选择通过约去公因子来简化，请明确地这样做。不需要四舍五入，也不需要单位。", "solution": "该问题分为三个部分。我们将依次进行解答。\n\n1) 让我们分析通量差分形式的有限体积（FV）方法的守恒性质。\n线性平流方程为 $u_t + a u_x = 0$。由于 $a$ 是一个常数，该方程已经处于守恒形式 $u_t + F(u)_x=0$，其中通量函数为线性函数 $F(u) = au$。该守恒律在控制体积 $C_i = [x_{i-1/2}, x_{i+1/2}]$ 上的积分形式，是通过对偏微分方程（PDE）关于 $x$ 进行积分得到的：\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u_t(x,t) \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} (au(x,t))_x \\,dx = 0 $$\n对第一项使用Leibniz积分法则，对第二项使用微积分基本定理，我们得到：\n$$ \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx + au(x_{i+1/2},t) - au(x_{i-1/2},t) = 0 $$\n我们将单元 $i$ 上的 $u$ 的单元平均值定义为 $u_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx$。代入此定义，方程变为关于单元平均值 $u_i(t)$ 的一个半离散常微分方程：\n$$ \\Delta x \\frac{du_i(t)}{dt} + F(u(x_{i+1/2},t)) - F(u(x_{i-1/2},t)) = 0 $$\n有限体积法通过用一个依赖于相邻单元解的状态的数值通量函数 $\\hat{F}_{i\\pm 1/2}$ 来代替单元界面上的精确通量 $F(u(x_{i\\pm 1/2},t))$，从而将其离散化。为简单起见，应用前向欧拉时间步进格式，我们得到全离散更新方程：\n$$ \\frac{u_i^{n+1} - u_i^n}{\\Delta t} + \\frac{\\hat{F}_{i+1/2}^n - \\hat{F}_{i-1/2}^n}{\\Delta x} = 0 $$\n这可以被重新整理为所谓的通量差分形式：\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (\\hat{F}_{i+1/2}^n - \\hat{F}_{i-1/2}^n) $$\n为了检验守恒量，我们将此更新规则对区域中所有 $N$ 个单元进行求和：\n$$ \\sum_{i=1}^{N} u_i^{n+1} = \\sum_{i=1}^{N} u_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^{N} (\\hat{F}_{i+1/2}^n - \\hat{F}_{i-1/2}^n) $$\n右侧的第二项是一个裂项和：\n$$ \\sum_{i=1}^{N} (\\hat{F}_{i+1/2}^n - \\hat{F}_{i-1/2}^n) = (\\hat{F}_{3/2}^n - \\hat{F}_{1/2}^n) + (\\hat{F}_{5/2}^n - \\hat{F}_{3/2}^n) + \\dots + (\\hat{F}_{N-1/2}^n - \\hat{F}_{N-3/2}^n) + (\\hat{F}_{N+1/2}^n - \\hat{F}_{N-1/2}^n) = \\hat{F}_{N+1/2}^n - \\hat{F}_{1/2}^n $$\n题目指定了在区域 $x \\in [0, L]$ 上的周期性边界条件。这意味着单元 $N$ 与单元 $1$ 相邻。在 $x_{N+1/2}$ 处的界面与在 $x_{1/2}$ 处的界面是等同的。因此，依赖于局部数据的数值通量也必须是周期性的：$\\hat{F}_{N+1/2}^n = \\hat{F}_{1/2}^n$。这使得裂项和恰好为零：\n$$ \\sum_{i=1}^{N} (\\hat{F}_{i+1/2}^n - \\hat{F}_{i-1/2}^n) = 0 $$\n因此，单元平均值的和是守恒的：\n$$ \\sum_{i=1}^{N} u_i^{n+1} = \\sum_{i=1}^{N} u_i^n $$\n乘以恒定的单元宽度 $\\Delta x$，我们证明了离散总质量 $M^n = \\Delta x \\sum_{i=1}^{N} u_i^n$ 对任何时间步 $n$ 都是精确守恒的：\n$$ M^{n+1} = M^n $$\n这个论证适用于任何以通量差分形式写出的相容有限体积方法，因为它只依赖于更新的代数结构和区域的周期性。标准迎风有限体积方法是此类格式的一个具体实例。其数值通量定义为：如果 $a>0$，则 $\\hat{F}_{i+1/2} = a u_i$；如果 $a<0$，则 $\\hat{F}_{i+1/2} = a u_{i+1}$。由于这符合通量差分形式，迎风方法能精确守恒离散总质量 $M^n$。\n\n2) 现在我们来考虑半拉格朗日（SL）方法及其守恒性质。SL方法基于特征线法。$u_t + a u_x = 0$ 的精确解是 $u(x,t) = u_0(x-at)$，这意味着解沿着特征曲线 $x - at = \\text{constant}$ 是常数。这导出了更新规则 $u(x_i, t^{n+1}) = u(x_i - a\\Delta t, t^n)$。点 $x_i^{\\mathrm{d}} = x_i - a\\Delta t$ 是出发点。\n在数值实现中，我们在时间 $t^n$ 只有离散的单元平均数据 $\\{u_j^n\\}$。SL格式通过首先从 $\\{u_j^n\\}$ 重构一个连续函数，然后在 $x_i^{\\mathrm{d}}$ 处对其进行求值（插值），来近似出发点的值。我们将插值算子表示为 $\\mathcal{I}$，那么临时更新为：\n$$ \\tilde{u}_i^{n+1} = \\mathcal{I}[\\{u_j^n\\}](x_i^{\\mathrm{d}}) $$\n这些临时值的总质量为 $\\tilde{M}^{n+1} = \\Delta x \\sum_{i=1}^{N} \\tilde{u}_i^{n+1}$。\n质量不守恒的根本原因在于守恒律的积分性质与SL更新的逐点性质之间的不匹配。\n时间 $t^n$ 的离散质量 $M^n = \\Delta x \\sum_i u_i^n$ 代表了总积分 $\\int_0^L u(x,t^n)\\,dx$ 的一个数值积分。如果 $\\tilde{M}^{n+1} = M^n$，则该格式是守恒的。这要求 $\\sum_i \\tilde{u}_i^{n+1} = \\sum_i u_i^n$。\nSL更新通过对一组插值点值求和来计算 $\\sum_i \\tilde{u}_i^{n+1}$。一个插值方法，例如线性或三次插值，将每个 $\\tilde{u}_i^{n+1}$ 计算为少数相邻值 $\\{u_j^n\\}$ 的线性组合。因此，和 $\\sum_i \\tilde{u}_i^{n+1}$ 是所有 $\\{u_j^n\\}$ 的一个总的线性组合。为了实现守恒，在这个总和中，每个 $u_j^n$ 的系数之和必须恰好为 1。\n情况通常并非如此。插值过程本身并不遵守数据的积分性质。例如，一个常见的错误是，为了插值而将单元平均数据 $u_j^n$ 视为点值 $u(x_j,t^n)$，这是一个不相容的近似。即使使用能保持单元平均值的更复杂的重构方法，在一组移位的点 $\\{x_i^\\mathrm{d}\\}$ 上采样的点值之和，通常也不等于原始单元平均值之和。\n简而言之，SL方法没有被表述为通量的平衡。它绕过了保证有限体积方法精确守恒的代数结构（通量的裂项和）。结果，没有内在机制能确保 $\\sum_i \\tilde{u}_i^{n+1} = \\sum_i u_i^n$，因此离散质量不守恒。\n\n3) 我们被要求推导一个全局乘法修正因子 $\\alpha$ 以强制实现质量守恒。\n来自SL步骤的未修正的临时更新给出了值 $\\{\\tilde{u}_i^{n+1}\\}_{i=1}^N$。相应的未修正离散总质量为：\n$$ \\tilde{M}^{n+1} = \\Delta x \\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1} $$\n我们希望找到一个单一标量 $\\alpha$ 来定义一个对所有 $i \\in \\{1, \\dots, N\\}$ 都成立的修正更新 $u_i^{n+1} = \\alpha \\tilde{u}_i^{n+1}$。该修正必须使得新的离散总质量 $M^{n+1}$ 等于前一步的质量 $M^n$。\n在时间 $t^{n+1}$ 的修正后质量为：\n$$ M^{n+1} = \\Delta x \\sum_{i=1}^{N} u_{i}^{n+1} $$\n代入提议的修正：\n$$ M^{n+1} = \\Delta x \\sum_{i=1}^{N} (\\alpha\\,\\tilde{u}_{i}^{n+1}) $$\n由于 $\\alpha$ 是一个全局常数，它可以从求和中提取出来：\n$$ M^{n+1} = \\alpha \\left( \\Delta x \\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1} \\right) = \\alpha \\tilde{M}^{n+1} $$\n守恒约束是 $M^{n+1} = M^n$。因此，我们必须有：\n$$ M^n = \\alpha \\tilde{M}^{n+1} $$\n假设 $\\tilde{M}^{n+1} \\neq 0$，解出 $\\alpha$：\n$$ \\alpha = \\frac{M^n}{\\tilde{M}^{n+1}} $$\n现在，我们将用单元平均值表示的 $M^n$ 和 $\\tilde{M}^{n+1}$ 的定义代入：\n$$ M^n = \\Delta x \\sum_{i=1}^{N} u_{i}^{n} $$\n$$ \\tilde{M}^{n+1} = \\Delta x \\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1} $$\n$\\alpha$ 的表达式变为：\n$$ \\alpha = \\frac{\\Delta x \\sum_{i=1}^{N} u_{i}^{n}}{\\Delta x \\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1}} $$\n因子 $\\Delta x$ 同时出现在分子和分母中，因此可以被约去。这得出了修正因子 $\\alpha$ 的最终闭式表达式：\n$$ \\alpha = \\frac{\\sum_{i=1}^{N} u_{i}^{n}}{\\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1}} $$\n这个因子是时间步之前的总质量（除去因子 $\\Delta x$）与非守恒SL更新产生的总质量之比。均匀地应用此因子可以缩放临时解，以恢复正确的总质量。", "answer": "$$\n\\boxed{\\frac{\\sum_{i=1}^{N} u_{i}^{n}}{\\sum_{i=1}^{N} \\tilde{u}_{i}^{n+1}}}\n$$", "id": "3394397"}]}