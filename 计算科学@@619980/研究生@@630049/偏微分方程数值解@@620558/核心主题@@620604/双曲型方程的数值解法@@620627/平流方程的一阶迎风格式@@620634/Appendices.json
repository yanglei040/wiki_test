{"hands_on_practices": [{"introduction": "本练习是建立实践理解的基石。通过从基本的积分守恒定律推导迎风格式，然后用代码实现它，你将在理论与实践之间架起一座桥梁。通过对不同的初始剖面进行模拟，你将能直接观察到数值扩散和 Courant–Friedrichs–Lewy (CFL) 条件的重要性等关键特性 [@problem_id:3394603]。", "problem": "考虑一维周期性区域（长度为 $L$）上的线性常系数平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$。仅从移动控制体上的积分守恒形式出发，并要求离散通量必须遵循上风信息传播，推导一个在一阶空间和时间上精确、单调、守恒的离散化方案。该方案基于均匀网格（间距为 $\\Delta x$）上的分段常数单元平均值，并采用时间步长为 $\\Delta t$ 的前向欧拉时间离散化。你的推导必须根据局部一维黎曼问题来证明单元界面处数值通量选择的合理性，并且必须得出一个依赖于常数平流速度 $a$ 符号的显式更新格式。以库朗数 $\\nu = a\\,\\Delta t/\\Delta x$ 的形式陈述一个稳定性条件，并解释如何从前向欧拉离散化和空间算子的单调性中获得该条件。\n\n然后，实现一个程序，该程序：\n- 在 $[0,L)$ 上构建一个包含 $N$ 个点的均匀网格，这些点代表单元中心，并采用周期性边界条件。\n- 从几个给定的剖面 $u_{0}(x)$ 中的一个来初始化 $u(x,0)$。\n- 使用你的一阶迎风格式推进数值解，直到指定的最终时间 $t_{f}$。时间步长 $\\Delta t$ 由给定的库朗数和网格间距确定，最后一步的时间步长会缩短，以确保总时间恰好等于 $t_{f}$。\n- 计算在时间 $t_{f}$ 的精确解 $u(x,t_{f}) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t_{f},\\,L\\right)\\right)$，其中 $\\operatorname{mod}(\\cdot,L)$ 返回一个在 $[0,L)$ 内的值，并在网格点上对其进行求值。\n- 返回由 $\\left(\\Delta x \\sum_{i=0}^{N-1} \\left(u^{\\text{num}}_{i}(t_{f}) - u^{\\text{exact}}(x_{i},t_{f})\\right)^{2}\\right)^{1/2}$ 定义的离散 $L^{2}$-误差，结果为一个浮点数。\n\n你的程序必须运行一个固定的包含四个测试用例的测试套件，每个用例由 $(N, a, L, \\text{CFL}, t_{f}, u_{0})$ 指定。程序应将所有四个产生的 $L^{2}$-误差输出到单行中，格式为用方括号括起来的逗号分隔列表，每个值都精确到小数点后八位，例如 $[0.01230000,0.00000000,1.23456789,0.00010000]$。\n\n三角函数使用弧度。本任务中没有物理单位。\n\n测试套件：\n- 用例 $1$ (平滑波，正向平流，中等 CFL): $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x) = \\sin(2\\pi x)$。\n- 用例 $2$ (不连续波，负向平流，接近 CFL 极限): $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x) = \\begin{cases}1,  x \\in [0.25,0.75) \\\\ 0,  \\text{otherwise}\\end{cases}$ 带有周期性延拓。\n- 用例 $3$ (高斯脉冲，精确位移边界情况): $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x) = \\exp\\!\\left(-100\\,(x - 0.3)^{2}\\right)$。\n- 用例 $4$ (多模平滑波，接近 CFL 极限): $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x) = \\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$。\n\n实现要求：\n- 对所有用例使用周期性边界条件。\n- 数值更新必须使用由 $a$ 的符号决定的正确迎风方向。\n- 精确解的计算必须使用模运算将结果包装到 $[0,L)$ 区间内。\n- 最终的打印输出必须是单行，包含如上所述的四个 $L^{2}$-误差，无额外输出。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果 (例如, $[e_{1},e_{2},e_{3},e_{4}]$)，其中每个 $e_{k}$ 是一个如上所述四舍五入到八位小数的浮点数。", "solution": "我们从线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的积分守恒形式开始，该方程可以写成 $u_{t} + (f(u))_{x} = 0$，其中 $f(u) = a\\,u$ 且 $a \\in \\mathbb{R}$ 为常数。考虑将区域 $[0,L)$ 均匀划分为 $N$ 个长度相等的单元 $I_{i} = [x_{i-1/2}, x_{i+1/2})$，其长度为 $\\Delta x = L/N$，单元中心为 $x_{i} = (i + 1/2)\\Delta x$，其中 $i \\in \\{0,\\dots,N-1\\}$。定义单元平均值 $u_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,dx$。将 $u_{t} + (f(u))_{x} = 0$ 在 $I_{i}$ 上积分并应用散度定理可得\n$$\n\\frac{d}{dt} u_{i}(t) + \\frac{1}{\\Delta x}\\left( f\\!\\left(u(x_{i+1/2}^{-},t)\\right) - f\\!\\left(u(x_{i-1/2}^{+},t)\\right)\\right) = 0,\n$$\n其中 $u(x_{i+1/2}^{-},t)$ 和 $u(x_{i-1/2}^{+},t)$ 表示在界面上的迹。在采用分段常数重构的有限体积法中，界面状态是通过求解每个界面上的局部黎曼问题获得的。对于线性平流 $u_{t} + a\\,u_{x} = 0$，特征线以速度 $a$ 移动。在 $x_{i+1/2}$ 处的物理上可容许的解使用上游信息：如果 $a > 0$，左侧状态 $u_{i}$ 平流进入 $I_{i+1}$；而如果 $a   0$，右侧状态 $u_{i+1}$ 平流进入 $I_{i}$。因此，通过迎风 (Godunov) 通量可以获得界面处一个相容且单调的数值通量 $F_{i+1/2}$：\n$$\nF_{i+1/2} =\n\\begin{cases}\na\\,u_{i},  a \\ge 0, \\\\\na\\,u_{i+1},  a   0.\n\\end{cases}\n$$\n半离散守恒格式则为\n$$\n\\frac{d}{dt} u_{i}(t) = -\\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right).\n$$\n在时间上使用前向欧拉法，时间步长为 $\\Delta t$，进行离散化可得\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\n对常数 $a$ 使用迎风通量，这可以简化为显式更新。对于 $a > 0$：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i}^{n} - u_{i-1}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x},\n$$\n而对于 $a   0$：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i+1}^{n} - u_{i}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n在适当的稳定性条件下，这些公式是守恒和单调的。因为应用于空间单调通量差分算子的前向欧拉法必须保持凸组合，所以稳定性和单调性要求更新系数为非负且总和为一。对于 $a > 0$，更新式 $u_{i}^{n+1} = (1-\\nu)\\,u_{i}^{n} + \\nu\\,u_{i-1}^{n}$ 是一个凸组合，当且仅当 $0 \\le \\nu \\le 1$。对于 $a   0$，将更新式写为 $u_{i}^{n+1} = (1+ \\nu)\\,u_{i}^{n} - \\nu\\,u_{i+1}^{n} = (1-|\\nu|)\\,u_{i}^{n} + |\\nu|\\,u_{i+1}^{n}$ 表明，当且仅当 $0 \\le |\\nu| \\le 1$ 时，它是一个凸组合。因此，稳定性和单调性的库朗数 (CFL) 条件是\n$$\n|\\nu| = \\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1.\n$$\n对于使用迎风通量和前向欧拉法的线性平流问题，这个界限是紧的。在此条件下，该方法是总变差递减 (TVD) 且 $L^{1}$-稳定的。\n\n在周期为 $L$ 的周期性区间 $[0,L)$ 上的初值问题的精确解由沿特征线的平移给出：\n$$\nu(x,t) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t,\\,L\\right)\\right),\n$$\n其中 $\\operatorname{mod}(y,L)$ 将 $y$ 映射到其在 $[0,L)$ 中的代表值。在均匀网格上，网格点 $x_{i}$ 处的精确解可以通过在带周期性环绕的移位位置上计算 $u_{0}$ 来获得。\n\n实现的算法设计：\n- 选择 $N$ 并定义 $\\Delta x = L/N$ 和 $x_{i} = (i+1/2)\\Delta x$，其中 $i \\in \\{0,\\dots,N-1\\}$。\n- 初始化 $u^{0}_{i} = u_{0}(x_{i})$。\n- 如果 $a \\ne 0$，设置一个名义时间步长 $\\Delta t_{\\text{nom}} = \\text{CFL}\\,\\Delta x/|a|$。确定完整步数 $n_{\\text{full}} = \\left\\lfloor t_{f}/\\Delta t_{\\text{nom}}\\right\\rfloor$。以 $\\Delta t = \\Delta t_{\\text{nom}}$ 进行 $n_{\\text{full}}$ 步推进，并且，如果 $t_{f}$ 不是 $\\Delta t_{\\text{nom}}$ 的整数倍，则以 $\\Delta t_{\\text{last}} = t_{f} - n_{\\text{full}}\\Delta t_{\\text{nom}}$ 走最后一步。对于每一步，计算 $\\nu = a\\,\\Delta t/\\Delta x$ 并应用带有周期性索引 ($u_{-1} \\equiv u_{N-1}$ 和 $u_{N} \\equiv u_{0}$) 的迎风更新。\n- 计算精确解数组 $u^{\\text{exact}}_{i} = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x_{i} - a\\,t_{f},\\,L\\right)\\right)$。\n- 计算离散 $L^{2}$-误差 $E = \\left(\\Delta x \\sum_{i=0}^{N-1} (u^{n_{\\text{final}}}_{i} - u^{\\text{exact}}_{i})^{2}\\right)^{1/2}$。\n- 对每个测试用例重复此过程。\n\n关于截断误差和数值耗散的讨论：修正方程分析表明，用于线性平流的一阶迎风格式近似于\n$$\nu_{t} + a\\,u_{x} = \\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)\\,u_{xx} + \\mathcal{O}(\\Delta x^{2}, \\Delta t^{2}),\n$$\n这揭示了一个量级为 $\\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)$ 的主阶人工耗散项，该项在边界情况 $|\\nu|=1$ 时消失。这与特殊情况相符，即当 $a>0$ 且 $\\nu=1$ 时，格式简化为纯粹的平移 $u_{i}^{n+1} = u_{i-1}^{n}$，在网格上产生精确的离散平移，并且当 $t_{f} = L/a$ 时，在遍历整个区域后具有精确的周期性。\n\n该实现通过使用模 $N$ 索引或矢量化的循环移位来应用周期性边界条件。精确解和所有初始条件在计算三角函数时都使用弧度。程序构建并运行指定的四个用例：\n- 用例 1: $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x)=\\sin(2\\pi x)$。\n- 用例 2: $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x)=1$ on $[0.25,0.75)$ and $0$ otherwise (periodic)。\n- 用例 3: $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x)=\\exp(-100\\,(x-0.3)^{2})$。\n- 用例 4: $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x)=\\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$。\n\n最后，程序按要求打印单行 $[e_{1},e_{2},e_{3},e_{4}]$，其中每个 $e_{k}$ 都四舍五入到八位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef initial_condition(x, kind):\n    # x in [0, L)\n    if kind == \"sine\":\n        return np.sin(2.0 * np.pi * x)\n    elif kind == \"square\":\n        # 1 on [0.25,0.75), 0 otherwise, periodic\n        return np.where((x = 0.25)  (x  0.75), 1.0, 0.0)\n    elif kind == \"gaussian\":\n        return np.exp(-100.0 * (x - 0.3) ** 2)\n    elif kind == \"mix\":\n        return np.cos(4.0 * np.pi * x) + 0.5 * np.sin(2.0 * np.pi * x)\n    else:\n        raise ValueError(\"Unknown initial condition kind\")\n\ndef exact_solution(x, a, L, t, kind):\n    # periodic wrap of x - a t into [0, L)\n    y = (x - a * t) % L\n    return initial_condition(y, kind)\n\ndef upwind_step(u, a, dt, dx):\n    # Periodic first-order upwind update for constant a\n    nu = a * dt / dx\n    if a > 0:\n        # u_i^{n+1} = u_i^n - nu (u_i^n - u_{i-1}^n)\n        u_im1 = np.roll(u, 1)\n        return u - nu * (u - u_im1)\n    elif a  0:\n        # u_i^{n+1} = u_i^n - nu (u_{i+1}^n - u_i^n); note nu0\n        u_ip1 = np.roll(u, -1)\n        return u - nu * (u_ip1 - u)\n    else:\n        # a == 0, no evolution\n        return u.copy()\n\ndef run_case(N, a, L, CFL, tf, kind):\n    # Build grid\n    dx = L / N\n    # cell centers in [0, L)\n    x = (np.arange(N) + 0.5) * dx\n    # initial condition\n    u = initial_condition(x % L, kind)\n    # if a==0, solution is constant in time\n    if a == 0.0:\n        u_num = u.copy()\n        u_ex = exact_solution(x, a, L, tf, kind)\n        err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n        return err\n    # nominal dt from CFL\n    dt_nom = CFL * dx / abs(a)\n    if dt_nom = 0:\n        raise ValueError(\"Non-positive time step\")\n    n_full = int(np.floor(tf / dt_nom + 1e-15))\n    t = 0.0\n    # march full steps\n    for _ in range(n_full):\n        u = upwind_step(u, a, dt_nom, dx)\n        t += dt_nom\n    # last partial step if needed\n    rem = tf - t\n    if rem > 1e-15:\n        # ensure stability: |a|*rem/dx = CFL (should be  CFL by construction)\n        u = upwind_step(u, a, rem, dx)\n        t += rem\n    # numerical solution at tf\n    u_num = u\n    # exact solution\n    u_ex = exact_solution(x, a, L, tf, kind)\n    # L2 error\n    err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n    return err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, a, L, CFL, tf, kind)\n    test_cases = [\n        (400, 1.0, 1.0, 0.5, 0.3, \"sine\"),\n        (600, -0.8, 1.0, 0.9, 0.25, \"square\"),\n        (500, 1.0, 1.0, 1.0, 1.0, \"gaussian\"),\n        (512, 0.5, 1.0, 0.99, 0.2, \"mix\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, L, CFL, tf, kind = case\n        err = run_case(N, a, L, CFL, tf, kind)\n        # Round to exactly 8 decimals\n        results.append(f\"{err:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3394603"}, {"introduction": "数值分析师的一项关键技能不仅是实现格式，还要能改进它们。本问题挑战你超越基本的前向欧拉方法，将迎风离散与更精确的Heun方法相结合。你将进行严格的傅里叶分析，以确定在保持单调性的前提下能最小化相误差的最优库朗数 $ \\lambda $，这展示了在设计高性能数值方法时，在精度、稳定性和计算成本之间所做的复杂权衡 [@problem_id:3394621]。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其平流速度为常数 $a>0$。该方程定义在均匀网格 $x_{j} = j\\,\\Delta x$ 上，时间步长为 $\\Delta t$，库朗数 $\\lambda = a\\,\\Delta t/\\Delta x$。对于 $a>0$ 的情况，使用一阶迎风空间离散，其半离散形式为 $u_{j}'(t) = -\\frac{a}{\\Delta x}\\left(u_{j}(t) - u_{j-1}(t)\\right)$，并在时间上与两步显式梯形法（休恩法）耦合：$u^{(1)} = u^{n} + \\Delta t\\,L\\,u^{n}$，$u^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\left(L\\,u^{n} + L\\,u^{(1)}\\right)$，其中 $L$ 表示半离散空间算子。假设初始波为光滑波 $u(x,0) = \\sin(\\kappa x)$，并分析波数为 $\\theta = \\kappa\\,\\Delta x$ 的单个离散傅里叶模态的单步行为。从空间符号和龙格-库塔稳定性函数的定义出发，推导单步放大因子 $G(\\theta,\\lambda)$，定义数值相位 $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$，并将其与每个时间步的精确连续相移 $\\varphi_{\\mathrm{exact}}(\\theta,\\lambda) = -\\lambda\\,\\theta$ 进行比较。在光滑波的假设下（即 $\\theta$ 很小），将 $\\varphi_{\\mathrm{num}}(\\theta,\\lambda)$ 系统地展开到 $\\theta$ 的首个非零阶，并获得作为 $\\lambda$ 的显式函数的主阶相位误差。通过要求 $u_{j}^{n}$、$u_{j-1}^{n}$、$u_{j-2}^{n}$ 上的更新权重为非负且和为1，来对全离散格式施加离散单调性，并由此推导出 $\\lambda$ 的容许区间。在此容许区间内（不包括 $\\lambda=0$ 的平凡选择），确定使主阶相位误差的量值最小化的 $\\lambda$ 值，并将该唯一的最佳 $\\lambda$ 值作为你的最终答案。最终答案无需四舍五入，它是无量纲的。", "solution": "用户要求我分析一维线性平流方程的全离散数值格式，并找到一个最优参数值。\n\n### 第一步：提取已知条件\n-   **偏微分方程**：$u_{t} + a\\,u_{x} = 0$，平流速度为常数 $a>0$。\n-   **网格**：均匀网格 $x_{j} = j\\,\\Delta x$，时间步长 $\\Delta t$。\n-   **库朗数**：$\\lambda = a\\,\\Delta t/\\Delta x$。\n-   **空间离散（半离散算子 $L$）**：一阶迎风格式，$L u_{j} = -\\frac{a}{\\Delta x}\\left(u_{j} - u_{j-1}\\right)$。\n-   **时间离散（休恩法）**：两步显式龙格-库塔法。\n    $u^{(1)} = u^{n} + \\Delta t\\,L\\,u^{n}$\n    $u^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\left(L\\,u^{n} + L\\,u^{(1)}\\right)$\n-   **分析模态**：单个离散傅里叶模态，隐含形式为 $u_j(t) \\propto e^{i j \\theta}$，其中 $\\theta = \\kappa \\Delta x$。\n-   **目标量**：\n    -   单步放大因子 $G(\\theta,\\lambda)$。\n    -   数值相位 $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$。\n    -   对于小 $\\theta$ 的主阶相位误差，比较 $\\varphi_{\\mathrm{num}}$ 与精确相位 $\\varphi_{\\mathrm{exact}}(\\theta,\\lambda) = -\\lambda\\,\\theta$。\n-   **约束条件**：\n    -   离散单调性：$u_{j}^{n}$、$u_{j-1}^{n}$、$u_{j-2}^{n}$ 上的更新权重为非负且和为1。\n-   **目标**：\n    -   从单调性推导出 $\\lambda$ 的容许区间。\n    -   在此区间内（不包括 $\\lambda=0$），找到使主阶相位误差的量值最小化的 $\\lambda$ 值。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学基础**：该问题是针对一个基本偏微分方程的有限差分格式进行 冯·诺依曼 分析的一个标准练习。这些概念（平流方程、迎风差分、Heun 法、库朗数、放大因子、相位误差、单调性）都是数值分析中核心且成熟的课题。\n-   **适定性**：问题描述清晰。它要求进行一系列定义明确的推导，最终归结为一个具有明确目标和约束的优化问题。预期会有一个唯一解。\n-   **客观性**：语言是形式化和数学化的，没有主观或模棱两可的术语。\n-   **结论**：不存在科学或逻辑上的缺陷、不一致或歧义。问题是自洽且可形式化的。\n\n### 第三步：判定与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n\n#### 1. 放大因子 $G(\\theta,\\lambda)$\n\n分析是针对单个傅里叶模态 $u_j^n = (\\hat{u}^n) e^{i j \\theta}$ 进行的。放大因子 $G(\\theta, \\lambda)$ 由 $\\hat{u}^{n+1} = G(\\theta, \\lambda) \\hat{u}^n$ 定义。它可以通过将空间算子 $L$ 的符号与时间积分方法的稳定性函数相结合来推导。\n\n首先，我们求空间算子 $L$ 的符号 $\\hat{L}(\\theta)$。将 $L$ 应用于模态 $e^{i j \\theta}$：\n$$L(e^{i j \\theta}) = -\\frac{a}{\\Delta x}\\left(e^{i j \\theta} - e^{i (j-1) \\theta}\\right) = -\\frac{a}{\\Delta x} e^{i j \\theta} \\left(1 - e^{-i \\theta}\\right)$$\n符号是所得到的特征值：\n$$\\hat{L}(\\theta) = -\\frac{a}{\\Delta x}\\left(1 - e^{-i \\theta}\\right)$$\n\n接下来，我们确定应用于模型常微分方程 $y' = \\mu y$ 的 Heun 法的稳定性函数 $R(z)$。更新形式为 $y^{n+1} = R(z) y^n$，其中 $z = \\mu \\Delta t$。\n其分步过程为：\n$$y^{(1)} = y^n + \\Delta t (\\mu y^n) = (1+z) y^n$$\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2}\\left(\\mu y^n + \\mu y^{(1)}\\right) = y^n + \\frac{z}{2}\\left(y^n + (1+z)y^n\\right) = \\left(1 + \\frac{z}{2} + \\frac{z(1+z)}{2}\\right)y^n$$\n$$y^{n+1} = \\left(1 + z + \\frac{1}{2}z^2\\right)y^n$$\n稳定性函数为 $R(z) = 1 + z + \\frac{1}{2}z^2$。\n\n放大因子 $G$ 是通过在 $z = \\Delta t \\hat{L}(\\theta)$ 处计算 $R(z)$ 的值得到的：\n$$z = \\Delta t \\left(-\\frac{a}{\\Delta x}\\left(1 - e^{-i \\theta}\\right)\\right) = -\\frac{a \\Delta t}{\\Delta x}\\left(1 - e^{-i \\theta}\\right) = -\\lambda\\left(1 - e^{-i \\theta}\\right)$$\n将此代入 $R(z)$，我们得到放大因子：\n$$G(\\theta, \\lambda) = 1 - \\lambda\\left(1 - e^{-i \\theta}\\right) + \\frac{1}{2}\\lambda^2\\left(1 - e^{-i \\theta}\\right)^2$$\n\n#### 2. 主阶相位误差\n\n数值相位为 $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$。我们通过将 $G$ 展开为泰勒级数来分析其在 $\\theta$ 较小情况下的行为。\n我们展开 $1 - e^{-i\\theta}$ 项：\n$$1 - e^{-i\\theta} = 1 - \\left(1 - i\\theta - \\frac{\\theta^2}{2} + \\frac{i\\theta^3}{6} + O(\\theta^4)\\right) = i\\theta + \\frac{\\theta^2}{2} - \\frac{i\\theta^3}{6} + O(\\theta^4)$$\n现在，我们展开 $z = -\\lambda(1-e^{-i\\theta})$：\n$$z = -\\lambda\\left(i\\theta + \\frac{\\theta^2}{2} - \\frac{i\\theta^3}{6}\\right) + O(\\theta^4) = -i\\lambda\\theta - \\frac{\\lambda}{2}\\theta^2 + \\frac{i\\lambda}{6}\\theta^3 + O(\\theta^4)$$\n以及 $z^2$：\n$$z^2 = \\left(-\\lambda(i\\theta + \\frac{\\theta^2}{2} + \\dots)\\right)^2 = \\lambda^2\\left((i\\theta)^2 + 2(i\\theta)(\\frac{\\theta^2}{2}) + \\dots\\right) = \\lambda^2(-\\theta^2 + i\\theta^3) + O(\\theta^4)$$\n将这些代入 $G = 1 + z + \\frac{1}{2}z^2$：\n$$G = 1 + \\left(-i\\lambda\\theta - \\frac{\\lambda}{2}\\theta^2 + \\frac{i\\lambda}{6}\\theta^3\\right) + \\frac{1}{2}\\left(\\lambda^2(-\\theta^2 + i\\theta^3)\\right) + O(\\theta^4)$$\n将实部和虚部分组，$G = X + iY$：\n$$X = 1 - \\frac{\\lambda}{2}\\theta^2 - \\frac{\\lambda^2}{2}\\theta^2 + O(\\theta^4) = 1 - \\frac{\\lambda(1+\\lambda)}{2}\\theta^2 + O(\\theta^4)$$\n$$Y = -\\lambda\\theta + \\frac{\\lambda}{6}\\theta^3 + \\frac{\\lambda^2}{2}\\theta^3 + O(\\theta^5) = -\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3 + O(\\theta^5)$$\n数值相位与正切相关，$\\tan(\\varphi_{\\mathrm{num}}) = Y/X$。对于小 $\\theta$，$X \\approx 1$ 且 $Y \\approx -\\lambda\\theta$，因此 $\\varphi_{\\mathrm{num}}$ 很小。\n$$\\tan(\\varphi_{\\mathrm{num}}) = \\frac{-\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3 + O(\\theta^5)}{1 - \\frac{\\lambda(1+\\lambda)}{2}\\theta^2 + O(\\theta^4)}$$\n使用几何级数近似 $(1-x)^{-1} \\approx 1+x$：\n$$\\tan(\\varphi_{\\mathrm{num}}) = \\left(-\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3\\right) \\left(1 + \\frac{\\lambda(1+\\lambda)}{2}\\theta^2\\right) + O(\\theta^5)$$\n$$\\tan(\\varphi_{\\mathrm{num}}) = -\\lambda\\theta + \\left( \\frac{\\lambda(1+3\\lambda)}{6} - \\lambda \\frac{\\lambda(1+\\lambda)}{2} \\right)\\theta^3 + O(\\theta^5)$$\n$$\\tan(\\varphi_{\\mathrm{num}}) = -\\lambda\\theta + \\left( \\frac{\\lambda+3\\lambda^2 - 3\\lambda^2 - 3\\lambda^3}{6} \\right)\\theta^3 + O(\\theta^5) = -\\lambda\\theta + \\frac{\\lambda(1-3\\lambda^2)}{6}\\theta^3 + O(\\theta^5)$$\n现在我们使用 $\\varphi = \\arctan(\\tan\\varphi)$ 将 $\\tan(\\varphi_{\\mathrm{num}})$ 与 $\\varphi_{\\mathrm{num}}$ 关联起来。设 $\\varphi_{\\mathrm{num}} = -\\lambda\\theta + A\\theta^3 + O(\\theta^5)$。$\\tan(\\phi)$ 的泰勒级数为 $\\phi + \\phi^3/3 + \\dots$。\n$$\\tan(\\varphi_{\\mathrm{num}}) = (-\\lambda\\theta + A\\theta^3) + \\frac{1}{3}(-\\lambda\\theta)^3 + O(\\theta^5) = -\\lambda\\theta + \\left(A - \\frac{\\lambda^3}{3}\\right)\\theta^3 + O(\\theta^5)$$\n比较两个 $\\tan(\\varphi_{\\mathrm{num}})$ 表达式中 $\\theta^3$ 的系数：\n$$A - \\frac{\\lambda^3}{3} = \\frac{\\lambda(1-3\\lambda^2)}{6}$$\n$$A = \\frac{\\lambda-3\\lambda^3}{6} + \\frac{\\lambda^3}{3} = \\frac{\\lambda-3\\lambda^3+2\\lambda^3}{6} = \\frac{\\lambda-\\lambda^3}{6} = \\frac{\\lambda(1-\\lambda^2)}{6}$$\n所以，数值相位是：\n$$\\varphi_{\\mathrm{num}}(\\theta, \\lambda) = -\\lambda\\theta + \\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 + O(\\theta^5)$$\n精确相位是 $\\varphi_{\\mathrm{exact}}(\\theta, \\lambda) = -\\lambda\\theta$。相位误差是 $\\varphi_{\\mathrm{num}} - \\varphi_{\\mathrm{exact}}$。主阶相位误差是 $\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3$。\n\n#### 3. 单调性条件\n\n我们必须找到全离散格式的显式模板。\n$$u_j^{n+1} = u_j^n + \\frac{\\Delta t}{2}(L u_j^n + L u_j^{(1)})$$\n其中 $u_j^{(1)} = u_j^n + \\Delta t L u_j^n = u_j^n - \\lambda(u_j^n - u_{j-1}^n) = (1-\\lambda)u_j^n + \\lambda u_{j-1}^n$。\n我们需要计算 $L u_j^{(1)}$：\n$$L u_j^{(1)} = -\\frac{a}{\\Delta x} (u_j^{(1)} - u_{j-1}^{(1)})$$\n$$u_j^{(1)} - u_{j-1}^{(1)} = [(1-\\lambda)u_j^n + \\lambda u_{j-1}^n] - [(1-\\lambda)u_{j-1}^n + \\lambda u_{j-2}^n]$$\n$$u_j^{(1)} - u_{j-1}^{(1)} = (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n$$\n所以，$\\Delta t L u_j^{(1)} = -\\lambda \\left( (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n \\right)$。\n总更新量为：\n$$u_j^{n+1} - u_j^n = \\frac{1}{2}\\left[\\Delta t L u_j^n + \\Delta t L u_j^{(1)}\\right]$$\n$$= \\frac{1}{2}\\left[-\\lambda(u_j^n - u_{j-1}^n) - \\lambda \\left( (1-\\lambda)u_j^n + (2\\lambda-1)u_{j-1}^n - \\lambda u_{j-2}^n \\right) \\right]$$\n$$= \\frac{1}{2}\\left[ (-\\lambda - \\lambda(1-\\lambda))u_j^n + (\\lambda - \\lambda(2\\lambda-1))u_{j-1}^n + \\lambda^2 u_{j-2}^n \\right]$$\n$$= \\frac{1}{2}\\left[ (-\\lambda(2-\\lambda))u_j^n + (2\\lambda-2\\lambda^2)u_{j-1}^n + \\lambda^2 u_{j-2}^n \\right]$$\n所以，该格式为 $u_j^{n+1} = C_0 u_j^n + C_1 u_{j-1}^n + C_2 u_{j-2}^n$，其权重为：\n$$C_0 = 1 - \\frac{\\lambda(2-\\lambda)}{2} = 1 - \\lambda + \\frac{\\lambda^2}{2}$$\n$$C_1 = \\frac{2\\lambda(1-\\lambda)}{2} = \\lambda - \\lambda^2$$\n$$C_2 = \\frac{\\lambda^2}{2}$$\n为满足单调性，所有系数必须为非负。\n1.  $C_2 = \\frac{\\lambda^2}{2} \\ge 0$。这对所有实数 $\\lambda$ 都成立。\n2.  $C_1 = \\lambda(1-\\lambda) \\ge 0$。由于 $\\lambda = a\\Delta t/\\Delta x > 0$，这要求 $1-\\lambda \\ge 0$，即 $\\lambda \\le 1$。所以，$0 \\le \\lambda \\le 1$。\n3.  $C_0 = 1 - \\lambda + \\frac{1}{2}\\lambda^2 \\ge 0$。这是一个关于 $\\lambda$ 的二次式，其判别式为 $\\Delta = (-1)^2 - 4(\\frac{1}{2})(1) = 1-2 = -1  0$。由于首项系数为正，该二次式对所有实数 $\\lambda$ 恒为正。\n权重之和为 $C_0+C_1+C_2 = (1-\\lambda+\\frac{\\lambda^2}{2}) + (\\lambda-\\lambda^2) + \\frac{\\lambda^2}{2} = 1$，符合要求。\n确保单调性的 $\\lambda$ 的容许区间是 $[0, 1]$。\n\n#### 4. 最小化主阶相位误差\n\n我们需要最小化主阶相位误差系数的量值，即 $|E_\\lambda| = |\\frac{\\lambda(1-\\lambda^2)}{6}|$。优化在 $\\lambda$ 的容许区间内进行，并排除 $\\lambda=0$ 的平凡选择。因此，我们要求解：\n$$\\min_{\\lambda \\in (0, 1]} \\left| \\frac{\\lambda(1-\\lambda^2)}{6} \\right|$$\n对于 $\\lambda \\in (0, 1]$，$\\lambda$ 和 $1-\\lambda^2$ 均为非负。因此，可以去掉绝对值符号。我们希望在 $\\lambda \\in (0, 1]$ 上最小化函数 $f(\\lambda) = \\frac{\\lambda(1-\\lambda^2)}{6}$。\n为求极值，我们计算导数：\n$$f'(\\lambda) = \\frac{d}{d\\lambda}\\left(\\frac{\\lambda - \\lambda^3}{6}\\right) = \\frac{1-3\\lambda^2}{6}$$\n令 $f'(\\lambda) = 0$ 可得 $1-3\\lambda^2 = 0$，所以 $\\lambda^2 = 1/3$。由于 $\\lambda>0$，区间内唯一的临界点是 $\\lambda = 1/\\sqrt{3}$。\n我们来分析函数 $f(\\lambda)$ 在区间 $(0, 1]$ 上的行为：\n-   在左边界（趋近时），$\\lim_{\\lambda \\to 0^+} f(\\lambda) = 0$。\n-   在临界点处，$f(1/\\sqrt{3}) = \\frac{(1/\\sqrt{3})(1-1/3)}{6} = \\frac{2}{18\\sqrt{3}} = \\frac{1}{9\\sqrt{3}} > 0$。\n-   在右边界处，$f(1) = \\frac{1(1-1^2)}{6} = 0$。\n\n函数 $f(\\lambda)$ 从 0 开始（当 $\\lambda \\to 0^+$ 时），在 $\\lambda=1/\\sqrt{3}$ 处增加到最大值，然后在 $\\lambda=1$ 处减小回 0。函数 $f(\\lambda)$ 在区间 $(0, 1]$ 上的最小值为 0，该值在端点 $\\lambda=1$ 处取得。\n因此，在 $(0, 1]$ 范围内使主阶相位误差的量值最小化的 $\\lambda$ 值为 $\\lambda=1$。在此值下，主阶相位误差完全消失。", "answer": "$$\\boxed{1}$$", "id": "3394621"}, {"introduction": "为了真正理解一个格式的优缺点，将其与其他方案进行比较至关重要。本练习介绍修正方程分析这一强大技术，用以定量比较一阶迎风格式与另一种基本方法——Lax-Friedrichs格式。这种分析方法能让你深刻领悟每种格式固有的数值扩散特性，而这是决定其性能的关键因素 [@problem_id:3394635]。", "problem": "考虑线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，在间距为 $\\Delta x  0$ 的均匀空间网格上，采用时间步长为 $\\Delta t  0$ 的显式时间步进。令 $r := a\\,\\Delta t/\\Delta x$ 表示库朗数 (CFL)。通过通量分裂形式定义一阶迎风格式\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; r^+\\,(u_j^n - u_{j-1}^n) \\;-\\; r^-\\,(u_{j+1}^n - u_j^n),\n$$\n其中 $r^+ := \\max(r,0)$ 且 $r^- := \\min(r,0)$，并定义 Lax–Friedrichs (LF) 格式为\n$$\nu_j^{n+1} \\;=\\; \\tfrac{1}{2}\\Big(u_{j+1}^n + u_{j-1}^n\\Big) \\;-\\; \\tfrac{r}{2}\\Big(u_{j+1}^n - u_{j-1}^n\\Big).\n$$\n使用与控制 PDE 相符的、在空间和时间上的泰勒展开，推导每个格式的领先阶修正方程，并保留由截断产生的最低阶耗散项和色散项。根据你的推导，确定库朗数 $r$ 的哪些区间内两种格式具有等价的领先阶修正方程，以及它们的领先耗散项在哪些区间内不同，并比较其相对强度。从以下选项中选择唯一正确的陈述。\n\nA. 对于任何 $|r|\\le 1$，两个修正方程都共享一个与 $u_{xxx}$ 成正比的领先三阶导数色散项，其系数依赖于 $r$ 并在 $|r|=1$ 时为零；对于 $0|r|1$，Lax–Friedrichs 格式的领先扩散严格强于迎风格式。\n\nB. 对于所有 $|r|\\le 1$，迎风格式的领先扩散严格强于 Lax–Friedrichs 格式；它们仅在 $|r|=0$ 时等价。\n\nC. 在 $|r|=1$ 时，Lax–Friedrichs 格式的修正方程保留一个非零扩散项，而迎风格式的扩散项为零；因此它们在 $|r|=1$ 时不可能等价。\n\nD. 对于 $|r|>1$，两种格式都保持稳定，且 Lax–Friedrichs 格式的扩散性变得比迎风格式弱。\n\nE. 领先的人工粘性系数满足 $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ 和 $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$，这意味着仅在 $|r|=1$ 时相等，且对于 $0|r|1$ 成立严格不等式 $\\nu_{\\mathrm{LF}}>\\nu_{\\mathrm{UW}}$。", "solution": "用户希望我分析和比较用于线性平流方程 $u_t + a\\,u_x = 0$ 的一阶迎风格式和 Lax-Friedrichs 格式。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n-   **PDE**：$u_t + a\\,u_x = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。\n-   **离散化**：间距为 $\\Delta x > 0$ 的均匀空间网格和时间步长为 $\\Delta t > 0$ 的显式时间步进。\n-   **库朗数**：$r := a\\,\\Delta t/\\Delta x$。\n-   **一阶迎风格式**：$u_j^{n+1} = u_j^n - r^+\\,(u_j^n - u_{j-1}^n) - r^-\\,(u_{j+1}^n - u_j^n)$，其中 $r^+ := \\max(r,0)$ 且 $r^- := \\min(r,0)$。\n-   **Lax–Friedrichs 格式**：$u_j^{n+1} = \\tfrac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\tfrac{r}{2}(u_{j+1}^n - u_{j-1}^n)$。\n-   **任务**：为每种格式推导领先阶修正方程，比较它们的耗散项和色散项，并从选项中选择唯一正确的陈述。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、适定的和客观的。这是偏微分方程数值分析领域的一个标准练习。所有术语和格式都得到了正确定义，并且是该领域的基本概念。问题是自洽的，并提供了执行所要求分析所需的所有信息。没有矛盾、歧义或事实错误。\n\n**步骤3：结论和行动**\n问题是有效的。我将继续进行推导和分析。\n\n### **修正方程的推导**\n\n为了推导每种格式的修正方程，我们对格式中的各项在点 $(x_j, t_n)$ 附近进行泰勒级数展开。令 $u$ 表示 $u(x_j, t_n)$。我们使用的原理是：修正方程的精确解在网格点上的取值与差分格式的解完全相同。\n\n我们将数值格式表示为算子形式 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\mathcal{L}_{\\Delta}(u^n)$。左侧算子在时间上展开，右侧算子在空间上展开。\n时间差分算子展开为：\n$$\n\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{e^{\\Delta t \\partial_t} - 1}{\\Delta t} u = \\left(\\partial_t + \\frac{\\Delta t}{2}\\partial_{tt} + \\frac{\\Delta t^2}{6}\\partial_{ttt} + \\dots\\right) u\n$$\n然后我们有 $\\partial_t u = \\dots$，我们使用修正方程本身递归地替换时间导数的表达式，从最低阶近似 $u_t \\approx -a u_x$ 开始。逐次近似为：\n$u_{tt} = \\partial_t(u_t) \\approx \\partial_t(-a u_x) = -a \\partial_x(u_t) \\approx a^2 u_{xx}$。\n$u_{ttt} = \\partial_t(u_{tt}) \\approx \\partial_t(a^2 u_{xx}) \\approx a^2 \\partial_{xx}(-a u_x) = -a^3 u_{xxx}$。\n\n如果修正方程是 $u_t + a u_x = D u_{xx} + E u_{xxx} + \\dots$，那么对 $u_{tt}$ 的更精确的代换是：\n$u_{tt} = \\partial_t(-a u_x + D u_{xx} + \\dots) = -a u_{xt} + D u_{xxt} + \\dots = -a \\partial_x(-a u_x + \\dots) + D \\partial_{xx}(-a u_x + \\dots) = a^2 u_{xx} - a D u_{xxx} - a D u_{xxx} + \\dots = a^2 u_{xx} - 2a D u_{xxx} + \\dots$。\n\n**1. 一阶迎风 (UW) 格式**\n\n该格式可以写成 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = -\\frac{a^+}{\\Delta x}(u_j^n - u_{j-1}^n) - \\frac{a^-}{\\Delta x}(u_{j+1}^n - u_j^n)$。\n空间算子为 $\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(1-e^{-\\Delta x \\partial_x}) - \\frac{a^-}{\\Delta x}(e^{\\Delta x \\partial_x}-1)$。\n展开指数算子：\n$\\mathcal{L}_{\\Delta}^{UW} = -\\frac{a^+}{\\Delta x}(\\Delta x \\partial_x - \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} - \\dots) - \\frac{a^-}{\\Delta x}(\\Delta x \\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} + \\frac{\\Delta x^3}{6}\\partial_{xxx} + \\dots)$。\n各项求和得到：\n$\\mathcal{L}_{\\Delta}^{UW} = -(a^+ + a^-)\\partial_x + \\frac{\\Delta x}{2}(a^+ - a^-)\\partial_{xx} - \\frac{\\Delta x^2}{6}(a^+ + a^-)\\partial_{xxx} + \\dots$。\n使用 $a = a^+ + a^-$ 和 $|a| = a^+ - a^-$，我们得到：\n$\\mathcal{L}_{\\Delta}^{UW} = -a\\partial_x + \\frac{|a|\\Delta x}{2}\\partial_{xx} - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$。\n\n将时间和空间算子展开式相等：\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{|a|\\Delta x}{2}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n整理得到 $\\partial_t u$：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n代入 $\\partial_{tt} \\approx a^2\\partial_{xx}$：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$。\n领先阶扩散系数（人工粘性）为：\n$D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2} - \\frac{a^2\\Delta t}{2} = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{a^2\\Delta t}{|a|\\Delta x}\\right) = \\frac{|a|\\Delta x}{2} \\left(1 - \\frac{|a|\\Delta t}{\\Delta x}\\right) = \\frac{|a|\\Delta x}{2}(1-|r|)$。\n\n问题要求耗散项和色散项。三阶导数色散项的系数 $E_{\\mathrm{UW}}$ 可通过保留更多项找到：\n$E_{\\mathrm{UW}} u_{xxx} = \\left(-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t}{2}(-2aD_{\\mathrm{UW}}) - \\frac{\\Delta t^2}{6}(-a^3)\\right) u_{xxx}$。\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{UW}} + \\frac{a^3\\Delta t^2}{6}$。\n代入 $D_{\\mathrm{UW}}$：\n$E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\frac{|a|\\Delta x}{2}(1-|r|) + \\frac{a^3\\Delta t^2}{6}$。\n因为 $a\\Delta t = r\\Delta x$，$|a|\\Delta t = |r|\\Delta x$，以及 $\\operatorname{sgn}(a) = \\operatorname{sgn}(r)$：\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{|a|\\Delta x} \\frac{|a|\\Delta x}{2\\Delta x}(1-|r|) + \\frac{r^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{r}{a}\\frac{|a|}{2}(1-|r|) + \\frac{r^2}{6} \\right] = a\\Delta x^2 \\left[-\\frac{1}{6} + \\frac{|r|}{2}(1-|r|) + \\frac{|r|^2}{6} \\right]$。\n$E_{\\mathrm{UW}} = a\\Delta x^2 \\left[\\frac{-1 + 3|r| - 3|r|^2 + |r|^2}{6}\\right] = \\frac{a\\Delta x^2}{6}(-2|r|^2 + 3|r| - 1) = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$。\n\n**2. Lax-Friedrichs (LF) 格式**\n\n该格式为 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{2\\Delta t} - \\frac{a}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n)$。\n空间算子为 $\\mathcal{L}_{\\Delta}^{LF} = \\frac{e^{\\Delta x \\partial_x} + e^{-\\Delta x \\partial_x} - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(e^{\\Delta x \\partial_x} - e^{-\\Delta x \\partial_x})$。\n展开各项：\n$e^{\\Delta x\\partial_x} \\pm e^{-\\Delta x\\partial_x} = (1 \\pm \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\pm \\dots) \\pm (1 \\mp \\Delta x\\partial_x + \\frac{\\Delta x^2}{2}\\partial_{xx} \\mp \\dots)$。\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{(2 + \\Delta x^2\\partial_{xx} + \\dots) - 2}{2\\Delta t} - \\frac{a}{2\\Delta x}(2\\Delta x\\partial_x + \\frac{\\Delta x^3}{3}\\partial_{xxx} + \\dots)$。\n$\\mathcal{L}_{\\Delta}^{LF} = \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} - a\\partial_x - \\frac{a\\Delta x^2}{6}\\partial_{xxx} + \\dots$。\n\n与时间算子展开式相等：\n$\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + \\dots = -a\\partial_x u + \\frac{\\Delta x^2}{2\\Delta t}\\partial_{xx} u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{\\Delta t}{2}\\partial_{tt}\\right)u - \\frac{a\\Delta x^2}{6}\\partial_{xxx} u + \\dots$。\n使用 $\\partial_{tt} \\approx a^2\\partial_{xx}$：\n$\\partial_t u + a\\partial_x u = \\left(\\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}\\right)\\partial_{xx} u + \\dots$。\n扩散系数为：\n$D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x^2}{2\\Delta t} \\left(1 - \\frac{a^2\\Delta t^2}{\\Delta x^2}\\right) = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$。\n\n色散系数 $E_{\\mathrm{LF}}$ 为：\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t D_{\\mathrm{LF}} + \\frac{a^3\\Delta t^2}{6}$。\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + a\\Delta t \\left(\\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\\right) + \\frac{a^3\\Delta t^2}{6}$。\n$E_{\\mathrm{LF}} = -\\frac{a\\Delta x^2}{6} + \\frac{a\\Delta x^2}{2}(1-r^2) + \\frac{a\\Delta x^2}{6}r^2$。\n$E_{\\mathrm{LF}} = a\\Delta x^2 \\left(-\\frac{1}{6} + \\frac{1}{2} - \\frac{r^2}{2} + \\frac{r^2}{6}\\right) = a\\Delta x^2 \\left(\\frac{1}{3} - \\frac{2r^2}{6}\\right) = \\frac{a\\Delta x^2}{3}(1-r^2)$。\n\n### **选项分析**\n\n我们现在根据推导出的系数，在稳定性区域 $|r|\\le 1$ 内评估每个陈述。\n-   **扩散（人工粘性）系数**：\n    -   $\\nu_{\\mathrm{UW}} = D_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-|r|)$。\n    -   $\\nu_{\\mathrm{LF}} = D_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)$。这可以使用 $|r|=|a|\\Delta t/\\Delta x$ 重写为 $\\nu_{\\mathrm{LF}} = \\frac{|a|\\Delta x}{2|r|}(1-r^2)$。\n\n-   **色散系数**：\n    -   $E_{\\mathrm{UW}} = -\\frac{a\\Delta x^2}{6}(2|r|-1)(|r|-1)$。\n    -   $E_{\\mathrm{LF}} = \\frac{a\\Delta x^2}{3}(1-r^2)$。\n\n**A. 对于任何 $|r|\\le 1$，两个修正方程都共享一个与 $u_{xxx}$ 成正比的领先三阶导数色散项，其系数依赖于 $r$ 并在 $|r|=1$ 时为零；对于 $0|r|1$，Lax–Friedrichs 格式的领先扩散严格强于迎风格式。**\n短语“领先 ... 色散项”指的是最低阶的非零奇数阶导数项。对于迎风格式，系数 $E_{\\mathrm{UW}}$ 在 $|r|=1$ 和 $|r|=0.5$ 时为零。在 $|r|=0.5$ 时，领先色散项不是三阶导数项，而是更高阶的项。对于 Lax–Friedrichs 格式，$E_{\\mathrm{LF}}$ 在 $|r|=0.5$ 时非零。因此，这两种格式并非“对于任何”$|r|\\le 1$ 都“共享一个领先三阶导数...项”。通用量词“对于任何”使得陈述的第一部分是错误的。\n结论：**错误**。\n\n**B. 对于所有 $|r|\\le 1$，迎风格式的领先扩散严格强于 Lax–Friedrichs 格式；它们仅在 $|r|=0$ 时等价。**\n我们来比较 $0|r|1$ 时的 $\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$。\n比值为 $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{\\frac{|a|\\Delta x}{2|r|}(1-|r|^2)}{\\frac{|a|\\Delta x}{2}(1-|r|)} = \\frac{(1-|r|)(1+|r|)}{|r|(1-|r|)} = \\frac{1+|r|}{|r|} = \\frac{1}{|r|} + 1$。\n对于 $0   |r|  1$，我们有 $\\frac{1}{|r|} > 1$，所以 $\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} > 2$。这意味着 $\\nu_{\\mathrm{LF}} > \\nu_{\\mathrm{UW}}$。该陈述声称的恰恰相反。此外，在 $|r|=0$（$a=0$）时，$\\nu_{\\mathrm{UW}}=0$ 而 $\\nu_{\\mathrm{LF}}=\\frac{\\Delta x^2}{2\\Delta t}$，所以它们不等价。\n结论：**错误**。\n\n**C. 在 $|r|=1$ 时，Lax–Friedrichs 格式的修正方程保留一个非零扩散项，而迎风格式的扩散项为零；因此它们在 $|r|=1$ 时不可能等价。**\n在 $|r|=1$ 时，Lax–Friedrichs 扩散系数为 $\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-1^2) = 0$。它非零的说法是错误的。实际上，在 $|r|=1$ 时，$\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$ 均为零。\n结论：**错误**。\n\n**D. 对于 $|r|>1$，两种格式都保持稳定，且 Lax–Friedrichs 格式的扩散性变得比迎风格式弱。**\n对这两种显式格式的 冯·诺依曼 稳定性分析表明，它们仅在 $|r| \\le 1$ 时稳定。它们在 $|r|>1$ 时稳定的前提是错误的。\n结论：**错误**。\n\n**E. 领先的人工粘性系数满足 $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ 和 $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$，这意味着仅在 $|r|=1$ 时相等，且对于 $0|r|1$ 成立严格不等式 $\\nu_{\\mathrm{LF}}>\\nu_{\\mathrm{UW}}$。**\n这个陈述由三部分组成。\n1.  系数 $\\nu_{\\mathrm{UW}}$ 和 $\\nu_{\\mathrm{LF}}$ 的公式与我们的推导完全匹配。\n2.  相等条件：$\\nu_{\\mathrm{UW}} = \\nu_{\\mathrm{LF}}$ 要求 $\\frac{|a|\\Delta x}{2}(1-|r|) = \\frac{|a|\\Delta x}{2|r|}(1-r^2) = \\frac{|a|\\Delta x}{2|r|}(1-|r|)(1+|r|)$。对于 $|r| \\in [0,1)$，我们可以除以公共的非零因子得到 $1 = \\frac{1+|r|}{|r|}$，这意味着 $|r| = 1+|r|$，或 $0=1$，这是一个矛盾。所以在 $[0,1)$ 中不存在相等的情况。在 $|r|=1$ 时，两个系数都为 $0$，所以它们相等。因此，在稳定性区域内，仅在 $|r|=1$ 时相等。这是正确的。\n3.  对于 $0|r|1$ 的不等式条件：如选项 B 的分析所示，$\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{1}{|r|} + 1 > 2$。因此，对于 $0|r|1$，$\\nu_{\\mathrm{LF}} > \\nu_{\\mathrm{UW}}$ 严格成立。这是正确的。\n这个陈述的所有部分都是正确的。\n结论：**正确**。", "answer": "$$\\boxed{E}$$", "id": "3394635"}]}