{"hands_on_practices": [{"introduction": "我们首先从分析Lax-Wendroff格式的基本性质入手。对于波动解，一个数值格式仅仅稳定是不够的；它还必须以正确的速度传播波。本练习通过计算群速度误差来探讨“数值色散”的概念，这揭示了该格式在传播不同波长的波包时的准确性[@problem_id:3414439]。理解这一点是预测和解释该方法中常见伪振荡的关键。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，在均匀网格 $x_{j} = j\\,\\Delta x$ 和 $t^{n} = n\\,\\Delta t$ 上进行离散。应用由预估步\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\n和校正步\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)\n$$\n定义的两步Lax–Wendroff（也称为Richtmyer两步Lax–Wendroff）格式。\n\n令Courant–Friedrichs–Lewy (CFL)数为 $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$，并通过von Neumann ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ 来分析该格式，其中 $\\theta = k\\,\\Delta x$，空间波数 $k \\in \\mathbb{R}$。放大因子 $G(\\theta)$ 由 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义，数值角频率 $\\omega_{\\mathrm{num}}(\\theta)$ 通过满足 $G(\\theta) = |G(\\theta)|\\exp(-i\\,\\phi(\\theta))$ 的数值相位 $\\phi(\\theta)$ 定义，其中 $\\omega_{\\mathrm{num}}(\\theta) = \\dfrac{\\phi(\\theta)}{\\Delta t}$。数值群速度为 $v_{g,\\mathrm{num}}(\\theta) = \\dfrac{d\\omega_{\\mathrm{num}}}{dk}(\\theta)$，群速度误差为 $E_{g}(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$。\n\n通过对数值色散关系进行微分来计算 $E_{g}(\\theta)$，并找出当 $\\theta \\to 0$ 时其小$\\theta$展开式中的首个非零项。请将您的最终答案表示为关于$\\theta$幂次的最低阶项的单个闭式解析表达式，用 $a$、$\\lambda$ 和 $\\theta$ 表示。无需四舍五入。最终答案必须是单个表达式（而不是方程或不等式），且不得包含单位。", "solution": "用户希望找到应用于线性平流方程的两步Lax-Wendroff格式的群速度误差的最低阶项。\n\n问题始于一维线性平流方程：\n$$\nu_t + a u_x = 0\n$$\n其中 $u = u(x,t)$ 且 $a$ 是一个恒定的波速。\n\nRichtmyer两步Lax-Wendroff格式由以下公式给出：\n预估步：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\n校正步：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)\n$$\nCourant-Friedrichs-Lewy (CFL) 数定义为 $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$。\n\n分析使用von Neumann ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$ 进行，其中 $\\theta = k\\,\\Delta x$ 是无量纲波数，$k$ 是空间波数。放大因子 $G(\\theta)$ 由关系式 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义。\n\n首先，我们必须求出放大因子 $G(\\theta)$。为此，我们可以将两个步骤合并为一个关于 $n$ 时间层上值的 $u_j^{n+1}$ 的单一表达式。\n将 $u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}$ 和 $u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}$（通过将索引 $j$ 移至 $j-1$ 得到）的预估步代入校正步：\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j-1}^{n}\\right) - \\frac{\\lambda}{2}\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\n校正步中的差分项变为：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\left[ \\frac{1}{2}(u_{j+1}^n+u_j^n) - \\frac{\\lambda}{2}(u_{j+1}^n-u_j^n) \\right] - \\left[ \\frac{1}{2}(u_j^n+u_{j-1}^n) - \\frac{\\lambda}{2}(u_j^n-u_{j-1}^n) \\right]\n$$\n$$\n= \\frac{1}{2}(u_{j+1}^n - u_{j-1}^n) - \\frac{\\lambda}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n将此代入校正方程：\n$$\nu_j^{n+1} = u_j^n - \\lambda \\left[ \\frac{1}{2}(u_{j+1}^n - u_{j-1}^n) - \\frac{\\lambda}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) \\right]\n$$\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\lambda^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n这是Lax-Wendroff格式的单步形式。现在，我们应用von Neumann ansatz $u_j^n = \\hat{u}^n e^{ij\\theta}$：\n$$\n\\hat{u}^{n+1} e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - \\frac{\\lambda}{2}(\\hat{u}^n e^{i(j+1)\\theta} - \\hat{u}^n e^{i(j-1)\\theta}) + \\frac{\\lambda^2}{2}(\\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta})\n$$\n除以 $\\hat{u}^n e^{ij\\theta}$，我们得到放大因子 $G(\\theta)$：\n$$\nG(\\theta) = 1 - \\frac{\\lambda}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\lambda^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，我们得到：\n$$\nG(\\theta) = 1 - \\frac{\\lambda}{2}(2i\\sin\\theta) + \\frac{\\lambda^2}{2}(2\\cos\\theta - 2)\n$$\n$$\nG(\\theta) = 1 - i\\lambda\\sin\\theta + \\lambda^2(\\cos\\theta - 1) = [1 - \\lambda^2(1-\\cos\\theta)] - i\\lambda\\sin\\theta\n$$\n数值相位 $\\phi(\\theta)$ 由 $G(\\theta) = |G(\\theta)|e^{-i\\phi(\\theta)}$ 定义。由此，我们有 $\\tan(\\phi(\\theta)) = -\\frac{\\mathrm{Im}(G)}{\\mathrm{Re}(G)}$。\n$$\n\\tan(\\phi(\\theta)) = \\frac{\\lambda\\sin\\theta}{1 - \\lambda^2(1-\\cos\\theta)}\n$$\n因此，数值相位为：\n$$\n\\phi(\\theta) = \\arctan\\left(\\frac{\\lambda\\sin\\theta}{1 - \\lambda^2(1-\\cos\\theta)}\\right)\n$$\n数值角频率为 $\\omega_{\\mathrm{num}}(\\theta) = \\frac{\\phi(\\theta)}{\\Delta t}$。数值群速度为 $v_{g,\\mathrm{num}}(\\theta) = \\frac{d\\omega_{\\mathrm{num}}}{dk}$。\n使用链式法则和 $\\theta = k\\Delta x$，我们有 $\\frac{d}{dk} = \\frac{d\\theta}{dk}\\frac{d}{d\\theta} = \\Delta x \\frac{d}{d\\theta}$。\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{d}{dk}\\left(\\frac{\\phi(\\theta)}{\\Delta t}\\right) = \\frac{\\Delta x}{\\Delta t} \\frac{d\\phi}{d\\theta}\n$$\n因为 $\\lambda = \\frac{a\\Delta t}{\\Delta x}$，所以我们有 $\\frac{\\Delta x}{\\Delta t} = \\frac{a}{\\lambda}$。\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{a}{\\lambda} \\frac{d\\phi}{d\\theta}\n$$\n为了找到小$\\theta$下群速度误差 $E_g(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$ 的最低阶项，我们可以将 $\\phi(\\theta)$ 在 $\\theta=0$ 附近进行泰勒展开。\n我们使用 $\\sin\\theta$、$\\cos\\theta$ 和 $\\arctan(x)$ 的泰勒级数：\n$\\sin\\theta = \\theta - \\frac{\\theta^3}{6} + O(\\theta^5)$\n$\\cos\\theta = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)$\n$\\arctan(x) = x - \\frac{x^3}{3} + O(x^5)$\n\n对于小$\\theta$，arctan函数的参数变为：\n$$\n\\frac{\\lambda(\\theta - \\frac{\\theta^3}{6} + \\dots)}{1 - \\lambda^2(1 - (1 - \\frac{\\theta^2}{2} + \\dots))} = \\frac{\\lambda\\theta - \\frac{\\lambda\\theta^3}{6} + \\dots}{1 - \\frac{\\lambda^2\\theta^2}{2} + \\dots}\n$$\n使用几何级数 $(1-z)^{-1} = 1+z+z^2+\\dots$：\n$$\n\\left(\\lambda\\theta - \\frac{\\lambda\\theta^3}{6} + \\dots\\right)\\left(1 + \\frac{\\lambda^2\\theta^2}{2} + \\dots\\right) = \\lambda\\theta + \\frac{\\lambda^3\\theta^3}{2} - \\frac{\\lambda\\theta^3}{6} + \\dots = \\lambda\\theta + \\left(\\frac{3\\lambda^3-\\lambda}{6}\\right)\\theta^3 + \\dots\n$$\n现在，我们展开 $\\phi(\\theta) = \\arctan(\\dots)$：\n$$\n\\phi(\\theta) = \\left(\\lambda\\theta + \\frac{\\lambda(3\\lambda^2-1)}{6}\\theta^3 + \\dots\\right) - \\frac{1}{3}(\\lambda\\theta + \\dots)^3 + \\dots\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\frac{\\lambda(3\\lambda^2-1)}{6}\\theta^3 - \\frac{\\lambda^3\\theta^3}{3} + O(\\theta^5)\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\left(\\frac{3\\lambda^3-\\lambda - 2\\lambda^3}{6}\\right)\\theta^3 + O(\\theta^5) = \\lambda\\theta + \\frac{\\lambda^3-\\lambda}{6}\\theta^3 + O(\\theta^5)\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\frac{\\lambda(\\lambda^2-1)}{6}\\theta^3 + O(\\theta^5)\n$$\n接下来，我们对 $\\phi(\\theta)$ 关于 $\\theta$ 求导：\n$$\n\\frac{d\\phi}{d\\theta} = \\lambda + \\frac{\\lambda(\\lambda^2-1)}{6}(3\\theta^2) + O(\\theta^4) = \\lambda + \\frac{\\lambda(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\n现在我们计算数值群速度：\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{a}{\\lambda} \\frac{d\\phi}{d\\theta} = \\frac{a}{\\lambda}\\left(\\lambda + \\frac{\\lambda(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\\right)\n$$\n$$\nv_{g,\\mathrm{num}}(\\theta) = a\\left(1 + \\frac{\\lambda^2-1}{2}\\theta^2 + O(\\theta^4)\\right) = a + \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\n群速度误差为 $E_g(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$。\n$$\nE_g(\\theta) = \\left(a + \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\\right) - a = \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\n对于小$\\theta$（假设 $\\lambda^2 \\neq 1$），群速度误差的首个非零项是：\n$$\n\\frac{a(\\lambda^2-1)}{2}\\theta^2\n$$", "answer": "$$\\boxed{\\frac{a \\left(\\lambda^{2} - 1\\right) \\theta^{2}}{2}}$$", "id": "3414439"}, {"introduction": "我们之前的分析是针对具有恒定速度的简单线性平流方程。然而，大多数现实世界的问题都是非线性的，其中波速本身取决于解。本练习解决了在这种情况下如何确保数值稳定性的关键问题[@problem_id:3414458]。我们将学习如何为非线性守恒律调整Courant-Friedrichs-Lewy (CFL)条件，这是将任何显式格式应用于复杂问题的基本技能。", "problem": "考虑标量守恒律 $u_t + f(u)_x = 0$，其中通量 $f \\in C^2(\\mathbb{R})$ 是光滑的，该方程在均匀网格 $x_j = j \\,\\Delta x$，$t^n = n \\,\\Delta t$ 上，通过两步 Lax–Wendroff (Richtmyer) 格式进行离散：\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\big(u_{j+1}^n + u_j^n\\big) - \\frac{\\Delta t}{2 \\,\\Delta x}\\Big(f(u_{j+1}^n)-f(u_j^n)\\Big),\n$$\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\Big(f\\big(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}\\big) - f\\big(u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\big)\\Big).\n$$\n从特征线法可知，局部波速即为特征速度 $a(x,t) = f'(u(x,t))$。对于具有恒定速度 $a$ 的线性平流方程，Lax–Wendroff 格式的 von Neumann 分析得出了对 Courant 数的稳定性限制。在非线性情况下，一种常见的方法是通过在当前状态附近进行线性化来“冻结”系数，然后根据每个时间层上的最大局部特征速度施加稳定性限制。利用此原理，根据空间网格和最大局部特征速度，定义在时间层 $n$ 上的非线性 Courant–Friedrichs–Lewy (CFL) 数，并确定如何选择时间步长 $\\Delta t$，以使格式在空间和时间上一致稳定。\n\n关于定义这样一个非线性 CFL 数和选择 $\\Delta t$ 以确保两步 Lax–Wendroff 格式在空间和时间上一致稳定，以下哪些陈述是有效的？\n\nA. 将非线性 CFL 数 $C^n$ 定义为网格比 $\\Delta t/\\Delta x$ 与时间层 $n$ 上局部特征速度大小的最大值（对 $j$ 取最大）的乘积，然后通过选择 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$ 来施加一个固定的界限 $C^n \\le \\nu$（其中常数 $0  \\nu \\le 1$）。这在每个时间步长上产生一个关于 $j$ 一致的稳定性限制，并通过保持相同的 $\\nu$ 来控制所有时间的稳定性。\n\nB. 使用特征速度的空间平均值来定义非线性 CFL 数，即在一个包含 $N$ 个单元的网格上设置 $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$（其中固定的 $0  \\nu \\le 1$）。这种平均化保证了空间和时间上的一致稳定性，因为大的局部速度会被其他地方的小速度所补偿。\n\nC. 使用特征速度的最小大小来定义非线性 CFL 数，即 $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$（其中固定的 $0  \\nu \\le 1$）。这对于一致稳定性是足够的，因为该格式是中心差分且二阶精确的。\n\nD. 如果存在一个先验不变范围 $I \\subset \\mathbb{R}$，使得对所有的 $j$ 和 $n$ 都有 $u_j^n \\in I$，那么可以定义 $a_* := \\sup_{u\\in I} |f'(u)|$ 并选择一个恒定的时间步长 $\\Delta t = \\nu \\,\\Delta x / a_*$（其中固定的 $0  \\nu \\le 1$），这确保了非线性 CFL 数在所有时间内都受 $\\nu$ 的限制，从而在空间和时间上获得一致的稳定性。\n\nE. 由于两步 Lax–Wendroff 格式是二阶的，因此对于光滑通量 $f$，无论 $\\Delta t/\\Delta x$ 的大小如何，它都是无条件稳定的，所以不需要 CFL 限制来获得空间和时间上的一致稳定性。", "solution": "用户希望我扮演一名 STEM 教授，解决一个关于标量守恒律的两步 Lax-Wendroff 格式稳定性的问题。\n\n### 第 1 步：提取已知条件\n- **控制方程：** 标量守恒律为 $u_t + f(u)_x = 0$。\n- **通量函数：** 通量 $f$ 是光滑的，$f \\in C^2(\\mathbb{R})$。\n- **离散化：** 网格是均匀的，$x_j = j \\,\\Delta x$ 且 $t^n = n \\,\\Delta t$。\n- **数值格式：** 两步 Lax–Wendroff (Richtmyer) 格式由以下公式给出：\n  - 预测步：$u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\big(u_{j+1}^n + u_j^n\\big) - \\frac{\\Delta t}{2 \\,\\Delta x}\\Big(f(u_{j+1}^n)-f(u_j^n)\\Big)$。\n  - 校正步：$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\Big(f\\big(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}\\big) - f\\big(u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\big)\\Big)$。\n- **特征速度：** 局部波速即为特征速度 $a(x,t) = f'(u(x,t))$。\n- **指导原则：** 对于非线性情况，通过在当前状态附近进行线性化（“冻结”系数）来施加基于每个时间层上最大局部特征速度的稳定性限制。\n- **目标：** 在时间层 $n$ 上定义一个非线性 Courant–Friedrichs–Lewy (CFL) 数，并确定如何选择时间步长 $\\Delta t$ 以确保格式在空间和时间上一致稳定。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述具有科学依据、良定且客观。\n1.  **科学或事实上的不健全性：** 该问题基于偏微分方程数值分析中的标准、成熟的概念，即双曲守恒律的 Lax-Wendroff 格式和 Courant-Friedrichs-Lewy (CFL) 稳定性条件。通过“冻结”系数并将线性稳定性分析扩展到非线性问题，并考虑最大局部波速，是一种标准的启发式和理论工具。没有违反科学原则。\n2.  **非形式化或不相关：** 该问题直接且正式地关注 Lax-Wendroff 格式及其稳定性的主题。\n3.  **不完整或矛盾的设置：** 问题提供了数值格式、控制方程以及分析所用原理的完整定义。设置是完整且自洽的。\n4.  **不切实际或不可行：** 所描述的场景是一个标准的计算问题。没有不切实际或不可行的条件。\n5.  **病态或结构不良：** 问题精确，并要求就标准程序给出有效陈述。可以从数值稳定性理论的原理中得出明确的答案。\n6.  **伪深刻、琐碎或同义反复：** 该问题涉及数值偏微分方程中的一个核心、非琐碎的概念：确保非线性问题的稳定性。它需要对局部属性（波速）如何决定全局数值行为（稳定性）有清晰的理解。\n7.  **超出科学可验证性：** 数值格式的稳定性是一个数学上严谨且可验证的领域。\n\n### 第 3 步：结论和行动\n问题陈述是**有效的**。将提供完整解答。\n\n对于双曲偏微分方程，显式有限差分格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定。该条件规定，点 $(x_j, t^{n+1})$ 的数值依赖域必须包含物理依赖域。对于线性平流方程 $u_t + a u_x = 0$（其中速度 $a$ 为常数），Lax-Wendroff 格式当且仅当 Courant 数 $\\nu = |a| \\frac{\\Delta t}{\\Delta x}$ 满足 $\\nu \\le 1$ 时是稳定的。\n\n对于非线性守恒律 $u_t + f(u)_x = 0$，特征速度 $a(u) = f'(u)$ 不是常数，而是依赖于解 $u$。问题指导我们使用冻结系数的原理。这意味着我们在每个时间步 $t^n$ 将问题局部地看作一组线性平流问题，其中每个网格点 $x_j$ 的速度由 $a_j^n = f'(u_j^n)$ 给出。\n\n为了确保在从 $t^n$ 到 $t^{n+1}$ 的时间步长内，整个空间域的稳定性，时间步长 $\\Delta t$ 必须足够小，以满足在时间 $t^n$ 的数值解中存在的*最快*波速的稳定性条件。局部特征速度的最大幅值为 $\\max_j |a_j^n| = \\max_j |f'(u_j^n)|$。\n\n因此，在每个时间步 $n$ 都必须满足的非线性 CFL 条件是：\n$$ \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu_{\\text{max}} $$\n对于 Lax-Wendroff 格式，线性稳定性分析得出 $\\nu_{\\text{max}} = 1$。在实践中，通常会使用一个安全因子，所以条件写为：\n$$ C^n := \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu $$\n其中 $C^n$ 是时间层 $n$ 的非线性 CFL 数，$\\nu$ 是一个选择的常数，使得 $0  \\nu \\le 1$。为了确保所有时间的稳定性，这个条件必须在每个时间步强制执行，这通常导致一个随解演化而变化的自适应时间步长 $\\Delta t^n$。\n\n我们现在基于此原则评估每个选项。\n\n**A. 将非线性 CFL 数 $C^n$ 定义为网格比 $\\Delta t/\\Delta x$ 与时间层 $n$ 上局部特征速度大小的最大值（对 $j$ 取最大）的乘积，然后通过选择 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$ 来施加一个固定的界限 $C^n \\le \\nu$（其中常数 $0  \\nu \\le 1$）。这在每个时间步长上产生一个关于 $j$ 一致的稳定性限制，并通过保持相同的 $\\nu$ 来控制所有时间的稳定性。**\n\n这个陈述正确地将非线性 CFL 数识别为 $C^n = (\\Delta t / \\Delta x) \\max_j |f'(u_j^n)|$。它正确地应用了稳定性由最大波速决定的原理。通过在每个时间层 $n$ 选择时间步长 $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$，CFL 数恰好为 $C^n = \\nu$，满足稳定性约束 $C^n \\le \\nu$。这种自适应时间步长策略是确保非线性双曲问题稳定性的标准有效方法。对其效果的描述是准确的。\n**结论：正确**\n\n**B. 使用特征速度的空间平均值来定义非线性 CFL 数，即在一个包含 $N$ 个单元的网格上设置 $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$（其中固定的 $0  \\nu \\le 1$）。这种平均化保证了空间和时间上的一致稳定性，因为大的局部速度会被其他地方的小速度所补偿。**\n\n这种方法从根本上是错误的。稳定性是一个局部条件。如果单个点 $x_j$ 的波传播得非常快（即 $|f'(u_j^n)|$ 很大），时间步长 $\\Delta t$ 必须足够小以捕捉这种传播。如果在 $f'(u)$ 中存在显著变化，对整个区域的速度进行平均可能会严重低估所需的时间步长限制。一个区域的大局部速度不会被其他地方的小速度“补偿”；它仍然会导致违反依赖域并引起数值不稳定性。\n**结论：不正确**\n\n**C. 使用特征速度的最小大小来定义非线性 CFL 数，即 $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$，并选择 $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$（其中固定的 $0  \\nu \\le 1$）。这对于一致稳定性是足够的，因为该格式是中心差分且二阶精确的。**\n\n这与正确的程序相反。使用最小速度来确定时间步长，如果存在高速区域，将允许一个过大的 $\\Delta t$，导致立即的不稳定。稳定性总是受限于*最快*的过程，而不是最慢的。声称这因为格式是二阶精确就足够了，这是一个不合逻辑的推论；精确度属性不保证稳定性，尤其是不保证一个错误的稳定性准则。\n**结论：不正确**\n\n**D. 如果存在一个先验不变范围 $I \\subset \\mathbb{R}$，使得对所有的 $j$ 和 $n$ 都有 $u_j^n \\in I$，那么可以定义 $a_* := \\sup_{u\\in I} |f'(u)|$ 并选择一个恒定的时间步长 $\\Delta t = \\nu \\,\\Delta x / a_*$（其中固定的 $0  \\nu \\le 1$），这确保了非线性 CFL 数在所有时间内都受 $\\nu$ 的限制，从而在空间和时间上获得一致的稳定性。**\n\n这个陈述描述了一个有效但更具限制性的方法。如果解 $u$ 的一个不变集 $I$ 是*先验*已知的，那么可以找到波速幅值的全局上界 $a_* = \\sup_{u \\in I} |f'(u)|$。由于对所有 $j$ 和 $n$，都有 $u_j^n \\in I$，因此对于所有时间步 $n$，都有 $\\max_j |f'(u_j^n)| \\le a_*$。如果选择一个恒定的时间步长 $\\Delta t = \\nu \\Delta x / a_*$，那么对于任何时间层 $n$，CFL 数为：\n$$ C^n = \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| = \\frac{\\nu \\Delta x / a_*}{\\Delta x} \\max_j |f'(u_j^n)| = \\nu \\frac{\\max_j |f'(u_j^n)|}{a_*} $$\n由于 $\\max_j |f'(u_j^n)| \\le a_*$，我们有 $C^n \\le \\nu$。因此，CFL 条件对于所有时间都用一个单一的、恒定的时间步长得到满足。当这样的界限 $a_*$ 可用时，这是一种正确且通常实用的方法。\n**结论：正确**\n\n**E. 由于两步 Lax–Wendroff 格式是二阶的，因此对于光滑通量 $f$，无论 $\\Delta t/\\Delta x$ 的大小如何，它都是无条件稳定的，所以不需要 CFL 限制来获得空间和时间上的一致稳定性。**\n\n这个陈述是错误的。精确度阶数和稳定性是数值格式的两个不同属性。对于双曲问题，像 Lax-Wendroff 这样的显式格式是条件稳定的，不是无条件稳定的。无条件稳定性通常是隐式格式的特点。Lax-Wendroff 的线性稳定性分析严格证明了它仅在 CFL 条件 $|a| \\Delta t / \\Delta x \\le 1$ 下稳定。只有当格式稳定时，才能达到二阶精确度。\n**结论：不正确**\n\n总而言之，陈述 A 和 D 都描述了确保非线性守恒律的 Lax-Wendroff 格式稳定性的有效方法。陈述 A 描述了一种更通用的自适应时间步长方法，而陈述 D 描述了一种在解的已知不变域这一更严格假设下有效的恒定时间步长方法。", "answer": "$$\\boxed{AD}$$", "id": "3414458"}, {"introduction": "一个数值模拟的准确性取决于其最薄弱的环节，而这通常是边界条件的实施。对于像Lax-Wendroff这样的二阶格式，使用一阶边界条件会损害整体精度。本练习专注于为不同类型的边界（周期性、入流、出流）设计合适的“虚拟单元”策略，以同时保持格式的二阶精度和关键的守恒性[@problem_id:3414477]。", "problem": "考虑一维区域上的单一场变量的标量守恒律，\n$$\nu_t + \\big(f(u)\\big)_x = 0,\\quad x\\in[0,L],\\ t\\ge 0,\n$$\n其中 $u(x,t)$ 是充分光滑的，$f(u)$ 是一个光滑的通量函数。一个均匀的有限体积网格将区域划分为 $N$ 个宽度为 $\\Delta x$ 的控制体，其单元中心索引为 $i=1,2,\\dots,N$，虚拟单元索引为 $i=0$ 和 $i=N+1$。令 $U_i^n$ 表示在时间 $t^n$ 时单元 $i$ 中 $u$ 的单元平均值，时间步长为 $\\Delta t$。使用一个两步 Lax-Wendroff (LW) 方法（预测到 $t^{n+1/2}=t^n+\\Delta t/2$，然后校正到 $t^{n+1}$）来推进 $\\{U_i^n\\}$，每个界面上的数值通量取决于 $t^{n+1/2}$ 时的预测状态，这需要在边界附近 $t^n$ 和 $t^{n+1/2}$ 两个时刻的虚拟单元值。\n\n该格式在离散层面上以守恒形式写出。你的任务是确定在区域边界上的虚拟单元填充策略，以使得两步 LW 方法能同时保持离散守恒性和空间及时间上的二阶精度。假设有以下边界类型：\n\n- 在 $[0,L]$ 上的周期性边界条件。\n- 对于线性平流情况 $f(u)=a\\,u$（其中速度 $a0$ 为常数）的流入/流出边界条件，使得 $x=0$ 处的左边界为流入边界，$x=L$ 处的右边界为流出边界。流入边界数据由光滑函数 $u(0,t)=g(t)$ 指定。\n\n哪个选项指定的边界虚拟单元策略能确保两步 LW 方法的守恒性和二阶精度？\n\nA. 周期性：通过设置 $U_0^n=U_N^n$ 和 $U_{N+1}^n=U_1^n$ 实现循环处理，类似地，$U_0^{n+1/2}=U_N^{n+1/2}$ 和 $U_{N+1}^{n+1/2}=U_1^{n+1/2}$。流入：设置 $U_0^n=g(t^n)$ 并使用二阶时间泰勒展开的边界迹 $U_0^{n+1/2}=g(t^n)+\\frac{\\Delta t}{2}g'(t^n)$。流出：对虚拟单元使用单边二阶空间外推，$U_{N+1}^n=2U_N^n-U_{N-1}^n$，对半时间步预测值也类似处理，$U_{N+1}^{n+1/2}=2U_N^{n+1/2}-U_{N-1}^{n+1/2}$。\n\nB. 周期性：如选项 A 中那样强制循环处理。流入：设置 $U_0^n=g(t^n)$ 并使用 $U_0^{n+1/2}=U_0^n$，不考虑时间变化。流出：复制与边界相邻的内部单元值，$U_{N+1}^n=U_N^n$ 和 $U_{N+1}^{n+1/2}=U_N^{n+1/2}$。\n\nC. 周期性：设置 $U_0^n=\\frac{U_1^n+U_N^n}{2}$ 和 $U_{N+1}^n=\\frac{U_1^n+U_N^n}{2}$，半时间步也类似。流入：使用零梯度条件 $U_0^n=U_1^n$ 和 $U_0^{n+1/2}=U_1^{n+1/2}$。流出：施加 $U_{N+1}^n=g(t^n)$ 和 $U_{N+1}^{n+1/2}=g(t^{n+1/2})$。\n\nD. 周期性：如选项 A 中那样强制循环处理。流入：设置 $U_0^n=g(t^n)$ 并使用一个基于一阶偏微分方程的预测子 $U_0^{n+1/2}=U_0^n+\\frac{\\Delta t}{2}u_t(0,t^n)$，其中 $u_t(0,t^n)=-a\\,u_x(0,t^n)$ 由一阶单边差分 $u_x(0,t^n)\\approx \\frac{U_1^n-U_0^n}{\\Delta x}$ 近似。流出：使用 $U_{N+1}^n=2U_N^n-U_{N-1}^n$ 但保持 $U_{N+1}^{n+1/2}=U_N^{n+1/2}$。\n\n选择正确的选项。", "solution": "我们从标量守恒律的有限体积半离散更新的守恒形式开始，\n$$\n\\frac{d}{dt}U_i(t) = -\\frac{1}{\\Delta x}\\Big(F_{i+\\frac{1}{2}}(t) - F_{i-\\frac{1}{2}}(t)\\Big),\n$$\n其中 $F_{i+\\frac{1}{2}}(t)$ 是在界面 $x_{i+\\frac{1}{2}}$ 处计算（或数值近似）的物理通量 $f(u)$。两步 Lax-Wendroff (LW) 方法通过一个基于时间泰勒展开和空间差分的预测步，在半时间层 $t^{n+\\frac{1}{2}}=t^n+\\frac{\\Delta t}{2}$ 计算界面状态，然后使用这些预测状态来定义 $F_{i+\\frac{1}{2}}^{n+\\frac{1}{2}}$ 并执行到 $t^{n+1}$ 的校正更新，从而达到二阶精度。只要每个单元都使用通量差并且边界通量得到一致处理，该方法就是守恒的：对 $i=1,\\dots,N$ 求和，\n$$\n\\frac{d}{dt}\\sum_{i=1}^N U_i(t) = -\\frac{1}{\\Delta x}\\Big(F_{N+\\frac{1}{2}}(t) - F_{\\frac{1}{2}}(t)\\Big),\n$$\n因此总变化量完全由边界通量 $F_{\\frac{1}{2}}$ 和 $F_{N+\\frac{1}{2}}$ 决定。在离散层面上，\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n - \\frac{\\Delta t}{\\Delta x}\\Big(F_{N+\\frac{1}{2}}^{n+\\frac{1}{2}} - F_{\\frac{1}{2}}^{n+\\frac{1}{2}}\\Big),\n$$\n这表明，如果边界数值通量与物理边界条件一致，并且是根据一个二阶精度的预测子给出的状态计算的，那么守恒性和二阶精度都可以得到保持。\n\n我们分析所需的边界封闭关系：\n\n- 周期性边界。对于一个周期性区域，$x=0$ 处的左边界与 $x=L$ 处的右边界等同。如果在 $i=\\frac{1}{2}$ 处使用的通量等于最后一个和第一个内部单元之间的通量，并且由于周期性循环，$i=N+\\frac{1}{2}$ 处的通量也等于该值，则离散守恒性得到保证。设置 $U_0^n=U_N^n$ 和 $U_{N+1}^n=U_1^n$ （同样地，$U_0^{n+\\frac{1}{2}}=U_N^{n+\\frac{1}{2}}$，$U_{N+1}^{n+\\frac{1}{2}}=U_1^{n+\\frac{1}{2}}$）确保了在边界附近 LW 预测子中使用的中心差分所看到的函数值与周期性延拓一致。这使得边界界面值与周期性副本精确匹配，保持了通量差的伸缩求和特性，并维持了二阶精度，因为周期性迹由虚拟单元精确表示。\n\n- 对于 $f(u)=a\\,u$ 且 $a0$ 的流入边界。在 $x=0$ 处是流入边界，正确的物理边界是 Dirichlet 条件 $u(0,t)=g(t)$。LW 预测子不仅需要 $t^n$ 时刻的边界虚拟状态，也需要 $t^{n+\\frac{1}{2}}$ 时刻的，因为 $x_{1/2}$ 处的通量是在半时间步计算的。时间上二阶精度的边界迹可以从泰勒展开得到\n$$\nu(0,t^{n+\\frac{1}{2}}) = u(0,t^n) + \\frac{\\Delta t}{2}\\,u_t(0,t^n) + \\mathcal{O}(\\Delta t^2).\n$$\n如果 $g(t)$ 是光滑且给定的，我们有 $u(0,t^n)=g(t^n)$ 和 $u_t(0,t^n)=g'(t^n)$，因此设置\n$$\nU_0^n=g(t^n),\\qquad U_0^{n+\\frac{1}{2}}=g(t^n)+\\frac{\\Delta t}{2}g'(t^n)\n$$\n在流入边界处提供了二阶时间精度。在 $i=1$ 附近，LW 预测子的空间二阶精度得以保持，因为中心差分使用了 $U_0^n$ 和 $U_2^n$，而 $U_0^n$ 是精确的边界值。离散守恒性质成立，因为边界数值通量 $F_{\\frac{1}{2}}^{n+\\frac{1}{2}}=f\\big(u(x_{1/2},t^{n+\\frac{1}{2}})\\big)$ 是使用相同的离散化从一致的左右状态计算得出的，并且有限体积更新仍然保持守恒形式。\n\n一个常见的错误是在 $g(t)$ 随时间变化时取 $U_0^{n+\\frac{1}{2}}=U_0^n$。这会破坏边界上的二阶时间精度，并降低全局时间精度阶，因为边界通量在时间上仅为一阶精度。另一个易错点是通过 $u_t=-a\\,u_x$ 来计算 $u_t(0,t^n)$，但仅用一阶单边差分来近似 $u_x(0,t^n)$，这在边界预测子中只产生一阶空间精度；需要一个对 $u_x$ 的二阶单边近似来保持格式的整体阶数。\n\n- 对于在 $x=L$ 处 $f(u)=a\\,u$ 且 $a0$ 的流出边界。流出边界不指定流入信息；在数值上，我们必须避免注入虚假信息，同时在 $i=N$ 附近保持 LW 预测子和校正子的二阶空间精度。一个标准的二阶选择是将解单边线性外推到虚拟单元，\n$$\nU_{N+1}^n = 2\\,U_N^n - U_{N-1}^n,\\qquad U_{N+1}^{n+\\frac{1}{2}} = 2\\,U_N^{n+\\frac{1}{2}} - U_{N-1}^{n+\\frac{1}{2}}.\n$$\n这对应于通过 $U_{N-1}$ 和 $U_N$ 拟合一个局部线性多项式，并在虚拟位置处求值；对于光滑的 $u$，误差为 $\\mathcal{O}(\\Delta x^2)$。因为更新仍然保持守恒的通量差形式，全局守恒性自动满足；流出边界仅仅允许质量通过 $F_{N+\\frac{1}{2}}^{n+\\frac{1}{2}}$ 流出，而没有任何从虚拟单元施加的流入。\n\n我们现在评估每个选项：\n\n选项 A。在 $t^n$ 和 $t^{n+\\frac{1}{2}}$ 两个时刻进行周期性循环处理是保持离散守恒性和二阶精度的正确方法；通量差通过精确的周期性识别进行伸缩求和。在流入处，$U_0^n=g(t^n)$ 和 $U_0^{n+\\frac{1}{2}}=g(t^n)+\\frac{\\Delta t}{2}g'(t^n)$ 精确地是二阶时间泰勒展开的边界迹，确保了半时间步的边界通量在时间上是二阶精度的。在流出处，对 $U_{N+1}$ 在 $t^n$ 和 $t^{n+\\frac{1}{2}}$ 两个时刻使用单边二阶外推保持了空间二阶精度且不注入信息，并且由于更新一致地使用边界通量，格式保持守恒。结论：正确。\n\n选项 B。周期性循环处理是合适的，但流入的半时间步虚拟值 $U_0^{n+\\frac{1}{2}}=U_0^n$ 忽略了 $g(t)$ 的时间变化，在 $g'(t^n)\\ne 0$ 时仅产生一阶时间精度。在流出处，复制 $U_{N+1}^n=U_N^n$ 仅为空间一阶精度，并降低了 $i=N$ 附近 LW 预测子的精度。尽管格式保持守恒形式，但这些选择破坏了二阶精度。结论：不正确。\n\n选项 C。等于平均值 $\\frac{U_1^n+U_N^n}{2}$ 的周期性虚拟值不代表周期性迹，并且通常会破坏守恒性，因为 $F_{\\frac{1}{2}}^{n+\\frac{1}{2}}$ 和 $F_{N+\\frac{1}{2}}^{n+\\frac{1}{2}}$ 将不是内部通量的一致副本；此外，除非 $u$ 恰好在边界附近为常数，否则它对于周期性延拓不是二阶精度的。流入的零梯度条件 $U_0^n=U_1^n$ 忽略了给定的 $g(t)$，可能注入错误的边界状态；流出的施加条件 $U_{N+1}^n=g(t^n)$ 在流出边界不恰当地指定了一个流入值，破坏了物理特征方向和守恒性。结论：不正确。\n\n选项 D。周期性循环处理是好的。在流入处，$U_0^{n+1/2}=U_0^n+\\frac{\\Delta t}{2}u_t(0,t^n)$ 且 $u_t(0,t^n)=-a\\,u_x(0,t^n)$，这是使用偏微分方程(PDE)进行时间泰勒展开在概念上是一致的，但是所提出的近似 $u_x(0,t^n)\\approx \\frac{U_1^n-U_0^n}{\\Delta x}$ 在空间上仅为一阶精度；这将整体边界预测子降为空间一阶，从而降低了全局格式在边界附近的精度。此外，在流出处，此选项保持 $U_{N+1}^{n+\\frac{1}{2}}=U_N^{n+1/2}$，这只是一阶精度，与二阶要求不符。结论：不正确。\n\n因此，在所述的边界类型下，只有选项 A 同时满足两步 LW 方法的离散守恒性和二阶精度要求。", "answer": "$$\\boxed{A}$$", "id": "3414477"}]}