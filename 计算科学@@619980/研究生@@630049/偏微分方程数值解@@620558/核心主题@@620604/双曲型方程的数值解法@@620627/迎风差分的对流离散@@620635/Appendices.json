{"hands_on_practices": [{"introduction": "本节的第一个实践为理解迎风差分格式奠定了基础。我们将分析稳态对流扩散方程，探究为何直观的中心差分格式会产生非物理振荡，而迎风格式又是如何通过引入数值稳定性来修正这一问题。[@problem_id:3374268] 这个练习将使用基本的分析工具，揭示这些格式的核心属性。", "problem": "考虑一维线性平流-扩散偏微分方程 (PDE)\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) \\;=\\; \\nu\\,u_{xx}(x,t),\n$$\n其中平流速度 $a0$ 和扩散系数 $\\nu0$ 为常数，方程定义在间距为 $h0$ 的均匀网格上。网格单元上的佩克莱特数 (Péclet number) 定义为\n$$\n\\mathrm{Pe}_{h} \\;=\\; \\frac{a\\,h}{\\nu}.\n$$\n以下任务要求您从通量平衡和傅里叶模态分析的第一性原理出发进行推导。\n\n(a) 对于通过设置 $u_{t}=0$ 并对内部节点 $\\{x_{j}\\}$ 上的 $u_{x}$ 和 $u_{xx}$ 分别使用二阶中心差分进行离散化所得到的稳态算子，写出在一般内部节点 $x_{j}$ 处的离散三对角算子，并确定在该条件下，所得系数矩阵失去与单调 $M$ 矩阵相关的符号结构，从而在离散解中引入伪振荡的 $\\mathrm{Pe}_{h}$ 条件。\n\n(b) 对于纯平流 PDE\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) \\;=\\; 0,\n$$\n在周期性域上，考虑采用一阶迎风空间离散化（对于 $a0$）的半离散线方法：\n$$\n\\frac{d}{dt}u_{j}(t) \\;=\\; -\\,a\\,\\frac{u_{j}(t)-u_{j-1}(t)}{h},\n$$\n其中 $u_{j}(t)$ 是 $u(x_{j},t)$ 的近似值，且 $x_{j}=j\\,h$。通过代入波数 $k\\in\\mathbb{R}$ 的傅里叶模态 ansatz $u_{j}(t)=\\hat{u}(t)\\,\\exp\\!\\big(i\\,k\\,x_{j}\\big)$，进行冯·诺依曼 (von Neumann)（傅里叶）模态分析，并推导每个傅里叶模态的精确复增长率（特征值）$\\lambda(k)$。确定控制振幅衰减的实部 $-\\,\\sigma(k)$，并证明迎风差分引入的数值扩散在其小波数极限下与修正方程分析的结果一致。\n\n(c) 使用您得到的 $\\sigma(k)$ 表达式，量化网格上可分辨的最高傅里叶模态的衰减率，该模态对应于 $k=\\pi/h$。将您的最终答案表示为仅含 $a$ 和 $h$ 的单个解析表达式。衰减率的物理单位是时间的倒数；用 $\\mathrm{s}^{-1}$ 表示。最终的方框答案中不要包含单位，也无需四舍五入。", "solution": "该问题提出了一系列关于一维线性平流-扩散方程数值分析的任务。问题陈述具有科学依据，提法恰当且客观，为进行严谨分析提供了所有必要信息。因此，该问题被认为是有效的。我们接下来对每个部分进行详细、分步的解答。\n\n(a) 稳态中心差分格式的分析。\n\n通过将时间导数项 $u_t(x,t)$ 设置为 $0$，可以得到稳态平流-扩散方程：\n$$\na\\,u_{x}(x,t) \\;=\\; \\nu\\,u_{xx}(x,t)\n$$\n这可以重排为 $\\nu\\,u_{xx} - a\\,u_x = 0$。我们在间距为 $h$ 的均匀网格上，于内部节点 $x_j=j\\,h$ 处对此方程进行离散化。对一阶和二阶导数使用二阶中心差分近似：\n$$\nu_x(x_j) \\approx \\frac{u_{j+1} - u_{j-1}}{2h}\n$$\n$$\nu_{xx}(x_j) \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\n其中 $u_j$ 是 $u(x_j)$ 的数值近似。将这些近似代入稳态 PDE，得到节点 $j$ 处的离散方程：\n$$\n\\nu \\left( \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} \\right) - a \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) \\;=\\; 0\n$$\n为确定所得三对角系统的系数，我们将方程乘以 $h^2$ 并按节点索引对各项进行分组：\n$$\n\\nu(u_{j+1} - 2u_j + u_{j-1}) - \\frac{a h}{2} (u_{j+1} - u_{j-1}) \\;=\\; 0\n$$\n$$\n\\left(\\nu + \\frac{a h}{2}\\right) u_{j-1} - 2\\nu u_j + \\left(\\nu - \\frac{a h}{2}\\right) u_{j+1} \\;=\\; 0\n$$\n此方程代表了线性系统 $A\\mathbf{u} = \\mathbf{f}$ 的第 $j$ 行。矩阵 $A$ 的该行中的非零元素为：\n$$\nA_{j, j-1} = \\nu + \\frac{a h}{2}, \\quad A_{j, j} = -2\\nu, \\quad A_{j, j+1} = \\nu - \\frac{a h}{2}\n$$\n一个矩阵如果是 Z 矩阵（非对角元素非正）且其逆矩阵为正矩阵，则该矩阵为 $M$ 矩阵。对于不可约的 Z 矩阵，这等价于其对角元素为正。这类矩阵对于离散算子具有理想的性质，包括单调性，这确保了离散解不会出现伪的、非物理的振荡。\n\n为了得到一个对角元素为正的矩阵，我们可以将离散方程乘以 $-1$：\n$$\n-\\left(\\nu + \\frac{a h}{2}\\right) u_{j-1} + 2\\nu u_j - \\left(\\nu - \\frac{a h}{2}\\right) u_{j+1} \\;=\\; 0\n$$\n这种形式对应的矩阵元素为：对角元 $2\\nu$，非对角元 $-(\\nu + \\frac{ah}{2})$ 和 $-(\\nu - \\frac{ah}{2})$。\n由于 $\\nu  0$，对角元 $2\\nu$ 是正的。\n对应于 $u_{j-1}$ 的左非对角元是 $-(\\nu + \\frac{ah}{2})$。因为 $a0$, $h0$ 和 $\\nu0$，该项恒为负。\n对应于 $u_{j+1}$ 的右非对角元是 $-(\\nu - \\frac{ah}{2})$。为了使该元素非正（这是 M 矩阵符号结构的要求），我们必须满足：\n$$\n-\\left(\\nu - \\frac{a h}{2}\\right) \\le 0 \\quad \\implies \\quad \\nu - \\frac{a h}{2} \\ge 0 \\quad \\implies \\quad \\nu \\ge \\frac{a h}{2}\n$$\n两边除以 $\\nu$（因为 $\\nu0$）并整理可得：\n$$\n1 \\ge \\frac{a h}{2\\nu} \\quad \\implies \\quad 2 \\ge \\frac{a h}{\\nu}\n$$\n使用网格佩克莱特数 (Péclet number) 的定义 $\\mathrm{Pe}_h = \\frac{ah}{\\nu}$，维持 M 矩阵符号结构的条件是 $\\mathrm{Pe}_h \\le 2$。当此条件被违反时，矩阵将失去该符号结构，从而失去其单调性保证。因此，矩阵失去所需符号结构的条件是 $\\mathrm{Pe}_h  2$。当 $\\mathrm{Pe}_h  2$ 时，$u_{j+1}$ 的系数变号，导致对角占优性丧失，并允许数值解中出现伪振荡，这是中心差分格式在处理平流主导问题时的一个众所周知的缺陷。\n\n(b) 迎风格式的冯·诺依曼分析。\n\n我们考虑纯平流方程 $u_t + a u_x = 0$（$a0$），使用一阶迎风格式进行空间离散化。节点 $j$ 处的半离散方程为：\n$$\n\\frac{d}{dt}u_{j}(t) \\;=\\; -\\,a\\,\\frac{u_{j}(t)-u_{j-1}(t)}{h}\n$$\n为进行冯·诺依曼稳定性分析，我们代入傅里叶模态 ansatz $u_j(t) = \\hat{u}(t)\\,\\exp(i\\,k\\,x_j)$，其中 $x_j=j\\,h$，$k$ 是波数。\n左边变为：\n$$\n\\frac{d}{dt} \\left( \\hat{u}(t)\\,\\exp(i\\,k\\,j\\,h) \\right) = \\frac{d\\hat{u}}{dt}\\,\\exp(i\\,k\\,j\\,h)\n$$\n右边变为：\n$$\n-\\frac{a}{h} \\left( \\hat{u}(t)\\,\\exp(i\\,k\\,j\\,h) - \\hat{u}(t)\\,\\exp(i\\,k\\,(j-1)\\,h) \\right)\n$$\n将两边相等，并除以公共的非零因子 $\\hat{u}(t)\\,\\exp(i\\,k\\,j\\,h)$，得到模态振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\n\\frac{1}{\\hat{u}} \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\left( 1 - \\exp(-i\\,k\\,h) \\right)\n$$\n该方程的形式为 $\\frac{d\\hat{u}}{dt} = \\lambda(k)\\hat{u}$，其中 $\\lambda(k)$ 是波数为 $k$ 的模态的复增长率（特征值）：\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - \\exp(-i\\,k\\,h) \\right)\n$$\n使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以将 $\\lambda(k)$ 分解为实部和虚部：\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - (\\cos(kh) - i\\sin(kh)) \\right) = -\\frac{a}{h} (1 - \\cos(kh)) - i\\frac{a}{h}\\sin(kh)\n$$\n$\\lambda(k)$ 的实部控制傅里叶模态的振幅演化（衰减或增长）。问题将其定义为 $-\\sigma(k)$：\n$$\n\\mathrm{Re}(\\lambda(k)) = -\\sigma(k) = -\\frac{a}{h}(1 - \\cos(kh))\n$$\n因此，衰减率为 $\\sigma(k) = \\frac{a}{h}(1 - \\cos(kh))$。由于 $a0$，$h0$，且对于所有实数 $k$ 和 $h$，$(1-\\cos(kh)) \\ge 0$，我们有 $\\sigma(k) \\ge 0$。这意味着 $\\mathrm{Re}(\\lambda(k)) \\le 0$，所以所有傅里叶模态都是衰减或稳定的，该格式对所有 $k$ 都是无条件稳定的。对于 $k \\ne 0$ 的非零衰减是数值耗散的标志。\n\n为了证明该数值耗散与修正方程分析一致，我们考察小波数极限，即 $kh \\ll 1$。我们使用 $\\cos(kh)$ 在 $kh=0$ 附近的泰勒级数展开：\n$$\n\\cos(kh) = 1 - \\frac{(kh)^2}{2!} + \\frac{(kh)^4}{4!} - \\dots\n$$\n将其代入 $\\mathrm{Re}(\\lambda(k))$ 的表达式中：\n$$\n\\mathrm{Re}(\\lambda(k)) = -\\frac{a}{h}\\left(1 - \\left[1 - \\frac{k^2h^2}{2} + O(k^4h^4)\\right]\\right) = -\\frac{a}{h}\\left(\\frac{k^2h^2}{2} - O(k^4h^4)\\right) = -\\frac{ah}{2}k^2 + O(h^3k^4)\n$$\n一个傅里叶模态 $\\exp(ikx)$ 在扩散算子 $\\nu_{num} u_{xx}$ 作用下的增长率为 $\\nu_{num}(ik)^2 = -\\nu_{num}k^2$。将此形式与 $\\mathrm{Re}(\\lambda(k))$ 的主导项进行比较，我们确定数值扩散系数为：\n$$\n\\nu_{num} = \\frac{ah}{2}\n$$\n该系数对应于一阶迎风格式的修正方程中的主导误差项，该修正方程为 $u_t + a u_x = \\frac{ah}{2}u_{xx} + O(h^2)$。这证实了冯·诺依曼分析中观察到的衰减确实是修正方程所预测的数值扩散。\n\n(c) 可分辨最高模态的衰减率。\n\n在间距为 $h$ 的网格上，可分辨的最高波数，即奈奎斯特波数 (Nyquist wavenumber)，对应于波长最短的模态，其波长为 $\\lambda_{min} = 2h$。波数 $k$ 与波长 $\\lambda$ 的关系为 $k=2\\pi/\\lambda$。因此，可分辨的最高波数为：\n$$\nk_{max} = \\frac{2\\pi}{2h} = \\frac{\\pi}{h}\n$$\n这个模态通常被称为“2-delta”或“锯齿”模态，因为它以 $2h$ 的周期振荡。为了量化其衰减率，我们将 (b) 部分推导出的 $\\sigma(k)$ 表达式在 $k = \\pi/h$ 处进行求值：\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - \\cos\\left(\\frac{\\pi}{h} \\cdot h\\right)\\right)\n$$\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - \\cos(\\pi)\\right)\n$$\n由于 $\\cos(\\pi) = -1$，衰减率变为：\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - (-1)\\right) = \\frac{a}{h} (2) = \\frac{2a}{h}\n$$\n这就是可分辨的最高傅里叶模态的衰减率。迎风格式在最高波数处耗散性最强，能有效地平滑尖锐的振荡。其物理单位是时间的倒数（$\\mathrm{s}^{-1}$），因为 $a$ 的单位是长度/时间，$h$ 的单位是长度。", "answer": "$$\\boxed{\\frac{2a}{h}}$$", "id": "3374268"}, {"introduction": "在我们理解了数值扩散的基础上，这个实践提供了一种量化其影响的具体方法。通过分别求解连续和离散的稳态对流扩散问题中的边界层，我们可以直接比较物理边界层厚度与数值格式产生的厚度。[@problem_id:3374259] 这个练习突显了我们在离散化中所做选择的实际后果，尤其是在对流主导的情境下。", "problem": "考虑稳态一维对流-扩散偏微分方程 (PDE)\n$$-a\\,u_{x} + \\epsilon\\,u_{xx} = 0 \\quad \\text{on } (0,1),$$\n其中对流速度 $a0$ 和扩散系数 $\\epsilon0$ 是严格为正的常数，边界条件为\n$$u(0)=0, \\quad u(1)=1.$$\n对于 $[0,1]$ 上的任意严格递增剖面 $v(x)$ 和任意固定的 $0  \\alpha  1$，将 $x=1$ 处的边界层厚度定义为满足以下条件的唯一 $\\delta(\\alpha)\\in[0,1]$：\n$$v(1-\\delta(\\alpha))=\\alpha.$$\n你的任务是：\n1) 从该微分方程和边界条件出发，求解连续解 $u(x)$，并利用上述定义，得到连续边界层厚度 $\\delta_{\\mathrm{cont}}(\\alpha)$ 的精确表达式。\n2) 在均匀网格 $x_{i}=i h$（其中 $h=1/N$，$N$ 为正整数）上离散化该偏微分方程，内部节点索引为 $i=1,\\dots,N-1$，并强制 $u_{0}=0$，$u_{N}=1$。对流导数项使用一阶迎风差分，扩散项使用标准的三点二阶中心差分，即\n$$-a\\,\\frac{u_{i}-u_{i-1}}{h}+\\epsilon\\,\\frac{u_{i+1}-2u_{i}+u_{i-1}}{h^{2}}=0.$$\n求解得到的关于 $u_i$ 的线性递推关系的封闭形式解。然后，采用在对流主导极限下以及在距离 $x=1$ 为 $\\mathcal{O}(h)$ 的范围内有效的几何内层近似，确定由 $u_{N-\\delta_{\\mathrm{disc}}(\\alpha)/h}=\\alpha$ 定义的离散边界层厚度 $\\delta_{\\mathrm{disc}}(\\alpha)$，并用 $a$、$\\epsilon$、$h$ 和 $\\alpha$ 显式表示。\n3) 构造比值\n$$R(\\epsilon,h,a) \\equiv \\frac{\\delta_{\\mathrm{disc}}(\\alpha)}{\\delta_{\\mathrm{cont}}(\\alpha)}.$$\n推导 $R(\\epsilon,h,a)$ 的封闭形式解析表达式，并证明它与 $\\alpha$ 无关。在 $a0$ 和 $h0$ 固定的情况下，对 $\\epsilon\\to 0^{+}$ 时的 $R(\\epsilon,h,a)$ 进行渐近解释。\n\n只需提供 $R(\\epsilon,h,a)$ 的最终封闭形式解析表达式作为答案。无需四舍五入，也无需报告单位。", "solution": "这个问题分为三个部分。首先，我们求出连续对流-扩散方程的精确解析解，并推导相应的边界层厚度。其次，我们使用指定的数值格式求解方程的离散版本，并在适当的近似下确定离散边界层厚度。第三，我们计算离散边界层厚度与连续边界层厚度的比值，并分析其行为。\n\n### 第1部分：连续解和边界层厚度\n\n给定的稳态一维对流-扩散方程为：\n$$ \\epsilon\\,u_{xx} - a\\,u_{x} = 0 \\quad \\text{on } (0,1) $$\n其中 $a0$，$\\epsilon0$。这是一个线性、二阶、常系数常微分方程。其特征方程为：\n$$ \\epsilon r^2 - ar = 0 $$\n$$ r(\\epsilon r - a) = 0 $$\n根为 $r_1=0$ 和 $r_2=a/\\epsilon$。因此 $u(x)$ 的通解为：\n$$ u(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x} = C_1 + C_2 \\exp\\left(\\frac{ax}{\\epsilon}\\right) $$\n常数 $C_1$ 和 $C_2$ 由边界条件 $u(0)=0$ 和 $u(1)=1$ 确定。\n应用 $u(0)=0$：\n$$ C_1 + C_2 \\exp(0) = 0 \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2 $$\n应用 $u(1)=1$：\n$$ C_1 + C_2 \\exp\\left(\\frac{a}{\\epsilon}\\right) = 1 $$\n将 $C_1 = -C_2$ 代入第二个方程，得到：\n$$ -C_2 + C_2 \\exp\\left(\\frac{a}{\\epsilon}\\right) = 1 \\implies C_2 \\left(\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1\\right) = 1 $$\n$$ C_2 = \\frac{1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} $$\n从而 $C_1 = -C_2 = -\\frac{1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1}$。\n精确的连续解为：\n$$ u(x) = \\frac{\\exp\\left(\\frac{ax}{\\epsilon}\\right) - 1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} $$\n边界层厚度 $\\delta_{\\mathrm{cont}}(\\alpha)$ 由 $u(1-\\delta_{\\mathrm{cont}}(\\alpha)) = \\alpha$ 定义。将 $x = 1 - \\delta_{\\mathrm{cont}}(\\alpha)$ 代入解中：\n$$ \\frac{\\exp\\left(\\frac{a(1-\\delta_{\\mathrm{cont}})}{\\epsilon}\\right) - 1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} = \\alpha $$\n求解 $\\delta_{\\mathrm{cont}}$：\n$$ \\exp\\left(\\frac{a}{\\epsilon} - \\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) - 1 = \\alpha \\left(\\exp\\left(\\frac{a}{\\epsilon}\\right)-1\\right) $$\n$$ \\exp\\left(\\frac{a}{\\epsilon}\\right) \\exp\\left(-\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) = 1 + \\alpha \\exp\\left(\\frac{a}{\\epsilon}\\right) - \\alpha $$\n$$ \\exp\\left(-\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) = \\frac{1-\\alpha + \\alpha \\exp\\left(\\frac{a}{\\epsilon}\\right)}{\\exp\\left(\\frac{a}{\\epsilon}\\right)} = \\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right) $$\n$$ -\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon} = \\ln\\left(\\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right)\\right) $$\n$$ \\delta_{\\mathrm{cont}}(\\alpha) = -\\frac{\\epsilon}{a} \\ln\\left(\\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right)\\right) $$\n对于将在对流主导极限 ($\\epsilon \\to 0^+$) 下进行的后续分析，我们对该表达式进行近似。在此极限下，$a/\\epsilon \\to \\infty$，因此 $\\exp(-a/\\epsilon) \\to 0$。$\\delta_{\\mathrm{cont}}$ 的表达式简化为：\n$$ \\delta_{\\mathrm{cont}}(\\alpha) \\approx -\\frac{\\epsilon}{a} \\ln(\\alpha) $$\n\n### 第2部分：离散解和边界层厚度\n\n给定的有限差分方程为：\n$$ -a\\,\\frac{u_{i}-u_{i-1}}{h}+\\epsilon\\,\\frac{u_{i+1}-2u_{i}+u_{i-1}}{h^{2}}=0 $$\n乘以 $h^2$ 并重新整理各项，我们得到关于 $u_i$ 的线性递推关系：\n$$ -ah(u_i - u_{i-1}) + \\epsilon(u_{i+1} - 2u_i + u_{i-1}) = 0 $$\n$$ \\epsilon u_{i+1} - (ah + 2\\epsilon)u_i + (ah + \\epsilon)u_{i-1} = 0 $$\n该递推关系的特征方程是：\n$$ \\epsilon r^2 - (ah + 2\\epsilon)r + (ah + \\epsilon) = 0 $$\n系数之和为 $\\epsilon - (ah+2\\epsilon) + (ah+\\epsilon) = 0$，所以 $r_1=1$ 是一个根。根的乘积为 $r_1 r_2 = (ah+\\epsilon)/\\epsilon$。因此，第二个根是：\n$$ r_2 = 1 + \\frac{ah}{\\epsilon} $$\n离散剖面 $u_i$ 的通解为：\n$$ u_i = D_1 (r_1)^i + D_2 (r_2)^i = D_1 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^i $$\n常数 $D_1$ 和 $D_2$ 由边界条件 $u_0=0$ 和 $u_N=1$ 确定。\n对于 $i=0$：$u_0 = D_1 + D_2 = 0 \\implies D_1 = -D_2$。\n对于 $i=N$：$u_N = D_1 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^N = 1$。\n代入 $D_1 = -D_2$：\n$$ -D_2 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^N = 1 \\implies D_2 \\left(\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1\\right) = 1 $$\n$$ D_2 = \\frac{1}{\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1} $$\n离散解为：\n$$ u_i = \\frac{\\left(1+\\frac{ah}{\\epsilon}\\right)^i - 1}{\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1} $$\n我们现在使用定义 $u_{N-\\delta_{\\mathrm{disc}}/h} = \\alpha$ 来求离散边界层厚度 $\\delta_{\\mathrm{disc}}(\\alpha)$。令 $k = \\delta_{\\mathrm{disc}}/h$ 为对应于该层厚度的网格单元数。索引为 $i=N-k$。问题指定使用在对流主导流 ($\\epsilon \\to 0^+$) 和靠近 $x=1$ (小 $k$) 处有效的“几何内层近似”。令 $\\rho = 1 + ah/\\epsilon$。在 $i=N-k$ 处的解是：\n$$ u_{N-k} = \\frac{\\rho^{N-k}-1}{\\rho^{N}-1} = \\frac{\\rho^N \\rho^{-k} - 1}{\\rho^N - 1} $$\n在对流主导的极限下，网格佩克莱特数 (cell Péclet number) $P_h=ah/\\epsilon$ 很大，因此 $\\rho = 1+P_h \\gg 1$。对于足够精细的网格 ($N$ 很大)，$\\rho^N$ 非常大。该近似在于忽略分子和分母中的 $-1$ 项：\n$$ u_{N-k} \\approx \\frac{\\rho^N \\rho^{-k}}{\\rho^N} = \\rho^{-k} $$\n令此式等于 $\\alpha$，得到：\n$$ \\alpha \\approx \\rho^{-k} = \\left(1+\\frac{ah}{\\epsilon}\\right)^{-k} = \\left(1+\\frac{ah}{\\epsilon}\\right)^{-\\delta_{\\mathrm{disc}}/h} $$\n对两边取自然对数：\n$$ \\ln(\\alpha) \\approx -\\frac{\\delta_{\\mathrm{disc}}}{h} \\ln\\left(1+\\frac{ah}{\\epsilon}\\right) $$\n求解 $\\delta_{\\mathrm{disc}}(\\alpha)$：\n$$ \\delta_{\\mathrm{disc}}(\\alpha) \\approx -h \\frac{\\ln(\\alpha)}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} $$\n\n### 第3部分：边界层厚度之比\n\n我们使用从适用于对流主导极限的近似推导出的表达式来构造比值 $R(\\epsilon, h, a) = \\delta_{\\mathrm{disc}}(\\alpha) / \\delta_{\\mathrm{cont}}(\\alpha)$。\n$$ R(\\epsilon,h,a) = \\frac{\\delta_{\\mathrm{disc}}(\\alpha)}{\\delta_{\\mathrm{cont}}(\\alpha)} \\approx \\frac{-h \\frac{\\ln(\\alpha)}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)}}{-\\frac{\\epsilon}{a} \\ln(\\alpha)} $$\n分子和分母中的 $\\ln(\\alpha)$ 项被消去，这表明比值 $R$ 与 $\\alpha$ 无关：\n$$ R(\\epsilon,h,a) = \\frac{h}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} \\frac{a}{\\epsilon} = \\frac{\\frac{ah}{\\epsilon}}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} $$\n这就是该比值的最终封闭形式表达式。\n\n为了进行渐近解释，我们考虑在 $a0$ 和 $h0$ 固定的情况下 $\\epsilon \\to 0^+$ 的极限。这对应于网格佩克莱特数 $P_h = ah/\\epsilon \\to \\infty$。\n$$ \\lim_{\\epsilon\\to 0^+} R(\\epsilon,h,a) = \\lim_{P_h\\to\\infty} \\frac{P_h}{\\ln(1+P_h)} $$\n使用洛必达法则 (L'Hôpital's rule)，该极限为 $\\infty$。这意味着对于非常小的物理扩散 $\\epsilon$，迎风数值格式产生的边界层远厚于真实的物理边界层。迎风格式引入了大量的数值扩散，该数值扩散与网格间距 $h$ 和对流速度 $a$ 成正比，并且这种数值扩散主导了物理扩散 $\\epsilon$，从而人为地加宽了边界层。", "answer": "$$\\boxed{\\frac{\\frac{ah}{\\epsilon}}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)}}$$", "id": "3374259"}, {"introduction": "我们的最后一个实践探讨了在处理可变系数时出现的一个关键而微妙的问题，这在真实的物理模型中很常见。我们将比较用于迎风格式的“守恒”有限体积法和“非守恒”有限差分法。[@problem_id:3374229] 这个练习展示了被离散化的偏微分方程的数学形式如何影响其基本性质，如守恒性和对简单解的保持能力。", "problem": "考虑一个定义在周期性区间 $[0,L]$ 上的非散度形式的线性平流偏微分方程 (PDE) $u_t + a(x)\\,u_x = 0$，其中 $a(x)$ 是一个给定的光滑函数，它可能随空间变化且可能改变符号。设区域被划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀单元，单元中心为 $x_i$，单元界面为 $x_{i\\pm 1/2}$，并定义时间步长为 $\\Delta t$。考虑两种一阶迎风半离散格式：\n\n- 守恒迎风（有限体积）格式 $S_c$：通过以下方式近似守恒律 $u_t + (a(x)\\,u)_x = 0$\n$$\nU_i^{n+1} \\;=\\; U_i^n \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n \\;-\\; F_{i-1/2}^n\\Big),\n$$\n其中迎风数值通量为\n$$\nF_{i+1/2}^n \\;=\\; a_{i+1/2}^+\\,U_i^n \\;+\\; a_{i+1/2}^-\\,U_{i+1}^n,\n$$\n其中 $a_{i+1/2} = a(x_{i+1/2})$, $a_{i+1/2}^+ = \\max\\{a_{i+1/2},\\,0\\}$，且 $a_{i+1/2}^- = \\min\\{a_{i+1/2},\\,0\\}$。\n\n- 非守恒迎风（有限差分）格式 $S_{nc}$：在单元中心通过以下方式离散 $u_t + a(x)\\,u_x = 0$\n$$\nU_i^{n+1} \\;=\\; U_i^n \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) \\;+\\; a_i^-\\,(U_{i+1}^n - U_i^n)\\Big),\n$$\n其中 $a_i = a(x_i)$, $a_i^+ = \\max\\{a_i,\\,0\\}$，且 $a_i^- = \\min\\{a_i,\\,0\\}$。\n\n假设采用周期性边界条件，因此指数按模 $N$ 计算。定义在时间层 $n$ 的离散空间平均值为\n$$\n\\bar{U}^n \\;=\\; \\frac{1}{N}\\sum_{i=1}^N U_i^n.\n$$\n\n对于光滑变量 $a(x)$ 和周期性边界，以下哪个陈述是正确的？\n\nA. 对于任何光滑变量 $a(x)$ 和周期性边界条件，格式 $S_c$ 在时间上精确地保持离散空间平均值 $\\bar{U}^n$ 不变，即对所有 $n$ 都有 $\\bar{U}^{n+1} = \\bar{U}^n$。\n\nB. 对于任何光滑变量 $a(x)$ 和周期性边界条件，格式 $S_{nc}$ 在时间上精确地保持离散空间平均值 $\\bar{U}^n$ 不变，即对所有 $n$ 都有 $\\bar{U}^{n+1} = \\bar{U}^n$。\n\nC. 对于任何光滑变量 $a(x)$，如果初始数据对所有 $i$ 均为常数 $U_i^0 \\equiv C$（其中 $C$ 与 $x$ 无关），那么格式 $S_c$ 在时间上精确地保持解为常数，即对所有 $n$ 都有 $U_i^n \\equiv C$。\n\nD. 对于任何光滑变量 $a(x)$，如果初始数据对所有 $i$ 均为常数 $U_i^0 \\equiv C$（其中 $C$ 与 $x$ 无关），那么格式 $S_{nc}$ 在时间上精确地保持解为常数，即对所有 $n$ 都有 $U_i^n \\equiv C$。", "solution": "该问题提出了两种数值格式，一种是守恒格式 ($S_c$)，另一种是非守恒格式 ($S_{nc}$)，用于求解具有空间变化系数 $a(x)$ 的线性平流方程。我们需要在周期性边界条件下评估关于这些格式性质的四个陈述。\n\n一个关键点在于区分非散度形式的PDE $u_t + a(x)u_x = 0$ 和守恒形式的PDE $u_t + (a(x)u)_x = 0$。这两个方程仅在 $a(x)$ 为常数时等价，因为根据乘法法则，$(a(x)u)_x = a(x)u_x + a'(x)u$。因此，守恒形式等价于 $u_t + a(x)u_x = -a'(x)u$。格式 $S_c$ 明确说明是近似守恒形式，而格式 $S_{nc}$ 则是离散化非散度形式。\n\n我们来逐一分析每个陈述。\n\n### 陈述 A 的分析\n**陈述 A：** 对于任何光滑变量 $a(x)$ 和周期性边界条件，格式 $S_c$ 在时间上精确地保持离散空间平均值 $\\bar{U}^n$ 不变，即对所有 $n$ 都有 $\\bar{U}^{n+1} = \\bar{U}^n$。\n\n离散空间平均值定义为 $\\bar{U}^n = \\frac{1}{N}\\sum_{i=1}^N U_i^n$。为了检验其是否守恒，我们需要分析求和 $\\sum_{i=1}^N U_i^{n+1}$。\n格式 $S_c$ 由下式给出：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\n对所有网格单元 $i=1, \\dots, N$ 求和：\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\n右边的第二项求和是一个伸缩求和：\n$$\n\\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big) = (F_{3/2}^n - F_{1/2}^n) + (F_{5/2}^n - F_{3/2}^n) + \\dots + (F_{N+1/2}^n - F_{N-1/2}^n)\n$$\n消去中间项后，求和简化为：\n$$\n\\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big) = F_{N+1/2}^n - F_{1/2}^n\n$$\n问题陈述了使用周期性边界条件，指数按模 $N$ 计算。这意味着网格点 $x_{i+N} = x_i$ 且单元中心值 $U_{i+N}^n = U_i^n$。因此，界面 $x_{N+1/2}$ 是 $x_{1/2}$ 的一个周期性副本。数值通量 $F_{i+1/2}^n$ 取决于 $a_{i+1/2} = a(x_{i+1/2})$、$U_i^n$ 和 $U_{i+1}^n$。\n对于周期性边界处的通量，我们有：\n$$\nF_{N+1/2}^n = a_{N+1/2}^+ U_N^n + a_{N+1/2}^- U_{N+1}^n\n$$\n根据周期性，$x_{N+1/2}$ 对应于与 $x_{1/2}$ 相同的物理位置，所以 $a_{N+1/2} = a(x_{N+1/2}) = a(x_{1/2}) = a_{1/2}$。同样，$U_{N+1}^n$ 是单元 $N+1$ 中的值，也就是单元 $1$ 的值，所以 $U_{N+1}^n = U_1^n$。因此，\n$$\nF_{N+1/2}^n = a_{1/2}^+ U_N^n + a_{1/2}^- U_1^n\n$$\n通量 $F_{1/2}^n$ 定义为 $F_{1/2}^n = a_{1/2}^+ U_0^n + a_{1/2}^- U_1^n$。根据周期性，单元 $0$ 是单元 $N$，所以 $U_0^n = U_N^n$。\n$$\nF_{1/2}^n = a_{1/2}^+ U_N^n + a_{1/2}^- U_1^n\n$$\n因此，$F_{N+1/2}^n = F_{1/2}^n$，伸缩求和为零。这个性质对于任何在周期性边界条件下写成这种通量差分形式的格式都成立。\n这导致：\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n\n$$\n两边除以 $N$ 得到 $\\bar{U}^{n+1} = \\bar{U}^n$。离散空间平均值是守恒的。\n\n**关于 A 的结论：** 正确。\n\n### 陈述 B 的分析\n**陈述 B：** 对于任何光滑变量 $a(x)$ 和周期性边界条件，格式 $S_{nc}$ 在时间上精确地保持离散空间平均值 $\\bar{U}^n$ 不变，即对所有 $n$ 都有 $\\bar{U}^{n+1} = \\bar{U}^n$。\n\n格式 $S_{nc}$ 由下式给出：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\n对 $i=1, \\dots, N$ 求和：\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^N \\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\n为了使平均值守恒，右侧的求和项对于任何一组值 $\\{U_j^n\\}$ 都必须为零。我们来分析这个和 $S$：\n$$\nS = \\sum_{i=1}^N a_i^+ U_i^n - \\sum_{i=1}^N a_i^+ U_{i-1}^n + \\sum_{i=1}^N a_i^- U_{i+1}^n - \\sum_{i=1}^N a_i^- U_i^n\n$$\n我们对第二和第三个求和进行指数变换，利用周期性（$U_0=U_N$, $U_{N+1}=U_1$ 等）。\n在第二个和中令 $j=i-1$：$\\sum_{i=1}^N a_i^+ U_{i-1}^n = \\sum_{j=0}^{N-1} a_{j+1}^+ U_j^n = \\sum_{j=1}^N a_{j+1}^+ U_j^n$。\n在第三个和中令 $j=i+1$：$\\sum_{i=1}^N a_i^- U_{i+1}^n = \\sum_{j=2}^{N+1} a_{j-1}^- U_j^n = \\sum_{j=1}^N a_{j-1}^- U_j^n$。\n将这些代回并使用 $i$ 作为求和指数：\n$$\nS = \\sum_{i=1}^N a_i^+ U_i^n - \\sum_{i=1}^N a_{i+1}^+ U_i^n + \\sum_{i=1}^N a_{i-1}^- U_i^n - \\sum_{i=1}^N a_i^- U_i^n\n$$\n合并各项：\n$$\nS = \\sum_{i=1}^N \\Big( (a_i^+ - a_{i+1}^+) + (a_{i-1}^- - a_i^-) \\Big) U_i^n\n$$\n对于任意的剖面 $U^n$，这个和为零当且仅当每个 $U_i^n$ 的系数为零，即对所有 $i$ 都有 $a_i^+ - a_{i+1}^+ + a_{i-1}^- - a_i^- = 0$。\n如果 $a(x)$ 是常数，$a_i = a$ 对所有 $i$ 成立，那么 $a_i^+=a_{i+1}^+$ 且 $a_{i-1}^-=a_i^-$，所以条件成立。然而，问题指定了一个*可变的* $a(x)$。让我们考虑一个简单情况，即对所有 $x$ 都有 $a(x)  0$。那么对所有 $i$ 都有 $a_i^+=a_i$ 和 $a_i^-=0$。条件变为 $a_i - a_{i+1} = 0$，这意味着 $a(x)$ 是常数，与前提矛盾。因此，对于一个一般的可变系数 $a(x)$，和 $S$ 不为零，平均值不守恒。\n\n**关于 B 的结论：** 不正确。\n\n### 陈述 C 的分析\n**陈述 C：** 对于任何光滑变量 $a(x)$，如果初始数据对所有 $i$ 均为常数 $U_i^0 \\equiv C$（其中 $C$ 与 $x$ 无关），那么格式 $S_c$ 在时间上精确地保持解为常数，即对所有 $n$ 都有 $U_i^n \\equiv C$。\n\n让我们假设在时间层 $n$，解是常数，即对所有 $j=1, \\dots, N$ 有 $U_j^n = C$。我们使用格式 $S_c$ 检查在时间 $n+1$ 的值。\n首先，我们计算数值通量 $F_{i+1/2}^n$：\n$$\nF_{i+1/2}^n = a_{i+1/2}^+\\,U_i^n + a_{i+1/2}^-\\,U_{i+1}^n\n$$\n代入 $U_i^n = C$ 和 $U_{i+1}^n = C$：\n$$\nF_{i+1/2}^n = a_{i+1/2}^+\\,C + a_{i+1/2}^-\\,C = (a_{i+1/2}^+ + a_{i+1/2}^-)\\,C\n$$\n对于任何实数 $z$，我们有恒等式 $z^+ + z^- = \\max(z,0) + \\min(z,0) = z$。\n因此，$a_{i+1/2}^+ + a_{i+1/2}^- = a_{i+1/2}$。\n通量变为 $F_{i+1/2}^n = a_{i+1/2}\\,C$。这是在 $u=C$ 处计算的精确物理通量 $f(u,x) = a(x)u$。\n现在，我们使用 $S_c$ 的更新规则：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\n代入 $U_i^n=C$ 和通量 $F_{i+1/2}^n = a_{i+1/2}\\,C$ 及 $F_{i-1/2}^n = a_{i-1/2}\\,C$：\n$$\nU_i^{n+1} = C - \\frac{\\Delta t}{\\Delta x} \\Big(a_{i+1/2}\\,C - a_{i-1/2}\\,C\\Big) = C - C\\,\\frac{\\Delta t}{\\Delta x} \\Big(a_{i+1/2} - a_{i-1/2}\\Big)\n$$\n要使 $U_i^{n+1}$ 等于 $C$，项 $C\\,\\frac{\\Delta t}{\\Delta x} (a_{i+1/2} - a_{i-1/2})$ 必须为零。假设 $C \\neq 0$，这要求对所有 $i$ 都有 $a_{i+1/2} = a_{i-1/2}$。这意味着函数 $a(x)$ 是常数，这与 $a(x)$ 是一个可变函数的前提相矛盾。格式 $S_c$ 离散化了 PDE $u_t + (a(x)u)_x=0$。一个常数状态 $u=C \\ne 0$ 是这个 PDE 的解，当且仅当 $(a(x)C)_x = C a'(x)=0$，即当 $a(x)$ 是常数时。由于该格式与此 PDE 相容，当 $a(x)$ 可变时，它正确地将一个常数状态演化为一个非常数状态。\n\n**关于 C 的结论：** 不正确。\n\n### 陈述 D 的分析\n**陈述 D：** 对于任何光滑变量 $a(x)$，如果初始数据对所有 $i$ 均为常数 $U_i^0 \\equiv C$（其中 $C$ 与 $x$ 无关），那么格式 $S_{nc}$ 在时间上精确地保持解为常数，即对所有 $n$ 都有 $U_i^n \\equiv C$。\n\n让我们假设在时间层 $n$ 时，对所有 $j$ 都有 $U_j^n = C$。$S_{nc}$ 的更新规则是：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\n我们将 $U_j^n = C$ 代入所有相关指数：\n差分变为 $U_i^n - U_{i-1}^n = C - C = 0$ 和 $U_{i+1}^n - U_i^n = C - C = 0$。\n更新方程简化为：\n$$\nU_i^{n+1} = C - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(0) + a_i^-\\,(0)\\Big) = C - 0 = C\n$$\n这对任何单元 $i$ 都成立，并且与 $a_i$ 的值无关。因此，如果在时间 $n$ 解是常数，那么在时间 $n+1$ 它仍然是常数。通过归纳法，如果对所有 $i$ 都有 $U_i^0=C$，那么对所有 $n \\ge 0$ 都有 $U_i^n=C$。对于任何旨在求解 $u_t+a(x)u_x=0$ 的格式来说，这个性质是一个基本的相容性要求，因为 $u(x,t)=C$ 是该 PDE 的一个平凡解。\n\n**关于 D 的结论：** 正确。\n\n### 总结\n- 陈述 A 是正确的，因为 $S_c$ 是一个守恒的有限体积格式，对于此类格式，在周期性边界条件下，解的总和是守恒的。\n- 陈述 B 是不正确的，因为 $S_{nc}$ 是一个非守恒的有限差分格式，对于可变系数 $a(x)$，它不能保证空间平均值的守恒。\n- 陈述 C 是不正确的，因为 $S_c$ 是 $u_t + (a(x)u)_x = 0$ 的一个相容离散化，如果 $a(x)$ 是可变的，常数状态不是其解。该格式正确地反映了这一点。\n- 陈述 D 是正确的，因为 $S_{nc}$ 是 $u_t + a(x)u_x = 0$ 的一个相容离散化，常数状态是其解。该格式的空间算子对于常数函数正确地计算为零。\n\n正确的陈述是 A 和 D。", "answer": "$$\\boxed{AD}$$", "id": "3374229"}]}