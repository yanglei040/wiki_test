{"hands_on_practices": [{"introduction": "振幅和相位误差分析的核心在于理解数值格式如何在傅里叶空间中近似导数。这项实践提供了一个基础练习：为一个简单且广泛使用的二阶中心差分格式推导其“有效数值波数”。通过将这个数值波数与真实波数进行比较，我们可以精确地识别出数值色散误差的来源。[@problem_id:3363559]", "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数，方程定义在均匀网格 $x_{j} = j\\,\\Delta x$ 上，$\\Delta x > 0$ 且 $j \\in \\mathbb{Z}$。空间导数 $u_{x}$ 由二阶中心差分算子近似：\n$$\n\\left(D_{0} u\\right)_{j} \\equiv \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\n假设一个离散傅里叶模态为 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$，其无量纲网格波数为 $\\theta \\in [-\\pi,\\pi]$。通过关系式 $D_{0} u_{j} = i\\,\\tilde{k}(\\theta)\\,u_{j}$ 定义有效数值波数 $\\tilde{k}(\\theta)$，因此精确波数为 $k = \\theta / \\Delta x$。在此框架下：\n- 推导与二阶中心差分相关的 $\\tilde{k}(\\theta)$ 的精确表达式。\n- 对 $\\tilde{k}(\\theta)$ 在 $\\theta = 0$ 附近进行关于 $\\theta$ 的幂次泰勒展开，直到并包括 $\\theta^{3}$ 阶项，从而确定相对于 $k$，$\\tilde{k}(\\theta)$ 的主导色散贡献。\n\n请给出 $\\tilde{k}(\\theta)$ 截断至并包括 $\\theta^{3}$ 项的级数作为最终答案。无需四舍五入。将答案表示为 $\\theta$ 和 $\\Delta x$ 的函数，不带单位。角度以弧度为单位。", "solution": "该问题要求推导有效数值波数 $\\tilde{k}(\\theta)$ 的表达式，并对其进行泰勒级数展开。此处的 $\\tilde{k}(\\theta)$ 是针对空间导数 $u_x$ 的二阶中心差分近似。\n\n首先，我们推导 $\\tilde{k}(\\theta)$ 的表达式。题目指出，平流方程 $u_t + a u_x = 0$ 中的空间导数 $u_x$ 由二阶中心差分算子 $(D_0 u)_j$ 近似，其定义为：\n$$\n(D_0 u)_j = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}\n$$\n我们分析该算子对单个离散傅里叶模态 $u_j(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$ 的作用。此处，$j$ 是网格指数，$\\theta$ 是无量纲网格波数，$i = \\sqrt{-1}$，$\\hat{u}(t)$ 是模态随时间变化的振幅。\n\n将 $u_j$ 的傅里叶模态表达式代入差分算子公式，我们得到：\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,(j+1)\\,\\theta) - \\hat{u}(t)\\,\\exp(i\\,(j-1)\\,\\theta)}{2\\,\\Delta x}\n$$\n我们可以提出公因式 $\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$，它等于 $u_j(t)$：\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta) \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right)}{2\\,\\Delta x} = u_j(t) \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x}\n$$\n使用欧拉公式 $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$，我们可以将分子中的项重写为 $2i\\,\\sin(\\theta)$。代回可得：\n$$\n(D_0 u)_j = u_j(t) \\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j(t)\n$$\n题目通过关系式 $D_0 u_j = i\\,\\tilde{k}(\\theta)\\,u_j$ 定义有效数值波数 $\\tilde{k}(\\theta)$。将此定义与我们刚推导出的结果进行比较，我们可以确定 $\\tilde{k}(\\theta)$ 的表达式：\n$$\ni\\,\\tilde{k}(\\theta)\\,u_j = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j\n$$\n这直接给出了二阶中心差分格式的数值波数的精确表达式：\n$$\n\\tilde{k}(\\theta) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n接下来，我们对 $\\tilde{k}(\\theta)$ 在 $\\theta=0$ 附近进行关于 $\\theta$ 的幂次泰勒展开。正弦函数的麦克劳林级数是：\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots = \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5)\n$$\n将此级数代入我们关于 $\\tilde{k}(\\theta)$ 的表达式中：\n$$\n\\tilde{k}(\\theta) = \\frac{1}{\\Delta x} \\left( \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5) \\right)\n$$\n将此展开式截断至包括 $\\theta^3$ 阶项，我们得到：\n$$\n\\tilde{k}(\\theta) \\approx \\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}\n$$\n对于连续傅里叶模态 $\\exp(ikx)$，其精确波数为 $k$。对于离散模态，对应关系是 $k = \\theta/\\Delta x$。展开式的第一项 $\\frac{\\theta}{\\Delta x}$ 精确匹配真实波数 $k$。第二项 $-\\frac{\\theta^3}{6\\,\\Delta x}$ 是主阶误差项。该项是数值色散的来源，因为它导致波的传播速度依赖于波数。推导至此完成。", "answer": "$$ \\boxed{\\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}} $$", "id": "3363559"}, {"introduction": "在数值波数概念的基础上，这项实践将探讨其直接的物理后果——“数值相速度”。我们将看到不同的傅里叶模式如何以错误的速度传播。本练习聚焦于一个关键场景：高频波（例如代表急剧梯度或激波的波）被差分格式严重欠解析，导致其几乎停滞不前，从而在数值解中产生非物理的振荡。[@problem_id:3363508]", "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中波速 $a > 0$ 为常数。设空间域在均匀网格 $x_{j} = j\\,\\Delta x$ 上离散，网格索引 $j \\in \\mathbb{Z}$，网格间距 $\\Delta x > 0$。使用二阶中心差分对空间导数进行离散，得到半离散格式为\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0.\n$$\n假设此半离散系统的时间积分为精确积分，因此该格式不引入数值耗散。通过寻求形式为 $u_{j}(t) = \\hat{u}\\,\\exp\\!\\left(i\\,(j\\,\\theta - \\omega\\,t)\\right)$ 的解，进行离散傅里叶 (von Neumann) 分析，其中 $\\hat{u} \\in \\mathbb{C}$ 是常数振幅，$\\theta \\in [0,\\pi]$ 是以弧度为单位的无量纲波数，$\\omega \\in \\mathbb{R}$ 是角频率。\n\n从这些定义和半离散格式出发，推导色散关系，并由此得到数值相速度 $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$ 关于 $a$ 和 $\\theta$ 的闭式解析表达式，其中 $k = \\theta/\\Delta x$ 是物理波数。然后，利用你的表达式，解释为什么 $\\theta$ 接近 $\\pi$ 的模态是严重欠解析的，并表现出几乎为零的数值相速度，并讨论在产生高波数内容的激波捕捉情境下，这种行为的物理影响。\n\n你的最终答案必须是 $v_{p}^{\\mathrm{num}}(\\theta)$ 关于 $a$ 和 $\\theta$（$\\theta$ 以弧度计）的单一闭式表达式。不需要数值四舍五入。请在你的解答中提供定性讨论，但确保最终方框内的答案只包含所要求的解析表达式。", "solution": "半离散格式由下式给出：\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0\n$$\n我们将模态解 $u_{j}(t) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))$ 代入该格式，进行离散傅里叶分析。首先，我们计算必要的项。时间导数为：\n$$\n\\frac{d u_{j}(t)}{d t} = \\frac{d}{dt} \\left[ \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) \\right] = -i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) = -i\\,\\omega\\,u_{j}(t)\n$$\n空间平移项为：\n$$\nu_{j+1}(t) = \\hat{u}\\,\\exp(i\\,((j+1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(i\\,\\theta) = u_{j}(t)\\,\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}(t) = \\hat{u}\\,\\exp(i\\,((j-1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(-i\\,\\theta) = u_{j}(t)\\,\\exp(-i\\,\\theta)\n$$\n将这些表达式代入半离散方程，得到：\n$$\n-i\\,\\omega\\,u_{j}(t) + a\\,\\frac{u_{j}(t)\\,\\exp(i\\,\\theta) - u_{j}(t)\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n对于非平凡解，我们要求 $u_{j}(t) \\neq 0$，因此我们可以将整个方程除以 $u_{j}(t)$：\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right) = 0\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$，我们可以将括号中的项重写为 $2i\\,\\sin(\\theta)$。方程变为：\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} (2i\\,\\sin(\\theta)) = 0\n$$\n$$\n-i\\,\\omega + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\n求解数值频率 $\\omega$，得到半离散格式的色散关系：\n$$\n\\omega = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\n问题将数值相速度定义为 $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$，其中物理波数为 $k = \\theta/\\Delta x$。代入 $\\omega$ 和 $k$ 的表达式：\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = \\frac{\\omega}{k} = \\frac{\\frac{a\\,\\sin(\\theta)}{\\Delta x}}{\\frac{\\theta}{\\Delta x}}\n$$\n通过消去 $\\Delta x$ 项来简化此表达式，得到数值相速度的最终闭式表达式：\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = a\\,\\frac{\\sin(\\theta)}{\\theta}\n$$\n对于精确的偏微分方程 $u_t + a u_x = 0$，对所有波数，精确相速度均为 $a$。因子 $\\frac{\\sin(\\theta)}{\\theta}$ 代表了数值相速度误差。\n\n我们现在分析 $\\theta$ 接近 $\\pi$ 的模态的行为。无量纲波数 $\\theta = k\\,\\Delta x = \\frac{2\\pi \\Delta x}{\\lambda}$，其中 $\\lambda$ 是波长。范围 $\\theta \\in [0, \\pi]$ 对应于波长 $\\lambda \\in [2\\Delta x, \\infty)$。因此，$\\theta = \\pi$ 对应于网格上可分辨的最短波长 $\\lambda = 2\\Delta x$，这被称为 $2\\Delta x$ 波。\n\n当 $\\theta$ 趋近于 $\\pi$ 时，数值相速度的行为如下：\n$$\n\\lim_{\\theta \\to \\pi} v_{p}^{\\mathrm{num}}(\\theta) = \\lim_{\\theta \\to \\pi} a\\,\\frac{\\sin(\\theta)}{\\theta} = a\\,\\frac{\\sin(\\pi)}{\\pi} = a\\,\\frac{0}{\\pi} = 0\n$$\n这一结果表明，波数在网格截止频率（$\\theta = \\pi$）处或其附近的模态，其数值相速度趋近于零。因此，这些高频分量被二阶中心差分格式严重欠解析；它们几乎变为静止状态，并且不以正确的速度 $a$ 传播。\n\n在激波捕捉的情境中，这种行为的物理影响尤为严重。激波和其他不连续性由宽谱的傅里叶模态表征，其中包括非常高波数的内容。当计算的解中出现此类特征时：\n$1$. 由急剧梯度产生的高波数分量不能被该格式正确传播。它们的移动速度远低于主波前。\n$2$. 这种传播速度上的差异导致这些高频分量滞后于激波，表现为虚假的、非物理的振荡，通常称为“扭曲”或吉布斯现象。\n$3$. 由于该格式是纯色散的，并且不引入数值耗散（根据问题前提，时间积分为精确积分），这些虚假模态中的能量不会被阻尼。相反，它会污染求解域，降低模拟的准确性和物理真实性。这就是为什么简单的中心差分格式不足以模拟带激波问题的主要原因，除非它们通过增加人工耗散或专门的滤波技术来控制或消除高频振荡。", "answer": "$$\\boxed{a\\,\\frac{\\sin(\\theta)}{\\theta}}$$", "id": "3363508"}, {"introduction": "虽然分析单个傅里叶模式富有启发性，但实际的解通常是许多模式的叠加，常形成波包。这最后一项实践运用强大的“稳相法”，将抽象的放大因子与高斯波包的可观测行为联系起来。你将编写一个程序来预测并量化波包位置（群速度误差）、内部相位和振幅的误差，从而在理论分析与计算结果之间建立起一座具体的桥梁。[@problem_id:3363501]", "problem": "考虑一维线性平流偏微分方程 $u_t + c\\,u_x = 0$，定义在一个长度为 $L$ 的周期性域上，具有均匀的空间网格间距 $\\Delta x$ 和离散时间步长 $\\Delta t$。设数值格式的离散傅里叶表示由其放大因子 $G(\\theta)$ 表征，其中 $\\theta \\in [-\\pi,\\pi]$ 是以弧度为单位的离散傅里叶角。经过 $N$ 个时间步后，总耗时为 $T = N\\,\\Delta t$。\n\n您将构建一个窄带高斯波包初始条件，其中心位于位置 $x_0$，载波波数为 $k_0$，包络宽度参数为 $\\sigma$，定义在网格点 $x_j = j\\,\\Delta x$（$j$ 为整数）上，形式如下：\n$$\nu(x,0) = \\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\!\\big(k_0\\,(x-x_0)\\big).\n$$\n假设在 $k_0\\,\\sigma \\gg 1$ 成立的窄带机制下。\n\n使用稳相法，将其应用于数值格式下演化波包的离散傅里叶积分表示，从第一性原理推导以下表达式：\n1. 经过 $N$ 步后预测的包络（群）位移，用数值相位 $\\phi(\\theta) = \\operatorname{arg}\\big(G(\\theta)\\big)$ 及其对 $\\theta$ 的导数在 $\\theta_0 = k_0\\,\\Delta x$ 处的值表示。\n2. 经过 $N$ 步后在包络中心的预测载波相位，相对于包络中心的初始载波相位。\n3. 在主阶窄带近似下，经过 $N$ 步后在中心的预测包络振幅。\n\n提供一个程序，对于给定的 $G(\\theta)$，为每个测试用例计算以下三个标量：\n- 绝对包络位移误差 $|x_{\\text{stat}} - c\\,T|$，其中 $x_{\\text{stat}}$ 是包络中心位移的稳相法预测值，$c\\,T$ 是由物理速度 $c$ 产生的精确平流位移。\n- 包络中心的载波相位误差（以弧度为单位），定义为预测的包络中心载波相位减去纯平流情况下该中心的精确载波相位（对于给定的初始条件和速度 $c$ 的平流，该值为零）。报告在 $[-\\pi,\\pi]$ 内的主值。\n- 绝对包络振幅误差 $||G(\\theta_0)|^N - 1|$，它将主阶数值包络振幅与保持振幅不变的精确平流进行比较。\n\n角度必须以弧度处理。除时间外，所有量均为无量纲量，时间使用与定义 $\\Delta t$ 相同的任意单位进行测量。您的程序不得执行时间步进模拟；它必须仅使用稳相分析和与精确平流的比较。\n\n推导的基本依据：\n- 离散傅里叶模式 $e^{i\\,j\\,\\theta}$ 在一个时间步长内通过乘以 $G(\\theta)$ 进行演化，因此在 $N$ 步之后，它对解的贡献为 $G(\\theta)^N\\,e^{i\\,j\\,\\theta}$。\n- 对于以 $\\theta_0$ 为中心的窄带初始数据，将稳相法应用于离散傅里叶积分，可将波包定域在相位的依赖于 $\\theta_0$ 的稳相点周围，从而得到主阶的包络中心和局部载波相位。\n\n为平流方程的两种广泛使用的一步格式实现 $G(\\theta)$：\n- 一阶迎风格式：$G(\\theta) = 1 - \\lambda + \\lambda\\,e^{-i\\,\\theta}$，其中 $\\lambda = c\\,\\Delta t/\\Delta x$ 满足 $0 \\le \\lambda \\le 1$ 以保证稳定性。\n- Lax–Wendroff 格式：$G(\\theta) = 1 - i\\,\\lambda\\,\\sin\\theta + \\lambda^2\\,(\\cos\\theta - 1)$。\n\n使用恒等式 $\\phi'(\\theta) = \\operatorname{Im}\\!\\big(G'(\\theta)/G(\\theta)\\big)$ 来获得数值相位的导数，其中 $'$ 表示对 $\\theta$ 的导数。\n\n测试套件：\n提供一个程序，为以下每个参数集评估上面列出的三个误差。在每个集合中，角度均以弧度为单位。\n1. $L = 256$，$\\Delta x = 1$，$c = 1$，$\\lambda = 0.8$（因此 $\\Delta t = \\lambda\\,\\Delta x/c$），$N = 25$，$k_0 = \\pi/3$，$\\sigma = 12$，$x_0 = 0$，$G(\\theta)$ 是 Lax–Wendroff 格式。\n2. $L = 256$，$\\Delta x = 1$，$c = 1$，$\\lambda = 0.8$，$N = 25$，$k_0 = \\pi/3$，$\\sigma = 12$，$x_0 = 0$，$G(\\theta)$ 是一阶迎风格式。\n3. $L = 256$，$\\Delta x = 1$，$c = 1$，$\\lambda = 0.8$，$N = 25$，$k_0 = 0.05\\,\\pi$，$\\sigma = 20$，$x_0 = 0$，$G(\\theta)$ 是 Lax–Wendroff 格式。\n4. $L = 256$，$\\Delta x = 1$，$c = 1$，$\\lambda = 0.8$，$N = 25$，$k_0 = 0.95\\,\\pi$，$\\sigma = 20$，$x_0 = 0$，$G(\\theta)$ 是 Lax–Wendroff 格式。\n5. $L = 256$，$\\Delta x = 1$，$c = 1$，$\\lambda = 0.5$，$N = 50$，$k_0 = 0.9\\,\\pi$，$\\sigma = 16$，$x_0 = 0$，$G(\\theta)$ 是一阶迎风格式。\n\n最终输出规范：\n您的程序应生成单行输出，其中包含五个测试用例结果的逗号分隔列表，格式如下：\n- 每个测试用例的结果必须是按 $[\\text{envelope\\_shift\\_error}, \\text{carrier\\_phase\\_error}, \\text{amplitude\\_error}]$ 顺序排列的三个浮点数的列表。\n- 将所有五个列表聚合到一个列表中，并以如下格式精确打印一行文本：\n$$\n[[e_{1},p_{1},a_{1}],[e_{2},p_{2},a_{2}],[e_{3},p_{3},a_{3}],[e_{4},p_{4},a_{4}],[e_{5},p_{5},a_{5}]]\n$$\n其中 $e_i$、$p_i$ 和 $a_i$ 是浮点数。不应打印任何其他文本。", "solution": "目标是分析窄带高斯波包在一维线性平流方程 $u_t + c\\,u_x = 0$ 的数值格式下的演化。我们将使用稳相法推导经过 $N$ 个时间步后的包络位移、载波相位和包络振幅的表达式。\n\n在网格点 $x_j=j\\Delta x$ 和时间 $T=N\\Delta t$ 的解 $u_j^N$ 可以表示为由数值格式传播的初始条件频谱的离散傅里叶逆变换。对于离散傅里叶模式 $e^{i j \\theta}$，单个时间步对应于乘以放大因子 $G(\\theta)$。经过 $N$ 步后，该模式被乘以 $G(\\theta)^N$。因此，通过对所有傅里叶模式 $\\theta \\in [-\\pi, \\pi]$ 进行积分来合成解：\n$$\nu_j^N = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\hat{u}(\\theta, 0) [G(\\theta)]^N e^{i j \\theta} d\\theta\n$$\n其中 $\\hat{u}(\\theta, 0)$ 是初始条件 $u(x,0)$ 的离散傅里叶变换。\n\n初始条件是以 $x_0$ 为中心的高斯波包：\n$$\nu(x,0) = \\exp\\left(-\\frac{(x-x_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\big(k_0\\,(x-x_0)\\big)\n$$\n使用恒等式 $\\cos(\\alpha) = \\frac{1}{2}(e^{i\\alpha} + e^{-i\\alpha})$，我们可以看到傅里叶谱 $\\hat{u}(\\theta,0)$ 将在 $\\theta = \\pm k_0 \\Delta x$ 附近出现尖锐的峰值。令 $\\theta_0 = k_0 \\Delta x$。窄带条件 $k_0 \\sigma \\gg 1$ 确保了包络的傅里叶变换非常窄，因此频谱由两个不同的峰组成。我们可以分别分析来自 $\\theta_0$ 处的峰（前向传播波）和 $-\\theta_0$ 处的峰的贡献。\n\n解的前向传播部分的积分可以写成：\n$$\nu_{j,+}^N \\approx \\int A(\\theta) e^{i \\Phi(\\theta)} d\\theta\n$$\n其中 $A(\\theta)$ 是一个与初始频谱和 $G(\\theta)^N$ 的大小相关的缓变振幅函数，而 $\\Phi(\\theta)$ 是快速振荡的相位。放大因子以极坐标形式写为 $G(\\theta) = |G(\\theta)| e^{i\\phi(\\theta)}$，其中 $\\phi(\\theta)$ 是数值相位。被积函数的总相位是：\n$$\n\\Phi(\\theta) = j\\theta + N\\phi(\\theta) + \\text{phase from } \\hat{u}(\\theta,0)\n$$\n初始条件 $u(x,0)$ 的傅里叶变换贡献了一个近似为 $-i k x_0$ 的相位因子，这对应于离散频谱的相位 $-\\theta x_0/\\Delta x$。因此，总相位为：\n$$\n\\Phi(\\theta) = j\\theta - \\frac{\\theta x_0}{\\Delta x} + N\\phi(\\theta)\n$$\n稳相法通过找到相位为稳态的点 $\\theta_s$（即 $\\frac{d\\Phi}{d\\theta}|_{\\theta_s}=0$）来近似积分。波群在满足此条件的空间位置 $x_j$ 处发生相长干涉。\n$$\n\\frac{d\\Phi}{d\\theta} = j - \\frac{x_0}{\\Delta x} + N\\phi'(\\theta) = 0\n$$\n由于波包在 $\\theta_0$ 附近是窄带的，主要贡献来自该区域。我们在 $\\theta_0$ 处评估稳相条件。演化后波包的中心位于满足以下条件的网格索引 $j_{\\text{center}}$：\n$$\nj_{\\text{center}} - \\frac{x_0}{\\Delta x} + N\\phi'(\\theta_0) = 0\n$$\n\n**1. 预测的包络（群）位移**\n\n从稳相条件，我们求解波包中心的网格索引：\n$$\nj_{\\text{center}} = \\frac{x_0}{\\Delta x} - N\\phi'(\\theta_0)\n$$\n包络中心的物理位置是 $x_{\\text{center}} = j_{\\text{center}}\\Delta x$。\n$$\nx_{\\text{center}} = \\left(\\frac{x_0}{\\Delta x} - N\\phi'(\\theta_0)\\right) \\Delta x = x_0 - N\\Delta x \\phi'(\\theta_0)\n$$\n中心的初始位置是 $x_0$。位移（记为 $x_{\\text{stat}}$）是位置的变化：\n$$\nx_{\\text{stat}} = x_{\\text{center}} - x_0 = -N\\Delta x \\phi'(\\theta_0)\n$$\n这是经过 $N$ 步后包络中心的预测位移。它取决于 $N$、网格间距 $\\Delta x$ 以及在载波波数 $\\theta_0 = k_0 \\Delta x$ 处评估的数值相位导数 $\\phi'(\\theta)$。项 $-\\frac{\\Delta x}{\\Delta t}\\phi'(\\theta_0)$ 代表数值群速度。\n\n**2. 包络中心的预测载波相位**\n\n演化后波包中心的载波相位由总相位函数 $\\Phi(\\theta)$ 在主导波数 $\\theta_0$ 和中心位置 $j_{\\text{center}}$ 处的值给出。\n$$\n\\Phi_{\\text{carrier}} = \\Phi(\\theta_0) \\big|_{j=j_{\\text{center}}} = j_{\\text{center}}\\theta_0 - \\frac{\\theta_0 x_0}{\\Delta x} + N\\phi(\\theta_0)\n$$\n代入 $j_{\\text{center}}$ 的表达式：\n$$\n\\Phi_{\\text{carrier}} = \\left(\\frac{x_0}{\\Delta x} - N\\phi'(\\theta_0)\\right)\\theta_0 - \\frac{\\theta_0 x_0}{\\Delta x} + N\\phi(\\theta_0)\n$$\n$$\n\\Phi_{\\text{carrier}} = \\frac{x_0 \\theta_0}{\\Delta x} - N\\theta_0\\phi'(\\theta_0) - \\frac{\\theta_0 x_0}{\\Delta x} + N\\phi(\\theta_0)\n$$\n$$\n\\Phi_{\\text{carrier}} = N(\\phi(\\theta_0) - \\theta_0\\phi'(\\theta_0))\n$$\n初始条件 $\\cos(k_0(x-x_0))$ 在其中心 $x=x_0$ 处的相位为零。因此，$\\Phi_{\\text{carrier}}$ 表示波包中心相对于其初始相位的相位变化。对于精确的平流方程，波包 $u(x,0)$ 演化为 $u(x-ct,0)$，保持其形状和内部相位结构。因此，中心的精确载波相位变化为 0。推导出的表达式 $\\Phi_{\\text{carrier}}$ 就是数值载波相位误差。\n\n**3. 中心的预测包络振幅**\n\n在主阶窄带近似中，我们认为波包的频谱完全集中在载波波数 $\\theta_0$ 处。该单模态的振幅在 $N$ 步内的演化由乘以 $[G(\\theta_0)]^N$ 控制。该复数因子的振幅为 $|G(\\theta_0)|^N$。初始条件在其中心 $x=x_0$ 处的振幅为 1。因此，忽略色散展宽效应（该效应可由稳相展开中涉及 $\\phi''(\\theta_0)$ 的高阶项捕捉），经过 $N$ 步后包络中心的预测振幅为：\n$$\nA_{\\text{center}} = |G(\\theta_0)|^N\n$$\n平流方程的精确解保持振幅不变，因此真实振幅保持为 1。\n\n**计算量总结**\n\n对于每个测试用例，我们使用 $\\theta_0 = k_0\\Delta x$ 计算以下三个误差度量：\n1.  **绝对包络位移误差：** 精确位移为 $cT = c(N\\Delta t) = N c (\\lambda \\Delta x / c) = N\\lambda\\Delta x$。误差为：\n    $$\n    e = |x_{\\text{stat}} - cT| = |-N\\Delta x \\phi'(\\theta_0) - N\\lambda\\Delta x|\n    $$\n2.  **载波相位误差：** 这是 $\\Phi_{\\text{carrier}}$，取其在 $[-\\pi, \\pi]$ 内的主值：\n    $$\n    p = \\text{wrap}_{[-\\pi, \\pi]} \\Big( N(\\phi(\\theta_0) - \\theta_0\\phi'(\\theta_0)) \\Big)\n    $$\n3.  **绝对包络振幅误差：**\n    $$\n    a = \\Big| |G(\\theta_0)|^N - 1 \\Big|\n    $$\n数值相位 $\\phi(\\theta)$ 及其导数 $\\phi'(\\theta)$ 分别计算为 $\\phi(\\theta) = \\operatorname{arg}(G(\\theta))$ 和 $\\phi'(\\theta) = \\operatorname{Im}(G'(\\theta)/G(\\theta))$。指定格式的放大因子 $G(\\theta)$ 及其导数 $G'(\\theta)$ 是：\n-   **一阶迎风：** $G(\\theta) = 1 - \\lambda + \\lambda e^{-i\\theta}$，$G'(\\theta) = -i\\lambda e^{-i\\theta}$。\n-   **Lax–Wendroff：** $G(\\theta) = 1 - i\\lambda\\sin\\theta + \\lambda^2(\\cos\\theta - 1)$，$G'(\\theta) = -i\\lambda\\cos\\theta - \\lambda^2\\sin\\theta$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes numerical dispersion and dissipation errors for finite difference schemes\n    using stationary phase analysis of a Gaussian wave packet.\n    \"\"\"\n\n    # Define the amplification factors and their derivatives for the schemes.\n    def g_upwind(theta, lam):\n        return 1 - lam + lam * np.exp(-1j * theta)\n\n    def g_prime_upwind(theta, lam):\n        return -1j * lam * np.exp(-1j * theta)\n\n    def g_lw(theta, lam):\n        return 1 - 1j * lam * np.sin(theta) + lam**2 * (np.cos(theta) - 1)\n\n    def g_prime_lw(theta, lam):\n        return -1j * lam * np.cos(theta) - lam**2 * np.sin(theta)\n\n    schemes = {\n        'upwind': {'g': g_upwind, 'g_prime': g_prime_upwind},\n        'lax-wendroff': {'g': g_lw, 'g_prime': g_prime_lw}\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'L': 256, 'dx': 1, 'c': 1, 'lam': 0.8, 'N': 25, 'k0': np.pi/3, 'sigma': 12, 'x0': 0, 'scheme_name': 'lax-wendroff'},\n        {'L': 256, 'dx': 1, 'c': 1, 'lam': 0.8, 'N': 25, 'k0': np.pi/3, 'sigma': 12, 'x0': 0, 'scheme_name': 'upwind'},\n        {'L': 256, 'dx': 1, 'c': 1, 'lam': 0.8, 'N': 25, 'k0': 0.05*np.pi, 'sigma': 20, 'x0': 0, 'scheme_name': 'lax-wendroff'},\n        {'L': 256, 'dx': 1, 'c': 1, 'lam': 0.8, 'N': 25, 'k0': 0.95*np.pi, 'sigma': 20, 'x0': 0, 'scheme_name': 'lax-wendroff'},\n        {'L': 256, 'dx': 1, 'c': 1, 'lam': 0.5, 'N': 50, 'k0': 0.9*np.pi, 'sigma': 16, 'x0': 0, 'scheme_name': 'upwind'}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters\n        dx = case['dx']\n        c = case['c']\n        lam = case['lam']\n        N = case['N']\n        k0 = case['k0']\n        \n        # Get the appropriate scheme functions\n        scheme = schemes[case['scheme_name']]\n        g_func = scheme['g']\n        g_prime_func = scheme['g_prime']\n\n        # Calculate discrete wavenumber and total time\n        theta0 = k0 * dx\n        dt = lam * dx / c\n        T = N * dt\n\n        # Evaluate G and G' at theta0\n        G0 = g_func(theta0, lam)\n        G_prime0 = g_prime_func(theta0, lam)\n\n        # 1. Envelope Displacement Error\n        phi_prime0 = np.imag(G_prime0 / G0)\n        x_stat = -N * dx * phi_prime0\n        x_exact = c * T\n        envelope_shift_error = np.abs(x_stat - x_exact)\n\n        # 2. Carrier Phase Error\n        phi0 = np.angle(G0)\n        carrier_phase_pred = N * (phi0 - theta0 * phi_prime0)\n        # The predicted phase is the error, as exact phase change is 0.\n        # Report principal value in [-pi, pi]\n        carrier_phase_error = (carrier_phase_pred + np.pi) % (2 * np.pi) - np.pi\n\n        # 3. Amplitude Error\n        amplitude_pred = np.abs(G0)**N\n        # Exact amplitude is 1\n        amplitude_error = np.abs(amplitude_pred - 1)\n\n        results.append([envelope_shift_error, carrier_phase_error, amplitude_error])\n\n    # Final print statement in the exact required format without spaces.\n    # The str() representation of a list of lists is desired. Remove spaces for compactness.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "3363501"}]}