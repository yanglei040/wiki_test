{"hands_on_practices": [{"introduction": "这项实践专注于偏微分方程分类的核心机制。通过分析一个常系数偏微分方程的主部，我们将把其系数矩阵的代数性质与坐标系的几何旋转联系起来 [@problem_id:3371555]。这个练习可以巩固我们对双曲型、抛物型和椭圆型方程为何有本质区别的理解，并展示如何通过变量替换将方程简化为其核心的“标准型”，从而消除混合导数项。", "problem": "考虑一个二阶线性偏微分方程 (PDE) 的主部，其形式为 $u_{xx}-4u_{xy}-3u_{yy}$。二阶线性偏微分方程的分类基于其主部系数构成的对称 $2 \\times 2$ 矩阵及其特征值的符号。变量的正交变换对应于坐标轴的旋转，它能保持方程类型不变，同时可以实现对主部的对角化。\n\n仅从这些定义和事实出发，完成以下任务：\n\n1. 通过确定其二次型的对称系数矩阵的特征值的符号，对偏微分方程 $u_{xx}-4u_{xy}-3u_{yy}$ 进行分类，并说明其类型。\n2. 对空间坐标 $(x,y) \\mapsto (\\xi,\\eta)$ 进行一次正交旋转，以消除混合导数项。明确求出旋转角 $\\theta$（以弧度为单位），并选择主值 $\\theta \\in (-\\pi/2,\\pi/2)$。\n3. 利用此旋转，将主部写成不含混合导数的典范形式，然后对旋转后的坐标进行伸缩变换，使得双曲型典范形式的系数为单位系数，即 $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$ 的形式。\n\n将你的最终答案表示为旋转角 $\\theta$ 的精确值（以弧度为单位）。不需要四舍五入，角度应以弧度给出。", "solution": "该问题要求对一个给定的二阶线性偏微分方程（PDE）进行分类并将其转换为典范形式。分析基于该PDE的主部，即 $u_{xx}-4u_{xy}-3u_{yy}$。\n\n在两个变量 $x$ 和 $y$ 中，二阶线性偏微分方程主部的一般形式为 $A u_{xx} + B u_{xy} + C u_{yy}$。对于给定的方程，我们确定其系数：\n$A = 1$\n$B = -4$\n$C = -3$\n\n该PDE的分类取决于与此二次型相关的对称系数矩阵的性质。该矩阵记为 $M$，构造如下：\n$$\nM = \\begin{pmatrix} A  \\frac{B}{2} \\\\ \\frac{B}{2}  C \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ -2  -3 \\end{pmatrix}\n$$\n\n**1. PDE的分类**\n\nPDE的类型由矩阵 $M$ 的特征值的符号决定。特征值记为 $\\lambda$，是特征方程 $\\det(M - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} 1-\\lambda  -2 \\\\ -2  -3-\\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到特征多项式：\n$$\n(1-\\lambda)(-3-\\lambda) - (-2)(-2) = 0\n$$\n$$\n-3 - \\lambda + 3\\lambda + \\lambda^2 - 4 = 0\n$$\n$$\n\\lambda^2 + 2\\lambda - 7 = 0\n$$\n我们使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(-7)}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 + 28}}{2} = \\frac{-2 \\pm \\sqrt{32}}{2} = \\frac{-2 \\pm 4\\sqrt{2}}{2}\n$$\n两个特征值为：\n$$\n\\lambda_1 = -1 + 2\\sqrt{2} \\quad \\text{和} \\quad \\lambda_2 = -1 - 2\\sqrt{2}\n$$\n为了确定它们的符号，我们注意到 $\\sqrt{2} \\approx 1.414$，所以 $2\\sqrt{2} = \\sqrt{8} \\approx 2.828$。\n因此，$\\lambda_1 = -1 + 2\\sqrt{2} > 0$ 且 $\\lambda_2 = -1 - 2\\sqrt{2}  0$。\n由于特征值符号相反（$\\lambda_1 \\lambda_2 = \\det(M) = (1)(-3) - (-2)(-2) = -7  0$），该PDE被分类为**双曲型**。\n\n这个结果可以用判别式 $\\Delta = B^2 - 4AC$ 来验证：\n$$\n\\Delta = (-4)^2 - 4(1)(-3) = 16 + 12 = 28 > 0\n$$\n正的判别式也表示方程是双曲型的。\n\n**2. 消除混合导数的正交旋转**\n\n将坐标系 $(x,y)$ 正交旋转到新坐标系 $(\\xi,\\eta)$ 可以使矩阵 $M$ 对角化。这对应于找到一个与 $M$ 的特征向量对齐的坐标系，从而消除混合偏导数项 $u_{\\xi\\eta}$。实现这一点所需的旋转角 $\\theta$ 由以下公式给出：\n$$\n\\tan(2\\theta) = \\frac{B}{A-C}\n$$\n代入系数 $A=1$，$B=-4$ 和 $C=-3$：\n$$\n\\tan(2\\theta) = \\frac{-4}{1 - (-3)} = \\frac{-4}{4} = -1\n$$\n我们需要在主值区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 内找到 $\\theta$。这意味着 $2\\theta$ 必须在区间 $(-\\pi, \\pi)$ 内。反正切函数的主值给出：\n$$\n2\\theta = \\arctan(-1) = -\\frac{\\pi}{4}\n$$\n求解 $\\theta$：\n$$\n\\theta = -\\frac{\\pi}{8}\n$$\n该值位于指定的区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 内。\n\n**3. 典范形式**\n\n坐标旋转由以下公式给出：\n$$\n\\begin{pmatrix} \\xi \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\n$$\n在此变换下，PDE的主部变换为：\n$$\nA u_{xx} + B u_{xy} + C u_{yy} \\longrightarrow \\lambda_{\\xi} u_{\\xi\\xi} + \\lambda_{\\eta} u_{\\eta\\eta}\n$$\n其中 $\\lambda_{\\xi}$ 和 $\\lambda_{\\eta}$ 是 $M$ 的特征值。特征值到新坐标轴的具体分配取决于旋转的选择。对于我们选择的 $\\theta = -\\frac{\\pi}{8}$，新的系数就是特征值 $\\lambda_1$ 和 $\\lambda_2$。我们来确定这种对应关系。微分算子的变换导致二次型被对角化为 $\\lambda_1 \\partial_{\\xi'}^2 + \\lambda_2 \\partial_{\\eta'}^2$，其中新坐标轴与特征向量对齐。算子变为：\n$$\n(-1+2\\sqrt{2}) u_{\\xi\\xi} + (-1-2\\sqrt{2}) u_{\\eta\\eta}\n$$\n这就是不含混合导数的典范形式。\n\n最后一步是对坐标 $(\\xi, \\eta)$ 进行伸缩变换，得到新坐标 $(\\tilde{\\xi}, \\tilde{\\eta})$，以使系数的绝对值为1，从而达到 $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$ 的形式。\n设典范形式写作 $\\lambda_1 u_{\\xi\\xi} + \\lambda_2 u_{\\eta\\eta}$，其中 $\\lambda_1 = 2\\sqrt{2}-1 > 0$ 且 $\\lambda_2 = -1-2\\sqrt{2}  0$。\n我们定义伸缩变换如下：\n$$\n\\tilde{\\xi} = \\sqrt{\\lambda_1} \\xi = \\sqrt{2\\sqrt{2}-1} \\xi\n$$\n$$\n\\tilde{\\eta} = \\sqrt{|\\lambda_2|} \\eta = \\sqrt{1+2\\sqrt{2}} \\eta\n$$\n根据链式法则可得：\n$u_{\\xi} = \\frac{d\\tilde{\\xi}}{d\\xi} u_{\\tilde{\\xi}} = \\sqrt{2\\sqrt{2}-1} \\ u_{\\tilde{\\xi}} \\implies u_{\\xi\\xi} = (2\\sqrt{2}-1) u_{\\tilde{\\xi}\\tilde{\\xi}}$\n$u_{\\eta} = \\frac{d\\tilde{\\eta}}{d\\eta} u_{\\tilde{\\eta}} = \\sqrt{1+2\\sqrt{2}} \\ u_{\\tilde{\\eta}} \\implies u_{\\eta\\eta} = (1+2\\sqrt{2}) u_{\\tilde{\\eta}\\tilde{\\eta}}$\n\n将这些代入典范形式中：\n$$\n(2\\sqrt{2}-1) u_{\\xi\\xi} - (1+2\\sqrt{2}) u_{\\eta\\eta} = (2\\sqrt{2}-1) \\frac{u_{\\tilde{\\xi}\\tilde{\\xi}}}{2\\sqrt{2}-1} - (1+2\\sqrt{2}) \\frac{u_{\\tilde{\\eta}\\tilde{\\eta}}}{1+2\\sqrt{2}}\n$$\n这可以简化为目标中的系数为单位的双曲型形式：\n$$\nu_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}\n$$\n问题要求旋转角 $\\theta$ 的精确值。根据我们的推导，这个角度是 $-\\frac{\\pi}{8}$ 弧度。", "answer": "$$\n\\boxed{-\\frac{\\pi}{8}}\n$$", "id": "3371555"}, {"introduction": "现实世界的问题通常涉及系数在空间上变化的偏微分方程。这项练习要求我们超越常系数的范畴，确定方程在整个求解域上的类型 [@problem_id:3371537]。我们将计算作为空间变量函数的判别式，并构建一个“分类图”，以识别出方程呈双曲型、抛物型或椭圆型的区域，这对于选择合适的局部数值方法至关重要。", "problem": "考虑在两个空间变量上的二阶线性偏微分方程（PDE）：\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0,$$\n该方程定义在坐标为 $(x,y)$ 的平面 $\\mathbb{R}^{2}$ 上。从二阶线性双变量偏微分方程类型分类的核心定义出发——即，对于写成 $A\\,u_{xx}+2\\,B\\,u_{xy}+C\\,u_{yy}$ 形式的主部，判别式 $D$ 定义为 $D=B^{2}-A\\,C$——请执行以下操作：\n\n(1) 确定给定偏微分方程的主部系数 $A$、$B$ 和 $C$，并推导出判别式 $D(x)$ 关于 $x$ 的显式解析表达式。\n\n(2) 仅使用 $D(x)$ 的符号和偏微分方程类型的标准定义（若 $D0$ 为椭圆型，若 $D=0$ 为抛物型，若 $D0$ 为双曲型），构建 $(x,y)$ 平面上的分区域类型图，精确指出哪些区域是椭圆型、抛物型或双曲型。请明确说明方程类型是否依赖于 $x$ 和/或 $y$。\n\n(3) 找出平面上满足 $D(x)=0$ 的所有实曲线（如果存在），这些曲线标志着抛物型退化。如果不存在这样的曲线，请根据你的 $D(x)$ 表达式直接证明此结论。\n\n(4) 简要解释你的分类图对于特征曲线的定性结构以及针对双曲型与椭圆型问题选择数值格式的意义，将你的讨论建立在 $D(x)$ 的符号和主部的基础上。\n\n你最终报告的答案必须是判别式 $D(x)$ 的简化解析表达式。无需四舍五入。最终答案中不要包含单位。", "solution": "该问题要求对一个给定的二阶线性偏微分方程（PDE）进行分类，分析其在整个定义域上的类型，并讨论其意义。第一步是验证问题陈述的有效性。\n\n### 步骤 1：提取已知信息\n提供的信息如下：\n- 偏微分方程：$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0$。\n- 定义域是坐标为 $(x,y)$ 的平面 $\\mathbb{R}^{2}$。\n- 主部的一般形式是 $A\\,u_{xx}+2\\,B\\,u_{xy}+C\\,u_{yy}$。\n- 判别式的定义是 $D=B^{2}-A\\,C$。\n- 分类标准是：\n  - 若 $D0$，为椭圆型。\n  - 若 $D=0$，为抛物型。\n  - 若 $D0$，为双曲型。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题具有科学依据，因为它涉及二阶线性偏微分方程的标准分类，这是数学物理和数值分析中的一个基本课题。所给定义和方程均为标准且正确。问题是适定的，提供了确定系数、计算判别式和对方程进行分类所需的所有必要信息。语言客观、精确。不存在矛盾、缺失数据或不科学的前提。该问题有效。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n分析将根据问题陈述的四个部分展开。\n\n**(1) 确定系数与推导判别式**\n\n给定的偏微分方程是：\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0$$\n为了对该方程进行分类，我们将其与二阶线性双变量偏微分方程主部的一般形式进行比较：\n$$A(x,y)\\,u_{xx}+2\\,B(x,y)\\,u_{xy}+C(x,y)\\,u_{yy} + \\text{低阶项} = 0$$\n通过直接比较，我们确定给定偏微分方程的系数 $A$、$B$ 和 $C$：\n- $u_{xx}$ 的系数是 $A = 1$。\n- $u_{xy}$ 的系数是 $2(1-x)$，因此 $2B = 2(1-x)$，得到 $B = 1-x$。\n- $u_{yy}$ 的系数是 $-(1+x^2)$，因此 $C = -(1+x^2)$。\n\n判别式 $D$ 定义为 $D = B^{2} - A\\,C$。代入已确定的系数，我们推导出判别式作为 $x$ 的函数：\n$$D(x) = (1-x)^{2} - (1)\\left(-(1+x^{2})\\right)$$\n展开各项，我们得到：\n$$D(x) = (1 - 2x + x^{2}) + (1+x^{2})$$\n合并同类项，得到判别式的简化解析表达式：\n$$D(x) = 2x^{2} - 2x + 2$$\n这也可以写成因式分解形式 $D(x) = 2(x^2 - x + 1)$。\n\n**(2) $(x,y)$ 平面上的分类图**\n\n偏微分方程的类型（椭圆型、抛物型或双曲型）由判别式 $D(x) = 2x^{2} - 2x + 2$ 的符号决定。系数 $A$、$B$ 和 $C$ 仅依赖于变量 $x$，因此判别式 $D$ 和偏微分方程的类型也仅依赖于 $x$，而不依赖于 $y$。\n\n为了确定 $D(x)$ 的符号，我们分析二次多项式 $p(x) = x^{2} - x + 1$。$D(x)$ 的符号与 $p(x)$ 的符号相同，因为 $D(x)=2p(x)$ 且 $2>0$。我们可以通过使用二次公式检查其是否有实根来确定 $p(x)$ 的符号，其中多项式本身的判别式（而非偏微分方程的判别式）是 $\\Delta = b^2 - 4ac$。对于 $p(x)=x^2-x+1$，我们有 $a=1$，$b=-1$ 和 $c=1$。\n$$\\Delta = (-1)^{2} - 4(1)(1) = 1 - 4 = -3$$\n由于 $\\Delta  0$ 且首项系数 $a=1$ 为正，二次多项式 $p(x)$ 没有实根，并且对于所有实数 $x$ 都严格为正。\n\n或者，我们可以对 $p(x)$ 进行配方：\n$$p(x) = x^{2} - x + 1 = \\left(x^{2} - x + \\frac{1}{4}\\right) - \\frac{1}{4} + 1 = \\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}$$\n由于对于所有 $x \\in \\mathbb{R}$，$\\left(x-\\frac{1}{2}\\right)^2 \\ge 0$，所以 $p(x)$ 的最小值为 $\\frac{3}{4}$，在 $x=\\frac{1}{2}$ 处取得。因此，对于所有 $x$，$p(x) > 0$。\n\n因此，该偏微分方程的判别式 $D(x) = 2 p(x) = 2\\left(\\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}\\right)$，对于所有 $x \\in \\mathbb{R}$ 都严格为正。\n$$D(x) > 0 \\quad \\forall (x,y) \\in \\mathbb{R}^{2}$$\n根据分类标准：\n- **椭圆型 ($D  0$)**：该偏微分方程永远不是椭圆型。\n- **抛物型 ($D = 0$)**：该偏微分方程永远不是抛物型。\n- **双曲型 ($D > 0$)**：对于平面 $\\mathbb{R}^{2}$ 中的所有点 $(x,y)$，该偏微分方程都是双曲型。\n\n分类图是统一的：整个 $(x,y)$ 平面都是双曲型区域。\n\n**(3) 抛物型退化曲线**\n\n抛物型退化发生在判别式为零的点，即 $D(x) = 0$。\n$$2x^{2} - 2x + 2 = 0$$\n两边同除以 2，我们得到方程：\n$$x^{2} - x + 1 = 0$$\n如第 (2) 部分所述，该二次方程没有实数解 $x$。因此，在 $(x,y)$ 平面上不存在使 $D(x)=0$ 的实曲线。该偏微分方程永远不是抛物型，也不表现出任何抛物型退化。\n\n**(4) 对特征曲线和数值格式的意义**\n\n判别式 $D(x)$ 恒为正这一事实，对解的行为和数值方法的选择具有重要意义。\n\n- **特征曲线**：由于该偏微分方程处处是双曲型（$D > 0$），因此通过 $(x,y)$ 平面上的任意一点，都存在两个不同的实特征曲线族。这些曲线表示信息（或导数的不连续性）传播的路径。特征曲线的方程由 $A\\,(dy)^2 - 2B\\,dy\\,dx + C\\,(dx)^2 = 0$ 给出。代入我们的系数：\n$$(1)(dy)^2 - 2(1-x)\\,dy\\,dx + (-(1+x^2))(dx)^2 = 0$$\n特征线的斜率 $\\frac{dy}{dx}$ 是以下二次方程的根：\n$$\\left(\\frac{dy}{dx}\\right)^2 - 2(1-x)\\frac{dy}{dx} - (1+x^2) = 0$$\n斜率的解为 $\\frac{dy}{dx} = (1-x) \\pm \\sqrt{(1-x)^2 + (1+x^2)} = (1-x) \\pm \\sqrt{2x^2-2x+2}$。由于根号下的项恰好是判别式 $D(x) = 2x^2-2x+2$，而该判别式恒为正，因此总存在两个不同的实斜率。这种结构是波动现象的典型特征。\n\n- **数值格式**：方程的分类决定了应采用哪类数值算法。对于像这样的**双曲型**方程，通常提出初值问题（例如，在初始时刻指定 $u$ 及其时间导数）。数值方法必须尊重沿特征线的信息流方向。合适的格式包括显式有限差分法（如迎风格式、Lax-Friedrichs 格式或 MacCormack 格式）或特征线法。这些显式方法通常受到一个稳定性约束，即 Courant-Friedrichs-Lewy (CFL) 条件的限制，该条件限制了时间步长相对于空间网格间距的大小，以确保数值依赖域能够包含真实的物理依赖域。\n\n相反，如果该偏微分方程是**椭圆型**（$D  0$），它将模拟一个稳态过程，其解由封闭域上的边界条件决定。合适的数值方法将是用于求解所得线性方程组的迭代求解器，如 Jacobi 法或 Gauss-Seidel 法。\n\n由于给定的偏微分方程处处是双曲型，一个为双曲型系统设计的数值格式可以统一应用于整个计算域。无需使用在椭圆型和双曲型求解器之间切换的混合格式，而这对于混合型偏微分方程是必需的。", "answer": "$$\\boxed{2x^{2} - 2x + 2}$$", "id": "3371537"}, {"introduction": "当我们将连续的偏微分方程转化为用于计算机模拟的离散近似时，数值模型是否能保持原方程的类型？这项高级实践通过傅里叶分析探讨了这一关键问题 [@problem_id:3371567]。我们将看到，针对混合导数项的不同有限差分格式会如何改变*离散*判别式，甚至可能引入人为效应，将一个抛物型问题在离散层面转变为类似双曲型的行为。这突显了数值格式设计对解的保真度的深远影响。", "problem": "考虑一个形式为 $a \\, u_{xx} + 2 b \\, u_{xy} + c \\, u_{yy} = 0$ 的二维二阶线性偏微分方程 (PDE)，其中 $a$、$b$ 和 $c$ 是常系数，$u_{xx}$、$u_{xy}$ 和 $u_{yy}$ 表示一个足够光滑的函数 $u(x,y)$ 的二阶偏导数。这类偏微分方程的分类由连续判别式 $D = b^2 - a c$ 的符号决定：如果 $D  0$，方程是双曲型的；如果 $D = 0$，它是抛物型的；如果 $D  0$，它是椭圆型的。在偏微分方程的数值求解中，离散近似会改变有效的主部，从而改变判别式的离散模拟，可能导致在离散层面上的错误分类。本问题研究混合导数项中的离散迎风格式如何使离散判别式产生偏差，并将一个在连续意义上是抛物型的偏微分方程推向一个类双曲的状态。\n\n从二维主部的偏微分方程分类基本定义，以及在间距为 $h_x  0$ 和 $h_y  0$ 的均匀笛卡尔网格上的标准有限差分近似出发。考虑混合导数 $u_{xy}$ 的两个相容的线性差分格式：\n- 对称中心差分格式 $u_{xy} \\approx \\dfrac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4 h_x h_y}$。\n- 一种通过顺序单边差分构造的单边“迎风”混合格式，$u_{xy} \\approx D_y^- D_x^+ u$，其中 $D_x^+ u_{i,j} = \\dfrac{u_{i+1,j} - u_{i,j}}{h_x}$ 且 $D_y^- v_{i,j} = \\dfrac{v_{i,j} - v_{i,j-1}}{h_y}$，得到线性差分格式 $u_{xy} \\approx \\dfrac{u_{i+1,j} - u_{i,j} - u_{i+1,j-1} + u_{i,j-1}}{h_x h_y}$。\n\n使用离散波数 $\\alpha \\in [0, \\pi]$ 和 $\\beta \\in [0, \\pi]$（角度必须以弧度处理），为此网格上的二阶导数算子定义离散傅里叶符号（通过离散傅里叶变换 (DFT) 分析）：\n- 对于 $u_{xx}$，其符号为 $-\\dfrac{4}{h_x^2} \\sin^2\\!\\left(\\dfrac{\\alpha}{2}\\right)$。\n- 对于 $u_{yy}$，其符号为 $-\\dfrac{4}{h_y^2} \\sin^2\\!\\left(\\dfrac{\\beta}{2}\\right)$。\n- 对于中心 $u_{xy}$ 格式，实部符号为 $-\\dfrac{2}{h_x h_y} \\sin(\\alpha) \\sin(\\beta)$。\n- 对于迎风 $u_{xy}$ 格式 $D_y^- D_x^+$，其符号为 $\\dfrac{2}{h_x h_y} \\left[(e^{i\\alpha}-1)(1 - e^{-i\\beta})\\right]$，其实部为 $\\dfrac{2}{h_x h_y} \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right]$。\n\n使用这些符号，通过将每个算子映射到其实部符号，为固定的 $a, b, c$ 在波数 $\\alpha$ 和 $\\beta$ 处定义主部的离散系数：\n- $A_d(\\alpha; h_x) = -\\dfrac{4 a}{h_x^2} \\sin^2\\!\\left(\\dfrac{\\alpha}{2}\\right)$,\n- $C_d(\\beta; h_y) = -\\dfrac{4 c}{h_y^2} \\sin^2\\!\\left(\\dfrac{\\beta}{2}\\right)$,\n- $B_{d,\\mathrm{central}}(\\alpha,\\beta; h_x,h_y) = -\\dfrac{2 b}{h_x h_y} \\sin(\\alpha) \\sin(\\beta)$,\n- $B_{d,\\mathrm{upwind}}(\\alpha,\\beta; h_x,h_y) = \\dfrac{2 b}{h_x h_y} \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right]$ (取实部，因为分类与对称实主部有关)。\n\n将一个格式的离散判别式定义为 $D_{\\mathrm{scheme}}(\\alpha,\\beta; h_x,h_y) = \\left(B_{d,\\mathrm{scheme}}(\\alpha,\\beta; h_x,h_y)\\right)^2 - A_d(\\alpha; h_x) \\, C_d(\\beta; h_y)$。对于系数为 $a = 1, b = 1, c = 1$ 的连续抛物型算子，其连续判别式为 $D = 0$，表明对所有 $(x,y)$ 都具有抛物特性。你的任务是通过计算每个测试用例的差值来量化迎风混合格式引入的偏差\n$$\n\\Delta(\\alpha,\\beta; h_x,h_y) \\equiv D_{\\mathrm{upwind}}(\\alpha,\\beta; h_x,h_y) - D_{\\mathrm{central}}(\\alpha,\\beta; h_x,h_y),\n$$\n其中角度以弧度为单位。一个正的 $\\Delta$ 表示迎风格式相对于中心格式增加了离散判别式的值，可能将离散算子推向一个类双曲的状态；一个负的 $\\Delta$ 则表示相反的情况。\n\n实现一个完整、可运行的程序，在 $a = 1, b = 1, c = 1$ 的条件下，为以下参数值 $(\\alpha,\\beta; h_x,h_y)$ 的测试集计算 $\\Delta$：\n1. $(\\alpha,\\beta; h_x,h_y) = (0.1, 0.1; 1.0, 1.0)$，一个低波数的“理想路径”情况，单位为弧度。\n2. $(\\alpha,\\beta; h_x,h_y) = \\left(\\dfrac{\\pi}{2}, \\dfrac{\\pi}{2}; 1.0, 1.0\\right)$，一个中谱情况，单位为弧度。\n3. $(\\alpha,\\beta; h_x,h_y) = (\\pi, \\pi; 1.0, 1.0)$，一个边界（奈奎斯特）情况，单位为弧度。\n4. $(\\alpha,\\beta; h_x,h_y) = \\left(\\dfrac{\\pi}{2}, \\dfrac{\\pi}{2}; 1.0, 2.0\\right)$，一个各向异性网格情况，单位为弧度。\n5. $(\\alpha,\\beta; h_x,h_y) = (0.5, 1.0; 1.0, 0.5)$，一个混合波数的各向异性网格情况，单位为弧度。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[result1,result2,result3,result4,result5]\"），其中每个“result”是对应测试用例的 $\\Delta$ 的浮点值，使用上述公式计算，角度以弧度为单位，不进行四舍五入。不应打印任何其他文本。", "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于偏微分方程数值分析的原理，特别是关于偏微分方程的分类和离散化格式的影响。该问题是适定的，提供了计算唯一、可验证结果所需的所有必要定义、公式和参数。所有术语都得到了客观且明确的定义。\n\n目标是计算针对一个特定的二阶线性偏微分方程，两种不同有限差分格式的离散判别式之间的差异。该偏微分方程由 $a \\, u_{xx} + 2 b \\, u_{xy} + c \\, u_{yy} = 0$ 给出，系数指定为 $a = 1, b = 1, c = 1$。连续判别式为 $D = b^2 - ac = 1^2 - (1)(1) = 0$，这将其分类为抛物型偏微分方程。\n\n任务是计算 $\\Delta(\\alpha,\\beta; h_x,h_y) \\equiv D_{\\mathrm{upwind}}(\\alpha,\\beta; h_x,h_y) - D_{\\mathrm{central}}(\\alpha,\\beta; h_x,h_y)$。\n\n给定格式的离散判别式定义为 $D_{\\mathrm{scheme}} = \\left(B_{d,\\mathrm{scheme}}\\right)^2 - A_d \\, C_d$。使用这个定义，$\\Delta$ 的表达式可以被显著简化。项 $A_d$ 和 $C_d$ 分别仅依赖于 $u_{xx}$ 和 $u_{yy}$ 的离散化，这在问题中描述的“迎风”和“中心”两种格式中是相同的。这两种格式仅在对混合导数项 $u_{xy}$ 的近似上有所不同，因此也仅在其对应的离散系数 $B_d$ 上有所不同。\n\n让我们写出 $\\Delta$ 的表达式：\n$$\n\\Delta = D_{\\mathrm{upwind}} - D_{\\mathrm{central}} = \\left[ \\left(B_{d,\\mathrm{upwind}}\\right)^2 - A_d \\, C_d \\right] - \\left[ \\left(B_{d,\\mathrm{central}}\\right)^2 - A_d \\, C_d \\right]\n$$\n$A_d C_d$ 项被消掉，剩下：\n$$\n\\Delta = \\left(B_{d,\\mathrm{upwind}}\\right)^2 - \\left(B_{d,\\mathrm{central}}\\right)^2\n$$\n\n现在，我们代入为 $B_{d,\\mathrm{upwind}}$ 和 $B_{d,\\mathrm{central}}$ 提供的定义。问题将 $u_{xy}$ 项的系数指定为 $2b$，其中 $b=1$。\n中心格式混合导数系数的定义是：\n$$\nB_{d,\\mathrm{central}}(\\alpha,\\beta; h_x,h_y) = -\\dfrac{2 b}{h_x h_y} \\sin(\\alpha) \\sin(\\beta)\n$$\n当 $b=1$ 时，这变成：\n$$\nB_{d,\\mathrm{central}}(\\alpha,\\beta; h_x,h_y) = -\\dfrac{2}{h_x h_y} \\sin(\\alpha) \\sin(\\beta)\n$$\n迎风格式混合导数系数的定义由其实部给出：\n$$\nB_{d,\\mathrm{upwind}}(\\alpha,\\beta; h_x,h_y) = \\dfrac{2 b}{h_x h_y} \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right]\n$$\n当 $b=1$ 时，这变成：\n$$\nB_{d,\\mathrm{upwind}}(\\alpha,\\beta; h_x,h_y) = \\dfrac{2}{h_x h_y} \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right]\n$$\n将这些代入 $\\Delta$ 的简化表达式中：\n$$\n\\Delta(\\alpha,\\beta; h_x,h_y) = \\left( \\dfrac{2}{h_x h_y} \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right] \\right)^2 - \\left( -\\dfrac{2}{h_x h_y} \\sin(\\alpha) \\sin(\\beta) \\right)^2\n$$\n我们可以提出公因项 $\\left(\\frac{2}{h_x h_y}\\right)^2 = \\frac{4}{(h_x h_y)^2}$：\n$$\n\\Delta(\\alpha,\\beta; h_x,h_y) = \\dfrac{4}{(h_x h_y)^2} \\left( \\left[\\cos(\\alpha) + \\cos(\\beta) - 1 - \\cos(\\alpha - \\beta)\\right]^2 - \\left[\\sin(\\alpha) \\sin(\\beta)\\right]^2 \\right)\n$$\n这就是将要实现以解决问题的最终公式。该过程将涉及创建一个函数，该函数将参数 $(\\alpha, \\beta, h_x, h_y)$ 作为输入，使用此公式计算 $\\Delta$，然后将此函数应用于问题陈述中提供的五个测试用例中的每一个。如规定，角度 $\\alpha$ 和 $\\beta$ 必须以弧度处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference in discrete discriminants between an upwind and a\n    central scheme for a given PDE, for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (alpha, beta, h_x, h_y)\n    test_cases = [\n        (0.1, 0.1, 1.0, 1.0),\n        (np.pi / 2, np.pi / 2, 1.0, 1.0),\n        (np.pi, np.pi, 1.0, 1.0),\n        (np.pi / 2, np.pi / 2, 1.0, 2.0),\n        (0.5, 1.0, 1.0, 0.5),\n    ]\n\n    results = []\n    \n    # Iterate through each test case and compute the result.\n    for alpha, beta, hx, hy in test_cases:\n        # Calculate Delta = B_d_upwind^2 - B_d_central^2\n        # This is derived from Delta = D_upwind - D_central where the A*C term cancels.\n        \n        # We use the simplified formula derived in the solution:\n        # Delta = 4 / (hx*hy)^2 * ( (cos(a)+cos(b)-1-cos(a-b))^2 - (sin(a)sin(b))^2 )\n        \n        # Term inside the first square for upwind part\n        term_upwind = np.cos(alpha) + np.cos(beta) - 1.0 - np.cos(alpha - beta)\n        \n        # Term inside the square for central part\n        term_central = np.sin(alpha) * np.sin(beta)\n        \n        # The common pre-factor\n        pre_factor = 4.0 / (hx * hy)**2\n        \n        # Calculate Delta\n        delta = pre_factor * (term_upwind**2 - term_central**2)\n        \n        results.append(delta)\n\n    # Format the results into the required output string.\n    # e.g., \"[result1,result2,result3,result4,result5]\"\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3371567"}]}