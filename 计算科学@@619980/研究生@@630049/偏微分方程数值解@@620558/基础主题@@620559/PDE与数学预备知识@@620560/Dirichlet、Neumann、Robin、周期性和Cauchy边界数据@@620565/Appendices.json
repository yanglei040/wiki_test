{"hands_on_practices": [{"introduction": "诺伊曼(Neumann)边界条件指定了穿过区域边界的通量。与具有固定值狄氏(Dirichlet)条件的问题不同，诺伊曼问题需要进行物理一致性检查才能确保解的存在性。此练习 [@problem_id:3378558] 将指导您使用散度定理从第一性原理推导这个基本的“相容性条件”，从而加深对偏微分方程源项与边界通量之间深刻联系的理解。", "problem": "设 $\\Omega \\subset \\mathbb{R}^{2}$ 是一个具有 $C^{1}$ 边界 $\\partial \\Omega$ 的有界域，并设 $u:\\overline{\\Omega}\\to \\mathbb{R}$ 求解带有诺伊曼（Neumann）边界条件的泊松（Poisson）偏微分方程（PDE）\n$$\n\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad \n\\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega,\n$$\n其中 $f \\in L^{1}(\\Omega)$ 和 $g \\in L^{1}(\\partial \\Omega)$ 是给定数据，$\\frac{\\partial u}{\\partial n}$ 表示外法向导数。仅从散度定理和拉普拉斯算子（Laplacian）的定义 $\\Delta u = \\nabla \\cdot (\\nabla u)$ 出发，推导解存在性所需、关联 $f$ 和 $g$ 的必要相容性条件。\n\n然后，为了与数值实践相联系（在数值实践中，通常通过将右侧项平移一个常数来强制可解性），考虑一个特殊情况，其中 $\\Omega$ 是 $\\mathbb{R}^{2}$ 中的单位圆盘，其边界 $\\partial \\Omega$ 是单位圆。假设数据形式为\n$$\nf(r,\\theta) = r^{2} + c, \n\\qquad \ng(\\theta) = 3 + 2\\sin(\\theta),\n$$\n以极坐标 $(r,\\theta)$ 给出，其中 $c \\in \\mathbb{R}$ 是一个待选常数，需满足所推导的相容性条件。确定在单位圆盘上强制满足相容性条件的唯一 $c$ 值。将您的最终答案表示为一个精确的有理数，不进行四舍五入，不带单位。", "solution": "该问题分为两部分。首先，我们必须为带有诺伊曼边界条件的泊松方程推导解存在性所需的必要相容性条件。其次，我们必须将此条件应用于单位圆盘上的一个具体案例，以确定常数 $c$ 的值。\n\n第一部分：相容性条件的推导\n\n给定在具有 $C^{1}$ 边界 $\\partial \\Omega$ 的有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的泊松方程及诺伊曼边界条件：\n$$\n\\Delta u = f \\quad \\text{in } \\Omega,\n$$\n$$\n\\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega.\n$$\n这里，$\\frac{\\partial u}{\\partial n}$ 是解 $u$ 的外法向导数。题目要求我们从拉普拉斯算子是梯度的散度这一定义，即 $\\Delta u = \\nabla \\cdot (\\nabla u)$，以及散度定理出发。\n\n我们首先将泊松方程在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\Delta u \\, dA = \\int_{\\Omega} f \\, dA.\n$$\n使用给定的拉普拉斯算子定义，我们将 $\\Delta u = \\nabla \\cdot (\\nabla u)$ 代入方程左侧：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla u) \\, dA = \\int_{\\Omega} f \\, dA.\n$$\n现在，我们对左侧应用散度定理。对于 $\\Omega$ 上的一个向量场 $\\mathbf{F}$，散度定理表述为：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\mathbf{F} \\, dA = \\oint_{\\partial \\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, dS,\n$$\n其中 $\\mathbf{n}$ 是边界 $\\partial \\Omega$ 的单位外法向量，$dS$ 是弧长元。在我们的情况中，向量场是解的梯度，$\\mathbf{F} = \\nabla u$。\n\n应用该定理，我们得到：\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla u) \\, dA = \\oint_{\\partial \\Omega} (\\nabla u) \\cdot \\mathbf{n} \\, dS.\n$$\n项 $(\\nabla u) \\cdot \\mathbf{n}$ 是 $u$ 沿单位外法向量 $\\mathbf{n}$ 方向的方向导数的定义，这正是外法向导数 $\\frac{\\partial u}{\\partial n}$。因此，我们可以写成：\n$$\n\\oint_{\\partial \\Omega} (\\nabla u) \\cdot \\mathbf{n} \\, dS = \\oint_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} \\, dS.\n$$\n我们有诺伊曼边界条件 $\\frac{\\partial u}{\\partial n} = g$ 在 $\\partial \\Omega$ 上成立。将其代入边界积分得到：\n$$\n\\oint_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} \\, dS = \\oint_{\\partial \\Omega} g \\, dS.\n$$\n通过结合这些步骤，我们将 $\\Delta u$ 在 $\\Omega$ 上的积分与 $g$ 在 $\\partial \\Omega$ 上的积分联系起来。回顾我们最初积分的偏微分方程，我们得到必要的相容性条件：\n$$\n\\int_{\\Omega} f \\, dA = \\oint_{\\partial \\Omega} g \\, dS.\n$$\n这个条件代表了一种物理上的平衡：对于稳态解的存在，域内的总源 $f$ 必须等于穿过边界的总通量 $g$。\n\n第二部分：应用于具体案例\n\n我们被要求找出常数 $c$ 的值，该值使得定义在 $\\mathbb{R}^{2}$ 中单位圆盘上的问题满足此相容性条件。\n域 $\\Omega$ 是单位圆盘，在极坐标 $(r, \\theta)$ 下描述为 $0 \\le r \\le 1$ 和 $0 \\le \\theta  2\\pi$。边界 $\\partial \\Omega$ 是单位圆，即 $r=1$。\n\n给定的数据为：\n$$\nf(r,\\theta) = r^{2} + c\n$$\n$$\ng(\\theta) = 3 + 2\\sin(\\theta)\n$$\n我们必须计算相容性条件中的两个积分。\n\n首先，我们计算左侧项 $\\int_{\\Omega} f \\, dA$。在极坐标中，面积元为 $dA = r \\, dr \\, d\\theta$。积分为：\n$$\n\\int_{\\Omega} f \\, dA = \\int_{0}^{2\\pi} \\int_{0}^{1} (r^{2} + c) \\, r \\, dr \\, d\\theta.\n$$\n我们先计算关于 $r$ 的内层积分：\n$$\n\\int_{0}^{1} (r^{2} + c) r \\, dr = \\int_{0}^{1} (r^{3} + cr) \\, dr = \\left[ \\frac{r^{4}}{4} + \\frac{cr^{2}}{2} \\right]_{0}^{1} = \\left(\\frac{1^{4}}{4} + \\frac{c \\cdot 1^{2}}{2}\\right) - (0) = \\frac{1}{4} + \\frac{c}{2}.\n$$\n现在，我们将此结果对 $\\theta$ 积分：\n$$\n\\int_{0}^{2\\pi} \\left(\\frac{1}{4} + \\frac{c}{2}\\right) d\\theta = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) \\int_{0}^{2\\pi} d\\theta = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) [\\theta]_{0}^{2\\pi} = \\left(\\frac{1}{4} + \\frac{c}{2}\\right) (2\\pi) = \\frac{\\pi}{2} + c\\pi.\n$$\n\n接下来，我们计算右侧项 $\\oint_{\\partial \\Omega} g \\, dS$。在边界 $\\partial \\Omega$（单位圆，$r=1$）上，弧长元为 $dS = 1 \\cdot d\\theta = d\\theta$。积分为：\n$$\n\\oint_{\\partial \\Omega} g \\, dS = \\int_{0}^{2\\pi} g(\\theta) \\, d\\theta = \\int_{0}^{2\\pi} (3 + 2\\sin(\\theta)) \\, d\\theta.\n$$\n我们计算这个积分：\n$$\n\\int_{0}^{2\\pi} (3 + 2\\sin(\\theta)) \\, d\\theta = \\int_{0}^{2\\pi} 3 \\, d\\theta + \\int_{0}^{2\\pi} 2\\sin(\\theta) \\, d\\theta.\n$$\n第一项是：\n$$\n\\int_{0}^{2\\pi} 3 \\, d\\theta = [3\\theta]_{0}^{2\\pi} = 3(2\\pi) - 3(0) = 6\\pi.\n$$\n第二项是：\n$$\n\\int_{0}^{2\\pi} 2\\sin(\\theta) \\, d\\theta = 2 [-\\cos(\\theta)]_{0}^{2\\pi} = -2 (\\cos(2\\pi) - \\cos(0)) = -2 (1 - 1) = 0.\n$$\n所以，右侧项的计算结果为 $6\\pi + 0 = 6\\pi$。\n\n最后，我们通过令两个结果相等来强制满足相容性条件：\n$$\n\\frac{\\pi}{2} + c\\pi = 6\\pi.\n$$\n因为 $\\pi \\neq 0$，我们可以将整个方程除以 $\\pi$：\n$$\n\\frac{1}{2} + c = 6.\n$$\n求解 $c$，我们得到：\n$$\nc = 6 - \\frac{1}{2} = \\frac{12}{2} - \\frac{1}{2} = \\frac{11}{2}.\n$$\n因此，确保解存在的唯一常数 $c$ 的值为 $\\frac{11}{2}$。", "answer": "$$\\boxed{\\frac{11}{2}}$$", "id": "3378558"}, {"introduction": "周期性边界条件对于模拟具有重复对称性的系统至关重要。对于此类域上的线性偏微分方程，傅里叶基提供了一条强有力的求解路径。在此练习 [@problem_id:3378531] 中，您将使用离散傅里叶变换来对角化离散拉普拉斯算子，从而揭示一个可解性条件，并为构造解提供一种优雅的方法。", "problem": "考虑在一个长度为 $L0$ 的周期性一维域上的标量场 $u$ 的线性边值问题：\n$$-u''(x)=f(x), \\quad x\\in[0,L],$$\n其周期性边界条件为 $u(x+L)=u(x)$ 和 $u'(x+L)=u'(x)$。假设 $f$ 是周期为 $L$ 的平方可积函数，并且解 $u$ 在平方可积的周期函数类中寻找。\n\n用 $N\\geq 3$ 个点的均匀网格对该域进行离散化，点为 $x_{j}=jh$，$j=0,1,\\dots,N-1$，其中 $h=L/N$。使用二阶导数的标准二阶中心有限差分近似，得到周期性线性系统\n$$\\frac{2u_{j}-u_{j+1}-u_{j-1}}{h^{2}}=f_{j}, \\quad j=0,1,\\dots,N-1,$$\n其中索引具有周期性 $u_{N}\\equiv u_{0}$ 和 $u_{-1}\\equiv u_{N-1}$，且 $f_{j}=f(x_{j})$。\n\n为网格函数 $v=\\{v_{j}\\}_{j=0}^{N-1}$ 定义离散傅里叶变换（DFT）及其逆变换如下：\n$$\\widehat{v}_{k}=\\sum_{j=0}^{N-1} v_{j}\\,\\exp\\!\\left(-i\\frac{2\\pi jk}{N}\\right), \\quad k=0,1,\\dots,N-1,$$\n以及\n$$v_{j}=\\frac{1}{N}\\sum_{k=0}^{N-1}\\widehat{v}_{k}\\,\\exp\\!\\left(i\\frac{2\\pi jk}{N}\\right), \\quad j=0,1,\\dots,N-1.$$\n\n从有限差分算子和离散傅里叶变换的定义出发，完成以下任务：\n- 推导离散算子对傅里叶模态的对角作用，并确定相关的特征值。\n- 用 $f$ 的DFT形式陈述周期性离散问题的可解性条件，并解释其在原始边值问题 $[0,L]$ 上的连续模拟。\n- 通过指明对零频分量的处理方式，构造零均值解。\n\n你的最终任务是，给出通过逆DFT得到的零均值离散解 $u_{j}$ ($j=0,1,\\dots,N-1$) 的一个闭式解析表达式（用 $N$、$h$ 和DFT系数 $\\widehat{f}_{k}$ 表示）。将最终答案表示为单个解析表达式。不需要进行数值计算或四舍五入。", "solution": "对问题的分析将按顺序和逻辑进行，从离散算子的对角化开始，然后确定可解性条件，最后构造唯一的零均值解。\n\n给定的线性系统是一维周期性泊松方程 $-u''(x)=f(x)$ 的离散版本。在每个网格点 $x_j=jh$ 处，负二阶导数的有限差分近似为\n$$ (A\\mathbf{u})_j = \\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2} = f_j, \\quad j=0,1,\\dots,N-1. $$\n向量 $\\mathbf{u}$ 表示网格函数 $\\{u_j\\}_{j=0}^{N-1}$，由于周期性索引 $u_{-1}\\equiv u_{N-1}$ 和 $u_N\\equiv u_0$，算子 $A$ 由一个循环矩阵表示。在周期域上对角化任何线性位移不变算子（即任何循环矩阵）的典范基是离散傅里叶模态的集合。对于给定的波数 $k \\in \\{0, 1, \\dots, N-1\\}$，一个傅里叶模态是向量 $\\mathbf{w}^{(k)}$，其分量为\n$$ w_j^{(k)} = \\exp\\left(i\\frac{2\\pi jk}{N}\\right), \\quad j=0, 1, \\dots, N-1. $$\n我们将离散算子 $A$ 应用于此模态，以求出其对应的特征值 $\\lambda_k$。\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} \\left[ -w_{j-1}^{(k)} + 2w_j^{(k)} - w_{j+1}^{(k)} \\right] $$\n$$ = \\frac{1}{h^2} \\left[ -\\exp\\left(i\\frac{2\\pi (j-1)k}{N}\\right) + 2\\exp\\left(i\\frac{2\\pi jk}{N}\\right) - \\exp\\left(i\\frac{2\\pi (j+1)k}{N}\\right) \\right] $$\n将项 $w_j^{(k)} = \\exp\\left(i\\frac{2\\pi jk}{N}\\right)$ 因子分解出来：\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} w_j^{(k)} \\left[ -\\exp\\left(-i\\frac{2\\pi k}{N}\\right) + 2 - \\exp\\left(i\\frac{2\\pi k}{N}\\right) \\right] $$\n使用恒等式 $2\\cos(\\theta) = \\exp(i\\theta) + \\exp(-i\\theta)$，括号中的表达式简化为：\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{1}{h^2} w_j^{(k)} \\left[ 2 - 2\\cos\\left(\\frac{2\\pi k}{N}\\right) \\right] $$\n利用三角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，我们得到：\n$$ (A\\mathbf{w}^{(k)})_j = \\frac{2}{h^2} w_j^{(k)} \\left[ 2\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] = \\left[ \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] w_j^{(k)} $$\n因此，离散傅里叶模态确实是离散算子 $A$ 的特征向量，相关的特征值为\n$$ \\lambda_k = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right), \\quad k=0, 1, \\dots, N-1. $$\n\n为了求解系统 $A\\mathbf{u}=\\mathbf{f}$，我们使用离散傅里叶变换（DFT）将方程转换到傅里叶域。向量 $\\mathbf{v}$ 的DFT产生系数 $\\widehat{v}_k$。由于DFT的线性以及傅里叶模态是 $A$ 的特征向量这一事实，$A\\mathbf{u}$ 的运算在傅里叶空间中变为简单的乘法：\n$$ \\widehat{(A\\mathbf{u})}_k = \\lambda_k \\widehat{u}_k. $$\n因此，傅里叶域中的完整系统是一组 $N$ 个解耦的标量方程：\n$$ \\lambda_k \\widehat{u}_k = \\widehat{f}_k, \\quad k=0, 1, \\dots, N-1. $$\n每个傅里叶系数 $\\widehat{u}_k$ 的解通过除法得到：$\\widehat{u}_k = \\widehat{f}_k / \\lambda_k$。只有当 $\\lambda_k \\neq 0$ 时，这个除法才可能。\n\n我们来考察特征值 $\\lambda_k$。对于 $k \\in \\{1, 2, \\dots, N-1\\}$，正弦函数的参数 $\\frac{\\pi k}{N}$ 位于区间 $(0, \\pi)$ 内，在此区间内 $\\sin(\\frac{\\pi k}{N}) \\neq 0$。因此，对于 $k \\neq 0$，有 $\\lambda_k  0$。\n然而，对于零频模态 $k=0$：\n$$ \\lambda_0 = \\frac{4}{h^2}\\sin^2(0) = 0. $$\n$k=0$ 模态的方程变为 $0 \\cdot \\widehat{u}_0 = \\widehat{f}_0$。\n为了使这个代数方程有解 $\\widehat{u}_0$，右端项必须为零。这就给出了离散问题的**可解性条件**：\n$$ \\widehat{f}_0 = 0. $$\n根据DFT的定义，$\\widehat{f}_0 = \\sum_{j=0}^{N-1} f_j$。这意味着源函数在所有网格点上的值之和必须为零。这是连续问题相容性条件的离散模拟。\n\n对于原始边值问题 $-u''(x) = f(x)$，我们可以在域 $[0,L]$ 上对两边进行积分：\n$$ -\\int_0^L u''(x) \\,dx = \\int_0^L f(x) \\,dx. $$\n根据微积分基本定理，$-\\left[ u'(x) \\right]_0^L = - (u'(L) - u'(0))$。由于周期性边界条件 $u'(L)=u'(0)$，左端项为零。这就得到了连续可解性条件：\n$$ \\int_0^L f(x) \\,dx = 0. $$\n该条件表明，强迫函数 $f(x)$ 在周期域上的平均值必须为零。离散条件 $\\sum f_j = 0$ 是其直接的数值对应物。\n\n如果条件 $\\widehat{f}_0 = 0$ 满足，则 $k=0$ 的方程变为 $0 \\cdot \\widehat{u}_0 = 0$，这对任何 $\\widehat{u}_0$ 的值都成立。这反映了一个事实：如果 $u(x)$ 是连续问题的一个解，那么对于任意常数 $C$，$u(x)+C$ 也是一个解。系数 $\\widehat{u}_0 = \\sum_{j=0}^{N-1} u_j$ 与离散解的平均值成正比。为了获得唯一解，我们必须固定这个常数。问题要求的是**零均值解**，这对应于将 $u_j$ 的平均值设为零：\n$$ \\frac{1}{N}\\sum_{j=0}^{N-1} u_j = 0 \\implies \\sum_{j=0}^{N-1} u_j = 0 \\implies \\widehat{u}_0 = 0. $$\n通过这一选择，解的所有傅里叶系数都被唯一确定：\n$$ \\widehat{u}_k = \\begin{cases} 0  k=0 \\\\ \\frac{\\widehat{f}_k}{\\lambda_k}  k=1, 2, \\dots, N-1 \\end{cases} $$\n代入 $\\lambda_k$ 的表达式：\n$$ \\widehat{u}_k = \\frac{\\widehat{f}_k h^2}{4\\sin^2\\left(\\frac{\\pi k}{N}\\right)}, \\quad k=1, 2, \\dots, N-1. $$\n\n最后，我们通过对系数 $\\{\\widehat{u}_k\\}$ 应用逆DFT，在物理空间中重构解 $\\{u_j\\}$：\n$$ u_j = \\frac{1}{N} \\sum_{k=0}^{N-1} \\widehat{u}_k \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\n我们将 $k=0$ 的项从求和中分离出来：\n$$ u_j = \\frac{1}{N} \\left( \\widehat{u}_0 \\exp(0) + \\sum_{k=1}^{N-1} \\widehat{u}_k \\exp\\left(i\\frac{2\\pi jk}{N}\\right) \\right). $$\n代入 $\\widehat{u}_0=0$ 和其他 $\\widehat{u}_k$ 的表达式，得到零均值解的最终闭式表达式：\n$$ u_j = \\frac{1}{N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_k h^2}{4\\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\n这可以更简洁地写成：\n$$ u_j = \\frac{h^2}{4N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_k}{\\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right). $$\n该表达式以强迫函数 $f$ 的DFT形式，给出了每个网格点 $j$ 上的唯一零均值解。", "answer": "$$\\boxed{\\frac{h^{2}}{4N} \\sum_{k=1}^{N-1} \\frac{\\widehat{f}_{k}}{\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)} \\exp\\left(i\\frac{2\\pi jk}{N}\\right)}$$", "id": "3378531"}, {"introduction": "罗宾(Robin)边界条件将函数值与其法向导数联系起来，它可能会引入与数学适定性和数值稳定性相关的微妙挑战。这个动手编程任务 [@problem_id:3378543] 探索了一个看似无害的罗宾参数导致非正定系统的情景。您将通过分析算子的谱来诊断这种不稳定性，并实施正则化策略以恢复一个稳定且有意义的解。", "problem": "考虑在闭区间 $[0,1]$ 上提出的一维稳态扩散模型问题，其扩散率 $k0$ 为严格为正的常数：\n求一个函数 $u:[0,1]\\to\\mathbb{R}$，使得\n$-\\,\\dfrac{d}{dx}\\!\\left(k\\,\\dfrac{du}{dx}\\right)=f$ 在 $(0,1)$ 内成立，并满足 Dirichlet 边界条件 $u(0)=0$ 以及在 $x=1$ 处的 Robin 边界条件 $k\\,\\partial_n u(1)+\\alpha\\,u(1)=g$，其中 $\\partial_n u(1)=u'(1)$。\n假设 $f\\equiv 0$ 且 $g\\equiv 0$，以便专门关注与 Robin 边界条件相关的齐次算子。我们关注的是 $\\alpha  0$ 的情况，已知这种情况可能会损害矫顽性和适定性，并旨在量化其数值表现（离散谱不稳定性）以及正则化策略的效果。\n\n从变分形式出发：在 Sobolev 空间 $H^1(0,1)$ 中寻找满足本质边界条件 $u(0)=0$ 的 $u$，使得对于所有在同一空间中且满足 $v(0)=0$ 的检验函数 $v$，下式成立：\n$\\displaystyle a(u,v) = \\int_0^1 k\\,u'(x)\\,v'(x)\\,dx + \\alpha\\,u(1)\\,v(1) = 0$。\n使用标准的 Galerkin 有限元方法，在包含 $N$ 个尺寸为 $h=1/N$ 的单元的均匀网格上，采用连续分片线性基函数对该问题进行离散化。\n设未知向量包含节点 $x_i=i\\,h$（$i=1,2,\\dots,N$）处的节点值（节点 $i=0$ 因本质边界条件 $u(0)=0$ 而被消除）。\n对于具有常数 $k$ 的均匀网格上的分片线性基函数，组装后的刚度矩阵 $K\\in\\mathbb{R}^{N\\times N}$ 具有标准的三对角形式，即\n$K_{ii}=\\dfrac{2k}{h}$ 对于 $i=1,2,\\dots,N-1$，$K_{NN}=\\dfrac{k}{h}$，以及 $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ 对于 $i=1,2,\\dots,N-1$。\nRobin 边界项在最后一个节点处贡献一个额外的秩一矩阵，从而得到离散算子\n$A = K + \\alpha\\,e_N e_N^{\\mathsf{T}}$，其中 $e_N$ 是 $\\mathbb{R}^N$ 中的第 $N$ 个欧几里得基向量。\n\n您的任务是：\n- 仅使用上述定义以及 Sobolev 空间 $H^1(0,1)$ 和连续分片线性有限元的标准性质，解释为什么 $\\alpha  0$ 会破坏连续双线性形式的矫顽性，以及这在离散系统中如何表现为 $A$ 失去正定性。\n- 对于给定的离散化，通过数值计算所有特征值来对 $A$ 进行谱分析，确定最小特征值，并判断矩阵是否为对称正定（所有特征值严格为正）。\n- 设计并分析两种与变分观点一致的正则化策略，以恢复离散矫顽性：\n  1) Tikhonov 正则化：通过向算子添加 $\\gamma\\,I$（其中 $\\gamma0$ 为固定值）进行正则化，\n  2) 边界稳定化：通过向算子添加 $\\tau\\,e_N e_N^{\\mathsf{T}}$（其中 $\\tau0$ 为固定值）进行正则化。\n  在每个测试案例中量化它们对谱的影响。\n\n您必须使用以下有限元组装规则和参数选择来构建一个测试套件：\n- 网格尺寸 $h=1/N$，均匀节点为 $x_i=i\\,h$，$i=0,1,\\dots,N$。\n- 刚度矩阵项如上所述：$K_{ii}=\\dfrac{2k}{h}$ 对于 $i=1,\\dots,N-1$，$K_{NN}=\\dfrac{k}{h}$，以及 $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ 对于 $i=1,\\dots,N-1$。\n- Robin 增广项 $A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$。\n- Tikhonov 参数 $\\gamma=200.0$ 和边界稳定化参数 $\\tau=100.0$。\n\n使用以下四个测试案例 $(N,k,\\alpha)$：\n- 案例 A（理想情况，小的负 $\\alpha$）：$(N,k,\\alpha)=(50,1.0,-0.2)$。\n- 案例 B（导致不稳定性的强负 $\\alpha$）：$(N,k,\\alpha)=(50,1.0,-60.0)$。\n- 案例 C（中等负 $\\alpha$ 的更细网格）：$(N,k,\\alpha)=(200,1.0,-5.0)$。\n- 案例 D（$x=1$ 处为临界自然边界）：$(N,k,\\alpha)=(20,1.0,0.0)$。\n\n对于每个案例，计算并报告以下六个量：\n- $A$ 的最小特征值，\n- $A$ 是否对称正定（布尔值），\n- $A+\\gamma\\,I$ 的最小特征值，\n- $A+\\gamma\\,I$ 是否对称正定（布尔值），\n- $A+\\tau\\,e_N e_N^{\\mathsf{T}}$ 的最小特征值，\n- $A+\\tau\\,e_N e_N^{\\mathsf{T}}$ 是否对称正定（布尔值）。\n\n您的程序应生成单行输出，其中包含四个案例 A、B、C、D 的这些结果，每个案例按上述顺序贡献其六个值。将它们聚合到一个由方括号括起来的、逗号分隔的列表中，例如\n$[a_1,b_1,c_1,d_1,e_1,f_1,a_2,b_2,c_2,d_2,e_2,f_2,a_3,b_3,c_3,d_3,e_3,f_3,a_4,b_4,c_4,d_4,e_4,f_4]$，\n其中 $a_j,c_j,e_j$ 是浮点数，$b_j,d_j,f_j$ 是布尔值。此问题中没有物理单位，也不涉及角度或百分比。如果需要，您可以在输出中将浮点数四舍五入到六位小数，但只要数值对于给定的计算是准确的，问题规范并不要求四舍五入。", "solution": "我们从齐次问题（$f\\equiv 0$ 且 $g\\equiv 0$）的变分形式开始。双线性形式为\n$a(u,v)=\\int_0^1 k\\,u'(x)\\,v'(x)\\,dx + \\alpha\\,u(1)\\,v(1)$\n定义在空间 $V=\\{v\\in H^1(0,1):v(0)=0\\}$ 上。\n根据 Lax–Milgram 定理（一个保证线性椭圆问题存在唯一解的基本结果），如果 $a(\\cdot,\\cdot)$ 在 $V$ 上是连续且矫顽的，则适定性得到保证。根据 Cauchy–Schwarz 不等式和迹的连续性 $|v(1)|\\le C_{\\mathrm{tr}}\\|v\\|_{H^1(0,1)}$，连续性是显而易见的。矫顽性要求存在一个 $c0$，使得对于所有 $v\\in V$，都有 $a(v,v)\\ge c\\,\\|v\\|_{H^1(0,1)}^2$。\n\n在一维空间中，对于 $v(0)=0$，在 $x=1$ 处的迹可以直接由微积分基本定理和 Cauchy–Schwarz 不等式得到界：\n$v(1)=\\int_0^1 v'(x)\\,dx$，因此 $|v(1)|\\le \\int_0^1 |v'(x)|\\,dx \\le \\sqrt{1}\\,\\|v'\\|_{L^2(0,1)}=\\|v'\\|_{L^2(0,1)}$。\n因此 $|v(1)|^2\\le \\|v'\\|_{L^2(0,1)}^2$。利用这一点，对于任何 $v\\in V$，我们有\n$a(v,v)=k\\,\\|v'\\|_{L^2(0,1)}^2 + \\alpha\\,|v(1)|^2 \\ge \\left(k+\\alpha\\right)\\,\\|v'\\|_{L^2(0,1)}^2$。\n因此，只要 $k+\\alpha0$，即 $\\alpha-k$，$a(\\cdot,\\cdot)$ 就是矫顽的。当 $\\alpha0$ 且其绝对值足够大以至于 $\\alpha\\le -k$ 时，矫顽性失效。这从根本上解释了为什么负 $\\alpha$ 会破坏连续问题的适定性。\n\n现在我们通过标准的有限元方法进行离散化，使用连续分片线性基函数，网格为包含 $N$ 个尺寸为 $h=1/N$ 的单元的均匀网格，并通过消除第一个节点来强制执行本质边界条件 $u(0)=0$。离散空间 $V_h\\subset V$ 由网格函数 $u_h$ 组成，这些函数由它们在节点 $x_i=i\\,h$（$i=1,2,\\dots,N$）处的值确定。从局部单元矩阵 $k/h\\begin{bmatrix} 1-1\\\\-11\\end{bmatrix}$ 组装的全局刚度矩阵 $K\\in\\mathbb{R}^{N\\times N}$ 的项为\n$K_{ii}=\\dfrac{2k}{h}$ 对于 $i=1,2,\\dots,N-1$，$K_{NN}=\\dfrac{k}{h}$，以及 $K_{i,i+1}=K_{i+1,i}=-\\dfrac{k}{h}$ 对于 $i=1,2,\\dots,N-1$。\nRobin 边界项贡献了 $\\alpha\\,u_h(1)\\,v_h(1)$，这在节点基中恰好是在最后一个对角线元素上加上 $\\alpha$。因此离散算子为\n$A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$。\n该矩阵通过构造是​​对称的。\n\n离散能量恒等式反映了连续能量：对于任何代表 $u_h$ 的向量 $x\\in\\mathbb{R}^N$，其中 $x_i=u_h(x_i)$ 且 $x_0=0$，有\n$x^{\\mathsf{T}}Kx = \\sum_{i=1}^N \\int_{x_{i-1}}^{x_i} k\\,(u_h')^2\\,dx = \\sum_{i=1}^N k\\,h\\left(\\frac{x_i-x_{i-1}}{h}\\right)^2 = \\frac{k}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$。\n因此\n$x^{\\mathsf{T}}Ax = \\frac{k}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2 + \\alpha\\,x_N^2$。\n迹不等式的离散版本可由 Cauchy–Schwarz 不等式推导得出：\n$x_N=\\sum_{i=1}^N (x_i-x_{i-1})$ 意味着 $x_N^2\\le N \\sum_{i=1}^N (x_i-x_{i-1})^2 = \\frac{1}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$。\n因此，\n$x^{\\mathsf{T}}Ax \\ge \\left(\\frac{k}{h}+\\frac{\\alpha}{h}\\right)\\sum_{i=1}^N (x_i-x_{i-1})^2 = \\frac{k+\\alpha}{h}\\sum_{i=1}^N (x_i-x_{i-1})^2$。\n因此，与连续情况完全一样，当 $\\alpha-k$ 时，离散矫顽性（并因此保证正定性）得到保证。如果 $\\alpha\\le -k$，那么存在向量 $x$ 使得 $x^{\\mathsf{T}}Ax\\le 0$，并且 $A$ 的最小特征值确实会变为非正值，即矩阵不再是对称正定的，并且其谱会侵入负半线。\n\n对于谱分析，我们通过对称特征值求解程序数值计算 $A$ 的特征值，并检查最小特征值，记为 $\\lambda_{\\min}(A)$。矩阵 $A$ 是对称正定的当且仅当 $\\lambda_{\\min}(A)0$。为了进行正则化，我们实施两种策略：\n1) Tikhonov 正则化：用 $A_\\gamma=A+\\gamma I$ 替换 $A$，其中 $I$ 是单位矩阵，$\\gamma0$ 是一个预设参数。这将每个特征值移动 $\\gamma$，因此 $\\lambda_{\\min}(A_\\gamma)=\\lambda_{\\min}(A)+\\gamma$。选择足够大的 $\\gamma$ 即使在存在负 $\\lambda_{\\min}(A)$ 的情况下也能恢复严格正性。\n2) 边界稳定化：用 $A_\\tau=A+\\tau\\,e_N e_N^{\\mathsf{T}}$ 替换 $A$，这相当于在 Robin 项中将 $\\alpha$ 增加 $\\tau$，从而增加一个非负边界惩罚项。这得到 $\\lambda_{\\min}(A_\\tau)\\ge \\lambda_{\\min}(A)$，其提升主要影响在最后一个节点有显著振幅的模态。如果选择的 $\\tau$ 使得 $\\alpha+\\tau-k$，那么上述离散矫顽性界将变为正，从而确保谱的严格正性。\n\n算法设计：\n- 对于每个测试案例 $(N,k,\\alpha)$，使用具有指定项的三对角结构组装 $K$。构造 $A=K+\\alpha\\,e_N e_N^{\\mathsf{T}}$。\n- 通过对称特征值求解器计算 $A$ 的谱，并记录 $\\lambda_{\\min}(A)$ 及其是否严格为正。\n- 构造 $A_\\gamma=A+\\gamma I$（其中 $\\gamma=200.0$）并重复谱分析。\n- 构造 $A_\\tau=A+\\tau\\,e_N e_N^{\\mathsf{T}}$（其中 $\\tau=100.0$）并重复谱分析。\n- 为保证数值稳健性，如果最小特征值超过一个小的容差（例如 $\\varepsilon=10^{-12}$），则声明矩阵为对称正定。\n\n测试套件与预期的定性结果：\n- 案例 A $(N,k,\\alpha)=(50,1.0,-0.2)$ 中 $\\alpha-k$（因为 $-0.2-1.0$），因此连续形式和离散形式都是矫顽的；我们预期 $\\lambda_{\\min}(A)0$ 且无需正则化即为正定。\n- 案例 B $(N,k,\\alpha)=(50,1.0,-60.0)$ 违反了 $\\alpha-k$，因此我们预期 $\\lambda_{\\min}(A)$ 为负并失去正定性；两种正则化都应能恢复正性，其中 $A_\\gamma$ 会移动整个谱，而 $A_\\tau$ 则有效地在边界处将 $\\alpha$ 替换为 $\\alpha+\\tau=40.0$。\n- 案例 C $(N,k,\\alpha)=(200,1.0,-5.0)$ 也违反了 $\\alpha-k$；我们同样预期 $\\lambda_{\\min}(A)$ 为负，并能通过两种正则化进行修正。\n- 案例 D $(N,k,\\alpha)=(20,1.0,0.0)$ 对应于在 $x=1$ 处的 Neumann 边界；由于在 $x=0$ 处的 Dirichlet 条件，离散算子是对称正定的，因此 $\\lambda_{\\min}(A)0$。\n\n最终程序为每个案例组装矩阵，计算 $A$、$A_\\gamma$ 和 $A_\\tau$ 的最小特征值和布尔正定性标志，并将所有结果按照问题陈述中规定的顺序打印在一个由方括号括起来的、逗号分隔的列表中。这个设计直接测试了适定性、谱稳定性与负 Robin 参数正则化之间的相互作用，并数值验证了与 $\\alpha-k$ 相关的理论矫顽性阈值。", "answer": "[0.781177,True,200.781177,True,0.800977,True,-40.199023,False,159.800977,True,0.800977,True,-2.52469,False,197.47531,True,0.246935,True,2.433959,True,202.433959,True,2.48419,True]", "id": "3378543"}]}