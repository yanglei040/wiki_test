{"hands_on_practices": [{"introduction": "逼近一阶导数是求解微分方程数值方法的基础。虽然标准中心差分格式在均匀网格上形式优雅简洁，但非均匀网格需要更严谨的推导来保持精度。第一个练习 [@problem_id:3394040] 将引导您从第一性原理出发，使用泰勒级数展开，构建在非均匀模板上的二阶精度中心差分格式，以逼近 $f'(x_i)$。这将巩固数值分析领域的一项基本技能。", "problem": "考虑一个偏微分方程（PDE）的一维离散化，其中一个足够光滑的函数 $f(x)$ 在三个连续的非均匀节点 $x_{i-1}, x_i, x_{i+1}$ 上采样。定义局部网格间距为 $h_{-} = x_i - x_{i-1}$ 和 $h_{+} = x_{i+1} - x_i$，其中 $h_{-} > 0$ 且 $h_{+} > 0$。仅使用这三个函数值 $f_{i-1} = f(x_{i-1})$、$f_i = f(x_i)$ 和 $f_{i+1} = f(x_{i+1})$，构造一个唯一的线性组合\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1}$$\n该组合为一阶导数 $f'(x_i)$ 提供了一个一致的近似，且在非均匀网格上使用这三个节点可达到最大代数阶。从第一性原理出发，推导系数 $a_{-1}$、$a_0$ 和 $a_{+1}$（用 $h_{-}$ 和 $h_{+}$ 表示），确定近似的阶 $p$，并计算局部展开式中的主截断误差系数 $C$\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1} = f'(x_i) + C\\, f^{(3)}(x_i) + \\text{higher-order terms}.$$\n将你的最终答案表示为闭合形式的解析表达式。不需要四舍五入，也不涉及物理单位。", "solution": "我们从光滑函数 $f(x)$ 在点 $x_i$ 附近关于邻近节点 $x_{i-1}$ 和 $x_{i+1}$ 的泰勒级数展开开始。设 $h_{-} = x_i - x_{i-1} > 0$ 和 $h_{+} = x_{i+1} - x_i > 0$。根据泰勒定理，\n\n$$\nf(x_{i-1}) = f(x_i - h_{-}) = f(x_i) - h_{-} f'(x_i) + \\frac{h_{-}^{2}}{2} f''(x_i) - \\frac{h_{-}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{-}^{4}}{24} f^{(4)}(x_i) + \\cdots,\n$$\n\n\n$$\nf(x_{i+1}) = f(x_i + h_{+}) = f(x_i) + h_{+} f'(x_i) + \\frac{h_{+}^{2}}{2} f''(x_i) + \\frac{h_{+}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{+}^{4}}{24} f^{(4)}(x_i) + \\cdots.\n$$\n\n我们寻求系数 $a_{-1}$、$a_0$ 和 $a_{+1}$，使得线性组合\n\n$$\nS = a_{-1} f(x_{i-1}) + a_{0} f(x_i) + a_{+1} f(x_{i+1})\n$$\n\n仅用这三个点以最高阶近似 $f'(x_i)$。将泰勒展开式代入 $S$ 并按 $f$ 在 $x_i$ 处的导数整理各项，得到\n\n$$\nS = (a_{-1} + a_0 + a_{+1}) f(x_i) + \\left(- a_{-1} h_{-} + a_{+1} h_{+}\\right) f'(x_i) + \\left(\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2}\\right) f''(x_i)\n$$\n\n\n$$\n\\quad + \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i) + \\cdots.\n$$\n\n为了与目标导数 $f'(x_i)$ 保持一致，我们要求 $f(x_i)$ 的系数为零，而 $f'(x_i)$ 的系数为1。为了用三个点最大化代数精度阶，我们进一步消去 $f''(x_i)$ 项。这给出了一个关于 $a_{-1}$、$a_0$ 和 $a_{+1}$ 的线性方程组：\n\n$$\na_{-1} + a_0 + a_{+1} = 0,\n$$\n\n\n$$\n- a_{-1} h_{-} + a_{+1} h_{+} = 1,\n$$\n\n\n$$\n\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2} = 0.\n$$\n\n由第三个方程，$a_{-1} h_{-}^{2} + a_{+1} h_{+}^{2} = 0$，这意味着\n\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}.\n$$\n\n代入第二个方程，\n\n$$\n- \\left(- a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}\\right) h_{-} + a_{+1} h_{+} = 1 \\quad \\Rightarrow \\quad a_{+1} \\left(\\frac{h_{+}^{2}}{h_{-}} + h_{+}\\right) = 1.\n$$\n\n因此\n\n$$\na_{+1} = \\frac{1}{\\dfrac{h_{+}^{2}}{h_{-}} + h_{+}} = \\frac{h_{-}}{h_{+} (h_{-} + h_{+})}.\n$$\n\n然后\n\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}} = - \\frac{h_{+}}{h_{-} (h_{-} + h_{+})}.\n$$\n\n最后，使用 $a_0 = - (a_{-1} + a_{+1})$，我们得到\n\n$$\na_0 = \\frac{h_{+}^{2} - h_{-}^{2}}{h_{-} h_{+} (h_{-} + h_{+})}.\n$$\n\n这些系数消去了 $f(x_i)$ 和 $f''(x_i)$ 的贡献，并将 $f'(x_i)$ 项归一化为1。对于三个节点，这是实现最大代数阶（即二阶）的唯一构造。为计算主截断误差系数，考察 $f^{(3)}(x_i)$ 项：\n\n$$\n\\text{leading error term} = \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i).\n$$\n\n代入 $a_{-1}$ 和 $a_{+1}$：\n\n$$\n- \\frac{a_{-1} h_{-}^{3}}{6} = - \\frac{\\left(- \\dfrac{h_{+}}{h_{-} (h_{-} + h_{+})}\\right) h_{-}^{3}}{6} = \\frac{h_{+} h_{-}^{2}}{6 (h_{-} + h_{+})},\n$$\n\n\n$$\n\\frac{a_{+1} h_{+}^{3}}{6} = \\frac{\\left(\\dfrac{h_{-}}{h_{+} (h_{-} + h_{+})}\\right) h_{+}^{3}}{6} = \\frac{h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})}.\n$$\n\n将这两项贡献相加，得到\n\n$$\n\\frac{h_{+} h_{-}^{2} + h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+} (h_{-} + h_{+})}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+}}{6}.\n$$\n\n因此，主截断误差为\n\n$$\nC\\, f^{(3)}(x_i) \\quad \\text{with} \\quad C = \\frac{h_{-} h_{+}}{6},\n$$\n\n且近似的阶为 $p = 2$，因为误差与乘积 $h_{-} h_{+}$ 成比例，在网格细化（其中 $h_{-}$ 和 $h_{+}$ 都与小参数 $h$ 成正比）的情况下，该乘积为 $\\mathcal{O}(h^{2})$。作为一致性检验，在均匀网格情况 $h_{-} = h_{+} = h$ 下，这些系数简化为 $a_{-1} = - \\dfrac{1}{2 h}$、$a_0 = 0$、$a_{+1} = \\dfrac{1}{2 h}$ 以及 $C = \\dfrac{h^{2}}{6}$，这正是 $f'(x_i)$ 的经典二阶中心差分及其正确的主误差项。", "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{h_{+}}{h_{-}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{+}^{2}-h_{-}^{2}}{h_{-}h_{+}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{-}}{h_{+}\\left(h_{-}+h_{+}\\right)} & 2 & \\dfrac{h_{-}h_{+}}{6}\n\\end{pmatrix}}$$", "id": "3394040"}, {"introduction": "真实的模拟总是在有限的区域上进行，这使得边界条件的处理至关重要。标准的中心差分格式无法应用于边界节点，因此必须使用单边格式。本练习 [@problem_id:3394065] 将演示如何推导一阶导数的二阶精度单边近似格式。这项技术对于在不降低整体解质量的情况下实现高精度边界条件至关重要。", "problem": "考虑一个光滑标量场 $u(x)$，它作为某个偏微分方程 (PDE) 在左边界点 $x_0$ 附近的解出现，其中在一个非均匀网格上只有前向、单边数据可用。设第一个内点为 $x_1 = x_0 + h_1$，第二个内点为 $x_2 = x_1 + h_2 = x_0 + h_1 + h_2$，其中 $h_1 > 0$ 和 $h_2 > 0$ 不必相等。假设 $u$ 在 $x_0$ 的一个邻域内至少有 $4$ 阶连续导数。\n\n你的任务是使用三点格式 $\\{x_0, x_1, x_2\\}$ 为一阶导数 $u'(x_0)$ 构建一个单边、二阶精度的有限差分近似。从关于 $x_0$ 的泰勒展开出发，并对最高为 $2$ 次的多项式强制其精确性，推导出唯一的系数 $a_0(h_1,h_2)$、$a_1(h_1,h_2)$ 和 $a_2(h_1,h_2)$，使得\n$$\na_0\\,u(x_0) + a_1\\,u(x_1) + a_2\\,u(x_2) = u'(x_0) + \\text{(截断误差)}.\n$$\n然后，确定形式为 $C(h_1,h_2)\\,u^{(3)}(x_0) + \\mathcal{O}\\!\\left(\\max\\{h_1,h_2\\}^3\\right)$ 的主截断误差项，并明确给出 $C(h_1,h_2)$ 的表达式。\n\n将你的最终答案以单行矩阵的形式给出，该矩阵按顺序 $\\big(a_0, a_1, a_2, C\\big)$ 包含三个系数和主误差系数。不需要进行数值舍入，也不涉及物理单位。", "solution": "所述问题在科学上是合理的、适定的，并包含了求得唯一解所需的所有必要信息。这是数值分析领域中关于推导有限差分公式的一个标准练习。因此，该问题被认为是有效的，有必要给出完整解法。\n\n我们的目标是使用非均匀网格点 $x_0$、$x_1 = x_0 + h_1$ 和 $x_2 = x_0 + h_1 + h_2$ 处的函数值，为一阶导数 $u'(x_0)$ 的有限差分近似找到系数 $a_0$、$a_1$ 和 $a_2$。该近似由下式给出：\n$$\nu'(x_0) \\approx a_0 u(x_0) + a_1 u(x_1) + a_2 u(x_2)\n$$\n问题指定该近似必须具有二阶精度。我们可以通过使用待定系数法来实现这一点，该方法涉及将 $u(x_1)$ 和 $u(x_2)$ 在点 $x_0$ 附近展开为泰勒级数。鉴于 $u(x)$ 至少有 4 阶连续导数，这些展开是有效的。\n\n$u(x_1)$ 和 $u(x_2)$ 关于 $x_0$ 的泰勒级数为：\n$$\nu(x_1) = u(x_0 + h_1) = u(x_0) + h_1 u'(x_0) + \\frac{h_1^2}{2} u''(x_0) + \\frac{h_1^3}{6} u^{(3)}(x_0) + \\mathcal{O}(h_1^4)\n$$\n$$\nu(x_2) = u(x_0 + h_1 + h_2) = u(x_0) + (h_1 + h_2) u'(x_0) + \\frac{(h_1 + h_2)^2}{2} u''(x_0) + \\frac{(h_1 + h_2)^3}{6} u^{(3)}(x_0) + \\mathcal{O}((h_1+h_2)^4)\n$$\n设有限差分算子为 $L_h u(x_0) = a_0 u(x_0) + a_1 u(x_1) + a_2 u(x_2)$。将泰勒展开代入此表达式可得：\n$$\nL_h u(x_0) = a_0 u(x_0) + a_1 \\left( u(x_0) + h_1 u'(x_0) + \\frac{h_1^2}{2} u''(x_0) + \\dots \\right) + a_2 \\left( u(x_0) + (h_1 + h_2) u'(x_0) + \\frac{(h_1 + h_2)^2}{2} u''(x_0) + \\dots \\right)\n$$\n我们根据 $u$ 在 $x_0$ 处的各阶导数来合并项：\n\\begin{align*}\nL_h u(x_0) = & (a_0 + a_1 + a_2) u(x_0) \\\\\n &+ (a_1 h_1 + a_2 (h_1 + h_2)) u'(x_0) \\\\\n &+ \\left(a_1 \\frac{h_1^2}{2} + a_2 \\frac{(h_1 + h_2)^2}{2}\\right) u''(x_0) \\\\\n &+ \\left(a_1 \\frac{h_1^3}{6} + a_2 \\frac{(h_1 + h_2)^3}{6}\\right) u^{(3)}(x_0) + \\dots\n\\end{align*}\n为了使此表达式成为 $u'(x_0)$ 的一个二阶精度近似，$u(x_0)$、$u'(x_0)$ 和 $u''(x_0)$ 的系数必须与目标量 $u'(x_0)$ 的系数相匹配。这意味着 $u'(x_0)$ 的系数必须为 $1$，而 $u(x_0)$ 和 $u''(x_0)$ 的系数必须为 $0$。这为三个未知系数 $a_0$、$a_1$ 和 $a_2$ 产生了一个三元线性方程组：\n\\begin{align*}\n(1) \\quad & a_0 + a_1 + a_2 = 0 \\\\\n(2) \\quad & a_1 h_1 + a_2 (h_1 + h_2) = 1 \\\\\n(3) \\quad & a_1 h_1^2 + a_2 (h_1 + h_2)^2 = 0\n\\end{align*}\n该方程组等价于对次数为 $0$、$1$ 和 $2$ 的多项式强制其精确性。\n\n我们求解这个方程组以得到 $a_0$、$a_1$ 和 $a_2$。从方程 (3) 中，我们可以用 $a_2$ 表示 $a_1$：\n$$\na_1 = -a_2 \\frac{(h_1 + h_2)^2}{h_1^2}\n$$\n将 $a_1$ 的这个表达式代入方程 (2)：\n$$\n\\left(-a_2 \\frac{(h_1 + h_2)^2}{h_1^2}\\right) h_1 + a_2 (h_1 + h_2) = 1\n$$\n$$\na_2 \\left( -\\frac{(h_1 + h_2)^2}{h_1} + (h_1 + h_2) \\right) = 1\n$$\n$$\na_2 (h_1 + h_2) \\left( -\\frac{h_1 + h_2}{h_1} + 1 \\right) = 1\n$$\n$$\na_2 (h_1 + h_2) \\left( \\frac{-h_1 - h_2 + h_1}{h_1} \\right) = 1\n$$\n$$\na_2 (h_1 + h_2) \\left( \\frac{-h_2}{h_1} \\right) = 1\n$$\n求解 $a_2$ 可得：\n$$\na_2 = -\\frac{h_1}{h_2 (h_1 + h_2)}\n$$\n现在，我们将 $a_2$ 的表达式代回以求得 $a_1$：\n$$\na_1 = - \\left(-\\frac{h_1}{h_2 (h_1 + h_2)}\\right) \\frac{(h_1 + h_2)^2}{h_1^2} = \\frac{h_1 (h_1 + h_2)^2}{h_1^2 h_2 (h_1 + h_2)} = \\frac{h_1 + h_2}{h_1 h_2}\n$$\n最后，我们从方程 (1) 求得 $a_0$：$a_0 = -a_1 - a_2$。\n$$\na_0 = -\\left(\\frac{h_1 + h_2}{h_1 h_2}\\right) - \\left(-\\frac{h_1}{h_2 (h_1 + h_2)}\\right) = -\\frac{h_1 + h_2}{h_1 h_2} + \\frac{h_1}{h_2 (h_1 + h_2)}\n$$\n为了合并这些项，我们使用公分母 $h_1 h_2 (h_1 + h_2)$：\n$$\na_0 = \\frac{-(h_1 + h_2)(h_1 + h_2) + h_1 \\cdot h_1}{h_1 h_2 (h_1 + h_2)} = \\frac{-(h_1^2 + 2 h_1 h_2 + h_2^2) + h_1^2}{h_1 h_2 (h_1 + h_2)}\n$$\n$$\na_0 = \\frac{-2 h_1 h_2 - h_2^2}{h_1 h_2 (h_1 + h_2)} = \\frac{-h_2 (2 h_1 + h_2)}{h_1 h_2 (h_1 + h_2)} = -\\frac{2 h_1 + h_2}{h_1 (h_1 + h_2)}\n$$\n系数为：\n$$\na_0 = -\\frac{2h_1 + h_2}{h_1(h_1 + h_2)}, \\quad a_1 = \\frac{h_1 + h_2}{h_1 h_2}, \\quad a_2 = -\\frac{h_1}{h_2(h_1 + h_2)}\n$$\n问题将截断误差 $T$ 定义为 $L_h u(x_0) - u'(x_0)$。根据我们推导出的系数，构造使得涉及 $u(x_0)$ 和 $u''(x_0)$ 的项的系数为零，而 $u'(x_0)$ 的项的系数为 1。泰勒展开中的第一个非零项即为截断误差的主项：\n$$\nT = \\left(a_1 \\frac{h_1^3}{6} + a_2 \\frac{(h_1 + h_2)^3}{6}\\right) u^{(3)}(x_0) + \\dots\n$$\n主误差项的系数为 $C(h_1, h_2) = \\frac{1}{6} \\left(a_1 h_1^3 + a_2 (h_1 + h_2)^3\\right)$。代入 $a_1$ 和 $a_2$ 的表达式：\n$$\nC(h_1, h_2) = \\frac{1}{6} \\left( \\left(\\frac{h_1 + h_2}{h_1 h_2}\\right) h_1^3 + \\left(-\\frac{h_1}{h_2 (h_1 + h_2)}\\right) (h_1 + h_2)^3 \\right)\n$$\n$$\nC(h_1, h_2) = \\frac{1}{6} \\left( \\frac{(h_1 + h_2) h_1^2}{h_2} - \\frac{h_1 (h_1 + h_2)^2}{h_2} \\right)\n$$\n提取公因式：\n$$\nC(h_1, h_2) = \\frac{h_1(h_1 + h_2)}{6 h_2} \\left( h_1 - (h_1 + h_2) \\right)\n$$\n$$\nC(h_1, h_2) = \\frac{h_1(h_1 + h_2)}{6 h_2} (-h_2) = -\\frac{h_1(h_1 + h_2)}{6}\n$$\n误差的阶为 $\\mathcal{O}(h_1 (h_1+h_2))$，如果 $h_1 \\sim h_2 \\sim h$，则变为 $\\mathcal{O}(h^2)$。这与二阶精度格式是一致的。\n\n所要求的四个量的最终结果是：\n$a_0 = -\\frac{2h_1 + h_2}{h_1(h_1 + h_2)}$\n$a_1 = \\frac{h_1 + h_2}{h_1 h_2}$\n$a_2 = -\\frac{h_1}{h_2(h_1 + h_2)}$\n$C = -\\frac{h_1(h_1 + h_2)}{6}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{2h_1 + h_2}{h_1(h_1 + h_2)} & \\frac{h_1 + h_2}{h_1 h_2} & -\\frac{h_1}{h_2(h_1 + h_2)} & -\\frac{h_1(h_1 + h_2)}{6} \\end{pmatrix}}\n$$", "id": "3394065"}, {"introduction": "许多复杂的物理现象，如 Korteweg-de Vries 方程或双调和方程所描述的，都涉及高阶导数。在非均匀网格上逼近这些导数带来了更大的挑战。这个进阶练习 [@problem_id:3394037] 将处理为三阶导数 $u'''(x)$ 构建差分格式的问题。它将引入拉格朗日插值这一强大方法作为泰勒级数展开的替代，并引导您分析公式系数的敏感性，从而揭示数值格式设计中的实际问题。", "problem": "考虑一个一维偏微分方程(PDE)，其空间算子包含三阶导数 $u'''(x)$。给定一个非均匀网格，包含四个连续节点 $x_{-1}, x_{0}, x_{1}, x_{2}$，以及向前的间距 $a = x_{0} - x_{-1} > 0$、$b = x_{1} - x_{0} > 0$ 和 $c = x_{2} - x_{1} > 0$。目标是构造一个最小的四点有限差分格式，仅使用此非均匀网格上的函数值 $u(x_{-1})$、$u(x_{0})$、$u(x_{1})$ 和 $u(x_{2})$ 来近似 $u'''(x_{0})$，并分析所得系数对间距 $a$、$b$ 和 $c$ 中扰动的敏感性。\n\n仅从基本原理——泰勒定理和拉格朗日基多项式形式的多项式插值——出发，推导系数 $w_{-1}$、$w_{0}$、$w_{1}$、$w_{2}$，使得有限差分近似 $w_{-1} u(x_{-1}) + w_{0} u(x_{0}) + w_{1} u(x_{1}) + w_{2} u(x_{2})$ 对所有三次多项式都精确，从而以由四阶及更高阶导数决定的主导误差来近似 $u'''(x_{0})$。然后，分析权重 $w_{j}$ 对间距中无穷小扰动 $\\delta a$、$\\delta b$ 和 $\\delta c$ 的一阶敏感性，并确定哪些间距扰动对每个权重的影响最大。基于此敏感性分析，提出能够避免不必要相消并且关于节点排列对称的稳健系数公式，将最终系数表示为仅依赖于节点位置差异的形式。\n\n您的最终答案必须是系数向量 $\\begin{pmatrix} w_{-1} & w_{0} & w_{1} & w_{2} \\end{pmatrix}$，以 $a$、$b$ 和 $c$ 的单个闭式解析表达式形式给出。不需要进行数值计算。", "solution": "问题陈述已经过验证，被认为是科学上合理、适定且客观的。它提出了一个数值分析领域的标准问题，尽管细节较多。因此，我们可以继续进行推导和分析。\n\n目标是为三阶导数 $u'''(x_{0})$ 的四点有限差分近似找到系数 $w_{-1}$、$w_{0}$、$w_{1}$ 和 $w_{2}$：\n$$\nu'''(x_{0}) \\approx w_{-1} u(x_{-1}) + w_{0} u(x_{0}) + w_{1} u(x_{1}) + w_{2} u(x_{2})\n$$\n网格节点为 $x_{-1} = x_{0} - a$、$x_{0}$、$x_{1} = x_{0} + b$ 和 $x_{2} = x_{1} + c = x_{0} + b + c$，其中 $a, b, c > 0$。要求该格式对任何三次多项式都精确。\n\n这个问题可以从两个等价的基本原理来解决：泰勒级数展开或多项式插值。问题陈述明确提到了两者。我们将主要使用拉格朗日插值法，因为它为求得系数及其性质提供了一条更直接的路径。\n\n设 $P(x)$ 是在四个给定节点上插值函数 $u(x)$ 的至多3次的唯一多项式，即对 $j \\in \\{-1, 0, 1, 2\\}$ 有 $P(x_j) = u(x_j)$。那么 $u'''(x_{0})$ 的有限差分近似由 $P'''(x_{0})$ 给出。\n这个插值多项式的拉格朗日形式是：\n$$\nP(x) = \\sum_{j=-1}^{2} u(x_j) L_j(x)\n$$\n其中 $L_j(x)$ 是拉格朗日基多项式，定义为：\n$$\nL_j(x) = \\prod_{k=-1, k \\neq j}^{2} \\frac{x - x_k}{x_j - x_k}\n$$\n将 $P(x)$ 求导三次并在 $x=x_0$ 处求值，得到近似式：\n$$\nP'''(x_0) = \\sum_{j=-1}^{2} u(x_j) L_j'''(x_0)\n$$\n通过将其与所求的有限差分公式进行比较，我们确定权重为 $w_j = L_j'''(x_0)$。\n\n我们来计算 $L_j'''(x_0)$。$L_j(x)$ 的分子是关于 $x$ 的三次多项式，我们称之为 $N_j(x) = \\prod_{k \\neq j} (x - x_k)$。$N_j(x)$ 的首项是 $x^3$。因此，它的三阶导数是一个常数：$N_j'''(x) = 3! = 6$。$L_j(x)$ 的分母是一个常数，我们称之为 $D_j = \\prod_{k \\neq j} (x_j - x_k)$。\n因此，权重由以下通用且对称的公式给出：\n$$\nw_j = L_j'''(x_0) = \\frac{N_j'''(x_0)}{D_j} = \\frac{6}{\\prod_{k=-1, k \\neq j}^{2} (x_j - x_k)}\n$$\n这个公式是稳健的，因为它只涉及节点坐标之间非零差的乘积，从而避免了相减抵消问题，前提是网格不是病态退化的（而在此问题中，由于 $a, b, c > 0$，网格并非病态）。它在节点排列方面也表现出明显的对称性。\n\n现在，我们将这个通用公式应用于我们的特定网格。为方便代数计算，我们可以设 $x_0 = 0$。节点坐标变为：$x_{-1} = -a$、$x_0 = 0$、$x_1 = b$ 和 $x_2 = b+c$。\n\n系数 $w_{-1}$ 是：\n$$\nw_{-1} = \\frac{6}{(x_{-1}-x_0)(x_{-1}-x_1)(x_{-1}-x_2)} = \\frac{6}{(-a)(-a-b)(-a-b-c)} = \\frac{-6}{a(a+b)(a+b+c)}\n$$\n系数 $w_{0}$ 是：\n$$\nw_{0} = \\frac{6}{(x_0-x_{-1})(x_0-x_1)(x_0-x_2)} = \\frac{6}{(a)(-b)(-(b+c))} = \\frac{6}{ab(b+c)}\n$$\n系数 $w_{1}$ 是：\n$$\nw_{1} = \\frac{6}{(x_1-x_{-1})(x_1-x_0)(x_1-x_2)} = \\frac{6}{(b-(-a))(b-0)(b-(b+c))} = \\frac{6}{(a+b)(b)(-c)} = \\frac{-6}{bc(a+b)}\n$$\n系数 $w_{2}$ 是：\n$$\nw_{2} = \\frac{6}{(x_2-x_{-1})(x_2-x_0)(x_2-x_1)} = \\frac{6}{((b+c)-(-a))((b+c)-0)((b+c)-b)} = \\frac{6}{(a+b+c)(b+c)(c)}\n$$\n\n作为检验，这种构造保证了该公式对任何三次多项式 $q(x)$ 都是精确的。如果 $u(x) = q(x)$，那么 $P(x) \\equiv q(x)$，并且近似值 $P'''(x_0)$ 会得到精确值 $q'''(x_0)$。这种对基多项式 $\\{1, x-x_0, (x-x_0)^2, (x-x_0)^3\\}$ 的精确性，等价于从泰勒级数展开推导出的方程组：\n\\begin{align*}\n\\sum_{j=-1}^{2} w_j &= 0 \\\\\n\\sum_{j=-1}^{2} w_j (x_j - x_0) &= 0 \\\\\n\\sum_{j=-1}^{2} w_j (x_j - x_0)^2 &= 0 \\\\\n\\sum_{j=-1}^{2} w_j (x_j - x_0)^3 &= 6\n\\end{align*}\n我们基于拉格朗日的推导隐式地求解了这个方程组。\n\n接下来，我们分析权重对间距 $a$、$b$ 和 $c$ 中无穷小扰动的敏感性。这涉及计算每个权重相对于每个间距的偏导数。\n\n对于 $w_{-1} = -6[a(a+b)(a+b+c)]^{-1}$：\n$$\n\\frac{\\partial w_{-1}}{\\partial a} = w_{-1} \\left( \\frac{1}{a} + \\frac{1}{a+b} + \\frac{1}{a+b+c} \\right) \\quad\n\\frac{\\partial w_{-1}}{\\partial b} = w_{-1} \\left( \\frac{1}{a+b} + \\frac{1}{a+b+c} \\right) \\quad\n\\frac{\\partial w_{-1}}{\\partial c} = w_{-1} \\left( \\frac{1}{a+b+c} \\right)\n$$\n由于 $w_{-1} < 0$，所有这些偏导数都是正的。$w_{-1}$ 对 $a$ 的敏感性最大，其次是 $b$，然后是 $c$。这是直观的，因为 $a$ 定义了离 $x_{-1}$ 最近的间距。\n\n对于 $w_{0} = 6[ab(b+c)]^{-1}$：\n$$\n\\frac{\\partial w_{0}}{\\partial a} = -w_{0} \\frac{1}{a} \\quad\n\\frac{\\partial w_{0}}{\\partial b} = -w_{0} \\left( \\frac{1}{b} + \\frac{1}{b+c} \\right) \\quad\n\\frac{\\partial w_{0}}{\\partial c} = -w_{0} \\frac{1}{b+c}\n$$\n由于 $w_{0} > 0$，所有这些偏导数都是负的。权重 $w_0$ 对相邻间距 $a$ 和 $b$ 的扰动最敏感。\n\n对于 $w_{1} = -6[bc(a+b)]^{-1}$：\n$$\n\\frac{\\partial w_{1}}{\\partial a} = w_{1} \\frac{1}{a+b} \\quad\n\\frac{\\partial w_{1}}{\\partial b} = w_{1} \\left( \\frac{1}{b} + \\frac{1}{a+b} \\right) \\quad\n\\frac{\\partial w_{1}}{\\partial c} = w_{1} \\frac{1}{c}\n$$\n由于 $w_{1} < 0$，所有这些偏导数都是正的。权重 $w_1$ 对其相邻间距 $b$ 和 $c$ 的扰动最敏感。\n\n对于 $w_{2} = 6[c(b+c)(a+b+c)]^{-1}$：\n$$\n\\frac{\\partial w_{2}}{\\partial a} = -w_{2} \\frac{1}{a+b+c} \\quad\n\\frac{\\partial w_{2}}{\\partial b} = -w_{2} \\left( \\frac{1}{b+c} + \\frac{1}{a+b+c} \\right) \\quad\n\\frac{\\partial w_{2}}{\\partial c} = -w_{2} \\left( \\frac{1}{c} + \\frac{1}{b+c} + \\frac{1}{a+b+c} \\right)\n$$\n由于 $w_{2} > 0$，所有这些偏导数都是负的。$w_2$ 对 $c$ 的敏感性最大，其次是 $b$，然后是 $a$，这同样是直观的。\n\n总而言之，敏感性分析证实了每个权重 $w_j$ 受其对应节点 $x_j$ 紧邻的网格区间间距的扰动影响最大。推导出的系数以一种稳健的形式表示，仅依赖于基本网格间距的总和，而这些间距本身就是节点位置的差。\n\n最终答案中汇总了以 $a$、$b$ 和 $c$ 表示的系数的最终表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{-6}{a(a+b)(a+b+c)} & \\frac{6}{ab(b+c)} & \\frac{-6}{bc(a+b)} & \\frac{6}{c(b+c)(a+b+c)} \\end{pmatrix}}\n$$", "id": "3394037"}]}