{"hands_on_practices": [{"introduction": "构建高阶差分格式是数值方法的核心技能之一。本练习将引导您从第一性原理出发，使用泰勒级数展开和待定系数法，系统地推导一个六阶精度的显式中心差分格式。通过这个过程，您将掌握如何通过扩展模板和求解权重来精确控制近似的阶数，这是设计满足特定精度要求的数值格式的基础。[@problem_id:3403002]", "problem": "考虑一个定义在均匀网格 $x_i = x_0 + i h$ 上的足够光滑的函数 $u(x)$，网格间距为 $h > 0$。您需要寻找一个针对一阶导数 $u'(x_i)$ 的显式中心有限差分近似，该近似使用对称的七点模板 $\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$。该离散算子的形式为\n$$\nD_h u(x_i) = \\frac{1}{h} \\sum_{m=-3}^{3} w_m \\, u(x_{i+m}),\n$$\n其中权重 $w_m$ 与 $i$ 和 $h$ 无关。\n\n使用待定系数法和 $u(x)$ 在 $x_i$ 点的泰勒展开，施加以下设计原则：\n- 模板是中心的和显式的，因此 $w_0 = 0$，并且权重满足反对称性 $w_{-m} = - w_m$（对于 $m = 1, 2, 3$）。\n- 近似的目标是六阶精度，因此它必须与 $u'(x_i)$ 一致，并消除泰勒级数中由偶数阶矩贡献所隐含的所有低阶误差项，从而产生一个与 $h^6$ 成正比的截断误差。\n\n从这些原则出发，不附加任何额外假设，推导权重 $w_{-3}, w_{-2}, w_{-1}, w_0, w_{1}, w_{2}, w_{3}$ 的精确有理数值，使得对于解析函数 $u(x)$，$D_h u(x_i)$ 对 $u'(x_i)$ 的近似具有 $\\mathcal{O}(h^6)$ 的截断误差。请将您的最终答案以对应于 $\\{u_{i-3}, u_{i-2}, u_{i-1}, u_i, u_{i+1}, u_{i+2}, u_{i+3}\\}$ 的有序系数行的形式给出，并表示为精确有理数。无需四舍五入。没有需要报告的物理单位。\n\n作为背景，此问题设置在偏微分方程（PDE）数值解的框架内，重点关注高阶和紧致有限差分格式。", "solution": "问题陈述经评估是有效的。这是一个在数值分析领域内的适定问题，具有科学依据、自洽且客观。我们可以继续进行有限差分权重的形式推导。\n\n目标是为一阶导数 $u'(x_i)$ 的七点中心有限差分近似找到权重 $w_m$：\n$$\nD_h u(x_i) = \\frac{1}{h} \\sum_{m=-3}^{3} w_m \\, u(x_{i+m})\n$$\n该近似必须具有 $\\mathcal{O}(h^6)$ 阶的截断误差。问题指明了两个设计原则：\n1.  算子是显式和中心的，意味着 $w_0 = 0$。\n2.  权重是反对称的，$w_{-m} = -w_m$（对于 $m=1, 2, 3$）。\n\n应用这些原则，算子得以简化。求和可以重写为：\n$$\nh D_h u(x_i) = w_0 u(x_i) + \\sum_{m=1}^{3} \\left( w_m u(x_{i+m}) + w_{-m} u(x_{i-m}) \\right)\n$$\n使用 $w_0 = 0$ 和 $w_{-m} = -w_m$：\n$$\nh D_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( u(x_{i+m}) - u(x_{i-m}) \\right)\n$$\n未知数是三个权重 $w_1, w_2, w_3$。为了确定它们，我们使用待定系数法。这涉及到在 $u(x)$ 足够光滑的假设下，将 $u(x_{i \\pm m})$ 项在点 $x_i$ 附近展开为泰勒级数。令 $u_i^{(k)}$ 表示 $u$ 在 $x_i$ 处的 $k$ 阶导数，即 $u^{(k)}(x_i)$。\n\n$u(x_i \\pm mh)$ 的泰勒展开为：\n$$\nu(x_i \\pm mh) = \\sum_{k=0}^{\\infty} \\frac{(\\pm mh)^k}{k!} u_i^{(k)} = u_i \\pm mh u_i' + \\frac{(mh)^2}{2!} u_i'' \\pm \\frac{(mh)^3}{3!} u_i''' + \\dots\n$$\n差分项 $u(x_{i+m}) - u(x_{i-m})$ 变为：\n$$\nu(x_{i+m}) - u(x_{i-m}) = 2mh u_i' + 2\\frac{(mh)^3}{3!} u_i''' + 2\\frac{(mh)^5}{5!} u_i^{(5)} + 2\\frac{(mh)^7}{7!} u_i^{(7)} + \\mathcal{O}(h^9)\n$$\n注意到由于反对称性，所有偶数阶导数项都抵消了。将此代回 $h D_h u(x_i)$ 的表达式中：\n$$\nh D_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( 2mh u_i' + \\frac{m^3 h^3}{3} u_i''' + \\frac{m^5 h^5}{60} u_i^{(5)} + \\frac{m^7 h^7}{2520} u_i^{(7)} + \\dots \\right)\n$$\n除以 $h$ 得到算子 $D_h u(x_i)$：\n$$\nD_h u(x_i) = \\sum_{m=1}^{3} w_m \\left( 2m u_i' + \\frac{m^3 h^2}{3} u_i''' + \\frac{m^5 h^4}{60} u_i^{(5)} + \\frac{m^7 h^6}{2520} u_i^{(7)} + \\mathcal{O}(h^8) \\right)\n$$\n我们可以根据 $u$ 的导数来合并各项：\n$$\nD_h u(x_i) = u_i' \\left( 2 \\sum_{m=1}^{3} m w_m \\right) + u_i''' \\frac{h^2}{3} \\left( \\sum_{m=1}^{3} m^3 w_m \\right) + u_i^{(5)} \\frac{h^4}{60} \\left( \\sum_{m=1}^{3} m^5 w_m \\right) + u_i^{(7)} \\frac{h^6}{2520} \\left( \\sum_{m=1}^{3} m^7 w_m \\right) + \\mathcal{O}(h^8)\n$$\n为使算子 $D_h u(x_i)$ 成为 $u'(x_i)$ 的一个六阶精度近似，必须满足以下条件：\n1.  $u_i'$ 的系数必须为 $1$。\n2.  $h^2 u_i'''$ 和 $h^4 u_i^{(5)}$ 项的系数必须为 $0$。\n\n这导出了一个关于三个未知权重 $w_1, w_2, w_3$ 的三元线性方程组：\n$$\n\\begin{cases}\n2 \\sum_{m=1}^{3} m w_m = 1 \\\\\n\\sum_{m=1}^{3} m^3 w_m = 0 \\\\\n\\sum_{m=1}^{3} m^5 w_m = 0\n\\end{cases}\n$$\n将该方程组明确写出：\n$$\n\\begin{cases}\n2(1 \\cdot w_1 + 2 \\cdot w_2 + 3 \\cdot w_3) = 1 \\\\\n1^3 w_1 + 2^3 w_2 + 3^3 w_3 = 0 \\\\\n1^5 w_1 + 2^5 w_2 + 3^5 w_3 = 0\n\\end{cases}\n\\implies\n\\begin{cases}\nw_1 + 2w_2 + 3w_3 = \\frac{1}{2}  \\text{(Eq. 1)} \\\\\nw_1 + 8w_2 + 27w_3 = 0  \\text{(Eq. 2)} \\\\\nw_1 + 32w_2 + 243w_3 = 0  \\text{(Eq. 3)}\n\\end{cases}\n$$\n我们来解这个方程组。首先，消去 $w_1$。\n(Eq. 3) 减去 (Eq. 2)：\n$$\n(32-8)w_2 + (243-27)w_3 = 0 \\implies 24w_2 + 216w_3 = 0\n$$\n$$\nw_2 + 9w_3 = 0 \\implies w_2 = -9w_3 \\quad \\text{(Eq. 4)}\n$$\n(Eq. 2) 减去 (Eq. 1)：\n$$\n(8-2)w_2 + (27-3)w_3 = 0 - \\frac{1}{2} \\implies 6w_2 + 24w_3 = -\\frac{1}{2} \\quad \\text{(Eq. 5)}\n$$\n将 (Eq. 4) 代入 (Eq. 5)：\n$$\n6(-9w_3) + 24w_3 = -\\frac{1}{2}\n$$\n$$\n-54w_3 + 24w_3 = -\\frac{1}{2}\n$$\n$$\n-30w_3 = -\\frac{1}{2} \\implies w_3 = \\frac{1}{60}\n$$\n现在，我们可以使用 (Eq. 4) 求出 $w_2$：\n$$\nw_2 = -9w_3 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\n最后，我们使用 (Eq. 1) 求出 $w_1$：\n$$\nw_1 + 2\\left(-\\frac{3}{20}\\right) + 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2}\n$$\n$$\nw_1 - \\frac{6}{20} + \\frac{3}{60} = \\frac{1}{2}\n$$\n$$\nw_1 - \\frac{3}{10} + \\frac{1}{20} = \\frac{1}{2}\n$$\n$$\nw_1 = \\frac{1}{2} + \\frac{3}{10} - \\frac{1}{20} = \\frac{10}{20} + \\frac{6}{20} - \\frac{1}{20} = \\frac{15}{20} = \\frac{3}{4}\n$$\n因此，权重为 $w_1 = \\frac{3}{4}$，$w_2 = -\\frac{3}{20}$，以及 $w_3 = \\frac{1}{60}$。\n由给定原则确定的 $m \\in \\{-3, \\dots, 3\\}$ 的全套权重 $\\{w_m\\}$ 为：\n- $w_0 = 0$\n- $w_1 = \\frac{3}{4}$, $w_{-1} = -w_1 = -\\frac{3}{4}$\n- $w_2 = -\\frac{3}{20}$, $w_{-2} = -w_2 = \\frac{3}{20}$\n- $w_3 = \\frac{1}{60}$, $w_{-3} = -w_3 = -\\frac{1}{60}$\n\n问题要求最终答案以对应于 $\\{u_{i-3}, u_{i-2}, u_{i-1}, u_i, u_{i+1}, u_{i+2}, u_{i+3}\\}$ 的有序系数行的形式给出。这指的是有序权重集 $(w_{-3}, w_{-2}, w_{-1}, w_0, w_1, w_2, w_3)$，根据构造，这些权重是与 $h$ 无关的有理数。\n\n有序的权重行为：\n$$\n\\left( -\\frac{1}{60}, \\frac{3}{20}, -\\frac{3}{4}, 0, \\frac{3}{4}, -\\frac{3}{20}, \\frac{1}{60} \\right)\n$$\n截断误差由我们忽略的第一个非零项决定。其系数为 $\\frac{h^6}{2520}\\sum_{m=1}^{3} m^7 w_m$。我们来计算这个和：\n$$\n\\sum_{m=1}^{3} m^7 w_m = 1^7\\left(\\frac{3}{4}\\right) + 2^7\\left(-\\frac{3}{20}\\right) + 3^7\\left(\\frac{1}{60}\\right) = \\frac{3}{4} - 128\\frac{3}{20} + \\frac{2187}{60}\n$$\n$$\n= \\frac{3}{4} - \\frac{96}{5} + \\frac{729}{20} = \\frac{15 - 384 + 729}{20} = \\frac{360}{20} = 18\n$$\n因此，首项误差项为 $\\frac{2 h^7}{7!} u_i^{(7)} \\frac{1}{h} \\sum_{m=1}^{3} m^7 w_m = \\frac{2 h^6}{5040} (18) u_i^{(7)} = \\frac{36 h^6}{5040} u_i^{(7)} = \\frac{h^6}{140} u_i^{(7)}$。截断误差确实是 $\\mathcal{O}(h^6)$，证实了其六阶精度。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60} & \\frac{3}{20} & -\\frac{3}{4} & 0 & \\frac{3}{4} & -\\frac{3}{20} & \\frac{1}{60} \\end{pmatrix}}\n$$", "id": "3403002"}, {"introduction": "一个数值格式的性能不仅取决于其静态的截断误差，更在于它在求解偏微分方程时的动态行为。本练习将静态分析推广到动态分析，利用傅里叶方法研究一个四阶紧致格式在求解线性平流方程时的波传播特性。通过推导色散关系和相速度误差，您将深入理解数值频散现象，即数值格式如何随时间扭曲解的形态，这是波传播和流体动力学模拟中的一个核心问题。[@problem_id:3403038]", "problem": "考虑一个间距为 $h>0$ 的均匀网格 $\\{x_i\\}_{i \\in \\mathbb{Z}}$，以及一个在 $x_i$ 的邻域内至少有六阶连续导数的足够光滑的函数 $u(x)$。$x_i$ 处二阶导数的四阶中心有限差分近似定义为\n$$\nD^{(2)}_h u(x_i) \\equiv \\frac{-u_{i+2}+16 u_{i+1}-30 u_i+16 u_{i-1}-u_{i-2}}{12 h^2},\n$$\n其中 $u_j \\equiv u(x_j)$ 且 $x_j = x_i + (j-i) h$。使用关于 $x_i$ 的泰勒级数展开，并仅根据数值分析中的第一性原理，推导用 $D^{(2)}_h u(x_i)$ 近似 $u''(x_i)$ 时局部截断误差的主项，并将其表示为以下形式\n$$\n\\mathrm{TE} \\equiv D^{(2)}_h u(x_i) - u''(x_i) = C\\, h^4\\, u^{(6)}(x_i) + \\mathcal{O}(h^6).\n$$\n确定乘以 $h^4 u^{(6)}(x_i)$ 的常数 $C$。请将您的最终答案以单个实数 $C$ 的形式给出。", "solution": "该问题要求推导给定二阶导数 $u''(x_i)$ 的四阶中心有限差分近似的局部截断误差的主项。该近似由下式给出\n$$\nD^{(2)}_h u(x_i) \\equiv \\frac{-u_{i+2}+16 u_{i+1}-30 u_i+16 u_{i-1}-u_{i-2}}{12 h^2}\n$$\n其中对于间距为 $h > 0$ 的均匀网格，$u_j \\equiv u(x_j)$ 且 $x_j = x_i + (j-i)h$。函数 $u(x)$ 假定为足够光滑，具有至少六阶连续导数。局部截断误差 $\\mathrm{TE}$ 定义为 $\\mathrm{TE} = D^{(2)}_h u(x_i) - u''(x_i)$。我们需要求出表达式 $\\mathrm{TE} = C h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)$ 中的常数 $C$。\n\n为实现这一目标，我们对 $D^{(2)}_h u(x_i)$ 表达式分子中的每一项 $u_{i+k}$ 在点 $x_i$ 周围进行泰勒级数展开。令 $u^{(n)}(x_i)$ 表示 $u$ 在 $x_i$ 处计算的 $n$ 阶导数。由于主误差项的预期阶数为 $h^4$，且算子分母为 $h^2$，我们必须将分子展开到至少 $h^6$ 阶，以捕捉主误差项。为了严谨并确认下一项的阶数，我们将展开到 $h^7$ 阶的项。\n\n$u(x_i + kh)$ 关于 $x_i$ 的泰勒级数展开为：\n$$\nu(x_i+kh) = u(x_i) + (kh)u'(x_i) + \\frac{(kh)^2}{2!}u''(x_i) + \\frac{(kh)^3}{3!}u'''(x_i) + \\frac{(kh)^4}{4!}u^{(4)}(x_i) + \\frac{(kh)^5}{5!}u^{(5)}(x_i) + \\frac{(kh)^6}{6!}u^{(6)}(x_i) + \\mathcal{O}(h^7)\n$$\n我们对 $k \\in \\{-2, -1, 1, 2\\}$ 应用此展开：\n当 $k=1$ 时：\n$$u_{i+1} = u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) + \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)$$\n当 $k=-1$ 时：\n$$u_{i-1} = u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) - \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) - \\mathcal{O}(h^7)$$\n当 $k=2$ 时：\n$$u_{i+2} = u(x_i) + 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) + \\frac{8h^3}{6} u'''(x_i) + \\frac{16h^4}{24} u^{(4)}(x_i) + \\frac{32h^5}{120} u^{(5)}(x_i) + \\frac{64h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)$$\n当 $k=-2$ 时：\n$$u_{i-2} = u(x_i) - 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) - \\frac{8h^3}{6} u'''(x_i) + \\frac{16h^4}{24} u^{(4)}(x_i) - \\frac{32h^5}{120} u^{(5)}(x_i) + \\frac{64h^6}{720} u^{(6)}(x_i) - \\mathcal{O}(h^7)$$\n\n现在我们将这些展开式代入 $D^{(2)}_h u(x_i)$ 的分子，记作 $N$：\n$$\nN = -u_{i+2} + 16u_{i+1} - 30u_i + 16u_{i-1} - u_{i-2}\n$$\n我们来收集 $u(x_i)$ 各阶导数的系数：\n$u(x_i)$ 的系数：\n$$-1 + 16 - 30 + 16 - 1 = 0$$\n$u'(x_i)$ 的系数：\n$$h(-2 + 16(1) + 16(-1) - (-2)) = h(-2 + 16 - 16 + 2) = 0$$\n$u''(x_i)$ 的系数：\n$$\\frac{h^2}{2}(-4 + 16(1) + 16(1) - 4) = \\frac{h^2}{2}(24) = 12h^2$$\n$u'''(x_i)$ 的系数：\n$$\\frac{h^3}{6}(-8 + 16(1) + 16(-1) - (-8)) = \\frac{h^3}{6}(-8 + 16 - 16 + 8) = 0$$\n$u^{(4)}(x_i)$ 的系数：\n$$\\frac{h^4}{24}(-16 + 16(1) + 16(1) - 16) = \\frac{h^4}{24}(-16 + 16 + 16 - 16) = 0$$\n$u^{(5)}(x_i)$ 的系数：\n$$\\frac{h^5}{120}(-32 + 16(1) + 16(-1) - (-32)) = \\frac{h^5}{120}(-32 + 16 - 16 + 32) = 0$$\n$u^{(6)}(x_i)$ 的系数：\n$$\\frac{h^6}{720}(-64 + 16(1) + 16(1) - 64) = \\frac{h^6}{720}(32 - 128) = -\\frac{96}{720}h^6$$\n化简该分数：$\\frac{96}{720} = \\frac{12 \\times 8}{12 \\times 60} = \\frac{8}{60} = \\frac{2}{15}$。\n所以，系数为 $-\\frac{2}{15}h^6$。\n\n所有奇数阶导数项的抵消是由于模板系数 $(-1, 16, -30, 16, -1)$ 的对称性。$u^{(4)}(x_i)$ 项的抵消是这个特定高阶公式的设计所致。\n\n因此，分子 $N$ 可以表示为：\n$$\nN = 12h^2 u''(x_i) - \\frac{2}{15}h^6 u^{(6)}(x_i) + \\mathcal{O}(h^8)\n$$\n注意，下一个非零项将涉及 $u^{(8)}(x_i)$，因此余项的阶数为 $h^8$。\n\n现在，我们将其代回 $D^{(2)}_h u(x_i)$ 的表达式中：\n$$\nD^{(2)}_h u(x_i) = \\frac{N}{12h^2} = \\frac{1}{12h^2} \\left( 12h^2 u''(x_i) - \\frac{2}{15}h^6 u^{(6)}(x_i) + \\mathcal{O}(h^8) \\right)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{2}{12 \\times 15} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{2}{180} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nD^{(2)}_h u(x_i) = u''(x_i) - \\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n局部截断误差 $\\mathrm{TE}$ 定义为 $\\mathrm{TE} = D^{(2)}_h u(x_i) - u''(x_i)$。因此，\n$$\n\\mathrm{TE} = \\left( u''(x_i) - \\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6) \\right) - u''(x_i)\n$$\n$$\n\\mathrm{TE} = -\\frac{1}{90} h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n将此结果与指定形式 $\\mathrm{TE} = C h^4 u^{(6)}(x_i) + \\mathcal{O}(h^6)$ 进行比较，我们可以确定常数 $C$。\n$$\nC = -\\frac{1}{90}\n$$", "answer": "$$\n\\boxed{-\\frac{1}{90}}\n$$", "id": "3403038"}, {"introduction": "一个数值格式的性能不仅取决于其静态的截断误差，更在于它在求解偏微分方程时的动态行为。本练习将静态分析推广到动态分析，利用傅里叶方法研究一个四阶紧致格式在求解线性平流方程时的波传播特性。通过推导色散关系和相速度误差，您将深入理解数值频散现象，即数值格式如何随时间扭曲解的形态，这是波传播和流体动力学模拟中的一个核心问题。[@problem_id:3403022]", "problem": "考虑在周期性空间域 $x \\in [0,L]$ 上，具有恒定平流速度 $a>0$ 的线性常系数偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$。用 $N$ 个均匀间隔的网格点 $x_{j} = j h$（$j=0,1,\\dots,N-1$，$h = L/N$）对空间域进行离散化。令 $D u_{j}$ 表示通过经典的四阶三对角中心紧致有限差分格式对 $u_{x}(x_{j},t)$ 的离散近似，该格式由以下公式隐式定义\n$$\n\\frac{1}{4}\\,D u_{j-1} + D u_{j} + \\frac{1}{4}\\,D u_{j+1} \\;=\\; \\frac{3}{4 h}\\,\\big(u_{j+1} - u_{j-1}\\big).\n$$\n构建半离散系统\n$$\n\\frac{d u_{j}}{d t} + a\\,D u_{j} = 0,\\qquad j=0,1,\\dots,N-1,\n$$\n其中索引是周期性的。使用离散傅里叶模态 ansatz $u_{j}(t) = \\hat{u}\\,\\exp\\!\\big(i\\,(k x_{j} + \\omega t)\\big)$，推导形式为 $\\omega(k) = -a\\,\\tilde{k}(k h)$ 的半离散色散关系，其中 $\\tilde{k}(k h)$ 是该格式的修正波数，然后计算相速度误差 $c_{p}(k) - a$，其中相速度定义为 $c_{p}(k) = -\\omega(k)/k$。将你的最终答案表示为关于 $a$、$k$ 和 $h$ 的单个闭式解析表达式。无需四舍五入，答案中不应包含任何物理单位。", "solution": "该问题要求推导线性平流方程 $u_t + a u_x = 0$ 在使用四阶中心紧致差分格式进行空间离散后，其半离散系统的相速度误差。\n\n**1. 设定 ansatz 并求解修正波数**\n\n我们从半离散系统入手：\n$$\n\\frac{d u_{j}}{d t} + a\\,D u_{j} = 0\n$$\n其中，差分算子 $D$ 由以下紧致格式定义：\n$$\n\\frac{1}{4}\\,(D u)_{j-1} + (D u)_{j} + \\frac{1}{4}\\,(D u)_{j+1} \\;=\\; \\frac{3}{4 h}\\,\\big(u_{j+1} - u_{j-1}\\big)\n$$\n我们假设解具有离散傅里叶模态的形式 $u_j(t) = \\hat{u} e^{i(kx_j + \\omega t)}$。将此 ansatz 代入，空间导数的数值近似 $(D u)_j$ 可以表示为 $(D u)_j = i\\tilde{k} u_j$，其中 $\\tilde{k}$ 是修正波数。\n\n将 $u_j$ 和 $(D u)_j$ 的表达式代入紧致格式定义中：\n$$\n\\frac{1}{4}(i\\tilde{k} u_{j-1}) + i\\tilde{k} u_j + \\frac{1}{4}(i\\tilde{k} u_{j+1}) = \\frac{3}{4h}(u_{j+1} - u_{j-1})\n$$\n用 $u_j = \\hat{u} e^{i(kjh + \\omega t)}$，我们有 $u_{j \\pm 1} = u_j e^{\\pm ikh}$。将 $u_j$ 从两边约去：\n$$\ni\\tilde{k} \\left( \\frac{1}{4}e^{-ikh} + 1 + \\frac{1}{4}e^{ikh} \\right) = \\frac{3}{4h} (e^{ikh} - e^{-ikh})\n$$\n利用欧拉公式 $e^{\\pm i\\theta} = \\cos\\theta \\pm i\\sin\\theta$：\n$$\ni\\tilde{k} \\left( 1 + \\frac{1}{2}\\cos(kh) \\right) = \\frac{3}{4h} (2i\\sin(kh))\n$$\n消去 $i$ 并求解 $\\tilde{k}$：\n$$\n\\tilde{k}(kh) = \\frac{3\\sin(kh)}{h(2+\\cos(kh))}\n$$\n这是该紧致格式的修正波数。\n\n**2. 推导数值色散关系和相速度**\n\n现在，我们将 ansatz $u_j(t) = \\hat{u} e^{i(kx_j + \\omega t)}$ 代入半离散偏微分方程 $\\frac{du_j}{dt} + a D u_j = 0$ 中。时间导数项变为 $\\frac{du_j}{dt} = i\\omega u_j$。\n$$\ni\\omega u_j + a (i\\tilde{k} u_j) = 0\n$$\n这给出了数值色散关系：\n$$\n\\omega(k) = -a\\tilde{k}(kh) = -a \\frac{3\\sin(kh)}{h(2+\\cos(kh))}\n$$\n\n数值相速度 $c_p(k)$ 定义为 $c_p(k) = -\\omega(k)/k$。因此：\n$$\nc_p(k) = - \\frac{1}{k} \\left( -a \\frac{3\\sin(kh)}{h(2+\\cos(kh))} \\right) = a \\frac{3\\sin(kh)}{kh(2+\\cos(kh))}\n$$\n\n**3. 计算相速度误差**\n\n对于精确的偏微分方程 $u_t + a u_x = 0$，其解为 $u(x,t) = f(x-at)$。对于单个傅里叶模态 $e^{i(kx-\\omega_{exact}t)}$，我们有 $\\omega_{exact} = ak$。因此，精确的相速度为 $c_{exact} = a$。\n\n相速度误差是数值相速度与精确相速度之差：\n$$\nE_{phase} = c_p(k) - a = a \\frac{3\\sin(kh)}{kh(2+\\cos(kh))} - a\n$$\n$$\nE_{phase} = a \\left( \\frac{3\\sin(kh)}{kh(2+\\cos(kh))} - 1 \\right)\n$$\n将表达式通分，得到最终的闭式表达式：\n$$\nE_{phase} = a \\left( \\frac{3\\sin(kh) - kh(2+\\cos(kh))}{kh(2+\\cos(kh))} \\right)\n$$\n这与问题所要求的形式一致。", "answer": "$$\n\\boxed{a \\left( \\frac{3\\sin(kh) - kh(2+\\cos(kh))}{kh(2+\\cos(kh))} \\right)}\n$$", "id": "3403022"}]}