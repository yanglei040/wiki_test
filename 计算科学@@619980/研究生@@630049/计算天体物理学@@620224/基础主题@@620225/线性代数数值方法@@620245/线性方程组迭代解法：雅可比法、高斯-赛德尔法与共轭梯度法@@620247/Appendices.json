{"hands_on_practices": [{"introduction": "理论分析是评估迭代方法性能的基石。本练习将引导你使用傅里叶分析这一强大工具，来剖析雅可比法在求解周期性泊松方程时的收敛特性[@problem_id:3515732]。通过推导其迭代矩阵的谱半径，你将揭示该方法应用于此类问题时的内在局限性，从而深刻理解为何我们需要更高级的迭代策略。", "problem": "在计算天体物理学中，薄周期盘的自引力势通常通过在具有周期性边界条件的方形域上求解泊松方程 $-\\nabla^{2}\\phi=\\rho$ 来计算。考虑一个边长为 $L$ 的均匀方形域，用间距为 $h=L/n$ 的 $n \\times n$ 网格进行离散化。该网格上算子 $-\\nabla^{2}$ 的标准五点有限差分离散化导致一个线性系统 $A u = b$，其中矩阵 $A$ 由以下模板定义\n$$\nA u_{i,j}=\\frac{1}{h^{2}}\\left(4 u_{i,j}-u_{i+1,j}-u_{i-1,j}-u_{i,j+1}-u_{i,j-1}\\right),\n$$\n对于所有内部索引 $(i,j)$，并在边界处周期性延拓。求解 $A u = b$ 的雅可比迭代定义为\n$$\nu^{(m+1)} = u^{(m)} + D^{-1}\\left(b - A u^{(m)}\\right),\n$$\n其中 $D$ 是 $A$ 的对角线部分，其迭代矩阵为 $G_{J}=I-D^{-1}A$。由于域和离散化是周期性的，离散傅里叶模式 $u_{i,j}=\\exp\\!\\big(i(k x_{i} + l y_{j})\\big)$（其中 $x_{i}=i h$，$y_{j}=j h$，波数 $k=\\frac{2\\pi m}{L}$，$l=\\frac{2\\pi p}{L}$，对于整数 $m,p\\in\\{0,1,\\dots,n-1\\}$）构成了 $A$ 和 $G_{J}$ 的一个特征基。\n\n从五点模板定义和网格的周期性出发，推导作用于傅里叶模式 $u_{i,j}=\\exp\\!\\big(i(k x_{i} + l y_{j})\\big)$ 的 $G_{J}$ 的特征值，用 $k$、$l$ 和 $h$ 表示。然后，通过分析所有离散傅里叶模式上这些特征值的模，确定放大最严重的模式，并计算谱半径（$G_{J}$ 在所有 $(k,l)$ 上的特征值的最大模）。将最终的谱半径表示为一个无单位的纯数。不需要四舍五入。", "solution": "用户希望分析周期性方形域上泊松方程的有限差分离散化的雅可比迭代。这涉及到求解雅可比迭代矩阵的特征值及其谱半径。\n\n问题陈述已经过验证，被认为是科学上合理的、适定的、客观的且内部一致的。它代表了偏微分方程数值分析中的一个标准问题。\n\n首先，我们确定雅可比迭代矩阵 $G_J = I - D^{-1}A$ 的组成部分。\n线性算子 $A$ 通过其对网格函数 $u_{i,j}$ 的作用来定义：\n$$\nA u_{i,j}=\\frac{1}{h^{2}}\\left(4 u_{i,j}-u_{i+1,j}-u_{i-1,j}-u_{i,j+1}-u_{i,j-1}\\right)\n$$\n矩阵 $D$ 是 $A$ 的对角部分。从模板中，$u_{i,j}$ 的系数决定了 $A$ 的对角线元素。因此，对于任何网格点 $(i,j)$，对应的对角线元素是 $\\frac{4}{h^2}$。因此，矩阵 $D$ 是单位矩阵 $I$ 的一个标量倍：\n$$\nD = \\frac{4}{h^2} I\n$$\n其逆矩阵为：\n$$\nD^{-1} = \\frac{h^2}{4} I\n$$\n雅可比迭代矩阵则为：\n$$\nG_J = I - D^{-1}A = I - \\frac{h^2}{4} A\n$$\n如果 $\\lambda_A$ 是 $A$ 对应于特征向量 $v$ 的一个特征值，那么 $G_J$ 对应的特征值，记为 $\\lambda_J$，可以通过将 $G_J$ 应用于 $v$ 来找到：\n$$\nG_J v = \\left(I - \\frac{h^2}{4} A\\right)v = I v - \\frac{h^2}{4} (A v) = v - \\frac{h^2}{4} (\\lambda_A v) = (1 - \\frac{h^2}{4}\\lambda_A) v\n$$\n因此，特征值之间的关系为 $\\lambda_J = 1 - \\frac{h^2}{4}\\lambda_A$。\n\n问题陈述中指出，离散傅里叶模式是 $A$ 的特征向量。我们现在通过将算子 $A$ 应用于傅里叶模式 $u_{i,j} = \\exp(i(k x_i + l y_j))$（其中 $x_i = i h$ 且 $y_j = j h$）来求特征值 $\\lambda_A$。\n$$\nu_{i+1, j} = \\exp(i(k(i+1)h + ljh)) = \\exp(ikh) \\exp(i(kih + ljh)) = \\exp(ikh) u_{i,j}\n$$\n$$\nu_{i-1, j} = \\exp(i(k(i-1)h + ljh)) = \\exp(-ikh) u_{i,j}\n$$\n$$\nu_{i, j+1} = \\exp(i(kih + l(j+1)h)) = \\exp(ilh) u_{i,j}\n$$\n$$\nu_{i, j-1} = \\exp(i(kih + l(j-1)h)) = \\exp(-ilh) u_{i,j}\n$$\n将这些代入 $A u_{i,j}$ 的定义中：\n$$\nA u_{i,j} = \\frac{1}{h^2} \\left[ 4 u_{i,j} - \\exp(ikh) u_{i,j} - \\exp(-ikh) u_{i,j} - \\exp(ilh) u_{i,j} - \\exp(-ilh) u_{i,j} \\right]\n$$\n提出 $u_{i,j}$ 因子：\n$$\nA u_{i,j} = \\frac{1}{h^2} \\left[ 4 - (\\exp(ikh) + \\exp(-ikh)) - (\\exp(ilh) + \\exp(-ilh)) \\right] u_{i,j}\n$$\n使用恒等式 $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$，我们得到每个模式 $(k,l)$ 对应的 $A$ 的特征值：\n$$\n\\lambda_A(k,l) = \\frac{1}{h^2} [4 - 2\\cos(kh) - 2\\cos(lh)]\n$$\n这个表达式可以使用半角恒等式 $1-\\cos\\theta = 2\\sin^2(\\theta/2)$ 进一步简化：\n$$\n\\lambda_A(k,l) = \\frac{2}{h^2} [ (1-\\cos(kh)) + (1-\\cos(lh)) ] = \\frac{4}{h^2} [\\sin^2(kh/2) + \\sin^2(lh/2)]\n$$\n现在我们可以找到雅可比迭代矩阵 $G_J$ 的特征值：\n$$\n\\lambda_J(k,l) = 1 - \\frac{h^2}{4}\\lambda_A(k,l) = 1 - \\frac{h^2}{4} \\left( \\frac{1}{h^2} [4 - 2\\cos(kh) - 2\\cos(lh)] \\right)\n$$\n$$\n\\lambda_J(k,l) = 1 - (1 - \\frac{1}{2}\\cos(kh) - \\frac{1}{2}\\cos(lh)) = \\frac{1}{2}(\\cos(kh) + \\cos(lh))\n$$\n这就是 $G_J$ 的特征值用 $k$、$l$ 和 $h$ 表示的表达式。\n\n接下来，我们计算谱半径 $\\rho(G_J)$，它是这些特征值在所有允许模式上的最大模。离散波数由 $k = \\frac{2\\pi m}{L}$ 和 $l = \\frac{2\\pi p}{L}$ 给出，其中整数 $m,p \\in \\{0, 1, \\dots, n-1\\}$。由于 $h=L/n$，余弦函数的参数变为 $kh = \\frac{2\\pi m}{n}$ 和 $lh = \\frac{2\\pi p}{n}$。每个模式 $(m,p)$ 的特征值为：\n$$\n\\lambda_{J,m,p} = \\frac{1}{2}\\left(\\cos\\left(\\frac{2\\pi m}{n}\\right) + \\cos\\left(\\frac{2\\pi p}{n}\\right)\\right)\n$$\n谱半径为 $\\rho(G_J) = \\max_{m,p} |\\lambda_{J,m,p}|$。由于 $\\cos\\theta \\in [-1, 1]$，$\\lambda_{J,m,p}$ 的值被限制在 $[-1, 1]$ 内。我们寻找达到这些极值的模式。\n\n$\\lambda_{J,m,p}$ 的最大值在两个余弦项都取最大值时出现。这发生在 $m=0$ 和 $p=0$ 时：\n$$\n\\lambda_{J,0,0} = \\frac{1}{2}(\\cos(0) + \\cos(0)) = \\frac{1}{2}(1 + 1) = 1\n$$\n模为 $|\\lambda_{J,0,0}| = 1$。这对应于 $k=0, l=0$ 模式（常数模式），它是离散拉普拉斯算子 $A$ 的特征向量，特征值为 $0$。迭代矩阵的特征值为 $1$ 意味着该模式下的误差分量不会衰减，表明不收敛。\n\n$\\lambda_{J,m,p}$ 的最小值在两个余弦项都取最小值时出现。这发生在参数尽可能接近 $\\pi$ 时。如果 $n$ 是偶数，我们可以选择 $m=n/2$ 和 $p=n/2$。这些是有效的整数索引。参数变为 $\\frac{2\\pi(n/2)}{n} = \\pi$。\n$$\n\\lambda_{J,n/2,n/2} = \\frac{1}{2}(\\cos(\\pi) + \\cos(\\pi)) = \\frac{1}{2}(-1 - 1) = -1\n$$\n模为 $|\\lambda_{J,n/2,n/2}| = 1$。这对应于最高频率（奈奎斯特）模式，通常称为“棋盘”模式，$u_{i,j} \\propto (-1)^{i+j}$。特征值为 $-1$ 意味着误差分量在每次迭代中符号翻转但模不衰减，同样表明不收敛。\n\n“放大最严重”的模式是那些特征值模 $|\\lambda_J|$ 最大的模式。我们已经找到了模为 $|\\lambda_J|=1$ 的模式。由于 $\\lambda_J$ 的范围是 $[-1,1]$，可能的最大模是 $1$。对于任何网格尺寸 $n$，常数模式 $(m,p)=(0,0)$ 都能达到这个最大值；如果 $n$ 是偶数，高频模式如 $(m,p)=(n/2, n/2)$ 也能达到。\n\n因此，雅可比迭代矩阵的谱半径是这些模的最大值。\n$$\n\\rho(G_J) = \\max_{m,p} |\\lambda_{J,m,p}| = 1\n$$", "answer": "$$ \\boxed{1} $$", "id": "3515732"}, {"introduction": "在从理论转向实际应用时，我们必须考虑计算资源，尤其是内存。本练习将探讨在三维天体物理学模拟中，由泊松方程离散化产生的稀疏矩阵的结构[@problem_id:3515775]。你需要确定该矩阵的带宽和非零元素的精确数量，并估算在压缩稀疏行（CSR）格式下存储该矩阵所需的内存，这是大规模科学计算中至关重要的一步。", "problem": "一个天体物理模拟在一个包含 $N^{3}$ 个点的立方均匀网格上，通过求解带狄利克雷边界条件的泊松方程 $\\nabla^{2} \\Phi = 4 \\pi G \\rho$，来计算牛顿引力势 $\\Phi$。该求解过程使用二阶中心有限差分法。这会导出一个线性系统 $A x = b$，其系数矩阵 $A$ 对应于三维网格上的标准 $7$ 点离散拉普拉斯算子。未知数按照从 $(i,j,k)$ 到单个索引的自然字典序（行主序）映射进行排序\n$$\np(i,j,k) = i + N (j - 1) + N^{2} (k - 1),\n$$\n其中 $i,j,k \\in \\{1,2,\\dots,N\\}$。\n\n从由 $\\nabla^{2}$ 和映射 $p(i,j,k)$ 导出的离散算子出发，通过确定所有使得 $a_{pq} \\neq 0$ 的索引差 $\\Delta = p - q$，从第一性原理推导 $A$ 的稀疏模式。利用此结果，确定在给定排序下 $A$ 的半带宽 $\\beta$，其定义为当 $|p - q|  \\beta$ 时 $a_{pq} = 0$。接下来，计算非零元总数的精确值 $\\mathrm{nnz}(A)$，作为 $N$ 的函数。\n\n最后，假设以压缩稀疏行（CSR）格式存储（压缩稀疏行 (CSR) 格式包含一个长度为 $\\mathrm{nnz}(A)$ 的值数组，一个长度为 $\\mathrm{nnz}(A)$ 的列索引数组，以及一个长度为 $N^{3} + 1$ 的行指针数组）。数值使用 $8$ 字节的电气与电子工程师协会 $754$ (IEEE-$754$) 浮点数，列索引和行指针均使用 $8$ 字节的 $64$ 位整数。推导以 CSR 格式存储 $A$ 所需的总内存占用 $M(N)$（以字节为单位）。\n\n将你的最终答案表示为有序对 $(\\beta(N), M(N))$。最终内存以字节表示。不要四舍五入；给出关于 $N$ 的精确闭式表达式。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题定义明确且客观。所有必要信息均已提供且内部一致。\n\n问题要求推导以压缩稀疏行（CSR）格式存储矩阵 $A$ 时的半带宽 $\\beta(N)$ 和总内存占用 $M(N)$。矩阵 $A$ 源于在 $N \\times N \\times N$ 大小的均匀立方网格上对泊松方程 $\\nabla^{2} \\Phi = 4 \\pi G \\rho$ 进行有限差分離散化。\n\n首先，我们分析矩阵 $A$ 的结构。对均匀网格上的三维拉普拉斯算子 $\\nabla^2$ 使用二阶中心有限差分格式会产生一个 $7$ 点模板。对于任何内部网格点 $(i,j,k)$，离散化方程为：\n$$\n\\frac{\\Phi_{i+1,j,k} - 2\\Phi_{i,j,k} + \\Phi_{i-1,j,k}}{h^2} + \\frac{\\Phi_{i,j+1,k} - 2\\Phi_{i,j,k} + \\Phi_{i,j-1,k}}{h^2} + \\frac{\\Phi_{i,j,k+1} - 2\\Phi_{i,j,k} + \\Phi_{i,j-1,k}}{h^2} = (4 \\pi G \\rho)_{i,j,k}\n$$\n其中 $h$ 是均匀网格间距。重新整理各项，我们得到：\n$$\n\\Phi_{i-1,j,k} + \\Phi_{i+1,j,k} + \\Phi_{i,j-1,k} + \\Phi_{i,j+1,k} + \\Phi_{i,j,k-1} + \\Phi_{i,j,k+1} - 6\\Phi_{i,j,k} = h^2 (4 \\pi G \\rho)_{i,j,k}\n$$\n这个方程定义了线性系统 $A x = b$ 的第 $p$ 行，其中 $p$ 是对应于网格点 $(i,j,k)$ 的线性索引，向量 $x$ 包含未知的势值 $\\Phi$。如果网格点 $q$ 处的势出现在网格点 $p$ 的方程中，则存在一个非零元 $a_{pq}$。这种情况发生在 $q$ 对应于点 $(i,j,k)$ 本身（对角项）或其六个最近邻点之一时：$(i\\pm1,j,k)$、$(i,j\\pm1,k)$ 和 $(i,j,k\\pm1)$。\n\n给定的从网格坐标 $(i,j,k)$ 到线性索引 $p$ 的字典序映射为：\n$$\np(i,j,k) = i + N(j-1) + N^2(k-1)\n$$\n其中 $i, j, k \\in \\{1, 2, \\dots, N\\}$。\n\n为了找到稀疏模式，我们计算所有非零元 $a_{pq}$ 的索引差 $\\Delta = p - q$。令 $p = p(i,j,k)$。列索引 $q$ 对应于一个相邻点。\n\\begin{itemize}\n    \\item 对于邻点 $(i-1,j,k)$，$q = p(i-1,j,k) = (i-1) + N(j-1) + N^2(k-1)$。差值为 $\\Delta = p - q = i - (i-1) = 1$。\n    \\item 对于邻点 $(i+1,j,k)$，$q = p(i+1,j,k) = (i+1) + N(j-1) + N^2(k-1)$。差值为 $\\Delta = p - q = i - (i+1) = -1$。\n    \\item 对于邻点 $(i,j-1,k)$，$q = p(i,j-1,k) = i + N(j-2) + N^2(k-1)$。差值为 $\\Delta = p - q = N(j-1) - N(j-2) = N$。\n    \\item 对于邻点 $(i,j+1,k)$，$q = p(i,j+1,k) = i + N(j) + N^2(k-1)$。差值为 $\\Delta = p - q = N(j-1) - N(j) = -N$。\n    \\item 对于邻点 $(i,j,k-1)$，$q = p(i,j,k-1) = i + N(j-1) + N^2(k-2)$。差值为 $\\Delta = p - q = N^2(k-1) - N^2(k-2) = N^2$。\n    \\item 对于邻点 $(i,j,k+1)$，$q = p(i,j,k+1) = i + N(j-1) + N^2(k)$。差值为 $\\Delta = p - q = N^2(k-1) - N^2(k) = -N^2$。\n\\end{itemize}\n对于对角元，$p=q$，所以 $\\Delta = 0$。因此，所有可能使 $a_{pq}$ 非零的索引差的集合是 $\\{0, \\pm 1, \\pm N, \\pm N^2\\}$。\n\n接下来，我们确定半带宽 $\\beta$，其定义为若 $|p-q|  \\beta$，则 $a_{pq}=0$。这等价于找到最大绝对索引差。\n$$\n\\beta = \\max_{a_{pq} \\neq 0} |p-q| = \\max\\{|0|, |\\pm 1|, |\\pm N|, |\\pm N^2|\\}\n$$\n假设 $N \\ge 1$，我们有 $N^2 \\ge N \\ge 1$。因此，半带宽为：\n$$\n\\beta(N) = N^2\n$$\n\n现在，我们计算非零元的精确总数 $\\mathrm{nnz}(A)$。矩阵 $A$ 的大小为 $N^3 \\times N^3$。由于存在狄利克雷边界条件，位于网格边界上的点的方程将具有较少的非对角项。非零元的总数是对角元和非对角元之和。\n$N^3$ 个网格点中的每一个点都有一个对角元，因此有 $N^3$ 个对角元。\n非对角元对应于网格内部相邻网格点之间的连接。由于拉普拉斯算子的对称性（$a_{pq} = a_{qp}$），两点之间的每个连接（或链接）都对矩阵贡献两个非零元。我们计算网格中的内部连接数。\n\\begin{itemize}\n    \\item $i$ 轴方向的连接：在每个 $j,k$ 平面上，有 $N^2$ 个由 $N$ 个点组成的行。每行有 $N-1$ 个连接。因此，$i$ 方向的总连接数：$N^2(N-1)$。\n    \\item $j$ 轴方向的连接：在每个 $i,k$ 平面上，有 $N^2$ 个由 $N$ 个点组成的列。每列有 $N-1$ 个连接。因此，$j$ 方向的总连接数：$N^2(N-1)$。\n    \\item $k$ 轴方向的连接：在每个 $i,j$ 平面上，有 $N^2$ 个由 $N$ 个点组成的“纵列”。每列有 $N-1$ 个连接。因此，$k$ 方向的总连接数：$N^2(N-1)$。\n\\end{itemize}\n唯一连接的总数为 $3 \\times N^2(N-1) = 3N^3 - 3N^2$。\n非对角元的总数是连接数的两倍：$2(3N^3 - 3N^2) = 6N^3 - 6N^2$。\n非零元的总数是对角元和非对角元之和：\n$$\n\\mathrm{nnz}(A) = N^3 + (6N^3 - 6N^2) = 7N^3 - 6N^2\n$$\n\n最后，我们推导以 CSR 格式存储 $A$ 所需的总内存占用 $M(N)$。问题指定了组件和数据类型：\n\\begin{itemize}\n    \\item 值数组：长度为 $\\mathrm{nnz}(A)$，存储 $8$ 字节浮点数。\n    \\item 列索引数组：长度为 $\\mathrm{nnz}(A)$，存储 $8$ 字节整数。\n    \\item 行指针数组：长度为 $N^3+1$，存储 $8$ 字节整数。\n\\end{itemize}\n总内存 $M(N)$（以字节为单位）是每个组件所需内存的总和：\n$$\nM(N) = (\\text{值数组长度}) \\times 8 + (\\text{列索引数组长度}) \\times 8 + (\\text{行指针数组长度}) \\times 8\n$$\n$$\nM(N) = \\mathrm{nnz}(A) \\times 8 + \\mathrm{nnz}(A) \\times 8 + (N^3+1) \\times 8\n$$\n$$\nM(N) = 16 \\times \\mathrm{nnz}(A) + 8(N^3+1)\n$$\n代入 $\\mathrm{nnz}(A)$ 的表达式：\n$$\nM(N) = 16(7N^3 - 6N^2) + 8(N^3+1)\n$$\n$$\nM(N) = 112N^3 - 96N^2 + 8N^3 + 8\n$$\n$$\nM(N) = 120N^3 - 96N^2 + 8\n$$\n此表达式给出了总内存占用（以字节为单位）作为 $N$ 的函数。\n\n最终答案为有序对 $(\\beta(N), M(N))$。\n$$\n\\beta(N) = N^2\n$$\n$$\nM(N) = 120N^3 - 96N^2 + 8\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nN^2  120N^3 - 96N^2 + 8\n\\end{pmatrix}\n}\n$$", "id": "3515775"}, {"introduction": "共轭梯度（CG）法是求解大型对称正定线性系统的首选方法之一，但其实际应用中的一个核心问题是：何时停止迭代？本练习将理论与实践相结合，要求你推导出一个可计算的误差上界[@problem_id:3515779]。你将学习如何利用可直接计算的残差和预条件子，来估计在能量范数下难以直接衡量的真实误差，这是设计高效、可靠的停止准则的关键。", "problem": "在一个用于求解薄轴对称盘中引力势的自洽场问题中，中平面势 $\\phi$ 满足一个泊松方程。在间距为 $h$ 的均匀网格上对其进行二阶有限差分-离散化后，会产生一个对称正定 (SPD) 线性系统 $A x = b$。考虑 $h = 1$、狄利克雷边界的一维简化情况，以及 $3 \\times 3$ 的 SPD 刚度矩阵\n$$\nA = \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n假设将共轭梯度 (CG) 法应用于 $A x = b$，并且在第 $k$ 次迭代时，残差为\n$$\nr_k = \\begin{pmatrix} 0.10 \\\\ -0.05 \\\\ 0.08 \\end{pmatrix}.\n$$\n设误差为 $e_k = x - x_k$，并定义由 $A$ 导出的能量范数为 $\\|u\\|_A = \\sqrt{u^{T} A u}$。你有一个可用的对称正定 (SPD) 预条件子 $P$，它近似于 $A^{-1}$，\n$$\nP = \\begin{pmatrix}\n0.6  0.2  0 \\\\\n0.2  0.6  0.2 \\\\\n0  0.2  0.6\n\\end{pmatrix},\n$$\n并且，通过与高分辨率多重网格校正进行求解器的离线校准，得到谱等价常数 $\\alpha$ 和 $\\beta$，使得对于所有 $v \\in \\mathbb{R}^{3}$，\n$$\n\\alpha v^{T} P v \\le v^{T} A^{-1} v \\le \\beta v^{T} P v,\n$$\n其中 $\\alpha = 0.5$ 且 $\\beta = 1.5$。\n\n从残差、误差和 $A$-内积的定义出发，推导能量范数误差 $\\|e_k\\|_A$ 的一个可计算上界，该上界用残差 $r_k$ 和预条件子 $P$ 表示。然后，使用给定的 $r_k$、$A$、$P$、$\\alpha$ 和 $\\beta$ 对此界进行数值计算。将该界报告为单个实数值。答案四舍五入到四位有效数字。无需单位。", "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n**步骤 1：提取已知条件**\n-   线性系统：$A x = b$，其中 $A$ 是一个对称正定 (SPD) 矩阵。\n-   刚度矩阵：\n    $$\n    A = \\begin{pmatrix}\n    2  -1  0 \\\\\n    -1  2  -1 \\\\\n    0  -1  2\n    \\end{pmatrix}\n    $$\n-   共轭梯度 (CG) 法第 $k$ 次迭代的残差：\n    $$\n    r_k = \\begin{pmatrix} 0.10 \\\\ -0.05 \\\\ 0.08 \\end{pmatrix}\n    $$\n-   第 $k$ 次迭代的误差：$e_k = x - x_k$。\n-   能量范数定义：$\\|u\\|_A = \\sqrt{u^{T} A u}$。\n-   SPD 预条件子：\n    $$\n    P = \\begin{pmatrix}\n    0.6  0.2  0 \\\\\n    0.2  0.6  0.2 \\\\\n    0  0.2  0.6\n    \\end{pmatrix}\n    $$\n-   谱等价常数与不等式：对于所有 $v \\in \\mathbb{R}^{3}$，\n    $$\n    \\alpha\\, v^{T} P v \\le v^{T} A^{-1} v \\le \\beta\\, v^{T} P v,\n    $$\n    其中 $\\alpha = 0.5$ 且 $\\beta = 1.5$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据。其背景是在天体物理学中，使用数值线性代数求解离散化偏微分方程的标准应用。给定的矩阵 $A$ 是著名的一维离散拉普拉斯算子，它是 SPD 的。给定的矩阵 $P$ 是对称的，其正定性可以通过检查其顺序主子式是否为正来验证：$0.6  0$，$0.6^2 - 0.2^2 = 0.32  0$，以及 $\\det(P) = 0.168  0$。因此，如题所述，$P$ 也是 SPD 的。预条件子和谱等价的概念是迭代法分析的核心。该问题是适定的，提供了推导和计算所需界限的所有必要信息。语言客观而精确。该问题被认为是有效的。\n\n**步骤 3：推导与求解**\n目标是使用所提供的量，推导误差的能量范数 $\\|e_k\\|_A$ 的一个可计算上界。\n\n首先，我们建立误差 $e_k$ 和残差 $r_k$ 之间的关系。残差定义为 $r_k = b - A x_k$。由于 $x$ 是 $A x = b$ 的精确解，我们可以写成：\n$$\nr_k = A x - A x_k = A(x - x_k)\n$$\n根据定义，误差为 $e_k = x - x_k$。将其代入残差的表达式可得：\n$$\nr_k = A e_k\n$$\n因为矩阵 $A$ 是给定的对称正定 (SPD) 矩阵，所以它是可逆的。因此，我们可以用残差表示误差：\n$$\ne_k = A^{-1} r_k\n$$\n接下来，我们使用能量范数的平方的定义，$\\|e_k\\|_A^2 = e_k^T A e_k$。将 $e_k$ 用 $r_k$ 的表达式代入：\n$$\n\\|e_k\\|_A^2 = (A^{-1} r_k)^T A (A^{-1} r_k)\n$$\n使用性质 $(XY)^T = Y^T X^T$，我们得到：\n$$\n\\|e_k\\|_A^2 = r_k^T (A^{-1})^T A A^{-1} r_k\n$$\n由于 $A$ 是对称的，其逆矩阵 $A^{-1}$ 也是对称的，所以 $(A^{-1})^T = A^{-1}$。表达式简化为：\n$$\n\\|e_k\\|_A^2 = r_k^T A^{-1} A A^{-1} r_k = r_k^T (A^{-1} A) A^{-1} r_k = r_k^T I A^{-1} r_k\n$$\n这给出了能量范数误差平方的精确表达式：\n$$\n\\|e_k\\|_A^2 = r_k^T A^{-1} r_k\n$$\n这个表达式无法直接计算，因为它涉及到 $A^{-1}$，而这正是我们试图避免计算的那个逆矩阵。然而，题目给出了一个预条件子 $P$ 和一个谱等价关系。问题提供了不等式：\n$$\n\\alpha\\, v^{T} P v \\le v^{T} A^{-1} v \\le \\beta\\, v^{T} P v\n$$\n此不等式对任意向量 $v \\in \\mathbb{R}^{3}$ 均成立。我们可以令 $v = r_k$，以获得对 $r_k^T A^{-1} r_k$ 项的界：\n$$\n\\alpha\\, r_k^{T} P r_k \\le r_k^{T} A^{-1} r_k \\le \\beta\\, r_k^{T} P r_k\n$$\n我们关心的是 $\\|e_k\\|_A$ 的一个上界。结合最后两个结果：\n$$\n\\|e_k\\|_A^2 = r_k^T A^{-1} r_k \\le \\beta\\, r_k^T P r_k\n$$\n对两边取平方根，得到能量范数误差的可计算上界：\n$$\n\\|e_k\\|_A \\le \\sqrt{\\beta\\, r_k^T P r_k}\n$$\n现在，我们使用给定的值对此界进行数值计算。\n已知：\n$\\beta = 1.5$\n$r_k = \\begin{pmatrix} 0.10 \\\\ -0.05 \\\\ 0.08 \\end{pmatrix}$\n$P = \\begin{pmatrix} 0.6  0.2  0 \\\\ 0.2  0.6  0.2 \\\\ 0  0.2  0.6 \\end{pmatrix}$\n\n首先，我们计算乘积 $P r_k$：\n$$\nP r_k = \\begin{pmatrix} 0.6  0.2  0 \\\\ 0.2  0.6  0.2 \\\\ 0  0.2  0.6 \\end{pmatrix} \\begin{pmatrix} 0.10 \\\\ -0.05 \\\\ 0.08 \\end{pmatrix} = \\begin{pmatrix} (0.6)(0.10) + (0.2)(-0.05) + (0)(0.08) \\\\ (0.2)(0.10) + (0.6)(-0.05) + (0.2)(0.08) \\\\ (0)(0.10) + (0.2)(-0.05) + (0.6)(0.08) \\end{pmatrix}\n$$\n$$\nP r_k = \\begin{pmatrix} 0.06 - 0.01 \\\\ 0.02 - 0.03 + 0.016 \\\\ -0.01 + 0.048 \\end{pmatrix} = \\begin{pmatrix} 0.05 \\\\ 0.006 \\\\ 0.038 \\end{pmatrix}\n$$\n接下来，我们计算二次型 $r_k^T P r_k$，即 $r_k$ 和 $P r_k$ 的点积：\n$$\nr_k^T P r_k = \\begin{pmatrix} 0.10  -0.05  0.08 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0.006 \\\\ 0.038 \\end{pmatrix}\n$$\n$$\nr_k^T P r_k = (0.10)(0.05) + (-0.05)(0.006) + (0.08)(0.038)\n$$\n$$\nr_k^T P r_k = 0.005 - 0.0003 + 0.00304 = 0.00774\n$$\n最后，我们将此值代入上界表达式：\n$$\n\\|e_k\\|_A \\le \\sqrt{\\beta\\, r_k^T P r_k} = \\sqrt{(1.5)(0.00774)} = \\sqrt{0.01161}\n$$\n计算最终的数值：\n$$\n\\sqrt{0.01161} \\approx 0.10774971\n$$\n四舍五入到四位有效数字，上界为 $0.1077$。", "answer": "$$\n\\boxed{0.1077}\n$$", "id": "3515779"}]}