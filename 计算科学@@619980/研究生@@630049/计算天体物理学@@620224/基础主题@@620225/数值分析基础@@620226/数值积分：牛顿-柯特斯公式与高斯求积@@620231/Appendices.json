{"hands_on_practices": [{"introduction": "牛顿-柯特斯积分法是一族基于一个简单直观思想的积分方法：用一个多项式近似一个函数，然后对该多项式进行积分。第一个练习将通过直接积分一阶拉格朗日插值多项式，引导你推导最基本的例子——梯形法则的权重。这项基础技能有助于揭示积分权重是如何产生的。[@problem_id:3526428]", "problem": "在平行平面恒星大气的辐射转移中，出射通量可以写成比强度对方向余弦的角度积分。更一般地，在计算天体物理学中，许多视线积分可以简化为 $\\int_{a}^{b} f(x) \\, dx$ 形式的一维定积分，这类积分必须通过数值方法进行计算，并严格控制离散化误差。\n\n考虑在区间 $\\left[a,b\\right]$ 上的一个闭合牛顿-柯特斯(Newton–Cotes)求积法则，它使用 $n+1$ 个等距节点，包括区间的两个端点。设节点为 $x_{i} = a + i h$，$i = 0,1,\\dots,n$，其中 $h = \\left(b-a\\right)/n$。闭合牛顿-柯特斯法则通过节点处函数值的加权和来近似积分，其权重经过选择，使得该法则能对所有最高为 $n$ 次的多项式的积分给出精确结果。\n\n在此设定下，从基本的多项式插值思想出发来定义求积权重：用基于这些节点构建的拉格朗日(Lagrange)插值多项式来表示一个函数，然后对该插值多项式进行积分。然后，特化到 $n=1$ 的情况（即在两个端点 $x_{0}=a$ 和 $x_{1}=b$ 处有两个节点），通过对与这两个节点相关联的一次拉格朗日(Lagrange)基函数进行显式积分，来推导梯形法则的权重。\n\n将你的最终答案表示为一个包含两个梯形法则权重 $\\left[w_{0}\\;\\;w_{1}\\right]$ 的行向量，该向量是 $a$ 和 $b$ 的函数。你的最终答案必须是单一的解析表达式。不要包含单位。不要四舍五入。", "solution": "该问题是有效的，因为它具有科学依据、是适定的、客观且内部一致的。它呈现了数值分析中的一个标准推导过程。\n\n目标是为 $n=1$ 的闭合牛顿-柯特斯(Newton–Cotes)求积法则（通常称为梯形法则）推导权重，该法则用于近似定积分 $\\int_{a}^{b} f(x) \\, dx$。推导过程是通过对在区间 $[a, b]$ 上近似函数 $f(x)$ 的拉格朗日(Lagrange)插值多项式进行积分来完成的。\n\n一个具有 $n+1$ 个节点的通用闭合牛顿-柯特斯(Newton–Cotes)公式将积分近似为这些节点上函数值的加权和：\n$$\n\\int_{a}^{b} f(x) \\, dx \\approx \\sum_{i=0}^{n} w_i f(x_i)\n$$\n节点 $x_i$ 在区间 $[a, b]$ 内等距分布，由 $x_i = a + ih$ 给出，$i = 0, 1, \\dots, n$，其中步长为 $h = \\frac{b-a}{n}$。权重 $w_i$ 是通过用一个唯一的、最高为 $n$ 次的拉格朗日(Lagrange)插值多项式 $P_n(x)$ 来近似 $f(x)$ 而确定的，该多项式穿过 $n+1$ 个点 $(x_i, f(x_i))$。该多项式由下式给出：\n$$\nP_n(x) = \\sum_{i=0}^{n} f(x_i) L_{n,i}(x)\n$$\n其中 $L_{n,i}(x)$ 是拉格朗日(Lagrange)基多项式，定义为：\n$$\nL_{n,i}(x) = \\prod_{\\substack{j=0 \\\\ j \\neq i}}^{n} \\frac{x-x_j}{x_i-x_j}\n$$\n对 $f(x)$ 的这个多项式近似进行积分，得到积分的近似值：\n$$\n\\int_{a}^{b} f(x) \\, dx \\approx \\int_{a}^{b} P_n(x) \\, dx = \\int_{a}^{b} \\sum_{i=0}^{n} f(x_i) L_{n,i}(x) \\, dx\n$$\n由于函数值 $f(x_i)$ 相对于积分变量 $x$ 是常数，我们可以写成：\n$$\n\\int_{a}^{b} P_n(x) \\, dx = \\sum_{i=0}^{n} f(x_i) \\left( \\int_{a}^{b} L_{n,i}(x) \\, dx \\right)\n$$\n通过将其与求积公式 $\\sum_{i=0}^{n} w_i f(x_i)$ 进行比较，我们将权重 $w_i$ 确定为相应拉格朗日(Lagrange)基多项式的积分：\n$$\nw_i = \\int_{a}^{b} L_{n,i}(x) \\, dx\n$$\n现在我们特化到 $n=1$ 的情况，这对应于梯形法则。对于 $n=1$，我们有 $n+1=2$ 个节点。这些节点是区间的端点：\n$x_0 = a + 0 \\cdot \\frac{b-a}{1} = a$\n$x_1 = a + 1 \\cdot \\frac{b-a}{1} = b$\n\n两个相应的一次拉格朗日(Lagrange)基多项式是：\n$L_{1,0}(x) = \\frac{x-x_1}{x_0-x_1} = \\frac{x-b}{a-b}$\n$L_{1,1}(x) = \\frac{x-x_0}{x_1-x_0} = \\frac{x-a}{b-a}$\n\n现在，我们通过在区间 $[a, b]$ 上对这些基多项式进行积分来计算权重 $w_0$ 和 $w_1$。\n\n对于权重 $w_0$：\n$$\nw_0 = \\int_{a}^{b} L_{1,0}(x) \\, dx = \\int_{a}^{b} \\frac{x-b}{a-b} \\, dx\n$$\n项 $\\frac{1}{a-b}$ 是一个常数，可以提取出来：\n$$\nw_0 = \\frac{1}{a-b} \\int_{a}^{b} (x-b) \\, dx = \\frac{1}{a-b} \\left[ \\frac{x^2}{2} - bx \\right]_{a}^{b}\n$$\n在积分上下限处计算原函数的值：\n$$\nw_0 = \\frac{1}{a-b} \\left( \\left(\\frac{b^2}{2} - b \\cdot b\\right) - \\left(\\frac{a^2}{2} - b \\cdot a\\right) \\right)\n$$\n$$\nw_0 = \\frac{1}{a-b} \\left( \\frac{b^2}{2} - b^2 - \\frac{a^2}{2} + ab \\right) = \\frac{1}{a-b} \\left( -\\frac{b^2}{2} - \\frac{a^2}{2} + ab \\right)\n$$\n提出因子 $-\\frac{1}{2}$：\n$$\nw_0 = \\frac{1}{a-b} \\left( -\\frac{1}{2} (b^2 + a^2 - 2ab) \\right) = \\frac{1}{-(b-a)} \\left( -\\frac{1}{2} (b-a)^2 \\right)\n$$\n$$\nw_0 = \\frac{b-a}{2}\n$$\n\n对于权重 $w_1$：\n$$\nw_1 = \\int_{a}^{b} L_{1,1}(x) \\, dx = \\int_{a}^{b} \\frac{x-a}{b-a} \\, dx\n$$\n项 $\\frac{1}{b-a}$ 是一个常数：\n$$\nw_1 = \\frac{1}{b-a} \\int_{a}^{b} (x-a) \\, dx = \\frac{1}{b-a} \\left[ \\frac{x^2}{2} - ax \\right]_{a}^{b}\n$$\n在积分限处求值：\n$$\nw_1 = \\frac{1}{b-a} \\left( \\left(\\frac{b^2}{2} - a \\cdot b\\right) - \\left(\\frac{a^2}{2} - a \\cdot a\\right) \\right)\n$$\n$$\nw_1 = \\frac{1}{b-a} \\left( \\frac{b^2}{2} - ab - \\frac{a^2}{2} + a^2 \\right) = \\frac{1}{b-a} \\left( \\frac{b^2}{2} - ab + \\frac{a^2}{2} \\right)\n$$\n提出因子 $\\frac{1}{2}$：\n$$\nw_1 = \\frac{1}{b-a} \\left( \\frac{1}{2} (b^2 - 2ab + a^2) \\right) = \\frac{1}{b-a} \\left( \\frac{1}{2} (b-a)^2 \\right)\n$$\n$$\nw_1 = \\frac{b-a}{2}\n$$\n因此，梯形法则（$n=1$ 的闭合牛顿-柯特斯法则）的权重是 $w_0 = \\frac{b-a}{2}$ 和 $w_1 = \\frac{b-a}{2}$。该求积法则是：\n$$\n\\int_{a}^{b} f(x) \\, dx \\approx w_0 f(x_0) + w_1 f(x_1) = \\frac{b-a}{2} f(a) + \\frac{b-a}{2} f(b) = \\frac{b-a}{2} (f(a) + f(b))\n$$\n最终答案是这两个权重的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{b-a}{2}  \\frac{b-a}{2}\n\\end{pmatrix}\n}\n$$", "id": "3526428"}, {"introduction": "牛顿-柯特斯法则使用固定的、等距的节点，而高斯积分法则通过优化采样点的位置来达到更高的精度。本练习将通过推导一个3点高斯-勒让德法则的节点和权重，来探索这种方法的强大之处。通过强制其对高阶多项式精确成立，你将发现那些使该方法如此高效的“神奇”数字。[@problem_id:3526485]", "problem": "在计算天体物理学的许多辐射转移计算中，对极角余弦（用 $\\mu$ 表示）的角度积分出现在矩闭合和通量计算中。当一个量的角依赖性足够光滑时，它可以用关于 $\\mu$ 的多项式精确近似。考虑在区间 $[-1,1]$ 上构造一个求积公式，该公式对所有次数最高为5的关于 $x$ 的多项式都精确，这是 $n=3$ Gauss-Legendre 求积的定义性质。从高斯求积的定义（即选择 $n$ 个节点和权重以精确积分次数最高为 $2n-1$ 的多项式）出发，仅利用对称区间上单项式积分和多项式精确性的基本事实，推导在区间 $[-1,1]$ 上的 $n=3$ Gauss-Legendre 法则的节点 $\\{\\xi_{i}\\}_{i=1}^{3}$ 和权重 $\\{w_{i}\\}_{i=1}^{3}$。然后，验证权重是严格为正的，并且它们的和等于2，这与积分常数函数的结果一致。用精确的符号形式表示最终的节点和权重。最终答案必须是一个单行矩阵，其中包含三个节点，后面跟着三个权重。", "solution": "问题陈述经核实具有科学依据、是适定且客观的。它提出了一个数值分析中的标准可解问题，具有明确的计算天体物理学背景。所有必要信息均已提供，任务是从第一性原理出发推导一个已知结果。\n\n目标是确定在区间 $[-1, 1]$ 上的一个3点数值求积法则的节点 $\\{\\xi_{i}\\}_{i=1}^{3}$ 和权重 $\\{w_{i}\\}_{i=1}^{3}$，该法则对所有次数最高为 $2n-1 = 2(3)-1 = 5$ 的多项式都精确。该求积法则的形式为：\n$$\n\\int_{-1}^{1} f(x) dx \\approx \\sum_{i=1}^{3} w_i f(\\xi_i)\n$$\n要使该法则对多项式 $P(x)$ 精确，必须满足以下等式：\n$$\n\\int_{-1}^{1} P(x) dx = \\sum_{i=1}^{3} w_i P(\\xi_i)\n$$\n我们有六个未知数：三个节点 $(\\xi_1, \\xi_2, \\xi_3)$ 和三个权重 $(w_1, w_2, w_3)$。为了求解这些未知数，我们要求该法则对次数最高为5的多项式空间的一个基是精确的。单项式基 $\\{x^0, x^1, x^2, x^3, x^4, x^5\\}$ 是一个方便的选择。这会得到一个包含六个方程的方程组：\n$$\n\\int_{-1}^{1} x^k dx = \\sum_{i=1}^{3} w_i \\xi_i^k \\quad \\text{for } k = 0, 1, 2, 3, 4, 5\n$$\n首先，我们计算左侧的积分。对于一般的整数 $k \\ge 0$：\n$$\n\\int_{-1}^{1} x^k dx = \\left[ \\frac{x^{k+1}}{k+1} \\right]_{-1}^{1} = \\frac{1^{k+1} - (-1)^{k+1}}{k+1}\n$$\n如果 $k$ 是奇数，则 $k+1$ 是偶数，积分为 $\\frac{1-1}{k+1} = 0$。\n如果 $k$ 是偶数，则 $k+1$ 是奇数，积分为 $\\frac{1-(-1)}{k+1} = \\frac{2}{k+1}$。\n所需的积分为：\n$k=0: \\int_{-1}^{1} 1 dx = 2$\n$k=1: \\int_{-1}^{1} x dx = 0$\n$k=2: \\int_{-1}^{1} x^2 dx = \\frac{2}{3}$\n$k=3: \\int_{-1}^{1} x^3 dx = 0$\n$k=4: \\int_{-1}^{1} x^4 dx = \\frac{2}{5}$\n$k=5: \\int_{-1}^{1} x^5 dx = 0$\n\n积分区间 $[-1, 1]$ 关于 $x=0$ 对称。这个性质强烈暗示节点和权重也应该是对称的。我们对节点进行排序，使得 $\\xi_1  \\xi_2  \\xi_3$。为了对称性，我们必须有一个节点在中心，即 $\\xi_2 = 0$，另外两个节点对称地分布在其两侧，即 $\\xi_3 = -\\xi_1$。对称节点对应的权重必须相等，所以 $w_3 = w_1$。这将未知数的数量从六个减少到三个：$\\xi_3 > 0$、$w_1$ 和 $w_2$。\n\n让我们用这些对称性假设重写方程组。节点为 $\\{-\\xi_3, 0, \\xi_3\\}$，权重为 $\\{w_1, w_2, w_1\\}$。\n对于 $k=0$：\n$w_1 (-\\xi_3)^0 + w_2 (0)^0 + w_1 (\\xi_3)^0 = w_1 + w_2 + w_1 = 2w_1 + w_2 = 2$\n对于 $k=1$：\n$w_1 (-\\xi_3)^1 + w_2 (0)^1 + w_1 (\\xi_3)^1 = -w_1\\xi_3 + 0 + w_1\\xi_3 = 0$。这与积分值匹配，因此对称性假设是一致的。\n对于 $k=2$：\n$w_1 (-\\xi_3)^2 + w_2 (0)^2 + w_1 (\\xi_3)^2 = w_1\\xi_3^2 + 0 + w_1\\xi_3^2 = 2w_1\\xi_3^2 = \\frac{2}{3}$\n对于 $k=3$：\n$w_1 (-\\xi_3)^3 + w_2 (0)^3 + w_1 (\\xi_3)^3 = -w_1\\xi_3^3 + 0 + w_1\\xi_3^3 = 0$。这也是一致的。\n对于 $k=4$：\n$w_1 (-\\xi_3)^4 + w_2 (0)^4 + w_1 (\\xi_3)^4 = w_1\\xi_3^4 + 0 + w_1\\xi_3^4 = 2w_1\\xi_3^4 = \\frac{2}{5}$\n对于 $k=5$：\n$w_1 (-\\xi_3)^5 + w_2 (0)^5 + w_1 (\\xi_3)^5 = -w_1\\xi_3^5 + 0 + w_1\\xi_3^5 = 0$。也一致。\n\n我们得到了一个关于三个未知数 $\\xi_3$、$w_1$ 和 $w_2$ 的三元非线性方程组：\n1. $2w_1 + w_2 = 2$\n2. $2w_1\\xi_3^2 = \\frac{2}{3} \\implies w_1\\xi_3^2 = \\frac{1}{3}$\n3. $2w_1\\xi_3^4 = \\frac{2}{5} \\implies w_1\\xi_3^4 = \\frac{1}{5}$\n\n我们可以通过用方程(3)除以方程(2)来求解 $\\xi_3$：\n$$\n\\frac{w_1\\xi_3^4}{w_1\\xi_3^2} = \\frac{1/5}{1/3}\n$$\n$$\n\\xi_3^2 = \\frac{3}{5}\n$$\n由于我们选择了 $\\xi_3 > 0$，我们有 $\\xi_3 = \\sqrt{\\frac{3}{5}}$。\n因此节点为 $\\xi_1 = -\\sqrt{\\frac{3}{5}}$，$\\xi_2 = 0$ 和 $\\xi_3 = \\sqrt{\\frac{3}{5}}$。\n\n现在，我们求解权重。将 $\\xi_3^2 = \\frac{3}{5}$ 代入方程(2)：\n$$\nw_1 \\left(\\frac{3}{5}\\right) = \\frac{1}{3}\n$$\n$$\nw_1 = \\frac{1}{3} \\cdot \\frac{5}{3} = \\frac{5}{9}\n$$\n因为 $w_3 = w_1$，所以我们有 $w_3 = \\frac{5}{9}$。\n\n最后，使用方程(1)来求 $w_2$：\n$$\n2w_1 + w_2 = 2\n$$\n$$\n2\\left(\\frac{5}{9}\\right) + w_2 = 2\n$$\n$$\n\\frac{10}{9} + w_2 = \\frac{18}{9}\n$$\n$$\nw_2 = \\frac{18}{9} - \\frac{10}{9} = \\frac{8}{9}\n$$\n所以节点为 $\\{-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}\\}$，对应的权重为 $\\{\\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\}$。\n\n问题要求验证权重是严格为正的，并且它们的和等于2。\n权重为 $w_1=w_3=\\frac{5}{9}$ 和 $w_2=\\frac{8}{9}$。它们都显然是正的。\n权重的和为：\n$$\n\\sum_{i=1}^{3} w_i = w_1 + w_2 + w_3 = \\frac{5}{9} + \\frac{8}{9} + \\frac{5}{9} = \\frac{5+8+5}{9} = \\frac{18}{9} = 2\n$$\n这与常数函数 $f(x)=1$ 的精确积分结果 $\\int_{-1}^{1} 1 dx = 2$ 一致。推导出的节点和权重是正确的。\n\n最终的节点和权重以精确符号形式表示为：\n节点: $\\xi_1 = -\\sqrt{\\frac{3}{5}}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{\\frac{3}{5}}$\n权重: $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\sqrt{\\frac{3}{5}}  0  \\sqrt{\\frac{3}{5}}  \\frac{5}{9}  \\frac{8}{9}  \\frac{5}{9} \\end{pmatrix}}\n$$", "id": "3526485"}, {"introduction": "理论上的精度是一回事，但在处理具有尖锐特征的实际问题时的性能则是另一回事。这个编程练习将一个高阶牛顿-柯特斯法则、一个复合辛普森法则和一个高斯-勒让德法则，在相同的函数求值次数预算下进行对比。通过在一个具有陡峭边界层的被积函数上测试它们，你将对等距节点上的高阶插值的危险（龙格现象）获得实践性的认识，并理解为什么高斯或复合方法通常更为稳健。[@problem_id:3526442]", "problem": "考虑一个综合积分，该积分在计算天体物理冷却模型中用于模拟归一化热力学变量高端附近的急剧局部贡献。设该积分为 $$Q=\\int_{0}^{1} f(x)\\,dx$$，其中被积函数定义为 $$f(x;\\varepsilon,p)=\\frac{1}{1+\\left(\\frac{1-x}{\\varepsilon}\\right)^{p}},$$ 参数 $\\varepsilon0$ 控制 $x=1$ 附近边界层的宽度，整数 $p\\ge 1$ 控制过渡的陡峭程度。该函数族在 $[0,1]$ 上是光滑的，有界于 $0\\le f\\le 1$ 之间。当 $\\varepsilon$ 很小时，函数在 $x=1$ 附近具有很大的导数，这对基于等距节点的插值型求积格式构成了挑战。\n\n您的任务是在 $[0,1]$ 区间上，在一个固定的函数求值预算下，实现并比较三种求积策略：\n\n- 单区间 $n_{\\mathrm{NC}}$ 阶闭合 Newton–Cotes 法则（即，在 $[0,1]$ 上使用 $n_{\\mathrm{NC}}+1$ 个等距节点）。\n- 基于 $m$ 个子区间上的 Simpson 法则构建的复合低阶 Newton–Cotes 格式，在 $[0,1]$ 上使用 $2m+1$ 个等距节点。\n- 在 $[0,1]$ 上的 $n_{\\mathrm{G}}$ 点 Gauss–Legendre 求积。\n\n所有方法必须使用相同数量的函数求值次数 $N_{\\mathrm{eval}}$，且 $n_{\\mathrm{NC}}+1=2m+1=n_{\\mathrm{G}}=N_{\\mathrm{eval}}$。您必须选择 $N_{\\mathrm{eval}}=11$，因此 $n_{\\mathrm{NC}}=10$，$m=5$ 且 $n_{\\mathrm{G}}=11$。\n\n为了进行验证，请在 $p=1$ 和 $p=2$ 的特殊情况下使用 $Q$ 的精确解析表达式。这些表达式可通过换元 $u=(1-x)/\\varepsilon$ 得到，具体如下\n$$Q(\\varepsilon,1)=\\varepsilon\\,\\ln\\!\\left(1+\\frac{1}{\\varepsilon}\\right)，\\qquad Q(\\varepsilon,2)=\\varepsilon\\,\\arctan\\!\\left(\\frac{1}{\\varepsilon}\\right)。$$\n\n请从多项式插值和正交多项式的基本原理出发实现这三种求积方法，不要使用任何自适应加密。您可以利用标准数值库来获取高阶闭合 Newton–Cotes 法则和 Gauss–Legendre 法则的权重和节点。\n\n测试套件。请对以下参数集评估绝对求积误差 $\\left|Q_{\\mathrm{approx}}-Q_{\\mathrm{exact}}\\right|$：\n- 情况 A：$(\\varepsilon,p)=(0.2,1)$。\n- 情况 B：$(\\varepsilon,p)=(0.01,1)$。\n- 情况 C：$(\\varepsilon,p)=(0.05,2)$。\n- 情况 D：$(\\varepsilon,p)=(1.0,2)$。\n- 情况 E：$(\\varepsilon,p)=(0.001,1)$。\n\n对于每种情况，报告一个包含三个浮点数的列表，这些浮点数分别对应于以下方法产生的绝对误差，顺序为：单区间 10 阶闭合 Newton–Cotes 法则、使用 $m=5$ 个子区间的复合 Simpson 法则、以及 11 点 Gauss–Legendre 求积。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身是针对一个测试用例的包含三个浮点数的列表，顺序为 [情况 A, 情况 B, 情况 C, 情况 D, 情况 E]。例如，一个有效的输出格式是\n\"[[eA1,eA2,eA3],[eB1,eB2,eB3],[eC1,eC2,eC3],[eD1,eD2,eD3],[eE1,eE2,eE3]]\"\n其中每个 $e\\cdot\\cdot$ 是一个浮点数。", "solution": "该问题要求实现并比较三种数值求积方法，用于近似积分 $Q=\\int_{0}^{1} f(x)\\,dx$，其中被积函数为 $f(x;\\varepsilon,p)=\\frac{1}{1+\\left(\\frac{1-x}{\\varepsilon}\\right)^{p}}$。此函数模拟了一个在 $x=1$ 附近的急剧过渡，即边界层，其宽度由 $\\varepsilon0$ 控制。过渡的陡峭程度由整数参数 $p\\ge 1$ 决定。当 $\\varepsilon$ 值很小时，被积函数在 $x=1$ 附近的导数变得非常大，这对数值积分格式，特别是那些基于等距节点的格式，构成了挑战。\n\n比较将在每种方法固定使用 $N_{\\mathrm{eval}}=11$ 次函数求值的预算下进行。这三种方法是：\n1.  单区间 $n_{\\mathrm{NC}}=10$ 阶闭合 Newton–Cotes 法则。\n2.  基于 $m=5$ 个子区间的复合 Simpson 法则。\n3.  $n_{\\mathrm{G}}=11$ 点 Gauss–Legendre 求积。\n\n请注意，每种方法的节点数与预算一致：$n_{\\mathrm{NC}}+1 = 10+1=11$，$2m+1 = 2(5)+1=11$，以及 $n_{\\mathrm{G}}=11$。\n\n通过计算几个测试用例的绝对误差 $|Q_{\\mathrm{approx}}-Q_{\\mathrm{exact}}|$ 来评估每种方法的准确性。对于 $p=1$ 和 $p=2$ 的特殊情况，题目给出了积分的精确值，这涵盖了所有测试用例。\n对于 $p=1$：$Q(\\varepsilon,1)=\\varepsilon\\,\\ln\\!\\left(1+\\frac{1}{\\varepsilon}\\right)$。\n对于 $p=2$：$Q(\\varepsilon,2)=\\varepsilon\\,\\arctan\\!\\left(\\frac{1}{\\varepsilon}\\right)$。\n\n当 $\\varepsilon$ 很小时，被积函数 $f(x)$ 在 $x=1$ 附近形成一个急剧的边界层。使用等距节点的求积格式，例如单区间 Newton-Cotes 法则和复合 Simpson 法则，预计表现会较差，因为它们可能无法在这个快速变化的狭窄区域内放置足够的采样点。相比之下，Gauss-Legendre 求积将节点聚集在积分区间的端点附近，因此预计能更好地解析 $x=1$ 处的特征，从而提供更准确的近似。\n\n每种方法的实现原理详述如下。\n\n### 方法一：单区间 10 阶闭合 Newton–Cotes 法则\n\n此方法通过对一个穿过 $[0,1]$ 区间上 $N_{\\mathrm{eval}}=11$ 个等距点的 $n_{\\mathrm{NC}}=10$ 阶插值多项式进行积分来近似原积分。\n节点由 $x_i = a + i \\cdot h$ 给出，其中 $i=0, 1, \\dots, n_{\\mathrm{NC}}$，区间为 $[a,b]=[0,1]$，步长为 $h=(b-a)/n_{\\mathrm{NC}} = (1-0)/10 = 0.1$。因此，$x_i = i/10$。\n求积公式为：\n$$ Q_{\\mathrm{NC}} = \\int_0^1 f(x) dx \\approx h \\sum_{i=0}^{n_{\\mathrm{NC}}} C_i^{(n_{\\mathrm{NC}})} f(x_i) $$\nNewton-Cotes 系数 $C_i^{(n_{\\mathrm{NC}})}$ 是通过对 Lagrange 基多项式积分得到的。按照题目允许，这些系数通过一个标准数值库函数，具体是 `scipy.integrate.newton_cotes`，来获取。对于 $n_{\\mathrm{NC}}=10$ 和区间 $[0,1]$，积分近似值使用 $h=0.1$ 进行计算。\n\n### 方法二：复合 Simpson 法则\n\n此方法将积分区间 $[0,1]$ 分成 $m=5$ 个等宽的子区间。在每个子区间上，函数由一个二次多项式（Simpson 法则）来近似。\n总节点数为 $N_{\\mathrm{eval}}=2m+1=11$，与 Newton-Cotes 方法中使用的等距节点相同：$x_i = i/10$，其中 $i=0, \\dots, 10$。相邻节点间的步长为 $h=1/10$。\n复合 Simpson 法则的公式为：\n$$ Q_{\\mathrm{CS}} = \\frac{h}{3} \\left[ f(x_0) + 4\\sum_{j=1}^{m} f(x_{2j-1}) + 2\\sum_{j=1}^{m-1} f(x_{2j}) + f(x_{2m}) \\right] $$\n代入 $m=5$ 和节点索引，公式变为：\n$$ Q_{\\mathrm{CS}} = \\frac{h}{3} \\left[ f(x_0) + 4(f(x_1)+f(x_3)+\\dots+f(x_9)) + 2(f(x_2)+f(x_4)+\\dots+f(x_8)) + f(x_{10}) \\right] $$\n该公式被直接实现。\n\n### 方法三：11 点 Gauss–Legendre 求积\n\n对于给定数量的节点，Gauss-Legendre 求积通过将节点优化地放置在 Legendre 多项式的根上，提供了最高的代数精度。对于一个 $n_{\\mathrm{G}}$ 点法则，它可以精确地对最高 $2n_{\\mathrm{G}}-1$ 阶的多项式进行积分。\n标准的 Gauss-Legendre 法则定义在区间 $[-1,1]$ 上：\n$$ \\int_{-1}^1 g(\\xi) d\\xi \\approx \\sum_{i=1}^{n_{\\mathrm{G}}} w_i^{\\mathrm{std}} g(\\xi_i^{\\mathrm{std}}) $$\n其中 $\\xi_i^{\\mathrm{std}}$ 是节点（第 $n_{\\mathrm{G}}$ 阶 Legendre 多项式的根），$w_i^{\\mathrm{std}}$ 是对应的权重。\n为了将其应用于区间 $[a,b]=[0,1]$，我们使用线性变换 $x = \\frac{b-a}{2}\\xi + \\frac{a+b}{2}$，对于 $[0,1]$ 区间该变换变为 $x = \\frac{1}{2}(\\xi+1)$。微分元变换为 $dx = \\frac{1}{2}d\\xi$。\n积分变为：\n$$ Q_{\\mathrm{GL}} = \\int_0^1 f(x) dx = \\int_{-1}^1 f\\left(\\frac{\\xi+1}{2}\\right) \\frac{1}{2} d\\xi \\approx \\sum_{i=1}^{n_{\\mathrm{G}}} \\left(\\frac{1}{2}w_i^{\\mathrm{std}}\\right) f\\left(\\frac{\\xi_i^{\\mathrm{std}}+1}{2}\\right) $$\n在 $[0,1]$ 上的变换后的节点为 $x_i = (\\xi_i^{\\mathrm{std}}+1)/2$，变换后的权重为 $w_i = w_i^{\\mathrm{std}}/2$。对于本问题，$n_{\\mathrm{G}}=11$。标准节点和权重从 `numpy.polynomial.legendre.leggauss` 获取。\n\n### 计算策略\n\n将构建一个 Python 脚本来执行所需的计算。对于由 $(\\varepsilon,p)$ 定义的五个测试用例中的每一个：\n1.  定义具体的被积函数 $f(x)$。\n2.  使用提供的解析公式计算精确积分 $Q_{\\mathrm{exact}}$。\n3.  使用 $N_{\\mathrm{eval}}=11$ 计算三种求积近似值（$Q_{\\mathrm{NC}}$、$Q_{\\mathrm{CS}}$、$Q_{\\mathrm{GL}}$）。\n4.  计算这三种方法的绝对误差并存储在列表中。\n5.  最终输出被格式化为这些误差列表的列表，每个测试用例对应一个，并打印到单行上。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import newton_cotes\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Implements and compares three quadrature strategies on a test integral\n    from computational astrophysics, reporting the absolute errors.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon, p), label\n        (0.2, 1, 'A'),\n        (0.01, 1, 'B'),\n        (0.05, 2, 'C'),\n        (1.0, 2, 'D'),\n        (0.001, 1, 'E'),\n    ]\n\n    # Shared parameters for all methods\n    N_eval = 11\n    a, b = 0.0, 1.0\n\n    all_results = []\n\n    for epsilon, p, _ in test_cases:\n        # 1. Define the integrand and exact solution\n        \n        # The integrand f(x; epsilon, p)\n        f = lambda x: 1.0 / (1.0 + ((1.0 - x) / epsilon)**p)\n\n        # The exact analytic solution Q(epsilon, p)\n        if p == 1:\n            Q_exact = epsilon * np.log(1.0 + 1.0 / epsilon)\n        elif p == 2:\n            Q_exact = epsilon * np.arctan(1.0 / epsilon)\n        else:\n            # This case will not be reached with the given test suite\n            raise ValueError(\"No exact solution provided for p != 1 or 2\")\n\n        # 2. Implement and apply the three quadrature methods\n\n        # Method 1: Single-panel closed Newton-Cotes of degree 10\n        n_nc = 10\n        nodes_nc = np.linspace(a, b, N_eval)\n        evals_nc = f(nodes_nc)\n        weights_nc_coeffs, _ = newton_cotes(n_nc)\n        h_nc = (b - a) / n_nc\n        Q_nc = h_nc * np.sum(weights_nc_coeffs * evals_nc)\n\n        # Method 2: Composite Simpson's rule with m=5 panels\n        m = 5\n        # Nodes are the same as for Newton-Cotes\n        nodes_cs = np.linspace(a, b, N_eval)\n        evals_cs = f(nodes_cs)\n        h_cs = (b - a) / (N_eval - 1)\n        Q_cs = (h_cs / 3.0) * (\n            evals_cs[0] + \n            4.0 * np.sum(evals_cs[1:-1:2]) + \n            2.0 * np.sum(evals_cs[2:-1:2]) + \n            evals_cs[-1]\n        )\n        # Note: evals[1:-1:2] is slightly different from problem description's sum limits\n        # but is correct for Python slicing. It selects all odd indices between 0 and N-1.\n\n        # Method 3: 11-point Gauss-Legendre quadrature\n        n_g = 11\n        nodes_gl_std, weights_gl_std = leggauss(n_g)\n        # Transform nodes and weights from [-1, 1] to [a, b] = [0, 1]\n        nodes_gl = 0.5 * (b - a) * nodes_gl_std + 0.5 * (a + b)\n        weights_gl = 0.5 * (b - a) * weights_gl_std\n        evals_gl = f(nodes_gl)\n        Q_gl = np.sum(weights_gl * evals_gl)\n\n        # 3. Calculate absolute errors\n        error_nc = abs(Q_nc - Q_exact)\n        error_cs = abs(Q_cs - Q_exact)\n        error_gl = abs(Q_gl - Q_exact)\n        \n        case_results = [error_nc, error_cs, error_gl]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Ex: \"[[eA1,eA2,eA3],[eB1,eB2,eB3],...]\"\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3526442"}]}