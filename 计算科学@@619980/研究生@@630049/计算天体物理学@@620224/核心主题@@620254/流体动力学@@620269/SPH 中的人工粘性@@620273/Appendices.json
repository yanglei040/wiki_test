{"hands_on_practices": [{"introduction": "本练习旨在解决一个基本问题：为何在光滑粒子流体动力学（SPH）中，标准的人工粘性项同时包含线性和二次两个部分？该练习将引导您探索此结构背后的物理依据。通过分析跨越激波的动量通量，您将推断出为何一个与速度成二次关系的项对于正确捕捉强高马赫数激波至关重要，而线性项则更适用于较弱的激波。这个实践揭示了粘性公式中 $\\alpha$ 和 $\\beta$ 参数各自扮演的不同物理角色。[@problem_id:3465341]", "problem": "在用光滑粒子流体动力学 (SPH) 模拟气体动力学的宇宙学激波捕获中，可压缩欧拉方程\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0, \\qquad\n\\frac{\\partial (\\rho \\mathbf{v})}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}\\mathbf{v} + P \\mathbf{I}) = 0,\n$$\n缺乏物理粘性，因此不能耗散激波处的动能通量。为稳定激波并防止粒子相互穿透，引入了一种人工粘性来阻尼接近运动。考虑一对等质量的 SPH 粒子，其分离矢量为 $\\mathbf{r}_{ij}$，接近径向速度为 $v_{r} \\equiv -\\mathbf{v}_{ij} \\cdot \\hat{\\mathbf{r}}_{ij}  0$（其中 $\\hat{\\mathbf{r}}_{ij} \\equiv \\mathbf{r}_{ij}/r_{ij}$）。人工粘性由一个无量纲的接近度量构建而成，\n$$\n\\mu_{ij} \\equiv \\frac{h v_{r}}{r_{ij}},\n$$\n其中 $h$ 是局部光滑长度。人工粘性还包含两个贡献项，通常称为带有系数 $\\alpha$ 和 $\\beta$ 的线性和二次项。设特征声速为 $c_{s}$，马赫数为 $\\mathcal{M} \\equiv v_{r}/c_{s}$。\n\n以可压缩欧拉方程为基本基础，并从跨激波的动量通量平衡出发进行论证，证明为何在高马赫数下需要速度的二次耗散来防止粒子相互穿透，并推导马赫数阈值 $\\mathcal{M}_{\\star}$。当马赫数高于此阈值时，二次贡献（与 $\\beta \\mu_{ij}^{2}$ 成正比）将主导线性贡献（与 $\\alpha c_{s} \\mu_{ij}$ 成正比）。假设 $v_{r}  0$ 并忽略任何小的正则化项，用 $\\alpha$、$\\beta$ 和 $h/r_{ij}$ 表示 $\\mathcal{M}_{\\star}$。\n\n然后，对于典型的宇宙学 SPH 配置，其中相邻粒子的分离距离与光滑长度相当，取 $\\alpha = 1$，$\\beta = 2$ 和 $h/r_{ij} = 1$ 来估计 $\\mathcal{M}_{\\star}$ 的数值。将最终答案表示为一个纯数（无量纲），并将您的估计值四舍五入到三位有效数字。", "solution": "该问题陈述科学基础扎实，问题良定，并包含了获得完整解答所需的所有信息。它准确描述了光滑粒子流体动力学 (SPH) 中人工粘性的物理动机和数学表述，这是计算天体物理学中的一项标准技术。所提出的问题是精确的，并能导出一个唯一、可推导的答案。\n\n该问题需要进行两部分分析：首先，为高马赫数激波中的二次粘性项提供物理解释；其次，推导该项开始占主导地位时的马赫数阈值，然后进行数值估计。\n\n首先，我们来论证为何需要一个速度的二次耗散项。可压缩欧拉方程描述了理想、无粘性流体的动力学。像欧拉方程这样的双曲守恒律的一个关键特征是，从初始光滑的条件可以形成不连续性，即激波。在物理激波前沿，密度、压力和温度会急剧增加，同时速度会迅速下降。这个过程本质上是耗散性的，将动能转化为内能（热能）。欧拉方程缺乏物理粘性项（如 Navier-Stokes 方程中存在的项），因此无法模拟这种耗散。在像 SPH 这样的将流体离散为粒子的数值格式中，这种耗散的缺乏会导致激波处的非物理行为：粒子可能会越过激波前沿并相互穿透，从而导致数值不稳定性和不正确的激波结构。\n\n标准的补救方法是引入人工粘性，它作为一个压力项，仅在强压缩区域（如激波）才显著。这个人工压力，我们称之为 $P_{\\text{visc}}$，必须提供必要的动量耗散。为了理解 $P_{\\text{visc}}$ 所需的形式，我们考虑由 Rankine-Hugoniot 跳跃条件描述的跨激波的动量平衡。在一维激波的静止参考系中，动量通量守恒由下式给出：\n$$\n\\rho_{1} v_{1}^{2} + P_{1} = \\rho_{2} v_{2}^{2} + P_{2}\n$$\n其中下标 1 和 2 分别表示激波前和激波后的状态。对于强激波，来流是高度超音速的，意味着马赫数 $\\mathcal{M}_{1} = v_{1}/c_{s,1} \\gg 1$。在此极限下，流动的动能远大于其内能，因此，冲压 $\\rho_{1} v_{1}^{2}$ 远大于热压 $P_{1}$。使流动停止所需的压力跳跃 $\\Delta P = P_{2} - P_{1}$ 必须与来流冲压的量级相同：\n$$\n\\Delta P \\approx \\rho_{1} v_{1}^{2}\n$$\n有效的人工粘性必须产生一个具有相似标度关系的压力 $P_{\\text{visc}}$。SPH 人工粘性由两部分构成：一个线性项和一个二次项。问题陈述了它们对无量纲接近度量 $\\mu_{ij} \\equiv \\frac{h v_{r}}{r_{ij}}$ 的依赖关系，其中 $v_{r}$ 是一对粒子的接近径向速度。\n\n对粘性压力的线性贡献与 $\\alpha c_{s} \\mu_{ij}$ 成正比：\n$$\nP_{\\text{visc, lin}} \\propto \\alpha c_{s} \\left( \\frac{h v_{r}}{r_{ij}} \\right) \\propto v_{r}\n$$\n该项提供了一个与接近速度成线性关系的耗散压力。\n\n二次贡献与 $\\beta \\mu_{ij}^{2}$ 成正比：\n$$\nP_{\\text{visc, quad}} \\propto \\beta \\left( \\frac{h v_{r}}{r_{ij}} \\right)^{2} \\propto v_{r}^{2}\n$$\n该项提供了一个与接近速度成二次关系的耗散压力。\n\n将这些标度关系与物理要求（激波压力必须与冲压成比例，$P_{\\text{shock}} \\sim \\rho v_{r}^{2}$）进行比较，可以清楚地看到，二次项 $P_{\\text{visc, quad}}$ 具有正确的对速度的函数依赖关系，能够处理强激波。线性项仅与 $v_{r}$ 成正比，除非其系数 $\\alpha$ 非物理地大，否则不足以在高马赫数下防止粒子相互穿透。因此，二次项对于提供必要的体积粘性以正确捕捉强、高马赫数激波的物理过程至关重要。\n\n接下来，我们推导二次贡献开始主导线性贡献的马赫数阈值 $\\mathcal{M}_{\\star}$。这个阈值出现在两项的量值相等时。我们令线性和二次贡献的表达式相等：\n$$\n\\beta \\mu_{ij}^{2} = \\alpha c_{s} \\mu_{ij}\n$$\n问题指明粒子正在接近，因此 $v_{r}  0$，这意味着 $\\mu_{ij}  0$。因此，我们可以在不失一般性的情况下将两边同除以 $\\mu_{ij}$：\n$$\n\\beta \\mu_{ij} = \\alpha c_{s}\n$$\n现在，我们将 $\\mu_{ij} = \\frac{h v_{r}}{r_{ij}}$ 的定义代入方程：\n$$\n\\beta \\left( \\frac{h v_{r}}{r_{ij}} \\right) = \\alpha c_{s}\n$$\n马赫数定义为 $\\mathcal{M} \\equiv v_{r}/c_{s}$。我们寻求该比率在阈值处的值，记作 $\\mathcal{M}_{\\star}$。我们重新整理方程以解出 $v_{r}/c_{s}$：\n$$\n\\frac{v_{r}}{c_{s}} = \\frac{\\alpha}{\\beta} \\frac{r_{ij}}{h}\n$$\n因此，阈值马赫数 $\\mathcal{M}_{\\star}$ 由下式给出：\n$$\n\\mathcal{M}_{\\star} = \\frac{\\alpha}{\\beta} \\left( \\frac{h}{r_{ij}} \\right)^{-1}\n$$\n此表达式按要求给出了用参数 $\\alpha$、$\\beta$ 和比率 $h/r_{ij}$ 表示的阈值。对于马赫数 $\\mathcal{M}  \\mathcal{M}_{\\star}$，二次项将占主导地位。\n\n最后，我们使用给定的典型宇宙学 SPH 值来估计 $\\mathcal{M}_{\\star}$ 的数值：$\\alpha = 1$，$\\beta = 2$，以及 $h/r_{ij} = 1$。将这些值代入我们推导出的表达式：\n$$\n\\mathcal{M}_{\\star} = \\frac{1}{2} \\left( 1 \\right)^{-1} = \\frac{1}{2} = 0.5\n$$\n问题要求将此估计值四舍五入到三位有效数字。因此，数值为 $0.500$。", "answer": "$$\\boxed{0.500}$$", "id": "3465341"}, {"introduction": "虽然人工粘性对于捕捉激波至关重要，但其耗散效应对其他类型的流体运动（如涡旋或剪切流）可能是有害的。本练习让您扮演方法开发者的角色，任务是设计一个“智能开关”，仅在需要时激活粘性。从基本物理原理出发，您将构建一个数学函数，利用局部流动属性——特别是压缩和涡度——来调节粘性，从而在确保激波区域稳定性的同时，保护旋转流动的动力学特性。[@problem_id:3465306]", "problem": "在宇宙学光滑粒子流体动力学 (SPH) 中，引入人工粘性是为了捕捉激波，同时避免在涡旋或剪切主导的流场中产生伪耗散。一种常见的策略是通过一个开关因子来调节人工粘性系数，该开关因子在涡度主导压缩的区域抑制粘性。考虑一个开关函数 $f$，它与基础人工粘性系数 $\\alpha$ 相乘，得到有效系数 $f \\alpha$。开关 $f$ 应满足从第一性原理和量纲分析导出的以下原则：\n\n- 它仅依赖于区分压缩和旋转的运动学不变量，即散度的大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度的大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n- 它是无量纲的，界于 $0$ 和 $1$ 之间，在固定的 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 单调增加，在固定的 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 单调减少。\n- 通过引入一个由局部信号速度 $c$ 和光滑长度 $h$ 构建的正则化项，并与一个小的无量纲参数 $\\epsilon0$ 结合，它在静止流中保持良定义，使得该组合项与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 具有相同的量纲。\n\n(a) 使用这些要求，构建一个由容许不变量的非负线性贡献构成的 $f$ 的最简容许形式，该形式需满足所述的单调性、有界性和量纲约束。\n\n(b) 对于一个宇宙学 SPH 计算中的局部涡旋流，其中 $\\left|\\nabla \\cdot \\mathbf{v}\\right|=0.01$，$\\left|\\nabla \\times \\mathbf{v}\\right|=10$，$c=1$，$h=0.05$，$\\epsilon=0.1$，基础系数 $\\alpha=1$，计算开关 $f$ 和有效人工粘性系数 $f\\alpha$。\n\n将 $f$ 和 $f\\alpha$ 的数值结果四舍五入到四位有效数字。按顺序 $\\left(f, f\\alpha\\right)$ 将你的最终答案报告为两个不带单位的数字。", "solution": "用户提供了一个问题，要求基于一系列物理原理推导光滑粒子流体动力学 (SPH) 中用于人工粘性的开关函数，并进行数值评估。\n\n### 步骤1：问题验证\n\n首先，我必须验证问题陈述。\n\n#### 1.1. 提取给定条件\n\n- **背景**：宇宙学 SPH 中的人工粘性。\n- **目标**：用开关函数 $f$ 调节基础人工粘性系数 $\\alpha$，得到有效系数 $f\\alpha$。\n- **构建 $f$ 的原则**：\n    1.  $f$ 仅依赖于散度大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n    2.  $f$ 是无量纲且有界的，使得 $0 \\le f \\le 1$。\n    3.  $f$ 表现出特定的单调性：在固定的 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 下，它随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 增加；在固定的 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 下，它随 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 减小。\n    4.  $f$ 被正则化以在静止流中保持良定义。正则化项由局部信号速度 $c$、光滑长度 $h$ 和一个小的无量纲参数 $\\epsilon  0$ 构成。该项必须与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 具有相同的量纲。\n    5. $f$ 的形式应是由容许不变量的非负线性贡献构成的“最简容许形式”。\n- **(a) 部分任务**：构建 $f$ 的数学形式。\n- **(b) 部分任务**：使用以下数值计算 $f$ 和 $f\\alpha$：\n    - $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n    - $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n    - $c = 1$\n    - $h = 0.05$\n    - $\\epsilon = 0.1$\n    - $\\alpha = 1$\n- **输出要求**：将数值结果四舍五入到四位有效数字，并以有序对 $(f, f\\alpha)$ 的形式报告。\n\n#### 1.2. 对照标准进行验证\n\n- **科学依据**：该问题在计算流体动力学和天体物理学领域有充分的依据。人工粘性的使用，特别是基于散度与涡度之比的开关来抑制剪切流中的粘性，是 SPH 中一种标准且有据可查的技术（例如，Balsara 开关）。所述原则在物理和数学上都是合理的。\n- **适定性**：该问题是适定的。(a) 部分要求基于一组明确的约束推导函数形式。“最简形式”是此类推导中的标准启发式方法，并导出一个特定的、常用的函数。(b) 部分是使用推导出的公式进行的直接数值计算。存在唯一解。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n- **缺陷检查**：该问题没有违反任何不合格的缺陷。它并非科学上不合理，是可形式化的，是完整的，提出了一个现实可行的任务，结构良好，并且不是琐碎或同义反复的。\n\n#### 1.3. 结论\n\n问题有效。我现在将进行解答。\n\n### 步骤2：求解推导\n\n#### (a) 部分：构建开关函数 $f$\n\n设散度大小为 $D = \\left|\\nabla \\cdot \\mathbf{v}\\right|$，涡度大小为 $W = \\left|\\nabla \\times \\mathbf{v}\\right|$。在流体动力学中，$D$ 和 $W$ 的量纲都是时间的倒数，即 $[T^{-1}]$。\n\n1.  **量纲性**：函数 $f$ 必须是无量纲的。这要求它是一个由输入量的无量纲组合构成的函数。从 $D$ 和 $W$ 构成无量纲量的最简单方法是取它们的比值，或具有相同量纲的表达式的比值。\n\n2.  **单调性**：函数 $f$ 必须随 $D$ 增加而增加，随 $W$ 增加而减小。这表明 $D$ 应该在分子中，$W$ 应该在分母中。让我们考虑一个一般形式 $f = g\\left(\\frac{D}{W}\\right)$，其中 $g$ 是某个函数。为满足单调性，$g$ 必须是其自变量的增函数。\n\n3.  **简明性和有界性**：问题要求“由非负线性贡献构成的最简容许形式”。这表明它是一个有理函数，其分子和分母是可用项的线性组合。我们提出一种形式：\n    $$f = \\frac{k_1 D}{k_2 D + k_3 W}$$\n    其中 $k_1, k_2, k_3$ 是正的无量纲常数。此形式是无量纲的。\n    - 为了满足有界性条件 $f \\le 1$，我们需要 $k_1 D \\le k_2 D + k_3 W$。整理后得到 $(k_1 - k_2)D \\le k_3 W$。为使此式对所有非负的 $D$ 和 $W$ 成立，最简单的选择是令 $k_1 = k_2$。\n    - “最简”形式和“非负线性贡献”的要求意味着我们应该选择尽可能简单的常数，例如 $1$。设 $k_1 = k_2 = k_3 = 1$ 得到以下形式：\n    $$f = \\frac{D}{D+W} = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right|}$$\n    对于非负的 $D$ 和 $W$，此形式界于 $0$ 和 $1$ 之间，并满足单调性要求。\n\n4.  **正则化**：如果 $D$ 和 $W$ 均为零，则上述形式无定义。问题要求一个正则化项来防止这种情况。这个项，我们称之为 $R$，必须与 $D$ 和 $W$ 具有相同的量纲，即 $[T^{-1}]$。它由信号速度 $c$（量纲为 $[L T^{-1}]$）、光滑长度 $h$（量纲为 $[L]$）和无量纲参数 $\\epsilon  0$ 构成。$c$ 和 $h$ 唯一能产生 $[T^{-1}]$ 量纲的组合是 $c/h$。因此，正则化项与此成正比，例如 $R = \\epsilon \\frac{c}{h}$。\n    为了将此正则化项并入我们的“最简线性贡献”形式，我们将其添加到分母中以防止除以零。这保持了函数的结构及其无量纲性质。\n\n综合这些原则，开关函数 $f$ 的最简容许形式是：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + \\epsilon \\frac{c}{h}}$$\n此形式满足所有陈述的条件：它依赖于正确的不变量，是无量纲的，界于 $0$ 和 $1$ 之间，具有正确的单调行为，并且为静止流进行了正则化。\n\n#### (b) 部分：数值评估\n\n我们给定以下数值：\n- $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n- $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n- $c = 1$\n- $h = 0.05$\n- $\\epsilon = 0.1$\n- $\\alpha = 1$\n\n首先，计算正则化项 $R = \\epsilon \\frac{c}{h}$：\n$$R = (0.1) \\frac{1}{0.05} = 0.1 \\times 20 = 2$$\n\n现在，将数值代入推导出的开关函数 $f$ 的表达式中：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + R} = \\frac{0.01}{0.01 + 10 + 2} = \\frac{0.01}{12.01}$$\n$$f \\approx 0.000832639467...$$\n四舍五入到四位有效数字，我们得到：\n$$f \\approx 0.0008326$$\n\n接下来，我们计算有效人工粘性系数 $f\\alpha$。由于基础系数 $\\alpha = 1$，有效系数在数值上等于 $f$：\n$$f\\alpha = (0.0008326) \\times 1 = 0.0008326$$\n\n问题要求两个数字 $(f, f\\alpha)$。其值为 $(0.0008326, 0.0008326)$。开关函数的这个极低的值是预料之中的，因为与压缩（$\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$）相比，流场由涡度（$\\left|\\nabla \\times \\mathbf{v}\\right| = 10$）强烈主导，这正是应该抑制人工粘性的情况。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0008326  0.0008326 \\end{pmatrix} } $$", "id": "3465306"}, {"introduction": "每一种数值方法都有其计算成本，人工粘性也不例外。本实践将激波捕捉的物理学与数值模拟的实际约束联系起来。通过引入一个有效的信号速度，人工粘性对模拟的时间步长施加了严格限制，以确保数值稳定性，这由Courant-Friedrichs-Lewy (CFL) 条件所规定。通过这个练习，您将推导并计算这个临界时间步长，从而深入理解为何具有强激波的区域常常成为大规模宇宙学模拟中的计算瓶颈。[@problem_id:3465304]", "problem": "在用于数值宇宙学的平滑粒子流体动力学（SPH，Smoothed Particle Hydrodynamics）中，人工粘性引入了一个特征性的成对信号速度，该速度限制了压缩扰动在相邻粒子间传播的速度。对于一个显式时间积分方法，稳定性和因果性要求信息在单个时间步长内传播的距离不能超过局部解析尺度的一个常数阶分数，这一要求通常由 Courant–Friedrichs–Lewy（CFL，Courant–Friedrichs–Lewy）条件来表述。考虑一个在宇宙学背景下，在流体动力学和引力作用下演化的单个SPH粒子，其局部平滑长度为 $h$，对其邻近粒子的最大成对人工粘性信号速度的估计值为 $v_{\\text{sig}}$。假设采用一个标准的显式格式，其中唯一相关的限制是由有限信号在核函数尺度上传播所设定的，并由一个无量纲 Courant 因子 $C_{\\text{CFL}} \\in (0,1)$ 进行调节。\n\n从这些原理和定义出发，推导该粒子最大允许时间步长 $\\Delta t_{\\max}$ 关于 $h$、$v_{\\text{sig}}$ 和 $C_{\\text{CFL}}$ 的通用表达式。然后，对于一个 $h = 0.005$、邻域最大 $v_{\\text{sig}} = 30$ 且 $C_{\\text{CFL}} = 0.25$ 的粒子，计算这个最大时间步长。所有量均以一致的代码单位给出，因此所得的时间步长也以代码时间单位表示。将你的最终数值答案四舍五入到 $4$ 位有效数字。最后，根据你的推导，讨论该限制对宇宙学模拟中局域时间步长策略的影响，特别是在具有强激波和巨大密度梯度的区域。你最终报告的答案必须是 $\\Delta t_{\\max}$ 在代码时间单位下的单一数值。", "solution": "相关的出发点是双曲型系统中具有有限信号传播速度的显式时间积分的稳定性约束。在此类系统中，Courant–Friedrichs–Lewy (CFL) 条件强制要求在一个时间步长内，最快的信号传播的距离不应超过局部解析尺度的一个常数阶分数。在平滑粒子流体动力学 (SPH) 中，局部解析尺度由平滑长度 $h$ 设定，而在存在人工粘性的情况下，压缩扰动的最大邻近粒子间传播速度由一个通过成对相互作用构建的估计值 $v_{\\text{sig}}$ 来描述。\n\n基本要求是，在时间步长 $\\Delta t$ 内，最快相关信号传播的距离受解析长度的一部分限制。写出这个因果性和稳定性约束：\n$$\nv_{\\text{sig}} \\, \\Delta t \\lesssim C_{\\text{CFL}} \\, h,\n$$\n其中 $C_{\\text{CFL}} \\in (0,1)$ 是一个无量纲的 Courant 因子，它包含了核函数支撑域的几何常数、显式格式的细节，以及为非线性和多维效应留出的安全裕度。求解这个不等式以得到时间步长限制，给出通用表达式：\n$$\n\\Delta t_{\\max} = \\frac{C_{\\text{CFL}} \\, h}{v_{\\text{sig}}}.\n$$\n\n这直接源于 (i) SPH 平滑长度 $h$ 作为解析相互作用的特征核函数尺度的定义，(ii) 将 $v_{\\text{sig}}$ 认定为由人工粘性引入以捕捉压缩激波的邻近粒子间信息速度的上界，以及 (iii) 显式方法要求离散格式的依赖域必须包含连续介质问题依赖域的稳定性要求。\n\n我们现在用指定的粒子数据来计算这个表达式。给定 $h = 0.005$，$v_{\\text{sig}} = 30$ 和 $C_{\\text{CFL}} = 0.25$，所有量均在一致的代码单位下，我们代入\n$$\n\\Delta t_{\\max} = \\frac{C_{\\text{CFL}} \\, h}{v_{\\text{sig}}}.\n$$\n计算分子：\n$$\nC_{\\text{CFL}} \\, h = 0.25 \\times 0.005 = 0.00125.\n$$\n除以 $v_{\\text{sig}}$：\n$$\n\\Delta t_{\\max} = \\frac{0.00125}{30} = 0.000041666\\ldots = 4.166666\\ldots \\times 10^{-5}.\n$$\n四舍五入到 $4$ 位有效数字得到\n$$\n\\Delta t_{\\max} = 4.167 \\times 10^{-5},\n$$\n单位为代码时间单位。\n\n对宇宙学模拟中局域时间步长的影响：推导出的限制表明 $\\Delta t_{\\max} \\propto h / v_{\\text{sig}}$。在宇宙学结构形成过程中，高密度区域（如维里化晕和激波前沿）通常具有较小的 $h$（由于拉格朗日自适应性使解析度集中）和较大的 $v_{\\text{sig}}$（由于增大的声速和跨压缩流的相对速度会触发更强的人工粘性）。因此，在这些区域，与弥散的星系际介质相比，$\\Delta t_{\\max}$ 可能会下降数个数量级。局域时间步长方案利用了这一点，仅在需要的地方分配更小的时间步长，从而在激波附近保持精度和稳定性，同时避免了全局时间步长受一小部分粒子的限制。然而，这也带来了一些挑战：流体动力学和长程引力求解器之间的同步问题，如果相邻粒子以迥异的时间步长演化可能导致的守恒误差，以及需要时间步长限制器来防止相互作用的邻近粒子间出现巨大差异。在共动表述中，还必须注意确保 $v_{\\text{sig}}$ 和 $h$ 在同一参考系（物理或共动）中被一致地定义，以便 CFL 限制保持其意义。总而言之，标度关系 $\\Delta t_{\\max} \\sim h / v_{\\text{sig}}$ 推动了在真实的宇宙学流体中使用带有考虑邻近粒子限制器的分层局域时间步长方法的发展。", "answer": "$$\\boxed{4.167 \\times 10^{-5}}$$", "id": "3465304"}]}