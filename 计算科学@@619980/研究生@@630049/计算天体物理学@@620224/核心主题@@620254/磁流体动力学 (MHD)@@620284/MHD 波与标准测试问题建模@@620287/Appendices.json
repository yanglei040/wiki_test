{"hands_on_practices": [{"introduction": "对于任何显式时间积分方案，数值稳定性都是至关重要的。本练习将深入探讨计算MHD中的一个核心概念：Courant–Friedrichs–Lewy (CFL) 条件。通过一个涉及各向异性网格和不同方向快磁声波速度的假设场景，您将实践从第一性原理推导并计算稳定时间步长$ \\Delta t $。这项实践对于理解如何平衡计算效率和数值模拟的稳定性至关重要，这是运行可靠的MHD模拟的基本技能[@problem_id:3520095]。", "problem": "考虑三维理想磁流体动力学（MHD）方程组，它构成一个双曲守恒律方程组。您正在使用一种显式的、非分裂的、有限体积Godunov型更新方法，并采用如Harten–Lax–van Leer (HLL)之类的近似黎曼求解器。背景流可忽略不计，因此波的传播由快磁声模主导。用于时间步进的Courant–Friedrichs–Lewy (CFL) 数为 $C_{\\mathrm{CFL}} = 0.4$。计算网格是各向异性的，其间距分别为 $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$，$\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$ 和 $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$。一次稳健的特征线分析和限制器估计得出了沿网格轴的最大方向快磁声信号速度，分别为 $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$，$c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$ 和 $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n从显式格式的数值依赖域必须包含底层双曲系统的物理依赖域这一原理出发，推导非分裂更新中限制稳定性的时间步长 $\\Delta t$ 关于方向信号速度和网格间距的函数形式。然后，根据给定值计算稳定的 $\\Delta t$。将您的答案四舍五入到四位有效数字，并以秒为单位表示时间步长。\n\n最后，定性讨论在非分裂的通量散度下，与具有相同最小间距的各向同性网格相比，各向异性单元（不相等的 $\\Delta x$, $\\Delta y$, $\\Delta z$）如何影响限制稳定性的 $\\Delta t$。您的讨论应基于相同的第一性原理CFL推断；不要依赖简便公式。", "solution": "所述问题在科学上是合理的、适定的，并包含了推导和计算理想磁流体动力学（MHD）方程组的显式、非分裂数值格式中限制稳定性的时间步长所需的所有信息。提供的物理参数是一致的，并且在天体物理模拟的合理范围内。因此，我们可以进行正式求解。\n\n该问题要求推导三维显式、非分裂有限体积格式中限制稳定性的时间步长 $\\Delta t$。其指导原则是Courant–Friedrichs–Lewy (CFL) 条件，该条件指出，为使显式时间推进格式保持稳定，计算单元的数值依赖域必须包含物理依赖域。\n\n对于一阶、以单元为中心的有限体积格式，在时间 $t^{n+1} = t^n + \\Delta t$ 时单元 $(i,j,k)$ 中的解是使用时间 $t^n$ 时该单元 $(i,j,k)$ 的解以及穿过其各个面的通量来计算的。这些通量是利用直接相邻单元的数据确定的。因此，在单个时间步长 $\\Delta t$ 内，信息从相邻单元的中心传播出去。最快的物理信号传播的距离不能超过此数值模板所允许的范围。\n\n在一维空间中（例如 $x$ 方向），速度为 $c_{f,x}$ 的最快信号传播的距离为 $c_{f,x} \\Delta t$。CFL条件要求这个距离小于或等于网格间距 $\\Delta x$（乘以一个安全因子，即CFL数 $C_{\\mathrm{CFL}} \\le 1$）。\n$$\nc_{f,x} \\Delta t \\le C_{\\mathrm{CFL}} \\Delta x \\implies \\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{c_{f,x}}\n$$\n对于三维的非分裂格式，我们必须考虑波同时向所有方向的传播。一个单元的更新取决于通过其所有面的通量。对于用一阶迎风或Godunov型格式求解的多维线性双曲系统，其稳定性条件是一维情况的推广。每个维度的Courant数 $\\nu_i = c_{f,i} \\frac{\\Delta t}{\\Delta i}$ (其中 $i \\in \\{x, y, z\\}$) 被加在一起。稳定性约束为：\n$$\n\\nu_x + \\nu_y + \\nu_z \\le C_{\\mathrm{CFL}}\n$$\n代入各方向Courant数的表达式，我们得到：\n$$\nc_{f,x} \\frac{\\Delta t}{\\Delta x} + c_{f,y} \\frac{\\Delta t}{\\Delta y} + c_{f,z} \\frac{\\Delta t}{\\Delta z} \\le C_{\\mathrm{CFL}}\n$$\n提取公因子 $\\Delta t$ 后，得到限制稳定性的时间步长的函数形式：\n$$\n\\Delta t \\left( \\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z} \\right) \\le C_{\\mathrm{CFL}}\n$$\n因此，最大稳定时间步长 $\\Delta t$ 由下式给出：\n$$\n\\Delta t = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\n此表达式表明，时间步长的倒数由最快波在各个维度上穿过单元所需特征时间的倒数之和决定。\n\n接下来，我们使用给定的值计算此表达式：\nCFL数: $C_{\\mathrm{CFL}} = 0.4$\n网格间距: $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$, $\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$, $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$\n信号速度: $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n\n我们计算分母中的各项，其单位为秒的倒数 ($\\mathrm{s}^{-1}$)：\n$$\n\\frac{c_{f,x}}{\\Delta x} = \\frac{1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{9}\\ \\mathrm{m}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,y}}{\\Delta y} = \\frac{2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{5.0 \\times 10^{8}\\ \\mathrm{m}} = 0.4 \\times 10^{-2}\\ \\mathrm{s}^{-1} = 4.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,z}}{\\Delta z} = \\frac{1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{2.0 \\times 10^{9}\\ \\mathrm{m}} = 0.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n这些项的和是：\n$$\n\\sum_{i \\in \\{x,y,z\\}} \\frac{c_{f,i}}{\\Delta i} = (1.5 + 4.0 + 0.5) \\times 10^{-3}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n现在，我们计算稳定的时间步长 $\\Delta t$：\n$$\n\\Delta t = \\frac{0.4}{6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}} = \\frac{4 \\times 10^{-1}}{6 \\times 10^{-3}}\\ \\mathrm{s} = \\frac{2}{3} \\times 10^{2}\\ \\mathrm{s} \\approx 66.666... \\mathrm{s}\n$$\n将结果四舍五入到四位有效数字，我们得到 $\\Delta t = 66.67\\ \\mathrm{s}$。\n\n最后，我们定性讨论各向异性单元的影响。给定的网格是各向异性的，其最小间距为 $\\Delta_{\\min} = \\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$。一个具有相同最小间距的等效各向同性网格将有 $\\Delta x' = \\Delta y' = \\Delta z' = \\Delta_{\\min}$。\n\n对于各向异性网格，稳定性条件是：\n$$\n\\Delta t_{\\text{aniso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\n对于间距为 $\\Delta_{\\min}$ 的假设的各向同性网格，其条件将是：\n$$\n\\Delta t_{\\text{iso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}}\n$$\n让我们比较分母。在各向异性的情况下，$x$ 和 $z$ 方向的网格间距大于最小间距：$\\Delta x > \\Delta_{\\min}$ 且 $\\Delta z > \\Delta_{\\min}$。因此，分母求和中的相应项更小：\n$$\n\\frac{c_{f,x}}{\\Delta x}  \\frac{c_{f,x}}{\\Delta_{\\min}} \\quad \\text{和} \\quad \\frac{c_{f,z}}{\\Delta z}  \\frac{c_{f,z}}{\\Delta_{\\min}}\n$$\n由于 $\\Delta y = \\Delta_{\\min}$，$y$ 方向的项在两种情况下是相同的。因此，各向异性情况下的分母之和严格小于各向同性情况下的分母之和：\n$$\n\\left(\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}\\right)  \\left(\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}\\right)\n$$\n由于时间步长 $\\Delta t$ 与这个和成反比，与一个在所有方向上都细化到相同最小分辨率的各向同性网格相比，各向异性网格允许一个更大、限制更少的时间步长：$\\Delta t_{\\text{aniso}} > \\Delta t_{\\text{iso}}$。这表明，对于仅在某些轴上需要高分辨率的问题，使用各向异性网格划分具有显著的计算优势，因为时间步长不会像在均匀细化的各向同性网格上那样，因最小单元尺寸而受到严重限制。", "answer": "$$\n\\boxed{66.67}\n$$", "id": "3520095"}, {"introduction": "在确保数值稳定性之后，正确定义计算域的边界是下一个关键步骤。边界条件不仅是数学构造，它们还代表了物理近似，可能会引入非物理效应，例如波的反射。本练习探讨了几种常用的数值边界条件（周期性、反射性、流入、流出等）如何与MHD中的一种基本波动模式——阿尔芬波——相互作用。通过分析不同边界对出射波的反射特性，您将培养选择适当边界设置的直觉，以最大程度地减少伪影并确保模拟结果的物理真实性[@problem_id:3520091]。", "problem": "考虑理想磁流体力学（MHD）方程：质量守恒、包含洛伦兹力的动量守恒、理想极限下的（无电阻率）感应方程，以及磁场的螺线约束。在笛卡尔坐标系中，速度为 $\\mathbf{u}$，磁场为 $\\mathbf{B}$，密度为 $\\rho$，压强为 $p$，总能量密度为 $E$，控制方程分别为连续性方程 $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$，动量方程 $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$，感应方程 $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$（其中 $\\nabla \\cdot \\mathbf{B} = 0$），以及一个热力学闭合关系，例如关于 $p$ 的理想气体定律。在一个具有均匀网格的一维区域 $x \\in [0,L]$ 中，在一个均匀、静态的背景场（具有恒定密度 $\\rho_0$、恒定压强 $p_0$ 和恒定磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$，且无平均流速 $\\mathbf{u}_0 = \\mathbf{0}$）周围对这些方程进行线性化。关注沿背景场方向传播的小振幅线性阿尔芬波：横向扰动 $u_y(x,t)$ 和 $B_y(x,t)$，阿尔芬波速为 $c_a = B_0/\\sqrt{4\\pi \\rho_0}$，相位关系为 $B_y = \\pm \\sqrt{4\\pi \\rho_0}\\, u_y$，具体符号取决于传播方向。\n\n一个频率为 $\\omega$、波数为 $k$ 的平面阿尔芬波从内部（$x>0$）向边界 $x=0$ 传播，因此对于一个群速度为 $-c_a$ 的向左传播的波，入射扰动的形式为 $\\exp\\{i(\\omega t - k x)\\}$；如果存在反射扰动，其形式为 $\\exp\\{i(\\omega t + k x)\\}$。那么 $x$ 处的总横向速度为 $u_y(x,t) = \\Re\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\}$，对于向左传播的阿尔芬分支，横向磁场为 $B_y(x,t) = \\Re\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\}$，其中 $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$，$R$ 是复反射系数。\n\n在 $x=0$ 处，考虑计算天体物理学MHD中使用的五种常见数值边界处理方法：\n\n- 周期性边界条件：将 $x=0$ 和 $x=L$ 等同起来，使得所有场都满足周期性，在均匀介质中，从 $x=0$ 离开的波会不加改变地从 $x=L$ 重新进入。\n\n- 反射性、理想导电壁：在 $x=0$ 处施加与理想MHD一致的运动学反射和理想导体约束，对于小振幅、沿场向的阿尔芬波，这导致 $u_y(0,t) = 0$ 以及切向电场 $E_y(0,t) = 0$ 为零。\n\n- 入流边界：在 $x=0$ 处指定固定的原始变量 $\\rho$、$p$、$\\mathbf{u}$ 和 $\\mathbf{B}$，对应一个不随时间变化的稳态入流状态。\n\n- 出流边界：在 $x=0$ 处对原始变量施加零法向梯度，例如 $\\partial_x (\\rho,p,u_y,B_y) = 0$。\n\n- 基于特征线的边界：将线性化的MHD系统分解为特征变量，并在 $x=0$ 处仅将传入特征的振幅设定为稳态背景值，而让传出特征自由，从而在线性极限下构建无反射边界条件。\n\n在此设置中，关于入射阿尔芬波在 $x=0$ 处的反射，以下哪些陈述是正确的？选择所有适用项。\n\nA. 在具有均匀背景和相同网格的周期性区域中，一个在 $x=L$ 处向右离开的波在 $x=0$ 处重新进入时没有任何反射；对于入射的阿尔芬波，在 $x=0$ 处的反射系数为 $R = 0$。\n\nB. 在 $x=0$ 处的反射性、理想导电壁强制要求沿场向阿尔芬波的横向速度扰动 $u_y(0,t)=0$，从而产生一个单位振幅且相位反转（$R = -1$）的反射波，因此能量被困住，扰动被反射。\n\nC. 一个简单的零梯度出流边界在 $x=0$ 处对于所有线性的MHD模式都是严格无反射的，无论波矢与磁场之间的夹角如何，也无论流动是亚临界还是超临界。\n\nD. 一个基于特征线的边界将传入的阿尔芬特征设定为稳态背景值，同时让传出的特征不受约束，这样可以在均匀介质中消除传出线性扰动的一阶反射；对于此处的阿尔芬波，可以得到 $R = 0$。\n\nE. 在 $x=0$ 处指定固定原始变量的入流边界通常会导致接近边界的传出线性波发生强烈反射；它仅在净特征通量进入区域时（即波是进入而非离开时）才是合适的（并且从内部看是无反射的）。", "solution": "用户提供了一个关于线性阿尔芬波在一维理想磁流体力学（MHD）设置中，在各种数值边界处反射的问题。\n\n### 步骤1：问题验证\n\n**已知条件提取：**\n-   **控制方程：** 密度 $\\rho$、速度 $\\mathbf{u}$、压强 $p$ 和磁场 $\\mathbf{B}$ 的理想MHD方程。\n    -   $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$\n    -   $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$\n    -   $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$\n    -   $\\nabla \\cdot \\mathbf{B} = 0$\n-   **坐标与区域：** 笛卡尔坐标系，$x \\in [0,L]$。\n-   **背景状态：** 均匀且静态：$\\rho_0 = \\text{常数}$，$p_0 = \\text{常数}$，$\\mathbf{u}_0 = \\mathbf{0}$，$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$。\n-   **波的性质：**\n    -   沿 $\\mathbf{B}_0$ 传播的平面、小振幅、线性阿尔芬波。\n    -   扰动是横向的：$u_y(x,t)$，$B_y(x,t)$。\n    -   阿尔芬波速：$c_a = B_0/\\sqrt{4\\pi \\rho_0}$。\n    -   入射波：从 $x>0$ 处接近 $x=0$，其形式为 $\\exp\\{i(\\omega t - k x)\\}$，被描述为“群速度为 $-c_a$ 的向左传播”。这意味着一个非常规但自洽的符号选择，其中对于 $\\omega>0$，波数 $k$ 为负。\n    -   反射波：形式为 $\\exp\\{i(\\omega t + k x)\\}$。当 $k0$ 时，这对应于向右传播。\n    -   总横向速度：$u_y(x,t) = \\Re\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\}$\n    -   总横向磁场：$B_y(x,t) = \\Re\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\}$\n    -   振幅关系：$\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$。$u_y$ 和 $B_y$ 之间的相对符号取决于传播方向。所提供的总 $B_y$ 表达式正确地考虑了这一点：入射波的 $B_{y,I}$ 和 $u_{y,I}$ 同相（对于沿 $\\mathbf{B}_0$ 的向左传播），而反射波的 $B_{y,R}$ 和 $u_{y,R}$ 反相（对于向右传播）。\n-   **$x=0$ 处的边界条件**：描述了五种类型：周期性、反射性（理想导电壁）、入流、出流（零梯度）和基于特征线的。\n\n**验证结论：**\n问题陈述具有科学依据、问题设定良好且客观。它描述了计算天体物理学中用于验证MHD代码中边界条件实现的一个标准测试问题。控制方程、波的性质以及边界条件的描述都是标准的。所选择的波函数形式的约定，尽管可能令人困惑，但内部是自洽的。问题定义明确，并包含足够的信息来确定所提出的每种情况下的反射系数 $R$。该问题是有效的。\n\n### 步骤2：推导与选项分析\n\n我们分析入射阿尔芬波在边界 $x=0$ 处的反射。在任意点 $x$ 处的总横向速度和磁场的复振幅由下式给出：\n$$ u_y(x) = \\hat{u} \\left(e^{-ikx} + R\\,e^{ikx}\\right) $$\n$$ B_y(x) = \\hat{b} \\left(e^{-ikx} - R\\,e^{ikx}\\right) $$\n其中 $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$。我们在 $x=0$ 处应用指定的边界条件来确定反射系数 $R$。在 $x=0$ 处，这些表达式简化为：\n$$ u_y(0) = \\hat{u} (1+R) $$\n$$ B_y(0) = \\hat{b} (1-R) $$\n\n**A. 周期性边界条件**\n周期性边界条件连接了区域的边缘，因此 $x=0$ 与 $x=L$ 等同。在均匀介质中，这种拓扑结构意味着在 $x=0$ 或 $x=L$ 处没有物理界面来引起反射。一个从内部向 $x=0$ 传播的波包（即一个向左传播的波）将无缝地通过 $x=0$ 并重新出现在 $x=L$，继续其传播。由于没有物理不连续性或会散射波的强加约束，因此不会产生反射波。反射波的振幅为零，这对应于反射系数 $R=0$。陈述文本正确地得出结论 $R=0$。虽然关于“向右离开的波”的描述性子句描述了不同的情景，但关于给定入射波的基本主张是正确的。\n**结论：正确。**\n\n**B. 反射性、理想导电壁**\n理想导电壁不能维持切向电场。在理想MHD中，电场为 $\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B}$。对于给定的波，其中 $\\mathbf{u} = u_y \\hat{\\mathbf{y}}$ 且 $\\mathbf{B} \\approx B_0 \\hat{\\mathbf{x}}$，电场为 $\\mathbf{E} \\approx - (u_y \\hat{\\mathbf{y}}) \\times (B_0 \\hat{\\mathbf{x}}) = u_y B_0 \\hat{\\mathbf{z}}$。在 $x=0$ 的壁面处，$\\mathbf{E}$ 的切向分量是 $E_y$ 和 $E_z$。对于这个波， $E_y=0$ 是自然成立的。条件 $E_z(0,t) = 0$ 意味着 $u_y(0,t) B_0 = 0$。由于 $B_0 \\neq 0$，物理边界条件是 $u_y(0,t) = 0$。\n将此条件应用于 $x=0$ 处的总速度：\n$$ u_y(0) = \\hat{u} (1+R) = 0 $$\n对于一个非平凡的入射波（$\\hat{u} \\neq 0$），这要求 $1+R = 0$，从而得出 $R=-1$。\n这意味着反射波的振幅与入射波相同，但相位反转。反射是全反射（$|R|^2=1$），所以所有入射能量都被反射，能量被困在区域内。该陈述完全准确。\n**结论：正确。**\n\n**C. 简单的零梯度出流边界**\n这个边界条件要求原始变量的法向导数为零。对于扰动 $u_y$ 和 $B_y$，这意味着在 $x=0$ 处 $\\partial_x u_y = 0$ 和 $\\partial_x B_y = 0$。\n首先，我们计算空间导数：\n$$ \\frac{\\partial u_y}{\\partial x} = \\hat{u} \\left(-ik e^{-ikx} + ikR e^{ikx}\\right) = ik\\hat{u}\\left(-e^{-ikx} + R e^{ikx}\\right) $$\n$$ \\frac{\\partial B_y}{\\partial x} = \\hat{b} \\left(-ik e^{-ikx} - ikR e^{ikx}\\right) = -ik\\hat{b}\\left(e^{-ikx} + R e^{ikx}\\right) $$\n在 $x=0$ 处应用这些条件：\n$$ \\frac{\\partial u_y}{\\partial x}\\bigg|_{x=0} = ik\\hat{u}(-1 + R) = 0 \\implies R=1 $$\n$$ \\frac{\\partial B_y}{\\partial x}\\bigg|_{x=0} = -ik\\hat{b}(1 + R) = 0 \\implies R=-1 $$\n条件 $\\partial_x u_y = 0$ 和 $\\partial_x B_y = 0$ 对反射系数提出了相互矛盾的要求（$R=1$ 和 $R=-1$）。这意味着没有一个简单的反射波形式的解能同时满足这些边界条件。问题是过约束的，并且众所周知，这种边界条件对于亚临界状态下的MHD波是高度反射的。称其“严格无反射”的说法是错误的。\n**结论：错误。**\n\n**D. 基于特征线的边界**\n这些边界条件是专门设计为无反射的。它们通过将MHD波模式分解为进入区域的波（传入特征）和离开区域的波（传出特征）来工作。对于位于 $x=0$ 的边界和位于 $x0$ 的区域，传出波具有负的传播速度。本问题中的入射阿尔芬波以速度 $-c_a$ 向左传播，因此在 $x=0$ 边界处它是一个传出特征。无反射边界条件是通过指定传入特征的振幅（例如，以匹配稳态的外部状态），同时使用外插法或其他数值技术允许传出特征不受阻碍地离开区域来实现的。根据设计，这可以防止边界产生虚假的反射波。在理想的线性极限下，这导致传出波的反射系数为 $R=0$。该陈述准确地描述了这一原理及其结果。\n**结论：正确。**\n\n**E. 指定的入流边界**\n这个边界条件在边界处固定了原始变量，对于涉及扰动的问题，通常将它们固定为其背景值。对于给定的设置，这意味着所有扰动必须在 $x=0$ 处为零。特别是，$u_y(0,t)=0$ 和 $B_y(0,t)=0$。\n应用这些条件：\n1.  $u_y(0) = \\hat{u} (1+R) = 0 \\implies R=-1$\n2.  $B_y(0) = \\hat{b} (1-R) = 0 \\implies R=1$\n与零梯度条件一样，我们发现对 $R$ 的要求是矛盾的。从物理上讲，这意味着对于一个传出的波，边界条件是过约束的，无法满足。在数值模拟中的结果是强烈的虚假反射。因此，陈述的第一部分“通常会导致接近边界的传出线性波发生强烈反射”是正确的。第二部分解释了这种边界适用的情景：当信息流进入区域时（即对于传入的波）。在这种情况下，边界条件用于指定传入流的性质，并且没有来自内部的“反射”。这是一个正确和完整的物理描述。\n**结论：正确。**", "answer": "$$\\boxed{ABDE}$$", "id": "3520091"}, {"introduction": "拥有一个可以运行的MHD代码仅仅是第一步；我们必须严格验证它能产生科学上准确的结果。本练习将挑战您像代码开发者一样思考，设计一个全面的验证计划。您需要将一系列天体物理学中经典的MHD测试问题（如线性波、Brio–Wu激波管、磁转子和Orszag–Tang涡旋）与特定的验证目标相结合，包括评估光滑流的精度、强间断的鲁棒性以及对磁场散度误差的控制。这项综合性练习将使您能够系统地评估和信任数值模拟工具的性能[@problem_id:3520099]。", "problem": "考虑理想磁流体力学（MHD）方程组，其守恒形式包括质量守恒、动量守恒、感应方程和总能量方程，以及无散度约束条件。使用原始变量密度 $\\,\\rho\\,$、速度 $\\,\\mathbf{v}\\,$、磁场 $\\,\\mathbf{B}\\,$、气体压力 $\\,p\\,$ 和绝热指数 $\\,\\gamma\\,$，该方程组可总结为：\n$$\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0,$$\n$$\\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0,$$\n$$\\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0,$$\n$$\\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0,$$\n并满足无散度条件\n$$\\nabla \\cdot \\mathbf{B} = 0,$$\n其中总能量为 $\\,E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2.$$\n\n一个计算天体物理程序声称对光滑流具有高阶精度，对间断具有鲁棒性，并且能够控制磁场的散度误差。您需要选择一个验证方案，该方案结合使用线性波传播、Brio–Wu 激波管、磁转子和 Orszag–Tang 涡，以分别评估：\n(i) 在光滑解上的精度，\n(ii) 当强间断和旋转结构形成时的鲁棒性，\n(iii) 对磁场散度误差的控制，即维持约束 $\\,\\nabla\\cdot\\mathbf{B}=0\\,$ 以及减缓当 $\\,\\nabla\\cdot\\mathbf{B}\\neq 0\\,$ 时产生的伪磁单极子力。\n\n该方案应定义科学上一致的初始条件和边界条件，指定与上述系统第一性原理相关的诊断方法，并避免混淆目标。选择正确区分了各目标并为每个测试使用了适当诊断方法的选项。\n\nA. 精度通过在周期性立方体 $[0,1]^3$ 上使用小振幅线性 MHD 波进行评估：初始化三个族（阿尔芬波、慢磁声波、快磁声波），振幅为 $\\,A = 10^{-6}\\,$，并使用归一化的波矢 $\\,\\mathbf{k} \\propto (1,2,3)\\,$ 以避免网格对齐。在一个周期 $\\,T = 2\\pi/\\omega_{\\text{mode}}\\,$ 后，通过与相应的线性解进行比较来计算 $\\,(\\rho,\\mathbf{v},\\mathbf{B},p)\\,$ 的误差，并测量 $\\,L_1\\,$、$\\,L_2\\,$ 和 $\\,L_\\infty\\,$ 范数作为分辨率 $\\,N = 64, 128, 256\\,$ 的函数，以确认光滑解的预期阶数。对间断的鲁棒性通过在 $[0,1]$ 上使用出流（非反射）边界的一维 Brio–Wu 激波管进行评估，其标准左/右状态为 $\\,(\\rho_L,p_L,\\mathbf{v}_L,\\mathbf{B}_L)=(1,1,(0,0,0),(0.75,1,0))\\,$ 和 $\\,(\\rho_R,p_R,\\mathbf{v}_R,\\mathbf{B}_R)=(0.125,0.1,(0,0,0),(0.75,-1,0))\\,$；同时，也通过在 $[0,1]^2$（周期性）上使用二维磁转子进行评估，在区域中心设置一个半径为 $\\,r_0=0.1\\,$ 的高密度旋转盘，其中 $\\,\\rho_{\\text{in}}=10\\,$，$\\,\\rho_{\\text{out}}=1\\,$，$\\,p=1\\,$，角速度 $\\,\\omega=20\\,$，以及均匀背景场 $\\,\\mathbf{B}_0=(5,0,0)\\,$；诊断方法包括激波/稀疏波位置、与高分辨率参考解比较的 $\\,L_1\\,$ 误差，以及角动量和峰值涡量的守恒性。散度误差的控制通过在 $[0,1]^2$（周期性）上使用 Orszag–Tang 涡进行评估，其中 $\\,\\gamma=5/3\\,$，$\\,\\rho=1\\,$，$\\,p=5/3\\,$，$\\,\\mathbf{v} = (-\\sin(2\\pi y), \\sin(2\\pi x), 0)\\,$，$\\,\\mathbf{B} = (-\\sin(2\\pi y), \\sin(4\\pi x), 0)\\,$；记录 $\\,\\|\\nabla\\cdot\\mathbf{B}\\|_2/\\|\\mathbf{B}\\|_2\\,$ 和最大值 $\\,|\\nabla\\cdot\\mathbf{B}|\\,$ 随时间的变化，针对两种算法变体：约束输运（CT）和广义拉格朗日乘子（GLM）清理，外加一个禁用清理的对照运行，以展示散度的增长及其对动量/能量残差的影响。\n\nB. 精度通过在一维中使用振幅为 $\\,A=0.1\\,$ 的大振幅阿尔芬波和入流/出流边界进行评估，在单一分辨率 $\\,N=128\\,$ 下比较 $\\,t=1\\,$ 时的总能量。对间断的鲁棒性通过使用 Orszag–Tang 涡作为激波管的替代品并计算激波宽度来评估，而散度控制则通过总能量的近似恒定性来间接推断，没有显式监控 $\\,\\nabla\\cdot\\mathbf{B}\\,$；不使用周期性边界以避免人为约束。\n\nC. 精度仅通过在单一分辨率 $\\,N=128\\,$ 下，在周期性边界上使用网格对齐的一维阿尔芬波并计算 $\\,L_1\\,$ 误差来评估。对间断的鲁棒性通过使用反射边界的转子测试进行评估，散度控制则被整合到转子测试中，通过检查 $\\,\\nabla\\cdot\\mathbf{v}\\,$ 而不是 $\\,\\nabla\\cdot\\mathbf{B}\\,$ 来实现，并辅以一次不跟踪散度范数或比较不同散度控制算法的 Orszag–Tang 运行。\n\nD. 精度通过 Brio–Wu 激波管在 $\\,t=0.2\\,$ 时测量随 $\\,N\\,$ 增加的激波宽度来评估，假设光滑解的收敛性可以延伸到间断处；对间断的鲁棒性通过在 $[0,1]^3$ 上使用 $\\,A=10^{-6}\\,$ 的线性波来评估；散度控制通过监控 $\\,\\nabla\\cdot\\mathbf{v}\\,$ 以及要求在使用出流边界的 Orszag–Tang 涡上平均磁场 $\\,\\langle \\mathbf{B} \\rangle\\,$ 保持恒定来评估。\n\n哪个选项提供了一个科学上合理的方案，该方案能正确地区分在光滑解上的精度、对间断的鲁棒性以及对散度误差的控制，并使用了基于控制方程的适当初始/边界条件和诊断方法？", "solution": "任务是为一款旨在求解理想磁流体力学（MHD）方程的计算天体物理程序选择最科学合理的验证方案。该方案必须分别评估三个关键能力：(i) 在光滑解上的精度，(ii) 在存在强间断时的鲁棒性，以及 (iii) 对磁场散度误差的控制。\n\n首先，我们必须确认问题陈述的有效性。问题给出了理想MHD方程的标准守恒形式：\n$$ \\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0 $$\n$$ \\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0 $$\n总能量定义为 $E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2$，并且该系统受无散度约束 $\\nabla \\cdot \\mathbf{B} = 0$ 的限制。这些方程是理想MHD的基本且正确的理论基础。指定的一系列测试问题——线性波传播、Brio–Wu 激波管、磁转子和 Orszag–Tang 涡——是计算MHD领域的经典基准测试。这三个验证目标是明确区分且对于认证一个现代MHD程序至关重要。因此，该问题在科学上是基础扎实、适定、客观且内部一致的。我们可以开始评估所提出的方案。\n\n一个合理的验证方案必须为每个目标采用量身定制的特定测试，并配备适当的初始条件、边界条件和诊断方法。\n\n1.  **目标 (i)：光滑解的精度。** 这需要一个具有已知、光滑的解析解或半解析解的测试问题。衡量数值解作为网格分辨率（$N$）函数的函数，其向真解收敛的情况。对于一个 $m$ 阶的格式，误差应随 $N^{-m}$ 减小。\n    -   **方法论**：小振幅线性波的传播是理想的测试。振幅必须很小（例如，$A \\sim 10^{-6}$），以确保系统保持在线性区域，防止波的陡峭化和激波的形成。为避免人为的有利结果，波矢 $\\mathbf{k}$ 不应与网格轴对齐。必须进行跨越多个分辨率的收敛性研究，以测量精度阶数。\n\n2.  **目标 (ii)：对间断的鲁棒性。** 这测试程序处理激波、稀疏波和接触间断的能力，要求不产生致命错误或过度的、非物理的振荡。这是对高度非线性区域中稳定性和定性正确性的测试。\n    -   **方法论**：标准的激波管问题，如 Brio–Wu 测试，旨在生成一个复杂的一维间断扇。更高维度的问题，如磁转子或 Orszag–Tang 涡，则测试强激波、剪切流和涡旋的相互作用。形式精度不是主要的诊断指标；相反，人们会将解的结构与高分辨率参考解进行比较，并检查物理原理（例如，守恒律）的保持情况。\n\n3.  **目标 (iii)：对磁场散度误差的控制。** 这验证了数值算法在维持 $\\nabla \\cdot \\mathbf{B} = 0$ 约束方面的有效性。如果做不到这一点，会引入一个与 $\\nabla \\cdot \\mathbf{B}$ 成正比的非物理力，这会破坏解并导致不稳定性。\n    -   **方法论**：一个具有复杂、演化的磁场结构（如 Orszag–Tang 涡）的测试问题是理想的。初始状态满足 $\\nabla \\cdot \\mathbf{B} = 0$，但数值误差可能导致其增长。主要的诊断方法是直接测量网格上 $\\nabla \\cdot \\mathbf{B}$ 的离散形式，通常通过其 $L_2$ 或 $L_\\infty$ 范数进行监控，并比较不同的散度控制策略（例如，约束输运、Powell 源项、投影法或 GLM 清理）。\n\n我们现在根据这些原则来评估每个选项。\n\n**选项 A：**\n-   **精度**：该方案正确地使用了小振幅（$A = 10^{-6}$）线性 MHD 波。选择一个不与网格对齐的波矢 $\\mathbf{k} \\propto (1,2,3)$ 对于进行严格的测试至关重要。它适当地指定了在多个分辨率（$N = 64, 128, 256$）上使用标准误差范数（$L_1, L_2, L_\\infty$）的收敛性研究。这构成了验证形式精度阶数的教科书式程序。\n-   **鲁棒性**：它同时使用了一维 Brio–Wu 激波管和二维磁转子。这些是针对间断和复杂流的标准且具有挑战性的测试。指定的初始和边界条件是标准的。诊断方法——激波位置、与参考解比较的 $L_1$ 误差，以及守恒律——都适用于此目标。\n-   **散度控制**：它正确地采用了 Orszag–Tang 涡，这是一个用于此目的的经典问题。诊断方法是直接和定量的：监控 $\\nabla \\cdot \\mathbf{B}$ 的范数随时间的变化。关键是，它提议将专用的散度控制算法（CT, GLM）与没有清理的运行进行比较，这是证明问题存在以及解决方案有效性的权威方法。\n-   **结论**：该选项正确地分开了三个目标，并为每个目标分配了适当的测试、边界条件和诊断方法。它代表了一个最先进的验证方案。**正确**。\n\n**选项 B：**\n-   **精度**：使用大振幅（$A=0.1$）波。这是不正确的，因为非线性效应将占主导地位，使其不适合进行清晰的精度测试。它也缺少收敛性研究（单一分辨率 $N=128$），因此无法确定精度阶数。\n-   **鲁棒性**：使用 Orszag–Tang 作为“激波管的替代品”，这是一个不精确的框架。\n-   **散度控制**：依赖于从能量守恒的“间接”推断。这是不可靠和不可接受的；$\\mathbf{B}$ 的散度必须直接测量。\n-   **结论**：由于使用了不正确的方法和诊断，该方案存在根本性缺陷。**不正确**。\n\n**选项 C：**\n-   **精度**：使用网格对齐的一维波和单一分辨率。这是一个薄弱、不严谨的测试，可能会掩盖错误并且无法测量收敛性。\n-   **鲁棒性**：对转子测试使用反射边界，这是非标准的，并且会因边界相互作用而使物理过程复杂化，使得与既定结果的比较变得困难。\n-   **散度控制**：提议检查 $\\nabla \\cdot \\mathbf{v}$ 而不是 $\\nabla \\cdot \\mathbf{B}$。这是一个毫无意义的替换，因为无散度约束适用于磁场，而不是速度场（在可压缩 MHD 中速度场不是无散度的）。\n-   **结论**：该方案表明了对物理学和验证目标的严重误解。**不正确**。\n\n**选项 D：**\n-   **精度**：通过使用激波管（Brio–Wu）来评估精度，混淆了目标。激波捕捉格式在间断处不是高阶精确的，所以这个测试无法测量光滑流的形式精度。\n-   **鲁棒性**：使用小振幅线性波来评估鲁棒性。这是不正确的。线性波是光滑的，不能测试程序在有激波或强非线性情况下的行为。\n-   **散度控制**：提议监控 $\\nabla \\cdot \\mathbf{v}$（不正确，如 C 中所述）和平均磁场 $\\langle \\mathbf{B} \\rangle$。在周期性区域上 $\\langle \\mathbf{B} \\rangle$ 的守恒是微不足道的，并且不提供关于局部散度误差的任何信息，而局部散度误差才是非物理力的来源。\n-   **结论**：该方案完全颠倒了精度和鲁棒性测试的角色，并为散度控制使用了不相关的诊断方法。**不正确**。\n\n基于这一严谨的分析，选项 A 是唯一一个科学上合理、方法上正确，并且没有混淆验证目标的方案。它为每个目标采用了正确的测试、正确的参数和诊断方法。", "answer": "$$\\boxed{A}$$", "id": "3520099"}]}