{"hands_on_practices": [{"introduction": "在任何显式数值模拟中，保证计算的稳定性是首要任务。本练习将引导你推导一个关键的数值参数：最大稳定时间步长 [@problem_id:3505207]。你将学习到，这个时间步长不仅受到流体中波传播速度的限制（即CFL条件），也受到辐射冷却等物理源项时间尺度的制约，这对于构建稳定且高效的化学动力学模拟至关重要。", "problem": "考虑一个用于可压缩气体动力学的一维显式有限体积求解器，该求解器包含辐射冷却，常用于星系的化学-动力学模拟。一个大小为 $\\Delta x$ 的均匀网格解析了一个区域，该区域具有局部整体速度 $u$、绝热声速 $c_s$、绝热指数 $\\gamma$、总粒子数密度 $n$、气体温度 $T$ 和金属丰度 $Z$。气体是理想气体，其压强为 $p = n k_B T$，其中 $k_B$ 是玻尔兹曼常数。辐射冷却在内能方程中表示为一个能量汇项，其体积冷却率为 $\\dot{e}_{\\mathrm{cool}} = -n^{2}\\,\\Lambda(T,Z)$，其中 $\\Lambda(T,Z)$ 是依赖于温度和金属丰度的列表冷却函数；当冷却率可以近似为 $n_e n_H \\Lambda(T,Z)$ 且电离分数被吸收到 $\\Lambda$ 中时，这种形式是合适的。该积分器对双曲通量更新使用一个 Courant-Friedrichs-Lewy (CFL) 安全因子 $C_{\\mathrm{CFL}} \\in (0,1)$，对显式冷却更新使用一个源项安全因子 $\\beta \\in (0,1)$。\n\n从第一性原理出发——即应用于双曲守恒律的显式格式的依赖域要求，以及理想气体热力学——推导由波传播所施加的最大稳定时间步长。然后，根据每次更新内能的相对变化不超过源项安全因子的要求，推导由显式冷却所限制的时间步长。最后，将这些约束组合成该区域的单个有效最大稳定时间步长。\n\n将你的最终答案表示为有效时间步长的单个闭式解析表达式（单位为秒），用 $\\Delta x$、$u$、$c_s$、$n$、$T$、$\\Lambda(T,Z)$、$\\gamma$、$k_B$、$C_{\\mathrm{CFL}}$ 和 $\\beta$ 来表示。不要在最终的方框表达式中包含单位。不需要进行数值取整。", "solution": "该问题陈述经评估具有科学依据、提法恰当、客观且内部一致。它提出了一个计算天体物理学中关于带源项的流体动力学数值格式稳定性的标准而非平凡的问题。推导所需的所有变量和约束条件均已提供。因此，该问题是有效的，并将提供解答。\n\n目标是为一个一维显式有限体积求解器推导有效最大稳定时间步长 $\\Delta t_{\\mathrm{eff}}$。该时间步长由两个约束中最严格的一个决定：波传播的 Courant-Friedrichs-Lewy (CFL) 条件（方程的双曲部分）和辐射冷却源项显式积分的稳定性条件。\n\n首先，我们推导由波传播施加的时间步长限制。可压缩气体动力学方程是一个双曲守恒律系统。对于一维系统，信息传播的特征速度为 $u-c_s$、$u$ 和 $u+c_s$，其中 $u$ 是局部流体速度，$c_s$ 是绝热声速。在单元尺寸为 $\\Delta x$ 的离散网格上，一个显式数值格式只有当一个网格单元的数值依赖域包含其物理依赖域时才是稳定的。这就是 CFL 条件。它要求在单个时间步长 $\\Delta t$ 内，任何波的传播距离不能超过一个单元宽度 $\\Delta x$。在网格坐标系中，最大可能的信号速度由特征速度绝对值的最大值给出：\n$$\nv_{\\mathrm{max}} = \\max(|u-c_s|, |u|, |u+c_s|)\n$$\n由于声速 $c_s$ 根据定义是非负的，这可以简化为：\n$$\nv_{\\mathrm{max}} = |u| + c_s\n$$\n因此，CFL 条件为 $\\Delta t \\le \\frac{\\Delta x}{v_{\\mathrm{max}}}$，即：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|u| + c_s}\n$$\n问题指定了一个 CFL 安全因子 $C_{\\mathrm{CFL}} \\in (0,1)$，这是一个在实践中为确保稳定性而使用的分数乘子。因此，由双曲通量更新得出的最大稳定时间步长约束（我们记为 $\\Delta t_{\\mathrm{CFL}}$）是：\n$$\n\\Delta t_{\\mathrm{CFL}} = C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}\n$$\n\n接下来，我们推导由辐射冷却源项的显式处理所施加的时间步长限制。问题指出，辐射冷却作为一个体积能量汇，其速率为 $\\dot{e}_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$，其中 $n$ 是粒子数密度，$\\Lambda(T,Z)$ 是冷却函数。该项表示由于冷却引起的内能密度 $e_{\\mathrm{int}}$ 的变化率。所以，$\\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$。\n\n对于具有绝热指数 $\\gamma$ 的理想气体，内能密度与压强 $p$ 的关系为：\n$$\ne_{\\mathrm{int}} = \\frac{p}{\\gamma - 1}\n$$\n使用理想气体定律 $p = n k_B T$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度，我们可以用给定的变量表示内能密度：\n$$\ne_{\\mathrm{int}} = \\frac{n k_B T}{\\gamma - 1}\n$$\n问题要求对于显式更新，一个时间步长内内能的相对变化不能超过源项安全因子 $\\beta \\in (0,1)$。对于显式（前向欧拉）更新，一个时间步长 $\\Delta t$ 内由冷却引起的内能密度变化为 $\\Delta e_{\\mathrm{int}} \\approx \\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} \\Delta t$。因此，稳定性约束为：\n$$\n\\frac{|\\Delta e_{\\mathrm{int}}|}{e_{\\mathrm{int}}} \\le \\beta\n$$\n代入 $\\Delta e_{\\mathrm{int}}$ 和 $e_{\\mathrm{int}}$ 的表达式：\n$$\n\\frac{|-n^2 \\Lambda(T,Z) \\Delta t|}{ \\frac{n k_B T}{\\gamma - 1} } \\le \\beta\n$$\n简化表达式：\n$$\n\\frac{n^2 \\Lambda(T,Z) \\Delta t (\\gamma - 1)}{n k_B T} \\le \\beta\n$$\n$$\n\\frac{n (\\gamma - 1) \\Lambda(T,Z)}{k_B T} \\Delta t \\le \\beta\n$$\n求解 $\\Delta t$ 得到由冷却项施加的最大稳定时间步长，我们记为 $\\Delta t_{\\mathrm{cool}}$：\n$$\n\\Delta t_{\\mathrm{cool}} = \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)}\n$$\n\n最后，为了使整个显式格式保持稳定，时间步长 $\\Delta t$ 必须同时满足这两个约束。因此，有效最大稳定时间步长 $\\Delta t_{\\mathrm{eff}}$ 是两个推导出的时间步长的最小值：\n$$\n\\Delta t_{\\mathrm{eff}} = \\min(\\Delta t_{\\mathrm{CFL}}, \\Delta t_{\\mathrm{cool}})\n$$\n代入 $\\Delta t_{\\mathrm{CFL}}$ 和 $\\Delta t_{\\mathrm{cool}}$ 的表达式，我们得到有效时间步长的最终组合表达式：\n$$\n\\Delta t_{\\mathrm{eff}} = \\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)\n$$\n这个单一的闭式表达式用所有指定的参数表示了该区域的最大稳定时间步长，符合题目要求。", "answer": "$$\\boxed{\\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)}$$", "id": "3505207"}, {"introduction": "紧接着时间步长的讨论，本练习聚焦于一个决定性的物理过程：辐射冷却 [@problem_id:3505146]。你将学习如何从基本的热力学原理和给定的原子数据表中计算冷却时间，并量化该时间尺度对气体化学成分（金属丰度）的敏感性。这个计算直接关系到前一个练习中推导出的受冷却限制的时间步长，展示了物理过程如何直接影响数值方案。", "problem": "一个代表环星系介质的均匀、光学薄、完全电离的气体团正在等容冷却。其氢数密度为 $n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$，温度为 $T = 10^{6}\\ \\mathrm{K}$，其成分为原初成分，氢质量分数为 $X=0.76$，氦质量分数为 $Y=0.24$（在计算数密度时忽略金属）。单位体积的辐射冷却率由列表形式的冷却函数 $\\Lambda(T,Z)$ 描述，因此辐射率为 $\\mathcal{L} = n_{e}\\,n_{\\mathrm{H}}\\,\\Lambda(T,Z)$，其中 $n_{e}$ 是电子数密度。理想、单原子、完全电离气体的内能密度为 $u = \\tfrac{3}{2}\\,n\\,k_{B}\\,T$，其中 $n$ 是总粒子数密度，$k_{B}$ 是玻尔兹曼常数。假设在给定温度下，电离状态不随金属丰度变化，因此在固定的 $T$ 和成分下，$n$、$n_{e}$ 和 $n_{\\mathrm{H}}$ 与 $Z$ 无关。\n\n在 $T = 10^{6}\\ \\mathrm{K}$ 时，$\\Lambda(T,Z)$ 的列表值为：\n- $Z = 0$：$\\Lambda = 1.2 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$，\n- $Z = 0.1\\,Z_{\\odot}$：$\\Lambda = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$，\n- $Z = 1.0\\,Z_{\\odot}$：$\\Lambda = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$，\n\n其中 $Z_{\\odot}$ 表示太阳金属丰度。\n\n仅使用基本定义和列表形式的 $\\Lambda(T,Z)$：\n1) 从辐射损失的能量守恒出发，用 $n$、$n_{e}$、$n_{\\mathrm{H}}$、$T$ 和 $\\Lambda(T,Z)$ 推导等容冷却时间 $t_{\\mathrm{cool}}$。\n2) 对于完全电离气体，根据 $n_{\\mathrm{H}}$、$X$ 和 $Y$ 计算 $n_{e}$ 和 $n$，然后使用列表形式的 $\\Lambda(T,Z)$ 在 $Z=0.1\\,Z_{\\odot}$ 和 $Z=1.0\\,Z_{\\odot}$ 处对 $t_{\\mathrm{cool}}$ 进行数值计算。\n3) 将冷却时间在区间 $Z \\in [0.1\\,Z_{\\odot},\\,1.0\\,Z_{\\odot}]$ 上的对数金属丰度灵敏度定义为\n$$\nS_{Z} \\equiv \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})}\\ \\ \\text{with}\\ \\ Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot},\\ \\ Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}.\n$$\n使用您的 $t_{\\mathrm{cool}}$ 值和列表形式的 $\\Lambda(T,Z)$ 计算 $S_{Z}$。\n\n将最终灵敏度 $S_{Z}$ 表示为一个无量纲数，并将您的最终答案四舍五入到三位有效数字。不要在最终答案中报告中间结果。", "solution": "首先根据既定标准对问题进行验证。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 过程：均匀、光学薄、完全电离气体团的等容冷却。\n- 氢数密度：$n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$。\n- 温度：$T = 10^{6}\\ \\mathrm{K}$。\n- 成分：氢质量分数 $X=0.76$，氦质量分数 $Y=0.24$。\n- 辐射率：$\\mathcal{L} = n_{e}\\,n_{\\mathrm{H}}\\,\\Lambda(T,Z)$，其中 $\\Lambda(T,Z)$ 是冷却函数。\n- 内能密度：对于理想、单原子、完全电离气体，$u = \\tfrac{3}{2}\\,n\\,k_{B}\\,T$。$n$ 是总粒子数密度。\n- 假设：$n$、$n_{e}$ 和 $n_{\\mathrm{H}}$ 与金属丰度 $Z$ 无关。\n- 在 $T = 10^{6}\\ \\mathrm{K}$ 时 $\\Lambda(T,Z)$ 的列表值：\n  - $Z = 0$：$\\Lambda = 1.2 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$。\n  - $Z = 0.1\\,Z_{\\odot}$：$\\Lambda = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$。\n  - $Z = 1.0\\,Z_{\\odot}$：$\\Lambda = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$。\n- 任务：\n  1. 用 $n$、$n_{e}$、$n_{\\mathrm{H}}$、$T$ 和 $\\Lambda(T,Z)$ 推导等容冷却时间 $t_{\\mathrm{cool}}$。\n  2. 根据 $n_{\\mathrm{H}}$、$X$ 和 $Y$ 计算 $n_{e}$ 和 $n$，然后在 $Z=0.1\\,Z_{\\odot}$ 和 $Z=1.0\\,Z_{\\odot}$ 处计算 $t_{\\mathrm{cool}}$。\n  3. 计算对数金属丰度灵敏度 $S_{Z} \\equiv \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})}$，其中 $Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot}$，$Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学上成立的**：该问题描述了天体物理气体的辐射冷却，受标准热力学原理控制，并使用了内能和辐射率的常规定义。物理参数和表格数据代表了诸如环星系介质之类的真实天体物理环境。该问题在科学上是合理的。\n- **适定的**：该问题是自洽的，提供了所有必要的定义、方程和数据。任务规定明确，并能导出一个唯一的、有意义的解。\n- **客观的**：该问题以精确、定量且无偏见的语言陈述。\n\n**步骤 3：结论与行动**\n- **结论**：该问题是有效的。它在科学上是成立的、适定的和客观的。\n- **行动**：继续进行求解。\n\n**解**\n\n**1) 等容冷却时间 $t_{\\mathrm{cool}}$ 的推导**\n将热力学第一定律应用于一个只存在辐射损失、经历等容冷却的单位体积气体，其内能密度 $u$ 的变化率与体积辐射冷却率 $\\mathcal{L}$ 之间存在平衡关系。\n$$ \\frac{du}{dt} = -\\mathcal{L} $$\n我们已知单原子理想气体的内能密度和辐射率的表达式：\n$$ u = \\frac{3}{2} n k_{B} T $$\n$$ \\mathcal{L} = n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\n将这些表达式代入能量守恒方程，得到：\n$$ \\frac{d}{dt} \\left( \\frac{3}{2} n k_{B} T \\right) = -n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\n对于一个成分固定且气体保持完全电离的等容过程，数密度 $n$、$n_{e}$ 和 $n_{\\mathrm{H}}$ 是常数。玻尔兹曼常数 $k_{B}$ 也是一个常数。因此，我们可以写出：\n$$ \\frac{3}{2} n k_{B} \\frac{dT}{dt} = -n_{e} n_{\\mathrm{H}} \\Lambda(T,Z) $$\n特征冷却时间 $t_{\\mathrm{cool}}$ 定义为内能（或等效地，温度）的 e-折叠时间，假设在该时间尺度上冷却率是恒定的：\n$$ t_{\\mathrm{cool}} \\equiv \\left| \\frac{u}{du/dt} \\right| = \\frac{u}{\\mathcal{L}} $$\n代入 $u$ 和 $\\mathcal{L}$ 的表达式，得到所需的冷却时间关系式：\n$$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} n k_{B} T}{n_{e} n_{\\mathrm{H}} \\Lambda(T,Z)} $$\n\n**2) 数密度和 $t_{\\mathrm{cool}}$ 的计算**\n接下来，我们计算氢质量分数为 $X=0.76$、氦质量分数为 $Y=0.24$ 的完全电离气体的总粒子数密度 $n$ 和电子数密度 $n_{e}$。设 $n_{\\mathrm{H}}$ 和 $n_{\\mathrm{He}}$ 分别为氢核和氦核的数密度。氢核的质量为 $m_{\\mathrm{p}}$，氦核的质量约为 $4m_{\\mathrm{p}}$。\n质量分数定义为 $X = n_{\\mathrm{H}} m_{\\mathrm{p}} / \\rho$ 和 $Y = 4 n_{\\mathrm{He}} m_{\\mathrm{p}} / \\rho$，其中 $\\rho$ 是总质量密度。这些分数的比值给出了数密度之间的关系：\n$$ \\frac{Y}{X} = \\frac{4 n_{\\mathrm{He}} m_{\\mathrm{p}} / \\rho}{n_{\\mathrm{H}} m_{\\mathrm{p}} / \\rho} = \\frac{4 n_{\\mathrm{He}}}{n_{\\mathrm{H}}} \\implies n_{\\mathrm{He}} = n_{\\mathrm{H}} \\frac{Y}{4X} $$\n由于气体是完全电离的，每个氢原子贡献一个电子，每个氦原子贡献两个电子。电子数密度 $n_e$ 为：\n$$ n_{e} = n_{\\mathrm{H}} + 2 n_{\\mathrm{He}} = n_{\\mathrm{H}} + 2 \\left( n_{\\mathrm{H}} \\frac{Y}{4X} \\right) = n_{\\mathrm{H}} \\left( 1 + \\frac{Y}{2X} \\right) $$\n总粒子数密度 $n$ 是离子（质子和 α 粒子）和电子的总和：\n$$ n = n_{\\mathrm{H}} + n_{\\mathrm{He}} + n_{e} = n_{\\mathrm{H}} + n_{\\mathrm{H}} \\frac{Y}{4X} + n_{\\mathrm{H}} \\left( 1 + \\frac{Y}{2X} \\right) = n_{\\mathrm{H}} \\left( 2 + \\frac{3Y}{4X} \\right) $$\n使用给定值 $X=0.76$ 和 $Y=0.24$：\n$$ \\frac{Y}{X} = \\frac{0.24}{0.76} = \\frac{6}{19} $$\n$$ n_{e} = n_{\\mathrm{H}} \\left( 1 + \\frac{1}{2} \\frac{6}{19} \\right) = n_{\\mathrm{H}} \\left( 1 + \\frac{3}{19} \\right) = \\frac{22}{19} n_{\\mathrm{H}} $$\n$$ n = n_{\\mathrm{H}} \\left( 2 + \\frac{3}{4} \\frac{6}{19} \\right) = n_{\\mathrm{H}} \\left( 2 + \\frac{9}{38} \\right) = \\frac{85}{38} n_{\\mathrm{H}} $$\n给定 $n_{\\mathrm{H}} = 1.0\\ \\mathrm{cm}^{-3}$，我们有 $n_{e} = \\frac{22}{19}\\ \\mathrm{cm}^{-3}$ 和 $n = \\frac{85}{38}\\ \\mathrm{cm}^{-3}$。\n\n现在我们将这些代入 $t_{\\mathrm{cool}}$ 的表达式中：\n$$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} \\left( \\frac{85}{38} n_{\\mathrm{H}} \\right) k_{B} T}{ \\left( \\frac{22}{19} n_{\\mathrm{H}} \\right) n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{3}{2} \\frac{85/38}{22/19} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{3}{2} \\frac{85}{44} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} = \\frac{255}{88} \\frac{k_{B} T}{n_{\\mathrm{H}} \\Lambda(T,Z)} $$\n令常数部分为 $C = \\frac{255}{88} \\frac{k_B T}{n_{\\mathrm{H}}}$。那么冷却时间为 $t_{\\mathrm{cool}}(Z) = C / \\Lambda(T,Z)$。我们被要求计算两种金属丰度下的 $t_{\\mathrm{cool}}$，尽管这些是中间结果。\n在 $Z_{\\mathrm{low}} = 0.1\\,Z_{\\odot}$ 时，$\\Lambda(Z_{\\mathrm{low}}) = 4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$。\n在 $Z_{\\mathrm{high}} = 1.0\\,Z_{\\odot}$ 时，$\\Lambda(Z_{\\mathrm{high}}) = 2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$。\n如下一步所示，计算冷却时间对于最终答案并非严格必要。\n\n**3) 对数金属丰度灵敏度 $S_{Z}$ 的计算**\n灵敏度 $S_Z$ 定义为：\n$$ S_{Z} = \\frac{\\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{high}})\\big) - \\ln\\!\\big(t_{\\mathrm{cool}}(Z_{\\mathrm{low}})\\big)}{\\ln(Z_{\\mathrm{high}}) - \\ln(Z_{\\mathrm{low}})} $$\n利用对数的性质，可以将其改写为：\n$$ S_{Z} = \\frac{\\ln \\left( \\frac{t_{\\mathrm{cool}}(Z_{\\mathrm{high}})}{t_{\\mathrm{cool}}(Z_{\\mathrm{low}})} \\right)}{\\ln \\left( \\frac{Z_{\\mathrm{high}}}{Z_{\\mathrm{low}}} \\right)} $$\n从我们得到的 $t_{\\mathrm{cool}}$ 表达式中可以看出，$t_{\\mathrm{cool}}$ 与 $\\Lambda(T,Z)$ 成反比，因为根据问题陈述，所有其他量（$n, n_e, n_{\\mathrm{H}}, T, k_B$）相对于金属丰度 $Z$ 都是恒定的。\n$$ \\frac{t_{\\mathrm{cool}}(Z_{\\mathrm{high}})}{t_{\\mathrm{cool}}(Z_{\\mathrm{low}})} = \\frac{C / \\Lambda(T, Z_{\\mathrm{high}})}{C / \\Lambda(T, Z_{\\mathrm{low}})} = \\frac{\\Lambda(T, Z_{\\mathrm{low}})}{\\Lambda(T, Z_{\\mathrm{high}})} $$\n代入表中的 $\\Lambda$ 值：\n$$ \\frac{\\Lambda(T, Z_{\\mathrm{low}})}{\\Lambda(T, Z_{\\mathrm{high}})} = \\frac{4.0 \\times 10^{-23}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}}{2.0 \\times 10^{-22}\\ \\mathrm{erg}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}} = \\frac{4.0}{20.0} = \\frac{1}{5} $$\n金属丰度的比值为：\n$$ \\frac{Z_{\\mathrm{high}}}{Z_{\\mathrm{low}}} = \\frac{1.0\\,Z_{\\odot}}{0.1\\,Z_{\\odot}} = 10 $$\n现在，我们可以计算 $S_{Z}$：\n$$ S_{Z} = \\frac{\\ln(1/5)}{\\ln(10)} = \\frac{-\\ln(5)}{\\ln(10)} $$\n使用自然对数的值：\n$\\ln(5) \\approx 1.6094379$\n$\\ln(10) \\approx 2.3025851$\n$$ S_{Z} \\approx \\frac{-1.6094379}{2.3025851} \\approx -0.6989700 $$\n将结果四舍五入到三位有效数字，我们得到 $S_{Z} \\approx -0.699$。", "answer": "$$\\boxed{-0.699}$$", "id": "3505146"}, {"introduction": "在掌握了基本原理之后，本练习将你带到更高层次的建模挑战：实现“次网格”物理 [@problem_id:3505175]。你将处理恒星反馈这一至关重要的过程，通过比较两种常见的模型——“能量守恒”方案和“热能倾倒”方案——来研究它们对矮星系晕中金属保持率这一关键可观测量的重要影响。这个练习突显了对未解析物理的建模选择如何能够产生巨大的、星系尺度上的后果。", "problem": "您需要在一个简化的矮星系晕的化学-动力学模型中，实现并比较两种恒星反馈方案，并量化金属保持率和喷流阈值。星系晕采用球状超密度定义进行建模，反馈会引发一股外流，其能否逃逸取决于其速度与星系晕逃逸速度的相对关系。您的程序必须是一个完整、可运行的程序，能够为每个给定的测试用例计算能量守恒反馈方案与热能倾倒方案下的金属保持分数，以及喷流阈值。所有计算都必须遵循物理上一致的单位制，并且每个中间物理量都必须进行明确的单位转换。所有输出必须符合指定的单位一致性要求。\n\n使用的基本原理和定义：\n\n- 假设在红移 $z = 0$ 处有一个质量为 $M_{\\mathrm{halo}}$ 的球状星系晕。维里半径 $R_{\\mathrm{vir}}$ 由球状超密度条件定义，其超密度为 $\\Delta_{c}$（相对于临界密度 $\\rho_{c}$）。使用临界密度 $\\rho_{c} = \\dfrac{3 H_{0}^{2}}{8 \\pi G}$，其中 $H_{0}$ 是哈勃常数，$G$ 是引力常数。维里半径为 $R_{\\mathrm{vir}} = \\left(\\dfrac{3 M_{\\mathrm{halo}}}{4 \\pi \\Delta_{c} \\rho_{c}}\\right)^{1/3}$。在 $R_{\\mathrm{vir}}$ 处的星系晕逃逸速度为 $v_{\\mathrm{esc}} = \\sqrt{\\dfrac{2 G M_{\\mathrm{halo}}}{R_{\\mathrm{vir}}}}$。\n- 重子质量为 $M_{\\mathrm{gas}} = f_{b} M_{\\mathrm{halo}}$，其中重子分数为 $f_{b}$。\n- 一次恒星形成事件会形成质量为 $M_{*}$ 的恒星。单位恒星质量的超新星数量为 $\\eta_{\\mathrm{SN}}$（超新星，SN）。每次超新星爆发的能量为 $E_{\\mathrm{SN}}$。总超新星能量的一部分（比例为 $\\epsilon_{E}$）作为反馈能量 $E_{\\mathrm{fb}}$ 进行耦合。\n- 能量守恒反馈方案将耦合的能量瞬间转化为外流的动能。质量加载因子为 $\\eta_{w}$，使得 $M_{\\mathrm{out}} = \\eta_{w} M_{*}$。风速 $v_{w}$ 满足能量守恒，当 $v_{w} \\ge v_{\\mathrm{esc}}$ 时发生喷流。\n- 热能倾倒反馈将相同的耦合能量以热能形式注入气体中。辐射冷却会消耗这部分能量。剩余的有效能量建模为 $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp\\!\\left(-\\dfrac{t_{\\mathrm{adv}}}{t_{\\mathrm{cool}}}\\right)$，其中 $t_{\\mathrm{adv}}$ 是一个固定的平流时间尺度，$t_{\\mathrm{cool}}$ 是根据局部气体条件计算出的辐射冷却时间。注入后单位质量的热能为 $e_{\\mathrm{th}} = \\dfrac{E_{\\mathrm{fb}}}{M_{\\mathrm{out}}}$，注入后的温度为 $T = \\dfrac{2 \\mu m_{p}}{3 k_{B}} e_{\\mathrm{th}}$，其中 $\\mu$ 是平均分子量，$m_{p}$ 是质子质量，$k_{B}$ 是玻尔兹曼常数。假设气体完全电离，数密度为 $n = \\dfrac{\\rho}{\\mu m_{p}}$，其中 $\\rho$ 是半径为 $r_{\\mathrm{sf}}$ 的恒星形成区域内的质量密度，恒星形成区域的体积视为 $V_{\\mathrm{sf}} = \\dfrac{4}{3} \\pi r_{\\mathrm{sf}}^{3}$，且 $\\rho = \\dfrac{M_{\\mathrm{gas}}}{V_{\\mathrm{sf}}}$。冷却函数近似为 $\\Lambda(T,Z) = \\Lambda_{0} Z \\left(\\dfrac{T}{10^{6}\\,\\mathrm{K}}\\right)^{1/2}$，冷却时间为 $t_{\\mathrm{cool}} = \\dfrac{\\tfrac{3}{2} n k_{B} T}{n^{2}\\Lambda(T,Z)} = \\dfrac{\\tfrac{3}{2} k_{B} T}{n \\Lambda(T,Z)}$。此处，$Z$ 是加入产额后的气体金属丰度（质量分数），$\\Lambda_{0}$ 是一个常数。\n- 金属产额将新的金属 $M_{Z,\\mathrm{new}} = y M_{*}$ 加入到气体中。初始金属丰度为 $Z_{0}$，因此产额加入后的金属丰度为 $Z_{1} = \\dfrac{Z_{0} M_{\\mathrm{gas}} + M_{Z,\\mathrm{new}}}{M_{\\mathrm{gas}}}$。相对于星际介质（ISM），风的金属负载因子为 $\\xi$，因此其金属质量分数为 $Z_{w} = \\min\\!\\left(1,\\xi Z_{1}\\right)$。产额加入后的总金属质量为 $M_{Z,\\mathrm{tot}} = Z_{1} M_{\\mathrm{gas}}$，由外流携带的金属质量为 $M_{Z,\\mathrm{out}} = \\min\\!\\left(Z_{w} M_{\\mathrm{out}}, M_{Z,\\mathrm{tot}}\\right)$。如果发生喷流（逃逸），这些金属将从星系晕中丢失；否则，它们将被保留下来。金属保持分数为 $f_{Z,\\mathrm{ret}} = \\dfrac{M_{Z,\\mathrm{ret}}}{M_{Z,\\mathrm{tot}}}$，其中如果发生喷流，$M_{Z,\\mathrm{ret}} = M_{Z,\\mathrm{tot}} - M_{Z,\\mathrm{out}}$，否则 $M_{Z,\\mathrm{ret}} = M_{Z,\\mathrm{tot}}$。\n\n需要计算的阈值：\n\n- 对于能量守恒反馈，计算在上述假设下使得 $v_{w} = v_{\\mathrm{esc}}$ 的最小耦合效率 $\\epsilon_{E,\\mathrm{th}}$。\n- 对于热能倾倒，计算临近平流时间 $t_{\\mathrm{adv,crit}}$，使得当 $E_{\\mathrm{eff}} = \\dfrac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^{2}$ 且 $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp\\!\\left(-\\dfrac{t_{\\mathrm{adv}}}{t_{\\mathrm{cool}}}\\right)$ 时，$v_{w} = v_{\\mathrm{esc}}$。以百万年（Myr）为单位表示 $t_{\\mathrm{adv,crit}}$。如果所需的比率 $\\dfrac{\\tfrac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^{2}}{E_{\\mathrm{fb}}}$ 超过1，则报告一个负值的 $t_{\\mathrm{adv,crit}}$，表示即使没有冷却，喷流也不可能发生。\n\n单位与常数：\n\n- 使用 $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$，$H_{0} = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$，$f_{b} = 0.16$，$\\Delta_{c} = 200$，$m_{p} = 1.67262\\times 10^{-27}\\,\\mathrm{kg}$，$k_{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，$\\mu = 0.6$（无量纲），太阳质量 $M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$，$1\\,\\mathrm{erg} = 10^{-7}\\,\\mathrm{J}$，$1\\,\\mathrm{kpc} = 3.085677581\\times 10^{19}\\,\\mathrm{m}$，$1\\,\\mathrm{Myr} = 3.15576\\times 10^{13}\\,\\mathrm{s}$。使用 $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$。使用 $\\Lambda_{0} = 2\\times 10^{-23}\\,\\mathrm{erg\\,cm^{3}\\,s^{-1}}$，转换为国际单位制（SI）为 $\\Lambda_{0,\\mathrm{SI}} = 2\\times 10^{-36}\\,\\mathrm{J\\,m^{3}\\,s^{-1}}$。\n- 所有涉及物理时间的输出都必须以百万年（Myr）为单位表示。金属丰度和保持率是无量纲的分数。布尔值必须以字面布尔值的形式生成。\n\n测试套件：\n\n您的程序必须评估以下四个测试用例。对于每个用例，使用上面给出的相同全局常数，以及指定的恒星形成区半径 $r_{\\mathrm{sf}}$ 和其他天体物理参数。参数中出现的所有质量单位均为太阳质量 $M_{\\odot}$，长度单位为千秒差距（kpc），时间单位为百万年（Myr），但您的内部计算必须转换为国际单位制（SI）单位。\n\n- 用例 1（一般情况）：\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$，$M_{*} = 10^{6}\\,M_{\\odot}$，$\\epsilon_{E} = 0.1$，$\\eta_{w} = 5$，$Z_{0} = 0.001$，$y = 0.02$，$\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$，$E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$，$\\xi = 3$，$r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$，$t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$。\n- 用例 2（接近能量喷流阈值）：\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$，$M_{*} = 5\\times 10^{5}\\,M_{\\odot}$，$\\epsilon_{E} = 9.65\\times 10^{-3}$，$\\eta_{w} = 5$，$Z_{0} = 0.001$，$y = 0.02$，$\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$，$E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$，$\\xi = 3$，$r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$，$t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$。\n- 用例 3（高质量加载边缘情况）：\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$，$M_{*} = 10^{6}\\,M_{\\odot}$，$\\epsilon_{E} = 0.05$，$\\eta_{w} = 20$，$Z_{0} = 0.001$，$y = 0.02$，$\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$，$E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$，$\\xi = 3$，$r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$，$t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$。\n- 用例 4（较低质量星系晕，较短平流时间）：\n    - $M_{\\mathrm{halo}} = 5\\times 10^{8}\\,M_{\\odot}$，$M_{*} = 3\\times 10^{5}\\,M_{\\odot}$，$\\epsilon_{E} = 0.05$，$\\eta_{w} = 5$，$Z_{0} = 5\\times 10^{-4}$，$y = 0.02$，$\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$，$E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$，$\\xi = 3$，$r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$，$t_{\\mathrm{adv}} = 10\\,\\mathrm{Myr}$。\n\n每个测试用例的必需输出：\n\n- 为每个用例计算并按以下顺序以列表形式输出：\n    1. 能量守恒反馈的 $f_{Z,\\mathrm{ret}}$（无量纲小数）。\n    2. 热能倾倒反馈的 $f_{Z,\\mathrm{ret}}$（无量纲小数）。\n    3. 一个布尔值，指示能量守恒反馈下是否发生喷流。\n    4. 一个布尔值，指示热能倾倒反馈下是否发生喷流。\n    5. 能量守恒喷流耦合阈值 $\\epsilon_{E,\\mathrm{th}}$（无量纲小数）。\n    6. 热能倾倒临近平流时间 $t_{\\mathrm{adv,crit}}$，单位为 $\\mathrm{Myr}$（浮点数；如果即使没有冷却也无法发生喷流，则为负值）。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含四个用例的结果，结果为逗号分隔的列表，每个用例的结果本身是按上述顺序排列的列表，整个输出用方括号括起来。例如，包含 $N$ 个用例的输出应如下所示：`[[\\ldots],[\\ldots],[\\ldots],[\\ldots]]`。不应打印任何附加文本。", "solution": "用户提供的问题是一个在计算天体物理学中定义明确且具有科学依据的练习，要求为一个矮星系实现一个简化的化学-动力学模型。该问题是有效的，因为它是自洽的，提供了计算所需量所需的所有物理公式、常数和参数。该模型虽然经过简化，但基于星系形成理论的既定原则，包括星系晕结构、恒星反馈和化学增丰。\n\n该解决方案以 Python 程序的形式实现，系统地处理每个测试用例。解决方案的核心是一个函数，它为一组给定的参数执行物理模型。所有计算都在国际单位制（SI）中执行，以确保物理一致性。\n\n算法和物理步骤如下：\n\n1.  **初始化和单位转换**：所有物理常数（$G$、$H_0$、$m_p$ 等）都在其国际单位制（SI）基本单位中定义。每个测试用例的输入参数，以常见的天体物理单位（例如，质量用 $M_{\\odot}$，距离用 kpc）给出，在开始时都转换为 SI 单位。例如，哈勃常数 $H_0 = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 被转换为 $\\mathrm{s}^{-1}$。\n\n2.  **星系晕属性**：该模型首先描述暗物质晕的特征。使用哈勃常数 $H_0$ 和引力常数 $G$ 计算红移 $z=0$ 时宇宙的临界密度：\n    $$ \\rho_{c} = \\frac{3 H_{0}^{2}}{8 \\pi G} $$\n    利用星系晕质量 $M_{\\mathrm{halo}}$ 和超密度参数 $\\Delta_c = 200$，确定维里半径 $R_{\\mathrm{vir}}$：\n    $$ R_{\\mathrm{vir}} = \\left(\\frac{3 M_{\\mathrm{halo}}}{4 \\pi \\Delta_{c} \\rho_{c}}\\right)^{1/3} $$\n    此半径处的逃逸速度设定了物质从星系晕中被喷射（喷流）的条件，其值为：\n    $$ v_{\\mathrm{esc}} = \\sqrt{\\frac{2 G M_{\\mathrm{halo}}}{R_{\\mathrm{vir}}}} $$\n\n3.  **重子和反馈成分**：总重子质量假定为星系晕质量的一个固定分数 $f_b$，$M_{\\mathrm{gas}} = f_b M_{\\mathrm{halo}}$。一次恒星形成事件产生质量为 $M_*$ 的恒星。超新星释放的总能量为 $E_{\\mathrm{SN,tot}} = \\eta_{\\mathrm{SN}} M_* E_{\\mathrm{SN}}$，其中 $\\eta_{\\mathrm{SN}}$ 是单位恒星质量的超新星数量，$E_{\\mathrm{SN}}$ 是每次超新星爆发的能量。这部分能量的一部分（比例为 $\\epsilon_E$）耦合到星际介质中作为反馈能量，$E_{\\mathrm{fb}} = \\epsilon_E E_{\\mathrm{SN,tot}}$。反馈驱动了质量为 $M_{\\mathrm{out}} = \\eta_w M_*$ 的外流，其中 $\\eta_w$ 是质量加载因子。\n\n4.  **化学演化**：恒星形成事件用金属增丰了气体。新合成的金属质量为 $M_{Z,\\mathrm{new}} = y M_*$，其中 $y$ 是恒星产额。气体金属丰度（质量分数）从其初始值 $Z_0$ 增加到产额后的值 $Z_1$：\n    $$ Z_1 = \\frac{Z_0 M_{\\mathrm{gas}} + M_{Z,\\mathrm{new}}}{M_{\\mathrm{gas}}} $$\n    星系中可用的总金属质量为 $M_{Z,\\mathrm{tot}} = Z_1 M_{\\mathrm{gas}}$。假定外流的金属丰度为 $Z_w = \\min(1, \\xi Z_1)$，可能比周围介质高出一个因子 $\\xi$。外流中喷射出的金属质量为 $M_{Z,\\mathrm{out}} = \\min(Z_w M_{\\mathrm{out}}, M_{Z,\\mathrm{tot}})$。这可以防止不合物理地移走比实际存在的还多的金属。\n\n5.  **能量守恒反馈模型**：在此方案中，反馈能量 $E_{\\mathrm{fb}}$ 被瞬间转化为外流的动能：\n    $$ \\frac{1}{2} M_{\\mathrm{out}} v_{w,\\mathrm{EC}}^2 = E_{\\mathrm{fb}} \\quad \\implies \\quad v_{w,\\mathrm{EC}} = \\sqrt{\\frac{2 E_{\\mathrm{fb}}}{M_{\\mathrm{out}}}} $$\n    如果 $v_{w,\\mathrm{EC}} \\ge v_{\\mathrm{esc}}$，则发生喷流。如果发生喷流，喷射出的金属 $M_{Z,\\mathrm{out}}$ 将永久丢失。金属保持分数 $f_{Z,\\mathrm{ret}}$ 是保留的金属质量与初始总金属质量之比。\n\n6.  **热能倾倒反馈模型**：该模型考虑了辐射冷却。能量 $E_{\\mathrm{fb}}$ 首先作为热能注入外流质量 $M_{\\mathrm{out}}$ 中，产生比热能 $e_{\\mathrm{th}} = E_{\\mathrm{fb}} / M_{\\mathrm{out}}$。这将气体温度提高到 $T$：\n    $$ T = \\frac{2 \\mu m_p}{3 k_B} e_{\\mathrm{th}} $$\n    气体随时间冷却。冷却时间 $t_{\\mathrm{cool}}$ 取决于气体密度 $n$ 和冷却函数 $\\Lambda(T, Z_1)$。假设气体被限制在半径为 $r_{\\mathrm{sf}}$ 的恒星形成区域内，得到密度 $\\rho = M_{\\mathrm{gas}} / (\\frac{4}{3}\\pi r_{\\mathrm{sf}}^3)$ 和数密度 $n = \\rho / (\\mu m_p)$。冷却时间为：\n    $$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} k_B T}{n \\Lambda(T, Z_1)}, \\quad \\text{with} \\quad \\Lambda(T, Z_1) = \\Lambda_0 Z_1 \\left(\\frac{T}{10^6\\,\\mathrm{K}}\\right)^{1/2} $$\n    经过固定的平流时间尺度 $t_{\\mathrm{adv}}$后，可用于驱动外流的剩余有效能量为 $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp(-t_{\\mathrm{adv}} / t_{\\mathrm{cool}})$。这导致风速 $v_{w,\\mathrm{TD}} = \\sqrt{2 E_{\\mathrm{eff}} / M_{\\mathrm{out}}}$。然后像能量守恒情况一样评估喷流和金属保持情况。\n\n7.  **阈值计算**：\n    -   对于能量守恒模型，喷流阈值耦合效率 $\\epsilon_{E,\\mathrm{th}}$ 是外流达到逃逸速度所需的最小效率。通过设置 $v_{w,\\mathrm{EC}} = v_{\\mathrm{esc}}$ 并求解 $\\epsilon_E$ 来找到该值：\n        $$ \\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2 = \\epsilon_{E,\\mathrm{th}} E_{\\mathrm{SN,tot}} \\quad \\implies \\quad \\epsilon_{E,\\mathrm{th}} = \\frac{M_{\\mathrm{out}} v_{\\mathrm{esc}}^2}{2 E_{\\mathrm{SN,tot}}} $$\n    -   对于热能倾倒模型，临近平流时间 $t_{\\mathrm{adv,crit}}$ 是冷却可以作用的时间，在此之后有效能量将降至喷流所需的水平以下。我们将最终动能设置为临界值 $\\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2$ 并求解 $t_{\\mathrm{adv}}$：\n        $$ \\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2 = E_{\\mathrm{fb}} \\exp(-t_{\\mathrm{adv,crit}} / t_{\\mathrm{cool}}) \\quad \\implies \\quad t_{\\mathrm{adv,crit}} = -t_{\\mathrm{cool}} \\ln\\left(\\frac{\\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2}{E_{\\mathrm{fb}}}\\right) $$\n        如果所需的动能超过了初始耦合的反馈能量（$E_{\\mathrm{fb}}$），即使没有冷却，喷流也不可能发生。在这种情况下，对数的参数大于 1，产生一个负的 $t_{\\mathrm{adv,crit}}$，这作为所需的标志。\n\n最终程序遍历每个测试用例，应用这些计算，并将六个所需的输出值格式化为单个列表。然后将这些列表组合成最终的列表之列表结构进行输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares two stellar feedback prescriptions in a simplified \n    chemo-dynamical model of a dwarf galaxy halo.\n    \"\"\"\n    # Define physical and astronomical constants in SI units\n    CONST = {\n        'G': 6.67430e-11,          # Gravitational constant in m^3 kg^-1 s^-2\n        'Mpc_to_m': 3.085677581e22, # Meters per Megaparsec\n        'kpc_to_m': 3.085677581e19, # Meters per kiloparsec\n        'Msol_to_kg': 1.98847e30,   # Kilograms per Solar mass\n        'erg_to_J': 1e-7,          # Joules per erg\n        'Myr_to_s': 3.15576e13,      # Seconds per Megayear\n        'm_p': 1.67262e-27,        # Proton mass in kg\n        'k_B': 1.380649e-23,       # Boltzmann constant in J K^-1\n        'mu': 0.6,                 # Mean molecular weight (dimensionless)\n        'f_b': 0.16,               # Baryon fraction (dimensionless)\n        'Delta_c': 200.0,          # Overdensity parameter (dimensionless)\n        'Lambda0_SI': 2e-36,       # Cooling function constant in J m^3 s^-1\n    }\n    # Derived constant: Hubble constant in s^-1\n    CONST['H0'] = 70 * 1000 / CONST['Mpc_to_m']\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'name': 'Case 1', 'M_halo': 1e9, 'M_star': 1e6, 'eps_E': 0.1, 'eta_w': 5, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 2', 'M_halo': 1e9, 'M_star': 5e5, 'eps_E': 9.65e-3, 'eta_w': 5, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 3', 'M_halo': 1e9, 'M_star': 1e6, 'eps_E': 0.05, 'eta_w': 20, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 4', 'M_halo': 5e8, 'M_star': 3e5, 'eps_E': 0.05, 'eta_w': 5, 'Z0': 5e-4, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 10},\n    ]\n\n    final_results_str = []\n    for params in test_cases:\n        # Convert input parameters to SI units\n        M_halo_si = params['M_halo'] * CONST['Msol_to_kg']\n        M_star_si = params['M_star'] * CONST['Msol_to_kg']\n        eta_SN_si = params['eta_SN'] / CONST['Msol_to_kg']\n        E_SN_si = params['E_SN'] * CONST['erg_to_J']\n        r_sf_si = params['r_sf'] * CONST['kpc_to_m']\n        t_adv_si = params['t_adv'] * CONST['Myr_to_s']\n\n        # Step 1: Calculate Halo Properties\n        rho_c = (3 * CONST['H0']**2) / (8 * np.pi * CONST['G'])\n        R_vir = ((3 * M_halo_si) / (4 * np.pi * CONST['Delta_c'] * rho_c))**(1/3)\n        v_esc = np.sqrt((2 * CONST['G'] * M_halo_si) / R_vir)\n        \n        # Step 2: Calculate Gas, Outflow, and Feedback Energy\n        M_gas_si = CONST['f_b'] * M_halo_si\n        M_out_si = params['eta_w'] * M_star_si\n        E_fb_total_sn = eta_SN_si * M_star_si * E_SN_si\n        E_fb = params['eps_E'] * E_fb_total_sn\n\n        # Step 3: Calculate Chemical Evolution\n        M_Z_new = params['y'] * M_star_si\n        Z1 = (params['Z0'] * M_gas_si + M_Z_new) / M_gas_si\n        M_Z_tot = Z1 * M_gas_si\n        Z_w = min(1.0, params['xi'] * Z1)\n        M_Z_out = min(Z_w * M_out_si, M_Z_tot)\n\n        # Step 4: Energy-Conserving Feedback Model\n        v_w_ec = np.sqrt((2 * E_fb) / M_out_si) if M_out_si > 0 else 0\n        blowout_ec = v_w_ec >= v_esc\n        \n        M_Z_ret_ec = M_Z_tot - M_Z_out if blowout_ec else M_Z_tot\n        f_Z_ret_ec = M_Z_ret_ec / M_Z_tot if M_Z_tot > 0 else 1.0\n        \n        # Step 5: Thermal Dump Feedback Model\n        V_sf = (4/3) * np.pi * r_sf_si**3\n        rho_gas_sf = M_gas_si / V_sf\n        n_gas_sf = rho_gas_sf / (CONST['mu'] * CONST['m_p'])\n        e_th = E_fb / M_out_si if M_out_si > 0 else 0\n        T_post_inj = (2 * CONST['mu'] * CONST['m_p'] / (3 * CONST['k_B'])) * e_th\n\n        Lambda_T_Z = CONST['Lambda0_SI'] * Z1 * np.sqrt(T_post_inj / 1e6)\n        if n_gas_sf > 0 and Lambda_T_Z > 0 and T_post_inj > 0:\n            t_cool = (1.5 * CONST['k_B'] * T_post_inj) / (n_gas_sf * Lambda_T_Z)\n        else:\n            t_cool = np.inf\n\n        E_eff = E_fb * np.exp(-t_adv_si / t_cool) if t_cool > 0 else 0\n        v_w_td = np.sqrt((2 * E_eff) / M_out_si) if M_out_si > 0 else 0\n        blowout_td = v_w_td >= v_esc\n        \n        M_Z_ret_td = M_Z_tot - M_Z_out if blowout_td else M_Z_tot\n        f_Z_ret_td = M_Z_ret_td / M_Z_tot if M_Z_tot > 0 else 1.0\n\n        # Step 6: Threshold Calculations\n        E_kin_crit = 0.5 * M_out_si * v_esc**2\n        eps_E_th = E_kin_crit / E_fb_total_sn if E_fb_total_sn > 0 else np.inf\n\n        ratio = E_kin_crit / E_fb if E_fb > 0 else np.inf\n        if ratio > 1.0 :\n            t_adv_crit_si = -t_cool * np.log(ratio) # Will be negative if t_cool is positive\n        elif t_cool == np.inf or ratio == 0:\n            t_adv_crit_si = np.inf # Effectively means blowout requires no cooling or is trivial\n        else:\n            t_adv_crit_si = -t_cool * np.log(ratio)\n        \n        t_adv_crit_myr = t_adv_crit_si / CONST['Myr_to_s']\n\n        # Collect and format results for the current case\n        case_results = [\n            f_Z_ret_ec, f_Z_ret_td, blowout_ec, blowout_td, eps_E_th, t_adv_crit_myr\n        ]\n        # Required format is a list of strings without white-space inside the inner lists.\n        final_results_str.append(f\"[{','.join(str(v) for v in case_results)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results_str)}]\")\n\nsolve()\n\n```", "id": "3505175"}]}