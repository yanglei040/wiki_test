## 引言
我们所处的宇宙并非一个静态的舞台，而是一幅持续膨胀的宏伟画卷，星系如同漂浮的尘埃，彼此不断远去。在这样一个动态的背景下，如何精确描述天体的位置、速度以及支配它们的物理定律，成为了[现代宇宙学](@entry_id:752086)的核心挑战。为了应对这一挑战，物理学家们发展出了一套强大而优雅的语言——[共动坐标系](@entry_id:266800)（comoving coordinates），它巧妙地将宇宙的整体、均匀膨胀与星系因局部[引力](@entry_id:175476)产生的“额外”运动分离开来，为我们理解和[模拟宇宙](@entry_id:754872)提供了一把钥匙。

本文旨在系统性地阐述[共动坐标系](@entry_id:266800)及其相关的宇宙膨胀项。我们将从第一性原理出发，带领读者构建起描述膨胀宇宙的完整框架。
- 在“**原理与机制**”一章中，我们将深入探讨[共动坐标](@entry_id:271238)、[尺度因子](@entry_id:266678)和哈勃参数的定义，推导速度的分解方式，并揭示质量守恒等基本定律在[膨胀时空](@entry_id:161389)中的新形式。
- 接着，在“**应用与交叉学科联系**”一章中，我们将展示这一理论框架如何在绘制宇宙大尺度结构、解释“哈勃阻力”等物理现象，以及构建大规模宇宙学数值模拟中发挥着不可或缺的作用。
- 最后，在“**动手实践**”部分，我们将通过具体的编程练习，将理论知识转化为可操作的技能，让读者亲手实现和验证[宇宙膨胀](@entry_id:161474)效应的数值处理方法。

通过这趟旅程，你将不仅掌握一套计算工具，更将获得一个看待宇宙运动的全新物理视角，为深入研究[计算天体物理学](@entry_id:145768)打下坚实的基础。

## 原理与机制

在导言中，我们瞥见了宇宙的宏伟画卷——一个不断膨胀、星系四散的动态舞台。现在，让我们深入其腹地，揭示支撑这幅画卷的物理原理与机制。我们将像物理学家一样，从最基本的思想出发，一步步构建起描述这个膨胀宇宙的语言和工具。这趟旅程不仅关乎公式，更关乎一种看待宇宙的全新视角。

### 一个正在伸展的宇宙舞台

想象一下，你在一张巨大的、正在被均匀拉伸的橡皮膜上作画。你画下的点，即使自身在橡皮膜上没有移动，它们之间的距离也在不断增大。这并非因为这些点有什么“速度”，而是因为它们所在的“空间”——橡皮膜本身——正在伸展。这便是理解[宇宙膨胀](@entry_id:161474)最直观的类比。

为了将这个类比精确化，物理学家引入了**[尺度因子](@entry_id:266678)**（scale factor），记为 $a(t)$。它是一个只随时间变化的无量纲量，描述了宇宙整体的伸展程度。如果我们规定今天的尺度因子为 $1$（即 $a(\text{today}) = 1$），那么在过去某个时刻 $t$，宇宙中任意两点间的物理距离 $D(t)$ 就是它们今天距离 $D_0$ 的 $a(t)$ 倍，即 $D(t) = a(t) D_0$。

现在，我们可以定义两种至关重要的[坐标系](@entry_id:156346)。一种是画在橡皮膜上的坐标格，它们会随着橡皮膜的拉伸而一同伸展。我们称之为**[共动坐标](@entry_id:271238)**（comoving coordinates），用 $\mathbf{x}$ 表示。对于那些仅仅随着宇宙膨胀而运动，自身没有“额外”运动的星系（就像我们画的静止的点），它们的[共动坐标](@entry_id:271238)是恒定不变的。

另一种[坐标系](@entry_id:156346)则是我们日常经验中的“真实”坐标，它测量的是任意时刻两点间的实际物理距离。我们称之为**物理坐标**（physical coordinates）或[固有时](@entry_id:192124)坐标（proper coordinates），用 $\mathbf{r}$ 表示。

这两种[坐标系](@entry_id:156346)通过[尺度因子](@entry_id:266678)建立起了简洁而深刻的联系：

$$
\mathbf{r}(t) = a(t) \mathbf{x}
$$

这个关系是[现代宇宙学](@entry_id:752086)的基石之一 [@problem_id:3506149] [@problem_id:3506156]。它告诉我们，任何时刻的物理位置，都可以看作是“附着”在宇宙结构网格上的[共动坐标](@entry_id:271238)，经过宇宙[尺度因子](@entry_id:266678) $a(t)$ 的“缩放”后得到的结果。值得注意的是，这个简洁的线性关系在我们的宇宙模型——一个空间上平直的弗里德曼-勒梅特-罗伯逊-沃尔克（FLRW）宇宙中是精确成立的。如果宇宙存在整体的曲率（例如球面或双曲面几何），这个关系会变得更复杂，但其精髓——物理距离是[共动距离](@entry_id:158059)与尺度因子的乘积——在局部区域内依然成立 [@problem_id:3506149]。

### 星系的速度：哈勃流与[本动速度](@entry_id:157964)

有了描述位置的工具，我们自然会问：一个星系的速度是多少？这个问题在膨胀的宇宙中出人意料地微妙。让我们运用最基本的微积分来探寻答案。一个物体的物理速度 $\mathbf{v}$ 定义为其物理位置 $\mathbf{r}$ 对时间的导数。利用乘法法则对关系式 $\mathbf{r}(t) = a(t)\mathbf{x}(t)$ 求导，我们得到：

$$
\mathbf{v}(t) = \frac{d\mathbf{r}}{dt} = \frac{d(a\mathbf{x})}{dt} = \dot{a}(t)\mathbf{x}(t) + a(t)\dot{\mathbf{x}}(t)
$$

这个公式本身就是一首物理的诗，它将一个星系的总速度优美地分解为两个性质截然不同的部分。

第一部分是 $\dot{a}\mathbf{x}$。我们可以对它做一个巧妙的变形。定义**哈勃参数**（Hubble parameter）$H(t) \equiv \dot{a}(t)/a(t)$，它代表了宇宙在时刻 $t$ 的膨胀速率。于是，第一项可以写成：

$$
\dot{a}\mathbf{x} = \left(\frac{\dot{a}}{a}\right)(a\mathbf{x}) = H(t)\mathbf{r}(t)
$$

这便是著名的**哈勃流**（Hubble flow）。它描述的不是星系在空间中的“运动”，而是空间本身膨胀带着星系产生的退行速度。一个星系离我们越远（$\mathbf{r}$ 越大），其哈勃流速度就越大。这正是天文学家观测到的哈勃-勒梅特定律 [@problem_id:3506211] [@problem_id:3506156]。对于一个[共动坐标](@entry_id:271238) $\mathbf{x}$ 保持不变的星系，它的全部速度就是哈勃流。

第二部分是 $a(t)\dot{\mathbf{x}}(t)$。这里的 $\dot{\mathbf{x}}(t)$ 代表了星系[共动坐标](@entry_id:271238)的变化率，也就是它在伸展的宇宙“橡皮膜”上的移动速度。我们将这个速度乘以[尺度因子](@entry_id:266678) $a(t)$ 转换为物理单位，就得到了**物理[本动速度](@entry_id:157964)**（physical peculiar velocity），通常记为 $\mathbf{v}_{\text{pec}}$。[本动速度](@entry_id:157964)是由局部[引力](@entry_id:175476)（例如星系团的[引力](@entry_id:175476)）等因素驱动的、相对于哈勃流的“额外”运动。

因此，宇宙中任何物体的总速度，总是哈勃流速度和[本动速度](@entry_id:157964)的矢量和：

$$
\mathbf{v} = H\mathbf{r} + \mathbf{v}_{\text{pec}}
$$

这个速度分解是宇宙运动学的核心方程 [@problem_id:3506211] [@problem_id:3506149]，它清晰地区分了两种根本不同的运动来源。在[计算天体物理学](@entry_id:145768)中，理解和验证这个恒等式是处理模拟数据的第一步 [@problem_id:3506179]。

### 膨胀画布上的守恒律

物理定律，如质量守恒，在膨胀的宇宙中会呈现出新的面貌。让我们思考一个基本问题：随着宇宙膨胀，物质的密度如何变化？

让我们在[共动坐标系](@entry_id:266800)中画一个边长为 $L_{\text{com}}$ 的立方体。它的**共动体积** $V_{\text{com}} = L_{\text{com}}^3$ 是恒定不变的，因为它和坐标格一起伸展。然而，在任意时刻 $t$，这个立方体在真实世界中所占据的**物理体积** $V_{\text{phys}}$ 会随着尺度因子而变化：

$$
V_{\text{phys}}(t) = (a(t)L_{\text{com}})^3 = a(t)^3 V_{\text{com}}
$$

物理体积以尺度因子的三次方增长 [@problem_id:3506211]。现在，假设这个体积内有 $N$ 个粒子，并且这些粒子是守恒的（既不产生也不湮灭）。它们的**共动[数密度](@entry_id:268986)**，即单位共动体积内的粒子数，$n_{\text{com}} = N/V_{\text{com}}$，将保持不变。

但是，我们通常更关心**物理[数密度](@entry_id:268986)** $n_{\text{phys}}$，即单位物理体积内的粒子数。它将是：

$$
n_{\text{phys}}(t) = \frac{N}{V_{\text{phys}}(t)} = \frac{N}{a(t)^3 V_{\text{com}}} = \frac{n_{\text{com}}}{a(t)^3}
$$

这是一个极为深刻的结果：随着宇宙膨胀，任何守恒物质的物理密度都会以 $a(t)^{-3}$ 的形式被稀释。对于一个均匀的流体，这意味着其密度随时间的变化率满足[微分方程](@entry_id:264184) $\dot{\rho} = -3H\rho$ [@problem_id:3506211]。在[宇宙学模拟](@entry_id:747928)中，检验粒子数密度的演化是否遵循这个 $a^{-3}$ 定律，是验证代码正确性的一个基本测试 [@problem_id:3506170]。

更进一步，我们可以将这个思想推广到包含密度涨落的[非均匀流体](@entry_id:187276)。通过一系列严谨的数学推导，我们可以将描述质量守恒的[流体力学](@entry_id:136788)[连续性方程](@entry_id:195013)从物理坐标转换到[共动坐标](@entry_id:271238)。奇妙的是，所有与背景膨胀相关的项（例如 $3H\rho$）都可以被优雅地吸收到变量的定义中，最终得到一个形式上极其简洁的方程：

$$
\frac{\partial\delta}{\partial\eta} + \nabla_{\mathbf{x}} \cdot ((1+\delta)\mathbf{u}) = 0
$$

这里，$\delta$ 是**密度衬度**（density contrast），即局部密度相对于宇宙平均密度的涨落；$\mathbf{u}$ 是[共动坐标](@entry_id:271238)下的[本动速度](@entry_id:157964)；而时间变量 $\eta$ 是我们稍后会详细讨论的**共形时**（conformal time）。这个方程是描述宇宙[大尺度结构](@entry_id:158990)形成的核心方程之一，是几乎所有现代宇宙学模拟的理论基础 [@problem_id:3506162]。

### 结构形成的舞蹈：从拉格朗日到欧拉

宇宙并非完全均匀，它充满了由星系、[星系团](@entry_id:160919)和空洞构成的壮丽“宇宙网”。这些结构是如何从早期宇宙微小的密度涟漪中生长出来的？[共动坐标](@entry_id:271238)为我们提供了一套完美的语言来描述这场[引力](@entry_id:175476)之舞。

我们可以给早期宇宙中的每一个物[质粒](@entry_id:263777)子一个永久的“标签”，这个标签就是它在初始时刻的共动位置。我们称之为**拉格朗日坐标**（Lagrangian coordinates），记为 $\mathbf{q}$。随着宇宙的演化，[引力](@entry_id:175476)将物质拉向高密度区域，每个粒子都会移动到一个新的共动位置，我们称之为**欧拉坐标**（Eulerian coordinates），记为 $\mathbf{x}(\mathbf{q}, t)$。

从拉格朗日坐标到欧拉坐标的映射 $\mathbf{x}(\mathbf{q}, t)$ 包含了宇宙[结构演化](@entry_id:186256)的全部动力学信息。而密度与这个映射之间存在着一个惊人而优美的联系。考虑最初占据了拉格朗日空间中一个无穷小体积 $d^3q$ 的物质元。其质量为 $dm = \bar{\rho}_{\text{com}} d^3q$，其中 $\bar{\rho}_{\text{com}}$ 是宇宙的平均共动密度。在演化[后期](@entry_id:165003)，这团相同的物质占据了欧拉空间中的体积 $d^3x$，其质量为 $dm = \rho_{\text{com}}(\mathbf{x}, t) d^3x$。

根据质量守恒，我们有 $\rho_{\text{com}}(\mathbf{x}) d^3x = \bar{\rho}_{\text{com}} d^3q$。而微元体积之间的关系由[坐标变换](@entry_id:172727)的**[雅可比行列式](@entry_id:137120)**（determinant of the Jacobian）决定：$d^3x = |\det(\mathbf{J})| d^3q$，其中[雅可比矩阵](@entry_id:264467)的元素为 $J_{ij} = \partial x_i / \partial q_j$。

将这些关系结合起来，我们便得到了连接密度与动力学的核心方程：

$$
\delta(\mathbf{x}, t) = \frac{\rho_{\text{com}}(\mathbf{x}, t) - \bar{\rho}_{\text{com}}}{\bar{\rho}_{\text{com}}} = \frac{1}{\det(\mathbf{J})} - 1
$$

这个公式揭示了[引力](@entry_id:175476)不稳定的本质 [@problem_id:3506178]：
-   当物质汇集，导致拉格朗日空间被“压缩”到更小的欧拉空间时，$\det(\mathbf{J})  1$，这使得密度衬度 $\delta$ 为正，形成过密区域（如星系团）。
-   当物质从某个区域流出，导致拉格朗日空间被“拉伸”到更大的欧拉空间时，$\det(\mathbf{J}) > 1$，这使得密度衬度 $\delta$ 为负，形成低密度区域（如宇宙空洞）。
宇宙结构的形成，本质上就是这场由[引力](@entry_id:175476)编排的、时空映射的[连续形变](@entry_id:151691)。

### 时钟的选择：宇宙时、共形时与[尺度因子](@entry_id:266678)

到目前为止，我们主要使用**宇宙时**（cosmic time） $t$。它有一个非常物理的定义：它就是那些与哈勃流完全同步运动的“[共动观测者](@entry_id:158168)”手表上流逝的时间 [@problem_id:3506149]。

然而，在进行[数值模拟](@entry_id:137087)时，使用宇宙时作为唯一的“时钟”会遇到一个大麻烦。宇宙的演化节奏极不均匀：在早期（$a \to 0$），万物演化得飞快，密度、温度在极短的宇宙时内发生剧变；而在晚期，演化则变得非常缓慢。如果用固定的宇宙时间步长来模拟，要么在早期跟不上宇宙的节奏，要么在晚期浪费大量的计算资源。

幸运的是，我们可以选择不同的“时钟”来重新[参数化](@entry_id:272587)时间。在宇宙学中，最常用的两个替代品是**[尺度因子](@entry_id:266678)** $a$ 本身，以及**共形时**（conformal time） $\eta$。共形时由关系式 $dt = a(t) d\eta$ 定义。

为什么要引入共形时？它有一个神奇的特性：它“拉伸”了早期宇宙的时间轴，同时“压缩”了晚期的时间轴。对于许多宇宙模型，从大爆炸到无穷远的未来的整个宇宙历史，都对应着一段有限的共形时区间。这对于[数值积分](@entry_id:136578)来说是巨大的优势，因为它使得演化过程看起来更加“平缓”，允许我们使用更大、更稳定的时间步长。

更换时钟意味着我们需要重新书写我们的[演化方程](@entry_id:268137)。导数之间的转换关系可以通过链式法则得到：

$$
\frac{d}{dt} = aH \frac{d}{da} = \frac{1}{a} \frac{d}{d\eta}
$$

掌握这些导数算符之间的变换，是编写任何宇宙学演化代码的关键技能 [@problem_id:3506160]。

这种选择会带来实实在在的物理和数值后果。例如，粒子的[本动速度](@entry_id:157964)会因为宇宙膨胀而自然衰减，这种现象被称为**哈勃阻尼**（Hubble drag）。在共形时下，这个效应的方程可以写成非常简洁的形式 $v' + \mathcal{H}v = 0$（其中 $\mathcal{H}$ 是共形哈勃参数）。如何对这个方程进行[数值积分](@entry_id:136578)——例如，是使用向前一步的显式方法还是向后一步的隐式方法——将直接影响到模拟的长期稳定性和精度 [@problem_id:3506202]。

同样，在[模拟宇宙](@entry_id:754872)[流体力学](@entry_id:136788)时，决定数值稳定性的**CFL条件**（[Courant-Friedrichs-Lewy](@entry_id:175598) condition）也必须根据所选的[坐标系](@entry_id:156346)和时间变量来正确表述。这个条件限制了时间步长，以确保信息传播的速度不会超过数值网格的解析能力。一个在[共动坐标系](@entry_id:266800)下推导出的[CFL条件](@entry_id:178032)，其形式会自然地包含尺度因子，例如 $\Delta t \propto a \Delta x / (|u|+c_s)$，这精确地反映了物理[信号速度](@entry_id:261601)和网格间距在膨胀宇宙中的相对关系 [@problem_id:3506198]。

综上所述，从一个简单的[坐标变换](@entry_id:172727) $\mathbf{r}=a\mathbf{x}$ 出发，我们构建了一整套描述[膨胀宇宙](@entry_id:161442)中运动、守恒律、[结构形成](@entry_id:158241)和数值计算的自洽框架。这套“共动”语言，不仅在数学上是优雅的，更在物理上深刻地揭示了宇宙膨胀如何塑造了我们所见的一切。