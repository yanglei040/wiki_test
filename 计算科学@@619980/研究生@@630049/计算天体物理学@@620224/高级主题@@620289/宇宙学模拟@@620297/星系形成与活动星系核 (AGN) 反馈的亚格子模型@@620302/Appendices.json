{"hands_on_practices": [{"introduction": "本练习模拟了活动星系核（AGN）反馈的一个常见结果：在星系团的热气体中膨胀的低密度气泡。通过平衡浮力与流体动力学阻力这两个基本作用力，你将推导出气泡的终端速度，这为宏观现象如何被简化为次网格配方提供了一个具体范例。这项练习将经典的流体动力学与大尺度天体物理学模拟联系了起来。[@problem_id:3537559]", "problem": "在一次关于星系形成的宇宙学流体动力学模拟中，一个活动星系核（AGN）注入能量，在星系团内介质（ICM）中膨胀出一个低密度气泡。由于气泡内部及其湍流边界层是未解析的，次网格模型将气泡表示为一个受到浮力和流体动力学阻力作用的球体。考虑一个半径为 $R=10\\,\\mathrm{kpc}$ 的单一气泡，它嵌入在引力加速度为 $g=10^{-8}\\,\\mathrm{cm\\,s^{-2}}$ 的星系团内介质中，其密度对比度为 $\\Delta \\rho / \\rho \\approx 1$，其中 $\\rho$ 是周围星系团内介质的密度，$\\Delta \\rho$ 是周围介质与气泡内部密度之差。假设适用于星系团内介质的高雷诺数情况，并采用球体的恒定阻力系数 $C_{d}=0.5$，这是浮力气泡次网格模型中的典型值。\n\n从以下基本原理出发：\n- 阿基米德浮力原理，即在引力场中，浮力等于排开流体的重量。\n- 物体在高雷诺数下穿过流体时的标准惯性阻力定律，即阻力与动压乘以横截面积成正比。\n\n通过平衡浮力和阻力，推导气泡的终端浮力上升速度，然后估算其移动自身半径距离所需的上升时间。使用 $1\\,\\mathrm{kpc}=3.08567758\\times 10^{21}\\,\\mathrm{cm}$ 和 $1\\,\\mathrm{Myr}=3.15576\\times 10^{13}\\,\\mathrm{s}$ 进行单位转换。将速度和时间均四舍五入至三位有效数字。最终速度以 $\\mathrm{km\\,s^{-1}}$ 为单位，最终时间以 $\\mathrm{Myr}$ 为单位表示。", "solution": "问题陈述的严格验证如下。\n\n### 步骤 1：提取已知条件\n- 气泡半径：$R=10\\,\\mathrm{kpc}$\n- 星系团内介质（ICM）中的引力加速度：$g=10^{-8}\\,\\mathrm{cm\\,s^{-2}}$\n- 周围ICM与气泡内部的密度对比度：$\\frac{\\Delta \\rho}{\\rho} \\approx 1$，其中 $\\rho$ 是周围ICM的密度，$\\Delta \\rho$ 是 $\\rho - \\rho_{\\text{bubble}}$ 的差值。\n- 球体的阻力系数：$C_{d}=0.5$\n- 基本原理1：浮力是排开流体的重量（阿基米德原理）。\n- 基本原理2：惯性阻力 $F_D \\propto$ 动压 $\\times$ 横截面积。\n- 转换常数1：$1\\,\\mathrm{kpc}=3.08567758\\times 10^{21}\\,\\mathrm{cm}$\n- 转换常数2：$1\\,\\mathrm{Myr}=3.15576\\times 10^{13}\\,\\mathrm{s}$\n- 要求的输出格式：速度以 $\\mathrm{km\\,s^{-1}}$ 为单位，时间以 $\\mathrm{Myr}$ 为单位，均四舍五入至三位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学依据**：该问题很好地基于流体动力学原理（浮力、阻力）及其在计算天体物理学中一个标准问题（特别是AGN反馈的建模）的应用。所提供的物理参数（$R$、$g$、$C_d$、密度对比度）在物理上是合理的，并且与星系团的观测和模拟结果一致。\n- **适定性**：问题定义明确。它提供了推导终端速度和后续上升时间所需的所有必要信息。通过平衡浮力和阻力来求解终端速度，可以得到唯一解。\n- **客观性**：语言精确且定量。没有主观或模糊的陈述。近似值 $\\frac{\\Delta \\rho}{\\rho} \\approx 1$ 是该领域使用的标准、明确的简化，代表一个非常热的低密度气泡，不构成歧义。\n- **结论**：该问题不违反任何指定的无效标准。它是一个完整、一致且科学合理的问题。\n\n### 步骤 3：判定与操作\n该问题被判定为**有效**。将提供完整解答。\n\n### 求解过程推导\n当向上的浮力 $F_B$ 与向下的流体动力学阻力 $F_D$ 完全平衡时，气泡达到其终端浮力上升速度 $v_t$。该气泡被建模为半径为 $R$ 的球体。\n\n球形气泡的体积由下式给出：\n$$V = \\frac{4}{3}\\pi R^3$$\n\n气泡垂直于其运动方向的横截面积为：\n$$A = \\pi R^2$$\n\n浮力由阿基米德原理给出。净向上的力是排开的周围流体的重量减去气泡自身的重量。\n$$F_B = (\\rho - \\rho_{\\text{bubble}}) V g = \\Delta \\rho V g$$\n代入体积 $V$ 的表达式：\n$$F_B = \\Delta \\rho \\left(\\frac{4}{3}\\pi R^3\\right) g$$\n\n对于高雷诺数下的物体，流体动力学阻力由惯性阻力定律给出：\n$$F_D = C_d A \\left(\\frac{1}{2}\\rho v^2\\right)$$\n在这里，$\\rho$ 是气泡所穿过的周围介质的密度，$v$ 是气泡的速度，$C_d$ 是无量纲的阻力系数。代入面积 $A$ 的表达式：\n$$F_D = C_d (\\pi R^2) \\frac{1}{2}\\rho v^2 = \\frac{1}{2} C_d \\pi R^2 \\rho v^2$$\n\n在终端速度 $v_t$ 时，力达到平衡，$F_B = F_D$：\n$$\\Delta \\rho \\left(\\frac{4}{3}\\pi R^3\\right) g = \\frac{1}{2} C_d \\pi R^2 \\rho v_t^2$$\n\n我们现在求解 $v_t^2$。可以通过消去公因式 $(\\pi R^2)$ 来简化：\n$$\\Delta \\rho \\left(\\frac{4}{3}R\\right) g = \\frac{1}{2} C_d \\rho v_t^2$$\n重新整理以分离出 $v_t^2$：\n$$v_t^2 = \\frac{\\frac{4}{3} \\Delta \\rho R g}{\\frac{1}{2} C_d \\rho} = \\frac{8}{3} \\left(\\frac{\\Delta \\rho}{\\rho}\\right) \\frac{g R}{C_d}$$\n终端速度是该表达式的平方根：\n$$v_t = \\sqrt{\\frac{8}{3} \\left(\\frac{\\Delta \\rho}{\\rho}\\right) \\frac{g R}{C_d}}$$\n\n现在我们将给定的数值代入这个符号表达式中。\n- $\\frac{\\Delta \\rho}{\\rho} \\approx 1$\n- $C_d = 0.5$\n- $g = 10^{-8}\\,\\mathrm{cm\\,s^{-2}}$\n- $R = 10\\,\\mathrm{kpc} = 10 \\times (3.08567758 \\times 10^{21}\\,\\mathrm{cm}) = 3.08567758 \\times 10^{22}\\,\\mathrm{cm}$\n\n代入无量纲常数的数值：\n$$v_t = \\sqrt{\\frac{8}{3} (1) \\frac{g R}{0.5}} = \\sqrt{\\frac{16}{3} g R}$$\n现在，我们代入CGS单位制下的物理量：\n$$v_t = \\sqrt{\\frac{16}{3} (10^{-8}\\,\\mathrm{cm\\,s^{-2}}) (3.08567758 \\times 10^{22}\\,\\mathrm{cm})}$$\n$$v_t = \\sqrt{1.645694709 \\times 10^{15}\\,\\mathrm{cm^2\\,s^{-2}}} \\approx 4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}$$\n问题要求速度以 $\\mathrm{km\\,s^{-1}}$ 为单位。我们使用转换关系 $1\\,\\mathrm{km} = 10^5\\,\\mathrm{cm}$：\n$$v_t \\approx (4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}) \\times \\left(\\frac{1\\,\\mathrm{km}}{10^5\\,\\mathrm{cm}}\\right) = 405.67163\\,\\mathrm{km\\,s^{-1}}$$\n四舍五入到三位有效数字，终端速度为：\n$$v_t \\approx 406\\,\\mathrm{km\\,s^{-1}}$$\n\n接下来，我们估算气泡移动一段与其自身半径 $R$ 相等的距离 $d$ 所需的上升时间 $t$。假设气泡以其终端速度行进（即加速阶段可以忽略不计），则时间由下式给出：\n$$t = \\frac{d}{v_t} = \\frac{R}{v_t}$$\n为保持精度，使用未四舍五入的 $v_t$ 值：\n$$t = \\frac{3.08567758 \\times 10^{22}\\,\\mathrm{cm}}{4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}} \\approx 7.60639 \\times 10^{14}\\,\\mathrm{s}$$\n问题要求时间以百万年（Myr）为单位。我们使用转换关系 $1\\,\\mathrm{Myr} = 3.15576 \\times 10^{13}\\,\\mathrm{s}$：\n$$t \\approx \\frac{7.60639 \\times 10^{14}\\,\\mathrm{s}}{3.15576 \\times 10^{13}\\,\\mathrm{s/Myr}} \\approx 24.1032\\,\\mathrm{Myr}$$\n四舍五入到三位有效数字，上升时间为：\n$$t \\approx 24.1\\,\\mathrm{Myr}$$\n\n最终答案是终端速度为 $406\\,\\mathrm{km\\,s^{-1}}$，上升时间为 $24.1\\,\\mathrm{Myr}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n406  24.1\n\\end{pmatrix}\n}\n$$", "id": "3537559"}, {"introduction": "AGN反馈不仅涉及爆发性事件，还包括宇宙射线（CRs）等非热成分对能量和动量的持续输运。本练习要求你比较两种相互竞争的输运机制的时间尺度——由星系风引起的平流和通过磁场的扩散。这种时间尺度分析是一项关键技能，可用于确定哪些物理过程占主导地位，并必须在次网格模型中优先考虑。[@problem_id:3537587]", "problem": "在一个具有次网格宇宙线（CRs）输运和活动星系核（AGN）反馈的大涡星系形成模拟中，假设存在一个各向同性的宇宙线扩散系数 $\\,\\kappa\\,$ 和一个在网格上可分辨的特征宇宙线梯度长度尺度 $\\,L\\,$。速度为 $\\,v\\,$ 的稳态星系风平流输运宇宙线。从宇宙线输運方程的标准扩散-平流形式出发，利用扩散和平流算符的量纲分析来定义特征时标，推导出在长度尺度 $\\,L\\,$ 上扩散时标与平流时标的无量纲比 $\\,R\\,$。然后，对于 $\\,\\kappa = 3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}$，$\\,L = 1\\,\\mathrm{kpc}$，以及 $\\,v = 300\\,\\mathrm{km\\,s^{-1}}$，计算 $\\,R\\,$ 的值。使用厘米-克-秒（cgs）单位制，其中 $\\,1\\,\\mathrm{kpc} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}\\,$ 且 $\\,1\\,\\mathrm{km\\,s^{-1}} = 10^{5}\\,\\mathrm{cm\\,s^{-1}}$。报告 $\\,R\\,$ 的单个数值（无量纲）。将你的答案四舍五入到四位有效数字。", "solution": "经评估，该问题陈述是有效的。它在科学上基于已建立的宇宙线输运物理学，问题本身是适定的，并有足够的信息来获得唯一解，且以客观、精确的语言表述。在计算天体物理学的背景下，所有给定的数据和条件都是一致且物理上合理的。\n\n任务是推导银河风中宇宙线（CRs）的扩散时标与平流时标的无量纲比值 $R$，然后数值计算这个比值。\n\n我们从宇宙线能量密度（记为 $e_{cr}$）输运的标准扩散-平流方程开始。在没有源项和汇项的情况下，方程为：\n$$\n\\frac{\\partial e_{cr}}{\\partial t} + \\nabla \\cdot \\mathbf{F}_{cr} = 0\n$$\n其中 $\\mathbf{F}_{cr}$ 是宇宙线通量。该通量由气体体运动（星系风）引起的平流分量和宇宙线在磁场不规则性上散射引起的扩散分量组成。通量的表达式为：\n$$\n\\mathbf{F}_{cr} = \\mathbf{v} e_{cr} - \\kappa \\nabla e_{cr}\n$$\n这里，$\\mathbf{v}$ 是风速，$\\kappa$ 是各向同性的宇宙线扩散系数。将通量代入输运方程得到：\n$$\n\\frac{\\partial e_{cr}}{\\partial t} = -\\nabla \\cdot (\\mathbf{v} e_{cr}) + \\nabla \\cdot (\\kappa \\nabla e_{cr})\n$$\n右边的第一项代表平流，第二项代表扩散。我们可以通过量纲分析来确定每个过程的特征时标。设 $L$ 是宇宙线能量密度 $e_{cr}$ 发生显著变化的特征长度尺度。\n\n平流项是 $\\mathcal{A} = -\\nabla \\cdot (\\mathbf{v} e_{cr})$。假设风速 $\\mathbf{v}$ 是恒定的，大小为 $v$，其大小可以估计为：\n$$\n|\\mathcal{A}| \\sim v |\\nabla e_{cr}| \\sim v \\frac{e_{cr}}{L}\n$$\n平流过程在时标 $\\tau_{adv}$ 上改变宇宙线能量密度，使得变化率约为 $\\frac{e_{cr}}{\\tau_{adv}}$。将其与平流算符的大小相等可得：\n$$\n\\frac{e_{cr}}{\\tau_{adv}} \\sim v \\frac{e_{cr}}{L} \\implies \\tau_{adv} \\sim \\frac{L}{v}\n$$\n这就是风将宇宙线输运过长度尺度 $L$ 所需的时间。\n\n扩散项是 $\\mathcal{D} = \\nabla \\cdot (\\kappa \\nabla e_{cr})$。假设扩散系数 $\\kappa$ 是恒定的，其大小可以估计为：\n$$\n|\\mathcal{D}| \\sim \\kappa |\\nabla^2 e_{cr}| \\sim \\kappa \\frac{e_{cr}}{L^2}\n$$\n扩散过程在时标 $\\tau_{diff}$ 上改变宇宙线能量密度，使得变化率约为 $\\frac{e_{cr}}{\\tau_{diff}}$。将其与扩散算符的大小相等可得：\n$$\n\\frac{e_{cr}}{\\tau_{diff}} \\sim \\kappa \\frac{e_{cr}}{L^2} \\implies \\tau_{diff} \\sim \\frac{L^2}{\\kappa}\n$$\n这就是宇宙线扩散过长度尺度 $L$ 的特征时间。\n\n问题要求的是扩散时标与平流时标的无量纲比值 $R$。\n$$\nR = \\frac{\\tau_{diff}}{\\tau_{adv}}\n$$\n代入推导出的时标表达式：\n$$\nR = \\frac{L^2 / \\kappa}{L / v} = \\frac{L^2}{\\kappa} \\frac{v}{L} = \\frac{vL}{\\kappa}\n$$\n这个比值也被称为佩克莱数（Péclet number），它比较了平流输运和扩散输运的相对重要性。\n\n接下来，我们使用给定的数值来计算 $R$。我们必须首先将所有量转换为厘米-克-秒（cgs）单位制。\n给定的值为：\n$\\kappa = 3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}$\n$L = 1\\,\\mathrm{kpc}$\n$v = 300\\,\\mathrm{km\\,s^{-1}}$\n\n转换因子为：\n$1\\,\\mathrm{kpc} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}$\n$1\\,\\mathrm{km\\,s^{-1}} = 10^{5}\\,\\mathrm{cm\\,s^{-1}}$\n\n转换长度尺度 $L$：\n$$\nL = 1\\,\\mathrm{kpc} \\times \\frac{3.085677581 \\times 10^{21}\\,\\mathrm{cm}}{1\\,\\mathrm{kpc}} = 3.085677581 \\times 10^{21}\\,\\mathrm{cm}\n$$\n转换风速 $v$：\n$$\nv = 300\\,\\mathrm{km\\,s^{-1}} \\times \\frac{10^{5}\\,\\mathrm{cm\\,s^{-1}}}{1\\,\\mathrm{km\\,s^{-1}}} = 3 \\times 10^2 \\times 10^5\\,\\mathrm{cm\\,s^{-1}} = 3 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}\n$$\n现在，我们将这些 cgs 单位的数值代入 $R$ 的表达式中：\n$$\nR = \\frac{vL}{\\kappa} = \\frac{(3 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}) \\times (3.085677581 \\times 10^{21}\\,\\mathrm{cm})}{3 \\times 10^{28}\\,\\mathrm{cm^{2}\\,s^{-1}}}\n$$\n正如预期的那样，单位被消掉：$(\\mathrm{cm\\,s^{-1}} \\cdot \\mathrm{cm}) / (\\mathrm{cm^{2}\\,s^{-1}}) = 1$。\n$$\nR = \\frac{3 \\times 3.085677581 \\times 10^{7+21}}{3 \\times 10^{28}} = \\frac{3.085677581 \\times 10^{28}}{10^{28}} = 3.085677581\n$$\n问题要求答案四舍五入到四位有效数字。前五位有效数字是 $3.0856$。由于第五位数字（$6$）大于或等于 $5$，我们将第四位数字向上取整。\n$$\nR \\approx 3.086\n$$", "answer": "$$\n\\boxed{3.086}\n$$", "id": "3537587"}, {"introduction": "次网格模型通常依赖随机（stochastic）方法来表示未解析的物理过程，例如在随机方向上施加动量踢。这个计算实验探讨了一个关键的数值人造物：由于一系列不完全平衡的随机动量踢而导致的中心黑洞的伪“漂移”。通过进行蒙特卡洛模拟，你将量化这种效应，并理解方向模型（各向同性与双锥形）的选择如何影响数值稳定性。[@problem_id:3537631]", "problem": "您的任务是评估用于表示活动星系核（AGN）反馈的次网格动量踢动模型的数值稳定性。在此类次网格模型中，一个质量为 $M_{\\mathrm{BH}}$ 的未分辨黑洞向周围气体施加一系列动量踢动 $\\{\\mathbf{p}_k\\}_{k=1}^{K}$，其大小固定为 $|\\mathbf{p}_k| = p_0$。根据动量守恒定律，黑洞会受到一个大小相等、方向相反的反冲动量 $-\\sum_{k=1}^{K} \\mathbf{p}_k$。由于踢动方向是从一个给定的方向概率分布中随机抽样的，有限样本的不对称性可能会导致黑洞产生伪净漂移。您的目标是量化这种伪漂移，并将其表示为踢动方向分布的函数。\n\n基本依据：\n- 动量守恒意味着，在 $K$ 次踢动后，黑洞的反冲速度为 $\\mathbf{v} = -\\frac{1}{M_{\\mathrm{BH}}}\\sum_{k=1}^{K} \\mathbf{p}_k$。\n- 在球面上均匀采样的方向（各向同性分布）可以通过抽取 $\\phi \\sim \\mathrm{Uniform}(0, 2\\pi)$ 和 $\\mu \\equiv \\cos\\theta \\sim \\mathrm{Uniform}(-1, 1)$ 来获得，从而得到单位矢量 $\\hat{\\mathbf{n}} = (\\sqrt{1-\\mu^2}\\cos\\phi, \\sqrt{1-\\mu^2}\\sin\\phi, \\mu)$。\n- 半张角为 $\\theta_0$ 的双锥分布由两个以 $\\pm \\hat{\\mathbf{z}}$ 轴为中心、半角为 $\\theta_0$ 的相对圆锥组成。要在此双锥内按立体角均匀采样，需以相等的概率抽取一个符号 $s \\in \\{+1, -1\\}$，抽取 $\\mu' \\sim \\mathrm{Uniform}(\\cos\\theta_0, 1)$，设置 $\\mu = s\\,\\mu'$，抽取 $\\phi \\sim \\mathrm{Uniform}(0, 2\\pi)$，然后构建单位矢量 $\\hat{\\mathbf{n}} = (\\sqrt{1-\\mu^2}\\cos\\phi, \\sqrt{1-\\mu^2}\\sin\\phi, \\mu)$。\n\n将伪净漂移速率定义为 $v \\equiv \\left\\|\\sum_{k=1}^{K} \\mathbf{p}_k\\right\\|/M_{\\mathrm{BH}}$，即反冲速度的大小。对于下面的每个测试用例，使用固定的伪随机数生成器种子，在 $T$ 次蒙特卡洛试验中计算样本均值 $\\langle v \\rangle$。\n\n在以下固定物理参数下实施计算实验：\n- 黑洞质量：$M_{\\mathrm{BH}} = 10^9 M_{\\odot}$，其中 $M_{\\odot} = 1.988 \\times 10^{30}\\,\\mathrm{kg}$，因此 $M_{\\mathrm{BH}}$ 必须以 $\\mathrm{kg}$ 为单位使用。\n- 每次踢动的动量大小：$p_0 = 2.0 \\times 10^{38}\\,\\mathrm{kg\\, m\\, s^{-1}}$，对于所有踢动和所有试验均相同。\n- 角度必须以弧度为单位。\n- 伪随机数生成器必须用种子 $12345$ 初始化一次。\n\n对于每个测试用例中的每次试验：\n1. 根据指定的方向分布（各向同性或半张角为 $\\theta_0$ 的双锥分布），采样 $K$ 个单位矢量 $\\{\\hat{\\mathbf{n}}_k\\}_{k=1}^{K}$。\n2. 计算净动量 $\\mathbf{P} \\equiv \\sum_{k=1}^{K} p_0 \\hat{\\mathbf{n}}_k$。\n3. 计算漂移速率 $v \\equiv \\|\\mathbf{P}\\| / M_{\\mathrm{BH}}$，单位为 $\\mathrm{m\\, s^{-1}}$。\n\n然后计算 $T$ 次试验的样本均值 $\\langle v \\rangle$。所有输出均以 $\\mathrm{m\\, s^{-1}}$ 为单位报告，并四舍五入到三位小数。\n\n测试套件（每个用例指定为 $(\\text{分布}, \\theta_0, K, T)$）：\n- 用例 1：$(\\text{各向同性},\\, \\text{不适用},\\, K = 1,\\, T = 4096)$。\n- 用例 2：$(\\text{各向同性},\\, \\text{不适用},\\, K = 1000,\\, T = 4096)$。\n- 用例 3：$(\\text{双锥},\\, \\theta_0 = \\pi/4,\\, K = 1000,\\, T = 4096)$。\n- 用例 4：$(\\text{双锥},\\, \\theta_0 = \\pi/12,\\, K = 1000,\\, T = 4096)$。\n- 用例 5：$(\\text{双锥},\\, \\theta_0 = 0,\\, K = 1000,\\, T = 4096)$。\n- 用例 6：$(\\text{双锥},\\, \\theta_0 = \\pi/2,\\, K = 1000,\\, T = 4096)$。\n\n关于边缘和边界条件的说明：\n- 对于 $K = 1$，每个单位矢量的大小为 $1$，因此每次试验的漂移速率等于 $p_0/M_{\\mathrm{BH}}$，与方向无关，因此样本均值应集中在 $p_0/M_{\\mathrm{BH}}$ 附近。\n- 对于 $\\theta_0 = 0$，双锥坍缩成沿 $\\pm \\hat{\\mathbf{z}}$ 方向的束状射流，因此每次踢动都精确地沿着 $\\pm \\hat{\\mathbf{z}}$ 方向，净动量大小为 $p_0\\,|\\Delta N|$，其中 $\\Delta N$ 是两个相反方向上的计数之差。\n- 对于 $\\theta_0 = \\pi/2$，双锥覆盖整个球面（至多相差一个测度为零的集合），从而再现了各向同性。\n\n您的程序应生成单行输出，其中包含按上述用例顺序排列的六个样本均值的结果，形式为逗号分隔的列表，并用方括号括起来，例如：$[x_1,x_2,x_3,x_4,x_5,x_6]$，其中每个 $x_i$ 是一个以 $\\mathrm{m\\, s^{-1}}$ 为单位的浮点数。", "solution": "我们从动量守恒出发，它意味着黑洞获得的反冲动量是施加给气体的总动量的负值。如果质量为 $M_{\\mathrm{BH}}$ 的黑洞受到 $K$ 次踢动 $\\{\\mathbf{p}_k\\}_{k=1}^{K}$，每次大小为 $p_0$，方向为 $\\hat{\\mathbf{n}}_k$，那么气体的净动量为 $\\mathbf{P} \\equiv \\sum_{k=1}^{K} \\mathbf{p}_k = p_0 \\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k$，反冲速度为 $\\mathbf{v} = -\\mathbf{P}/M_{\\mathrm{BH}}$。单次实现的伪净漂移速率为 $v \\equiv \\|\\mathbf{P}\\|/M_{\\mathrm{BH}}$。大小 $\\|\\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k\\|$ 的行为类似于三维随机游走，因此其标度为 $\\mathcal{O}(\\sqrt{K})$，其中的常数取决于方向分布。\n\n方向采样源于立体角内的均匀采样。球坐标系中的一个方向 $(\\theta, \\phi)$ 映射到单位矢量 $\\hat{\\mathbf{n}} = (\\sin\\theta \\cos\\phi, \\sin\\theta \\sin\\phi, \\cos\\theta)$，其中 $\\phi \\in [0,2\\pi)$ 且 $\\theta \\in [0,\\pi]$。单位球面上的面元为 $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$。在 $d\\Omega$ 上的均匀性意味着 $\\phi$ 在 $[0,2\\pi)$ 上均匀分布，而 $\\mu \\equiv \\cos\\theta$ 在 $[-1,1]$ 上均匀分布。因此，对于各向同性情况，我们采样 $\\phi \\sim \\mathrm{Uniform}(0,2\\pi)$ 和 $\\mu \\sim \\mathrm{Uniform}(-1,1)$，然后设置 $\\hat{\\mathbf{n}} = (\\sqrt{1-\\mu^2}\\cos\\phi, \\sqrt{1-\\mu^2}\\sin\\phi, \\mu)$。\n\n对于半张角为 $\\theta_0$ 的双锥情况，我们将方向限制在以 $\\pm \\hat{\\mathbf{z}}$ 为中心、半角为 $\\theta_0$ 的两个圆锥的并集内。每个圆锥内的立体角均匀性意味着 $\\mu' \\equiv \\cos\\theta' \\sim \\mathrm{Uniform}(\\cos\\theta_0, 1)$，其中 $\\theta'$ 是相对于相应锥轴的极角。以相等的概率选择前向或后向圆锥，相对于全局 $\\hat{\\mathbf{z}}$ 轴的带符号余弦为 $\\mu = s\\,\\mu'$，其中 $s \\in \\{+1,-1\\}$。方位角 $\\phi$ 仍然是 $\\mathrm{Uniform}(0,2\\pi)$。最终的单位矢量同样是 $\\hat{\\mathbf{n}} = (\\sqrt{1-\\mu^2}\\cos\\phi, \\sqrt{1-\\mu^2}\\sin\\phi, \\mu)$。根据构造，这种采样保证了双锥内 $d\\Omega$ 的均匀性。\n\n给定 $M_{\\mathrm{BH}}$（单位 $\\mathrm{kg}$）和 $p_0$（单位 $\\mathrm{kg\\, m\\, s^{-1}}$），漂移速率 $v$ 的单位是 $\\mathrm{m\\, s^{-1}}$。对于有 $K$ 次踢动的单次试验，我们计算：\n$$\n\\mathbf{P} = p_0 \\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k, \\quad v = \\frac{\\|\\mathbf{P}\\|}{M_{\\mathrm{BH}}}.\n$$\n为了估算由有限样本不对称性引起的伪漂移，我们计算 $T$ 次独立试验的样本均值 $\\langle v \\rangle$。使用固定的种子可确保蒙特卡洛估计的可复现性。\n\n标度预期和边缘情况：\n- 对于各向同性方向，$\\hat{\\mathbf{n}}$ 的每个笛卡尔分量的均值为 $0$，方差为 $1/3$。根据中心极限定理，和 $\\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k$ 趋近于一个零均值、分量方差为 $K/3$ 的三维正态分布。其大小的分布近似为参数为 $\\sigma = \\sqrt{K/3}$ 的麦克斯韦分布，期望大小为 $E[\\|\\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k\\|] \\approx 2\\sigma \\sqrt{2/\\pi} = 2\\sqrt{2K/(3\\pi)}$。因此 $E[v] \\approx \\left(2\\sqrt{2K/(3\\pi)}\\right) p_0/M_{\\mathrm{BH}}$，这验证了 $\\sqrt{K}$ 标度关系。\n- 对于 $\\theta_0 = 0$ 的束状射流双锥，每次踢动都精确地沿着 $\\pm \\hat{\\mathbf{z}}$ 方向。那么净大小简化为 $p_0 |\\Delta N|$，其中 $\\Delta N$ 是两个方向上计数之差。当 $N_+ \\sim \\mathrm{Binomial}(K, 1/2)$ 时，我们有 $\\Delta N = 2N_+ - K$，这是一个方差为 $K$ 的离散对称随机变量。当 $K \\to \\infty$ 时，其绝对均值满足 $E[|\\Delta N|] \\sim \\sqrt{2K/\\pi}$，因此 $E[v] \\sim \\left(\\sqrt{2K/\\pi}\\right)p_0/M_{\\mathrm{BH}}$，这再次显示了 $\\sqrt{K}$ 标度关系，但具有不同的前置因子。\n- 对于 $\\theta_0 = \\pi/2$，双锥跨越整个球面（在赤道上至多相差一个测度为零的集合），这再现了各向同性情况，因此具有相同的期望值。\n- 对于 $K=1$，不论方向分布如何，每次试验的漂移都等于 $p_0/M_{\\mathrm{BH}}$，因为 $\\|\\hat{\\mathbf{n}}_1\\| = 1$，所以样本均值会集中在该值附近。\n\n算法设计：\n1. 用种子 $12345$ 初始化一个伪随机数生成器。\n2. 对每个测试用例：\n   - 对每次试验 $t \\in \\{1, \\dots, T\\}$，根据指定的分布（各向同性或双锥），抽取 $K$ 个方位角 $\\phi_k$ 和余弦值 $\\mu_k$，并将它们转换为单位矢量 $\\hat{\\mathbf{n}}_k$。\n   - 计算 $\\mathbf{P}_t = p_0 \\sum_{k=1}^{K} \\hat{\\mathbf{n}}_k$ 和 $v_t = \\|\\mathbf{P}_t\\|/M_{\\mathrm{BH}}$。\n   - 累积平均值 $\\langle v \\rangle = \\frac{1}{T}\\sum_{t=1}^{T} v_t$。\n3. 按测试套件的顺序输出六个均值。\n4. 所有速度必须以 $\\mathrm{m\\, s^{-1}}$ 为单位报告，并四舍五入到三位小数。\n5. 最终输出必须是单行，形式为用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$。\n\n该方法基于守恒定律和均匀立体角采样，通过蒙特卡洛聚合来估算由有限 $K$ 值的不对称性引起的预期伪漂移。双锥用例探究了方向各向异性如何调制 $\\sqrt{K}$ 标度关系的前置因子，并揭示了净漂移对两个锥体间不对称采样的敏感性。边界情况（$K=1$, $\\theta_0=0$, and $\\theta_0=\\pi/2$）为正确性和数值稳定性提供了检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_mean_drift(distribution, theta0, K, T, rng, p0, MBH):\n    \"\"\"\n    Simulate T trials of K momentum kicks of fixed magnitude p0,\n    for a given directional distribution, and return the mean drift speed in m/s.\n    \"\"\"\n    # Draw azimuthal angles uniformly in [0, 2*pi)\n    phi = rng.uniform(0.0, 2.0 * np.pi, size=(T, K))\n\n    if distribution == \"isotropic\":\n        # cos(theta) uniform in [-1, 1]\n        mu = rng.uniform(-1.0, 1.0, size=(T, K))\n    elif distribution == \"bicone\":\n        # Two opposite cones of half-opening angle theta0, chosen with equal probability\n        # Sample |cos(theta)| uniformly in [cos(theta0), 1], then apply random sign\n        cos_min = np.cos(theta0)\n        # Handle tiny numerical negatives if theta0 slightly > pi/2 from rounding\n        cos_min = np.clip(cos_min, -1.0, 1.0)\n        mu_abs = rng.uniform(cos_min, 1.0, size=(T, K))\n        # Random signs +/- 1 with equal probability\n        signs = rng.integers(0, 2, size=(T, K)) * 2 - 1\n        mu = signs * mu_abs\n    else:\n        raise ValueError(\"Unknown distribution\")\n\n    # Convert spherical to Cartesian unit vectors\n    sin_theta = np.sqrt(np.maximum(0.0, 1.0 - mu**2))\n    cos_phi = np.cos(phi)\n    sin_phi = np.sin(phi)\n\n    x = sin_theta * cos_phi\n    y = sin_theta * sin_phi\n    z = mu\n\n    # Sum over K kicks for each trial\n    sum_x = np.sum(x, axis=1)\n    sum_y = np.sum(y, axis=1)\n    sum_z = np.sum(z, axis=1)\n\n    # Net momentum vectors per trial\n    P_x = p0 * sum_x\n    P_y = p0 * sum_y\n    P_z = p0 * sum_z\n\n    # Drift speeds per trial: |P| / MBH\n    v = np.sqrt(P_x**2 + P_y**2 + P_z**2) / MBH\n\n    # Return mean drift speed\n    return float(np.mean(v))\n\ndef solve():\n    # Physical constants and parameters\n    Msun = 1.988e30  # kg\n    MBH = 1.0e9 * Msun  # kg\n    p0 = 2.0e38  # kg m / s\n\n    # Fixed RNG seed for reproducibility\n    rng = np.random.default_rng(12345)\n\n    # Test cases: (distribution, theta0 [radians or None], K, T)\n    test_cases = [\n        (\"isotropic\", None, 1, 4096),\n        (\"isotropic\", None, 1000, 4096),\n        (\"bicone\", np.pi/4.0, 1000, 4096),\n        (\"bicone\", np.pi/12.0, 1000, 4096),\n        (\"bicone\", 0.0, 1000, 4096),\n        (\"bicone\", np.pi/2.0, 1000, 4096),\n    ]\n\n    results = []\n    for dist, theta0, K, T in test_cases:\n        theta = 0.0 if theta0 is None else theta0\n        mean_v = simulate_mean_drift(dist, theta, K, T, rng, p0, MBH)\n        # Round to three decimal places for output formatting\n        results.append(f\"{mean_v:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3537631"}]}