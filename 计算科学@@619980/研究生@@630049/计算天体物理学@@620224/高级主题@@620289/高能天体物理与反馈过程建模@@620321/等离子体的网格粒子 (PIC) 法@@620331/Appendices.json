{"hands_on_practices": [{"introduction": "在开始任何等离子体模拟之前，首要步骤是将控制物理过程的方程（如麦克斯韦-洛伦兹系统）转换为无量纲形式。这个过程被称为归一化，它不仅能简化方程、减少自由参数的数量，还能使数值实现更加稳定和通用。本练习 [@problem_id:3529057] 将指导您完成这一基本但至关重要的理论推导，通过选择等离子体自身的特征尺度（如等离子体频率 $\\omega_p$ 和德拜长度 $\\lambda_D$），您将亲身体验物理洞察力如何指导数值方案的设计。", "problem": "将使用质点网格 (PIC) 方法模拟无碰撞电子离子等离子体，其中质点网格 (PIC) 法指的是在空间网格上求解麦克斯韦方程组的同时，根据电磁场推进带电宏观粒子的标准方法。考虑均匀的背景电子数密度 $n_0$ 和电子温度 $T_e$。定义电子等离子体频率为 $\\omega_p^2 = n_0 q^2/(m_e \\epsilon_0)$，其中 $q$ 表示电子电荷的大小，$m_e$ 是电子质量，$\\epsilon_0$ 是真空介电常数。定义电子热速度 $v_{\\mathrm{th}} = \\sqrt{k_B T_e/m_e}$（其中 $k_B$ 是玻尔兹曼常数），以及电子德拜长度 $\\lambda_D = v_{\\mathrm{th}}/\\omega_p$。令 $c$ 为光速。\n\n你需要对 PIC 中使用的麦克斯韦-洛伦兹系统进行无量纲化，选择时间单位为 $\\omega_p^{-1}$，长度单位为 $\\lambda_D$，电场单位为 $E_0 = m_e c \\omega_p/|q|$，磁场单位为 $B_0 = m_e \\omega_p/|q|$。在这些选择下，隐含的速度单位是 $v_{\\mathrm{th}} = \\lambda_D \\omega_p$。用 $\\rho_0 = n_0 |q|$ 归一化电荷密度，用 $J_0 = n_0 |q| v_{\\mathrm{th}}$ 归一化电流密度。定义无量纲变量 $t' = \\omega_p t$、$\\boldsymbol{x}' = \\boldsymbol{x}/\\lambda_D$、$\\boldsymbol{E}' = \\boldsymbol{E}/E_0$、$\\boldsymbol{B}' = \\boldsymbol{B}/B_0$、$\\boldsymbol{v}' = \\boldsymbol{v}/v_{\\mathrm{th}}$、$\\rho' = \\rho/\\rho_0$ 和 $\\boldsymbol{J}' = \\boldsymbol{J}/J_0$。令 $C = c/v_{\\mathrm{th}}$ 表示无量纲光速。\n\n从电子的洛伦兹力定律 $m_e \\, d\\boldsymbol{v}/dt = q_e \\left(\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}\\right)$（其中 $q_e = -|q|$）和真空中的麦克斯韦方程组，即 $\\partial \\boldsymbol{B}/\\partial t = -\\nabla \\times \\boldsymbol{E}$、$\\partial \\boldsymbol{E}/\\partial t = c^2 \\nabla \\times \\boldsymbol{B} - \\boldsymbol{J}/\\epsilon_0$、$\\nabla \\cdot \\boldsymbol{E} = \\rho/\\epsilon_0$ 和 $\\nabla \\cdot \\boldsymbol{B} = 0$ 出发，使用上述尺度仔细进行无量纲化。然后，根据得到的无量纲系统，确定下面哪个陈述与此归一化一致。\n\nA. 在这些归一化下，无量纲的电子运动方程为 $d\\boldsymbol{v}'/dt' = -\\left(\\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}'\\right)$，即电场项和磁场项都带有单位系数，并且没有显式的因子 $C$。\n\nB. 在这些归一化下，无量纲的安培-麦克斯韦定律可以写成 $\\partial \\boldsymbol{E}'/\\partial t' = C \\, \\nabla' \\times \\boldsymbol{B}' - (1/C) \\, \\boldsymbol{J}'$，其中 $C = c/v_{\\mathrm{th}}$ 且 $\\boldsymbol{J}' = \\boldsymbol{J}/(n_0 |q| v_{\\mathrm{th}})$。\n\nC. 在这些归一化下，显式时域有限差分场求解器的稳定性约束（Courant–Friedrichs–Lewy 条件）的无量纲形式为 $\\Delta t' \\leq 1$，与 $C$ 和无量纲网格间距无关。\n\nD. 在这些归一化下，高斯定律变为 $\\nabla' \\cdot \\boldsymbol{E}' = \\rho'$，即归一化场散度与归一化电荷密度之间没有前置因子。\n\nE. 在非相对论极限下，并使用归一化动量 $\\boldsymbol{u}' = \\boldsymbol{p}/(m_e v_{\\mathrm{th}})$，归一化的电子运动方程为 $d\\boldsymbol{u}'/dt' = -\\left(C \\, \\boldsymbol{E}' + C \\, \\boldsymbol{v}' \\times \\boldsymbol{B}'\\right)$，即因子 $C$ 同等地乘以电场项和磁场项。", "solution": "问题陈述已经过验证，被认为是科学上正确、提法得当且无矛盾的。它提出了一个对麦克斯韦-洛伦兹系统进行无量纲化的标准练习，这是计算等离子体物理学中的一个基本步骤。所有给出的定义和尺度都是标准的且内部一致的。\n\n我们现在将按照问题陈述中的规定，对控制方程进行无量纲化。物理（有量纲）变量与无量纲（带撇号）变量的关系如下：\n-   时间: $t = t'/\\omega_p$\n-   位置: $\\boldsymbol{x} = \\lambda_D \\boldsymbol{x}'$\n-   速度: $\\boldsymbol{v} = v_{\\mathrm{th}} \\boldsymbol{v}'$\n-   电场: $\\boldsymbol{E} = E_0 \\boldsymbol{E}' = (m_e c \\omega_p/|q|) \\boldsymbol{E}'$\n-   磁场: $\\boldsymbol{B} = B_0 \\boldsymbol{B}' = (m_e \\omega_p/|q|) \\boldsymbol{B}'$\n-   电荷密度: $\\rho = \\rho_0 \\rho' = (n_0 |q|) \\rho'$\n-   电流密度: $\\boldsymbol{J} = J_0 \\boldsymbol{J}' = (n_0 |q| v_{\\mathrm{th}}) \\boldsymbol{J}'$\n\n微分算符变换如下：\n-   时间导数: $\\frac{d}{dt} = \\frac{dt'}{dt} \\frac{d}{dt'} = \\omega_p \\frac{d}{dt'}$\n-   梯度算符: $\\nabla = \\frac{\\partial}{\\partial \\boldsymbol{x}} = \\frac{1}{\\lambda_D} \\nabla'$\n\n我们现在将变换每个控制方程。\n\n**1. 电子的洛伦兹力定律**\n\n起始方程为：\n$$m_e \\frac{d\\boldsymbol{v}}{dt} = q_e (\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B})$$\n使用 $q_e = -|q|$ 并代入归一化变量：\n$$m_e \\left(\\omega_p \\frac{d}{dt'}\\right) (v_{\\mathrm{th}} \\boldsymbol{v}') = -|q| \\left(E_0 \\boldsymbol{E}' + (v_{\\mathrm{th}} \\boldsymbol{v}') \\times (B_0 \\boldsymbol{B}')\\right)$$\n$$m_e \\omega_p v_{\\mathrm{th}} \\frac{d\\boldsymbol{v}'}{dt'} = -|q| \\left( E_0 \\boldsymbol{E}' + v_{\\mathrm{th}} B_0 (\\boldsymbol{v}' \\times \\boldsymbol{B}') \\right)$$\n现在，代入归一化常数 $E_0 = m_e c \\omega_p/|q|$ 和 $B_0 = m_e \\omega_p/|q|$ 的定义：\n$$m_e \\omega_p v_{\\mathrm{th}} \\frac{d\\boldsymbol{v}'}{dt'} = -|q| \\left( \\frac{m_e c \\omega_p}{|q|} \\boldsymbol{E}' + v_{\\mathrm{th}} \\frac{m_e \\omega_p}{|q|} (\\boldsymbol{v}' \\times \\boldsymbol{B}') \\right)$$\n提取右侧的公因式：\n$$m_e \\omega_p v_{\\mathrm{th}} \\frac{d\\boldsymbol{v}'}{dt'} = -m_e \\omega_p \\left( c \\boldsymbol{E}' + v_{\\mathrm{th}} (\\boldsymbol{v}' \\times \\boldsymbol{B}') \\right)$$\n两边同除以 $m_e \\omega_p v_{\\mathrm{th}}$ 得到无量纲方程：\n$$\\frac{d\\boldsymbol{v}'}{dt'} = - \\frac{1}{v_{\\mathrm{th}}} \\left( c \\boldsymbol{E}' + v_{\\mathrm{th}} (\\boldsymbol{v}' \\times \\boldsymbol{B}') \\right)$$\n$$\\frac{d\\boldsymbol{v}'}{dt'} = - \\left( \\frac{c}{v_{\\mathrm{th}}} \\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}' \\right)$$\n使用定义 $C = c/v_{\\mathrm{th}}$:\n$$\\frac{d\\boldsymbol{v}'}{dt'} = - \\left( C \\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}' \\right)$$\n\n**2. 安培-麦克斯韦定律**\n\n起始方程为：\n$$\\frac{\\partial \\boldsymbol{E}}{\\partial t} = c^2 \\nabla \\times \\boldsymbol{B} - \\frac{\\boldsymbol{J}}{\\epsilon_0}$$\n代入归一化变量和算符：\n$$\\omega_p \\frac{\\partial (E_0 \\boldsymbol{E}')}{\\partial t'} = c^2 \\left(\\frac{1}{\\lambda_D} \\nabla'\\right) \\times (B_0 \\boldsymbol{B}') - \\frac{J_0 \\boldsymbol{J}'}{\\epsilon_0}$$\n$$\\omega_p E_0 \\frac{\\partial \\boldsymbol{E}'}{\\partial t'} = \\frac{c^2 B_0}{\\lambda_D} \\nabla' \\times \\boldsymbol{B}' - \\frac{J_0}{\\epsilon_0} \\boldsymbol{J}'$$\n除以 $\\omega_p E_0$ 以分离出 $\\partial \\boldsymbol{E}'/\\partial t'$：\n$$\\frac{\\partial \\boldsymbol{E}'}{\\partial t'} = \\left(\\frac{c^2 B_0}{\\omega_p \\lambda_D E_0}\\right) \\nabla' \\times \\boldsymbol{B}' - \\left(\\frac{J_0}{\\omega_p E_0 \\epsilon_0}\\right) \\boldsymbol{J}'$$\n现在，我们计算这两个系数。\n对于第一个系数，代入 $E_0 = c B_0$ 和 $\\lambda_D = v_{\\mathrm{th}}/\\omega_p$：\n$$\\frac{c^2 B_0}{\\omega_p \\lambda_D E_0} = \\frac{c^2 B_0}{\\omega_p (v_{\\mathrm{th}}/\\omega_p) (c B_0)} = \\frac{c^2}{c v_{\\mathrm{th}}} = \\frac{c}{v_{\\mathrm{th}}} = C$$\n对于第二个系数，代入 $J_0 = n_0 |q| v_{\\mathrm{th}}$，$E_0 = m_e c \\omega_p / |q|$，并使用等离子体频率的定义 $\\omega_p^2 = n_0 q^2/(m_e \\epsilon_0)$：\n$$\\frac{J_0}{\\omega_p E_0 \\epsilon_0} = \\frac{n_0 |q| v_{\\mathrm{th}}}{\\omega_p (m_e c \\omega_p / |q|) \\epsilon_0} = \\frac{n_0 |q|^2 v_{\\mathrm{th}}}{m_e \\epsilon_0 c \\omega_p^2} = \\left(\\frac{n_0 q^2}{m_e \\epsilon_0}\\right) \\frac{v_{\\mathrm{th}}}{c \\omega_p^2} = \\omega_p^2 \\frac{v_{\\mathrm{th}}}{c \\omega_p^2} = \\frac{v_{\\mathrm{th}}}{c} = \\frac{1}{C}$$\n得到的无量纲安培-麦克斯韦定律是：\n$$\\frac{\\partial \\boldsymbol{E}'}{\\partial t'} = C \\nabla' \\times \\boldsymbol{B}' - \\frac{1}{C} \\boldsymbol{J}'$$\n\n**3. 电场高斯定律**\n\n起始方程为 $\\nabla \\cdot \\boldsymbol{E} = \\rho/\\epsilon_0$。\n$$\\left(\\frac{1}{\\lambda_D}\\nabla'\\right) \\cdot (E_0 \\boldsymbol{E}') = \\frac{\\rho_0 \\rho'}{\\epsilon_0}$$\n$$\\frac{E_0}{\\lambda_D} \\nabla' \\cdot \\boldsymbol{E}' = \\frac{\\rho_0}{\\epsilon_0} \\rho'$$\n$$\\nabla' \\cdot \\boldsymbol{E}' = \\left(\\frac{\\lambda_D \\rho_0}{E_0 \\epsilon_0}\\right) \\rho'$$\n系数为 $\\frac{\\lambda_D \\rho_0}{E_0 \\epsilon_0}$。这可以与安培定律中电流项的系数联系起来。注意 $\\lambda_D \\rho_0 = (v_{\\mathrm{th}}/\\omega_p) J_0/v_{\\mathrm{th}} = J_0/\\omega_p$。\n所以系数为 $\\frac{J_0/\\omega_p}{E_0 \\epsilon_0} = \\frac{J_0}{\\omega_p E_0 \\epsilon_0}$，我们已经计算出其值为 $1/C$。\n因此，高斯定律变为：\n$$\\nabla' \\cdot \\boldsymbol{E}' = \\frac{1}{C} \\rho'$$\n\n现在我们来评估每个选项。\n\n**A. 在这些归一化下，无量纲的电子运动方程为 $d\\boldsymbol{v}'/dt' = -\\left(\\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}'\\right)$，即电场项和磁场项都带有单位系数，并且没有显式的因子 $C$。**\n\n我们推导出的运动方程是 $\\frac{d\\boldsymbol{v}'}{dt'} = - \\left( C \\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}' \\right)$。电场项 $\\boldsymbol{E}'$ 乘以一个因子 $C = c/v_{\\mathrm{th}}$，而不是 $1$。\n**结论：不正确。**\n\n**B. 在这些归一化下，无量纲的安培-麦克斯韦定律可以写成 $\\partial \\boldsymbol{E}'/\\partial t' = C \\, \\nabla' \\times \\boldsymbol{B}' - (1/C) \\, \\boldsymbol{J}'$，其中 $C = c/v_{\\mathrm{th}}$ 且 $\\boldsymbol{J}' = \\boldsymbol{J}/(n_0 |q| v_{\\mathrm{th}})$。**\n\n我们推导出的无量纲安培-麦克斯韦定律是 $\\frac{\\partial \\boldsymbol{E}'}{\\partial t'} = C \\nabla' \\times \\boldsymbol{B}' - \\frac{1}{C} \\boldsymbol{J}'$。这与选项中的陈述完全匹配。所提供的 $C$ 和 $\\boldsymbol{J}'$ 的定义与问题陈述中的定义一致。\n**结论：正确。**\n\n**C. 在这些归一化下，显式时域有限差分场求解器的稳定性约束（Courant–Friedrichs–Lewy 条件）的无量纲形式为 $\\Delta t' \\leq 1$，与 $C$ 和无量纲网格间距无关。**\n\nCFL 条件限制了数值传播速度必须小于或等于物理波的传播速度。对于麦克斯韦方程组，最大速度是光速 $c$。该条件是 $c \\Delta t \\leq \\Delta s$，其中 $\\Delta s$ 是特征网格间距。在无量纲单位中，$\\Delta t = \\Delta t'/\\omega_p$ 且 $\\Delta s = \\lambda_D \\Delta s'$。\n$$c \\frac{\\Delta t'}{\\omega_p} \\leq \\lambda_D \\Delta s'$$\n$$\\Delta t' \\leq \\frac{\\omega_p \\lambda_D}{c} \\Delta s'$$\n代入 $\\lambda_D = v_{\\mathrm{th}}/\\omega_p$:\n$$\\Delta t' \\leq \\frac{\\omega_p (v_{\\mathrm{th}}/\\omega_p)}{c} \\Delta s' = \\frac{v_{\\mathrm{th}}}{c} \\Delta s' = \\frac{1}{C} \\Delta s'$$\n无量纲的稳定性约束是 $\\Delta t' \\leq \\Delta s'/C$。该条件同时依赖于无量纲网格间距 $\\Delta s'$ 和参数 $C$。因此该陈述是错误的。\n**结论：不正确。**\n\n**D. 在这些归一化下，高斯定律变为 $\\nabla' \\cdot \\boldsymbol{E}' = \\rho'$，即归一化场散度与归一化电荷密度之间没有前置因子。**\n\n我们推导出的无量纲高斯定律是 $\\nabla' \\cdot \\boldsymbol{E}' = \\frac{1}{C} \\rho'$。有一个 $1/C$ 的前置因子。该陈述是错误的。\n**结论：不正确。**\n\n**E. 在非相对论极限下，并使用归一化动量 $\\boldsymbol{u}' = \\boldsymbol{p}/(m_e v_{\\mathrm{th}})$，归一化的电子运动方程为 $d\\boldsymbol{u}'/dt' = -\\left(C \\, \\boldsymbol{E}' + C \\, \\boldsymbol{v}' \\times \\boldsymbol{B}'\\right)$，即因子 $C$ 同等地乘以电场项和磁场项。**\n\n在非相对论极限下，动量为 $\\boldsymbol{p} = m_e \\boldsymbol{v}$。归一化动量为 $\\boldsymbol{u}' = \\boldsymbol{p}/(m_e v_{\\mathrm{th}}) = (m_e \\boldsymbol{v})/(m_e v_{\\mathrm{th}}) = \\boldsymbol{v}/v_{\\mathrm{th}} = \\boldsymbol{v}'$。因此，$d\\boldsymbol{u}'/dt' = d\\boldsymbol{v}'/dt'$。运动方程与 $\\boldsymbol{v}'$ 的相同：\n$$\\frac{d\\boldsymbol{u}'}{dt'} = - \\left( C \\boldsymbol{E}' + \\boldsymbol{v}' \\times \\boldsymbol{B}' \\right)$$\n陈述声称磁场项是 $-\\left(C \\, \\boldsymbol{v}' \\times \\boldsymbol{B}'\\right)$，但我们的推导表明其系数是 $-1$。因此，因子 $C$ 并不同等地乘以这两项。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "3529057"}, {"introduction": "在PIC方法中，带电粒子在连续空间中运动，而电磁场则定义在离散的网格上。连接这两个世界的桥梁是“形函数”，它负责将粒子携带的电荷和电流分配到周围的网格点上。本练习 [@problem_id:3529046] 深入探讨了这一核心过程的数值后果，特别是由于网格的离散采样而产生的“混叠”效应。通过在傅里叶空间中分析不同阶数形函数的特性，您将定量地理解高阶形函数（如TSC）如何比低阶形函数（如CIC）更有效地抑制非物理的数值噪声。", "problem": "考虑一个一维“盒中粒子”(Particle-In-Cell, PIC) 方法中的密度分配问题。该分配将一个具有平均密度、空间均匀的泊松粒子分布，映射到一个间距为 $\\Delta x$ 的均匀网格上。设粒子到网格的分配使用 $m$ 阶基本B样条形状函数，该函数由 $m+1$ 个宽度为 $\\Delta x$ 的相同单位面积顶帽函数卷积而成。用 $S_{m}(k)$ 表示该分配形状的傅里叶变换（根据惯例，实空间中的卷积对应于傅里叶空间中的乘积），并将其归一化以满足 $S_{m}(0)=1$。网格的离散采样会产生频谱混叠：在可分辨波数 $k$ 处，预期的散粒噪声对分配的网格密度功率谱的贡献，正比于对所有整数混叠 $p \\in \\mathbb{Z}$ 的 $\\left|S_{m}\\!\\left(k + \\frac{2\\pi p}{\\Delta x}\\right)\\right|^{2}$ 之和。\n\n仅从以上定义出发，利用卷积定理和单位面积顶帽函数的基本傅里叶性质，完成以下任务：\n\n1) 推导 $S_{m}(k)$ 关于 $k$ 和 $\\Delta x$ 的闭式表达式。\n\n2) 使用第 (1) 部分的结果，并假设只有第一对混叠（$p=\\pm 1$）对混叠功率有显著贡献，将模式 $k$ 处的第一混叠功率定义为\n$$\nA_{m}^{(1)}(k) \\propto \\left|S_{m}\\!\\left(k + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{m}\\!\\left(k - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}.\n$$\n计算无量纲比值\n$$\nR \\equiv \\frac{A_{1}^{(1)}(k_{N}/2)}{A_{2}^{(1)}(k_{N}/2)},\n$$\n其中 $k_{N} \\equiv \\pi/\\Delta x$ 是奈奎斯特波数，$m=1$ 对应于 Cloud-In-Cell (CIC)，而 $m=2$ 对应于 Triangular-Shaped Cloud (TSC)。\n\n将 $R$ 的最终答案表示为一个纯数，并四舍五入到四位有效数字。$R$ 无需单位。", "solution": "此问题已经过验证，是计算天体物理学中一个良定的、有科学依据的问题。我们将给出完整的解答。\n\n问题分为两部分。首先，我们必须推导出 $m$ 阶基本B样条形状函数（记为 $S_m(k)$）的傅里叶变换的闭式表达式。其次，我们必须利用此结果计算两种不同样条阶数的混叠功率的特定比值 $R$。\n\n### 第1部分：推导 $S_m(k)$\n\n$m$ 阶基本B样条形状函数（我们称之为 $W_m(x)$）被定义为 $m+1$ 个宽度为 $\\Delta x$ 的相同单位面积顶帽函数的卷积。我们将中心化的顶帽函数 $\\Pi(x)$ 定义为：\n$$\n\\Pi(x) =\n\\begin{cases}\n    \\frac{1}{\\Delta x}  \\text{若 } |x| \\le \\frac{\\Delta x}{2} \\\\\n    0  \\text{其他情况}\n\\end{cases}\n$$\n根据定义，$\\Pi(x)$ 下的面积为 $\\int_{-\\infty}^{\\infty} \\Pi(x) dx = \\frac{1}{\\Delta x} \\times \\Delta x = 1$。\n\n形状函数 $W_m(x)$ 是 $\\Pi(x)$ 与其自身的 $(m+1)$ 重卷积：\n$$\nW_m(x) = \\underbrace{(\\Pi * \\Pi * \\dots * \\Pi)(x)}_{m+1 \\text{ 次}}\n$$\n其中 $*$ 表示卷积算子。\n\n问题要求解 $S_m(k)$，即 $W_m(x)$ 的傅里叶变换。我们利用卷积定理，该定理指出，函数卷积的傅里叶变换是它们各自傅里叶变换的乘积。设 $\\hat{\\Pi}(k)$ 是 $\\Pi(x)$ 的傅里叶变换。那么，\n$$\nS_m(k) = \\mathcal{F}[W_m(x)](k) = \\left( \\mathcal{F}[\\Pi(x)](k) \\right)^{m+1} = (\\hat{\\Pi}(k))^{m+1}\n$$\n我们使用傅里叶变换的定义 $\\mathcal{F}[f(x)](k) = \\int_{-\\infty}^{\\infty} f(x) e^{-ikx} dx$ 来计算 $\\hat{\\Pi}(k)$：\n$$\n\\hat{\\Pi}(k) = \\int_{-\\infty}^{\\infty} \\Pi(x) e^{-ikx} dx = \\int_{-\\Delta x/2}^{\\Delta x/2} \\frac{1}{\\Delta x} e^{-ikx} dx\n$$\n$$\n\\hat{\\Pi}(k) = \\frac{1}{\\Delta x} \\left[ \\frac{e^{-ikx}}{-ik} \\right]_{-\\Delta x/2}^{\\Delta x/2} = \\frac{1}{-ik\\Delta x} \\left( e^{-ik\\Delta x/2} - e^{ik\\Delta x/2} \\right)\n$$\n使用欧拉公式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们得到：\n$$\n\\hat{\\Pi}(k) = \\frac{1}{ik\\Delta x} \\left( e^{ik\\Delta x/2} - e^{-ik\\Delta x/2} \\right) = \\frac{1}{ik\\Delta x} \\left( 2i\\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right) = \\frac{2\\sin(k\\Delta x/2)}{k\\Delta x}\n$$\n这个表达式通常使用归一化的sinc函数 $\\text{sinc}(\\theta) = \\sin(\\theta)/\\theta$ 来书写。因此，\n$$\n\\hat{\\Pi}(k) = \\frac{\\sin(k\\Delta x/2)}{k\\Delta x/2} = \\text{sinc}\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n问题指定了归一化条件 $S_m(0)=1$。我们来验证一下：$\\hat{\\Pi}(0) = \\lim_{k\\to 0} \\text{sinc}(k\\Delta x/2) = 1$。因此，$S_m(0) = (\\hat{\\Pi}(0))^{m+1} = 1^{m+1} = 1$，这与要求一致。\n\n将 $\\hat{\\Pi}(k)$ 的表达式代回 $S_m(k)$ 的方程，我们得到形状因子的最终闭式表达式：\n$$\nS_m(k) = \\left( \\text{sinc}\\left(\\frac{k\\Delta x}{2}\\right) \\right)^{m+1} = \\left( \\frac{\\sin(k\\Delta x/2)}{k\\Delta x/2} \\right)^{m+1}\n$$\n\n### 第2部分：计算比值 $R$\n\n问题将模式 $k$ 处的第一混叠功率定义为：\n$$\nA_{m}^{(1)}(k) \\propto \\left|S_{m}\\!\\left(k + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{m}\\!\\left(k - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}\n$$\n我们需要计算比值 $R = A_{1}^{(1)}(k_{N}/2) / A_{2}^{(1)}(k_{N}/2)$，其中 $m=1$ 是 CIC，$m=2$ 是 TSC，奈奎斯特波数为 $k_N = \\pi/\\Delta x$。计算所用的波数是 $k = k_N/2 = \\frac{\\pi}{2\\Delta x}$。\n\n由于比值 $R$ 与比例常数无关，我们可以写出：\n$$\nR = \\frac{\\left|S_{1}\\!\\left(\\frac{k_N}{2} + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{1}\\!\\left(\\frac{k_N}{2} - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}}{\\left|S_{2}\\!\\left(\\frac{k_N}{2} + \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2} + \\left|S_{2}\\!\\left(\\frac{k_N}{2} - \\frac{2\\pi}{\\Delta x}\\right)\\right|^{2}}\n$$\n我们来计算 $S_m$ 的自变量。混叠波数为 $k_{\\pm} = \\frac{k_N}{2} \\pm \\frac{2\\pi}{\\Delta x}$。代入 $k_N = \\pi/\\Delta x$，我们有 $\\frac{2\\pi}{\\Delta x} = 2k_N$。\n$$\nk_+ = \\frac{k_N}{2} + 2k_N = \\frac{5}{2}k_N = \\frac{5\\pi}{2\\Delta x}\n$$\n$$\nk_- = \\frac{k_N}{2} - 2k_N = -\\frac{3}{2}k_N = -\\frac{3\\pi}{2\\Delta x}\n$$\n$S_m(k)$ 中sinc函数的自变量是 $\\frac{k\\Delta x}{2}$。对于混叠波数 $k_{\\pm}$，该自变量为：\n$$\n\\frac{k_+\\Delta x}{2} = \\frac{(5\\pi/2\\Delta x)\\Delta x}{2} = \\frac{5\\pi}{4}\n$$\n$$\n\\frac{k_-\\Delta x}{2} = \\frac{(-3\\pi/2\\Delta x)\\Delta x}{2} = -\\frac{3\\pi}{4}\n$$\n现在我们计算sinc函数在这些值处的函数值：\n$$\n\\text{sinc}\\left(\\frac{5\\pi}{4}\\right) = \\frac{\\sin(5\\pi/4)}{5\\pi/4} = \\frac{-1/\\sqrt{2}}{5\\pi/4} = -\\frac{4}{5\\pi\\sqrt{2}}\n$$\n$$\n\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right) = \\frac{\\sin(-3\\pi/4)}{-3\\pi/4} = \\frac{-1/\\sqrt{2}}{-3\\pi/4} = \\frac{4}{3\\pi\\sqrt{2}}\n$$\n由于形状因子 $S_m(k)$ 对于实数自变量是实数，所以 $|S_m(k)|^2 = (S_m(k))^2$。\n对于 $m=1$ (CIC)，$S_1(k) = (\\text{sinc}(\\frac{k\\Delta x}{2}))^2$。混叠功率为：\n$$\nA_1^{(1)}(k_N/2) \\propto \\left|S_1(k_+)\\right|^2 + \\left|S_1(k_-)\\right|^2 = \\left(\\left(\\text{sinc}\\left(\\frac{5\\pi}{4}\\right)\\right)^2\\right)^2 + \\left(\\left(\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right)\\right)^2\\right)^2\n$$\n$$\nA_1^{(1)}(k_N/2) \\propto \\left(-\\frac{4}{5\\pi\\sqrt{2}}\\right)^4 + \\left(\\frac{4}{3\\pi\\sqrt{2}}\\right)^4 = \\left(\\frac{256}{625 \\times 4\\pi^4}\\right) + \\left(\\frac{256}{81 \\times 4\\pi^4}\\right) = \\frac{64}{\\pi^4}\\left(\\frac{1}{625} + \\frac{1}{81}\\right)\n$$\n对于 $m=2$ (TSC)，$S_2(k) = (\\text{sinc}(\\frac{k\\Delta x}{2}))^3$。混叠功率为：\n$$\nA_2^{(1)}(k_N/2) \\propto \\left|S_2(k_+)\\right|^2 + \\left|S_2(k_-)\\right|^2 = \\left(\\left(\\text{sinc}\\left(\\frac{5\\pi}{4}\\right)\\right)^3\\right)^2 + \\left(\\left(\\text{sinc}\\left(-\\frac{3\\pi}{4}\\right)\\right)^3\\right)^2\n$$\n$$\nA_2^{(1)}(k_N/2) \\propto \\left(-\\frac{4}{5\\pi\\sqrt{2}}\\right)^6 + \\left(\\frac{4}{3\\pi\\sqrt{2}}\\right)^6 = \\frac{4096}{8\\pi^6}\\left(\\frac{1}{5^6} + \\frac{1}{3^6}\\right) = \\frac{512}{\\pi^6}\\left(\\frac{1}{15625} + \\frac{1}{729}\\right)\n$$\n现在我们计算比值 $R$：\n$$\nR = \\frac{A_1^{(1)}}{A_2^{(1)}} = \\frac{\\frac{64}{\\pi^4}\\left(\\frac{1}{625} + \\frac{1}{81}\\right)}{\\frac{512}{\\pi^6}\\left(\\frac{1}{15625} + \\frac{1}{729}\\right)} = \\frac{64}{512} \\pi^2 \\frac{\\frac{81+625}{625 \\times 81}}{\\frac{729+15625}{15625 \\times 729}}\n$$\n$$\nR = \\frac{\\pi^2}{8} \\frac{\\frac{706}{50625}}{\\frac{16354}{11390625}} = \\frac{\\pi^2}{8} \\frac{706}{50625} \\frac{11390625}{16354}\n$$\n注意到 $11390625 = 225 \\times 50625$。\n$$\nR = \\frac{\\pi^2}{8} \\frac{706 \\times 225}{16354}\n$$\n简化分数：$706 = 2 \\times 353$ and $16354 = 2 \\times 8177$.\n$$\nR = \\frac{\\pi^2}{8} \\frac{353 \\times 225}{8177}\n$$\n现在我们代入 $\\pi \\approx 3.14159265$ 的数值：\n$$\nR = \\frac{\\pi^2}{8} \\frac{79425}{8177} \\approx \\frac{9.8696044}{8} \\times 9.7132199 \\approx 1.23370055 \\times 9.7132199 \\approx 11.982141\n$$\n四舍五入到四位有效数字，我们得到 $11.98$。", "answer": "$$\n\\boxed{11.98}\n$$", "id": "3529046"}, {"introduction": "标准“显式”PIC模拟在处理高密度等离子体时会遇到严峻的挑战，因为时间步长必须满足苛刻的稳定性条件 $\\omega_p \\Delta t \\lt 2$。为了模拟这类物理系统（如天体物理和聚变研究中的许多场景），我们必须采用“隐式”时间积分方案。本练习 [@problem_id:3529066] 将带您进入高级计算等离子体物理学的核心，通过实现预处理共轭梯度法来求解隐式格式产生的线性方程组。您将直接比较有无“物理预处理器”时算法的收敛速度，从而深刻理解为何高效的求解器是使隐式PIC方法切实可行的关键。", "problem": "考虑一种用于具有周期性边界的冷、单电荷电子等离子体的一维静电隐式网格粒子（Particle-In-Cell）方法。计算目标是在稠密等离子体条件下（即等离子体频率 $ \\omega_p $ 相对于时间步长较大，特别满足 $ \\omega_p \\Delta t \\gg 1 $），将电场从时间步 $n$ 推进到 $n+1$。从基本定律和经过充分检验的公式出发：电子的动量方程、简化到静电条件下的麦克斯韦方程组以及连续性方程。假设存在一个数密度为 $ n_e $ 的冷、均匀电子等离子体，其中包含固定的、用于中和的离子背景，并将研究范围限制在具有周期性边界条件的一维空间 $ x \\in [0,1) $ 内。在整个过程中使用无量纲变量，这样最终的数值答案中就不需要物理单位。\n\n以这些基础为起点，进行时间上向后差分的隐式离散化，以推导出一个用于电场 $ E^{n+1} $ 网格表示的线性、对称正定系统。证明所得到的算子包含一个与单位矩阵成正比、依赖于 $ \\omega_p^2 \\Delta t^2 $ 的局域响应项，以及一个由麦克斯韦方程组产生的、在周期性网格上简化为离散拉普拉斯算子的空间耦合项。将得到的线性系统记为\n$$\n\\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b},\n$$\n其中 $ \\mathbf{A} $ 是一个结合了局域等离子体响应和离散拉普拉斯算子的对称正定矩阵，$ \\mathbf{E}^{n+1} $ 是时间步 $ n+1 $ 时电场的未知网格向量，$ \\mathbf{b} $ 是一个由时间步 $ n $ 的数据和任何外部源确定的已知向量。对迭代求解使用零初始猜测 $ \\mathbf{E}^{(0)} = \\mathbf{0} $。\n\n实现共轭梯度法来求解 $ \\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b} $，并记录每次迭代 $ k $ 的残差范数 $ \\| \\mathbf{r}^{(k)} \\|_2 $，其中 $ \\mathbf{r}^{(k)} = \\mathbf{b} - \\mathbf{A} \\mathbf{E}^{(k)} $。在以下两种情况下分析收敛性：\n1. 不使用任何预条件子。\n2. 使用一个基于物理的预条件子，该预条件子通过忽略空间耦合来模拟局域等离子体响应，即应用在舍弃离散拉普拉斯算子后得到的对角算子的逆。\n\n使用一个在 $ [0,1) $ 上具有周期性边界条件的 $ N $ 个点的均匀网格。在此网格上，离散拉普拉斯算子通过以下方式作用于向量 $ \\mathbf{x} $\n$$\n(D \\mathbf{x})_i = \\mathbf{x}_{i+1} - 2 \\mathbf{x}_i + \\mathbf{x}_{i-1},\n$$\n其中下标对 $ N $ 取模。在推导出的算子 $ \\mathbf{A} $ 中，离散拉普拉斯算子必须由一个非负耦合参数 $ \\lambda $ 进行缩放，该参数表征了由隐式场更新产生的空间耦合强度。从波数为 $ m $ 的单一正弦傅里叶模式构建右端向量 $ \\mathbf{b} $，具体为\n$$\nb_i = \\sin(2 \\pi m x_i), \\quad x_i = \\frac{i}{N}, \\quad i = 0, 1, \\ldots, N-1.\n$$\n\n对每个测试用例，运行不带预条件的共轭梯度法和带基于物理的预条件子的共轭梯度法。使用基于相对残差的停止准则：当 $ \\| \\mathbf{r}^{(k)} \\|_2 / \\| \\mathbf{r}^{(0)} \\|_2 \\leq 10^{-8} $ 或当 $ k $ 达到 $ N $ 时停止，以先满足者为准。记录每种情况下所需的迭代次数。\n\n测试套件：\n- 用例1（一般稠密等离子体，中等空间耦合）：$ N = 128 $，$ \\omega_p = 100 $，$ \\Delta t = 10 $，$ \\lambda = 1 $，$ m = 1 $。\n- 用例2（极稠密等离子体，中等空间耦合）：$ N = 128 $，$ \\omega_p = 1000 $，$ \\Delta t = 20 $，$ \\lambda = 1 $，$ m = 3 $。\n- 用例3（无空间耦合，纯局域响应）：$ N = 128 $，$ \\omega_p = 100 $，$ \\Delta t = 10 $，$ \\lambda = 0 $，$ m = 5 $。\n- 用例4（稠密等离子体，强空间耦合和更高分辨率）：$ N = 256 $，$ \\omega_p = 300 $，$ \\Delta t = 15 $，$ \\lambda = 50 $，$ m = 2 $。\n\n最终输出规格：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的数对列表，每个数对 $ [k_{\\text{no}},k_{\\text{pre}}] $ 对应一个测试用例，$ k_{\\text{no}} $ 和 $ k_{\\text{pre}} $ 分别是表示不使用和使用基于物理的预条件子时的迭代次数的整数。例如，输出格式必须是\n$$\n\\texttt{[[k\\_no1,k\\_pre1],[k\\_no2,k\\_pre2],[k\\_no3,k\\_pre3],[k\\_no4,k\\_pre4]]}.\n$$", "solution": "该问题要求在一个一维冷电子等离子体的隐式网格粒子（PIC）模型中，推导并求解一个关于电场的线性系统。该系统将使用共轭梯度（CG）法进行求解，包括使用和不使用基于物理的预条件子两种情况。\n\n### 电场线性系统的推导\n\n我们从一个具有固定中和离子背景（密度为 $n_0$）的冷、无磁化电子等离子体的线性化一维流体方程开始。电子电荷为 $q_e = -e$，质量为 $m_e$。在无量纲单位制中，我们可以设定 $e=1$、$m_e=1$ 和 $\\epsilon_0=1$。\n\n1.  **动量方程（冷流体的欧拉方程）：**\n    $$\n    \\frac{\\partial v_e}{\\partial t} = -E\n    $$\n2.  **电流密度：** 电子电流密度为 $J_e = -n_e v_e$。在平衡态（$n_e \\approx n_0$，$v_e \\approx 0$）附近进行线性化，我们得到 $J_e \\approx -n_0 v_e$。\n3.  **安培-麦克斯韦定律：** 在一维无磁场的情况下，该定律为 $\\frac{\\partial E}{\\partial t} = -J_{tot}$。在我们的等离子体中，总电流由电子电流 $J_e$ 和任何其他源组成，我们会将这些源并入最终系统的右端项。因此，我们将 $E$ 的时间演化与等离子体电流联系起来：$\\frac{\\partial E}{\\partial t} = -J_e$。\n\n我们采用一种时间上向后（全隐式）的离散格式来处理高频等离子体振荡，这种格式即使在 $\\omega_p \\Delta t \\gg 1$ 的情况下也是稳定的。\n离散化动量方程：\n$$\n\\frac{v_e^{n+1} - v_e^n}{\\Delta t} = -E^{n+1} \\implies v_e^{n+1} = v_e^n - \\Delta t E^{n+1}\n$$\n那么时间步 $n+1$ 的电流为：\n$$\nJ_e^{n+1} = -n_0 v_e^{n+1} = -n_0 (v_e^n - \\Delta t E^{n+1}) = J_e^n + n_0 \\Delta t E^{n+1}\n$$\n等离子体频率定义为 $\\omega_p^2 = n_0 e^2 / (\\epsilon_0 m_e)$。在我们的无量纲单位制中，这变为 $\\omega_p^2 = n_0$。所以，我们有：\n$$\nJ_e^{n+1} = J_e^n + \\omega_p^2 \\Delta t E^{n+1}\n$$\n现在，我们对安培-麦克斯韦定律进行隐式离散化：\n$$\n\\frac{E^{n+1} - E^n}{\\Delta t} = -J_e^{n+1}\n$$\n代入 $J_e^{n+1}$ 的表达式：\n$$\n\\frac{E^{n+1} - E^n}{\\Delta t} = -(J_e^n + \\omega_p^2 \\Delta t E^{n+1})\n$$\n重新整理以求解 $E^{n+1}$：\n$$\nE^{n+1} - E^n = -\\Delta t J_e^n - \\omega_p^2 \\Delta t^2 E^{n+1}\n$$\n$$\n(1 + \\omega_p^2 \\Delta t^2) E^{n+1} = E^n - \\Delta t J_e^n\n$$\n这个方程描述了局域等离子体响应。项 $(1 + \\omega_p^2 \\Delta t^2)E^{n+1}$ 显示了电场如何被等离子体的惯性响应所屏蔽。由于 $\\omega_p \\Delta t \\gg 1$，我们可以将其近似为 $(\\omega_p^2 \\Delta t^2) E^{n+1}$。\n\n空间耦合源于麦克斯韦方程组，特别是将场与其源联系起来的高斯定律（泊松方程）。使用“直接隐式”方法进行完整推导会得到一个亥姆霍兹型电场方程。为解决本问题，我们采用所提供的结构，这是此类推导的一个常见结果：\n$$\n(\\omega_p^2 \\Delta t^2) \\mathbf{E}^{n+1} - \\lambda \\nabla^2 \\mathbf{E}^{n+1} = \\mathbf{b}'\n$$\n其中 $\\mathbf{b}'$ 是一个由时间 $n$ 的条件推导出的源项，$\\lambda$ 是一个控制空间耦合强度的参数。算子 $\\nabla^2$ 是一维拉普拉斯算子 $\\frac{\\partial^2}{\\partial x^2}$。\n\n我们一个由 $N$ 个点 $x_i = i/N$（$i=0, \\dots, N-1$）组成的均匀网格上离散化此方程。电场由其在网格点上的值 $E_i$ 组成的向量 $\\mathbf{E}$ 表示。指定的离散拉普拉斯算子是 $(D\\mathbf{E})_i = E_{i+1} - 2E_i + E_{i-1}$，这对应于 $h^2 \\nabla^2 E$，其中 $h=1/N$ 是网格间距。因子 $h^2$ 可以被吸收到 $\\lambda$ 中。得到的线性系统是 $\\mathbf{A} \\mathbf{E}^{n+1} = \\mathbf{b}$，其中矩阵 $\\mathbf{A}$ 作用于向量 $\\mathbf{E}$ 的方式如下：\n$$\n(\\mathbf{A} \\mathbf{E})_i = (\\omega_p^2 \\Delta t^2) E_i + \\lambda (- (E_{i+1} - 2E_i + E_{i-1}))\n$$\n令 $c = \\omega_p^2 \\Delta t^2$。矩阵 $\\mathbf{A}$ 可以写作：\n$$\n\\mathbf{A} = c \\mathbf{I} - \\lambda \\mathbf{D}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵，$\\mathbf{D}$ 是具有周期性边界条件的离散拉普拉斯算子的矩阵表示。矩阵 $-\\mathbf{D}$ 是一个对称半正定矩阵。其特征值为 $2(1 - \\cos(2\\pi k/N)) \\ge 0$ (对于 $k=0, \\dots, N-1$）。$\\mathbf{A}$ 的特征值为 $\\mu_k = c + 2\\lambda(1 - \\cos(2\\pi k/N))$。由于 $c = (\\omega_p \\Delta t)^2 > 0$ 且 $\\lambda \\ge 0$，所有特征值 $\\mu_k$ 均为正。因此，$\\mathbf{A}$ 是一个对称正定（SPD）矩阵，这是标准共轭梯度算法的一个要求。\n\n右端向量 $\\mathbf{b}$ 以单一傅里叶模式给出：\n$$\nb_i = \\sin(2 \\pi m x_i) = \\sin(2 \\pi m i / N)\n$$\n\n### 共轭梯度法\n\n共轭梯度（CG）法是一种用于求解线性系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的迭代算法，其中 $\\mathbf{A}$ 是对称正定的。从一个初始猜测 $\\mathbf{x}^{(0)} = \\mathbf{0}$ 开始，该算法迭代地优化解。对于每个测试用例，我们将运行标准 CG 算法，并计算迭代次数 $k_{\\text{no}}$，直到相对残差范数 $\\| \\mathbf{r}^{(k)} \\|_2 / \\| \\mathbf{r}^{(0)} \\|_2$ 降至容差 $10^{-8}$ 以下。\n\n### 预条件共轭梯度法\n\n预处理是一种提高迭代方法收敛速度的技术。预条件子 $\\mathbf{M}$ 是一个近似于 $\\mathbf{A}$ 但更容易求逆的矩阵。预条件共轭梯度（PCG）法有效地求解变换后的系统 $\\mathbf{M}^{-1}\\mathbf{A}\\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}$。\n\n问题指定了一个基于物理的预条件子，该预条件子通过从 $\\mathbf{A}$ 中舍弃空间耦合（拉普拉斯）项来模拟主导的局域等离子体响应。算子 $\\mathbf{A}$ 由局域响应项 $c\\mathbf{I}$ 和空间耦合项 $-\\lambda \\mathbf{D}$ 组成。舍弃空间项后剩下算子 $c\\mathbf{I}$。预条件子 $\\mathbf{M}$ 就是这个算子本身。PCG 中的预处理步骤需要求解 $\\mathbf{M}\\mathbf{z}^{(k)} = \\mathbf{r}^{(k)}$，这变得非常简单：\n$$\n(c\\mathbf{I}) \\mathbf{z}^{(k)} = \\mathbf{r}^{(k)} \\implies \\mathbf{z}^{(k)} = \\frac{1}{c} \\mathbf{r}^{(k)}\n$$\n这是对残差向量的简单缩放。对于 $\\omega_p \\Delta t \\gg 1$ 的稠密等离子体区域，项 $c\\mathbf{I}$ 在 $\\mathbf{A}$ 中占主导地位，使其成为强对角占优矩阵。这表明该预条件子应该非常有效。我们将使用此预条件子运行 PCG 算法并计算迭代次数 $k_{\\text{pre}}$。\n\n实现将包括两个函数，一个用于 CG，一个用于 PCG。它们不会显式地构建矩阵 $\\mathbf{A}$，而是使用一个函数来计算矩阵-向量乘积 $\\mathbf{A}\\mathbf{p}$，这对于像 $\\mathbf{A}$ 这样的稀疏/结构化矩阵更高效。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the specified linear systems using Conjugate Gradient methods\n    and outputs the number of iterations for each test case.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general dense plasma, moderate spatial coupling)\n        (128, 100.0, 10.0, 1.0, 1),\n        # Case 2 (very dense plasma, moderate spatial coupling)\n        (128, 1000.0, 20.0, 1.0, 3),\n        # Case 3 (no spatial coupling, purely local response)\n        (128, 100.0, 10.0, 0.0, 5),\n        # Case 4 (dense plasma, strong spatial coupling and higher resolution)\n        (256, 300.0, 15.0, 50.0, 2),\n    ]\n\n    results = []\n    \n    # Tolerance for stopping criterion\n    tol = 1e-8\n\n    for case in test_cases:\n        N, omega_p, dt, lam, m = case\n        \n        # Calculate the constant for the identity matrix part of the operator\n        c = omega_p**2 * dt**2\n\n        # Construct the right-hand side vector b\n        x_grid = np.arange(N) / N\n        b = np.sin(2 * np.pi * m * x_grid)\n\n        # Define the matrix-vector product function for A*p\n        # A*p = (c*I - lam*D)*p, where Dp_i = p_{i+1} - 2p_i + p_{i-1}\n        # (A*p)_i = c*p_i - lam*(p_{i+1} - 2p_i + p_{i-1})\n        #         = (c + 2*lam)*p_i - lam*(p_{i+1} + p_{i-1})\n        def matvec(p):\n            return (c + 2 * lam) * p - lam * (np.roll(p, -1) + np.roll(p, 1))\n\n        # --- Unpreconditioned Conjugate Gradient ---\n        def cg(A_matvec, b_vec):\n            x = np.zeros_like(b_vec)\n            r = b_vec.copy()\n            p = r.copy()\n            \n            rs_old = np.dot(r, r)\n            r_norm_0 = np.sqrt(rs_old)\n            if r_norm_0 == 0:\n                return 0\n\n            max_iter = N\n            for k in range(1, max_iter + 1):\n                Ap = A_matvec(p)\n                alpha = rs_old / np.dot(p, Ap)\n                x += alpha * p\n                r -= alpha * Ap\n                \n                rs_new = np.dot(r, r)\n                \n                if np.sqrt(rs_new) / r_norm_0 = tol:\n                    return k\n                \n                p = r + (rs_new / rs_old) * p\n                rs_old = rs_new\n            return max_iter\n\n        k_no = cg(matvec, b)\n\n        # --- Preconditioned Conjugate Gradient ---\n        # The preconditioning step z = M_inv * r, where M = c*I\n        def precond_inv(r_vec):\n            # If c is zero, the operator is singular and M is not invertible.\n            # Based on problem constraints, c will be large.\n            return (1/c) * r_vec\n\n        def pcg(A_matvec, b_vec, P_inv_vec):\n            x = np.zeros_like(b_vec)\n            r = b_vec.copy()\n            \n            r_norm_0 = np.linalg.norm(r)\n            if r_norm_0 == 0:\n                return 0\n            \n            z = P_inv_vec(r)\n            p = z.copy()\n            rz_old = np.dot(r, z)\n            \n            max_iter = N\n            for k in range(1, max_iter + 1):\n                Ap = A_matvec(p)\n                alpha = rz_old / np.dot(p, Ap)\n                x += alpha * p\n                r -= alpha * Ap\n                \n                if np.linalg.norm(r) / r_norm_0 = tol:\n                    return k\n\n                z = P_inv_vec(r)\n                rz_new = np.dot(r, z)\n                \n                p = z + (rz_new / rz_old) * p\n                rz_old = rz_new\n            return max_iter\n\n        k_pre = pcg(matvec, b, precond_inv)\n        \n        results.append(f\"[{k_no},{k_pre}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "3529066"}]}