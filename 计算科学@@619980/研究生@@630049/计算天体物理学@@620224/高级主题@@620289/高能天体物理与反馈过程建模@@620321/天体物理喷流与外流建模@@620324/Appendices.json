{"hands_on_practices": [{"introduction": "在相对论性磁流体力学（RMHD）中，区分实验室参考系和流体共动参考系中的物理量至关重要。本练习将引导您实践这一关键变换，将实验室参考系中测量的磁场 $\\mathbf{B}$ 转换为共动参考系中的磁四维矢量 $b^{\\mu}$ [@problem_id:3517930]。通过这个过程，您将计算出磁化参数 $\\sigma$，它是衡量喷流中磁场能量相对于物质能量的重要性的核心无量纲参数。", "problem": "在相对论磁流体力学（RMHD）中，在流体静止参考系中测量的磁场被编码在磁四维矢量 $b^{\\mu}$ 中，它通过对偶电磁场张量 ${^{\\ast}\\!F}^{\\mu \\nu}$ 和流体四维速度 $u^{\\nu}$ 定义为 $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$。在闵可夫斯基度规符号为 $(-,+,+,+)$ 的平直时空中进行计算，采用光速 $c=1$ 的单位制，并使用亥维赛-洛伦兹电磁单位。假设为理想磁流体动力学（完美电导性），因此实验室参考系中的电场和磁场满足 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$，其中 $\\mathbf{v}$ 是流体三维速度。\n\n仅从上述定义出发，结合场张量及其对偶张量在实验室参考系场下的标准表示，执行以下操作：\n\n1. 构建一个变换，将 $b^{\\mu}$ 明确地用实验室参考系磁场 $\\mathbf{B}$、流体三维速度 $\\mathbf{v}$ 和洛伦兹因子 $\\Gamma \\equiv (1 - v^{2})^{-1/2}$ 表示，其中 $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$。\n\n2. 从你得到的一般表达式中，推导出一个关于 $\\mathbf{B}$、$\\mathbf{v}$ 和 $\\Gamma$ 的 $b^{2} \\equiv b^{\\mu} b_{\\mu}$ 的简化标量表达式。\n\n3. 对于一个喷流流体元，其实验室参考系磁场为 $\\mathbf{B} = (3, 4, 12)$，速度为 $\\mathbf{v} = (0.6, 0.3, 0.0)$，求 $b^{2}$ 的值，然后在给定焓密度 $w = 50$ 的情况下，计算磁化参数 $\\sigma \\equiv b^{2}/w$。将你的最终答案 $\\sigma$ 表示为一个无量纲数。将你的最终答案四舍五入到 $4$ 位有效数字。", "solution": "解答按要求分为三个部分。\n\n**第1部分：用实验室参考系物理量表示 $b^{\\mu}$**\n\n我们从定义 $b^{\\mu} = {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$ 开始。四维速度 $u^{\\mu}$ 及其协变形式 $u_{\\mu}$ 的分量是：\n$$ u^{\\mu} = (\\Gamma, \\Gamma \\mathbf{v}) = (\\Gamma, \\Gamma v^x, \\Gamma v^y, \\Gamma v^z) $$\n$$ u_{\\mu} = \\eta_{\\mu\\nu}u^{\\nu} = (-\\Gamma, \\Gamma \\mathbf{v}) = (-\\Gamma, \\Gamma v_x, \\Gamma v_y, \\Gamma v_z) $$\n对偶电磁场张量 ${^{\\ast}\\!F}^{\\mu\\nu}$ 用实验室参考系的电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 表示为：\n$$ {^{\\ast}\\!F}^{\\mu\\nu} = \\begin{pmatrix} 0  -B_x  -B_y  -B_z \\\\ B_x  0  E_z  -E_y \\\\ B_y  -E_z  0  E_x \\\\ B_z  E_y  -E_x  0 \\end{pmatrix} $$\n现在我们通过矩阵-矢量乘法计算 $b^{\\mu}$ 的分量。\n\n时间分量 $b^0$：\n$$ b^0 = {^{\\ast}\\!F}^{0\\nu}u_{\\nu} = {^{\\ast}\\!F}^{00}u_0 + {^{\\ast}\\!F}^{01}u_1 + {^{\\ast}\\!F}^{02}u_2 + {^{\\ast}\\!F}^{03}u_3 $$\n$$ b^0 = (0)(-\\Gamma) + (-B_x)(\\Gamma v_x) + (-B_y)(\\Gamma v_y) + (-B_z)(\\Gamma v_z) = -\\Gamma (B_x v_x + B_y v_y + B_z v_z) $$\n$$ b^0 = -\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}) $$\n\n空间分量 $b^i$（其中 $i=1,2,3$ 对应 $x,y,z$）构成一个三维矢量 $\\mathbf{b}$。我们来计算 $b^1$：\n$$ b^1 = {^{\\ast}\\!F}^{1\\nu}u_{\\nu} = {^{\\ast}\\!F}^{10}u_0 + {^{\\ast}\\!F}^{11}u_1 + {^{\\ast}\\!F}^{12}u_2 + {^{\\ast}\\!F}^{13}u_3 $$\n$$ b^1 = (B_x)(-\\Gamma) + (0)(\\Gamma v_x) + (E_z)(\\Gamma v_y) + (-E_y)(\\Gamma v_z) = \\Gamma[-B_x + (E_z v_y - E_y v_z)] = \\Gamma[-B_x + (\\mathbf{v} \\times \\mathbf{E})_x] $$\n推广到所有三个空间分量：\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times \\mathbf{E}) $$\n现在我们应用理想MHD条件，$\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$。\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times (-\\mathbf{v} \\times \\mathbf{B})) = \\Gamma(-\\mathbf{B} - \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B})) $$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$，我们得到：\n$$ \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}(\\mathbf{v}\\cdot\\mathbf{v}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2 $$\n将此代入 $\\mathbf{b}$ 的表达式：\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} - [\\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2]) = \\Gamma(-\\mathbf{B} - \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) + \\mathbf{B}v^2) $$\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B}(1-v^2) - \\mathbf{v}(\\mathbf{B}\\cdot\\mathbf{v})) $$\n使用定义 $\\Gamma = (1-v^2)^{-1/2}$，我们有 $1-v^2 = 1/\\Gamma^2$：\n$$ \\mathbf{b} = \\Gamma(-\\frac{\\mathbf{B}}{\\Gamma^2} - (\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v}) = -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v} $$\n因此，四维矢量 $b^{\\mu} = (b^0, \\mathbf{b})$ 表示为：\n$$ b^{\\mu} = \\left(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}), -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n\n**第2部分：推导 $b^2 \\equiv b^{\\mu} b_{\\mu}$ 的表达式**\n\n标量平方 $b^2$ 是一个洛伦兹不变量。使用 $(-,+,+,+)$ 度规符号，它的计算方式如下：\n$$ b^2 = b^{\\mu} b_{\\mu} = -(b^0)^2 + \\mathbf{b} \\cdot \\mathbf{b} $$\n代入第1部分推导出的分量：\n$$ b^2 = -(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}))^2 + \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n展开点积：\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\frac{\\mathbf{B}}{\\Gamma}\\right) + 2\\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) + \\left(\\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + 2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 v^2 $$\n让我们对含有 $(\\mathbf{B} \\cdot \\mathbf{v})^2$ 的项进行分组：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2(-\\Gamma^2 + 2 + \\Gamma^2 v^2) $$\n乘以 $(\\mathbf{B} \\cdot \\mathbf{v})^2$ 的因子可以显著简化：\n$$ -\\Gamma^2 + 2 + \\Gamma^2 v^2 = -\\Gamma^2(1 - v^2) + 2 $$\n由于 $\\Gamma^2(1-v^2) = 1$，这变为：\n$$ -1 + 2 = 1 $$\n因此，$b^2$ 的表达式简化为：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 $$\n这就是所求的标量表达式。\n\n**第3部分：根据给定的数值计算 $b^2$ 和 $\\sigma$**\n\n给定：\n- $\\mathbf{B} = (3, 4, 12)$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $w = 50$\n\n首先，我们计算所需的标量。\n流体速度大小的平方：\n$$ v^2 = \\mathbf{v} \\cdot \\mathbf{v} = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45 $$\n洛伦兹因子的平方：\n$$ \\Gamma^2 = \\frac{1}{1 - v^2} = \\frac{1}{1 - 0.45} = \\frac{1}{0.55} = \\frac{1}{11/20} = \\frac{20}{11} $$\n磁场大小的平方：\n$$ |\\mathbf{B}|^2 = \\mathbf{B} \\cdot \\mathbf{B} = 3^2 + 4^2 + 12^2 = 9 + 16 + 144 = 169 $$\n$\\mathbf{B}$ 和 $\\mathbf{v}$ 的点积：\n$$ \\mathbf{B} \\cdot \\mathbf{v} = (3)(0.6) + (4)(0.3) + (12)(0.0) = 1.8 + 1.2 + 0.0 = 3.0 $$\n此点积的平方：\n$$ (\\mathbf{B} \\cdot \\mathbf{v})^2 = (3.0)^2 = 9.0 $$\n\n现在，将这些值代入 $b^2$ 的表达式：\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 = \\frac{169}{20/11} + 9.0 $$\n$$ b^2 = 169 \\times \\frac{11}{20} + 9.0 = \\frac{1859}{20} + 9.0 = 92.95 + 9.0 = 101.95 $$\n最后，我们计算磁化参数 $\\sigma$：\n$$ \\sigma = \\frac{b^2}{w} = \\frac{101.95}{50} = 2.039 $$\n问题要求将最终答案四舍五入到4位有效数字。计算出的值 $2.039$ 已经恰好是4位有效数字，因此不需要进一步舍入。", "answer": "$$\\boxed{2.039}$$", "id": "3517930"}, {"introduction": "从物理理论转向数值实现时，我们必须面对坐标系带来的挑战。虽然柱坐标或球坐标对于模拟轴对称喷流十分自然，但它们在对称轴或原点处会引入坐标奇异性 [@problem_id:3517917]。本练习将通过分析和实现一个正则化方案，向您展示如何正确处理对称轴上的奇异性，以避免产生虚假的数值力，确保模拟的物理真实性。", "problem": "您正在柱坐标系中对轴对称射流和外流进行建模，需要处理对称轴上的坐标奇点。考虑一个柱坐标系中的轴对称控制体，其径向坐标为 $R \\ge 0$，其中对于质量密度 $\\rho$ 和速度分量 $v_{R}$、$v_{z}$，连续性方程表示为：\n$$\\frac{\\partial \\rho}{\\partial t} + \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R \\rho v_{R}\\right) + \\frac{\\partial}{\\partial z}\\left(\\rho v_{z}\\right) = 0.$$\n定义 $A_{R}(R) \\equiv \\rho v_{R}$ 为径向质量通量密度。在轴附近，轴对称射流或外流的物理对称性意味着 $v_{R}$ 是 $R$ 的奇函数，而 $\\rho$ 是 $R$ 的偶函数，因此 $A_{R}$ 具有以下形式的奇函数泰勒展开：\n$$A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3},$$\n其中 $a_{0}$ 表示可能在数值计算中出现的非物理偶数污染，$a_{1}$ 捕捉物理上允许的主导阶奇数行为，而 $a_{3}$ 捕捉更高阶的奇数行为。几何散度算子\n$$\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$$\n在其逐点微分形式下于 $R=0$ 处是奇异的，但其物理极限存在，且任何数值方法都必须在不产生伪力的情况下捕捉到这一极限。\n\n任务：\n- 仅从连续性方程和泰勒展开出发，在给定奇宇称条件下，推导当 $R \\to 0$ 时 $\\mathcal{L}[A_{R}]$ 的有限极限。您的推导不得假设任何已知的专门正则化公式，必须从定义和泰勒展开开始。\n- 考虑一个一维均匀径向网格，其单元中心位于 $R_{i} = \\left(i + \\tfrac{1}{2}\\right)\\Delta R$（整数 $i \\ge 0$），因此前两个中心为 $R_{0} = \\tfrac{1}{2}\\Delta R$ 和 $R_{1} = \\tfrac{3}{2}\\Delta R$。定义 $A_{i} \\equiv A_{R}(R_{i})$，其中 $i \\in \\{0,1\\}$。\n\n  在第一个单元中心 $R_{0}$ 处，实现 $\\mathcal{L}[A_{R}]$ 的两种离散近似：\n  - 一种朴素的逐点中心差分近似，它直接在 $R_{0}$ 处离散化 $\\mathcal{L}[A_{R}] = \\tfrac{1}{R}\\tfrac{\\partial}{\\partial R}(R A_{R})$，对径向导数使用中心差分，并对 $i=-1$ 处的虚拟值使用偶反射，即在 $R_{-1} = -\\tfrac{1}{2}\\Delta R$ 处有 $A_{-1} = A_{0}$。这会产生\n    $$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) \\approx \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}.$$\n    这反映了一个未在轴上强制施加正确奇宇称的求解器。\n  - 一种正则化的有限体积近似，它强制施加奇宇称并通过轴面实现零净通量，该近似从第一个控制体 $[0,\\Delta R]$ 上的守恒积分形式推导而来，其内界面位于 $R_{-1/2} = 0$，外界面位于 $R_{+1/2} = \\Delta R$。通过以下步骤估算界面中心 $R_{+1/2}$ 处的值 $A_{R}$：首先，使用最近的两个单元中心对 $A(R)$ 进行局部线性拟合，并减去在 $R=0$ 处的拟合截距，以移除偶数污染；然后，线性插值到该界面。在 $R_{0}$ 处得到的散度有限体积形式为\n    $$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) \\approx \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R},$$\n    其中根据对称性 $A_{-1/2}^{\\mathrm{odd}} = 0$，而 $A_{+1/2}^{\\mathrm{odd}}$ 通过奇宇称投影后进行线性插值得到。\n\n- 对于每种情况，定义绝对轴散度误差为 $e_{\\mathrm{naive}} \\equiv \\left|\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$ 和 $e_{\\mathrm{reg}} \\equiv \\left|\\mathcal{L}_{\\mathrm{reg}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$，其中 $\\mathcal{L}_{\\mathrm{exact}}(0)$ 是您推导出的解析轴极限。通过比率\n  $$\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)},$$\n  来量化轴奇点的数值影响和正则化的有效性，其中 $\\epsilon$ 是一个小的正常数，以防止除以零。使用 $\\epsilon = 10^{-18}$。比率 $\\mathcal{R}$ 是无量纲的，必须以浮点数形式报告。\n\n- 实现一个完整、可运行的程序，该程序针对下面的每个测试用例，计算并输出如上定义的 $\\mathcal{R}$。\n\n使用以下测试套件，其中每个用例指定 $(a_{0}, a_{1}, a_{3}, \\Delta R)$，均为无量纲：\n- 情况 1：$(0, 1, 0, 10^{-3})$。\n- 情况 2：$(10^{-3}, 1, 0, 10^{-2})$。\n- 情况 3：$(2\\times 10^{-4}, 0.3, -2.0, 5\\times 10^{-2})$。\n- 情况 4：$(-5\\times 10^{-5}, 2.0, 10.0, 2\\times 10^{-1})$。\n- 情况 5：$(10^{-6}, 0.0, 5.0, 10^{-2})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，按上述测试套件的顺序排列，例如 $[\\mathcal{R}_{1},\\mathcal{R}_{2},\\mathcal{R}_{3},\\mathcal{R}_{4},\\mathcal{R}_{5}]$。\n- 输出是纯粹的无量纲浮点数。", "solution": "求解过程分四个阶段进行：\n1.  推导对称轴上散度算子的精确解析极限。\n2.  分析朴素数值近似及其相关误差。\n3.  分析正则化有限体积近似及其相关误差。\n4.  计算每个测试用例的误差比 $\\mathcal{R}$。\n\n**1. 精确轴散度的推导**\n\n径向散度算子定义为 $\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$。径向质量通量密度 $A_{R}(R)$ 由泰勒展开式给出 $A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3}$。\n\n首先，我们计算导数内的乘积：\n$$R A_{R}(R) = R (a_{0} + a_{1} R + a_{3} R^{3}) = a_{0} R + a_{1} R^{2} + a_{3} R^{4}$$\n接下来，我们对 $R$ 求偏导数：\n$$\\frac{\\partial}{\\partial R}\\left(R A_{R}(R)\\right) = \\frac{\\partial}{\\partial R}\\left(a_{0} R + a_{1} R^{2} + a_{3} R^{4}\\right) = a_{0} + 2 a_{1} R + 4 a_{3} R^{3}$$\n最后，我们应用因子 $\\frac{1}{R}$ 来获得算子的完整表达式：\n$$\\mathcal{L}[A_{R}] = \\frac{1}{R} \\left(a_{0} + 2 a_{1} R + 4 a_{3} R^{3}\\right) = \\frac{a_{0}}{R} + 2 a_{1} + 4 a_{3} R^{2}$$\n为了找到轴上的物理极限，我们取 $R \\to 0$ 的极限。问题陈述指出，对于物理的轴对称流，径向速度 $v_{R}$ 是 $R$ 的奇函数，密度 $\\rho$ 是 $R$ 的偶函数。因此，它们的乘积，即质量通量 $A_R = \\rho v_R$，必须是 $R$ 的奇函数。一个奇函数在 $R=0$ 附近的泰勒级数只包含 $R$ 的奇次幂。因此，对于物理上正确的流动，偶次幂 $R^0$ 的系数 $a_0$ 必须为零。项 $a_0$ 被明确描述为可能在数值上产生的“非物理偶数污染”。在物理约束 $a_0 = 0$ 的条件下，极限为：\n$$\\mathcal{L}_{\\mathrm{exact}}(0) \\equiv \\lim_{R \\to 0, a_0=0} \\mathcal{L}[A_{R}] = \\lim_{R \\to 0} \\left(2 a_{1} + 4 a_{3} R^{2}\\right) = 2 a_{1}$$\n这就是对称轴上散度的精确、非奇异值。\n\n**2. 朴素数值格式的分析**\n\n朴素中心差分近似应用于第一个单元中心 $R_{0} = \\frac{1}{2}\\Delta R$。其公式为：\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}$$\n网格位置为 $R_{1} = \\frac{3}{2}\\Delta R$ 和 $R_{-1} = -\\frac{1}{2}\\Delta R$。边界条件为偶反射，$A_{-1} = A_{0}$。将这些代入公式：\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{\\frac{1}{2}\\Delta R} \\cdot \\frac{(\\frac{3}{2}\\Delta R)A_{1} - (-\\frac{1}{2}\\Delta R)A_{0}}{2\\Delta R} = \\frac{2}{\\Delta R} \\cdot \\frac{\\frac{\\Delta R}{2}(3 A_1 + A_0)}{2\\Delta R} = \\frac{3 A_1 + A_0}{2\\Delta R}$$\n为了分析误差，我们使用给定的展开式来表示 $A_{0} \\equiv A_{R}(R_{0})$ 和 $A_{1} \\equiv A_{R}(R_{1})$：\n$$A_{0} = a_{0} + a_{1}\\left(\\frac{1}{2}\\Delta R\\right) + a_{3}\\left(\\frac{1}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}$$\n$$A_{1} = a_{0} + a_{1}\\left(\\frac{3}{2}\\Delta R\\right) + a_{3}\\left(\\frac{3}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}$$\n将这些代入 $\\mathcal{L}_{\\mathrm{naive}}(R_{0})$ 的表达式中：\n$$3A_{1} + A_{0} = 3\\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) + \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$3A_{1} + A_{0} = 4a_{0} + \\left(\\frac{9}{2} + \\frac{1}{2}\\right)a_{1}\\Delta R + \\left(\\frac{81}{8} + \\frac{1}{8}\\right)a_{3}(\\Delta R)^{3} = 4a_{0} + 5a_{1}\\Delta R + \\frac{82}{8}a_{3}(\\Delta R)^{3}$$\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{4a_{0} + 5a_{1}\\Delta R + 10.25 a_{3}(\\Delta R)^{3}}{2\\Delta R} = \\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}$$\n误差为 $e_{\\mathrm{naive}} = |\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)|$：\n$$e_{\\mathrm{naive}} = \\left|\\left(\\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right) - 2a_{1}\\right| = \\left|\\frac{2a_{0}}{\\Delta R} + 0.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right|$$\n该格式存在一个与 $a_{0}/\\Delta R$ 成正比的项，如果存在非物理污染 $a_{0}$，该项在 $\\Delta R \\to 0$ 时会发散。\n\n**3. 正则化数值格式的分析**\n\n在第一个单元 $[0, \\Delta R]$ 上的正则化有限体积近似为：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R}$$\n其界面位于 $R_{-1/2} = 0$ 和 $R_{+1/2} = \\Delta R$。单元中心为 $R_0 = \\frac{1}{2}\\Delta R$。根据对称性，通过轴的通量为零，因此 $A_{-1/2}^{\\mathrm{odd}} = 0$。公式简化为：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{(\\Delta R) A_{+1/2}^{\\mathrm{odd}}}{(\\frac{1}{2}\\Delta R)\\Delta R} = \\frac{2 A_{+1/2}^{\\mathrm{odd}}}{\\Delta R}$$\n为了找到 $A_{+1/2}^{\\mathrm{odd}}$，我们遵循指定的步骤。首先，我们使用中心 $R_0$ 和 $R_1$ 处的值进行局部线性拟合 $f(R) = mR+c$。截距 $c$ 估算了偶数污染 $a_0$。\n$$m = \\frac{A_1 - A_0}{R_1 - R_0} = \\frac{A_1 - A_0}{\\Delta R}$$\n$$c = A_0 - m R_0 = A_0 - \\left(\\frac{A_1 - A_0}{\\Delta R}\\right)\\left(\\frac{1}{2}\\Delta R\\right) = \\frac{3}{2}A_0 - \\frac{1}{2}A_1$$\n接下来，我们定义一个投影函数 $A^{\\mathrm{odd}}_{\\text{local}}(R) = A(R) - c$，该函数移除了污染。我们在单元中心 $R_0$ 和 $R_1$ 处计算此函数的值：\n$$A'_{0} = A_0 - c = A_0 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{1}{2}A_0 + \\frac{1}{2}A_1$$\n$$A'_{1} = A_1 - c = A_1 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{3}{2}A_0 + \\frac{3}{2}A_1$$\n最后，我们在点 $(R_0, A'_{0})$ 和 $(R_1, A'_{1})$ 之间进行线性插值，以找到界面 $R_{+1/2} = \\Delta R$ 处的值：\n$$A_{+1/2}^{\\mathrm{odd}} = A'_{0} + (A'_{1} - A'_{0})\\frac{\\Delta R - R_0}{R_1 - R_0} = \\left(-\\frac{1}{2}A_0 + \\frac{1}{2}A_1\\right) + (-A_0 + A_1)\\frac{\\frac{1}{2}\\Delta R}{\\Delta R} = A_1 - A_0$$\n将此结果代回 $\\mathcal{L}_{\\mathrm{reg}}(R_{0})$ 的表达式中：\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2(A_1 - A_0)}{\\Delta R}$$\n为了分析误差，我们使用 $A_0$ 和 $A_1$ 的表达式：\n$$A_1 - A_0 = \\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) - \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$A_1 - A_0 = a_1 \\Delta R + \\frac{26}{8}a_3(\\Delta R)^3 = a_1\\Delta R + 3.25 a_3(\\Delta R)^3$$\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2}{\\Delta R}\\left(a_1\\Delta R + 3.25 a_3(\\Delta R)^3\\right) = 2a_1 + 6.5 a_3 (\\Delta R)^2$$\n误差为 $e_{\\mathrm{reg}} = |\\mathcal{L}_{\\mathrm{reg}}(R_0) - \\mathcal{L}_{\\mathrm{exact}}(0)|$：\n$$e_{\\mathrm{reg}} = |\\left(2a_1 + 6.5 a_3 (\\Delta R)^2\\right) - 2a_1| = |6.5 a_3 (\\Delta R)^2|$$\n该格式是二阶精确的，并正确地消除了与 $a_0$ 相关的发散项。\n\n**4. 误差比的计算**\n\n比率为 $\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)}$，其中 $\\epsilon = 10^{-18}$。通过执行所提供的Python代码可以得到每个测试用例的具体数值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the ratio of errors between a naive and a regularized numerical\n    scheme for the divergence operator at the axis of a cylindrical coordinate system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a1, a3, delta_R)\n    test_cases = [\n        (0.0, 1.0, 0.0, 1e-3),\n        (1e-3, 1.0, 0.0, 1e-2),\n        (2e-4, 0.3, -2.0, 5e-2),\n        (-5e-5, 2.0, 10.0, 2e-1),\n        (1e-6, 0.0, 5.0, 1e-2),\n    ]\n\n    epsilon = 1e-18\n    results = []\n\n    for case in test_cases:\n        a0, a1, a3, delta_R = case\n\n        # Analytical value of the divergence at the R=0 axis.\n        # L_exact(0) = 2 * a1\n        L_exact = 2.0 * a1\n\n        # Define the radial mass flux density function A_R(R)\n        def A_R(R):\n            return a0 + a1 * R + a3 * R**3\n\n        # Define grid cell centers\n        R0 = 0.5 * delta_R\n        R1 = 1.5 * delta_R\n\n        # Evaluate A_R at cell centers\n        A0 = A_R(R0)\n        A1 = A_R(R1)\n\n        # --- Naive Approximation ---\n        # L_naive = (1/R0) * (R1*A1 - R_m1*A_m1) / (2*delta_R)\n        # where R_m1 = -R0 and A_m1 = A0 (even reflection)\n        # This simplifies to: L_naive = (3*A1 + A0) / (2*delta_R)\n        L_naive = (3.0 * A1 + A0) / (2.0 * delta_R)\n        \n        # --- Regularized Approximation ---\n        # The derivation in the solution text shows that the complex procedure\n        # described in the problem simplifies to:\n        # L_reg = 2 * (A1 - A0) / delta_R\n        L_reg = 2.0 * (A1 - A0) / delta_R\n\n        # --- Errors and Ratio ---\n        e_naive = abs(L_naive - L_exact)\n        e_reg = abs(L_reg - L_exact)\n\n        # The ratio R quantifies the improvement of the regularized scheme.\n        R_val = e_naive / max(e_reg, epsilon)\n        results.append(R_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3517917"}, {"introduction": "掌握了流体描述和数值技术后，我们可以应用这些工具来分析喷流的物理行为。开尔文-亥姆霍兹（Kelvin-Helmholtz）不稳定性是塑造喷流与其周围介质边界的关键机制 [@problem_id:3517935]。本练习将引导您推导并数值求解一个简化的相对论性KHI色散关系，以确定不稳定性的增长率，从而将理论稳定性分析与定量预测联系起来。", "problem": "考虑一个半径为 $r_0$ 的冷柱状相对论性喷流，其沿着 $z$ 轴具有均匀的轴向整体流，速度为 $v_j$，洛伦兹因子为 $\\Gamma_j = (1 - v_j^2)^{-1/2}$。该喷流嵌入在一个静态的环境介质中。我们采用理想相对论磁流体动力学 (RMHD)，假设在喷流边界处存在一个不可压缩的薄剪切层，该剪切层可以局部处理为半厚度 $a \\ll r_0$ 的平面切向不连续面，并关注实验室坐标系中轴向波数为 $k$ 的轴对称表面扰动。喷流携带一个螺旋磁场，其轴向分量为 $B_z$，方位角分量为 $B_\\phi$，由螺距参数 $P = B_\\phi/(r_0 B_z)$ 表征，而环境介质被视为无磁化。在整个过程中，我们使用自然单位制，光速 $c = 1$，并将所有长度归一化为 $r_0 = 1$，因此频率和增长率的单位是逆光穿越时间 $r_0/c$。\n\n从包含电磁贡献的 RMHD 能量-动量张量和理想欧姆定律出发，围绕基态进行线性化，并考虑振幅随远离界面而衰减的不可压缩扰动。对于标记为 $j \\in \\{1,2\\}$ 的两个半无限均匀状态（喷流 $j=1$，环境介质 $j=2$）之间的平面界面，波数为 $k$、复频率为 $\\omega$ 的表面模的线性化法向应力平衡产生一个二次色散关系，当磁场平行于流动方向时，该关系可以写成紧凑的惯性-张力平衡形式。在冷等离子体极限下，第 $j$ 侧的单位体积相对论惯性为 $I_j = w_j + b_j^2$，其中 $w_j$ 是焓密度，$b_j^2$ 是在共动坐标系中磁场强度的平方。进入表面模平衡的轴向磁张力由共动坐标系中的轴向场分量 $b_{z,j}^2$ 控制。对于均匀轴向流和实验室坐标系中的螺旋磁场分量 $(B_z, B_\\phi)$，理想 RMHD 给出 $b_j^2 = (B_z^2 + B_\\phi^2)/\\Gamma_j^2 + v_j^2 B_z^2$ 和 $b_{z,j}^2 = B_z^2/\\Gamma_j^2$。\n\n假设以下基态：\n- 喷流侧 ($j=1$): $w_1 = 1$ (以 $c^2$ 为单位的冷焓密度)，整体洛伦兹因子 $\\Gamma_1 = \\Gamma$，速度 $v_1 = \\sqrt{1 - \\Gamma^{-2}}$，磁化强度 $\\sigma \\equiv b_1^2/w_1$，以及螺距 $P = B_\\phi/(r_0 B_z)$，其中 $r_0 = 1$。\n- 环境介质侧 ($j=2$): $w_2 = 1$，$v_2 = 0$，无磁场，因此 $b_2^2 = 0$ 且 $b_{z,2}^2 = 0$。\n\n对于喷流，上述定义意味着\n$$\nb_1^2 = \\sigma w_1 = \\sigma,\\quad b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2},\\quad \\text{和}\\quad B_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2},\n$$\n可简化为\n$$\nb_{z,1}^2 = \\frac{\\sigma}{P^2 + \\Gamma^2}.\n$$\n因此，有效相对论惯性为 $I_1 = w_1 + b_1^2 = 1 + \\sigma$ 和 $I_2 = w_2 + b_2^2 = 1$，而对表面模平衡有贡献的轴向磁张力完全由 $b_{z,1}^2$ 决定。\n\n在不可压缩、平面、表面波近似下，平行场的开尔文-亥姆霍兹不稳定性 (KHI) 的色散关系产生一个关于 $\\omega$ 的二次方程，形式如下\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0,\n$$\n其不稳定性条件和增长率可由判别式得出。特别地，增长率 $\\omega_i(k) \\equiv \\operatorname{Im}(\\omega)$ 可以用速度剪切和轴向张力表示为\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2 - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\n且不稳定性要求平方根下的表达式为正。为了在一个原本是平面的处理中启发式地考虑有限的剪切层半厚度 $a$，使用一个因子 $\\tanh(ka)$ 来替代速度剪切驱动，得到\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\n当平方根的参数为负时，$\\omega_i(k) = 0$。这种近似再现了小 $k$ 值的稳定性以及剪切驱动在大 $k$ 值下的饱和，同时保留了轴向磁张力。\n\n任务：\n1) 从理想 RMHD 框架和上述基态定义出发，推导上述不可压缩表面模的色散关系及其有限厚度修正，用 $I_j$、$v_j$ 和 $b_{z,j}^2$ 表示，并明确表达 $b_{z,1}^2$ 如何依赖于 $\\Gamma$、$\\sigma$ 和 $P$。\n2) 实现一个程序，对于指定的参数集 $(\\Gamma,\\sigma,P)$，其中 $w_1 = w_2 = 1$，$v_2 = 0$，$b_{z,2}^2 = 0$，剪切层半厚度 $a = 0.1$，在 $k \\in [0.01, 10.0]$（单位为 $r_0^{-1}$）范围内均匀扫描 $k$ 值，使用上述公式计算 $\\omega_i(k)$，并返回此 $k$ 范围内的最大增长率。最终增长率以逆光穿越时间 $r_0/c$ 为单位，并四舍五入到六位小数。\n\n使用以下 $(\\Gamma,\\sigma,P)$ 值的测试套件：\n- 测试 1: $(\\Gamma,\\sigma,P) = (5.0, 0.01, 0.0)$\n- 测试 2: $(\\Gamma,\\sigma,P) = (2.0, 5.0, 0.0)$\n- 测试 3: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 0.0)$\n- 测试 4: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 10.0)$\n- 测试 5: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 0.0)$\n- 测试 6: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 10.0)$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[x1,x2,x3,x4,x5,x6]\"），其中每个条目是对应测试的最大 $\\omega_i$，按上述顺序排列，并四舍五入到六位小数。所有计算都必须在此处指定的归一化单位中进行，输出单位是逆光穿越时间 $r_0/c$。", "solution": "根据问题的任务，解决方案分为两部分：\n1. 物理模型方程的推导。\n2. 计算最大增长率的数值实现说明。\n\n**1. 推导与理论框架**\n\n该问题研究了平面切向不连续面的稳定性，这是对柱状喷流边界处薄剪切层的标准局部近似。我们考虑形式为 $e^{i(kz-\\omega t)}$ 的不可压缩、轴对称表面波扰动，其中 $k$ 是轴向波数，$\\omega$ 是复频率。$\\omega$ 的虚部 $\\omega_i = \\operatorname{Im}(\\omega)$ 代表了不稳定性的增长率。\n\n这类波的色散关系是通过线性化理想 RMHD 方程并在位移界面上施加总压力扰动连续性条件来找到的。对于磁场平行于流速的情况，问题陈述指出，得到的色散关系是一个关于 $\\omega$ 的二次方程：\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0\n$$\n此处，下标 $j=1$ 指喷流，$j=2$ 指环境介质。各项定义如下：\n- $I_j = w_j + b_j^2$ 是有效相对论惯性密度，其中 $w_j$ 是焓密度，$b_j^2$ 是共动磁能密度。\n- $v_j$ 是沿 $z$ 轴的整体流速。\n- $b_{z,j}^2$ 是共动轴向磁场的平方，它提供了一个可以抑制不稳定性的恢复磁张力。\n\n基态指定为：\n- 喷流 ($j=1$)：焓 $w_1 = 1$，洛伦兹因子 $\\Gamma_1 = \\Gamma$，因此速度 $v_1 = \\sqrt{1 - \\Gamma^{-2}}$。磁化强度为 $\\sigma \\equiv b_1^2/w_1 = b_1^2$，磁螺距为 $P = B_\\phi/(r_0 B_z)$，其中 $r_0=1$。这得出 $I_1 = 1 + \\sigma$。\n- 环境介质 ($j=2$)：焓 $w_2 = 1$，静态流 $v_2 = 0$，且无磁化，因此 $b_2^2=0$ 且 $b_{z,2}^2=0$。这得出 $I_2 = 1$。\n\n任务的一个关键部分是推导喷流的共动轴向磁场项 $b_{z,1}^2$ 的表达式。共动磁场分量通过洛伦兹变换与实验室坐标系分量 ($B_z, B_\\phi$) 相关。问题提供了相关公式：\n$b_1^2 = \\frac{B_z^2 + B_\\phi^2}{\\Gamma^2} + v_1^2 B_z^2$\n$b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2}$\n\n给定磁化强度 $\\sigma=b_1^2$ 和螺距 $P=B_\\phi/B_z$。将 $B_\\phi = P B_z$ 代入 $b_1^2$ 的表达式：\n$$\n\\sigma = b_1^2 = \\frac{B_z^2 + (P B_z)^2}{\\Gamma^2} + v_1^2 B_z^2 = B_z^2 \\left( \\frac{1+P^2}{\\Gamma^2} + v_1^2 \\right)\n$$\n解出 $B_z^2$ 得到：\n$$\nB_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2}\n$$\n这与问题中提供的中间表达式相匹配。现在，将其代入 $b_{z,1}^2$ 的公式：\n$$\nb_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2} = \\frac{1}{\\Gamma^2} \\left( \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2} \\right) = \\frac{\\sigma}{(1+P^2) + \\Gamma^2 v_1^2}\n$$\n使用相对论恒等式 $\\Gamma^2_j = (1-v_j^2)^{-1}$，我们有 $\\Gamma^2 v_1^2 = \\Gamma^2(1 - 1/\\Gamma^2) = \\Gamma^2 - 1$。将其代入分母：\n$$\nb_{z,1}^2 = \\frac{\\sigma}{(1+P^2) + (\\Gamma^2 - 1)} = \\frac{\\sigma}{P^2 + \\Gamma^2}\n$$\n这就完成了 $b_{z,1}^2$ 表达式的推导。\n\n接下来，我们求解不稳定性增长率 $\\omega_i$。二次方程 $A\\omega^2 + B\\omega + C = 0$ 的根是 $\\omega = (-B \\pm \\sqrt{B^2 - 4AC}) / (2A)$。当判别式 $D = B^2 - 4AC$ 为负时，会出现不稳定性，导致 $\\omega$ 有共轭复根。增长率则为 $\\omega_i = \\operatorname{Im}(\\omega) = \\sqrt{-D}/(2A) = \\sqrt{4AC - B^2}/(2A)$。\n从我们的色散关系中，我们确定系数：\n$A = I_1 + I_2$\n$B = -2k(I_1 v_1 + I_2 v_2)$\n$C = k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2)$\n\n$\\omega_i$ 的平方根下的项是 $4AC - B^2$：\n$$\n4AC - B^2 = 4(I_1+I_2)k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2) - [-2k(I_1 v_1 + I_2 v_2)]^2\n$$\n$$\n= 4k^2 \\left[ (I_1+I_2)(I_1 v_1^2 + I_2 v_2^2) - (I_1 v_1 + I_2 v_2)^2 - (I_1+I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]\n$$\n展开方括号中与速度相关的部分：\n$I_1^2 v_1^2 + I_1 I_2 v_2^2 + I_2 I_1 v_1^2 + I_2^2 v_2^2 - (I_1^2 v_1^2 + 2I_1 I_2 v_1 v_2 + I_2^2 v_2^2)$\n$= I_1 I_2 v_1^2 + I_1 I_2 v_2^2 - 2I_1 I_2 v_1 v_2 = I_1 I_2(v_1 - v_2)^2$\n因此，$4AC - B^2 = 4k^2 \\left[ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]$。\n增长率为：\n$$\n\\omega_i(k) = \\frac{\\sqrt{4AC - B^2}}{2A} = \\frac{2k \\sqrt{ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) }}{2(I_1 + I_2)}\n$$\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2} \\sqrt{I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2)}\n$$\n这与为理想、无限薄不连续面提供的增长率公式相匹配。\n\n最后，问题引入了一个启发式修正，以考虑有限的剪切层半厚度 $a$。这是通过认识到 KHI 是由速度剪切驱动的。对于与剪切层厚度相当或更短的波长 ($ka \\gtrsim 1$)，有效剪切会减小。这种效应通常通过将剪切驱动项 $(v_1 - v_2)^2$ 乘以一个随大 $k$ 值衰减的因子来建模。问题指定了一个标准选择，即 $\\tanh^2(ka)$。对于长波长 ($ka \\ll 1$)，该因子趋近于 1，对于短波长 ($ka \\gg 1$)，该因子趋近于 0，但其作用是减小大 $k$ 值下的驱动。修正后的增长率为：\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\n$$\n按照惯例，如果平方根下的表达式为负，则 $\\omega_i(k)=0$，表示在该波数下是稳定的。\n\n**2. 数值实现**\n\n为完成任务，我们必须实现一个程序，以找到在 $k$ 处于 $[0.01, 10.0]$ 范围内以及对于几组物理参数 $(\\Gamma, \\sigma, P)$ 的最大增长率 $\\omega_{i, \\text{max}} = \\max_k \\omega_i(k)$。\n每个测试用例的计算过程如下：\n1.  定义系统常量：$w_1=1$, $w_2=1$, $v_2=0$, $b_{z,2}^2=0$, 和 $a=0.1$。\n2.  对于一组给定的喷流参数 $(\\Gamma, \\sigma, P)$，计算导出的物理量：\n    - 喷流速度: $v_1 = \\sqrt{1 - \\Gamma^{-2}}$。\n    - 喷流惯性: $I_1 = 1 + \\sigma$。\n    - 环境介质惯性: $I_2 = 1$。\n    - 喷流的共动轴向磁场项: $b_{z,1}^2 = \\sigma / (P^2 + \\Gamma^2)$。\n3.  定义波数范围。例如，通过从 $k \\in [0.01, 10.0]$ 中均匀采样 20000 个点来创建一个精细的 $k$ 值网格。\n4.  对于网格中的每个 $k$，计算 $\\omega_i(k)$ 公式中平方根的参数：\n    $$ \\text{arg} = (1+\\sigma)(1)v_1^2 \\tanh^2(ak) - (1+\\sigma+1)b_{z,1}^2 $$\n5.  如果 $\\text{arg}  0$，则将增长率设为 $0$。否则，使用推导出的公式计算 $\\omega_i(k)$。\n6.  确定 $k$ 值网格上 $\\omega_i(k)$ 的最大值。\n7.  然后将此最大值四舍五入到六位小数。\n8.  对所有测试用例重复此过程，并将结果编译成一个逗号分隔的列表。\n\n这种数值方法能稳健地处理增长率存在内部最大值的可能性，以及在整个或部分指定 $k$ 范围内稳定的情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum Kelvin-Helmholtz instability growth rate\n    for a relativistic magnetized jet for a given set of parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (Gamma, sigma, P)\n    test_cases = [\n        (5.0, 0.01, 0.0),\n        (2.0, 5.0, 0.0),\n        (2.0, 2.3, 0.0),\n        (2.0, 2.3, 10.0),\n        (5.0, 0.5, 0.0),\n        (5.0, 0.5, 10.0),\n    ]\n\n    results = []\n    \n    # Static parameters\n    a = 0.1  # Shear-layer half-thickness\n    v2 = 0.0  # Ambient medium speed\n    I2 = 1.0  # Ambient medium inertia (w2=1, b2=0)\n    bz2_sq = 0.0 # Ambient medium magnetic tension term\n\n    # Wavenumber range for sweeping to find the maximum growth rate\n    k_values = np.linspace(0.01, 10.0, num=20000)\n\n    for case in test_cases:\n        Gamma, sigma, P = case\n        \n        # Calculate derived physical quantities for the jet\n        if Gamma == 1.0:\n            v1 = 0.0\n        else:\n            v1 = np.sqrt(1.0 - 1.0 / (Gamma**2))\n\n        I1 = 1.0 + sigma\n        bz1_sq = sigma / (P**2 + Gamma**2)\n        \n        # Define constants for the growth rate equation for clarity\n        #omega_i(k) = (k / (I1 + I2)) * sqrt(term_A * tanh^2(ka) - term_B)\n        term_A = I1 * I2 * (v1 - v2)**2\n        term_B = (I1 + I2) * (bz1_sq + bz2_sq)\n        \n        # Calculate the argument of the square root for all k values\n        tanh_ka_sq = np.tanh(k_values * a)**2\n        sqrt_arg = term_A * tanh_ka_sq - term_B\n        \n        # Instability exists only where the argument is positive.\n        # Set argument to 0 where it's negative.\n        sqrt_arg[sqrt_arg  0] = 0.0\n        \n        # Calculate the growth rate omega_i for all k\n        omega_i_k = (k_values / (I1 + I2)) * np.sqrt(sqrt_arg)\n        \n        # Find the maximum growth rate over the k range\n        max_omega_i = np.max(omega_i_k)\n        \n        results.append(f\"{max_omega_i:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3517935"}]}