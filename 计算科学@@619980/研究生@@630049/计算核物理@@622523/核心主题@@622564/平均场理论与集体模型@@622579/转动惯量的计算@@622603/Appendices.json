{"hands_on_practices": [{"introduction": "本练习将引导你进入转动惯量计算的核心——“摇摆模型”（cranking model）。通过在一个简化的单粒子系统中构建和对角化劳斯算符（Routhian），你将亲手验证一个源于费曼-海尔曼定理（Feynman-Hellmann theorem）的重要一致性关系，即动力学转动惯量 $J^{(2)}$ 可以通过两种等价的方式计算。这个实践不仅能加深你对摇摆模型基本原理的理解，也为你处理更复杂的多体问题奠定了坚实的计算基础。[@problem_id:3548296]", "problem": "考虑一个摇摆单粒子模型，其中单个核子占据一个截断的角动量子空间，其总角动量为 $j=\\frac{3}{2}$，磁亚能级为 $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。在自然单位制中进行计算，其中 $\\hbar=1$。设非摇转哈密顿量为一个对角矩阵 $H_0$，其能级能量为 $E_m$，这些能量唯象地模拟了静态平均场（例如，由四极形变引起的）。通过劳斯算符 (Routhian) $R(\\omega)=H_0-\\omega \\hat{J}_x$ 定义绕 $x$ 轴的摇摆，其中 $\\omega$ 是转动频率。本问题中使用的物理类能泛函定义为 $E(\\omega)\\equiv -\\langle R(\\omega)\\rangle$，它是在固定 $\\omega$ 时，在 $R(\\omega)$ 的最低能量本征态中计算的。\n\n您必须：\n- 在 $j=\\frac{3}{2}$ 子空间中，使用升降算符 $\\hat{J}_\\pm$ 构造角动量算符 $\\hat{J}_x$。其矩阵元为 $ \\langle j,m'|\\hat{J}_\\pm|j,m\\rangle = \\sqrt{j(j+1)-m(m\\pm 1)}\\,\\delta_{m',m\\pm 1}$，且 $\\hat{J}_x=\\frac{1}{2}\\left(\\hat{J}_+ + \\hat{J}_-\\right)$，其中 $\\hbar=1$。\n- 使用对角哈密顿量 $H_0=\\mathrm{diag}(E_{-3/2},E_{-1/2},E_{1/2},E_{3/2})$，其中 $E_{-3/2}=0.00~\\mathrm{MeV}$，$E_{-1/2}=0.85~\\mathrm{MeV}$，$E_{1/2}=1.70~\\mathrm{MeV}$ 以及 $E_{3/2}=2.80~\\mathrm{MeV}$。\n- 对于任意给定的 $\\omega$（单位为 $\\mathrm{MeV}$），计算 $R(\\omega)$ 的基态本征对 $\\left(\\lambda_{\\min}(\\omega),|\\psi(\\omega)\\rangle\\right)$，然后计算期望值 $\\langle \\hat{J}_x\\rangle(\\omega)=\\langle \\psi(\\omega)|\\hat{J}_x|\\psi(\\omega)\\rangle$ 和类能泛函 $E(\\omega)=-\\lambda_{\\min}(\\omega)$。\n- 使用步长为 $h$ 的对称有限差分来近似 $\\frac{\\partial \\langle \\hat{J}_x\\rangle}{\\partial \\omega}$：\n$$\n\\frac{\\partial \\langle \\hat{J}_x\\rangle}{\\partial \\omega}\\bigg|_{\\omega}\\approx \\frac{\\langle \\hat{J}_x\\rangle(\\omega+h)-\\langle \\hat{J}_x\\rangle(\\omega-h)}{2h},\n$$\n并用以下公式近似二阶导数 $\\frac{\\partial^2 E}{\\partial \\omega^2}$：\n$$\n\\frac{\\partial^2 E}{\\partial \\omega^2}\\bigg|_{\\omega}\\approx \\frac{E(\\omega+h)-2E(\\omega)+E(\\omega-h)}{h^2}.\n$$\n- 通过比较两种有限差分估计值，对指定的测试集数值验证自洽关系 $J^{(2)}(\\omega)=\\frac{\\partial \\langle \\hat{J}_x\\rangle}{\\partial \\omega}=\\frac{\\partial^2 E}{\\partial \\omega^2}$。\n\n使用以下 $(\\omega,h)$ 对的测试集（单位均为 $\\mathrm{MeV}$）：\n- $(\\omega,h)=\\left(0.00,10^{-3}\\right)$,\n- $(\\omega,h)=\\left(0.20,5\\times 10^{-3}\\right)$,\n- $(\\omega,h)=\\left(0.80,2\\times 10^{-3}\\right)$,\n- $(\\omega,h)=\\left(1.50,5\\times 10^{-3}\\right)$,\n- $(\\omega,h)=\\left(2.50,10^{-2}\\right)$.\n\n此外，包括两个用于探究数值稳定性的边界情况：\n- $(\\omega,h)=\\left(0.00,10^{-6}\\right)$,\n- $(\\omega,h)=\\left(2.00,5\\times 10^{-4}\\right)$.\n\n所有能量和频率都必须以 $\\mathrm{MeV}$ 为单位处理，而由于 $\\hbar=1$，所有角动量期望值都是无量纲的。对于每个测试用例，计算绝对差\n$$\n\\Delta(\\omega,h)=\\left|\\frac{\\partial \\langle \\hat{J}_x\\rangle}{\\partial \\omega}\\bigg|_{\\omega}-\\frac{\\partial^2 E}{\\partial \\omega^2}\\bigg|_{\\omega}\\right|\n$$\n并以 $\\varepsilon=10^{-6}$ 为容差，评估是否满足 $\\Delta(\\omega,h)  \\varepsilon$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个布尔值，并按上述顺序列出（例如，$[\\mathrm{True}, \\mathrm{False}, \\dots]$）。", "solution": "目标是在一个摇摆单粒子模型的框架内，数值验证关于动力学转动惯量的自洽关系 $J^{(2)}(\\omega) = \\frac{\\partial \\langle \\hat{J}_x \\rangle}{\\partial \\omega} = \\frac{\\partial^2 E}{\\partial \\omega^2}$。该验证将针对一个总角动量为 $j=\\frac{3}{2}$、处于截断角动量子空间中的单个核子进行。该过程涉及将相关的量子力学算符构造为矩阵，求解劳斯算符 (Routhian) 的本征值问题，然后使用有限差分来近似导数。\n\n首先，我们建立该物理系统的数学表示。单粒子态为 $|j, m\\rangle$，其中总角动量固定为 $j=\\frac{3}{2}$，磁量子数 $m$ 在集合 $\\left\\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\right\\}$ 中取值。这定义了一个 $4$ 维的希尔伯特空间。我们建立一个与 $m$ 递增相对应的有序基：\n$$\n|1\\rangle \\equiv |\\frac{3}{2}, -\\frac{3}{2}\\rangle, \\quad |2\\rangle \\equiv |\\frac{3}{2}, -\\frac{1}{2}\\rangle, \\quad |3\\rangle \\equiv |\\frac{3}{2}, \\frac{1}{2}\\rangle, \\quad |4\\rangle \\equiv |\\frac{3}{2}, \\frac{3}{2}\\rangle\n$$\n在此基中，非摇转哈密顿量 $H_0$ 是一个对角矩阵，其元素为给定的单粒子能量 $E_m$：\n$$\nH_0 = \\mathrm{diag}(E_{-3/2}, E_{-1/2}, E_{1/2}, E_{3/2}) = \\begin{pmatrix} 0.00  0  0  0 \\\\ 0  0.85  0  0 \\\\ 0  0  1.70  0 \\\\ 0  0  0  2.80 \\end{pmatrix} \\, \\mathrm{MeV}\n$$\n\n接下来，我们构造角动量算符 $\\hat{J}_x$ 的矩阵。这是通过升降算符 $\\hat{J}_+$ 和 $\\hat{J}_-$ 完成的，因为 $\\hat{J}_x = \\frac{1}{2}(\\hat{J}_+ + \\hat{J}_-)$。在 $|j,m\\rangle$ 基中 $\\hat{J}_\\pm$ 的矩阵元由以下公式给出（其中 $\\hbar=1$）：\n$$\n\\langle j,m'|\\hat{J}_\\pm|j,m\\rangle = \\sqrt{j(j+1)-m(m\\pm 1)}\\,\\delta_{m',m\\pm 1}\n$$\n对于 $j=\\frac{3}{2}$，项 $j(j+1) = \\frac{15}{4}$。$\\hat{J}_+$ 的非零矩阵元为：\n- $\\langle \\frac{3}{2}, -\\frac{1}{2} | \\hat{J}_+ | \\frac{3}{2}, -\\frac{3}{2} \\rangle = \\sqrt{\\frac{15}{4} - (-\\frac{3}{2})(-\\frac{1}{2})} = \\sqrt{3}$\n- $\\langle \\frac{3}{2}, \\frac{1}{2} | \\hat{J}_+ | \\frac{3}{2}, -\\frac{1}{2} \\rangle = \\sqrt{\\frac{15}{4} - (-\\frac{1}{2})(\\frac{1}{2})} = 2$\n- $\\langle \\frac{3}{2}, \\frac{3}{2} | \\hat{J}_+ | \\frac{3}{2}, \\frac{1}{2} \\rangle = \\sqrt{\\frac{15}{4} - (\\frac{1}{2})(\\frac{3}{2})} = \\sqrt{3}$\n\n这给出了 $\\hat{J}_+$ 在我们有序基中的矩阵表示。算符 $\\hat{J}_-$ 是其厄米共轭，即 $\\hat{J}_- = (\\hat{J}_+)^\\dagger$。\n$$\nJ_+ = \\begin{pmatrix} 0  0  0  0 \\\\ \\sqrt{3}  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  \\sqrt{3}  0 \\end{pmatrix}, \\quad J_- = \\begin{pmatrix} 0  \\sqrt{3}  0  0 \\\\ 0  0  2  0 \\\\ 0  0  0  \\sqrt{3} \\\\ 0  0  0  0 \\end{pmatrix}\n$$\n那么 $\\hat{J}_x$ 的矩阵为：\n$$\nJ_x = \\frac{1}{2}(J_+ + J_-) = \\frac{1}{2} \\begin{pmatrix}\n0  \\sqrt{3}  0  0 \\\\\n\\sqrt{3}  0  2  0 \\\\\n0  2  0  \\sqrt{3} \\\\\n0  0  \\sqrt{3}  0\n\\end{pmatrix}\n$$\n系统在转动下的动力学由劳斯算符 $R(\\omega) = H_0 - \\omega \\hat{J}_x$ 描述。对于给定的转动频率 $\\omega$，我们求解劳斯算符的不含时薛定谔方程，$R(\\omega)|\\psi(\\omega)\\rangle = \\lambda(\\omega)|\\psi(\\omega)\\rangle$。我们关心的是基态，它对应于最低本征值 $\\lambda_{\\min}(\\omega)$ 及其相关的本征矢 $|\\psi(\\omega)\\rangle$。\n\n物理类能泛函为 $E(\\omega) = -\\langle R(\\omega) \\rangle$。对于一个本征态，这简化为 $E(\\omega) = -\\lambda(\\omega)$。因此，对于基态，$E(\\omega) = -\\lambda_{\\min}(\\omega)$。角动量的期望值为 $\\langle \\hat{J}_x \\rangle (\\omega) = \\langle \\psi(\\omega) | \\hat{J}_x | \\psi(\\omega) \\rangle$。\n\n待验证的关系式 $\\frac{\\partial \\langle \\hat{J}_x \\rangle}{\\partial \\omega} = \\frac{\\partial^2 E}{\\partial \\omega^2}$ 是 Feynman-Hellmann 定理的一个推论。将该定理应用于劳斯算符的本征值 $\\lambda_{\\min}(\\omega)$（对参数 $\\omega$ 求导），可得 $\\frac{\\partial \\lambda_{\\min}}{\\partial \\omega} = \\langle \\psi(\\omega) | \\frac{\\partial R}{\\partial \\omega} | \\psi(\\omega) \\rangle = \\langle \\psi(\\omega) | (-\\hat{J}_x) | \\psi(\\omega) \\rangle = -\\langle \\hat{J}_x \\rangle(\\omega)$。因为 $E(\\omega) = -\\lambda_{\\min}(\\omega)$，我们有 $\\frac{\\partial E}{\\partial \\omega} = \\langle \\hat{J}_x \\rangle(\\omega)$。对 $\\omega$ 再求一次导数即可得到所需恒等式。\n\n对于测试集中的每个 $(\\omega,h)$ 对，数值算法按以下步骤进行：\n1.  定义一个函数，对于任意输入频率 $\\omega'$，构造 $4 \\times 4$ 的实对称矩阵 $R(\\omega') = H_0 - \\omega' J_x$。\n2.  数值对角化 $R(\\omega')$ 以获得其本征值和本征矢。标准数值库为此提供了稳健的方法。我们确定最低的本征值 $\\lambda_{\\min}(\\omega')$ 和对应的本征矢 $|\\psi(\\omega')\\rangle$。\n3.  计算两个我们感兴趣的量：$E(\\omega') = -\\lambda_{\\min}(\\omega')$ 和 $\\langle \\hat{J}_x \\rangle (\\omega') = \\langle \\psi(\\omega') | J_x | \\psi(\\omega') \\rangle$。\n4.  对所需的三个频率点 $\\omega$、$\\omega+h$ 和 $\\omega-h$ 应用此函数。\n5.  使用计算出的值来计算两个有限差分近似：\n    $$\n    \\frac{\\partial \\langle \\hat{J}_x\\rangle}{\\partial \\omega}\\bigg|_{\\omega}\\approx \\frac{\\langle \\hat{J}_x\\rangle(\\omega+h)-\\langle \\hat{J}_x\\rangle(\\omega-h)}{2h}\n    $$\n    $$\n    \\frac{\\partial^2 E}{\\partial \\omega^2}\\bigg|_{\\omega}\\approx \\frac{E(\\omega+h)-2E(\\omega)+E(\\omega-h)}{h^2}\n    $$\n6.  计算这两个近似值之间的绝对差 $\\Delta(\\omega,h)$。\n7.  将 $\\Delta(\\omega,h)$ 与容差 $\\varepsilon = 10^{-6}$ 进行比较，以确定该关系式在数值上是否成立。结果是一个布尔值。\n\n将此程序系统地应用于所有测试用例，生成的布尔值列表构成最终答案。使用双精度浮点数对于达到所需的精度至关重要，特别是对于较小的步长 $h$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cranked single-particle model problem by numerically verifying\n    the consistency relation J^(2)(omega) = d", "id": "3548296"}, {"introduction": "现代核物理的研究前沿之一是处理弱束缚和非束缚核态，这要求我们将理论框架从标准的厄米量子力学扩展到包含共振态（Gamow states）的非厄米系统。本练习将引导你使用复数对称哈密顿量来模拟这些效应，并量化连续谱耦合对原子核转动响应的具体影响。通过这个实践，你将学习到一种前沿的计算方法，并深入理解连续谱在核结构物理中的重要作用。[@problem_id:3548279]", "problem": "要求您设计并实现一个计算实验，以区分连续谱和共振 (Gamow) 贡献如何改变弱束缚核系统中的转动响应，并因此影响转动惯量的计算。\n\n使用的出发点和模型假设：\n- 在有限基中，定态薛定谔方程写作 $H(\\omega)\\,| \\psi(\\omega) \\rangle = \\lambda(\\omega)\\,| \\psi(\\omega) \\rangle$，其中 $H(\\omega)$ 是微观哈密顿量的有限维矩阵表示，$| \\psi(\\omega) \\rangle$ 是右本征矢量，$\\lambda(\\omega)$ 是对应的本征值。\n- 接近粒子发射阈的弱束缚核由一组有限的分立态建模。束缚态被赋予实数能量，而共振态则由具有复数能量 $E = E_r - i \\Gamma/2$ 的 Gamow 态表示，当使用出射波边界条件时，会产生一个复对称哈密顿量。这种方法捕捉了连续谱耦合和粒子衰变宽度。\n- 通过一个与角动量投影算符 $\\hat{J}_x$ 线性耦合的摇摆场引入转动，从而产生一个哈密顿量族 $H(\\omega)$，它线性依赖于一个具有能量单位的小摇摆频率参数 $\\omega$，这与 $\\hbar = 1$ 的核物理自然单位制相符。\n\n在非厄米（复对称）情况下的期望值：\n- 对于复对称矩阵，合适的双正交内积是复对称 c-积。如果 $H$ 是复对称的，其左本征矢量可以取为右本征矢量的转置。对于任意算符 $\\hat{O}$ 和态 $| \\psi \\rangle$，期望值的计算公式为 $\\langle \\hat{O} \\rangle = \\dfrac{\\langle \\psi| \\hat{O} | \\psi \\rangle_c}{\\langle \\psi | \\psi \\rangle_c}$，其中 c-积定义为 $\\langle \\phi | \\psi \\rangle_c \\equiv \\phi^{\\mathsf{T}} \\psi$。\n\n你的任务：\n1. 考虑 $H(\\omega) = D - \\omega J_x$，其中 $D = \\mathrm{diag}(E_1,E_2,\\dots,E_N)$ 是态能量的对角矩阵，$J_x$ 是所选基中 $\\hat{J}_x$ 的实对称矩阵表示。\n2. 对于下面的每个测试用例，计算 $H(\\omega)$ 在两个小值 $\\omega = +\\delta$ 和 $\\omega = -\\delta$（其中 $\\delta = 1\\times 10^{-3} \\, \\mathrm{MeV}$）下的类基态（即本征值实部最小的本征态）。\n3. 对于这两个 $\\omega$ 值，使用适用于 Gamow 基的复对称 c-积来评估期望值 $\\langle \\hat{J}_x \\rangle_{\\omega}$。\n4. 通过对称有限差分法，数值推断在 $\\omega=0$ 时的线性转动响应系数 $C$。$C$ 定义为 $\\langle \\hat{J}_x \\rangle_{\\omega}$ 实部在零摇摆频率处的斜率。使用 $\\omega=\\pm \\delta$ 的值显式计算 $C$。\n5. 为一个基准情况重复步骤 2-4，在该基准中，所有能量都被其纯实部替换（即所有宽度都设置为零，以消除连续谱衰变效应），从而得出 $C_{\\mathrm{real\\_only}}$。\n6. 通过计算每个测试用例的 $\\Delta C = C_{\\mathrm{complex}} - C_{\\mathrm{real\\_only}}$ 来量化由复数能量贡献引起的变化。报告实数值 $\\Delta C$。\n7. 最终结果以 $\\mathrm{MeV}^{-1}$ 为单位表示，并四舍五入到六位小数。\n\n测试套件（所有能量单位均为 $\\mathrm{MeV}$；矩阵维度与态的数量匹配）：\n- 情况 A（仅束缚态基准）：\n  - 能量： $E = \\left[ -2.0,\\,-1.0 \\right]$.\n  - 算符： $J_x = \\begin{pmatrix} 0.0  0.5 \\\\ 0.5  0.0 \\end{pmatrix}$。\n- 情况 B（一个窄共振态）：\n  - 能量： $E = \\left[ -2.0,\\,-1.0,\\,1.5 - i\\,0.1 \\right]$.\n  - 算符： $J_x = \\begin{pmatrix} 0.0  0.5  0.3 \\\\ 0.5  0.0  0.2 \\\\ 0.3  0.2  0.0 \\end{pmatrix}$。\n- 情况 C（一个宽共振态）：\n  - 能量： $E = \\left[ -2.0,\\,-1.5,\\,4.0 - i\\,0.8 \\right]$.\n  - 算符： $J_x = \\begin{pmatrix} 0.0  0.4  0.25 \\\\ 0.4  0.0  0.35 \\\\ 0.25  0.35  0.0 \\end{pmatrix}$。\n- 情况 D（近阈弱束缚态和多个共振态）：\n  - 能量： $E = \\left[ -0.05,\\,0.7 - i\\,0.05,\\,2.0 - i\\,0.5 \\right]$.\n  - 算符： $J_x = \\begin{pmatrix} 0.0  0.6  0.2 \\\\ 0.6  0.0  0.4 \\\\ 0.2  0.4  0.0 \\end{pmatrix}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按 A、B、C、D 的顺序给出测试用例的结果。每个条目必须是实数值 $\\Delta C$，单位为 $\\mathrm{MeV}^{-1}$，并四舍五入到六位小数。例如，输出应类似于 $[\\mathrm{0.000123},\\mathrm{0.001234},\\mathrm{0.000987},\\mathrm{0.000456}]$（这仅为示例；请根据上述模型计算实际值）。", "solution": "该问题要求设计并执行一个计算实验，以量化由复数 Gamow 态能量所代表的连续谱耦合对弱束缚核系统转动响应的影响。转动响应由线性响应系数 $C$ 来表征，该系数与转动惯量有关。目标是计算使用复数能量计算的响应系数 ($C_{\\mathrm{complex}}$) 与仅使用这些能量的实部计算的基准响应系数 ($C_{\\mathrm{real\\_only}}$) 之间的差值 $\\Delta C$。\n\n理论框架是描述旋转系统在有限、非厄米（复对称）基中的定态薛定谔方程。转动效应通过摇摆模型引入。\n\n系统的哈密顿量是摇摆频率 $\\omega$ 的函数：\n$$\nH(\\omega) = D - \\omega J_x\n$$\n此处，$D$ 是一个对角矩阵，$D = \\mathrm{diag}(E_1, E_2, \\dots, E_N)$，其元素 $E_k$ 是基态的能量。对于束缚态，这些能量可以是实数；对于共振 (Gamow) 态，这些能量可以是复数，其中复数能量 $E_k = E_{r,k} - i\\Gamma_k/2$ 表示一个能量为 $E_{r,k}$、衰变宽度为 $\\Gamma_k$ 的共振态。矩阵 $J_x$ 是角动量投影算符 $\\hat{J}_x$ 的实对称表示。参数 $\\omega$ 是一个具有能量单位的小实数。由于 $D$ 可以是复数而 $J_x$ 是实对称的，总哈密顿量 $H(\\omega)$ 是一个复对称矩阵，即 $H(\\omega) = H(\\omega)^{\\mathsf{T}}$。\n\n计算的核心在于求解该哈密顿量在两个小的对称摇摆频率 $\\omega = +\\delta$ 和 $\\omega = -\\delta$（其中 $\\delta = 1 \\times 10^{-3} \\, \\mathrm{MeV}$）下的本征值问题：\n$$\nH(\\omega) \\, | \\psi_j(\\omega) \\rangle = \\lambda_j(\\omega) \\, | \\psi_j(\\omega) \\rangle\n$$\n这将得到一组本征值 $\\lambda_j(\\omega)$ 和对应的右本征矢量 $|\\psi_j(\\omega)\\rangle$。我们关心的是“类基态”，它被定义为本征值 $\\lambda(\\omega)$ 实部最小的那个本征态。该态是无转动系统的绝热延拓基态。\n\n对于复对称哈密顿量，标准的厄米内积是不适用的。我们转而使用双正交或复对称 (c-) 积。一个算符 $\\hat{O}$ 对于态 $|\\psi\\rangle$ 的期望值由以下公式给出：\n$$\n\\langle \\hat{O} \\rangle = \\frac{\\langle \\psi | \\hat{O} | \\psi \\rangle_c}{\\langle \\psi | \\psi \\rangle_c}\n$$\n其中 c-积定义为 $\\langle \\phi | \\psi \\rangle_c \\equiv \\phi^{\\mathsf{T}} \\psi$。这里，$\\phi^{\\mathsf{T}}$ 是列矢量 $\\phi$ 的转置。在计算上，如果 $\\psi$ 是一个列矢量，这可以转换为 $\\psi^{\\mathsf{T}} O \\psi / (\\psi^{\\mathsf{T}} \\psi)$。\n\n利用类基态的本征矢量，我们计算在 $\\omega = +\\delta$ 和 $\\omega = -\\delta$ 时的角动量期望值 $\\langle J_x \\rangle_{\\omega}$。\n\n线性转动响应系数 $C$ 定义为角动量期望值的实部相对于摇摆频率的变化率，在 $\\omega=0$ 处进行求值：\n$$\nC = \\left. \\frac{d}{d\\omega} \\mathrm{Re} \\left( \\langle J_x \\rangle_{\\omega} \\right) \\right|_{\\omega=0}\n$$\n我们使用对称有限差分格式对该导数进行数值近似，该方法提供了一个二阶精确的近似：\n$$\nC \\approx \\frac{\\mathrm{Re}(\\langle J_x \\rangle_{+\\delta}) - \\mathrm{Re}(\\langle J_x \\rangle_{-\\delta})}{(+\\delta) - (-\\delta)} = \\frac{\\mathrm{Re}(\\langle J_x \\rangle_{+\\delta}) - \\mathrm{Re}(\\langle J_x \\rangle_{-\\delta})}{2\\delta}\n$$\n\n为了区分连续谱的效应，我们对每个测试用例执行两次此计算：\n1.  **复数计算**：我们使用全套复数能量 $E_k$ 来构造 $D$，得到一个复对称的 $H(\\omega)$。上述过程得出系数 $C_{\\mathrm{complex}}$。\n2.  **纯实数基准**：我们通过将所有衰变宽度 $\\Gamma_k$ 设置为零来创建一个基准哈密顿量。这是通过仅取能量的实部 $E_{k,\\mathrm{real}} = \\mathrm{Re}(E_k)$ 来构造一个实对角矩阵 $D_{\\mathrm{real}}$ 实现的。由此产生的哈密顿量 $H_{\\mathrm{real\\_only}}(\\omega) = D_{\\mathrm{real}} - \\omega J_x$ 是实对称的。同样的过程得出系数 $C_{\\mathrm{real\\_only}}$。\n\n我们最终关心的量是这两个系数之间的差值，它量化了仅由衰变宽度的存在引起的转动响应变化：\n$$\n\\Delta C = C_{\\mathrm{complex}} - C_{\\mathrm{real\\_only}}\n$$\n\n每个测试用例的算法如下：\n1.  定义能量列表 $E$ 和矩阵 $J_x$。\n2.  定义 $\\delta = 1 \\times 10^{-3}$。\n3.  计算 $C_{\\mathrm{complex}}$：\n    a. 构造 $D = \\mathrm{diag}(E)$。\n    b. 求解 $H(+\\delta) = D - \\delta J_x$ 和 $H(-\\delta) = D + \\delta J_x$ 的本征问题。\n    c. 对于每个情况，找到对应于最小实部本征值的本征矢量。\n    d. 使用 c-积计算 $\\langle J_x \\rangle_{+\\delta}$ 和 $\\langle J_x \\rangle_{-\\delta}$。\n    e. 使用有限差分公式计算 $C_{\\mathrm{complex}}$。\n4.  计算 $C_{\\mathrm{real\\_only}}$：\n    a. 构造 $E_{\\mathrm{real}} = \\mathrm{Re}(E)$。\n    b. 使用 $E_{\\mathrm{real}}$ 重复步骤 3 以找到 $C_{\\mathrm{real\\_only}}$。\n5.  计算 $\\Delta C = C_{\\mathrm{complex}} - C_{\\mathrm{real\\_only}}$。\n6.  每个测试用例的最终结果是 $\\Delta C$，以 $\\mathrm{MeV}^{-1}$ 为单位报告，并四舍五入到六位小数。\n\n该过程将为所提供的四个测试用例中的每一个实施。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the computational nuclear physics problem.\n    It iterates through the test cases, calculates the change in the\n    rotational response coefficient (Delta C), and prints the results.\n    \"\"\"\n\n    def calculate_response_coefficient(energies, Jx, delta):\n        \"\"\"\n        Calculates the linear rotational response coefficient C.\n\n        Args:\n            energies (list or np.ndarray): A list of state energies (can be complex).\n            Jx (np.ndarray): The matrix representation of the Jx operator.\n            delta (float): The small cranking frequency value.\n\n        Returns:\n            float: The calculated response coefficient C.\n        \"\"\"\n        # Ensure energies are of complex type for consistent calculations.\n        D = np.diag(np.asarray(energies, dtype=complex))\n\n        # --- Calculation for omega = +delta ---\n        H_plus = D - delta * Jx\n        # Solve the eigenvalue problem for the complex-symmetric Hamiltonian.\n        eigvals_p, eigvecs_p = np.linalg.eig(H_plus)\n        # Identify the ground-like state (minimum real part of eigenvalue).\n        idx_p = np.argmin(np.real(eigvals_p))\n        psi_p = eigvecs_p[:, idx_p]\n        # Compute the expectation value using the c-product.\n        # psi_p is a 1D array, so @ is dot product.\n        j_exp_p = (psi_p @ Jx @ psi_p) / (psi_p @ psi_p)\n\n        # --- Calculation for omega = -delta ---\n        H_minus = D + delta * Jx\n        eigvals_m, eigvecs_m = np.linalg.eig(H_minus)\n        idx_m = np.argmin(np.real(eigvals_m))\n        psi_m = eigvecs_m[:, idx_m]\n        j_exp_m = (psi_m @ Jx @ psi_m) / (psi_m @ psi_m)\n\n        # Compute C using a symmetric finite difference formula.\n        C = (np.real(j_exp_p) - np.real(j_exp_m)) / (2.0 * delta)\n        return C\n\n    # Define the cranking frequency delta.\n    delta = 1.0e-3  # in MeV\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (bound-only baseline)\n        {\n            \"E\": [-2.0, -1.0],\n            \"Jx\": np.array([[0.0, 0.5], [0.5, 0.0]])\n        },\n        # Case B (one narrow resonance)\n        {\n            \"E\": [-2.0, -1.0, 1.5 - 0.1j],\n            \"Jx\": np.array([[0.0, 0.5, 0.3], [0.5, 0.0, 0.2], [0.3, 0.2, 0.0]])\n        },\n        # Case C (one broad resonance)\n        {\n            \"E\": [-2.0, -1.5, 4.0 - 0.8j],\n            \"Jx\": np.array([[0.0, 0.4, 0.25], [0.4, 0.0, 0.35], [0.25, 0.35, 0.0]])\n        },\n        # Case D (near-threshold weakly bound state and multiple resonances)\n        {\n            \"E\": [-0.05, 0.7 - 0.05j, 2.0 - 0.5j],\n            \"Jx\": np.array([[0.0, 0.6, 0.2], [0.6, 0.0, 0.4], [0.2, 0.4, 0.0]])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        Jx = case[\"Jx\"]\n\n        # 1. Calculate the response coefficient with complex energies.\n        C_complex = calculate_response_coefficient(E, Jx, delta)\n\n        # 2. Calculate the baseline response coefficient with real-only energies.\n        E_real_only = np.real(np.asarray(E))\n        C_real_only = calculate_response_coefficient(E_real_only, Jx, delta)\n\n        # 3. Compute the difference to isolate the continuum contribution.\n        delta_C = C_complex - C_real_only\n        results.append(delta_C)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3548279"}]}