{"hands_on_practices": [{"introduction": "Hartree-Fock-Bogoliubov理论的核心在于对角化Bogoliubov-de Gennes (BdG) 哈密顿量，从而找到准粒子基。这个过程的关键是，从粒子表象到准粒子表象的Bogoliubov变换必须是正则的，以保持费米子反对易关系。此练习 [@problem_id:3595364] 将指导你为一个一维模型构建BdG矩阵，通过数值对角化得到变换矩阵 $U$ 和 $V$，并验证它们是否满足作为正则变换基础的正交归一性约束。", "problem": "考虑一个 Hartree–Fock–Bogoliubov 框架下的离散一维核平均场模型，其中通过 Bogoliubov–de Gennes (BdG) 形式引入了对关联。正则费米子算符满足正则反对易关系 $ \\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij} $ 以及 $ \\{ \\hat{c}_i, \\hat{c}_j \\} = \\{ \\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger \\} = 0 $。在 Nambu 空间中，该平均场哈密顿量可以表示为一个厄米 BdG 矩阵，作用于一个由粒子和空穴分量组成的 $ 2N $ 维矢量，其中 $ N $ 是空间格点的数量。BdG 哈密顿量由一个维度为 $ N \\times N $ 的单粒子矩阵 $ h $ 和一个维度为 $ N \\times N $ 的对力场矩阵 $ \\Delta $ 构成，其中 $ h $ 和 $ \\Delta $ 均为实对称矩阵。Bogoliubov 变换通过一个线性变换将原始算符 $ \\hat{c}_i $ 和 $ \\hat{c}_i^\\dagger $ 映射到准粒子算符 $ \\hat{\\gamma}_k $ 和 $ \\hat{\\gamma}_k^\\dagger $，该线性变换的矩阵 $ U $ 和 $ V $ 的列向量源自 BdG 哈密顿量的正能本征矢量。保持正则反对易关系不变，对 $ U $ 和 $ V $ 施加了正交归一性约束，您的程序必须验证这些约束。\n\n从这些基本定义出发，编写一个程序来完成以下任务：\n- 为每个指定的测试用例构建 $ h $ 和 $ \\Delta $。\n- 使用 $ h $ 和 $ \\Delta $ 组装维度为 $ 2N \\times 2N $ 的 BdG 哈密顿量。\n- 对角化 BdG 哈密顿量，选取与严格正本征值相关的 $ N $ 个本征矢量，并将每个选定的本征矢量分解为粒子（$ U $）和空穴（$ V $）分量，从而构成矩阵 $ U \\in \\mathbb{R}^{N \\times N} $ 和 $ V \\in \\mathbb{R}^{N \\times N} $。\n- 通过检查 $ U^\\dagger U + V^\\dagger V $ 是否等于单位矩阵以及 $ U^T V + V^T U $ 是否等于零矩阵来验证 Bogoliubov 正交归一性约束，数值容差为 $ 10^{-10} $，以逐项绝对偏差的最大值衡量。\n- 对于每个测试用例，返回一个布尔值，指示两个正交归一性约束是否在指定的容差范围内都成立。\n\n对 $ h $ 使用开放边界条件，包含最近邻动能跳跃项和在位项。具体来说，对于每个具有参数 $ (N, t, \\mu, V) $ 的测试用例，按如下方式构建 $ h $：\n- $ h_{ii} = 2t + V_i - \\mu $，其中 $ i = 0, 1, \\dots, N-1 $，\n- $ h_{i,i+1} = h_{i+1,i} = -t $，其中 $ i = 0, 1, \\dots, N-2 $，\n- 所有其他矩阵元均为 $ 0 $。\n确保 $ \\Delta $ 是如下所述的实对称矩阵。\n\n测试套件：\n提供四个测试用例，每个用例由 $ (N, t, \\mu, V, \\Delta) $ 指定：\n1. 具有恒定对的通用情况：\n   - $ N = 8 $，$ t = 1.0 $，$ \\mu = 0.2 $，对所有 $ i $，$ V_i = 0 $，\n   - $ \\Delta = \\delta_0 I $，其中 $ \\delta_0 = 0.5 $。\n2. 具有高斯分布的空间关联对：\n   - $ N = 6 $，$ t = 1.2 $，$ \\mu = -0.4 $，对所有 $ i $，$ V_i = 0 $，\n   - $ \\Delta_{ij} = \\delta_0 \\exp\\!\\left(-\\dfrac{(i-j)^2}{2\\sigma^2}\\right) $，其中 $ \\delta_0 = 0.3 $，$ \\sigma = 1.5 $，对于 $ i,j \\in \\{0,1,\\dots,N-1\\} $。\n3. 无对的边界情况：\n   - $ N = 4 $，$ t = 0.8 $，$ \\mu = 0.1 $，对所有 $ i $，$ V_i = 0 $，\n   - $ \\Delta = 0 $（零矩阵）。\n4. 具有弱对的小系统：\n   - $ N = 2 $，$ t = 1.0 $，$ \\mu = 0.0 $，$ V_0 = 0.1 $，$ V_1 = -0.1 $，\n   - $ \\Delta = \\delta_0 I $，其中 $ \\delta_0 = 0.2 $。\n\n算法要求：\n- 使用精确的算术运算和双精度浮点类型。\n- 使用适用于实对称矩阵的本征值求解器。\n- 在选择正能本征矢量时，使用严格标准 $ E > 0 $；假设给定的参数避免了精确的零能简并。\n\n输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$ [\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4] $），其中每个 $ \\text{result}_k $ 是对应于第 $ k $ 个测试用例的布尔值，表示两个正交归一性约束是否都在 $ 10^{-10} $ 的容差内得到满足。", "solution": "该计算任务基于 Hartree–Fock–Bogoliubov 平均场理论，通过将单粒子描述扩展到 Nambu 空间来引入对关联。基本算符 $ \\hat{c}_i $ 和 $ \\hat{c}_i^\\dagger $ 遵循 $ \\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij} $，其他情况则为零，这是正则费米子代数。在存在对的情况下，平均场哈密顿量变为二次型，并可以在 Nambu 空间中表示为一个作用于长度为 $ 2N $ 的矢量 $ \\Psi = \\begin{pmatrix} u \\\\ v \\end{pmatrix} $ 上的厄米矩阵，其中 $ u \\in \\mathbb{R}^N $ 和 $ v \\in \\mathbb{R}^N $ 表示与格点相关的粒子和空穴分量。\n\n对于实对称的 $ h $ 和实对称的 $ \\Delta $，Bogoliubov–de Gennes (BdG) 哈密顿量具有块形式\n$$\n\\mathcal{H}_{\\mathrm{BdG}} = \n\\begin{pmatrix}\nh  \\Delta \\\\\n\\Delta  -h^T\n\\end{pmatrix},\n$$\n当 $ h = h^T $ 且 $ \\Delta = \\Delta^T $ 时，该矩阵是厄米矩阵（实对称矩阵）。对角化 $ \\mathcal{H}_{\\mathrm{BdG}} $ 得到满足 $ \\mathcal{H}_{\\mathrm{BdG}} \\Psi_k = E_k \\Psi_k $ 的本征对 $ (E_k, \\Psi_k) $，由于粒子-空穴对称性，本征值以 $ \\pm $ 对的形式出现。每个本征矢量可以分解为 $ \\Psi_k = \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix} $，其中 $ u_k \\in \\mathbb{R}^N $ 且 $ v_k \\in \\mathbb{R}^N $。对于 $ E_k > 0 $，列向量 $ u_k $ 和 $ v_k $ 构成了维度为 $ N \\times N $ 的 Bogoliubov 变换矩阵 $ U = [u_1, \\dots, u_N] $ 和 $ V = [v_1, \\dots, v_N] $。\n\nBogoliubov 变换通过以下方式将原始费米子算符映射到准粒子算符：\n$$\n\\hat{\\gamma}_k = \\sum_{i=1}^{N} U_{ik} \\hat{c}_i + V_{ik} \\hat{c}_i^\\dagger,\n\\quad\n\\hat{\\gamma}_k^\\dagger = \\sum_{i=1}^{N} U_{ik} \\hat{c}_i^\\dagger + V_{ik} \\hat{c}_i,\n$$\n这必须保持正则反对易关系不变。保持不变的要求施加了正交归一性约束\n$$\nU^\\dagger U + V^\\dagger V = I_N,\n\\quad\nU^T V + V^T U = 0_{N \\times N},\n$$\n这些约束是通过强制要求对所有 $ k, k' $ 都满足 $ \\{ \\hat{\\gamma}_k, \\hat{\\gamma}_{k'}^\\dagger \\} = \\delta_{kk'} $ 和 $ \\{ \\hat{\\gamma}_k, \\hat{\\gamma}_{k'} \\} = 0 $ 而得出的。这些约束可以通过直接代入并利用费米子算符的双线性和反对易性来推导。\n\n算法上，步骤如下：\n1. 根据给定的 $ N $、$ t $、$ \\mu $ 和 $ V $，在开放边界条件下构建 $ h $。具体来说，对于 $ i = 0, 1, \\dots, N-1 $，设置 $ h_{ii} = 2t + V_i - \\mu $；对于 $ i = 0, 1, \\dots, N-2 $，设置 $ h_{i,i+1} = h_{i+1,i} = -t $；并将所有其他矩阵元设置为 $ 0 $。这是一维网格上动能加局域势和化学势移动的标准有限差分表示。\n2. 根据测试用例规范构建 $ \\Delta $，确保 $ \\Delta $ 是实对称矩阵：\n   - 对于恒定对，使用 $ \\Delta = \\delta_0 I_N $。\n   - 对于高斯空间关联，使用 $ \\Delta_{ij} = \\delta_0 \\exp\\!\\left(-\\dfrac{(i-j)^2}{2\\sigma^2}\\right) $，其中 $ i,j \\in \\{0,\\dots,N-1\\} $。\n   - 对于无对的边界情况，设置 $ \\Delta = 0_{N \\times N} $。\n3. 将大小为 $ 2N \\times 2N $ 的 BdG 矩阵 $ \\mathcal{H}_{\\mathrm{BdG}} $ 构建为如上所示的块矩阵。\n4. 使用实对称矩阵的本征值求解器计算所有本征对 $ (E_k, \\Psi_k) $。将本征值按升序排序，并选择具有严格正本征值 $ E_k > 0 $ 的 $ N $ 个本征矢量；测试参数的选择是为了避免精确的零能简并。\n5. 将选定的本征矢量分解为粒子和空穴分量，以组装成 $ N \\times N $ 矩阵 $ U $ 和 $ V $。\n6. 通过计算以下各项来验证正交归一性约束：\n   - $ R_1 = U^\\dagger U + V^\\dagger V - I_N $，\n   - $ R_2 = U^T V + V^T U $，\n   并评估逐项绝对偏差的最大值 $ \\max_{i,j} |(R_1)_{ij}| $ 和 $ \\max_{i,j} |(R_2)_{ij}| $。如果两个偏差都小于或等于容差 $ 10^{-10} $，则宣布该测试用例成功。\n7. 输出单行文本，其中包含一个方括号括起来的、由逗号分隔的四个布尔值列表，对应四个测试用例，每个布尔值表示两个正交归一性检查是否都在容差范围内通过。\n\n通过对 $ h $ 使用标准的类紧束缚离散化方法和物理上合理的对称对力场 $ \\Delta $，确保了科学真实性。程序的结果是可量化的：对于每个测试用例，布尔值反映了 Bogoliubov 变换所要求的​​基本正交归一性约束是否在数值容差内成立。测试套件涵盖了具有均匀对的通用情况、空间关联对的情况、零对的边界情况以及具有弱对的小系统，以探究数值稳定性和边界行为。最终输出是所需格式的单行文本 $ [\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4] $。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_h(N, t, mu, V=None):\n    \"\"\"Construct the single-particle Hamiltonian h with open boundary conditions.\"\"\"\n    h = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        vi = 0.0 if V is None else V[i]\n        h[i, i] = 2.0 * t + vi - mu\n        if i + 1  N:\n            h[i, i + 1] = -t\n            h[i + 1, i] = -t\n    return h\n\ndef build_delta_constant(N, delta0):\n    \"\"\"Construct a constant pairing field: Delta = delta0 * I.\"\"\"\n    return np.eye(N, dtype=float) * delta0\n\ndef build_delta_gaussian(N, delta0, sigma):\n    \"\"\"Construct a Gaussian-correlated pairing field: Delta_ij = delta0 * exp(-(i-j)^2/(2*sigma^2)).\"\"\"\n    idx = np.arange(N)\n    ii, jj = np.meshgrid(idx, idx, indexing='ij')\n    Delta = delta0 * np.exp(-((ii - jj) ** 2) / (2.0 * sigma ** 2))\n    # Ensure exact symmetry in case of floating rounding (though it's symmetric by construction).\n    Delta = 0.5 * (Delta + Delta.T)\n    return Delta\n\ndef build_bdg(h, Delta):\n    \"\"\"Construct the BdG Hamiltonian matrix.\"\"\"\n    upper = np.hstack((h, Delta))\n    lower = np.hstack((Delta, -h.T))\n    H = np.vstack((upper, lower))\n    return H\n\ndef extract_U_V_from_bdg(H, N, eps=1e-12):\n    \"\"\"Diagonalize BdG, select positive-energy eigenvectors, and extract U, V.\"\"\"\n    # eigh for symmetric matrices\n    evals, evecs = np.linalg.eigh(H)\n    # Strictly positive eigenvalues\n    pos_idx = np.where(evals > eps)[0]\n    if len(pos_idx)  N:\n        # As a fallback (should not happen for provided test cases), include zeros if needed.\n        pos_idx = np.where(evals >= 0.0)[0][:N]\n    else:\n        # Take the lowest N positive energies to avoid accidental oversubscription\n        # (in general there should be exactly N)\n        pos_idx = pos_idx[:N]\n    U = evecs[:N, pos_idx]\n    V = evecs[N:, pos_idx]\n    return U, V\n\ndef check_orthonormality(U, V, tol=1e-10):\n    \"\"\"Check U^\\dagger U + V^\\dagger V = I and U^T V + V^T U = 0 within tolerance.\"\"\"\n    N = U.shape[0]\n    I = np.eye(N, dtype=float)\n    # Use conjugates to allow complex generalization; here matrices are real.\n    R1 = U.conj().T @ U + V.conj().T @ V - I\n    R2 = U.T @ V + V.T @ U\n    max_abs_R1 = np.max(np.abs(R1))\n    max_abs_R2 = np.max(np.abs(R2))\n    return (max_abs_R1 = tol) and (max_abs_R2 = tol)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: N=8, t=1.0, mu=0.2, V_i=0, Delta=0.5*I\n        {\"N\": 8, \"t\": 1.0, \"mu\": 0.2, \"V\": np.zeros(8, dtype=float),\n         \"Delta_fn\": lambda N: build_delta_constant(N, 0.5)},\n        # Case 2: N=6, t=1.2, mu=-0.4, V_i=0, Delta Gaussian with delta0=0.3, sigma=1.5\n        {\"N\": 6, \"t\": 1.2, \"mu\": -0.4, \"V\": np.zeros(6, dtype=float),\n         \"Delta_fn\": lambda N: build_delta_gaussian(N, 0.3, 1.5)},\n        # Case 3: N=4, t=0.8, mu=0.1, V_i=0, Delta=0\n        {\"N\": 4, \"t\": 0.8, \"mu\": 0.1, \"V\": np.zeros(4, dtype=float),\n         \"Delta_fn\": lambda N: np.zeros((N, N), dtype=float)},\n        # Case 4: N=2, t=1.0, mu=0.0, V=[0.1, -0.1], Delta=0.2*I\n        {\"N\": 2, \"t\": 1.0, \"mu\": 0.0, \"V\": np.array([0.1, -0.1], dtype=float),\n         \"Delta_fn\": lambda N: build_delta_constant(N, 0.2)},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        t = case[\"t\"]\n        mu = case[\"mu\"]\n        V = case[\"V\"]\n        Delta = case[\"Delta_fn\"](N)\n        h = build_h(N, t, mu, V)\n        H_bdg = build_bdg(h, Delta)\n        U, Vmat = extract_U_V_from_bdg(H_bdg, N)\n        ok = check_orthonormality(U, Vmat, tol=1e-10)\n        results.append(ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3595364"}, {"introduction": "Bogoliubov变换不仅是一个数学工具，更是描述超导和原子核超流等物理现象的强大理论。一个经典应用是研究转动原子核的性质，其中科里奥利力倾向于将核子的角动量与转动轴对齐，这与将核子耦合形成角动量为零的配对相互作用相竞争。通过求解自洽的摇摆BCS方程，你将在本次练习 [@problem_id:3595314] 中观察到转动如何引发能级交叉并导致配对能隙的减小，这一现象被称为“科里奥利反配对”。这个实践将展示如何运用该理论框架来模拟和理解量子多体系统中的复杂物理现象。", "problem": "您将从第一性原理出发，为一个示意性的偶数粒子系统，在正则对基下实现一个小规模的Hartree-Fock-Bogoliubov (HFB) 计算。其目标是构建与Bogoliubov准粒子真空相关的广义密度矩阵 $\\mathcal{R}$，并数值验证其幂等性。单体场将通过一个简化的类Skyrme单粒子哈密顿量来建模，该哈密顿量包含一个局域的、依赖于密度的平均场；而配对场将在Bardeen–Cooper–Schrieffer (BCS) 极限下使用一种依赖于密度的接触形式。该实现不应依赖任何预先存在的、可以简化推导过程的HFB或BCS公式；相反，它必须从正则费米子反对易关系以及Bogoliubov变换作为保持这些关系的线性正则变换的定义出发。以此为基础，推导准粒子真空如何决定正常密度和反常密度，并证明广义密度矩阵为何是一个投影算子。\n\n用作基本基础的定义和建模假设：\n- 正则费米子反对易关系：对于费米子产生和湮灭算符 $\\hat{c}_i^\\dagger$ 和 $\\hat{c}_i$，有 $\\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij}$ 和 $\\{ \\hat{c}_i, \\hat{c}_j \\} = \\{ \\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger \\} = 0$。\n- Bogoliubov变换是一种保持正则反对易关系的算符线性变换 $(\\hat{c}, \\hat{c}^\\dagger) \\mapsto (\\hat{\\beta}, \\hat{\\beta}^\\dagger)$。\n- 广义密度矩阵由作为准粒子真空期望值构建的正常密度和反常密度定义，在零温下，HFB准粒子真空意味着 $\\mathcal{R}$ 的幂等性。\n\n用于构建输入单粒子哈密顿量和配对场的计算模型：\n- 考虑一个偶数 $N$ 个单粒子态，它们被分组成 $N/2$ 个时间反演对，标记为 $p \\in \\{0, \\dots, N/2 - 1\\}$。每对 $p$ 由具有相同单粒子动能 $\\varepsilon^{\\mathrm{kin}}_p$ 的态 $(p,\\bar{p})$ 组成。\n- 为每对 $p$ 定义一个类Skyrme局域平均场移位，使用简化的密度依赖关系 $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$，其中 $\\rho_p$ 是一个密度的局域代理，由初始的Hartree-Fock阶跃函数占据数构建：$\\rho_p = w_p \\, \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$，其中权重为 $w_p \\in [0,1]$，化学势为 $\\mu$。所有量均为无量纲。\n- 在此正则对基中，单粒子哈密顿量是对角的，其能级为 $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$，对于 $(p,\\bar{p})$ 对中的两个态是相同的。\n- 对每对 $p$ 使用一个依赖于密度的接触配对振幅，形式为 $\\Delta_p = |V_0| \\left(1 - \\eta \\, \\rho_p/\\rho_0 \\right)$，参数为 $V_0 \\le 0$，$\\eta \\in [0,1]$，以及一个参考密度 $\\rho_0 > 0$；为保证数值稳定性，将 $\\Delta_p \\ge 0$ 视为一个大小。在正则基中，将反常配对张量构建为一个反对称矩阵，耦合每个时间反演对：$\\kappa_{p,\\bar{p}} = -\\kappa_{\\bar{p},p}$，所有其他元素为零。\n\n需要完成的任务：\n- 从正则反对易关系和保持这些关系的Bogoliubov变换的定义出发，推导在零温准粒子真空下，广义密度矩阵 $\\mathcal{R}$ 用正常密度 $\\rho$ 和反常密度 $\\kappa$ 表示的结构。证明当Bogoliubov变换是正则的时，$\\mathcal{R}$ 是一个投影算子，即 $\\mathcal{R}^2 = \\mathcal{R}$。\n- 将问题特化到正则对基，其中单粒子哈密顿量是对角的，并且时间反演态之间存在反对称配对。展示如何通过对角化每对的 $2 \\times 2$ HFB 块得到实数振幅 $u_p$ 和 $v_p$（满足 $u_p^2 + v_p^2 = 1$），并用这些振幅表示每对的 $\\rho$ 和 $\\kappa$，而无需引入任何未经证明的简化公式。\n- 实现一个程序，对于给定的测试套件，构建 $\\rho$、$\\kappa$、 $2N \\times 2N$ 的广义密度矩阵\n$$\n\\mathcal{R} = \\begin{pmatrix}\n\\rho  \\kappa \\\\\n-\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast\n\\end{pmatrix},\n$$\n并使用Frobenius范数计算幂等性破缺的数值度量\n$$\n\\|\\mathcal{R}^2 - \\mathcal{R}\\|_{\\mathrm{F}} = \\sqrt{\\sum_{i,j} \\left| \\left( \\mathcal{R}^2 - \\mathcal{R} \\right)_{ij} \\right|^2 }.\n$$\n- 所有量均为无量纲；本问题不使用物理单位。\n\n需要实现的算法细节：\n- 对于每个测试用例，给定 $\\{\\varepsilon^{\\mathrm{kin}}_p\\}_{p=0}^{N/2-1}$、$\\{w_p\\}$、$\\mu$、$t_0$、$t_3$、$\\alpha$、$V_0$、$\\eta$ 和 $\\rho_0$：\n    - 计算 $\\rho_p = w_p \\, \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$ 和 $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$。\n    - 设置 $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$ 和 $\\xi_p = \\varepsilon_p - \\mu$。\n    - 计算 $\\Delta_p = |V_0| (1 - \\eta \\rho_p/\\rho_0)$，其中 $\\Delta_p \\ge 0$。\n    - 求解 $2 \\times 2$ 的HFB对块以获得满足 $u_p^2 + v_p^2 = 1$ 的实数 $u_p$ 和 $v_p$。\n    - 构建对角矩阵 $\\rho$，其对角元对于 $(p,\\bar{p})$ 对中的两个态均为 $v_p^2$；构建反对称矩阵 $\\kappa$，其中 $\\kappa_{p,\\bar{p}} = u_p v_p$ 且 $\\kappa_{\\bar{p},p} = -u_p v_p$。\n    - 组装 $\\mathcal{R}$ 并计算 $\\|\\mathcal{R}^2 - \\mathcal{R}\\|_{\\mathrm{F}}$。\n\n用于评估不同方面的测试套件：\n- 情况 A（具有有限配对的一般情况）：\n    - $N = 4$（即 $N/2 = 2$ 对），\n    - $\\varepsilon^{\\mathrm{kin}}_p = [-3.0, -1.0]$,\n    - $w_p = [0.9, 0.6]$,\n    - $\\mu = -1.5$,\n    - $t_0 = -2.0$, $t_3 = 1.2$, $\\alpha = 0.5$,\n    - $V_0 = -1.6$, $\\eta = 0.7$, $\\rho_0 = 1.0$.\n- 情况 B（配对为零的边界情况）：\n    - 与情况 A 相同，但 $V_0 = 0.0$。\n- 情况 C（更大的系统和不同的密度依赖性）：\n    - $N = 6$（即 $N/2 = 3$ 对），\n    - $\\varepsilon^{\\mathrm{kin}}_p = [-2.2, -1.2, -0.2]$,\n    - $w_p = [0.5, 0.4, 0.3]$,\n    - $\\mu = -0.8$,\n    - $t_0 = -3.0$, $t_3 = 1.1$, $\\alpha = 1.0$,\n    - $V_0 = -2.0$, $\\eta = 0.5$, $\\rho_0 = 1.0$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个情况的结果，格式为方括号内由逗号分隔的浮点数列表，例如 $[x_1,x_2,x_3]$，其中 $x_i = \\|\\mathcal{R}^2 - \\mathcal{R}\\|_{\\mathrm{F}}$ 对应于相应的情况。", "solution": "该问题陈述是量子多体物理学中，特别是在Hartree-Fock-Bogoliubov (HFB) 框架内的一个有效理论和计算练习。它具有科学依据，问题设定良好，客观且内部一致。我们将开始解答，解答包括两个主要部分：按要求从第一性原理进行的理论推导，以及为验证推导属性而进行的数值实现。\n\n### 第1部分：理论推导\n\n#### 1.1 Bogoliubov变换和广义密度矩阵\n\n我们从一组由 $i$ 索引的单粒子态的费米子产生 ($\\hat{c}_i^\\dagger$) 和湮灭 ($\\hat{c}_i$) 算符的基本反对易关系开始：\n$$\n\\{ \\hat{c}_i, \\hat{c}_j^\\dagger \\} = \\delta_{ij}, \\quad \\{ \\hat{c}_i, \\hat{c}_j \\} = 0, \\quad \\{ \\hat{c}_i^\\dagger, \\hat{c}_j^\\dagger \\} = 0\n$$\nBogoliubov变换将一组新的费米子算符，即准粒子算符 ($\\hat{\\beta}_k^\\dagger, \\hat{\\beta}_k$)，定义为原始粒子算符的线性组合。为使此变换是正则的，准粒子算符必须满足相同的反对易关系：\n$$\n\\{ \\hat{\\beta}_k, \\hat{\\beta}_l^\\dagger \\} = \\delta_{kl}, \\quad \\{ \\hat{\\beta}_k, \\hat{\\beta}_l \\} = 0, \\quad \\{ \\hat{\\beta}_k^\\dagger, \\hat{\\beta}_l^\\dagger \\} = 0\n$$\n这种线性变换的一般形式可以写成：\n$$\n\\hat{\\beta}_k = \\sum_i (U_{ik}^* \\hat{c}_i + V_{ik}^* \\hat{c}_i^\\dagger)\n$$\n其中 $U$ 和 $V$ 是复数矩阵。逆变换将粒子算符用准粒子算符表示：\n$$\n\\hat{c}_i = \\sum_k (U_{ik} \\hat{\\beta}_k + V_{ik}^* \\hat{\\beta}_k^\\dagger)\n$$\n在零温下的HFB基态，记作 $|\\Phi_0\\rangle$，被定义为准粒子的真空态：\n$$\n\\hat{\\beta}_k |\\Phi_0\\rangle = 0 \\quad \\forall k\n$$\n这意味着 $\\langle \\Phi_0 | \\hat{\\beta}_k^\\dagger = 0$。\n\n系统在基态下的性质被编码在广义密度矩阵 $\\mathcal{R}$ 中。$\\mathcal{R}$ 的分量是正常密度矩阵 $\\rho$ 和反常密度矩阵（或配对张量）$\\kappa$，它们被定义为在准粒子真空中的期望值：\n$$\n\\rho_{ij} = \\langle \\Phi_0 | \\hat{c}_j^\\dagger \\hat{c}_i | \\Phi_0 \\rangle\n$$\n$$\n\\kappa_{ij} = \\langle \\Phi_0 | \\hat{c}_j \\hat{c}_i | \\Phi_0 \\rangle\n$$\n我们可以通过代入Bogoliubov逆变换来推导 $\\rho$ 和 $\\kappa$ 的表达式。对于正常密度 $\\rho_{ij}$：\n$$\n\\rho_{ij} = \\langle \\Phi_0 | \\left( \\sum_l U_{jl}^* \\hat{\\beta}_l^\\dagger + V_{jl} \\hat{\\beta}_l \\right) \\left( \\sum_k U_{ik} \\hat{\\beta}_k + V_{ik}^* \\hat{\\beta}_k^\\dagger \\right) | \\Phi_0 \\rangle\n$$\n由于准粒子真空条件，唯一非零的贡献来自于准粒子被 $\\hat{\\beta}_k^\\dagger$ 产生后立即被 $\\hat{\\beta}_l$ 湮灭的项。这发生在项 $\\langle\\Phi_0|\\sum_{l,k}V_{jl}\\hat{\\beta}_l V_{ik}^*\\hat{\\beta}_k^\\dagger|\\Phi_0\\rangle$ 中。使用 $\\langle \\Phi_0 | \\hat{\\beta}_l \\hat{\\beta}_k^\\dagger | \\Phi_0 \\rangle = \\delta_{lk}$，我们得到：\n$$\n\\rho_{ij} = \\sum_k V_{ik}^* V_{jl} = (V V^\\dagger)_{ij} \\implies \\rho = V V^\\dagger\n$$\n类似地，对于反常密度 $\\kappa_{ij}$：\n$$\n\\kappa_{ij} = \\langle \\Phi_0 | \\left( \\sum_l U_{jl} \\hat{\\beta}_l + V_{jl}^* \\hat{\\beta}_l^\\dagger \\right) \\left( \\sum_k U_{ik} \\hat{\\beta}_k + V_{ik}^* \\hat{\\beta}_k^\\dagger \\right) | \\Phi_0 \\rangle\n$$\n非零项是 $\\langle\\Phi_0|\\sum_{l,k}U_{jl}\\hat{\\beta}_l V_{ik}^*\\hat{\\beta}_k^\\dagger|\\Phi_0\\rangle$。这得出：\n$$\n\\kappa_{ij} = \\sum_k U_{jk} V_{ik}^* = (V^\\dagger U)_{ji} \\implies \\kappa = (V^\\dagger U)^T = U^T V^*\n$$\n\n矩阵 $U$ 和 $V$ 不是任意的；它们必须满足确保变换正则性的条件。这些条件是 $U^\\dagger U + V^\\dagger V = \\mathbb{I}$ 和 $U^T V + V^T U = 0$（对于指定的 $\\kappa$ 为反对称的情况）。从逆变换中，也可以得到 $UU^\\dagger + VV^\\dagger = \\mathbb{I}$ 和 $UV^T + VU^T = 0$。\n\n广义密度矩阵由下式给出：\n$$\n\\mathcal{R} = \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix}\n$$\n为了证明 $\\mathcal{R}$ 是一个投影算子，即 $\\mathcal{R}^2 = \\mathcal{R}$，我们计算它的平方：\n$$\n\\mathcal{R}^2 = \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix} \\begin{pmatrix} \\rho  \\kappa \\\\ -\\kappa^\\ast  \\mathbb{I} - \\rho^\\ast \\end{pmatrix} = \\begin{pmatrix} \\rho^2 - \\kappa \\kappa^\\ast  \\rho \\kappa - \\kappa \\rho^\\ast + \\kappa \\\\ -\\kappa^\\ast \\rho - (\\mathbb{I} - \\rho^\\ast)\\kappa^\\ast  -\\kappa^\\ast \\kappa + (\\mathbb{I}-\\rho^\\ast)^2 \\end{pmatrix}\n$$\n使用从正则条件推导出的关系（例如，$UU^\\dagger + VV^\\dagger = \\mathbb{I}$ 和 $\\kappa = U V^\\dagger$，这可以被普遍证明）。然而，特化到问题的正则对基提供了一个更简单和直接的证明。\n\n#### 1.2 特化到正则对基\n\n该问题定义了一个时间反演对 $(p, \\bar{p})$ 的正则基。对于每一对，Bogoliubov变换采用简化的实数形式：\n$$\n\\hat{\\beta}_p = u_p \\hat{c}_p - v_p \\hat{c}_{\\bar{p}}^\\dagger\n$$\n$$\n\\hat{\\beta}_{\\bar{p}} = u_p \\hat{c}_{\\bar{p}} + v_p \\hat{c}_p^\\dagger\n$$\n其中实系数 $u_p, v_p$ 满足 $u_p^2 + v_p^2 = 1$。这确保了正则性。逆关系是：\n$$\n\\hat{c}_p = u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger\n$$\n$$\n\\hat{c}_{\\bar{p}} = u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger\n$$\n我们现在计算这对在准粒子真空中的密度矩阵元。唯一非零的单粒子期望值是占据几率：\n$$\n\\rho_{pp} = \\langle \\Phi_0 | \\hat{c}_p^\\dagger \\hat{c}_p | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_p^\\dagger + v_p \\hat{\\beta}_{\\bar{p}}) (u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger) | \\Phi_0 \\rangle = v_p^2 \\langle \\Phi_0 | \\hat{\\beta}_{\\bar{p}} \\hat{\\beta}_{\\bar{p}}^\\dagger | \\Phi_0 \\rangle = v_p^2\n$$\n$$\n\\rho_{\\bar{p}\\bar{p}} = \\langle \\Phi_0 | \\hat{c}_{\\bar{p}}^\\dagger \\hat{c}_{\\bar{p}} | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_{\\bar{p}}^\\dagger - v_p \\hat{\\beta}_p) (u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger) | \\Phi_0 \\rangle = v_p^2 \\langle \\Phi_0 | \\hat{\\beta}_p \\hat{\\beta}_p^\\dagger | \\Phi_0 \\rangle = v_p^2\n$$\n所有非对角元 $\\rho_{p\\bar{p}}$ 均为零。\n对于反常密度：\n$$\n\\kappa_{p\\bar{p}} = \\langle \\Phi_0 | \\hat{c}_{\\bar{p}} \\hat{c}_p | \\Phi_0 \\rangle = \\langle \\Phi_0 | (u_p \\hat{\\beta}_{\\bar{p}} - v_p \\hat{\\beta}_p^\\dagger) (u_p \\hat{\\beta}_p + v_p \\hat{\\beta}_{\\bar{p}}^\\dagger) | \\Phi_0 \\rangle = u_p v_p \\langle \\Phi_0 | \\hat{\\beta}_{\\bar{p}} \\hat{\\beta}_{\\bar{p}}^\\dagger | \\Phi_0 \\rangle = u_p v_p\n$$\n由于反对易关系，$\\kappa_{\\bar{p}p} = \\langle \\Phi_0 | \\hat{c}_p \\hat{c}_{\\bar{p}} | \\Phi_0 \\rangle = - \\kappa_{p\\bar{p}} = -u_p v_p$。所有其他元素如 $\\kappa_{pp}$ 均为零。这些结果与问题中指定的构造相匹配。\n\n系数 $u_p$ 和 $v_p$ 通过求解HFB方程确定，对于这种简单的对结构，这简化为对角化一个代表该对的BCS问题的 $2 \\times 2$ 矩阵：\n$$\n\\begin{pmatrix} \\xi_p  \\Delta_p \\\\ \\Delta_p  -\\xi_p \\end{pmatrix} \\begin{pmatrix} u_p \\\\ -v_p \\end{pmatrix} = E_p \\begin{pmatrix} u_p \\\\ -v_p \\end{pmatrix}\n$$\n准粒子能量为 $E_p = \\sqrt{\\xi_p^2 + \\Delta_p^2}$，系数由下式给出：\n$$\nu_p^2 = \\frac{1}{2}\\left(1 + \\frac{\\xi_p}{E_p}\\right), \\quad v_p^2 = \\frac{1}{2}\\left(1 - \\frac{\\xi_p}{E_p}\\right)\n$$\n其中 $E_p$ 取正根。\n\n完整的矩阵 $\\rho$ 和 $\\kappa$ 是块对角矩阵，由每对的块组成。总的广义密度矩阵 $\\mathcal{R}$ 也是块对角的，由每个对 $p$ 的 $4 \\times 4$ 块组成。对于单个对，在粒子指标的基 $(p, \\bar{p})$ 中，$\\mathcal{R}$ 块是：\n$$\n\\mathcal{R}^{(p)} = \\begin{pmatrix} \\rho^{(p)}  \\kappa^{(p)} \\\\ -(\\kappa^{(p)})^*  \\mathbb{I} - (\\rho^{(p)})^* \\end{pmatrix} = \\begin{pmatrix} v_p^2  0  0  u_p v_p \\\\ 0  v_p^2  -u_p v_p  0 \\\\ 0  u_p v_p  1-v_p^2  0 \\\\ -u_p v_p  0  0  1-v_p^2 \\end{pmatrix}\n$$\n由于 $u_p^2+v_p^2=1$，我们有 $1-v_p^2 = u_p^2$。该矩阵可以置换成两个独立的 $2 \\times 2$ 块：\n$$\n\\text{块 1: } \\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}, \\quad \\text{块 2: } \\begin{pmatrix} v_p^2  -u_p v_p \\\\ -u_p v_p  u_p^2 \\end{pmatrix}\n$$\n我们可以验证块1的幂等性：\n$$\n\\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}^2 = \\begin{pmatrix} v_p^4+u_p^2v_p^2  u_p v_p^3+u_p^3v_p \\\\ u_p v_p^3+u_p^3v_p  u_p^2v_p^2+u_p^4 \\end{pmatrix} = \\begin{pmatrix} v_p^2(v_p^2+u_p^2)  u_p v_p(v_p^2+u_p^2) \\\\ u_p v_p(v_p^2+u_p^2)  u_p^2(v_p^2+u_p^2) \\end{pmatrix} = \\begin{pmatrix} v_p^2  u_p v_p \\\\ u_p v_p  u_p^2 \\end{pmatrix}\n$$\n块2也同样成立。由于 $\\mathcal{R}$ 的每个块都是幂等的，所以整个矩阵 $\\mathcal{R}$ 也是幂等的。下面的数值实现将验证这一性质。\n\n### 第2部分：算法实现\n\n对于每个测试用例，算法按以下步骤进行：\n1.  读取模型的输入参数：$N$, $\\{\\varepsilon^{\\mathrm{kin}}_p\\}$, $\\{w_p\\}$, $\\mu$, $t_0$, $t_3$, $\\alpha$, $V_0$, $\\eta$, $\\rho_0$。\n2.  从 $0$ 到 $N/2-1$ 遍历每个时间反演对 $p$。\n3.  计算局域密度代理 $\\rho_p = w_p \\cdot \\theta(\\mu - \\varepsilon^{\\mathrm{kin}}_p)$，其中 $\\theta$ 是Heaviside阶跃函数。\n4.  计算平均场移位 $U_p = t_0 \\rho_p + \\frac{1}{2} t_3 \\rho_p^{\\alpha + 1}$。\n5.  确定单粒子能量 $\\varepsilon_p = \\varepsilon^{\\mathrm{kin}}_p + U_p$，并通过化学势进行移位得到 $\\xi_p = \\varepsilon_p - \\mu$。\n6.  计算配对能隙 $\\Delta_p = |V_0| (1 - \\eta \\rho_p / \\rho_0)$。\n7.  求解Bogoliubov振幅。首先，找到准粒子能量 $E_p = \\sqrt{\\xi_p^2 + \\Delta_p^2}$。通过设置 $\\xi_p/E_p=0$（对应于 $v_p^2=0.5$）来谨慎处理 $E_p=0$ 的情况。\n8.  从 $E_p$ 和 $\\xi_p$ 计算 $v_p^2 = \\frac{1}{2} (1 - \\xi_p/E_p)$ 和 $u_p v_p = \\Delta_p / (2 E_p)$。\n9.  构建 $N \\times N$ 的矩阵 $\\rho$ 和 $\\kappa$。对于每对 $p$，$\\rho$ 的相应对角元被设置为 $v_p^2$，而 $\\kappa$ 的非对角块则用 $\\pm u_p v_p$ 填充。\n10. 组装 $2N \\times 2N$ 的广义密度矩阵 $\\mathcal{R}$。\n11. 计算平方矩阵 $\\mathcal{R}^2$ 和差分矩阵 $\\mathcal{D} = \\mathcal{R}^2 - \\mathcal{R}$。\n12. 计算Frobenius范数 $\\|\\mathcal{D}\\|_{\\mathrm{F}}$，它量化了幂等性的破缺程度。这个值应该接近于机器精度零。", "answer": "```python\nimport numpy as np\n\ndef calculate_idempotency_violation(case_params):\n    \"\"\"\n    Performs a small-scale HFB computation and verifies idempotency of the\n    generalized density matrix.\n    \"\"\"\n    N = case_params[\"N\"]\n    eps_kin = np.array(case_params[\"eps_kin_p\"])\n    w_p = np.array(case_params[\"w_p\"])\n    mu = case_params[\"mu\"]\n    t0 = case_params[\"t0\"]\n    t3 = case_params[\"t3\"]\n    alpha = case_params[\"alpha\"]\n    V0 = case_params[\"V0\"]\n    eta = case_params[\"eta\"]\n    rho0 = case_params[\"rho0\"]\n    \n    N_pairs = N // 2\n    \n    vp_sq_vals = np.zeros(N_pairs)\n    up_vp_vals = np.zeros(N_pairs)\n    \n    for p in range(N_pairs):\n        # Step 1: Compute local density proxy\n        theta = 1.0 if mu > eps_kin[p] else 0.0\n        rho_p_val = w_p[p] * theta\n        \n        # Step 2: Compute mean-field shift and s.p. energies\n        Up = t0 * rho_p_val + 0.5 * t3 * rho_p_val**(alpha + 1)\n        eps_p = eps_kin[p] + Up\n        xi_p = eps_p - mu\n        \n        # Step 3: Compute pairing gap\n        Delta_p = np.abs(V0) * (1 - eta * rho_p_val / rho0)\n        \n        # Step 4: Solve for Bogoliubov amplitudes\n        E_p_sq = xi_p**2 + Delta_p**2\n        \n        if E_p_sq  1e-16: # Handle potential division by zero\n            E_p = 0.0\n        else:\n            E_p = np.sqrt(E_p_sq)\n            \n        if E_p == 0.0:\n            # If E_p is zero, xi_p and Delta_p must be zero.\n            # This corresponds to the Fermi level in a non-interacting system.\n            # The occupancy v_p^2 is ill-defined from the formula but physically is 0.5\n            # however the problem is usually set up to avoid this ambiguity.\n            # In the limit xi_p -> 0, v_p^2 -> 0.5.\n            vp_sq = 0.5\n            # Since Delta_p is zero, u_p*v_p is zero.\n            up_vp = 0.0\n        else:\n            vp_sq = 0.5 * (1 - xi_p / E_p)\n            up_vp = Delta_p / (2.0 * E_p)\n            \n        vp_sq_vals[p] = vp_sq\n        up_vp_vals[p] = up_vp\n\n    # Step 5: Build rho and kappa matrices\n    rho = np.zeros((N, N))\n    kappa = np.zeros((N, N))\n    \n    for p in range(N_pairs):\n        i1 = 2 * p\n        i2 = 2 * p + 1\n        \n        # Normal density (diagonal)\n        rho[i1, i1] = vp_sq_vals[p]\n        rho[i2, i2] = vp_sq_vals[p]\n        \n        # Anomalous density (antisymmetric)\n        kappa[i1, i2] = up_vp_vals[p]\n        kappa[i2, i1] = -up_vp_vals[p]\n        \n    # Step 6: Assemble the generalized density matrix R\n    R = np.zeros((2 * N, 2 * N))\n    I_N = np.eye(N)\n    \n    R[:N, :N] = rho\n    R[:N, N:] = kappa\n    R[N:, :N] = -kappa  # kappa is real\n    R[N:, N:] = I_N - rho # rho is real\n    \n    # Step 7: Compute idempotency violation\n    R_squared = R @ R\n    diff = R_squared - R\n    \n    # Use Frobenius norm\n    frob_norm = np.linalg.norm(diff, 'fro')\n    \n    return frob_norm\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: General case with finite pairing\n        {\n            \"N\": 4, \"eps_kin_p\": [-3.0, -1.0], \"w_p\": [0.9, 0.6],\n            \"mu\": -1.5, \"t0\": -2.0, \"t3\": 1.2, \"alpha\": 0.5,\n            \"V0\": -1.6, \"eta\": 0.7, \"rho0\": 1.0\n        },\n        # Case B: Edge case with zero pairing\n        {\n            \"N\": 4, \"eps_kin_p\": [-3.0, -1.0], \"w_p\": [0.9, 0.6],\n            \"mu\": -1.5, \"t0\": -2.0, \"t3\": 1.2, \"alpha\": 0.5,\n            \"V0\": 0.0, \"eta\": 0.7, \"rho0\": 1.0\n        },\n        # Case C: Larger system and different density dependence\n        {\n            \"N\": 6, \"eps_kin_p\": [-2.2, -1.2, -0.2], \"w_p\": [0.5, 0.4, 0.3],\n            \"mu\": -0.8, \"t0\": -3.0, \"t3\": 1.1, \"alpha\": 1.0,\n            \"V0\": -2.0, \"eta\": 0.5, \"rho0\": 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_idempotency_violation(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "3595314"}, {"introduction": "Bogoliubov变换不仅是一个数学工具，更是描述超导和原子核超流等物理现象的强大理论。一个经典应用是研究转动原子核的性质，其中科里奥利力倾向于将核子的角动量与转动轴对齐，这与将核子耦合形成角动量为零的配对相互作用相竞争。通过求解自洽的摇摆BCS方程，你将在本次练习 [@problem_id:3595326] 中观察到转动如何引发能级交叉并导致配对能隙的减小，这一现象被称为“科里奥利反配对”。这个实践将展示如何运用该理论框架来模拟和理解量子多体系统中的复杂物理现象。", "problem": "考虑一个在计算核物理中用于研究科里奥利力诱导的对破裂的摇转、常数配对玩具模型。在零温下工作，并采用旋转坐标系平均场方法，在该方法中，对于一组由 $k$ 索引的分立单粒子轨道，多体哈密顿量被一个带有旋转摇转项的 Bardeen-Cooper-Schrieffer (BCS) 准粒子图像所近似。使用的单位制中，普朗克常数 $\\hbar$ 设为 $1$，因此角频率具有能量单位。假设存在一个实的、均匀的配对能隙 $\\Delta(\\omega)$ 和一个化学势 $\\lambda(\\omega)$，它们在每个旋转频率 $\\omega$ 下通过粒子数约束自洽地确定。对于每个轨道 $k$，其非旋转能量为 $\\epsilon_k^{(0)}$，排齐的角动量投影为 $j_k$，将旋转坐标系单粒子能量（劳斯量）定义为 $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$。Bardeen-Cooper-Schrieffer (BCS) Bogoliubov 振幅 $u_k(\\omega)$ 和 $v_k(\\omega)$ 必须通过对每个 $k$ 的 $2 \\times 2$ Bogoliubov-de Gennes 矩阵进行对角化，并实施粒子数和能隙的自洽方程来获得。\n\n仅从以下基本出发点开始：\n- 旋转坐标系单粒子能量的定义 $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$，\n- 具有在时间反演态之间强度为 $G$ 的常数配对相互作用的 Bardeen-Cooper-Schrieffer (BCS) 平均场，\n- 要求在每个 $\\omega$ 下，$\\Delta(\\omega)$ 和 $\\lambda(\\omega)$ 由零温能隙和粒子数方程自洽地确定，\n\n推导算法，以计算下方测试套件中每个 $\\omega$ 对应的振幅 $u_k(\\omega)$ 和 $v_k(\\omega)$、配对能隙 $\\Delta(\\omega)$ 以及配对减弱的定量度量。确保推导过程从对每个 $k$ 的 $2 \\times 2$ 准粒子矩阵的对角化及相关的自洽条件出发，不引用任何预先给出的目标量的简化公式。\n\n物理和数值规范：\n- 以兆电子伏特 (MeV) 为能量单位，因此所有能量，包括 $\\epsilon_k^{(0)}$, $\\Delta$, $\\lambda$ 和 $\\omega$，单位均为 $\\mathrm{MeV}$。\n- 轨道列表为 $k \\in \\{0,1,2,3,4,5\\}$，其 $(\\epsilon_k^{(0)} [\\mathrm{MeV}], j_k [\\hbar])$ 由下式给出\n  - $k=0: (-3.0, 0.5)$,\n  - $k=1: (-1.0, 1.0)$,\n  - $k=2: (0.2, 0.5)$,\n  - $k=3: (0.8, 3.0)$,\n  - $k=4: (2.0, 1.2)$,\n  - $k=5: (3.0, 0.8)$.\n- 使用配对强度 $G = 0.60\\,\\mathrm{MeV}$ 和偶数粒子数 $N=6$，因此粒子数约束为 $\\sum_k 2v_k(\\omega)^2 = N$。\n- 测试套件的旋转频率为 $\\omega \\in \\{0.0, 0.24, 0.40, 0.80\\}\\,\\mathrm{MeV}$，选择这些频率是为了探测在 $\\omega \\approx 0.24\\,\\mathrm{MeV}$ 附近由旋转诱导的 $k=2$ 和 $k=3$ 之间的能级交叉、一个刚好在交叉点之上的区域，以及一个具有显著科里奥利反配对效应的更高频率区域。\n- 不使用角度；在内部计算任何与角度相关的量时，使用弧度。\n\n任务：\n- 对于每个 $\\omega$，根据旋转坐标系中 Bardeen-Cooper-Schrieffer (BCS) 平均场所隐含的零温粒子数和能隙方程，自洽求解 $\\Delta(\\omega)$ 和 $\\lambda(\\omega)$。然后计算所有 $k$ 的 $u_k(\\omega)$ 和 $v_k(\\omega)$。\n- 通过比率 $R(\\omega)=\\Delta(\\omega)/\\Delta(0)$ 来量化配对的减弱程度。\n- 为表征 Bogoliubov 振幅在交叉点处的演化，还需提取每个 $\\omega$ 的 $v_{k=2}(\\omega)^2$ 和 $v_{k=3}(\\omega)^2$。\n\n输出规范：\n- 如前所述，所有能量均以 $\\mathrm{MeV}$ 表示。最终的数值输出必须四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个子列表的列表，每个 $\\omega$ 对应一个子列表，每个子列表的形式为 $[R(\\omega),v_{2}(\\omega)^2,v_{3}(\\omega)^2]$。所有数字必须是四舍五入到六位小数的浮点数。例如，输出格式必须像 $[[r_0,v2_0,v3_0],[r_1,v2_1,v3_1],\\dots]$，不带任何额外文本。\n\n需精确实现的测试套件：\n- 单粒子数据如上所列。\n- 配对强度 $G=0.60\\,\\mathrm{MeV}$。\n- 粒子数 $N=6$。\n- 旋转频率 $\\omega = 0.0\\,\\mathrm{MeV}, 0.24\\,\\mathrm{MeV}, 0.40\\,\\mathrm{MeV}, 0.80\\,\\mathrm{MeV}$。\n\n您的程序必须完全自包含，不接受任何输入，并且只打印指定的单行内容。", "solution": "根据既定的验证标准，对用户提供的问题进行了严格评估。\n\n### 步骤 1：提取给定条件\n- **模型**：旋转平均场框架下，零温的摇转、常数配对 Bardeen-Cooper-Schrieffer (BCS) 模型。\n- **劳斯量定义**：轨道 $k$ 的旋转坐标系单粒子能量（劳斯量）为 $\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$。\n- **常数**：普朗克常数 $\\hbar=1$。配对强度 $G = 0.60\\,\\mathrm{MeV}$。\n- **粒子数**：总偶数粒子数 $N=6$。\n- **自洽性**：配对能隙 $\\Delta(\\omega)$ 和化学势 $\\lambda(\\omega)$ 在每个旋转频率 $\\omega$ 下通过零温能隙和粒子数方程自洽地确定。\n- **系统基矢**：一组由 $k \\in \\{0, 1, 2, 3, 4, 5\\}$ 索引的单粒子轨道，每个轨道都有非旋转能量 $\\epsilon_k^{(0)}$ 和排齐的角动量投影 $j_k$。\n- **单粒子数据**：\n  - $k=0: (\\epsilon_0^{(0)}, j_0) = (-3.0\\,\\mathrm{MeV}, 0.5\\,\\hbar)$\n  - $k=1: (\\epsilon_1^{(0)}, j_1) = (-1.0\\,\\mathrm{MeV}, 1.0\\,\\hbar)$\n  - $k=2: (\\epsilon_2^{(0)}, j_2) = (0.2\\,\\mathrm{MeV}, 0.5\\,\\hbar)$\n  - $k=3: (\\epsilon_3^{(0)}, j_3) = (0.8\\,\\mathrm{MeV}, 3.0\\,\\hbar)$\n  - $k=4: (\\epsilon_4^{(0)}, j_4) = (2.0\\,\\mathrm{MeV}, 1.2\\,\\hbar)$\n  - $k=5: (\\epsilon_5^{(0)}, j_5) = (3.0\\,\\mathrm{MeV}, 0.8\\,\\hbar)$\n- **粒子数约束**：$\\sum_k 2v_k(\\omega)^2 = N$。\n- **测试频率**：$\\omega \\in \\{0.0, 0.24, 0.40, 0.80\\}\\,\\mathrm{MeV}$。\n- **每个 $\\omega$ 的要求输出**：\n    1. 配对减弱比率：$R(\\omega) = \\Delta(\\omega) / \\Delta(0)$。\n    2. 占据概率：$v_2(\\omega)^2$ 和 $v_3(\\omega)^2$。\n\n### 步骤 2：使用提取的给定条件进行验证\n1.  **科学依据**：该问题是摇转 BCS 模型的一个应用，这是理论核物理中研究原子核旋转性质的标准和基础工具。它在科学上是合理的，不含伪科学。\n2.  **适定性**：该问题是适定的。它提供了求解 BCS 方程所需的所有必要参数（$G$，$N$，单粒子谱）。自洽性要求导出一个非线性方程组，对于给定的物理背景，该方程组通常会为配对的超流相产生一个唯一且稳定的解。\n3.  **客观性**：语言精确、定量且客观。所有术语都在核结构理论的标准词汇范围内定义。\n4.  **完备性**：问题是自包含的。单粒子能级、配对强度和粒子数的数据足以执行计算。\n5.  **一致性**：给定条件内部一致。单位已指定（$\\mathrm{MeV}$，$\\hbar$）。物理情景（科里奥利力诱导的对破裂）与数学形式（摇转 BCS）相符。在 $\\omega \\approx 0.24\\,\\mathrm{MeV}$ 处提到的能级交叉可以通过所提供的数据验证：$\\epsilon_2(0.24) = 0.2 - 0.24 \\cdot 0.5 = 0.08\\,\\mathrm{MeV}$ 且 $\\epsilon_3(0.24) = 0.8 - 0.24 \\cdot 3.0 = 0.08\\,\\mathrm{MeV}$。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 推导与算法设计\n\n该问题要求在摇转 BCS 框架内，推导计算 Bogoliubov 振幅 ($u_k, v_k$) 和自洽参数 ($\\Delta, \\lambda$) 的算法。\n\n**1. 摇转坐标系中的 Bogoliubov 变换**\nBCS 方法的核心是 Bogoliubov 变换，它用独立的准粒子重新定义了基态。在这个在零温下有效的简化模型中，我们为每个轨道 $k$ 对角化一个 $2 \\times 2$ 矩阵。摇转 BCS 中一个常见且有效的简化方法是使用单粒子劳斯量 $\\epsilon_k(\\omega)$ 来构建这个矩阵，而不是在矩阵结构中显式处理时间反演的伴侣态，这个问题的结构似乎也暗示了这一点。这导出了在粒子-空穴态基矢下轨道 $k$ 的 Bogoliubov-de Gennes 矩阵：\n$$\n\\mathcal{H}_k(\\omega) = \\begin{pmatrix} \\epsilon_k(\\omega) - \\lambda(\\omega)  \\Delta(\\omega) \\\\ \\Delta(\\omega)  -(\\epsilon_k(\\omega) - \\lambda(\\omega)) \\end{pmatrix}\n$$\n这里，$\\epsilon_k(\\omega) = \\epsilon_k^{(0)} - \\omega j_k$ 是单粒子劳斯量，$\\lambda(\\omega)$ 是化学势，$\\Delta(\\omega)$ 是配对能隙。我们假设 $\\Delta(\\omega)$ 是实数且为正。\n\n**2. 准粒子能量与 Bogoliubov 振幅**\n对角化 $\\mathcal{H}_k(\\omega)$ 得到准粒子能量。本征值为 $\\pm E_k(\\omega)$，其中正的准粒子能量为：\n$$\nE_k(\\omega) = \\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}\n$$\n对应于本征值 $+E_k(\\omega)$ 的本征矢量定义了 Bogoliubov 振幅 $(u_k, v_k)$。通过求解本征矢量方程 $\\mathcal{H}_k(\\omega) \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix} = E_k(\\omega) \\begin{pmatrix} u_k \\\\ v_k \\end{pmatrix}$ 并满足归一化条件 $u_k^2 + v_k^2 = 1$，我们推导出占据 ($v_k^2$) 和非占据 ($u_k^2$) 振幅的标准表达式：\n$$\nu_k(\\omega)^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\n$$\nv_k(\\omega)^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\n量 $v_k(\\omega)^2$ 表示在旋转频率为 $\\omega$ 的 BCS 基态中，发现对态 $(k, \\bar{k})$ 被占据的概率。\n\n**3. 自洽方程**\n参数 $\\Delta(\\omega)$ 和 $\\lambda(\\omega)$ 不是自由参数，而是由核相互作用的性质和粒子数决定。它们必须通过自洽求解得到。\n\n**a. 粒子数方程：** 总粒子数 $N$ 必须在平均意义下守恒。粒子数算符在 BCS 基态中的期望值由所有轨道上的占据概率之和给出，同时考虑到每个对 $(k, \\bar{k})$ 中的两个粒子。\n$$\nN = \\sum_k 2 v_k(\\omega)^2 = \\sum_k 2 \\cdot \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{E_k(\\omega)} \\right)\n$$\n这简化为粒子数守恒方程：\n$$\nN = \\sum_k \\left( 1 - \\frac{\\epsilon_k(\\omega) - \\lambda(\\omega)}{\\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}} \\right)\n$$\n\n**b. 能隙方程：** 配对能隙 $\\Delta$ 源于核力的配对部分。在具有常数配对强度 $G$ 的 BCS 模型中，能隙定义为 $\\Delta = G \\sum_k \\langle \\text{pair} \\rangle_k$。态 $k$ 的对产生算符的期望值为 $u_k v_k$。\n$$\n\\Delta(\\omega) = G \\sum_k u_k(\\omega) v_k(\\omega)\n$$\n使用推导出的 $u_k$ 和 $v_k$ 的表达式，我们得到 $u_k v_k = \\frac{\\Delta}{2 E_k}$。将其代入定义中可得：\n$$\n\\Delta(\\omega) = G \\sum_k \\frac{\\Delta(\\omega)}{2 E_k(\\omega)}\n$$\n对于 $\\Delta(\\omega) > 0$ 的非平凡配对解，我们可以两边同除以 $\\Delta(\\omega)$ 来获得能隙方程：\n$$\n\\frac{2}{G} = \\sum_k \\frac{1}{E_k(\\omega)} = \\sum_k \\frac{1}{\\sqrt{(\\epsilon_k(\\omega) - \\lambda(\\omega))^2 + \\Delta(\\omega)^2}}\n$$\n\n**4. 数值解法算法**\n对于每个指定的旋转频率 $\\omega$，我们必须找到同时解非线性粒子数和能隙方程的对 $(\\Delta, \\lambda)$。这是一个包含两个方程的方程组的求根问题。\n\n让我们定义需要置零的函数：\n$$\nF_{\\text{num}}(\\Delta, \\lambda; \\omega) = \\sum_k \\left( 1 - \\frac{\\epsilon_k^{(0)} - \\omega j_k - \\lambda}{\\sqrt{(\\epsilon_k^{(0)} - \\omega j_k - \\lambda)^2 + \\Delta^2}} \\right) - N = 0\n$$\n$$\nF_{\\text{gap}}(\\Delta, \\lambda; \\omega) = \\sum_k \\frac{1}{\\sqrt{(\\epsilon_k^{(0)} - \\omega j_k - \\lambda)^2 + \\Delta^2}} - \\frac{2}{G} = 0\n$$\n\n求解过程如下：\n1.  初始化一个结果列表。\n2.  为 $\\omega=0$ 时的 $(\\Delta, \\lambda)$ 设置一个初始猜测值。对于 $\\lambda(0)$，一个有物理动机的猜测是跨越费米面的轨道的平均能量，这里有 $N/2$ 个对。对于 $N=6$，即 3 个对，所以能级为 $k=0,1,2$。$\\lambda(0)$ 预期在 $\\epsilon_2^{(0)}=0.2\\,\\mathrm{MeV}$ 和 $\\epsilon_3^{(0)}=0.8\\,\\mathrm{MeV}$ 之间。对于 $\\Delta(0)$ 的一个合理猜测是 $1\\,\\mathrm{MeV}$ 的量级。\n3.  遍历测试套件中的每个 $\\omega$：\n    a. 使用数值求根器（例如 `scipy.optimize.root`）求解方程组 $F_{\\text{num}}=0$ 和 $F_{\\text{gap}}=0$，以得到 $(\\Delta(\\omega), \\lambda(\\omega))$。\n    b. 对于 $\\omega > 0$，前一个较小 $\\omega$ 的收敛解为当前计算提供了一个绝佳的初始猜测，从而保证了稳健性和效率（延拓法）。\n    c. 在找到 $(\\Delta(\\omega), \\lambda(\\omega))$ 之后，如果 $\\omega=0$，则存储 $\\Delta(0)$。\n    d. 计算配对减弱比率 $R(\\omega) = \\Delta(\\omega) / \\Delta(0)$。\n    e. 使用收敛的参数计算所需的占据概率 $v_2(\\omega)^2$ 和 $v_3(\\omega)^2$。\n    f. 将列表 $[R(\\omega), v_2(\\omega)^2, v_3(\\omega)^2]$ 追加到结果中。\n4.  循环结束后，按要求格式化结果并打印最终输出。此过程系统地计算了核配对和单粒子结构随旋转的演化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the cranked BCS problem for a toy model nucleus.\n    \"\"\"\n    \n    # Physical and numerical specifications\n    # Single-particle data: (epsilon_k^0 [MeV], j_k [hbar])\n    sp_data = [\n        (-3.0, 0.5),  # k=0\n        (-1.0, 1.0),  # k=1\n        (0.2, 0.5),   # k=2\n        (0.8, 3.0),   # k=3\n        (2.0, 1.2),   # k=4\n        (3.0, 0.8),   # k=5\n    ]\n    eps0 = np.array([d[0] for d in sp_data])\n    j = np.array([d[1] for d in sp_data])\n    \n    # Pairing strength and particle number\n    G = 0.60  # MeV\n    N = 6.0\n\n    # Test suite of rotational frequencies\n    omega_vals = [0.0, 0.24, 0.40, 0.80] # MeV\n\n    # Store results for all frequencies\n    all_results = []\n    \n    # Store Delta(0) for ratio calculation\n    delta_at_zero = None\n    \n    # Initial guess for the solver [Delta, Lambda]\n    # For omega=0, lambda is roughly between eps0[2] and eps0[3]\n    # A typical Delta is ~1 MeV.\n    initial_guess = np.array([1.0, 0.5]) \n\n    for omega in omega_vals:\n        \n        # Define the system of self-consistency equations for the current omega\n        def bcs_equations(variables):\n            \"\"\"\n            System of BCS equations to be solved for [Delta, Lambda].\n            \n            Args:\n                variables (list or np.ndarray): A list [delta, lamb]\n            \n            Returns:\n                list: The residuals of the [gap_eq, number_eq]\n            \"\"\"\n            delta, lamb = variables\n            \n            # To avoid division by zero if delta -> 0, though not expected here\n            # E_k = sqrt( (eps_k(omega) - lambda)^2 + delta^2 )\n            # Add a small stabilization term inside sqrt for safety.\n            eps_k_omega = eps0 - omega * j\n            ek_prime_sq = (eps_k_omega - lamb)**2\n            \n            # Avoid delta=0 issues, although solver should not go there for a paired solution.\n            delta_sq = delta**2\n            if delta_sq  1e-24:\n                delta_sq = 1e-24\n\n            E_k = np.sqrt(ek_prime_sq + delta_sq)\n            \n            # Gap Equation: 2/G = sum(1 / E_k)\n            gap_eq_residual = np.sum(1.0 / E_k) - 2.0 / G\n            \n            # Number Equation: N = sum(1 - (eps_k(omega) - lambda) / E_k)\n            num_eq_residual = np.sum(1.0 - (eps_k_omega - lamb) / E_k) - N\n            \n            return [gap_eq_residual, num_eq_residual]\n\n        # Solve the system of equations\n        solution = root(bcs_equations, initial_guess, method='hybr', tol=1e-9)\n        \n        if not solution.success:\n            # Handle cases where convergence fails, though not expected for this problem.\n            # For this problem, we can assume it will succeed.\n            # Using NaN as a placeholder for failure.\n            final_delta, final_lambda = np.nan, np.nan\n        else:\n            final_delta, final_lambda = solution.x\n            # Ensure Delta is positive as per convention\n            if final_delta  0:\n                final_delta = -final_delta\n\n        # Update the initial guess for the next omega value (continuation)\n        initial_guess = solution.x\n\n        # Store Delta(0)\n        if omega == 0.0:\n            delta_at_zero = final_delta\n\n        # Calculate required quantities\n        # Ratio R(omega) = Delta(omega) / Delta(0)\n        R_omega = final_delta / delta_at_zero if delta_at_zero is not None else np.nan\n\n        # Occupation probabilities v_k^2 = 0.5 * (1 - (eps_k(omega) - lambda) / E_k)\n        eps_k_omega = eps0 - omega * j\n        ek_prime_sq = (eps_k_omega - final_lambda)**2\n        delta_sq = final_delta**2\n        E_k = np.sqrt(ek_prime_sq + delta_sq)\n        \n        v_k_sq = 0.5 * (1.0 - (eps_k_omega - final_lambda) / E_k)\n        \n        v2_sq = v_k_sq[2]\n        v3_sq = v_k_sq[3]\n\n        # Append results for the current omega, rounded to six decimal places\n        current_results = [\n            round(R_omega, 6),\n            round(v2_sq, 6),\n            round(v3_sq, 6)\n        ]\n        all_results.append(current_results)\n    \n    # The problem asks for a literal list-of-lists format in the string.\n    # The formatting requires floating-point representation, not scientific notation for small numbers.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3595326"}]}