{"hands_on_practices": [{"introduction": "在核壳模型中，对称性为理解原子核结构提供了强有力的工具，其中一个关键概念是资历 (seniority)，它用于组织在单个 $j$ 壳层中的相同核子。本练习将引导你探索这一基本对称性如何决定单粒子强度的分布。你将推导一个重要的谱求和规则，并学习如何利用资历概念来预测从不同资历的初态中移出一个核子时，谱强度是如何划分的 [@problem_id:3591818]。", "problem": "在一个单轨道核壳模型计算中，考虑全同中子占据一个总单粒子角动量为 $j$（简并度为 $2j+1$）的单轨道。考虑一个在纯高位数方案（无组态混合，高位数 $v$ 是一个好量子数）下的偶数 $n$ 粒子组态 $j^{n}$。对于从 $(n,\\ell,j)$ 轨道移出一个中子，从初态 $\\lvert i; j^{n}, J_{i} \\rangle$ 到末态 $\\lvert f; j^{n-1}, J_{f} \\rangle$ 的核单核子移出谱因子 $S_{n\\ell j}(f \\leftarrow i)$ 定义为\n$$\nS_{n\\ell j}(f \\leftarrow i) \\equiv \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2},\n$$\n其中 $a_{jm}$ 在该轨道上湮灭一个量子数为 $(\\ell,j,m)$ 的中子。\n\n仅从这个定义、末态基的正交归一性/完备性以及高位数的诠释（高位数 $v$ 计算未耦合至角动量 $J=0$ 对的核子数）出发，完成以下任务：\n\n1. 推导移出强度的求和规则，\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = n_{j},\n$$\n其中 $n_{j}$ 是初态在 $(n,\\ell,j)$ 轨道上的粒子数算符的期望值，并将其特化到 $n_{j}=n$ 的纯 $j^{n}$ 组态。\n\n2. 利用单体湮灭算符下的高位数选择定则（在纯高位数极限下，高位数改变 $\\Delta v = \\pm 1$）以及 $v$ 为未配对核子数、$n-v$ 为 $J=0$ 对中的核子数的诠释，论证总移出强度如何在末态高位数 $v' = v-1$ 和 $v' = v+1$ 之间划分。用 $n$ 和 $v$ 表述到每个高位数类别的总强度。\n\n3. 考虑同一 $j$ 轨道中的两种初态偶数 $n$ 的情况：(i) 完全配对的高位数-$v=0$ 基态组态 $j^{n}(v=0)$，以及 (ii) 高位数-$v=2$ 组态 $j^{n}(v=2)$。对每种情况，计算到 $v'=1$ 的末态的总移出谱因子。然后，计算比值\n$$\nR(n) \\equiv \\frac{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=2) \\to j^{n-1}(v'=1)}{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=0) \\to j^{n-1}(v'=1)}.\n$$\n\n用语言解释对于 $v=2$ 的初态，强度在 $v'=1$ 和 $v'=3$ 之间的重新分布如何反映了移出一个未配对核子与打破一个 $J=0$ 对的物理过程。将你对 $R(n)$ 的最终答案表示为关于 $n$ 的简化解析表达式。不需要进行数值计算，也不涉及单位。", "solution": "本题将按要求分三部分解答。首先，推导谱因子的求和规则。其次，根据高位数选择定则确定总强度的划分。最后，将这些结果应用于特定的高位数态，以计算所需的比值。\n\n第一部分：求和规则的推导\n\n题目要求推导单核子移出谱因子 $S_{n\\ell j}$ 的求和规则。我们从所给的定义开始：\n$$\nS_{n\\ell j}(f \\leftarrow i) \\equiv \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2}\n$$\n为了找到从初态 $\\lvert i \\rangle$ 到所有可能的末态 $\\lvert f \\rangle$ 的总移出强度，我们将 $S_{n\\ell j}(f \\leftarrow i)$ 对所有末态 $f$ 求和。注意，态的集合 $\\{ \\lvert f; J_{f} M_{f} \\rangle \\}$ 构成 $(n-1)$ 粒子系统的一个完备正交基。\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\sum_{f} \\left( \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2} \\right)\n$$\n我们可以交换求和的顺序。对 $f$ 的求和包括对其所有定义量子数（包括 $J_f$）的求和。\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\sum_{f,M_{f}} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2}\n$$\n矩阵元的平方可以写成矩阵元与其复共轭的乘积：\n$$\n\\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2} = \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} \\rvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\n将此代入求和式中：\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\sum_{f,M_{f}} \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} \\rvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\n现在我们使用末态的完备性关系 $\\sum_{f,M_{f}} \\lvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\rvert = \\hat{\\mathbb{I}}$，其中 $\\hat{\\mathbb{I}}$ 是 $(n-1)$ 粒子希尔伯特空间中的单位算符。表达式简化为：\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\n对产生和湮灭算符乘积的磁亚态 $m$ 的求和 $\\sum_{m=-j}^{j} a_{j m}^{\\dagger} a_{j m}$ 定义了轨道 $j$ 的粒子数算符 $\\hat{n}_{j}$。\n$$\n\\hat{n}_{j} = \\sum_{m=-j}^{j} a_{j m}^{\\dagger} a_{j m}\n$$\n将此代入我们的方程得到：\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i}} \\langle i; J_{i} M_{i} \\lvert \\hat{n}_{j} \\rvert i; J_{i} M_{i} \\rangle\n$$\n粒子数算符 $\\hat{n}_{j}$ 是一个标量算符，意味着其期望值与态的磁量子数 $M_i$ 无关。因此，对 $M_i$ 的求和会产生 $2J_i+1$ 个相同的项：\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} (2J_{i}+1) \\langle i; J_{i} M_{i} \\lvert \\hat{n}_{j} \\rvert i; J_{i} M_{i} \\rangle = \\langle \\hat{n}_{j} \\rangle_{i}\n$$\n这就是普适的求和规则，它表明总移出强度等于初态中粒子数算符的期望值，记为 $n_j$。对于纯组态 $j^n$，初态 $\\lvert i \\rangle$ 是 $\\hat{n}_j$ 的本征态，本征值为 $n$。因此，$\\langle \\hat{n}_j \\rangle_i = n$。该求和规则特化为：\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = n\n$$\n\n第二部分：按高位数划分强度\n\n给定高位数 $v$ 表示未耦合到角动量 $J=0$ 对的核子数，并且单核子湮灭算符 $a_{jm}$ 引起的跃迁会使高位数发生 $\\Delta v = v' - v = \\pm 1$ 的改变。核子总数为 $n$，配对核子数为 $n-v$。\n\n通过 $a_{jm}$ 移出一个核子的过程可以从两种方式来描绘：\n1.  移出一个未配对的核子：初态有 $v$ 个未配对核子。如果我们移走其中一个，末态 $(n-1)$ 粒子系统中的未配对核子数变为 $v-1$。对的数目 $\\frac{n-v}{2}$ 保持不变。末态高位数为 $v' = v-1$。这对应于 $\\Delta v = -1$ 选择定则。\n2.  移出一个配对的核子：初态有 $n-v$ 个核子参与 $J=0$ 对。如果我们从一个对中移走一个核子，该对就被打破了。该对中的另一个核子现在变为未配对。因此，末态拥有原来 $v$ 个未配对的核子，再加上这个新产生的未配对核子，总共有 $v+1$ 个未配对核子。末态高位数为 $v' = v+1$。这对应于 $\\Delta v = +1$ 选择定则。\n\n求和规则表明总强度为 $n$。这个强度必须在两个可能的末态高位数类别 $v'=v-1$ 和 $v'=v+1$ 之间划分。与问题的框架一致，最简单、最直接的解释是，每个过程的谱强度与可用于该过程的核子数目成正比。\n- 到 $v' = v-1$ 的跃迁强度（移出一个未配对核子）与未配对核子数 $v$ 成正比。\n- 到 $v' = v+1$ 的跃迁强度（移出一个配对核子）与配对核子数 $n-v$ 成正比。\n\n设 $S_{v \\to v'}$ 是从一个高位数为 $v$ 的初态到所有高位数为 $v'$ 的末态的总谱强度之和。我们可以写出：\n$S_{v \\to v-1} = C \\cdot v$\n$S_{v \\to v+1} = C \\cdot (n-v)$\n其中 $C$ 是某个比例常数。\n从第一部分推导的求和规则可知，总强度必须为 $n$：\n$S_{v \\to v-1} + S_{v \\to v+1} = n$\n$C \\cdot v + C \\cdot (n-v) = C \\cdot n = n$\n这意味着比例常数 $C=1$。因此，到每个高位数类别的总强度为：\n- 到 $v' = v-1$ 的总强度：$S_{v \\to v-1} = v$\n- 到 $v' = v+1$ 的总强度：$S_{v \\to v+1} = n-v$\n\n第三部分：比值 $R(n)$ 的计算\n\n我们将第二部分的结果应用于两种指定的初态情况，以求得到 $v'=1$ 的末态的总谱因子。\n\n情况 (i)：初态为 $j^{n}(v=0)$。\n初态高位数为 $v=0$。这是一个完全配对的组态，包含 0 个未配对核子和 $n-0=n$ 个配对核子。我们移走一个核子，所以末态将有 $n-1$ 个核子。可能的末态高位数为 $v' = v \\pm 1 = 0 \\pm 1$。由于高位数不能为负，唯一可能的末态高位数是 $v'=1$。这对应于一个 $\\Delta v = +1$ 的跃迁。\n到 $v'=1$ 的总强度由 $v=0$ 时的 $S_{v \\to v+1}$ 公式给出：\n$$S_{j^{n}(v=0) \\to j^{n-1}(v'=1)} = n-v = n-0 = n$$\n从物理上看，因为所有 $n$ 个核子都处于配对状态，移走任何一个都必须打破一个对，导致末态的高位数为 $v'=1$。因此，全部强度 $n$ 都进入了这个道。\n\n情况 (ii)：初态为 $j^{n}(v=2)$。\n初态高位数为 $v=2$。该态有 2 个未配对核子和 $n-2$ 个配对核子。可能的末态高位数为 $v' = v \\pm 1 = 2 \\pm 1$，即 $v'=1$ 或 $v'=3$。我们关心的是到 $v'=1$ 的末态的强度。\n跃迁 $j^{n}(v=2) \\to j^{n-1}(v'=1)$ 对应于 $\\Delta v = 1 - 2 = -1$ 的改变。\n这个过程的总强度由 $v=2$ 时的 $S_{v \\to v-1}$ 公式给出：\n$$S_{j^{n}(v=2) \\to j^{n-1}(v'=1)} = v = 2$$\n这个强度 2 对应于移走两个已未配对核子中的一个。剩余的强度 $S_{j^{n}(v=2) \\to j^{n-1}(v'=3)} = n-v = n-2$ 对应于打破一个对。\n\n现在我们计算比值 $R(n)$：\n$$\nR(n) \\equiv \\frac{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=2) \\to j^{n-1}(v'=1)}{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=0) \\to j^{n-1}(v'=1)}\n$$\n代入计算出的值：\n$$\nR(n) = \\frac{2}{n}\n$$\n\n物理诠释：\n在 $j^{n}(v=0)$ 初态中，所有 $n$ 个核子都处于 $J=0$ 对中。移走任何一个核子都必然会打破一个对，从而导致高位数为 $v'=1$ 的末态。因此，总移出强度 $n$ 完全集中在布居 $v'=1$ 的态上。\n在 $j^{n}(v=2)$ 初态中，核子有两种类型：2 个是未配对的， $n-2$ 个是配对的。移走 2 个未配对核子中的一个，会导致高位数为 $v'=1$ 的末态；此过程的强度为 2。移走 $n-2$ 个配对核子中的一个，会打破一个对并导致高位数为 $v'=3$ 的末态；此过程的强度为 $n-2$。因此，总强度 $n$ 在这两个道之间分裂。比值 $R(n)=2/n$ 比较了从这两个不同出发点到 $v'=1$ 末态的绝对强度。它突显了对于 $v=2$ 的初态，只有一小部分总强度（$n$ 中的 2）布居 $v'=1$ 的态，这个过程对应于移走一个“旁观者”未配对核子。主导过程是打破一个额外的对，这会布居 $v'=3$ 的态。", "answer": "$$\n\\boxed{\\frac{2}{n}}\n$$", "id": "3591818"}, {"introduction": "虽然纯资历模型提供了深刻的物理图像，但由于剩余相互作用的存在，真实的核态通常是不同组态的混合。本计算练习使用一个简化的双能级模型来研究这种组态混合如何影响谱因子。通过系统地改变一个轨道的能量（一种称为单极移动的技术），你将亲手观察谱强度是如何被“碎片化”并在不同态之间重新分布的，这是壳模型计算中的一个核心现象 [@problem_id:3591801]。", "problem": "要求您设计并实现一个完整的、自包含的计算实验，该实验在最小壳模型设置中，通过施加受控的单极移动来模拟单粒子强度的重新分布，并量化近简并轨道谱因子的非线性响应。您的实现必须是一个可运行的程序，为指定的测试套件输出所要求的数值。\n\n从以下基本基础开始：\n\n1. 在截断的单粒子空间中，单体壳模型哈密顿量由一个厄米矩阵表示，其对角元是单粒子能量，非对角元则编码了耦合轨道的剩余混合。对于双轨道子空间，其矩阵形式为一个实对称矩阵。这源于量子力学的标准表述，其中可观测算符是厄米算符。\n\n2. 谱因子通过单核子转移连接的精确多体态之间的单体交叠来定义，并且是无量纲的，界于零和一之间。在一个包含惰性核心和分布在一小组单粒子轨道上的单个价核子的模型中，多体问题简化为价空间有限维单体哈密顿量的对角化，且将一个核子添加到基轨道上的谱因子，等于归一化本征态矢量在该基中的相应分量的模方。这是单粒子态的二次量子化正交归一性以及转移振幅定义的直接结果。\n\n3. 单极移动是一种受控的、有物理动机的对角能量移动，由占据数引起的平均场变化所导致。在参数化研究中，这种移动可被视为一个外部控制参数，它以您将明确改变的量来修改所选轨道的能量。这保持了厄米性，并测试了可观测量对单粒子能量重心的敏感度。\n\n模型、定义与任务：\n\n- 考虑两个单粒子轨道，由基态 $\\lvert a \\rangle$ 和 $\\lvert b \\rangle$ 标记，初始具有单粒子能量 $\\epsilon_a$ 和 $\\epsilon_b$（单位为 $\\mathrm{MeV}$）。假设一个剩余混合矩阵元 $v$（单位为 $\\mathrm{MeV}$）在单体哈密顿量中耦合了 $\\lvert a \\rangle$ 和 $\\lvert b \\rangle$。引入一个单极控制变量 $x$（单位为 $\\mathrm{MeV}$），它仅根据 $\\epsilon_b \\mapsto \\epsilon_b + x$ 来移动轨道 $b$ 的能量，而 $\\epsilon_a$ 保持不变。那么，在有序基 $\\{\\lvert a \\rangle,\\lvert b \\rangle\\}$ 中的截断单体哈密顿量是一个实对称的 $2 \\times 2$ 矩阵\n$$\nH(x) \\equiv\n\\begin{pmatrix}\n\\epsilon_a  v \\\\\nv  \\epsilon_b + x\n\\end{pmatrix}.\n$$\n\n- 对于每个 $x$，求得 $H(x)$ 的最低能量归一化本征态 $\\lvert \\psi_{\\min}(x) \\rangle$。将其在所选基中的分量表示为\n$$\n\\lvert \\psi_{\\min}(x) \\rangle = c_a(x) \\lvert a \\rangle + c_b(x) \\lvert b \\rangle,\n$$\n满足 $\\lvert c_a(x) \\rvert^2 + \\lvert c_b(x) \\rvert^2 = 1$。\n\n- 定义将一个核子添加到轨道 $a$ 的谱因子为\n$$\nS_a(x) \\equiv \\lvert c_a(x) \\rvert^2,\n$$\n该因子是无量纲的。\n\n- 为量化 $S_a(x)$ 对单极移动响应的非线性，使用中心二阶有限差分来估计在 $x = 0$ 处的局部曲率，步长为 $h$（单位为 $\\mathrm{MeV}$）：\n$$\n\\kappa \\equiv \\frac{S_a(h) - 2 S_a(0) + S_a(-h)}{h^2},\n$$\n其单位为 $\\mathrm{MeV}^{-2}$。\n\n实现要求：\n\n- 编写一个程序，对于每个指定的测试用例，构造 $H(x)$，将其对角化以获得 $\\lvert \\psi_{\\min}(x) \\rangle$，计算在 $x \\in \\{-h, 0, +h\\}$ 处的 $S_a(x)$，然后使用上述离散公式计算曲率 $\\kappa$。所有能量单位必须是 $\\mathrm{MeV}$，曲率单位必须是 $\\mathrm{MeV}^{-2}$。\n\n- 您的程序不得要求任何用户输入，并且必须使用以下测试套件。每个测试用例是一个四元组 $(\\epsilon_a, \\epsilon_b, v, h)$，所有量的单位均为 $\\mathrm{MeV}$：\n    1. $(0.0, 0.01, 0.005, 0.01)$\n    2. $(0.0, 0.0005, 0.0001, 0.0005)$\n    3. $(0.0, 0.0, 0.2, 0.05)$\n    4. $(0.1, 0.0, 0.03, 0.05)$\n\n- 对于每个测试用例，程序必须生成一个包含四个浮点数的四元组：\n$$\n\\big[ S_a(-h),\\ S_a(0),\\ S_a(+h),\\ \\kappa \\big],\n$$\n其中 $S_a(\\cdot)$ 是无量纲的，而 $\\kappa$ 的单位是 $\\mathrm{MeV}^{-2}$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，每个测试用例的结果以指定顺序的四个浮点数的嵌套列表形式报告。最终打印的字符串必须如下所示\n$$\n\\left[\n\\left[S_a(-h), S_a(0), S_a(+h), \\kappa\\right],\\ \\ldots\\ \\text{for all cases}\n\\right]\n$$\n不含任何额外文本。例如，一个有效的格式应为\n$[[s_{1,-}, s_{1,0}, s_{1,+}, \\kappa_1],[s_{2,-}, s_{2,0}, s_{2,+}, \\kappa_2],\\ldots]$。", "solution": "问题陈述经过严格审查，并被确定为有效。它在科学上植根于量子力学原理，特别是壳模型在核物理中的应用。该问题提法恰当、客观，并包含了获得唯一且有意义解所需的所有信息。所指定的计算任务是计算物理中的一个标准练习，涉及到一个小哈密顿矩阵的对角化和导数的数值估计。\n\n求解过程如下。我们的任务是分析一个双能级量子系统，这是一个价空间中单个核子行为的简化表示，该价空间由两个单粒子轨道 $\\lvert a \\rangle$ 和 $\\lvert b \\rangle$ 构成。该系统的动力学由一个单体哈密顿量控制，在基 $\\{\\lvert a \\rangle, \\lvert b \\rangle\\}$ 中，它由以下实对称矩阵给出：\n$$\nH(x) =\n\\begin{pmatrix}\n\\epsilon_a  v \\\\\nv  \\epsilon_b + x\n\\end{pmatrix}\n$$\n在此，$\\epsilon_a$ 和 $\\epsilon_b$ 是轨道的未扰动单粒子能量，$v$ 是混合两个基态的剩余相互作用强度，$x$ 是一个外部参数，表示施加于轨道 $\\lvert b \\rangle$ 的单极移动。所有这些量的单位均为 $\\mathrm{MeV}$。\n\n根据量子力学的基本假设，系统的定态是哈密顿量的本征态，其对应的能量是本征值。为了找到最低能量态 $\\lvert \\psi_{\\min}(x) \\rangle$，我们必须求解不含时薛定谔方程，在此矩阵表示中，这是一个本征值问题：\n$$\nH(x) \\lvert \\psi(x) \\rangle = E(x) \\lvert \\psi(x) \\rangle\n$$\n对于一个 $2 \\times 2$ 的实对称矩阵，将有两个实数本征值 $E_{\\min}(x)$ 和 $E_{\\max}(x)$，以及一组相应的两个正交归一的本征矢量。我们关心的是与最低本征值 $E_{\\min}(x)$ 相关联的本征态 $\\lvert \\psi_{\\min}(x) \\rangle$。该本征态可以表示为基态的线性组合：\n$$\n\\lvert \\psi_{\\min}(x) \\rangle = c_a(x) \\lvert a \\rangle + c_b(x) \\lvert b \\rangle\n$$\n系数 $c_a(x)$ 和 $c_b(x)$ 是对应于 $E_{\\min}(x)$ 的归一化本征矢量的分量。归一化条件要求 $\\lvert c_a(x) \\rvert^2 + \\lvert c_b(x) \\rvert^2 = 1$。\n\n将一个核子添加到轨道 $a$ 以达到最终态 $\\lvert \\psi_{\\min}(x) \\rangle$ 的谱因子，定义为交叠积分的平方，在本模型中简化为 $S_a(x) \\equiv \\lvert c_a(x) \\rvert^2$。这个量是一个模的平方，是无量纲的，表示在由基态 $\\lvert a \\rangle$ 描述的组态中找到系统的概率。\n\n计算任务的核心是实现一个算法，对于每个给定的参数集 $(\\epsilon_a, \\epsilon_b, v, h)$，执行以下步骤：\n$1$. 定义待评估的单极移动参数的范围：$x \\in \\{-h, 0, +h\\}$。\n$2$. 对于此集合中的每个 $x$ 值：\n    a. 构造哈密顿量 $H(x)$ 的数值矩阵。\n    b. 对角化 $H(x)$ 以找到其本征值和本征矢量。标准的数值线性代数库提供了用于对角化厄米矩阵的稳健例程，例如 `numpy.linalg.eigh`，它可以方便地返回按升序排序的本征值以及相应的正交归一本征矢量。\n    c. 识别最低的本征值 $E_{\\min}(x)$，它将是排序后本征值列表的第一个元素。\n    d. 提取相应的本征矢量 $\\lvert \\psi_{\\min}(x) \\rangle$。其分量 $c_a(x)$ 和 $c_b(x)$ 将构成对角化例程返回的本征矢量矩阵的第一列。\n    e. 通过对该本征矢量的第一个分量求平方来计算谱因子 $S_a(x)$：$S_a(x) = (c_a(x))^2$。\n$3$. 在获得 $S_a(-h)$、$S_a(0)$ 和 $S_a(+h)$ 这三个值之后，计算函数 $S_a(x)$ 在 $x=0$ 处的局部曲率 $\\kappa$。这通过中心二阶有限差分公式进行估计：\n$$\n\\kappa = \\frac{S_a(h) - 2 S_a(0) + S_a(-h)}{h^2}\n$$\n$\\kappa$ 的单位是 $\\mathrm{MeV}^{-2}$，因为 $S_a$ 是无量纲的，而 $h$ 和 $x$ 的单位都是 $\\mathrm{MeV}$。\n\n将此过程系统地应用于问题陈述中提供的每个测试用例。每个用例的最终输出是四个计算出的浮点数的集合：$[S_a(-h), S_a(0), S_a(+h), \\kappa]$。程序被设计为自包含的，并以指定的列表的列表格式打印所有测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a given set of test cases.\n\n    This function iterates through a predefined test suite. For each case, it models\n    a two-level quantum system, calculates spectroscopic factors under monopole shifts,\n    and computes the curvature of the spectroscopic factor response.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (epsilon_a, epsilon_b, v, h) in MeV.\n    test_cases = [\n        (0.0, 0.01, 0.005, 0.01),\n        (0.0, 0.0005, 0.0001, 0.0005),\n        (0.0, 0.0, 0.2, 0.05),\n        (0.1, 0.0, 0.03, 0.05),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        epsilon_a, epsilon_b, v, h = case\n        \n        spectroscopic_factors = {}\n\n        # The monopole shift 'x' is evaluated at -h, 0, and +h.\n        for x_val in [-h, 0, h]:\n            # Construct the 2x2 one-body Hamiltonian matrix H(x).\n            # H(x) = [[epsilon_a,   v          ],\n            #         [v,           epsilon_b + x]]\n            hamiltonian = np.array([\n                [epsilon_a, v],\n                [v, epsilon_b + x_val]\n            ])\n\n            # Diagonalize the Hermitian Hamiltonian.\n            # numpy.linalg.eigh returns eigenvalues in ascending order and\n            # corresponding eigenvectors as columns of a matrix.\n            eigenvalues, eigenvectors = np.linalg.eigh(hamiltonian)\n\n            # The lowest-energy eigenstate corresponds to the first eigenvalue.\n            # Its eigenvector is the first column of the eigenvectors matrix.\n            # The eigenvector is already normalized.\n            lowest_eigenstate_vector = eigenvectors[:, 0]\n\n            # The component c_a(x) is the first element of this vector.\n            c_a = lowest_eigenstate_vector[0]\n\n            # The spectroscopic factor S_a(x) is the square of the component c_a(x).\n            s_a = c_a**2\n            \n            spectroscopic_factors[x_val] = s_a\n\n        # Extract the computed spectroscopic factors.\n        s_a_minus_h = spectroscopic_factors.get(-h)\n        s_a_zero = spectroscopic_factors.get(0)\n        s_a_plus_h = spectroscopic_factors.get(h)\n\n        # Calculate the curvature kappa using the central second finite difference.\n        # kappa = (S_a(h) - 2*S_a(0) + S_a(-h)) / h^2\n        # Handle the case h=0 to avoid division by zero, although not expected in test cases.\n        if h == 0.0:\n            kappa = 0.0\n        else:\n            kappa = (s_a_plus_h - 2 * s_a_zero + s_a_minus_h) / (h**2)\n\n        # Store the results for this test case as a list of four floats.\n        case_result = [s_a_minus_h, s_a_zero, s_a_plus_h, kappa]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The standard string representation of a list of lists is used.\n    print(str(all_results))\n\nsolve()\n```", "id": "3591801"}, {"introduction": "将理论壳模型计算与实验数据联系起来，需要仔细辨析实验的真正可观测量是什么。本练习探讨了壳模型谱因子 $S_{nlj}$ 与渐近归一化系数 (ANC) 之间的关键区别：前者反映了核波函数的“内部”部分，而后者则描述了其“外部”的渐近行为，并与转移反应截面（尤其对于弱束缚核）直接相关 [@problem_id:3591851]。通过一个简单的势模型，你将证明当核子结合能发生变化时，这两个量的行为可能截然不同。", "problem": "考虑一个在中子平均场势中的单个中子，该势由半径为 $R$、深度为 $V_{0}$ 的球形方势阱描述，即当 $0 \\le r \\le R$ 时，$V(r) = -V_{0}$，当 $r \\ge R$ 时，$V(r) = 0$。使用约化径向波函数 $u(r)$（定义为 $u(r) = r R(r)$，其中 $R(r)$ 是波函数的常规径向部分）的径向薛定谔方程，轨道角动量为 $l = 0$（s波）。使用中子的非相对论动能项，其约化质量 $\\mu$ 近似为中子质量。采用经过充分检验的常数 $\\hbar^{2}/(2\\mu) = 20.735$，单位为 $\\text{MeV}\\cdot\\text{fm}^{2}$。假设束缚态能量为 $E = -E_{b}$，其中 $E_{b}  0$。\n\n从不含时薛定谔方程的基本原理和束缚态的定义出发，根据第一性原理推导 $l=0$ 时势阱内外 $u(r)$ 的分段形式，施加物理边界条件和连续性条件以确定内部波数与外部衰减常数之间的关系，并将 $u(r)$ 归一化为单位概率：\n$$\\int_{0}^{\\infty} |u(r)|^{2} \\, dr = 1.$$\n定义渐近归一化系数 (Asymptotic Normalization Coefficient, ANC) 如下：当 $r \\ge R$ 时，约化径向波函数必须按以下形式衰减：\n$$u(r) \\approx C \\, e^{-\\kappa r},$$\n其中 $\\kappa = \\sqrt{E_{b} / \\left(\\hbar^{2}/(2\\mu)\\right)}$，$C$ 是 ANC。为了量化，定义两个归一化约化径向波函数 $u_{a}(r)$ 和 $u_{b}(r)$ 在内部区域 $[0,R]$ 上的内部重叠相似度，其值为它们在限制于 $[0,R]$ 的希尔伯特空间中夹角的余弦：\n$$\\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}}.$$\n该量满足 $0 \\le \\mathcal{S}_{\\mathrm{int}} \\le 1$，并度量与外部尾部无关的内部形状相似性。\n\n你的任务是实现一个程序，对于固定的势阱半径 $R$ 和一组束缚态能量 $E_{b}$，计算：\n- ANC $C$（单位为 $\\text{fm}^{-1/2}$），以及\n- 相对于在指定参考束缚能 $E_{b}^{\\mathrm{ref}}$ 下的指定参考束缚态 $u_{\\mathrm{ref}}$ 的内部相似度 $\\mathcal{S}_{\\mathrm{int}}(u_{\\mathrm{ref}}, u_{E_{b}})$。\n\n所有计算都必须基于薛定谔方程所蕴含的定义以及边界/匹配条件。不要假设任何非由这些原理推导出的公式。\n\n使用的数值和物理参数（所有数学实体和数字均在此处指定）：\n- 方势阱半径：$R = 4.0$ fm。\n- 动能常数：$\\hbar^{2}/(2\\mu) = 20.735$ MeV·fm²。\n- 轨道角动量：$l = 0$。\n- 束缚能测试集：$E_{b} \\in \\{0.05, 0.5, 1.0, 2.0, 5.0\\}$ MeV。\n- 参考束缚能：$E_{b}^{\\mathrm{ref}} = 1.0$ MeV。\n\n对于测试集中的每个 $E_{b}$，构建满足方势阱中薛定谔方程、适当边界条件以及在 $r = R$ 处匹配条件的归一化束缚态约化径向波函数 $u_{E_{b}}(r)$。计算：\n- ANC $C$（单位为 $\\text{fm}^{-1/2}$），以及\n- 在 $[0,R]$ 上的内部相似度 $\\mathcal{S}_{\\mathrm{int}}(u_{\\mathrm{ref}}, u_{E_{b}})$，其中 $u_{\\mathrm{ref}} = u_{E_{b}^{\\mathrm{ref}}}$。\n\n通过计算值证明，当 $E_{b}$ 变化时，对于弱束缚情况，ANC $C$ 发生显著变化，而内部相似度 $\\mathcal{S}_{\\mathrm{int}}$ 保持接近于1，这表明内部重叠几乎恒定（并由此暗示，在壳模型的意义上，谱因子几乎恒定）。\n\n角度单位在此不适用。所有物理单位必须按规定使用：报告 $C$ 的单位为 $\\text{fm}^{-1/2}$，报告 $\\mathcal{S}_{\\mathrm{int}}$ 为无量纲数。对于数值报告，将 $C$ 和 $\\mathcal{S}_{\\mathrm{int}}$ 均四舍五入到6位小数。\n\n最终输出格式规范：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素都是一个双元素列表，顺序为 $[C,\\mathcal{S}_{\\mathrm{int}}]$，对应于测试集中给定顺序 $[0.05, 0.5, 1.0, 2.0, 5.0]$ 的束缚能。例如，打印的行必须看起来像：\n$$[ [C_{1}, S_{1}], [C_{2}, S_{2}], [C_{3}, S_{3}], [C_{4}, S_{4}], [C_{5}, S_{5}] ],$$\n其中每个 $C_{i}$ 的单位是 $\\text{fm}^{-1/2}$，每个 $S_{i}$ 是无量纲数，两者都四舍五入到6位小数。", "solution": "用户希望分析球形方势阱中中子束缚态的性质。该问题要求从第一性原理出发推导波函数，然后通过数值实现来计算给定一组束缚能下的渐近归一化系数 (ANC) 和内部重叠相似度。\n\n### 第1步：问题验证\n\n**1.1. 提取给定条件**\n\n-   **势**：球形方势阱，$0 \\le r \\le R$ 时 $V(r) = -V_{0}$，$r \\ge R$ 时 $V(r) = 0$。\n-   **粒子**：单个中子，其约化质量 $\\mu$ 近似为中子质量。\n-   **动能项**：非相对论。\n-   **常数**：$\\hbar^{2}/(2\\mu) = 20.735$，单位为 $\\text{MeV}\\cdot\\text{fm}^{2}$。\n-   **角动量**：$l = 0$ (s波)。\n-   **波函数**：约化径向波函数 $u(r) = r R(r)$。\n-   **能量**：束缚态能量 $E = -E_b$，其中 $E_{b}  0$。\n-   **势阱半径**：$R = 4.0$ fm。\n-   **束缚能**：测试集 $E_{b} \\in \\{0.05, 0.5, 1.0, 2.0, 5.0\\}$ MeV。\n-   **参考能量**：$E_{b}^{\\mathrm{ref}} = 1.0$ MeV。\n-   **归一化条件**：$\\int_{0}^{\\infty} |u(r)|^{2} \\, dr = 1$。\n-   **ANC 定义**：当 $r \\ge R$ 时，$u(r) \\approx C \\, e^{-\\kappa r}$，其中 $\\kappa = \\sqrt{E_{b} / \\left(\\hbar^{2}/(2\\mu)\\right)}$。$C$ 是 ANC。\n-   **内部重叠相似度定义**：$\\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}}$。\n-   **任务**：为测试集中的每个能量计算 ANC $C$（单位为 $\\text{fm}^{-1/2}$）以及相对于参考态的内部相似度 $\\mathcal{S}_{\\mathrm{int}}$。\n-   **输出格式**：一个单行字符串 `[ [C1, S1], [C2, S2], ... ]`，数值四舍五入到6位小数。\n\n**1.2. 使用提取的给定条件进行验证**\n\n-   **科学依据**：该问题是量子力学和核物理入门的标准练习。球形方势阱是一个常见且易于理解的模型。所有物理量和常数都适用于核尺度。该问题在科学上是合理的。\n-   **适定性**：问题设定了明确的任务并提供了所有必要信息。对于给定的束缚能 $E_b$ 和半径 $R$，势深 $V_0$ 和相应的波函数是唯一确定的（对于基态）。解的存在性和唯一性得到保证。\n-   **客观性**：问题以精确的数学术语陈述。ANC 和重叠相似度的定义是明确的。没有主观或基于观点的元素。\n-   **完整性**：所有需要的数据（$R$、$\\hbar^2/(2\\mu)$、$E_b$ 值）均已提供。没有信息缺失。\n-   **一致性**：给定条件内部一致。单位已指定且在全文中保持一致。\n\n**1.3. 结论与行动**\n\n该问题有效。这是一个定义明确、科学合理的计算核物理问题，可以从第一性原理求解。\n\n### 第2步：推导与求解\n\n**2.1. 不含时薛定谔方程**\n\n对于一个在中心势 $V(r)$ 中运动、约化质量为 $\\mu$ 的粒子，其轨道角动量为 $l$ 时，约化径向波函数 $u(r)$ 的径向薛定谔方程为：\n$$ - \\frac{\\hbar^2}{2\\mu} \\frac{d^2 u(r)}{dr^2} + \\left[V(r) + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\\right] u(r) = E u(r) $$\n给定 $l=0$ (s波)，离心势项消失。使用常数 $c_k = \\hbar^2/(2\\mu) = 20.735 \\, \\text{MeV} \\cdot \\text{fm}^2$ 和束缚态能量 $E = -E_b$，方程简化为：\n$$ - c_k \\frac{d^2 u(r)}{dr^2} + V(r) u(r) = -E_b u(r) $$\n\n**2.2. 分段解**\n\n我们在方势阱定义的两个区域内求解该方程。\n\n**区域 I：内部 ($0 \\le r \\le R$)**\n在这里，$V(r) = -V_0$。方程变为：\n$$ \\frac{d^2 u_{\\text{in}}(r)}{dr^2} = -\\frac{V_0 - E_b}{c_k} u_{\\text{in}}(r) \\equiv -k^2 u_{\\text{in}}(r) $$\n其中内部波数为 $k = \\sqrt{(V_0 - E_b)/c_k}$。通解为 $u_{\\text{in}}(r) = A' \\sin(kr) + B' \\cos(kr)$。物理边界条件要求全径向波函数 $R(r) = u(r)/r$ 在原点处是有限的，这要求 $u(0)=0$。这意味着 $B'=0$。因此，\n$$ u_{\\text{in}}(r) = A \\sin(kr) $$\n其中 $A$ 是一个归一化常数。\n\n**区域 II：外部 ($r \\ge R$)**\n在这里，$V(r) = 0$。方程变为：\n$$ \\frac{d^2 u_{\\text{out}}(r)}{dr^2} = \\frac{E_b}{c_k} u_{\\text{out}}(r) \\equiv \\kappa^2 u_{\\text{out}}(r) $$\n其中外部衰减常数为 $\\kappa = \\sqrt{E_b/c_k}$，与问题定义相符。通解为 $u_{\\text{out}}(r) = C' e^{-\\kappa r} + D' e^{\\kappa r}$。波函数必须可归一化的边界条件要求当 $r \\to \\infty$ 时 $u(r) \\to 0$。这意味着 $D'=0$。因此，\n$$ u_{\\text{out}}(r) = B e^{-\\kappa r} $$\n其中 $B$ 是一个常数。\n\n**2.3. 连续性与超越方程**\n\n为了使解在物理上有效，波函数 $u(r)$ 及其一阶导数 $u'(r)$ 在边界 $r=R$ 处必须连续。\n\\begin{align*} u_{\\text{in}}(R) = u_{\\text{out}}(R) \\quad \\implies \\quad A \\sin(kR) = B e^{-\\kappa R} \\quad (1) \\\\ u'_{\\text{in}}(R) = u'_{\\text{out}}(R) \\quad \\implies \\quad kA \\cos(kR) = - \\kappa B e^{-\\kappa R} \\quad (2) \\end{align*}\n将方程 $(2)$ 除以方程 $(1)$（对于非平凡解），得到关联 $k$ 和 $\\kappa$ 的超越方程：\n$$ k \\cot(kR) = -\\kappa $$\n对于每个给定的束缚能 $E_b$，我们首先计算 $\\kappa$，然后数值求解此方程以得到相应的内部波数 $k$。对于基态（对于给定的势，束缚最深的状态，或者如果势阱足够浅，则为唯一的状态），我们在区间 $(\\frac{\\pi}{2R}, \\frac{\\pi}{R})$ 内寻找 $k$ 的解。\n\n**2.4. 归一化与渐近归一化系数 (ANC)**\n\n波函数必须归一化为1：$\\int_0^\\infty |u(r)|^2 dr = 1$。\n$$ \\int_0^R (A \\sin(kr))^2 dr + \\int_R^\\infty (B e^{-\\kappa r})^2 dr = 1 $$\n从方程 $(1)$，我们有 $B = A \\sin(kR) e^{\\kappa R}$。将其代入归一化积分中：\n$$ A^2 \\left[ \\int_0^R \\sin^2(kr) dr + \\sin^2(kR) e^{2\\kappa R} \\int_R^\\infty e^{-2\\kappa r} dr \\right] = 1 $$\n积分为 $\\int_0^R \\sin^2(kr) dr = \\frac{R}{2} - \\frac{\\sin(2kR)}{4k}$ 和 $\\int_R^\\infty e^{-2\\kappa r} dr = \\frac{e^{-2\\kappa R}}{2\\kappa}$。\n使用超越方程后，括号内的表达式显著简化。详细推导表明，此和恰好为 $\\frac{R}{2} + \\frac{1}{2\\kappa}$。\n$$ A^2 \\left( \\frac{R}{2} + \\frac{1}{2\\kappa} \\right) = 1 \\implies A = \\sqrt{\\frac{2}{R + 1/\\kappa}} $$\n问题通过渐近行为 $u(r) \\approx C e^{-\\kappa r}$（对于 $r \\ge R$）定义了 ANC，记为 $C$。我们的归一化外部解是 $u_{\\text{out}}(r) = B e^{-\\kappa r}$。因此，ANC 就是 $C = B$。使用方程 $(1)$：\n$$ C = B = A \\sin(kR) e^{\\kappa R} = \\sqrt{\\frac{2}{R + 1/\\kappa}} \\sin(kR) e^{\\kappa R} $$\n\n**2.5. 内部重叠相似度**\n\n两个波函数 $u_a(r)$ 和 $u_b(r)$ 之间的相似度 $\\mathcal{S}_{\\mathrm{int}}$ 由下式给出：\n$$ \\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}} $$\n由于在内部区域 $u_i(r) = A_i \\sin(k_i r)$，归一化常数 $A_i$ 从表达式中抵消：\n$$ \\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_0^R \\sin(k_a r)\\sin(k_b r) dr}{\\sqrt{\\left(\\int_0^R \\sin^2(k_a r)dr\\right)\\left(\\int_0^R \\sin^2(k_b r)dr\\right)}} $$\n所需的积分可以解析计算：\n\\begin{align*} \\int_0^R \\sin(k_a r)\\sin(k_b r) dr = \\frac{\\sin((k_a-k_b)R)}{2(k_a-k_b)} - \\frac{\\sin((k_a+k_b)R)}{2(k_a+k_b)} \\quad (\\text{for } k_a \\neq k_b) \\\\ \\int_0^R \\sin^2(k_a r) dr = \\frac{R}{2} - \\frac{\\sin(2k_a R)}{4k_a} \\end{align*}\n\n**2.6. 计算算法**\n\n计算所需值的算法如下：\n1.  定义常数 $R = 4.0$ 和 $c_k = 20.735$。\n2.  创建一个数据结构来存储测试集 $\\{0.05, 0.5, 1.0, 2.0, 5.0\\}$ 中每个 $E_{b,i}$ 的结果。\n3.  对于每个 $E_{b,i}$：\n    a. 计算 $\\kappa_i = \\sqrt{E_{b,i}/c_k}$。\n    b. 使用如 Brent 方法之类的求根算法，在区间 $(\\frac{\\pi}{2R}, \\frac{\\pi}{R})$ 内数值求解超越方程 $k_i \\cot(k_i R) = -\\kappa_i$ 以得到 $k_i$。\n    c. 计算 ANC $C_i = \\sqrt{2/(R + 1/\\kappa_i)} \\sin(k_i R) e^{\\kappa_i R}$。\n    d. 存储计算出的 $k_i$ 和 $C_i$。\n4.  确定与参考能量 $E_{b}^{\\mathrm{ref}} = 1.0$ MeV 对应的参考波数 $k_{\\mathrm{ref}}$。\n5.  对于每个状态 $i$：\n    a. 计算重叠积分 $I_{i, \\mathrm{ref}} = \\int_0^R \\sin(k_i r) \\sin(k_{\\mathrm{ref}} r) dr$。\n    b. 计算自重叠积分 $I_{ii} = \\int_0^R \\sin^2(k_i r) dr$ 和 $I_{\\mathrm{ref}, \\mathrm{ref}} = \\int_0^R \\sin^2(k_{\\mathrm{ref}} r) dr$。\n    c. 计算内部相似度 $\\mathcal{S}_{\\mathrm{int}, i} = I_{i, \\mathrm{ref}} / \\sqrt{I_{ii} I_{\\mathrm{ref}, \\mathrm{ref}}}$。\n6.  将配对 $[C_i, \\mathcal{S}_{\\mathrm{int}, i}]$ 四舍五入到6位小数，并格式化为所需的字符串格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Asymptotic Normalization Coefficient (ANC) and interior overlap\n    similarity for neutron bound states in a spherical square-well potential.\n    \"\"\"\n\n    # Physical and numerical parameters from the problem statement.\n    R = 4.0  # Square-well radius in fm\n    HBAR2_2MU = 20.735  # Kinetic constant in MeV*fm^2\n    E_B_VALUES = [0.05, 0.5, 1.0, 2.0, 5.0]  # Binding energies in MeV\n    E_B_REF = 1.0  # Reference binding energy in MeV\n\n    def solve_transcendental_k(kappa, R_val):\n        \"\"\"\n        Solves the transcendental equation k*cot(k*R) = -kappa for k.\n        The ground state solution is sought in the interval k*R in (pi/2, pi).\n        \"\"\"\n        # Define the function whose root we want to find: f(k) = k*cot(k*R) + kappa\n        def f(k):\n            return k / np.tan(k * R_val) + kappa\n\n        # The root is located in the interval (pi/(2*R), pi/R).\n        # We add a small epsilon to avoid the poles of the cotangent function.\n        epsilon = 1e-9\n        k_min = np.pi / (2 * R_val) + epsilon\n        k_max = np.pi / R_val - epsilon\n\n        # Use Brent's method to find the root k.\n        # f(k_min) is positive and f(k_max) is negative in this interval.\n        k_solution = brentq(f, k_min, k_max)\n        return k_solution\n\n    def integrate_sin_product(k1, k2, R_val):\n        \"\"\"\n        Calculates the definite integral of sin(k1*r) * sin(k2*r) from 0 to R.\n        \"\"\"\n        # Case 1: k1 is close to k2 (diagonal term)\n        if np.isclose(k1, k2):\n            return R_val / 2.0 - np.sin(2.0 * k1 * R_val) / (4.0 * k1)\n        # Case 2: k1 is different from k2 (off-diagonal term)\n        else:\n            term1 = np.sin((k1 - k2) * R_val) / (2.0 * (k1 - k2))\n            term2 = np.sin((k1 + k2) * R_val) / (2.0 * (k1 + k2))\n            return term1 - term2\n\n    # Store wavefunction parameters (k and C) for each energy\n    wavefunction_params = {}\n\n    for eb in E_B_VALUES:\n        kappa = np.sqrt(eb / HBAR2_2MU)\n        k = solve_transcendental_k(kappa, R)\n\n        # Calculate the normalization constant A of the interior wavefunction\n        # The derivation A = sqrt(2 / (R + 1/kappa)) is incorrect in the provided logic.\n        # A more robust normalization is done by directly calculating the integrals.\n        # B = A sin(kR) exp(kappa R).\n        # A^2 int_0^R sin^2(kr) dr + B^2 int_R^inf exp(-2kr) dr = 1\n        # A^2 [ int_0^R sin^2(kr) dr + sin^2(kR)exp(2kR) int_R^inf exp(-2kr) dr ] = 1\n        integral_in = integrate_sin_product(k, k, R)\n        integral_out = np.exp(-2 * kappa * R) / (2 * kappa)\n        A_squared = 1.0 / (integral_in + (np.sin(k * R)**2) * integral_out)\n        A = np.sqrt(A_squared)\n\n        # Calculate the Asymptotic Normalization Coefficient (ANC) C\n        # C is the normalization constant for the exterior part, which is B in derivation.\n        # C = B = A * sin(k*R) * exp(kappa*R)\n        anc = A * np.sin(k * R) * np.exp(kappa * R)\n\n        wavefunction_params[eb] = {'k': k, 'C': anc}\n\n    # Retrieve the reference wavenumber k_ref\n    k_ref = wavefunction_params[E_B_REF]['k']\n\n    results = []\n    # Calculate self-overlap integral for the reference state\n    den_integral_ref = integrate_sin_product(k_ref, k_ref, R)\n\n    for eb in E_B_VALUES:\n        params = wavefunction_params[eb]\n        k_i = params['k']\n        C_i = params['C']\n\n        # Calculate overlap integrals for S_int\n        num_integral = integrate_sin_product(k_i, k_ref, R)\n        den_integral_i = integrate_sin_product(k_i, k_i, R)\n        \n        # Calculate the interior overlap similarity S_int\n        S_int = num_integral / np.sqrt(den_integral_i * den_integral_ref)\n\n        # Append the rounded results\n        results.append([round(C_i, 6), round(S_int, 6)])\n\n    # Format the final output string as specified in the problem\n    output_str = \"[\" + \", \".join([f\"[{c}, {s}]\" for c, s in results]) + \"]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "3591851"}]}