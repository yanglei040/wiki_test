{"hands_on_practices": [{"introduction": "独立粒子模型（IPM）的成功不仅在于其平均场近似，更关键在于引入了自旋-轨道耦合项。这项练习将引导你完成一项核心的量子力学计算，即推导和量化由该相互作用引起的能级移动。掌握这项计算不仅是应用角动量代数解决物理问题的基本功，也为理解核壳层结构的形成奠定了数学基础。[@problem_id:3602406]", "problem": "考虑在原子核的独立粒子模型中，一个在球对称平均场中运动的单个核子。非相对论哈密顿量取为中心部分和自旋-轨道相互作用之和，\n$$\nH \\;=\\; T \\,+\\, U(r) \\,+\\, H_{ls},\n$$\n其中 $T$ 是动能算符，$U(r)$ 是一个中心势，以及\n$$\nH_{ls} \\;=\\; W_{ls}(r)\\,\\mathbf{l}\\cdot\\mathbf{s}\n$$\n是自旋-轨道相互作用，其中 $W_{ls}(r)$ 是 $r$ 的一个标量函数。假设核子的内禀自旋为 $s=\\tfrac{1}{2}$，并且对于由 $(n,l,j)$ 标记的束缚单粒子本征态，$H_{ls}$ 可以用一级微扰理论处理，其中 $n$ 是主量子数，$l$ 是轨道角动量，$j$ 是由耦合 $\\mathbf{j}=\\mathbf{l}+\\mathbf{s}$ 得到的总角动量。\n\n从角动量相加法则和 $\\mathbf{j}^2$ 的定义出发，推导在单粒子态 $(n,l,j)$ 中期望值 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 的通式。然后，利用一级微扰理论，用 $\\langle W_{ls}(r)\\rangle_{nl}$ 和 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 表示自旋-轨道能量移动 $\\Delta E_{j}$，其中\n$$\n\\langle W_{ls}(r)\\rangle_{nl} \\;\\equiv\\; \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r\n$$\n是具有径向波函数 $R_{nl}(r)$ 的 $(n,l)$ 态的径向期望值。\n\n现在考虑一个处于 $(n=2,l=3)$ 态的中子，其所在原子核的质量数为 $A=40$，对此，径向期望值的数值计算给出 $\\langle W_{ls}(r)\\rangle_{nl} = C_{nl} = 0.9$ $\\mathrm{MeV}$。使用你推导的 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 表达式来估算自旋-轨道能量分裂\n$$\n\\Delta E_{\\mathrm{so}} \\;\\equiv\\; E_{j=l+\\tfrac{1}{2}} \\;-\\; E_{j=l-\\tfrac{1}{2}}\n$$\n对于此 $(n,l)$ 组态。以 $\\mathrm{MeV}$ 为单位给出 $\\Delta E_{\\mathrm{so}}$ 的最终数值。无需四舍五入；报告由给定数据所隐含的精确值。", "solution": "根据验证标准对问题陈述进行评估。\n\n### 步骤1：提取已知条件\n- **哈密顿量：** $H = T + U(r) + H_{ls}$\n- **动能算符：** $T$\n- **中心势：** $U(r)$\n- **自旋-轨道相互作用：** $H_{ls} = W_{ls}(r)\\,\\mathbf{l}\\cdot\\mathbf{s}$，其中 $W_{ls}(r)$ 是 $r$ 的一个标量函数。\n- **核子内禀自旋：** $s=\\frac{1}{2}$\n- **微扰：** $H_{ls}$ 用一级微扰理论处理。\n- **单粒子态：** 由 $(n,l,j)$ 标记，其中 $n$ 是主量子数，$l$ 是轨道角动量，$j$ 是总角动量。\n- **总角动量：** $\\mathbf{j}=\\mathbf{l}+\\mathbf{s}$\n- **径向期望值的定义：** $\\langle W_{ls}(r)\\rangle_{nl} \\equiv \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r$，其中 $R_{nl}(r)$ 是径向波函数。\n- **特定情况：** 一个处于 $(n=2,l=3)$ 态的中子。\n- **原子核质量数：** $A=40$。\n- **给定的数值：** 对于指定的状态，$\\langle W_{ls}(r)\\rangle_{nl} = C_{nl} = 0.9$ $\\mathrm{MeV}$。\n- **目标量：** 自旋-轨道能量分裂 $\\Delta E_{\\mathrm{so}} \\equiv E_{j=l+\\tfrac{1}{2}} - E_{j=l-\\tfrac{1}{2}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是原子核壳层模型理论中的一个标准练习，属于计算核物理的一个子领域。\n- **科学依据：** 哈密顿量的形式，包括中心势和自旋-轨道耦合项，是原子核独立粒子模型（壳层模型）的基石。所提出的方法，即一级微扰理论，是计算能量移动的标准量子力学技术。所有概念都基于已建立的量子力学和核物理原理。\n- **良构性：** 该问题提供了推导所需表达式和计算最终数值所需的所有必要信息。它要求基于所提供的数据和标准物理定律计算一个特定的、可计算的量。在该模型的背景下，解是唯一且有意义的。\n- **客观性：** 该问题使用精确、标准的科学术语进行陈述。没有主观或模糊的陈述。\n- **无其他缺陷：** 该问题是自洽的，其前提是合理的，不涉及任何逻辑矛盾或不切实际的物理。$\\langle W_{ls}(r)\\rangle_{nl}$ 的值在物理上是合理的。\n\n### 步骤3：结论和行动\n该问题有效。将提供解答。\n\n解答过程分三部分。首先，我们推导期望值 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 的通式。其次，我们在 一级微扰理论框架内使用此结果求出能量分裂 $\\Delta E_{\\mathrm{so}}$。第三，我们计算给定情况下的数值。\n\n总角动量算符 $\\mathbf{j}$ 是轨道角动量算符 $\\mathbf{l}$ 和自旋角动量算符 $\\mathbf{s}$ 的和：\n$$\n\\mathbf{j} = \\mathbf{l} + \\mathbf{s}\n$$\n对该算符进行平方得到：\n$$\n\\mathbf{j}^2 = (\\mathbf{l} + \\mathbf{s}) \\cdot (\\mathbf{l} + \\mathbf{s}) = \\mathbf{l}^2 + \\mathbf{s}^2 + 2\\,\\mathbf{l}\\cdot\\mathbf{s}\n$$\n我们可以重排此方程，用平方角动量算符来表示自旋-轨道耦合算符 $\\mathbf{l}\\cdot\\mathbf{s}$：\n$$\n\\mathbf{l}\\cdot\\mathbf{s} = \\frac{1}{2} (\\mathbf{j}^2 - \\mathbf{l}^2 - \\mathbf{s}^2)\n$$\n单粒子态，记为 $|n, l, j, m_j\\rangle$，是算符 $\\mathbf{j}^2$、$\\mathbf{l}^2$ 和 $\\mathbf{s}^2$ 的共同本征态。这些算符的本征值由以下各式给出：\n- $\\mathbf{j}^2 |n, l, j, m_j\\rangle = j(j+1)\\hbar^2 |n, l, j, m_j\\rangle$\n- $\\mathbf{l}^2 |n, l, j, m_j\\rangle = l(l+1)\\hbar^2 |n, l, j, m_j\\rangle$\n- $\\mathbf{s}^2 |n, l, j, m_j\\rangle = s(s+1)\\hbar^2 |n, l, j, m_j\\rangle$\n\n在核物理学中，习惯上使用无量纲的角动量算符，其中 $\\mathbf{L} = \\mathbf{l}\\hbar$ 和 $\\mathbf{S} = \\mathbf{s}\\hbar$。哈密顿量中的算符写作 $\\mathbf{l}\\cdot\\mathbf{s}$，被视为一个无量纲量。因此，该算符的期望值是通过将算符替换为其对应的本征值，但不包含 $\\hbar^2$ 因子来求得的。\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle = \\langle n, l, j, m_j | \\frac{1}{2} (\\mathbf{j}^2 - \\mathbf{l}^2 - \\mathbf{s}^2) | n, l, j, m_j \\rangle = \\frac{1}{2} [j(j+1) - l(l+1) - s(s+1)]\n$$\n对于一个核子，自旋为 $s=\\frac{1}{2}$，因此 $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。表达式变为：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle = \\frac{1}{2} \\left[ j(j+1) - l(l+1) - \\frac{3}{4} \\right]\n$$\n对于给定的 $l > 0$，总角动量量子数 $j$ 可以取两个可能的值：$j=l+\\frac{1}{2}$ 和 $j=l-\\frac{1}{2}$。\n- 对于 $j = l+\\frac{1}{2}$：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} = \\frac{1}{2} \\left[ \\left(l+\\frac{1}{2}\\right)\\left(l+\\frac{3}{2}\\right) - l(l+1) - \\frac{3}{4} \\right] = \\frac{1}{2} \\left[ \\left(l^2 + 2l + \\frac{3}{4}\\right) - (l^2+l) - \\frac{3}{4} \\right] = \\frac{1}{2}l\n$$\n- 对于 $j = l-\\frac{1}{2}$：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2} = \\frac{1}{2} \\left[ \\left(l-\\frac{1}{2}\\right)\\left(l+\\frac{1}{2}\\right) - l(l+1) - \\frac{3}{4} \\right] = \\frac{1}{2} \\left[ \\left(l^2 - \\frac{1}{4}\\right) - (l^2+l) - \\frac{3}{4} \\right] = \\frac{1}{2}(-l-1) = -\\frac{l+1}{2}\n$$\n\n接下来，我们应用一级微扰理论来求由自旋-轨道相互作用 $H_{ls} = W_{ls}(r)\\mathbf{l}\\cdot\\mathbf{s}$ 引起的能量移动 $\\Delta E_j$。能量移动是在未微扰态 $|n,l,j,m_j\\rangle$ 中微扰的期望值。\n$$\n\\Delta E_j = \\langle n,l,j,m_j | W_{ls}(r)\\mathbf{l}\\cdot\\mathbf{s} | n,l,j,m_j \\rangle\n$$\n由于算符 $W_{ls}(r)$ 只作用于波函数的径向部分，而 $\\mathbf{l}\\cdot\\mathbf{s}$ 只作用于自旋-角动量部分，因此期望值可以分离为径向期望值和自旋-角动量期望值的乘积。\n$$\n\\Delta E_j = \\left( \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r \\right) \\cdot \\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{lj}\n$$\n使用问题陈述中的记号，这可以写成：\n$$\n\\Delta E_j = \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{lj}\n$$\n\n自旋-轨道能量分裂 $\\Delta E_{\\mathrm{so}}$ 是对于给定的 $l$ 的两个可能的 $j$ 态的能量之差。未微扰能量 $E^{(0)}_{nl}$ 依赖于 $n$ 和 $l$，但不依赖于 $j$。因此，能量分裂就是一级能量移动之差。\n$$\n\\Delta E_{\\mathrm{so}} = E_{j=l+\\tfrac{1}{2}} - E_{j=l-\\tfrac{1}{2}} = (E^{(0)}_{nl} + \\Delta E_{l+1/2}) - (E^{(0)}_{nl} + \\Delta E_{l-1/2}) = \\Delta E_{l+1/2} - \\Delta E_{l-1/2}\n$$\n代入能量移动的表达式：\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} - \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2}\n$$\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} - \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2} \\right)\n$$\n使用推导出的 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 的值：\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\frac{l}{2} - \\left(-\\frac{l+1}{2}\\right) \\right) = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\frac{l+l+1}{2} \\right)\n$$\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\frac{2l+1}{2}\n$$\n\n最后，我们代入为 $(n=2,l=3)$ 态的中子所提供的数值。给定 $l=3$ 且 $\\langle W_{ls}(r)\\rangle_{nl} = 0.9$ $\\mathrm{MeV}$。\n$$\n\\Delta E_{\\mathrm{so}} = (0.9 \\; \\mathrm{MeV}) \\cdot \\frac{2(3)+1}{2} = (0.9 \\; \\mathrm{MeV}) \\cdot \\frac{7}{2}\n$$\n$$\n\\Delta E_{\\mathrm{so}} = (0.9 \\; \\mathrm{MeV}) \\cdot 3.5 = 3.15 \\; \\mathrm{MeV}\n$$\n计算得出 $l=3$ 能级的自旋-轨道分裂为 $3.15$ $\\mathrm{MeV}$。", "answer": "$$\n\\boxed{3.15}\n$$", "id": "3602406"}, {"introduction": "在掌握了上一练习中的数学工具后，我们现在可以探究其深远的物理效应。这项计算实践将向你展示，我们刚刚量化的自旋-轨道分裂如何显著地重构简谐振子势中的能级结构。通过编写程序来模拟这个模型并调整相互作用强度，你将亲眼见证正确的核魔法数是如何涌现的，从而在计算中直观地理解壳层结构的起源。[@problem_id:3602363]", "problem": "要求您对球对称平均场中具有自旋轨道相互作用的核子独立粒子模型进行计算研究。从球形三維谐振子作为基准平均场开始，并加入单体自旋轨道项。核心思想是模拟单粒子能谱，观察自旋轨道强度如何破坏主壳层内的简并模式，以及推断出的幻数如何随自旋轨道强度的变化而改变。\n\n使用以下物理上标准且被广泛接受的出发点：\n\n- 在独立粒子模型中，单个核子在平均场势中运动。对于球形谐振子，未微扰能量由 $E_{\\mathrm{HO}} = \\hbar\\omega\\left(N + \\tfrac{3}{2}\\right)$ 给出，其中 $N = 2n + \\ell$ 是主振子量子数，$n \\in \\{0,1,2,\\dots\\}$ 是径向量子数，$\\ell \\in \\{0,1,2,\\dots\\}$ 是轨道角动量量子数。\n\n- 单体自旋轨道算符为 $\\hat{V}_{\\ell s} = V_{ls}\\,\\hat{\\ell}\\cdot\\hat{s}$，其中 $V_{ls}$ 是一个强度参数（单位为 $\\mathrm{MeV}$），$\\hat{\\ell}$ 是轨道角动量算符，$\\hat{s}$ 是自旋为 $s = \\tfrac{1}{2}$ 的核子的自旋算符。\n\n- 对于一个由 $(N,\\ell,j)$ 标记的球谐基态，其总角动量为 $j \\in \\{\\ell \\pm \\tfrac{1}{2}\\}$（对于 $\\ell=0$ 只有 $j=\\tfrac{1}{2}$），其期望值为 $\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = \\tfrac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-s(s+1)\\right]$，其中 $s(s+1) = \\tfrac{3}{4}$。\n\n- 对于单一核子种类（中子或质子），给定 $(\\ell,j)$ 能级的简并度（容量）为 $g = 2j+1$。\n\n将单粒子能量定义为\n$$\nE_{N\\ell j} = \\hbar\\omega\\left(N + \\tfrac{3}{2}\\right) + V_{ls}\\,\\tfrac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-\\tfrac{3}{4}\\right],\n$$\n其中 $\\hbar\\omega$ 是一个固定标度，而 $V_{ls}$ 是可变的。在本问题中，您必须取 $\\hbar\\omega = 10\\,\\mathrm{MeV}$，并在负值范围内扫描 $V_{ls}$，以观察简并性如何被破坏以及幻数如何变化。\n\n算法说明：\n\n1. 枚举所有球谐振子轨道 $(N,\\ell,j)$，其中 $N \\in \\{0,1,2,3,4,5,6\\}$（即 $N_{\\max}=6$）。对于每个 $N$，包括所有允许的 $\\ell \\in \\{N, N-2, \\dots, 0 \\text{ or } 1\\}$，对于每个 $\\ell>0$，包括 $j=\\ell-\\tfrac{1}{2}$ 和 $j=\\ell+\\tfrac{1}{2}$，而对于 $\\ell=0$，只包括 $j=\\tfrac{1}{2}$。\n\n2. 对于给定的 $V_{ls}$，计算每个 $E_{N\\ell j}$（单位为 $\\mathrm{MeV}$）和相应的简并度 $g=2j+1$。按能量 $E_{N\\ell j}$ 升序对所有能级进行排序。\n\n3. 将累积占据数 $C_{k}$ 定义为按能量递增顺序填充能级后简并度的累加和，即 $C_{k} = \\sum_{i=1}^{k} g_{i}$。为了从能谱中确定幻数，引入一个固定的“显著能隙”阈值 $\\Delta_{\\mathrm{gap}}$（单位为 $\\mathrm{MeV}$）。当连续能级之间的能隙满足 $\\Delta E_{k} = E_{k+1} - E_{k} \\ge \\Delta_{\\mathrm{gap}}$ 时，将 $C_{k}$ 记录为一个幻数（解释为单一核子种类的满壳层闭合）。使用 $\\Delta_{\\mathrm{gap}} = 5\\,\\mathrm{MeV}$。\n\n4. 只报告不超过 $126$ 的幻数（即，报告任何 $C_{k} \\le 126$ 并忽略更大的闭壳）。这对应于单一核子种类已确立的幻数的标准范围。\n\n物理单位：\n\n- 所有能量必须以 $\\mathrm{MeV}$ 为单位处理。输出的幻数是无量纲整数。\n\n角度单位不适用于此问题。\n\n测试组：\n\n- 使用以下自旋轨道强度（单位为 $\\mathrm{MeV}$）：$V_{ls} \\in \\{0, -2.5, -5.0, -7.5, -10.0\\}$。\n- 对于这些值中的每一个，计算由上述规则定义的幻数列表。\n\n最终输出格式：\n\n- 您的程序必须生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，用方括号括起来，不含空格。例如，对于三个测试用例，其输出分别为 $[2,8]$, $[2,8,20]$, 和 $[2,8,20,28]$, 则要求的输出应确切为 \"[[2,8],[2,8,20],[2,8,20,28]]\"。\n- 在此问题中，您的程序的单行输出必须是包含五个列表的列表，按顺序分别对应于 $V_{ls} = 0$, $-2.5$, $-5.0$, $-7.5$, 和 $-10.0$。", "solution": "该问题是有效的。其科学基础是原子核壳层模型原理，问题提法适定，有明确的算法路径可得到唯一解，并以客观、正式的语言陈述。所有必需的参数和条件均已给出，且无内部矛盾。\n\n解决此问题需要计算模拟平均场中核子的单粒子能谱，并识别幻数，幻数对应于由显著能隙隔开的满壳层。该模型从球形三维量子谐振子开始，并加入一个自旋轨道相互作用项，这对于重现经验上观测到的超过 $20$ 的幻数至关重要。\n\n由主振子壳层 ($N$)、轨道角动量 ($\\ell$) 和总角动量 ($j$) 等量子数表征的单粒子态（或轨道）的能量，由谐振子能量和自旋轨道能量修正之和给出：\n$$\nE_{N\\ell j} = E_{\\mathrm{HO}} + E_{\\ell s}\n$$\n未微扰的谐振子能量仅取决于主壳层数 $N=2n+\\ell$，其中 $n$ 是径向量子数。给定能量标度 $\\hbar\\omega = 10\\,\\mathrm{MeV}$，其能量为：\n$$\nE_{\\mathrm{HO}} = \\hbar\\omega\\left(N + \\frac{3}{2}\\right) = 10\\left(N + \\frac{3}{2}\\right)\\,\\mathrm{MeV}\n$$\n在没有其他相互作用的情况下，给定 $N$ 壳层内的所有轨道都是简并的，这导致幻数出现在 $2, 8, 20, 40, 70$ 和 $112$。\n\n自旋轨道相互作用 $\\hat{V}_{\\ell s} = V_{ls}\\,\\hat{\\ell}\\cdot\\hat{s}$ 打破了这种简并。能量修正 $E_{\\ell s}$ 是该算符的期望值。对于一个量子数为 $\\ell$ 和 $j$（其中对于 $\\ell > 0$，$j$ 可以是 $\\ell \\pm \\frac{1}{2}$）且核子自旋为 $s=\\frac{1}{2}$ 的态，其期望值为：\n$$\nE_{\\ell s} = \\langle \\hat{V}_{\\ell s} \\rangle = V_{ls}\\,\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = V_{ls}\\,\\frac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-s(s+1)\\right]\n$$\n代入 $s(s+1) = \\frac{3}{4}$，对于 $\\ell > 0$ 可简化为两种情况：\n1.  对于 $j=\\ell+\\frac{1}{2}$（自旋和轨道角动量平行）：$\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = \\frac{\\ell}{2}$。能量移动为 $V_{ls}\\frac{\\ell}{2}$。\n2.  对于 $j=\\ell-\\frac{1}{2}$（自旋和轨道角动量反平行）：$\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = -\\frac{\\ell+1}{2}$。能量移动为 $-V_{ls}\\frac{\\ell+1}{2}$。\n\n对于 $\\ell = 0$，我们必须有 $j=\\frac{1}{2}$，且自旋轨道能量移动为零。由于物理上的自旋轨道强度 $V_{ls}$ 是负值，“平行” ($j=\\ell+\\frac{1}{2}$) 轨道的能量降低，而“反平行” ($j=\\ell-\\frac{1}{2}$) 轨道的能量升高。这种分裂的幅度随 $\\ell$ 增大而增加。这种效应在每个壳层中 $\\ell$ 值最高的轨道上最为显著，该轨道能量可能降低到足以成为下一层壳层的一部分，从而重构壳隙并产生正确的幻数序列。\n\n寻找幻数的算法流程如下：\n\n1.  **枚举态**：系统地生成主壳层数 $N$ 从 $0$ 到 $6$ 的所有允许的单粒子态 $(N, \\ell, j)$。对于每个 $N$，允许的轨道角动量为 $\\ell = N, N-2, \\dots, 0$ 或 $1$。对于每个 $\\ell$，确定相应的 $j$ 值。\n\n2.  **计算能级属性**：对于每个生成的态和给定的自旋轨道强度 $V_{ls}$，使用上述公式计算其能量 $E_{N\\ell j}$。同时，计算其简并度（它能容纳的一种核子的数量），由 $g = 2j+1$ 给出。\n\n3.  **按能量排序**：创建一个包含所有态及其相应能量和简并度的列表。按能量升序对此列表进行排序。这个排序后的顺序代表了核子填充轨道的序列。\n\n4.  **识别能隙**：遍历排序后的能级列表。维持简并度的累加和，即累积占据数 ($C_k = \\sum_{i=1}^{k} g_i$)。处理完每个能级后，计算到下一个能级的能隙 $\\Delta E_k = E_{k+1} - E_k$。如果此能隙大于或等于指定的阈值 $\\Delta_{\\mathrm{gap}} = 5\\,\\mathrm{MeV}$，则当前的累积占据数 $C_k$ 被记录为一个幻数，前提是它不超过指定的最大值 $126$。\n\n对测试组中的每个 $V_{ls}$ 值 $\\{0, -2.5, -5.0, -7.5, -10.0\\}\\,\\mathrm{MeV}$ 重复此过程，以观察壳层结构和幻数如何随自旋轨道相互作用的强度演化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nuclear magic numbers based on the independent particle model\n    with a harmonic oscillator potential and a spin-orbit term.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a single value for the spin-orbit strength V_ls in MeV.\n    test_cases = [0.0, -2.5, -5.0, -7.5, -10.0]\n\n    # Global parameters from the problem\n    HW = 10.0  # MeV, Harmonic oscillator energy scale h-bar * omega\n    DELTA_GAP = 5.0  # MeV, Threshold for identifying a magic number gap\n    N_MAX = 6  # Maximum major oscillator quantum number\n    MAX_MAGIC_NUMBER = 126  # Report magic numbers up to this value\n\n    all_results = []\n\n    for v_ls in test_cases:\n        levels = []\n        \n        # Step 1: Enumerate all single-particle states (N, l, j) and\n        # calculate their energies and degeneracies.\n        for N in range(N_MAX + 1):\n            # The allowed orbital angular momenta l have the same parity as N\n            # and satisfy l = N.\n            for l in range(N, -1, -2):\n                e_ho = HW * (N + 1.5)\n                \n                if l == 0:\n                    # For l=0, only j=1/2 is possible. The spin-orbit term is zero.\n                    j = 0.5\n                    ls_expectation = 0.0\n                    energy = e_ho + v_ls * ls_expectation\n                    degeneracy = 2 * j + 1\n                    levels.append({'energy': energy, 'degeneracy': degeneracy})\n                else:\n                    # For l > 0, two j values are possible: j = l +/- 1/2.\n                    # Case 1: j = l + 1/2 (spin-aligned)\n                    j_plus = l + 0.5\n                    ls_expectation_plus = 0.5 * l\n                    energy_plus = e_ho + v_ls * ls_expectation_plus\n                    degeneracy_plus = 2 * j_plus + 1\n                    levels.append({'energy': energy_plus, 'degeneracy': degeneracy_plus})\n\n                    # Case 2: j = l - 1/2 (spin-anti-aligned)\n                    j_minus = l - 0.5\n                    ls_expectation_minus = -0.5 * (l + 1)\n                    energy_minus = e_ho + v_ls * ls_expectation_minus\n                    degeneracy_minus = 2 * j_minus + 1\n                    levels.append({'energy': energy_minus, 'degeneracy': degeneracy_minus})\n        \n        # Step 2: Sort the levels by ascending energy to determine the filling order.\n        levels.sort(key=lambda x: x['energy'])\n\n        # Step 3: Identify magic numbers by finding large energy gaps in the sorted spectrum.\n        magic_numbers = []\n        cumulative_occupancy = 0\n        for i in range(len(levels) - 1):\n            # Accumulate the number of particles filling shells up to the current level.\n            cumulative_occupancy += levels[i]['degeneracy']\n            \n            # Calculate the energy gap to the next level.\n            energy_gap = levels[i+1]['energy'] - levels[i]['energy']\n            \n            # If the gap is significant, the cumulative occupancy is a magic number.\n            if energy_gap >= DELTA_GAP:\n                if cumulative_occupancy = MAX_MAGIC_NUMBER:\n                    magic_numbers.append(int(cumulative_occupancy))\n\n        all_results.append(magic_numbers)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[[2,8,20],[2,8,20,28],...]\"\n    outer_parts = [f'[{\",\".join(map(str, sublist))}]' for sublist in all_results]\n    print(f\"[{','.join(outer_parts)}]\")\n\nsolve()\n```", "id": "3602363"}, {"introduction": "一个成功的物理模型不仅要能解释已知现象，还必须做出可检验的预测。这项练习将应用独立粒子模型，并通过一个常见的近似（类库普曼斯近似）来预测一个关键的核物理观测量——核子分离能。通过将这些理论预测与实验数据进行比较，你将学会如何量化模型的表现，识别其系统性偏差，并体会平均场方法的成功与局限。[@problem_id:3602424]", "problem": "要求您使用类库普曼斯近似 (Koopmans-like approximation) 对独立粒子模型 (Independent Particle Model, IPM) 在核分离能方面的应用进行计算评估，并量化其相对于同位素链参考数据的系统性偏差。独立粒子模型 (IPM) 假设核子在平均场势中独立运动，从而产生单粒子能级。在类库普曼斯近似中，移除一个核子所需的能量被估计为最后一个被占据的单粒子轨道能量的负值，忽略了重排和关联效应。\n\n从以下基本和核心定义开始：\n- 中子分离能 $S_n(N,Z)$ 和质子分离能 $S_p(N,Z)$ 被定义为核结合能的差值，即 $S_n(N,Z) = B(N,Z) - B(N-1,Z)$ 和 $S_p(N,Z) = B(N,Z) - B(N,Z-1)$，其中 $B(N,Z)$ 是中子数为 $N$、质子数为 $Z$ 的原子核的结合能。\n- 在平均场图像中，根据类库普曼斯论证，当忽略重排时，从一个填满的轨道上移除一个核子的能量可以近似为其单粒子能量的负值。因此，类库普曼斯预测值为 $S_n^{\\mathrm{Koop}}(N,Z) \\approx -\\epsilon^{(n)}_{N}$ 和 $S_p^{\\mathrm{Koop}}(N,Z) \\approx -\\epsilon^{(p)}_{Z}$，其中 $\\epsilon^{(n)}_{i}$ 和 $\\epsilon^{(p)}_{j}$ 分别是中子和质子的单粒子能量，并已排序，使得中子和质子最后一个被占据的能级索引分别为 $N$ 和 $Z$。\n\n您的程序必须：\n1. 对所提供的同位素链中的每个原子核，根据最后一个被占据的IPM单粒子能量计算类库普曼斯估计值 $S_n^{\\mathrm{Koop}}(N,Z)$ 和 $S_p^{\\mathrm{Koop}}(N,Z)$，并将它们与参考分离能 $S_n^{\\mathrm{exp}}(N,Z)$ 和 $S_p^{\\mathrm{exp}}(N,Z)$ 进行比较。\n2. 对每个同位素链（固定的 $Z$，变化的 $N$），分别为中子和质子计算以下指标：\n   - 平均偏差 $\\overline{\\Delta S}$，定义为链中所有原子核的 $\\Delta S = S^{\\mathrm{Koop}} - S^{\\mathrm{exp}}$ 的算术平均值。\n   - 均方根误差 (RMSE) $E_{\\mathrm{rms}} = \\sqrt{\\frac{1}{M}\\sum_{k=1}^M (\\Delta S_k)^2}$，其中 $M$ 是链中原子核的数量。\n   - 偏差与中子数关系的线性趋势斜率 $b$，通过最小二乘法得到 $b = \\frac{\\sum_{k}(N_k - \\overline{N}) \\Delta S_k}{\\sum_{k}(N_k - \\overline{N})^2}$，并约定如果分母为零（单个数据点），则 $b$ 设为 $0.0$。\n3. 同时计算所有链中所有原子核的总体指标：中子和质子的总体平均偏差和总体均方根误差。\n\n所有能量单位必须以兆电子伏 (MeV) 处理。最终输出必须以 MeV 为单位呈现所有数值，并四舍五入到三位小数。\n\n使用以下同位素链测试套件。每个链指定一个固定的质子数 $Z$，并为每个原子核提供中子数 $N$、IPM单粒子能量（对中子，占据到 $N$；对质子，占据到 $Z$；单位为 MeV，从最束缚到最不束缚排序）以及参考分离能 $S_n^{\\mathrm{exp}}$ 和 $S_p^{\\mathrm{exp}}$（单位也为 MeV）。\n\n链 1：Oxygen, $Z = 8$\n- $N = 8$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-25.0,-18.0,-16.5,-16.0,-15.8,-15.6\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-21.0,-18.0,-14.0,-13.5,-12.9,-12.4,-12.1\\}$, $S_n^{\\mathrm{exp}} = 15.7$, $S_p^{\\mathrm{exp}} = 12.1$.\n- $N = 10$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-25.0,-18.0,-16.0,-13.0,-11.5,-10.5,-9.5,-9.0\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-21.0,-18.0,-14.0,-13.5,-12.9,-12.3,-11.8\\}$, $S_n^{\\mathrm{exp}} = 8.0$, $S_p^{\\mathrm{exp}} = 11.7$.\n- $N = 12$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-25.0,-18.0,-16.0,-13.0,-11.5,-10.5,-9.5,-8.0,-6.8,-6.0\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-21.0,-18.0,-14.0,-13.5,-12.8,-12.2,-11.5\\}$, $S_n^{\\mathrm{exp}} = 6.0$, $S_p^{\\mathrm{exp}} = 11.3$.\n\n链 2：Neon, $Z = 10$\n- $N = 10$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-12.3,-12.0\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-25.0,-20.0,-15.0,-12.0,-10.5,-9.5,-9.0,-8.7,-8.5\\}$, $S_n^{\\mathrm{exp}} = 12.0$, $S_p^{\\mathrm{exp}} = 8.6$.\n- $N = 12$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-10.5,-10.0,-9.8,-9.7\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-25.0,-20.0,-15.0,-12.0,-10.8,-9.7,-9.2,-8.9,-8.7\\}$, $S_n^{\\mathrm{exp}} = 9.8$, $S_p^{\\mathrm{exp}} = 8.8$.\n- $N = 14$: $\\{\\epsilon^{(n)}\\} = \\{-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-10.5,-9.8,-8.2,-7.8,-7.6,-7.4\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-25.0,-20.0,-15.0,-12.0,-11.0,-10.0,-9.4,-9.1,-8.9\\}$, $S_n^{\\mathrm{exp}} = 7.6$, $S_p^{\\mathrm{exp}} = 9.0$.\n\n链 3：Magnesium, $Z = 12$\n- $N = 12$: $\\{\\epsilon^{(n)}\\} = \\{-42.0,-32.0,-28.0,-22.0,-20.0,-18.0,-16.0,-14.5,-13.5,-13.0,-12.9,-12.8\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-28.0,-24.0,-20.0,-16.0,-13.0,-11.0,-9.5,-8.9,-8.5,-8.3,-8.1\\}$, $S_n^{\\mathrm{exp}} = 13.0$, $S_p^{\\mathrm{exp}} = 8.0$.\n- $N = 14$: $\\{\\epsilon^{(n)}\\} = \\{-42.0,-32.0,-28.0,-22.0,-20.0,-18.0,-16.0,-14.5,-13.5,-12.0,-11.2,-10.9,-10.7,-10.5\\}$, $\\{\\epsilon^{(p)}\\} = \\{-38.0,-28.0,-24.0,-20.0,-16.0,-13.0,-11.0,-9.6,-9.1,-8.7,-8.5,-8.3\\}$, $S_n^{\\mathrm{exp}} = 10.4$, $S_p^{\\mathrm{exp}} = 8.2$.\n\n链 4：Carbon, $Z = 6$\n- $N = 6$: $\\{\\epsilon^{(n)}\\} = \\{-48.0,-38.0,-28.0,-22.0,-20.0,-18.8\\}$, $\\{\\epsilon^{(p)}\\} = \\{-45.0,-35.0,-25.0,-20.0,-17.0,-15.2\\}$, $S_n^{\\mathrm{exp}} = 18.7$, $S_p^{\\mathrm{exp}} = 15.1$.\n\n对于每个原子核，使用提供的已排序能量列表的最后一个条目，计算类库普曼斯预测值 $S_n^{\\mathrm{Koop}}(N,Z) = -\\epsilon^{(n)}_{N}$ 和 $S_p^{\\mathrm{Koop}}(N,Z) = -\\epsilon^{(p)}_{Z}$。然后计算偏差 $\\Delta S_n = S_n^{\\mathrm{Koop}} - S_n^{\\mathrm{exp}}$ 和 $\\Delta S_p = S_p^{\\mathrm{Koop}} - S_p^{\\mathrm{exp}}$。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表的列表，不含空格。每个内部列表对应一个链，最后跟着一个包含所有链总体指标的最终内部列表。\n- 对于每个链，按顺序输出六个浮点数：$[\\overline{\\Delta S_n}, E_{\\mathrm{rms},n}, b_n, \\overline{\\Delta S_p}, E_{\\mathrm{rms},p}, b_p]$，所有数值均以 MeV 为单位并四舍五入到三位小数。\n- 最后一个内部列表必须按顺序包含四个浮点数：$[\\overline{\\Delta S_n}^{\\mathrm{all}}, E_{\\mathrm{rms},n}^{\\mathrm{all}}, \\overline{\\Delta S_p}^{\\mathrm{all}}, E_{\\mathrm{rms},p}^{\\mathrm{all}}]$，同样以 MeV 为单位并四舍五入到三位小数。\n- 具有占位符值的总体输出结构示例：$[[a_1,b_1,c_1,d_1,e_1,f_1],[a_2,b_2,c_2,d_2,e_2,f_2],[a_3,b_3,c_3,d_3,e_3,f_3],[a_4,b_4,c_4,d_4,e_4,f_4],[g_1,g_2,g_3,g_4]]$。\n\n不涉及角度；所有能量均以 MeV 表示，并按指定格式将所有数字报告为四舍五入到三位小数的浮点数。", "solution": "独立粒子模型 (IPM) 将核子视为在由所有其他核子产生的平均场势中独立运动。在此图像中，核哈密顿量是单体项的总和，其本征值是单粒子能量。在考虑移除一个核子时，类库普曼斯近似断言，移除能量约等于核子被移除的轨道的单粒子能量的负值，此过程忽略了平均场的重排和多体关联。在原子物理学中，这被称为库普曼斯定理 (Koopmans' theorem)，而在核物理学中，类似的假设经常在平均场处理中使用。\n\n我们从结合能定义的分离能开始。中子分离能是 $S_n(N,Z) = B(N,Z) - B(N-1,Z)$，质子分离能是 $S_p(N,Z) = B(N,Z) - B(N,Z-1)$。在平均场背景下，中子和质子的单体能量 $\\epsilon^{(n)}_i$ 和 $\\epsilon^{(p)}_j$ 从最束缚到最不束缚排序，最后一个被占据的能级对应中子的索引为 $i = N$，质子的索引为 $j = Z$。类库普曼斯估计值为\n$$\nS_n^{\\mathrm{Koop}}(N,Z) = -\\epsilon^{(n)}_{N}, \\quad S_p^{\\mathrm{Koop}}(N,Z) = -\\epsilon^{(p)}_{Z}.\n$$\n这是通过将移除能量解释为当平均场和其他能级的占据数冻结时单粒子本征值的负值而得出的。\n\n给定参考分离能 $S_n^{\\mathrm{exp}}(N,Z)$ 和 $S_p^{\\mathrm{exp}}(N,Z)$，每种类型的偏差定义为\n$$\n\\Delta S_n(N,Z) = S_n^{\\mathrm{Koop}}(N,Z) - S_n^{\\mathrm{exp}}(N,Z), \\quad \\Delta S_p(N,Z) = S_p^{\\mathrm{Koop}}(N,Z) - S_p^{\\mathrm{exp}}(N,Z).\n$$\n对于一个同位素链（固定的 $Z$，变化的 $N$），我们使用以下方法量化系统性差异以及可能随 $N$ 变化的漂移：\n- 平均偏差，\n$$\n\\overline{\\Delta S_n} = \\frac{1}{M} \\sum_{k=1}^M \\Delta S_{n,k}, \\quad\n\\overline{\\Delta S_p} = \\frac{1}{M} \\sum_{k=1}^M \\Delta S_{p,k},\n$$\n其中 $M$ 是链中原子核的数量。\n- 均方根误差 (RMSE)，\n$$\nE_{\\mathrm{rms},n} = \\sqrt{\\frac{1}{M} \\sum_{k=1}^M \\left(\\Delta S_{n,k}\\right)^2}, \\quad\nE_{\\mathrm{rms},p} = \\sqrt{\\frac{1}{M} \\sum_{k=1}^M \\left(\\Delta S_{p,k}\\right)^2}.\n$$\n- 与中子数 $N$ 关系的线性趋势斜率，通过最小二乘法获得，\n$$\nb_n = \\frac{\\sum_{k=1}^{M} \\left(N_k - \\overline{N}\\right)\\, \\Delta S_{n,k}}{\\sum_{k=1}^{M} \\left(N_k - \\overline{N}\\right)^2}, \\quad\nb_p = \\frac{\\sum_{k=1}^{M} \\left(N_k - \\overline{N}\\right)\\, \\Delta S_{p,k}}{\\sum_{k=1}^{M} \\left(N_k - \\overline{N}\\right)^2},\n$$\n其中 $\\overline{N} = \\frac{1}{M} \\sum_{k=1}^{M} N_k$。如果 $M=1$，分母为零，我们定义 $b_n = 0.0$ 和 $b_p = 0.0$。\n\n为量化所有链中所有原子核的总体性能，我们计算聚合指标：\n$$\n\\overline{\\Delta S_n}^{\\mathrm{all}} = \\frac{1}{K} \\sum_{q=1}^{K} \\Delta S_{n,q}, \\quad\nE_{\\mathrm{rms},n}^{\\mathrm{all}} = \\sqrt{\\frac{1}{K} \\sum_{q=1}^{K} \\left(\\Delta S_{n,q}\\right)^2},\n$$\n对质子也类似，其中 $K$ 是所有链中原子核的总数。\n\n算法设计：\n1. 对于每个原子核，从排序列表中提取最后一个被占据的单粒子能量：$\\epsilon^{(n)}_{N}$ 和 $\\epsilon^{(p)}_{Z}$。形成类库普曼斯预测值 $S_n^{\\mathrm{Koop}} = -\\epsilon^{(n)}_{N}$ 和 $S_p^{\\mathrm{Koop}} = -\\epsilon^{(p)}_{Z}$。\n2. 计算相对于参考值 $S_n^{\\mathrm{exp}}$ 和 $S_p^{\\mathrm{exp}}$ 的偏差 $\\Delta S_n$ 和 $\\Delta S_p$。\n3. 对于每个链，通过直接公式计算平均偏差和RMSE。通过最小二乘表达式计算斜率，并防范单点情况。\n4. 聚合所有链的偏差，以计算中子和质子的总体平均偏差和RMSE。\n5. 将所有输出四舍五入到三位小数，并按照指定的顺序和格式组装成最终的列表的列表，将数值解释为 MeV。\n\n科学真实性与局限性：\n- IPM和类库普曼斯估计忽略了对关联和平均场的重排，这通常会导致系统性偏差。平均偏差和趋势斜率可以诊断单粒子图像是否系统性地高估或低估了分离能，以及偏差是否在同位素链内随中子数漂移。\n- 所提供的单粒子能量是从最束缚到最不束缚排序的，并且在每个链中随 $N$ 适度变化，这与平均场能级随同位旋演化的物理直觉相符。参考分离能是合理的 MeV 值。\n\n程序实现了这些步骤，并打印一行包含每个链及总体所需指标的输出，格式为方括号括起来的逗号分隔列表，不含空格，所有值均以 MeV 为单位四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef mean_bias_and_rmse(biases):\n    biases = np.array(biases, dtype=float)\n    mb = float(np.mean(biases)) if biases.size > 0 else 0.0\n    rmse = float(np.sqrt(np.mean(biases**2))) if biases.size > 0 else 0.0\n    return mb, rmse\n\ndef slope_vs_N(Ns, biases):\n    Ns = np.array(Ns, dtype=float)\n    biases = np.array(biases, dtype=float)\n    if Ns.size = 1:\n        return 0.0\n    Nmean = float(np.mean(Ns))\n    denom = float(np.sum((Ns - Nmean)**2))\n    if denom == 0.0:\n        return 0.0\n    num = float(np.sum((Ns - Nmean) * biases))\n    return num / denom\n\ndef format_list_of_floats(values):\n    # Format each float to three decimal places, no spaces.\n    return \"[\" + \",\".join(f\"{v:.3f}\" for v in values) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement as isotopic chains.\n    # Each chain: dict with 'Z' and 'nuclei' list. Each nucleus: dict with 'N', 'eps_n', 'eps_p', 'Sn_exp', 'Sp_exp'.\n    chains = [\n        {\n            \"name\": \"Oxygen\",\n            \"Z\": 8,\n            \"nuclei\": [\n                {\"N\": 8,\n                 \"eps_n\": [-40.0,-30.0,-25.0,-18.0,-16.5,-16.0,-15.8,-15.6],\n                 \"eps_p\": [-38.0,-21.0,-18.0,-14.0,-13.5,-12.9,-12.4,-12.1],\n                 \"Sn_exp\": 15.7, \"Sp_exp\": 12.1},\n                {\"N\": 10,\n                 \"eps_n\": [-40.0,-30.0,-25.0,-18.0,-16.0,-13.0,-11.5,-10.5,-9.5,-9.0],\n                 \"eps_p\": [-38.0,-21.0,-18.0,-14.0,-13.5,-12.9,-12.3,-11.8],\n                 \"Sn_exp\": 8.0, \"Sp_exp\": 11.7},\n                {\"N\": 12,\n                 \"eps_n\": [-40.0,-30.0,-25.0,-18.0,-16.0,-13.0,-11.5,-10.5,-9.5,-8.0,-6.8,-6.0],\n                 \"eps_p\": [-38.0,-21.0,-18.0,-14.0,-13.5,-12.8,-12.2,-11.5],\n                 \"Sn_exp\": 6.0, \"Sp_exp\": 11.3},\n            ],\n        },\n        {\n            \"name\": \"Neon\",\n            \"Z\": 10,\n            \"nuclei\": [\n                {\"N\": 10,\n                 \"eps_n\": [-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-12.3,-12.0],\n                 \"eps_p\": [-38.0,-25.0,-20.0,-15.0,-12.0,-10.5,-9.5,-9.0,-8.7,-8.5],\n                 \"Sn_exp\": 12.0, \"Sp_exp\": 8.6},\n                {\"N\": 12,\n                 \"eps_n\": [-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-10.5,-10.0,-9.8,-9.7],\n                 \"eps_p\": [-38.0,-25.0,-20.0,-15.0,-12.0,-10.8,-9.7,-9.2,-8.9,-8.7],\n                 \"Sn_exp\": 9.8, \"Sp_exp\": 8.8},\n                {\"N\": 14,\n                 \"eps_n\": [-40.0,-30.0,-26.0,-20.0,-18.0,-15.0,-13.8,-12.8,-10.5,-9.8,-8.2,-7.8,-7.6,-7.4],\n                 \"eps_p\": [-38.0,-25.0,-20.0,-15.0,-12.0,-11.0,-10.0,-9.4,-9.1,-8.9],\n                 \"Sn_exp\": 7.6, \"Sp_exp\": 9.0},\n            ],\n        },\n        {\n            \"name\": \"Magnesium\",\n            \"Z\": 12,\n            \"nuclei\": [\n                {\"N\": 12,\n                 \"eps_n\": [-42.0,-32.0,-28.0,-22.0,-20.0,-18.0,-16.0,-14.5,-13.5,-13.0,-12.9,-12.8],\n                 \"eps_p\": [-38.0,-28.0,-24.0,-20.0,-16.0,-13.0,-11.0,-9.5,-8.9,-8.5,-8.3,-8.1],\n                 \"Sn_exp\": 13.0, \"Sp_exp\": 8.0},\n                {\"N\": 14,\n                 \"eps_n\": [-42.0,-32.0,-28.0,-22.0,-20.0,-18.0,-16.0,-14.5,-13.5,-12.0,-11.2,-10.9,-10.7,-10.5],\n                 \"eps_p\": [-38.0,-28.0,-24.0,-20.0,-16.0,-13.0,-11.0,-9.6,-9.1,-8.7,-8.5,-8.3],\n                 \"Sn_exp\": 10.4, \"Sp_exp\": 8.2},\n            ],\n        },\n        {\n            \"name\": \"Carbon\",\n            \"Z\": 6,\n            \"nuclei\": [\n                {\"N\": 6,\n                 \"eps_n\": [-48.0,-38.0,-28.0,-22.0,-20.0,-18.8],\n                 \"eps_p\": [-45.0,-35.0,-25.0,-20.0,-17.0,-15.2],\n                 \"Sn_exp\": 18.7, \"Sp_exp\": 15.1},\n            ],\n        },\n    ]\n\n    chain_results = []\n    all_bias_n = []\n    all_bias_p = []\n\n    for chain in chains:\n        Z = chain[\"Z\"]\n        Ns = []\n        biases_n = []\n        biases_p = []\n        for nuc in chain[\"nuclei\"]:\n            N = nuc[\"N\"]\n            eps_n = nuc[\"eps_n\"]\n            eps_p = nuc[\"eps_p\"]\n            # Safety checks\n            if len(eps_n)  N:\n                raise ValueError(f\"Neutron levels insufficient for N={N} in chain {chain['name']}\")\n            if len(eps_p)  Z:\n                raise ValueError(f\"Proton levels insufficient for Z={Z} in chain {chain['name']}\")\n            # Koopmans-like predictions: negative of last occupied single-particle energy\n            Sn_pred = -float(eps_n[N-1])\n            Sp_pred = -float(eps_p[Z-1])\n            # Biases relative to experimental\n            Sn_exp = float(nuc[\"Sn_exp\"])\n            Sp_exp = float(nuc[\"Sp_exp\"])\n            bias_n = Sn_pred - Sn_exp\n            bias_p = Sp_pred - Sp_exp\n\n            Ns.append(N)\n            biases_n.append(bias_n)\n            biases_p.append(bias_p)\n            all_bias_n.append(bias_n)\n            all_bias_p.append(bias_p)\n\n        mb_n, rmse_n = mean_bias_and_rmse(biases_n)\n        mb_p, rmse_p = mean_bias_and_rmse(biases_p)\n        slope_n = slope_vs_N(Ns, biases_n)\n        slope_p = slope_vs_N(Ns, biases_p)\n\n        chain_results.append([mb_n, rmse_n, slope_n, mb_p, rmse_p, slope_p])\n\n    overall_mb_n, overall_rmse_n = mean_bias_and_rmse(all_bias_n)\n    overall_mb_p, overall_rmse_p = mean_bias_and_rmse(all_bias_p)\n    overall = [overall_mb_n, overall_rmse_n, overall_mb_p, overall_rmse_p]\n\n    # Build the final string output with required formatting (no spaces, three decimals).\n    formatted_chains = [format_list_of_floats(vals) for vals in chain_results]\n    formatted_overall = format_list_of_floats(overall)\n    output = \"[\" + \",\".join(formatted_chains + [formatted_overall]) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output)\n\nsolve()\n```", "id": "3602424"}]}