{"hands_on_practices": [{"introduction": "在坐标空间中求解散射问题时，一种强大的方法是将空间划分为存在相互作用的“内部区域”和相互作用可忽略的“外部区域”。通过分别求解并确保波函数在交界处平滑连接，我们可以精确确定散射相移。这项实践旨在推导外部区域解析解的关键性质——对数导数，它为内部区域的数值积分提供了至关重要的边界条件 [@problem_id:3577805]。", "problem": "考虑一个约化质量为 $\\mu$ 的核子在球对称的短程核势 $V(r)$ 中运动，该核势在有限半径 $R$ 之外可以忽略不计。对于轨道角动量为 $l$ 的分波，其径向薛定谔方程为\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\left[V(r)+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}\\right]u_{l}(r)=E\\,u_{l}(r),\n$$\n在原点 $r\\to 0$ 附近，其正则边界行为由 $u_{l}(r)\\propto r^{l+1}$ 给出；而在大半径 $r\\to\\infty$ 处，其物理散射行为由能量为 $E=\\frac{\\hbar^{2}k^{2}}{2\\mu}0$、相移为 $\\delta_{l}(E)$ 的出射畸变波给出。对于 $r\\ge R$（此处 $V(r)\\approx 0$），外部解可以表示为与相移 $\\delta_{l}(E)$ 一致的球 Bessel 函数 $j_{l}(kr)$ 和 $n_{l}(kr)$ 的实驻波组合。\n\n你需要设计一个内外匹配程序，其中：\n- 内部解 $u_{l}^{\\text{(in)}}(r)$ 通过从一个小半径 $r_{\\epsilon}\\ll R$ 开始，利用正则边界行为进行数值向外积分得到，并且\n- 外部解 $u_{l}^{\\text{(out)}}(r)$ 通过从一个大半径 $r_{\\infty}\\gg R$ 开始，利用渐近散射表示进行数值向内积分得到。\n\n在选定的匹配半径 $r_{m}\\ge R$ 处，通过令向内和向外积分的对数导数 $L(r)\\equiv u_{l}'(r)/u_{l}(r)$ 在 $r=r_{m}$ 处相等，来施加全局解是 $C^{1}$（连续可微）的条件。从径向薛定谔方程和解在大半径 $r$ 处的散射形式（用 $j_l$ 和 $n_l$ 表示）出发，推导外部对数导数 $L(r_m)$ 的显式解析表达式，该表达式用 $k$、$l$、$\\delta_l$ 以及函数 $j_l$、$n_l$ 及其在 $kr_m$ 处的导数值表示。你的最终答案必须是 $L(r_{m})$ 的单个闭式解析表达式；不要引入任何数值。使用标准数学符号表示所有数学量，并陈述将要与内部计算相匹配的结果。最终表达式中不需要四舍五入，也不应报告单位。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定、客观和完整的。它描述了计算量子散射理论中的一个标准程序。因此，我们可以开始推导。\n\n目标是求出外部径向波函数 $u_l^{\\text{(out)}}(r)$ 在匹配半径 $r=r_m$ 处的对数导数 $L(r_m) \\equiv u_l'(r_m) / u_l(r_m)$ 的解析表达式。外部区域定义为 $r \\ge R$，其中核势 $V(r)$ 假定为零。匹配半径 $r_m$ 在此区域内，即 $r_m \\ge R$。\n\n在外部区域，当 $V(r)=0$ 时，径向薛定谔方程为：\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}u_{l}(r)=E\\,u_{l}(r)\n$$\n给定散射态的能量 $E=\\frac{\\hbar^{2}k^{2}}{2\\mu}$，我们将其代入方程：\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}u_{l}(r)=\\frac{\\hbar^{2}k^{2}}{2\\mu}u_{l}(r)\n$$\n两边同乘 $-\\frac{2\\mu}{\\hbar^{2}}$ 并整理各项，我们得到球 Bessel 微分方程的标准形式：\n$$\n\\frac{d^{2}u_{l}(r)}{dr^{2}} + \\left[k^{2} - \\frac{l(l+1)}{r^{2}}\\right]u_{l}(r) = 0\n$$\n该方程的通解是第一类球 Bessel 函数 $j_l(kr)$ 和第二类球 Bessel 函数（或 Neumann 函数） $n_l(kr)$ 的线性组合：\n$$\nu_{l}(r) = A j_{l}(kr) + B n_{l}(kr)\n$$\n其中 $A$ 和 $B$ 是常数。\n\n问题指出，对于大的 $r$，解应表示一个带有相移 $\\delta_l(E)$ 的散射波。径向波函数的渐近行为由以下公式给出：\n$$\nu_{l}(r) \\xrightarrow{r\\to\\infty} C \\sin\\left(kr - \\frac{l\\pi}{2} + \\delta_l\\right)\n$$\n为了匹配此行为，我们必须适当地选择常数 $A$ 和 $B$。我们使用球 Bessel 函数在大宗量 $\\rho = kr$ 时的已知渐近形式：\n$$\nj_{l}(\\rho) \\xrightarrow{\\rho\\to\\infty} \\frac{1}{\\rho}\\sin\\left(\\rho - \\frac{l\\pi}{2}\\right)\n$$\n$$\nn_{l}(\\rho) \\xrightarrow{\\rho\\to\\infty} -\\frac{1}{\\rho}\\cos\\left(\\rho - \\frac{l\\pi}{2}\\right)\n$$\n对于包含相移 $\\delta_l$ 的外部解 $u_l^{\\text{(out)}}(r)$，一个常规且方便的选择是实驻波形式：\n$$\nu_{l}^{\\text{(out)}}(r) = C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right]\n$$\n其中 $C_0$ 是一个任意的归一化常数。让我们来验证其渐近形式。代入 $j_l$ 和 $n_l$ 的渐近表达式：\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} C_0 \\left[\\cos(\\delta_l) \\frac{\\sin(kr - \\frac{l\\pi}{2})}{kr} - \\sin(\\delta_l) \\left(-\\frac{\\cos(kr - \\frac{l\\pi}{2})}{kr}\\right)\\right]\n$$\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} \\frac{C_0}{kr} \\left[\\cos(\\delta_l)\\sin\\left(kr - \\frac{l\\pi}{2}\\right) + \\sin(\\delta_l)\\cos\\left(kr - \\frac{l\\pi}{2}\\right)\\right]\n$$\n使用和角正弦的三角恒等式 $\\sin(\\alpha+\\beta) = \\sin\\alpha\\cos\\beta + \\cos\\alpha\\sin\\beta$，我们得到：\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} \\frac{C_0}{kr} \\sin\\left(kr - \\frac{l\\pi}{2} + \\delta_l\\right)\n$$\n这与要求的渐近行为相匹配。因此，我们采用这种形式作为适用于所有 $r \\ge R$ 的外部解。\n\n对数导数定义为 $L(r) = \\frac{u_l'(r)}{u_l(r)}$，其中撇号表示对 $r$求导。首先，我们计算 $u_l^{\\text{(out)}}(r)$ 的导数：\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = \\frac{d}{dr} \\left( C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right] \\right)\n$$\n使用链式法则 $\\frac{d}{dr}f(kr) = k \\frac{df(x)}{dx}\\big|_{x=kr}$，我们得到：\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = C_0 \\left[\\cos(\\delta_l) \\left(k j_l'(kr)\\right) - \\sin(\\delta_l) \\left(k n_l'(kr)\\right)\\right]\n$$\n这里，$j_l'(\\rho)$ 和 $n_l'(\\rho)$ 表示球 Bessel 函数对其宗量 $\\rho$ 的导数。\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = k C_0 \\left[\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)\\right]\n$$\n现在我们可以通过取 $u_{l}^{\\text{(out)}\\prime}(r)$ 与 $u_{l}^{\\text{(out)}}(r)$ 的比值来构造对数导数。归一化常数 $C_0$ 被消去：\n$$\nL(r) = \\frac{k C_0 \\left[\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)\\right]}{C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right]}\n$$\n$$\nL(r) = k \\frac{\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)}{\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)}\n$$\n问题要求计算此表达式在匹配半径 $r_m$ 处的值。代入 $r=r_m$：\n$$\nL(r_m) = k \\frac{\\cos(\\delta_l) j_l'(kr_m) - \\sin(\\delta_l) n_l'(kr_m)}{\\cos(\\delta_l) j_l(kr_m) - \\sin(\\delta_l) n_l(kr_m)}\n$$\n这就是在匹配点 $r_m$ 处外部解的对数导数的显式解析表达式。它用波数 $k$、轨道角动量量子数 $l$（作为索引）、相移 $\\delta_l$ 以及球 Bessel 函数 $j_l, n_l$ 及其对宗量的导数（在 $kr_m$ 处求值）来表示。这个量必须与数值积分得到的内部解的对数导数相匹配，以施加 $C^1$ 连续性并确定相移。", "answer": "$$\n\\boxed{k \\frac{\\cos(\\delta_l) j_l'(kr_m) - \\sin(\\delta_l) n_l'(kr_m)}{\\cos(\\delta_l) j_l(kr_m) - \\sin(\\delta_l) n_l(kr_m)}}\n$$", "id": "3577805"}, {"introduction": "与坐标空间中的微分方程不同，动量空间中的散射问题通常通过求解 Lippmann-Schwinger 这样的积分方程来解决。这些积分方程的核函数中包含由自由演化算符 $(E - \\hat{T} \\pm i0^+)^{-1}$ 带来的奇点，对数值计算构成了挑战。这项实践将引导你掌握处理此类奇点的核心技术，通过运用 Sokhotski-Plemelj 定理，你将学习如何将一个奇异积分分解为一个柯西主值积分和一个在壳贡献，并最终通过代码实现一个数值稳定的计算方案 [@problem_id:3577750]。", "problem": "考虑在动量空间、s波简化下，三维空间中双体散射的不含时薛定谔方程。在此表示下，对于正散射能量$E$，自由豫解算符出现在形式为 $R(E \\pm i0^+) = (E - \\hat{T} \\pm i0^+)^{-1}$ 的核中，其中 $\\hat{T}$ 是动能算符。当简化为对相对动量大小$q$的一维积分时，会遇到以下类型的积分\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{E - \\frac{q^2}{2\\mu} + i0^+},\n$$\n其中$\\mu$是约化质量，$\\Lambda$是有限的紫外动量截断，而$f(q)$是一个足够光滑的检验函数，它编码了相互作用的角向平均以及可能的其他因素。$i0^+$的约定编码了出射波边界条件，并导致在在壳动量上的分布式求值。您必须从定义豫解算符的基本分布式极限出发，解释柯西主值在此类积分的数值处理中是如何产生的，并设计一个鲁棒的数值方法，将柯西主值与δ函数贡献分离开来，以确保在连续谱散射能量下的准确性。\n\n从分布的基本定义和关于复豫解算符作用于光滑检验函数的极限的成熟结论出发，推导一个当$E  0$时$I(E)$的数值稳定分解，该分解：\n- 将一个实的柯西主值积分与一个局域在由$E = \\frac{q_0^2}{2\\mu}$隐式定义的在壳动量$q_0$上的虚部贡献清晰地分离开来，并且\n- 产生一个适合在$[0,\\Lambda]$上进行高精度求积的良态实积分。\n\n然后，通过特化到检验函数\n$$\nf(q) = \\exp\\!\\big(-\\alpha \\, q^2\\big),\n$$\n在代码中实现您推导的方法，其中参数$\\alpha  0$为定值。使用一个稳定的减加策略，通过加减一个由$f(q_0)$构造的常数来移除被积函数实部在$q=q_0$处的极点，并以高精度数值计算任何由此产生的非奇异实积分。任何您确定有闭合形式解的项都应解析计算，而非数值计算。\n\n采用自然单位制，令约化普朗克常数和光速为一，即$\\hbar = c = 1$。所有动量以$\\mathrm{fm}^{-1}$为单位，质量以$\\mathrm{fm}^{-1}$为单位，能量以$\\mathrm{fm}^{-1}$为单位。在这些约定下，积分$I(E)$的单位是$\\mathrm{fm}^{-1}$。对于数值计算，将报告的$I(E)$的实部和虚部均四舍五入到8位小数，并以$\\mathrm{fm}^{-1}$为单位报告。\n\n您的程序必须为以下探测不同区域的参数值测试套件实现该方法：\n- 所有情况的通用参数：折合质量 $\\mu = 2.385\\,\\mathrm{fm}^{-1}$，截断 $\\Lambda = 5.0\\,\\mathrm{fm}^{-1}$，以及高斯参数 $\\alpha = 0.3\\,\\mathrm{fm}^2$。\n- 情况 A（散射能量远在截断壳层内部）：选择在壳动量$q_0 = 2.0\\,\\mathrm{fm}^{-1}$，并设$E = \\frac{q_0^2}{2\\mu}$。\n- 情况 B（阈值附近的低能散射）：选择$q_0 = 0.1\\,\\mathrm{fm}^{-1}$，并设$E = \\frac{q_0^2}{2\\mu}$。\n- 情况 C（在壳动量从下方接近截断）：选择$q_0 = 0.99\\,\\Lambda$，并设$E = \\frac{q_0^2}{2\\mu}$。\n- 情况 D（截断内部无在壳动量）：选择$q_0 = 6.0\\,\\mathrm{fm}^{-1}$，并设$E = \\frac{q_0^2}{2\\mu}$。\n\n对于每种情况，计算复数$I(E)$，并报告其实部（柯西主值）和虚部（在壳δ函数贡献），单位均为$\\mathrm{fm}^{-1}$。最终输出必须是单行，包含一个序对列表，其中每个序对是一个包含$[ \\text{Re}(I), \\text{Im}(I) ]$（四舍五入到8位小数）的双元素列表。例如，整体格式必须是\n$[ [r_1,i_1],[r_2,i_2],[r_3,i_3],[r_4,i_4] ]$\n输出中不含空格。此问题不涉及角度，因此不需要角度单位。\n\n您的程序应生成单行输出，其中包含按上述方式描述的结果，以逗号分隔的列表形式，并用方括号括起来，按A、B、C、D的顺序列出测试套件中的四种情况。不允许用户输入；所有常量和参数必须在代码中定义。", "solution": "该问题要求计算一个在量子散射理论的动量空间表述中经常遇到的复积分。该积分为\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{E - \\frac{q^2}{2\\mu} + i0^+},\n$$\n其中$E  0$是散射能量，$\\mu$是折合质量，$\\Lambda$是动量截断，而$f(q)$是一个光滑函数。项$+i0^+$指示了一个特定的极限，这对于定义该积分和实施物理边界条件（出射球面波）至关重要。\n\n我们的第一步是分析被积函数分母的结构。我们可以用在壳动量$q_0 = \\sqrt{2\\mu E}$来重写它，这是动能等于总能量$E$时的相对动量大小。\n$$\nE - \\frac{q^2}{2\\mu} = \\frac{q_0^2}{2\\mu} - \\frac{q^2}{2\\mu} = -\\frac{1}{2\\mu} (q^2 - q_0^2).\n$$\n将此代入积分，我们得到\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{-\\frac{1}{2\\mu} (q^2 - q_0^2) + i0^+} = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2 - i(2\\mu \\cdot 0^+)}.\n$$\n项$i(2\\mu \\cdot 0^+)$只是另一个无穷小量，我们可以将其表示为$i\\epsilon$。积分变为\n$$\nI(E) = -2\\mu \\lim_{\\epsilon \\to 0^+} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2 - i\\epsilon}.\n$$\n为了计算这个积分，我们使用Sokhotski-Plemelj定理，它为此类分布的极限提供了一个公式：\n$$\n\\lim_{\\epsilon \\to 0^+} \\frac{1}{x \\pm i\\epsilon} = \\mathcal{P}\\left(\\frac{1}{x}\\right) \\mp i\\pi \\delta(x),\n$$\n其中$\\mathcal{P}$表示柯西主值，$\\delta(x)$是狄拉克δ函数。在我们的例子中，分母中的变量是积分变量的函数，$g(q) = q^2 - q_0^2$。应用该定理可得\n$$\n\\frac{1}{q^2 - q_0^2 - i\\epsilon} \\xrightarrow{\\epsilon\\to0^+} \\mathcal{P}\\left(\\frac{1}{q^2 - q_0^2}\\right) + i\\pi \\delta(q^2 - q_0^2).\n$$\n因此，积分$I(E)$分离为一个实部（来自主值）和一个虚部（来自δ函数）：\n$$\nI(E) = -2\\mu \\left[ \\mathcal{P} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2} + i\\pi \\int_{0}^{\\Lambda} \\mathrm{d}q \\, q^2 \\, f(q) \\, \\delta(q^2 - q_0^2) \\right].\n$$\n如果奇点$q=q_0$位于积分区间内，即$0  q_0  \\Lambda$，则此分解有效。如果$q_0 \\ge \\Lambda$，则分母在$[0, \\Lambda]$内永不为零，$i0^+$项无关紧要，积分为纯实数，并且不需要主值。\n\n我们来分析$0  q_0  \\Lambda$情况下的两个部分。\n\n**虚部：**\n虚部涉及一个包含函数形式的δ函数的积分，即$\\delta(q^2 - q_0^2)$。我们使用恒等式$\\delta(g(x)) = \\sum_i \\frac{\\delta(x-x_i)}{|g'(x_i)|}$，其中$x_i$是$g(x)$的单根。这里，$g(q) = q^2 - q_0^2$的根是$q = \\pm q_0$。导数是$g'(q) = 2q$，所以$|g'(\\pm q_0)| = 2q_0$。因此，\n$$\n\\delta(q^2 - q_0^2) = \\frac{1}{2q_0} [\\delta(q - q_0) + \\delta(q + q_0)].\n$$\n由于积分域是$[0, \\Lambda]$且$q_0  0$，只有$\\delta(q - q_0)$项有贡献。$I(E)$的虚部是\n$$\n\\mathrm{Im}[I(E)] = -2\\mu\\pi \\int_{0}^{\\Lambda} \\mathrm{d}q \\, q^2 \\, f(q) \\, \\frac{1}{2q_0} \\delta(q - q_0) = - \\frac{\\mu\\pi}{q_0} [q^2 f(q)]_{q=q_0} = -\\mu\\pi q_0 f(q_0).\n$$\n对于指定的检验函数$f(q) = \\exp(-\\alpha q^2)$，这变为\n$$\n\\mathrm{Im}[I(E)] = -\\mu\\pi q_0 \\exp(-\\alpha q_0^2).\n$$\n\n**实部：**\n$I(E)$的实部是主值积分：\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\, \\mathcal{P} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2}.\n$$\n由于奇点的存在，直接对这类积分进行数值计算是不稳定的。我们使用减加技术。令$h(q) = q^2 f(q)$。我们将积分重写为：\n$$\n\\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q)}{q^2 - q_0^2} \\mathrm{d}q = \\int_{0}^{\\Lambda} \\frac{h(q) - h(q_0)}{q^2 - q_0^2} \\mathrm{d}q + \\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q_0)}{q^2 - q_0^2} \\mathrm{d}q.\n$$\n第一项是一个正则积分，因为分子$h(q) - h(q_0)$在$q=q_0$处为零，抵消了分母中的奇点。当$q \\to q_0$时，被积函数趋于一个明确的极限。这个积分可以使用标准的数值求积方法精确计算。\n\n第二项可以解析计算：\n$$\n\\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q_0)}{q^2 - q_0^2} \\mathrm{d}q = h(q_0) \\, \\mathcal{P} \\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{(q-q_0)(q+q_0)}.\n$$\n使用部分分式分解，$\\frac{1}{(q-q_0)(q+q_0)} = \\frac{1}{2q_0}\\left(\\frac{1}{q-q_0} - \\frac{1}{q+q_0}\\right)$，我们得到\n$$\n\\frac{h(q_0)}{2q_0} \\left( \\mathcal{P}\\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{q-q_0} - \\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{q+q_0} \\right) = \\frac{h(q_0)}{2q_0} \\left( [\\ln|q-q_0|]_0^\\Lambda - [\\ln(q+q_0)]_0^\\Lambda \\right)\n$$\n$$\n= \\frac{h(q_0)}{2q_0} \\left( (\\ln|\\Lambda-q_0|-\\ln|-q_0|) - (\\ln(\\Lambda+q_0)-\\ln(q_0)) \\right) = \\frac{h(q_0)}{2q_0} \\ln\\left|\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right|.\n$$\n代入$h(q_0) = q_0^2 f(q_0)$，积分的解析部分变为$\\frac{q_0^2 f(q_0)}{2q_0} \\ln\\left|\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right| = \\frac{q_0 f(q_0)}{2} \\ln\\left|\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right|$。\n\n综合所有部分，实部为：\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\left[ \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 f(q) - q_0^2 f(q_0)}{q^2 - q_0^2} + \\frac{q_0 f(q_0)}{2} \\ln\\left|\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right| \\right].\n$$\n使用$f(q) = \\exp(-\\alpha q^2)$，则\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 e^{-\\alpha q^2} - q_0^2 e^{-\\alpha q_0^2}}{q^2 - q_0^2} - \\mu q_0 e^{-\\alpha q_0^2} \\ln\\left|\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right|.\n$$\n这个公式在$0  q_0  \\Lambda$时有效。对于正则化积分的数值计算，被积函数在 $q=q_0$ 处的值可以通过洛必达法则求得，其值为 $(1-\\alpha q_0^2)e^{-\\alpha q_0^2}$。\n\n**情况 $q_0 \\ge \\Lambda$：**\n在这种情况下，极点$q=q_0$位于积分区间$[0, \\Lambda]$之外。分母$E - q^2/(2\\mu)$永远不为零。$i0^+$的约定是不需要的，积分是纯实数。\n$$\nI(E) = \\mathrm{Re}[I(E)] = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 f(q)}{E - q^2/(2\\mu)} = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 e^{-\\alpha q^2}}{q^2 - q_0^2}.\n$$\n$$\n\\mathrm{Im}[I(E)] = 0.\n$$\n$\\mathrm{Re}[I(E)]$的积分是非奇异的，可以直接使用数值求积计算。\n\n实现策略总结：\n- 对于每个测试用例，判断是否$0  q_0  \\Lambda$。\n- 如果$0  q_0  \\Lambda$：\n    1. 使用解析公式$-\\mu\\pi q_0 \\exp(-\\alpha q_0^2)$计算$\\mathrm{Im}[I(E)]$。\n    2. 计算$\\mathrm{Re}[I(E)]$的解析部分。\n    3. 数值积分正则化的被积函数以找到$\\mathrm{Re}[I(E)]$的数值部分。\n    4. 将两部分相加得到总的$\\mathrm{Re}[I(E)]$。\n- 如果$q_0 \\ge \\Lambda$：\n    1. 设置$\\mathrm{Im}[I(E)] = 0$。\n    2. 数值积分$\\mathrm{Re}[I(E)]$的非奇异表达式。\n- 将最终的实部和虚部四舍五入到8位小数。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves for the complex integral I(E) for four different scattering energies.\n    \"\"\"\n\n    # Common parameters as specified in the problem statement.\n    # All quantities are in appropriate powers of fm.\n    MU = 2.385  # Reduced mass in fm^-1\n    LAMBDA = 5.0  # Momentum cutoff in fm^-1\n    ALPHA = 0.3  # Gaussian parameter in fm^2\n\n    # Test cases defined by the on-shell momentum q_0 in fm^-1\n    test_q0 = [\n        2.0,                  # Case A\n        0.1,                  # Case B\n        0.99 * LAMBDA,        # Case C\n        6.0                   # Case D\n    ]\n\n    results = []\n    for q0 in test_q0:\n        # The test function f(q) = exp(-alpha * q^2)\n        f = lambda q: np.exp(-ALPHA * q**2)\n\n        # Handle the two main scenarios: pole inside or outside the integration domain.\n        if 0  q0  LAMBDA:\n            # --- Case 1: Pole is inside the integration interval [0, LAMBDA] ---\n\n            # Imaginary part from the delta-function contribution\n            im_I = -MU * np.pi * q0 * f(q0)\n\n            # Real part is split into a numerically evaluated integral and an analytical term.\n            \n            # 1. Integrand for the numerically evaluated part.\n            # This is the regularized integrand for the principal value.\n            def integrand_re_pv(q):\n                # To avoid 0/0, we handle q -> q0 using L'Hopital's rule, \n                # which results in the derivative of h(x)=x*f(sqrt(x)) w.r.t x=q^2.\n                # d/dx[x*exp(-alpha*x)] = (1 - alpha*x)*exp(-alpha*x)\n                if np.isclose(q, q0):\n                    return (1 - ALPHA * q0**2) * f(q0)\n                else:\n                    numerator = q**2 * f(q) - q0**2 * f(q0)\n                    denominator = q**2 - q0**2\n                    return numerator / denominator\n\n            # The integral is over [0, LAMBDA].\n            # scipy.integrate.quad is used for high-accuracy numerical integration.\n            numerical_part, _ = integrate.quad(integrand_re_pv, 0, LAMBDA)\n            \n            # 2. The analytical part of the principal value integral.\n            # Note that log(|L-q0|/|L+q0|) is used for generality, but L>q0>0 here.\n            analytical_part = (q0**2 * f(q0) / (2.0 * q0)) * np.log(np.abs((LAMBDA - q0) / (LAMBDA + q0)))\n\n            # Total real part of I(E)\n            re_I = -2.0 * MU * (numerical_part + analytical_part)\n\n        else: # q0 >= LAMBDA or q0 = 0\n            # --- Case 2: Pole is outside the integration interval ---\n            # The integral is purely real and non-singular.\n            \n            im_I = 0.0\n\n            # The integrand for the real part.\n            # E = q0^2 / (2*mu) => E - q^2/(2*mu) = -(q^2 - q0^2)/(2*mu)\n            # The denominator q^2 - q0^2 is never zero for q in [0, LAMBDA].\n            def integrand_re_no_pole(q):\n                return (q**2 * f(q)) / (q**2 - q0**2)\n\n            integral_val, _ = integrate.quad(integrand_re_no_pole, 0, LAMBDA)\n            re_I = -2.0 * MU * integral_val\n\n        # Round results to 8 decimal places as required.\n        results.append([round(re_I, 8), round(im_I, 8)])\n    \n    # Format the final output string exactly as specified.\n    output_str = \"[\" + \",\".join([f\"[{r},{i}]\" for r, i in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3577750"}]}