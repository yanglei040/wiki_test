{"hands_on_practices": [{"introduction": "构建低动量相互作用的核心目标是改善多体计算的收敛性。本练习提供了一种直接量化核相互作用“微扰性”的方法——计算其温伯格（Weinberg）本征值。通过对一个模型势应用不同类型的调节函数（尖锐截断与平滑调节），你将直接观察到移除高动量成分如何“软化”相互作用，这是理解 $V_{\\text{low-}k}$ 方法威力的关键第一步。[@problem_id:3567799]", "problem": "要求你对低动量相互作用进行数值研究，重点关注被称为 $V_{\\text{low-}k}$ 的相互作用的微扰特性。目标是计算不同正则化函数选择（锐利截断与平滑截断）下的 Weinberg 本征值，并检验正则化函数的形状如何影响多次散射级数的收敛性质。\n\n从两体散射的 Lippmann–Schwinger 方程的算符形式出发，\n$$\n\\hat{T}(E) = \\hat{V} + \\hat{V} \\hat{G}_0(E) \\hat{T}(E),\n$$\n其中 $\\hat{T}(E)$ 是能量为 $E$ 时的散射跃迁算符，$\\hat{G}_0(E)$ 是自由预解算符（自由空间格林函数）。Weinberg 本征值定义为算符 $\\hat{V} \\hat{G}_0(E)$ 的本征值 $\\eta$，其模的大小表明了 Born 级数的收敛性质；具体来说，如果 $\\max |\\eta| < 1$，则级数在该能量下是微扰的。\n\n在 S 波分波动量表象下进行计算。使用一个球对称的中心裸相互作用，其在动量空间中由一个可分离高斯形式定义，\n$$\nV_{\\text{bare}}(k,k') = -g \\exp\\!\\left(-\\frac{k^2 + k'^2}{\\beta^2}\\right),\n$$\n其中 $g > 0$ 和 $\\beta > 0$ 是常数，$k$ 和 $k'$ 是相对动量。通过将一个正则化函数 $f(k)$ 应用于势的两端来模拟低动量相互作用的构建，\n$$\nV_{\\text{reg}}(k,k') = f(k) \\, V_{\\text{bare}}(k,k') \\, f(k').\n$$\n考虑以下两个正则化函数族：\n- 锐利截断正则化函数：$f_{\\text{sharp}}(k; \\Lambda) = \\Theta(\\Lambda - k)$，其中 $\\Theta$ 是 Heaviside 阶跃函数，$\\Lambda$ 是动量截断。\n- 平滑截断正则化函数：$f_{\\text{smooth}}(k; \\Lambda, n) = \\exp\\!\\left(-\\left(\\frac{k}{\\Lambda}\\right)^{2n}\\right)$，其中 $n$ 控制下降的平滑度。\n\n假设所选单位使得 $\\hbar^2/(2\\mu) = 1$，其中 $\\mu$ 是约化质量，因此能量的单位是长度的平方反比，动量的单位是长度的反比。所有动量必须以 $\\text{fm}^{-1}$ 为单位指定，能量以 $\\text{fm}^{-2}$ 为单位指定。在负能量 $E < 0$ 处计算 Weinberg 算符，以避免自由预解算符中的奇点。\n\n将对应于 $\\hat{V} \\hat{G}_0(E)$ 的 S 波积分算符构建为对相对动量 $q$ 的积分，并使用适当的三维动量测度。使用数值稳定的求积方法在有限动量区间上对积分进行离散化。对于锐利截断，积分范围为 $q \\in [0, \\Lambda]$。对于平滑截断，积分范围为 $q \\in [0, k_{\\max}]$，其中 $k_{\\max}$ 需足够大于截断值以捕捉到正则化函数的尾部。构造 Weinberg 算符的有限维矩阵表示并计算其本征值。对于每个测试用例，报告定义为本征值最大模的谱半径。\n\n对裸相互作用和能量使用以下参数值：\n- $g = 5.0$（在所选单位中为无量纲），\n- $\\beta = 2.0 \\, \\text{fm}^{-1}$，\n- $E = -0.5 \\, \\text{fm}^{-2}$。\n\n使用至少 $N = 200$ 个点的 Gauss–Legendre 求积法以确保数值稳定性。对于平滑正则化函数，设置 $k_{\\max} = 6.0 \\, \\text{fm}^{-1}$。\n\n实现以下正则化函数设置的测试套件：\n1. 锐利截断，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$。\n2. 平滑截断，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$ 且 $n = 2$。\n3. 平滑截断，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$ 且 $n = 8$。\n4. 锐利截断，$\\Lambda = 1.2 \\, \\text{fm}^{-1}$。\n5. 平滑截断，$\\Lambda = 3.0 \\, \\text{fm}^{-1}$ 且 $n = 2$。\n\n对于每个测试用例，计算一个浮点数：在指定的能量和参数下 Weinberg 算符的谱半径。将所有输出表示为无量纲浮点数。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4,result5]”）。", "solution": "该问题要求计算在给定可分离势和负能量 $E$ 的情况下，Weinberg 算符 $\\hat{K}(E) = \\hat{V} \\hat{G}_0(E)$ 的谱半径。谱半径定义为 $\\hat{K}(E)$ 的本征值 $\\eta$ 的最大绝对值，它决定了散射 T 矩阵的 Born 级数展开的收敛性。\n\n出发点是 Weinberg 态的算符本征值方程：\n$$\n\\hat{V} \\hat{G}_0(E) |\\psi\\rangle = \\eta |\\psi\\rangle\n$$\n我们在 S 波（$l=0$）分波动量表象下进行计算。在此基底下，态的归一化使得完备性关系为 $\\frac{2}{\\pi}\\int_0^\\infty dk\\, k^2 |k\\rangle\\langle k| = \\hat{1}$，本征值方程变为一个积分方程：\n$$\n\\frac{2}{\\pi} \\int_0^\\infty dq\\, q^2 \\frac{V_{\\text{reg}}(k, q)}{E - q^2} \\psi(q) = \\eta \\psi(k)\n$$\n这里，$V_{\\text{reg}}(k,q)$ 是 S 波正则化势矩阵元，$k$ 和 $q$ 是相对动量，我们利用了自由预解算符 $\\hat{G}_0(E) = (E - \\hat{H}_0)^{-1}$ 在此基底下是对角的事实，其矩阵元为 $\\langle k | \\hat{G}_0(E) | q \\rangle \\propto \\delta(k-q)/(E-k^2)$。恒定能量 $E$ 被给定为 $E = -0.5 \\, \\text{fm}^{-2}$，并且由于积分是在正实动量 $q$ 上进行的，分母 $E-q^2$ 永远不为零，从而避免了任何奇点。\n\n正则化势由下式给出：\n$$\nV_{\\text{reg}}(k,k') = f(k) V_{\\text{bare}}(k,k') f(k') = -g \\cdot f(k) \\exp\\left(-\\frac{k^2 + k'^2}{\\beta^2}\\right) f(k')\n$$\n这个势是可分离形式的，可以表示为 $V_{\\text{reg}}(k,q) = -v(k)v(q)$，其中函数 $v(k)$ 定义为：\n$$\nv(k) = \\sqrt{g} \\exp\\left(-\\frac{k^2}{2\\beta^2}\\right) f(k)\n$$\n将此可分离形式代入积分方程得到：\n$$\n\\frac{2}{\\pi} \\int_0^\\infty dq\\, q^2 \\frac{-v(k)v(q)}{E - q^2} \\psi(q) = \\eta \\psi(k)\n$$\n我们可以将与 $k$ 相关的项从积分中提出来：\n$$\n-v(k) \\left[ \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q) \\psi(q)}{E - q^2} \\right] = \\eta \\psi(k)\n$$\n方括号中的表达式是一个标量常数，我们称之为 $C$。方程变为 $\\eta \\psi(k) = -C v(k)$。这表明本征函数 $\\psi(k)$ 必须与函数 $v(k)$ 成正比，即 $\\psi(k) = A v(k)$，其中 $A$ 是某个归一化常数。将此代回方程中：\n$$\n-v(k) \\left[ \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q) (A v(q))}{E - q^2} \\right] = \\eta (A v(k))\n$$\n假设 $v(k)$ 不恒为零，我们可以消去非零的公因子 $A$ 和 $v(k)$，这将问题从求解一个无限维算符的本征值简化为求解单个标量值 $\\eta$：\n$$\n\\eta = - \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q)^2}{E - q^2}\n$$\n对于此可分离势，算符 $\\hat{V}\\hat{G}_0(E)$ 是一个秩为一的算符，因此只有一个非零本征值。因此，谱半径就是这个单一本征值的模 $|\\eta|$。\n\n代入 $v(q)^2$ 的定义：\n$$\n\\eta = - \\frac{2g}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 \\exp\\left(-\\frac{2q^2}{\\beta^2}\\right) f(q)^2}{E - q^2}\n$$\n积分的上限实际上由正则化函数 $f(q)$ 决定。对于锐利截断 $f_{\\text{sharp}}(q; \\Lambda) = \\Theta(\\Lambda - q)$，积分范围是从 $0$ 到 $\\Lambda$。对于平滑截断 $f_{\\text{smooth}}(q; \\Lambda, n)$，正则化函数的指数尾部会快速抑制 $q > \\Lambda$ 时的被积函数，因此我们按指定积分到一个足够大的动量 $k_{\\max}$。\n\n为了对每个测试用例进行计算，我们使用带有 $N=200$ 个点的 Gauss-Legendre 求积法对该定积分进行数值计算。积分 $\\int_a^b F(q) dq$ 由求和 $\\sum_{i=1}^N w_i' F(q_i)$ 近似，其中 $q_i$ 和 $w_i'$ 是映射到积分区间 $[a, b]$ 的求积点和权重。\n\n每个测试用例的步骤如下：\n1.  设置参数 $g=5.0$，$\\beta=2.0 \\, \\text{fm}^{-1}$ 和 $E=-0.5 \\, \\text{fm}^{-2}$。\n2.  确定积分区间 $[0, k_{\\text{int\\_max}}]$。对于锐利截断，$k_{\\text{int\\_max}}=\\Lambda$；对于平滑截断，$k_{\\text{int\\_max}}=k_{\\max}=6.0 \\, \\text{fm}^{-1}$。\n3.  为区间 $[-1, 1]$ 生成 $N=200$ 个 Gauss-Legendre 点 $z_i$ 和权重 $w_i$。\n4.  将这些点和权重映射到积分区间 $[0, k_{\\text{int\\_max}}]$：\n    $$\n    q_i = \\frac{k_{\\text{int\\_max}}}{2}(z_i + 1), \\quad w'_i = \\frac{k_{\\text{int\\_max}}}{2}w_i\n    $$\n5.  为具体情况（锐利或平滑）定义正则化函数 $f(q)$。\n6.  计算本征值 $\\eta$ 的求和：\n    $$\n    \\eta \\approx - \\frac{2g}{\\pi} \\sum_{i=1}^N w'_i \\frac{q_i^2 \\exp\\left(-\\frac{2q_i^2}{\\beta^2}\\right) f(q_i)^2}{E - q_i^2}\n    $$\n7.  谱半径为 $|\\eta|$，因为分母 $E-q_i^2$ 始终为负，而被积函数中的所有其他因子均为正，这使得 $\\eta$ 成为一个正实数。\n对五个指定的参数集中的每一个都实现了此算法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main solver function to compute the spectral radius for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        {'type': 'sharp', 'Lambda': 2.0},\n        {'type': 'smooth', 'Lambda': 2.0, 'n': 2},\n        {'type': 'smooth', 'Lambda': 2.0, 'n': 8},\n        {'type': 'sharp', 'Lambda': 1.2},\n        {'type': 'smooth', 'Lambda': 3.0, 'n': 2},\n    ]\n\n    results = []\n    for params in test_cases:\n        radius = compute_spectral_radius(**params)\n        results.append(f\"{radius:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef compute_spectral_radius(type, Lambda, n=None):\n    \"\"\"\n    Computes the spectral radius of the Weinberg operator for given parameters.\n\n    The problem simplifies to calculating a single non-zero eigenvalue for a\n    rank-one operator derived from a separable potential. The spectral radius\n    is the magnitude of this eigenvalue.\n\n    Args:\n        type (str): The regulator type, 'sharp' or 'smooth'.\n        Lambda (float): The momentum cutoff in fm^-1.\n        n (int, optional): The exponent for the smooth regulator. Defaults to None.\n\n    Returns:\n        float: The spectral radius (dimensionless).\n    \"\"\"\n    # --- Physical and Numerical Parameters ---\n    g_bare = 5.0  # Dimensionless strength parameter\n    beta = 2.0    # Momentum scale in fm^-1\n    energy = -0.5 # Scattering energy in fm^-2\n    \n    num_points = 200 # Number of quadrature points\n    k_max_smooth = 6.0 # Integration limit for smooth regulators in fm^-1\n\n    # --- Setup Integration Mesh using Gauss-Legendre Quadrature ---\n    if type == 'sharp':\n        k_int_max = Lambda\n    elif type == 'smooth':\n        k_int_max = k_max_smooth\n    else:\n        raise ValueError(\"Invalid regulator type specified.\")\n\n    # Get standard Gauss-Legendre roots and weights for the interval [-1, 1]\n    roots, weights = roots_legendre(num_points)\n\n    # Map points and weights to the integration interval [0, k_int_max]\n    q_points = 0.5 * k_int_max * (roots + 1.0)\n    q_weights = 0.5 * k_int_max * weights\n\n    # --- Define Regulator Function f(q)^2 ---\n    if type == 'sharp':\n        # For a sharp cutoff, integration is from 0 to Lambda, and f(q)=1\n        # within this range. So f(q)^2 is effectively 1.\n        f_squared = 1.0\n    else: # 'smooth'\n        # f(q) = exp(-(q/Lambda)^(2n))\n        # f(q)^2 = exp(-2 * (q/Lambda)^(2n))\n        f_squared = np.exp(-2.0 * (q_points / Lambda)**(2 * n))\n        \n    # --- Define Integrand ---\n    # The integrand for the eigenvalue eta, from the formula:\n    # eta = - (2g/pi) * integral{ dq q^2 * exp(-2q^2/beta^2) * f(q)^2 / (E-q^2) }\n    \n    numerator = q_points**2 * np.exp(-2.0 * q_points**2 / beta**2) * f_squared\n    denominator = energy - q_points**2\n    \n    integrand = numerator / denominator\n    \n    # --- Calculate the Integral ---\n    integral_val = np.sum(q_weights * integrand)\n    \n    # --- Calculate the Eigenvalue eta ---\n    eta = - (2.0 * g_bare / np.pi) * integral_val\n    \n    # The spectral radius is the magnitude of the single non-zero eigenvalue.\n    # Since E  0, the denominator (E - q^2) is always negative.\n    # All other terms in the integral are positive, so the integral is negative.\n    # This makes eta = - (const) * (negative value) always positive.\n    # Therefore, the spectral radius is simply eta.\n    spectral_radius = eta\n    \n    return spectral_radius\n\nsolve()\n```", "id": "3567799"}, {"introduction": "在理解了我们*为何*需要更软的相互作用之后，我们现在来探讨*如何*构建它们。本练习使用一个简化的二能级系统——一种常见的教学工具——来演示和对比两种强大的重整化技术：用于构建 $V_{\\text{low-}k}$ 的 Lee-Suzuki 方法和相似性重整化群（SRG）。通过解析地完成显式解耦，你将对高动量自由度如何被积掉（integrated out）获得深刻的、机理层面的理解。[@problem_id:3567822]", "problem": "考虑一个描述核子-核子分波中相对运动的两能级模型，其中有一个低动量态 $\\lvert \\ell \\rangle$ 和一个高动量态 $\\lvert h \\rangle$。在此基下，相对动能算符 $T$ 是对角的，其本征值为 $e_{\\ell}$ 和 $e_{h}$。令 $e_{\\ell} = 0\\,\\text{MeV}$ 且 $e_{h} = \\Delta = 200\\,\\text{MeV}$。在此基下，初始（裸）相互作用 $V(s{=}0)$ 为\n$$\nV(0) = \\begin{pmatrix}\nV_{\\ell \\ell}  V_{\\ell h} \\\\\nV_{h \\ell}  V_{h h}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-20\\,\\text{MeV}  -60\\,\\text{MeV} \\\\\n-60\\,\\text{MeV}  0\\,\\text{MeV}\n\\end{pmatrix},\n$$\n因此，完整裸哈密顿量为 $H(0) = T + V(0)$。\n\n你将需要构建一个低动量有效相互作用 $V_{\\text{low-}k}$ 和一个从相似性重整化群 (SRG) 获得的演化相互作用，然后量化非对角压低及其对低动量态微扰收敛性的影响。\n\n仅从以下基本要素出发：\n- 不含时薛定谔方程 $H \\lvert \\Psi \\rangle = E \\lvert \\Psi \\rangle$ 以及再现选定精确本征值的模型空间有效哈密顿量的定义。\n- 针对哈密顿量 $H(s)$ 且生成元为 $G = T$ 的 SRG 流方程，\n$$\n\\frac{d H(s)}{d s} = \\big[ \\eta(s), H(s) \\big], \\quad \\eta(s) \\equiv [G, H(s)] = [T, H(s)],\n$$\n以及标准的对易子算符代数。\n- 将 $V$ 视为微扰，针对 $T$ 的基态的非简并 Rayleigh–Schrödinger 微扰理论，直至二阶。\n\n按以下步骤进行，并展示基于这些基础的推导过程：\n\n(a) 定义投影算符 $P = \\lvert \\ell \\rangle \\langle \\ell \\rvert$ 和互补投影算符 $Q = \\lvert h \\rangle \\langle h \\rvert$。使用选取 $H(0)$ 精确最低本征值的一维 $P$ 空间 Lee–Suzuki 解耦构造，构建不依赖于能量的 $P$ 空间有效哈密顿量 $H_{\\text{eff}} = e_{\\ell} + V_{\\text{low-}k}$，使其单一本征值等于 $H(0)$ 的精确基态本征值。给出显式的标量 $V_{\\text{low-}k}$。\n\n(b) 通过使用生成元 $G = T$ 的 SRG 演化 $H(s)$。通过计算 SRG 方程所蕴含的双重对易子结构，用 $e_{\\ell}$、$e_{h}$ 和 $V(s)$ 推导出矩阵元 $V_{12}(s) \\equiv \\langle \\ell \\rvert V(s) \\lvert h \\rangle$ 和 $V_{11}(s) \\equiv \\langle \\ell \\rvert V(s) \\lvert \\ell \\rangle$ 的流方程。在 $\\lvert V_{ii}(s) \\rvert \\ll \\Delta$ 的情况下，证明领头阶近似\n$$\nV_{12}(s) \\approx V_{12}(0)\\,\\exp\\!\\big(-\\Delta^{2} s\\big), \\quad\nV_{11}(s) \\approx V_{11}(0) - \\frac{\\lvert V_{12}(0) \\rvert^{2}}{\\Delta}\\,\\Big(1 - \\exp\\!\\big(-2 \\Delta^{2} s\\big)\\Big)\n$$\n的合理性。利用这些近似，找出能将非对角元的大小减小 10 倍的 SRG 流参数 $s^{\\star}$（单位为 $\\text{MeV}^{-2}$），即 $\\lvert V_{12}(s^{\\star}) \\rvert = \\lvert V_{12}(0) \\rvert / 10$。然后计算 $V_{11}(s^{\\star})$（单位为 $\\text{MeV}$）。\n\n(c) 将 $V(s)$ 视为对 $T$ 的微扰，写出在普适 $s$ 处对低动量态的一阶和二阶能量修正，然后将其特化到 $s^{\\star}$。计算比值\n$$\nr_{\\text{SRG}}(s^{\\star}) \\equiv \\left| \\frac{\\delta E^{(2)}(s^{\\star})}{\\delta E^{(1)}(s^{\\star})} \\right|\n$$\n作为一个纯数。将你对 $r_{\\text{SRG}}(s^{\\star})$ 的最终答案四舍五入到四位有效数字，并以小数形式表示（无单位）。该比值即为要求的最终答案。", "solution": "问题陈述是自洽的，其科学基础在于量子力学和核有效场论的原理，并且是良定的。所有提供的数据都是一致的，并且足以得到唯一解。我们开始进行推导。\n\n在基 $\\{ \\lvert \\ell \\rangle, \\lvert h \\rangle \\}$ 下，完整裸哈密顿量 $H(0) = T + V(0)$ 由以下矩阵给出\n$$\nH(0) = \\begin{pmatrix} e_{\\ell}  0 \\\\ 0  e_{h} \\end{pmatrix} + \\begin{pmatrix} V_{\\ell \\ell}  V_{\\ell h} \\\\ V_{h \\ell}  V_{h h} \\end{pmatrix} = \\begin{pmatrix} 0\\,\\text{MeV}  0 \\\\ 0  200\\,\\text{MeV} \\end{pmatrix} + \\begin{pmatrix} -20\\,\\text{MeV}  -60\\,\\text{MeV} \\\\ -60\\,\\text{MeV}  0\\,\\text{MeV} \\end{pmatrix} = \\begin{pmatrix} -20  -60 \\\\ -60  200 \\end{pmatrix}\\,\\text{MeV}.\n$$\n\n(a) 为了构建低动量有效相互作用 $V_{\\text{low-}k}$，我们首先通过求解特征方程 $\\det(H(0) - E \\cdot I) = 0$ 来找到 $H(0)$ 的精确本征值 $E$。\n$$\n\\det \\begin{pmatrix} -20 - E  -60 \\\\ -60  200 - E \\end{pmatrix} = 0\n$$\n$$\n(-20 - E)(200 - E) - (-60)^2 = 0\n$$\n$$\n-4000 + 20E - 200E + E^2 - 3600 = 0\n$$\n$$\nE^2 - 180E - 7600 = 0\n$$\n使用二次方程求根公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，本征值为：\n$$\nE = \\frac{180 \\pm \\sqrt{(-180)^2 - 4(1)(-7600)}}{2} = \\frac{180 \\pm \\sqrt{32400 + 30400}}{2} = \\frac{180 \\pm \\sqrt{62800}}{2} = 90 \\pm 10\\sqrt{157}.\n$$\n问题指明，有效哈密顿量必须再现 $H(0)$ 的精确最低本征值，即基态能量 $E_0$：\n$$\nE_0 = 90 - 10\\sqrt{157}\\,\\text{MeV}.\n$$\n在一维 $P$ 空间中，有效哈密顿量 $H_{\\text{eff}}$ 定义为 $H_{\\text{eff}} = e_{\\ell} + V_{\\text{low-}k}$。由于这是一个 $1 \\times 1$ 矩阵（一个标量），其本征值就是它自身的值。根据定义，该本征值必须是 $E_0$。\n$$\nH_{\\text{eff}} = E_0\n$$\n给定 $e_{\\ell} = 0$，我们有：\n$$\n0 + V_{\\text{low-}k} = E_0\n$$\n因此，标量低动量相互作用等于精确的基态能量。\n$$\nV_{\\text{low-}k} = 90 - 10\\sqrt{157}\\,\\text{MeV}.\n$$\n\n(b) 我们推导势矩阵元的 SRG 流方程。SRG 方程为 $\\frac{dH(s)}{ds} = [\\eta(s), H(s)]$，生成元为 $\\eta(s) = [T, H(s)]$。由于 $T$ 是常数，所以 $\\frac{dH(s)}{ds} = \\frac{dV(s)}{ds}$。\n令 $H(s) = T + V(s)$，其中 $T = \\text{diag}(e_{\\ell}, e_{h})$ 且 $V(s) = \\begin{pmatrix} V_{11}(s)  V_{12}(s) \\\\ V_{21}(s)  V_{22}(s) \\end{pmatrix}$。令 $\\Delta = e_{h} - e_{\\ell}$。生成元为：\n$$\n\\eta(s) = [T, V(s)] = \\begin{pmatrix} 0  (e_{\\ell}-e_{h})V_{12}(s) \\\\ (e_{h}-e_{\\ell})V_{21}(s)  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\Delta V_{12}(s) \\\\ \\Delta V_{21}(s)  0 \\end{pmatrix}.\n$$\n流方程变为 $\\frac{dH(s)}{ds} = [\\eta(s), H(s)] = [\\eta(s), T+V(s)]$。\n$$\n\\frac{dH(s)}{ds} = \\begin{pmatrix} -2\\Delta V_{12}(s)V_{21}(s)  -\\Delta V_{12}(s)(\\Delta + V_{22}(s)-V_{11}(s)) \\\\ -\\Delta V_{21}(s)(\\Delta + V_{22}(s)-V_{11}(s))  2\\Delta V_{12}(s)V_{21}(s) \\end{pmatrix}.\n$$\n这给出了势矩阵元的流方程（$V_{12}=V_{21}$）：\n$$\n\\frac{dV_{11}(s)}{ds} = -2\\Delta |V_{12}(s)|^2, \\quad \\frac{dV_{12}(s)}{ds} = -(\\Delta + V_{22}(s) - V_{11}(s))\\Delta V_{12}(s).\n$$\n在 $|V_{ii}(s)| \\ll \\Delta$ 的情况下，$V_{12}(s)$ 的方程简化为：\n$$\n\\frac{dV_{12}(s)}{ds} \\approx -\\Delta^2 V_{12}(s).\n$$\n这个一阶线性微分方程的解为 $V_{12}(s) = V_{12}(0)\\exp(-\\Delta^2 s)$，这证明了第一个近似的合理性。\n将此代入 $V_{11}(s)$ 的流方程中：\n$$\n\\frac{dV_{11}(s)}{ds} = -2\\Delta |V_{12}(0)\\exp(-\\Delta^2 s)|^2 = -2\\Delta|V_{12}(0)|^2 \\exp(-2\\Delta^2 s).\n$$\n从 $s=0$ 积分到 $s$：\n$$\n\\int_0^s \\frac{dV_{11}(s')}{ds'} ds' = V_{11}(s) - V_{11}(0) = -2\\Delta|V_{12}(0)|^2 \\int_0^s \\exp(-2\\Delta^2 s') ds'.\n$$\n$$\nV_{11}(s) - V_{11}(0) = -2\\Delta|V_{12}(0)|^2 \\left[ \\frac{\\exp(-2\\Delta^2 s')}{-2\\Delta^2} \\right]_0^s = \\frac{|V_{12}(0)|^2}{\\Delta} \\left( \\exp(-2\\Delta^2 s) - 1 \\right).\n$$\n$$\nV_{11}(s) \\approx V_{11}(0) - \\frac{|V_{12}(0)|^2}{\\Delta} \\left( 1 - \\exp(-2\\Delta^2 s) \\right).\n$$\n这证明了第二个近似的合理性。\n现在，我们求解满足 $|V_{12}(s^{\\star})| = |V_{12}(0)|/10$ 的 $s^{\\star}$：\n$$\n|V_{12}(0)| \\exp(-\\Delta^2 s^{\\star}) = \\frac{|V_{12}(0)|}{10} \\implies \\exp(-\\Delta^2 s^{\\star}) = \\frac{1}{10}.\n$$\n$$\n-\\Delta^2 s^{\\star} = \\ln(1/10) = -\\ln(10) \\implies s^{\\star} = \\frac{\\ln(10)}{\\Delta^2}.\n$$\n当 $\\Delta = 200\\,\\text{MeV}$ 时，$s^{\\star} = \\frac{\\ln(10)}{200^2} = \\frac{\\ln(10)}{40000}\\,\\text{MeV}^{-2}$。\n接下来，我们计算 $V_{11}(s^{\\star})$：\n$$\n\\exp(-2\\Delta^2 s^{\\star}) = \\left(\\exp(-\\Delta^2 s^{\\star})\\right)^2 = \\left(\\frac{1}{10}\\right)^2 = \\frac{1}{100}.\n$$\n使用 $V_{11}(0) = -20\\,\\text{MeV}$， $|V_{12}(0)|^2 = (-60\\,\\text{MeV})^2 = 3600\\,\\text{MeV}^2$，以及 $\\Delta = 200\\,\\text{MeV}$：\n$$\nV_{11}(s^{\\star}) = -20 - \\frac{3600}{200} \\left( 1 - \\frac{1}{100} \\right) = -20 - 18 \\left( \\frac{99}{100} \\right) = -20 - 17.82 = -37.82\\,\\text{MeV}.\n$$\n\n(c) 使用非简并 Rayleigh-Schrödinger 微扰理论，其中 $H_0 = T$ 且微扰为 $V(s)$，对低动量态 $|\\ell\\rangle$ 的能量修正为：\n一阶修正：\n$$\n\\delta E^{(1)}(s) = \\langle \\ell | V(s) | \\ell \\rangle = V_{11}(s).\n$$\n二阶修正：\n$$\n\\delta E^{(2)}(s) = \\frac{|\\langle \\ell | V(s) | h \\rangle|^2}{e_{\\ell} - e_{h}} = \\frac{|V_{12}(s)|^2}{-\\Delta}.\n$$\n比值 $r_{\\text{SRG}}(s^{\\star})$ 为：\n$$\nr_{\\text{SRG}}(s^{\\star}) = \\left| \\frac{\\delta E^{(2)}(s^{\\star})}{\\delta E^{(1)}(s^{\\star})} \\right| = \\left| \\frac{-|V_{12}(s^{\\star})|^2/\\Delta}{V_{11}(s^{\\star})} \\right| = \\frac{|V_{12}(s^{\\star})|^2}{\\Delta |V_{11}(s^{\\star})|}.\n$$\n我们在 $s=s^{\\star}$ 处有所需的值：\n$V_{11}(s^{\\star}) = -37.82\\,\\text{MeV}$。\n$|V_{12}(s^{\\star})| = |V_{12}(0)|/10 = 60/10 = 6\\,\\text{MeV}$。\n$\\Delta = 200\\,\\text{MeV}$。\n代入这些值：\n$$\nr_{\\text{SRG}}(s^{\\star}) = \\frac{(6)^2}{200 \\cdot |-37.82|} = \\frac{36}{200 \\cdot 37.82} = \\frac{36}{7564}.\n$$\n$$\nr_{\\text{SRG}}(s^{\\star}) \\approx 0.004759386...\n$$\n四舍五入到四位有效数字，结果为 $0.004759$。", "answer": "$$\\boxed{0.004759}$$", "id": "3567822"}, {"introduction": "最后的这个实践练习将从简化模型转向现代核理论核心的实际计算任务。你将为一个可分离的核子-核子势实现 Lee-Suzuki 消减（decimation），这是许多多体计算的常用起点。成功的关键检验标准是验证所产生的低动量相互作用 $V_{\\text{low-}k}$ 能够完美地再现原始“裸”势的低能散射相移和束缚态性质。[@problem_id:3567823]", "problem": "你需要实现一个动量空间的 Lee–Suzuki 约化方法，从一个给定的真实核子-核子 (NN) 势 $V_{NN}$ 构建低动量核子-核子相互作用 $V_{\\text{low-}k}$，并对几个平滑调节函数 $f(k,\\Lambda,n)$，在动量 $k \\le \\Lambda$ 范围内数值上验证相移和氘核结合能的不变性。在单通道 $S$ 波框架下，使用自然单位制，其中 $\\hbar = 1$ 且 $2\\mu = 1$，因此自由哈密顿量为 $H_0 = k^2$，能量为 $E = k^2$。所有角度必须以弧度表示，输出必须是无量纲的。\n\n基本依据与定义：\n- $S$ 波反应矩阵（K-矩阵）$K(k,k';E)$ 的 Lippmann–Schwinger 方程由下式给出\n$$\nK(k,k';E) = V(k,k') + \\int_{0}^{\\infty} q^2 \\, \\mathrm{d}q \\, V(k,q) \\, \\mathcal{P}\\left(\\frac{1}{E - q^2}\\right) \\, K(q,k';E),\n$$\n其中 $\\mathcal{P}$ 表示柯西主值，对于散射过程 $E = k^2 \\ge 0$。\n- $S$ 波相移 $\\delta(k)$ 通过在壳 K-矩阵定义为\n$$\n\\tan \\delta(k) = k \\, K(k,k;E=k^2).\n$$\n- 氘核结合能 $E_d  0$ 是齐次二体方程的负能解，对于秩一可分离核，该方程简化为条件\n$$\n1 + \\lambda \\, J(E_d) = 0,\n$$\n其中 $J(E)$ 是一个主值积分，形式为\n$$\nJ(E) = \\int_{0}^{\\infty} q^2 \\, \\mathrm{d}q \\, \\frac{g(q)^2}{E - q^2},\n$$\n而 $g(q)$ 是可分离势的形状因子。对于 $E0$，该积分是常规积分（无需主值）。\n\n通过 Lee–Suzuki 方法进行低动量约化：\n- 使用一个满足 $f(0,\\Lambda,n) = 1$ 和 $\\lim_{k \\to \\infty} f(k,\\Lambda,n) = 0$ 的平滑调节函数 $f(k,\\Lambda,n)$，将动量空间划分为一个低动量模型空间 $\\mathcal{P}$ 和一个互补的高动量空间 $\\mathcal{Q}$，其中 $0 \\le f(k,\\Lambda,n) \\le 1$。模型空间投影算符的作用是乘以 $f(k,\\Lambda,n)$，而互补投影算符的作用是乘以 $\\sqrt{1 - f(k,\\Lambda,n)^2}$，这样 $f(k,\\Lambda,n)^2 + \\left(1 - f(k,\\Lambda,n)^2\\right) = 1$ 构成单位分解。\n- $\\mathcal{P}$ 空间中的 Lee–Suzuki 有效相互作用的定义是，它能重现 $k \\le \\Lambda$ 的所有在壳 K-矩阵元和束缚态性质。一种方便的表示是依赖于能量的 Bloch–Horowitz 有效相互作用，\n$$\nV_{\\mathrm{eff}}(E) = P V P + P V Q \\, \\frac{1}{E - Q H Q} \\, Q V P,\n$$\n其中 $P$ 和 $Q$ 分别是到 $\\mathcal{P}$ 和 $\\mathcal{Q}$ 的投影算符，且 $H = H_0 + V$。对于秩一可分离势，此表达式可在动量空间中精确实现。\n\n模型势：\n- 使用一个真实的、秩一可分离的 Yamaguchi 形式的 $S$ 波 NN 势\n$$\nV(k,k') = -\\lambda \\, g(k) \\, g(k'), \\quad g(k) = \\frac{1}{k^2 + \\beta^2},\n$$\n其中 $\\lambda$ 和 $\\beta$ 是为产生单个束缚态而选择的正常数。\n\n调节函数：\n- 实现以下平滑调节函数 $f(k,\\Lambda,n)$：\n    1. 指数形式（超高斯）：$f_{\\mathrm{exp}}(k,\\Lambda,n) = \\exp\\!\\left[-\\left(\\frac{k}{\\Lambda}\\right)^{2n}\\right]$。\n    2. 洛伦兹族：$f_{\\mathrm{lor}}(k,\\Lambda,n) = \\frac{1}{1 + \\left(\\frac{k}{\\Lambda}\\right)^{2n}}$。\n    3. 费米-狄拉克：$f_{\\mathrm{fd}}(k,\\Lambda,n) = \\frac{1}{1 + \\exp\\!\\left(\\frac{k - \\Lambda}{a}\\right)}$，平滑度参数 $a = \\frac{\\Lambda}{n}$。\n\n验证任务：\n- 对于每个调节函数和截断动量，通过 Lee–Suzuki 约化在模型空间中构建 $V_{\\text{low-}k}$，计算选定动量 $k \\le \\Lambda$ 的在壳 K-矩阵元 $K_{\\mathrm{full}}(k,k;E)$ 和 $K_{\\mathrm{low}}(k,k;E)$，并通过比较由 $\\tan \\delta(k) = k \\, K(k,k;E)$ 定义的 $\\delta_{\\mathrm{full}}(k)$ 和 $\\delta_{\\mathrm{low}}(k)$ 来验证相移不变性。\n- 从全空间条件确定氘核结合能 $E_d$，并通过在 $E_d$ 处评估模型空间条件来验证结合能不变性。\n\n数值要求：\n- 对 $q \\in [0,\\infty)$ 上的积分实现具有足够收敛性的数值求积。对于正能量 $E > 0$，通过将积分分割为下半部分 $[0,\\sqrt{E}-\\epsilon]$ 和上半部分 $[\\sqrt{E}+\\epsilon,q_{\\max}]$ 来处理在 $q = \\sqrt{E}$ 处的主值，其中 $\\epsilon > 0$ 是一个小量，$q_{\\max}$ 是一个大的积分上限。对于负能量 $E  0$，无需主值。\n- 通过 $\\tan \\delta(k) = k \\, K(k,k;E)$ 从在壳 K-矩阵计算相移（以弧度为单位）。\n- 在比较全空间和模型空间量时，始终使用相同的数值归一化。\n\n测试套件：\n- 对势使用以下参数值：$\\lambda = 10.0$，$\\beta = 1.0$（在所选的自然单位制中是无量纲的）。\n- 使用以下测试用例 $(\\Lambda,\\text{regulator},n)$：\n    1. $(\\Lambda = 1.0,\\text{exp},n = 3)$\n    2. $(\\Lambda = 0.6,\\text{lor},n = 2)$\n    3. $(\\Lambda = 2.0,\\text{fd},n = 10)$\n    4. $(\\Lambda = 1.5,\\text{exp},n = 5)$\n- 对于每个测试用例，通过对三个动量 $k \\in \\{0.1 \\Lambda, 0.5 \\Lambda, 0.9 \\Lambda\\}$ 进行采样来评估相移不变性，并计算最大绝对差\n$$\n\\Delta_{\\delta,\\max} = \\max_{k \\in \\{0.1 \\Lambda, 0.5 \\Lambda, 0.9 \\Lambda\\}} \\left| \\delta_{\\mathrm{full}}(k) - \\delta_{\\mathrm{low}}(k) \\right|.\n$$\n- 对于结合能不变性，从全空间条件获得 $E_d$ 并计算模型空间残差\n$$\n\\Delta_{B} = \\left| 1 + \\lambda_{\\mathrm{eff}}(E_d) \\, J_{\\mathcal{P}}(E_d) \\right|,\n$$\n其中 $J_{\\mathcal{P}}(E)$ 表示带有调节函数 $f(k,\\Lambda,n)$ 的低动量积分，$\\lambda_{\\mathrm{eff}}(E)$ 是由 Lee–Suzuki 约化在能量 $E$ 处确定的有效模型空间耦合强度。\n\n最终输出格式：\n- 你的程序应产生单行输出，包含一个方括号内的逗号分隔列表。对于每个测试用例，输出两个浮点数：首先是 $\\Delta_{\\delta,\\max}$（以弧度为单位），然后是 $\\Delta_{B}$（无量纲）。因此，最终输出总共包含 8 个数字，按上面列出的测试用例顺序排列，例如 $\\left[\\Delta_{\\delta,\\max}^{(1)},\\Delta_{B}^{(1)},\\Delta_{\\delta,\\max}^{(2)},\\Delta_{B}^{(2)},\\Delta_{\\delta,\\max}^{(3)},\\Delta_{B}^{(3)},\\Delta_{\\delta,\\max}^{(4)},\\Delta_{B}^{(4)}\\right]$。", "solution": "用户要求实现 Lee–Suzuki 约化方法，从一个可分离势构建低动量核子-核子相互作用 $V_{\\text{low-}k}$，并验证其性质。\n\n### 步骤 1：问题验证\n\n问题陈述经过仔细分析，并被确定为**有效**的。它在科学上基于计算核物理的原理，特别是有效相互作用理论。所有必需的组成部分——势的形式、Lippmann-Schwinger 方程、相移的定义、Lee–Suzuki 方法、调节函数的选择以及数值验证任务——都是标准且明确定义的。所提供的参数在物理上是合理的，且任务在计算上是可行的。该问题是自洽的、客观的且适定的。因此，我们可以着手解决。\n\n### 步骤 2：理论构建\n\n这个问题的基础是动量空间中的秩一可分离势，由 Yamaguchi 形式给出：\n$$\nV(k,k') = -\\lambda \\, g(k) \\, g(k')\n$$\n其中形状因子为 $g(k) = \\frac{1}{k^2 + \\beta^2}$。对于这种势，Lippmann-Schwinger 方程可以解析求解。由此得到的决定散射性质的在壳 K-矩阵是：\n$$\nK(k,k; E=k^2) = -\\lambda \\frac{g(k)^2}{1 + \\lambda J(k^2)}\n$$\n积分 $J(E)$ 定义为：\n$$\nJ(E) = \\mathcal{P} \\int_{0}^{\\infty} q^2 \\, \\mathrm{d}q \\, \\frac{g(q)^2}{E - q^2}\n$$\n其中 $\\mathcal{P}$ 表示对于散射能量 $E > 0$ 的柯西主值。对于束缚态能量 $E  0$，该积分是常规积分。相移 $\\delta(k)$ 通过 $\\tan\\delta(k) = k \\, K(k,k;k^2)$ 获得。\n\nLee–Suzuki 约化过程旨在构建一个有效相互作用 $V_{\\text{low-}k}$，它在低动量模型空间 $\\mathcal{P}$（由动量 $k \\lesssim \\Lambda$ 定义）内重现原始势 $V$ 的物理可观测量。我们通过引入一个平滑的调节函数 $f(k, \\Lambda, n)$ 来实现这一点，该函数抑制相互作用的高动量分量。\n\n低动量相互作用 $V_{\\text{low-}k}$ 用一个类似的可分离形式建模，但具有修正的形状因子和依赖于能量的耦合常数：\n$$\nV_{\\text{low-}k}(k,k';E) = -\\lambda_{\\text{eff}}(E) \\, g_{\\text{low}}(k) \\, g_{\\text{low}}(k')\n$$\n其中低动量形状因子是 $g_{\\text{low}}(k) = f(k, \\Lambda, n) g(k)$。相应的低动量 K-矩阵是：\n$$\nK_{\\text{low}}(k,k; E=k^2) = -\\lambda_{\\text{eff}}(k^2) \\frac{g_{\\text{low}}(k)^2}{1 + \\lambda_{\\text{eff}}(k^2) J_{\\mathcal{P}}(k^2)}\n$$\n模型空间积分定义为：\n$$\nJ_{\\mathcal{P}}(E) = \\mathcal{P} \\int_{0}^{\\infty} q^2 \\, \\mathrm{d}q \\, \\frac{g_{\\text{low}}(q)^2}{E - q^2} = \\mathcal{P} \\int_{0}^{\\infty} q^2 \\, \\mathrm{d}q \\, \\frac{f(q, \\Lambda, n)^2 g(q)^2}{E - q^2}\n$$\n约化的核心要求是在模型空间内的动量，其在壳性质得以保持。通过强制 $K_{\\text{low}}(k,k;k^2) = K(k,k;k^2)$ 对于 $k \\le \\Lambda$，我们可以求解有效耦合 $\\lambda_{\\text{eff}}(E=k^2)$：\n$$\n\\lambda_{\\text{eff}}(E) = \\frac{\\lambda}{f(\\sqrt{E}, \\Lambda, n)^2 (1 + \\lambda J(E)) - \\lambda J_{\\mathcal{P}}(E)}\n$$\n这个依赖于能量的耦合有效地将被排除的高动量空间（$\\mathcal{Q}$）的物理效应整合到模型空间的计算中。\n\n### 步骤 3：验证任务与实现策略\n\n**结合能不变性：**\n当 K-矩阵（以及 T-矩阵）出现极点时，在能量 $E_d  0$ 处存在束缚态。对于全势，这对应于条件：\n$$\n1 + \\lambda J(E_d) = 0\n$$\n我们首先使用像 Brent 方法这样的求根算法，数值求解该方程以得到 $E_d$。然后，我们验证低动量相互作用能够重现这个极点。需要计算的残差是 $\\Delta_B = \\left| 1 + \\lambda_{\\text{eff}}(E_d) J_{\\mathcal{P}}(E_d) \\right|$。解析上，通过代入 $\\lambda_{\\text{eff}}(E_d)$ 的表达式并利用 $1 + \\lambda J(E_d) = 0$ 这一事实，这个残差必须为零。数值结果将是一个小数字，反映了求根器和数值求积的精度，因此可作为对实现正确性的关键检验。注意，对于 $E_d  0$，动量是虚数，$k=i\\kappa$，其中 $E_d = -\\kappa^2$。调节函数 $f(k, \\Lambda, n)$ 必须在此复动量下进行评估。\n\n**相移不变性：**\n对于散射能量 $E = k^2 > 0$，我们必须验证对于动量 $k \\le \\Lambda$，有 $\\delta_{\\text{low}}(k) \\approx \\delta_{\\text{full}}(k)$。这通过计算以下两项来完成：\n1.  使用全空间 K-矩阵计算 $\\delta_{\\text{full}}(k) = \\arctan(k \\, K(k,k;k^2))$。\n2.  使用带有导出的 $\\lambda_{\\text{eff}}(k^2)$ 的低动量 K-矩阵计算 $\\delta_{\\text{low}}(k) = \\arctan(k \\, K_{\\text{low}}(k,k;k^2))$。\n在一组样本动量上的最大绝对差 $\\Delta_{\\delta,\\max}$ 作为相移不变性的度量。与结合能检验一样，这个差异在解析上应为零，因此计算值检验了实现的数值保真度。\n\n**数值方法：**\n- **积分：** $J(E)$ 和 $J_{\\mathcal{P}}(E)$ 的积分使用数值求积计算。对于 $E > 0$，主值通过使用 `scipy.integrate.quad` 的 `weight='cauchy'` 特性来高效处理。对于 $E  0$，标准求积就足够了。\n- **求根：** 结合能 $E_d$ 使用 `scipy.optimize.brentq` 找到。\n- **调节函数：** 指定的指数、洛伦兹和费米-狄拉克调节函数将被实现为函数。\n\n下面的 Python 代码为指定的测试用例实现了这整个过程。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\nimport cmath\n\ndef solve():\n    \"\"\"\n    Implements the Lee-Suzuki decimation for a separable potential and verifies\n    phase-shift and binding energy invariance.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    LAMBDA_POT = 10.0\n    BETA_POT = 1.0\n\n    # --- Numerical Parameters ---\n    Q_MAX = 100.0  # Upper integration limit for numerical quadrature\n    ROOT_FINDER_TOL = 1e-15 # Tolerance for the binding energy root finder\n\n    # --- Yamaguchi Potential Form Factor ---\n    def g(k, beta=BETA_POT):\n        \"\"\"Calculates the Yamaguchi form factor g(k).\"\"\"\n        return 1.0 / (k**2 + beta**2)\n\n    # --- Regulator Functions ---\n    def f_exp(k, L, n):\n        \"\"\"Exponential (super-Gaussian) regulator.\"\"\"\n        # Use cmath for complex k to handle negative energies\n        if np.iscomplexobj(k):\n             return cmath.exp(-(k / L)**(2 * n))\n        return np.exp(-(k / L)**(2 * n))\n\n    def f_lor(k, L, n):\n        \"\"\"Lorentzian regulator.\"\"\"\n        return 1.0 / (1.0 + (k / L)**(2 * n))\n\n    def f_fd(k, L, n):\n        \"\"\"Fermi-Dirac regulator.\"\"\"\n        a = L / n\n        if np.iscomplexobj(k):\n            return 1.0 / (1.0 + cmath.exp((k - L) / a))\n        return 1.0 / (1.0 + np.exp((k - L) / a))\n\n    # --- Integral J(E) Calculation ---\n    def get_h_integrand_func(form_factor_func):\n        \"\"\"Returns the function h(q) = q^2 * g(q)^2 for use in J(E) integral.\"\"\"\n        def h_integrand(q):\n            return q**2 * form_factor_func(q)**2\n        return h_integrand\n\n    def calculate_J(E, h_func):\n        \"\"\"\n        Calculates the integral J(E) = integral(h(q) / (E - q^2) dq).\n        Handles E > 0 (principal value) and E  0 (direct integration).\n        \"\"\"\n        if E  0:\n            integrand = lambda q: h_func(q) / (E - q**2)\n            result, _ = quad(integrand, 0, Q_MAX, epsabs=1e-12, epsrel=1e-12)\n            return result\n        elif E == 0:\n            integrand = lambda q: -h_func(q) / q**2 if q > 0 else -form_factor_func(0)**2\n            result, _ = quad(lambda q: -form_factor_func(q,BETA_POT)**2, 0, Q_MAX, epsabs=1e-12, epsrel=1e-12)\n            # This is specific for g(q) = 1/(q^2+beta^2).\n            # The general form with h_func requires careful limit handling at q=0.\n            # h(q)/q^2 = g(q)^2 is regular.\n            result_analytic = -np.pi / (4 * BETA_POT**3) if h_func == get_h_integrand_func(g) else result\n            return result\n        else: # E > 0, Principal Value\n            q0 = np.sqrt(E)\n            # We compute PV( integral( h(q) / (E - q^2) dq ) )\n            # This is rewritten for scipy as PV( integral( F(q) / (q - q0) dq ) )\n            # where F(q) = -h(q)/(q + q0).\n            F_for_cauchy = lambda q: -h_func(q) / (q + q0)\n            result, _ = quad(F_for_cauchy, 0, Q_MAX, weight='cauchy', wvar=q0, epsabs=1e-12, epsrel=1e-12)\n            return result\n\n    # --- Main Logic ---\n    test_cases = [\n        (1.0, 'exp', 3),\n        (0.6, 'lor', 2),\n        (2.0, 'fd', 10),\n        (1.5, 'exp', 5),\n    ]\n\n    regulator_map = {'exp': f_exp, 'lor': f_lor, 'fd': f_fd}\n    final_results = []\n    \n    # Calculate binding energy once for the full potential\n    h_full = get_h_integrand_func(g)\n    def root_func(E):\n        return 1.0 + LAMBDA_POT * calculate_J(E, h_full)\n    \n    E_d = brentq(root_func, -LAMBDA_POT, -1e-9, xtol=ROOT_FINDER_TOL)\n    \n    for Lambda, reg_name, n in test_cases:\n        reg_func = regulator_map[reg_name]\n        \n        def g_low(k):\n            return reg_func(k, Lambda, n) * g(k)\n\n        h_low = get_h_integrand_func(g_low)\n\n        # --- Part 1: Binding Invariance Verification ---\n        J_full_Ed = calculate_J(E_d, h_full)\n        J_low_Ed = calculate_J(E_d, h_low)\n\n        kappa = cmath.sqrt(-E_d)\n        k_complex = 1j * kappa\n        f_val_Ed = reg_func(k_complex, Lambda, n)\n\n        # The term (1 + LAMBDA_POT * J_full_Ed) is numerically close to zero\n        root_residual = 1.0 + LAMBDA_POT * J_full_Ed\n        \n        lam_eff_denom = f_val_Ed**2 * (root_residual) - LAMBDA_POT * J_low_Ed\n        lam_eff_Ed = LAMBDA_POT / lam_eff_denom\n\n        delta_B = abs(1.0 + lam_eff_Ed * J_low_Ed)\n        \n        # --- Part 2: Phase Shift Invariance Verification ---\n        k_samples = [0.1 * Lambda, 0.5 * Lambda, 0.9 * Lambda]\n        phase_diffs = []\n\n        for k in k_samples:\n            E = k**2\n            \n            J_full_E = calculate_J(E, h_full)\n            K_full_onshell = -LAMBDA_POT * g(k)**2 / (1.0 + LAMBDA_POT * J_full_E)\n            delta_full = np.arctan(k * K_full_onshell)\n\n            J_low_E = calculate_J(E, h_low)\n            f_val_E = reg_func(k, Lambda, n)\n\n            lam_eff_denom_E = f_val_E**2 * (1.0 + LAMBDA_POT * J_full_E) - LAMBDA_POT * J_low_E\n            lam_eff_E = LAMBDA_POT / lam_eff_denom_E\n\n            K_low_onshell = -lam_eff_E * g_low(k)**2 / (1.0 + lam_eff_E * J_low_E)\n            delta_low = np.arctan(k * K_low_onshell)\n            \n            phase_diffs.append(abs(delta_full - delta_low))\n            \n        delta_delta_max = max(phase_diffs)\n\n        final_results.extend([delta_delta_max, delta_B])\n\n    print(f\"[{','.join(f'{x:.8e}' for x in final_results)}]\")\n\nsolve()\n```", "id": "3567823"}]}