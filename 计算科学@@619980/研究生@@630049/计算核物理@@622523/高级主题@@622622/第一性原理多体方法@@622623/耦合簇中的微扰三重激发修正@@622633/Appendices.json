{"hands_on_practices": [{"introduction": "在深入研究复杂的数值计算之前，理解物理系统潜在的对称性如何约束计算结果是至关重要的。这项练习采用一个简化但功能强大的“玩具模型”，该模型具有守恒的元数（seniority），旨在揭示某些贡献（如此处的三重激发修正）如何仅因对称性就恒为零。这种分析有助于建立深刻的理论直觉，并强调了在着手大规模计算之前进行理论分析的重要性。[@problem_id:3580078]", "problem": "考虑一个在有限动量空间盒子中描述的偶偶闭壳层有限原子核，其单粒子轨道由动量 $p$ 标记，并具有双重时间反演简并性。设哈密顿量为\n$$\nH \\equiv \\sum_{p,\\sigma} \\varepsilon_{p} \\, a^{\\dagger}_{p\\sigma} a_{p\\sigma} \\;+\\; \\lambda \\sum_{p p'} f(p) f(p') \\, P^{\\dagger}_{p} P_{p'} \\,,\n$$\n其中 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 表示自旋投影（或 Kramers 标签），$a^{\\dagger}_{p\\sigma}$ 和 $a_{p\\sigma}$ 是费米子产生和湮灭算符，$P^{\\dagger}_{p} \\equiv a^{\\dagger}_{p\\uparrow} a^{\\dagger}_{\\bar{p}\\downarrow}$ 在轨道 $p$ 中产生一个时间反演 S 波对（其中 $\\bar{p}$ 是 $p$ 的时间反演伙伴），$\\lambda$ 是一个实数耦合常数，$f(p)$ 是一个实数形状因子。假设一个 Hartree–Fock 参考态 $|\\Phi\\rangle$，该参考态用时间反演对填充了所有低于费米动量的轨道，并相对于 $|\\Phi\\rangle$ 定义正规排序哈密顿量 $H_{N}$。\n\n在单双激发耦合簇 (CCSD) 近似下进行计算，簇算符为 $T = T_{1} + T_{2}$，并假设使用正则 Hartree–Fock 基，因此根据 Brillouin 定理有 $T_{1} = 0$。令 $T_{2}$ 仅限于与上述可分离对力相互作用一致的 seniority-zero 对激发。考虑对基态能量的标准非迭代微扰三重激发修正，记为 $E^{(T)}$，它是通过将三重激发振幅近似为以下形式构建的\n$$\nt_{abc}^{ijk} \\approx \\frac{W_{abc}^{ijk}}{\\Delta_{abc}^{ijk}} \\,,\n$$\n其中 $| \\Phi_{ijk}^{abc} \\rangle$ 是相对于 $|\\Phi\\rangle$ 的三粒子-三空穴激发，$\\Delta_{abc}^{ijk} \\equiv \\varepsilon_{i} + \\varepsilon_{j} + \\varepsilon_{k} - \\varepsilon_{a} - \\varepsilon_{b} - \\varepsilon_{c}$ 是由单粒子能量构建的 Møller–Plesset 分母，$W_{abc}^{ijk}$ 是在收敛的 CCSD 水平上由相似性变换哈密顿量 $\\bar{H} \\equiv \\exp(-T) H_{N} \\exp(T)$ 生成的连通三重激发残差耦合。\n\n从耦合簇拟设以及 seniority 和对守恒算符的性质出发，推导对于该哈密顿量，$W_{abc}^{ijk}$ 是否为零。然后，确定此模型中 $E^{(T)}$ 的最终闭合形式值。将 $\\lambda$ 和 $f(p)$ 视为与束缚闭壳层兼容的任意实数参数，并且不假设 $\\varepsilon_{p}$、$\\lambda$ 或 $f(p)$ 的任何具体数值。您的论证必须基于算符结构以及源于给定哈密顿量 $H$ 和 CCSD 截断的选择定则，而不是基于任何 $E^{(T)}$ 的专门公式。\n\n以兆电子伏特 (MeV) 为单位陈述 $E^{(T)}$ 的最终答案。如果您的结果非零且需要一个数值，则四舍五入到四位有效数字；如果您的结果恒等于零，则报告 $0$。", "solution": "该问题要求计算由特定对力哈密顿量描述的原子核基态能量的非迭代微扰三重激发修正值 $E^{(T)}$。解决该问题的方法是首先分析哈密顿量的性质和波函数的拟设，特别是关于 seniority 的概念。Seniority，记为 $v$，定义为给定状态中不属于时间反演对的费米子数量。一个时间反演对是指一对处于状态 $(p, \\uparrow)$ 和 $(\\bar{p}, \\downarrow)$ 的费米子，其中 $\\bar{p}$ 是 $p$ 的时间反演伙伴。产生这样一对的算符为 $P^{\\dagger}_{p} \\equiv a^{\\dagger}_{p\\uparrow} a^{\\dagger}_{\\bar{p}\\downarrow}$。\n\n让我们分析给定的哈密顿量：\n$$\nH = H_{0} + V = \\sum_{p,\\sigma} \\varepsilon_{p} \\, a^{\\dagger}_{p\\sigma} a_{p\\sigma} + \\lambda \\sum_{p p'} f(p) f(p') \\, P^{\\dagger}_{p} P_{p'}\n$$\n单体部分 $H_{0}$ 是每个单粒子轨道的粒子数算符，因此它保持每个单粒子轨道的粒子数守恒。它不破坏对，因此是 seniority 守恒的。\n两体相互作用 $V$与 $P^{\\dagger}_{p} P_{p'}$ 成正比。算符 $P_{p'}$ 湮灭轨道 $p'$ 中的一个时间反演对，而算符 $P^{\\dagger}_{p}$ 在轨道 $p$ 中产生一个时间反演对。相互作用的净效应是将一个对从一个轨道散射到另一个轨道。由于它只作用于对，所以不会改变未配对费米子的数量。因此，相互作用 $V$ 也是 seniority 守恒的。\n由于 $H_0$ 和 $V$ 都是 seniority 守恒的，总哈密顿量 $H$ 是一个 seniority 守恒算符。这意味着对于 seniority 分别为 $v_1$ 和 $v_2$ 的任意两个态 $|\\Psi_1\\rangle$ 和 $|\\Psi_2\\rangle$，矩阵元 $\\langle \\Psi_1 | H | \\Psi_2 \\rangle$ 仅在 $v_1 = v_2$ 时非零。\n\n参考态 $|\\Phi\\rangle$ 是偶偶闭壳层原子核的 Hartree-Fock 基态，它被描述为用时间反演对填充了所有低于费米动量的轨道。据此定义，$|\\Phi\\rangle$ 中所有费米子都已配对，因此参考态的 seniority 为 $v=0$。\n\n耦合簇计算在 CCSD 水平上进行，簇算符为 $T = T_2$（因为 $T_1=0$）。问题指明 $T_2$ 被“限制于 seniority-zero 对激发”。这意味着 $T_2$ 只产生本身为 seniority-zero 态的 2 粒子-2 空穴（$2p-2h$）激发。实现这一功能的算符具有以下形式：\n$$\nT_2 = \\sum_{i \\in \\text{holes}, a \\in \\text{particles}} c_{ia} P_a^{\\dagger} P_i\n$$\n其中 $c_{ia}$ 是簇振幅，$P_a^{\\dagger}$ 产生一个粒子对，$P_i \\equiv a_{\\bar{i}\\downarrow} a_{i\\uparrow}$ 湮灭一个空穴对。这种形式的 $T_2$ 作用于 seniority 为 $v$ 的态上，会产生一个 seniority 为 $v$ 的态。因此，指定的 $T_2$ 算符是 seniority 守恒的。\n\n三重激发修正 $E^{(T)}$ 由三重激发振幅 $t_{abc}^{ijk}$ 构成，后者近似为：\n$$\nt_{abc}^{ijk} \\approx \\frac{W_{abc}^{ijk}}{\\Delta_{abc}^{ijk}}\n$$\n分子 $W_{abc}^{ijk}$ 是连通三重激发残差，它由相似性变换哈密顿量 $\\bar{H} \\equiv \\exp(-T_2) H_N \\exp(T_2)$ 在参考态 $|\\Phi\\rangle$ 和一个 $3p-3h$ 激发态 $|\\Phi_{ijk}^{abc}\\rangle$ 之间的矩阵元给出。注意，正规排序哈密顿量 $H_N$ 也是 seniority 守恒的，因为它是由 $H$ 推导出来的。\n$$\nW_{abc}^{ijk} = \\langle \\Phi_{ijk}^{abc} | \\bar{H} | \\Phi \\rangle\n$$\n$W$ 的下标符号是次要的，关键在于这是一个参考态和一个 $3p-3h$ 态之间的矩阵元。让我们分析所涉及的态的 seniority。\n如前所述，参考态 $|\\Phi\\rangle$ 的 seniority 为 $v=0$。\n现在，考虑相似性变换哈密顿量 $\\bar{H}$。它是由一个包含 $H_N$ 和 $T_2$ 对易子的 BCH 展开式构建的。由于 $H_N$ 和 $T_2$ 都是 seniority 守恒算符，任何涉及它们的对易子，如 $[H_N, T_2]$，也都是 seniority 守恒的。因此，BCH 展开式中的每一项都是 seniority 守恒的，这意味着算符 $\\bar{H}$ 是 seniority 守恒的。\n\n接下来，我们必须确定一个 $3p-3h$ 态 $|\\Phi_{ijk}^{abc}\\rangle = a_a^\\dagger a_b^\\dagger a_c^\\dagger a_k a_j a_i |\\Phi\\rangle$ 的 seniority。该态是通过在初始为空的轨道中产生三个粒子，并在初始为满的轨道中产生三个空穴而形成的。这三个粒子 $\\{a, b, c\\}$ 不可能都属于时间反演对；至少会有一个未配对的粒子。三个粒子的最小粒子 seniority $v_p$ 为 $v_p=1$（例如，一个对和一个未配对粒子）。类似地，三个空穴 $\\{i, j, k\\}$ 将在费米海中至少留下一个未配对的费米子。三个空穴的最小空穴 seniority $v_h$ 为 $v_h=1$。该态的总 seniority 为 $v' = v_p + v_h$。因此，任何 $3p-3h$ 态 $|\\Phi_{ijk}^{abc}\\rangle$ 的最小 seniority 为 $v'_{min} = 1+1=2$。在所有情况下，$v' \\neq 0$。\n\n我们现在可以计算三重激发残差 $W_{abc}^{ijk}$。它是一个 seniority 守恒算符 $\\bar{H}$ 在两个不同 seniority 的态之间的矩阵元：\n- 初始态 $|\\Phi\\rangle$ 的 seniority 为 $v=0$。\n- 最终态 $|\\Phi_{ijk}^{abc}\\rangle$ 的 seniority 为 $v' \\ge 2$。\n\n因为 $v' \\neq v$，所以矩阵元必须为零：\n$$\nW_{abc}^{ijk} = \\langle \\Phi_{ijk}^{abc} | \\bar{H} | \\Phi \\rangle = 0\n$$\n这对任何 $i,j,k,a,b,c$ 的选择都成立。\n\n由于三重激发残差 $W_{abc}^{ijk}$ 全部恒等于零，近似的三重激发振幅也为零：\n$$\nt_{abc}^{ijk} \\approx \\frac{0}{\\Delta_{abc}^{ijk}} = 0\n$$\n能量的非迭代三重激发修正 $E^{(T)}$ 是由这些振幅构建的。任何 $E^{(T)}$ 的标准公式都涉及一个项的求和，其中每一项至少包含一个三重激发振幅因子 $t_{abc}^{ijk}$。由于所有三重激发振幅都为零，求和中的每一项都为零。\n\n因此，对于此模型哈密顿量和给定的近似，三重激发修正 $E^{(T)}$ 恒等于零。\n$$\nE^{(T)} = 0\n$$\n以 MeV 为单位作答的要求得到了满足，因为 $0 \\, \\text{MeV}$ 就是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3580078"}, {"introduction": "从理论结构转向实际的数值考量，我们知道微扰方法的一个基本假设是，不同量子态之间的能量间隔远大于它们之间的耦合强度。本练习将探讨当此假设不成立时会发生什么，这也是实际计算中常见的问题。通过分析“近简并”情景下的能量分母，学习者将学会识别潜在的数值不稳定性，并理解微扰方法的适用边界。[@problem_id:3580146]", "problem": "考虑一个由中等质量原子核的正则哈特里-福克 (HF) 轨道所描述的闭壳层参考态。您将使用瑞利-薛定谔多体微扰理论 (RS-MBPT)，将哈密顿量进行标准的 Møller–Plesset 划分为一个单体福克算符和一个剩余相互作用，来分析在单双激发耦合簇 (CCSD) 基础上的微扰三重激发修正。令 $i,j,k$ 表示占据轨道，$a,b,c$ 表示未占轨道，且它们均不相同。正则轨道能量（单位为 MeV）如下：\n- 占据轨道：$\\varepsilon_{i} = -11.2$, $\\varepsilon_{j} = -6.7$, $\\varepsilon_{k} = -3.9$，\n- 未占轨道（近简并情况）：$\\varepsilon_{a} = -7.4$, $\\varepsilon_{b} = -7.2$, $\\varepsilon_{c} = -7.1$。\n\n采用一个简化的单通道模型来计算微扰三重激发能量，其中三重激发 $(i,j,k) \\rightarrow (a,b,c)$ 的所有连通、反对称化且经过排列求和的分子项贡献被汇总为一个有效标量 $M_{ijk}^{abc}$，其单位为 MeV$^{2}$，而所有其他三重激发的贡献均为零。对于此通道，给定 $M_{ijk}^{abc} = 0.135$ MeV$^{2}$。请在福克算符是对角的正则基中进行计算。\n\n从 RS-MBPT 中针对非相互作用参考态的能量修正的定义出发，仅使用正则轨道的基本性质以及在粒子-空穴指标置换下的反对称性（不要假定任何预先引用的“最终公式”），完成以下任务：\n1. 推导三重激发 $(i,j,k) \\rightarrow (a,b,c)$ 的非相互作用能量分母的表达式（用正则轨道能量表示），并计算其在上述近简并情况下的数值。\n2. 在正则基中，对于单个不同的三重激发通道，确定由三个空穴指标和三个粒子指标的独立置换所产生的对称因子，并用它将单通道微扰三重激发能量表示为 $M_{ijk}^{abc}$ 和您计算出的分母的函数。\n3. 对得到的单通道微扰三重激发修正 $E^{(T)}$ 进行数值计算。\n\n为了评估数值稳定性（除了计算分母外，不需要进行额外计算），考虑一个“参考”未占轨道集，其能量为 $\\varepsilon_{a'} = -2.0$, $\\varepsilon_{b'} = -1.2$, $\\varepsilon_{c'} = -0.6$，同时保持占据轨道集不变。计算该参考集对应的分母，并根据分母的量级，简要评论近简并情况与参考情况相比 $E^{(T)}$ 的数值稳定性。您报告的最终答案必须是近简并情况下 $E^{(T)}$ 的数值。请将您的答案四舍五入到四位有效数字，并以 MeV 为单位表示能量。", "solution": "该问题被验证为具有科学依据、良定且客观。它设定在多体微扰理论应用于计算物理学中耦合簇方法的标准理论框架内。所有必要的数据均已提供，且问题结构导向唯一的解。\n\n解答过程根据题目要求分三部分进行。\n\n1. 能量分母的推导与计算\n\n在采用 Møller–Plesset 划分的瑞利-薛定谔多体微扰理论 (RS-MBPT) 中，未微扰哈密顿量 $H_0$ 是福克算符 $F$，微扰 $V$ 是剩余二体相互作用。哈特里-福克基态 $|\\Phi_0\\rangle$ 是 $H_0$ 的本征态，其本征值为 $E_0^{(0)}$，即所有占据轨道能量的总和。\n$$E_0^{(0)} = \\sum_{l \\in \\text{occ}} \\varepsilon_l$$\n选择正则轨道基，使得福克算符是对角的：$F | \\phi_p \\rangle = \\varepsilon_p | \\phi_p \\rangle$。\n通过将三个电子从占据轨道 $i,j,k$ 激发到未占轨道 $a,b,c$ 来构成一个未微扰三重激发行列式 $|\\Phi_{ijk}^{abc}\\rangle$。该态也是 $H_0$ 的本征态，本征值为 $E_{ijk}^{abc,(0)}$。其能量是基态能量加上从占据轨道移走电子并将其置于未占轨道的能量代价。\n$$E_{ijk}^{abc,(0)} = E_0^{(0)} - \\varepsilon_i - \\varepsilon_j - \\varepsilon_k + \\varepsilon_a + \\varepsilon_b + \\varepsilon_c$$\n涉及中间态 $|\\Phi_{ijk}^{abc}\\rangle$ 的微扰贡献的能量分母是基态和激发态的未微扰能量之差。\n$$D_{ijk}^{abc} = E_0^{(0)} - E_{ijk}^{abc,(0)} = E_0^{(0)} - (E_0^{(0)} - \\varepsilon_i - \\varepsilon_j - \\varepsilon_k + \\varepsilon_a + \\varepsilon_b + \\varepsilon_c)$$\n这可以简化为：\n$$D_{ijk}^{abc} = \\varepsilon_i + \\varepsilon_j + \\varepsilon_k - \\varepsilon_a - \\varepsilon_b - \\varepsilon_c$$\n使用所提供的近简并情况下的轨道能量：\n$\\varepsilon_i = -11.2$ MeV, $\\varepsilon_j = -6.7$ MeV, $\\varepsilon_k = -3.9$ MeV,\n$\\varepsilon_a = -7.4$ MeV, $\\varepsilon_b = -7.2$ MeV, $\\varepsilon_c = -7.1$ MeV.\n分母的数值为：\n$$D_{ijk}^{abc} = (-11.2) + (-6.7) + (-3.9) - ((-7.4) + (-7.2) + (-7.1)) \\text{ MeV}$$\n$$D_{ijk}^{abc} = -21.8 - (-21.7) \\text{ MeV} = -0.1 \\text{ MeV}$$\n\n为进行比较，我们计算“参考”未占轨道集（$\\varepsilon_{a'} = -2.0$ MeV, $\\varepsilon_{b'} = -1.2$ MeV, 及 $\\varepsilon_{c'} = -0.6$ MeV）的分母，同时保持占据轨道能量不变。\n$$D_{ijk}^{a'b'c'} = \\varepsilon_i + \\varepsilon_j + \\varepsilon_k - \\varepsilon_{a'} - \\varepsilon_{b'} - \\varepsilon_{c'}$$\n$$D_{ijk}^{a'b'c'} = -21.8 - ((-2.0) + (-1.2) + (-0.6)) \\text{ MeV}$$\n$$D_{ijk}^{a'b'c'} = -21.8 - (-3.8) \\text{ MeV} = -18.0 \\text{ MeV}$$\n近简并情况下分母的量值 ($|D_{ijk}^{abc}| = 0.1$ MeV) 远小于参考情况下的量值 ($|D_{ijk}^{a'b'c'}| = 18.0$ MeV)。由于微扰能量修正 $E^{(T)}$ 与该分母成反比，近简并情况将产生大得多的能量修正。这表明微扰方法可能失效，因为基态和激发态之间的小能量间隔违背了小微扰的假设。结果在数值上是不稳定的，因为近简并轨道能量的微小变化会导致计算出的能量修正产生巨大波动。\n\n2. 对称因子和能量表达式\n\n总微扰三重激发能量修正 $E^{(T)}$ 是通过对所有不同三重激发通道的贡献求和得到的。为避免在对所有指标的一般求和中重复计算相同的贡献，需要引入一个对称因子。对于涉及三个不同空穴指标 ($i,j,k$) 和三个不同粒子指标 ($a,b,c$) 的三重激发，存在 $3!$ 种空穴指标的置换和 $3!$ 种粒子指标的置换。由于这些是独立的，因此有 $3! \\times 3! = 6 \\times 6 = 36$ 种方式来标记一个具有特定六个轨道的图，而所有这些标记都对应于同一物理通道。\n\n当能量表达式写成对所有指标 $i,j,k,a,b,c$ 的求和时，需要一个对称因子 $S = \\frac{1}{3! \\times 3!} = \\frac{1}{36}$ 来确保每个不同通道的贡献只被计算一次。通用公式的形式如下：\n$$E^{(T)}_{\\text{total}} = \\frac{1}{36} \\sum_{i,j,k,a,b,c} \\frac{N(i,j,k,a,b,c)}{D(i,j,k,a,b,c)}$$\n其中 $N(i,j,k,a,b,c)$ 是针对一组特定标记指标的基本分子项贡献。\n\n题目指出只有一个通道对能量有贡献，并提供了一个“有效标量 $M_{ijk}^{abc}$”，它代表“排列求和的分子项贡献”。这意味着 $M_{ijk}^{abc}$ 是对给定通道的所有排列的基本分子项求和：\n$$M_{ijk}^{abc} = \\sum_{P \\in S_3} \\sum_{Q \\in S_3} N(P(i,j,k), Q(a,b,c))$$\n其中 $P$ 和 $Q$ 分别是作用于空穴和粒子指标的置换算符。来自此单通道的能量贡献可以通过将总能量求和限制为仅对给定指标的排列求和来找到：\n$$E^{(T)} = \\frac{1}{36} \\sum_{P \\in S_3} \\sum_{Q \\in S_3} \\frac{N(P(i,j,k), Q(a,b,c))}{D(P(i,j,k), Q(a,b,c))}$$\n由于我们使用的是具有不同轨道能量的正则基，分母 $D_{ijk}^{abc}$ 在空穴指标之间或粒子指标之间的任何置换下都是不变的。因此，我们可以将其从求和中提取出来：\n$$E^{(T)} = \\frac{1}{36 D_{ijk}^{abc}} \\sum_{P \\in S_3} \\sum_{Q \\in S_3} N(P(i,j,k), Q(a,b,c))$$\n代入 $M_{ijk}^{abc}$ 的给定定义，单通道微扰三重激发能量修正的表达式为：\n$$E^{(T)} = \\frac{1}{36} \\frac{M_{ijk}^{abc}}{D_{ijk}^{abc}}$$\n\n3. 三重激发修正的数值计算\n\n使用所提供的值 $M_{ijk}^{abc} = 0.135$ MeV$^2$ 和计算出的分母 $D_{ijk}^{abc} = -0.1$ MeV，我们计算能量修正 $E^{(T)}$：\n$$E^{(T)} = \\frac{1}{36} \\frac{0.135 \\text{ MeV}^2}{-0.1 \\text{ MeV}}$$\n$$E^{(T)} = \\frac{1}{36} \\times (-1.35 \\text{ MeV})$$\n$$E^{(T)} = -0.0375 \\text{ MeV}$$\n题目要求将答案四舍五入到四位有效数字。\n$$E^{(T)} = -0.03750 \\text{ MeV}$$\n这就是单通道微扰三重激发修正的数值。", "answer": "$$\\boxed{-0.03750}$$", "id": "3580146"}, {"introduction": "在理解了理论及其数值挑战之后，最后一步便是高效的计算实现。这项练习将重点转向计算科学方面，这对于大规模计算至关重要。学习者将比较一种朴素的实现方案（$m$-scheme）与一种利用旋转对称性的复杂方案（$J$-coupled scheme），并量化后者在内存和计算时间方面的巨大节省。此练习体现了理论物理原理（角动量耦合）如何直接转化为实际的计算优势。[@problem_id:3580110]", "problem": "你的任务是为单双激发耦合簇方法（CCSD）中的(T)微扰三重激发校正 $E^{(T)}$ 设计一个计算方案。该方案需专门针对适用于闭壳层原子核的球形、$J$-耦合表象。目标是通过使用约化矩阵元和 Wigner $6j$ 及 $9j$ 符号进行角动量重耦合，与传统的磁量子数（$m$-方案）实现相比，在内存和浮点运算次数（flops）上实现的算法节省进行量化。我们关注的原子核是氧-$^{24}\\mathrm{O}$，它在 $sd$ 壳层中具有中子闭合子壳层结构。\n\n从第一性原理出发，使用以下基本原理：\n\n- Wigner–Eckart 定理指出，球张量算符的矩阵元可以分解为一个约化矩阵元和一个由 Clebsch–Gordan 系数给出的几何部分。用符号表示，该定理断言：\n$$\n\\langle j_a m_a | T^{(k)}_q | j_b m_b \\rangle = \\frac{\\langle j_a \\| T^{(k)} \\| j_b \\rangle}{\\sqrt{2j_a+1}} \\, C^{j_a m_a}_{j_b m_b, k q},\n$$\n其中 $C^{j_a m_a}_{j_b m_b, k q}$ 是一个 Clebsch–Gordan 系数。\n- 对于两体算符和双粒子态，通过 Wigner $6j$ 及 $9j$ 符号的重耦合恒等式，可以用受三角形限制和选择定则约束的解析因子替换显式的 $(m)$ 求和。在总角动量 $J=0$ 的标量闭壳层基态中，耦合的两体振幅在约化形式下遵循 $J_{\\mathrm{holes}} = J_{\\mathrm{particles}}$。\n- 对于占据相同单粒子轨道（即具有相同的 $n\\ell j$ 标记）且总角动量为 $j$ 的全同费米子，允许的耦合两体总角动量 $J$ 是从 $0$ 到 $2j-1$ 的偶数。对于角动量分别为 $j_1$ 和 $j_2$ 的两个不同轨道，允许的 $J$ 满足三角形条件 $J \\in \\{|j_1 - j_2|, |j_1 - j_2| + 1, \\dots, j_1 + j_2\\}$，并且对于半整数的 $j_1$ 和 $j_2$，$J$ 是一个整数。\n\n将内存和 flop 模型定义如下：\n\n- 在 $m$-方案中，考虑唯一的反对称双重激发张量 $t_{ij}^{ab}$，其中 $i  j$ 且 $a  b$，$i,j$ 指空穴态，$a,b$ 指粒子态。如果空穴单粒子态的总数为 $N_h$，粒子单粒子态的总数为 $N_p$，则唯一的张量条目数为\n$$\nN_{\\mathrm{m}} = \\binom{N_h}{2} \\binom{N_p}{2}.\n$$\n假设每个存储的数字是一个8字节的浮点值，因此以字节为单位的内存为 $M_{\\mathrm{m}} = 8 N_{\\mathrm{m}}$。对于 flop 模型，假设对 $E^{(T)}$ 累加的每个贡献有2次浮点运算的基础，所以\n$$\nF_{\\mathrm{m}} = 2 N_{\\mathrm{m}}.\n$$\n- 在 $J$-耦合方案中，通过无序的空穴轨道对和无序的粒子轨道对来索引约化的双重激发振幅，每个轨道对都由其角动量 $j$ 标记，并带有一个公共的耦合两体总角动量 $J$，该 $J$ 同时满足两对的三角形规则和标量选择 $J_{\\mathrm{holes}} = J_{\\mathrm{particles}}$。设 $N_{\\mathrm{J}}$ 为此类约化通道的总数，通过对每种配对组合的允许 $J$ 集合的交集大小求和得到。以字节为单位的内存为\n$$\nM_{\\mathrm{J}} = 8 N_{\\mathrm{J}} + B_{\\mathrm{ang}} N_{\\mathrm{J}},\n$$\n其中 $B_{\\mathrm{ang}}$ 是每个通道的字节开销，代表预计算的 Wigner $6j$/$9j$ 表和相关的几何系数。flop 模型为\n$$\nF_{\\mathrm{J}} = (2 + C_{\\mathrm{ang}}) N_{\\mathrm{J}},\n$$\n其中 $C_{\\mathrm{ang}}$ 是每个通道的角动量重耦合开销（以浮点运算次数计）。\n\n你必须计算并报告节省比\n$$\nS_M = \\frac{M_{\\mathrm{m}}}{M_{\\mathrm{J}}}, \\qquad S_F = \\frac{F_{\\mathrm{m}}}{F_{\\mathrm{J}}},\n$$\n对于每个测试用例。这些比率是无量纲的。\n\n角动量通道计数规则：\n\n- 用一个标签及其总角动量 $j$（一个半整数）来表示每个单粒子轨道。每个轨道的简并度为 $g = 2j + 1$。\n- 空穴单粒子态的总数为 $N_h = \\sum_{\\text{hole orbits}} g$，类似地，粒子单粒子态的总数为 $N_p = \\sum_{\\text{particle orbits}} g$。\n- 对于角动量为 $j$ 的无序相同轨道对（即该对由同一个轨道标签两次组成），允许的 $J$-集合为 $\\{0, 2, 4, \\dots, 2j-1\\}$。\n- 对于角动量为 $j_1$ 和 $j_2$ 的无序不同轨道对，允许的 $J$-集合为 $\\{|j_1 - j_2|, |j_1 - j_2| + 1, \\dots, j_1 + j_2\\}$。\n- 贡献于约化双重激发振幅的 $J$-通道是空穴对和粒子对的允许 $J$-集合的交集。\n\n精确实现上述计数，并为以下模拟 $^{24}\\mathrm{O}$ 在实际壳层中子构型的测试套件生成所需的节省比：\n\n- 测试用例 1 (基准 $sd$-壳层粒子):\n    - 空穴轨道: $\\{(0d_{5/2}, j = 5/2), (1s_{1/2}, j = 1/2)\\}$。\n    - 粒子轨道: $\\{(0d_{3/2}, j = 3/2)\\}$。\n    - 角动量开销参数: $B_{\\mathrm{ang}} = 64$ 字节/通道，$C_{\\mathrm{ang}} = 12$ flops/通道。\n- 测试用例 2 (添加 $pf$-壳层 $0f_{7/2}$ 粒子):\n    - 空穴轨道: $\\{(0d_{5/2}, j = 5/2), (1s_{1/2}, j = 1/2)\\}$。\n    - 粒子轨道: $\\{(0d_{3/2}, j = 3/2), (0f_{7/2}, j = 7/2)\\}$。\n    - 角动量开销参数: $B_{\\mathrm{ang}} = 128$ 字节/通道，$C_{\\mathrm{ang}} = 16$ flops/通道。\n- 测试用例 3 (扩展粒子，包括与 $0d_{3/2}$ 不同的 $1p_{3/2}$):\n    - 空穴轨道: $\\{(0d_{5/2}, j = 5/2), (1s_{1/2}, j = 1/2)\\}$。\n    - 粒子轨道: $\\{(0d_{3/2}, j = 3/2), (0f_{7/2}, j = 7/2), (1p_{3/2}, j = 3/2)\\}$，其中 $0d_{3/2}$ 和 $1p_{3/2}$ 是具有相同 $j$ 的不同轨道。\n    - 角动量开销参数: $B_{\\mathrm{ang}} = 0$ 字节/通道，$C_{\\mathrm{ang}} = 0$ flops/通道。\n\n你的程序应计算每个测试用例的节省比 $S_M$ 和 $S_F$，并生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n[S_M^{(1)}, S_F^{(1)}, S_M^{(2)}, S_F^{(2)}, S_M^{(3)}, S_F^{(3)}].\n$$\n所有数字必须打印为浮点值。不允许外部输入，由于所有输出都是无量纲比率，因此不需要物理单位。", "solution": "该问题要求对耦合簇计算中微扰三重激发校正 $E^{(T)}$ 的计算成本（内存和浮点运算次数-flops）进行定量比较。比较是在使用磁量子数（$m$-方案）的标准实现与利用角动量理论（$J$-耦合方案）的实现之间进行的。目标是计算与氧-24（$^{24}\\mathrm{O}$）原子核结构计算相关的三个指定测试用例的节省比 $S_M$ 和 $S_F$。\n\n分析分为两部分。首先，我们根据给出的问题陈述为每种方案定义成本模型。其次，我们通过对状态和通道进行详细枚举，将这些模型应用于每个测试用例。\n\n### 1. 成本模型：$m$-方案\n\n在 $m$-方案中，单粒子态由包括磁量子数 $m$ 在内的全套量子数索引。因此，总角动量为 $j$ 的单粒子轨道是 $g = 2j+1$ 个简并单粒子态的集合。\n\n空穴态总数 $N_h$ 和粒子态总数 $N_p$ 通过对相应轨道的简并度求和得到：\n$$\nN_h = \\sum_{i \\in \\text{hole orbits}} (2j_i+1)\n$$\n$$\nN_p = \\sum_{a \\in \\text{particle orbits}} (2j_a+1)\n$$\n\n双重激发振幅是存储和操作的主要对象，是反对称张量 $t_{ij}^{ab}$。为了计算唯一元素的数量，我们考虑无序的空穴对和无序的粒子对。此类唯一元素的总数 $N_{\\mathrm{m}}$ 由二项式系数的乘积给出：\n$$\nN_{\\mathrm{m}} = \\binom{N_h}{2} \\binom{N_p}{2}\n$$\n\n内存成本 $M_{\\mathrm{m}}$ 建模为元素总数乘以浮点数的大小（指定为8字节）。flop成本 $F_{\\mathrm{m}}$ 建模为每个张量元素贡献的基础为2次浮点运算。\n$$\nM_{\\mathrm{m}} = 8 N_{\\mathrm{m}}\n$$\n$$\nF_{\\mathrm{m}} = 2 N_{\\mathrm{m}}\n$$\n\n### 2. 成本模型：$J$-耦合方案\n\n在 $J$-耦合方案中，状态按其总角动量 $J$ 分组。这利用了核哈密顿量的旋转对称性，显著减少了需要存储的独立量的数量。独立量的数量 $N_{\\mathrm{J}}$ 是约化的两体通道的数量。一个通道由一对空穴轨道、一对粒子轨道和一个公共的耦合总角动量 $J$ 定义。\n\n$N_{\\mathrm{J}}$ 的计算需要枚举所有有效的通道：\n1.  枚举所有无序的空穴轨道对 $\\{h_1, h_2\\}$。对于每对，确定允许的耦合总角动量集合 $J_{\\mathrm{holes}}$。规则是：\n    - 如果 $h_1$ 和 $h_2$ 是相同的轨道（角动量为 $j_h$）：由于全同费米子的泡利不相容原理，$J_{\\mathrm{holes}} = \\{0, 2, 4, \\dots, 2j_h-1\\}$。\n    - 如果 $h_1$ 和 $h_2$ 是不同的轨道（角动量为 $j_{h1}, j_{h2}$）：根据标准的角动量耦合规则，$J_{\\mathrm{holes}} = \\{|j_{h1}-j_{h2}|, |j_{h1}-j_{h2}|+1, \\dots, j_{h1}+j_{h2}\\}$。\n\n2.  枚举所有无序的粒子轨道对 $\\{p_1, p_2\\}$。对于每对，使用与空穴相同的规则确定允许的耦合总角动量集合 $J_{\\mathrm{particles}}$。\n\n3.  通道总数 $N_{\\mathrm{J}}$ 是所有空穴对和粒子对组合的公共 $J$ 值数量之和。对于每个（空穴对，粒子对）组合，贡献的通道数是它们各自 $J$ 集合交集的大小：$|\\,J_{\\mathrm{holes}} \\cap J_{\\mathrm{particles}}\\,|$。\n$$\nN_{\\mathrm{J}} = \\sum_{\\substack{\\text{hole pairs} \\\\ \\{h_1, h_2\\}}} \\sum_{\\substack{\\text{particle pairs} \\\\ \\{p_1, p_2\\}}} |\\,J_{\\mathrm{holes}}(\\{h_1, h_2\\}) \\cap J_{\\mathrm{particles}}(\\{p_1, p_2\\})\\,|\n$$\n\n内存和 flop 成本现在包括存储和使用预计算的角动量重耦合系数（Wigner 符号）的开销。\n$$\nM_{\\mathrm{J}} = (8 + B_{\\mathrm{ang}}) N_{\\mathrm{J}}\n$$\n$$\nF_{\\mathrm{J}} = (2 + C_{\\mathrm{ang}}) N_{\\mathrm{J}}\n$$\n其中 $B_{\\mathrm{ang}}$ 和 $C_{\\mathrm{ang}}$ 是给定的每个通道的开销。\n\n### 3. 逐案分析\n\n我们现在将这些模型应用于三个测试用例。\n\n#### 测试用例 1\n- 空穴轨道: $\\{(0d_{5/2}, j = 5/2), (1s_{1/2}, j = 1/2)\\}$\n- 粒子轨道: $\\{(0d_{3/2}, j = 3/2)\\}$\n- 开销: $B_{\\mathrm{ang}} = 64$ 字节, $C_{\\mathrm{ang}} = 12$ flops.\n\n**$m$-方案计算:**\n- 空穴简并度: $g(5/2) = 2(5/2)+1 = 6$, $g(1/2) = 2(1/2)+1 = 2$.\n- $N_h = 6 + 2 = 8$.\n- 粒子简并度: $g(3/2) = 2(3/2)+1 = 4$.\n- $N_p = 4$.\n- $N_{\\mathrm{m}} = \\binom{8}{2} \\binom{4}{2} = 28 \\times 6 = 168$.\n- $M_{\\mathrm{m}} = 8 \\times 168 = 1344$ 字节。\n- $F_{\\mathrm{m}} = 2 \\times 168 = 336$ flops。\n\n**$J$-耦合方案计算:**\n- 空穴对及其 $J$ 集合:\n    - $\\{0d_{5/2}, 0d_{5/2}\\}$: $j=5/2$, 相同。 $J \\in \\{0, 2, 4\\}$。\n    - $\\{1s_{1/2}, 1s_{1/2}\\}$: $j=1/2$, 相同。 $J \\in \\{0\\}$。\n    - $\\{0d_{5/2}, 1s_{1/2}\\}$: $j_1=5/2, j_2=1/2$, 不同。 $J \\in \\{|5/2-1/2|, \\dots, 5/2+1/2\\} = \\{2, 3\\}$。\n- 粒子对及其 $J$ 集合:\n    - $\\{0d_{3/2}, 0d_{3/2}\\}$: $j=3/2$, 相同。 $J \\in \\{0, 2\\}$。\n- 通道计数 ($N_{\\mathrm{J}}$):\n    - $(\\{d_{5/2}, d_{5/2}\\}, \\{d_{3/2}, d_{3/2}\\}): |\\{0,2,4\\} \\cap \\{0,2\\}| = 2$.\n    - $(\\{s_{1/2}, s_{1/2}\\}, \\{d_{3/2}, d_{3/2}\\}): |\\{0\\} \\cap \\{0,2\\}| = 1$.\n    - $(\\{d_{5/2}, s_{1/2}\\}, \\{d_{3/2}, d_{3/2}\\}): |\\{2,3\\} \\cap \\{0,2\\}| = 1$.\n- $N_{\\mathrm{J}} = 2 + 1 + 1 = 4$.\n- $M_{\\mathrm{J}} = (8 + 64) \\times 4 = 72 \\times 4 = 288$ 字节。\n- $F_{\\mathrm{J}} = (2 + 12) \\times 4 = 14 \\times 4 = 56$ flops。\n\n**节省比:**\n- $S_M^{(1)} = M_{\\mathrm{m}} / M_{\\mathrm{J}} = 1344 / 288 = 4.666...$\n- $S_F^{(1)} = F_{\\mathrm{m}} / F_{\\mathrm{J}} = 336 / 56 = 6.0$.\n\n#### 测试用例 2\n- 空穴轨道: 与用例1相同。\n- 粒子轨道: $\\{(0d_{3/2}, j=3/2), (0f_{7/2}, j=7/2)\\}$\n- 开销: $B_{\\mathrm{ang}} = 128$ 字节, $C_{\\mathrm{ang}} = 16$ flops.\n\n**$m$-方案计算:**\n- $N_h = 8$.\n- 粒子简并度: $g(3/2)=4$, $g(7/2)=2(7/2)+1=8$.\n- $N_p = 4 + 8 = 12$.\n- $N_{\\mathrm{m}} = \\binom{8}{2} \\binom{12}{2} = 28 \\times 66 = 1848$.\n- $M_{\\mathrm{m}} = 8 \\times 1848 = 14784$ 字节。\n- $F_{\\mathrm{m}} = 2 \\times 1848 = 3696$ flops。\n\n**$J$-耦合方案计算:**\n- 空穴对和 $J$ 集合与用例1保持不变。\n- 粒子对及其 $J$ 集合:\n    - $\\{0d_{3/2}, 0d_{3/2}\\}$: $j=3/2$, 相同。 $J \\in \\{0, 2\\}$。\n    - $\\{0f_{7/2}, 0f_{7/2}\\}$: $j=7/2$, 相同。 $J \\in \\{0, 2, 4, 6\\}$。\n    - $\\{0d_{3/2}, 0f_{7/2}\\}$: $j_1=3/2, j_2=7/2$, 不同。 $J \\in \\{2, 3, 4, 5\\}$。\n- 通道计数 ($N_{\\mathrm{J}}$):\n    - 来自空穴对 $\\{d_{5/2}, d_{5/2}\\}$, $J_h=\\{0,2,4\\}$:\n        - vs $\\{d_{3/2}, d_{3/2}\\}, J_p=\\{0,2\\}: |\\{0,2,4\\} \\cap \\{0,2\\}| = 2$.\n        - vs $\\{f_{7/2}, f_{7/2}\\}, J_p=\\{0,2,4,6\\}: |\\{0,2,4\\} \\cap \\{0,2,4,6\\}| = 3$.\n        - vs $\\{d_{3/2}, f_{7/2}\\}, J_p=\\{2,3,4,5\\}: |\\{0,2,4\\} \\cap \\{2,3,4,5\\}| = 2$.\n    - 来自空穴对 $\\{s_{1/2}, s_{1/2}\\}$, $J_h=\\{0\\}$:\n        - vs $\\{d_{3/2}, d_{3/2}\\}: |\\{0\\} \\cap \\{0,2\\}| = 1$.\n        - vs $\\{f_{7/2}, f_{7/2}\\}: |\\{0\\} \\cap \\{0,2,4,6\\}| = 1$.\n        - vs $\\{d_{3/2}, f_{7/2}\\}: |\\{0\\} \\cap \\{2,3,4,5\\}| = 0$.\n    - 来自空穴对 $\\{d_{5/2}, s_{1/2}\\}$, $J_h=\\{2,3\\}$:\n        - vs $\\{d_{3/2}, d_{3/2}\\}: |\\{2,3\\} \\cap \\{0,2\\}| = 1$.\n        - vs $\\{f_{7/2}, f_{7/2}\\}: |\\{2,3\\} \\cap \\{0,2,4,6\\}| = 1$.\n        - vs $\\{d_{3/2}, f_{7/2}\\}: |\\{2,3\\} \\cap \\{2,3,4,5\\}| = 2$.\n- $N_{\\mathrm{J}} = (2+3+2) + (1+1+0) + (1+1+2) = 13$.\n- $M_{\\mathrm{J}} = (8 + 128) \\times 13 = 136 \\times 13 = 1768$ 字节。\n- $F_{\\mathrm{J}} = (2 + 16) \\times 13 = 18 \\times 13 = 234$ flops。\n\n**节省比:**\n- $S_M^{(2)} = M_{\\mathrm{m}} / M_{\\mathrm{J}} = 14784 / 1768 \\approx 8.361968...$\n- $S_F^{(2)} = F_{\\mathrm{m}} / F_{\\mathrm{J}} = 3696 / 234 \\approx 15.79487...$\n\n#### 测试用例 3\n- 空穴轨道: 与用例1相同。\n- 粒子轨道: $\\{(0d_{3/2}, j=3/2), (0f_{7/2}, j=7/2), (1p_{3/2}, j=3/2)\\}$\n- 开销: $B_{\\mathrm{ang}} = 0$ 字节, $C_{\\mathrm{ang}} = 0$ flops.\n\n**$m$-方案计算:**\n- $N_h = 8$.\n- 粒子简并度: $g(0d_{3/2})=4$, $g(0f_{7/2})=8$, $g(1p_{3/2})=4$.\n- $N_p = 4 + 8 + 4 = 16$.\n- $N_{\\mathrm{m}} = \\binom{8}{2} \\binom{16}{2} = 28 \\times 120 = 3360$.\n- $M_{\\mathrm{m}} = 8 \\times 3360 = 26880$ 字节。\n- $F_{\\mathrm{m}} = 2 \\times 3360 = 6720$ flops。\n\n**$J$-耦合方案计算:**\n- 空穴对和 $J$ 集合与用例1保持不变。\n- 粒子对及其 $J$ 集合 (注意 $0d_{3/2}$ 和 $1p_{3/2}$ 是不同的):\n    - $\\{0d_{3/2}, 0d_{3/2}\\}$: $j=3/2$, 相同。 $J \\in \\{0, 2\\}$。\n    - $\\{0f_{7/2}, 0f_{7/2}\\}$: $j=7/2$, 相同。 $J \\in \\{0, 2, 4, 6\\}$。\n    - $\\{1p_{3/2}, 1p_{3/2}\\}$: $j=3/2$, 相同。 $J \\in \\{0, 2\\}$。\n    - $\\{0d_{3/2}, 0f_{7/2}\\}$: $j_1=3/2, j_2=7/2$, 不同。 $J \\in \\{2, 3, 4, 5\\}$。\n    - $\\{0d_{3/2}, 1p_{3/2}\\}$: $j_1=3/2, j_2=3/2$, 不同。 $J \\in \\{0, 1, 2, 3\\}$。\n    - $\\{0f_{7/2}, 1p_{3/2}\\}$: $j_1=7/2, j_2=3/2$, 不同。 $J \\in \\{2, 3, 4, 5\\}$。\n- 通道计数 ($N_{\\mathrm{J}}$)。设 $d=0d_{3/2}$，$f=0f_{7/2}$，$p=1p_{3/2}$。\n    - 来自空穴对 $\\{d_{5/2}, d_{5/2}\\}$, $J_h=\\{0,2,4\\}$:\n        - vs $\\{d,d\\}: |\\{0,2,4\\}\\cap\\{0,2\\}|=2$.\n        - vs $\\{f,f\\}: |\\{0,2,4\\}\\cap\\{0,2,4,6\\}|=3$.\n        - vs $\\{p,p\\}: |\\{0,2,4\\}\\cap\\{0,2\\}|=2$.\n        - vs $\\{d,f\\}: |\\{0,2,4\\}\\cap\\{2,3,4,5\\}|=2$.\n        - vs $\\{d,p\\}: |\\{0,2,4\\}\\cap\\{0,1,2,3\\}|=2$.\n        - vs $\\{f,p\\}: |\\{0,2,4\\}\\cap\\{2,3,4,5\\}|=2$.\n        - 小计: $2+3+2+2+2+2=13$.\n    - 来自空穴对 $\\{s_{1/2}, s_{1/2}\\}$, $J_h=\\{0\\}$:\n        - vs $\\{d,d\\}: |\\{0\\}\\cap\\{0,2\\}|=1$.\n        - vs $\\{f,f\\}: |\\{0\\}\\cap\\{0,2,4,6\\}|=1$.\n        - vs $\\{p,p\\}: |\\{0\\}\\cap\\{0,2\\}|=1$.\n        - vs $\\{d,f\\}: |\\{0\\}\\cap\\{2,3,4,5\\}|=0$.\n        - vs $\\{d,p\\}: |\\{0\\}\\cap\\{0,1,2,3\\}|=1$.\n        - vs $\\{f,p\\}: |\\{0\\}\\cap\\{2,3,4,5\\}|=0$.\n        - 小计: $1+1+1+0+1+0=4$.\n    - 来自空穴对 $\\{d_{5/2}, s_{1/2}\\}$, $J_h=\\{2,3\\}$:\n        - vs $\\{d,d\\}: |\\{2,3\\}\\cap\\{0,2\\}|=1$.\n        - vs $\\{f,f\\}: |\\{2,3\\}\\cap\\{0,2,4,6\\}|=1$.\n        - vs $\\{p,p\\}: |\\{2,3\\}\\cap\\{0,2\\}|=1$.\n        - vs $\\{d,f\\}: |\\{2,3\\}\\cap\\{2,3,4,5\\}|=2$.\n        - vs $\\{d,p\\}: |\\{2,3\\}\\cap\\{0,1,2,3\\}|=2$.\n        - vs $\\{f,p\\}: |\\{2,3\\}\\cap\\{2,3,4,5\\}|=2$.\n        - 小计: $1+1+1+2+2+2=9$.\n- $N_{\\mathrm{J}} = 13 + 4 + 9 = 26$.\n- 当 $B_{\\mathrm{ang}} = 0$ 和 $C_{\\mathrm{ang}}=0$ 时:\n- $M_{\\mathrm{J}} = (8 + 0) \\times 26 = 208$ 字节。\n- $F_{\\mathrm{J}} = (2 + 0) \\times 26 = 52$ flops。\n\n**节省比:**\n- $S_M^{(3)} = M_{\\mathrm{m}} / M_{\\mathrm{J}} = 26880 / 208 = 129.230769...$\n- $S_F^{(3)} = F_{\\mathrm{m}} / F_{\\mathrm{J}} = 6720 / 52 = 129.230769...$\n\n在这种情况下，内存和 flop 的节省比是相同的，这与角动量开销设置为零时的预期一致。基础比率 $N_{\\mathrm{m}}/N_{\\mathrm{J}} = 3360/26 = 129.23...$ 决定了两个节省因子。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\nfrom itertools import combinations_with_replacement\n\ndef get_j_set(orbit1, orbit2):\n    \"\"\"\n    Calculates the set of allowed coupled angular momenta J for a pair of orbits.\n    Each orbit is a tuple (label, j_value).\n    \"\"\"\n    label1, j1 = orbit1\n    label2, j2 = orbit2\n\n    if label1 == label2:  # Identical orbits\n        # Allowed J are even integers from 0 to 2j-1\n        max_j = int(2 * j1 - 1)\n        return set(range(0, max_j + 1, 2))\n    else:  # Distinct orbits\n        # Allowed J Follow triangle rule: |j1-j2| = J = j1+j2\n        min_j = int(abs(j1 - j2) + 0.5) # Use 0.5 to handle half-integers correctly\n        max_j = int(j1 + j2 + 0.5)\n        return set(range(min_j, max_j + 1))\n\ndef solve():\n    \"\"\"\n    Computes memory and flop savings ratios for m-scheme vs J-coupled scheme\n    in nuclear coupled-cluster calculations.\n    \"\"\"\n    # Define test cases as (hole_orbits, particle_orbits, B_ang, C_ang)\n    # Orbits are defined as (label, j_value)\n    test_cases = [\n        # Case 1\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2)],\n            64,\n            12\n        ),\n        # Case 2\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2), ('0f7/2', 7/2)],\n            128,\n            16\n        ),\n        # Case 3\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2), ('0f7/2', 7/2), ('1p3/2', 3/2)],\n            0,\n            0\n        )\n    ]\n\n    results = []\n\n    for case in test_cases:\n        hole_orbits, particle_orbits, B_ang, C_ang = case\n\n        # --- M-scheme calculation ---\n        N_h = sum(2 * j + 1 for _, j in hole_orbits)\n        N_p = sum(2 * j + 1 for _, j in particle_orbits)\n\n        if N_h  2 or N_p  2:\n            N_m = 0\n        else:\n            N_m = math.comb(int(N_h), 2) * math.comb(int(N_p), 2)\n\n        M_m = 8 * N_m\n        F_m = 2 * N_m\n\n        # --- J-coupled scheme calculation ---\n        hole_pairs = list(combinations_with_replacement(hole_orbits, 2))\n        particle_pairs = list(combinations_with_replacement(particle_orbits, 2))\n\n        N_J = 0\n        for h_pair in hole_pairs:\n            j_set_holes = get_j_set(h_pair[0], h_pair[1])\n            for p_pair in particle_pairs:\n                j_set_particles = get_j_set(p_pair[0], p_pair[1])\n                \n                # Count channels from the intersection of J sets\n                N_J += len(j_set_holes.intersection(j_set_particles))\n\n        M_J = (8 + B_ang) * N_J\n        F_J = (2 + C_ang) * N_J\n\n        # --- Savings Ratios ---\n        S_M = M_m / M_J if M_J > 0 else 0.0\n        S_F = F_m / F_J if F_J > 0 else 0.0\n        \n        results.extend([S_M, S_F])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3580110"}]}