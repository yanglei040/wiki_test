{"hands_on_practices": [{"introduction": "在推导耦合簇（Coupled-Cluster, CC）方程时，需要对产生和湮灭算符进行大量的代数运算。本练习聚焦于两个关键概念：相对于参考态的正规排序，它能极大地简化方程形式；以及分析对易子的结构，这是相似变换哈密顿量的Baker-Campbell-Hausdorff展开的核心。掌握这些代数技巧是深入理解CC方法的基石。[@problem_id:3553610]", "problem": "考虑一个由正交归一的单粒子轨道构成的闭壳层原子核参考态斯莱特行列式 $|\\Phi\\rangle$，这些轨道张成一个活性单粒子基。设二次量子化形式的原子核多体哈密顿量最多包含双体相互作用，并以任意算符次序写为\n$$\n\\hat{H} \\equiv \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\bar{v}_{pqrs}\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r},\n$$\n其中 $a_{p}^{\\dagger}$ 和 $a_{q}$ 分别是产生和湮灭算符，$t_{pq}$ 是单体矩阵元，$\\bar{v}_{pqrs}$ 是反对称化的双体矩阵元。相对于参考态 $|\\Phi\\rangle$ 的正规序是通过 Wick 定理，根据 $|\\Phi\\rangle$ 的单体密度矩阵所隐含的收缩来定义的。\n\n您将在耦合簇单双激发 (CCSD) 框架内进行计算，其中簇算符在单激发和双激发处截断，\n$$\n\\hat{T} \\equiv \\hat{T}_{1} + \\hat{T}_{2}, \\quad \\hat{T}_{1} = \\sum_{ai} t_{i}^{a}\\, a_{a}^{\\dagger} a_{i}, \\quad \\hat{T}_{2} = \\frac{1}{4}\\sum_{abij} t_{ij}^{ab}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{j} a_{i},\n$$\n其中下标 $i,j,\\ldots$ 表示在 $|\\Phi\\rangle$ 中被占据的轨道，而 $a,b,\\ldots$ 表示未被占据的（虚）轨道。\n\n任务：\n1. 使用相对于 $|\\Phi\\rangle$ 的 Wick 定理和正规序的定义，证明将 $\\hat{H}$ 分解为相对于 $|\\Phi\\rangle$ 的正规序零体、单体和双体部分的合理性，并从物理上解释为什么这种正规序在采用 CCSD 的原子核多体计算中是有利的。\n2. 将一个正规序算符 $\\hat{O}$ 的粒子秩 $r(\\hat{O})$ 定义为其任意单项式项中产生算符的数量（等于湮灭算符的数量）。根据此定义，并使用 Wick 定理所隐含的连通收缩计数，确定由正规序哈密顿量的单体部分 $\\hat{H}_{1}$ 和双体部分 $\\hat{H}_{2}$ 与 $\\hat{T}_{1}$ 和 $\\hat{T}_{2}$ 构成的以下对易子和双重对易子所产生的最大粒子秩：\n$$\n[\\hat{H}_{1}, \\hat{T}_{1}],\\; [\\hat{H}_{1}, \\hat{T}_{2}],\\; [\\hat{H}_{2}, \\hat{T}_{1}],\\; [\\hat{H}_{2}, \\hat{T}_{2}],\n$$\n和\n$$\n[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{1}],\\; [[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{2}],\\; [[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{1}],\\; [[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{2}],\n$$\n$$\n[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{1}],\\; [[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{2}],\\; [[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{1}],\\; [[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{2}].\n$$\n将您的最终答案表示为一个单行矩阵，其 $12$ 个条目是上述对易子按所列顺序的最大粒子秩。不需要单位。答案必须是只产生整数的计算，且无需四舍五入。", "solution": "该问题包含与原子核多体理论中的耦合簇单双激发 (CCSD) 形式相关的两个任务。第一个任务是论证哈密顿量正规序的合理性并解释其效用。第二个任务是确定一系列涉及正规序哈密顿量分量和簇算符的对易子的最大粒子秩。\n\n**任务 1：正规序哈密顿量及其在 CCSD 中的优势**\n\n原子核多体哈密顿量最初以任意算符次序给出：\n$$\n\\hat{H} \\equiv \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\bar{v}_{pqrs}\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\n$$\n其中 $p,q,r,s$ 跨越一个完备的正交归一单粒子基。相对于一个参考态斯莱特行列式 $|\\Phi\\rangle$ 的正规序是将任何产生和湮灭算符的乘积重写为一系列项之和的过程，其中每一项都是一个 c-数（一个标量）乘以一个正规序的算符乘积。如果所有产生算符都位于所有湮灭算符的左侧，则称该算符乘积处于正规序，记为 $\\{\\ldots\\}$。\n\n这种重写是通过广义 Wick 定理实现的，该定理指出任何算符串都等于其正规序乘积加上所有可能的单次、双次及更高次收缩之和。两个算符的收缩是它们在参考态中的期望值，这是一个 c-数。对于由占据轨道（下标 $i,j,\\dots$）构成的斯莱特行列式参考态 $|\\Phi\\rangle$，唯一非零的基本收缩是：\n$$\n\\overline{a_{p}^{\\dagger} a_{q}} = \\langle \\Phi | a_{p}^{\\dagger} a_{q} | \\Phi \\rangle = \\rho_{qp}\n$$\n其中 $\\rho_{qp}$ 是参考态单体密度矩阵的一个元素。如果 $p, q$ 都是占据轨道，则 $\\rho_{qp} = \\delta_{qp}$，否则为 $0$。\n\n将 Wick 定理应用于 $\\hat{H}$，系统地将其分解为正规序分量：\n$1$. **单体项：**\n$$\na_{p}^{\\dagger} a_{q} = \\{a_{p}^{\\dagger} a_{q}\\} + \\overline{a_{p}^{\\dagger} a_{q}} = \\{a_{p}^{\\dagger} a_{q}\\} + \\rho_{qp}\n$$\n对 $p, q$ 求和得到：\n$$\n\\sum_{pq} t_{pq} a_{p}^{\\dagger} a_{q} = \\sum_{pq} t_{pq} \\{a_{p}^{\\dagger} a_{q}\\} + \\sum_{pq} t_{pq} \\rho_{qp} = \\sum_{pq} t_{pq} \\{a_{p}^{\\dagger} a_{q}\\} + \\sum_{i} t_{ii}\n$$\n第一项是一个正规序单体算符。第二项 $\\sum_{i} t_{ii}$ 是一个标量（一个零体算符）。\n\n$2$. **双体项：**\n乘积 $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}$ 分解如下：\n$$\na_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} = \\{a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\\} + \\sum_{\\text{1-contractions}} + \\sum_{\\text{2-contractions}}\n$$\n单次收缩项在对所有指标求和后，产生一个正规序单体算符。例如，像 $\\overline{a_p^\\dagger a_r} \\{a_q^\\dagger a_s\\} = \\rho_{rp} \\{a_q^\\dagger a_s\\}$ 这样的项对单体部分有贡献。两次收缩项产生一个标量。例如，$(\\overline{a_p^\\dagger a_r}\\overline{a_q^\\dagger a_s} - \\overline{a_p^\\dagger a_s}\\overline{a_q^\\dagger a_r}) = (\\rho_{rp}\\rho_{sq} - \\rho_{sp}\\rho_{rq})$ 对零体部分有贡献。\n\n收集所有具有相同数量未收缩算符（即相同粒子秩）的项，哈密顿量可以写成正规序形式：\n$$\n\\hat{H} = H_{0} + \\hat{H}_{1} + \\hat{H}_{2}\n$$\n其中：\n- $H_{0} = \\langle \\Phi | \\hat{H} | \\Phi \\rangle$ 是标量参考态能量（零体部分）。\n- $\\hat{H}_{1} = \\sum_{pq} f_{pq} \\{a_{p}^{\\dagger} a_{q}\\}$ 是正规序单体部分，其中 $f_{pq}$ 是 Fock 矩阵元，包含了来自 $t_{pq}$ 和 $\\bar{v}_{pqrs}$ 收缩的贡献。\n- $\\hat{H}_{2} = \\frac{1}{4} \\sum_{pqrs} \\bar{v}_{pqrs} \\{a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\\}$ 是正规序双体部分（因为 $\\bar{v}$ 是反对称的，其内部的收缩不会存在）。\n\n这种正规序在 CCSD 计算中的**物理优势**是深远的：\n首先，它将总能量分离为参考态能量 $H_0$ 和关联能。问题简化为从正规序哈密顿量 $\\hat{H}_N = \\hat{H}_1 + \\hat{H}_2$ 中寻找关联能。\n其次，也是最重要的，参考态 $|\\Phi\\rangle$ 对于正规序算符来说充当了真正的真空，这意味着任何非标量正规序算符相对于 $|\\Phi\\rangle$ 的期望值都为零。例如，$\\langle \\Phi | \\{a_{p}^{\\dagger} a_{q}\\} | \\Phi \\rangle = 0$。簇算符 $\\hat{T}_1$ 和 $\\hat{T}_2$ 本身被定义为正规序的粒子-空穴激发算符。这一性质极大地简化了耦合簇方程。核心的 CC 能量和振幅方程由相似变换哈密顿量 $\\bar{H} = e^{-\\hat{T}} \\hat{H} e^{\\hat{T}}$ 的投影导出：\n$$\nE_{\\text{corr}} = \\langle \\Phi | \\bar{H}_N | \\Phi \\rangle = \\langle \\Phi | (\\hat{H}_N e^{\\hat{T}})_C | \\Phi \\rangle\n$$\n$$\n0 = \\langle \\Phi_{\\mu} | \\bar{H}_N | \\Phi \\rangle = \\langle \\Phi_{\\mu} | (\\hat{H}_N e^{\\hat{T}})_C | \\Phi \\rangle\n$$\n其中 $|\\Phi_{\\mu}\\rangle$ 是激发行列式，下标 $C$ 表示只有连通图（项）有贡献。正规序的使用确保了关联图定理的成立，从而导向了仅含连通项的展开。使用 Wick 定理计算右侧的矩阵元被大大简化，因为任何未完全收缩（即结果为标量）的项都会消失，这极大地减少了需要计算的项数，并确保了尺度广延性。\n\n**任务 2：对易子的最大粒子秩**\n\n正规序算符 $\\hat{O}$ 的粒子秩 $r(\\hat{O})$ 是它包含的产生算符的数量。所涉及的算符具有以下秩：\n- $\\hat{H}_{1}$：单体算符，$r(\\hat{H}_{1}) = 1$。\n- $\\hat{H}_{2}$：双体算符，$r(\\hat{H}_{2}) = 2$。\n- $\\hat{T}_{1}$：单粒子-单空穴 ($1p1h$) 激发算符，$r(\\hat{T}_{1}) = 1$。\n- $\\hat{T}_{2}$：双粒子-双空穴 ($2p2h$) 激发算符，$r(\\hat{T}_{2}) = 2$。\n\n两个正规序算符 $\\hat{A}$ 和 $\\hat{B}$ 的对易子可以使用 Wick 定理进行评估。乘积 $\\hat{A}\\hat{B}$ 是正规序乘积 $\\{\\hat{A}\\hat{B}\\}$ 与带有一个或多个 $\\hat{A}$ 和 $\\hat{B}$ 算符之间收缩的项之和。由于 $\\{\\hat{A}\\hat{B}\\} = \\{\\hat{B}\\hat{A}\\}$（因为两个算符都含有偶数个费米子），这些部分在对易子 $[\\hat{A}, \\hat{B}] = \\hat{A}\\hat{B} - \\hat{B}\\hat{A}$ 中相互抵消。结果是至少源于一次收缩的项之和。\n\n单次收缩使总产生算符数量减少一个，总湮灭算符数量减少一个，因此粒子秩减少一。所得算符的最大可能秩对应于产生非零结果所需的最少连接数。对于指定的“连通收缩计数”：\n- 单个对易子 $[\\hat{A}, \\hat{B}]$ 的最大粒子秩由带有一个收缩的项产生。其秩为 $r([\\hat{A}, \\hat{B}])_{\\text{max}} = r(\\hat{A}) + r(\\hat{B}) - 1$。\n- 双重对易子 $[[\\hat{A}, \\hat{B}], \\hat{C}]$ 的最大粒子秩由所有三个算符都连通的项产生，这至少需要两次收缩。其秩为 $r([[\\hat{A}, \\hat{B}], \\hat{C}])_{\\text{max}} = r(\\hat{A}) + r(\\hat{B}) + r(\\hat{C}) - 2$。\n\n使用这些规则，我们计算每个指定对易子的最大粒子秩。\n\n**单对易子：**\n$1$. $[\\hat{H}_{1}, \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) - 1 = 1 + 1 - 1 = 1$。\n$2$. $[\\hat{H}_{1}, \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) - 1 = 1 + 2 - 1 = 2$。\n$3$. $[\\hat{H}_{2}, \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) - 1 = 2 + 1 - 1 = 2$。\n$4$. $[\\hat{H}_{2}, \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) - 1 = 2 + 2 - 1 = 3$。\n\n**双重对易子：**\n$5$. $[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) + r(\\hat{T}_{1}) - 2 = 1 + 1 + 1 - 2 = 1$。\n$6$. $[[\\hat{H}_{1}, \\hat{T}_{1}], \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{1}) + r(\\hat{T}_{2}) - 2 = 1 + 1 + 2 - 2 = 2$。\n$7$. $[[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{1}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) + r(\\hat{T}_{1}) - 2 = 1 + 2 + 1 - 2 = 2$。\n$8$. $[[\\hat{H}_{1}, \\hat{T}_{2}], \\hat{T}_{2}]$: $r(\\hat{H}_{1}) + r(\\hat{T}_{2}) + r(\\hat{T}_{2}) - 2 = 1 + 2 + 2 - 2 = 3$。\n$9$. $[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) + r(\\hat{T}_{1}) - 2 = 2 + 1 + 1 - 2 = 2$。\n$10$. $[[\\hat{H}_{2}, \\hat{T}_{1}], \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{1}) + r(\\hat{T}_{2}) - 2 = 2 + 1 + 2 - 2 = 3$。\n$11$. $[[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{1}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) + r(\\hat{T}_{1}) - 2 = 2 + 2 + 1 - 2 = 3$。\n$12$. $[[\\hat{H}_{2}, \\hat{T}_{2}], \\hat{T}_{2}]$: $r(\\hat{H}_{2}) + r(\\hat{T}_{2}) + r(\\hat{T}_{2}) - 2 = 2 + 2 + 2 - 2 = 4$。\n\n这 $12$ 个对易子的最大粒子秩序列是 $\\{1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  & 2 & 2 & 3 & 1 & 2 & 2 & 3 & 2 & 3 & 3 & 4\n\\end{pmatrix}\n}\n$$", "id": "3553610"}, {"introduction": "对耦合簇单双激发（CCSD）方程的直接计算会导致极高的计算成本，限制了其在更大体系中的应用。本练习将介绍一个至关重要的概念——“中间量”，即预先计算并存储那些在方程中反复出现的张量。通过构建和使用这些中间量，我们可以有效地分解计算步骤，从而显著降低整体的计算标度，使得对复杂原子核的精确计算成为可能。[@problem_id:3553631]", "problem": "考虑一个闭壳层原子核，其在由自洽平均场计算得到的单粒子基中进行描述。多体哈密顿量相对于平均场斯莱特行列式参考态进行正规排序，并包含单体和反对称化的双体部分。令反对称化的双体矩阵元表示为 $\\langle pq||rs\\rangle$，其中 $p,q,r,s$ 标记广义的单粒子态。在截断至单激发和双激发的耦合簇方法（Coupled-Cluster Singles and Doubles, CCSD）中，簇算符为 $T=T_{1}+T_{2}$，其中 $T_{1}=\\sum_{i,a}t_{i}^{a}a_{a}^{\\dagger}a_{i}$ 且 $T_{2}=\\frac{1}{4}\\sum_{i,j,a,b}t_{ij}^{ab}a_{a}^{\\dagger}a_{b}^{\\dagger}a_{j}a_{i}$，这里下标 $i,j,k,\\dots$ 表示参考态中的已占据态，$a,b,c,\\dots$ 表示未占据态。\n\n相似变换后的哈密顿量为 $\\bar{H}=\\exp(-T)H\\exp(T)$，双激发残差 $R_{ij}^{ab}$ 是通过将 $\\bar{H}$ 投影到双激发行列式上得到的，即 $R_{ij}^{ab}=\\langle \\Phi_{ij}^{ab}|\\bar{H}|\\Phi_{0}\\rangle$，其中 $|\\Phi_{0}\\rangle$ 是参考态，而 $|\\Phi_{ij}^{ab}\\rangle=a_{a}^{\\dagger}a_{b}^{\\dagger}a_{j}a_{i}|\\Phi_{0}\\rangle$。\n\n- 任务1：从 $\\bar{H}$ 的形式化 Baker–Campbell–Hausdorff 展开和 CCSD 截断出发，通过收集双激发残差中所有由反对称化双体相互作用 $\\langle pq||rs\\rangle$ 与单激发振幅 $t_{i}^{a}$ 进行单次收缩形成的贡献，构建一个标准的双体“缀饰相互作用”中间量 $W_{ij}^{ab}$。显式地写出 $W_{ij}^{ab}$ 的表达式，直到并包括单激发振幅 $t_{i}^{a}$ 的线性阶，并在需要时使用排列反对称化算符 $P(ij)$ 和 $P(ab)$ 来强制已占据和未占据指标对的反对称性。\n\n- 任务2：使用任务1中得到的中间量 $W_{ij}^{ab}$，将双激发残差 $R_{ij}^{ab}$ 中包含这些对单激发呈线性的双体贡献的部分，完全用 $W_{ij}^{ab}$ 来重写，要求残差表达式中不包含任何对已占据或未占据指标的显式内部求和。\n\n- 任务3：令 $n_{o}$ 为已占据单粒子态的数量，$n_{v}$ 为未占据单粒子态的数量。通过计算指标循环，确定以两种方式为所有 $\\{i,j,a,b\\}$ 构建 $R_{ij}^{ab}$ 中这个对单激发呈线性的双体贡献的前导阶计算标度（用大$\\mathcal{O}$符号表示）：(i) 当通过在 $R_{ij}^{ab}$ 中为每个四元组 $(i,j,a,b)$ 直接执行内部求和进行朴素计算时，以及 (ii) 当使用任务1中预计算的 $W_{ij}^{ab}$ 进行计算时。请提供情况 (ii) 的简化标度作为你的最终答案。\n\n以大$\\mathcal{O}$符号将你的最终标度表示为单个解析表达式。不需要数值计算。", "solution": "此问题要求在耦合簇单双激发（CCSD）振幅方程中推导和分析特定项。这些任务涉及使用二次量子化的代数操作、图论概念以及计算复杂性分析。\n\n### 问题验证\n问题陈述具有科学依据，表述清晰且客观。它基于标准的、无争议的耦合簇理论，这是计算量子物理和化学中的一种基本方法。所有变量、算符和目标都使用该领域的标准术语定义。任务具体，并导向一个唯一的、可验证的解。该问题被认定为**有效**。\n\n### 任务1：中间量 $W_{ij}^{ab}$ 的构建\n\n双激发残差 $R_{ij}^{ab}$ 由 $R_{ij}^{ab} = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle$ 给出，其中 $\\bar{H} = \\exp(-T)H\\exp(T)$ 且 $|\\Phi_0\\rangle$ 是参考斯莱特行列式。所要求的对 $R_{ij}^{ab}$ 的贡献是那些对单激发振幅 $t_k^c$ 呈线性且涉及哈密顿量双体相互作用部分 $V_N$ 的项。这些项来源于 $\\bar{H}$ 的 Baker-Campbell-Hausdorff (BCH) 展开中 $V_N$ 与单激发簇算符 $T_1$ 的单次对易子：\n$$\n\\bar{H} = H + [H, T] + \\frac{1}{2}[[H, T], T] + \\dots\n$$\n$\\bar{H}$ 中包含对 $T_1$ 呈线性且涉及 $V_N$ 的相关部分是 $[V_N, T_1]$。因此，对残差的贡献是 $\\langle \\Phi_{ij}^{ab} | [V_N, T_1] | \\Phi_0 \\rangle$。\n\n由于 $V_N$ 是一个保持粒子数的双体算符（在其正规排序形式中，它最多可以改变两个粒子和两个空穴），$V_N|\\Phi_0\\rangle$ 最多包含双激发行列式。算符 $T_1 = \\sum_{k,c} t_k^c a_c^\\dagger a_k$ 在向左作用时是一个退激发算符。因此，项 $\\langle \\Phi_{ij}^{ab} | T_1 V_N | \\Phi_0 \\rangle$ 为零，因为 $T_1$ 无法将一个最多具有两次激发的状态退激发到一个特定的四次激发状态（相对于被 $\\langle \\Phi_{ij}^{ab} |$ 湮灭的状态）。\n\n我们剩下需要计算 $\\langle \\Phi_{ij}^{ab} | V_N T_1 | \\Phi_0 \\rangle$。\n$$\n\\langle \\Phi_{ij}^{ab} | V_N T_1 | \\Phi_0 \\rangle = \\sum_{k,c} t_k^c \\langle \\Phi_{ij}^{ab} | V_N | \\Phi_k^c \\rangle\n$$\n其中 $|\\Phi_k^c \\rangle = a_c^\\dagger a_k |\\Phi_0\\rangle$。使用 Wick 定理或图论技巧计算矩阵元 $\\langle \\Phi_{ij}^{ab} | V_N | \\Phi_k^c \\rangle$ 会产生四种类型的非零贡献，这些贡献对应于通过双体相互作用顶点 $V_N$ 连接外部线 $\\{i, j, a, b\\}$ 与线 $\\{k, c\\}$。这些是 CCSD 双激发振幅方程中的标准项：\n\n1.  来自相互作用的 $V_{hvvv}$ 部分（一个空穴，三个粒子）的贡献：$\\sum_c t_i^c \\langle cj || ab \\rangle$。对已占据指标 $i$ 和 $j$ 进行反对称化后，得到 $P(ij) \\sum_c t_i^c \\langle cj || ab \\rangle = \\sum_c t_i^c \\langle cj || ab \\rangle - \\sum_c t_j^c \\langle ci || ab \\rangle$。\n2.  来自相互作用的 $V_{ohho}$ 部分（一个粒子，三个空穴）的贡献：$-\\sum_k t_k^a \\langle ik || jb \\rangle$。对未占据指标 $a$ 和 $b$ 进行反对称化后，得到 $-P(ab) \\sum_k t_k^a \\langle ik || jb \\rangle = - \\sum_k t_k^a \\langle ik || jb \\rangle + \\sum_k t_k^b \\langle ik || ja \\rangle$。\n\n排列算符 $P(pq)$ 定义为 $P(pq)f(p,q) = f(p,q) - f(q,p)$。\n\n“缀饰相互作用”中间量 $W_{ij}^{ab}$ 是通过收集所有这些贡献形成的：\n$$\nW_{ij}^{ab} = P(ij) \\sum_c t_i^c \\langle cj || ab \\rangle - P(ab) \\sum_k t_k^a \\langle ik || jb \\rangle\n$$\n展开排列算符可得到四个不同的项：\n$$\nW_{ij}^{ab} = \\left( \\sum_c t_i^c \\langle cj || ab \\rangle - \\sum_c t_j^c \\langle ci || ab \\rangle \\right) - \\left( \\sum_k t_k^a \\langle ik || jb \\rangle - \\sum_k t_k^b \\langle ik || ja \\rangle \\right)\n$$\n\n### 任务2：重写残差贡献\n\n任务1将中间量 $W_{ij}^{ab}$ 定义为对双激发残差的所有对 $T_1$ 呈线性的双体贡献的集合。任务2要求将残差的这一部分（我们记为 $\\Delta R_{ij}^{ab}(V, T_1)$）用 $W_{ij}^{ab}$ 表示。根据任务1中的构造，这是一个直接替换。$W_{ij}^{ab}$ 的表达式已经包含了对空穴指标 $k$ 和粒子指标 $c$ 的内部求和。通过预先计算整个 $W_{ij}^{ab}$ 张量，它对完整残差 $R_{ij}^{ab}$ 的贡献仅仅是一个加法。\n$$\n\\Delta R_{ij}^{ab}(V, T_1) = W_{ij}^{ab}\n$$\n这种表述满足了残差表达式本身不包含显式内部求和的要求，因为这些求和已被包含在中间量 $W_{ij}^{ab}$ 的定义和计算中。\n\n### 任务3：计算标度分析\n\n令 $n_o$ 为已占据态的数量，$n_v$ 为未占据态的数量。计算标度通过计算浮点运算次数来估计，这取决于直接实现中的嵌套循环数量。\n\n**(i) 朴素计算：**\n在朴素计算中，对每个特定残差元 $R_{ij}^{ab}$ 的贡献是通过为 $n_o^2 n_v^2$ 个四元组 $(i,j,a,b)$ 中的每一个直接执行对 $k$ 和 $c$ 的求和来计算的。\n\n*   考虑项 $\\sum_c t_i^c \\langle cj || ab \\rangle$：对于每个 $(i,j,a,b)$，这需要对 $n_v$ 个元素求和。在所有残差中，这类项（包括其置换部分）的总成本与 $n_o^2 \\times n_v^2 \\times n_v = n_o^2 n_v^3$ 成正比。\n*   考虑项 $\\sum_k t_k^a \\langle ik || jb \\rangle$：对于每个 $(i,j,a,b)$，这需要对 $n_o$ 个元素求和。在所有残差中，这类项（包括其置换部分）的总成本与 $n_o^2 \\times n_v^2 \\times n_o = n_o^3 n_v^2$ 成正比。\n\n朴素计算的总标度是这些成本的总和，由最昂贵的步骤决定：\n$$\n\\mathcal{O}_{\\text{naive}} = \\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)\n$$\n\n**(ii) 使用预计算的中间量 $W_{ij}^{ab}$ 进行计算：**\n这种方法意味着一个两阶段过程。首先，计算并存储整个张量 $W_{ij}^{ab}$。其次，使用这个预计算的张量来更新完整的残差张量 $R_{ij}^{ab}$。\n\n1.  **$W_{ij}^{ab}$ 的计算：** 计算 $W_{ij}^{ab}$ 张量所有元素的成本与朴素计算的成本相同，因为它涉及完全相同的求和：$\\mathcal{O}(n_o^2 n_v^3 + n_o^3 n_v^2)$。\n2.  **$W_{ij}^{ab}$ 的使用：** 一旦 $W_{ij}^{ab}$ 被完全计算出来，“计算”其对残差的贡献就仅仅意味着将 $W_{ij}^{ab}$ 的元素加到 $R_{ij}^{ab}$ 的相应元素上。这是一个张量加法：$R \\leftarrow R + W$。此操作需要对所有四个指标 $i, j, a, b$ 循环一次，没有内部求和。\n\n这第二步的成本由张量的大小决定，即 $n_o^2 n_v^2$。\n\n问题要求的是“情况 (ii) 的简化标度”。这种措辞被解释为询问算法中因预计算了中间量而简化的那部分的标度。虽然整个过程的成本由 $W_{ij}^{ab}$ 的计算主导，但*使用*预计算的中间量来构建最终残差的步骤，其标度与朴素的、一体化的计算相比有所降低。这个简化的标度对应于最终张量加法的成本。\n\n从预计算的中间量构建残差的简化标度是：\n$$\n\\mathcal{O}_{\\text{reduced}} = \\mathcal{O}(n_o^2 n_v^2)\n$$\n这是最终更新步骤的标度，它显著低于对每个残差元素的贡献进行直接、未分解计算的标度。", "answer": "$$\n\\boxed{\\mathcal{O}(n_o^2 n_v^2)}\n$$", "id": "3553631"}, {"introduction": "CCSD计算的最终目标之一是预测物理可观测量，以与实验结果进行比较。本练习将演示如何将多体计算的抽象结果（如单体密度矩阵）与一个可实验测量的物理量——核电荷半径——联系起来。此过程不仅涉及应用CCSD密度矩阵，还包括引入必要的物理修正（如质心运动和相对论效应），从而提供了一个从理论计算到实验验证的完整工作流程。[@problem_id:3553638]", "problem": "你面临一个公式化任务，它深深植根于应用于耦合簇单双激发（CCSD）的核结构多体理论。仅从基本定义和经过充分检验的公式出发，设计并实现一个算法，用于在谐振子单粒子基中根据CCSD单体质子密度计算核电荷半径。你的程序必须为一小组测试用例输出以飞米（fm）为单位的电荷半径。\n\n从以下基本基础开始。\n\n- 均方电荷半径定义为内禀电荷密度算符的基态期望值。对于一个质子数为 $Z$、中子数为 $N$、质量数为 $A = Z + N$ 的原子核，其均方电荷半径为\n$$\nr_{\\mathrm{ch}}^2 \\equiv \\frac{1}{Z}\\sum_{i \\in p} \\left\\langle \\left(\\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}\\right)^2 \\right\\rangle + \\Delta_{\\mathrm{em}},\n$$\n其中 $\\mathbf{R}_{\\mathrm{cm}}$ 是所有 $A$ 个核子的质心坐标算符，而 $\\Delta_{\\mathrm{em}}$ 集合了电磁和相对论有效算符的贡献。\n\n- 在耦合簇单双激发（CCSD）中，单体算符 $\\hat{O}$ 的期望值由CCSD单体密度矩阵 $\\gamma$ 与该算符在所选单粒子基中的单体矩阵表示 $O$ 的乘积的迹给出，\n$$\n\\langle \\hat{O} \\rangle = \\mathrm{Tr}\\left(\\gamma \\, O\\right).\n$$\n对于实验室系中的点质子均方半径，这给出\n$$\nr_{pp,\\mathrm{lab}}^2 = \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} \\, R^2\\right),\n$$\n其中 $\\gamma^{(p)}$ 是质子部分的CCSD单体密度矩阵，而 $R^2$ 是算符 $\\hat{r}^{\\,2}$ 在该基中的单体矩阵。\n\n- 在振子长度为 $b$ 的谐振子基中，假设基态可分解为一个内禀部分和一个 $0s$ 质心部分，质心均方半径的期望值为\n$$\n\\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle = \\frac{3 b^2}{2 A}.\n$$\n使用此公式从 $r_{pp,\\mathrm{lab}}^2$ 获得内禀点质子均方半径 $r_{pp}^2$。\n\n- 所需的电磁和相对论修正是领先的质子有限尺寸修正 $R_p^2$、乘以因子 $N/Z$ 的中子均方电荷半径 $R_n^2$、Darwin–Foldy 项 $r_{\\mathrm{DF}}^2$ 以及自旋轨道修正 $r_{\\mathrm{SO}}^2$。这些修正定义了\n$$\n\\Delta_{\\mathrm{em}} = R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2.\n$$\n\n你的任务是使用上述有物理依据的出发点，不作任何其他假设，为以下每个测试用例计算以飞米为单位的电荷半径 $r_{\\mathrm{ch}}$。在所有情况下，单体密度矩阵 $\\gamma^{(p)}$ 都是厄米的，其迹等于 $Z$。单体算符矩阵 $R^2$ 是实对称的，其元素单位为 $\\mathrm{fm}^2$。谐振子长度 $b$ 的单位是 $\\mathrm{fm}$，而 $R_p^2$、$R_n^2$、$r_{\\mathrm{DF}}^2$ 和 $r_{\\mathrm{SO}}^2$ 的单位是 $\\mathrm{fm}^2$。每个用例的最终答案必须是电荷半径 $r_{\\mathrm{ch}}$（单位为 $\\mathrm{fm}$），并四舍五入到 $6$ 位小数。\n\n需要实现的测试套件：\n\n- 情况 1：\n  - $A = 16$, $Z = 8$, $N = 8$, $b = 1.76$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 6.8  & 0.1 \\\\ 0.1  & 1.2 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.0  & 0.2 \\\\ 0.2  & 7.0 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.080$。\n\n- 情况 2：\n  - $A = 40$, $Z = 20$, $N = 20$, $b = 1.97$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 10.0  & 0.2 & 0.0 \\\\ 0.2  & 8.5 & 0.1 \\\\ 0.0  & 0.1 & 1.5 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.5  & 0.1 & 0.0 \\\\ 0.1  & 8.0 & 0.2 \\\\ 0.0  & 0.2 & 10.5 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.050$。\n\n- 情况 3：\n  - $A = 4$, $Z = 2$, $N = 2$, $b = 1.40$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 2.0 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 2.94 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = 0.000$。\n\n- 情况 4：\n  - $A = 48$, $Z = 20$, $N = 28$, $b = 2.00$。\n  - $\\gamma^{(p)} = \\begin{bmatrix} 15.5  & -0.3 \\\\ -0.3  & 4.5 \\end{bmatrix}$。\n  - $R^2 = \\begin{bmatrix} 5.6  & 0.15 \\\\ 0.15  & 9.5 \\end{bmatrix}$。\n  - $R_p^2 = 0.770$, $R_n^2 = -0.1161$, $r_{\\mathrm{DF}}^2 = 0.033$, $r_{\\mathrm{SO}}^2 = -0.060$。\n\n实现和输出要求：\n\n- 对每个用例，根据上述基本定义计算电荷半径 $r_{\\mathrm{ch}}$（单位为 $\\mathrm{fm}$）。仅使用给定的数据和标准的线性代数运算。\n- 你的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是用例 $i$ 的电荷半径（单位为 $\\mathrm{fm}$），并四舍五入到 $6$ 位小数。", "solution": "该问题是有效的，因为它在科学上基于核多体理论的原理，特别是耦合簇理论，并为计算核电荷半径提供了一套定义明确、客观且完整的数据和定义。所有提供的方程和常数都是计算核物理领域的标准。\n\n目标是为几个测试用例计算核电荷半径 $r_{\\mathrm{ch}}$。计算过程是通过确定均方电荷半径 $r_{\\mathrm{ch}}^2$，然后取其平方根得到 $r_{\\mathrm{ch}}$。\n\n均方电荷半径定义为内禀点质子均方半径（此处表示为 $r_{pp}^2$）与一系列电磁和相对论修正项 $\\Delta_{\\mathrm{em}}$ 的和：\n$$\nr_{\\mathrm{ch}}^2 = r_{pp}^2 + \\Delta_{\\mathrm{em}}\n$$\n其中 $r_{pp}^2 = \\frac{1}{Z}\\sum_{i \\in p} \\left\\langle \\left(\\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}\\right)^2 \\right\\rangle$。计算 $r_{\\mathrm{ch}}^2$ 的算法可分为以下几个步骤：\n\n1.  **计算实验室系点质子均方半径 ($r_{pp,\\mathrm{lab}}^2$)**：\n    实验室系中半径平方算符的期望值是使用提供的耦合簇单双激发（CCSD）单体质子密度矩阵 $\\gamma^{(p)}$ 和位置平方算符的矩阵表示 $R^2$ 来计算的。公式为：\n    $$\n    r_{pp,\\mathrm{lab}}^2 = \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} R^2\\right)\n    $$\n    其中 $Z$ 是质子数，$\\mathrm{Tr}(M)$ 表示矩阵 $M$ 的迹。矩阵乘积 $\\gamma^{(p)} R^2$ 的迹计算为 $\\sum_i \\sum_j (\\gamma^{(p)})_{ij} (R^2)_{ji}$。\n\n2.  **计算质心（CM）贡献 ($\\langle R_{\\mathrm{cm}}^2 \\rangle$)**：\n    质心的运动对实验室系半径有贡献。为了获得内禀半径，必须移除这种效应。使用为谐振子基提供的公式，质心坐标平方的期望值为：\n    $$\n    \\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle = \\frac{3 b^2}{2 A}\n    $$\n    其中 $b$ 是谐振子长度，$A$ 是核子总数。\n\n3.  **计算内禀点质子均方半径 ($r_{pp}^2$)**：\n    通过从实验室系半径中减去质心贡献来获得内禀半径。当使用不能分离质心和内禀坐标的基组时，这种修正是核结构计算中的标准程序。\n    $$\n    r_{pp}^2 = r_{pp,\\mathrm{lab}}^2 - \\left\\langle R_{\\mathrm{cm}}^2 \\right\\rangle\n    $$\n\n4.  **计算电磁和相对论修正 ($\\Delta_{\\mathrm{em}}$)**：\n    测量的电荷半径不仅仅由点状质子的空间分布决定。其他几种效应也有贡献，这些效应被收集在 $\\Delta_{\\mathrm{em}}$ 项中。这些包括质子的有限尺寸（$R_p^2$）、中子的电荷分布（$R_n^2$）以及相对论效应，即 Darwin-Foldy（$r_{\\mathrm{DF}}^2$）和自旋轨道（$r_{\\mathrm{SO}}^2$）项。总修正由下式给出：\n    $$\n    \\Delta_{\\mathrm{em}} = R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2\n    $$\n    其中 $N$ 是中子数。\n\n5.  **计算最终电荷半径 ($r_{\\mathrm{ch}}$)**：\n    通过将内禀点质子均方半径和修正项相加，我们得到总均方电荷半径：\n    $$\n    r_{\\mathrm{ch}}^2 = r_{pp}^2 + \\Delta_{\\mathrm{em}} = \\left( \\frac{1}{Z}\\mathrm{Tr}\\left(\\gamma^{(p)} R^2\\right) - \\frac{3 b^2}{2 A} \\right) + \\left( R_p^2 + \\frac{N}{Z} R_n^2 + r_{\\mathrm{DF}}^2 + r_{\\mathrm{SO}}^2 \\right)\n    $$\n    电荷半径是该值的平方根：\n    $$\n    r_{\\mathrm{ch}} = \\sqrt{r_{\\mathrm{ch}}^2}\n    $$\n这一系列计算将应用于每个测试用例，使用所提供的数据。每个用例的最终结果将四舍五入到6位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nuclear charge radius from CCSD one-body proton densities\n    in a harmonic-oscillator single-particle basis for a set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": 16, \"Z\": 8, \"N\": 8, \"b\": 1.76,\n            \"gamma_p\": np.array([[6.8, 0.1], [0.1, 1.2]]),\n            \"R2\": np.array([[5.0, 0.2], [0.2, 7.0]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.080,\n        },\n        {\n            \"A\": 40, \"Z\": 20, \"N\": 20, \"b\": 1.97,\n            \"gamma_p\": np.array([[10.0, 0.2, 0.0], [0.2, 8.5, 0.1], [0.0, 0.1, 1.5]]),\n            \"R2\": np.array([[5.5, 0.1, 0.0], [0.1, 8.0, 0.2], [0.0, 0.2, 10.5]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.050,\n        },\n        {\n            \"A\": 4, \"Z\": 2, \"N\": 2, \"b\": 1.40,\n            \"gamma_p\": np.array([[2.0]]),\n            \"R2\": np.array([[2.94]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": 0.000,\n        },\n        {\n            \"A\": 48, \"Z\": 20, \"N\": 28, \"b\": 2.00,\n            \"gamma_p\": np.array([[15.5, -0.3], [-0.3, 4.5]]),\n            \"R2\": np.array([[5.6, 0.15], [0.15, 9.5]]),\n            \"R_p_sq\": 0.770, \"R_n_sq\": -0.1161, \"r_DF_sq\": 0.033, \"r_SO_sq\": -0.060,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack variables for clarity\n        A, Z, N = case[\"A\"], case[\"Z\"], case[\"N\"]\n        b = case[\"b\"]\n        gamma_p = case[\"gamma_p\"]\n        R2 = case[\"R2\"]\n        R_p_sq, R_n_sq, r_DF_sq, r_SO_sq = case[\"R_p_sq\"], case[\"R_n_sq\"], case[\"r_DF_sq\"], case[\"r_SO_sq\"]\n\n        # Step 1: Calculate the lab-frame point-proton mean-square radius\n        # Tr(gamma * R^2) can be calculated as Tr(gamma @ R2)\n        tr_gamma_R2 = np.trace(gamma_p @ R2)\n        r_pp_lab_sq = tr_gamma_R2 / Z\n\n        # Step 2: Calculate the center-of-mass contribution\n        r_cm_sq = (3 * b**2) / (2 * A)\n\n        # Step 3: Calculate the intrinsic point-proton mean-square radius\n        r_pp_sq = r_pp_lab_sq - r_cm_sq\n\n        # Step 4: Calculate the electromagnetic and relativistic corrections\n        delta_em = R_p_sq + (N / Z) * R_n_sq + r_DF_sq + r_SO_sq\n\n        # Step 5: Calculate the total mean-square charge radius and the charge radius\n        r_ch_sq = r_pp_sq + delta_em\n        r_ch = np.sqrt(r_ch_sq)\n        \n        # Append the result rounded to 6 decimal places\n        results.append(round(r_ch, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3553638"}]}