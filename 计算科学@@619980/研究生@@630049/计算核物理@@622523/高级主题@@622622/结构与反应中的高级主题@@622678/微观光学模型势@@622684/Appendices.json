{"hands_on_practices": [{"introduction": "掌握微观光学势的第一步是学习如何从其基本组成部分构建它。这个练习 [@problem_id:3569722] 将指导您完成一个核心的“折叠”计算，即将一个现实的核密度分布与一个有效的核子-核子相互作用相结合。这项实践将抽象的理论植根于一个具体的数值任务中，通过计算其关键的积分性质——体积积分，来加深您对模型成分的理解。", "problem": "给定一个基于有效相互作用（$g$矩阵）和核基态密度的、用于描述核子从球形核上散射的中心光学势的微观折叠模型表示。该光学势由三维空间卷积定义\n$$\nU(\\mathbf{r},E) = \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big),\n$$\n其中 $U(\\mathbf{r},E)$ 是入射能量为 $E$ 时的复光学势，$\\rho(\\mathbf{r})$ 是靶核的基态密度，而 $g(s;E)$ 是间距为 $s$、能量为 $E$ 时的有效核子-核子相互作用（$g$矩阵）的中心部分。需要计算的中心体积分是\n$$\nJ_V(E) = \\int d^3 r \\,\\Re U(\\mathbf{r},E),\n$$\n其中 $\\Re U(\\mathbf{r},E)$ 表示 $U(\\mathbf{r},E)$ 的实部。所有量都必须在球对称近似下处理，所有 $J_V(E)$ 的最终数值答案必须以 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$ 为单位表示。\n\n对于钙-40 ($^{40}\\mathrm{Ca}$) 靶核，请使用以下物理上自洽的模型输入：\n\n1. 基态密度为双参数费米（也称为Woods-Saxon）形式，\n$$\n\\rho(r) = \\frac{\\rho_0}{1+\\exp\\left(\\frac{r-c}{a}\\right)},\n$$\n其中 $c=3.67\\,\\mathrm{fm}$ 且 $a=0.55\\,\\mathrm{fm}$。参数 $\\rho_0$ 必须由归一化条件确定\n$$\n\\int d^3 r \\,\\rho(r) = A,\n$$\n其中 $A=40$。您必须通过数值计算 $\\rho_0$，以使归一化密度在您的求积法的数值精度内积分为 $A$。\n\n2. 有效相互作用（$g$矩阵）的实中心部分被建模为具有能量依赖性的单程高斯形式，\n$$\n\\Re g(s;E) = V_0(E)\\,\\exp\\!\\left(-\\frac{s^2}{\\beta^2}\\right),\n$$\n其中 $\\beta = 1.0\\,\\mathrm{fm}$，$V_0(E)$ 是能量依赖强度，由下式给出\n$$\nV_0(E) = \\frac{V_{00}}{1 + E/E_0},\n$$\n其中 $V_{00} = -120\\,\\mathrm{MeV}$ 且 $E_0 = 100\\,\\mathrm{MeV}$。此任务不需要 $g(s;E)$ 的虚部。\n\n您的任务是实现一个对 $J_V(E)$ 的数值稳定计算，使用在均匀步长为 $dr$ 的有限域 $[0,R_{\\max}]$ 上的球对称径向求积。所有中间径向积分都应在所选网格上使用标准数值求积法进行。通过选择测试套件中指定的物理上合理的 $R_{\\max}$ 和 $dr$ 值来确保数值收敛。按要求以 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$ 为单位报告 $J_V(E)$ 和派生量。\n\n测试套件。您的程序必须针对下面列出的参数值计算以下输出：\n\n- 除非另有说明，否则全程使用 $R_{\\max} = 12\\,\\mathrm{fm}$。\n- 使用 $^{40}\\mathrm{Ca}$ 的参数 $A=40$, $c=3.67\\,\\mathrm{fm}$, $a=0.55\\,\\mathrm{fm}$, $\\beta=1.0\\,\\mathrm{fm}$, $V_{00}=-120\\,\\mathrm{MeV}$, $E_0=100\\,\\mathrm{MeV}$。\n\n定义并计算以下七个结果：\n1. 对于 $E=50\\,\\mathrm{MeV}$ 和 $dr=0.01\\,\\mathrm{fm}$，计算总中心体积分 $J_V(50\\,\\mathrm{MeV})$，单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$。\n2. 对于 $E=50\\,\\mathrm{MeV}$ 和 $dr=0.01\\,\\mathrm{fm}$，计算单核子体积分 $J_V(50\\,\\mathrm{MeV})/A$，单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$。\n3. 对于 $E=50\\,\\mathrm{MeV}$ 和 $dr=0.01\\,\\mathrm{fm}$，将 $J_V(50\\,\\mathrm{MeV})/A$ 与一个唯象基准窗口 $[-550,-350]\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^3$ 进行比较，该窗口在此能量下对中等质量核是典型的。输出一个布尔值，指示 $J_V(50\\,\\mathrm{MeV})/A$ 是否在此区间内。\n4. 对于 $E=0\\,\\mathrm{MeV}$ 和 $dr=0.01\\,\\mathrm{fm}$，计算 $J_V(0\\,\\mathrm{MeV})/A$，单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$。\n5. 对于 $E=200\\,\\mathrm{MeV}$ 和 $dr=0.01\\,\\mathrm{fm}$，计算 $J_V(200\\,\\mathrm{MeV})/A$，单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$。\n6. 使用 $dr=0.01\\,\\mathrm{fm}$，计算数值计算得到的归一化值 $\\int d^3 r\\, \\rho(r)$，以验证其接近 $A=40$。将此值作为浮点数输出。\n7. 在 $E=50\\,\\mathrm{MeV}$ 处进行网格敏感性检查：分别使用 $dr=0.01\\,\\mathrm{fm}$（“精细”）和 $dr=0.20\\,\\mathrm{fm}$（“粗略”）计算 $J_V(50\\,\\mathrm{MeV})/A$，并输出这两个单核子值之间的绝对差，单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$。\n\n最终输出格式。您的程序应生成单行输出，其中包含按顺序排列的上述七个结果，形式为用方括号括起来的逗号分隔列表，例如\n$$\n[\\text{J50\\_total},\\text{J50\\_perA},\\text{in\\_window},\\text{J0\\_perA},\\text{J200\\_perA},\\text{A\\_computed},\\text{grid\\_diff}].\n$$\n第一、二、四、五和七个条目必须是单位为 $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$ 的浮点数，第三个条目必须是布尔值，第六个条目必须是表示计算出的归一化值的浮点数（无量纲，预计接近 $40$）。", "solution": "该问题要求计算微观光学势 $U(\\mathbf{r},E)$ 实部的中心体积分 $J_V(E)$。该势是通过折叠模型构建的，表示靶核密度 $\\rho(\\mathbf{r}')$ 与有效核子-核子相互作用 $g$ 的卷积。\n\n中心体积分定义为：\n$$\nJ_V(E) = \\int d^3 r \\,\\Re U(\\mathbf{r},E)\n$$\n光学势 $U(\\mathbf{r},E)$ 由卷积分给出：\n$$\nU(\\mathbf{r},E) = \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big)\n$$\n将 $U(\\mathbf{r},E)$ 的表达式代入 $J_V(E)$ 的定义中，并取实部，得到：\n$$\nJ_V(E) = \\int d^3 r \\, \\Re \\left( \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big) \\right)\n$$\n由于核密度 $\\rho(\\mathbf{r}')$ 是一个实数量，我们可以将实部算符 $\\Re$ 移动到仅作用于复数相互作用 $g$ 上：\n$$\nJ_V(E) = \\int d^3 r \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, \\Re g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big)\n$$\n函数 $\\rho$ 和 $\\Re g$ 是良态的，允许交换积分顺序（Fubini 定理）：\n$$\nJ_V(E) = \\int d^3 r' \\,\\rho(\\mathbf{r}') \\left( \\int d^3 r \\, \\Re g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big) \\right)\n$$\n我们来分析内部积分。引入变量替换 $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$，这意味着 $d^3 s = d^3 r$。内部积分变为：\n$$\n\\int d^3 s \\, \\Re g(s;E)\n$$\n其中 $s = |\\mathbf{s}|$。该积分表示有效相互作用实部的体积分。关键的是，它的值不依赖于 $\\mathbf{r}'$。因此，可以将其从外部积分中提出：\n$$\nJ_V(E) = \\left( \\int d^3 r' \\,\\rho(\\mathbf{r}') \\right) \\left( \\int d^3 s \\, \\Re g(s;E) \\right)\n$$\n这种分离是简化计算的关键。问题从一个复杂的六维卷积简化为两个独立的三维积分的乘积。\n\n第一项是核密度的体积分。根据定义，该积分被归一化为质量数 $A$：\n$$\n\\int d^3 r' \\,\\rho(\\mathbf{r}') = A\n$$\n第二项是相互作用实部的体积分，我们将其记为 $j_V(E)$：\n$$\nj_V(E) = \\int d^3 s \\, \\Re g(s;E)\n$$\n因此，总中心体积分就是：\n$$\nJ_V(E) = A \\cdot j_V(E)\n$$\n由此，单核子体积分立即可以确定为 $j_V(E) = J_V(E)/A$。\n\n该问题要求在有限径向网格上进行数值实现。这两个积分将使用梯形法则进行数值计算，这是一种适用于均匀网格的标准且合适的方法。\n\n**数值实现步骤：**\n\n1.  **网格设置**：建立一个从 $r=0$ 到 $R_{\\max}=12\\,\\mathrm{fm}$ 的均匀径向网格，步长为 $dr$。两个积分都将在此网格上进行。这个有限范围是一个极好的近似，因为密度 $\\rho(r)$ 和相互作用 $\\Re g(s)$ 都呈指数衰减，并且在半径大于 $R_{\\max}$ 时可以忽略不计。\n\n2.  **密度归一化**：$^{40}\\mathrm{Ca}$ 的基态密度由双参数费米函数给出：\n    $$\n    \\rho(r) = \\frac{\\rho_0}{1+\\exp\\left(\\frac{r-c}{a}\\right)}\n    $$\n    参数为 $c=3.67\\,\\mathrm{fm}$ 和 $a=0.55\\,\\mathrm{fm}$。归一化常数 $\\rho_0$ 未给出，必须通过施加核子总数为 $A=40$ 的条件来确定。在球坐标系中，此条件为：\n    $$\n    \\int_0^{R_{\\max}} 4\\pi r^2 \\rho(r) dr = A\n    $$\n    我们首先数值计算未归一化部分的积分，$I_{unnorm} = \\int_0^{R_{\\max}} 4\\pi r^2 \\left(1+\\exp\\left(\\frac{r-c}{a}\\right)\\right)^{-1} dr$。然后，通过 $\\rho_0 = A/I_{unnorm}$ 找到 $\\rho_0$。对于需要总积分 $J_V(E)$ 的任务，我们将使用数值计算的归一化值 $A_{\\text{comp}} = \\int_0^{R_{\\max}} 4\\pi r^2 \\rho(r) dr$，以确保一致性。\n\n3.  **相互作用体积分**：单核子体积分 $j_V(E)$ 是通过对给定的 $g$ 矩阵实部进行积分来计算的：\n    $$\n    \\Re g(s;E) = V_0(E)\\,\\exp\\!\\left(-\\frac{s^2}{\\beta^2}\\right), \\quad \\text{其中} \\quad V_0(E) = \\frac{V_{00}}{1 + E/E_0}\n    $$\n    参数为 $\\beta=1.0\\,\\mathrm{fm}$，$V_{00}=-120\\,\\mathrm{MeV}$ 和 $E_0=100\\,\\mathrm{MeV}$。在球坐标系中的积分为：\n    $$\n    j_V(E) = \\int_0^{R_{\\max}} 4\\pi s^2 \\, \\Re g(s;E) ds\n    $$\n    对每个所需的能量 $E$ 数值计算该积分。\n\n4.  **最终量**：测试套件所需的量由这些中间计算组装而成。总积分为 $J_V(E) = A_{\\text{comp}} \\cdot j_V(E)$，单核子体积分是 $j_V(E)$。其他测试涉及在指定的不同条件下（$E$ 和 $dr$）比较这些值。\n    - 测试 1：$J_V(50\\,\\mathrm{MeV})$\n    - 测试 2：$J_V(50\\,\\mathrm{MeV})/A \\approx j_V(50\\,\\mathrm{MeV})$\n    - 测试 3：检查 $j_V(50\\,\\mathrm{MeV}) \\in [-550,-350]\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^3$\n    - 测试 4：$j_V(0\\,\\mathrm{MeV})$\n    - 测试 5：$j_V(200\\,\\mathrm{MeV})$\n    - 测试 6：$A_{\\text{comp}}$\n    - 测试 7：用 $dr=0.01\\,\\mathrm{fm}$ 和 $dr=0.20\\,\\mathrm{fm}$ 计算的 $j_V(50\\,\\mathrm{MeV})$ 的绝对差。\n\n这种方法计算效率高、数值稳定，并正确地解释了折叠模型及其体积分的物理原理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the volume integral of a microscopic optical potential and derived quantities.\n    \"\"\"\n    \n    # Define physical and model constants for Ca-40\n    A = 40.0\n    c = 3.67      # fm (radius parameter of Woods-Saxon)\n    a = 0.55      # fm (diffuseness parameter of Woods-Saxon)\n    beta = 1.0    # fm (range of the Gaussian interaction)\n    V00 = -120.0  # MeV (strength of the interaction at E=0)\n    E0 = 100.0    # MeV (energy dependence scale)\n    R_max = 12.0  # fm (radial integration cutoff)\n\n    def compute_all(E, dr):\n        \"\"\"\n        Helper function to perform the core numerical calculations for a given\n        energy E and grid spacing dr.\n\n        Returns:\n            j_V_num (float): Per-nucleon volume integral in MeV*fm^3.\n            J_V_total (float): Total volume integral in MeV*fm^3.\n            A_comp (float): Numerically computed normalization of the density.\n        \"\"\"\n        # 1. Create the uniform radial grid\n        # Use np.arange with a small addition to ensure R_max is included.\n        r_grid = np.arange(0, R_max + dr / 2.0, dr)\n        \n        # 2. Normalize the nuclear density\n        # Integrand for the unnormalized density: 4*pi*r^2 * rho_unnormalized(r)\n        rho_unnorm_integrand = 4.0 * np.pi * r_grid**2 / (1.0 + np.exp((r_grid - c) / a))\n        \n        # Integrate using the trapezoidal rule\n        I_rho_unnorm = np.trapz(rho_unnorm_integrand, x=r_grid)\n        \n        # Determine the normalization constant rho_0\n        rho_0 = A / I_rho_unnorm\n        \n        # 3. Compute the volume integral of the interaction (j_V)\n        # This is the per-nucleon volume integral J_V/A.\n        V0 = V00 / (1.0 + E / E0)\n        \n        # Integrand for j_V: 4*pi*s^2 * Re(g(s; E))\n        # The integration variable is s, but we use the same radial grid.\n        g_integrand = 4.0 * np.pi * r_grid**2 * V0 * np.exp(-r_grid**2 / beta**2)\n        \n        # Integrate using the trapezoidal rule\n        j_V_num = np.trapz(g_integrand, x=r_grid)\n        \n        # 4. Compute the actual numerical normalization achieved (A_comp)\n        # This serves as a consistency check and is required for Test 6.\n        rho_norm_integrand = rho_0 * (4.0 * np.pi * r_grid**2 / (1.0 + np.exp((r_grid - c) / a)))\n        A_comp = np.trapz(rho_norm_integrand, x=r_grid)\n        \n        # 5. Compute the total volume integral (J_V)\n        # We use A_comp for full numerical consistency.\n        J_V_total = A_comp * j_V_num\n        \n        return j_V_num, J_V_total, A_comp\n\n    # --- Execute the Test Suite ---\n    \n    dr_fine = 0.01\n\n    # Tests 1, 2, 3, 6 are based on E=50 MeV, dr=0.01 fm\n    j50_perA_fine, J50_total, A_computed_fine = compute_all(E=50.0, dr=dr_fine)\n    \n    # Result 1: Total central volume integral J_V(50 MeV)\n    result1 = J50_total\n    \n    # Result 2: Per-nucleon volume integral J_V(50 MeV)/A\n    result2 = j50_perA_fine\n    \n    # Result 3: Check if J_V(50 MeV)/A is in the benchmark window\n    result3 = -550.0 = j50_perA_fine = -350.0\n    \n    # Result 6: The numerically obtained normalization integral\n    result6 = A_computed_fine\n\n    # Test 4: Per-nucleon volume integral at E=0 MeV\n    j0_perA, _, _ = compute_all(E=0.0, dr=dr_fine)\n    result4 = j0_perA\n\n    # Test 5: Per-nucleon volume integral at E=200 MeV\n    j200_perA, _, _ = compute_all(E=200.0, dr=dr_fine)\n    result5 = j200_perA\n    \n    # Test 7: Grid sensitivity check\n    dr_coarse = 0.20\n    j50_perA_coarse, _, _ = compute_all(E=50.0, dr=dr_coarse)\n    \n    # Absolute difference between fine and coarse grid results\n    result7 = abs(j50_perA_fine - j50_perA_coarse)\n\n    # --- Final Output Formatting ---\n    \n    # Assemble the final list of results in the specified order\n    final_results = [result1, result2, result3, result4, result5, result6, result7]\n\n    # Format the list into the required string format\n    # Booleans must be lowercase 'true' or 'false'.\n    formatted_results = []\n    for res in final_results:\n        if isinstance(res, (bool, np.bool_)):\n            formatted_results.append(str(res).lower())\n        else:\n            formatted_results.append(f\"{res:.8f}\")\n\n    # Print the final output string in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3569722"}, {"introduction": "微观光学势的一个关键特征是其固有的非局域性，这源于量子力学中的交换效应。这项实践 [@problem_id:3569711] 提供了一种切实可感的方式来理解非局域性的影响，通过计算并比较非局域势及其简化的局域等效势所产生的散射粒子角分布。您将亲身体会到这一基本性质如何直接体现在可观测的散射截面中，并学习如何量化这种差异。", "problem": "考虑在一个包含非局域性的微观光学势框架内模拟的核子-原子核弹性散射。在一级玻恩近似下进行研究，以分离解析结构并进行受控比较。假设一个有心的、纯实的、球形“微观”体项，在坐标空间中用高斯形状因子近似。采用一个高斯 Perey–Buck 型非局域核，该核依赖于相对坐标和平均坐标，在微观光学模型中被广泛用作交换效应和离壳效应引起的非局域性的替代。\n\n用作基本出发点和假设：\n- 用于弹性散射的不含时薛定谔方程和 Lippmann–Schwinger (LS) 散射形式理论。\n- 从势算符计算在壳散射振幅的一级玻恩近似，以及散射理论中使用的标准平面波归一化。\n- 质心相对动量 $k$ 的定义，由约化质量 $\\mu$ 和质心能量 $E_{\\mathrm{cm}}$ 通过 $k = \\sqrt{2 \\mu E_{\\mathrm{cm}}}/(\\hbar c)$ 给出，单位为逆费米。\n- 球贝塞尔函数 $j_0(x)$ 出现在球对称函数的三维傅里叶变换中。\n\n模型要素：\n- 对势的平均坐标依赖性使用局域高斯剖面 $V(r) = -V_0 \\exp(-r^2/a^2)$，其中 $V_0  0$，力程参数 $a$ 的单位为费米。这代表一个折叠微观相互作用。\n- 使用非局域力程为 $\\beta$ (单位为费米) 的高斯非局域核 $g(s) \\propto \\exp(-s^2/\\beta^2)$，完整的非局域光学势取为 $U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$，其中 $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ 且 $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$。\n- 通过将非局域核替换为一个在前向运动学下计算的、依赖于能量的常数因子来定义“局域等效”模型，使得局域等效振幅在 $ \\theta = 0 $ 时与非局域振幅匹配，但在有限角度时不一定匹配。\n\n任务：\n1. 从 LS 方程和一级玻恩近似出发，基于上述模型假设，推导局域高斯势在动量空间中的散射振幅。然后，推导由依赖于平均坐标的高斯非局域核引入的修正，并说明非局域核如何通过入射和出射动量的平均值在弹性运动学中引入额外的角依赖性。用 $k$、动量转移大小 $q = 2k \\sin(\\theta/2)$ 和平均动量大小 $K = k \\cos(\\theta/2)$ 来表示相应的微分截面。\n2. 通过将给定参数集的非局域预测作为真实值并施加一个全局尺度失配来定义合成的“实验”微分截面值。具体来说，对于任意固定角度 $\\theta_i$，将实验值 $\\sigma_{\\mathrm{exp}}(\\theta_i)$ 设为非局域模型预测值 $\\sigma_{\\mathrm{nonloc}}(\\theta_i)$ 的 $s$ 倍，其中 $s = 1.02$，并指定标准差 $\\delta \\sigma(\\theta_i) = u \\, \\sigma_{\\mathrm{exp}}(\\theta_i)$，其中 $u = 0.05$。在所有公式中，角度必须解释为弧度，但在测试套件中以度为单位提供。对于 $N$ 个角度，约化卡方为\n$$\n\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2,\n$$\n这是无量纲的；所有最终结果都以无量纲浮点数（无单位）的形式报告。\n3. 实现一个程序，对下面测试套件中的每个测试用例，使用任务1中推导的解析结果和任务2中的实验构建，计算非局域模型的约化卡方 $\\chi^2_{\\nu}(\\mathrm{nonloc})$ 及其局域等效模型的约化卡方 $\\chi^2_{\\nu}(\\mathrm{loc\\_equiv})$。然后，为每个测试用例报告其差值\n$$\n\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc}),\n$$\n四舍五入到三位小数。正的 $\\Delta \\chi^2_{\\nu}$ 表示非局域模型比其局域等效模型提供了更好的拟合。\n\n物理常数和单位约定：\n- 使用 $\\hbar c = 197.3269804 \\ \\mathrm{MeV \\, fm}$。\n- 使用核子质量 $m_N = 938.92 \\ \\mathrm{MeV}/c^2$。\n- 对于质量数为 $A$ 的靶核上的入射核子，使用约化质量 $\\mu = m_N \\, A/(A+1)$。\n- 使用质心能量 $E_{\\mathrm{cm}} = E_{\\mathrm{lab}} \\, A/(A+1)$。\n- 所有能量单位必须为 $\\mathrm{MeV}$，所有长度单位为 $\\mathrm{fm}$，所有角度在计算时需转换为弧度。输出是无量纲的。\n\n测试套件：\n- 使用固定的角度集（以度为单位） $\\Theta = \\{0, 30, 60, 90, 120, 150\\}$。\n- 在所有情况下均使用 $s = 1.02$ 和 $u = 0.05$。\n- 用例1 (理想情况): $E_{\\mathrm{lab}} = 30$, $A = 40$, $V_0 = 50$, $a = 1.2$, $\\beta = 0.85$。\n- 用例2 (边界，局域极限): $E_{\\mathrm{lab}} = 30$, $A = 40$, $V_0 = 50$, $a = 1.2$, $\\beta = 0$。\n- 用例3 (更高动量，更强非局域效应): $E_{\\mathrm{lab}} = 65$, $A = 90$, $V_0 = 52$, $a = 1.2$, $\\beta = 0.85$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含用例1-3的 $\\Delta \\chi^2_{\\nu}$ 值，按顺序排列，形式为用方括号括起来的逗号分隔列表，每个值都四舍五入到三位小数。例如，三个用例的输出行必须类似于 $[x_1,x_2,x_3]$，其中每个 $x_i$ 是一个小数点后恰好有三位数字的浮点数。", "solution": "## 问题验证\n\n### 步骤1：提取给定信息\n- **框架**：不含时薛定谔方程，Lippmann-Schwinger 形式理论，一级玻恩近似。\n- **散射振幅**：对于一般的非局域势 $U$， $f(\\mathbf{k}', \\mathbf{k}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\int e^{-i\\mathbf{k}' \\cdot \\mathbf{r}'} U(\\mathbf{r}, \\mathbf{r}') e^{i\\mathbf{k} \\cdot \\mathbf{r}} d^3r d^3r'$。\n- **动量定义**：$k = \\sqrt{2 \\mu E_{\\mathrm{cm}}}/(\\hbar c)$，单位为 fm$^{-1}$。\n- **数学函数**：球贝塞尔函数 $j_0(x)$，用于球对称函数的三维傅里叶变换。\n- **局域势形式**：$V(r) = -V_0 \\exp(-r^2/a^2)$，其中 $V_0  0$。\n- **非局域核形式**：$g(s) \\propto \\exp(-s^2/\\beta^2)$。\n- **完整非局域势**：$U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$，其中 $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ 且 $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$。\n- **局域等效定义**：局域等效振幅在 $\\theta = 0$ 时与非局域振幅匹配，方法是用一个依赖于能量的常数因子替换非局域核的效应。\n- **“实验”数据**：$\\sigma_{\\mathrm{exp}}(\\theta_i) = s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$，比例因子 $s = 1.02$。\n- **不确定度**：$\\delta \\sigma(\\theta_i) = u \\cdot \\sigma_{\\mathrm{exp}}(\\theta_i)$，相对不确定度 $u = 0.05$。\n- **约化卡方**：$\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2$。\n- **目标量**：$\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc})$。\n- **物理常数**：$\\hbar c = 197.3269804 \\ \\mathrm{MeV \\, fm}$，$m_N = 938.92 \\ \\mathrm{MeV}/c^2$。\n- **运动学关系**：$\\mu = m_N \\, A/(A+1)$，$E_{\\mathrm{cm}} = E_{\\mathrm{lab}} \\, A/(A+1)$。\n- **角度集**：$\\Theta = \\{0, 30, 60, 90, 120, 150\\}$ 度。\n- **测试用例**：\n    1. $E_{\\mathrm{lab}} = 30$ MeV, $A = 40$, $V_0 = 50$ MeV, $a = 1.2$ fm, $\\beta = 0.85$ fm。\n    2. $E_{\\mathrm{lab}} = 30$ MeV, $A = 40$, $V_0 = 50$ MeV, $a = 1.2$ fm, $\\beta = 0$ fm。\n    3. $E_{\\mathrm{lab}} = 65$ MeV, $A = 90$, $V_0 = 52$ MeV, $a = 1.2$ fm, $\\beta = 0.85$ fm。\n\n### 步骤2：使用提取的给定信息进行验证\n该问题是理论和计算核物理中一个定义明确的练习。\n- **有科学依据**：该问题建立在标准散射理论（Lippmann-Schwinger 方程，玻恩近似）之上，并使用了一个常见的非局域光学势模型（Perey-Buck 型高斯非局域性）。运动学关系和物理常数都是标准的。该模型是一种简化，但植根于已建立的物理概念。\n- **良构的**：所有必需的参数、常数和公式都已提供。任务是具体的，并且对每个测试用例都能导出一个唯一的、可计算的数值结果。\n- **客观的**：该问题使用精确的数学和物理术语陈述，没有主观或模棱两可的语言。\n\n该问题没有违反任何无效标准。它是一个可形式化的、自洽的且科学上合理的问题。\n\n### 步骤3：结论和行动\n问题是有效的。将制定一个完整的解决方案。\n\n## 解答\n\n### 任务1：散射截面的推导\n\n对于一般的、可能非局域的势 $U(\\mathbf{r}, \\mathbf{r}')$，一级玻恩近似下的散射振幅 $f$ 由下式给出：\n$$\nf(\\mathbf{k}', \\mathbf{k}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\iint e^{-i\\mathbf{k}' \\cdot \\mathbf{r}'} U(\\mathbf{r}, \\mathbf{r}') e^{i\\mathbf{k} \\cdot \\mathbf{r}} d^3r d^3r'\n$$\n其中 $\\mathbf{k}$ 和 $\\mathbf{k}'$ 是质心系中的初始和末态波矢，$\\mu$ 是约化质量，$\\hbar$ 是约化普朗克常数。对于弹性散射，有 $|\\mathbf{k}| = |\\mathbf{k}'| = k$。\n\n非局域势由 $U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$ 给出，其中 $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ 且 $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$。我们必须将积分变量从 $(\\mathbf{r}, \\mathbf{r}')$ 更改为 $(\\mathbf{R}, \\mathbf{s})$。其关系为 $\\mathbf{r} = \\mathbf{R} + \\mathbf{s}/2$ 和 $\\mathbf{r}' = \\mathbf{R} - \\mathbf{s}/2$。这个变换的雅可比行列式为 $1$。积分中的相位因子变为：\n$$\n-i\\mathbf{k}' \\cdot \\mathbf{r}' + i\\mathbf{k} \\cdot \\mathbf{r} = -i\\mathbf{k}' \\cdot (\\mathbf{R} - \\mathbf{s}/2) + i\\mathbf{k} \\cdot (\\mathbf{R} + \\mathbf{s}/2) = -i(\\mathbf{k}' - \\mathbf{k}) \\cdot \\mathbf{R} + i\\frac{\\mathbf{k}' + \\mathbf{k}}{2} \\cdot \\mathbf{s}\n$$\n定义动量转移 $\\mathbf{q} = \\mathbf{k}' - \\mathbf{k}$ 和平均动量 $\\mathbf{K} = (\\mathbf{k}' + \\mathbf{k})/2$，相位为 $-i\\mathbf{q} \\cdot \\mathbf{R} + i\\mathbf{K} \\cdot \\mathbf{s}$。散射振幅积分分解为两个傅里叶变换的乘积：\n$$\nf_{\\mathrm{nonloc}}(\\mathbf{q}, \\mathbf{K}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\left[ \\int e^{-i\\mathbf{q} \\cdot \\mathbf{R}} V(R) d^3R \\right] \\left[ \\int e^{i\\mathbf{K} \\cdot \\mathbf{s}} g(s) d^3s \\right] = -\\frac{\\mu}{2\\pi\\hbar^2} \\tilde{V}(\\mathbf{q}) \\tilde{g}(-\\mathbf{K})\n$$\n势的形式是 $V(r) = -V_0 \\exp(-r^2/a^2)$ 和 $g(s) \\propto \\exp(-s^2/\\beta^2)$。对于标准的 Perey-Buck 形式，核 $g(s)$ 被归一化，使得 $\\int g(s) d^3s = 1$，这要求 $g(s) = (\\pi \\beta^2)^{-3/2} \\exp(-s^2/\\beta^2)$。\n高斯函数 $G(\\mathbf{x}) = \\exp(-|\\mathbf{x}|^2/b^2)$ 的三维傅里叶变换是 $\\tilde{G}(\\mathbf{p}) = (\\pi b^2)^{3/2} \\exp(-p^2 b^2/4)$。\n应用这个，我们得到：\n$$\n\\tilde{V}(q) = -V_0 (\\pi a^2)^{3/2} \\exp(-q^2 a^2/4)\n$$\n$$\n\\tilde{g}(K) = \\int e^{-i\\mathbf{K} \\cdot \\mathbf{s}} (\\pi \\beta^2)^{-3/2} e^{-s^2/\\beta^2} d^3s = \\exp(-K^2 \\beta^2/4)\n$$\n由于 $g(s)$ 是一个偶函数，$\\tilde{g}(-\\mathbf{K}) = \\tilde{g}(\\mathbf{K})$。非局域散射振幅是：\n$$\nf_{\\mathrm{nonloc}}(\\mathbf{q}, \\mathbf{K}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\left[-V_0 (\\pi a^2)^{3/2} e^{-q^2 a^2/4}\\right] \\left[e^{-K^2 \\beta^2/4}\\right]\n$$\n纯局域势对应于 $\\beta \\to 0$ 的情况，此时 $g(s) \\to \\delta(\\mathbf{s})$ 且 $\\tilde{g}(K) \\to 1$。因此，局域势 $V(r)$ 的振幅为：\n$$\nf_{\\mathrm{loc}}(q) = -\\frac{\\mu}{2\\pi\\hbar^2} \\tilde{V}(q) = \\frac{\\mu V_0 (\\pi a^2)^{3/2}}{2\\pi\\hbar^2} e^{-q^2 a^2/4}\n$$\n比较两者，我们发现 $f_{\\mathrm{nonloc}}(q, K) = f_{\\mathrm{loc}}(q) \\exp(-K^2 \\beta^2/4)$。\n\n微分截面是 $\\frac{d\\sigma}{d\\Omega} = |f|^2$。\n对于局域势：$\\sigma_{\\mathrm{loc}}(\\theta) = |f_{\\mathrm{loc}}(q(\\theta))|^2$。\n对于非局域势：$\\sigma_{\\mathrm{nonloc}}(\\theta) = |f_{\\mathrm{nonloc}}(q(\\theta), K(\\theta))|^2 = |f_{\\mathrm{loc}}(q(\\theta))|^2 |e^{-K(\\theta)^2 \\beta^2/4}|^2 = \\sigma_{\\mathrm{loc}}(\\theta) e^{-K(\\theta)^2 \\beta^2/2}$。\n\n$q$ 和 $K$ 的大小取决于散射角 $\\theta$：\n$q = |\\mathbf{k}' - \\mathbf{k}| = 2k \\sin(\\theta/2)$\n$K = |(\\mathbf{k}' + \\mathbf{k})/2| = k \\cos(\\theta/2)$\n\n局域等效模型由一个振幅定义，其中非局域修正因子被“冻结”在其前向角 ($\\theta=0$) 的值上。在 $\\theta=0$ 时，我们有 $q=0$ 和 $K=k$。修正因子变为 $\\exp(-k^2 \\beta^2/4)$。\n$$\nf_{\\mathrm{loc\\_equiv}}(\\theta) = f_{\\mathrm{loc}}(q(\\theta)) \\cdot e^{-k^2 \\beta^2/4}\n$$\n相应的截面是：\n$$\n\\sigma_{\\mathrm{loc\\_equiv}}(\\theta) = |f_{\\mathrm{loc\\_equiv}}(\\theta)|^2 = |f_{\\mathrm{loc}}(q(\\theta))|^2 |e^{-k^2 \\beta^2/4}|^2 = \\sigma_{\\mathrm{loc}}(\\theta) e^{-k^2 \\beta^2/2}\n$$\n这种形式正确地表明，局域等效模型具有局域势的角依赖性，但被一个依赖于能量的常数缩放，该常数解释了零角度处的非局域性。\n\n### 任务2：卡方计算\n约化卡方为 $\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2$。\n合成实验数据定义为 $\\sigma_{\\mathrm{exp}}(\\theta_i) = s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$，其不确定度为 $\\delta \\sigma(\\theta_i) = u \\cdot \\sigma_{\\mathrm{exp}}(\\theta_i) = u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$。\n\n1.  **对于非局域模型**，$\\sigma_{\\mathrm{th}} = \\sigma_{\\mathrm{nonloc}}$。求和内的项变为：\n    $$\n    \\left( \\frac{\\sigma_{\\mathrm{nonloc}}(\\theta_i) - s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)}{u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)} \\right)^2 = \\left( \\frac{1 - s}{u \\cdot s} \\right)^2\n    $$\n    这个表达式对于所有角度和参数都是常数。因此，\n    $$\n    \\chi^2_{\\nu}(\\mathrm{nonloc}) = \\left( \\frac{1 - s}{u \\cdot s} \\right)^2\n    $$\n\n2.  **对于局域等效模型**，$\\sigma_{\\mathrm{th}} = \\sigma_{\\mathrm{loc\\_equiv}}$。求和内的项为：\n    $$\n    \\left( \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i) - s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)}{u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)} \\right)^2 = \\left( \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i)/\\sigma_{\\mathrm{nonloc}}(\\theta_i) - s}{u \\cdot s} \\right)^2\n    $$\n    使用推导出的截面：\n    $$\n    \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i)}{\\sigma_{\\mathrm{nonloc}}(\\theta_i)} = \\frac{\\sigma_{\\mathrm{loc}}(\\theta_i) e^{-k^2 \\beta^2/2}}{\\sigma_{\\mathrm{loc}}(\\theta_i) e^{-K(\\theta_i)^2 \\beta^2/2}} = e^{-\\frac{\\beta^2}{2} (k^2 - K(\\theta_i)^2)}\n    $$\n    代入 $K(\\theta_i)^2 = k^2 \\cos^2(\\theta_i/2)$：\n    $$\n    k^2 - K(\\theta_i)^2 = k^2 (1 - \\cos^2(\\theta_i/2)) = k^2 \\sin^2(\\theta_i/2)\n    $$\n    所以比值为 $e^{-\\frac{1}{2} k^2 \\beta^2 \\sin^2(\\theta_i/2)}$。因此，\n    $$\n    \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{e^{-\\frac{1}{2} k^2 \\beta^2 \\sin^2(\\theta_i/2)} - s}{u \\cdot s} \\right)^2\n    $$\n\n### 任务3：最终计算\n要计算的量是 $\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc})$。\n每个测试用例的算法是：\n1.  计算约化质量 $\\mu$ 和质心能量 $E_{\\mathrm{cm}}$。\n2.  计算质心动量的平方 $k^2 = 2 \\mu E_{\\mathrm{cm}} / (\\hbar c)^2$。\n3.  计算常数值 $\\chi^2_{\\nu}(\\mathrm{nonloc}) = ((1-s)/(us))^2$。\n4.  通过对给定集合 $\\Theta$ 求和角依赖项来计算 $\\chi^2_{\\nu}(\\mathrm{loc\\_equiv})$。\n5.  计算差值 $\\Delta \\chi^2_{\\nu}$ 并四舍五入到三位小数。\n\n该过程在以下 Python 代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference in reduced chi-squared between a local-equivalent\n    and a nonlocal optical model for nucleon-nucleus scattering.\n    \"\"\"\n    # Physical constants and unit conventions\n    HBARC = 197.3269804  # MeV fm\n    M_N = 938.92          # MeV/c^2\n\n    # Fixed analysis parameters\n    S_SCALE = 1.02\n    U_UNCERT = 0.05\n    ANGLES_DEG = [0, 30, 60, 90, 120, 150]\n    angles_rad = np.deg2rad(ANGLES_DEG)\n    N_ANGLES = len(ANGLES_DEG)\n\n    # Test suite: (E_lab [MeV], A, V0 [MeV], a [fm], beta [fm])\n    test_cases = [\n        (30, 40, 50, 1.2, 0.85),  # Case 1: Happy path\n        (30, 40, 50, 1.2, 0.0),   # Case 2: Boundary, local limit\n        (65, 90, 52, 1.2, 0.85),  # Case 3: Higher momentum\n    ]\n\n    results = []\n    \n    # Pre-calculate the chi-squared for the nonlocal model, which is constant.\n    # The 'experimental' data is defined from this model, so the chi-squared\n    # just measures the built-in scale mismatch 's'.\n    chi2_nu_nonloc = ((1 - S_SCALE) / (U_UNCERT * S_SCALE))**2\n\n    for case in test_cases:\n        e_lab, A, _, _, beta = case\n        \n        # Check for the trivial local case (beta=0)\n        if beta == 0:\n            # If beta is zero, nonlocality vanishes. The local, nonlocal, and\n            # local-equivalent models are identical. The difference in chi_nu^2\n            # must be zero.\n            results.append(0.0)\n            continue\n            \n        # 1. Calculate kinematic quantities\n        mu = M_N * A / (A + 1)\n        e_cm = e_lab * A / (A + 1)\n        \n        # 2. Calculate squared CM momentum k^2\n        k_squared = (2 * mu * e_cm) / (HBARC**2)\n        \n        # 3. Calculate chi-squared for the local-equivalent model\n        sum_of_sq_diffs = 0.0\n        for theta in angles_rad:\n            # The ratio of the local-equivalent to the nonlocal cross section\n            arg_exp = -0.5 * k_squared * beta**2 * np.sin(theta/2)**2\n            sigma_ratio = np.exp(arg_exp)\n            \n            # The term in the chi-squared sum\n            term = ((sigma_ratio - S_SCALE) / (U_UNCERT * S_SCALE))**2\n            sum_of_sq_diffs += term\n            \n        chi2_nu_loc_equiv = sum_of_sq_diffs / N_ANGLES\n        \n        # 4. Compute the difference\n        delta_chi2_nu = chi2_nu_loc_equiv - chi2_nu_nonloc\n        \n        results.append(delta_chi2_nu)\n\n    # Format the final output as a comma-separated list of numbers\n    # rounded to three decimal places, enclosed in square brackets.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "3569711"}, {"introduction": "一个有效的光学势必须满足深刻的理论约束，其中最核心的是因果律。这个练习 [@problem_id:3569748] 探讨了因果律如何体现为势的实部（代表折射）和虚部（代表吸收）之间的一个数学联系——色散关系。通过数值实现这一关系，您将体会到理论约束对于构建自洽且具有预测能力的模型的重要性，并理解为何对相互作用的高能行为进行正确建模至关重要。", "problem": "您的任务是构建并执行一个完整的程序，该程序数值验证了关联核物理中微观光学模型势的实部和虚部的克拉默-克若尼色散积分的收敛性质。光学模型势写作 $U(E) = V(E) + i\\,W(E)$，其中 $V(E)$ 和 $W(E)$ 分别是推迟自能的实部和虚部。根据因果性和解析性，这两部分通过色散积分相互关联。施加高能约束对于数值收敛至关重要。您的任务是实现一个关于费米能的一次减除色散关系，并量化计算出的费米能附近结果的紫外敏感性。\n\n基本原理：\n- 多体理论中的推迟响应函数在复能量上半平面是解析的，根据柯西积分定理，这意味着其实部和虚部由色散关系相连接。\n- 在一个参考能量点进行减除，通过利用希尔伯特核之差改善被积函数的积分衰减性，从而消除了紫外敏感性。\n\n定义和模型：\n- 设费米能为 $E_F$（单位：$\\mathrm{MeV}$）。\n- 设吸收阈值为 $E_t$（单位：$\\mathrm{MeV}$），对于 $E  E_t$ 有 $W(E) = 0$。这模拟了当只有阈值以上的正能激发有贡献时，原子核中的粒子道吸收。\n- 考虑以下两种虚部 $W(E)$（单位：$\\mathrm{MeV}$）的模型，由 $W_0  0$、$a  0$ 和 $E_c  0$（均为 $\\mathrm{MeV}$）参数化：\n  1. 模型 A（当 $E \\to +\\infty$ 时具有非衰减尾部）：\n     $$W_A(E) = \\begin{cases}\n     0,  \\text{for } E  E_t, \\\\\n     -W_0 \\dfrac{(E - E_t)^2}{(E - E_t)^2 + a^2},  \\text{for } E \\ge E_t.\n     \\end{cases}$$\n     这满足当 $E \\to +\\infty$ 时 $W_A(E) \\to -W_0$。\n  2. 模型 B（高能约束的阻尼尾部）：\n     $$W_B(E) = \\begin{cases}\n     0,  \\text{for } E  E_t, \\\\\n     -W_0 \\dfrac{(E - E_t)^2}{(E - E_t)^2 + a^2}\\,\\dfrac{1}{1 + \\left(\\dfrac{E - E_t}{E_c}\\right)^2},  \\text{for } E \\ge E_t.\n     \\end{cases}$$\n     这满足当 $E \\to +\\infty$ 时 $W_B(E) \\to 0$，且渐近衰减与 $\\propto E^{-2}$ 成正比。\n\n您必须实现的任务：\n- 根据推迟自能的解析性和 $W(E)$ 描述吸收强度的要求，推导并实现关于费米能的实部的一次减除色散关系。设 $\\Lambda  E_t$ 为一个紫外截断（单位：$\\mathrm{MeV}$）。为了进行数值评估，通过在 $E' = \\Lambda$ 处截断来近似半无限积分，并计算 $E_F$ 附近的减除后实部。\n- 同时，实现在区间 $[E_t,\\Lambda]$ 上截断至 $E' = \\Lambda$ 的相应未减除积分，以量化紫外敏感性。\n\n数值要求：\n- 所有能量单位必须是 $\\mathrm{MeV}$。\n- 不出现角度。\n- 您必须生成浮点数结果，单位为 $\\mathrm{MeV}$，并精确到六位小数。\n\n测试套件：\n使用以下固定参数，单位均为 $\\mathrm{MeV}$：\n- $E_F = -8.0$\n- $E_t = 0.0$\n- $W_0 = 25.0$\n- $a = 40.0$\n- $E_c = 200.0$\n定义费米能附近的评估能量为 $E_\\star = E_F + 5.0$。使用以下紫外截断 $\\Lambda \\in \\{200.0, 400.0, 800.0\\}$。\n\n按规定顺序计算以下六个量：\n1. 使用模型 A 和在 $\\Lambda$ 处截断的未减除色散积分，计算差值\n   $$\\Delta_{\\mathrm{unsub}}^{A} \\equiv V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=200.0),$$\n   单位为 $\\mathrm{MeV}$。\n2. 使用模型 A 和在 $\\Lambda$ 处截断的一次减除色散积分，计算\n   $$V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=200.0),\\quad V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=400.0),\\quad V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=800.0),$$\n   单位均为 $\\mathrm{MeV}$。\n3. 使用模型 B 和在 $\\Lambda$ 处截断的未减除色散积分，计算差值\n   $$\\Delta_{\\mathrm{unsub}}^{B} \\equiv V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=400.0),$$\n   单位为 $\\mathrm{MeV}$。\n4. 使用模型 A 和在 $\\Lambda=400.0$ 处截断的一次减除色散积分，计算\n   $$V_{\\mathrm{sub}}^{A}(E_F;\\Lambda=400.0),$$\n   单位为 $\\mathrm{MeV}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中包含六个结果，每个值都四舍五入到六位小数，并以 $\\mathrm{MeV}$ 为单位，顺序与上述规定完全一致。例如：\n“[x1,x2,x3,x4,x5,x6]”，其中每个 xi 是一个小数点后有六位数字的浮点数。", "solution": "该问题要求对核物理中微观光学模型势的色散积分的收敛性质进行数值验证。我们首先建立理论框架并推导必要的公式。\n\n光学势表示为 $U(E) = V(E) + i\\,W(E)$，它是一个推迟自能。量子多体理论中推迟响应函数的一个基本性质是其在复能量上半平面的解析性。这个性质是因果性的结果，它允许应用柯西积分定理，从而得到连接势的实部 $V(E)$ 和虚部 $W(E)$ 的克拉默-克若尼色散关系。\n\n未减除的色散关系由下式给出：\n$$ V(E) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{W(E')}{E' - E} dE' $$\n其中 $\\mathcal{P}$ 表示柯西主值。问题指明，虚部 $W(E)$ 仅在能量高于吸收阈值 $E_t$ 时非零，即对于 $E  E_t$ 有 $W(E) = 0$。因此，积分简化为：\n$$ V(E) = \\frac{1}{\\pi} \\mathcal{P} \\int_{E_t}^{\\infty} \\frac{W(E')}{E' - E} dE' $$\n问题中指定的评估能量 $E_\\star$ 和 $E_F$ 都小于阈值 $E_t=0.0\\,\\mathrm{MeV}$。因此，位于 $E' = E$ 的极点永远不在积分域内，主值算符 $\\mathcal{P}$ 可以省略。对于使用紫外截断 $\\Lambda$ 的数值计算，未减除的势为：\n$$ V_{\\mathrm{unsub}}(E; \\Lambda) = \\frac{1}{\\pi} \\int_{E_t}^{\\Lambda} \\frac{W(E')}{E' - E} dE' $$\n仅当 $W(E')$ 在 $E' \\to \\infty$ 时足够快地趋于零，该积分才是收敛的。模型 A 中，$W_A(E) \\to -W_0$ 当 $E \\to \\infty$，不满足此条件，因为被积函数的行为类似于 $1/E'$，导致随 $\\Lambda$ 的对数发散。这显示了紫外敏感性。\n\n为修正这种发散，采用了一次减除的色散关系。减除在参考能量点进行，此处选择为费米能 $E_F$。我们从 $V(E)$ 中减去 $V(E_F)$ 的表达式：\n$$ V(E) - V(E_F) = \\frac{1}{\\pi} \\int_{E_t}^{\\infty} W(E') \\left( \\frac{1}{E' - E} - \\frac{1}{E' - E_F} \\right) dE' $$\n合并括号中的项，我们得到：\n$$ V(E) - V(E_F) = \\frac{E - E_F}{\\pi} \\int_{E_t}^{\\infty} \\frac{W(E')}{(E' - E)(E' - E_F)} dE' $$\n此方程的右侧表示实势相对于其在费米能处的值的、依赖于能量的色散修正。我们将这个在截断 $\\Lambda$ 处的修正认定为问题中要求的“减除后实部” $V_{\\mathrm{sub}}(E; \\Lambda)$：\n$$ V_{\\mathrm{sub}}(E; \\Lambda) = \\frac{E - E_F}{\\pi} \\int_{E_t}^{\\Lambda} \\frac{W(E')}{(E' - E)(E' - E_F)} dE' $$\n在这种形式下，即使对于模型 A，被积函数在大 $E'$ 时的行为也类似于 $1/(E')^2$，确保了当 $\\Lambda \\to \\infty$ 时积分的收敛性。此过程消除了与未减除形式相关的紫外敏感性。此定义的一个重要推论是，当 $E=E_F$ 时，前置因子 $(E-E_F)$ 变为零，这意味着对于任何 $\\Lambda$，$V_{\\mathrm{sub}}(E_F; \\Lambda) = 0$。\n\n现在我们将使用给定的参数进行具体计算：$E_F = -8.0\\,\\mathrm{MeV}$，$E_t = 0.0\\,\\mathrm{MeV}$，$W_0 = 25.0\\,\\mathrm{MeV}$，$a = 40.0\\,\\mathrm{MeV}$，$E_c = 200.0\\,\\mathrm{MeV}$，以及 $E_\\star = E_F + 5.0 = -3.0\\,\\mathrm{MeV}$。\n\n虚势模型为：\n$$ W_A(E') = -25.0 \\frac{(E')^2}{(E')^2 + 40.0^2} \\quad \\text{对于 } E' \\ge 0 $$\n$$ W_B(E') = W_A(E') \\frac{1}{1 + (E'/200.0)^2} \\quad \\text{对于 } E' \\ge 0 $$\n\n需要计算的六个量是：\n\n1.  $\\Delta_{\\mathrm{unsub}}^{A} \\equiv V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=200.0)$：这个差值突显了对于非衰减模型 A，未减除积分对截断 $\\Lambda$ 的强烈依赖性。\n    $$ \\Delta_{\\mathrm{unsub}}^{A} = \\frac{1}{\\pi} \\int_{200.0}^{800.0} \\frac{W_A(E')}{E' - (-3.0)} dE' $$\n\n2.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=200.0)$：模型 A 在 $E_\\star = -3.0 \\, \\mathrm{MeV}$ 且 $\\Lambda = 200.0 \\, \\mathrm{MeV}$ 时的减除后势。\n    $$ V_{\\mathrm{sub}}^{A}(E_\\star; 200.0) = \\frac{-3.0 - (-8.0)}{\\pi} \\int_{0.0}^{200.0} \\frac{W_A(E')}{(E' - (-3.0))(E' - (-8.0))} dE' $$\n\n3.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=400.0)$：同上，但 $\\Lambda = 400.0 \\, \\mathrm{MeV}$。\n\n4.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=800.0)$：同上，但 $\\Lambda = 800.0 \\, \\mathrm{MeV}$。比较这三个值将展示减除后积分的快速收敛性。\n\n5.  $\\Delta_{\\mathrm{unsub}}^{B} \\equiv V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=400.0)$：这个差值显示了具有物理约束高能衰减的模型 B 减弱的紫外敏感性。\n    $$ \\Delta_{\\mathrm{unsub}}^{B} = \\frac{1}{\\pi} \\int_{400.0}^{800.0} \\frac{W_B(E')}{E' - (-3.0)} dE' $$\n\n6.  $V_{\\mathrm{sub}}^{A}(E_F;\\Lambda=400.0)$：模型 A 在减除能量 $E_F = -8.0 \\, \\mathrm{MeV}$ 处评估的减除后势。\n    $$ V_{\\mathrm{sub}}^{A}(E_F; 400.0) = \\frac{-8.0 - (-8.0)}{\\pi} \\int_{0.0}^{400.0} \\frac{W_A(E')}{(E' - (-8.0))(E' - (-8.0))} dE' = 0 $$\n    由于 $(E-E_F)$ 前置因子，这个结果在解析上为零。\n\n将使用标准库函数进行数值积分，以计算这些定积分。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    # Define fixed parameters as per the problem statement.\n    # All energy units are in MeV.\n    E_F = -8.0\n    E_t = 0.0\n    W_0 = 25.0\n    a = 40.0\n    E_c = 200.0\n    \n    # Define the evaluation energy E_star\n    E_star = E_F + 5.0\n    \n    # Define the ultraviolet cutoffs\n    cutoffs = {'low': 200.0, 'mid': 400.0, 'high': 800.0}\n\n    # --- Models for the imaginary part W(E) ---\n    \n    def W_A(E_prime):\n        \"\"\"Model A for the imaginary part of the optical potential.\"\"\"\n        if E_prime  E_t:\n            return 0.0\n        # For E_prime >= E_t\n        E_minus_Et = E_prime - E_t\n        return -W_0 * (E_minus_Et**2) / (E_minus_Et**2 + a**2)\n\n    def W_B(E_prime):\n        \"\"\"Model B for the imaginary part of the optical potential.\"\"\"\n        if E_prime  E_t:\n            return 0.0\n        # For E_prime >= E_t\n        E_minus_Et = E_prime - E_t\n        damping_factor = 1.0 / (1.0 + (E_minus_Et / E_c)**2)\n        return W_A(E_prime) * damping_factor\n\n    # --- Integrand definitions for numerical integration ---\n\n    # For Task 1: Unsubtracted, Model A\n    def integrand_unsub_A(E_prime):\n        return W_A(E_prime) / (np.pi * (E_prime - E_star))\n\n    # For Task 2, 3, 4: Subtracted, Model A\n    def integrand_sub_A(E_prime):\n        return W_A(E_prime) / ((E_prime - E_star) * (E_prime - E_F))\n\n    # For Task 5: Unsubtracted, Model B\n    def integrand_unsub_B(E_prime):\n        return W_B(E_prime) / (np.pi * (E_prime - E_star))\n\n    # --- Computation of the six required quantities ---\n    results = []\n\n    # 1. Delta_unsub^A = V_unsub^A(E_star; 800) - V_unsub^A(E_star; 200)\n    # This is equivalent to integrating from 200 to 800.\n    delta_unsub_A, _ = quad(integrand_unsub_A, cutoffs['low'], cutoffs['high'])\n    results.append(delta_unsub_A)\n    \n    # 2. V_sub^A(E_star; 200)\n    integral_sub_A_200, _ = quad(integrand_sub_A, E_t, cutoffs['low'])\n    prefactor_sub = (E_star - E_F) / np.pi\n    v_sub_A_200 = prefactor_sub * integral_sub_A_200\n    results.append(v_sub_A_200)\n\n    # 3. V_sub^A(E_star; 400)\n    integral_sub_A_400, _ = quad(integrand_sub_A, E_t, cutoffs['mid'])\n    v_sub_A_400 = prefactor_sub * integral_sub_A_400\n    results.append(v_sub_A_400)\n\n    # 4. V_sub^A(E_star; 800)\n    integral_sub_A_800, _ = quad(integrand_sub_A, E_t, cutoffs['high'])\n    v_sub_A_800 = prefactor_sub * integral_sub_A_800\n    results.append(v_sub_A_800)\n\n    # 5. Delta_unsub^B = V_unsub^B(E_star; 800) - V_unsub^B(E_star; 400)\n    # This is equivalent to integrating from 400 to 800.\n    delta_unsub_B, _ = quad(integrand_unsub_B, cutoffs['mid'], cutoffs['high'])\n    results.append(delta_unsub_B)\n\n    # 6. V_sub^A(E_F; 400)\n    # This is analytically zero due to the (E - E_F) prefactor.\n    v_sub_A_EF = 0.0\n    results.append(v_sub_A_EF)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3569748"}]}