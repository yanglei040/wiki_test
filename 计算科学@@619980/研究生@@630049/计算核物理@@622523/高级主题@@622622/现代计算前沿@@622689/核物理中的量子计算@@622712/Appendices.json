{"hands_on_practices": [{"introduction": "在量子计算机上解决核物理问题的第一步，是将描述核子相互作用的费米子哈密顿量转化为量子比特哈密顿量。Jordan-Wigner (JW) 变换是实现这一目标的一种标准方法。本练习 [@problem_id:3583685] 将通过一个非平凡的三体相互作用项，让你亲手实践这一映射过程，这对于精确表示核力至关重要，并有助于培养熟练进行相关代数操作的能力。", "problem": "考虑一个计算核物理中的简化截断壳模型系统，该系统包含三个无自旋单粒子轨道，用 $p \\in \\{1,2,3\\}$ 标记。令 $c_{p}$ 和 $c_{p}^{\\dagger}$ 分别表示轨道 $p$ 的费米子湮灭和产生算符，它们满足正则反对易关系 $\\{c_{p}, c_{q}^{\\dagger}\\} = \\delta_{pq}$ 和 $\\{c_{p}, c_{q}\\} = \\{c_{p}^{\\dagger}, c_{q}^{\\dagger}\\} = 0$。考虑一种三体接触相互作用，该作用对特定轨道集 $(1,2,3)$ 的三重占据施加能量惩罚，在二次量子化中表示为正规排序算符\n$$\nH_{3} \\;=\\; g_{3}\\, c_{1}^{\\dagger} c_{2}^{\\dagger} c_{3}^{\\dagger} c_{3} c_{2} c_{1},\n$$\n其中 $g_{3}$ 是一个实耦合常数。\n\n使用 Jordan–Wigner (JW) 变换，将 $H_{3}$ 映射到一个包含三个量子比特的量子线路模型，其中每个费米子轨道 $p$ 被编码到量子比特 $p$ 中。泡利串是在三量子比特寄存器上，从 $\\{I, X, Y, Z\\}$ 中选取的单量子比特算符的张量积。仅从正则反对易关系和 Jordan–Wigner (JW) 变换的定义出发，将 $H_{3}$ 一步步地映射为泡利串的线性组合。\n\n然后，完全展开所得表达式，并计算产生的不同非平凡泡利串的数量，其中“非平凡”是指泡利串包含至少一个非单位单量子比特算符。计数时忽略总体标量系数，且不包括单位算符。\n\n以单个整数形式给出最终计数。最终答案无需四舍五入，也无需单位。", "solution": "问题要求使用 Jordan–Wigner (JW) 变换将一个三体费米子哈密顿量 $H_3$ 映射为泡利串之和，然后计算所得表达式中不同非平凡泡利串的数量。\n\n三体哈密顿量由下式给出：\n$$\nH_{3} = g_{3}\\, c_{1}^{\\dagger} c_{2}^{\\dagger} c_{3}^{\\dagger} c_{3} c_{2} c_{1}\n$$\n其中 $c_{p}$ 和 $c_{p}^{\\dagger}$ 是轨道 $p \\in \\{1,2,3\\}$ 的费米子湮灭和产生算符，满足 $\\{c_{p}, c_{q}^{\\dagger}\\} = \\delta_{pq}$ 和 $\\{c_{p}, c_{q}\\} = \\{c_{p}^{\\dagger}, c_{q}^{\\dagger}\\} = 0$。\n\nJordan–Wigner 变换将这些费米子算符映射到多量子比特寄存器上的算符。对于一个包含 $N$ 个轨道的系统，轨道 $p$ 的映射为：\n$$\nc_{p}^{\\dagger} = \\left(\\bigotimes_{j=1}^{p-1} Z_{j}\\right) \\otimes \\sigma_{p}^{+}\n$$\n$$\nc_{p} = \\left(\\bigotimes_{j=1}^{p-1} Z_{j}\\right) \\otimes \\sigma_{p}^{-}\n$$\n其中 $Z_j$ 是作用在量子比特 $j$ 上的泡利-Z 算符，$\\sigma_{p}^{\\pm}$ 是量子比特 $p$ 的升/降算符。它们通过泡利算符 $X_p$、$Y_p$ 和 $I_p$ 定义如下：\n$$\n\\sigma_{p}^{+} = \\frac{1}{2}(X_{p} + iY_{p}) \\quad \\text{和} \\quad \\sigma_{p}^{-} = \\frac{1}{2}(X_{p} - iY_{p})\n$$\n我们使用标准的泡利算符对易关系：$XY=iZ$、$YZ=iX$、$ZX=iY$，这对于不同的 $A,B \\in \\{X, Y, Z\\}$ 意味着 $AB=-BA$。我们还使用恒等式 $\\sigma_j^2 = I_j$，其中 $\\sigma_j \\in \\{X_j, Y_j, Z_j\\}$。\n\n我们将通过分别变换产生算符乘积 $C_{\\text{op}} = c_{1}^{\\dagger} c_{2}^{\\dagger} c_{3}^{\\dagger}$ 和湮灭算符乘积 $A_{\\text{op}} = c_{3} c_{2} c_{1}$ 来进行 $H_3$ 的映射。为简洁起见，我们将隐式地写出张量積（例如，$Z_1 \\otimes \\sigma_2^+ \\equiv Z_1 \\sigma_2^+$）。\n\n首先，我们写出 $p=1, 2, 3$ 时的算符：\n$c_1^{\\dagger} = \\sigma_1^{+}$\n$c_2^{\\dagger} = Z_1 \\sigma_2^{+}$\n$c_3^{\\dagger} = Z_1 Z_2 \\sigma_3^{+}$\n\n$c_1 = \\sigma_1^{-}$\n$c_2 = Z_1 \\sigma_2^{-}$\n$c_3 = Z_1 Z_2 \\sigma_3^{-}$\n\n我们需要同一量子比特 $p$ 上算符的以下对易关系：\n$\\sigma_{p}^{+} Z_{p} = \\frac{1}{2}(X_p+iY_p)Z_p = \\frac{1}{2}(X_pZ_p+iY_pZ_p) = \\frac{1}{2}(-iY_p+i(iX_p)) = -\\frac{1}{2}(X_p+iY_p) = -\\sigma_{p}^{+}$。\n$Z_p \\sigma_{p}^{+} = Z_p \\frac{1}{2}(X_p+iY_p) = \\frac{1}{2}(Z_pX_p+iZ_pY_p) = \\frac{1}{2}(iY_p+i(-iX_p)) = \\frac{1}{2}(X_p+iY_p) = \\sigma_{p}^{+}$。\n$Z_p \\sigma_{p}^{-} = Z_p \\frac{1}{2}(X_p-iY_p) = \\frac{1}{2}(Z_pX_p-iZ_pY_p) = \\frac{1}{2}(iY_p-i(-iX_p)) = -\\frac{1}{2}(X_p-iY_p) = -\\sigma_{p}^{-}$。\n\n现在，我们计算产生算符的乘积 $C_{\\text{op}} = c_1^\\dagger c_2^\\dagger c_3^\\dagger$：\n$c_1^\\dagger c_2^\\dagger = (\\sigma_1^{+}) (Z_1 \\sigma_2^{+}) = (\\sigma_1^{+} Z_1) \\sigma_2^{+} = (-\\sigma_1^{+}) \\sigma_2^{+} = -\\sigma_1^{+} \\sigma_2^{+}$。\n$(c_1^\\dagger c_2^\\dagger) c_3^\\dagger = (-\\sigma_1^{+} \\sigma_2^{+}) (Z_1 Z_2 \\sigma_3^{+}) = -(\\sigma_1^{+} \\otimes \\sigma_2^{+} \\otimes I_3) (Z_1 \\otimes Z_2 \\otimes \\sigma_3^{+})$\n$= -(\\sigma_1^{+} Z_1) \\otimes (\\sigma_2^{+} Z_2) \\otimes (\\sigma_3^{+})$\n使用 $\\sigma_{p}^{+} Z_{p} = -\\sigma_{p}^{+}$，我们得到：\n$= -(-\\sigma_1^{+}) \\otimes (-\\sigma_2^{+}) \\otimes (\\sigma_3^{+}) = -\\sigma_1^{+} \\sigma_2^{+} \\sigma_3^{+}$。\n\n接下来，我们计算湮灭算符的乘积 $A_{\\text{op}} = c_3 c_2 c_1$：\n$c_2 c_1 = (Z_1 \\sigma_2^{-}) (\\sigma_1^{-}) = (Z_1 \\sigma_1^{-}) \\sigma_2^{-} = (-\\sigma_1^{-}) \\sigma_2^{-} = -\\sigma_1^{-} \\sigma_2^{-}$。\n$c_3 (c_2 c_1) = (Z_1 Z_2 \\sigma_3^{-}) (-\\sigma_1^{-} \\sigma_2^{-}) = -(Z_1 \\otimes Z_2 \\otimes \\sigma_3^{-}) (\\sigma_1^{-} \\otimes \\sigma_2^{-} \\otimes I_3)$\n$= -(Z_1 \\sigma_1^{-}) \\otimes (Z_2 \\sigma_2^{-}) \\otimes (\\sigma_3^{-})$\n使用 $Z_p \\sigma_{p}^{-} = -\\sigma_{p}^{-}$，我们得到：\n$= -(-\\sigma_1^{-}) \\otimes (-\\sigma_2^{-}) \\otimes (\\sigma_3^{-}) = -\\sigma_1^{-} \\sigma_2^{-} \\sigma_3^{-}$。\n\n现在我们将这些结果组合起来，构成哈密顿算符 $H_3 / g_3$：\n$H_3 / g_3 = C_{\\text{op}} A_{\\text{op}} = (c_1^\\dagger c_2^\\dagger c_3^\\dagger) (c_3 c_2 c_1)$\n$= (-\\sigma_1^{+} \\sigma_2^{+} \\sigma_3^{+}) (-\\sigma_1^{-} \\sigma_2^{-} \\sigma_3^{-})$\n$= (\\sigma_1^{+} \\sigma_2^{+} \\sigma_3^{+}) (\\sigma_1^{-} \\sigma_2^{-} \\sigma_3^{-})$\n由于不同量子比特上的算符互相对易，我们可以按量子比特索引将各项分组：\n$= (\\sigma_1^{+} \\sigma_1^{-}) \\otimes (\\sigma_2^{+} \\sigma_2^{-}) \\otimes (\\sigma_3^{+} \\sigma_3^{-})$。\n\n我们必须计算乘积 $\\sigma_p^{+} \\sigma_p^{-}$：\n$\\sigma_p^{+} \\sigma_p^{-} = \\frac{1}{4}(X_p + iY_p)(X_p - iY_p) = \\frac{1}{4}(X_p^2 - iX_pY_p + iY_pX_p + Y_p^2)$\n使用 $X_p^2=I_p$、$Y_p^2=I_p$、$X_pY_p=iZ_p$ 和 $Y_pX_p=-iZ_p$：\n$\\sigma_p^{+} \\sigma_p^{-} = \\frac{1}{4}(I_p - i(iZ_p) + i(-iZ_p) + I_p) = \\frac{1}{4}(I_p + Z_p + Z_p + I_p) = \\frac{1}{2}(I_p + Z_p)$。\n\n将此结果代回到 $H_3$ 的表达式中：\n$H_3 = g_3 \\left(\\frac{1}{2}(I_1 + Z_1)\\right) \\otimes \\left(\\frac{1}{2}(I_2 + Z_2)\\right) \\otimes \\left(\\frac{1}{2}(I_3 + Z_3)\\right)$\n$$H_3 = \\frac{g_3}{8} (I_1 + Z_1)(I_2 + Z_2)(I_3 + Z_3)$$\n\n为求出不同非平凡泡利串的数量，我们展开泡利算符的乘积，并忽略总体系数 $\\frac{g_3}{8}$。令 $I$ 表示作用于所有三个量子比特的单位算符。\n$(I + Z_1)(I + Z_2)(I + Z_3) = (I \\otimes I \\otimes I + Z_1 \\otimes I \\otimes I)(I \\otimes I \\otimes I + I \\otimes Z_2 \\otimes I)(I \\otimes I \\otimes I + I \\otimes I \\otimes Z_3)$\n展开前两个因子：\n$(I + Z_1 + Z_2 + Z_1Z_2)(I+Z_3)$\n完全展开：\n$= I + Z_3 + Z_1 + Z_1Z_3 + Z_2 + Z_2Z_3 + Z_1Z_2 + Z_1Z_2Z_3$\n\n得到的不同泡利串为：\n1. $I_1 \\otimes I_2 \\otimes I_3$ (单位算符)\n2. $Z_1 \\otimes I_2 \\otimes I_3$\n3. $I_1 \\otimes Z_2 \\otimes I_3$\n4. $I_1 \\otimes I_2 \\otimes Z_3$\n5. $Z_1 \\otimes Z_2 \\otimes I_3$\n6. $Z_1 \\otimes I_2 \\otimes Z_3$\n7. $I_1 \\otimes Z_2 \\otimes Z_3$\n8. $Z_1 \\otimes Z_2 \\otimes Z_3$\n\n总共有 $8$ 个不同的泡利串。“非平凡”串是指包含至少一个非单位算符的串。这排除了单位串 $I_1 \\otimes I_2 \\otimes I_3$。\n从上面的列表（第 $2$ 到第 $8$ 项）中数出非平凡串，我们发现有 $7$ 个这样的串。", "answer": "$$\n\\boxed{7}\n$$", "id": "3583685"}, {"introduction": "将算符映射到量子比特之后，我们需要为变分量子本征求解器 (VQE) 等算法准备完整的哈密顿量。这通常涉及到一个关键步骤：相对于一个参考态（如斯莱特行列式）来定义能量。本练习 [@problem_id:3583721] 演示了如何运用正常排序的概念来提取参考态的能量，该能量在哈密顿量中表现为一个常数项。掌握这一技能对于正确解读量子模拟结果和计算绝对核能至关重要。", "problem": "考虑一个由相同核子组成的相互作用体系，该体系处在一个有限的正交归一单粒子基中，并通过一个包含单体和双体部分的哈密顿量在二次量子化框架下进行描述。对于标记为 $p$ 和 $q$ 的单粒子轨道，其产生和湮灭算符分别表示为 $a_{p}^{\\dagger}$ 和 $a_{q}$，它们满足费米子反对易关系 $\\{a_{p},a_{q}^{\\dagger}\\}=\\delta_{pq}$ 和 $\\{a_{p},a_{q}\\}=\\{a_{p}^{\\dagger},a_{p}^{\\dagger}\\}=0$。该哈密顿量具有以下形式\n$$\nH \\;=\\; \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\;+\\; \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r},\n$$\n其中 $t_{pq}$ 是单体矩阵元，$\\langle pq \\Vert rs \\rangle$ 是反对称化的双体矩阵元。令 $\\lvert \\Phi \\rangle$ 为一个斯莱特行列式 (SD) 参考态，它是通过占据一组轨道 $\\{i\\}$ 构建的，其占据数为 $n_{p}=\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{p} \\rvert \\Phi \\rangle \\in \\{0,1\\}$。\n\n仅使用上述基本定义、关于参考态 $\\lvert \\Phi \\rangle$ 进行正规排序的 Wick 定理的规范形式，以及费米子算符的代数，推导关于 $\\lvert \\Phi \\rangle$ 的正规排序如何改变期望值 $\\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$。具体来说，从关于 $\\lvert \\Phi \\rangle$ 的收缩和正规乘积的定义出发，证明正规排序将 $H$ 分解为一个在 $\\lvert \\Phi \\rangle$ 中的期望值为零的正规排序算符，外加一个等于 $\\lvert \\Phi \\rangle$ 参考能量的常数“零体”项。\n\n然后将您的结果应用于以下简单的两能级配对模型，该模型在计算核物理以及核物理量子计算中量子比特哈密顿量的构建中被广泛使用。存在两个空间轨道，标记为 $a$ 和 $b$，每个轨道有两个自旋投影 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$，因此单粒子标记为 $p \\in \\{a\\uparrow,a\\downarrow,b\\uparrow,b\\downarrow\\}$。单体部分是对角的，有 $t_{pq}=\\varepsilon_{p}\\,\\delta_{pq}$，单粒子能量为 $\\varepsilon_{a\\uparrow}=\\varepsilon_{a\\downarrow}=\\varepsilon_{a}$ 和 $\\varepsilon_{b\\uparrow}=\\varepsilon_{b\\downarrow}=\\varepsilon_{b}$。唯一不为零的反对称化双体矩阵元是轨道 $a$ 内的 seniority-zero 配对相互作用，\n$$\n\\langle a\\uparrow \\, a\\downarrow \\Vert a\\uparrow \\, a\\downarrow \\rangle \\;=\\; -g,\n$$\n所有其他的 $\\langle pq \\Vert rs \\rangle$ 均为零。取 SD 参考态 $\\lvert \\Phi \\rangle$ 为轨道 $a$ 中被填充的粒子对，即 $n_{a\\uparrow}=n_{a\\downarrow}=1$ 且 $n_{b\\uparrow}=n_{b\\downarrow}=0$。使用您的一般推导来计算对 $H$ 关于 $\\lvert \\Phi \\rangle$ 进行正规排序所产生的常数（零体）项。\n\n对于数值计算，使用 $\\varepsilon_{a}=-3.75$ MeV, $\\varepsilon_{b}=-0.80$ MeV, 和 $g=0.64$ MeV，并注意只有被占据的轨道对零体项有贡献。以 MeV 为单位表示常数的最终结果，并将您的答案四舍五入到三位有效数字。最终答案仅陈述该常数项的值。角度单位在此不适用。您计算出的最终常数项等于通过任何费米子到量子比特的映射所获得的量子比特哈密顿量中的单位算符系数，并且在诸如量子相位估计等算法中，必须将其加回到测量的激发能上，以恢复 $\\lvert \\Phi \\rangle$ 的绝对能量。", "solution": "该问题要求我们首先推导当一个双体哈密顿量相对于一个斯莱特行列式参考态 $\\lvert \\Phi \\rangle$ 进行正规排序时出现的常数项，或称“零体”项的一般表达式。然后，我们必须将此一般结果应用于一个特定的两能级配对模型，并计算该常数的数值。\n\n根据广义 Wick 定理，任何算符都可以分解为其相对于参考态 $\\lvert \\Phi \\rangle$ 的正规排序部分与涉及收缩的项之和。一个算符的正规排序部分，我们记为 $\\{O\\}$，其定义性质是它在参考态中的期望值为零：$\\langle \\Phi \\lvert \\{O\\} \\rvert \\Phi \\rangle = 0$。一串产生和湮灭算符可以写成其正规乘积与所有可能的收缩项之和。一个算符的完全收缩部分是一个常数（一个 c-数），我们需要为哈密顿量 $H$ 找到这个常数。\n\n设哈密顿量为 $H$。其分解为 $H = \\{H\\} + C$，其中 $\\{H\\}$ 是哈密顿量的正规排序部分，而 $C$ 是完全收缩的常数项。取该方程关于 $\\lvert \\Phi \\rangle$ 的期望值，我们得到：\n$$\n\\langle \\Phi \\lvert H \\rvert \\Phi \\rangle = \\langle \\Phi \\lvert \\{H\\} \\rvert \\Phi \\rangle + \\langle \\Phi \\lvert C \\rvert \\Phi \\rangle\n$$\n由于 $\\langle \\Phi \\lvert \\{H\\} \\rvert \\Phi \\rangle = 0$ 且 $C$ 是一个常数，我们有 $C = \\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$。因此，由正规排序产生的常数“零体”项恰好是参考态的能量 $E_{\\Phi} = \\langle \\Phi \\lvert H \\rvert \\Phi \\rangle$。我们现在来推导 $E_{\\Phi}$ 的表达式。\n\n哈密顿量由 $H = H_1 + H_2$ 给出，其中：\n$$\nH_1 = \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\quad \\text{和} \\quad H_2 = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r}\n$$\n期望值是单体和双体部分期望值的和。设在斯莱特行列式 $\\lvert \\Phi \\rangle$ 中被占据的单粒子轨道集合表示为 $\\{i, j, k, \\dots\\}$。如果轨道 $p$ 在这个集合中，其占据数 $n_p=1$，否则 $n_p=0$。对于一个正交归一基，数算符的作用是 $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle = \\delta_{pq} n_p$。\n\n首先，我们计算单体部分 $E_1$ 的期望值：\n$$\nE_1 = \\langle \\Phi \\lvert H_1 \\rvert \\Phi \\rangle = \\left\\langle \\Phi \\left\\lvert \\sum_{pq} t_{pq}\\, a_{p}^{\\dagger} a_{q} \\right\\rvert \\Phi \\right\\rangle = \\sum_{pq} t_{pq} \\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle\n$$\n使用性质 $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q} \\rvert \\Phi \\rangle = \\delta_{pq} n_p$，我们得到：\n$$\nE_1 = \\sum_{pq} t_{pq} \\delta_{pq} n_p = \\sum_{p} t_{pp} n_p\n$$\n由于 $n_p$ 仅对被占据的轨道非零，求和被限制在被占据的轨道集合 $\\{i\\}$ 上：\n$$\nE_1 = \\sum_{i \\in \\text{occ}} t_{ii}\n$$\n\n接下来，我们计算双体部分 $E_2$ 的期望值：\n$$\nE_2 = \\langle \\Phi \\lvert H_2 \\rvert \\Phi \\rangle = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle\\, \\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle\n$$\n期望值 $\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle$ 仅当轨道 $r$ 和 $s$ 在 $\\lvert \\Phi \\rangle$ 中被占据，且轨道集合 $\\{p,q\\}$ 与集合 $\\{r,s\\}$ 相同时才非零。对于一个斯莱特行列式，该期望值由下式给出：\n$$\n\\langle \\Phi \\lvert a_{p}^{\\dagger} a_{q}^{\\dagger} a_{s} a_{r} \\rvert \\Phi \\rangle = (\\delta_{pr}\\delta_{qs} - \\delta_{ps}\\delta_{qr}) n_r n_s\n$$\n将此代入 $E_2$ 的表达式中：\n$$\nE_2 = \\frac{1}{4}\\sum_{pqrs} \\langle pq \\Vert rs \\rangle (\\delta_{pr}\\delta_{qs} - \\delta_{ps}\\delta_{qr}) n_r n_s\n$$\n我们可以对 $p$ 和 $q$ 进行求和：\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s \\left( \\sum_{pq} \\langle pq \\Vert rs \\rangle \\delta_{pr}\\delta_{qs} - \\sum_{pq} \\langle pq \\Vert rs \\rangle \\delta_{ps}\\delta_{qr} \\right)\n$$\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s \\left( \\langle rs \\Vert rs \\rangle - \\langle sr \\Vert rs \\rangle \\right)\n$$\n反对称化矩阵元具有性质 $\\langle sr \\Vert rs \\rangle = -\\langle rs \\Vert sr \\rangle$。然而，一个更直接的方法是使用定义 $\\langle ab \\Vert cd \\rangle = \\langle ab|V|cd \\rangle - \\langle ab|V|dc \\rangle$。设 $V_{abcd} = \\langle ab|V|cd \\rangle$。\n$$\n\\langle rs \\Vert rs \\rangle = V_{rs,rs} - V_{rs,sr}\n$$\n$$\n\\langle sr \\Vert rs \\rangle = V_{sr,rs} - V_{sr,sr}\n$$\n假设矩阵元为实数（在此上下文中为标准做法），$V_{sr,rs} = V_{rs,sr}$ 且 $V_{sr,sr}=V_{rs,rs}$。\n$$\nE_2 = \\frac{1}{4}\\sum_{rs} n_r n_s \\left[ (V_{rs,rs} - V_{rs,sr}) - (V_{sr,rs} - V_{sr,sr}) \\right] = \\frac{1}{4}\\sum_{rs} n_r n_s \\left[ (V_{rs,rs} - V_{rs,sr}) - (V_{rs,sr} - V_{rs,rs}) \\right]\n$$\n$$\nE_2 = \\frac{1}{2}\\sum_{rs} n_r n_s (V_{rs,rs} - V_{rs,sr}) = \\frac{1}{2}\\sum_{rs} n_r n_s \\langle rs \\Vert rs \\rangle\n$$\n求和遍及所有态，但因子 $n_r n_s$ 将其限制在被占据的轨道 $\\{i, j\\}$ 上：\n$$\nE_2 = \\frac{1}{2}\\sum_{i,j \\in \\text{occ}} \\langle ij \\Vert ij \\rangle\n$$\n结合单体和双体部分，总的常数项（参考能量）为：\n$$\nE_{\\Phi} = \\sum_{i \\in \\text{occ}} t_{ii} + \\frac{1}{2}\\sum_{i,j \\in \\text{occ}} \\langle ij \\Vert ij \\rangle\n$$\n\n现在，我们将此通用公式应用于指定的两能级配对模型。\n单粒子态为 $p \\in \\{a\\uparrow, a\\downarrow, b\\uparrow, b\\downarrow\\}$。\n参考态 $\\lvert \\Phi \\rangle$ 中轨道 $a$ 的粒子对被填满。因此，被占据的态为 $\\{ a\\uparrow, a\\downarrow \\}$。占据数为 $n_{a\\uparrow}=1$，$n_{a\\downarrow}=1$，以及 $n_{b\\uparrow}=n_{b\\downarrow}=0$。\n\n单体贡献使用 $t_{pq} = \\varepsilon_p \\delta_{pq}$ 计算，这意味着 $t_{pp} = \\varepsilon_p$。\n$$\nE_1 = \\sum_{i \\in \\text{occ}} t_{ii} = t_{a\\uparrow, a\\uparrow} + t_{a\\downarrow, a\\downarrow} = \\varepsilon_{a\\uparrow} + \\varepsilon_{a\\downarrow}\n$$\n给定 $\\varepsilon_{a\\uparrow} = \\varepsilon_{a\\downarrow} = \\varepsilon_a$，我们有：\n$$\nE_1 = \\varepsilon_a + \\varepsilon_a = 2\\varepsilon_a\n$$\n\n双体贡献为：\n$$\nE_2 = \\frac{1}{2}\\sum_{i,j \\in \\{a\\uparrow, a\\downarrow\\}} \\langle ij \\Vert ij \\rangle\n$$\n这个和展开为四项：\n$$\nE_2 = \\frac{1}{2} \\left( \\langle a\\uparrow a\\uparrow \\Vert a\\uparrow a\\uparrow \\rangle + \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle + \\langle a\\downarrow a\\uparrow \\Vert a\\downarrow a\\uparrow \\rangle + \\langle a\\downarrow a\\downarrow \\Vert a\\downarrow a\\downarrow \\rangle \\right)\n$$\n根据泡利不相容原理，两个相同费米子在初态和末态的反对称化矩阵元为零：$\\langle pp \\Vert pp \\rangle = 0$。因此，第一项和最后一项为零。\n对于剩下的项，我们使用对称性质 $\\langle pq \\Vert pq \\rangle = \\langle qp \\Vert qp \\rangle$。\n$$\n\\langle a\\downarrow a\\uparrow \\Vert a\\downarrow a\\uparrow \\rangle = \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle\n$$\n所以 $E_2$ 的表达式简化为：\n$$\nE_2 = \\frac{1}{2} \\left( \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle + \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle \\right) = \\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle\n$$\n问题陈述唯一不为零的双体矩阵元是 $\\langle a\\uparrow a\\downarrow \\Vert a\\uparrow a\\downarrow \\rangle = -g$。\n因此，$E_2 = -g$。\n\n总的常数项是单体和双体贡献之和：\n$$\nE_{\\Phi} = E_1 + E_2 = 2\\varepsilon_a - g\n$$\n我们被给予数值 $\\varepsilon_{a}=-3.75$ MeV 和 $g=0.64$ MeV。\n代入这些值：\n$$\nE_{\\Phi} = 2(-3.75) - 0.64 = -7.50 - 0.64 = -8.14 \\, \\text{MeV}\n$$\n问题要求结果四舍五入到三位有效数字。数值 $-8.14$ 有三位有效数字。\n常数“零体”项是 $-8.14$ MeV。", "answer": "$$\n\\boxed{-8.14}\n$$", "id": "3583721"}, {"introduction": "当前的量子设备存在噪声，因此量子纠错是获得有意义结果的一套关键技术。本练习 [@problem_id:3583676] 深入探讨了一种特别适用于物理模拟的强大方法：利用系统的已知对称性（如粒子数和宇称）来识别和过滤错误。通过模拟将噪声态投影回正确对称性子空间的过程，我们可以获得关于如何提高量子计算保真度的实用见解。", "problem": "要求您设计并实现一个完整的程序，该程序模拟一个编码在量子比特上的简化核多体寄存器的基于对称性的误差缓解。其背景是通过粒子数和宇称进行对称性投影，这是计算核物理和原子核量子计算中广泛使用的策略。您必须从第一性原理推导量值，并针对一组指定的测试用例进行数值计算。\n\n模型与定义：\n- 考虑一个维度为 $2^L$ 的希尔伯特空间，它表示通过占据数基映射到量子比特的 $L$ 个无自旋单粒子轨道。一个基态由比特串 $\\mathbf{b}=(b_0,b_1,\\dots,b_{L-1})$ 标记，其中 $b_i \\in \\{0,1\\}$，对应于轨道 $i$ 的占据情况。$\\mathbf{b}$ 的整数索引为 $n=\\sum_{i=0}^{L-1} b_i 2^i$。\n- 粒子数算符为 $\\hat{N}=\\sum_{i=0}^{L-1} \\hat{n}_i$，其中 $\\hat{n}_i$ 是轨道 $i$ 上的数算符，在计算基下是对角的，本征值为 $b_i$。对于一个基态 $\\mathbf{b}$，有 $\\hat{N}\\ket{\\mathbf{b}}=\\left(\\sum_{i=0}^{L-1} b_i\\right)\\ket{\\mathbf{b}}$。\n- 为每个单粒子轨道 $i$ 分配一个内禀宇称 $p_i \\in \\{+1,-1\\}$。一个基态 $\\mathbf{b}$ 上的多体宇称本征值为 $\\Pi(\\mathbf{b})=\\prod_{i=0}^{L-1} p_i^{b_i} \\in \\{+1,-1\\}$。定义宇称算符 $\\hat{P}$ 在计算基下是对角的，本征值为 $\\Pi(\\mathbf{b})$。\n- 对于固定的粒子数 $A$ 和宇称 $\\pi \\in \\{+1,-1\\}$，定义对称性子空间投影算符 $\\hat{P}_{A,\\pi}=\\sum_{\\mathbf{b}:\\,\\sum_i b_i=A,\\,\\Pi(\\mathbf{b})=\\pi} \\ket{\\mathbf{b}}\\bra{\\mathbf{b}}$。\n- 目标纯态是在 $(A,\\pi)$ 子空间内的等幅叠加：如果该子空间中有 $K$ 个基态，则 $\\ket{\\psi}=\\frac{1}{\\sqrt{K}}\\sum_{\\mathbf{b} \\in \\mathcal{S}_{A,\\pi}} \\ket{\\mathbf{b}}$，其中 $\\mathcal{S}_{A,\\pi}=\\{\\mathbf{b}\\,|\\,\\sum_i b_i=A,\\,\\Pi(\\mathbf{b})=\\pi\\}$。如果 $K=0$，则此目标未定义。\n- 通过权重为 $\\varepsilon \\in [0,1]$ 的全局去极化信道在整个空间上对噪声建模：含噪态为密度算符 $\\rho=(1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\varepsilon \\frac{\\mathbb{I}}{2^L}$，其中 $\\mathbb{I}$ 是维度为 $2^L$ 上的单位算符。\n- 基于对称性的后选择误差缓解通过将 $\\rho$ 投影到 $(A,\\pi)$ 子空间并重新归一化来建模：$\\rho'=\\frac{\\hat{P}_{A,\\pi}\\,\\rho\\,\\hat{P}_{A,\\pi}}{\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\,\\rho)}$。后选择的接受概率为 $p_{\\mathrm{acc}}=\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\,\\rho)$。\n- 定义两个可观测量：(i) 对易可观测量 $\\hat{O}_{\\mathrm{comm}}=\\hat{N}$，和 (ii) 一个非对易可观测量 $\\hat{O}_{\\mathrm{nonc}}=\\hat{X}_0$，即作用在量子比特 $0$ 上的泡利 $X$ 算符与计算基中所有其他量子比特上的单位算符的张量积。\n\n每个测试用例所需的计算：\n- 计算未缓解的保真度 $F_{\\mathrm{un}}=\\bra{\\psi}\\rho\\ket{\\psi}$。\n- 计算缓解后的保真度 $F_{\\mathrm{mit}}=\\bra{\\psi}\\rho'\\ket{\\psi}$，前提是分母非零。\n- 计算保真度提升 $\\Delta F=F_{\\mathrm{mit}}-F_{\\mathrm{un}}$。\n- 计算接受概率 $p_{\\mathrm{acc}}$。\n- 计算每个可观测量的残余偏差，即缓解后的含噪期望值与精确目标态期望值之间的带符号差值：\n  - $b_{\\mathrm{comm}}=\\mathrm{Tr}(\\rho'\\hat{O}_{\\mathrm{comm}})-\\bra{\\psi}\\hat{O}_{\\mathrm{comm}}\\ket{\\psi}$，\n  - $b_{\\mathrm{nonc}}=\\mathrm{Tr}(\\rho'\\hat{O}_{\\mathrm{nonc}})-\\bra{\\psi}\\hat{O}_{\\mathrm{nonc}}\\ket{\\psi}$。\n- 如果 $(A,\\pi)$ 子空间为空 ($K=0$)，则 $\\ket{\\psi}$ 未定义；在这种情况下，将 $F_{\\mathrm{un}}$、$F_{\\mathrm{mit}}$、$\\Delta F$、$b_{\\mathrm{comm}}$ 和 $b_{\\mathrm{nonc}}$ 定义为 $\\mathrm{nan}$，并计算 $p_{\\mathrm{acc}}=\\mathrm{Tr}\\left(\\hat{P}_{A,\\pi}\\,\\frac{\\mathbb{I}}{2^L}\\right)=\\frac{\\mathrm{Tr}(\\hat{P}_{A,\\pi})}{2^L}$。\n\n您在推导和设计中必须使用的基本出发点：\n- 量子态和混合态表示为希尔伯特空间上的密度算符 $\\rho$，期望值为 $\\langle \\hat{O} \\rangle=\\mathrm{Tr}(\\rho \\hat{O})$。\n- 投影算符 $\\hat{P}$ 满足 $\\hat{P}^2=\\hat{P}=\\hat{P}^\\dagger$，并实现理想的子空间后选择，通过玻恩法则概率 $\\mathrm{Tr}(\\hat{P}\\rho)$ 进行归一化。\n- 对于纯参考态 $\\ket{\\psi}$ 的保真度为 $F=\\bra{\\psi}\\rho\\ket{\\psi}$。\n\n数值和算法约束：\n- 所有计算都应使用双精度浮点运算进行有限维复向量空间上的精确线性代数运算。\n- 不会出现角度；对角度单位没有要求。\n- 所有输出均为无量纲实数。\n\n测试套件：\n实现您的程序以处理以下 $4$ 个测试用例。每个用例指定了 $(L,\\mathbf{p},A,\\pi,\\varepsilon)$，其中 $\\mathbf{p}=[p_0,p_1,\\dots,p_{L-1}]$。\n- 用例 1：$L=6$, $\\mathbf{p}=[+1,-1,+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=0.1$。\n- 用例 2：$L=5$, $\\mathbf{p}=[+1,+1,-1,-1,+1]$, $A=3$, $\\pi=-1$, $\\varepsilon=0.6$。\n- 用例 3：$L=4$, $\\mathbf{p}=[+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=0.0$。\n- 用例 4：$L=4$, $\\mathbf{p}=[+1,-1,+1,-1]$, $A=2$, $\\pi=+1$, $\\varepsilon=1.0$。\n\n最终输出规格：\n- 对于每个测试用例，您的程序必须按以下确切顺序生成一个包含六个浮点数的列表：$[F_{\\mathrm{un}},F_{\\mathrm{mit}},\\Delta F,p_{\\mathrm{acc}},b_{\\mathrm{comm}},b_{\\mathrm{nonc}}]$。\n- 将所有测试用例的结果按给定的测试用例顺序汇总到一个单行的列表的列表中。\n- 将每个数值条目四舍五入到恰好 $6$ 位小数。如果一个值如上文所述未定义，则打印 $\\mathrm{nan}$。\n- 您的程序应生成一行输出，其中包含此聚合格式的结果，例如 $[[r_{1,1},r_{1,2},r_{1,3},r_{1,4},r_{1,5},r_{1,6}],[r_{2,1},\\dots],[r_{3,1},\\dots],[r_{4,1},\\dots]]$，其中每个 $r_{i,j}$ 是一个保留 $6$ 位小数的浮点数或 $\\mathrm{nan}$。", "solution": "用户请求一个程序来模拟量子寄存器的基于对称性的误差缓解，重点是在提供解决方案之前验证问题陈述。\n\n### 第 1 步：问题验证\n\n问题陈述已根据指定标准进行了彻底分析。\n\n-   **已知条件提取**：所有定义、常量和所需计算都已逐字提取。这些包括希尔伯特空间结构、粒子数（$\\hat{N}$）和宇称（$\\hat{P}$）算符的定义、目标态（$\\ket{\\psi}$）、全局去极化噪声模型（$\\rho$）、误差缓解过程（$\\rho'$）、可观测量（$\\hat{O}_{\\mathrm{comm}}$、$\\hat{O}_{\\mathrm{nonc}}$）以及需要计算的特定量值（$F_{\\mathrm{un}}, F_{\\mathrm{mit}}, \\Delta F, p_{\\mathrm{acc}}, b_{\\mathrm{comm}}, b_{\\mathrm{nonc}}$）。还明确定义了目标子空间为空（$K=0$）的特殊情况的处理方式。\n-   **验证检查**：\n    -   **科学依据**：该问题在量子力学、量子信息论和计算核物理的原理中有充分的依据。占据数基、基本对称性（粒子数、宇称）、投影算符、密度算符和噪声信道等概念都是标准的。\n    -   **良定性**：该问题是自洽的，并为每个测试用例提供了所有必要的信息（$L, \\mathbf{p}, A, \\pi, \\varepsilon$）。所需的输出有明确的定义，计算路径清晰。每个案例都存在唯一、稳定的解。\n    -   **客观性**：语言正式、精确，没有主观论断。\n\n-   **结论**：该问题是 **有效的**。它是一个定义明确的计算物理任务，科学上合理、客观且内部一致。\n\n### 第 2 步：量值推导\n\n设 $L$ 为轨道数，$D = 2^L$ 为希尔伯特空间的维度，$A$ 为目标粒子数，$\\pi$ 为目标宇称。噪声参数为 $\\varepsilon$。\n\n1.  **对称性子空间**：首先，我们必须确定满足对称性约束的计算基态集合 $\\mathcal{S}_{A,\\pi}$：如果一个态 $\\ket{\\mathbf{b}}$ 的粒子数 $\\sum_i b_i = A$ 且其宇称 $\\prod_i p_i^{b_i} = \\pi$，则该态位于此子空间中。该子空间的维度为 $K = |\\mathcal{S}_{A,\\pi}|$。如果 $K=0$，则子空间为空。\n\n2.  **情况 $K=0$**：根据问题定义，如果子空间为空，则目标态未定义。输出为：$F_{\\mathrm{un}}=\\mathrm{nan}$，$F_{\\mathrm{mit}}=\\mathrm{nan}$，$\\Delta F=\\mathrm{nan}$，$b_{\\mathrm{comm}}=\\mathrm{nan}$，$b_{\\mathrm{nonc}}=\\mathrm{nan}$。投影算符 $\\hat{P}_{A,\\pi}$ 是零算符，因此其迹为 $0$。接受概率为 $p_{\\mathrm{acc}} = \\mathrm{Tr}(\\hat{P}_{A,\\pi}) / D = 0/D = 0$。\n\n3.  **情况 $K>0$**：\n    -   **未缓解保真度 ($F_{\\mathrm{un}}$)**：含噪态 $\\rho = (1-\\varepsilon)\\ket{\\psi}\\bra{\\psi}+\\varepsilon \\frac{\\mathbb{I}}{D}$ 与纯目标态 $\\ket{\\psi}$ 的保真度为：\n        $$F_{\\mathrm{un}} = \\bra{\\psi}\\rho\\ket{\\psi} = (1-\\varepsilon)\\braket{\\psi|\\psi}^2 + \\frac{\\varepsilon}{D}\\braket{\\psi|\\psi} = 1 - \\varepsilon + \\frac{\\varepsilon}{D} = 1 - \\varepsilon\\left(1 - \\frac{1}{D}\\right)$$\n    -   **接受概率 ($p_{\\mathrm{acc}}$)**：这是归一化前投影含噪态的迹。\n        $$p_{\\mathrm{acc}} = \\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho) = (1-\\varepsilon)\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\ket{\\psi}\\bra{\\psi}) + \\frac{\\varepsilon}{D}\\mathrm{Tr}(\\hat{P}_{A,\\pi})$$\n        由于 $\\ket{\\psi}$ 完全位于该子空间内，$\\hat{P}_{A,\\pi}\\ket{\\psi}=\\ket{\\psi}$，这得出 $\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\ket{\\psi}\\bra{\\psi}) = \\braket{\\psi|\\hat{P}_{A,\\pi}|\\psi}=1$。此外，$\\mathrm{Tr}(\\hat{P}_{A,\\pi})=K$。\n        $$p_{\\mathrm{acc}} = (1-\\varepsilon) + \\frac{\\varepsilon K}{D} = 1 - \\varepsilon\\left(1 - \\frac{K}{D}\\right)$$\n    -   **缓解后保真度 ($F_{\\mathrm{mit}}$)**：缓解后的态为 $\\rho' = \\frac{\\hat{P}_{A,\\pi}\\rho \\hat{P}_{A,\\pi}}{p_{\\mathrm{acc}}}$。保真度为 $F_{\\mathrm{mit}}=\\bra{\\psi}\\rho'\\ket{\\psi}$。\n        $$\\bra{\\psi}\\hat{P}_{A,\\pi}\\rho \\hat{P}_{A,\\pi}\\ket{\\psi} = \\bra{\\psi}\\rho\\ket{\\psi} = F_{\\mathrm{un}}$$\n        因此，\n        $$F_{\\mathrm{mit}} = \\frac{F_{\\mathrm{un}}}{p_{\\mathrm{acc}}}$$\n    -   **保真度提升 ($\\Delta F$)**：这只是两者之差：\n        $$\\Delta F = F_{\\mathrm{mit}} - F_{\\mathrm{un}}$$\n    -   **残余偏差 ($b_{\\mathrm{comm}}$，对于 $\\hat{O}_{\\mathrm{comm}}=\\hat{N}$)**：偏差为 $b_{\\mathrm{comm}}=\\mathrm{Tr}(\\rho'\\hat{N})-\\bra{\\psi}\\hat{N}\\ket{\\psi}$。\n        目标态 $\\ket{\\psi}$ 是所有粒子数均为 $A$ 的态的叠加，因此 $\\hat{N}\\ket{\\psi}=A\\ket{\\psi}$。这给出了精确期望值 $\\bra{\\psi}\\hat{N}\\ket{\\psi}=A$。\n        缓解后的期望值为 $\\mathrm{Tr}(\\rho'\\hat{N}) = \\frac{1}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\ \\hat{P}_{A,\\pi}\\rho \\hat{P}_{A,\\pi} \\hat{N})$。\n        由于 $\\hat{N}$ 与 $\\hat{P}_{A,\\pi}$ 对易（因为 $\\hat{P}_{A,\\pi}$ 投影到 $\\hat{N}$ 的一个本征空间上），$\\hat{P}_{A,\\pi}\\hat{N} = A\\hat{P}_{A,\\pi}$。迹变为 $\\frac{A}{p_{\\mathrm{acc}}}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho\\hat{P}_{A,\\pi}) = \\frac{A}{p_{\\mathrm{acc}}} \\mathrm{Tr}(\\hat{P}_{A,\\pi}\\rho) = \\frac{A}{p_{\\mathrm{acc}}}p_{\\mathrm{acc}} = A$。\n        因此，偏差为 $b_{\\mathrm{comm}} = A - A = 0$。\n    -   **残余偏差 ($b_{\\mathrm{nonc}}$，对于 $\\hat{O}_{\\mathrm{nonc}}=\\hat{X}_0$)**：偏差为 $b_{\\mathrm{nonc}}=\\mathrm{Tr}(\\rho'\\hat{X}_0)-\\bra{\\psi}\\hat{X}_0\\ket{\\psi}$。\n        算符 $\\hat{X}_0$ 作用于量子比特 0 并翻转其状态。这会改变第零个轨道的占据数 $b_0$，从而使总粒子数 $\\sum_i b_i$ 改变 $\\pm 1$。\n        精确期望值为 $\\bra{\\psi}\\hat{X}_0\\ket{\\psi}$。由于 $\\ket{\\psi}$ 是粒子数为 $A$ 的态的叠加，态 $\\hat{X}_0\\ket{\\psi}$ 是粒子数为 $A\\pm 1$ 的态的叠加。这两个空间是正交的，因此它们的内积为零：\n        $$\\bra{\\psi}\\hat{X}_0\\ket{\\psi} = 0$$\n        缓解后的期望值为 $\\mathrm{Tr}(\\rho'\\hat{X}_0) = \\frac{1}{p_{\\mathrm{acc}}}\\left((1-\\varepsilon)\\bra{\\psi}\\hat{X}_0\\ket{\\psi} + \\frac{\\varepsilon}{D}\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\hat{X}_0\\hat{P}_{A,\\pi})\\right)$。\n        项 $\\mathrm{Tr}(\\hat{P}_{A,\\pi}\\hat{X}_0)$ 为零，因为 $\\hat{P}_{A,\\pi}$ 在计算基下是对角的，而 $\\hat{X}_0$ 是纯非对角的。因此可以得出 $\\mathrm{Tr}(\\rho'\\hat{X}_0)=0$。\n        因此，偏差为 $b_{\\mathrm{nonc}} = 0 - 0 = 0$。\n\n### 第 3 步：算法实现\n\n该算法包含一个主函数，它遍历所有测试用例。对于每个用例，一个辅助函数首先通过检查 $2^L$ 个基态中的每一个是否满足粒子数和宇称标准，来确定对称性约束子空间 $\\mathcal{S}_{A,\\pi}$ 的维度 $K$。如果 $K=0$，它返回指定的 `nan`/`0` 值。如果 $K>0$，它应用上面推导的解析公式来计算所需的六个量值。结果被收集并按规定格式化为单个字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print\n    the final formatted output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: L=6, p=[+1,-1,+1,-1,+1,-1], A=2, pi=+1, epsilon=0.1\n        {'L': 6, 'p': [1, -1, 1, -1, 1, -1], 'A': 2, 'pi': 1, 'epsilon': 0.1},\n        # Case 2: L=5, p=[+1,+1,-1,-1,+1], A=3, pi=-1, epsilon=0.6\n        {'L': 5, 'p': [1, 1, -1, -1, 1], 'A': 3, 'pi': -1, 'epsilon': 0.6},\n        # Case 3: L=4, p=[+1,-1,+1,-1], A=2, pi=+1, epsilon=0.0\n        {'L': 4, 'p': [1, -1, 1, -1], 'A': 2, 'pi': 1, 'epsilon': 0.0},\n        # Case 4: L=4, p=[+1,-1,+1,-1], A=2, pi=+1, epsilon=1.0\n        {'L': 4, 'p': [1, -1, 1, -1], 'A': 2, 'pi': 1, 'epsilon': 1.0},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = compute_quantities(\n            case['L'], case['p'], case['A'], case['pi'], case['epsilon']\n        )\n        all_results.append(result)\n\n    # Format the final output string as a single line list of lists.\n    list_of_lists_str = []\n    for result_list in all_results:\n        # Format each value to 6 decimal places or 'nan'.\n        str_list = [f\"{v:.6f}\" if not np.isnan(v) else \"nan\" for v in result_list]\n        list_of_lists_str.append(f\"[{','.join(str_list)}]\")\n    \n    final_output = f\"[{','.join(list_of_lists_str)}]\"\n    print(final_output)\n\ndef compute_quantities(L, p_vec, A_target, pi_target, epsilon):\n    \"\"\"\n    Computes the six required quantities for a single test case.\n\n    Args:\n        L (int): Number of orbitals (qubits).\n        p_vec (list): List of intrinsic parities for each orbital.\n        A_target (int): Target particle number.\n        pi_target (int): Target many-body parity.\n        epsilon (float): Global depolarizing noise parameter.\n\n    Returns:\n        list: A list of 6 floats containing [F_un, F_mit, Delta_F, p_acc, b_comm, b_nonc].\n    \"\"\"\n    dim = 2**L\n    \n    # Identify the symmetry subspace and find its dimension K\n    K = 0\n    for n in range(dim):\n        # For each state represented by integer n, calculate its properties.\n        # The bit b_i corresponds to orbital i, where n = sum(b_i * 2^i).\n        \n        particle_num = 0\n        parity = 1\n        for i in range(L):\n            if (n >> i)  1:  # Check if i-th bit of n is 1 (i.e., b_i=1)\n                particle_num += 1\n                parity *= p_vec[i]\n                \n        if particle_num == A_target and parity == pi_target:\n            K += 1\n            \n    # Handle the case where the subspace is empty (K=0)\n    if K == 0:\n        p_acc = 0.0\n        return [np.nan, np.nan, np.nan, p_acc, np.nan, np.nan]\n\n    # For K > 0, compute quantities using derived analytical formulas\n    F_un = 1.0 - epsilon * (1.0 - 1.0 / dim)\n    p_acc = 1.0 - epsilon * (1.0 - K / dim)\n    \n    # p_acc should not be zero for K>0 and epsilon in [0,1], but as a safeguard.\n    F_mit = F_un / p_acc if p_acc != 0 else np.nan\n    Delta_F = F_mit - F_un if p_acc != 0 else np.nan\n\n    # Residual biases are zero based on symmetry arguments in the derivation.\n    b_comm = 0.0\n    b_nonc = 0.0\n    \n    return [F_un, F_mit, Delta_F, p_acc, b_comm, b_nonc]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3583676"}]}