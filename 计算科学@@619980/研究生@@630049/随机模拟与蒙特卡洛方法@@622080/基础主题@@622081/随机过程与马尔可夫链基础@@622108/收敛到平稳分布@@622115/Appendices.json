{"hands_on_practices": [{"introduction": "PageRank算法为马尔可夫链收敛提供了一个引人注目的现实世界应用，其中网页的重要性由一个大规模随机游走的平稳分布确定。本练习 [@problem_id:3300074] 提供了一个动手实践的机会，让您实现用于计算这些排名的核心幂迭代方法。通过模拟该过程，您将获得关于“瞬移”概率 $\\alpha$ 和图结构等因素如何影响向平稳分布收敛速度的实践洞察。", "problem": "将谷歌网页排名（Google PageRank）公式视为有限有向图上带有“瞬移”（teleportation）的马尔可夫链的平稳分布。设 $n \\in \\mathbb{N}$ 表示节点数，设 $W \\in \\{0,1\\}^{n \\times n}$ 为邻接矩阵，按列定义如下：若存在从节点 $j$ 到节点 $i$ 的有向边，则 $W_{ij} = 1$；否则 $W_{ij} = 0$。将瞬移分布 $v \\in \\mathbb{R}^n$ 定义为均匀概率向量，即对于所有 $i \\in \\{1,\\dots,n\\}$，$v_i = 1/n$。通过对 $W$ 的每一列进行归一化来定义列随机矩阵 $S \\in \\mathbb{R}^{n \\times n}$；如果第 $j$ 列的和为零（即“悬挂节点”），则设 $S_{\\cdot j} = v$。对于瞬移概率 $\\alpha \\in [0,1)$，考虑 PageRank 迭代\n$$\nx_{k+1} \\;=\\; \\alpha S x_k \\;+\\; (1 - \\alpha)\\, v,\\quad k = 0,1,2,\\dots,\n$$\n初始分布为 $x_0 = v$。平稳分布 $x^\\star \\in \\mathbb{R}^n$ 是以下方程组的唯一解\n$$\nx^\\star \\;=\\; \\alpha S x^\\star \\;+\\; (1-\\alpha)\\, v, \\qquad x^\\star \\ge 0, \\;\\; \\sum_{i=1}^n x^\\star_i = 1,\n$$\n等价地，\n$$\n(I - \\alpha S)\\, x^\\star \\;=\\; (1-\\alpha)\\, v.\n$$\n使用全变差距离 $d_{\\mathrm{TV}}(p,q) = \\tfrac{1}{2}\\,\\lVert p - q\\rVert_1$ 来量化收敛性。目标是使用幂迭代法模拟向 $x^\\star$ 的收敛过程，并量化收敛速度如何依赖于 $\\alpha$ 和悬挂节点的存在。\n\n从以下基本事实出发：(i) 根据构造，$S$ 是列随机的；(ii) 对于任何 $\\alpha \\in [0,1)$，$x^\\star$ 存在且唯一；(iii) 迭代是线性的。设计并实现一个程序，对下述每个测试用例执行以下任务：\n1. 根据上述定义，从 $W$ 和 $v$ 构建 $S$。\n2. 通过求解 $(I - \\alpha S)\\,x^\\star = (1-\\alpha) v$ 并归一化为概率向量，计算精确的平稳分布 $x^\\star$。\n3. 运行幂迭代 $x_{k+1} = \\alpha S x_k + (1 - \\alpha) v$，初始值为 $x_0 = v$，直到满足停止准则 $d_{\\mathrm{TV}}(x_k, x^\\star) \\le \\varepsilon$，或达到最大迭代次数 $K_{\\max} = 100000$。所有用例均使用 $\\varepsilon = 10^{-10}$。\n4. 记录 $K$，即首次满足停止准则时执行的迭代次数（如果初始的 $x_0$ 已满足准则，则 $K=0$）。如果在 $K_{\\max}$ 次迭代内未满足停止准则，则设 $K=K_{\\max}$。\n5. 从 $\\ell_1$ 误差序列 $e_k = \\lVert x_k - x^\\star \\rVert_1$ 中估计经验线性收敛率 $r_{\\mathrm{hat}}$，方法是计算运行过程中 $k \\ge 1$ 的比率 $e_k/e_{k-1}$，并报告最后 $\\min\\{50, \\text{比率数量}\\}$ 个比率的中位数。如果可用迭代次数少于两次，则设 $r_{\\mathrm{hat}}=0.0$。这个 $r_{\\mathrm{hat}}$ 近似了零和子空间上的渐近收缩因子，并反映了对 $\\alpha$ 和悬挂节点的敏感性。\n\n您必须为以下测试套件中的图和参数实现上述过程。每个图都由其邻接矩阵 $W$（遵循上述基于列的约定）指定，每个测试用例都使用均匀分布的 $v$ 和 $\\varepsilon = 10^{-10}$：\n\n- 测试用例 1（无悬挂节点，中等瞬移概率）：$n=4$，$\\alpha=0.85$，\n$$\nW = \\begin{bmatrix}\n0  0  0  1 \\\\\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0\n\\end{bmatrix}.\n$$\n- 测试用例 2（无悬挂节点，慢混合）：$n=4$，$\\alpha=0.99$，与测试用例 1 中的 $W$ 相同。\n- 测试用例 3（一个悬挂节点，中等瞬移概率）：$n=3$，$\\alpha=0.85$，\n$$\nW = \\begin{bmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  0\n\\end{bmatrix}.\n$$\n- 测试用例 4（一个悬挂节点，慢混合）：$n=3$，$\\alpha=0.99$，与测试用例 3 中的 $W$ 相同。\n- 测试用例 5（无可约图无悬挂节点，中等瞬移概率）：$n=4$，$\\alpha=0.90$，\n$$\nW = \\begin{bmatrix}\n0  1  0  0 \\\\\n1  0  0  0 \\\\\n0  0  0  1 \\\\\n0  0  1  0\n\\end{bmatrix}.\n$$\n- 测试用例 6（瞬移占主导）：$n=4$，$\\alpha=0.00$，与测试用例 1 中的 $W$ 相同。\n\n您的程序必须生成单行输出，其中包含六个测试用例的结果，形式为方括号括起来的逗号分隔列表。每个测试用例的结果必须是 $[K, r_{\\mathrm{hat}}]$ 顺序的双元素列表。因此，输出格式必须严格为\n\"[ [K1,rhat1],[K2,rhat2],[K3,rhat3],[K4,rhat4],[K5,rhat5],[K6,rhat6] ]\"\n除了所示空格外，不要求其他空格，浮点数以十进制或科学记数法表示。不涉及物理单位或角度，输出中也不出现百分比。所有计算均为纯数值且无量纲。", "solution": "问题陈述已经过严格验证，被认为是可靠的。它在科学上基于马尔可夫链理论和数值线性代数，特别是 PageRank 算法。该问题是适定的（well-posed），提供了所有必要的数据、定义和约束，以确保一个唯一、稳定且有意义的解。目标明确，并以精确的数学语言表达。因此，我们可以着手求解。\n\n该问题要求为一组指定的图和参数实现并分析 PageRank 算法。对于每个测试用例，解决方案涉及五个主要任务：\n1. 构建谷歌矩阵分量 $S$。\n2. 计算精确的平稳 PageRank 向量 $x^\\star$。\n3. 使用幂迭代法模拟向 $x^\\star$ 的收敛过程。\n4. 确定达到指定容差所需的迭代次数 $K$。\n5. 估计经验收敛率 $r_{\\mathrm{hat}}$。\n\n我们现在将详细说明每个任务的方法。\n\n**1. 随机矩阵 $S$ 的构建**\n\n矩阵 $S \\in \\mathbb{R}^{n \\times n}$ 由图的邻接矩阵 $W \\in \\{0,1\\}^{n \\times n}$ 导出。问题为 $W$ 指定了基于列的约定，其中 $W_{ij} = 1$ 表示从节点 $j$ 到节点 $i$ 的有向边。$S$ 是一个列随机矩阵，构建如下：\n\n对于 $W$ 的每一列 $j \\in \\{1, \\dots, n\\}$：\n- 令 $c_j = \\sum_{i=1}^n W_{ij}$ 为第 $j$ 列元素的总和，这对应于节点 $j$ 的出度。\n- 如果 $c_j > 0$，节点 $j$ 有出链。$S$ 对应的列 $S_{\\cdot j}$ 通过对列 $W_{\\cdot j}$ 进行归一化得到：\n$$S_{ij} = \\frac{W_{ij}}{c_j} \\quad \\text{for } i=1, \\dots, n.$$\n- 如果 $c_j = 0$，节点 $j$ 是一个没有出链的“悬挂节点”。为确保结果矩阵是随机的（即其列和为 $1$），将列 $S_{\\cdot j}$ 设置为均匀瞬移向量 $v \\in \\mathbb{R}^n$，其中对所有 $i$，$v_i = 1/n$。\n$$S_{\\cdot j} = v = \\begin{bmatrix} 1/n  1/n  \\dots  1/n \\end{bmatrix}^T.$$\n通过这种构造， $S$ 的每一列都是非负的且和为 $1$，使得 $S$ 成为一个列随机矩阵。\n\n**2. 精确平稳分布 $x^\\star$ 的计算**\n\n平稳分布，也即 PageRank 向量 $x^\\star$，是 PageRank 迭代的唯一不动点概率向量。它满足方程：\n$$x^\\star = \\alpha S x^\\star + (1-\\alpha)v$$\n其中 $\\alpha \\in [0,1)$ 是瞬移概率。该方程可以重排为一个标准线性方程组：\n$$I x^\\star - \\alpha S x^\\star = (1-\\alpha)v$$\n$$(I - \\alpha S) x^\\star = (1-\\alpha)v$$\n其中 $I$ 是 $n \\times n$ 的单位矩阵。\n\n对于 $\\alpha \\in [0,1)$，解 $x^\\star$ 的存在性和唯一性是有保证的。矩阵 $S$ 是随机的，因此其谱半径（其特征值模的最大值）为 $\\rho(S)=1$。$\\alpha S$ 的谱半径为 $\\rho(\\alpha S) = \\alpha \\rho(S) = \\alpha$。由于 $\\alpha  1$，$\\alpha S$ 的所有特征值都严格位于复平面的单位圆内。这确保了 $1$ 不是 $\\alpha S$ 的特征值，因此矩阵 $(I - \\alpha S)$ 是可逆的。\n\n唯一的解 $x^\\star$ 可以通过求解这个线性系统来计算。虽然问题陈述建议对结果进行归一化，但该系统的解保证是一个概率向量（其分量和为 $1$），因此归一化是多余但无害的。\n\n**3. 幂迭代模拟**\n\nPageRank 向量 $x^\\star$ 是使用幂迭代法进行迭代计算的。迭代定义为：\n$$x_{k+1} = \\alpha S x_k + (1-\\alpha)v$$\n从初始分布 $x_0 = v$ 开始。该过程持续进行，直到迭代值 $x_k$ 足够接近真实的平稳分布 $x^\\star$。收敛性使用全变差距离 $d_{\\mathrm{TV}}(p,q) = \\frac{1}{2} \\lVert p - q \\rVert_1$ 来衡量。当条件 $d_{\\mathrm{TV}}(x_k, x^\\star) \\le \\varepsilon$ 满足时，迭代停止，其中给定的容差为 $\\varepsilon = 10^{-10}$。记录达到此标准所需的迭代次数 $K$。如果在最多 $K_{\\max} = 100000$ 次迭代内未满足该标准，则将 $K$ 设置为 $K_{\\max}$。如果初始向量 $x_0$ 已满足标准，则 $K=0$。\n\n**4. 经验收敛率 $r_{\\mathrm{hat}}$ 的估计**\n\n幂迭代的收敛是线性的。第 $k$ 步的误差向量为 $e_k = x_k - x^\\star$。误差传播如下：\n$$e_{k+1} = x_{k+1} - x^\\star = (\\alpha S x_k + (1-\\alpha)v) - (\\alpha S x^\\star + (1-\\alpha)v) = \\alpha S (x_k - x^\\star) = \\alpha S e_k.$$\n取 $\\ell_1$-范数，我们得到 $\\lVert e_{k+1} \\rVert_1 = \\alpha \\lVert S e_k \\rVert_1$。$\\ell_1$-误差 $\\lVert e_k \\rVert_1$ 的渐近收敛率由算子 $\\alpha S$ 在零和向量子空间上的作用决定（因为 $x_k$ 和 $x^\\star$ 是概率向量，它们的差 $e_k$ 的和为零）。理论收敛率与 $\\alpha$ 及 $S$ 的谱性质有关。\n\n问题要求对此速率进行*经验*估计，即 $r_{\\mathrm{hat}}$。这是根据幂迭代期间生成的 $\\ell_1$-误差序列 $e_k = \\lVert x_k - x^\\star \\rVert_1$ 计算的。对于 $k \\ge 1$，比率 $e_k/e_{k-1}$ 近似了每步的误差减少量。为了获得渐近速率的稳定估计，我们计算这些比率中最后 $\\min\\{50, K\\}$ 个的中位数，其中 $K$ 是执行的总迭代次数。如果生成的迭代次数少于两次（即 $K=0$），这意味着无法计算比率，则将 $r_{\\mathrm{hat}}$ 设置为 $0.0$。\n\n以下程序为所有指定的测试用例实现了这整个过程，并严格遵守所描述的方法。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the PageRank convergence problem for all test cases.\n    \"\"\"\n\n    def solve_one_case(n, alpha, W, epsilon, k_max):\n        \"\"\"\n        Solves a single test case of the PageRank problem.\n\n        Args:\n            n (int): Number of nodes.\n            alpha (float): Teleportation probability.\n            W (np.ndarray): Adjacency matrix (column-based).\n            epsilon (float): Convergence tolerance for total variation distance.\n            k_max (int): Maximum number of iterations.\n\n        Returns:\n            list: A list containing [K, r_hat], the number of iterations and the\n                  empirical convergence rate.\n        \"\"\"\n        # 1. Construct the stochastic matrix S\n        v = np.ones((n, 1)) / n\n        S = np.zeros((n, n), dtype=np.float64)\n        col_sums = np.sum(W, axis=0)\n        for j in range(n):\n            if col_sums[j] == 0:\n                S[:, j] = v.flatten()\n            else:\n                S[:, j] = W[:, j] / col_sums[j]\n\n        # 2. Compute the exact stationary distribution x_star\n        I = np.identity(n, dtype=np.float64)\n        A = I - alpha * S\n        b = (1 - alpha) * v\n        x_star = np.linalg.solve(A, b)\n        # Normalization is generally redundant but specified as a safeguard\n        x_star /= np.sum(x_star)\n\n        # 3.  4. Run power iteration and find K\n        x_k = v.copy()\n        errors_l1 = []\n        K = 0\n\n        # Loop from k=0 to k_max\n        for k_iter in range(k_max + 1):\n            e_k = np.linalg.norm(x_k - x_star, ord=1)\n            errors_l1.append(e_k)\n            d_tv = 0.5 * e_k\n\n            if d_tv = epsilon:\n                K = k_iter\n                break\n            \n            if k_iter == k_max:\n                K = k_max\n                # The loop will naturally break here, K is set correctly.\n                # No need for special handling if limit is reached.\n                break\n\n            # Update for next iteration\n            x_k = alpha * S @ x_k + (1 - alpha) * v\n        else:\n            # This part of loop is only executed if the loop completes without a break.\n            # In our case, range(k_max + 1) will always terminate.\n            # We set K=k_max if the loop finishes without meeting the criterion.\n            # The break statement at k_iter == k_max handles this.\n            K = k_max\n\n        # 5. Estimate empirical convergence rate r_hat\n        if len(errors_l1)  2:\n            r_hat = 0.0\n        else:\n            # Calculate ratios e_k / e_{k-1}\n            ratios = [errors_l1[i] / errors_l1[i-1] \n                      for i in range(1, len(errors_l1)) if errors_l1[i-1] > 0]\n\n            if not ratios:\n                r_hat = 0.0\n            else:\n                num_ratios_to_consider = min(50, len(ratios))\n                last_ratios = ratios[-num_ratios_to_consider:]\n                r_hat = np.median(last_ratios)\n\n        return [K, r_hat]\n\n    # --- Test Case Definitions ---\n    # Epsilon and K_max are common for all cases\n    epsilon = 1e-10\n    k_max = 100000\n\n    test_cases = [\n        # Case 1: n=4, alpha=0.85, W for a 4-cycle\n        (4, 0.85, np.array([[0, 0, 0, 1], [1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0]], dtype=np.float64)),\n        # Case 2: n=4, alpha=0.99, W for a 4-cycle (slower mixing)\n        (4, 0.99, np.array([[0, 0, 0, 1], [1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0]], dtype=np.float64)),\n        # Case 3: n=3, alpha=0.85, W with one dangling node\n        (3, 0.85, np.array([[0, 1, 0], [1, 0, 0], [0, 0, 0]], dtype=np.float64)),\n        # Case 4: n=3, alpha=0.99, W with one dangling node (slower mixing)\n        (3, 0.99, np.array([[0, 1, 0], [1, 0, 0], [0, 0, 0]], dtype=np.float64)),\n        # Case 5: n=4, alpha=0.90, reducible graph (two 2-cycles)\n        (4, 0.90, np.array([[0, 1, 0, 0], [1, 0, 0, 0], [0, 0, 0, 1], [0, 0, 1, 0]], dtype=np.float64)),\n        # Case 6: n=4, alpha=0.00, teleportation only\n        (4, 0.00, np.array([[0, 0, 0, 1], [1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0]], dtype=np.float64)),\n    ]\n\n    results = []\n    for n, alpha, W in test_cases:\n        result = solve_one_case(n, alpha, W, epsilon, k_max)\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    # The default string representation of a list of lists matches the format needs.\n    # E.g., str([[1, 2.0], [3, 4.0]]) -> '[[1, 2.0], [3, 4.0]]'\n    # The request is for \"[ [K1,rhat1],[K2,rhat2]... ]\" which str() does not produce.\n    # The template `print(f\"[{','.join(map(str, results))}]\")` will produce a string like\n    # '[[71, 0.85],[498, 0.99]]' which is a standard compact representation.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "3300074"}, {"introduction": "除了观察收敛现象，严谨的理解还需要分析系统稳定性的工具。本练习 [@problem_id:3300024] 挑战您使用 Dobrushin 系数——一个用于量化马尔可夫核收缩性的基本概念。通过推导转移核 $P$ 的扰动所导致的平稳分布 $\\pi$ 变化的界限，您将练习支撑马尔可夫链扰动理论的形式化推演。", "problem": "考虑一个定义在有限状态空间 $\\mathcal{X}$ 上的时间齐次马尔可夫链，其转移核为 $P$。令 $\\pi$ 表示 $P$ 的唯一平稳分布。将在 $\\mathcal{X}$ 上的符号测度 $\\mu$ 的全变差（TV）范数定义为 $\\|\\mu\\|_{\\mathrm{TV}} = \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} |\\mu(x)|$，对于一个核 $K$，其扰动半范数定义为\n$$\n\\|K\\|_{\\mathrm{ker}} = \\sup_{x \\in \\mathcal{X}} \\|K(x,\\cdot)\\|_{\\mathrm{TV}}.\n$$\n核 $P$ 的 Dobrushin 系数 $\\delta(P)$ 定义为\n$$\n\\delta(P) = \\sup_{\\mu \\neq \\nu} \\frac{\\|\\mu P - \\nu P\\|_{\\mathrm{TV}}}{\\|\\mu - \\nu\\|_{\\mathrm{TV}}},\n$$\n其中 $\\mu$ 和 $\\nu$ 是 $\\mathcal{X}$ 上的概率测度，$\\mu P$ 表示 $\\mu$ 在 $P$ 下的推前测度。假设 $\\delta(P)  1$，因此 $P$ 在 TV 范数下是唯一遍历且几何收缩的。\n\n现在考虑一个扰动核 $\\tilde{P}$，其平稳分布为 $\\tilde{\\pi}$，并假设核扰动在以下意义上是一致小的\n$$\n\\|P - \\tilde{P}\\|_{\\mathrm{ker}} \\le \\epsilon,\n$$\n对于某个 $\\epsilon > 0$。仅使用上述核心定义及它们的直接推论，推导出一个关于 $\\delta(P)$ 和 $\\epsilon$ 的 $\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$ 的显式上界。\n\n最后，对 $\\delta(P) = 0.87$ 和 $\\epsilon = 3.0 \\times 10^{-2}$ 计算你的界，并报告该界的数值。将你的最终数值答案四舍五入到四位有效数字。", "solution": "用户想要解决一个问题：“考虑一个定义在有限状态空间 $\\mathcal{X}$ 上的时间齐次马尔可夫链，其转移核为 $P$。令 $\\pi$ 表示 $P$ 的唯一平稳分布。将在 $\\mathcal{X}$ 上的符号测度 $\\mu$ 的全变差（TV）范数定义为 $\\|\\mu\\|_{\\mathrm{TV}} = \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} |\\mu(x)|$，对于一个核 $K$，其扰动半范数定义为\n$$\n\\|K\\|_{\\mathrm{ker}} = \\sup_{x \\in \\mathcal{X}} \\|K(x,\\cdot)\\|_{\\mathrm{TV}}.\n$$\n核 $P$ 的 Dobrushin 系数 $\\delta(P)$ 定义为\n$$\n\\delta(P) = \\sup_{\\mu \\neq \\nu} \\frac{\\|\\mu P - \\nu P\\|_{\\mathrm{TV}}}{\\|\\mu - \\nu\\|_{\\mathrm{TV}}},\n$$\n其中 $\\mu$ 和 $\\nu$ 是 $\\mathcal{X}$ 上的概率测度，$\\mu P$ 表示 $\\mu$ 在 $P$ 下的推前测度。假设 $\\delta(P)  1$，因此 $P$ 在 TV 范数下是唯一遍历且几何收缩的。\n\n现在考虑一个扰动核 $\\tilde{P}$，其平稳分布为 $\\tilde{\\pi}$，并假设核扰动在以下意义上是一致小的\n$$\n\\|P - \\tilde{P}\\|_{\\mathrm{ker}} \\le \\epsilon,\n$$\n对于某个 $\\epsilon > 0$。仅使用上述核心定义及它们的直接推论，推导出一个关于 $\\delta(P)$ 和 $\\epsilon$ 的 $\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$ 的显式上界。\n\n最后，对 $\\delta(P) = 0.87$ 和 $\\epsilon = 3.0 \\times 10^{-2}$ 计算你的界，并报告该界的数值。将你的最终数值答案四舍五入到四位有效数字。”\n\n### 步骤 1：提取已知条件\n- 状态空间 $\\mathcal{X}$ 是有限的。\n- 马尔可夫链是时间齐次的，转移核为 $P$。\n- $\\pi$ 是 $P$ 的唯一平稳分布，所以 $\\pi P = \\pi$。\n- 符号测度 $\\mu$ 的全变差（TV）范数：$\\|\\mu\\|_{\\mathrm{TV}} = \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} |\\mu(x)|$。\n- 核 $K$ 的核扰动半范数：$\\|K\\|_{\\mathrm{ker}} = \\sup_{x \\in \\mathcal{X}} \\|K(x,\\cdot)\\|_{\\mathrm{TV}}$。\n- 核 $P$ 的 Dobrushin 系数：$\\delta(P) = \\sup_{\\mu \\neq \\nu} \\frac{\\|\\mu P - \\nu P\\|_{\\mathrm{TV}}}{\\|\\mu - \\nu\\|_{\\mathrm{TV}}}$，其中 $\\mu, \\nu$ 为概率测度。\n- 假设：$\\delta(P)  1$。\n- 扰动核为 $\\tilde{P}$，其平稳分布为 $\\tilde{\\pi}$，所以 $\\tilde{\\pi} \\tilde{P} = \\tilde{\\pi}$。\n- 扰动界：$\\|P - \\tilde{P}\\|_{\\mathrm{ker}} \\le \\epsilon$，对于某个 $\\epsilon > 0$。\n- 任务 1：用 $\\delta(P)$ 和 $\\epsilon$ 推导 $\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$ 的上界。\n- 任务 2：对 $\\delta(P) = 0.87$ 和 $\\epsilon = 3.0 \\times 10^{-2}$ 计算该界。报告四舍五入到四位有效数字的数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用马尔可夫链理论中标准的、完善的概念来表述，包括全变差范数、Dobrushin 系数和扰动界。这些是分析随机过程稳定性和收敛性的基本工具。前提和定义在数学上是合理的。\n- **适定性**：该问题是适定的。条件 $\\delta(P)  1$ 保证了平稳分布 $\\pi$ 的存在性和唯一性，以及核 $P$ 在 TV 范数下的几何收缩性，这些对于分析至关重要。问题要求一个上界，这是在这种情况下一个典型且有意义的问题。所提供的信息足以推导出结果。\n- **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观性或模糊性。\n\n问题是有效的。这是马尔可夫链扰动理论中的一个标准结果，需要按照概述从第一性原理进行严格推导。我将继续进行求解。\n\n目标是找到核 $P$ 和 $\\tilde{P}$ 各自的平稳分布 $\\pi$ 和 $\\tilde{\\pi}$ 之间的全变差距离 $\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$ 的一个上界。\n\n根据定义，$\\pi$ 和 $\\tilde{\\pi}$ 是平稳分布，这意味着它们是 $\\mathcal{X}$ 上的概率测度，满足：\n$$\n\\pi P = \\pi\n$$\n$$\n\\tilde{\\pi} \\tilde{P} = \\tilde{\\pi}\n$$\n我们希望界定 $\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$。我们可以利用平稳性来重写差值 $\\pi - \\tilde{\\pi}$：\n$$\n\\pi - \\tilde{\\pi} = \\pi P - \\tilde{\\pi} \\tilde{P}\n$$\n为了将其与给定数量联系起来，我们加上和减去一个交叉项 $\\tilde{\\pi} P$：\n$$\n\\pi - \\tilde{\\pi} = (\\pi P - \\tilde{\\pi} P) + (\\tilde{\\pi} P - \\tilde{\\pi} \\tilde{P})\n$$\n第二项可以因式分解为 $\\tilde{\\pi}(P - \\tilde{P})$。对 TV 范数应用三角不等式可得：\n$$\n\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}} = \\|(\\pi P - \\tilde{\\pi} P) + \\tilde{\\pi}(P - \\tilde{P})\\|_{\\mathrm{TV}} \\le \\|\\pi P - \\tilde{\\pi} P\\|_{\\mathrm{TV}} + \\|\\tilde{\\pi}(P - \\tilde{P})\\|_{\\mathrm{TV}}\n$$\n我们现在分别分析右侧的两项。\n\n对于第一项 $\\|\\pi P - \\tilde{\\pi} P\\|_{\\mathrm{TV}}$，我们使用 Dobrushin 系数 $\\delta(P)$ 的定义。由于 $\\pi$ 和 $\\tilde{\\pi}$ 是概率测度，我们有：\n$$\n\\frac{\\|\\pi P - \\tilde{\\pi} P\\|_{\\mathrm{TV}}}{\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}} \\le \\sup_{\\mu \\neq \\nu} \\frac{\\|\\mu P - \\nu P\\|_{\\mathrm{TV}}}{\\|\\mu - \\nu\\|_{\\mathrm{TV}}} = \\delta(P)\n$$\n这直接意味着：\n$$\n\\|\\pi P - \\tilde{\\pi} P\\|_{\\mathrm{TV}} \\le \\delta(P) \\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}\n$$\n\n对于第二项 $\\|\\tilde{\\pi}(P - \\tilde{P})\\|_{\\mathrm{TV}}$，令 $K = P - \\tilde{P}$。推前测度 $\\tilde{\\pi} K$ 在状态 $y \\in \\mathcal{X}$ 处的值为 $(\\tilde{\\pi} K)(y) = \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) K(x,y)$。根据 TV 范数的定义：\n$$\n\\|\\tilde{\\pi} K\\|_{\\mathrm{TV}} = \\frac{1}{2} \\sum_{y \\in \\mathcal{X}} \\left| \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) K(x,y) \\right|\n$$\n使用实数求和的三角不等式，并注意到 $\\tilde{\\pi}(x) \\ge 0$：\n$$\n\\|\\tilde{\\pi} K\\|_{\\mathrm{TV}} \\le \\frac{1}{2} \\sum_{y \\in \\mathcal{X}} \\sum_{x \\in \\mathcal{X}} |\\tilde{\\pi}(x) K(x,y)| = \\frac{1}{2} \\sum_{y \\in \\mathcal{X}} \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) |K(x,y)|\n$$\n由于求和是在有限空间上进行的，我们可以交换求和顺序：\n$$\n\\|\\tilde{\\pi} K\\|_{\\mathrm{TV}} \\le \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) \\left( \\frac{1}{2} \\sum_{y \\in \\mathcal{X}} |K(x,y)| \\right)\n$$\n括号中的项是符号测度 $K(x, \\cdot)$ 的 TV 范数：\n$$\n\\frac{1}{2} \\sum_{y \\in \\mathcal{X}} |K(x,y)| = \\|K(x, \\cdot)\\|_{\\mathrm{TV}}\n$$\n因此，不等式变为：\n$$\n\\|\\tilde{\\pi} K\\|_{\\mathrm{TV}} \\le \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) \\|K(x, \\cdot)\\|_{\\mathrm{TV}}\n$$\n我们现在使用核半范数的定义，$\\|K\\|_{\\mathrm{ker}} = \\sup_{z \\in \\mathcal{X}} \\|K(z, \\cdot)\\|_{\\mathrm{TV}}$。这意味着对于所有 $x \\in \\mathcal{X}$，都有 $\\|K(x, \\cdot)\\|_{\\mathrm{TV}} \\le \\|K\\|_{\\mathrm{ker}}$。\n$$\n\\|\\tilde{\\pi} K\\|_{\\mathrm{TV}} \\le \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) \\|K\\|_{\\mathrm{ker}} = \\|K\\|_{\\mathrm{ker}} \\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x)\n$$\n因为 $\\tilde{\\pi}$ 是一个概率测度，所以 $\\sum_{x \\in \\mathcal{X}} \\tilde{\\pi}(x) = 1$。因此，\n$$\n\\|\\tilde{\\pi}(P - \\tilde{P})\\|_{\\mathrm{TV}} \\le \\|P - \\tilde{P}\\|_{\\mathrm{ker}}\n$$\n问题陈述了 $\\|P - \\tilde{P}\\|_{\\mathrm{ker}} \\le \\epsilon$。因此，我们有：\n$$\n\\|\\tilde{\\pi}(P - \\tilde{P})\\|_{\\mathrm{TV}} \\le \\epsilon\n$$\n将这两项的界代入主不等式中：\n$$\n\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}} \\le \\delta(P) \\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}} + \\epsilon\n$$\n令 $d = \\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}}$。不等式为 $d \\le \\delta(P) d + \\epsilon$。整理各项以解出 $d$：\n$$\nd - \\delta(P) d \\le \\epsilon\n$$\n$$\n(1 - \\delta(P)) d \\le \\epsilon\n$$\n由于给定 $\\delta(P)  1$，项 $(1 - \\delta(P))$ 是正的。我们可以用它来除，而不改变不等号的方向：\n$$\n\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}} \\le \\frac{\\epsilon}{1 - \\delta(P)}\n$$\n这就是所求的显式上界。\n\n最后，我们用给定的数值计算这个界：$\\delta(P) = 0.87$ 和 $\\epsilon = 3.0 \\times 10^{-2}$。\n$$\n\\|\\pi - \\tilde{\\pi}\\|_{\\mathrm{TV}} \\le \\frac{3.0 \\times 10^{-2}}{1 - 0.87} = \\frac{0.03}{0.13} = \\frac{3}{13}\n$$\n数值为：\n$$\n\\frac{3}{13} \\approx 0.23076923...\n$$\n四舍五入到四位有效数字，我们得到 $0.2308$。", "answer": "$$\n\\boxed{0.2308}\n$$", "id": "3300024"}, {"introduction": "收敛到唯一平稳分布的理论保证取决于遍历性（ergodicity）。本问题 [@problem_id:3300040] 提出了一个思想实验，涉及一个 Metropolis-Hastings 采样器，其提议机制中一个看似无害的设计却破坏了遍历性假设。通过剖析这个例子，您将诊断出一种常见的失效模式——可约性（reducibility），并理解其深远后果，例如存在多个平稳分布以及收敛行为对初始化的依赖性。", "problem": "考虑一个马尔可夫链蒙特卡洛（MCMC）方案，旨在从整数格$\\mathbb{Z}$上的目标分布$\\pi$中进行抽样，其中对于$k \\in \\mathbb{Z}$，$\\pi(k) \\propto \\exp(-|k|)$。该算法是一个Metropolis-Hastings（MH）方案（Metropolis-Hastings (MH) 算法），其提议机制中存在确定性约束：从当前状态$x \\in \\mathbb{Z}$开始，它提议$y \\in \\{x-2, x, x+2\\}$，其中$q(y \\mid x)$由$q(x-2 \\mid x) = p$、$q(x \\mid x) = 1 - 2p$和$q(x+2 \\mid x) = p$给出，对于某个固定的$p \\in (0, 1/2)$，并使用标准的MH接受准则。根据构造，该提议保留了状态的奇偶性；也就是说，如果$x$是偶数（或奇数），那么任何提议的$y$也同样是偶数（或奇数）。假设对于所有$k \\in \\mathbb{Z}$，$\\pi(k)  0$。\n\n供参考的基本定义：\n- 一个在可数状态空间上具有转移核$P$的马尔可夫链是不可约的（irreducible），如果对于所有状态$x, y$，存在$n \\in \\mathbb{N}$使得$P^n(x, y)  0$。\n- 状态$x$的周期$d(x)$定义为$d(x) = \\gcd\\{n \\geq 1 : P^n(x, x)  0\\}$。如果对于感兴趣的互通类中的所有$x$，$d(x) = 1$，则链是非周期的（aperiodic）。\n- 如果$\\mu P = \\mu$，则概率测度$\\mu$是$P$的平稳（不变）测度。\n\n在此背景下，请指出关于所述链的遍历性、不变分布和收敛行为的正确陈述。\n\nA. 该链在$\\mathbb{Z}$上是不可约的，并且无论初始化如何，都收敛到唯一的平稳分布$\\pi$。\n\nB. 该链是非周期的但可约，具有两个不相交的闭互通类，分别由偶数和奇数构成；该链从不在这些类之间转移。\n\nC. 存在无穷多个形式为$\\mu_\\alpha = \\alpha \\,\\pi_{\\mathrm{even}} + (1-\\alpha)\\,\\pi_{\\mathrm{odd}}$（对于$\\alpha \\in [0,1]$）的不变分布，其中$\\pi_{\\mathrm{even}}$和$\\pi_{\\mathrm{odd}}$分别是$\\pi$限制在偶数和奇数上并进行归一化后的分布。如果从一个偶数状态初始化，该链收敛到$\\pi_{\\mathrm{even}}$。\n\nD. 因为MH接受准则强制了关于$\\pi$的细致平衡条件，所以不可约性不是必需的；该链从任何初始状态都收敛到$\\pi$。\n\nE. 对于任何可积函数$f$，经验平均值$\\frac{1}{T} \\sum_{t=1}^T f(X_t)$几乎必然收敛到$\\mathbb{E}_\\pi[f(X)]$，且与初始化无关，因为该链是非周期的。", "solution": "用户希望我扮演一位严谨细致的STEM领域教授，来验证并解决一个与Metropolis-Hastings MCMC方案相关的问题。\n\n### 问题验证\n\n首先，我将根据指定标准验证问题陈述。\n\n**步骤1：提取给定条件**\n\n*   目标分布：$\\pi$，在整数格$\\mathbb{Z}$上，其中对于$k \\in \\mathbb{Z}$，$\\pi(k) \\propto \\exp(-|k|)$。\n*   算法：Metropolis-Hastings（MH）方案。\n*   状态空间：$\\mathcal{S} = \\mathbb{Z}$。\n*   当前状态：$x \\in \\mathbb{Z}$。\n*   提议分布$q(y \\mid x)$：\n    *   $q(x-2 \\mid x) = p$。\n    *   $q(x \\mid x) = 1 - 2p$。\n    *   $q(x+2 \\mid x) = p$。\n*   参数：$p \\in (0, 1/2)$。\n*   提议属性：保留状态的奇偶性。\n*   假设：对于所有$k \\in \\mathbb{Z}$，$\\pi(k)  0$。\n*   参考定义：不可约性、周期、平稳分布。\n\n**步骤2：使用提取的给定条件进行验证**\n\n问题陈述描述了一个在可数状态空间上的标准Metropolis-Hastings算法，其目标分布（拉普拉斯分布的离散版本）和特定的提议机制都已明确定义。\n\n*   **科学依据：** 该问题牢固地植根于马尔可夫链蒙特卡洛方法的理论，这是统计学和应用数学中一个标准且成熟的领域。所有概念——Metropolis-Hastings、目标分布、平稳分布、不可约性、非周期性——都是标准的。该设置在数学上是合理的。\n*   **适定性：** 问题要求分析所描述的马尔可夫链的性质。设置是完整和明确的，允许对这些性质进行严谨和唯一的确定。\n*   **客观性：** 问题以精确、客观的数学语言陈述，不含任何主观或非形式化的内容。\n\n问题陈述的所有要素都是一致的。提议概率的总和为$p + (1-2p) + p = 1$。条件$p \\in (0, 1/2)$确保了$p  0$和$1-2p  0$。假设$\\pi(k)  0$与$\\pi(k) \\propto \\exp(-|k|)$是一致的。该问题没有任何科学、逻辑或结构上的缺陷。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。我将继续进行详细的推导和分析。\n\n### 推导与求解\n\n该问题涉及一个Metropolis-Hastings (MH) 算法，旨在从状态空间$\\mathcal{S} = \\mathbb{Z}$上的目标分布$\\pi(k) \\propto \\exp(-|k|)$进行抽样。所产生的马尔可夫链的转移核$P(x,y)$决定了其性质。\n\n**1. 对提议分布$q(y \\mid x)$的分析**\n\n提议分布由$q(x-2 \\mid x) = p$、$q(x+2 \\mid x) = p$和$q(x \\mid x) = 1-2p$给出。我们注意到这个提议分布是对称的：$q(y \\mid x) = q(x \\mid y)$。例如，如果$y = x+2$，那么$x=y-2$。对此的提议概率是$q(x+2 \\mid x) = p$，而$q(x \\mid y) = q(y-2 \\mid y) = p$。对称性成立。对于$y=x$，这是平凡的。对于其他配对$(x,y)$，$q(y \\mid x) = q(x \\mid y) = 0$。\n\n**2. MH接受概率$\\alpha(x,y)$**\n\n标准的MH接受概率是$\\alpha(x, y) = \\min\\left(1, \\frac{\\pi(y)q(x \\mid y)}{\\pi(x)q(y \\mid x)}\\right)$。由于提议分布的对称性（$q(x \\mid y) = q(y \\mid x)$），接受概率简化为Metropolis算法的形式：\n$$ \\alpha(x, y) = \\min\\left(1, \\frac{\\pi(y)}{\\pi(x)}\\right) $$\n代入$\\pi(k)$的形式，我们得到：\n$$ \\alpha(x, y) = \\min\\left(1, \\frac{C \\exp(-|y|)}{C \\exp(-|x|)}\\right) = \\min\\left(1, \\exp(|x| - |y|)\\right) $$\n由于对所有$k \\in \\mathbb{Z}$都有$\\pi(k)  0$，对于任何可能进行提议的配对$(x, y)$（即$y \\in \\{x-2, x+2\\}$），接受概率$\\alpha(x, y)$都严格为正。\n\n**3. 对不可约性的分析**\n\n如果对于任何$x, y \\in \\mathbb{Z}$，都存在一个整数$n \\geq 1$使得$P^n(x, y)  0$，则马尔可夫链在$\\mathbb{Z}$上是不可约的。从$x$到$y$（其中$y \\neq x$）的转移概率是$P(x,y) = q(y \\mid x) \\alpha(x,y)$。只有当$q(y \\mid x)  0$时，转移才可能发生。\n\n提议机制只允许在相同奇偶性的状态之间跳转。如果$x$是一个偶数，即$x=2k$（对于某个$k \\in \\mathbb{Z}$）。一个被提议的状态$y$可以是$2k-2 = 2(k-1)$、$2k$或$2k+2 = 2(k+1)$。所有被提议的状态都是偶数。如果$x$是一个奇数，即$x=2k+1$，一个被提议的状态$y$可以是$(2k+1)-2 = 2(k-1)+1$、$2k+1$或$(2k+1)+2 = 2(k+1)+1$。所有被提议的状态都是奇数。\n\n因此，该链永远不能从偶数状态转移到奇数状态，反之亦然。状态空间$\\mathbb{Z}$被划分为两个不相交的、闭合的互通状态集：\n*   $\\mathcal{S}_E = \\{ k \\in \\mathbb{Z} : k \\text{ 是偶数} \\}$\n*   $\\mathcal{S}_O = \\{ k \\in \\mathbb{Z} : k \\text{ 是奇数} \\}$\n\n由于不可能从$\\mathcal{S}_E$中的状态转移到$\\mathcal{S}_O$中的状态（例如，从$0$到$1$），该链在$\\mathbb{Z}$上是**可约的**。\n\n在每个子类内部，链是不可约的。对于任何$x, y \\in \\mathcal{S}_E$，可以通过一系列大小为$+2$或$-2$的步从$x$到达$y$。每这样一步都有正的概率$P(z, z\\pm2) = q(z\\pm2 \\mid z)\\alpha(z, z\\pm2) = p \\cdot \\alpha(z, z\\pm2)  0$。同样的逻辑也适用于$\\mathcal{S}_O$。\n\n**4. 对非周期性的分析**\n\n状态$x$的周期是$d(x) = \\gcd\\{n \\geq 1 : P^n(x, x)  0\\}$。如果对于一个互通类中的所有状态$d(x)=1$，则链是非周期的。停留在状态$x$的概率是：\n$$ P(x,x) = q(x \\mid x) + \\sum_{y \\neq x} q(y \\mid x)(1-\\alpha(x,y)) $$\n由于$q(x \\mid x) = 1-2p$且给定$p \\in (0, 1/2)$，因此$1-2p  0$。所以，对于所有$x \\in \\mathbb{Z}$，$P(x,x) \\ge q(x \\mid x)  0$。\n由于$P^1(x,x)  0$，集合$\\{n \\geq 1 : P^n(x, x)  0\\}$包含$1$。任何包含$1$的整数集合的最大公约数（gcd）是$1$。因此，对于所有$x \\in \\mathbb{Z}$，$d(x) = 1$。该链是**非周期的**。\n\n**5. 对不变分布和收敛性的分析**\n\n根据构造，MH算法满足关于$\\pi$的细致平衡条件：$\\pi(x)P(x,y) = \\pi(y)P(y,x)$。这意味着$\\pi$是该链的一个平稳分布。然而，因为链是可约的，所以平稳分布不是唯一的。\n\n所有平稳分布的集合是不可约分量的唯一平稳分布的凸包。\n*   令$\\pi_{\\mathrm{even}}$为$\\pi$限制在$\\mathcal{S}_E$上的归一化分布：对于$k \\in \\mathcal{S}_E$，$\\pi_{\\mathrm{even}}(k) = \\frac{\\pi(k)}{\\sum_{j \\in \\mathcal{S}_E} \\pi(j)}$，否则为$0$。限制在$\\mathcal{S}_E$上的链是不可约且非周期的，因此它以$\\pi_{\\mathrm{even}}$作为其唯一的平稳分布。\n*   类似地，令$\\pi_{\\mathrm{odd}}$为$\\pi$限制在$\\mathcal{S}_O$上的归一化分布。限制在$\\mathcal{S}_O$上的链收敛到$\\pi_{\\mathrm{odd}}$。\n\n对于$\\alpha \\in [0, 1]$，任何形式为$\\mu_\\alpha = \\alpha \\, \\pi_{\\mathrm{even}} + (1-\\alpha) \\, \\pi_{\\mathrm{odd}}$的分布都是整个链在$\\mathbb{Z}$上的一个有效平稳分布。这构成了一个无穷的不变分布族。\n\n关于收敛性：\n*   如果链从一个状态$x_0 \\in \\mathcal{S}_E$初始化，它将永远停留在$\\mathcal{S}_E$中。由于在$\\mathcal{S}_E$上的子链是不可约且非周期的，当$t \\to \\infty$时，$X_t$的分布将收敛到$\\pi_{\\mathrm{even}}$。\n*   如果从$x_0 \\in \\mathcal{S}_O$初始化，分布将收敛到$\\pi_{\\mathrm{odd}}$。\n\n该链不会收敛到与初始化无关的单一分布$\\pi$。\n\n### 逐项分析\n\n**A. 该链在$\\mathbb{Z}$上是不可约的，并且无论初始化如何，都收敛到唯一的平稳分布$\\pi$。**\n此陈述不正确。如上所示，该链是**可约的**，因为它不能在偶数和奇数之间转移。因此，它没有唯一的平稳分布，其收敛行为取决于初始状态的奇偶性。\n\n**B. 该链是非周期的但可约，具有两个不相交的闭互通类，分别由偶数和奇数构成；该链从不在这些类之间转移。**\n此陈述正确。我们的分析证实了该链是非周期的（因为$P(x,x)  0$）和可约的。两个不相交的闭互通类恰好是偶数集（$\\mathcal{S}_E$）和奇数集（$\\mathcal{S}_O$）。\n\n**C. 存在无穷多个形式为$\\mu_\\alpha = \\alpha \\,\\pi_{\\mathrm{even}} + (1-\\alpha)\\,\\pi_{\\mathrm{odd}}$（对于$\\alpha \\in [0,1]$）的不变分布，其中$\\pi_{\\mathrm{even}}$和$\\pi_{\\mathrm{odd}}$分别是$\\pi$限制在偶数和奇数上并进行归一化后的分布。如果从一个偶数状态初始化，该链收敛到$\\pi_{\\mathrm{even}}$。**\n此陈述正确。我们的分析表明，由于可约性，不可约分量（$\\pi_{\\mathrm{even}}$和$\\pi_{\\mathrm{odd}}$）的平稳分布的任何凸组合也是一个平稳分布。这给出了一个由$\\alpha \\in [0,1]$参数化的无穷族。此外，由于限制在偶数上的链是不可约且非周期的，当从偶数状态开始时，它会收敛到其唯一的平稳分布$\\pi_{\\mathrm{even}}$。\n\n**D. 因为MH接受准则强制了关于$\\pi$的细致平衡条件，所以不可约性不是必需的；该链从任何初始状态都收敛到$\\pi$。**\n此陈述不正确。虽然细致平衡确保了$\\pi$是一个平稳分布，但它并不保证从任何初始状态都收敛到$\\pi$。遍历性，即在感兴趣的空间上同时需要不可约性和非周期性，是这种全局收敛所必需的。这个问题是一个典型例子，说明了缺乏不可约性如何阻止了链在整个状态空间上收敛到单一目标分布。\n\n**E. 对于任何可积函数$f$，经验平均值$\\frac{1}{T} \\sum_{t=1}^T f(X_t)$几乎必然收敛到$\\mathbb{E}_\\pi[f(X)]$，且与初始化无关，因为该链是非周期的。**\n此陈述不正确。该结论描述了遍历马尔可夫链的强大数定律。该链在$\\mathbb{Z}$上不是遍历的，因为它不是不可约的。经验平均值的极限取决于初始状态。如果从一个偶数状态$x_0 \\in \\mathcal{S}_E$开始，平均值收敛到$\\mathbb{E}_{\\pi_{\\mathrm{even}}}[f(X)]$。如果从一个奇数状态$x_0 \\in \\mathcal{S}_O$开始，它收敛到$\\mathbb{E}_{\\pi_{\\mathrm{odd}}}[f(X)]$。这两个值通常不相等，也与$\\mathbb{E}_\\pi[f(X)]$不等。仅有非周期性不足以保证所述的收敛性。\n\n选项B和C都正确地描述了该链的性质和行为。", "answer": "$$\\boxed{BC}$$", "id": "3300040"}]}