{"hands_on_practices": [{"introduction": "在经典统计学中，寻求无偏估计量是一个常见的主题。然而，无偏估计量总是更优越吗？本练习通过比较一个标准的无偏估计量和一个简单的有偏常数估计量，来挑战这一假设。通过在一个具体情景下计算两者的均方误差（MSE），你将发现最小化 MSE 有时需要接受一定的偏差，这引入了偏差-方差权衡的核心概念。[@problem_id:1934147]", "problem": "在统计估计理论中，我们通常根据不同估计量对参数的性能表现来进行比较。考虑一个服从参数为 $p$ 的伯努利分布的随机变量 $X$，记作 $X \\sim \\text{Bernoulli}(p)$，其中 $p$ 是成功（$X=1$）的概率，$1-p$ 是失败（$X=0$）的概率。\n\n假设我们只有一个 $X$ 的观测值来估计未知参数 $p$。提出了两种不同的估计量：\n\n1.  第一个估计量 $\\hat{p}_1$ 就是观测结果：$\\hat{p}_1 = X$。\n2.  第二个估计量 $\\hat{p}_2$ 是一个固定的常数值：$\\hat{p}_2 = 0.8$。\n\n一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的优劣通常用其均方误差（MSE）来衡量，其定义为 $\\text{MSE}(\\hat{\\theta}) = E[(\\hat{\\theta} - \\theta)^2]$，其中 $E[\\cdot]$ 表示期望。\n\n假设参数的真实值为 $p=0.9$，这两个估计量中哪一个的均方误差更低？\n\nA. $\\hat{p}_1$ 的均方误差更低。\nB. $\\hat{p}_2$ 的均方误差更低。\nC. 均方误差相等。\nD. 根据给定信息无法进行比较。", "solution": "我们给定一个观测值 $X \\sim \\text{Bernoulli}(p)$ 和两个估计量：$\\hat{p}_{1}=X$ 以及 $\\hat{p}_{2}=0.8$。均方误差定义为 $\\text{MSE}(\\hat{\\theta})=E[(\\hat{\\theta}-\\theta)^{2}]$。我们先用 $p$ 的符号形式计算均方误差，然后在 $p=0.9$ 时求值。\n\n对于 $\\hat{p}_{1}=X$，使用偏差-方差分解，\n$$\n\\text{MSE}(\\hat{p}_{1})= \\operatorname{Var}(X) + \\left(E[X]-p\\right)^{2}.\n$$\n对于 $X \\sim \\text{Bernoulli}(p)$，$E[X]=p$ 且 $\\operatorname{Var}(X)=p(1-p)$。因此，\n$$\n\\text{MSE}(\\hat{p}_{1})=p(1-p).\n$$\n或者，直接计算：\n$$\n\\text{MSE}(\\hat{p}_{1})=E[(X-p)^{2}]=E[X^{2}] - 2pE[X] + p^{2} = E[X] - 2p^{2} + p^{2} = p - p^{2} = p(1-p).\n$$\n\n对于 $\\hat{p}_{2}=0.8$，由于它是一个常数，\n$$\n\\text{MSE}(\\hat{p}_{2})=E[(0.8-p)^{2}]=(0.8-p)^{2}.\n$$\n\n现在在真实值 $p=0.9$ 处进行求值：\n$$\n\\text{MSE}(\\hat{p}_{1})=0.9(1-0.9)=0.09,\\qquad \\text{MSE}(\\hat{p}_{2})=(0.8-0.9)^{2}=0.01.\n$$\n由于 $0.01  0.09$，第二个估计量的均方误差更低。因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1934147"}, {"introduction": "现在我们已经看到了偏差可能扮演的角色，让我们来分析一个统计估计的基石——样本均值的性能。这个问题要求你推导指数分布寿命样本均值的 MSE。这个练习将展示，对于一个无偏估计量，其 MSE 完全由其方差决定，而方差又是样本量的一个直接函数。[@problem_id:1934129]", "problem": "在一个生产新型长寿命发光二极管（LED）灯泡的工厂中，灯泡的工作寿命是一个关键的质量指标。大量的既往数据表明，这些灯泡的寿命（以千小时为单位）可以被一个指数分布精确地建模，其未知的真实平均寿命记为 $\\theta$。\n\n一位质量控制工程师的任务是估计这个平均寿命 $\\theta$。该工程师从生产线上采集了 $n$ 个灯泡的随机样本，并测量了它们的寿命，记为 $X_1, X_2, \\dots, X_n$。对于真实平均寿命 $\\theta$ 提议的估计量是样本均值 $\\hat{\\theta} = \\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n为了评估这个估计量的性能，工程师决定计算其均方误差（MSE）。对于参数 $\\theta$ 的一个估计量 $\\hat{\\theta}$ 的均方误差（MSE）被定义为估计量与参数之间差的平方的期望值：$\\text{MSE}(\\hat{\\theta}) = \\mathbb{E}\\left[(\\hat{\\theta} - \\theta)^2\\right]$。\n\n你的任务是在此背景下，推导样本均值估计量 $\\hat{\\theta}$ 的均方误差的通用表达式。请用真实平均寿命 $\\theta$ 和样本大小 $n$ 来表示你的答案。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的指数随机变量，其均值为 $\\theta$。对于由其均值参数化的指数分布，对每个 $i$ 我们有 $\\mathbb{E}[X_{i}]=\\theta$ 和 $\\operatorname{Var}(X_{i})=\\theta^{2}$。\n\n估计量是样本均值 $\\hat{\\theta}=\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。根据期望的线性性质，\n$$\n\\mathbb{E}[\\bar{X}]=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbb{E}[X_{i}]=\\frac{1}{n}\\cdot n\\theta=\\theta,\n$$\n所以该估计量是无偏的，且偏差为 $0$。\n\n利用独立性和方差的尺度变换性质，\n$$\n\\operatorname{Var}(\\bar{X})=\\operatorname{Var}\\!\\left(\\frac{1}{n}\\sum_{i=1}^{n}X_{i}\\right)=\\frac{1}{n^{2}}\\sum_{i=1}^{n}\\operatorname{Var}(X_{i})=\\frac{1}{n^{2}}\\cdot n\\theta^{2}=\\frac{\\theta^{2}}{n}.\n$$\n均方误差满足偏差-方差分解\n$$\n\\operatorname{MSE}(\\hat{\\theta})=\\mathbb{E}\\big[(\\hat{\\theta}-\\theta)^{2}\\big]=\\operatorname{Var}(\\hat{\\theta})+\\big(\\mathbb{E}[\\hat{\\theta}]-\\theta\\big)^{2}.\n$$\n由于偏差为 $0$，上式简化为\n$$\n\\operatorname{MSE}(\\bar{X})=\\operatorname{Var}(\\bar{X})=\\frac{\\theta^{2}}{n}.\n$$", "answer": "$$\\boxed{\\frac{\\theta^{2}}{n}}$$", "id": "1934129"}, {"introduction": "现在，我们将这些概念综合到一个对计算科学和蒙特卡洛方法至关重要的实际优化问题中。在模拟复杂系统时，我们面临一个权衡：减少离散化偏差需要更小的时间步长（$h$），而减少统计方差需要更多的模拟次数（$n$），这两者都会增加计算成本。这个高级练习将指导你在固定的计算预算下，通过找到偏差和方差之间的最佳平衡点来最小化总均方误差。[@problem_id:3292367]", "problem": "考虑一个用于计算期望 $\\mu = \\mathbb{E}[G(X)]$ 的单层蒙特卡洛估计量，其中 $X$ 是一个连续时间随机过程的末态，而 $G$ 是一个可测泛函。该估计量使用时间离散化参数 $h \\in (0,1]$ 和 $n \\in \\mathbb{N}$ 个独立样本，得到近似值 $\\widehat{\\mu}_{n,h} = \\frac{1}{n}\\sum_{i=1}^{n} G\\!\\left(X^{(i)}_{h}\\right)$，其中 $X^{(i)}_{h}$ 表示分辨率为 $h$ 的第 $i$ 条离散化样本路径。在底层过程弱近似的标准正则性条件下，假设如下：\n- 当 $h \\to 0$ 时，偏差满足 $|\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu| = c_{b}\\, h^{p} + o(h^{p})$，其中常数 $c_{b}  0$ 且阶数 $p  0$。\n- 单样本方差关于 $h$ 一致有界，即 $\\operatorname{Var}(G(X_{h})) \\leq c_{v}$，其中常数 $c_{v}  0$。\n- 计算成本的标度关系为 $C(n,h) = \\kappa\\, \\frac{n}{h}$，其中常数 $\\kappa  0$，这反映了每条样本路径需要 $\\mathcal{O}(h^{-1})$ 个时间步长。\n\n利用偏差、方差和均方误差 (MSE) 的基本定义，并将 $n$ 视为用于优化的连续正变量，构建并求解在固定计算预算 $\\mathcal{B}  0$（即 $C(n,h) \\leq \\mathcal{B}$，且优化器达到预算）的约束下，选择 $(n,h)$ 以最小化 MSE 的约束优化问题。推导最优的 $h^{\\star}$、$n^{\\star}$ 和最小化后的均方误差 $\\mathrm{MSE}^{\\star}$ 关于 $p$、$c_{b}$、$c_{v}$、$\\kappa$ 和 $\\mathcal{B}$ 的精确符号表达式。最后，解释最优的 $h^{\\star}$、$n^{\\star}$ 和 $\\mathrm{MSE}^{\\star}$ 相对于 $\\mathcal{B}$ 和阶数 $p$ 的标度关系。将最优量表示为精确的解析表达式；不需要进行数值取整。", "solution": "该问题被评估为有效。它在科学上基于随机微分方程的蒙特卡洛方法理论，作为一个约束优化问题是适定的，并且陈述客观、没有歧义。唯一解所需的所有数据和假设均已提供。因此，我们可以进行推导。\n\n目标是在给定的计算预算 $\\mathcal{B}$ 下，最小化估计量 $\\widehat{\\mu}_{n,h}$ 的均方误差 (MSE)。MSE 定义为 $\\mathrm{MSE}(\\widehat{\\mu}_{n,h}) = \\mathbb{E}[(\\widehat{\\mu}_{n,h} - \\mu)^2]$。它可以分解为偏差平方和估计量方差之和：\n$$\n\\mathrm{MSE}(\\widehat{\\mu}_{n,h}) = \\left(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu\\right)^2 + \\operatorname{Var}(\\widehat{\\mu}_{n,h})\n$$\n\n当 $h \\to 0$ 时，我们有以下关于主阶项的关系：\n$1$. 偏差平方为 $(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu)^2$。由于该估计量是 $n$ 个独立样本的均值，其期望为 $\\mathbb{E}[\\widehat{\\mu}_{n,h}] = \\mathbb{E}[G(X_h)]$。问题陈述 $|\\mathbb{E}[G(X_h)] - \\mu| = c_{b} h^{p} + o(h^p)$。我们用其主阶项的平方来近似偏差平方：\n$$\n\\left(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu\\right)^2 \\approx (c_{b} h^{p})^2 = c_{b}^2 h^{2p}\n$$\n$2$. 估计量的方差为 $\\operatorname{Var}(\\widehat{\\mu}_{n,h}) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{i=1}^{n} G(X^{(i)}_{h})\\right)$。由于样本是独立同分布的，均值的方差等于单个样本的方差除以 $n$：\n$$\n\\operatorname{Var}(\\widehat{\\mu}_{n,h}) = \\frac{1}{n} \\operatorname{Var}(G(X_h))\n$$\n问题陈述 $\\operatorname{Var}(G(X_h)) \\leq c_{v}$。我们假设此界限为了优化的目的可以代表方差，因此 $\\operatorname{Var}(G(X_h)) \\approx c_{v}$。于是，\n$$\n\\operatorname{Var}(\\widehat{\\mu}_{n,h}) \\approx \\frac{c_{v}}{n}\n$$\n\n结合这些项，MSE 作为 $n$ 和 $h$ 的函数为：\n$$\n\\mathrm{MSE}(n,h) = c_{b}^2 h^{2p} + \\frac{c_{v}}{n}\n$$\n\n该优化受固定计算预算 $\\mathcal{B}$ 的约束。成本函数为 $C(n,h) = \\kappa \\frac{n}{h}$。约束条件是成本等于预算：\n$$\n\\kappa \\frac{n}{h} = \\mathcal{B}\n$$\n\n我们可以利用该约束将 $n$ 表示为 $h$ 的函数：\n$$\nn = \\frac{\\mathcal{B} h}{\\kappa}\n$$\n将此代入 MSE 表达式中以消去变量 $n$，得到一个仅依赖于 $h$ 的目标函数：\n$$\nf(h) \\equiv \\mathrm{MSE}(h) = c_{b}^2 h^{2p} + \\frac{c_{v}}{\\frac{\\mathcal{B} h}{\\kappa}} = c_{b}^2 h^{2p} + \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-1}\n$$\n\n为了找到最小化此函数的最优步长 $h^{\\star}$，我们计算 $f(h)$ 关于 $h$ 的导数并将其设为零：\n$$\n\\frac{df}{dh} = \\frac{d}{dh} \\left( c_{b}^2 h^{2p} + \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-1} \\right) = 2p c_{b}^2 h^{2p-1} - \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-2}\n$$\n将导数设为零，得到：\n$$\n2p c_{b}^2 (h^{\\star})^{2p-1} = \\frac{c_{v} \\kappa}{\\mathcal{B}} (h^{\\star})^{-2}\n$$\n求解 $h^{\\star}$：\n$$\n(h^{\\star})^{2p+1} = \\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\n$$\n$$\nh^{\\star} = \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n为确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^2f}{dh^2} = 2p(2p-1) c_{b}^2 h^{2p-2} + 2 \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-3}\n$$\n由于 $p0$，$c_b0$，$c_v0$，$\\kappa0$，$\\mathcal{B}0$ 且 $h0$，第二项恒为正。如果 $p \\ge 1/2$，第一项非负。如果 $0  p  1/2$，第一项为负，但平衡偏差和方差的问题通常是针对 $p \\ge 1/2$ 的方法提出的（例如，Euler-Maruyama 法，其中 $p=1$）。然而，即使对于 $0  p  1/2$，由一阶必要条件 $2p c_{b}^2 (h^{\\star})^{2p} = \\frac{c_{v} \\kappa}{\\mathcal{B} h^{\\star}}$ 得到的最小值条件也能保证二阶导数为正：$\\frac{d^2f}{dh^2} |_{h=h^*} = (2p-1)\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3} + 2\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3} = (2p+1)\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3}  0$。因此，$h^{\\star}$ 对应一个局部最小值。\n\n接下来，我们将 $h^{\\star}$ 代入约束方程，求出最优样本数 $n^{\\star}$：\n$$\nn^{\\star} = \\frac{\\mathcal{B}}{\\kappa} h^{\\star} = \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n\n最后，我们通过将 $h^{\\star}$ 和 $n^{\\star}$ 代入 MSE 表达式来求得最小化的均方误差 $\\mathrm{MSE}^{\\star}$。一个关键的洞见来自一阶条件，该条件表明在最优点，方差项和偏差平方项是相关的。令 $B^2(h) = c_{b}^2 h^{2p}$ 和 $V(n) = c_{v}/n$。条件 $2p c_{b}^2 (h^{\\star})^{2p-1} = \\frac{c_{v} \\kappa}{\\mathcal{B}} (h^{\\star})^{-2}$ 两边乘以 $h^\\star$ 得到 $2p c_{b}^2 (h^{\\star})^{2p} = \\frac{c_{v} \\kappa}{\\mathcal{B} h^{\\star}}$。这等价于 $2p B^2(h^{\\star}) = V(n^{\\star})$。\n因此，最小 MSE 为：\n$$\n\\mathrm{MSE}^{\\star} = B^2(h^{\\star}) + V(n^{\\star}) = B^2(h^{\\star}) + 2p B^2(h^{\\star}) = (1+2p) B^2(h^{\\star})\n$$\n将 $h^{\\star}$ 的表达式代入其中：\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 (h^{\\star})^{2p} = (1+2p) c_{b}^2 \\left[ \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} \\right]^{2p}\n$$\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$\n为了便于展示，可以将其简化为：\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) (c_{b}^2)^{1 - \\frac{2p}{2p+1}} \\left(\\frac{c_{v} \\kappa}{2p \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}} = (1+2p) (c_b^2)^{\\frac{1}{2p+1}} \\left(\\frac{c_v \\kappa}{2p \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$\n一个等价的优美形式是：\n$$\n\\mathrm{MSE}^{\\star} = \\frac{1+2p}{2p} V(n^\\star) = \\frac{1+2p}{2p} \\left(\\frac{c_v \\kappa}{\\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}(2p c_b^2)^{\\frac{1}{2p+1}}\n$$\n\n最优参数相对于预算 $\\mathcal{B}$ 的标度关系如下：\n-   $h^{\\star} \\propto \\mathcal{B}^{-\\frac{1}{2p+1}}$。随着预算增加，最优时间步长减小，从而可以减小偏差。\n-   $n^{\\star} \\propto \\mathcal{B} \\cdot h^{\\star} \\propto \\mathcal{B} \\cdot \\mathcal{B}^{-\\frac{1}{2p+1}} = \\mathcal{B}^{\\frac{2p}{2p+1}}$。随着预算增加，最优样本数量增加，从而可以减小方差。\n-   $\\mathrm{MSE}^{\\star} \\propto \\mathcal{B}^{-\\frac{2p}{2p+1}}$。随着预算增加，可达到的最小误差减小。这种减小的速率由指数 $\\frac{2p}{2p+1}$ 决定，并随着方法阶数 $p$ 的增加而提高。对于大的 $p$，误差的标度关系近似为 $\\mathcal{B}^{-1}$。\n\n最优量的最终表达式为：\n$$\nh^{\\star} = \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n$$\nn^{\\star} = \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} h^{\\star} = \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} \\\\ n^{\\star} = \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} \\\\ \\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}} \\end{pmatrix}}\n$$", "id": "3292367"}]}