{"hands_on_practices": [{"introduction": "在实际应用中，我们常常需要处理标准概率分布的变体，例如当数据生成过程排除了某些结果时。本练习探讨零截断泊松分布，这是一种在建模中排除零值观测时产生的常见分布。通过这个练习，你将从第一性原理出发，推导该分布的关键性质，并构建一个基于逆变换法的模拟器，这是随机模拟中最基本也是最核心的抽样技术之一。[@problem_id:3296921]", "problem": "设 $X$ 是一个参数为 $\\lambda \\in (0,\\infty)$ 的 $\\mathrm{Poisson}(\\lambda)$ 随机变量，并设 $Y$ 表示在零点截断得到的条件随机变量，$Y := X \\mid X > 0$，这被称为零截断泊松分布。从 $\\mathrm{Poisson}(\\lambda)$ 分布的概率质量函数 (pmf) 的基本定义，$P(X = k)$（对于整数 $k \\geq 0$），以及离散随机变量的条件概率定义出发。推导 $Y$ 在支撑集 $\\{1,2,3,\\dots\\}$ 上的 pmf，然后推导其均值 $\\mathbb{E}[Y]$ 作为 $\\lambda$ 的闭式函数。接着，描述一个基于反演的模拟器，该模拟器使用逆变换采样 (ITS) 方法，通过单个 $(0,1)$ 上的 $\\mathrm{Uniform}$ 随机变量和对原始泊松分布的累积分布函数 (CDF) 的顺序累加，来生成一个来自 $Y$ 的样本；明确说明用于反演的截断 CDF 以及用于实现截断而与原始泊松 CDF 进行比较的变换后阈值，并论证该构造为何是正确的。作为最终答案，提供 $\\mathbb{E}[Y]$ 关于 $\\lambda$ 的闭式表达式。", "solution": "### Y的PMF推导\n设 $X$ 是一个服从参数为 $\\lambda > 0$ 的泊松分布的随机变量。其概率质量函数 (pmf) 由下式给出：\n$$ P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} \\quad \\text{for } k \\in \\{0, 1, 2, \\dots\\} $$\n随机变量 $Y$ 定义为 $Y := X \\mid X > 0$。$Y$ 的支撑集是正整数集合 $\\{1, 2, 3, \\dots\\}$。$Y$ 的 pmf，记为 $P(Y=k)$，可以使用条件概率的定义推导。对于任何整数 $k \\geq 1$：\n$$ P(Y=k) = P(X=k \\mid X > 0) = \\frac{P(X=k \\text{ and } X>0)}{P(X>0)} $$\n由于 $Y$ 的支撑集是 $k \\geq 1$，事件 $\\{X=k\\}$ 是事件 $\\{X>0\\}$ 的一个子集。因此，这些事件的交集就是 $\\{X=k\\}$。表达式简化为：\n$$ P(Y=k) = \\frac{P(X=k)}{P(X>0)} $$\n分母 $P(X>0)$ 计算为 $1 - P(X=0)$。对于泊松分布：\n$$ P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda) $$\n因此，$P(X>0) = 1 - \\exp(-\\lambda)$。将此代入 $Y$ 的 pmf 表达式中，我们得到：\n$$ P(Y=k) = \\frac{\\frac{\\lambda^k \\exp(-\\lambda)}{k!}}{1 - \\exp(-\\lambda)} = \\frac{\\lambda^k \\exp(-\\lambda)}{k! (1 - \\exp(-\\lambda))} \\quad \\text{for } k \\in \\{1, 2, 3, \\dots\\} $$\n这就是零截断泊松分布的 pmf。\n\n### Y的均值推导\n$Y$ 的均值（或期望），记为 $\\mathbb{E}[Y]$，是通过将每个可能值 $k$ 与其对应的概率 $P(Y=k)$ 的乘积在 $Y$ 的支撑集上求和来计算的：\n$$ \\mathbb{E}[Y] = \\sum_{k=1}^{\\infty} k \\cdot P(Y=k) = \\sum_{k=1}^{\\infty} k \\cdot \\frac{\\lambda^k \\exp(-\\lambda)}{k! (1 - \\exp(-\\lambda))} $$\n我们可以将常数项从求和中提出：\n$$ \\mathbb{E}[Y] = \\frac{\\exp(-\\lambda)}{1 - \\exp(-\\lambda)} \\sum_{k=1}^{\\infty} k \\frac{\\lambda^k}{k!} $$\n对于 $k \\geq 1$，我们可以简化求和内的项：$k/k! = 1/(k-1)!$。\n$$ \\mathbb{E}[Y] = \\frac{\\exp(-\\lambda)}{1 - \\exp(-\\lambda)} \\sum_{k=1}^{\\infty} \\frac{\\lambda^k}{(k-1)!} $$\n我们可以从求和中提出一个 $\\lambda$：\n$$ \\mathbb{E}[Y] = \\frac{\\exp(-\\lambda)}{1 - \\exp(-\\lambda)} \\lambda \\sum_{k=1}^{\\infty} \\frac{\\lambda^{k-1}}{(k-1)!} $$\n令 $j = k-1$。当 $k$ 从 $1$ 趋于 $\\infty$ 时，$j$ 从 $0$ 趋于 $\\infty$。求和变为：\n$$ \\sum_{j=0}^{\\infty} \\frac{\\lambda^j}{j!} $$\n这是 $\\exp(\\lambda)$ 的泰勒级数展开。因此，该和等于 $\\exp(\\lambda)$。\n将此结果代回 $\\mathbb{E}[Y]$ 的表达式中：\n$$ \\mathbb{E}[Y] = \\frac{\\exp(-\\lambda)}{1 - \\exp(-\\lambda)} \\cdot \\lambda \\exp(\\lambda) = \\frac{\\lambda \\exp(-\\lambda)\\exp(\\lambda)}{1 - \\exp(-\\lambda)} = \\frac{\\lambda}{1 - \\exp(-\\lambda)} $$\n这就是零截断泊松分布均值的闭式表达式。\n\n### 基于反演的Y模拟器\n逆变换采样 (ITS) 方法通过将其累积分布函数 (CDF) 的逆函数应用于一个均匀随机变量来从一个随机变量生成样本。设 $U \\sim \\mathrm{Uniform}(0,1)$。来自 $Y$ 的一个样本 $y$ 由 $y = F_Y^{-1}(U)$ 给出，其中 $F_Y$ 是 $Y$ 的 CDF，且 $F_Y^{-1}(u) = \\min\\{k \\in \\{1,2,\\dots\\} : F_Y(k) \\geq u\\}$。\n\n首先，我们将 $Y$ 的 CDF，$F_Y(k) = P(Y \\leq k)$，用 $X$ 的 CDF，$F_X(k) = P(X \\leq k)$ 来表示。对于 $k \\in \\{1, 2, 3, \\dots\\}$：\n$$ F_Y(k) = P(X \\leq k \\mid X>0) = \\frac{P(1 \\leq X \\leq k)}{P(X>0)} $$\n分子可以写成 $P(X \\leq k) - P(X=0) = F_X(k) - F_X(0)$。分母是 $1 - P(X=0) = 1 - F_X(0)$。\n因此，$F_Y(k) = \\frac{F_X(k) - F_X(0)}{1 - F_X(0)}$。\n\n要使用逆变换法生成 $Y$ 的一个样本，我们首先生成一个均匀随机数 $U \\sim \\mathrm{Uniform}(0,1)$，然后找到最小的整数 $y \\ge 1$ 使得 $F_Y(y) \\ge U$。\n$$ \\frac{F_X(y) - F_X(0)}{1 - F_X(0)} \\ge U $$\n$$ F_X(y) \\ge F_X(0) + U(1 - F_X(0)) $$\n令 $U' = F_X(0) + U(1 - F_X(0))$。由于 $U$ 在 $(0,1)$ 上均匀分布，因此 $U'$ 在 $(F_X(0), 1)$ 即 $(\\exp(-\\lambda), 1)$ 上均匀分布。\n该算法可以描述如下：\n1. 生成一个随机数 $U \\sim \\mathrm{Uniform}(0,1)$。\n2. 计算变换后的阈值 $U' = \\exp(-\\lambda) + U \\cdot (1 - \\exp(-\\lambda))$。\n3. 从 $k=1$ 开始，按顺序累加原始泊松分布的概率 $P(X=k)$，并计算其累积分布函数 $F_X(k) = \\sum_{i=0}^k P(X=i)$。\n4. 找到满足 $F_X(k) \\ge U'$ 的最小整数 $k$。这个 $k$ 就是来自零截断泊松分布的一个样本。\n\n此构造是正确的，因为它有效地将区间 $(0,1)$ 上的均匀样本 $U$ 映射到区间 $(\\exp(-\\lambda), 1)$ 上的均匀样本 $U'$，然后使用这个 $U'$ 来反演*未截断*的泊松CDF $F_X$。这等价于直接反演截断的CDF $F_Y$，但避免了为截断分布重新计算概率和CDF的需要，而是复用了原始分布的CDF计算过程。", "answer": "$$\n\\boxed{\\frac{\\lambda}{1 - \\exp(-\\lambda)}}\n$$", "id": "3296921"}, {"introduction": "蒙特卡洛估计的精度直接受其方差的影响，而减小方差是提高模拟效率的关键。本练习介绍一种强大而经典的方差缩减技术——控制变量法。我们将从最基本的伯努利试验出发，推导如何利用一个相关且已知均值的随机变量来显著降低估计量的方差，从而让你深入理解方差缩减的核心思想。[@problem_id:3296919]", "problem": "考虑从 $\\mathrm{Uniform}(0,1)$ 分布中进行一次抽样 $U$ 以及一个固定参数 $p \\in (0,1)$。定义伯努利随机变量 $X=\\mathbf{1}\\{U \\le p\\}$ 和控制变量 $g(U)=U$，其期望 $\\mathbb{E}[g(U)]$ 是已知的。定义控制变量估计量\n$$\nZ_{c} \\;=\\; X \\;-\\; c\\big(g(U)-\\mathbb{E}[g(U)]\\big).\n$$\n从期望、方差和协方差的定义出发，且不使用任何预先推导的控制变量公式，推导以下两项，并以 $p$ 的闭式函数形式表示：\n- 最小化 $\\mathrm{Var}(Z_{c})$ 的最优控制系数 $c^{\\star}$；\n- 相应的方差缩减因子，定义为比率 $\\mathrm{Var}(Z_{c^{\\star}})/\\mathrm{Var}(X)$。\n\n将你的最终答案表示为两个关于 $p$ 的闭式解析表达式。无需进行数值舍入。", "solution": "控制变量估计量由下式给出\n$$\nZ_{c} \\;=\\; X \\;-\\; c\\big(g(U)-\\mathbb{E}[g(U)]\\big)\n$$\n其中 $X = \\mathbf{1}\\{U \\le p\\}$，$U \\sim \\mathrm{Uniform}(0,1)$，$p \\in (0,1)$，控制变量为 $g(U)=U$。我们的目标是找到使 $Z_{c}$ 方差最小化的系数 $c$ 的值，记为 $c^{\\star}$，然后求出相应的方差缩减因子。\n\n首先，我们使用方差算子的性质来表示 $Z_{c}$ 的方差。令 $Y = g(U) = U$。估计量为 $Z_c = X - c(Y - \\mathbb{E}[Y])$。\n$$\n\\mathrm{Var}(Z_c) = \\mathrm{Var}\\left(X - c(Y - \\mathbb{E}[Y])\\right)\n$$\n使用恒等式 $\\mathrm{Var}(A - B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) - 2\\mathrm{Cov}(A, B)$，我们有：\n$$\n\\mathrm{Var}(Z_c) = \\mathrm{Var}(X) + \\mathrm{Var}\\left(c(Y - \\mathbb{E}[Y])\\right) - 2\\mathrm{Cov}\\left(X, c(Y - \\mathbb{E}[Y])\\right)\n$$\n使用性质 $\\mathrm{Var}(aZ) = a^2\\mathrm{Var}(Z)$ 和 $\\mathrm{Cov}(Z_1, aZ_2) = a\\mathrm{Cov}(Z_1, Z_2)$，上式变为：\n$$\n\\mathrm{Var}(Z_c) = \\mathrm{Var}(X) + c^2\\mathrm{Var}(Y - \\mathbb{E}[Y]) - 2c\\mathrm{Cov}(X, Y - \\mathbb{E}[Y])\n$$\n由于对于任意常数 $k$，都有 $\\mathrm{Var}(Y - k) = \\mathrm{Var}(Y)$ 和 $\\mathrm{Cov}(X, Y - k) = \\mathrm{Cov}(X,Y)$，表达式简化为：\n$$\n\\mathrm{Var}(Z_c) = \\mathrm{Var}(X) + c^2\\mathrm{Var}(Y) - 2c\\mathrm{Cov}(X, Y)\n$$\n这是一个关于 $c$ 的二次函数。为了求最小值，我们对 $c$ 求导并令其等于 $0$：\n$$\n\\frac{d}{dc}\\mathrm{Var}(Z_c) = 2c\\mathrm{Var}(Y) - 2\\mathrm{Cov}(X, Y)\n$$\n为求最优系数 $c^{\\star}$，将导数设为 $0$：\n$$\n2c^{\\star}\\mathrm{Var}(Y) - 2\\mathrm{Cov}(X, Y) = 0 \\implies c^{\\star} = \\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(Y)}\n$$\n为了求出 $c^{\\star}$ 的具体值，我们必须计算 $\\mathrm{Var}(Y)$ 和 $\\mathrm{Cov}(X, Y)$。\n\n1.  **控制变量 $Y=U$ 的矩**：\n    由于 $U \\sim \\mathrm{Uniform}(0,1)$，其概率密度函数为 $f_U(u) = 1$，$u \\in [0,1]$。\n    期望为 $\\mathbb{E}[Y] = \\mathbb{E}[U] = \\int_0^1 u \\cdot 1 \\,du = \\frac{1}{2}$。\n    方差为 $\\mathrm{Var}(Y) = \\mathrm{Var}(U) = \\mathbb{E}[U^2] - (\\mathbb{E}[U])^2$。\n    $\\mathbb{E}[U^2] = \\int_0^1 u^2 \\cdot 1 \\,du = \\frac{1}{3}$。\n    所以，$\\mathrm{Var}(Y) = \\frac{1}{3} - (\\frac{1}{2})^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}$。\n\n2.  **估计量 $X = \\mathbf{1}\\{U \\le p\\}$ 的矩**：\n    $X$ 是一个伯努利随机变量，因为如果事件 $\\{U \\le p\\}$ 发生，它取值为 $1$，否则取值为 $0$。\n    成功的概率为 $\\mathbb{P}(X=1) = \\mathbb{P}(U \\le p) = \\int_0^p 1 \\,du = p$。\n    因此，$X \\sim \\mathrm{Bernoulli}(p)$。\n    期望为 $\\mathbb{E}[X] = p$。\n    方差为 $\\mathrm{Var}(X) = p(1-p)$。\n\n3.  $X$ **与** $Y$ **的协方差**：\n    $\\mathrm{Cov}(X, Y) = \\mathrm{Cov}(X, U) = \\mathbb{E}[XU] - \\mathbb{E}[X]\\mathbb{E}[U]$。\n    我们需要计算 $\\mathbb{E}[XU] = \\mathbb{E}[\\mathbf{1}\\{U \\le p\\} \\cdot U]$。\n    使用无意识统计学家法则：\n    $$\n    \\mathbb{E}[XU] = \\int_0^1 (\\mathbf{1}\\{u \\le p\\} \\cdot u) f_U(u) \\,du = \\int_0^1 \\mathbf{1}\\{u \\le p\\} \\cdot u \\,du = \\int_0^p u \\,du\n    $$\n    $$\n    \\mathbb{E}[XU] = \\left[\\frac{u^2}{2}\\right]_0^p = \\frac{p^2}{2}\n    $$\n    现在，我们可以计算协方差：\n    $$\n    \\mathrm{Cov}(X, Y) = \\frac{p^2}{2} - (p)\\left(\\frac{1}{2}\\right) = \\frac{p^2 - p}{2} = -\\frac{p(1-p)}{2}\n    $$\n\n4.  **最优系数** $c^{\\star}$：\n    将计算出的方差和协方差代入 $c^{\\star}$ 的表达式中：\n    $$\n    c^{\\star} = \\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(Y)} = \\frac{-p(1-p)/2}{1/12} = -\\frac{p(1-p)}{2} \\cdot 12 = -6p(1-p)\n    $$\n    这是第一个要求的表达式。\n\n接下来，我们推导方差缩减因子 $\\mathrm{Var}(Z_{c^{\\star}})/\\mathrm{Var}(X)$。\n首先，我们将 $c^{\\star}$ 代回方差公式，求出最小方差 $\\mathrm{Var}(Z_{c^{\\star}})$：\n$$\n\\mathrm{Var}(Z_{c^{\\star}}) = \\mathrm{Var}(X) + (c^{\\star})^2\\mathrm{Var}(Y) - 2c^{\\star}\\mathrm{Cov}(X, Y)\n$$\n$$\n\\mathrm{Var}(Z_{c^{\\star}}) = \\mathrm{Var}(X) + \\left(\\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(Y)}\\right)^2\\mathrm{Var}(Y) - 2\\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(Y)}\\mathrm{Cov}(X, Y)\n$$\n$$\n\\mathrm{Var}(Z_{c^{\\star}}) = \\mathrm{Var}(X) + \\frac{\\mathrm{Cov}(X, Y)^2}{\\mathrm{Var}(Y)} - 2\\frac{\\mathrm{Cov}(X, Y)^2}{\\mathrm{Var}(Y)} = \\mathrm{Var}(X) - \\frac{\\mathrm{Cov}(X, Y)^2}{\\mathrm{Var}(Y)}\n$$\n这个结果可以用相关系数的平方 $\\rho_{XY}^2 = \\frac{\\mathrm{Cov}(X,Y)^2}{\\mathrm{Var}(X)\\mathrm{Var}(Y)}$ 来表示。\n$$\n\\mathrm{Var}(Z_{c^{\\star}}) = \\mathrm{Var}(X) - \\frac{\\rho_{XY}^2 \\mathrm{Var}(X)\\mathrm{Var}(Y)}{\\mathrm{Var}(Y)} = \\mathrm{Var}(X)(1 - \\rho_{XY}^2)\n$$\n因此，方差缩减因子为：\n$$\n\\frac{\\mathrm{Var}(Z_{c^{\\star}})}{\\mathrm{Var}(X)} = 1 - \\rho_{XY}^2\n$$\n现在我们使用先前推导出的量来计算 $\\rho_{XY}^2$：\n$$\n\\rho_{XY}^2 = \\frac{\\mathrm{Cov}(X, Y)^2}{\\mathrm{Var}(X)\\mathrm{Var}(Y)} = \\frac{\\left(-\\frac{p(1-p)}{2}\\right)^2}{p(1-p) \\cdot \\frac{1}{12}} = \\frac{\\frac{p^2(1-p)^2}{4}}{\\frac{p(1-p)}{12}}\n$$\n假设 $p \\in (0,1)$，则有 $p \\neq 0$ 且 $1-p \\neq 0$，因此我们可以简化：\n$$\n\\rho_{XY}^2 = \\frac{p^2(1-p)^2}{4} \\cdot \\frac{12}{p(1-p)} = 3p(1-p)\n$$\n最后，方差缩减因子为：\n$$\n\\frac{\\mathrm{Var}(Z_{c^{\\star}})}{\\mathrm{Var}(X)} = 1 - 3p(1-p)\n$$\n注意，由于 $p \\in (0,1)$，项 $p(1-p)$ 在 $p=1/2$ 时取得最大值 $1/4$。因此，$0  \\rho_{XY}^2 \\le 3/4$，这确保了 $1/4 \\le 1 - \\rho_{XY}^2  1$，证实了方差确实严格减小了。\n\n这两个闭式表达式是 $c^{\\star} = -6p(1-p)$ 和方差缩减因子 $1 - 3p(1-p)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -6p(1-p)  1 - 3p(1-p) \\end{pmatrix}}\n$$", "id": "3296919"}, {"introduction": "当目标事件的发生概率极低时，标准的蒙特卡洛方法会变得非常低效，甚至不可行。本练习将引导你应用重要性抽样这一高级技巧来解决罕见事件的估计问题。你将学习如何通过指数倾斜来设计一个新的、更优的抽样分布，使得罕见事件得以频繁发生，并利用似然比修正估计，从而高效地计算二项分布的尾部概率。[@problem_id:3296986]", "problem": "考虑独立同分布的 Bernoulli 随机变量 $X_{1},\\dots,X_{n}$，其参数为 $p\\in(0,1)$，使得 $\\mathbb{P}(X_{i}=1)=p$ 且 $\\mathbb{P}(X_{i}=0)=1-p$。令 $S_{n}=\\sum_{i=1}^{n}X_{i}$ 表示参数为 $n$ 和 $p$ 的二项计数。固定一个整数阈值 $a\\in\\{0,1,\\dots,n\\}$，满足 $anp$，从而使得上尾概率 $\\mathbb{P}(S_{n}\\ge a)$ 是一个稀有事件。任务是构建一个基于指数倾斜的重要性抽样 (IS) 方案，以高效地估计 $\\mathbb{P}(S_{n}\\ge a)$。\n\n仅从以下基础要素出发：\n- Bernoulli 分布和二项分布的定义，\n- 使用 Radon–Nikodym 导数（似然比）的 Monte Carlo (MC) 估计和重要性抽样 (IS) 的定义，\n- 独立随机变量之和的矩生成函数 (MGF) 和累积量生成函数 (CGF)，\n\n推导一个指数倾斜的测度变换，该变换将 $p$ 替换为一个新参数 $p^{\\star}\\in(0,1)$。在此新测度下，样本从参数为 $p^{\\star}$ 的独立同分布 Bernoulli 模型中抽取，并且 IS 估计量使用相应的似然比来保持对 $\\mathbb{P}(S_{n}\\ge a)$ 的无偏性。具体来说：\n\n- 推导似然比，其为实现计数值 $s$（对于给定样本，$s=S_{n}$）、$n$、$p$ 和 $p^{\\star}$ 的函数。\n- 使用累积量生成函数和指数倾斜原理，推导 $p^{\\star}$ 的选择，使得 $S_{n}$ 的倾斜均值等于阈值 $a$。在独立同分布 Bernoulli 倾斜类中，该选择渐进地最小化了估计 $\\mathbb{P}(S_{n}\\ge a)$ 的方差增长率。\n\n你的最终答案必须是单一的闭式解析表达式。将你的最终答案表示为行矩阵 $\\begin{pmatrix}p^{\\star}  L(s)\\end{pmatrix}$ 的形式，其中 $p^{\\star}$ 用 $n$ 和 $a$ 表示，$L(s)$ 是仅用 $n$、$p$、$a$ 和 $s$ 表示的似然比。不需要四舍五入，也不涉及物理单位。", "solution": "### 重要性抽样方案的推导\n\n令 $\\mathbb{P}_{p}$ 表示概率测度，在此测度下，每个 $X_{i}$ 都是成功概率为 $p$ 的独立 Bernoulli 试验。特定结果序列 $\\mathbf{x} = (x_{1}, \\dots, x_{n})$ 的概率质量函数 (PMF) 仅取决于成功的总次数 $s = \\sum_{i=1}^{n} x_{i}$。在 $\\mathbb{P}_{p}$ 下，此 PMF 由下式给出：\n$$f(\\mathbf{x}; p) = \\prod_{i=1}^{n} p^{x_{i}} (1-p)^{1-x_{i}} = p^{s} (1-p)^{n-s}$$\n\n目标是估计 $P_a = \\mathbb{P}_{p}(S_{n} \\ge a) = \\mathbb{E}_{p}[\\mathbf{1}_{\\{S_{n} \\ge a\\}}]$，其中 $\\mathbf{1}_{\\{\\cdot\\}}$ 是指示函数。当 $P_a$ 很小时，用于此数量的朴素 Monte Carlo 估计器会存在高方差问题。\n\n重要性抽样涉及将基础概率测度从 $\\mathbb{P}_{p}$ 更改为一个新测度 $\\mathbb{P}_{p^{\\star}}$，在新测度下，稀有事件更有可能发生。问题规定，在 $\\mathbb{P}_{p^{\\star}}$ 下，变量 $X_{i}$ 仍然是 i.i.d. Bernoulli 变量，但使用新参数 $p^{\\star}$。序列 $\\mathbf{x}$ 在 $\\mathbb{P}_{p^{\\star}}$ 下的 PMF 为：\n$$f(\\mathbf{x}; p^{\\star}) = (p^{\\star})^{s} (1-p^{\\star})^{n-s}$$\n\n为确保估计量保持无偏，每个样本必须通过似然比（或 Radon-Nikodym 导数）$L(\\mathbf{x}) = \\frac{d\\mathbb{P}_{p}}{d\\mathbb{P}_{p^{\\star}}}(\\mathbf{x})$ 进行加权。该比率由下式给出：\n$$L(\\mathbf{x}) = \\frac{f(\\mathbf{x}; p)}{f(\\mathbf{x}; p^{\\star})} = \\frac{p^{s} (1-p)^{n-s}}{(p^{\\star})^{s} (1-p^{\\star})^{n-s}}$$\n这可以简化为和 $s$ 的函数：\n$$L(s) = \\left(\\frac{p}{p^{\\star}}\\right)^{s} \\left(\\frac{1-p}{1-p^{\\star}}\\right)^{n-s}$$\n该表达式是所需推导的第一部分，给出了用 $s, n, p, p^{\\star}$ 表示的似然比。\n\n接下来，我们必须确定 $p^{\\star}$ 的最优选择。问题指导我们使用指数倾斜原理，并选择 $p^{\\star}$ 使得在新测度 $\\mathbb{P}_{p^{\\star}}$ 下 $S_{n}$ 的均值等于阈值 $a$。\n\n单个 Bernoulli($p$) 随机变量 $X$ 的累积量生成函数 (CGF) 是 $K_{X}(\\theta) = \\ln(\\mathbb{E}_{p}[e^{\\theta X}])$。\n$$\\mathbb{E}_{p}[e^{\\theta X}] = e^{\\theta \\cdot 1} \\mathbb{P}_{p}(X=1) + e^{\\theta \\cdot 0} \\mathbb{P}_{p}(X=0) = p e^{\\theta} + 1-p$$\n因此，$K_{X}(\\theta) = \\ln(p e^{\\theta} + 1-p)$。\n\n对于 $n$ 个 i.i.d. 变量之和 $S_{n} = \\sum_{i=1}^{n} X_{i}$，CGF 为 $K_{S_{n}}(\\theta) = n K_{X}(\\theta) = n \\ln(p e^{\\theta} + 1-p)$。\n\n使用参数 $\\theta$ 的指数倾斜定义了一个新的概率测度 $\\mathbb{P}_{\\theta}$，其中结果 $x_i$ 的概率与 $e^{\\theta x_i} \\mathbb{P}_p(X_i=x_i)$ 成正比。对于一个 Bernoulli 变量，新的成功概率（我们将其等同于 $p^\\star$）是：\n$$p^{\\star} = \\mathbb{P}_{\\theta}(X=1) = \\frac{e^{\\theta \\cdot 1} \\mathbb{P}_{p}(X=1)}{\\mathbb{E}_{p}[e^{\\theta X}]} = \\frac{p e^{\\theta}}{p e^{\\theta} + 1-p}$$\n这建立了指数倾斜参数 $\\theta$ 和新 Bernoulli 参数 $p^{\\star}$ 之间的联系。\n\n指数倾斜分布的一个关键性质是，倾斜随机变量的均值是 CGF 的导数。在倾斜测度下（我们称之为 $\\mathbb{E}_{p^{\\star}}$），$S_{n}$ 的均值为：\n$$\\mathbb{E}_{p^{\\star}}[S_{n}] = \\frac{d}{d\\theta} K_{S_{n}}(\\theta) = n \\frac{d}{d\\theta} \\ln(p e^{\\theta} + 1-p) = n \\frac{p e^{\\theta}}{p e^{\\theta} + 1-p}$$\n观察 $p^{\\star}$ 的表达式，我们看到 $\\mathbb{E}_{p^{\\star}}[S_{n}] = n p^{\\star}$。这证实了 Binomial($n, p^{\\star}$) 分布的均值确实是 $np^{\\star}$。\n\n问题规定了选择新参数的条件：新测度下的均值必须等于阈值 $a$。\n$$\\mathbb{E}_{p^{\\star}}[S_{n}] = a$$\n代入均值的表达式，我们得到：\n$$n p^{\\star} = a$$\n解出 $p^{\\star}$，得到最优参数选择：\n$$p^{\\star} = \\frac{a}{n}$$\n这是所求的用 $n$ 和 $a$ 表示的 $p^{\\star}$ 的表达式。问题约束 $p^\\star \\in (0,1)$ 和 $anp$ 与此选择一致，因为 $a/n  p$，确保了分布确实向稀有事件区域“倾斜”。\n\n最后，我们将这个特定的 $p^{\\star}$ 值代入通用的似然比表达式 $L(s)$ 中，以获得答案所需的最终形式。\n$$L(s) = \\left(\\frac{p}{p^{\\star}}\\right)^{s} \\left(\\frac{1-p}{1-p^{\\star}}\\right)^{n-s} = \\left(\\frac{p}{a/n}\\right)^{s} \\left(\\frac{1-p}{1-a/n}\\right)^{n-s}$$\n简化此表达式可得：\n$$L(s) = \\left(\\frac{np}{a}\\right)^{s} \\left(\\frac{1-p}{(n-a)/n}\\right)^{n-s} = \\left(\\frac{np}{a}\\right)^{s} \\left(\\frac{n(1-p)}{n-a}\\right)^{n-s}$$\n这就是仅用 $n$、$p$、$a$ 和实现计数值 $s$ 表示的似然比，符合要求。\n\n两个结果是 $p^{\\star} = \\frac{a}{n}$ 和 $L(s) = \\left(\\frac{np}{a}\\right)^{s} \\left(\\frac{n(1-p)}{n-a}\\right)^{n-s}$。我们以指定的矩阵格式呈现它们。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{a}{n}  \\left(\\frac{np}{a}\\right)^{s} \\left(\\frac{n(1-p)}{n-a}\\right)^{n-s}\n\\end{pmatrix}\n}\n$$", "id": "3296986"}]}