{"hands_on_practices": [{"introduction": "线性同余生成器（LCG）是伪随机数生成的基础，但其生成的序列远非真正随机。本练习将引导你通过一个具体的例子，从第一性原理出发，揭示出这些伪随机点实际上受限于少数几个平行的超平面上 [@problem_id:3309974]。理解这种“晶格结构”是评估和设计高质量生成器的关键第一步。", "problem": "考虑一个线性同余生成器 (LCG)，其定义为递推关系 $X_{n+1} \\equiv a X_{n} + c \\pmod{m}$，用于生成伪随机整数 $X_{n} \\in \\{0,1,\\dots,m-1\\}$。与其关联的归一化序列为 $U_{n} = X_{n}/m$，该序列用于近似从单位区间上的均匀分布中进行的独立抽样。设 $s \\geq 2$ 为一固定值，并构造 $s$ 维点 $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1}) \\in [0,1)^{s}$。\n\n仅从模算术以及LCG和归一化的定义出发，推导当 $c=0$ 且 $a  m$ 时，点集 $\\{\\mathbf{U}_{n}\\}$ 所占据的形如 $b \\cdot \\mathbf{U}_{n} = t$ 的 $\\mathbb{R}^{s}$ 中不同平行仿射超平面（余维为1的子集）的确切数量。其中 $b = (a, -1, 0, \\dots, 0)$，而 $t$ 的取值范围由生成器的算术运算决定。您的推导必须解释这些超平面为何出现，并确定在所有可能的种子 $X_{0} \\in \\{0,1,\\dots,m-1\\}$ 下，$t$ 所能取到的不同值的精确数量。\n\n然后，设 $s=3$ 且LCG参数为 $m = 13$, $a = 5$ 和 $c = 0$。通过对所有 $X_{n} \\in \\{0,1,\\dots,12\\}$ 进行穷举，确定 $a U_{n} - U_{n+1}$ 所取不同值的集合并计数，从而对您的理论计数进行经验性验证。最后，给出在这些参数下，三维点集 $\\{\\mathbf{U}_{n}\\}$ 所占据的形如 $a U_{n} - U_{n+1} = t$ 的不同平行仿射超平面的确切数量。请将您的最终答案以单个实数值形式给出。无需四舍五入。", "solution": "该问题陈述已经过验证，被确定为伪随机数生成器数学分析领域中一个定义明确且具有科学依据的问题。它没有任何内部矛盾、歧义或事实错误。因此，我们可以进行形式化的求解。\n\n该问题要求得到两个主要结果：首先，对一种特定类型的线性同余生成器（LCG）所生成的点所在的超平面数量进行一般性推导；其次，对给定的一组参数，对此结果进行经验性验证。\n\n**第一部分：一般性理论推导**\n\n给定一个线性同余生成器，其递推关系定义为：\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m}$$\n问题指定了加法常数 $c=0$ 的情况。递推关系简化为：\n$$X_{n+1} \\equiv a X_{n} \\pmod{m}$$\n$X_n$ 的值是集合 $\\{0, 1, \\dots, m-1\\}$ 中的整数。根据这些整数，通过 $U_n = X_n / m$ 生成一个归一化的实数序列 $U_n$。这些值落在区间 $[0, 1)$ 内。随后，构造 $s$ 维向量 $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1})$。\n\n我们被要求通过考察点集 $\\{\\mathbf{U}_n\\}$ 所占据的仿射超平面来研究其几何结构。该超平面族由方程 $b \\cdot \\mathbf{U}_{n} = t$ 定义，其中法向量为 $b = (a, -1, 0, \\dots, 0)$。其点积为：\n$$b \\cdot \\mathbf{U}_{n} = a U_n + (-1) U_{n+1} + \\sum_{i=2}^{s-1} 0 \\cdot U_{n+i} = a U_n - U_{n+1}$$\n因此，超平面的方程为：\n$$a U_n - U_{n+1} = t$$\n我们的目标是找出当 $X_n$ 取遍所有可能值 $\\{0, 1, \\dots, m-1\\}$ 时，$t$ 可以取到的不同值的数量。\n\n我们将 $U_n$ 和 $U_{n+1}$ 的定义用 $X_n$ 和 $X_{n+1}$ 代入：\n$$t = a \\frac{X_n}{m} - \\frac{X_{n+1}}{m} = \\frac{a X_n - X_{n+1}}{m}$$\n根据 LCG 递推关系 $X_{n+1} \\equiv a X_n \\pmod{m}$，我们知道 $a X_n - X_{n+1}$ 必须是 $m$ 的整数倍。让我们明确地写出这一点。模运算符的定义意味着存在一个整数（我们称之为 $k_n$），使得：\n$$a X_n = k_n m + X_{n+1}$$\n其中 $X_{n+1}$ 是 $a X_n$ 除以 $m$ 的余数。整数 $k_n$ 是该除法的商，可以用向下取整函数表示：\n$$k_n = \\left\\lfloor \\frac{a X_n}{m} \\right\\rfloor$$\n整理方程 $a X_n = k_n m + X_{n+1}$ 可得 $a X_n - X_{n+1} = k_n m$。\n\n现在我们将其代回到 $t$ 的表达式中：\n$$t = \\frac{k_n m}{m} = k_n$$\n这是一个关键的洞见：定义不同超平面的 $t$ 值，恰好是 LCG 算术运算生成的整数值 $k_n$。为了求出不同超平面的数量，我们必须求出当 $X_n$ 遍历所有可能性时，$k_n = \\lfloor \\frac{a X_n}{m} \\rfloor$ 所能取到的不同值的数量。问题指定我们考虑所有可能的种子 $X_0 \\in \\{0, 1, \\dots, m-1\\}$，这意味着我们必须考虑所有可能的状态 $X_n \\in \\{0, 1, \\dots, m-1\\}$。\n\n我们来分析当 $X_n \\in \\{0, 1, \\dots, m-1\\}$ 时，$k_n$ 的取值范围。\n向下取整函数的参数是 $\\frac{a X_n}{m}$。\n最小值在 $X_n=0$ 时取得：\n$$k_{\\min} = \\left\\lfloor \\frac{a \\cdot 0}{m} \\right\\rfloor = \\lfloor 0 \\rfloor = 0$$\n最大值在 $X_n=m-1$ 时取得：\n$$k_{\\max} = \\left\\lfloor \\frac{a (m-1)}{m} \\right\\rfloor = \\left\\lfloor \\frac{am - a}{m} \\right\\rfloor = \\left\\lfloor a - \\frac{a}{m} \\right\\rfloor$$\n问题陈述 $a$ 是整数且 $a  m$。这意味着 $0  \\frac{a}{m}  1$。因此，$a-1  a - \\frac{a}{m}  a$。该值的向下取整为：\n$$k_{\\max} = a-1$$\n$k_n$ 的值是从最小值为 $0$ 到最大值为 $a-1$ 的整数。我们还必须确认 $0$ 和 $a-1$ 之间的所有整数值都可以取到。如果存在一个 $X_n \\in \\{0, 1, \\dots, m-1\\}$ 使得 $\\lfloor \\frac{a X_n}{m} \\rfloor = j$，那么整数 $j$ 就在 $k_n$ 的可能值集合中。这等价于条件 $j \\le \\frac{a X_n}{m}  j+1$，即 $\\frac{jm}{a} \\le X_n  \\frac{(j+1)m}{a}$。$X_n$ 的这个区间的长度为 $\\frac{m}{a}$。由于 $a  m$，该长度大于 $1$，保证了区间内至少存在一个整数 $X_n$。因此，从 $0$到 $a-1$ 的所有整数 $j$ 确实都是 $k_n$ 的可能值。\n\n$t$ 的所有可能值的集合是 $\\{0, 1, \\dots, a-1\\}$。不同值的数量为 $(a-1) - 0 + 1 = a$。", "answer": "$$\n\\boxed{5}\n$$", "id": "3309974"}, {"introduction": "在大规模蒙特卡洛模拟中，将一个伪随机数序列分割给多个并行的处理器使用是一项常见需求。本练习将推导并应用线性同余生成器（LCG）的“向前跳跃”（skip-ahead）公式，它允许我们直接计算序列中远处的某个成员，而无需迭代计算中间的所有值 [@problem_id:3310000]。掌握这项技术对于实现可重复且高效的并行随机数生成至关重要。", "problem": "考虑定义在模 $m$ 整数环 $\\mathbb{Z}_m$ 上的线性同余生成器（LCG），其递推关系为 $X_{n+1} \\equiv a X_n + c \\pmod{m}$，其中参数 $a \\in \\mathbb{Z}_m$，$c \\in \\mathbb{Z}_m$ 为固定值，且 $m \\geq 2$。其对应的均匀分布随机变量序列为 $U_n = X_n / m$。从此定义和 $\\mathbb{Z}_m$ 的代数性质出发，推导一个用 $X_n$、$a$、$c$、$t$ 和 $m$ 表示 $X_{n+t}$ 的闭式表达式，推导过程不假定 $a$、$c$ 或 $m$ 具有任何特殊的数论性质。然后，仅使用第一性原理推导和环代数，解释如何通过结合 $\\mathbb{Z}_m$ 中的平方求幂与模逆元（当其存在时，即当 $\\gcd(a-1, m) = 1$ 时）以 $\\mathcal{O}(\\log t)$ 的时间复杂度高效地计算跳跃后的 $X_{n+t}$。如果 $\\gcd(a-1, m) \\neq 1$，解释一种避免在 $\\mathbb{Z}_m$ 中进行除法的替代方法。\n\n最后，将你的推导和方法应用于具体实例：$m = 1009$，$a = 7$，$c = 11$，初始状态 $X_0 = 123$，跳跃长度 $t = 20$。计算满足 $0 \\leq X_{20}  m$ 的 $X_{20}$ 的确切值，并报告这个整数。无需四舍五入，最终答案不涉及单位。", "solution": "该问题要求推导线性同余生成器（LCG）的闭式表达式，解释其高效计算方法，并进行一次具体计算。\n\n首先，我们推导 $X_{n+t}$ 的闭式表达式。LCG 由递推关系 $X_{k+1} \\equiv a X_k + c \\pmod{m}$（对于 $k \\ge 0$）定义。我们可以从状态 $X_n$ 开始展开这个递推关系。\n当 $t=1$ 时：\n$X_{n+1} \\equiv a X_n + c \\pmod{m}$\n\n当 $t=2$ 时：\n$X_{n+2} \\equiv a X_{n+1} + c \\equiv a(a X_n + c) + c \\equiv a^2 X_n + ac + c \\pmod{m}$\n\n当 $t=3$ 时：\n$X_{n+3} \\equiv a X_{n+2} + c \\equiv a(a^2 X_n + ac + c) + c \\equiv a^3 X_n + a^2 c + ac + c \\pmod{m}$\n\n一个模式浮现出来。对于一个通用整数 $t \\ge 1$，表达式似乎是：\n$$X_{n+t} \\equiv a^t X_n + c(a^{t-1} + a^{t-2} + \\dots + a + 1) \\pmod{m}$$\n使用求和符号可以更紧凑地写成：\n$$X_{n+t} \\equiv a^t X_n + c \\sum_{i=0}^{t-1} a^i \\pmod{m}$$\n我们用数学归纳法对 $t$ 证明这个公式。当 $t=1$ 时的基础情形是 $X_{n+1} \\equiv a^1 X_n + c \\sum_{i=0}^{0} a^i \\equiv a X_n + c a^0 \\equiv aX_n + c$，这正是 LCG 的定义。\n假设该公式对某个整数 $k \\ge 1$ 成立：$X_{n+k} \\equiv a^k X_n + c \\sum_{i=0}^{k-1} a^i \\pmod{m}$。\n我们接着证明它对 $k+1$ 也成立：\n\\begin{align*} X_{n+k+1}  \\equiv a X_{n+k} + c \\\\  \\equiv a \\left( a^k X_n + c \\sum_{i=0}^{k-1} a^i \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( a \\sum_{i=0}^{k-1} a^i \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( \\sum_{i=0}^{k-1} a^{i+1} \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( \\sum_{j=1}^{k} a^j + 1 \\right) \\\\  \\equiv a^{k+1} X_n + c \\sum_{j=0}^{k} a^j \\pmod{m}\\end{align*}\n该公式对 $k+1$ 成立，因此根据数学归纳法原理，对于任何 $t \\ge 1$，$X_{n+t}$ 的闭式表达式为：\n$$X_{n+t} \\equiv a^t X_n + c \\sum_{i=0}^{t-1} a^i \\pmod{m}$$\n这个表达式仅使用递推定义和 $\\mathbb{Z}_m$ 的环性质推导得出，不依赖于 $a$、$c$ 或 $m$ 的任何特殊性质。\n\n接下来，我们解释如何以 $\\mathcal{O}(\\log t)$ 的时间复杂度高效地计算 $X_{n+t}$。计算需要求值 $a^t \\pmod{m}$ 和等比数列和 $S_t = \\sum_{i=0}^{t-1} a^i \\pmod{m}$。\n\n情况 1：$\\gcd(a-1, m) = 1$。\n在这种情况下，元素 $(a-1)$ 在环 $\\mathbb{Z}_m$ 中存在乘法逆元，记为 $(a-1)^{-1}$。有限等比级数的和有一个众所周知的公式，该公式在任何分母可逆的环中都成立：\n$$\\sum_{i=0}^{t-1} a^i = (a^t - 1)(a-1)^{-1}$$\n将此代入闭式表达式得到：\n$$X_{n+t} \\equiv a^t X_n + c (a^t - 1)(a-1)^{-1} \\pmod{m}$$\n计算过程如下：\n1. 计算 $A = a^t \\pmod{m}$。这可以使用快速幂算法（平方求幂）在 $\\mathcal{O}(\\log t)$ 时间内高效完成。\n2. 计算 $B = (a-1)^{-1} \\pmod{m}$。这可以通过扩展欧几里得算法找到，其时间复杂度为 $\\mathcal{O}(\\log m)$。\n3. 使用模运算组合最终结果：$X_{n+t} \\equiv A \\cdot X_n + c \\cdot (A - 1) \\cdot B \\pmod{m}$。这些是常数次操作。\n主要开销是模幂运算，因此总时间复杂度为 $\\mathcal{O}(\\log t+\\log m)$，由于在跳跃计算中 $t$ 是我们关心的变量，通常简化为 $\\mathcal{O}(\\log t)$。\n\n情况 2：$\\gcd(a-1, m) \\neq 1$。\n在这种情况下，$(a-1)$ 模 $m$ 不可逆，等比数列和的分数形式公式不能直接使用。我们必须使用一种替代方法。通过增广状态向量，递推关系可以表示为矩阵形式：\n$$\\begin{pmatrix} X_{k+1} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} X_k \\\\ 1 \\end{pmatrix}$$\n这是对增广状态向量的一个线性变换。将此变换应用 $t$ 次可得：\n$$\\begin{pmatrix} X_{n+t} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix}^t \\begin{pmatrix} X_n \\\\ 1 \\end{pmatrix}$$\n问题简化为计算 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix}$ 的 $t$ 次幂。这可以使用矩阵的快速幂算法在 $\\mathcal{O}(\\log t)$ 时间内完成。$M^t$ 的元素可以通过归纳法得到：\n$$M^t = \\begin{pmatrix} a^t  c \\sum_{i=0}^{t-1} a^i \\\\ 0  1 \\end{pmatrix}$$\n因此，执行矩阵快速幂可以同时计算 $a^t$ 和 $c \\sum_{i=0}^{t-1} a^i$，而无需任何模除法。快速幂算法中的每一步都涉及一次 $2 \\times 2$ 矩阵乘法，这包括在 $\\mathbb{Z}_m$ 中的 $8$ 次整数乘法和 $4$ 次整数加法。因此，总复杂度为 $\\mathcal{O}(\\log t)$。这种方法是通用的，适用于任何参数 $a, c, m$。\n\n最后，我们将其应用于具体实例：$m = 1009$，$a = 7$，$c = 11$，$X_0 = 123$，$t = 20$。我们需要计算 $X_{20}$。\n首先，我们检查使用更简单方法（情况 1）的条件。我们计算 $\\gcd(a-1, m) = \\gcd(7-1, 1009) = \\gcd(6, 1009)$。因为 $1009$ 不能被 $2$ 整除（它是奇数），也不能被 $3$ 整除（其数字和为 $1+0+0+9=10$），所以我们有 $\\gcd(6, 1009) = 1$。因此，我们可以使用涉及模逆元的方法。\n\n公式为 $X_{20} \\equiv a^{20} X_0 + c (a^{20} - 1)(a-1)^{-1} \\pmod m$。\n\n1. 计算 $a^{20} \\pmod m$，即 $7^{20} \\pmod{1009}$。我们使用快速幂算法。$t=20$ 的二进制表示是 $10100_2$，所以 $20 = 16+4$。\n$7^1 \\equiv 7 \\pmod{1009}$\n$7^2 \\equiv 49 \\pmod{1009}$\n$7^4 \\equiv 49^2 = 2401 \\equiv 2 \\cdot 1009 + 383 \\equiv 383 \\pmod{1009}$\n$7^8 \\equiv 383^2 = 146689 \\equiv 145 \\cdot 1009 + 384 \\equiv 384 \\pmod{1009}$\n$7^{16} \\equiv 384^2 = 147456 \\equiv 146 \\cdot 1009 + 142 \\equiv 142 \\pmod{1009}$\n$7^{20} = 7^{16} \\cdot 7^4 \\equiv 142 \\cdot 383 = 54386 \\equiv 53 \\cdot 1009 + 909 \\equiv 909 \\pmod{1009}$。\n\n2. 计算 $(a-1)^{-1} \\pmod m$，即 $6^{-1} \\pmod{1009}$。我们对 $1009$ 和 $6$ 使用扩展欧几里得算法。\n$1009 = 168 \\cdot 6 + 1$\n重新整理得到贝祖等式：$1 = 1009 - 168 \\cdot 6$。\n将此方程模 $1009$，我们得到 $1 \\equiv -168 \\cdot 6 \\pmod{1009}$。\n所以，$6^{-1} \\equiv -168 \\equiv -168 + 1009 \\equiv 841 \\pmod{1009}$。\n\n3. 组合结果来计算 $X_{20}$。\n$X_{20} \\equiv 7^{20} \\cdot X_0 + 11 \\cdot (7^{20} - 1) \\cdot 6^{-1} \\pmod{1009}$\n$X_{20} \\equiv 909 \\cdot 123 + 11 \\cdot (909 - 1) \\cdot 841 \\pmod{1009}$\n$X_{20} \\equiv 909 \\cdot 123 + 11 \\cdot 908 \\cdot 841 \\pmod{1009}$\n\n分别计算这两项：\n第一项：$909 \\cdot 123 = 111807$。\n$111807 = 110 \\cdot 1009 + 817$。所以，$909 \\cdot 123 \\equiv 817 \\pmod{1009}$。\n\n第二项：$11 \\cdot 908 \\cdot 841 \\pmod{1009}$。\n$11 \\cdot 908 = 9988$。$9988 = 9 \\cdot 1009 + 907$。所以，$11 \\cdot 908 \\equiv 907 \\pmod{1009}$。\n现在计算 $907 \\cdot 841 = 762787$。\n$762787 = 755 \\cdot 1009 + 992$。所以，$907 \\cdot 841 \\equiv 992 \\pmod{1009}$。\n\n最后，将两项相加：\n$X_{20} \\equiv 817 + 992 \\pmod{1009}$\n$X_{20} \\equiv 1809 \\pmod{1009}$\n$X_{20} \\equiv 1 \\cdot 1009 + 800 \\pmod{1009}$\n$X_{20} \\equiv 800 \\pmod{1009}$\n\n$X_{20}$ 的值是 $800$。", "answer": "$$\\boxed{800}$$", "id": "3310000"}, {"introduction": "从一个随机整数生成一个在 $[0,1]$ 区间上的均匀分布浮点数，是随机数生成流程的最后一步，但其中充满了微妙的陷阱。本练习探讨了两种不同的整数到浮点数映射方案，并分析它们产生边界值（$0$ 或 $1$）的概率差异 [@problem_id:3309936]。你将发现，一个看似无害的选择可能会在后续的统计应用（如逆变换采样）中导致灾难性的后果，例如生成无穷大的数值。", "problem": "伪随机数生成器 (PRNG) 产生独立同分布的比特。考虑使用两种基于 $b=53$ 位精度的整数到浮点数映射方案，来生成单位区间上均匀分布的浮点数近似。这种精度通常用于填充双精度浮点数的尾数。\n\n- 方案 A（右开区间离散化）：从离散集合 $\\{0,1,2,\\ldots,2^{53}-1\\}$ 中均匀采样 $I$，并设 $U_{A} = I / 2^{53}$。\n- 方案 B（闭区间离散化）：从离散集合 $\\{0,1,2,\\ldots,2^{53}\\}$ 中均匀采样 $J$，并设 $U_{B} = J / 2^{53}$。\n\n你将分析在每种方案下生成边界值 $U=0$ 和 $U=1$ 的确切概率，然后评估这些概率对重尾分布的逆变换采样的影响。\n\n设 $F$ 为帕累托分布的累积分布函数，其尾指数为 $\\alpha  0$，尺度参数为 $x_{m}  0$，即：\n$$\nF(x) =\n\\begin{cases}\n0,  x  x_{m},\\\\[4pt]\n1 - \\left(\\dfrac{x_{m}}{x}\\right)^{\\alpha},  x \\ge x_{m}.\n\\end{cases}\n$$\n在逆变换采样中，设 $X = F^{-1}(U)$，其中 $U$ 在 $[0,1]$ 上均匀分布。\n\n从有限集上的离散均匀分布和逆变换方法的定义出发，完成以下任务：\n\n1. 推导 $P(U_{A} = 0)$、$P(U_{A} = 1)$、$P(U_{B} = 0)$ 和 $P(U_{B} = 1)$。\n2. 仅使用上述帕累托累积分布函数的定义，推导对于 $u \\in [0,1]$ 的 $F^{-1}(u)$，并确定在每种方案下 $X$ 为无穷大的确切概率，即 $P(X = +\\infty)$。\n3. 现假设你在方案 B 下生成了 $N = 10^{12}$ 个独立变量 $U_{B}^{(1)},\\ldots,U_{B}^{(N)}$，并将每个变量转换为 $X^{(i)} = F^{-1}(U_{B}^{(i)})$。计算其中至少有一个 $X^{(i)}$ 为 $+\\infty$ 的概率。将你最终的数值答案四舍五入到四位有效数字。\n\n你的最终答案必须是第 3 项中要求的单个数值，按规定四舍五入，不带单位。", "solution": "本题要求分析两种为单位区间上的均匀随机变量生成离散近似值的方案，以及它们对帕累托分布逆变换采样的影响。解答按要求分为三个部分。\n\n### 第 1 部分：边界值的概率\n\n设 $b=53$。\n\n**方案 A（右开区间离散化）**\n\n在方案 A 下，从集合 $\\mathcal{I} = \\{0, 1, 2, \\ldots, 2^{b}-1\\}$ 中均匀抽取一个随机整数 $I$。该集合的大小为 $|\\mathcal{I}| = 2^{b}$。$I$ 的概率质量函数为 $P(I=i) = \\frac{1}{2^{b}}$，适用于任何 $i \\in \\mathcal{I}$。随机变量为 $U_{A} = I / 2^{b}$。\n\n我们确定生成边界值 $0$ 和 $1$ 的概率。\n\n-   **生成 $U_{A}=0$ 的概率**：\n    事件 $U_{A}=0$ 发生当且仅当 $I=0$。由于 $0 \\in \\mathcal{I}$，该事件是可能发生的。其概率为：\n    $$P(U_{A}=0) = P(I=0) = \\frac{1}{2^{b}} = \\frac{1}{2^{53}}$$\n\n-   **生成 $U_{A}=1$ 的概率**：\n    事件 $U_{A}=1$ 发生当且仅当 $I/2^{b}=1$，这意味着 $I=2^{b}$。然而，集合 $\\mathcal{I}$ 中的最大值是 $2^{b}-1$。因此，$I=2^{b}$ 是一个不可能事件。\n    $$P(U_{A}=1) = P(I=2^{b}) = 0$$\n\n**方案 B（闭区间离散化）**\n\n在方案 B 下，从集合 $\\mathcal{J} = \\{0, 1, 2, \\ldots, 2^{b}\\}$ 中均匀抽取一个随机整数 $J$。该集合的大小为 $|\\mathcal{J}| = 2^{b}+1$。$J$ 的概率质量函数为 $P(J=j) = \\frac{1}{2^{b}+1}$，适用于任何 $j \\in \\mathcal{J}$。随机变量为 $U_{B} = J / 2^{b}$。\n\n我们确定生成边界值 $0$ 和 $1$ 的概率。\n\n-   **生成 $U_{B}=0$ 的概率**：\n    事件 $U_{B}=0$ 发生当且仅当 $J=0$。由于 $0 \\in \\mathcal{J}$，该事件是可能发生的。其概率为：\n    $$P(U_{B}=0) = P(J=0) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n-   **生成 $U_{B}=1$ 的概率**：\n    事件 $U_{B}=1$ 发生当且仅当 $J/2^{b}=1$，这意味着 $J=2^{b}$。由于 $2^{b} \\in \\mathcal{J}$，该事件是可能发生的。其概率为：\n    $$P(U_{B}=1) = P(J=2^{b}) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n### 第 2 部分：逆累积分布函数和无穷大概率\n\n首先，我们推导帕累托分布的逆累积分布函数 $F^{-1}(u)$。其累积分布函数 (CDF) 为 $F(x) = 1 - (x_{m}/x)^{\\alpha}$，适用于 $x \\ge x_{m}$。我们设 $u = F(x)$，其中 $u$ 在 $F$ 的值域 $[0, 1)$ 内，然后解出 $x$：\n$$u = 1 - \\left(\\frac{x_{m}}{x}\\right)^{\\alpha}$$\n$$\\left(\\frac{x_{m}}{x}\\right)^{\\alpha} = 1 - u$$\n$$\\frac{x_{m}}{x} = (1 - u)^{1/\\alpha}$$\n$$x = \\frac{x_{m}}{(1 - u)^{1/\\alpha}} = x_{m}(1-u)^{-1/\\alpha}$$\n因此，对于 $u \\in [0, 1)$，逆累积分布函数为 $F^{-1}(u) = x_{m}(1-u)^{-1/\\alpha}$。\n\n题目要求考虑 $u \\in [0, 1]$。我们必须检验在 $u=1$ 处的行为。当 $u \\to 1^{-}$ 时，项 $(1-u) \\to 0^{+}$，因此 $(1-u)^{-1/\\alpha} \\to +\\infty$，因为 $\\alpha > 0$。因此，通常定义 $F^{-1}(1) = +\\infty$。\n\n使用逆变换方法从帕累托分布中采样得到的值 $X = F^{-1}(U)$ 将为无穷大，当且仅当均匀变量 $U$ 恰好为 $1$。因此，概率 $P(X=+\\infty)$ 等于概率 $P(U=1)$。\n\n现在我们可以使用第 1 部分的结果来计算每种方案下的这个概率。\n\n-   **方案 A**：\n    $$P(X=+\\infty) = P(U_{A}=1) = 0$$\n\n-   **方案 B**：\n    $$P(X=+\\infty) = P(U_{B}=1) = \\frac{1}{2^{53}+1}$$\n\n这突显了一个关键区别：方案 A 永远不能生成无穷大值，而方案 B 则可以，尽管概率非常小。\n\n### 第 3 部分：至少一个无穷大变量的概率\n\n给定在方案 B 下生成的 $N = 10^{12}$ 个独立变量 $U_{B}^{(i)}$。对于每个 $i \\in \\{1, \\ldots, N\\}$，我们将其转换为 $X^{(i)} = F^{-1}(U_{B}^{(i)})$。我们需要计算这些 $X^{(i)}$ 中至少有一个为 $+\\infty$ 的概率。\n\n设 $E_{i}$ 为事件 $X^{(i)} = +\\infty$。根据第 2 部分的结论，单次试验中此事件的概率为：\n$$p = P(E_{i}) = P(X = +\\infty \\text{ under Scheme B}) = \\frac{1}{2^{53}+1}$$\n这些试验是独立的。至少有一个事件 $E_{i}$ 发生的概率是 $1$ 减去所有事件都不发生的概率。单个事件 $E_{i}$ 不发生的概率是 $1-p$。$N$ 个独立事件全都不发生的概率是 $(1-p)^{N}$。\n\n所求概率为：\n$$P(\\text{at least one } X^{(i)} = +\\infty) = 1 - (1-p)^{N} = 1 - \\left(1 - \\frac{1}{2^{53}+1}\\right)^{10^{12}}$$\n\n这个表达式是精确的。为了计算其数值，我们注意到 $N$ 非常大而 $p$ 非常小。在这种情况下，“成功”（即 $X^{(i)}=+\\infty$ 发生）的次数可以很好地用参数为 $\\lambda = Np$ 的泊松分布来近似。零次成功的概率是 $\\exp(-\\lambda)$。至少一次成功的概率是 $1 - \\exp(-\\lambda)$。这个近似非常精确。\n\n我们来计算 $\\lambda$：\n$$\\lambda = Np = \\frac{10^{12}}{2^{53}+1}$$\n使用 $2^{53} = 9007199254740992$，我们得到：\n$$\\lambda = \\frac{10^{12}}{9007199254740993} \\approx 0.0001110223024625$$\n现在我们计算概率：\n$$P(\\text{at least one } \\infty) \\approx 1 - \\exp(-\\lambda) = 1 - \\exp(-0.0001110223024625)$$\n使用计算器，\n$$P(\\text{at least one } \\infty) \\approx 1 - 0.9998889838318...$$\n$$P(\\text{at least one } \\infty) \\approx 0.00011101616818...$$\n题目要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $1, 1, 1, 0$。第五位有效数字是 $1$，所以我们不对第四位进行进位。\n\n最终的数值是 $0.0001110$。", "answer": "$$\\boxed{0.0001110}$$", "id": "3309936"}]}