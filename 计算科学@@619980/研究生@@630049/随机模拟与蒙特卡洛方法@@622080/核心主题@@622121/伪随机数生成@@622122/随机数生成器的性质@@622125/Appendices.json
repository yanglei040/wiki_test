{"hands_on_practices": [{"introduction": "线性同余生成器 (LCG) 的一个众所周知理论缺陷是，其输出的$k$维向量并非真正随机地分布在单位超立方体中，而是完全落在少数平行超平面上，形成一个规则的晶格结构。这个练习将引导你通过“谱检验”这一基本工具，亲手揭示这种几何结构。你将从一个具体的 LCG 递归关系出发，推导出其对应的晶格基，并利用对偶晶格的概念来计算最大超平面间距，从而量化其非随机性。[@problem_id:3332090]", "problem": "考虑一个由递归式 $x_{n+1} \\equiv a x_{n} + c \\pmod m$ 定义的线性同余生成器 (LCG)，其中 $a \\in \\mathbb{Z}$，$c \\in \\mathbb{Z}$，$m \\in \\mathbb{Z}_{>0}$。定义归一化输出为 $U_{n} = x_{n} / m \\in [0,1)$。对于一个固定的维度 $k \\in \\mathbb{Z}_{\\ge 2}$，考虑 $k$ 维点集 $P_{k} = \\{(U_{n}, U_{n+1}, \\dots, U_{n+k-1}) : n \\in \\mathbb{Z}\\} \\subset [0,1)^{k}$。\n\n在 $m = 31$，$a = 3$，$c = 0$ 和 $k = 3$ 的特定情况下，仅使用LCG、模算术、欧几里得格和对偶格的基本定义，完成以下任务：\n\n1) 推导一个满秩格 $L \\subset \\mathbb{R}^{3}$，该格由一个基矩阵 $B \\in \\mathbb{R}^{3 \\times 3}$ 明确给出，使得从 $P_{3}$ 获得的提升到 $\\mathbb{R}^{3}$ 中的点集位于 $L$ 被 $\\mathbb{Z}^{3}$ 中向量平移后形成的有限并集之内。你的推导必须从定义 $x_{n}$ 的递归式以及当 $c = 0$ 时 $x_{n+j} \\equiv a^{j} x_{n} \\pmod m$ 这个事实开始。\n\n2) 根据对偶格的定义 $L^{\\ast} = \\{h \\in \\mathbb{R}^{3} : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L\\}$，推导出所有整数向量 $h = (h_{1}, h_{2}, h_{3}) \\in \\mathbb{Z}^{3}$ 的明确特征，这些向量通过条件 $h \\cdot u \\in \\mathbb{Z}$ 对所有 $u \\in P_{3}$ 定义了平行超平面族。将此特征表示为 $\\mathbb{Z}/m\\mathbb{Z}$ 中的一个同余式。\n\n3) 在所有满足第2部分同余式的非零 $h \\in \\mathbb{Z}^{3}$ 中，确定一个欧几里得范数最小的向量。然后，利用几何事实——点所在的、与 $h$ 正交的相邻平行超平面之间的距离等于欧几里得范数 $\\|h\\|_{2}$ 的倒数——计算这个维度为 $k=3$ 的LCG可能的最大平面间距。\n\n将你的最终答案表示为该最大距离的单个精确解析表达式。不要对结果进行四舍五入，也不要包含单位。", "solution": "用户希望我解决一个关于线性同余生成器（LCG）几何特性的三部分问题。\n\n### 问题验证\n问题陈述定义了一个特定的乘法LCG，其模数 $m = 31$，乘数 $a = 3$，增量 $c = 0$。任务是分析该生成器产生的 $k=3$ 维点的结构。这包括推导与生成器相关的格，描述其对偶格的特征，并计算谱检验值，即最大超平面间距。\n\n1.  **已知条件提取：**\n    - LCG递归式: $x_{n+1} \\equiv a x_{n} + c \\pmod m$。\n    - 归一化输出: $U_n = x_n/m$。\n    - 点集: $P_k = \\{(U_n, U_{n+1}, \\dots, U_{n+k-1}) : n \\in \\mathbb{Z}\\}$。\n    - 特定参数: $m=31$, $a=3$, $c=0$, $k=3$。\n\n2.  **验证：**\n    - 该问题具有科学依据，植根于准随机数生成的标准理论和谱检验，后者是分析LCG的基本工具。\n    - 问题提法严谨，为获得唯一解提供了所有必要的参数和定义。\n    - 语言客观而精确。\n    - 设置完整、一致且数学上合理。\n\n3.  **结论：**\n    - 问题有效。我将继续进行完整解答。\n\n### 第1部分：格 $L$ 的推导\n\n由LCG生成的点，当按模数 $m$ 缩放时，存在于一个整格中。归一化点集 $P_3 = \\{(U_n, U_{n+1}, U_{n+2})\\}$ 是这个整格经过缩放后的一个子集，模整数向量。\n\n整数状态序列 $(x_n, x_{n+1}, x_{n+2})$ 由递归式 $x_{j+1} \\equiv a x_j \\pmod m$ 生成。对于 $k=3$ 和 $c=0$，这给出了以下关系：\n$x_{n+1} \\equiv 3 x_n \\pmod{31}$\n$x_{n+2} \\equiv 3 x_{n+1} \\pmod{31}$\n\n问题要求找到一个格 $L \\subset \\mathbb{R}^3$。LCG的点 $u_n = (x_n/m, x_{n+1}/m, x_{n+2}/m)$ 已知其位于一个格结构上。我们首先确定整格 $\\Lambda \\subset \\mathbb{Z}^3$，它包含所有满足与LCG状态相同递归关系的整数向量 $y=(y_1, y_2, y_3)$：\n$y_2 \\equiv 3 y_1 \\pmod{31}$\n$y_3 \\equiv 3 y_2 \\pmod{31}$\n\n这个同余方程组定义了整格 $\\Lambda$。我们可以找到 $\\Lambda$ 的一组基。$\\Lambda$ 中的任何向量 $y$ 都可以表示为基向量的整线性组合。\n这些同余式的一个通解可以写成：\n$y_2 = 3y_1 + 31j_1$\n$y_3 = 3y_2 + 31j_2 = 3(3y_1 + 31j_1) + 31j_2 = 9y_1 + 93j_1 + 31j_2$\n其中 $y_1, j_1, j_2$ 是任意整数。\n\n我们可以将 $\\Lambda$ 中的任意向量 $y$ 表示为：\n$y = (y_1, 3y_1 + 31j_1, 9y_1 + 93j_1 + 31j_2)$\n$y = y_1(1, 3, 9) + j_1(0, 31, 93) + j_2(0, 0, 31)$\n这表明向量 $b_1' = (1, 3, 9)$、$b_2' = (0, 31, 93)$ 和 $b_3' = (0, 0, 31)$ 构成了 $\\Lambda$ 的一组基。\n\n问题中描述的格 $L \\subset \\mathbb{R}^3$ 是通过将整格 $\\Lambda$ 缩放因子 $1/m = 1/31$ 得到的。$L$ 的一组基可以通过将 $\\Lambda$ 的基向量缩放 $1/31$ 得到：\n$b_1 = \\frac{1}{31} b_1' = (\\frac{1}{31}, \\frac{3}{31}, \\frac{9}{31})$\n$b_2 = \\frac{1}{31} b_2' = (0, 1, 3)$\n$b_3 = \\frac{1}{31} b_3' = (0, 0, 1)$\n\n$L$ 的基矩阵 $B$ 由这些基向量作为行向量构成：\n$$B = \\begin{pmatrix} \\frac{1}{31} & \\frac{3}{31} & \\frac{9}{31} \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n任何LCG点 $u_n = (\\frac{x_n}{31}, \\frac{x_{n+1}}{31}, \\frac{x_{n+2}}{31})$ 可以证明是 $L$ 中的一个点，并且所有这些点的集合 $P_3$ 是 $L$ 的一个子集。问题中关于“平移的并集”的措辞是关于LCG的一般性陈述，但在这种标准构造中，这些点直接位于 $L$ 中。\n\n### 第2部分：对偶格整数向量的特征描述\n\n对偶格 $L^*$ 定义为 $L^* = \\{ h \\in \\mathbb{R}^3 : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L \\}$。\n$L^*$ 的一组基由矩阵 $B^* = (B^{-1})^T = (B^T)^{-1}$ 的行向量给出。\n我们的基矩阵 $B$ 的转置是：\n$$B^T = \\begin{pmatrix} \\frac{1}{31} & 0 & 0 \\\\ \\frac{3}{31} & 1 & 0 \\\\ \\frac{9}{31} & 3 & 1 \\end{pmatrix}$$\n$B^T$ 的逆矩阵是：\n$$B^* = (B^T)^{-1} = \\begin{pmatrix} 31 & 0 & 0 \\\\ -3 & 1 & 0 \\\\ 0 & -3 & 1 \\end{pmatrix}$$\n$B^*$ 的行向量构成了 $L^*$ 的一组基。$L^*$ 中的任意向量 $h$ 是这些基向量的整线性组合：\n$h = n_1(31, 0, 0) + n_2(-3, 1, 0) + n_3(0, -3, 1)$，其中 $n_1, n_2, n_3$ 为整数。\n\n我们感兴趣的是同时也在 $\\mathbb{Z}^3$ 中的向量 $h = (h_1, h_2, h_3)$。\n$h_1 = 31n_1 - 3n_2$\n$h_2 = n_2 - 3n_3$\n$h_3 = n_3$\n要使 $h$ 成为整数向量，其分量必须是整数。由于 $n_1, n_2, n_3$ 是整数，这总是成立的。我们需要找到一个整数向量 $(h_1, h_2, h_3)$ 能以这种形式表示的条件。\n从上面的方程中，我们可以用分量 $h_i$ 来表示系数 $n_i$：\n$n_3 = h_3$\n$n_2 = h_2 + 3n_3 = h_2 + 3h_3$\n$31n_1 = h_1 + 3n_2 = h_1 + 3(h_2 + 3h_3) = h_1 + 3h_2 + 9h_3$\n为了使 $n_1$ 为整数，等式右边必须能被 $31$ 整除。这给出了整数向量 $h$ 属于 $L^*$ 的充分必要条件：\n$$h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$$\n这就是所要求的明确特征描述。\n\n### 第3部分：最小范数向量与最大平面间距\n\n我们必须找到一个非零整数向量 $h=(h_1, h_2, h_3)$，它满足 $h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$ 并最小化欧几里得范数 $\\|h\\|_2 = \\sqrt{h_1^2 + h_2^2 + h_3^2}$。这等价于最小化范数的平方 $\\|h\\|_2^2 = h_1^2+h_2^2+h_3^2$。\n\n这是一个在由同余式定义的格中的最短向量问题。我们可以通过测试具有小整数分量的向量来搜索解。对于 $h_2$ 和 $h_3$ 的任意选择，$h_1$ 的值受 $h_1 \\equiv -(3h_2 + 9h_3) \\pmod{31}$ 的约束。为了最小化 $|h_1|$，我们选择同余类中绝对值最小的代表元。\n\n我们来测试 $(h_2, h_3)$ 的一些小值：\n- $(h_2,h_3) = (1,0) \\implies h_1 \\equiv -3 \\pmod{31}$。我们选择 $h_1=-3$。向量为 $h=(-3,1,0)$。$\\|h\\|_2^2 = (-3)^2+1^2+0^2 = 10$。\n- $(h_2,h_3) = (0,1) \\implies h_1 \\equiv -9 \\pmod{31}$。我们选择 $h_1=-9$。向量为 $h=(-9,0,1)$。$\\|h\\|_2^2 = (-9)^2+0^2+1^2 = 82$。\n- $(h_2,h_3) = (1,1) \\implies h_1 \\equiv -12 \\pmod{31}$。我们选择 $h_1=-12$。向量为 $h=(-12,1,1)$。$\\|h\\|_2^2 = (-12)^2+1^2+1^2 = 146$。\n- $(h_2,h_3) = (1,-1) \\implies h_1 \\equiv - (3-9) = 6 \\pmod{31}$。我们选择 $h_1=6$。向量为 $h=(6,1,-1)$。$\\|h\\|_2^2 = 6^2+1^2+(-1)^2 = 38$。\n- $(h_2,h_3) = (2,-1) \\implies h_1 \\equiv -(6-9) = 3 \\pmod{31}$。我们选择 $h_1=3$。向量为 $h=(3,2,-1)$。$\\|h\\|_2^2 = 3^2+2^2+(-1)^2 = 14$。\n- $(h_2,h_3) = (3,-1) \\implies h_1 \\equiv -(9-9)=0 \\pmod{31}$。我们选择 $h_1=0$。向量为 $h=(0,3,-1)$。$\\|h\\|_2^2 = 0^2+3^2+(-1)^2 = 10$。\n\n系统性的搜索显示，最小的非零范数平方是 $10$。达到这个最小值的向量包括 $h=(-3,1,0)$ 和 $h=(0,3,-1)$ 等。\n因此，满足条件的非零整数向量 $h$ 的最小欧几里得范数是 $\\|h\\|_{\\text{min}} = \\sqrt{10}$。\n\nLCG的点 $u_n$ 都位于由 $h \\cdot x = j$（$j$ 为整数）定义的平行超平面族上。谱检验的几何解释指出，这些相邻超平面之间的最大距离是这样一个非零整数向量 $h$ 的最小范数的倒数。这个距离是衡量LCG输出“粒度”或“粗糙度”的指标。更小的距离是更理想的。\n\n最大可能的平面间距是：\n$$d_{\\text{max}} = \\frac{1}{\\|h\\|_{\\text{min}}} = \\frac{1}{\\sqrt{10}}$$\n这就是最终答案，一个精确的解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{10}}}$$", "id": "3332090"}, {"introduction": "除了全局的晶格结构，某些类型的 LCG 还存在局部的、同样严重的缺陷。一个经典的例子是模数为$2$的幂的 LCG，尽管其计算效率高，但其产生的序列的低位比特具有极短的周期性，因而表现出高度的可预测性。本练习将指导你从第一性原理出发，严格推导这些比特序列的精确周期，从而从数学上揭示这一著名缺陷的根源。[@problem_id:3332070]", "problem": "考虑一个定义在模2的幂的整数环上的线性同余生成器 (LCG)，其递推关系为\n$$\nX_{n+1} \\equiv a\\,X_n + c \\pmod{2^{w}},\n$$\n其中 $a$ 和 $c$ 是整数，$w \\geq 1$，且 $X_0 \\in \\{0,1,\\dots,2^{w}-1\\}$。假设 $a$ 和 $c$ 满足在环 $\\mathbb{Z}/2^{w}\\mathbb{Z}$ 上模 $2^{w}$ 的 LCG 达到满周期的标准充要条件，即 $c$ 为奇数且 $a \\equiv 1 \\pmod{4}$，因此 $(X_n)$ 的周期等于 $2^{w}$。\n\n通过 $Y_n \\equiv X_n \\pmod{2^{r}}$ 定义截断到 $r$ 个最低有效位，其中 $1 \\leq r \\leq w$，并将 $X_n$ 的第 $k$ 位（最低有效位索引为 $k=0$）定义为 $b_k(n) \\in \\{0,1\\}$，使得\n$$\nX_n \\equiv \\sum_{j=0}^{w-1} b_j(n)\\,2^j, \\quad \\text{所以 } b_k(n) = \\left\\lfloor \\frac{X_n}{2^k} \\right\\rfloor \\bmod 2,\n$$\n对于 $0 \\leq k \\leq r-1$。\n\n从模算术的核心定义和 $\\mathbb{Z}/2^{q}\\mathbb{Z}$ 上 LCG 的结构出发，并仅使用经过充分检验的结果（包括模2的幂的满周期LCG的刻画和2-adic赋值的基本性质），完成以下任务：\n\n- 从第一性原理出发，证明 $(Y_n)$ 是一个模 $2^{r}$ 且具有相同参数 $a$ 和 $c$ 的 LCG。\n- 利用 $a$ 和 $c$ 的结构条件以及 $\\mathbb{Z}/2^{r}\\mathbb{Z}$ 的性质，推导 $(Y_n)$ 的精确周期。\n- 对于固定的位索引 $k$（其中 $0 \\leq k \\leq r-1$），分析在 $\\mathbb{Z}/2^{k+1}\\mathbb{Z}$ 上控制 $b_k(n)$ 的导出映射，并推导位序列 $(b_k(n))$ 的精确周期 $T_k$。您的推导必须是明确的，并且必须清楚地说明为什么低位会表现出短周期。\n- 将您的最终答案表示为 $(Y_n)$ 的周期和 $T_k$ 作为 $k$ 的函数的闭式解析表达式。\n\n不需要进行数值舍入。提供没有单位的最终表达式。对于所要求的多个量，将它们一起以单行矩阵的形式呈现在您的最终答案中。", "solution": "此问题已经过验证。\n\n### 步骤 1：提取已知条件\n-   线性同余生成器 (LCG) 由递推关系 $X_{n+1} \\equiv a\\,X_n + c \\pmod{2^{w}}$ 定义。\n-   参数：$a$ 和 $c$ 是整数，$w \\geq 1$。\n-   初始种子 $X_0$ 属于集合 $\\{0, 1, \\dots, 2^{w}-1\\}$。\n-   假设 LCG 具有 $2^w$ 的满周期。为此给出的充要条件是 $c$ 为奇数且 $a \\equiv 1 \\pmod{4}$。\n-   截断序列定义为 $Y_n \\equiv X_n \\pmod{2^{r}}$，其中 $1 \\leq r \\leq w$。\n-   $X_n$ 的第 $k$ 位定义为 $b_k(n) \\in \\{0,1\\}$，使得 $X_n \\equiv \\sum_{j=0}^{w-1} b_j(n)\\,2^j$，这等价于 $b_k(n) = \\lfloor \\frac{X_n}{2^k} \\rfloor \\bmod 2$，对于 $0 \\leq k \\leq r-1$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础**：该问题涉及对线性同余生成器的分析，这是数论和计算机科学中的一个标准课题。所提供的模2的幂的满周期LCG的条件，$a \\equiv 1 \\pmod{4}$ 和 $c$ 为奇数，是经典结果（例如，由 D. E. Knuth 提出）。该问题牢固地建立在已有的数学原理之上。\n2.  **适定性**：该问题陈述清晰，包含了所有必要的定义和约束。它要求推导特定量（派生序列的周期），这些量是定义明确的数学对象。预期会有一个唯一解。\n3.  **客观性**：该问题以精确、客观的数学语言陈述，没有主观或模糊的术语。\n4.  **完整性和一致性**：该问题是自洽的。LCG、截断序列和位序列的定义清晰且一致。对 $a$ 和 $c$ 的约束与所断言的 $2^w$ 满周期是一致的。\n5.  **其他缺陷**：该问题没有表现出任何其他缺陷，例如非形式化、不切实际、不适定或过于简单。所要求的分析虽然基于标准技术，但并非微不足道，并且揭示了此类生成器的重要结构特性。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个完整且有理有据的解答。\n\n### 解答推导\n\n解答将分三部分呈现，对应于问题陈述中指定的任务。\n\n**第1部分：截断序列 $(Y_n)$**\n\n原始的 LCG 由递推关系定义\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^w}\n$$\n该同余式意味着存在一个整数 $k_n$，使得 $X_{n+1} = a X_n + c + k_n 2^w$。\n截断序列定义为 $Y_n = X_n \\pmod{2^r}$，其中 $1 \\leq r \\leq w$。这意味着 $Y_n$ 是 $X_n$ 除以 $2^r$ 的余数。根据定义，$X_n \\equiv Y_n \\pmod{2^r}$。\n为了找到 $(Y_n)$ 的递推关系，我们考虑主递推关系模 $2^r$ 的情况。由于 $r \\leq w$，$2^w$ 是 $2^r$ 的倍数，所以 $2^w \\equiv 0 \\pmod{2^r}$。\n将方程 $X_{n+1} = a X_n + c + k_n 2^w$ 对 $2^r$ 取模，我们得到：\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^r}\n$$\n使用 $Y_n$ 的定义，我们有 $X_{n+1} \\equiv Y_{n+1} \\pmod{2^r}$ 和 $X_n \\equiv Y_n \\pmod{2^r}$。将这些代入同余式中，得到：\n$$\nY_{n+1} \\equiv a Y_n + c \\pmod{2^r}\n$$\n这表明序列 $(Y_n)$ 本身是一个线性同余生成器，具有相同的乘数 $a$ 和增量 $c$，但模数减小为 $2^r$。\n\n**第2部分：$(Y_n)$ 的周期**\n\n我们已经确定 $(Y_n)$ 是一个模为 $2^r$ 的 LCG。这种生成器的周期是最小的正整数 $p > 0$，使得对于所有可能的初始状态 $Y_0$ 和所有 $n \\geq 0$，都有 $Y_{n+p} \\equiv Y_n \\pmod{2^r}$。\n根据 LCG 的标准理论，对于模数为 $2^r$ ($r \\ge 1$) 的 LCG，其达到满周期 $2^r$ 的充要条件是 $c$ 为奇数且 $a \\equiv 1 \\pmod 4$。\n由于问题中给定的原始生成器（模 $2^w$）的参数 $a$ 和 $c$ 满足这些条件，因此对于任何 $1 \\le r \\le w$，这些条件同样成立。因此，序列 $(Y_n)$ 的周期是其模数，即 $2^r$。\n\n**第3部分：位序列 $(b_k(n))$ 的周期**\n\n我们想找到对于固定的 $k$（其中 $0 \\leq k \\leq w-1$），序列 $(b_k(n))$ 的周期 $T_k$。位 $b_k(n)$ 由 $X_n \\pmod{2^{k+1}}$ 的值确定。令 $Y_n^{(j)} = X_n \\pmod{2^j}$。根据第2部分，序列 $(Y_n^{(k+1)})$ 的周期为 $2^{k+1}$。\n位 $b_k(n)$ 由 $b_k(n) = \\lfloor Y_n^{(k+1)}/2^k \\rfloor$ 给出。\n\n我们来分析序列 $(Y_n^{(k+1)})$ 经过 $2^k$ 步的演化。其递推关系为 $Y_{n+1}^{(k+1)} \\equiv a Y_n^{(k+1)} + c \\pmod{2^{k+1}}$。\n将此递推关系迭代 $T = 2^k$ 次，得到：\n$$\nY_{n+2^k}^{(k+1)} \\equiv a^{2^k} Y_n^{(k+1)} + c \\frac{a^{2^k}-1}{a-1} \\pmod{2^{k+1}}\n$$\n我们来分析项 $a^{2^k}$ 和 $\\frac{a^{2^k}-1}{a-1}$ 模 $2^{k+1}$ 的情况。我们使用一个关键引理：如果整数 $a$ 满足 $a \\equiv 1 \\pmod 4$，那么对于任何整数 $n \\geq 1$，有 $v_2(a^n-1) = v_2(a-1) + v_2(n)$，其中 $v_2(z)$ 是 $z$ 的 2-adic 赋值。\n令 $s = v_2(a-1)$。给定 $a \\equiv 1 \\pmod 4$，所以 $s \\ge 2$。\n$v_2(a^{2^k}-1) = v_2(a-1) + v_2(2^k) = s+k$。由于 $s \\ge 2$，有 $s+k \\ge k+2 > k+1$。这意味着 $a^{2^k} \\equiv 1 \\pmod{2^{k+1}}$。\n\n对于第二项，我们有：\n$v_2\\left(\\frac{a^{2^k}-1}{a-1}\\right) = v_2(a^{2^k}-1) - v_2(a-1) = (s+k) - s = k$。\n这意味着 $\\frac{a^{2^k}-1}{a-1} = M \\cdot 2^k$，其中 $M$ 为某个奇整数。\n因此，$c \\frac{a^{2^k}-1}{a-1} = c M 2^k$。由于 $c$ 和 $M$ 都是奇数，它们的乘积 $cM$ 也是奇数。\n所以，$c \\frac{a^{2^k}-1}{a-1} \\equiv 2^k \\pmod{2^{k+1}}$。\n\n将这些发现代回到 $Y_{n+2^k}^{(k+1)}$ 的递推关系中：\n$$\nY_{n+2^k}^{(k+1)} \\equiv 1 \\cdot Y_n^{(k+1)} + 2^k \\pmod{2^{k+1}}\n$$\n这个关系是核心。现在，我们将 $Y_n^{(k+1)}$ 分解为其第 $k$ 位和更低的位：\n$Y_n^{(k+1)} = b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)$。\n关系式变为：\n$$\nb_k(n+2^k) 2^k + (Y_{n+2^k}^{(k+1)} \\bmod 2^k) \\equiv \\left(b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)\\right) + 2^k \\pmod{2^{k+1}}\n$$\n该方程蕴含了模 $2^k$ 的同余关系以及关于 $2^k$ 系数的关系。\n模 $2^k$：$Y_{n+2^k}^{(k+1)} \\bmod 2^k \\equiv Y_n^{(k+1)} \\bmod 2^k$。这意味着 $Y_{n+2^k}^{(k)} \\equiv Y_n^{(k)}$。这与序列 $(Y_n^{(k)})$ 的周期为 $2^k$ 的事实是一致的。\n\n通过比较 $2^k$ 的系数，我们得到一个关于位的关系：\n$$\nb_k(n+2^k) \\equiv b_k(n) + 1 \\pmod 2\n$$\n这表明位 $b_k(n)$ 在 $2^k$ 步后会翻转。因此，位序列 $(b_k(n))$ 的周期不是 $2^k$。为了回到其原始状态，我们必须将此变换应用两次：\n$$\nb_k(n+2 \\cdot 2^k) = b_k(n+2^{k+1}) \\equiv b_k(n+2^k)+1 \\equiv (b_k(n)+1)+1 \\equiv b_k(n) \\pmod 2\n$$\n序列 $(b_k(n))$ 在 $2^{k+1}$ 步后首次重复。其周期不是 $2^k$ 的约数，因此周期必须恰好是 $T_k = 2^{k+1}$。这个结果清楚地说明了为什么模为2的幂的LCG的低位（小的 $k$）具有非常短的周期（$T_0=2$，$T_1=4$ 等），这使得它们不适用于需要高质量随机性的应用。\n\n### 结果总结\n-   截断序列 $(Y_n) = (X_n \\pmod{2^r})$ 的周期是 $2^r$。\n-   第 $k$ 位序列 $(b_k(n))$ 的周期是 $T_k = 2^{k+1}$。", "answer": "$$\\boxed{\\begin{pmatrix} 2^{r} & 2^{k+1} \\end{pmatrix}}$$", "id": "3332070"}, {"introduction": "在分析了生成器的结构性缺陷后，我们需要转向评估其统计质量，其中最基本的属性就是均匀性。星偏差（star discrepancy）$D_{N}^{\\\\ast}$ 是一个衡量有限点集偏离理想均匀分布的严格度量，它量化了经验分布与均匀分布之间的“最坏情况”偏差。这个练习将让你为一个给定的点集计算$D_{N}^{\\\\ast}$，从而将抽象的定义与具体的计算联系起来，并加深对经验累积分布函数及 Kolmogorov-Smirnov 统计量之间关系的理解。[@problem_id:3332021]", "problem": "考虑一个来自单位区间上均匀随机数生成器的有限输出样本，由 $N=8$ 个有序点 $x_{1}, x_{2}, \\dots, x_{N} \\in [0,1]$ 组成，且\n$$\nx_{1} = 0.03,\\quad x_{2} = 0.14,\\quad x_{3} = 0.22,\\quad x_{4} = 0.49,\\quad x_{5} = 0.55,\\quad x_{6} = 0.77,\\quad x_{7} = 0.88,\\quad x_{8} = 0.97.\n$$\n一维点集的星偏差 $D_{N}^{\\ast}$ 定义为在所有锚定区间上，经验含量与勒贝格测度之间绝对偏差的上确界，即\n$$\nD_{N}^{\\ast} \\equiv \\sup_{t \\in [0,1]} \\left| \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\in [0,t) \\} \\;-\\; t \\right|.\n$$\n用于检验 $[0,1]$ 上均匀性的 Kolmogorov–Smirnov 统计量 (KS) 定义为\n$$\n\\sup_{t \\in [0,1]} \\left| F_{N}(t) - t \\right|,\n$$\n其中 $F_{N}(t) \\equiv \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\le t \\}$ 是经验累积分布函数。\n\n仅从这些定义以及 $[0,1]$ 上阶梯函数和勒贝格测度的基本性质出发，通过显式计算在锚定区间 $[0,t)$ 上的上确界，来计算给定样本的 $D_{N}^{\\ast}$，然后将其与同一维度的同一批样本的 Kolmogorov–Smirnov 统计量进行比较。请将您的最终答案表示为等于这两个量的单个精确有理数。", "solution": "此问题经评估是有效的。问题要求计算给定一维点集的星偏差 $D_N^*$ 和 Kolmogorov-Smirnov (KS) 统计量。\n\n对于一维有序点集 $0 \\le x_1 \\le x_2 \\le \\dots \\le x_N \\le 1$，星偏差和KS统计量的值是相同的，其计算公式可以简化为在经验分布函数的所有跳跃点处评估最大偏差：\n$$ D_N^* = K_N = \\max_{i=1,\\dots,N} \\max\\left( \\frac{i}{N} - x_i, x_i - \\frac{i-1}{N} \\right) $$\n我们使用给定的 $N=8$ 个点，并为每个点 $x_i$ 计算 $(\\frac{i}{N} - x_i)$ 和 $(x_i - \\frac{i-1}{N})$：\n- $i=1$: $x_1=0.03$. 偏差为 $\\max(\\frac{1}{8}-0.03, 0.03-\\frac{0}{8}) = \\max(0.125-0.03, 0.03) = \\max(0.095, 0.03) = 0.095$。\n- $i=2$: $x_2=0.14$. 偏差为 $\\max(\\frac{2}{8}-0.14, 0.14-\\frac{1}{8}) = \\max(0.25-0.14, 0.14-0.125) = \\max(0.110, 0.015) = 0.110$。\n- $i=3$: $x_3=0.22$. 偏差为 $\\max(\\frac{3}{8}-0.22, 0.22-\\frac{2}{8}) = \\max(0.375-0.22, 0.22-0.25) = \\max(0.155, -0.03) = 0.155$。\n- $i=4$: $x_4=0.49$. 偏差为 $\\max(\\frac{4}{8}-0.49, 0.49-\\frac{3}{8}) = \\max(0.5-0.49, 0.49-0.375) = \\max(0.010, 0.115) = 0.115$。\n- $i=5$: $x_5=0.55$. 偏差为 $\\max(\\frac{5}{8}-0.55, 0.55-\\frac{4}{8}) = \\max(0.625-0.55, 0.55-0.5) = \\max(0.075, 0.050) = 0.075$。\n- $i=6$: $x_6=0.77$. 偏差为 $\\max(\\frac{6}{8}-0.77, 0.77-\\frac{5}{8}) = \\max(0.75-0.77, 0.77-0.625) = \\max(-0.020, 0.145) = 0.145$。\n- $i=7$: $x_7=0.88$. 偏差为 $\\max(\\frac{7}{8}-0.88, 0.88-\\frac{6}{8}) = \\max(0.875-0.88, 0.88-0.75) = \\max(-0.005, 0.130) = 0.130$。\n- $i=8$: $x_8=0.97$. 偏差为 $\\max(\\frac{8}{8}-0.97, 0.97-\\frac{7}{8}) = \\max(1.0-0.97, 0.97-0.875) = \\max(0.030, 0.095) = 0.095$。\n\n在所有这些偏差中取最大值：\n$$ D_N^* = \\max(0.095, 0.110, 0.155, 0.115, 0.075, 0.145, 0.130, 0.095) = 0.155 $$\n将此十进制数转换为精确分数：\n$$ 0.155 = \\frac{155}{1000} = \\frac{31}{200} $$\n因此，星偏差和 KS 统计量的值均为 $\\frac{31}{200}$。", "answer": "$$ \\boxed{\\frac{31}{200}} $$", "id": "3332021"}]}