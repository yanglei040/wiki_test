{"hands_on_practices": [{"introduction": "第一个练习直击控制变量方法的核心。通过从第一性原理推导最优系数 $c^*$，您将巩固对如何最小化估计量方差的理解，并看到方差的减少如何与目标变量和控制变量之间的相关性直接相关 [@problem_id:3299185]。这是有效应用这种强大的方差缩减技术的基础技能。", "problem": "您正在使用带有控制变量的蒙特卡洛（MC）方法来估计一个实值随机变量 $\\,Y\\,$ 的均值 $\\,\\mu_Y = \\mathbb{E}[Y]\\,$。您观测了 $\\,n\\,$ 次对二元配对 $\\,(Y, X)\\,$ 的独立同分布（i.i.d.）抽样，其中控制均值 $\\,\\mu_X = \\mathbb{E}[X]\\,$ 已知。定义控制变量估计量为 $\\,\\hat{\\mu}_c = \\bar{Y} - c \\left(\\bar{X} - \\mu_X\\right)\\,$，其中 $\\,\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^n Y_i\\,$ 且 $\\,\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n X_i\\,$。假设 $\\,\\operatorname{Var}(Y) = 2\\,$, $\\,\\operatorname{Var}(X) = 3\\,$, 相关系数为 $\\,\\rho = 0.8\\,$, 样本量为 $\\,n = 2000\\,$。\n\n仅从期望的线性性质、i.i.d. 样本均值的方差和协方差定义，以及随机变量线性组合的方差公式出发，推导使 $\\,\\operatorname{Var}(\\hat{\\mu}_c)\\,$ 最小化的最优系数 $\\,c^*\\,$、相应的最小化方差 $\\,\\operatorname{Var}(\\hat{\\mu}_{c^*})\\,$，以及相对于普通样本均值 $\\,\\bar{Y}\\,$ 的方差缩减，其定义为 $\\,1 - \\frac{\\operatorname{Var}(\\hat{\\mu}_{c^*})}{\\operatorname{Var}(\\bar{Y})}\\,$.\n\n给定 $\\,\\rho = 0.8\\,$, $\\,\\operatorname{Var}(Y) = 2\\,$, $\\,\\operatorname{Var}(X) = 3\\,$ 及 $\\,n = 2000\\,$, 数值计算：\n- $\\,c^*\\,$,\n- $\\,\\operatorname{Var}(\\hat{\\mu}_{c^*})\\,$,\n- 方差缩减 $\\,1 - \\frac{\\operatorname{Var}(\\hat{\\mu}_{c^*})}{\\operatorname{Var}(\\bar{Y})}\\,$,\n\n并将您的最终答案以行向量 $\\,\\left(c^*, \\operatorname{Var}(\\hat{\\mu}_{c^*}), \\text{reduction}\\right)\\,$ 的形式报告，四舍五入到四位有效数字。将缩减量表示为小数（不使用百分号）。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 均值 $\\mu_Y = \\mathbb{E}[Y]$ 的估计量：$\\hat{\\mu}_c = \\bar{Y} - c \\left(\\bar{X} - \\mu_X\\right)$\n- 样本均值：$\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^n Y_i$ 和 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n X_i$\n- 抽样：$n$ 次对二元配对 $(Y, X)$ 的独立同分布（i.i.d.）抽样\n- 已知控制均值：$\\mu_X = \\mathbb{E}[X]$\n- $Y$ 的方差：$\\operatorname{Var}(Y) = 2$\n- $X$ 的方差：$\\operatorname{Var}(X) = 3$\n- $Y$ 和 $X$ 的相关系数：$\\rho = 0.8$\n- 样本量：$n = 2000$\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：**该问题牢固地植根于蒙特卡洛方法的理论，特别是使用控制变量进行方差缩减。所有概念——期望、方差、协方差、相关系数和样本均值——都是概率论和统计学中的标准概念。\n- **适定性：**该问题是适定的。它要求推导和计算控制变量估计量的最优系数、得到的方差以及方差缩减。这是一个经典的、可解的问题，具有唯一且有意义的解。\n- **客观性：**该问题使用精确、客观的数学语言进行陈述。\n- **完整性与一致性：**提供了所有必要的数据和定义，且没有矛盾。\n- **现实性与可行性：**问题设置和数值对于典型的模拟情境是现实且可行的。\n\n### 第 3 步：结论与行动\n该问题是有效的。下面是一个完整且合理的解答。\n\n$\\mu_Y = \\mathbb{E}[Y]$ 的控制变量估计量由下式给出\n$$\n\\hat{\\mu}_c = \\bar{Y} - c(\\bar{X} - \\mu_X)\n$$\n其中 $c$ 是一个常数，$\\bar{Y}$ 和 $\\bar{X}$ 是来自 $n$ 个独立同分布观测值 $(Y_i, X_i)$ 的样本均值。控制变量的均值 $\\mu_X = \\mathbb{E}[X]$ 是已知的。\n\n首先，我们证明对于任何 $c$ 的选择，$\\hat{\\mu}_c$ 都是 $\\mu_Y$ 的一个无偏估计量。利用期望的线性性质：\n$$\n\\mathbb{E}[\\hat{\\mu}_c] = \\mathbb{E}[\\bar{Y} - c(\\bar{X} - \\mu_X)] = \\mathbb{E}[\\bar{Y}] - c(\\mathbb{E}[\\bar{X}] - \\mathbb{E}[\\mu_X])\n$$\n因为样本是独立同分布的，所以 $\\mathbb{E}[\\bar{Y}] = \\mu_Y$ 且 $\\mathbb{E}[\\bar{X}] = \\mu_X$。由于 $\\mu_X$ 是一个已知常数，$\\mathbb{E}[\\mu_X] = \\mu_X$。\n$$\n\\mathbb{E}[\\hat{\\mu}_c] = \\mu_Y - c(\\mu_X - \\mu_X) = \\mu_Y\n$$\n该估计量确实是无偏的。我们的目标是找到使该估计量方差最小化的系数 $c^*$。\n\n$\\hat{\\mu}_c$ 的方差是：\n$$\n\\operatorname{Var}(\\hat{\\mu}_c) = \\operatorname{Var}(\\bar{Y} - c(\\bar{X} - \\mu_X))\n$$\n由于 $\\mu_X$ 是一个常数，这等价于：\n$$\n\\operatorname{Var}(\\hat{\\mu}_c) = \\operatorname{Var}(\\bar{Y} - c\\bar{X})\n$$\n使用随机变量线性组合的方差公式 $\\operatorname{Var}(A - B) = \\operatorname{Var}(A) + \\operatorname{Var}(B) - 2\\operatorname{Cov}(A, B)$，我们得到：\n$$\n\\operatorname{Var}(\\hat{\\mu}_c) = \\operatorname{Var}(\\bar{Y}) + \\operatorname{Var}(c\\bar{X}) - 2\\operatorname{Cov}(\\bar{Y}, c\\bar{X})\n$$\n使用方差和协方差的性质 $\\operatorname{Var}(kZ) = k^2\\operatorname{Var}(Z)$ 和 $\\operatorname{Cov}(Z_1, kZ_2) = k\\operatorname{Cov}(Z_1, Z_2)$，上式变为：\n$$\n\\operatorname{Var}(\\hat{\\mu}_c) = \\operatorname{Var}(\\bar{Y}) + c^2\\operatorname{Var}(\\bar{X}) - 2c\\operatorname{Cov}(\\bar{Y}, \\bar{X})\n$$\n接下来，我们用总体矩来表示 $\\operatorname{Var}(\\bar{Y})$、$\\operatorname{Var}(\\bar{X})$ 和 $\\operatorname{Cov}(\\bar{Y}, \\bar{X})$。由于样本 $(Y_i, X_i)$ 是独立同分布的，对于样本均值 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^n Y_i$ 和 $\\bar{X} = \\frac{1}{n}\\sum_{j=1}^n X_j$：\n$$\n\\operatorname{Var}(\\bar{Y}) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{i=1}^n Y_i\\right) = \\frac{1}{n^2} \\sum_{i=1}^n \\operatorname{Var}(Y_i) = \\frac{n\\operatorname{Var}(Y)}{n^2} = \\frac{\\operatorname{Var}(Y)}{n}\n$$\n$$\n\\operatorname{Var}(\\bar{X}) = \\frac{\\operatorname{Var}(X)}{n}\n$$\n$$\n\\operatorname{Cov}(\\bar{Y}, \\bar{X}) = \\operatorname{Cov}\\left(\\frac{1}{n}\\sum_{i=1}^n Y_i, \\frac{1}{n}\\sum_{j=1}^n X_j\\right) = \\frac{1}{n^2} \\sum_{i=1}^n \\sum_{j=1}^n \\operatorname{Cov}(Y_i, X_j)\n$$\n由于配对是独立同分布的，当 $i \\neq j$ 时 $\\operatorname{Cov}(Y_i, X_j)=0$。因此，只有 $i=j$ 的项保留下来：\n$$\n\\operatorname{Cov}(\\bar{Y}, \\bar{X}) = \\frac{1}{n^2} \\sum_{i=1}^n \\operatorname{Cov}(Y_i, X_i) = \\frac{n\\operatorname{Cov}(Y, X)}{n^2} = \\frac{\\operatorname{Cov}(Y, X)}{n}\n$$\n将这些表达式代回 $\\hat{\\mu}_c$ 的方差公式：\n$$\n\\operatorname{Var}(\\hat{\\mu}_c) = \\frac{\\operatorname{Var}(Y)}{n} + c^2\\frac{\\operatorname{Var}(X)}{n} - 2c\\frac{\\operatorname{Cov}(Y, X)}{n} = \\frac{1}{n} \\left( \\operatorname{Var}(Y) - 2c\\operatorname{Cov}(Y, X) + c^2\\operatorname{Var}(X) \\right)\n$$\n这个表达式是关于 $c$ 的一个二次函数。为了找到使该方差最小化的值 $c^*$，我们对 $c$求导并令其为零：\n$$\n\\frac{d}{dc}\\operatorname{Var}(\\hat{\\mu}_c) = \\frac{1}{n} \\left( -2\\operatorname{Cov}(Y, X) + 2c\\operatorname{Var}(X) \\right) = 0\n$$\n$$\n-2\\operatorname{Cov}(Y, X) + 2c^*\\operatorname{Var}(X) = 0\n$$\n解出最优系数 $c^*$：\n$$\nc^* = \\frac{\\operatorname{Cov}(Y, X)}{\\operatorname{Var}(X)}\n$$\n现在我们将 $c^*$ 代回方差表达式，求出最小化方差 $\\operatorname{Var}(\\hat{\\mu}_{c^*})$：\n$$\n\\operatorname{Var}(\\hat{\\mu}_{c^*}) = \\frac{1}{n} \\left( \\operatorname{Var}(Y) - 2 \\frac{\\operatorname{Cov}(Y, X)}{\\operatorname{Var}(X)} \\operatorname{Cov}(Y, X) + \\left(\\frac{\\operatorname{Cov}(Y, X)}{\\operatorname{Var}(X)}\\right)^2 \\operatorname{Var}(X) \\right)\n$$\n$$\n\\operatorname{Var}(\\hat{\\mu}_{c^*}) = \\frac{1}{n} \\left( \\operatorname{Var}(Y) - \\frac{2\\operatorname{Cov}(Y, X)^2}{\\operatorname{Var}(X)} + \\frac{\\operatorname{Cov}(Y, X)^2}{\\operatorname{Var}(X)} \\right)\n$$\n$$\n\\operatorname{Var}(\\hat{\\mu}_{c^*}) = \\frac{1}{n} \\left( \\operatorname{Var}(Y) - \\frac{\\operatorname{Cov}(Y, X)^2}{\\operatorname{Var}(X)} \\right)\n$$\n使用相关系数的定义 $\\rho = \\frac{\\operatorname{Cov}(Y, X)}{\\sqrt{\\operatorname{Var}(Y)}\\sqrt{\\operatorname{Var}(X)}}$，我们有 $\\operatorname{Cov}(Y, X)^2 = \\rho^2 \\operatorname{Var}(Y)\\operatorname{Var}(X)$。代入此式可得：\n$$\n\\operatorname{Var}(\\hat{\\mu}_{c^*}) = \\frac{1}{n} \\left( \\operatorname{Var}(Y) - \\frac{\\rho^2 \\operatorname{Var}(Y)\\operatorname{Var}(X)}{\\operatorname{Var}(X)} \\right) = \\frac{\\operatorname{Var}(Y)}{n} (1 - \\rho^2)\n$$\n普通样本均值估计量的方差为 $\\operatorname{Var}(\\bar{Y}) = \\frac{\\operatorname{Var}(Y)}{n}$。相对于 $\\bar{Y}$ 的方差缩减为：\n$$\n1 - \\frac{\\operatorname{Var}(\\hat{\\mu}_{c^*})}{\\operatorname{Var}(\\bar{Y})} = 1 - \\frac{\\frac{\\operatorname{Var}(Y)}{n} (1 - \\rho^2)}{\\frac{\\operatorname{Var}(Y)}{n}} = 1 - (1 - \\rho^2) = \\rho^2\n$$\n现在，我们根据给定的 $\\rho = 0.8$，$\\operatorname{Var}(Y) = 2$，$\\operatorname{Var}(X) = 3$ 和 $n = 2000$ 计算数值。\n\n1.  **最优系数 $c^*$**：\n    首先，我们需要计算 $\\operatorname{Cov}(Y, X)$。\n    $$\n    \\operatorname{Cov}(Y, X) = \\rho \\sqrt{\\operatorname{Var}(Y)} \\sqrt{\\operatorname{Var}(X)} = 0.8 \\times \\sqrt{2} \\times \\sqrt{3} = 0.8\\sqrt{6}\n    $$\n    $$\n    c^* = \\frac{\\operatorname{Cov}(Y, X)}{\\operatorname{Var}(X)} = \\frac{0.8\\sqrt{6}}{3} \\approx 0.65319659...\n    $$\n    四舍五入到四位有效数字，$c^* = 0.6532$。\n\n2.  **最小化方差 $\\operatorname{Var}(\\hat{\\mu}_{c^*})$**：\n    $$\n    \\operatorname{Var}(\\hat{\\mu}_{c^*}) = \\frac{\\operatorname{Var}(Y)}{n} (1 - \\rho^2) = \\frac{2}{2000} (1 - 0.8^2) = 0.001 \\times (1 - 0.64) = 0.001 \\times 0.36 = 0.00036\n    $$\n    用科学计数法表示并四舍五入到四位有效数字，结果为 $3.600 \\times 10^{-4}$。\n\n3.  **方差缩减**：\n    $$\n    \\text{reduction} = \\rho^2 = 0.8^2 = 0.64\n    $$\n    表示为四位有效数字的小数，缩减量为 $0.6400$。\n\n最终答案是行向量 $(c^*, \\operatorname{Var}(\\hat{\\mu}_{c^*}), \\text{reduction})$，其值均四舍五入到四位有效数字。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.6532  3.600 \\times 10^{-4}  0.6400 \\end{pmatrix}}\n$$", "id": "3299185"}, {"introduction": "在真实的模拟中，我们并不知道计算最优系数所需的真实方差和协方差。这个实践练习通过演示如何使用可从模拟输出中轻松获得的样本统计量来估计最优系数，从而弥合了这一差距 [@problem_id:3299180]。这将控制变量法从一个理论概念转变为一个可用于您自己分析的实用工具。", "problem": "您正在使用带有控制变量的蒙特卡洛模拟来估计一个实值随机变量 $\\,Y\\,$ 的未知均值 $\\,\\theta = \\mathbb{E}[Y]\\,$。您拥有 $\\,i=1,\\dots,n\\,$ 的独立同分布样本 $\\,(Y_{i},X_{i})\\,$，其中 $\\,X\\,$ 是一个实值控制变量，其均值已知为 $\\,\\mathbb{E}[X]=0\\,$ 且二阶矩有限。考虑以下无偏控制变量估计量族\n$$\n\\hat{\\theta}(c) \\equiv \\bar{Y} - c\\left(\\bar{X} - \\mu_{X}\\right),\n$$\n其中 $\\,\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}\\,$，$\\,\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}\\,$，且 $\\,\\mu_{X}=\\mathbb{E}[X]=0\\,$。给定以下从模拟数据集中计算得出的样本汇总统计量：\n$$\n\\bar{Y}=1.5,\\quad \\bar{X}=0.7,\\quad S_{XX}=2.4,\\quad S_{YX}=1.2,\n$$\n其中 $\\,S_{XX}=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}\\,$ 和 $\\,S_{YX}=\\frac{1}{n-1}\\sum_{i=1}^{n}(Y_{i}-\\bar{Y})(X_{i}-\\bar{X})\\,$ 分别表示 $\\,X\\,$ 的无偏样本方差和 $\\,Y\\,$ 与 $\\,X\\,$ 之间的无偏样本协方差。\n\n从第一性原理出发——即无偏性、方差、协方差以及线性组合方差的定义——仅使用提供的汇总统计量，推导出方差最小化系数 $\\,c^{*}\\,$ 的值以及相应的调整后估计量值 $\\,\\hat{\\theta}(c^{*})\\,$。假设所有需要的矩都存在且有限，但不要假设 $\\,(Y,X)\\,$ 具有任何特定的分布形式。\n\n请按 $\\,c^{*}\\,$ 和 $\\,\\hat{\\theta}(c^{*})\\,$ 的顺序，以两个值的形式给出您的最终答案。请以精确形式给出答案，不要四舍五入。", "solution": "该问题要求推导控制变量估计量的方差最小化系数，并计算未知均值 $\\theta$ 的相应点估计值。该过程从验证问题陈述开始。\n\n### 第 1 步：提取已知条件\n- 待估计的参数是 $\\theta = \\mathbb{E}[Y]$。\n- 数据由独立同分布 (i.i.d.) 的样本对 $(Y_{i},X_{i})$ 组成，其中 $i=1,\\dots,n$。\n- $X$ 是一个控制变量，其已知均值为 $\\mu_{X} = \\mathbb{E}[X]=0$。\n- 控制变量估计量族由 $\\hat{\\theta}(c) \\equiv \\bar{Y} - c\\left(\\bar{X} - \\mu_{X}\\right)$ 给出，其中 $\\bar{Y}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 且 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。由于 $\\mu_X = 0$，这可简化为 $\\hat{\\theta}(c) = \\bar{Y} - c\\bar{X}$。\n- 提供的样本汇总统计量如下：\n  - $\\bar{Y}=1.5$\n  - $\\bar{X}=0.7$\n  - $X$ 的无偏样本方差：$S_{XX}=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2} = 2.4$\n  - $Y$ 和 $X$ 的无偏样本协方差：$S_{YX}=\\frac{1}{n-1}\\sum_{i=1}^{n}(Y_{i}-\\bar{Y})(X_{i}-\\bar{X}) = 1.2$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学和数学上是合理的。它描述了控制变量法的标准和基础应用，这是一种在蒙特卡洛模拟中广泛使用的方差缩减技术。目标是通过最小化一个方差函数来找到一个最优参数，这是一个良态优化问题。所提供的定义和数据清晰、一致且足以计算最优系数的估计值以及由此产生的调整后均值。当总体矩未知时，使用样本统计量（$S_{XX}$、$S_{YX}$）作为相应总体参数（$\\text{Var}(X)$、$\\text{Cov}(Y,X)$）的估计是一种标准且必要的过程。该问题没有歧义、主观论断和事实错误。\n\n### 第 3 步：结论与行动\n该问题被认为是**有效的**。我们继续进行求解。\n\n### 从第一性原理推导\n\n目标是找到使估计量 $\\hat{\\theta}(c)$ 方差最小的系数 $c$ 的值。由于 $\\mu_X = 0$，估计量为 $\\hat{\\theta}(c) = \\bar{Y} - c\\bar{X}$。\n\n首先，我们确认对于任何 $c$ 的选择，该估计量都是无偏的。该估计量的期望为：\n$$\n\\mathbb{E}[\\hat{\\theta}(c)] = \\mathbb{E}[\\bar{Y} - c\\bar{X}] = \\mathbb{E}[\\bar{Y}] - c\\mathbb{E}[\\bar{X}]\n$$\n由于样本是独立同分布的，样本均值的期望等于总体均值：\n$$\n\\mathbb{E}[\\bar{Y}] = \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}\\right] = \\frac{1}{n}\\sum_{i=1}^{n}\\mathbb{E}[Y_{i}] = \\frac{1}{n}(n\\theta) = \\theta\n$$\n$$\n\\mathbb{E}[\\bar{X}] = \\mathbb{E}\\left[\\frac{1}{n}\\sum_{i=1}^{n}X_{i}\\right] = \\frac{1}{n}\\sum_{i=1}^{n}\\mathbb{E}[X_{i}] = \\frac{1}{n}(n\\mu_{X}) = \\mu_{X} = 0\n$$\n将这些结果代入估计量的期望表达式中，得到：\n$$\n\\mathbb{E}[\\hat{\\theta}(c)] = \\theta - c(0) = \\theta\n$$\n对于任何有限值 $c$，估计量 $\\hat{\\theta}(c)$ 确实是 $\\theta$ 的无偏估计量。\n\n接下来，我们推导 $\\hat{\\theta}(c)$ 的方差。使用随机变量线性组合的方差性质 $\\text{Var}(A - B) = \\text{Var}(A) + \\text{Var}(B) - 2\\text{Cov}(A,B)$，我们有：\n$$\n\\text{Var}(\\hat{\\theta}(c)) = \\text{Var}(\\bar{Y} - c\\bar{X}) = \\text{Var}(\\bar{Y}) + \\text{Var}(c\\bar{X}) - 2\\text{Cov}(\\bar{Y}, c\\bar{X})\n$$\n$$\n\\text{Var}(\\hat{\\theta}(c)) = \\text{Var}(\\bar{Y}) + c^{2}\\text{Var}(\\bar{X}) - 2c\\text{Cov}(\\bar{Y}, \\bar{X})\n$$\n令 $\\sigma_{Y}^{2} = \\text{Var}(Y)$，$\\sigma_{X}^{2} = \\text{Var}(X)$，以及 $\\sigma_{YX} = \\text{Cov}(Y,X)$。对于独立同分布的样本，样本均值的方差和协方差为：\n$$\n\\text{Var}(\\bar{Y}) = \\frac{\\sigma_{Y}^{2}}{n}, \\quad \\text{Var}(\\bar{X}) = \\frac{\\sigma_{X}^{2}}{n}, \\quad \\text{Cov}(\\bar{Y}, \\bar{X}) = \\frac{\\sigma_{YX}}{n}\n$$\n将这些代入 $\\hat{\\theta}(c)$ 的方差表达式中：\n$$\n\\text{Var}(\\hat{\\theta}(c)) = \\frac{\\sigma_{Y}^{2}}{n} + c^{2}\\frac{\\sigma_{X}^{2}}{n} - 2c\\frac{\\sigma_{YX}}{n} = \\frac{1}{n} \\left(\\sigma_{Y}^{2} - 2c\\sigma_{YX} + c^{2}\\sigma_{X}^{2}\\right)\n$$\n为了找到使该方差最小的 $c$ 值，我们将 $\\text{Var}(\\hat{\\theta}(c))$ 对 $c$ 求导，并令其结果为零：\n$$\n\\frac{d}{dc}\\text{Var}(\\hat{\\theta}(c)) = \\frac{d}{dc}\\left[\\frac{1}{n} \\left(\\sigma_{Y}^{2} - 2c\\sigma_{YX} + c^{2}\\sigma_{X}^{2}\\right)\\right] = \\frac{1}{n} \\left(-2\\sigma_{YX} + 2c\\sigma_{X}^{2}\\right)\n$$\n令导数为零：\n$$\n\\frac{1}{n} \\left(-2\\sigma_{YX} + 2c\\sigma_{X}^{2}\\right) = 0 \\implies -2\\sigma_{YX} + 2c\\sigma_{X}^{2} = 0 \\implies c = \\frac{\\sigma_{YX}}{\\sigma_{X}^{2}}\n$$\n这个最优系数记为 $c^{*}$。其二阶导数 $\\frac{d^{2}}{dc^{2}}\\text{Var}(\\hat{\\theta}(c)) = \\frac{2\\sigma_{X}^{2}}{n}$ 为正（假设 $X$ 不是常数，因此 $\\sigma_{X}^{2}0$），这证实了该 $c$ 值对应于一个最小值。\n因此，理论上的最优系数是 $c^{*} = \\frac{\\text{Cov}(Y,X)}{\\text{Var}(X)}$。\n\n在实践中，总体协方差 $\\sigma_{YX}$ 和总体方差 $\\sigma_{X}^{2}$ 是未知的。我们使用问题陈述中提供的它们的无偏样本对应物 $S_{YX}$ 和 $S_{XX}$ 来估计它们。问题要求仅使用给定的汇总统计量来计算 $c^{*}$ 的值，这意味着我们必须使用这些样本估计值。\n$$\nc^{*} \\approx \\hat{c}^{*} = \\frac{S_{YX}}{S_{XX}}\n$$\n使用提供的数值：\n$$\nS_{YX} = 1.2, \\quad S_{XX} = 2.4\n$$\n$$\nc^{*} = \\frac{1.2}{2.4} = 0.5\n$$\n现在，我们使用这个最优系数和给定的样本均值来计算调整后的估计量值 $\\hat{\\theta}(c^{*})$：\n$$\n\\hat{\\theta}(c^{*}) = \\bar{Y} - c^{*}\\bar{X}\n$$\n使用提供的值 $\\bar{Y} = 1.5$ 和 $\\bar{X} = 0.7$：\n$$\n\\hat{\\theta}(c^{*}) = 1.5 - (0.5)(0.7) = 1.5 - 0.35 = 1.15\n$$\n方差最小化系数是 $0.5$，得到的 $\\theta$ 的调整后估计值是 $1.15$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5  1.15 \\end{pmatrix}}\n$$", "id": "3299180"}, {"introduction": "当您可以使用多个控制变量时，为什么只使用一个呢？这个进阶问题将控制变量的概念扩展到多变量情况，其中使用控制变量向量来实现更大的方差缩减 [@problem_id:3299208]。您将看到该解决方案如何利用矩阵代数进行优雅的推广，为复杂的估计问题提供一个稳健的框架。", "problem": "考虑一个标量随机变量 $Y$ 和一个二维控制变量向量 $X=(X_{1},X_{2})^{\\top}$。您希望通过蒙特卡洛 (MC) 中的控制变量法，使用单次复制残差 $Y-c^{\\top}(X-\\mu_{X})$ 来估计均值 $\\mu_{Y}=\\mathbb{E}[Y]$，其中 $\\mu_{X}=\\mathbb{E}[X]$ 已知。假设 $(Y,X)$ 具有有限二阶矩，并且其二阶结构完全由以下数值量刻画：\n$$\n\\Sigma_{XX}=\\begin{pmatrix}2  1 \\\\ 1  3\\end{pmatrix},\\qquad \\Sigma_{XY}=\\begin{pmatrix}1 \\\\ 2\\end{pmatrix},\\qquad \\operatorname{Var}(Y)=5,\n$$\n其中 $\\Sigma_{XX}=\\operatorname{Cov}(X,X)$ 且 $\\Sigma_{XY}=\\operatorname{Cov}(X,Y)$。\n\n仅从方差和协方差的定义以及随机变量线性组合的标准性质出发，确定使残差 $Y-c^{\\top}(X-\\mu_{X})$ 的方差最小化的系数向量 $c^{\\star}$，并计算所得的最小化方差 $\\operatorname{Var}\\big(Y-(c^{\\star})^{\\top}(X-\\mu_{X})\\big)$。\n\n将您的最终答案表示为单个行向量 $\\big(c_{1}^{\\star},c_{2}^{\\star},V_{\\min}\\big)$，使用精确值（不要四舍五入或小数近似）。无需单位。", "solution": "该问题是有效的。这是一个随机模拟领域的适定问题，具体涉及用于方差缩减的控制变量法。所有必要信息均已提供，且该问题基于概率论和统计学的标准、可靠原理。\n\n目标是找到使控制变量估计量方差最小化的系数向量 $c^{\\star} \\in \\mathbb{R}^2$，并计算这个最小方差。单次复制估计量由 $Z_c = Y - c^{\\top}(X - \\mu_X)$ 给出，其中 $c = (c_1, c_2)^{\\top}$ 是系数向量。要最小化的方差是 $V(c) = \\operatorname{Var}(Z_c) = \\operatorname{Var}(Y - c^{\\top}(X - \\mu_X))$。\n\n首先，我们展开方差表达式。由于随机变量的方差对于常数位移是不变的，并且 $\\mu_X$ 是一个常数向量，我们有：\n$$\nV(c) = \\operatorname{Var}(Y - c^{\\top}X + c^{\\top}\\mu_X) = \\operatorname{Var}(Y - c^{\\top}X)\n$$\n我们使用随机变量线性组合方差的一般性质。如果我们定义一个新的随机向量 $W = \\begin{pmatrix} Y \\\\ X \\end{pmatrix}$，那么 $Y - c^{\\top}X$ 这一项可以写成 $a^{\\top}W$，其中 $a^{\\top} = \\begin{pmatrix} 1  -c^{\\top} \\end{pmatrix} = \\begin{pmatrix} 1  -c_1  -c_2 \\end{pmatrix}$。那么方差由下式给出：\n$$\nV(c) = \\operatorname{Var}(a^{\\top}W) = a^{\\top}\\operatorname{Cov}(W,W)a\n$$\n$W$ 的协方差矩阵是一个由给定的二阶矩组成的分块矩阵：\n$$\n\\operatorname{Cov}(W,W) = \\begin{pmatrix} \\operatorname{Var}(Y)  \\operatorname{Cov}(Y,X) \\\\ \\operatorname{Cov}(X,Y)  \\operatorname{Cov}(X,X) \\end{pmatrix} = \\begin{pmatrix} \\operatorname{Var}(Y)  \\Sigma_{XY}^{\\top} \\\\ \\Sigma_{XY}  \\Sigma_{XX} \\end{pmatrix}\n$$\n将 $a$ 和 $\\operatorname{Cov}(W,W)$ 代入方差表达式中：\n$$\nV(c) = \\begin{pmatrix} 1  -c^{\\top} \\end{pmatrix} \\begin{pmatrix} \\operatorname{Var}(Y)  \\Sigma_{XY}^{\\top} \\\\ \\Sigma_{XY}  \\Sigma_{XX} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -c \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\nV(c) = \\begin{pmatrix} \\operatorname{Var}(Y) - c^{\\top}\\Sigma_{XY}  \\Sigma_{XY}^{\\top} - c^{\\top}\\Sigma_{XX} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -c \\end{pmatrix}\n$$\n$$\nV(c) = (\\operatorname{Var}(Y) - c^{\\top}\\Sigma_{XY}) \\cdot 1 + (\\Sigma_{XY}^{\\top} - c^{\\top}\\Sigma_{XX}) \\cdot (-c)\n$$\n$$\nV(c) = \\operatorname{Var}(Y) - c^{\\top}\\Sigma_{XY} - \\Sigma_{XY}^{\\top}c + c^{\\top}\\Sigma_{XX}c\n$$\n由于 $c^{\\top}\\Sigma_{XY}$ 是一个标量，它等于其转置 $(\\Sigma_{XY})^{\\top}c = \\Sigma_{XY}^{\\top}c$。因此，该表达式可化简为关于 $c$ 的二次型：\n$$\nV(c) = \\operatorname{Var(Y)} - 2c^{\\top}\\Sigma_{XY} + c^{\\top}\\Sigma_{XX}c\n$$\n为了找到使该方差最小化的系数向量 $c^{\\star}$，我们将 $V(c)$ 对向量 $c$ 求导，并将梯度设为零向量。使用标准矩阵微积分法则（对于对称矩阵 $A$，有 $\\nabla_x (b^{\\top}x) = b$ 和 $\\nabla_x (x^{\\top}Ax) = 2Ax$）：\n$$\n\\nabla_{c}V(c) = -2\\Sigma_{XY} + 2\\Sigma_{XX}c\n$$\n将梯度设为零以求最优的 $c^{\\star}$：\n$$\n-2\\Sigma_{XY} + 2\\Sigma_{XX}c^{\\star} = 0\n$$\n$$\n\\Sigma_{XX}c^{\\star} = \\Sigma_{XY}\n$$\n这是一个关于 $c^{\\star}$ 的线性方程组。如果 $\\Sigma_{XX}$ 可逆，则解为 $c^{\\star} = \\Sigma_{XX}^{-1}\\Sigma_{XY}$。\n\n我们已知的数值为：\n$$\n\\Sigma_{XX}=\\begin{pmatrix}2  1 \\\\ 1  3\\end{pmatrix}, \\qquad \\Sigma_{XY}=\\begin{pmatrix}1 \\\\ 2\\end{pmatrix}, \\qquad \\operatorname{Var}(Y)=5\n$$\n首先，我们计算 $\\Sigma_{XX}$ 的逆矩阵。其行列式为 $\\det(\\Sigma_{XX}) = (2)(3) - (1)(1) = 6 - 1 = 5$。由于行列式非零，逆矩阵存在。\n$$\n\\Sigma_{XX}^{-1} = \\frac{1}{\\det(\\Sigma_{XX})} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n现在，我们可以求解 $c^{\\star}$：\n$$\nc^{\\star} = \\Sigma_{XX}^{-1}\\Sigma_{XY} = \\frac{1}{5} \\begin{pmatrix} 3  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\nc^{\\star} = \\frac{1}{5} \\begin{pmatrix} (3)(1) + (-1)(2) \\\\ (-1)(1) + (2)(2) \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 3 - 2 \\\\ -1 + 4 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1/5 \\\\ 3/5 \\end{pmatrix}\n$$\n所以，最优系数为 $c_1^{\\star} = 1/5$ 和 $c_2^{\\star} = 3/5$。\n\n接下来，我们计算最小化方差 $V_{\\min} = V(c^{\\star})$。我们将 $c^{\\star}$ 代回 $V(c)$ 的表达式中：\n$$\nV_{\\min} = \\operatorname{Var}(Y) - 2(c^{\\star})^{\\top}\\Sigma_{XY} + (c^{\\star})^{\\top}\\Sigma_{XX}c^{\\star}\n$$\n利用条件 $\\Sigma_{XX}c^{\\star} = \\Sigma_{XY}$，我们可以化简该表达式：\n$$\nV_{\\min} = \\operatorname{Var}(Y) - 2(c^{\\star})^{\\top}\\Sigma_{XY} + (c^{\\star})^{\\top}(\\Sigma_{XY})\n$$\n$$\nV_{\\min} = \\operatorname{Var}(Y) - (c^{\\star})^{\\top}\\Sigma_{XY}\n$$\n代入 $\\operatorname{Var}(Y)$、$c^{\\star}$ 和 $\\Sigma_{XY}$ 的数值：\n$$\n(c^{\\star})^{\\top}\\Sigma_{XY} = \\begin{pmatrix} 1/5   3/5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (1/5)(1) + (3/5)(2) = \\frac{1}{5} + \\frac{6}{5} = \\frac{7}{5}\n$$\n$$\nV_{\\min} = 5 - \\frac{7}{5} = \\frac{25}{5} - \\frac{7}{5} = \\frac{18}{5}\n$$\n最优系数向量为 $c^{\\star} = (1/5, 3/5)^{\\top}$，得到的最小方差为 $V_{\\min} = 18/5$。最终答案要求为单个行向量 $(c_1^{\\star}, c_2^{\\star}, V_{\\min})$。\n\n最终向量：$\\left(\\frac{1}{5}, \\frac{3}{5}, \\frac{18}{5}\\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{5}  \\frac{3}{5}  \\frac{18}{5}\n\\end{pmatrix}\n}\n$$", "id": "3299208"}]}