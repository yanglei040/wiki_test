{"hands_on_practices": [{"introduction": "本练习提供了方差缩减技术的基础性实践。通过从头推导一个简单函数下对偶变量估计量的方差，您将具体理解在成对样本间引入负相关性是如何直接带来更有效估计量的。这项实践旨在强化这一优雅方差缩减技术背后的核心机制，即通过构造相关的随机数来降低估计的统计波动性 [@problem_id:3360544]。", "problem": "考虑估计积分 $I=\\mathbb{E}[f(U)]$，其中 $f(u)=\\exp(u)$ 且 $U\\sim \\text{Uniform}(0,1)$。请从第一性原理出发：期望的积分定义、方差的定义 $\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}$，以及期望的线性性质。考虑在固定的 $N$ 次函数求值（$N$ 为偶数）的计算预算下，使用两种估计器。\n\n- 普通蒙特卡罗（MC）：抽取独立同分布（i.i.d.）的 $U_{1},\\ldots,U_{N}\\sim \\text{Uniform}(0,1)$，并计算 $\\widehat{I}_{N}=\\frac{1}{N}\\sum_{i=1}^{N} f(U_{i})$。\n\n- 对偶变量法：抽取独立同分布的 $U_{1},\\ldots,U_{N/2}\\sim \\text{Uniform}(0,1)$，形成对偶变量对 $(U_{i},1-U_{i})$，并计算 $\\widehat{I}^{\\mathrm{anti}}_{N}=\\frac{2}{N}\\sum_{i=1}^{N/2}\\frac{f(U_{i})+f(1-U_{i})}{2}$。\n\n仅使用上述积分定义以及期望和方差的性质，完成以下任务：\n\n1. 推导 $\\operatorname{Var}(f(U))$ 的精确表达式。\n2. 推导单个对偶变量对的 $\\operatorname{Var}\\!\\left(\\frac{f(U)+f(1-U)}{2}\\right)$ 的精确表达式。\n3. 因此，在相同的计算成本 $N$ 下，推导 $\\widehat{I}_{N}$ 和 $\\widehat{I}^{\\mathrm{anti}}_{N}$ 的精确方差。\n4. 将等成本下的方差缩减因子 $R$ 定义为比率 $R=\\operatorname{Var}(\\widehat{I}^{\\mathrm{anti}}_{N})/\\operatorname{Var}(\\widehat{I}_{N})$，并将其简化为一个不依赖于 $N$ 的封闭形式表达式。\n\n以精确的符号形式提供 $R$ 作为最终答案。不要进行近似，也不要包含单位。如果使用任何中间数值进行验证，请勿在最终结果中使用它。", "solution": "该问题陈述清晰，具有科学依据，并包含唯一解所需的所有信息。我们开始进行推导。\n\n设 $U$ 为一个服从 Uniform($0,1$) 分布的随机变量。其概率密度函数为 $p(u) = 1$ 当 $u \\in [0, 1]$ 时，否则为 $0$。我们感兴趣的函数是 $f(u) = \\exp(u)$。需要估计的积分是 $I = \\mathbb{E}[f(U)]$。\n\n首先，我们计算积分 $I$ 的真实值：\n$$I = \\mathbb{E}[f(U)] = \\int_{0}^{1} f(u) p(u) \\, du = \\int_{0}^{1} \\exp(u) \\cdot 1 \\, du = [\\exp(u)]_{0}^{1} = \\exp(1) - \\exp(0) = e-1$$\n\n这证实了我们估计器的期望值应为 $e-1$。\n\n**1. 推导 $\\operatorname{Var}(f(U))$**\n\n为了计算方差，我们使用公式 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$。我们首先需要 $f(U)$ 的二阶矩。\n$$\\mathbb{E}[(f(U))^2] = \\mathbb{E}[\\exp(2U)] = \\int_{0}^{1} \\exp(2u) \\, du = \\left[\\frac{1}{2}\\exp(2u)\\right]_{0}^{1} = \\frac{1}{2}(\\exp(2) - \\exp(0)) = \\frac{e^2 - 1}{2}$$\n现在，我们可以计算 $f(U)$ 的方差：\n$$\\operatorname{Var}(f(U)) = \\mathbb{E}[(f(U))^2] - (\\mathbb{E}[f(U)])^2 = \\frac{e^2 - 1}{2} - (e-1)^2$$\n展开平方项：\n$$(e-1)^2 = e^2 - 2e + 1$$\n将此代回方差表达式中：\n$$\\operatorname{Var}(f(U)) = \\frac{e^2 - 1}{2} - (e^2 - 2e + 1) = \\frac{e^2 - 1 - 2(e^2 - 2e + 1)}{2} = \\frac{e^2 - 1 - 2e^2 + 4e - 2}{2}$$\n$$\\operatorname{Var}(f(U)) = \\frac{-e^2 + 4e - 3}{2}$$\n\n**2. 推导 $\\operatorname{Var}\\!\\left(\\frac{f(U)+f(1-U)}{2}\\right)$**\n\n设 $Y = \\frac{f(U)+f(1-U)}{2} = \\frac{\\exp(U)+\\exp(1-U)}{2}$。我们需要计算 $\\operatorname{Var}(Y)$。\n首先，我们求 $Y$ 的期望：\n$$\\mathbb{E}[Y] = \\mathbb{E}\\left[\\frac{\\exp(U)+\\exp(1-U)}{2}\\right] = \\frac{1}{2}(\\mathbb{E}[\\exp(U)] + \\mathbb{E}[\\exp(1-U)])$$\n如果 $U \\sim \\text{Uniform}(0,1)$，那么随机变量 $V = 1-U$ 也服从 $\\text{Uniform}(0,1)$ 分布。因此，$\\mathbb{E}[\\exp(1-U)] = \\mathbb{E}[\\exp(V)] = \\mathbb{E}[\\exp(U)] = e-1$。\n$$\\mathbb{E}[Y] = \\frac{1}{2}((e-1) + (e-1)) = e-1$$\n这表明对偶变量抽样提供了一个无偏估计。\n\n接下来，我们求 $Y$ 的二阶矩：\n$$\\mathbb{E}[Y^2] = \\mathbb{E}\\left[\\left(\\frac{\\exp(U)+\\exp(1-U)}{2}\\right)^2\\right] = \\frac{1}{4}\\mathbb{E}[\\exp(2U) + 2\\exp(U)\\exp(1-U) + \\exp(2(1-U))]$$\n中间项简化为：$2\\exp(U)\\exp(1-U) = 2\\exp(U+1-U) = 2e$。\n$$\\mathbb{E}[Y^2] = \\frac{1}{4}\\mathbb{E}[\\exp(2U) + 2e + \\exp(2-2U)]$$\n利用期望的线性性质：\n$$\\mathbb{E}[Y^2] = \\frac{1}{4}(\\mathbb{E}[\\exp(2U)] + \\mathbb{E}[2e] + \\mathbb{E}[\\exp(2-2U)])$$\n我们已经知道 $\\mathbb{E}[\\exp(2U)] = \\frac{e^2-1}{2}$。对于最后一项，我们计算积分：\n$$\\mathbb{E}[\\exp(2-2U)] = \\int_{0}^{1} \\exp(2-2u) \\, du = \\left[-\\frac{1}{2}\\exp(2-2u)\\right]_{0}^{1} = -\\frac{1}{2}(\\exp(0) - \\exp(2)) = \\frac{e^2-1}{2}$$\n将这些结果代回：\n$$\\mathbb{E}[Y^2] = \\frac{1}{4}\\left(\\frac{e^2-1}{2} + 2e + \\frac{e^2-1}{2}\\right) = \\frac{1}{4}(e^2-1+2e) = \\frac{e^2+2e-1}{4}$$\n现在我们计算 $Y$ 的方差：\n$$\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2 = \\frac{e^2+2e-1}{4} - (e-1)^2 = \\frac{e^2+2e-1 - 4(e^2-2e+1)}{4}$$\n$$\\operatorname{Var}(Y) = \\frac{e^2+2e-1 - 4e^2+8e-4}{4} = \\frac{-3e^2+10e-5}{4}$$\n\n**3. 推导估计器的方差**\n\n普通蒙特卡罗估计器是 $\\widehat{I}_{N} = \\frac{1}{N}\\sum_{i=1}^{N} f(U_{i})$，其中 $U_i$ 是独立同分布的。$N$ 个独立同分布随机变量均值的方差是单个变量方差除以 $N$。\n$$\\operatorname{Var}(\\widehat{I}_{N}) = \\frac{1}{N}\\operatorname{Var}(f(U)) = \\frac{1}{N} \\left(\\frac{-e^2 + 4e - 3}{2}\\right) = \\frac{-e^2 + 4e - 3}{2N}$$\n对偶变量估计器是 $\\widehat{I}^{\\mathrm{anti}}_{N} = \\frac{1}{N/2}\\sum_{i=1}^{N/2} Y_i$，其中 $Y_i = \\frac{f(U_i)+f(1-U_i)}{2}$。因为对于 $i=1, \\dots, N/2$，$U_i$ 是独立同分布的，所以随机变量 $Y_i$ 也是独立同分布的。该估计器是 $N/2$ 个独立同分布样本的均值。\n$$\\operatorname{Var}(\\widehat{I}^{\\mathrm{anti}}_{N}) = \\frac{1}{N/2}\\operatorname{Var}(Y) = \\frac{2}{N}\\left(\\frac{-3e^2+10e-5}{4}\\right) = \\frac{-3e^2+10e-5}{2N}$$\n\n**4. 推导方差缩减因子 $R$**\n\n在相同计算成本 $N$ 下，方差缩减因子 $R$ 是两个方差的比值。\n$$R = \\frac{\\operatorname{Var}(\\widehat{I}^{\\mathrm{anti}}_{N})}{\\operatorname{Var}(\\widehat{I}_{N})} = \\frac{\\frac{-3e^2+10e-5}{2N}}{\\frac{-e^2+4e-3}{2N}}$$\n分母中的 $2N$ 项相互抵消，得到一个不依赖于 $N$ 的 $R$ 的表达式：\n$$R = \\frac{-3e^2+10e-5}{-e^2+4e-3}$$\n这可以通过将分子和分母同乘以 $-1$ 来重写，以使首项系数为正：\n$$R = \\frac{3e^2-10e+5}{e^2-4e+3}$$\n两种形式是等价的。我们展示直接从正方差项推导出的形式。", "answer": "$$\\boxed{\\frac{-3e^2+10e-5}{-e^2+4e-3}}$$", "id": "3360544"}, {"introduction": "在相关性的主题上更进一步，本练习将探索强大的控制变量法。您将推导最小化方差的最优系数——这是模拟理论中的一个基石性成果——并将其应用于一个实际例子。这项练习展示了如何系统地利用一个具有已知均值的相关变量来显著提高估计精度，这是优化蒙特卡洛模拟效率的关键一步 [@problem_id:3360574]。", "problem": "设 $X$ 是一个实值随机变量，其分布为 $X \\sim \\mathcal{N}(0,1)$。考虑使用基于一个期望已知的函数 $g(X)$ 的控制变量来估计期望 $\\mu = \\mathbb{E}[f(X)]$。设 $f(X) = X^{4}$ 且 $g(X) = X^{2}$。对于一个标量系数 $\\beta \\in \\mathbb{R}$，定义控制变量估计量为 $Y_{\\beta} = f(X) - \\beta\\big(g(X) - \\mathbb{E}[g(X)]\\big)$。仅使用方差、协方差的定义以及期望的线性性质，从第一性原理推导使 $\\operatorname{Var}(Y_{\\beta})$ 在 $\\beta$ 上最小化的系数 $\\beta^{*}$。然后，针对给定的 $f$ 和 $g$ 进行特化计算：\n- 最优系数 $\\beta^{*}$，\n- 得到的方差 $\\operatorname{Var}\\big(X^{4} - \\beta^{*} X^{2}\\big)$，\n- 定义为 $\\operatorname{Var}\\big(X^{4} - \\beta^{*} X^{2}\\big)\\big/\\operatorname{Var}(X^{4})$ 的缩减因子。\n\n提供精确值；无需四舍五入。为清晰起见，请注意减去一个常数不会改变方差，因此对于任何 $\\beta \\in \\mathbb{R}$，都有 $\\operatorname{Var}\\big(X^{4} - \\beta^{*} X^{2}\\big) = \\operatorname{Var}\\big(X^{4} - \\beta^{*}(X^{2} - \\mathbb{E}[X^{2}])\\big)$。请按上述顺序列出您的最终结果。", "solution": "该问题是有效的，因为它在概率论中有科学依据，问题提法恰当，客观且自洽。我们将开始进行解答。\n\n该问题要求三项内容：最优控制变量系数 $\\beta^{*}$ 的推导，其对于给定函数的具体值，得到的方差，以及方差缩减因子。\n\n首先，我们推导使控制变量估计量 $Y_{\\beta}$ 的方差最小化的最优系数 $\\beta^{*}$。该估计量定义为：\n$$\nY_{\\beta} = f(X) - \\beta\\big(g(X) - \\mathbb{E}[g(X)]\\big)\n$$\n其中 $f(X)$ 和 $g(X)$ 是随机变量 $X$ 的函数，而 $\\mathbb{E}[g(X)]$ 是 $g(X)$ 的已知期望。\n\n我们寻求相对于系数 $\\beta \\in \\mathbb{R}$ 最小化 $\\operatorname{Var}(Y_{\\beta})$。我们首先使用方差的性质来表示 $Y_{\\beta}$ 的方差。设 $C = \\beta \\mathbb{E}[g(X)]$ 是一个常数。随机变量的方差不受加上或减去一个常数的影响，因此：\n$$\n\\operatorname{Var}(Y_{\\beta}) = \\operatorname{Var}\\big(f(X) - \\beta g(X) + \\beta \\mathbb{E}[g(X)]\\big) = \\operatorname{Var}\\big(f(X) - \\beta g(X)\\big)\n$$\n使用随机变量线性组合的方差公式 $\\operatorname{Var}(A - B) = \\operatorname{Var}(A) + \\operatorname{Var}(B) - 2\\operatorname{Cov}(A, B)$，我们有：\n$$\n\\operatorname{Var}(Y_{\\beta}) = \\operatorname{Var}(f(X)) + \\operatorname{Var}(\\beta g(X)) - 2\\operatorname{Cov}(f(X), \\beta g(X))\n$$\n使用性质 $\\operatorname{Var}(cZ) = c^2\\operatorname{Var}(Z)$ 和 $\\operatorname{Cov}(Z_1, cZ_2) = c\\operatorname{Cov}(Z_1, Z_2)$（其中 $c$ 为常数），我们得到：\n$$\n\\operatorname{Var}(Y_{\\beta}) = \\operatorname{Var}(f(X)) + \\beta^2 \\operatorname{Var}(g(X)) - 2\\beta \\operatorname{Cov}(f(X), g(X))\n$$\n为了找到最小化此方差的 $\\beta$ 值，我们将 $\\operatorname{Var}(Y_{\\beta})$ 视为 $\\beta$ 的函数，通过对其求关于 $\\beta$ 的导数并令其为零来找到其最小值。\n$$\n\\frac{d}{d\\beta} \\operatorname{Var}(Y_{\\beta}) = \\frac{d}{d\\beta} \\left( \\operatorname{Var}(f(X)) + \\beta^2 \\operatorname{Var}(g(X)) - 2\\beta \\operatorname{Cov}(f(X), g(X)) \\right)\n$$\n$$\n\\frac{d}{d\\beta} \\operatorname{Var}(Y_{\\beta}) = 2\\beta \\operatorname{Var}(g(X)) - 2\\operatorname{Cov}(f(X), g(X))\n$$\n将导数设为零以找到最优系数 $\\beta^{*}$：\n$$\n2\\beta^{*} \\operatorname{Var}(g(X)) - 2\\operatorname{Cov}(f(X), g(X)) = 0\n$$\n$$\n\\beta^{*} \\operatorname{Var}(g(X)) = \\operatorname{Cov}(f(X), g(X))\n$$\n假设 $\\operatorname{Var}(g(X)) > 0$（即，$g(X)$ 不是一个常数），我们可以解出 $\\beta^{*}$：\n$$\n\\beta^{*} = \\frac{\\operatorname{Cov}(f(X), g(X))}{\\operatorname{Var}(g(X))}\n$$\n二阶导数 $\\frac{d^2}{d\\beta^2}\\operatorname{Var}(Y_{\\beta}) = 2\\operatorname{Var}(g(X))$ 为正，确认了此 $\\beta$ 值对应一个最小值。\n\n接下来，我们针对给定的问题进行特化，其中 $X \\sim \\mathcal{N}(0,1)$，$f(X) = X^4$，$g(X) = X^2$。要计算 $\\beta^*$，我们必须求出标准正态分布的矩。标准正态随机变量 $X$ 的 $n$ 阶矩是 $\\mathbb{E}[X^n]$。当 $n$ 为奇数时，$\\mathbb{E}[X^n] = 0$。当 $n$ 为偶数时，设 $n=2k$，矩由 $\\mathbb{E}[X^{2k}] = (2k-1)!! = (2k-1)(2k-3)\\cdots 1$ 给出。\n我们需要以下期望值：\n- $\\mathbb{E}[X^2] = (2-1)!! = 1$\n- $\\mathbb{E}[X^4] = (4-1)!! = 3 \\times 1 = 3$\n- $\\mathbb{E}[X^6] = (6-1)!! = 5 \\times 3 \\times 1 = 15$\n- $\\mathbb{E}[X^8] = (8-1)!! = 7 \\times 5 \\times 3 \\times 1 = 105$\n\n现在我们计算 $\\beta^{*}$ 表达式中的各项：\n协方差项为：\n$$\n\\operatorname{Cov}(f(X), g(X)) = \\operatorname{Cov}(X^4, X^2) = \\mathbb{E}[X^4 \\cdot X^2] - \\mathbb{E}[X^4]\\mathbb{E}[X^2] = \\mathbb{E}[X^6] - \\mathbb{E}[X^4]\\mathbb{E}[X^2]\n$$\n$$\n\\operatorname{Cov}(X^4, X^2) = 15 - (3)(1) = 12\n$$\n方差项为：\n$$\n\\operatorname{Var}(g(X)) = \\operatorname{Var}(X^2) = \\mathbb{E}[(X^2)^2] - (\\mathbb{E}[X^2])^2 = \\mathbb{E}[X^4] - (\\mathbb{E}[X^2])^2\n$$\n$$\n\\operatorname{Var}(X^2) = 3 - (1)^2 = 2\n$$\n因此，最优系数为：\n$$\n\\beta^{*} = \\frac{12}{2} = 6\n$$\n现在，我们计算得到的方差 $\\operatorname{Var}\\big(X^4 - \\beta^{*} X^2\\big) = \\operatorname{Var}\\big(X^4 - 6X^2\\big)$。\n设 $W = X^4 - 6X^2$。\n$$\n\\operatorname{Var}(W) = \\mathbb{E}[W^2] - (\\mathbb{E}[W])^2\n$$\n首先，计算 $W$ 的期望：\n$$\n\\mathbb{E}[W] = \\mathbb{E}[X^4 - 6X^2] = \\mathbb{E}[X^4] - 6\\mathbb{E}[X^2] = 3 - 6(1) = -3\n$$\n其次，计算 $W^2$ 的期望：\n$$\n\\mathbb{E}[W^2] = \\mathbb{E}[(X^4 - 6X^2)^2] = \\mathbb{E}[X^8 - 12X^6 + 36X^4]\n$$\n根据期望的线性性质：\n$$\n\\mathbb{E}[W^2] = \\mathbb{E}[X^8] - 12\\mathbb{E}[X^6] + 36\\mathbb{E}[X^4] = 105 - 12(15) + 36(3) = 105 - 180 + 108 = 33\n$$\n因此，方差为：\n$$\n\\operatorname{Var}(X^4 - 6X^2) = 33 - (-3)^2 = 33 - 9 = 24\n$$\n最后，我们计算缩减因子，即控制后方差与原始方差之比。原始方差为 $\\operatorname{Var}(f(X)) = \\operatorname{Var}(X^4)$。\n$$\n\\operatorname{Var}(X^4) = \\mathbb{E}[(X^4)^2] - (\\mathbb{E}[X^4])^2 = \\mathbb{E}[X^8] - (\\mathbb{E}[X^4])^2 = 105 - (3)^2 = 105 - 9 = 96\n$$\n缩减因子为：\n$$\n\\frac{\\operatorname{Var}(X^4 - \\beta^{*} X^2)}{\\operatorname{Var}(X^4)} = \\frac{24}{96} = \\frac{1}{4}\n$$\n所求的三个值是最优系数 $\\beta^{*} = 6$，得到的方差 $\\operatorname{Var}(X^4 - 6X^2) = 24$，以及缩减因子 $1/4$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6  24  \\frac{1}{4} \\end{pmatrix}}\n$$", "id": "3360574"}, {"introduction": "最后的这项实践是一个关键的总结，它说明了方差缩减技术并非普遍适用，需要审慎选择。通过分析一个共同随机数（CRN）反而意外地*增加*方差的场景，您将揭示模拟系统间单调关系的重要性。这个高级问题旨在磨练您的诊断技能，并强调深刻理解问题结构对于有效实施方差缩减至关重要 [@problem_id:3360579]。", "problem": "考虑两个竞争的随机系统，其输出建模为 $Y_{1} = f_{1}(U) + \\epsilon_{1}$ 和 $Y_{2} = f_{2}(U) + \\epsilon_{2}$，其中 $U \\sim \\mathcal{N}(0,1)$ 是一个标量共同输入驱动，而 $\\epsilon_{1} \\sim \\mathcal{N}(0,\\sigma_{1}^{2})$ 和 $\\epsilon_{2} \\sim \\mathcal{N}(0,\\sigma_{2}^{2})$ 相互独立且与 $U$ 独立。定义响应函数以展示依赖于区间的回归斜率，这些斜率在 $U=0$ 处改变符号：\n$$\nf_{1}(U) = \\alpha_{1} + \\begin{cases}\na\\,U,  U  0, \\\\\n- a\\,U,  U \\ge 0,\n\\end{cases}\n\\qquad\nf_{2}(U) = \\alpha_{2} + \\begin{cases}\n- b\\,U,  U  0, \\\\\nb\\,U,  U \\ge 0,\n\\end{cases}\n$$\n其中 $\\alpha_{1}, \\alpha_{2} \\in \\mathbb{R}$ 和 $a  0$, $b  0$ 为固定常数。考虑通过单次重复蒙特卡洛差值估计量来估计平均性能差异 $\\mu_{\\Delta} = \\mathbb{E}[Y_{1} - Y_{2}]$，使用公共随机数（CRN，即两个系统使用相同的 $U$ 的实现）或独立随机数（IRN，即两个系统使用独立的实现 $U_{1} \\sim \\mathcal{N}(0,1)$ 和 $U_{2} \\sim \\mathcal{N}(0,1)$）。\n\n仅从基本的概率定义和性质出发，完成以下任务：\n- 推导在CRN和IRN下单次重复差值估计量的方差，并获得方差膨胀比 $R$，定义为CRN方差除以IRN方差，用 $a$、$b$、$\\sigma_{1}^{2}$、$\\sigma_{2}^{2}$ 和已知常数以闭合形式表示。\n- 使用局部线性，推导一个基于局部回归斜率乘积的诊断量 $D$，该量指示CRN是否适用于此设置下差值估计量的方差缩减。用 $a$ 和 $b$ 以闭合形式表示 $D$。\n\n将你的最终答案以包含方差膨胀比 $R$ 和诊断量 $D$ 的行矩阵形式给出。无需进行数值舍入。", "solution": "该问题被认为是有效的，因为它具有科学依据、问题设定良好、客观，并且包含在随机模拟领域内获得唯一数学解所需的所有必要信息。我们可以继续进行推导。\n\n目标是估计平均性能差异 $\\mu_{\\Delta} = \\mathbb{E}[Y_{1} - Y_{2}]$。两个系统由 $Y_{1} = f_{1}(U) + \\epsilon_{1}$ 和 $Y_{2} = f_{2}(U) + \\epsilon_{2}$ 给出。噪声项 $\\epsilon_{1} \\sim \\mathcal{N}(0,\\sigma_{1}^{2})$ 和 $\\epsilon_{2} \\sim \\mathcal{N}(0,\\sigma_{2}^{2})$ 相互独立，且与共同输入驱动 $U \\sim \\mathcal{N}(0,1)$ 独立。常数 $a, b$ 为正。\n\n响应函数为：\n$$\nf_{1}(U) = \\alpha_{1} + \\begin{cases}\na\\,U,  U  0, \\\\\n- a\\,U,  U \\ge 0,\n\\end{cases}\n\\qquad\nf_{2}(U) = \\alpha_{2} + \\begin{cases}\n- b\\,U,  U  0, \\\\\nb\\,U,  U \\ge 0,\n\\end{cases}\n$$\n这些函数可以使用绝对值函数更紧凑地写出。对于 $U  0$，我们有 $|U| = -U$，所以 $aU = -a|U|$ 且 $-bU = b|U|$。对于 $U \\ge 0$，我们有 $|U| = U$，所以 $-aU = -a|U|$ 且 $bU = b|U|$。因此，这些函数等价于：\n$$\nf_{1}(U) = \\alpha_{1} - a|U|\n$$\n$$\nf_{2}(U) = \\alpha_{2} + b|U|\n$$\n这种紧凑的表示简化了后续的计算。\n\n首先，我们计算 $U \\sim \\mathcal{N}(0,1)$ 时 $|U|$ 的矩。$U$ 的概率密度函数为 $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right)$。\n一阶矩，或期望，为：\n$$\n\\mathbb{E}[|U|] = \\int_{-\\infty}^{\\infty} |u| \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du = 2 \\int_{0}^{\\infty} u \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) du\n$$\n使用换元法 $v = u^2/2$，其中 $dv = u\\,du$：\n$$\n\\mathbb{E}[|U|] = \\frac{2}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} \\exp(-v) dv = \\frac{2}{\\sqrt{2\\pi}} [-\\exp(-v)]_{0}^{\\infty} = \\frac{2}{\\sqrt{2\\pi}} (0 - (-1)) = \\sqrt{\\frac{2}{\\pi}}\n$$\n$|U|$ 的二阶矩与 $U$ 的二阶矩相同：\n$$\n\\mathbb{E}[|U|^2] = \\mathbb{E}[U^2] = \\text{Var}(U) + (\\mathbb{E}[U])^2 = 1 + 0^2 = 1\n$$\n因此，$|U|$ 的方差为：\n$$\n\\text{Var}(|U|) = \\mathbb{E}[|U|^2] - (\\mathbb{E}[|U|])^2 = 1 - \\left(\\sqrt{\\frac{2}{\\pi}}\\right)^2 = 1 - \\frac{2}{\\pi}\n$$\n系统输出的期望为：\n$\\mathbb{E}[Y_{1}] = \\mathbb{E}[\\alpha_{1} - a|U| + \\epsilon_{1}] = \\alpha_{1} - a\\mathbb{E}[|U|] + \\mathbb{E}[\\epsilon_{1}] = \\alpha_{1} - a\\sqrt{\\frac{2}{\\pi}}$\n$\\mathbb{E}[Y_{2}] = \\mathbb{E}[\\alpha_{2} + b|U| + \\epsilon_{2}] = \\alpha_{2} + b\\mathbb{E}[|U|] + \\mathbb{E}[\\epsilon_{2}] = \\alpha_{2} + b\\sqrt{\\frac{2}{\\pi}}$\n真实平均差异为 $\\mu_{\\Delta} = \\mathbb{E}[Y_1-Y_2] = (\\alpha_1-\\alpha_2) - (a+b)\\sqrt{\\frac{2}{\\pi}}$。\n\n**独立随机数（IRN）下的方差**\n单次重复差值估计量为 $\\hat{\\mu}_{\\Delta, \\text{IRN}} = Y_{1} - Y_{2} = (f_{1}(U_{1}) + \\epsilon_{1}) - (f_{2}(U_{2}) + \\epsilon_{2})$，其中 $U_{1}$、$U_{2}$、$\\epsilon_{1}$ 和 $\\epsilon_{2}$ 相互独立。方差是独立项方差之和：\n$$\n\\text{Var}_{\\text{IRN}} = \\text{Var}(\\hat{\\mu}_{\\Delta, \\text{IRN}}) = \\text{Var}(f_{1}(U_{1})) + \\text{Var}(\\epsilon_{1}) + \\text{Var}(f_{2}(U_{2})) + \\text{Var}(\\epsilon_{2})\n$$\n我们计算函数输出的方差：\n$$\n\\text{Var}(f_{1}(U_{1})) = \\text{Var}(\\alpha_{1} - a|U_{1}|) = (-a)^2 \\text{Var}(|U_{1}|) = a^2 \\left(1 - \\frac{2}{\\pi}\\right)\n$$\n$$\n\\text{Var}(f_{2}(U_{2})) = \\text{Var}(\\alpha_{2} + b|U_{2}|) = b^2 \\text{Var}(|U_{2}|) = b^2 \\left(1 - \\frac{2}{\\pi}\\right)\n$$\n给定的噪声方差为 $\\text{Var}(\\epsilon_{1}) = \\sigma_{1}^2$ 和 $\\text{Var}(\\epsilon_{2}) = \\sigma_{2}^2$。\n将这些代入 $\\text{Var}_{\\text{IRN}}$ 的表达式中：\n$$\n\\text{Var}_{\\text{IRN}} = a^2 \\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^2 + b^2 \\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{2}^2 = (a^2+b^2)\\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^2 + \\sigma_{2}^2\n$$\n\n**公共随机数（CRN）下的方差**\n单次重复差值估计量为 $\\hat{\\mu}_{\\Delta, \\text{CRN}} = Y_{1} - Y_{2} = (f_{1}(U) + \\epsilon_{1}) - (f_{2}(U) + \\epsilon_{2})$，其中同一个随机数 $U$ 驱动两个系统。方差为：\n$$\n\\text{Var}_{\\text{CRN}} = \\text{Var}(\\hat{\\mu}_{\\Delta, \\text{CRN}}) = \\text{Var}( (f_{1}(U) - f_{2}(U)) + (\\epsilon_{1} - \\epsilon_{2}) )\n$$\n因为 $U$、$\\epsilon_{1}$ 和 $\\epsilon_{2}$ 相互独立，和的方差等于方差的和：\n$$\n\\text{Var}_{\\text{CRN}} = \\text{Var}(f_{1}(U) - f_{2}(U)) + \\text{Var}(\\epsilon_{1} - \\epsilon_{2})\n$$\n函数之差为 $f_{1}(U) - f_{2}(U) = (\\alpha_{1} - a|U|) - (\\alpha_{2} + b|U|) = (\\alpha_{1} - \\alpha_{2}) - (a+b)|U|$。\n这个差的方差为：\n$$\n\\text{Var}(f_{1}(U) - f_{2}(U)) = \\text{Var}((\\alpha_{1} - \\alpha_{2}) - (a+b)|U|) = (-(a+b))^2 \\text{Var}(|U|) = (a+b)^2 \\left(1 - \\frac{2}{\\pi}\\right)\n$$\n噪声差的方差为 $\\text{Var}(\\epsilon_{1} - \\epsilon_{2}) = \\text{Var}(\\epsilon_{1}) + \\text{Var}(- \\epsilon_{2}) = \\text{Var}(\\epsilon_{1}) + \\text{Var}(\\epsilon_{2}) = \\sigma_{1}^2 + \\sigma_{2}^2$。\n将这些代入 $\\text{Var}_{\\text{CRN}}$ 的表达式中：\n$$\n\\text{Var}_{\\text{CRN}} = (a+b)^2 \\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^2 + \\sigma_{2}^2\n$$\n\n**方差膨胀比 (R)**\n比率 $R$ 定义为 CRN 方差除以 IRN 方差：\n$$\nR = \\frac{\\text{Var}_{\\text{CRN}}}{\\text{Var}_{\\text{IRN}}} = \\frac{(a+b)^2 \\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^2 + \\sigma_{2}^2}{(a^2+b^2)\\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^2 + \\sigma_{2}^2}\n$$\n\n**诊断量 (D)**\n如果 $\\text{Cov}(Y_{1}, Y_{2})  0$，CRN 可以缩减方差。根据性质 $\\text{Var}(Y_1 - Y_2) = \\text{Var}(Y_1) + \\text{Var}(Y_2) - 2\\text{Cov}(Y_1, Y_2)$，正协方差可以减小差的方差。在这里，\n$$\n\\text{Cov}(Y_{1}, Y_{2}) = \\text{Cov}(f_{1}(U) + \\epsilon_1, f_{2}(U) + \\epsilon_2) = \\text{Cov}(f_{1}(U), f_{2}(U))\n$$\n这是由于噪声项的独立性。\n基于局部线性的启发式方法表明，该协方差的符号通常由响应函数导数之积的符号所指示。局部回归斜率是导数 $f_{1}'(U)$ 和 $f_{2}'(U)$：\n$$\nf_{1}'(U) = \\frac{d}{dU}(\\alpha_{1} - a|U|) = -a \\cdot \\text{sgn}(U) = \\begin{cases} a,  U  0, \\\\ -a,  U  0, \\end{cases}\n$$\n$$\nf_{2}'(U) = \\frac{d}{dU}(\\alpha_{2} + b|U|) = b \\cdot \\text{sgn}(U) = \\begin{cases} -b,  U  0, \\\\ b,  U  0, \\end{cases}\n$$\n这些导数在 $U \\ne 0$ 时有定义。诊断量基于这些斜率的乘积 $f_{1}'(U)f_{2}'(U)$。\n对于 $U  0$，乘积为 $(a)(-b) = -ab$。\n对于 $U  0$，乘积为 $(-a)(b) = -ab$。\n对于几乎所有的 $U$（即对于所有 $U \\in \\mathbb{R} \\setminus \\{0\\}$），该乘积是一个常数 $-ab$。诊断量 $D$ 就是这个乘积，它表示了在 $U$ 的定义域内局部斜率之间的一致关系。\n$$\nD = -ab\n$$\n由于 $a  0$ 和 $b  0$，$D$ 的符号为负。这正确地预测了 $\\text{Cov}(f_{1}(U), f_{2}(U))$ 为负，因此在该特定问题中，CRN 不适用于方差缩减。我们可以用精确的协方差来验证这一点：\n$\\text{Cov}(f_{1}(U), f_{2}(U)) = \\text{Cov}(\\alpha_{1} - a|U|, \\alpha_{2} + b|U|) = -ab \\cdot \\text{Var}(|U|) = -ab\\left(1 - \\frac{2}{\\pi}\\right)$。由于 $1  2/\\pi$，该协方差确实为负。\n\n最终结果是 $R$ 和 $D$ 的表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(a+b)^{2} \\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^{2} + \\sigma_{2}^{2}}{(a^{2}+b^{2})\\left(1 - \\frac{2}{\\pi}\\right) + \\sigma_{1}^{2} + \\sigma_{2}^{2}}  -ab \\end{pmatrix}}\n$$", "id": "3360579"}]}