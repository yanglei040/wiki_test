{"hands_on_practices": [{"introduction": "掌握一种新技术的最佳方式莫过于亲手实践。本练习将指导您从第一性原理出发，为潜在狄利克雷分配（LDA）这一经典模型推导折叠吉布斯采样（collapsed Gibbs sampling）的更新方程。通过在一个具体的小规模实例上进行计算，您将巩固对该方法核心机制的理解。[@problem_id:3296126]", "problem": "考虑在潜在狄利克雷分布（Latent Dirichlet Allocation, LDA）的折叠吉布斯采样中的单令牌更新步骤。给定一个文档索引 $d$ 和一个留出令牌索引 $i$，其词语类型为 $v^{\\star}$。当前状态从所有计数中排除了令牌 $i$（用上标 $-i$ 表示）。共有 $K=3$ 个主题和一个大小为 $V=4$ 的词汇表。文档-主题比例的狄利克雷先验是 $\\operatorname{Dirichlet}(\\boldsymbol{\\alpha})$，其中 $\\boldsymbol{\\alpha}=(\\alpha_{1},\\alpha_{2},\\alpha_{3})=(0.7,0.5,0.3)$。每个主题-词语分布的狄利克雷先验是对称的 $\\operatorname{Dirichlet}(\\beta \\boldsymbol{1}_{V})$，其中 $\\beta=0.2$。留出的词语令牌是 $v^{\\star}=3$。不包括令牌 $i$ 的观测计数如下：\n- 文档 $d$ 的文档-主题计数：$(n_{d,1}^{-i},n_{d,2}^{-i},n_{d,3}^{-i})=(3,1,0)$。\n- 在整个语料库上聚合的主题-词语计数：\n  - 主题 $k=1$：总数为 $n_{1,\\cdot}^{-i}=10$，其中词语 $v=3$ 的计数为 $n_{1,3}^{-i}=2$。\n  - 主题 $k=2$：总数为 $n_{2,\\cdot}^{-i}=5$，其中词语 $v=3$ 的计数为 $n_{2,3}^{-i}=1$。\n  - 主题 $k=3$：总数为 $n_{3,\\cdot}^{-i}=8$，其中词语 $v=3$ 的计数为 $n_{3,3}^{-i}=4$。\n\n仅从潜在狄利克雷分布生成模型、狄利克雷密度、狄利克雷-多项式共轭性和贝叶斯规则的基本定义出发，执行以下操作：\n\n1) 通过对所有文档-主题比例和所有主题-词语分布进行积分，从第一性原理推导给定 $(\\boldsymbol{z}_{-i},\\boldsymbol{w})$ 时 $z_{i}$ 的折叠条件分配分布。您的推导必须明确展示狄利克雷-多项式积分如何引入并简化。\n\n2) 使用您推导出的表达式，计算令牌 $i$ 的主题 $k=1,2,3$ 的三个未归一化分配权重，然后将它们归一化以获得分配概率。在可能的情况下，保持所有中间计算的精确性。\n\n3) 通过评估仅在 $z_{i}$ 设置上不同的两种配置下的折叠联合密度 $p(\\boldsymbol{w},\\boldsymbol{z}\\,|\\,\\boldsymbol{\\alpha},\\beta)$ 之比，并确认该比率等于您计算出的相应未归一化分配权重之比，来独立地数值验证您的折叠条件与折叠联合是一致的。证明该等式至少对一对非平凡主题成立。\n\n仅报告令牌 $i$ 的主题 $k=2$ 的归一化分配概率，以单个最简分数形式表示。不包含任何单位。不要四舍五入。", "solution": "该问题被评估为有效，因为它科学地基于潜在狄利克雷分布（LDA）的既定理论，其参数和数据完整且一致，问题陈述清晰，并以客观、正式的语言表达。这是贝叶斯机器学习中的一个标准问题，它有一个唯一的、可验证的解。我们开始解答。\n\n该问题要求完成三项任务：推导LDA的折叠吉布斯采样更新规则，计算特定令牌的分配概率，以及对结果进行数值验证。\n\n### 1. 折叠条件分布的推导\n\nLDA折叠吉布斯采样的目标是从给定所有其他主题分配 $\\boldsymbol{z}_{-i}$ 和所有观测词语 $\\boldsymbol{w}$ 的条件下，为单个令牌 $i$ 的主题分配 $z_i$ 进行采样。模型参数，即文档-主题比例 $\\boldsymbol{\\theta} = \\{\\boldsymbol{\\theta}_d\\}_{d=1}^D$ 和主题-词语分布 $\\boldsymbol{\\phi} = \\{\\boldsymbol{\\phi}_k\\}_{k=1}^K$，被积分掉（折叠）。\n\n根据贝叶斯规则，所求的条件概率为：\n$$p(z_i = k | \\boldsymbol{z}_{-i}, \\boldsymbol{w}, \\boldsymbol{\\alpha}, \\beta) \\propto p(z_i = k, \\boldsymbol{z}_{-i}, \\boldsymbol{w} | \\boldsymbol{\\alpha}, \\beta) = p(\\boldsymbol{z}, \\boldsymbol{w} | \\boldsymbol{\\alpha}, \\beta)$$\n其中完整的分配向量是 $\\boldsymbol{z} = (z_i=k, \\boldsymbol{z}_{-i})$。项 $p(\\boldsymbol{z}, \\boldsymbol{w} | \\boldsymbol{\\alpha}, \\beta)$ 是在积分掉参数 $\\boldsymbol{\\theta}$ 和 $\\boldsymbol{\\phi}$ 后，分配和词语的边际似然。\n\n完整的生成模型定义为：\n$p(\\boldsymbol{w}, \\boldsymbol{z}, \\boldsymbol{\\theta}, \\boldsymbol{\\phi} | \\boldsymbol{\\alpha}, \\beta) = p(\\boldsymbol{w} | \\boldsymbol{z}, \\boldsymbol{\\phi}) p(\\boldsymbol{z} | \\boldsymbol{\\theta}) p(\\boldsymbol{\\theta} | \\boldsymbol{\\alpha}) p(\\boldsymbol{\\phi} | \\beta)$。\n由于条件独立性，这可以写成：\n$$p(\\boldsymbol{w}, \\boldsymbol{z}, \\boldsymbol{\\theta}, \\boldsymbol{\\phi} | \\boldsymbol{\\alpha}, \\beta) = \\left( \\prod_{d=1}^{D} p(\\boldsymbol{z}_d|\\boldsymbol{\\theta}_d)p(\\boldsymbol{\\theta}_d|\\boldsymbol{\\alpha}) \\right) \\left( \\prod_{k=1}^{K} p(\\boldsymbol{w}^{(k)}|\\boldsymbol{\\phi}_k)p(\\boldsymbol{\\phi}_k|\\beta) \\right)$$\n其中 $\\boldsymbol{w}^{(k)}$ 是分配给主题 $k$ 的词语。\n\n我们积分掉 $\\boldsymbol{\\theta}$ 和 $\\boldsymbol{\\phi}$：\n$$p(\\boldsymbol{z}, \\boldsymbol{w} | \\boldsymbol{\\alpha}, \\beta) = \\int p(\\boldsymbol{\\theta}|\\boldsymbol{\\alpha})p(\\boldsymbol{z}|\\boldsymbol{\\theta})\\,d\\boldsymbol{\\theta} \\int p(\\boldsymbol{\\phi}|\\beta)p(\\boldsymbol{w}|\\boldsymbol{z},\\boldsymbol{\\phi})\\,d\\boldsymbol{\\phi}$$\n我们来计算每个积分。似然 $p(\\boldsymbol{z}|\\boldsymbol{\\theta})$ 和 $p(\\boldsymbol{w}|\\boldsymbol{z},\\boldsymbol{\\phi})$ 是多项式分布，而先验 $p(\\boldsymbol{\\theta}|\\boldsymbol{\\alpha})$ 和 $p(\\boldsymbol{\\phi}|\\beta)$ 是狄利克雷分布。这是一个共轭配对。\n\n对 $\\boldsymbol{\\theta}$ 的积分是文档上的狄利克雷-多项式边际似然的乘积：\n$$\\int \\prod_{d=1}^{D} p(\\boldsymbol{z}_d|\\boldsymbol{\\theta}_d)p(\\boldsymbol{\\theta}_d|\\boldsymbol{\\alpha})\\,d\\boldsymbol{\\theta}_d = \\prod_{d=1}^{D} \\frac{\\Gamma(\\sum_k \\alpha_k)}{\\prod_k \\Gamma(\\alpha_k)} \\frac{\\prod_k \\Gamma(n_{d,k} + \\alpha_k)}{\\Gamma(\\sum_k(n_{d,k} + \\alpha_k))}$$\n其中 $n_{d,k}$ 是文档 $d$ 中分配给主题 $k$ 的令牌数量。\n\n类似地，对 $\\boldsymbol{\\phi}$ 的积分是主题上的乘积：\n$$\\int \\prod_{k=1}^{K} p(\\boldsymbol{w}^{(k)}|\\boldsymbol{\\phi}_k)p(\\boldsymbol{\\phi}_k|\\beta)\\,d\\boldsymbol{\\phi}_k = \\prod_{k=1}^{K} \\frac{\\Gamma(V\\beta)}{\\Gamma(\\beta)^V} \\frac{\\prod_v \\Gamma(n_{k,v} + \\beta)}{\\Gamma(\\sum_v(n_{k,v} + \\beta))}$$\n其中 $n_{k,v}$ 是在整个语料库中词语类型 $v$ 被分配给主题 $k$ 的次数。\n\n完整的折叠联合概率是这些项的乘积。为了找到条件概率 $p(z_i = k | \\boldsymbol{z}_{-i}, \\boldsymbol{w})$，我们分析当单个令牌 $i$ 的分配 $z_i$ 变化时，折叠联合概率 $p(\\boldsymbol{z}, \\boldsymbol{w})$ 如何变化。假设这个令牌在文档 $d$ 中，其词语类型为 $v^{\\star}$。计数之间的关系为 $n_{d,k} = n_{d,k}^{-i} + \\delta(z_i, k)$ 和 $n_{k,v^{\\star}} = n_{k,v^{\\star}}^{-i} + \\delta(z_i, k)$，其中 $\\delta$ 是克罗内克δ函数，带上标 $-i$ 的计数表示不包括令牌 $i$。联合概率中所有不依赖于 $k$ 的项对于采样决策都是常数，可以被吸收到比例常数中。\n\n随 $z_i$ 的主题 $k$ 的选择而变化的项是：\n1. 从文档-主题部分，对于文档 $d$：$\\Gamma(n_{d,k} + \\alpha_k)$。\n2. 从主题-词语部分，对于主题 $k$：$\\prod_v \\Gamma(n_{k,v} + \\beta)$ 和 $\\Gamma(\\sum_v(n_{k,v} + \\beta))$。\n\n我们来看一下 $z_i=k$ 时的联合概率与移除了令牌 $i$ 的基线状态的比率。\n文档-主题项的变化是：\n$$\\frac{\\Gamma(n_{d,k}^{-i}+1+\\alpha_k)}{\\Gamma(n_{d,k}^{-i}+\\alpha_k)} \\frac{\\Gamma(n_{d,\\cdot}^{-i}+\\sum_j \\alpha_j)}{\\Gamma(n_{d,\\cdot}^{-i}+1+\\sum_j \\alpha_j)} = \\frac{n_{d,k}^{-i}+\\alpha_k}{n_{d,\\cdot}^{-i}+\\sum_j \\alpha_j}$$\n使用属性 $\\Gamma(x+1)=x\\Gamma(x)$。\n\n主题 $k$（词语为 $w_i=v^{\\star}$）的主题-词语项的变化是：\n$$\\frac{\\Gamma(n_{k,v^{\\star}}^{-i}+1+\\beta)}{\\Gamma(n_{k,v^{\\star}}^{-i}+\\beta)} \\frac{\\Gamma(n_{k,\\cdot}^{-i}+V\\beta)}{\\Gamma(n_{k,\\cdot}^{-i}+1+V\\beta)} = \\frac{n_{k,v^{\\star}}^{-i}+\\beta}{n_{k,\\cdot}^{-i}+V\\beta}$$\n\n结合这些项，条件概率与这些因子的乘积成正比：\n$$p(z_i = k | \\boldsymbol{z}_{-i}, \\boldsymbol{w}) \\propto \\frac{n_{d,k}^{-i}+\\alpha_k}{n_{d,\\cdot}^{-i}+\\sum_j \\alpha_j} \\times \\frac{n_{k,v^{\\star}}^{-i}+\\beta}{n_{k,\\cdot}^{-i}+V\\beta}$$\n项 $n_{d,\\cdot}^{-i}+\\sum_j \\alpha_j$ 相对于 $k$ 是一个常数，因此可以从未归一化权重中去掉。因此，未归一化的分配权重 $W_k$ 是：\n$$W_k \\propto (n_{d,k}^{-i} + \\alpha_k) \\times \\frac{n_{k,v^{\\star}}^{-i} + \\beta}{n_{k,\\cdot}^{-i} + V\\beta}$$\n推导至此完成。\n\n### 2. 分配概率的计算\n\n我们得到以下数据：\n- 主题数 $K=3$。\n- 词汇表大小 $V=4$。\n- 文档-主题先验 $\\boldsymbol{\\alpha}=(\\alpha_{1},\\alpha_{2},\\alpha_{3})=(0.7,0.5,0.3)$。\n- 主题-词语先验参数 $\\beta=0.2$。\n- 留出的词语类型 $v^{\\star}=3$。\n- 文档 $d$ 的文档-主题计数：$(n_{d,1}^{-i},n_{d,2}^{-i},n_{d,3}^{-i})=(3,1,0)$。\n- 主题-词语计数：\n  - $k=1$：$n_{1,\\cdot}^{-i}=10$, $n_{1,3}^{-i}=2$。\n  - $k=2$：$n_{2,\\cdot}^{-i}=5$, $n_{2,3}^{-i}=1$。\n  - $k=3$：$n_{3,\\cdot}^{-i}=8$, $n_{3,3}^{-i}=4$。\n\n常数项是 $V\\beta = 4 \\times 0.2 = 0.8$。我们为每个主题 $k \\in \\{1,2,3\\}$ 计算未归一化权重 $W_k$。\n\n对于主题 $k=1$：\n$$W_1 = (n_{d,1}^{-i} + \\alpha_1) \\times \\frac{n_{1,3}^{-i} + \\beta}{n_{1,\\cdot}^{-i} + V\\beta} = (3 + 0.7) \\times \\frac{2 + 0.2}{10 + 0.8} = 3.7 \\times \\frac{2.2}{10.8} = \\frac{37}{10} \\times \\frac{22}{108} = \\frac{37 \\times 11}{10 \\times 54} = \\frac{407}{540}$$\n\n对于主题 $k=2$：\n$$W_2 = (n_{d,2}^{-i} + \\alpha_2) \\times \\frac{n_{2,3}^{-i} + \\beta}{n_{2,\\cdot}^{-i} + V\\beta} = (1 + 0.5) \\times \\frac{1 + 0.2}{5 + 0.8} = 1.5 \\times \\frac{1.2}{5.8} = \\frac{3}{2} \\times \\frac{12}{58} = \\frac{18}{58} = \\frac{9}{29}$$\n\n对于主题 $k=3$：\n$$W_3 = (n_{d,3}^{-i} + \\alpha_3) \\times \\frac{n_{3,3}^{-i} + \\beta}{n_{3,\\cdot}^{-i} + V\\beta} = (0 + 0.3) \\times \\frac{4 + 0.2}{8 + 0.8} = 0.3 \\times \\frac{4.2}{8.8} = \\frac{3}{10} \\times \\frac{42}{88} = \\frac{3 \\times 21}{10 \\times 44} = \\frac{63}{440}$$\n\n总的未归一化权重是 $W_{total} = W_1 + W_2 + W_3$：\n$$W_{total} = \\frac{407}{540} + \\frac{9}{29} + \\frac{63}{440}$$\n$540=2^2 \\cdot 3^3 \\cdot 5$、$29$ 和 $440=2^3 \\cdot 5 \\cdot 11$ 的最小公分母是 $2^3 \\cdot 3^3 \\cdot 5 \\cdot 11 \\cdot 29 = 344520$。\n$$W_{total} = \\frac{407 \\cdot 638}{344520} + \\frac{9 \\cdot 11880}{344520} + \\frac{63 \\cdot 783}{344520} = \\frac{259666 + 106920 + 49329}{344520} = \\frac{415915}{344520}$$\n除以 $5$ 进行化简：\n$$W_{total} = \\frac{83183}{68904}$$\n归一化概率 $P_k = W_k / W_{total}$。\n对于 $k=2$ 的概率 $P_2$:\n$P_2 = \\frac{W_2}{W_{total}} = \\frac{9/29}{83183/68904} = \\frac{9}{29} \\times \\frac{68904}{83183} = \\frac{9 \\times 2376}{83183} = \\frac{21384}{83183}$。\n分子 $21384$ 的质因数是 $2^3 \\cdot 3 \\cdot 7 \\cdot 127$。分母 $83183$ 是一个质数。因此，该分数已是最简形式。\n\n### 3. 数值验证\n\n我们验证对于 $z_i$ 的两个不同分配，条件概率之比等于完整折叠联合概率之比。令 $\\boldsymbol{z}$ 为 $z_i=1$ 时的配置，$\\boldsymbol{z}'$ 为 $z_i=2$ 时的配置。我们必须证明 $\\frac{W_2}{W_1} = \\frac{p(\\boldsymbol{w}, \\boldsymbol{z}')}{p(\\boldsymbol{w}, \\boldsymbol{z})}$。\n\n未归一化权重的比率：\n$$\\frac{W_2}{W_1} = \\frac{9/29}{407/540} = \\frac{9}{29} \\times \\frac{540}{407} = \\frac{4860}{11803}$$\n\n联合概率的比率：\n联合概率由伽马函数比率的乘积给出。在计算比率 $\\frac{p(\\boldsymbol{w}, \\boldsymbol{z}')}{p(\\boldsymbol{w}, \\boldsymbol{z})}$ 时，大多数项会消掉。唯一不消掉的项是那些与 $\\boldsymbol{z}$ 和 $\\boldsymbol{z}'$ 之间不同的计数相关的项。\n- 对于 $\\boldsymbol{z}$：$z_i=1$。更新的计数是 $n_{d,1}$, $n_{d,\\cdot}$, $n_{1,v^{\\star}}$, $n_{1,\\cdot}$。\n- 对于 $\\boldsymbol{z}'$：$z_i=2$。更新的计数是 $n_{d,2}$, $n_{d,\\cdot}$, $n_{2,v^{\\star}}$, $n_{2,\\cdot}$。\n联合概率的比率是：\n$$\\frac{p(\\boldsymbol{w}, \\boldsymbol{z}')}{p(\\boldsymbol{w}, \\boldsymbol{z})} = \\frac{\\Gamma(n_{d,1}^{-i}+\\alpha_1) \\Gamma(n_{d,2}^{-i}+1+\\alpha_2)}{\\Gamma(n_{d,1}^{-i}+1+\\alpha_1) \\Gamma(n_{d,2}^{-i}+\\alpha_2)} \\times \\frac{\\frac{\\prod_v \\Gamma(n_{1,v}^{-i \\prime}+\\beta) \\prod_v \\Gamma(n_{2,v}^{-i \\prime \\prime}+\\beta)}{\\Gamma(n_{1,\\cdot}^{-i}+V\\beta)\\Gamma(n_{2,\\cdot}^{-i}+1+V\\beta)}}{\\frac{\\prod_v \\Gamma(n_{1,v}^{-i \\prime \\prime \\prime}+\\beta) \\prod_v \\Gamma(n_{2,v}^{-i \\prime \\prime \\prime \\prime}+\\beta)}{\\Gamma(n_{1,\\cdot}^{-i}+1+V\\beta)\\Gamma(n_{2,\\cdot}^{-i}+V\\beta)}}$$\n这可以简化为：\n$$ \\frac{p(\\boldsymbol{w}, \\boldsymbol{z}')}{p(\\boldsymbol{w}, \\boldsymbol{z})} = \\frac{n_{d,2}^{-i}+\\alpha_2}{n_{d,1}^{-i}+\\alpha_1} \\times \\frac{(n_{2,v^{\\star}}^{-i}+\\beta)/(n_{1,v^{\\star}}^{-i}+\\beta)}{(n_{2,\\cdot}^{-i}+V\\beta)/(n_{1,\\cdot}^{-i}+V\\beta)} = \\frac{n_{d,2}^{-i}+\\alpha_2}{n_{d,1}^{-i}+\\alpha_1} \\times \\frac{n_{2,v^{\\star}}^{-i}+\\beta}{n_{2,\\cdot}^{-i}+V\\beta} \\times \\frac{n_{1,\\cdot}^{-i}+V\\beta}{n_{1,v^{\\star}}^{-i}+\\beta} $$\n这恰好是简化常数之前的 $\\frac{W_2}{W_1}$。代入数字：\n$$ \\frac{p(\\boldsymbol{w}, \\boldsymbol{z}')}{p(\\boldsymbol{w}, \\boldsymbol{z})} = \\frac{1+0.5}{3+0.7} \\times \\frac{1+0.2}{5+0.8} \\times \\frac{10+0.8}{2+0.2} = \\frac{1.5}{3.7} \\times \\frac{1.2}{5.8} \\times \\frac{10.8}{2.2} = \\frac{15}{37} \\times \\frac{12}{58} \\times \\frac{108}{22} $$\n$$ = \\frac{15}{37} \\times \\frac{6}{29} \\times \\frac{54}{11} = \\frac{15 \\times 324}{37 \\times 319} = \\frac{4860}{11803} $$\n这与权重比率 $\\frac{W_2}{W_1}$ 完全匹配，从而证实了推导和计算的一致性。\n\n要求的最终答案是主题 $k=2$ 的归一化分配概率。\n$$ P_2 = \\frac{21384}{83183} $$", "answer": "$$\\boxed{\\frac{21384}{83183}}$$", "id": "3296126"}, {"introduction": "在掌握了折叠吉布斯采样的基本推导之后，深入理解超参数如何影响模型行为至关重要。本练习将引导您探究 LDA 模型中的超参数 $\\alpha$ 和 $\\beta$ 如何塑造主题分配的动态，并分析在稀疏和密集先验的极限情况下模型的行为。这项实践有助于培养对贝叶斯模型中先验选择的直觉。[@problem_id:3296154]", "problem": "考虑具有对称狄利克雷先验的隐狄利克雷分配（Latent Dirichlet Allocation, LDA），其中对于每个主题 $k \\in \\{1,\\dots,K\\}$，主题-词分布 $\\phi_{k}$ 从 $\\phi_{k} \\sim \\mathrm{Dirichlet}_{V}(\\beta)$ 中抽取；对于每个文档 $d$，文档-主题比例 $\\theta_{d}$ 从 $\\theta_{d} \\sim \\mathrm{Dirichlet}_{K}(\\alpha)$ 中抽取，其中 $\\alpha > 0$ 且 $\\beta > 0$。对于文档 $d$ 中的每个词元 $i$，主题分配 $z_{di}$ 从 $z_{di} \\sim \\mathrm{Categorical}(\\theta_{d})$ 中抽取，一个词 $w_{di}$ 从 $w_{di} \\sim \\mathrm{Categorical}(\\phi_{z_{di}})$ 中抽取。在崩塌吉布斯采样（collapsed Gibbs sampling）中，文档-主题比例和主题-词分布被解析地积分掉。令 $w_{di}$ 表示文档 $d$ 中词元 $i$ 的观测词类型，并用 $z_{-i}$ 和 $w_{-i}$ 表示除词元 $i$ 之外所有位置的分配和词元。定义排除词元 $i$ 的常用计数符号：$n_{dk}^{-i}$ 是文档 $d$ 中分配给主题 $k$ 的词元数，$n_{kv}^{-i}$ 是分配给主题 $k$ 且词类型为 $v$ 的词元数，以及 $n_{k\\cdot}^{-i} = \\sum_{v=1}^{V} n_{kv}^{-i}$。\n\n您的任务是：\n- 仅使用贝叶斯法则、狄利克雷分布的定义以及狄利克雷-多项式共轭性，从第一性原理推导单个词元的崩塌吉布斯转移，即在给定 $z_{-i}$ 和 $w$ 的条件下 $z_{di}$ 的条件分布（直到一个比例常数）。不要假设任何预先给定的崩塌公式。\n- 使用您推导出的表达式，定性解释超参数 $\\alpha$ 和 $\\beta$ 如何影响 $z_{di}$ 的崩塌吉布斯转移概率，重点关注文档级主题频率和主题级词频率的相对权重。\n- 推导极限归一化条件概率 $\\lim_{\\alpha,\\beta \\to 0^{+}} \\Pr\\!\\big(z_{di} = k \\mid z_{-i}, w, \\alpha, \\beta\\big)$ 和 $\\lim_{\\alpha,\\beta \\to \\infty} \\Pr\\!\\big(z_{di} = k \\mid z_{-i}, w, \\alpha, \\beta\\big)$，并说明在什么条件下这些极限会给某个主题分配非零质量。\n\n现在将这些结果应用于一个具体实例，其中有 $K = 3$ 个主题，词汇量大小 $V = 6$。考虑一个特定文档 $d$ 和词元位置 $i$，在该位置观察到的词类型为 $v^{\\star}$。排除词元 $i$ 后的语料库计数如下：\n- 文档计数：$n_{d1}^{-i} = 2$， $n_{d2}^{-i} = 0$， $n_{d3}^{-i} = 5$。\n- 主题总计：$n_{1\\cdot}^{-i} = 20$， $n_{2\\cdot}^{-i} = 15$， $n_{3\\cdot}^{-i} = 1$。\n- 针对 $v^{\\star}$ 的特定词计数：$n_{1 v^{\\star}}^{-i} = 3$， $n_{2 v^{\\star}}^{-i} = 0$， $n_{3 v^{\\star}}^{-i} = 1$。\n\n计算在 $\\alpha,\\beta \\to 0^{+}$（稀疏先验）和 $\\alpha,\\beta \\to \\infty$（弥散先验）这两种情况下，分配 $z_{di} = 3$ 的精确极限归一化条件概率。将您的最终答案以一个行矩阵的形式给出，该矩阵按顺序包含这两个精确概率 $\\big(\\lim_{\\alpha,\\beta \\to 0^{+}} \\Pr(z_{di}=3 \\mid \\cdot),\\ \\lim_{\\alpha,\\beta \\to \\infty} \\Pr(z_{di}=3 \\mid \\cdot)\\big)$。无需四舍五入，不涉及单位。", "solution": "所提出的问题是有效的，因为它在科学上基于已建立的隐狄利克雷分配（LDA）和崩塌吉布斯采样理论，信息充分、问题明确，可以得到唯一解，并且表述客观。我们着手求解。\n\n核心任务是推导在给定所有其他分配 $z_{-i}$ 和所有观测词 $w$ 的情况下，单个主题分配 $z_{di}$ 的条件概率。这就是崩塌吉布斯采样的更新规则。术语“崩塌”指的是连续参数 $\\theta_d$（文档-主题比例）和 $\\phi_k$（主题-词分布）被积分掉的事实。\n\n首先，我们推导 $z_{di}=k$ 的一般崩塌吉布斯采样转移概率。根据贝叶斯法则，所求的条件概率为：\n$$\n\\Pr(z_{di}=k \\mid z_{-i}, w, \\alpha, \\beta) = \\frac{\\Pr(w, z)}{\\Pr(w, z_{-i})} = \\frac{\\Pr(w, z)}{\\sum_{j=1}^K \\Pr(w, z_{di}=j, z_{-i})}\n$$\n我们只需要找到一个与分子成正比的表达式，因为分母只是一个归一化常数。\n$$\n\\Pr(z_{di}=k \\mid z_{-i}, w, \\alpha, \\beta) \\propto \\Pr(w, z \\mid \\alpha, \\beta)\n$$\n其中 $z$ 表示主题分配 $\\{z_{di}\\}$ 的完整集合。我们可以将联合概率 $\\Pr(w, z \\mid \\alpha, \\beta)$ 分解为 $\\Pr(w \\mid z, \\beta) \\Pr(z \\mid \\alpha)$。参数 $\\theta$ 和 $\\phi$ 已被积分掉。\n\n项 $\\Pr(z \\mid \\alpha)$ 涉及主题分配。在每个文档 $d$ 中，分配 $z_d = \\{z_{d1}, z_{d2}, \\dots \\}$ 是从一个共享的 $\\theta_d \\sim \\mathrm{Dirichlet}_K(\\alpha)$ 生成的。由于狄利克雷-多项式共轭的性质，我们可以积分掉 $\\theta_d$：\n$$\n\\Pr(z_d \\mid \\alpha) = \\int \\Pr(z_d \\mid \\theta_d) \\Pr(\\theta_d \\mid \\alpha) d\\theta_d = \\int \\left( \\prod_{k=1}^K \\theta_{dk}^{n_{dk}} \\right) \\frac{\\Gamma(K\\alpha)}{\\Gamma(\\alpha)^K} \\left( \\prod_{k=1}^K \\theta_{dk}^{\\alpha-1} \\right) d\\theta_d\n$$\n其中 $n_{dk}$ 是文档 $d$ 中分配给主题 $k$ 的词元计数。这积分得到狄利克雷-多项式分布：\n$$\n\\Pr(z_d \\mid \\alpha) = \\frac{\\Gamma(K\\alpha)}{\\Gamma(\\alpha)^K} \\frac{\\prod_{k=1}^K \\Gamma(n_{dk}+\\alpha)}{\\Gamma(n_{d\\cdot}+K\\alpha)}\n$$\n其中 $n_{d\\cdot} = \\sum_k n_{dk}$。由于主题分配在不同文档间是独立的，因此 $\\Pr(z \\mid \\alpha) = \\prod_d \\Pr(z_d \\mid \\alpha)$。\n\n类似地，项 $\\Pr(w \\mid z, \\beta)$ 涉及词。给定主题分配 $z$，词是从主题-词分布 $\\phi_k \\sim \\mathrm{Dirichlet}_V(\\beta)$ 生成的。对于每个主题 $k$，我们可以积分掉 $\\phi_k$：\n$$\n\\Pr(w \\mid z, \\beta) = \\int \\Pr(w \\mid z, \\{\\phi_k\\}) \\Pr(\\{\\phi_k\\} \\mid \\beta) d\\{\\phi_k\\} = \\prod_{k=1}^K \\int \\Pr(w_k \\mid \\phi_k) \\Pr(\\phi_k \\mid \\beta) d\\phi_k\n$$\n其中 $w_k$ 是分配给主题 $k$ 的词。这产生了另一个狄利克雷-多项式概率的乘积：\n$$\n\\Pr(w \\mid z, \\beta) = \\prod_{k=1}^K \\frac{\\Gamma(V\\beta)}{\\Gamma(\\beta)^V} \\frac{\\prod_{v=1}^V \\Gamma(n_{kv}+\\beta)}{\\Gamma(n_{k\\cdot}+V\\beta)}\n$$\n其中 $n_{kv}$ 是主题 $k$ 中词类型 $v$ 的计数，$n_{k\\cdot} = \\sum_v n_{kv}$。\n\n为了找到 $z_{di}=k$ 的吉布斯采样更新，我们考察仅改变词元 $i$ 的分配前后联合概率 $\\Pr(w,z)$ 的比率。在 $\\Pr(z \\mid \\alpha)$ 和 $\\Pr(w \\mid z, \\beta)$ 的乘积中，与文档 $d$ 或主题 $k$ 无关的所有项都将抵消。计数关系为 $n_{dk} = n_{dk}^{-i} + 1$ 和 $n_{kv} = n_{kv}^{-i} + 1$（对于 $w_{di}=v$）。使用性质 $\\Gamma(x+1) = x\\Gamma(x)$：\n$$\n\\Pr(z_{di}=k \\mid z_{-i}, w) \\propto \\frac{\\Gamma(n_{dk}^{-i} + 1 + \\alpha)}{\\Gamma(n_{dk}^{-i} + \\alpha)} \\frac{\\Gamma(n_{d\\cdot}^{-i} + K\\alpha)}{\\Gamma(n_{d\\cdot}^{-i} + 1 + K\\alpha)} \\times \\frac{\\Gamma(n_{kv}^{-i} + 1 + \\beta)}{\\Gamma(n_{kv}^{-i} + \\beta)} \\frac{\\Gamma(n_{k\\cdot}^{-i} + V\\beta)}{\\Gamma(n_{k\\cdot}^{-i} + 1 + V\\beta)}\n$$\n使用 $\\Gamma(x+1) = x\\Gamma(x)$ 进行简化：\n$$\n\\Pr(z_{di}=k \\mid z_{-i}, w) \\propto (n_{dk}^{-i} + \\alpha) \\frac{1}{n_{d\\cdot}^{-i}+K\\alpha} \\times (n_{kv}^{-i}+\\beta) \\frac{1}{n_{k\\cdot}^{-i}+V\\beta}\n$$\n项 $n_{d\\cdot}^{-i}+K\\alpha$ 对所有主题 $k$ 都是相同的，可以从比例关系中去掉。因此，最终的崩塌吉布斯采样更新规则是：\n$$\n\\Pr(z_{di}=k \\mid z_{-i}, w, \\alpha, \\beta) \\propto (n_{dk}^{-i} + \\alpha) \\frac{n_{kv}^{-i} + \\beta}{n_{k\\cdot}^{-i} + V\\beta}\n$$\n此推导按要求使用了第一性原理。\n\n该表达式有两个主要部分：\n1.  $(n_{dk}^{-i} + \\alpha)$：此项反映了主题 $k$ 在文档 $d$ 中的普遍程度。\n2.  $\\frac{n_{kv}^{-i} + \\beta}{n_{k\\cdot}^{-i} + V\\beta}$：此项反映了词 $v=w_{di}$ 由主题 $k$ 生成的可能性有多大。\n\n超参数 $\\alpha$ 和 $\\beta$ 起到平滑伪计数的作用。\n-   $\\alpha$ 影响文档-主题分布。一个小的 $\\alpha$（例如 $\\alpha \\ll 1$）意味着先验偏好文档由少数主题生成（稀疏性）。更新概率主要由现有计数 $n_{dk}^{-i}$ 决定。一个大的 $\\alpha$ 意味着先验偏好文档包含许多主题的混合（密集性）。项 $(n_{dk}^{-i} + \\alpha)$ 对特定计数 $n_{dk}^{-i}$ 的敏感度降低，使得文档级分布更平坦，并给予未观察到的主题更高的机会。\n-   $\\beta$ 影响主题-词分布。一个小的 $\\beta$（例如 $\\beta \\ll 1$）意味着先验偏好主题由少数词组成。更新概率主要由观测计数的比率 $\\frac{n_{kv}^{-i}}{n_{k\\cdot}^{-i}}$ 决定。一个大的 $\\beta$ 意味着先验偏好主题包含词汇表中许多不同词的混合。项 $\\frac{n_{kv}^{-i} + \\beta}{n_{k\\cdot}^{-i} + V\\beta}$ 接近 $\\frac{1}{V}$，使得词-主题关联的信息量减少，并将主题-词分布推向均匀分布。\n\n接下来，我们推导极限归一化条件概率。令未归一化的概率为 $q_k(\\alpha, \\beta) = (n_{dk}^{-i} + \\alpha) \\frac{n_{kv}^{-i} + \\beta}{n_{k\\cdot}^{-i} + V\\beta}$。归一化概率为 $P_k = \\frac{q_k}{\\sum_{j=1}^K q_j}$。\n\n-   **极限当 $\\alpha, \\beta \\to 0^{+}$ (稀疏先验):**\n    我们分析当超参数趋近于零时 $q_k(\\alpha, \\beta)$ 的行为。\n    如果 $n_{dk}^{-i}=0$，那么 $q_k(\\alpha, \\beta) \\propto \\alpha$，它会消失。因此，一个主题要在极限下具有非零概率，它必须已经在文档中被观察到 ($n_{dk}^{-i} > 0$)。\n    如果 $n_{dk}^{-i} > 0$，那么 $\\lim_{\\alpha \\to 0^+} q_k(\\alpha, \\beta) = n_{dk}^{-i} \\lim_{\\beta \\to 0^+} \\frac{n_{kv}^{-i} + \\beta}{n_{k\\cdot}^{-i} + V\\beta}$。\n    - 如果 $n_{k\\cdot}^{-i} > 0$，极限为 $n_{dk}^{-i} \\frac{n_{kv}^{-i}}{n_{k\\cdot}^{-i}}$。\n    - 如果 $n_{k\\cdot}^{-i} = 0$，那么对于所有 $v$ 都有 $n_{kv}^{-i}=0$。极限为 $n_{dk}^{-i} \\lim_{\\beta \\to 0^+} \\frac{\\beta}{V\\beta} = \\frac{n_{dk}^{-i}}{V}$。\n    令 $L_k = \\lim_{\\alpha,\\beta \\to 0^{+}} q_k(\\alpha, \\beta)$（直到一个公共缩放因子）。所以，对于 $k \\in \\{1,\\dots,K\\}$：\n    $L_k = n_{dk}^{-i} \\frac{n_{kv}^{-i}}{n_{k\\cdot}^{-i}}$ 如果 $n_{dk}^{-i}>0$ 且 $n_{k\\cdot}^{-i}>0$。\n    $L_k = \\frac{n_{dk}^{-i}}{V}$ 如果 $n_{dk}^{-i}>0$ 且 $n_{k\\cdot}^{-i}=0$。\n    $L_k = 0$ 如果 $n_{dk}^{-i}=0$。\n    极限归一化概率为 $\\Pr(z_{di}=k|\\cdot) = \\frac{L_k}{\\sum_{j=1}^K L_j}$。一个主题 $k$ 只有在 $n_{dk}^{-i} > 0$ 的情况下才能具有非零质量。\n\n-   **极限当 $\\alpha, \\beta \\to \\infty$ (弥散先验):**\n    当 $\\alpha,\\beta \\to \\infty$ 时，计数 $n_{dk}^{-i}, n_{kv}^{-i}, n_{k\\cdot}^{-i}$ 变得可以忽略不计。\n    $q_k(\\alpha,\\beta) \\approx \\alpha \\frac{\\beta}{V\\beta} = \\frac{\\alpha}{V}$。\n    由于这种渐进行为对所有主题 $k$ 都相同，归一化概率变为均匀分布。\n    $$\n    \\lim_{\\alpha,\\beta \\to \\infty} \\Pr(z_{di}=k|\\cdot) = \\lim_{\\alpha,\\beta \\to \\infty} \\frac{q_k(\\alpha, \\beta)}{\\sum_{j=1}^K q_j(\\alpha, \\beta)} = \\frac{\\lim \\frac{\\alpha}{V}}{\\sum_{j=1}^K \\lim \\frac{\\alpha}{V}} = \\frac{\\frac{\\alpha}{V}}{K \\frac{\\alpha}{V}} = \\frac{1}{K}\n    $$\n    在这个极限下，每个主题都被分配了非零质量，即 $P_k = 1/K > 0$。\n\n现在我们将这些结果应用于给定的实例：\n$K=3$， $V=6$， $w_{di}=v^\\star$。\n计数：$n_{d1}^{-i} = 2$， $n_{d2}^{-i} = 0$， $n_{d3}^{-i} = 5$。\n$n_{1\\cdot}^{-i} = 20$， $n_{2\\cdot}^{-i} = 15$， $n_{3\\cdot}^{-i} = 1$。\n$n_{1v^\\star}^{-i} = 3$， $n_{2v^\\star}^{-i} = 0$， $n_{3v^\\star}^{-i} = 1$。\n\n-   **计算 $\\lim_{\\alpha,\\beta \\to 0^{+}} \\Pr(z_{di}=3|\\cdot)$:**\n    我们计算未归一化的分数 $L_k$。\n    对于 $k=1$：$n_{d1}^{-i}=2>0$ 且 $n_{1\\cdot}^{-i}=20>0$。\n    $L_1 = n_{d1}^{-i} \\frac{n_{1v^\\star}^{-i}}{n_{1\\cdot}^{-i}} = 2 \\times \\frac{3}{20} = \\frac{6}{20} = \\frac{3}{10}$。\n    对于 $k=2$：$n_{d2}^{-i}=0$。\n    $L_2 = 0$。\n    对于 $k=3$：$n_{d3}^{-i}=5>0$ 且 $n_{3\\cdot}^{-i}=1>0$。\n    $L_3 = n_{d3}^{-i} \\frac{n_{3v^\\star}^{-i}}{n_{3\\cdot}^{-i}} = 5 \\times \\frac{1}{1} = 5$。\n    总和为 $\\sum_{j=1}^3 L_j = L_1 + L_2 + L_3 = \\frac{3}{10} + 0 + 5 = \\frac{3+50}{10} = \\frac{53}{10}$。\n    $z_{di}=3$ 的归一化概率为：\n    $$\n    \\lim_{\\alpha,\\beta \\to 0^{+}} \\Pr(z_{di}=3|\\cdot) = \\frac{L_3}{\\sum_{j=1}^3 L_j} = \\frac{5}{\\frac{53}{10}} = \\frac{50}{53}\n    $$\n\n-   **计算 $\\lim_{\\alpha,\\beta \\to \\infty} \\Pr(z_{di}=3|\\cdot)$:**\n    根据推导，这个极限是 $\\frac{1}{K}$。当 $K=3$ 时：\n    $$\n    \\lim_{\\alpha,\\beta \\to \\infty} \\Pr(z_{di}=3|\\cdot) = \\frac{1}{3}\n    $$\n\n这两个精确概率是 $\\frac{50}{53}$ 和 $\\frac{1}{3}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{50}{53} & \\frac{1}{3}\n\\end{pmatrix}\n}\n$$", "id": "3296154"}, {"introduction": "理论上的优雅并不总能直接转化为实践中的优势。折叠吉布斯采样通过积分掉参数来改善马尔可夫链的混合速度，但通常会增加每次迭代的计算成本。本练习通过一个量化模型，让您分析这种计算成本与统计效率之间的权衡，并推导出一个临界条件，在该条件下，折叠采样器与非折叠采样器具有相同的效率。[@problem_id:3296131]", "problem": "考虑一个具有$K$个组分的潜变量有限混合模型，其中吉布斯采样在每次迭代中更新单个潜变量的分配。在一个非折叠吉布斯采样器中，每次迭代的计算成本为 $c>0$。在一个折叠吉布斯采样器中，对混合权重执行精确边缘化，这增加了一个与$K$成线性关系的额外单次迭代成本，因此折叠采样器的单次迭代成本为 $c+\\alpha K$，其中$\\alpha>0$。假设在这两种方案下，马尔可夫链都具有平稳性和遍历性。\n\n为了量化采样效率，定义有效样本量 (ESS) 为 $\\mathrm{ESS}=N/\\tau_{\\mathrm{int}}$，其中$N$是迭代次数，$\\tau_{\\mathrm{int}}$是积分自相关时间。因此，单位挂钟时间内的有效样本量与 $1/\\left(\\text{每次迭代的成本} \\times \\tau_{\\mathrm{int}}\\right)$ 成正比。对于非折叠链，假设其自相关函数为几何形式，滞后参数为 $r\\in(0,1)$，即对于滞后 $k\\geq 0$，有 $\\rho_{k}=r^{k}$。对于折叠链，假设精确边缘化通过将滞后参数减小到 $r^{\\delta}$ 来改善混合性，其中 $\\delta>1$ 是一个与$K$无关的固定值。\n\n从积分自相关时间的定义出发，\n$$\n\\tau_{\\mathrm{int}} \\equiv 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k},\n$$\n推导临界组分数 $K^{\\star}$ 的一个闭式表达式。在此临界值下，折叠采样器和非折叠采样器具有相同的单位挂钟时间有效样本量。将 $K^{\\star}$ 表示为 $c$, $\\alpha$, $r$, $\\delta$ 的符号函数。你的最终答案必须是一个单一的闭式解析表达式，且不应进行四舍五入。", "solution": "用户要求对问题进行严格验证，如果问题有效，则提供解答。\n\n### 第1步：提取已知条件\n- **模型：** 具有$K$个组分的潜变量有限混合模型。\n- **采样器：**\n    1.  非折叠吉布斯采样器 (U)\n    2.  折叠吉布斯采样器 (C)\n- **每次迭代的成本：**\n    -   非折叠：$C^{(U)} = c$，其中 $c > 0$。\n    -   折叠：$C^{(C)} = c + \\alpha K$，其中 $\\alpha > 0$。\n- **效率度量：** 单位挂钟时间内的有效样本量 (ESS)，$\\eta$。\n    -   $\\mathrm{ESS} = N/\\tau_{\\mathrm{int}}$，其中$N$是迭代次数，$\\tau_{\\mathrm{int}}$是积分自相关时间。\n    -   $\\eta \\propto 1 / (\\text{每次迭代的成本} \\times \\tau_{\\mathrm{int}})$。\n- **积分自相关时间的定义：**\n    -   $\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k}$，其中 $\\rho_k$ 是滞后$k$的自相关。\n- **自相关模型：**\n    -   非折叠：对于 $k \\geq 0$，$\\rho_{k}^{(U)} = r^{k}$，其中 $r \\in (0,1)$。\n    -   折叠：滞后参数减小到 $r^{\\delta}$，因此 $\\rho_{k}^{(C)} = (r^{\\delta})^{k} = r^{\\delta k}$，其中 $\\delta > 1$。\n- **目标：** 找到临界组分数 $K^{\\star}$，在该值下折叠采样器和非折叠采样器的单位挂钟时间有效样本量相等。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础（关键）：** 该问题在计算统计学和机器学习领域，特别是关于MCMC方法方面，有充分的科学依据。吉布斯采样、折叠采样器、ESS和自相关时间等概念是分析随机算法效率的标准工具。通过对标准采样器和折叠采样器的成本和混合率分别建模进行比较，是一种经典且根本上合理的方法。\n- **适定性：** 该问题提供了所有必要的定义、参数（$c, \\alpha, r, \\delta$）和函数形式，以建立一个可解的方程。目标是找到一个满足明确等式的特定值 $K^{\\star}$，从而得到一个唯一解。\n- **客观性（关键）：** 该问题使用形式化、精确且无偏见的语言陈述。没有主观或基于观点的内容。\n- **不完整或矛盾的设置：** 问题是自洽的。所有变量和假设都已明确定义。没有矛盾之处。假设（$c>0$, $\\alpha>0$, $r \\in (0,1)$, $\\delta>1$）是一致的，并确保问题在物理和数学上是有意义的（例如，正成本、衰减的相关性）。\n- **其他缺陷：** 该问题不违反任何其他无效性标准。它是一个形式化、可验证且非平凡的问题，完全在指定主题范围内。\n\n### 第3步：结论与行动\n问题是有效的。将提供完整解答。\n\n### 解答推导\n效率 $\\eta$ 被定义为与每次迭代的成本和积分自相关时间的乘积的倒数成正比。我们在寻找$K$的值，记为$K^{\\star}$，使得非折叠采样器和折叠采样器的效率相等。\n$$\n\\eta^{(U)} = \\eta^{(C)}\n$$\n由于两者的比例常数相同，这意味着：\n$$\n\\frac{1}{C^{(U)} \\tau_{\\mathrm{int}}^{(U)}} = \\frac{1}{C^{(C)} \\tau_{\\mathrm{int}}^{(C)}}\n$$\n这可以简化为两种方法的每个有效样本的总计算成本相等的条件：\n$$\nC^{(U)} \\tau_{\\mathrm{int}}^{(U)} = C^{(C)} \\tau_{\\mathrm{int}}^{(C)}\n$$\n首先，我们必须为每个采样器推导出积分自相关时间 $\\tau_{\\mathrm{int}}$ 的闭式表达式。其定义为 $\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k}$。该求和是一个几何级数。对于一个通用滞后参数 $p \\in (0,1)$，其中 $\\rho_k = p^k$，该级数的和为 $\\sum_{k=1}^{\\infty} p^k = \\frac{p}{1-p}$。\n因此，$\\tau_{\\mathrm{int}}$ 的一般形式为：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\left( \\frac{p}{1-p} \\right) = \\frac{1-p+2p}{1-p} = \\frac{1+p}{1-p}\n$$\n\n对于非折叠采样器，滞后参数为 $p = r$。其积分自相关时间为：\n$$\n\\tau_{\\mathrm{int}}^{(U)} = \\frac{1+r}{1-r}\n$$\n\n对于折叠采样器，滞后参数为 $p = r^{\\delta}$。其积分自相关时间为：\n$$\n\\tau_{\\mathrm{int}}^{(C)} = \\frac{1+r^{\\delta}}{1-r^{\\delta}}\n$$\n\n现在，我们可以将这些表达式以及给定的成本代入我们的等式条件中。非折叠采样器的成本为 $C^{(U)} = c$，而在临界点 $K^{\\star}$ 处，折叠采样器的成本为 $C^{(C)} = c + \\alpha K^{\\star}$。\n$$\nc \\left( \\frac{1+r}{1-r} \\right) = (c + \\alpha K^{\\star}) \\left( \\frac{1+r^{\\delta}}{1-r^{\\delta}} \\right)\n$$\n我们的目标是解出 $K^{\\star}$。我们首先分离出 $(c + \\alpha K^{\\star})$ 项：\n$$\nc + \\alpha K^{\\star} = c \\left( \\frac{1+r}{1-r} \\right) \\left( \\frac{1-r^{\\delta}}{1+r^{\\delta}} \\right)\n$$\n接下来，我们从两边减去 $c$ 以分离出含有 $K^{\\star}$ 的项：\n$$\n\\alpha K^{\\star} = c \\left[ \\left( \\frac{1+r}{1-r} \\right) \\left( \\frac{1-r^{\\delta}}{1+r^{\\delta}} \\right) - 1 \\right]\n$$\n为了简化方括号内的表达式，我们进行通分：\n$$\n\\alpha K^{\\star} = c \\left[ \\frac{(1+r)(1-r^{\\delta}) - (1-r)(1+r^{\\delta})}{(1-r)(1+r^{\\delta})} \\right]\n$$\n现在，我们展开分子中的各项：\n\\begin{align*} (1+r)(1-r^{\\delta}) &= 1 - r^{\\delta} + r - r^{1+\\delta} \\\\ (1-r)(1+r^{\\delta}) &= 1 + r^{\\delta} - r - r^{1+\\delta}\\end{align*}\n将第一个展开式减去第二个展开式：\n$$\n(1 - r^{\\delta} + r - r^{1+\\delta}) - (1 + r^{\\delta} - r - r^{1+\\delta}) = 2r - 2r^{\\delta} = 2(r - r^{\\delta})\n$$\n将这个简化后的分子代回关于 $\\alpha K^{\\star}$ 的方程中：\n$$\n\\alpha K^{\\star} = c \\left[ \\frac{2(r-r^{\\delta})}{(1-r)(1+r^{\\delta})} \\right]\n$$\n最后，我们通过除以 $\\alpha$ 来解出 $K^{\\star}$：\n$$\nK^{\\star} = \\frac{2c(r-r^{\\delta})}{\\alpha(1-r)(1+r^{\\delta})}\n$$\n这就是两个采样器效率相等时的临界组分数 $K^{\\star}$ 的闭式表达式。在约束条件 $c>0$, $\\alpha>0$, $r \\in (0,1)$ 和 $\\delta > 1$ 下，我们有 $r > r^{\\delta}$，因此 $(r-r^{\\delta})>0$。所有其他项也都是正的，这确保了 $K^{\\star} > 0$，这对于一个组分数来说是具有物理意义的。", "answer": "$$\n\\boxed{\\frac{2c(r-r^{\\delta})}{\\alpha(1-r)(1+r^{\\delta})}}\n$$", "id": "3296131"}]}