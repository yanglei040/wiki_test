{"hands_on_practices": [{"introduction": "动手实践是检验理论理解的试金石。本章的第一个练习旨在将 $(t,m,s)$-net 的抽象定义具体化，我们将通过一个简单的例子，亲手构造一个二维的低差异点集。通过计算其八个点的位置，并直接根据定义检验其基本区间填充属性[@problem_id:3334624]，您将对这些点集的精巧结构和均匀分布特性有更直观的认识。", "problem": "设 $b$ 为数字构造的基数，基数 $b$ 中的基本区间是任意形如 $\\prod_{j=1}^{s} [a_{j} b^{-d_{j}}, (a_{j}+1) b^{-d_{j}})$ 的笛卡尔积，其中 $s$ 是维度，$d_{j} \\in \\mathbb{Z}_{\\ge 0}$ 且对每个 $j$ 都有 $a_{j} \\in \\{0,1,\\dots,b^{d_{j}}-1\\}$。在 $[0,1)^{s}$ 中，一个大小为 $N=b^{m}$ 的有限点集被称为基数 $b$ 中的一个 $(t,m,s)$-网，如果对于任意满足 $\\sum_{j=1}^{s} d_{j} = m - t$ 的非负整数 $d_{1},\\dots,d_{s}$，每个上述形式的基本区间都恰好包含该点集的 $b^{t}$ 个点。\n\n基数 $b$ 中的根倒函数，记为 $\\phi_{b}$，由以下经过充分检验的规则定义：如果 $n \\in \\mathbb{Z}_{\\ge 0}$ 的 $b$ 基展开式为 $n = \\sum_{k=0}^{K} d_{k} b^{k}$，其中各位数字 $d_{k} \\in \\{0,1,\\dots,b-1\\}$，那么 $\\phi_{b}(n) = \\sum_{k=0}^{K} d_{k} b^{-(k+1)}$。\n\n考虑在基数 $b=2$、维度 $s=2$ 和 $m=3$ 下构造的二维点集，其包含 $N=2^{3} = 8$ 个点，由下式给出：\n$$\nP = \\left\\{ \\left(\\frac{i}{2^{3}}, \\phi_{2}(i) \\right) : i = 0,1,\\dots,7 \\right\\} \\subset [0,1)^{2}.\n$$\n\n任务：\n- 通过将每个 $i$ 写成二进制形式并计算 $\\phi_{2}(i)$，显式地构造出 $P$ 中的所有 $8$ 个点。\n- 仅使用 $(t,m,s)$-网的核心定义和基数 2 中二进基本区间的结构，对所有满足 $d_{1}+d_{2}=3$ 的数对 $(d_{1},d_{2})$ 验证其占有属性。\n- 确定使 $P$ 成为基数 2 中的一个 $(t,3,2)$-网的最小 $t$ 值。\n- 简要说明为什么基数 2 中的随机数字移位（即对每个坐标的前 $m$ 个小数位应用一个固定的按位异或操作）会保留已验证的占有属性，从而产生一个具有相同 $(t,m,s)$ 参数的随机化拟蒙特卡洛点集。\n\n将最小的 $t$ 值作为你的最终答案。答案应表示为一个精确整数，不进行四舍五入，也不带单位。", "solution": "首先验证问题，以确保其科学上合理、问题提出得当，并提供了所有必要信息。问题陈述定义了 $(t,m,s)$-网、根倒函数 $\\phi_b(n)$ 以及一个特定的二维点集 $P$。所有定义在拟蒙特卡洛方法理论中都是标准的。参数 $b=2$、$m=3$、$s=2$ 和 $N=8$ 均已明确说明。各项任务定义明确，并能导出一个唯一的、可验证的答案。因此，该问题是有效的。\n\n我们按顺序处理每个任务，开始解题。点集由下式给出：\n$$P = \\left\\{ \\left(\\frac{i}{2^{3}}, \\phi_{2}(i) \\right) : i = 0,1,\\dots,7 \\right\\}$$\n其中 $b=2$、$m=3$、$s=2$。\n\n首先，我们构造 $P$ 中的 $N=2^3=8$ 个点。对于每个 $i \\in \\{0, 1, \\dots, 7\\}$，我们求出其基数 2 的展开式 $i = d_{2}2^2 + d_{1}2^1 + d_{0}2^0$，我们将其记为 $(d_2 d_1 d_0)_2$。根倒函数 $\\phi_2(i)$ 则是 $\\phi_{2}(i) = d_{0}2^{-1} + d_{1}2^{-2} + d_{2}2^{-3}$。每个点的第一个坐标是 $x_1 = i/8$。这 8 个点是：\n- 对于 $i=0=(000)_2$：$\\phi_2(0) = 0\\cdot 2^{-1} + 0\\cdot 2^{-2} + 0\\cdot 2^{-3} = 0$。该点为 $(0/8, 0/8)$。\n- 对于 $i=1=(001)_2$：$\\phi_2(1) = 1\\cdot 2^{-1} + 0\\cdot 2^{-2} + 0\\cdot 2^{-3} = 1/2 = 4/8$。该点为 $(1/8, 4/8)$。\n- 对于 $i=2=(010)_2$：$\\phi_2(2) = 0\\cdot 2^{-1} + 1\\cdot 2^{-2} + 0\\cdot 2^{-3} = 1/4 = 2/8$。该点为 $(2/8, 2/8)$。\n- 对于 $i=3=(011)_2$：$\\phi_2(3) = 1\\cdot 2^{-1} + 1\\cdot 2^{-2} + 0\\cdot 2^{-3} = 3/4 = 6/8$。该点为 $(3/8, 6/8)$。\n- 对于 $i=4=(100)_2$：$\\phi_2(4) = 0\\cdot 2^{-1} + 0\\cdot 2^{-2} + 1\\cdot 2^{-3} = 1/8$。该点为 $(4/8, 1/8)$。\n- 对于 $i=5=(101)_2$：$\\phi_2(5) = 1\\cdot 2^{-1} + 0\\cdot 2^{-2} + 1\\cdot 2^{-3} = 5/8$。该点为 $(5/8, 5/8)$。\n- 对于 $i=6=(110)_2$：$\\phi_2(6) = 0\\cdot 2^{-1} + 1\\cdot 2^{-2} + 1\\cdot 2^{-3} = 3/8$。该点为 $(6/8, 3/8)$。\n- 对于 $i=7=(111)_2$：$\\phi_2(7) = 1\\cdot 2^{-1} + 1\\cdot 2^{-2} + 1\\cdot 2^{-3} = 7/8$。该点为 $(7/8, 7/8)$。\n\n接下来，我们确定使 $P$ 成为一个 $(t,m,s)$-网的最小非负整数 $t$。这要求对于任意满足 $d_1+d_2=m-t=3-t$ 的非负整数 $d_1, d_2$，每个基本区间 $\\prod_{j=1}^{2} [a_{j} 2^{-d_{j}}, (a_{j}+1) 2^{-d_{j}})$ 都恰好包含 $2^t$ 个点。\n\n我们测试 $t=0$ 的情况。这是 $t$ 可能的最小非负值。如果 $P$ 是一个 $(0,3,2)$-网，那么 $t=0$ 就是最小值。$t=0$ 的条件是，对于所有满足 $d_1+d_2=3-0=3$ 的 $d_1, d_2 \\ge 0$，每个基本区间必须恰好包含 $2^0=1$ 个点。可能的数对 $(d_1, d_2)$ 有 $(3,0)$、$(2,1)$、$(1,2)$ 和 $(0,3)$。\n\n为了系统地分析这一点，我们用二进制表示这些点的坐标。对于 $i = (d_2 d_1 d_0)_2$，第 $i$ 个点 $p_i=(x_{i,1}, x_{i,2})$ 的坐标为：\n$x_{i,1} = i/8 = (d_2 2^2 + d_1 2^1 + d_0 2^0)/8 = d_2 2^{-1} + d_1 2^{-2} + d_0 2^{-3} = (0.d_2 d_1 d_0)_2$。\n$x_{i,2} = \\phi_2(i) = d_0 2^{-1} + d_1 2^{-2} + d_2 2^{-3} = (0.d_0 d_1 d_2)_2$。\n\n一个基本区间 $[a_1 2^{-d_1}, (a_1+1) 2^{-d_1}) \\times [a_2 2^{-d_2}, (a_2+1) 2^{-d_2})$ 是 $[0,1)^2$ 中所有点 $(y_1, y_2)$ 的集合，其中 $y_1$ 的前 $d_1$ 位二进制数字和 $y_2$ 的前 $d_2$ 位二进制数字是固定的。$a_1 \\in \\{0,\\dots,2^{d_1}-1\\}$ 和 $a_2 \\in \\{0,\\dots,2^{d_2}-1\\}$ 的值决定了这些固定的数字。\n\n我们来验证 $d_1+d_2=3$ 时的占有属性。共有 $2^{d_1} \\times 2^{d_2} = 2^{d_1+d_2} = 2^3=8$ 个这样的区间，我们必须证明每个区间恰好包含一个点。\n\n情况1：$(d_1, d_2) = (3,0)$。区间为 $[a_1/8, (a_1+1)/8) \\times [0,1)$，其中 $a_1 \\in \\{0,\\dots,7\\}$。一个区间是通过固定第一个坐标的前 3 位来定义的。这意味着 $(d_2, d_1, d_0)$ 是固定的。这唯一地指定了 $i$，因此每个这样的区间恰好落入一个点。例如，对于 $a_1=5=(101)_2$，区间是 $[5/8, 6/8) \\times [0,1)$。如果一个点 $p_i$ 的第一个坐标 $x_{i,1}$ 的二进制展开为 $(0.101)_2$，那么它就在这个区间内。这要求 $(d_2,d_1,d_0)=(1,0,1)$，即 $i=5$。只有一个点 $p_5$ 满足这个条件。这对所有 8 个区间都成立。\n\n情况2：$(d_1, d_2) = (0,3)$。区间为 $[0,1) \\times [a_2/8, (a_2+1)/8)$，其中 $a_2 \\in \\{0,\\dots,7\\}$。一个区间是通过固定第二个坐标的前 3 位来定义的。对于一个点 $p_i$，这固定了 $(d_0, d_1, d_2)$。这同样唯一地确定了 $i = d_2 2^2 + d_1 2^1 + d_0$。因此，这 8 个区间中的每一个都恰好包含一个点。例如，对于 $a_2=5=(101)_2$，我们需要 $x_{i,2}$ 的二进制展开为 $(0.101)_2$。这固定了 $(d_0, d_1, d_2)=(1,0,1)$，对应于 $i = 1\\cdot 2^2 + 0\\cdot 2^1 + 1\\cdot 2^0=5$。只有 $p_5$ 在这个区间内。\n\n情况3：$(d_1, d_2) = (2,1)$。区间为 $[a_1/4, (a_1+1)/4) \\times [a_2/2, (a_2+1)/2)$。一个区间是通过固定 $x_1$ 的前 $d_1=2$ 位和 $x_2$ 的前 $d_2=1$ 位来定义的。这意味着我们固定了 $(d_2,d_1)$ 和 $d_0$。三元组 $(d_2,d_1,d_0)$ 由 $a_1$ 和 $a_2$ 的选择唯一确定。例如，取 $a_1=2=(10)_2$ 和 $a_2=1=(1)_2$。区间是 $[2/4, 3/4) \\times [1/2, 1)$。如果 $x_{i,1}$ 以 $(0.10)_2$ 开头且 $x_{i,2}$ 以 $(0.1)_2$ 开头，则点 $p_i$ 在该区间内。这意味着 $(d_2,d_1)=(1,0)$ 且 $d_0=1$。所以我们必须有 $i = (101)_2 = 5$。只有点 $p_5=(5/8, 5/8)$ 在这个区间内。由于对于 $4 \\times 2 = 8$ 种 $(a_1, a_2)$ 的选择中的每一种，位 $(d_2, d_1, d_0)$ 都是唯一指定的，因此每个区间都恰好包含一个点。\n\n情况4：$(d_1, d_2) = (1,2)$。区间为 $[a_1/2, (a_1+1)/2) \\times [a_2/4, (a_2+1)/4)$。一个区间是通过固定 $x_1$ 的前 $d_1=1$ 位和 $x_2$ 的前 $d_2=2$ 位来定义的。这意味着我们固定了 $d_2$ 和 $(d_0, d_1)$。同样，三元组 $(d_2, d_1, d_0)$ 是唯一确定的。例如，$a_1=0=(0)_2$ 且 $a_2=3=(11)_2$。区间是 $[0,1/2) \\times [3/4,1)$。如果 $d_2=0$ 且 $(d_0,d_1)=(1,1)$，则点 $p_i$ 在该区间内。这固定了 $i=(011)_2=3$。只有点 $p_3=(3/8, 6/8)$ 在这个区间内。这对所有 $2 \\times 4 = 8$ 个这样的区间都成立。\n\n由于在所有 $d_1+d_2=3$ 的情况下，每个基本区间都恰好包含 $1=2^0$ 个点，所以点集 $P$ 是基数 2 中的一个 $(0,3,2)$-网。因为 $t$ 必须是非负整数，所以 $t$ 的最小值为 $0$。\n\n最后，我们简要说明为什么随机数字移位会保留此属性。基数 2 中的数字移位是通过取一个随机向量 $u=(u_1, u_2) \\in [0,1)^2$ 并将其应用于 $P$ 中的所有点来执行的，从而得到一个新的集合 $P'=\\{p'_i\\}$，其中 $p'_i = p_i \\oplus u$。运算 $\\oplus$ 是逐坐标的模 1 加法，对于二进制展开，这是一个按位异或 (XOR) 操作。\n设 $E$ 是一个通过固定坐标 $j$ (对于 $j=1,2$) 的前 $d_j$ 位来定义的基本区间。$E$ 中 $P'$ 的点数是集合 $\\{i \\mid p_i \\oplus u \\in E\\}$ 的大小。一个点 $p_i \\oplus u$ 在 $E$ 中当且仅当 $p_i$ 在集合 $E' = \\{y \\in [0,1)^2 \\mid y \\oplus u \\in E\\}$ 中。集合 $E'$ 本身是同一类型的基本区间（即具有相同的 $d_1, d_2$）。这是因为固定 $y_j \\oplus u_j$ 的前 $d_j$ 位等效于将 $y_j$ 的前 $d_j$ 位固定为一组由 $u_j$ 的位确定的新值。\n所以，$E$ 中 $P'$ 的点数等于 $E'$ 中 $P$ 的点数。由于 $P$ 是一个 $(t,m,s)$-网，它在任何满足 $\\sum d_j = m-t$ 的基本区间 $E'$ 中都恰好包含 $b^t$ 个点。因此，$P'$ 在任何这类区间 $E$ 中也包含 $b^t$ 个点。随机化保留了 $(t,m,s)$-网的属性。在我们的特定情况下，移位后的集合也是一个 $(0,3,2)$-网。\n\n使 $P$ 成为基数 2 中的一个 $(t,3,2)$-网的最小 $t$ 值已被确定为 $0$。", "answer": "$$ \\boxed{0} $$", "id": "3334624"}, {"introduction": "在掌握了 $(t,m,s)$-net 的基本构造后，我们进一步探索其在积分估计中展现的强大威力。本练习将揭示随机化拟蒙特卡罗（RQMC）方法的一个惊人特性：对于某些与点集结构“完美对齐”的被积函数，其积分估计的方差可以降至零。通过对一个基本区间指示函数的方差进行计算[@problem_id:3334644]，我们将深刻体会到低差异点集内蕴的“分层”思想是如何实现极致的方差缩减的。", "problem": "设 $b \\geq 2$ 为一个整数基底，并设 $m \\in \\mathbb{N}$，$s \\in \\mathbb{N}$，以及 $t \\in \\{0,1,\\dots,m\\}$。考虑一个以 b 为基底的 $(t,m,s)$-网，它包含 $[0,1)^{s}$ 中的 $N = b^{m}$ 个点。应用 Owen 的嵌套均匀置乱（一种在随机化拟蒙特卡洛 (RQMC) 中的标准随机化方法）来获得随机化点 $\\tilde{X}_{1},\\dots,\\tilde{X}_{N}$，这些点边缘上独立同分布于 $[0,1)^{s}$ 上的均匀分布，并且几乎必然地，置乱后的点集仍然是以 b 为基底的 $(t,m,s)$-网。定义一个基底为 b 的基本区间\n$$\nJ \\;=\\; \\prod_{i=1}^{s} \\Big[ a_{i} b^{-d_{i}},\\, (a_{i}+1) b^{-d_{i}} \\Big),\n$$\n其中对于每个 $i \\in \\{1,\\dots,s\\}$，$d_{i} \\in \\mathbb{N}_{0}$ 且 $a_{i} \\in \\{0,1,\\dots,b^{d_{i}}-1\\}$，并假设 $\\sum_{i=1}^{s} d_{i} \\leq m - t$。令 $f(x) = \\mathbf{1}_{J}(x)$ 且 $I = \\int_{[0,1)^{s}} f(x)\\,\\mathrm{d}x$ 表示 $f$ 的积分。考虑 RQMC 估计量\n$$\n\\widehat{I}_{N} \\;=\\; \\frac{1}{N} \\sum_{n=1}^{N} f(\\tilde{X}_{n}).\n$$\n\n仅使用以 b 为基底的 $(t,m,s)$-网的定义性质、基底为 b 的基本区间的结构，以及 Owen 的置乱几乎必然地保持 $(t,m,s)$-网性质这一事实，计算 $\\widehat{I}_{N}$ 相对于置乱随机化的方差（以底层的确定性网为条件）。为了进行科学对比，请在您的计算过程中也推导出使用 $[0,1)^{s}$ 上的 $N$ 个独立均匀样本对相同 $f$ 进行估计的普通蒙特卡洛估计量的方差，但最终答案只报告 $\\widehat{I}_{N}$ 的方差。最终答案必须是单个精确值，不得进行舍入。", "solution": "该问题具有科学依据、是适定的且客观的。它基于随机化拟蒙特卡洛方法数学理论中的标准、可验证的概念，特别是 `(t,m,s)`-网和 Owen 的置乱。问题陈述完整、一致，并提供了推导唯一解所需的所有必要信息。因此，该问题是有效的。我们着手求解。\n\n待估计的积分是 $I = \\int_{[0,1)^{s}} f(x)\\,\\mathrm{d}x$，其中被积函数是基本区间 $J$ 的指示函数 $f(x) = \\mathbf{1}_{J}(x)$。积分的值是区间的体积，$I = \\text{Vol}(J)$。该基本区间由下式给出\n$$\nJ \\;=\\; \\prod_{i=1}^{s} \\Big[ a_{i} b^{-d_{i}},\\, (a_{i}+1) b^{-d_{i}} \\Big)\n$$\n其中对于每个 $i \\in \\{1,\\dots,s\\}$，$d_{i} \\in \\mathbb{N}_{0}$ 且 $a_{i} \\in \\{0,1,\\dots,b^{d_{i}}-1\\}$。该区间的体积是 $\\text{Vol}(J) = \\prod_{i=1}^{s} b^{-d_{i}} = b^{-\\sum_{i=1}^{s} d_{i}}$。\n\n$I$ 的随机化拟蒙特卡洛 (RQMC) 估计量是\n$$\n\\widehat{I}_{N} \\;=\\; \\frac{1}{N} \\sum_{n=1}^{N} f(\\tilde{X}_{n}) \\;=\\; \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{J}(\\tilde{X}_{n})\n$$\n其中 $N=b^m$，$\\tilde{X}_{1},\\dots,\\tilde{X}_{N}$ 是来自一个置乱的 $(t,m,s)$-网的点。我们想计算该估计量相对于置乱随机化的方差，其由 $\\mathrm{Var}(\\widehat{I}_{N}) = E[\\widehat{I}_{N}^2] - (E[\\widehat{I}_{N}])^2$ 给出。\n\n首先，我们计算估计量的期望。由于置乱点 $\\tilde{X}_{n}$ 边缘分布为 $[0,1)^{s}$ 上的均匀分布，对于任何 $n$，$f(\\tilde{X}_{n})$ 的期望是\n$$\nE[f(\\tilde{X}_{n})] = \\int_{[0,1)^{s}} f(x)\\,\\mathrm{d}x = I = \\text{Vol}(J).\n$$\n根据期望的线性性，估计量的期望是\n$$\nE[\\widehat{I}_{N}] = E\\left[\\frac{1}{N} \\sum_{n=1}^{N} f(\\tilde{X}_{n})\\right] = \\frac{1}{N} \\sum_{n=1}^{N} E[f(\\tilde{X}_{n})] = \\frac{1}{N} \\sum_{n=1}^{N} I = \\frac{N \\cdot I}{N} = I.\n$$\n该 RQMC 估计量是无偏的。\n\n现在我们分析估计量的核心性质。数量 $\\sum_{n=1}^{N} \\mathbf{1}_{J}(\\tilde{X}_{n})$ 是落入区间 $J$ 内的置乱点的数量，我们将其记为 $\\tilde{n}(J)$。\n问题提供了两条关键信息：\n1. 置乱点集 $\\{\\tilde{X}_{1},\\dots,\\tilde{X}_{N}\\}$ 几乎必然地构成一个以 b 为基底的 $(t,m,s)$-网。\n2. 基本区间 $J$ 满足条件 $\\sum_{i=1}^{s} d_{i} \\leq m - t$。\n\n我们来使用 $(t,m,s)$-网的定义。一个包含 $N=b^m$ 个点的集合，如果任何体积为 $\\text{Vol}(E) = b^{t-m}$ 的基本区间 $E$ 都恰好包含该集合中的 $b^t$ 个点，那么它就是以 b 为基底的 $(t,m,s)$-网。\n给定的区间 $J$ 的体积为 $\\text{Vol}(J) = b^{-k}$，其中 $k = \\sum_{i=1}^{s} d_{i}$。条件是 $k \\leq m-t$。\n这个区间 $J$ 可以表示为若干个较小的基本区间的不交并，每个区间的体积均为 $b^{t-m}$。具体来说，$J$ 可以被划分为数量等于它们体积比率的此类区间：\n$$\n\\frac{\\text{Vol}(J)}{\\text{Vol}(E)} = \\frac{b^{-k}}{b^{-(m-t)}} = b^{m-t-k}.\n$$\n由于 $\\{\\tilde{X}_{1},\\dots,\\tilde{X}_{N}\\}$ 构成一个 $(t,m,s)$-网（几乎必然），这 $b^{m-t-k}$ 个子区间中的每一个都恰好包含 $b^t$ 个点。因此，$J$ 中置乱点的总数几乎必然是\n$$\n\\tilde{n}(J) = (\\text{子区间数量}) \\times (\\text{每个子区间的点数}) = (b^{m-t-k}) \\times (b^t) = b^{m-k}.\n$$\n让我们将其与积分 $I$ 联系起来。我们有 $N = b^m$ 且 $I = \\text{Vol}(J) = b^{-k}$。因此，几乎必然地，\n$$\n\\tilde{n}(J) = b^{m-k} = b^m \\cdot b^{-k} = N \\cdot I.\n$$\n这意味着对于任何置乱的实现，落入 $J$ 的点的数量是一个固定的、非随机的量（概率为 1）。因此，RQMC 估计量几乎必然是常数：\n$$\n\\widehat{I}_{N} = \\frac{1}{N} \\tilde{n}(J) = \\frac{1}{N} (N \\cdot I) = I.\n$$\n一个几乎必然等于一个常数的随机变量，其方差为零。因此，\n$$\n\\mathrm{Var}(\\widehat{I}_{N}) = E\\big[(\\widehat{I}_{N} - E[\\widehat{I}_{N}])^2\\big] = E\\big[(I - I)^2\\big] = E[0] = 0.\n$$\n\n为了进行科学对比，我们推导了基于 $N$ 个独立同分布样本 $X_{n} \\sim U([0,1)^{s})$ 的普通蒙特卡洛 (MC) 估计量 $\\widehat{I}_{\\text{MC}}$ 的方差。MC 估计量是 $\\widehat{I}_{\\text{MC}} = \\frac{1}{N} \\sum_{n=1}^{N} f(X_{n})$。由于样本是独立的，方差为\n$$\n\\mathrm{Var}(\\widehat{I}_{\\text{MC}}) = \\frac{1}{N^2} \\sum_{n=1}^{N} \\mathrm{Var}(f(X_{n})) = \\frac{N}{N^2} \\mathrm{Var}(f(X_1)) = \\frac{\\mathrm{Var}(f(X_1))}{N}.\n$$\n随机变量 $f(X_1) = \\mathbf{1}_{J}(X_1)$ 是一个伯努利试验，其成功概率为 $p = P(X_1 \\in J) = \\text{Vol}(J) = I$。伯努利$(p)$变量的方差是 $p(1-p)$。因此，\n$$\n\\mathrm{Var}(f(X_1)) = I(1-I).\n$$\n标准MC估计量的方差是\n$$\n\\mathrm{Var}(\\widehat{I}_{\\text{MC}}) = \\frac{I(1-I)}{N}.\n$$\n这个结果突显了 RQMC 的一个显著性质：对于某些结构良好的被积函数，例如与网的结构对齐的基本区间的指示函数，积分误差方差可以降为零，然而普通MC方差总是正的（对于 $0  I  1$）。对于指定的问题，RQMC 估计量 $\\widehat{I}_{N}$ 的方差精确为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3334644"}, {"introduction": "尽管经典的 Koksma-Hlawka 不等式为确定性 QMC 方法提供了误差界，但在许多情况下，这个界可能过于宽松，以至于失去了实用价值。本练习旨在阐明随机化的关键优势，我们将分析一个特殊构造的函数[@problem_id:3334588]，其 Hardy-Krause 变分极大而函数值本身却很小。通过此例，您将理解为何确定性误差上界会“失效”，而 RQMC 的均方根误差却能更准确地捕捉真实误差，这突显了随机化在提供可靠误差估计方面不可或缺的作用。", "problem": "考虑维度 $s \\ge 2$ 以及 Koksma–Hlawka 不等式，该不等式将一个函数在 $[0,1]^s$ 上的积分误差（通过拟蒙特卡罗法则计算）与点集的星偏差以及 Hardy–Krause 意义下的被積函数变差联系起来。请您在 $[0,1]^s$ 中确定一个具体的 Lipschitz 构造，其变差具有有限但很大的高阶交互作用贡献，并解释在使用维度为 $s$ 的低偏差点集时，这对 Koksma–Hlawka 界的紧致性有何影响，以及数字网格的标准随机化如何改变这一情况。\n\n选择唯一一个正确构造了这样一个函数，并准确描述了所得界的紧致性以及随机化效应的选项。\n\nA. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$，其中参数 $\\epsilon \\in (0,1)$ 且整数 $m \\ge 1$，并在 $[0,1]^s$ 上定义 $f(x) = \\prod_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，且具有有限的带锚点 Hardy–Krause 变差 $V_{\\mathrm{HK}}^{(1)}(f)$，该变差完全由 $s$ 阶混合交互作用主导，其值为 $V_{\\mathrm{HK}}^{(1)}(f) = \\left(\\int_0^1 |h'(t)|\\,\\mathrm{d}t\\right)^s$。即使 $\\epsilon$ 很小，通过增大 $m$ 也可以使该值变得非常大。因此，对于这个函数 $f$，在使用维度为 $s$ 的低偏差点集时，Koksma–Hlawka 界可能极其松弛，因为它的大小与 $\\left(\\int_0^1 |h'(t)|\\,\\mathrm{d}t\\right)^s$ 乘以星偏差成比例。相比之下，对于一个随机化的数字网格（例如，一个加扰的 $(t,m,s)$–网格），均方根误差取决于 $f$ 的平方可积投影，而不是 $V_{\\mathrm{HK}}^{(1)}(f)$，并且对于此构造，由于 $\\|f\\|_{\\infty} \\le \\epsilon^s$，该误差可能小得多。\n\nB. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\sum_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，其变差由一阶效应主导，因此 Koksma–Hlawka 界随着 $s$ 的增长而变紧，因为低偏差点集的星偏差随维度减小。\n\nC. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\prod_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，且 $V_{\\mathrm{HK}}^{(1)}(f) = s \\int_0^1 |h'(t)|\\,\\mathrm{d}t$，因此数字网格的随机化将 Koksma–Hlawka 界收紧到 $(\\log N)^s/N$ 乘以 $s$ 的阶。\n\nD. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\prod_{j=1}^s h(x_j)$。因为 $h(1)=0$，所有低阶方差分析分量都消失，对于任何 $(t,m,s)$–网格，Koksma–Hlawka 不等式在一个普适常数内变得精确，因此该界在高维下是紧的。", "solution": "## 问题验证\n\n### 第1步：提取已知信息\n问题陈述提供了以下信息：\n1.  **背景**：在 $s$ 维单位立方体 $[0,1]^s$ 上对函数 $f$ 进行积分，维度 $s \\ge 2$。\n2.  **方法**：拟蒙特卡罗 (QMC) 积分。\n3.  **不等式**：Koksma–Hlawka 不等式，它通过点集星偏差 $D_N^*$ 与 Hardy–Krause 意义下被积函数的变差 $V_{\\mathrm{HK}}(f)$ 的乘积来界定积分误差。\n4.  **任务**：\n    a. 确定一个具体的 Lipschitz 函数 $f: [0,1]^s \\to \\mathbb{R}$，其 Hardy–Krause 变差中高阶交互作用的贡献有限但很大。\n    b. 解释在使用低偏差点集时对 Koksma–Hlawka 界紧致性的影响。\n    c. 解释对数字网格（一种低偏差点集）进行随机化如何影响此函数的积分误差。\n\n### 第2步：使用提取的已知信息进行验证\n根据验证标准评估问题陈述。\n\n*   **科学上成立**：该问题基于数值积分数学理论中公认的基本概念，特别是拟蒙特卡罗方法领域。Koksma–Hlawka 不等式、Hardy–Krause 变差、星偏差、数字网格和随机化技术都是该领域的标准课题。该问题在科学和数学上是合理的。\n*   **良态的**：这个问题是良态的。它要求识别并分析一种特定类型的函数，以说明 QMC 中的一个已知理论现象。任务定义清晰，可以从理论中推导出一个唯一的、合理的答案。\n*   **客观的**：该问题以精确、客观和技术性的语言陈述，没有歧义、主观性或观点。\n\n该问题没有显示说明中列出的任何缺陷：\n1.  **科学或事实不成立**：无。基本原理是正确的。\n2.  **不可形式化或不相关**：该问题高度可形式化，并且是随机化拟蒙特卡罗方法主题的核心。\n3.  **不完整或矛盾的设置**：问题是自洽的，并提供了足够的上下文以继续进行。选项 A 中使用的术语“带锚点 Hardy–Krause 变差 $V_{\\mathrm{HK}}^{(1)}(f)$”略非标准，但其含义从上下文和所给公式中可以清楚地看出。\n4.  **不切实际或不可行**：不适用，因为这是一个纯数学问题。\n5.  **病态或结构不良**：问题结构良好。\n6.  **伪深刻、琐碎或同义反复**：问题不琐碎，需要对 QMC 中不同误差估计机制有细致的理解。\n7.  **超出科学可验证性范围**：这些主张在数学上是可验证的。\n\n### 第3步：结论和行动\n问题陈述是**有效的**。将推导出一个完整的解答。\n\n## 推导与选项分析\n\n问题的核心是找到一个函数，使得确定性 QMC 误差界（Koksma–Hlawka）非常悲观，而随机化 QMC（RQMC）的误差很小。这种情况通常发生在具有高频振荡但振幅很小的函数上。\n\n我们来分析所提出的函数构造。设 $h(t) = \\epsilon \\sin(2\\pi m t)(1-t)$，其中 $\\epsilon \\in (0,1)$ 且整数 $m \\ge 1$。要积分的函数是 $f(x) = \\prod_{j=1}^s h(x_j)$，对于 $x = (x_1, \\dots, x_s) \\in [0,1]^s$。\n\n**1. 所构造函数 $f$ 的性质：**\n\n*   **Lipschitz 连续性**：$h$ 的导数是 $h'(t) = \\epsilon [ - \\sin(2\\pi m t) + 2\\pi m (1-t) \\cos(2\\pi m t) ]$。由于 $t \\in [0,1]$， $|h'(t)|$ 由一个常数（比如 $L_h$）界定。因此，$h$ 是 Lipschitz 的。$f$ 关于 $x_k$ 的偏导数是 $\\frac{\\partial f}{\\partial x_k} = h'(x_k) \\prod_{j \\neq k} h(x_j)$。其大小有界：$|\\frac{\\partial f}{\\partial x_k}| \\le L_h \\cdot (\\sup_{t \\in [0,1]} |h(t)|)^{s-1}$。由于 $h$ 是有界的， $f$ 的所有一阶偏导数在 $[0,1]^s$ 上都是有界的，这意味着 $f$ 是 Lipschitz 的。\n\n*   **Hardy–Krause 变差 ($V_{\\mathrm{HK}}(f)$)**：Hardy 和 Krause 意义下的变差由混合偏导数绝对值的积分之和给出，计算时未微分的变量被设为 $1$。\n    $$ V_{\\mathrm{HK}}(f) = \\sum_{\\emptyset \\neq u \\subseteq \\{1, \\dots, s\\}} \\int_{[0,1]^{|u|}} \\left| \\frac{\\partial^{|u|} f}{\\prod_{j \\in u} \\partial x_j} (x_u; 1) \\right| d x_u $$\n    其中 $(x_u; 1)$ 表示坐标在 $u$ 中的是变量，而不在 $u$ 中的坐标设为 $1$。\n    混合偏导数是 $\\frac{\\partial^{|u|} f}{\\prod_{j \\in u} \\partial x_j} = \\left(\\prod_{j \\in u} h'(x_j)\\right) \\left(\\prod_{k \\notin u} h(x_k)\\right)$。\n    我们所选 $h(t)$ 的一个关键性质是 $h(1) = \\epsilon \\sin(2\\pi m)(1-1) = 0$。\n    因此，对于任何 $u \\neq \\{1, \\dots, s\\}$，不在 $u$ 中的索引集非空。在 $x_k=1$ 处计算 $\\prod_{k \\notin u} h(x_k)$ 项将包含一个因子 $h(1)=0$，使得整个项为零。\n    $V_{\\mathrm{HK}}(f)$ 的和式中唯一不为零的项是对应于 $u = \\{1, \\dots, s\\}$ 的项。\n    $$ V_{\\mathrm{HK}}(f) = \\int_{[0,1]^s} \\left| \\prod_{j=1}^s h'(x_j) \\right| dx_1 \\cdots dx_s = \\prod_{j=1}^s \\int_0^1 |h'(x_j)| dx_j = \\left( \\int_0^1 |h'(t)| dt \\right)^s $$\n    这表明变差完全由最高阶（$s$ 阶）交互作用决定。\n\n*   **变差的大小**：让我们估计 $|h'(t)|$ 的积分。\n    $|h'(t)| = |\\epsilon [ - \\sin(2\\pi m t) + 2\\pi m (1-t) \\cos(2\\pi m t) ]|$。\n    对于大的 $m$，项 $2\\pi m (1-t) \\cos(2\\pi m t)$ 占主导。\n    $\\int_0^1 |h'(t)| dt \\approx \\int_0^1 |2\\pi m \\epsilon (1-t) \\cos(2\\pi m t)| dt = 2\\pi m \\epsilon \\int_0^1 (1-t) |\\cos(2\\pi m t)| dt$。\n    积分 $\\int_0^1 (1-t) |\\cos(2\\pi m t)| dt$ 近似等于 $(1-t)$ 的平均值（即 $1/2$）乘以 $|\\cos(\\cdot)|$ 在多个周期上的平均值（即 $2/\\pi$），所以该积分大约是 $(1/2)(2/\\pi) = 1/\\pi$。\n    因此，$\\int_0^1 |h'(t)| dt \\approx 2m\\epsilon$。这个值随 $m$ 线性增长。\n    因此，$V_{\\mathrm{HK}}(f) \\approx (2m\\epsilon)^s$。通过选择一个大的整数 $m$，可以使变差任意大。\n\n*   **函数的大小**：$|h(t)| = |\\epsilon \\sin(2\\pi m t)(1-t)| \\le \\epsilon$。\n    因此，$\\|f\\|_{\\infty} = \\sup_{x \\in [0,1]^s} |f(x)| \\le \\epsilon^s$。对于 $\\epsilon  1$，这个值可以非常小。\n\n**2. 对 QMC 误差界的影响：**\n\n*   **Koksma–Hlawka 界（确定性 QMC）**：误差由 $|E_N(f)| \\le V_{\\mathrm{HK}}(f) D_N^*$ 界定。使用一个低偏差序列（例如一个 $(t,m,s)$-网格），$D_N^* = O(N^{-1} (\\log N)^{s-1})$。\n    误差界大约为 $(2m\\epsilon)^s \\cdot O(N^{-1} (\\log N)^{s-1})$。\n    实际误差的平凡界为 $2\\|f\\|_{\\infty} \\le 2\\epsilon^s$。\n    如果我们选择非常大的 $m$，Koksma–Hlawka 界可能非常巨大，例如，远大于 1，而真实误差保证很小。这表明对于这类函数，Koksma-Hlawka 界极其松弛且不具信息量。\n\n*   **随机化 QMC（RQMC）误差**：对于一个随机化的 QMC 方法，如加扰数字网格，误差是一个随机变量。我们分析其均方根误差 (RMSE)，它是一个无偏估计量的方差的平方根。RQMC 估计量的方差不是由 Hardy-Krause 变差决定的，而是由函数 ANOVA（方差分析）分量的方差之和 $\\sigma_u^2(f)$ 决定的。\n    函数本身的总方差是 $\\sigma^2(f) = \\int_{[0,1]^s} f(x)^2 dx - (\\int_{[0,1]^s} f(x) dx)^2$。\n    RMSE 由函数的标准差 $\\sigma(f)$ 界定。\n    $\\sigma(f)^2 \\le \\int f(x)^2 dx = \\int_0^1 \\cdots \\int_0^1 \\prod_{j=1}^s h(x_j)^2 dx_1 \\cdots dx_s = \\left( \\int_0^1 h(t)^2 dt \\right)^s$。\n    另外，$\\int_0^1 h(t)^2 dt \\le \\int_0^1 \\epsilon^2 dt = \\epsilon^2$。因此，$\\sigma(f)^2 \\le (\\epsilon^2)^s = \\epsilon^{2s}$。\n    RMSE 由一个 $\\epsilon^s$ 阶的量界定。这个值很小。\n    对于光滑函数，RQMC 误差率通常是 $O(N^{-1})$ 或更快，其常数因子取决于 $f$ 或其导数的 $L_2$-范数，而不是基于 $L_1$ 的 Hardy-Krause 变差。对于此函数，RQMC 误差估计会很小，反映了函数的小幅值，并将提供一个更紧的误差界。\n\n### 逐项选项分析\n\n**A. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$，其中参数 $\\epsilon \\in (0,1)$ 且整数 $m \\ge 1$，并在 $[0,1]^s$ 上定义 $f(x) = \\prod_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，且具有有限的带锚点 Hardy–Krause 变差 $V_{\\mathrm{HK}}^{(1)}(f)$，该变差完全由 $s$ 阶混合交互作用主导，其值为 $V_{\\mathrm{HK}}^{(1)}(f) = \\left(\\int_0^1 |h'(t)|\\,\\mathrm{d}t\\right)^s$。即使 $\\epsilon$ 很小，通过增大 $m$ 也可以使该值变得非常大。因此，对于这个函数 $f$，在使用维度为 $s$ 的低偏差点集时，Koksma–Hlawka 界可能极其松弛，因为它的大小与 $\\left(\\int_0^1 |h'(t)|\\,\\mathrm{d}t\\right)^s$ 乘以星偏差成比例。相比之下，对于一个随机化的数字网格（例如，一个加扰的 $(t,m,s)$–网格），均方根误差取决于 $f$ 的平方可积投影，而不是 $V_{\\mathrm{HK}}^{(1)}(f)$，并且对于此构造，由于 $\\|f\\|_{\\infty} \\le \\epsilon^s$，该误差可能小得多。**\n此选项正确地描述了构造。它正确地计算了 Hardy–Krause 变差的结构及其大小。它正确地推断出 Koksma–Hlawka 界是松弛的。它正确地将其与 RQMC 误差进行了对比，后者取决于 $f$ 的不同性质（与其 $L_2$-范数或 ANOVA 分解有关，即“平方可积投影”），因此要小得多。此选项中的每一项主张都与我们的推导一致。\n**结论：正确。**\n\n**B. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\sum_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，其变差由一阶效应主导，因此 Koksma–Hlawka 界随着 $s$ 的增长而变紧，因为低偏差点集的星偏差随维度减小。**\n此选项提出了一个加性函数 $f(x) = \\sum_{j=1}^s h(x_j)$。这个函数由一阶效应主导，与问题要求具有大的*高阶*交互作用贡献相矛盾。此外，关于星偏差 $D_N^*$ 随维度 $s$ 减小的说法是错误的；维度灾难意味着对于固定的 $N$，$D_N^*$ 会随着 $s$ 的增加而迅速恶化（增大）。\n**结论：错误。**\n\n**C. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\prod_{j=1}^s h(x_j)$。那么 $f$ 是 Lipschitz 的，且 $V_{\\mathrm{HK}}^{(1)}(f) = s \\int_0^1 |h'(t)|\\,\\mathrm{d}t$，因此数字网格的随机化将 Koksma–Hlawka 界收紧到 $(\\log N)^s/N$ 乘以 $s$ 的阶。**\n此选项使用了正确的函数形式，但给出了一个错误的变差公式。公式 $V_{\\mathrm{HK}}(f) = s \\int_0^1 |h'(t)|\\,\\mathrm{d}t$ 适用于加性函数，而非乘性函数。正确的公式是积分的乘积，$\\left(\\int_0^1 |h'(t)|\\,dt\\right)^s$。此外，关于随机化的陈述是混乱的。随机化导致一种不同类型的误差界（概率性的，基于方差），它并不会“收紧 Koksma-Hlawka 界”。所给的误差率表述也很奇怪。\n**结论：错误。**\n\n**D. 设 $h(t) = \\epsilon \\sin(2\\pi m t)\\,(1-t)$ 并定义 $f(x) = \\prod_{j=1}^s h(x_j)$。因为 $h(1)=0$，所有低阶方差分析分量都消失，对于任何 $(t,m,s)$–网格，Koksma–Hlawka 不等式在一个普适常数内变得精确，因此该界在高维下是紧的。**\n前提“因为 $h(1)=0$，所有低阶方差分析分量都消失”是错误的。条件 $h(1)=0$ 使得*Hardy-Krause 变差公式*中的低阶项消失，而不是 ANOVA 分量。例如，均值 $f_\\emptyset = \\int f(x) dx = (\\int h(t) dt)^s \\neq 0$。关于 K-H 不等式变得精确或紧的结论也是错误的；如前所示，对于这个函数，该界极其松弛。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "3334588"}]}