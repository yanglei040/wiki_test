{"hands_on_practices": [{"introduction": "我们的第一个练习旨在为使用随机 Galerkin 方法和间断 Galerkin (DG) 方法进行不确定性量化（UQ）打下基础。我们将研究一个非线性守恒律，并推导其半离散格式，重点关注时间导数项。通过构建局部质量矩阵，本练习将具体展示空间和随机自由度如何通过张量积结构进行组合 [@problem_id:3426145]。", "problem": "考虑非线性守恒律伯格斯方程 $u_t + \\frac{1}{2}(u^2)_x = 0$，定义在空间域 $[0,1]$ 上，使用包含 $N$ 个尺寸为 $h = \\frac{1}{N}$ 的单元的均匀网格。使用间断 Galerkin (DG) 方法，其模态空间基的阶数为 $p=1$，并使用广义多项式混沌 (gPC) 进行不确定性量化，其在单个标量随机变量 $\\zeta$ 上的多项式阶数为 $P=1$。该随机变量在 $[-1,1]$ 上均匀分布，密度为 $\\rho(\\zeta) = \\frac{1}{2}$。gPC 基是相对于 $\\rho$ 正交归一化的 Legendre 族：$\\psi_0(\\zeta) = 1$ 和 $\\psi_1(\\zeta) = \\sqrt{3}\\,\\zeta$。在每个单元上，通过 $x = x_e + \\frac{h}{2}\\eta$ 将物理坐标 $x$ 映射到参考坐标 $\\eta \\in [-1,1]$，并使用模态 Legendre 空间基 $P_0(\\eta) = 1$ 和 $P_1(\\eta) = \\eta$。将单元 $e$ 上的局部解近似为\n$$\nu_e(\\eta,t,\\zeta) = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\widehat{u}_{i,k}^{(e)}(t)\\,P_i(\\eta)\\,\\psi_k(\\zeta).\n$$\n使用与空间基函数相同的检验函数以及伯格斯方程的 Lax–Friedrichs 数值通量，推导每个单元上的半离散 DG 弱形式，\n$$\nf^{\\ast}(a,b) = \\frac{1}{2}\\left( \\frac{a^2}{2} + \\frac{b^2}{2} \\right) - \\frac{\\alpha}{2}\\,(b-a),\n$$\n其中 $\\alpha \\ge 0$ 是为限制特征速度而选择的确定性常数。用空间-随机系数 $\\widehat{u}_{i,k}^{(e)}(t)$ 来组装局部单元系统，明确指出空间质量算子、由 $\\frac{1}{2}(u^2)$ 引起的体积耦合以及面通量贡献。在推导中，仅使用 Legendre 多项式的性质、gPC 基相对于 $\\rho$ 的正交归一性以及物理坐标与参考坐标之间的映射关系。\n\n最后，计算并报告与系数排序 $\\big(\\widehat{u}_{0,0}^{(e)},\\,\\widehat{u}_{1,0}^{(e)},\\,\\widehat{u}_{0,1}^{(e)},\\,\\widehat{u}_{1,1}^{(e)}\\big)$ 相关联的单元 $e$ 的显式 $4 \\times 4$ 空间-随机局部质量矩阵 $M_e$。你的最终答案必须是这个以精确封闭形式写出的矩阵。不需要四舍五入，答案中也不涉及单位。", "solution": "该问题要求使用间断 Galerkin (DG) 方法和广义多项式混沌 (gPC) 进行不确定性量化，推导伯格斯方程的半离散弱形式，并显式计算局部空间-随机质量矩阵。\n\n控制偏微分方程 (PDE) 是伯格斯方程：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}u^2\\right) = 0\n$$\n解 $u(x, t, \\zeta)$ 在每个单元 $I_e = [x_{e-1/2}, x_{e+1/2}]$ 上通过使用 $x = x_e + \\frac{h}{2}\\eta$ 映射到参考单元 $\\eta \\in [-1,1]$ 来近似。该近似是空间基函数和随机基函数的张量积：\n$$\nu_e(\\eta, t, \\zeta) = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\widehat{u}_{i,k}^{(e)}(t)\\,P_i(\\eta)\\,\\psi_k(\\zeta)\n$$\n其中 $P_i(\\eta)$ 是空间 Legendre 基函数 ($P_0(\\eta)=1, P_1(\\eta)=\\eta$)，$\\psi_k(\\zeta)$ 是正交归一的 gPC 基函数 ($\\psi_0(\\zeta)=1, \\psi_1(\\zeta)=\\sqrt{3}\\zeta$)。\n\n标准的 DG 弱形式是通过将 PDE 乘以一个空间检验函数 $v_h(x)$ 并在一个单元 $I_e$ 上积分得到的。对通量项使用分部积分法，我们得到：\n$$\n\\int_{I_e} \\frac{\\partial u}{\\partial t} v_h \\,dx - \\int_{I_e} \\frac{1}{2}u^2 \\frac{dv_h}{dx} \\,dx + \\left[ f^*(u) v_h \\right]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\n其中 $f^*(u)$ 是数值通量，取代了单元边界处的解析通量 $\\frac{1}{2}u^2$。这被指定为 Lax-Friedrichs 通量。该项展开为 $f^*(u(x_{e+1/2}^-), u(x_{e+1/2}^+)) v_h(x_{e+1/2}) - f^*(u(x_{e-1/2}^-), u(x_{e-1/2}^+)) v_h(x_{e-1/2})$。\n\n我们现在应用随机 Galerkin 方法。检验函数为 $v_{jl}(\\eta, \\zeta) = P_j(\\eta)\\psi_l(\\zeta)$，其中 $j, l \\in \\{0, 1\\}$。我们将空间离散化但在 $\\zeta$ 上仍连续的方程乘以 $\\psi_l(\\zeta)$，并使用权重函数 $\\rho(\\zeta) = \\frac{1}{2}$ 在随机域上积分。这将方程投影到 gPC 基上。空间检验函数为 $v_h(\\eta) = P_j(\\eta)$。变换变量到参考单元（$dx = \\frac{h}{2}d\\eta$, $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\eta}$）后，完整的弱形式变为：\n$$\n\\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( \\int_{-1}^{1} \\frac{\\partial u}{\\partial t} P_j(\\eta) \\frac{h}{2} \\,d\\eta \\right) d\\zeta \\\\\n- \\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( \\int_{-1}^{1} \\frac{1}{2}u^2 \\frac{2}{h}\\frac{dP_j}{d\\eta} \\frac{h}{2} \\,d\\eta \\right) d\\zeta \\\\\n+ \\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( f_{e+1/2}^* P_j(1) - f_{e-1/2}^* P_j(-1) \\right) d\\zeta = 0\n$$\n对 $j,l \\in \\{0,1\\}$。我们分别分析每一项。\n\n1.  **质量算子（时间导数项）：**\n    让我们用 $\\mathcal{M}$ 表示这一项。\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{\\partial u}{\\partial t} P_j(\\eta) \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    代入 $u_t$ 的展开式 $u_t = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} P_i(\\eta)\\psi_k(\\zeta)$：\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} P_i(\\eta)\\psi_k(\\zeta) \\right) P_j(\\eta) \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    重新排列求和与积分：\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right) \\left( \\int_{-1}^{1} \\psi_k(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta) \\,d\\zeta \\right)\n    $$\n    gPC 基相对于权重 $\\rho(\\zeta)$ 是正交归一的，所以 $\\int_{-1}^{1} \\psi_k(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta) \\,d\\zeta = \\delta_{kl}$，即 Kronecker delta。\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right) \\delta_{kl}\n    $$\n    对 $k$ 求和使求和项收缩，只剩下 $k=l$ 的项。\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1} \\frac{d\\widehat{u}_{i,l}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right)\n    $$\n    这个表达式定义了局部质量矩阵 $M_e$ 的各项。\n\n2.  **体积耦合（非线性对流项）：**\n    让我们用 $\\mathcal{V}$ 表示这一项。\n    $$\n    \\mathcal{V} = - \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2}u^2 \\frac{dP_j}{d\\eta} \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    $u^2(\\eta,\\zeta)$ 由 $(\\sum_{i,k} \\widehat{u}_{ik}P_i\\psi_k)(\\sum_{m,n} \\widehat{u}_{mn}P_m\\psi_n)$ 给出。这一项以非线性方式耦合了所有的模态系数。它涉及到形如 $\\int_{-1}^1 P_i(\\eta)P_m(\\eta)\\frac{dP_j}{d\\eta}d\\eta$ 的空间积分和形如 $\\int_{-1}^1 \\psi_k(\\zeta)\\psi_n(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta)d\\zeta$ 的随机积分。\n\n3.  **面通量贡献：**\n    让我们用 $\\mathcal{F}$ 表示这一项。\n    $$\n    \\mathcal{F} = P_j(1) \\int_{-1}^{1} f_{e+1/2}^* \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\zeta - P_j(-1) \\int_{-1}^{1} f_{e-1/2}^* \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\zeta\n    $$\n    数值通量 $f^*(a,b)$ 是边界迹 $a=u_e$ 和 $b=u_{e+1}$ 的非线性函数，而这些边界迹本身是 $\\zeta$ 的展开式。例如，$u_e(\\eta=1, \\zeta) = \\sum_{i,k} \\widehat{u}_{ik}^{(e)} P_i(1) \\psi_k(\\zeta)$。这一项将单元 $e$ 的系数与其邻居的系数非线性地耦合起来。\n\n**局部质量矩阵 $M_e$ 的计算**\n\n最后的任务是计算单元 $e$ 的 $4 \\times 4$ 质量矩阵 $M_e$。其元素是方程组中时间导数向量 $\\dot{\\mathbf{\\widehat{u}}}^{(e)} = \\left(\\frac{d\\widehat{u}_{0,0}^{(e)}}{dt}, \\frac{d\\widehat{u}_{1,0}^{(e)}}{dt}, \\frac{d\\widehat{u}_{0,1}^{(e)}}{dt}, \\frac{d\\widehat{u}_{1,1}^{(e)}}{dt}\\right)^T$ 的系数。\n从 $\\mathcal{M}$ 的表达式可知，该系统具有 $M_e \\dot{\\mathbf{\\widehat{u}}}^{(e)}$ 的形式。让我们将参考单元上的局部空间质量矩阵定义为 $M^{sp}$，其元素为 $M^{sp}_{ji} = \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta$。\n使用 $P_0(\\eta)=1$ 和 $P_1(\\eta)=\\eta$：\n$M_{00}^{sp} = \\int_{-1}^{1} (1)(1) \\,d\\eta = [\\eta]_{-1}^1 = 2$。\n$M_{01}^{sp} = M_{10}^{sp} = \\int_{-1}^{1} (1)(\\eta) \\,d\\eta = [\\eta^2/2]_{-1}^1 = 0$。\n$M_{11}^{sp} = \\int_{-1}^{1} (\\eta)(\\eta) \\,d\\eta = [\\eta^3/3]_{-1}^1 = \\frac{1}{3} - (-\\frac{1}{3}) = \\frac{2}{3}$。\n所以，空间质量矩阵是 $M^{sp} = \\begin{pmatrix} 2  0 \\\\ 0  \\frac{2}{3} \\end{pmatrix}$。\n\n$\\mathcal{M}$ 的表达式表明，对于给定的随机检验模态 $l$，方程仅涉及具有相同随机指数的系数 $\\widehat{u}_{i,l}$。这意味着完整的质量矩阵将是块对角矩阵。我们有两个块，一个用于 $l=0$，一个用于 $l=1$。\n对于 $l=0$，系统涉及 $\\dot{\\widehat{u}}_{0,0}$ 和 $\\dot{\\widehat{u}}_{1,0}$。子矩阵是 $\\frac{h}{2} M^{sp}$。\n对于 $l=1$，系统涉及 $\\dot{\\widehat{u}}_{0,1}$ 和 $\\dot{\\widehat{u}}_{1,1}$。子矩阵也是 $\\frac{h}{2} M^{sp}$。\n\n因此，完整系统的质量矩阵 $M_e$ 是 Kronecker 积 $M_e = I_2 \\otimes \\left(\\frac{h}{2}M^{sp}\\right)$，其中 $I_2$ 是来自随机 Galerkin 投影正交归一性的 $2 \\times 2$ 单位矩阵。\n让我们计算排序为 $(\\widehat{u}_{0,0}^{(e)},\\,\\widehat{u}_{1,0}^{(e)},\\,\\widehat{u}_{0,1}^{(e)},\\,\\widehat{u}_{1,1}^{(e)})$ 的块矩阵。\n\n该块是 $\\frac{h}{2}M^{sp} = \\frac{h}{2}\\begin{pmatrix} 2  0 \\\\ 0  \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} h  0 \\\\ 0  \\frac{h}{3} \\end{pmatrix}$。\n\n完整的 $4 \\times 4$ 质量矩阵是：\n$$\nM_e = \\begin{pmatrix} \\frac{h}{2}M^{sp}  0 \\\\ 0  \\frac{h}{2}M^{sp} \\end{pmatrix} = \\begin{pmatrix} h  0  0  0 \\\\ 0  \\frac{h}{3}  0  0 \\\\ 0  0  h  0 \\\\ 0  0  0  \\frac{h}{3} \\end{pmatrix}\n$$\n这是单元 $e$ 的空间-随机局部质量矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} h  0  0  0 \\\\ 0  \\frac{h}{3}  0  0 \\\\ 0  0  h  0 \\\\ 0  0  0  \\frac{h}{3} \\end{pmatrix}}\n$$", "id": "3426145"}, {"introduction": "在掌握了质量矩阵的结构之后，我们现在转向一个更具挑战性的方面：处理随机系数，这会引入随机模态之间的耦合。本练习将深入探讨随机 Galerkin 系统的核心，即刚度矩阵的构建，这需要计算 gPC 基函数的三重积积分。通过计算一个线性扩散模型系统矩阵中的特定元素，您将亲身体验随机系数如何将问题转化为一个耦合的代数系统 [@problem_id:3426119]。", "problem": "考虑一个线性扩散型模型的单参数不确定性量化问题，该模型通过单单元间断 Galerkin (DG) 方法在空间上进行离散化。设随机输入为单个标准正态变量 $\\,\\xi \\sim \\mathcal{N}(0,1)\\,$，其密度函数为 $\\,\\varphi(\\xi) = (2\\pi)^{-1/2}\\exp(-\\xi^{2}/2)\\,$。使用广义多项式混沌 (gPC) 随机 Galerkin (SG) 近似，其正交概率 Hermite 基为 $\\{\\psi_{n}(\\xi)\\}_{n=0}^{2}$，总阶数最高为 $p=2$，其中 $\\psi_{0}(\\xi)=1$，$\\psi_{1}(\\xi)=\\xi$，且 $\\psi_{2}(\\xi)=(\\xi^{2}-1)/\\sqrt{2}$。定义三乘积系数\n$$\nC_{\\alpha\\beta\\gamma} \\;=\\; \\mathbb{E}\\!\\left[\\psi_{\\alpha}(\\xi)\\,\\psi_{\\beta}(\\xi)\\,\\psi_{\\gamma}(\\xi)\\right] \\;=\\; \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(\\xi)\\,\\psi_{\\beta}(\\xi)\\,\\psi_{\\gamma}(\\xi)\\,\\varphi(\\xi)\\,d\\xi,\n$$\n对于 $\\alpha,\\beta,\\gamma \\in \\{0,1,2\\}$。假设空间 DG 半离散化，在进行数值积分和通量指定后，对于单元上唯一的局部试探函数，产生单个标量空间质量 $M_{s}=2$ 和单个标量空间刚度 $K_{s}=3$。随机扩散系数在相同的随机基中展开为\n$$\na(\\xi) \\;=\\; a_{0}\\,\\psi_{0}(\\xi) \\;+\\; a_{1}\\,\\psi_{1}(\\xi) \\;+\\; a_{2}\\,\\psi_{2}\\!(\\xi),\n$$\n其确定性系数为 $a_{0}=3$, $a_{1}=-1$, 和 $a_{2}=2$。\n\n在随机 Galerkin 系统中，$3\\times 3$ 的随机质量块是 $G^{(0)}$，其元素为 $G^{(0)}_{\\alpha\\beta}=\\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}]=\\delta_{\\alpha\\beta}$，而 $3\\times 3$ 的随机刚度块是\n$$\nS \\;=\\; a_{0}\\,G^{(0)} \\;+\\; a_{1}\\,G^{(1)} \\;+\\; a_{2}\\,G^{(2)}, \\quad \\text{其中}\\quad G^{(\\gamma)}_{\\alpha\\beta} \\;=\\; C_{\\alpha\\beta\\gamma}.\n$$\nSG 系统中的完整质量矩阵和刚度矩阵分别为 $M = M_{s}\\,G^{(0)}$ 和 $K = K_{s}\\,S$。\n\n从 $\\{\\psi_{n}\\}$ 相对于 $\\varphi(\\xi)$ 的正交性以及概率 Hermite 多项式的定义性质出发，显式计算组装 $G^{(0)}$, $G^{(1)}$, 和 $G^{(2)}$ 所需的所有 $C_{\\alpha\\beta\\gamma}$（对于 $\\alpha,\\beta,\\gamma \\in \\{0,1,2\\}$）。然后组装 $S$ 和完整的刚度矩阵 $K = K_{s}S$。\n\n当基的排序为 $(\\psi_{0},\\psi_{1},\\psi_{2})$ 对应于索引 $(1,2,3)$ 时，$K$ 的 $(3,3)$ 元素的精确封闭形式值是多少？请以单个简化的解析表达式给出答案。不要四舍五入。", "solution": "用户想要找出给定问题的值。\n\n### 第 1 步：提取已知条件\n-   **随机变量**：一个标准正态变量 $\\xi \\sim \\mathcal{N}(0,1)$，其概率密度函数为 $\\varphi(\\xi) = (2\\pi)^{-1/2}\\exp(-\\xi^{2}/2)$。\n-   **随机基**：最高阶数为 $p=2$ 的正交概率 Hermite 多项式：\n    -   $\\psi_{0}(\\xi)=1$\n    -   $\\psi_{1}(\\xi)=\\xi$\n    -   $\\psi_{2}(\\xi)=(\\xi^{2}-1)/\\sqrt{2}$\n-   **正交性**：$\\mathbb{E}[\\psi_{\\alpha}(\\xi)\\psi_{\\beta}(\\xi)] = \\delta_{\\alpha\\beta}$，其中期望 $\\mathbb{E}[\\cdot] = \\int_{-\\infty}^{\\infty} (\\cdot) \\varphi(\\xi) d\\xi$。\n-   **三乘积系数**：$C_{\\alpha\\beta\\gamma} = \\mathbb{E}[\\psi_{\\alpha}(\\xi)\\psi_{\\beta}(\\xi)\\psi_{\\gamma}(\\xi)]$，对于 $\\alpha,\\beta,\\gamma \\in \\{0,1,2\\}$。\n-   **空间离散化常数**：\n    -   空间质量 $M_{s}=2$。\n    -   空间刚度 $K_{s}=3$。\n-   **随机扩散系数**：$a(\\xi) = a_{0}\\psi_{0}(\\xi) + a_{1}\\psi_{1}(\\xi) + a_{2}\\psi_{2}(\\xi)$，其系数为：\n    -   $a_{0}=3$\n    -   $a_{1}=-1$\n    -   $a_{2}=2$\n-   **随机 Galerkin (SG) 矩阵**：\n    -   随机质量块：$G^{(0)}$，其元素为 $G^{(0)}_{\\alpha\\beta}=\\delta_{\\alpha\\beta}$。\n    -   随机刚度分量：$G^{(\\gamma)}$，其元素为 $G^{(\\gamma)}_{\\alpha\\beta} = C_{\\alpha\\beta\\gamma}$。\n    -   随机刚度块：$S = a_{0}G^{(0)} + a_{1}G^{(1)} + a_{2}G^{(2)}$。\n    -   完整 SG 质量矩阵：$M = M_{s}G^{(0)}$。\n    -   完整 SG 刚度矩阵：$K = K_{s}S$。\n-   **索引**：基 $(\\psi_{0}, \\psi_{1}, \\psi_{2})$ 对应于矩阵索引 $(1, 2, 3)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了随机 Galerkin 方法与广义多项式混沌 (gPC) 展开的一个标准应用。针对高斯随机变量使用 Hermite 多项式是此项技术（Wiener-Askey 格式）的基石。所有定义和关系都与已建立的用于不确定性量化的谱方法和间断 Galerkin 方法理论一致。\n-   **适定性**：该问题已完全指定。所有计算所需量所必需的数据（$K_s$, $a_n$）和定义（$\\psi_n$, $S$, $K$）均已提供。问题要求计算一个由已知条件唯一确定的矩阵的特定元素。\n-   **客观性**：该问题以精确、形式化的数学语言陈述，没有歧义或主观内容。\n\n该问题是使用谱方法进行不确定性量化（UQ）领域中一个定义明确的标准练习。它科学合理、自成体系且客观。\n\n### 第 3 步：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n目标是计算完整刚度矩阵 $K$ 的 $(3,3)$ 元素。矩阵 $K$ 定义为空间刚度标量 $K_{s}$ 与随机刚度块 $S$ 的张量积，即 $K = K_{s}S$。$S$ 的维度由多项式混沌基确定，其大小为 $p+1 = 3$。因此，$S$ 是一个 $3 \\times 3$ 的矩阵。\n\n$K$ 的 $(3,3)$ 元素，记为 $K_{33}$，由下式给出：\n$$\nK_{33} = K_{s} S_{33}\n$$\n随机刚度矩阵 $S$ 定义为矩阵 $G^{(\\gamma)}$ 的线性组合：\n$$\nS = a_{0}G^{(0)} + a_{1}G^{(1)} + a_{2}G^{(2)}\n$$\n因此，$S$ 的 $(3,3)$ 元素为：\n$$\nS_{33} = a_{0}G^{(0)}_{33} + a_{1}G^{(1)}_{33} + a_{2}G^{(2)}_{33}\n$$\n问题指定基函数 $\\psi_{0}, \\psi_{1}, \\psi_{2}$ 对应于索引 $1, 2, 3$。因此，矩阵元素 $(i,j)=(3,3)$ 对应于基函数 $(\\psi_{3-1}, \\psi_{3-1}) = (\\psi_{2}, \\psi_{2})$。通常，我们对基函数使用从 0 开始的索引 $\\alpha, \\beta, \\gamma \\in \\{0, 1, 2\\}$。矩阵元素 $G^{(\\gamma)}_{ij}$ 对应于 $G^{(\\gamma)}_{\\alpha\\beta}$，其中 $\\alpha=i-1$ 且 $\\beta=j-1$。\n\n矩阵 $G^{(\\gamma)}$ 的元素由三乘积系数 $C_{\\alpha\\beta\\gamma}$ 定义：\n$$\nG^{(\\gamma)}_{\\alpha\\beta} = C_{\\alpha\\beta\\gamma} = \\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}\\psi_{\\gamma}]\n$$\n对于特定的元素 $S_{33}$，我们需要计算 $\\gamma \\in \\{0, 1, 2\\}$ 时的 $G^{(\\gamma)}_{33}$。这意味着我们需要三乘积系数 $C_{220}$, $C_{221}$ 和 $C_{222}$。\n\n1.  **计算 $C_{220}$**：\n    $$\n    C_{220} = \\mathbb{E}[\\psi_{2}(\\xi)\\,\\psi_{2}(\\xi)\\,\\psi_{0}(\\xi)]\n    $$\n    由于 $\\psi_{0}(\\xi)=1$，这可以简化为：\n    $$\n    C_{220} = \\mathbb{E}[\\psi_{2}(\\xi)\\,\\psi_{2}(\\xi)]\n    $$\n    根据基的正交性，$\\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}] = \\delta_{\\alpha\\beta}$，其中 $\\delta_{\\alpha\\beta}$ 是克罗内克 delta。对于 $\\alpha=\\beta=2$：\n    $$\n    C_{220} = \\delta_{22} = 1\n    $$\n    这对应于矩阵元素 $G^{(0)}_{33} = 1$。\n\n2.  **计算 $C_{221}$**：\n    $$\n    C_{221} = \\mathbb{E}[\\psi_{2}(\\xi)\\,\\psi_{2}(\\xi)\\,\\psi_{1}(\\xi)] = \\int_{-\\infty}^{\\infty} \\psi_{2}(\\xi)^{2}\\,\\psi_{1}(\\xi)\\,\\varphi(\\xi)\\,d\\xi\n    $$\n    我们来分析被积函数。基函数 $\\psi_{1}(\\xi)=\\xi$（奇函数）和 $\\psi_{2}(\\xi)=(\\xi^{2}-1)/\\sqrt{2}$（偶函数）。因此，其平方 $\\psi_{2}(\\xi)^{2}$ 也是一个偶函数。一个偶函数（$\\psi_{2}^{2}$）和一个奇函数（$\\psi_{1}$）的乘积是一个奇函数。密度函数 $\\varphi(\\xi)=(2\\pi)^{-1/2}\\exp(-\\xi^{2}/2)$ 是一个偶函数。一个奇函数乘以一个偶函数在对称区间 $(-\\infty, \\infty)$ 上的积分等于零。\n    因此，无需显式计算矩：\n    $$\n    C_{221} = 0\n    $$\n    这对应于矩阵元素 $G^{(1)}_{33} = 0$。\n\n3.  **计算 $C_{222}$**：\n    $$\n    C_{222} = \\mathbb{E}[\\psi_{2}(\\xi)\\,\\psi_{2}(\\xi)\\,\\psi_{2}(\\xi)] = \\mathbb{E}[\\psi_{2}(\\xi)^{3}]\n    $$\n    我们代入 $\\psi_{2}(\\xi)$ 的表达式：\n    $$\n    \\psi_{2}(\\xi)^{3} = \\left(\\frac{\\xi^{2}-1}{\\sqrt{2}}\\right)^{3} = \\frac{(\\xi^{2}-1)^{3}}{(\\sqrt{2})^{3}} = \\frac{\\xi^{6} - 3\\xi^{4} + 3\\xi^{2} - 1}{2\\sqrt{2}}\n    $$\n    根据期望的线性性质：\n    $$\n    C_{222} = \\frac{1}{2\\sqrt{2}} \\left( \\mathbb{E}[\\xi^{6}] - 3\\mathbb{E}[\\xi^{4}] + 3\\mathbb{E}[\\xi^{2}] - \\mathbb{E}[1] \\right)\n    $$\n    需要标准正态变量 $\\xi \\sim \\mathcal{N}(0,1)$ 的矩。对于偶数次幂 $2n$，矩由双阶乘给出：$\\mathbb{E}[\\xi^{2n}] = (2n-1)!! = (2n-1)(2n-3)\\cdots 1$。\n    -   $\\mathbb{E}[1] = 1$\n    -   $\\mathbb{E}[\\xi^{2}] = (2-1)!! = 1!! = 1$\n    -   $\\mathbb{E}[\\xi^{4}] = (4-1)!! = 3!! = 3 \\times 1 = 3$\n    -   $\\mathbb{E}[\\xi^{6}] = (6-1)!! = 5!! = 5 \\times 3 \\times 1 = 15$\n    代入这些值：\n    $$\n    C_{222} = \\frac{1}{2\\sqrt{2}} \\left( 15 - 3(3) + 3(1) - 1 \\right) = \\frac{1}{2\\sqrt{2}} (15 - 9 + 3 - 1) = \\frac{8}{2\\sqrt{2}} = \\frac{4}{\\sqrt{2}}\n    $$\n    分母有理化后得到：\n    $$\n    C_{222} = \\frac{4\\sqrt{2}}{2} = 2\\sqrt{2}\n    $$\n    这对应于矩阵元素 $G^{(2)}_{33} = 2\\sqrt{2}$。\n\n现在，我们使用给定的系数 $a_{0}=3$，$a_{1}=-1$ 和 $a_{2}=2$ 来组装元素 $S_{33}$：\n$$\nS_{33} = a_{0}G^{(0)}_{33} + a_{1}G^{(1)}_{33} + a_{2}G^{(2)}_{33} = a_{0}C_{220} + a_{1}C_{221} + a_{2}C_{222}\n$$\n$$\nS_{33} = (3)(1) + (-1)(0) + (2)(2\\sqrt{2}) = 3 + 4\\sqrt{2}\n$$\n最后，我们使用给定的空间刚度 $K_{s}=3$ 来计算完整刚度矩阵 $K$ 的 $(3,3)$ 元素：\n$$\nK_{33} = K_{s} S_{33} = 3(3 + 4\\sqrt{2})\n$$\n$$\nK_{33} = 9 + 12\\sqrt{2}\n$$\n这就是指定矩阵元素的确切封闭形式值。", "answer": "$$\n\\boxed{9 + 12\\sqrt{2}}\n$$", "id": "3426119"}, {"introduction": "最后，我们将从局部元素分析扩展到全局视角，研究整个耦合系统矩阵的结构和计算特性。本练习将引导您推导出由 DG 空间离散化和 gPC 随机离散化产生的全局矩阵的优雅的 Kronecker 积结构。通过分析这种结构下的稀疏性，您将理解如何利用这些特性来设计高效的求解器，这是大规模 UQ 计算中的一个关键考虑因素 [@problem_id:3426079]。", "problem": "考虑空间域 $\\mathcal{D}=(0,1)$ 上的随机扩散系数的一维椭圆模型问题：求 $u:\\mathcal{D}\\times\\Gamma\\to\\mathbb{R}$ 使得\n$$\n-\\frac{d}{dx}\\!\\left(a(x,\\xi)\\,\\frac{du}{dx}(x,\\xi)\\right)=f(x)\\quad\\text{for }x\\in(0,1),\n$$\n具有齐次狄利克雷边界条件 $u(0,\\xi)=u(1,\\xi)=0$ 对所有 $\\xi\\in\\Gamma$ 成立。随机输入被建模为单个标量随机变量 $\\xi\\in[-1,1]$，服从均匀分布，且系数关于 $\\xi$ 是仿射的：\n$$\na(x,\\xi)=a_{0}(x)+a_{1}(x)\\,\\xi,\n$$\n其中 $a_{0}(x)0$ 和 $a_{1}(x)$ 是确定性函数。\n\n使用对称内部罚分段伽辽金(Discontinuous Galerkin, DG)方法对空间域进行离散化，每个单元内多项式次数为 $r=2$，采用包含 $N=50$ 个单元的均匀网格。令 $\\{\\varphi_{i}(x)\\}_{i=1}^{n_{x}}$ 表示空间DG基，其中 $n_{x}=3N=150$。使用广义多项式混沌(Generalized Polynomial Chaos, gPC)对随机空间进行离散化，采用单个变量 $\\xi$ 中最高总次数为 $p_{s}=4$ 的标准正交勒让德基 $\\{\\psi_{k}(\\xi)\\}_{k=0}^{p_{s}}$；因此，随机基函数的数量为 $n_{s}=p_{s}+1=5$。构造伽辽金近似\n$$\nu_{h}(x,\\xi)=\\sum_{i=1}^{n_{x}}\\sum_{k=0}^{p_{s}} c_{ik}\\,\\varphi_{i}(x)\\,\\psi_{k}(\\xi),\n$$\n并使用空间上的标准DG弱形式与随机空间中的伽辽金投影相结合，其中随机内积为\n$$\n\\langle g,h\\rangle := \\int_{-1}^{1} g(\\xi)\\,h(\\xi)\\,\\frac{1}{2}\\,d\\xi.\n$$\n\n从对称内部罚DG双线性形式和带标准正交基的随机空间中伽辽金投影的基本定义出发，完成以下任务：\n\n1. 推导耦合空间自由度和随机自由度的全局代数系统。将系统矩阵表示为分离了确定性空间算子和随机矩矩阵的克罗内克积形式。您的推导必须从DG弱形式和gPC伽辽金投影开始，并从第一性原理（正交性和双线性）明确论证这种分离。\n\n2. 使用著名的标准正交勒让德多项式的三项递推关系，确定由含 $a_{0}(x)$ 和 $a_{1}(x)\\,\\xi$ 的项产生的随机矩矩阵的稀疏模式。基于标准正交性和奇偶性，解释与乘以 $\\xi$ 相关联的随机矩阵中是否出现任何对角线元素。\n\n3. 使用均匀网格上 $r=2$ 的对称内部罚DG刚度算子的标准结构，观察到每个单元在主块对角线上贡献一个 $3\\times 3$ 的稠密块，而最近邻耦合在第一条次对角线上贡献 $3\\times 3$ 的稠密块。假设这些块是稠密的，且系数函数不引入额外的零点，确定分别从 $a_{0}$ 和 $a_{1}$ 得到的每个空间刚度矩阵中的非零项的确切数量。\n\n4. 结合您的发现，计算从克罗内克结构和得到的完整全局系统矩阵的非零项的确切数量。您可以假设两个稀疏矩阵的克罗内克积的非零模式是其因子非零模式的笛卡尔积，并且 $a_{0}$ 和 $a_{1}$ 项的贡献在全局矩阵中不重叠，因为一个只占据块对角线的随机位置，而另一个只占据严格的块次对角线的随机位置。\n\n给出您的最终答案，为一个等于全局矩阵中非零项确切数量的整数。不需要四舍五入。", "solution": "该问题要求推导一个具有随机系数的一维椭圆偏微分方程的全局代数系统，该方程使用空间上的分段伽辽金(DG)方法和随机维度上的广义多项式混沌(gPC)展开进行离散化。最后，要求计算得到的全局系统矩阵中非零项的总数。\n\n问题陈述已经过验证，被认为是科学上合理的、适定的、客观且自洽的。因此，下面提供了完整的解答。\n\n### 1. 全局代数系统的推导\n\n给定的偏微分方程为：\n$$\n-\\frac{d}{dx}\\!\\left(a(x,\\xi)\\,\\frac{du}{dx}(x,\\xi)\\right)=f(x) \\quad \\text{for } x \\in (0,1)\n$$\n边界条件为 $u(0,\\xi)=u(1,\\xi)=0$。随机系数为 $a(x,\\xi) = a_0(x) + a_1(x)\\xi$。\n\n解 $u(x,\\xi)$ 通过变量分离和伽辽金展开进行近似：\n$$\nu_h(x,\\xi) = \\sum_{i=1}^{n_x} \\sum_{k=0}^{p_s} c_{ik} \\varphi_i(x) \\psi_k(\\xi)\n$$\n其中 $\\{\\varphi_i(x)\\}$ 是空间DG基，$\\{\\psi_k(\\xi)\\}$ 是随机gPC基。测试函数的形式为 $v_{jl}(x,\\xi) = \\varphi_j(x)\\psi_l(\\xi)$。\n\n弱形式将空间DG公式与随机伽辽金投影相结合。对称内部罚DG双线性形式，记为 $B(g;u,v)$，在其第一个参数（系数函数 $g$）上是线性的。对于固定的 $\\xi$，空间弱问题是找到 $u(\\cdot, \\xi) \\in V_h = \\text{span}\\{\\varphi_i\\}_{i=1}^{n_x}$，使得对于所有 $v_h \\in V_h$：\n$$\nB(a(\\cdot,\\xi); u(\\cdot,\\xi), v_h) = (f, v_h)_{\\mathcal{D}}\n$$\n其中 $(\\cdot,\\cdot)_{\\mathcal{D}}$ 是 $L^2((0,1))$ 内积。\n\n代入 $u(x,\\xi) = \\sum_i u_i(\\xi) \\varphi_i(x)$ 的展开式并使用 $v_h = \\varphi_j$，我们得到关于系数函数 $u_i(\\xi)$ 的方程组：\n$$\n\\sum_{i=1}^{n_x} B(a(\\cdot, \\xi); \\varphi_i, \\varphi_j) u_i(\\xi) = (f, \\varphi_j)_{\\mathcal{D}} \\quad \\text{for } j=1, \\dots, n_x\n$$\n利用 $a(x,\\xi)$ 的仿射形式以及 $B(\\cdot; \\cdot, \\cdot)$ 的线性性质：\n$$\nB(a(\\cdot, \\xi); \\varphi_i, \\varphi_j) = B(a_0(\\cdot) + a_1(\\cdot)\\xi; \\varphi_i, \\varphi_j) = B(a_0; \\varphi_i, \\varphi_j) + \\xi B(a_1; \\varphi_i, \\varphi_j)\n$$\n我们定义确定性空间刚度矩阵 $K_0$ 和 $K_1$，其元素为：\n$$\n(K_0)_{ji} = B(a_0; \\varphi_i, \\varphi_j) \\quad \\text{and} \\quad (K_1)_{ji} = B(a_1; \\varphi_i, \\varphi_j)\n$$\n以及空间载荷向量 $F_{sp}$，其元素为 $(F_{sp})_j = (f, \\varphi_j)_{\\mathcal{D}}$。半离散化系统（空间离散，$\\xi$ 连续）为：\n$$\n(K_0 + \\xi K_1) \\mathbf{u}(\\xi) = F_{sp}\n$$\n其中 $\\mathbf{u}(\\xi)$ 是系数函数向量 $[u_1(\\xi), \\dots, u_{n_x}(\\xi)]^T$。\n\n接下来，我们在随机空间中应用伽辽金投影。我们将函数向量 $\\mathbf{u}(\\xi)$ 在gPC基中展开：$\\mathbf{u}(\\xi) = \\sum_{k=0}^{p_s} C_k \\psi_k(\\xi)$，其中 $C_k = [c_{1k}, c_{2k}, \\dots, c_{n_x,k}]^T$ 是第 $k$ 个随机基函数的确定性系数向量。伽辽金条件要求残差相对于随机内积 $\\langle\\cdot, \\cdot\\rangle$ 与测试基 $\\{\\psi_l(\\xi)\\}_{l=0}^{p_s}$ 正交：\n$$\n\\left\\langle (K_0 + \\xi K_1) \\sum_{k=0}^{p_s} C_k \\psi_k(\\xi) - F_{sp}, \\psi_l(\\xi) \\right\\rangle = 0 \\quad \\text{for } l=0, \\dots, p_s\n$$\n由于 $K_0$, $K_1$, $C_k$, 和 $F_{sp}$ 是确定性的，我们可以将它们从内积中提出：\n$$\n\\sum_{k=0}^{p_s} K_0 C_k \\langle \\psi_k, \\psi_l \\rangle + \\sum_{k=0}^{p_s} K_1 C_k \\langle \\xi \\psi_k, \\psi_l \\rangle = F_{sp} \\langle 1, \\psi_l \\rangle\n$$\n基 $\\{\\psi_k\\}$ 是标准正交的，所以 $\\langle \\psi_k, \\psi_l \\rangle = \\delta_{kl}$。常数函数是 $\\psi_0(\\xi) = 1$，它是归一化的，因为 $\\langle 1,1 \\rangle = \\int_{-1}^1 1^2 \\frac{1}{2} d\\xi = 1$。因此，$\\langle 1, \\psi_l \\rangle = \\langle \\psi_0, \\psi_l \\rangle = \\delta_{0l}$。\n我们定义大小为 $n_s \\times n_s = (p_s+1)\\times(p_s+1)$ 的随机矩矩阵 $M_0$ 和 $M_1$：\n$$\n(M_0)_{lk} = \\langle \\psi_k, \\psi_l \\rangle = \\delta_{kl} \\quad \\implies \\quad M_0 = I_{n_s}\n$$\n$$\n(M_1)_{lk} = \\langle \\xi \\psi_k, \\psi_l \\rangle\n$$\n对于给定的 $l$，系统变为：\n$$\nK_0 C_l + \\sum_{k=0}^{p_s} (M_1)_{lk} K_1 C_k = F_{sp} \\delta_{0l}\n$$\n这表示 $n_s$ 个耦合的线性系统。令 $\\mathcal{C}$ 为全局未知向量，由堆叠向量 $C_k$ 形成：$\\mathcal{C} = [C_0^T, C_1^T, \\dots, C_{p_s}^T]^T$。完整的代数系统可以写成块形式。系统矩阵的第 $(l,k)$ 个块是 $(M_0)_{lk}K_0 + (M_1)_{lk}K_1 = \\delta_{lk}K_0 + (M_1)_{lk}K_1$。\n这种块结构恰好是克罗内克积之和的定义。全局系统矩阵 $\\mathcal{K}$ 是：\n$$\n\\mathcal{K} = M_0 \\otimes K_0 + M_1 \\otimes K_1 = I_{n_s} \\otimes K_0 + M_1 \\otimes K_1\n$$\n其中 $I_{n_s}$ 是 $n_s \\times n_s$ 的单位矩阵。全局系统是 $\\mathcal{K}\\mathcal{C} = \\mathcal{F}$，其中 $\\mathcal{F}$ 是全局右端向量 $[F_{sp}^T, 0, \\dots, 0]^T$。\n\n### 2. 随机矩矩阵的稀疏性\n\n基 $\\{\\psi_k(\\xi)\\}_{k=0}^{p_s}$ 是对于权重为 $1/2$ 的 $[-1,1]$ 上均匀测度的标准正交勒让德多项式。标准勒让德多项式 $P_k(\\xi)$ 在权重为 $1$ 时是正交的，并满足 $\\int_{-1}^1 P_k(\\xi)P_l(\\xi)d\\xi = \\frac{2}{2k+1}\\delta_{kl}$。标准正交基是 $\\psi_k(\\xi) = \\sqrt{\\frac{2k+1}{2}}P_k(\\xi)$。 *注：问题定义的内积是 $\\langle g,h\\rangle := \\int_{-1}^{1} g(\\xi)\\,h(\\xi)\\,\\frac{1}{2}\\,d\\xi$，因此标准正交勒让德多项式为 $\\psi_k(\\xi) = \\sqrt{2k+1}P_k(\\xi)$。*\n\n随机矩阵 $M_1$ 的元素为 $(M_1)_{lk} = \\langle \\xi \\psi_k, \\psi_l \\rangle$。我们使用勒让德多项式的三项递推关系：\n$$\n\\xi P_k(\\xi) = \\frac{k+1}{2k+1} P_{k+1}(\\xi) + \\frac{k}{2k+1} P_{k-1}(\\xi)\n$$\n代入 $P_k(\\xi) = \\psi_k(\\xi)/\\sqrt{2k+1}$ 得到关于 $\\xi \\psi_k(\\xi)$ 的关系：\n$$\n\\xi \\psi_k(\\xi) = \\frac{k+1}{\\sqrt{(2k+1)(2k+3)}} \\psi_{k+1}(\\xi) + \\frac{k}{\\sqrt{(2k-1)(2k+1)}} \\psi_{k-1}(\\xi)\n$$\n通过与 $\\psi_l(\\xi)$ 取内积并利用标准正交性，我们发现 $(M_1)_{lk} = \\langle \\xi \\psi_k, \\psi_l \\rangle$ 仅当 $l=k+1$ 或 $l=k-1$ 时非零。因此，$M_1$ 是一个对称三对角矩阵。\n\n对角线元素为 $(M_1)_{kk} = \\langle \\xi \\psi_k, \\psi_k \\rangle = \\int_{-1}^1 \\xi \\psi_k^2(\\xi) \\frac{1}{2} d\\xi$。由于 $\\psi_k^2(\\xi)$ 是一个偶函数（因为 $P_k(\\xi)$ 的奇偶性为 $(-1)^k$，所以 $P_k^2(\\xi)$ 总是偶函数），被积函数 $\\xi \\psi_k^2(\\xi)$ 是一个奇函数。奇函数在对称区间 $[-1,1]$ 上的积分为零。因此，$M_1$ 的所有对角线元素都为零。\n\n矩阵 $M_1$ 是一个具有零对角线且非零项仅出现在第一条超对角线和次对角线上的对称矩阵。对于 $p_s=4$，矩阵维度为 $n_s=p_s+1=5$。超对角线上有 $n_s-1=4$ 个非零项，次对角线上有 $4$ 个。$M_1$ 中的非零项总数为 $nnz(M_1) = 2(n_s-1) = 2(5-1) = 8$。\n\n### 3. 空间矩阵中非零项的数量\n\n空间离散化使用一个包含 $N=50$ 个单元的均匀网格和多项式次数为 $r=2$ 的DG方法。每个单元的局部基函数数量为 $r+1=3$。空间自由度的总数为 $n_x = (r+1)N = 3 \\times 50 = 150$。\n\n问题陈述指出，DG刚度矩阵（无论是 $K_0$ 还是 $K_1$）具有特定的块结构：\n-   $N=50$ 个稠密的 $3 \\times 3$ 块在主对角线上，对应于每个单元内部的相互作用。\n-   $N-1=49$ 个稠密的 $3 \\times 3$ 块在第一条超对角线上，以及 $N-1=49$ 个稠密的 $3 \\times 3$ 块在第一条次对角线上，对应于相邻单元之间的相互作用。\n\n一个空间矩阵 $K$（无论是 $K_0$ 还是 $K_1$）中的非零项总数是所有这些块中非零项的总和。\n-   来自对角块的非零项：$N \\times (3 \\times 3) = 50 \\times 9 = 450$。\n-   来自次对角块的非零项：$2 \\times (N-1) \\times (3 \\times 3) = 2 \\times 49 \\times 9 = 98 \\times 9 = 882$。\n\n一个空间矩阵中的非零项总数为 $nnz(K) = 450 + 882 = 1332$。\n这对 $K_0$ 和 $K_1$ 都成立，所以 $nnz(K_0) = nnz(K_1) = 1332$。\n\n### 4. 全局矩阵中非零项的总数\n\n全局系统矩阵为 $\\mathcal{K} = I_{n_s} \\otimes K_0 + M_1 \\otimes K_1$。我们使用性质 $nnz(A \\otimes B) = nnz(A) \\times nnz(B)$。\n\n第一项是 $I_{n_s} \\otimes K_0$。矩阵 $I_{n_s}$ 是 $5 \\times 5$ 的单位矩阵，所以 $nnz(I_{n_s})=5$。\n$$\nnnz(I_{n_s} \\otimes K_0) = nnz(I_{n_s}) \\times nnz(K_0) = 5 \\times 1332 = 6660\n$$\n第二项是 $M_1 \\otimes K_1$。根据第2部分，$nnz(M_1) = 8$。\n$$\nnnz(M_1 \\otimes K_1) = nnz(M_1) \\times nnz(K_1) = 8 \\times 1332 = 10656\n$$\n问题正确地指出，这两项的非零模式是不相交的。项 $I_{n_s} \\otimes K_0$ 仅对 $\\mathcal{K}$ 的块对角线（块 $(l,l)$）有贡献，而项 $M_1 \\otimes K_1$ 仅对块次对角线（块 $(l,k)$，其中 $l \\neq k$）有贡献，因为 $M_1$ 的对角线为零。因此，非零项的总数是每一项非零项数量的总和。\n\n$$\nnnz(\\mathcal{K}) = nnz(I_{n_s} \\otimes K_0) + nnz(M_1 \\otimes K_1) = 6660 + 10656 = 17316\n$$\n完整全局系统矩阵中的非零项总数为 $17316$。", "answer": "$$\n\\boxed{17316}\n$$", "id": "3426079"}]}