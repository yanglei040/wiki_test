{"hands_on_practices": [{"introduction": "理论学习之后，通过实践来巩固理解至关重要。本章提供了一系列动手练习，旨在加深您对可压缩Navier-Stokes方程的间断Galerkin（DG）方法中关键数值组成的理解。我们从对流项的核心挑战开始：如何离散化形如 $\\frac{\\partial}{\\partial x}(\\frac{u^2}{2})$ 的非线性项。虽然不同的形式（例如守恒形式和对流形式）在连续分析中是等价的，但它们的离散对应形式却具有截然不同的性质。本练习 [@problem_id:3376460] 将探讨如何构建一种“斜对称”分裂形式以保证能量守恒，这对于长时间模拟的稳定性至关重要。", "problem": "考虑一个出现在可压缩欧拉（Euler）方程和纳维-斯托克斯（Navier–Stokes）方程中的二次对流非线性的一维原型，它由参考单元 $[-1,1]$ 上的无粘性 Burgers 型强形式建模：\n$$\n\\frac{\\partial u}{\\partial t} + \\mathcal{C}(u) = 0, \\qquad \\mathcal{C}(u) := \\frac{\\partial}{\\partial x}\\!\\left(\\frac{u^2}{2}\\right),\n$$\n且带有周期性边界条件。在基于 Gauss–Lobatto–Legendre (GLL) 节点的间断伽辽金 (DG) 配置离散化中，半离散微分算子 $D$ 和对角质量/权重矩阵 $W$ 满足分部求和 (SBP) 性质 $W D + D^{\\top} W = B$，其中 $B$ 是一个仅包含边界贡献项的秩为 2 的矩阵。在周期性网格上，这些边界贡献项在相邻单元之间相互抵消，因此在半离散层面上被视为消失。\n\n- 使用 $[-1,1]$ 上多项式次数 $N=2$ 的以下 GLL 数据：\n  - 节点 $x_0=-1$，$x_1=0$，$x_2=1$。\n  - 求积权重 $W=\\mathrm{diag}\\!\\big(\\tfrac{1}{3},\\tfrac{4}{3},\\tfrac{1}{3}\\big)$。\n  - 微分矩阵\n    $$\n    D \\;=\\;\n    \\begin{pmatrix}\n    -\\tfrac{3}{2} & 2 & -\\tfrac{1}{2}\\\\[4pt]\n    -\\tfrac{1}{2} & 0 & \\tfrac{1}{2}\\\\[4pt]\n    \\tfrac{1}{2} & -2 & \\tfrac{3}{2}\n    \\end{pmatrix}.\n    $$\n  您可以假设 SBP 恒等式 $W D + D^{\\top} W = \\mathrm{diag}(-1,0,1)$ 成立。\n\n- 令 $u(x)=1+x^2$，并令 $u_i := u(x_i)$ 表示其节点值。将节点上的精确强形式对流导数定义为\n  $$\n  s_{\\mathrm{exact},i} := u(x_i)\\,\\frac{d u}{d x}(x_i).\n  $$\n\n- 在配置法中，$\\mathcal{C}(u)$ 在节点上的两种常见的欠积分强形式离散化是：\n  - 守恒（通量）形式：$s_{\\mathrm{cons}} := D\\big(\\tfrac{1}{2} u^{\\circ 2}\\big)$，其中 $u^{\\circ 2}$ 表示逐分量平方。\n  - 平流形式：$s_{\\mathrm{adv}} := U\\,D u$，其中 $U=\\mathrm{diag}(u_0,u_1,u_2)$。\n\n我们在以下族中寻找针对二次非线性的强形式对流导数的一种斜对称分裂形式\n$$\ns_{\\alpha,\\beta}(u) \\;=\\; \\alpha\\, U\\,D u \\;+\\; \\beta\\, D\\!\\left(\\tfrac{1}{2}u^{\\circ 2}\\right),\n$$\n其中常数 $\\alpha$ 和 $\\beta$ 不依赖于 $u$ 或 $x$。您将通过在周期性情况下利用 SBP 性质强制执行离散能量守恒来确定 $\\alpha$ 和 $\\beta$。\n\n任务：\n1) 从 SBP 恒等式和半离散能量 $E = \\tfrac{1}{2} u^{\\top} W u$ 出发，推导斜对称分裂形式 $s_{\\alpha,\\beta}(u)$ 在周期性网格上对所有 $u$ 满足 $dE/dt = 0$ 时 $\\alpha$ 和 $\\beta$ 的充分必要条件。明確地表达出您最终的 $s_{\\mathrm{skew}}(u)$。\n\n2) 使用给定的节点 $x_i$ 和算子 $D$ 和 $W$，计算当 $u(x)=1+x^2$ 时的节点向量 $s_{\\mathrm{exact}}$、$s_{\\mathrm{cons}}$ 和 $s_{\\mathrm{skew}}$。\n\n3) 定义加权混叠误差范数\n$$\n\\|e_{\\mathrm{cons}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{cons},i} - s_{\\mathrm{exact},i}\\right)^{2},\n\\qquad\n\\|e_{\\mathrm{skew}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{skew},i} - s_{\\mathrm{exact},i}\\right)^{2},\n$$\n其中 $w_0=\\tfrac{1}{3}$，$w_1=\\tfrac{4}{3}$，$w_2=\\tfrac{1}{3}$。计算比率\n$$\nr \\;=\\; \\frac{\\|e_{\\mathrm{cons}}\\|_{W}^{2}}{\\|e_{\\mathrm{skew}}\\|_{W}^{2}}.\n$$\n\n以精确数形式提供 $r$ 的最终值。不要包含单位。不要使用百分比。如果进行近似计算，请四舍五入到四位有效数字。", "solution": "该问题被评估为科学上合理、内容自洽且良定的。唯一解所需的所有数据和定义都已提供，不存在内部矛盾或违反数学原理之处。我们可以开始求解。\n\n该问题分为三个任务。我们将按顺序解决它们。\n\n### 任务1：斜对称形式的推导\n我们得到的节点值向量 $\\mathbf{u}$ 的半离散方程为 $\\frac{d\\mathbf{u}}{dt} + s_{\\alpha,\\beta}(\\mathbf{u}) = 0$。单元上的离散动能为 $E = \\frac{1}{2} \\mathbf{u}^{\\top} W \\mathbf{u}$。能量的时间变化率由下式给出：\n$$\n\\frac{dE}{dt} = \\frac{1}{2} \\left( \\frac{d\\mathbf{u}^{\\top}}{dt} W \\mathbf{u} + \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt} \\right) = \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt}\n$$\n这里我们利用了质量矩阵 $W$ 的对称性。代入半离散方程，我们得到：\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W s_{\\alpha,\\beta}(\\mathbf{u})\n$$\n分裂形式 $s_{\\alpha,\\beta}(\\mathbf{u})$ 由下式给出：\n$$\ns_{\\alpha,\\beta}(\\mathbf{u}) = \\alpha U D \\mathbf{u} + \\beta D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right)\n$$\n其中 $U = \\mathrm{diag}(\\mathbf{u})$ 且 $\\mathbf{u}^{\\circ 2}$ 是 $\\mathbf{u}$ 的逐元素平方。能量变化率变为：\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W \\left[ \\alpha U D \\mathbf{u} + \\frac{\\beta}{2} D(\\mathbf{u}^{\\circ 2}) \\right] = -\\alpha (\\mathbf{u}^{\\top} W U D \\mathbf{u}) - \\frac{\\beta}{2} (\\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2}))\n$$\n我们来分析 $\\mathbf{u}^{\\top} W U$ 这一项。由于 $W$ 和 $U$ 都是对角矩阵，其对角线元素分别为 $w_i$ 和 $u_i$，行向量 $\\mathbf{u}^{\\top} W U$ 的第 $j$ 个元素是 $\\sum_i u_i (WU)_{ij} = \\sum_i u_i W_{ij} U_{jj} = u_j W_{jj} U_{jj} = u_j w_j u_j = w_j u_j^2$。这与行向量 $(\\mathbf{u}^{\\circ 2})^{\\top} W$ 的第 $j$ 个分量相同。因此，我们有恒等式 $\\mathbf{u}^{\\top} W U = (\\mathbf{u}^{\\circ 2})^{\\top} W$。\n我们定义两个二次型：\n$$\nT_1 = (\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} \\qquad \\text{and} \\qquad T_2 = \\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2})\n$$\n如此，能量变化率为 $\\frac{dE}{dt} = -(\\alpha T_1 + \\frac{\\beta}{2} T_2)$。\n\n分部求和 (SBP) 性质 $W D + D^{\\top} W = B$ 提供了一个离散分部积分公式。对任意向量 $\\mathbf{v}$ 和 $\\mathbf{z}$：\n$$\n\\mathbf{v}^{\\top} W D \\mathbf{z} + (D\\mathbf{v})^{\\top} W \\mathbf{z} = \\mathbf{v}^{\\top} B \\mathbf{z}\n$$\n令 $\\mathbf{v} = \\mathbf{u}^{\\circ 2}$ 和 $\\mathbf{z} = \\mathbf{u}$。SBP 公式给出：\n$$\n(\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} + (D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\n左边的第二项是 $(D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = \\mathbf{u}^{\\top} W (D(\\mathbf{u}^{\\circ 2})) = T_2$。第一项是 $T_1$。所以，我们有关系式：\n$$\nT_1 + T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\n右边的项是边界项。对于全局周期性网格，所有单元上的这些边界项之和为零。\n\n我们现在用 $T_1$ 和边界项来表示能量变化率。根据 SBP 关系，我们有 $T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1$。将其代入 $\\frac{dE}{dt}$ 的表达式中：\n$$\n\\frac{dE}{dt} = -\\left[ \\alpha T_1 + \\frac{\\beta}{2} \\left( (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1 \\right) \\right] = -\\left[ \\left(\\alpha - \\frac{\\beta}{2}\\right)T_1 + \\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} \\right]\n$$\n周期性域上的总能量变化是这些单元贡献的总和。所有单元上的边界项 $\\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}$ 的总和为零。然而，项 $T_1$ 通常不为零，且其在所有单元上的总和不消失。因此，为了使总能量对任意 $\\mathbf{u}$ 都守恒，$T_1$ 的系数必须为零：\n$$\n\\alpha - \\frac{\\beta}{2} = 0 \\implies 2\\alpha = \\beta\n$$\n为了使分裂形式离散化与原始对流项 $\\mathcal{C}(u)$ 保持一致，系数之和必须为1，因为 $U D \\mathbf{u}$ 和 $D(\\frac{1}{2}\\mathbf{u}^{\\circ 2})$ 都是 $\\mathcal{C}(u)$ 的一致离散化：\n$$\n\\alpha + \\beta = 1\n$$\n解这个二元线性方程组：\n$$\n\\alpha + 2\\alpha = 1 \\implies 3\\alpha = 1 \\implies \\alpha = \\frac{1}{3}\n$$\n$$\n\\beta = 2\\alpha = \\frac{2}{3}\n$$\n得到的能量守恒或斜对称的分裂形式是：\n$$\ns_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{2}{3} D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})\n$$\n\n### 任务2：节点向量的计算\n给定 $u(x) = 1+x^2$ 和 GLL 节点 $x_0=-1, x_1=0, x_2=1$。$u(x)$ 的节点值为：\n$u_0 = u(-1) = 1+(-1)^2 = 2$\n$u_1 = u(0) = 1+0^2 = 1$\n$u_2 = u(1) = 1+1^2 = 2$\n节点向量为 $\\mathbf{u} = \\begin{pmatrix} 2 & 1 & 2 \\end{pmatrix}^{\\top}$。\n\n精确强形式对流导数为 $s_{\\mathrm{exact},i} = u(x_i) \\frac{du}{dx}(x_i)$。由于 $\\frac{du}{dx} = 2x$：\n$s_{\\mathrm{exact},0} = u(-1) \\cdot (2(-1)) = 2 \\cdot (-2) = -4$\n$s_{\\mathrm{exact},1} = u(0) \\cdot (2(0)) = 1 \\cdot 0 = 0$\n$s_{\\mathrm{exact},2} = u(1) \\cdot (2(1)) = 2 \\cdot 2 = 4$\n所以，$\\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -4 & 0 & 4 \\end{pmatrix}^{\\top}$。\n\n守恒形式为 $s_{\\mathrm{cons}} = D(\\frac{1}{2} \\mathbf{u}^{\\circ 2})$。节点值平方的向量为 $\\mathbf{u}^{\\circ 2} = \\begin{pmatrix} 2^2 & 1^2 & 2^2 \\end{pmatrix}^{\\top} = \\begin{pmatrix} 4 & 1 & 4 \\end{pmatrix}^{\\top}$。\n$$\n\\mathbf{s}_{\\mathrm{cons}} = \\frac{1}{2} D \\mathbf{u}^{\\circ 2} = \\frac{1}{2} \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 1 \\\\ 4 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6+2-2 \\\\ -2+0+2 \\\\ 2-2+6 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix}\n$$\n\n斜对称形式为 $s_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})$。首先，我们计算 $D\\mathbf{u}$：\n$$\nD\\mathbf{u} = \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -3+2-1 \\\\ -1+0+1 \\\\ 1-2+3 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix}\n$$\n矩阵 $U$ 是 $\\mathrm{diag}(2,1,2)$。所以，$UD\\mathbf{u} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix}$。我们已经计算出 $D(\\mathbf{u}^{\\circ 2}) = \\begin{pmatrix} -6 & 0 & 6 \\end{pmatrix}^{\\top}$。\n$$\n\\mathbf{s}_{\\mathrm{skew}} = \\frac{1}{3} \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} + \\frac{1}{3} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -10 \\\\ 0 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix}\n$$\n\n### 任务3：误差比率的计算\n首先，我们计算误差向量。\n$$\n\\mathbf{e}_{\\mathrm{cons}} = \\mathbf{s}_{\\mathrm{cons}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\mathrm{skew}} = \\mathbf{s}_{\\mathrm{skew}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} + \\frac{12}{3} \\\\ 0 \\\\ \\frac{10}{3} - \\frac{12}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ 0 \\\\ -\\frac{2}{3} \\end{pmatrix}\n$$\n接下来，我们计算加权平方范数。权重为 $w_0=\\frac{1}{3}, w_1=\\frac{4}{3}, w_2=\\frac{1}{3}$。\n$$\n\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{cons},i}^2 = \\frac{1}{3}(1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(-1)^2 = \\frac{1}{3} + 0 + \\frac{1}{3} = \\frac{2}{3}\n$$\n$$\n\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{skew},i}^2 = \\frac{1}{3}\\left(\\frac{2}{3}\\right)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}\\left(-\\frac{2}{3}\\right)^2 = \\frac{1}{3}\\left(\\frac{4}{9}\\right) + 0 + \\frac{1}{3}\\left(\\frac{4}{9}\\right) = \\frac{4}{27} + \\frac{4}{27} = \\frac{8}{27}\n$$\n最后，我们计算比率 $r$：\n$$\nr = \\frac{\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2}}{\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2}} = \\frac{\\frac{2}{3}}{\\frac{8}{27}} = \\frac{2}{3} \\times \\frac{27}{8} = \\frac{2 \\times 27}{3 \\times 8} = \\frac{54}{24} = \\frac{9 \\times 6}{4 \\times 6} = \\frac{9}{4}\n$$\n换算成小数是 $2.25$。题目要求提供一个精确数。", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "3376460"}, {"introduction": "接下来，我们从单元内部转向单元界面。DG方法依赖于数值通量（如Roe格式）来处理间断并耦合相邻单元。本练习 [@problem_id:3376511] 首先要求您推导著名的Roe线性化，这是构建近似Riemann求解器的基石。更重要的是，本练习将处理一个在高马赫数流动中至关重要的问题：高阶方法可能产生非物理状态（如负密度 $\\rho$ 或负压力 $p$），您将练习设计一个“保正限制器”来修正解，同时保持其守恒性。", "problem": "考虑守恒形式的一维可压缩欧拉方程，其状态向量为 $\\,\\boldsymbol{q} = (\\rho,\\,\\rho u,\\,E)^{\\top}\\,$，通量为 $\\,\\boldsymbol{f}(\\boldsymbol{q}) = \\big(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\big)^{\\top}\\,$，以及理想气体状态方程 $\\,p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)\\,$，其中常比热比 $\\,\\gamma > 1\\,$。\n\nA部分（推导）：从上述守恒形式和理想气体热力学出发，推导可压缩欧拉通量在流动方向上单位法向界面上的Roe线性化，即确定一个常雅可比矩阵 $\\,\\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{L}},\\boldsymbol{q}_{\\mathrm{R}})\\,$ 使得 $\\,\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})\\,$。您的推导必须确定Roe平均量 $\\,\\tilde{u}\\,$ 和 $\\,\\tilde{H}\\,$、Roe声速 $\\,\\tilde{a}\\,$，以及 $\\,\\tilde{\\boldsymbol{A}}\\,$ 的特征值，并用左右状态表示。请勿直接引用结果；需从Roe线性化的定义性质和理想气体关系式出发进行推导。\n\nB部分（间断Galerkin方法中的正定性修正）：在用于高马赫数流动的间断Galerkin（DG）格式中，密度和压力在求积点处必须保持为正，以避免双曲性的丧失和非物理状态的出现。请从守恒和凸性的第一性原理出发，解释如何通过重新缩放多项式与单元平均值的偏差来构造一个保正限制器。具体来说，考虑一个单元上的节点DG表示，该单元有两个权重相等的求积节点 $\\,\\tfrac{1}{2}\\,$ 和守恒节点状态 $\\,\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}\\,$ 和 $\\,\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}\\,$，其中 $\\,m=\\rho u\\,$。单元平均值为 $\\,\\bar{\\boldsymbol{U}}=\\tfrac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$。保正重缩放产生受限的节点状态 $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta\\big(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}}\\big)\\,$，其中 $\\,\\theta \\in [0,1]\\,$ 的选择应是最小的，以使得在节点 $\\,1\\,$ 处 $\\,\\rho(\\theta) > 0\\,$ 和 $\\,p(\\theta) \\ge 0\\,$ 均成立，其中 $\\,\\rho(\\theta)\\,$、$\\,m(\\theta)\\,$ 和 $\\,E(\\theta)\\,$ 是 $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}}\\,$ 的分量，且 $\\,p(\\theta)=(\\gamma-1)\\!\\left(E(\\theta)-\\tfrac{1}{2}\\tfrac{m(\\theta)^{2}}{\\rho(\\theta)}\\right)\\,$。推导由 $\\,p(\\theta)=0\\,$ 隐含的关于 $\\,\\theta\\,$ 的标量非线性条件，并将其简化为一个二次方程。请精确说明如何在约束 $\\,\\theta \\in [0,1]\\,$ 下，从该二次方程的根中选择最小的允许值 $\\,\\theta\\,$。\n\n具体计算：取 $\\,\\gamma=1.4\\,$ 和两个节点状态\n- $\\,\\boldsymbol{U}_{1} = (\\rho_{1},m_{1},E_{1})^{\\top} = (\\,0.05,\\,2.0,\\,39.75\\,)^{\\top}\\,$，\n- $\\,\\boldsymbol{U}_{2} = (\\rho_{2},m_{2},E_{2})^{\\top} = (\\,0.8,\\,4.0,\\,12.5\\,)^{\\top}\\,$，\n使得 $\\,\\bar{\\boldsymbol{U}} = \\tfrac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$。计算最小的 $\\,\\theta \\in [0,1]\\,$，使得节点 $\\,1\\,$ 处的受限状态满足 $\\,p(\\theta)=0\\,$（为此计算，取压力下限为 $\\,0\\,$）。将您的答案 $\\,\\theta\\,$ 四舍五入到四位有效数字。您提交的最终答案必须仅为 $\\,\\theta\\,$ 的数值，该值是无量纲的。", "solution": "用户提供了一个关于可压缩欧拉方程的两部分问题。我将首先验证问题陈述，然后提供一个完整的解决方案。\n\n## 问题验证\n\n### 步骤1：提取已知条件\n\n**A部分（推导）：**\n-   方程组：守恒形式的一维可压缩欧拉方程。\n-   状态向量：$\\boldsymbol{q} = (\\rho, \\rho u, E)^{\\top}$。\n-   通量向量：$\\boldsymbol{f}(\\boldsymbol{q}) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$。\n-   状态方程：理想气体，$p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$，具有常数 $\\gamma > 1$。\n-   任务：推导满足 $\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})$ 的Roe线性化 $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$。\n-   要求输出：Roe平均量 $\\tilde{u}$ 和 $\\tilde{H}$、Roe声速 $\\tilde{a}$ 以及 $\\tilde{\\boldsymbol{A}}$ 的特征值的表达式。推导必须从第一性原理出发。\n\n**B部分（保正限制器）：**\n-   背景：节点间断Galerkin（DG）方法，一个单元，两个求积节点。\n-   求积权重：相等，为 $\\frac{1}{2}$。\n-   节点状态：$\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}$ 和 $\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}$，其中 $m=\\rho u$。\n-   单元平均值：$\\bar{\\boldsymbol{U}}=\\frac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})$。\n-   节点1处的受限状态：$\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$，其中 $\\theta \\in [0,1]$。\n-   正定性约束：在节点1处 $\\rho(\\theta) > 0$ 和 $p(\\theta) \\ge 0$，其中 $p(\\theta)=(\\gamma-1)(E(\\theta)-\\frac{1}{2}\\frac{m(\\theta)^{2}}{\\rho(\\theta)})$。\n-   任务1（推导）：从 $p(\\theta)=0$ 推导关于 $\\theta$ 的标量非线性条件，将其简化为二次方程，并解释如何选择最小的允许值 $\\theta \\in [0,1]$。\n-   任务2（计算）：对于 $\\gamma=1.4$ 和给定的节点状态 $\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$ 和 $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$，计算使 $p(\\theta)=0$ 的最小 $\\theta \\in [0,1]$。\n-   最终答案要求：将 $\\theta$ 的数值四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n\n1.  **科学依据：** 该问题涉及欧拉方程、理想气体定律、Roe线性化和保正限制器。这些都是计算流体动力学（CFD）和应用数学中的标准、成熟的概念。该问题具有科学合理性。\n2.  **良态的：**\n    -   A部分是一个标准的推导任务，其结果唯一且广为人知。所有必要的定义都已提供。\n    -   B部分提出了一个清晰的限制解的过程。它指定了受限状态的形式以及它必须满足的条件。给定的数值导致了一种需要此类限制器的情况（节点处压力为负），这使得问题有意义。它要求解一个参数 $\\theta$，且推导过程会得到一个可解的二次方程。该问题是良态的。\n3.  **客观性：** 该问题以精确的数学和物理术语陈述，没有歧义或主观性。\n\n### 步骤3：结论和行动\n\n该问题是**有效的**。它具有科学依据，是良态的、客观的，并包含所有必要的信息。我现在将开始解答。\n\n## A部分：Roe线性化的推导\n\nRoe线性化要求找到一个矩阵 $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$ 使得跨越间断的通量差满足\n$$ \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}}) $$\n令 $\\Delta(\\cdot)$ 表示跳跃 $(\\cdot)_{\\mathrm{R}} - (\\cdot)_{\\mathrm{L}}$。条件是 $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$。\nRoe矩阵 $\\tilde{\\boldsymbol{A}}$ 与真实的通量雅可比矩阵 $\\boldsymbol{A}(\\boldsymbol{q}) = \\frac{\\partial\\boldsymbol{f}}{\\partial\\boldsymbol{q}}$ 具有相同的结构，但它是在一个特殊的“Roe平均”状态下进行求值的。欧拉通量的雅可比矩阵为：\n$$ \\boldsymbol{A}(\\boldsymbol{q}) = \\begin{pmatrix} 0 & 1 & 0 \\\\ \\frac{\\gamma-3}{2}u^2 & (3-\\gamma)u & \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2-H\\right) & H - (\\gamma-1)u^2 & \\gamma u \\end{pmatrix} $$\n其中 $H = (E+p)/\\rho$ 是比总焓。Roe矩阵 $\\tilde{\\boldsymbol{A}}$ 是通过将 $u$ 和 $H$ 替换为它们的Roe平均值 $\\tilde{u}$ 和 $\\tilde{H}$ 得到的：\n$$ \\tilde{\\boldsymbol{A}} = \\begin{pmatrix} 0 & 1 & 0 \\\\ \\frac{\\gamma-3}{2}\\tilde{u}^2 & (3-\\gamma)\\tilde{u} & \\gamma-1 \\\\ \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}\\right) & \\tilde{H} - (\\gamma-1)\\tilde{u}^2 & \\gamma \\tilde{u} \\end{pmatrix} $$\nRoe平均量的定义如下：\n$$ \\tilde{\\rho} = \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}} $$\n$$ \\tilde{u} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}u_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}u_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\n$$ \\tilde{H} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}H_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}H_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\n推导过程在于证明，使用这些定义，性质 $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ 精确成立。这一验证依赖于Roe平均量满足的几个恒等式。令 $S_{\\mathrm{L}}=\\sqrt{\\rho_{\\mathrm{L}}}$ 和 $S_{\\mathrm{R}}=\\sqrt{\\rho_{\\mathrm{R}}}$。\n\n**关键恒等式：**\n一组关键的恒等式利用Roe平均量将守恒量的跳跃与原始变量的跳跃联系起来。\n1.  $\\Delta(\\rho u) = \\rho_{\\mathrm{R}}u_{\\mathrm{R}} - \\rho_{\\mathrm{L}}u_{\\mathrm{L}} = S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}$。\n    直接的代数运算表明：$\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\tilde{u}(\\rho_{\\mathrm{R}}-\\rho_{\\mathrm{L}}) + \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}}(u_{\\mathrm{R}}-u_{\\mathrm{L}}) = \\Delta(\\rho u)$。\n2.  $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho$。\n    证明：$2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho = \\tilde{u}(2\\Delta(\\rho u) - \\tilde{u}\\Delta\\rho)$。括号中的项变为\n    $2(S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}) - \\frac{S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}}}{S_{\\mathrm{L}}+S_{\\mathrm{R}}}(S_{\\mathrm{R}}^2-S_{\\mathrm{L}}^2) = (S_{\\mathrm{L}}+S_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}})$。\n    乘以 $\\tilde{u}$ 得到 $(S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}}) = S_{\\mathrm{R}}^2 u_{\\mathrm{R}}^2 - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}^2 = \\Delta(\\rho u^2)$。\n3.  $\\Delta(\\rho uH) = \\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho$。这可以通过类似（尽管更冗长）的代数步骤来证明。\n\n**Roe性质的验证：** 我们逐行检查 $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$。\n$\\Delta\\boldsymbol{q} = (\\Delta\\rho, \\Delta(\\rho u), \\Delta E)^{\\top} = (\\Delta q_1, \\Delta q_2, \\Delta q_3)^{\\top}$。\n$\\Delta\\boldsymbol{f} = (\\Delta(\\rho u), \\Delta(\\rho u^2+p), \\Delta(u(E+p)))^{\\top} = (\\Delta f_1, \\Delta f_2, \\Delta f_3)^{\\top}$。\n\n*   **第1行：** $\\Delta f_1 = \\Delta(\\rho u) = \\Delta q_2$。\n    $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ 的第一行是 $0 \\cdot \\Delta q_1 + 1 \\cdot \\Delta q_2 + 0 \\cdot \\Delta q_3 = \\Delta q_2$。这是正确的。\n\n*   **第2行：** $\\Delta f_2 = \\Delta(\\rho u^2+p) = \\Delta(\\rho u^2) + \\Delta p$。\n    使用 $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$，我们有 $\\Delta p = (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2))$。\n    所以，$\\Delta f_2 = \\Delta(\\rho u^2) + (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2)) = \\frac{3-\\gamma}{2}\\Delta(\\rho u^2) + (\\gamma-1)\\Delta E$。\n    $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ 的第二行是 $\\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta q_1 + (3-\\gamma)\\tilde{u} \\Delta q_2 + (\\gamma-1) \\Delta q_3$。\n    将 $\\Delta f_2$ 的两个表达式相等，我们必须验证：\n    $\\frac{3-\\gamma}{2}\\Delta(\\rho u^2) = \\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta\\rho + (3-\\gamma)\\tilde{u}\\Delta(\\rho u)$。\n    除以 $\\frac{3-\\gamma}{2}$，这正是恒等式2：$\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$。这是正确的。\n\n*   **第3行：** $\\Delta f_3 = \\Delta(u(E+p)) = \\Delta(\\rho u H)$。\n    $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ 的第三行是 $\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\Delta E$。\n    让我们重新整理这个表达式。从压力关系式，$\\Delta p = \\frac{\\gamma-1}{\\gamma}\\Delta(\\rho(H-u^2/2)) = \\frac{\\gamma-1}{\\gamma}(\\Delta(\\rho H)-\\frac{1}{2}\\Delta(\\rho u^2))$。\n    同时，$\\Delta E = \\frac{\\Delta p}{\\gamma-1} + \\frac{1}{2}\\Delta(\\rho u^2) = \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2)$。\n    将此代入第三行的表达式中：\n    $\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\left( \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2) \\right)$\n    $= \\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\tilde{u}\\Delta(\\rho H) + \\frac{\\gamma-1}{2}\\tilde{u}\\Delta(\\rho u^2)$。\n    使用恒等式2，$\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$：\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho\\left[\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}) - \\frac{\\gamma-1}{2}\\tilde{u}^3\\right] + \\Delta(\\rho u)\\left[\\tilde{H} - (\\gamma-1)\\tilde{u}^2 + (\\gamma-1)\\tilde{u}^2\\right]$\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho[-\\tilde{u}\\tilde{H}] + \\Delta(\\rho u)[\\tilde{H}]$。\n    这正是恒等式3：$\\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho = \\Delta(\\rho u H)$。这是正确的。\n\n**特征值：**\nRoe矩阵 $\\tilde{\\boldsymbol{A}}$ 的特征值是通过与真实雅可比矩阵 $\\boldsymbol{A}(\\boldsymbol{q})$ 的特征值 $\\lambda_1=u-a$, $\\lambda_2=u$, $\\lambda_3=u+a$ 类比得到的，其中 $a=\\sqrt{\\gamma p/\\rho}$ 是声速。将变量替换为它们的Roe平均对应量，即可得到 $\\tilde{\\boldsymbol{A}}$ 的特征值：\n$$ \\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a} $$\nRoe平均声速 $\\tilde{a}$ 定义为\n$$ \\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right) $$\n这个表达式源于要求 $\\tilde{a}^2 = \\gamma\\tilde{p}/\\tilde{\\rho}$，可以证明这与其他定义是一致的。Roe平均过程保证了如果状态L和R具有正的压力和密度，则 $\\tilde{a}^2 > 0$，从而确保了线性化系统的双曲性。\n\n## B部分：保正限制器\n\n该问题要求推导一个关于缩放因子 $\\theta$ 的条件以强制压力为正，然后在一个具体案例中计算这个因子。\n\n**二次方程的推导：**\n节点1处的受限状态由 $\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$ 给出，其中 $\\theta \\in [0,1]$。这可以写成一个凸组合：$\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (1-\\theta)\\bar{\\boldsymbol{U}} + \\theta\\boldsymbol{U}_{1}$。\n受限状态向量 $\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (\\rho(\\theta), m(\\theta), E(\\theta))^{\\top}$ 的分量是：\n$$ \\rho(\\theta) = (1-\\theta)\\bar{\\rho} + \\theta\\rho_{1} $$\n$$ m(\\theta) = (1-\\theta)\\bar{m} + \\theta m_{1} $$\n$$ E(\\theta) = (1-\\theta)\\bar{E} + \\theta E_{1} $$\n压力正定性约束是 $p(\\theta) \\ge 0$，其中 $p(\\theta) = (\\gamma-1)(E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)})$。我们令 $p(\\theta)=0$ 来找到允许区域的边界。由于 $\\gamma > 1$，这要求\n$$ E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)} = 0 $$\n假设 $\\rho(\\theta)>0$，这等价于 $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$。\n代入 $\\rho(\\theta), m(\\theta), E(\\theta)$ 的表达式：\n$$ 2 \\left((1-\\theta)\\bar{E} + \\theta E_{1}\\right) \\left((1-\\theta)\\bar{\\rho} + \\theta\\rho_{1}\\right) - \\left((1-\\theta)\\bar{m} + \\theta m_{1}\\right)^2 = 0 $$\n这是一个关于 $\\theta$ 的二次方程。让我们按 $\\theta$ 的幂次展开它：\n$$ (1-\\theta)^2 [2\\bar{E}\\bar{\\rho} - \\bar{m}^2] + \\theta(1-\\theta)[2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1] + \\theta^2[2E_1\\rho_1 - m_1^2] = 0 $$\n令 $C_0 = 2\\bar{E}\\bar{\\rho} - \\bar{m}^2$, $C_1 = 2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1$，以及 $C_2 = 2E_1\\rho_1 - m_1^2$。方程为：\n$$ (1-2\\theta+\\theta^2)C_0 + (\\theta-\\theta^2)C_1 + \\theta^2 C_2 = 0 $$\n整理成标准形式 $A\\theta^2 + B\\theta + C = 0$：\n$$ \\theta^2(C_0 - C_1 + C_2) + \\theta(-2C_0 + C_1) + C_0 = 0 $$\n因此，$A=C_0 - C_1 + C_2$，$B=-2C_0 + C_1$，以及 $C=C_0$。\n\n**$\\theta$ 的选择：**\n系数 $C=C_0$ 与单元平均状态 $\\bar{\\boldsymbol{U}}$ 的压力分子成正比。假设单元平均值具有正压力，因此 $C_0 > 0$。该二次函数在 $\\theta=1$ 处的值是 $A(1)^2+B(1)+C = C_2$，它与原始节点状态 $\\boldsymbol{U}_1$ 的压力分子成正比。调用限制程序是因为此压力为负，所以 $C_2 < 0$。\n一个在 $\\theta=0$ 处为正、在 $\\theta=1$ 处为负的连续函数，在区间 $(0,1)$ 内必须至少有一个根。\n允许状态的集合（具有正密度和正压力）是凸的。对于 $\\theta \\in [0,1]$，$\\boldsymbol{U}_1^{\\text{lim}}(\\theta)$ 的轨迹是从允许状态 $\\bar{\\boldsymbol{U}}$ 到非物理状态 $\\boldsymbol{U}_1$ 的一条直线。这条线必须在 $(0,1)$ 内精确地穿过允许集边界一次。因此，该二次方程在 $(0,1)$ 内有一个唯一的根 $\\theta_p$。\n$p(\\theta) \\ge 0$ 的区域是区间 $[0, \\theta_p]$。问题要求满足 $p(\\theta)=0$ 的最小 $\\theta \\in [0,1]$。这正是根 $\\theta_p$。\n\n**具体计算：**\n给定 $\\gamma=1.4$，$\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$，和 $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$。\n首先，计算单元平均值 $\\bar{\\boldsymbol{U}}$：\n$$ \\bar{\\rho} = \\frac{0.05+0.8}{2} = 0.425 $$\n$$ \\bar{m} = \\frac{2.0+4.0}{2} = 3.0 $$\n$$ \\bar{E} = \\frac{39.75+12.5}{2} = 26.125 $$\n所以 $\\bar{\\boldsymbol{U}} = (0.425, 3.0, 26.125)^{\\top}$。\n节点1的状态需要限制，因为其压力为负：$p_1 = (1.4-1)(39.75 - \\frac{2.0^2}{2 \\times 0.05}) = 0.4(39.75 - 40) = -0.1$。\n状态被修改为 $\\boldsymbol{U}_1^{\\text{lim}}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_1 - \\bar{\\boldsymbol{U}})$。分量是：\n$$ \\rho(\\theta) = 0.425 + \\theta(0.05 - 0.425) = 0.425 - 0.375\\theta $$\n$$ m(\\theta) = 3.0 + \\theta(2.0 - 3.0) = 3.0 - \\theta $$\n$$ E(\\theta) = 26.125 + \\theta(39.75 - 26.125) = 26.125 + 13.625\\theta $$\n条件 $p(\\theta)=0$ 导致 $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$。\n$$ 2(26.125 + 13.625\\theta)(0.425 - 0.375\\theta) - (3.0 - \\theta)^2 = 0 $$\n展开各项：\n$2(26.125 \\times 0.425 - 26.125 \\times 0.375\\theta + 13.625 \\times 0.425\\theta - 13.625 \\times 0.375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 9.796875\\theta + 5.790625\\theta - 5.109375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 4.00625\\theta - 5.109375\\theta^2) - 9 + 6\\theta - \\theta^2 = 0$\n$22.20625 - 8.0125\\theta - 10.21875\\theta^2 - 9 + 6\\theta - \\theta^2 = 0$\n收集关于 $\\theta$ 的二次方程的各项：\n$$ (-10.21875 - 1)\\theta^2 + (-8.0125 + 6)\\theta + (22.20625 - 9) = 0 $$\n$$ -11.21875\\theta^2 - 2.0125\\theta + 13.20625 = 0 $$\n乘以-1：\n$$ 11.21875\\theta^2 + 2.0125\\theta - 13.20625 = 0 $$\n我们使用二次公式 $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解 $\\theta$：\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{2.0125^2 - 4(11.21875)(-13.20625)}}{2(11.21875)} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{4.05015625 + 592.6546875}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{596.70484375}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm 24.42754274}{22.4375} $$\n我们寻找在 $[0,1]$ 内的根。正解是：\n$$ \\theta = \\frac{-2.0125 + 24.42754274}{22.4375} = \\frac{22.41504274}{22.4375} \\approx 0.999000... $$\n另一个根是负的（$\\approx -1.178$）且没有物理意义。\n四舍五入到四位有效数字，我们得到 $\\theta = 0.9990$。", "answer": "$$\n\\boxed{0.9990}\n$$", "id": "3376511"}, {"introduction": "最后，我们将前面的概念应用于求解完整的可压缩Navier-Stokes方程，这类方程通常是“刚性”的，需要高效的隐式时间步进方法。本练习 [@problem_id:3376455] 专注于推导对流和粘性通量的雅可比矩阵，它们是为隐式方法（如Newton-Krylov方法）中求解的大型线性系统提供基础。这项实践对于理解和实现求解刚性问题所需的高性能隐式DG求解器至关重要。", "problem": "考虑理想气体的二维可压缩纳维–斯托克斯方程的守恒形式，其比热容比 $ \\gamma $、特定气体常数 $ R $、动力粘度 $ \\mu $ 和热导率 $ \\kappa $ 均为常数。守恒状态为 $ U = [ \\rho, \\rho u, \\rho v, \\rho E ]^{\\top} $，其中 $ \\rho $ 是密度，$ u $ 和 $ v $ 是速度分量，$ E $ 是总比能。压力由 $ p = (\\gamma - 1)\\left( \\rho E - \\tfrac{1}{2}\\rho (u^{2} + v^{2}) \\right) $ 给出，其中 $ H = E + \\tfrac{p}{\\rho} $ 是总比焓。$ x $ 方向的对流通量为 $ F^{c}_{x}(U) = [ \\rho u,\\ \\rho u^{2} + p,\\ \\rho u v,\\ u(\\rho E + p) ]^{\\top} $，$ y $ 方向的通量形式与此类似。粘性应力张量使用牛顿流体和 Stokes 假设，$ \\tau = \\mu \\left( \\nabla \\mathbf{v} + \\nabla \\mathbf{v}^{\\top} - \\tfrac{2}{3}(\\nabla \\cdot \\mathbf{v}) I \\right) $，其中 $ \\mathbf{v} = (u,v) $，热通量为 $ \\mathbf{q} = - \\kappa \\nabla T $。温度为 $ T = \\tfrac{p}{\\rho R} = \\tfrac{\\gamma - 1}{R}\\left( E - \\tfrac{1}{2}(u^{2} + v^{2}) \\right) $。设 $ \\mathbf{n} = (n_{x}, n_{y}) $ 为单位法向量。\n\n- 仅使用这些定义和关系，推导法向对流通量雅可比矩阵 $ A^{c}_{n}(U) = \\dfrac{\\partial}{\\partial U}\\big( F^{c}(U) \\cdot \\mathbf{n} \\big) \\in \\mathbb{R}^{4 \\times 4} $，其中 $ F^{c}(U) \\cdot \\mathbf{n} = n_{x} F^{c}_{x}(U) + n_{y} F^{c}_{y}(U) $。\n\n- 推导法向粘性通量关于状态梯度的雅可比矩阵 $ K^{v}_{n}(U) = \\dfrac{\\partial}{\\partial (\\nabla U)}\\big( F^{v}(U, \\nabla U) \\cdot \\mathbf{n} \\big) $，它被视为一个 $ 4 \\times 8 $ 矩阵，在固定状态 $ U $ 下，将堆叠的梯度向量 $ [ \\partial_{x}\\rho,\\ \\partial_{x}(\\rho u),\\ \\partial_{x}(\\rho v),\\ \\partial_{x}(\\rho E),\\ \\partial_{y}\\rho,\\ \\partial_{y}(\\rho u),\\ \\partial_{y}(\\rho v),\\ \\partial_{y}(\\rho E) ]^{\\top} $ 映射到 $ F^{v} \\cdot \\mathbf{n} $。用 $ \\rho, u, v, E, \\gamma, R, \\mu, \\kappa, n_{x}, n_{y} $ 显式地写出 $ K^{v}_{n}(U) $ 的元素。\n\n- 用一段话解释，在隐式向后欧拉时间离散化下，$ A^{c}_{n}(U) $ 和 $ K^{v}_{n}(U) $ 如何用于构成半离散间断伽辽金残差雅可比矩阵的单元局部贡献和面贡献，以及这个雅可比矩阵如何在牛顿–克雷洛夫方法（无矩阵作用）中被应用，包括数值通量在界面处的作用。\n\n最后，考虑均匀状态 $ \\rho = 1.18\\ \\mathrm{kg/m^{3}} $，$ u = 210\\ \\mathrm{m/s} $，$ v = -35\\ \\mathrm{m/s} $，$ p = 101325\\ \\mathrm{Pa} $，以及 $ \\gamma = 1.4 $ 和单位法向量 $ \\mathbf{n} = (0.6, 0.8) $。计算在此状态下 $ A^{c}_{n}(U) $ 的谱半径，即 $ \\rho(A^{c}_{n}) = |u_{n}| + a $，其中 $ u_{n} = u n_{x} + v n_{y} $，声速 $ a = \\sqrt{\\gamma p / \\rho} $。用 $ \\mathrm{m/s} $ 表示你的最终数值答案，并四舍五入到四位有效数字。", "solution": "该问题要求进行几项与可压缩纳维–斯托克斯方程雅可比矩阵相关的推导，解释它们在间断伽辽金（DG）方法中的应用，并进行一次数值计算。该问题具有科学依据、是适定的、客观的，并包含了得到唯一解所需的所有信息。\n\n首先，我们推导法向对流雅可比矩阵 $ A^{c}_{n}(U) = \\dfrac{\\partial}{\\partial U}\\big( F^{c}(U) \\cdot \\mathbf{n} \\big) $。\n设状态向量为 $ U = [U_{1}, U_{2}, U_{3}, U_{4}]^{\\top} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top} $。原始变量可以用守恒变量表示：$ \\rho = U_{1} $，$ u=U_{2}/U_{1} $，$ v=U_{3}/U_{1} $ 以及 $ E=U_{4}/U_{1} $。压力 $ p $ 由下式给出\n$$ p = (\\gamma - 1)\\left( \\rho E - \\tfrac{1}{2}\\rho (u^{2} + v^{2}) \\right) = (\\gamma - 1)\\left( U_{4} - \\frac{U_{2}^{2} + U_{3}^{2}}{2U_{1}} \\right) $$\n法向对流通量为 $ F^{c}_{n} = n_{x} F^{c}_{x} + n_{y} F^{c}_{y} $。设 $ u_{n} = u n_{x} + v n_{y} $。\n$$ F^{c}_{n}(U) = \\begin{pmatrix} \\rho u_{n} \\\\ \\rho u u_{n} + p n_{x} \\\\ \\rho v u_{n} + p n_{y} \\\\ (\\rho E + p) u_{n} \\end{pmatrix} $$\n雅可比矩阵 $ A^{c}_{n} $ 是一个 $ 4 \\times 4 $ 矩阵，其元素为 $ (A^{c}_{n})_{ij} = \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial U_{j}} $。推导过程通过应用链式法则来完成，例如，$ \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial U_{j}} = \\sum_{k=1}^{4} \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial W_{k}} \\dfrac{\\partial W_{k}}{\\partial U_{j}} $，其中 $ W=[\\rho, u, v, p]^{\\top} $ 是一组原始变量。所需的偏导数是：\n$ \\dfrac{\\partial u}{\\partial U} = [-\\frac{u}{\\rho}, \\frac{1}{\\rho}, 0, 0] $，$ \\dfrac{\\partial v}{\\partial U} = [-\\frac{v}{\\rho}, 0, \\frac{1}{\\rho}, 0] $，以及 $ \\dfrac{\\partial p}{\\partial U} = [(\\gamma-1)\\frac{u^{2}+v^{2}}{2}, -(\\gamma-1)u, -(\\gamma-1)v, \\gamma-1] $。\n让我们定义 $ \\phi^{2} = \\frac{\\gamma-1}{2}(u^{2}+v^{2}) $ 和总比焓 $ H = E + \\frac{p}{\\rho} $。完成微分运算后，得到的雅可比矩阵是：\n$$ A^{c}_{n}(U) = \\begin{pmatrix}\n0 & n_{x} & n_{y} & 0 \\\\\nn_{x}(\\phi^{2}-u^{2}) - n_{y}uv & u_{n} + (2-\\gamma)u n_{x} & u n_{y} - (\\gamma-1)v n_{x} & (\\gamma-1)n_{x} \\\\\nn_{y}(\\phi^{2}-v^{2}) - n_{x}uv & v n_{x} - (\\gamma-1)u n_{y} & u_{n} + (2-\\gamma)v n_{y} & (\\gamma-1)n_{y} \\\\\nu_{n}(\\phi^{2}-H) & H n_{x} - (\\gamma-1)u u_{n} & H n_{y} - (\\gamma-1)v u_{n} & \\gamma u_{n}\n\\end{pmatrix} $$\n\n其次，我们推导法向粘性通量关于状态梯度的雅可比矩阵 $ K^{v}_{n}(U) = \\dfrac{\\partial}{\\partial (\\nabla U)}\\big( F^{v}(U, \\nabla U) \\cdot \\mathbf{n} \\big) $。\n法向粘性通量为 $ F^{v}_{n} = n_{x} F^{v}_{x} + n_{y} F^{v}_{y} $。使用粘性应力张量 $ \\tau $ 和热通量 $ \\mathbf{q} $ 的定义，我们有：\n$$ F^{v}_{n} = \\begin{pmatrix} 0 \\\\ n_{x}\\tau_{xx} + n_{y}\\tau_{yx} \\\\ n_{x}\\tau_{xy} + n_{y}\\tau_{yy} \\\\ u(n_{x}\\tau_{xx} + n_{y}\\tau_{yx}) + v(n_{x}\\tau_{xy} + n_{y}\\tau_{yy}) - (n_{x}q_{x} + n_{y}q_{y}) \\end{pmatrix} $$\n粘性通量对于原始变量（速度分量 $ u, v $ 和温度 $ T $）的梯度是线性的。这些梯度必须用守恒状态的梯度 $ \\nabla U $ 来表示。对于一个固定的状态 $ U $，这种关系是线性的。例如，$ \\partial_{x} u = \\frac{1}{\\rho}\\partial_{x}(\\rho u) - \\frac{u}{\\rho}\\partial_{x}\\rho = \\frac{1}{U_{1}}\\partial_{x}U_{2} - \\frac{u}{U_{1}}\\partial_{x}U_{1} $。对于 $ \\partial_{y}u, \\partial_{x}v, \\partial_{y}v $ 也是类似的。温度梯度为：\n$$ \\nabla T = \\frac{\\gamma-1}{R\\rho} \\left[ (u^{2}+v^{2}-E)\\nabla\\rho - u\\nabla(\\rho u) - v\\nabla(\\rho v) + \\nabla(\\rho E) \\right] $$\n问题要求的是 $ 4 \\times 8 $ 矩阵 $ K^{v}_{n} $，它将堆叠的梯度向量 $ [\\partial_{x}U^{\\top}, \\partial_{y}U^{\\top}]^{\\top} $ 映射到 $ F^{v}_{n} $。设 $ C_{\\mu} = \\mu/\\rho $ 和 $ C_{\\kappa}=\\frac{\\kappa(\\gamma-1)}{R\\rho} $。通过代入原始变量梯度的表达式并收集 $ \\nabla U $ 每个分量的系数，可以计算出 $ K^{v}_{n} $ 的元素。\n\n得到的矩阵 $ K^{v}_{n} $ 为：\n$ K^{v}_{n} = \\begin{pmatrix} K^{v,x} & K^{v,y} \\end{pmatrix} $，其中 $ K^{v,x} $ 和 $ K^{v,y} $ 是 $ 4 \\times 4 $ 矩阵。\n第一行为零：$ (K^{v}_{n})_{1,j} = 0 $ for $ j=1, \\dots, 8 $。\n\n对于第二行 $(F^{v}_{n,2} = n_x\\tau_{xx} + n_y\\tau_{xy})$：\n$ (K_{n}^{v})_{2,1} = -C_{\\mu}(\\frac{4}{3}n_{x}u + n_{y}v) $\n$ (K_{n}^{v})_{2,2} = C_{\\mu}\\frac{4}{3}n_{x} $\n$ (K_{n}^{v})_{2,3} = C_{\\mu}n_{y} $\n$ (K_{n}^{v})_{2,4} = 0 $\n$ (K_{n}^{v})_{2,5} = C_{\\mu}(\\frac{2}{3}n_{x}v - n_{y}u) $\n$ (K_{n}^{v})_{2,6} = C_{\\mu}n_{y} $\n$ (K_{n}^{v})_{2,7} = -C_{\\mu}\\frac{2}{3}n_{x} $\n$ (K_{n}^{v})_{2,8} = 0 $\n\n对于第三行 $(F^{v}_{n,3} = n_x\\tau_{xy} + n_y\\tau_{yy})$：\n$ (K_{n}^{v})_{3,1} = C_{\\mu}(-n_{x}v + \\frac{2}{3}n_{y}u) $\n$ (K_{n}^{v})_{3,2} = -C_{\\mu}\\frac{2}{3}n_{y} $\n$ (K_{n}^{v})_{3,3} = C_{\\mu}n_{x} $\n$ (K_{n}^{v})_{3,4} = 0 $\n$ (K_{n}^{v})_{3,5} = -C_{\\mu}(n_{x}u + \\frac{4}{3}n_{y}v) $\n$ (K_{n}^{v})_{3,6} = C_{\\mu}n_{x} $\n$ (K_{n}^{v})_{3,7} = C_{\\mu}\\frac{4}{3}n_{y} $\n$ (K_{n}^{v})_{3,8} = 0 $\n\n对于第四行，设 $ E_{k} = \\frac{1}{2}(u^{2}+v^{2}) $。贡献来自于应力张量功和热通量。系数是这两部分项的和。\n$ (K_{n}^{v})_{4,j} = u(K_{n}^{v})_{2,j} + v(K_{n}^{v})_{3,j} - \\frac{\\partial(n_x q_x + n_y q_y)}{\\partial (\\nabla U)_j} $。\n热通量部分是：\n$ (K_{n}^{v})_{4,1} = u(K_{n}^{v})_{2,1} + v(K_{n}^{v})_{3,1} + C_{\\kappa}n_{x}(u^{2}+v^{2}-E) $\n$ (K_{n}^{v})_{4,2} = u(K_{n}^{v})_{2,2} + v(K_{n}^{v})_{3,2} - C_{\\kappa}n_{x}u $\n$ (K_{n}^{v})_{4,3} = u(K_{n}^{v})_{2,3} + v(K_{n}^{v})_{3,3} - C_{\\kappa}n_{x}v $\n$ (K_{n}^{v})_{4,4} = C_{\\kappa}n_{x} $\n$ (K_{n}^{v})_{4,5} = u(K_{n}^{v})_{2,5} + v(K_{n}^{v})_{3,5} + C_{\\kappa}n_{y}(u^{2}+v^{2}-E) $\n$ (K_{n}^{v})_{4,6} = u(K_{n}^{v})_{2,6} + v(K_{n}^{v})_{3,6} - C_{\\kappa}n_{y}u $\n$ (K_{n}^{v})_{4,7} = u(K_{n}^{v})_{2,7} + v(K_{n}^{v})_{3,7} - C_{\\kappa}n_{y}v $\n$ (K_{n}^{v})_{4,8} = C_{\\kappa}n_{y} $\n\n第三，我们解释 $ A^{c}_{n} $ 和 $ K^{v}_{n} $ 在求解纳维–斯托克斯方程的隐式 DG 方法中的作用。\n半离散 DG 公式化会产生一个常微分方程组 $ M \\frac{d\\mathbf{U}}{dt} = \\mathcal{R}(\\mathbf{U}) $，其中 $ \\mathbf{U} $ 是离散解 $ U_{h} $ 所有自由度的向量，$ M $ 是质量矩阵。应用诸如 Backward Euler 等隐式时间积分格式，在每个时间步 $ n+1 $ 产生一个非线性代数系统：$ \\mathbf{G}(\\mathbf{U}^{n+1}) = \\mathbf{U}^{n+1} - \\mathbf{U}^{n} - \\Delta t M^{-1}\\mathcal{R}(\\mathbf{U}^{n+1}) = \\mathbf{0} $。这个系统通常使用牛顿法求解，该方法要求在每次迭代中求解一个线性系统 $ J_{\\mathbf{G}} \\delta\\mathbf{U} = -\\mathbf{G} $，其中 $ J_{\\mathbf{G}} = I - \\Delta t M^{-1}\\frac{\\partial\\mathcal{R}}{\\partial\\mathbf{U}} $ 是系统雅可比矩阵。对于大规模问题，这个线性系统使用克雷洛夫子空间方法（例如，GMRES）求解，这样可以避免显式地构建稠密矩阵 $ J_{\\mathbf{G}} $。相反，它只需要雅可比矩阵对一个向量的作用，即 $ w \\mapsto J_{\\mathbf{G}} w $，这是一种所谓的无矩阵方法。残差的雅可比矩阵 $ \\frac{\\partial\\mathcal{R}}{\\partial\\mathbf{U}} $ 由单元局部体积积分和连接相邻单元的面积分的贡献组成。面积分项的雅可比矩阵涉及对流项（$ \\hat{F}_{n}^{c} $）和粘性项（$ \\hat{F}_{n}^{v} $）的数值通量，而这正是 $ A^{c}_{n} $ 和 $ K^{v}_{n} $ 发挥关键作用的地方。数值对流通量的线性化 $ \\frac{\\partial \\hat{F}_{n}^{c}}{\\partial U} $ 是通过使用在界面两侧的状态下计算的法向对流雅可比矩阵 $ A^{c}_{n} $ 来构建的。类似地，数值粘性通量的线性化（例如，使用 BR2 格式）涉及关于状态 $ U $ 及其梯度 $ \\nabla U $ 的导数。导数 $ \\frac{\\partial \\hat{F}_{n}^{v}}{\\partial (\\nabla U)} $ 是由矩阵 $ K^{v}_{n} $ 构建的。因此，$ A^{c}_{n} $ 和 $ K^{v}_{n} $ 是组装牛顿–克雷洛夫求解器所需的完整系统雅可比矩阵作用的基本构建模块。\n\n最后，我们计算给定状态下 $ A^{c}_{n}(U) $ 的谱半径。\n数据为：$ \\rho = 1.18\\ \\mathrm{kg/m^{3}} $，$ u = 210\\ \\mathrm{m/s} $，$ v = -35\\ \\mathrm{m/s} $，$ p = 101325\\ \\mathrm{Pa} $，$ \\gamma = 1.4 $，以及 $ \\mathbf{n} = (0.6, 0.8) $。\n$ A^{c}_{n}(U) $ 的特征值为 $ u_{n}, u_{n}, u_{n}+a, u_{n}-a $，其中 $ u_{n} $ 是法向速度，$ a $ 是声速。谱半径是特征值绝对值的最大值，由 $ \\rho(A^{c}_{n}) = |u_{n}| + a $ 给出。\n首先，我们计算法向速度 $ u_{n} $：\n$$ u_{n} = u n_{x} + v n_{y} = (210)(0.6) + (-35)(0.8) = 126 - 28 = 98\\ \\mathrm{m/s} $$\n接下来，我们计算声速 $ a $：\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(101325)}{1.18}} \\approx \\sqrt{120216.1}\\ \\mathrm{m/s} \\approx 346.722\\ \\mathrm{m/s} $$\n那么谱半径为：\n$$ \\rho(A^{c}_{n}) = |u_{n}| + a = |98| + 346.722 = 444.722\\ \\mathrm{m/s} $$\n四舍五入到四位有效数字，结果是 $ 444.7\\ \\mathrm{m/s} $。", "answer": "$$ \\boxed{444.7} $$", "id": "3376455"}]}