{"hands_on_practices": [{"introduction": "谱延迟修正（SDC）方法的核心在于其积分校正机制，而这依赖于一个关键的数学工具：积分矩阵$Q$。该矩阵将常微分方程的连续积分形式离散化，从而将一个分析问题转化为一个代数方程组。通过从第一性原理出发，为一组给定的配置点推导这个矩阵 [@problem_id:3416873]，您将对配置近似的构建方式以及如何利用它形成驱动SDC扫描的残差有一个具体而深刻的理解。", "problem": "考虑一个常微分方程 (ODE) 的初值问题，$y^{\\prime}(t)=f(t,y(t))$，该问题设定在步长为$h=t_{n+1}-t_{n}$的单个时间步$[t_{n},t_{n+1}]$上。通过$t=t_{n}+h\\,\\tau$引入归一化时间变量$\\tau\\in[0,1]$，因此$y(t_{n}+h\\,\\tau)$满足积分形式$y(t_{n}+h\\,\\tau)=y(t_{n})+\\int_{0}^{\\tau}h\\,f(t_{n}+h\\,s,y(t_{n}+h\\,s))\\,ds$。在作为谱延迟修正 (SDC) 方法基础的配置点构造中，右侧项通过在$[0,1]$上的勒让德-高斯-洛巴托 (LGL) 节点进行多项式插值来近似。对于$M=2$的情况，这三个节点是$\\tau_{0}=0$, $\\tau_{1}=\\tfrac{1}{2}$和$\\tau_{2}=1$。令$\\ell_{j}(\\tau)$，$j=0,1,2$，表示与这些节点相关的拉格朗日基多项式。\n\n仅从这些原理和定义出发，并且不使用任何预先组合的配置点算子公式，完成以下任务：\n\n1. 从第一性原理出发，构造一个线性算子，该算子将节点函数值向量$\\big(f(t_{n}+h\\,\\tau_{j},y(t_{n}+h\\,\\tau_{j}))\\big)_{j=0}^{2}$映射到$[0,1]$上积分的近似值向量$\\left(\\int_{0}^{\\tau_{m}}f(t_{n}+h\\,s,y(t_{n}+h\\,s))\\,ds\\right)_{m=0}^{2}$。将此算子表示为一个求积矩阵$Q\\in\\mathbb{R}^{(M+1)\\times(M+1)}$ (对于$M=2$)，其元素以精确的有理数形式明确给出。\n\n2. 使用积分形式和配置点插值，解释在单个时间步上对常微分方程进行谱延迟修正 (SDC) 扫描时，如何使用这个求积矩阵$Q$来评估节点上的残差，并用$Q$、$h$、节点函数值向量和节点解近似值向量来表示残差向量。\n\n作为一个唯一的正确性数值证明，报告你计算出的矩阵$Q$的弗罗贝尼乌斯范数平方$\\|Q\\|_{F}^{2}$的精确值。以单个无舍入的有理数形式提供该精确值。", "solution": "该问题是有效的，因为它是常微分方程数值分析领域中一个适定且有科学依据的问题。我们可以开始求解。\n\n该问题要求构造一个与配置点方法相关的求积矩阵$Q$，用于求解常微分方程 (ODE) $y^{\\prime}(t)=f(t,y(t))$。该方法定义在长度为$h=t_{n+1}-t_n$的时间区间$[t_n, t_{n+1}]$上。通过$t=t_n+h\\tau$变换到归一化时间变量$\\tau\\in[0,1]$后，ODE的积分形式为\n$$\ny(t_n+h\\tau) = y(t_n) + h \\int_{0}^{\\tau} f(t_n+hs, y(t_n+hs)) ds\n$$\n为简洁起见，我们记$F(\\tau) = f(t_n+h\\tau, y(t_n+h\\tau))$。通过将在$[0,1]$上的勒让德-高斯-洛巴托 (LGL) 节点处$M=2$次的插值多项式$P(s)$替换$F(s)$来近似该积分。对于$M=2$，这$M+1=3$个节点为$\\tau_0=0$, $\\tau_1=\\frac{1}{2}$和$\\tau_2=1$。\n\n插值多项式$P(s)$在拉格朗日基中表示为：\n$$\nP(s) = \\sum_{j=0}^{2} F_j \\ell_j(s)\n$$\n其中$F_j = F(\\tau_j)$是节点上的函数值，$\\ell_j(s)$是满足$\\ell_j(\\tau_k) = \\delta_{jk}$的拉格朗日基多项式。基多项式构造如下：\n$$\n\\ell_j(s) = \\prod_{k=0, k\\neq j}^{2} \\frac{s-\\tau_k}{\\tau_j-\\tau_k}\n$$\n对于给定的节点$\\tau_0=0$, $\\tau_1=\\frac{1}{2}$, $\\tau_2=1$：\n\\begin{enumerate}\n    \\item 对于$j=0$: $\\ell_0(s) = \\frac{(s-\\frac{1}{2})(s-1)}{(0-\\frac{1}{2})(0-1)} = \\frac{s^2-\\frac{3}{2}s+\\frac{1}{2}}{\\frac{1}{2}} = 2s^2 - 3s + 1$。\n    \\item 对于$j=1$: $\\ell_1(s) = \\frac{(s-0)(s-1)}{(\\frac{1}{2}-0)(\\frac{1}{2}-1)} = \\frac{s^2-s}{-\\frac{1}{4}} = -4s^2 + 4s$。\n    \\item 对于$j=2$: $\\ell_2(s) = \\frac{(s-0)(s-\\frac{1}{2})}{(1-0)(1-\\frac{1}{2})} = \\frac{s^2-\\frac{1}{2}s}{\\frac{1}{2}} = 2s^2 - s$。\n\\end{enumerate}\n\n**1. 求积矩阵 $Q$ 的构造**\n\n问题要求找到一个线性算子，它将节点函数值向量$(F_j)_{j=0}^2$映射到积分近似值向量$\\left(\\int_{0}^{\\tau_{m}} F(s) ds\\right)_{m=0}^2$。这个算子就是求积矩阵$Q \\in \\mathbb{R}^{3 \\times 3}$。其元素$Q_{mj}$定义为：\n$$\n\\int_0^{\\tau_m} P(s) ds = \\int_0^{\\tau_m} \\sum_{j=0}^2 F_j \\ell_j(s) ds = \\sum_{j=0}^2 F_j \\left(\\int_0^{\\tau_m} \\ell_j(s) ds\\right)\n$$\n因此，矩阵$Q$的元素由$Q_{mj} = \\int_{0}^{\\tau_m} \\ell_j(s) ds$给出，其中$m$是行索引，$j$是列索引 ($m, j \\in \\{0, 1, 2\\}$)。\n\n首先，我们求拉格朗日多项式的不定积分：\n\\begin{itemize}\n    \\item $\\int \\ell_0(s) ds = \\int (2s^2 - 3s + 1) ds = \\frac{2}{3}s^3 - \\frac{3}{2}s^2 + s$\n    \\item $\\int \\ell_1(s) ds = \\int (-4s^2 + 4s) ds = -\\frac{4}{3}s^3 + 2s^2$\n    \\item $\\int \\ell_2(s) ds = \\int (2s^2 - s) ds = \\frac{2}{3}s^3 - \\frac{1}{2}s^2$\n\\end{itemize}\n我们计算这些积分在$0$到$\\tau_m$上的值，其中$m=0, 1, 2$。\n\n对于$m=0$，$\\tau_0=0$。在$[0,0]$上的积分为零。\n$$Q_{00} = 0, \\quad Q_{01} = 0, \\quad Q_{02} = 0$$\n\n对于$m=1$，$\\tau_1=\\frac{1}{2}$。\n\\begin{itemize}\n    \\item $Q_{10} = \\left[\\frac{2}{3}s^3 - \\frac{3}{2}s^2 + s\\right]_0^{1/2} = \\frac{2}{3}\\left(\\frac{1}{8}\\right) - \\frac{3}{2}\\left(\\frac{1}{4}\\right) + \\frac{1}{2} = \\frac{1}{12} - \\frac{3}{8} + \\frac{1}{2} = \\frac{2-9+12}{24} = \\frac{5}{24}$。\n    \\item $Q_{11} = \\left[-\\frac{4}{3}s^3 + 2s^2\\right]_0^{1/2} = -\\frac{4}{3}\\left(\\frac{1}{8}\\right) + 2\\left(\\frac{1}{4}\\right) = -\\frac{1}{6} + \\frac{1}{2} = \\frac{2}{6} = \\frac{1}{3}$。\n    \\item $Q_{12} = \\left[\\frac{2}{3}s^3 - \\frac{1}{2}s^2\\right]_0^{1/2} = \\frac{2}{3}\\left(\\frac{1}{8}\\right) - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{12} - \\frac{1}{8} = \\frac{2-3}{24} = -\\frac{1}{24}$。\n\\end{itemize}\n\n对于$m=2$，$\\tau_2=1$。\n\\begin{itemize}\n    \\item $Q_{20} = \\left[\\frac{2}{3}s^3 - \\frac{3}{2}s^2 + s\\right]_0^1 = \\frac{2}{3} - \\frac{3}{2} + 1 = \\frac{4-9+6}{6} = \\frac{1}{6}$。\n    \\item $Q_{21} = \\left[-\\frac{4}{3}s^3 + 2s^2\\right]_0^1 = -\\frac{4}{3} + 2 = \\frac{2}{3}$。\n    \\item $Q_{22} = \\left[\\frac{2}{3}s^3 - \\frac{1}{2}s^2\\right]_0^1 = \\frac{2}{3} - \\frac{1}{2} = \\frac{1}{6}$。\n\\end{itemize}\n\n综合这些结果，求积矩阵$Q$为：\n$$\nQ = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\frac{5}{24} & \\frac{1}{3} & -\\frac{1}{24} \\\\ \\frac{1}{6} & \\frac{2}{3} & \\frac{1}{6} \\end{pmatrix}\n$$\n\n**2. 谱延迟修正 (SDC) 中的残差评估**\n\n在 SDC 方法中，我们寻求一个满足所有节点上配置点条件的数值解。令$\\mathbf{y} = (y_0, y_1, ..., y_M)^T$为节点$\\tau_m$处解的近似值向量，其中$y_m \\approx y(t_n+h\\tau_m)$。配置点条件要求数值解在每个节点上都满足积分方程的离散形式：\n$$\ny_m = y_n + h \\int_0^{\\tau_m} P(s) ds, \\quad m=0, ..., M\n$$\n此处，$P(s)$是在节点上插值函数值$f(t_n+h\\tau_j, y_j)$的多项式。使用矩阵$Q$，积分近似值向量$\\mathbf{I} = (\\int_0^{\\tau_m} P(s) ds)_{m=0}^M$由$Q \\mathbf{F}(\\mathbf{y})$给出，其中$\\mathbf{F}(\\mathbf{y}) = (f(t_n+h\\tau_0, y_0), ..., f(t_n+h\\tau_M, y_M))^T$是节点函数值向量。\n\n配置点方程组可以写成向量形式：\n$$\n\\mathbf{y} = y_n\\mathbf{1} + h Q \\mathbf{F}(\\mathbf{y})\n$$\n其中$\\mathbf{1}$是全1向量。\n\n对于给定的近似值$\\mathbf{y}$，残差向量$\\mathbf{r}$衡量了该方程未被满足的程度。它被定义为配置点方程右侧与左侧之差。在 SDC 扫描中，此残差驱动修正步骤。\n\n因此，求积矩阵$Q$用于同时计算所有节点的积分项。残差向量由下式给出：\n$$\n\\mathbf{r} = (y_n\\mathbf{1} + h Q \\mathbf{F}(\\mathbf{y})) - \\mathbf{y}\n$$\n在 SDC 中，我们构造一系列近似值$\\mathbf{y}^{(k)}$，目标是使这个残差$\\mathbf{r}^{(k)}$趋于零。\n\n最后，作为数值证明，我们计算$Q$的弗罗贝尼乌斯范数的平方：\n$$\n\\|Q\\|_F^2 = \\sum_{m=0}^2 \\sum_{j=0}^2 |Q_{mj}|^2\n$$\n使用计算出的$Q$的元素：\n$$\nQ = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\frac{5}{24} & \\frac{8}{24} & -\\frac{1}{24} \\\\ \\frac{4}{24} & \\frac{16}{24} & \\frac{4}{24} \\end{pmatrix}\n$$\n$$\n\\|Q\\|_F^2 = 0^2+0^2+0^2 + \\left(\\frac{5}{24}\\right)^2 + \\left(\\frac{8}{24}\\right)^2 + \\left(-\\frac{1}{24}\\right)^2 + \\left(\\frac{4}{24}\\right)^2 + \\left(\\frac{16}{24}\\right)^2 + \\left(\\frac{4}{24}\\right)^2\n$$\n$$\n\\|Q\\|_F^2 = \\frac{1}{24^2} \\left(5^2 + 8^2 + (-1)^2 + 4^2 + 16^2 + 4^2\\right)\n$$\n$$\n\\|Q\\|_F^2 = \\frac{1}{576} \\left(25 + 64 + 1 + 16 + 256 + 16\\right)\n$$\n$$\n\\|Q\\|_F^2 = \\frac{378}{576}\n$$\n该分数可以通过将分子和分母同除以它们的最大公约数来简化。两者都可以被$18$整除（$378 = 18 \\times 21$, $576 = 18 \\times 32$）。\n$$\n\\|Q\\|_F^2 = \\frac{21}{32}\n$$", "answer": "$$\n\\boxed{\\frac{21}{32}}\n$$", "id": "3416873"}, {"introduction": "SDC方法本质上是迭代的，因此理解误差在迭代扫描中的传播方式对于稳健的实现至关重要。在现代计算环境中，为了平衡性能与精度，常常采用混合精度算法，这使得误差分析尤为重要。这个练习 [@problem_id:3416879] 要求您分析舍入误差在混合精度SDC格式中的累积效应，从而推导出一个严格的误差上界。这项实践将加深您对算法数值稳定性、收缩特性与有限机器精度之间相互作用的认识。", "problem": "考虑在长度为$h>0$的单个时间步$[t_n,t_{n+1}]$上的常微分方程$y'(t)=f(y(t))$的初值问题，其中$f:\\mathbb{R}\\to\\mathbb{R}$是 Lipschitz 连续的，Lipschitz 常数为$L>0$。令$M\\in\\mathbb{N}$表示用于在$[t_n,t_{n+1}]$上定义配置问题的配置节点的数量，并令相应的谱延迟修正（SDC）迭代定义一个阶段向量序列$\\{Y^{(m)}\\}_{m\\ge 0}\\in\\mathbb{R}^M$，该序列旨在收敛到配置解$Y^{\\star}\\in\\mathbb{R}^M$。\n\n假设以下标准事实成立，这些事实对于足够小的$hL$和常见的 SDC 预条件子是成立的：存在一个相容的向量范数$\\|\\cdot\\|$和一个收缩常数$\\sigma\\in(0,1)$，使得一次精确的 SDC 扫描（视为一个映射$\\mathcal{S}:\\mathbb{R}^M\\to\\mathbb{R}^M$）对所有$U,V\\in\\mathbb{R}^M$都满足收缩性质$\\|\\mathcal{S}(U)-\\mathcal{S}(V)\\|\\le \\sigma \\|U-V\\|$，并且$\\mathcal{S}(Y^{\\star})=Y^{\\star}$。此外，假设对某个有限的$B>0$，对所有$m\\ge 0$存在一个先验界$\\|Y^{(m)}\\|\\le B$。\n\n设计一个混合精度的 SDC 扫描，其计算过程如下：\n- 在单位舍入误差为$u_{\\ell}\\in(0,1)$的低精度算术中，显式构造配置残差（即，由函数求值和求积构成的、用于建立修正方程右端的向量），以及\n- 在单位舍入误差为$u_{h}\\in(0,1)$的高精度算术中，求解线性修正方程和执行所有向量更新，\n\n在标准浮点模型下：每个基本算术运算$\\circ\\in\\{+,-,\\times,\\div\\}$满足$\\mathrm{fl}(a\\circ b)=(a\\circ b)(1+\\delta)$，其中$|\\delta|\\le u$，$u$是执行该运算所用算术的相应单位舍入误差。\n\n假设在每次扫描中，低精度残差构造引入一个加性扰动向量$r_{\\ell}^{(m)}$，其范数界为$\\|r_{\\ell}^{(m)}\\|\\le \\alpha\\,u_{\\ell}$；高精度修正求解和向量更新引入一个加性扰动向量$r_{h}^{(m)}$，其范数界为$\\|r_{h}^{(m)}\\|\\le \\beta\\,u_{h}$。其中常数$\\alpha,\\beta\\ge 0$仅依赖于$h$、$L$、求积和预条件子矩阵以及界$B$，而不依赖于$m$或精度参数$u_{\\ell},u_h$。假设$\\{r_{\\ell}^{(m)}\\}$和$\\{r_{h}^{(m)}\\}$是对抗性的，但在此意义下是有界的。\n\n令混合精度 SDC 扫描从精确的初始猜测$Y^{(0)}=Y^{\\star}$开始应用$k\\in\\mathbb{N}$次，因此所有误差都源于有限精度。仅使用精确 SDC 扫描的收缩性质以及所述的浮点模型和$\\|r_{\\ell}^{(m)}\\|$与$\\|r_{h}^{(m)}\\|$的界，推导一个关于$k$次扫描后总舍入误差范数$\\|Y^{(k)}-Y^{\\star}\\|$的严格上界，该上界应表示为关于$\\sigma$、$k$、$\\alpha$、$\\beta$、$u_{\\ell}$和$u_{h}$的闭式解析表达式。您的最终答案必须是单个解析表达式。不要引入任何未说明的假设。如果使用等比级数，请根据给定数据证明其收敛性。请精确表达您的答案，不需要进行数值舍入。", "solution": "本题要求推导混合精度谱延迟修正（SDC）方法在$k$次扫描后总舍入误差的严格上界。分析将基于所提供的精确 SDC 扫描的收缩性质以及给定的浮点扰动模型。\n\n令$\\tilde{Y}^{(m)} \\in \\mathbb{R}^M$表示混合精度 SDC 算法经过$m$次扫描后计算出的阶段向量。精确的配置解记为$Y^{\\star} \\in \\mathbb{R}^M$。$m$次扫描后的误差向量定义为$e^{(m)} = \\tilde{Y}^{(m)} - Y^{\\star}$。题目指出迭代从精确的初始猜测开始，因此我们有$\\tilde{Y}^{(0)} = Y^{\\star}$，这意味着初始误差为零：$e^{(0)} = 0$。我们的目标是对于给定的扫描次数$k \\in \\mathbb{N}$，求出$\\|e^{(k)}\\|$的一个上界。\n\n单次精确的 SDC 扫描由一个映射$\\mathcal{S}: \\mathbb{R}^M \\to \\mathbb{R}^M$表示。题目描述了一个混合精度实现，其中每次扫描都受到两种舍入误差源的影响：来自低精度残差构造的加性扰动$r_{\\ell}^{(m)}$和来自高精度修正求解及向量更新的加性扰动$r_{h}^{(m)}$。我们可以将对当前近似值$\\tilde{Y}^{(m)}$应用一次扫描的计算结果建模为精确扫描算子的结果加上该次扫描的总扰动项。令从$\\tilde{Y}^{(m)}$计算$\\tilde{Y}^{(m+1)}$的扫描的总加性扰动为$r^{(m)} = r_{\\ell}^{(m)} + r_{h}^{(m)}$。因此，浮点迭代由以下递推关系建模：\n$$\n\\tilde{Y}^{(m+1)} = \\mathcal{S}(\\tilde{Y}^{(m)}) + r^{(m)} \\quad \\text{其中 } m = 0, 1, \\dots, k-1\n$$\n\n现在我们可以推导误差向量范数$\\|e^{(m)}\\|$的递推关系。根据定义，$e^{(m+1)} = \\tilde{Y}^{(m+1)} - Y^{\\star}$。代入混合精度扫描的模型可得：\n$$\ne^{(m+1)} = \\left( \\mathcal{S}(\\tilde{Y}^{(m)}) + r^{(m)} \\right) - Y^{\\star}\n$$\n题目指出$Y^{\\star}$是精确扫描算子$\\mathcal{S}$的一个不动点，这意味着$\\mathcal{S}(Y^{\\star}) = Y^{\\star}$。我们可以将此代入方程中：\n$$\ne^{(m+1)} = \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) + r^{(m)}\n$$\n现在，我们对等式两边取向量范数，并应用三角不等式：\n$$\n\\|e^{(m+1)}\\| = \\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) + r^{(m)} \\| \\le \\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) \\| + \\|r^{(m)}\\|\n$$\n题目给定$\\mathcal{S}$是一个收缩常数为$\\sigma \\in (0,1)$的收缩映射，即对于任意向量$U,V \\in \\mathbb{R}^M$，有$\\|\\mathcal{S}(U) - \\mathcal{S}(V)\\| \\le \\sigma \\|U - V\\|$。将此性质应用于$U = \\tilde{Y}^{(m)}$和$V = Y^{\\star}$：\n$$\n\\| \\mathcal{S}(\\tilde{Y}^{(m)}) - \\mathcal{S}(Y^{\\star}) \\| \\le \\sigma \\| \\tilde{Y}^{(m)} - Y^{\\star} \\| = \\sigma \\|e^{(m)}\\|\n$$\n将此结果代入$\\|e^{(m+1)}\\|$的不等式中，得到误差范数的以下递推不等式：\n$$\n\\|e^{(m+1)}\\| \\le \\sigma \\|e^{(m)}\\| + \\|r^{(m)}\\|\n$$\n接下来，我们需要对扰动项$\\|r^{(m)}\\|$进行界定。题目给定，对于每次扫描$m$，低精度扰动的范数有界$\\|r_{\\ell}^{(m)}\\| \\le \\alpha u_{\\ell}$，高精度扰动的范数有界$\\|r_{h}^{(m)}\\| \\le \\beta u_{h}$。对$\\|r^{(m)}\\| = \\|r_{\\ell}^{(m)} + r_{h}^{(m)}\\|$使用三角不等式，我们得到：\n$$\n\\|r^{(m)}\\| \\le \\|r_{\\ell}^{(m)}\\| + \\|r_{h}^{(m)}\\| \\le \\alpha u_{\\ell} + \\beta u_{h}\n$$\n由于$\\alpha$、$\\beta$、$u_{\\ell}$和$u_{h}$均为常数，我们可以为每次扫描的扰动范数定义一个常数上界，$\\Delta = \\alpha u_{\\ell} + \\beta u_{h}$。题目中关于扰动是对抗性的陈述意味着我们必须使用这个最坏情况下的界。误差范数的递推关系变为：\n$$\n\\|e^{(m+1)}\\| \\le \\sigma \\|e^{(m)}\\| + \\Delta\n$$\n我们可以通过展开这个线性递推关系来求解$\\|e^{(k)}\\|$，从初始条件$\\|e^{(0)}\\| = 0$开始：\n当$m=0$时：\n$$\n\\|e^{(1)}\\| \\le \\sigma \\|e^{(0)}\\| + \\Delta = \\sigma(0) + \\Delta = \\Delta\n$$\n当$m=1$时：\n$$\n\\|e^{(2)}\\| \\le \\sigma \\|e^{(1)}\\| + \\Delta \\le \\sigma(\\Delta) + \\Delta = \\Delta(1 + \\sigma)\n$$\n当$m=2$时：\n$$\n\\|e^{(3)}\\| \\le \\sigma \\|e^{(2)}\\| + \\Delta \\le \\sigma(\\Delta(1+\\sigma)) + \\Delta = \\Delta(1 + \\sigma + \\sigma^2)\n$$\n通过归纳法，经过$k$次扫描后（即，对于从$m=0$到$m=k-1$迭代产生的误差$e^{(k)}$），其界为：\n$$\n\\|e^{(k)}\\| \\le \\Delta \\sum_{j=0}^{k-1} \\sigma^j\n$$\n该和是一个有限等比级数。有限等比级数的求和公式为$\\sum_{j=0}^{n-1} r^j = \\frac{1-r^n}{1-r}$，对任意$r \\ne 1$均有效。在我们的例子中，公比是$\\sigma$，且题目给定$\\sigma \\in (0,1)$，这保证了$\\sigma \\ne 1$。因此，我们可以写出：\n$$\n\\sum_{j=0}^{k-1} \\sigma^j = \\frac{1 - \\sigma^k}{1 - \\sigma}\n$$\n将此结果代回到$\\|e^{(k)}\\|$的界中，并用其定义替换$\\Delta$，即可得到$k$次扫描后总舍入误差的最终上界：\n$$\n\\|Y^{(k)} - Y^{\\star}\\| = \\|e^{(k)}\\| \\le (\\alpha u_{\\ell} + \\beta u_{h}) \\frac{1 - \\sigma^k}{1 - \\sigma}\n$$\n此表达式是仅根据题目陈述中所提供的性质和界推导出的严格上界。", "answer": "$$\n\\boxed{(\\alpha u_{\\ell} + \\beta u_{h}) \\frac{1 - \\sigma^k}{1 - \\sigma}}\n$$", "id": "3416879"}, {"introduction": "这个综合性练习旨在展示如何将SDC作为一个功能强大的“黑箱”积分器，应用于更宏大的科学计算任务中。您将实现一个基于SDC的打靶法，用于寻找一个偏微分方程的时间周期解——这是流体力学、非线性光学等领域中一个常见且重要的问题。通过解决这个问题 [@problem_id:3416865]，您将把数值线性代数、Floquet理论和高等时间积分方法融会贯通，体验如何有效地部署SDC来解决具有实际物理意义的复杂问题。", "problem": "考虑一个线性抛物型偏微分方程 (PDE)，定义在周期性空间域$x \\in [0,2\\pi]$上，并具有周期为$T$的时间依赖性，其形式如下：\n$$\nu_t(x,t) = u_{xx}(x,t) + a \\cos(\\omega t)\\,u(x,t) + f(x,t),\n$$\n其中$a \\in \\mathbb{R}$是一个常数振幅，$\\omega = \\frac{2\\pi}{T}$是角频率，$f(x,t)$是一个给定的在时间上以$T$为周期的强迫项。假设解在一个包含$N$个模态的截断傅里叶余弦基（偶延拓）中表示，\n$$\nu(x,t) \\approx \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x),\n$$\n使得截断的谱系数$y_k(t)$满足一个常微分方程组 (ODE)。傅里叶拉普拉斯算子得到$u_{xx} \\mapsto -k^2 y_k$。设强迫项是逐模态且时间周期与解相同，具体为\n$$\nf(x,t) = \\sum_{k=1}^N g_k \\sin(\\omega t)\\,\\cos(k x),\n$$\n其中$g_k$是给定的振幅。\n\n1) 推导谱系数向量$y(t) \\in \\mathbb{R}^N$的$N$维常微分方程组，并将其写成仿射线性形式\n$$\ny'(t) = A(t)\\,y(t) + b(t),\n$$\n其中$A(t)$是一个时间周期矩阵，$b(t)$是一个时间周期向量。明确地用问题参数表示$A(t)$和$b(t)$。\n\n2) 周期为$T$的时间周期解可以通过单值（单周期）映射$\\Phi_T$的不动点来表征，该映射定义为$y(T) = \\Phi_T(y(0))$。对于仿射线性系统，存在一个矩阵$M$（线性单值矩阵）和一个向量$d$，使得\n$$\n\\Phi_T(y_0) = M\\,y_0 + d.\n$$\n从第一性原理出发，解释为什么不动点条件$y_{\\star} = \\Phi_T(y_{\\star})$等价于线性系统\n$$\n(I - M)\\,y_{\\star} = d.\n$$\n将 Floquet 乘子定义为$M$的特征值，并解释为什么当不动点存在时，谱半径$\\rho(M)$控制着 Picard 不动点迭代$y^{(n+1)} = \\Phi_T(y^{(n)})$向$y_{\\star}$的线性收敛。\n\n3) 构造一个在一个完整周期$[0,T]$上的谱延迟修正 (SDC) 时间积分方法，步骤如下。使用$K$个 Chebyshev–Gauss–Lobatto 节点$0 = t_0,  t_1,  \\dots,  t_{K-1} = T$，这些节点由$[0,1]$上的 Chebyshev–Lobatto 点通过$t_j = T\\,c_j$映射得到，其中$c_j = \\frac{1}{2}\\bigl(1 - \\cos(\\frac{\\pi j}{K-1})\\bigr)$。令$\\{\\ell_j(s)\\}_{j=0}^{K-1}$表示在$[0,1]$上的相关拉格朗日基多项式。定义子区间求积权重\n$$\nS_{m,j} = T \\int_{c_{m-1}}^{c_m} \\ell_j(s)\\,ds,\\quad m=1,\\dots,K-1,\\;\\; j=0,\\dots,K-1.\n$$\n从一个通过在节点上使用单个后向欧拉预测步得到的初始猜测开始，对于线性右端项$F(t,y) = A(t)\\,y + b(t)$，应用基于完全隐式后向欧拉基方法的$S$次 SDC 修正扫描。证明从节点$m-1$到$m$的一次 SDC 修正扫描通过求解以下线性系统来更新$y_m$：\n$$\n\\bigl(I - \\Delta t_m\\,A(t_m)\\bigr)\\,y_m^{k+1}\n=\ny_{m-1}^{k+1}\n- \\Delta t_m\\,A(t_m)\\,y_m^{k}\n+ \\sum_{j=0}^{K-1} S_{m,j}\\,F(t_j, y_j^{k}),\n$$\n其中$m=1,\\dots,K-1$，$\\Delta t_m = t_m - t_{m-1}$，$k$是扫描索引。解释为什么这个公式可以通过对配置方程加上和减去后向欧拉残差而直接得到。\n\n4) 实现一个基于 SDC 的打靶法程序，以数值方式构造单值映射。具体来说：\n- 对于给定的$N$、$K$和$S$，通过将 SDC 积分器应用于齐次系统$y' = A(t)\\,y$，使用$\\mathbb{R}^N$中的标准基向量作为$N$个线性无关的初始条件，在一个周期内构造$N\\times N$的单值矩阵$M$。\n- 通过将相同的 SDC 积分器应用于从零向量开始的非齐次系统来构造仿射项$d$。\n\n然后：\n- 使用直接线性求解器求解$(I - M)\\,y_{\\star} = d$，得到时间周期初始向量$y_{\\star}$。\n- 计算残差范数$\\| \\Phi_T(y_{\\star}) - y_{\\star} \\|_2$，其中$\\Phi_T$由相同的 SDC 积分器评估。\n- 将 Floquet 乘子计算为$M$的特征值，并报告它们的最大模$\\rho(M)$。\n\n角度必须以弧度处理。不需要物理单位。\n\n测试套件。您的程序必须运行以下三个测试用例，并将输出汇总到单行中。在每个测试中，强迫振幅按指定为$g_k = \\gamma/k$或$g_k = \\gamma/k^2$，其中$k=1,\\dots,N$：\n- 测试 1 (一般情况): $N=5$, $K=5$, $S=3$, $T=1.0$, $a=1.0$, $\\omega = 2\\pi/T$, $g_k = 1/k^2$。\n- 测试 2 (更短的周期，更强的参数系数): $N=4$, $K=4$, $S=2$, $T=0.7$, $a=3.0$, $\\omega = 2\\pi/T$, $g_k = 0.5/k$。\n- 测试 3 (更长的周期，一个周期内更强的扩散): $N=3$, $K=6$, $S=4$, $T=2.0$, $a=0.5$, $\\omega = 2\\pi/T$, $g_k = 1.0/k$。\n\n对于每个测试，按此顺序输出以下三个量：\n- 谱半径$\\rho(M)$，浮点数。\n- 周期性残差范数$\\| \\Phi_T(y_{\\star}) - y_{\\star} \\|_2$，浮点数。\n- 一个布尔值，指示收缩条件$\\rho(M)  1$是否成立。\n\n最终输出格式。您的程序应生成单行输出，其中包含三个测试的九个结果，按顺序连接成一个逗号分隔的 Python 风格列表，例如：“[rho1,res1,contract1,rho2,res2,contract2,rho3,res3,contract3]”。角度必须以弧度为单位，不应打印任何其他文本。", "solution": "该问题要求推导并数值求解一个常微分方程组 (ODE)，该方程组源于一个具有时间周期系数的线性抛物型偏微分方程 (PDE) 的谱离散化。求解过程涉及应用傅里叶分析、具有周期系数的线性常微分方程理论（Floquet 理论）以及高级时间积分数值方法，特别是谱延迟修正 (SDC)。\n\n### 第1部分：常微分方程组的推导\n\n控制偏微分方程如下：\n$$\nu_t(x,t) = u_{xx}(x,t) + a \\cos(\\omega t)\\,u(x,t) + f(x,t)\n$$\n其中$x \\in [0, 2\\pi]$（周期性），时间周期为$T$，$\\omega = 2\\pi/T$。\n\n解$u(x,t)$和强迫项$f(x,t)$由具有$N$个模态的截断傅里叶余弦级数表示：\n$$\nu(x,t) \\approx \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x)\n$$\n$$\nf(x,t) = \\sum_{k=1}^{N} g_k \\sin(\\omega t)\\,\\cos(k x)\n$$\n$u(x,t)$关于$t$和$x$的偏导数通过对级数逐项求导得到：\n$$\nu_t(x,t) \\approx \\sum_{k=1}^{N} y'_k(t)\\,\\cos(k x)\n$$\n$$\nu_x(x,t) \\approx \\sum_{k=1}^{N} -k\\,y_k(t)\\,\\sin(k x)\n$$\n$$\nu_{xx}(x,t) \\approx \\sum_{k=1}^{N} -k^2\\,y_k(t)\\,\\cos(k x)\n$$\n将这些表达式代入偏微分方程，我们得到：\n$$\n\\sum_{k=1}^{N} y'_k(t)\\,\\cos(k x) = \\sum_{k=1}^{N} -k^2 y_k(t)\\,\\cos(k x) + a \\cos(\\omega t) \\sum_{k=1}^{N} y_k(t)\\,\\cos(k x) + \\sum_{k=1}^{N} g_k \\sin(\\omega t)\\,\\cos(k x)\n$$\n通过收集与每个基函数$\\cos(k x)$相关的项，可以重新整理此方程：\n$$\n\\sum_{k=1}^{N} \\left[ y'_k(t) - \\left(-k^2 + a \\cos(\\omega t)\\right) y_k(t) - g_k \\sin(\\omega t) \\right] \\cos(k x) = 0\n$$\n由于基函数$\\{\\cos(k x)\\}_{k=1}^N$在区间$[0, 2\\pi]$上的正交性，每个$\\cos(k x)$的系数必须为零。该投影产生了一个由$N$个解耦的一阶线性常微分方程组成的系统，每个方程对应一个谱系数$y_k(t)$：\n$$\ny'_k(t) = (-k^2 + a \\cos(\\omega t)) y_k(t) + g_k \\sin(\\omega t), \\quad k=1, \\dots, N\n$$\n我们可以将此系统写成所需的仿射线性形式$y'(t) = A(t)\\,y(t) + b(t)$，其中$y(t) = [y_1(t), y_2(t), \\dots, y_N(t)]^T \\in \\mathbb{R}^N$。矩阵$A(t)$和向量$b(t)$被确定为：\n$$\nA(t) = \\text{diag}\\left(-1^2 + a \\cos(\\omega t), -2^2 + a \\cos(\\omega t), \\dots, -N^2 + a \\cos(\\omega t)\\right)\n$$\n$$\nb(t) = \\begin{pmatrix} g_1 \\sin(\\omega t) \\\\ g_2 \\sin(\\omega t) \\\\ \\vdots \\\\ g_N \\sin(\\omega t) \\end{pmatrix}\n$$\n$A(t)$是一个周期为$T$的对角时间周期矩阵，$b(t)$也是一个周期为$T$的时间周期向量。\n\n### 第2部分：不动点条件与收敛性\n\n初始值问题$y'(t) = A(t)\\,y(t) + b(t)$且$y(0) = y_0$的解可以使用常数变易法公式形式化地写出。令$\\Psi(t,s)$为齐次系统$y' = A(t)y$的状态转移矩阵（或基本矩阵），它满足$\\frac{d}{dt}\\Psi(t,s) = A(t)\\Psi(t,s)$和$\\Psi(s,s) = I$。在时间$t$的解是：\n$$\ny(t) = \\Psi(t,0)y_0 + \\int_0^t \\Psi(t,s) b(s) ds\n$$\n单值映射$\\Phi_T$将解推进一个周期，$y(T) = \\Phi_T(y(0))$。在$t=T$处评估解可得：\n$$\ny(T) = \\Psi(T,0)y_0 + \\int_0^T \\Psi(T,s) b(s) ds\n$$\n通过将其与给定的仿射形式$\\Phi_T(y_0) = M y_0 + d$进行比较，我们确定了线性单值矩阵$M = \\Psi(T,0)$和仿射向量$d = \\int_0^T \\Psi(T,s) b(s) ds$。\n\n一个解$y(t)$是周期为$T$的周期解，当且仅当$y(T) = y(0)$。令$y_\\star = y(0)$为产生这样一个周期解的初始条件。条件$y(T) = y(0)$转化为$y_\\star = \\Phi_T(y_\\star)$，这意味着$y_\\star$必须是单值映射的一个不动点。使用映射的仿射形式，我们得到：\n$$\ny_\\star = M y_\\star + d\n$$\n重新整理此方程得到关于未知初始条件$y_\\star$的一个线性系统：\n$$\nI y_\\star - M y_\\star = d \\implies (I - M) y_\\star = d\n$$\n唯一周期解存在的充要条件是矩阵$(I - M)$可逆，这等价于$1$不是$M$的特征值。\n\n用于寻找$y_\\star$的 Picard 不动点迭代由$y^{(n+1)} = \\Phi_T(y^{(n)})$给出。为了分析其收敛性，我们考察误差的演化，$e^{(n)} = y^{(n)} - y_\\star$。\n$$\ne^{(n+1)} = y^{(n+1)} - y_\\star = \\Phi_T(y^{(n)}) - y_\\star = (M y^{(n)} + d) - (M y_\\star + d) = M(y^{(n)} - y_\\star) = M e^{(n)}\n$$\n这意味着$e^{(n)} = M^n e^{(0)}$。对于任何初始误差$e^{(0)}$，迭代收敛的充要条件是$\\lim_{n \\to \\infty} M^n = 0$。这发生的充要条件是$M$的谱半径$\\rho(M) = \\max_i |\\lambda_i(M)|$严格小于$1$。单值矩阵$M$的特征值$\\lambda_i(M)$被称为系统的 Floquet 乘子。因此，Picard 迭代线性收敛的条件是$\\rho(M)  1$。\n\n### 第3部分：谱延迟修正 (SDC) 公式\n\nSDC 是一种求解常微分方程的迭代方法，它系统地提高精度阶数。它从一个低阶近似开始，并使用基于高阶求积法则的残差来迭代地修正它。\n在子区间$[t_{m-1}, t_m]$上的常微分方程的积分形式是：\n$$\ny(t_m) = y(t_{m-1}) + \\int_{t_{m-1}}^{t_m} F(s, y(s)) ds\n$$\n其中$F(t,y) = A(t)y + b(t)$。SDC 使用基于全部$K$个节点$\\{t_j\\}_{j=0}^{K-1}$的求积法则来近似积分。从扫描$k$到$k+1$的更新是通过加上和减去一个低阶（例如，后向欧拉）的积分近似来构造的。\n用于积分的基于配置点的高阶求积是$\\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j)$，其中$S_{m,j} = T \\int_{c_{m-1}}^{c_m} \\ell_j(s) ds$。低阶后向欧拉近似是$\\Delta t_m F(t_m, y_m)$，其中$\\Delta t_m = t_m - t_{m-1}$。\n\nSDC 方法迭代地求解配置方程。可以为误差修正制定一个隐式扫描。其核心思想是，新迭代相对于低阶方法的残差应等于前一个迭代相对于高阶求积的误差（残差）。\n设$y_m^k$是在扫描$k$次后节点$t_m$处的解。从$m-1$到$m$的类 Gauss-Seidel 扫描的更新规则是：\n$$\ny_m^{k+1} - \\Delta t_m F(t_m, y_m^{k+1}) = y_{m-1}^{k+1} + \\left[ \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k) - \\Delta t_m F(t_m, y_m^k) \\right]\n$$\n左侧是应用于新迭代$y_m^{k+1}$的隐式后向欧拉算子，使用了刚计算出的前一个节点的值$y_{m-1}^{k+1}$。右侧由$y_{m-1}^{k+1}$加上“谱积分残差”组成，该残差是高阶求积与低阶积分近似之间的差值，使用前一次扫描的值$y^k$进行评估。\n对于线性常微分方程$F(t,y) = A(t)y + b(t)$，我们将其代入公式：\n$$\ny_m^{k+1} - \\Delta t_m (A(t_m)y_m^{k+1} + b(t_m)) = y_{m-1}^{k+1} + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k) - \\Delta t_m (A(t_m)y_m^k + b(t_m))\n$$\n项$\\Delta t_m b(t_m)$在两侧抵消。将涉及$y_m^{k+1}$的项重新整理到左侧，得到：\n$$\ny_m^{k+1} - \\Delta t_m A(t_m)y_m^{k+1} = y_{m-1}^{k+1} - \\Delta t_m A(t_m)y_m^k + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k)\n$$\n提取出$y_m^{k+1}$因子，得到问题中陈述的线性系统：\n$$\n\\bigl(I - \\Delta t_m A(t_m)\\bigr) y_m^{k+1} = y_{m-1}^{k+1} - \\Delta t_m A(t_m) y_m^k + \\sum_{j=0}^{K-1} S_{m,j} F(t_j, y_j^k)\n$$\n这是一个线性系统，需要在扫描的每一步$m=1, \\dots, K-1$求解$y_m^{k+1}$。\n\n### 第4部分：通过基于 SDC 的打靶法实现\n\n数值程序将遵循所提供的指令。\n1.  **定义系统和离散化：** 对于每个测试用例，设置参数$N$, $K$, $S$, $T$, $a$以及$g_k$的规则。计算角频率$\\omega=2\\pi/T$、时间节点$\\{t_j\\}$和时间步长$\\{\\Delta t_m\\}$。\n2.  **求积权重：** 通过在每个子区间$[t_{m-1}, t_m]$上解析地积分与 Chebyshev-Lobatto 节点相关的拉格朗日基多项式，来预先计算求积矩阵$S_{m,j}$。\n3.  **SDC 积分器：** 实现一个函数来执行在$[0,T]$上的时间积分。它接受一个初始条件$y(0)$，并应用一个后向欧拉预测步，随后进行$S$次 SDC 修正扫描，如第 3 部分所推导。\n4.  **构造单值映射：**\n    -   单值矩阵$M$是逐列构造的。$M$的第$j$列是将 SDC 积分器应用于齐次系统（$b(t)=0$）的结果，其中初始条件为第$j$个标准基向量$e_j$。\n    -   仿射向量$d$是通过将 SDC 积分器应用于以零向量为初始条件的完整非齐次系统来构造的。\n5.  **求解周期解：**\n    -   周期解的初始条件$y_\\star$是通过求解线性系统$(I - M)y_\\star = d$来找到的。\n    -   为验证解，计算周期性残差$\\|\\Phi_T(y_\\star) - y_\\star\\|_2$。这是通过以初始条件$y_\\star$再次应用 SDC 积分器得到$\\Phi_T(y_\\star)$，并将其与$y_\\star$进行比较来完成的。由于有限精度算术和离散化误差，该范数将很小但非零。\n6.  **分析稳定性：** Floquet 乘子计算为$M$的特征值。找到并报告它们的最大模，即谱半径$\\rho(M)$，以及收缩条件$\\rho(M)  1$是否满足。\n\n这种结构化程序可以对周期解进行稳健的数值逼近，并分析其稳定性特征。", "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import lagrange\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        {'N': 5, 'K': 5, 'S': 3, 'T': 1.0, 'a': 1.0, 'g_rule': lambda k: 1.0 / k**2},\n        {'N': 4, 'K': 4, 'S': 2, 'T': 0.7, 'a': 3.0, 'g_rule': lambda k: 0.5 / k},\n        {'N': 3, 'K': 6, 'S': 4, 'T': 2.0, 'a': 0.5, 'g_rule': lambda k: 1.0 / k},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        rho_M, residual_norm, is_contraction = run_test_case(**params)\n        all_results.extend([rho_M, residual_norm, is_contraction])\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\n\ndef run_test_case(N, K, S, T, a, g_rule):\n    \"\"\"\n    Executes a single test case for the given parameters.\n    \"\"\"\n    # ====== 1. Setup Discretization and System Parameters ======\n    omega = 2.0 * np.pi / T\n    ks = np.arange(1, N + 1)\n    gs = g_rule(ks)\n\n    # Chebyshev-Gauss-Lobatto nodes mapped to [0, T]\n    c_nodes = 0.5 * (1.0 - np.cos(np.pi * np.arange(K) / (K - 1)))\n    t_nodes = T * c_nodes\n    delta_ts = np.diff(t_nodes)\n\n    # Define the system functions A(t) and b(t)\n    def A_func(t):\n        diag_vals = -ks**2 + a * np.cos(omega * t)\n        return np.diag(diag_vals)\n\n    def b_func(t):\n        return gs * np.sin(omega * t)\n\n    def F_func(t, y):\n        return A_func(t) @ y + b_func(t)\n\n    # ====== 2. Pre-compute SDC Quadrature Matrix S_m,j ======\n    S_mat = np.zeros((K - 1, K))\n    id_matrix_K = np.eye(K)\n    for j in range(K):\n        # Lagrange polynomial for node j on [0,1]\n        l_j_poly = lagrange(c_nodes, id_matrix_K[:, j])\n        # Integral of the polynomial\n        l_j_integral = l_j_poly.integ()\n        for m in range(1, K):\n            integral_val = l_j_integral(c_nodes[m]) - l_j_integral(c_nodes[m-1])\n            S_mat[m - 1, j] = T * integral_val\n\n    # ====== 3. SDC Integrator over one period [0, T] ======\n    def sdc_integrate(y0, b_func_local):\n        # Initialize solution at nodes\n        Y = np.zeros((K, N))\n        Y[0] = y0\n\n        # Predictor step (k=0): Backward Euler\n        for m in range(1, K):\n            dt = delta_ts[m - 1]\n            LHS_mat = np.eye(N) - dt * A_func(t_nodes[m])\n            RHS = Y[m - 1] + dt * b_func_local(t_nodes[m])\n            Y[m] = np.linalg.solve(LHS_mat, RHS)\n        \n        # Corrector sweeps\n        for _ in range(S):\n            Y_new = np.copy(Y)\n            for m in range(1, K):\n                dt = delta_ts[m - 1]\n                \n                # Compute integral term from previous sweep k\n                integral_term = np.zeros(N)\n                for j in range(K):\n                    F_j = A_func(t_nodes[j]) @ Y[j] + b_func_local(t_nodes[j])\n                    integral_term += S_mat[m - 1, j] * F_j\n                \n                # Form RHS of the linear system for y_m^(k+1)\n                RHS = Y_new[m - 1] - dt * A_func(t_nodes[m]) @ Y[m] + integral_term\n\n                # Form LHS and solve\n                LHS_mat = np.eye(N) - dt * A_func(t_nodes[m])\n                Y_new[m] = np.linalg.solve(LHS_mat, RHS)\n            \n            Y = Y_new # Update for next sweep\n        \n        return Y[-1]\n\n    # ====== 4. Construct Monodromy Matrix M and Affine Vector d ======\n    M = np.zeros((N, N))\n    I_N = np.eye(N)\n    b_zero = lambda t: np.zeros(N)\n    \n    for j in range(N):\n        e_j = I_N[:, j]\n        M[:, j] = sdc_integrate(e_j, b_zero)\n\n    d = sdc_integrate(np.zeros(N), b_func)\n\n    # ====== 5. Solve for Periodic Solution and Compute Residual ======\n    try:\n        y_star = np.linalg.solve(np.eye(N) - M, d)\n    except np.linalg.LinAlgError:\n        # Handle case where (I-M) is singular (1 is an eigenvalue)\n        return np.inf, np.inf, False\n\n    # Compute Phi_T(y_star) to find the residual\n    yT_star = sdc_integrate(y_star, b_func)\n    residual_norm = np.linalg.norm(yT_star - y_star)\n\n    # ====== 6. Compute Floquet Multipliers and Spectral Radius ======\n    floquet_multipliers = np.linalg.eigvals(M)\n    rho_M = np.max(np.abs(floquet_multipliers))\n    is_contraction = rho_M  1.0\n\n    return rho_M, residual_norm, is_contraction\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3416865"}]}