{"hands_on_practices": [{"introduction": "本练习为理解局部时间步进（LTS）奠定了基础。我们将探讨单元的属性——例如其尺寸和所用多项式的阶数——与其所能承受的最大稳定时间步长之间的基本关系，从而阐明LTS方法背后的核心动机（[@problem_id:3396758]）。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其定义在一个由三个尺寸分别为 $h_{1} = 1$，$h_{2} = 1/2$ 和 $h_{3} = 1/4$ 的单元组成的非均匀网格上。空间离散化在每个单元上采用多项式次数为 $p = 2$ 的间断伽辽金（DG）方法和迎风数值通量。时间积分采用3阶强稳定保持龙格－库塔方法（Strong Stability Preserving (SSP)–Runge–Kutta (RK3)）。假设平流速度为 $a = 1$，并且计算是无量纲化的，因此时间不带物理单位。\n\n设 $\\Delta t_{K}$ 表示在局部时间步进策略下，单元 $K$ 上的最大稳定局部时间步长。从线性系统的显式时间积分的稳定性要求和迎风通量下谱半径的标准DG估计出发，仅使用以下假设，推导出 $\\Delta t_{K}$ 对 $h_{K}$，$a$ 和 $p$ 的函数依赖关系：存在一个稳定性常数 $C(p)$，使得前向欧拉稳定时间步长满足 $\\Delta t_{\\mathrm{FE},K} \\le C(p)\\,h_{K}/|a|$，其中 $C(p) = 1/(2p+1)$。然后，考虑SSP–RK3方法，计算给定网格的三个局部时间步长 $\\Delta t_{1}$、$\\Delta t_{2}$ 和 $\\Delta t_{3}$。\n\n将每个 $\\Delta t_{K}$ 表示为精确分数；不要四舍五入或小数化。以行向量 $\\bigl[\\Delta t_{1},\\Delta t_{2},\\Delta t_{3}\\bigr]$ 的形式给出最终答案。", "solution": "用户希望我解决一个关于线性平流方程的间断伽辽金（DG）离散化的局部时间步进的数值分析问题。首先，我必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **控制方程**：一维线性平流方程，$u_{t} + a\\,u_{x} = 0$。\n- **平流速度**：$a = 1$。\n- **网格**：一个由三个尺寸分别为 $h_{1} = 1$，$h_{2} = 1/2$ 和 $h_{3} = 1/4$ 的单元组成的非均匀网格。\n- **空间离散化**：在每个单元上采用多项式次数为 $p = 2$ 的间断伽辽金（DG）方法。\n- **数值通量**：迎风通量。\n- **时间积分**：3阶强稳定保持龙格－库塔方法（SSP-RK3）。\n- **稳定性假设**：对于单元 $K$，前向欧拉稳定时间步长由 $\\Delta t_{\\mathrm{FE},K} \\le C(p)\\,h_{K}/|a|$ 给出。\n- **稳定性常数**：函数 $C(p)$ 定义为 $C(p) = 1/(2p+1)$。\n- **目标**：计算三个最大稳定局部时间步长 $\\Delta t_{1}$、$\\Delta t_{2}$ 和 $\\Delta t_{3}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行验证。\n- **科学依据**：该问题在偏微分方程数值方法的既定理论中有充分的依据。DG方法、SSP时间积分器和Courant-Friedrichs-Lewy (CFL) 稳定性条件都是计算科学与工程中的标准概念。对于使用DG和迎风通量离散化的一维线性平流方程，所提供的稳定性估计 $\\Delta t_{\\mathrm{FE},K} \\le \\frac{h_K}{(2p+1)|a|}$ 是一个已知的结果。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（$a$、$p$、$h_K$）和定义（特定的时间积分器和基本稳定性条件），以确定局部时间步长的唯一解。\n- **客观性**：该问题以精确、客观、无歧义的数学术语陈述。\n- **缺陷清单**：该问题没有违反任何指定的无效标准。它在科学上是合理的、可形式化的、完整的、现实的且结构良好。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n使用间断伽辽金方法对偏微分方程 $u_{t} + a\\,u_{x} = 0$ 进行半离散化，会得到每个单元上自由度所满足的常微分方程组（ODEs）。该系统可以抽象地写为 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}_h(\\mathbf{u})$，其中 $\\mathbf{L}_h$ 是空间离散算子。为了使显式时间积分格式稳定，所选的时间步长 $\\Delta t$ 必须满足：$\\Delta t$ 乘以 $\\mathbf{L}_h$ 的谱半径所得到的值位于时间积分器的稳定域内。\n\n问题提供了最简单的显式时间积分器——前向欧拉（FE）方法的稳定性约束。对于网格中的单元 $K$，前向欧拉方法下的最大稳定时间步长由下式给出：\n$$ \\Delta t_{\\mathrm{FE},K}^{\\max} = C(p)\\,\\frac{h_{K}}{|a|} $$\n根据所提供的定义 $C(p) = 1/(2p+1)$，这变为：\n$$ \\Delta t_{\\mathrm{FE},K}^{\\max} = \\frac{1}{2p+1} \\frac{h_{K}}{|a|} $$\n这是CFL条件的一种形式，特定于DG离散化。\n\n问题指定使用3阶强稳定保持龙格－库塔方法（SSP-RK3）。SSP方法的设计使得，对于给定的ODE系统，在任何对于前向欧拉方法稳定的时间步长 $\\Delta t$ 乘以一个称为SSP系数 $c$ 的因子后，该方法仍然保持稳定。SSP方法的稳定性条件是：\n$$ \\Delta t \\le c \\cdot \\Delta t_{\\mathrm{FE}}^{\\max} $$\n特定的SSP-RK3方法是指由Shu和Osher开发的流行的三阶、三步格式。此方法的一个基本且决定性的属性是其SSP系数为 $c=1$。因此，对于此方法，最大稳定时间步长与最大稳定前向欧拉时间步长相同。\n\n设 $\\Delta t_K$ 为使用SSP-RK3积分器在单元 $K$ 上的最大稳定局部时间步长。我们可以写出：\n$$ \\Delta t_{K} = c_{\\mathrm{SSP-RK3}} \\cdot \\Delta t_{\\mathrm{FE},K}^{\\max} $$\n由于 $c_{\\mathrm{SSP-RK3}} = 1$，我们有：\n$$ \\Delta t_{K} = \\Delta t_{\\mathrm{FE},K}^{\\max} = \\frac{1}{2p+1} \\frac{h_{K}}{|a|} $$\n该表达式给出了局部时间步长 $\\Delta t_K$ 对单元尺寸 $h_K$、平流速度 $a$ 和多项式次数 $p$ 的函数依赖关系。\n\n现在，我们可以代入问题陈述中给出的具体值：\n- 多项式次数：$p = 2$\n- 平流速度：$a = 1$\n\n首先，我们计算 $\\Delta t_K$ 表达式中的常数因子：\n$$ \\frac{1}{(2p+1)|a|} = \\frac{1}{(2(2)+1)|1|} = \\frac{1}{4+1} = \\frac{1}{5} $$\n因此，局部时间步长的公式简化为：\n$$ \\Delta t_{K} = \\frac{h_{K}}{5} $$\n\n现在我们将此公式应用于三个尺寸已知的单元：\n- 对于单元1，其 $h_{1} = 1$：\n$$ \\Delta t_{1} = \\frac{h_{1}}{5} = \\frac{1}{5} $$\n\n- 对于单元2，其 $h_{2} = 1/2$：\n$$ \\Delta t_{2} = \\frac{h_{2}}{5} = \\frac{1/2}{5} = \\frac{1}{10} $$\n\n- 对于单元3，其 $h_{3} = 1/4$：\n$$ \\Delta t_{3} = \\frac{h_{3}}{5} = \\frac{1/4}{5} = \\frac{1}{20} $$\n\n三个局部时间步长为 $\\Delta t_{1} = 1/5$、$\\Delta t_{2} = 1/10$ 和 $\\Delta t_{3} = 1/20$。最终答案应以行向量的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{5}  \\frac{1}{10}  \\frac{1}{20}\n\\end{pmatrix}\n}\n$$", "id": "3396758"}, {"introduction": "在局部稳定性概念的基础上，本练习深入探讨了整个耦合系统的稳定性。您将为一个特定的LTS调度构建全局更新算子，并通过其谱半径来分析其稳定性，揭示不同时间步长区域之间的相互作用如何影响整个方案的稳定性（[@problem_id:3396681]）。", "problem": "考虑长度为 $L=1$ 的周期性区域上的一维线性平流方程，其速度为恒定正值 $a>0$。该方程使用间断 Galerkin (DG) 方法进行离散化，在包含 $N$ 个单元的均匀网格上采用多项式次数 $p=0$（分片常数）。设网格单元宽度为 $h=L/N$。使用迎风数值通量和前向欧拉时间积分器，半离散系统可以写成向量形式 $\\frac{d\\mathbf{u}}{dt}=\\mathbf{A}\\mathbf{u}$，其中 $\\mathbf{u}\\in\\mathbb{R}^N$ 汇集了单元平均值，$\\mathbf{A}\\in\\mathbb{R}^{N\\times N}$ 是编码了带周期性边界条件的迎风 DG 耦合的循环矩阵。\n\n我们考虑一种局部时间步进 (LTS) 方案，该方案在周期性网格上交替使用两种时间步长级别：偶数索引的单元使用小步长 $\\Delta t_s$，奇数索引的单元使用大步长 $2\\Delta t_s$。在一个持续时间为 $T=2\\Delta t_s$ 的宏观步中，更新方案如下：\n- 第一子步：使用大小为 $\\Delta t_s$ 的前向欧拉步，同时更新所有偶数索引的单元（小步长集合），并使用此子步开始时最近邻居的状态。\n- 第二子步：再次使用大小为 $\\Delta t_s$ 的前向欧拉步，同时更新所有偶数索引的单元，并使用此子步开始时可用的当前邻居状态。\n- 第三子步：使用大小为 $2\\Delta t_s$ 的前向欧拉步，同时更新所有奇数索引的单元（大步长集合），并使用此子步开始时可用的当前邻居状态。\n\n对于 $a>0$ 的 $p=0$ DG 迎风离散化，单元 $i$ 上的半离散方程为\n$$\n\\frac{du_i}{dt} \\;=\\; -\\frac{a}{h}\\,\\big(u_i - u_{i-1}\\big),\n$$\n采用周期性索引。在给定时间，一个大小为 $\\Delta t$ 的前向欧拉步使用\n$$\nu_i^{\\text{new}} \\;=\\; u_i^{\\text{old}} \\;-\\; \\Delta t\\,\\frac{a}{h}\\,\\big(u_i^{\\text{old}} - u_{i-1}^{\\text{old}}\\big),\n$$\n同时应用于所选的索引集合。\n\n定义全局更新算子 $\\mathbf{G}\\in\\mathbb{R}^{N\\times N}$，它将状态从时间 $t^n$ 映射到由上述三子步 LTS 方案产生的时间 $t^{n+1}=t^n+T$。由于系统和更新是线性的，$\\mathbf{G}$ 是一个线性算子，可以通过将该方案应用于基向量来构建。\n\n对于 $p=0$ 迎风半离散化，强稳定性保持 (SSP) 前向欧拉时间步长限制是适用于任何显式步的 Courant–Friedrichs–Lewy (CFL) 条件 $a\\,\\Delta t / h \\le 1$。在具有两个级别的 LTS 设置中，这要求 $a\\,\\Delta t_s / h \\le 1$ 和 $a\\,(2\\Delta t_s)/h \\le 1$ 同时成立，即 $c \\equiv a\\,\\Delta t_s/h \\le 1/2$。\n\n您的任务是：\n- 对于所描述的 LTS 方案，通过在每个子步应用 $p=0$ DG 迎风前向欧拉更新，构建对应于一个宏观步 $T=2\\Delta t_s$ 的全局更新算子 $\\mathbf{G}$。\n- 计算谱半径 $\\rho(\\mathbf{G})$，其定义为 $\\mathbf{G}$ 的特征值的最大模。\n- 通过比较 $\\rho(\\mathbf{G})\\le 1$ 是否与 SSP 条件 $c\\le 1/2$ 一致，来验证其与 SSP 界的稳定性。\n\n使用以下具有周期性网格和交替时间步长级别的测试套件：\n- 测试 1：$N=8$, $a=1$, $c=0.45$，因此 $h=1/N$ 且 $\\Delta t_s = c\\,h/a$。\n- 测试 2：$N=8$, $a=1$, $c=0.50$，因此 $h=1/N$ 且 $\\Delta t_s = c\\,h/a$。\n- 测试 3：$N=8$, $a=1$, $c=0.55$，因此 $h=1/N$ 且 $\\Delta t_s = c\\,h/a$。\n- 测试 4：$N=8$, $a=1$, $c=0.10$，因此 $h=1/N$ 且 $\\Delta t_s = c\\,h/a$。\n\n对于每个测试，计算并报告由以下三项组成的三元组：\n- 谱半径 $\\rho(\\mathbf{G})$，四舍五入到六位小数，\n- 一个布尔值，指示 $\\rho(\\mathbf{G}) \\le 1$ 是否成立（使用适合浮点特征值计算的数值容差），\n- 一个布尔值，指示 SSP 界 $c \\le 1/2$ 是否成立。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有测试的结果，格式为逗号分隔的列表的列表，其中每个内部列表的形式为 $[\\rho,\\text{spectral\\_stable},\\text{ssp\\_ok}]$。例如，包含两个测试的输出可能如下所示：$[[0.999999,\\text{True},\\text{True}],[1.234567,\\text{False},\\text{False}]]$。", "solution": "该问题陈述是偏微分方程数值分析领域中一个适定 (well-posed) 的练习。它在科学上是合理的、自洽的，并提供了构建和分析指定局部时间步进 (LTS) 方案所需的所有必要信息。所有参数和过程都定义清晰。因此，该问题是有效的。\n\n核心任务是为一个应用于一维线性平流方程的间断 Galerkin (DG) 离散化的三子步 LTS 方案推导出全局更新算子 $\\mathbf{G}$，并随后通过计算其谱半径 $\\rho(\\mathbf{G})$ 来分析其稳定性。\n\n设宏观步开始时系统的状态为单元平均值向量 $\\mathbf{u}^n \\in \\mathbb{R}^N$。宏观步的持续时间为 $T = 2\\Delta t_s$。小时间步的常数 Courant 数定义为 $c = a\\Delta t_s/h$。\n\n单个单元 $i$ 在一个时间步长 $\\Delta t$ 内的前向欧拉更新由下式给出：\n$$\nu_i^{\\text{new}} = u_i^{\\text{old}} - \\frac{a \\Delta t}{h} (u_i^{\\text{old}} - u_{i-1}^{\\text{old}})\n$$\n其中索引按模 $N$ 周期性取值。\n\n我们将通过跟踪状态向量在 LTS 方案的三个子步中的变化来确定最终状态 $\\mathbf{u}^{n+1} = \\mathbf{G}\\mathbf{u}^n$。设 $\\mathbf{u}^{(0)} = \\mathbf{u}^n$。\n\n子步 1：使用步长 $\\Delta t_s$ 更新偶数索引的单元。\n对于 $i\\%2=0$（偶数）的单元 $i$，更新使用时间步长 $\\Delta t_s$，对应于 Courant 数 $c$。\n$$\nu_i^{(1)} = u_i^{(0)} - c (u_i^{(0)} - u_{i-1}^{(0)}) = (1-c)u_i^{(0)} + c u_{i-1}^{(0)} \\quad \\text{for } i \\text{ even}\n$$\n对于 $i\\%2=1$（奇数）的单元 $i$，状态保持不变。\n$$\nu_i^{(1)} = u_i^{(0)} \\quad \\text{for } i \\text{ odd}\n$$\n\n子步 2：再次使用步长 $\\Delta t_s$ 更新偶数索引的单元。此步的初始状态为 $\\mathbf{u}^{(1)}$。\n$$\nu_i^{(2)} = u_i^{(1)} - c (u_i^{(1)} - u_{i-1}^{(1)}) = (1-c)u_i^{(1)} + c u_{i-1}^{(1)} \\quad \\text{for } i \\text{ even}\n$$\n$$\nu_i^{(2)} = u_i^{(1)} \\quad \\text{for } i \\text{ odd}\n$$\n为了用 $\\mathbf{u}^{(0)}$ 表示 $\\mathbf{u}^{(2)}$，我们代入 $\\mathbf{u}^{(1)}$ 的表达式。\n对于偶数索引 $i$，索引 $i-1$ 是奇数。因此，$u_{i-1}^{(1)} = u_{i-1}^{(0)}$。\n$$\nu_i^{(2)} = (1-c) \\left( (1-c)u_i^{(0)} + c u_{i-1}^{(0)} \\right) + c u_{i-1}^{(0)} = (1-c)^2 u_i^{(0)} + c(1-c)u_{i-1}^{(0)} + c u_{i-1}^{(0)}\n$$\n$$\nu_i^{(2)} = (1-c)^2 u_i^{(0)} + c(2-c) u_{i-1}^{(0)} \\quad \\text{for } i \\text{ even}\n$$\n对于奇数索引 $i$，状态在前两个子步中保持不变：$u_i^{(2)} = u_i^{(1)} = u_i^{(0)}$。\n\n子步 3：使用步长 $2\\Delta t_s$ 更新奇数索引的单元。此步的初始状态为 $\\mathbf{u}^{(2)}$。对应的 Courant 数为 $a(2\\Delta t_s)/h = 2c$。\n$$\nu_i^{(3)} = u_i^{(2)} - 2c (u_i^{(2)} - u_{i-1}^{(2)}) = (1-2c)u_i^{(2)} + 2c u_{i-1}^{(2)} \\quad \\text{for } i \\text{ odd}\n$$\n$$\nu_i^{(3)} = u_i^{(2)} \\quad \\text{for } i \\text{ even}\n$$\n最终状态为 $\\mathbf{u}^{n+1} = \\mathbf{u}^{(3)}$。为了用 $\\mathbf{u}^{(0)}$ 表示 $\\mathbf{u}^{n+1}$，我们代入 $\\mathbf{u}^{(2)}$ 的表达式。\n对于偶数索引 $i$，状态在此子步中被冻结：\n$$\nu_i^{n+1} = u_i^{(2)} = (1-c)^2 u_i^{(0)} + c(2-c) u_{i-1}^{(0)} \\quad \\text{for } i \\text{ even}\n$$\n对于奇数索引 $i$，索引 $i-1$ 是偶数。我们代入 $u_i^{(2)}$ 和 $u_{i-1}^{(2)}$ 的表达式：\n$$\nu_i^{n+1} = (1-2c)u_i^{(0)} + 2c \\left( (1-c)^2 u_{i-1}^{(0)} + c(2-c) u_{i-2}^{(0)} \\right)\n$$\n$$\nu_i^{n+1} = (1-2c)u_i^{(0)} + 2c(1-c)^2 u_{i-1}^{(0)} + 2c^2(2-c) u_{i-2}^{(0)} \\quad \\text{for } i \\text{ odd}\n$$\n\n这些方程定义了线性变换 $\\mathbf{u}^{n+1} = \\mathbf{G}\\mathbf{u}^n$。矩阵 $\\mathbf{G}$ 可以根据这些关系构建。$\\mathbf{G}$ 的第 $i$ 行包含将 $\\mathbf{u}^n$ 的分量映射到 $u_i^{n+1}$ 的系数。设 $G_{ij}$ 为 $\\mathbf{G}$ 的第 $i$ 行第 $j$ 列的元素。\n如果 $i$ 是偶数：\n$$\nG_{i,i} = (1-c)^2\n$$\n$$\nG_{i, j} = c(2-c) \\quad \\text{for } j=(i-1) \\pmod N\n$$\n如果 $i$ 是奇数：\n$$\nG_{i,i} = 1-2c\n$$\n$$\nG_{i, j} = 2c(1-c)^2 \\quad \\text{for } j=(i-1) \\pmod N\n$$\n$$\nG_{i, k} = 2c^2(2-c) \\quad \\text{for } k=(i-2) \\pmod N\n$$\n$\\mathbf{G}$ 的所有其他元素均为零。\n\n该方案的稳定性由放大矩阵的谱半径 $\\rho(\\mathbf{G}) = \\max_j |\\lambda_j|$ 决定，其中 $\\{\\lambda_j\\}$ 是 $\\mathbf{G}$ 的特征值。该方案稳定的充要条件是 $\\rho(\\mathbf{G}) \\le 1$。问题要求验证此条件是否与从系统中最大时间步长推导出的强稳定性保持 (SSP) 条件 $a (2\\Delta t_s)/h \\le 1$（即 $c \\le 1/2$）相一致。\n\n对于指定的每个测试用例，我们将通过计算执行以下步骤：\n1.  对于给定的 $c$ 值和 $N=8$，构建 $N \\times N$ 矩阵 $\\mathbf{G}$。\n2.  使用数值库计算 $\\mathbf{G}$ 的特征值。\n3.  计算谱半径 $\\rho(\\mathbf{G})$，即所计算特征值的最大绝对值。\n4.  通过检查 $\\rho(\\mathbf{G}) \\le 1$（带有较小的浮点容差）来确定谱稳定性。\n5.  确定是否满足 SSP 条件 $c \\le 1/2$。\n6.  以指定格式报告结果。\n\n对于 $c \\le 1/2$，更新公式中的所有系数都是非负的。还可以验证，每行系数之和恰好为 $1$，这意味着 $\\mathbf{G}$ 是一个随机矩阵。根据非负矩阵的 Perron-Frobenius 定理，其谱半径恰好为 $1$。对于 $c > 1/2$，项 $1-2c$ 变为负值，谱半径可能超过 $1$。数值实验将证实这一理论预期。", "answer": "[[1.000000, True, True],[1.000000, True, True],[1.037840, False, False],[1.000000, True, True]]", "id": "3396681"}, {"introduction": "这个高级实践处理了将LTS应用于带有源项的物理模型（如浅水方程）时的一个关键挑战。您将首先识别出一个朴素的LTS方案如何破坏一个关键的物理特性——保均衡（well-balanced）的平衡态，然后设计一个修正的方案来保持这一特性，这突显了对数值方法进行精心协同设计的必要性（[@problem_id:3396698]）。", "problem": "考虑在一维固定床 $b(x)$ 上，平均深度为常数 $H>0$ 的静止状态附近线性化的一维浅水方程，\n$$\n\\eta_{t} + m_{x} = 0,\\qquad m_{t} + g H\\, \\eta_{x} = - g H\\, b_{x},\n$$\n其中 $\\eta(x,t)$ 是相对于 $H$ 的自由表面高程，$m(x,t)$ 是流量，$g$ 是重力加速度。静湖平衡定义为 $m(x,t)\\equiv 0$ 和 $\\eta(x,t) + b(x) \\equiv \\text{const}$，这是该偏微分方程组的一个稳态解。\n\n使用分片常数间断伽辽金（DG）方法，在两个共享界面为 $x_{1/2}$ 的相邻单元 $K_{L}$ 和 $K_{R}$ 上对该系统进行离散化。假设采用空间良态平衡的半离散化，使得对于静湖平衡，半离散残差为零。现在应用带有局部时间步进（LTS）的显式时间积分：左单元 $K_{L}$ 以大小为 $\\Delta>0$ 的宏观步长推进，而右单元 $K_{R}$ 以大小为 $\\Delta/3$ 的三个相等子步进行子循环。将三个子步的中点表示为 $t_{1}=\\Delta/6$，$t_{2}=\\Delta/2$ 和 $t_{3}=5\\Delta/6$。\n\n在共享界面处，由于在 $K_{R}$ 上使用了局部时间预测子，进入 $K_{L}$ 的（向右传播的）数值动量通量贡献在 $[0,\\Delta]$ 上表示为时间上的二次依赖关系，\n$$\nF(t)\\;=\\;A + B\\, t + C\\, t^{2},\n$$\n其中 $A$、$B$ 和 $C$ 是常数（在 $[0,\\Delta]$ 上不依赖于 $t$）。在精确的静湖平衡条件下，要与 $K_{L}$ 上的床坡源项抵消，需要 $F(t)$ 在 $[0,\\Delta]$ 上的时间积分与（同样是二次的）源项贡献 $S(t)$ 的时间积分相匹配。但一种朴素的LTS耦合使用了不匹配的时间求积方法：\n- 对于进入 $K_{L}$ 的界面通量，慢单元朴素地使用三个快子步通量值的等权重平均，即使用复合矩形法则 $\\frac{\\Delta}{3}\\sum_{k=1}^{3}F(t_{k})$。\n- 对于 $K_{L}$ 中的床坡源项，慢单元使用单步中点法则 $\\Delta\\, S(t_{2})$。\n\n假设在 $t\\in[0,\\Delta]$ 上 $S(t)\\equiv F(t)$，以反映连续介质层面上的良态平衡目标。从 $t=0$ 时的 $m\\equiv 0$ 开始，$K_{L}$ 上 $m$ 的朴素LTS更新通常不会保持为零。首先，通过计算伪净更新来给出一个稳态反例\n$$\n\\Delta m_{L}^{\\text{naive}} \\;=\\; \\frac{\\Delta}{\\Delta x}\\left(\\frac{\\Delta}{3}\\sum_{k=1}^{3}F(t_{k}) \\;-\\; \\Delta\\, F(t_{2})\\right),\n$$\n将其用系数 $C$ 和时间步长 $\\Delta$ 表示（你可以将 $\\Delta x>0$ 视为一个恒定的比例因子并提取因子 $1/\\Delta x$），从而明确地表明当 $C\\neq 0$ 时，朴素的LTS会破坏静湖平衡。\n\n接下来，为了在不改变子步时间 $\\{t_{k}\\}_{k=1}^{3}$ 的情况下修正这种不平衡，请在慢单元 $K_{L}$ 上设计一个支于相同节点 $\\{t_{1},t_{2},t_{3}\\}$ 且权重为 $\\{w_{1},w_{2},w_{3}\\}$ 的界面与源项时间求积，使得对于任意时间上的二次多项式 $Q(t)=\\alpha+\\beta t+\\gamma t^{2}$，该求积\n$$\n\\Delta \\sum_{k=1}^{3} w_{k}\\, Q(t_{k})\n$$\n精确等于其精确时间积分 $\\int_{0}^{\\Delta} Q(t)\\, dt$。该条件强制要求对于任何时间上的二次函数 $F(t)$ 和 $S(t)$，其界面和源项贡献都能精确抵消，从而在给定的LTS下恢复离散良态平衡性质。\n\n计算作为有理数的精确权重 $\\{w_{1},w_{2},w_{3}\\}$。以行向量 $\\bigl(w_{1},\\,w_{2},\\,w_{3}\\bigr)$ 的形式报告你的最终答案，并以精确分数形式书写。无需四舍五入，最终答案中不包含任何物理单位。", "solution": "该问题被验证为具有科学依据、适定且客观。它提出了偏微分方程数值分析中的一个标准问题，特别是关于局部时间步进下的良态平衡格式。题目包含了进行求解所需的所有信息。\n\n问题包括两个部分。首先，我们必须证明一个朴素的局部时间步进（LTS）格式会破坏保持静湖（良态平衡）的性质。其次，我们必须计算一组能够恢复此性质的求积权重。\n\n第1部分：朴素LTS格式中的伪更新。\n\n问题要求计算由以下公式给出的伪净更新 $\\Delta m_{L}^{\\text{naive}}$：\n$$\n\\Delta m_{L}^{\\text{naive}} = \\frac{\\Delta}{\\Delta x}\\left(\\frac{\\Delta}{3}\\sum_{k=1}^{3}F(t_{k}) - \\Delta F(t_{2})\\right)\n$$\n给定 $F(t) = A + B t + C t^2$ 和求积点 $t_1 = \\frac{\\Delta}{6}$，$t_2 = \\frac{\\Delta}{2}$ 以及 $t_3 = \\frac{5\\Delta}{6}$。我们需要计算括号中的项，它表示时间积分的两种朴素求积近似之间的差值。我们将此差值称为 $E_{quad}$。\n$$\nE_{quad} = \\frac{\\Delta}{3}\\sum_{k=1}^{3}F(t_{k}) - \\Delta F(t_{2})\n$$\n首先，我们在给定的时间点上计算 $F(t)$ 的值：\n$F(t_1) = A + B\\left(\\frac{\\Delta}{6}\\right) + C\\left(\\frac{\\Delta}{6}\\right)^2 = A + \\frac{B\\Delta}{6} + \\frac{C\\Delta^2}{36}$\n$F(t_2) = A + B\\left(\\frac{\\Delta}{2}\\right) + C\\left(\\frac{\\Delta}{2}\\right)^2 = A + \\frac{B\\Delta}{2} + \\frac{C\\Delta^2}{4}$\n$F(t_3) = A + B\\left(\\frac{5\\Delta}{6}\\right) + C\\left(\\frac{5\\Delta}{6}\\right)^2 = A + \\frac{5B\\Delta}{6} + \\frac{25C\\Delta^2}{36}$\n\n接下来，我们计算复合矩形法则所需的总和：\n$$\n\\sum_{k=1}^{3}F(t_{k}) = (A+A+A) + B\\Delta\\left(\\frac{1}{6}+\\frac{3}{6}+\\frac{5}{6}\\right) + C\\Delta^2\\left(\\frac{1}{36}+\\frac{9}{36}+\\frac{25}{36}\\right)\n$$\n$$\n\\sum_{k=1}^{3}F(t_{k}) = 3A + \\frac{3}{2}B\\Delta + \\frac{35}{36}C\\Delta^2\n$$\n第一个求积项是：\n$$\n\\frac{\\Delta}{3}\\sum_{k=1}^{3}F(t_{k}) = \\frac{\\Delta}{3}\\left(3A + \\frac{3}{2}B\\Delta + \\frac{35}{36}C\\Delta^2\\right) = A\\Delta + \\frac{1}{2}B\\Delta^2 + \\frac{35}{108}C\\Delta^3\n$$\n第二个求积项是：\n$$\n\\Delta F(t_2) = \\Delta\\left(A + \\frac{B\\Delta}{2} + \\frac{C\\Delta^2}{4}\\right) = A\\Delta + \\frac{1}{2}B\\Delta^2 + \\frac{1}{4}C\\Delta^3\n$$\n现在我们计算差值 $E_{quad}$：\n$$\nE_{quad} = \\left(A\\Delta + \\frac{1}{2}B\\Delta^2 + \\frac{35}{108}C\\Delta^3\\right) - \\left(A\\Delta + \\frac{1}{2}B\\Delta^2 + \\frac{1}{4}C\\Delta^3\\right)\n$$\n带有系数 $A$ 和 $B$ 的项相互抵消，因为两种求积法则对于 $[0, \\Delta]$ 上的常数函数和线性函数都是精确的（复合中点法则对线性函数是精确的，单步中点法则在该区间上也对线性函数精确）。误差来自于二次项：\n$$\nE_{quad} = \\left(\\frac{35}{108} - \\frac{1}{4}\\right)C\\Delta^3 = \\left(\\frac{35}{108} - \\frac{27}{108}\\right)C\\Delta^3 = \\frac{8}{108}C\\Delta^3 = \\frac{2}{27}C\\Delta^3\n$$\n将此结果代入伪更新的表达式中：\n$$\n\\Delta m_{L}^{\\text{naive}} = \\frac{\\Delta}{\\Delta x} E_{quad} = \\frac{\\Delta}{\\Delta x} \\left(\\frac{2}{27}C\\Delta^3\\right) = \\frac{2 C \\Delta^4}{27 \\Delta x}\n$$\n如果 $C \\neq 0$，这个表达式非零。由于单元 $K_L$ 中的动量初始为零，这个非零更新 $\\Delta m_L^{\\text{naive}}$ 表明，当通量和源项的时间依赖性具有非零的二次分量时，朴素的LTS耦合会破坏静湖状态的良态平衡性质。\n\n第2部分：设计一个良态平衡的求积方法。\n\n为了恢复良态平衡性质，我们需要一个对通量和源项都适用的单一求积法则，该法则对任何时间上的二次多项式都是精确的。设该求积由节点 $\\{t_1, t_2, t_3\\}$ 上的权重 $\\{w_1, w_2, w_3\\}$ 定义。条件是：\n$$\n\\int_{0}^{\\Delta} Q(t)\\, dt = \\Delta \\sum_{k=1}^{3} w_{k}\\, Q(t_{k})\n$$\n对于任何多项式 $Q(t) = \\alpha + \\beta t + \\gamma t^2$。根据线性性，我们只需对基多项式 $Q(t)=1$，$Q(t)=t$ 和 $Q(t)=t^2$ 强制执行此条件即可。\n\n1. 对于 $Q(t)=1$：\n$\\int_0^\\Delta 1\\, dt = \\Delta$。求积给出 $\\Delta(w_1 \\cdot 1 + w_2 \\cdot 1 + w_3 \\cdot 1)$。\n这导出我们的第一个方程：\n$$w_1 + w_2 + w_3 = 1$$\n\n2. 对于 $Q(t)=t$：\n$\\int_0^\\Delta t\\, dt = \\frac{\\Delta^2}{2}$。求积给出 $\\Delta(w_1 t_1 + w_2 t_2 + w_3 t_3)$。\n代入 $t_1=\\frac{\\Delta}{6}$，$t_2=\\frac{\\Delta}{2}$，$t_3=\\frac{5\\Delta}{6}$：\n$\\frac{\\Delta^2}{2} = \\Delta\\left(w_1\\frac{\\Delta}{6} + w_2\\frac{\\Delta}{2} + w_3\\frac{5\\Delta}{6}\\right) = \\frac{\\Delta^2}{6}(w_1 + 3w_2 + 5w_3)$。\n这导出我们的第二个方程：\n$$w_1 + 3w_2 + 5w_3 = 3$$\n\n3. 对于 $Q(t)=t^2$：\n$\\int_0^\\Delta t^2\\, dt = \\frac{\\Delta^3}{3}$。求积给出 $\\Delta(w_1 t_1^2 + w_2 t_2^2 + w_3 t_3^2)$。\n代入节点的平方 $t_1^2=\\frac{\\Delta^2}{36}$，$t_2^2=\\frac{\\Delta^2}{4}$，$t_3^2=\\frac{25\\Delta^2}{36}$：\n$\\frac{\\Delta^3}{3} = \\Delta\\left(w_1\\frac{\\Delta^2}{36} + w_2\\frac{\\Delta^2}{4} + w_3\\frac{25\\Delta^2}{36}\\right) = \\frac{\\Delta^3}{36}(w_1 + 9w_2 + 25w_3)$。\n这导出我们的第三个方程：\n$$w_1 + 9w_2 + 25w_3 = 12$$\n\n我们现在求解关于 $(w_1, w_2, w_3)$ 的线性方程组：\n(1) $w_1 + w_2 + w_3 = 1$\n(2) $w_1 + 3w_2 + 5w_3 = 3$\n(3) $w_1 + 9w_2 + 25w_3 = 12$\n\n(2)式减(1)式：\n$(3-1)w_2 + (5-1)w_3 = 3-1 \\implies 2w_2 + 4w_3 = 2 \\implies w_2 + 2w_3 = 1$ (4)\n\n(3)式减(2)式：\n$(9-3)w_2 + (25-5)w_3 = 12-3 \\implies 6w_2 + 20w_3 = 9$ (5)\n\n现在我们求解关于 $w_2$ 和 $w_3$ 的 $2 \\times 2$ 方程组。由(4)式，我们有 $w_2 = 1 - 2w_3$。将其代入(5)式：\n$6(1-2w_3) + 20w_3 = 9$\n$6 - 12w_3 + 20w_3 = 9$\n$8w_3 = 3 \\implies w_3 = \\frac{3}{8}$\n\n现在我们求 $w_2$：\n$w_2 = 1 - 2w_3 = 1 - 2\\left(\\frac{3}{8}\\right) = 1 - \\frac{6}{8} = 1 - \\frac{3}{4} = \\frac{1}{4}$\n\n最后，我们使用(1)式求 $w_1$：\n$w_1 = 1 - w_2 - w_3 = 1 - \\frac{1}{4} - \\frac{3}{8} = \\frac{8-2-3}{8} = \\frac{3}{8}$\n\n所需的权重为 $(w_1, w_2, w_3) = \\left(\\frac{3}{8}, \\frac{1}{4}, \\frac{3}{8}\\right)$。\n通过选择这些权重，时间积分近似对于任何二次多项式都是精确的。因此，如果 $S(t) \\equiv F(t)$，通量和源项的数值积分将完全相同，确保了它们在动量更新中相互抵消，从而恢复了LTS格式的良态平衡性质。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{8}  \\frac{1}{4}  \\frac{3}{8}\n\\end{pmatrix}\n}\n$$", "id": "3396698"}]}