{"hands_on_practices": [{"introduction": "通量限制器函数 $\\phi(r)$ 是高分辨率格式的“大脑”，它根据连续梯度的比值 $r$ 动态地调整格式的数值特性。这个练习将指导你计算在不同 $r$ 值下van Leer限制器的响应，从而亲身体会它如何在扩散性（平滑伪振荡）和压缩性（锐化间断）行为之间进行智能切换。通过这个基本计算，你将深入理解限制器如何感知解的局部光滑度并作出适应性调整。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a>0$ 为常数，该方程在均匀网格上通过一阶间断Galerkin (DG) 方法进行离散。为了在保持陡峭梯度的同时抑制非物理振荡，对每个单元内的重构线性解应用总变差递减 (TVD) 斜率限制器。设斜率更新由一个通量限制器函数 $\\phi(r)$ 定义，该函数作用于单元线性重构的连续差分之比 $r$，其中 $r$ 由 $r = \\Delta u_{i-1/2} / \\Delta u_{i+1/2}$ 给出，$\\Delta u_{i\\pm 1/2}$ 表示考虑了迎风方向的一致界面差分。假设该限制器是高分辨率有限体积和DG方法中使用的标准van Leer TVD限制器，并且 $r$ 是从三个不同的局部邻域数据计算得出的，分别为 $r=0.5$、$r=1$ 和 $r=2$。\n\n从通量限制器的TVD框架出发，不假设任何特定的快捷公式，计算van Leer限制器 $\\phi_{\\mathrm{VL}}(r)$ 在 $r=0.5$、$r=1$ 和 $r=2$ 处的值。然后，结合minmod和superbee限制器的行为，批判性地解释这些值如何反映DG重构中扩散行为（平滑小梯度）和压缩行为（保持或锐化大梯度）之间的转换。\n\n将最终答案表示为一个行矩阵，按顺序包含 $\\phi_{\\mathrm{VL}}(0.5)$、$\\phi_{\\mathrm{VL}}(1)$ 和 $\\phi_{\\mathrm{VL}}(2)$ 这三个值。无需四舍五入，不涉及单位。", "solution": "用户希望解决一个与间断Galerkin (DG) 方法中的斜率限制器相关的问题。\n\n**1. 问题验证**\n\n首先，我将验证所提供的问题陈述。\n\n**步骤1：提取已知条件**\n\n*   **控制方程：** 一维线性平流方程，$u_{t} + a\\,u_{x} = 0$，常波速 $a>0$。\n*   **数值方法：** 在均匀网格上采用一阶间断Galerkin (DG) 方法，并对“每个单元内的重构线性解”应用总变差递减 (TVD) 斜率限制器。这意味着使用分段线性多项式 ($P^1$)，这构成了一个二阶格式。\n*   **限制器函数：** 斜率更新由一个通量限制器函数 $\\phi(r)$ 定义。\n*   **光滑度比率：** 比率由 $r = \\Delta u_{i-1/2} / \\Delta u_{i+1/2}$ 给出，其中 $\\Delta u_{i\\pm 1/2}$ 是“考虑了迎风方向的一致界面差分”。\n*   **特定限制器：** van Leer TVD限制器，表示为 $\\phi_{\\mathrm{VL}}(r)$。\n*   **输入数据：** 比率 $r$ 取三个值：$r=0.5$、$r=1$ 和 $r=2$。\n*   **任务：**\n    1.  针对给定的 $r$ 值，计算van Leer限制器 $\\phi_{\\mathrm{VL}}(r)$ 的值。计算应从TVD框架开始。\n    2.  在扩散行为与压缩行为的背景下，并与minmod和superbee限制器相关联，解释这些值。\n*   **输出格式：** 一个包含 $\\phi_{\\mathrm{VL}}(0.5)$、$\\phi_{\\mathrm{VL}}(1)$ 和 $\\phi_{\\mathrm{VL}}(2)$ 三个计算值的行矩阵。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题牢固地建立在双曲型偏微分方程的数值分析领域。线性平流方程、间断Galerkin方法、TVD性质以及斜率/通量限制器（van Leer、minmod、superbee）是高分辨率格式中的标准和基本概念。\n*   **适定性：** 该问题是适定的。van Leer限制器是一个唯一定义的数学函数。任务是在特定点上评估此函数，并根据已建立的理论提供标准解释。存在一个唯一且有意义的解。\n*   **客观性：** 问题以精确、客观、技术性的语言陈述，没有任何主观或有偏见的措辞。\n\n该问题未表现出任何无效性缺陷：\n1.  它在科学上和事实上都是合理的。\n2.  它可以直接形式化，并与指定主题相关。\n3.  问题设定是完整的。虽然没有给出 $\\phi_{\\mathrm{VL}}(r)$ 的显式公式，但问题指导求解者从TVD框架开始，这意味着该公式需要根据其性质被回忆或证明，这对于此级别的分析是标准做法。“一阶间断Galerkin (DG) 方法”与“重构线性解”相结合的说法，尽管略显不精确，却是指代DG($P^1$)格式的一种常见方式，其内部是一致的。\n4.  条件并非不切实际或不可行。\n5.  问题不是病态的。\n6.  问题并非微不足道；它需要对守恒律数值格式理论有扎实的理解。\n7.  结果是数学上可验证的。\n\n**步骤3：结论与行动**\n\n问题是**有效的**。我将继续进行求解。\n\n**2. 求解推导**\n\n该问题探讨了在线性平流方程 $u_t + a u_x = 0$ 的高阶数值方法中应用斜率限制器。这类限制器的目标是确保格式是总变差递减 (TVD) 的，即它不会引入新的虚假振荡，同时在解的光滑区域保持高阶精度。\n\n在使用分段线性重构的DG或有限体积方法的背景下，计算单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$ 中的解由其单元平均值 $\\bar{u}_i$ 和一个斜率表示。该格式达到二阶精度，但在陡峭梯度附近可能产生过冲和下冲。为防止这种情况，初始计算的斜率会被修改或“限制”。\n\n这个限制过程通常方便地用一个通量限制器函数 $\\phi(r)$ 来表示。函数 $\\phi$ 根据解的局部光滑度来调节高阶项的贡献，局部光滑度由连续解梯度的比率 $r_i$ 来衡量。对于均匀网格和 $a>0$（迎风方向从左到右），该比率通常使用单元平均值定义为：\n$$r_i = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{\\bar{u}_{i+1} - \\bar{u}_i}$$\n为使一个格式成为TVD格式，限制器函数 $\\phi(r)$ 必须对 $r>0$ 满足某些条件。这些条件定义了由Sweby首次描述的 $(\\phi, r)$ 平面中的“TVD区域”：\n$$0 \\le \\phi(r) \\le 2$$\n$$0 \\le \\frac{\\phi(r)}{r} \\le 2 \\quad \\implies \\quad \\phi(r) \\le 2r$$\n为防止产生新的局部极值，还要求当 $r \\le 0$ 时 $\\phi(r) = 0$。\n\nvan Leer限制器 $\\phi_{\\mathrm{VL}}(r)$ 是 $\\phi(r)$ 的一个经典选择，它提供了一个平滑的过渡，并在精度和鲁棒性之间取得了平衡。它的定义源于它是一个位于TVD区域内的对称且光滑的函数。van Leer限制器的标准解析形式是：\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1+|r|}$$\n对于问题中指定的 $r > 0$ 的情况，有 $|r|=r$。公式简化为：\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + r}{1+r} = \\frac{2r}{1+r} \\quad \\text{for } r > 0$$\n此函数对于 $r>0$ 满足TVD条件：\n1.  $r>0 \\implies 2r > 0$ 且 $1+r > 1$，因此 $\\phi_{\\mathrm{VL}}(r) > 0$。同时，$2r < 2(1+r) \\implies \\frac{2r}{1+r} < 2$。因此，$0 \\le \\phi_{\\mathrm{VL}}(r) \\le 2$。\n2.  $\\frac{\\phi_{\\mathrm{VL}}(r)}{r} = \\frac{2}{1+r}$。对于 $r>0$，我们有 $1+r > 1$，这意味着 $0 < \\frac{2}{1+r} < 2$。因此，$0 \\le \\frac{\\phi_{\\mathrm{VL}}(r)}{r} \\le 2$。\n\n现在，我们为给定的输入计算 $\\phi_{\\mathrm{VL}}(r)$ 的值。\n\n对于 $r=0.5$:\n$$\\phi_{\\mathrm{VL}}(0.5) = \\frac{2 \\times 0.5}{1 + 0.5} = \\frac{1}{1.5} = \\frac{1}{3/2} = \\frac{2}{3}$$\n\n对于 $r=1$:\n$$\\phi_{\\mathrm{VL}}(1) = \\frac{2 \\times 1}{1 + 1} = \\frac{2}{2} = 1$$\n\n对于 $r=2$:\n$$\\phi_{\\mathrm{VL}}(2) = \\frac{2 \\times 2}{1 + 2} = \\frac{4}{3}$$\n\n**3. 解释与比较**\n\n$\\phi(r)$ 的值决定了数值格式在局部层面的特性。\n-   $\\phi(r)=0$ 将格式降为一阶（例如，迎风格式），这是高度耗散的。\n-   $\\phi(r)=1$ 对应于“线性”或无限制的二阶格式（例如，Lax-Wendroff类型），在光滑区域能保持精度。\n-   $0 < \\phi(r) < 1$ 表明格式比基准二阶格式更具耗散性。\n-   $\\phi(r) > 1$ 意味着“压缩性”或“反耗散”行为，此时限制器试图使梯度变陡，这对于解析像接触间断这样的尖锐特征是理想的。\n\n让我们将计算出的值与另外两个著名的限制器进行分析比较：高耗散的`minmod`限制器和高压缩性的`superbee`限制器。\n-   **Minmod:** $\\phi_{\\mathrm{min}}(r) = \\max(0, \\min(1, r))$\n-   **Superbee:** $\\phi_{\\mathrm{sup}}(r) = \\max(0, \\min(2r, 1), \\min(r, 2))$\n\n**情况1: $r=0.5$**\n该比率值表示上游梯度 $(\\bar{u}_i - \\bar{u}_{i-1})$ 是下游梯度 $(\\bar{u}_{i+1} - \\bar{u}_i)$ 大小的一半。这通常发生在光滑极值附近或波正在展宽的区域。\n-   $\\phi_{\\mathrm{VL}}(0.5) = 2/3 \\approx 0.67$。此值小于1，表明存在扩散行为。限制器减小了斜率以防止过冲，但不如`minmod`那样激进。\n-   作为比较：$\\phi_{\\mathrm{min}}(0.5) = 0.5$（更具耗散性），而 $\\phi_{\\mathrm{sup}}(0.5) = \\max(0, \\min(1,1), \\min(0.5,2)) = 1$（相对于二阶格式没有增加耗散）。\n-   van Leer限制器找到了一个折中方案，比`minmod`更温和地平滑剖面。\n\n**情况2: $r=1$**\n这对应于梯度恒定的区域，即一个完全光滑的线性剖面。\n-   $\\phi_{\\mathrm{VL}}(1) = 1$。限制器不对斜率做任何修改。\n-   这是任何二阶TVD格式的一个关键属性：在线性剖面上，格式必须是二阶精确的。`minmod` ($\\phi_{\\mathrm{min}}(1)=1$) 和 `superbee` ($\\phi_{\\mathrm{sup}}(1)=1$) 在 $r=1$ 时也得到1。\n\n**情况3: $r=2$**\n该比率表明梯度在流动方向上变得更陡，这是激波或陡峭波前脚点区域的特征。\n-   $\\phi_{\\mathrm{VL}}(2) = 4/3 \\approx 1.33$。此值大于1，展示了van Leer限制器的**压缩性**。它主动地锐化波前以抵抗数值耗散，从而为间断提供更清晰的剖面。\n-   作为比较：$\\phi_{\\mathrm{min}}(2) = \\min(1, 2) = 1$（非压缩性，在二阶贡献处进行裁剪），而 $\\phi_{\\mathrm{sup}}(2) = \\max(0, \\min(4,1), \\min(2,2)) = 2$（最大压缩性，位于TVD区域的上边界）。\n-   在这里，van Leer限制器在保持锐度方面比`minmod`更积极，但不如`superbee`，后者有时可能导致过于陡峭、呈“盒状”的剖面表示。\n\n总之，这三个计算值说明了van Leer限制器如何巧妙地从梯度减小区域的耗散特性 $(\\phi<1)$ 过渡到梯度增加区域的压缩特性 $(\\phi>1)$，同时在光滑线性区域保持二阶精度 $(\\phi=1)$。这种平衡的方法是它成为一个被广泛使用且有效的限制器的原因。\n\n要求的最终答案是为 $\\phi_{\\mathrm{VL}}(r)$ 计算出的值集。\n$\\phi_{\\mathrm{VL}}(0.5) = 2/3$\n$\\phi_{\\mathrm{VL}}(1) = 1$\n$\\phi_{\\mathrm{VL}}(2) = 4/3$\n\n这些值将以一个行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3} & 1 & \\frac{4}{3}\n\\end{pmatrix}\n}\n$$", "id": "3399885"}, {"introduction": "对于高于二阶的数值格式，例如使用高次多项式的间断Galerkin（DG）方法，仅仅限制斜率（一阶模态）已不足以完全控制伪振荡。这个练习将探讨如何将限制器的思想推广到更高阶的模态系数上，例如与解的曲率相关的二阶模态。你将实践如何在一个DG($P^2$)单元中，使用一个基于`minmod`准则的限制器来修正代表曲率的二阶模态，这是确保高阶格式稳定性的关键步骤。", "problem": "考虑在一个单元尺寸为 $h = 1$ 的均匀网格上，对一个光滑标量场进行的一维间断 Galerkin (DG) 近似。在索引为 $i$ 的给定单元上，映射到参考坐标 $\\xi \\in [-1,1]$ 上的近似解，使用勒让德多项式作为分层模态基，表示为\n$$\nu_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi),\n$$\n其中 $L_0(\\xi) = 1$，$L_1(\\xi) = \\xi$，以及 $L_2(\\xi) = \\frac{3\\xi^2 - 1}{2}$。给定的模态系数为 $\\bar{u}_i = 1.2$，$a_1 = 0.3$，$a_2 = -0.05$。相邻单元的平均值为 $\\bar{u}_{i-1} = 0.9$ 和 $\\bar{u}_{i+1} = 1.35$。\n\n您将仅对第二个模态 $a_2$ 应用一个基于 minmod 的限制器，该限制器使用由相邻单元平均值构造的曲率代理。具体来说：\n\n1. 从两个参数 $a$ 和 $b$ 的 minmod 函数定义开始，\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } \\operatorname{sign}(a) = \\operatorname{sign}(b),\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n以及物理坐标和参考坐标之间的仿射映射 $x = x_i + \\frac{h}{2}\\,\\xi$。\n\n2. 仅使用所选基的第一性原理，推导将第二模态系数 $a_2$ 与单元上的物理二阶导数 $u_{xx}$ 相关联的比例常数 $\\kappa$，然后将 $a_2$ 与相邻单元平均值的离散二阶差分\n$$\n\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}\n$$\n关联起来。将此关系表示为 $a_2 \\approx \\kappa\\,\\Delta^2 \\bar{u}_i$ 的形式，并解析地确定 $\\kappa$。\n\n3. 计算受限的第二模态系数\n$$\na_2^{\\mathrm{lim}} = \\operatorname{minmod}\\!\\big(a_2,\\;\\kappa\\,\\Delta^2 \\bar{u}_i\\big),\n$$\n并构造受限多项式\n$$\nu_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi).\n$$\n\n4. 在多项式次数为 $p=2$ 的高斯-洛巴托点，即在 $\\xi = -1$，$\\xi = 0$ 和 $\\xi = 1$ 处，计算 $u_i^{\\mathrm{lim}}(\\xi)$ 的值，并以单个行矩阵的形式报告这三个值。\n\n以一个行矩阵的形式提供您的最终答案，该矩阵包含受限多项式在高斯-洛巴托点处的三个值。不包括单位。如果您选择表达任何中间数值，请使用精确小数；无需四舍五入。", "solution": "首先通过提取所有给定信息并评估其科学合理性和形式结构来验证该问题。\n\n### 步骤 1：提取给定信息\n- **方法：** 一维间断 Galerkin (DG) 近似。\n- **网格：** 单元尺寸为 $h = 1$ 的均匀网格。\n- **单元：** 索引为 $i$。\n- **参考坐标：** $\\xi \\in [-1,1]$。\n- **基：** 使用勒让德多项式的分层模态基。\n- **解的表示：** $u_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi)$。\n- **勒让德多项式：** $L_0(\\xi) = 1$，$L_1(\\xi) = \\xi$，以及 $L_2(\\xi) = \\frac{3\\xi^2 - 1}{2}$。\n- **模态系数：** $\\bar{u}_i = 1.2$，$a_1 = 0.3$，$a_2 = -0.05$。\n- **相邻单元平均值：** $\\bar{u}_{i-1} = 0.9$，$\\bar{u}_{i+1} = 1.35$。\n- **Minmod 函数：** $\\operatorname{minmod}(a,b) = \\begin{cases} \\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } \\operatorname{sign}(a) = \\operatorname{sign}(b),\\\\ 0,  \\text{otherwise}. \\end{cases}$\n- **坐标映射：** $x = x_i + \\frac{h}{2}\\,\\xi$，其中 $x_i$ 是单元 $i$ 的中心。\n- **离散二阶差分：** $\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}$。\n- **限制器定义：** $a_2^{\\mathrm{lim}} = \\operatorname{minmod}\\!\\big(a_2,\\;\\kappa\\,\\Delta^2 \\bar{u}_i\\big)$。\n- **受限多项式：** $u_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi)$。\n- **求值点：** 多项式次数为 $p=2$ 的高斯-洛巴托点，即 $\\xi = -1, 0, 1$。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据：** 该问题牢固地建立在偏微分方程数值方法的既定原则之上，特别是高阶间断 Galerkin 方法和斜率/曲率限制技术。勒让德多项式、minmod 限制器和导数的有限差分近似的使用是该领域的标准做法。\n- **适定性：** 提供了所有必要的数据和定义。该问题是自洽的，并能导出一个唯一的、有意义的解。\n- **客观性：** 该问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它是科学上合理的、适定的和客观的。将提供解答。\n\n---\n\n解答过程首先推导比例常数 $\\kappa$，然后将限制器应用于第二模态系数 $a_2$，最后在指定点处计算得到的受限多项式的值。\n\n**1. 比例常数 $\\kappa$ 的推导**\n\n目标是找到模态系数 $a_2$ 与单元平均值的离散二阶差分 $\\Delta^2 \\bar{u}_i$ 之间的关系。这通过将这两个量都与解的物理二阶导数 $u_{xx}$ 关联起来实现。\n\n首先，我们将 $a_2$ 与 $u_{xx}$ 关联起来。从参考坐标 $\\xi$到物理坐标 $x$ 的映射由 $x = x_i + \\frac{h}{2}\\xi$ 给出。我们使用链式法则来关联关于 $x$ 和 $\\xi$ 的导数：\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi}\n$$\n根据该映射，我们有 $\\frac{dx}{d\\xi} = \\frac{h}{2}$，所以 $\\frac{d\\xi}{dx} = \\frac{2}{h}$。那么二阶导数是：\n$$\n\\frac{d^2}{dx^2} = \\frac{d}{dx}\\left(\\frac{2}{h}\\frac{d}{d\\xi}\\right) = \\frac{2}{h}\\frac{d\\xi}{dx}\\frac{d}{d\\xi}\\left(\\frac{d}{d\\xi}\\right) = \\left(\\frac{2}{h}\\right)^2 \\frac{d^2}{d\\xi^2} = \\frac{4}{h^2}\\frac{d^2}{d\\xi^2}\n$$\n单元内的解表示为 $u_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi) = \\bar{u}_i + a_1 \\xi + a_2 \\frac{3\\xi^2 - 1}{2}$。我们计算其关于 $\\xi$ 的二阶导数：\n$$\n\\frac{du_i}{d\\xi} = a_1 + a_2 (3\\xi) = a_1 + 3a_2\\xi\n$$\n$$\n\\frac{d^2u_i}{d\\xi^2} = 3a_2\n$$\n将此代入物理二阶导数 $u_{xx}$ 的表达式中：\n$$\nu_{xx} = \\frac{4}{h^2}\\frac{d^2u_i}{d\\xi^2} = \\frac{4}{h^2}(3a_2) = \\frac{12a_2}{h^2}\n$$\n这给出了单元内多项式近似的精确二阶导数。对 $a_2$ 求解：\n$$\na_2 = \\frac{h^2}{12}u_{xx}\n$$\n接下来，我们使用单元平均值上的二阶中心有限差分来近似单元中心 $x_i$ 处的物理二阶导数 $u_{xx}$：\n$$\nu_{xx}(x_i) \\approx \\frac{\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}}{h^2} = \\frac{\\Delta^2 \\bar{u}_i}{h^2}\n$$\n通过将单元内连续的二阶导数与其跨单元的离散近似相等，我们为 $a_2$ 建立了所需的关系：\n$$\na_2 \\approx \\frac{h^2}{12} \\left( \\frac{\\Delta^2 \\bar{u}_i}{h^2} \\right) = \\frac{1}{12}\\Delta^2 \\bar{u}_i\n$$\n从问题陈述的形式 $a_2 \\approx \\kappa\\,\\Delta^2 \\bar{u}_i$，我们确定比例常数为：\n$$\n\\kappa = \\frac{1}{12}\n$$\n问题指定了 $h=1$，这在推导中被隐式使用。此结果与 $h$ 无关。\n\n**2. 受限系数 $a_2^{\\mathrm{lim}}$ 的计算**\n\n我们现在计算 minmod 函数的两个参数。第一个参数是原始系数 $a_2 = -0.05$。第二个参数是 $\\kappa\\,\\Delta^2 \\bar{u}_i$。首先，我们计算 $\\Delta^2 \\bar{u}_i$：\n$$\n\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} = 1.35 - 2(1.2) + 0.9 = 1.35 - 2.4 + 0.9 = -0.15\n$$\n现在我们计算第二个参数：\n$$\n\\kappa\\,\\Delta^2 \\bar{u}_i = \\frac{1}{12} (-0.15) = -\\frac{0.15}{12} = -0.0125\n$$\n现在，我们应用 minmod 函数来找到受限系数 $a_2^{\\mathrm{lim}}$：\n$$\na_2^{\\mathrm{lim}} = \\operatorname{minmod}(a_2, \\kappa\\,\\Delta^2 \\bar{u}_i) = \\operatorname{minmod}(-0.05, -0.0125)\n$$\n由于两个参数都是负数，它们的符号相同。因此，\n$$\na_2^{\\mathrm{lim}} = \\operatorname{sign}(-0.05) \\min(|-0.05|, |-0.0125|) = -1 \\min(0.05, 0.0125) = -0.0125\n$$\n\n**3. 受限多项式的求值**\n\n受限多项式由以下公式给出：\n$$\nu_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi)\n$$\n代入已知值和勒让德多项式的表达式：\n$$\nu_i^{\\mathrm{lim}}(\\xi) = 1.2 + 0.3\\xi -0.0125\\left(\\frac{3\\xi^2 - 1}{2}\\right)\n$$\n我们在 $p=2$ 的高斯-洛巴托点，即 $\\xi = -1, 0, 1$ 处，计算该多项式的值。\n\n- 对于 $\\xi = -1$：\n$$\nu_i^{\\mathrm{lim}}(-1) = 1.2 + 0.3(-1) - 0.0125\\left(\\frac{3(-1)^2 - 1}{2}\\right) = 1.2 - 0.3 - 0.0125\\left(\\frac{3 - 1}{2}\\right) = 0.9 - 0.0125(1) = 0.8875\n$$\n\n- 对于 $\\xi = 0$：\n$$\nu_i^{\\mathrm{lim}}(0) = 1.2 + 0.3(0) - 0.0125\\left(\\frac{3(0)^2 - 1}{2}\\right) = 1.2 - 0.0125\\left(-\\frac{1}{2}\\right) = 1.2 + 0.00625 = 1.20625\n$$\n\n- 对于 $\\xi = 1$：\n$$\nu_i^{\\mathrm{lim}}(1) = 1.2 + 0.3(1) - 0.0125\\left(\\frac{3(1)^2 - 1}{2}\\right) = 1.2 + 0.3 - 0.0125\\left(\\frac{3 - 1}{2}\\right) = 1.5 - 0.0125(1) = 1.4875\n$$\n\n受限多项式在指定点处的三个值为 $0.8875$、$1.20625$ 和 $1.4875$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.8875 & 1.20625 & 1.4875 \\end{pmatrix}}\n$$", "id": "3399846"}, {"introduction": "在实践中，并不存在唯一的“最佳”限制器，每种限制器都代表了在锐度和无振荡性之间的一种权衡。本计算实验旨在揭示两种典型限制器——保守的`minmod`和激进的`superbee`——在光滑极值点附近的截然不同的行为，这也是检验TVD格式性能的一个经典难题。通过这个实践，你将验证`minmod`限制器保持单调性的能力，并量化`superbee`限制器产生过冲的倾向，从而对如何在具体应用中选择合适的限制器获得深刻的直觉。", "problem": "考虑一维标量守恒律 $u_t + a\\,u_x = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数。在单元宽度为 $h > 0$ 的均匀网格上进行间断Galerkin (DG) 空间离散。在每个单元上，DG近似在参考区间 $\\xi \\in [-1,1]$ 上以模态Legendre基 $\\{P_k(\\xi)\\}_{k=0}^p$ 表示，并映射到物理坐标 $x = c + \\frac{h}{2}\\,\\xi$，其中 $c$ 是单元中心，$p \\in \\mathbb{N}$ 是多项式阶数。模态系数 $a_k$ 是初始条件在 $P_k(\\xi)$ 上的 $L^2$ 投影，由 $a_k = \\frac{2k+1}{2} \\int_{-1}^{1} u\\!\\left(c + \\tfrac{h}{2}\\,\\xi\\right) P_k(\\xi)\\,\\mathrm{d}\\xi$ 给出，单元上的DG多项式为 $u_h(\\xi) = \\sum_{k=0}^{p} a_k P_k(\\xi)$。由于 $P_0(\\xi)=1$，单元平均值等于 $a_0$。\n\n斜率限制器作用于单元平均值的单元间差分，以修改邻近光滑极值点的单调单元中的第一模态 $a_1$。为中心点分别为 $c_{-2}=-2h$, $c_{-1}=-h$, $c_0=0$, $c_1=h$, $c_2=2h$ 的五个连续单元定义单元平均值 $a_0^{(i)}$。对于每个单调的相邻单元 $i \\in \\{-1,1\\}$，定义后向和前向差分 $d_-^{(i)} = a_0^{(i)} - a_0^{(i-1)}$ 和 $d_+^{(i)} = a_0^{(i+1)} - a_0^{(i)}$。斜率限制器根据这些差分生成一个受限斜率 $s^{(i)}$。minmod限制器定义为 $s^{(i)} = \\operatorname{minmod}(d_-^{(i)}, d_+^{(i)})$，其中 $\\operatorname{minmod}(a,b) = \\begin{cases} \\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\ 0,  \\text{otherwise.} \\end{cases}$。superbee限制器定义为 $s^{(i)} = \\operatorname{superbee}(d_-^{(i)}, d_+^{(i)})$，其中 $\\operatorname{superbee}(a,b) = \\begin{cases} \\max\\left(0, \\min(2|a|, |b|), \\min(|a|, 2|b|)\\right)\\,\\operatorname{sign}(b),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\ 0,  \\text{otherwise.} \\end{cases}$。在这两种情况下，将受限的第一模态系数设为 $a_1^{(i)} \\leftarrow \\tfrac{1}{2}\\,s^{(i)}$，所有更高阶的模态系数 $a_k$ ($k \\ge 2$) 保持不变。\n\n通过 $u_0(x) = 1 - x^2 + \\alpha x^4$ (固定 $\\alpha > 0$) 构建一个在 $x=0$ 处具有二阶连续可微 ($C^2$) 极值的光滑初始条件。该函数在 $x=0$ 处有一个光滑极大值，满足 $u_0(0)=1$ 和 $u_0''(0) = -2$。如上所述，将 $u_0(x)$ 投影到五个单元 $\\{c_{-2},c_{-1},c_{0},c_{1},c_{2}\\}$ 中阶数为 $p$ 的DG多项式上。按前述方法，对相邻单元 $i=-1$ 和 $i=1$ 分别应用minmod限制器和superbee限制器。对于每种受限情况，通过在 $\\xi \\in [-1,1]$ 的一个稠密点集上对 $u_h(\\xi)$ 进行采样，并取两个单元上的最大值，来计算这两个相邻单元中DG近似的点态最大值。\n\n您的任务是：\n1. 通过基于这些定义的计算表明，minmod限制器在单调的相邻单元中不会引入新的极值点；形式上，当以足够精细的分辨率采样时，受限的DG多项式应在每个相邻单元内保持单调。\n2. 通过计算表明，由于其更激进的斜率选择，superbee限制器可能在单调的相邻单元中产生相对于minmod限制重构的过冲。通过计算superbee限制和minmod限制的DG多项式在两个相邻单元上的最大点态值之差，来量化过冲幅度，将其表示为多项式阶数 $p$ 和单元宽度 $h$ 的函数。\n\n纯粹以数学术语进行，不假设任何特定的物理单位。不涉及角度。输出应以编程的、可测试的方式对验证和量化进行编码。\n\n测试套件和所需输出：\n- 使用固定参数 $\\alpha = 1$。\n- 评估以下五个 $(p,h)$ 测试用例：\n  1. $(p,h) = (1, 0.5)$\n  2. $(p,h) = (2, 0.5)$\n  3. $(p,h) = (3, 0.2)$\n  4. $(p,h) = (5, 0.1)$\n  5. $(p,h) = (10, 0.05)$\n对于每个测试用例，生成一个包含以下内容的数据对：\n- 一个布尔值，指示在精细网格上采样时，minmod限制的DG多项式在相邻单元中是否保持单调（无新极值点）。\n- 一个非负浮点数，给出superbee限制的DG重构相对于minmod限制的重构的过冲幅度，定义为superbee限制和minmod限制的DG多项式在两个相邻单元上的最大点态值之差。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素对应一个测试用例，本身是 $[\\text{布尔值}, \\text{浮点数}]$ 形式的列表。例如，输出应类似于 $[[\\text{True},0.00123],[\\text{True},0.00004],\\ldots]$。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在守恒律数值方法理论中具有科学依据，特别是关于在间断Galerkin (DG) 框架内应用斜率限制器。该问题是适定的，所有必要的定义、参数和计算任务都已明确指定。语言客观且数学上精确。因此，我将着手提供一个完整的解决方案。\n\n问题的核心是分析两种常见的斜率限制器minmod和superbee在应用于具有局部极值的光滑函数的DG重构时的行为。我们将计算这些限制器对极值点相邻单元中DG多项式的影响，并量化它们在单调性和过冲方面的性质。\n\n该过程包括以下步骤：\n1.  对于由多项式阶数 $p$ 和单元宽度 $h$ 定义的每个测试用例，我们考虑五个以 $c_i = ih$ 为中心的空间单元 $I_i = [c_i - h/2, c_i + h/2]$，其中 $i \\in \\{-2, -1, 0, 1, 2\\}$。\n2.  在每个单元 $I_i$ 中，我们将初始条件 $u_0(x) = 1 - x^2 + x^4$ 投影到Legendre多项式的DG基 $\\{P_k(\\xi)\\}_{k=0}^p$ 上。这涉及使用以下公式计算模态系数 $a_k^{(i)}$ ($k=0, \\dots, p$)：\n    $$\n    a_k^{(i)} = \\frac{2k+1}{2} \\int_{-1}^{1} u_0\\left(c_i + \\frac{h}{2}\\xi\\right) P_k(\\xi)\\,\\mathrm{d}\\xi\n    $$\n    积分通过数值积分执行，因为对于计算任务而言，解析解既繁琐又不必要。单元 $I_i$ 中的单元平均值由第零模态系数 $a_0^{(i)}$ 给出。\n3.  对于邻近中心极值点的两个单元 $I_{-1}$ 和 $I_1$，我们应用斜率限制器。对于由 $i \\in \\{-1, 1\\}$ 索引的每个单元，我们计算单元平均值的后向和前向差分：\n    $$\n    d_-^{(i)} = a_0^{(i)} - a_0^{(i-1)} \\quad \\text{and} \\quad d_+^{(i)} = a_0^{(i+1)} - a_0^{(i)}\n    $$\n4.  使用问题中定义的 `minmod` 和 `superbee` 函数，利用这些差分计算受限斜率 $s^{(i)}$。\n    minmod限制器为：\n    $$\n    s_{\\text{minmod}}^{(i)} = \\operatorname{minmod}(d_-^{(i)}, d_+^{(i)}) = \\begin{cases} \\operatorname{sign}(d_-^{(i)})\\,\\min(|d_-^{(i)}|,|d_+^{(i)}|),  \\text{if } \\operatorname{sign}(d_-^{(i)})=\\operatorname{sign}(d_+^{(i)}), \\\\ 0,  \\text{otherwise.} \\end{cases}\n    $$\n    superbee限制器为：\n    $$\n    s_{\\text{superbee}}^{(i)} = \\operatorname{superbee}(d_-^{(i)}, d_+^{(i)}) = \\begin{cases} \\max\\left(0, \\min(2|d_-^{(i)}|, |d_+^{(i)}|), \\min(|d_-^{(i)}|, 2|d_+^{(i)}|)\\right)\\,\\operatorname{sign}(d_+^{(i)}),  \\text{if } \\operatorname{sign}(d_-^{(i)})=\\operatorname{sign}(d_+^{(i)}), \\\\ 0,  \\text{otherwise.} \\end{cases}\n    $$\n5.  代表单元内多项式线性斜率的第一模态系数 $a_1^{(i)}$ 被更新。原始的更高阶系数 ($k \\ge 2$) 被保留。\n    $$\n    a_{1,\\text{lim}}^{(i)} \\leftarrow \\frac{1}{2}\\,s^{(i)}\n    $$\n    这为每个相邻单元生成了两组新的模态系数： $\\{a_{k,\\text{minmod}}^{(i)}\\}$ 和 $\\{a_{k,\\text{superbee}}^{(i)}\\}$。\n6.  然后重构受限的DG多项式：\n    $$\n    u_{h,\\text{limiter}}^{(i)}(\\xi) = \\sum_{k=0}^{p} a_{k,\\text{limiter}}^{(i)} P_k(\\xi)\n    $$\n7.  为完成这两个任务，我们分析这些重构的多项式。\n    - **单调性检查**：对于minmod限制器，我们在 $\\xi \\in [-1,1]$ 的精细点网格上评估 $u_{h,\\text{minmod}}^{(i)}(\\xi)$ (对于 $i \\in \\{-1,1\\}$)。由于单元 $I_{-1}$ 位于 $x=0$ 处最大值的左侧，我们期望一个非减多项式。由于单元 $I_1$ 位于右侧，我们期望一个非增多项式。我们检查这些单调性是否成立。一个布尔值代表跨越两个单元的此项检查的结果。\n    - **过冲量化**：我们为每种限制器类型找到两个相邻单元上受限多项式的最大点态值。\n      $$\n      M_{\\text{minmod}} = \\max\\left( \\max_{\\xi \\in [-1,1]} u_{h,\\text{minmod}}^{(-1)}(\\xi), \\max_{\\xi \\in [-1,1]} u_{h,\\text{minmod}}^{(1)}(\\xi) \\right)\n      $$\n      $$\n      M_{\\text{superbee}} = \\max\\left( \\max_{\\xi \\in [-1,1]} u_{h,\\text{superbee}}^{(-1)}(\\xi), \\max_{\\xi \\in [-1,1]} u_{h,\\text{superbee}}^{(1)}(\\xi) \\right)\n      $$\n      然后，过冲幅度计算为非负差值 $M_{\\text{superbee}} - M_{\\text{minmod}}$。\n\n所要求的测试用例将按照此过程进行处理，结果将被编译成指定的输出格式。初始条件 $u_0(x)$ 的对称性以及围绕 $x=0$ 的单元排列意味着单元 $I_i$ 和 $I_{-i}$ 中的系数之间存在特定关系（例如，$a_k^{(-i)} = (-1)^k a_k^{(i)}$），但为了通用性和鲁棒性，实现将执行完整的计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import legendre\nfrom scipy.integrate import quad\nfrom numpy.polynomial.legendre import Legendre\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    \n    # Define the initial condition u0(x) = 1 - x^2 + alpha * x^4 with alpha = 1.\n    def u0(x):\n        return 1.0 - x**2 + x**4\n\n    def minmod(a, b):\n        \"\"\"\n        Calculates the minmod of two numbers.\n        \"\"\"\n        if np.sign(a) != np.sign(b):\n            return 0.0\n        return np.sign(a) * min(abs(a), abs(b))\n\n    def superbee(a, b):\n        \"\"\"\n        Calculates the superbee limiter of two numbers.\n        \"\"\"\n        if np.sign(a) != np.sign(b):\n            return 0.0\n        # The result's sign is determined by sign(b) as specified.\n        return np.sign(b) * max(0.0, min(2 * abs(a), abs(b)), min(abs(a), 2 * abs(b)))\n\n    def run_analysis(p, h):\n        \"\"\"\n        Performs the DG projection and limiter analysis for a given (p, h) case.\n        \"\"\"\n        # 1. Define cell structure\n        cell_indices = range(-2, 3)\n        cell_centers = {i: i * h for i in cell_indices}\n\n        # 2. Compute modal coefficients for each of the 5 cells\n        coeffs = {}\n        for i in cell_indices:\n            c_i = cell_centers[i]\n            coeffs_i = np.zeros(p + 1)\n            for k in range(p + 1):\n                # Integrand for the L2 projection\n                integrand = lambda xi: u0(c_i + h / 2.0 * xi) * legendre(k)(xi)\n                # Numerical integration using quad\n                integral, _ = quad(integrand, -1, 1, epsabs=1e-14, epsrel=1e-14)\n                coeffs_i[k] = (2 * k + 1) / 2.0 * integral\n            coeffs[i] = coeffs_i\n\n        # 3. Apply limiters to neighbor cells i = -1 and i = 1\n        a0 = {i: coeffs[i][0] for i in cell_indices}\n        \n        coeffs_minmod = {i: np.copy(coeffs[i]) for i in [-1, 1]}\n        coeffs_superbee = {i: np.copy(coeffs[i]) for i in [-1, 1]}\n        \n        if p >= 1:\n            for i in [-1, 1]:\n                # 3a. Compute differences of cell averages\n                d_minus = a0[i] - a0[i-1]\n                d_plus = a0[i+1] - a0[i]\n                \n                # 3b. Apply minmod limiter\n                s_minmod = minmod(d_minus, d_plus)\n                coeffs_minmod[i][1] = 0.5 * s_minmod\n                \n                # 3c. Apply superbee limiter\n                s_superbee = superbee(d_minus, d_plus)\n                coeffs_superbee[i][1] = 0.5 * s_superbee\n\n        # 4. Analyze the limited polynomials\n        num_pts = max(101, 20 * p + 1)\n        xi_grid = np.linspace(-1, 1, num_pts)\n        \n        # 4a. Task 1: Check monotonicity of minmod-limited polynomials\n        is_monotone = True\n        \n        # Cell i = -1 (left of extremum, expecting non-decreasing)\n        poly_vals_minmod_m1 = Legendre(coeffs_minmod[-1])(xi_grid)\n        diffs_m1 = np.diff(poly_vals_minmod_m1)\n        # Use a small tolerance for floating point comparisons\n        if not np.all(diffs_m1 >= -1e-12):\n            is_monotone = False\n            \n        # Cell i = 1 (right of extremum, expecting non-increasing)\n        poly_vals_minmod_p1 = Legendre(coeffs_minmod[1])(xi_grid)\n        diffs_p1 = np.diff(poly_vals_minmod_p1)\n        if not np.all(diffs_p1 <= 1e-12):\n            is_monotone = False\n\n        # 4b. Task 2: Quantify superbee overshoot relative to minmod\n        # Find max value of minmod-limited polynomials across both cells\n        global_max_minmod = max(np.max(poly_vals_minmod_m1), np.max(poly_vals_minmod_p1))\n        \n        # Find max value of superbee-limited polynomials across both cells\n        poly_vals_superbee_m1 = Legendre(coeffs_superbee[-1])(xi_grid)\n        poly_vals_superbee_p1 = Legendre(coeffs_superbee[1])(xi_grid)\n        global_max_superbee = max(np.max(poly_vals_superbee_m1), np.max(poly_vals_superbee_p1))\n        \n        overshoot = max(0.0, global_max_superbee - global_max_minmod)\n        \n        return [is_monotone, overshoot]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1, 0.5),\n        (2, 0.5),\n        (3, 0.2),\n        (5, 0.1),\n        (10, 0.05),\n    ]\n\n    results = []\n    for p, h in test_cases:\n        result = run_analysis(p=p, h=h)\n        results.append(f\"[{result[0]},{result[1]:.16f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3399809"}]}