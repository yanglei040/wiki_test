{"hands_on_practices": [{"introduction": "为了有效实践谱方法滤波，我们首先必须从根本上理解其作用方式。滤波可以在物理空间（节点空间）中通过卷积核来实现，也可以在谱空间（模态空间）中通过对模态系数进行乘法运算来实现。此练习将引导您运用第一性原理，探讨这两种看似不同的方法之间的深刻联系，并明确在何种条件下它们是等价的[@problem_id:3418285]。通过辨析这些基本关系，您将能更深入地理解为何模态滤波因其高效性而成为谱方法中的首选稳定化工具。", "problem": "考虑一个单一的参考单元 $\\Omega = [-1,1]$ 和由勒让德多项式 $\\{P_k(x)\\}_{k=0}^N$ 张成的多项式逼近空间 $\\mathbb{P}_N$。令 $\\{x_i\\}_{i=0}^N$ 为 $\\Omega$ 上任意一组不同的插值节点，令 $\\{w_i\\}_{i=0}^N$ 为具有正权重的相关求积法则。函数 $u \\in \\mathbb{P}_N$ 的节点表示是向量 $\\mathbf{u}^n \\in \\mathbb{R}^{N+1}$，其元素为 $u(x_i)$；而模态表示是向量 $\\hat{\\mathbf{u}} \\in \\mathbb{R}^{N+1}$，其元素为 $\\hat{u}_k$，使得 $u(x) = \\sum_{k=0}^N \\hat{u}_k P_k(x)$。令 $V \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 为范德蒙矩阵，其元素为 $V_{ik} = P_k(x_i)$，因此有 $\\mathbf{u}^n = V \\hat{\\mathbf{u}}$。\n\n通过一个紧支撑的对称核 $K : \\Omega \\times \\Omega \\to \\mathbb{R}$ 定义一个线性的、单元局域的物理空间滤波器，其作用方式如下\n$$\n(\\mathcal{K} u)(x) = \\int_{-1}^1 K(x,\\xi)\\,u(\\xi)\\,d\\xi.\n$$\n使用求积法则的节点实现是\n$$\nu_f(x_i) = \\sum_{j=0}^N w_j\\,K(x_i,x_j)\\,u(x_j), \\quad i=0,\\dots,N,\n$$\n这定义了一个节点滤波矩阵 $G \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，其元素为 $G_{ij} = w_j K(x_i,x_j)$。模态（谱）滤波器被定义为对模态系数进行对角作用，即 $\\hat{u}_k \\mapsto \\sigma_k \\hat{u}_k$，其中 $\\{\\sigma_k\\}_{k=0}^N$ 是预先设定的标量。\n\n仅使用关于线性算子、$\\Omega$ 上的正交多项式基以及卷积定义的第一性原理，判断以下哪些陈述是正确的。假设算术是精确的，并且当出现此类假设时，求积法则对所有阶数达到所规定阶数的多项式被积函数都是精确的。\n\nA. 对于一个在 $\\Omega \\times \\Omega$ 上为常数的对称紧凑核的单元局域物理空间滤波器，节点卷积等效于一个对角模态滤波器，其权重是核的傅里叶变换在勒让德模态阶数处求得的值。\n\nB. 如果核具有可分离展开式\n$$\nK(x,\\xi) = \\sum_{k=0}^N \\sigma_k\\,\\frac{2k+1}{2}\\,P_k(x)\\,P_k(\\xi),\n$$\n并且离散内积 $\\langle p,q\\rangle_h = \\sum_{i=0}^N w_i\\,p(x_i)\\,q(x_i)$ 对所有阶数最高为 $2N$ 的多项式乘积都是精确的，那么由 $G$ 定义的节点卷积在模态空间中完全等效于将每个模态系数乘以 $\\sigma_k$。\n\nC. 对于任何支撑严格位于 $\\Omega$ 内部（即，在边界的邻域内消失）的对称紧凑核，以勒让德模态基表示的节点卷积矩阵是严格下三角的，除非核是常数。\n\nD. 如果核在 $(\\mathcal{K} p)(x) = p(x)$ 对于所有多项式 $p \\in \\mathbb{P}_M$ 成立的意义上能够重现最高为 $M$ 阶的多项式，那么相关的模态滤波器满足对于所有 $k \\le M$，有 $\\sigma_k = 1$。\n\nE. 在一个通过最高为 $N$ 阶的全局三角多项式离散化并使用精确求积的周期性域上，一个平移不变的紧凑核产生的卷积算子在傅里叶模态基中是对角的，其特征值等于在相应波数处核采样的离散傅里叶变换。\n\n选择所有正确的陈述。", "solution": "该问题陈述是数值分析领域的一个有效练习，具体涉及微分方程谱方法理论。所有定义都是标准的，各项命题是定义明确的数学陈述，可以使用线性代数、逼近理论和正交多项式的第一性原理来证明或证伪。\n\n我们来建立物理空间节点滤波矩阵 $G$ 与其模态空间表示（我们将其记为 $\\hat{G}$）之间的联系。一个函数 $u(x) = \\sum_{k=0}^N \\hat{u}_k P_k(x)$ 有一个节点值向量 $\\mathbf{u}^n$ 和一个模态系数向量 $\\hat{\\mathbf{u}}$。它们通过范德蒙矩阵 $V$（其元素为 $V_{ik} = P_k(x_i)$）相关联，即 $\\mathbf{u}^n = V\\hat{\\mathbf{u}}$。节点滤波器是作用于节点值的线性变换，$\\mathbf{u}_f^n = G\\mathbf{u}^n$。滤波后的函数 $u_f(x)$ 对应一组新的模态系数 $\\hat{\\mathbf{u}}_f$。代入模态表示，我们得到 $V\\hat{\\mathbf{u}}_f = G(V\\hat{\\mathbf{u}})$。由于节点 $\\{x_i\\}$ 是不同的，并且 $\\{P_k(x)\\}$ 构成了 $\\mathbb{P}_N$ 的一个基，范德蒙矩阵 $V$ 是可逆的。因此，模态空间中的变换由 $\\hat{\\mathbf{u}}_f = (V^{-1}GV)\\hat{\\mathbf{u}}$ 给出。滤波器的模态表示是矩阵 $\\hat{G} = V^{-1}GV$。一个“模态滤波器”被定义为模态空间中的对角算子，这意味着 $\\hat{G}$ 必须是一个对角矩阵，其元素为 $\\sigma_k$。\n\n我们来分析每个陈述。\n\n### 选项 A\n该陈述考虑了一个常数核，$K(x,\\xi) = c$，其中 $c \\in \\mathbb{R}$ 为某个常数。节点滤波操作给出了滤波后的节点值 $u_f(x_i)$：\n$$\nu_f(x_i) = \\sum_{j=0}^N w_j K(x_i,x_j) u(x_j) = c \\sum_{j=0}^N w_j u(x_j).\n$$\n这个和 $\\sum_{j=0}^N w_j u(x_j)$ 是一个单一的标量值，它是积分 $\\int_{-1}^1 u(x) dx$ 的求积近似。令这个标量为 $C_u = \\sum_{j=0}^N w_j u(x_j)$。那么对于所有的 $i=0,\\dots,N$，有 $u_f(x_i) = c C_u$。\n由于滤波后的节点值都相同，插值这些值的唯一多项式 $u_f(x) \\in \\mathbb{P}_N$ 必须是一个常数多项式，$u_f(x) = c C_u$。\n在勒让德模态基中，常数函数 $A$ 的表示为 $A P_0(x)$，因为 $P_0(x)=1$。因此，$u_f(x)$ 的模态系数为 $\\hat{u}_{f,0} = c C_u$ 且当 $k > 0$ 时 $\\hat{u}_{f,k} = 0$。\n原始函数是 $u(x) = \\sum_{m=0}^N \\hat{u}_m P_m(x)$。项 $C_u$ 可以用模态系数 $\\hat{u}_m$ 表示：\n$$\nC_u = \\sum_{j=0}^N w_j \\sum_{m=0}^N \\hat{u}_m P_m(x_j) = \\sum_{m=0}^N \\hat{u}_m \\left(\\sum_{j=0}^N w_j P_m(x_j) P_0(x_j)\\right) = \\sum_{m=0}^N \\hat{u}_m \\langle P_m, P_0 \\rangle_h.\n$$\n输入和输出模态系数之间的关系是 $\\hat{u}_{f,0} = c \\sum_{m=0}^N \\hat{u}_m \\langle P_m, P_0 \\rangle_h$ 且当 $k>0$ 时 $\\hat{u}_{f,k} = 0$。\n这对应于一个模态矩阵 $\\hat{G}$，其中只有第一行是非零的。这是一个秩为1的矩阵，而不是对角矩阵。对角滤波器要求对所有 $k$ 都有 $\\hat{u}_{f,k} = \\sigma_k \\hat{u}_k$。对于 $k>0$，这将要求 $\\sigma_k=0$（除非 $\\hat{u}_k=0$），但对于 $k=0$，$\\hat{u}_{f,0}$ 依赖于所有使得 $\\langle P_m, P_0 \\rangle_h \\ne 0$ 的输入模态 $\\hat{u}_m$。这与对角滤波器有本质上的不同。关于“傅里叶变换”的措辞在勒让德多项式的上下文中也是不精确的。\n\n结论：**错误**。\n\n### 选项 B\n核由谱展开式 $K(x,\\xi) = \\sum_{l=0}^N \\sigma_l\\,\\frac{2l+1}{2}\\,P_l(x)\\,P_l(\\xi)$ 给出。\n节点滤波操作是 $u_f(x_i) = \\sum_{j=0}^N w_j K(x_i,x_j) u(x_j)$。\n我们将 $u(x_j)$ 表示为其模态形式，$u(x_j) = \\sum_{m=0}^N \\hat{u}_m P_m(x_j)$。\n$$\nu_f(x_i) = \\sum_{j=0}^N w_j \\left( \\sum_{l=0}^N \\sigma_l\\,\\frac{2l+1}{2}\\,P_l(x_i)\\,P_l(x_j) \\right) \\left( \\sum_{m=0}^N \\hat{u}_m P_m(x_j) \\right).\n$$\n重新排列求和顺序，我们得到：\n$$\nu_f(x_i) = \\sum_{l=0}^N \\sum_{m=0}^N \\left( \\sigma_l\\,\\frac{2l+1}{2}\\,\\hat{u}_m\\,P_l(x_i) \\right) \\left( \\sum_{j=0}^N w_j P_l(x_j) P_m(x_j) \\right).\n$$\n最后一个括号中的项是离散内积 $\\langle P_l, P_m \\rangle_h$。陈述假设这个离散内积对于阶数最高为 $2N$ 的多项式是精确的。由于 $l,m \\le N$， $P_l(x)P_m(x)$ 的阶数是 $l+m \\le 2N$。因此，求积是精确的。我们可以用连续积分替换求和：\n$$\n\\langle P_l, P_m \\rangle_h = \\int_{-1}^1 P_l(x) P_m(x) dx = \\frac{2}{2l+1} \\delta_{lm},\n$$\n其中 $\\delta_{lm}$ 是克罗内克符号。这是勒让德多项式的正交性。\n将此代回 $u_f(x_i)$ 的表达式中：\n$$\nu_f(x_i) = \\sum_{l=0}^N \\sum_{m=0}^N \\left( \\sigma_l\\,\\frac{2l+1}{2}\\,\\hat{u}_m\\,P_l(x_i) \\right) \\left( \\frac{2}{2l+1} \\delta_{lm} \\right).\n$$\n由于克罗内克符号，对 $m$ 的求和会消失，只剩下 $m=l$ 的项：\n$$\nu_f(x_i) = \\sum_{l=0}^N \\sigma_l\\,\\frac{2l+1}{2}\\,\\hat{u}_l\\,P_l(x_i) \\frac{2}{2l+1} = \\sum_{l=0}^N (\\sigma_l \\hat{u}_l) P_l(x_i).\n$$\n这个方程表明，滤波后多项式的节点值 $u_f(x_i)$ 与多项式 $p(x) = \\sum_{l=0}^N (\\sigma_l \\hat{u}_l) P_l(x)$ 的节点值相同。由于在 $\\mathbb{P}_N$ 中存在唯一一个通过 $N+1$ 个不同点的多项式，滤波后的多项式 $u_f(x)$ 必须与 $p(x)$ 完全相同。因此，$u_f(x)$ 的模态系数是 $\\hat{u}_{f,l} = \\sigma_l \\hat{u}_l$。这正是权重为 $\\sigma_k$ 的对角模态滤波器的作用。\n\n结论：**正确**。\n\n### 选项 C\n该陈述声称，对于支撑严格位于 $\\Omega$ 内部的对称核，模态矩阵 $\\hat{G}=V^{-1}GV$ 是严格下三角的。一个矩阵 $A$ 如果其元素对于所有 $i \\le j$ 都满足 $A_{ij}=0$，则称其为严格下三角矩阵。\n如果一个矩阵既对称 ($A=A^T$) 又是严格下三角的，那么它必须是零矩阵。虽然模态矩阵 $\\hat{G}$ 不保证在标准意义上是对称的（即 $\\hat{G} \\ne \\hat{G}^T$），但在某些条件下（例如，高斯求积），它关于离散质量矩阵内积是自伴的，并且其连续模拟 $\\hat{K}$ 具有加权对称性。像严格下三角这样特殊的结构是不太可能出现的。这种结构将意味着模态空间中的因果关系（即，滤波模态 $m$ 只影响模态 $k>m$），这不是卷积算子的特征。卷积倾向于传播信息，耦合所有模态，从而导致一个满矩阵。选项 B 中的例子在求积精确时导致一个对角矩阵，这是一个直接的反例，因为对角矩阵不是严格下三角的。对于一个通用的核和求积方法，混叠误差将使 $\\hat{G}$ 成为一个稠密的满矩阵。该主张没有根据。\n\n结论：**错误**。\n\n### 选项 D\n条件是滤波器能够重现最高为 $M \\le N$ 阶的多项式，即对于所有 $p(x) \\in \\mathbb{P}_M$，有 $(\\mathcal{K} p)(x) = p(x)$。一个“相关的模态滤波器”是指对模态系数进行对角作用的滤波器，即 $\\hat{u}_k \\mapsto \\sigma_k \\hat{u}_k$。这意味着滤波器算子 $\\mathcal{K}$ 的特征函数就是基函数 $P_k(x)$ 本身，因此有 $(\\mathcal{K} P_k)(x) = \\sigma_k P_k(x)$。\n我们对任意 $k \\le M$ 的基多项式 $p(x) = P_k(x)$ 应用这个重现性质。由于 $\\deg(P_k)=k \\le M$，我们有 $P_k \\in \\mathbb{P}_M$。\n该性质要求 $(\\mathcal{K} P_k)(x) = P_k(x)$。\n相关的模态滤波器对 $P_k(x)$ 的作用是 $(\\mathcal{K} P_k)(x) = \\sigma_k P_k(x)$。\n将这两个表达式相等，得到 $\\sigma_k P_k(x) = P_k(x)$。\n由于 $P_k(x)$ 不是零多项式，我们可以得出结论 $\\sigma_k = 1$。这必须对所有的 $k \\in \\{0, 1, \\dots, M\\}$ 成立。\n即使我们不假设 $\\mathcal{K}$ 是一个纯粹的模态滤波器，而是一个具有模态矩阵表示 $\\hat{K}$ 的一般算子，条件 $(\\mathcal{K}P_k)(x) = P_k(x)$ 也可以转化为对于 $k \\le M$，有 $\\hat{K}e_k = e_k$，其中 $e_k$ 是标准基向量。这意味着 $\\hat{K}$ 的第 $k$ 列是 $e_k$。对角线元素是 $\\hat{K}_{kk}=1$。如果“相关的模态滤波器”系数 $\\sigma_k$ 被定义为完整模态矩阵的对角线元素，即 $\\sigma_k = \\hat{K}_{kk}$，那么我们同样得到对于 $k \\le M$，有 $\\sigma_k = 1$。\n\n结论：**正确**。\n\n### 选项 E\n该陈述将背景切换到一个具有三角多项式基（傅里叶级数）的周期性域。平移不变的核具有形式 $K(x,\\xi) = K(x-\\xi)$。滤波操作是一个卷积：$(\\mathcal{K} u)(x) = \\int u(\\xi)K(x-\\xi)d\\xi$。\n傅里叶分析的一个基本定理（卷积定理）指出，两个函数卷积的傅里叶级数系数是它们各自傅里叶系数的乘积（取决于约定，可能相差一个常数因子）。具体来说，如果 $u(x) = \\sum_k \\hat{u}_k e^{ikx}$，滤波后的函数是 $(\\mathcal{K} u)(x) = \\sum_k c \\cdot \\hat{K}_k \\hat{u}_k e^{ikx}$，其中 $\\hat{K}_k$ 是核 $K$ 的傅里叶系数，$c$ 是一个归一化常数。这意味着该算子在傅里叶模态基中是对角的，其特征值与核的傅里叶系数成正比。\n其离散模拟涉及一个等距点网格和一个对所选三角多项式精确的求积法则（例如梯形法则）。离散滤波操作变成一个循环卷积，由一个循环矩阵 $G$ 表示。循环矩阵可以被离散傅里叶变换（DFT）矩阵对角化。它的特征值是该矩阵第一行的DFT值，而第一行由核的采样值组成。因此，离散卷积算子在离散傅里叶基中是对角的，其特征值由核采样的DFT给出。这个陈述是傅里叶谱方法中的一个标准且正确的结果。\n\n结论：**正确**。", "answer": "$$\\boxed{BDE}$$", "id": "3418285"}, {"introduction": "在理解了模态滤波的理论基础后，下一个关键步骤是学习如何设计一个满足特定性能要求的滤波器。一个理想的滤波器应当能够精确地区分并区别对待不同频率的模态：它需要有力地抑制导致不稳定的高频伪振荡，同时又要尽可能地保留解的真实物理内容的低频部分。本练习将通过一个具体的推导任务，让您亲手实践这一核心设计原则[@problem_id:3418245]。您需要根据给定的精度保持要求，推导出指数型滤波器的最小阶数，从而量化地掌握在保证精度的前提下如何配置滤波器的关键参数。", "problem": "考虑在标准单元 $[-1,1]$ 上使用标准正交勒让德多项式基的一维模态谱近似，截断于模态指数 $N$。设函数 $u(x)$ 的展开式为 $u(x) = \\sum_{k=0}^{N} a_{k} \\phi_{k}(x)$，其中 $\\{\\phi_{k}\\}_{k=0}^{N}$ 是标准正交模态，$a_{k}$ 是相应的模态系数。在间断伽辽金(DG)近似中，通过谱滤波进行的稳定化是通过将模态系数乘以一个滤波器传递函数 $\\sigma_{k}$ 来实现的。\n\n假设一个由模态传递函数定义的指数滤波器\n$$\n\\sigma_{k} = \\exp\\!\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right),\n$$\n其中 $m > 0$ 是滤波器阶数，$\\alpha > 0$ 是滤波器强度。该滤波器需要近似保持所有次数至多为 $r$（其中 $0  r  N$）的多项式，其意义如下：对于任意具有模态系数 $\\{a_{k}\\}_{k=0}^{r}$ 且当 $k>r$ 时 $a_{k}=0$ 的多项式 $p(x)$，滤波对所有保留模态引起的相对模态扰动必须满足\n$$\n\\max_{0 \\leq k \\leq r} \\left|1 - \\sigma_{k}\\right| \\leq \\varepsilon,\n$$\n对于给定的容差 $0  \\varepsilon  1$。假设 $\\alpha > -\\ln(1 - \\varepsilon)$，从而使保持约束非平凡，并要求 $m > 0$。\n\n从模态滤波器的基本定义出发，推导保证上述保持要求的最小阶数 $m$ 的闭式解析表达式。你的最终答案应该是一个用 $r$、$N$、$\\alpha$ 和 $\\varepsilon$ 表示的单一解析表达式。不需要进行数值计算或四舍五入。将你的最终答案表示为单个表达式，且不要在最终答案中包含不等式。", "solution": "目标是推导满足指定多项式保持要求的最小滤波器阶数 $m$ 的闭式解析表达式。\n\n问题陈述，对于一个次数至多为 $r$（其中 $0  r  N$）的多项式，其模态系数 $a_k$ 在 $k>r$ 时为零。滤波器的保持要求由以下不等式给出：\n$$\n\\max_{0 \\leq k \\leq r} |1 - \\sigma_{k}| \\leq \\varepsilon\n$$\n其中 $0  \\varepsilon  1$ 是一个给定的容差，$\\sigma_k$ 是滤波器的模态传递函数。\n\n该滤波器定义为指数滤波器：\n$$\n\\sigma_{k} = \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n其滤波器阶数 $m > 0$，滤波器强度 $\\alpha > 0$。指数 $k$ 为非负整数。\n\n首先，我们分析 $|1 - \\sigma_k|$ 这一项。当 $k=0$ 时，指数为 $-\\alpha(0/N)^m = 0$，所以 $\\sigma_0 = \\exp(0) = 1$。这得到 $|1 - \\sigma_0| = |1-1| = 0$。对于任何 $k > 0$，因为 $\\alpha > 0$ 和 $m > 0$，指数 $-\\alpha(k/N)^m$ 严格为负。因此，$0  \\sigma_k  1$。这意味着对于 $k > 0$，$1 - \\sigma_k$ 总是正的。所以，对于所有 $k \\ge 0$，绝对值是多余的：\n$$\n|1 - \\sigma_k| = 1 - \\sigma_k\n$$\n保持约束简化为：\n$$\n\\max_{0 \\leq k \\leq r} (1 - \\sigma_{k}) \\leq \\varepsilon\n$$\n接下来，我们确定在 $0 \\le k \\le r$ 范围内哪个 $k$ 值能使函数 $f(k) = 1 - \\sigma_k$ 最大化。我们将 $k$ 视为 $k \\ge 0$ 的连续实变量来分析 $f(k)$ 的单调性。该函数为：\n$$\nf(k) = 1 - \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n我们计算 $f(k)$ 关于 $k$ 的导数：\n$$\n\\frac{df}{dk} = -\\frac{d}{dk} \\left[ \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right) \\right]\n$$\n使用链式法则，\n$$\n\\frac{df}{dk} = - \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right) \\cdot \\left(-\\alpha \\frac{m k^{m-1}}{N^m}\\right)\n$$\n$$\n\\frac{df}{dk} = \\left(\\frac{\\alpha m}{N^m}\\right) k^{m-1} \\exp\\left(-\\alpha \\left(\\frac{k}{N}\\right)^{m}\\right)\n$$\n鉴于 $\\alpha > 0$，$m > 0$ 且 $N > 0$，前置因子 $(\\alpha m / N^m)$ 是正的。指数项总是正的。对于 $k \\ge 0$，$k^{m-1}$ 项是非负的。仅当 $m>1$ 时在 $k=0$ 处为零，而当 $m \\le 1$ 时对于 $k>0$ 为正。在所有 $k \\ge 0$ 的情况下，$\\frac{df}{dk} \\ge 0$。这表明 $f(k)$ 是一个关于 $k$ 的单调非减函数。\n\n对于一个离散整数值集合 $\\{0, 1, 2, ..., r\\}$，一个单调非减函数在该集合中的最大值处取得其最大值。因此，$f(k)$ 的最大值出现在 $k=r$ 处。\n$$\n\\max_{0 \\leq k \\leq r} (1 - \\sigma_{k}) = 1 - \\sigma_{r}\n$$\n保持约束简化为只涉及模态 $k=r$ 的单个不等式：\n$$\n1 - \\sigma_{r} \\leq \\varepsilon\n$$\n代入 $\\sigma_r$ 的表达式：\n$$\n1 - \\exp\\left(-\\alpha \\left(\\frac{r}{N}\\right)^{m}\\right) \\leq \\varepsilon\n$$\n我们现在解这个关于滤波器阶数 $m$ 的不等式。整理各项，我们得到：\n$$\n1 - \\varepsilon \\leq \\exp\\left(-\\alpha \\left(\\frac{r}{N}\\right)^{m}\\right)\n$$\n因为 $0  \\varepsilon  1$，所以 $1 - \\varepsilon$ 这一项在 $0$ 和 $1$ 之间。我们可以对两边取自然对数。由于自然对数函数是单调递增的，不等号的方向保持不变：\n$$\n\\ln(1 - \\varepsilon) \\leq -\\alpha \\left(\\frac{r}{N}\\right)^{m}\n$$\n两边乘以 $-1$ 会使不等号反向：\n$$\n-\\ln(1 - \\varepsilon) \\geq \\alpha \\left(\\frac{r}{N}\\right)^{m}\n$$\n因为 $\\alpha > 0$，我们可以用 $\\alpha$ 除两边而不改变不等号方向：\n$$\n\\frac{-\\ln(1 - \\varepsilon)}{\\alpha} \\geq \\left(\\frac{r}{N}\\right)^{m}\n$$\n为了分离出 $m$，我们再次对两边取自然对数。问题陈述 $\\alpha > -\\ln(1 - \\varepsilon)$，这意味着左侧的 $\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}$ 是一个小于 $1$ 的正数。右侧幂的底数 $r/N$ 也因为 $0  r  N$ 而在 $0$ 和 $1$ 之间。对一个在 $0$ 和 $1$ 之间的数取自然对数会得到一个负的结果。\n$$\n\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right) \\geq \\ln\\left(\\left(\\frac{r}{N}\\right)^{m}\\right)\n$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$：\n$$\n\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right) \\geq m \\ln\\left(\\frac{r}{N}\\right)\n$$\n为了解出 $m$，我们必须除以 $\\ln(r/N)$。因为 $0  r  N$，我们有 $0  r/N  1$，这意味着 $\\ln(r/N)$ 是一个负数。除以一个负数会使不等号反向：\n$$\n\\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)} \\leq m\n$$\n这个不等式给出了 $m$ 必须满足的条件。为了找到保证保持要求的最小阶数 $m$，我们选择 $m$ 的最小可能值，即这个不等式的下界。\n$$\nm_{\\text{min}} = \\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)}\n$$\n此表达式为所需的最小滤波器阶数 $m$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{\\ln\\left(\\frac{-\\ln(1 - \\varepsilon)}{\\alpha}\\right)}{\\ln\\left(\\frac{r}{N}\\right)}}$$", "id": "3418245"}, {"introduction": "虽然谱方法滤波是抑制数值振荡的强大工具，但它的应用并非没有代价。在实践中，我们必须警惕滤波可能带来的意想不到的副作用。本练习旨在揭示一个重要的权衡：稳定性的获得有时会以牺牲部分高阶精度特性为代价[@problem_id:3418287]。您将分析一个具体情况，即滤波如何破坏谱配置方法在特定点（通量点）上所具有的超收敛性——这是许多高阶方法所特有的宝贵性质。通过这个练习，您将更深刻地认识到在数值模拟中应用任何稳定化机制时，都需要进行审慎的评估。", "problem": "考虑标量线性平流方程 $u_{t} + a u_{x} = 0$，定义在区间 $[-1,1]$ 上，其中平流速度 $a>0$ 为常数。设使用单单元谱搭配法进行离散化，搭配点为 $N$ 次多项式的 Legendre–Gauss–Lobatto 节点。因此，数值解（在没有滤波的情况下）可以由 Legendre 模态展开精确表示为 $u_{N}(x,t) = \\sum_{k=0}^{N} \\hat{u}_{k}(t) P_{k}(x)$，其中 $P_{k}(x)$ 是 Legendre 多项式，对所有 $k$ 满足 $P_{k}(1)=1$。在这种搭配设置中，点 $x=1$ 是一个通量点：对于最高次数为 $N$ 的多项式数据，节点表示和模态表示是一致的，并且在未滤波的格式中，在 $x=1$ 处计算的守恒通量是精确的。\n\n为了稳定振荡，在每个时间步对模态系数应用指数模态滤波器，形式为 $\\hat{u}_{k} \\mapsto \\sigma_{k} \\hat{u}_{k}$，其中传递函数为\n$$\n\\sigma_{k} = \\exp\\!\\big(-\\alpha \\left(\\tfrac{k}{N}\\right)^{p}\\big),\n$$ \n其中滤波器强度 $\\alpha>0$，滤波器阶数 $p \\in \\mathbb{N}$。假设在某个固定时刻 $t^{\\star}$，精确解 $u(x,t^{\\star})$ 等于单个 Legendre 模态 $P_{N}(x)$，因此未滤波的谱搭配表示可以精确地恢复 $u(x,t^{\\star})$，其模态系数为 $\\hat{u}_{N}(t^{\\star})=1$ 且当 $k\\neq N$ 时 $\\hat{u}_{k}(t^{\\star})=0$。\n\n从 Legendre 多项式模态展开的核心定义和对角模态滤波的作用出发，推导由该滤波器在通量点 $x=1$ 处引入的逐点误差，定义为\n$$\n\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star}),\n$$ \n并提供 $\\varepsilon(\\alpha,p,N)$ 关于 $\\alpha$、$p$ 和 $N$ 的封闭形式解析表达式。然后，利用在 $x=1$ 处从模态到点值计算的第一性原理，刻画对角模态传递函数 $k \\mapsto \\sigma_{k}$ 需满足的充要条件，在该条件下，通量点的超收敛性（即对于所有最高次数为 $N$ 的多项式，通量点的值都是精确的）在滤波后得以保持。\n\n将最终答案表示为 $\\varepsilon(\\alpha,p,N)$ 的单一解析表达式。无需四舍五入，也不涉及单位。", "solution": "用户提供了一个数值分析领域的问题，具体涉及偏微分方程的谱方法。任务是验证问题陈述的有效性，如果有效，则推导一个特定的误差量和一个与谱滤波相关的通用条件。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **控制方程：** $u_{t} + a u_{x} = 0$，在 $x \\in [-1,1]$ 上，常数 $a>0$。\n- **离散化：** 单单元谱搭配法，使用 $N$ 次多项式的 Legendre–Gauss–Lobatto 节点。\n- **解的表示：** Legendre 模态展开 $u_{N}(x,t) = \\sum_{k=0}^{N} \\hat{u}_{k}(t) P_{k}(x)$。\n- **Legendre 多项式：** $P_{k}(x)$，具有对所有 $k$ 满足 $P_{k}(1)=1$ 的性质。\n- **通量点：** 点 $x=1$。\n- **模态滤波器：** 通过 $\\hat{u}_{k} \\mapsto \\sigma_{k} \\hat{u}_{k}$ 应用。\n- **滤波器传递函数：** $\\sigma_{k} = \\exp(-\\alpha (\\frac{k}{N})^{p})$，参数为 $\\alpha>0$ 和 $p \\in \\mathbb{N}$。\n- **在 $t^{\\star}$ 时刻的解状态：** 精确解为 $u(x,t^{\\star}) = P_{N}(x)$。这意味着未滤波的数值解的模态系数为 $\\hat{u}_{N}(t^{\\star})=1$ 且当 $k\\neq N$ 时 $\\hat{u}_{k}(t^{\\star})=0$。\n- **误差定义：** $\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star})$。\n- **任务：**\n  1. 推导 $\\varepsilon(\\alpha,p,N)$ 的封闭形式解析表达式。\n  2. 刻画为保持通量点超收敛性，$\\sigma_{k}$ 需满足的充要条件。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于谱方法和间断 Galerkin 方法的理论中。平流方程、Legendre 多项式、模态滤波以及单元边界（通量点）的超收敛性概念都是该领域中标准且成熟的课题。\n- **适定性：** 该问题是适定的。它提供了所有必要的定义和数据，以唯一地确定所要求的量。整个设定是自洽且合乎逻辑的。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有任何主观或含糊的术语。\n- **缺陷检查表：** 该问题没有违反任何无效性标准。它在科学上是合理的、可形式化的、完整的，在数值分析模型问题的背景下是现实的，并且并非微不足道。\n\n**第3步：结论与行动**\n该问题被判定为 **有效**。将提供完整解答。\n\n### 解答推导\n\n按照问题陈述的要求，分析分两部分进行。\n\n**第一部分：逐点误差 $\\varepsilon(\\alpha,p,N)$ 的推导**\n\n通量点 $x=1$ 处的误差定义为 $\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star})$。我们将分别计算每一项。\n\n首先，我们确定精确解在目标点的值。问题陈述，在时刻 $t^{\\star}$，精确解为 $u(x,t^{\\star}) = P_{N}(x)$。我们将其在 $x=1$ 处求值：\n$$\nu(1,t^{\\star}) = P_{N}(1)\n$$\n问题指明了 Legendre 多项式满足的性质，即对所有 $k$ 都有 $P_{k}(1) = 1$。因此，对于 $k=N$，我们有：\n$$\nu(1,t^{\\star}) = 1\n$$\n\n接下来，我们确定滤波后数值解的值 $u_{N}^{\\mathrm{filtered}}(1,t^{\\star})$。已知未滤波的解 $u_{N}(x,t^{\\star})$ 的模态系数为 $\\hat{u}_{N}(t^{\\star})=1$ 且对所有 $k \\neq N$ 有 $\\hat{u}_{k}(t^{\\star})=0$。滤波过程作用于这些模态系数。设滤波后的系数为 $\\hat{u}_{k}^{\\mathrm{filtered}}$。变换由下式给出：\n$$\n\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\hat{u}_{k}(t^{\\star})\n$$\n对于 $k \\neq N$，我们有 $\\hat{u}_{k}(t^{\\star})=0$，所以 $\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\cdot 0 = 0$。\n对于 $k = N$，我们有 $\\hat{u}_{N}(t^{\\star})=1$，所以 $\\hat{u}_{N}^{\\mathrm{filtered}} = \\sigma_{N} \\cdot 1 = \\sigma_{N}$。\n\n滤波器传递函数为 $\\sigma_{k} = \\exp(-\\alpha (\\frac{k}{N})^{p})$。对于特定的模态 $k=N$，它变为：\n$$\n\\sigma_{N} = \\exp\\big(-\\alpha \\left(\\tfrac{N}{N}\\right)^{p}\\big) = \\exp(-\\alpha \\cdot 1^{p}) = \\exp(-\\alpha)\n$$\n因此，唯一非零的滤波后模态系数是 $\\hat{u}_{N}^{\\mathrm{filtered}} = \\exp(-\\alpha)$。\n\n滤波后的数值解由这些滤波后的系数重构：\n$$\nu_{N}^{\\mathrm{filtered}}(x,t^{\\star}) = \\sum_{k=0}^{N} \\hat{u}_{k}^{\\mathrm{filtered}} P_{k}(x)\n$$\n由于只有 $k=N$ 的系数非零，这个求和简化为单项：\n$$\nu_{N}^{\\mathrm{filtered}}(x,t^{\\star}) = \\hat{u}_{N}^{\\mathrm{filtered}} P_{N}(x) = \\exp(-\\alpha) P_{N}(x)\n$$\n现在，我们在通量点 $x=1$ 处计算这个滤波后的解：\n$$\nu_{N}^{\\mathrm{filtered}}(1,t^{\\star}) = \\exp(-\\alpha) P_{N}(1)\n$$\n使用性质 $P_{N}(1)=1$，我们得到：\n$$\nu_{N}^{\\mathrm{filtered}}(1,t^{\\star}) = \\exp(-\\alpha)\n$$\n\n最后，我们代入已求得的值来计算误差 $\\varepsilon(\\alpha,p,N)$：\n$$\n\\varepsilon(\\alpha,p,N) = u_{N}^{\\mathrm{filtered}}(1,t^{\\star}) - u(1,t^{\\star}) = \\exp(-\\alpha) - 1\n$$\n这就是误差的封闭形式解析表达式。值得注意的是，在初始误差集中于最高模态 $k=N$ 的特定条件下，滤波器引入的误差与多项式次数 $N$ 和滤波器阶数 $p$ 无关。\n\n**第二部分：保持通量点超收敛性的条件**\n\n通量点超收敛性意味着对于任何次数最高为 $N$ 的多项式解，数值解在点 $x=1$ 处都是精确的。我们考虑该空间中的一个任意多项式解 $u(x)$，其 Legendre 模态展开为：\n$$\nu(x) = \\sum_{k=0}^{N} \\hat{u}_{k} P_{k}(x)\n$$\n该解在 $x=1$ 处的精确值为：\n$$\nu(1) = \\sum_{k=0}^{N} \\hat{u}_{k} P_{k}(1) = \\sum_{k=0}^{N} \\hat{u}_{k} \\cdot 1 = \\sum_{k=0}^{N} \\hat{u}_{k}\n$$\n该解的滤波后数值表示 $u_{N}^{\\mathrm{filtered}}(x)$ 的模态系数为 $\\hat{u}_{k}^{\\mathrm{filtered}} = \\sigma_{k} \\hat{u}_{k}$。其在 $x=1$ 处的值为：\n$$\nu_{N}^{\\mathrm{filtered}}(1) = \\sum_{k=0}^{N} \\hat{u}_{k}^{\\mathrm{filtered}} P_{k}(1) = \\sum_{k=0}^{N} (\\sigma_{k} \\hat{u}_{k}) \\cdot 1 = \\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k}\n$$\n为了使超收敛性在滤波后得以保持，对于系数 $\\{\\hat{u}_{k}\\}_{k=0}^{N}$ 的任何选择，滤波后的值必须等于精确值。这给出了条件：\n$$\n\\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k} = \\sum_{k=0}^{N} \\hat{u}_{k}\n$$\n整理各项，我们得到：\n$$\n\\sum_{k=0}^{N} \\sigma_{k} \\hat{u}_{k} - \\sum_{k=0}^{N} \\hat{u}_{k} = 0\n$$\n$$\n\\sum_{k=0}^{N} (\\sigma_{k} - 1) \\hat{u}_{k} = 0\n$$\n此方程必须对任意系数向量 $(\\hat{u}_{0}, \\hat{u}_{1}, \\dots, \\hat{u}_{N})$ 都成立。在系数的向量空间中，这等价于向量 $(\\sigma_{0}-1, \\dots, \\sigma_{N}-1)$ 与任意向量 $(\\hat{u}_{0}, \\dots, \\hat{u}_{N})$ 的点积为零。这仅当第一个向量是零向量时才可能。因此，每个分量都必须为零：\n$$\n\\sigma_{k} - 1 = 0 \\quad \\text{对所有 } k \\in \\{0, 1, \\dots, N\\}\n$$\n这得出了充要条件：\n$$\n\\sigma_{k} = 1 \\quad \\text{对所有 } k \\in \\{0, 1, \\dots, N\\}\n$$\n换句话说，为了对所有次数不超过 $N$ 的多项式都保持解在通量点的精确性，滤波器的传递函数对于所有相应的模态都必须为1。这意味着滤波器必须作为解空间上的单位算子，实际上不施加任何滤波。任何非平凡的滤波器（即对于某个 $k$ 有 $\\sigma_{k}  1$）都会破坏超收敛性。", "answer": "$$\n\\boxed{\\exp(-\\alpha) - 1}\n$$", "id": "3418287"}]}