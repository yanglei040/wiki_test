{"hands_on_practices": [{"introduction": "第一个练习将深入探讨谱消失黏性（SVV）方法的核心。我们将构建在节点间断伽辽金（DG）框架下的SVV算子，并直接验证其最关键的特性：它只阻尼解的高频模式。这项实践对于理解SVV方法如何在不牺牲解的精确解析部分的情况下实现数值稳定至关重要。[@problem_id:3419879]", "problem": "考虑一个一维参考单元 $[-1,1]$，其上配有高斯-洛巴托-勒让德（GLL）节点和最高阶为 $p$ 的多项式空间 $\\mathbb{P}_{p}$，其中 $p=6$。在采用GLL节点的节点间断伽辽金（DG）方法中，定义一个谱消失粘性（SVV）算子，该算子通过斯特姆-刘维尔-勒让德算子 $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})\\frac{\\mathrm{d}}{\\mathrm{d}x}\\right]$ 作用于模态勒让德多项式基 $\\{P_{k}(x)\\}_{k=0}^{p}$，并在模态指数 $m_{p}=3$ 处应用谱截断，其中光滑核函数 $Q(k)$ 在低阶模态上为零，在高阶模态上呈平方增长。具体来说，取\n$$Q(k)=\\begin{cases} 0,  k\\le m_{p}, \\\\[6pt] \\left(\\dfrac{k-m_{p}}{p-m_{p}}\\right)^{2},  k> m_{p}, \\end{cases}\n$$\n并将粘性随多项式阶数进行缩放，即 $\\nu_{p}=\\nu_{0}/p$，其中 $\\nu_{0}=1$。SVV算子通过以下方式定义在模态系数上：\n$$\\mathcal{A}_{p} P_{k}=\\nu_{p}\\,Q(k)\\,k(k+1)\\,P_{k},\\quad k=0,1,\\dots,p$$\n因此，在模态勒让德基下，其矩阵为对角矩阵，对角元为 $\\lambda_{k}=\\nu_{p}\\,Q(k)\\,k(k+1)$。设GLL节点基为与GLL节点 $\\{x_{i}\\}_{i=0}^{p}$ 相关的拉格朗日多项式 $\\{l_{i}(x)\\}_{i=0}^{p}$，并用 $V\\in\\mathbb{R}^{(p+1)\\times(p+1)}$ 表示类范德蒙求值矩阵，其元素为 $V_{i,k}=P_{k}(x_{i})$。\n\n(a) 仅使用勒让德多项式的性质和上述SVV算子的定义，将GLL节点基中的离散SVV矩阵明确构造为对角模态矩阵的相似变换，并解释为何节点SVV矩阵的特征值与对角元 $\\lambda_{k}$ 一致。\n\n(b) 对于 $p=6$，$m_{p}=3$ 和 $\\nu_{0}=1$ 的情况，精确计算七个特征值 $\\{\\lambda_{k}\\}_{k=0}^{6}$，以验证只有高阶模态子空间被阻尼。请将最终答案表示为一个精确的解析行矩阵，不要四舍五入。", "solution": "该问题首先要求在高斯-洛巴托-勒让德（GLL）节点基中构造离散谱消失粘性（SVV）矩阵，并解释其特征值为给定的模态值 $\\lambda_k$ 的原因。其次，它要求根据指定参数明确计算这些特征值。\n\n该问题具有科学依据，提法恰当，并包含求解所需的所有信息。它是偏微分方程数值方法领域的一个标准问题，特别涉及谱方法的稳定化技术。因此，该问题被认为是有效的。\n\n(a)部分：节点SVV矩阵的构造与特征值分析\n\n设最高阶为 $p$ 的多项式空间表示为 $\\mathbb{P}_{p}$。任何多项式 $u(x) \\in \\mathbb{P}_{p}$ 可以在与本问题相关的两种不同基中表示：模态勒让德基和节点GLL基。\n\n1.  **模态表示**：在由勒让德多项式 $\\{P_k(x)\\}_{k=0}^{p}$ 组成的模态基中，多项式 $u(x)$ 表示为线性组合：\n    $$u(x) = \\sum_{k=0}^{p} \\hat{u}_k P_k(x)$$\n    模态系数向量为 $\\mathbf{\\hat{u}} = (\\hat{u}_0, \\hat{u}_1, \\dots, \\hat{u}_p)^T \\in \\mathbb{R}^{p+1}$。\n\n2.  **节点表示**：在与GLL节点 $\\{x_i\\}_{i=0}^{p}$ 相关的、由拉格朗日多项式 $\\{l_i(x)\\}_{i=0}^{p}$ 组成的节点基中，同一个多项式 $u(x)$ 由其在这些节点处的值表示：\n    $$u(x) = \\sum_{i=0}^{p} u_i l_i(x)$$\n    其中 $u_i = u(x_i)$。节点值向量为 $\\mathbf{u} = (u_0, u_1, \\dots, u_p)^T \\in \\mathbb{R}^{p+1}$。\n\n这两种表示之间的联系是通过在GLL节点上对模态展开式进行求值来建立的：\n$$u_i = u(x_i) = \\sum_{k=0}^{p} \\hat{u}_k P_k(x_i)$$\n这个线性方程组可以写成矩阵形式。设 $V$ 是一个 $(p+1) \\times (p+1)$ 的类范德蒙矩阵，其元素为 $V_{ik} = P_k(x_i)$。那么，节点值向量 $\\mathbf{u}$ 和模态系数向量 $\\mathbf{\\hat{u}}$ 之间的关系是：\n$$\\mathbf{u} = V \\mathbf{\\hat{u}}$$\n由于多项式集合 $\\{P_k(x)\\}_{k=0}^{p}$ 构成了 $\\mathbb{P}_{p}$ 的一组基，矩阵 $V$ 是可逆的。因此，我们可以使用逆矩阵 $V^{-1}$ 从节点值转换到模态系数：\n$$\\mathbf{\\hat{u}} = V^{-1} \\mathbf{u}$$\n\nSVV算子 $\\mathcal{A}_p$ 通过其对模态基函数的作用来定义：\n$$\\mathcal{A}_p P_k = \\nu_p Q(k) k(k+1) P_k = \\lambda_k P_k$$\n这个定义意味着勒让德多项式 $P_k(x)$ 是算子 $\\mathcal{A}_p$ 的特征函数，对应的特征值为 $\\lambda_k$。因此，$\\mathcal{A}_p$ 在模态基中的矩阵表示是一个对角矩阵 $\\Lambda$，其对角线上的元素为特征值：\n$$\\Lambda = \\mathrm{diag}(\\lambda_0, \\lambda_1, \\dots, \\lambda_p)$$\n将算子 $\\mathcal{A}_p$ 应用于模态系数为 $\\mathbf{\\hat{u}}$ 的多项式 $u(x)$，会得到一个新的多项式 $v(x) = \\mathcal{A}_p u(x)$，其模态系数为 $\\mathbf{\\hat{v}} = \\Lambda \\mathbf{\\hat{u}}$。\n\n为了找到 $\\mathcal{A}_p$ 在GLL节点基中的矩阵表示（我们称之为 $A_{nodal}$），我们追踪一个节点向量 $\\mathbf{u}$ 在该算子作用下的变换过程。\n1.  从一个节点向量 $\\mathbf{u}$ 开始。\n2.  将其转换为模态表示：$\\mathbf{\\hat{u}} = V^{-1} \\mathbf{u}$。\n3.  在模态基中应用SVV算子，即乘以 $\\Lambda$：$\\mathbf{\\hat{v}} = \\Lambda \\mathbf{\\hat{u}} = \\Lambda V^{-1} \\mathbf{u}$。\n4.  将得到的模态向量 $\\mathbf{\\hat{v}}$ 转换回节点基：$\\mathbf{v} = V \\mathbf{\\hat{v}} = V (\\Lambda V^{-1} \\mathbf{u})$。\n\n最终的节点向量 $\\mathbf{v}$ 与初始节点向量 $\\mathbf{u}$ 通过矩阵 $A_{nodal}$ 相关联：\n$$\\mathbf{v} = A_{nodal} \\mathbf{u}$$\n根据上述推导，我们可以确定GLL节点基中离散SVV矩阵的显式形式：\n$$A_{nodal} = V \\Lambda V^{-1}$$\n这个构造将节点SVV矩阵表示为对角模态矩阵 $\\Lambda$ 的相似变换。\n\n根据线性代数的一个基本定理，相似矩阵具有相同的特征值集。由于 $A_{nodal}$ 和 $\\Lambda$ 是相似的，它们的特征值必须相同。矩阵 $\\Lambda$ 是对角矩阵，其特征值就是其对角元。因此，节点SVV矩阵 $A_{nodal}$ 的特征值恰好是 $\\{\\lambda_k\\}_{k=0}^p$。\n\n(b)部分：特征值的计算\n\n给定参数 $p=6$，$m_p=3$ 和 $\\nu_0=1$。\n首先，我们计算粘性参数 $\\nu_p$：\n$$\\nu_p = \\frac{\\nu_0}{p} = \\frac{1}{6}$$\n接着，我们为 $p=6$ 和 $m_p=3$ 定义谱核函数 $Q(k)$：\n$$Q(k)=\\begin{cases}\n0,   k\\leq 3, \\\\\n\\left(\\dfrac{k-3}{6-3}\\right)^{2} = \\left(\\dfrac{k-3}{3}\\right)^{2},  k>3.\n\\end{cases}$$\n特征值由公式 $\\lambda_k = \\nu_p Q(k) k(k+1)$ 给出，其中 $k=0, 1, \\dots, 6$。我们计算每个特征值：\n\n对于 $k=0$：$Q(0)=0 \\implies \\lambda_0 = \\frac{1}{6} \\cdot 0 \\cdot 0(1) = 0$。\n对于 $k=1$：$Q(1)=0 \\implies \\lambda_1 = \\frac{1}{6} \\cdot 0 \\cdot 1(2) = 0$。\n对于 $k=2$：$Q(2)=0 \\implies \\lambda_2 = \\frac{1}{6} \\cdot 0 \\cdot 2(3) = 0$。\n对于 $k=3$：$Q(3)=0 \\implies \\lambda_3 = \\frac{1}{6} \\cdot 0 \\cdot 3(4) = 0$。\n这些结果表明，低阶模态子空间（对于 $k \\leq m_p$）不受SVV算子的影响，这与预期相符。\n\n对于 $k=4$：\n$Q(4) = \\left(\\frac{4-3}{3}\\right)^2 = \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{9}$。\n$\\lambda_4 = \\frac{1}{6} \\cdot Q(4) \\cdot 4(4+1) = \\frac{1}{6} \\cdot \\frac{1}{9} \\cdot (4 \\cdot 5) = \\frac{20}{54} = \\frac{10}{27}$。\n\n对于 $k=5$：\n$Q(5) = \\left(\\frac{5-3}{3}\\right)^2 = \\left(\\frac{2}{3}\\right)^2 = \\frac{4}{9}$。\n$\\lambda_5 = \\frac{1}{6} \\cdot Q(5) \\cdot 5(5+1) = \\frac{1}{6} \\cdot \\frac{4}{9} \\cdot (5 \\cdot 6) = \\frac{4 \\cdot 30}{54} = \\frac{120}{54} = \\frac{20}{9}$。\n\n对于 $k=6$：\n$Q(6) = \\left(\\frac{6-3}{3}\\right)^2 = \\left(\\frac{3}{3}\\right)^2 = 1^2 = 1$。\n$\\lambda_6 = \\frac{1}{6} \\cdot Q(6) \\cdot 6(6+1) = \\frac{1}{6} \\cdot 1 \\cdot (6 \\cdot 7) = \\frac{42}{6} = 7$。\n\n高阶模态（$km_p$）受到非零阻尼，且阻尼随模态数增加而增大，这正是SVV方法的预期效果。完整的特征值集合 $\\{\\lambda_k\\}_{k=0}^6$ 为 $\\{0, 0, 0, 0, \\frac{10}{27}, \\frac{20}{9}, 7\\}$。", "answer": "$$\\boxed{\\begin{pmatrix} 0  0  0  0  \\frac{10}{27}  \\frac{20}{9}  7 \\end{pmatrix}}$$", "id": "3419879"}, {"introduction": "既然我们已经理解了SVV的机制，一个实际问题随之而来：人工黏性应该设置多大？本练习将指导您通过平衡物理和数值时间尺度的强大技术，来确定SVV强度 $\\nu_{h,p}$ 的适当缩放关系。这种基于物理动机的方法是设计鲁棒且精确的数值格式的基础。[@problem_id:3419847]", "problem": "考虑一个在周期性区域上具有恒定平流速度 $U$ 的一维线性平流方程，该方程通过在物理尺寸为 $h$ 的单元上使用 $p$ 阶分片多项式间断Galerkin (DG) 方法进行离散。为了稳定解并仅在最高可分辨尺度上模拟小尺度物理耗散，添加了一个谱消失黏性 (SVV) 项，该项对足够高的模态或傅里叶分量起到类似扩散算子的作用。具体来说，对于波数为 $k$ 的傅里叶模态，SVV 的贡献会产生一个指数衰减，其衰减率与 $\\nu_{h,p}\\,k^{2}$ 成正比，其中 $\\nu_{h,p}$ 是由 SVV 核函数施加于高模态的（恒定）SVV 强度，并且假设该核函数在截止波数 $k_{c}$ 处等于 $1$。\n\n采用以下具有物理动机的分辨率模型：每个单元上最小的可分辨长度尺度与 $h/p$ 成正比，因此相应的截止波数为 $k_{c}\\approx \\pi p/h$。仅使用基本平衡和标准估计，确定 SVV 强度 $\\nu_{h,p}$ 随单元尺寸 $h$ 和多项式阶数 $p$ 的显式标度关系，使得在截止波数 $k_{c}$ 处，平流时间尺度和扩散时间尺度相等，从而使 SVV 在单元分辨率上模拟目标物理耗散。\n\n你的最终答案必须是关于 $\\nu_{h,p}$ 的一个单一闭式解析表达式，用 $U$、$h$、$p$ 和数值常数表示。不需要四舍五入，最终表达式中不应包含单位。", "solution": "该问题陈述被评估为有效。它在科学上基于偏微分方程数值分析的原理，特别是关于间断Galerkin方法和用于稳定化的人工黏性。该问题是适定的、客观的，并包含足够的信息来推导所要求的标度律。所有组成部分，如线性平流方程、谱消失黏性（SVV）的概念以及模态分辨率模型，都是该领域的标准内容。\n\n目标是确定谱消失黏性（SVV）强度（表示为 $\\nu_{h,p}$）随单元尺寸 $h$ 和多项式阶数 $p$ 的标度关系。确定此关系的条件是，在截止波数 $k_c$ 处，平流时间尺度必须等于由 SVV 引入的扩散时间尺度。\n\n首先，我们来定义相关的时间尺度。\n\n平流时间尺度 $\\tau_{adv}$ 与信息通过平流速度 $U$ 传播有关。对于波数为 $k$ 的单个傅里叶模态，表示为 $\\exp(i(kx - \\omega t))$，线性平流方程 $\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = 0$ 得出色散关系 $\\omega = Uk$。角频率 $\\omega$ 表示单位时间内的相位变化率。与此过程相关的特征时间尺度是角频率的倒数。\n$$\n\\tau_{adv}(k) = \\frac{1}{\\omega} = \\frac{1}{Uk}\n$$\n这个时间尺度表示波的相位改变一个弧度所需的时间。\n\n扩散时间尺度 $\\tau_{diff}$ 与 SVV 机制的能量耗散有关。问题陈述指出，SVV 对高频模态起扩散算子的作用，其衰减率正比于 $\\nu_{h,p} k^2$。这对应于解的高频分量满足形如 $\\frac{\\partial u}{\\partial t} = \\nu_{h,p} \\frac{\\partial^2 u}{\\partial x^2}$ 的模型方程。对于傅里叶模态 $\\exp(ikx)$，扩散算子的作用为 $\\frac{\\partial^2}{\\partial x^2} \\exp(ikx) = (ik)^2 \\exp(ikx) = -k^2 \\exp(ikx)$。将此代入形如 $u(x,t) = \\hat{u}(k) \\exp(-\\gamma t) \\exp(ikx)$ 的解的模型方程中，我们得到：\n$$\n-\\gamma \\hat{u}(k) = \\nu_{h,p} (-k^2) \\hat{u}(k)\n$$\n这给出了时间衰减率 $\\gamma = \\nu_{h,p} k^2$。扩散时间尺度是模态振幅衰减的特征时间，即该衰减率的倒数。\n$$\n\\tau_{diff}(k) = \\frac{1}{\\gamma} = \\frac{1}{\\nu_{h,p} k^2}\n$$\n\n问题要求这两个时间尺度在截止波数 $k_c$ 处相等。这就建立了一种平衡，在最小可分辨尺度上，平流效应和耗散效应处于同一数量级。\n$$\n\\tau_{adv}(k_c) = \\tau_{diff}(k_c)\n$$\n代入时间尺度的表达式：\n$$\n\\frac{1}{U k_c} = \\frac{1}{\\nu_{h,p} k_c^2}\n$$\n我们可以解此方程以求得 SVV 强度 $\\nu_{h,p}$。两边同乘以 $\\nu_{h,p} U k_c^2$ 得到：\n$$\n\\nu_{h,p} k_c = U\n$$\n因此，所需的 SVV 强度为：\n$$\n\\nu_{h,p} = \\frac{U}{k_c}\n$$\n\n最后一步是将问题中提供的具有物理动机的分辨率模型代入截止波数 $k_c$。问题陈述指出，最小可分辨长度尺度正比于 $h/p$，这导致截止波数 $k_c \\approx \\pi p/h$。为了推导标度律，我们将此表达式用作等式：\n$$\nk_c = \\frac{\\pi p}{h}\n$$\n将此代入我们关于 $\\nu_{h,p}$ 的表达式中：\n$$\n\\nu_{h,p} = \\frac{U}{\\frac{\\pi p}{h}}\n$$\n化简此表达式得到 SVV 强度的标度关系的最终结果：\n$$\n\\nu_{h,p} = \\frac{Uh}{\\pi p}\n$$\n此结果表明，所需的人工黏性正比于单元尺寸 $h$ 和平流速度 $U$，反比于多项式阶数 $p$。这是一个在物理上和数值上都一致的结果，因为对于更精细的网格（更小的 $h$）和更高阶的近似（更大的 $p$），人工耗散应该减小。", "answer": "$$\\boxed{\\frac{Uh}{\\pi p}}$$", "id": "3419847"}, {"introduction": "我们最后的实践将从理论转向一个实际应用：为声学问题校准SVV方案。您将实现一个SVV模型来抑制模拟声腔中的伪数值共振，这是波模拟中的一个常见挑战。目标是找到合适的平衡点——在抑制不必要噪声的同时，保持物理声波的准确性和品质因数——这体现了设计实用稳定化方法时必须面对的关键权衡。[@problem_id:3419895]", "problem": "考虑一个一维声学腔体，其模型建立在长度为 $L$（单位：米）的周期性域上，声速为 $c$（单位：米/秒）。其基线动力学由线性波动方程 $\\partial_{tt} u = c^2 \\partial_{xx} u$ 控制。引入谱消失粘性 (Spectral Vanishing Viscosity, SVV) 机制作为一种人工阻尼项，该项选择性地作用于高波数内容。在傅里叶表示中，将 SVV 算子定义为施加于时间导数上的模态阻尼：\n$$\n\\partial_{tt} \\widehat{u}(k,t) = - c^2 k^2 \\widehat{u}(k,t) - \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\partial_t \\widehat{u}(k,t)\n$$\n其中 $\\widehat{u}(k,t)$ 是波数为 $k$（单位：弧度/米）时的傅里叶模态，$\\sigma_{\\mathrm{svv}}$ 是 SVV 幅值（单位：平方米/秒），$\\phi(k)$ 是一个无量纲滤波器函数，它在低波数处为零，并在接近最大可分辨波数时斜坡上升。对于在长度为 $L$ 的周期性域上具有 $N$ 个模态的傅里叶离散化，最高可分辨波数为\n$$\nk_{\\max} = \\frac{\\pi N}{L}.\n$$\n我们关注的物理模态是基模\n$$\nk_{\\mathrm{phys}} = \\frac{2\\pi}{L},\n$$\n并取奈奎斯特模态作为一个代表性的伪模\n$$\nk_{\\mathrm{spur}} = k_{\\max}.\n$$\n使用一个由截止波数 $k_c$ 和指数 $p$ 参数化的斜坡 SVV 滤波器：\n$$\\phi(k) = \n\\begin{cases}\n0,  k \\le k_c, \\\\[4pt]\n\\left(\\dfrac{k - k_c}{k_{\\max} - k_c}\\right)^{p},  k > k_c,\n\\end{cases}\n\\quad\\text{其中}\\quad k_c = r\\,k_{\\max},$$\n其中 $r \\in [0,1)$ 是截止比。对于每个模态 $k$，得到的线性常微分方程是一个阻尼谐振子\n$$\n\\ddot{\\widehat{u}}_k + \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\dot{\\widehat{u}}_k + c^2 k^2 \\widehat{u}_k = 0.\n$$\n定义模态阻尼系数和无阻尼角频率为\n$$\n\\alpha_k = \\tfrac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2,\\qquad \\omega_k = c\\,|k|.\n$$\n对于欠阻尼状态（即 $\\alpha_k  \\omega_k$），模态品质因数 $Q_k$ 和阻尼角频率 $\\omega_{d,k}$ 分别为\n$$\nQ_k = \\frac{\\omega_k}{2\\alpha_k},\\qquad \\omega_{d,k} = \\sqrt{\\omega_k^2 - \\alpha_k^2}.\n$$\n当 $\\phi(k) = 0$ 时，将 $Q_k$ 解释为 $+\\infty$，$\\omega_{d,k} = \\omega_k$。\n\n校准目标：选择 $\\sigma_{\\mathrm{svv}}$、$r$ 和 $p$ 以抑制伪腔体共振，同时保持物理模态的品质因数和准确性。通过检查以下三个条件来量化这种权衡：\n- 伪模抑制：$Q_{\\mathrm{spur}} \\le Q_{\\max,\\mathrm{spur}}$。\n- 物理模态保持：$Q_{\\mathrm{phys}} \\ge Q_{\\min}$。\n- 物理频率准确性：$\\left|\\omega_{d,\\mathrm{phys}} - \\omega_{\\mathrm{phys}}\\right|/\\omega_{\\mathrm{phys}} \\le \\varepsilon_{\\mathrm{tol}}$，使用单位弧度/秒。\n\n此外，要求物理模态处于欠阻尼状态：$\\alpha_{\\mathrm{phys}}  \\omega_{\\mathrm{phys}}$。\n\n常数和单位：\n- 域长度 $L = 1\\,\\mathrm{m}$。\n- 声速 $c = 343\\,\\mathrm{m/s}$。\n- 品质因数阈值：$Q_{\\min} = 200$（无量纲）和 $Q_{\\max,\\mathrm{spur}} = 5$（无量纲）。\n- 频率准确性容差：$\\varepsilon_{\\mathrm{tol}} = 0.01$（无量纲，弧度/秒单位下相对误差的分数）。\n\n实现一个程序，对于下方的每个测试用例，计算一个布尔值，指示是否所有四个标准都同时满足：\n1. $N = 64$，$\\sigma_{\\mathrm{svv}} = 0.4\\,\\mathrm{m}^2/\\mathrm{s}$，$r = 0.8$，$p = 8$。\n2. $N = 64$，$\\sigma_{\\mathrm{svv}} = 0.05\\,\\mathrm{m}^2/\\mathrm{s}$，$r = 0.8$，$p = 8$。\n3. $N = 4$，$\\sigma_{\\mathrm{svv}} = 2.0\\,\\mathrm{m}^2/\\mathrm{s}$，$r = 0.1$，$p = 1$。\n4. $N = 64$，$\\sigma_{\\mathrm{svv}} = 0.35\\,\\mathrm{m}^2/\\mathrm{s}$，$r = 0.7$，$p = 6$。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如：$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是一个布尔值。所有频率必须按上述规定以弧度/秒为单位处理，长度以米为单位。不允许外部输入；请使用此处提供的常数和测试套件。", "solution": "该问题要求对应用于一维波动方程的谱消失粘性 (SVV) 阻尼方案的四个具体标准进行验证。对于每个由一组参数 $(N, \\sigma_{\\mathrm{svv}}, r, p)$ 定义的测试用例，我们必须确定是否所有标准都同时满足。\n\n单个傅里叶模态 $\\widehat{u}_k(t)$ 的控制方程以阻尼谐振子的形式给出：\n$$\n\\ddot{\\widehat{u}}_k + \\sigma_{\\mathrm{svv}}\\,\\phi(k)\\,k^2\\,\\dot{\\widehat{u}}_k + c^2 k^2 \\widehat{u}_k = 0.\n$$\n这是标准形式 $\\ddot{x} + 2\\alpha \\dot{x} + \\omega_0^2 x = 0$，其中无阻尼角频率为 $\\omega_k = c|k|$，阻尼系数为 $\\alpha_k = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\phi(k)k^2$。\n\n每个测试用例的验证过程如下：\n\n首先，我们基于所提供的参数 $N$ 和固定的域长度 $L=1\\,\\mathrm{m}$ 计算关键波数：\n关注的物理模态的波数为 $k_{\\mathrm{phys}} = \\frac{2\\pi}{L} = 2\\pi\\,\\mathrm{rad/m}$。\n具有 $N$ 个模态的数值网格支持的最大可分辨波数为 $k_{\\max} = \\frac{\\pi N}{L} = N\\pi\\,\\mathrm{rad/m}$。\n这个最大波数被视为一个代表性的伪模，因此 $k_{\\mathrm{spur}} = k_{\\max}$。\nSVV 滤波器函数 $\\phi(k)$ 依赖于截止波数 $k_c = r\\,k_{\\max}$。\n\n其次，我们分析物理模态 $k=k_{\\mathrm{phys}}$ 的行为。\n物理模态的无阻尼角频率为 $\\omega_{\\mathrm{phys}} = c\\,k_{\\mathrm{phys}} = 343 \\cdot 2\\pi\\,\\mathrm{rad/s}$。\nSVV 滤波器函数 $\\phi(k_{\\mathrm{phys}})$ 使用其定义进行计算：\n$$\n\\phi(k_{\\mathrm{phys}}) = \n\\begin{cases}\n0,  k_{\\mathrm{phys}} \\le k_c \\\\\n\\left(\\dfrac{k_{\\mathrm{phys}} - k_c}{k_{\\max} - k_c}\\right)^{p},  k_{\\mathrm{phys}} > k_c\n\\end{cases}\n$$\n物理模态的阻尼系数则为 $\\alpha_{\\mathrm{phys}} = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k_{\\mathrm{phys}})\\,k_{\\mathrm{phys}}^2$。\n利用这些值，我们检查与物理模态相关的三个标准：\n1.  **欠阻尼条件**：我们必须验证 $\\alpha_{\\mathrm{phys}}  \\omega_{\\mathrm{phys}}$。如果不满足此条件，则模态为临界阻尼或过阻尼，问题中关于振荡系统的品质因数和阻尼频率的表述将不适用。\n2.  **品质因数保持**：品质因数为 $Q_k = \\frac{\\omega_k}{2\\alpha_k}$。如果 $\\alpha_{\\mathrm{phys}} = 0$，则 $Q_{\\mathrm{phys}} = \\infty$。要检查的条件是 $Q_{\\mathrm{phys}} \\ge Q_{\\min}$，其中 $Q_{\\min} = 200$。\n3.  **频率准确性**：阻尼角频率为 $\\omega_{d,k} = \\sqrt{\\omega_k^2 - \\alpha_k^2}$。如果 $\\alpha_{\\mathrm{phys}} = 0$，则 $\\omega_{d,\\mathrm{phys}} = \\omega_{\\mathrm{phys}}$。相对频率误差必须满足 $\\frac{|\\omega_{d,\\mathrm{phys}} - \\omega_{\\mathrm{phys}}|}{\\omega_{\\mathrm{phys}}} \\le \\varepsilon_{\\mathrm{tol}}$，其中 $\\varepsilon_{\\mathrm{tol}} = 0.01$。这个不等式可以重写为 $1 - \\sqrt{1 - (\\alpha_{\\mathrm{phys}}/\\omega_{\\mathrm{phys}})^2} \\le \\varepsilon_{\\mathrm{tol}}$。\n\n第三，我们分析伪模 $k=k_{\\mathrm{spur}} = k_{\\max}$ 的行为。\n伪模的无阻尼角频率为 $\\omega_{\\mathrm{spur}} = c\\,k_{\\max}$。\n滤波器函数在 $k_{\\mathrm{spur}}$ 处求值。由于 $r \\in [0,1)$，我们有 $k_c  k_{\\max}$。因此，$k_{\\mathrm{spur}} = k_{\\max} > k_c$，滤波器函数的值为：\n$$\n\\phi(k_{\\mathrm{spur}}) = \\phi(k_{\\max}) = \\left(\\dfrac{k_{\\max} - k_c}{k_{\\max} - k_c}\\right)^{p} = 1^p = 1.\n$$\n伪模的阻尼系数是 $\\alpha_{\\mathrm{spur}} = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,\\phi(k_{\\mathrm{spur}})\\,k_{\\mathrm{spur}}^2 = \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,k_{\\max}^2$。\n利用这些值，我们检查伪模的单一标准：\n4.  **伪模抑制**：品质因数为 $Q_{\\mathrm{spur}} = \\frac{\\omega_{\\mathrm{spur}}}{2\\alpha_{\\mathrm{spur}}}$。将 $\\omega_{\\mathrm{spur}}$ 和 $\\alpha_{\\mathrm{spur}}$ 的表达式代入，得到：\n$$\nQ_{\\mathrm{spur}} = \\frac{c\\,k_{\\max}}{2 \\cdot \\frac{1}{2}\\sigma_{\\mathrm{svv}}\\,k_{\\max}^2} = \\frac{c}{\\sigma_{\\mathrm{svv}}\\,k_{\\max}}.\n$$\n该品质因数必须很小，满足 $Q_{\\mathrm{spur}} \\le Q_{\\max,\\mathrm{spur}}$，其中 $Q_{\\max,\\mathrm{spur}} = 5$。如果模态是过阻尼的，即 $\\alpha_{\\mathrm{spur}} \\ge \\omega_{\\mathrm{spur}}$，其有效品质因数小于或等于 0.5，这将自动满足该条件。$Q_{\\mathrm{spur}}$ 的公式对于此检查仍然有效。\n\n最后，对于一个给定的测试用例，当且仅当上述所有四个条件都满足时，结果为 `True`。否则，结果为 `False`。此过程系统地应用于所提供的四个测试用例中的每一个。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the SVV validation for all test cases.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    L = 1.0  # m\n    c = 343.0  # m/s\n    Q_min = 200.0  # dimensionless\n    Q_max_spur = 5.0  # dimensionless\n    epsilon_tol = 0.01  # dimensionless\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, sigma_svv, r, p)\n        (64, 0.4, 0.8, 8),\n        (64, 0.05, 0.8, 8),\n        (4, 2.0, 0.1, 1),\n        (64, 0.35, 0.7, 6),\n    ]\n\n    def check_case(N, sigma_svv, r, p):\n        \"\"\"\n        Validates a single set of SVV parameters against the four criteria.\n\n        Args:\n            N (int): Number of Fourier modes.\n            sigma_svv (float): SVV amplitude (m^2/s).\n            r (float): Cutoff ratio for the SVV filter.\n            p (float): Exponent for the SVV filter.\n\n        Returns:\n            bool: True if all criteria are met, False otherwise.\n        \"\"\"\n        # Step 1: Calculate wavenumbers\n        k_max = np.pi * N / L\n        k_phys = 2.0 * np.pi / L\n        k_spur = k_max\n        k_c = r * k_max\n\n        # --- Step 2: Analyze the Physical Mode (k_phys) ---\n\n        # Calculate phi(k_phys)\n        if k_phys = k_c:\n            phi_phys = 0.0\n        else:\n            phi_phys = ((k_phys - k_c) / (k_max - k_c))**p\n\n        # Calculate omega_phys and alpha_phys\n        omega_phys = c * k_phys\n        alpha_phys = 0.5 * sigma_svv * phi_phys * k_phys**2\n\n        # Criterion 4: Physical mode must be underdamped\n        is_phys_underdamped = (alpha_phys  omega_phys)\n        if not is_phys_underdamped:\n            return False\n\n        # Criterion 2: Physical mode quality factor preservation (Q_phys >= Q_min)\n        if alpha_phys == 0.0:\n            q_phys = float('inf')\n        else:\n            q_phys = omega_phys / (2.0 * alpha_phys)\n        \n        is_q_phys_preserved = (q_phys >= Q_min)\n\n        # Criterion 3: Physical mode frequency accuracy\n        if alpha_phys == 0.0:\n            freq_error_phys = 0.0\n        else:\n            # Using stable formula: 1 - sqrt(1 - (alpha/omega)^2)\n            ratio_sq = (alpha_phys / omega_phys)**2\n            freq_error_phys = 1.0 - np.sqrt(1.0 - ratio_sq)\n        \n        is_freq_accurate = (freq_error_phys = epsilon_tol)\n\n        # --- Step 3: Analyze the Spurious Mode (k_spur) ---\n\n        # For the spurious mode k_spur = k_max, phi(k_spur) is always 1\n        # Q_spur simplifies to c / (sigma_svv * k_max)\n        q_spur = c / (sigma_svv * k_max)\n\n        # Criterion 1: Spurious mode suppression (Q_spur = Q_max_spur)\n        is_spur_suppressed = (q_spur = Q_max_spur)\n\n        # Final check: all conditions must be true\n        return (is_q_phys_preserved and \n                is_freq_accurate and \n                is_spur_suppressed and \n                is_phys_underdamped)\n\n    results = []\n    for case in test_cases:\n        N, sigma_svv, r, p = case\n        result = check_case(N, sigma_svv, r, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3419895"}]}