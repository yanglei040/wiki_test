{"hands_on_practices": [{"introduction": "一个优秀的限制器应当是“隐形”的，只在必要时才启动。首要任务是设计一个“问题单元”指示器，它能可靠地区分真实的非物理振荡（如激波附近）和复杂的但光滑的流动特征（如涡旋），以避免不必要的精度损失。这项练习将通过比较不同的传感器方案，磨练您设计鲁棒数值算法的物理直觉和判断力[@problem_id:3421984]。", "problem": "考虑状态向量为 $\\mathbf{U} = (\\rho, \\rho u, \\rho v, \\rho E)^{\\top}$ 的二维可压缩欧拉方程的守恒形式，\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\n该方程在一个非结构网格上使用多项式次数为 $p$ 的高阶间断伽辽金（DG）方法进行离散。为确保在存在激波和接触间断情况下的鲁棒性，可以使用一个子单元有限体积限制器。当在标记的单元中激活时，该限制器将DG多项式投影到每个单元的 $N_{\\text{sub}}$ 个有限体积子单元上，使用总变差递减（TVD）通量执行单调更新，并重构一个守恒多项式。一个问题单元指示器决定是否预先激活限制器，而一个后验的多维最优阶数检测（MOOD）接受阶段则根据可接受性标准评估高阶更新或限制器更新。\n\n现有三类光滑度/压缩指示器：\n- 一个 Persson–Peraire 风格的模态衰减检测器：在每个单元中，将归一化高阶模态能量分数 $I_{\\text{pp}} \\in [0,1]$ 定义为最高阶模态块所携带的能量与总多项式能量之比。对于足够光滑的 $\\mathbf{U}$，谱衰减意味着 $I_{\\text{pp}}$ 很小，而光滑度的丧失则导致较大的 $I_{\\text{pp}}$。\n- 一个基于膨胀的压缩敏感激波传感器：定义无量纲膨胀 $d^{*} = -\\frac{h}{a}\\,\\nabla \\cdot \\mathbf{u}$，其中 $h$ 是特征单元尺寸，$a$ 是当地声速，$\\mathbf{u}=(u,v)$，并设置 $I_{\\text{div}} = \\max(0, d^{*})$。强压缩会产生大的 $I_{\\text{div}}$，而纯剪切和涡旋运动则有 $I_{\\text{div}} \\approx 0$。\n- 一个涡旋活动指示器：定义无量纲涡量大小 $\\omega^{*} = \\frac{h\\,\\lVert \\nabla \\times \\mathbf{u} \\rVert}{\\lVert \\mathbf{u} \\rVert + \\delta}$，其中有一个小的 $\\delta>0$ 以避免除以零，并设置 $I_{\\omega} = \\omega^{*}$。分辨率不足的涡有较大的 $I_{\\omega}$，激波由于剪切层的存在可能具有中等的 $I_{\\omega}$，但通常表现出比 $I_{\\omega}$ 大得多的 $I_{\\text{div}}$。\n\n多维最优阶数检测（MOOD）接受阶段强制执行物理可接受性：密度 $\\rho$ 和压力 $p$ 的正性，内能 $e$ 的松弛不变域的保持，以及对每个单元及其直接邻居上的选定变量应用离散局部最大值原理。\n\n现要求您在一个包含三个代表性单元的场景中，比较候选预先传感器的行为：\n- 单元 $E_{1}$（以中等马赫数平流的分辨不足的等熵涡核）：$I_{\\text{pp}} = 0.20$, $I_{\\text{div}} = 0.01$, $I_{\\omega} = 1.00$。\n- 单元 $E_{2}$（与单元相交的马赫数为 $M_{s}$ 的静止正激波）：$I_{\\text{pp}} = 0.50$, $I_{\\text{div}} = 2.00$, $I_{\\omega} = 0.20$。\n- 单元 $E_{3}$（无净压缩的接触/剪切层）：$I_{\\text{pp}} = 0.30$, $I_{\\text{div}} = 0.05$, $I_{\\omega} = 0.40$。\n\n假设选择阈值 $0  \\tau_{\\text{pp}}, \\tau_{\\text{div}}  1$ 以便仅在指示器足够大时触发预先限制，并且除非另有明确说明，否则总是在更新后执行 MOOD 接受测试。目标是最小化像 $E_{1}$ 这样分辨率不足的涡旋区域中的假阳性（不必要的限制），同时可靠地捕捉 $E_{2}$ 中的激波，并避免在 $E_{3}$ 中进行过度限制。\n\n基于谱衰减、可压缩性和涡旋判别的第一性原理，并与MOOD接受阶段协同作用，以下哪种混合传感器设计最能实现所述目标？\n\nA. 定义压缩-涡量门\n$$\nr = \\frac{I_{\\text{div}}}{I_{\\text{div}} + I_{\\omega} + \\varepsilon}, \\quad \\varepsilon = 10^{-3},\n$$\n和混合预先传感器\n$$\nS_{A} = I_{\\text{pp}} \\, r.\n$$\n如果 $S_{A}  \\tau_{\\text{pp}}$，则对单元进行预先限制；否则，接受高阶更新，除非MOOD拒绝它，在这种情况下回退到子单元有限体积方法。所有指示器都由 $h$ 和当地声速 $a$ 无量纲化，以确保网格和马赫数的鲁棒性。\n\nB. 定义加性预先传感器\n$$\nS_{B} = I_{\\text{pp}} + I_{\\text{div}},\n$$\n如果 $S_{B}  \\tau$，则对单元进行限制。仅对已经限制的单元应用MOOD接受测试；如果MOOD失败，则使用更具耗散性的通量重新限制。\n\nC. 定义涡量放大的光滑度传感器\n$$\nS_{C} = I_{\\text{pp}} \\left(1 + I_{\\omega}\\right),\n$$\n如果 $S_{C}  \\tau$，则对单元进行限制。依赖更新后的MOOD接受测试来捕捉任何残余振荡。\n\nD. 使用纯膨胀激波传感器\n$$\nS_{D} = I_{\\text{div}},\n$$\n如果 $S_{D}  \\tau_{\\text{div}}$，则对单元进行限制。禁用MOOD接受测试以减少开销；相信压缩是激波和间断的主要标志。\n\n选择唯一最佳选项，并通过分析 $E_{1}$、$E_{2}$ 和 $E_{3}$，利用压缩性运动和涡旋运动之间的基本区别以及光滑场与非光滑场的谱衰减行为来论证该选择。", "solution": "题目陈述经评估是有效的。它在科学上基于计算流体力学高阶数值方法的既定理论，特别是关于可压缩欧拉方程的激波捕捉技术。该问题是适定的、客观的，并提供了充分、一致的数据和定义，以便对所提出的选项进行严格评估。\n\n目标是确定最佳的混合传感器设计，该设计能可靠地为激波（单元 $E_{2}$）触发数值限制，避免为分辨率不足的光滑涡（单元 $E_{1}$）进行不必要的限制，并谨慎处理接触/剪切层（单元 $E_{3}$），所有这些都在一个包含后验多维最优阶数检测（MOOD）以进行物理可接受性检查的鲁棒框架内。\n\n我们有以下三个代表性单元的数据：\n- 单元 $E_{1}$（等熵涡）：$I_{\\text{pp}} = 0.20$, $I_{\\text{div}} = 0.01$, $I_{\\omega} = 1.00$。\n- 单元 $E_{2}$（正激波）：$I_{\\text{pp}} = 0.50$, $I_{\\text{div}} = 2.00$, $I_{\\omega} = 0.20$。\n- 单元 $E_{3}$（接触/剪切层）：$I_{\\text{pp}} = 0.30$, $I_{\\text{div}} = 0.05$, $I_{\\omega} = 0.40$。\n\n让我们通过计算每个单元的传感器值来分析每个选项。\n\n### 选项 A 分析\n\n传感器定义为 $S_{A} = I_{\\text{pp}} \\, r$，其中压缩-涡量门是 $r = \\frac{I_{\\text{div}}}{I_{\\text{div}} + I_{\\omega} + \\varepsilon}$，$\\varepsilon = 10^{-3}$。该传感器设计用一个因子 $r$ 来调制谱衰减指示器 $I_{\\text{pp}}$，当压缩（$I_{\\text{div}}$）主导涡量（$I_{\\omega}$）时，$r$ 接近 $1$，否则接近 $0$。\n\n- **对于单元 $E_{1}$（涡）：**\n在这里，涡量主导压缩：$I_{\\text{div}} = 0.01 \\ll I_{\\omega} = 1.00$。\n$$\nr = \\frac{0.01}{0.01 + 1.00 + 0.001} = \\frac{0.01}{1.011} \\approx 0.00989\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.20 \\times 0.00989 \\approx 0.00198\n$$\n传感器值极小。这正确地将该单元识别为从激波捕捉的角度来看没有问题的单元，从而避免了假阳性并保持了光滑涡的高阶精度。此行为符合所述目标。\n\n- **对于单元 $E_{2}$（激波）：**\n在这里，压缩主导涡量：$I_{\\text{div}} = 2.00 \\gg I_{\\omega} = 0.20$。\n$$\nr = \\frac{2.00}{2.00 + 0.20 + 0.001} = \\frac{2.00}{2.201} \\approx 0.9087\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.50 \\times 0.9087 \\approx 0.454\n$$\n传感器值很大，接近原始谱指示器 $I_{\\text{pp}}=0.50$。对于任何合理的阈值 $\\tau_{\\text{pp}} \\in (0,1)$（例如 $\\tau_{\\text{pp}} \\sim 0.1-0.2$），这将可靠地触发预先限制，从而正确捕捉激波。此行为符合所述目标。\n\n- **对于单元 $E_{3}$（接触/剪切层）：**\n在这里，涡量显著而压缩可忽略不计：$I_{\\text{div}} = 0.05, I_{\\omega} = 0.40$。\n$$\nr = \\frac{0.05}{0.05 + 0.40 + 0.001} = \\frac{0.05}{0.451} \\approx 0.1109\n$$\n$$\nS_{A} = I_{\\text{pp}} \\cdot r = 0.30 \\times 0.1109 \\approx 0.0332\n$$\n该值很小，远低于原始的 $I_{\\text{pp}}=0.30$。传感器不太可能触发预先限制。这是一个理想的结果。接触间断不像激波那样内在地违反物理可接受性。通过不进行预先限制，决策被传递给后验的MOOD阶段。如果接触间断的高阶更新被证明是物理上可接受的（例如，保持 $\\rho$ 和 $p$ 为正），则正确地避免了限制器。如果它产生导致违反可接受性的振荡，MOOD将拒绝该更新并回退到限制器。这种针对模糊情况的“信任但验证”方法是鲁棒且高效格式的一个标志。\n\n整体策略，即将这种智能预先传感器与最终的MOOD检查相结合，是合理的，并代表了一种现代、有效的激波捕捉方法。\n\n**结论：正确。**\n\n### 选项 B 分析\n\n传感器是 $S_{B} = I_{\\text{pp}} + I_{\\text{div}}$。该策略仅对已经限制的单元应用MOOD。\n\n- **对于单元 $E_{1}$（涡）：** $S_{B} = 0.20 + 0.01 = 0.21$。这个值很显著，很可能超过一个选定的阈值 $\\tau \\in (0,1)$，导致不必要的限制（假阳性）。\n- **对于单元 $E_{2}$（激波）：** $S_{B} = 0.50 + 2.00 = 2.50$。这个值非常大，会正确触发限制。\n- **对于单元 $E_{3}$（剪切层）：** $S_{B} = 0.30 + 0.05 = 0.35$。这个值也很显著，很可能触发限制。\n\n批判：传感器 $S_{B}$ 不能有效地区分激波和涡，未能实现一个主要目标。更关键的是，所提出的仅对已限制单元应用MOOD的策略存在根本性缺陷。像MOOD这样的后验格式的基本作用是验证高阶、未限制解的物理可接受性。通过跳过此检查，该方法冒着接受非物理（例如，具有负密度）高阶更新的风险，这可能导致灾难性的模拟失败。\n\n**结论：不正确。**\n\n### 选项 C 分析\n\n传感器是 $S_{C} = I_{\\text{pp}} \\left(1 + I_{\\omega}\\right)$。\n\n- **对于单元 $E_{1}$（涡）：** $S_{C} = 0.20 \\times (1 + 1.00) = 0.40$。这个传感器*放大*了涡旋区域的响应，产生一个很高的值。这与期望的行为完全相反，会导致很高的假阳性率。\n- **对于单元 $E_{2}$（激波）：** $S_{C} = 0.50 \\times (1 + 0.20) = 0.60$。这个高值正确地识别了激波。\n- **对于单元 $E_{3}$（剪切层）：** $S_{C} = 0.30 \\times (1 + 0.40) = 0.42$。这个高值很可能触发不必要的限制。\n\n批判：该传感器的设计对涡量敏感，这直接与*避免*在涡旋区域进行限制的目标相矛盾。它是一个“涡量检测器”，而不是一个选择性的激波检测器。\n\n**结论：不正确。**\n\n### 选项 D 分析\n\n传感器是 $S_{D} = I_{\\text{div}}$。该策略是完全禁用MOOD。\n\n- **对于单元 $E_{1}$（涡）：** $S_{D} = 0.01$。该值非常低，正确地避免了限制。\n- **对于单元 $E_{2}$（激波）：** $S_{D} = 2.00$。该值非常高，正确地触发了限制。\n- **对于单元 $E_{3}$（剪切层）：** $S_{D} = 0.05$。该值非常低。此传感器将无法标记剪切层。虽然剪切层是非压缩性的，但它们是尖锐的间断，高阶方法可能会在此产生伪振荡（吉布斯现象）。其非光滑性由 $I_{\\text{pp}} = 0.30$ 捕捉，而此传感器忽略了这一点。\n\n批判：虽然 $S_D$ 在区分激波和涡方面是有效的，但它对像接触间断这样的非压缩性间断视而不见，而这些间断也需要稳定化。最严重的缺陷是禁用了MOOD接受阶段。MOOD是保证物理可接受性的最终安全网。为了微小的性能增益而移除它，牺牲了整个数值格式的鲁棒性，使其在遇到像 $E_3$ 中的剪切层这样的现象时容易失败。\n\n**结论：不正确。**\n\n### 最终结论\n\n选项A提出了最精巧且恰当的解决方案。其混合传感器 $S_A$ 是为解决核心挑战而明确设计的：区分压缩性间断（激波）和非压缩性但分辨率不足的光滑特征（涡）。它正确地利用了谱指示器 $I_{\\text{pp}}$ 进行广义间断检测，并使用压缩-涡量门 $r$ 来滤除由涡引起的假阳性。对于像剪切层这样的模糊情况，以及作为一个通用的安全网，它依赖于后验的MOOD检查，这构成了一个鲁棒且平衡良好的策略。", "answer": "$$\\boxed{A}$$", "id": "3421984"}, {"introduction": "一旦某个单元被标记为“问题单元”，下一步就是执行限制过程本身，即将振荡的高阶多项式投影到一个更稳定的分段表示上。这个思想实验将引导您比较两种核心的投影哲学——$L^2$ 投影与 $L^1$ 最小化——从而深刻理解它们如何处理激波，以及为何总变差（Total Variation, TV）约束对于获得清晰、无色散的激波至关重要[@problem_id:3422011]。", "problem": "考虑守恒形式下的一维 ($1\\text{-}\\mathrm{D}$) 可压缩欧拉方程，其守恒变量向量为 $\\mathbf{u}(x,t)=\\big(\\rho(x,t),\\,\\rho(x,t)u(x,t),\\,E(x,t)\\big)$，\n$$\n\\partial_t \\mathbf{u}(x,t) + \\partial_x \\mathbf{f}(\\mathbf{u}(x,t)) = \\mathbf{0},\n$$\n其中物理通量 $\\mathbf{f}(\\mathbf{u})$ 由质量、动量和能量守恒的常规关系以及恒定的比热比 $\\gamma1$ 确定。假设一个黎曼问题的初值条件产生了一个满足熵条件的激波。在一个多项式阶数为 $p$ 的间断 Galerkin (DG) 方法中，对于一个单元 $K=[x_L,x_R]$，DG 表示是一个阶数至多为 $p$ 的多项式 $\\mathbf{u}_h(x)$，其模态谱在间断附近可能表现出 Gibbs 型振荡。当 $\\mathbf{u}_h(x)$ 的局部变化表明可能存在非物理振荡时，问题单元指示器会标记单元 $K$。\n\n子单元有限体积限制器将 $K$ 划分成 $M$ 个等长的子单元 $K_m$（其界面为 $x_L=x_1  x_2  \\dots  x_{M+1}=x_R$），并寻求一个新的、被限制的分段常数解 $\\mathbf{u}_M(x)$（在每个子单元 $K_m$ 上取值为 $\\bar{\\mathbf{u}}_m$），该解需满足守恒和正性约束。这可以通过两种不同的哲学实现：\n\n1.  **$L^2$ 投影**：在满足约束的条件下，最小化与原始DG多项式的 $L^2$ 差异，即 $\\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_2^2\\,\\mathrm{d}x$。\n2.  **带总变差(TV)约束的 $L^1$ 最小化**：在满足约束的条件下，最小化 $L^1$ 差异，即 $\\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_1\\,\\mathrm{d}x$，同时强制执行一个额外的总变差界限 $TV_K(\\{\\bar{w}_m\\}) \\le TV_{\\mathrm{nb}}$，其中 $\\{w_m\\}$ 是从 $\\{\\bar{\\mathbf{u}}_m\\}$ 派生的一组特征变量，$TV_{\\mathrm{nb}}$ 是根据相邻单元估计的TV界限。\n\n现在，请对以下关于这两种策略的假设进行评估，并选出所有科学上合理的论述。\n\nA. 如果间断严格位于 $K$ 内部，且 $\\mathbf{u}_h(x)$ 在 $x_s$ 附近表现出由最高阶模态主导的 Gibbs 振荡，那么具有显式总变差界限和正性强制的 $L^1$ 数据保真度会产生一个具有单个主导跳跃且激波前后涟漪可忽略的子单元场，从而保持总变差并最小化色散；而 $L^2$ 投影会将跳跃分布在多个子单元上，除非激波恰好与子单元界面重合。\n\nB. 当问题单元包含具有缓和梯度的光滑剖面，相邻单元也光滑（无振荡），且激波位于 $K$ 外部时，满足守恒和正性约束的 $L^2$ 投影与 $L^1$ 相比，不会增加总变差并能最小化色散，而 $L^1$ 倾向于产生阶梯状效应并且可能增大总变差。\n\nC. 对于任何激波强度和位置，强制施加守恒和熵不等式足以使 $L^2$ 投影成为总变差递减 (TVD) 的，而 $L^1$ 最小化除非添加额外的耗散，否则不能成为 TVD。\n\nD. 如果子单元数量等于多项式阶数加一，并且激波马赫数超过一个固定阈值，只要重构是在特征变量中完成的，$L^2$ 投影将最小化色散，而无论对齐情况如何，$L^1$ 最小化总是会增加总变差。", "solution": "问题陈述要求对一维可压缩欧拉方程的间断 Galerkin (DG) 方法中的两种子单元重构策略进行批判性比较：一种基于 $L^2$ 投影，另一种基于带总变差 (TV) 约束的 $L^1$ 最小化。目标是假设在何种条件下，每种方法能最好地保持总变差，同时最小化色散，尤其是在激波附近。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：一维可压缩欧拉方程，$\\partial_t \\mathbf{u} + \\partial_x \\mathbf{f}(\\mathbf{u}) = \\mathbf{0}$。\n-   **状态向量**：$\\mathbf{u} = (\\rho, \\rho u, E)$。\n-   **气体动力学**：理想气体，比热比为常数 $\\gamma  1$。\n-   **数值格式**：间断 Galerkin (DG) 方法，多项式阶数为 $p$。\n-   **解的表示**：在单元 $K=[x_L,x_R]$ 中，解是一个阶数至多为 $p$ 的多项式 $\\mathbf{u}_h(x)$。\n-   **限制器**：一个子单元有限体积限制器对显示出潜在非物理振荡的“问题单元”$K$ 启动。\n-   **子单元离散化**：$K$ 被划分为 $M$ 个等长的子单元，$K = \\cup_{m=1}^M K_m$。被限制的解是一个分段常数场 $\\mathbf{u}_M(x)$，其值为 $\\{\\bar{\\mathbf{u}}_m\\}_{m=1}^M$。\n-   **重构的约束条件**：\n    1.  **守恒性**：单元平均值被保持：$\\frac{1}{|K|}\\int_K \\mathbf{u}_M(x)\\,\\mathrm{d}x=\\frac{1}{|K|}\\int_K \\mathbf{u}_h(x)\\,\\mathrm{d}x$。这意味着 $\\frac{1}{M}\\sum_{m=1}^M \\bar{\\mathbf{u}}_m = \\bar{\\mathbf{u}}_h$，其中 $\\bar{\\mathbf{u}}_h$ 是 DG 多项式的单元平均值。\n    2.  **正性**：与每个 $\\bar{\\mathbf{u}}_m$ 对应的密度 $\\rho$ 和压力 $p$ 必须为正。\n-   **重构策略**：\n    1.  **$L^2$ 投影**：在约束条件下最小化 $\\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_2^2\\,\\mathrm{d}x$。\n    2.  **$L^1$ 最小化**：在约束条件下最小化 $\\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_1\\,\\mathrm{d}x$，并附加一个总变差界限 $TV_K(\\{\\bar{w}_m\\}) \\le TV_{\\mathrm{nb}}$。\n-   **总变差**：$TV_K(\\{\\bar{w}_m\\})=\\sum_{m=1}^{M-1}|\\bar{w}_{m+1}-\\bar{w}_m|$，对于一个选定的变量集 $\\{w_m\\}$。\n-   **变量空间**：重构在特征变量中执行。\n-   **思想实验的场景**：\n    1.  一个激波位于 $x_s \\in (x_L, x_R)$，且 $\\mathbf{u}_h(x)$ 具有 Gibbs 振荡。\n    2.  $K$ 中的解 $\\mathbf{u}_h(x)$ 是具有缓和梯度的光滑剖面（激波在 $K$ 外部）。\n\n### 步骤 2：验证问题陈述\n该问题定义明确且有科学依据。它描述了计算流体力学中一个复杂且前沿的课题：使用子单元限制器的高阶激波捕捉。所有术语——DG 方法、欧拉方程、Gibbs 现象、$L^1$ 和 $L^2$ 范数、总变差、特征变量——都是该领域的标准术语。这两种重构策略是适定的优化问题，并反映了研究代码中使用的实际方法。这些场景是相关的，并允许对这些方法的基本属性进行清晰的比较。问题陈述不包含科学或数学上的缺陷、矛盾或歧义。这是一个有效的概念性问题。\n\n### 步骤 3：从第一性原理进行推导和分析\n\n让我们基于基本的数学性质来分析这两种重构策略。\n\n**$L^2$ 投影策略**\n目标是最小化 $J_{L^2} = \\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_2^2\\,\\mathrm{d}x = \\sum_{m=1}^M \\int_{K_m} \\|\\mathbf{u}_h(x)-\\bar{\\mathbf{u}}_m\\|_2^2\\,\\mathrm{d}x$。标准变分法表明，如果只受守恒约束，子单元平均值 $\\{\\bar{\\mathbf{u}}_m\\}$ 的最小化解是通过将多项式 $\\mathbf{u}_h(x)$ 投影到子网格上的分段常数函数空间上来获得的。这意味着每个子单元平均值 $\\bar{\\mathbf{u}}_m$ 只是 DG 多项式 $\\mathbf{u}_h(x)$ 在该子单元 $K_m$ 上的平均值：\n$$ \\bar{\\mathbf{u}}_m^{L^2} = \\frac{1}{|K_m|} \\int_{K_m} \\mathbf{u}_h(x) \\,\\mathrm{d}x $$\n这个过程是一个线性平均或平滑操作。正性约束是一个额外的非线性不等式约束，但 $L^2$ 方法的基本性质是平均。\n\n**带 TV 约束的 $L^1$ 最小化策略**\n目标是最小化误差的 $L^1$ 范数，$J_{L^1} = \\int_K \\|\\mathbf{u}_h(x)-\\mathbf{u}_M(x)\\|_1\\,\\mathrm{d}x$，同时满足守恒、正性和总变差的显式界限 $TV_K \\le TV_{\\mathrm{nb}}$。这是一个非线性的约束优化问题。$L^1$ 范数以及更关键的总变差约束，已知会偏好具有稀疏梯度的解，这意味着具有尖锐跳跃的分段常数解。这种方法论是总变差递减 (TVD)、基本无振荡 (ENO) 和加权基本无振荡 (WENO) 格式的核心，这些格式是专门为处理间断而不引入伪振荡而设计的。约束 $TV_{\\mathrm{nb}}$ 基于相邻单元的状态为局部变化提供了一个目标，旨在重现物理上无振荡的剖面。\n\n现在我们分析给定的场景：\n\n**场景 1：激波在单元 $K$ 内部**\nDG 多项式 $\\mathbf{u}_h(x)$ 近似一个阶跃函数，因此表现出 Gibbs 振荡。\n-   **$L^2$ 投影的效果**：应用平均算子 $\\bar{\\mathbf{u}}_m^{L^2} = \\text{avg}_{K_m}(\\mathbf{u}_h)$ 会将 $\\mathbf{u}_h(x)$ 中存在的振荡平均到子单元值中。这并不能消除振荡，而是将其抹平。激波的尖锐跳跃将被分散到几个子单元上，从而产生一个数值色散的剖面。由于被抹平的波纹，重构序列 $\\{\\bar{\\mathbf{u}}_m^{L^2}\\}$ 的总变差可能会很大。\n-   **$L^1$/TV 最小化的效果**：这种方法是为此情况量身定制的。TV 约束 $TV_K \\le TV_{\\mathrm{nb}}$ 明确惩罚或禁止振荡解。优化过程有效地充当一个滤波器，从 $\\mathbf{u}_h(x)$ 中去除高频 Gibbs 振荡。在低总变差约束下最小化 $L^1$ 误差的解，将是把间断合并为两个子单元之间的单个尖锐跳跃，两侧状态近似恒定。这会得到一个具有最小色散（一个尖锐跳跃）和受控总变差（无涟漪）的子单元场。\n\n**场景 2：单元 $K$ 内部为光滑剖面**\nDG 多项式 $\\mathbf{u}_h(x)$ 是光滑物理场解的一个高阶、精确的表示。该单元可能因为存在陡峭梯度而被标记为“问题”单元。\n-   **$L^2$ 投影的效果**：$L^2$ 投影产生 $\\bar{\\mathbf{u}}_m^{L^2} = \\text{avg}_{K_m}(\\mathbf{u}_h)$，这是在最小二乘意义下对光滑多项式 $\\mathbf{u}_h(x)$ 的最佳分段常数近似。它为光滑剖面提供了一个高质量的“阶梯状”表示。这是将函数投影到低维基函数空间上的标准且最优的方法。\n-   **$L^1$/TV 最小化的效果**：这种方法是为间断优化的。当应用于带有梯度的光滑剖面时，最小化总变差的倾向可能是有害的。它会在光滑梯度区域人为地使剖面变平，这种现象被称为“阶梯效应”。这会降低格式在光滑区域的理论精度。虽然 TVD 格式的目的不是增加总变差，但与 $L^2$ 投影相比，其应用可能导致对光滑数据表示的准确性降低。\n\n### 选项评估\n\n**A. 如果间断严格位于 $K$ 内部，且 $\\mathbf{u}_h(x)$ 在 $x_s$ 附近表现出由最高阶模态主导的 Gibbs 振荡，那么具有显式总变差界限和正性强制的 $L^1$ 数据保真度会产生一个具有单个主导跳跃且激波前后涟漪可忽略的子单元场，从而保持总变差并最小化色散；而 $L^2$ 投影会将跳跃分布在多个子单元上，除非激波恰好与子单元界面重合。**\n这个陈述与我们对场景 1 的分析完全一致。$L^1$/TV 方法被正确定位为一个振荡滤波器，能产生一个尖锐、无色散的跳跃。$L^2$ 投影被正确定位为一个平均过程，会抹平间断和相关的振荡。这个陈述是一个正确且可辩护的假设。\n**结论：正确**\n\n**B. 当问题单元包含具有缓和梯度的光滑剖面，相邻单元也光滑（无振荡），且激波位于 $K$ 外部时，满足守恒和正性约束的 $L^2$ 投影与 $L^1$ 相比，不会增加总变差并能最小化色散，而 $L^1$ 倾向于产生阶梯状效应并且可能增大总变差。**\n这个陈述与我们对场景 2 的分析一致。对于光滑剖面，$L^2$ 投影是数学上获得最佳拟合近似的自然选择，能保持光滑多项式的特征。$L^1$/TV 方法不适合这种情况，并可能降低精度，例如通过“阶梯效应”。在此背景下，$L^2$ 投影更优的论点是正确的。$L^1$ 倾向于产生阶梯效应是一个已知问题。关于它可能“增大总变差”的说法是合理的，因为由此产生的阶梯状近似的离散 TV 可能比直接采样光滑曲线更高，但关键在于精度的下降。这个陈述正确地指出了 $L^2$ 方法的适用范围。\n**结论：正确**\n\n**C. 对于任何激波强度和位置，强制施加守恒和熵不等式足以使 $L^2$ 投影成为总变差递减 (TVD) 的，而 $L^1$ 最小化除非添加额外的耗散，否则不能成为 TVD。**\n这个陈述从根本上是错误的。$L^2$ 投影是一个线性平均算子，其本身不是 TVD 的。它会传播振荡。强制施加守恒和熵是必要的，但不足以使一个格式成为 TVD。陈述的后半部分也是错误的；所描述的 $L^1$ 最小化*包含一个显式的 TV 约束*，这正是赋予其 TVD 属性的机制（类似于非线性耗散/限制）。该陈述曲解了两种方法的作用。\n**结论：不正确**\n\n**D. 如果子单元数量等于多项式阶数加一，并且激波马赫数超过一个固定阈值，只要重构是在特征变量中完成的，$L^2$ 投影将最小化色散，而无论对齐情况如何，$L^1$ 最小化总是会增加总变差。**\n这个陈述提出了一些未经证实且不正确的说法。条件 $M=p+1$ 关联了自由度，但并不能神奇地使具有色散性的 $L^2$ 投影对激波变得最优。马赫数的“固定阈值”是任意的。最重要的是，“$L^1$ 最小化*总是*会增加总变差”的说法是明显错误的。该方法的设计初衷就是通过一个 TV *界限*来防止总变差的增加。\n**结论：不正确**\n\n选项 A 和 B 都准确且互补地描述了两种重构方法的行为，正确地指出了各自在何种条件下更优。选项 A 描述了 $L^1$/TV 方法擅长的核心激波捕捉场景，而选项 B 描述了 $L^2$ 投影是更佳选择的光滑流场景。两者都是基于数值分析基本原理的有效假设。", "answer": "$$\\boxed{AB}$$", "id": "3422011"}, {"introduction": "限制器循环的最后一步是重构。在子单元平均值通过鲁棒的低阶有限体积方法更新后，我们必须从这些离散的平均值中重构出一个新的、光滑的高阶多项式，以便方法能无缝切换回高精度的 DG 框架。这项练习通过一个约束最小二乘问题，让您亲手实践这一守恒重构过程，这是混合 DG-FV 格式的一项基本技能[@problem_id:3422067]。", "problem": "考虑一个标量守恒律，它在坐标为 $\\xi \\in [-1,1]$ 的单个参考单元上通过间断伽辽金(DG)方法进行离散。一个子单元有限体积(FV)限制器在三个等尺寸的子单元 $I_{1}=[-1,-\\tfrac{1}{3}]$、$I_{2}=[-\\tfrac{1}{3},\\tfrac{1}{3}]$ 和 $I_{3}=[\\tfrac{1}{3},1]$ 上提供了分片常数的子单元平均值 $\\{m_{j}\\}_{j=1}^{3}$。您的任务是通过求解一个强制单元平均值守恒的约束最小二乘问题，在 $[-1,1]$ 上的二次勒让德基（即 $P_{0}(\\xi)=1$、$P_{1}(\\xi)=\\xi$ 和 $P_{2}(\\xi)=\\tfrac{1}{2}(3\\xi^{2}-1)$）中重构一个2次DG多项式 $u_{h}(\\xi)$。\n\n形式上，定义分片常数数据函数 $m(\\xi)$，当 $\\xi \\in I_{j}$ 时 $m(\\xi)=m_{j}$，并寻求\n$$\nu_{h}(\\xi)=c_{0}P_{0}(\\xi)+c_{1}P_{1}(\\xi)+c_{2}P_{2}(\\xi)\n$$\n以最小化平方 $L^{2}$ 差异\n$$\nJ(c_{0},c_{1},c_{2})=\\sum_{j=1}^{3}\\int_{I_{j}}\\left(u_{h}(\\xi)-m(\\xi)\\right)^{2}\\,d\\xi\n$$\n同时满足DG单元平均值等于FV计算的单元平均值的守恒约束，\n$$\n\\frac{1}{2}\\int_{-1}^{1}u_{h}(\\xi)\\,d\\xi=\\bar{m},\\quad \\bar{m}=\\frac{1}{2}\\sum_{j=1}^{3}\\int_{I_{j}}m(\\xi)\\,d\\xi=\\frac{m_{1}+m_{2}+m_{3}}{3}.\n$$\n推导出唯一的最小化子，并以 $\\xi$、$m_{1}$、$m_{2}$ 和 $m_{3}$ 的函数形式明确给出最终重构的多项式 $u_{h}(\\xi)$。您的最终答案必须是 $u_{h}(\\xi)$ 的一个无舍入、无单位的单一闭式解析表达式。", "solution": "该问题要求找到一个二次多项式 $u_{h}(\\xi)$，使其相对于分片常数函数 $m(\\xi)$ 的平方 $L^{2}$ 差异最小化，同时满足其单元平均值的积分约束。这是一个约束优化问题，可以使用拉格朗日乘子法求解，也可以通过直接引入约束来减少自由变量的数量。我们将采用后一种更直接的方法。\n\n待重构的多项式是2次的，并在区间 $[-1,1]$ 上的勒让德多项式基中表示：\n$$\nu_{h}(\\xi) = c_{0}P_{0}(\\xi) + c_{1}P_{1}(\\xi) + c_{2}P_{2}(\\xi)\n$$\n其中 $P_{0}(\\xi)=1$，$P_{1}(\\xi)=\\xi$，以及 $P_{2}(\\xi)=\\frac{1}{2}(3\\xi^{2}-1)$。\n\n该约束强制了单元平均值的守恒：\n$$\n\\frac{1}{2}\\int_{-1}^{1}u_{h}(\\xi)\\,d\\xi = \\bar{m}\n$$\n其中 $\\bar{m}$ 是子单元数据 $\\{m_{1}, m_{2}, m_{3}\\}$ 在单元 $[-1,1]$ 上的平均值。如题目所给，$\\bar{m} = \\frac{m_{1}+m_{2}+m_{3}}{3}$。我们首先分析这个约束。将 $u_{h}(\\xi)$ 的表达式代入约束积分中：\n$$\n\\frac{1}{2}\\int_{-1}^{1} \\left(c_{0}P_{0}(\\xi) + c_{1}P_{1}(\\xi) + c_{2}P_{2}(\\xi)\\right) \\,d\\xi = \\bar{m}\n$$\n勒让德多项式在 $[-1,1]$ 上是正交的，满足 $\\int_{-1}^{1}P_{n}(\\xi)P_{k}(\\xi)\\,d\\xi = \\frac{2}{2n+1}\\delta_{nk}$。我们可以将该积分写成与 $P_{0}(\\xi)=1$ 的内积。\n$$\n\\frac{1}{2}\\int_{-1}^{1} u_{h}(\\xi)P_{0}(\\xi)\\,d\\xi = \\frac{1}{2} \\left( c_{0}\\int_{-1}^{1}P_{0}^{2}(\\xi)\\,d\\xi + c_{1}\\int_{-1}^{1}P_{1}(\\xi)P_{0}(\\xi)\\,d\\xi + c_{2}\\int_{-1}^{1}P_{2}(\\xi)P_{0}(\\xi)\\,d\\xi \\right) = \\bar{m}\n$$\n由于正交性，涉及 $P_1 P_0$ 和 $P_2 P_0$ 的积分为零。第一个积分得出 $\\int_{-1}^{1}P_{0}^{2}(\\xi)\\,d\\xi = \\int_{-1}^{1}1^{2}\\,d\\xi = 2$。\n约束简化为：\n$$\n\\frac{1}{2} (c_{0} \\cdot 2) = c_{0} = \\bar{m} = \\frac{m_{1}+m_{2}+m_{3}}{3}\n$$\n因此，守恒约束直接确定了第一个系数 $c_{0}$。\n\n问题现在简化为在 $c_{0}$ 固定为 $\\bar{m}$ 的情况下，寻找最小化目标函数 $J$ 的系数 $c_{1}$ 和 $c_{2}$。\n$$\nJ(c_{1},c_{2}) = \\int_{-1}^{1} \\left(u_{h}(\\xi)-m(\\xi)\\right)^{2}\\,d\\xi\n$$\n为使 $J$ 达到最小值，其关于自由变量 $c_{1}$ 和 $c_{2}$ 的偏导数必须为零。\n$$\n\\frac{\\partial J}{\\partial c_{1}} = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)\\frac{\\partial u_{h}}{\\partial c_{1}}\\,d\\xi = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)P_{1}(\\xi)\\,d\\xi = 0\n$$\n$$\n\\frac{\\partial J}{\\partial c_{2}} = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)\\frac{\\partial u_{h}}{\\partial c_{2}}\\,d\\xi = \\int_{-1}^{1} 2\\left(u_{h}(\\xi)-m(\\xi)\\right)P_{2}(\\xi)\\,d\\xi = 0\n$$\n这些条件得出了一个关于 $c_1$ 和 $c_2$ 的二元线性方程组：\n1. $\\int_{-1}^{1} u_{h}(\\xi)P_{1}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)P_{1}(\\xi)\\,d\\xi$\n2. $\\int_{-1}^{1} u_{h}(\\xi)P_{2}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)P_{2}(\\xi)\\,d\\xi$\n\n让我们利用勒让德多项式的正交性来计算这些方程的左侧(LHS)：\n(1)的LHS：$\\int_{-1}^{1} (c_{0}P_{0}+c_{1}P_{1}+c_{2}P_{2})P_{1}\\,d\\xi = c_{1}\\int_{-1}^{1}P_{1}^{2}(\\xi)\\,d\\xi = c_{1}\\frac{2}{2(1)+1} = \\frac{2}{3}c_{1}$。\n(2)的LHS：$\\int_{-1}^{1} (c_{0}P_{0}+c_{1}P_{1}+c_{2}P_{2})P_{2}\\,d\\xi = c_{2}\\int_{-1}^{1}P_{2}^{2}(\\xi)\\,d\\xi = c_{2}\\frac{2}{2(2)+1} = \\frac{2}{5}c_{2}$。\n\n接下来，我们计算方程的右侧(RHS)。函数 $m(\\xi)$ 在子单元 $I_{1}=[-1,-\\frac{1}{3}]$、$I_{2}=[-\\frac{1}{3},\\frac{1}{3}]$ 和 $I_{3}=[\\frac{1}{3},1]$ 上是分片常数的。\n(1)的RHS：$\\int_{-1}^{1} m(\\xi)P_{1}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)\\xi\\,d\\xi$\n$$\n= \\int_{-1}^{-1/3} m_{1}\\xi\\,d\\xi + \\int_{-1/3}^{1/3} m_{2}\\xi\\,d\\xi + \\int_{1/3}^{1} m_{3}\\xi\\,d\\xi\n$$\n$$\n= m_{1}\\left[\\frac{\\xi^{2}}{2}\\right]_{-1}^{-1/3} + m_{2}\\left[\\frac{\\xi^{2}}{2}\\right]_{-1/3}^{1/3} + m_{3}\\left[\\frac{\\xi^{2}}{2}\\right]_{1/3}^{1}\n$$\n$$\n= m_{1}\\left(\\frac{1}{18}-\\frac{1}{2}\\right) + m_{2}\\left(\\frac{1}{18}-\\frac{1}{18}\\right) + m_{3}\\left(\\frac{1}{2}-\\frac{1}{18}\\right) = m_{1}\\left(-\\frac{8}{18}\\right) + m_{3}\\left(\\frac{8}{18}\\right) = \\frac{4}{9}(m_{3}-m_{1})\n$$\n令(1)的LHS和RHS相等：$\\frac{2}{3}c_{1} = \\frac{4}{9}(m_{3}-m_{1})$，可得 $c_{1} = \\frac{3}{2}\\frac{4}{9}(m_{3}-m_{1}) = \\frac{2}{3}(m_{3}-m_{1})$。\n\n(2)的RHS：$\\int_{-1}^{1} m(\\xi)P_{2}(\\xi)\\,d\\xi = \\int_{-1}^{1} m(\\xi)\\frac{1}{2}(3\\xi^{2}-1)\\,d\\xi$\n$$\n= \\frac{1}{2}\\left( m_{1}\\int_{-1}^{-1/3}(3\\xi^{2}-1)d\\xi + m_{2}\\int_{-1/3}^{1/3}(3\\xi^{2}-1)d\\xi + m_{3}\\int_{1/3}^{1}(3\\xi^{2}-1)d\\xi \\right)\n$$\n原函数是 $\\int(3\\xi^{2}-1)d\\xi = \\xi^{3}-\\xi$。令 $F(\\xi) = \\xi^{3}-\\xi$。\n$$\n\\int_{-1}^{-1/3}(3\\xi^{2}-1)d\\xi = F(-\\tfrac{1}{3}) - F(-1) = (-\\tfrac{1}{27}+\\tfrac{1}{3}) - (-1+1) = \\tfrac{8}{27}\n$$\n$$\n\\int_{-1/3}^{1/3}(3\\xi^{2}-1)d\\xi = F(\\tfrac{1}{3}) - F(-\\tfrac{1}{3}) = (\\tfrac{1}{27}-\\tfrac{1}{3}) - (-\\tfrac{1}{27}+\\tfrac{1}{3}) = 2(\\tfrac{1}{27}-\\tfrac{1}{3}) = -\\tfrac{16}{27}\n$$\n$$\n\\int_{1/3}^{1}(3\\xi^{2}-1)d\\xi = F(1) - F(\\tfrac{1}{3}) = (1-1) - (\\tfrac{1}{27}-\\tfrac{1}{3}) = \\tfrac{8}{27}\n$$\n因此，(2)的RHS为：\n$$\n\\frac{1}{2}\\left(m_{1}\\frac{8}{27} + m_{2}\\frac{-16}{27} + m_{3}\\frac{8}{27}\\right) = \\frac{4}{27}(m_{1}-2m_{2}+m_{3})\n$$\n令(2)的LHS和RHS相等：$\\frac{2}{5}c_{2} = \\frac{4}{27}(m_{1}-2m_{2}+m_{3})$，可得 $c_{2} = \\frac{5}{2}\\frac{4}{27}(m_{1}-2m_{2}+m_{3}) = \\frac{10}{27}(m_{1}-2m_{2}+m_{3})$。\n\n我们现在已经确定了所有系数：\n$c_{0} = \\frac{m_{1}+m_{2}+m_{3}}{3}$\n$c_{1} = \\frac{2}{3}(m_{3}-m_{1})$\n$c_{2} = \\frac{10}{27}(m_{1}-2m_{2}+m_{3})$\n\n最终重构的多项式为 $u_{h}(\\xi)=c_{0}P_{0}(\\xi)+c_{1}P_{1}(\\xi)+c_{2}P_{2}(\\xi)$。\n代入勒让德多项式和系数：\n$$\nu_{h}(\\xi) = \\left(\\frac{m_{1}+m_{2}+m_{3}}{3}\\right) + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\left(\\frac{10}{27}(m_{1}-2m_{2}+m_{3})\\right)\\left(\\frac{3\\xi^{2}-1}{2}\\right)\n$$\n为了得到关于 $\\xi$ 的标准多项式表达式，我们合并 $\\xi$ 的同次幂项。\n$\\xi^2$ 的系数是：$\\frac{10}{27}(m_{1}-2m_{2}+m_{3}) \\cdot \\frac{3}{2} = \\frac{5}{9}(m_{1}-2m_{2}+m_{3})$。\n$\\xi$ 的系数是：$\\frac{2}{3}(m_{3}-m_{1})$。\n常数项是：\n$$\nc_{0} - \\frac{1}{2}c_{2} = \\frac{m_{1}+m_{2}+m_{3}}{3} - \\frac{1}{2}\\frac{10}{27}(m_{1}-2m_{2}+m_{3})\n$$\n$$\n= \\frac{9(m_{1}+m_{2}+m_{3})}{27} - \\frac{5(m_{1}-2m_{2}+m_{3})}{27}\n$$\n$$\n= \\frac{9m_{1}+9m_{2}+9m_{3} - 5m_{1}+10m_{2}-5m_{3}}{27} = \\frac{4m_{1}+19m_{2}+4m_{3}}{27}\n$$\n合并这些项，我们得到重构多项式的最终表达式：\n$$\nu_{h}(\\xi) = \\left(\\frac{5}{9}(m_{1}-2m_{2}+m_{3})\\right)\\xi^{2} + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\frac{4m_{1}+19m_{2}+4m_{3}}{27}\n$$", "answer": "$$\n\\boxed{\\left(\\frac{5}{9}(m_{1}-2m_{2}+m_{3})\\right)\\xi^{2} + \\left(\\frac{2}{3}(m_{3}-m_{1})\\right)\\xi + \\frac{4m_{1}+19m_{2}+4m_{3}}{27}}\n$$", "id": "3422067"}]}