{"hands_on_practices": [{"introduction": "要证明线性平流方程下通量重构（FR）与节点间断Galerkin（DG）方法的等价性，最直接的方法是为两者显式地构建半离散算子矩阵。本练习将指导您完成这一过程，针对一个中等阶数（$N=3$）的情形，并通过数值计算来验证它们的恒等性，从而将理论推导与计算验证联系起来。这是理解两种方法内在联系的一个基础性练习[@problem_id:3385018]。", "problem": "考虑参考单元 $\\xi \\in [-1,1]$ 上的一维线性平流方程 $u_t + a u_x = 0$。设 $u_h(\\xi,t)$ 在多项式阶数为 $N$ 的 $N+1$ 个 Gauss–Lobatto–Legendre (GLL) 节点上用节点Lagrange基表示。本推导请使用以下基本依据：在不同节点上使用Lagrange多项式进行插值，对阶数为 $N$ 的多项式使用GLL权重进行精确求积，以及微分矩阵的定义，即插值多项式在各节点处的导数值。\n\n您将重点关注 $N=3$ 的情况，该情况下在参考区间上有4个GLL节点和4个GLL求积权重。用 $u \\in \\mathbb{R}^4$ 表示节点值的列向量，用 $M = \\mathrm{diag}(w_0,w_1,w_2,w_3)$ 表示对角质量矩阵，用 $D \\in \\mathbb{R}^{4 \\times 4}$ 表示微分矩阵，其定义为 $D_{ij} = \\ell_j'(\\xi_i)$，其中 $\\ell_j$ 是第 $j$ 个Lagrange基多项式，$\\xi_i$ 是节点。设两个边界面选择向量分别为 $e_L = [1,0,0,0]^T$ 和 $e_R = [0,0,0,1]^T$，分别对应于左右端点 $\\xi=-1$ 和 $\\xi=+1$。\n\n对于线性通量 $f(u) = a u$，根据内部 ($+$) 和外部 ($-$) 迹，定义界面处的数值通量 $f^*$ 如下：\n- 迎风通量：$f^* = \\begin{cases} a u^-  \\text{若 } a > 0, \\\\ a u^+  \\text{若 } a  0, \\\\ 0  \\text{若 } a=0, \\end{cases}$\n- 中心通量：$f^* = \\frac{a}{2}(u^- + u^+)$。\n\n对于单个单元，将其自身自由度对半离散强形式不连续Galerkin (DG) 算子的贡献写成矩阵 $A_{\\mathrm{DG}} \\in \\mathbb{R}^{4 \\times 4}$ 的形式，使得 $u_t = A_{\\mathrm{DG}} u + \\text{(相邻项)}$。类似地，根据修正通量，为同一单元写出通量重构 (FR) 算子 $A_{\\mathrm{FR}}$。您的推导必须从上述基本依据出发，导出显式的算子矩阵，不得依赖任何快捷公式。确保所有数学对象都用LaTeX表示。\n\n具体要求如下：\n1. 在 $[-1,1]$ 上构建 $N=3$ 的GLL节点 $\\{\\xi_i\\}_{i=0}^3$ 及其权重 $\\{w_i\\}_{i=0}^3$。\n2. 使用不同节点上的重心微分公式，根据这些节点上的Lagrange基构建微分矩阵 $D$。\n3. 对于DG强形式，使用 $D$、$M$ 以及左右边界面上 $(f^* - f)$ 的局部贡献来表示 $A_{\\mathrm{DG}}$。只包含 $(f^* - f)$ 中依赖于单元自身节点边界值 $u_L$ 和 $u_R$ 的部分；排除依赖于相邻单元的项。\n4. 对于FR，使用修正通量 $f_h = f(u) + (f^*_L - f_L) g_L + (f^*_R - f_R) g_R$，并用 $D$ 以及修正函数在节点上的离散导数 $\\{D g_L, D g_R\\}$ 来表示 $A_{\\mathrm{FR}}$。您的推导必须展示如何正确选择 $D g_L$ 和 $D g_R$，以在指定基下实现与DG的等价性。\n\n然后，您必须实现一个程序，为以下参数测试套件组装 $A_{\\mathrm{DG}}$ 和 $A_{\\mathrm{FR}}$，并为每种情况计算它们差值的Frobenius范数 $\\|A_{\\mathrm{FR}} - A_{\\mathrm{DG}}\\|_F$。测试涵盖不同的波速 $a$ 和通量类型：\n- 测试 1：$a=1.0$，迎风通量。\n- 测试 2：$a=-1.75$，迎风通量。\n- 测试 3：$a=1.0$，中心通量。\n- 测试 4：$a=-3.7$，中心通量。\n- 测试 5：$a=0.0$，迎风通量。\n\n所有答案都是无量纲的；不需要物理单位。您的程序的最终输出必须是单行，包含一个用方括号括起来的逗号分隔的浮点数列表，按上述测试顺序对应于各Frobenius范数（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\text{result5}]$）。输出必须是浮点数。", "solution": "目标是证明对于参考单元 $\\xi \\in [-1,1]$ 上的一维线性平流方程 $u_t + a u_x = 0$，强形式不连续Galerkin (DG) 方法的算子与通量重构 (FR) 方法的算子是等价的。分析是针对阶数为 $N=3$ 的多项式逼近进行的，使用了在 $N+1=4$ 个Gauss-Lobatto-Legendre (GLL) 点上定义的节点Lagrange基。\n\n问题的核心是从第一性原理推导半离散算子 $A_{\\mathrm{DG}}$ 和 $A_{\\mathrm{FR}}$，其中单元的节点值 $u$ 根据 $u_t = A u + \\text{(相邻贡献)}$ 进行演化。我们将证明，通过对FR修正函数的特定选择，$A_{\\mathrm{FR}}$ 会与 $A_{\\mathrm{DG}}$ 完全相同。\n\n**步骤1：GLL节点、权重和微分矩阵 ($N=3$)**\n\n对于阶数 $N=3$ 的多项式，我们在区间 $[-1,1]$ 上使用 $N+1=4$ 个GLL节点。这些节点是 $(1-\\xi^2)P_3'(\\xi)$ 的根，其中 $P_3(\\xi)$ 是3阶Legendre多项式。节点 $\\{\\xi_i\\}_{i=0}^3$ 为：\n$$ \\xi_0=-1, \\quad \\xi_1 = -\\sqrt{\\frac{1}{5}}, \\quad \\xi_2 = \\sqrt{\\frac{1}{5}}, \\quad \\xi_3 = 1 $$\n相应的GLL求积权重 $\\{w_i\\}_{i=0}^3$ 用于定义对角质量矩阵 $M=\\mathrm{diag}(w_0, w_1, w_2, w_3)$，其值为：\n$$ w_0 = \\frac{1}{6}, \\quad w_1 = \\frac{5}{6}, \\quad w_2 = \\frac{5}{6}, \\quad w_3 = \\frac{1}{6} $$\n微分矩阵 $D$ 的元素为 $D_{ij} = \\ell_j'(\\xi_i)$，其中 $\\ell_j(\\xi)$ 是第 $j$ 个Lagrange多项式。对于GLL节点，微分矩阵具有分部求和 (SBP) 性质：\n$$ MD + D^T M = e_R e_R^T - e_L e_L^T = \\mathrm{diag}(-1, 0, 0, 1) $$\n其中 $e_L = [1,0,0,0]^T$ 和 $e_R = [0,0,0,1]^T$ 是边界面选择向量。此性质对稳定性和等价性证明至关重要。$N=3$ GLL节点对应的唯一 $4 \\times 4$ 微分矩阵是：\n$$ D = \\begin{pmatrix} -3  \\frac{3\\sqrt{5}}{2}  - \\frac{\\sqrt{5}}{2}  \\frac{1}{2} \\\\ -\\frac{3\\sqrt{5}}{10}  0  \\frac{\\sqrt{5}}{2}  -\\frac{1}{10} \\\\ \\frac{1}{10}  -\\frac{\\sqrt{5}}{2}  0  \\frac{3\\sqrt{5}}{10} \\\\ -\\frac{1}{2}  \\frac{\\sqrt{5}}{2}  -\\frac{3\\sqrt{5}}{2}  3 \\end{pmatrix} $$\n\n**步骤2：不连续Galerkin (DG) 算子，$A_{\\mathrm{DG}}$**\n\n我们从 $u_t + a u_\\xi = 0$ 的DG方法强形式出发。对于一个检验函数 $v_h$，我们有：\n$$ \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial t} d\\xi = -a \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial \\xi} d\\xi + \\left[ v_h(a u_h - f^*) \\right]_{\\xi=-1}^{\\xi=1} $$\n其中 $f^*$ 是数值通量。展开边界项得到：\n$$ \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial t} d\\xi = -a \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial \\xi} d\\xi + v_h(1)(a u_R^+ - f^*_R) - v_h(-1)(a u_L^+ - f^*_L) $$\n这里，$u_L^+ = u_h(-1)$ 和 $u_R^+ = u_h(1)$ 是内部迹。使用节点基 $u_h(\\xi) = \\sum_j u_j \\ell_j(\\xi)$ 和检验函数 $v_h = \\ell_i(\\xi)$ 进行离散化，并对积分使用GLL求积（这将使质量矩阵集总为对角阵），我们得到关于节点值 $u$ 的系统：\n$$ w_i \\frac{du_i}{dt} = -a \\sum_j u_j \\left(w_i \\ell_j'(\\xi_i)\\right) + \\delta_{i3}(a u_3 - f^*_R) - \\delta_{i0}(a u_0 - f^*_L) $$\n两边同除以 $w_i$ 并写成矩阵形式：\n$$ \\frac{du}{dt} = -a D u + M^{-1}e_R(a e_R^T u - f^*_R) - M^{-1}e_L(a e_L^T u - f^*_L) $$\n为了求得 $A_{\\mathrm{DG}}$，我们分离出依赖于单元自身解向量 $u$ 的项。数值通量可以写为 $f^*(u^+, u^-) = f^{*,+}(u^+) + f^{*,-}(u^-)$。设 $f^{*,+}(u^+) = \\alpha u^+$。\n对半离散化的局部贡献是：\n$$ A_{\\mathrm{DG}}u = -a D u + M^{-1}e_R(a e_R^T u - \\alpha_R e_R^T u) - M^{-1}e_L(a e_L^T u - \\alpha_L e_L^T u) $$\n分解项可得DG算子：\n$$ A_{\\mathrm{DG}} = -a D - (a - \\alpha_L) M^{-1}e_L e_L^T + (a - \\alpha_R) M^{-1}e_R e_R^T $$\n我们定义提升算子 $L_L = M^{-1}e_L e_L^T$ 和 $L_R = M^{-1}e_R e_R^T$。DG算子为：\n$$ A_{\\mathrm{DG}} = -a D - (a - \\alpha_L) L_L + (a - \\alpha_R) L_R $$\n通量参数 $\\alpha_L$ 和 $\\alpha_R$ 依赖于通量函数：\n- **迎风通量：** 若 $a>0$，$f^* = a u^-$，所以 $\\alpha_L=\\alpha_R=0$。若 $a0$，$f^*=au^+$，所以 $\\alpha_L=\\alpha_R=a$。\n- **中心通量：** $f^* = \\frac{a}{2}(u^+ + u^-)$，所以 $\\alpha_L=\\alpha_R=\\frac{a}{2}$。\n\n**步骤3：通量重构 (FR) 算子，$A_{\\mathrm{FR}}$**\n\nFR方法从一个不稳定的格式 $u_t = -a D u$ 开始，通过在单元边界添加修正项来使其稳定。这是通过使用一个修正通量多项式 $f_h(\\xi)$ 实现的：\n$$ f_h(\\xi) = f(u_h(\\xi)) + (f^*_L - f_L)g_L(\\xi) + (f^*_R - f_R)g_R(\\xi) $$\n其中 $f(u)=au$ 是物理通量，$f_L=f(u_L^+)$，$f_R=f(u_R^+)$，而 $g_L(\\xi)$ 和 $g_R(\\xi)$ 是修正函数。通过对这个修正通量求导并在节点上求值，可以得到半离散FR格式：\n$$ \\frac{du}{dt} = -D f_h(u) $$\n以向量形式表示，其中 $g_L$ 和 $g_R$ 代表在节点上求值的修正函数向量：\n$$ \\frac{du}{dt} = -D \\left[ a u + (f^*_L - a e_L^T u)g_L + (f^*_R - a e_R^T u)g_R \\right] $$\n$$ \\frac{du}{dt} = -a D u - (f^*_L - a e_L^T u) D g_L - (f^*_R - a e_R^T u) D g_R $$\n通过代入 $f^{*,+} = \\alpha u^+$ 来分离依赖于 $u$ 的项：\n$$ A_{\\mathrm{FR}}u = -a D u - (\\alpha_L e_L^T u - a e_L^T u) D g_L - (\\alpha_R e_R^T u - a e_R^T u) D g_R $$\n$$ A_{\\mathrm{FR}}u = -a D u + (a - \\alpha_L)(D g_L)e_L^T u + (a - \\alpha_R)(D g_R)e_R^T u $$\n这就得到了FR算子：\n$$ A_{\\mathrm{FR}} = -a D + (a - \\alpha_L)(D g_L)e_L^T + (a - \\alpha_R)(D g_R)e_R^T $$\n\n**步骤4：DG与FR的等价性**\n\n为建立等价性，我们令 $A_{\\mathrm{DG}} = A_{\\mathrm{FR}}$：\n$$ -a D - (a - \\alpha_L) L_L + (a - \\alpha_R) L_R = -a D + (a - \\alpha_L)(D g_L)e_L^T + (a - \\alpha_R)(D g_R)e_R^T $$\n体项 $-a D$ 被消去。为了使该方程对任何通量选择（即任何有效的 $a, \\alpha_L, \\alpha_R$ 使得系数非零）都成立，我们必须独立地匹配边界修正项：\n$$ -(a - \\alpha_L) L_L = (a - \\alpha_L)(D g_L)e_L^T \\implies -M^{-1}e_L e_L^T = (D g_L)e_L^T $$\n$$ (a - \\alpha_R) L_R = (a - \\alpha_R)(D g_R)e_R^T \\implies M^{-1}e_R e_R^T = (D g_R)e_R^T $$\n这些算子等式必须成立，这意味着FR修正函数的离散导数应作如下选择：\n$$ D g_L = -M^{-1}e_L \\quad \\text{以及} \\quad D g_R = M^{-1}e_R $$\n通过这一特定选择，FR算子变为：\n$$ A_{\\mathrm{FR}} = -a D + (a - \\alpha_L)(-M^{-1}e_L)e_L^T + (a - \\alpha_R)(M^{-1}e_R)e_R^T $$\n$$ A_{\\mathrm{FR}} = -a D - (a - \\alpha_L)L_L + (a - \\alpha_R)L_R $$\n这与 $A_{\\mathrm{DG}}$ 的表达式完全相同。\n\n结论：使用GLL节点和非精确（集总质量）求积的节点DG格式，在数学上等价于FR格式，前提是FR修正函数的离散导数被选为DG的提升算子，即 $D g_L = -M^{-1} e_L$ 和 $D g_R = M^{-1} e_R$。因此，矩阵差 $A_{\\mathrm{FR}} - A_{\\mathrm{DG}}$ 是零矩阵，其Frobenius范数 $\\|A_{\\mathrm{FR}} - A_{\\mathrm{DG}}\\|_F$ 对所有测试用例都将为0（在机器精度范围内）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Assembles the DG and FR operators for the 1D linear advection equation\n    and computes the Frobenius norm of their difference for several test cases.\n    \"\"\"\n    test_cases = [\n        (1.0, 'upwind'),\n        (-1.75, 'upwind'),\n        (1.0, 'central'),\n        (-3.7, 'central'),\n        (0.0, 'upwind'),\n    ]\n\n    results = []\n    for a, flux_type in test_cases:\n        # Define N=3 GLL constants and matrices\n        s5 = np.sqrt(5.0)\n        # The differentiation matrix for N=3 GLL nodes\n        D = np.array([\n            [-3.0, 3.0*s5/2.0, -s5/2.0, 0.5],\n            [-3.0*s5/10.0, 0.0, s5/2.0, -0.1],\n            [0.1, -s5/2.0, 0.0, 3.0*s5/10.0],\n            [-0.5, s5/2.0, -3.0*s5/2.0, 3.0]\n        ])\n        \n        # GLL weights and inverse mass matrix\n        w = np.array([1.0/6.0, 5.0/6.0, 5.0/6.0, 1.0/6.0])\n        M_inv = np.diag(1.0 / w)\n        \n        # Face selector vectors\n        N_p = 4\n        e_L = np.zeros((N_p, 1))\n        e_L[0, 0] = 1.0\n        e_R = np.zeros((N_p, 1))\n        e_R[N_p - 1, 0] = 1.0\n\n        # Determine alpha coefficients based on the numerical flux\n        if flux_type == 'upwind':\n            if a > 0.0:\n                alpha_L, alpha_R = 0.0, 0.0\n            else:  # a = 0.0\n                alpha_L, alpha_R = a, a\n        elif flux_type == 'central':\n            alpha_L, alpha_R = a / 2.0, a / 2.0\n        else:\n            raise ValueError(\"Unknown flux type specified\")\n            \n        # Assemble the Discontinuous Galerkin (DG) operator\n        L_L = M_inv @ (e_L @ e_L.T)\n        L_R = M_inv @ (e_R @ e_R.T)\n        A_dg = -a * D - (a - alpha_L) * L_L + (a - alpha_R) * L_R\n\n        # Assemble the Flux Reconstruction (FR) operator\n        # The choice of correction function derivatives Dg_L and Dg_R\n        # is made to match the DG lifting operators.\n        Dg_L = -M_inv @ e_L\n        Dg_R = M_inv @ e_R\n        \n        A_fr = -a * D + (a - alpha_L) * (Dg_L @ e_L.T) + (a - alpha_R) * (Dg_R @ e_R.T)\n        \n        # Compute the Frobenius norm of the difference matrix\n        # This norm will be zero (up to machine precision) due to the\n        # mathematical equivalence shown in the derivation.\n        diff_norm = np.linalg.norm(A_fr - A_dg, 'fro')\n        results.append(diff_norm)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3385018"}, {"introduction": "在线性问题中建立了等价性之后，一个自然的问题是这种关系是否能推广到像伯格斯方程（Burgers' equation）这样的非线性方程。本练习将通过关注一种具有良好守恒特性的、被广泛使用的“分裂形式”离散格式来探讨此问题。您将证明，对于这些复杂的非线性格式，FR和DG的等价性依然可以保持，这突显了两种框架之间深刻的内在联系和构造上的灵活性[@problem_id:3384967]。", "problem": "考虑一维参考单元 $[-1,1]$ 上的无粘性伯格斯方程 (inviscid Burgers’ equation)，\n$$\nu_{t} + \\partial_{x}\\!\\left(\\tfrac{1}{2}u^{2}\\right) = 0,\n$$\n以及使用高斯-洛巴托-勒让德 (Gauss–Lobatto–Legendre, GLL) 节点集 $\\{x_{0},x_{1},x_{2}\\} = \\{-1,0,1\\}$ 和拉格朗日基 (Lagrange basis) $\\{\\ell_{j}(x)\\}_{j=0}^{2}$ 的 $N=2$ 次多项式逼近。令对角质量矩阵 $M = \\operatorname{diag}(w_{0},w_{1},w_{2})$ 使用 GLL 求积权重 $w_{0} = \\tfrac{1}{3}$，$w_{1} = \\tfrac{4}{3}$，$w_{2} = \\tfrac{1}{3}$，并令微分矩阵 $D \\in \\mathbb{R}^{3 \\times 3}$ 由 $D_{ij} = \\ell_{j}'(x_{i})$ 定义。定义分部求和 (Summation-By-Parts, SBP) 算子 $Q := M D$。\n\n对于非线性体积项的分裂形式离散化，使用对称的两点熵守恒通量\n$$\nf^{\\mathrm{ec}}(u_{L},u_{R}) = \\tfrac{1}{6}\\!\\left(u_{L}^{2} + u_{L}u_{R} + u_{R}^{2}\\right),\n$$\n并定义节点间断伽辽金 (Discontinuous Galerkin, DG) 方法的斜对称（分裂形式）体积算子为\n$$\nv^{\\mathrm{DG}}_{i} := 2 \\sum_{j=0}^{2} Q_{ij}\\, f^{\\mathrm{ec}}(u_{i},u_{j}) \\quad \\text{for } i=0,1,2.\n$$\n考虑一个通量重构 (Flux Reconstruction, FR) 格式，其构造使其斜对称体积算子与基于 SBP 的分裂形式相一致，\n$$\nv^{\\mathrm{FR}}_{i} := \\tfrac{1}{3}\\,u_{i}\\,\\sum_{j=0}^{2}Q_{ij}\\,u_{j} \\;+\\; \\tfrac{1}{3}\\,\\sum_{j=0}^{2}Q_{ij}\\,u_{j}^{2} \\quad \\text{for } i=0,1,2.\n$$\n\n从以上定义和 GLL SBP 算子的基本性质出发，显式计算 $N=2$ 时的 $D$、$M$ 和 $Q$，并用它们来计算一般节点值 $(u_{0},u_{1},u_{2}) \\in \\mathbb{R}^{3}$ 对应的 $v^{\\mathrm{DG}}$ 和 $v^{\\mathrm{FR}}$。然后，计算差值的欧几里得范数的平方，\n$$\n\\|v^{\\mathrm{DG}} - v^{\\mathrm{FR}}\\|_{2}^{2} \\;=\\; \\sum_{i=0}^{2}\\left(v^{\\mathrm{DG}}_{i} - v^{\\mathrm{FR}}_{i}\\right)^{2},\n$$\n并将结果化简为一个实数。报告这个数字。无需四舍五入，该量为无量纲量。", "solution": "用户提供了一个偏微分方程数值方法领域的问题，具体涉及间断伽辽金 (DG) 和通量重构 (FR) 框架内某些公式的等价性。目标是计算无粘性伯格斯方程的非线性体积项的两种离散化之间的差值的欧几里得范数的平方。\n\n我们从题目陈述开始。第一步是显式计算在高斯-洛巴托-勒让德 (GLL) 节点集 $\\{x_{0}, x_{1}, x_{2}\\} = \\{-1, 0, 1\\}$ 上，多项式次数为 $N=2$ 时所需的矩阵。\n\n与这些节点对应的拉格朗日基多项式 $\\{\\ell_{j}(x)\\}_{j=0}^{2}$ 为：\n$$\n\\ell_{0}(x) = \\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)} = \\frac{x(x-1)}{(-1)(-2)} = \\frac{1}{2}(x^2 - x)\n$$\n$$\n\\ell_{1}(x) = \\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)} = \\frac{(x+1)(x-1)}{(1)(-1)} = 1 - x^2\n$$\n$$\n\\ell_{2}(x) = \\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)} = \\frac{(x+1)x}{(2)(1)} = \\frac{1}{2}(x^2 + x)\n$$\n这些基多项式的导数为：\n$$\n\\ell_{0}'(x) = x - \\frac{1}{2}\n$$\n$$\n\\ell_{1}'(x) = -2x\n$$\n$$\n\\ell_{2}'(x) = x + \\frac{1}{2}\n$$\n微分矩阵 $D$ 的元素由 $D_{ij} = \\ell_{j}'(x_{i})$ 定义。在节点 $x_0 = -1$, $x_1 = 0$, $x_2 = 1$ 处计算导数值：\n$$\nD = \\begin{pmatrix} \\ell_{0}'(x_0)  \\ell_{1}'(x_0)  \\ell_{2}'(x_0) \\\\ \\ell_{0}'(x_1)  \\ell_{1}'(x_1)  \\ell_{2}'(x_1) \\\\ \\ell_{0}'(x_2)  \\ell_{1}'(x_2)  \\ell_{2}'(x_2) \\end{pmatrix} = \\begin{pmatrix} -1 - \\frac{1}{2}  -2(-1)  -1 + \\frac{1}{2} \\\\ 0 - \\frac{1}{2}  -2(0)  0 + \\frac{1}{2} \\\\ 1 - \\frac{1}{2}  -2(1)  1 + \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{2}  2  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix}\n$$\n质量矩阵 $M$ 是由 GLL 求积权重 $w_0 = \\frac{1}{3}$，$w_1 = \\frac{4}{3}$，$w_2 = \\frac{1}{3}$ 构成的对角矩阵：\n$$\nM = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  \\frac{4}{3}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix}\n$$\n分部求和 (SBP) 算子 $Q$ 定义为 $Q := M D$：\n$$\nQ = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  \\frac{4}{3}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} -\\frac{3}{2}  2  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{2}{3}  -\\frac{1}{6} \\\\ -\\frac{2}{3}  0  \\frac{2}{3} \\\\ \\frac{1}{6}  -\\frac{2}{3}  \\frac{1}{2} \\end{pmatrix}\n$$\n现在，我们必须计算 DG 和 FR 体积算子之间的差值。首先分析 DG 算子 $v^{\\mathrm{DG}}_{i}$。其定义为：\n$$\nv^{\\mathrm{DG}}_{i} := 2 \\sum_{j=0}^{2} Q_{ij}\\, f^{\\mathrm{ec}}(u_{i},u_{j})\n$$\n代入给定的熵守恒通量定义 $f^{\\mathrm{ec}}(u_{L},u_{R}) = \\frac{1}{6}(u_{L}^{2} + u_{L}u_{R} + u_{R}^{2})$，我们得到：\n$$\nv^{\\mathrm{DG}}_{i} = 2 \\sum_{j=0}^{2} Q_{ij} \\left( \\frac{1}{6}(u_{i}^{2} + u_{i}u_{j} + u_{j}^{2}) \\right) = \\frac{1}{3} \\sum_{j=0}^{2} Q_{ij} (u_{i}^{2} + u_{i}u_{j} + u_{j}^{2})\n$$\n我们可以分配求和：\n$$\nv^{\\mathrm{DG}}_{i} = \\frac{1}{3} \\left( \\sum_{j=0}^{2} Q_{ij}u_{i}^{2} + \\sum_{j=0}^{2} Q_{ij}u_{i}u_{j} + \\sum_{j=0}^{2} Q_{ij}u_{j}^{2} \\right)\n$$\n将不依赖于求和索引 $j$ 的项提取出来：\n$$\nv^{\\mathrm{DG}}_{i} = \\frac{1}{3} \\left( u_{i}^{2} \\sum_{j=0}^{2} Q_{ij} + u_{i} \\sum_{j=0}^{2} Q_{ij}u_{j} + \\sum_{j=0}^{2} Q_{ij}u_{j}^{2} \\right)\n$$\n题目说明我们应该使用 GLL SBP 算子的基本性质。基于拉格朗日多项式的微分矩阵 $D$ 的一个基本性质是其每行之和为零。这是因为基函数之和为一，$\\sum_{j=0}^{N} \\ell_j(x) = 1$，这是一个常数。常数的导数为零，所以 $\\frac{d}{dx}\\left(\\sum_{j=0}^{N} \\ell_j(x)\\right) = \\sum_{j=0}^{N} \\ell_j'(x) = 0$。在任意节点 $x_i$ 处计算该式可得 $\\sum_{j=0}^{N} \\ell_j'(x_i) = \\sum_{j=0}^{N} D_{ij} = 0$。\n因此，对于 SBP 算子 $Q = MD$，每行之和也为零：\n$$\n\\sum_{j=0}^{2} Q_{ij} = \\sum_{j=0}^{2} M_{ii} D_{ij} = M_{ii} \\sum_{j=0}^{2} D_{ij} = M_{ii} \\cdot 0 = 0\n$$\n这个性质可以用我们计算出的矩阵 $Q$ 来验证：\n第 0 行: $-\\frac{1}{2} + \\frac{2}{3} - \\frac{1}{6} = \\frac{-3+4-1}{6} = 0$。\n第 1 行: $-\\frac{2}{3} + 0 + \\frac{2}{3} = 0$。\n第 2 行: $\\frac{1}{6} - \\frac{2}{3} + \\frac{1}{2} = \\frac{1-4+3}{6} = 0$。\n\n将这个基本性质 $\\sum_{j=0}^{2} Q_{ij} = 0$ 应用到 $v^{\\mathrm{DG}}_{i}$ 的表达式中：\n$$\nv^{\\mathrm{DG}}_{i} = \\frac{1}{3} \\left( u_{i}^{2} \\cdot 0 + u_{i} \\sum_{j=0}^{2} Q_{ij}u_{j} + \\sum_{j=0}^{2} Q_{ij}u_{j}^{2} \\right)\n$$\n这可以简化为：\n$$\nv^{\\mathrm{DG}}_{i} = \\frac{1}{3} u_{i} \\sum_{j=0}^{2} Q_{ij}u_{j} + \\frac{1}{3} \\sum_{j=0}^{2} Q_{ij}u_{j}^{2}\n$$\n现在，我们将这个结果与问题陈述中提供的 FR 体积算子的定义进行比较：\n$$\nv^{\\mathrm{FR}}_{i} := \\frac{1}{3}\\,u_{i}\\,\\sum_{j=0}^{2}Q_{ij}\\,u_{j} \\;+\\; \\frac{1}{3}\\,\\sum_{j=0}^{2}Q_{ij}\\,u_{j}^{2}\n$$\n$v^{\\mathrm{DG}}_{i}$ 和 $v^{\\mathrm{FR}}_{i}$ 的表达式是相同的。因此，对于任意选择的节点值 $(u_0, u_1, u_2)$，差值为零：\n$$\nv^{\\mathrm{DG}}_{i} - v^{\\mathrm{FR}}_{i} = 0 \\quad \\text{for } i=0,1,2.\n$$\n需要计算的量是差向量 $v^{\\mathrm{DG}} - v^{\\mathrm{FR}}$ 的欧几里得范数的平方：\n$$\n\\|v^{\\mathrm{DG}} - v^{\\mathrm{FR}}\\|_{2}^{2} = \\sum_{i=0}^{2}\\left(v^{\\mathrm{DG}}_{i} - v^{\\mathrm{FR}}_{i}\\right)^{2}\n$$\n由于和中的每一项都为零，最终结果是：\n$$\n\\|v^{\\mathrm{DG}} - v^{\\mathrm{FR}}\\|_{2}^{2} = (0)^2 + (0)^2 + (0)^2 = 0\n$$\n该问题证明了特定的分裂形式节点 DG 格式（使用熵守恒通量）与由相同 SBP 算子构建的特定通量重构格式之间的代数等价性。显式计算证实了这一理论结果。", "answer": "$$\\boxed{0}$$", "id": "3384967"}, {"introduction": "FR和DG之间的等价性非常强大，但它依赖于一致的离散定义。本最后一个练习将深入探讨一个在曲线网格上出现的关键细微之处：几何守恒律（GCL）。本练习构建了一个反例，展示了FR的一种“朴素”实现如何违反GCL，从而无法保持简单的自由流解，而精心构造的DG格式却能成功，这揭示了度量项离散化方式的至关重要性[@problem_id:3384975]。", "problem": "考虑一个常系数二维线性平流方程，其守恒形式定义在单个曲线四边形单元上。该单元通过将参考正方形 $\\{(\\xi,\\eta): -1 \\le \\xi,\\eta \\le 1\\}$ 映射到物理空间得到，映射关系为\n$$\nx(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta^{2}, \\qquad y(\\xi,\\eta) = \\eta,\n$$\n其中 $\\alpha \\in \\mathbb{R}$。设物理平流速度为常数 $\\,\\boldsymbol{v} = (0,1)\\,$，解为严格的自由流 $\\,u(\\boldsymbol{x},t) \\equiv u_{0}\\,$，其中 $u_{0} \\in \\mathbb{R}$ 为常数。用标准映射导数 $\\,x_{\\xi}, x_{\\eta}, y_{\\xi}, y_{\\eta}\\,$ 表示雅可比行列式和协变基向量，其中 $\\,J = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi}\\,$。守恒形式的逆变向量为 $\\,J \\boldsymbol{a}^{\\xi} = \\begin{bmatrix} y_{\\eta} \\\\ -x_{\\eta} \\end{bmatrix}$ 和 $\\,J \\boldsymbol{a}^{\\eta} = \\begin{bmatrix} -y_{\\xi} \\\\ x_{\\xi} \\end{bmatrix}\\,$。\n\n在每个坐标方向上，使用多项式次数为 $N=1$ 的张量积 Gauss–Lobatto–Legendre (GLL) 节点进行离散化，即 $\\{\\xi_{1},\\xi_{2}\\}=\\{-1,1\\}$ 和 $\\{\\eta_{1},\\eta_{2}\\}=\\{-1,1\\}$，相应的一维节点微分矩阵为\n$$\nD \\;=\\; \\begin{bmatrix} -\\tfrac{1}{2}  \\tfrac{1}{2} \\\\ -\\tfrac{1}{2}  \\tfrac{1}{2} \\end{bmatrix}.\n$$\n假设采用周期性边界条件（或等效地，对于常数状态，界面数值通量的贡献为零），因此只有体离散化决定节点的残差。考虑以下两种用于计算映射通量散度的半离散体积定式：\n- 通量重构 (Flux Reconstruction, FR)：通过将逐点的解析导数 $\\,x_{\\xi},x_{\\eta},y_{\\xi},y_{\\eta}\\,$ 直接代入上述定义，来构造节点上的逆变因子 $\\,J \\boldsymbol{a}^{\\xi}\\,$ 和 $\\,J \\boldsymbol{a}^{\\eta}\\,$，然后通过在每个坐标方向上对逆变通量 $F^{\\xi} = (J \\boldsymbol{a}^{\\xi}\\cdot \\boldsymbol{v})\\,u_{0}$ 和 $F^{\\eta} = (J \\boldsymbol{a}^{\\eta}\\cdot \\boldsymbol{v})\\,u_{0}$ 的相应节点分量应用 $D$ 来评估离散散度。\n- 使用守恒度量的节点间断 Galerkin (Nodal Discontinuous Galerkin, DG) 方法：不通过逐点乘积来构造 $\\,J \\boldsymbol{a}^{\\xi}$ 和 $\\,J \\boldsymbol{a}^{\\eta}$；而是通过离散的守恒旋度形式来计算它们\n$$\nJ \\boldsymbol{a}^{\\xi} \\;=\\; \\begin{bmatrix} D_{\\eta} y \\\\ -D_{\\eta} x \\end{bmatrix}, \n\\qquad\nJ \\boldsymbol{a}^{\\eta} \\;=\\; \\begin{bmatrix} -D_{\\xi} y \\\\ D_{\\xi} x \\end{bmatrix},\n$$\n其中 $D_{\\xi}$ 表示固定 $\\eta$ 并沿 $\\xi$ 索引应用 $D$，$D_{\\eta}$ 表示固定 $\\xi$ 并沿 $\\eta$ 索引应用 $D$。\n\n仅使用这些定义和给定的映射，以闭合形式计算任意张量节点 $(\\xi_{i},\\eta_{j})$ 处的节点 FR 体积残差 $\\,\\mathcal{R}^{\\mathrm{FR}}_{i,j}\\,$，并证明对于相同配置，使用守恒度量的节点 DG 体积残差 $\\,\\mathcal{R}^{\\mathrm{DG}}_{i,j}\\,$ 恒为零。你的最终答案应该是 $\\,\\mathcal{R}^{\\mathrm{FR}}_{i,j}\\,$ 的闭合形式解析表达式，表示为 $\\alpha$、$u_{0}$ 和 $\\eta_{j}$ 的函数。不需要四舍五入，也没有单位。", "solution": "该问题被评估为有效。这是一个在偏微分方程数值分析领域中，特别是在谱方法和间断 Galerkin 方法方面，一个适定的、具有科学依据的问题。所有定义、数据和条件都已提供，并且相互一致，没有任何科学或逻辑上的缺陷。该问题是检验数值格式在曲线网格上自由流保持特性的标准测试用例，这是一个与几何守恒律 (Geometric Conservation Law, GCL) 相关的关键概念。\n\n我们将首先计算通量重构 (FR) 定式的体积残差，然后计算使用守恒度量的节点间断 Galerkin (DG) 定式的体积残差。\n\n### 通量重构 (FR) 残差计算\n\nFR 方法要求在每个节点处使用解析推导的度量项来评估逆变通量，然后应用离散散度算子。\n\n1.  **解析度量导数：**\n    从参考单元 $(\\xi, \\eta)$ 到物理空间 $(x, y)$ 的映射由下式给出：\n    $$\n    x(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta^{2}, \\qquad y(\\xi,\\eta) = \\eta\n    $$\n    偏导数（协变基向量的分量）为：\n    $$\n    x_{\\xi} = \\frac{\\partial x}{\\partial \\xi} = 1 + \\alpha\\,\\eta^{2}\n    $$\n    $$\n    x_{\\eta} = \\frac{\\partial x}{\\partial \\eta} = 2\\,\\alpha\\,\\xi\\,\\eta\n    $$\n    $$\n    y_{\\xi} = \\frac{\\partial y}{\\partial \\xi} = 0\n    $$\n    $$\n    y_{\\eta} = \\frac{\\partial y}{\\partial \\eta} = 1\n    $$\n\n2.  **守恒逆变向量：**\n    根据所给定义，逆变向量的守恒形式为：\n    $$\n    J \\boldsymbol{a}^{\\xi} = \\begin{bmatrix} y_{\\eta} \\\\ -x_{\\eta} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -2\\,\\alpha\\,\\xi\\,\\eta \\end{bmatrix}\n    $$\n    $$\n    J \\boldsymbol{a}^{\\eta} = \\begin{bmatrix} -y_{\\xi} \\\\ x_{\\xi} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 + \\alpha\\,\\eta^{2} \\end{bmatrix}\n    $$\n\n3.  **逆变通量：**\n    物理平流速度为 $\\boldsymbol{v} = (0, 1)$，解为常数 $u = u_0$。逆变通量 $F^{\\xi}$ 和 $F^{\\eta}$ 计算如下：\n    $$\n    F^{\\xi} = (J \\boldsymbol{a}^{\\xi} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 1 \\\\ -2\\,\\alpha\\,\\xi\\,\\eta \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = -2\\,\\alpha\\,\\xi\\,\\eta\\,u_{0}\n    $$\n    $$\n    F^{\\eta} = (J \\boldsymbol{a}^{\\eta} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 0 \\\\ 1 + \\alpha\\,\\eta^{2} \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = (1 + \\alpha\\,\\eta^{2})\\,u_{0}\n    $$\n\n4.  **离散散度（残差）：**\n    节点 $(\\xi_i, \\eta_j)$ 处的体积残差由逆变通量的离散散度给出。离散化使用 $N=1$ 的张量积 GLL 节点，因此 $(\\xi_i, \\eta_j) \\in \\{-1, 1\\} \\times \\{-1, 1\\}$。\n    $$\n    \\mathcal{R}^{\\mathrm{FR}}_{i,j} = \\left(D_{\\xi} F^{\\xi}\\right)_{i,j} + \\left(D_{\\eta} F^{\\eta}\\right)_{i,j}\n    $$\n    其中 $D_{\\xi}$ 和 $D_{\\eta}$ 分别表示沿相应坐标方向应用微分矩阵 $D$。\n\n    我们分别计算这两项。\n\n    **来自 $F^{\\xi}$ 的贡献：**\n    对于固定的 $\\eta_j$，沿 $\\xi$ 方向的通量值为：\n    $$\n    F^{\\xi}_{1,j} = F^{\\xi}(\\xi_1, \\eta_j) = F^{\\xi}(-1, \\eta_j) = -2\\,\\alpha\\,(-1)\\,\\eta_j\\,u_{0} = 2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    $$\n    F^{\\xi}_{2,j} = F^{\\xi}(\\xi_2, \\eta_j) = F^{\\xi}(1, \\eta_j) = -2\\,\\alpha\\,(1)\\,\\eta_j\\,u_{0} = -2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    将微分矩阵 $D = \\begin{bmatrix} -1/2  1/2 \\\\ -1/2  1/2 \\end{bmatrix}$ 应用于这些通量值的向量：\n    $$\n    \\begin{bmatrix} (D_{\\xi} F^{\\xi})_{1,j} \\\\ (D_{\\xi} F^{\\xi})_{2,j} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{2}  \\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} 2\\,\\alpha\\,\\eta_j\\,u_{0} \\\\ -2\\,\\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} -\\alpha\\,\\eta_j\\,u_{0} - \\alpha\\,\\eta_j\\,u_{0} \\\\ -\\alpha\\,\\eta_j\\,u_{0} - \\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} -2\\,\\alpha\\,\\eta_j\\,u_{0} \\\\ -2\\,\\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix}\n    $$\n    因此，来自 $\\xi$-通量散度的残差贡献为 $(D_{\\xi} F^{\\xi})_{i,j} = -2\\,\\alpha\\,\\eta_j\\,u_{0}$，对任意 $i \\in \\{1, 2\\}$ 成立。\n\n    **来自 $F^{\\eta}$ 的贡献：**\n    在 GLL 节点处，$\\eta_j \\in \\{-1, 1\\}$，因此 $\\eta_j^2 = 1$。通量 $F^{\\eta}$ 在所有节点上都变为常数：\n    $$\n    F^{\\eta}_{i,j} = (1 + \\alpha\\,\\eta_j^{2})\\,u_{0} = (1 + \\alpha)\\,u_{0}\n    $$\n    对于固定的 $\\xi_i$，沿 $\\eta$ 方向的通量值为 $(F^{\\eta}_{i,1}, F^{\\eta}_{i,2}) = ((1+\\alpha)u_0, (1+\\alpha)u_0)$。将 $D$ 应用于此常数向量：\n    $$\n    \\begin{bmatrix} (D_{\\eta} F^{\\eta})_{i,1} \\\\ (D_{\\eta} F^{\\eta})_{i,2} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{2}  \\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} (1 + \\alpha)\\,u_{0} \\\\ (1 + \\alpha)\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n    $$\n    因此，$(D_{\\eta} F^{\\eta})_{i,j} = 0$。\n\n    **总 FR 残差：**\n    结合两项贡献，FR 残差为：\n    $$\n    \\mathcal{R}^{\\mathrm{FR}}_{i,j} = -2\\,\\alpha\\,\\eta_j\\,u_{0} + 0 = -2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    当 $\\alpha \\ne 0$ 时，此残差不为零，表明该定式不保持恒定的自由流解。\n\n### 使用守恒度量的节点 DG 残差计算\n\n此方法使用离散微分算子来计算度量项本身。\n\n1.  **节点坐标场：**\n    在节点 $(\\xi_i, \\eta_j)$ 处，其中 $\\eta_j^2 = 1$，坐标为：\n    $$\n    x_{i,j} = \\xi_i + \\alpha\\,\\xi_i\\,\\eta_j^2 = \\xi_i(1+\\alpha)\n    $$\n    $$\n    y_{i,j} = \\eta_j\n    $$\n\n2.  **离散守恒逆变向量：**\n    度量项使用离散旋度形式计算：\n    $$\n    (J \\boldsymbol{a}^{\\xi})_{i,j} = \\begin{bmatrix} (D_{\\eta}\\,y)_{i,j} \\\\ -(D_{\\eta}\\,x)_{i,j} \\end{bmatrix}, \\qquad (J \\boldsymbol{a}^{\\eta})_{i,j} = \\begin{bmatrix} -(D_{\\xi}\\,y)_{i,j} \\\\ (D_{\\xi}\\,x)_{i,j} \\end{bmatrix}\n    $$\n    我们计算节点 $(\\xi_i, \\eta_j)$ 处的每个分量。\n    - $(D_{\\eta}\\,y)_{i,j}$：对于固定的 $\\xi_i$，$y$ 坐标向量为 $(y_{i,1}, y_{i,2}) = (\\eta_1, \\eta_2) = (-1, 1)$。应用 $D$：$D \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2+1/2 \\\\ 1/2+1/2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。因此，对所有 $i,j$ 都有 $(D_{\\eta}\\,y)_{i,j} = 1$。\n    - $(D_{\\eta}\\,x)_{i,j}$：对于固定的 $\\xi_i$，$x$ 坐标向量为 $(x_{i,1}, x_{i,2}) = (\\xi_i(1+\\alpha), \\xi_i(1+\\alpha))$。由于这是一个常数向量，应用 $D$ 会得到一个零向量。因此，对所有 $i,j$ 都有 $(D_{\\eta}\\,x)_{i,j} = 0$。\n    - $(D_{\\xi}\\,y)_{i,j}$：对于固定的 $\\eta_j$，$y$ 坐标向量为 $(y_{1,j}, y_{2,j}) = (\\eta_j, \\eta_j)$。这是一个常数向量，因此应用 $D$ 会得到零。因此，对所有 $i,j$ 都有 $(D_{\\xi}\\,y)_{i,j} = 0$。\n    - $(D_{\\xi}\\,x)_{i,j}$：对于固定的 $\\eta_j$，$x$ 坐标向量为 $(x_{1,j}, x_{2,j}) = (\\xi_1(1+\\alpha), \\xi_2(1+\\alpha)) = (-(1+\\alpha), 1+\\alpha)$。应用 $D$：$D \\begin{pmatrix} -(1+\\alpha) \\\\ 1+\\alpha \\end{pmatrix} = \\begin{pmatrix} 1/2(1+\\alpha)+1/2(1+\\alpha) \\\\ 1/2(1+\\alpha)+1/2(1+\\alpha) \\end{pmatrix} = \\begin{pmatrix} 1+\\alpha \\\\ 1+\\alpha \\end{pmatrix}$。因此，对所有 $i,j$ 都有 $(D_{\\xi}\\,x)_{i,j} = 1+\\alpha$。\n\n    在任意节点 $(\\xi_i, \\eta_j)$ 处计算的离散度量项为：\n    $$\n    (J \\boldsymbol{a}^{\\xi})^{\\mathrm{DG}}_{i,j} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\qquad (J \\boldsymbol{a}^{\\eta})^{\\mathrm{DG}}_{i,j} = \\begin{bmatrix} 0 \\\\ 1+\\alpha \\end{bmatrix}\n    $$\n\n3.  **离散逆变通量：**\n    $$\n    (F^{\\xi})^{\\mathrm{DG}}_{i,j} = ((J \\boldsymbol{a}^{\\xi})^{\\mathrm{DG}}_{i,j} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = 0\n    $$\n    $$\n    (F^{\\eta})^{\\mathrm{DG}}_{i,j} = ((J \\boldsymbol{a}^{\\eta})^{\\mathrm{DG}}_{i,j} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 0 \\\\ 1+\\alpha \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = (1+\\alpha)\\,u_{0}\n    $$\n\n4.  **离散散度（残差）：**\n    $$\n    \\mathcal{R}^{\\mathrm{DG}}_{i,j} = \\left(D_{\\xi} (F^{\\xi})^{\\mathrm{DG}}\\right)_{i,j} + \\left(D_{\\eta} (F^{\\eta})^{\\mathrm{DG}}\\right)_{i,j}\n    $$\n    - 通量 $(F^{\\xi})^{\\mathrm{DG}}$ 在所有节点上都为零。因此其离散导数为零。\n    - 通量 $(F^{\\eta})^{\\mathrm{DG}}$ 在所有节点上都是常数 $(1+\\alpha)u_0$。用 $D$ 对常数场求导得到零。\n    因此，两项都为零。\n\n    **总 DG 残差：**\n    $$\n    \\mathcal{R}^{\\mathrm{DG}}_{i,j} = 0 + 0 = 0\n    $$\n\n这表明使用守恒度量的节点 DG 定式是自由流保持的，对于该曲线网格上的常数解，其残差恒为零。这是因为该构造在设计上满足了离散几何守恒律 (GCL)。而使用解析度量的 FR 定式不满足离散 GCL，因此会产生一个伪源项。\n\n最终答案是推导出的通量重构残差的表达式。", "answer": "$$\n\\boxed{-2\\,\\alpha\\,u_{0}\\,\\eta_{j}}\n$$", "id": "3384975"}]}