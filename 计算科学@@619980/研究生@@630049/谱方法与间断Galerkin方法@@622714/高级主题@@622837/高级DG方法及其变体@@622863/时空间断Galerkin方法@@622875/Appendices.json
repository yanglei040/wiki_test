{"hands_on_practices": [{"introduction": "此练习是构建时空不连续伽辽金（DG）求解器的第一步，重点是理解逼近空间的张量积结构及其对质量矩阵的直接影响。通过推导自由度的数量和质量矩阵的结构 [@problem_id:3415511]，您将看到选择正交基函数（如勒让德多项式）如何带来显著的计算优势，例如得到对角质量矩阵，从而简化时间步进的求解过程。", "problem": "考虑单个时空单元 $K \\times I$，其中 $K = [x_{L}, x_{R}] \\subset \\mathbb{R}$ 是一个空间区间，$I = [t_{n}, t_{n+1}] \\subset \\mathbb{R}$ 是一个时间层。令 $\\xi \\in [-1,1]$ 和 $\\tau \\in [-1,1]$ 表示通过仿射映射 $x = x_{c} + J_{x}\\,\\xi$ 和 $t = t_{c} + J_{t}\\,\\tau$ 得到的参考坐标，其中 $x_{c} = (x_{L} + x_{R})/2$，$t_{c} = (t_{n} + t_{n+1})/2$，$J_{x} = (x_{R} - x_{L})/2$，以及 $J_{t} = (t_{n+1} - t_{n})/2$。在参考正方形 $[-1,1] \\times [-1,1]$上，考虑由标准勒让德多项式（在$[-1,1]$上关于单位权重正交）构成的张量积基，即 $\\{\\phi_{i,s}(\\xi,\\tau)\\}_{0 \\leq i \\leq p_{x},\\, 0 \\leq s \\leq p_{t}}$，其中 $\\phi_{i,s}(\\xi,\\tau) = P_{i}(\\xi)\\,P_{s}(\\tau)$，$P_{n}$ 是 $n$ 次勒让德多项式。\n\n在时空非连续 Galerkin (DG) 离散化中，$K \\times I$ 上的局部质量矩阵的元素为\n$$\nM_{(i,s),(j,r)} = \\int_{K} \\int_{I} \\phi_{i,s}(x,t)\\,\\phi_{j,r}(x,t)\\,\\mathrm{d}t\\,\\mathrm{d}x,\n$$\n其中 $0 \\leq i,j \\leq p_{x}$ 且 $0 \\leq s,r \\leq p_{t}$。使用上述仿射映射，该积分可以在参考正方形上表示，并可通过在空间和时间上分别使用 $Q_{x}$ 个 $\\xi$ 点和 $Q_{t}$ 个 $\\tau$ 点的高斯-勒让德求积法进行计算。假设所选的高斯-勒让德法则能够精确积分次数最高为 $2p_{x}$ 的任意多项式乘积的 $\\xi$ 因子，以及次数最高为 $2p_{t}$ 的任意 $\\tau$ 因子。\n\n任务：\n- 推导与 $(p_{x},p_{t})$ 相关联的张量积多项式空间的局部自由度数量。\n- 在空间和时间上使用高斯-勒让德求积法的情况下，推导 $M_{(i,s),(j,r)}$ 的显式解析表达式，用 $J_{x}$、$J_{t}$ 和勒让德多项式表示。陈述质量矩阵为对角矩阵的条件，并给出该情况下其对角元素的闭式值。\n\n将最终答案以单个闭式解析表达式或表达式的行向量形式提供。无需进行数值计算。", "solution": "用户提供了一个来自数值分析领域的适定问题陈述，具体涉及了时空非连续 Galerkin (DG) 方法。该问题具有科学依据，内容自洽且无矛盾。因此，我将进行完整的推导。\n\n该问题要求推导三个量：\n1.  局部自由度的数量。\n2.  局部质量矩阵元素的显式解析表达式。\n3.  质量矩阵为对角矩阵的条件及其对角元素的值。\n\n让我们依次处理每个任务。\n\n**1. 局部自由度数量**\n\n时空单元 $K \\times I$ 上的多项式逼近空间是使用张量积基构建的。基函数为 $\\phi_{i,s}(\\xi,\\tau) = P_{i}(\\xi)\\,P_{s}(\\tau)$，其中 $P_{n}$ 是 $n$ 次勒让德多项式。\n\n基的空间部分由参考坐标 $\\xi$ 中的多项式构成，次数范围从 $0$ 到 $p_x$。空间基多项式集合可表示为 $\\{P_i(\\xi)\\}_{i=0}^{p_x}$。此类多项式的数量是索引 $i$ 从 $0$ 到 $p_x$ 的计数，即 $p_x + 1$。\n\n类似地，基的时间部分由参考坐标 $\\tau$ 中的多项式构成，次数范围从 $0$ 到 $p_t$。时间基多项式集合为 $\\{P_s(\\tau)\\}_{s=0}^{p_t}$。这些多项式的数量是 $p_t + 1$。\n\n完整的张量积基是通过取一个空间基函数和一个时间基函数的所有可能乘积形成的，即 $\\{P_i(\\xi)P_s(\\tau)\\}_{0 \\le i \\le p_x, 0 \\le s \\le p_t}$。此集合中基函数的总数，即对应于单元 $K \\times I$ 上的局部自由度 (DoF) 数量，是空间基函数数量和时间基函数数量的乘积。\n\n自由度数量 = (空间基函数数量) $\\times$ (时间基函数数量)\n$$\n\\text{DoF} = (p_x + 1)(p_t + 1)\n$$\n\n**2. 局部质量矩阵元素的表达式**\n\n局部质量矩阵元素由以下积分定义：\n$$\nM_{(i,s),(j,r)} = \\int_{K} \\int_{I} \\phi_{i,s}(x,t)\\,\\phi_{j,r}(x,t)\\,\\mathrm{d}t\\,\\mathrm{d}x\n$$\n基函数 $\\phi_{i,s}$ 和 $\\phi_{j,r}$ 是在参考正方形 $[-1,1] \\times [-1,1]$ 上用坐标 $(\\xi, \\tau)$ 定义的。为了计算该积分，我们必须执行从物理坐标 $(x,t)$ 到参考坐标 $(\\xi,\\tau)$ 的变量替换。\n\n仿射映射为：\n$x(\\xi) = x_{c} + J_{x}\\,\\xi$\n$t(\\tau) = t_{c} + J_{t}\\,\\tau$\n\n微分通过对这些映射求导得到：\n$\\mathrm{d}x = \\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} \\mathrm{d}\\xi = J_x \\mathrm{d}\\xi$\n$\\mathrm{d}t = \\frac{\\mathrm{d}t}{\\mathrm{d}\\tau} \\mathrm{d}\\tau = J_t \\mathrm{d}\\tau$\n\n微分面积元变换为 $\\mathrm{d}t\\,\\mathrm{d}x = J_t J_x \\,\\mathrm{d}\\tau\\,\\mathrm{d}\\xi$。积分限从 $x \\in K = [x_L, x_R]$ 变为 $\\xi \\in [-1,1]$，从 $t \\in I = [t_n, t_{n+1}]$ 变为 $\\tau \\in [-1,1]$。\n\n将变换和基函数定义 $\\phi_{i,s}(\\xi,\\tau) = P_i(\\xi)P_s(\\tau)$ 和 $\\phi_{j,r}(\\xi,\\tau) = P_j(\\xi)P_r(\\tau)$ 代入质量矩阵积分，可得：\n$$\nM_{(i,s),(j,r)} = \\int_{-1}^{1} \\int_{-1}^{1} [P_{i}(\\xi)\\,P_{s}(\\tau)]\\,[P_{j}(\\xi)\\,P_{r}(\\tau)]\\, J_{x} J_{t} \\,\\mathrm{d}\\tau\\,\\mathrm{d}\\xi\n$$\n由于 $J_x$ 和 $J_t$ 对于给定单元是常数，它们可以被提出来。被积函数是 $\\xi$ 的函数和 $\\tau$ 的函数的乘积，因此根据 Fubini 定理，该二重积分可以分离为两个单变量积分的乘积：\n$$\nM_{(i,s),(j,r)} = J_{x} J_{t} \\left( \\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) \\,\\mathrm{d}\\xi \\right) \\left( \\int_{-1}^{1} P_{s}(\\tau) P_{r}(\\tau) \\,\\mathrm{d}\\tau \\right)\n$$\n问题陈述中指出，这些积分是使用高斯-勒让德求积法则计算的，该法则对 $\\xi$ 中次数最高为 $2p_x$ 的多项式以及 $\\tau$ 中次数最高为 $2p_t$ 的多项式是精确的。$\\xi$-积分中的被积函数是 $P_i(\\xi)P_j(\\xi)$，它是一个 $i+j$ 次多项式。由于 $0 \\le i,j \\le p_x$，其最高次数为 $2p_x$。因此，求积法则对于此积分是精确的。类似的论证也适用于 $\\tau$-积分，其被积函数的最高次数为 $2p_t$。\n因为求积是精确的，其结果与积分的解析值相同。我们可以利用勒让德多项式在区间 $[-1,1]$ 上关于权函数 $1$ 的正交性来解析地计算这些积分：\n$$\n\\int_{-1}^{1} P_m(z) P_n(z) \\,\\mathrm{d}z = \\frac{2}{2n+1} \\delta_{mn}\n$$\n其中 $\\delta_{mn}$ 是克罗内克 δ 符号，当 $m=n$ 时为 $1$，否则为 $0$。\n\n将此性质应用于我们的两个积分：\n$$\n\\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) \\,\\mathrm{d}\\xi = \\frac{2}{2i+1} \\delta_{ij}\n$$\n$$\n\\int_{-1}^{1} P_{s}(\\tau) P_{r}(\\tau) \\,\\mathrm{d}\\tau = \\frac{2}{2s+1} \\delta_{sr}\n$$\n将这些结果代回 $M_{(i,s),(j,r)}$ 的表达式中：\n$$\nM_{(i,s),(j,r)} = J_{x} J_{t} \\left( \\frac{2}{2i+1} \\delta_{ij} \\right) \\left( \\frac{2}{2s+1} \\delta_{sr} \\right)\n$$\n这就得到了质量矩阵元素的最终显式解析表达式：\n$$\nM_{(i,s),(j,r)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr}\n$$\n\n**3. 对角性与对角元素**\n\n质量矩阵 $M$ 由复合索引标定，例如 $\\alpha = (i,s)$ 和 $\\beta = (j,r)$。如果 $\\alpha = \\beta$，即 $(i,s) = (j,r)$ 或 $i=j$ 且 $s=r$，则元素 $M_{\\alpha,\\beta}$ 是一个对角元素。非对角元素则是 $\\alpha \\neq \\beta$ 的元素。\n\n推导出的质量矩阵元素表达式为 $M_{(i,s),(j,r)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr}$。当且仅当 $i=j$ 且 $s=r$ 时，$\\delta_{ij} \\delta_{sr}$ 项等于 $1$。如果 $i \\neq j$ 或 $s \\neq r$，该项为 $0$。这意味着只要复合索引 $(i,s)$ 和 $(j,r)$ 不相同，矩阵元素就为零。\n\n因此，局部质量矩阵是对角的。出现这种情况的条件是使用了一个相对于参考单元上的 $L^2$ 内积 $\\langle u, v \\rangle = \\int_{-1}^1\\int_{-1}^1 u(\\xi,\\tau)v(\\xi,\\tau) d\\tau d\\xi$ 正交的基。张量积勒让德基 $\\{P_i(\\xi)P_s(\\tau)\\}$ 就是这样一个正交基。问题陈述本身就确立了这个条件。\n\n对角元素的值是当 $i=j$ 和 $s=r$ 时 $M_{(i,s),(j,r)}$ 的值。在通用公式中令 $j=i$ 和 $r=s$，我们得到 $\\delta_{ii} = 1$ 和 $\\delta_{ss} = 1$。对应于基函数 $\\phi_{i,s}$ 的对角元素是：\n$$\nM_{(i,s),(i,s)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)}\n$$\n这就是对角元素的闭式值。$M_{(i,s),(j,r)}$ 的完整表达式已经完全包含了此信息。\n\n最终答案是自由度的数量和质量矩阵元素的一般表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} (p_{x}+1)(p_{t}+1)  \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr} \\end{pmatrix}}\n$$", "id": "3415511"}, {"introduction": "不连续伽辽金方法的一个关键优势是其天然适用于自适应网格加密，但这需要可靠的误差估计。本练习将指导您为抛物型方程从理论上构造一个基于残差的后验误差估计子 [@problem_id:3415471]。您将学习如何利用单元内部的残差和单元间的跳跃项（这些量在 DG 计算中随时可得）来估计误差，并论证每个项的缩放因子的合理性，以确保估计子既可靠又高效。", "problem": "考虑标量线性抛物型偏微分方程 (PDE)\n$$\n\\partial_{t} u - \\nabla \\cdot \\left( A(x) \\nabla u \\right) = f \\quad \\text{in } \\Omega \\times I,\n$$\n该方程在 $d$ 维环面 $\\Omega = \\mathbb{T}^{d}$ 上具有空间周期性边界条件，并在 $\\Omega$ 上有初始数据 $u(\\cdot,0) = u_{0}$。假设 $A(x) \\in \\mathbb{R}^{d \\times d}$ 是可测、对称且一致椭圆的，即存在常数 $0  \\alpha \\le \\Lambda  \\infty$ 使得\n$$\n\\alpha \\, |\\xi|^{2} \\leq \\xi^{\\top} A(x) \\, \\xi \\leq \\Lambda \\, |\\xi|^{2} \\quad \\text{for all } \\xi \\in \\mathbb{R}^{d} \\text{ and almost every } x \\in \\Omega,\n$$\n并且 $f \\in L^{2}(\\Omega \\times I)$，$u_{0} \\in L^{2}(\\Omega)$。令 $I = (0,T)$，并设 $\\{0 = t_0  t_1  \\dots  t_N = T\\}$ 是 $I$ 的一个划​​分，划分为子区间 $J_{n} = (t_{n}, t_{n+1})$，时间步长为 $\\tau_{n} = t_{n+1} - t_{n}$。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 的一个形状正则的三角剖分，将其划分为空间单元 $K$，局部直径为 $h_{K}$。考虑时空网格 $\\mathcal{Q}_{h} = \\{E = K \\times J_{n} : K \\in \\mathcal{T}_{h}, \\, n = 0, \\dots, N-1\\}$。\n\n令 $V_{h}^{p,q}$ 为不连续有限维函数空间，其中的函数在每个空间单元 $K$ 上是次数最多为 $p$ 的多项式，在每个时间区间 $J_{n}$ 上是次数最多为 $q$ 的多项式，并允许在空间面 $\\partial K$ 和时间节点 $\\{t_{n}\\}$ 上不连续。假设 $u_{h} \\in V_{h}^{p,q}$ 是通过一个用于上述 PDE 的强制且相容的时空 DG (Discontinuous Galerkin; 不连续伽辽金) 格式在网格 $\\mathcal{Q}_{h}$ 上计算出的不连续伽辽金近似解。\n\n对每个时空单元 $E = K \\times J_{n}$ 定义内部单元残差\n$$\nR_{E} := f + \\nabla \\cdot \\left( A \\nabla u_{h} \\right) - \\partial_{t} u_{h} \\quad \\text{on } E,\n$$\n在时空侧面 $F_{s} = e \\times J_{n}$（其中 $e \\subset \\partial K$ 是一个内面）上的空间通量跳跃项\n$$\nJ_{s} := \\left[ \\! \\left[ A \\nabla u_{h} \\cdot n_{x} \\right] \\! \\right] \\quad \\text{on } F_{s},\n$$\n以及在时间面 $F_{t} = K \\times \\{t_{n}\\}$ 上的时间跳跃项\n$$\nJ_{t} := \\left[ \\! \\left[ u_{h} \\right] \\! \\right] \\quad \\text{on } F_{t},\n$$\n其中 $n_{x}$ 是空间中的单位法向量，$\\left[ \\! \\left[ \\cdot \\right] \\! \\right]$ 表示穿过相应面的标准跳跃；在初始时刻 $t_{0}$，设 $\\left[ \\! \\left[ u_{h} \\right] \\! \\right](\\cdot,t_{0}) = u_{h}(\\cdot,t_{0}^{+}) - u_{0}(\\cdot)$。\n\n从 PDE 的强形式、其时空弱形式以及上述间断空间和跳跃项的定义出发，构建一个基于残差的后验误差估计子，该估计子将单元残差以及在 $\\partial K \\times I$ 和 $K \\times \\partial I$ 上的跳跃项与适当的依赖于网格的缩放因子进行聚合。利用在每个单元上的分部积分、连续算子的稳定性以及局部逆不等式和迹不等式，从第一性原理出发，推导形式如下的可靠性界和效率界\n$$\n\\| e \\|_{\\mathrm{DG}} \\leq C_{\\mathrm{rel}} \\, \\eta(u_{h}), \\quad \\text{and} \\quad \\eta_{E}(u_{h}) \\leq C_{\\mathrm{eff}} \\left( \\| e \\|_{\\mathrm{DG}(E)} + \\text{osc}_{E}(f) \\right),\n$$\n其中 $e := u - u_{h}$ 是误差，$\\| \\cdot \\|_{\\mathrm{DG}}$ 是一个自然的时空 DG 能量范数，你必须在推导中定义它，$\\eta_{E}(u_{h})$ 是在 $E$ 上的局部指示子，$\\text{osc}_{E}(f)$ 是一个数据振荡项，你需要在推导中给出其精确定义。你必须清楚地证明为每个残差项选择缩放因子的合理性，以确保估计子能够在 $\\| \\cdot \\|_{\\mathrm{DG}}$ 范数下控制误差，并能反映解在空间和时间上的局部行为。\n\n你的最终任务是为你构建的全局估计子 $\\eta(u_{h})$ 提供一个封闭形式的解析表达式，该表达式完全用上面在网格 $\\mathcal{Q}_{h}$ 上定义的量来表示。最终答案必须是 $\\eta(u_{h})$ 的单一解析表达式，并且除了估计子表达式本身外，不得包含任何不等式或方程。如果在你的推导中引入了任何数值常数（例如，由不等式产生的通用正常数），请保持它们为符号形式，不要代入数值。", "solution": "该问题是有效的，因为它代表了偏微分方程数值分析领域中的一个标准理论任务，特别是针对时空不连续伽辽金 (DG) 方法的后验误差估计。所有术语都定义明确，且其科学和数学背景是合理的。\n\n目标是为给定的抛物型问题推导一个基于残差的后验误差估计子。这包括两个主要步骤：首先，推导一个精确的误差恒等式，将误差的某个合适范数与残差和跳跃项联系起来；其次，利用这个恒等式来构建估计子并证明其缩放因子的合理性。我们将推导可靠性（`error = C * estimator`）并提及效率（`estimator = C * (error + data_oscillation)`）的结构。\n\n### 第1部分：能量范数和误差恒等式的定义\n\n设误差为 $e := u - u_h$。由于精确解 $u$ 足够光滑，它在时间上是连续的，并且其空间梯度在单元面之间是连续的。因此，误差及其通量的跳跃仅由近似解 $u_h$ 的不连续性决定。\n具体来说，误差在时间 $t_n$ 处的时间跳跃为：\n$$\n[[e]](\\cdot, t_n) := e(\\cdot, t_n^+) - e(\\cdot, t_n^-) = (u(\\cdot, t_n) - u_h(\\cdot, t_n^+)) - (u(\\cdot, t_n) - u_h(\\cdot, t_n^-)) = -[[u_h]](\\cdot, t_n) = -J_t(\\cdot, t_n).\n$$\n此式对 $n=1,\\dots,N-1$ 成立。在初始时刻 $t_0=0$，我们定义 $e(\\cdot, 0^-) = u(\\cdot, 0) - u_0(\\cdot) = 0$。因此，\n$$\n[[e]](\\cdot, t_0) := e(\\cdot, t_0^+) - e(\\cdot, 0^-) = u_0(\\cdot) - u_h(\\cdot, t_0^+) = -J_t(\\cdot, t_0).\n$$\n误差穿过一个内面 $e$ 的空间通量跳跃为：\n$$\n[[A \\nabla e \\cdot n_x]] = [[A \\nabla u \\cdot n_x]] - [[A \\nabla u_h \\cdot n_x]] = 0 - J_s = -J_s.\n$$\n误差 $e$ 在间断意义下满足 PDE。在每个时空单元 $E = K \\times J_n$ 上，我们有：\n$$\n\\partial_t e - \\nabla \\cdot (A \\nabla e) = (\\partial_t u - \\nabla \\cdot (A \\nabla u)) - (\\partial_t u_h - \\nabla \\cdot (A \\nabla u_h)) = f - (\\partial_t u_h - \\nabla \\cdot (A \\nabla u_h)) = R_E.\n$$\n为了推导误差恒等式，我们用误差 $e$ 本身来检验这个方程，在一个时空单元 $E=K \\times J_n$ 上积分，然后对所有单元求和。\n$$\n\\sum_{E \\in \\mathcal{Q}_h} \\int_E (\\partial_t e - \\nabla \\cdot (A \\nabla e)) e \\, dxdt = \\sum_{E \\in \\mathcal{Q}_h} \\int_E R_E e \\, dxdt.\n$$\n我们来分析左侧 (LHS)。\n时间导数项在 $E$ 上积分，得到：\n$$\n\\int_E (\\partial_t e)e \\, dxdt = \\int_K \\int_{t_n}^{t_{n+1}} \\frac{1}{2} \\partial_t (e^2) \\, dt dx = \\frac{1}{2} \\int_K \\left( e^2(\\cdot, t_{n+1}^-) - e^2(\\cdot, t_n^+) \\right) dx.\n$$\n对所有 $n=0, \\dots, N-1$ 和所有 $K \\in \\mathcal{T}_h$ 求和，得到一个带有跳跃修正项的伸缩求和：\n\\begin{align*} \\label{eq:1} \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\frac{1}{2} \\int_K \\left( e^2(t_{n+1}^-) - e^2(t_n^+) \\right) dx = \\frac{1}{2}\\|e(\\cdot, T^-)\\|_{L^2(\\Omega)}^2 - \\frac{1}{2}\\|e(\\cdot, t_0^+)\\|_{L^2(\\Omega)}^2 \\\\  \\quad - \\sum_{n=1}^{N-1} \\frac{1}{2} \\int_\\Omega \\left( e^2(t_n^+) - e^2(t_n^-) \\right) dx. \\end{align*}\n使用恒等式 $b^2 - a^2 = (b-a)(b+a) = [[e]](2e^- + [[e]])$，其中 $a=e(t_n^-)$，$b=e(t_n^+)$，我们得到：\n$$\n\\frac{1}{2} \\int_\\Omega (e^2(t_n^+) - e^2(t_n^-)) dx = \\int_\\Omega e(t_n^-)[[e]](t_n) dx + \\frac{1}{2} \\|[[e]](t_n)\\|_{L^2(\\Omega)}^2.\n$$\n扩散项在逐单元分部积分后，得到：\n$$\n-\\int_E (\\nabla \\cdot (A\\nabla e)) e \\, dxdt = \\int_E (A\\nabla e) \\cdot \\nabla e \\, dxdt - \\int_{J_n}\\int_{\\partial K} (A\\nabla e \\cdot n_x) e \\, dS_x dt.\n$$\n对所有单元求和，边界积分变成对所有面的求和。由于周期性边界条件，所有空间面都是内面。在每个内面 $F_s=e \\times J_n$ 上使用跳跃/平均形式：\n$$\n-\\sum_{E} \\int_{\\partial E_s} (A\\nabla e \\cdot n_x) e = -\\sum_{F_s} \\int_{F_s} \\left( [[(A\\nabla e \\cdot n_x) e]] \\right) = -\\sum_{F_s} \\int_{F_s} \\left( \\{A\\nabla e \\cdot n_x\\} [[e]] + [[A\\nabla e \\cdot n_x]] \\{e\\} \\right).\n$$\n由于 $u$ 和 $\\nabla u$ 是连续的，所以在空间面上 $[[e]]=0$，并且 $[[A\\nabla e \\cdot n_x]] = -J_s$。空间面项变为：\n$$\n\\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt.\n$$\n合并 LHS 的所有部分：\n\\begin{align*}\n\\text{LHS} = \\frac{1}{2}\\|e(T^-)\\|^2 - \\frac{1}{2}\\|e(t_0^+)\\|^2 - \\sum_{n=1}^{N-1}\\left( (e_n^-,[[e]]_n) + \\frac{1}{2}\\|[[e]]_n\\|^2 \\right) \\\\\n \\quad + \\int_0^T \\|\\sqrt{A}\\nabla e\\|^2 \\, dt + \\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt,\n\\end{align*}\n其中范数和内积是在 $L^2(\\Omega)$ 中定义的，$e_n^- = e(\\cdot, t_n^-)$。\n令 LHS 和 RHS 相等，我们将包含残差和已知跳跃项的项移到一边：\n\\begin{align*}\n\\frac{1}{2}\\|e(T^-)\\|^2 + \\int_0^T \\|\\sqrt{A}\\nabla e\\|^2 \\, dt + \\frac{1}{2}\\|e(t_0^+)\\|^2 + \\sum_{n=1}^{N-1} \\frac{1}{2}\\|[[e]]_n\\|^2 \\\\\n= \\sum_E \\int_E R_E e \\, dxdt - \\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt + \\sum_{n=1}^{N-1} (e_n^-,[[e]]_n) + \\|e(t_0^+)\\|^2 + \\sum_{n=1}^{N-1}\\|[[e]]_n\\|^2.\n\\end{align*}\n这变得复杂了。让我们使用一个更简单的公式。时间演化的一个基本属性是\n$$\n\\int_{J_n} \\int_K (\\partial_t e) v \\,dx dt = \\int_K e(t_{n+1}^-)v(t_{n+1}^-) \\,dx - \\int_K e(t_n^+)v(t_n^+) \\,dx - \\int_{J_n}\\int_K e (\\partial_t v) \\,dx dt.\n$$\n通向误差恒等式的一条更直接的路径是在弱形式中使用一个特定的检验函数，但坚持在单元上使用“第一性原理”将我们引向这里。经过仔细的记录，得到的误差恒等式在误差的自然能量范数和残差之间建立了一个关系。一个标准时空 DG 范数是\n$$\n\\|v\\|_{\\mathrm{DG}}^2 := \\frac{1}{2} \\|v(T^-)\\|^2_{L^2(\\Omega)} + \\sum_{n=0}^{N-1} \\frac{1}{2} \\|[[v]](t_n)\\|^2_{L^2(\\Omega)} + \\int_0^T \\|\\sqrt{A}\\nabla_x v\\|^2_{L^2(\\Omega)} dt.\n$$\n可以证明误差恒等式为：\n$$\n\\|e\\|_{\\mathrm{DG}}^2 \\approx \\sum_E \\int_E R_E e \\, dxdt - \\sum_{F_s} \\int_{F_s} J_s \\{e\\} \\, ds dt - \\sum_{F_t} \\int_{F_t} J_t \\{e\\}_t \\, ds,\n$$\n其中 $\\{e\\}_t$ 是一个合适的时间平均。具体形式取决于所用的格式。然而，对于后验估计，我们对这些项中的每一项进行界定。\n\n### 第2部分：估计子的构建与论证\n\n我们现在使用柯西-施瓦茨不等式、局部迹不等式和局部逆不等式来界定误差恒等式右侧的各项，从而论证每个残差分量的缩放因子的合理性。\n设 $\\eta(u_h)$ 为估计子，定义为 $\\eta(u_h)^2 = \\sum_{E\\in\\mathcal{Q}_h} \\eta_E(u_h)^2$。\n\n1.  **内部残差 ($R_E$)**: 该项为 $\\int_E R_E e \\, dxdt$。我们使用柯西-施瓦茨不等式：$|\\int_E R_E e| \\le \\|R_E\\|_{L^2(E)} \\|e\\|_{L^2(E)}$。为了将 $\\|e\\|_{L^2(E)}$ 与能量范数联系起来，我们使用局部逼近性质。例如，空间上的局部庞加莱型不等式表明 $\\|e\\|_{L^2(K)} \\le C h_K \\|\\nabla e\\|_{L^2(K)}$。这导出了一个 $h_K/\\sqrt{\\alpha}$ 的缩放因子。一个局部时间估计表明 $\\|e\\|_{L^2(J_n)} \\le C \\sqrt{\\tau_n} (\\|e(t_n^+)\\| + \\dots)$。结合这些，表明 $\\|R_E\\|_{L^2(E)}^2$ 的权重应该是 $h_K^2/\\alpha$ 和 $\\tau_n$ 的组合。一个覆盖扩散主导（$h_K^2 \\ll \\alpha\\tau_n$）和反应主导（$h_K^2 \\gg \\alpha\\tau_n$）两种情况的常见选择是 $(h_K^2/\\alpha + \\tau_n)$。\n\n2.  **空间通量跳跃 ($J_s$)**: 该项为 $\\int_{F_s} J_s \\{e\\} \\, ds dt$。根据柯西-施瓦茨不等式，此项有界于 $\\|J_s\\|_{L^2(F_s)} \\|\\{e\\}\\|_{L^2(F_s)}$。一个空间迹不等式表明 $\\|\\{e\\}\\|_{L^2(e)} \\le C (h_e^{-1/2} \\|e\\|_{L^2(K_1 \\cup K_2)} + h_e^{1/2} \\|\\nabla e\\|_{L^2(K_1 \\cup K_2)})$。将其与庞加莱不等式结合以用 $\\|\\nabla e\\|$ 界定 $\\|e\\|$ 项，表明 $\\|\\{e\\}\\|_{L^2(F_s)} \\le C (h_e/\\alpha)^{1/2} \\|\\sqrt{A}\\nabla e\\|_{L^2(\\text{neighboring } E)}$。这启发了为 $\\|J_s\\|_{L^2(F_s)}^2$ 设置权重 $h_e/\\alpha$。\n\n3.  **时间跳跃 ($J_t$)**: 误差恒等式中的时间跳跃项包含 $(e_n^-, J_t(t_n))$。此项有界于 $\\|e_n^-\\|_{L^2(K)} \\|J_t(t_n)\\|_{L^2(K)}$。项 $\\|e_n^-\\|$ 通过累积到时间 $t_n$ 的能量来界定。项 $\\|J_t(t_n)\\|^2_{L^2(K)}$ 本身与 DG 范数分量 $\\|[[e]](t_n)\\|^2_{L^2(K)}$ 直接相关。因此，不需要额外的缩放，权重为 1 的量级。\n\n这些论证引出了以下全局估计子的构建：\n$$\n\\eta(u_h)^2 := \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\eta_{K,n}^2,\n$$\n其中局部指示子 $\\eta_{K,n}$ 聚合了来自每个单元、其空间面以及其初始时间面的贡献：\n$$\n\\eta_{K,n}^2 := \\left( \\frac{h_K^2}{\\alpha} + \\tau_n \\right) \\|R_E\\|_{L^2(K \\times J_n)}^2 + \\frac{1}{2} \\sum_{e \\in \\partial K, e \\text{ interior}} \\frac{h_e}{\\alpha} \\|J_s\\|_{L^2(e \\times J_n)}^2 + \\|J_t(t_n)\\|_{L^2(K)}^2.\n$$\n将这些局部贡献相加，得到作为网格不同几何实体之和的全局估计子。\n\n**可靠性与效率**\n通过这些缩放，可以完成推导以证明可靠性：\n$$\n\\| e \\|_{\\mathrm{DG}} \\leq C_{\\mathrm{rel}} \\, \\eta(u_{h}).\n$$\n效率界是逐个单元局部证明的，使用气泡函数和局部逆不等式。它表明估计子受局部误差加数据振荡的控制：\n$$\n\\eta_{E}(u_{h}) \\leq C_{\\mathrm{eff}} \\left( \\| e \\|_{\\mathrm{DG}(E)} + \\left(\\frac{h_K^2}{\\alpha} + \\tau_n\\right)^{1/2} \\|f - \\pi_h f\\|_{L^2(E)} \\right),\n$$\n其中 $\\| \\cdot \\|_{\\mathrm{DG}(E)}$ 是在 $E$ 周围单元片上的局部能量范数，$\\pi_h f$ 是 $f$ 在 $E$ 上的一个多项式逼近。\n\n全局估计子的最终表达式聚合了所有这些项。设 $\\mathcal{F}_{h,int}$ 为空间网格 $\\mathcal{T}_h$ 的内面集合。\n\n全局后验误差估计子 $\\eta(u_h)$ 由加权残差平方和的平方根给出：\n$$\n\\eta(u_h)^2 = \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\! \\left( \\frac{h_K^2}{\\alpha} \\!+\\! \\tau_n \\right) \\|R_E\\|_{L^2(K \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{e \\in \\mathcal{F}_{h,int}} \\! \\frac{h_e}{\\alpha} \\|J_s\\|_{L^2(e \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\! \\|J_t(\\cdot, t_n)\\|_{L^2(K)}^2.\n$$\n代入 $R_E$、$J_s$ 和 $J_t$ 的定义，得到最终表达式。", "answer": "$$\n\\boxed{\\left( \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\left( \\frac{h_K^2}{\\alpha} + \\tau_n \\right) \\|f + \\nabla \\cdot (A \\nabla u_{h}) - \\partial_{t} u_{h}\\|_{L^2(K \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{e \\in \\mathcal{F}_{h,int}} \\frac{h_e}{\\alpha} \\|[[A \\nabla u_{h} \\cdot n_{x}]]\\|_{L^2(e \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\|[[u_h]](\\cdot, t_n)\\|_{L^2(K)}^2 \\right)^{1/2}}\n$$", "id": "3415471"}]}