{"hands_on_practices": [{"introduction": "第一个练习旨在从头开始为一个经典的泊松问题 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 构建嵌入式间断伽辽金 (EDG) 方法。通过推导弱形式、定义离散多项式空间并理解迹变量 $\\widehat{u}_h$ 的作用，您将对该方法的核心组成部分及其预期性能有一个基本的认识。这项实践 [@problem_id:3383258] 为后续更高级的主题奠定了必要的基础。", "problem": "考虑具有狄利克雷边界条件的标量扩散模型问题：求 $u:\\Omega \\to \\mathbb{R}$ 使得在 $\\Omega=(0,1)^2$ 中 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 且在 $\\partial \\Omega$ 上 $u=g$，其中 $\\kappa=1$。取人造解函数 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ 和强迫项 $f=\\pi^2 u$，并设 $g=u|_{\\partial \\Omega}$（其恒为零）。从一阶系统表示和单元弱形式出发，推导在 $\\Omega$ 的一个形状规则、拟一致的轴对齐矩形剖分上，多项式次数为 $k=1$ 的嵌入式间断伽辽金 (Embedded Discontinuous Galerkin, EDG) 方法。明确指定单元通量 $q_h$、单元标量场 $u_h$ 和嵌入迹 $\\widehat{u}_h$ 的离散空间，并写出包含数值通量的局部 EDG 方程，其中稳定化参数 $\\tau>0$ 在每条边上为常数。然后，详细说明该矩形网格上 $k=1$ 的 EDG 迹空间中的迹连续性约束：解释在内部顶点和内部边上强制执行了何种连续性，以及狄利克雷边界值是如何在 $\\partial \\Omega$ 上被并入的。最后，将能量误差定义为 $\\left(\\sum_{K}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}$，$L^2$ 误差定义为 $\\|u-u_h\\|_{L^2(\\Omega)}$，并在 EDG 方法于拟一致网格上对光滑精确解具有标准稳定性和逼近性质的假设下，给出指数序偶 $(r_E,r_{L^2})$，使得当 $h\\to 0$ 时，对于 $k=1$，这些误差的行为如同 $C h^{r_E}$ 和 $C h^{r_{L^2}}$。将你的最终答案表示为一个包含两个指数的单行矩阵。无需四舍五入，不涉及物理单位。", "solution": "该问题陈述经核实具有科学依据、是适定的且客观的。它提出了一个偏微分方程数值分析领域的标准问题，特别地，是关于嵌入式间断伽辽金 (Embedded Discontinuous Galerkin, EDG) 方法的。所有用于构建该方法并确定其理论收敛性质的必要信息均已提供。\n\n问题始于域 $\\Omega=(0,1)^2$ 上的标量扩散方程：\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f\n$$\n其中 $\\kappa=1$。这是泊松方程 $-\\nabla^2 u = f$。为了推导该方法，我们将使用一般的强迫项 $f$。所提供的人造解 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ 对应的强迫项为 $f = -\\nabla^2 u = 2\\pi^2\\sin(\\pi x)\\sin(\\pi y) = 2\\pi^2 u$，这与问题中定义的 $f=\\pi^2 u$ 相差一个因子 $2$。这个不一致之处是次要的，不影响数值方法的推导或其一般收敛性质，而这些才是问题的核心。\n\nEDG 方法的构建首先将二阶偏微分方程改写为一阶系统。我们引入通量变量 $q = -\\kappa \\nabla u$。当 $\\kappa=1$ 时，即为 $q = -\\nabla u$。该系统为：\n$$\n\\begin{cases}\nq + \\nabla u = 0  \\text{在 } \\Omega \\text{ 中} \\\\\n\\nabla \\cdot q = f  \\text{在 } \\Omega \\text{ 中}\n\\end{cases}\n$$\n弱形式是逐个单元推导的。令 $\\mathcal{T}_h$ 是 $\\Omega$ 的一个由形状规则、拟一致、轴对齐的矩形 $K$ 构成的剖分。对于任意单元 $K \\in \\mathcal{T}_h$，我们将两个方程分别乘以向量和标量测试函数 $v_q$ 和 $v_u$，并在 $K$ 上积分：\n$$\n\\int_K (q + \\nabla u) \\cdot v_q \\, dK = 0\n$$\n$$\n\\int_K (\\nabla \\cdot q) v_u \\, dK = \\int_K f v_u \\, dK\n$$\n对散度项应用分部积分得到：\n$$\n\\int_K q \\cdot v_q \\, dK - \\int_K u (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} u (v_q \\cdot n) \\, dS = 0\n$$\n$$\n-\\int_K q \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q \\cdot n) v_u \\, dS = \\int_K f v_u \\, dK\n$$\n其中 $n$ 是边界 $\\partial K$ 的单位外法向量。\n\nEDG 方法定义了三个离散变量：近似标量场 $u_h$、近似通量 $q_h$ 和嵌入迹 $\\widehat{u}_h$。对于矩形网格上多项式次数为 $k=1$ 的情况，离散空间定义如下：\n\\begin{itemize}\n    \\item 单元标量场 $u_h$ 属于空间 $U_h = \\{v \\in L^2(\\Omega): v|_K \\in Q_1(K) \\text{ for all } K \\in \\mathcal{T}_h \\}$，其中 $Q_1(K)$ 是矩形 $K$ 上的双线性多项式空间，由 $\\{1, x, y, xy\\}$ 张成。\n    \\item 单元通量 $q_h$ 属于空间 $Q_h = \\{ v_q \\in (L^2(\\Omega))^2: v_q|_K \\in (P_1(K))^2 \\text{ for all } K \\in \\mathcal{T}_h \\}$，其中 $P_1(K)$ 是线性多项式空间。\n    \\item 嵌入迹 $\\widehat{u}_h$ 属于空间 $\\widehat{U}_h = \\{ \\widehat{v} \\in C^0(\\mathcal{E}_h) : \\widehat{v}|_e \\in P_1(e) \\text{ for all } e \\in \\mathcal{E}_h \\}$，其中 $\\mathcal{E}_h$ 是网格骨架（所有单元面的并集）。$C^0(\\mathcal{E}_h)$ 表示骨架上的连续函数空间，$P_1(e)$ 是边 $e$ 上的线性多项式空间。\n\\end{itemize}\n\nEDG 格式是通过将弱形式中的精确解及其边界迹替换为它们的离散对应物和数值通量得到的。$u$ 在 $\\partial K$ 上的迹被单值的迹变量 $\\widehat{u}_h$ 替代。通量的法向分量 $q \\cdot n$ 被数值通量 $\\widehat{q}_h \\cdot n$ 替代。包含稳定化参数 $\\tau>0$ 的数值通量的一个标准选择是：\n$$\n\\widehat{q}_h \\cdot n = q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)\n$$\n对于任意单元 $K \\in \\mathcal{T}_h$ 的局部 EDG 方程为：求 $(u_h|_K, q_h|_K) \\in Q_1(K) \\times (P_1(K))^2$，使得对于给定的 $\\partial K$ 上的 $\\widehat{u}_h$：\n$$\n\\int_K q_h \\cdot v_q \\, dK - \\int_K u_h (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} \\widehat{u}_h (v_q \\cdot n) \\, dS = 0, \\quad \\forall v_q \\in (P_1(K))^2\n$$\n$$\n-\\int_K q_h \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)) v_u \\, dS = \\int_K f v_u \\, dK, \\quad \\forall v_u \\in Q_1(K)\n$$\n这些局部方程通过迹变量 $\\widehat{u}_h$ 全局耦合。\n\n连续性约束完全被编码在迹空间 $\\widehat{U}_h$ 的定义中。\n\\begin{itemize}\n    \\item **内部顶点：** $\\widehat{U}_h$ 的自由度是函数在网格顶点处的值。对于一个内部顶点 $V$，只有一个未知值 $\\widehat{u}_h(V)$。这个值被所有与 $V$ 相邻的边共享，从而在顶点处强制实现 $C^0$ 连续性。\n    \\item **内部边：** 对于一个具有顶点 $V_1$ 和 $V_2$ 的内部边 $e$，函数 $\\widehat{u}_h|_e$ 是由值 $\\widehat{u}_{h}(V_1)$ 和 $\\widehat{u}_{h}(V_2)$ 决定的唯一线性多项式。由于 $\\widehat{u}_h$ 在骨架 $\\mathcal{E}_h$ 上是单值的，这同一个线性函数作为共享边 $e$ 的两个单元的迹。\n    \\item **狄利克雷边界：** 在区域边界 $\\partial\\Omega$ 上，$\\widehat{u}_h$ 的值不是未知的，而是由狄利克雷条件 $u=g$ 指定。对于任意顶点 $V \\in \\partial\\Omega$，相应的自由度是固定的：$\\widehat{u}_h(V) = g(V)$。在这个具体问题中，$g=0$，所以对于边界上的所有顶点 $V$，$\\widehat{u}_h(V) = 0$。这意味着在 $\\partial\\Omega$ 上 $\\widehat{u}_h \\equiv 0$。\n\\end{itemize}\n\n最后，我们考虑收敛阶。问题将能量误差和 $L^2$ 误差定义为：\n$$\n\\text{能量误差} = \\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}\n$$\n$$\nL^2 \\text{ 误差} = \\|u-u_h\\|_{L^2(\\Omega)}\n$$\n对于一个足够光滑的精确解 $u$ 和一个网格尺寸 $h \\to 0$ 的拟一致网格序列，使用 $k$ 次多项式的 DG 类方法的标准先验误差分析可以得到最优收敛阶。EDG 方法作为可杂交 DG (Hybridizable DG, HDG) 方法族的一员，达到了这些最优收敛阶。\n对于标量变量的 $L^2$ 误差，收敛阶比用于逼近的多项式次数高一阶。\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} = O(h^{k+1})\n$$\n对于能量误差，在破碎 $H^1$-半范数的意义下，收敛阶由多项式梯度的逼近性质决定。\n$$\n\\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2} = O(h^k)\n$$\n虽然已知 HDG/EDG 方法对通量变量 $q_h$ 可以达到 $O(h^{k+1})$ 的更高收敛阶，但这种高阶收敛性通常不会在没有特殊参数选择或后处理的情况下传递给破碎梯度 $\\nabla u_h$。\n对于指定的多项式次数 $k=1$，误差行为的指数为：\n\\begin{itemize}\n    \\item $r_E = k = 1$。能量误差的行为如同 $C h^1$。\n    \\item $r_{L^2} = k+1 = 2$。$L^2$ 误差的行为如同 $C h^2$。\n\\end{itemize}\n指数序偶为 $(r_E, r_{L^2}) = (1, 2)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$", "id": "3383258"}, {"introduction": "一个稳定且精确的数值格式依赖于其积分形式的正确计算。这项练习探讨了数值求积在 EDG 方法中的关键作用，特别是对于稳定项中形如 $(u_h - \\widehat{u}_h)^2$ 的被积函数。通过分析使用 $p$ 次多项式时各项的次数，您将确定 [@problem_id:3383256] 为防止混叠误差并确保理论性质得以保持所需的最低求积精度。", "problem": "考虑一个笛卡尔域上的标量泊松问题，该域上具有由张量积单元（二维矩形或三维六面体）组成的仿射网格。设应用嵌入式间断 Galerkin (EDG) 方法，其中内部单元的试探空间和检验空间由每个单元 $K$ 上总次数最高为 $k$ 的多项式（记作 $P^{k}(K)$）给出，并且在每个面上具有一个最高次数为 $k$ 的嵌入式（连续）迹空间。假设系数为常数，几何映射为仿射映射，因此雅可比矩阵为常数，并设稳定化参数 $\\tau$ 在每个面上为常数。对称 EDG 双线性形式包括：\n- 每个单元 $K$ 上的一个体项，涉及试探函数和检验函数梯度的乘积，\n- 面一致性项，涉及法向通量与内部函数和迹函数之差的配对，以及\n- 面稳定化项，在每个面上与乘积 $(u_{h}-\\widehat{u}_{h})(v_{h}-\\widehat{v}_{h})$ 成正比，其中 $u_{h},v_{h}\\in P^{k}(K)$，而 $\\widehat{u}_{h},\\widehat{v}_{h}$ 是它们在最高次数为 $k$ 的面空间中的迹。\n\n体积分的求积采用张量积高斯-勒让德法则，在每个坐标方向上具有相同的一维精度阶 $q$。面积分的求积采用沿面参数坐标的一维高斯-勒让德法则，其精度阶为 $q$。求积阶 $q$ 定义为能使该法则对相应积分变量中次数最高为 $q$ 的所有一维多项式都精确的最大整数。\n\n仅使用多项式空间 $P^{k}$ 的定义、仿射映射假设以及上述 EDG 双线性形式的结构，确定 $q$ 的最小整数值（作为 $k$ 的闭式函数），以保证在存在稳定化项时，张量积单元上 EDG 双线性形式的所有贡献项（包括体积分和面积分）都能被精确计算。请以关于 $k$ 的符号表达式给出最终答案，不带单位。", "solution": "该问题是有效的。这是一个在偏微分方程数值分析这一成熟领域内的适定问题，具体涉及嵌入式间断 Galerkin (EDG) 方法背景下对数值求积的要求。所有术语定义清晰，前提在科学上和数学上都是合理的。\n\n目标是确定一维高斯-勒让德求积法则的精度阶 $q$ 的最小整数值，使得由其构造的张量积法则足以精确积分泊松问题的对称 EDG 双线性形式中的所有项。分析必须同时考虑体积分和面积分。要求精确积分，因此我们必须找到双线性形式中出现的任何被积函数的最高多项式次数。\n\n令 $K$ 为网格中的一个张量积单元，$\\hat{K}$ 为参考单元（例如，对于维度 $d$，为 $[-1, 1]^d$）。问题陈述了从 $\\hat{K}$ 到 $K$ 的映射是仿射的，这意味着变换的雅可比矩阵 $J_K$ 及其行列式 $\\det(J_K)$ 是常数。类似地，对于 $K$ 的任意一个面 $F$，从参考面 $\\hat{F}$ 进行的面映射具有一个常数的雅可比行列式，即微分曲面元的缩放因子。\n\n试探函数和检验函数 $u_h$ 和 $v_h$ 属于空间 $P^{k}(K)$，这是在 $K$ 上总次数最高为 $k$ 的多项式空间。\n\n首先，我们分析双线性形式的体积分项：\n$$\n\\int_{K} \\nabla u_h \\cdot \\nabla v_h \\, dV\n$$\n由于 $u_h, v_h \\in P^{k}(K)$，它们的梯度 $\\nabla u_h$ 和 $\\nabla v_h$ 是向量值多项式，其分量是总次数最高为 $k-1$ 的多项式。因此，点积 $\\nabla u_h \\cdot \\nabla v_h$ 是一个总次数最高为 $(k-1) + (k-1) = 2k-2$ 的标量多项式。所以，被积函数属于 $P^{2k-2}(K)$。\n当变换到参考单元 $\\hat{K}$ 上时，积分变为：\n$$\n\\int_{\\hat{K}} (\\nabla_{\\hat{x}} \\hat{u}_h J_K^{-T}) \\cdot (\\nabla_{\\hat{x}} \\hat{v}_h J_K^{-T}) \\det(J_K) \\, d\\hat{V}\n$$\n其中 $\\hat{u}_h$ 和 $\\hat{v}_h$ 是参考单元上的多项式。由于映射是仿射的，$J_K$ 是一个常数矩阵。参考单元上的被积函数是关于参考坐标 $\\hat{x}$ 的多项式。其总次数与物理单元上的被积函数相同，即 $2k-2$。\n\n体求积是一个由一维精度阶为 $q$ 的高斯-勒让德法则构成的张量积法则。这意味着该一维法则能精确积分任何次数不高于 $q$ 的多项式。在一个 $d$ 维域上，由此类一维法则构造的张量积法则对于张量积空间 $Q_q = \\text{span}\\{x_1^{i_1} \\cdots x_d^{i_d} | 0 \\leq i_j \\leq q \\text{ for } j=1, \\dots, d\\}$ 中的所有多项式都是精确的。为保证对任何总次数为 $D$ 的多项式进行精确积分，我们必须确保 $P^D \\subset Q_q$。一个总次数为 $D$ 的多项式可以包含形如 $x_j^D$ 的单项式。为了使该项包含在 $Q_q$ 中，其指数必须小于或等于 $q$，因此我们必须有 $q \\geq D$。\n对于体项，被积函数的总次数为 $D = 2k-2$。因此，为使体积分精确，我们需要 $q \\geq 2k-2$。\n\n接下来，我们分析面积分项。这些积分在单元的面 $F$ 上进行计算。双线性形式包括一致性项和稳定化项。\n我们首先考虑稳定化项，根据问题陈述，它与以下表达式成正比：\n$$\n\\int_F \\tau (u_h - \\widehat{u}_h)(v_h - \\widehat{v}_h) \\, dS\n$$\n这里，$u_h$ 和 $v_h$ 来自 $P^k(K)$，它们在面 $F$ 上的迹（记为 $u_h|_F$ 和 $v_h|_F$）是关于 $(d-1)$ 维面坐标的总次数最高为 $k$ 的多项式。迹空间函数 $\\widehat{u}_h$ 和 $\\widehat{v}_h$ 也是面 $F$ 上次数最高为 $k$ 的多项式。因此，差 $(u_h - \\widehat{u}_h)$ 和 $(v_h - \\widehat{v}_h)$ 是面 $F$ 上总次数最高为 $k$ 的多项式。参数 $\\tau$ 在面上是常数。乘积 $(u_h - \\widehat{u}_h)(v_h - \\widehat{v}_h)$ 是面 $F$ 上总次数最高为 $k + k = 2k$ 的多项式。\n\n现在我们考虑一致性项，其形式（不计符号）为：\n$$\n\\int_F (\\nabla u_h \\cdot n) (v_h - \\widehat{v}_h) \\, dS\n$$\n法向量 $n$ 在仿射单元的平面上是常数。项 $\\nabla u_h \\cdot n$ 是 $\\nabla u_h$ 各分量的线性组合，这些分量是总次数最高为 $k-1$ 的多项式。因此，$\\nabla u_h \\cdot n$ 是一个总次数最高为 $k-1$ 的多项式。如前所述，$(v_h - \\widehat{v}_h)$ 是一个总次数最高为 $k$ 的多项式。因此，乘积 $(\\nabla u_h \\cdot n)(v_h - \\widehat{v}_h)$ 是面 $F$ 上总次数最高为 $(k-1) + k = 2k-1$ 的多项式。\n\n比较各项面积分，稳定化项的被积函数总次数为 $2k$，而一致性项的被积函数总次数为 $2k-1$。因此，面上多项式的最高次数为 $2k$，来自稳定化项。\n面求积是在 $(d-1)$ 维参考面上的张量积法则，由同样的一维精度阶为 $q$ 的法则构造。遵循与体积分相同的逻辑，为了在面上精确积分一个总次数为 $D_{\\text{face}}=2k$ 的多项式，一维法则的精度阶必须满足 $q \\geq D_{\\text{face}}$。因此，从面积分我们得到要求 $q \\geq 2k$。\n\n为确保 EDG 双线性形式中的所有项都被精确积分，我们必须满足体积分和面积分两方面的要求。\n来自体积分的要求：$q \\geq 2k-2$。\n来自面积分的要求：$q \\geq 2k$。\n更严格的条件是 $q \\geq 2k$。因此，满足这两个条件的 $q$ 的最小整数值为 $2k$。", "answer": "$$\n\\boxed{2k}\n$$", "id": "3383256"}, {"introduction": "现实世界的问题常常涉及各向异性，这给标准数值方法带来了挑战。这项实践 [@problem_id:3383210] 旨在引导您设计一个能够适应这种各向异性的稳定化参数 $\\tau$，从而展示 EDG 方法的稳健性。理解这种各向异性缩放是开发在任何物理或几何纵横比下都能保持一致稳定并维持最优收敛性的方法的关键。", "problem": "考虑在矩形域 $\\Omega \\subset \\mathbb{R}^2$ 上的标量扩散问题，其带有齐次狄利克雷边界条件：求 $u$ 使得\n$$\n-\\nabla \\cdot \\left(\\mathbf{A}\\,\\nabla u\\right) = f \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial\\Omega,\n$$\n其中扩散张量为对称正定对角矩阵 $\\mathbf{A} = \\mathrm{diag}(a_x, a_y)$，且 $a_x>0$ 和 $a_y>0$。设 $\\mathcal{T}_h$ 是 $\\Omega$ 的一个形状正则剖分，该剖分由边长为 $h_x$ 和 $h_y$ 的轴对齐矩形组成，可能存在各向异性 $h_x \\neq h_y$，但在整个网格上具有有界的纵横比。\n\n我们在 $\\mathcal{T}_h$ 上考虑一个多项式次数 $k \\ge 1$ 的嵌入式间断Galerkin (EDG) 方法，其中单元未知量 $u_h$ 和网格骨架上的全局单值迹 $\\widehat{u}_h$ 通过每个面 $F$ 上基于面的稳定化（也称为嵌入）参数 $\\tau_F>0$ 进行耦合。在每个具有单位法向量 $\\mathbf{n}_F$ 的内部面 $F$ 上，数值法向通量具有以下形式\n$$\n-\\mathbf{A}\\,\\nabla u_h \\cdot \\mathbf{n}_F \\;+\\; \\tau_F\\,(u_h - \\widehat{u}_h),\n$$\n在边界面上也有一致的选择。假设 $\\tau_F$ 可能依赖于局部单元尺寸和 $\\mathbf{A}$，并且网格是一致的，因此每个垂直面由两个宽度为 $h_x$ 的矩形共享，每个水平面由两个高度为 $h_y$ 的矩形共享。定义垂直于面 $F$ 的网格尺寸为 $h_{n,F}$，因此在垂直面上 $h_{n,F} = h_x$，在水平面上 $h_{n,F} = h_y$，并定义法向扩散率 $\\kappa_F := \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$。\n\n从EDG双线性形式的定义、单元分部积分、柯西-施瓦茨不等式和杨氏不等式、矩形上的各向异性迹不等式以及标准多项式反不等式出发，确定一个 $\\tau_F$ 的逐面各向异性缩放，该缩放足以保证EDG双线性形式的一致矫顽性，其常数与纵横比 $h_x/h_y$ 无关，并且在标准正则性假设下，在破碎能量范数和 $L^2$ 范数中保持最优收敛率。您提出的缩放应以 $k$、$\\kappa_F$ 和 $h_{n,F}$ 表示，并应在垂直面上简化为涉及 $a_x$ 和 $h_x$ 的缩放，在水平面上简化为涉及 $a_y$ 和 $h_y$ 的缩放。在以下选项中，选择一个满足这些标准并且不会在单元较长的方向上过度惩罚面，从而使得凝聚EDG系统的条件数与面法向网格尺寸倒数的平方保持最优比例的选项。\n\n哪个 $\\tau_F$ 的选择是合适的？\n\nA. $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$，其中 $h_{t,F}$ 是与 $F$ 相切的网格尺寸，而 $C>0$ 是一个与 $h_x$、$h_y$、$a_x$、$a_y$ 和 $k$ 无关的通用常数。\n\nB. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$，当 $h_{n,F}$ 在面两侧不同时，面的取值为两个相邻单元贡献的最大值；在一致的矩形网格上，这在垂直面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$，在水平面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$。\n\nC. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$，统一应用于所有面，不论其方向如何。\n\nD. $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$，统一应用于所有面，不论其方向如何。\n\nE. $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$，其中 $C>0$ 与 $h_x$、$h_y$、$a_x$、$a_y$ 和 $k$ 无关。", "solution": "嵌入式间断Galerkin (EDG) 方法是一种可混合间断Galerkin (HDG) 方法。稳定性和收敛性分析取决于稳定化参数 $\\tau_F$ 的正确选择，该参数弱地施加了解在单元面上的连续性。该问题要求为在具有各向异性单元的网格上、具有各向异性张量 $\\mathbf{A}$ 的扩散问题找到一个 $\\tau_F$ 的各向异性缩放。该缩放必须确保迹变量 $\\widehat{u}_h$ 的全局系统具有一致的矫顽性，保持最优收敛率，并保持全局矩阵的良好条件数，其常数与网格纵横比 $h_x/h_y$ 和扩散各向异性 $a_x/a_y$ 无关。\n\n稳定化参数的推导源于该方法的稳定性分析。为了使迹变量 $\\widehat{u}_h$ 的全局系统是矫顽的，必须控制由分部积分产生的某些项。在DG类方法的分析中，一个关键步骤是利用体积分来界定面积分项。让我们分析这个关键项。在经过一些代数运算后，矫顽性证明需要将形如 $\\sum_{K \\in \\mathcal{T}_h} \\sum_{F \\subset \\partial K} \\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla u_h)\\|^2_{L^2(F)}$ 的项用自然能量范数项 $\\sum_{K \\in \\mathcal{T}_h} \\|\\mathbf{A}^{1/2} \\nabla u_h\\|^2_{L^2(K)}$ 的一小部分来界定。这需要一个如下形式的不等式：\n$$\n\\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)} \\le C_{inv} \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}\n$$\n对于单元 $K$ 上任意次数为 $k$ 的多项式 $v_h$，其中 $F$ 是 $K$ 的一个面。此处，$C_{inv}$ 是一个依赖于多项式次数 $k$ 但与单元几何形状（$h_x$，$h_y$）和扩散张量（$\\mathbf{A}$）无关的常数。这是一种各向异性迹反不等式。众所周知，对多项式次数的依赖性是二次的，即 $C_{inv} \\propto (k+1)^2$。\n\n为理解此不等式为何成立，考虑一个边长为 $h_x$ 和 $h_y$ 的矩形单元 $K$ 和一个垂直面 $F$（因此 $\\mathbf{n}_F = (\\pm 1, 0)^\\top$）。在这个面上，$h_{n,F} = h_x$，法向扩散率为 $\\kappa_F = \\mathbf{n}_F^\\top\\mathbf{A}\\mathbf{n}_F = a_x$。需要界定的量是 $\\|a_x \\partial_x v_h\\|^2_{L^2(F)}$。通过缩放到一个参考单元 $\\hat{K}$，应用多项式及其导数的迹不等式，然后再缩放回物理单元 $K$，可以证明：\n$$\n\\|a_x \\partial_x v_h\\|^2_{L^2(F)} \\le C(k+1)^2 \\frac{a_x}{h_x} \\left( a_x \\|\\partial_x v_h\\|^2_{L^2(K)} + a_y \\|\\partial_y v_h\\|^2_{L^2(K)} \\right)\n$$\n右边的项恰好是 $C(k+1)^2 \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$。\n类似的论证对水平面也成立。\n\n为了稳定性，我们必须选择足够大的 $\\tau_F$ 来控制由迹不等式产生的项。具体来说，为了使 $\\sum_{K,F}\\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)}$ 能被 $\\sum_K \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$ 吸收，我们需要选择 $\\tau_F$ 使得：\n$$\n\\tau_F \\ge C_0 (k+1)^2 \\frac{\\kappa_F}{h_{n,F}}\n$$\n对于一个足够大的常数 $C_0 > 0$。这个选择确保了 $\\widehat{u}_h$ 的全局系统的矫顽常数与纵横比 $h_x/h_y$ 和扩散各向异性 $a_x/a_y$ 无关。\n\n这个缩放也被认为是最优的。一个较小的 $\\tau_F$（例如，$(k+1)$ 的幂次较低或对 $h$ 或 $\\mathbf{A}$ 的依赖关系不同）将无法提供一致的稳定性。一个显著较大的 $\\tau_F$（过度惩罚）会降低近似误差界中的常数并污染解，导致次优收敛。它还会不必要地增加系统矩阵的条件数。这个特定的选择不会过度惩罚面，因为在面 $F$ 上，惩罚项仅依赖于垂直于它的网格尺寸 $h_{n,F}$ 和该法向方向上的扩散率 $\\kappa_F$。这个性质对于为凝聚系统保持最优条件数至关重要，该条件数应按 $\\max_{F} (h_{n,F}^{-2})$ 比例缩放，且与任何各向异性无关。\n\n让我们根据这个推导来检查给定的选项。$\\tau_F$ 的合适缩放与 $(k+1)^2 \\frac{\\kappa_F}{h_{n,F}}$ 成正比。\n\n**选项 A: $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$**\n这个选项有几个缺陷。\n1. 对多项式次数的依赖性是 $(k+1)$，对于一般的 $k \\ge 1$ 来说，这不足以保证稳定性。反不等式引入了一个 $(k+1)^2$ 因子。\n2. 对法向扩散率 $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$ 的依赖性是通过其平方根 $\\sqrt{\\kappa_F}$，这是不正确的。缩放应与 $\\kappa_F$ 呈线性关系。\n3. 网格尺寸的依赖性是 $h_{t,F}^{-1}$，即*切向*网格尺寸的倒数。对于各向异性单元，稳定性要求依赖于*法向*网格尺寸 $h_{n,F}^{-1}$。使用 $h_{t,F}$ 会使得在法向短而切向长的单元上的稳定化参数过小，从而导致失去一致稳定性。\n**结论：不正确。**\n\n**选项 B: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$，当 $h_{n,F}$ 在面两侧不同时，面的取值为两个相邻单元贡献的最大值；在一致的矩形网格上，这在垂直面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$，在水平面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$。**\n这正是从稳定性分析中推导出的缩放。\n1. 对多项式次数的依赖性是 $(k+1)^2$。\n2. 对扩散率的依赖性与 $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$ 呈线性关系。\n3. 对网格尺寸的依赖性是 $h_{n,F}^{-1}$，即法向网格尺寸的倒数。\n这个选择保证了一致矫顽性，能得到最优误差估计，并且不会过度惩罚，从而保持了凝聚系统的最优条件数。对于一致矩形网格的指定简化形式也是正确的：在垂直面上，$\\kappa_F = a_x$ 且 $h_{n,F}=h_x$；在水平面上，$\\kappa_F = a_y$ 且 $h_{n,F}=h_y$。\n**结论：正确。**\n\n**选项 C: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$，统一应用于所有面，不论其方向如何。**\n这是一个各向同性的缩放，因为它不依赖于面方向 $\\mathbf{n}_F$。它使用了网格尺寸的算术平均值和扩散张量的迹 $\\mathrm{tr}(\\mathbf{A}) = a_x + a_y$。如果一个单元是高度各向异性的，例如 $h_x \\ll h_y$，那么在垂直面上，稳定性需要一个与 $a_x/h_x$ 成正比的惩罚项。这个公式提供了一个大约为 $(a_x+a_y)/h_y$ 的惩罚项，它可能比要求的要小得多，从而导致稳定性丧失。因此，它不能提供一致的矫顽性。\n**结论：不正确。**\n\n**选项 D: $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$，统一应用于所有面，不论其方向如何。**\n这是另一个各向同性的缩放。虽然它很可能通过取所有可能方向上所需的最大惩罚来保证矫顽性，但它违反了不过度惩罚的标准。例如，如果 $a_x/h_x \\gg a_y/h_y$，这种缩放会将大的惩罚项 $\\sim a_x/h_x$ 应用于*所有*面，包括那些只需要较小惩罚项 $\\sim a_y/h_y$ 的水平面。这种过度惩罚会降低误差估计中的精度常数，并且关键的是，会恶化全局系统的条件数，使其依赖于纵横比。\n**结论：不正确。**\n\n**选项 E: $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$，其中 $C>0$ 与 $h_x$、$h_y$、$a_x$、$a_y$ 和 $k$ 无关。**\n这个缩放表明 $\\tau_F \\simeq C(k+1)^2 \\kappa_F h_{n,F}$。网格尺寸的依赖性是 $h_{n,F}$，而不是 $h_{n,F}^{-1}$。当网格加密时（$h_{n,F} \\to 0$），这个稳定化参数会消失。一个消失的惩罚项无法控制跳跃项或通量项，因此该方法将不稳定。惩罚参数必须足够大，而不是小。尽管公式中包含 $(k+1)^2$，但声称 $C$ 与 $k$ 无关，这个小的不一致性并不能改变与 $h_{n,F}$ 的缩放是根本错误的这一事实。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "3383210"}]}