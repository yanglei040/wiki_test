{"hands_on_practices": [{"introduction": "深入理解间断 Galerkin (DG) 方法的第一步是掌握其基本构造。任何 DG 求解器的核心都是将连续的弱形式方程离散化为一组矩阵算子。本练习将引导你通过基本原理，使用勒让德多项式 (Legendre polynomials) 作为基函数，亲自计算参考单元上的一个关键矩阵——微分矩阵。这个过程不仅能加深你对弱形式积分如何转化为离散代数运算的理解，还能让你熟悉勒让德多项式的重要性质，例如正交性，这是谱方法和 DG 方法的基石。", "problem": "考虑一种标量守恒律 $u_{t} + f(u)_{x} = 0$ 的半离散 Discontinuous Galerkin (DG) 方法，例如常数 $a$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$ 或无粘性 Burgers 方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$。在每个单元上，在映射到参考坐标 $\\xi \\in [-1,1]$ 后，一个模态谱近似将解在 Legendre 多项式基 $\\{\\phi_{k}(\\xi)\\}_{k=0}^{p}$ 中展开，其中 $\\phi_{k}$ 表示 $k$ 次 Legendre 多项式。对于标准 Legendre 基，其元素为\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n的刚度类微分矩阵 $D$ 源于弱形式，并且是构造通量导数的 DG 算子的核心。\n\n利用 Legendre 多项式的基本性质——在 $[-1,1]$ 上的正交性、奇偶性、端点值 $\\phi_{n}(1) = 1$ 和 $\\phi_{n}(-1) = (-1)^{n}$，以及 $\\phi_{k}$ 是一个 $k$ 次多项式的事实——计算多项式次数为 $p = 2$ 时矩阵 $D$ 的所有元素，取标准（未归一化）Legendre 多项式 $\\phi_{0}(\\xi) = 1$、$\\phi_{1}(\\xi) = \\xi$ 和 $\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)$。将您的最终结果表示为一个封闭形式的 $3 \\times 3$ 矩阵。无需四舍五入，也无物理单位。用单个解析表达式给出完整矩阵作为答案。", "solution": "任务是计算次数为 $p=2$ 的多项式基的刚度类微分矩阵 $D$。该矩阵的元素 $D_{kl}$ 由以下积分定义：\n$$\nD_{kl} = \\int_{-1}^{1} \\phi_{k}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n其中 $k, l \\in \\{0, 1, 2\\}$，且 $\\{\\phi_k\\}$ 是参考区间 $\\xi \\in [-1, 1]$ 上的标准 Legendre 多项式基。问题为 $p=2$ 提供了具体的基函数：\n$$\n\\phi_{0}(\\xi) = 1 \\\\\n\\phi_{1}(\\xi) = \\xi \\\\\n\\phi_{2}(\\xi) = \\frac{1}{2}\\left(3\\xi^{2} - 1\\right)\n$$\n首先，我们计算这些基函数关于 $\\xi$ 的导数：\n$$\n\\phi_{0}'(\\xi) = \\frac{d}{d\\xi}(1) = 0 \\\\\n\\phi_{1}'(\\xi) = \\frac{d}{d\\xi}(\\xi) = 1 \\\\\n\\phi_{2}'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(3\\xi^{2} - 1)\\right) = \\frac{1}{2}(6\\xi) = 3\\xi\n$$\n我们可以观察到，这些导数可以用基函数本身来表示：\n$$\n\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi) \\\\\n\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)\n$$\n现在我们通过为每一对 $(k, l)$ 系统地计算积分来计算 $3 \\times 3$ 矩阵 $D$ 的 9 个元素。我们将利用 Legendre 多项式的基本正交性质：\n$$\n\\int_{-1}^{1} \\phi_{m}(\\xi)\\,\\phi_{n}(\\xi)\\,d\\xi = 0 \\quad \\text{for } m \\neq n\n$$\n\n**第 1 行：$k=0$**\n对于这一行，导数为 $\\phi_{0}'(\\xi) = 0$。\n$$\nD_{0l} = \\int_{-1}^{1} \\phi_{0}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 0 \\cdot \\phi_{l}(\\xi)\\,d\\xi = 0 \\quad \\text{for } l \\in \\{0, 1, 2\\}\n$$\n因此，矩阵 $D$ 的第一行完全为零：$D_{00} = 0$，$D_{01} = 0$，$D_{02} = 0$。\n\n**第 2 行：$k=1$**\n对于这一行，导数为 $\\phi_{1}'(\\xi) = 1 = \\phi_{0}(\\xi)$。\n$$\nD_{1l} = \\int_{-1}^{1} \\phi_{1}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- 对于 $l=0$：\n$$\nD_{10} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = \\int_{-1}^{1} (1)(1)\\,d\\xi = \\int_{-1}^{1} 1\\,d\\xi = [\\xi]_{-1}^{1} = 1 - (-1) = 2\n$$\n- 对于 $l=1$：\n$$\nD_{11} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 0 \\neq 1)\n$$\n- 对于 $l=2$：\n$$\nD_{12} = \\int_{-1}^{1} \\phi_{0}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 0 \\neq 2)\n$$\n矩阵 $D$ 的第二行为 $[2, 0, 0]$。\n\n**第 3 行：$k=2$**\n对于这一行，导数为 $\\phi_{2}'(\\xi) = 3\\xi = 3\\phi_{1}(\\xi)$。\n$$\nD_{2l} = \\int_{-1}^{1} \\phi_{2}'(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = \\int_{-1}^{1} 3\\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{l}(\\xi)\\,d\\xi\n$$\n- 对于 $l=0$：\n$$\nD_{20} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{0}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 1 \\neq 0)\n$$\n- 对于 $l=1$：\n$$\nD_{21} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{1}(\\xi)\\,d\\xi = 3 \\int_{-1}^{1} \\xi^{2}\\,d\\xi = 3 \\left[\\frac{\\xi^{3}}{3}\\right]_{-1}^{1} = 3 \\left(\\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3}\\right) = 3 \\left(\\frac{1}{3} - \\left(-\\frac{1}{3}\\right)\\right) = 3 \\left(\\frac{2}{3}\\right) = 2\n$$\n- 对于 $l=2$：\n$$\nD_{22} = 3 \\int_{-1}^{1} \\phi_{1}(\\xi)\\,\\phi_{2}(\\xi)\\,d\\xi = 0 \\quad \\text{(by orthogonality, since } 1 \\neq 2)\n$$\n矩阵 $D$ 的第三行为 $[0, 2, 0]$。\n\n综合这些结果，我们构造矩阵 $D$：\n$$\nD = \\begin{pmatrix} D_{00}  D_{01}  D_{02} \\\\ D_{10}  D_{11}  D_{12} \\\\ D_{20}  D_{21}  D_{22} \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 2  0  0 \\\\ 0  2  0 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0 \\\\ 2  0  0 \\\\ 0  2  0 \\end{pmatrix}}\n$$", "id": "3378346"}, {"introduction": "在构建了离散算子之后，理解它们的性质和在实际计算中可能出现的微妙问题至关重要。虽然 DG 方法的强形式和弱形式在连续理论中是等价的，但当使用数值积分（求积）来近似计算积分时，这种等价性可能会被打破。本练习通过一个精心设计的思想实验，即故意使用不精确的求积规则，来揭示这一现象。你将直接计算由“混叠误差”(aliasing error) 引起的能量变化率差异，从而直观地理解离散守恒定律是如何受到求积精度影响的。", "problem": "考虑参考区间 $[-1,1]$ 上的一维线性平流方程\n$$\nu_{t} + s\\,u_{x} = 0,\n$$\n采用常数平流速度 $s>0$，通过使用勒让德多项式试验和测试空间、多项式阶数为 $N$ 的单单元模态间断伽辽金 (DG) 方法（Discontinuous Galerkin）进行离散。半离散 DG 公式通过使用 $v \\in \\mathbb{P}_{N}$ 进行测试，并在单元边界上逐点选取数值通量来定义。在单元上定义 DG 强形式为\n$$\n\\int_{-1}^{1} v\\,u_{t}\\,dx + \\int_{-1}^{1} v\\,s\\,u_{x}\\,dx - v^{-} \\widehat{f}\\big|_{x=-1} + v^{+} \\widehat{f}\\big|_{x=1} = 0,\n$$\n以及 DG 弱形式为\n$$\n\\int_{-1}^{1} v\\,u_{t}\\,dx - \\int_{-1}^{1} v_{x}\\,s\\,u\\,dx + v^{-} \\widehat{f}\\big|_{x=-1} - v^{+} \\widehat{f}\\big|_{x=1} = 0,\n$$\n其中 $\\widehat{f}$ 是物理通量 $f=s\\,u$ 的相容数值通量，上标 $-$ 和 $+$ 分别表示左、右单元边界上的值。假设中心数值通量为 $\\widehat{f}=\\frac{1}{2}\\big(f^{-}+f^{+}\\big)$，并考虑通过用 $v=u$ 进行测试以及使用基于求积的内积测量能量来计算瞬时能量速率\n$$\nE_{Q}(t) := \\frac{1}{2}\\,(u,u)_{Q}, \\qquad (w,z)_{Q} := \\sum_{q=1}^{Q} w_{q}\\,w(x_{q})\\,z(x_{q}).\n$$\n\n你需要计算在体积项使用 $Q=2$ 点高斯-勒让德求积（节点 $x_{1}=-1/\\sqrt{3}$，$x_{2}=+1/\\sqrt{3}$，权重 $w_{1}=w_{2}=1$）进行刻意欠积分的情况下，从强形式和弱形式 DG 得到的两个能量速率 $E'_{\\text{strong}}(0)$ 和 $E'_{\\text{weak}}(0)$。假设一个多项式阶数 $N=3$ 的近似，其初始 DG 场为\n$$\nu_{h}(x,0) = (x^{2}-1)(x+1),\n$$\n该场满足 $u_{h}(-1,0)=u_{h}(1,0)=0$，因此在使用中心通量时，强形式和弱形式在 $t=0$ 时的瞬时边界贡献都为零。\n\n从上述守恒律和 DG 原理出发，并对所有体积内积仅使用指定的求积方法，推导并计算在 $t=0$ 时强弱能量速率之间的瞬时差值，\n$$\n\\Delta := E'_{\\text{strong}}(0) - E'_{\\text{weak}}(0),\n$$\n表示为一个精确的实数。在你的计算中，取 $s=1$。请以精确值的形式提供最终答案。如果在计算过程中得到近似小数，不要四舍五入；相反，在报告最终结果之前，应将其简化为有理数或闭式表达式。答案不需要物理单位。", "solution": "首先，我们建立能量速率的表达式。能量使用基于求积的内积定义为 $E_{Q}(t) := \\frac{1}{2}\\,(u,u)_{Q}$。能量的变化率为：\n$$\nE'_{Q}(t) = \\frac{d}{dt} \\left( \\frac{1}{2} (u,u)_{Q} \\right) = \\frac{1}{2} \\left( (\\frac{du}{dt}, u)_{Q} + (u, \\frac{du}{dt})_{Q} \\right)\n$$\n由于求积内积 $(w,z)_{Q} := \\sum_{q=1}^{Q} w_{q}\\,w(x_{q})\\,z(x_{q})$ 是对称的，这可以简化为：\n$$\nE'_{Q}(t) = (u_t, u)_{Q}\n$$\n我们需要对强形式和弱形式的 DG 公式，在 $t=0$ 时计算这个表达式。这需要从每种形式中找到 $(u_t, u)_{Q}$ 的表达式。\n\n首先分析强形式。使用指定求积进行体积积分的半离散强形式为：\n$$\n(v, u_t)_{Q} + s(v, u_x)_{Q} - v(-1) \\widehat{f}(-1) + v(1) \\widehat{f}(1) = 0\n$$\n为了计算能量速率，我们将测试函数 $v$ 设为解 $u$：\n$$\n(u, u_t)_{Q} + s(u, u_x)_{Q} - u(-1) \\widehat{f}(-1) + u(1) \\widehat{f}(1) = 0\n$$\n这给出了强形式的能量速率：\n$$\nE'_{\\text{strong}}(t) = (u, u_t)_{Q} = -s(u, u_x)_{Q} + u(-1) \\widehat{f}(-1) - u(1) \\widehat{f}(1)\n$$\n问题指定了初始 DG 场 $u_h(x,0) = (x^2-1)(x+1)$。在单元边界 $x=-1$ 和 $x=1$ 处：\n$u_h(-1,0) = ((-1)^2-1)(-1+1) = 0$\n$u_h(1,0) = ((1)^2-1)(1+1) = 0$\n因此，在 $t=0$ 时边界项消失：\n$$\nE'_{\\text{strong}}(0) = -s(u_h(x,0), u_{h,x}(x,0))_{Q}\n$$\n\n接下来，我们分析弱形式。使用求积的半离散弱形式为：\n$$\n(v, u_t)_{Q} - s(v_x, u)_{Q} + v(-1) \\widehat{f}(-1) - v(1) \\widehat{f}(1) = 0\n$$\n设 $v=u$：\n$$\n(u, u_t)_{Q} - s(u_x, u)_{Q} + u(-1) \\widehat{f}(-1) - u(1) \\widehat{f}(1) = 0\n$$\n这给出了弱形式的能量速率：\n$$\nE'_{\\text{weak}}(t) = (u, u_t)_{Q} = s(u_x, u)_{Q} - u(-1) \\widehat{f}(-1) + u(1) \\widehat{f}(1)\n$$\n同样地，由于 $u_h(-1,0)=u_h(1,0)=0$，在 $t=0$ 时边界项消失。\n$$\nE'_{\\text{weak}}(0) = s(u_{h,x}(x,0), u_h(x,0))_{Q}\n$$\n由于求积内积的对称性，$(u_x, u)_Q = (u, u_x)_Q$。因此：\n$$\nE'_{\\text{weak}}(0) = s(u_h(x,0), u_{h,x}(x,0))_{Q}\n$$\n\n现在我们可以计算差值 $\\Delta$：\n$$\n\\Delta = E'_{\\text{strong}}(0) - E'_{\\text{weak}}(0) = -s(u_h, u_{h,x})_{Q} - s(u_h, u_{h,x})_{Q} = -2s(u_h, u_{h,x})_{Q}\n$$\n问题指定了常数平流速度 $s=1$。任务简化为在 $t=0$ 时计算内积 $(u_h, u_{h,x})_{Q}$。\n问题指定了一个 $Q=2$ 点的高斯-勒让德求积法则。节点为 $x_1 = -1/\\sqrt{3}$，$x_2 = +1/\\sqrt{3}$，权重为 $w_1=w_2=1$。内积为：\n$$\n(w,z)_{Q} = \\sum_{q=1}^{2} w_q w(x_q) z(x_q) = w(x_1)z(x_1) + w(x_2)z(x_2)\n$$\n所以我们需要计算：\n$$\n\\Delta = -2 \\left[ u_h(x_1, 0) u_{h,x}(x_1, 0) + u_h(x_2, 0) u_{h,x}(x_2, 0) \\right]\n$$\n初始条件为 $u_h(x,0) = (x^2-1)(x+1) = x^3 + x^2 - x - 1$。其导数为 $u_{h,x}(x,0) = 3x^2 + 2x - 1$。\n\n让我们在求积节点处计算这些多项式的值。设 $x = \\pm 1/\\sqrt{3}$，所以 $x^2=1/3$。\n\n在第一个节点，$x_1 = -1/\\sqrt{3}$：\n$$\nu_h(x_1, 0) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(-\\frac{1}{\\sqrt{3}}\\right)^2 - \\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{3} + \\frac{1}{\\sqrt{3}} - 1 = \\frac{2}{3\\sqrt{3}} - \\frac{2}{3} = \\frac{2-2\\sqrt{3}}{3\\sqrt{3}}\n$$\n$$\nu_{h,x}(x_1, 0) = 3\\left(-\\frac{1}{\\sqrt{3}}\\right)^2 + 2\\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = 3\\left(\\frac{1}{3}\\right) - \\frac{2}{\\sqrt{3}} - 1 = 1 - \\frac{2}{\\sqrt{3}} - 1 = -\\frac{2}{\\sqrt{3}}\n$$\n在 $x_1$ 处的乘积是：\n$$\nu_h(x_1, 0)u_{h,x}(x_1, 0) = \\left(\\frac{2-2\\sqrt{3}}{3\\sqrt{3}}\\right) \\left(-\\frac{2}{\\sqrt{3}}\\right) = \\frac{-4+4\\sqrt{3}}{3 \\cdot 3} = \\frac{-4+4\\sqrt{3}}{9}\n$$\n\n在第二个节点，$x_2 = 1/\\sqrt{3}$：\n$$\nu_h(x_2, 0) = \\left(\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(\\frac{1}{\\sqrt{3}}\\right)^2 - \\frac{1}{\\sqrt{3}} - 1 = \\frac{1}{3\\sqrt{3}} + \\frac{1}{3} - \\frac{1}{\\sqrt{3}} - 1 = -\\frac{2}{3\\sqrt{3}} - \\frac{2}{3} = \\frac{-2-2\\sqrt{3}}{3\\sqrt{3}}\n$$\n$$\nu_{h,x}(x_2, 0) = 3\\left(\\frac{1}{\\sqrt{3}}\\right)^2 + 2\\left(\\frac{1}{\\sqrt{3}}\\right) - 1 = 3\\left(\\frac{1}{3}\\right) + \\frac{2}{\\sqrt{3}} - 1 = 1 + \\frac{2}{\\sqrt{3}} - 1 = \\frac{2}{\\sqrt{3}}\n$$\n在 $x_2$ 处的乘积是：\n$$\nu_h(x_2, 0)u_{h,x}(x_2, 0) = \\left(\\frac{-2-2\\sqrt{3}}{3\\sqrt{3}}\\right) \\left(\\frac{2}{\\sqrt{3}}\\right) = \\frac{-4-4\\sqrt{3}}{3 \\cdot 3} = \\frac{-4-4\\sqrt{3}}{9}\n$$\n\n现在，我们计算内积 $(u_h, u_{h,x})_{Q}$：\n$$\n(u_h, u_{h,x})_{Q} = \\left(\\frac{-4+4\\sqrt{3}}{9}\\right) + \\left(\\frac{-4-4\\sqrt{3}}{9}\\right) = \\frac{-4+4\\sqrt{3}-4-4\\sqrt{3}}{9} = -\\frac{8}{9}\n$$\n\n最后，我们计算 $\\Delta$：\n$$\n\\Delta = -2s(u_h, u_{h,x})_{Q} = -2(1)\\left(-\\frac{8}{9}\\right) = \\frac{16}{9}\n$$\n能量速率的差异是由于使用了一个对于被积函数 $u_h u_{h,x}$（一个5次多项式）不精确的求积法则所引入的混叠误差的直接结果。2点高斯-勒让德求积法则仅对最高为 $2(2)-1=3$ 次的多项式是精确的。", "answer": "$$\n\\boxed{\\frac{16}{9}}\n$$", "id": "3378342"}, {"introduction": "将 DG 方法应用于非线性问题（如无粘性伯格斯方程, inviscid Burgers' equation）时，一个核心的实际挑战是确保数值稳定性。对于显式时间积分方案，时间步长 $\\Delta t$ 必须满足 Courant-Friedrichs-Lewy (CFL) 条件，以防止解的无界增长。本练习将理论与实践相结合，要求你为一个具体的非线性问题推导并应用 CFL 限制。你将根据离散解的当前状态（通过节点值估计局部最大波速）和网格参数，计算出保证稳定性的最大允许时间步长，这是运行任何 DG 模拟都必须掌握的关键技能。", "problem": "考虑定义在周期区间上的一维无粘伯格斯方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$，该方程在一个非均匀网格 $\\{K_{j}\\}$ 上使用 $p$ 次分片多项式间断伽辽金(DG)方法进行离散，单元长度为 $h_{j}$。界面上使用的数值通量是局部Lax-Friedrichs (LLF)通量，时间推进采用显式强稳定常数保持龙格-库塔(SSPRK)方法。设单元 $K_{j}$ 上的半离散解表示为 $u_{h}|_{K_{j}} \\in \\mathbb{P}^{p}(K_{j})$。将每个单元上的LLF耗散参数定义为 $\\alpha_{j} = \\max_{x \\in K_{j}} |u_{h}(x)|$，该值由 $u_{h}$ 在 $K_{j}$ 上的节点值估计得出。\n\n从DG弱形式、分部积分能量平衡以及 $K_{j}$ 上多项式的标准一维逆不等式和迹不等式出发，推导一个仅依赖于 $(p, h_{j}, \\alpha_{j})$ 的、用于前向欧拉稳定性的充分Courant-Friedrichs-Lewy (CFL)限制条件。然后，使用此限制条件，为以下数据计算最大稳定时间步长：\n- 多项式次数：$p = 3$。\n- 显式积分器的Courant因子：$C = 0.9$。\n- 网格单元长度：$h_{1} = 0.22$，$h_{2} = 0.18$，$h_{3} = 0.25$，$h_{4} = 0.35$。\n- $u_{h}$ 的逐单元节点值（每个单元四个节点）：\n  $K_{1}$: $\\{0.8,\\ 1.1,\\ -0.9,\\ 0.5\\}$，\n  $K_{2}$: $\\{0.2,\\ -0.4,\\ 0.6,\\ -0.3\\}$，\n  $K_{3}$: $\\{-1.2,\\ -0.7,\\ -0.5,\\ -0.9\\}$，\n  $K_{4}$: $\\{0.05,\\ 0.15,\\ -0.1,\\ 0.2\\}$。\n\n通过节点最大值来解释 $\\alpha_{j}$，即 $\\alpha_{j} = \\max_{\\text{nodes in }K_{j}} |u_{h}|$，并确定由推导出的CFL限制条件所允许的最大时间步长 $\\Delta t$。将最终数值答案四舍五入到四位有效数字，并以无量纲时间单位的单个实数形式给出。", "solution": "一维无粘伯格斯方程为：\n$$ u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0 $$\n这是一个形式为 $u_t + f(u)_x = 0$ 的非线性双曲守恒律，其通量函数为 $f(u) = \\frac{u^2}{2}$。在网格单元 $K_j$ 上，使用测试函数 $v_h \\in \\mathbb{P}^p(K_j)$ 的DG半离散化形式为：\n$$ \\frac{d}{dt}\\int_{K_j} u_h v_h \\,dx - \\int_{K_j} f(u_h) \\frac{\\partial v_h}{\\partial x} \\,dx + \\widehat{f}_{j+1/2} v_h(x_{j+1/2}^{-}) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^{+}) = 0 $$\n其中 $\\widehat{f}$ 是数值通量。这可以抽象地写成一个常微分方程组(ODEs)系统，$\\frac{d\\mathbf{u}}{dt} = \\mathcal{L}_h(\\mathbf{u})$，其中 $\\mathbf{u}$ 代表解 $u_h$ 的自由度。\n\n**第一部分：前向欧拉稳定性的CFL限制条件推导**\n\n前向欧拉格式 $\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t \\mathcal{L}_h(\\mathbf{u}^n)$ 的稳定性要求 $\\Delta t$ 受到限制，以使该格式不会放大误差。对于线性系统，这意味着对于系统矩阵的所有特征值 $\\lambda$，$\\Delta t \\lambda$ 都必须位于前向欧拉方法的稳定区域内。对于非线性系统，需要分析空间算子的雅可比矩阵 $J = \\frac{\\partial \\mathcal{L}_h}{\\partial \\mathbf{u}}$。稳定性要求 $\\Delta t \\rho(J) \\le 1$，其中 $\\rho(J)$ 是雅可比矩阵的谱半径。\n\n对DG算子雅可比矩阵谱半径的严格推导在技术上非常复杂。本问题要求基于“分部积分能量平衡以及标准一维逆不等式和迹不等式”进行推导。这指向一种用于估计算子范数量级的标准论证，而算子范数又可以界定谱半径。\n\n1.  **线性化：** 雅可比分析涉及在局部状态附近对该方程进行线性化。相关的波速由通量函数的导数 $f'(u) = u$ 给出。单元 $K_j$ 上的稳定性取决于该单元上的最大波速，即 $\\alpha_j = \\max_{x \\in K_j} |u_h(x)|$。数值通量是局部Lax-Friedrichs (LLF)通量，对于线性化问题 $u_t + a u_x = 0$（其中 $|a| \\le \\alpha_j$），它使用的耗散参数必须至少为 $|a|$。给定的 $\\alpha_j$ 定义与此一致。\n\n2.  **算子范数估计：** 空间算子 $\\mathcal{L}_h$ 包括一个积分项和边界通量项。使用逆不等式和迹不等式，可以界定算子的范数。\n    - 内部积分项 $\\int_{K_j} f(u_h) v_h' \\,dx$，在线性化后包含一个类似 $\\alpha_j \\int_{K_j} u_h v_h' \\,dx$ 的项。这部分的范数可以使用逆不等式 $\\|v_h'\\|_{L^2(K_j)} \\le C \\frac{p^2}{h_j} \\|v_h\\|_{L^2(K_j)}$ 来界定。\n    - 边界通量项涉及单元端点处的 $u_h$ 和 $v_h$ 的值。它们的贡献可以使用迹不等式来界定，例如 $\\|v_h\\|_{L^2(\\partial K_j)} \\le C \\sqrt{p/h_j}\\|v_h\\|_{L^2(K_j)}$。\n    - 结合这些界限的详细分析表明，对于一维对流问题，DG空间算子的谱半径尺度为 $\\rho(J) \\sim \\frac{\\alpha_j}{h_j} \\times (\\text{p的多项式})$。\n\n3.  **标准CFL条件：** 对于应用于双曲守恒律的DG方法，一个广泛建立的、使用迎风通量或其他单调通量的稳定性充分条件由下式给出：\n    $$ \\Delta t \\le \\frac{h_j}{\\alpha_j (2p+1)} $$\n    这个结果源于对DG算子特征值的更精确分析，对于带迎风通量的一维问题，其特征值被界定为 $\\rho(J) \\approx \\frac{\\alpha_j(2p+1)}{h_j}$。LLF通量由于其构造方式（为所有波分量增加耗散），通常比迎风通量更具耗散性。因此，一个对迎风通量充分的稳定性条件通常也对LLF通量充分。因此，我们采用这个条件作为前向欧拉稳定性所需的充分CFL限制。\n\n**第二部分：最大稳定时间步长的计算**\n\n推导出的条件必须对网格中的所有单元都成立。此外，问题指定了一个Courant因子为 $C = 0.9$ 的SSPRK方法。这个系数扩展了前向欧拉方法的稳定区域。因此，全局时间步长 $\\Delta t$ 受到最严格单元的限制：\n$$ \\Delta t \\le C \\times \\min_{j} \\left( \\frac{h_j}{\\alpha_j (2p+1)} \\right) = \\frac{C}{2p+1} \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) $$\n\n我们已知以下数据：\n- 多项式次数：$p = 3$。这得到 $2p+1 = 2(3)+1 = 7$。\n- 积分器Courant因子：$C = 0.9$。\n- 网格单元长度和节点值。\n\n现在我们为每个单元 $K_j$ 计算比率 $\\frac{h_j}{\\alpha_j}$。参数 $\\alpha_j$ 是单元 $K_j$ 上节点解值的最大绝对值。\n\n- **单元 $K_1$**:\n  - 节点值：$\\{0.8, 1.1, -0.9, 0.5\\}$\n  - $\\alpha_1 = \\max(|0.8|, |1.1|, |-0.9|, |0.5|) = 1.1$\n  - $h_1 = 0.22$\n  - 比率：$\\frac{h_1}{\\alpha_1} = \\frac{0.22}{1.1} = 0.2$\n\n- **单元 $K_2$**:\n  - 节点值：$\\{0.2, -0.4, 0.6, -0.3\\}$\n  - $\\alpha_2 = \\max(|0.2|, |-0.4|, |0.6|, |-0.3|) = 0.6$\n  - $h_2 = 0.18$\n  - 比率：$\\frac{h_2}{\\alpha_2} = \\frac{0.18}{0.6} = 0.3$\n\n- **单元 $K_3$**:\n  - 节点值：$\\{-1.2, -0.7, -0.5, -0.9\\}$\n  - $\\alpha_3 = \\max(|-1.2|, |-0.7|, |-0.5|, |-0.9|) = 1.2$\n  - $h_3 = 0.25$\n  - 比率：$\\frac{h_3}{\\alpha_3} = \\frac{0.25}{1.2} = \\frac{25}{120} = \\frac{5}{24} \\approx 0.20833$\n\n- **单元 $K_4$**:\n  - 节点值：$\\{0.05, 0.15, -0.1, 0.2\\}$\n  - $\\alpha_4 = \\max(|0.05|, |0.15|, |-0.1|, |0.2|) = 0.2$\n  - $h_4 = 0.35$\n  - 比率：$\\frac{h_4}{\\alpha_4} = \\frac{0.35}{0.2} = 1.75$\n\n接下来，我们找到这些比率的最小值：\n$$ \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) = \\min(0.2, 0.3, 0.20833..., 1.75) = 0.2 $$\n限制性最强的单元是 $K_1$。\n\n最后，我们计算最大允许时间步长 $\\Delta t$：\n$$ \\Delta t = \\frac{C}{2p+1} \\times \\min_{j} \\left( \\frac{h_j}{\\alpha_j} \\right) = \\frac{0.9}{7} \\times 0.2 = \\frac{0.18}{7} \\approx 0.02571428... $$\n\n将结果四舍五入到四位有效数字，得到 $0.02571$。", "answer": "$$\n\\boxed{0.02571}\n$$", "id": "3378391"}]}