{"hands_on_practices": [{"introduction": "本章节的第一个练习是一个基础计算，旨在帮助你熟悉三种主要内部罚方法（对称Symmetric, 非对称Nonsymmetric, 和不完全Incomplete）的代数结构。通过在一个简单的一维环境中，针对给定的试探函数和检验函数计算跳跃项、平均项以及参数 $\\theta$ 的作用，你将巩固对这些方法核心差异的理解。这项练习对于掌握内部罚方法的本质至关重要。[@problem_id:3422664]", "problem": "考虑在区域 $\\Omega = [0,1]$ 上，带有齐次诺伊曼边界条件的一维泊松方程，该方程通过间断伽辽金（DG）方法进行离散化，使用包含两个单元 $K_{1} = [0,\\tfrac{1}{2}]$ 和 $K_{2} = [\\tfrac{1}{2},1]$ 的均匀网格。设每个单元上的多项式次数为一，并将试探函数 $u_{h}$ 和检验函数 $v_{h}$ 定义为\n$$\nu_{h}(x) = \\begin{cases}\nx  \\text{for } x \\in K_{1}, \\\\\n0  \\text{for } x \\in K_{2},\n\\end{cases}\n\\qquad\nv_{h}(x) = \\begin{cases}\n1  \\text{for } x \\in K_{1}, \\\\\nx  \\text{for } x \\in K_{2}.\n\\end{cases}\n$$\n设 $K_{1}$ 在 $x=\\tfrac{1}{2}$ 处的单位外法向量为 $n^{-}=+1$，$K_{2}$ 在 $x=\\tfrac{1}{2}$ 处的单位外法向量为 $n^{+}=-1$。对于标量函数 $w$，在内部面 $e=\\{ \\tfrac{1}{2} \\}$ 上，定义其跳跃为 $[w] = w^{-} - w^{+}$，法向导数的平均值定义为\n$$\n\\{ \\partial_{n} w \\} = \\frac{ \\nabla w^{-} \\cdot n^{-} + \\nabla w^{+} \\cdot n^{+} }{2}.\n$$\n从单元分部积分和数值通量的定义出发，推导内部罚 DG 双线性形式\n$$\na_{\\theta}(u_{h},v_{h}) = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx \\;-\\; \\sum_{e} \\left( \\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}] \\right) \\;+\\; \\sum_{e} \\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}],\n$$\n其中对 $e$ 的求和遍历所有内部面，$h_{e}$ 是局部面尺寸，定义为相邻单元尺寸的调和平均值（对于给定网格，其值为 $h_{e} = \\tfrac{1}{2}$），$\\sigma$ 是一个正常数罚参数。在这种一维情况下，将面积分解释为在面点处的求值。通过如下选择 $\\theta$ 可以得到三种经典的内部罚变体：对称内部罚伽辽金（SIPG）对应 $\\theta=1$，非对称内部罚伽辽金（NIPG）对应 $\\theta=-1$，以及不完全内部罚伽辽金（IIPG）对应 $\\theta=0$。\n\n使用上述定义和选择，对罚参数 $\\sigma = 3$ 和 $h_{e} = \\tfrac{1}{2}$，计算线性组合\n$$\nL \\;=\\; a_{\\text{SIPG}}(u_{h},v_{h}) \\;+\\; 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) \\;+\\; 3\\,a_{\\text{IIPG}}(u_{h},v_{h}),\n$$\n其中 $a_{\\text{SIPG}}$、$a_{\\text{NIPG}}$ 和 $a_{\\text{IIPG}}$ 分别表示在 $\\theta=1$、$\\theta=-1$ 和 $\\theta=0$ 时计算的 $a_{\\theta}$。将你的最终答案精确地表示为一个有理数。", "solution": "我们的目标是计算线性组合 $L = a_{\\text{SIPG}}(u_{h},v_{h}) + 2\\,a_{\\text{NIPG}}(u_{h},v_{h}) + 3\\,a_{\\text{IIPG}}(u_{h},v_{h})$。\n首先，我们计算通用的双线性形式 $a_{\\theta}(u_{h},v_{h})$ 的各个分量。\n\n**1. 计算界面处的函数值和导数**\n内部面位于 $x=\\frac{1}{2}$。我们计算函数 $u_h, v_h$ 及其梯度 $\\nabla u_h, \\nabla v_h$ 在 $K_1 = [0, \\frac{1}{2}]$ 和 $K_2 = [\\frac{1}{2}, 1]$ 上的表达式：\n- 在 $K_1$ 上，$u_h(x)=x$，$\\nabla u_h=1$。$v_h(x)=1$，$\\nabla v_h=0$。\n- 在 $K_2$ 上，$u_h(x)=0$，$\\nabla u_h=0$。$v_h(x)=x$，$\\nabla v_h=1$。\n\n在界面 $x=\\frac{1}{2}$ 处，来自左侧（$K_1$）的迹记为 $w^{-}$，来自右侧（$K_2$）的迹记为 $w^{+}$：\n- $u_h^{-} = \\frac{1}{2}$, $u_h^{+} = 0$\n- $v_h^{-} = 1$, $v_h^{+} = \\frac{1}{2}$\n- $\\nabla u_h^{-} = 1$, $\\nabla u_h^{+} = 0$\n- $\\nabla v_h^{-} = 0$, $\\nabla v_h^{+} = 1$\n\n**2. 计算跳跃和平均值**\n使用给定的外法向量 $n^{-}=+1$ 和 $n^{+}=-1$，我们计算跳跃和平均值：\n- **跳跃**:\n  - $[u_h] = u_h^{-} - u_h^{+} = \\frac{1}{2} - 0 = \\frac{1}{2}$\n  - $[v_h] = v_h^{-} - v_h^{+} = 1 - \\frac{1}{2} = \\frac{1}{2}$\n- **平均值**:\n  - $\\{ \\partial_{n} u_{h} \\} = \\frac{ \\nabla u_{h}^{-} \\cdot n^{-} + \\nabla u_{h}^{+} \\cdot n^{+} }{2} = \\frac{(1)(1) + (0)(-1)}{2} = \\frac{1}{2}$\n  - $\\{ \\partial_{n} v_{h} \\} = \\frac{ \\nabla v_{h}^{-} \\cdot n^{-} + \\nabla v_{h}^{+} \\cdot n^{+} }{2} = \\frac{(0)(1) + (1)(-1)}{2} = -\\frac{1}{2}$\n\n**3. 计算 $a_{\\theta}(u_{h},v_{h})$ 的各项**\n双线性形式由三部分组成：\n- **体积分项**: $\\sum_{K} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\, dx = \\int_{K_1} (1)(0) dx + \\int_{K_2} (0)(1) dx = 0$。\n- **通量项**: 在唯一的内部面 $e=\\{\\frac{1}{2}\\}$ 上求值：\n  $$ - \\left( \\{ \\partial_{n} u_{h} \\} [v_{h}] + \\theta \\, \\{ \\partial_{n} v_{h} \\} [u_{h}] \\right) = - \\left( \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\theta \\left(-\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) \\right) = - \\left(\\frac{1}{4} - \\frac{\\theta}{4}\\right) = \\frac{\\theta - 1}{4} $$\n- **罚项**: 使用 $\\sigma = 3$ 和 $h_e=\\frac{1}{2}$：\n  $$ \\frac{\\sigma}{h_{e}} \\, [u_{h}] [v_{h}] = \\frac{3}{1/2} \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 6 \\cdot \\frac{1}{4} = \\frac{3}{2} $$\n合并所有项，我们得到 $a_{\\theta}(u_{h},v_{h})$ 的表达式：\n$$ a_{\\theta}(u_{h},v_{h}) = 0 + \\frac{\\theta-1}{4} + \\frac{3}{2} $$\n\n**4. 计算 $a_{\\text{SIPG}}$, $a_{\\text{NIPG}}$, 和 $a_{\\text{IIPG}}$**\n- **SIPG ($\\theta=1$)**: $a_{\\text{SIPG}}(u_{h},v_{h}) = \\frac{1-1}{4} + \\frac{3}{2} = \\frac{3}{2}$。\n- **NIPG ($\\theta=-1$)**: $a_{\\text{NIPG}}(u_{h},v_{h}) = \\frac{-1-1}{4} + \\frac{3}{2} = -\\frac{2}{4} + \\frac{3}{2} = -\\frac{1}{2} + \\frac{3}{2} = 1$。\n- **IIPG ($\\theta=0$)**: $a_{\\text{IIPG}}(u_{h},v_{h}) = \\frac{0-1}{4} + \\frac{3}{2} = -\\frac{1}{4} + \\frac{6}{4} = \\frac{5}{4}$。\n\n**5. 计算最终的线性组合 $L$**\n$$ L = a_{\\text{SIPG}} + 2\\,a_{\\text{NIPG}} + 3\\,a_{\\text{IIPG}} = \\frac{3}{2} + 2(1) + 3\\left(\\frac{5}{4}\\right) = \\frac{3}{2} + 2 + \\frac{15}{4} $$\n$$ L = \\frac{6}{4} + \\frac{8}{4} + \\frac{15}{4} = \\frac{6+8+15}{4} = \\frac{29}{4} $$", "answer": "$$\\boxed{\\frac{29}{4}}$$", "id": "3422664"}, {"introduction": "在练习了双线性形式之后，下一个练习将重点转移到线性系统的右侧：载荷向量。该练习旨在处理一个实际任务：如何整合非齐次狄利克雷（Dirichlet）边界条件。通过在边界上应用对称内部罚(SIPG)公式，你可以亲身体验间断伽辽金方法如何通过边界通量自然地处理狄利克雷数据，这与连续伽辽金方法有显著不同。[@problem_id:3422733]", "problem": "考虑一个一维域上的带有非齐次 Dirichlet 边界条件的稳态扩散问题：求一个足够光滑的函数 $u$，使得\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = g_L, \\quad u(1) = g_R,\n$$\n其中 $f$ 是给定的源项，$g_L, g_R$ 是指定的边界数据。用 $N \\geq 2$ 个大小为 $h=1/N$ 的仿射单元组成的均匀网格对 $(0,1)$ 进行离散化。在每个单元上，使用一个次数为 $p=2$ 的多项式空间，该空间由参考单元 $[-1,1]$ 上的三个 Gauss–Legendre 求积节点（即 $\\xi_1 = -\\sqrt{3/5}$、$\\xi_2 = 0$、$\\xi_3 = \\sqrt{3/5}$）以及相关的 Lagrange 基函数 $\\{\\ell_i(\\xi)\\}_{i=1}^3$ 所给出的节点基来表示。对扩散系数为常数 $1$ 的扩散问题，采用对称内部罚 Galerkin (SIPG) 格式，罚参数为 $\\sigma > 0$，并使用边界点处的标准单位外法向量（$n(0) = -1$，$n(1) = +1$）。\n\n从通过逐单元分部积分和数值通量定义的间断 Galerkin 方法出发，推导分别在第一个和最后一个单元上，仅由非齐次 Dirichlet 边界数据 $g_L$ 和 $g_R$ 产生的对局部载荷向量的显式边界贡献。假设：\n- 从参考坐标 $\\xi \\in [-1,1]$ 到边界单元 $K$ 的映射是仿射的，$x = x_K + \\frac{h}{2}\\,\\xi$，因此 $\\frac{d\\xi}{dx} = \\frac{2}{h}$，\n- 只需要边界项（忽略体源项 $f$ 和所有内部面的贡献），\n- 在边界面 $\\partial K \\cap \\partial\\Omega$ 上的 SIPG 线性泛函贡献为\n$$\n\\int_{\\partial K \\cap \\partial\\Omega} \\left( \\partial_n v_h \\, g + \\frac{\\sigma}{h} \\, g\\, v_h \\right) \\, ds,\n$$\n其中 $v_h$ 是一个局部测试函数，且 $\\partial_n v_h = n\\, \\frac{dv_h}{dx}$。\n\n令 $g(0) = g_L$ 且 $g(1) = g_R$。在每个边界单元（最左侧和最右侧的单元）上使用上述节点基，计算由 $x=0$ 处的边界数据贡献的局部载荷向量的三个分量，以及由 $x=1$ 处的边界数据贡献的三个分量。你的最终答案需要用 $g_L$、$g_R$、$h$、$\\sigma$ 和 $\\sqrt{3/5}$ 以闭合形式表示，并按以下顺序排列：\n$$\n\\bigl[\\, \\text{左单元分量 }1,\\ \\text{左单元分量 }2,\\ \\text{左单元分量 }3,\\ \\text{右单元分量 }1,\\ \\text{右单元分量 }2,\\ \\text{右单元分量 }3 \\,\\bigr].\n$$\n按规定格式将你的答案作为一个单行向量提供。不需要进行数值舍入。", "solution": "我们的目标是计算由 Dirichlet 边界数据 $g_L$ 和 $g_R$ 产生的局部载荷向量分量。载荷向量的第 $i$ 个分量 $b_i$ 由测试函数为第 $i$ 个基函数 $\\phi_i$ 时的线性泛函 $L(\\phi_i)$ 给出。我们只关心边界贡献。\n\n**1. 一般公式**\n给定边界贡献的线性泛函为 $L_{\\partial}(v_h) = \\int_{\\partial K \\cap \\partial\\Omega} \\left( \\partial_n v_h \\, g + \\frac{\\sigma}{h} \\, g\\, v_h \\right) \\, ds$。在一维中，这简化为在边界点处的求值。\n- 在左边界 $x=0$（最左侧单元 $K_1$）：$n(0)=-1$，$g=g_L$。$x=0$ 对应参考坐标 $\\xi=-1$。\n  $$ b_{1,i} = \\left. g_L \\left( n(0) \\frac{d\\phi_i}{dx} + \\frac{\\sigma}{h} \\phi_i \\right) \\right|_{x=0} = g_L \\left( - \\frac{d\\phi_i}{dx}(0) + \\frac{\\sigma}{h} \\phi_i(0) \\right) $$\n- 在右边界 $x=1$（最右侧单元 $K_N$）：$n(1)=+1$，$g=g_R$。$x=1$ 对应参考坐标 $\\xi=+1$。\n  $$ b_{N,i} = \\left. g_R \\left( n(1) \\frac{d\\phi_i}{dx} + \\frac{\\sigma}{h} \\phi_i \\right) \\right|_{x=1} = g_R \\left( \\frac{d\\phi_i}{dx}(1) + \\frac{\\sigma}{h} \\phi_i(1) \\right) $$\n使用链式法则，$\\frac{d\\phi_i}{dx} = \\frac{d\\ell_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{2}{h} \\frac{d\\ell_i}{d\\xi}$。将此代入，我们得到：\n$$ b_{1,i} = \\frac{g_L}{h} \\left( -2 \\frac{d\\ell_i}{d\\xi}(-1) + \\sigma \\ell_i(-1) \\right) \\quad \\text{和} \\quad b_{N,i} = \\frac{g_R}{h} \\left( 2 \\frac{d\\ell_i}{d\\xi}(1) + \\sigma \\ell_i(1) \\right) $$\n\n**2. 基函数及其导数**\n与节点 $\\xi_1=-\\sqrt{3/5}, \\xi_2=0, \\xi_3=\\sqrt{3/5}$ 相关的次数为 2 的 Lagrange 基函数及其导数为：\n- $\\ell_1(\\xi) = \\frac{5}{6}(\\xi^2 - \\xi\\sqrt{3/5}) \\implies \\frac{d\\ell_1}{d\\xi} = \\frac{5}{6}(2\\xi - \\sqrt{3/5})$\n- $\\ell_2(\\xi) = 1 - \\frac{5}{3}\\xi^2 \\implies \\frac{d\\ell_2}{d\\xi} = -\\frac{10}{3}\\xi$\n- $\\ell_3(\\xi) = \\frac{5}{6}(\\xi^2 + \\xi\\sqrt{3/5}) \\implies \\frac{d\\ell_3}{d\\xi} = \\frac{5}{6}(2\\xi + \\sqrt{3/5})$\n\n**3. 在边界点求值**\n- 在 $\\xi = -1$ (左边界):\n  - $\\ell_1(-1) = \\frac{5}{6}(1+\\sqrt{3/5})$, $\\ell_2(-1) = -2/3$, $\\ell_3(-1) = \\frac{5}{6}(1-\\sqrt{3/5})$\n  - $\\frac{d\\ell_1}{d\\xi}(-1) = \\frac{5}{6}(-2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(-1) = 10/3$, $\\frac{d\\ell_3}{d\\xi}(-1) = \\frac{5}{6}(-2+\\sqrt{3/5})$\n- 在 $\\xi = 1$ (右边界):\n  - $\\ell_1(1) = \\frac{5}{6}(1-\\sqrt{3/5})$, $\\ell_2(1) = -2/3$, $\\ell_3(1) = \\frac{5}{6}(1+\\sqrt{3/5})$\n  - $\\frac{d\\ell_1}{d\\xi}(1) = \\frac{5}{6}(2-\\sqrt{3/5})$, $\\frac{d\\ell_2}{d\\xi}(1) = -10/3$, $\\frac{d\\ell_3}{d\\xi}(1) = \\frac{5}{6}(2+\\sqrt{3/5})$\n\n**4. 计算载荷向量分量**\n- **左单元 ($K_1$)**:\n  - $b_{1,1} = \\frac{g_L}{h} \\left( -2 \\frac{5}{6}(-2-\\sqrt{3/5}) + \\sigma \\frac{5}{6}(1+\\sqrt{3/5}) \\right) = \\frac{5g_L}{6h} \\left( (4+2\\sqrt{3/5}) + \\sigma(1+\\sqrt{3/5}) \\right) = \\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{3/5} \\right)$\n  - $b_{1,2} = \\frac{g_L}{h} \\left( -2 \\cdot \\frac{10}{3} + \\sigma (-\\frac{2}{3}) \\right) = -\\frac{2g_L}{3h}(10+\\sigma)$\n  - $b_{1,3} = \\frac{g_L}{h} \\left( -2 \\frac{5}{6}(-2+\\sqrt{3/5}) + \\sigma \\frac{5}{6}(1-\\sqrt{3/5}) \\right) = \\frac{5g_L}{6h} \\left( (4-2\\sqrt{3/5}) + \\sigma(1-\\sqrt{3/5}) \\right) = \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{3/5} \\right)$\n- **右单元 ($K_N$)**:\n  - $b_{N,1} = \\frac{g_R}{h} \\left( 2 \\frac{5}{6}(2-\\sqrt{3/5}) + \\sigma \\frac{5}{6}(1-\\sqrt{3/5}) \\right) = \\frac{5g_R}{6h} \\left( (4-2\\sqrt{3/5}) + \\sigma(1-\\sqrt{3/5}) \\right) = \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{3/5} \\right)$\n  - $b_{N,2} = \\frac{g_R}{h} \\left( 2 (-\\frac{10}{3}) + \\sigma (-\\frac{2}{3}) \\right) = -\\frac{2g_R}{3h}(10+\\sigma)$\n  - $b_{N,3} = \\frac{g_R}{h} \\left( 2 \\frac{5}{6}(2+\\sqrt{3/5}) + \\sigma \\frac{5}{6}(1+\\sqrt{3/5}) \\right) = \\frac{5g_R}{6h} \\left( (4+2\\sqrt{3/5}) + \\sigma(1+\\sqrt{3/5}) \\right) = \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{3/5} \\right)$", "answer": "$$ \\boxed{ \\left[ \\frac{5g_L}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), -\\frac{2g_L}{3h} (10+\\sigma), \\frac{5g_L}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), \\frac{5g_R}{6h} \\left( (4+\\sigma) - (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right), -\\frac{2g_R}{3h} (10+\\sigma), \\frac{5g_R}{6h} \\left( (4+\\sigma) + (2+\\sigma)\\sqrt{\\frac{3}{5}} \\right) \\right] } $$", "id": "3422733"}, {"introduction": "最后的练习深入探讨了支持间断伽辽金方法特定形式的理论基础。它通过引入一个在法向量方向定义上“朴素”的跳跃算子，要求你量化由此产生的一致性误差。通过为非对称内部罚(NIPG)方法计算“伴随一致性缺陷”，你将证明对算子定义的看似微小的修改可能会破坏数值格式的基本性质，从而加深对标准、正确定向算子重要性的理解。[@problem_id:3422725]", "problem": "考虑在开放区间 $\\Omega=(0,1)$ 上的一个空间维度中的标量扩散问题，其强形式为 $-u''=f$。设网格 $\\mathcal{T}_h$ 由 $2$ 个单元 $K_1=(0,\\tfrac{1}{2})$ 和 $K_2=(\\tfrac{1}{2},1)$ 组成，唯一的内部面为 $F=\\{\\tfrac{1}{2}\\}$。对于一个函数 $v$，其在 $K_1$ 上的迹为 $v_{-}$，在 $K_2$ 上的迹为 $v_{+}$，定义有向平均和跳跃为 $\\{v'\\}=\\tfrac{1}{2}(v'_{-}+v'_{+})$ 和 $[v]=v_{-}n^{-}+v_{+}n^{+}$，其中外法向单位向量在 $K_1$ 的右边界上满足 $n^{-}=+1$，在 $K_2$ 的左边界上满足 $n^{+}=-1$。使用正确定向的模型扩散算子的非对称内部罚 Galerkin (NIPG) 双线性形式为\n$$\na_{\\mathrm{NIPG}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]\\,\\mathrm{d}s+\\int_{F}\\{w'\\}\\,[u]\\,\\mathrm{d}s+\\int_{F}\\frac{\\eta}{h_F}[u][w]\\,\\mathrm{d}s,\n$$\n其中罚参数为 $\\eta>0$，面尺寸为 $h_F$。在精确解一致性检验中，当 $u$ 在 $F$ 上足够光滑时，有 $[u]=0$，因此最后两项消失。\n\n现在，将有向跳跃替换为一个忽略外法向符号并将两个法向量都设为 $+1$ 的朴素选择，即\n$$\n[w]_{\\mathrm{naive}}=w_{-}+w_{+}.\n$$\n保持上述的有向平均 $\\{u'\\}$，并将朴素的 NIPG 双线性形式定义为\n$$\na_{\\mathrm{naive}}(u,w)=\\sum_{K\\in\\mathcal{T}_h}\\int_{K}u'(x)w'(x)\\,\\mathrm{d}x-\\int_{F}\\{u'\\}\\,[w]_{\\mathrm{naive}}\\,\\mathrm{d}s.\n$$\n\n令 $u(x)=x-x^{3}$，因此 $f(x)=-u''(x)=6x$，并选择测试函数 $w(x)=x(1-x)$。$u$ 和 $w$ 在 $\\Omega$ 上均为 $C^{\\infty}$，并且 $w(0)=w(1)=0$。定义伴随一致性缺陷\n$$\nD(u,w)=a_{\\mathrm{naive}}(u,w)-\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x.\n$$\n为此双单元网格精确计算 $D(u,w)$。您的最终答案必须是一个实数。不需要四舍五入。", "solution": "该问题要求计算伴随一致性缺陷 $D(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x$。我们将分步计算等式右侧的两项。\n\n**1. 计算 $a_{\\mathrm{naive}}(u,w)$**\n朴素双线性形式为 $a_{\\mathrm{naive}}(u,w) = \\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x - \\left(\\{u'\\}\\,[w]_{\\mathrm{naive}}\\right)\\Big|_{x=\\frac{1}{2}}$。\n\n首先，我们计算导数：\n- $u(x) = x-x^3 \\implies u'(x) = 1 - 3x^2$\n- $w(x) = x-x^2 \\implies w'(x) = 1 - 2x$\n\n接下来，计算体积分项：\n$$\n\\int_{0}^{1}u'(x)w'(x)\\,\\mathrm{d}x = \\int_{0}^{1}(1-3x^2)(1-2x)\\,\\mathrm{d}x = \\int_{0}^{1}(1 - 2x - 3x^2 + 6x^3)\\,\\mathrm{d}x\n$$\n$$\n= \\left[x - x^2 - x^3 + \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(1 - 1 - 1 + \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\n\n然后，计算面项。由于函数 $u(x)$ 和 $w(x)$ 是光滑的，它们在面 $F=\\{\\frac{1}{2}\\}$ 上的迹 $u'_{-}, u'_{+}$ 和 $w_{-}, w_{+}$ 是相等的。\n- $u'(\\frac{1}{2}) = 1 - 3(\\frac{1}{2})^2 = 1 - \\frac{3}{4} = \\frac{1}{4}$。因此，$\\{u'\\} = \\frac{1}{2}(u'_{-} + u'_{+}) = \\frac{1}{2}(\\frac{1}{4} + \\frac{1}{4}) = \\frac{1}{4}$。\n- $w(\\frac{1}{2}) = \\frac{1}{2}(1-\\frac{1}{2}) = \\frac{1}{4}$。因此，$w_{-} = w_{+} = \\frac{1}{4}$。\n\n使用朴素跳跃的定义：\n$$ [w]_{\\mathrm{naive}} = w_{-} + w_{+} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}. $$\n面项为：\n$$ -\\left(\\{u'\\}\\,[w]_{\\mathrm{naive}}\\right)\\Big|_{x=\\frac{1}{2}} = -\\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{1}{8}. $$\n将体积分项和面项相加得到 $a_{\\mathrm{naive}}(u,w)$：\n$$ a_{\\mathrm{naive}}(u,w) = \\frac{1}{2} - \\frac{1}{8} = \\frac{3}{8}. $$\n\n**2. 计算 $\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x$**\n首先确定源项 $f(x)$：\n$$ u''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1-3x^2) = -6x \\implies f(x) = -u''(x) = 6x. $$\n现在计算积分：\n$$\n\\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\int_{0}^{1}(6x)(x-x^2)\\,\\mathrm{d}x = \\int_{0}^{1}(6x^2 - 6x^3)\\,\\mathrm{d}x\n$$\n$$\n= \\left[2x^3 - \\frac{3}{2}x^4\\right]_{0}^{1} = \\left(2 - \\frac{3}{2}\\right) - 0 = \\frac{1}{2}.\n$$\n\n**3. 计算伴随一致性缺陷 $D(u,w)$**\n最后，我们计算差值：\n$$ D(u,w) = a_{\\mathrm{naive}}(u,w) - \\int_{0}^{1}f(x)w(x)\\,\\mathrm{d}x = \\frac{3}{8} - \\frac{1}{2} = \\frac{3}{8} - \\frac{4}{8} = -\\frac{1}{8}. $$", "answer": "$$\n\\boxed{-\\frac{1}{8}}\n$$", "id": "3422725"}]}