{"hands_on_practices": [{"introduction": "此练习为理解函数光滑性与其傅里叶谱之间联系提供了实践基础。通过生成具有可控谱衰减的合成数据，学生将直接观察并验证傅里叶分析的核心原则之一：更光滑的函数具有更快衰减的傅里叶系数。这项动手编程任务巩固了关于三角多项式插值和谱滤波的理论 ([@problem_id:3284382])。", "problem": "要求您设计并实现一个程序，该程序根据合成周期函数的等距样本构建三角插值多项式，其中这些函数的频谱内容由一个可调的衰减参数控制。然后，该程序必须通过估计傅里叶系数的衰减率来验证平滑度，并量化频谱滤波的效果。所有角度必须以弧度为单位。\n\n将使用的基本基底和定义：\n- 一个实值的、$2\\pi$-周期函数 $f$ 可由一个从基 $\\{1, \\cos(kx), \\sin(kx)\\}$（其中 $k \\in \\mathbb{N}$）构建的三角多项式来近似。插值 $N$ 个等距样本且次数至多为 $\\lfloor (N-1)/2 \\rfloor$ 的三角插值多项式是唯一的。\n- 使用等距节点 $x_j = 2\\pi j/N$（其中 $j = 0, 1, \\dots, N-1$），复指数基 $\\{e^{\\mathrm{i}kx}\\}$ 的离散正交性确保了离散傅里叶变换系数 $c_k$ 可以被计算出来，并且原始样本可以通过逆变换精确恢复。对于实信号，频率 $k$ 处的谐波对的振幅与复系数的模相关。\n- 周期函数的平滑度反映在其傅里叶系数的衰减上；更平滑的函数表现出谐波振幅作为频率指数的函数衰减得更快。\n\n任务：\n1. 具有受控平滑度的合成数据集生成：\n   - 对于给定的整数 $N$ 和 $K$（$N \\ge 2$ 且 $1 \\le K  N$），考虑等距网格 $x_j = 2\\pi j/N$。\n   - 使用衰减参数 $p  0$ 为 $k = 1, 2, \\dots, K$ 定义系数 $a_k$ 和 $b_k$ 如下：\n     $$a_k = k^{-p} + \\Delta_a(k), \\quad b_k = s_k\\left(\\tfrac{1}{2}k^{-p} + \\Delta_b(k)\\right),$$\n     其中 $s_k = (-1)^k$，且\n     $$\\Delta_a(k) = \\begin{cases} \\delta,  k \\ge k_0 \\\\ 0,  k  k_0 \\end{cases}, \\quad \\Delta_b(k) = \\begin{cases} \\tfrac{\\delta}{2},  k \\ge k_0 \\\\ 0,  k  k_0 \\end{cases}.$$\n     系数对 $(\\Delta_a(k), \\Delta_b(k))$ 引入一个水平为 $\\delta \\ge 0$ 的高频平台，从索引 $k_0$ 开始（如果指定了 $k_0$），否则在 $\\delta = 0$ 或未提供 $k_0$ 时禁用。\n   - 构建合成周期样本\n     $$s_j = \\sum_{k=1}^{K} \\left( a_k \\cos(k x_j) + b_k \\sin(k x_j) \\right), \\quad j = 0, 1, \\dots, N-1.$$\n2. 通过离散傅里叶变换进行三角插值：\n   - 使用标准的复指数正交性在等距网格上，计算样本序列 $\\{s_j\\}$ 的离散傅里叶变换系数 $c_k$，其中 $k = 0, 1, \\dots, N-1$。\n   - 为 $k = 1, 2, \\dots, m$（其中 $m = \\lfloor N/2 \\rfloor$）定义谐波振幅包络：\n     $$A_k = \\begin{cases} 2|c_k|,  1 \\le k  m \\\\ |c_m|,  k = m \\text{ and } N \\text{ even} \\end{cases}.$$\n     当 $N$ 为偶数时，这种约定避免了对奈奎斯特频率的双重计数，并捕获了每个正弦-余弦谐波对的振幅。\n3. 通过系数衰减进行平滑度验证：\n   - 通过对 $\\log(A_k)$ 与 $\\log(k)$ 在 $A_k$ 具有数值显著性的指数范围（排除 $A_k \\le 10^{-12}$ 的值）上进行最小二乘线性回归来估计衰减率 $p_{\\mathrm{est}}$，并在 $N$ 为偶数时排除奈奎斯特指数。具体来说，拟合\n     $$\\log(A_k) \\approx \\alpha - p_{\\mathrm{est}} \\log(k).$$\n4. 频谱滤波与误差量化：\n   - 对于给定的截止频率 $M_{\\mathrm{cut}}$（$1 \\le M_{\\mathrm{cut}} \\le m$），通过将所有满足 $k > M_{\\mathrm{cut}}$ 和 $k  N - M_{\\mathrm{cut}}$ 的离散傅里叶系数 $\\{c_k\\}$ 置零，然后应用离散傅里叶逆变换来获得滤波后的样本 $\\{\\hat{s}_j\\}$，从而构建一个滤波后的重构。\n   - 计算最大绝对插值误差\n     $$E_{\\max} = \\max_{0 \\le j  N} | \\hat{s}_j - s_j |.$$\n   - 计算超出截止频率的尾部能量比\n     $$R_{\\mathrm{tail}} = \\frac{ \\sum_{k = M_{\\mathrm{cut}}+1}^{m} A_k^2 }{ \\sum_{k = 1}^{m} A_k^2 }.$$\n5. 验证逻辑：\n   - 通过/失败标准结合了衰减估计和尾部能量行为：\n     - 如果测试用例指定没有平台（即期望一个衰减谱），则当 $|p_{\\mathrm{est}} - p| \\le \\tau_p$ 且 $R_{\\mathrm{tail}}  \\rho$ 时声明通过。\n     - 如果测试用例指定有平台（即期望非衰减的高频内容），则当 $R_{\\mathrm{tail}} \\ge \\rho$ 时声明通过。在这种平台情况下，对 $p_{\\mathrm{est}}$ 不施加任何条件。\n\n测试：\n提供以下测试套件，每个测试用例由一个元组 $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau})$ 定义：\n- 用例 1（理想路径，平滑衰减）：$(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (128, 30, 2.5, 20, \\text{none}, 0.0, 0.1, 0.05, \\text{False})$。\n- 用例 2（较小 $N$ 的边界情况）：$(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (32, 10, 1.0, 8, \\text{none}, 0.0, 0.2, 0.05, \\text{False})$。\n- 用例 3（带有高频平台的边缘情况）：$(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau}) = (256, 60, 2.0, 30, 40, 0.1, 0.2, 0.1, \\text{True})$。\n\n最终输出规范：\n- 对于每个测试用例，生成一个子列表 $[p_{\\mathrm{est}}, E_{\\max}, R_{\\mathrm{tail}}, \\text{pass}]$，其中 $p_{\\mathrm{est}}$、$E_{\\max}$ 和 $R_{\\mathrm{tail}}$ 是四舍五入到六位小数的浮点数，$\\text{pass}$ 为 $\\text{True}$ 或 $\\text{False}$。\n- 您的程序应生成单行输出，其中包含这些子列表的结果，以逗号分隔，并用方括号括起来，不含空格。例如，三个测试用例的输出必须类似于 $[[p_1,E_1,R_1,\\text{True}],[p_2,E_2,R_2,\\text{False}],[p_3,E_3,R_3,\\text{True}]]$，所有浮点数显示到六位小数。", "solution": "用户提供的问题被评估为 **有效**，因为它科学地基于傅里叶分析和数值方法的原理，问题定义明确，并提供了一套完整、一致且可形式化的指令。该问题要求实现一个涉及三角插值、频谱分析和滤波的数值过程，这是科学计算中的一个标准课题。所有提供的定义、公式和测试用例都是一致的，并允许开发出唯一、可验证的解决方案。\n\n该解答通过为每个测试用例实现指定的步骤来进行。\n\n**1. 合成数据集生成**\n对于每个测试用例，我们都给定参数 $(N, K, p, M_{\\mathrm{cut}}, k_0, \\delta, \\tau_p, \\rho, \\text{expect\\_plateau})$。我们首先在 $N$ 个点的等距网格 $x_j = \\frac{2\\pi j}{N}$（其中 $j=0, \\dots, N-1$）上构建信号 $s_j$。该信号是 $K$ 个谐波的总和：\n$$s_j = \\sum_{k=1}^{K} \\left( a_k \\cos(k x_j) + b_k \\sin(k x_j) \\right)$$\n系数 $a_k$ 和 $b_k$ 被定义为模拟一个带有潜在高频平台的幂律谱衰减：\n$$a_k = k^{-p} + \\Delta_a(k), \\quad b_k = (-1)^k\\left(\\tfrac{1}{2}k^{-p} + \\Delta_b(k)\\right)$$\n平台项 $\\Delta_a(k)$ 和 $\\Delta_b(k)$ 仅在提供了起始索引 $k_0$ 且 $\\delta  0$ 时非零。具体来说，当 $k \\ge k_0$ 时，$\\Delta_a(k) = \\delta$ 且 $\\Delta_b(k) = \\frac{\\delta}{2}$，否则为零。这种构造可以使用向量化的 NumPy 操作高效实现。\n\n**2. 离散傅里叶变换和谐波振幅**\n三角插值多项式是通过计算样本 $\\{s_j\\}$ 的离散傅里叶变换（DFT）来隐式求得的。DFT系数，我们记为 $C_k^{\\text{unnorm}} = \\sum_{j=0}^{N-1} s_j e^{-i k x_j}$，是使用 `numpy.fft.fft` 计算的。为了理论上的一致性，这些系数被归一化以获得 $c_k = \\frac{1}{N} C_k^{\\text{unnorm}}$。\n对于实值信号，第 $k$ 个谐波的振幅与 $c_k$ 的模相关。谐波振幅包络 $A_k$ 是为正频率 $k=1, \\dots, m$ 定义的，其中 $m = \\lfloor N/2 \\rfloor$。由于所有测试用例都使用偶数 $N$，因此 $m=N/2$。定义如下：\n$$A_k = \\begin{cases} 2|c_k|,  1 \\le k  m \\\\ |c_m|,  k = m \\end{cases}$$\n因子 $2$ 解释了来自正频率（$k$）和负频率（$-k \\equiv N-k$）分量的能量，它们是复共轭的。奈奎斯特频率分量（$k=m$）在唯一频率范围内没有共轭对应项，因此被单独处理。由于输入信号没有直流分量（$s(x)$ 在一个周期内积分为零），所以 $c_0=0$。\n一个关键的理论见解是，对于一个如上构造且 $K  N/2$ 的信号，不存在混叠，并且从样本计算出的振幅 $A_k$ 应与生成系数直接相关：对于 $k \\le K$，$A_k \\approx \\sqrt{a_k^2 + b_k^2}$，而对于 $k  K$，$A_k \\approx 0$。\n\n**3. 通过衰减率估计进行平滑度验证**\n潜在连续函数的光滑度与其傅里叶系数衰减的速度有关。我们通过对振幅的对数拟合一个线性模型来估计衰减指数 $p$：\n$$\\log(A_k) \\approx \\alpha - p_{\\mathrm{est}} \\log(k)$$\n这是一个 $y = \\log(A_k)$ 对 $x = \\log(k)$ 的线性回归。估计的衰减率 $p_{\\mathrm{est}}$ 是这条线斜率的相反数。拟合是在频率范围 $k=1, \\dots, m-1$ 上使用最小二乘法（`numpy.polyfit`）进行的。奈奎斯特频率被排除在外，这是一种标准做法，因为它的行为不同。为了避免 $\\log(0)$ 引起的数值问题，只有振幅 $A_k > 10^{-12}$ 被包含在回归中。\n\n**4. 频谱滤波和误差分析**\n为了模拟低通滤波器的效果，我们截断频谱。通过首先将所有频率指数 $k$ 满足 $M_{\\mathrm{cut}}  k  N - M_{\\mathrm{cut}}$ 的 DFT 系数 $C_k^{\\text{unnorm}}$ 置零，来重构一个滤波后的信号 $\\{\\hat{s}_j\\}$。然后，对这个修改后的频谱应用逆 DFT（`numpy.fft.ifft`）。得到的 $\\hat{s}_j$ 是使用前 $M_{\\mathrm{cut}}$ 个谐波对 $s_j$ 的最佳逼近。\n滤波误差由最大绝对误差 $E_{\\max} = \\max_{j} | \\hat{s}_j - s_j |$ 来量化。\n由滤波造成的能量损失由尾部能量比 $R_{\\mathrm{tail}}$ 来量化。根据帕塞瓦尔定理，信号域中的能量与频域中振幅平方和成正比。因此，该比率为：\n$$R_{\\mathrm{tail}} = \\frac{ \\sum_{k = M_{\\mathrm{cut}}+1}^{m} A_k^2 }{ \\sum_{k = 1}^{m} A_k^2 }$$\n这衡量了包含在截止频率 $M_{\\mathrm{cut}}$ 以上的频率中的频谱能量的比例。\n\n**5. 验证逻辑**\n最后一步是根据问题规范应用通过/失败标准：\n- 如果期望平滑衰减（`expect_plateau` 为 False），则当估计的衰减率 $p_{\\mathrm{est}}$ 接近真实率 $p$（即 $|p_{\\mathrm{est}} - p| \\le \\tau_p$）且尾部能量 $R_{\\mathrm{tail}}  \\rho$）时，测试通过。\n- 如果期望高频平台（`expect_plateau` 为 True），则当尾部能量 $R_{\\mathrm{tail}} \\ge \\rho$）时，测试通过，这表明高频分量不可忽略。\n\n计算出的值 $p_{\\mathrm{est}}$、$E_{\\max}$ 和 $R_{\\mathrm{tail}}$ 被四舍五入到六位小数，并为每个用例确定布尔型的通过/失败结果。然后将这些结果格式化为指定的字符串输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main entry point for solving the problem. It defines the test cases,\n    processes each one, and prints the formatted results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, K, p, M_cut, k0, delta, tau_p, rho, expect_plateau)\n        (128, 30, 2.5, 20, None, 0.0, 0.1, 0.05, False),\n        (32, 10, 1.0, 8, None, 0.0, 0.2, 0.05, False),\n        (256, 60, 2.0, 30, 40, 0.1, 0.2, 0.1, True),\n    ]\n\n    # This list will store the sublist strings for final concatenation.\n    results_as_strings = []\n    \n    for case in test_cases:\n        N, K, p, M_cut, k0, delta, tau_p, rho, expect_plateau = case\n        \n        # 1. Synthetic dataset generation\n        x_j = (2 * np.pi / N) * np.arange(N)\n        k_vals = np.arange(1, K + 1)\n        \n        p_decay = k_vals**(-p)\n        \n        delta_a = np.zeros(K)\n        delta_b = np.zeros(K)\n        if k0 is not None and delta > 0:\n            indices_to_modify = k_vals >= k0\n            delta_a[indices_to_modify] = delta\n            delta_b[indices_to_modify] = delta / 2.0\n            \n        a_k = p_decay + delta_a\n        s_k_sign = (-1)**k_vals\n        b_k = s_k_sign * (0.5 * p_decay + delta_b)\n        \n        outer_prod = np.outer(x_j, k_vals)\n        s_j = np.cos(outer_prod) @ a_k + np.sin(outer_prod) @ b_k\n\n        # 2. Trigonometric interpolation via DFT\n        C_k_unnormalized = np.fft.fft(s_j)\n        c_k = C_k_unnormalized / N\n        \n        m = N // 2\n        \n        # Harmonic amplitude envelope A_k for k=1..m (0-indexed array)\n        A_k = np.zeros(m)\n        if m > 1: # Handles N=2 case\n            A_k[:m-1] = 2 * np.abs(c_k[1:m])\n        A_k[m-1] = np.abs(c_k[m]) # Nyquist frequency (all test cases have even N)\n\n        # 3. Smoothness validation via coefficient decay\n        k_for_fit = np.arange(1, m)\n        A_for_fit = A_k[:m-1]\n        \n        significant_mask = A_for_fit > 1e-12\n        k_reg = k_for_fit[significant_mask]\n        \n        p_est = 0.0\n        if len(k_reg) >= 2:\n            A_reg = A_for_fit[significant_mask]\n            log_k = np.log(k_reg)\n            log_A = np.log(A_reg)\n            slope, _ = np.polyfit(log_k, log_A, 1)\n            p_est = -slope\n\n        # 4. Spectral filtering and error quantification\n        C_filtered = C_k_unnormalized.copy()\n        C_filtered[M_cut + 1 : N - M_cut] = 0.0\n        \n        s_hat_j = np.real(np.fft.ifft(C_filtered))\n        E_max = np.max(np.abs(s_hat_j - s_j))\n\n        # 5. Tail energy ratio\n        numerator = np.sum(A_k[M_cut:]**2)\n        denominator = np.sum(A_k**2)\n        R_tail = numerator / denominator if denominator > 1e-15 else 0.0\n\n        # 6. Validation logic\n        if expect_plateau:\n            is_pass = R_tail >= rho\n        else:\n            is_pass = (np.abs(p_est - p) = tau_p) and (R_tail  rho)\n        \n        # Format the sublist as a string according to requirements\n        sublist_str = f\"[{p_est:.6f},{E_max:.6f},{R_tail:.6f},{is_pass}]\"\n        results_as_strings.append(sublist_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```", "id": "3284382"}, {"introduction": "此练习是将在谱方法应用于实际场景的关键一步，因为实际场景通常涉及非均匀网格。该练习要求学生从单个周期域过渡到多单元间断伽辽金（DG）设置，推导最大可分辨的全局波数 ([@problem_id:3387856])。此实践揭示了每个单元上的局部离散化参数（例如多项式阶数 $N_e$ 和单元尺寸 $h_e$）如何共同限制模拟的全局分辨率，这是谱元和DG方法中的一个核心概念。", "problem": "考虑一个长度为 $L=2\\pi$ 的周期性域，该域被划分为 $E=3$ 个单元，其长度分别为 $h_{1}=\\frac{\\pi}{3}$、$h_{2}=\\frac{\\pi}{2}$ 和 $h_{3}=\\frac{7\\pi}{6}$，因此 $h_{1}+h_{2}+h_{3}=2\\pi$。在每个单元 $e\\in\\{1,2,3\\}$ 上，定义局部角坐标 $\\theta_{e}=2\\pi\\,(x-x_{e-1})/h_{e}\\in[0,2\\pi)$，其中 $x_{e-1}$ 是第 $e$ 个单元的左端点。局部逼近空间是复指数函数 $\\{\\exp(\\mathrm{i}j\\theta_{e})\\}_{j=-N_{e}}^{N_{e}}$ 的张成空间，即 $N_{e}$ 次三角多项式，并在 $\\theta_{e}$ 中的 $2N_{e}+1$ 个等距节点上进行插值。角度以弧度为单位。假设分片逼近是使用 Discontinuous Galerkin (DG) 方法（Discontinuous Galerkin (DG)）构建的，因此不强制要求数值在界面上连续。\n\n一个全局傅里叶模态由 $u_{k}(x)=\\exp(\\mathrm{i}k x)$ 给出，其中波数 $k$ 为整数且 $k\\geq 0$。从每个单元上的三角多项式插值的定义以及均匀网格的采样定理出发，推导全局模态 $u_{k}$ 在每个单元上都能被无混叠地表示的充分必要条件。利用此条件，建立最大可分辨全局波数 $k_{\\star}$ 的表达式，该表达式用局部次数 $N_{e}$ 和单元长度 $h_{e}$ 表示，并确保无混叠，从而在单元表示中没有界面不一致性。\n\n最后，将您的表达式应用于给定的网格和次数 $N_{1}=5$、$N_{2}=3$ 和 $N_{3}=8$，并计算满足无混叠条件的最大整数 $k_{\\star}$。提供 $k_{\\star}$ 的单一数值作为最终答案。无需四舍五入。角度以弧度为单位。", "solution": "本问题要求在 Discontinuous Galerkin (DG) 框架下，推导一个条件以确保全局傅里叶模态 $u_{k}(x) = \\exp(\\mathrm{i}k x)$ 在一个非均匀网格的每个单元上都能被无混叠地表示。该条件将导出最大可分辨全局波数 $k_{\\star}$。\n\n首先，我们必须将全局函数 $u_{k}(x)$ 表示为关于每个单元 $e$ 的局部坐标 $\\theta_{e}$ 的函数。问题将单元 $e$ 上的局部角坐标定义为 $\\theta_{e} = 2\\pi(x - x_{e-1})/h_{e}$，其中 $x_{e-1}$ 是单元的左端点，$h_e$ 是其长度。局部坐标的定义域为 $\\theta_{e} \\in [0, 2\\pi)$。我们可以反转这个关系，从而用局部坐标 $\\theta_{e}$ 表示全局坐标 $x$：\n$$\nx = x_{e-1} + \\frac{h_{e}}{2\\pi} \\theta_{e}\n$$\n将此代入全局傅里叶模态 $u_{k}(x)$ 的表达式中，我们得到它在单元 $e$ 的局部坐标系中的表示：\n$$\nu_{k}(x(\\theta_e)) = \\exp\\left(\\mathrm{i}k \\left(x_{e-1} + \\frac{h_{e}}{2\\pi} \\theta_{e}\\right)\\right) = \\exp(\\mathrm{i}k x_{e-1}) \\exp\\left(\\mathrm{i} \\frac{kh_{e}}{2\\pi} \\theta_{e}\\right)\n$$\n项 $\\exp(\\mathrm{i}k x_{e-1})$ 在单元 $e$ 上是一个常数相位因子。对局部坐标的函数依赖性完全包含在项 $\\exp(\\mathrm{i} J_{e} \\theta_{e})$ 中，其中我们将单元 $e$ 上的无量纲局部波数定义为：\n$$\nJ_{e} = \\frac{kh_{e}}{2\\pi}\n$$\n单元 $e$ 上的局部逼近空间是 $N_{e}$ 次三角多项式的空间，它是基函数 $\\{\\exp(\\mathrm{i}j\\theta_{e})\\}_{j=-N_{e}}^{N_{e}}$ 的张成空间。这个空间可以唯一地表示任何频率 $j$ 在范围 $[-N_{e}, N_{e}]$ 内的三角多项式。\n\n问题指出，逼近是通过在 $\\theta_{e}$ 中的 $2N_{e}+1$ 个等距节点上插值构建的。根据三角多项式的采样定理，如果我们在 $2N_{e}+1$ 个等距点上对函数 $f(\\theta_e) = \\exp(\\mathrm{i}J_{e}\\theta_{e})$ 进行采样，所得的三角插值函数将是原始函数的混叠版本。插值函数与原始函数完全匹配的充分必要条件是频率 $J_e$ 位于多项式空间可唯一表示的频率范围内。对于像 $[0, 2\\pi)$ 这样的半开区间和从 $-N_e$ 到 $N_e$ 索引的基，避免混叠的条件是：\n$$\n-N_{e} \\leq J_{e} \\leq N_{e}\n$$\n或者，更紧凑地写为 $|J_{e}| \\leq N_{e}$。由于全局波数 $k$ 是给定的非负整数（$k \\geq 0$）且单元长度 $h_{e}$ 为正，局部波数 $J_{e} = kh_{e}/(2\\pi)$ 也是非负的。无混叠条件简化为：\n$$\nJ_{e} \\leq N_{e}\n$$\n代入 $J_{e}$ 的定义，我们得到在单元 $e$ 上不发生混叠对全局波数 $k$ 的条件：\n$$\n\\frac{kh_{e}}{2\\pi} \\leq N_{e}\n$$\n对 $k$ 进行整理，我们得到：\n$$\nk \\leq \\frac{2\\pi N_{e}}{h_{e}}\n$$\n这个不等式给出了单个单元 $e$ 上的最大可分辨全局波数。为了使全局模态 $u_{k}(x)$ 在网格中的*每个*单元上都被无混叠地表示，这个条件必须对所有 $e \\in \\{1, 2, ..., E\\}$ 同时成立。因此，$k$ 必须小于或等于所有单元上这些上界的最小值：\n$$\nk \\leq \\min_{e \\in \\{1, \\dots, E\\}} \\left( \\frac{2\\pi N_{e}}{h_{e}} \\right)\n$$\n最大可分辨全局波数 $k_{\\star}$ 是满足此条件的最大整数 $k$。它由最小值的向下取整函数（floor function）给出：\n$$\nk_{\\star} = \\left\\lfloor \\min_{e \\in \\{1, \\dots, E\\}} \\left( \\frac{2\\pi N_{e}}{h_{e}} \\right) \\right\\rfloor\n$$\n这是 $k_{\\star}$ 的通用表达式。现在，我们将此结果应用于具有 $E=3$ 个单元和指定参数的给定网格。数据如下：\n- 单元 1: $h_{1} = \\frac{\\pi}{3}$，$N_{1} = 5$\n- 单元 2: $h_{2} = \\frac{\\pi}{2}$，$N_{2} = 3$\n- 单元 3: $h_{3} = \\frac{7\\pi}{6}$，$N_{3} = 8$\n\n我们计算每个单元的最大可分辨波数：\n对单元 1：\n$$\n\\frac{2\\pi N_{1}}{h_{1}} = \\frac{2\\pi (5)}{\\frac{\\pi}{3}} = \\frac{10\\pi}{\\frac{\\pi}{3}} = 10 \\times 3 = 30\n$$\n对单元 2：\n$$\n\\frac{2\\pi N_{2}}{h_{2}} = \\frac{2\\pi (3)}{\\frac{\\pi}{2}} = \\frac{6\\pi}{\\frac{\\pi}{2}} = 6 \\times 2 = 12\n$$\n对单元 3：\n$$\n\\frac{2\\pi N_{3}}{h_{3}} = \\frac{2\\pi (8)}{\\frac{7\\pi}{6}} = \\frac{16\\pi}{\\frac{7\\pi}{6}} = 16 \\times \\frac{6}{7} = \\frac{96}{7}\n$$\n现在我们求这三个值的最小值：\n$$\n\\min\\left(30, 12, \\frac{96}{7}\\right)\n$$\n为了比较这些值，我们注意到 $\\frac{96}{7} \\approx 13.714$。因此，最小值是 $12$。\n$$\n\\min\\left(30, 12, \\frac{96}{7}\\right) = 12\n$$\n可以在所有三个单元上无混叠地表示的最大整数波数 $k_{\\star}$ 是这个最小值的向下取整：\n$$\nk_{\\star} = \\lfloor 12 \\rfloor = 12\n$$\n因此，在每个单元上都满足无混叠条件的最大整数全局波数是 $12$。", "answer": "$$\n\\boxed{12}\n$$", "id": "3387856"}]}