{"hands_on_practices": [{"introduction": "在复杂域（如三角形）上的数值方法依赖于精确的求积。本练习 [@problem_id:3406319] 提供了一个基础性的检验：我们将首先解析计算一个简单多项式在参考三角形上的积分，然后验证一个特定的、已知的求积法则（Dunavant法则）能够重现这个精确结果。通过这种方式，我们能够确认其所声称的精确度，这一实践也加深了对解析真实值与数值近似之间联系的理解。", "problem": "在高阶谱元法和间断伽辽金 (DG) 方法中，单纯形上的数值求积法则必须能够精确计算低阶多项式的体积和面积分，以保证设计的精度阶。考虑参考三角形 $\\mathcal{T}$，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$，即 $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$。从二维积分作为 $\\mathcal{T}$ 上累次积分的基本定义出发，计算单项式 $x^{i}y^{j}$ 在 $i=1$ 和 $j=1$ 时的积分精确值，即\n$$\nI=\\int_{\\mathcal{T}} x^{1}y^{1}\\,dx\\,dy.\n$$\n然后，使用以下 Dunavant 三角形求积法则验证此精确值，该法则是为对所有总次数不超过 2 的多项式精确而设计的。该法则使用 $N_{q}=3$ 个对称点，其重心坐标 $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 由集合\n$$\n\\{( \\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3})\\}\n$$\n给出，在 $\\mathcal{T}$ 上每个点的权重均为 $w=\\tfrac{1}{6}$。使用从关于顶点 $(0,0)$、$(1,0)$、$(0,1)$ 的重心坐标到笛卡尔坐标的标准映射，即 $x=\\lambda_{2}$ 和 $y=\\lambda_{3}$，来评估求积近似值\n$$\nQ=\\sum_{q=1}^{N_{q}} w\\, x_{q}^{1} y_{q}^{1}.\n$$\n确认 $Q=I$，从而验证该求积法则对此单项式的精确阶。将 $I$ 的精确值作为最终答案。无需四舍五入，不涉及单位。您的最终答案必须是一个数字。", "solution": "该问题需要进行两部分计算。首先，我们必须求出积分 $I=\\int_{\\mathcal{T}} x^{1}y^{1}\\,dx\\,dy$ 在参考三角形 $\\mathcal{T}$ 上的精确解析值。其次，我们必须使用指定的 $3$ 点 Dunavant 求积法则计算该积分的数值近似值 $Q$，并验证 $Q=I$。最终答案是 $I$ 的精确值。\n\n参考三角形 $\\mathcal{T}$ 由其顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 定义。该区域在笛卡尔平面上对应于满足不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 的点集 $(x,y)$。\n\n首先，我们通过将积分 $I$ 表示为累次积分来计算其精确值。我们选择先对 $y$ 积分，然后对 $x$ 积分。$x$ 的积分限为从 $0$ 到 $1$。对于此区间内固定的 $x$ 值，$y$ 的范围为从 $0$ 到 $1-x$。\n$$\nI = \\int_{\\mathcal{T}} xy \\,dx\\,dy = \\int_{x=0}^{x=1} \\left( \\int_{y=0}^{y=1-x} xy \\,dy \\right) dx\n$$\n我们计算关于 $y$ 的内层积分：\n$$\n\\int_{0}^{1-x} xy \\,dy = x \\left[ \\frac{y^2}{2} \\right]_{0}^{1-x} = x \\left( \\frac{(1-x)^2}{2} - \\frac{0^2}{2} \\right) = \\frac{x(1-x)^2}{2}\n$$\n接下来，我们将此结果代入外层积分，并对 $x$ 进行积分：\n$$\nI = \\int_{0}^{1} \\frac{x(1-x)^2}{2} \\,dx\n$$\n我们展开被积函数以便于积分：\n$$\nI = \\frac{1}{2} \\int_{0}^{1} x(1 - 2x + x^2) \\,dx = \\frac{1}{2} \\int_{0}^{1} (x - 2x^2 + x^3) \\,dx\n$$\n逐项进行积分：\n$$\nI = \\frac{1}{2} \\left[ \\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4} \\right]_{0}^{1}\n$$\n在积分上下限处计算所得多项式的值：\n$$\nI = \\frac{1}{2} \\left( \\left( \\frac{1^2}{2} - \\frac{2(1)^3}{3} + \\frac{1^4}{4} \\right) - (0) \\right) = \\frac{1}{2} \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right)\n$$\n为简化括号中的表达式，我们找到一个公分母，即 $12$：\n$$\nI = \\frac{1}{2} \\left( \\frac{6}{12} - \\frac{8}{12} + \\frac{3}{12} \\right) = \\frac{1}{2} \\left( \\frac{6 - 8 + 3}{12} \\right) = \\frac{1}{2} \\left( \\frac{1}{12} \\right) = \\frac{1}{24}\n$$\n积分的精确值为 $I = \\frac{1}{24}$。\n\n其次，我们使用指定的 Dunavant 求积法则来验证此结果。该法则将积分近似为一个加权和：\n$$\nQ = \\sum_{q=1}^{N_{q}} w\\, x_{q}^{1} y_{q}^{1}\n$$\n其中点的数量为 $N_q=3$，每个点的权重为 $w=\\frac{1}{6}$。求积点以重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 给出，并且必须使用所提供的映射 $x=\\lambda_2$ 和 $y=\\lambda_3$ 转换为笛卡尔坐标 $(x_q, y_q)$。\n\n三个求积点是：\n1.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$。这映射到 $(x_1, y_1) = (\\frac{1}{6}, \\frac{1}{6})$。\n2.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$。这映射到 $(x_2, y_2) = (\\frac{2}{3}, \\frac{1}{6})$。\n3.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$。这映射到 $(x_3, y_3) = (\\frac{1}{6}, \\frac{2}{3})$。\n\n然后，我们在每个笛卡尔坐标点上计算被积函数 $f(x,y)=xy$ 的值：\n-   $f(x_1, y_1) = x_1 y_1 = (\\frac{1}{6})(\\frac{1}{6}) = \\frac{1}{36}$\n-   $f(x_2, y_2) = x_2 y_2 = (\\frac{2}{3})(\\frac{1}{6}) = \\frac{2}{18} = \\frac{1}{9}$\n-   $f(x_3, y_3) = x_3 y_3 = (\\frac{1}{6})(\\frac{2}{3}) = \\frac{2}{18} = \\frac{1}{9}$\n\n现在我们计算求积和 $Q$：\n$$\nQ = w f(x_1, y_1) + w f(x_2, y_2) + w f(x_3, y_3) = \\frac{1}{6} \\left( \\frac{1}{36} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right)\n$$\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{1}{9} + \\frac{1}{9} \\right)\n$$\n对括号中的项使用公分母 $36$：\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36} \\right) = \\frac{1}{6} \\left( \\frac{1+4+4}{36} \\right) = \\frac{1}{6} \\left( \\frac{9}{36} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\n通过求积法则计算出的值为 $Q = \\frac{1}{24}$。\n\n将精确积分值 $I=\\frac{1}{24}$ 与求积近似值 $Q=\\frac{1}{24}$ 进行比较，我们发现它们是相同的。这证实了所给的求积法则对单项式 $x^1y^1$ 是精确的，该单项式的总次数为 $1+1=2$，与问题前提中所述一致。所要求的最终答案是 $I$ 的精确值。", "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$", "id": "3406319"}, {"introduction": "在确认了求积法则的精确度概念之后，我们现在转向设计求积法则的原则。求积点的数量并非任意选择，它与我们需要精确积分的多项式次数直接相关。本练习 [@problem_id:3406258] 将深入探讨一维区间上两种核心的求积法则——高斯-勒让德 (Gauss-Legendre, GL) 和 高斯-洛巴托-勒让德 (Gauss-Lobatto-Legendre, GLL) ——的理论基础，以推导达到目标精确度所需的最小节点数。理解这种权衡对于高效和准确地实现代码至关重要。", "problem": "考虑一个定义在区间 $[-1,1]$ 上、权重函数为 $w(x)=1$ 的一维参考单元。在谱元法和间断伽辽金 (Discontinuous Galerkin, DG) 方法中，对多项式试探和检验空间上的体积分和面积分是通过数值求积来计算的。在 $[-1,1]$ 上两种广泛使用的求积法则是：使用 $N$ 个内部节点的高斯-勒让德 (Gauss–Legendre, GL) 求积法，以及使用包括端点 $x=-1$ 和 $x=1$ 在内的 $N$ 个节点的高斯-洛巴托-勒让德 (Gauss–Lobatto–Legendre, GLL) 求积法。一个求积法则的精确度是最大的整数 $r$，使得该法则能够精确地对任意次数 $\\deg(p)\\le r$ 的多项式 $p(x)$ 进行积分。\n\n从正交多项式的基本性质、其相关的高斯求积法以及多项式求积积分的经典误差表示出发，确定作为目标多项式次数 $D\\in\\mathbb{N}$ 的函数，所需的最小节点数 $N$，以满足以下条件：\n- 具有 $N$ 个节点的 GL 求积法能够精确地对任意次数 $\\deg(p)\\le D$ 的多项式 $p(x)$ 进行积分，以及\n- 具有 $N$ 个节点的 GLL 求积法能够精确地对任意次数 $\\deg(p)\\le D$ 的多项式 $p(x)$ 进行积分。\n\n然后分析比较这些最小节点数。将最终答案表示为一个行矩阵，其元素按顺序分别为 GL 求积法所需的最小 $N$ 值、GLL 求积法所需的最小 $N$ 值，以及这两个最小节点数之差。不需要数值四舍五入，也不涉及物理单位。最终答案必须是单一的闭式解析表达式。", "solution": "目标是确定高斯-勒让德 (GL) 和高斯-洛巴托-勒让德 (GLL) 求积法在区间 $[-1, 1]$ 上（权重函数 $w(x)=1$）精确地对任意次数至多为 $D$（其中 $D \\in \\mathbb{N}$）的多项式 $p(x)$ 进行积分所需的最小节点数 $N$。一个求积法则的精确度是最大的整数 $r$，使得该法则对所有次数小于或等于 $r$ 的多项式都是精确的。问题要求找到最小的 $N$，使得精确度至少为 $D$。\n\n设函数 $f(x)$ 的积分为 $I(f) = \\int_{-1}^{1} f(x) \\, dx$。一个 $N$ 点求积法则将其近似为 $Q_N(f) = \\sum_{i=1}^{N} w_i f(x_i)$，其中 $\\{x_i\\}$ 是节点，$\\{w_i\\}$ 是权重。\n\n**高斯-勒让德 (GL) 求积法**\n\nGL 求积法是在区间 $[-1, 1]$ 上、权重函数为 $w(x)=1$ 的标准高斯求积法。相关的正交多项式是勒让德多项式 $P_n(x)$，它们满足正交条件 $\\int_{-1}^{1} P_m(x) P_n(x) \\, dx = 0$（当 $m \\neq n$ 时）。\n\n一个 $N$ 点 GL 求积法则使用勒让德多项式 $P_N(x)$ 的 $N$ 个根作为节点 $\\{x_i\\}_{i=1}^N$ 来构造。高斯求积法的一个基本定理指出，这样的法则具有 $2N-1$ 的精确度。我们可以如下证明这一点。\n\n设 $p(x)$ 是任意一个次数至多为 $2N-1$ 的多项式。我们可以用 $N$ 次勒让德多项式 $P_N(x)$ 对 $p(x)$ 进行多项式除法：\n$$p(x) = q(x) P_N(x) + r(x)$$\n其中 $q(x)$ 是商，$r(x)$ 是余数。这些多项式的次数满足 $\\deg(q) \\le (2N-1) - N = N-1$ 和 $\\deg(r) \\le N-1$。\n\n$p(x)$ 的精确积分为：\n$$I(p) = \\int_{-1}^{1} p(x) \\, dx = \\int_{-1}^{1} \\left( q(x) P_N(x) + r(x) \\right) \\, dx = \\int_{-1}^{1} q(x) P_N(x) \\, dx + \\int_{-1}^{1} r(x) \\, dx$$\n由于 $\\deg(q) \\le N-1$，$q(x)$ 可以表示为勒让德多项式 $P_0(x), \\dots, P_{N-1}(x)$ 的线性组合。根据正交性， $P_N(x)$ 与所有次数小于 $N$ 的多项式正交。因此，第一项积分为零：\n$$\\int_{-1}^{1} q(x) P_N(x) \\, dx = 0$$\n这使得 $I(p) = \\int_{-1}^{1} r(x) \\, dx = I(r)$。\n\n现在，我们计算 $p(x)$ 的求积和：\n$$Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$$\n求积节点 $x_i$ 是 $P_N(x)$ 的根，因此对所有 $i=1, \\dots, N$ 都有 $P_N(x_i) = 0$。在这些节点上计算 $p(x)$ 的值得到：\n$$p(x_i) = q(x_i) P_N(x_i) + r(x_i) = q(x_i) \\cdot 0 + r(x_i) = r(x_i)$$\n因此，求积和变为：\n$$Q_N(p) = \\sum_{i=1}^{N} w_i r(x_i) = Q_N(r)$$\n一个具有 $N$ 个节点的高斯求积法则是被构造成对所有次数不超过 $N-1$ 的多项式都精确的。由于 $\\deg(r) \\le N-1$，我们有 $Q_N(r) = I(r)$。\n综合这些结果，我们得到 $I(p) = I(r) = Q_N(r) = Q_N(p)$，这表明该法则对任意次数 $\\deg(p) \\le 2N-1$ 的多项式 $p(x)$ 都是精确的。这个精确度是最高的。\n\n为使 GL 法则能精确地对任意次数 $\\deg(p) \\le D$ 的多项式 $p(x)$ 进行积分，其精确度必须至少为 $D$。\n$$2N_{GL} - 1 \\ge D$$\n解出 $N_{GL}$，我们得到：\n$$N_{GL} \\ge \\frac{D+1}{2}$$\n因为 $N_{GL}$ 必须是整数，我们取满足此不等式的最小整数，即由向上取整函数给出：\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n\n**高斯-洛巴托-勒让德 (GLL) 求积法**\n\nGLL 求积法是高斯求积法的一个变体，其中区间的端点 $x=-1$ 和 $x=1$ 被预先指定为节点。对于一个 $N$ 点法则，两个节点是固定的（$x_1=-1$，$x_N=1$），其余的 $N-2$ 个内部节点被选择以最大化精确度。可以证明，这 $N-2$ 个内部节点是 $(N-1)$ 次勒让德多项式的一阶导数 $P'_{N-1}(x)$ 的根。\n\n一个 $N$ 点 GLL 法则的精确度是 $2N-3$。让我们来证明这一点。\n设 $p(x)$ 是一个次数至多为 $2N-3$ 的多项式。这 $N$ 个 GLL 节点是多项式 $\\omega(x) = (x^2-1)P'_{N-1}(x)$ 的根，该多项式的次数为 $N$。我们将 $p(x)$ 除以 $\\omega(x)$：\n$$p(x) = q(x) (x^2-1)P'_{N-1}(x) + r(x)$$\n其中 $\\deg(q) \\le (2N-3) - N = N-3$ 且 $\\deg(r) \\le N-1$。\n\n精确积分为 $I(p) = \\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, dx + \\int_{-1}^{1} r(x) \\, dx$。对第一项使用分部积分法：\n$$\\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, dx = \\left[ q(x)(x^2-1)P_{N-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} \\frac{d}{dx}\\left(q(x)(x^2-1)\\right) P_{N-1}(x) \\, dx$$\n边界项为零，因为 $(x^2-1)$ 在 $x=\\pm 1$ 处为零。导数 $\\frac{d}{dx}(q(x)(x^2-1))$ 产生一个次数至多为 $(N-3)+2-1 = N-2$ 的多项式。根据正交性，这个多项式乘以 $P_{N-1}(x)$ 的积分为零。因此，第一项积分为零，且 $I(p) = I(r)$。\n\n求积和为 $Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$。由于 GLL 节点 $x_i$ 是 $(x^2-1)P'_{N-1}(x)$ 的根，我们在每个节点上都有 $p(x_i) = r(x_i)$。因此，$Q_N(p) = Q_N(r)$。GLL 法则是被构造成对次数不超过 $N-1$ 的多项式都精确的。由于 $\\deg(r) \\le N-1$，我们有 $Q_N(r) = I(r)$。\n因此，$I(p) = I(r) = Q_N(r) = Q_N(p)$，该法则对所有次数不超过 $2N-3$ 的多项式都是精确的。\n\n为使 GLL 法则能精确地对任意次数 $\\deg(p) \\le D$ 的多项式 $p(x)$ 进行积分，其精确度必须至少为 $D$。\n$$2N_{GLL} - 3 \\ge D$$\n解出 $N_{GLL}$：\n$$2N_{GLL} \\ge D+3 \\implies N_{GLL} \\ge \\frac{D+3}{2}$$\n最小整数 $N_{GLL}$ 是：\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$$\n\n**比较**\n\n我们现在比较最小节点数 $N_{GL}$ 和 $N_{GLL}$。\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + \\frac{2}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + 1 \\right\\rceil$$\n利用向上取整函数的性质 $\\lceil z+k \\rceil = \\lceil z \\rceil + k$（对于任意整数 $k$），我们得到：\n$$N_{GLL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil + 1 = N_{GL} + 1$$\n最小节点数之差为：\n$$N_{GLL} - N_{GL} = 1$$\n这表明，对于给定的所需精确度 $D$，GLL 求积法比 GL 求积法恰好多需要一个节点。这是强制将端点包含在节点集中的代价。\n\n最终答案要求一个行矩阵，其元素为 $N_{GL}$、$N_{GLL}$ 和 $N_{GLL} - N_{GL}$。它们是：\n1. $N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$\n2. $N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$\n3. $N_{GLL} - N_{GL} = 1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{D+1}{2} \\right\\rceil & \\left\\lceil \\frac{D+3}{2} \\right\\rceil & 1\n\\end{pmatrix}\n}\n$$", "id": "3406258"}, {"introduction": "在学习了如何选择足够精确的求积法则后，我们必须理解选择*不充分*法则的后果。本练习 [@problem_id:3406257] 将揭示一种关键现象——混叠（aliasing），即当使用积分不精确的投影时，高频信息会被错误地表示为低频行为，从而污染解。通过一个具体的计算，你将看到一个本应为零的投影如何变为非零，并量化由不精确求积引入的误差，这突显了谱方法和DG方法中不稳定性和误差的一个主要来源。", "problem": "考虑一维参考单元 $[-1,1]$，其上定义了标准 $L^{2}$ 内积 $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)\\,v(x)\\,dx$。令 $\\{P_{n}(x)\\}_{n\\geq 0}$ 表示在 $[-1,1]$ 上的勒让德多项式，它们关于内积 $\\langle \\cdot, \\cdot \\rangle$ 正交，并具有精确的范数 $\\|P_{n}\\|_{L^{2}(-1,1)}^{2} = \\int_{-1}^{1} P_{n}(x)^{2}\\,dx = \\frac{2}{2n+1}$。在多项式谱方法和间断Galerkin方法中，函数 $f$ 到 $p$ 次多项式空间上的 $L^{2}$ 投影由系数 $c_{k}$ 定义，这些系数满足对于所有 $j=0,\\dots,p$，有 $\\langle f - \\sum_{k=0}^{p} c_{k} P_{k}, P_{j} \\rangle = 0$。\n\n假设内积由一个多项式精度为 $2p-1$ 的求积法则来近似，具体地，使用在 $[-1,1]$ 上的 $(p+1)$ 点高斯-洛巴托-勒让德 (GLL) 求积法则（Gauss–Lobatto–Legendre (GLL)），该法则对于次数至多为 $2p-1$ 的被积函数是精确的。为了演示将一个 $2p$ 次多项式投影到 $p$ 次空间时出现的混叠（aliasing）现象，构建并分析以下具体示例：\n\n- 取 $p=2$ 且 $f(x) = P_{4}(x)$。\n- 使用 3 点 GLL 求积节点和权重：节点为 $x_{1}=-1$, $x_{2}=0$, $x_{3}=1$，权重为 $w_{1}=\\frac{1}{3}$, $w_{2}=\\frac{4}{3}$, $w_{3}=\\frac{1}{3}$。\n\n计算由离散法方程定义的基于求积的投影系数 $c_{0}$、$c_{1}$ 和 $c_{2}$\n$$\n\\sum_{m=0}^{2} \\left(\\sum_{i=1}^{3} w_{i}\\,P_{m}(x_{i})\\,P_{j}(x_{i})\\right) c_{m} \\;=\\; \\sum_{i=1}^{3} w_{i}\\,f(x_{i})\\,P_{j}(x_{i}), \\quad j=0,1,2,\n$$\n从而得到基于求积的投影 $u_{Q}(x)=\\sum_{k=0}^{2} c_{k} P_{k}(x)$。证明混叠现象发生（即 $u_{Q}(x)\\not\\equiv 0$），尽管 $f(x)=P_{4}(x)$ 到 2 次多项式空间上的精确 $L^{2}$ 投影是零多项式。最后，通过报告由混叠引起的误差的 $L^{2}([-1,1])$ 范数的精确值 $\\|u_{Q}-0\\|_{L^{2}(-1,1)}$ 来量化所产生的投影误差。您的最终答案必须是一个没有单位的单一闭式解析表达式。", "solution": "问题要求计算函数 $f(x) = P_4(x)$ 在区间 $[-1,1]$ 上到次数至多为 $p=2$ 的多项式空间上的基于求积的 $L^2$ 投影。该投影我们记为 $u_Q(x)$，它是空间 $\\mathbb{P}_2 = \\text{span}\\{P_0(x), P_1(x), P_2(x)\\}$ 中的一个元素，可以写成 $u_Q(x) = \\sum_{k=0}^{2} c_k P_k(x)$。\n\n系数 $c_k$ 是通过使用指定的求积法则来近似Galerkin正交条件中的内积来确定的。真实 $L^2$ 投影的精确正交条件是对于 $j=0,1,2$，有 $\\langle f - \\sum_{k=0}^{2} c_k P_k, P_j \\rangle = 0$。将精确内积 $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)v(x)dx$ 替换为由求积法则导出的离散内积 $\\langle u, v \\rangle_Q = \\sum_{i=1}^{3} w_i u(x_i)v(x_i)$，我们得到问题陈述中给出的线性方程组：\n$$ \\sum_{m=0}^{2} \\langle P_m, P_j \\rangle_Q c_m = \\langle f, P_j \\rangle_Q, \\quad j=0,1,2 $$\n这可以写成矩阵系统 $M_Q \\mathbf{c} = \\mathbf{f}_Q$，其中 $(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q$，$\\mathbf{c} = (c_0, c_1, c_2)^T$ 且 $(\\mathbf{f}_Q)_j = \\langle f, P_j \\rangle_Q$。\n\n问题指定 $p=2$ 并使用 3 点高斯-洛巴托-勒让德 (GLL) 求积，节点为 $x_1=-1, x_2=0, x_3=1$，权重为 $w_1=1/3, w_2=4/3, w_3=1/3$。该求积法则对于次数至多为 $2(3)-3=3$ 的多项式是精确的。\n\n首先，我们需要相关勒让德多项式在求积节点处的值。前几个勒让德多项式是：\n$P_0(x) = 1$\n$P_1(x) = x$\n$P_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$\n\n在节点 $x \\in \\{-1, 0, 1\\}$ 处计算这些值：\n$P_0(-1)=1, P_0(0)=1, P_0(1)=1$\n$P_1(-1)=-1, P_1(0)=0, P_1(1)=1$\n$P_2(-1)=1, P_2(0)=-\\frac{1}{2}, P_2(1)=1$\n$P_4(-1)=1, P_4(0)=\\frac{3}{8}, P_4(1)=1$\n\n接下来，我们计算离散质量矩阵 $M_Q$ 的元素。对于 $j,m \\in \\{0,1,2\\}$：\n$(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_j(x_i) P_m(x_i)$。\n由于被积函数 $P_j(x)P_m(x)$ 的次数至多为 $2+2=4$，而求积法则仅对次数至多为 3 的多项式精确，我们不期望离散质量矩阵与单位矩阵成比例，如果它等于精确（对角）质量矩阵，情况会是这样。然而，由于 GLL 节点和权重的对称性，以及勒让德多项式的奇偶性，非对角项为零：\n$\\langle P_0, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(1)(0) + \\frac{1}{3}(1)(1) = 0$ （精确，次数=1）\n$\\langle P_0, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(1)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{2}{3} = 0$ （精确，次数=2）\n$\\langle P_1, P_2 \\rangle_Q = \\frac{1}{3}(-1)(1) + \\frac{4}{3}(0)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = 0$ （精确，次数=3）\n对角元素为：\n$\\langle P_0, P_0 \\rangle_Q = \\sum_{i=1}^{3} w_i (1)^2 = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = 2$。这是精确的：$\\|P_0\\|^2=2$。\n$\\langle P_1, P_1 \\rangle_Q = \\frac{1}{3}(-1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(1)^2 = \\frac{2}{3}$。这是精确的：$\\|P_1\\|^2=2/3$。\n$\\langle P_2, P_2 \\rangle_Q = \\frac{1}{3}(1)^2 + \\frac{4}{3}(-\\frac{1}{2})^2 + \\frac{1}{3}(1)^2 = \\frac{1}{3} + \\frac{4}{3}(\\frac{1}{4}) + \\frac{1}{3} = 1$。这不是精确的：$\\|P_2\\|^2=2/5$。\n离散质量矩阵是对角的：\n$$ M_Q = \\begin{pmatrix} 2  & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n现在，我们计算右侧向量 $\\mathbf{f}_Q$，其中 $f(x)=P_4(x)$：\n$(\\mathbf{f}_Q)_j = \\langle P_4, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_4(x_i) P_j(x_i)$。\n对于 $j=0$：$\\langle P_4, P_0 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(\\frac{3}{8})(1) + \\frac{1}{3}(1)(1) = \\frac{1}{3} + \\frac{1}{2} + \\frac{1}{3} = \\frac{7}{6}$。\n对于 $j=1$：$\\langle P_4, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(\\frac{3}{8})(0) + \\frac{1}{3}(1)(1) = 0$。\n对于 $j=2$：$\\langle P_4, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac43(\\frac{3}{8})(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{1}{4} = \\frac{5}{12}$。\n\n系统 $M_Q \\mathbf{c} = \\mathbf{f}_Q$ 为：\n$$ \\begin{pmatrix} 2  & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 7/6 \\\\ 0 \\\\ 5/12 \\end{pmatrix} $$\n解出系数：\n$c_0 = \\frac{7/6}{2} = \\frac{7}{12}$\n$c_1 = \\frac{0}{2/3} = 0$\n$c_2 = \\frac{5/12}{1} = \\frac{5}{12}$\n\n基于求积的投影是 $u_Q(x) = \\frac{7}{12}P_0(x) + 0 \\cdot P_1(x) + \\frac{5}{12}P_2(x)$。\n$f(x) = P_4(x)$ 到 $\\mathbb{P}_2$ 上的精确 $L^2$ 投影是零多项式，因为根据勒让德多项式的正交性，对于 $j=0,1,2$ 有 $\\langle P_4, P_j \\rangle = 0$。然而，计算出的投影 $u_Q(x)$ 不是零多项式，因为系数 $c_0$ 和 $c_2$ 非零。这种差异就是混叠误差，是由求积法则无法精确积分乘积 $P_4(x)P_j(x)$ 造成的，这些乘积的次数最高可达 $4+2=6$。高频分量 $P_4(x)$ 被“混叠”到了低频空间 $\\mathbb{P}_2$ 中。在求积点上，$u_Q(x_i)$ 等于 $P_4(x_i)$，因此该误差对于求积法则是不可见的。\n\n问题要求计算由混叠引起的误差的 $L^2$ 范数。误差是计算出的投影与精确投影之差，即 $u_Q(x) - 0 = u_Q(x)$。我们需要计算 $\\|u_Q\\|_{L^2(-1,1)}$。\n使用勒让德多项式在精确内积下的正交性：\n$$ \\|u_Q\\|^2 = \\left\\langle \\frac{7}{12}P_0 + \\frac{5}{12}P_2, \\frac{7}{12}P_0 + \\frac{5}{12}P_2 \\right\\rangle $$\n$$ \\|u_Q\\|^2 = \\left(\\frac{7}{12}\\right)^2 \\langle P_0, P_0 \\rangle + \\left(\\frac{5}{12}\\right)^2 \\langle P_2, P_2 \\rangle $$\n使用已知的范数 $\\|P_n\\|^2 = \\frac{2}{2n+1}$：\n$\\|P_0\\|^2 = \\frac{2}{2(0)+1} = 2$\n$\\|P_2\\|^2 = \\frac{2}{2(2)+1} = \\frac{2}{5}$\n代入这些值：\n$$ \\|u_Q\\|^2 = \\left(\\frac{49}{144}\\right)(2) + \\left(\\frac{25}{144}\\right)\\left(\\frac{2}{5}\\right) = \\frac{98}{144} + \\frac{50}{144 \\cdot 5} = \\frac{98}{144} + \\frac{10}{144} = \\frac{108}{144} $$\n化简分数：\n$$ \\|u_Q\\|^2 = \\frac{108}{144} = \\frac{9 \\times 12}{12 \\times 12} = \\frac{9}{12} = \\frac{3}{4} $$\n混叠误差的 $L^2$ 范数是该值的平方根：\n$$ \\|u_Q - 0\\|_{L^2(-1,1)} = \\|u_Q\\| = \\sqrt{\\frac{3}{4}} = \\frac{\\sqrt{3}}{2} $$\n这是由于混叠造成的投影误差的最终度量。", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$", "id": "3406257"}]}