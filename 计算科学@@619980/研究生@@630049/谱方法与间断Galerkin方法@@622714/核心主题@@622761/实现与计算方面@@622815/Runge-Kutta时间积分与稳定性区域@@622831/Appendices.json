{"hands_on_practices": [{"introduction": "第一个练习是后续内容的基础。我们将分析使用傅里叶谱方法离散化的线性平流方程 $u_{t} + a u_{x} = 0$ 的稳定性，这种方法会产生纯虚数特征值。通过推导一个三阶龙格-库塔方法的稳定性函数并确定其在虚轴上的稳定区间，您将建立算子谱与最大稳定时间步长之间的直接联系，从而清晰地阐释谱方法的Courant-Friedrichs-Lewy (CFL)条件。[@problem_id:3413513]", "problem": "考虑在长度为 $L$ 的周期性区域上的线性平流偏微分方程(PDE) $u_{t} + a\\,u_{x} = 0$，其中 $a \\neq 0$ 是一个实常数。空间离散化在 $N$ 个等距网格点上使用傅里叶谱配置法，网格间距为 $h = L/N$。时间积分采用三阶三级显式龙格－库塔方法进行。令库朗数定义为 $C = |a|\\,\\Delta t / h$，其中 $\\Delta t$ 是时间步长。\n\n从傅里叶分析和龙格－库塔稳定性的基本原理出发：\n\n1) 利用周期函数的傅里叶级数表示和傅里叶模态的正交性，推导每个傅里叶模态的半离散演化，并用波数 $k$ 和平流速度 $a$ 来表示相关的特征值 $\\lambda_{k}$。\n\n2) 对于一个一般的三阶显式龙格－库塔方法，当应用于线性测试方程 $y'(t) = \\lambda\\,y(t)$ 时，仅使用截至三阶的阶条件，推导该方法的稳定性函数 $R(z)$，其中 $z = \\lambda\\,\\Delta t$。\n\n3) 专门考虑纯虚宗量 $z = \\mathrm{i}\\,y$，其中 $y$ 为实数。确定最大的非负数 $y_{\\max}$，使得对于所有 $|y| \\leq y_{\\max}$，都有 $|R(\\mathrm{i}\\,y)| \\leq 1$。\n\n4) 对于在长度为 $L$ 的周期性区域上 $N$ 个点进行的傅里叶谱配置离散化，可分辨波数为 $k_{n} = \\frac{2\\pi n}{L}$，其中 $n \\in \\{-\\frac{N}{2},\\ldots,\\frac{N}{2}\\}$ (若 $N$ 为奇数则作适当解释)，因此可分辨的最大波数大小为 $|k|_{\\max} = \\pi/h$。利用这一事实以及您在第 1) 至 3) 部分得到的结果，确定当使用三阶三级显式龙格－库塔方法时，保证所有可分辨傅里叶模态线性稳定的最大允许库朗数 $C_{\\max}$ 的精确闭式表达式。将您的最终答案表示为单个无单位的闭式表达式。", "solution": "我们分步进行，首先对空间离散化进行傅里叶分析，然后推导时间步进的稳定性约束。\n\n第1步：半离散演化与特征值。在长度为 $L$ 的周期性区域上，将 $u(x,t)$ 展开为傅里叶级数 $u(x,t) = \\sum_{n} \\hat{u}_{n}(t)\\,\\exp(\\mathrm{i}\\,k_{n} x)$，其中 $k_{n} = \\frac{2\\pi n}{L}$ 且 $n \\in \\mathbb{Z}$。对于傅里叶谱配置法，空间微分对每个模态的作用为 $u_{x}(x,t) \\mapsto \\sum_{n} (\\mathrm{i}\\,k_{n})\\,\\hat{u}_{n}(t)\\,\\exp(\\mathrm{i}\\,k_{n}x)$。将此代入偏微分方程 $u_{t} + a\\,u_{x} = 0$ 并令每个模态的系数相等，可得\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\,\\hat{u}_{n}(t) \\;=\\; -\\,a\\,(\\mathrm{i}\\,k_{n})\\,\\hat{u}_{n}(t) \\;=\\; \\lambda_{n}\\,\\hat{u}_{n}(t),\n$$\n因此，半离散算子在傅里叶空间中是对角的，其特征值为\n$$\n\\lambda_{n} \\;=\\; -\\,\\mathrm{i}\\,a\\,k_{n}.\n$$\n因此，当 $a$ 为实数时，每个傅里叶模态满足标量线性常微分方程 $\\hat{u}_{n}'(t) = \\lambda_{n}\\,\\hat{u}_{n}(t)$，其中 $\\lambda_{n}$ 为纯虚数。\n\n第2步：三阶三级显式龙格－库塔方法的稳定性函数。考虑将一个显式龙格－库塔方法应用于线性测试方程 $y'(t) = \\lambda\\,y(t)$。单步映射满足 $y^{n+1} = R(z)\\,y^{n}$，其中 $z = \\lambda\\,\\Delta t$，$R(z)$ 是一个系数由该方法确定的多项式。对于一个三阶方法，阶条件强制要求 $R(z)$ 与 $\\exp(z)$ 的泰勒展开式匹配，直到并包括 $z^{3}$ 阶项。由于一个三级显式龙格－库塔方法的稳定性函数是一个次数最多为 3 的多项式，这些条件将 $R(z)$ 唯一地确定为 $\\exp(z)$ 的三阶泰勒多项式：\n$$\nR(z) \\;=\\; 1 \\;+\\; z \\;+\\; \\frac{z^{2}}{2} \\;+\\; \\frac{z^{3}}{6}.\n$$\n\n第3步：虚轴稳定性范围。令 $z = \\mathrm{i}\\,y$，其中 $y \\in \\mathbb{R}$。则\n$$\nR(\\mathrm{i}\\,y) \\;=\\; 1 \\;+\\; \\mathrm{i}\\,y \\;-\\; \\frac{y^{2}}{2} \\;-\\; \\mathrm{i}\\,\\frac{y^{3}}{6}.\n$$\n其实部和虚部分别为 $\\Re R(\\mathrm{i}\\,y) = 1 - \\frac{y^{2}}{2}$ 和 $\\Im R(\\mathrm{i}\\,y) = y - \\frac{y^{3}}{6}$。因此，\n$$\n\\bigl|R(\\mathrm{i}\\,y)\\bigr|^{2} \\;=\\; \\left(1 - \\frac{y^{2}}{2}\\right)^{2} \\;+\\; \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n\\;=\\; 1 \\;-\\; \\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36}.\n$$\n稳定性条件 $\\bigl|R(\\mathrm{i}\\,y)\\bigr| \\leq 1$ 等价于\n$$\n1 \\;-\\; \\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36} \\;\\leq\\; 1\n\\;\\;\\Longleftrightarrow\\;\\;\n-\\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36} \\;\\leq\\; 0\n\\;\\;\\Longleftrightarrow\\;\\;\ny^{4}\\left(\\frac{y^{2}}{36} - \\frac{1}{12}\\right) \\;\\leq\\; 0.\n$$\n由于 $y^{4} \\geq 0$，不等式简化为 $\\frac{y^{2}}{36} - \\frac{1}{12} \\leq 0$，即\n$$\ny^{2} \\;\\leq\\; 3.\n$$\n因此，在虚轴上使得 $\\bigl|R(\\mathrm{i}\\,y)\\bigr| \\leq 1$ 成立的最大非负值为\n$$\ny_{\\max} \\;=\\; \\sqrt{3}.\n$$\n\n第4步：最大允许库朗数。在长度为 $L$ 的周期性傅里叶网格上的 $N$ 个点上，可分辨波数为 $k_{n} = \\frac{2\\pi n}{L}$，其最大值为 $|k|_{\\max} = \\frac{\\pi N}{L} = \\frac{\\pi}{h}$。对于波数为 $k$ 的模态，稳定性函数的宗量为 $z = \\lambda\\,\\Delta t = -\\,\\mathrm{i}\\,a\\,k\\,\\Delta t$，因此 $|z| = |a|\\,|k|\\,\\Delta t$。为确保所有可分辨模态的稳定性，要求\n$$\n|a|\\,|k|\\,\\Delta t \\;\\leq\\; y_{\\max} \\;=\\; \\sqrt{3}\n\\quad\\text{for all}\\quad |k| \\leq \\frac{\\pi}{h}.\n$$\n最严格的情况是 $|k| = \\frac{\\pi}{h}$，这给出 $|a|\\,\\Delta t\\,\\frac{\\pi}{h} \\leq \\sqrt{3}$。用库朗数 $C = |a|\\,\\Delta t / h$ 表示，此条件为\n$$\n\\pi\\,C \\;\\leq\\; \\sqrt{3},\n$$\n因此最大允许库朗数为\n$$\nC_{\\max} \\;=\\; \\frac{\\sqrt{3}}{\\pi}.\n$$\n这个值保证了每个可分辨的傅里叶模态都位于三阶三级显式龙格－库塔方法的稳定性区域的虚轴范围之内。", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{\\pi}}$$", "id": "3413513"}, {"introduction": "在上一练习的基础上，本实践从傅里叶方法的理想化谱过渡到更具实际意义的间断伽辽金 (DG) 方法。您将发现，当使用迎风格式时，用于平流问题的DG空间算子的特征值不再是纯虚数，而是在复平面中形成一个独特的形状。本练习将指导您推导这一特征值轨迹，并阐明为何稳定性分析现在必须考虑稳定性区域沿实轴的范围，从而更深入地理解空间离散化的选择如何决定稳定性问题的性质。[@problem_id:3413528]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中常数平流速度 $a > 0$。该方程定义在一个周期性域上，该域被划分为宽度为 $h$ 的均匀网格单元。使用多项式次数 $p=0$（分片常数基）的间断Galerkin（DG）方法和迎风数值通量在空间上进行离散。用 $u_{j}(t)$ 表示单元 $j$ 中的单元平均值。\n\n1. 从测试函数等于 $1$ 的DG弱形式出发，并使用与 $a>0$ 一致的迎风数值通量，推导均匀网格上 $u_{j}(t)$ 的半离散演化方程。然后，使用试探解 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i j \\theta)$ 进行傅里叶（von Neumann）分析，其中 $\\theta \\in [-\\pi,\\pi]$ 是以弧度为单位的无量纲波数。由此，求出由 $\\hat{u}'(t) = \\lambda(\\theta)\\,\\hat{u}(t)$ 定义的半离散色散关系 $\\lambda(\\theta)$。\n\n2. 通过分析 $\\Delta t\\,\\lambda(\\theta)$ 在复平面中的位置，确定用于显式时间积分稳定性的最坏情况傅里叶模式 $\\theta_{\\star}$。证明对于下面考虑的显式方法，该模式控制了此网格上的最大稳定时间步长。\n\n3. 对于应用于线性测试问题 $y'=\\lambda y$ 的以下每种显式Runge-Kutta（RK）方法，推导其线性稳定性函数 $R(z)$，其中 $z = \\lambda\\,\\Delta t$：\n   - 两阶段二阶显式梯形法则（通常称为RK2）。\n   - 三阶段三阶强稳定性保持Runge-Kutta方法（SSPRK(3,3)）。\n   - 四阶段四阶经典Runge-Kutta方法（RK4）。\n   对于每种方法，确定最大的 $r>0$，使得实轴上的整个闭区间 $[-r,0]$ 都包含在该方法的稳定性区域 $\\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$ 内。\n\n4. 当 $a=1$ 和 $h=1$ 时，使用第1部分的色散关系、第2部分的最坏情况模式以及第3部分的实轴稳定性范围，确定RK2和RK4的最大稳定时间步长 $\\Delta t_{\\max}$。最后，计算比率\n$$\n\\kappa \\equiv \\frac{\\Delta t_{\\max}^{\\mathrm{RK4}}}{\\Delta t_{\\max}^{\\mathrm{RK2}}}.\n$$\n报告 $\\kappa$ 的值，四舍五入到四位有效数字。\n\n你的最终答案必须仅为 $\\kappa$ 的单个数值。", "solution": "该问题需要进行多步分析，涉及线性平流方程的间断Galerkin（DG）离散化、傅里叶稳定性分析以及显式Runge-Kutta（RK）方法的性质。我们将按顺序处理问题陈述的四个部分。\n\n### 第1部分：半离散方程和色散关系\n\n一维线性平流方程为 $u_t + a u_x = 0$，其中常数速度 $a > 0$。我们在空间上使用DG方法在单元宽度为 $h$ 的均匀网格上进行离散。单元记为 $K_j = [x_{j-1/2}, x_{j+1/2}]$。我们使用次数为 $p=0$ 的多项式基，这意味着解被近似为分片常数函数，$u_h(x,t) = u_j(t)$ 对于 $x \\in K_j$。\n\n单元 $K_j$ 的DG弱形式是通过将偏微分方程乘以来自同一近似空间的测试函数 $v_h$ 并在单元上积分得到的：\n$$ \\int_{K_j} (u_t) v_h \\,dx + \\int_{K_j} (a u_x) v_h \\,dx = 0 $$\n对第二项进行分部积分得到：\n$$ \\int_{K_j} (u_t) v_h \\,dx - \\int_{K_j} a u (v_h)_x \\,dx + [a u v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0 $$\n项 $[a u v_h]$ 被数值通量函数 $\\widehat{auv_h}$ 替换：\n$$ \\int_{K_j} (u_t) v_h \\,dx - \\int_{K_j} a u_h (v_h)_x \\,dx + \\widehat{auv_h}(x_{j+1/2}) - \\widehat{auv_h}(x_{j-1/2}) = 0 $$\n对于 $p=0$，我们选择测试函数 $v_h$ 为单元 $K_j$ 上的特征函数，即当 $x \\in K_j$ 时 $v_h(x) = 1$，否则为 $0$。在此选择下，$u_h(x,t) = u_j(t)$ 并且在单元 $K_j$ 内部 $(v_h)_x = 0$。弱形式简化为：\n$$ \\int_{K_j} \\frac{d u_j}{dt} \\cdot 1 \\,dx - 0 + a\\hat{u}_h(x_{j+1/2})v_h(x_{j+1/2}^-) - a\\hat{u}_h(x_{j-1/2})v_h(x_{j-1/2}^+) = 0 $$\n这里，$\\hat{u}_h$ 是 $u$ 的数值通量。由于在 $K_j$ 上 $v_h=1$，我们有 $v_h(x_{j+1/2}^-) = 1$ 和 $v_h(x_{j-1/2}^+) = 1$。时间导数的积分是 $h \\frac{du_j}{dt}$。半离散方程变为：\n$$ h \\frac{du_j}{dt} + a \\left( \\hat{u}_h(x_{j+1/2}) - \\hat{u}_h(x_{j-1/2}) \\right) = 0 $$\n问题指定了迎风数值通量。由于 $a>0$，特征信息从左向右传播。因此，在任何界面上的迎风值都是来自左侧的值。\n在界面 $x_{j+1/2}$ 处，左侧的值是 $u_j$，右侧的值是 $u_{j+1}$。迎风通量是 $\\hat{u}_h(x_{j+1/2}) = u_j$。\n在界面 $x_{j-1/2}$ 处，左侧的值是 $u_{j-1}$，右侧的值是 $u_j$。迎风通量是 $\\hat{u}_h(x_{j-1/2}) = u_{j-1}$。\n将这些通量代入半离散方程得到：\n$$ h \\frac{du_j}{dt} + a (u_j - u_{j-1}) = 0 \\implies \\frac{du_j}{dt} = -\\frac{a}{h}(u_j - u_{j-1}) $$\n为了进行傅里叶分析，我们使用试探解 $u_j(t) = \\hat{u}(t) \\exp(i j \\theta)$，其中 $\\theta = k h$ 是无量纲波数，$k$ 是波数。将其代入半离散方程：\n$$ \\frac{d}{dt} \\left( \\hat{u}(t) \\exp(i j \\theta) \\right) = -\\frac{a}{h} \\left( \\hat{u}(t) \\exp(i j \\theta) - \\hat{u}(t) \\exp(i (j-1) \\theta) \\right) $$\n$$ \\exp(i j \\theta) \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\hat{u}(t) \\exp(i j \\theta) (1 - \\exp(-i \\theta)) $$\n两边同除以 $\\exp(i j \\theta)$，我们得到傅里叶模式振幅 $\\hat{u}(t)$ 的常微分方程：\n$$ \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} (1 - \\exp(-i \\theta)) \\hat{u}(t) $$\n该方程的形式为 $\\hat{u}'(t) = \\lambda(\\theta)\\hat{u}(t)$。因此，半离散色散关系，或称符号，是：\n$$ \\lambda(\\theta) = -\\frac{a}{h}(1 - \\exp(-i \\theta)) = -\\frac{a}{h}(1 - \\cos\\theta + i\\sin\\theta) $$\n\n### 第2部分：稳定性的最坏情况傅里叶模式\n\n对于显式时间积分，方法的稳定性取决于所有 $\\theta \\in [-\\pi, \\pi]$ 的值 $z = \\Delta t \\lambda(\\theta)$ 在复平面中的位置。让我们分析特征值 $\\lambda(\\theta)$ 的轨迹。令 $\\nu = a/h$。\n$$ \\lambda(\\theta) = -\\nu(1 - \\cos\\theta) - i\\nu\\sin\\theta $$\n设 $\\lambda = x+iy$。则 $x = -\\nu(1-\\cos\\theta)$ 且 $y = -\\nu\\sin\\theta$。我们可以写出 $\\cos\\theta = 1+x/\\nu$ 和 $\\sin\\theta = -y/\\nu$。使用恒等式 $\\cos^2\\theta + \\sin^2\\theta = 1$：\n$$ \\left(1 + \\frac{x}{\\nu}\\right)^2 + \\left(-\\frac{y}{\\nu}\\right)^2 = 1 \\implies (x+\\nu)^2 + y^2 = \\nu^2 $$\n这是复平面中一个圆的方程，圆心为 $(-\\nu, 0) = (-a/h, 0)$，半径为 $\\nu = a/h$。这个圆经过原点（对于 $\\theta=0$）并延伸到负实轴上的 $-2a/h$（对于 $\\theta=\\pi$）。\n为保证显式RK方法的稳定性，集合 $\\{ \\Delta t \\lambda(\\theta) \\mid \\theta \\in [-\\pi, \\pi] \\}$ 必须被包含在方法的稳定性区域 $S = \\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$ 内。缩放后的特征值集合也是一个圆，圆心为 $-\\Delta t a/h$，半径为 $\\Delta t a/h$。\n标准显式RK方法（如RK2和RK4）的稳定性区域包含负实轴上的一个区间 $[-r, 0]$。随着 $\\Delta t$ 的增加，缩放后的特征值圆会扩大。这个圆上最有可能首先离开稳定性区域的点是离原点最远的点，即 $\\Delta t \\lambda(\\pi) = -2a\\Delta t/h$。这个点位于负实轴上。因此，稳定性受限于该点保持在稳定性区域内的条件，即 $-2a\\Delta t/h \\ge -r$。这意味着时间步长的限制是由稳定性区域在实轴上的范围决定的。对应于这个极限特征值的傅里叶模式是 $\\theta_{\\star} = \\pi$。这是网格上可表示的最高频率模式，它控制着最大稳定时间步长。\n\n### 第3部分：Runge-Kutta稳定性函数和实轴范围\n\n应用于 $y'=\\lambda y$ 的RK方法的稳定性函数 $R(z)$ 定义为 $y_{n+1} = R(\\lambda\\Delta t) y_n = R(z) y_n$。稳定性区域为 $\\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$。我们寻找最大的 $r > 0$，使得 $[-r, 0]$ 包含在稳定性区域内。\n\n1.  **RK2（显式梯形法则）：** 该方法是：\n    $k_1 = \\lambda y_n$\n    $k_2 = \\lambda(y_n + \\Delta t k_1) = \\lambda(y_n + \\Delta t \\lambda y_n) = \\lambda y_n(1+z)$\n    $y_{n+1} = y_n + \\frac{\\Delta t}{2}(k_1 + k_2) = y_n + \\frac{z}{2\\lambda}(\\lambda y_n + \\lambda y_n(1+z)) = y_n(1 + \\frac{z}{2}(1 + 1+z)) = y_n(1+z+\\frac{z^2}{2})$。\n    所以，$R_{\\text{RK2}}(z) = 1+z+\\frac{z^2}{2}$。对于实轴稳定性，我们考察 $z=-x$（其中 $x \\ge 0$）：$|1-x+\\frac{x^2}{2}| \\le 1$。这等价于 $-1 \\le 1-x+\\frac{x^2}{2} \\le 1$。\n    -   $1-x+\\frac{x^2}{2} \\le 1 \\implies \\frac{x^2}{2}-x \\le 0 \\implies x(\\frac{x}{2}-1) \\le 0$。对于 $x \\ge 0$，这要求 $\\frac{x}{2}-1 \\le 0$，即 $x \\le 2$。\n    -   $-1 \\le 1-x+\\frac{x^2}{2} \\implies 0 \\le 2-x+\\frac{x^2}{2} \\implies 0 \\le x^2-2x+4$。判别式为 $(-2)^2-4(1)(4) = -12  0$，所以这个二次式总是正的。\n    实数稳定性区间是 $[-2, 0]$，所以 $r_{\\text{RK2}} = 2$。\n\n2.  **SSPRK(3,3)：** 其稳定性函数是 $e^z$ 的3次泰勒多项式。\n    $R_{\\text{SSPRK3}}(z) = 1+z+\\frac{z^2}{2}+\\frac{z^3}{6}$。对于实轴稳定性，我们分析 $|1-x+\\frac{x^2}{2}-\\frac{x^3}{6}| \\le 1$（其中 $x \\ge 0$）。\n    -   $1-x+\\frac{x^2}{2}-\\frac{x^3}{6} \\le 1 \\implies -x+\\frac{x^2}{2}-\\frac{x^3}{6} \\le 0 \\implies x(1-\\frac{x}{2}+\\frac{x^2}{6}) \\ge 0$。二次式 $1-\\frac{x}{2}+\\frac{x^2}{6}$ 的判别式是 $(-\\frac{1}{2})^2 - 4(\\frac{1}{6})(1) = \\frac{1}{4}-\\frac{2}{3}  0$。它总是正的，所以这个不等式对所有 $x \\ge 0$ 都成立。\n    -   $-1 \\le 1-x+\\frac{x^2}{2}-\\frac{x^3}{6} \\implies 0 \\le 2-x+\\frac{x^2}{2}-\\frac{x^3}{6}$。我们必须找到方程 $x^3 - 3x^2 + 6x - 12 = 0$ 的最小正根。数值计算给出这个根约为 $x \\approx 2.5127$。\n    实数稳定性区间大约是 $[-2.5127, 0]$，所以 $r_{\\text{SSPRK3}} \\approx 2.5127$。\n\n3.  **RK4（经典）：** 其稳定性函数是 $e^z$ 的4次泰勒多项式。\n    $R_{\\text{RK4}}(z) = 1+z+\\frac{z^2}{2}+\\frac{z^3}{6}+\\frac{z^4}{24}$。对于实轴稳定性，我们分析 $|1-x+\\frac{x^2}{2}-\\frac{x^3}{6}+\\frac{x^4}{24}| \\le 1$（其中 $x \\ge 0$）。\n    -   $1-x+\\frac{x^2}{2}-\\frac{x^3}{6}+\\frac{x^4}{24} \\le 1 \\implies x(-1+\\frac{x}{2}-\\frac{x^2}{6}+\\frac{x^3}{24}) \\le 0$。对于 $x \\ge 0$，我们需要解 $-1+\\frac{x}{2}-\\frac{x^2}{6}+\\frac{x^3}{24} \\le 0$，即 $x^3 - 4x^2 + 12x - 24 \\le 0$。这个多项式的根通过数值计算得出约为 $x \\approx 2.78528$。该多项式在 $x \\in [0, 2.78528]$ 上是非正的。\n    -   另一个不等式 $-1 \\le 1-x+\\ldots$ 对所有 $x \\ge 0$ 都成立。\n    实数稳定性区间大约是 $[-2.78528, 0]$，所以 $r_{\\text{RK4}} \\approx 2.78528$。\n\n### 第4部分：最大稳定时间步长和比率 $\\kappa$\n\n给定 $a=1$ 和 $h=1$。第2部分的稳定性限制特征值是 $\\lambda_\\star = \\lambda(\\pi) = -2a/h = -2(1)/1 = -2$。稳定性条件要求缩放后的特征值 $z = \\Delta t \\lambda_\\star = -2\\Delta t$ 位于相应RK方法的实数稳定性区间 $[-r, 0]$ 内。\n$$ -r \\le -2\\Delta t \\le 0 $$\n这意味着 $2\\Delta t \\le r$，或者 $\\Delta t \\le r/2$。因此，最大稳定时间步长为 $\\Delta t_{\\max} = r/2$。\n\n对于RK2，我们得到 $r_{\\text{RK2}} = 2$。\n$$ \\Delta t_{\\max}^{\\text{RK2}} = \\frac{r_{\\text{RK2}}}{2} = \\frac{2}{2} = 1 $$\n\n对于RK4，我们得到 $r_{\\text{RK4}} \\approx 2.78528$。\n$$ \\Delta t_{\\max}^{\\text{RK4}} = \\frac{r_{\\text{RK4}}}{2} \\approx \\frac{2.78528}{2} = 1.39264 $$\n\n题目要求计算比率 $\\kappa$：\n$$ \\kappa \\equiv \\frac{\\Delta t_{\\max}^{\\mathrm{RK4}}}{\\Delta t_{\\max}^{\\mathrm{RK2}}} = \\frac{r_{\\text{RK4}}/2}{r_{\\text{RK2}}/2} = \\frac{r_{\\text{RK4}}}{r_{\\text{RK2}}} $$\n$$ \\kappa \\approx \\frac{2.78528}{2} = 1.39264 $$\n四舍五入到四位有效数字，我们得到 $\\kappa \\approx 1.393$。", "answer": "$$\\boxed{1.393}$$", "id": "3413528"}, {"introduction": "我们的最后一个实践将焦点从平流主导问题转移到刚性系统，这类问题经常源于粘性或扩散项的离散化。对于这些问题，显式方法的时间步长会受到极其严格的限制，因此隐式方法变得至关重要。本练习将介绍A-稳定性和L-稳定性等关键概念，指导您分析现代隐式格式（如ESDIRK和SDIRK）的有理稳定性函数，并验证它们对于具有大的负实部的特征值所具备的卓越稳定性。[@problem_id:3413532]", "problem": "您的任务是编写一个完整的、自包含的程序，该程序构造并分析具有显式第一阶的单对角隐式龙格-库塔方法（Explicit First Stage Singly Diagonally Implicit Runge-Kutta, ESDIRK）的稳定性，并将其与标准的二级单对角隐式龙格-库塔（Singly Diagonally Implicit Runge-Kutta, SDIRK）方法进行比较。该分析必须在对纳维-斯托克斯方程进行间断伽辽金 (DG) 离散化所产生的刚性粘性项进行时间积分的背景下进行。\n\n您必须从 Dahlquist 测试问题和应用于线性常微分方程的龙格-库塔方法的基本定义出发。具体而言：\n\n- 考虑 Dahlquist 测试方程 $y'(t) = \\lambda y(t)$，其中对于稳定耗散算子，$\\lambda \\in \\mathbb{C}$ 且 $\\operatorname{Re}(\\lambda) \\le 0$。如果取大小为 $\\Delta t$ 的时间步长，定义 $z = \\lambda \\Delta t$。\n- 龙格-库塔方法由其 Butcher 表 $(\\mathbf{A}, \\mathbf{b}, \\mathbf{c})$ 定义，其中 $\\mathbf{A} \\in \\mathbb{R}^{s \\times s}$，$\\mathbf{b} \\in \\mathbb{R}^{s}$，$\\mathbf{c} \\in \\mathbb{R}^{s}$，$s$ 是阶数。对于隐式方法，当应用于 Dahlquist 测试方程时，内部阶满足线性系统。\n- 在 Dahlquist 测试方程上，离散增长因子映射 $y^{n} \\mapsto y^{n+1}$ 通过 $y^{n+1} = R(z) y^{n}$ 定义了稳定性函数 $R(z)$。对于应用于 Dahlquist 测试方程的 $s$ 阶龙格-库塔方法（显式或隐式），$R(z)$ 可以通过 $(\\mathbf{I} - z \\mathbf{A})$ 的预解式推导为一个依赖于 $\\mathbf{A}$ 和 $\\mathbf{b}$ 的有理函数，其中 $\\mathbf{I}$ 是 $s \\times s$ 的单位矩阵。\n\n您必须实现以下任务：\n\n1. 为两种方法构造稳定性函数 $R(z)$：\n   - 一种 $s=2$ 的 ESDIRK 方法，该方法可简化为具有显式第一阶的隐式梯形法则。使用系数 $\\mathbf{A} = \\begin{bmatrix} 0  0 \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{bmatrix}$，$\\mathbf{b} = \\begin{bmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{bmatrix}$ 和 $\\mathbf{c} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。已知该方法是代数稳定和 A-稳定的。通过将该方法应用于 $y'(t) = \\lambda y(t)$，从第一性原理推导相应的 $R(z)$。\n   - 一种经典的 $s=2$ 的 SDIRK 方法，具有刚性精度且 L-稳定。使用 $\\gamma = 1 - \\frac{1}{\\sqrt{2}}$ 和系数 $\\mathbf{A} = \\begin{bmatrix} \\gamma  0 \\\\ 1 - \\gamma  \\gamma \\end{bmatrix}$，$\\mathbf{b} = \\begin{bmatrix} 1 - \\gamma  \\gamma \\end{bmatrix}$ 和 $\\mathbf{c} = \\begin{bmatrix} \\gamma \\\\ 1 \\end{bmatrix}$。从第一性原理推导出相应的 $R(z)$。\n\n   在这两种情况下，您必须直接通过矩阵预解式形式构造 $R(z)$，而不是引用已知公式。您的程序必须对复数 $z$ 进行 $R(z)$ 的数值计算。\n\n2. 数值验证 A-稳定性或 L-稳定性：\n   - 对于 ESDIRK 隐式梯形方法，通过在虚轴上对区间 $[-100, 100]$ 内均匀分布的 $\\omega$ 采样值 $z = i \\omega$ 来验证 A-稳定性，并报告 $\\max_{\\omega} |R(i \\omega)| \\le 1$ 是否在小的数值容差内成立。\n   - 对于刚性精度的 $s=2$ SDIRK 方法，通过在一个较大的负实数值（例如 $z = -10^{6}$）处计算 $|R(z)|$ 来数值验证 L-稳定性，并报告 $|R(-10^{6})|$ 是否足够小（您必须使用一个在数值上有意义的容差，例如 $10^{-6}$）。\n\n3. 将纳维-斯托克斯方程中粘性算子的间断伽辽金离散化所得到的最大负粘性特征值映射到稳定性参数 $z$：\n   - 考虑一维域，其长度为 $L$，被划分为 $N$ 个大小均匀的单元 $h = L/N$，每个单元上的多项式阶数为 $p$。对称内部罚离散化产生的刚度标度，其最大负特征值的量级可以保守地估计为\n     $$ \\lambda_{\\max}^{\\text{neg}} \\approx - \\nu \\, \\alpha_{\\mathrm{DG}} \\, \\frac{(p+1)^2}{h^2}, $$\n     其中 $\\nu$ 是运动粘度，$\\alpha_{\\mathrm{DG}}$ 是一个无量纲常数，它捕捉了间断伽辽金算子的迹不等式和反不等式界。对于本问题，使用保守值 $\\alpha_{\\mathrm{DG}} = 4$。这种标度与单元上多项式逼近中的内部罚稳定化和反不等式的经过充分检验的事实相一致。\n   - 对于给定的参数 $(\\nu, L, N, p, \\Delta t)$，计算 $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$ 并通过检查 $|R(z)| \\le 1$ 来评估每种方法在该 $z$ 值下是否稳定。\n\n4. 使用以下测试套件生成可量化的输出：\n   - 测试 1 (ESDIRK A-稳定性验证): 在 $\\omega \\in [-100, 100]$ 中进行 100 个点的虚轴采样。输出一个布尔值，指示是否 $\\max |R(i \\omega)| \\le 1$。\n   - 测试 2 (SDIRK L-稳定性验证): 计算 $|R(-10^{6})|$ 并输出一个布尔值，指示其是否小于 $10^{-6}$。\n   - 测试 3 (DG 粘性映射，中等刚度): 参数 $(\\nu, L, N, p, \\Delta t) = (10^{-2}, 1, 8, 3, 10^{-3})$。计算 $z$ 并输出两个布尔值，分别指示 ESDIRK 方法和 SDIRK 方法的稳定性。\n   - 测试 4 (DG 粘性映射，强刚度): 参数 $(\\nu, L, N, p, \\Delta t) = (0.5, 1, 128, 9, 10^{-4})$。计算 $z$ 并输出两个布尔值，分别指示 ESDIRK 方法和 SDIRK 方法的稳定性。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。该列表必须按以下顺序排列：\n- [$[$测试 1 的结果, 测试 2 的结果, 测试 3 中 ESDIRK 的结果, 测试 3 中 SDIRK 的结果, 测试 4 中 ESDIRK 的结果, 测试 4 中 SDIRK 的结果$]$]。\n\n所有输出必须是布尔值。输出中不需要物理单位，因为量已通过 $z = \\lambda \\Delta t$ 进行了无量纲化；但是，如果您注释任何中间量，请以秒为单位表示 $\\Delta t$，以米为单位表示 $L$ 和 $h$，以保持内部一致性。不涉及角度。任何地方都不得使用百分比；如果您的推导或代码中出现任何分数量，则必须表示为小数或分数，不带百分号。", "solution": "所述问题是有效的。它在科学上基于常微分方程数值分析的原理，特别是龙格-库塔方法的稳定性理论。该问题是适定的，为获得唯一且可验证的解提供了所有必要的数据和定义。与纳维-斯托克斯方程的间断伽辽金方法相关的参数和背景，在计算流体力学中是现实且标准的。我现在将着手解决问题。\n\n数值时间积分格式的稳定性通过将其应用于 Dahlquist 测试方程 $y'(t) = \\lambda y(t)$ 来分析，其中 $\\lambda$ 是一个满足 $\\operatorname{Re}(\\lambda) \\le 0$ 的复数。使用时间步长 $\\Delta t$ 应用龙格-库塔 (RK) 方法会得到一个离散映射 $y^{n+1} = R(z) y^n$，其中 $z = \\lambda \\Delta t$ 是无量纲稳定性参数，$R(z)$ 是稳定性函数。如果 $|R(z)| \\le 1$，则该方法对于给定的 $z$ 是稳定的。\n\n对于一个由其 Butcher 表 $(\\mathbf{A}, \\mathbf{b}, \\mathbf{c})$ 定义的 $s$ 阶 RK 方法，Dahlquist 方程的内部阶值 $\\mathbf{Y} \\in \\mathbb{C}^s$ 满足线性系统：\n$$\n\\mathbf{Y} = y^n \\mathbf{1} + z \\mathbf{A} \\mathbf{Y}\n$$\n其中 $\\mathbf{1}$ 是 $s$ 维的全 1 向量。重新整理得到 $(\\mathbf{I} - z \\mathbf{A})\\mathbf{Y} = y^n \\mathbf{1}$，从中可以解出阶向量 $\\mathbf{Y} = y^n (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$。\n\n数值解通过 $y^{n+1} = y^n + \\Delta t \\sum_{i=1}^s b_i k_i$ 更新，其中阶导数为 $k_i = \\lambda Y_i$。以向量形式表示为 $y^{n+1} = y^n + z \\mathbf{b}^T \\mathbf{Y}$。代入 $\\mathbf{Y}$ 的表达式得到：\n$$\ny^{n+1} = y^n + z \\mathbf{b}^T (y^n (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}) = \\left( 1 + z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} \\right) y^n\n$$\n因此，稳定性函数由以下一般表达式给出：\n$$\nR(z) = 1 + z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}\n$$\n我们现在将使用此公式为指定的两种方法推导 $R(z)$。\n\n**1. ESDIRK 隐式梯形方法 ($s=2$)**\n系数由 $\\mathbf{A} = \\begin{bmatrix} 0  0 \\\\ 1/2  1/2 \\end{bmatrix}$ 和 $\\mathbf{b}^T = [1/2, 1/2]$ 给出。\n首先，我们构造矩阵 $(\\mathbf{I} - z \\mathbf{A})$：\n$$\n\\mathbf{I} - z \\mathbf{A} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - z \\begin{bmatrix} 0  0 \\\\ 1/2  1/2 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ -z/2  1 - z/2 \\end{bmatrix}\n$$\n这个 $2 \\times 2$ 矩阵的逆是：\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} = \\frac{1}{1(1-z/2) - 0} \\begin{bmatrix} 1 - z/2  0 \\\\ z/2  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ z/(2(1-z/2))  1/(1-z/2) \\end{bmatrix}\n$$\n现在，我们计算乘积 $(\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$：\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} = \\begin{bmatrix} 1  0 \\\\ z/(2(1-z/2))  1/(1-z/2) \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{z/2 + 1}{1-z/2} \\end{bmatrix}\n$$\n接下来，我们计算项 $z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$：\n$$\nz \\begin{bmatrix} 1/2  1/2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ \\frac{1+z/2}{1-z/2} \\end{bmatrix} = z \\left( \\frac{1}{2} + \\frac{1}{2} \\frac{1+z/2}{1-z/2} \\right) = \\frac{z}{2} \\left( \\frac{1-z/2 + 1+z/2}{1-z/2} \\right) = \\frac{z}{2} \\left( \\frac{2}{1-z/2} \\right) = \\frac{z}{1-z/2}\n$$\n最后，稳定性函数是：\n$$\nR_1(z) = 1 + \\frac{z}{1-z/2} = \\frac{1-z/2 + z}{1-z/2} = \\frac{1+z/2}{1-z/2}\n$$\n这是经典梯形法则的稳定性函数。已知它是 A-稳定的，意味着其稳定域包含整个复平面左半部分，即 $\\{z \\in \\mathbb{C} \\mid \\operatorname{Re}(z) \\le 0\\}$。对于虚轴上的任何 $z = i\\omega$，有 $|R_1(i\\omega)| = |(1+i\\omega/2)/(1-i\\omega/2)| = 1$。\n\n**2. 刚性精度 SDIRK 方法 ($s=2$)**\n系数由 $\\gamma = 1 - 1/\\sqrt{2}$，$\\mathbf{A} = \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix}$ 和 $\\mathbf{b}^T = [1-\\gamma, \\gamma]$ 给出。\n矩阵 $(\\mathbf{I} - z \\mathbf{A})$ 是：\n$$\n\\mathbf{I} - z \\mathbf{A} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - z \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix} = \\begin{bmatrix} 1-z\\gamma  0 \\\\ -z(1-\\gamma)  1-z\\gamma \\end{bmatrix}\n$$\n其行列式为 $(1-z\\gamma)^2$。逆矩阵是：\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{bmatrix} 1-z\\gamma  0 \\\\ z(1-\\gamma)  1-z\\gamma \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{1-z\\gamma}  0 \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2}  \\frac{1}{1-z\\gamma} \\end{bmatrix}\n$$\n我们计算项 $z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$：\n$$\n\\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} = \\begin{bmatrix} 1-\\gamma  \\gamma \\end{bmatrix} \\begin{bmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2} + \\frac{1}{1-z\\gamma} \\end{bmatrix} = \\frac{1-\\gamma}{1-z\\gamma} + \\frac{\\gamma(z(1-\\gamma)+1-z\\gamma)}{(1-z\\gamma)^2}\n$$\n$$\n= \\frac{(1-\\gamma)(1-z\\gamma) + \\gamma(1+z-2z\\gamma)}{(1-z\\gamma)^2} = \\frac{(1-\\gamma -z\\gamma + z\\gamma^2) + (\\gamma + z\\gamma - 2z\\gamma^2)}{(1-z\\gamma)^2} = \\frac{1 - z\\gamma^2}{(1-z\\gamma)^2}\n$$\n稳定性函数为：\n$$\nR_2(z) = 1 + z \\left( \\frac{1-z\\gamma^2}{(1-z\\gamma)^2} \\right) = \\frac{(1-z\\gamma)^2 + z(1-z\\gamma^2)}{(1-z\\gamma)^2} = \\frac{1-2z\\gamma+z^2\\gamma^2+z-z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2}\n$$\n该方法是 L-稳定的，这意味着它是 A-稳定的，并且附加地满足 $\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)  0} |R_2(z)| = 0$。这从 $R_2(z)$ 的形式可以明显看出，对于大的 $|z|$，其行为类似于 $O(1/z)$。\n\n**3. 间断伽辽金 (DG) 粘性特征值映射**\nDG 粘性算子的最大负特征值估计为 $\\lambda_{\\max}^{\\text{neg}} \\approx - \\nu \\, \\alpha_{\\mathrm{DG}} \\, \\frac{(p+1)^2}{h^2}$。鉴于 $\\nu  0$, $\\alpha_{\\mathrm{DG}}  0$ 且 $h  0$，该特征值始终是一个负实数。因此，对于任何正时间步长 $\\Delta t$，稳定性参数 $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$ 也是一个负实数。\n由于 ESDIRK 和 SDIRK 方法都是 A-稳定的，它们的稳定域包含整个负实轴。因此，对于从 DG 特征值估计得出的任何 $z$，我们期望两种方法都是稳定的，即 $|R(z)| \\le 1$。\n\n**4. 数值验证计划**\n- **测试 1 (ESDIRK A-稳定性):** 我们将对 $\\omega \\in [-100, 100]$ 的 100 个值采样 $z=i\\omega$，计算 $|R_1(i\\omega)|$，并验证最大值小于或等于 1，允许一个小的数值容差。\n- **测试 2 (SDIRK L-稳定性):** 我们将在一个大的负实数 $z=-10^6$ 处评估 $|R_2(z)|$，并验证结果小于指定的容差 $10^{-6}$。\n- **测试 3 和 4 (DG 稳定性):** 对于每组参数 $(\\nu, L, N, p, \\Delta t)$，我们将计算 $h=L/N$, $\\lambda_{\\max}^{\\text{neg}}$ 和 $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$。然后我们将评估 $|R_1(z)|$ 和 $|R_2(z)|$ 并检查它们是否都小于或等于 1。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes the stability functions for an ESDIRK and an SDIRK\n    Runge-Kutta method, then applies the analysis to a DG context.\n    \"\"\"\n\n    # --- Part 1: Define Stability Functions ---\n\n    def r_esdirk(z: complex) - complex:\n        \"\"\"\n        Stability function for the s=2 ESDIRK implicit trapezoidal method.\n        R(z) = (1 + z/2) / (1 - z/2).\n        \"\"\"\n        return (1.0 + 0.5 * z) / (1.0 - 0.5 * z)\n\n    def r_sdirk(z: complex) - complex:\n        \"\"\"\n        Stability function for the s=2 stiffly accurate L-stable SDIRK method.\n        R(z) = (1 + z(1-2*gamma)) / (1 - z*gamma)^2.\n        \"\"\"\n        gamma = 1.0 - 1.0 / np.sqrt(2.0)\n        numerator = 1.0 + z * (1.0 - 2.0 * gamma)\n        denominator = (1.0 - z * gamma)**2\n        return numerator / denominator\n\n    results = []\n\n    # --- Part 2: Perform Numerical Tests ---\n\n    # Test 1: ESDIRK A-stability verification\n    # Sample along the imaginary axis and check if |R(i*omega)| = 1.\n    omega_vals = np.linspace(-100.0, 100.0, 100)\n    z_vals_test1 = 1j * omega_vals\n    r_abs_vals_test1 = np.abs(r_esdirk(z_vals_test1))\n    # Use a small tolerance for floating point comparison with the analytical value of 1.\n    is_a_stable_esdirk = np.max(r_abs_vals_test1) = 1.0 + 1e-9\n    results.append(is_a_stable_esdirk)\n\n    # Test 2: SDIRK L-stability verification\n    # Check if |R(z)| - 0 for large negative real z.\n    z_test2 = -1.0e6\n    r_abs_test2 = np.abs(r_sdirk(z_test2))\n    is_l_stable_sdirk = r_abs_test2  1.0e-6\n    results.append(is_l_stable_sdirk)\n\n    def compute_dg_z(nu, L, N, p, dt):\n        \"\"\"\n        Computes the stability parameter z from DG discretization parameters.\n        \"\"\"\n        alpha_dg = 4.0\n        h = L / N\n        lambda_max_neg = -nu * alpha_dg * ((p + 1.0)**2) / (h**2)\n        z = lambda_max_neg * dt\n        return z\n\n    # Test 3: DG viscous mapping, moderate stiffness\n    params_test3 = {'nu': 1.0e-2, 'L': 1.0, 'N': 8, 'p': 3, 'dt': 1.0e-3}\n    z_test3 = compute_dg_z(**params_test3)\n    esdirk_stable_test3 = np.abs(r_esdirk(z_test3)) = 1.0\n    sdirk_stable_test3 = np.abs(r_sdirk(z_test3)) = 1.0\n    results.extend([esdirk_stable_test3, sdirk_stable_test3])\n\n    # Test 4: DG viscous mapping, severe stiffness\n    params_test4 = {'nu': 0.5, 'L': 1.0, 'N': 128, 'p': 9, 'dt': 1.0e-4}\n    z_test4 = compute_dg_z(**params_test4)\n    esdirk_stable_test4 = np.abs(r_esdirk(z_test4)) = 1.0\n    sdirk_stable_test4 = np.abs(r_sdirk(z_test4)) = 1.0\n    results.extend([esdirk_stable_test4, sdirk_stable_test4])\n\n    # --- Part 3: Format and Print Output ---\n    # Convert booleans to strings (\"True\" or \"False\") and join with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3413532"}]}