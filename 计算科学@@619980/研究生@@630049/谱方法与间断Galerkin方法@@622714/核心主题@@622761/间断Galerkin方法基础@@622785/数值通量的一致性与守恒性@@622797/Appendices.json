{"hands_on_practices": [{"introduction": "本练习旨在揭示数值守恒的核心。通过一个假设性场景——相邻单元在界面上使用不同的数值通量函数——我们将推导出保证格式守恒性的基本要求。这项实践将帮助您深入理解，为何总质量的守恒（即 $\\frac{d}{dt}\\int u_h dx = 0$）是界面通量形成可对消求和的直接结果 [@problem_id:3373203]。", "problem": "考虑在周期性区间 $[0,L]$ 上的线性标量守恒律 $u_{t} + a\\,u_{x} = 0$，其中 $L>0$，速度 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 为常数。设该域被划分为 $N \\geq 2$ 个不重叠的单元 $\\{K_{j}\\}_{j=1}^{N}$，交界面位于点 $x_{j+\\frac{1}{2}}$。标准的间断伽辽金（DG）方法在每个单元上用固定阶数的多项式空间中的 $u_{h}$ 来近似 $u$，并通过在单元交界面处使用两点数值通量来强制执行守恒弱形式。\n\n您的任务是对一个受扰动的实现进行诊断和守恒性验证，在该实现中，与交界面 $x_{j+\\frac{1}{2}}$ 相邻的左右单元使用不同的两点数值通量。具体来说，对于每个内部交界面，定义左右通量为\n$$\n\\widehat{f}^{(L)}_{\\theta}\\!\\left(u^{-},u^{+}\\right) \\coloneqq a\\left((1-\\theta)\\,u^{-} + \\theta\\,u^{+}\\right), \\qquad\n\\widehat{f}^{(R)}_{\\phi}\\!\\left(u^{-},u^{+}\\right) \\coloneqq a\\left((1-\\phi)\\,u^{-} + \\phi\\,u^{+}\\right),\n$$\n其中 $u^{-}$ 和 $u^{+}$ 分别是 $u_{h}$ 从交界面左侧和右侧的迹，$\\theta,\\phi \\in \\mathbb{R}$ 是固定参数。假设在周期性边界上一致地应用相同的左右分裂，以便所有交界面都得到统一处理。\n\n定义全局离散质量诊断量\n$$\nM_{h}(t) \\coloneqq \\sum_{j=1}^{N}\\int_{K_{j}} u_{h}(x,t)\\,dx,\n$$\n并令 $\\frac{d}{dt}M_{h}(t)$ 表示由半离散DG方法预测的其时间变化率。仅从守恒律和间断伽辽金（DG）弱形式的定义属性（即逐单元测试和通过数值通量进行交界面耦合）出发，执行以下操作：\n\n- 在周期性边界条件下，推导 $\\frac{d}{dt}M_{h}(t)$ 关于交界面迹 $u^{-}$、$u^{+}$ 以及参数 $\\theta,\\phi$ 的表达式。\n- 施加一个验证要求：诊断量必须恒为零，即 $\\frac{d}{dt}M_{h}(t)\\equiv 0$，对于所有分片多项式状态 $u_{h}$ 和所有时间 $t$ 均成立，从而证明全局守恒性。\n- 假设右通量通过设置 $\\phi=\\tfrac{1}{2}$ 固定为中心选择。确定能保证诊断量对所有 $u_{h}$ 都消失的 $\\theta$ 的唯一值。\n\n您的最终答案必须是 $\\theta$ 的单个实数值。无需四舍五入，也不涉及单位。请以精确形式表示最终答案。", "solution": "该问题要求我们确定一个具有非标准交界面通量公式的间断伽辽金（DG）格式，对于线性平流方程 $u_t + a u_x = 0$ 实现全局质量守恒的条件。\n\n设计算域 $[0, L]$ 被划分为 $N$ 个单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$，其中 $j=1, \\dots, N$。单元 $K_j$ 的DG半离散弱形式是通过将偏微分方程乘以一个与近似解 $u_h$ 属于相同多项式空间的测试函数 $v_h$，在 $K_j$ 上积分，并对空间导数项进行分部积分得到的：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx + \\left[ \\widehat{f} v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n其中 $\\widehat{f}$ 代表数值通量。最后一项展开为 $\\widehat{f}_{j+1/2} v_h(x_{j+1/2}^-) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^+)$。问题指定了一个特殊的设置，即所使用的数值通量取决于单元位于交界面的哪一侧。对于单元 $K_j$，其右边界是 $x_{j+1/2}$，左边界是 $x_{j-1/2}$。在交界面 $x_{j+1/2}$ 处，$K_j$ 是“左单元”。在交界面 $x_{j-1/2}$ 处，$K_j$ 是“右单元”。\n\n根据问题陈述，单元 $K_j$ 上弱形式的通量项在其右边界 $x_{j+1/2}$ 处使用 $\\widehat{f}^{(L)}$ 计算，在其左边界 $x_{j-1/2}$ 处使用 $\\widehat{f}^{(R)}$ 计算。让我们将交界面 $x_{j+1/2}$ 处的 $u_h$ 的迹记为来自单元 $K_j$ 的 $u_j^+ = u_h(x_{j+1/2}^-)$ 和来自单元 $K_{j+1}$ 的 $u_{j+1}^- = u_h(x_{j+1/2}^+)$。因此，单元 $K_j$ 的弱形式为：\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx = \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-) v_h(x_{j+1/2}^-) + \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) v_h(x_{j-1/2}^+)\n$$\n其中下标被理解为周期性的，即 $j=0$ 等价于 $j=N$。\n\n为了求出单元 $K_j$ 上质量的时间变化率，我们设置测试函数 $v_h(x) = 1$。选择该测试函数后，$\\frac{\\partial v_h}{\\partial x} = 0$，方程简化为：\n$$\n\\frac{d}{dt} \\int_{K_j} u_h \\,dx = \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-)\n$$\n\n全局离散质量为 $M_h(t) = \\sum_{j=1}^{N}\\int_{K_j} u_{h}(x,t)\\,dx$。其时间导数是每个单元上质量时间导数的总和：\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\frac{d}{dt} \\int_{K_j} u_h \\,dx = \\sum_{j=1}^{N} \\left[ \\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-) - \\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-) \\right]\n$$\n我们可以重组这个求和。项 $\\widehat{f}^{(R)}_{\\phi}(u_{j-1}^+, u_j^-)$ 和 $\\widehat{f}^{(L)}_{\\theta}(u_{j-1}^+, u_j^-)$ 都与同一个交界面 $x_{j-1/2}$ 相关。让我们将求和的索引从单元改为交界面。由于周期性，有 $N$ 个交界面。我们考虑交界面 $x_{j+1/2}$，其中 $j=1, \\dots, N$。此交界面处的迹是 $u_j^+$（来自左侧，单元 $K_j$）和 $u_{j+1}^-$（来自右侧，单元 $K_{j+1}$）。\n项 $-\\widehat{f}^{(L)}_{\\theta}(u_j^+, u_{j+1}^-)$ 来自单元 $K_j$ 的方程。\n项 $+\\widehat{f}^{(R)}_{\\phi}(u_j^+, u_{j+1}^-)$ 来自单元 $K_{j+1}$ 的方程（在其左边界处）。\n因此，对所有单元 $j=1, \\dots, N$ 求和等价于对所有交界面上的净通量交换求和。在每个交界面处，对总质量的净影响是进入右单元的通量减去离开左单元的通量。\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\left[ \\widehat{f}^{(R)}_{\\phi}(u_{j}^+, u_{j+1}^-) - \\widehat{f}^{(L)}_{\\theta}(u_{j}^+, u_{j+1}^-) \\right]\n$$\n这提供了 $\\frac{d}{dt}M_{h}(t)$ 的推导表达式。现在，我们代入数值通量的给定定义。在一个通用交界面上，令 $u^{-}$ 为左迹，$u^{+}$ 为右迹。\n$\\widehat{f}^{(L)}_{\\theta}(u^-, u^+) = a((1-\\theta)u^- + \\theta u^+)$\n$\\widehat{f}^{(R)}_{\\phi}(u^-, u^+) = a((1-\\phi)u^- + \\phi u^+)$\n在交界面 $x_{j+1/2}$ 处，我们有 $u^- \\equiv u_j^+$ 和 $u^+ \\equiv u_{j+1}^-$。\n$$\n\\frac{d}{dt}M_{h}(t) = \\sum_{j=1}^{N} \\left[ a\\left((1-\\phi)u_j^+ + \\phi u_{j+1}^-\\right) - a\\left((1-\\theta)u_j^+ + \\theta u_{j+1}^-\\right) \\right]\n$$\n合并具有相同迹的项：\n$$\n\\frac{d}{dt}M_{h}(t) = a \\sum_{j=1}^{N} \\left[ (1-\\phi - (1-\\theta)) u_j^+ + (\\phi - \\theta) u_{j+1}^- \\right]\n$$\n$$\n\\frac{d}{dt}M_{h}(t) = a \\sum_{j=1}^{N} \\left[ (\\theta - \\phi) u_j^+ - (\\theta - \\phi) u_{j+1}^- \\right]\n$$\n$$\n\\frac{d}{dt}M_{h}(t) = a(\\theta - \\phi) \\sum_{j=1}^{N} \\left( u_j^+ - u_{j+1}^- \\right)\n$$\n守恒性要求是 $\\frac{d}{dt}M_{h}(t) \\equiv 0$ 对所有有效的分片多项式函数 $u_h$ 均成立。\n求和 $\\sum_{j=1}^{N} (u_j^+ - u_{j+1}^-)$ 可以重写。利用周期性，$\\sum_{j=1}^{N} u_{j+1}^- = \\sum_{j=1}^{N} u_j^-$。\n因此，该求和为 $\\sum_{j=1}^{N} (u_j^+ - u_j^-)$。\n项 $u_j^+ - u_j^-$ 是单元 $K_j$ 中多项式在其右边界和左边界处的迹之差。这等于 $\\int_{K_j} \\frac{\\partial u_h}{\\partial x} dx$。\n总和为 $\\sum_{j=1}^N \\int_{K_j} \\frac{\\partial u_h}{\\partial x} dx$。对于任意不连续函数 $u_h$，这个和通常不为零。例如，如果我们选择 $u_h$ 在一个单元 $K_k$ 上为具有非零斜率的线性多项式，而在所有其他单元上为零，则该和将不为零。\n因此，为了使总表达式对任何 $u_h$ 恒为零，其系数必须消失。由于 $a \\neq 0$，我们必须有：\n$$\n\\theta - \\phi = 0 \\implies \\theta = \\phi\n$$\n这个结果证实了基本原理，即为了确保守恒性，数值通量在每个交界面上必须是单值的；也就是说，离开一个单元的通量必须与进入相邻单元的通量相同。\n\n问题陈述右通量通过设置 $\\phi=\\frac{1}{2}$ 固定为中心选择。为保证守恒性，我们必须有 $\\theta=\\phi$。\n因此，保证诊断量对所有 $u_h$ 都消失的 $\\theta$ 的唯一值是：\n$$\n\\theta = \\frac{1}{2}\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3373203"}, {"introduction": "在半离散格式中建立了守恒条件后，一个自然的问题是：时间离散化过程是否会引入破坏守恒性的误差？本练习将通过分析一个全离散格式来回答这个问题。您将证明，对于一个空间上守恒的离散格式，诸如隐式欧拉等标准的时间推进方法能够精确地保持守恒性（在机器精度范围内），从而强调全局守恒本质上是空间算子的属性 [@problem_id:3373186]。", "problem": "考虑标量守恒律 $\\partial_{t} u + \\partial_{x} f(u) = 0$，定义在周期区间 $[0,L]$ 上，其中 $L>0$，且有周期性边界条件 $x=0$ 和 $x=L$。设 $\\{I_{j}\\}_{j=1}^{K}$ 是 $[0,L]$ 的一个剖分，它将区间分成 $K$ 个不重叠的单元，交界为 $\\{x_{j+\\frac{1}{2}}\\}_{j=0}^{K-1}$，且有周期性标识 $x_{\\frac{1}{2}} \\equiv x_{K+\\frac{1}{2}}$。设 $V_{h}$ 是此网格上最高次数为 $p \\ge 0$ 的分片不连续多项式空间。假设常数函数 $v \\equiv 1$ 在每个单元上都属于 $V_{h}$。\n\n间断Galerkin (DG) 半离散格式定义如下：求解 $u_{h}(t) \\in V_{h}$，使得对于每个单元 $I_{j}$ 和所有测试函数 $v \\in \\mathbb{P}^{p}(I_{j})$，\n$$\n\\int_{I_{j}} \\partial_{t} u_{h}(x,t) v(x) \\mathrm{d}x - \\int_{I_{j}} f\\big(u_{h}(x,t)\\big) \\partial_{x} v(x) \\mathrm{d}x + \\widehat{f}\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j+\\frac{1}{2}},t} v\\big(x_{j+\\frac{1}{2}}^{-}\\big) - \\widehat{f}\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j-\\frac{1}{2}},t} v\\big(x_{j-\\frac{1}{2}}^{+}\\big) = 0.\n$$\n此处 $\\widehat{f}:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}$ 是一个数值通量函数，并假设其在以下意义上是一致且守恒的：\n- 一致性：对于所有 $a \\in \\mathbb{R}$，有 $\\widehat{f}(a,a) = f(a)$。\n- 守恒性：在单元 $I_{j}$ 和 $I_{j+1}$ 共享的内部交界 $x_{j+\\frac{1}{2}}$ 上，两个单元的方程使用同一个数值通量 $\\widehat{f}\\big(u_{h}^{-},u_{h}^{+}\\big)\\big|_{x_{j+\\frac{1}{2}},t}$，但方向相反，即它以 $+$ 号进入 $I_{j}$ 的公式，以 $-$ 号进入 $I_{j+1}$ 的公式。\n\n考虑时间步长为 $\\Delta t>0$ 的后向欧拉时间离散。给定在时刻 $t^{n} = n \\Delta t$ 的 $u_{h}^{n} \\in V_{h}$，通过要求对于每个单元 $I_{j}$ 和所有 $v \\in \\mathbb{P}^{p}(I_{j})$，定义在时刻 $t^{n+1} = (n+1)\\Delta t$ 的 $u_{h}^{n+1} \\in V_{h}$，\n$$\n\\frac{1}{\\Delta t}\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big) v(x) \\mathrm{d}x - \\int_{I_{j}} f\\big(u_{h}^{n+1}(x)\\big) \\partial_{x} v(x) \\mathrm{d}x + \\widehat{f}^{\\,n+1}\\big|_{x_{j+\\frac{1}{2}}} v\\big(x_{j+\\frac{1}{2}}^{-}\\big) - \\widehat{f}^{\\,n+1}\\big|_{x_{j-\\frac{1}{2}}} v\\big(x_{j-\\frac{1}{2}}^{+}\\big) = 0,\n$$\n其中 $\\widehat{f}^{\\,n+1}\\big|_{x_{j+\\frac{1}{2}}} := \\widehat{f}\\Big(u_{h}^{n+1,-}\\big(x_{j+\\frac{1}{2}}\\big), u_{h}^{n+1,+}\\big(x_{j+\\frac{1}{2}}\\big)\\Big)$ 是根据 $u_{h}^{n+1}$ 在交界 $x_{j+\\frac{1}{2}}$ 处的左右迹计算得到的数值通量。\n\n定义在时间步 $n$ 的离散总质量为\n$$\nM^{n} := \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x) \\mathrm{d}x,\n$$\n并定义经过 $N$ 步后向欧拉方法后的累积质量误差为\n$$\nE_{N} := M^{N} - M^{0}.\n$$\n\n仅使用上述数值通量的性质和定义，计算周期问题 $[0,L]$ 上 $E_{N}$ 的精确值。将您的最终答案表示为没有未计算的和或积分的单一闭式表达式。无需四舍五入。", "solution": "目标是计算指定的后向欧拉间断Galerkin (DG) 格式在 $N$ 步之后累积质量误差 $E_{N} = M^{N} - M^{0}$ 的精确值。在时间步 $n$ 的总离散质量定义为 $M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x)\\, \\mathrm{d}x$。\n\n我们首先分析单个时间步内，即从 $t^n$ 到 $t^{n+1}$，总质量的变化。该变化由 $M^{n+1} - M^{n}$ 给出。\n使用 $M^n$ 的定义，我们可以将此变化写为：\n$$\nM^{n+1} - M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n+1}(x)\\, \\mathrm{d}x - \\sum_{j=1}^{K} \\int_{I_{j}} u_{h}^{n}(x)\\, \\mathrm{d}x = \\sum_{j=1}^{K} \\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x.\n$$\n为了计算这个表达式，我们回到问题描述中给出的全离散 DG 格式。该格式对每个单元 $I_{j}$ 和所有测试函数 $v \\in \\mathbb{P}^{p}(I_{j})$ 都成立。问题陈述中说明了多项式次数 $p \\ge 0$ 且常数函数 $v(x) \\equiv 1$ 在每个单元上都属于逼近空间 $V_h$。因此，我们可以为每个单元 $I_j$ 选择特定的测试函数 $v(x) = 1$。\n\n当 $v(x) = 1$ 时，我们有 $\\partial_{x} v(x) = 0$。测试函数在单元边界上的值为 $v(x_{j+\\tfrac{1}{2}}^{-}) = 1$ 和 $v(x_{j-\\tfrac{1}{2}}^{+}) = 1$。将这些代入单元 $I_j$ 的全离散格式中：\n$$\n\\frac{1}{\\Delta t}\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big) \\cdot 1\\, \\mathrm{d}x - \\int_{I_{j}} f(u_{h}^{n+1}(x)) \\cdot 0\\, \\mathrm{d}x + \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} \\cdot 1 - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\cdot 1 = 0.\n$$\n第二项消失。整理方程可得单元 $I_j$ 内质量变化的表达式：\n$$\n\\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x = \\Delta t \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right).\n$$\n这个方程是单元 $I_j$ 上微积分基本定理的离散形式。为了求得总质量变化 $M^{n+1} - M^{n}$，我们将此关系对所有单元 $j=1, \\dots, K$ 求和：\n$$\nM^{n+1} - M^{n} = \\sum_{j=1}^{K} \\int_{I_{j}} \\Big(u_{h}^{n+1}(x) - u_{h}^{n}(x)\\Big)\\, \\mathrm{d}x = \\sum_{j=1}^{K} \\Delta t \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right).\n$$\n我们来分析通量项的和：\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\left( \\widehat{f}^{\\,n+1}|_{x_{1+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{1-\\tfrac{1}{2}}} \\right) + \\left( \\widehat{f}^{\\,n+1}|_{x_{2+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{2-\\tfrac{1}{2}}} \\right) + \\dots + \\left( \\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{K-\\tfrac{1}{2}}} \\right).\n$$\n问题陈述中指明，数值通量在内部交界上是守恒的。这意味着离开单元 $I_j$ 处 $x_{j+\\tfrac{1}{2}}$ 的通量，记为 $\\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$，与进入单元 $I_{j+1}$ 左边界（也是 $x_{j+\\tfrac{1}{2}}$）的通量值相同。我们对单元 $I_{j+1}$ 的公式使用 $\\widehat{f}^{\\,n+1}|_{x_{(j+1)-\\tfrac{1}{2}}} = \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$。因此，这是一个伸缩求和。第 $j$ 个被加项中的 $-\\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}}$ 与第 $(j+1)$ 个被加项中的 $+\\widehat{f}^{\\,n+1}|_{x_{(j+1)-\\tfrac{1}{2}}}$ 相抵消。\n\n在抵消所有内部通量项后，只剩下区域边界上的通量：\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}}.\n$$\n问题设定在周期区间 $[0,L]$ 上，且有周期性边界条件 $x=0$ 和 $x=L$。交界索引从 $j=0$ 到 $K-1$，因此第一个交界是 $x_{\\tfrac{1}{2}}$，最后一个是 $x_{K-\\tfrac{1}{2}}$。最后一个单元 $I_K$ 右侧的交界是 $x_{K+\\tfrac{1}{2}}$。由于周期性，交界 $x_{K+\\tfrac{1}{2}}$ 与第一个交界 $x_{\\tfrac{1}{2}}$ 是等同的。因此，$x_{K+\\tfrac{1}{2}} \\equiv x_{\\tfrac{1}{2}}$。\n这意味着在这个等同的交界处，数值通量的值必须是唯一的单个值：\n$$\n\\widehat{f}^{\\,n+1}|_{x_{K+\\tfrac{1}{2}}} = \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}}.\n$$\n将此代入通量和的表达式中，可得：\n$$\n\\sum_{j=1}^{K} \\left( \\widehat{f}^{\\,n+1}|_{x_{j+\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{j-\\tfrac{1}{2}}} \\right) = \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}} - \\widehat{f}^{\\,n+1}|_{x_{\\tfrac{1}{2}}} = 0.\n$$\n因此，单个时间步内的总质量变化为：\n$$\nM^{n+1} - M^{n} = \\Delta t \\cdot 0 = 0.\n$$\n这表明在全离散格式的每个时间步，总质量都是精确守恒的，即对于所有 $n \\ge 0$，有 $M^{n+1} = M^{n}$。\n此性质被称为全局质量守恒。它之所以成立，是由于 DG 方法的守恒形式（通过分部积分得到）、在交界处使用了守恒的数值通量，以及周期性边界条件。注意，此推导过程并不需要通量的一致性性质 $\\widehat{f}(a,a)=f(a)$。\n\n$N$ 步后的累积质量误差定义为 $E_{N} = M^{N} - M^{0}$。由于质量在每一步都守恒，我们有：\n$$\nM^{N} = M^{N-1} = M^{N-2} = \\dots = M^{1} = M^{0}.\n$$\n因此，$M^{N} = M^{0}$。所以累积质量误差为：\n$$\nE_{N} = M^{0} - M^{0} = 0.\n$$\n这个结果是精确的，并且对任意步数 $N$、任意时间步长 $\\Delta t > 0$、任意多项式次数 $p \\ge 0$、任意单元数 $K$、任意有效的物理通量函数 $f(u)$ 以及任意守恒的数值通量函数 $\\widehat{f}$ 都成立。", "answer": "$$\\boxed{0}$$", "id": "3373186"}, {"introduction": "理论是一回事，实际执行是另一回事。最后一个练习揭示了一个虽然微妙但至关重要的问题：一个理论上守恒的格式在实践中仍可能失效。我们将展示，当在单元界面上使用不匹配的求积规则时，即使采用了相容的通量，混淆误差（aliasing error）也会导致守恒量的“泄漏”。这项练习强调了严谨实施的重要性，并引出了分裂形式（split-form）或保和分部积分（SBP）这类通量作为一种现代解决方案 [@problem_id:3373214]。", "problem": "考虑二维空间中的标量守恒律 $u_{t} + \\nabla \\cdot \\boldsymbol{f}(u) = 0$，其通量为 $\\boldsymbol{f}(u) = \\left(\\tfrac{1}{2}u^{2}, 0\\right)$。我们关注一个物理长度为 $2$ 的单一直立界面段，由 $t \\in [-1,1]$ 参数化。两个相邻的四边形单元 $K_{L}$ 和 $K_{R}$ 共享该界面。假设界面上解的迹是单值的，并由 $u(t) = t^{3} + t$ 给出，因此任何一致性数值通量都满足 $F^{*}(u,u) = f(u)$，对于本问题，有 $F^{*}(u,u) = \\tfrac{1}{2}u^{2}$。\n\n每个单元使用其局部求积法则计算其对沿共享界面的面积分的贡献：\n- 左单元 $K_{L}$ 使用 Gauss–Legendre 求积，取 $N_{L} = 2$ 个点，位于 $t = \\pm 1/\\sqrt{3}$，权重为 $w_{i} = 1$（$i = 1,2$）。\n- 右单元 $K_{R}$ 使用中点法则，取 $N_{R} = 1$ 个点，位于 $t = 0$，权重为 $w = 2$。\n\n在间断 Galerkin (DG) 方法中，跨界面的离散守恒要求，在考虑了相反的向外法向量后，当使用一致性数值通量进行计算时，两个单元的面积分贡献必须完全抵消。证明当两个单元的面积分求积是欠积分且不匹配时，仅靠通量一致性 $F^{*}(u,u) = f(u)$ 不足以保证离散守恒。\n\n将界面上由混叠效应引起的离散泄漏定义为\n$$\nL := \\sum_{i=1}^{N_{L}} w_{i} f(u(t_{i})) - \\sum_{j=1}^{N_{R}} w_{j} f(u(\\tau_{j})),\n$$\n其中 $\\{t_{i}\\}$ 和 $\\{\\tau_{j}\\}$ 分别表示左、右求积节点。对于 $u(t) = t^{3} + t$ 和 $f(u) = \\tfrac{1}{2}u^{2}$，显式计算 $L$，并将 $L$ 表示为单个简化的有理数。\n\n最后，解释基于对称两点通量和分部求和 (SBP) 性质的分裂形式通量差分，在应用于公共界面求积时，如何通过恢复两个单元贡献的精确离散抵消来消除 $f(u) = \\tfrac{1}{2}u^{2}$ 的这种泄漏。最后一部分不需要数值计算；重点关注分裂形式修正这种不匹配的机理原因。\n\n将 $L$ 的最终值表示为简化的有理数。无需四舍五入。", "solution": "该问题研究了由两个单元 $K_L$ 和 $K_R$ 共享的界面上的通量离散守恒。在 DG 框架中，为了使格式局部和全局守恒，每个单元在其公共界面上的数值通量贡献之和必须为零。对于一个垂直界面，左单元的向外单位法向量为 $\\boldsymbol{n}_L = (1, 0)$，右单元的为 $\\boldsymbol{n}_R = (-1, 0)$。跨界面的总通量交换被离散化。来自 $K_L$ 的贡献是 $\\int_{-1}^{1} F^*_x(u_L, u_R) dt$ 的近似，而来自 $K_R$ 的贡献是 $\\int_{-1}^{1} F^*_x(u_R, u_L) dt$ 的近似，其中内部解和外部解的角色互换。跨界面的总离散通量是两个单元贡献的总和，同时考虑了相反的法向量。\n\n问题陈述指出，解的迹是单值的，$u(t) = t^3 + t$，这意味着 $u_L = u_R = u(t)$，并且使用了一致性数值通量，即 $F^*(u,u) = f(u)$。这里，标量通量为 $f(u) = \\frac{1}{2}u^2$。来自 $K_L$ 的离散面积分为 $\\sum_{i=1}^{N_L} w_i f(u(t_i)) n_{L,x}$，来自 $K_R$ 的为 $\\sum_{j=1}^{N_R} w_j f(u(\\tau_j)) n_{R,x}$。由于 $n_{L,x}=1$ 和 $n_{R,x}=-1$，跨界面的净通量，即所谓的混叠效应引起的离散泄漏 $L$，定义为：\n$$\nL := \\sum_{i=1}^{N_{L}} w_{i} f(u(t_{i})) - \\sum_{j=1}^{N_{R}} w_{j} f(u(\\tau_{j}))\n$$\n当且仅当 $L=0$ 时，才能实现离散守恒。我们将使用给定的数据计算 $L$。\n\n首先，我们计算函数 $f(u(t))$：\n$$\nf(u(t)) = \\frac{1}{2} (u(t))^2 = \\frac{1}{2} (t^3 + t)^2 = \\frac{1}{2} (t^6 + 2t^4 + t^2)\n$$\n这是一个 6 次多项式。\n\n接下来，我们使用 $N_L=2$ 点的 Gauss-Legendre 求积（节点为 $t_1 = -1/\\sqrt{3}$，$t_2 = 1/\\sqrt{3}$，权重为 $w_1=1$，$w_2=1$）来计算左单元的和 $S_L$。\n我们在求积节点处计算解 $u(t)$：\n$$u(t_1) = u\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(-\\frac{1}{\\sqrt{3}}\\right) = -\\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} = -\\frac{4}{3\\sqrt{3}}$$\n$$u(t_2) = u\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^3 + \\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{4}{3\\sqrt{3}}$$\n现在，我们在这些值处计算通量函数 $f(u)$：\n$$f(u(t_1)) = \\frac{1}{2} \\left(-\\frac{4}{3\\sqrt{3}}\\right)^2 = \\frac{1}{2} \\left(\\frac{16}{9 \\cdot 3}\\right) = \\frac{1}{2} \\cdot \\frac{16}{27} = \\frac{8}{27}$$\n$$f(u(t_2)) = \\frac{1}{2} \\left(\\frac{4}{3\\sqrt{3}}\\right)^2 = \\frac{1}{2} \\left(\\frac{16}{9 \\cdot 3}\\right) = \\frac{1}{2} \\cdot \\frac{16}{27} = \\frac{8}{27}$$\n左单元的求积和为：\n$$S_L = \\sum_{i=1}^{2} w_i f(u(t_i)) = (1) \\cdot \\frac{8}{27} + (1) \\cdot \\frac{8}{27} = \\frac{16}{27}$$\n\n接下来，我们使用 $N_R=1$ 点的中点法则（节点为 $\\tau_1 = 0$，权重为 $w=2$）来计算右单元的和 $S_R$。\n我们在求积节点处计算解 $u(t)$：\n$$u(\\tau_1) = u(0) = 0^3 + 0 = 0$$\n现在，我们在此值处计算通量函数 $f(u)$：\n$$f(u(0)) = \\frac{1}{2} (0)^2 = 0$$\n右单元的求积和为：\n$$S_R = \\sum_{j=1}^{1} w_j f(u(\\tau_j)) = (2) \\cdot 0 = 0$$\n\n最后，我们计算离散泄漏 $L$：\n$$L = S_L - S_R = \\frac{16}{27} - 0 = \\frac{16}{27}$$\n由于 $L \\neq 0$，两个单元的离散通量贡献没有抵消。这表明，当相邻单元对其面积分使用不匹配且欠积分的求积法则时，仅靠通量一致性 $F^*(u,u)=f(u)$ 不足以保证离散守恒。对同一积分 $\\int_{-1}^1 f(u(t)) dt$ 的不同数值近似导致了在离散层面上的守恒量泄漏。\n\n问题的最后一部分要求解释分裂形式通量差分，结合分部求和 (SBP) 性质和公共界面求积，如何解决这个问题。该机制依赖于两个关键组成部分：使用对称数值通量，以及强制两个单元在其共享界面上使用公共求积法则。\n\n在 DG 格式中，跨越单元 $K_L$ 和 $K_R$ 之间界面 $\\Gamma$ 的守恒要求离散面积分近似之和为零。设 $K_L$ 的近似为 $I_L$，$K_R$ 的近似为 $I_R$。考虑到向外法向量 $\\boldsymbol{n}_R = -\\boldsymbol{n}_L$，我们有：\n$I_L = \\sum_{k=1}^{N} c_k F^*(u_L(\\zeta_k), u_R(\\zeta_k)) \\cdot \\boldsymbol{n}_L(\\zeta_k)$\n$I_R = \\sum_{k=1}^{N} c_k F^*(u_R(\\zeta_k), u_L(\\zeta_k)) \\cdot \\boldsymbol{n}_R(\\zeta_k) = -\\sum_{k=1}^{N} c_k F^*(u_R(\\zeta_k), u_L(\\zeta_k)) \\cdot \\boldsymbol{n}_L(\\zeta_k)$\n这里，一个关键的改变是：两个单元现在都使用一个**公共求积法则**，其节点为 $\\{\\zeta_k\\}$，权重为 $\\{c_k\\}$。这是实现抵消的先决条件。总通量为 $I_L + I_R$。对于单向标量通量，这变为：\n$$I_L + I_R = \\sum_{k=1}^{N} c_k \\left[ F^*_x(u_L(\\zeta_k), u_R(\\zeta_k)) - F^*_x(u_R(\\zeta_k), u_L(\\zeta_k)) \\right] (n_L)_x$$\n如果数值通量关于其参数是**对称的**，即 $F^*(a, b) = F^*(b, a)$，那么这个和保证逐项为零。\n\n这就是二次通量 $f(u) = \\frac{1}{2}u^2$ 的分裂形式差分变得重要的地方。“分裂形式”指的是将通量或其散度重写为一种形式，当其离散化后，能带来某些理想的性质，如稳定性或守恒性。对于二次通量，可以构造一个既是一致性又是对称的两点通量 $F^*(a,b)$。一个著名的例子是熵守恒通量：\n$$F^*(a, b) = \\frac{a^2 + ab + b^2}{6}$$\n该通量是一致性的，因为 $F^*(u,u) = \\frac{u^2+u^2+u^2}{6} = \\frac{3u^2}{6} = \\frac{1}{2}u^2 = f(u)$；它也是对称的，因为 $F^*(a,b) = F^*(b,a)$。\n\n通过选择这样一个对称通量并强制在界面上使用公共求积法则，相邻单元的离散面积分项变得大小相等、方向相反，从而确保精确抵消。这就恢复了离散守恒，消除了泄漏，而无论公共求积法则是否足够精确以至于能够精确地积分通量多项式。分部求和 (SBP) 性质是指导此类离散化构造的一般原则，它确保离散算子模仿分部积分公式，而分部积分公式是在连续情况下证明守恒的基础。在 DG 或 SBP-SAT 的背景下，对称通量和公共界面网格的组合是在单元界面上实现 SBP 原则的实际方法。", "answer": "$$\n\\boxed{\\frac{16}{27}}\n$$", "id": "3373214"}]}