{"hands_on_practices": [{"introduction": "在求解瞬态问题时，质量矩阵的结构对计算效率至关重要。本练习将通过在一个简单的四边形单元上进行直接计算，揭示间断Galerkin方法的核心优势之一。你将看到，在正交基和仿射映射的条件下，DG方法的局部质量矩阵是对角矩阵 [@problem_id:3401227]，这极大地简化了求解过程，是其被广泛应用的重要原因。", "problem": "考虑在无量纲坐标下的单个四边形单元上的不连续伽辽金 (DG) 方法。设参考单元为具有局部坐标 $(r,s)$ 的正方形 $\\widehat{K} = [-1,1] \\times [-1,1]$。物理单元 $K$ 的顶点按逆时针顺序排列，对应于参考角点 $(-1,-1)$, $(1,-1)$, $(1,1)$, $(-1,1)$，在物理坐标系 $(x,y)$ 中由点 $(0,0)$, $(2,0)$, $(2,3)$, $(0,3)$ 给出。使用由 $\\widehat{K}$ 上的四个双线性 Lagrange 形函数构建的标准双线性等参映射：\n$$\nN_{1}(r,s) = \\frac{1}{4}(1-r)(1-s),\\quad\nN_{2}(r,s) = \\frac{1}{4}(1+r)(1-s),\\quad\nN_{3}(r,s) = \\frac{1}{4}(1+r)(1+s),\\quad\nN_{4}(r,s) = \\frac{1}{4}(1-r)(1+s),\n$$\n并将到物理单元的映射定义为\n$$\nx(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,x_{i},\\qquad\ny(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,y_{i},\n$$\n其中 $(x_{i},y_{i})$ 是上述顺序的物理顶点坐标。设 $\\widehat{K}$ 上的逼近空间为张量积 $L^{2}$-正交多项式基\n$$\n\\psi_{p,q}(r,s) = \\varphi_{p}(r)\\,\\varphi_{q}(s),\\qquad p,q \\in \\{0,1,\\dots,P\\},\n$$\n其中 $\\varphi_{p}(r) = \\sqrt{\\frac{2p+1}{2}}\\,P_{p}(r)$，$P_{p}$ 是 $[-1,1]$ 上的 $p$ 次 Legendre 多项式，因此\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}.\n$$\nDG 方法的局部质量矩阵项定义为\n$$\nM_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA,\n$$\n其中 $dA$ 是物理面积元，$\\delta_{i,j}$ 表示克罗内克 δ 符号。\n\n从这些定义出发：\n- 计算从参考单元到物理单元的显式映射 $(x(r,s),y(r,s))$ 和雅可比行列式 $J(r,s) = \\det\\left(\\frac{\\partial(x,y)}{\\partial(r,s)}\\right)$。\n- 使用变量替换公式将 $M_{(p,q),(p',q')}$ 写成在 $\\widehat{K}$ 上包含雅可比行列式的积分。\n- 以闭式形式计算该积分。\n\n基于你的推导，简要解释局部质量矩阵的所得结构如何阐释不连续伽辽金 (DG) 方法的一个核心计算动机和优势，重点关注局部性和效率。将你的最终答案表示为 $M_{(p,q),(p',q')}$ 的单一闭式解析表达式；无需四舍五入。", "solution": "首先验证该问题，以确保其具有科学依据、适定且客观。\n\n### 第 1 步：提取已知条件\n-   参考单元：具有局部坐标 $(r,s)$ 的正方形 $\\widehat{K} = [-1,1] \\times [-1,1]$。\n-   物理单元顶点：按逆时针顺序排列，对应于参考角点 $(-1,-1)$, $(1,-1)$, $(1,1)$, $(-1,1)$，分别为 $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0)$, $(x_3,y_3)=(2,3)$, $(x_4,y_4)=(0,3)$。\n-   双线性 Lagrange 形函数：\n    $N_{1}(r,s) = \\frac{1}{4}(1-r)(1-s)$\n    $N_{2}(r,s) = \\frac{1}{4}(1+r)(1-s)$\n    $N_{3}(r,s) = \\frac{1}{4}(1+r)(1+s)$\n    $N_{4}(r,s) = \\frac{1}{4}(1-r)(1+s)$\n-   等参映射：$x(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,x_{i}$，$y(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,y_{i}$。\n-   $\\widehat{K}$ 上的逼近基：$\\psi_{p,q}(r,s) = \\varphi_{p}(r)\\,\\varphi_{q}(s)$，其中 $p,q \\in \\{0,1,\\dots,P\\}$。\n-   一维基函数：$\\varphi_{p}(r) = \\sqrt{\\frac{2p+1}{2}}\\,P_{p}(r)$，其中 $P_{p}$ 是 $p$ 次 Legendre 多项式。\n-   正交归一性条件：$\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}$。\n-   局部质量矩阵定义：$M_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题是不连续伽辽金 (DG) 方法计算理论中的一个标准练习。所有给出的定义，包括形函数、等参映射和 Legendre 多项式基，都是谱方法和有限元方法领域的标准定义。该问题是自洽的，提供了所有必要的数据和定义。这些顶点定义了一个简单的矩形，这简化了雅可比行列式的计算，是阐释基本原理的常用技巧。该问题是客观的、可数学形式化的，并直接关系到指定的主题。不存在科学或事实上的不健全、矛盾或含糊之处。\n\n### 第 3 步：结论与操作\n该问题被认定为有效。将提供完整解答。\n\n### 解答推导\n\n解答按要求分为三部分进行：计算映射和雅可比行列式，变换质量矩阵积分，以及计算积分，最后解释结果的意义。\n\n**1. 从参考单元到物理单元的映射及雅可比行列式**\n\n从参考坐标 $(r,s) \\in \\widehat{K}$ 到物理坐标 $(x,y) \\in K$ 的等参映射是使用给定的形函数和顶点坐标构建的。\n\n$x$ 坐标的映射为：\n$$\nx(r,s) = N_{1}(r,s)x_{1} + N_{2}(r,s)x_{2} + N_{3}(r,s)x_{3} + N_{4}(r,s)x_{4}\n$$\n代入顶点坐标 $(x_1, x_2, x_3, x_4) = (0, 2, 2, 0)$：\n$$\nx(r,s) = \\frac{1}{4}(1-r)(1-s)(0) + \\frac{1}{4}(1+r)(1-s)(2) + \\frac{1}{4}(1+r)(1+s)(2) + \\frac{1}{4}(1-r)(1+s)(0)\n$$\n$$\nx(r,s) = \\frac{1}{2}(1+r)(1-s) + \\frac{1}{2}(1+r)(1+s) = \\frac{1}{2}(1+r)[(1-s)+(1+s)] = \\frac{1}{2}(1+r)(2) = 1+r\n$$\n\n$y$ 坐标的映射为：\n$$\ny(r,s) = N_{1}(r,s)y_{1} + N_{2}(r,s)y_{2} + N_{3}(r,s)y_{3} + N_{4}(r,s)y_{4}\n$$\n代入顶点坐标 $(y_1, y_2, y_3, y_4) = (0, 0, 3, 3)$：\n$$\ny(r,s) = \\frac{1}{4}(1-r)(1-s)(0) + \\frac{1}{4}(1+r)(1-s)(0) + \\frac{1}{4}(1+r)(1+s)(3) + \\frac{1}{4}(1-r)(1+s)(3)\n$$\n$$\ny(r,s) = \\frac{3}{4}(1+r)(1+s) + \\frac{3}{4}(1-r)(1+s) = \\frac{3}{4}(1+s)[(1+r)+(1-r)] = \\frac{3}{4}(1+s)(2) = \\frac{3}{2}(1+s)\n$$\n显式映射为 $(x(r,s), y(r,s)) = \\left(1+r, \\frac{3}{2}(1+s)\\right)$。这是一个仿射映射。\n\n接下来，我们计算变换的雅可比矩阵 $\\frac{\\partial(x,y)}{\\partial(r,s)}$：\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial r} & \\frac{\\partial x}{\\partial s} \\\\\n\\frac{\\partial y}{\\partial r} & \\frac{\\partial y}{\\partial s}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial r}(1+r) & \\frac{\\partial}{\\partial s}(1+r) \\\\\n\\frac{\\partial}{\\partial r}\\left(\\frac{3}{2}(1+s)\\right) & \\frac{\\partial}{\\partial s}\\left(\\frac{3}{2}(1+s)\\right)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & \\frac{3}{2}\n\\end{pmatrix}\n$$\n雅可比行列式 $J(r,s)$ 是该矩阵的行列式：\n$$\nJ(r,s) = \\det(\\mathbf{J}) = (1)\\left(\\frac{3}{2}\\right) - (0)(0) = \\frac{3}{2}\n$$\n雅可比行列式为常数，因为该映射是仿射的（将正方形映射到矩形）。该常数代表物理单元面积与参考单元面积之比：$\\text{Area}(K) / \\text{Area}(\\widehat{K}) = (2 \\times 3) / (2 \\times 2) = 6/4 = 3/2$。\n\n**2. 质量矩阵积分变换**\n\n局部质量矩阵项定义为在物理单元 $K$ 上的积分：\n$$\nM_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA\n$$\n基函数 $\\psi_{p,q}$ 是在参考单元 $\\widehat{K}$ 上用 $(r,s)$ 定义的。我们使用积分的变量替换公式，其中物理面积元 $dA$ 被替换为 $J(r,s)\\,dr\\,ds$。\n$$\nM_{(p,q),(p',q')} = \\int_{\\widehat{K}} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,J(r,s)\\,dr\\,ds\n$$\n代入计算出的雅可比行列式 $J(r,s) = \\frac{3}{2}$：\n$$\nM_{(p,q),(p',q')} = \\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,\\left(\\frac{3}{2}\\right)\\,dr\\,ds\n$$\n\n**3. 闭式计算与解释**\n\n由于雅可比行列式是一个常数，可以将其从积分中提出：\n$$\nM_{(p,q),(p',q')} = \\frac{3}{2} \\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds\n$$\n问题陈述中给出了基函数 $\\psi_{p,q}$ 的正交归一性：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}\n$$\n其中 $\\delta_{i,j}$ 是克罗内克 δ 符号。将此代入质量矩阵项的表达式中，得到最终的闭式结果：\n$$\nM_{(p,q),(p',q')} = \\frac{3}{2}\\,\\delta_{p,p'}\\,\\delta_{q,q'}\n$$\n此结果表明局部质量矩阵是一个对角矩阵。具体来说，它是单位矩阵的 $\\frac{3}{2}$ 倍。\n\n**计算动机和优势的解释：**\n\n该推导阐释了不连续伽辽金方法的一个核心计算优势，尤其是在使用正交基时。\n\n1.  **局部性和块对角结构：** 质量矩阵是逐个单元计算的。在由许多单元组装成的全局系统中，全局质量矩阵呈块对角结构，其中每个块是对应单元的局部质量矩阵。不同单元上的基函数之间没有耦合，这正是逼近的“不连续”性质的由来。\n\n2.  **通过对角化实现效率：** 这里的关键结果是局部质量矩阵是对角的。对于时间相关问题，通常采用显式时间步进格式（例如，Runge-Kutta 方法）求解，其关键步骤涉及求解形式为 $M\\dot{u} = F(u)$ 的线性系统，这需要计算 $M^{-1}F(u)$。\n    -   由于全局质量矩阵 $M$ 是块对角的，其逆矩阵 $M^{-1}$ 也是块对角的，其中每个块是相应局部质量矩阵的逆。求逆过程可以在每个单元上局部进行。\n    -   至关重要的是，由于局部质量矩阵本身是对角的（$M_{\\text{local}} = cI$），其逆矩阵的计算微不足道：$(M_{\\text{local}})^{-1} = (1/c)I$。在这个具体问题中，任何局部质量矩阵块的逆就是简单地乘以 $2/3$。\n    -   这避免了在每个时间步进行计算成本高昂的全局线性求解，而这在连续伽辽金方法中是必需的，因为其全局质量矩阵是稀疏但非块对角的。因此，DG 方法的质量矩阵是“对显式格式友好的”，从而实现了高效且可并行化的算法。\n\n尽管完全对角的质量矩阵出现在仿射单元和正交基的情况下，但块对角的全局结构是 DG 方法的一个普遍特征。对于更复杂的非仿射（弯曲）单元，雅可比行列式不再是常数，局部质量矩阵会变得稠密。然而，它仍然是一个小矩阵，其求逆效率远高于大型全局系统矩阵，从而与连续方法相比保留了显著的计算优势。", "answer": "$$\n\\boxed{\\frac{3}{2}\\delta_{p,p'}\\delta_{q,q'}}\n$$", "id": "3401227"}, {"introduction": "间断Galerkin方法的核心特点在于其处理单元边界（或称为“界面”）的方式，这与连续有限元法有本质区别。本练习将引导你推导对称内部罚分Galerkin (SIPG) 方法的公式 [@problem_id:3401258]。通过构造并引入用于惩罚解在界面处“跳跃”的项，你将亲身体会到DG方法在保证数值格式稳定性和一致性方面的巨大灵活性。", "problem": "考虑开区间 $\\Omega=(0,1)$ 上的一维扩散模型问题，\n$$-u''=f \\quad \\text{in } \\Omega,$$\n其狄利克雷边界数据为 $u(0)=g_{0}$ 和 $u(1)=g_{1}$。令 $\\mathcal{T}_{h}$ 为 $\\Omega$ 的一个剖分，其节点为 $0=x_{0} < x_{1} < \\dots < x_{N}=1$。在内部界面 $x_i$ ($i=1, \\dots, N-1$)，定义跳跃算子 $[v]_{i} = v(x_{i}^{+}) - v(x_{i}^{-})$ 和平均算子 $\\{v\\}_{i} = \\frac{1}{2}(v(x_{i}^{+}) + v(x_{i}^{-}))$。请推导该问题的对称内部罚分伽辽金 (SIPG) 格式，并给出其双线性形式 $a_{h}(u_{h},v_{h})$ 的表达式。", "solution": "该问题要求为带非齐次狄利克雷边界条件的一维扩散问题推导对称内部罚分伽辽金（SIPG）格式。我们将推导完整的弱形式 $a_{h}(u_{h}, v_{h}) = L_{h}(v_{h})$，并根据要求给出双线性形式 $a_h$。\n\n### 步骤 1：单元上的弱形式\n\n我们从微分方程 $-u'' = f$ 开始。将其乘以一个测试函数 $v_h$，并在单个单元 $K_i=(x_{i-1}, x_i)$上积分：\n$$\n-\\int_{K_i} u'' v_h \\,dx = \\int_{K_i} f v_h \\,dx\n$$\n使用分部积分法（格林第一恒等式），我们将导数从 $u$ 移到 $v_h$ 上：\n$$\n\\int_{K_i} u' v'_h \\,dx - \\left[ u' v_h \\right]_{x_{i-1}}^{x_i} = \\int_{K_i} f v_h \\,dx\n$$\n其中 $\\left[ u' v_h \\right]_{x_{i-1}}^{x_i} = u'(x_i)v_h(x_i) - u'(x_{i-1})v_h(x_{i-1})$。\n\n### 步骤 2：对所有单元求和\n\n接下来，我们对网格 $\\mathcal{T}_h$ 中的所有单元 $i=1, \\dots, N$ 求和：\n$$\n\\sum_{i=1}^{N} \\int_{K_i} u' v'_h \\,dx - \\sum_{i=1}^{N} \\left[ u' v_h \\right]_{x_{i-1}}^{x_i} = \\sum_{i=1}^{N} \\int_{K_i} f v_h \\,dx\n$$\n我们将边界项的和 $\\sum_{i=1}^{N} \\left[ u' v_h \\right]_{x_{i-1}}^{x_i}$ 分解为对内部界面和区域边界的贡献。这是一个伸缩和，但由于解是不连续的，各项不会完全抵消：\n$$\n\\sum_{i=1}^{N} \\left[ u' v_h \\right]_{x_{i-1}}^{x_i} = \\sum_{i=1}^{N-1} \\left( u'(x_i^-)v_h(x_i^-) - u'(x_i^+)v_h(x_i^+) \\right) + u'(1)v_h(1) - u'(0)v_h(0)\n$$\n利用跳跃和平均算子的恒等式 $a^-b^- - a^+b^+ = -(\\{a\\}[b] + [a]\\{b\\})$，内部界面的和可以写为：\n$$\n\\sum_{i=1}^{N-1} \\left( u'(x_i^-)v_h(x_i^-) - u'(x_i^+)v_h(x_i^+) \\right) = - \\sum_{i=1}^{N-1} \\left( \\{u'\\}_{i} [v_{h}]_{i} + [u']_{i} \\{v_{h}\\}_{i} \\right)\n$$\n\n### 步骤 3：构建 SIPG 格式\n\n到目前为止，我们得到的方程对于 $u'$ 仍然是未知的。在 DG 方法中，我们用数值通量代替边界上的精确值。SIPG 格式通过精心设计通量来获得一个对称、相容且稳定的格式。\n\n我们将近似解 $u_h$ 和测试函数 $v_h$ 代入，并用以下各项构建双线性形式 $a_h(u_h, v_h)$：\n1.  **体积项：** 直接来自格林公式，$\\sum_{i=1}^{N} \\int_{K_{i}} u'_{h} v'_{h} \\,dx$。\n2.  **对称性项：** 为了使格式对称，我们将两个方向的通量项都包括进来。对于内部界面，这是 $-\\sum_{i=1}^{N-1} ( \\{u'_{h}\\}_{i} [v_{h}]_{i} + \\{v'_{h}\\}_{i} [u_{h}]_{i} )$。\n3.  **罚项（稳定性项）：** 为了惩罚解的跳跃并确保格式的稳定性（强制性），我们为内部界面的跳跃添加一个罚项 $\\sum_{i=1}^{N-1} \\gamma_{i} [u_{h}]_{i} [v_{h}]_{i}$，其中 $\\gamma_i$ 是一个足够大的正参数。\n4.  **边界项：** 我们将相同的逻辑应用于区域边界 $\\partial\\Omega = \\{0, 1\\}$。在这里，我们弱施加狄利克雷边界条件 $u=g$。对称性和罚项变为：\n    - 对称性项：$-(u'_{h}v_{h}n + v'_{h}u_{h}n)$。在 $x=1$ 处 $n=1$，在 $x=0$ 处 $n=-1$。\n    - 罚项：$\\gamma u_h v_h$。\n\n将这些项组合起来，我们得到双线性形式 $a_h(u_h, v_h)$：\n$$\na_{h}(u_{h},v_{h}) = \\sum_{i=1}^{N} \\int_{K_{i}} u'_{h} v'_{h} \\,dx - \\sum_{i=1}^{N-1} \\left( \\{u'_{h}\\}_{i} [v_{h}]_{i} + \\{v'_{h}\\}_{i} [u_{h}]_{i} \\right) + \\sum_{i=1}^{N-1} \\gamma_{i} [u_{h}]_{i} [v_{h}]_{i} - \\sum_{x \\in \\{0,1\\}} ( u'_{h}v_{h}n + v'_{h}u_{h}n ) + \\sum_{x \\in \\{0,1\\}} \\gamma u_h v_h\n$$\n这个表达式可以更明确地写为：\n$$\na_{h}(u_{h},v_{h}) = \\sum_{i=1}^{N} \\int_{K_{i}} u'_{h} v'_{h} \\,dx - \\sum_{i=1}^{N-1} \\left( \\{u'_{h}\\}_{i} [v_{h}]_{i} + \\{v'_{h}\\}_{i} [u_{h}]_{i} \\right) + \\sum_{i=1}^{N-1} \\gamma_{i} [u_{h}]_{i} [v_{h}]_{i} - (u'_{h}v_{h}|_{x=1} - u'_{h}v_{h}|_{x=0}) - (v'_{h}u_{h}|_{x=1} - v'_{h}u_{h}|_{x=0}) + \\gamma_{1} u_h(1)v_h(1) + \\gamma_{0} u_h(0)v_h(0)\n$$\n\n### 步骤 4：定义线性形式 $L_h(v_h)$\n\n线性形式 $L_h(v_h)$ 来自源项 $f$ 和边界数据 $g_0, g_1$。\n$$\nL_h(v_h) = \\sum_{i=1}^{N} \\int_{K_i} f v_h \\,dx - \\sum_{x \\in \\{0,1\\}} v'_{h} g n + \\sum_{x \\in \\{0,1\\}} \\gamma g v_h\n$$\n展开后为：\n$$\nL_h(v_h) = \\sum_{i=1}^{N} \\int_{K_i} f v_h \\,dx - (v'_{h}(1)g_1 - v'_{h}(0)g_0) + (\\gamma_1 g_1 v_h(1) + \\gamma_0 g_0 v_h(0))\n$$\n\n最终，SIPG 格式是求解 $u_h$ 使得对所有测试函数 $v_h$ 都有 $a_h(u_h, v_h) = L_h(v_h)$。问题要求给出双线性形式 $a_h(u_h, v_h)$ 的表达式。根据上述推导，它由体积积分、内部界面上的对称性和罚项以及边界上的相应项组成。", "answer": "$$\n\\boxed{\na_{h}(u_{h},v_{h}) = \\sum_{i=1}^{N} \\int_{K_{i}} u'_{h} v'_{h} \\,dx - \\sum_{i=1}^{N-1} \\left( \\{u'_{h}\\}_{i} [v_{h}]_{i} + \\{v'_{h}\\}_{i} [u_{h}]_{i} \\right) + \\sum_{i=1}^{N-1} \\gamma_{i} [u_{h}]_{i} [v_{h}]_{i} - \\sum_{x \\in \\{0,1\\}} \\left( u'_{h}v_{h}n + v'_{h}u_{h}n \\right) + \\gamma_{1} u_h(1)v_h(1) + \\gamma_{0} u_h(0)v_h(0)\n}\n$$", "id": "3401258"}, {"introduction": "虽然高阶方法在求解光滑问题时表现出色，但在处理带有激波等间断的解时，容易产生虚假的数值振荡。本练习将向你展示如何通过局部修正来克服这一挑战 [@problem_id:3401228]。你将亲手为一个DG解应用经典的 `minmod` 斜率限制器，体会DG方法的局部化特性如何使其在保持光滑区域高精度的同时，又能有效抑制间断附近的振荡，从而增强方法的鲁棒性。", "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，其在一个均匀网格上离散，网格单元为 $I_{j} = [x_{j - \\frac{1}{2}}, x_{j + \\frac{1}{2}}]$，宽度为 $h$。离散方法为多项式次数 $p=1$ 的间断Galerkin (DG) 方法。在每个单元 $I_{j}$ 中，近似解通过 $x = x_{j} + \\frac{h}{2}\\,\\xi$ 从参考区间 $[-1,1]$ 映射，在一个模态Legendre基中表示为\n$$\nu_{h}(x)\\big|_{I_{j}} = \\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi,\n$$\n其中 $\\bar{u}_{j}$ 是单元平均值，$\\hat{u}_{j,1}$ 是与参考基函数 $\\xi$ 相关联的线性模态系数，且 $\\xi \\in [-1,1]$。\n\n为了在存在间断的情况下增强鲁棒性，一个基于 minmod 函数的斜率限制器被逐单元地应用于物理斜率 $s_{j}$。对于 $p=1$，物理斜率 $s_j$ 定义为单元内的常数导数，\n$$\ns_{j} := \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x}\\bigg|_{I_{j}}.\n$$\n被限制后的斜率定义为\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod\\!\\Big(s_{j}, s_{j}^{-}, s_{j}^{+}\\Big),\n$$\n其中\n$$\ns_{j}^{-} := \\frac{\\bar{u}_{j} - \\bar{u}_{j-1}}{h}, \\qquad s_{j}^{+} := \\frac{\\bar{u}_{j+1} - \\bar{u}_{j}}{h},\n$$\n且 minmod 函数为\n$$\n\\minmod(a_{1},\\dots,a_{n}) = \\begin{cases}\n\\operatorname{sign}(a_{1})\\,\\min\\{|a_{1}|,\\dots,|a_{n}|\\}, & \\text{if } \\operatorname{sign}(a_{1}) = \\cdots = \\operatorname{sign}(a_{n}),\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\n给定一个测试配置，在单元 $I_{j}$ 右侧存在一个间断：\n- 网格宽度 $h = 0.5$，\n- 单元平均值 $\\bar{u}_{j-1} = 1.9$， $\\bar{u}_{j} = 2.0$， $\\bar{u}_{j+1} = -1.8$，\n- 模态系数 $\\hat{u}_{j,1} = 0.15$。\n\n仅使用这些数据和上述定义，计算被限制后的斜率 $s_{j}^{\\mathrm{lim}}$。将最终答案精确表示为单个实数。无需四舍五入。简要解释在间断Galerkin框架中，当存在间断时应用此限制器的动机，阐明此操作保留了该方法的哪些属性，但请确保最终报告的值仅为所要求的被限制后的斜率。", "solution": "该问题是有效的。这是一个来自偏微分方程数值分析领域的适定的、有科学依据的问题，特别是关于谱方法和间断Galerkin (DG) 方法。它提供了计算唯一解所需的所有必要定义和数据。\n\n任务是计算在给定数据和DG方法设置下的被限制后的斜率 $s_{j}^{\\mathrm{lim}}$。被限制后的斜率定义为\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod\\!\\Big(s_{j}, s_{j}^{-}, s_{j}^{+}\\Big).\n$$\n为了计算这个值，我们必须首先确定 `minmod` 函数的三个参数的值：单元 $I_j$ 内的物理斜率 $s_j$，以及根据相邻单元平均值估算的斜率 $s_j^-$ 和 $s_j^+$。\n\n首先，我们计算单元 $I_j$ 内的物理斜率 $s_j$。其定义为单元内近似解 $u_h(x)$ 的空间导数：\n$$\ns_{j} := \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x}\\bigg|_{I_{j}}.\n$$\n解由参考坐标 $\\xi \\in [-1, 1]$ 表示为 $u_{h}(x)\\big|_{I_{j}} = \\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi$。物理坐标 $x$ 和参考坐标 $\\xi$ 之间的映射是 $x = x_{j} + \\frac{h}{2}\\,\\xi$。我们使用链式法则来求导数：\n$$\n\\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x} = \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}\\xi} \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x}.\n$$\n从解的表示形式，关于 $\\xi$ 的导数是：\n$$\n\\frac{\\mathrm{d}u_{h}}{\\mathrm{d}\\xi} = \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} (\\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi) = \\hat{u}_{j,1}.\n$$\n从坐标映射，我们得到 $\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\frac{h}{2}$，这意味着 $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\frac{2}{h}$。\n综合这些结果，物理斜率 $s_j$ 为：\n$$\ns_{j} = \\hat{u}_{j,1} \\cdot \\frac{2}{h}.\n$$\n代入给定值 $h = 0.5$ 和 $\\hat{u}_{j,1} = 0.15$：\n$$\ns_{j} = 0.15 \\cdot \\frac{2}{0.5} = 0.15 \\cdot 4 = 0.6.\n$$\n\n接下来，我们根据相邻单元的平均值计算斜率 $s_j^-$ 和 $s_j^+$。其定义为：\n$$\ns_{j}^{-} := \\frac{\\bar{u}_{j} - \\bar{u}_{j-1}}{h}, \\qquad s_{j}^{+} := \\frac{\\bar{u}_{j+1} - \\bar{u}_{j}}{h}.\n$$\n使用提供的单元平均值 $\\bar{u}_{j-1} = 1.9$， $\\bar{u}_{j} = 2.0$， $\\bar{u}_{j+1} = -1.8$，和网格宽度 $h = 0.5$：\n$$\ns_{j}^{-} = \\frac{2.0 - 1.9}{0.5} = \\frac{0.1}{0.5} = 0.2.\n$$\n$$\ns_{j}^{+} = \\frac{-1.8 - 2.0}{0.5} = \\frac{-3.8}{0.5} = -7.6.\n$$\n\n最后，我们使用 `minmod` 函数和计算出的三个斜率：$s_{j} = 0.6$、$s_{j}^{-} = 0.2$ 和 $s_{j}^{+} = -7.6$ 来计算被限制后的斜率 $s_{j}^{\\mathrm{lim}}$：\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod(0.6, 0.2, -7.6).\n$$\n`minmod` 函数的定义如下：\n$$\n\\minmod(a_{1},\\dots,a_{n}) = \\begin{cases}\n\\operatorname{sign}(a_{1})\\,\\min\\{|a_{1}|,\\dots,|a_{n}|\\}, & \\text{if } \\operatorname{sign}(a_{1}) = \\cdots = \\operatorname{sign}(a_{n}),\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n我们检查参数的符号：$\\operatorname{sign}(0.6) = +1$，$\\operatorname{sign}(0.2) = +1$，以及 $\\operatorname{sign}(-7.6) = -1$。由于这三个参数的符号不完全相同，`minmod` 定义的第二种情况适用。\n因此，被限制后的斜率为：\n$$\ns_{j}^{\\mathrm{lim}} = 0.\n$$\n\n当使用像DG这样的高阶方法求解守恒律时，应用这种限制器的动机是为了确保数值稳定性和物理真实性。高阶格式可以精确地捕捉光滑解，但在激波等间断附近容易产生虚假的、非物理的振荡（吉布斯现象）。这些振荡可能导致非物理状态（例如，负密度）并导致数值模拟失败。\n\n限制器的功能是检测即将出现振荡的区域并局部修改解以抑制它们。限制器所保留或强制的关键属性是**单调性**。如果一个格式不会在解中产生新的局部极大值或极小值，那么它就是保单调的。通过将单元内的斜率 ($s_j$) 与其相邻单元的有限差分斜率 ($s_j^-$ 和 $s_j^+$)进行比较，限制器评估解是否是单调的。在本问题中，单元平均值 $\\bar{u}_{j-1} = 1.9$、$\\bar{u}_{j} = 2.0$ 和 $\\bar{u}_{j+1} = -1.8$ 表明在单元 $I_j$ 处存在一个局部极大值。`minmod` 函数的参数中混合了正负斜率，正是这种非单调剖面的直接结果。通过返回一个值为 $0$，限制器有效地消除了单元 $I_j$ 内的斜率，将多项式表示降为一个常数，$u_h(x)|_{I_j} = \\bar{u}_j$。这在局部将格式的精度降低到一阶，而一阶格式是内在无振荡的，从而以牺牲局部精度为代价来保持单调性。这个过程对于使高阶DG方法在处理涉及激波的问题时具有鲁棒性至关重要。", "answer": "$$\\boxed{0}$$", "id": "3401228"}]}