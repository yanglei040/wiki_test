{"hands_on_practices": [{"introduction": "理论学习的第一步，我们通常从最简单但最核心的情形入手。本练习将引导你通过第一性原理，为一维空间中的Sobolev嵌入 $H^1(0,1) \\hookrightarrow C^{0,1/2}(0,1)$ 推导其最佳嵌入常数。这个过程不仅能具体地揭示函数梯度的可积性如何控制其逐点连续性，而且计算最佳常数本身也是泛函分析中的一项核心技能。[@problem_id:3414907]", "problem": "令 $\\Omega = (0,1)$，考虑指数为 $\\alpha \\in (0,1)$ 的索博列夫空间 $H^{1}(\\Omega)$ 和赫尔德空间 $C^{0,\\alpha}(\\Omega)$。对于一个函数 $f \\in C^{0,\\alpha}(\\Omega)$，定义赫尔德半范数\n$$\n[f]_{C^{0,\\alpha}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{\\alpha}}.\n$$\n在谱方法和间断伽辽金 (DG) 方法的背景下，尖锐嵌入常数用平方可积梯度控制逐点振荡，并直接影响先验误差估计。仅假设 $H^{1}(\\Omega)$ 中函数的基本性质、微积分基本定理和经典不等式。使用对 $H^{1}(\\Omega)$ 函数有效的积分表示和第一性原理推导，确定使得不等式\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\n对所有 $f \\in H^{1}(\\Omega)$ 成立的最小常数 $C_{\\ast}$。然后，将您得到的一维显式常数与在单位区间上当 $n=1, p=2$ 时由 $pn$ 的一般 $n$ 维莫雷型估计所预测的标度进行简要比较，但最终答案只需报告 $C_{\\ast}$ 的值。无需四舍五入，也不涉及物理单位。请提供 $C_{\\ast}$ 的精确值。", "solution": "问题要求找到在定义域 $\\Omega = (0,1)$ 上，索博列夫空间 $H^{1}(\\Omega)$ 嵌入到赫尔德空间 $C^{0,1/2}(\\Omega)$ 的最小常数 $C_{\\ast}$，也称为尖锐常数。所讨论的不等式是：\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\n对所有函数 $f \\in H^{1}(\\Omega)$ 成立，其中 $f'$ 表示 $f$ 的弱导数。赫尔德半范数定义为：\n$$\n[f]_{C^{0,1/2}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}}\n$$\n并且 $L^{2}(\\Omega)$ 中的范数是 $\\|f'\\|_{L^{2}(\\Omega)} = \\left(\\int_{0}^{1} |f'(t)|^2 \\, dt\\right)^{1/2}$。\n\n尖锐常数 $C_{\\ast}$ 是左侧与右侧之比在所有容许函数上的上确界：\n$$\nC_{\\ast} = \\sup_{f \\in H^{1}(\\Omega), f' \\not\\equiv 0} \\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}}\n$$\n我们将分两步确定 $C_{\\ast}$：首先，找到该常数的一个上界；其次，证明该上界可以达到或可以任意逼近。\n\n步骤1：推导 $C_{\\ast}$ 的一个上界。\n\n令 $f \\in H^{1}(\\Omega)$。一维区间上的 $H^{1}$ 函数是绝对连续的。因此，对于任意两点 $x, y \\in \\Omega$，我们可以使用微积分基本定理写出：\n$$\nf(x) - f(y) = \\int_{y}^{x} f'(t) \\, dt\n$$\n不失一般性，设 $x  y$。取绝对值，我们有：\n$$\n|f(x) - f(y)| = \\left| \\int_{y}^{x} f'(t) \\, dt \\right| = \\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right|\n$$\n我们对右侧的表达式应用积分的柯西-施瓦茨不等式：\n$$\n\\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right| \\leq \\left( \\int_{y}^{x} 1^2 \\, dt \\right)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n这可以简化为：\n$$\n|f(x) - f(y)| \\leq (x-y)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n两边除以 $|x-y|^{1/2} = (x-y)^{1/2}$（因为 $x \\neq y$），我们得到：\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\n在子区间 $[y, x]$ 上的积分受整个定义域 $\\Omega = (0,1)$ 上的积分限制：\n$$\n\\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2} \\leq \\left( \\int_{0}^{1} |f'(t)|^2 \\, dt \\right)^{1/2} = \\|f'\\|_{L^{2}(\\Omega)}\n$$\n结合这些不等式，我们得到对于任意一对 $x, y \\in \\Omega$ 且 $x \\neq y$：\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\n因为这对所有这样的点对都成立，我们可以对所有 $x, y \\in \\Omega$ 且 $x \\neq y$ 取上确界：\n$$\n\\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\n这等价于 $[f]_{C^{0,1/2}(\\Omega)} \\leq 1 \\cdot \\|f'\\|_{L^{2}(\\Omega)}$。这个不等式表明常数 $C_{\\ast}$ 必须小于或等于 $1$，即 $C_{\\ast} \\leq 1$。\n\n步骤2：证明该上界是尖锐的。\n\n为证明 $C_{\\ast} = 1$，我们必须证明 $C_{\\ast} \\ge 1$。我们可以通过构造一个函数序列 $f_k \\in H^1(\\Omega)$，使得比值 $\\frac{[f_k]_{C^{0,1/2}(\\Omega)}}{\\|f_k'\\|_{L^2(\\Omega)}}$ 趋近于 $1$，或者通过找到一个使该比值恰好为 $1$ 的函数来实现。\n\n让我们选择一个任意子区间 $(a,b) \\subset \\Omega = (0,1)$，其中 $0  a  b  1$。考虑一个函数 $f \\in H^{1}(\\Omega)$，其弱导数 $f'(t)$ 是该区间的特征函数：\n$$\nf'(t) = \\chi_{(a,b)}(t) = \\begin{cases} 1  \\text{若 } t \\in (a,b) \\\\ 0  \\text{否则} \\end{cases}\n$$\n函数 $f'$ 属于 $L^{2}(\\Omega)$。其一个原函数是 $f(x) = \\int_0^x f'(t)\\,dt$，这是一个连续的分段线性函数，因此属于 $H^1(\\Omega)$。\n\n让我们计算 $f'$ 的 $L^{2}$-范数：\n$$\n\\|f'\\|_{L^{2}(\\Omega)}^2 = \\int_{0}^{1} |f'(t)|^2 \\, dt = \\int_{a}^{b} 1^2 \\, dt = b-a\n$$\n因此，$\\|f'\\|_{L^{2}(\\Omega)} = \\sqrt{b-a}$。\n\n现在，让我们计算赫尔德半范数 $[f]_{C^{0,1/2}(\\Omega)}$。对于任意 $x, y \\in \\Omega$ 且 $xy$：\n$$\n\\frac{|f(x)-f(y)|}{|x-y|^{1/2}} = \\frac{|\\int_y^x f'(t)\\,dt|}{|x-y|^{1/2}} = \\frac{\\int_y^x \\chi_{(a,b)}(t)\\,dt}{\\sqrt{x-y}} = \\frac{\\text{长度}((y,x) \\cap (a,b))}{\\sqrt{x-y}}\n$$\n从步骤1可知，这个量受 $(\\int_y^x |f'(t)|^2 dt)^{1/2} = \\sqrt{\\text{长度}((y,x) \\cap (a,b))}$ 的限制。令 $L_{int} = \\text{长度}((y,x))$ 和 $L_{cap} = \\text{长度}((y,x) \\cap (a,b))$。该量为 $L_{cap}/\\sqrt{L_{int}}$。\n\n让我们对 $x=b$ 和 $y=a$ 的特定选择来评估这个量。我们有：\n$$\n\\frac{|f(b)-f(a)|}{|b-a|^{1/2}} = \\frac{\\int_a^b 1 \\, dt}{\\sqrt{b-a}} = \\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}\n$$\n为了找到半范数，我们需要所有点对的上确界。让我们分析函数 $g(x,y) = \\frac{\\text{长度}((y,x) \\cap (a,b))}{\\sqrt{x-y}}$。\n如果我们选择区间 $(y,x)$ 恰好是 $(a,b)$，我们已经证明其值为 $\\sqrt{b-a}$。\n如果我们选择一个区间 $(y,x)$ 作为 $(a,b)$ 的子集，那么 $\\text{长度}((y,x) \\cap (a,b)) = x-y$。其值为 $\\frac{x-y}{\\sqrt{x-y}} = \\sqrt{x-y}$，当 $x-y$ 尽可能大时，即 $x-y \\to b-a$ 时，该值最大化。\n如果我们选择一个包含 $(a,b)$ 的区间 $(y,x)$，那么 $\\text{长度}((y,x) \\cap (a,b)) = b-a$。其值为 $\\frac{b-a}{\\sqrt{x-y}}$。当 $x-y$ 最小时，即当 $(y,x)$ 恰好是 $(a,b)$ 时，该值最大化，其值为 $\\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}$。\n一个更形式化的论证可以证实上确界确实是 $\\sqrt{b-a}$。\n所以，对于这个函数 $f$，我们有 $[f]_{C^{0,1/2}(\\Omega)} = \\sqrt{b-a}$。\n\n现在我们可以计算这个特定函数的比值：\n$$\n\\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}} = \\frac{\\sqrt{b-a}}{\\sqrt{b-a}} = 1\n$$\n因为我们找到了一个非平凡函数 $f \\in H^{1}(\\Omega)$，其比值恰好为 $1$，所以所有此类函数的上确界必须至少为 $1$。因此，$C_{\\ast} \\ge 1$。\n\n结合我们的两个发现，$C_{\\ast} \\leq 1$ 和 $C_{\\ast} \\ge 1$，我们得出结论，尖锐常数恰好是 $1$。\n\n问题还要求与一般 $n$ 维莫雷型估计在 $W^{1,p}(\\Omega)$ 上的特例进行简要比较。对于 $pn$ 的 $W^{1,p}(\\Omega)$，嵌入到 $C^{0,\\alpha}(\\overline{\\Omega})$，其中 $\\alpha = 1 - n/p$。对于我们的问题，空间是 $H^1(\\Omega) = W^{1,2}(\\Omega)$，定义域是一维的，所以 $n=1$ 且 $p=2$。条件 $pn$ 满足，因为 $2  1$。预测的赫尔德指数是 $\\alpha = 1 - 1/2 = 1/2$，这与问题陈述相符。如步骤1所示，使用微积分基本定理和柯西-施瓦茨不等式的直接推导是证明莫雷不等式一维情况的标准方法。该方法直接得到常数 $C=1$。我们在步骤2中发现这个常数是尖锐的，这表明对于这个特定情况（$n=1, p=2, \\Omega=(0,1)$），用于证明一般定理的最简单的证明技巧恰好得到了最优常数。\n\n最终要求的答案是 $C_\\ast$ 的值。", "answer": "$$\\boxed{1}$$", "id": "3414907"}, {"introduction": "在掌握了理论推导的基础后，通过数值计算来验证和探索理论的边界是至关重要的。本练习将带你进入计算的世界，利用傅里叶级数这一在环面上定义Sobolev空间最自然的工具，来数值验证 $H^s(\\mathbb{T}^n) \\hookrightarrow L^\\infty(\\mathbb{T}^n)$ 嵌入定理。你将亲手实现范数的计算，并直观地感受到光滑指数 $s$ 与空间维数 $n$ 之间的关键关系，即 $s \\gt n/2$ 条件的重要性。[@problem_id:3414954]", "problem": "考虑周期环面 $\\mathbb{T}^n$，它被等同于带有周期性边界条件的立方体 $[0,2\\pi]^n$，其中的角度以弧度为单位。令 $u_N:\\mathbb{T}^n\\to\\mathbb{C}$ 为一个谱近似，由有限傅里叶级数表示\n$$\nu_N(x)=\\sum_{k\\in I\\subset\\mathbb{Z}^n}\\hat{u}_k\\,e^{i\\,k\\cdot x},\n$$\n其中 $I$ 是多重指标 $k=(k_1,\\dots,k_n)\\in\\mathbb{Z}^n$ 的一个有限索引集，$x=(x_1,\\dots,x_n)\\in\\mathbb{T}^n$，系数 $\\hat{u}_k\\in\\mathbb{C}$ 是与指数基 $e^{i\\,k\\cdot x}$ 相关联的归一化傅里叶系数。在谱方法和间断 Galerkin (DG) 方法的背景下，一致（本质上确界）范数中的界限用于控制非线性通量和混叠，而当 $s\\frac{n}{2}$ 时，Sobolev 嵌入定理提供了必要的估计。\n\n请从第一性原理出发，使用 Sobolev 空间 $H^s(\\mathbb{T}^n)$ 的定义和 Cauchy–Schwarz 不等式，将 $u_N$ 的 $H^s$ 范数与一个一致（本质上确界）界限联系起来。具体而言：\n\n- Sobolev 范数 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ 通过傅里叶系数 $\\hat{u}_k$ 定义。\n- 一致界 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ 必须通过在 $\\mathbb{T}^n$ 上的一个均匀网格上计算 $u_N$ 并取其绝对值的最大值来数值化地获得。网格分辨率必须足够高以捕捉到上确界；对于一维空间，每个维度使用 $M=4096$ 个网格点，对于二维空间，每个维度使用 $M=512$ 个网格点。\n- 基于嵌入的界限通过应用带有权重 $(1+|k|^2)^{s}$ 的 Cauchy–Schwarz 不等式获得，其中 $|k|$ 表示 $\\mathbb{R}^n$ 中的欧几里得范数。这将产生一个界限，其常数可以通过将完整的索引格点截断为对每个分量 $i\\in\\{1,\\dots,n\\}$ 都有 $|k_i|\\leq K_{\\max}$ 来近似。\n\n您的任务是 (i) 从给定的有限傅里叶系数集计算 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，(ii) 通过在均匀网格上采样来计算 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ 的数值近似，(iii) 计算一个基于嵌入的界限 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(K_{\\max})\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，其中\n$$\nC_{s,n}(K_{\\max})=\\left(\\sum_{k\\in\\mathbb{Z}^n,\\;|k_i|\\leq K_{\\max}}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\n以及 (iv) 对每个测试用例数值化地验证该不等式。此外，请仅使用有限索引集 $I$ 计算精确的索引集界限，\n$$\nC_{s,n}(I)=\\left(\\sum_{k\\in I}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\n并验证 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(I)\\|u_N\\|_{H^s(\\mathbb{T}^n)}$。\n\n请采用以下基本依据：\n- $\\mathbb{T}^n$ 上的傅里叶表示、归一化的傅里叶系数以及欧几里得范数 $|k|$。\n- 通过 $\\mathbb{T}^n$ 上的傅里叶系数定义 Sobolev 空间，即由 $(1+|k|^2)^s|\\hat{u}_k|^2$ 的平方可和性定义的 $H^s(\\mathbb{T}^n)$。\n- 应用于由 $k\\in\\mathbb{Z}^n$ 索引的序列的 $\\ell^2$ 中的 Cauchy–Schwarz 不等式。\n\n您必须实现一个程序，对于每个测试用例，输出：\n- Sobolev 范数 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 数值计算的一致范数 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$，作为一个浮点数。\n- 截断格点嵌入界限 $B_{\\text{trunc}}=C_{s,n}(K_{\\max})\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 一个布尔值，指示 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{\\text{trunc}}$ 是否在数值上成立。\n- 有限索引集界限 $B_{I}=C_{s,n}(I)\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$，作为一个浮点数。\n- 一个布尔值，指示 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{I}$ 是否在数值上成立。\n\n使用以下参数值测试套件，它涵盖了 $s\\frac{n}{2}$、边界 $s=\\frac{n}{2}$ 和 $s\\frac{n}{2}$ 的情况，以及一维和二维两种情况：\n- 测试用例 1：$n=1$, $s=1.0$, $K_{\\max}=64$，指数集 $I=\\{k\\in\\mathbb{Z}:k\\in\\{-2,-1,1,2\\}\\}$，系数为 $\\hat{u}_{-2}=\\hat{u}_{2}=0.25$, $\\hat{u}_{-1}=\\hat{u}_{1}=0.5$。\n- 测试用例 2：$n=2$, $s=1.2$, $K_{\\max}=32$，指数集 $I=\\{(-2,0),(-1,0),(0,-1),(0,1),(1,0),(1,1),(-1,-1),(2,0)\\}$，系数为 $\\hat{u}_{-2,0}=\\hat{u}_{2,0}=0.05$, $\\hat{u}_{-1,0}=\\hat{u}_{1,0}=0.3$, $\\hat{u}_{0,-1}=\\hat{u}_{0,1}=0.2$, $\\hat{u}_{1,1}=\\hat{u}_{-1,-1}=0.1$。\n- 测试用例 3：$n=1$, $s=0.5$, $K_{\\max}=64$，指数集 $I=\\{(-10),(-3),(-1),(1),(3),(10)\\}$，系数为 $\\hat{u}_{-10}=\\hat{u}_{10}=0.02$, $\\hat{u}_{-3}=\\hat{u}_{3}=0.1$, $\\hat{u}_{-1}=\\hat{u}_{1}=0.7$。\n- 测试用例 4：$n=2$, $s=0.4$, $K_{\\max}=32$，指数集 $I=\\{(-5,0),(-1,-2),(0,-5),(0,5),(1,2),(5,0)\\}$，系数为 $\\hat{u}_{-5,0}=\\hat{u}_{5,0}=0.05$, $\\hat{u}_{0,-5}=\\hat{u}_{0,5}=0.05$, $\\hat{u}_{1,2}=\\hat{u}_{-1,-2}=0.03$。\n\n对于每种情况，程序必须：\n- 计算 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}=\\left(\\sum_{k\\in I}(1+|k|^2)^s\\,|\\hat{u}_k|^2\\right)^{1/2}$。\n- 通过在每个维度有 $M$ 个点的均匀网格上（对于 $n=1$ 使用 $M=4096$，对于 $n=2$ 使用 $M=512$）采样 $u_N$ 并取网格上 $|u_N(x)|$ 的最大值来计算 $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$。\n- 通过在截断格点 $\\{k\\in\\mathbb{Z}^n:\\ |k_i|\\leq K_{\\max}\\}$ 上求和来计算 $C_{s,n}(K_{\\max})$。\n- 仅通过在给定的索引集 $I$ 上求和来计算 $C_{s,n}(I)$。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来（例如，$[\\,[r_{11},r_{12},\\dots],\\,[r_{21},r_{22},\\dots]\\,]$），其中每个内部列表对应一个测试用例，并完全按照以下顺序包含六个条目：$\\|u_N\\|_{H^s}$ (浮点数)，$\\|u_N\\|_{L^\\infty}$ (浮点数)，$B_{\\text{trunc}}$ (浮点数)，带 $B_{\\text{trunc}}$ 的不等式是否成立 (布尔值)，$B_{I}$ (浮点数)，带 $B_{I}$ 的不等式是否成立 (布尔值)。", "solution": "该问题要求对 $n$ 维环面 $\\mathbb{T}^n$ 上的有限傅里叶级数进行 Sobolev 嵌入定理的数值研究。我们给定一个由其截断傅里叶级数定义的函数 $u_N(x)$：\n$$\nu_N(x) = \\sum_{k \\in I \\subset \\mathbb{Z}^n} \\hat{u}_k \\, e^{i k \\cdot x}\n$$\n其中 $I$ 是整数多重指标的有限集合，$\\hat{u}_k$ 是相应的复傅里叶系数。目标是计算与 Sobolev 嵌入 $H^s(\\mathbb{T}^n) \\hookrightarrow L^\\infty(\\mathbb{T}^n)$ 相关的几个量，并数值验证相关的不等式。\n\n任务的核心依赖于 Sobolev $H^s$ 范数和一致 $L^\\infty$ 范数的定义，以及 Cauchy-Schwarz 不等式的应用。\n\n**1. 范数定义**\n\n对于实数 $s$，Sobolev 空间 $H^s(\\mathbb{T}^n)$ 由环面上的函数组成，其直到 $s$ 阶的导数是平方可积的。对于一个函数 $u(x) = \\sum_{k \\in \\mathbb{Z}^n} \\hat{u}_k e^{i k \\cdot x}$，其 $H^s$ 范数通过其傅里叶系数定义为：\n$$\n\\|u\\|_{H^s(\\mathbb{T}^n)}^2 = \\sum_{k \\in \\mathbb{Z}^n} (1 + |k|^2)^s |\\hat{u}_k|^2\n$$\n其中 $|k| = \\sqrt{k_1^2 + \\dots + k_n^2}$ 是多重指标 $k$ 的欧几里得范数。该定义对高频模式（大 $|k|$）赋予更大的权重，从而捕捉函数的光滑性。对于我们的有限傅里叶级数 $u_N(x)$，求和仅限于有限索引集 $I$：\n$$\n\\|u_N\\|_{H^s(\\mathbb{T}^n)} = \\left(\\sum_{k \\in I} (1 + |k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}\n$$\n\n一致范数，或称 $L^\\infty$ 范数，衡量函数的最大幅值：\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} = \\sup_{x \\in \\mathbb{T}^n} |u_N(x)|\n$$\n在数值上，此值通过在环面 $\\mathbb{T}^n \\cong [0, 2\\pi]^n$ 上的一个精细的、$M^n$ 个点的均匀网格上计算 $|u_N(x)|$ 并找到最大值来近似。\n\n**2. Sobolev 嵌入与 Cauchy-Schwarz 不等式**\n\nSobolev 嵌入定理指出，对于 $s  n/2$，空间 $H^s(\\mathbb{T}^n)$ 连续地嵌入到连续函数空间中，这意味着存在一个常数 $C$，使得对于所有 $u \\in H^s(\\mathbb{T}^n)$，都有 $\\|u\\|_{L^\\infty} \\leq C \\|u\\|_{H^s}$。我们可以直接从 Cauchy-Schwarz 不等式为我们的函数 $u_N$ 推导出这个不等式的一个具体实例。\n\n考虑 $u_N(x)$ 的表达式。我们可以将求和重写为：\n$$\nu_N(x) = \\sum_{k \\in I} \\left( (1+|k|^2)^{s/2} \\hat{u}_k \\right) \\cdot \\left( \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right)\n$$\n将 Cauchy-Schwarz 不等式应用于此求和（视为序列空间 $\\ell^2(I)$ 中的内积）得到：\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} \\left| (1+|k|^2)^{s/2} \\hat{u}_k \\right|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\left| \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right|^2 \\right)\n$$\n识别各项，我们将其简化为：\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)\n$$\n右边的第一项恰好是 $\\|u_N\\|_{H^s(\\mathbb{T}^n)}^2$。由于右边不依赖于 $x$，这个不等式对于左边在所有 $x$ 上的上确界也成立。对两边取平方根，我们得到：\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} \\leq C_{s,n}(I) \\, \\|u_N\\|_{H^s(\\mathbb{T}^n)}\n$$\n其中常数 $C_{s,n}(I)$ 由下式给出：\n$$\nC_{s,n}(I) = \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\n这个不等式是定义的代数结果，对任何有限傅里叶级数 $u_N$ 都必须成立。这给出了界 $B_I = C_{s,n}(I) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$。\n\n问题还引入了第二个常数 $C_{s,n}(K_{\\max})$，通过在更大、更规则的模式格点上求和计算得出：\n$$\nC_{s,n}(K_{\\max}) = \\left(\\sum_{k \\in \\mathbb{Z}^n, \\, |k_i| \\leq K_{\\max}} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\n这个常数近似于真正的嵌入常数 $C_{s,n}(\\infty)$，其定义级数仅在 $2s  n$ (即 $s  n/2$) 时收敛。由于每个测试用例的索引集 $I$ 都是由 $K_{\\max}$ 定义的格点的子集，因此必然有 $C_{s,n}(I) \\leq C_{s,n}(K_{\\max})$。因此，界 $B_{\\text{trunc}} = C_{s,n}(K_{\\max}) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$ 比 $B_I$ 更宽松，但也必须成立。\n\n**3. 计算流程**\n\n对每个测试用例，我们执行以下计算：\n1.  **计算 $\\|u_N\\|_{H^s}$**：使用给定的索引集 $I$ 和系数 $\\hat{u}_k$，直接计算总和 $\\left(\\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}$。\n2.  **计算 $\\|u_N\\|_{L^\\infty}$**：在 $[0, 2\\pi]^n$ 上构建一个每个维度有 $M$ 个点的均匀网格（$n=1$ 时 $M=4096$，$n=2$ 时 $M=512$）。在每个网格点上计算复值函数 $u_N(x)$。为了效率，使用了矢量化计算，即对于每个模式 $k \\in I$，同时为所有网格点 $x$ 计算项 $\\hat{u}_k e^{i k \\cdot x}$。然后将所有模式的结果相加。$L^\\infty$ 范数则近似为网格上 $|u_N(x)|$ 的最大值 $\\max_x |u_N(x)|$。\n3.  **计算 $C_{s,n}(K_{\\max})$ 和 $B_{\\text{trunc}}$**：生成所有满足对所有分量 $i=1,\\dots,n$ 都有 $|k_i| \\leq K_{\\max}$ 的整数向量 $k \\in \\mathbb{Z}^n$。计算定义 $C_{s,n}(K_{\\max})^2$ 的和，取平方根，再乘以 $\\|u_N\\|_{H^s}$ 得到 $B_{\\text{trunc}}$。\n4.  **计算 $C_{s,n}(I)$ 和 $B_I$**：在给定的稀疏索引集 $I$ 上计算定义 $C_{s,n}(I)^2$ 的和，取平方根，再乘以 $\\|u_N\\|_{H^s}$ 得到 $B_I$。\n5.  **验证不等式**：检查数值计算出的 $\\|u_N\\|_{L^\\infty}$ 是否小于或等于计算出的界 $B_{\\text{trunc}}$ 和 $B_I$。\n\n选择的测试用例旨在探索嵌入定理成立（$s  n/2$，用例 1 和 2）、处于临界边界（$s=n/2$，用例 3）和失效（$s  n/2$，用例 4）的场景。对于所有情况，因为 $u_N$ 只有有限数量的模式，所以它是无限可微的，因此是有界的。无论 $s$ 和 $n$ 的值如何，所推导的涉及 $C_{s,n}(I)$ 和 $C_{s,n}(K_{\\max})$ 的代数不等式都应成立。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Sobolev and uniform norms for finite Fourier series on the torus\n    and verifies the Sobolev embedding inequality numerically.\n    \"\"\"\n    test_cases = [\n        {\n            \"n\": 1, \"s\": 1.0, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {(-2,): 0.25, (-1,): 0.5, (1,): 0.5, (2,): 0.25}\n        },\n        {\n            \"n\": 2, \"s\": 1.2, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-2, 0): 0.05, (-1, 0): 0.3, (0, -1): 0.2, (0, 1): 0.2,\n                (1, 0): 0.3, (1, 1): 0.1, (-1, -1): 0.1, (2, 0): 0.05\n            }\n        },\n        {\n            \"n\": 1, \"s\": 0.5, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {\n                (-10,): 0.02, (-3,): 0.1, (-1,): 0.7,\n                (1,): 0.7, (3,): 0.1, (10,): 0.02\n            }\n        },\n        {\n            \"n\": 2, \"s\": 0.4, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-5, 0): 0.05, (-1, -2): 0.03, (0, -5): 0.05,\n                (0, 5): 0.05, (1, 2): 0.03, (5, 0): 0.05\n            }\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n, s, K_max, M, coeffs = case['n'], case['s'], case['K_max'], case['M'], case['coeffs']\n        \n        I = np.array(list(coeffs.keys()))  # Shape (|I|, n)\n        u_hats = np.array(list(coeffs.values()))  # Shape (|I|,)\n\n        # 1. Compute ||u_N||_{H^s}\n        k_norms_sq = np.sum(I**2, axis=1)\n        h_s_norm_sq_terms = (1 + k_norms_sq)**s * np.abs(u_hats)**2\n        h_s_norm = np.sqrt(np.sum(h_s_norm_sq_terms))\n\n        # 2. Compute ||u_N||_{L^infty} numerically\n        grid_coords_1d = [np.linspace(0, 2 * np.pi, M, endpoint=False) for _ in range(n)]\n        \n        # Vectorized evaluation of u_N on the grid\n        if n == 1:\n            pos_vectors = grid_coords_1d[0][:, np.newaxis]  # Shape (M, 1)\n        else:  # n == 2\n            grid_mesh = np.meshgrid(*grid_coords_1d, indexing='ij')\n            pos_vectors = np.stack(grid_mesh, axis=-1)  # Shape (M, M, n)\n            \n        k_dot_x = np.tensordot(I, pos_vectors, axes=([-1], [-1])) # Shape (|I|, M,...)\n        u_hats_reshaped = u_hats.reshape(u_hats.shape + (1,) * n)\n        u_N_grid = np.sum(u_hats_reshaped * np.exp(1j * k_dot_x), axis=0)\n        l_inf_norm = np.max(np.abs(u_N_grid))\n\n        # 3. Compute C_{s,n}(K_max) and the truncated bound B_trunc\n        if n == 1:\n            k_range = np.arange(-K_max, K_max + 1)\n            k_grid = k_range.reshape(-1, 1)\n        else: # n == 2\n            k_range = np.arange(-K_max, K_max + 1)\n            k_mesh = np.meshgrid(k_range, k_range, indexing='ij')\n            k_grid = np.stack(k_mesh, axis=-1).reshape(-1, 2)\n        \n        k_grid_norms_sq = np.sum(k_grid**2, axis=1)\n        c_trunc_sq_sum = np.sum(1.0 / (1 + k_grid_norms_sq)**s)\n        c_trunc = np.sqrt(c_trunc_sq_sum)\n        b_trunc = c_trunc * h_s_norm\n        ineq_trunc_holds = l_inf_norm = b_trunc\n\n        # 4. Compute C_{s,n}(I) and the exact index-set bound B_I\n        c_I_sq_sum = np.sum(1.0 / (1 + k_norms_sq)**s)\n        c_I = np.sqrt(c_I_sq_sum)\n        b_I = c_I * h_s_norm\n        ineq_I_holds = l_inf_norm = b_I\n\n        results.append([\n            float(h_s_norm), float(l_inf_norm),\n            float(b_trunc), bool(ineq_trunc_holds),\n            float(b_I), bool(ineq_I_holds)\n        ])\n\n    # Format the output as a list of lists.\n    output_str_parts = []\n    for res_list in results:\n        res_str = (\n            f\"[{res_list[0]},{res_list[1]},{res_list[2]},\"\n            f\"{str(res_list[3]).lower()},{res_list[4]},{str(res_list[5]).lower()}]\"\n        )\n        output_str_parts.append(res_str)\n        \n    print(f\"[{','.join(output_str_parts)}]\")\n\nsolve()\n```", "id": "3414954"}, {"introduction": "Sobolev嵌入定理在偏微分方程数值方法的稳定性与误差分析中扮演着核心角色，尤其是在间断Galerkin（DG）方法中。然而，标准理论的应用通常依赖于网格的“形状规则性”假设。本练习是一个具有警示意义的实践，它将揭示当网格具有不断增长的各向异性时，标准的迹不等式（一种边界上的Sobolev嵌入）将如何失效，从而突显了学习和应用更高级的各向异性嵌入理论在现代科学计算中的必要性。[@problem_id:3414934]", "problem": "考虑一个由轴对齐矩形组成的不连续Galerkin网格族。设单个单元为矩形 $K = [0,h_x] \\times [0,h_y]$，其中 $h_x  0$ 和 $h_y  0$ 分别是 $x$ 和 $y$ 方向上的边长。令迹算子将函数 $v \\in H^1(K)$（具有平方可积弱梯度的平方可积函数构成的Sobolev空间）映射到其在 $\\partial K$ 上的边界值，并考虑用于形状规则族上的标准各向同性迹控制：对于单元尺寸参数 $h := \\max\\{h_x, h_y\\}$，一个典型的各向同性界旨在通过体范数来控制边界范数，其形式为\n$$\n\\| v \\|_{L^2(\\partial K)}^2 \\leq C \\left( h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2 \\right),\n$$\n其中常数 $C$ 在整个网格序列上是一致的。在不连续Galerkin内部罚格式中，分段函数 $u$ 跨越长度为 $\\ell_F$ 的内部面 $F$ 的跳跃项由一个形如下式的项来惩罚\n$$\n\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds,\n$$\n其中 $[u]$ 是迹跳跃，$\\sigma  0$ 是一个固定的罚参数，$h_F$ 是一个各向同性面尺寸，其选择与相邻单元上的 $h$ 一致，通常取 $h_F = h$。已知当网格是形状规则的（长宽比一致有界）时，这些各向同性控制是稳定的，但随着各向异性的增长可能会失效。\n\n你的任务是构造并分析一个各向异性增长的网格序列，并数值上证明各向同性迹类型控制无法一致地界定边界项或跳跃项。请从以下基本基础出发：域和边界上 $L^2$ 范数的定义、弱梯度范数的定义，以及不连续Galerkin内部罚跳跃项的结构。不要使用现成的各向异性不等式；使用简单代表性函数的精确积分，从第一性原理推导出所有表达式。\n\n对于任意矩形 $K = [0,h_x] \\times [0,h_y]$ 和 $h = \\max\\{h_x,h_y\\}$，定义比率\n$$\nR(v; K) := \\frac{\\| v \\|_{L^2(\\partial K)}^2}{h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2},\n$$\n适用于以下三个测试函数\n- $v(x,y) = 1$,\n- $v(x,y) = x$,\n- $v(x,y) = y$。\n这些函数探查了相对于各向异性的不同方向性行为。\n\n另外，定义一个双单元不连续Galerkin配置，它由两个共享一个长度为 $h_y$ 的垂直内部面 $F$ 的相邻矩形 $K^-$ 和 $K^+$ 组成，这两个矩形分别为 $[0,h_x] \\times [0,h_y]$ 和 $[h_x,2h_x] \\times [0,h_y]$。考虑分段常数函数 $u$，使得 $u|_{K^-} = -1$ 和 $u|_{K^+} = 1$，罚参数 $\\sigma = 1$，以及各向同性面尺寸 $h_F = h := \\max\\{h_x,h_y\\}$。定义各向同性跳跃-体控制比率\n$$\nQ(h_x, h_y) := \\frac{\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds}{h^{-1} \\left( \\| u \\|_{L^2(K^-)}^2 + \\| u \\|_{L^2(K^+)}^2 \\right) + h \\left( \\| \\nabla u \\|_{L^2(K^-)}^2 + \\| \\nabla u \\|_{L^2(K^+)}^2 \\right)}.\n$$\n该比率量化了随着各向异性的增长，各向同性体控制在一致地界定跳跃项方面的失败程度。\n\n仅使用 $L^2$ 积分和边界积分的定义，以及给定测试函数的弱梯度即为其经典梯度这一事实，编写一个程序，为指定的单元尺寸精确计算比率 $R(v;K)$ 和 $Q(h_x,h_y)$。你的程序必须评估以下检验不同行为的测试套件：\n\n- 具有增长长宽比的各向异性序列，定义为 $h_x(n) = 2^{-n}$ 和 $h_y(n) = 2^{-2n}$，对于 $n \\in \\{1,3,5\\}$。对每个 $n$，计算最大值\n$$\nM(n) := \\max\\left\\{ R(1;K_n), R(x;K_n), R(y;K_n) \\right\\},\n$$\n其中 $K_n = [0,h_x(n)] \\times [0,h_y(n)]$，并计算\n$$\nQ(n) := Q\\left(h_x(n), h_y(n)\\right).\n$$\n\n- 一个形状规则（各向同性）的比较案例，其中 $h_x = h_y = 2^{-3}$。计算\n$$\nM_{\\mathrm{iso}} := \\max\\left\\{ R(1;K_{\\mathrm{iso}}), R(x;K_{\\mathrm{iso}}), R(y;K_{\\mathrm{iso}}) \\right\\},\n$$\n其中 $K_{\\mathrm{iso}} = [0,2^{-3}] \\times [0,2^{-3}]$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果：具体来说，\n$$\n\\left[ M(1), M(3), M(5), M_{\\mathrm{iso}}, Q(1), Q(3), Q(5) \\right].\n$$\n所有输出必须是实数（浮点数）。不涉及物理单位。不存在角度。将所有量表示为无量纲浮点数。确保你的程序是自包含的，无需输入，并且只使用执行环境中指定的库。", "solution": "该问题是有效的。它是一个适定的、有科学依据的数值方法分析练习，具体地从第一性原理证明了各向同性迹不等式在各向异性网格上的失效。\n\n任务是为一个具有增长各向异性的一系列矩形单元以及一个形状规则的比较案例计算两个比率 $R(v;K)$ 和 $Q(h_x, h_y)$。我们将通过从定义出发计算所需的积分，来推导这些比率的解析表达式。\n\n设矩形单元为 $K = [0, h_x] \\times [0, h_y]$，其中 $h_x  0$ 且 $h_y  0$。各向同性尺寸参数为 $h := \\max\\{h_x, h_y\\}$。比率 $R(v;K)$ 定义为：\n$$\nR(v; K) := \\frac{\\| v \\|_{L^2(\\partial K)}^2}{h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2}\n$$\n范数定义如下：\n- $\\| v \\|_{L^2(K)}^2 = \\int_K v^2 \\, dA = \\int_0^{h_y} \\int_0^{h_x} v(x,y)^2 \\, dx \\, dy$\n- $\\| \\nabla v \\|_{L^2(K)}^2 = \\int_K |\\nabla v|^2 \\, dA = \\int_0^{h_y} \\int_0^{h_x} \\left( (\\partial_x v)^2 + (\\partial_y v)^2 \\right) \\, dx \\, dy$\n- $\\| v \\|_{L^2(\\partial K)}^2 = \\int_{\\partial K} v^2 \\, ds$，即矩形四条边上积分的总和。\n\n我们对三个指定的测试函数计算这些项。\n\n**情况1：$v(x,y) = 1$**\n\n梯度为 $\\nabla v = (0, 0)$。\n$L^2(K)$ 范数的平方是：\n$$\n\\| v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} 1^2 \\, dx \\, dy = h_x h_y\n$$\n梯度的 $L^2(K)$ 范数的平方是：\n$$\n\\| \\nabla v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} (0^2 + 0^2) \\, dx \\, dy = 0\n$$\n$L^2(\\partial K)$ 范数的平方是在边界上对 $1^2$ 的积分，即矩形的周长：\n$$\n\\| v \\|_{L^2(\\partial K)}^2 = \\int_{\\partial K} 1^2 \\, ds = 2(h_x + h_y)\n$$\n将这些代入 $R$ 的定义中：\n$$\nR(1; K) = \\frac{2(h_x + h_y)}{h^{-1} (h_x h_y) + h (0)} = \\frac{2h(h_x + h_y)}{h_x h_y} = 2h \\left( \\frac{1}{h_y} + \\frac{1}{h_x} \\right)\n$$\n\n**情况2：$v(x,y) = x$**\n\n梯度为 $\\nabla v = (1, 0)$。\n$L^2(K)$ 范数的平方是：\n$$\n\\| v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} x^2 \\, dx \\, dy = h_y \\left[ \\frac{x^3}{3} \\right]_0^{h_x} = \\frac{h_x^3 h_y}{3}\n$$\n梯度的 $L^2(K)$ 范数的平方是：\n$$\n\\| \\nabla v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} (1^2 + 0^2) \\, dx \\, dy = h_x h_y\n$$\n$L^2(\\partial K)$ 范数的平方是四条边上积分的总和：\n- 底边（$y=0$, $x \\in [0, h_x]$）：$\\int_0^{h_x} x^2 \\, dx = \\frac{h_x^3}{3}$\n- 顶边（$y=h_y$, $x \\in [0, h_x]$）：$\\int_0^{h_x} x^2 \\, dx = \\frac{h_x^3}{3}$\n- 左边（$x=0$, $y \\in [0, h_y]$）：$\\int_0^{h_y} 0^2 \\, dy = 0$\n- 右边（$x=h_x$, $y \\in [0, h_y]$）：$\\int_0^{h_y} h_x^2 \\, dy = h_x^2 h_y$\n总和为 $\\| v \\|_{L^2(\\partial K)}^2 = \\frac{2h_x^3}{3} + h_x^2 h_y$。\n将这些代入 $R$ 的定义中：\n$$\nR(x; K) = \\frac{\\frac{2h_x^3}{3} + h_x^2 h_y}{h^{-1} \\left(\\frac{h_x^3 h_y}{3}\\right) + h (h_x h_y)} = \\frac{h_x^2(\\frac{2h_x}{3} + h_y)}{h_x h_y (\\frac{h^{-1} h_x^2}{3} + h)} = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h^{-1} h_x^2}{3} + h)}\n$$\n\n**情况3：$v(x,y) = y$**\n\n根据与情况 $v(x,y)=x$ 的对称性，我们可以交换 $h_x$ 和 $h_y$。梯度为 $\\nabla v = (0, 1)$。\n- $\\| v \\|_{L^2(K)}^2 = \\frac{h_x h_y^3}{3}$\n- $\\| \\nabla v \\|_{L^2(K)}^2 = h_x h_y$\n- $\\| v \\|_{L^2(\\partial K)}^2 = h_x h_y^2 + \\frac{2h_y^3}{3}$\n将这些代入 $R$ 的定义中：\n$$\nR(y; K) = \\frac{h_x h_y^2 + \\frac{2h_y^3}{3}}{h^{-1} \\left(\\frac{h_x h_y^3}{3}\\right) + h (h_x h_y)} = \\frac{h_y^2(h_x + \\frac{2h_y}{3})}{h_x h_y (\\frac{h^{-1} h_y^2}{3} + h)} = \\frac{h_y (h_x + \\frac{2h_y}{3})}{h_x (\\frac{h^{-1} h_y^2}{3} + h)}\n$$\n\n**比率 $Q(h_x, h_y)$ 的推导**\n\n该配置由两个单元 $K^- = [0,h_x] \\times [0,h_y]$ 和 $K^+ = [h_x,2h_x] \\times [0,h_y]$ 组成，它们共享一个长度为 $\\ell_F=h_y$ 的垂直内部面 $F = \\{h_x\\} \\times [0,h_y]$。分段函数为 $u|_{K^-} = -1$ 和 $u|_{K^+} = 1$。跨面的跳跃为 $[u] = u|_{K^+} - u|_{K^-} = 1 - (-1) = 2$。罚参数为 $\\sigma=1$，各向同性面尺寸为 $h_F = h = \\max\\{h_x,h_y\\}$。\n比率 $Q$ 定义为：\n$$\nQ(h_x, h_y) := \\frac{\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds}{h^{-1} \\left( \\| u \\|_{L^2(K^-)}^2 + \\| u \\|_{L^2(K^+)}^2 \\right) + h \\left( \\| \\nabla u \\|_{L^2(K^-)}^2 + \\| \\nabla u \\|_{L^2(K^+)}^2 \\right)}\n$$\n分子是：\n$$\n\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds = \\frac{1}{h} \\cdot 2^2 \\int_0^{h_y} \\, ds = \\frac{4}{h} h_y\n$$\n对于分母，我们计算范数。由于 $u$ 是分段常数，其在每个单元内的弱梯度为零，因此 $\\| \\nabla u \\|_{L^2(K^-)}^2 = 0$ 且 $\\| \\nabla u \\|_{L^2(K^+)}^2 = 0$。\n$L^2$ 范数是：\n$$\n\\| u \\|_{L^2(K^-)}^2 = \\int_{K^-} (-1)^2 \\, dA = \\text{Area}(K^-) = h_x h_y\n$$\n$$\n\\| u \\|_{L^2(K^+)}^2 = \\int_{K^+} (1)^2 \\, dA = \\text{Area}(K^+) = h_x h_y\n$$\n因此分母是：\n$$\nh^{-1} (h_x h_y + h_x h_y) + h(0+0) = \\frac{2h_x h_y}{h}\n$$\n比率 $Q$ 是：\n$$\nQ(h_x, h_y) = \\frac{\\frac{4h_y}{h}}{\\frac{2h_x h_y}{h}} = \\frac{4h_y}{2h_x h_y} = \\frac{2}{h_x}\n$$\n这个结果表明比率 $Q$ 与 $h_y$ 无关，并且当 $h_x \\to 0$ 时趋于无穷大。\n\n**数值评估**\n\n我们现在将这些公式应用于指定的测试案例。\n\n_各向异性序列_：$h_x(n) = 2^{-n}$ 和 $h_y(n) = 2^{-2n}$，对于 $n \\in \\{1, 3, 5\\}$。\n对于 $n \\ge 1$，我们有 $2n  n$，所以 $2^{-2n}  2^{-n}$，这意味着 $h_y  h_x$。因此，$h = \\max\\{h_x, h_y\\} = h_x$。长宽比为 $h_x/h_y = 2^n$，它随着 $n$ 的增长而增长。\n我们在 $R$ 的公式中使用 $h=h_x$：\n- $R(1; K_n) = \\frac{2h_x(h_x + h_y)}{h_x h_y} = \\frac{2(h_x+h_y)}{h_y} = 2(\\frac{h_x}{h_y}+1) = 2(2^n+1)$.\n- $R(x; K_n) = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h_x^{-1} h_x^2}{3} + h_x)} = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h_x}{3} + h_x)} = \\frac{h_x(\\frac{2h_x}{3} + h_y)}{h_y(\\frac{4h_x}{3})} = \\frac{2h_x+3h_y}{4h_y} = \\frac{1}{2}\\frac{h_x}{h_y} + \\frac{3}{4} = \\frac{1}{2}2^n + \\frac{3}{4}$.\n- $R(y; K_n) = \\frac{h_y (h_x + \\frac{2h_y}{3})}{h_x (\\frac{h_x^{-1} h_y^2}{3} + h_x)} = \\frac{h_y(h_x + \\frac{2}{3}h_y)}{h_x^2 + h_y^2/3}$.\n$R(1; K_n) = 2^{n+1}+2$ 且 $R(x; K_n) = 2^{n-1}+0.75$。对于 $n \\ge 1$，$R(1; K_n)$ 更大。当 $n \\to \\infty$ 时，$R(y; K_n)$ 趋近于 $0$。因此，$M(n) = \\max\\{R(1;K_n), R(x;K_n), R(y;K_n)\\} = 2(2^n+1)$。\n- 对于 $n=1$：$M(1) = 2(2^1+1) = 6$。\n- 对于 $n=3$：$M(3) = 2(2^3+1) = 18$。\n- 对于 $n=5$：$M(5) = 2(2^5+1) = 66$。\n\n对于 $Q(n)$，我们有 $Q(n) = 2/h_x(n) = 2/2^{-n} = 2^{n+1}$。\n- 对于 $n=1$：$Q(1) = 2^{1+1} = 4$。\n- 对于 $n=3$：$Q(3) = 2^{3+1} = 16$。\n- 对于 $n=5$：$Q(5) = 2^{5+1} = 64$。\n\n_各向同性案例_：$h_x = h_y = 2^{-3}$。此处 $h=h_x=h_y$。我们称这个尺寸为 $H$。\n- $R(1; K_{\\mathrm{iso}}) = \\frac{2H(H+H)}{H \\cdot H} = \\frac{4H^2}{H^2} = 4$。\n- $R(x; K_{\\mathrm{iso}}) = \\frac{H(\\frac{2H}{3} + H)}{H(\\frac{H^{-1}H^2}{3} + H)} = \\frac{H(5H/3)}{H(4H/3)} = \\frac{5}{4} = 1.25$。\n- $R(y; K_{\\mathrm{iso}}) = R(x; K_{\\mathrm{iso}}) = 1.25$ 根据对称性。\n因此，$M_{\\mathrm{iso}} = \\max\\{4, 1.25, 1.25\\} = 4$。\n\n最终的结果列表是 $[M(1), M(3), M(5), M_{\\mathrm{iso}}, Q(1), Q(3), Q(5)]$。\n- $M(1) = 6.0$\n- $M(3) = 18.0$\n- $M(5) = 66.0$\n- $M_{\\mathrm{iso}} = 4.0$\n- $Q(1) = 4.0$\n- $Q(3) = 16.0$\n- $Q(5) = 64.0$\n这些值清楚地表明，对于各向异性网格序列，比率 $R$ 和 $Q$ 不是一致有界的，这证实了各向同性控制的失效。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_R(v_type, hx, hy):\n    \"\"\"\n    Computes the ratio R(v; K) for a given test function type and element dimensions.\n\n    R(v; K) = ||v||^2_L2(dK) / (h^-1 ||v||^2_L2(K) + h ||grad v||^2_L2(K))\n    \"\"\"\n    if not (hx > 0 and hy > 0):\n        # This case should not be reached with the problem's inputs\n        raise ValueError(\"Element dimensions hx and hy must be positive.\")\n        \n    h = max(hx, hy)\n\n    if v_type == '1':\n        # v(x,y) = 1\n        # Numerator: ||v||^2_L2(dK) = Perimeter = 2*(hx+hy)\n        num = 2.0 * (hx + hy)\n        # Denominator:\n        # ||v||^2_L2(K) = hx*hy\n        # ||grad v||^2_L2(K) = 0\n        den = (1.0 / h) * (hx * hy)\n        if den == 0.0: return np.inf\n        return num / den\n\n    elif v_type == 'x':\n        # v(x,y) = x\n        # Numerator: ||v||^2_L2(dK) = integral of x^2 over boundary\n        num = (2.0/3.0) * hx**3 + hx**2 * hy\n        # Denominator:\n        # ||v||^2_L2(K) = integral of x^2 over K = hx^3 * hy / 3\n        v_norm_sq = (hx**3 * hy) / 3.0\n        # ||grad v||^2_L2(K) = integral of 1^2 over K = hx*hy\n        grad_v_norm_sq = hx * hy\n        den = (1.0 / h) * v_norm_sq + h * grad_v_norm_sq\n        if den == 0.0: return np.inf\n        return num / den\n\n    elif v_type == 'y':\n        # v(x,y) = y\n        # Numerator: ||v||^2_L2(dK) = integral of y^2 over boundary\n        num = hx * hy**2 + (2.0/3.0) * hy**3\n        # Denominator:\n        # ||v||^2_L2(K) = integral of y^2 over K = hx * hy^3 / 3\n        v_norm_sq = (hx * hy**3) / 3.0\n        # ||grad v||^2_L2(K) = integral of 1^2 over K = hx*hy\n        grad_v_norm_sq = hx * hy\n        den = (1.0 / h) * v_norm_sq + h * grad_v_norm_sq\n        if den == 0.0: return np.inf\n        return num / den\n\n    else:\n        raise ValueError(\"Invalid v_type specified. Must be '1', 'x', or 'y'.\")\n\ndef calculate_Q(hx, hy):\n    \"\"\"\n    Computes the ratio Q(hx, hy) for given element dimensions.\n    Based on the analytical derivation, Q(hx, hy) = 2/hx.\n    \"\"\"\n    if hx == 0.0: return np.inf\n    return 2.0 / hx\n\ndef solve():\n    \"\"\"\n    Main function to compute and print the results for the problem.\n    \"\"\"\n    \n    # Define test cases from the problem statement.\n    test_n = [1, 3, 5]\n    \n    m_anisotropic_results = []\n    q_anisotropic_results = []\n\n    # Anisotropic sequence calculation\n    for n in test_n:\n        hx = 2.0**(-n)\n        hy = 2.0**(-2*n)\n\n        # Calculate M(n)\n        r_1 = calculate_R('1', hx, hy)\n        r_x = calculate_R('x', hx, hy)\n        r_y = calculate_R('y', hx, hy)\n        m_n = max(r_1, r_x, r_y)\n        m_anisotropic_results.append(m_n)\n\n        # Calculate Q(n)\n        q_n = calculate_Q(hx, hy)\n        q_anisotropic_results.append(q_n)\n\n    # Isotropic comparison case calculation\n    hx_iso = 2.0**(-3)\n    hy_iso = 2.0**(-3)\n    \n    r_1_iso = calculate_R('1', hx_iso, hy_iso)\n    r_x_iso = calculate_R('x', hx_iso, hy_iso)\n    r_y_iso = calculate_R('y', hx_iso, hy_iso)\n    m_iso = max(r_1_iso, r_x_iso, r_y_iso)\n\n    # Assemble the final list in the required order\n    # [ M(1), M(3), M(5), M_iso, Q(1), Q(3), Q(5) ]\n    final_results = [\n        m_anisotropic_results[0],\n        m_anisotropic_results[1],\n        m_anisotropic_results[2],\n        m_iso,\n        q_anisotropic_results[0],\n        q_anisotropic_results[1],\n        q_anisotropic_results[2],\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3414934"}]}