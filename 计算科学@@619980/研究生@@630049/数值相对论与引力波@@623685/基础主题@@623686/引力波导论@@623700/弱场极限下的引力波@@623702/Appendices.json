{"hands_on_practices": [{"introduction": "在弱场近似下，度规扰动 $h_{\\mu\\nu}$ 包含了非物理的规范自由度。为了分离出真正传播的引力自由度，我们必须将度规的空间部分投影到其横向无迹（TT）部分。这个练习 ([@problem_id:3476552]) 提供了推导并应用TT投影算符的直接实践，这是引力波理论分析中一项至关重要的数学技能。", "problem": "考虑在弱场近似下闵可夫斯基时空中的线性化引力，其中通过对空间对称二阶张量施加横向无迹 (TT) 条件来分离引力波内容。设传播方向为单位矢量 $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)$，且对称空间张量为\n$$\nS_{ij}(t) \\equiv \\begin{pmatrix}\n2\\cos(\\Omega t) & \\sin(\\Omega t) & \\cos(\\Omega t) \\\\\n\\sin(\\Omega t) & -\\cos(\\Omega t) + \\sin(\\Omega t) & 2\\sin(\\Omega t) \\\\\n\\cos(\\Omega t) & 2\\sin(\\Omega t) & 3\\cos(\\Omega t)\n\\end{pmatrix},\n$$\n其中 $\\Omega$ 是一个恒定的角频率，$t$ 是坐标时。\n\n从广义相对论 (GR) 弱场近似中平面波的 TT 条件的定义出发——即 TT 部分 $S^{TT}_{ij}$ 与传播方向横向（正交），$\\hat{n}^{i} S^{TT}_{ij} = 0$，并且相对于空间欧几里得度规是无迹的，$\\delta^{ij} S^{TT}_{ij} = 0$——利用到与 $\\hat{n}$ 正交的平面上的空间投影算符，推导将任意对称空间张量 $S_{ij}$ 映射到其 TT 部分 $S^{TT}_{ij}$ 的 TT 投影算符。然后将您推导出的投影算符应用于上面给出的特定 $S_{ij}(t)$ 和 $\\hat{n}$，以获得 $S^{TT}_{ij}(t)$ 的一个用 $\\sin(\\Omega t)$ 和 $\\cos(\\Omega t)$ 表示的 $3\\times 3$ 矩阵的显式闭合形式表达式。\n\n将您的最终答案表示为单个闭合形式的解析 $3\\times 3$ 矩阵。不需要数值近似或四舍五入，也不应包含任何物理单位。", "solution": "- **引言：** 陈述目标是推导 TT 投影算符并将其应用于给定的张量 $S_{ij}$。\n- **TT 投影算符的推导：**\n    - 从一个任意的对称空间张量 $S_{ij}$ 开始。\n    - 目标是获得满足两个条件 $S^{TT}_{ij}$：$\\hat{n}^i S^{TT}_{ij} = 0$ 和 $\\delta^{ij} S^{TT}_{ij} = 0$。\n    - 投影是一个两步过程。\n    - **步骤 A：投影到与 $\\hat{n}$ 正交的平面上。**\n        - 将到 $\\hat{n}$ 方向上的投影算符定义为 $\\hat{n}_i \\hat{n}_j$。\n        - 到与 $\\hat{n}$ 正交的平面上的投影算符是 $P_{ij} = \\delta_{ij} - \\hat{n}_i \\hat{n}_j$。这里，$\\delta_{ij}$ 是克罗内克δ（或欧几里得度规）。\n        - 将此投影算符两次应用于 $S_{kl}$ 会得到一个横向张量。我们称之为 $S'_{ij}$。\n        - $S'_{ij} = P_{ik} P_{jl} S_{kl}$。根据构造，该张量是对称和横向的。\n        - 让我们验证横向性：$\\hat{n}^i S'_{ij} = \\hat{n}^i P_{ik} P_{jl} S_{kl} = (\\hat{n}^i (\\delta_{ik} - \\hat{n}_i \\hat{n}_k)) P_{jl} S_{kl} = (\\hat{n}_k - \\hat{n}_k (\\hat{n}^i\\hat{n}_i)) P_{jl} S_{kl}$。由于 $\\hat{n}^i\\hat{n}_i = 1$，这变为 $(n_k - n_k) P_{jl} S_{kl} = 0$。所以，$S'_{ij}$ 是横向的。\n    - **步骤 B：使张量无迹。**\n        - 横向张量 $S'_{ij}$ 通常不是无迹的。它的迹是 $S' = \\delta^{ij} S'_{ij}$。\n        - 我们需要从 $S'_{ij}$ 中减去一部分使其无迹，同时不破坏其横向性。\n        - 要减去的部分必须是 $C \\cdot P_{ij}$ 的形式，其中 $C$ 是一个标量，因为 $P_{ij}$ 是横向平面上的“单位算符”。$\\hat{n}^i P_{ij} = 0$。所以减去 $P_{ij}$ 的倍数会保持横向性。\n        - 设 $S^{TT}_{ij} = S'_{ij} - C \\cdot P_{ij}$。\n        - 条件是 $\\delta^{ij} S^{TT}_{ij} = 0$。\n        - $0 = \\delta^{ij} (S'_{ij} - C P_{ij}) = \\delta^{ij} S'_{ij} - C \\delta^{ij} P_{ij}$。\n        - $0 = S' - C (\\delta^{ij} (\\delta_{ij} - \\hat{n}_i \\hat{n}_j)) = S' - C (\\delta^{ii} - \\hat{n}^j \\hat{n}_j)$。\n        - 在 3 维空间中，$\\delta^{ii} = 3$。且 $\\hat{n}^j \\hat{n}_j = 1$。\n        - 所以，$0 = S' - C (3-1) = S' - 2C$。\n        - 这得出 $C = \\frac{1}{2} S'$。\n        - 因此，$S^{TT}_{ij} = S'_{ij} - \\frac{1}{2} S' P_{ij}$。\n    - **合并步骤：**\n        - $S^{TT}_{ij} = P_{ik} P_{jl} S_{kl} - \\frac{1}{2} (\\delta^{ab} P_{ac} P_{bd} S_{cd}) P_{ij}$。\n        - 这就是 TT 投影算符，通常表示为 $\\Lambda_{ijkl}$。所以 $S^{TT}_{ij} = \\Lambda_{ijkl} S_{kl}$。\n        - $\\Lambda_{ijkl} = P_{ik}P_{jl} - \\frac{1}{2} P_{ij} P_{kl}$。这是 TT 投影算符的标准形式。\n- **应用于具体问题：**\n    - **给定：** $\\hat{n} = \\frac{1}{\\sqrt{3}}(1, 1, 1)$。\n    - 投影算符 $P_{ij} = \\delta_{ij} - \\hat{n}_i \\hat{n}_j$。\n    - $\\hat{n}_i \\hat{n}_j = \\frac{1}{3} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & 1 \\end{pmatrix}$。\n    - $P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 1 \\\\ 1 & 1 & 1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$。\n    - 张量 $S_{ij}(t)$ 已给定。我们将其写为 $S$。\n    - **步骤 A：计算 $S' = P S P^T$。** 由于 $P$ 是对称的，所以 $P^T = P$。因此 $S' = P S P$。\n        - 让我们进行矩阵乘法。这会有点繁琐。\n        - $S = \\begin{pmatrix} 2c & s & c \\\\ s & -c+s & 2s \\\\ c & 2s & 3c \\end{pmatrix}$，其中 $c = \\cos(\\Omega t)$，$s = \\sin(\\Omega t)$。\n        - 首先，计算 $SP$。\n        - $SP = \\begin{pmatrix} 2c & s & c \\\\ s & -c+s & 2s \\\\ c & 2s & 3c \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$\n        - $(SP)_{11} = \\frac{1}{3} (4c - s - c) = \\frac{1}{3} (3c - s)$\n        - $(SP)_{12} = \\frac{1}{3} (-2c + 2s - c) = \\frac{1}{3} (-3c + 2s)$\n        - $(SP)_{13} = \\frac{1}{3} (-2c - s + 2c) = \\frac{1}{3} (-s)$\n        - $(SP)_{21} = \\frac{1}{3} (2s - (-c+s) - 2s) = \\frac{1}{3} (-s+c)$\n        - $(SP)_{22} = \\frac{1}{3} (-s + 2(-c+s) - 2s) = \\frac{1}{3} (-s - 2c + 2s - 2s) = \\frac{1}{3} (-s - 2c)$\n        - $(SP)_{23} = \\frac{1}{3} (-s - (-c+s) + 4s) = \\frac{1}{3} (-s+c-s+4s) = \\frac{1}{3} (2s+c)$\n        - $(SP)_{31} = \\frac{1}{3} (2c - 2s - 3c) = \\frac{1}{3} (-c-2s)$\n        - $(SP)_{32} = \\frac{1}{3} (-c + 4s - 3c) = \\frac{1}{3} (-4c+4s)$\n        - $(SP)_{33} = \\frac{1}{3} (-c - 2s + 6c) = \\frac{1}{3} (5c-2s)$\n        - $SP = \\frac{1}{3} \\begin{pmatrix} 3c-s & -3c+2s & -s \\\\ -s+c & -s-2c & 2s+c \\\\ -c-2s & -4c+4s & 5c-2s \\end{pmatrix}$\n        - 现在，计算 $S' = P(SP)$。\n        - $S' = \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 3c-s & -3c+2s & -s \\\\ -s+c & -s-2c & 2s+c \\\\ -c-2s & -4c+4s & 5c-2s \\end{pmatrix}$\n        - $S' = \\frac{1}{9} \\begin{pmatrix} \\dots & \\dots & \\dots \\\\ \\dots & \\dots & \\dots \\\\ \\dots & \\dots & \\dots \\end{pmatrix}$\n        - $(S')_{11} = 2(3c-s) - (-s+c) - (-c-2s) = 6c-2s+s-c+c+2s = 6c+s$\n        - $(S')_{12} = 2(-3c+2s) - (-s-2c) - (-4c+4s) = -6c+4s+s+2c+4c-4s = s$\n        - $(S')_{13} = 2(-s) - (2s+c) - (5c-2s) = -2s-2s-c-5c+2s = -6c-2s$\n        - 我们来检查对称性。$(S')_{21}$ 应该等于 $(S')_{12}$。\n        - $(S')_{21} = -(3c-s) + 2(-s+c) - (-c-2s) = -3c+s-2s+2c+c+2s = s$。正确。\n        - $(S')_{22} = -(-3c+2s) + 2(-s-2c) - (-4c+4s) = 3c-2s-2s-4c+4c-4s = 3c-8s$\n        - $(S')_{23} = -(-s) + 2(2s+c) - (5c-2s) = s+4s+2c-5c+2s = 7s-3c$\n        - 检查 $(S')_{31} = (S')_{13}$。\n        - $(S')_{31} = -(3c-s) - (-s+c) + 2(-c-2s) = -3c+s+s-c-2c-4s = -6c-2s$。正确。\n        - 检查 $(S')_{32} = (S')_{23}$。\n        - $(S')_{32} = -(-3c+2s) - (-s-2c) + 2(-4c+4s) = 3c-2s+s+2c-8c+8s = -3c+7s$。正确。\n        - $(S')_{33} = -(-s) - (2s+c) + 2(5c-2s) = s-2s-c+10c-4s = 9c-5s$\n        - 所以，$S' = \\frac{1}{9} \\begin{pmatrix} 6c+s & s & -6c-2s \\\\ s & 3c-8s & -3c+7s \\\\ -6c-2s & -3c+7s & 9c-5s \\end{pmatrix}$。\n        \n    - **步骤 B：使其无迹。**\n        - 计算 $S'$ 的迹。$S' = \\delta^{ij} S'_{ij} = (S')_{11} + (S')_{22} + (S')_{33}$。\n        - $S' = \\frac{1}{9} [ (6c+s) + (3c-8s) + (9c-5s) ] = \\frac{1}{9} [ (6+3+9)c + (1-8-5)s ]$\n        - $S' = \\frac{1}{9} [ 18c - 12s ] = \\frac{6}{9} (3c - 2s) = \\frac{2}{3} (3c - 2s)$。\n        - 要减去的项是 $\\frac{1}{2} S' P$。\n        - $\\frac{1}{2} S' = \\frac{1}{3} (3c-2s)$。\n        - $\\frac{1}{2} S' P = \\frac{1}{3}(3c-2s) \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\frac{3c-2s}{9} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$。\n        - 所以 $S^{TT} = S' - \\frac{1}{2} S' P$。\n        - $S^{TT} = \\frac{1}{9} \\begin{pmatrix} 6c+s & s & -6c-2s \\\\ s & 3c-8s & -3c+7s \\\\ -6c-2s & -3c+7s & 9c-5s \\end{pmatrix} - \\frac{1}{9} \\begin{pmatrix} 2(3c-2s) & -(3c-2s) & -(3c-2s) \\\\ -(3c-2s) & 2(3c-2s) & -(3c-2s) \\\\ -(3c-2s) & -(3c-2s) & 2(3c-2s) \\end{pmatrix}$\n        - $S^{TT} = \\frac{1}{9} \\begin{pmatrix} (6c+s) - (6c-4s) & s - (-3c+2s) & (-6c-2s) - (-3c+2s) \\\\ s - (-3c+2s) & (3c-8s) - (6c-4s) & (-3c+7s) - (-3c+2s) \\\\ (-6c-2s) - (-3c+2s) & (-3c+7s) - (-3c+2s) & (9c-5s) - (6c-4s) \\end{pmatrix}$\n        - 让我们计算分量。\n        - $(S^{TT})_{11} = \\frac{1}{9} (5s)$\n        - $(S^{TT})_{12} = \\frac{1}{9} (s+3c-2s) = \\frac{1}{9} (3c-s)$\n        - $(S^{TT})_{13} = \\frac{1}{9} (-6c-2s+3c-2s) = \\frac{1}{9}(-3c-4s)$\n        - $(S^{TT})_{21} = (S^{TT})_{12} = \\frac{1}{9}(3c-s)$。很好，对称性成立。\n        - $(S^{TT})_{22} = \\frac{1}{9} (3c-8s - 6c+4s) = \\frac{1}{9} (-3c-4s)$\n        - $(S^{TT})_{23} = \\frac{1}{9} (-3c+7s+3c-2s) = \\frac{1}{9}(5s)$\n        - $(S^{TT})_{31} = (S^{TT})_{13} = \\frac{1}{9}(-3c-4s)$。很好。\n        - $(S^{TT})_{32} = \\frac{1}{9} (-3c+7s+3c-2s) = \\frac{1}{9}(5s)$。\n        - $(S^{TT})_{33} = \\frac{1}{9} (9c-5s - 6c+4s) = \\frac{1}{9} (3c-s)$。\n        \n        所以得到的矩阵是：\n        $$ S^{TT} = \\frac{1}{9} \\begin{pmatrix} 5s & 3c-s & -3c-4s \\\\ 3c-s & -3c-4s & 5s \\\\ -3c-4s & 5s & 3c-s \\end{pmatrix} $$\n        - **对 $S^{TT}$ 的最终检查：**\n            - **1. 无迹条件：** $\\mathrm{Tr}(S^{TT}) = 0$？\n              $\\mathrm{Tr}(S^{TT}) = \\frac{1}{9}[ (5s) + (-3c-4s) + (3c-s) ] = \\frac{1}{9}[ 5s - 3c - 4s + 3c - s ] = \\frac{1}{9}[ (5-4-1)s + (-3+3)c ] = \\frac{1}{9}[0] = 0$。\n              无迹条件成立。这是一个非常重要的检查。\n            - **2. 横向条件：** $\\hat{n}_i S^{TT}_{ij} = 0$？\n              这等价于检查每一列（或行）的分量之和是否为零，因为 $\\hat{n} = \\frac{1}{\\sqrt{3}}(1,1,1)$。\n              让我们检查第一列（乘以 $\\frac{1}{9}$）：\n              $ (5s) + (3c-s) + (-3c-4s) = 5s+3c-s-3c-4s = (5-1-4)s + (3-3)c = 0$。\n              第一列是横向的。\n              让我们检查第二列：\n              $ (3c-s) + (-3c-4s) + (5s) = 3c-s-3c-4s+5s = (-1-4+5)s + (3-3)c = 0$。\n              第二列是横向的。\n              由于对称性，我们只需要再检查一个。让我们检查第三列：\n              $ (-3c-4s) + (5s) + (3c-s) = -3c-4s+5s+3c-s = (-4+5-1)s + (-3+3)c = 0$。\n              第三列是横向的。\n              所以横向条件也成立。\n              我的计算似乎是正确的。\n\n        $S^{TT}_{ij}(t) = \\frac{1}{9} \\begin{pmatrix} 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) \\\\ 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) \\\\ -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) \\end{pmatrix}$", "answer": "$$ \\boxed{ \\frac{1}{9} \\begin{pmatrix} 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) \\\\ 3\\cos(\\Omega t)-\\sin(\\Omega t) & -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) \\\\ -3\\cos(\\Omega t)-4\\sin(\\Omega t) & 5\\sin(\\Omega t) & 3\\cos(\\Omega t)-\\sin(\\Omega t) \\end{pmatrix} } $$", "id": "3476552"}, {"introduction": "一旦我们分离出物理的引力波分量，就可以研究它们的内在属性。$h_+$ 和 $h_\\times$ 这两种极化在观测者坐标系旋转下的变换方式，揭示了引力相互作用的基本性质。通过这个练习 ([@problem_id:3476585])，你将亲自推导出这个变换关系，并从中发现引力波作为一种自旋为$2$的场的确凿证据。", "problem": "在广义相对论 (GR) 的弱场线性化近似下，一个平面引力波由形式为 $g_{\\mu \\nu} = \\eta_{\\mu \\nu} + h_{\\mu \\nu}$ 的度规建模，其中 $|h_{\\mu \\nu}| \\ll 1$。这里 $\\eta_{\\mu \\nu}$ 是 Minkowski 度规，$h_{\\mu \\nu}$ 是度规微扰。在横向无迹 (TT) 规范下，对于一个沿 $\\hat{\\boldsymbol{z}}$ 方向传播的波，$h_{ij}$ 的非零分量位于与 $\\hat{\\boldsymbol{z}}$ 正交的平面内，并且可以相对于一个标准正交横向基 $\\{\\hat{\\boldsymbol{x}},\\hat{\\boldsymbol{y}}\\}$ 分解为\n$$\nh_{ij}(t-z) = h_{+}(t-z)\\, e^{+}_{ij} + h_{\\times}(t-z)\\, e^{\\times}_{ij},\n$$\n其中极化张量定义为\n$$\ne^{+}_{ij} = \\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}, \\quad e^{\\times}_{ij} = \\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j}.\n$$\n考虑横向基向量绕 $\\hat{\\boldsymbol{z}}$ 轴旋转一个角度 $\\psi$（以弧度为单位），\n$$\n\\hat{\\boldsymbol{x}}' = \\cos\\psi\\, \\hat{\\boldsymbol{x}} + \\sin\\psi\\, \\hat{\\boldsymbol{y}}, \\qquad \\hat{\\boldsymbol{y}}' = -\\sin\\psi\\, \\hat{\\boldsymbol{x}} + \\cos\\psi\\, \\hat{\\boldsymbol{y}}.\n$$\n设 $e^{+}_{ij}$ 和 $e^{\\times}_{ij}$ 相对于旋转后的基 $\\{\\hat{\\boldsymbol{x}}',\\hat{\\boldsymbol{y}}'\\}$ 被重新定义，并设 $h_{+}'$ 和 $h_{\\times}'$ 表示在旋转后的基中相应的极化振幅，定义为 $h_{ij} = h_{+}'\\, e^{+}_{ij}{}' + h_{\\times}'\\, e^{\\times}_{ij}{}'$。\n\n仅从上述定义出发，推导在角度为 $\\psi$ 的旋转下，对 $(h_{+},h_{\\times})$ 是如何混合的。将您的最终结果表示为复应变组合 $h^{\\mathrm{c}} := h_{+} + i h_{\\times}$ 的单个闭合形式解析表达式，建立 $h^{\\mathrm{c}}{}'$ 与 $h^{\\mathrm{c}}$ 和 $\\psi$ 之间的关系。请提供精确的符号表达式；无需数值近似或舍入。在您的最终答案中，角度 $\\psi$ 以弧度为单位。", "solution": "问题陈述已经过验证，并被认为是合理的。它科学地植根于广义相对论的原理，特别是弱场近似下的引力波理论。该问题是良定的，提供了推导唯一解所需的所有必要定义和约束。术语精确客观。不存在矛盾、模糊或事实不准确之处。因此，将提供一个解答。\n\n问题的核心是确定极化振幅 $h_{+}$ 和 $h_{\\times}$ 在横向空间基向量旋转下的变换方式。物理的度规微扰张量 $h_{ij}$ 是一个不变量，这意味着它的表示可以随基底的改变而改变，但张量本身不变。这种不变性使我们可以将 $h_{ij}$ 在原始基和旋转后的基中的表达式等同起来。\n\n设原始基为 $\\{\\hat{\\boldsymbol{x}}, \\hat{\\boldsymbol{y}}\\}$，旋转后的基为 $\\{\\hat{\\boldsymbol{x}}', \\hat{\\boldsymbol{y}}'\\}$。度规微扰张量 $h_{ij}$ 可以在任一基中表示：\n$$\nh_{ij} = h_{+}(t-z)\\, e^{+}_{ij} + h_{\\times}(t-z)\\, e^{\\times}_{ij} = h_{+}'(t-z)\\, e^{+}_{ij}{}' + h_{\\times}'(t-z)\\, e^{\\times}_{ij}{}'\n$$\n此处，$e^{+}_{ij}$ 和 $e^{\\times}_{ij}$ 是原始基中的极化张量，而 $e^{+}_{ij}{}'$ 和 $e^{\\times}_{ij}{}'$ 是旋转后的基中相应的张量。为了找到 $(h_{+}, h_{\\times})$ 和 $(h_{+}', h_{\\times}')$ 之间的关系，我们必须首先用原始极化张量表示旋转后的极化张量。\n\n旋转后的基向量由下式给出：\n$$\n\\hat{\\boldsymbol{x}}' = \\cos\\psi\\, \\hat{\\boldsymbol{x}} + \\sin\\psi\\, \\hat{\\boldsymbol{y}}\n$$\n$$\n\\hat{\\boldsymbol{y}}' = -\\sin\\psi\\, \\hat{\\boldsymbol{x}} + \\cos\\psi\\, \\hat{\\boldsymbol{y}}\n$$\n旋转后的极化张量定义为：\n$$\ne^{+}_{ij}{}' = \\hat{x}'_{i}\\hat{x}'_{j} - \\hat{y}'_{i}\\hat{y}'_{j}\n$$\n$$\ne^{\\times}_{ij}{}' = \\hat{x}'_{i}\\hat{y}'_{j} + \\hat{y}'_{i}\\hat{x}'_{j}\n$$\n我们将 $\\hat{\\boldsymbol{x}}'$ 和 $\\hat{\\boldsymbol{y}}'$ 的表达式代入这些定义中。\n\n首先，对于 $e^{+}_{ij}{}'$：\n项 $\\hat{x}'_{i}\\hat{x}'_{j}$ 为：\n$$\n\\hat{x}'_{i}\\hat{x}'_{j} = (\\cos\\psi\\, \\hat{x}_{i} + \\sin\\psi\\, \\hat{y}_{i})(\\cos\\psi\\, \\hat{x}_{j} + \\sin\\psi\\, \\hat{y}_{j}) = \\cos^{2}\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\sin^{2}\\psi\\, \\hat{y}_{i}\\hat{y}_{j} + \\sin\\psi\\cos\\psi\\, (\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\n项 $\\hat{y}'_{i}\\hat{y}'_{j}$ 为：\n$$\n\\hat{y}'_{i}\\hat{y}'_{j} = (-\\sin\\psi\\, \\hat{x}_{i} + \\cos\\psi\\, \\hat{y}_{i})(-\\sin\\psi\\, \\hat{x}_{j} + \\cos\\psi\\, \\hat{y}_{j}) = \\sin^{2}\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\cos^{2}\\psi\\, \\hat{y}_{i}\\hat{y}_{j} - \\sin\\psi\\cos\\psi\\, (\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\n从第一个式子中减去第二个式子，得到 $e^{+}_{ij}{}'$：\n$$\ne^{+}_{ij}{}' = (\\cos^{2}\\psi - \\sin^{2}\\psi)(\\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}) + (2\\sin\\psi\\cos\\psi)(\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\n使用三角恒等式 $\\cos(2\\psi) = \\cos^{2}\\psi - \\sin^{2}\\psi$ 和 $\\sin(2\\psi) = 2\\sin\\psi\\cos\\psi$，以及定义 $e^{+}_{ij} = \\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}$ 和 $e^{\\times}_{ij} = \\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j}$，我们得到：\n$$\ne^{+}_{ij}{}' = \\cos(2\\psi)\\, e^{+}_{ij} + \\sin(2\\psi)\\, e^{\\times}_{ij}\n$$\n\n接下来，对于 $e^{\\times}_{ij}{}'$：\n项 $\\hat{x}'_{i}\\hat{y}'_{j}$ 为：\n$$\n\\hat{x}'_{i}\\hat{y}'_{j} = (\\cos\\psi\\, \\hat{x}_{i} + \\sin\\psi\\, \\hat{y}_{i})(-\\sin\\psi\\, \\hat{x}_{j} + \\cos\\psi\\, \\hat{y}_{j}) = -\\sin\\psi\\cos\\psi\\, \\hat{x}_{i}\\hat{x}_{j} + \\cos^{2}\\psi\\, \\hat{x}_{i}\\hat{y}_{j} - \\sin^{2}\\psi\\, \\hat{y}_{i}\\hat{x}_{j} + \\sin\\psi\\cos\\psi\\, \\hat{y}_{i}\\hat{y}_{j}\n$$\n将此项与其对称对应项 $\\hat{y}'_{i}\\hat{x}'_{j}$ 相加，得到 $e^{\\times}_{ij}{}'$：\n$$\ne^{\\times}_{ij}{}' = -\\sin(2\\psi)\\, (\\hat{x}_{i}\\hat{x}_{j} - \\hat{y}_{i}\\hat{y}_{j}) + (\\cos^{2}\\psi - \\sin^{2}\\psi)(\\hat{x}_{i}\\hat{y}_{j} + \\hat{y}_{i}\\hat{x}_{j})\n$$\n$$\ne^{\\times}_{ij}{}' = -\\sin(2\\psi)\\, e^{+}_{ij} + \\cos(2\\psi)\\, e^{\\times}_{ij}\n$$\n现在，我们将这些关系代回到 $h_{ij}$ 的不变性方程中：\n$$\nh_{+}\\, e^{+}_{ij} + h_{\\times}\\, e^{\\times}_{ij} = h_{+}'( \\cos(2\\psi)\\, e^{+}_{ij} + \\sin(2\\psi)\\, e^{\\times}_{ij} ) + h_{\\times}'( -\\sin(2\\psi)\\, e^{+}_{ij} + \\cos(2\\psi)\\, e^{\\times}_{ij} )\n$$\n我们按基张量 $e^{+}_{ij}$ 和 $e^{\\times}_{ij}$ 对各项进行分组：\n$$\nh_{+}\\, e^{+}_{ij} + h_{\\times}\\, e^{\\times}_{ij} = (h_{+}'\\cos(2\\psi) - h_{\\times}'\\sin(2\\psi))\\, e^{+}_{ij} + (h_{+}'\\sin(2\\psi) + h_{\\times}'\\cos(2\\psi))\\, e^{\\times}_{ij}\n$$\n极化张量 $e^{+}_{ij}$ 和 $e^{\\times}_{ij}$ 是正交的，并构成了微扰的横向无迹部分的一个基。因此，我们可以令方程两边的系数相等：\n$$\nh_{+} = h_{+}'\\cos(2\\psi) - h_{\\times}'\\sin(2\\psi)\n$$\n$$\nh_{\\times} = h_{+}'\\sin(2\\psi) + h_{\\times}'\\cos(2\\psi)\n$$\n这表示一个坐标旋转。为了用 $h_{+}$ 和 $h_{\\times}$ 表示 $h_{+}'$ 和 $h_{\\times}'$，我们反解这个方程组。这对应于一个角度为 $2\\psi$ 的旋转：\n$$\nh_{+}' = h_{+}\\cos(2\\psi) + h_{\\times}\\sin(2\\psi)\n$$\n$$\nh_{\\times}' = -h_{+}\\sin(2\\psi) + h_{\\times}\\cos(2\\psi)\n$$\n最后，我们构建在旋转后的基中的复应变，$h^{\\mathrm{c}}{}' = h_{+}' + i h_{\\times}'$：\n$$\nh^{\\mathrm{c}}{}' = (h_{+}\\cos(2\\psi) + h_{\\times}\\sin(2\\psi)) + i(-h_{+}\\sin(2\\psi) + h_{\\times}\\cos(2\\psi))\n$$\n我们收集乘以 $h_{+}$ 和 $h_{\\times}$ 的项：\n$$\nh^{\\mathrm{c}}{}' = h_{+}(\\cos(2\\psi) - i\\sin(2\\psi)) + h_{\\times}(\\sin(2\\psi) + i\\cos(2\\psi))\n$$\n从第二项中提出因子 $i$，我们得到 $\\sin(2\\psi) + i\\cos(2\\psi) = i(\\cos(2\\psi) - i\\sin(2\\psi))$。\n$$\nh^{\\mathrm{c}}{}' = h_{+}(\\cos(2\\psi) - i\\sin(2\\psi)) + i h_{\\times}(\\cos(2\\psi) - i\\sin(2\\psi))\n$$\n提出公因式 $(\\cos(2\\psi) - i\\sin(2\\psi))$：\n$$\nh^{\\mathrm{c}}{}' = (h_{+} + i h_{\\times})(\\cos(2\\psi) - i\\sin(2\\psi))\n$$\n使用欧拉公式 $\\exp(-i\\theta) = \\cos\\theta - i\\sin\\theta$，其中 $\\theta = 2\\psi$，以及定义 $h^{\\mathrm{c}} = h_{+} + i h_{\\times}$，我们得到最终的表达式：\n$$\nh^{\\mathrm{c}}{}' = h^{\\mathrm{c}}\\exp(-i2\\psi)\n$$\n这个结果表明，在横向平面内的旋转下，复应变作为一个自旋为2的量进行变换，因为角度为 $\\psi$ 的旋转会引起 $-2\\psi$ 的相移。", "answer": "$$\n\\boxed{h^{\\mathrm{c}}{}' = h^{\\mathrm{c}} \\exp(-i 2 \\psi)}\n$$", "id": "3476585"}, {"introduction": "理论概念必须在数值模拟中得到检验，而数值模拟是现代相对论研究的核心工具。这项练习旨在连接解析理论与计算实践。通过在离散网格上构建引力波并用数值方法验证其性质 ([@problem_id:3476511])，你将锻炼使用有限差分等数值技术的核心能力，并加深对TT规范在计算环境中的物理意义的理解。", "problem": "考虑由平直背景上的小度规微扰 $h_{\\mu\\nu}$（其中 $|h_{\\mu\\nu}| \\ll 1$）描述的弱场引力波。在横向无迹 (TT) 规范中，已知真空平面波解的空间分量 $h_{ij}^{\\mathrm{TT}}$ 是无散（横向）且无迹的。对于空间张量场 $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$，其横向性和无迹性条件分别为 $\\partial_i h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x}) = 0$ 和 $h_{ii}^{\\mathrm{TT}}(t,\\mathbf{x}) = 0$，其中重复指标表示对 $i = 1,2,3$ 求和。\n\n您的任务是为一组平面波测试用例，在三维笛卡尔网格上对这些条件进行数值验证。每个测试用例定义了：一个立方空间域、一个离散网格、一个单位传播方向矢量、一个固定的观测时间、一个角频率以及两个正交极化模式的振幅。构建一个与横向无迹 (TT) 规范一致的平面波场 $h_{ij}^{\\mathrm{TT}}$，并数值验证其散度 $\\partial_i h_{ij}^{\\mathrm{TT}}$ 和迹 $h_{ii}^{\\mathrm{TT}}$ 在整个网格上一致地处于给定的容差范围内。\n\n使用以下基本原理：\n- 在弱场极限下，线性化爱因斯坦方程表明，在真空中，度规微扰满足波动方程，并且横向无迹 (TT) 规范要求 $\\partial_i h_{ij}^{\\mathrm{TT}} = 0$ 和 $h_{ii}^{\\mathrm{TT}} = 0$。\n- 一个角频率为 $\\omega$、波矢为 $\\mathbf{k} = k\\,\\hat{\\mathbf{n}}$ 的平面波沿单位矢量 $\\hat{\\mathbf{n}}$ 传播，其中 $k = \\omega/c$，$c$ 为光速。\n- 场 $h_{ij}^{\\mathrm{TT}}$ 是无量纲的。空间坐标单位为 $\\mathrm{m}$，时间单位为 $\\mathrm{s}$，频率单位为 $\\mathrm{rad/s}$，三角函数中使用的角度必须是弧度。使用 $c = 2.99792458\\times 10^8\\,\\mathrm{m/s}$。\n\n数值方法要求：\n- 将区域离散化为一个均匀网格，在每个方向上有 $N_x, N_y, N_z$ 个点，范围长度分别为 $L_x, L_y, L_z$（单位：$\\mathrm{m}$）。设间距为 $dx = L_x/(N_x-1), dy = L_y/(N_y-1), dz = L_z/(N_z-1)$。\n- 在内部区域使用至少二阶精度的有限差分来数值计算偏导数。边界处理可以使用一阶或二阶的单边差分，前提是全局最大范数是在整个网格上进行评估。\n- 对每个测试用例，评估所有网格点和指标上的最大绝对值 $\\max_{\\mathbf{x},j}|\\partial_i h_{ij}^{\\mathrm{TT}}|$ 和 $\\max_{\\mathbf{x}}|h_{ii}^{\\mathrm{TT}}|$，并与容差 $\\varepsilon$ 进行比较。\n\n测试套件：\n实现以下四个测试用例。对每个用例，使用指定的参数构建一个与横向无迹 (TT) 规范一致的平面波，并验证其条件。为每个测试用例报告一个布尔值结果，该结果指示横向性和无迹性两个条件是否都在整个域内满足指定的容差。\n\n- 测试用例 1：\n    - 域：$L_x = L_y = L_z = 10000\\,\\mathrm{m}$，网格：$N_x = N_y = N_z = 33$。\n    - 传播方向：$\\hat{\\mathbf{n}} = (0,0,1)$。\n    - 角频率：$\\omega = 2\\pi\\times 100\\,\\mathrm{rad/s}$。\n    - 极化振幅：$A_{+} = 1\\times 10^{-21}$，$A_{\\times} = 0$。\n    - 时间：$t = 0\\,\\mathrm{s}$。\n    - 容差：$\\varepsilon = 1\\times 10^{-18}$。\n\n- 测试用例 2：\n    - 域：$L_x = L_y = L_z = 20000\\,\\mathrm{m}$，网格：$N_x = N_y = N_z = 41$。\n    - 传播方向：$\\hat{\\mathbf{n}} = (1,1,1)/\\sqrt{3}$。\n    - 角频率：$\\omega = 2\\pi\\times 50\\,\\mathrm{rad/s}$。\n    - 极化振幅：$A_{+} = 0$，$A_{\\times} = 2\\times 10^{-21}$。\n    - 时间：$t = 0\\,\\mathrm{s}$。\n    - 容差：$\\varepsilon = 1\\times 10^{-18}$。\n\n- 测试用例 3：\n    - 域：$L_x = L_y = L_z = 5000\\,\\mathrm{m}$，网格：$N_x = N_y = N_z = 21$。\n    - 传播方向：$\\hat{\\mathbf{n}} = (0,1,0)$。\n    - 角频率：$\\omega = 2\\pi\\times 1000\\,\\mathrm{rad/s}$。\n    - 极化振幅：$A_{+} = 1\\times 10^{-21}$，$A_{\\times} = 3\\times 10^{-21}$。\n    - 时间：$t = 1\\times 10^{-2}\\,\\mathrm{s}$。\n    - 容差：$\\varepsilon = 1\\times 10^{-18}$。\n\n- 测试用例 4：\n    - 域：$L_x = L_y = L_z = 1000\\,\\mathrm{m}$，网格：$N_x = N_y = N_z = 9$。\n    - 传播方向：$\\hat{\\mathbf{n}} = (0,0,1)$。\n    - 角频率：$\\omega = 2\\pi\\times 200\\,\\mathrm{rad/s}$。\n    - 极化振幅：$A_{+} = 2\\times 10^{-21}$，$A_{\\times} = 1\\times 10^{-21}$。\n    - 时间：$t = 5\\times 10^{-3}\\,\\mathrm{s}$。\n    - 容差：$\\varepsilon = 1\\times 10^{-16}$。\n\n实现细节：\n- 构建与 $\\hat{\\mathbf{n}}$ 垂直的正交归一极化基矢量 $\\hat{\\mathbf{e}}_{1}$ 和 $\\hat{\\mathbf{e}}_{2}$，并用它们来构建具有两个正交模式和振幅 $A_{+}$ 和 $A_{\\times}$ 的横向无迹 (TT) 极化张量。\n- 形成一个与横向无迹 (TT) 规范一致的平面波 $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$，该波沿 $\\hat{\\mathbf{n}}$ 传播，其相位取决于 $\\omega$、$t$ 和 $\\mathbf{k}\\cdot\\mathbf{x}$，其中 $\\mathbf{k} = (\\omega/c)\\,\\hat{\\mathbf{n}}$。\n- 通过有限差分数值计算 $\\partial_i h_{ij}^{\\mathrm{TT}}$，并直接从场计算 $h_{ii}^{\\mathrm{TT}}$。\n\n输出规格：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_m$ 是一个布尔值，指示对于测试用例 $m$，$\\partial_i h_{ij}^{\\mathrm{TT}} = 0$ 和 $h_{ii}^{\\mathrm{TT}} = 0$ 这两个条件是否在整个网格上都在指定容差内得到满足。", "solution": "该问题是有效的，因为它在科学上基于广义相对论，问题陈述清晰，并为数值验证任务提供了一套完整且一致的参数。该任务涉及为弱场度规微扰构建横向无迹 (TT) 规范下的平面波解，并数值验证其定义属性。\n\n解决方案主要分两步进行：首先，解析地构建引力波场 $h_{ij}^{\\mathrm{TT}}(t,\\mathbf{x})$；其次，通过数值程序在离散网格上验证其属性。\n\n在真空中传播的平面引力波由对平直闵可夫斯基度规 $\\eta_{\\mu\\nu}$ 的微扰 $h_{\\mu\\nu}$ 来描述。在 TT 规范中，此微扰的空间部分 $h_{ij}^{\\mathrm{TT}}$ 是真空波动方程的一个解。对于角频率为 $\\omega$、波矢为 $\\mathbf{k}$ 的单色平面波，其解可以写为：\n$$\nh_{ij}^{\\mathrm{TT}}(t, \\mathbf{x}) = \\mathcal{A}_{ij} \\cos(\\phi) = \\mathcal{A}_{ij} \\cos(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)\n$$\n其中 $\\phi = \\mathbf{k} \\cdot \\mathbf{x} - \\omega t$ 是相位。波矢由 $\\mathbf{k} = (\\omega/c) \\hat{\\mathbf{n}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是传播方向上的单位矢量，$c = 2.99792458 \\times 10^8 \\, \\mathrm{m/s}$ 是光速。振幅张量 $\\mathcal{A}_{ij}$ 是常数，并包含了极化信息。\n\nTT 规范对空间张量 $h_{ij}^{\\mathrm{TT}}$ 施加了两个条件：\n1.  **无迹性**：张量的迹为零，$h_{ii}^{\\mathrm{TT}} = 0$（对 $i=1,2,3$ 求和）。\n2.  **横向性**：张量与传播方向横向正交，对于平面波而言，这意味着 $k_i h_{ij}^{\\mathrm{TT}} = 0$。这等价于无散条件 $\\partial_i h_{ij}^{\\mathrm{TT}} = 0$，通过应用链式法则可以看出：$\\partial_i h_{ij}^{\\mathrm{TT}} = \\mathcal{A}_{ij} (-\\sin(\\phi)) (\\partial_i \\phi) = -k_i \\mathcal{A}_{ij} \\sin(\\phi)$。\n\n为满足这些条件，振幅张量 $\\mathcal{A}_{ij}$ 由两个基极化张量 $\\epsilon_{ij}^{+}$ 和 $\\epsilon_{ij}^{\\times}$ 的线性组合构成：\n$$\n\\mathcal{A}_{ij} = A_{+} \\epsilon_{ij}^{+} + A_{\\times} \\epsilon_{ij}^{\\times}\n$$\n其中 $A_{+}$ 和 $A_{\\times}$ 分别是“加”和“叉”极化模式的振幅。\n\n极化张量由垂直于传播方向 $\\hat{\\mathbf{n}}$ 的平面内的一个正交归一基 $\\{\\hat{\\mathbf{e}}_1, \\hat{\\mathbf{e}}_2\\}$ 构建。\n$$\n\\epsilon_{ij}^{+} = (\\hat{e}_1)_i (\\hat{e}_1)_j - (\\hat{e}_2)_i (\\hat{e}_2)_j\n$$\n$$\n\\epsilon_{ij}^{\\times} = (\\hat{e}_1)_i (\\hat{e}_2)_j + (\\hat{e}_2)_i (\\hat{e}_1)_j\n$$\n对于任何给定的 $\\hat{\\mathbf{n}}$，都可以构建此基。一个稳健的方法是选择一个固定的非共线矢量，例如 $\\mathbf{v} = (0,0,1)$（如果 $\\hat{\\mathbf{n}}$ 与 $(0,0,1)$ 平行，则选择 $\\mathbf{v}=(1,0,0)$），然后使用 Gram-Schmidt 方法或叉积。一个可靠的构建方法是：\n1.  选择一个不与 $\\hat{\\mathbf{n}}$ 平行的矢量 $\\mathbf{v}$。\n2.  定义 $\\hat{\\mathbf{e}}_2 = \\frac{\\hat{\\mathbf{n}} \\times \\mathbf{v}}{|\\hat{\\mathbf{n}} \\times \\mathbf{v}|}$。\n3.  定义 $\\hat{\\mathbf{e}}_1 = \\hat{\\mathbf{e}}_2 \\times \\hat{\\mathbf{n}}$。\n所得集合 $\\{\\hat{\\mathbf{e}}_1, \\hat{\\mathbf{e}}_2, \\hat{\\mathbf{n}}\\}$ 构成一个右手正交归一基。\n\n根据构造，$\\epsilon_{ij}^{+}$ 和 $\\epsilon_{ij}^{\\times}$ 都是无迹的且与 $\\mathbf{k}$ 横向正交，这确保了 $h_{ij}^{\\mathrm{TT}}$ 能解析地满足 TT 规范条件。\n\n对于数值验证，空间域被离散化为一个维度为 $N_x \\times N_y \\times N_z$、间距为 $dx, dy, dz$ 的均匀笛卡尔网格。在固定的时间 $t$，于每个网格点上计算场 $h_{ij}^{\\mathrm{TT}}(t, \\mathbf{x})$ 的值。\n\n**无迹性验证**：\n在每个网格点上计算迹 $T(\\mathbf{x}) = h_{ii}^{\\mathrm{TT}}(\\mathbf{x}) = h_{11}^{\\mathrm{TT}}(\\mathbf{x}) + h_{22}^{\\mathrm{TT}}(\\mathbf{x}) + h_{33}^{\\mathrm{TT}}(\\mathbf{x})$。然后找到整个网格上迹的最大绝对值：\n$$\n\\text{err}_{\\text{trace}} = \\max_{\\mathbf{x}} |T(\\mathbf{x})|\n$$\n将该值与容差 $\\varepsilon$ 进行比较。解析上，迹为零。在数值上，此误差应在机器浮点精度的数量级。\n\n**横向性验证**：\n对每个分量 $j \\in \\{1,2,3\\}$ 计算散度矢量 $D_j(\\mathbf{x}) = \\partial_i h_{ij}^{\\mathrm{TT}}(\\mathbf{x})$。这需要进行数值微分。我们使用在网格内部具有二阶精度、在边界具有一阶精度的有限差分，正如 `numpy.gradient` 中所实现的。对于每个网格点 $\\mathbf{x}$，散度的三个分量是：\n$$\nD_1(\\mathbf{x}) = \\partial_1 h_{11}^{\\mathrm{TT}} + \\partial_2 h_{21}^{\\mathrm{TT}} + \\partial_3 h_{31}^{\\mathrm{TT}}\n$$\n$$\nD_2(\\mathbf{x}) = \\partial_1 h_{12}^{\\mathrm{TT}} + \\partial_2 h_{22}^{\\mathrm{TT}} + \\partial_3 h_{32}^{\\mathrm{TT}}\n$$\n$$\nD_3(\\mathbf{x}) = \\partial_1 h_{13}^{\\mathrm{TT}} + \\partial_2 h_{23}^{\\mathrm{TT}} + \\partial_3 h_{33}^{\\mathrm{TT}}\n$$\n找到整个网格和所有三个分量上散度的最大绝对值：\n$$\n\\text{err}_{\\text{div}} = \\max_{\\mathbf{x}, j} |D_j(\\mathbf{x})|\n$$\n将此误差（其源于微分算子的离散化）与容差 $\\varepsilon$ 进行比较。\n\n对于每个测试用例，当且仅当 $\\text{err}_{\\text{trace}} \\le \\varepsilon$ 和 $\\text{err}_{\\text{div}} \\le \\varepsilon$ 这两个条件都满足时，最终结果为 `True`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"domain\": (10000.0, 10000.0, 10000.0),\n            \"grid_size\": (33, 33, 33),\n            \"n_hat\": np.array([0.0, 0.0, 1.0]),\n            \"omega\": 2.0 * np.pi * 100.0,\n            \"A_plus\": 1e-21,\n            \"A_cross\": 0.0,\n            \"time\": 0.0,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 2\n        {\n            \"domain\": (20000.0, 20000.0, 20000.0),\n            \"grid_size\": (41, 41, 41),\n            \"n_hat\": np.array([1.0, 1.0, 1.0]) / np.sqrt(3),\n            \"omega\": 2.0 * np.pi * 50.0,\n            \"A_plus\": 0.0,\n            \"A_cross\": 2e-21,\n            \"time\": 0.0,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 3\n        {\n            \"domain\": (5000.0, 5000.0, 5000.0),\n            \"grid_size\": (21, 21, 21),\n            \"n_hat\": np.array([0.0, 1.0, 0.0]),\n            \"omega\": 2.0 * np.pi * 1000.0,\n            \"A_plus\": 1e-21,\n            \"A_cross\": 3e-21,\n            \"time\": 1e-2,\n            \"tolerance\": 1e-18,\n        },\n        # Test case 4\n        {\n            \"domain\": (1000.0, 1000.0, 1000.0),\n            \"grid_size\": (9, 9, 9),\n            \"n_hat\": np.array([0.0, 0.0, 1.0]),\n            \"omega\": 2.0 * np.pi * 200.0,\n            \"A_plus\": 2e-21,\n            \"A_cross\": 1e-21,\n            \"time\": 5e-3,\n            \"tolerance\": 1e-16,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = verify_tt_conditions(**case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef verify_tt_conditions(domain, grid_size, n_hat, omega, A_plus, A_cross, time, tolerance):\n    \"\"\"\n    Constructs a TT-gauge plane wave and verifies its properties numerically.\n\n    Args:\n        domain (tuple): A tuple (Lx, Ly, Lz) of domain lengths in meters.\n        grid_size (tuple): A tuple (Nx, Ny, Nz) of grid points.\n        n_hat (np.ndarray): A 3D unit vector for the propagation direction.\n        omega (float): Angular frequency in rad/s.\n        A_plus (float): Amplitude of the plus polarization.\n        A_cross (float): Amplitude of the cross polarization.\n        time (float): Observation time in seconds.\n        tolerance (float): Error tolerance for verification.\n\n    Returns:\n        bool: True if both conditions are met, False otherwise.\n    \"\"\"\n    c = 2.99792458e8  # Speed of light in m/s\n    Lx, Ly, Lz = domain\n    Nx, Ny, Nz = grid_size\n\n    # 1. Construct polarization basis vectors e1, e2 orthogonal to n_hat\n    v = np.array([0.0, 0.0, 1.0])\n    # If n_hat is parallel to v, choose a different v\n    if np.allclose(np.abs(np.dot(n_hat, v)), 1.0):\n        v = np.array([1.0, 0.0, 0.0])\n    \n    e2 = np.cross(n_hat, v)\n    e2 /= np.linalg.norm(e2)\n    e1 = np.cross(e2, n_hat)\n\n    # 2. Construct polarization tensors\n    eps_plus = np.outer(e1, e1) - np.outer(e2, e2)\n    eps_cross = np.outer(e1, e2) + np.outer(e2, e1)\n\n    # 3. Set up the grid and wave vector\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    z = np.linspace(0, Lz, Nz)\n    xx, yy, zz = np.meshgrid(x, y, z, indexing='ij')\n\n    k_vec = (omega / c) * n_hat\n\n    # 4. Construct the h_ij field\n    phase = k_vec[0] * xx + k_vec[1] * yy + k_vec[2] * zz - omega * time\n    \n    # h_field shape: (Nx, Ny, Nz, 3, 3)\n    amplitude_tensor = A_plus * eps_plus + A_cross * eps_cross\n    h_field = amplitude_tensor[np.newaxis, np.newaxis, np.newaxis, :, :] * np.cos(phase)[..., np.newaxis, np.newaxis]\n\n    # 5. Verify tracelessness\n    trace_h = np.einsum('...ii->...', h_field)\n    max_trace_error = np.max(np.abs(trace_h))\n\n    # 6. Verify transversality (divergence-free)\n    dx = Lx / (Nx - 1) if Nx > 1 else 1.0\n    dy = Ly / (Ny - 1) if Ny > 1 else 1.0\n    dz = Lz / (Nz - 1) if Nz > 1 else 1.0\n    \n    # Calculate gradients of h field w.r.t. spatial coordinates\n    # np.gradient returns a list of arrays: [grad_x(h_ij), grad_y(h_ij), grad_z(h_ij)]\n    # axis=(0,1,2) corresponds to x,y,z grid axes\n    # The output is a list of arrays, which we stack into a single array for einsum\n    # grad_h_list has shape (3, Nx, Ny, Nz, 3, 3)\n    # The first '3' corresponds to the derivative direction (d/dx, d/dy, d/dz)\n    grad_h_list = np.stack(np.gradient(h_field, dx, dy, dz, axis=(0, 1, 2)), axis=0)\n\n    # Compute divergence D_j = sum_i(d/dx_i h_ij)\n    # einsum contracts the derivative index with the first tensor index\n    # 'i...ij->...j'\n    # i: derivative direction (0,1,2 for x,y,z) and first tensor index\n    # ...: grid dimensions (Nx, Ny, Nz)\n    # j: second tensor index\n    # The result `div_h` has shape (Nx, Ny, Nz, 3)\n    div_h = np.einsum('i...ij->...j', grad_h_list)\n    max_div_error = np.max(np.abs(div_h))\n\n    # 7. Final check\n    is_valid = (max_trace_error = tolerance) and (max_div_error = tolerance)\n    return is_valid\n\n# Execute the solution\nsolve()\n```", "id": "3476511"}]}