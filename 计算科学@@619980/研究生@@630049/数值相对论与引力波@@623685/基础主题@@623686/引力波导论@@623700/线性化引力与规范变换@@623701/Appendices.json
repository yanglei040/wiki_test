{"hands_on_practices": [{"introduction": "在线性化引力理论中，度规扰动 $h_{\\mu\\nu}$ 的所有分量并非都具有物理意义；真正的物理自由度蕴含在其横向无迹（TT）部分。本练习提供了一种强有力的数值方法来验证这一点，通过将空间度规扰动 $h_{ij}$ 分解为不同的螺旋度（helicity）本征态。您将通过计算验证，规范变换虽然会改变 $h_{ij}$ 的分量，但无法在真空中为物理的横向无迹（TT）部分引入非物理的螺旋度（$\\lambda=0, \\pm1$）分量，从而加深对规范不变性的理解。[@problem_id:3478825]", "problem": "考虑平直闵可夫斯基时空中的线性化引力。令度规写作 $g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$，其中 $h_{\\mu\\nu}$ 是一个小微扰。在真空中，使用洛伦兹规范条件 $\\partial^{\\mu} \\bar{h}_{\\mu\\nu} = 0$（其中 $\\bar{h}_{\\mu\\nu} = h_{\\mu\\nu} - \\tfrac{1}{2} \\eta_{\\mu\\nu} h$），线性化爱因斯坦方程简化为波动方程 $\\Box \\bar{h}_{\\mu\\nu} = 0$。在由矢量场 $\\xi_{\\mu}$ 生成的无穷小规范变换下，微扰的变换形式为 $h'_{\\mu\\nu} = h_{\\mu\\nu} + \\partial_{\\mu} \\xi_{\\nu} + \\partial_{\\nu} \\xi_{\\mu}$。对于一个沿 $z$ 方向传播的平面波，其空间波矢为 $\\mathbf{k} = k \\hat{\\mathbf{z}}$，频率为 $\\omega$，在光速 $c$ 等于 1 的单位制下 $k = \\omega$。其空间分量在傅里叶空间中的变换为 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n\n引力波的物理极化内容由 $h_{ij}$ 的横向无迹 (TT) 部分描述。定义单位传播方向 $\\mathbf{n} = \\hat{\\mathbf{z}}$，以及横向投影算子 $P_{ij} = \\delta_{ij} - n_i n_j$。作用在空间对称张量 $h_{ij}$ 上的 TT 投影算子为\n$$\nh^{\\mathrm{TT}}_{ij} = \\left(P_{ik} h_{kl} P_{lj}\\right) - \\frac{1}{2} P_{ij} \\, \\mathrm{tr}\\left(P h P\\right).\n$$\n螺旋度态是相对于围绕 $\\mathbf{n}$ 的旋转来定义的。使用笛卡尔基矢量 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$，构建对应于螺旋度 $\\lambda \\in \\{+2, -2, +1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$ 的六个正交归一的对称张量基元：\n- $\\lambda = +2$:\n$$\ne^{(+2)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j + i \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right) \\right),\n$$\n- $\\lambda = -2$:\n$$\ne^{(-2)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j - i \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right) \\right),\n$$\n- $\\lambda = +1$:\n$$\ne^{(+1)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{z}_j + \\hat{z}_i \\hat{x}_j + i \\left(\\hat{y}_i \\hat{z}_j + \\hat{z}_i \\hat{y}_j\\right) \\right),\n$$\n- $\\lambda = -1$:\n$$\ne^{(-1)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{z}_j + \\hat{z}_i \\hat{x}_j - i \\left(\\hat{y}_i \\hat{z}_j + \\hat{z}_i \\hat{y}_j\\right) \\right),\n$$\n- $\\lambda = 0_{\\mathrm{t}}$ (无迹轴向):\n$$\ne^{(0_{\\mathrm{t}})}_{ij} = \\frac{1}{\\sqrt{6}} \\left(\\hat{x}_i \\hat{x}_j + \\hat{y}_i \\hat{y}_j - 2 \\hat{z}_i \\hat{z}_j \\right),\n$$\n- $\\lambda = 0_{\\mathrm{s}}$ (迹标量):\n$$\ne^{(0_{\\mathrm{s}})}_{ij} = \\frac{1}{\\sqrt{3}} \\left(\\hat{x}_i \\hat{x}_j + \\hat{y}_i \\hat{y}_j + \\hat{z}_i \\hat{z}_j \\right).\n$$\n它们满足正交归一性条件 $\\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} e^{(\\lambda')}_{ij} = \\delta_{\\lambda \\lambda'}$，其中 ${}^{*}$ 表示复共轭。一个通用的 $3 \\times 3$ 对称张量 $h_{ij}$ 可以通过投影到该基上进行分解，其系数为 $c_{\\lambda} = \\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} h_{ij}$。\n\n从一个沿 $\\hat{\\mathbf{z}}$ 传播的横向无迹 (TT) 平面引力波微扰开始，该微扰由实振幅 $a_{+}$ (plus) 和 $a_{\\times}$ (cross) 参数化为\n$$\nh^{\\mathrm{TT}}_{ij} = a_{+} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j\\right) + a_{\\times} \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right),\n$$\n施加一个由空间矢量振幅 $\\boldsymbol{\\xi} = (\\xi_x, \\xi_y, \\xi_z)$ 在相同波矢 $\\mathbf{k} = k \\hat{\\mathbf{z}}$ 下生成的平面波规范变换，于是在傅里叶空间中\n$$\n\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i), \\quad \\text{with} \\quad \\mathbf{k} = k \\hat{\\mathbf{z}}, \\quad k = \\omega.\n$$\n构成 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$，然后投影到物理内容 $h^{\\mathrm{TT}}_{\\mathrm{phys}} = \\mathrm{TT}(h'_{ij})$。将 $h^{\\mathrm{TT}}_{\\mathrm{phys}}$ 分解到螺旋度基上，并数值计算 $\\lambda = 0_{\\mathrm{s}}, 0_{\\mathrm{t}}, +1, -1$ 时系数的模。在真空中，结论是这些模必须为零，即规范变换不能在物理 TT 内容中产生 $\\lambda = 0, \\pm 1$ 分量。\n\n你的任务是实现一个程序，对于一组指定的测试参数，构造 $h^{\\mathrm{TT}}_{ij}$，应用规范变换 $\\delta h_{ij}$，执行 TT 投影，分解到螺旋度基上，并对每个测试用例返回一个布尔值，该值指示在非期望的螺旋度 $\\lambda \\in \\{0_{\\mathrm{s}}, 0_{\\mathrm{t}}, +1, -1\\}$ 中，系数模的最大值是否小于容差 $\\epsilon$。使用容差 $\\epsilon = 10^{-12}$。\n\n使用以下测试套件，所有情况均沿 $\\hat{\\mathbf{z}}$ 传播，且 $k = \\omega = 1$：\n- 情况 1：$a_{+} = 1$, $a_{\\times} = 0$, $(\\xi_x, \\xi_y, \\xi_z) = (0.3, -0.25, 0.1)$。\n- 情况 2：$a_{+} = -0.7$, $a_{\\times} = 1.1$, $(\\xi_x, \\xi_y, \\xi_z) = (2.0, 3.0, -1.0)$。\n- 情况 3：$a_{+} = 0$, $a_{\\times} = 0$, $(\\xi_x, \\xi_y, \\xi_z) = (5.0, -4.0, 2.0)$。\n- 情况 4：$a_{+} = 1 \\times 10^{-12}$, $a_{\\times} = -1 \\times 10^{-12}$, $(\\xi_x, \\xi_y, \\xi_z) = (1 \\times 10^{6}, -1 \\times 10^{6}, 1 \\times 10^{6})$。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\texttt{[result1,result2,result3,result4]}$，其中每个 $\\texttt{result}$ 为 $\\texttt{True}$ 或 $\\texttt{False}$，取决于相应测试用例中非期望的螺旋度模是否低于 $\\epsilon$。本问题中不需要物理单位。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上是合理的，内容自洽，且问题提法明确。它提出了一个在线性化广义相对论框架内的标准、可验证的问题。\n\n核心任务是数值验证线性化引力的一条基本原理：无穷小规范变换虽然会改变度规微扰分量 $h_{ij}$，但不会改变引力波的物理的、规范不变的内容。物理内容完全由度规微扰的横向无迹 (TT) 部分所描述，这对应于无质量自旋-2 场的螺旋度 $\\lambda=\\pm 2$ 模式。\n\n在概述数值实现之前，我们首先对该原理进行解析确认。\n\n一个广义的无穷小坐标变换 $x'^{\\mu} = x^{\\mu} - \\xi^{\\mu}(x)$ 引起的度规微扰变化为 $\\delta h_{\\mu\\nu} = \\mathcal{L}_{\\xi} g_{\\mu\\nu} \\approx \\partial_{\\mu}\\xi_{\\nu} + \\partial_{\\nu}\\xi_{\\mu}$，其中 $\\mathcal{L}_{\\xi}$ 是沿矢量场 $\\xi^{\\mu}$ 的李导数。对于一个四维波矢为 $k^{\\mu}$ 的平面波，其生成场也可以写成平面波形式，$\\xi_{\\mu}(x) = \\xi_{\\mu} e^{i k_{\\alpha}x^{\\alpha}}$，其中右边的 $\\xi_{\\mu}$ 是常数振幅矢量。因此，在傅里叶空间中，偏导数变为乘以 $i k_{\\mu}$。度规微扰空间分量的变化因此为 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n\n问题指出，这个规范部分 $\\delta h_{ij}$ 不应对最终的物理张量 $h^{\\mathrm{TT}}_{\\mathrm{phys}}$ 有贡献。物理张量是通过将 TT 投影算子应用于完整微扰 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$ 得到的。TT 投影算子是线性的，所以我们有：\n$$\nh^{\\mathrm{TT}}_{\\mathrm{phys}} = \\mathrm{TT}(h'_{ij}) = \\mathrm{TT}(h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}) = \\mathrm{TT}(h^{\\mathrm{TT}}_{ij}) + \\mathrm{TT}(\\delta h_{ij})\n$$\n根据定义，初始张量 $h^{\\mathrm{TT}}_{ij}$ 已经是横向无迹的。对于这样的张量，TT 投影是一个恒等操作，即 $\\mathrm{TT}(h^{\\mathrm{TT}}_{ij}) = h^{\\mathrm{TT}}_{ij}$。因此，中心论点等价于证明规范项的 TT 投影为零：\n$$\n\\mathrm{TT}(\\delta h_{ij}) = 0\n$$\n我们来证明这一点。令 $S_{ij} = k_i \\xi_j + k_j \\xi_i$。$iS_{ij}$ 的 TT 投影定义为：\n$$\n\\mathrm{TT}(iS_{ij}) = i \\left[ \\left(P_{ik} S_{kl} P_{lj}\\right) - \\frac{1}{2} P_{ij} \\, \\mathrm{tr}\\left(P S P\\right) \\right]\n$$\n波沿 $\\hat{\\mathbf{z}}$ 方向传播，因此单位传播矢量为 $\\mathbf{n} = (0, 0, 1)$，空间波矢为 $\\mathbf{k} = k \\mathbf{n}$，这意味着 $k_i = k n_i$。横向投影算子为 $P_{ij} = \\delta_{ij} - n_i n_j$。横向投影算子的一个关键性质是它会湮灭任何与 $\\mathbf{n}$ 共线的矢量，例如 $\\mathbf{k}$：$P_{ij} k_j = P_{ij} (k n_j) = k(P_{ij} n_j) = k(\\delta_{ij}n_j - n_i(n_j n_j)) = k(n_i - n_i) = 0$。\n\n我们来计算 $P_{ik} S_{kl}$ 项：\n$$\nP_{ik} S_{kl} = P_{ik} (k_k \\xi_l + k_l \\xi_k) = (P_{ik} k_k) \\xi_l + k_l (P_{ik} \\xi_k)\n$$\n由于 $P_{ik} k_k = 0$，第一项消失。我们剩下：\n$$\nP_{ik} S_{kl} = k_l (P_{ik} \\xi_k) = (k n_l) (P_{ik} \\xi_k)\n$$\n现在，我们计算完整的横向部分，$(PSP)_{ij} = (P S)_{il} P_{lj}$：\n$$\n(P S P)_{ij} = \\left[ (k n_l) (P_{ik} \\xi_k) \\right] P_{lj} = (k P_{ik} \\xi_k) (n_l P_{lj})\n$$\n我们再次使用相同的性质：$n_l P_{lj} = n_l (\\delta_{lj} - n_l n_j) = n_j - (n_l n_l)n_j = n_j - n_j = 0$。\n因此，$(P S P)_{ij} = 0$。规范项的横向部分恒等于零。这立即意味着它的迹也为零，$\\mathrm{tr}(PSP) = 0$。\n将此代入 TT 投影公式可得：\n$$\n\\mathrm{TT}(\\delta h_{ij}) = i [ 0 - \\frac{1}{2} P_{ij} \\cdot 0 ] = 0\n$$\n这解析地证实了规范变换项被完全投影掉了。因此，最终的物理张量与初始张量相同：\n$$\nh^{\\mathrm{TT}}_{\\mathrm{phys}} = h^{\\mathrm{TT}}_{ij}\n$$\n初始张量 $h^{\\mathrm{TT}}_{ij}$ 是由 plus（“加”）极化张量 ($e^{+}_{ij} = \\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j$) 和 cross（“叉”）极化张量 ($e^{\\times}_{ij} = \\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j$) 的线性组合构成的。这些可以用螺旋度为 $\\pm 2$ 的基张量来表示：\n$$\ne^{+}_{ij} = e^{(+2)}_{ij} + e^{(-2)}_{ij} \\quad \\text{and} \\quad e^{\\times}_{ij} = -i(e^{(+2)}_{ij} - e^{(-2)}_{ij})\n$$\n这意味着 $h^{\\mathrm{TT}}_{ij}$ 完全由 $\\lambda=\\pm 2$ 螺旋度模式构成。螺旋度基是正交归一的，所以当我们将 $h^{\\mathrm{TT}}_{ij}$ 投影到这个基上进行分解时，系数 $c_{\\lambda} = \\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} h^{\\mathrm{TT}}_{ij}$ 将仅在 $\\lambda = \\pm 2$ 时非零。对于任何其他螺旋度 $\\lambda \\in \\{+1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$，由于正交性，系数 $c_{\\lambda}$ 必须精确为零。\n\n数值计算过程将涉及浮点运算，因此计算出的非期望螺旋度的系数预计会接近于零，处于机器精度的量级，而不是精确为零。问题正确地要求检查它们的模是否小于一个小的容差 $\\epsilon = 10^{-12}$。\n\n要实现的算法如下：\n1. 对于每个测试用例 $(a_{+}, a_{\\times}, \\boldsymbol{\\xi})$:\n2. 定义笛卡尔基矢量 $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$ 和波矢 $\\mathbf{k} = (0, 0, 1)$。\n3. 构造初始实张量 $h^{\\mathrm{TT}}_{ij} = a_{+} (\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j) + a_{\\times} (\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j)$。\n4. 构造复数规范变换张量 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n5. 形成变换后的张量 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$。\n6. 构造横向投影算子 $P_{ij} = \\delta_{ij} - n_i n_j$，其中 $\\mathbf{n} = \\mathbf{k}$。\n7. 将 TT 投影应用于 $h'_{ij}$ 以求得 $h^{\\mathrm{TT}}_{\\mathrm{phys}} = (P h' P)_{ij} - \\frac{1}{2} P_{ij} \\mathrm{tr}(P h' P)$。\n8. 构造 $\\lambda \\in \\{+1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$ 的基张量 $e^{(\\lambda)}_{ij}$。\n9. 对于每个“非期望”的螺旋度模式，计算投影系数的模：$| c_{\\lambda} | = |\\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} (h^{\\mathrm{TT}}_{\\mathrm{phys}})_{ij}|$。\n10. 找到这些系数中的最大模，并检查它是否小于 $\\epsilon = 10^{-12}$。测试用例的结果就是这个布尔值。\n根据解析证明，所有测试用例的预期结果都是 `True`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave gauge transformation problem.\n\n    Numerically verifies that gauge transformations on a Transverse-Traceless (TT)\n    plane wave do not introduce physical content into non-TT helicity modes\n    after TT projection.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a_plus, a_cross, (xi_x, xi_y, xi_z))\n        (1.0, 0.0, (0.3, -0.25, 0.1)),\n        (-0.7, 1.1, (2.0, 3.0, -1.0)),\n        (0.0, 0.0, (5.0, -4.0, 2.0)),\n        (1e-12, -1e-12, (1e6, -1e6, 1e6)),\n    ]\n    \n    # Define tolerance\n    epsilon = 1e-12\n    \n    # Define Cartesian basis vectors\n    x_hat = np.array([1., 0., 0.])\n    y_hat = np.array([0., 1., 0.])\n    z_hat = np.array([0., 0., 1.])\n    \n    # Define wavevector k (k=1, propagating along z)\n    k_vec = z_hat.copy()\n    n_vec = k_vec.copy()\n\n    # Construct the helicity basis tensors\n    e_p2 = 0.5 * (np.outer(x_hat, x_hat) - np.outer(y_hat, y_hat) + 1j * (np.outer(x_hat, y_hat) + np.outer(y_hat, x_hat)))\n    e_m2 = e_p2.conj()\n    e_p1 = 0.5 * (np.outer(x_hat, z_hat) + np.outer(z_hat, x_hat) + 1j * (np.outer(y_hat, z_hat) + np.outer(z_hat, y_hat)))\n    e_m1 = e_p1.conj()\n    e_0t = (1. / np.sqrt(6.)) * (np.outer(x_hat, x_hat) + np.outer(y_hat, y_hat) - 2. * np.outer(z_hat, z_hat))\n    e_0s = (1. / np.sqrt(3.)) * np.identity(3)\n    \n    # Select the \"unwanted\" helicity modes to check against\n    unwanted_basis_tensors = {\n        \"0s\": e_0s,\n        \"0t\": e_0t,\n        \"+1\": e_p1,\n        \"-1\": e_m1,\n    }\n\n    # Construct the transverse projector P_ij = delta_ij - n_i n_j\n    P = np.identity(3) - np.outer(n_vec, n_vec)\n\n    results = []\n    for case in test_cases:\n        a_plus, a_cross, xi = case\n        xi_vec = np.array(xi)\n        \n        # 1. Construct the initial Transverse-Traceless (TT) tensor h_TT\n        e_plus = np.outer(x_hat, x_hat) - np.outer(y_hat, y_hat)\n        e_cross = np.outer(x_hat, y_hat) + np.outer(y_hat, x_hat)\n        h_TT = a_plus * e_plus + a_cross * e_cross\n        \n        # 2. Construct the gauge transformation term delta_h\n        # delta_h_ij = i * (k_i * xi_j + k_j * xi_i)\n        delta_h = 1j * (np.outer(k_vec, xi_vec) + np.outer(xi_vec, k_vec))\n\n        # 3. Form the new tensor h_prime\n        h_prime = h_TT + delta_h\n\n        # 4. Perform the TT projection on h_prime\n        # T(h) = (P h P) - 1/2 * P * tr(P h P)\n        PhP = P @ h_prime @ P\n        tr_PhP = np.trace(PhP)\n        h_TT_phys = PhP - 0.5 * P * tr_PhP\n\n        # 5. Decompose the physical tensor onto the unwanted helicity basis\n        unwanted_magnitudes = []\n        for key, e_lambda in unwanted_basis_tensors.items():\n            # Coefficient c_lambda = sum_{i,j} e_lambda^*_{ij} * h_phys_{ij}\n            # This is the Frobenius inner product: tr(A^H B)\n            c_lambda = np.sum(e_lambda.conj() * h_TT_phys)\n            unwanted_magnitudes.append(np.abs(c_lambda))\n            \n        # 6. Check if the maximum magnitude is below the tolerance\n        max_mag = np.max(unwanted_magnitudes)\n        is_below_tolerance = max_mag  epsilon\n        results.append(is_below_tolerance)\n\n    # Final print statement in the exact required format.\n    # The output format for booleans in Python's str() is 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3478825"}, {"introduction": "虽然平面波是阐释物理原理的理想模型，但天体物理源（如双黑洞并合）产生的引力波通常在球坐标系下研究更为自然。本练习将我们的理解从平面波推广到更贴近实际的场景，通过球谐函数分解来考察规范变换的行为。您将通过编程实现球谐分解，并数值验证一个具有特定球谐模式 $(\\ell, m)$ 的规范矢量如何影响度规扰动，同时引入一个关键概念——规范不变的“主变量”（master variable），这对于从复杂数值模拟中提取物理信息至关重要。[@problem_id:3478804]", "problem": "您需要实现一个完整的、可运行的程序，该程序对线性化的度规微扰进行数值球谐分解，并通过显式计算来逐模式地验证规范变换的作用。工作背景设定为平直闵可夫斯基时空周围的线性化引力，并使用球坐标 $(t,r,\\theta,\\phi)$，背景度规为 $g_{\\mu\\nu}=\\mathrm{diag}(-1,1,r^2,r^2\\sin^2\\theta)$。角度 $\\theta$ 和 $\\phi$ 应以弧度表示。所有球谐积分都是在二维球面上进行的，使用标准面积元 $d\\Omega=\\sin\\theta\\,d\\theta\\,d\\phi$。\n\n基本依据和定义：\n- 考虑背景度规的微小扰动 $h_{\\mu\\nu}$，$g_{\\mu\\nu}\\to g_{\\mu\\nu}+h_{\\mu\\nu}$，其中 $|h_{\\mu\\nu}|\\ll 1$。\n- 在由矢量场 $\\xi^\\mu$ 生成的无穷小规范变换下，度规微扰的变换形式为 $h_{\\mu\\nu}\\to h_{\\mu\\nu}'=h_{\\mu\\nu}-\\nabla_\\mu \\xi_\\nu-\\nabla_\\nu \\xi_\\mu$，其中 $\\nabla_\\mu$ 是背景度规的 Levi-Civita 协变导数，且 $\\xi_\\nu=g_{\\nu\\alpha}\\xi^\\alpha$。\n- 使用在二维球面上正交归一的复标量球谐函数 $Y_{\\ell m}(\\theta,\\phi)$，满足 $\\int Y_{\\ell m}(\\theta,\\phi)Y^*_{\\ell' m'}(\\theta,\\phi)\\,d\\Omega=\\delta_{\\ell\\ell'}\\delta_{mm'}$。对于球面上的任意标量场 $f(\\theta,\\phi)$，其 $(\\ell,m)$ 系数为 $f^{\\ell m}=\\int f(\\theta,\\phi)Y^*_{\\ell m}(\\theta,\\phi)\\,d\\Omega$。\n\n问题设置：\n1. 定义一个在球面上（相对于坐标基）纯标量的综合微扰：\n   - $h_{tt}(t,r,\\theta,\\phi)=H_0(r)\\,T_h(t)\\,Y_{\\ell_h m_h}(\\theta,\\phi)$,\n   - $h_{rr}(t,r,\\theta,\\phi)=H_2(r)\\,T_h(t)\\,Y_{\\ell_h m_h}(\\theta,\\phi)$,\n   - 所有其他分量 $h_{\\mu\\nu}$ 均设为零。\n   这里 $H_0(r)$ 和 $H_2(r)$ 是光滑的径向轮廓，$T_h(t)$ 是光滑的时间轮廓。对于本任务，请使用经过充分检验的函数 $H_0(r)=\\exp\\!\\left(-\\frac{(r-r_{0,h})^2}{2\\sigma_h^2}\\right)$、$H_2(r)=\\exp\\!\\left(-\\frac{(r-r_{0,h})^2}{2\\sigma_h^2}\\right)$ 和 $T_h(t)=\\cos(\\omega_h t)$。\n\n2. 定义一个纯径向的规范矢量 $\\xi^\\mu$，没有时间或角度分量：\n   - $\\xi^\\mu=(0,\\xi^r,0,0)$，其中 $\\xi^r(t,r,\\theta,\\phi)=A_r\\,W_r(r)\\,T_\\xi(t)\\,Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi)$，\n   - 其中 $W_r(r)=\\exp\\!\\left(-\\frac{(r-r_{0,\\xi})^2}{2\\sigma_\\xi^2}\\right)$ 且 $T_\\xi(t)=\\cos(\\omega_\\xi t)$。\n\n3. 在平直背景的球坐标中，实现规范变换 $h'_{\\mu\\nu}=h_{\\mu\\nu}-\\nabla_\\mu\\xi_\\nu-\\nabla_\\nu\\xi_\\mu$。使用协矢量协变导数的一般定义 $\\nabla_\\mu \\xi_\\nu=\\partial_\\mu \\xi_\\nu-\\Gamma^\\lambda_{\\mu\\nu}\\xi_\\lambda$，其中 $\\Gamma^\\lambda_{\\mu\\nu}$ 是背景度规的 Christoffel 符号。然后，对于上述仅有径向分量的规范矢量，在固定的 $(t,r)$ 处计算变换后的 $h'_{rr}$ 和 $h'_{tt}$，并将其角度依赖性展开为球谐函数。\n\n4. 球谐分解：对于在选定 $(t,r)$ 处的每个球面上标量分量 $f(\\theta,\\phi)$（包括 $h_{rr}$、$h'_{rr}$、$h_{tt}$ 和 $h'_{tt}$），使用球面上的数值求积方法计算其系数 $f^{\\ell m}$，直至指定的 $\\ell_{\\max}$。为确保准确性和普适性，对极角积分使用关于 $x=\\cos\\theta$ 的高斯求积，对 $\\phi \\in [0,2\\pi)$ 的积分使用均匀梯形求积。请确保您的数值积分正确地表示 $\\int f(\\theta,\\phi)\\,Y^*_{\\ell m}(\\theta,\\phi)\\,d\\Omega$。\n\n5. 将 $tt$ 分量的 $(\\ell,m)$ 模式定义为此任务的主变量（master variable），\n   $$\\mathcal{M}_{\\ell m}(t,r):=\\int h_{tt}(t,r,\\theta,\\phi)\\,Y^*_{\\ell m}(\\theta,\\phi)\\,d\\Omega.$$\n   对于上面指定的仅有径向分量且 $\\xi^t=0$ 的规范矢量，数值上证明 $\\mathcal{M}_{\\ell m}$ 在此规范变换下保持不变。\n\n需要数值验证的内容：\n- 规范变分的模式局域性：令 $\\delta h_{rr}:=h'_{rr}-h_{rr}$。证明球谐系数 $(\\delta h_{rr})^{\\ell m}$ 在严格的数值容差内，对于所有 $(\\ell,m)\\neq(\\ell_\\xi,m_\\xi)$ 均消失。\n- 与不相关模式的解耦：如果 $(\\ell_h,m_h)\\neq(\\ell_\\xi,m_\\xi)$，验证度规原始 $(\\ell_h,m_h)$ 模式在 $h_{rr}$ 中的系数在规范变换下保持不变，即在容差范围内 $|h_{rr}'^{\\ell_h m_h}-h_{rr}^{\\ell_h m_h}|  10^{-6}$。\n- 主变量的规范不变性：验证对于给定类别的 $\\xi^\\mu$，从 $h_{tt}$ 计算的主变量 $\\mathcal{M}_{\\ell_h m_h}$ 在规范变换下的变化在 $10^{-10}$ 容差内，则为 True，否则为 False。\n- 目标模式上的振幅一致性：对于平直时空中的纯径向规范矢量，从第一性原理推导出 $\\delta h_{rr}=-2\\,\\partial_r \\xi_r$。由此得出，在选定的 $(t,r)$ 处，$(\\delta h_{rr})^{\\ell_\\xi m_\\xi}=-2\\,\\partial_r \\xi_r$。使用 $W_r'(r)=-\\frac{r-r_{0,\\xi}}{\\sigma_\\xi^2}W_r(r)$，预测的目标模式振幅为\n  $$A_{\\text{pred}}=-2\\,A_r\\,W_r'(r)\\,T_\\xi(t)。$$\n  数值验证 $(\\delta h_{rr})^{\\ell_\\xi m_\\xi}$ 在容差范围内等于 $A_{\\text{pred}}$，即 $|(\\delta h_{rr})^{\\ell_\\xi m_\\xi}-A_{\\text{pred}}|  10^{-6}$。\n\n数值和算法约束：\n- 角度必须使用弧度制。\n- 使用关于 $x=\\cos\\theta$ 的高斯求积和关于 $\\phi$ 的均匀求积来实现球谐投影。使用足够精细的网格，以使系数的绝对误差小于 $10^{-6}$。\n- 使用具有标准正交归一化的复球谐函数 $Y_{\\ell m}$。\n\n测试套件：\n在以下四个测试用例上评估您的程序。在每个用例中，使用以下参数和定义，在指定的 $(t,r)$ 处进行计算。对于所有用例，使用 $H_0(r)=\\exp(-\\frac{(r-r_{0,h})^2}{2\\sigma_h^2})$、$H_2(r)=\\exp(-\\frac{(r-r_{0,h})^2}{2\\sigma_h^2})$、$T_h(t)=\\cos(\\omega_h t)$、$\\xi^r=A_r\\,\\exp(-\\frac{(r-r_{0,\\xi})^2}{2\\sigma_\\xi^2})\\,\\cos(\\omega_\\xi t)\\,Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi)$，并取 $\\ell_{\\max}=\\max(\\ell_h,\\ell_\\xi)+2$。\n\n- 用例 1：\n  - $(\\ell_h,m_h)=(2,0)$, $(\\ell_\\xi,m_\\xi)=(3,1)$,\n  - $r=7.3$, $t=0.4$,\n  - $r_{0,h}=7.0$, $\\sigma_h=1.2$, $\\omega_h=0.9$,\n  - $A_r=0.3$, $r_{0,\\xi}=6.0$, $\\sigma_\\xi=1.5$, $\\omega_\\xi=1.1$.\n\n- 用例 2：\n  - $(\\ell_h,m_h)=(3,-2)$, $(\\ell_\\xi,m_\\xi)=(3,-2)$,\n  - $r=4.1$, $t=1.0$,\n  - $r_{0,h}=4.0$, $\\sigma_h=0.9$, $\\omega_h=1.3$,\n  - $A_r=0.5$, $r_{0,\\xi}=4.0$, $\\sigma_\\xi=0.8$, $\\omega_\\xi=0.7$.\n\n- 用例 3：\n  - $(\\ell_h,m_h)=(2,2)$, $(\\ell_\\xi,m_\\xi)=(1,1)$,\n  - $r=10.0$, $t=0.25$,\n  - $r_{0,h}=10.0$, $\\sigma_h=1.0$, $\\omega_h=1.0$,\n  - $A_r=0.2$, $r_{0,\\xi}=9.0$, $\\sigma_\\xi=2.0$, $\\omega_\\xi=1.5$.\n\n- 用例 4：\n  - $(\\ell_h,m_h)=(0,0)$, $(\\ell_\\xi,m_\\xi)=(0,0)$,\n  - $r=5.0$, $t=0.6$,\n  - $r_{0,h}=5.0$, $\\sigma_h=0.5$, $\\omega_h=0.3$,\n  - $A_r=0.7$, $r_{0,\\xi}=5.0$, $\\sigma_\\xi=1.7$, $\\omega_\\xi=1.2$.\n\n要求的输出和格式：\n- 对于每个用例，按此顺序生成四个布尔值结果：\n  1. $b_1$：如果所有 $(\\delta h_{rr})^{\\ell m}$（其中 $(\\ell,m)\\neq(\\ell_\\xi,m_\\xi)$）的绝对值都小于 $10^{-6}$，则为 True，否则为 False。\n  2. $b_2$：如果 $(\\ell_h,m_h)\\neq(\\ell_\\xi,m_\\xi)$ 且 $|h_{rr}'^{\\ell_h m_h}-h_{rr}^{\\ell_h m_h}|  10^{-6}$，或者如果 $(\\ell_h,m_h)=(\\ell_\\xi,m_\\xi)$（此情况自然为 True），则为 True，否则为 False。\n  3. $b_3$：如果从 $h_{tt}$ 计算的主变量 $\\mathcal{M}_{\\ell_h m_h}$ 在规范变换下的变化在 $10^{-10}$ 容差内，则为 True，否则为 False。\n  4. $b_4$：如果 $|(\\delta h_{rr})^{\\ell_\\xi m_\\xi}-A_{\\text{pred}}|  10^{-6}$，则为 True，否则为 False。\n- 将四个用例的所有结果聚合到一个长度为 $16$ 的扁平列表中，顺序为 $[b_1^{(1)},b_2^{(1)},b_3^{(1)},b_4^{(1)},b_1^{(2)},\\dots,b_4^{(4)}]$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，`[True,False,True,...]`）。\n\n不允许外部输入；所有常量和参数必须在程序中定义。您的程序打印的最后一行必须严格是指定的单行列表。", "solution": "该问题定义明确且科学上合理，是线性化广义相对论中的一个标准练习。我们将首先推导规范变换的解析形式，为数值验证提供理论基础。\n\n背景时空是闵可夫斯基时空，其在球坐标 $(t,r,\\theta,\\phi)$ 下的度规由下式给出\n$$g_{\\mu\\nu} = \\mathrm{diag}(-1, 1, r^2, r^2\\sin^2\\theta)$$\n由矢量场 $\\xi^\\mu$ 生成的度规微扰 $h_{\\mu\\nu}$ 的无穷小规范变换为：\n$$h'_{\\mu\\nu} = h_{\\mu\\nu} - \\nabla_\\mu \\xi_\\nu - \\nabla_\\nu \\xi_\\mu$$\n其中 $\\nabla_\\mu$ 是与背景度规 $g_{\\mu\\nu}$ 兼容的协变导数。协矢量 $\\xi_\\nu$ 的协变导数由 $\\nabla_\\mu \\xi_\\nu = \\partial_\\mu \\xi_\\nu - \\Gamma^\\lambda_{\\mu\\nu}\\xi_\\lambda$ 给出，其中 $\\Gamma^\\lambda_{\\mu\\nu}$ 是背景度规的 Christoffel 符号。闵可夫斯基度规在球坐标系中的非零 Christoffel 符号为：\n\\begin{align*}\n\\Gamma^r_{\\theta\\theta} = -r \\\\ \\Gamma^r_{\\phi\\phi} = -r \\sin^2\\theta \\\\\n\\Gamma^\\theta_{r\\theta} = \\frac{1}{r} \\\\ \\Gamma^\\theta_{\\phi\\phi} = -\\sin\\theta \\cos\\theta \\\\\n\\Gamma^\\phi_{r\\phi} = \\frac{1}{r} \\\\ \\Gamma^\\phi_{\\theta\\phi} = \\cot\\theta\n\\end{align*}\n\n问题指定了一个纯径向的规范矢量 $\\xi^\\mu = (0, \\xi^r, 0, 0)$，其中 $\\xi^r = A_r W_r(r) T_\\xi(t) Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi)$。我们首先降低指标以获得协矢量 $\\xi_\\mu = g_{\\mu\\nu}\\xi^\\nu$：\n\\begin{align*}\n\\xi_t = g_{tt}\\xi^t = (-1)(0) = 0 \\\\\n\\xi_r = g_{rr}\\xi^r = (1)\\xi^r = \\xi^r \\\\\n\\xi_\\theta = g_{\\theta\\theta}\\xi^\\theta = (r^2)(0) = 0 \\\\\n\\xi_\\phi = g_{\\phi\\phi}\\xi^\\phi = (r^2\\sin^2\\theta)(0) = 0\n\\end{align*}\n唯一非零的分量是 $\\xi_r$。规范变分 $\\delta h_{\\mu\\nu} = h'_{\\mu\\nu} - h_{\\mu\\nu} = -\\nabla_\\mu \\xi_\\nu - \\nabla_\\nu \\xi_\\mu$ 现在可以逐分量计算。由于只有 $\\xi_r$ 非零，一般表达式 $\\nabla_\\mu \\xi_\\nu = \\partial_\\mu \\xi_\\nu - \\Gamma^\\lambda_{\\mu\\nu}\\xi_\\lambda$ 简化为 $\\nabla_\\mu \\xi_\\nu = \\partial_\\mu \\xi_\\nu - \\Gamma^r_{\\mu\\nu}\\xi_r$。\n\n此问题相关的规范变分 $\\delta h_{\\mu\\nu}$ 的分量是：\n- 对于 $h_{tt}$：$\\delta h_{tt} = -(\\nabla_t \\xi_t + \\nabla_t \\xi_t) = -2(\\partial_t \\xi_t - \\Gamma^\\lambda_{tt}\\xi_\\lambda) = 0$，因为 $\\xi_t=0$ 且所有 $\\Gamma^\\lambda_{tt}=0$。\n- 对于 $h_{rr}$：$\\delta h_{rr} = -(\\nabla_r \\xi_r + \\nabla_r \\xi_r) = -2(\\partial_r \\xi_r - \\Gamma^\\lambda_{rr}\\xi_\\lambda)$。因为所有 $\\Gamma^\\lambda_{rr}=0$，这简化为 $\\delta h_{rr} = -2\\partial_r \\xi_r$。\n\n这就建立了数值检验所需的解析预测。\n\n1.  **主变量 $\\mathcal{M}_{\\ell m}$ 的规范不变性**：主变量被定义为 $h_{tt}$ 的球谐投影：$\\mathcal{M}_{\\ell m} = \\int h_{tt} Y^*_{\\ell m} d\\Omega$。变换后的微扰是 $h'_{tt} = h_{tt} + \\delta h_{tt}$。由于我们发现 $\\delta h_{tt} = 0$，因此可以精确地得出 $h'_{tt} = h_{tt}$。因此，对于所有的 $(\\ell,m)$，主变量必须是规范不变的，即 $\\mathcal{M}'_{\\ell m} = \\mathcal{M}_{\\ell m}$。数值检验应在数值求积的精度范围内证实这一点，对于一个零被积函数，其结果应接近机器精度。\n\n2.  **$\\delta h_{rr}$ 的模式依赖性**：我们推导出 $\\delta h_{rr} = -2\\partial_r \\xi_r$。代入 $\\xi_r$ 的定义：\n    $$\\delta h_{rr}(t,r,\\theta,\\phi) = -2 \\partial_r \\left[ A_r W_r(r) T_\\xi(t) Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi) \\right]$$\n    由于在对 $r$ 求偏导时 $t, \\theta, \\phi$ 保持不变：\n    $$\\delta h_{rr} = -2 A_r W'_r(r) T_\\xi(t) Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi)$$\n    其中 $W'_r(r) = \\frac{d}{dr}W_r(r)$。该变分的球谐系数由下式给出：\n    $$(\\delta h_{rr})^{\\ell m} = \\int \\delta h_{rr} Y^*_{\\ell m} d\\Omega = \\left[-2 A_r W'_r(r) T_\\xi(t)\\right] \\int Y_{\\ell_\\xi m_\\xi}(\\theta,\\phi) Y^*_{\\ell m}(\\theta,\\phi) d\\Omega$$\n    由于球谐函数的正交归一性 $\\int Y_{\\ell' m'} Y^*_{\\ell m} d\\Omega = \\delta_{\\ell\\ell'}\\delta_{mm'}$，积分结果为 $\\delta_{\\ell\\ell_\\xi}\\delta_{mm_\\xi}$。因此，系数为：\n    $$(\\delta h_{rr})^{\\ell m} = \\begin{cases} -2 A_r W'_r(r) T_\\xi(t)  \\text{如果 } (\\ell,m) = (\\ell_\\xi, m_\\xi) \\\\ 0  \\text{如果 } (\\ell,m) \\neq (\\ell_\\xi, m_\\xi) \\end{cases}$$\n    这一个结果为三个数值检验提供了理论基础：\n    - **$b_1$（模式局域性）：** 对于所有不等于规范矢量模式 $(\\ell_\\xi,m_\\xi)$ 的模式 $(\\ell,m)$，其系数 $(\\delta h_{rr})^{\\ell m}$ 在解析上为零。\n    - **$b_2$（解耦）：** 度规的 $(\\ell_h, m_h)$ 模式的变化量 $h_{rr}'^{\\ell_h m_h} - h_{rr}^{\\ell_h m_h}$ 等于 $(\\delta h_{rr})^{\\ell_h m_h}$。如果 $(\\ell_h,m_h) \\neq (\\ell_\\xi,m_\\xi)$，这个变化量为零。\n    - **$b_4$（振幅一致性）：** 唯一的非零模式的系数 $(\\delta h_{rr})^{\\ell_\\xi m_\\xi}$ 必须等于预测的振幅 $A_{\\text{pred}} = -2 A_r W'_r(r) T_\\xi(t)$。使用所提供的导数 $W'_r(r) = -\\frac{r-r_{0,\\xi}}{\\sigma_\\xi^2}W_r(r)$，我们得到精确的预测 $A_{\\text{pred}} = 2 A_r \\frac{r-r_{0,\\xi}}{\\sigma_\\xi^2} \\exp\\!\\left(-\\frac{(r-r_{0,\\xi})^2}{2\\sigma_\\xi^2}\\right) \\cos(\\omega_\\xi t)$。\n\n数值算法将通过在二维角度网格上计算初始和变换后的度规微扰，使用数值求积进行球谐投影，并将结果与这些解析预测进行比较来进行。", "answer": "```python\nimport numpy as np\nfrom scipy.special import sph_harm, roots_legendre\n\ndef solve():\n    \"\"\"\n    Numerically verifies gauge transformation properties in linearized gravity.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {'lh': 2, 'mh': 0, 'lxi': 3, 'mxi': 1, 'r': 7.3, 't': 0.4, \n         'r0h': 7.0, 'sigmah': 1.2, 'omegah': 0.9, \n         'Ar': 0.3, 'r0xi': 6.0, 'sigmaxi': 1.5, 'omegaxi': 1.1},\n        # Case 2\n        {'lh': 3, 'mh': -2, 'lxi': 3, 'mxi': -2, 'r': 4.1, 't': 1.0, \n         'r0h': 4.0, 'sigmah': 0.9, 'omegah': 1.3, \n         'Ar': 0.5, 'r0xi': 4.0, 'sigmaxi': 0.8, 'omegaxi': 0.7},\n        # Case 3\n        {'lh': 2, 'mh': 2, 'lxi': 1, 'mxi': 1, 'r': 10.0, 't': 0.25, \n         'r0h': 10.0, 'sigmah': 1.0, 'omegah': 1.0, \n         'Ar': 0.2, 'r0xi': 9.0, 'sigmaxi': 2.0, 'omegaxi': 1.5},\n        # Case 4\n        {'lh': 0, 'mh': 0, 'lxi': 0, 'mxi': 0, 'r': 5.0, 't': 0.6, \n         'r0h': 5.0, 'sigmah': 0.5, 'omegah': 0.3, \n         'Ar': 0.7, 'r0xi': 5.0, 'sigmaxi': 1.7, 'omegaxi': 1.2},\n    ]\n\n    all_results = []\n    \n    # Quadrature grid settings - generous for high accuracy\n    N_theta = 100\n    N_phi = 200\n\n    # Get Gaussian quadrature points (x=cos(theta)) and weights\n    x_points, w_weights = roots_legendre(N_theta)\n    theta_points = np.arccos(x_points)\n    \n    # Uniform grid for phi\n    phi_points = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n    \n    # Create 2D grids for angular evaluation\n    phi_grid, theta_grid = np.meshgrid(phi_points, theta_points)\n\n    def project(field_on_grid, l_proj, m_proj):\n        \"\"\"\n        Projects a scalar field on the sphere onto a spherical harmonic Y_lm.\n        Integral: integral(f(theta,phi) * Y_lm^*(theta,phi) * sin(theta) dtheta dphi)\n        This is equivalent to integral(f * Y_lm^* dx dphi) where x=cos(theta).\n        \"\"\"\n        Y_lm_star_grid = np.conj(sph_harm(m_proj, l_proj, phi_grid, theta_grid))\n        integrand = field_on_grid * Y_lm_star_grid\n        \n        # Integrate over phi using trapezoidal rule\n        integral_phi = (2 * np.pi / N_phi) * np.sum(integrand, axis=1)\n        \n        # Integrate over theta (via x=cos(theta)) using Gaussian quadrature\n        full_integral = np.sum(w_weights * integral_phi)\n        \n        return full_integral\n\n    for case in test_cases:\n        lh, mh = case['lh'], case['mh']\n        lxi, mxi = case['lxi'], case['mxi']\n        r, t = case['r'], case['t']\n        r0h, sigmah, omegah = case['r0h'], case['sigmah'], case['omegah']\n        Ar, r0xi, sigmaxi, omegaxi = case['Ar'], case['r0xi'], case['sigmaxi'], case['omegaxi']\n\n        l_max = max(lh, lxi) + 2\n\n        # Define radial and temporal profile functions\n        H0 = lambda r_val: np.exp(-(r_val - r0h)**2 / (2 * sigmah**2))\n        H2 = lambda r_val: np.exp(-(r_val - r0h)**2 / (2 * sigmah**2))\n        Th = lambda t_val: np.cos(omegah * t_val)\n        \n        Wr = lambda r_val: np.exp(-(r_val - r0xi)**2 / (2 * sigmaxi**2))\n        dWr_dr = lambda r_val: -(r_val - r0xi) / sigmaxi**2 * Wr(r_val)\n        Txi = lambda t_val: np.cos(omegaxi * t_val)\n\n        # Evaluate scalar parts of fields at the specified (t,r)\n        h_scalar_part = H2(r) * Th(t)\n        # h_tt's scalar part is H0(r)*Th(t), which is the same as H2(r)*Th(t) for this problem\n        \n        # Evaluate spherical harmonics on the grid\n        Y_lh_mh_grid = sph_harm(mh, lh, phi_grid, theta_grid)\n        Y_lxi_mxi_grid = sph_harm(mxi, lxi, phi_grid, theta_grid)\n\n        # Construct the fields on the angular grid\n        h_rr_grid = h_scalar_part * Y_lh_mh_grid\n        h_tt_grid = h_scalar_part * Y_lh_mh_grid # using H0=H2\n\n        # Calculate the gauge variation delta_h_rr\n        A_pred_scalar = -2 * Ar * dWr_dr(r) * Txi(t)\n        # delta_h_rr = A_scalar * Y_lm.\n        delta_h_rr_grid = -2 * Ar * dWr_dr(r) * Txi(t) * Y_lxi_mxi_grid\n        \n        # Transformed fields\n        h_rr_prime_grid = h_rr_grid + delta_h_rr_grid\n        h_tt_prime_grid = h_tt_grid  # delta_h_tt is zero\n\n        # --- Perform projections and store coefficients ---\n        coeffs = {}\n        for l in range(l_max + 1):\n            for m in range(-l, l + 1):\n                key = (l, m)\n                coeffs[key] = {\n                    'h_rr': project(h_rr_grid, l, m),\n                    'h_rr_prime': project(h_rr_prime_grid, l, m),\n                    'h_tt': project(h_tt_grid, l, m),\n                    'h_tt_prime': project(h_tt_prime_grid, l, m),\n                }\n\n        # --- Perform Verifications ---\n        \n        # b1: Mode locality of delta_h_rr\n        b1 = True\n        for l in range(l_max + 1):\n            for m in range(-l, l + 1):\n                if (l, m) != (lxi, mxi):\n                    delta_h_rr_lm = coeffs[(l, m)]['h_rr_prime'] - coeffs[(l, m)]['h_rr']\n                    if abs(delta_h_rr_lm) >= 1e-6:\n                        b1 = False\n                        break\n            if not b1: break\n\n        # b2: Decoupling of unrelated modes\n        if (lh, mh) == (lxi, mxi):\n            b2 = True  # Vacuously true as per problem\n        else:\n            h_rr_lhmh = coeffs[(lh, mh)]['h_rr']\n            h_rr_prime_lhmh = coeffs[(lh, mh)]['h_rr_prime']\n            b2 = abs(h_rr_prime_lhmh - h_rr_lhmh)  1e-6\n\n        # b3: Gauge invariance of Master Variable M_lhmh\n        M_lhmh = coeffs[(lh, mh)]['h_tt']\n        M_prime_lhmh = coeffs[(lh, mh)]['h_tt_prime']\n        # This difference should be close to machine precision as delta_h_tt is analytically zero.\n        b3 = abs(M_prime_lhmh - M_lhmh)  1e-10\n\n        # b4: Amplitude consistency on the target mode\n        delta_h_rr_lximxi = coeffs[(lxi, mxi)]['h_rr_prime'] - coeffs[(lxi, mxi)]['h_rr']\n        A_pred = -2 * Ar * dWr_dr(r) * Txi(t)\n        b4 = abs(delta_h_rr_lximxi - A_pred)  1e-6\n\n        all_results.extend([b1, b2, b3, b4])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3478804"}, {"introduction": "在真实的数值相对论模拟中，我们得到的度规扰动数据往往是物理引力波信号与非物理规范“噪声”的混合体。最后一个练习将带您直面该领域的核心挑战之一：如何从“脏”数据中提纯出物理信号。您将设计并实现一个基于最小二乘法的优化方案，寻找一个“最佳”的规范变换来消除这些规范伪影，从而精确地提取出引力波的“+”（plus）和“×”（cross）两种物理极化分量的振幅。[@problem_id:3478836]", "problem": "考虑在闵可夫斯基背景下的线性化引力，其中时空度规写作 $g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$，且 $\\lvert h_{\\mu\\nu} \\rvert \\ll 1$。在由矢量场 $\\xi^\\mu$ 生成的无穷小规范变换下，度规微扰的变换形式为 $h'_{\\mu\\nu} = h_{\\mu\\nu} - \\partial_\\mu \\xi_\\nu - \\partial_\\nu \\xi_\\mu$。在洛伦兹规范中，残余规范变换是指其规范矢量满足波动方程 $\\Box \\xi^\\mu = 0$ 的变换。对于真空中的平面波解，物理自由度被编码在空间度规微扰 $h_{ij}$ 的横向无迹（TT）部分中，对于波矢 $k^i$，该部分遵循条件 $k^i h^{\\text{TT}}_{ij} = 0$ 和 $\\delta^{ij} h^{\\text{TT}}_{ij} = 0$。两种物理极化，通常表示为“加”模和“叉”模，是通过将 $h^{\\text{TT}}_{ij}$ 投影到垂直于传播方向的平面上的一个标准正交基来获得的。\n\n给定来自混合规范数值模拟的 $h_{ij}$ 的合成傅里叶模式表示。这些表示包括纯TT信号、由残余规范变换产生的纯规范贡献，以及微小的非TT数值噪声。你的任务是设计并实现一种方法，通过求解一个约束最小二乘问题来推断物理极化。该问题旨在寻找一个空间规范矢量振幅（每个模式），以最小化变换后空间微扰的横向性和无迹性的违反程度，同时保持与所选傅里叶模式的 $\\Box \\xi^\\mu = 0$ 条件的相容性。\n\n推导的基本依据：\n- 围绕闵可夫斯基时空的线性化爱因斯坦方程。\n- 度规微扰 $h_{\\mu\\nu}$ 的无穷小规范变换。\n- 残余洛伦兹规范的相容性条件 $\\Box \\xi^\\mu = 0$。\n- 横向无迹（TT）条件和物理极化的定义。\n\n问题要求：\n1. 构建一个最小二乘目标，该目标惩罚变换后的空间微扰 $h'_{ij}$ 对于给定波矢 $k^i$ 未能满足横向和无迹条件的程度。该目标必须只涉及规范矢量的空间导数的线性组合（在傅里叶空间中，这些变为关于 $k^i$ 的代数式），并且不应假设任何用于最终解的简便公式。必须通过确保色散一致的模式来强制执行相容性条件 $\\Box \\xi^\\mu = 0$，即对于角频率为 $\\omega$ 的傅里叶模式，在应用任何规范校正之前，强制执行 $\\omega^2 = \\lvert k \\rvert^2$。如果不满足相容性条件，则不应应用任何规范校正。\n2. 从第一性原理出发，推导一个算法来计算一个经过规范调整的空间微扰 $h'_{ij}$，该微扰使你的最小二乘目标最小化，然后计算 $h'_{ij}$ 的TT投影，通过投影到垂直于单位传播方向 $n^i = k^i / \\lvert k \\rvert$ 的标准正交基 $\\{e_1, e_2\\}$ 上，提取物理上的加极化和叉极化。\n3. 将该方法实现为一个完整的、可运行的程序，对于每个测试用例，返回推断出的加极化和叉极化的值。所有输出都是无量纲的浮点数（无物理单位）。\n4. 横向无迹（TT）投影必须使用标准空间投影算子 $P_{ij} = \\delta_{ij} - n_i n_j$ 在与 $n^i$ 正交的平面上进行，然后由 $P_{ij}$ 和 $h'_{ij}$ 构建TT分量。极化振幅必须使用横向标准正交基从 $h^{\\text{TT}}_{ij}$ 计算。\n5. 你的程序必须独立处理每个测试用例，为该用例强制执行 $\\Box \\xi^\\mu = 0$ 的相容性，并按下文规定生成最终的极化值。\n\n测试套件：\n- 通用约定：\n  - 使用光速 $c = 1$ 的单位制，因此色散相容性为 $\\omega = \\lvert k \\rvert$。\n  - 当 $k = (0, 0, k)$ 时，波沿+z方向传播。\n  - 对于沿+z方向传播的波，振幅为 $A_+$ 的纯“加”极化具有 $h_{xx} = A_+$，$h_{yy} = -A_+$，所有其他分量为零。振幅为 $A_\\times$ 的纯“叉”极化具有 $h_{xy} = h_{yx} = A_\\times$，所有其他分量为零。\n  - 对于具有空间规范振幅 $u_j$ 的平面波，规范污染通过向空间 $h_{ij}$ 添加对称张量 $G_{ij} = k_i u_j + k_j u_i$ 来建模（在傅里叶空间中）。\n\n- 测试用例1（理想情况，纯TT）：\n  - $k = (0, 0, 1)$，$\\omega = 1$，正则化权重 $\\lambda = 1$。\n  - $h_{ij}$ 是纯加模式，其中 $A_+ = 1.0 \\times 10^{-21}$ 且 $A_\\times = 0$。\n\n- 测试用例2（TT加残余规范）：\n  - $k = (0, 0, 1)$，$\\omega = 1$，$\\lambda = 1$。\n  - 基础TT信号：$A_+ = 1.0 \\times 10^{-21}$，$A_\\times = 0$。\n  - 添加规范污染，其中 $u = (0.5 \\times 10^{-21}, -0.3 \\times 10^{-21}, 0.2 \\times 10^{-21})$，即 $h_{ij} \\leftarrow h_{ij} + G_{ij}$，其中 $G_{ij} = k_i u_j + k_j u_i$。\n\n- 测试用例3（含两种极化、规范污染和微小对称噪声的TT信号）：\n  - $k = (0, 0, 1)$，$\\omega = 1$，$\\lambda = 1$。\n  - 基础TT信号：$A_+ = 0.8 \\times 10^{-21}$，$A_\\times = 0.5 \\times 10^{-21}$。\n  - 通过上述 $G_{ij}$ 添加规范污染，其中 $u = (-0.4 \\times 10^{-21}, 0.6 \\times 10^{-21}, 0.1 \\times 10^{-21})$。\n  - 向 $h_{ij}$ 添加均值为零、标准差为 $1.0 \\times 10^{-23}$ 的对称噪声 $N_{ij}$，该噪声通过在固定种子上播种伪随机数生成器并对称化一个矩阵以确保 $N_{ij} = N_{ji}$ 来构建。\n\n- 测试用例4（边界情况：纯规范但色散不相容，不应用校正）：\n  - $k = (0, 0, 1)$，$\\omega = 2$，$\\lambda = 1$。\n  - 基础TT信号：$A_+ = 0$，$A_\\times = 0$。\n  - 通过 $G_{ij}$ 添加规范污染，其中 $u = (0.7 \\times 10^{-21}, -0.2 \\times 10^{-21}, 0.1 \\times 10^{-21})$。\n\n要求的最终输出格式：\n- 你的程序应生成一行输出，其中包含所有测试用例的推断极化振幅，形式为一个逗号分隔的八个浮点数列表，顺序为 $[A^{(1)}_+, A^{(1)}_\\times, A^{(2)}_+, A^{(2)}_\\times, A^{(3)}_+, A^{(3)}_\\times, A^{(4)}_+, A^{(4)}_\\times]$，并用方括号括起来。所有振幅都是无量纲的，并且必须在不带任何单位的情况下打印。\n\n角度单位不适用。输出中没有物理单位，因为引力波应变是无量纲的。", "solution": "该问题要求构建并实现一种方法，从受到残余规范赝品和噪声污染的数值生成的空间度规微扰 $h_{ij}$ 中提取引力波的物理极化振幅。这需要通过求解一个约束最小二乘问题来实现。\n\n### 问题验证\n\n该问题在科学上基于成熟的线性化引力理论。所有给出的术语——规范变换、洛伦兹规范条件（$\\Box \\xi^\\mu = 0$）、横向无迹（TT）投影和极化模式——都是广义相对论中的标准概念。问题是良构的，提供了明确的目标（最小化非TT残差）、测试用例中的充分数据以及精确的输出格式。没有矛盾、模糊之处或伪科学论述。该问题被判定为**有效**。\n\n### 理论构建与算法设计\n\n**1. 傅里叶空间中的规范变换**\n\n分析在傅里叶空间中进行，其中每个场都由其对应特定四维波矢 $k^\\mu = (\\omega, \\mathbf{k})$ 的傅里叶振幅表示。偏导数 $\\partial_\\mu$ 变换为乘以 $i k_\\mu$。\n给定的度规微扰，我们表示为 $h_{ij}^{\\text{obs}}$，被假定为一个纯物理信号 $h_{ij}^{\\text{TT}}$ 被规范部分和噪声所污染。由矢量场 $\\xi^\\mu$ 生成的无穷小规范变换将度规微扰修改为 $h'_{\\mu\\nu} = h_{\\mu\\nu} - (\\partial_\\mu \\xi_\\nu + \\partial_\\nu \\xi_\\mu)$。对于振幅为 $\\tilde{\\xi}_\\nu$ 的单个傅里叶模式，这变为 $\\tilde{h}'_{\\mu\\nu} = \\tilde{h}_{\\mu\\nu} - i(k_\\mu \\tilde{\\xi}_\\nu + k_\\nu \\tilde{\\xi}_\\mu)$。\n\n我们寻求找到一个最优的规范矢量来“清理”观测数据。设该矢量傅里叶振幅的空间分量为 $\\zeta_j$。经过规范校正的空间度规微扰 $h'_{ij}$ 于是为：\n$$\nh'_{ij} = h_{ij}^{\\text{obs}} - (i k_i \\zeta_j + i k_j \\zeta_i)\n$$\n为了与问题中省略了因子 $i$ 的规范污染定义保持一致，我们重定义 $\\zeta_j$ 以吸收它。因此，我们的目标是找到一个实矢量 $\\zeta_j$，使得以下表达式的非TT性质最小化：\n$$\nh'_{ij} = h_{ij}^{\\text{obs}} - (k_i \\zeta_j + k_j \\zeta_i)\n$$\n\n**2. 最小二乘目标函数**\n\n物理自由度存在于度规的横向无迹（TT）部分。$h'_{ij}$ 的TT条件是：\n1.  **横向性**：$k^i h'_{ij} = 0$（对于 $j=1,2,3$）。\n2.  **无迹性**：$\\delta^{ij} h'_{ij} = 0$。\n\n我们定义一个成本函数 $C(\\zeta)$，用于惩罚对这些条件的偏离。设 $R_j = k^i h'_{ij}$ 为横向性残差矢量，$S = \\delta^{ij} h'_{ij}$ 为无迹性残差标量。目标函数是这些残差的模方和：\n$$\nC(\\zeta) = \\sum_{j=1}^3 |R_j|^2 + \\lambda |S|^2\n$$\n问题指定了正则化权重 $\\lambda=1$，表示两个条件同等重要。代入 $h'_{ij}$ 的表达式：\n$$\nR_j = k^i h^{\\text{obs}}_{ij} - |k|^2 \\zeta_j - k_j(k^m \\zeta_m)\n$$\n$$\nS = \\delta^{ij} h^{\\text{obs}}_{ij} - 2(k^m \\zeta_m)\n$$\n其中 $|k|^2 = k_m k^m$，我们假设空间索引使用欧几里得度规。令 $v_j = k^i h^{\\text{obs}}_{ij}$ 且 $T = \\delta^{ij} h^{\\text{obs}}_{ij}$。目标是找到 $\\zeta = (\\zeta_1, \\zeta_2, \\zeta_3)$ 来最小化：\n$$\nC(\\zeta) = \\sum_{j=1}^3 |v_j - |k|^2 \\zeta_j - k_j(k^m \\zeta_m)|^2 + |T - 2(k^m \\zeta_m)|^2\n$$\n这是一个标准的线性最小二乘问题，可以表示为最小化 $\\|A\\zeta - b\\|^2$，其解由正规方程组 $(A^T A) \\zeta = A^T b$ 给出。\n\n**3. 最优规范矢量 $\\zeta$ 的推导**\n\n为找到最小值，我们令偏导数 $\\partial C / \\partial \\zeta_m = 0$（对于 $m=1,2,3$）。虽然这可以对一个通用的波矢 $\\mathbf{k}$ 求解，但如果我们将坐标系对齐，使 $\\mathbf{k}$ 指向 $z$ 轴，即 $\\mathbf{k}=(0, 0, K)$ 其中 $K=|\\mathbf{k}|$，则解会大大简化。由于所有测试用例都使用 $\\mathbf{k}=(0,0,1)$，这种简化对于手头的问题是合理且稳健的。\n\n当 $\\mathbf{k}=(0, 0, K)$ 时：\n-   $k \\cdot \\zeta = K \\zeta_3$\n-   $v_j = K h^{\\text{obs}}_{3j}$\n-   $R_1 = K h^{\\text{obs}}_{31} - K^2 \\zeta_1$\n-   $R_2 = K h^{\\text{obs}}_{32} - K^2 \\zeta_2$\n-   $R_3 = K h^{\\text{obs}}_{33} - K^2 \\zeta_3 - K(K\\zeta_3) = K h^{\\text{obs}}_{33} - 2K^2 \\zeta_3$\n-   $S = T - 2K \\zeta_3$\n\n成本函数变为：\n$$\nC(\\zeta_1, \\zeta_2, \\zeta_3) = (K h^{\\text{obs}}_{31} - K^2 \\zeta_1)^2 + (K h^{\\text{obs}}_{32} - K^2 \\zeta_2)^2 + (K h^{\\text{obs}}_{33} - 2K^2 \\zeta_3)^2 + (T - 2K \\zeta_3)^2\n$$\n分别对 $\\zeta_1$、$\\zeta_2$ 和 $\\zeta_3$ 求最小值得：\n-   $\\frac{\\partial C}{\\partial \\zeta_1}=0 \\implies \\zeta_1 = \\frac{h^{\\text{obs}}_{31}}{K} = \\frac{h^{\\text{obs}}_{13}}{K}$（假设 $h$ 是对称的）。\n-   $\\frac{\\partial C}{\\partial \\zeta_2}=0 \\implies \\zeta_2 = \\frac{h^{\\text{obs}}_{32}}{K} = \\frac{h^{\\text{obs}}_{23}}{K}$。\n-   $\\frac{\\partial C}{\\partial \\zeta_3}=0 \\implies (K h^{\\text{obs}}_{33} - 2K^2 \\zeta_3)(-2K^2) + (T-2K\\zeta_3)(-2K) = 0$。当 $\\lambda=1$ 时，解出 $\\zeta_3$：\n    $$\n    \\zeta_3 = \\frac{K^2 h^{\\text{obs}}_{33} + T}{2K(K^2+1)}\n    $$\n\n**4. 完整算法**\n\n为每个测试用例 $(h^{\\text{obs}}_{ij}, \\mathbf{k}, \\omega)$ 提取极化的完整流程如下：\n\n1.  **色散检查**：洛伦兹规范的残余规范自由度要求 $\\Box \\xi^\\mu = 0$，这在傅里叶空间中意味着 $k^\\mu k_\\mu = 0$，或 $\\omega^2 = |\\mathbf{k}|^2$（当 $c=1$ 时）。比较 $\\omega$ 和 $|\\mathbf{k}|$。如果它们不相等（在数值容差内），则模式是“离壳”的，不应执行规范校正（$h'_{ij} = h^{\\text{obs}}_{ij}$）。否则，继续。\n\n2.  **计算最优规范矢量 $\\zeta$**：使用观测到的 $h^{\\text{obs}}_{ij}$ 和波矢 $\\mathbf{k}=(0,0,K)$，利用上面推导的公式计算 $\\zeta$ 的分量。\n\n3.  **应用规范校正**：计算清理后的度规微扰：\n    $$\n    h'_{ij} = h^{\\text{obs}}_{ij} - (k_i \\zeta_j + k_j \\zeta_i)\n    $$\n    对于 $\\mathbf{k}=(0,0,K)$，校正项的非零分量是 $k_3 \\zeta_j + k_j \\zeta_3$，只影响索引为3的分量。\n\n4.  **TT投影与极化提取**：\n    - 将 $h'_{ij}$ 投影到垂直于传播方向 $\\mathbf{n} = \\mathbf{k}/|\\mathbf{k}|$ 的空间平面上。对于 $\\mathbf{n}=(0,0,1)$，这会分离出对应于 $xy$ 平面的左上角 $2 \\times 2$ 子矩阵。\n    - 极化振幅 $A_+$ 和 $A_\\times$ 从 $h'_{ij}$ 的这个横向部分中提取。对于沿+z方向传播的波，“加”和“叉”极化张量是对称无迹 $2 \\times 2$ 张量的基矩阵。振幅通过投影找到：\n    $$\n    A_+ = \\frac{1}{2}(h'_{11} - h'_{22})\n    $$\n    $$\n    A_\\times = h'_{12}\n    $$\n    这些公式直接给出了经过规范清理程序后的物理模式的振幅。\n\n该算法系统地移除了被最小二乘目标惩罚的规范赝品，保留了物理信号，然后可以将其分解为其典范极化模式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print the final result.\n    \"\"\"\n\n    def construct_h_tensor(A_plus, A_cross, scale=1e-21):\n        \"\"\"Constructs the spatial metric perturbation h_ij for pure TT modes.\"\"\"\n        h = np.zeros((3, 3))\n        h[0, 0] = A_plus * scale\n        h[1, 1] = -A_plus * scale\n        h[0, 1] = A_cross * scale\n        h[1, 0] = A_cross * scale\n        return h\n\n    def add_gauge_contamination(h, k, u, scale=1e-21):\n        \"\"\"Adds gauge contamination to h_ij.\"\"\"\n        u_vec = np.array(u, dtype=float) * scale\n        gauge_term = np.outer(k, u_vec) + np.outer(u_vec, k)\n        return h + gauge_term\n\n    def add_symmetric_noise(h, std_dev, seed):\n        \"\"\"Adds symmetric Gaussian noise to h_ij.\"\"\"\n        rng = np.random.default_rng(seed)\n        noise = rng.normal(loc=0.0, scale=std_dev, size=(3, 3))\n        symmetric_noise = (noise + noise.T) / 2.0\n        return h + symmetric_noise\n\n    def process_case(h_obs, k, omega):\n        \"\"\"\n        Processes a single test case to infer polarization amplitudes.\n        \n        Args:\n            h_obs (np.ndarray): The 3x3 observed spatial metric perturbation.\n            k (np.ndarray): The 3-component wavevector.\n            omega (float): The angular frequency.\n\n        Returns:\n            tuple: A pair of floats (A_plus, A_cross).\n        \"\"\"\n        k_mag = np.linalg.norm(k)\n        \n        # Step 1: Check dispersion compatibility (on-shell condition)\n        # If not met, no gauge correction is applied.\n        if not np.isclose(omega, k_mag):\n            h_prime = h_obs\n        else:\n            # Avoid division by zero for a zero wavevector\n            if np.isclose(k_mag, 0):\n                h_prime = h_obs\n            else:\n                # Step 2: Calculate the optimal gauge vector zeta\n                # The derivation uses a coordinate system where k is along the z-axis.\n                # All test cases satisfy this, so we use the simplified formulas.\n                K = k_mag\n                trace_h = np.trace(h_obs)\n                \n                # Using h_ij indices (i,j) in {1,2,3} mapping to python indices {0,1,2}\n                h13 = h_obs[0, 2]\n                h23 = h_obs[1, 2]\n                h33 = h_obs[2, 2]\n                \n                zeta_1 = h13 / K\n                zeta_2 = h23 / K\n                \n                # Formula derived from minimizing the least-squares objective with lambda=1\n                zeta_3 = (K**2 * h33 + trace_h) / (2 * K * (K**2 + 1))\n                \n                zeta = np.array([zeta_1, zeta_2, zeta_3])\n\n                # Step 3: Apply gauge correction to get h_prime\n                gauge_correction = np.outer(k, zeta) + np.outer(zeta, k)\n                h_prime = h_obs - gauge_correction\n\n        # Step 4  5: Perform TT projection and extract polarization amplitudes\n        # For a z-propagating wave, the relevant components are in the xy-plane.\n        A_plus_inferred = (h_prime[0, 0] - h_prime[1, 1]) / 2.0\n        A_cross_inferred = h_prime[0, 1]\n        \n        return A_plus_inferred, A_cross_inferred\n\n    # --- Define Test Cases ---\n    \n    # Case 1: Pure TT signal\n    k1 = np.array([0., 0., 1.])\n    omega1 = 1.\n    h1 = construct_h_tensor(A_plus=1.0, A_cross=0.0)\n\n    # Case 2: TT signal + Residual Gauge\n    k2 = np.array([0., 0., 1.])\n    omega2 = 1.\n    h2_base = construct_h_tensor(A_plus=1.0, A_cross=0.0)\n    u2 = [0.5, -0.3, 0.2]\n    h2 = add_gauge_contamination(h2_base, k2, u2)\n\n    # Case 3: TT (both pols) + Gauge + Noise\n    k3 = np.array([0., 0., 1.])\n    omega3 = 1.\n    h3_base = construct_h_tensor(A_plus=0.8, A_cross=0.5)\n    u3 = [-0.4, 0.6, 0.1]\n    h3_with_gauge = add_gauge_contamination(h3_base, k3, u3)\n    # Noise uses a fixed seed for reproducibility, as required\n    h3 = add_symmetric_noise(h3_with_gauge, std_dev=1e-23, seed=42)\n    \n    # Case 4: Pure gauge, off-shell (incompatible dispersion)\n    k4 = np.array([0., 0., 1.])\n    omega4 = 2.\n    h4_base = construct_h_tensor(A_plus=0.0, A_cross=0.0)\n    u4 = [0.7, -0.2, 0.1]\n    h4 = add_gauge_contamination(h4_base, k4, u4)\n\n    test_cases = [\n        (h1, k1, omega1),\n        (h2, k2, omega2),\n        (h3, k3, omega3),\n        (h4, k4, omega4),\n    ]\n\n    # --- Run Solver and Collect Results ---\n    final_results = []\n    for h_obs, k, omega in test_cases:\n        A_p, A_x = process_case(h_obs, k, omega)\n        final_results.extend([A_p, A_x])\n\n    # --- Format and Print Output ---\n    # The output must be a single line in the specified format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3478836"}]}