{"hands_on_practices": [{"introduction": "Gamma-驱动器位移条件利用共形Christoffel符号的缩并（即$\\tilde{\\Gamma}^i$）作为“源项”，来驱动坐标演化到期望的状态。这个练习是BSSN形式体系中张量计算的一项基本实践。通过为一个简单但非平庸的度规显式地计算$\\tilde{\\Gamma}^i$ [@problem_id:3490848]，你将巩固对其数学定义的理解，并明确其作为坐标驱动方程输入项的角色。", "problem": "在数值相对论的Baumgarte-Shapiro-Shibata-Nakamura (BSSN)形式中，Gamma-驱动器位移条件 (Gamma-driver) 使用与共形度规 $\\tilde{\\gamma}_{ij}$ 相关的共形联络函数 $\\tilde{\\Gamma}^{i}$ 来演化空间漂移。从黎曼度规的Levi-Civita联络及其缩并的基本定义出发，计算在球坐标 $(r,\\theta,\\phi)$ 下由下式给出的共形平坦三维-度规的共形联络函数 $\\tilde{\\Gamma}^{i} \\equiv \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}$：\n$$\n\\tilde{\\gamma}_{ij}=\\mathrm{diag}\\!\\big(1,\\,r^{2},\\,r^{2}\\sin^{2}\\theta\\big).\n$$\n仅使用克里斯托费尔符号关于度规分量及其导数的定义，推导分量 $\\tilde{\\Gamma}^{r}$、$\\tilde{\\Gamma}^{\\theta}$ 和 $\\tilde{\\Gamma}^{\\phi}$ 的显式表达式，并确定哪些分量不为零。将您的最终答案以闭合形式表示为有序三元组 $(\\tilde{\\Gamma}^{r},\\tilde{\\Gamma}^{\\theta},\\tilde{\\Gamma}^{\\phi})$。无需进行数值舍入，也不涉及物理单位。", "solution": "该问题要求计算在球坐标下特定三维-度规的共形联络函数 $\\tilde{\\Gamma}^{i}$。该问题在科学上根植于数值相对论领域，特别是在 BSSN 形式体系内，并且是微分几何中一个良定的数学练习。所给信息对于得出唯一解是充分且一致的。\n\n共形联络函数定义为缩并 $\\tilde{\\Gamma}^{i} \\equiv \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}$，其中 $\\tilde{\\Gamma}^{i}{}_{jk}$ 是与共形度规 $\\tilde{\\gamma}_{ij}$ 相关的第二类克里斯托费尔符号。坐标为球坐标，记作 $(x^1, x^2, x^3) = (r, \\theta, \\phi)$。\n\n给定的共形度规为：\n$$ \\tilde{\\gamma}_{ij} = \\mathrm{diag}\\!\\big(1,\\,r^{2},\\,r^{2}\\sin^{2}\\theta\\big) $$\n度规张量的非零分量为：\n$$ \\tilde{\\gamma}_{rr} = 1 $$\n$$ \\tilde{\\gamma}_{\\theta\\theta} = r^2 $$\n$$ \\tilde{\\gamma}_{\\phi\\phi} = r^2\\sin^2\\theta $$\n由于度规张量 $\\tilde{\\gamma}_{ij}$ 是对角的，其逆 $\\tilde{\\gamma}^{ij}$ 也是对角的，其分量是 $\\tilde{\\gamma}_{ij}$ 相应分量的倒数：\n$$ \\tilde{\\gamma}^{rr} = 1 $$\n$$ \\tilde{\\gamma}^{\\theta\\theta} = \\frac{1}{r^2} $$\n$$ \\tilde{\\gamma}^{\\phi\\phi} = \\frac{1}{r^2\\sin^2\\theta} $$\n\n共形联络函数的定义涉及对指标 $j$ 和 $k$ 的求和。由于 $\\tilde{\\gamma}^{jk}$ 是一个对角张量，这个求和过程大大简化，因为只有 $j=k$ 的项有贡献：\n$$ \\tilde{\\Gamma}^{i} = \\sum_{j,k} \\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{i}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{i}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{i}{}_{\\phi\\phi} $$\n为了计算 $\\tilde{\\Gamma}^{i}$，我们必须首先计算形如 $\\tilde{\\Gamma}^{i}{}_{jj}$ 的克里斯托费尔符号 (对 $j$ 没有隐式求和)。\n\n第二类克里斯托费尔符号由以下公式定义：\n$$ \\tilde{\\Gamma}^{i}{}_{jk} = \\frac{1}{2} \\tilde{\\gamma}^{im} \\left( \\frac{\\partial \\tilde{\\gamma}_{mk}}{\\partial x^j} + \\frac{\\partial \\tilde{\\gamma}_{mj}}{\\partial x^k} - \\frac{\\partial \\tilde{\\gamma}_{jk}}{\\partial x^m} \\right) $$\n对于对角度规，此公式得到简化。我们为每个分量 $i$ 计算所需的符号。\n\n首先，我们列出度规分量的非零偏导数：\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\theta\\theta}}{\\partial r} = \\frac{\\partial}{\\partial r}(r^2) = 2r $$\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\phi\\phi}}{\\partial r} = \\frac{\\partial}{\\partial r}(r^2 \\sin^2\\theta) = 2r \\sin^2\\theta $$\n$$ \\frac{\\partial \\tilde{\\gamma}_{\\phi\\phi}}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta}(r^2 \\sin^2\\theta) = 2r^2 \\sin\\theta \\cos\\theta $$\n\n现在我们计算克里斯托费尔符号 $\\tilde{\\Gamma}^{i}{}_{jj}$：\n\n分量 $i=r$：\n$$ \\tilde{\\Gamma}^{r}{}_{rr} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_r \\tilde{\\gamma}_{mr} + \\partial_r \\tilde{\\gamma}_{mr} - \\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{rr} + 2\\partial_r\\tilde{\\gamma}_{rr}) = \\frac{1}{2}(1)\\partial_r(1) = 0 $$\n$$ \\tilde{\\Gamma}^{r}{}_{\\theta\\theta} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_\\theta \\tilde{\\gamma}_{m\\theta} + \\partial_\\theta \\tilde{\\gamma}_{m\\theta} - \\partial_m \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}(1)(-2r) = -r $$\n$$ \\tilde{\\Gamma}^{r}{}_{\\phi\\phi} = \\frac{1}{2} \\tilde{\\gamma}^{rm} (\\partial_\\phi \\tilde{\\gamma}_{m\\phi} + \\partial_\\phi \\tilde{\\gamma}_{m\\phi} - \\partial_m \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{rr}(-\\partial_r\\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}(1)(-2r\\sin^2\\theta) = -r\\sin^2\\theta $$\n\n分量 $i=\\theta$：\n$$ \\tilde{\\Gamma}^{\\theta}{}_{rr} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(-\\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(-\\partial_\\theta\\tilde{\\gamma}_{rr}) = \\frac{1}{2r^2}(-\\partial_\\theta(1)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\theta}{}_{\\theta\\theta} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(\\partial_\\theta \\tilde{\\gamma}_{m\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(\\partial_\\theta \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2r^2}(\\partial_\\theta(r^2)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\theta}{}_{\\phi\\phi} = \\frac{1}{2}\\tilde{\\gamma}^{\\theta m}(-\\partial_m \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{\\theta\\theta}(-\\partial_\\theta \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2r^2}(-2r^2\\sin\\theta\\cos\\theta) = -\\sin\\theta\\cos\\theta $$\n\n分量 $i=\\phi$：\n$$ \\tilde{\\Gamma}^{\\phi}{}_{rr} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(-\\partial_m \\tilde{\\gamma}_{rr}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(-\\partial_\\phi\\tilde{\\gamma}_{rr}) = \\frac{1}{2r^2\\sin^2\\theta}(-\\partial_\\phi(1)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\phi}{}_{\\theta\\theta} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(-\\partial_m \\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(-\\partial_\\phi\\tilde{\\gamma}_{\\theta\\theta}) = \\frac{1}{2r^2\\sin^2\\theta}(-\\partial_\\phi(r^2)) = 0 $$\n$$ \\tilde{\\Gamma}^{\\phi}{}_{\\phi\\phi} = \\frac{1}{2}\\tilde{\\gamma}^{\\phi m}(\\partial_\\phi \\tilde{\\gamma}_{m\\phi}) = \\frac{1}{2}\\tilde{\\gamma}^{\\phi\\phi}(\\partial_\\phi \\tilde{\\gamma}_{\\phi\\phi}) = \\frac{1}{2r^2\\sin^2\\theta}(\\partial_\\phi(r^2\\sin^2\\theta)) = 0 $$\n\n在计算出克里斯托费尔符号后，我们现在进行缩并以求得 $\\tilde{\\Gamma}^i$ 的分量。\n\n对于 $i=r$：\n$$ \\tilde{\\Gamma}^{r} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{r}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{r}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{r}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{r} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(-r) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(-r\\sin^2\\theta) = 0 - \\frac{1}{r} - \\frac{1}{r} = -\\frac{2}{r} $$\n\n对于 $i=\\theta$：\n$$ \\tilde{\\Gamma}^{\\theta} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{\\theta}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{\\theta}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{\\theta}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{\\theta} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(0) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(-\\sin\\theta\\cos\\theta) = -\\frac{\\cos\\theta}{r^2\\sin\\theta} = -\\frac{\\cot\\theta}{r^2} $$\n\n对于 $i=\\phi$：\n$$ \\tilde{\\Gamma}^{\\phi} = \\tilde{\\gamma}^{rr}\\tilde{\\Gamma}^{\\phi}{}_{rr} + \\tilde{\\gamma}^{\\theta\\theta}\\tilde{\\Gamma}^{\\phi}{}_{\\theta\\theta} + \\tilde{\\gamma}^{\\phi\\phi}\\tilde{\\Gamma}^{\\phi}{}_{\\phi\\phi} $$\n$$ \\tilde{\\Gamma}^{\\phi} = (1)(0) + \\left(\\frac{1}{r^2}\\right)(0) + \\left(\\frac{1}{r^2\\sin^2\\theta}\\right)(0) = 0 $$\n\n因此，共形联络函数的分量为 $\\tilde{\\Gamma}^{r} = -2/r$，$\\tilde{\\Gamma}^{\\theta} = -(\\cot\\theta)/r^2$ 和 $\\tilde{\\Gamma}^{\\phi}=0$。不为零的分量是 $\\tilde{\\Gamma}^{r}$ 和 $\\tilde{\\Gamma}^{\\theta}$。\n\n最终答案是有序三元组 $(\\tilde{\\Gamma}^{r},\\tilde{\\Gamma}^{\\theta},\\tilde{\\Gamma}^{\\phi})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{2}{r} & -\\frac{\\cot\\theta}{r^2} & 0\n\\end{pmatrix}\n}\n$$", "id": "3490848"}, {"introduction": "理解了源项$\\tilde{\\Gamma}^i$之后，下一步是探究Gamma-驱动器方程本身的动力学行为。本练习在一个简化的静态时空背景下考察该系统，此时$\\tilde{\\Gamma}^i$不随时间变化。通过求解这个常微分方程组[@problem_id:3490844]，你将从解析上理解Gamma-驱动器的核心机制：它如何像一个阻尼系统一样，通过阻尼参数$\\eta$使驱动量$B^i$衰减至零，同时让移动矢量$\\beta^i$趋于一个稳定的常数，从而达到固定坐标的效果。", "problem": "考虑爱因斯坦方程的Baumgarte–Shapiro–Shibata–Nakamura (BSSN)表述，其中移动矢量 $\\,\\beta^{i}\\,$ 及其驱动量 $\\,B^{i}\\,$ 采用所谓的Gamma-驱动器位移条件。Gamma-驱动器系统是一种广泛使用的双曲-抛物线型驱动，其最简单的形式可以写成如下的时间上一阶系统：\n$$\n\\partial_{t}\\beta^{i} \\;=\\; f(\\alpha)\\,B^{i}, \n\\qquad\n\\partial_{t}B^{i} \\;=\\; \\partial_{t}\\tilde{\\Gamma}^{i} \\;-\\; \\eta\\,B^{i},\n$$\n其中 $\\,\\tilde{\\Gamma}^{i}\\,$ 是BSSN变量的收缩共形连接函数，$\\,\\alpha\\,$ 是递减函数，$\\,f(\\alpha)>0\\,$ 是一个正的规范驱动函数，$\\,\\eta>0\\,$ 是一个正的阻尼参数。假设在一个静态背景中，$\\,\\partial_{t}\\tilde{\\Gamma}^{i}=0\\,$ 且 $\\,\\alpha\\,$ 不依赖于时间，因此 $\\,f(\\alpha)\\,$ 是一个正常数。在一个固定的空间点进行局部计算，这样空间导数就不会出现。设 $\\,t=0\\,$ 时的初始数据为 $\\,\\beta^{i}(0)=\\beta^{i}_{0}\\,$ 和 $\\,B^{i}(0)=B^{i}_{0}\\,$, 其中 $\\,\\beta^{i}_{0}\\,$ 和 $\\,B^{i}_{0}\\,$ 是有限常数。\n\n从这些演化方程和假设出发，求解 $\\,\\beta^{i}(t)\\,$ 和 $\\,B^{i}(t)\\,$, 并确定其长时间极限 $\\,\\lim_{t\\to\\infty}\\beta^{i}(t)\\,$ 和 $\\,\\lim_{t\\to\\infty}B^{i}(t)\\,$。你的推导应从给定的Gamma-驱动器系统开始，通过直接求解得到的常微分方程来进行。清晰地陈述所有中间步骤，并根据给定条件 $\\,\\eta>0\\,$ 和 $\\,f(\\alpha)>0\\,$ 证明任何指数因子的符号。\n\n用一个双元素行向量的形式给出最终答案，顺序为 $\\bigl(\\lim_{t\\to\\infty}\\beta^{i}(t),\\;\\lim_{t\\to\\infty}B^{i}(t)\\bigr)$，仅使用符号 $\\,\\beta^{i}_{0}\\,$, $\\,B^{i}_{0}\\,$, $\\,f(\\alpha)\\,$ 和 $\\,\\eta\\,$。不需要进行数值计算。不要包含单位。", "solution": "问题陈述具有科学依据，是适定的、客观的且内部一致的。它提出了一个标准情景，用于在简化但具有物理意义的假设下，分析数值相对论中Gamma-驱动器位移条件的表现。因此，该问题是有效的，我们开始求解。\n\n移动矢量 $\\beta^{i}$ 及其驱动量 $B^{i}$ 的演化方程由以下系统给出：\n$$\n\\partial_{t}\\beta^{i} \\;=\\; f(\\alpha)\\,B^{i}\n$$\n$$\n\\partial_{t}B^{i} \\;=\\; \\partial_{t}\\tilde{\\Gamma}^{i} \\;-\\; \\eta\\,B^{i}\n$$\n问题指定了一个静态背景，其中 $\\partial_{t}\\tilde{\\Gamma}^{i}=0$。问题还假设递减函数 $\\alpha$ 不依赖于时间，这意味着规范驱动函数 $f(\\alpha)$ 是一个常数。由于我们在一个固定的空间点上工作，时间偏导数 $\\partial_{t}$ 可以被视为全时间导数 $\\frac{d}{dt}$。因此，该方程组简化为一个常微分方程(ODE)组：\n$$\n\\frac{d\\beta^{i}}{dt} = f(\\alpha)B^{i}\n\\quad \\quad (1)\n$$\n$$\n\\frac{dB^{i}}{dt} = -\\eta B^{i}\n\\quad \\quad (2)\n$$\n给定 $t=0$ 时的初始条件：$\\beta^{i}(0)=\\beta^{i}_{0}$ 和 $B^{i}(0)=B^{i}_{0}$。\n\n首先，我们求解方程 $(2)$ 以得到 $B^{i}(t)$。这是一个系数为常数 $-\\eta$ 的一阶线性齐次常微分方程。通解可以通过分离变量法找到：\n$$\n\\frac{dB^{i}}{B^{i}} = -\\eta \\, dt\n$$\n对两边积分得到：\n$$\n\\ln|B^{i}| = -\\eta t + C_{1}\n$$\n其中 $C_{1}$ 是一个积分常数。对两边取指数得到：\n$$\nB^{i}(t) = C_{2} \\exp(-\\eta t)\n$$\n其中 $C_{2} = \\pm \\exp(C_{1})$ 是一个常矢量。我们使用初始条件 $B^{i}(0)=B^{i}_{0}$ 来确定 $C_{2}$：\n$$\nB^{i}_{0} = C_{2} \\exp(-\\eta \\cdot 0) = C_{2} \\exp(0) = C_{2}\n$$\n因此，$B^{i}(t)$ 的解是：\n$$\nB^{i}(t) = B^{i}_{0} \\exp(-\\eta t)\n$$\n接下来，我们将 $B^{i}(t)$ 的表达式代入方程 $(1)$ 来求解 $\\beta^{i}(t)$：\n$$\n\\frac{d\\beta^{i}}{dt} = f(\\alpha) \\left( B^{i}_{0} \\exp(-\\eta t) \\right)\n$$\n为了求得 $\\beta^{i}(t)$，我们对时间 $t$ 进行积分：\n$$\n\\beta^{i}(t) = \\int f(\\alpha) B^{i}_{0} \\exp(-\\eta t) \\, dt\n$$\n由于 $f(\\alpha)$ 和 $B^{i}_{0}$ 是关于时间的常数，我们有：\n$$\n\\beta^{i}(t) = f(\\alpha) B^{i}_{0} \\int \\exp(-\\eta t) \\, dt = f(\\alpha) B^{i}_{0} \\left( -\\frac{1}{\\eta} \\exp(-\\eta t) \\right) + C_{3}\n$$\n其中 $C_{3}$ 是另一个积分常矢量。我们使用初始条件 $\\beta^{i}(0)=\\beta^{i}_{0}$ 来确定 $C_{3}$：\n$$\n\\beta^{i}_{0} = f(\\alpha) B^{i}_{0} \\left( -\\frac{1}{\\eta} \\exp(0) \\right) + C_{3} = -\\frac{f(\\alpha) B^{i}_{0}}{\\eta} + C_{3}\n$$\n求解 $C_{3}$ 得到：\n$$\nC_{3} = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\n将此代回 $\\beta^{i}(t)$ 的表达式中，我们得到完整解：\n$$\n\\beta^{i}(t) = -\\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\exp(-\\eta t) + \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\n这可以更紧凑地写为：\n$$\n\\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - \\exp(-\\eta t) \\right)\n$$\n现在，我们确定当 $t \\to \\infty$ 时的长时间极限。问题陈述 $\\eta > 0$。因此，当 $t \\to \\infty$ 时，指数项 $\\exp(-\\eta t)$ 趋近于零：\n$$\n\\lim_{t\\to\\infty} \\exp(-\\eta t) = 0\n$$\n使用这个极限，我们评估 $B^{i}(t)$ 和 $\\beta^{i}(t)$ 的长时间行为。对于驱动量 $B^{i}(t)$：\n$$\n\\lim_{t\\to\\infty} B^{i}(t) = \\lim_{t\\to\\infty} \\left( B^{i}_{0} \\exp(-\\eta t) \\right) = B^{i}_{0} \\cdot 0 = 0\n$$\n这表明驱动项 $B^{i}$ 在晚期被阻尼到零，这是Gamma-驱动器条件在达到稳态时的预期行为。\n对于移动矢量 $\\beta^{i}(t)$：\n$$\n\\lim_{t\\to\\infty} \\beta^{i}(t) = \\lim_{t\\to\\infty} \\left( \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - \\exp(-\\eta t) \\right) \\right)\n$$\n$$\n\\lim_{t\\to\\infty} \\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} \\left( 1 - 0 \\right) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}\n$$\n移动矢量渐近于一个常数值，表明坐标系稳定到一个固定状态。条件 $f(\\alpha)>0$ 确保了来自 $B^{i}_{0}$ 的贡献的符号仅取决于 $B^{i}_{0}$ 本身的符号。\n\n因此，所求的极限为 $\\lim_{t\\to\\infty} \\beta^{i}(t) = \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta}$ 和 $\\lim_{t\\to\\infty} B^{i}(t) = 0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\beta^{i}_{0} + \\frac{f(\\alpha) B^{i}_{0}}{\\eta} & 0 \\end{pmatrix}}\n$$", "id": "3490844"}, {"introduction": "理论与实际应用之间需要一座桥梁。在真实的数值模拟中（例如双黑洞系统），不佳的规范选择会导致坐标系发生非物理性的漂移，而这个练习将此场景简化为一个由外力驱动的阻尼谐振子模型。这个动手编程实践[@problem_id:3490832]要求你数值求解该模型，通过测试不同的阻尼参数$\\eta$值，你将能定量地分析其对坐标稳定性的直接影响，并体会到在实际研究中微调规范参数以获得物理上可靠结果的重要性。", "problem": "您将要对 Gamma-驱动器规范中由移位矢量引起的坐标质心漂移进行建模，并量化对于等质量双星系统，阻尼参数如何影响该漂移。请在几何单位制下工作，总质量归一化为一，因此所有长度和时间都以总质量的倍数表示，记为 $M$。所有要求的输出都必须以 $M$ 为单位表示。\n\n基本原理和定义：\n- 在时空的 $3+1$ 分解中，移位矢量为 $ \\beta^i $，欧拉坐标时间线根据 $ \\mathrm{d}x^i/\\mathrm{d}t = \\beta^i $ 平流坐标，因此沿 $x$ 轴的均匀平移可以用一个标量坐标位移 $ \\xi(t) $ 来表示，该位移满足 $ \\dot{\\xi}(t) = \\beta^x(t) $。\n- 考虑经过充分检验的积分形式 Gamma-驱动器位移条件，其最简形式为 $ \\partial_t \\beta^i = \\mu_S \\tilde{\\Gamma}^i - \\eta \\beta^i $，其中 $ \\tilde{\\Gamma}^i $ 是 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 形式中的共形联络函数，$ \\mu_S $ 是一个正常数，$ \\eta $ 是一个正阻尼参数。\n- 使用定义 $ x_{\\mathrm{CM}}(t) = \\dfrac{\\int x \\, \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}{\\int \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x} $ 来量化坐标质心漂移，其中 $ \\rho_{\\mathrm{eff}} $ 是有效密度。\n\n模型假设与简化为常微分方程：\n- 用两个质量为 $ m_1 = m_2 $ 的相同球对称高斯有效密度来模拟一个等质量双星系统，初始时中心位于 $x$ 轴上的 $ x = \\pm a $ 处，且 $ y = 0 $，$ z = 0 $。在沿 $x$ 轴的空间均匀坐标平移 $ \\xi(t) $ 下，对于所有 $ t $，中心位置为 $ x_1(t) = -a + \\xi(t) $ 和 $ x_2(t) = +a + \\xi(t) $。\n- 由于高斯分布是归一化且球对称的，根据 $ x_{\\mathrm{CM}}(t) $ 计算出的质心等于两个中心的平均值。因此，对于等质量情况，我们精确地得到 $ x_{\\mathrm{CM}}(t) = \\xi(t) $，这与高斯宽度无关。\n- 对共形联络响应于微小均匀平移进行线性化，使得 $ \\tilde{\\Gamma}^x(t) \\approx -\\kappa \\, \\xi(t) + F_{\\mathrm{bias}}(t) $，其中 $ \\kappa > 0 $ 是一个设定驱动器恢复趋势的常数，$ F_{\\mathrm{bias}}(t) $ 是一个缓慢变化的偏置，代表来自双星系统的净规范曲率源。对该偏置采用一个平滑斜坡函数 $ F_{\\mathrm{bias}}(t) = F_\\infty \\left(1 - e^{-t/\\tau}\\right) $，其中常数 $ F_\\infty > 0 $ 且 $ \\tau > 0 $。\n- 将 $ \\dot{\\xi} = \\beta^x $ 与 $ \\partial_t \\beta^x = \\mu_S \\tilde{\\Gamma}^x - \\eta \\beta^x $ 结合，得到二阶常微分方程\n$$\n\\ddot{\\xi}(t) + \\eta \\, \\dot{\\xi}(t) + \\omega_0^2 \\, \\xi(t) = \\mu_S \\, F_{\\mathrm{bias}}(t),\n$$\n其中 $ \\omega_0^2 = \\mu_S \\, \\kappa $。渐近偏移量为 $ \\xi_\\infty = \\dfrac{\\mu_S F_\\infty}{\\omega_0^2} = \\dfrac{F_\\infty}{\\kappa} $。\n\n任务：\n- 对于下述参数选择，求解初始条件为 $ \\xi(0) = 0 $ 和 $ \\dot{\\xi}(0) = 0 $ 的初值问题。使用得到的 $ \\xi(t) $ 计算漂移度量\n$$\nD(\\eta) = \\max_{t \\in [0,T]} \\left| x_{\\mathrm{CM}}(t) - \\xi_\\infty \\right| = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right|.\n$$\n将 $ D(\\eta) $ 解释为相对于渐近偏移量的最大动态漂移。所有输出都必须以 $M$ 为单位给出。\n\n参数值（这些值构成了测试套件，必须严格按照规定使用）：\n- 总质量归一化为一，因此所有时间和长度都以 $M$ 为单位。\n- 双星间距参数 $ a = 10 $。\n- 高斯宽度参数 $ \\sigma = 1 $（仅在 $ \\rho_{\\mathrm{eff}} $ 的概念定义中使用，数值计算上不需要，因为对于等质量情况，$ x_{\\mathrm{CM}}(t) = \\xi(t) $ 精确成立）。\n- 驱动器常数：$ \\mu_S = 3/4 $，$ \\kappa = 4/3 $，因此 $ \\omega_0^2 = \\mu_S \\kappa = 1 $。\n- 偏置斜坡：$ F_\\infty = \\kappa \\times 0.1 $，因此 $ \\xi_\\infty = 0.1 $，且 $ \\tau = 5 $。\n- 最终时间：$ T = 50 $。\n- 阻尼参数测试套件：$ \\eta \\in \\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\} $。\n\n数值要求：\n- 对于测试套件中的每个 $ \\eta $，使用您选择的稳定显式格式和一个足够小以解析由 $ \\omega_0 $ 和 $ \\eta $ 决定的最快时间尺度的固定时间步长，来对常微分方程进行积分。您不得依赖任何用户输入。\n- 对每个 $ \\eta $，在区间 $ [0,T] $ 上计算如上定义的 $ D(\\eta) $。\n- 确定 $ k_{\\min} $，即给定列表中使 $ D(\\eta) $ 最小化的 $ \\eta $ 的从0开始的索引。如果在数值精度范围内存在平局，请选择最小的索引。\n\n最终输出规范：\n- 您的程序应生成单行输出，包含一个有 $7$ 个条目的类JSON列表：按照指定顺序排列的测试套件中 $ \\eta $ 值对应的六个 $ D(\\eta) $ 值，后跟整数 $ k_{\\min} $。例如，格式必须严格如 $ [d_0,d_1,d_2,d_3,d_4,d_5,k_{\\min}] $，条目之间用逗号分隔，无空格。所有 $ d_j $ 都必须是以 $ M $ 为单位的浮点数，$ k_{\\min} $ 必须是整数。", "solution": "### 第1步：提取给定信息\n\n问题提供了以下数据、定义和条件：\n- **基本关系**：\n  - 坐标平流：$\\mathrm{d}x^i/\\mathrm{d}t = \\beta^i$\n  - 均匀平移位移 $\\xi(t)$ 满足 $\\dot{\\xi}(t) = \\beta^x(t)$。\n  - 积分形式的Gamma-驱动器位移条件：$\\partial_t \\beta^i = \\mu_S \\tilde{\\Gamma}^i - \\eta \\beta^i$，其中 $\\mu_S > 0$ 且 $\\eta > 0$。\n  - 质心定义：$x_{\\mathrm{CM}}(t) = \\dfrac{\\int x \\, \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}{\\int \\rho_{\\mathrm{eff}}(\\mathbf{x},t) \\, \\mathrm{d}^3 x}$。\n- **模型假设**：\n  - 对于等质量双星，$x_{\\mathrm{CM}}(t) = \\xi(t)$。\n  - 线性化的共形联络响应：$\\tilde{\\Gamma}^x(t) \\approx -\\kappa \\, \\xi(t) + F_{\\mathrm{bias}}(t)$，其中 $\\kappa > 0$。\n  - 偏置项函数形式：$F_{\\mathrm{bias}}(t) = F_\\infty \\left(1 - e^{-t/\\tau}\\right)$，其中 $F_\\infty > 0$ 且 $\\tau > 0$。\n- **控制方程**：\n  - 关于 $\\xi(t)$ 的二阶常微分方程(ODE)：\n    $$ \\ddot{\\xi}(t) + \\eta \\, \\dot{\\xi}(t) + \\omega_0^2 \\, \\xi(t) = \\mu_S \\, F_{\\mathrm{bias}}(t) $$\n  - $\\omega_0^2$ 的定义：$\\omega_0^2 = \\mu_S \\, \\kappa$。\n  - 初始条件：$\\xi(0) = 0$ 且 $\\dot{\\xi}(0) = 0$。\n- **漂移度量**：\n  - 渐近偏移量：$\\xi_\\infty = \\dfrac{\\mu_S F_\\infty}{\\omega_0^2} = \\dfrac{F_\\infty}{\\kappa}$。\n  - 漂移度量定义：$D(\\eta) = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right|$。\n- **参数值**：\n  - 驱动器常数：$\\mu_S = 3/4$, $\\kappa = 4/3$。这意味着 $\\omega_0^2 = (3/4)(4/3) = 1$。\n  - 偏置斜坡参数：$F_\\infty = \\kappa \\times 0.1$, $\\tau = 5$。这意味着 $\\xi_\\infty = 0.1$。\n  - 积分的最终时间：$T = 50$。\n  - 阻尼参数测试套件：$\\eta \\in \\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\}$。\n- **任务要求**：\n  - 对每个 $\\eta$ 求解ODE。\n  - 对每个 $\\eta$ 计算 $D(\\eta)$。\n  - 确定 $k_{\\min}$，即最小化 $D(\\eta)$ 的 $\\eta$ 的从0开始的索引。\n  - 数值积分必须使用具有固定时间步长的稳定显式格式。\n  - 最终输出必须是单个类JSON列表：$[D_0, D_1, D_2, D_3, D_4, D_5, k_{\\min}]$。\n\n### 第2步：使用提取的信息进行验证\n\n该问题是一个适定的数学物理初值问题，其基础是数值相对论的标准理论框架。\n- **科学依据**：该问题使用了BSSN形式中的Gamma-驱动器位移条件，这是模拟双星系统引力波时的一种标准规范选择。该模型虽然经过简化（线性化，特定的偏置项），但代表了研究规范动力学的一种有效的物理近似。最终得到的方程是一个受驱、带阻尼的谐振子，这是物理学中一个普遍存在的基本模型。\n- **适定性**：该问题指定了一个线性、二阶、非齐次、常系数的常微分方程，其驱动函数性质良好。初始条件（$\\xi(0)=0, \\dot{\\xi}(0)=0$）已给出，确保了对于所有 $t \\ge 0$ 都存在唯一且稳定的解。\n- **客观性**：所有术语都经过了精确的数学定义。参数以具体的数值给出，任务陈述明确。没有主观或基于观点的部分。\n- **自洽性和一致性**：所有必要信息均已提供。派生出的参数值与定义一致（$\\omega_0^2 = 1$，$\\xi_\\infty = 0.1$）。将给定参数代入通用ODE，得到一个待求解的具体方程。右侧的驱动项为 $\\mu_S F_{\\mathrm{bias}}(t) = \\mu_S (F_\\infty) (1 - e^{-t/\\tau}) = (3/4) (\\kappa \\times 0.1) (1 - e^{-t/\\tau}) = (3/4) ((4/3) \\times 0.1) (1 - e^{-t/5}) = 0.1(1-e^{-t/5})$。完整的ODE是 $\\ddot{\\xi}(t) + \\eta \\dot{\\xi}(t) + \\xi(t) = 0.1(1-e^{-t/5})$，该方程是一致且可解的。\n\n该问题不存在科学上不健全、不完整、矛盾或模糊等任何缺陷。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。将提供完整解答。\n\n### 解答\n\n该问题要求针对阻尼参数 $\\eta$ 的几个不同值，求解坐标位移 $\\xi(t)$ 的二阶初值问题，然后计算漂移度量 $D(\\eta)$。\n\n代入给定参数 $\\omega_0^2 = 1$, $\\mu_S = 3/4$, $F_\\infty = \\kappa \\times 0.1 = (4/3) \\times 0.1$ 和 $\\tau=5$ 后，控制常微分方程为：\n$$ \\ddot{\\xi}(t) + \\eta \\dot{\\xi}(t) + \\xi(t) = 0.1 \\left(1 - e^{-t/5}\\right) $$\n初始条件为 $\\xi(0) = 0$ 和 $\\dot{\\xi}(0) = 0$。\n\n问题指出，必须使用具有固定时间步长的稳定、显式的数值积分格式。四阶龙格-库塔（RK4）方法是一个绝佳的选择，它具有高精度和宽稳定性区域。\n\n为了应用RK4方法，我们首先将二阶ODE转换为一个一阶ODE系统。我们定义一个状态向量 $\\mathbf{y}(t)$ 为：\n$$ \\mathbf{y}(t) = \\begin{pmatrix} y_0(t) \\\\ y_1(t) \\end{pmatrix} = \\begin{pmatrix} \\xi(t) \\\\ \\dot{\\xi}(t) \\end{pmatrix} $$\n该向量的时间导数为：\n$$ \\frac{\\mathrm{d}\\mathbf{y}}{\\mathrm{d}t} = \\begin{pmatrix} \\dot{y}_0(t) \\\\ \\dot{y}_1(t) \\end{pmatrix} = \\begin{pmatrix} \\dot{\\xi}(t) \\\\ \\ddot{\\xi}(t) \\end{pmatrix} = \\begin{pmatrix} y_1(t) \\\\ 0.1 \\left(1 - e^{-t/5}\\right) - \\eta y_1(t) - y_0(t) \\end{pmatrix} $$\n这就将我们的系统定义为 $\\dot{\\mathbf{y}}(t) = \\mathbf{f}(t, \\mathbf{y}(t), \\eta)$，初始条件为 $\\mathbf{y}(0) = [0, 0]^T$。\n\nRK4算法将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$，其中 $\\Delta t$ 是固定的时间步长。对于在时间 $t_n$ 的状态向量 $\\mathbf{y}_n$，下一个状态 $\\mathbf{y}_{n+1}$ 按如下方式计算：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4) $$\n其中中间斜率为：\n\\begin{align*}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n, \\eta) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2}, \\eta) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2}, \\eta) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3, \\eta)\n\\end{align*}\n系统中的最快时间尺度由自然频率 $\\omega_0 = 1$ 决定，对应周期为 $2\\pi/ \\omega_0 \\approx 6.28$。选择时间步长 $\\Delta t=0.01$，这个值足够小，可以精确地解析此振荡。\n\n对于集合 $\\{ 0, 0.5, 1.0, 2.0, 4.0, 8.0 \\}$ 中的每个 $\\eta$ 值，我们执行以下步骤：\n1.  在 $t=0$ 时初始化状态向量 $\\mathbf{y} = [0, 0]^T$。创建一个数组来存储 $\\xi(t)$ 的历史记录。\n2.  使用RK4方法，以 $\\Delta t=0.01$ 从 $t=0$ 迭代到 $t=T=50$，在每一步存储计算出的 $\\xi(t)$ 值。\n3.  积分完成后，我们得到在区间 $[0, 50]$ 上的轨迹 $\\xi(t)$。\n4.  计算漂移度量 $D(\\eta)$。渐近偏移量给定为 $\\xi_\\infty = 0.1$。该度量是与此偏移量的最大偏差：\n    $$ D(\\eta) = \\max_{t \\in [0,T]} \\left| \\xi(t) - \\xi_\\infty \\right| $$\n    这可以通过取存储的 $\\xi(t)$ 值与 $\\xi_\\infty$ 之间绝对差的最大值来找到。\n5.  存储计算出的 $D(\\eta)$ 值。\n\n在为所有指定的 $\\eta$ 值计算出 $D(\\eta)$ 后，我们找到对应于 $D(\\eta)$ 结果列表中的最小值的从0开始的索引 $k_{\\min}$。如果多个 $\\eta$ 值产生相同的最小值（在数值精度范围内），则根据问题规范选择索引最小的那个。这可以通过查找数组中最小值索引的标准函数自然处理。\n\n最后，将六个计算出的 $D(\\eta)$ 值和整数索引 $k_{\\min}$ 格式化为所需的单行列表格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ODE for center-of-mass drift, calculates the drift metric D(eta)\n    for a suite of damping parameters, and finds the optimal parameter index.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    # Driver constants and derived quantities\n    mu_S = 3.0/4.0\n    kappa = 4.0/3.0\n    omega_0_2 = mu_S * kappa  # This is 1.0\n\n    # Bias ramp parameters and derived asymptotic offset\n    F_infty = kappa * 0.1\n    xi_infty = F_infty / kappa  # This is 0.1\n    tau = 5.0\n\n    # Integration time\n    T_final = 50.0\n\n    # Test suite for the damping parameter eta\n    eta_suite = [0.0, 0.5, 1.0, 2.0, 4.0, 8.0]\n\n    # --- Numerical Settings ---\n    # Fixed time step, chosen to be small enough to resolve the fastest timescale (omega_0=1)\n    dt = 0.01\n    n_steps = int(T_final / dt)\n\n    # --- ODE System Definition ---\n    # We solve the system d(y)/dt = f(t, y) where y = [xi, dot_xi]\n    # ddot(xi) + eta * dot(xi) + omega_0^2 * xi = mu_S * F_bias(t)\n    # The right-hand side forcing term simplifies to:\n    # mu_S * F_infty * (1 - exp(-t/tau)) = omega_0^2 * xi_infty * (1 - exp(-t/tau))\n    # Since omega_0^2=1 and xi_infty=0.1, this is 0.1 * (1 - exp(-t/tau))\n    \n    def forcing_term(t):\n        \"\"\"Calculates the forcing term of the ODE at a given time t.\"\"\"\n        return xi_infty * (1.0 - np.exp(-t / tau))\n\n    def ode_system(t, y, eta):\n        \"\"\"\n        Defines the system of first-order ODEs.\n        y[0] = xi (displacement)\n        y[1] = dot_xi (velocity)\n        \"\"\"\n        xi, dot_xi = y\n        # From the ODE: ddot_xi = forcing - eta * dot_xi - omega_0^2 * xi\n        ddot_xi = forcing_term(t) - eta * dot_xi - omega_0_2 * xi\n        return np.array([dot_xi, ddot_xi])\n\n    # --- Main Calculation Loop ---\n    D_results = []\n    \n    for eta in eta_suite:\n        # Initial conditions: xi(0)=0, dot_xi(0)=0\n        y = np.array([0.0, 0.0])\n        \n        # Store the history of xi(t) to calculate the max deviation later\n        xi_history = [y[0]]\n        \n        t = 0.0\n        for _ in range(n_steps):\n            # Fourth-Order Runge-Kutta (RK4) step\n            k1 = dt * ode_system(t, y, eta)\n            k2 = dt * ode_system(t + 0.5 * dt, y + 0.5 * k1, eta)\n            k3 = dt * ode_system(t + 0.5 * dt, y + 0.5 * k2, eta)\n            k4 = dt * ode_system(t + dt, y + k3, eta)\n            \n            y = y + (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0\n            t += dt\n            \n            xi_history.append(y[0])\n            \n        xi_values = np.array(xi_history)\n        \n        # Calculate the drift metric D(eta) = max |xi(t) - xi_infty| over [0, T]\n        deviation = np.abs(xi_values - xi_infty)\n        max_deviation = np.max(deviation)\n        D_results.append(max_deviation)\n\n    # --- Final Result Aggregation ---\n    # Find the 0-based index of the eta value that minimizes D(eta).\n    # np.argmin returns the index of the first occurrence of the minimum value,\n    # satisfying the tie-breaking rule.\n    k_min = np.argmin(D_results)\n\n    # Combine all results into a single list\n    final_output_list = D_results + [k_min]\n\n    # Format the output string exactly as specified: [d0,d1,d2,d3,d4,d5,k_min]\n    # No spaces, comma-separated values.\n    output_str = f\"[{','.join(map(str, final_output_list))}]\"\n    \n    # Print the final single-line result.\n    print(output_str)\n\n# Run the solver.\nsolve()\n```", "id": "3490832"}]}