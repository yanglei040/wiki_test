{"hands_on_practices": [{"introduction": "本练习将从一个基础的对角化系统入手，帮助你巩固强双曲性的核心定义。通过直接计算特征速度并验证主矩阵的可对角化性，你将掌握判断一个演化系统是否适定的基本方法[@problem_id:3497855]。这个实践是理解更复杂系统（如爱因斯坦方程）性质的起点。", "problem": "考虑一维空间中的线性、常系数、一阶偏微分方程组(PDE)，\n$$\nu_{t} = A\\,\\partial_{x} u,\n$$\n其中 $u(x,t) \\in \\mathbb{R}^{2}$ 且\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}.\n$$\n你需要从第一性原理出发，使用平面波拟设和强双曲性的定义。对于平面波分析，采用\n$$\nu(x,t) = v\\,\\exp\\!\\big(i(k x + \\omega t)\\big),\n$$\n其中 $k \\in \\mathbb{R}$ 是空间波数，$\\omega \\in \\mathbb{R}$ 是时间频率，$v \\in \\mathbb{C}^{2}$ 是一个恒定振幅向量。当 $k \\neq 0$ 时，将特征速度 $c$ 定义为 $c = \\omega/k$。对于强双曲性，使用基于主象征和对角化的定义：如果一个一阶系统的主象征对于空间方向上的所有单位余向量都存在一组具有实特征值的完备特征向量，并且存在一个特征向量矩阵 $S$ 能将主象征对角化，使得算子 2-范数（谱范数）条件数 $\\kappa_{2}(S) = \\|S\\|_{2}\\,\\|S^{-1}\\|_{2}$ 一致有界，则该系统是强双曲的。\n\n仅根据这些定义进行推导：\n- 通过计算平面波拟设所蕴含的色散关系，并将 $\\omega/k$ 与矩阵 $A$ 的特征值联系起来，从而推导出系统的特征速度。\n- 通过明确地展示系统主象征的一个对角化过程，并确定对角化矩阵 $S$ 的算子 2-范数条件数的一致上界，来验证强双曲性。在所有有效的对角化中，确定你能保证的最小一致上界 $\\kappa_{\\ast}$。\n\n将你的最终答案表示为单行矩阵 $\\begin{pmatrix} c_{1}  c_{2}  \\kappa_{\\ast} \\end{pmatrix}$ 的形式，其中 $c_{1}$ 和 $c_{2}$ 是特征速度。无需四舍五入。", "solution": "该问题被评估为有效，因为它具有科学依据、适定且客观。这是一阶双曲偏微分方程理论中的一个标准练习。\n\n给定的偏微分方程组(PDE)是：\n$$\n\\partial_{t} u = A\\,\\partial_{x} u\n$$\n其中 $u(x,t) \\in \\mathbb{R}^{2}$ 且系数矩阵 $A$ 为\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n\n### 推导特征速度\n\n我们采用所提供的平面波拟设：\n$$\nu(x,t) = v\\,\\exp\\big(i(k x + \\omega t)\\big)\n$$\n其中 $v \\in \\mathbb{C}^{2}$ 是一个恒定振幅向量，$k \\in \\mathbb{R}$ 是空间波数，$\\omega \\in \\mathbb{R}$ 是时间频率。\n\n首先，我们计算 $u(x,t)$ 的偏导数：\n$$\n\\partial_{t} u = i\\omega v\\,\\exp\\big(i(k x + \\omega t)\\big) = i\\omega u\n$$\n$$\n\\partial_{x} u = ik v\\,\\exp\\big(i(k x + \\omega t)\\big) = ik u\n$$\n将这些表达式代入偏微分方程组得到：\n$$\ni\\omega u = A(ik u)\n$$\n由于此式必须对任何非平凡解 $u$ 成立，我们可以除以非零标量因子 $i$ 和处处非零的指数项，从而得到关于振幅向量 $v$ 的一个代数方程：\n$$\n\\omega v = k A v\n$$\n对于非平凡解（$v \\neq 0$），此方程必须成立。这可以改写为一个特征值问题：\n$$\nA v = \\frac{\\omega}{k} v\n$$\n对于 $k \\neq 0$。特征速度 $c$ 定义为 $c = \\omega/k$。因此，特征速度就是矩阵 $A$ 的特征值。\n\n或者，我们可以推导色散关系。将方程 $\\omega v = k A v$ 重新整理得到：\n$$\n(k A - \\omega I) v = 0\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。为使 $v$ 有非平凡解，矩阵 $(k A - \\omega I)$ 的行列式必须为零：\n$$\n\\det(k A - \\omega I) = 0\n$$\n让我们计算这个行列式：\n$$\nk A - \\omega I = k \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} - \\omega \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} k - \\omega  0 \\\\ 0  -k - \\omega \\end{pmatrix}\n$$\n行列式为：\n$$\n\\det\\begin{pmatrix} k - \\omega  0 \\\\ 0  -k - \\omega \\end{pmatrix} = (k - \\omega)(-k - \\omega) = -(k - \\omega)(k + \\omega) = 0\n$$\n这给出了频率 $\\omega$ 的两个解：\n$$\n\\omega_1 = k \\quad \\text{和} \\quad \\omega_2 = -k\n$$\n相应的特征速度 $c = \\omega/k$ (对于 $k \\neq 0$) 为：\n$$\nc_{1} = \\frac{\\omega_1}{k} = \\frac{k}{k} = 1\n$$\n$$\nc_{2} = \\frac{\\omega_2}{k} = \\frac{-k}{k} = -1\n$$\n作为检验， $A = \\text{diag}(1, -1)$ 的特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = -1$，这确实是特征速度。\n\n### 验证强双曲性\n\n该偏微分方程组可以写成 $\\partial_t u + A_x \\partial_x u = 0$ 的形式，其中 $A_x = -A$。对于一维空间中的一阶系统，主象征为 $P(n_x) = n_x A_x$，其中 $n_x$ 是空间方向上的单位余向量，即 $n_x \\in \\{-1, 1\\}$。\n在本例中，主象征矩阵为：\n$$\nP(n_x) = n_x(-A) = -n_x A = -n_x \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} -n_x  0 \\\\ 0  n_x \\end{pmatrix}\n$$\n对于强双曲性，对于每个单位余向量 $n_x$，主象征 $P(n_x)$ 必须有一组具有实特征值的完备特征向量，并且必须存在一个对角化矩阵 $S$，其条件数在所有这样的 $n_x$ 上一致有界。\n\n1.  **特征值和特征向量**：\n    矩阵 $P(n_x)$ 是对角矩阵。其特征值是对角线上的元素：$\\lambda_1 = -n_x$ 和 $\\lambda_2 = n_x$。由于 $n_x$ 是实数，因此特征值也是实数。\n    由于当 $n_x \\neq 0$ 时（对于 $n_x \\in \\{-1, 1\\}$ 这是成立的）特征值是互不相同的，因此保证存在一组完备的线性无关特征向量。$P(n_x)$ 的特征向量是标准基向量，与 $n_x$ 的值无关：\n    对于 $\\lambda_1 = -n_x$，特征向量为 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n    对于 $\\lambda_2 = n_x$，特征向量为 $v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n2.  **对角化与条件数**：\n    特征向量的定义可以相差一个非零标量倍数。一个普适的特征向量矩阵 $S$ 由这些缩放后的特征向量作为列构成：\n    $$\n    S = \\begin{pmatrix} \\alpha v_1  \\beta v_2 \\end{pmatrix} = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix}\n    $$\n    其中 $\\alpha, \\beta \\in \\mathbb{C}$ 是非零缩放因子。这个矩阵 $S$ 对任意 $n_x$ 都能将 $P(n_x)$ 对角化。算子 2-范数下的条件数为 $\\kappa_2(S) = \\|S\\|_2 \\|S^{-1}\\|_2$。\n\n    对于对角矩阵，其 2-范数是其对角线元素绝对值的最大值。\n    $$\n    \\|S\\|_2 = \\max(|\\alpha|, |\\beta|)\n    $$\n    $S$ 的逆矩阵为 $S^{-1} = \\begin{pmatrix} 1/\\alpha  0 \\\\ 0  1/\\beta \\end{pmatrix}$，其范数为：\n    $$\n    \\|S^{-1}\\|_2 = \\max\\left(\\left|\\frac{1}{\\alpha}\\right|, \\left|\\frac{1}{\\beta}\\right|\\right) = \\frac{1}{\\min(|\\alpha|, |\\beta|)}\n    $$\n    因此，条件数为：\n    $$\n    \\kappa_2(S) = \\frac{\\max(|\\alpha|, |\\beta|)}{\\min(|\\alpha|, |\\beta|)}\n    $$\n    $\\kappa_2(S)$ 的这个表达式不依赖于余向量 $n_x$。因此，对于任意非零 $\\alpha$ 和 $\\beta$ 的选择，条件数都是一致有界的。该系统是强双曲的。\n\n3.  **最小一致上界 $\\kappa_{\\ast}$**：\n    题目要求我们找到在所有有效对角化中最小的可能一致上界 $\\kappa_{\\ast}$。这对应于在所有可能的 $\\alpha$ 和 $\\beta$ 选择中，找到 $\\kappa_2(S)$ 的最小值。比值 $\\frac{\\max(|\\alpha|, |\\beta|)}{\\min(|\\alpha|, |\\beta|)}$ 总是大于或等于 $1$。当 $|\\alpha| = |\\beta|$ 时，达到最小值 $1$。\n\n    例如，我们可以选择 $\\alpha=1$ 和 $\\beta=1$。这给出了特征向量矩阵 $S = I$，即单位矩阵。\n    $$\n    \\kappa_2(I) = \\|I\\|_2 \\|I^{-1}\\|_2 = 1 \\cdot 1 = 1\n    $$\n    这是任何矩阵可能达到的最低条件数。因此，我们能保证的最小一致上界是 $\\kappa_{\\ast} = 1$。\n\n特征速度为 $c_1=1$，$c_2=-1$，条件数的最小一致上界为 $\\kappa_{\\ast}=1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  -1  1 \\end{pmatrix}}\n$$", "id": "3497855"}, {"introduction": "与前一个理想的例子[@problem_id:3497855]形成对比，本练习探讨了一个典型的弱双曲系统，其主矩阵是一个非对角化的约旦块。通过分析其特征值和特征向量的“缺陷”，你将深刻理解强双曲性与弱双曲性在数学结构上的根本区别[@problem_id:3497799]。这为你认识弱双曲系统为何会导致数值不稳定性奠定了理论基础。", "problem": "考虑一个一维空间中的线性一阶偏微分方程（PDE）组，其未知向量场 $u:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}^{2}$ 由以下方程给出\n$$\n\\partial_{t}u = A\\,\\partial_{x}u,\\quad A=\\begin{pmatrix}1  1\\\\ 0  1\\end{pmatrix}.\n$$\n约定主象征是对于协向量 $\\xi\\in\\mathbb{R}$ 的线性映射 $P(\\xi)=A\\,\\xi$。从一阶系统的主象征和双曲性的定义出发，执行以下步骤：\n- 明确计算主象征 $P(\\xi)$。\n- 确定当 $\\xi\\neq 0$ 时 $P(\\xi)$ 的特征值和特征向量，并判断该系统是强双曲的还是仅为弱双曲的，并根据可对角化性和一致对角化存在与否解释你的推理。\n- 使用关于 $x$ 的傅里叶模态假设，简要论证 $P(\\xi)$ 的结构如何影响高频解随时间的增长，并将其与强双曲性和弱双曲性之间的区别联系起来。\n\n将象征的亏损 $\\delta$ 定义为，对于一个固定的但任意的非零 $\\xi$，$P(\\xi)$ 的任意特征值的代数重数与几何重数之差：\n$$\n\\delta \\equiv \\text{(代数重数)} - \\text{(几何重数)}.\n$$\n最终答案请提供单个数字 $\\delta$。无需四舍五入。不要包含单位。", "solution": "问题要求分析一个给定的一阶偏微分方程（PDE）组的双曲性，并计算一个定义为“亏损”的量。\n\n该偏微分方程组由 $\\partial_{t}u = A\\,\\partial_{x}u$ 给出，其中 $u(t, x)$ 是 $\\mathbb{R}^{2}$ 中的一个向量场，常数矩阵 $A$ 为\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}.\n$$\n问题设定在一维空间中，因此波协向量 $\\xi$ 是 $\\mathbb{R}$ 中的一个标量。\n\n首先，我们计算该系统的主象征。根据所给定义，主象征是由下式给出的矩阵值函数 $P(\\xi)$\n$$\nP(\\xi) = A\\,\\xi = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} \\xi = \\begin{pmatrix} \\xi  \\xi \\\\ 0  \\xi \\end{pmatrix}.\n$$\n\n接下来，我们确定对于非零协向量 $\\xi \\neq 0$ 时 $P(\\xi)$ 的特征值和特征向量。特征值 $\\lambda$ 是特征方程 $\\det(P(\\xi) - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det\\begin{pmatrix} \\xi - \\lambda  \\xi \\\\ 0  \\xi - \\lambda \\end{pmatrix} = (\\xi - \\lambda)^{2} = 0.\n$$\n该方程产生一个单一的特征值 $\\lambda = \\xi$，其代数重数为 $2$。\n\n如果对于每个实协向量 $\\xi$，$P(\\xi)$ 的所有特征值都是实数，那么该系统被定义为双曲系统。在我们的例子中，对于任何 $\\xi \\in \\mathbb{R}$，唯一的特征值是 $\\lambda=\\xi$，它总是实数。因此，该系统是双曲的。\n\n为了区分强双曲性和弱双曲性，我们必须检验 $P(\\xi)$ 的可对角化性，这由其特征值的几何重数决定。特征值的几何重数是其对应特征空间的维度，也就是矩阵 $P(\\xi) - \\lambda I$ 的零空间。对于我们的特征值 $\\lambda = \\xi$，我们需要找到以下矩阵的零空间\n$$\nP(\\xi) - \\xi I = \\begin{pmatrix} \\xi - \\xi  \\xi \\\\ 0  \\xi - \\xi \\end{pmatrix} = \\begin{pmatrix} 0  \\xi \\\\ 0  0 \\end{pmatrix}.\n$$\n令 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 为一个特征向量。条件 $(P(\\xi) - \\xi I)v = 0$ 变为\n$$\n\\begin{pmatrix} 0  \\xi \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} \\xi v_2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n对于一个非零协向量 $\\xi \\neq 0$，这个方程意味着 $\\xi v_2 = 0$，即 $v_2 = 0$。分量 $v_1$ 没有约束。因此，任何特征向量都必须是 $v = \\begin{pmatrix} c \\\\ 0 \\end{pmatrix}$ 的形式，其中 $c \\in \\mathbb{R}$ 是某个非零常数。该特征空间由单个向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 张成。此特征空间的维度是 $1$。\n所以，特征值 $\\lambda = \\xi$ 的几何重数是 $1$。\n\n如果对于所有 $\\xi$，其主象征 $P(\\xi)$ 都是可对角化的，则该系统是强双曲的。这要求对于每个特征值，其代数重数和几何重数都相等。在我们的例子中，对于任何 $\\xi \\neq 0$，代数重数是 $2$，而几何重数是 $1$。由于重数不匹配，矩阵 $P(\\xi)$ 对于任何 $\\xi \\neq 0$ 都不是可对角化的。因此，该系统不是强双曲的。由于它是双曲的但不是强双曲的，所以该系统是弱双曲的。\n\n现在，我们将 $P(\\xi)$ 的结构与高频解的行为联系起来。考虑一个傅里叶模态假设 $u(t, x) = \\hat{u}(t) \\exp(ikx)$，其中 $k$ 是波数。将其代入偏微分方程得到：\n$$\n\\frac{d\\hat{u}(t)}{dt} \\exp(ikx) = A \\,(ik \\hat{u}(t) \\exp(ikx)).\n$$\n这可以简化为关于傅里叶振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\n\\frac{d\\hat{u}(t)}{dt} = ikA \\, \\hat{u}(t) = i P(k) \\, \\hat{u}(t).\n$$\n解由 $\\hat{u}(t) = \\exp(i P(k) t) \\hat{u}(0) = \\exp(iktA) \\hat{u}(0)$ 给出。$A$（以及 $P(k)$）的不可对角化性在这里是至关重要的。矩阵 $A$ 是一个若尔当块。我们可以写出 $A = I + N$，其中 $N = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$ 且 $N^2 = 0$。由于 $I$ 和 $N$ 可交换，我们可以将矩阵指数写为：\n$$\n\\exp(iktA) = \\exp(ikt(I+N)) = \\exp(iktI)\\exp(iktN).\n$$\n使用指数的级数展开，我们有 $\\exp(iktI) = \\exp(ikt)I$ 以及\n$$\n\\exp(iktN) = I + (iktN) + \\frac{(iktN)^2}{2!} + \\dots = I + iktN,\n$$\n因为当 $m \\geq 2$ 时 $N^m = 0$。所以，解算子是：\n$$\n\\exp(iktA) = \\exp(ikt) (I + iktN) = \\exp(ikt) \\begin{pmatrix} 1  ikt \\\\ 0  1 \\end{pmatrix}.\n$$\n傅里叶振幅的解是 $\\hat{u}(t) = \\exp(ikt) \\begin{pmatrix} 1  ikt \\\\ 0  1 \\end{pmatrix} \\hat{u}(0)$。矩阵右上角的项 $ikt$ 导致了长期增长（secular growth）。解向量的范数 $\\|\\hat{u}(t)\\|$ 可以随时间 $t$ 线性增长。这种增长的速率与频率 $k$ 成正比。高频模态（$|k| \\gg 1$）在时间上的这种多项式增长是弱双曲系统的一个标志，并且是主象征不可对角化性的直接后果。相比之下，对于强双曲系统，解算子 $\\exp(iP(k)t)$ 在时间上将是一致有界的，从而防止了这种增长。\n\n最后，我们被要求计算亏损 $\\delta$，它被定义为对于一个固定的非零 $\\xi$，$P(\\xi)$ 的任意特征值的代数重数和几何重数之差。\n根据我们的分析：\n- 特征值 $\\lambda = \\xi$ 的代数重数是 $2$。\n- 特征值 $\\lambda = \\xi$ 的几何重数是 $1$。\n因此，亏损 $\\delta$ 是：\n$$\n\\delta = (\\text{代数重数}) - (\\text{几何重数}) = 2 - 1 = 1.\n$$\n这个结果与非零 $\\xi$ 的具体选择无关。", "answer": "$$\\boxed{1}$$", "id": "3497799"}, {"introduction": "这个动手实践将前面练习[@problem_id:3497855] [@problem_id:3497799]中的理论与计算物理的现实联系起来。你将通过编写代码，亲眼见证弱双曲系统在数值模拟中如何因分辨率提高而变得不稳定。这个练习[@problem_id:3497807]直观地揭示了为什么强双曲性是构建稳定数值相对论模拟的根本要求。", "problem": "考虑广义相对论在线性化 Arnowitt–Deser–Misner (ADM) 形式下，围绕平直时空的情况，并仅关注演化系统的主部。以一阶形式，将状态向量 $\\,\\mathbf{u}(x,t)\\in\\mathbb{R}^2\\,$ 的系统写作\n$$\n\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u},\n$$\n其中 $A$ 是一个捕捉了线性化主符号的常数 $2\\times 2$ 矩阵。一个基本的分析基础是傅里叶（简正模）方法：代入拟设 $\\,\\mathbf{u}(x,t)=\\widehat{\\mathbf{u}}(k,t)e^{i k x}\\,$，其中空间波数为 $\\,k\\in\\mathbb{R}\\,$，以得到\n$$\n\\partial_t \\widehat{\\mathbf{u}} = i k A \\,\\widehat{\\mathbf{u}}.\n$$\n\n该系统的双曲性由 A 的谱性质决定。如果对于每个空间方向，主符号都是可对角化的，具有完备的特征向量集和一致有界的条件数，则该系统是强双曲的。如果特征值是实数，但主符号不可对角化（即存在非平凡的若尔当块），则它只是弱双曲的。已知弱双曲性会导致阿达马意义下的不适定性，表现为相对于频率 $\\,k\\,$ 的无界增长，这在 ADM 系统的数值模拟中可能表现为与分辨率相关的恶化。\n\n您将实现并研究一个模拟此行为的典型弱双曲测试问题。考虑以下两个矩阵：\n$$\nA_{\\text{weak}} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}, \\qquad\nA_{\\text{strong}} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}.\n$$\n矩阵 $A_{\\text{weak}}$ 有一个重特征值和一个非平凡的若尔当块，因此代表一个弱双曲主部。相比之下，$A_{\\text{strong}}$ 可对角化且具有实特征值，代表一个强双曲主部。\n\n您的程序必须使用线方法在周期域 $[0,2\\pi]$ 上对系统进行数值积分：\n- 使用具有 $N$ 个点和网格间距 $\\,h=2\\pi/N\\,$ 的均匀网格。\n- 使用二阶中心差分算子来近似 $\\,\\partial_x\\,$\n$$\nD_h f_j = \\frac{f_{j+1}-f_{j-1}}{2h}, \\quad \\text{带有周期性环绕}。\n$$\n- 使用经典的四阶龙格-库塔方法（RK4）将时间推进到最终时刻 $\\,T\\,$。\n- 使用时间步长 $\\,\\Delta t = \\text{CFL}\\cdot h / a_{\\max}\\,$，其中 $\\,a_{\\max}\\,$ 是 $A$ 所蕴含的特征速度的最大幅值（对于上述选择，取 $\\,a_{\\max}=1\\,$）。通过采用整数步数并将 $\\,\\Delta t = T / n_{\\text{steps}}\\,$ 重置，确保最终时间积分恰好跨越 $T$。\n\n对于初始条件，取一个波数为 $\\,m\\,$ 的傅里叶单模，并根据网格进行缩放：\n$$\n\\mathbf{u}(x,0) = \\begin{cases}\n\\big(\\sin(m x), \\sin(m x)\\big)^{\\top},  \\text{通用双分量模式}, \\\\\n\\big(\\sin(m x), 0\\big)^{\\top},  \\text{针对 } A_{\\text{weak}} \\text{ 的纯特征向量模式}。\n\\end{cases}\n$$\n在具有 $N$ 个点的网格上，设置 $\\,m=\\lfloor \\alpha N \\rfloor\\,$，其中 $\\,\\alpha\\in(0,0.5)\\,$ 是一个固定分数，以探测与分辨率相关的高频行为。使用 $L^2$ 范数\n$$\n\\|\\mathbf{u}\\|_{L^2} = \\left( \\int_0^{2\\pi} \\left(u_1^2(x,t) + u_2^2(x,t)\\right) \\, dx \\right)^{1/2}\n$$\n并用求积公式 $\\,\\left(h\\sum_j \\big(u_{1,j}^2+u_{2,j}^2\\big)\\right)^{1/2}\\,$ 来近似它。定义放大因子\n$$\n\\mathcal{A} = \\frac{\\|\\mathbf{u}(\\cdot,T)\\|_{L^2}}{\\|\\mathbf{u}(\\cdot,0)\\|_{L^2}}.\n$$\n\n任务：\n- 按描述实现数值积分器。\n- 对每个测试案例，计算放大因子 $\\,\\mathcal{A}\\,$。\n\n科学目标：\n- 使用傅里叶符号的观点，解释为什么对于高频模式，使用 $A_{\\text{weak}}$ 的弱双曲系统即使在粗糙网格上短时间内看起来稳定，其放大效应仍会随分辨率的提高而增长。\n- 通过数值演示，对于弱双曲通用模式，$\\,\\mathcal{A}\\,$ 会随着 $\\,h\\to 0\\,$ 而增加，而对于弱双曲纯特征向量模式和强双曲比较案例，$\\,\\mathcal{A}\\,$ 保持在 1 附近。\n\n测试套件：\n为以下参数集 $(\\text{system}, N, \\alpha, T, \\text{CFL})$ 提供结果：\n1. $(\\text{weak\\_generic}, 64, 0.25, 1.0, 0.5)$\n2. $(\\text{weak\\_generic}, 256, 0.25, 1.0, 0.5)$\n3. $(\\text{weak\\_generic}, 512, 0.25, 1.0, 0.5)$\n4. $(\\text{weak\\_eigen}, 256, 0.25, 1.0, 0.5)$\n5. $(\\text{strong\\_generic}, 256, 0.25, 1.0, 0.5)$\n\n答案规格：\n- 对于每个测试案例，将放大因子 $\\,\\mathcal{A}\\,$ 作为浮点数输出，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$）。\n- 不涉及物理单位；所有量纲均为无量纲。", "solution": "此问题已根据指定标准进行验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：$\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u}$，对于状态向量 $\\mathbf{u}(x,t)\\in\\mathbb{R}^2$。\n- **矩阵**：\n  - 弱双曲：$A_{\\text{weak}} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$。\n  - 强双曲：$A_{\\text{strong}} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$。\n- **域**：周期性，$x \\in [0, 2\\pi]$。\n- **数值离散化（线方法）**：\n  - **空间**：具有 $N$ 个点的均匀网格，间距 $h=2\\pi/N$，以及带周期性边界的二阶中心差分算子 $D_h f_j = \\frac{f_{j+1}-f_{j-1}}{2h}$。\n  - **时间**：经典的四阶龙格-库塔（RK4）积分器，直至最终时间 $T$。\n- **时间步长**：$\\Delta t = \\text{CFL}\\cdot h / a_{\\max}$，其中最大特征速度 $a_{\\max}=1$。步数固定为 $n_{\\text{steps}} = \\lceil T / \\Delta t_{\\text{initial}} \\rceil$，并调整时间步长为 $\\Delta t = T / n_{\\text{steps}}$ 以精确达到时间 $T$。\n- **初始条件**：波数为 $m=\\lfloor \\alpha N \\rfloor$ 的傅里叶单模，其中 $\\alpha\\in(0,0.5)$。\n  - 通用模式：$\\mathbf{u}(x,0) = (\\sin(m x), \\sin(m x))^{\\top}$。\n  - 纯特征向量模式（对于 $A_{\\text{weak}}$）：$\\mathbf{u}(x,0) = (\\sin(m x), 0)^{\\top}$。\n- **分析度量**：放大因子 $\\mathcal{A} = \\frac{\\|\\mathbf{u}(\\cdot,T)\\|_{L^2}}{\\|\\mathbf{u}(\\cdot,0)\\|_{L^2}}$，其中 $L^2$ 范数通过求积公式 $\\|\\mathbf{u}\\|_{L^2} \\approx \\left(h\\sum_j \\big(u_{1,j}^2+u_{2,j}^2\\big)\\right)^{1/2}$ 近似。\n- **测试套件**：指定了五个案例，参数为 $(\\text{system}, N, \\alpha, T, \\text{CFL})$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题在科学上是合理的。它探讨了一阶偏微分方程中强双曲性和弱双曲性之间已确立的区别，这是数值相对论和计算物理学中的一个基石主题。矩阵 $A_{\\text{weak}}$ 和 $A_{\\text{strong}}$ 是用于说明此概念的典型例子。对于弱双曲系统预测的数值病态（与分辨率相关的增长）是一种已知现象。\n- **适定性**：该问题是适定的。它指定了一个完整的初边值问题以及一个完全确定的数值求解方法。所有参数均已提供。\n- **客观性**：该问题以精确、客观和形式化的数学语言陈述。\n- **缺陷清单**：该问题没有违反任何指定的无效标准。它在科学上是真实的、可形式化的、完整的、可行的、结构良好的且非平凡的。\n\n### 第 3 步：结论与操作\n该问题有效。下面提供了完整的解决方案。\n\n### 基于原理的解答\n\n该问题研究了偏微分方程（PDE）系统中弱双曲性的数值后果。我们通过检查傅里叶空间中演化算子的性质来分析系统 $\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u}$ 的行为。\n\n**1. 双曲性与傅里叶符号**\n\n对于平面波拟设 $\\mathbf{u}(x,t)=\\widehat{\\mathbf{u}}(k,t)e^{i k x}$，其中空间波数为 $k$，偏微分方程系统转换为傅里叶振幅 $\\widehat{\\mathbf{u}}$ 的常微分方程组（ODEs）：\n$$\n\\partial_t \\widehat{\\mathbf{u}} = i k A \\,\\widehat{\\mathbf{u}}\n$$\n矩阵 $P(k) = ikA$ 是微分算子的傅里叶符号。如果主符号矩阵（在此一维情况下为 $A$）的所有特征值均为实数，则系统定义为双曲系统。这确保了解 $\\widehat{\\mathbf{u}}(k,t) = e^{ikAt}\\widehat{\\mathbf{u}}(k,0)$ 对每个模式 $k$ 都是纯粹是振荡的，而不是指数增长的。\n\n**2. 强双曲性与弱双曲性**\n\n双曲性的性质取决于 $A$ 的特征系统：\n- **强双曲性 ($A_{\\text{strong}}$)**：矩阵 $A_{\\text{strong}} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$ 具有不同的实特征值 $\\lambda = 1, -1$ 并且是可对角化的。演化算子 $e^{ikA_{\\text{strong}}t}$ 是幺正的（在坐标变换下），因此它在任何时候都保持 $\\widehat{\\mathbf{u}}(k,t)$ 的范数。因此，解的总 $L^2$ 范数是守恒的，放大因子 $\\mathcal{A}$ 预期为 $1$。\n- **弱双曲性 ($A_{\\text{weak}}$)**：矩阵 $A_{\\text{weak}} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$ 有一个重复的实特征值 $\\lambda = 1$ 但不可对角化；它拥有一个非平凡的若尔当块。其矩阵指数可以计算为：\n$$\ne^{ikA_{\\text{weak}}t} = e^{ikt(I+N)} = e^{ikt}e^{ikNt} = e^{ikt}(I + ikNt + \\frac{(ikNt)^2}{2!} + \\dots)\n$$\n其中 $N = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$。由于 $N^2=0$，级数截断为：\n$$\ne^{ikA_{\\text{weak}}t} = e^{ikt} \\left( I + ikNt \\right) = e^{ikt} \\begin{pmatrix} 1  ikt \\\\ 0  1 \\end{pmatrix}\n$$\n模式的解为 $\\widehat{\\mathbf{u}}(k,t) = e^{ikt} \\begin{pmatrix} 1  ikt \\\\ 0  1 \\end{pmatrix} \\widehat{\\mathbf{u}}(k,0)$。如果初始数据 $\\widehat{\\mathbf{u}}(k,0)$ 有一个不属于真特征空间的分量（即第二个分量非零），则项 $ikt$ 导致 $\\widehat{\\mathbf{u}}(k,t)$ 第一个分量的振幅随时间 $t$ 和波数 $k$ 线性增长。这种相对于 $k$ 的无界增长表明连续问题在阿达马意义下是不适定的。\n\n**3. 数值意义**\n\n线方法将空间域离散化，用离散矩阵算子替换连续的微分算子 $\\partial_x$。二阶中心差分算子 $D_h$ 的符号是通过将其应用于网格函数 $e^{ikx_j}$ 来找到的：\n$$\nD_h e^{ikx_j} \\to i \\frac{\\sin(kh)}{h} e^{ikx_j}\n$$\n半离散系统对于一个傅里叶模式的行为类似于 $\\partial_t \\widehat{\\mathbf{u}} = i k_{\\text{eff}} A \\widehat{\\mathbf{u}}$，其中 $k_{\\text{eff}}(k) = \\frac{\\sin(kh)}{h}$ 是有效波数。\n\n对于弱双曲情况，增长现在与 $k_{\\text{eff}}t$ 成正比。在具有 $N$ 个点和间距 $h=2\\pi/N$ 的网格上，可以解析的最高波数约为 $k \\sim 1/h \\propto N$。当 $kh=\\pi/2$ 时，$k_{\\text{eff}}$ 最大，此时 $k_{\\text{eff}} = 1/h \\propto N$。问题设计时 $\\alpha=0.25$，它将初始模式波数设置为 $m = \\lfloor 0.25 N \\rfloor$。这对应的网格波数为 $kh = m (2\\pi/N) \\approx 0.25 \\times 2\\pi = \\pi/2$。这个选择精确地锁定了最大数值增长的频率。\n\n因此，对于具有通用初始条件的弱双曲系统：\n- 放大是由演化算子中的 $ikt$ 项引起的。\n- 更高的分辨率（更大的 $N$，更小的 $h$）允许表示具有更大有效波数 $k_{\\text{eff}} \\approx 1/h$ 的模式。\n- 这导致在固定时间 $T$ 内增长因子更大，从而使放大因子 $\\mathcal{A}$ 随分辨率增加而增加。这正是数值测试要证明的。\n\n相比之下：\n- 对于 `weak_eigen` 情况，初始条件 $\\mathbf{u}(x,0) = (\\sin(mx), 0)^\\top$ 完全位于 $A_{\\text{weak}}$ 的特征空间内。演化算子不引起增长：$e^{ikt}\\begin{pmatrix} 1  ikt \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\hat{u}_1 \\\\ 0 \\end{pmatrix} = e^{ikt}\\begin{pmatrix} \\hat{u}_1 \\\\ 0 \\end{pmatrix}$。范数被保持，$\\mathcal{A} \\approx 1$。\n- 对于 `strong_generic` 情况，系统是保范数的。数值离散化会引入小误差，但预期不会有系统性增长，因此 $\\mathcal{A} \\approx 1$。\n\n**4. 实现细节**\n\n解决方案使用线方法实现。状态向量 $\\mathbf{u}(x,t)$ 被离散化到具有 $N$ 个点的网格上，产生一个大小为 $2N$ 的大型状态向量。在每个网格点上，使用带周期性环绕的中心差分公式计算空间导数 $\\partial_x \\mathbf{u}$，这可以高效地使用 `np.roll` 实现。这给出了一个大型常微分方程组的右端项 (RHS)，$\\frac{d}{dt}\\mathbf{U} = F(\\mathbf{U})$。然后，使用经典的四阶龙格-库塔（RK4）方法将此 ODE 系统从 $t=0$ 积分到 $t=T$。最后，通过数值求积计算初始和最终状态的 $L^2$ 范数，以求得放大因子 $\\mathcal{A}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(system_type, N, alpha, T, CFL):\n    \"\"\"\n    Runs a single simulation for the given parameters.\n\n    Args:\n        system_type (str): Type of system ('weak_generic', 'weak_eigen', 'strong_generic').\n        N (int): Number of grid points.\n        alpha (float): Factor to determine the initial mode wavenumber.\n        T (float): Final integration time.\n        CFL (float): CFL number for time step calculation.\n\n    Returns:\n        float: The amplification factor A.\n    \"\"\"\n    # 1. Setup Grid and System Matrix\n    h = 2 * np.pi / N\n    x = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    \n    A_weak = np.array([[1.0, 1.0], [0.0, 1.0]])\n    A_strong = np.array([[1.0, 0.0], [0.0, -1.0]])\n\n    m = int(alpha * N)\n\n    # 2. Set Initial Conditions\n    if system_type == 'weak_generic':\n        A = A_weak\n        u0 = np.array([np.sin(m * x), np.sin(m * x)])\n    elif system_type == 'weak_eigen':\n        A = A_weak\n        u0 = np.array([np.sin(m * x), np.zeros(N)])\n    elif system_type == 'strong_generic':\n        A = A_strong\n        u0 = np.array([np.sin(m * x), np.sin(m * x)])\n    else:\n        raise ValueError(\"Invalid system_type\")\n\n    # 3. Setup Time Integration\n    a_max = 1.0 # Max characteristic speed\n    dt_initial = CFL * h / a_max\n    # Problem specifies to adjust dt to hit T exactly\n    num_steps = int(np.ceil(T / dt_initial))\n    dt = T / num_steps\n\n    # 4. Define the RHS function for the ODE system d(u)/dt = F(u)\n    def rhs(u_state, A_matrix, h_spacing):\n        \"\"\"\n        Calculates the right-hand side of the semi-discretized PDE system.\n        RHS = A * d(u)/dx\n        \"\"\"\n        # Second-order centered difference with periodic boundaries\n        # np.roll(u, -1, axis=1) corresponds to u_{j+1}\n        # np.roll(u, 1, axis=1) corresponds to u_{j-1}\n        du_dx = (np.roll(u_state, -1, axis=1) - np.roll(u_state, 1, axis=1)) / (2 * h_spacing)\n        \n        # Apply the matrix A to the spatial derivatives\n        # A is (2,2), du_dx is (2,N). Result is (2,N)\n        return A_matrix @ du_dx\n\n    # 5. Perform RK4 Time Integration\n    u = u0.copy()\n    for _ in range(num_steps):\n        k1 = rhs(u, A, h)\n        k2 = rhs(u + dt / 2 * k1, A, h)\n        k3 = rhs(u + dt / 2 * k2, A, h)\n        k4 = rhs(u + dt * k3, A, h)\n        u += dt / 6 * (k1 + 2 * k2 + 2 * k3 + k4)\n\n    # 6. Calculate Amplification Factor\n    # L2 norm is sqrt(h * sum(u_1^2 + u_2^2))\n    norm_initial = np.sqrt(h * np.sum(u0**2))\n    norm_final = np.sqrt(h * np.sum(u**2))\n    \n    amplification = norm_final / norm_initial\n    return amplification\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (system_type, N, alpha, T, CFL)\n        ('weak_generic', 64, 0.25, 1.0, 0.5),\n        ('weak_generic', 256, 0.25, 1.0, 0.5),\n        ('weak_generic', 512, 0.25, 1.0, 0.5),\n        ('weak_eigen', 256, 0.25, 1.0, 0.5),\n        ('strong_generic', 256, 0.25, 1.0, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(*params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Results are rounded to three decimal places.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```", "id": "3497807"}]}