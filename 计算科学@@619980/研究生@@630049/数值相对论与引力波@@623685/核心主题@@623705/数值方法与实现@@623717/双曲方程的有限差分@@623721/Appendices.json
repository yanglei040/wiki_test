{"hands_on_practices": [{"introduction": "相对论中数值模拟的精度取决于我们如何用离散公式逼近连续的导数。高阶有限差分模板对于最大限度地减少引力波模拟中的误差至关重要。本练习 [@problem_id:3474408] 将引导你通过泰勒级数展开，系统地消除误差项，从而推导出一个高阶模板的系数，这是任何计算物理学家的核心技能。", "problem": "线方法（MOL）是一种求解双曲型偏微分方程的方法，常用于数值相对论和引力波建模。在该方法中，诸如 $u_{x}$ 的空间导数在均匀网格上通过有限差分进行近似。考虑一个间距为 $\\Delta x$ 的均匀一维网格，其网格点为 $x_{i} = x_{0} + i \\,\\Delta x$。设有一个光滑函数 $u(x)$，它代表（例如）一个线性化引力波传播模型的特征场。您需要使用一个对称七点格式 $\\{x_{i+k}\\}_{k=-3}^{3}$ 来构建一阶导数 $u_{x}(x_{i})$ 的中心有限差分近似。假设其表示形式为\n$$\nu_{x}(x_{i}) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_{k} \\, u(x_{i+k}),\n$$\n其中系数 $c_{k}$ 的选择需要达到六阶精度。\n\n从 $u(x_{i+k})$ 在 $x_{i}$ 处的泰勒级数展开开始，通过施加必要的阶数条件，使得 $u_{x}(x_{i})$ 近似的截断误差为 $\\mathcal{O}(\\Delta x^{6})$，来推导对称七点格式的系数 $\\{c_{k}\\}_{k=-3}^{3}$。利用格式是中心的且导数是奇的这一事实，来证明 $c_{0} = 0$ 且对于 $k=1,2,3$ 有 $c_{-k} = -c_{k}$。将您的最终结果表示为有序系数行向量\n$$\n\\big(c_{-3},\\, c_{-2},\\, c_{-1},\\, c_{0},\\, c_{1},\\, c_{2},\\, c_{3}\\big)\n$$\n其中，整体因子 $1/\\Delta x$ 已被提出，作为离散和的乘数。无需进行四舍五入。", "solution": "该问题要求推导一阶导数 $u_x(x_i)$ 的六阶精度中心有限差分近似的系数 $\\{c_k\\}$。该近似定义在间距为 $\\Delta x$ 的均匀网格上，并使用对称七点格式 $\\{x_{i+k}\\}_{k=-3}^{3}$。其公式为：\n$$\nu_x(x_i) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\, u(x_{i+k})\n$$\n为确定这些系数，我们将每一项 $u(x_{i+k}) = u(x_i + k\\Delta x)$ 在点 $x_i$ 附近进行泰勒级数展开。设 $u^{(n)}(x_i)$ 表示 $u$ 在 $x_i$ 处的 $n$ 阶导数。泰勒级数为：\n$$\nu(x_i + k\\Delta x) = \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i)\n$$\n将此展开式代入有限差分公式，我们得到：\n$$\n\\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\left( \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i) \\right)\n$$\n通过交换求和顺序，我们可以按 $u$ 的导数对各项进行分组：\n$$\n\\sum_{n=0}^{\\infty} \\left( \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\frac{(k\\Delta x)^n}{n!} \\right) u^{(n)}(x_i) = \\sum_{n=0}^{\\infty} \\left( \\sum_{k=-3}^{3} c_k k^n \\right) \\frac{(\\Delta x)^{n-1}}{n!} u^{(n)}(x_i)\n$$\n我们希望这个表达式是 $u_x(x_i) = u^{(1)}(x_i)$ 的一个近似。这意味着 $u^{(1)}(x_i)$ 的系数必须为 $1$，而其他导数 $u^{(n)}(x_i)$（对于 $n \\neq 1$）的系数在达到所需精度阶数之前应为零。为达到六阶精度，截断误差必须为 $\\mathcal{O}(\\Delta x^6)$。这意味着对于 $n=0, 2, 3, 4, 5, 6$，$ (\\Delta x)^{n-1} u^{(n)}(x_i)$ 的系数必须为零。\n\n这导出了关于系数 $c_k$ 的以下方程组：\n\\begin{enumerate}\n    \\item $u^{(0)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^0 = 0$\n    \\item $u^{(1)}(x_i)$ 的系数： $\\frac{(\\Delta x)^{1-1}}{1!} \\sum_{k=-3}^{3} c_k k^1 = 1 \\implies \\sum_{k=-3}^{3} c_k k = 1$\n    \\item $u^{(2)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^2 = 0$\n    \\item $u^{(3)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^3 = 0$\n    \\item $u^{(4)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^4 = 0$\n    \\item $u^{(5)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^5 = 0$\n    \\item $u^{(6)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^6 = 0$\n\\end{enumerate}\n第一个不为零的高阶项将是 $u^{(7)}(x_i)$ 的系数，这导致截断误差与 $(\\Delta x)^6 u^{(7)}(x_i)$ 成正比。\n\n问题陈述中提到，由于格式是中心的且一阶导数具有奇性，系数必须满足反对称条件 $c_{-k} = -c_k$。这意味着 $c_0 = -c_0$，从而得到 $c_0 = 0$。此性质显著简化了该方程组。\n\n我们来考察 $k$ 的偶次幂和奇次幂的和：\n对于任意偶次幂 $n=2m$（其中 $m=0, 1, 2, 3, \\dots$）：\n$$\n\\sum_{k=-3}^{3} c_k k^{2m} = c_0 \\cdot 0^{2m} + \\sum_{k=1}^{3} (c_k k^{2m} + c_{-k}(-k)^{2m}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m} - c_k k^{2m}) = 0\n$$\n这表明方程 $1$、$3$、$5$ 和 $7$（对于 $n=0, 2, 4, 6$）会因系数的反对称性而自动满足。\n\n对于任意奇次幂 $n=2m+1$（其中 $m=0, 1, 2, \\dots$）：\n$$\n\\sum_{k=-3}^{3} c_k k^{2m+1} = c_0 \\cdot 0^{2m+1} + \\sum_{k=1}^{3} (c_k k^{2m+1} + c_{-k}(-k)^{2m+1}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m+1} - c_k(-k^{2m+1})) = 2 \\sum_{k=1}^{3} c_k k^{2m+1}\n$$\n将此应用于剩余的奇数 $n$ 的方程：\n\\begin{itemize}\n    \\item $n=1$ 时： $2 \\sum_{k=1}^{3} c_k k = 1 \\implies c_1 + 2c_2 + 3c_3 = \\frac{1}{2}$\n    \\item $n=3$ 时： $2 \\sum_{k=1}^{3} c_k k^3 = 0 \\implies c_1 + 8c_2 + 27c_3 = 0$\n    \\item $n=5$ 时： $2 \\sum_{k=1}^{3} c_k k^5 = 0 \\implies c_1 + 32c_2 + 243c_3 = 0$\n\\end{itemize}\n现在我们得到了一个关于三个未知系数 $c_1, c_2, c_3$ 的三元线性方程组：\n$$\n\\begin{array}{rcrcrcr}\nc_1  +  2c_2  +  3c_3  =  1/2 \\\\\nc_1  +  8c_2  +  27c_3  =  0 \\\\\nc_1  +  32c_2  +  243c_3  =  0\n\\end{array}\n$$\n为求解此方程组，我们使用消元法。第三个方程减去第二个方程，得到：\n$$\n(32-8)c_2 + (243-27)c_3 = 0 \\implies 24c_2 + 216c_3 = 0\n$$\n两边同除以 $24$，我们得到 $c_2$ 和 $c_3$ 之间的一个关系：\n$$\nc_2 + 9c_3 = 0 \\implies c_2 = -9c_3\n$$\n接下来，第二个方程减去第一个方程：\n$$\n(8-2)c_2 + (27-3)c_3 = 0 - \\frac{1}{2} \\implies 6c_2 + 24c_3 = -\\frac{1}{2}\n$$\n将 $c_2 = -9c_3$ 代入此方程：\n$$\n6(-9c_3) + 24c_3 = -\\frac{1}{2} \\implies -54c_3 + 24c_3 = -\\frac{1}{2}\n$$\n$$\n-30c_3 = -\\frac{1}{2} \\implies c_3 = \\frac{1}{60}\n$$\n现在我们可以求出 $c_2$：\n$$\nc_2 = -9c_3 = -9 \\left( \\frac{1}{60} \\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\n最后，我们使用第一个方程求出 $c_1$：\n$$\nc_1 = \\frac{1}{2} - 2c_2 - 3c_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right)\n$$\n$$\nc_1 = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{1}{2} + \\frac{3}{10} - \\frac{1}{20}\n$$\n使用公分母 $20$：\n$$\nc_1 = \\frac{10}{20} + \\frac{6}{20} - \\frac{1}{20} = \\frac{15}{20} = \\frac{3}{4}\n$$\n所以，系数为 $c_1 = \\frac{3}{4}$，$c_2 = -\\frac{3}{20}$，以及 $c_3 = \\frac{1}{60}$。\n对称七点格式的完整系数集为：\n$$\nc_3 = \\frac{1}{60}\n$$\n$$\nc_2 = -\\frac{3}{20}\n$$\n$$\nc_1 = \\frac{3}{4}\n$$\n$$\nc_0 = 0\n$$\n$$\nc_{-1} = -c_1 = -\\frac{3}{4}\n$$\n$$\nc_{-2} = -c_2 = \\frac{3}{20}\n$$\n$$\nc_{-3} = -c_3 = -\\frac{1}{60}\n$$\n问题要求给出有序系数行向量 $(c_{-3}, c_{-2}, c_{-1}, c_0, c_1, c_2, c_3)$。该向量为：\n$$\n\\left(-\\frac{1}{60}, \\frac{3}{20}, -\\frac{3}{4}, 0, \\frac{3}{4}, -\\frac{3}{20}, \\frac{1}{60}\\right)\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60}  \\frac{3}{20}  -\\frac{3}{4}  0  \\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60} \\end{pmatrix}}\n$$", "id": "3474408"}, {"introduction": "在实现一个数值方案后，最关键的步骤是验证：确认代码的行为与理论预期一致。这个概念性练习 [@problem_id:3474345] 深入探讨了收敛性测试的原理，这是衡量模拟精度的标准程序。通过分析假设的实验数据，你将学会如何计算观测到的收敛阶数，并区分正确的验证实践与常见的误解。", "problem": "考虑周期区间 $[0,1]$ 上的线性平流方程 $u_t + c\\,u_x = 0$，其具有光滑初始数据和波速 $c>0$。空间上采用线方法有限差分离散，并采用显式龙格-库塔积分器进行时间推进。在网格加密过程中，Courant–Friedrichs–Lewy (CFL) 数保持不变，且时间积分器的阶数至少与空间阶数一样高，因此全局误差由空间截断误差主导。设网格点 $x_i$ 处的离散解为 $u_i$，并设 $u_i^{\\text{exact}}$ 表示在相同网格点上采样的精确解。定义离散误差范数\n$$\nL_2 = \\left(\\sum_{i} \\left|u_i - u_i^{\\text{exact}}\\right|^2\\,\\Delta x\\right)^{1/2},\\qquad\nL_\\infty = \\max_i \\left|u_i - u_i^{\\text{exact}}\\right|.\n$$\n假设该格式是一致且稳定的，因此在渐近区域内，当以固定CFL数、加密因子 $r>1$ 进行网格加密时，全局误差遵循 $\\|e_h\\| = C h^p + \\mathcal{O}(h^{p+1})$，其中 $h$ 是网格间距，$p$ 是空间精度阶数，$C$ 是一个取决于解和范数的常数。你在网格间距为 $h$、$h/2$ 和 $h/4$（因此加密比为 $r=2$）的网格上进行了三次模拟，直至时间 $T$。测得的误差如下：\n- 对于 $L_2$ 范数：$L_2(h) = 1.31\\times 10^{-3}$，$L_2(h/2) = 3.27\\times 10^{-4}$，$L_2(h/4) = 8.18\\times 10^{-5}$。\n- 对于 $L_\\infty$ 范数：$L_\\infty(h) = 1.07\\times 10^{-2}$，$L_\\infty(h/2) = 2.69\\times 10^{-3}$，$L_\\infty(h/4) = 6.80\\times 10^{-4}$。\n\n仅使用上述基本定义以及在固定CFL数下，主导全局误差在渐近区域内按 $C h^p$ 比例缩放的假设，评估以下关于 Richardson 外推和观测到的精度阶数的陈述。选择所有正确的陈述。\n\nA. 对于任何一致的范数 $L(\\cdot)$，观测阶数的两层网格 Richardson 估计为 $p \\approx \\dfrac{\\ln\\!\\left(L(h)/L(h/r)\\right)}{\\ln r}$。根据给定的 $L_2$ 数据和 $r=2$，计算结果精确到两位小数为 $p \\approx 2.00$。\n\nB. 如果精确解不可用，只要解是光滑的且主导截断误差占优，就可以用网格间差异替换精确误差范数，并通过 $p \\approx \\dfrac{\\ln\\!\\left(\\|u_h - u_{h/r}\\|/\\|u_{h/r} - u_{h/r^2}\\|\\right)}{\\ln r}$ 在一致范数下估计 $p$。在渐近区域内，该估计值趋于从精确误差范数中提取的相同 $p$。\n\nC. $L_\\infty$ 范数不适用于双曲问题，并且对于光滑解，在网格加密下不收敛，因此任何基于 $L_\\infty$ 的 Richardson 估计即使对于高阶格式也会趋向于 $p\\to 0$。\n\nD. 为确保观测到的阶数反映空间精度，在线方法中，标准做法是在加密过程中保持 Courant–Friedrichs–Lewy 数不变，并使用阶数至少为 $p$ 的时间积分器，这样时间离散误差的缩放比例为 $\\mathcal{O}(\\Delta t^{p_t})$ 且 $p_t\\ge p$，从而不会污染空间阶数的估计。\n\nE. 一个三层网格范数的外推公式 $L_{\\text{extrap}}(h/4) = \\dfrac{2^p L(h/4) - L(h/2)}{2^p - 1}$ 可用于消除主导误差项，并且无论 $p$ 是否已知都有效；然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 在没有额外数据的情况下后验地计算 $p$。", "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：周期区间 $[0,1]$ 上的线性平流方程 $u_t + c\\,u_x = 0$，具有光滑初始数据和正波速 $c>0$。\n- **数值方法**：采用线方法，空间上使用有限差分离散，时间上使用显式龙格-库塔积分器。\n- **实验设置**：\n    - 在网格加密期间，Courant–Friedrichs–Lewy (CFL) 数保持不变。\n    - 时间积分器的阶数至少与空间精度阶数一样高。\n    - 全局误差由空间截断误差主导。\n    - 在间距为 $h$、$h/2$ 和 $h/4$ 的网格上运行三次模拟直至最终时间 $T$，对应的加密比为 $r=2$。\n- **误差定义**：设 $u_i$ 为离散解，$u_i^{\\text{exact}}$ 为在网格点 $x_i$ 处的精确解。\n    - 离散 $L_2$ 误差范数为 $L_2 = \\left(\\sum_{i} \\left|u_i - u_i^{\\text{exact}}\\right|^2\\,\\Delta x\\right)^{1/2}$。\n    - 离散 $L_\\infty$ 误差范数为 $L_\\infty = \\max_i \\left|u_i - u_i^{\\text{exact}}\\right|$。\n- **渐近误差模型**：对于一致且稳定的格式，假设全局误差范数 $\\|e_h\\|$ 遵循 $\\|e_h\\| = C h^p + \\mathcal{O}(h^{p+1})$，其中 $h$ 是网格间距，$p$ 是空间精度阶数。\n- **测量数据**：\n    - $L_2(h) = 1.31\\times 10^{-3}$，$L_2(h/2) = 3.27\\times 10^{-4}$，$L_2(h/4) = 8.18\\times 10^{-5}$。\n    - $L_\\infty(h) = 1.07\\times 10^{-2}$，$L_\\infty(h/2) = 2.69\\times 10^{-3}$，$L_\\infty(h/4) = 6.80\\times 10^{-4}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题在偏微分方程数值分析的成熟领域中有充分的依据。线性平流方程、线方法、CFL 条件、误差范数和收敛性分析都是标准概念。\n- **适定性**：该问题是适定的。它要求根据所提供的定义和数据评估一组陈述，这是一个可以根据计算和既定理论得出确定答案的任务。\n- **客观性**：问题陈述是客观的，使用了精确的数学和计算术语。\n- **结论**：问题陈述没有科学上的不健全、模糊性和矛盾之处。它描述了一个标准的数值实验，并要求根据结果进行分析。因此，该问题是**有效的**。\n\n### 第 3 步：推导与选项分析\n问题要求评估五个陈述。将逐一进行分析。\n\n**A. 对于任何一致的范数 $L(\\cdot)$，观测阶数的两层网格 Richardson 估计为 $p \\approx \\dfrac{\\ln\\!\\left(L(h)/L(h/r)\\right)}{\\ln r}$。根据给定的 $L_2$ 数据和 $r=2$，计算结果精确到两位小数为 $p \\approx 2.00$。**\n\n观测收敛阶数 $p$ 的公式推导始于渐近误差模型：\n对于间距为 $h$ 的网格上的误差范数 $L$，有 $L(h) \\approx C h^p$。\n对于间距为 $h/r$ 的加密网格，误差为：\n$L(h/r) \\approx C (h/r)^p = C h^p / r^p$。\n将两个误差相除可以消去未知常数 $C$：\n$$\n\\frac{L(h)}{L(h/r)} \\approx \\frac{C h^p}{C h^p / r^p} = r^p\n$$\n两边取自然对数求解 $p$ 可得：\n$$\n\\ln\\left(\\frac{L(h)}{L(h/r)}\\right) \\approx \\ln(r^p) = p \\ln r\n$$\n$$\np \\approx \\frac{\\ln(L(h)/L(h/r))}{\\ln r}\n$$\n陈述中提供的公式是正确的。现在我们将其应用于给定的 $L_2$ 数据，其中 $r=2$。通常做法是使用最密的两层网格来最准确地估计渐近阶数。因此，我们使用 $L_2(h/2)$ 和 $L_2(h/4)$：\n$L(h') = L_2(h/2) = 3.27\\times 10^{-4}$\n$L(h'/r) = L_2(h/4) = 8.18\\times 10^{-5}$\n加密比为 $r=2$。\n$$\np \\approx \\frac{\\ln\\left(\\frac{3.27\\times 10^{-4}}{8.18\\times 10^{-5}}\\right)}{\\ln 2} \\approx \\frac{\\ln(3.997555...)}{\\ln 2} \\approx \\frac{1.38565}{0.69315} \\approx 1.9991\n$$\n精确到两位小数，结果是 $p \\approx 2.00$。该陈述正确。\n\n**对 A 的判决：** 正确。\n\n**B. 如果精确解不可用，只要解是光滑的且主导截断误差占优，就可以用网格间差异替换精确误差范数，并通过 $p \\approx \\dfrac{\\ln\\!\\left(\\|u_h - u_{h/r}\\|/\\|u_{h/r} - u_{h/r^2}\\|\\right)}{\\ln r}$ 在一致范数下估计 $p$。在渐近区域内，该估计值趋于从精确误差范数中提取的相同 $p$。**\n\n该陈述描述了当精确解未知时进行收敛性分析的一种标准技术。设 $u_{\\text{exact}}$ 为在网格上采样的精确解。设 $u_h$ 为间距为 $h$ 的网格上的数值解。误差为 $e_h = u_h - u_{\\text{exact}}$。我们假设 $e_h(x) \\approx C(x) h^p$。\n两层网格上解的差异是：\n$u_h - u_{h/r} = (u_{\\text{exact}} + e_h) - (u_{\\text{exact}} + e_{h/r}) = e_h - e_{h/r}$。\n假设 $e_h \\approx C h^p$，我们有：\n$u_h - u_{h/r} \\approx C h^p - C (h/r)^p = C h^p (1 - r^{-p})$。\n因此，该差异的范数缩放如下：\n$\\|u_h - u_{h/r}\\| \\approx \\|C h^p (1-r^{-p})\\| \\approx K_1 h^p$，其中 $K_1$ 是一个常数。\n类似地，对于下一层加密：\n$\\|u_{h/r} - u_{h/r^2}\\| \\approx K_1 (h/r)^p$。\n取这些范数的比值：\n$$\n\\frac{\\|u_h - u_{h/r}\\|}{\\|u_{h/r} - u_{h/r^2}\\|} \\approx \\frac{K_1 h^p}{K_1 (h/r)^p} = r^p\n$$\n求解 $p$ 即可得到陈述中给出的公式。该过程在所述条件（光滑解，渐近区域）下是有效的，并且是实用代码验证的基石。\n\n**对 B 的判决：** 正确。\n\n**C. $L_\\infty$ 范数不适用于双曲问题，并且对于光滑解，在网格加密下不收敛，因此任何基于 $L_\\infty$ 的 Richardson 估计即使对于高阶格式也会趋向于 $p\\to 0$。**\n\n这个陈述根本上是错误的。对于应用于具有光滑解的线性双曲方程（如问题中所述）的稳定、一致的数值格式，误差在所有标准范数（包括 $L_\\infty$ (最大值) 范数）下，都应随着网格加密收敛到零。对于光滑问题，$L_2$ 和 $L_\\infty$ 范数下的收敛阶数 $p$ 应该相同。像 Gibbs 振荡这样会降低 $L_\\infty$ 收敛性的问题，是出现在*不连续*解的情况下，而问题的前提“光滑初始数据”明确排除了这种情况。\n我们可以直接用所提供的数据证伪该陈述。让我们使用 $L_\\infty$ 数据和陈述 A 中的公式来计算观测到的收敛阶数。我们使用最密的两层网格：\n$L_\\infty(h/2) = 2.69\\times 10^{-3}$\n$L_\\infty(h/4) = 6.80\\times 10^{-4}$\n$r=2$。\n$$\np \\approx \\frac{\\ln\\left(\\frac{2.69\\times 10^{-3}}{6.80\\times 10^{-4}}\\right)}{\\ln 2} \\approx \\frac{\\ln(3.95588...)}{\\ln 2} \\approx \\frac{1.3752}{0.69315} \\approx 1.984\n$$\n在 $L_\\infty$ 范数下观测到的收敛阶数约为 $p \\approx 1.98$，这与使用 $L_2$ 范数得到的阶数 $2$ 非常接近。这与二阶格式的预期一致，并直接反驳了收敛阶数将趋于 $0$ 的说法。\n\n**对 C 的判决：** 错误。\n\n**D. 为确保观测到的阶数反映空间精度，在线方法中，标准做法是在加密过程中保持 Courant–Friedrichs–Lewy 数不变，并使用阶数至少为 $p$ 的时间积分器，这样时间离散误差的缩放比例为 $\\mathcal{O}(\\Delta t^{p_t})$ 且 $p_t\\ge p$，从而不会污染空间阶数的估计。**\n\n该陈述准确地描述了对线方法离散进行收敛性分析的标准方法。全局误差是空间离散误差 $E_{\\text{space}}$ 和时间离散误差 $E_{\\text{time}}$ 的组合。\n$E_{\\text{total}} \\approx E_{\\text{space}} + E_{\\text{time}}$\n假设这些误差的缩放方式如下：\n$\\|E_{\\text{space}}\\| \\approx C_s h^p$\n$\\|E_{\\text{time}}\\| \\approx C_t \\Delta t^{p_t}$\n其中 $p$ 是空间阶数，$p_t$ 是时间阶数。\n为了测试空间阶数 $p$，我们加密空间网格，$h \\to h/r$。CFL 数定义为 $\\lambda = c \\Delta t / h$。保持 $\\lambda$ 不变意味着当 $h$ 改变时，$\\Delta t$ 必须成比例地改变：$\\Delta t = (\\lambda/c) h$。\n将此代入总误差表达式可得：\n$\\|E_{\\text{total}}\\| \\approx C_s h^p + C_t \\left(\\frac{\\lambda}{c} h\\right)^{p_t} = C_s h^p + C'_t h^{p_t}$。\n要使总误差呈现出 $p$ 的收敛率，当 $h \\to 0$ 时，$C_s h^p$ 项必须是主导项。这要求另一项 $C'_t h^{p_t}$ 的消失速度至少与 $h^p$ 一样快。这个条件是 $p_t \\ge p$。如果 $p_t  p$，时间误差将占主导地位，观测到的收敛率将是 $p_t$，而不是空间阶数 $p$。因此，所描述的程序对于正确测量空间精度阶数是必要的。\n\n**对 D 的判决：** 正确。\n\n**E. 一个三层网格范数的外推公式 $L_{\\text{extrap}}(h/4) = \\dfrac{2^p L(h/4) - L(h/2)}{2^p - 1}$ 可用于消除主导误差项，并且无论 $p$ 是否已知都有效；然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 在没有额外数据的情况下后验地计算 $p$。**\n\n这个陈述涉及 Richardson 外推。从两个近似值 $A_h$ 和 $A_{h/r}$ 获得一个量 $A$ 的更精确估计的通用 Richardson 外推公式是 $A_{\\text{extrap}} = \\frac{r^p A_{h/r} - A_h}{r^p - 1}$。这个公式可以消去阶为 $h^p$ 的主导误差项。\n该陈述将此应用于误差范数本身。我们来分析其主张：\n1.  “……无论 $p$ 是否已知都有效……”：这是错误的。该公式明确包含项 $2^p$（因为 $r=2$）。要计算外推值 $L_{\\text{extrap}}$，必须事先知道或估计收敛阶数 $p$。该公式从根本上依赖于 $p$。\n2.  “……然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 在没有额外数据的情况下后验地计算 $p$。”：这也是错误的。要计算收敛率（阶数 $p$），需要观察误差量如何随网格间距*缩放*。这至少需要在两个不同的网格间距下进行两次误差测量。$L(h/4)$ 是在间距 $h/4$ 下测得的误差。$L_{\\text{extrap}}(h/4)$ 是在相同有效间距 $h/4$ 下误差的*修正估计*，但其主导的 $\\mathcal{O}(h^p)$ 误差项已被移除。它是一个单一的数据点。无法从单个网格分辨率下的原始值和修正值来确定变化率。需要另一个外推值，例如 $L_{\\text{extrap}}(h/8)$，来估计*外推*解的收敛率。该陈述提出了一个逻辑上不可能的程序。\n\n**对 E 的判决：** 错误。\n\n**正确陈述总结**\n根据数值分析原理和对所提供数据的验证，陈述 A、B 和 D 是正确的。陈述 C 和 E 包含根本性错误。", "answer": "$$\\boxed{ABD}$$", "id": "3474345"}, {"introduction": "在这最后一个练习中，理论与实践将融为一体，你将为一个引力波传播模型实现一个完整的收敛性测试 [@problem_id:3474363]。你将编写代码，使用线方法求解波动方程，提取一个类似于 $\\Psi_4$ 的物理相关量，并测量你的模拟的收敛阶。这个总结性的实践将有限差分、时间积分和代码验证的概念整合到一个连贯的工作流程中。", "problem": "考虑一个远区引力辐射的一维线性代理模型，该模型是在一个具有无量纲单位的周期性域上的标量波动方程：设 $x \\in [0,1)$，波速 $c=1$，场 $u(x,t)$ 由以下方程控制：\n$$\n\\partial_t^2 u(x,t) = \\partial_x^2 u(x,t),\n$$\n边界条件为周期性边界条件。取对应于单个傅里叶模的初始数据，其中波数 $m \\in \\mathbb{Z}^+$为整数：\n$$\nu(x,0) = \\cos(2\\pi m x), \\quad \\partial_t u(x,0) = 0.\n$$\n此设置产生一个角频率为 $\\omega = 2\\pi m$ 的驻波解。在线性化引力中，Newman–Penrose标量 $\\Psi_4$ 与协变的二阶时间导数成正比。在此标量代理模型中，定义提取量为\n$$\n\\Psi_4(x,t) := \\partial_t^2 u(x,t).\n$$\n在给定的初始数据和边界条件下，$u(x,t)$ 存在解析解，从而也导出了 $\\Psi_4(x,t)$ 的解析表达式。\n\n您的任务是为 $\\Psi_4$ 实现一个三层网格收敛性测试。该测试在空间上使用二阶精度的有限差分，并采用线法（method-of-lines），时间积分器为经典的四阶龙格-库塔方法。同时，通过设置时间步长 $\\Delta t$ 为 $T/N_t$ 来强制执行 Courant–Friedrichs–Lewy (CFL) 时间步长约束，其中 $N_t = \\left\\lceil T / (\\text{CFL}\\,\\Delta x) \\right\\rceil$，$\\Delta x = 1/N$，$N$ 为网格点数，$T$ 为最终时间。使用具有周期性边界条件的离散二阶导数算子来近似 $\\partial_x^2 u$，并对以下时间上一阶的系统进行演化：\n$$\n\\partial_t u = v, \\quad \\partial_t v = \\partial_x^2 u.\n$$\n在最终时间 $t = T$ 时，将数值提取量近似为：\n$$\n\\Psi_4^{\\text{num}}(x,T) := \\partial_t v(x,T) \\approx \\partial_x^2 u(x,T),\n$$\n这里使用应用于数值演化得到的 $u(x,T)$ 的相同二阶中心有限差分算子。根据 $u(x,t)$ 的解析解构造解析提取量 $\\Psi_4^{\\text{exact}}(x,T)$，并计算误差的空间离散$\\ell^2$范数：\n$$\nE(N) := \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left( \\Psi_4^{\\text{num}}(x_j,T) - \\Psi_4^{\\text{exact}}(x_j,T) \\right)^2 \\right)^{1/2},\n$$\n其中网格点为 $x_j = j \\,\\Delta x$。对三个逐次加密的网格 $N, 2N, 4N$ 执行此操作，并通过误差比计算观测收敛阶：\n$$\np_{12} = \\log_2\\!\\left(\\frac{E(N)}{E(2N)}\\right), \\quad p_{23} = \\log_2\\!\\left(\\frac{E(2N)}{E(4N)}\\right),\n$$\n并报告平均值 $p = \\tfrac{1}{2}(p_{12}+p_{23})$ 作为实测阶。\n\n实现上述过程，并对以下每个测试用例（它们共同构成了测试套件）评估观测阶 $p$：\n- 测试1（理想情况）：$m = 1$，$T = 1.0$，$\\text{CFL} = 0.4$，基础网格尺寸 $N = 64$。\n- 测试2（更高波数）：$m = 3$，$T = 0.7$，$\\text{CFL} = 0.4$，基础网格尺寸 $N = 64$。\n- 测试3（振荡更剧烈且运行时间更短）：$m = 5$，$T = 0.3$，$\\text{CFL} = 0.4$，基础网格尺寸 $N = 64$。\n\n所有量均为无量纲。您的程序必须为每个测试用例计算三层观测阶 $p$（一个浮点数）。最终的程序输出应为单行，其中包含一个用方括号括起来的、逗号分隔的列表，列表内容是按上述测试顺序排列的三个实测阶。例如，格式必须严格为\n\"[p_test1,p_test2,p_test3]\"。", "solution": "我们旨在设计并实现一个针对与引力波提取相关的双曲方程的有原则的三层收敛性测试，仅使用基本定义和广泛接受的数值实践。其基础包括：使用线性波动方程作为远区引力辐射的代理模型，将Newman–Penrose标量 $\\Psi_4$ 定义为线性机制下类协变场的二阶时间导数，使用二阶中心有限差分计算空间导数，以及使用Courant–Friedrichs–Lewy条件指导显式时间积分的稳定性。\n\n1. 建模与解析解。在远区，线性化爱因斯坦方程简化为微扰的波传播。一个标量代理 $u(x,t)$ 满足一维波动方程\n$$\n\\partial_t^2 u = \\partial_x^2 u,\n$$\n该方程定义在周期性域上。选择初始数据 $u(x,0) = \\cos(2\\pi m x)$ 和 $\\partial_t u(x,0) = 0$ 会得到一个可分离解，该解在空间上保持模态形状，并带有一个余弦时间因子。具体而言，角频率为 $\\omega = 2\\pi m$，因此\n$$\nu(x,t) = \\cos(2\\pi m x) \\cos(\\omega t).\n$$\n此模型中的线性化提取量定义为\n$$\n\\Psi_4(x,t) := \\partial_t^2 u(x,t),\n$$\n因此，解析提取量为\n$$\n\\Psi_4^{\\text{exact}}(x,t) = \\partial_t^2 \\left[\\cos(2\\pi m x) \\cos(\\omega t)\\right] = -\\omega^2 \\cos(2\\pi m x) \\cos(\\omega t).\n$$\n\n2. 线法空间离散化。我们将波动方程重写为一阶系统，\n$$\n\\partial_t u = v, \\quad \\partial_t v = \\partial_x^2 u.\n$$\n在一个有 $N$ 个点、间距为 $\\Delta x = 1/N$ 的均匀网格上，使用周期性索引算术，我们定义作用于网格函数 $w_j \\approx w(x_j)$ 的标准二阶中心离散拉普拉斯算子 $D_{xx}$ 为\n$$\n(D_{xx} w)_j = \\frac{w_{j+1} - 2 w_j + w_{j-1}}{\\Delta x^2},\n$$\n其中索引对 $N$ 取模。该算子与 $\\partial_x^2$ 相容，其截断误差为 $\\mathcal{O}(\\Delta x^2)$ 阶。\n\n3. 时间推进。线法使用空间离散化的右端项来构成一个关于时间的常微分方程组。我们采用经典的四阶龙格-库塔积分器来将 $(u, v)$ 从 $t=0$ 演化到 $t=T$。对于双曲系统的显式格式，其稳定性由Courant–Friedrichs–Lewy条件决定；我们强制时间步长为 $\\Delta t = T/N_t$ 的形式，其中\n$$\nN_t = \\left\\lceil \\frac{T}{\\text{CFL} \\,\\Delta x} \\right\\rceil,\n$$\n使得 $\\Delta t \\le \\text{CFL}\\,\\Delta x$，满足一个保守的稳定性约束。尽管时间积分器是四阶的，但当 $\\Delta t$ 与 $\\Delta x$ 呈线性关系时，对于光滑解，总体的空间截断误差占主导地位，导致从 $u$ 构造出的空间依赖量的空间收敛阶为二阶。\n\n4. 数值提取与误差范数。在最终时间 $t=T$，我们根据系统方程的相容性来近似数值提取量：\n$$\n\\Psi_4^{\\text{num}}(x_j,T) \\approx \\partial_t v(x_j,T) = \\partial_x^2 u(x_j,T) \\approx (D_{xx} u)_j(T).\n$$\n我们计算离散空间$\\ell^2$误差范数\n$$\nE(N) = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[ \\Psi_4^{\\text{num}}(x_j,T) - \\Psi_4^{\\text{exact}}(x_j,T) \\right]^2 \\right)^{1/2}.\n$$\n\n5. 三层收敛性测量。对于应用于光滑解的相容二阶方法，误差满足渐近模型 $E(N) \\approx C \\,\\Delta x^p$，其中 $p \\approx 2$。使用具有 $N, 2N, 4N$ 个点的三个网格会产生误差 $E(N), E(2N), E(4N)$。通过逐次加密计算出的观测阶为\n$$\np_{12} = \\log_2\\!\\left(\\frac{E(N)}{E(2N)}\\right), \\quad p_{23} = \\log_2\\!\\left(\\frac{E(2N)}{E(4N)}\\right),\n$$\n我们报告平均值 $p = \\tfrac{1}{2}(p_{12}+p_{23})$ 以减少对前渐近效应的敏感性。\n\n6. 每个测试用例的算法步骤。\n- 固定 $m$、$T$ 和 Courant–Friedrichs–Lewy 参数。\n- 对于 $N \\in \\{N_0, 2N_0, 4N_0\\}$ 且 $N_0 = 64$，设置 $\\Delta x = 1/N$，初始化 $u_j(0) = \\cos(2\\pi m x_j)$ 和 $v_j(0) = 0$，并设置 $N_t = \\left\\lceil T / (\\text{CFL} \\,\\Delta x) \\right\\rceil$, $\\Delta t = T / N_t$。\n- 使用经典的四阶龙格-库塔方法和离散拉普拉斯算子将 $(u, v)$ 演化至 $t=T$。\n- 计算 $\\Psi_4^{\\text{num}} = D_{xx} u(T)$ 并评估 $\\Psi_4^{\\text{exact}}(x_j,T) = -\\omega^2 \\cos(2\\pi m x_j) \\cos(\\omega T)$，其中 $\\omega = 2\\pi m$。\n- 将 $E(N)$ 计算为离散$\\ell^2$范数，然后评估 $p_{12}$ 和 $p_{23}$ 及其平均值 $p$。\n- 对每个测试用例重复上述步骤。\n\n7. 预期行为。由于空间算子是二阶的，并且时间步长与 $\\Delta x$ 成正比，因此在整个测试套件中，$\\Psi_4^{\\text{num}}$ 的全局误差预期会以 $p \\approx 2$ 的阶数收敛，可能会因色散和有限时间积分效应而有微小偏差。更高波数的测试对分辨率要求更高，如果最粗的网格未完全进入渐近区域，可能会略微降低观测到的阶数，但平均阶数应保持接近于2。\n\n该程序实现了上述过程，并以要求的格式单行输出测试套件的三个观测阶。", "answer": "```python\nimport numpy as np\n\ndef laplacian_periodic(u, dx):\n    # Second-order centered finite-difference Laplacian with periodic BC\n    return (np.roll(u, -1) - 2.0 * u + np.roll(u, 1)) / (dx * dx)\n\ndef rk4_step(u, v, dt, dx):\n    # Right-hand sides: du/dt = v, dv/dt = lap(u)\n    # Stage 1\n    k1_u = v\n    k1_v = laplacian_periodic(u, dx)\n    # Stage 2\n    u2 = u + 0.5 * dt * k1_u\n    v2 = v + 0.5 * dt * k1_v\n    k2_u = v2\n    k2_v = laplacian_periodic(u2, dx)\n    # Stage 3\n    u3 = u + 0.5 * dt * k2_u\n    v3 = v + 0.5 * dt * k2_v\n    k3_u = v3\n    k3_v = laplacian_periodic(u3, dx)\n    # Stage 4\n    u4 = u + dt * k3_u\n    v4 = v + dt * k3_v\n    k4_u = v4\n    k4_v = laplacian_periodic(u4, dx)\n    # Combine\n    u_next = u + (dt / 6.0) * (k1_u + 2.0 * k2_u + 2.0 * k3_u + k4_u)\n    v_next = v + (dt / 6.0) * (k1_v + 2.0 * k2_v + 2.0 * k3_v + k4_v)\n    return u_next, v_next\n\ndef evolve_and_error(m, T, CFL, N):\n    # Domain [0,1), periodic, nondimensional units, c=1\n    L = 1.0\n    dx = L / N\n    x = np.linspace(0.0, L, N, endpoint=False)\n    # Initial conditions\n    k = 2.0 * np.pi * m\n    omega = k  # c=1\n    u = np.cos(k * x)\n    v = np.zeros_like(u)\n    # Time step via conservative CFL choice\n    Nt = int(np.ceil(T / (CFL * dx)))\n    dt = T / Nt\n    # Time integration to t = T\n    for _ in range(Nt):\n        u, v = rk4_step(u, v, dt, dx)\n    # Numerical Psi4 via dv/dt = lap(u) at final time\n    psi4_num = laplacian_periodic(u, dx)\n    # Analytic Psi4 at final time\n    u_exact_final = np.cos(k * x) * np.cos(omega * T)\n    psi4_exact = - (omega ** 2) * u_exact_final\n    # Discrete L2 error\n    err = psi4_num - psi4_exact\n    E = np.sqrt(np.mean(err * err))\n    return E\n\ndef observed_order(m, T, CFL, N0):\n    # Three-level errors\n    E1 = evolve_and_error(m, T, CFL, N0)\n    E2 = evolve_and_error(m, T, CFL, 2 * N0)\n    E3 = evolve_and_error(m, T, CFL, 4 * N0)\n    # Compute observed orders\n    # Guard against division by zero if errors are too small (should not happen here)\n    p12 = np.log2(E1 / E2) if E2 > 0 and E1 > 0 else float('nan')\n    p23 = np.log2(E2 / E3) if E3 > 0 and E2 > 0 else float('nan')\n    p_avg = 0.5 * (p12 + p23)\n    return p_avg\n\ndef solve():\n    # Define the test cases from the problem statement: (m, T, CFL, N0)\n    test_cases = [\n        (1, 1.0, 0.4, 64),  # Test 1\n        (3, 0.7, 0.4, 64),  # Test 2\n        (5, 0.3, 0.4, 64),  # Test 3\n    ]\n    results = []\n    for m, T, CFL, N0 in test_cases:\n        p = observed_order(m, T, CFL, N0)\n        results.append(p)\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3474363"}]}