{"hands_on_practices": [{"introduction": "掌握数值相对论的第一项基本技能是从给定的四维时空度规中执行 $3+1$分解。这个练习提供了一个具体的例子——旋转柱坐标系下的闵可夫斯基时空——并要求你从第一性原理出发，利用几何定义推导出切变函数 $\\alpha$、移动矢量 $\\beta^i$ 和空间度规 $\\gamma_{ij}$。通过这个实践，你将熟练掌握进行分解所需的基础计算方法。[@problem_id:3492634]", "problem": "考虑广义相对论中 Arnowitt–Deser–Misner (ADM) 形式论下的 $(3+1)$ 分解，对于一个时空，其坐标 $(t,r,\\phi,z)$ 与常数 $t$ 超曲面构成的叶状结构相适应。设该时空度规为平直闵可夫斯基度规，以角速度 $\\Omega$ 匀速旋转的柱坐标表示，该坐标系通过变换 $\\phi'=\\phi+\\Omega t$ 从惯性柱坐标 $(t,r,\\phi',z)$ 得到。在这些坐标系中，线元为\n$$\nds^{2} = -\\left(1 - \\Omega^{2} r^{2}\\right)\\, dt^{2} + 2\\,\\Omega r^{2}\\, dt\\, d\\phi + dr^{2} + r^{2} d\\phi^{2} + dz^{2},\n$$\n其中 $r \\ge 0$，$z \\in \\mathbb{R}$，且 $\\phi \\in [0,2\\pi)$，并假设 $r\\,\\Omega  1$ 使得坐标时间 $t$ 是类时的。令 $t^{\\mu}$ 表示坐标时间基矢量场 $t^{\\mu} = (\\partial/\\partial t)^{\\mu}$。\n\n从第一性原理出发，即：$t=\\text{const}$ 超曲面的单位法向量 $n^{\\mu}$ 的定义，其通过 $n_{\\mu} \\propto \\nabla_{\\mu} t$ 并由 $g^{\\mu\\nu} n_{\\mu} n_{\\nu} = -1$ 归一化；拉回到超曲面的诱导空间度规 $\\gamma_{\\mu\\nu} = g_{\\mu\\nu} + n_{\\mu} n_{\\nu}$；以及运动学分解 $t^{\\mu} = \\alpha n^{\\mu} + \\beta^{\\mu}$，其中 $\\beta^{\\mu}$ 与超曲面相切 ($n_{\\mu}\\beta^{\\mu}=0$)，计算在给定的旋转坐标系中，$t=\\text{const}$ 切片上的诱导空间度规分量 $\\gamma_{ij}$、切变函数 $\\alpha$ 和移动矢量分量 $\\beta^{i}$。\n\n将你的最终结果按以下顺序以行矩阵的形式报告\n$$\n\\left(\\alpha,\\ \\beta^{r},\\ \\beta^{\\phi},\\ \\beta^{z},\\ \\gamma_{rr},\\ \\gamma_{r\\phi},\\ \\gamma_{rz},\\ \\gamma_{\\phi\\phi},\\ \\gamma_{\\phi z},\\ \\gamma_{zz}\\right).\n$$\n根据需要，用 $r$ 和 $\\Omega$ 表示你的答案。不需要四舍五入。在最终报告的矩阵中不要包含单位。", "solution": "该问题要求使用 Arnowitt–Deser–Misner (ADM) 形式论，为一个给定的时空度规计算切变函数 $\\alpha$、移动矢量分量 $\\beta^i$ 和诱导空间度规分量 $\\gamma_{ij}$。该时空是在匀速旋转柱坐标中描述的平直闵可夫斯基空间。\n\n线元由下式给出：\n$$ds^{2} = -\\left(1 - \\Omega^{2} r^{2}\\right)\\, dt^{2} + 2\\,\\Omega r^{2}\\, dt\\, d\\phi + dr^{2} + r^{2} d\\phi^{2} + dz^{2}$$\n坐标为 $(x^0, x^1, x^2, x^3) = (t, r, \\phi, z)$。协变度规张量 $g_{\\mu\\nu}$ 的分量可以直接从线元中读出。注意 $dt d\\phi$ 的系数是 $2 g_{t\\phi}$。\n$$\ng_{\\mu\\nu} = \\begin{pmatrix}\ng_{tt}  g_{tr}  g_{t\\phi}  g_{tz} \\\\\ng_{rt}  g_{rr}  g_{r\\phi}  g_{rz} \\\\\ng_{\\phi t}  g_{\\phi r}  g_{\\phi\\phi}  g_{\\phi z} \\\\\ng_{zt}  g_{zr}  g_{z\\phi}  g_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\n-(1-\\Omega^2 r^2)  0  \\Omega r^2  0 \\\\\n0  1  0  0 \\\\\n\\Omega r^2  0  r^2  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n问题定义在常数时间 $t$ 的超曲面上。坐标时间基矢量为 $t^\\mu = (\\partial/\\partial t)^\\mu$，所以其分量为 $t^\\mu = (1, 0, 0, 0)$。ADM 形式论的基本量是通过此矢量场相对于叶状结构几何的分解导出的。\n\n首先，我们通过求 $g_{\\mu\\nu}$ 的逆来计算逆变度规张量 $g^{\\mu\\nu}$。度规是块对角的，在 $(t, \\phi)$ 分块中有一个非平凡的 $2 \\times 2$ 块。子矩阵\n$$\n\\begin{pmatrix} g_{tt}  g_{t\\phi} \\\\ g_{\\phi t}  g_{\\phi\\phi} \\end{pmatrix} = \\begin{pmatrix} -(1-\\Omega^2 r^2)  \\Omega r^2 \\\\ \\Omega r^2  r^2 \\end{pmatrix}\n$$\n的行列式为 $\\det = -(1-\\Omega^2 r^2)(r^2) - (\\Omega r^2)^2 = -r^2 + \\Omega^2 r^4 - \\Omega^2 r^4 = -r^2$。\n逆子矩阵为：\n$$\n\\begin{pmatrix} g^{tt}  g^{t\\phi} \\\\ g^{\\phi t}  g^{\\phi\\phi} \\end{pmatrix} = \\frac{1}{-r^2} \\begin{pmatrix} r^2  -\\Omega r^2 \\\\ -\\Omega r^2  -(1-\\Omega^2 r^2) \\end{pmatrix} = \\begin{pmatrix} -1  \\Omega \\\\ \\Omega  \\frac{1-\\Omega^2 r^2}{r^2} \\end{pmatrix}\n$$\n剩下的分量 $g^{rr}$ 和 $g^{zz}$ 就是 $g_{rr}=1$ 和 $g_{zz}=1$ 的逆。因此，完整的逆度规是：\n$$\ng^{\\mu\\nu} = \\begin{pmatrix}\n-1  0  \\Omega  0 \\\\\n0  1  0  0 \\\\\n\\Omega  0  \\frac{1}{r^2} - \\Omega^2  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n常数 $t$ 超曲面的单位法矢量 $n^\\mu$ 定义为与标量场 $t$ 的梯度成正比，$n^\\mu \\propto \\nabla^\\mu t = g^{\\mu\\nu}\\nabla_\\nu t$。因为 $\\nabla_\\nu t = \\delta_\\nu^t = (1, 0, 0, 0)$，我们有 $\\nabla^\\mu t = g^{\\mu\\nu}\\delta_\\nu^t = g^{\\mu t}$。所以，$\\nabla^\\mu t = (g^{tt}, g^{tr}, g^{t\\phi}, g^{tz}) = (-1, 0, \\Omega, 0)$。\n这个矢量的范数是 $g_{\\mu\\nu}(\\nabla^{\\mu}t)(\\nabla^{\\nu}t) = g_{\\mu\\nu}g^{\\mu\\alpha}\\delta_\\alpha^t g^{\\nu\\beta}\\delta_\\beta^t = g_{\\alpha\\beta}g^{\\alpha t}g^{\\beta t} = g_{\\beta t}g^{\\beta t} = g_{tt}g^{tt} + g_{\\phi t}g^{\\phi t} = g_{tt}g^{tt} + g_{t\\phi}g^{\\phi t}$。让我们使用分量：$g_{\\mu\\nu}(\\nabla^{\\mu}t)(\\nabla^{\\nu}t) = g^{\\alpha\\beta}\\nabla_\\alpha t \\nabla_\\beta t = g^{tt} = -1$。\n所以 $\\nabla^\\mu t$ 已经归一化。一个指向未来的法矢量 $n^\\mu$ 必须满足 $n_\\mu t^\\mu  0$。矢量 $\\nabla^\\mu t$ 的协变分量为 $\\nabla_\\mu t = (1, 0, 0, 0)$，且 $(\\nabla^\\mu t) \\cdot t^\\mu = g_{\\mu\\nu}(\\nabla^\\mu t) t^\\nu = \\nabla_\\nu t^\\nu = 1  0$。因此，$\\nabla^\\mu t$ 是指向过去的。我们选择指向未来的法矢量为 $n^\\mu = -g^{\\mu t}$。\n$$n^\\mu = -(-1, 0, \\Omega, 0) = (1, 0, -\\Omega, 0)$$\n协变分量为 $n_\\mu = g_{\\mu\\nu}n^\\nu$：\n$n_t = g_{tt}n^t + g_{t\\phi}n^\\phi = -(1-\\Omega^2 r^2)(1) + (\\Omega r^2)(-\\Omega) = -1 + \\Omega^2 r^2 - \\Omega^2 r^2 = -1$。\n$n_r = g_{rr}n^r = (1)(0) = 0$。\n$n_\\phi = g_{\\phi t}n^t + g_{\\phi\\phi}n^\\phi = (\\Omega r^2)(1) + (r^2)(-\\Omega) = \\Omega r^2 - \\Omega r^2 = 0$。\n$n_z = g_{zz}n^z = (1)(0) = 0$。\n所以，协变法矢量为 $n_\\mu = (-1, 0, 0, 0)$。\n\n切变函数 $\\alpha$ 由关系式 $n_\\mu t^\\mu = -\\alpha$ 定义。\n$$-\\alpha = n_t t^t + n_r t^r + n_\\phi t^\\phi + n_z t^z = (-1)(1) + (0)(0) + (0)(0) + (0)(0) = -1$$\n因此，切变函数为 $\\alpha=1$。\n\n移动矢量场 $\\beta^\\mu$ 由时间演化矢量的分解定义：$t^\\mu = \\alpha n^\\mu + \\beta^\\mu$。\n移动矢量是纯空间的，意味着它与超曲面相切，$n_\\mu\\beta^\\mu=0$，这表示 $\\beta^t=0$。\n从该分解中，我们解出 $\\beta^\\mu$：\n$$\\beta^\\mu = t^\\mu - \\alpha n^\\mu = (1, 0, 0, 0) - (1) \\cdot (1, 0, -\\Omega, 0) = (0, 0, \\Omega, 0)$$\n移动矢量 $\\beta^i$ 的分量是 $\\beta^\\mu$ 的空间分量：\n$$\\beta^r = 0, \\quad \\beta^\\phi = \\Omega, \\quad \\beta^z = 0$$\n\n超曲面上的诱导空间度规由 $\\gamma_{\\mu\\nu} = g_{\\mu\\nu} + n_\\mu n_\\nu$ 给出。分量 $\\gamma_{ij}$ 是该张量的空间分量。对于 $i,j \\in \\{r, \\phi, z\\}$，我们有：\n$$\\gamma_{ij} = g_{ij} + n_i n_j$$\n因为我们已经求得 $n_\\mu = (-1, 0, 0, 0)$，空间分量 $n_i$ 全为零 ($n_r=0, n_\\phi=0, n_z=0$)。\n因此，诱导度规分量与四维时空度规张量的空间分量相同：\n$$\\gamma_{ij} = g_{ij}$$\n从 $g_{\\mu\\nu}$ 的矩阵中，我们读出这些分量：\n$$\n\\gamma_{ij} = \\begin{pmatrix}\n\\gamma_{rr}  \\gamma_{r\\phi}  \\gamma_{rz} \\\\\n\\gamma_{\\phi r}  \\gamma_{\\phi\\phi}  \\gamma_{\\phi z} \\\\\n\\gamma_{zr}  \\gamma_{z\\phi}  \\gamma_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\ng_{rr}  g_{r\\phi}  g_{rz} \\\\\ng_{\\phi r}  g_{\\phi\\phi}  g_{\\phi z} \\\\\ng_{zr}  g_{z\\phi}  g_{zz}\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0 \\\\\n0  r^2  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n各个分量为：\n$\\gamma_{rr} = 1$\n$\\gamma_{r\\phi} = 0$\n$\\gamma_{rz} = 0$\n$\\gamma_{\\phi\\phi} = r^2$\n$\\gamma_{\\phi z} = 0$\n$\\gamma_{zz} = 1$\n\n将这些结果按指定顺序 $(\\alpha, \\beta^{r}, \\beta^{\\phi}, \\beta^{z}, \\gamma_{rr}, \\gamma_{r\\phi}, \\gamma_{rz}, \\gamma_{\\phi\\phi}, \\gamma_{\\phi z}, \\gamma_{zz})$ 组合起来，得到最终答案。\n$$\n\\left(1,\\ 0,\\ \\Omega,\\ 0,\\ 1,\\ 0,\\ 0,\\ r^{2},\\ 0,\\ 1\\right)\n$$", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  0  \\Omega  0  1  0  0  r^2  0  1 \\end{pmatrix} } $$", "id": "3492634"}, {"introduction": "在学会如何提取 ADM 变量之后，一个关键的概念性问题随之而来：这些量是唯一的吗？本练习通过求解“逆问题”，然后施加一个微小的坐标变换（微分同胚）来探讨此问题。通过比较变换前后的切变函数和移动矢量，你将直接观察到它们的规范依赖性，这是 $3+1$ 形式主义的基石。[@problem_id:3492610]", "problem": "给定一个适应于$3+1$分解的坐标卡中单个事件点的时空度规$g_{\\mu\\nu}$。$3+1$分解引入了切变函数$\\alpha$、移动矢量$\\beta^i$和空间度规$\\gamma_{ij}$，它们通过以下关系与线元相关联：\n$$\nds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} \\left(dx^i + \\beta^i dt\\right)\\left(dx^j + \\beta^j dt\\right).\n$$\n逆问题要求：给定$g_{\\mu\\nu}$，重构$\\alpha$和$\\beta^i$。然后，分析一个微小微分同胚（一种坐标变换）对重构出的$\\alpha$和$\\beta^i$的影响，并讨论由此产生的非唯一性。\n\n基本依据与假设：\n- 在几何化单位制中进行计算，其中$c = G = 1$（无量纲单位）。\n- 假设度规符号差为$(-,+,+,+)$，且分解在该事件点是良定义的（即，度规的空间块是正定的，并且$g_{00}  0$）。\n- 考虑一个由$t' = t + \\epsilon(\\vec{x})$和$x'^i = x^i$定义的微小微分同胚，其中$\\epsilon$是微小且光滑的，并使用空间梯度$\\partial_i \\epsilon$来评估其在该事件点的效应。\n\n任务：\n- 对于下面列出的每个测试用例度规$g_{\\mu\\nu}$，在该事件点重构$\\alpha$和$\\beta^i$。\n- 应用微小微分同胚到$\\epsilon$的一阶，以获得该事件点变换后的度规分量$g'_{\\mu\\nu}$，仅使用$\\partial_i \\epsilon$并忽略$\\left(\\partial \\epsilon\\right)^2$及更高阶的项。\n- 从变换后的度规$g'_{\\mu\\nu}$重构$\\alpha'$和$\\beta'^i$。\n- 通过报告$\\alpha'$和$\\beta'^i$与$\\alpha$和$\\beta^i$的差异是否超出数值容差来分析非唯一性，从而证明在微小微分同胚下的规范自由度。\n- 通过检查$\\det(g') \\approx \\det(g)$是否在指定的容差范围内成立，来验证度规的行列式在微小微分同胚下在一阶近似中保持不变。\n\n数值容差：\n- 行列式不变性容差：如果$\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$，则认为行列式是不变的。\n- 非唯一性容差：如果$\\left|\\alpha' - \\alpha\\right|  10^{-12}$或$\\|\\beta' - \\beta\\|_2  10^{-12}$，则认为切变函数/移动矢量在微分同胚下发生了改变。\n\n测试套件（所有值均采用几何化单位）：\n- 测试用例1（标准坐标下的 Minkowski 时空）：\n  - $g_{00} = -1$, $g_{0i} = 0$ for $i \\in \\{1,2,3\\}$, $g_{ij} = \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[1\\times 10^{-3}, -2\\times 10^{-3}, 1.5\\times 10^{-3}\\right]$。\n- 测试用例2（具有均匀移动的 Minkowski 时空）：\n  - 移动$\\beta^i = \\left[0.3, -0.2, 0.1\\right]$，切变$\\alpha = 1$，空间度规$\\gamma_{ij} = \\delta_{ij}$。\n  - 根据这些，构建$g_{00} = -1 + \\beta^i \\beta^j \\delta_{ij}$，$g_{0i} = \\delta_{ij} \\beta^j$，$g_{ij} = \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[2\\times 10^{-3}, 0, -1\\times 10^{-3}\\right]$。\n- 测试用例3（横向无迹规范下的线性化引力波，正号偏振）：\n  - 事件点的振幅$h = 1\\times 10^{-2}$，其相位经选择以使$h$为所述值。\n  - $g_{00} = -1$, $g_{0i} = 0$, $g_{ij} = \\mathrm{diag}\\left(1 + h, 1 - h, 1\\right)$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[1\\times 10^{-3}, 1\\times 10^{-3}, 0\\right]$。\n- 测试用例4（各向同性坐标中半径$r = 10 M$处的 Schwarzschild 时空，其中$M=1$）：\n  - 定义 $\\phi = 1 + \\frac{M}{2r} = 1 + \\frac{1}{20} = 1.05$。\n  - $g_{00} = -\\left(\\frac{1 - \\frac{M}{2r}}{1 + \\frac{M}{2r}}\\right)^2 = -\\left(\\frac{0.95}{1.05}\\right)^2$, $g_{0i} = 0$, $g_{ij} = \\phi^4 \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[5\\times 10^{-4}, -5\\times 10^{-4}, 2.5\\times 10^{-4}\\right]$。\n- 测试用例5（边界情况：具有均匀移动但没有微分同胚的 Minkowski 时空）：\n  - 与测试用例2具有相同的$g_{\\mu\\nu}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[0, 0, 0\\right]$。\n\n输出规范：\n- 对于每个测试用例，你的程序必须计算并返回以下四项：\n  - 从$g_{\\mu\\nu}$重构的$\\alpha$，四舍五入到六位小数。\n  - 从$g'_{\\mu\\nu}$重构的$\\alpha'$，四舍五入到六位小数。\n  - 一个表示行列式不变性的布尔值：如果$\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$则为$True$，否则为$False$。\n  - 一个表示非唯一性的布尔值：如果$\\left|\\alpha' - \\alpha\\right|  10^{-12}$或$\\|\\beta' - \\beta\\|_2  10^{-12}$则为$True$，否则为$False$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$），该列表由测试用例1的四项、接着测试用例2的四项、依此类推直到测试用例5的各项串联而成。", "solution": "该问题是良定的，科学上基于广义相对论及其$3+1$ (ADM) 分解的原理，并为严谨求解提供了一套完整的数据和定义。任务是从给定的时空度规$g_{\\mu\\nu}$重构切变函数$\\alpha$和移动矢量$\\beta^i$，然后分析这些量在特定的微小坐标变换（微分同胚）下如何变化。这可以作为对时空描述中所固有的规范自由度的一个演示。该问题是有效的。\n\n针对每个测试用例，求解过程分三个主要阶段进行：\n1.  从给定的度规$g_{\\mu\\nu}$重构初始的切变函数和移动矢量$(\\alpha, \\beta^i)$。\n2.  在指定的微小微分同胚下计算变换后的度规$g'_{\\mu\\nu}$。\n3.  从$g'_{\\mu\\nu}$重构变换后的切变函数和移动矢量$(\\alpha', \\beta'^i)$，并与初始值进行比较。\n\n**1. 从度规重构切变函数和移动矢量**\n\n在$3+1$分解中，线元由下式给出：\n$$\nds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i + \\beta^i dt)(dx^j + \\beta^j dt)\n$$\n展开右侧并与$g_{\\mu\\nu}dx^\\mu dx^\\nu$的系数进行匹配，可以得到用 ADM 变量$(\\alpha, \\beta^i, \\gamma_{ij})$表示的时空度规分量：\n$$\ng_{00} = -\\alpha^2 + \\beta_k \\beta^k \\quad , \\quad g_{0i} = \\beta_i \\quad , \\quad g_{ij} = \\gamma_{ij}\n$$\n其中 $\\beta_i = \\gamma_{ij}\\beta^j$。\n\n为了执行逆操作——从$g_{\\mu\\nu}$重构$(\\alpha, \\beta^i, \\gamma_{ij})$——我们可以使用逆度规$g^{\\mu\\nu}$的分量。空间超曲面$t=\\text{const}$的法矢量为$n_\\mu = (-\\alpha, 0, 0, 0)$，其逆变形式为$n^\\mu = g^{\\mu\\nu} n_\\nu = (-\\alpha g^{\\mu 0})$。归一化条件$n_\\mu n^\\mu = -1$给出$(-\\alpha)(-\\alpha g^{00}) = -1$，从而得到$g^{00} = -1/\\alpha^2$。由此，我们可以直接求出切变函数：\n$$\n\\alpha = \\frac{1}{\\sqrt{-g^{00}}}\n$$\n逆变法矢量的分量也由$n^\\mu = (1/\\alpha, -\\beta^i/\\alpha)$给出。将其与$n^\\mu = (-\\alpha g^{\\mu 0})$进行比较，对于空间分量$(\\mu=i)$，我们发现：\n$$\n-\\frac{\\beta^i}{\\alpha} = -\\alpha g^{i0} \\implies \\beta^i = \\alpha^2 g^{i0}\n$$\n代入$\\alpha^2$的表达式，我们得到移动矢量：\n$$\n\\beta^i = \\frac{-1}{g^{00}} g^{0i}\n$$\n因此，重构算法如下：\n1.  给定$g_{\\mu\\nu}$，计算其逆$g^{\\mu\\nu}$。\n2.  提取$g^{00}$和$g^{0i}$。\n3.  使用上述公式计算$\\alpha$和$\\beta^i$。\n\n**2. 微小微分同胚下的度规变换**\n\n问题指定了一个微小微分同胚，它对应于时间坐标的平移：\n$$\nt' = t + \\epsilon(\\vec{x}) \\quad, \\quad x'^i = x^i\n$$\n度规张量根据(0,2)阶张量的变换规则进行变换。我们可以通过强制线元的不变性，$ds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = g'_{\\alpha\\beta}dx'^\\alpha dx'^\\beta$，来找到变换后的分量$g'_{\\mu\\nu}$。对变换方程取微分：\n$$\ndt' = dt + \\partial_i \\epsilon\\, dx^i \\quad, \\quad dx'^i = dx^i\n$$\n我们将用$dx'^\\alpha$表示的$dx^\\mu$代入原始线元表达式中，并识别出新的度规分量。然而，一个更直接的方法是用$dx^\\mu$表示$dx'^\\alpha$，并将得到的二次型与$g_{\\mu\\nu}dx^\\mu dx^\\nu$进行比较。在小量$\\partial_i \\epsilon$的一阶近似下，这给出了事件点度规分量的以下变换规则：\n$$\ng'_{00} = g_{00}\n$$\n$$\ng'_{0i} = g_{0i} - g_{00} \\partial_i \\epsilon\n$$\n$$\ng'_{ij} = g_{ij} - (g_{0i} \\partial_j \\epsilon + g_{0j} \\partial_i \\epsilon)\n$$\n这些关系等价于由关于矢量场$\\xi^\\mu = (\\epsilon, 0, 0, 0)$的李导数给出的一阶度规变化，即$\\delta g_{\\mu\\nu} = \\mathcal{L}_\\xi g_{\\mu\\nu}$，它在一个$\\epsilon=0$但其梯度非零的点进行求值。\n\n**3. 非唯一性与行列式不变性分析**\n\n在使用上述规则计算出变换后的度规$g'_{\\mu\\nu}$后，我们应用第1节中描述的相同重构算法来找到新的切变函数$\\alpha'$和移动矢量$\\beta'^i$。\n\n非唯一性通过比较变换前后的重构值来确定。如果切变函数或移动矢量的变化超过了指定的数值容差，就表明$3+1$分解不是唯一的，而是依赖于坐标系的选择（它是“规范依赖的”）。\n$$\n\\text{若 } |\\alpha' - \\alpha|  10^{-12} \\text{ 或 } \\|\\beta' - \\beta\\|_2  10^{-12} \\text{ 则非唯一}\n$$\n\n度规的行列式按照$\\det(g') = (\\det(J))^{-2} \\det(g)$进行变换，其中$J$是坐标变换的雅可比矩阵。对于给定的变换，雅可比行列式为$\\det(\\partial x'^\\alpha / \\partial x^\\beta) = 1$。这意味着$\\det(g') = \\det(g)$应该精确成立。由于我们对度规分量的变换使用了一阶近似，我们通过检查行列式的绝对差是否在一个小的容差范围内来计算验证此性质。\n$$\n\\text{若 } |\\det(g') - \\det(g)| \\leq 10^{-12} \\text{ 则行列式不变}\n$$\n\n该实现将对每个测试用例应用这个三阶段过程。\n对于测试用例2和5，其初始度规通过ADM变量定义，我们首先使用$g_{00} = -\\alpha^2 + \\gamma_{ij}\\beta^i\\beta^j$，$g_{0i} = \\gamma_{ij}\\beta^j$和$g_{ij} = \\gamma_{ij}$来构建度规$g_{\\mu\\nu}$。\n整个过程将在提供的 Python 代码中自动化实现。", "answer": "```python\nimport numpy as np\n\ndef construct_g_from_adm(alpha, beta_vec, gamma_mat):\n    \"\"\"Constructs the 4D metric g_munu from ADM variables.\"\"\"\n    g = np.zeros((4, 4))\n    beta_vec = np.array(beta_vec)\n    gamma_mat = np.array(gamma_mat)\n    \n    beta_down = gamma_mat @ beta_vec\n    beta_sq = beta_vec @ beta_down\n    \n    g[0, 0] = -alpha**2 + beta_sq\n    g[0, 1:] = beta_down\n    g[1:, 0] = beta_down\n    g[1:, 1:] = gamma_mat\n    \n    return g\n\ndef reconstruct_adm(g):\n    \"\"\"Reconstructs alpha and beta from the 4D metric g_munu.\"\"\"\n    try:\n        g_inv = np.linalg.inv(g)\n    except np.linalg.LinAlgError:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    g00_inv = g_inv[0, 0]\n    g0i_inv = g_inv[0, 1:]\n    \n    if g00_inv >= 0:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    alpha = (-g00_inv)**(-0.5)\n    beta = -g0i_inv / g00_inv\n    \n    return alpha, beta\n\ndef transform_metric(g, grad_eps):\n    \"\"\"Applies the small diffeomorphism to the metric g_munu.\"\"\"\n    g_prime = np.zeros((4, 4))\n    grad_eps = np.array(grad_eps)\n    \n    g00 = g[0, 0]\n    g0i = g[0, 1:]\n    gij = g[1:, 1:]\n    \n    # g'_00 = g_00\n    g_prime[0, 0] = g00\n    \n    # g'_0i = g_0i - g_00 * grad_eps\n    gp_0i = g0i - g00 * grad_eps\n    g_prime[0, 1:] = gp_0i\n    g_prime[1:, 0] = gp_0i\n    \n    # g'_ij = g_ij - (g_0i * grad_eps_j + g_0j * grad_eps_i)\n    gp_ij = gij - (np.outer(g0i, grad_eps) + np.outer(grad_eps, g0i))\n    g_prime[1:, 1:] = gp_ij\n    \n    return g_prime\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print results.\n    \"\"\"\n    \n    # Define test cases\n    test_cases = [\n        # Case 1: Minkowski\n        {\n            \"g_mu_nu\": np.array([[-1., 0., 0., 0.],\n                                 [0., 1., 0., 0.],\n                                 [0., 0., 1., 0.],\n                                 [0., 0., 0., 1.]]),\n            \"grad_eps\": [1e-3, -2e-3, 1.5e-3]\n        },\n        # Case 2: Minkowski with shift\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [2e-3, 0., -1e-3]\n        },\n        # Case 3: Linearized GW\n        {\n            \"g_mu_nu\": np.array([[-1.0, 0., 0., 0.],\n                                 [0., 1.01, 0., 0.],\n                                 [0., 0., 0.99, 0.],\n                                 [0., 0., 0., 1.0]]),\n            \"grad_eps\": [1e-3, 1e-3, 0.]\n        },\n        # Case 4: Schwarzschild in isotropic coordinates\n        {\n            \"g_mu_nu\": {\n                'g00': -((1 - 1./20.) / (1 + 1./20.))**2,\n                 'gij_diag': (1 + 1./20.)**4\n            },\n            \"grad_eps\": [5e-4, -5e-4, 2.5e-4]\n        },\n        # Case 5: Edge case (Minkowski with shift, no diffeomorphism)\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [0., 0., 0.]\n        }\n    ]\n    \n    # Special handling for case 4 construction\n    g_case4_data = test_cases[3][\"g_mu_nu\"]\n    g_case4 = np.diag([g_case4_data['g00'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag']])\n    test_cases[3][\"g_mu_nu\"] = g_case4\n\n    # Tolerances\n    det_tol = 1e-12\n    non_unique_tol = 1e-12\n    \n    results = []\n    \n    for case in test_cases:\n        g = case[\"g_mu_nu\"]\n        grad_eps = case[\"grad_eps\"]\n        \n        # 1. Reconstruct initial alpha, beta\n        alpha, beta = reconstruct_adm(g)\n        \n        # 2. Transform the metric\n        g_prime = transform_metric(g, grad_eps)\n        \n        # 3. Reconstruct transformed alpha', beta'\n        alpha_prime, beta_prime = reconstruct_adm(g_prime)\n        \n        # 4. Analyze non-uniqueness and determinant invariance\n        det_g = np.linalg.det(g)\n        det_g_prime = np.linalg.det(g_prime)\n        \n        det_invariant = abs(det_g_prime - det_g) = det_tol\n        \n        alpha_diff = abs(alpha_prime - alpha)\n        beta_diff_norm = np.linalg.norm(beta_prime - beta)\n        non_unique = (alpha_diff > non_unique_tol) or (beta_diff_norm > non_unique_tol)\n        \n        # Append results for this case\n        results.extend([\n            f\"{alpha:.6f}\",\n            f\"{alpha_prime:.6f}\",\n            str(det_invariant),\n            str(non_unique)\n        ])\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3492610"}, {"introduction": "理解了切变函数和移动矢量是规范选择之后，我们面临最核心的实践问题：应该如何选择它们？本练习通过一个模型来探讨不同的规范条件如何影响约束违背的增长，从而深入数值相对论的核心。通过分析一个简化的误差演化方程，你将深刻理解为何诸如“$1+\\log$”切片等动态规范条件对于像黑洞并合这类现象的长期稳定模拟至关重要。[@problem_id:3492624]", "problem": "要求您在 ADM $3+1$ 分解的框架下，对一维非线性规范波测试中的约束违背增长进行建模和量化，重点关注切变函数 $\\alpha$ 和移动矢量 $\\beta^{i}$ 的选择如何影响这种增长。哈密顿约束 $\\mathcal{H}$ 和动量约束 $\\mathcal{M}_{i}$ 应在 Arnowitt-Deser-Misner (ADM) 形式体系以及诸如 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 和协变共形 Z4 (CCZ4) 等广泛使用的公式化体系的背景下进行理解。您必须从第一性原理和标准的、广为接受的事实出发。不要假设或使用任何可以简化推导过程的目标公式。\n\n假设：\n- 考虑一个一维周期性区域 $x \\in [0,L)$，其中 $L$ 为常数。背景时空是一个非线性规范波，即一个非平凡坐标规范下的闵可夫斯基时空，因此在连续统中，爱因斯坦约束得到精确满足。\n- 关注由离散化和不良规范控制引起的小的约束违背。围绕精确背景对约束传播进行线性化。对于哈密顿约束 $\\mathcal{H}$ 或动量约束的分量 $\\mathcal{M}_{x}$，将小的约束违背 $c(x,t)$ 的主导阶演化近似为一个常系数线性平流-扩散-反应偏微分方程 (PDE)：\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c,\n$$\n其中 $v$ 是从移动矢量 $\\beta^{x}$ 继承的有效平流速度，$\\nu \\ge 0$ 是一个有效扩散系数，捕捉了约束阻尼和数值耗散，而 $\\sigma$ 是一个有效反应率，它聚合了由切变函数 $\\alpha$ 和移动矢量 $\\beta^{i}$ 的规范选择以及依赖于公式化体系的约束阻尼引起的稳定或不稳定耦合。假设采用周期性边界条件。所有量均为无量纲。\n- 将域上的 $L^{2}$-范数定义为 $\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$，增长因子定义为 $G(t) = \\lVert c(\\cdot,t)\\rVert_{2} / \\lVert c(\\cdot,0)\\rVert_{2}$（对于 $\\lVert c(\\cdot,0)\\rVert_{2} \\neq 0$）。如果 $\\lVert c(\\cdot,0)\\rVert_{2} = 0$，则将报告的增长因子定义为 $0.0$。\n\n任务：\n- 从 $3+1$ 分解以及哈密顿和动量约束是必须由演化方程保持的椭圆关系这一概念出发，论证上述线性平流-扩散-反应模型对于光滑背景上的小违背的合理性。解释移动矢量 $\\beta^{x}$ 如何提供平流项，如何将针对切变函数的 Bona-Massó 型切片条件和针对移动矢量的 Gamma-driver 条件解释为对系数 $(\\sigma,\\nu)$ 的修正，以及为什么周期性边界条件适用于非线性规范波测试。\n- 在不依赖任何预先给定的简化公式的情况下，推导一种计算周期域上单傅里葉模式初始数据 $c(x,0) = \\varepsilon \\sin\\left(2\\pi m x / L\\right)$（其中模式指数 $m \\in \\mathbb{Z}^{+}$，振幅为 $\\varepsilon$）下 $c(x,t)$ 的 $L^{2}$-范数时间演化的方法。您的推导必须明确利用周期域上线性微分算符的性质，并且必须识别每个系数 $(v,\\sigma,\\nu)$ 在决定 $G(t)$ 中所起的作用。\n- 基于您的推导，提出对切变函数和移动矢量的具体的、广泛使用的规范修正，这些修正可以被解释为在有效模型中使 $\\sigma$ 为负、$\\nu$ 为正，从而减少增长。例如，讨论用于 $\\alpha$ 的 Bona-Massó $1+\\log$ 切片和用于 $\\beta^{i}$ 的双曲 Gamma-driver，并定性地将它们的参数与模型中的 $(\\sigma,\\nu)$ 联系起来。\n\n计算要求：\n- 实现一个程序，为以下测试套件计算哈密顿和动量约束的增长因子。每个测试案例提供 $(L,m,\\varepsilon,v,\\sigma_{\\mathcal{H}},\\nu_{\\mathcal{H}},\\sigma_{\\mathcal{M}},\\nu_{\\mathcal{M}},T)$，其中 $T$ 是报告增长因子时的最终时间。所有量均为无量纲：\n    1. 不良规范（类测地线切片，冻结的移动矢量）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = 0.15$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.10$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$。\n    2. 具有恒定非零移动矢量的不良规范：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.5$, $\\sigma_{\\mathcal{H}} = 0.10$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.08$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$。\n    3. 改进的规范（$1+\\log$ 切片和 Gamma-driver 移动矢量，轻度阻尼）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = -0.05$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.08$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$。\n    4. 具有非零移动矢量的改进规范（平流加更强阻尼）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.8$, $\\sigma_{\\mathcal{H}} = -0.10$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.12$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$。\n    5. 初始约束违背为零的边缘情况：$L = 1$, $m = 1$, $\\varepsilon = 0$, $v = 0.3$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.02$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$。根据定义，报告哈密顿和动量增长因子均为 $0.0$。\n    6. 高波数边缘情况（强耗散占主导）：$L = 1$, $m = 16$, $\\varepsilon = 10^{-6}$, $v = 0.2$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.03$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$。\n- 您的程序必须为每个测试案例计算一个有序浮点数对 $(G_{\\mathcal{H}}, G_{\\mathcal{M}})$，其中 $G_{\\mathcal{H}}$ 是哈密顿约束增长因子，$G_{\\mathcal{M}}$ 是动量约束增长因子，都在时间 $T$ 时刻。\n- 角度单位不适用。不使用物理单位；所有变量都是无量纲的。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个由双元素列表组成的列表形式的结果，按测试套件的顺序排列，每个浮点数四舍五入到六位小数，例如：\n$[[G_{\\mathcal{H},1},G_{\\mathcal{M},1}],[G_{\\mathcal{H},2},G_{\\mathcal{M},2}],\\dots]$。", "solution": "问题陈述经评估有效。它在科学上基于数值相对论和爱因斯坦方程组 $3+1$ 分解的原理。该问题是适定的，提供了一个常系数线性偏微分方程、清晰的初始条件和周期性边界条件，这构成了一个可解的初边值问题。参数和目标都定义得足够精确，任务要求理论论证、数学推导和计算实现的结合，所有这些都是计算物理学中的标准实践。\n\n### 模型 PDE 的合理性论证\n\n在 Arnowitt-Deser-Misner (ADM) $3+1$ 形式体系中，时空的演化由一组关于空间度规 $\\gamma_{ij}$ 和外在曲率 $K_{ij}$ 的演化方程控制，并受到哈密顿约束 $\\mathcal{H}=0$ 和动量约束 $\\mathcal{M}_{i}=0$ 的制约。在连续统中，如果约束在初始时间切片上得到满足，演化方程保证它们在所有时间都得到满足。然而，在数值模拟中，离散化误差和规范选择（切变函数 $\\alpha$ 和移动矢量 $\\beta^i$）可能导致约束违背的增长。\n\n让 $C$ 代表哈密顿约束 $\\mathcal{H}$ 或动量约束的一个分量，例如 $\\mathcal{M}_x$。约束的时间演化可以示意性地写成 $\\partial_t C = L(C, \\phi)$，其中 $L$ 是一个复杂的微分算符，依赖于时空场 $\\phi = \\{\\gamma_{ij}, K_{ij}, \\alpha, \\beta^i\\}$ 和约束 $C$ 本身。\n\n该问题考虑的是非线性规范波，它是真空爱因斯坦方程的一个精确解，对应于非平凡规范下的闵可夫斯基时空。在此背景下，约束恒为零，$C_{bg} = 0$。我们感兴趣的是由数值误差引起的小的约束违背 $c(x,t)$ 的演化。我们可以在精确背景解周围线性化约束演化方程：\n$$\n\\partial_t c \\approx \\delta(\\partial_t C)|_{C=0} = \\left.\\frac{\\delta L}{\\delta C}\\right|_{C=0} c\n$$\n算符 $\\delta L/\\delta C$ 是一个线性微分算符，其系数依赖于背景解和所选的规范。在一维空间 $x$ 中，对于光滑背景，该算符可以近似为一个常系数线性算符。给定的模型，\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c\n$$\n代表了这种线性化的主导阶项。\n\n*   **平流项 ($-v\\,\\partial_x c$):** 在 $3+1$ 分解中，时间导数是垂直于空间超曲面的导数（由切变函数 $\\alpha$ 控制）和沿着超曲面的“拖拽”（由移动矢量 $\\beta^i$ 控制）的组合。一个沿着时间坐标线移动的观察者测量的标量场 $c$ 的时间导数是 $\\partial_t c = \\alpha (\\text{法向导数}) + \\mathcal{L}_{\\beta} c$，其中 $\\mathcal{L}_{\\beta}$ 是沿着移动矢量的李导数。对于标量，$\\mathcal{L}_{\\beta} c = \\beta^i \\partial_i c$。在一维中，这是 $\\beta^x \\partial_x c$。该项直接以由移动矢量定义的坐标速度平流标量场 $c$。因此，模型中的平流速度 $v$ 直接对应于 $-\\beta^x$（符号是一个约定问题）。\n\n*   **反应项 ($\\sigma\\,c$):** 该项源于线性化算符中对约束 $c$ 呈代数关系的部分。这些项严重依赖于规范选择，特别是切变函数 $\\alpha$ 的演化方程。例如，对于“测地线切片”，观察者沿着垂直于切片的测地线运动，已知约束违背会呈指数增长。这对应于一个正的反应率，$\\sigma  0$。动态调整的切片条件，如 Bona-Massó 族（例如“$1+\\log$”切片），定义了一个与外在曲率迹 $K$ 耦合的 $\\alpha$ 的演化方程。由于 $K$与哈密顿约束 $\\mathcal{H}$ 相关，这种耦合创建了一个反馈机制。增长的 $\\mathcal{H}$ 会改变 $K$，这反过来又以一种抵消增长的方式驱动切变函数，从而有效地使 $\\sigma$ 为负并稳定演化。\n\n*   **扩散项 ($\\nu\\,\\partial_x^2 c$):** 二阶导数项 $\\partial_x^2 c$ 可以从约束演化方程中的曲率项自然产生。更重要的是，像 BSSN 和 CCZ4 这样的现代数值相对论公式化体系通常包含明确的“约束阻尼”项。这些是手动添加到演化方程中的项，与约束的空间导数成正比（例如，形式为 $\\nabla_i C$）。当线性化时，这些项表现为一个扩散项 $\\nu \\nabla^2 c$，在一维中即为 $\\nu \\partial_x^2 c$。正系数 $\\nu  0$ 会阻尼高波数（短波长）的约束违背，这在数值上通常是最成问题的。该项也模拟了许多有限差分格式中固有的数值耗散效应。\n\n*   **周期性边界条件：** 非线性规范波是一个解，其中度规分量是行波坐标（例如 $f(x-t)$）的周期函数。因此，具有周期性边界条件的计算域是模拟这种波并分析其上扰动的自然且物理上合适的选择。\n\n### 增长因子 $G(t)$ 的推导\n\n我们需要在周期域 $x \\in [0,L)$ 上求解 PDE $\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c$，初始条件为单傅里叶模式 $c(x,0) = \\varepsilon \\sin(k x)$，其中 $k = 2\\pi m / L$，模式指数为整数 $m \\ge 1$。\n\n由于 PDE 在周期域上是线性的且系数恒定，我们可以使用傅里叶分析。该域上空间微分算符 $\\partial_x$ 和 $\\partial_x^2$ 的特征函数是复指数 $e^{i k_n x}$，其波数为 $k_n = 2\\pi n / L$，$n \\in \\mathbb{Z}$。\n让我们考虑一个单一复傅里叶模式作为解的拟设：$c(x,t) = \\hat{c}(t) e^{ikx}$。将此代入 PDE，得到关于随时变振幅 $\\hat{c}(t)$ 的常微分方程 (ODE)：\n$$\n\\frac{d\\hat{c}(t)}{dt} e^{ikx} = -v \\hat{c}(t) (ik) e^{ikx} + \\sigma \\hat{c}(t) e^{ikx} + \\nu \\hat{c}(t) (ik)^2 e^{ikx}\n$$\n两边除以 $e^{ikx}$，我们得到：\n$$\n\\frac{d\\hat{c}(t)}{dt} = (-ikv + \\sigma - \\nu k^2) \\hat{c}(t)\n$$\n这是一个一阶线性 ODE，其解为：\n$$\n\\hat{c}(t) = \\hat{c}(0) \\exp\\left((\\sigma - \\nu k^2 - ikv)t\\right)\n$$\n初始条件是 $c(x,0) = \\varepsilon \\sin(kx)$。我们可以使用欧拉公式将其写为：\n$$\nc(x,0) = \\varepsilon \\left(\\frac{e^{ikx} - e^{-ikx}}{2i}\\right) = \\left(\\frac{\\varepsilon}{2i}\\right) e^{ikx} + \\left(\\frac{-\\varepsilon}{2i}\\right) e^{-ikx}\n$$\n这表明初始条件是波数为 $k$ 和 $-k$ 的两个复傅里葉模式的叠加。初始振幅为 $\\hat{c}_{k}(0) = \\varepsilon / (2i)$ 和 $\\hat{c}_{-k}(0) = -\\varepsilon / (2i)$。根据线性性质，时间 $t$ 的解是演化后模式的叠加：\n$$\nc(x,t) = \\hat{c}_{k}(t) e^{ikx} + \\hat{c}_{-k}(t) e^{-ikx}\n$$\n波数为 $-k$ 的模式振幅演化如下：\n$$\n\\hat{c}_{-k}(t) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu (-k)^2 - i(-k)v)t\\right) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu k^2 + ikv)t\\right)\n$$\n代入初始振幅和演化因子：\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 - ikv)t} e^{ikx} - \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 + ikv)t} e^{-ikx}\n$$\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2)t} \\left( e^{i(kx - kvt)} - e^{-i(kx - kvt)} \\right)\n$$\n$$\nc(x,t) = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt))\n$$\n解是一个正弦波，其振幅以速率 $(\\sigma - \\nu k^2)$ 指数演化，并以速度 $v$ 平流。\n\n现在我们计算 $L^2$-范数，$\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$。\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\int_{0}^{L} \\left( \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt)) \\right)^2 dx\n$$\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\int_{0}^{L} \\sin^2(k(x-vt)) dx\n$$\n$\\sin^2$ 在整数个周期上的积分是 $L/2$。由于 $k = 2\\pi m/L$，被积函数 $\\sin^2(\\frac{2\\pi m}{L}(x-vt))$ 在区间 $[0,L)$ 上完成了 $m$ 个完整周期，所以积分值确实是 $L/2$。\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\frac{L}{2}\n$$\n取平方根，假设 $\\varepsilon > 0$：\n$$\n\\lVert c(\\cdot,t)\\rVert_{2} = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{\\frac{L}{2}}\n$$\n初始范数是 $\\lVert c(\\cdot,0)\\rVert_{2} = \\varepsilon \\sqrt{L/2}$。增长因子 $G(t)$ 是它们的比值：\n$$\nG(t) = \\frac{\\lVert c(\\cdot,t)\\rVert_{2}}{\\lVert c(\\cdot,0)\\rVert_{2}} = \\frac{\\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{L/2}}{\\varepsilon \\sqrt{L/2}} = e^{(\\sigma - \\nu k^2)t}\n$$\n代入 $k = 2\\pi m / L$：\n$$\nG(t) = \\exp\\left(\\left(\\sigma - \\nu \\left(\\frac{2\\pi m}{L}\\right)^2\\right)t\\right)\n$$\n这是增长因子的最终表达式。注意，平流速度 $v$ 不影响 $L^2$-范数的增长，因为范数在空间平移下是不变的。如果 $\\varepsilon=0$，初始范数为 $0$，解保持为 $c(x,t)=0$，所以增长因子被正确定义为 $0.0$。\n\n### 稳定性的规范条件\n\n“良好”规范选择的目标是确保约束违背不会增长；理想情况下，它们应该被阻尼掉。在我们的模型背景下，这意味着设计整个系统，使得约束的有效系数满足 $\\sigma  0$ 和 $\\nu > 0$。\n\n*   **切变函数条件 ($1+\\log$ 切片):** $1+\\log$ 切片条件是 Bona-Massó 切片条件族的一员。一种常见的形式是 $\\partial_t \\alpha = -\\alpha^2 f(\\alpha) K + \\beta^i \\partial_i \\alpha$，其中一个流行的选择是 $f(\\alpha)=2/\\alpha$。关键是包含外在曲率迹 $K$ 的项。哈密顿约束 $\\mathcal{H}$ 与 $K$ 有代数关系（例如 $\\mathcal{H} = R + K^2 - K_{ij}K^{ij} - 16\\pi\\rho$）。当 $\\mathcal{H}$ 偏离零时，$K$ 也偏离其“在壳”值。切片条件将此偏差耦合回切变函数 $\\alpha$ 的演化中。这种反馈被专门设计为负反馈：增长的约束违背会以一种抵消该增长的方式驱动切变函数。这迫使约束服从一个类波动方程，而不是指数增长，这在我们的有效模型中对应于为 $\\sigma_{\\mathcal{H}}$ 贡献一个负项，从而促进稳定性。\n\n*   **移动矢量条件 (Gamma-driver):** 移动矢量 $\\beta^i$ 控制坐标漂移。静态移动矢量或简单的选择可能导致动量约束 $\\mathcal{M}_i$ 的不稳定性。“Gamma-driver”移动条件是关于 $\\beta^i$ 的一组动力学演化方程。一个典型的形式是 $\\partial_t \\beta^i = B^i$ 和 $\\partial_t B^i = \\frac{3}{4}\\partial_t \\tilde{\\Gamma}^i - \\eta B^i$，其中 $\\tilde{\\Gamma}^i$ 是共形联络函数（本质上是度规的空间导数），$\\eta$ 是一个阻尼参数。源项 $\\tilde{\\Gamma}^i$ 与动量约束 $\\mathcal{M}_i$ 密切相关。当 $\\mathcal{M}_i$ 非零时，它充当移动矢量演化的源。然后移动矢量动态调整以将 $\\tilde{\\Gamma}^i$（并因此将 $\\mathcal{M}_i$）驱动回零。这将约束演化转变为一个有阻尼的双曲系统。这对应于使 $\\sigma_{\\mathcal{M}}$ 为负，并且也可以解释为对扩散/阻尼项 $\\nu_{\\mathcal{M}}$ 有贡献。\n\n总之，现代的“动态”规范条件旨在将约束子系统从一个不适定或不稳定的系统转变为一个适定的、稳定的、有阻尼的双曲系统。这是通过在规范演化方程中引入提供负反馈的项来实现的，在有效模型中转化为 $\\sigma  0$ 和 $\\nu > 0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Hamiltonian and momentum constraint growth factors for a\n    series of test cases based on a linearized 1D constraint evolution model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, m, ε, v, σ_H, ν_H, σ_M, ν_M, T)\n    test_cases = [\n        # 1. Poor gauge (geodesic-like slicing, frozen shift)\n        (1.0, 1, 1e-6, 0.0, 0.15, 0.00005, 0.10, 0.00005, 10.0),\n        # 2. Poor gauge with constant nonzero shift\n        (1.0, 1, 1e-6, 0.5, 0.10, 0.00005, 0.08, 0.00005, 10.0),\n        # 3. Improved gauge (1+log slicing and Gamma-driver shift, mild damping)\n        (1.0, 1, 1e-6, 0.0, -0.05, 0.005, -0.08, 0.005, 10.0),\n        # 4. Improved gauge with nonzero shift (advection plus stronger damping)\n        (1.0, 1, 1e-6, 0.8, -0.10, 0.005, -0.12, 0.005, 10.0),\n        # 5. Edge case with zero initial constraint violation\n        (1.0, 1, 0.0, 0.3, 0.05, 0.001, 0.02, 0.001, 10.0),\n        # 6. High-wavenumber edge case (strong dissipation dominates)\n        (1.0, 16, 1e-6, 0.2, 0.05, 0.001, 0.03, 0.001, 10.0),\n    ]\n\n    all_results_formatted = []\n    \n    for case in test_cases:\n        L, m, epsilon, v, sigma_H, nu_H, sigma_M, nu_M, T = case\n\n        # Handle the special case of zero initial violation as per problem description.\n        if epsilon == 0.0:\n            G_H = 0.0\n            G_M = 0.0\n        else:\n            # The derived growth factor G(t) = exp((σ - ν * k^2) * t)\n            # where k = 2 * pi * m / L.\n            \n            # Calculate the square of the wavenumber k.\n            k_squared = (2 * np.pi * m / L)**2\n\n            # Calculate the growth factor for the Hamiltonian constraint.\n            exponent_H = (sigma_H - nu_H * k_squared) * T\n            G_H = np.exp(exponent_H)\n\n            # Calculate the growth factor for the momentum constraint.\n            exponent_M = (sigma_M - nu_M * k_squared) * T\n            G_M = np.exp(exponent_M)\n\n        # Format the result pair as a string '[val1,val2]'\n        formatted_pair = f\"[{G_H:.6f},{G_M:.6f}]\"\n        all_results_formatted.append(formatted_pair)\n\n    # Final print statement in the exact required format.\n    # Joins the formatted strings and wraps them in an outer list bracket.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n\n```", "id": "3492624"}]}