{"hands_on_practices": [{"introduction": "有效单体（EOB）模型的一个核心设计原则是在特定极限下，必须与广义相对论的已知精确解保持一致。这项练习提供了应用这一原则的实践机会。通过要求学生在测试质量极限（test-mass limit）下，强制EOB模型重现著名的史瓦西时空中的最内稳定圆轨道（ISCO），学生将亲手推导出对EOB势函数校准参数的约束条件，从而深刻理解理论一致性在模型构建中的关键作用 [@problem_id:3472716]。", "problem": "考虑用于双黑洞的无自旋有效单体 (EOB) 势 $A(u;\\nu)$，其中 $u \\equiv M/r$，$\\nu$ 是对称质量比。在试验质量极限 $\\nu \\to 0$ 下，为了与 Schwarzschild 时空中的测地运动保持一致，必须能再现其圆轨道结构。假设在试验质量极限下，EOB 势通过引入校准系数，被建模为 Schwarzschild 势的一个小形变，\n$$\nA(u;\\nu{=}0) = 1 - 2 u + \\alpha\\, u^{3} + \\beta\\, u^{4} + \\gamma\\, u^{5} + \\mathcal{O}(u^{6}),\n$$\n其中 $|\\alpha|,|\\beta|,|\\gamma|$ 假定为小量，且 $\\alpha,\\beta,\\gamma$ 与 $u$ 无关。\n\n使用球对称有效度规中的圆形赤道测地线条件以及定义最内稳定圆轨道 (ISCO) 的临界稳定条件，施加约束使得在试验质量极限下，ISCO 出现在 Schwarzschild 值 $u_{\\mathrm{ISCO}} = 1/6$ 处。在计算中对小的校准系数 $\\alpha,\\beta,\\gamma$ 保持一致到线性阶。\n\n推导由 $u_{\\mathrm{ISCO}} = 1/6$ 施加在 $(\\alpha,\\beta,\\gamma)$ 上的线性约束，然后将 $\\alpha$ 表示为 $\\beta$ 和 $\\gamma$ 的函数。您的最终答案必须是关于 $\\alpha(\\beta,\\gamma)$ 的单个闭式解析表达式，不带单位。不要引入任何数值近似；请给出精确的有理系数。", "solution": "用户要求我通过施加“在试验质量极限 ($\\nu \\to 0$) 下，最内稳定圆轨道 (ISCO) 出现在已知的 Schwarzschild 值 $u_{\\mathrm{ISCO}} = 1/6$ 处”这一条件，来推导有效单体 (EOB) 校准系数 $(\\alpha, \\beta, \\gamma)$ 上的一个线性约束。\n\n### 步骤 1：圆轨道和 ISCO 的形式体系\n\n对于静态球对称时空中的一个试验粒子，其径向运动由一个有效势控制。EOB 形式体系使用一个有效度规来对动力学进行建模，其 $g_{tt}$ 分量由 $-A(r)$ 给出。对于具有比角动量 $L$ 的粒子，其有效势的平方为 $V_{\\mathrm{eff}}^2(r) = A(r) \\left(1 + \\frac{L^2}{r^2}\\right)$。\n\n圆轨道存在于有效势取极值的半径 $r$ 处，即 $\\frac{d(V_{\\mathrm{eff}}^2)}{dr} = 0$。\nISCO 对应于临界稳定条件，此时轨道处于有效势的拐点上，即 $\\frac{d^2(V_{\\mathrm{eff}}^2)}{dr^2} = 0$。\n\n通过同时求解这两个方程可以推导出 ISCO 半径 $r_{\\mathrm{ISCO}}$ 的一个组合条件，该过程消去了比角动量 $L$。这得出了关于 $A(r)$ 的以下微分方程，该方程必须在 $r=r_{\\mathrm{ISCO}}$ 处得到满足：\n$$\n2r (A'(r))^2 - 3A(r)A'(r) - rA(r)A''(r) = 0\n$$\n其中撇号表示对 $r$ 的导数。\n\n### 步骤 2：将 ISCO 条件转换为变量 $u$\n\n问题是用变量 $u \\equiv M/r$ 来表述的，其中 $M$ 是总质量。我们必须将 ISCO 条件转换为一个以 $u$ 为变量的方程。使用链式法则，对 $r$ 的导数可以表示为对 $u$ 的导数：\n$r = M/u$\n$\\frac{d}{dr} = \\frac{du}{dr} \\frac{d}{du} = \\left(-\\frac{M}{r^2}\\right) \\frac{d}{du} = -\\frac{u^2}{M} \\frac{d}{du}$\n\n令 $A_u \\equiv \\frac{dA}{du}$ 和 $A_{uu} \\equiv \\frac{d^2A}{du^2}$。\nA 对 r 的一阶和二阶导数是：\n$A'(r) = -\\frac{u^2}{M} A_u$\n$A''(r) = \\frac{d}{dr} \\left(-\\frac{u^2}{M} A_u\\right) = -\\frac{u^2}{M} \\frac{d}{du} \\left(-\\frac{u^2}{M} A_u\\right) = \\frac{u^2}{M} \\left(\\frac{2u}{M} A_u + \\frac{u^2}{M} A_{uu}\\right) = \\frac{2u^3}{M^2} A_u + \\frac{u^4}{M^2} A_{uu}$\n\n将这些代入 ISCO 条件：\n$$\n2\\left(\\frac{M}{u}\\right) \\left(-\\frac{u^2}{M} A_u\\right)^2 - 3A \\left(-\\frac{u^2}{M} A_u\\right) - \\left(\\frac{M}{u}\\right) A \\left(\\frac{2u^3}{M^2} A_u + \\frac{u^4}{M^2} A_{uu}\\right) = 0\n$$\n简化各项：\n$$\n\\frac{2u^3}{M} A_u^2 + \\frac{3u^2}{M} A A_u - \\frac{A}{M}(2u^2 A_u + u^3 A_{uu}) = 0\n$$\n乘以 $M/u^2$ (对于 $u \\neq 0$)，得到 $2u A_u^2 + 3A A_u - A (2A_u + u A_{uu}) = 0$。\n这化简为以 $u$ 表示的最终 ISCO 条件：\n$$\nC(u) \\equiv 2u (A_u)^2 + A A_u - u A A_{uu} = 0\n$$\n\n### 步骤 3：将条件应用于 EOB 势\n\n在试验质量极限下，给定的 EOB 势为：\n$$\nA(u) = 1 - 2u + \\alpha u^3 + \\beta u^4 + \\gamma u^5 + \\mathcal{O}(u^6)\n$$\n我们在小系数 $\\alpha, \\beta, \\gamma$ 的线性阶上进行计算。我们将 $A(u)$ 表示为 Schwarzschild 部分 $A_S(u) = 1-2u$ 和一个小微扰 $\\delta A(u) = \\alpha u^3 + \\beta u^4 + \\gamma u^5$ 的和。\n\n导数为：\n$A_u = -2 + 3\\alpha u^2 + 4\\beta u^3 + 5\\gamma u^4 \\equiv A_{S,u} + \\delta A_u$\n$A_{uu} = 6\\alpha u + 12\\beta u^2 + 20\\gamma u^3 \\equiv \\delta A_{uu}$ (因为 $A_{S,uu}=0$)。\n\n我们将这些代入 ISCO 条件 $C(u)=0$ 并进行线性化。\n零阶部分，$C_0(u):$\n$$\nC_0(u) = 2u(A_{S,u})^2 + A_S A_{S,u} - u A_S A_{S,uu} = 2u(-2)^2 + (1-2u)(-2) - 0 = 8u - 2 + 4u = 12u - 2\n$$\n对于 Schwarzschild 时空，ISCO 位于 $C_0(u)=0$ 处，这给出 $12u-2=0 \\implies u=1/6$。这是正确的。\n\n一阶部分，$\\delta C(u):$\n$$\n\\delta C(u) = (A_S - 8u)\\delta A_u - 2\\delta A - uA_S\\delta A_{uu} = 0\n$$\n我们必须在 Schwarzschild ISCO 位置 $u_0 = 1/6$ 处施加此条件。\n在 $u_0=1/6$ 处：\n$A_S(u_0) = 1 - 2(1/6) = 1 - 1/3 = 2/3$.\n$A_S(u_0) - 8u_0 = 2/3 - 8/6 = 2/3 - 4/3 = -2/3$.\n$u_0 A_S(u_0) = (1/6)(2/3) = 1/9$.\n\n条件变为：\n$$\n-\\frac{2}{3}\\delta A_u(u_0) - 2\\delta A(u_0) - \\frac{1}{9}\\delta A_{uu}(u_0) = 0\n$$\n代入微扰的表达式：\n$\\delta A(u_0) = \\alpha u_0^3 + \\beta u_0^4 + \\gamma u_0^5$\n$\\delta A_u(u_0) = 3\\alpha u_0^2 + 4\\beta u_0^3 + 5\\gamma u_0^4$\n$\\delta A_{uu}(u_0) = 6\\alpha u_0 + 12\\beta u_0^2 + 20\\gamma u_0^3$\n\n我们收集 $\\alpha, \\beta, \\gamma$ 的系数。\n\n$\\alpha$ 的系数：\n$$\n-\\frac{2}{3}(3u_0^2) - 2u_0^3 - \\frac{1}{9}(6u_0) = -2u_0^2 - 2u_0^3 - \\frac{2}{3}u_0\n$$\n代入 $u_0=1/6$：$-2(1/36) - 2(1/216) - (2/3)(1/6) = -1/18 - 1/108 - 1/9 = (-6 - 1 - 12)/108 = -19/108$。\n\n$\\beta$ 的系数：\n$$\n-\\frac{2}{3}(4u_0^3) - 2u_0^4 - \\frac{1}{9}(12u_0^2) = -\\frac{8}{3}u_0^3 - 2u_0^4 - \\frac{4}{3}u_0^2\n$$\n代入 $u_0=1/6$：$-\\frac{8}{3}(\\frac{1}{216}) - 2(\\frac{1}{1296}) - \\frac{4}{3}(\\frac{1}{36}) = -\\frac{1}{81} - \\frac{1}{648} - \\frac{1}{27} = \\frac{-8 - 1 - 24}{648} = -\\frac{33}{648} = -\\frac{11}{216}$。\n\n$\\gamma$ 的系数：\n$$\n-\\frac{2}{3}(5u_0^4) - 2u_0^5 - \\frac{1}{9}(20u_0^3) = -\\frac{10}{3}u_0^4 - 2u_0^5 - \\frac{20}{9}u_0^3\n$$\n代入 $u_0=1/6$：$-\\frac{10}{3}(\\frac{1}{1296}) - 2(\\frac{1}{7776}) - \\frac{20}{9}(\\frac{1}{216}) = -\\frac{10}{3888} - \\frac{2}{7776} - \\frac{20}{1944} = \\frac{-20 - 2 - 80}{7776} = -\\frac{102}{7776} = -\\frac{17}{1296}$。\n\n### 步骤 4：最终推导\n\n施加在 $(\\alpha, \\beta, \\gamma)$ 上的线性约束是：\n$$\n\\alpha \\left(-\\frac{19}{108}\\right) + \\beta \\left(-\\frac{11}{216}\\right) + \\gamma \\left(-\\frac{17}{1296}\\right) = 0\n$$\n将整个方程乘以 $-1296$ 以消去分母：\n$1296 = 12 \\times 108 = 6 \\times 216$.\n$$\n\\alpha \\left(\\frac{19}{108} \\times 1296\\right) + \\beta \\left(\\frac{11}{216} \\times 1296\\right) + \\gamma \\left(\\frac{17}{1296} \\times 1296\\right) = 0\n$$\n$$\n\\alpha(19 \\times 12) + \\beta(11 \\times 6) + \\gamma(17) = 0\n$$\n$$\n228\\alpha + 66\\beta + 17\\gamma = 0\n$$\n求解 $\\alpha$ 作为 $\\beta$ 和 $\\gamma$ 的函数：\n$$\n228\\alpha = -66\\beta - 17\\gamma\n$$\n$$\n\\alpha = -\\frac{66}{228}\\beta - \\frac{17}{228}\\gamma\n$$\n化简有理系数：\n$$\n\\frac{66}{228} = \\frac{33}{114} = \\frac{11}{38}\n$$\n分数 $\\frac{17}{228}$ 是不可约的，因为 17 是质数，而 $228 = 2^2 \\times 3 \\times 19$。\n因此，$\\alpha$ 的最终表达式是：\n$$\n\\alpha = -\\frac{11}{38}\\beta - \\frac{17}{228}\\gamma\n$$", "answer": "$$\n\\boxed{-\\frac{11}{38}\\beta - \\frac{17}{228}\\gamma}\n$$", "id": "3472716"}, {"introduction": "构建了波形模型之后，一个至关重要的问题是：我们能从实际的引力波信号中多好地测量出它的参数？这项编码练习运用强大的费雪信息矩阵（Fisher information matrix）形式，来探讨EOB模型中校准参数的可识别性（identifiability）。通过这个实践，你将揭示在参数空间中（例如高不对称质量比的情况下），某些参数组合变得难以区分的常见问题，即所谓的“简并性”（degeneracies），这是连接理论模型结构与观测能力的桥梁 [@problem_id:3472703]。", "problem": "考虑一个有效单体（EOB）模型的简化校准研究，其目标是使用费雪信息分析和类数值相对论（NR）的合成数据来评估校准参数的可辨识性。假设探测器噪声是稳态高斯噪声，并使用信号之间的标准频域内积。该问题关注三个无量纲校准参数，它们通过对称质量比抑制的修正项进入旋进阶段，并研究当质量比增加时，它们的组合如何变得受到弱约束。所有量均为无量纲，您不应引入任何物理单位。\n\n从以下基础出发：\n- 在稳态高斯噪声中，似然由噪声加权内积确定。对于两个复频域波形 $h_1(f)$ 和 $h_2(f)$，定义内积为\n$$\n\\langle h_1, h_2 \\rangle \\equiv 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{h_1(f)\\,h_2^*(f)}{S_n(f)}\\, df,\n$$\n其中 $S_n(f)$ 是单边功率谱密度（PSD）。\n- 参数 $\\boldsymbol{\\theta}$ 的费雪信息矩阵由下式给出\n$$\n\\Gamma_{ij} = \\left\\langle \\frac{\\partial h}{\\partial \\theta_i}, \\frac{\\partial h}{\\partial \\theta_j} \\right\\rangle,\n$$\n$\\Gamma$ 的本征结构揭示了可辨识和弱约束的参数组合：小的本征值表示参数空间中约束很差的方向。\n- 波形模板采用稳相近似下的领头阶旋进模型，其振幅为 $A(f)$，相位为 $\\psi(f)$，使得\n$$\nh(f;\\boldsymbol{\\theta}) = A(f)\\, e^{i \\psi(f;\\boldsymbol{\\theta})}.\n$$\n\n明确定义以下类NR的合成模型要素，以使研究在计算上是适定的：\n- 使用领头阶振幅标度\n$$\nA(f) = A_0\\, f^{-7/6},\n$$\n其中 $A_0$ 的选择应使得在给定的PSD和频带下达到目标信噪比（SNR）$\\,\\rho_{\\mathrm{tgt}}$：\n$$\n\\rho^2 = \\langle h, h \\rangle = 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{|h(f)|^2}{S_n(f)}\\, df, \\quad \\text{要求 } \\rho = \\rho_{\\mathrm{tgt}}。\n$$\n- 将相位建模为基线加上校准修正项。为研究校准参数的可辨识性，仅保留依赖于校准的贡献就足够了。设校准参数为 $\\boldsymbol{\\theta} = (\\alpha_2,\\alpha_3,\\alpha_4)$，它们以下述形式进入相位：\n$$\n\\psi_{\\mathrm{cal}}(f;\\boldsymbol{\\theta},q) = \\sum_{n\\in\\{2,3,4\\}} \\alpha_n \\, \\nu(q)^{n/2} \\, v(f)^n,\n$$\n其中 $q \\equiv m_1/m_2 \\ge 1$ 是质量比，$\\nu(q) \\equiv \\frac{q}{(1+q)^2}$ 是对称质量比，而 $v(f) \\equiv (\\pi f)^{1/3}$ 是在几何化单位下，总质量设为1时的领头阶后牛顿频率参数，因此所有量都是无量纲的。相位的基线部分与 $\\boldsymbol{\\theta}$ 无关，对 $(\\alpha_2,\\alpha_3,\\alpha_4)$ 的费雪信息矩阵没有贡献，因此在本次分析中可以省略。\n- 使用以下形式的光滑、无量纲PSD：\n$$\nS_n(f) = S_0 \\left[ \\left(\\frac{f}{f_0}\\right)^{-4} + 2\\left(\\frac{f}{f_0}\\right)^2 + 1 \\right],\n$$\n其中 $S_0 = 1$ 和 $f_0 = 2\\times 10^{-2}$ 为固定的无量纲常数。\n\n在这些假设下，模板的参数导数为\n$$\n\\frac{\\partial h}{\\partial \\alpha_n}(f) = i\\, h(f) \\,\\nu(q)^{n/2} \\, v(f)^n, \\quad n\\in\\{2,3,4\\}.\n$$\n因此，费雪信息矩阵元为\n$$\n\\Gamma_{mn} = 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{|h(f)|^2}{S_n(f)} \\, \\nu(q)^{(m+n)/2} \\, v(f)^{m+n} \\, df, \\quad m,n\\in\\{2,3,4\\}.\n$$\n通过计算多个质量比 $q$ 下 $\\Gamma$ 的本征值和本征向量来研究可辨识性；通过比值来量化弱可辨识性\n$$\nr \\equiv \\frac{\\lambda_{\\min}}{\\lambda_{\\max}},\n$$\n并通过与 $\\lambda_{\\min}$ 相关联的归一化本征向量来刻画最弱方向，该向量提供了 $(\\alpha_2,\\alpha_3,\\alpha_4)$ 中约束最弱的线性组合。\n\n您的任务：\n- 实现一个程序，该程序为每个测试用例，在均匀频率网格上构建 $h(f)$，归一化 $A_0$ 以达到目标信噪比 $\\,\\rho_{\\mathrm{tgt}}$，构建 $(\\alpha_2,\\alpha_3,\\alpha_4)$ 的费雪信息矩阵 $\\Gamma$，并计算 $(r,\\mathbf{e}_{\\min})$，其中 $\\mathbf{e}_{\\min}$ 是与 $\\lambda_{\\min}$ 相关联的单位范数本征向量，表示在参数基 $(\\alpha_2,\\alpha_3,\\alpha_4)$ 中。\n- 使用一个在 $f_{\\min} = 3\\times 10^{-3}$ 和 $f_{\\max} = 3\\times 10^{-2}$ 之间有 $N_f = 5000$ 个点的均匀频率网格。\n- 使用目标信噪比 $\\rho_{\\mathrm{tgt}} = 25$。\n- 对于数值积分，使用梯形法则。\n\n测试套件：\n- 用例1：$q=1$（等质量；预期是良态的）。\n- 用例2：$q=4$（中度不等质量；条件数开始恶化）。\n- 用例3：$q=8$（阈值区域；组合开始变得弱约束）。\n- 用例4：$q=12$（更极端；显著的简并性）。\n- 用例5：$q=64$（非常极端；接近奇异的费雪矩阵）。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个对应于一个测试用例的元素本身必须是一个包含4个浮点数的列表，形式为 $[r, e_2, e_3, e_4]$，其中 $r$ 是本征值比 $\\lambda_{\\min}/\\lambda_{\\max}$，而 $(e_2,e_3,e_4)$ 是单位范数本征向量 $\\mathbf{e}_{\\min}$ 在基 $(\\alpha_2,\\alpha_3,\\alpha_4)$ 中的分量，按此顺序排列。例如，输出应如下所示：\n$$\n\\left[ [r_1, e_{2,1}, e_{3,1}, e_{4,1}], [r_2, e_{2,2}, e_{3,2}, e_{4,2}], \\ldots \\right].\n$$\n所有输出均为无量纲浮点数，不得包含任何单位。", "solution": "用户提供的问题是有效的。它在科学上基于引力波数据分析的原理，特别是通过费雪信息矩阵形式体系进行的参数估计。该问题是适定的，为获得唯一解提供了所有必要的定义、常数和数值参数。其语言客观，设置自洽且逻辑一致。因此，我们可以着手求解。\n\n目标是分析一个简化的有效单体（EOB）波形模型中三个校准参数 $\\boldsymbol{\\theta} = (\\alpha_2, \\alpha_3, \\alpha_4)$ 的可辨识性。通过研究作为双星质量比 $q$ 的函数的费雪信息矩阵 $\\Gamma$ 的本征系统来评估可辨识性。参数空间中约束差的方向对应于 $\\Gamma$ 的小本征值。\n\n参数 $\\boldsymbol{\\theta}$ 的费雪信息矩阵由下式给出\n$$\n\\Gamma_{ij} = \\left\\langle \\frac{\\partial h}{\\partial \\theta_i}, \\frac{\\partial h}{\\partial \\theta_j} \\right\\rangle\n$$\n其中噪声加权内积定义为\n$$\n\\langle h_1, h_2 \\rangle \\equiv 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{h_1(f)\\,h_2^*(f)}{S_n(f)}\\, df\n$$\n问题指定了波形模型 $h(f) = A(f) e^{i\\psi(f)}$，其相位 $\\psi(f)$ 依赖于校准参数 $\\boldsymbol{\\theta}$。波形对参数 $\\alpha_m$ 和 $\\alpha_n$（其中 $m, n \\in \\{2,3,4\\}$）的导数由 $\\frac{\\partial h}{\\partial \\alpha_k} = i h(f) \\frac{\\partial \\psi}{\\partial \\alpha_k}$ 给出。来自校准的相位贡献为 $\\psi_{\\mathrm{cal}} = \\sum_{k=2}^4 \\alpha_k \\nu(q)^{k/2} v(f)^k$，这导致 $\\frac{\\partial \\psi}{\\partial \\alpha_k} = \\nu(q)^{k/2} v(f)^k$。\n\n将这些代入费雪矩阵的定义中可得：\n$$\n\\begin{aligned}\n\\Gamma_{mn} = \\left\\langle i h(f) \\nu(q)^{m/2} v(f)^m, i h(f) \\nu(q)^{n/2} v(f)^n \\right\\rangle \\\\\n= (i)(-i) \\nu(q)^{(m+n)/2} \\left\\langle h(f) v(f)^m, h(f) v(f)^n \\right\\rangle \\\\\n= \\nu(q)^{(m+n)/2} \\int_{f_{\\min}}^{f_{\\max}} 4 \\frac{\\left(A(f)e^{i\\psi(f)}v(f)^m\\right) \\left(A(f)e^{i\\psi(f)}v(f)^n\\right)^*}{S_n(f)} df \\\\\n= \\nu(q)^{(m+n)/2} \\int_{f_{\\min}}^{f_{\\max}} 4 \\frac{A(f)^2 v(f)^{m+n}}{S_n(f)} df \\\\\n= 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{|h(f)|^2}{S_n(f)} \\, \\nu(q)^{(m+n)/2} \\, v(f)^{m+n} \\, df\n\\end{aligned}\n$$\n这证实了问题陈述中提供的表达式。振幅为 $|h(f)| = A(f) = A_0 f^{-7/6}$。\n\n一个关键步骤是归一化波形以达到目标信噪比（SNR）$\\rho_{\\mathrm{tgt}}$。信噪比的平方为 $\\rho^2 = \\langle h, h \\rangle$。我们要求 $\\rho = \\rho_{\\mathrm{tgt}}$。\n$$\n\\rho_{\\mathrm{tgt}}^2 = \\langle h, h \\rangle = 4 \\int_{f_{\\min}}^{f_{\\max}} \\frac{|h(f)|^2}{S_n(f)} df = 4 A_0^2 \\int_{f_{\\min}}^{f_{\\max}} \\frac{f^{-7/3}}{S_n(f)} df\n$$\n我们可以解出项 $4 A_0^2$：\n$$\n4 A_0^2 = \\frac{\\rho_{\\mathrm{tgt}}^2}{\\int_{f_{\\min}}^{f_{\\max}} \\frac{f^{-7/3}}{S_n(f)} df}\n$$\n将此代回 $\\Gamma_{mn}$ 的表达式中，就无需显式计算 $A_0$：\n$$\n\\Gamma_{mn} = \\nu(q)^{(m+n)/2} \\left( 4 A_0^2 \\int_{f_{\\min}}^{f_{\\max}} \\frac{f^{-7/3} v(f)^{m+n}}{S_n(f)} df \\right)\n$$\n使用 $v(f) = (\\pi f)^{1/3}$，我们得到 $v(f)^{m+n} = \\pi^{(m+n)/3} f^{(m+n)/3}$。\n$$\n\\Gamma_{mn} = \\rho_{\\mathrm{tgt}}^2 \\, \\nu(q)^{(m+n)/2} \\, \\pi^{(m+n)/3} \\, \\frac{\\int_{f_{\\min}}^{f_{\\max}} \\frac{f^{(m+n-7)/3}}{S_n(f)} df}{\\int_{f_{\\min}}^{f_{\\max}} \\frac{f^{-7/3}}{S_n(f)} df}\n$$\n这是用于计算的最终表达式。\n\n数值实现过程如下：\n1.  定义所有物理和数值常数（$f_{\\min}$、$f_{\\max}$、$N_f$、$\\rho_{\\mathrm{tgt}}$、$S_0$、$f_0$）。\n2.  建立一个从 $f_{\\min}$ 到 $f_{\\max}$，包含 $N_f$ 个点的均匀频率网格 $f$。\n3.  定义功率谱密度函数 $S_n(f)$。\n4.  为避免重复计算，我们预先计算所有需要的幂 $p$ 的积分 $I(p) = \\int_{f_{\\min}}^{f_{\\max}} \\frac{f^p}{S_n(f)} df$。对于 $m,n \\in \\{2,3,4\\}$，幂为 $p = (m+n-7)/3$，归一化积分需要 $p=-7/3$。所有积分都使用梯形法则进行数值计算。\n5.  对于测试套件中的每个质量比 $q$：\n    a. 计算对称质量比 $\\nu(q) = q/(1+q)^2$。\n    b. 通过遍历 $m, n \\in \\{2,3,4\\}$ 并使用上面导出的公式来构建 $3 \\times 3$ 的费雪矩阵 $\\Gamma$。\n    c. 使用标准数值库函数（`numpy.linalg.eigh`）计算实对称矩阵 $\\Gamma$ 的本征值和本征向量，该函数会方便地按升序返回本征值。\n    d. 最小的本征值是 $\\lambda_{\\min}$，最大的是 $\\lambda_{\\max}$，与 $\\lambda_{\\min}$ 对应的本征向量是 $\\mathbf{e}_{\\min}$。\n    e. 计算可辨识性比率 $r = \\lambda_{\\min} / \\lambda_{\\max}$。\n    f. 为获得确定性输出，通过要求绝对值最大的元素为正来固定本征向量 $\\mathbf{e}_{\\min}$ 的符号。\n    g. 存储用例 $q$ 的结果，即 $[r, e_2, e_3, e_4]$。\n6.  将收集到的结果格式化为指定的字符串表示形式，作为最终输出。\n\n此过程系统地评估了随着质量比 $q$ 的增加，费雪矩阵的条件数如何恶化（即 $r$ 减小），并辨识出变得难以确定的校准参数的具体组合。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the EOB calibration identifiability problem using Fisher analysis.\n    \"\"\"\n    \n    # Define problem constants and numerical parameters\n    f_min = 3e-3\n    f_max = 3e-2\n    N_f = 5000\n    rho_tgt = 25.0\n    S0 = 1.0\n    f0 = 2e-2\n    \n    # Define the test cases from the problem statement\n    test_cases = [1.0, 4.0, 8.0, 12.0, 64.0]\n\n    # Set up the uniform frequency grid\n    f = np.linspace(f_min, f_max, N_f)\n\n    # Define the Power Spectral Density (PSD)\n    def Sn(freq):\n        x = freq / f0\n        return S0 * (x**(-4) + 2 * x**2 + 1)\n\n    # Calculate the PSD on the frequency grid\n    psd_vals = Sn(f)\n\n    # Pre-compute necessary integrals using the trapezoidal rule\n    # I(p) = integral(f^p / Sn(f) df)\n    integrals = {}\n    param_indices = [2, 3, 4]\n    \n    # Powers 'p' needed for Gamma_mn elements\n    p_values = set()\n    for m in param_indices:\n        for n in param_indices:\n            p_values.add((m + n - 7) / 3.0)\n    \n    # Power needed for the normalization integral\n    p_values.add(-7.0 / 3.0)\n\n    for p in p_values:\n        integrand = f**p / psd_vals\n        # np.trapz integrates using the composite trapezoidal rule.\n        integrals[p] = np.trapz(integrand, f)\n        \n    I_norm = integrals[-7.0 / 3.0]\n    \n    results = []\n    \n    for q in test_cases:\n        # Calculate symmetric mass ratio\n        nu = q / (1 + q)**2\n        \n        # Initialize the 3x3 Fisher matrix\n        Gamma = np.zeros((3, 3))\n        \n        # Construct the Fisher matrix\n        for i, m in enumerate(param_indices):\n            for j, n in enumerate(param_indices):\n                # Power for this matrix element\n                p_mn = (m + n - 7) / 3.0\n                I_mn = integrals[p_mn]\n                \n                # Calculate Gamma_mn\n                term_nu = nu**((m + n) / 2.0)\n                term_pi = np.pi**((m + n) / 3.0)\n                \n                Gamma[i, j] = (rho_tgt**2) * term_nu * term_pi * (I_mn / I_norm)\n                \n        # Compute eigenvalues and eigenvectors.\n        # eigh is used for Hermitian (or real symmetric) matrices.\n        # It returns eigenvalues in ascending order.\n        eigvals, eigvecs = np.linalg.eigh(Gamma)\n        \n        lambda_min = eigvals[0]\n        lambda_max = eigvals[-1]\n        \n        # The eigenvector for the smallest eigenvalue\n        e_min = eigvecs[:, 0]\n\n        # Fix sign of eigenvector for deterministic output.\n        # Make the element with the largest magnitude positive.\n        if e_min[np.argmax(np.abs(e_min))] < 0:\n            e_min *= -1\n            \n        # Ratio of smallest to largest eigenvalue\n        # Handle case where lambda_max could be zero or close to it, though unlikely here\n        if lambda_max > 0:\n            r = lambda_min / lambda_max\n        else:\n            r = 0.0 # Or some other indicator of singularity\n        \n        # Store result for this case: [r, e_alpha2, e_alpha3, e_alpha4]\n        case_result = [r] + e_min.tolist()\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # str(list) produces a string with spaces like '[0.1, 0.2, 0.3]'\n    # Joining these with a comma and wrapping with brackets gives the desired output.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3472703"}, {"introduction": "将EOB模型与数值相对论（NR）模拟进行校准，是现代引力波科学的基石。然而，NR模拟并非完美无缺，其自身也带有数值误差。本练习深入探讨校准过程的统计核心，你将学习如何在一个贝叶斯框架（Bayesian framework）中正确地整合这些NR误差棒（即异方差噪声, heteroscedastic noise）。通过与忽略误差差异的简化方法（即同方差噪声, homoscedastic noise）进行对比，你将量化地看到，一个严谨的统计处理对最终校准参数的后验分布会产生多么显著的影响 [@problem_id:3472659]。", "problem": "给定一个在数值相对论 (NR) 和引力波背景下的有效单体 (EOB) 模型的校准任务。目标是通过在线性化模型下拟合 NR 信息残差来校准 EOB 参数中的小偏移，并研究将 NR 误差棒作为异方差噪声纳入似然函数中，相对于同方差拟合，如何改变 EOB 参数的后验分布。\n\n假设存在以下校准设置。令 $n$ 为 NR 信息残差数据点的数量，令 $k$ 为正在校准的 EOB 参数偏移的数量。令 $\\boldsymbol{\\theta} \\in \\mathbb{R}^k$ 表示相对于参考 EOB 模型的小参数偏移，令 $\\mathbf{y} \\in \\mathbb{R}^n$ 表示测量 EOB 参考模型与 NR 派生的汇总量（例如，跨构型聚合的相位差异或失配）之间差异的残差。令 $\\mathbf{X} \\in \\mathbb{R}^{n \\times k}$ 为根据残差对 $\\boldsymbol{\\theta}$ 在参考点附近的线性化灵敏度构建的设计矩阵，因此线性化模型为\n$$\n\\mathbf{y} \\approx \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是一个随机噪声项。\n\n考虑 $\\boldsymbol{\\varepsilon}$ 的两种似然公式：\n- 由 NR 误差棒提供的异方差高斯噪声，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$，其中协方差矩阵 $\\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_n^2)$ 是对角矩阵。\n- 具有恒定方差的同方差高斯噪声，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I}_n)$。\n\n假设参数服从高斯先验分布，$\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，其中 $\\boldsymbol{\\Sigma}_0$ 是对称正定矩阵。\n\n从贝叶斯定理和上述线性高斯模型假设出发，推导异方差情况下的后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\boldsymbol{\\Sigma}, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$ 和同方差情况下的后验分布 $p(\\boldsymbol{\\theta} \\mid \\mathbf{y}, \\mathbf{X}, \\sigma^2, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$。然后实现一个程序，对于下面提供的每个测试用例，计算异方差和同方差后验之间的以下三个定量比较：\n1. 后验均值之差的欧几里得范数，即 $||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2$。\n2. 后验协方差矩阵行列式的比值，即 $\\det(\\boldsymbol{\\Sigma}_{\\text{het}})/\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})$。\n3. 两个多元正态后验之间的对称化 Kullback–Leibler 散度，即 $\\mathrm{KL}(\\mathcal{N}_{\\text{het}} \\,\\|\\, \\mathcal{N}_{\\text{hom}}) + \\mathrm{KL}(\\mathcal{N}_{\\text{hom}} \\,\\|\\, \\mathcal{N}_{\\text{het}})$。\n\n所有量都是无量纲的，不需要物理单位。不涉及角度。最终输出必须是十进制浮点数。\n\n使用以下测试套件。每个测试用例由 $(\\mathbf{X}, \\mathbf{y}, \\boldsymbol{\\sigma}^2, \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0, \\sigma^2)$ 指定，其中 $\\boldsymbol{\\sigma}^2$ 表示异方差方差的向量，$\\sigma^2$ 是同方差方差。\n\n- 测试用例 1（理想情况，中等异方差性）：\n  - $n=6, k=2$，\n  - $\\mathbf{X} = \\begin{bmatrix} 0.8  -0.1 \\\\ 1.2  0.0 \\\\ 0.5  0.3 \\\\ 1.5  -0.2 \\\\ 0.9  0.4 \\\\ 1.1  -0.3 \\end{bmatrix}$，\n  - $\\mathbf{y} = \\begin{bmatrix} -0.020 \\\\ 0.010 \\\\ 0.005 \\\\ -0.030 \\\\ 0.012 \\\\ -0.015 \\end{bmatrix}$，\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 1.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 1.5\\times 10^{-4} \\\\ 1.0\\times 10^{-4} \\\\ 2.5\\times 10^{-4} \\\\ 1.8\\times 10^{-4} \\end{bmatrix}$，\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$，\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n- 测试用例 2（边界条件，近似同方差）：\n  - $n=5, k=2$，\n  - $\\mathbf{X} = \\begin{bmatrix} 0.7  0.2 \\\\ 0.9  -0.1 \\\\ 1.1  0.0 \\\\ 1.3  0.3 \\\\ 0.8  -0.2 \\end{bmatrix}$，\n  - $\\mathbf{y} = \\begin{bmatrix} 0.006 \\\\ -0.012 \\\\ 0.008 \\\\ 0.002 \\\\ -0.009 \\end{bmatrix}$，\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\end{bmatrix}$，\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$，\n  - $\\sigma^2 = 2.0\\times 10^{-4}$。\n- 测试用例 3（边缘情况，一个极其精确的数据点）：\n  - $n=6, k=2$，\n  - $\\mathbf{X} = \\begin{bmatrix} 1.4  0.1 \\\\ 0.6  -0.2 \\\\ 1.0  0.2 \\\\ 0.7  0.0 \\\\ 1.2  -0.3 \\\\ 0.9  0.4 \\end{bmatrix}$，\n  - $\\mathbf{y} = \\begin{bmatrix} 0.015 \\\\ -0.010 \\\\ 0.005 \\\\ 0.000 \\\\ -0.020 \\\\ 0.010 \\end{bmatrix}$，\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 1.0\\times 10^{-6} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\\\ 3.0\\times 10^{-4} \\end{bmatrix}$，\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$，\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n- 测试用例 4（边缘情况，两个高度不确定的数据点）：\n  - $n=6, k=2$，\n  - $\\mathbf{X} = \\begin{bmatrix} 0.5  0.5 \\\\ 1.0  -0.4 \\\\ 0.8  0.1 \\\\ 1.3  -0.1 \\\\ 0.6  0.3 \\\\ 1.1  -0.2 \\end{bmatrix}$，\n  - $\\mathbf{y} = \\begin{bmatrix} -0.005 \\\\ 0.020 \\\\ -0.010 \\\\ 0.015 \\\\ -0.004 \\\\ 0.008 \\end{bmatrix}$，\n  - $\\boldsymbol{\\sigma}^2 = \\begin{bmatrix} 2.0\\times 10^{-4} \\\\ 1.0\\times 10^{-2} \\\\ 2.0\\times 10^{-4} \\\\ 1.0\\times 10^{-2} \\\\ 2.5\\times 10^{-4} \\\\ 2.0\\times 10^{-4} \\end{bmatrix}$，\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$，\n  - $\\boldsymbol{\\Sigma}_0 = \\mathrm{diag}(0.05^2, 0.05^2)$，\n  - $\\sigma^2 = \\mathrm{mean}(\\boldsymbol{\\sigma}^2)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。对于每个测试用例，按此顺序输出三个十进制浮点数：$||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2$，$\\det(\\boldsymbol{\\Sigma}_{\\text{het}})/\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})$，以及对称化 Kullback–Leibler 散度。将这四个测试用例的三元组连接成一个扁平列表，总共得到十二个浮点数。例如，最终输出格式必须是\n$$\n[\\text{case1\\_norm},\\text{case1\\_det\\_ratio},\\text{case1\\_KL\\_sym},\\text{case2\\_norm},\\dots,\\text{case4\\_KL\\_sym}].\n$$", "solution": "目标是推导有效单体 (EOB) 参数偏移 $\\boldsymbol{\\theta}$ 在两种不同噪声模型（异方差和同方差）下的后验分布，然后计算比较这两种后验分布的定量指标。推导从贝叶斯定理开始，该定理指出参数在给定数据下的后验概率与似然和先验的乘积成正比：\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}) \\propto p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) p(\\boldsymbol{\\theta})\n$$\n问题定义了一个线性模型 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$，一个噪声项 $\\boldsymbol{\\varepsilon}$ 的高斯似然，以及参数 $\\boldsymbol{\\theta}$ 的高斯先验。由于高斯似然的共轭先验是高斯分布，因此得到的后验也将是高斯分布，即 $\\boldsymbol{\\theta} \\mid \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{post}}, \\boldsymbol{\\Sigma}_{\\text{post}})$。我们可以通过分析后验概率密度函数的指数部分来确定后验均值 $\\boldsymbol{\\mu}_{\\text{post}}$ 和协方差 $\\boldsymbol{\\Sigma}_{\\text{post}}$。\n\n对于 $\\boldsymbol{\\theta} \\in \\mathbb{R}^k$ 的先验分布给定为 $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，所以其概率密度函数为：\n$$\np(\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^T \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right)\n$$\n似然函数 $p(\\mathbf{y} \\mid \\boldsymbol{\\theta})$ 取决于噪声 $\\boldsymbol{\\varepsilon}$ 的模型。一般地，对于 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{C})$，似然为：\n$$\np(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) \\right)\n$$\n因此，对数后验与指数之和成正比：\n$$\n\\log p(\\boldsymbol{\\theta} \\mid \\mathbf{y}) = -\\frac{1}{2} \\left[ (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^T \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right] + \\text{const.}\n$$\n我们展开二次型并对涉及 $\\boldsymbol{\\theta}$ 的项进行分组：\n$$\n\\begin{aligned}\n\\text{Exponent} = - \\frac{1}{2} \\left[ \\mathbf{y}^T\\mathbf{C}^{-1}\\mathbf{y} - 2\\boldsymbol{\\theta}^T\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\theta}^T\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X}\\boldsymbol{\\theta} \\right. \\\\\n \\qquad \\left. + \\boldsymbol{\\theta}^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\boldsymbol{\\mu}_0^T\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 \\right] \\\\\n= - \\frac{1}{2} \\left[ \\boldsymbol{\\theta}^T(\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})\\boldsymbol{\\theta} - 2\\boldsymbol{\\theta}^T(\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0) \\right] + \\text{const.}\n\\end{aligned}\n$$\n通过配方法，我们可以将其与多元高斯分布 $\\mathcal{N}(\\boldsymbol{\\mu}_{\\text{post}}, \\boldsymbol{\\Sigma}_{\\text{post}})$ 的指数形式 $-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}})^T \\boldsymbol{\\Sigma}_{\\text{post}}^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}})$ 进行匹配。比较 $\\boldsymbol{\\theta}$ 的二次项和线性项，我们可以确定后验精度矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}$ 和均值 $\\boldsymbol{\\mu}_{\\text{post}}$。\n\n后验精度矩阵是：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}}^{-1} = \\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1}\n$$\n后验协方差矩阵是它的逆：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}} = (\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})^{-1}\n$$\n后验均值由 $\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}\\boldsymbol{\\mu}_{\\text{post}} = \\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0$ 给出，即：\n$$\n\\boldsymbol{\\mu}_{\\text{post}} = \\boldsymbol{\\Sigma}_{\\text{post}} (\\mathbf{X}^T\\mathbf{C}^{-1}\\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0)\n$$\n\n现在我们将这些一般结果应用于两种具体情况。\n\n**1. 异方差后验**\n噪声协方差为 $\\mathbf{C} = \\boldsymbol{\\Sigma} = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_n^2)$。其逆矩阵为 $\\boldsymbol{\\Sigma}^{-1} = \\mathrm{diag}(1/\\sigma_1^2, \\dots, 1/\\sigma_n^2)$。\n后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{het}}$ 为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{het}} = (\\mathbf{X}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1})^{-1}\n$$\n后验均值 $\\boldsymbol{\\mu}_{\\text{het}}$ 为：\n$$\n\\boldsymbol{\\mu}_{\\text{het}} = \\boldsymbol{\\Sigma}_{\\text{het}} (\\mathbf{X}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0)\n$$\n后验分布为 $\\mathcal{N}_{\\text{het}} = \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{het}}, \\boldsymbol{\\Sigma}_{\\text{het}})$。\n\n**2. 同方差后验**\n噪声协方差为 $\\mathbf{C} = \\sigma^2 \\mathbf{I}_n$，其中 $\\mathbf{I}_n$ 是 $n \\times n$ 的单位矩阵。其逆矩阵为 $\\mathbf{C}^{-1} = \\frac{1}{\\sigma^2}\\mathbf{I}_n$。\n后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{hom}}$ 为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{hom}} = \\left(\\frac{1}{\\sigma^2}\\mathbf{X}^T \\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1}\\right)^{-1}\n$$\n后验均值 $\\boldsymbol{\\mu}_{\\text{hom}}$ 为：\n$$\n\\boldsymbol{\\mu}_{\\text{hom}} = \\boldsymbol{\\Sigma}_{\\text{hom}} \\left(\\frac{1}{\\sigma^2}\\mathbf{X}^T \\mathbf{y} + \\boldsymbol{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0\\right)\n$$\n后验分布为 $\\mathcal{N}_{\\text{hom}} = \\mathcal{N}(\\boldsymbol{\\mu}_{\\text{hom}}, \\boldsymbol{\\Sigma}_{\\text{hom}})$。\n\n**比较指标**\n在推导出后验均值和协方差后，我们定义三个比较指标。\n1.  **后验均值之差的欧几里得范数：**\n    $$\n    ||\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}||_2 = \\sqrt{ (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}})^T (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}) }\n    $$\n2.  **后验协方差矩阵行列式的比值：**\n    $$\n    \\frac{\\det(\\boldsymbol{\\Sigma}_{\\text{het}})}{\\det(\\boldsymbol{\\Sigma}_{\\text{hom}})}\n    $$\n3.  **对称化 Kullback–Leibler 散度：** 对于两个维度为 $k$ 的多元正态分布 $\\mathcal{N}_1 = \\mathcal{N}(\\boldsymbol{\\mu}_1, \\boldsymbol{\\Sigma}_1)$ 和 $\\mathcal{N}_2 = \\mathcal{N}(\\boldsymbol{\\mu}_2, \\boldsymbol{\\Sigma}_2)$，KL 散度为\n    $$\n    \\mathrm{KL}(\\mathcal{N}_1 \\,\\|\\, \\mathcal{N}_2) = \\frac{1}{2} \\left[ \\log\\left(\\frac{\\det \\boldsymbol{\\Sigma}_2}{\\det \\boldsymbol{\\Sigma}_1}\\right) - k + \\mathrm{Tr}(\\boldsymbol{\\Sigma}_2^{-1} \\boldsymbol{\\Sigma}_1) + (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)^T \\boldsymbol{\\Sigma}_2^{-1} (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1) \\right]\n    $$\n    对称化 KL 散度为 $\\mathrm{KL}(\\mathcal{N}_{\\text{het}} \\,\\|\\, \\mathcal{N}_{\\text{hom}}) + \\mathrm{KL}(\\mathcal{N}_{\\text{hom}} \\,\\|\\, \\mathcal{N}_{\\text{het}})$。经过代数简化后，得到：\n    $$\n    \\frac{1}{2} \\left[ \\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\text{het}}^{-1}\\boldsymbol{\\Sigma}_{\\text{hom}} + \\boldsymbol{\\Sigma}_{\\text{hom}}^{-1}\\boldsymbol{\\Sigma}_{\\text{het}} - 2\\mathbf{I}_k) + (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}})^T (\\boldsymbol{\\Sigma}_{\\text{het}}^{-1} + \\boldsymbol{\\Sigma}_{\\text{hom}}^{-1}) (\\boldsymbol{\\mu}_{\\text{het}} - \\boldsymbol{\\mu}_{\\text{hom}}) \\right]\n    $$\n实现将为每个测试用例计算这些量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the EOB calibration problem for the given test cases.\n    \"\"\"\n    \n    # Define a helper function to compute posterior and comparison metrics for one case.\n    def compute_posterior_comparison(X, y, sigma_het_sq, mu0, Sigma0, sigma_hom_sq):\n        \"\"\"\n        Calculates the posterior distributions for heteroscedastic and homoscedastic\n        models and computes the three comparison metrics.\n        \"\"\"\n        n, k = X.shape\n\n        # Reshape vectors to be column vectors (n x 1 or k x 1)\n        y = y.reshape(-1, 1)\n        sigma_het_sq = sigma_het_sq.reshape(-1, 1)\n        mu0 = mu0.reshape(-1, 1)\n\n        # Pre-compute prior precision matrix\n        Sigma0_inv = np.linalg.inv(Sigma0)\n\n        # 1. Heteroscedastic Posterior Calculation\n        # The noise covariance inverse is diagonal with 1/sigma_i^2 on the diagonal.\n        # Efficiently compute X.T @ Sigma_inv @ X and X.T @ Sigma_inv @ y\n        # by scaling rows of X and elements of y before matrix multiplication.\n        W_het = 1.0 / sigma_het_sq.flatten()\n        X_T_S_inv_X_het = X.T * W_het @ X\n        X_T_S_inv_y_het = X.T @ (W_het * y.flatten())\n        X_T_S_inv_y_het = X_T_S_inv_y_het.reshape(-1, 1)\n\n        Sigma_post_het_inv = X_T_S_inv_X_het + Sigma0_inv\n        Sigma_post_het = np.linalg.inv(Sigma_post_het_inv)\n        mu_post_het = Sigma_post_het @ (X_T_S_inv_y_het + Sigma0_inv @ mu0)\n\n        # 2. Homoscedastic Posterior Calculation\n        const_inv_var_hom = 1.0 / sigma_hom_sq\n        Sigma_post_hom_inv = const_inv_var_hom * (X.T @ X) + Sigma0_inv\n        Sigma_post_hom = np.linalg.inv(Sigma_post_hom_inv)\n        mu_post_hom = Sigma_post_hom @ (const_inv_var_hom * (X.T @ y) + Sigma0_inv @ mu0)\n\n        # 3. Compute Comparison Metrics\n        # Metric 1: Euclidean norm of the difference between posterior means\n        delta_mu = mu_post_het - mu_post_hom\n        norm_diff = np.linalg.norm(delta_mu)\n\n        # Metric 2: Ratio of the determinants of the posterior covariances\n        det_het = np.linalg.det(Sigma_post_het)\n        det_hom = np.linalg.det(Sigma_post_hom)\n        det_ratio = det_het / det_hom\n\n        # Metric 3: Symmetrized Kullback-Leibler divergence\n        trace_term = np.trace(Sigma_post_hom_inv @ Sigma_post_het + Sigma_post_het_inv @ Sigma_post_hom - 2 * np.eye(k))\n        mahalanobis_term = delta_mu.T @ (Sigma_post_het_inv + Sigma_post_hom_inv) @ delta_mu\n        kl_sym = 0.5 * (trace_term + mahalanobis_term.item())\n\n        return (norm_diff, det_ratio, kl_sym)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"X\": np.array([[0.8, -0.1], [1.2, 0.0], [0.5, 0.3], [1.5, -0.2], [0.9, 0.4], [1.1, -0.3]]),\n            \"y\": np.array([-0.020, 0.010, 0.005, -0.030, 0.012, -0.015]),\n            \"sigma_het_sq\": np.array([1.0e-4, 2.0e-4, 1.5e-4, 1.0e-4, 2.5e-4, 1.8e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([1.0e-4, 2.0e-4, 1.5e-4, 1.0e-4, 2.5e-4, 1.8e-4]))\n        },\n        # Test Case 2\n        {\n            \"X\": np.array([[0.7, 0.2], [0.9, -0.1], [1.1, 0.0], [1.3, 0.3], [0.8, -0.2]]),\n            \"y\": np.array([0.006, -0.012, 0.008, 0.002, -0.009]),\n            \"sigma_het_sq\": np.array([2.0e-4, 2.0e-4, 2.0e-4, 2.0e-4, 2.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": 2.0e-4\n        },\n        # Test Case 3\n        {\n            \"X\": np.array([[1.4, 0.1], [0.6, -0.2], [1.0, 0.2], [0.7, 0.0], [1.2, -0.3], [0.9, 0.4]]),\n            \"y\": np.array([0.015, -0.010, 0.005, 0.000, -0.020, 0.010]),\n            \"sigma_het_sq\": np.array([1.0e-6, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([1.0e-6, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4, 3.0e-4]))\n        },\n        # Test Case 4\n        {\n            \"X\": np.array([[0.5, 0.5], [1.0, -0.4], [0.8, 0.1], [1.3, -0.1], [0.6, 0.3], [1.1, -0.2]]),\n            \"y\": np.array([-0.005, 0.020, -0.010, 0.015, -0.004, 0.008]),\n            \"sigma_het_sq\": np.array([2.0e-4, 1.0e-2, 2.0e-4, 1.0e-2, 2.5e-4, 2.0e-4]),\n            \"mu0\": np.array([0.0, 0.0]),\n            \"Sigma0\": np.diag([0.05**2, 0.05**2]),\n            \"sigma_hom_sq\": np.mean(np.array([2.0e-4, 1.0e-2, 2.0e-4, 1.0e-2, 2.5e-4, 2.0e-4]))\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        norm_diff, det_ratio, kl_sym = compute_posterior_comparison(\n            case[\"X\"],\n            case[\"y\"],\n            case[\"sigma_het_sq\"],\n            case[\"mu0\"],\n            case[\"Sigma0\"],\n            case[\"sigma_hom_sq\"]\n        )\n        results.extend([norm_diff, det_ratio, kl_sym])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3472659"}]}