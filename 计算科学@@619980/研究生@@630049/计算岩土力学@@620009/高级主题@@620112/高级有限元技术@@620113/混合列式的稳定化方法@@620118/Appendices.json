{"hands_on_practices": [{"introduction": "选择合适的稳定化参数是设计稳定混合有限元格式的关键一步。一个鲁棒的参数不仅要能抑制伪解，还必须在网格加密 ($h_K \\to 0$) 或材料接近不可压缩极限时保持稳定性和精度。本练习 [@problem_id:3562747] 将引导你通过分析舒尔补算子和利用逆不等式，推导出稳定化参数与网格尺寸 $h_K$ 和材料属性（如剪切模量 $G$）之间的正确标度关系。", "problem": "考虑在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^d$ 上，带有体力 $\\boldsymbol{f}$ 的准静态、线性、各向同性弹性力学的位移-压力混合格式。令 $\\boldsymbol{u}$ 表示位移，$p$ 表示标量压力（体积应力）。材料由剪切模量 $G$ 和体积模量 $K_b$ 表征。混合弱形式旨在寻找 $(\\boldsymbol{u},p)$，使其对所有测试函数 $(\\boldsymbol{v},q)$ 均满足：\n$$(a)\\quad \\int_{\\Omega} 2G\\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}):\\boldsymbol{\\varepsilon}(\\boldsymbol{v})\\, \\mathrm{d}x \\;-\\; \\int_{\\Omega} p\\, \\nabla\\cdot \\boldsymbol{v}\\, \\mathrm{d}x \\;=\\; \\int_{\\Omega} \\boldsymbol{f}\\cdot \\boldsymbol{v}\\, \\mathrm{d}x,$$\n$$(b)\\quad -\\int_{\\Omega} q\\, \\nabla\\cdot \\boldsymbol{u}\\, \\mathrm{d}x \\;-\\; \\int_{\\Omega} \\frac{1}{K_b}\\, p\\, q\\, \\mathrm{d}x \\;=\\; 0,$$\n其中 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$。假设我们使用有限元法（FEM）对该系统进行离散化，在单元直径为 $h_K$ 的协调单纯形网格 $\\mathcal{T}_h$ 上，对 $\\boldsymbol{u}$ 和 $p$ 均采用同阶连续分片线性元。由于同阶元对违反了 Brezzi–Babuška inf–sup 条件，我们添加一个形式如下的相容压力梯度稳定项\n$$s_h(p_h,q_h) \\;=\\; \\sum_{K\\in \\mathcal{T}_h} \\gamma_K \\int_K \\nabla p_h \\cdot \\nabla q_h \\, \\mathrm{d}x,$$\n其中 $\\gamma_K > 0$ 是逐单元稳定化参数。目标是选择 $\\gamma_K$，以平衡条件数和精度，使其关于网格尺寸和材料参数一致。\n\n仅使用关于 (i) 混合算子及其Schur补的结构，(ii) Brezzi 稳定机制，以及 (iii) 连续分片线性函数的标准反不等式等基本事实，确定一个选择 $\\gamma_K$ 的鲁棒策略，该策略应满足：\n- 当 $h_K \\to 0$ 时，与 $h_K$ 正确地缩放，以避免过稳定和相容性损失，\n- 对近不可压缩极限 $K_b \\to \\infty$ 不敏感，\n- 使稳定化贡献 $s_h(\\cdot,\\cdot)$ 的量级与由弹性块导出的压力Schur补的量级相等，从而使压力子系统关于 $G$ 一致良态。\n\n以下哪种方案最能满足这些要求？\n\nA. $\\gamma_K \\;=\\; c_0 \\,\\dfrac{h_K^2}{G}$，其中 $c_0$ 是一个与网格和材料无关的 $\\mathcal{O}(1)$ 阶常数（例如，$c_0 \\in [\\,10^{-1},\\,1\\,]$），可选择性地由一个单元形状正则性因子进行调整，对于形状正则的网格，该因子保持有界。\n\nB. $\\gamma_K \\;=\\; c_0 \\, G \\, h_K^2$，选择稳定化强度使其随刚度增加而增加，从而在近不可压缩极限下，稳定化项占主导地位。\n\nC. $\\gamma_K \\;=\\; \\dfrac{c_0}{h_K}$，与材料参数无关，从而仅通过网格加密来增强稳定化，以抑制伪压力模式。\n\nD. $\\gamma_K \\;=\\; c_0 \\, \\dfrac{K_b}{h_K^2}$，将稳定化与体积模量挂钩，以便在材料趋于不可压缩时更强地惩罚压力变化。\n\n选择最合适的选项。", "solution": "我们从第一性原理推导适当的缩放关系。该混合系统将位移上的对称、矫顽弹性双线性形式与压力上的散度约束耦合在一起。同阶元的离散inf-sup条件的不足可以通过添加一个压力梯度稳定项 $s_h(\\cdot,\\cdot)$ 来补偿，该项是相容的，并且当 $h_K \\to 0$ 时以正确的速率趋于零。三个基本要素是：\n\n(i) 混合算子和Schur补的结构。将离散层面上的分块系统写为\n$$\n\\begin{bmatrix}\nA  & B^{\\top} \\\\\nB  & -\\tfrac{1}{K_b} M_p\n\\end{bmatrix}\n\\begin{bmatrix}\n\\boldsymbol{u}_h \\\\ p_h\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\boldsymbol{f}_h \\\\ 0\n\\end{bmatrix},\n$$\n其中 $A$ 是由 $a(\\cdot,\\cdot) = \\int_{\\Omega} 2G\\, \\boldsymbol{\\varepsilon}(\\cdot):\\boldsymbol{\\varepsilon}(\\cdot)\\, \\mathrm{d}x$ 导出的离散弹性算子，$B$ 编码了离散散度，$M_p$ 是压力上的 $L^2$ 质量矩阵。消去 $\\boldsymbol{u}_h$ 得到压力上的离散Schur补：\n$$\nS_h \\;=\\; -\\tfrac{1}{K_b} M_p \\;-\\; B\\,A^{-1}\\,B^{\\top}.\n$$\n算子 $B\\,A^{-1}\\,B^{\\top}$ 表示通过位移柔度实现的压力到压力的映射。由于 $A$ 与 $G$ 成比例缩放（即 $A \\sim G\\,K_u$，其中 $K_u$ 是无量纲刚度），因此 $A^{-1}$ 在能量单位上按 $G^{-1}$ 的方式缩放。因此，$B\\,A^{-1}\\,B^{\\top}$ 的缩放方式类似于 $G^{-1}$ 乘以一个类压力质量算子。因此，关于 $K_b$ 一致地（包括极限 $K_b \\to \\infty$），压力块从力学部分获得一个量级为 $\\mathcal{O}(G^{-1})$ 的有效稳定化。\n\n(ii) 稳定化的作用。添加项 $s_h(p_h,q_h) = \\sum_K \\gamma_K \\int_K \\nabla p_h \\cdot \\nabla q_h \\,\\mathrm{d}x$ 应该 (a) 控制违反离散inf-sup条件的压力模式，并且 (b) 是相容的，因此对于光滑的压力，它必须在极限 $h_K \\to 0$ 时消失。为了将 $s_h$ 与类质量控制项进行比较，我们使用反不等式。\n\n(iii) 连续分片线性函数的反不等式。对于在 $K$ 上的分片线性函数 $p_h$，一个标准的反估计给出\n$$\n\\|\\nabla p_h\\|_{0,K}^2 \\;\\le\\; C_{\\mathrm{inv}}\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2,\n$$\n其中 $C_{\\mathrm{inv}}$ 仅依赖于形状正则性。因此，\n$$\ns_h(p_h,p_h) \\;=\\; \\sum_K \\gamma_K \\|\\nabla p_h\\|_{0,K}^2 \\;\\le\\; \\sum_K \\gamma_K\\, C_{\\mathrm{inv}}\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2.\n$$\n因此，选择与 $h_K^2$ 成正比的 $\\gamma_K$ 会将 $s_h(\\cdot,\\cdot)$ 转换为一个类 $L^2$ 控制项，其系数与该比例常数成正比。特别地，如果 $\\gamma_K \\sim h_K^2 / G$，那么\n$$\ns_h(p_h,p_h) \\;\\lesssim\\; \\sum_K \\big(h_K^2/G\\big)\\, h_K^{-2}\\, \\|p_h\\|_{0,K}^2 \\;\\sim\\; G^{-1}\\, \\|p_h\\|_{0,\\Omega}^2,\n$$\n这与 $B\\,A^{-1}\\,B^{\\top}$ 的 $G^{-1}$ 缩放关系相匹配。这种匹配平衡了压力Schur补，从而使得整个压力块保持良态，且与 $G$ 和网格尺寸无关。此外，由于 $\\gamma_K \\propto h_K^2$，该稳定项是高阶相容的：对于光滑的 $p$，$\\|\\nabla p\\|_{0,K}^2$ 是有界的，而当 $h_K \\to 0$ 时 $\\gamma_K \\to 0$，从而避免了过稳定。\n\n对 $K_b$ 的不敏感性：在近不可压缩极限 $K_b \\to \\infty$ 下，$-(1/K_b)M_p$ 项消失，压力Schur补中剩下的唯一与材料相关的缩放关系就是 $B\\,A^{-1}\\,B^{\\top} \\sim G^{-1}$ 的缩放关系。选择 $\\gamma_K \\sim h_K^2 / G$ 使得稳定化与此尺度相称，因此对闭锁是鲁棒的。\n\n我们现在来评估各个选项。\n\n选项 A: $\\gamma_K = c_0\\, h_K^2/G$，其中 $c_0 = \\mathcal{O}(1)$。这完全实现了上述推理。选择 $\\gamma_K \\propto h_K^2$ 保证了相容性，而除以 $G$ 则匹配了力学Schur补的 $G^{-1}$ 缩放关系。仅引入有界的形状正则性调整保持了网格无关性。该选择对 $K_b$ 不敏感，并平衡了条件数和精度。结论——正确。\n\n选项 B: $\\gamma_K = c_0\\, G\\, h_K^2$。该值随 $G$ 增长，因此 $s_h(p_h,p_h) \\lesssim G\\, \\|p_h\\|^2$，当 $G$ 增大时，这会压倒 $B\\,A^{-1}\\,B^{\\top}$ 的自然 $G^{-1}$ 尺度。在近不可压缩区域（相对于压力尺度，$G$ 很大），这会导致过稳定，降低精度，并可能通过施加一个人为的刚性压力梯度罚项来损害收敛性。结论——不正确。\n\n选项 C: $\\gamma_K = c_0/h_K$。在基于梯度的稳定化所要求的意义上，当 $h_K \\to 0$ 时，该项不趋于零。实际上，在 $d=\\!3$ 时，$s_h(p_h,p_h) \\lesssim (c_0/h_K)\\, h_K^{-2}\\, \\|p_h\\|^2 \\sim c_0\\, h_K^{-3}\\, \\|p_h\\|^2$（在其他维度也有类似的爆破），它在网格加密时发散，并破坏相容性。此外，它忽略了材料缩放关系，无法平衡 $B\\,A^{-1}\\,B^{\\top} \\sim G^{-1}$。结论——不正确。\n\n选项 D: $\\gamma_K = c_0\\, K_b/h_K^2$。这一选择使得 $s_h(p_h,p_h)$ 按 $K_b\\, h_K^{-2}\\, \\|p_h\\|^2$ 的方式缩放，当 $h_K \\to 0$ 和 $K_b \\to \\infty$ 时都会发散。在近不可压缩极限下，稳定化项占主导地位，导致类闭锁行为并破坏精度。它还违反了稳定化应对 $K_b$ 不敏感以及随网格加密适当消失的要求。结论——不正确。\n\n因此，鲁棒且相容的策略是将 $\\gamma_K$ 设置为与 $h_K^2$ 成正比，与 $G$ 成反比，并带有一个与网格和材料参数无关的 $\\mathcal{O}(1)$ 常数，如选项 A 所示。", "answer": "$$\\boxed{A}$$", "id": "3562747"}, {"introduction": "在处理多孔介质固结等瞬态问题时，稳定化分析需要考虑时间步长 $\\Delta t$ 的影响。特别是在不排水极限下，物理项提供的稳定性可能会减弱，因此需要稳定化项来保证数值格式在所有时间步长下的一致稳定性。本练习 [@problem_id:3562719] 将演示如何将舒尔补分析应用于时间离散格式，从而推导出稳定化系数 $\\gamma(\\Delta t)$ 随 $\\Delta t$ 变化的标度律。", "problem": "考虑有界 Lipschitz 域中的准静态线性多孔弹性问题，该问题由 Biot 方程建模。设 $\\Omega \\subset \\mathbb{R}^{d}$ 为该域，其位移满足均匀 Dirichlet 条件，孔隙流体边界为不渗透边界。令 $(\\boldsymbol{u}(t), p(t))$ 分别表示位移场和孔隙压力场。应力由 $\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,(\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I} - \\alpha\\,p\\,\\boldsymbol{I}$ 给出，其中 $\\mu > 0$ 和 $\\lambda > 0$ 是 Lamé 参数，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) := \\frac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top})$ 是小应变张量，$\\boldsymbol{I}$ 是单位张量，$\\alpha \\in (0,1]$ 是 Biot 系数。质量守恒方程为 $S\\,\\dot{p} + \\alpha\\,\\nabla \\cdot \\dot{\\boldsymbol{u}} - \\nabla \\cdot (\\boldsymbol{K}\\,\\nabla p) = 0$，其中 $S \\ge 0$ 是比储水系数，$\\boldsymbol{K}$ 是导水率张量。假设准静态力学平衡（忽略惯性），并且在不排水极限下流体流动可忽略不计，因此扩散项 $\\nabla \\cdot (\\boldsymbol{K}\\,\\nabla p)$ 可忽略不计。\n\n使用时间步长为 $\\Delta t > 0$ 的后向欧拉法对时间进行离散，从而得到在时间 $t^{n}$ 时对 $(\\boldsymbol{u}^{n}, p^{n})$ 的混合有限元近似，其中位移和压力使用同阶形函数。为确保此同阶混合格式的稳定性，引入一个压力稳定化泛函（例如，连续内部罚 (CIP) 类型），并乘以一个可能依赖于时间步长的稳定化系数 $\\gamma(\\Delta t)$。稳定化泛函的具体形式未指定；但它以附加项的形式出现在离散压力方程的双线性形式中，并由 $\\gamma(\\Delta t)$ 进行缩放。\n\n从控制方程、本构定义和后向欧拉时间离散出发，并利用流体流动可忽略的准静态不排水极限的结构，推导稳定化系数 $\\gamma(\\Delta t)$ 必须如何随 $\\Delta t$ 缩放，以使离散格式的稳定性在不排水极限下关于 $\\Delta t$是一致的。请用一个关于 $\\Delta t$、Biot 系数 $\\alpha$、Lamé 参数 $\\lambda$ 和比储水系数 $S$ 的单一封闭形式表达式来表示你的答案，该表达式可含一个不依赖于材料参数或 $\\Delta t$ 的无量纲正常数因子 $c_{s} > 0$。不要计算任何数值。你的最终答案必须是一个单一的解析表达式。", "solution": "用户希望找到准静态多孔弹性问题混合有限元格式中稳定化参数的缩放关系。\n\n### 步骤 1：问题公式化\n\n在不排水极限下（忽略导水率项 $\\nabla \\cdot (\\boldsymbol{K}\\,\\nabla p)$），准静态线性多孔弹性的控制方程由以下公式给出：\n1.  动量平衡：$\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}, p) = \\boldsymbol{0}$\n2.  质量守恒：$S\\,\\dot{p} + \\alpha\\,\\nabla \\cdot \\dot{\\boldsymbol{u}} = 0$\n\n其中，$\\boldsymbol{u}$ 是固体位移， $p$ 是孔隙压力， $S$ 是比储水系数， $\\alpha$ 是 Biot-Willis 系数。总应力张量 $\\boldsymbol{\\sigma}$ 定义为：\n$$ \\boldsymbol{\\sigma}(\\boldsymbol{u}, p) = 2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\boldsymbol{I} - \\alpha\\,p\\,\\boldsymbol{I} $$\n其中 $\\mu$ 和 $\\lambda$ 是 Lamé 参数，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u})$ 是线性应变张量，$\\boldsymbol{I}$ 是单位张量。动量平衡方程可以写成 $-\\mathcal{L}\\boldsymbol{u} + \\alpha\\nabla p = \\boldsymbol{0}$，其中 $\\mathcal{L}\\boldsymbol{u} = -\\nabla \\cdot (2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\boldsymbol{I})$ 是线性弹性算子。\n\n### 步骤 2：弱形式与时间离散\n\n设 $\\boldsymbol{V}$ 为位移测试函数空间， $Q$ 为压力测试函数空间。控制方程的弱形式为：\n寻找 $(\\boldsymbol{u}, p) \\in \\boldsymbol{V} \\times Q$，使得对于所有 $(\\boldsymbol{v}, q) \\in \\boldsymbol{V} \\times Q$：\n$$ (2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\boldsymbol{I}, \\boldsymbol{\\varepsilon}(\\boldsymbol{v})) - \\alpha(p, \\nabla \\cdot \\boldsymbol{v}) = 0 $$\n$$ (S\\,\\dot{p}, q) + \\alpha(\\nabla \\cdot \\dot{\\boldsymbol{u}}, q) = 0 $$\n其中 $(\\cdot, \\cdot)$ 表示在域 $\\Omega$ 上的 $L^2$ 内积。我们定义弹性双线性形式 $a(\\boldsymbol{u}, \\boldsymbol{v}) = (2\\mu\\,\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\boldsymbol{I}, \\boldsymbol{\\varepsilon}(\\boldsymbol{v}))$。\n\n应用时间步长为 $\\Delta t > 0$ 的后向欧拉格式，时间导数近似为 $\\dot{p} \\approx (p^n - p^{n-1})/\\Delta t$ 和 $\\dot{\\boldsymbol{u}} \\approx (\\boldsymbol{u}^n - \\boldsymbol{u}^{n-1})/\\Delta t$，其中上标 $n$ 表示当前时间步。在时间 $t^n$ 的半离散系统为：\n$$ a(\\boldsymbol{u}^n, \\boldsymbol{v}) - \\alpha(p^n, \\nabla \\cdot \\boldsymbol{v}) = 0 $$\n$$ \\frac{S}{\\Delta t}(p^n, q) + \\frac{\\alpha}{\\Delta t}(\\nabla \\cdot \\boldsymbol{u}^n, q) = \\frac{S}{\\Delta t}(p^{n-1}, q) + \\frac{\\alpha}{\\Delta t}(\\nabla \\cdot \\boldsymbol{u}^{n-1}, q) $$\n\n### 步骤 3：有限元离散与稳定化\n\n我们引入有限元子空间 $\\boldsymbol{V}_h \\subset \\boldsymbol{V}$ 和 $Q_h \\subset Q$。对于同阶近似，标准的离散格式是不稳定的。为确保稳定性，一个由系数 $\\gamma(\\Delta t)$ 缩放的稳定化项被添加到离散压力方程中。在时间 $t^n$ 时，未知系数向量 $(\\mathbf{U}^n, \\mathbf{P}^n)$ 的全离散系统为：\n$$ a(\\boldsymbol{u}_h^n, \\boldsymbol{v}_h) - \\alpha(p_h^n, \\nabla \\cdot \\boldsymbol{v}_h) = 0 $$\n$$ \\frac{\\alpha}{\\Delta t}(\\nabla \\cdot \\boldsymbol{u}_h^n, q_h) + \\frac{S}{\\Delta t}(p_h^n, q_h) + \\gamma(\\Delta t) c(p_h^n, q_h) = \\text{RHS}(q_h) $$\n其中 $c(p_h, q_h)$ 是对应于压力稳定化泛函的对称、半正定双线性形式。\n\n该系统可以写成块矩阵形式：\n$$\n\\begin{pmatrix}\n\\mathbf{A}  & -\\alpha \\mathbf{B} \\\\\n\\frac{\\alpha}{\\Delta t} \\mathbf{B}^T  & \\frac{S}{\\Delta t} \\mathbf{M}_p + \\gamma(\\Delta t) \\mathbf{C}_p\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{U}^n \\\\\n\\mathbf{P}^n\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{F}_u \\\\\n\\mathbf{F}_p\n\\end{pmatrix}\n$$\n此处，$\\mathbf{A}$ 是弹性刚度矩阵（来自 $a(\\cdot,\\cdot)$），$\\mathbf{B}$ 是离散梯度矩阵（来自 $(p_h, \\nabla \\cdot \\boldsymbol{v}_h)$），$\\mathbf{M}_p$ 是压力质量矩阵（来自 $(p_h, q_h)$），而 $\\mathbf{C}_p$ 是压力稳定化矩阵（来自 $c(p_h, q_h)$）。\n\n### 步骤 4：Schur 补分析与参数缩放\n\n为了分析稳定性，我们通过从第一个块行中形式上求解 $\\mathbf{U}^n$ 来构造系统的 Schur 补：\n$$ \\mathbf{U}^n = \\alpha \\mathbf{A}^{-1} \\mathbf{B} \\mathbf{P}^n + \\mathbf{A}^{-1}\\mathbf{F}_u $$\n将此代入第二个块行，得到关于压力未知数 $\\mathbf{P}^n$ 的 Schur 补系统：\n$$ \\left( \\frac{\\alpha^2}{\\Delta t} \\mathbf{B}^T \\mathbf{A}^{-1} \\mathbf{B} + \\frac{S}{\\Delta t} \\mathbf{M}_p + \\gamma(\\Delta t) \\mathbf{C}_p \\right) \\mathbf{P}^n = \\mathbf{F}'_p $$\n令 $\\mathbf{S}_{\\text{schur}}$ 为 Schur 补矩阵：\n$$ \\mathbf{S}_{\\text{schur}} = \\frac{\\alpha^2}{\\Delta t} \\mathbf{B}^T \\mathbf{A}^{-1} \\mathbf{B} + \\frac{S}{\\Delta t} \\mathbf{M}_p + \\gamma(\\Delta t) \\mathbf{C}_p $$\n为了使数值格式关于 $\\Delta t$ 一致稳定，$\\mathbf{S}_{\\text{schur}}$ 的条件数必须由一个与 $\\Delta t$ 无关的常数界定。这要求和中的所有项都得到适当的平衡。\n\n我们来分析矩阵项系数的缩放关系。问题要求的是关于材料参数的缩放，而不是网格尺寸 $h$。我们分析与矩阵相对应的连续算子。\n- 弹性矩阵 $\\mathbf{A}$ 的范数与弹性模量成正比，我们用 Lamé 参数 $\\lambda$ 来表示。因此，$\\|\\mathbf{A}^{-1}\\| \\sim \\lambda^{-1}$。\n- 项 $\\frac{\\alpha^2}{\\Delta t} \\mathbf{B}^T \\mathbf{A}^{-1} \\mathbf{B}$ 代表弹性耦合。其系数按 $\\frac{\\alpha^2}{\\lambda \\Delta t}$ 缩放。\n- 项 $\\frac{S}{\\Delta t} \\mathbf{M}_p$ 代表流体储存。其系数按 $\\frac{S}{\\Delta t}$ 缩放。\n\n为实现一致稳定性，稳定化项 $\\gamma(\\Delta t)\\mathbf{C}_p$ 应足够有效，以在物理项可能提供不足控制的极限情况（例如，不可压缩极限）下对系统进行正则化，但又不能大到引起过度的数值耗散。对于稳定化参数 $\\gamma(\\Delta t)$，一个稳健的选择是使其与 Schur 补中物理项系数之和成比例。这确保了稳定化项与主导物理效应始终处于同一数量级。\n$$ \\gamma(\\Delta t) \\propto \\left( \\frac{\\alpha^2}{\\lambda \\Delta t} + \\frac{S}{\\Delta t} \\right) $$\n引入一个无量纲比例常数 $c_s > 0$，我们得到：\n$$ \\gamma(\\Delta t) = c_s \\left( \\frac{\\alpha^2}{\\lambda \\Delta t} + \\frac{S}{\\Delta t} \\right) $$\n该表达式可以通过提出因子 $\\frac{1}{\\Delta t}$ 来简化。\n\n采用此选择，Schur 补变为：\n$$ \\mathbf{S}_{\\text{schur}} \\approx \\frac{1}{\\Delta t} \\left( \\frac{\\alpha^2}{\\lambda} [\\dots] + S [\\dots] \\right) + \\frac{c_s}{\\Delta t} \\left( \\frac{\\alpha^2}{\\lambda} + S \\right) [\\dots] $$\n整个矩阵 $\\mathbf{S}_{\\text{schur}}$ 按因子 $\\frac{1}{\\Delta t}$ 缩放。被缩放的矩阵是 $\\left( \\alpha^2 \\mathbf{B}^T \\mathbf{A}^{-1} \\mathbf{B} + S \\mathbf{M}_p + c_s (\\frac{\\alpha^2}{\\lambda} + S) \\mathbf{C}_p \\right)$，根据构造，其条件数与 $\\Delta t$ 无关。因此，$\\mathbf{S}_{\\text{schur}}$ 的条件数也与 $\\Delta t$ 无关，从而确保了一致稳定性。\n\n### 步骤 5：最终表达式\n\n稳定化系数 $\\gamma(\\Delta t)$ 必须与 Schur 补矩阵中物理项的系数之和成比例。这得出了最终的表达式：\n$$ \\gamma(\\Delta t) = c_s \\frac{1}{\\Delta t} \\left( \\frac{\\alpha^2}{\\lambda} + S \\right) $$", "answer": "$$ \\boxed{c_{s} \\frac{1}{\\Delta t}\\left(\\frac{\\alpha^{2}}{\\lambda} + S\\right)} $$", "id": "3562719"}, {"introduction": "理论推导为我们提供了参数选择的指导原则，而数值实验则是验证这些原则并深入理解其影响的最终手段。在本练习 [@problem_id:3562780] 中，你将通过编写代码来构建一个简单的一维混合有限元模型，并计算其系统矩阵的最小奇异值。这个数值实验可以让你直观地观察到稳定化参数 $\\tau$ 和网格密度 $N$ 如何直接影响离散算子的稳定性。", "problem": "考虑单位区间 $\\left[0,1\\right]$ 上达西流的一维混合格式，该问题以一阶形式提出，未知量为通量 $q$ 和压力 $p$，由质量守恒和达西定律推导得出。从基本平衡方程 $\\nabla \\cdot q = f$ 和本构关系 $q = -\\kappa \\nabla p$（其中 $\\kappa$ 为常数导水率）出发，考虑为评估混合算子稳定性而设计的稳定化同阶离散。目标是组装一个离散算子，并通过计算该算子的最小奇异值来估计其稳定性，该奇异值可视为离散 inf-sup 常数的一个代理。您必须编写一个完整的、可运行的程序，该程序能够组装下述算子，并为多组参数计算最小奇异值 $\\sigma_{\\min}$。\n\n弱形式旨在求解 $q$ 和 $p$，使得对于所有容许的测试函数 $v$ 和 $w$，\n- 本构关系被弱形式强制，并且\n- 质量平衡被弱形式强制。\n\n引入一个带有非负稳定化参数 $\\tau$ 的压力梯度稳定化项，使得稳定化的双线性形式为\n$$(q, v) + (p, \\nabla \\cdot v) + (\\nabla \\cdot q, w) + \\tau (\\nabla p, \\nabla w),$$\n其中 $(\\cdot,\\cdot)$ 表示在 $\\left[0,1\\right]$ 上的 $L^2$ 内积。对压力施加齐次狄利克雷边界条件，$p(0)=0$ 和 $p(1)=0$，从而将压力未知量仅限制在内部节点上。忽略右侧项，专注于齐次算子以研究其稳定性。\n\n使用包含 $N$ 个单元的均匀网格对区间 $\\left[0,1\\right]$ 进行离散，单元尺寸为 $h = 1/N$。对通量 $q$ 和压力 $p$ 均使用连续分片线性拉格朗日基函数（同阶近似）。令 $\\{\\varphi_i\\}_{i=0}^{N}$ 表示通量基函数，$\\{\\psi_j\\}_{j=0}^{N}$ 表示压力基函数，在施加 $p(0)=p(1)=0$ 后，压力自由度被限制在内部节点 $\\{1,\\dots,N-1\\}$ 上。为离散算子 $A \\in \\mathbb{R}^{(N+1 + N-1)\\times(N+1 + N-1)}$ 组装以下分块矩阵：\n$$\nA = \\begin{bmatrix}\nM_q & G \\\\\nG^\\top & \\tau K_p\n\\end{bmatrix},\n$$\n其中：\n- $M_q \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 是通量质量矩阵，其元素为 $(M_q)_{ik} = \\int_0^1 \\varphi_i \\varphi_k \\, dx$，\n- $K_p \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ 是压力刚度矩阵，其元素为 $(K_p)_{j\\ell} = \\int_0^1 \\nabla \\psi_j \\cdot \\nabla \\psi_\\ell \\, dx$，仅在内部压力节点上组装，\n- $G \\in \\mathbb{R}^{(N+1)\\times(N-1)}$ 是耦合矩阵，其元素为 $G_{i j} = \\int_0^1 \\psi_j \\, \\nabla \\cdot \\varphi_i \\, dx$，在限制于内部压力节点后。\n\n在每个长度为 $h$ 的单元上，局部节点索引 $a$ 和 $b$ 对应于全局节点 $i$ 和 $i+1$，标准的一维分片线性形函数 $\\widehat{N}_1$ 和 $\\widehat{N}_2$ 产生以下经过良好测试的局部贡献：\n- 局部通量质量矩阵：\n$$\nM_q^{(e)} = \\frac{h}{3}\\begin{bmatrix}2  & 1 \\\\ 1 & 2\\end{bmatrix}.\n$$\n- 局部压力刚度矩阵：\n$$\nK_p^{(e)} = \\frac{1}{h}\\begin{bmatrix}1  & -1 \\\\ -1 & 1\\end{bmatrix}.\n$$\n- 实现 $(p, v')$ 的局部耦合矩阵，其中在一维中 $v' = \\nabla \\cdot v$ 且 $p$ 是标量：\n$$\nG^{(e)} = \\begin{bmatrix} -\\tfrac{1}{2} & -\\tfrac{1}{2} \\\\ \\tfrac{1}{2} & \\tfrac{1}{2} \\end{bmatrix},\n$$\n其行与局部节点 $a$ 和 $b$ 处的测试通量基函数相关联，列与局部节点 $a$ 和 $b$ 处的试验压力基函数相关联。全局组装后，通过从压力空间中消除第一个和最后一个压力自由度（对应于全局节点 $0$ 和 $N$）来施加齐次压力边界条件，这将 $K_p$ 和 $G$ 限制在内部压力节点上。\n\n定义如上组装的离散算子 $A(N,\\tau)$。所要求的稳定性度量是最小奇异值：\n$$\n\\sigma_{\\min}(A) = \\min \\operatorname{svd}(A),\n$$\n它可以等效地计算为 $A^\\top A$ 的最小特征值的平方根。使用稳健的方法（如奇异值分解，SVD, Singular Value Decomposition）对 $\\sigma_{\\min}(A)$ 进行数值计算。\n\n您的任务：\n- 实现一个程序，对于给定的 $(N,\\tau)$，完全按照规定组装 $A(N,\\tau)$ 并返回 $\\sigma_{\\min}(A(N,\\tau))$。\n- 使用以下测试用例集 $(N,\\tau)$，它探究了一个典型情况、一个接近不稳定的情况以及网格加密效应：\n  - 案例 1: $(N,\\tau) = (8, 0)$。\n  - 案例 2: $(N,\\tau) = (8, 10^{-6})$。\n  - 案例 3: $(N,\\tau) = (8, 10^{-2})$。\n  - 案例 4: $(N,\\tau) = (16, 10^{-2})$。\n  - 案例 5: $(N,\\tau) = (32, 10^{-2})$。\n  - 案例 6: $(N,\\tau) = (32, 1)$。\n- 对于每种情况，计算单个浮点数 $\\sigma_{\\min}(A(N,\\tau))$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按案例 1 到 6 的顺序排列，并采用具有 10 位有效数字的科学记数法：\n$$\n[\\sigma_{\\min}(A(8,0)),\\sigma_{\\min}(A(8,10^{-6})),\\sigma_{\\min}(A(8,10^{-2})),\\sigma_{\\min}(A(16,10^{-2})),\\sigma_{\\min}(A(32,10^{-2})),\\sigma_{\\min}(A(32,1))]\n$$\n不需要物理单位；所要求的值是无量纲的。不涉及角度。所有数值输出均以具有 10 位有效数字的科学记数法表示（例如，$1.2345678900\\mathrm{e}{-02}$）。", "solution": "该问题被认为是有效的，因为它具有科学依据、适定且客观。它提出了一个来自计算力学领域的标准数值分析任务，特别是针对达西流的混合有限元方法的稳定性分析。所有参数和定义均已提供，从而可以得到唯一且可验证的解。\n\n目标是计算离散算子 $A(N,\\tau)$ 的最小奇异值 $\\sigma_{\\min}$，该算子对应于一维达西流的稳定化混合有限元格式。该值可作为 inf-sup 常数的数值估计，后者是混合格式稳定性的关键度量。算法首先组装系统矩阵 $A(N,\\tau)$，然后计算其奇异值。\n\n问题定义在单位区间 $\\Omega = [0,1]$ 上，通过一个由 $N$ 个单元组成的均匀网格进行离散，每个单元的长度为 $h = 1/N$。我们对通量变量 $q$ 和压力变量 $p$ 均使用连续分片线性 ($P_1$) 拉格朗日基函数。节点总数为 $N+1$，索引从 $i=0$ 到 $i=N$。\n\n通量变量 $q$ 近似为 $q_h = \\sum_{i=0}^{N} q_i \\varphi_i(x)$，其中 $\\{\\varphi_i\\}_{i=0}^{N}$ 是张成通量近似空间 $V_h$ 的 $P_1$ 基函数。该空间的维数为 $N+1$。\n\n压力变量 $p$ 近似为 $p_h = \\sum_{j=0}^{N} p_j \\psi_j(x)$，其中 $\\{\\psi_j\\}_{j=0}^{N}$ 也是 $P_1$ 基函数。问题施加了齐次狄利克雷边界条件，$p(0)=0$ 和 $p(1)=0$。这些条件通过将压力近似限制在由内部基函数 $\\{\\psi_j\\}_{j=1}^{N-1}$ 张成的子空间中来强制执行。因此，压力近似为 $p_h = \\sum_{j=1}^{N-1} p_j \\psi_j(x)$，压力近似空间 $Q_h$ 的维数为 $N-1$。\n\n离散系统源于稳定化的弱形式，导出分块矩阵算子 $A \\in \\mathbb{R}^{(N+1 + N-1)\\times(N+1 + N-1)}$：\n$$\nA = \\begin{bmatrix}\nM_q  & G \\\\\nG^\\top & \\tau K_p\n\\end{bmatrix}\n$$\n矩阵 $A$ 的总大小为 $(2N) \\times (2N)$。各分块组装如下：\n\n1.  **通量质量矩阵, $M_q$**: 这个 $(N+1) \\times (N+1)$ 矩阵的元素为 $(M_q)_{ik} = \\int_0^1 \\varphi_i \\varphi_k \\, dx$。它通过对每个单元的局部质量矩阵的贡献求和来组装，局部质量矩阵为：\n    $$\n    M_q^{(e)} = \\frac{h}{3}\\begin{bmatrix} 2  & 1 \\\\ 1  & 2 \\end{bmatrix}\n    $$\n\n2.  **压力刚度矩阵, $K_p$**: 这个 $(N-1) \\times (N-1)$ 矩阵对应于稳定项 $\\tau (\\nabla p, \\nabla w)$。其元素为 $(K_p)_{j\\ell} = \\int_0^1 \\nabla \\psi_j \\cdot \\nabla \\psi_\\ell \\, dx$，其中 $j, \\ell \\in \\{1, \\dots, N-1\\}$ 是内部压力基函数。组装使用局部刚度矩阵：\n    $$\n    K_p^{(e)} = \\frac{1}{h}\\begin{bmatrix} 1  & -1 \\\\ -1  & 1 \\end{bmatrix}\n    $$\n    首先组装一个完整的 $(N+1) \\times (N+1)$ 矩阵，然后提取对应于内部节点 $\\{1, \\dots, N-1\\}$ 的子矩阵以形成 $K_p$。\n\n3.  **耦合矩阵, $G$**: 这个 $(N+1) \\times (N-1)$ 矩阵源于原始混合格式中的非对称项 $(p, \\nabla \\cdot v)$ 和 $(\\nabla \\cdot q, w)$。元素 $G_{ij}$ 定义为 $G_{ij} = \\int_0^1 \\psi_j \\, \\nabla \\cdot \\varphi_i \\, dx$，其中 $i \\in \\{0, \\dots, N\\}$ 且 $j \\in \\{1, \\dots, N-1\\}$。局部耦合矩阵的行对应通量测试函数，列对应压力试验函数，其形式为：\n    $$\n    G^{(e)} = \\begin{bmatrix} -1/2  & -1/2 \\\\ 1/2  & 1/2 \\end{bmatrix}\n    $$\n    首先组装一个完整的 $(N+1) \\times (N+1)$ 耦合矩阵，然后选择对应于内部压力节点 $\\{1, \\dots, N-1\\}$ 的列以形成 $G$。系统矩阵 A 中的分块 $G^\\top$ 是该所得矩阵的转置。\n\n组装过程包括将大小为 $(N+1) \\times (N+1)$ 的全局矩阵初始化为零。然后，对于连接全局节点 $i$ 和 $i+1$ 的每个单元 $e$，将相应的 $2 \\times 2$ 局部矩阵加到全局矩阵的适当条目中。在遍历所有 $N$ 个单元后，通过对组装好的全局矩阵进行切片来施加边界条件，以获得最终的块 $K_p$ 和 $G$。\n\n一旦构建了完整的矩阵 $A(N,\\tau)$，就通过计算其最小奇异值 $\\sigma_{\\min}(A)$ 来评估其稳定性。奇异值是对称半正定矩阵 $A^\\top A$ 的特征值的平方根。我们使用标准的奇异值分解（SVD）算法进行数值计算。这些值中的最小值即为所求的度量。\n\n总体算法如下：\n1.  对于给定的对 $(N, \\tau)$，计算单元尺寸 $h=1/N$。\n2.  将局部矩阵 $M_q^{(e)}$, $K_p^{(e)}$ 和 $G^{(e)}$ 定义为 $h$ 的函数。\n3.  初始化大小为 $(N+1) \\times (N+1)$ 的全局矩阵 $M_q^{\\text{global}}$, $K_p^{\\text{global}}$, $G^{\\text{global}}$ 为零。\n4.  从单元 $e=0$ 循环到 $N-1$：\n    a.  确定单元节点的全局索引 $\\{i, i+1\\}$，其中 $i=e$。\n    b.  将局部矩阵添加到全局矩阵中对应于索引 $\\{i, i+1\\}$ 的子块上。\n5.  提取最终的矩阵块：\n    a.  $M_q = M_q^{\\text{global}}$。\n    b.  $K_p = K_p^{\\text{global}}[1:N, 1:N]$。\n    c.  $G = G^{\\text{global}}[:, 1:N]$。\n6.  构造 $(2N) \\times (2N)$ 的分块矩阵 $A = \\begin{bmatrix} M_q  & G \\\\ G^\\top  & \\tau K_p \\end{bmatrix}$。\n7.  使用 SVD 例程计算 $A$ 的奇异值。\n8.  返回最小奇异值 $\\sigma_{\\min}(A)$。\n对问题陈述中提供的每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef compute_sigma_min(N, tau):\n    \"\"\"\n    Assembles the discrete operator A(N, tau) and computes its smallest singular value.\n\n    Args:\n        N (int): The number of elements in the mesh.\n        tau (float): The stabilization parameter.\n\n    Returns:\n        float: The smallest singular value of the matrix A.\n    \"\"\"\n    # 1. Mesh and matrix dimensions\n    h = 1.0 / N\n    num_nodes = N + 1\n    num_flux_dofs = N + 1\n    num_pressure_dofs_interior = N - 1\n\n    # 2. Define local element matrices\n    # Using the local mass matrix from the problem statement\n    M_q_local = (h / 3.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    K_p_local = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    G_local = np.array([[-0.5, -0.5], [0.5, 0.5]])\n\n    # 3. Initialize global matrices (full size, before applying BCs)\n    M_q_global = np.zeros((num_nodes, num_nodes))\n    K_p_global = np.zeros((num_nodes, num_nodes))\n    G_global = np.zeros((num_nodes, num_nodes))\n\n    # 4. Assembly loop over elements\n    for e in range(N):\n        # Global node indices for element e\n        idx0, idx1 = e, e + 1\n        dof_map = np.array([idx0, idx1])\n\n        # Add local contributions to global matrices\n        # np.ix_ is used for indexing submatrices\n        M_q_global[np.ix_(dof_map, dof_map)] += M_q_local\n        K_p_global[np.ix_(dof_map, dof_map)] += K_p_local\n        G_global[np.ix_(dof_map, dof_map)] += G_local\n\n    # 5. Apply boundary conditions to extract final matrix blocks\n    # M_q uses all N+1 flux DOFs\n    M_q = M_q_global\n\n    # K_p is restricted to the N-1 interior pressure DOFs (nodes 1 to N-1)\n    K_p = K_p_global[1:N, 1:N]\n\n    # G has rows for all N+1 flux DOFs and columns for the N-1 interior pressure DOFs\n    G = G_global[:, 1:N]\n\n    # 6. Construct the final block matrix A\n    # A has size (num_flux_dofs + num_pressure_dofs_interior) x (...)\n    # which is (N+1 + N-1) x (N+1 + N-1) = 2N x 2N\n    A = np.block([\n        [M_q, G],\n        [G.T, tau * K_p]\n    ])\n\n    # 7. Compute singular values of A\n    # We only need the singular values, not the vectors U and Vh, so compute_uv=False.\n    # linalg.svd returns singular values in descending order.\n    singular_values = linalg.svd(A, compute_uv=False)\n    \n    # 8. Return the minimum singular value\n    if singular_values.size > 0:\n        return np.min(singular_values)\n    else:\n        return 0.0\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (8, 0.0),          # Case 1\n        (8, 1e-6),         # Case 2\n        (8, 1e-2),         # Case 3\n        (16, 1e-2),        # Case 4\n        (32, 1e-2),        # Case 5\n        (32, 1.0)          # Case 6\n    ]\n\n    results = []\n    for N, tau in test_cases:\n        sigma_min = compute_sigma_min(N, tau)\n        results.append(sigma_min)\n\n    # Final print statement in the exact required format.\n    # Format each number in scientific notation with 10 significant digits.\n    # The format string \"{:.9e}\" accomplishes this (1 digit before '.', 9 after).\n    formatted_results = [f\"{res:.9e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3562780"}]}