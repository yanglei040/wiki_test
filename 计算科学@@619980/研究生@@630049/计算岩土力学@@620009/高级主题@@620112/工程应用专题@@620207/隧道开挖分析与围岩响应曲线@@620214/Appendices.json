{"hands_on_practices": [{"introduction": "本练习是理解隧道工程中地层-支护相互作用的基础。通过从弹性力学的第一性原理出发，您将推导出线弹性岩体中圆形隧道的“地层响应曲线”($\\text{GRC}$)。这项实践不仅阐明了围岩如何因开挖而变形，还通过引入支护特性曲线($\\text{SCC}$)来确定最终的平衡状态，为您提供了分析隧道稳定性的核心工具[@problem_id:3569433]。", "problem": "在一个无限、均质、各向同性的岩体中，在平面应变条件下，开挖了一个半径为 $a$ 的圆形隧道。远场地应力为静水压力，大小为 $\\sigma_{0}$（压应力为正）。岩石表现为线弹性体，其杨氏模量为 $E$，泊松比为 $\\nu$。在 $r=a$ 处的开挖边界由一个轴对称支护系统提供支撑，该系统以均匀的压力作用于围岩。支护是在应力释放一部分后安装的，这通过约束解除系数 $\\lambda \\in (0,1)$ 来模拟，该系数定义为：在支护开始起作用时，已经发生的自由（无支护）弹性收敛量占总自由弹性收敛量的比例。安装后，支护遵循线性的支护特性曲线（SCC），模拟为一个均匀压力 $p_{s}$，该压力与超过安装收敛量的额外洞壁收敛量成正比：当 $u \\ge u_{i}$ 时，$p_{s} = K_{s}\\,(u - u_{i})$；当 $u  u_{i}$ 时，$p_{s}=0$。其中，$u$ 是隧道洞壁的径向收敛量，$K_{s}$ 是支护刚度，单位为应力/位移，$u_{i}$ 是安装时的收敛量。\n\n仅从平面应变条件下的轴对称平衡、协调和线弹性基本方程出发，首先推导弹性地层响应曲线（GRC），即施加在 $r=a$ 处的均匀内压 $p$ 与相应洞壁收敛量 $u$ 之间的关系。然后，利用上述定义，通过令支护压力 $p_{s}(u_{\\ast})$ 等于地层反力 $p(u_{\\ast})$，确定唯一的围岩-支护相互作用平衡收敛量 $u_{\\ast}$。\n\n使用以下数据：\n- 隧道半径: $a = 2.5\\,\\mathrm{m}$。\n- 远场静水应力: $\\sigma_{0} = 15\\,\\mathrm{MPa}$。\n- 岩石弹性特性: $E = 2.0 \\times 10^{9}\\,\\mathrm{Pa}$，$\\nu = 0.25$。\n- 支护刚度: $K_{s} = 3.0 \\times 10^{8}\\,\\mathrm{Pa/m}$。\n- 安装时的约束解除系数: $\\lambda = 0.60$。\n\n假设压应力为正，忽略掌子面效应，并将问题视为具有无限弹性域的二维平面应变问题。以毫米为单位表示最终的平衡洞壁收敛量 $u_{\\ast}$，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求计算在线弹性岩体中开挖的圆形隧道的平衡洞壁收敛量，并考虑与线性支护系统的相互作用。求解过程包括两个主要步骤：首先，从力学基本原理推导地层响应曲线（GRC）；其次，通过求解GRC与支护特性曲线（SCC）的交点来确定平衡点。分析是在平面应变条件和静水远场应力下进行的。压应力取为正值。\n\n**第1部分：地层响应曲线（GRC）的推导**\n\nGRC描述了施加在隧道边界上的均匀内压 $p$ 与由此产生的径向洞壁收敛量 $u$ 之间的关系。我们通过求解弹性静力学边值问题来推导这个关系。\n\n**1. 控制方程**\n该问题是轴对称的，因此我们使用极坐标系 $(r, \\theta)$。基本方程如下：\n-   **平衡方程**（不考虑体力）：\n    $$ \\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0 $$\n    其中 $\\sigma_r$ 是径向应力，$\\sigma_\\theta$ 是切向（环向）应力。\n-   **几何关系：** 应变与径向位移场 $u_r(r)$ 的关系如下：\n    $$ \\epsilon_r = \\frac{du_r}{dr}, \\quad \\epsilon_\\theta = \\frac{u_r}{r} $$\n    其中 $\\epsilon_r$ 和 $\\epsilon_\\theta$ 分别是径向应变和切向应变。\n-   **本构律（平面应变下的胡克定律）：** 对于平面应变（$\\epsilon_z = 0$）且压应力为正的各向同性线弹性材料，其应力-应变关系为：\n    $$ \\epsilon_r = \\frac{1}{E}[-\\sigma_r + \\nu(\\sigma_\\theta + \\sigma_z)] $$\n    $$ \\epsilon_\\theta = \\frac{1}{E}[-\\sigma_\\theta + \\nu(\\sigma_r + \\sigma_z)] $$\n    条件 $\\epsilon_z=0$ 意味着 $\\sigma_z = \\nu(\\sigma_r + \\sigma_\\theta)$。将此代入应变方程，得到：\n    $$ \\epsilon_r = -\\frac{1+\\nu}{E}[(1-\\nu)\\sigma_r - \\nu\\sigma_\\theta] $$\n    $$ \\epsilon_\\theta = -\\frac{1+\\nu}{E}[(1-\\nu)\\sigma_\\theta - \\nu\\sigma_r] $$\n\n**2. 应力场求解**\n该问题可以通过叠加法求解。最终状态（远场应力 $\\sigma_0$，内压 $p$）是初始静水应力场（处处为 $\\sigma=\\sigma_0$）与由开挖和支护安装引起的应力变化之和。位移完全由这些应力变化引起。隧道壁（$r=a$）处边界条件的变化对应于施加一个大小为 $p - \\sigma_0$ 的面力。\n\n令 $\\Delta\\sigma_r$ 和 $\\Delta\\sigma_\\theta$ 为应力变化量。该变化场的边界条件为：\n-   在隧道壁处，$r=a$：$\\Delta\\sigma_r(a) = p - \\sigma_0$。\n-   在远场处，$r \\to \\infty$：$\\Delta\\sigma_r(\\infty) \\to 0$。\n\n对于轴对称问题，极坐标系下平衡方程的通解（拉梅解）为：\n$$ \\Delta\\sigma_r(r) = A - \\frac{B}{r^2} $$\n$$ \\Delta\\sigma_\\theta(r) = A + \\frac{B}{r^2} $$\n应用远场边界条件：$\\Delta\\sigma_r(\\infty) = A = 0$。\n应用近场边界条件：$\\Delta\\sigma_r(a) = -\\frac{B}{a^2} = p - \\sigma_0$，可得 $B = a^2(\\sigma_0 - p)$。\n因此，应力变化量为：\n$$ \\Delta\\sigma_r(r) = -(\\sigma_0 - p)\\frac{a^2}{r^2} $$\n$$ \\Delta\\sigma_\\theta(r) = (\\sigma_0 - p)\\frac{a^2}{r^2} $$\n\n**3. 位移与GRC**\n现在我们计算由这些应力变化引起的位移场。我们使用几何关系 $u_r(r) = r \\epsilon_\\theta(r)$ 和 $\\epsilon_\\theta$ 的本构律，其中应力为应力变化量 $\\Delta\\sigma_r$ 和 $\\Delta\\sigma_\\theta$：\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}[(1-\\nu)\\Delta\\sigma_\\theta(r) - \\nu\\Delta\\sigma_r(r)] $$\n代入 $\\Delta\\sigma_r$ 和 $\\Delta\\sigma_\\theta$ 的表达式：\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}\\left[(1-\\nu)\\left((\\sigma_0 - p)\\frac{a^2}{r^2}\\right) - \\nu\\left(-(\\sigma_0 - p)\\frac{a^2}{r^2}\\right)\\right] $$\n$$ \\epsilon_\\theta(r) = -\\frac{1+\\nu}{E}\\left[(\\sigma_0 - p)\\frac{a^2}{r^2}(1-\\nu+\\nu)\\right] = -\\frac{1+\\nu}{E}(\\sigma_0 - p)\\frac{a^2}{r^2} $$\n径向位移场为：\n$$ u_r(r) = r \\epsilon_\\theta(r) = -r \\frac{1+\\nu}{E}(\\sigma_0 - p)\\frac{a^2}{r^2} = -\\frac{a^2(1+\\nu)}{E r}(\\sigma_0 - p) $$\n在隧道壁处（$r=a$），径向位移为：\n$$ u_r(a) = -\\frac{a(1+\\nu)}{E}(\\sigma_0 - p) $$\n负号表示当 $\\sigma_0 > p$ 时，位移是向内的。洞壁收敛量 $u$ 定义为该向内位移的大小，因此 $u = -u_r(a)$。\n$$ u(p) = \\frac{a(1+\\nu)}{E}(\\sigma_0 - p) $$\n这个线性方程就是地层响应曲线（GRC）。它可以重新整理，将压力表示为收敛量的函数：\n$$ p(u) = \\sigma_0 - \\frac{E}{a(1+\\nu)} u $$\n\n**第2部分：围岩-支护相互作用**\n\n**1. 支护特性曲线（SCC）**\n支护在安装收敛量 $u_i$ 时开始起作用。该收敛量是自由（无支护）收敛量 $u_{max}$ 的一个比例 $\\lambda$，$u_{max}$ 发生在 $p=0$ 时。\n$$ u_{max} = u(p=0) = \\frac{a(1+\\nu)}{E}\\sigma_0 $$\n$$ u_i = \\lambda u_{max} = \\lambda \\frac{a(1+\\nu)}{E}\\sigma_0 $$\n支护特性曲线（SCC）由下式给出：\n$$ p_s(u) = \n\\begin{cases} \n0  \\text{for } u  u_i \\\\\nK_s (u - u_i)  \\text{for } u \\ge u_i \n\\end{cases}\n$$\n其中 $K_s$ 是支护刚度。\n\n**2. 平衡条件**\n当来自地层反力的压力与支护施加的压力相等时，达到平衡。令平衡收敛量为 $u_\\ast$。\n$$ p(u_\\ast) = p_s(u_\\ast) $$\n假设 $u_\\ast \\ge u_i$，我们有：\n$$ \\sigma_0 - \\frac{E}{a(1+\\nu)} u_\\ast = K_s (u_\\ast - u_i) $$\n我们求解 $u_\\ast$。我们定义地层刚度模量 $K_g = \\frac{E}{a(1+\\nu)}$。方程变为：\n$$ \\sigma_0 - K_g u_\\ast = K_s u_\\ast - K_s u_i $$\n$$ \\sigma_0 + K_s u_i = u_\\ast (K_s + K_g) $$\n$$ u_\\ast = \\frac{\\sigma_0 + K_s u_i}{K_s + K_g} $$\n代入 $u_i = \\lambda \\frac{\\sigma_0}{K_g}$ 的表达式：\n$$ u_\\ast = \\frac{\\sigma_0 + K_s (\\lambda \\frac{\\sigma_0}{K_g})}{K_s + K_g} = \\frac{\\sigma_0(1 + \\frac{\\lambda K_s}{K_g})}{K_s + K_g} $$\n\n**第3部分：数值计算**\n\n给定数据如下：\n-   $a = 2.5\\,\\mathrm{m}$\n-   $\\sigma_0 = 15\\,\\mathrm{MPa} = 15 \\times 10^6\\,\\mathrm{Pa}$\n-   $E = 2.0 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\nu = 0.25$\n-   $K_s = 3.0 \\times 10^8\\,\\mathrm{Pa/m}$\n-   $\\lambda = 0.60$\n\n首先，计算地层刚度模量 $K_g$：\n$$ K_g = \\frac{E}{a(1+\\nu)} = \\frac{2.0 \\times 10^9\\,\\mathrm{Pa}}{2.5\\,\\mathrm{m} \\times (1 + 0.25)} = \\frac{2.0 \\times 10^9}{2.5 \\times 1.25} = \\frac{2.0 \\times 10^9}{3.125}\\,\\mathrm{Pa/m} = 6.4 \\times 10^8\\,\\mathrm{Pa/m} $$\n接下来，计算安装收敛量 $u_i$：\n$$ u_i = \\lambda \\frac{\\sigma_0}{K_g} = 0.60 \\times \\frac{15 \\times 10^6\\,\\mathrm{Pa}}{6.4 \\times 10^8\\,\\mathrm{Pa/m}} = \\frac{9 \\times 10^6}{6.4 \\times 10^8}\\,\\mathrm{m} = \\frac{9}{640}\\,\\mathrm{m} = 0.0140625\\,\\mathrm{m} $$\n现在，使用推导出的公式计算平衡收敛量 $u_\\ast$：\n$$ u_\\ast = \\frac{\\sigma_0 + K_s u_i}{K_s + K_g} $$\n计算分子：\n$$ \\sigma_0 + K_s u_i = 15 \\times 10^6\\,\\mathrm{Pa} + (3.0 \\times 10^8\\,\\mathrm{Pa/m}) \\times (0.0140625\\,\\mathrm{m}) $$\n$$ \\sigma_0 + K_s u_i = 15 \\times 10^6\\,\\mathrm{Pa} + 4.21875 \\times 10^6\\,\\mathrm{Pa} = 19.21875 \\times 10^6\\,\\mathrm{Pa} $$\n计算分母：\n$$ K_s + K_g = 3.0 \\times 10^8\\,\\mathrm{Pa/m} + 6.4 \\times 10^8\\,\\mathrm{Pa/m} = 9.4 \\times 10^8\\,\\mathrm{Pa/m} $$\n最后，计算 $u_\\ast$：\n$$ u_\\ast = \\frac{19.21875 \\times 10^6\\,\\mathrm{Pa}}{9.4 \\times 10^8\\,\\mathrm{Pa/m}} \\approx 0.0204454787\\,\\mathrm{m} $$\n问题要求答案以毫米为单位，并四舍五入到四位有效数字。\n$$ u_\\ast \\approx 0.0204454787\\,\\mathrm{m} \\times 1000\\,\\mathrm{mm/m} \\approx 20.4454787\\,\\mathrm{mm} $$\n四舍五入到四位有效数字，得到：\n$$ u_\\ast = 20.45\\,\\mathrm{mm} $$\n由于 $u_\\ast \\approx 20.45\\,\\mathrm{mm}$ 且 $u_i = 14.0625\\,\\mathrm{mm}$，条件 $u_\\ast > u_i$ 得到满足，这验证了我们使用主动支护压力公式的正确性。", "answer": "$$\\boxed{20.45}$$", "id": "3569433"}, {"introduction": "在掌握了理想弹性模型后，本练习将引导您进入更符合工程实际的弹塑性分析领域。您将应用国际岩石力学界广泛使用的Hoek-Brown准则来描述岩体强度，并通过一个计算流程来确定隧道周围塑性区的范围。这项实践旨在将复杂的岩体本构理论转化为一个可执行的算法，从而加深您对真实岩体在隧道开挖下力学响应的理解[@problem_id:3569461]。", "problem": "考虑在深度 $H$ 处的岩体中开挖一个半径为 $a$ 的圆形隧道，该隧道处于平面应变条件和轴对称远场静水压力下。隧道轴线处的原地岩压力为 $p_0 = \\gamma H / 1000$，单位为 $\\mathrm{MPa}$，其中 $\\gamma$ 是单位重量（$\\mathrm{kN/m^3}$），$H$ 是深度（$\\mathrm{m}$）。隧道边界承受均匀的支护压力 $p_i$（单位 $\\mathrm{MPa}$）。岩体被建模为理想弹塑性体，其强度由 Hoek-Brown 岩体准则描述。目标是使用基于连续介质力学和 Hoek-Brown 准则的算法，计算几个测试案例的塑性区半径 $r_p$，并报告无量纲比值 $r_p/a$。\n\n您必须从以下基本原理推导您的计算方法：\n- 平面应变条件下轴对称圆柱连续介质中的径向应力平衡：径向平衡微分方程为\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0,\n$$\n其中 $\\sigma_r$ 和 $\\sigma_\\theta$ 分别为径向应力和周向（环向）应力，$r$ 是径向坐标。\n- 在远场静水压力 $p_0$ 和内压力 $p_i$ 作用下，无限弹性介质中受压圆柱形空腔的外部区域（如果存在）的弹性解（在弹性区域内）为：\n$$\n\\sigma_r^{e}(r) = p_0 - (p_0 - p_i)\\frac{a^2}{r^2},\\quad\n\\sigma_\\theta^{e}(r) = p_0 + (p_0 - p_i)\\frac{a^2}{r^2},\n$$\n适用于 $r \\ge r_p$。\n- Hoek-Brown 岩体强度准则，表示最大主应力 $\\sigma_1$ 作为最小主应力 $\\sigma_3$ 的函数，其形式为\n$$\n\\sigma_1 = \\sigma_3 + \\sigma_{ci}\\left(m_b\\frac{\\sigma_3}{\\sigma_{ci}} + s\\right)^a,\n$$\n其中 $\\sigma_{ci}$ 是完整岩石的单轴抗压强度，$m_b$ 是岩体的折减 Hoek-Brown 常数，$s$ 是一个随岩体质量下降而减小的标量，$a$ 是一个无量纲指数。这些经验参数由地质强度指标（GSI）和扰动因子 $D$ 定义：\n$$\nm_b = m_i \\exp\\left(\\frac{\\mathrm{GSI}-100}{28-14D}\\right),\\quad\ns = \\exp\\left(\\frac{\\mathrm{GSI}-100}{9-3D}\\right),\\quad\na = \\frac{1}{2} + \\frac{1}{6}\\left[\\exp\\left(-\\frac{\\mathrm{GSI}}{15}\\right) - \\exp\\left(-\\frac{20}{3}\\right)\\right],\n$$\n其中 $m_i$ 是完整岩石常数。\n- 为使问题易于计算，使用 Hoek-Brown 函数的导数，在指定的围压 $\\sigma_3 = \\sigma_{3t}$ 处，通过切线 Mohr-Coulomb 线性化来近似非线性的 Hoek-Brown 包络线。Mohr-Coulomb 形式为\n$$\n\\sigma_1 = \\alpha\\,\\sigma_3 + \\beta,\\quad \\alpha = \\frac{1+\\sin\\varphi}{1-\\sin\\varphi},\\quad \\beta = \\frac{2c\\cos\\varphi}{1-\\sin\\varphi},\n$$\n其中 $c$ 是黏聚力，$\\varphi$ 是摩擦角（内部计算时角度用弧度表示）。切线映射通过在 $\\sigma_3 = \\sigma_{3t}$ 处匹配斜率和函数值来定义：\n$$\n\\left.\\frac{d\\sigma_1}{d\\sigma_3}\\right|_{\\sigma_3=\\sigma_{3t}} = k = 1 + a\\,m_b\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^{a-1},\n$$\n于是\n$$\n\\sin\\varphi = \\frac{k-1}{k+1},\n$$\n并且\n$$\n\\sigma_1^{HB}(\\sigma_{3t}) = \\sigma_{3t} + \\sigma_{ci}\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^a,\n$$\n由此可得\n$$\nc = \\frac{\\left[\\sigma_1^{HB}(\\sigma_{3t}) - \\alpha\\,\\sigma_{3t}\\right](1-\\sin\\varphi)}{2\\cos\\varphi}.\n$$\n- 在塑性区（$a \\le r \\le r_p$）内，如果最大主应力是环向应力（$\\sigma_\\theta = \\sigma_1$），最小主应力是径向应力（$\\sigma_r = \\sigma_3$），则屈服时的应力状态满足 Mohr-Coulomb 包络线 $\\sigma_\\theta = \\alpha\\,\\sigma_r + \\beta$。代入平衡方程可得一阶常微分方程\n$$\n\\frac{d\\sigma_r}{dr} + \\frac{(1-\\alpha)\\sigma_r - \\beta}{r} = 0,\n$$\n积分可得\n$$\n\\sigma_r(r) = \\frac{\\beta}{1-\\alpha} + C\\,r^{\\alpha-1},\n$$\n其边界条件为 $\\sigma_r(a) = p_i$，由此得到 $C = \\left(p_i - \\frac{\\beta}{1-\\alpha}\\right)a^{1-\\alpha}$。在 $r=r_p$ 处的连续性要求弹性应力状态在界面处满足屈服条件，这导出方程\n$$\n\\sigma_\\theta^{e}(r_p) = \\alpha\\,\\sigma_r^{e}(r_p) + \\beta,\n$$\n该方程可用于求解 $r_p$。\n\n执行以下算法步骤，为每个测试案例计算 $r_p/a$：\n1. 计算 $p_0 = \\gamma H / 1000$（单位 $\\mathrm{MPa}$）并设置 $\\Delta = p_0 - p_i$。\n2. 使用给定的 $\\mathrm{GSI}$ 和 $D$ 计算 Hoek-Brown 参数 $m_b$、$s$ 和 $a$。\n3. 选择切线围压 $\\sigma_{3t} = p_i$，计算 $k$，然后计算 $\\sin\\varphi$ 和 $\\cos\\varphi$，接着计算 $\\alpha$ 和 $\\sigma_1^{HB}(\\sigma_{3t})$，最后计算黏聚力 $c$ 和 $\\beta$。\n4. 使用以弹性解写出的界面屈服条件求解塑性区半径比：\n$$\np_0 + \\Delta\\frac{a^2}{r_p^2} = \\alpha\\left[p_0 - \\Delta\\frac{a^2}{r_p^2}\\right] + \\beta,\\quad \\text{因此}\\quad\nx \\equiv \\frac{a^2}{r_p^2} = \\frac{p_0(\\alpha - 1) + \\beta}{\\Delta(1+\\alpha)}.\n$$\n如果 $0  x  1$，则设置 $r_p/a = 1/\\sqrt{x}$；如果 $x \\le 0$ 或 $\\Delta = 0$（这在这种理想化模型中表示没有扰动或塑性区不扩展），则设置 $r_p/a = 1$。\n5. 将比值 $r_p/a$ 作为无量纲浮点数报告。\n\n设计一个测试套件以在不同工况下运行该算法：\n- 案例 1（典型岩石，无支护）：$a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 0\\,\\mathrm{MPa}$, $\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$。\n- 案例 2（典型岩石，中等支护）：$a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 5\\,\\mathrm{MPa}$, $\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$。\n- 案例 3（边界条件，全支护等于原地岩压力）：$a = 2.5\\,\\mathrm{m}$, $H = 500\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = p_0$（由 $H$ 和 $\\gamma$ 计算），$\\sigma_{ci} = 80\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 55$, $D = 0.5$。\n- 案例 4（较弱岩石，低支护）：$a = 3.0\\,\\mathrm{m}$, $H = 400\\,\\mathrm{m}$, $\\gamma = 27\\,\\mathrm{kN/m^3}$, $p_i = 1.0\\,\\mathrm{MPa}$, $\\sigma_{ci} = 50\\,\\mathrm{MPa}$, $m_i = 10$, $\\mathrm{GSI} = 35$, $D = 0.7$。\n\n测试套件中的所有输入均采用指定的国际标准单位（SI）。内部计算所用角度必须是弧度。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如：$[r_{p1}/a, r_{p2}/a, r_{p3}/a, r_{p4}/a]$）。每个列表项必须是浮点数。\n\n最终答案必须是一个完整的、可运行的程序，该程序精确地为所提供的测试套件实现此算法，并以指定格式打印结果。", "solution": "该问题陈述已被验证，并被认为是计算岩土力学中一个适定的、科学上合理的问题。它提出了一个清晰的算法流程，用一个被广泛接受但经过简化的解析模型，来确定静水压力条件下圆形隧道周围塑性区的范围。该模型将非线性的 Hoek-Brown 破坏准则线性化为切线的 Mohr-Coulomb 准则，从而允许获得闭合形式解。所有必需的物理参数、方程和测试案例均已提供，且设置是内部一致的。\n\n求解过程通过执行指定的算法来进行。分析的核心在于计算岩体中的应力状态，并将其与岩体强度进行比较，以确定发生屈服区域的半径 $r_p$。\n\n第一步是建立初始应力状态。远场原地岩压力 $p_0$ 是由上覆岩层重量产生的静水压力。其计算公式为：\n$$\np_0 = \\frac{\\gamma H}{1000}\n$$\n其中 $p_0$ 的单位为 $\\mathrm{MPa}$，$\\gamma$ 为岩石单位重量（$\\mathrm{kN/m^3}$），$H$ 为隧道深度（$\\mathrm{m}$）。隧道的开挖和内部支护压力 $p_i$ 的施加会产生一个应力差 $\\Delta = p_0 - p_i$。该应力差驱动隧道周围的应力重分布和潜在的塑性破坏。如果 $\\Delta = 0$，则意味着支护压力等于或大于原地应力，从而防止了任何向内位移或应力引起的破坏。在这种情况下，不会形成塑性区，塑性区半径 $r_p$ 等于隧道半径 $a$，得到的比值为 $r_p/a = 1$。\n\n接下来，使用经验性的 Hoek-Brown 准则来表征岩体强度。该准则取决于从地质强度指标（$\\mathrm{GSI}$）、扰动因子（$D$）以及完整岩石性质（$\\sigma_{ci}, m_i$）导出的几个参数。这些参数是折减的 Hoek-Brown 常数 $m_b$、岩体质量项 $s$ 和指数 $a$：\n$$\nm_b = m_i \\exp\\left(\\frac{\\mathrm{GSI}-100}{28-14D}\\right)\n$$\n$$\ns = \\exp\\left(\\frac{\\mathrm{GSI}-100}{9-3D}\\right)\n$$\n$$\na = \\frac{1}{2} + \\frac{1}{6}\\left[\\exp\\left(-\\frac{\\mathrm{GSI}}{15}\\right) - \\exp\\left(-\\frac{20}{3}\\right)\\right]\n$$\n\n非线性的 Hoek-Brown 破坏包络线对于直接解析积分而言，计算上非常复杂。因此，该问题指定了一种常见的工程近似方法：在选定的围压下，线性化为等效的 Mohr-Coulomb 模型（$\\sigma_1 = \\alpha\\,\\sigma_3 + \\beta$）。问题指定使用 $\\sigma_{3t} = p_i$ 作为切点。在此点，Hoek-Brown 准则的斜率与 Mohr-Coulomb 线的斜率相匹配。\n斜率 $k$ 是最大主应力 $\\sigma_1$ 对最小主应力 $\\sigma_3$ 的导数，在 $\\sigma_{3t}$ 处求值：\n$$\nk = \\left.\\frac{d\\sigma_1}{d\\sigma_3}\\right|_{\\sigma_3=\\sigma_{3t}} = 1 + a\\,m_b\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^{a-1}\n$$\n这个斜率 $k$ 与 Mohr-Coulomb 参数 $\\alpha$ 相同。由 $k$ 可以求出等效内摩擦角 $\\varphi$：\n$$\n\\sin\\varphi = \\frac{k-1}{k+1} \\implies \\alpha = k = \\frac{1+\\sin\\varphi}{1-\\sin\\varphi}\n$$\n为了求得与黏聚力 $c$ 相关的第二个 Mohr-Coulomb 参数 $\\beta$，我们强制该直线通过 Hoek-Brown 曲线上 $\\sigma_{3t}$ 这一点。首先，我们根据 Hoek-Brown 准则计算该点处的最大主应力：\n$$\n\\sigma_1^{HB}(\\sigma_{3t}) = \\sigma_{3t} + \\sigma_{ci}\\left(m_b\\frac{\\sigma_{3t}}{\\sigma_{ci}} + s\\right)^a\n$$\n然后，通过恒等式 $\\sigma_1^{HB}(\\sigma_{3t}) = \\alpha\\,\\sigma_{3t} + \\beta$ 来确定参数 $\\beta$：\n$$\n\\beta = \\sigma_1^{HB}(\\sigma_{3t}) - \\alpha\\,\\sigma_{3t}\n$$\n\n塑性区的范围是通过在弹塑性区交界面 $r=r_p$ 处建立连续性条件来找到的。在此边界上，由弹性解预测的应力状态必须满足塑性屈服准则。圆柱形空腔周围的弹性应力由下式给出：\n$$\n\\sigma_r^{e}(r) = p_0 - (p_0 - p_i)\\frac{a^2}{r^2}\n$$\n$$\n\\sigma_\\theta^{e}(r) = p_0 + (p_0 - p_i)\\frac{a^2}{r^2}\n$$\n在 $r=r_p$ 处应用屈服条件 $\\sigma_\\theta = \\alpha\\,\\sigma_r + \\beta$（其中 $\\sigma_\\theta=\\sigma_1$, $\\sigma_r=\\sigma_3$），并使用弹性应力表达式：\n$$\np_0 + (p_0 - p_i)\\frac{a^2}{r_p^2} = \\alpha\\left[p_0 - (p_0 - p_i)\\frac{a^2}{r_p^2}\\right] + \\beta\n$$\n定义 $x \\equiv (a/r_p)^2$ 和 $\\Delta = p_0 - p_i$，该方程可以通过代数重排来求解 $x$：\n$$\np_0 + \\Delta\\,x = \\alpha(p_0 - \\Delta\\,x) + \\beta \\implies \\Delta\\,x(1+\\alpha) = p_0(\\alpha-1) + \\beta\n$$\n$$\nx = \\frac{p_0(\\alpha - 1) + \\beta}{\\Delta(1+\\alpha)}\n$$\n$x$ 的值决定了塑性区的大小。\n1.  如果 $\\Delta = 0$，不存在塑性区，因此 $r_p/a = 1$。\n2.  如果 $x = 0$，岩体足够坚固，在给定条件下应力状态永远不会达到屈服包络线。因此，$r_p/a = 1$。\n3.  只有当隧道壁（$r=a$）处发生屈服时，才会形成塑性区。这对应于 $x  1$。如果 $x >= 1$，岩体各处均保持弹性，因此 $r_p/a = 1$。\n4.  如果存在塑性区（$0  x  1$），其大小由 $r_p/a = 1/\\sqrt{x}$ 给出。\n\n这就完成了该算法的逻辑框架，该算法将被实现以解决所提供的测试案例。", "answer": "```python\nimport numpy as np\n\ndef compute_rp_ratio(a_rad, H, gamma, p_i, sig_ci, m_i, gsi, d):\n    \"\"\"\n    Computes the plastic zone radius ratio r_p/a around a circular tunnel.\n    All pressure/stress inputs are in MPa.\n    \"\"\"\n    \n    # Step 1: Compute geostatic pressure and stress differential\n    p0 = gamma * H / 1000.0\n    \n    # Handle the specific setup for Case 3 where p_i is defined as p0\n    if isinstance(p_i, str) and p_i.lower() == 'p0':\n        p_i_val = p0\n    else:\n        p_i_val = p_i\n\n    delta = p0 - p_i_val\n    \n    # Condition: If support pressure is high enough, no plastic zone forms.\n    if delta = 0:\n        return 1.0\n        \n    # Step 2: Compute Hoek-Brown parameters\n    mb = m_i * np.exp((gsi - 100) / (28 - 14 * d))\n    s = np.exp((gsi - 100) / (9 - 3 * d))\n    a_param = 0.5 + (1/6) * (np.exp(-gsi / 15) - np.exp(-20 / 3))\n    \n    # Step 3: Mohr-Coulomb Linearization\n    sigma_3t = p_i_val\n    \n    # Check for potential math domain error if the term inside the power is negative\n    # This happens if s is very small and sigma_3t is negative, which is not the case here.\n    term_for_k = (mb * sigma_3t / sig_ci) + s\n    if term_for_k  0:\n        # This case is physically unlikely for this problem setup but is a robust check.\n        # It would imply tension, and the H-B criterion has limitations here.\n        # For this problem's constraints, we assume no plastic yielding.\n        return 1.0\n\n    k = 1 + a_param * mb * (term_for_k)**(a_param - 1)\n    \n    alpha = k\n    \n    if k = 1: # a non-frictional or cohesive-only material model may result from linearization\n               # this should not occur for typical rock parameters, implies high strength.\n        return 1.0\n        \n    # Calculate major principal stress from H-B at the tangent point\n    sig1_hb = sigma_3t + sig_ci * (term_for_k)**a_param\n    \n    # Calculate beta from the tangent condition\n    beta = sig1_hb - alpha * sigma_3t\n    \n    # Step 4: Solve for the plastic radius ratio\n    # x = (a/r_p)^2\n    denominator = delta * (1 + alpha)\n    if denominator == 0: # Should be caught by delta = 0, but as a safeguard.\n        return 1.0\n\n    numerator = p0 * (alpha - 1) + beta\n    x = numerator / denominator\n    \n    # Step 5: Report the ratio based on the value of x\n    # if x = 0, rock is too strong, no plastic zone.\n    # if x >= 1, elastic stress state at the wall is within the yield envelope, no plastic zone.\n    if x = 0 or x >= 1:\n        return 1.0\n    \n    # if 0  x  1, a plastic zone exists.\n    rp_over_a = 1.0 / np.sqrt(x)\n    \n    return rp_over_a\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (a, H, gamma, p_i, sig_ci, m_i, GSI, D)\n        (2.5, 500, 27, 0, 80, 10, 55, 0.5),      # Case 1\n        (2.5, 500, 27, 5, 80, 10, 55, 0.5),      # Case 2\n        (2.5, 500, 27, 'p0', 80, 10, 55, 0.5),   # Case 3\n        (3.0, 400, 27, 1.0, 50, 10, 35, 0.7),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_rp_ratio(*case)\n        results.append(result)\n\n    # Format the output as a single line: [res1,res2,res3,res4]\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```", "id": "3569461"}, {"introduction": "隧道系统的稳定性是设计中的关键考量，尤其是在面对非线性行为时。本练习通过一个简化的非线性模型，引入了基于能量原理的稳定性分析方法。您将学习如何通过分析系统总势能的二阶变分($\\delta^{2}\\Pi$)来判断平衡路径的稳定性，并识别可能导致“突跳”(snap-through)等灾难性破坏的极限点，从而对隧道设计的安全性有更深刻的认识[@problem_id:3569440]。", "problem": "为了研究非线性变形地层与弹性支护之间的相互作用，采用收敛-约束法的单自由度简化模型来分析平面应变条件下的圆形隧道。设广义位移为隧道壁收敛量 $u$（单位：$\\text{m}$）。远场地应力 $p_0$（单位：$\\text{MPa}$）为恒载。弹性支护被模型化为一个线性弹簧，其刚度为 $k_s = 5 \\text{ MPa/m}$。周围岩体由一个保守的非线性地层响应来表示，该响应通过广义抗力来描述：\n$$\np_g(u) = A\\,u - B\\,u^{3} + C\\,u^{5},\n$$\n其中 $A = 10 \\text{ MPa/m}$，$B = 150 \\text{ MPa/m}^3$，$C = 500 \\text{ MPa/m}^5$。该耦合保守系统由总势能描述：\n$$\n\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u,\n$$\n其中 $U_g(u)$ 是地层的可恢复储存能量，满足本构功共轭定义 $\\frac{dU_g}{du} = p_g(u)$。\n\n从能量最小化第一性原理出发，利用总势能的平稳性和正定性条件来：\n\n- 推导平衡路径以及该路径上的能量稳定性条件，\n- 评估沿地层响应曲线 (GRC) 平衡路径的二次变分 $\\delta^{2}\\Pi$，\n- 确定平衡路径上能量稳定性丧失的点（即 $\\delta^{2}\\Pi = 0$ 的点），并根据荷载控制与位移控制下的突跳或回弹行为对相应的极限点进行分类。\n\n最后，计算能量稳定性首次丧失时对应的两个远场压力 $p_0$（单位：$\\text{MPa}$）中较小的一个（即 $p_0$–$u$ 路径上两个临界值中较低的一个）。将您的答案四舍五入到四位有效数字，并以 $\\text{MPa}$ 为单位表示最终压力。您最终报告的答案必须是一个实数。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **广义位移**：隧道壁收敛量 $u$（单位：$\\text{m}$）。\n- **远场地应力**：$p_0$（单位：$\\text{MPa}$），为恒载。\n- **支护刚度**：$k_s = 5 \\text{ MPa/m}$。\n- **地层抗力**：$p_g(u) = A\\,u - B\\,u^{3} + C\\,u^{5}$。\n- **地层响应常数**：$A = 10 \\text{ MPa/m}$，$B = 150 \\text{ MPa/m}^3$，$C = 500 \\text{ MPa/m}^5$。\n- **总势能**：$\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u$。\n- **功共轭关系**：$\\frac{dU_g}{du} = p_g(u)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需准则对问题进行评估。\n- **科学基础**：该问题基于收敛-约束法，这是岩石力学和隧道工程中一个标准且成熟的框架。使用势能最小化来寻找平衡和评估稳定性是力学的基本原理。给定的函数和参数与一个简化但有效的非线性力学模型一致。\n- **适定性**：该问题在数学上是适定的。它提供了确定平衡路径及其稳定性所需的所有函数和常数。其目标是找到特定的临界点，这在微积分和稳定性理论中是一个可解的问题。\n- **客观性**：问题陈述由客观的技术语言构成，没有任何主观或有偏见的措辞。\n- **完整性与一致性**：所有参数（$A$、$B$、$C$、$k_s$）和函数关系都已明确给出。单位在整个问题描述中是一致的（$\\text{MPa}$、$\\text{m}$、$\\text{MPa/m}$ 等）。内部没有矛盾。\n- **真实性与可行性**：该模型是一个单自由度的理想化模型，但它代表了隧道初步设计分析中使用的有效简化。数值虽然特定于此问题，但不代表物理上不可能的量。\n- **结构与清晰度**：该问题结构逻辑清晰，引导求解者从第一性原理（势能的平稳性）到最终计算。所使用的术语（例如，平稳性、正定性、突跳）是非线性力学中的标准术语。\n\n### 步骤 3：结论与行动\n该问题科学合理、适定且内部一致。这是计算岩土力学中的一个有效问题。可以开始求解过程。\n\n### 求解推导\n解答源于最小势能原理。平衡状态对应于总势能 $\\Pi(u)$ 的一个驻点。稳定平衡要求该驻点是一个局部极小值点。\n\n首先，我们建立平衡路径。平衡条件是总势能的平稳性，即 $\\delta \\Pi = 0$。对于单自由度系统，这对应于势能相对于广义位移的一阶导数为零：\n$$\n\\frac{d\\Pi}{du} = 0\n$$\n已知总势能 $\\Pi(u) = U_g(u) + \\frac{1}{2} k_s u^2 - p_0 u$ 和功共轭关系 $\\frac{dU_g}{du} = p_g(u)$，其导数为：\n$$\n\\frac{d\\Pi}{du} = \\frac{dU_g}{du} + \\frac{d}{du}\\left(\\frac{1}{2}k_s u^2\\right) - \\frac{d}{du}(p_0 u) = p_g(u) + k_s u - p_0\n$$\n将其设为零可得到平衡方程，该方程定义了平衡状态 $(u, p_0)$ 的路径：\n$$\np_0(u) = p_g(u) + k_s u\n$$\n此方程描述了系统（地层加支护）在给定收敛量 $u$ 下可以承受的总压力。代入 $p_g(u)$ 的表达式：\n$$\np_0(u) = (A u - B u^3 + C u^5) + k_s u = (A + k_s)u - B u^3 + C u^5\n$$\n这就是耦合系统的平衡路径。\n\n接下来，我们建立能量稳定性条件。为使平衡点稳定，它必须是势能的局部极小值点。这要求势能的二次变分为正定，即 $\\delta^2 \\Pi > 0$。对于单自由度系统，这等效于二阶导数为正：\n$$\n\\delta^2 \\Pi = \\frac{d^2\\Pi}{du^2} > 0\n$$\n我们计算 $\\Pi(u)$ 的二阶导数：\n$$\n\\frac{d^2\\Pi}{du^2} = \\frac{d}{du}\\left( \\frac{d\\Pi}{du} \\right) = \\frac{d}{du}\\left( p_g(u) + k_s u - p_0 \\right) = \\frac{dp_g}{du} + k_s\n$$\n注意到 $\\frac{d^2\\Pi}{du^2} = \\frac{dp_0}{du}$。因此，稳定性条件是 $\\frac{dp_0}{du} > 0$，这意味着在荷载控制下要获得稳定响应，所需荷载 $p_0$ 必须随位移 $u$ 的增加而增加。在 $p_0$ 对 $u$ 的关系图上，平衡路径的斜率必须为正。\n\n问题要求找出能量稳定性丧失的点。这发生在稳定区域的边界上，此时二次变分为零：\n$$\n\\delta^2 \\Pi = \\frac{d^2\\Pi}{du^2} = 0\n$$\n计算导数 $\\frac{dp_g}{du}$：\n$$\n\\frac{dp_g}{du} = \\frac{d}{du}(A u - B u^3 + C u^5) = A - 3B u^2 + 5C u^4\n$$\n稳定性丧失的条件变为：\n$$\n(A - 3B u^2 + 5C u^4) + k_s = 0\n$$\n$$\n(A + k_s) - 3B u^2 + 5C u^4 = 0\n$$\n这些点对应于平衡路径 $p_0(u)$ 上的局部极值点（极大值和极小值），在这些点上 $\\frac{dp_0}{du} = 0$。这些是极限点。在荷载控制下（由“恒载”指定），达到这样的点会导致动态地跳跃到另一个平衡状态，这种现象称为“突跳”。该问题的几何形状不允许出现“回弹”行为，因为回弹行为要求位移随着控制参数的前进而减小。\n\n为了找到稳定性丧失时的临界位移 $u_{crit}$，我们求解关于 $u$ 的方程。令 $x = u^2$。该方程是一个关于 $x$ 的二次方程：\n$$\n5C x^2 - 3B x + (A + k_s) = 0\n$$\n代入给定值 $A = 10 \\text{ MPa/m}$，$B = 150 \\text{ MPa/m}^3$，$C = 500 \\text{ MPa/m}^5$ 和 $k_s = 5 \\text{ MPa/m}$：\n$$\n5(500) x^2 - 3(150) x + (10 + 5) = 0\n$$\n$$\n2500 x^2 - 450 x + 15 = 0\n$$\n两边同除以 $5$ 可简化方程为：\n$$\n500 x^2 - 90 x + 3 = 0\n$$\n我们使用二次公式求根 $x_{1,2}$：\n$$\nx = \\frac{-(-90) \\pm \\sqrt{(-90)^2 - 4(500)(3)}}{2(500)} = \\frac{90 \\pm \\sqrt{8100 - 6000}}{1000} = \\frac{90 \\pm \\sqrt{2100}}{1000}\n$$\n$$\nx = \\frac{90 \\pm 10\\sqrt{21}}{1000} = \\frac{9 \\pm \\sqrt{21}}{100}\n$$\n由于 $\\sqrt{21} \\approx 4.58$，$x=u^2$ 的两个根都是正数，因此具有物理意义。令较小的根为 $x_1$，较大的根为 $x_2$：\n$$\nx_1 = u_1^2 = \\frac{9 - \\sqrt{21}}{100} \\approx 0.044174 \\text{ m}^2\n$$\n$$\nx_2 = u_2^2 = \\frac{9 + \\sqrt{21}}{100} \\approx 0.135826 \\text{ m}^2\n$$\n这对应于两个临界的正位移 $u_1 = \\sqrt{x_1}$ 和 $u_2 = \\sqrt{x_2}$。稳定性条件 $\\frac{dp_0}{du} > 0$ 在 $u  u_1$ 和 $u > u_2$ 时满足。平衡路径在 $u_1  u  u_2$ 范围内是不稳定的。因此，$u_1$ 对应于 $p_0(u)$ 的一个局部极大值，$u_2$ 对应于 $p_0(u)$ 的一个局部极小值。\n\n最后一步是通过将这两个临界位移代入平衡路径方程来计算临界压力 $p_{0,crit}$：\n$$\np_0(u) = (A + k_s)u - B u^3 + C u^5 = 15u - 150u^3 + 500u^5\n$$\n我们计算对应于 $u_1$ 和 $u_2$ 的压力：\n$$\np_{0, crit, 1} = p_0(u_1) = 15u_1 - 150u_1^3 + 500u_1^5\n$$\n$$\np_{0, crit, 2} = p_0(u_2) = 15u_2 - 150u_2^3 + 500u_2^5\n$$\n数值计算如下：\n对于 $u_1 = \\sqrt{0.04417424...} \\approx 0.21017670 \\text{ m}$：\n$$\np_{0, crit, 1} = 15(0.21017670) - 150(0.21017670)^3 + 500(0.21017670)^5 \\approx 3.152650 - 1.392715 + 0.205073 \\approx 1.965008 \\text{ MPa}\n$$\n对于 $u_2 = \\sqrt{0.13582576...} \\approx 0.36854546 \\text{ m}$：\n$$\np_{0, crit, 2} = 15(0.36854546) - 150(0.36854546)^3 + 500(0.36854546)^5 \\approx 5.528182 - 7.509015 + 3.400194 \\approx 1.419361 \\text{ MPa}\n$$\n稳定性丧失时的两个临界压力近似为 $1.9650 \\text{ MPa}$ 和 $1.4194 \\text{ MPa}$。问题要求取这两个值中较小的一个。\n$$\n\\min(p_{0, crit, 1}, p_{0, crit, 2}) \\approx 1.419361 \\text{ MPa}\n$$\n将结果四舍五入到四位有效数字，得到 $1.419$。", "answer": "$$\\boxed{1.419}$$", "id": "3569440"}]}