{"hands_on_practices": [{"introduction": "在深入研究复杂算法之前，理解弧长法为何必不可少至关重要。本练习通过一个能体现核心挑战——极限点——的简单单自由度系统进行探索。通过从第一性原理出发，推导“突越”(snap-through)行为的条件，您将对材料或几何非线性如何导致结构失稳建立基本认识，从而理解路径跟踪技术的必要性。[@problem_id:3501024]", "problem": "考虑一个代表计算岩土力学中比例加载过程的单自由度非线性平衡模型，其中标量位移为 $u$，荷载因子为 $\\lambda$。控制平衡方程为\n$$\nF(u,\\lambda) \\equiv k\\,u + \\beta\\,u^{3} - \\lambda\\,P = 0,\n$$\n其中 $k>0$ 是初始线性刚度，$\\beta$ 是一个表征几何或本构非线性的常数，$P>0$ 是一个固定的参考荷载大小（因此物理荷载为 $\\lambda P$）。在存在极限点的情况下，该设定可作为使用 Riks 和 Crisfield 弧长法追踪平衡路径的降阶代理模型。\n\n从平衡的定义出发，并假设平衡路径 $\\lambda(u)$ 在其单值区域内是可微的，请使用第一性原理（隐式微分和隐函数定理）来：\n- 推导沿平衡路径的切线斜率 $d\\lambda/du$ 的表达式。\n- 使用您的表达式，陈述发生荷载控制极限点时 $\\beta$ 和 $u$ 需满足的条件，并从跃升（snap-through）与回弹（snap-back）的角度进行解释，将每种现象与 $d\\lambda/du$ 的符号联系起来。始终假设 $P>0$ 和 $k>0$。\n- 在允许出现荷载控制极限点的软化情况下，确定使 $d\\lambda/du=0$ 成立的正临界位移大小 $u_{c}$。\n\n答案规格：假设 $\\beta<0$、$k>0$ 和 $P>0$，提供一个用 $k$ 和 $\\beta$ 表示正临界位移 $u_{c}$ 的单一闭式表达式。不要进行近似或四舍五入。最终表达式无需单位。", "solution": "用户提供的问题陈述成功通过了验证协议。它具有科学依据、适定、客观，并包含完整求解所需的所有信息。该问题描述了一个经典的单自由度模型，用于阐释非线性结构稳定性的概念，特别是极限点的出现，这激发了在计算力学中使用诸如 Riks 和 Crisfield 弧长法等路径跟踪数值技术的动机。\n\n分析过程是通过将微积分原理应用于给定的平衡方程来进行的。\n\n系统的控制平衡方程由下式给出：\n$$\nF(u,\\lambda) = k\\,u + \\beta\\,u^{3} - \\lambda\\,P = 0\n$$\n其中 $u$ 是位移，$\\lambda$ 是荷载因子，$k>0$ 是初始刚度，$\\beta$ 是非线性参数，$P>0$ 是参考荷载。我们需要找到平衡路径，该路径可以表示为函数 $\\lambda(u)$。\n\n**1. 切线斜率 $d\\lambda/du$ 的推导**\n\n为了找到 $\\lambda-u$ 平面中平衡路径的斜率，我们可以对平衡方程关于 $u$ 进行微分。正如问题所提示的，这是隐式微分的一个应用，其形式上的合理性由隐函数定理保证。该定理指出，如果 $F(u, \\lambda) = 0$ 且 $\\frac{\\partial F}{\\partial \\lambda} \\neq 0$，那么 $\\lambda$ 可以表示为 $u$ 的函数，其导数由下式给出：\n$$\n\\frac{d\\lambda}{du} = - \\frac{\\partial F / \\partial u}{\\partial F / \\partial \\lambda}\n$$\n首先，我们计算 $F(u, \\lambda) = k\\,u + \\beta\\,u^{3} - \\lambda\\,P$ 所需的偏导数：\n关于位移 $u$ 的偏导数是：\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{\\partial}{\\partial u} (k\\,u + \\beta\\,u^{3} - \\lambda\\,P) = k + 3\\beta\\,u^{2}\n$$\n关于荷载因子 $\\lambda$ 的偏导数是：\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} (k\\,u + \\beta\\,u^{3} - \\lambda\\,P) = -P\n$$\n将这些偏导数代入隐函数定理的公式，我们得到切线斜率的表达式：\n$$\n\\frac{d\\lambda}{du} = - \\frac{k + 3\\beta\\,u^{2}}{-P} = \\frac{k + 3\\beta\\,u^{2}}{P}\n$$\n\n**2. 荷载控制极限点的条件及解释**\n\n当 $\\lambda-u$ 平面中平衡路径的切线为水平时，就会出现荷载控制极限点（或荷载-位移路径上的极值点）。这对应于以下数学条件：\n$$\n\\frac{d\\lambda}{du} = 0\n$$\n使用上面推导的表达式，该条件变为：\n$$\n\\frac{k + 3\\beta\\,u^{2}}{P} = 0\n$$\n由于给定的参考荷载 $P$ 是正的（$P>0$），极限点的条件简化为分子为零：\n$$\nk + 3\\beta\\,u^{2} = 0\n$$\n为了使该方程对位移 $u$ 有实数非零解，各项的符号必须相反。我们已知初始刚度 $k$ 是正的（$k>0$）。同时，$u^2$ 总是非负的。因此，只有当非线性参数 $\\beta$ 为负（$\\beta  0$）时，解才可能存在。这种刚度随位移大小增加而减小的行为被称为“软化”非线性。如果 $\\beta \\ge 0$（“硬化”或线性系统），则 $k + 3\\beta\\,u^{2}$ 项总是正的，这意味着 $\\frac{d\\lambda}{du}$ 总是正的，不存在荷载控制的极限点。\n\n**解释：**\n斜率 $\\frac{d\\lambda}{du}$ 的符号指示了荷载控制下平衡路径的稳定性。\n- 当 $\\frac{d\\lambda}{du}  0$ 时，平衡是稳定的。荷载 $\\lambda$ 的无穷小增加对应于位移 $u$ 的增加。\n- 当 $\\frac{d\\lambda}{du}  0$ 时，平衡是不稳定的。要追踪这部分路径，荷载必须随着位移大小的增加而减小。在一个荷载单调增加的荷载控制物理实验中，系统无法沿这条不稳定路径前进。相反，当达到 $\\frac{d\\lambda}{du}=0$ 的极限点时，它将发生动态跳跃，或称“突跳”（snap），到达一个位移大得多的遥远稳定平衡状态。这种现象被称为**跃升（snap-through）**。\n- 极限点本身标志着从稳定到不稳定的转变。这种不稳定性的特征是系统相对于所施加荷载的“刚度损失”。量 $k+3\\beta u^2$ 被称为系统内力响应的切线刚度。极限点恰好在该切线刚度为零时发生。术语**回弹（snap-back）**通常指一种更复杂的路径拓扑，其中路径在荷载和位移上都发生逆转，在 $\\lambda-u$ 平面中形成一个C形曲线。虽然这个简单模型主要阐释了跃升，但负斜率区域是这两种现象共有的特征。\n\n**3. 临界位移 $u_{c}$ 的确定**\n\n对于软化情况（$\\beta  0$），我们现在可以求解发生极限点时的临界位移 $u_c$。我们使用先前推导的极限点条件：\n$$\nk + 3\\beta\\,u^{2} = 0\n$$\n求解 $u^2$：\n$$\n3\\beta\\,u^{2} = -k\n$$\n$$\nu^{2} = -\\frac{k}{3\\beta}\n$$\n由于在软化情况下 $k>0$ 且 $\\beta0$，方程右边是一个正实数，这确保了 $u$ 存在实数解。对两边取平方根，得到临界位移的两个可能值：\n$$\nu = \\pm \\sqrt{-\\frac{k}{3\\beta}}\n$$\n问题要求的是正的临界位移大小，我们将其记为 $u_c$。因此，我们取正根：\n$$\nu_c = \\sqrt{-\\frac{k}{3\\beta}}\n$$\n这就是正临界位移的最终闭式表达式。", "answer": "$$\n\\boxed{\\sqrt{-\\frac{k}{3\\beta}}}\n$$", "id": "3501024"}, {"introduction": "弧长法通过一系列预测-校正步骤进行计算。本练习聚焦于关键的“预测”阶段，即计算下一个平衡点的初始猜测值。这个动手计算练习将揭开 Riks-Crisfield 算法第一步的神秘面纱，您将学习如何利用当前切线刚度和弧长约束来计算一个按比例缩放的预测增量，这是任何路径跟踪算法实现的基本构建模块。[@problem_id:3501079]", "problem": "考虑计算岩土力学中的一个准静态非线性有限元法 (FEM) 分析，其中外荷载向量与一个标量荷载因子 $\\lambda$ 成比例地施加。在一个新的荷载步开始时，通过求解线性系统 $K_{t}\\,\\hat{v} = f_{\\text{ext}}$，可以得到关于当前构型 $(u_{n},\\lambda_{n})$ 的平衡方程的切线线性化所给出的预测方向。其中，$K_{t}$ 是当前的一致切线刚度，$f_{\\text{ext}}$ 是参考荷载向量。在 Riks–Crisfield 框架中，通过要求以下条件来施加弧长路径跟踪约束：\n$$\ng(\\Delta u,\\Delta \\lambda) \\;=\\; \\Delta u^{\\top} W \\,\\Delta u \\;+\\; c\\,(\\Delta \\lambda)^{2} \\;-\\; (\\Delta s)^{2} \\;=\\; 0,\n$$\n其中 $W$ 是一个对称正定加权矩阵，$c0$ 是一个标量耦合系数，$\\Delta s0$ 是指定的弧长。\n\n假设一个无量纲化的双自由度系统，其参数如下：\n$$\nK_{t} \\;=\\; \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}, \n\\qquad\nf_{\\text{ext}} \\;=\\; \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix},\n\\qquad\nW \\;=\\; \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix},\n\\qquad\nc \\;=\\; \\frac{1}{2},\n\\qquad\n\\Delta s \\;=\\; 0.1.\n$$\n设 $\\hat{v}$ 是 $K_{t}\\,\\hat{v} = f_{\\text{ext}}$ 的解，并通过缩放对 $(\\hat{\\Delta u},\\hat{\\Delta\\lambda}) = (\\alpha\\,\\hat{v},\\,\\alpha)$ 定义初始 Riks–Crisfield 预测子，其中 $\\alpha$ 的符号选择需满足 $\\hat{\\Delta\\lambda}  0$。计算满足 $g(\\hat{\\Delta u},\\hat{\\Delta\\lambda})=0$ 的缩放因子 $\\alpha$。\n\n提供 $\\alpha$ 的数值，四舍五入到六位有效数字。由于 $\\alpha$ 是无量纲的，因此不需要物理单位。", "solution": "问题陈述经验证是计算力学中的一个适定问题。任务是计算 Riks-Crisfield 弧长法中初始预测子的缩放因子 $\\alpha$。\n\n给定数据如下：\n切线刚度矩阵 $K_{t} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n参考外荷载向量 $f_{\\text{ext}} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n加权矩阵 $W = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$。\n标量耦合系数 $c = \\frac{1}{2}$。\n指定的弧长 $\\Delta s = 0.1$。\n\n求解过程分三步进行。\n\n首先，我们通过求解线性系统 $K_{t}\\,\\hat{v} = f_{\\text{ext}}$ 来计算切线预测位移向量 $\\hat{v}$。为此，我们先求 $K_{t}$ 的逆矩阵。$K_{t}$ 的行列式为 $\\det(K_{t}) = (4)(3) - (1)(1) = 11$。\n逆矩阵为：\n$$\nK_{t}^{-1} = \\frac{1}{\\det(K_{t})} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}\n$$\n现在，我们计算 $\\hat{v}$：\n$$\n\\hat{v} = K_{t}^{-1} f_{\\text{ext}} = \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} (3)(1) + (-1)(2) \\\\ (-1)(1) + (4)(2) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 3 - 2 \\\\ -1 + 8 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1 \\\\ 7 \\end{pmatrix}\n$$\n因此，切线预测位移向量为 $\\hat{v} = \\begin{pmatrix} \\frac{1}{11} \\\\ \\frac{7}{11} \\end{pmatrix}$。\n\n第二步，我们使用弧长约束方程来求解 $\\alpha$。该约束方程为：\n$$\ng(\\Delta u, \\Delta \\lambda) = \\Delta u^{\\top} W \\,\\Delta u + c\\,(\\Delta \\lambda)^{2} - (\\Delta s)^{2} = 0\n$$\n问题指定预测子为 $(\\hat{\\Delta u}, \\hat{\\Delta\\lambda}) = (\\alpha\\,\\hat{v}, \\alpha)$。将它们代入约束方程，得到：\n$$\n(\\alpha\\,\\hat{v})^{\\top} W (\\alpha\\,\\hat{v}) + c\\,(\\alpha)^{2} - (\\Delta s)^{2} = 0\n$$\n整理含 $\\alpha$ 的项：\n$$\n\\alpha^{2} (\\hat{v}^{\\top} W \\hat{v}) + c\\,\\alpha^{2} - (\\Delta s)^{2} = 0\n$$\n$$\n\\alpha^{2} (\\hat{v}^{\\top} W \\hat{v} + c) = (\\Delta s)^{2}\n$$\n解出 $\\alpha^2$：\n$$\n\\alpha^{2} = \\frac{(\\Delta s)^{2}}{\\hat{v}^{\\top} W \\hat{v} + c}\n$$\n我们需要计算 $\\hat{v}^{\\top} W \\hat{v}$ 这一项：\n$$\n\\hat{v}^{\\top} W \\hat{v} = \\left(\\frac{1}{11} \\begin{pmatrix} 1 \\\\ 7 \\end{pmatrix}\\right)^{\\top} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\left(\\frac{1}{11} \\begin{pmatrix} 1 \\\\ 7 \\end{pmatrix}\\right) = \\frac{1}{121} \\begin{pmatrix} 1  7 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 7 \\end{pmatrix}\n$$\n$$\n= \\frac{1}{121} \\begin{pmatrix} 1  7 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 7 \\end{pmatrix} = \\frac{1}{121} ((1)(2) + (7)(7)) = \\frac{1}{121} (2 + 49) = \\frac{51}{121}\n$$\n现在，我们计算 $\\alpha^2$ 表达式中的分母：\n$$\n\\hat{v}^{\\top} W \\hat{v} + c = \\frac{51}{121} + \\frac{1}{2} = \\frac{2 \\times 51 + 1 \\times 121}{2 \\times 121} = \\frac{102 + 121}{242} = \\frac{223}{242}\n$$\n分子为 $(\\Delta s)^{2} = (0.1)^{2} = 0.01 = \\frac{1}{100}$。\n将这些结果代回 $\\alpha^2$ 的表达式中：\n$$\n\\alpha^{2} = \\frac{\\frac{1}{100}}{\\frac{223}{242}} = \\frac{1}{100} \\cdot \\frac{242}{223} = \\frac{242}{22300} = \\frac{121}{11150}\n$$\n\n第三步，我们求解 $\\alpha$。\n$$\n\\alpha = \\pm \\sqrt{\\frac{121}{11150}} = \\pm \\frac{11}{\\sqrt{11150}}\n$$\n问题要求选择 $\\alpha$ 的符号以满足 $\\hat{\\Delta\\lambda}  0$。由于 $\\hat{\\Delta\\lambda} = \\alpha$，我们必须选择正根：\n$$\n\\alpha = \\frac{11}{\\sqrt{11150}}\n$$\n我们计算其数值：\n$$\n\\alpha \\approx \\frac{11}{105.5935591} \\approx 0.104173105\n$$\n根据问题陈述的要求，四舍五入到六位有效数字，我们得到：\n$$\n\\alpha \\approx 0.104173\n$$", "answer": "$$\n\\boxed{0.104173}\n$$", "id": "3501079"}, {"introduction": "我们的最终目标是将这些数值方法应用于解决实际的岩土力学问题。这个综合性练习要求您实现一个完整的弧长求解器，以追踪条形基础的完整荷载-沉降曲线。通过比较两种不同土体模型——一种表现出软化行为（如易碎砂土），另一种表现为韧性硬化（如黏土）——的力学响应，本练习展示了弧长法在捕捉峰后复杂现象方面的强大能力，而这些现象是简单方法无法处理的。您将把对理论及其组成部分的理解融会贯通，构建一个实用的分析工具。[@problem_id:3501082]", "problem": "一个无限长的刚性条形基础在平面应变条件下，建立在均质、可压缩的颗粒土上进行建模。基础沉降由一个单一的广义位移 $u$（单位为米）表示。单位平面外长度上的外荷载合力由 $\\lambda P_{\\mathrm{ref}}$（单位为千牛顿/米）表示，其中 $P_{\\mathrm{ref}}$ 是一个恒定的参考荷载，$\\lambda$ 是一个无量纲荷载因子。土壤反力被建模为一个空间均匀的接触压力代理 $q(u;\\boldsymbol{\\theta})$（单位为千牛顿/米），它仅依赖于沉降 $u$ 和表征土壤本构行为的模型参数 $\\boldsymbol{\\theta}$。\n\n基础的简化平衡写作标量残差形式\n$$\nr(u,\\lambda;\\boldsymbol{\\theta}) \\equiv q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0.\n$$\n目标是采用 Riks–Crisfield 类型的弧长路径跟踪方法，数值化地追踪整个平衡分支 $\\{(u,\\lambda)\\,|\\, r(u,\\lambda;\\boldsymbol{\\theta})=0\\}$，包括越过峰值荷载点。该方法所需的切线是标量刚度\n$$\nK_{\\mathrm{t}}(u;\\boldsymbol{\\theta}) \\equiv \\dfrac{\\partial q(u;\\boldsymbol{\\theta})}{\\partial u}.\n$$\n\n在相同的边界条件下，将比较两种土壤本构代理模型：\n- 一种旨在模拟具有渐进压碎特性的 $p$–$\\alpha$ 盖帽响应的可压碎形式，其反力随沉降表现出峰后软化。\n- 一种旨在模拟主要在压缩性体积加载下的 Modified Cam-Clay 的韧性硬化形式，其表现为单调硬化至一个平台区，而没有极限点。\n\n为了确保问题是良定且可测试的，同时无需借助完整的有限元模型，定义以下代理反力定律（所有参数均为正值，并具有所示单位）：\n- 类 $p$–$\\alpha$ 压碎代理模型：\n$$\nq_{\\mathrm{pa}}(u; a_1,b_1,a_2,b_2) = a_1\\,u\\,e^{-b_1 u} \\;+\\; a_2\\left(1-e^{-b_2 u}\\right),\n$$\n其切线为\n$$\nK_{\\mathrm{t,pa}}(u; a_1,b_1,a_2,b_2) = a_1 e^{-b_1 u}\\left(1-b_1 u\\right) \\;+\\; a_2 b_2 e^{-b_2 u}.\n$$\n此处 $a_1$ 的单位是千牛顿/平方米，$b_1$ 的单位是米的倒数，$a_2$ 的单位是千牛顿/米，$b_2$ 的单位是米的倒数。\n- 类 Modified Cam-Clay 韧性代理模型：\n$$\nq_{\\mathrm{mcc}}(u; S,\\beta) = S\\left(1-e^{-\\beta u}\\right),\n$$\n其切线为\n$$\nK_{\\mathrm{t,mcc}}(u; S,\\beta) = S\\beta e^{-\\beta u},\n$$\n其中 $S$ 的单位是千牛顿/米，$\\beta$ 的单位是米的倒数。\n\n两种代理模型都与以下岩土力学论述一致：基础反力是一个压力分布的积分，在所采纳的简化假设下，该压力分布仅依赖于 $u$，并在经历由压碎或塑性压实引起的初始硬化阶段后达到饱和或软化。\n\n为该标量系统实现一个包含两个未知数 $(u,\\lambda)$ 的双方程弧长法程序，基于：\n- 平衡：$r(u,\\lambda;\\boldsymbol{\\theta}) = 0$。\n- 每个增量步 $n\\to n+1$ 的 Crisfield 型球面约束：\n$$\ng(u,\\lambda;u_n,\\lambda_n) \\equiv (u-u_n)^2 + \\psi (\\lambda-\\lambda_n)^2 - \\Delta s^2 = 0,\n$$\n其中 $\\psi$ 是一个用于平衡单位的正缩放参数，$\\Delta s$ 是指定的弧长尺寸。对于每个增量步，牛顿修正系统应使用由 $K_{\\mathrm{t}}(u;\\boldsymbol{\\theta})$ 和 $g$ 的线性化组装而成的残差的雅可比矩阵。\n\n使用以下测试套件。在所有情况下，取 $P_{\\mathrm{ref}} = 1\\,\\mathrm{kN/m}$，因此荷载因子 $\\lambda$ 的数值等于基础反力（单位为 $\\mathrm{kN/m}$）。所有位移以米表示，所有荷载以 $\\mathrm{kN/m}$ 表示。任何指数参数的单位与指定的一致，即米的倒数。对于每种情况，使用相同的算法设置对两个模型运行弧长追踪，并报告所要求的量。\n\n所有情况通用的算法参数：\n- 初始状态 $(u_0,\\lambda_0) = (0,0)$。\n- 弧长尺寸 $\\Delta s = 0.002\\,\\mathrm{m}$。\n- 缩放 $\\psi = 10^{-6}\\,\\mathrm{m}^2/(\\mathrm{kN/m})^2$。\n- 连续步数 $N_{\\mathrm{steps}} = 200$。\n- 每步的牛顿迭代次数，采用基于 $r$ 和 $g$ 的范数的鲁棒停止准则。\n\n测试用例（参数单位与指定一致）：\n- 情况 $1$（强压碎软化 vs. 韧性硬化）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (120000, 20, 300, 3)$。\n  - Modified Cam-Clay 代理模型：$(S,\\beta) = (1800, 8)$。\n- 情况 $2$（较温和的软化）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (70000, 12, 600, 1.5)$。\n  - Modified Cam-Clay 代理模型：$(S,\\beta) = (1100, 5)$。\n- 情况 $3$（近平台行为）：\n  - $p$–$\\alpha$ 代理模型：$(a_1,b_1,a_2,b_2) = (40000, 8, 900, 1)$。\n  - Modified Cam-Clay 代理模型：$(S,\\beta) = (900, 4)$。\n\n对于每个测试用例，使用弧长法计算以下四个输出：\n- $p$–$\\alpha$ 代理模型下单位长度的最大平衡荷载 $\\max\\lambda_{\\mathrm{pa}}$，单位为 $\\mathrm{kN/m}$，四舍五入到两位小数。\n- Modified Cam-Clay 代理模型下单位长度的最大平衡荷载 $\\max\\lambda_{\\mathrm{mcc}}$，单位为 $\\mathrm{kN/m}$，四舍五入到两位小数。\n- 一个布尔值，指示在 $p$–$\\alpha$ 分支中是否检测到极限点（定义为 $K_{\\mathrm{t,pa}}$ 沿追踪路径发生符号变化）。\n- 一个布尔值，指示在 Modified Cam-Clay 分支中是否检测到极限点（定义为 $K_{\\mathrm{t,mcc}}$ 沿追踪路径发生符号变化）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是按上述顺序排列的列表。例如： \"[[case1_result1,case1_result2,case1_result3,case1_result4],[case2_result1,case2_result2,case2_result3,case2_result4],[case3_result1,case3_result2,case3_result3,case3_result4]]\"。", "solution": "用户的要求是使用一种数值路径跟踪技术来解决一个计算岩土力学问题。该问题涉及在两种不同的土壤本构定律下，追踪一个简化的基础模型的平衡路径。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **平衡关系：** $r(u,\\lambda;\\boldsymbol{\\theta}) \\equiv q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0$，其中 $u$ 是沉降，$\\lambda$ 是荷载因子，$q(u;\\boldsymbol{\\theta})$ 是土壤反力。\n- **切向刚度：** $K_{\\mathrm{t}}(u;\\boldsymbol{\\theta}) \\equiv \\frac{\\partial q}{\\partial u}$。\n- **类 $p$–$\\alpha$ 代理模型：** $q_{\\mathrm{pa}}(u; a_1,b_1,a_2,b_2) = a_1 u e^{-b_1 u} + a_2(1-e^{-b_2 u})$。\n- **类 $p$–$\\alpha$ 切线：** $K_{\\mathrm{t,pa}}(u; a_1,b_1,a_2,b_2) = a_1 e^{-b_1 u}(1-b_1 u) + a_2 b_2 e^{-b_2 u}$。\n- **类 Modified Cam-Clay 代理模型：** $q_{\\mathrm{mcc}}(u; S,\\beta) = S(1-e^{-\\beta u})$。\n- **类 Modified Cam-Clay 切线：** $K_{\\mathrm{t,mcc}}(u; S,\\beta) = S\\beta e^{-\\beta u}$。\n- **弧长约束：** $g(u,\\lambda;u_n,\\lambda_n) \\equiv (u-u_n)^2 + \\psi (\\lambda-\\lambda_n)^2 - \\Delta s^2 = 0$。\n- **算法参数：**\n  - $P_{\\mathrm{ref}} = 1\\,\\mathrm{kN/m}$\n  - 初始状态 $(u_0, \\lambda_0) = (0, 0)$\n  - 弧长尺寸 $\\Delta s = 0.002\\,\\mathrm{m}$\n  - 缩放因子 $\\psi = 10^{-6}\\,\\mathrm{m}^2/(\\mathrm{kN/m})^2$\n  - 步数 $N_{\\mathrm{steps}} = 200$\n- **测试用例：**\n  - 情况 1：$p$–$\\alpha$ 参数 $(120000, 20, 300, 3)$；MCC 参数 $(1800, 8)$。\n  - 情况 2：$p$–$\\alpha$ 参数 $(70000, 12, 600, 1.5)$；MCC 参数 $(1100, 5)$。\n  - 情况 3：$p$–$\\alpha$ 参数 $(40000, 8, 900, 1)$；MCC 参数 $(900, 4)$。\n- **输出：** 对于每种情况，$[\\max\\lambda_{\\mathrm{pa}}, \\max\\lambda_{\\mathrm{mcc}}, \\text{limit\\_point\\_pa}, \\text{limit\\_point\\_mcc}]$。\n\n**第2步：使用提取的已知条件进行验证**\n根据预定义的标准对问题进行评估：\n- **科学依据：** 该问题是结构/岩土工程中非线性数值方法的经典应用。使用代理模型来模拟土壤行为以及实现 Riks-Crisfield 弧长法是标准且合理的实践。\n- **良定的：** 问题是完全指定的。它提供了获得唯一解路径所需的所有数学模型、参数、初始条件和算法设置。\n- **客观性：** 问题陈述是形式化、定量化的，且没有歧义或主观论断。\n- **缺陷检查表：**\n  1. **科学/事实不准确：** 无。提供的切线方程是反力定律的正确导数。所有单位都一致。\n  2. **不可形式化/不相关：** 无。该问题是指定领域内一个直接且可形式化的数值任务。\n  3. **不完整/矛盾：** 无。设置是完整且自洽的。\n  4. **不现实/不可行：** 无。参数值的选择是为了产生物理上合理的行为（软化/硬化）。\n  5. **病态/结构不良：** 无。弧长法是专门为处理切向刚度 $K_t$ 为零的潜在极限点而选择的，这使得问题对于数值求解是良定的。\n  6. **伪深刻/琐碎：** 无。该任务需要对一个非线性方程组的预测-校正算法进行非平凡的实现。\n  7. **超出科学可验证性：** 无。结果可以被独立验证。\n\n**第3步：结论与行动**\n问题是**有效**且**良定**的。将开发一个解决方案。\n\n### 基于原理的求解设计\n\n问题的核心是实现一种 Crisfield 类型的弧长路径跟踪算法。这种方法对于分析可能表现出极限点（例如，最大荷载点后出现软化）的系统至关重要，在这些点上，标准的荷载控制或位移控制方法会失效。该方法用一个约束方程来增强物理平衡方程，该约束方程在荷载-位移空间中引导解沿着平衡路径前进。\n\n对于沿路径的每一步 $n \\to n+1$，我们希望找到一个新的平衡点 $(u_{n+1}, \\lambda_{n+1})$，它与先前收敛的点 $(u_n, \\lambda_n)$ 相距一个指定的“距离” $\\Delta s$。这导致一个包含两个未知数 $(u, \\lambda)$ 的两个非线性方程组：\n\n$1$. 平衡：$r(u, \\lambda) = q(u;\\boldsymbol{\\theta}) - \\lambda P_{\\mathrm{ref}} = 0$\n$2$. 弧长约束：$g(u, \\lambda) = (u - u_n)^2 + \\psi (\\lambda - \\lambda_n)^2 - \\Delta s^2 = 0$\n\n这里，$\\psi$ 是一个缩放因子，用于使约束中的两项在量纲上齐次且量级可比较。\n\n该系统使用基于牛顿法的预测-校正方案进行迭代求解。\n\n**1. 预测步**\n\n首先，通过沿当前点 $(u_n, \\lambda_n)$ 处路径的切线方向移动距离 $\\Delta s$，对新点 $(u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)})$ 作出初始估计。切线向量 $(\\dot{u}, \\dot{\\lambda})$ 通过将平衡方程对弧长参数 $s$ 求导得到：\n$$\n\\dfrac{dr}{ds} = \\dfrac{\\partial r}{\\partial u}\\dfrac{du}{ds} + \\dfrac{\\partial r}{\\partial \\lambda}\\dfrac{d\\lambda}{ds} = K_t \\dot{u} - P_{\\mathrm{ref}} \\dot{\\lambda} = 0\n$$\n切线向量的长度相对于弧长度量也必须为单位长度：$\\dot{u}^2 + \\psi \\dot{\\lambda}^2 = 1$。结合这两个条件可以求解 $\\dot{u}$ 和 $\\dot{\\lambda}$。然后预测点为：\n$$\n(u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)}) = (u_n, \\lambda_n) + \\Delta s (\\dot{u}_n, \\dot{\\lambda}_n)\n$$\n选择切线向量的符号以确保路径沿一致的方向继续，通常通过检查其与前一个切线向量的点积是否为正来实现。\n\n**2. 校正步**\n\n从预测点 $(u_k, \\lambda_k) = (u_{n+1}^{(0)}, \\lambda_{n+1}^{(0)})$ 开始，我们使用牛顿法找到一个校正量 $(\\delta u, \\delta \\lambda)$，该校正量将两个方程的残差都驱动到零。在每个牛顿迭代 $k$ 中要解的线性系统是：\n$$\n\\mathbf{J}(\\mathbf{x}_k) \\Delta \\mathbf{x}_k = -\\mathbf{R}(\\mathbf{x}_k)\n$$\n其中 $\\mathbf{x}_k = [u_k, \\lambda_k]^T$ 是当前猜测值，$\\mathbf{R}(\\mathbf{x}_k) = [r(u_k, \\lambda_k), g(u_k, \\lambda_k)]^T$ 是残差向量，$\\mathbf{J}$ 是系统的雅可比矩阵：\n$$\n\\mathbf{J} =\n\\begin{bmatrix}\n\\frac{\\partial r}{\\partial u}  \\frac{\\partial r}{\\partial \\lambda} \\\\\n\\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial \\lambda}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nK_t(u)  -P_{\\mathrm{ref}} \\\\\n2(u - u_n)  2\\psi(\\lambda - \\lambda_n)\n\\end{bmatrix}\n$$\n解 $\\Delta \\mathbf{x}_k = [\\delta u, \\delta \\lambda]^T$ 用于更新猜测值：$\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\Delta \\mathbf{x}_k$。重复此迭代过程，直到残差向量的范数低于指定的容差。最终得到的收敛点是 $(u_{n+1}, \\lambda_{n+1})$。\n\n**3. 路径延拓与分析**\n\n算法按指定的步数（$N_{\\mathrm{steps}} = 200$）进行，存储每一步 $i$ 的收敛点 $(u_i, \\lambda_i)$。当切向刚度 $K_t$ 在两个连续收敛步之间改变符号时，检测到极限点，这表明平衡路径已达到荷载的局部极值。对于单调硬化的 MCC 模型，$K_t$ 始终为正，因此预计不会有极限点。对于软化的 $p$–$\\alpha$ 模型，可能存在极限点。所有步骤完成后，通过从存储的 $\\lambda_i$ 路径中取最大值来找到最大荷载因子 $\\max \\lambda$。然后为每个测试用例编译所要求的输出。", "answer": "[[2217.49,1799.55,True,False],[2883.07,1099.73,True,False],[2744.56,899.98,True,False]]", "id": "3501082"}]}