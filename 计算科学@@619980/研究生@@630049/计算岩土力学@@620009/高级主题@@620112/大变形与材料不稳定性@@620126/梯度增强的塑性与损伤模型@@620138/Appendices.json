{"hands_on_practices": [{"introduction": "在上一个练习中，我们从数值上验证了梯度模型能够有效正则化应变局部化问题，现在我们将通过解析分析来探究其内在机理。本练习将引导您推导在一个一维杆中，由梯度损伤模型描述的损伤局部化带内的损伤分布廓形。这个推导的最终目标是揭示模型的内禀长度尺度 $l$ 如何直接决定局部化带的宽度，从而为这一关键参数赋予明确的物理意义[@problem_id:3528898]。", "problem": "考虑一根占据区间 $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$ 的一维单轴杆，该杆承受小应变，并受到规定的端到端位移，从而在远场产生空间均匀的名义拉伸应变。该杆采用 Ambrosio-Tortorelli 2 型 (AT2) 相场损伤公式进行建模，其中位移场为 $u(x)$，标量损伤场为 $\\alpha(x) \\in [0,1]$，杨氏模量为 $E$，临界能量释放率为 $G_c$。假设为纯拉伸状态，并忽略残余刚度正则化。总能量泛函为\n$$\n\\Pi[u,\\alpha] \\;=\\; \\int_{-L/2}^{L/2} \\left[ g(\\alpha)\\,\\psi_e(\\varepsilon) \\;+\\; G_c\\left(\\frac{\\alpha^2}{2\\,l} \\;+\\; \\frac{l}{2}\\,(\\alpha')^2\\right) \\right] \\,\\mathrm{d}x,\n$$\n其中退化函数为 $g(\\alpha)=(1-\\alpha)^2$，弹性应变能密度为 $\\psi_e(\\varepsilon) = \\tfrac{1}{2} E\\,\\varepsilon^2$，应变为 $\\varepsilon(x)=u'(x)$，内禀长度尺度为 $l>0$。假设 $L \\gg l$，从而损伤区与边界充分分离；并假设在峰值载荷下，损伤在 $x=0$ 附近发生局部化，而远场基本保持弹性，具有近似均匀的拉伸应变。\n\n从最小势能原理及相关的欧拉-拉格朗日方程出发，结合率无关损伤不可逆条件，在峰值载荷附近并假设远场存在微小但非零的峰值载荷损伤的条件下，推导出一维损伤分布 $\\alpha(x)$ 的领头阶闭合形式解。然后，将局部化宽度 $w$ 定义为超额损伤（超出其远场值的部分）的半峰全宽 (FWHM)，即对于 $\\beta(x) \\equiv \\alpha(x)-\\alpha_{\\infty}$ (其中 $\\alpha_{\\infty} \\equiv \\lim_{|x|\\to\\infty} \\alpha(x)$)，令 $w$ 满足 $\\beta\\!\\left(\\tfrac{w}{2}\\right) = \\tfrac{1}{2}\\,\\beta(0)$。使用此定义显式表达 $w$，并讨论其如何依赖于 $l$ 和 $E$。\n\n作答要求：\n- 给出 $\\alpha(x)$ 的完整推导过程以及得到 $w$ 的推理过程。\n- 以 $w$ 关于 $l$ 和 $E$ 的闭合形式解析表达式报告最终答案。不要代入数值。在最终的方框答案中不要包含单位。在解题过程中解释 $w$ 是否以及如何依赖于 $E$。\n- 以米为单位表示最终宽度。", "solution": "本题要求推导由 Ambrosio-Tortorelli (AT2) 相场损伤模型描述的一维杆的损伤分布和局部化宽度。\n\n首先，我们必须验证问题的陈述。\n已知条件如下：\n- 区域为一维杆，$x \\in [-L/2, L/2]$。\n- 状态变量为位移场 $u(x)$ 和损伤场 $\\alpha(x) \\in [0,1]$。\n- 物理常数为杨氏模量 $E$ 和临界能量释放率 $G_c$。\n- 总能量泛函为 $\\Pi[u,\\alpha] = \\int_{-L/2}^{L/2} \\left[ g(\\alpha)\\,\\psi_e(\\varepsilon) + G_c\\left(\\frac{\\alpha^2}{2\\,l} + \\frac{l}{2}\\,(\\alpha')^2\\right) \\right] \\,\\mathrm{d}x$。\n- 本构函数和定义为：退化函数 $g(\\alpha)=(1-\\alpha)^2$，弹性应变能密度 $\\psi_e(\\varepsilon) = \\frac{1}{2} E\\,\\varepsilon^2$，应变 $\\varepsilon(x)=u'(x)$，以及内禀长度尺度 $l>0$。\n- 假设包括 $L \\gg l$，$x=0$ 处发生局部化，以及“远场存在微小但非零的峰值载荷损伤”，记为 $\\alpha_{\\infty}$。\n\n该问题具有科学依据，采用了计算力学中的标准公式。它在很大程度上是适定且客观的。然而，存在一个微妙的矛盾。对于指定的 AT2 模型，峰值载荷条件（从均匀状态发生分岔）发生在远场损伤值为 $\\alpha_{\\infty} = 1/4$ 时，这并非一个很小的值。因此，问题中“远场存在微小但非零的峰值载荷损伤”的假设与模型在峰值载荷下的性质直接冲突。为了继续求解，我们必须将此解释为寻找一个“领头阶”解的指令，该解对应于远场损伤很小（$\\alpha_{\\infty} \\to 0$）的极限情况。这是得到所要求的闭合形式解析解的唯一途径。在此解释下，该问题被认为是有效的。\n\n杆的平衡态通过最小化总势能 $\\Pi[u,\\alpha]$ 来找到。与 $\\Pi$ 关于 $u$ 和 $\\alpha$ 的变分相关的欧拉-拉格朗日方程给出了控制方程。泛函的被积函数为 $\\mathcal{L}(\\alpha, \\alpha', \\varepsilon) = (1-\\alpha)^2 \\frac{1}{2} E \\varepsilon^2 + G_c \\frac{\\alpha^2}{2l} + G_c \\frac{l}{2} (\\alpha')^2$。\n\n1.  **平衡方程 (由 $\\delta_u \\Pi$ 得出):**\n    位移场 $u(x)$ 的欧拉-拉格朗日方程为 $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon}\\right) - \\frac{\\partial \\mathcal{L}}{\\partial u} = 0$。由于 $\\mathcal{L}$ 不显式依赖于 $u$，该方程简化为 $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon}\\right) = 0$。\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon} = (1-\\alpha)^2 E \\varepsilon = \\sigma\n    $$\n    这是应力 $\\sigma$ 的本构关系。因此，平衡方程为 $\\sigma'(x) = 0$，这意味着应力 $\\sigma$ 在整个杆上必须是均匀的。我们将这个常数应力记为 $\\sigma_0$。\n\n2.  **损伤演化方程 (由 $\\delta_\\alpha \\Pi$ 得出):**\n    损伤场 $\\alpha(x)$ 的欧拉-拉格朗日方程为 $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\alpha'}\\right) - \\frac{\\partial \\mathcal{L}}{\\partial \\alpha} = 0$。\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\alpha'} = G_c l \\alpha'\n    $$\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\alpha} = 2(1-\\alpha)(-1)\\frac{1}{2}E\\varepsilon^2 + G_c\\frac{\\alpha}{l} = -(1-\\alpha)E\\varepsilon^2 + G_c\\frac{\\alpha}{l}\n    $$\n    考虑损伤不可逆条件 ($\\dot{\\alpha} \\geq 0$)，损伤的控制方程为：\n    $$\n    G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + (1-\\alpha)E\\varepsilon^2 = 0\n    $$\n    根据平衡方程，我们有 $\\varepsilon(x) = \\frac{\\sigma_0}{E(1-\\alpha(x))^2}$。将其代入损伤方程，得到关于 $\\alpha(x)$ 的非线性常微分方程 (ODE)：\n    $$\n    G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + (1-\\alpha)E\\left(\\frac{\\sigma_0}{E(1-\\alpha)^2}\\right)^2 = 0\n    \\implies G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + \\frac{\\sigma_0^2}{E(1-\\alpha)^3} = 0\n    $$\n\n3.  **方程的第一积分：**\n    这是一个自治常微分方程。我们可以通过乘以 $\\alpha'$ 并对 $x$ 积分来找到第一积分。一个更直接的基于能量的论证可以得到相同的结果。第一积分为：\n    $$\n    \\frac{1}{2} G_c l (\\alpha')^2 - \\frac{1}{2} G_c \\frac{\\alpha^2}{l} - \\frac{\\sigma_0^2}{2E(1-\\alpha)^2} = \\text{constant}\n    $$\n    我们使用远场边界条件来确定常数：当 $|x| \\to \\infty$ 时，$\\alpha \\to \\alpha_{\\infty}$ 且 $\\alpha' \\to 0$。\n    $$\n    \\text{constant} = -\\frac{1}{2} G_c \\frac{\\alpha_{\\infty}^2}{l} - \\frac{\\sigma_0^2}{2E(1-\\alpha_{\\infty})^2}\n    $$\n    将其代回并简化，我们得到：\n    $$\n    G_c l (\\alpha')^2 = G_c\\frac{\\alpha^2 - \\alpha_{\\infty}^2}{l} + \\frac{\\sigma_0^2}{E}\\left(\\frac{1}{(1-\\alpha)^2} - \\frac{1}{(1-\\alpha_{\\infty})^2}\\right)\n    $$\n    在远场，损伤演化方程对于均匀状态（$\\alpha''=0$）也必须成立，这给出了 $\\sigma_0$ 和 $\\alpha_{\\infty}$ 之间的关系：$G_c \\frac{\\alpha_{\\infty}}{l} = \\frac{\\sigma_0^2}{E(1-\\alpha_{\\infty})^3}$，因此 $\\sigma_0^2 = \\frac{E G_c \\alpha_{\\infty} (1-\\alpha_{\\infty})^3}{l}$。\n    将 $\\sigma_0^2$ 代入第一积分方程，得到：\n    $$\n    l^2 (\\alpha')^2 = (\\alpha^2 - \\alpha_{\\infty}^2) - \\alpha_{\\infty}(1-\\alpha_{\\infty})^3 \\left(\\frac{1}{(1-\\alpha)^2} - \\frac{1}{(1-\\alpha_{\\infty})^2}\\right)\n    $$\n\n4.  **损伤分布的领头阶近似：**\n    为了找到领头阶分布，我们分析损伤 $\\alpha(x)$ 在其远场值 $\\alpha_{\\infty}$ 附近的行为。令 $\\alpha(x) = \\alpha_{\\infty} + \\beta(x)$，其中 $\\beta(x)$ 很小。我们将 $(\\alpha')^2$ 方程的右侧 (RHS) 按 $\\beta$ 的幂次展开。\n    令 $F(\\alpha) = \\text{RHS}$。我们在 $\\alpha=\\alpha_{\\infty}$ 附近对 $F(\\alpha)$ 进行泰勒展开：$F(\\alpha) = F(\\alpha_{\\infty}) + F'(\\alpha_{\\infty})\\beta + \\frac{1}{2}F''(\\alpha_{\\infty})\\beta^2 + O(\\beta^3)$。\n    - 根据构造，$F(\\alpha_{\\infty})=0$。\n    - $F'(\\alpha) = 2\\alpha - 2\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha)^{-3}$。因此，$F'(\\alpha_{\\infty}) = 2\\alpha_{\\infty} - 2\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha_{\\infty})^{-3} = 0$。\n    - $F''(\\alpha) = 2 - 6\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha)^{-4}$。因此，$F''(\\alpha_{\\infty}) = 2 - 6\\alpha_{\\infty}(1-\\alpha_{\\infty})^{-1} = 2\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}$。\n    因此，对于很小的 $\\beta$，我们有 $(\\beta')^2 = l^{-2} (\\frac{1}{2}F''(\\alpha_{\\infty})\\beta^2) = l^{-2} \\left(\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}\\right)\\beta^2$。\n    该常微分方程为 $\\beta' = \\pm \\frac{1}{l}\\sqrt{\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}} \\beta$。\n    如在验证阶段所指出的，题目要求假设“远场损伤...微小”，我们将其解释为取极限 $\\alpha_{\\infty} \\to 0$。在此极限下，项 $\\sqrt{\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}} \\to 1$。\n    超额损伤 $\\beta(x)$ 的领头阶方程变为：\n    $$\n    \\beta' = \\pm \\frac{1}{l} \\beta\n    $$\n    当 $|x| \\to \\infty$ 时衰减至零的解是一个指数函数：\n    $$\n    \\beta(x) = \\beta(0) \\exp\\left(-\\frac{|x|}{l}\\right)\n    $$\n    这里 $\\beta(0) = \\alpha(0) - \\alpha_{\\infty}$ 是杆中心处的峰值超额损伤。因此，完整的领头阶损伤分布为 $\\alpha(x) = \\alpha_{\\infty} + (\\alpha(0) - \\alpha_{\\infty})\\exp(-|x|/l)$。\n\n5.  **局部化宽度 $w$ 的计算：**\n    局部化宽度 $w$ 定义为超额损伤分布 $\\beta(x)$ 的半峰全宽 (FWHM)。这需要找到宽度 $w$ 使得 $\\beta(w/2) = \\frac{1}{2}\\beta(0)$。\n    $$\n    \\beta(0) \\exp\\left(-\\frac{w/2}{l}\\right) = \\frac{1}{2}\\beta(0)\n    $$\n    假设存在非平凡的局部化（$\\beta(0) \\neq 0$），我们可以除以 $\\beta(0)$：\n    $$\n    \\exp\\left(-\\frac{w}{2l}\\right) = \\frac{1}{2}\n    $$\n    对两边取自然对数：\n    $$\n    -\\frac{w}{2l} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n    $$\n    解出 $w$，我们得到：\n    $$\n    w = 2l\\ln(2)\n    $$\n    该表达式给出了以内部长度尺度 $l$ 表示的局部化宽度。按照指示，这提供的宽度 $w$ 与 $l$ 的单位相同（例如，米）。\n\n6.  **对 $l$ 和 $E$ 的依赖性：**\n    推导出的局部化宽度 $w$ 与内禀长度尺度 $l$ 成正比。在这个领头阶近似下，它完全独立于杨氏模量 $E$。其物理原因是，局部化区域中损伤分布的形状是由局部能量储存项 $G_c \\alpha^2/(2l)$ 和梯度能量项 $G_c l (\\alpha')^2/2$ 之间的平衡决定的。这两项都是断裂能惩罚的一部分，并且与材料的弹性 $E$ 无关。弹性特性通过 $E$ 影响应力 $\\sigma_0$ 的大小以及损伤值 $\\alpha_{\\infty}$ 和 $\\alpha(0)$，但在该领头阶分析中，它们不影响空间损伤变化的特征长度。", "answer": "$$\n\\boxed{2l\\ln(2)}\n$$", "id": "3528898"}, {"introduction": "从解析洞察转向完整的数值实现，本练习旨在构建一个耦合梯度塑性问题的完整有限元框架。您将从变分原理出发，推导问题的弱形式和单元刚度矩阵，这些都是构建任何有限元模拟器的基本构件。通过编程实现，您不仅能实践梯度模型的数值离散化过程，还能验证一个源于其能量本质的关键理论特性——切线刚度矩阵的对称性[@problem_id:3528869]。", "problem": "考虑一根长度为 $L$、横截面积恒为 $A$ 的一维直杆，在小应变假设下，使用能量梯度增强塑性本构进行建模。总应变由 $\\varepsilon = u'$ 给出，其中 $u$ 是位移场，内标量场 $\\kappa$ 代表一个等效塑性应变类变量。单位参考长度上的 Helmholtz 自由能假设为二次形式，并由下式给出\n$$\n\\psi(u,\\kappa) = \\tfrac{1}{2} E A \\left(u' - \\kappa\\right)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A l^2 \\left(\\kappa'\\right)^2,\n$$\n其中 $E$ 是杨氏模量，$H$ 是一个恒定的能量硬化/软化模量（在软化情况下该值可以为负，但需满足 $E+H$ 保持为正以确保内变量的稳定性），$l$ 是一个材料长度尺度。忽略外部体力和面力，因此只有内能对增量势有贡献。假设为准静态条件，不考虑惯性。\n\n任务 A (推导)：从总势能的驻值条件（一阶变分为零）出发，使用 Galerkin 方法和等阶插值，推导未知场 $u$ 和 $\\kappa$ 的耦合弱形式。在均匀网格上的两节点单元上，$u$ 和 $\\kappa$ 均使用相同的线性拉格朗日形函数进行离散。在物理坐标 $x$ 中使用等参映射，以便对 $x$ 求导。\n\n任务 B (离散化)：从弱形式出发，对 $u$ 和 $\\kappa$ 均使用线性形函数，写出一个长度为 $h$ 的两节点单元的一致单元级切向子矩阵。清楚地标示出耦合 $u$ 和 $\\kappa$ 的矩阵块。\n\n任务 C (实现与对称性验证)：实现一个程序，该程序：\n- 使用任务 B 中的单元矩阵，为具有 $n$ 个单元的均匀网格组装全局切向矩阵。\n- 将全局自由度排序为 $[u_0, u_1, \\dots, u_n, \\kappa_0, \\kappa_1, \\dots, \\kappa_n]$。\n- 通过对称的行-列消去法施加本质边界条件 $u(0)=0$，以保持缩减系统的对称性。不对 $\\kappa$ 施加任何本质边界条件。\n- 计算一个定义为归一化 Frobenius 范数的对称性指标\n$$\n\\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)},\n$$\n其中 $K$ 是施加本质边界条件后的缩减全局切向矩阵，$\\|\\cdot\\|_F$ 表示 Frobenius 范数。对称性指标 $\\eta$ 是无量纲的，对于一个精确对称的矩阵，其值等于零（在舍入误差范围内）。\n\n使用的科学基础和建模假设：\n- 小应变运动学以及应用于所述 Helmholtz 自由能的最小势能原理。\n- 在每个单元上对 $u$ 和 $\\kappa$ 均使用标准的两节点线性拉格朗日形函数。\n- 单元长度为 $h = L/n$ 的均匀网格。\n- Galerkin 有限元离散化和一致线性化以构建全局切向矩阵。\n\n测试套件：\n为以下每一组参数 $(L, n, E, A, H, l)$ 计算对称性指标 $\\eta$：\n- 案例 1：$(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.05)$。\n- 案例 2：$(1.0, 4, 30\\times 10^9, 0.01, 0.0, 0.05)$。\n- 案例 3：$(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.0)$。\n- 案例 4：$(1.0, 1, 210\\times 10^9, 0.02, 10\\times 10^9, 0.1)$。\n- 案例 5：$(1.5, 3, 25\\times 10^9, 0.015, -2\\times 10^9, 0.08)$。\n\n所有量均采用国际单位制：$L$ 和 $l$ 的单位是米，$E$ 和 $H$ 的单位是帕斯卡，$A$ 的单位是平方米。输出 $\\eta$ 是一个无量纲实数。你的程序必须计算与五个案例相对应的列表 $[\\eta_1, \\eta_2, \\eta_3, \\eta_4, \\eta_5]$。\n\n最终输出格式：\n你的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是案例 $i$ 的 $\\eta$ 的浮点值。", "solution": "该问题要求对一维杆的梯度增强塑性模型进行推导、离散化和实现，以验证所得切向刚度矩阵的对称性。解答按照指定的任务分为三个部分呈现。\n\n### 任务 A: 耦合弱形式的推导\n\n出发点是最小势能原理，该原理指出，对于处于稳定平衡状态的系统，其总势能取驻值。对于这个无外力的准静态问题，总势能 $\\Pi$ 是 Helmholtz 自由能密度 $\\psi$ 在杆的定义域（从 $x=0$ 到 $x=L$）上的积分。\n\n给定的单位参考长度上的 Helmholtz 自由能为：\n$$\n\\psi(u', \\kappa, \\kappa') = \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A l^2 (\\kappa')^2\n$$\n总势能为：\n$$\n\\Pi[u, \\kappa] = \\int_0^L \\psi(u', \\kappa, \\kappa') dx = \\int_0^L \\left[ \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A l^2 (\\kappa')^2 \\right] dx\n$$\n驻值条件要求，对于所有容许的变分 $\\delta u$ 和 $\\delta \\kappa$，$\\Pi$ 相对于独立场 $u$ 和 $\\kappa$ 的一阶变分都为零。容许变分是指与约束在运动学上兼容的变分；在这里，本质边界条件 $u(0)=0$ 意味着相应的变分必须满足 $\\delta u(0)=0$。\n\n一阶变分（或 Gâteaux 导数）为：\n$$\n\\delta \\Pi = \\int_0^L \\left[ \\frac{\\partial \\psi}{\\partial u'} \\delta(u') + \\frac{\\partial \\psi}{\\partial \\kappa} \\delta \\kappa + \\frac{\\partial \\psi}{\\partial \\kappa'} \\delta(\\kappa') \\right] dx = 0\n$$\n由于变分和微分是线性算子，我们有 $\\delta(u') = (\\delta u)'$ 和 $\\delta(\\kappa') = (\\delta \\kappa)'$。$\\psi$ 的偏导数是：\n$$\n\\frac{\\partial \\psi}{\\partial u'} = E A (u' - \\kappa)\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa} = -E A (u' - \\kappa) + A H \\kappa\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa'} = A l^2 \\kappa'\n$$\n将这些代入变分表达式，得到：\n$$\n\\delta \\Pi = \\int_0^L \\left[ E A (u' - \\kappa) (\\delta u)' + (-E A (u' - \\kappa) + A H \\kappa) \\delta \\kappa + (A l^2 \\kappa') (\\delta \\kappa)' \\right] dx = 0\n$$\n在 Galerkin 方法中，变分 $\\delta u$ 和 $\\delta \\kappa$ 被替换为来自与 $u$ 和 $\\kappa$ 相同函数空间的任意权函数 $w_u$ 和 $w_\\kappa$。由于此方程必须对 $w_u$ 和 $w_\\kappa$ 的任意选择都成立，我们可以将其分成两个独立的方程。这就构成了该问题的耦合弱形式。\n\n第一个方程，控制力学平衡（与 $u$ 相关）：\n$$\nG_u(u, \\kappa; w_u) = \\int_0^L E A (u' - \\kappa) w_u' \\,dx = 0 \\quad \\forall w_u \\text{ with } w_u(0)=0\n$$\n第二个方程，控制内变量的演化（与 $\\kappa$ 相关）：\n$$\nG_\\kappa(u, \\kappa; w_\\kappa) = \\int_0^L \\left[ -E A (u' - \\kappa) w_\\kappa + A H \\kappa w_\\kappa + A l^2 \\kappa' w_\\kappa' \\right] dx = 0 \\quad \\forall w_\\kappa\n$$\n这两个积分方程构成了耦合弱形式。必须同时求解它们以得到位移场 $u(x)$ 和内变量场 $\\kappa(x)$。\n\n### 任务 B: 单元级切向子矩阵\n\n为了数值求解弱形式，我们采用有限元法。我们将域 $L$ 离散为 $n$ 个两节点线性单元，每个单元的长度为 $h = L/n$。在每个单元内，未知场 $u$ 和 $\\kappa$ 使用线性拉格朗日形函数 $\\mathbf{N} = [N_1, N_2]$ 进行近似：\n$$\nu^h(x) = \\mathbf{N}(x) \\mathbf{u}_e, \\quad \\kappa^h(x) = \\mathbf{N}(x) \\boldsymbol{\\kappa}_e\n$$\n其中 $\\mathbf{u}_e = [u_1, u_2]^\\top$ 和 $\\boldsymbol{\\kappa}_e = [\\kappa_1, \\kappa_2]^\\top$ 是单元的节点值。导数近似为：\n$$\n(u^h)'(x) = \\mathbf{B}(x) \\mathbf{u}_e, \\quad (\\kappa^h)'(x) = \\mathbf{B}(x) \\boldsymbol{\\kappa}_e\n$$\n其中 $\\mathbf{B} = d\\mathbf{N}/dx$。对于长度为 $h$ 的线性单元，形函数的导数是常数：$\\mathbf{B} = [-1/h, 1/h]$。测试函数也以相同的方式离散。\n\n由于控制弱形式方程对于 $u$ 和 $\\kappa$ 是线性的，其离散化将导出一个线性代数方程组 $\\mathbf{K}_{global} \\mathbf{d} = \\mathbf{f}$。矩阵 $\\mathbf{K}_{global}$ 是全局切向刚度矩阵。我们通过先求单元切向矩阵 $\\mathbf{K}_e$ 来推导它。切向矩阵是残差向量相对于节点自由度的导数。对于这个线性问题，这等同于将有限元近似代入弱形式所基于的双线性形式中。单元切向矩阵是一个 $4 \\times 4$ 的矩阵，由四个 $2 \\times 2$ 的子矩阵组成：\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{e,uu}  \\mathbf{K}_{e,u\\kappa} \\\\ \\mathbf{K}_{e,\\kappa u}  \\mathbf{K}_{e,\\kappa\\kappa} \\end{pmatrix}\n$$\n这些子矩阵是通过将弱形式中的相应项在单元长度 $h$ 上积分得到的：\n$$\n\\mathbf{K}_{e,uu} = E A \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = E A \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,u\\kappa} = -E A \\int_0^h \\mathbf{B}^\\top \\mathbf{N} \\,dx = -E A \\begin{pmatrix} -1/2  -1/2 \\\\ 1/2  1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2  1/2 \\\\ -1/2  -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa u} = -E A \\int_0^h \\mathbf{N}^\\top \\mathbf{B} \\,dx = -E A \\begin{pmatrix} -1/2  1/2 \\\\ -1/2  1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2  -1/2 \\\\ 1/2  -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa\\kappa} = (E+H) A \\int_0^h \\mathbf{N}^\\top \\mathbf{N} \\,dx + A l^2 \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = (E+H) A \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + A l^2 \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n积分 $\\int \\mathbf{N}^\\top\\mathbf{N}\\,dx$ 和 $\\int \\mathbf{B}^\\top\\mathbf{N}\\,dx$ 是线性有限元的标准结果。矩阵 $\\mathbf{K}_{e,u\\kappa}$ 和 $\\mathbf{K}_{e,\\kappa u}$ 是耦合块。正如基于势的本构所预期的那样，单元切向矩阵是对称的，因为 $\\mathbf{K}_{e,\\kappa u} = \\mathbf{K}_{e,u\\kappa}^\\top$。\n\n### 任务 C: 实现与对称性验证\n\n实现过程包括从单元矩阵组装全局切向矩阵，然后计算对称性指标。\n\n1.  **组装**：我们初始化一个大小为 $(2(n+1) \\times 2(n+1))$ 的全局切向矩阵 $\\mathbf{K}_{global}$，并用零填充。然后我们遍历 $n$ 个单元中的每一个。对于每个单元 $i$（连接节点 $i$ 和 $i+1$），我们计算其 $4 \\times 4$ 的单元切向矩阵 $\\mathbf{K}_e$。然后将 $\\mathbf{K}_e$ 的条目加到 $\\mathbf{K}_{global}$ 中的相应位置。从局部自由度到全局自由度的映射遵循指定的排序 $[u_0, \\dots, u_n, \\kappa_0, \\dots, \\kappa_n]$。对于单元 $i$，节点自由度按如下方式映射到全局索引：$u_i \\rightarrow i$, $u_{i+1} \\rightarrow i+1$, $\\kappa_i \\rightarrow (n+1)+i$, 和 $\\kappa_{i+1} \\rightarrow (n+1)+i+1$。这个被称为直接刚度法的标准组装过程构建了完整的全局矩阵。\n\n2.  **边界条件**：本质边界条件 $u(0)=0$ 固定了自由度 $u_0$，该自由度在我们的全局系统中对应于索引 0。为了获得未知自由度 (DOF) 的缩减系统，我们应用对称消去法。这涉及从全局矩阵中移除与受约束自由度对应的行和列。所得的缩减矩阵 $K$ 的大小将为 $(2n+1) \\times (2n+1)$。这个操作保留了原始矩阵的对称性。\n\n3.  **对称性指标**：最后，为了数值上验证缩减矩阵 $K$ 的对称性，我们计算对称性指标 $\\eta$：\n    $$\n    \\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)}\n    $$\n    其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数。如果 $K$ 是完全对称的，则 $\\|K - K^\\top\\|_F$ 项将为零。由于有限精度的浮点运算，这个范数将是一个非常小的数，接近于机器精度。用 $\\|K\\|_F$ 进行归一化使指标无量纲化，并且对于矩阵元素的大小具有鲁棒性。对于一个正确实现的对称本构，$\\eta$ 对于所有测试案例都应有效地为零。所提供的程序实现了这整个过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_element_matrix(h, E, A, H, l):\n    \"\"\"\n    Computes the 4x4 element tangent matrix for a two-node element.\n\n    The local degrees of freedom are ordered as [u1, u2, k1, k2].\n    \"\"\"\n    # K_uu = E*A/h * [[1, -1], [-1, 1]]\n    k_uu = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # K_uk = E*A * [[1/2, 1/2], [-1/2, -1/2]]\n    k_uk = (E * A / 2.0) * np.array([[1, 1], [-1, -1]])\n\n    # K_ku = E*A * [[1/2, -1/2], [1/2, -1/2]]\n    k_ku = (E * A / 2.0) * np.array([[1, -1], [1, -1]])\n    # Note: k_ku should be the transpose of k_uk for symmetry.\n    # As a check: k_uk.T = (E*A/2) * [[1, -1], [1, -1]] == k_ku. Correct.\n\n    # K_kk = (E+H)*A*h/6 * [[2, 1], [1, 2]] + A*l^2/h * [[1, -1], [-1, 1]]\n    term1 = ((E + H) * A * h / 6.0) * np.array([[2, 1], [1, 2]])\n    term2 = (A * l**2 / h) * np.array([[1, -1], [-1, 1]])\n    k_kk = term1 + term2\n\n    # Assemble the 4x4 element matrix using blocks\n    K_e = np.block([[k_uu, k_uk], [k_ku, k_kk]])\n    \n    return K_e\n\ndef assemble_global_matrix(n, K_e):\n    \"\"\"\n    Assembles the global tangent matrix from element matrices.\n    \n    DOF ordering: [u_0, ..., u_n, k_0, ..., k_n]\n    \"\"\"\n    num_nodes = n + 1\n    total_dofs = 2 * num_nodes\n    K_global = np.zeros((total_dofs, total_dofs))\n\n    for i in range(n):\n        # Global indices for element 'i' (connecting nodes i and i+1)\n        # Local DOFs: u_i, u_{i+1}, k_i, k_{i+1}\n        # Global DOF map for the element\n        dof_map = [\n            i,          # u_i\n            i + 1,      # u_{i+1}\n            num_nodes + i,  # k_i\n            num_nodes + i + 1   # k_{i+1}\n        ]\n        \n        # Add element matrix to global matrix\n        K_global[np.ix_(dof_map, dof_map)] += K_e\n        \n    return K_global\n\ndef compute_symmetry_indicator(L, n, E, A, H, l):\n    \"\"\"\n    Computes the symmetry indicator for the given set of parameters.\n    \"\"\"\n    # 1. Calculate element properties\n    h = L / n\n    \n    # 2. Compute the element tangent matrix\n    K_e = compute_element_matrix(h, E, A, H, l)\n    \n    # 3. Assemble the global tangent matrix\n    K_global = assemble_global_matrix(n, K_e)\n    \n    # 4. Apply essential boundary condition u(0)=0 by symmetric elimination\n    # The DOF for u(0) is at index 0. We remove the first row and column.\n    K_reduced = np.delete(K_global, 0, axis=0)\n    K_reduced = np.delete(K_reduced, 0, axis=1)\n\n    # 5. Compute the symmetry indicator eta\n    K_transpose = K_reduced.T\n    diff_norm = np.linalg.norm(K_reduced - K_transpose, 'fro')\n    K_norm = np.linalg.norm(K_reduced, 'fro')\n    \n    eta = diff_norm / max(1.0, K_norm)\n    \n    return eta\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test suite: (L, n, E, A, H, l)\n    test_cases = [\n        (1.0, 4, 30e9, 0.01, 5e9, 0.05),\n        (1.0, 4, 30e9, 0.01, 0.0, 0.05),\n        (1.0, 4, 30e9, 0.01, 5e9, 0.0),\n        (1.0, 1, 210e9, 0.02, 10e9, 0.1),\n        (1.5, 3, 25e9, 0.015, -2e9, 0.08),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, n, E, A, H, l = case\n        eta = compute_symmetry_indicator(L, n, E, A, H, l)\n        results.append(eta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3528869"}]}