{"hands_on_practices": [{"introduction": "岩土材料的塑性模型通常不是基于完整的应力张量，而是使用应力不变量来表述。本练习将让你能够从一个给定的柯西应力张量中计算出基本的应力不变量——平均应力（$p$）、偏应力（$q$）和洛德角（$\\theta$），并对加载路径进行分类，这是评估任何屈服准则的关键技能。[@problem_id:3525005]", "problem": "考虑一个正在经历有限变形的均质地质材料，其应力量度为 Cauchy 应力张量。假设压应力为正，且 Cauchy 应力张量是对称的。在当前构型中，给定的 Cauchy 应力张量为\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80  20  0 \\\\\n20  80  0 \\\\\n0  0  60\n\\end{pmatrix}\n\\ \\text{MPa}.\n$$\n使用计算岩土力学中 Cauchy 应力的标准应力不变量，计算平均应力 $p$、偏应力量度 $q$ 以及与偏应力相关的 Lode 角 $\\theta$。然后将加载路径分类为三轴压缩、三轴拉伸或纯剪切。对于分类，根据以下约定报告一个数值代码 $C$：三轴压缩为 $C=+1$，三轴拉伸为 $C=-1$，纯剪切为 $C=0$。\n\n以 $\\text{MPa}$ 为单位表示 $p$ 和 $q$，以弧度为单位表示 $\\theta$。无需四舍五入；如果出现自然产生的精确值，请提供精确值。将您的最终答案表示为一个单行矩阵，按顺序包含 $p$、$q$、$\\theta$ 和 $C$。", "solution": "Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 是对称且实值的，因此它存在一组标准正交的特征向量和实特征值，这些特征值即为主应力。对于形如下式的对称分块矩阵\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80  20  0 \\\\\n20  80  0 \\\\\n0  0  60\n\\end{pmatrix},\n$$\n其左上角的 $2\\times 2$ 子块的特征值可通过求解下式得到\n$$\n\\det\\!\\left(\\begin{pmatrix}80  20 \\\\ 20  80\\end{pmatrix} - \\lambda \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}\\right) = 0,\n$$\n解得 $(80-\\lambda)^{2} - 20^{2} = 0$，因此 $\\lambda = 100$ 和 $\\lambda = 60$。解耦的 $(3,3)$ 分量为 $60$。因此，主应力为\n$$\n\\sigma_{1} = 100,\\quad \\sigma_{2} = 60,\\quad \\sigma_{3} = 60\n$$\n单位为 $\\text{MPa}$，并按 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\sigma_{3}$ 排序。\n\n平均应力 $p$ 定义为 $\\boldsymbol{\\sigma}$ 的第一不变量的三分之一，\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{\\sigma_{1} + \\sigma_{2} + \\sigma_{3}}{3} = \\frac{100 + 60 + 60}{3} = \\frac{220}{3}.\n$$\n\n为了得到偏应力量度 $q$，我们首先构建偏应力张量 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$，其主分量为\n$$\ns_{1} = \\sigma_{1} - p = 100 - \\frac{220}{3} = \\frac{80}{3},\\quad\ns_{2} = \\sigma_{2} - p = 60 - \\frac{220}{3} = -\\frac{40}{3},\\quad\ns_{3} = \\sigma_{3} - p = 60 - \\frac{220}{3} = -\\frac{40}{3}.\n$$\n这些分量满足 $s_{1} + s_{2} + s_{3} = 0$，符合要求。$\\boldsymbol{s}$ 的第二不变量是\n$$\nJ_{2} = \\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{2}\\left(s_{1}^{2} + s_{2}^{2} + s_{3}^{2}\\right) = \\frac{1}{2}\\left(\\left(\\frac{80}{3}\\right)^{2} + 2\\left(\\frac{40}{3}\\right)^{2}\\right) = \\frac{1600}{3}.\n$$\n则偏应力量度 $q$ 为\n$$\nq = \\sqrt{3\\,J_{2}} = \\sqrt{3 \\cdot \\frac{1600}{3}} = \\sqrt{1600} = 40.\n$$\n\nLode 角 $\\theta$ 表征了在偏平面上的位置，可由 $\\boldsymbol{s}$ 的第三不变量得到，\n$$\nJ_{3} = \\det(\\boldsymbol{s}) = s_{1}\\,s_{2}\\,s_{3} = \\left(\\frac{80}{3}\\right)\\left(-\\frac{40}{3}\\right)\\left(-\\frac{40}{3}\\right) = \\frac{128000}{27}.\n$$\n定义 Lode 参数\n$$\n\\mu = \\frac{3\\sqrt{3}}{2}\\,\\frac{J_{3}}{J_{2}^{3/2}},\n$$\nLode 角由下式给出\n$$\n\\theta = \\frac{1}{3}\\,\\arcsin(\\mu),\n$$\n其取值范围在区间 $-\\frac{\\pi}{6} \\leq \\theta \\leq \\frac{\\pi}{6}$ 内。计算 $J_{2}^{3/2}$：\n$$\nJ_{2}^{1/2} = \\sqrt{\\frac{1600}{3}} = \\frac{40}{\\sqrt{3}},\\quad\nJ_{2}^{3/2} = J_{2}\\,J_{2}^{1/2} = \\frac{1600}{3}\\cdot \\frac{40}{\\sqrt{3}} = \\frac{64000}{3\\sqrt{3}}.\n$$\n因此，\n$$\n\\mu = \\frac{3\\sqrt{3}}{2}\\,\\frac{\\frac{128000}{27}}{\\frac{64000}{3\\sqrt{3}}}\n= \\frac{3\\sqrt{3}}{2}\\cdot \\frac{128000}{27}\\cdot \\frac{3\\sqrt{3}}{64000}\n= \\frac{27}{2}\\cdot\\frac{2}{27} = 1,\n$$\n因此\n$$\n\\theta = \\frac{1}{3}\\,\\arcsin(1) = \\frac{\\pi}{6}.\n$$\n\n分类取决于 Lode 角：$\\theta = \\frac{\\pi}{6}$ 对应于轴对称压缩（三轴压缩）状态，因为两个较小的主应力相等（$\\sigma_{2} = \\sigma_{3}$），并且 Lode 参数达到了其正极值。因此，分类代码为 $C = +1$。\n\n按要求的顺序和单位汇总结果，我们得到 $p = \\frac{220}{3}\\ \\text{MPa}$，$q = 40\\ \\text{MPa}$，$\\theta = \\frac{\\pi}{6}\\ \\text{rad}$ 以及 $C = +1$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{220}{3}  40  \\frac{\\pi}{6}  1\\end{pmatrix}}$$", "id": "3525005"}, {"introduction": "这项综合性练习将理论知识整合到一个实用的计算算法中——弹性预测-塑性修正算法，这是现代计算岩土力学的核心工具。通过实现该算法，你将把运动学、弹性、屈服准则和数值积分等概念联系起来，从而深刻理解这些模型在实践中是如何应用的。[@problem_id:3525032]", "problem": "考虑一种各向同性岩土地质材料，该材料由嵌入在有限应变框架中的 Drucker–Prager 塑性面建模，其中包含一个超弹性弹性预测子和一个在压力-偏应力不变量空间中的塑性修正子。变形是一个单一的有限简单剪切步，变形梯度 $F \\in \\mathbb{R}^{3 \\times 3}$ 从初始无应力无变形状态施加。该算法应根据可压缩超弹性模型计算弹性试探应力，根据柯西应力的不变量 $p$ 和 $q$ 评估 Drucker–Prager 屈服函数，如果发生屈服，则通过使用后向欧拉算法和线性各向同性硬化将点投影回 $(p,q)$ 平面上的 Drucker–Prager 锥面来进行返回映射（塑性修正子）。内变量为累积等效塑性应变 $r$ 和塑性体积应变 $\\varepsilon_v^p$。\n\n使用以下基本依据和定义。\n\n- 运动学：有限简单剪切步由变形梯度表示\n$$\nF = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix},\n$$\n其中剪切参数 $\\gamma \\ge 0$ (无量纲)。对于此 $F$，雅可比行列式为 $J = \\det F = 1$，左柯西-格林张量为 $b = F F^\\top$。\n\n- 弹性预测子：使用由剪切模量 $\\mu$ 和体积模量 $K$ 定义的可压缩 Neo-Hookean 超弹性模型。定义等容左柯西-格林张量 $\\bar b = J^{-2/3} b$。Kirchhoff 应力为\n$$\n\\tau^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(\\bar b) + K \\ln J \\, \\mathbf{I},\n$$\n而 Cauchy 应力为 $\\sigma^{\\mathrm{tr}} = \\tau^{\\mathrm{tr}}/J$。由于对于给定的简单剪切，$J = 1$，因此 $\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)$。材料常数通过杨氏模量 $E$ 和泊松比 $\\nu$ 相关联\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}.\n$$\n\n- 应力不变量和符号约定：根据 Cauchy 应力 $\\sigma$ 定义压力 $p$（压缩为正）和偏应力不变量 $q$\n$$\np = -\\frac{1}{3} \\mathrm{tr}(\\sigma), \\qquad s = \\sigma + p \\mathbf{I}, \\qquad q = \\sqrt{\\frac{3}{2}\\, s:s}.\n$$\n\n- 带线性各向同性硬化的 Drucker–Prager 屈服函数：\n$$\nf(p,q,r) = q + \\beta\\, p - \\left(c_0 + H\\, r\\right),\n$$\n其中 $\\beta = \\dfrac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ 取决于摩擦角 $\\varphi$（以弧度为单位），$c_0 \\ge 0$ 是初始内聚力（以兆帕为单位），$H \\ge 0$ 是线性硬化模量（以兆帕为单位），$r$ 是累积等效塑性应变（无量纲）。流动法则通常是非关联的，其塑性势为 $g(p,q) = q + \\beta_g p$，其中 $\\beta_g = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$ 取决于剪胀角 $\\psi$（以弧度为单位）。内变量通过后向欧拉法更新\n$$\nr_{n+1} = r_n + \\Delta \\lambda, \\qquad \\varepsilon_{v,n+1}^p = \\varepsilon_{v,n}^p + \\beta_g\\, \\Delta \\lambda,\n$$\n其中塑性乘子 $\\Delta \\lambda \\ge 0$。\n\n- $(p,q)$ 空间中的弹塑性修正子：从弹性预测子 $(p^{\\mathrm{tr}},q^{\\mathrm{tr}})$ 开始，在 $(p,q)$ 空间中应用后向欧拉返回映射，\n$$\np_{n+1} = p^{\\mathrm{tr}} - K\\, \\beta_g\\, \\Delta \\lambda, \\qquad q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu\\, \\Delta \\lambda,\n$$\n须满足一致性条件 $f(p_{n+1},q_{n+1},r_{n+1}) = 0$。求解 $\\Delta \\lambda$ 得\n$$\n\\Delta \\lambda =\n\\begin{cases}\n0,  \\text{若 } f^{\\mathrm{tr}} \\le 0,\\\\\n\\dfrac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H},  \\text{若 } f^{\\mathrm{tr}} > 0,\n\\end{cases}\n\\quad \\text{其中 } f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - \\left(c_0 + H r_n\\right).\n$$\n在返回过程中，偏应力方向保持不变，即如果 $q^{\\mathrm{tr}} > 0$，则 $s_{n+1} = \\dfrac{q_{n+1}}{q^{\\mathrm{tr}}} s^{\\mathrm{tr}}$；否则 $s_{n+1} = \\mathbf{0}$。该步骤结束时的 Cauchy 应力为 $\\sigma_{n+1} = s_{n+1} - p_{n+1} \\mathbf{I}$。\n\n您的任务是实现一个程序，对下面的每个测试用例执行上述弹性预测-塑性修正单一简单剪切步，并返回修正后的最终 $(p,q)$ 值。\n\n在三角函数中使用角度时，单位必须是弧度。在测试用例中，输入的摩擦角和剪胀角将以度为单位指定；请在程序内部将其转换为弧度。所有应力、模量和内聚力/硬化参数均以兆帕（MPa）为单位。剪切参数 $\\gamma$ 是无量纲的。以兆帕（MPa）为单位表示最终输出 $p$ 和 $q$。将每个输出值四舍五入到六位小数。\n\n测试套件：\n为以下情况提供结果，每种情况都从 $r_n = 0$ 和 $\\varepsilon_{v,n}^p = 0$ 开始：\n\n- 情况 1（弹性检查）：$E = 10000$ MPa，$\\nu = 0.30$，$\\varphi = 30$ 度，$\\psi = 0$ 度，$c_0 = 150$ MPa，$H = 100$ MPa，$\\gamma = 0.01$。\n- 情况 2（塑性，非关联）：$E = 5000$ MPa，$\\nu = 0.30$，$\\varphi = 30$ 度，$\\psi = 5$ 度，$c_0 = 5$ MPa，$H = 50$ MPa，$\\gamma = 0.10$。\n- 情况 3（理想塑性，有摩擦零内聚力）：$E = 10000$ MPa，$\\nu = 0.20$，$\\varphi = 35$ 度，$\\psi = 0$ 度，$c_0 = 0$ MPa，$H = 0$ MPa，$\\gamma = 0.20$。\n- 情况 4（屈服边界，无摩擦）：$E = 6000$ MPa，$\\nu = 0.25$，$\\varphi = 0$ 度，$\\psi = 0$ 度，$c_0 = 41.568$ MPa，$H = 0$ MPa，$\\gamma = 0.01$。\n- 情况 5（极大硬化，近弹性响应）：$E = 8000$ MPa，$\\nu = 0.30$，$\\varphi = 25$ 度，$\\psi = 10$ 度，$c_0 = 1$ MPa，$H = 1000000$ MPa，$\\gamma = 0.20$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[p_1,q_1,p_2,q_2,\\dots,p_5,q_5]$，其中 $p_i$ 和 $q_i$ 是情况 $i$ 的最终修正值。每个数字必须四舍五入到六位小数并以 MPa 表示。", "solution": "用户提供了一个计算岩土力学问题，要求实现一个针对 Drucker-Prager 材料模型的有限应变弹性预测-塑性修正算法。任务是计算经过单步有限简单剪切后的最终应力状态，该状态由压力 $p$ 和偏应力不变量 $q$ 表示。以下论述详细说明了从所提供的问题陈述中推导出的方法论。\n\n该算法分三个主要阶段进行：\n1.  从基本属性计算材料参数。\n2.  弹性预测子步骤，该步骤假设纯弹性行为并计算试探应力状态。\n3.  塑性修正子步骤，该步骤检查是否发生屈服，如果发生屈服，则将试探应力状态返回到屈服面上。\n\n所有步骤均针对初始未变形、无应力的材料进行，因此内变量、累积等效塑性应变 $r_n$ 和塑性体积应变 $\\varepsilon_{v,n}^p$ 的初始值均为零。\n\n**1. 材料参数计算**\n\n本构行为由一组材料参数定义。杨氏模量 $E$ 和泊松比 $\\nu$ 用于定义弹性剪切模量 $\\mu$ 和体积模量 $K$：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}\n$$\nDrucker-Prager 屈服面和塑性势分别由摩擦角 $\\varphi$ 和剪胀角 $\\psi$ 定义。这些角用于计算无量纲参数 $\\beta$ 和 $\\beta_g$：\n$$\n\\beta = \\frac{6 \\sin \\varphi}{3 - \\sin \\varphi}, \\qquad \\beta_g = \\frac{6 \\sin \\psi}{3 - \\sin \\psi}\n$$\n在用于三角函数之前，必须先将以度为单位的输入角度转换为弧度。该模型还包括初始内聚力 $c_0$ 和线性硬化模量 $H$。\n\n**2. 弹性预测子步骤**\n\n变形是一个单一的有限简单剪切步，由剪切参数为 $\\gamma$ 的变形梯度 $F$ 定义：\n$$\nF = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}\n$$\n$F$ 的行列式是 $J = \\det(F) = 1$，表示等容（体积保持）变形。左柯西-格林张量 $b$ 计算为 $b = F F^\\top$：\n$$\nb = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}\n\\begin{bmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix}\n= \\begin{bmatrix} 1+\\gamma^2  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix}\n$$\n弹性预测应力由可压缩 Neo-Hookean 模型给出。由于 $J=1$，Kirchhoff 应力 $\\tau^{\\mathrm{tr}}$ 和 Cauchy 应力 $\\sigma^{\\mathrm{tr}}$ 是相同的，并简化为：\n$$\n\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)\n$$\n其中 $\\mathrm{dev}(b) = b - \\frac{1}{3}\\mathrm{tr}(b)\\mathbf{I}$。$b$ 的迹是 $\\mathrm{tr}(b) = (1+\\gamma^2) + 1 + 1 = 3 + \\gamma^2$。\n$$\n\\mathrm{dev}(b) = \\begin{bmatrix} 1+\\gamma^2  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{bmatrix} - \\frac{3+\\gamma^2}{3}\\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{pmatrix} \\frac{2}{3}\\gamma^2  \\gamma  0 \\\\ \\gamma  -\\frac{1}{3}\\gamma^2  0 \\\\ 0  0  -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\n因此，试探 Cauchy 应力为：\n$$\n\\sigma^{\\mathrm{tr}} = \\mu \\begin{pmatrix} \\frac{2}{3}\\gamma^2  \\gamma  0 \\\\ \\gamma  -\\frac{1}{3}\\gamma^2  0 \\\\ 0  0  -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\n从此试探应力，我们计算试探应力不变量，即压力 $p^{\\mathrm{tr}}$ 和偏应力不变量 $q^{\\mathrm{tr}}$。\n试探压力 $p^{\\mathrm{tr}}$ 为：\n$$\np^{\\mathrm{tr}} = -\\frac{1}{3} \\mathrm{tr}(\\sigma^{\\mathrm{tr}}) = -\\frac{\\mu}{3} \\left( \\frac{2}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 \\right) = 0\n$$\n由于 $p^{\\mathrm{tr}}=0$，试探偏应力张量 $s^{\\mathrm{tr}}$ 等于试探应力 $\\sigma^{\\mathrm{tr}}$ 本身。试探偏应力不变量 $q^{\\mathrm{tr}}$ 为：\n$$\nq^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} s^{\\mathrm{tr}}:s^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} \\sum_{i,j} (\\sigma^{\\mathrm{tr}}_{ij})^2} = \\sqrt{\\frac{3}{2} \\mu^2 \\left[ (\\frac{2}{3}\\gamma^2)^2 + \\gamma^2 + \\gamma^2 + (-\\frac{1}{3}\\gamma^2)^2 + (-\\frac{1}{3}\\gamma^2)^2 \\right]}\n$$\n$$\nq^{\\mathrm{tr}} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{4}{9}\\gamma^4 + 2\\gamma^2 + \\frac{2}{9}\\gamma^4 \\right]} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{2}{3}\\gamma^4 + 2\\gamma^2 \\right]} = \\mu \\sqrt{\\gamma^4 + 3\\gamma^2} = \\mu \\gamma \\sqrt{\\gamma^2 + 3}\n$$\n因此，对于给定的简单剪切变形，试探状态就是 $(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}) = (0, \\mu \\gamma \\sqrt{\\gamma^2 + 3})$。\n\n**3. 屈服检查和塑性修正子步骤**\n\n我们在试探状态下评估 Drucker-Prager 屈服函数 $f$：\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - (c_0 + H r_n)\n$$\n鉴于 $p^{\\mathrm{tr}} = 0$ 和初始条件 $r_n=0$，这简化为：\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} - c_0\n$$\n- 如果 $f^{\\mathrm{tr}} \\le 0$，材料响应是弹性的。试探状态即为最终状态：\n  $$ p_{n+1} = p^{\\mathrm{tr}} = 0, \\qquad q_{n+1} = q^{\\mathrm{tr}} $$\n- 如果 $f^{\\mathrm{tr}} > 0$，试探状态位于屈服面之外，发生塑性流动。需要进行塑性修正。塑性修正的大小由塑性乘子 $\\Delta\\lambda$ 决定，计算如下：\n  $$\n  \\Delta \\lambda = \\frac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H}\n  $$\n  最终的应力不变量 $(p_{n+1}, q_{n+1})$ 通过使用后向欧拉算法将试探状态返回到屈服面来找到：\n  $$\n  p_{n+1} = p^{\\mathrm{tr}} - K \\beta_g \\Delta\\lambda = - K \\beta_g \\Delta\\lambda\n  $$\n  $$\n  q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu \\Delta\\lambda\n  $$\n内变量也同样更新，尽管最终的 $(p,q)$ 输出不需要它们：\n$$\nr_{n+1} = r_n + \\Delta\\lambda = \\Delta\\lambda\n$$\n\n将此完整算法应用于问题陈述中指定的每个测试用例。计算每个案例的最终值 $p_{n+1}$ 和 $q_{n+1}$，四舍五入到六位小数，并按要求格式呈现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    This function implements an elastic-predictor, plastic-corrector algorithm\n    for a Drucker-Prager material model under a single finite simple shear step.\n    It calculates the final stress state (p, q) for each test case.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (elastic check)\n        {'E': 10000, 'nu': 0.30, 'phi': 30, 'psi': 0, 'c0': 150, 'H': 100, 'gamma': 0.01},\n        # Case 2 (plastic, non-associative)\n        {'E': 5000, 'nu': 0.30, 'phi': 30, 'psi': 5, 'c0': 5, 'H': 50, 'gamma': 0.10},\n        # Case 3 (perfectly plastic, frictional with zero cohesion)\n        {'E': 10000, 'nu': 0.20, 'phi': 35, 'psi': 0, 'c0': 0, 'H': 0, 'gamma': 0.20},\n        # Case 4 (boundary on yield, frictionless)\n        {'E': 6000, 'nu': 0.25, 'phi': 0, 'psi': 0, 'c0': 41.568, 'H': 0, 'gamma': 0.01},\n        # Case 5 (very large hardening, near-elastic response)\n        {'E': 8000, 'nu': 0.30, 'phi': 25, 'psi': 10, 'c0': 1, 'H': 1000000, 'gamma': 0.20},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_final, q_final = calculate_stress_state(case)\n        # Round to six decimal places as required\n        results.extend([round(p_final, 6), round(q_final, 6)])\n\n    # Format the final output string\n    # Using format specifier to avoid scientific notation and ensure standard decimal representation\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_stress_state(params):\n    \"\"\"\n    Performs the elastic-predictor plastic-corrector calculation for one case.\n\n    Args:\n        params (dict): A dictionary containing all material and loading parameters.\n\n    Returns:\n        tuple: A tuple containing the final pressure (p) and deviatoric invariant (q).\n    \"\"\"\n    # Unpack parameters\n    E = params['E']\n    nu = params['nu']\n    phi_deg = params['phi']\n    psi_deg = params['psi']\n    c0 = params['c0']\n    H = params['H']\n    gamma = params['gamma']\n    \n    # --- 1. Material Parameter Calculation ---\n\n    # Elastic moduli\n    mu = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n\n    # Convert angles to radians\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n    \n    sin_phi = np.sin(phi_rad)\n    sin_psi = np.sin(psi_rad)\n\n    # Drucker-Prager parameters\n    # The denominator 3-sin(phi) cannot be zero since sin(phi) is in [-1, 1]\n    beta = (6 * sin_phi) / (3 - sin_phi) if (3 - sin_phi) != 0 else 0\n    beta_g = (6 * sin_psi) / (3 - sin_psi) if (3 - sin_psi) != 0 else 0\n\n    # --- 2. Elastic Predictor Step ---\n    \n    # For finite simple shear, the trial stress invariants are:\n    p_tr = 0.0\n    q_tr = mu * gamma * np.sqrt(gamma**2 + 3)\n\n    # --- 3. Yield Check ---\n\n    # Initial internal variable state\n    r_n = 0.0\n    \n    # Evaluate trial yield function\n    f_tr = q_tr + beta * p_tr - (c0 + H * r_n)\n\n    # --- 4. Plastic Corrector Step (if needed) ---\n    \n    if f_tr = 0:\n        # Elastic step: final state is the trial state\n        p_final = p_tr\n        q_final = q_tr\n    else:\n        # Plastic step: perform return mapping\n        \n        # Calculate plastic multiplier\n        denominator = 3 * mu + K * beta * beta_g + H\n        if denominator == 0:\n            # Avoid division by zero, although physically unlikely with H >= 0\n            # For H=0, mu > 0, K > 0, phi >= psi >= 0, this is positive\n            delta_lambda = 0\n        else:\n            delta_lambda = f_tr / denominator\n        \n        # Update stress invariants\n        p_final = p_tr - K * beta_g * delta_lambda\n        q_final = q_tr - 3 * mu * delta_lambda\n\n    return p_final, q_final\n\n# Execute the solver\nsolve()\n```", "id": "3525032"}]}