{"hands_on_practices": [{"introduction": "在隐式有限元分析中，核心步骤是构建和求解一个非线性方程组，其基础是残差向量的集成。本练习将深入探讨这一过程的根本，通过推导单个从节点与主面接触对的离散残差贡献，来揭示接触力如何在节点自由度上分配。通过应用虚功原理和罚函数法，我们将把一个连续的接触约束转化为一组可计算的节点力，这是理解和实现任何接触算法的基础。[@problem_id:3510014]", "problem": "在计算岩土力学的背景下，考虑二维小应变运动学中单个从节点与一个由两个节点组成的直线主面之间的无摩擦单边接触相互作用。该主面的端点节点标记为 $m_{1}$ 和 $m_{2}$，其参考位置为 $\\boldsymbol{X}_{m_{1}}$ 和 $\\boldsymbol{X}_{m_{2}}$，当前位移为 $\\boldsymbol{u}_{m_{1}}$ 和 $\\boldsymbol{u}_{m_{2}}$。从节点 $s$ 的参考位置为 $\\boldsymbol{X}_{s}$，当前位移为 $\\boldsymbol{u}_{s}$。设主面由局部坐标 $\\xi \\in [-1,1]$ 参数化，其标准线性形函数为 $N_{1}(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_{2}(\\xi) = \\frac{1+\\xi}{2}$。假设在最近投影点处，主面的外单位法向量为常向量 $\\boldsymbol{n} = (n_{x}, n_{y})^{\\mathsf{T}}$，并且最近点投影坐标 $\\xi$ 严格位于开区间 $(-1,1)$ 内，且在当前残差评估过程中保持不变。\n\n从虚功原理和法向接触间隙的二次罚函数势的定义出发，推导与该单个从节点到主面的接触对相关的离散残差贡献。使用由运动学定义的法向间隙\n$$\ng_{n} = \\boldsymbol{n}^{\\mathsf{T}}\\left[\\left(\\boldsymbol{X}_{s} + \\boldsymbol{u}_{s}\\right) - \\sum_{a=1}^{2} N_{a}(\\xi)\\left(\\boldsymbol{X}_{m_{a}} + \\boldsymbol{u}_{m_{a}}\\right)\\right],\n$$\n以及标量罚刚度 $k_{p}  0$。在构造此残差时，忽略 $\\xi$ 和 $\\boldsymbol{n}$ 对节点自由度的依赖性。\n\n- 明确指出从该接触对接收非零贡献的节点自由度，并采用自由度排序\n$$\n\\left[u_{s,x},\\, u_{s,y},\\, u_{m_{1},x},\\, u_{m_{1},y},\\, u_{m_{2},x},\\, u_{m_{2},y}\\right]^{\\mathsf{T}}.\n$$\n- 将您的最终结果表示为离散残差贡献 $\\boldsymbol{R}_{c}$ 的单个矢量值解析表达式，该表达式用 $k_{p}$、$g_{n}$、$n_{x}$、$n_{y}$、$N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 表示，并遵循上述排序。您可以将 $g_{n}$ 保留为符号形式，或代入其对参考位置和位移的显式依赖关系。\n\n您的最终答案必须是单个闭式解析表达式。不包括单位。无需进行数值四舍五入。", "solution": "推导从罚函数法中接触问题的虚功原理开始。对于无摩擦法向接触罚函数，引入一个通过法向间隙惩罚穿透的罚函数势。从节点上的一个标准二次罚函数势为\n$$\n\\Pi_{c} = \\frac{1}{2}\\,k_{p}\\,g_{n}^{2},\n$$\n其中 $k_{p}  0$ 是罚刚度，$g_{n}$ 是法向间隙。相应的接触虚功是该势的一阶变分，\n$$\n\\delta \\Pi_{c} = k_{p}\\,g_{n}\\,\\delta g_{n}.\n$$\n在小应变、小位移设定下，对于固定的最近点参数 $\\xi$ 和固定的单位法向量 $\\boldsymbol{n}$，法向间隙由运动学定义为\n$$\ng_{n} = \\boldsymbol{n}^{\\mathsf{T}}\\left[\\left(\\boldsymbol{X}_{s} + \\boldsymbol{u}_{s}\\right) - \\sum_{a=1}^{2} N_{a}(\\xi)\\left(\\boldsymbol{X}_{m_{a}} + \\boldsymbol{u}_{m_{a}}\\right)\\right].\n$$\n忽略 $\\xi$ 和 $\\boldsymbol{n}$ 的变分，间隙的变分根据线性关系得出：\n$$\n\\delta g_{n} = \\boldsymbol{n}^{\\mathsf{T}}\\left[\\delta \\boldsymbol{u}_{s} - \\sum_{a=1}^{2} N_{a}(\\xi)\\,\\delta \\boldsymbol{u}_{m_{a}}\\right]\n= \\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{s} - N_{1}(\\xi)\\,\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{m_{1}} - N_{2}(\\xi)\\,\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{m_{2}}.\n$$\n代入虚功表达式，得到\n$$\n\\delta \\Pi_{c} = k_{p}\\,g_{n}\\left(\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{s} - N_{1}(\\xi)\\,\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{m_{1}} - N_{2}(\\xi)\\,\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{m_{2}}\\right).\n$$\n根据与自由度相关的离散残差向量 $\\boldsymbol{R}_{c}$ 的定义，$\\delta \\Pi_{c} = \\boldsymbol{R}_{c}^{\\mathsf{T}}\\,\\delta \\boldsymbol{u}$，其中采用的排序下的虚节点位移向量为\n$$\n\\delta \\boldsymbol{u} =\n\\begin{bmatrix}\n\\delta u_{s,x} \\\\ \\delta u_{s,y} \\\\ \\delta u_{m_{1},x} \\\\ \\delta u_{m_{1},y} \\\\ \\delta u_{m_{2},x} \\\\ \\delta u_{m_{2},y}\n\\end{bmatrix}.\n$$\n注意到 $\\boldsymbol{n}^{\\mathsf{T}}\\delta \\boldsymbol{u}_{\\bullet} = n_{x}\\,\\delta u_{\\bullet,x} + n_{y}\\,\\delta u_{\\bullet,y}$，可以读出残差向量的分量：\n- 从节点接收贡献 $k_{p} g_{n}\\,\\boldsymbol{n}$，即在其 x 和 y 位置上的项为 $k_{p} g_{n} n_{x}$ 和 $k_{p} g_{n} n_{y}$。\n- 主节点 $m_{1}$ 接收相反的贡献，按 $N_{1}(\\xi)$ 加权，即项为 $-k_{p} g_{n} N_{1}(\\xi) n_{x}$ 和 $-k_{p} g_{n} N_{1}(\\xi) n_{y}$。\n- 主节点 $m_{2}$ 接收相反的贡献，按 $N_{2}(\\xi)$ 加权，即项为 $-k_{p} g_{n} N_{2}(\\xi) n_{x}$ 和 $-k_{p} g_{n} N_{2}(\\xi) n_{y}$。\n\n将这些分量按照指定的自由度排序 $[u_{s,x},\\, u_{s,y},\\, u_{m_{1},x},\\, u_{m_{1},y},\\, u_{m_{2},x},\\, u_{m_{2},y}]^{\\mathsf{T}}$ 收集起来，得到\n$$\n\\boldsymbol{R}_{c} = k_{p}\\,g_{n}\\,\n\\begin{bmatrix}\nn_{x} \\\\\nn_{y} \\\\\n-\\,N_{1}(\\xi)\\,n_{x} \\\\\n-\\,N_{1}(\\xi)\\,n_{y} \\\\\n-\\,N_{2}(\\xi)\\,n_{x} \\\\\n-\\,N_{2}(\\xi)\\,n_{y}\n\\end{bmatrix}.\n$$\n为完整起见，可以将 $g_{n}$ 用参考位置和位移显式表示为\n$$\ng_{n} = \\boldsymbol{n}^{\\mathsf{T}}\\left[\\left(\\boldsymbol{X}_{s} - N_{1}(\\xi)\\,\\boldsymbol{X}_{m_{1}} - N_{2}(\\xi)\\,\\boldsymbol{X}_{m_{2}}\\right) + \\left(\\boldsymbol{u}_{s} - N_{1}(\\xi)\\,\\boldsymbol{u}_{m_{1}} - N_{2}(\\xi)\\,\\boldsymbol{u}_{m_{2}}\\right)\\right].\n$$\n\n所涉及的自由度正是从节点和两个主面端点的平动分量，即按所述排序的 $u_{s,x}$、$u_{s,y}$、$u_{m_{1},x}$、$u_{m_{1},y}$、$u_{m_{2},x}$ 和 $u_{m_{2},y}$。在所述假设下，没有其他自由度从这个单节点到主面的接触对中接收贡献。", "answer": "$$\\boxed{k_{p}\\,g_{n}\\,\\begin{bmatrix}\nn_{x} \\\\\nn_{y} \\\\\n-\\,N_{1}(\\xi)\\,n_{x} \\\\\n-\\,N_{1}(\\xi)\\,n_{y} \\\\\n-\\,N_{2}(\\xi)\\,n_{x} \\\\\n-\\,N_{2}(\\xi)\\,n_{y}\n\\end{bmatrix}}$$", "id": "3510014"}, {"introduction": "在理解了单个接触点的力学行为后，我们需要评估整个接触界面的离散化方案的性能。斑块检验（patch test）是验证有限元方法是否具备基本一致性和准确性的“试金石”。这个思想实验旨在对比两种主流的接触离散化方法——点对面（Node-to-Segment, NTS）和面面（Segment-to-Segment, S2S）方法，揭示为何简单的离散格式可能导致虚假的压力振荡，而更复杂的格式则能提供稳定和精确的结果。这项练习对于培养评估和选择合适数值方法的批判性思维至关重要。[@problem_id:3509997]", "problem": "考虑一个在二维小应变线性弹性理论下的无摩擦单边接触斑块测试，该测试在两个相同的矩形弹性连续体（标记为物体 $1$ 和物体 $2$）之间进行。它们分别占据域 $\\Omega^{(1)}$ 和 $\\Omega^{(2)}$，并拥有一个与水平轴对齐、长度为 $L$ 的完全平坦的界面 $\\Gamma_{c}$。设 $\\Gamma_{c}$ 是 $\\Omega^{(1)}$ 的下边界和 $\\Omega^{(2)}$ 的上边界。在 $\\Gamma_{c}$ 上，$\\Omega^{(1)}$ 的外单位法向量为 $\\mathbf{n}$，而 $\\Omega^{(2)}$ 的外单位法向量为 $-\\mathbf{n}$。两个物体具有相同的弹性模量，即杨氏模量 $E$ 和泊松比 $\\nu$，并且在平面应变条件下厚度相等。非接触边界上施加了大小为 $p_{0}0$ 的均匀压缩牵引力，使得在强制接触且无穿透的情况下，其精确解在 $\\Gamma_{c}$ 上产生恒定的接触压力 $p(\\mathbf{x})=p_{0}$、零法向间隙 $g_{n}(\\mathbf{x})=0$ 以及零切向牵引力。\n\n控制弱形式将标准的线性动量平衡与接触约束耦合起来。对于位移场 $\\mathbf{u}^{(1)}$ 和 $\\mathbf{u}^{(2)}$ 以及测试函数 $\\mathbf{w}^{(1)}$ 和 $\\mathbf{w}^{(2)}$，每个物体上的弹性部分为\n$$\n\\int_{\\Omega^{(k)}} \\boldsymbol{\\sigma}(\\mathbf{u}^{(k)}):\\boldsymbol{\\varepsilon}(\\mathbf{w}^{(k)})\\,\\mathrm{d}\\Omega = \\int_{\\Omega^{(k)}} \\mathbf{b}^{(k)}\\cdot \\mathbf{w}^{(k)}\\,\\mathrm{d}\\Omega + \\int_{\\Gamma_{N}^{(k)}} \\bar{\\mathbf{t}}^{(k)}\\cdot \\mathbf{w}^{(k)}\\,\\mathrm{d}\\Gamma, \\quad k\\in\\{1,2\\},\n$$\n其中 $\\boldsymbol{\\sigma}(\\mathbf{u}) = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u}))\\,\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\mathbf{u})$，拉梅参数 $\\lambda,\\mu$ 与 $E,\\nu$ 相关。在 $\\Gamma_{c}$ 上，无摩擦单边接触条件用法向间隙 $g_{n}(\\mathbf{x})$ 和法向接触压力 $p(\\mathbf{x})$ 表示为 $p(\\mathbf{x})\\ge 0$，$g_{n}(\\mathbf{x})\\ge 0$ 和 $p(\\mathbf{x})\\,g_{n}(\\mathbf{x})=0$，其弱接触贡献项为\n$$\n-\\int_{\\Gamma_{c}} p(\\mathbf{x})\\,\\mathbf{n}\\cdot \\left(\\mathbf{w}^{(1)} - \\mathbf{w}^{(2)}\\right)\\,\\mathrm{d}\\Gamma.\n$$\n\n使用有限元方法 (FEM) 进行离散化，为 $\\Omega^{(1)}$ 和 $\\Omega^{(2)}$ 构建相同的网格，每个网格在 $\\Gamma_{c}$ 上都有一个由 $m$ 个等长线段组成的笔直界面网格，节点为 $\\{\\mathbf{x}_{a}\\}_{a=1}^{m+1}$；位移场通过从面上的标准界面迹形函数 $\\{N_{a}(\\xi)\\}$ 进行插值，其中 $\\xi$ 是局部界面坐标。\n\n考虑两种可供选择的接触离散化方法：\n\n- 点到段 (NTS)：法向间隙在从节点处进行评估，法向接触压力通过与从节点配置在同一位置的节点拉格朗日乘子 $\\{\\lambda_{a}\\}$ 进行离散，使用的插值阶数与位移迹相同。离散接触双线性形式简化为与 $\\Gamma_{c}$ 上的质量集中求积一致的节点和。\n\n- 段到段 (S2S)：一种砂浆类 (mortar-type) 格式，使用一个拉格朗日乘子场 $p_{h}(\\xi)$，该场由定义在从网格上的对偶（双正交）界面形函数 $\\{\\widehat{M}_{a}(\\xi)\\}$ 插值得到，满足双正交条件\n$$\n\\int_{\\Gamma_{c}} \\widehat{M}_{a}(\\xi)\\,N_{b}(\\xi)\\,\\mathrm{d}\\Gamma = \\delta_{ab}\\,w_{a},\n$$\n对于所有的 $a,b$，其中 $w_{a}0$ 是标量权重，$\\delta_{ab}$ 是克罗内克 δ。然后，接触耦合涉及分段积分，将反作用力分布在段上而不是集中在节点上。\n\n斑块测试要求，在均匀外部压缩下，离散模型能够再现精确的界面解 $p(\\mathbf{x})\\equiv p_{0}$，$g_{n}(\\mathbf{x})\\equiv 0$，并且计算出的接触压力中没有伪振荡。关于此斑块测试，提出以下陈述：\n\nA. 在使用双正交对偶形函数作为乘子场的 S2S 方法中，离散接触算子能够在 $\\Gamma_{c}$ 上精确地再现一个恒定的压力 $p_{h}(\\xi)\\equiv p_{0}$，并且段反力等于 $p_{0}$ 乘以段长度；因此，通过了斑块测试。\n\nB. 在从节点处配置等阶节点拉格朗日乘子的 NTS 方法中，离散系统满足一个稳定的离散 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件，保证了均匀的乘子场且无振荡；因此，通过了斑块测试。\n\nC. 在从节点处使用罚函数法强制施加法向间隙的 NTS 方法中，界面反力场集中在节点上，即使在网格相同的情况下，重建的接触压力中也会产生伪振荡，除非引入一致的投影或平滑处理；因此，在其严格意义上未通过斑块测试。\n\nD. S2S 砂浆格式仅在从网格和主网格相同且节点对齐时才能通过恒定压力斑块测试；如果网格不匹配，则无法再现恒定压力。\n\n以上陈述中，哪些是正确的？", "solution": "问题陈述描述了计算力学中接触离散化的一个经典斑块测试。该测试验证了一种数值方法是否能够在一个平坦界面上精确再现恒定的接触压力状态，这是一项基本的一致性要求。该问题是适定的，并且在科学上是合理的，允许对所提出的数值格式进行严格分析。\n\n分析的关键在于用于位移场和拉格朗日乘子（接触压力）场的离散函数空间的性质。一个稳定且准确的接触格式要求所选空间满足离散 inf-sup 或 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件。不满足此条件的格式容易在计算出的压力场中产生伪振荡，而满足此条件的格式可以提供稳定且收敛的解。\n\n设 $\\mathcal{V}_h$ 是接触边界 $\\Gamma_c$ 上位移场迹的离散空间，设 $\\mathcal{M}_h$ 是拉格朗日乘子（压力）场的离散空间。对于线性单元，位移迹是分段线性和连续的，所以 $u_h|_ {\\Gamma_c} \\in \\mathcal{V}_h = \\{v \\in C^0(\\Gamma_c) \\mid v|_e \\in P_1(e) \\}$，其中 $P_1(e)$ 是单元 $e$ 上的线性多项式空间。\n\n让我们分析两种提出的离散化格式。\n\n**1. 段到段 (S2S) 砂浆格式**\n该方法采用一个由对偶或双正交基函数 $\\{\\widehat{M}_a(\\xi)\\}$ 张成的拉格朗日乘子空间 $\\mathcal{M}_h$。这些基函数是相对于位移迹基函数 $\\{N_b(\\xi)\\}$（即标准的帐篷状 $P_1$ 形函数）通过以下条件定义的：\n$$ \\int_{\\Gamma_{c}} \\widehat{M}_{a}(\\xi)\\,N_{b}(\\xi)\\,\\mathrm{d}\\Gamma = \\delta_{ab}\\,w_{a} $$\n其中 $\\delta_{ab}$ 是克罗内克 δ，$w_a  0$ 是权重。这种构造是专门为满足 LBB 条件而设计的。\n\n为了通过斑块测试，该方法必须能够精确表示恒定压力解 $p(\\mathbf{x}) = p_0$。这意味着必须存在一个离散压力场 $p_h(\\xi) \\in \\mathcal{M}_h$，使得 $p_h(\\xi) = p_0$。我们可以写出 $p_h(\\xi) = \\sum_a \\lambda_a \\widehat{M}_a(\\xi)$，其中 $\\lambda_a$ 是未知的乘子系数。要使其等于 $p_0$，必须满足：\n$$ \\sum_a \\lambda_a \\widehat{M}_a(\\xi) = p_0 $$\n为了找到系数 $\\lambda_a$，我们可以将此方程投影到位移基函数 $\\{N_b(\\xi)\\}$ 上：\n$$ \\int_{\\Gamma_c} \\left( \\sum_a \\lambda_a \\widehat{M}_a(\\xi) \\right) N_b(\\xi) \\, \\mathrm{d}\\Gamma = \\int_{\\Gamma_c} p_0 N_b(\\xi) \\, \\mathrm{d}\\Gamma $$\n利用双正交性质，左侧简化为：\n$$ \\sum_a \\lambda_a (\\delta_{ab} w_a) = \\lambda_b w_b $$\n因此，所需的系数为：\n$$ \\lambda_b = \\frac{p_0}{w_b} \\int_{\\Gamma_c} N_b(\\xi) \\, \\mathrm{d}\\Gamma $$\n由于该方程为 $\\{\\lambda_b\\}$ 产生了一组唯一的系数，因此恒定压力状态在乘子空间 $\\mathcal{M}_h$ 中是可精确表示的。得到的离散节点力为 $F_{c,b} = \\lambda_b w_b = p_0 \\int_{\\Gamma_c} N_b(\\xi) \\, \\mathrm{d}\\Gamma$，这正对应于均匀压力 $p_0$ 的一致节点力。因为精确解包含在位移和压力的有限元近似空间内，伽辽金法将精确地恢复它。因此，带有对偶基的 S2S 砂浆方法通过了斑块测试。\n\n**2. 带有配置拉格朗日乘子的点到段 (NTS) 方法**\n该方法使用“点在段上”或从点配置的方法。问题陈述指出，拉格朗日乘子 $\\{\\lambda_a\\}$ 配置在从节点处，并使用与位移迹相同的插值阶数。这对应于选择乘子空间 $\\mathcal{M}_h$ 与位移迹空间 $\\mathcal{V}_h$ 相同。对于线性单元，这是 P1-P1（位移为分段线性，压力也为分段线性）配对。在混合有限元方法理论中，这是一个经典结论：在斯托克斯流中对速度-压力，或在接触/不可压缩性问题中对位移-压力采用这种等阶配对，会违反 LBB 条件。\n\n不满足 LBB 条件会导致格式不稳定。压力（或拉格朗日乘子）场不是唯一确定的，并且容易出现非物理的伪振荡。即使在这个简单的斑块测试中，精确解是恒定压力，配置的 NTS 方法计算出的节点乘子值也会在真值 $p_0$ 附近振荡。因此，无法再现恒定压力，斑块测试失败。\n\n**3. 使用罚函数法的 NTS**\n这是一种替代的 NTS 方法，其中接触约束不是通过拉格朗日乘子强制施加，而是通过向势能中添加一个罚函数项，形式为 $\\frac{1}{2} \\epsilon_N g_n^2$，其中 $\\epsilon_N$ 是一个大的罚参数。在离散形式中，这被应用于从节点，导致节点反作用力 $F_{c,a} = \\epsilon_N g_{n,a}$（对于穿透 $g_{n,a}  0$，或对间隙进行适当的重新定义）。与配置的LM方法一样，这种方法在离散点上强制施加约束。已知的，由此产生的节点反作用力也是振荡的，不能准确地表示恒定的压力分布。为了获得连续的压力场，需要一个重建或平滑过程，但底层的节点数据是振荡的。因此，该方法在其严格意义上也没有通过恒定压力斑块测试。\n\n现在，我们评估每个陈述：\n\n**A. 在使用双正交对偶形函数作为乘子场的 S2S 方法中，离散接触算子能够在 $\\Gamma_{c}$ 上精确地再现一个恒定的压力 $p_{h}(\\xi)\\equiv p_{0}$，并且段反力等于 $p_{0}$ 乘以段长度；因此，通过了斑块测试。**\n如上所述，带有对偶基的 S2S 砂浆方法是专门为能够精确表示恒定压力场而构建的。拉格朗日乘子的系数可以被唯一确定以匹配 $p_0$。由此产生的力分布与恒定压力场是一致的。恒定压力 $p_0$ 在长度为 $L_s$ 的段上的积分确实是 $p_0 L_s$。这个陈述正确地描述了一个良好制定的砂浆方法的特性。\n**结论：正确。**\n\n**B. 在从节点处配置等阶节点拉格朗日乘子的 NTS 方法中，离散系统满足一个稳定的离散 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件，保证了均匀的乘子场且无振荡；因此，通过了斑块测试。**\n这个陈述有根本性的错误。其前提，即采用等阶插值的 NTS 格式满足 LBB 条件，是错误的。这种空间选择是已知的 LBB-不稳定的。因此，它不能保证均匀的乘子场，实际上容易产生伪振荡。斑块测试没有通过。\n**结论：不正确。**\n\n**C. 在从节点处使用罚函数法强制施加法向间隙的 NTS 方法中，界面反力场集中在节点上，即使在网格相同的情况下，重建的接触压力中也会产生伪振荡，除非引入一致的投影或平滑处理；因此，在其严格意义上未通过斑块测试。**\n这个陈述正确地描述了 NTS 罚函数法的行为。在离散点上强制施加约束导致了一组节点反作用力。对于恒定压力斑块测试，这些节点力已知会表现出振荡（例如，它们在接触区域的两端通常比在内部小）。任何直接从这些力重建连续压力场的尝试都会继承这些振荡。结论是，在其严格意义上未通过斑块测试是准确的。这种行为是点配置接触格式普遍存在的症状，包括问题中描述的不稳定的拉格朗日乘子变体。\n**结论：正确。**\n\n**D. S2S 砂浆格式仅在从网格和主网格相同且节点对齐时才能通过恒定压力斑块测试；如果网格不匹配，则无法再现恒定压力。**\n这个陈述是错误的。砂浆 (S2S) 方法的一个主要动机和关键优势是其处理界面处不匹配、非协调网格的能力。一个正确制定的砂浆方法，例如使用对偶拉格朗日乘子基的方法，被设计为即使在网格不相同的情况下也能通过斑块测试（包括恒定压力测试）。声称它*仅*在网格相同时才通过，否定了该方法本身的目的。\n**结论：不正确。**\n\n根据分析，陈述 A 和 C 是正确的。", "answer": "$$\\boxed{AC}$$", "id": "3509997"}, {"introduction": "本练习将理论付诸实践，要求您通过编程实现一个计算斑块检验，以数值方式验证点对面（NTS）和面面（STS）方法的关键特性。您将检验两种方法在刚体运动下的运动学一致性（即是否产生虚假间隙）以及在恒定压力下的平衡一致性（即是否能精确再现接触力）。通过在非匹配网格上实现接触力的重建过程，您可以直观地观察到简单方法的缺陷，并体会到诸如砂浆法（mortar method）等高级格式的鲁棒性。[@problem_id:3509964]", "problem": "考虑一个二维、小应变、无摩擦接触界面，该界面位于 $y=0$ 处，是一个直线段 $\\Gamma = [0,L] \\subset \\mathbb{R}$，存在于两个弹性连续体之间。设 $\\mathbf{n} = (0,1)$ 表示界面的单位法向量。我们考虑精确运动学，其中两个物体都经历一个均匀的刚体位移场 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0$，其中 $\\mathbf{u}_0 \\in \\mathbb{R}^2$ 在 $\\Gamma$ 上是常数。两个预期接触面的初始构型在 $\\Gamma$ 上重合，且没有初始间隙。\n\n将用作基础的基本定义和定律：\n- 法向间隙定义为 $g_n = \\mathbf{n} \\cdot (\\mathbf{x}_s - \\mathbf{x}_m)$，其中 $\\mathbf{x}_s$ 和 $\\mathbf{x}_m$ 分别表示从面和主面上的当前位置。\n- 无摩擦法向接触牵引力为 $t_n$，在拉格朗日乘子强制中，$t_n$ 等于弱形式中的拉格朗日乘子 $\\lambda_n$，即 $t_n = \\lambda_n$。\n- 在两个物体以相同的 $\\mathbf{u}_0$ 进行均匀刚体运动时，精确运动学意味着在 $\\Gamma$ 上处处有 $g_n = 0$。\n- 作用力-反作用力原理要求，跨 $\\Gamma$ 传递的牵引力场在适当的（强形式或弱形式）意义上是平衡的，并与拉格朗日乘子场一致。\n\n我们比较计算岩土力学中使用的两种标准接触离散化方法：\n1. 点对面（Node-To-Segment, NTS）：基于将从节点投影到主段上并通过从节点求积（节点集中）组装接触贡献的离散强制方法，主面侧使用线性段和线性形函数。\n2. 面对面（Segment-To-Segment, STS）砂浆法：基于通过求解沿 $\\Gamma$ 的一致一维质量矩阵问题，将拉格朗日乘子场投影到主迹空间上的弱强制方法。\n\n在下面的计算斑块测试中，你将：\n- 通过为每种方法计算间隙一致性度量来验证刚体运动下的几何一致性。对于 NTS，在从节点处评估；对于 STS，在主段上的标准高斯点处评估。\n- 通过沿 $\\Gamma$ 指定一个恒定的拉格朗日乘子场 $\\lambda_n(x) = p_0$（恒定且为压缩）来验证牵引力平衡，为每种方法重构相应的主面侧牵引力场，并测量其与精确恒定场 $t_n(x) = p_0$ 之间的 $L^2$ 误差。NTS 的重构必须通过在最近点投影处使用局部线性形函数，将从节点力分配到主节点，并按节点贡献长度进行归一化；STS 的重构必须通过在主网格上求解一致的一维质量矩阵系统以获得节点牵引力系数，然后在每个主段上进行线性插值来获得。\n\n精确的计算定义：\n- 设主网格节点为 $0 = x^m_0  x^m_1  \\dots  x^m_{N_m} = L$，定义了 $N_m$ 个线性段。设从网格节点为 $0 = x^s_0  x^s_1  \\dots  x^s_{N_s} = L$，定义了 $N_s$ 个线性段。所有坐标都位于 $\\Gamma$ 上。\n- 一维网格中节点 $x_i$ 的贡献长度定义为相邻段长度之和的一半（在端点处只有一个相邻段）。\n- 在恒定乘子 $p_0$ 下的 NTS 牵引力组装过程如下：为每个从节点分配一个标量节点力 $f^s_i = p_0 \\, w^s_i$，其中 $w^s_i$ 是其贡献长度。然后，通过在 $x^s_i$ 到该主段的投影处评估的线性形函数，将每个 $f^s_i$ 分配给包含 $x^s_i$ 的唯一主段的两个相邻主节点，从而得到一个累积的主节点力向量。重构的主节点牵引力是每个节点上的累积主节点力除以其主贡献长度。然后通过在相邻主节点值之间进行线性插值，获得沿每个主段的连续牵引力场。\n- STS 牵引力重构通过在主网格上组装并求解一致的一维质量矩阵系统 $M \\mathbf{c} = \\mathbf{b}$ 来获得，其中 $M_{ab} = \\int_{\\Gamma} N_a N_b \\, \\mathrm{d}x$，$N_a$ 是主节点基函数，而 $b_a = \\int_{\\Gamma} N_a \\, p_0 \\, \\mathrm{d}x$。解 $\\mathbf{c}$ 是主节点牵引力值，通过在每个主段上进行线性插值定义了一个连续的牵引力场。\n- $L^2$ 牵引力误差计算为 $\\left( \\int_{\\Gamma} (t_n(x) - p_0)^2 \\, \\mathrm{d}x \\right)^{1/2}$，其中 $t_n(x)$ 是重构的连续主面侧牵引力。此积分通过在每个主段上使用标准的两点高斯求积来近似。\n- 每种方法的间隙一致性度量是在精确运动学 $\\mathbf{u} = \\mathbf{u}_0$（同样施加于两个物体）下，在其评估点（NTS 为从节点，STS 为主段上的两点高斯点）上的最大法向间隙绝对值。\n\n所有量均为无量纲。\n\n测试套件。对于以下每种情况，设 $L = 1$ 并按顺序计算四个标量：\n- $G_{\\mathrm{NTS}}$：NTS 评估点的最大法向间隙绝对值。\n- $E_{\\mathrm{NTS}}$：NTS 的 $L^2$ 牵引力误差。\n- $G_{\\mathrm{STS}}$：STS 评估点的最大法向间隙绝对值。\n- $E_{\\mathrm{STS}}$：STS 的 $L^2$ 牵引力误差。\n\n使用：\n1. 情况 1（不匹配、非均匀）：\n   - 主节点：$[0.0, 0.25, 0.55, 0.8, 1.0]$。\n   - 从节点：$[0.0, 0.2, 0.6, 0.9, 1.0]$。\n   - $p_0 = 3.0$。\n   - $\\mathbf{u}_0 = (0.01,-0.02)$。\n2. 情况 2（极端不匹配、粗糙主网格）：\n   - 主节点：$[0.0, 1.0]$。\n   - 从节点：$[0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]$。\n   - $p_0 = 1.5$。\n   - $\\mathbf{u}_0 = (0.0, 0.0)$。\n3. 情况 3（匹配、均匀）：\n   - 主节点：$[0.0, 0.25, 0.5, 0.75, 1.0]$。\n   - 从节点：$[0.0, 0.25, 0.5, 0.75, 1.0]$。\n   - $p_0 = 2.2$。\n   - $\\mathbf{u}_0 = (0.003, 0.004)$。\n4. 情况 4（高度非均匀、不匹配）：\n   - 主节点：$[0.0, 0.05, 0.9, 1.0]$。\n   - 从节点：$[0.0, 0.4, 0.41, 0.8, 1.0]$。\n   - $p_0 = 5.0$。\n   - $\\mathbf{u}_0 = (-0.02, 0.01)$。\n\n你的程序必须精确实现上述定义，并生成单行输出，其中包含一个由逗号分隔的列表，包含 16 个浮点数，并用方括号括起来，顺序为\n$\\left[ G_{\\mathrm{NTS}}^{(1)}, E_{\\mathrm{NTS}}^{(1)}, G_{\\mathrm{STS}}^{(1)}, E_{\\mathrm{STS}}^{(1)}, \\dots, G_{\\mathrm{NTS}}^{(4)}, E_{\\mathrm{NTS}}^{(4)}, G_{\\mathrm{STS}}^{(4)}, E_{\\mathrm{STS}}^{(4)} \\right]$，\n每个值使用小数表示法，最多保留十二位有效数字。", "solution": "我们从接触运动学和弱强制原则开始。在界面 $\\Gamma$ 上，法向间隙定义为 $g_n = \\mathbf{n}\\cdot(\\mathbf{x}_s - \\mathbf{x}_m)$，其中 $\\mathbf{n}$ 是主面上的外法线，$\\mathbf{x}_s$ 和 $\\mathbf{x}_m$ 分别表示从面和主面上对应点的当前位置。如果两个物体都经历相同的刚体运动 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0$ 并且初始构型沿 $\\Gamma$ 重合，那么 $\\mathbf{x}_s = \\mathbf{X}_s + \\mathbf{u}_0$ 和 $\\mathbf{x}_m = \\mathbf{X}_m + \\mathbf{u}_0$ 且在 $\\Gamma$ 上 $\\mathbf{X}_s = \\mathbf{X}_m$，因此\n$$\ng_n = \\mathbf{n} \\cdot \\big( (\\mathbf{X}_s + \\mathbf{u}_0) - (\\mathbf{X}_m + \\mathbf{u}_0) \\big) = \\mathbf{n} \\cdot (\\mathbf{X}_s - \\mathbf{X}_m) = 0.\n$$\n因此，精确运动学得出 $g_n = 0$ 处处成立。\n\n在由拉格朗日乘子强制的无摩擦接触公式中，法向接触的弱陈述可以简化为在 $\\Gamma$ 上的一维迹形式：\n$$\n\\int_{\\Gamma} w \\, t_n \\, \\mathrm{d}x = \\int_{\\Gamma} w \\, \\lambda_n \\, \\mathrm{d}x\n$$\n对于所有容许的标量测试函数 $w$；因此在弱形式意义上 $t_n = \\lambda_n$。对于一个恒定的指定拉格朗日乘子场 $\\lambda_n(x) = p_0$，精确的牵引力场为 $t_n(x) = p_0$。\n\n我们现在描述用于计算斑块测试的离散实现，以及它们如何与基本原则相联系。\n\n点对面（NTS）离散化。NTS 方法通过将每个从节点投影到其在主面上的最近点，并使用从节点求积（节点集中）来近似界面积分，从而强制接触条件。对于具有节点 $\\{x^s_i\\}_{i=0}^{N_s}$ 的从网格，定义节点 $x^s_i$ 处的贡献长度为\n$$\nw^s_i = \\begin{cases}\n\\frac{1}{2}(x^s_{i+1} - x^s_i),  i=0,\\\\\n\\frac{1}{2}(x^s_{i+1} - x^s_{i-1}),  0  i  N_s,\\\\\n\\frac{1}{2}(x^s_{i} - x^s_{i-1}),  i=N_s,\n\\end{cases}\n$$\n主网格的贡献长度 $\\{w^m_j\\}_{j=0}^{N_m}$ 也类似地定义。在恒定乘子 $\\lambda_n = p_0$ 下，$x^s_i$ 处的集中从节点力为 $f^s_i = p_0 \\, w^s_i$。包含 $x^s_i$ 的唯一主段的端点为 $(x^m_j, x^m_{j+1})$，在投影位置处评估的局部线性主形函数给出的权重为 $N_1 = 1 - \\xi$，$N_2 = \\xi$，其中 $\\xi = (x^s_i - x^m_j)/(x^m_{j+1} - x^m_j) \\in [0,1]$。对主节点力的相等且相反的贡献是 $f^m_j \\mathrel{+}= f^s_i N_1$ 和 $f^m_{j+1} \\mathrel{+}= f^s_i N_2$。然后，重构的主节点牵引力定义为\n$$\nt^m_j = \\frac{f^m_j}{w^m_j}.\n$$\n通过在相邻节点值 $t^m_j$ 和 $t^m_{j+1}$ 之间进行线性插值，可以得到沿每个主段的连续牵引力场，记为 $t^{\\mathrm{NTS}}(x)$。这种构造是对弱等式 $t_n = \\lambda_n$ 的一种近似，仅在从求积与主基函数特定对齐的情况下（例如，当主节点与从节点对齐时，或者当主基函数是全局线性时）才是精确的。通常，不匹配的网格会导致从节点求积用从网格划分上的梯形法则来近似 $\\int N_j \\, \\mathrm{d}x$，这对于在从单元内部具有斜率不连续性的函数来说不是精确的；这会产生非零的差异。\n\n面对面（STS）砂浆法离散化。STS 方法通过一致质量矩阵将拉格朗日乘子场投影到主迹空间上。设 $N_j(x)$ 表示主节点基函数（线性形函数）。主质量矩阵 $M \\in \\mathbb{R}^{(N_m+1)\\times(N_m+1)}$ 的元素为\n$$\nM_{ab} = \\int_{\\Gamma} N_a(x) N_b(x) \\, \\mathrm{d}x,\n$$\n右侧项为\n$$\nb_a = \\int_{\\Gamma} N_a(x) \\, \\lambda_n(x) \\, \\mathrm{d}x = p_0 \\int_{\\Gamma} N_a(x) \\, \\mathrm{d}x.\n$$\n求解 $M \\mathbf{c} = \\mathbf{b}$ 得到主节点牵引力系数 $\\mathbf{c} = (c_0, \\dots, c_{N_m})^\\top$ 和通过对 $\\{c_j\\}$ 进行线性插值得到的连续牵引力场 $t^{\\mathrm{STS}}(x)$。因为主基函数构成单位分解，并且我们进行了一致积分，所以恒定场 $p_0$ 被精确重现；也就是说，对于所有 $j$，有 $c_j = p_0$，并且 $t^{\\mathrm{STS}}(x) \\equiv p_0$。\n\n间隙一致性评估。在两个物体上都施加精确运动学 $\\mathbf{u} = \\mathbf{u}_0$ 且初始界面重合的情况下，每个从节点都以零法向间距投影到主界面上，因此 NTS 在从节点上的最大法向间隙为\n$$\nG_{\\mathrm{NTS}} = \\max_i |g_n(x^s_i)| = 0.\n$$\n对于 STS，在主段上的标准求积点处评估同样得到\n$$\nG_{\\mathrm{STS}} = \\max_{q} |g_n(x_q)| = 0.\n$$\n在数值上，这些值应该为零，直到舍入误差。\n\n牵引力平衡缺陷。对于任一重构的连续牵引力 $t(x)$，我们在主面上计算离散 $L^2$ 误差\n$$\nE = \\left( \\int_{\\Gamma} (t(x) - p_0)^2 \\, \\mathrm{d}x \\right)^{1/2},\n$$\n该误差通过在每个主段上使用两点高斯求积来近似。对于 STS，$E_{\\mathrm{STS}}$ 在求解器容差范围内为零。对于 NTS，对于不匹配的划分，$E_{\\mathrm{NTS}}$ 通常为非零；它在特殊情况下消失，例如单个主段（基函数全局线性）或匹配网格（主节点转折点与从求积节点重合），这反映了从节点梯形法则对线性函数的精确积分。\n\n程序的算法设计：\n1. 对于每个测试用例，构建主节点和从节点数组、常数 $p_0$ 和位移 $\\mathbf{u}_0$。因为所有节点都位于 $y=0$ 上，并且两个物体共享相同的 $\\mathbf{u}_0$，所以法向间隙恒为零；计算 $G_{\\mathrm{NTS}}$ 为从节点上的最大绝对间隙，以及 $G_{\\mathrm{STS}}$ 为每个主段上两点高斯点上的最大绝对间隙，以验证数值零。\n2. 计算主节点和从节点的贡献长度，即相邻段长度之和的一半（端点使用单个相邻段的一半）。\n3. NTS 牵引力重构：\n   - 组装从节点力 $f^s_i = p_0 \\, w^s_i$。\n   - 对于每个从节点，找到其所在的主段，计算局部坐标 $\\xi \\in [0,1]$，并通过 $(1-\\xi, \\xi)$ 累加将 $f^s_i$ 分配给相邻的主节点。\n   - 将累积的主节点力除以主贡献长度，得到主节点牵引力值，并沿段进行线性插值以定义 $t^{\\mathrm{NTS}}(x)$。\n   - 在每个主段上计算 $E_{\\mathrm{NTS}}$ 的两点高斯求积近似。\n4. STS 牵引力重构：\n   - 使用长度为 $h$ 的段上的局部贡献 $M^{(e)} = \\frac{h}{6} \\begin{bmatrix}2  1\\\\ 1  2\\end{bmatrix}$ 组装一致的一维质量矩阵 $M$。\n   - 使用局部向量 $b^{(e)} = \\frac{h}{2} \\begin{bmatrix}1\\\\ 1\\end{bmatrix} p_0$ 组装右侧项。\n   - 求解 $M \\mathbf{c} = \\mathbf{b}$ 以获得主节点牵引力值，并沿段进行线性插值以定义 $t^{\\mathrm{STS}}(x)$。\n   - 计算 $E_{\\mathrm{STS}}$ 的两点高斯求积近似。\n5. 对每个测试用例，汇总四个标量 $[G_{\\mathrm{NTS}}, E_{\\mathrm{NTS}}, G_{\\mathrm{STS}}, E_{\\mathrm{STS}}]$，并按规定的单行格式打印所有结果。\n\n给定测试套件的预期定性结果：\n- 在情况 1 和情况 4（不匹配网格）中，由于精确运动学，$G_{\\mathrm{NTS}} \\approx 0$ 和 $G_{\\mathrm{STS}} \\approx 0$，而由于位于从单元内部的主节点转折点处的求积不一致性，$E_{\\mathrm{NTS}}$ 严格为正；$E_{\\mathrm{STS}}$ 在数值上为零。\n- 在情况 2（单个主段）中，两种方法都产生 $E \\approx 0$，因为主基函数是全局线性的，从节点梯形法则可以精确地积分它们。\n- 在情况 3（匹配网格）中，两种方法都产生 $E \\approx 0$，因为从求积节点与主转折点重合，使得梯形法则对于分段线性基函数是精确的。\n\n这表明，从运动学定义和弱强制出发，当网格不匹配时，NTS 方法可能违反精确运动学下的精确牵引力平衡 $t_n = \\lambda_n$，而 STS 砂浆法则在弱形式意义上精确地重现了恒定牵引力场；两者在刚体运动下都保持 $g_n = 0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef tributary_lengths(nodes):\n    nodes = np.asarray(nodes, dtype=float)\n    n = len(nodes)\n    w = np.zeros(n, dtype=float)\n    if n == 1:\n        w[0] = 0.0\n        return w\n    # End nodes\n    w[0] = 0.5 * (nodes[1] - nodes[0])\n    w[-1] = 0.5 * (nodes[-1] - nodes[-2])\n    # Interior nodes\n    for i in range(1, n - 1):\n        w[i] = 0.5 * (nodes[i+1] - nodes[i-1])\n    return w\n\ndef find_master_segment(x, xm):\n    # Returns index j such that x in [xm[j], xm[j+1]]\n    # Clamp x to [xm[0], xm[-1]]\n    if x = xm[0]:\n        return 0\n    if x = xm[-1]:\n        return len(xm) - 2\n    j = np.searchsorted(xm, x, side='right') - 1\n    if j == len(xm) - 1:\n        j = len(xm) - 2\n    if j  0:\n        j = 0\n    return j\n\ndef gauss_points_segment(xa, xb):\n    # Two-point Gauss on [xa, xb]\n    h = xb - xa\n    # Reference points +-1/sqrt(3)\n    gp_ref = np.array([-1.0/np.sqrt(3.0), 1.0/np.sqrt(3.0)])\n    # Map to physical\n    xg = 0.5*(xb + xa) + 0.5*h*gp_ref\n    wg = np.array([1.0, 1.0]) * 0.5 * h  # weights include Jacobian\n    # Also return shape functions at gauss points in reference [-1,1] space mapped to xi in [0,1]\n    xi = 0.5*(gp_ref + 1.0)  # 0..1\n    N = np.vstack([1.0 - xi, xi]).T  # shape functions N1,N2 at gauss points\n    return xg, wg, N\n\ndef nts_reconstruct_master_traction(xm, xs, p0):\n    xm = np.asarray(xm, dtype=float)\n    xs = np.asarray(xs, dtype=float)\n    wm = tributary_lengths(xm)\n    ws = tributary_lengths(xs)\n    # Slave nodal forces\n    fs = p0 * ws\n    # Accumulate master nodal forces\n    fm = np.zeros_like(xm)\n    for i, x in enumerate(xs):\n        # Distribute fs[i] to the containing master segment nodes with linear weights\n        j = find_master_segment(x, xm)\n        xa = xm[j]\n        xb = xm[j+1]\n        h = xb - xa\n        if h == 0:\n            # Degenerate; skip\n            continue\n        xi = (x - xa) / h  # in [0,1] ideally\n        N1 = 1.0 - xi\n        N2 = xi\n        fm[j] += fs[i] * N1\n        fm[j+1] += fs[i] * N2\n    # Reconstructed nodal traction on master\n    # Avoid division by zero: if wm[j]==0, set traction to 0 (no measure)\n    tm = np.zeros_like(xm)\n    for j in range(len(xm)):\n        if wm[j]  0:\n            tm[j] = fm[j] / wm[j]\n        else:\n            tm[j] = 0.0\n    return tm  # nodal values at master nodes\n\ndef sts_reconstruct_master_traction(xm, p0):\n    xm = np.asarray(xm, dtype=float)\n    nm = len(xm)\n    # Assemble mass matrix M and RHS b\n    M = np.zeros((nm, nm), dtype=float)\n    b = np.zeros(nm, dtype=float)\n    for j in range(nm - 1):\n        xa = xm[j]\n        xb = xm[j+1]\n        h = xb - xa\n        # Local mass matrix for linear 1D element\n        Mloc = (h / 6.0) * np.array([[2.0, 1.0],\n                                     [1.0, 2.0]], dtype=float)\n        # Local RHS for constant p0: integral of N * p0 over element\n        bloc = (h / 2.0) * np.array([1.0, 1.0], dtype=float) * p0\n        # Assembly\n        M[j:j+2, j:j+2] += Mloc\n        b[j:j+2] += bloc\n    # Solve M c = b\n    # Use a robust solver; M is symmetric positive definite\n    c = np.linalg.solve(M, b)\n    return c  # nodal values at master nodes\n\ndef traction_L2_error(xm, tnodal, p0):\n    # Compute L2 error norm between linear interpolated tnodal and constant p0\n    err2 = 0.0\n    for j in range(len(xm) - 1):\n        xa = xm[j]\n        xb = xm[j+1]\n        xg, wg, N = gauss_points_segment(xa, xb)\n        # Interpolate traction at gauss points\n        tj = np.array([tnodal[j], tnodal[j+1]])\n        tg = N @ tj\n        diff = tg - p0\n        err2 += np.sum((diff**2) * wg)\n    return np.sqrt(err2)\n\ndef nts_gap_max(xs, xm, u0):\n    # Under rigid-body motion with identical u0, the gap is zero.\n    # Evaluate at slave nodes: n = (0,1), both y=0 always - gap = 0\n    # Compute explicitly as zeros to reflect evaluation\n    # We keep code that could be extended but for this straight interface, it's zero.\n    gaps = np.zeros(len(xs), dtype=float)\n    return float(np.max(np.abs(gaps)))\n\ndef sts_gap_max(xm, u0):\n    # Evaluate at two-point Gauss points on each master segment; also zero\n    max_gap = 0.0\n    for j in range(len(xm) - 1):\n        xa = xm[j]\n        xb = xm[j+1]\n        xg, wg, N = gauss_points_segment(xa, xb)\n        gaps = np.zeros_like(xg)  # all zero for this exact kinematics\n        max_gap = max(max_gap, float(np.max(np.abs(gaps))))\n    return float(max_gap)\n\ndef format_float(x):\n    # Format with up to 12 significant digits to satisfy problem statement\n    return f\"{x:.12g}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"xm\": [0.0, 0.25, 0.55, 0.8, 1.0],\n            \"xs\": [0.0, 0.2, 0.6, 0.9, 1.0],\n            \"p0\": 3.0,\n            \"u0\": (0.01, -0.02)\n        },\n        # Case 2\n        {\n            \"xm\": [0.0, 1.0],\n            \"xs\": [0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0],\n            \"p0\": 1.5,\n            \"u0\": (0.0, 0.0)\n        },\n        # Case 3\n        {\n            \"xm\": [0.0, 0.25, 0.5, 0.75, 1.0],\n            \"xs\": [0.0, 0.25, 0.5, 0.75, 1.0],\n            \"p0\": 2.2,\n            \"u0\": (0.003, 0.004)\n        },\n        # Case 4\n        {\n            \"xm\": [0.0, 0.05, 0.9, 1.0],\n            \"xs\": [0.0, 0.4, 0.41, 0.8, 1.0],\n            \"p0\": 5.0,\n            \"u0\": (-0.02, 0.01)\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        xm = np.array(case[\"xm\"], dtype=float)\n        xs = np.array(case[\"xs\"], dtype=float)\n        p0 = float(case[\"p0\"])\n        u0 = tuple(case[\"u0\"])\n\n        # Gap measures\n        G_nts = nts_gap_max(xs, xm, u0)\n        G_sts = sts_gap_max(xm, u0)\n\n        # NTS traction reconstruction and error\n        tnodal_nts = nts_reconstruct_master_traction(xm, xs, p0)\n        E_nts = traction_L2_error(xm, tnodal_nts, p0)\n\n        # STS traction reconstruction and error\n        tnodal_sts = sts_reconstruct_master_traction(xm, p0)\n        E_sts = traction_L2_error(xm, tnodal_sts, p0)\n\n        # Append in the prescribed order: G_NTS, E_NTS, G_STS, E_STS\n        results.extend([G_nts, E_nts, G_sts, E_sts])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(format_float(r) for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3509964"}]}