{"hands_on_practices": [{"introduction": "本练习是热传导分析的基础。我们从能量守恒和傅里叶热传导定律这两个第一性原理出发，推导在一个带有内部热源的简化一维土层中稳态温度场的解析解。通过这个实践，你将掌握从基本物理定律出发，建立和求解地质力学中热问题数学模型的核心技能。[@problem_id:3525671]", "problem": "一个厚度为 $L$ 的均质土层占据区域 $x \\in [0,L]$，且侧向绝热，因此热流严格沿 $x$ 轴一维（$1$D）传导。该土壤的导热系数 $k$ 为常数，并存在一个空间上均匀的体积生热率 $q$。当 $q$ 为正值时，表示对土壤加热。该土层处于稳态，其两端温度为给定值：$T(0)=T_{0}$ 和 $T(L)=T_{L}$。从局部能量守恒和 Fourier 热传导定律出发，推导在这些条件下稳态温度场 $T(x)$（$x \\in [0,L]$）的闭式表达式。清晰地陈述推导所需的任何假设。将最终答案表示为 $T(x)$ 的单个闭式解析表达式。无需进行数值计算。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 一个厚度为 $L$ 的均质土层占据区域 $x \\in [0,L]$。\n- 热流沿 $x$ 轴一维（$1$D）传导（侧向绝热）。\n- 导热系数 $k$ 是常数。\n- 存在一个空间上均匀的体积生热率，记为 $q$。\n- 系统处于稳态。\n- 给定的边界条件：$T(0)=T_{0}$ 和 $T(L)=T_{L}$。\n- 推导必须从局部能量守恒和 Fourier 热传导定律出发。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是传热学原理的一个经典应用，特别是带有源项的稳态热方程。这是物理学和工程学（包括地质力学）中的一个基本概念。其前提是科学合理的。\n- **适定性**：该问题描述了一个带有两个指定边界条件（Dirichlet 条件）的二阶常微分方程。这种结构确保了唯一且稳定解的存在。\n- **客观性**：该问题使用清晰、精确且标准的数学和物理学术语进行陈述。所有参数（$L, k, q, T_{0}, T_{L}$）都得到了正式定义。\n- **完整性与一致性**：该问题是自洽的。它提供了推导所需的控制物理定律、区域、边界条件和材料属性。没有缺失数据或矛盾约束。\n- **真实性**：这些假设（一维流动、恒定属性、均匀生成）是标准的理想化处理，用于为许多实际情景（例如埋地电缆或放射性废料罐附近地下的热流）获得解析解。该设定在物理上是合理的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它是科学合理的、适定的、客观的和自洽的。可以并且将会推导出严谨的解。\n\n### 温度场的推导\n\n推导始于稳态系统的局部能量守恒原理。考虑在区域 $x \\in [0,L]$ 内一个长度为 $dx$、横截面积为 $A$ 的微分控制体。在稳态下，能量累积率为零。能量平衡方程为：\n\n（在 $x$ 处传导进入的能量速率）-（在 $x+dx$ 处传导出去的能量速率）+（控制体内产生的能量速率）= $0$\n\n设 $j(x)$ 为沿 $x$ 正方向的热通量（单位面积单位时间的能量）。能量平衡可以写作：\n$$A j(x) - A j(x+dx) + q (A \\, dx) = 0$$\n其中 $q$ 是体积生热率。等式两边同除以体积 $A \\, dx$ 得：\n$$-\\frac{j(x+dx) - j(x)}{dx} + q = 0$$\n当 $dx \\to 0$ 时取极限，我们得到一维能量守恒方程的微分形式：\n$$-\\frac{dj}{dx} + q = 0$$\n\n接下来，我们引入 Fourier 热传导定律，该定律将热通量 $j(x)$ 与局部温度梯度 $\\frac{dT}{dx}$ 联系起来：\n$$j(x) = -k \\frac{dT}{dx}$$\n其中 $k$ 是材料的导热系数。负号表示热量沿温度梯度方向向下流动（从高温到低温）。\n\n将 Fourier 热传导定律代入能量守恒方程，得到：\n$$-\\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) + q = 0$$\n$$\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) + q = 0$$\n\n问题陈述中指出导热系数 $k$ 是常数。因此，可以将其从导数中提出：\n$$k \\frac{d^2T}{dx^2} + q = 0$$\n\n这就是稳态温度场 $T(x)$ 的控制二阶常微分方程。我们可以将其改写为：\n$$\\frac{d^2T}{dx^2} = -\\frac{q}{k}$$\n\n为了求出温度分布 $T(x)$，我们将此方程对 $x$ 积分两次。第一次积分得到：\n$$\\frac{dT}{dx} = -\\frac{q}{k}x + C_1$$\n其中 $C_1$ 是第一个积分常数。\n\n第二次积分得到温度场的通解：\n$$T(x) = -\\frac{q}{2k}x^2 + C_1 x + C_2$$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 通过应用给定的边界条件 $T(0) = T_0$ 和 $T(L) = T_L$ 来确定。\n\n应用第一个边界条件，在 $x=0$ 处：\n$$T(0) = -\\frac{q}{2k}(0)^2 + C_1(0) + C_2 = T_0$$\n这直接得出 $C_2 = T_0$。\n\n现在解变为：\n$$T(x) = -\\frac{q}{2k}x^2 + C_1 x + T_0$$\n\n应用第二个边界条件，在 $x=L$ 处：\n$$T(L) = -\\frac{q}{2k}L^2 + C_1 L + T_0 = T_L$$\n\n现在我们求解常数 $C_1$：\n$$C_1 L = T_L - T_0 + \\frac{qL^2}{2k}$$\n$$C_1 = \\frac{T_L - T_0}{L} + \\frac{qL}{2k}$$\n\n最后，我们将 $C_1$ 和 $C_2$ 的表达式代回 $T(x)$ 的通解，得到该问题的特解：\n$$T(x) = -\\frac{q}{2k}x^2 + \\left(\\frac{T_L - T_0}{L} + \\frac{qL}{2k}\\right)x + T_0$$\n\n可以对该表达式进行重组，以更好地揭示其物理意义。我们可以将与生热无关的项和与生热相关的项分开：\n$$T(x) = T_0 + \\left(\\frac{T_L - T_0}{L}\\right)x - \\frac{q}{2k}x^2 + \\frac{qL}{2k}x$$\n将与 $q$ 相关的项组合在一起，得到最终的闭式表达式：\n$$T(x) = T_0 + (T_L - T_0)\\frac{x}{L} + \\frac{q}{2k}(Lx - x^2)$$\n该解表明，温度分布是一个线性分布（$q=0$ 时的解）和一个由内部生热引起的抛物线分布的叠加。此推导所需的假设已在问题中明确说明：稳态条件、一维热流和恒定的材料属性（$k$）。", "answer": "$$\\boxed{T(x) = T_{0} + \\left(T_{L} - T_{0}\\right) \\frac{x}{L} + \\frac{q}{2k} \\left(Lx - x^{2}\\right)}$$", "id": "3525671"}, {"introduction": "在真实的地质系统中，热量传递不仅通过传导，还常常伴随着流体流动（即平流）。本练习将引导你通过无量纲化分析，推导出衡量平流与传导相对重要性的关键无量纲参数——佩克莱数（Péclet number, $Pe$）。掌握这种分析方法，对于在复杂的场问题中识别主导物理机制、简化模型以及做出合理的工程判断至关重要。[@problem_id:3525735]", "problem": "一个厚度为 $L$ 的完全饱和、均质的砂岩层受到一个恒定的垂直水力梯度 $i$ 的作用，该梯度驱动着稳定的地下水流动。孔隙流体是处于接近均匀参考温度的水，并且施加在岩层两端的一个微小温差维持着热传导。假设整个岩层和时间范围内的性质是恒定的。从饱和多孔介质的局部能量守恒方程出发，结合热传导的傅里叶定律和地下水流动的达西定律，对控制能量方程进行无量纲化，以确定比较流动引起的热平流与热传导的无量纲数群，然后根据以下数据计算其值。最后，利用该无量纲数群的量级，判断在此长度尺度上，平流相对于传导是否可以忽略。\n\n给定数据：\n- 砂岩的固有渗透率：$k_{i} = 5.0 \\times 10^{-13}\\,\\mathrm{m}^{2}$。\n- 水力梯度：$i = 0.020$。\n- 水的动力粘度：$\\mu = 1.00 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。\n- 水的密度：$\\rho_{f} = 998\\,\\mathrm{kg/m^{3}}$。\n- 水的比热容：$c_{f} = 4184\\,\\mathrm{J/(kg\\cdot K)}$。\n- 重力加速度：$g = 9.81\\,\\mathrm{m/s^{2}}$。\n- 饱和砂岩的有效导热系数：$k_{\\mathrm{eff}} = 2.7\\,\\mathrm{W/(m\\cdot K)}$。\n- 岩层厚度（特征长度）：$L = 10\\,\\mathrm{m}$。\n\n说明：\n- 从第一性原理推导相关的无量纲数群，并用可测量的性质和达西速度来表示它。\n- 使用达西定律将达西速度与水力梯度和固有渗透率联系起来。\n- 根据所提供的数据计算此无量纲数群的数值。\n- 将您的答案四舍五入到三位有效数字。\n- 将最终数值报告为无单位的纯实数。", "solution": "首先通过检查其前提和约束条件来验证问题。\n\n**步骤1：提取已知条件**\n- 砂岩的固有渗透率：$k_{i} = 5.0 \\times 10^{-13}\\,\\mathrm{m}^{2}$。\n- 水力梯度：$i = 0.020$。\n- 水的动力粘度：$\\mu = 1.00 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。\n- 水的密度：$\\rho_{f} = 998\\,\\mathrm{kg/m^{3}}$。\n- 水的比热容：$c_{f} = 4184\\,\\mathrm{J/(kg\\cdot K)}$。\n- 重力加速度：$g = 9.81\\,\\mathrm{m/s^{2}}$。\n- 饱和砂岩的有效导热系数：$k_{\\mathrm{eff}} = 2.7\\,\\mathrm{W/(m\\cdot K)}$。\n- 岩层厚度（特征长度）：$L = 10\\,\\mathrm{m}$。\n- 条件：稳定地下水流，性质恒定，完全饱和的均质岩层。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于传热学（傅里叶定律）和多孔介质中流体流动（达西定律）的公认原理，这些是水文地质学和地质力学的基石。所有概念都具有科学合理性。\n- **适定性**：该问题要求从基本方程和给定数据推导并计算一个特定的无量纲数。这是工程和物理学中一个标准且定义明确的任务，保证了唯一且有意义的解的存在。\n- **客观性**：问题以精确、定量的术语陈述，没有主观或模糊的语言。\n- **完整性和一致性**：所有必要的物理性质和参数都以一致的国际单位制提供。对于所描述的地质情景，这些值在物理上是现实的。没有矛盾之处。\n\n**步骤3：结论和行动**\n该问题是有效的，因为它具有科学依据、适定、客观且内部一致。将推导求解。\n\n在性质恒定且无热源的情况下，饱和多孔介质中稳态传热的控制方程平衡了流体流动的热平流和通过介质的热传导。这表示为：\n$$(\\rho_f c_f) \\mathbf{v}_D \\cdot \\nabla T = \\nabla \\cdot (k_{\\mathrm{eff}} \\nabla T)$$\n在这里，$\\rho_f$ 是流体密度，$c_f$ 是流体的比热容，$\\mathbf{v}_D$ 是达西速度矢量，$T$ 是温度，$k_{\\mathrm{eff}}$ 是饱和多孔介质的有效导热系数。左边的项代表平流热输运，右边的项代表传导热输运。\n\n为了确定比较这两种热输运机制的无量纲数群，我们对方程进行无量纲化。我们使用特征尺度引入无量纲变量。设 $L$ 为特征长度（岩层厚度），$v_D$ 为特征速度（达西速度的大小），$\\Delta T$ 为岩层两端的特征温差。\n无量纲变量定义为：\n$$ \\mathbf{x}^* = \\frac{\\mathbf{x}}{L} \\quad \\text{和} \\quad T^* = \\frac{T-T_{\\mathrm{ref}}}{\\Delta T} $$\n梯度和拉普拉斯算子用无量纲坐标表示为：\n$$ \\nabla = \\frac{1}{L} \\nabla^* \\quad \\text{和} \\quad \\nabla^2 = \\frac{1}{L^2} \\nabla^{*2} $$\n将这些代入控制方程：\n$$ (\\rho_f c_f) (v_D \\mathbf{e}_v) \\cdot \\left(\\frac{\\Delta T}{L} \\nabla^* T^*\\right) = k_{\\mathrm{eff}} \\left(\\frac{\\Delta T}{L^2} \\nabla^{*2} T^*\\right) $$\n其中 $\\mathbf{e}_v$ 是流动方向的单位矢量。重新整理各项，我们得到：\n$$ \\frac{(\\rho_f c_f) v_D L}{k_{\\mathrm{eff}}} (\\mathbf{e}_v \\cdot \\nabla^* T^*) = \\nabla^{*2} T^* $$\n在平流项前面的无量纲数群是佩克莱数（Péclet number），$Pe$。它代表了热平流速率与热传导速率之比：\n$$ Pe = \\frac{\\text{平流热输运}}{\\text{传导热输运}} = \\frac{(\\rho_f c_f) v_D L}{k_{\\mathrm{eff}}} $$\n接下来，我们必须确定达西速度 $v_D$。达西定律指出，比流量（达西速度）与水力梯度 $i$ 成正比：\n$$ v_D = K i $$\n其中 $K$ 是水力传导系数。水力传导系数与固有渗透率 $k_i$ 和流体性质的关系如下：\n$$ K = \\frac{k_i \\rho_f g}{\\mu} $$\n其中 $g$ 是重力加速度，$\\mu$ 是流体的动力粘度。结合这些，达सी速度为：\n$$ v_D = \\frac{k_i \\rho_f g i}{\\mu} $$\n代入给定值：\n$$ v_D = \\frac{(5.0 \\times 10^{-13}\\,\\mathrm{m}^{2}) (998\\,\\mathrm{kg/m^{3}}) (9.81\\,\\mathrm{m/s^{2}}) (0.020)}{1.00 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}} $$\n$$ v_D = 9.79038 \\times 10^{-8}\\,\\mathrm{m/s} $$\n现在，我们可以用这个速度计算佩克莱数：\n$$ Pe = \\frac{(998\\,\\mathrm{kg/m^{3}}) (4184\\,\\mathrm{J/(kg\\cdot K)}) (9.79038 \\times 10^{-8}\\,\\mathrm{m/s}) (10\\,\\mathrm{m})}{2.7\\,\\mathrm{W/(m\\cdot K)}} $$\n$$ Pe = \\frac{4088.193}{2.7} $$\n$$ Pe \\approx 1.514145... $$\n问题要求将答案四舍五入到三位有效数字。\n$$ Pe \\approx 1.51 $$\n佩克莱数比较了平流和传导的相对重要性。$Pe \\ll 1$ 的值表示传导占主导地位，而 $Pe \\gg 1$ 的值表示平流占主导地位。由于计算出的值为 $Pe \\approx 1.51$，其数量级为1（$O(1)$），因此在此长度尺度上，热平流和热传导都是重要的输运机制。因此，相对于传导，平流不可忽略。", "answer": "$$\\boxed{1.51}$$", "id": "3525735"}, {"introduction": "本章的最终目标是理解并模拟温度变化如何影响岩土材料的力学行为。这个综合性练习将热传导分析与弹塑性力学相结合，要求你为一个温度依赖的Drucker-Prager本构模型构建一个完整的应力更新算法。通过实现这一热-力耦合模型，你将深入理解温度如何通过改变材料强度（如内聚力 $c(T)$）来直接控制其变形和破坏响应。[@problem_id:3525679]", "problem": "在一个岩土体中的某个材料点上，需要进行小应变热-弹-塑性本构更新。该点的温度由傅里叶热传导控制，其屈服行为遵循 Drucker–Prager (DP) 模型。该材料在弹性域内是各向同性的线性弹性体，其体积模量为 $K$，剪切模量为 $G$。塑性是关联的，其 Drucker-Prager 屈服函数为 $f(\\boldsymbol{\\sigma},T) = \\sqrt{J_2(\\boldsymbol{\\sigma})} + a\\,I_1(\\boldsymbol{\\sigma}) - c(T)$，其中 $a$ 是给定的摩擦参数，$I_1(\\boldsymbol{\\sigma})$ 是柯西应力张量 $\\boldsymbol{\\sigma}$ 的第一不变量，$J_2(\\boldsymbol{\\sigma})$ 是偏应力张量的第二不变量。内聚力 $c(T)$ 依赖于温度 $T$，其关系为 $c(T) = c_0 - b\\,(T - T_0)$，其中 $c_0$、$b$ 和 $T_0$ 是常数。热膨胀是各向同性的，热膨胀系数为 $\\alpha_T$，因此热应变增量为 $\\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{th}} = \\alpha_T\\,\\Delta T\\,\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量，$\\Delta T = T^{n+1}-T^n$。\n\n温度演化由傅里叶热传导控制，其中密度 $\\rho$、比热 $c_p$、热导率 $k_{\\mathrm{th}}$ 均为常数，并存在一个均匀的体积热源 $r$。在 $t^n$ 时刻，对于一个已知温度拉普拉斯算子 $\\nabla^2 T$ 的材料点，温度的单步向前欧拉时间更新为：\n$$\nT^{n+1} = T^n + \\Delta t \\left( \\frac{k_{\\mathrm{th}}}{\\rho c_p}\\,\\nabla^2 T^n + \\frac{r}{\\rho c_p} \\right),\n$$\n其中 $\\Delta t$ 是时间步长。\n\n在同一材料点上，在此时间步长内，给定了一个总小应变增量 $\\Delta \\boldsymbol{\\varepsilon}$。应力更新遵循标准的 Drucker–Prager 模型的弹性预测/塑性修正（返回映射）方案。目标是构建：\n- 更新后的柯西应力 $\\boldsymbol{\\sigma}^{n+1}$，\n- 塑性一致性增量 $\\Delta \\lambda$，\n- 在固定 $T^{n+1}$ 下的一致算法力学切线 $\\mathbb{C}_{\\mathrm{ep}} = \\partial \\boldsymbol{\\sigma}^{n+1}/\\partial \\boldsymbol{\\varepsilon}^{n+1}$，\n- 以及在固定 $\\boldsymbol{\\varepsilon}^{n+1}$ 下的热-力耦合张量 $\\partial \\boldsymbol{\\sigma}^{n+1}/\\partial T^{n+1}$，\n仅从基本定义和定律出发。您必须精确处理偏量和体积部分，并确保算法切线与返回映射一致。假设流动法则是关联的，并且是理想塑性，除了与温度相关的内聚力 $c(T)$ 外，没有应变硬化。\n\n请实现一个程序，使用以下固定的材料和热学参数，并针对三个测试用例执行此更新。所有应力和模量必须以兆帕（MPa）为单位处理；温度以开尔文（K）为单位；时间以秒（s）为单位；密度以千克每立方米（kg/m$^3$）为单位；比热以焦耳每千克每开尔文（J/(kg·K)）为单位；热导率以瓦特每米每开尔文（W/(m·K)）为单位；热源以瓦特每立方米（W/m$^3$）为单位。\n\n材料和热学常数（所有测试用例共享）：\n- $K = 20000$ MPa, $G = 12000$ MPa, $a = 0.1$, $c_0 = 20$ MPa, $b = 0.2$ MPa/K, $T_0 = 293$ K, $\\alpha_T = 1\\times 10^{-5}$ K$^{-1}$。\n- $\\rho = 2200$ kg/m$^3$, $c_p = 800$ J/(kg·K), $k_{\\mathrm{th}} = 2$ W/(m·K)。\n- 所有用例的上一步应力均为零，$\\boldsymbol{\\sigma}^n = \\boldsymbol{0}$，上一步温度为 $T^n = 293$ K。\n\n测试套件（每个用例指定时间步数据和给定的总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$）：\n- 情况 1（名义弹性）：$\\Delta t = 60$ s, $\\nabla^2 T^n = 0$ K/m$^2$, $r = 0$ W/m$^3$，且 $\\Delta \\boldsymbol{\\varepsilon} = \\mathrm{diag}(1\\times 10^{-5},\\,1\\times 10^{-5},\\,1\\times 10^{-5})$。\n- 情况 2（力学驱动的塑性）：$\\Delta t = 60$ s, $\\nabla^2 T^n = 0$ K/m$^2$, $r = 0$ W/m$^3$，且 $\\Delta \\boldsymbol{\\varepsilon} = \\mathrm{diag}(1\\times 10^{-3},\\,-5\\times 10^{-4},\\,-5\\times 10^{-4})$。\n- 情况 3（温度引起的软化至塑性）：$\\Delta t = 3600$ s, $\\nabla^2 T^n = 0$ K/m$^2$, $r = \\rho c_p \\times 50 / 3600$ W/m$^3$，且 $\\Delta \\boldsymbol{\\varepsilon} = \\mathrm{diag}(5\\times 10^{-4},\\,-2.5\\times 10^{-4},\\,-2.5\\times 10^{-4})$。\n\n对于每个用例，您的程序必须：\n- 通过上述傅里叶更新计算 $T^{n+1}$。\n- 从第一性原理执行返回映射，以获得 $\\boldsymbol{\\sigma}^{n+1}$ 和塑性一致性增量 $\\Delta \\lambda$，包括由 $\\Delta T$ 构建的热应变 $\\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{th}}$。\n- 构建在固定 $T^{n+1}$ 下的一致算法力学切线 $\\mathbb{C}_{\\mathrm{ep}}$。\n- 构建在固定 $\\boldsymbol{\\varepsilon}^{n+1}$ 下的热-力耦合张量 $\\partial \\boldsymbol{\\sigma}^{n+1}/\\partial T^{n+1}$。\n\n为使结果可测试且简洁，对于每个用例，输出一个包含以下四个量的列表：\n- 一个整数形式的塑性指示符，其中 $1$ 表示发生塑性修正，$0$ 表示弹性。\n- 塑性一致性增量 $\\Delta \\lambda$（无量纲），四舍五入到六位小数。\n- 算法体积模量 $K_{\\mathrm{alg}} = \\frac{1}{9}\\,\\boldsymbol{I}:\\mathbb{C}_{\\mathrm{ep}}:\\boldsymbol{I}$，单位为 MPa，四舍五入到六位小数。\n- 热-力耦合张量的弗罗贝尼乌斯范数 $\\left\\|\\partial \\boldsymbol{\\sigma}^{n+1}/\\partial T^{n+1}\\right\\|_F$，单位为 MPa/K，四舍五入到六位小数。\n\n您的程序应生成一行输出，其中包含这些按用例排列的列表，以逗号分隔并用方括号括起来（例如：\"[[case1_list],[case2_list],[case3_list]]\"）。", "solution": "该问题要求在材料点上实现小应变热-弹-塑性本构更新。热行为由傅里叶热传导控制，力学行为遵循具有温度依赖性内聚力的关联 Drucker-Prager (DP) 模型。我们必须推导更新后的应力 $\\boldsymbol{\\sigma}^{n+1}$、塑性乘子增量 $\\Delta\\lambda$、一致算法力学切线 $\\mathbb{C}_{\\mathrm{ep}}$ 以及热-力耦合张量 $\\partial \\boldsymbol{\\sigma}^{n+1}/\\partial T^{n+1}$。\n\n求解过程分为几个步骤：（1）更新温度，（2）执行弹性预测/塑性修正的应力更新，以及（3）从更新算法中推导所需的切线模量和耦合张量。\n\n### 1. 预备知识：本构关系\n\n总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 可加性地分解为弹性、塑性和热学部分：\n$$\n\\Delta \\boldsymbol{\\varepsilon} = \\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{e}} + \\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{p}} + \\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{th}}\n$$\n线性各向同性弹性应力-应变关系由胡克定律给出：\n$$\n\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}_{\\mathrm{e}} = (3K \\mathbb{P}_{\\mathrm{vol}} + 2G \\mathbb{P}_{\\mathrm{dev}}) : \\boldsymbol{\\varepsilon}_{\\mathrm{e}}\n$$\n其中 $K$ 和 $G$ 分别是体积模量和剪切模量，$\\mathbb{P}_{\\mathrm{vol}} = \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I}$ 和 $\\mathbb{P}_{\\mathrm{dev}} = \\mathbb{I} - \\mathbb{P}_{\\mathrm{vol}}$ 分别是四阶体积和偏量投影张量。$\\boldsymbol{I}$ 是二阶单位张量，$\\mathbb{I}$ 是四阶对称单位张量。\n\n热应变增量是各向同性的：\n$$\n\\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{th}} = \\alpha_T \\Delta T \\boldsymbol{I}\n$$\n其中 $\\alpha_T$ 是热膨胀系数，$\\Delta T = T^{n+1} - T^n$。\n\nDrucker-Prager 屈服函数为：\n$$\nf(\\boldsymbol{\\sigma}, T) = \\sqrt{J_2(\\boldsymbol{\\sigma})} + a \\, I_1(\\boldsymbol{\\sigma}) - c(T) \\le 0\n$$\n其中 $I_1(\\boldsymbol{\\sigma}) = \\mathrm{tr}(\\boldsymbol{\\sigma})$ 是应力张量的第一不变量，$J_2(\\boldsymbol{\\sigma}) = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 是偏应力张量 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}I_1(\\boldsymbol{\\sigma})\\boldsymbol{I}$ 的第二不变量，$a$ 是摩擦参数，$c(T)$ 是与温度相关的内聚力：\n$$\nc(T) = c_0 - b(T - T_0)\n$$\n塑性流动是关联的，这意味着塑性应变增量垂直于屈服面：\n$$\n\\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{p}} = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\lambda \\boldsymbol{N}\n$$\n其中 $\\Delta\\lambda \\ge 0$ 是塑性乘子增量，$\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 是流动方向。$\\boldsymbol{N} = \\frac{\\boldsymbol{s}}{2\\sqrt{J_2}} + a\\boldsymbol{I}$。\n\n### 2. 温度更新\n\n新时间步 $t^{n+1}$ 的温度通过单步向前欧拉法计算：\n$$\nT^{n+1} = T^n + \\Delta t \\left( \\frac{k_{\\mathrm{th}}}{\\rho c_p}\\,\\nabla^2 T^n + \\frac{r}{\\rho c_p} \\right)\n$$\n此更新后的温度 $T^{n+1}$ 用于后续的力学更新。$\\Delta T = T^{n+1}-T^n$。\n\n### 3. 应力更新：弹性预测-塑性修正\n\n给定 $t^n$ 时刻的状态 $(\\boldsymbol{\\sigma}^n, T^n)$ 和在 $\\Delta t$ 内给定的总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$，求新的状态 $(\\boldsymbol{\\sigma}^{n+1}, T^{n+1})$。\n\n#### 3.1. 弹性预测\n首先，我们假设整个力学应变增量都是弹性的。基于此假设计算试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{trial}}$：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{trial}} = \\boldsymbol{\\sigma}^n + \\mathbb{C} : (\\Delta \\boldsymbol{\\varepsilon} - \\Delta \\boldsymbol{\\varepsilon}_{\\mathrm{th}}) = \\boldsymbol{\\sigma}^n + \\mathbb{C} : (\\Delta \\boldsymbol{\\varepsilon} - \\alpha_T \\Delta T \\boldsymbol{I})\n$$\n由于 $\\boldsymbol{\\sigma}^n=\\boldsymbol{0}$，我们可以将试探应力的不变量写为：\n$$\nI_1^{\\mathrm{trial}} = I_1(\\boldsymbol{\\sigma}^{\\mathrm{trial}}) = 3K(\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}) - 3\\alpha_T \\Delta T)\n$$\n$$\n\\boldsymbol{s}^{\\mathrm{trial}} = \\boldsymbol{s}_{\\boldsymbol{\\sigma}^{\\mathrm{trial}}} = 2G\\,\\boldsymbol{e}\n$$\n其中 $\\boldsymbol{e} = \\Delta\\boldsymbol{\\varepsilon} - \\frac{1}{3}\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon})\\boldsymbol{I}$ 是总应变增量的偏量部分。\n\n#### 3.2. 屈服检查\n我们在试探状态和新温度 $T^{n+1}$ 下评估屈服函数：\n$$\nf^{\\mathrm{trial}} = f(\\boldsymbol{\\sigma}^{\\mathrm{trial}}, T^{n+1}) = \\sqrt{J_2(\\boldsymbol{s}^{\\mathrm{trial}})} + a\\, I_1^{\\mathrm{trial}} - c(T^{n+1})\n$$\n如果 $f^{\\mathrm{trial}} \\le 0$，则假设正确，该步为弹性。最终应力为 $\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{trial}}$，塑性增量为 $\\Delta\\lambda = 0$。\n\n#### 3.3. 塑性修正（返回映射）\n如果 $f^{\\mathrm{trial}}  0$，则试探状态位于屈服面之外，表明发生了塑性变形。应力状态必须被“返回”到屈服面上。最终应力 $\\boldsymbol{\\sigma}^{n+1}$ 与试探应力相关：\n$$\n\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{trial}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{p}} = \\boldsymbol{\\sigma}^{\\mathrm{trial}} - \\Delta\\lambda \\, \\mathbb{C} : \\boldsymbol{N}^{n+1}\n$$\n其中 $\\boldsymbol{N}^{n+1}$ 在最终状态 $\\boldsymbol{\\sigma}^{n+1}$ 下评估。对于 DP 模型，该系统可以显式求解。返回映射得出塑性乘子的以下显式公式：\n$$\n\\Delta\\lambda = \\frac{f^{\\mathrm{trial}}}{G + 9Ka^2}\n$$\n一旦 $\\Delta\\lambda$ 已知，最终应力状态通过修正试探状态来计算：\n$$\nI_1^{n+1} = I_1^{\\mathrm{trial}} - 9Ka \\Delta\\lambda\n$$\n$$\n\\boldsymbol{s}^{n+1} = \\left(1 - \\frac{\\Delta\\lambda G}{\\sqrt{J_2^{\\mathrm{trial}}}}\\right)\\boldsymbol{s}^{\\mathrm{trial}}\n$$\n最终应力张量为 $\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{s}^{n+1} + \\frac{1}{3}I_1^{n+1}\\boldsymbol{I}$。\n\n### 4. 算法一致性切线\n\n#### 4.1. 力学切线与算法体积模量\n一致算法切线 $\\mathbb{C}_{\\mathrm{ep}} = \\partial\\boldsymbol{\\sigma}^{n+1}/\\partial\\boldsymbol{\\varepsilon}^{n+1}$ 是通过对更新算法进行精确线性化得到的。\n- **弹性情况 ($f^{\\mathrm{trial}} \\le 0$):**\n  $\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{trial}} = \\boldsymbol{\\sigma}^n + \\mathbb{C}:(\\Delta\\boldsymbol{\\varepsilon}-\\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{th}})$。在固定的 $T^{n+1}$ 下，$\\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{th}}$ 是常数。\n  $$ \\mathbb{C}_{\\mathrm{ep}} = \\frac{\\partial \\boldsymbol{\\sigma}^{\\mathrm{trial}}}{\\partial (\\Delta\\boldsymbol{\\varepsilon})} = \\mathbb{C} $$\n- **塑性情况 ($f^{\\mathrm{trial}}  0$):**\n  推导过程更为复杂，但会得到一个已知的对称四阶张量。我们关心的是算法体积模量 $K_{\\mathrm{alg}} = \\frac{1}{9}\\boldsymbol{I}:\\mathbb{C}_{\\mathrm{ep}}:\\boldsymbol{I}$。将此应用于 $\\mathbb{C}_{\\mathrm{ep}}$ 的完整表达式，得到：\n  $$ K_{\\mathrm{alg}} = K \\left( \\frac{G}{G + 9Ka^2} \\right) $$\n对于弹性情况，此框架是一致的，因为让 $\\Delta\\lambda \\to 0$（或将塑性情况视为一种通用形式），分母项可能会消失，但 $K_{alg}$ 的公式是塑性切线的属性，而不是 $\\Delta \\lambda$ 的连续函数。在弹性情况下，$K_{\\mathrm{alg}} = K$。\n\n#### 4.2. 热-力耦合张量\n热-力耦合张量为 $\\boldsymbol{h} = \\partial\\boldsymbol{\\sigma}^{n+1}/\\partial T^{n+1}$，在总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 固定的情况下。\n- **弹性情况 ($f^{\\mathrm{trial}} \\le 0$):**\n  $\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^n + \\mathbb{C}:(\\Delta\\boldsymbol{\\varepsilon} - \\alpha_T(T^{n+1}-T^n)\\boldsymbol{I})$。\n  $$ \\boldsymbol{h}_{\\mathrm{el}} = \\frac{\\partial \\boldsymbol{\\sigma}^{n+1}}{\\partial T^{n+1}} = -\\mathbb{C}:(\\alpha_T \\boldsymbol{I}) = -3K\\alpha_T\\boldsymbol{I} $$\n  弗罗贝尼乌斯范数为 $\\| \\boldsymbol{h}_{\\mathrm{el}} \\|_F = \\sqrt{(-3K\\alpha_T)^2 \\times 3} = 3\\sqrt{3} K\\alpha_T$。\n- **塑性情况 ($f^{\\mathrm{trial}}  0$):**\n  我们对塑性更新方程关于 $T^{n+1}$ 求导。试探应力通过热应变依赖于 $T^{n+1}$，而屈服条件通过内聚力 $c(T^{n+1})$ 依赖于它。\n  $$ \\frac{\\partial I_1^{\\mathrm{trial}}}{\\partial T^{n+1}} = -9K\\alpha_T, \\quad \\frac{\\partial \\boldsymbol{s}^{\\mathrm{trial}}}{\\partial T^{n+1}} = \\boldsymbol{0}, \\quad \\frac{\\partial c(T^{n+1})}{\\partial T^{n+1}} = -b $$\n  这导致塑性乘子的导数为：\n  $$ \\frac{\\partial \\Delta\\lambda}{\\partial T^{n+1}} = \\frac{1}{G+9Ka^2} \\left( a \\frac{\\partial I_1^{\\mathrm{trial}}}{\\partial T^{n+1}} - \\frac{\\partial c}{\\partial T^{n+1}} \\right) = \\frac{b - 9Ka\\alpha_T}{G+9Ka^2} $$\n  对最终应力分量求导并计算弗罗贝尼乌斯范数，得到：\n  $$ \\| \\boldsymbol{h}_{\\mathrm{pl}} \\|_F = \\frac{1}{G+9Ka^2} \\sqrt{2G^2(b - 9Ka\\alpha_T)^2 + 27K^2(G\\alpha_T + ab)^2} $$\n\n### 5. 实现公式总结\n\n对于每个测试用例：\n1.  计算 $T^{n+1}$ 和 $\\Delta T$。\n2.  计算试探应力不变量 $I_1^{\\mathrm{trial}}$、$\\boldsymbol{s}^{\\mathrm{trial}}$ 和 $\\sqrt{J_2^{\\mathrm{trial}}}$。\n3.  计算当前内聚力 $c(T^{n+1})$。\n4.  计算 $f^{\\mathrm{trial}} = \\sqrt{J_2^{\\mathrm{trial}}} + a I_1^{\\mathrm{trial}} - c(T^{n+1})$。\n5.  如果 $f^{\\mathrm{trial}} \\le 0$：\n    - 塑性指示符：$0$。\n    - $\\Delta\\lambda = 0$。\n    - $K_{\\mathrm{alg}} = K$。\n    - $\\|\\boldsymbol{h}\\|_F = 3\\sqrt{3}K\\alpha_T$。\n6.  如果 $f^{\\mathrm{trial}}  0$：\n    - 塑性指示符：$1$。\n    - 令 $H=G+9Ka^2$。\n    - $\\Delta\\lambda = f^{\\mathrm{trial}} / H$。\n    - $K_{\\mathrm{alg}} = K(G/H)$。\n    - $\\|\\boldsymbol{h}\\|_F = \\frac{1}{H}\\sqrt{2G^2(b-9Ka\\alpha_T)^2 + 27K^2(G\\alpha_T+ab)^2}$。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a thermo-elasto-plastic constitutive update for three test cases.\n    \"\"\"\n    # Material and thermal constants\n    K = 20000.0  # MPa\n    G = 12000.0  # MPa\n    a = 0.1\n    c0 = 20.0   # MPa\n    b = 0.2     # MPa/K\n    T0 = 293.0  # K\n    alpha_T = 1.0e-5  # K^-1\n    rho = 2200.0  # kg/m^3\n    cp = 800.0    # J/(kg.K)\n    k_th = 2.0    # W/(m.K)\n\n    # Initial conditions (shared)\n    sigma_n = np.zeros((3, 3))\n    T_n = 293.0  # K\n\n    test_cases = [\n        # Case 1 (nominally elastic)\n        (60.0, 0.0, 0.0, np.diag([1e-5, 1e-5, 1e-5])),\n        # Case 2 (mechanically driven plasticity)\n        (60.0, 0.0, 0.0, np.diag([1e-3, -5e-4, -5e-4])),\n        # Case 3 (temperature-induced softening to plasticity)\n        (3600.0, 0.0, rho * cp * 50.0 / 3600.0, np.diag([5e-4, -2.5e-4, -2.5e-4])),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        delta_t, lap_T_n, r, delta_eps = case\n\n        # 1. Temperature Update\n        T_n_plus_1 = T_n + delta_t * ((k_th / (rho * cp)) * lap_T_n + r / (rho * cp))\n        delta_T = T_n_plus_1 - T_n\n        \n        # 2. Elastic Predictor\n        delta_eps_v = np.trace(delta_eps)\n        delta_e = delta_eps - (delta_eps_v / 3.0) * np.eye(3)\n        \n        # Since sigma_n is zero\n        I1_trial = 3.0 * K * (delta_eps_v - 3.0 * alpha_T * delta_T)\n        s_trial = 2.0 * G * delta_e\n        \n        # 3. Yield Check\n        J2_trial = 0.5 * np.sum(s_trial * s_trial)\n        sqrt_J2_trial = np.sqrt(J2_trial)\n        \n        c_n_plus_1 = c0 - b * (T_n_plus_1 - T0)\n        \n        f_trial = sqrt_J2_trial + a * I1_trial - c_n_plus_1\n        \n        if f_trial = 0:\n            # Elastic case\n            plasticity_indicator = 0\n            delta_lambda = 0.0\n            K_alg = K\n            h_norm_F = 3.0 * np.sqrt(3.0) * K * alpha_T\n        else:\n            # Plastic case\n            plasticity_indicator = 1\n            H = G + 9.0 * K * a**2\n            delta_lambda = f_trial / H\n            \n            K_alg = K * (G / H)\n            \n            # Thermo-mechanical coupling tensor norm\n            term1 = 2.0 * G**2 * (b - 9.0 * K * a * alpha_T)**2\n            term2 = 27.0 * K**2 * (G * alpha_T + a * b)**2\n            h_norm_F = (1.0 / H) * np.sqrt(term1 + term2)\n            \n        all_results.append([\n            plasticity_indicator,\n            delta_lambda,\n            K_alg,\n            h_norm_F\n        ])\n\n    # Format output\n    case_strings = []\n    for res in all_results:\n        s = f\"[{res[0]},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        case_strings.append(s)\n    \n    final_output_str = f\"[{','.join(case_strings)}]\"\n    print(final_output_str)\n\nsolve()\n```", "answer": "```\n[[0,0.000000,20000.000000,1.039230],[1,0.000858,17391.304348,0.916896],[1,0.000305,17391.304348,0.916896]]\n```", "id": "3525679"}]}