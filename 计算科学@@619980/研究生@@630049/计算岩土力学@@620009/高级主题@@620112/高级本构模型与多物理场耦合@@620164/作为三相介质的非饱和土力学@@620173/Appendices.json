{"hands_on_practices": [{"introduction": "任何对非饱和土的分析都始于对其三相组成的清晰理解。本练习旨在巩固孔隙率和饱和度的基本定义，让学生能够计算出非饱和土样的基本质量-体积属性。这是表征三相介质、连接微观孔隙结构与宏观工程属性的第一步[@problem.id:3542387]。", "problem": "一个非饱和土试样被模拟为由固体、水和空气组成的三相介质。试样的总体积为 $V=1.0\\times 10^{-3}\\ \\mathrm{m^3}$。孔隙率为 $n=0.40$，饱和度为 $S_r=0.35$。假设水的密度为 $\\rho_w=1000\\ \\mathrm{kg/m^3}$，土粒的密度为 $\\rho_s=2650\\ \\mathrm{kg/m^3}$，在此条件下水和固体是不可压缩的，并且空气的质量可以忽略不计。使用孔隙率（孔隙体积分数）、饱和度（孔隙中水所占的体积分数）和质量-密度关系的基本定义，确定试样中水的质量、固体的质量和湿密度。\n\n报告水的质量和固体的质量（单位为 $\\mathrm{kg}$），以及湿密度（单位为 $\\mathrm{kg/m^3}$）。将最终数值结果四舍五入到四位有效数字。请按以下顺序提供三个结果：水的质量、固体的质量、湿密度。", "solution": "该问题是有效的，因为它科学地基于土力学原理，问题提法恰当，并包含了一套完整且一致的数据。求解过程通过应用三相土介质中相关系的基本定义来进行。\n\n非饱和土是一种多孔介质，由三相组成：固体颗粒（土骨架）、水和空气。试样的总体积 $V$ 是固体颗粒体积 $V_s$ 和孔隙体积 $V_v$ 的总和。孔隙被水（体积 $V_w$）和空气（体积 $V_a$）占据。\n$$V = V_s + V_v = V_s + V_w + V_a$$\n试样的总质量 $M$ 是各组分质量的总和。根据题目要求，空气的质量 $m_a$ 被认为可以忽略不计。\n$$M = m_s + m_w + m_a \\approx m_s + m_w$$\n\n题目提供了以下数据：\n- 总体积：$V = 1.0 \\times 10^{-3} \\, \\mathrm{m^3}$\n- 孔隙率：$n = 0.40$\n- 饱和度：$S_r = 0.35$\n- 水的密度：$\\rho_w = 1000 \\, \\mathrm{kg/m^3}$\n- 土粒的密度：$\\rho_s = 2650 \\, \\mathrm{kg/m^3}$\n\n首先，我们使用孔隙率和饱和度的定义来确定不同相的体积。\n\n孔隙率 $n$ 是孔隙体积与总体积之比：\n$$n = \\frac{V_v}{V}$$\n由此，可以计算出孔隙体积 $V_v$：\n$$V_v = n \\cdot V = 0.40 \\times (1.0 \\times 10^{-3} \\, \\mathrm{m^3}) = 0.40 \\times 10^{-3} \\, \\mathrm{m^3}$$\n固相的体积 $V_s$ 是总体积减去孔隙体积：\n$$V_s = V - V_v = V - nV = V(1-n)$$\n$$V_s = (1.0 \\times 10^{-3} \\, \\mathrm{m^3}) \\times (1 - 0.40) = 0.60 \\times 10^{-3} \\, \\mathrm{m^3}$$\n\n接下来，我们使用饱和度 $S_r$，其定义为水的体积与孔隙体积之比：\n$$S_r = \\frac{V_w}{V_v}$$\n这使我们能够计算水的体积 $V_w$：\n$$V_w = S_r \\cdot V_v = 0.35 \\times (0.40 \\times 10^{-3} \\, \\mathrm{m^3}) = 0.14 \\times 10^{-3} \\, \\mathrm{m^3}$$\n\n知道了水和固相的体积后，我们现在可以使用质量-密度关系 $m = \\rho V$ 来计算它们各自的质量。\n\n水的质量 $m_w$ 为：\n$$m_w = V_w \\cdot \\rho_w = (0.14 \\times 10^{-3} \\, \\mathrm{m^3}) \\times (1000 \\, \\mathrm{kg/m^3}) = 0.14 \\, \\mathrm{kg}$$\n按要求四舍五入到四位有效数字，水的质量为 $0.1400 \\, \\mathrm{kg}$。\n\n固体的质量 $m_s$ 为：\n$$m_s = V_s \\cdot \\rho_s = (0.60 \\times 10^{-3} \\, \\mathrm{m^3}) \\times (2650 \\, \\mathrm{kg/m^3}) = 1.59 \\, \\mathrm{kg}$$\n四舍五入到四位有效数字，固体的质量为 $1.590 \\, \\mathrm{kg}$。\n\n最后，我们计算试样的湿密度 $\\rho$。湿密度定义为总质量 $M$ 除以总体积 $V$。\n$$\\rho = \\frac{M}{V}$$\n总质量 $M$ 是固体质量和水质量的总和（因为空气质量可以忽略不计）：\n$$M = m_s + m_w = 1.59 \\, \\mathrm{kg} + 0.14 \\, \\mathrm{kg} = 1.73 \\, \\mathrm{kg}$$\n现在，湿密度为：\n$$\\rho = \\frac{1.73 \\, \\mathrm{kg}}{1.0 \\times 10^{-3} \\, \\mathrm{m^3}} = 1730 \\, \\mathrm{kg/m^3}$$\n这个结果是基于中间值计算得出的精确值。表示为四位有效数字，湿密度为 $1730 \\, \\mathrm{kg/m^3}$。\n\n或者，湿密度可以表示为给定参数的函数：\n$$\\rho = \\frac{m_s + m_w}{V} = \\frac{V_s \\rho_s + V_w \\rho_w}{V} = \\frac{(1-n)V\\rho_s + S_r n V \\rho_w}{V}$$\n从分子和分母中消去总体积 $V$ 可得：\n$$\\rho = (1-n)\\rho_s + n S_r \\rho_w$$\n代入给定值：\n$$\\rho = (1-0.40)(2650 \\, \\mathrm{kg/m^3}) + (0.40)(0.35)(1000 \\, \\mathrm{kg/m^3})$$\n$$\\rho = (0.60)(2650 \\, \\mathrm{kg/m^3}) + (0.14)(1000 \\, \\mathrm{kg/m^3})$$\n$$\\rho = 1590 \\, \\mathrm{kg/m^3} + 140 \\, \\mathrm{kg/m^3} = 1730 \\, \\mathrm{kg/m^3}$$\n这验证了之前的计算。\n\n所需数值，四舍五入到四位有效数字，为：\n- 水的质量 ($m_w$)：$0.1400 \\, \\mathrm{kg}$\n- 固体的质量 ($m_s$)：$1.590 \\, \\mathrm{kg}$\n- 湿密度 ($\\rho$)：$1730 \\, \\mathrm{kg/m^3}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1400  1.590  1730\n\\end{pmatrix}\n}\n$$", "id": "3542387"}, {"introduction": "在掌握了非饱和土的物理构成后，下一步是模拟其力学行为。本练习引入了非饱和土力学中的基石概念——Bishop有效应力原理。通过计算在给定应力增量下的应变响应，学生将直接应用该原理解释总应力、孔隙水压力和土骨架变形之间的关系[@problem.id:3542380]。", "problem": "将非饱和土建模为三相介质（固相、气相、水相）。假设土骨架的力学响应服从小应变、线性、各向同性弹性理论，且驱动骨架变形的应力为 Bishop 有效应力。采用岩土力学符号约定，其中压缩为正。考虑一个各向同性总应力增量，使得柯西应力增量为 $\\Delta \\sigma_{ij} = \\Delta \\sigma \\,\\delta_{ij}$，其中 $\\Delta \\sigma$ 在所有方向上均等施加。土的弹性模量为杨氏模量 $E = 50$ MPa 和泊松比 $\\nu = 0.3$。孔隙气压力为 $u_a = 0$ kPa，孔隙水压力为 $u_w = -100$ kPa，Bishop 参数为 $\\chi = 0.6$。假设在增量过程中，$\\chi$、$u_a$ 和 $u_w$ 保持不变。\n\n使用 Bishop 有效应力概念和线性弹性理论，计算由施加的各向同性总应力增量 $\\Delta \\sigma = 100$ kPa 引起的土骨架体积应变增量 $\\Delta \\varepsilon_v$。以小数应变（无量纲）形式表示最终答案，并将其四舍五入至四位有效数字。", "solution": "本题要求计算非饱和土骨架在承受各向同性总应力增量时产生的体积应变增量 $\\Delta \\varepsilon_v$。土的力学行为由线性各向同性弹性理论描述，其中 Bishop 有效应力是驱动变形的应力。采用岩土力学符号约定（压缩为正）。\n\n首先，我们必须建立应力增量和应变增量之间的关系。根据题目陈述，本构律将应变增量张量 $\\Delta \\varepsilon_{ij}$ 与 Bishop 有效应力增量张量 $\\Delta \\sigma'_{ij}$ 联系起来。对于线性各向同性弹性材料，体积应变增量 $\\Delta \\varepsilon_v = \\Delta \\varepsilon_{kk}$ 与平均有效应力增量 $\\Delta \\sigma'_m = \\frac{1}{3}\\Delta \\sigma'_{kk}$ 之间的关系由下式给出：\n$$ \\Delta \\varepsilon_v = \\frac{\\Delta \\sigma'_m}{K} $$\n其中 $K$ 是土骨架的体积模量。\n\n体积模量 $K$ 可以根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 确定：\n$$ K = \\frac{E}{3(1 - 2\\nu)} $$\n给定的值为 $E = 50 \\text{ MPa}$ 和 $\\nu = 0.3$。必须保持单位一致。我们将所有应力和模量值转换为千帕（kPa）。\n$E = 50 \\text{ MPa} = 50 \\times 10^3 \\text{ kPa} = 50000 \\text{ kPa}$。\n将 $E$ 和 $\\nu$ 的值代入 $K$ 的方程中：\n$$ K = \\frac{50000 \\text{ kPa}}{3(1 - 2 \\times 0.3)} = \\frac{50000}{3(1 - 0.6)} = \\frac{50000}{3(0.4)} = \\frac{50000}{1.2} \\text{ kPa} $$\n\n接下来，我们必须确定平均有效应力增量 $\\Delta \\sigma'_m$。Bishop 有效应力张量 $\\sigma'_{ij}$ 定义为：\n$$ \\sigma'_{ij} = \\sigma_{ij} - p_e \\delta_{ij} $$\n其中 $\\sigma_{ij}$ 是总应力张量，$\\delta_{ij}$ 是克罗内克符号，$p_e$ 是等效孔隙压力，由下式给出：\n$$ p_e = (1-\\chi)u_a + \\chi u_w $$\n这里，$\\chi$ 是 Bishop 参数，$u_a$ 是孔隙气压力，$u_w$ 是孔隙水压力。\n\nBishop 有效应力张量的增量形式为：\n$$ \\Delta \\sigma'_{ij} = \\Delta \\sigma_{ij} - \\Delta p_e \\delta_{ij} $$\n等效孔隙压力的增量 $\\Delta p_e$ 可通过对 $p_e$ 求全微分得到。假设 $\\chi$ 可变，则其表达式为 $\\Delta p_e = (1-\\chi)\\Delta u_a + \\chi \\Delta u_w + (u_w - u_a)\\Delta \\chi$。\n然而，题目明确指出，在应力增量过程中 $\\chi$、$u_a$ 和 $u_w$ 保持不变。这意味着 $\\Delta \\chi = 0$、$\\Delta u_a = 0$ 和 $\\Delta u_w = 0$。因此，等效孔隙压力的增量为零：\n$$ \\Delta p_e = (1-0.6)(0) + 0.6(0) + (-100 - 0)(0) = 0 $$\n所以，Bishop 有效应力增量等于总应力增量：\n$$ \\Delta \\sigma'_{ij} = \\Delta \\sigma_{ij} $$\n在这些特定假设下，计算增量响应时不需要初始值 $u_a = 0 \\text{ kPa}$、$u_w = -100 \\text{ kPa}$ 和 $\\chi = 0.6$。\n\n题目指定了一个各向同性总应力增量：\n$$ \\Delta \\sigma_{ij} = \\Delta \\sigma \\, \\delta_{ij} $$\n其中 $\\Delta \\sigma = 100 \\text{ kPa}$。\n因此，有效应力增量也是各向同性的：\n$$ \\Delta \\sigma'_{ij} = 100 \\, \\delta_{ij} \\text{ kPa} $$\n平均有效应力增量 $\\Delta \\sigma'_m$ 是有效应力增量张量的迹除以3：\n$$ \\Delta \\sigma'_m = \\frac{1}{3} \\Delta \\sigma'_{kk} = \\frac{1}{3} (\\Delta \\sigma'_{11} + \\Delta \\sigma'_{22} + \\Delta \\sigma'_{33}) = \\frac{1}{3} (\\Delta \\sigma + \\Delta \\sigma + \\Delta \\sigma) = \\Delta \\sigma $$\n代入给定值：\n$$ \\Delta \\sigma'_m = 100 \\text{ kPa} $$\n\n最后，我们可以计算体积应变增量 $\\Delta \\varepsilon_v$：\n$$ \\Delta \\varepsilon_v = \\frac{\\Delta \\sigma'_m}{K} = \\frac{100 \\text{ kPa}}{\\frac{50000}{1.2} \\text{ kPa}} = \\frac{100 \\times 1.2}{50000} = \\frac{120}{50000} = \\frac{12}{5000} = 0.0024 $$\n结果是正应变（压缩应变），这与施加正应力（压缩应力）增量是一致的。\n\n题目要求最终答案以小数应变表示，并四舍五入到四位有效数字。计算出的值 $0.0024$ 有两位有效数字。为了用四位有效数字表示，我们在后面添加零：$0.002400$。", "answer": "$$\\boxed{0.002400}$$", "id": "3542380"}, {"introduction": "最后的实践练习将理论与实际应用联系起来，指导学生实现一个有限元求解器。这项任务将相态关系[@problem.id:3542387]、有效应力[@problem.id:3542380]和流体流动等概念整合到一个统一的数值模型中。通过从第一性原理出发构建求解器，学生将深刻理解在工程实践中如何模拟非饱和土的耦合水力-力学行为[@problem.id:3542350]。", "problem": "要求您实现一个一维、双场有限元求解器，用于处理被视为三相介质的非饱和土。该求解器使用一个简化的线性化小应变多孔连续介质模型，并考虑轴平移。未知量是固体位移场 $u(x,t)$ 和孔隙水压力场 $u_w(x,t)$（水压力），而孔隙气压力 $u_a(t)$ 通过边界轴平移施加，并由于气相的高导通性而被假定为空间均匀。气压力 $u_a(t)$ 在 $t=0^+$ 时发生阶跃变化，此后保持恒定。\n\n从以下基本原理出发：\n\n- 线性动量平衡（准静态，忽略惯性力和体力）：$-\\dfrac{d \\sigma}{dx} = 0$。\n- 基于 Bishop 非饱和土有效应力原理的有效应力线性各向同性弹性本构关系：$\\sigma = E \\dfrac{du}{dx} - \\chi u_w - (1-\\chi) u_a$，其中 $E$ 是杨氏模量，$\\chi \\in [0,1]$ 是 Bishop 参数（在本问题中假定为常数）。\n- 一维小应变条件下，具有恒定储水和导水系数的水质量平衡方程：$M \\dfrac{\\partial u_w}{\\partial t} + \\chi \\dfrac{\\partial}{\\partial t}\\left(\\dfrac{\\partial u}{\\partial x}\\right) - \\dfrac{\\partial}{\\partial x}\\left(K \\dfrac{\\partial u_w}{\\partial x}\\right) = 0$，其中 $M$ 是比储水系数，$K$ 是导水系数，以一致的单位表示，作为乘以压力梯度项的系数。\n\n所有符号均为一维空间中的标量场，所有数学运算均为关于 $x$ 和 $t$ 的常规导数。假定单位横截面积。\n\n使用标准伽辽金方法，在区间 $[0,L]$ 上由 $N_e$ 个线性单元组成的均匀网格上，使用 $C^0$ 线性形函数推导弱形式。对 $u_w$ 和 $u$ 使用后向欧拉时间积分法，在每个时间步处理准静态动量方程。在每个时间步对耦合代数系统采用整体求解方法。\n\n边界和初始条件：\n\n- 位移边界：$u(0,t)=0$ (Dirichlet)，以及在 $x=L$ 处无牵引力（自然边界），对应于 $\\sigma(L,t)=0$。\n- 水压力边界：$u_w(0,t)=0$ (Dirichlet，左端完全排水)，以及在 $x=L$ 处无流量（自然边界），对应于 $\\dfrac{\\partial u_w}{\\partial x}(L,t)=0$。\n- 气压力通过边界上的轴平移方法施加，并且由于气相的高导通性，假定在域内空间上是均匀的：$u_a(x,t)=u_a(t)$，其中当 $t \\ge 0$ 时 $u_a(t) = u_a^{\\star}$，当 $t  0$ 时 $u_a(t)=0$。\n- $t=0$ 时的初始条件：$u(x,0)=0$ 和 $u_w(x,0)=0$。\n\n实现要求：\n\n- 在同一网格上，使用标准的一维线性有限元为 $u$ 和 $u_w$ 组装耦合系统的全局矩阵。\n- 对于力学方程，弱形式在残差中产生弹性刚度贡献项 $\\int_0^L E \\dfrac{dw}{dx} \\dfrac{du}{dx} \\, dx$，水压力耦合贡献项 $-\\int_0^L \\chi \\, u_w \\, \\dfrac{dw}{dx} \\, dx$，以及由施加的均匀气压产生的贡献项 $-\\int_0^L (1-\\chi) \\, u_a \\, \\dfrac{dw}{dx} \\, dx$。这里 $w$ 是 $u$ 的试函数。\n- 对于水质量平衡方程，试函数为 $q$，其半离散弱形式项为 $\\int_0^L M \\, q \\, \\dfrac{\\partial u_w}{\\partial t} \\, dx + \\int_0^L \\chi \\, q \\, \\dfrac{\\partial}{\\partial t}\\left(\\dfrac{\\partial u}{\\partial x}\\right) \\, dx + \\int_0^L K \\, \\dfrac{dq}{dx} \\, \\dfrac{du_w}{\\partial x} \\, dx = 0$。\n- 使用后向欧拉法，在均匀时间步长 $\\Delta t$ 上，为每个时间步的未知节点值 $u$ 和 $u_w$ 构建耦合线性系统。\n- 通过直接修改全局线性系统来施加 Dirichlet 边界条件。\n\n物理单位：\n\n- $L$ 的单位是 $\\mathrm{m}$，$E$ 的单位是 $\\mathrm{Pa}$，$\\chi$ 无量纲，$M$ 的单位是 $\\mathrm{Pa}^{-1}$，$K$ 的单位是 $\\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$，$u_a^{\\star}$ 的单位是 $\\mathrm{Pa}$，时间的单位是 $\\mathrm{s}$，位移 $u$ 的单位是 $\\mathrm{m}$，水压力 $u_w$ 的单位是 $\\mathrm{Pa}$。\n- 您的程序必须以 $\\mathrm{m}$ 为单位输出位移，以 $\\mathrm{Pa}$ 为单位输出压力。\n\n测试套件：\n\n您必须对以下四组参数运行求解器。在每种情况下，使用包含 $N_e$ 个单元的均匀网格、均匀时间步长 $\\Delta t$ 和总时间 $T$。\n\n- 情况 A（一般行为）：\n  - $L = 1.0 \\ \\mathrm{m}$, $E = 5.0 \\times 10^{7} \\ \\mathrm{Pa}$, $\\chi = 0.6$, $M = 1.0 \\times 10^{-9} \\ \\mathrm{Pa}^{-1}$, $K = 1.0 \\times 10^{-11} \\ \\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$, $u_a^{\\star} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$, $N_e = 20$, $\\Delta t = 1.0 \\times 10^{-1} \\ \\mathrm{s}$, $T = 1.0 \\times 10^{1} \\ \\mathrm{s}$。\n- 情况 B（边缘情况，零气压阶跃）：\n  - 与情况 A 相同，除了 $u_a^{\\star} = 0$ 且 $T = 5.0 \\ \\mathrm{s}$。\n- 情况 C（低导水系数）：\n  - 与情况 A 相同，除了 $K = 1.0 \\times 10^{-13} \\ \\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$ 且 $T = 5.0 \\ \\mathrm{s}$。\n- 情况 D（短域）：\n  - $L = 1.0 \\times 10^{-1} \\ \\mathrm{m}$, $E = 5.0 \\times 10^{7} \\ \\mathrm{Pa}$, $\\chi = 0.6$, $M = 1.0 \\times 10^{-9} \\ \\mathrm{Pa}^{-1}$, $K = 1.0 \\times 10^{-11} \\ \\mathrm{m}^2/(\\mathrm{Pa}\\cdot\\mathrm{s})$, $u_a^{\\star} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$, $N_e = 10$, $\\Delta t = 1.0 \\times 10^{-1} \\ \\mathrm{s}$, $T = 5.0 \\ \\mathrm{s}$。\n\n对于每种情况，在积分到时间 $T$ 后，提取：\n\n- 尖端位移 $u(L,T)$，单位为 $\\mathrm{m}$。\n- 中点处的孔隙水压力 $u_w(L/2,T)$，单位为 $\\mathrm{Pa}$，使用最接近 $x = L/2$ 的网格节点。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表按 A、B、C、D 的顺序串联每种情况的两个结果，格式为 $[u(L,T)_{\\mathrm{A}}, u_w(L/2,T)_{\\mathrm{A}}, u(L,T)_{\\mathrm{B}}, u_w(L/2,T)_{\\mathrm{B}}, u(L,T)_{\\mathrm{C}}, u_w(L/2,T)_{\\mathrm{C}}, u(L,T)_{\\mathrm{D}}, u_w(L/2,T)_{\\mathrm{D}}]$。所有值都必须是浮点数，并使用上述指定单位。", "solution": "用户希望为非饱和土中的一个耦合、线性化、准静态的多孔力学问题实现一个一维有限元求解器。该模型基于 Bishop 的有效应力概念，并将固体位移 $u(x,t)$ 和孔隙水压力 $u_w(x,t)$ 视为主要未知场。\n\n### 1. 问题验证\n\n首先，我将验证问题陈述。\n\n**第 1 步：提取已知条件**\n\n- **控制方程**:\n    - 线性动量平衡（准静态）：$-\\dfrac{d \\sigma}{dx} = 0$。\n    - 本构关系：$\\sigma = E \\dfrac{du}{dx} - \\chi u_w - (1-\\chi) u_a$。\n    - 水质量平衡：$M \\dfrac{\\partial u_w}{\\partial t} + \\chi \\dfrac{\\partial}{\\partial t}\\left(\\dfrac{\\partial u}{\\partial x}\\right) - \\dfrac{\\partial}{\\partial x}\\left(K \\dfrac{\\partial u_w}{\\partial x}\\right) = 0$。\n- **变量和参数**:\n    - 未知场：固体位移 $u(x,t)$，孔隙水压力 $u_w(x,t)$。\n    - 给定场：孔隙气压力 $u_a(t)$，空间均匀。\n    - 材料属性：杨氏模量 $E$，Bishop 参数 $\\chi$，比储水系数 $M$，导水系数 $K$。均为常数。\n- **域和离散化**:\n    - 一维域：$x \\in [0,L]$。\n    - 具有 $N_e$ 个线性单元（$C^0$ 形函数）的均匀网格。\n- **边界条件 (BCs)**:\n    - 在 $x=0$ 处：$u(0,t)=0$, $u_w(0,t)=0$。\n    - 在 $x=L$ 处：$\\sigma(L,t)=0$, $\\dfrac{\\partial u_w}{\\partial x}(L,t)=0$。\n- **初始条件 (ICs)**:\n    - 在 $t=0$ 处：$u(x,0)=0$, $u_w(x,0)=0$。\n- **荷载**:\n    - 阶跃气压：当 $t  0$ 时 $u_a(t) = 0$，当 $t \\ge 0$ 时 $u_a(t) = u_a^{\\star}$。\n- **数值方法**:\n    - 伽辽金有限元法。\n    - 使用时间步长 $\\Delta t$ 的后向欧拉法进行时间积分。\n    - 耦合系统的整体解法。\n    - 通过直接修改线性系统施加 Dirichlet 边界条件。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题描述了 Biot 多孔力学理论的简化版本，并通过 Bishop 参数将其扩展到非饱和土。这是计算岩土力学中一个标准且成熟的框架。控制偏微分方程代表了基本的平衡定律（动量和质量）。尽管所提供的本构关系中的符号约定（$\\sigma = E \\frac{du}{dx} - ...$）与标准的岩土工程文献（通常使用 $\\sigma = E \\frac{du}{dx} + ...$）相比不寻常，但它并未违反能量守恒等基本物理定律。它仅仅定义了一种具有特定响应的材料，尽管在某些情况下这种响应可能与直觉相悖。因此，该问题在数学上和内部是自洽的。它并非基于伪科学。\n- **适定性**：该问题是适定的。它由一个线性偏微分方程组和一套完整的初始及边界条件组成。指定的边界条件（一端为 Dirichlet，另一端为自然/Neumann，对两个场均如此）是标准的，足以确保存在唯一解。\n- **客观性**：该问题使用精确的数学和工程术语进行陈述。所有参数、条件和要求都是客观定义的，没有主观或基于意见的陈述。\n\n该问题没有任何无效性缺陷。它具有科学依据、适定、客观、完整且并非微不足道。\n\n**第 3 步：结论和行动**\n\n问题陈述是**有效的**。我将继续推导并实现解决方案。\n\n### 2. 有限元公式\n\n该解决方案需要为耦合系统开发一个整体有限元方案。\n\n**弱形式**\n按照标准的伽辽金程序，我们将控制方程乘以试函数（力学方程的试函数为 $w$，流体方程的试函数为 $q$），并在域 $[0,L]$ 上积分。\n\n1.  **力学方程**：\n    通过分部积分 $\\int_0^L w \\frac{d\\sigma}{dx} dx = 0$ 得到 $\\int_0^L \\frac{dw}{dx} \\sigma dx - [w\\sigma]_0^L = 0$。\n    边界项 $[w\\sigma]_0^L$ 消失，因为 $w(0)=0$（由于本质边界条件 $u(0,t)=0$）并且 $\\sigma(L,t)=0$（自然边界条件）。\n    代入 $\\sigma$ 的本构关系：\n    $$ \\int_0^L \\frac{dw}{dx} E \\frac{du}{dx} dx - \\int_0^L \\frac{dw}{dx} \\chi u_w dx = \\int_0^L \\frac{dw}{dx} (1-\\chi) u_a dx $$\n2.  **流体方程**：\n    弱形式为 $\\int_0^L q \\left( M \\frac{\\partial u_w}{\\partial t} + \\chi \\frac{\\partial}{\\partial t}(\\frac{\\partial u}{\\partial x}) - \\frac{\\partial}{\\partial x}(K \\frac{\\partial u_w}{\\partial x}) \\right) dx = 0$。\n    对导水系数项进行分部积分得到 $\\int_0^L K \\frac{dq}{dx} \\frac{\\partial u_w}{\\partial x} dx - [q K \\frac{\\partial u_w}{\\partial x}]_0^L$。\n    边界项消失，因为 $q(0)=0$（由于 $u_w(0,t)=0$）并且 $\\frac{\\partial u_w}{\\partial x}(L,t)=0$（自然边界条件）。\n    得到的弱形式为：\n    $$ \\int_0^L q M \\frac{\\partial u_w}{\\partial t} dx + \\int_0^L q \\chi \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial u}{\\partial x}\\right) dx + \\int_0^L K \\frac{dq}{dx} \\frac{\\partial u_w}{\\partial x} dx = 0 $$\n\n**空间离散化**\n我们使用线性形函数 $N_i(x)$ 和节点值 $d_i(t)$、$p_i(t)$ 来近似连续场 $u$ 和 $u_w$：$u(x,t) \\approx \\sum_i N_i(x) d_i(t)$ 以及 $u_w(x,t) \\approx \\sum_i N_i(x) p_i(t)$。这将弱形式转换为一个常微分方程（ODE）组，可以写成矩阵形式：\n$$ \\mathbf{K}_{uu} \\mathbf{d} + \\mathbf{K}_{uw} \\mathbf{p} = \\mathbf{F}_{u,a} $$\n$$ \\mathbf{K}_{wu} \\dot{\\mathbf{d}} + \\mathbf{M}_{ww} \\dot{\\mathbf{p}} + \\mathbf{K}_{ww} \\mathbf{p} = \\mathbf{0} $$\n其中 $\\mathbf{d}$ 和 $\\mathbf{p}$ 是节点位移和压力的向量，矩阵由单元级贡献组装而成。对于长度为 $h_e$ 的一维线性单元：\n- 刚度矩阵：$\\mathbf{K}_{uu}^e = \\frac{E}{h_e} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$\n- 耦合矩阵：$\\mathbf{K}_{uw}^e = -\\frac{\\chi}{2} \\begin{bmatrix} -1  -1 \\\\ 1  1 \\end{bmatrix}$，$\\mathbf{K}_{wu}^e = \\frac{\\chi}{2} \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix}$\n- 储水（质量）矩阵：$\\mathbf{M}_{ww}^e = \\frac{M h_e}{6} \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$\n- 导水矩阵：$\\mathbf{K}_{ww}^e = \\frac{K}{h_e} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$\n- 气压力荷载向量：$\\mathbf{F}_{u,a}^e = (1-\\chi) u_a^\\star \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix}$\n\n**时间离散化**\n使用后向欧拉格式，我们将时间步 $n+1$ 处的时间导数近似为 $\\dot{\\mathbf{y}}^{n+1} \\approx (\\mathbf{y}^{n+1} - \\mathbf{y}^{n}) / \\Delta t$。将此应用于半离散系统并重新整理各项，以求解 $t^{n+1}$ 时的状态，得到一个线性整体系统 $\\mathbf{A} \\mathbf{X}^{n+1} = \\mathbf{b}^n$：\n$$\n\\begin{bmatrix}\n\\mathbf{K}_{uu}  \\mathbf{K}_{uw} \\\\\n\\frac{1}{\\Delta t} \\mathbf{K}_{wu}  \\frac{1}{\\Delta t} \\mathbf{M}_{ww} + \\mathbf{K}_{ww}\n\\end{bmatrix}\n\\begin{Bmatrix}\n\\mathbf{d}^{n+1} \\\\\n\\mathbf{p}^{n+1}\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\mathbf{F}_{u,a} \\\\\n\\frac{1}{\\Delta t} ( \\mathbf{K}_{wu} \\mathbf{d}^n + \\mathbf{M}_{ww} \\mathbf{p}^n )\n\\end{Bmatrix}\n$$\n系统矩阵 $\\mathbf{A}$ 是常数，因此可以进行一次 LU 分解，以便在每个时间步高效求解。\n\n**实现**\n该解决方案通过一个 Python 程序实现。函数 `run_simulation` 封装了单个测试用例的逻辑：\n1.  它根据提供的物理参数计算单元矩阵。\n2.  它组装全局矩阵和恒定的气压力荷载向量。\n3.  它构建与时间无关的全局系统矩阵 $\\mathbf{A}$。\n4.  它通过修改与约束自由度对应的 $\\mathbf{A}$ 的行和列来施加 Dirichlet 边界条件（$u_0=0, p_0=0$），将对角线元素设为 $1$，并将该行中的所有其他元素设为 $0$。\n5.  它对修改后的 $\\mathbf{A}$ 执行 LU 分解。\n6.  它根据初始条件将位移和压力向量初始化为零。\n7.  它遍历时间步，在每个步骤中计算右侧向量 $\\mathbf{b}^n$，对其施加边界条件，并使用预先计算的 LU 因子求解线性系统以获得 $n+1$ 时的状态。\n8.  在最后一个时间步之后，它提取尖端位移 $u(L,T)$ 和中点压力 $u_w(L/2,T)$ 并返回它们。\n\n主函数遍历四个测试用例，为每个用例调用模拟函数，并将收集到的结果格式化为所需的输出字符串。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import lu_factor, lu_solve\n\ndef run_simulation(L, E, chi, M, K, ua_star, Ne, dt, T):\n    \"\"\"\n    Solves the 1D coupled poromechanics problem for a single set of parameters.\n\n    The solver implements a monolithic finite element formulation for the linearized,\n    quasi-static equations of poromechanics in an unsaturated soil. It uses\n    1D linear elements, backward Euler time integration, and a blocked system\n    for the unknowns (displacements and pore-water pressures).\n\n    Args:\n        L (float): Domain length [m].\n        E (float): Young's modulus [Pa].\n        chi (float): Bishop's parameter [-].\n        M (float): Specific storage coefficient [1/Pa].\n        K (float): Hydraulic conductivity [m^2/(Pa*s)].\n        ua_star (float): Imposed air pressure [Pa].\n        Ne (int): Number of elements.\n        dt (float): Time step [s].\n        T (float): Total simulation time [s].\n\n    Returns:\n        tuple[float, float]: A tuple containing the tip displacement u(L,T) [m]\n                             and the midpoint pressure uw(L/2,T) [Pa].\n    \"\"\"\n    N_nodes = Ne + 1\n    N_dofs = 2 * N_nodes\n    h = L / Ne\n    # Use round to avoid floating point issues in T/dt\n    n_steps = int(round(T / dt))\n\n    # --- Element matrices (based on 1D linear shape functions) ---\n    k_uu_e = (E / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    k_uw_e = -(chi / 2.0) * np.array([[-1.0, -1.0], [1.0, 1.0]])\n    k_wu_e = (chi / 2.0) * np.array([[-1.0, 1.0], [-1.0, 1.0]])\n    m_ww_e = (M * h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    k_ww_e = (K / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    f_ua_e = (1.0 - chi) * ua_star * np.array([-1.0, 1.0])\n\n    # --- Global matrices and vectors ---\n    Kuu = np.zeros((N_nodes, N_nodes))\n    Kuw = np.zeros((N_nodes, N_nodes))\n    Kwu = np.zeros((N_nodes, N_nodes))\n    Mww = np.zeros((N_nodes, N_nodes))\n    Kww = np.zeros((N_nodes, N_nodes))\n    F_ua = np.zeros(N_nodes)\n\n    # --- Assembly loop ---\n    for e in range(Ne):\n        nodes = [e, e + 1]\n        ix = np.ix_(nodes, nodes)\n        Kuu[ix] += k_uu_e\n        Kuw[ix] += k_uw_e\n        Kwu[ix] += k_wu_e\n        Mww[ix] += m_ww_e\n        Kww[ix] += k_ww_e\n        F_ua[nodes] += f_ua_e\n\n    # --- Form the monolithic system matrix A (time-independent) ---\n    A = np.zeros((N_dofs, N_dofs))\n    A[0:N_nodes, 0:N_nodes] = Kuu\n    A[0:N_nodes, N_nodes:N_dofs] = Kuw\n    A[N_nodes:N_dofs, 0:N_nodes] = (1.0 / dt) * Kwu\n    A[N_nodes:N_dofs, N_nodes:N_dofs] = (1.0 / dt) * Mww + Kww\n\n    # --- Apply Dirichlet BCs u(0)=0 and uw(0)=0 ---\n    # The DOFs are ordered [d_0, ..., d_Ne, p_0, ..., p_Ne]\n    # u(0)=0 affects DOF 0. uw(0)=0 affects DOF N_nodes.\n    d_bc_idx = 0\n    p_bc_idx = N_nodes\n    \n    A[d_bc_idx, :] = 0.0\n    A[d_bc_idx, d_bc_idx] = 1.0\n    \n    A[p_bc_idx, :] = 0.0\n    A[p_bc_idx, p_bc_idx] = 1.0\n\n    # --- Pre-factorize the system matrix for efficiency ---\n    lu, piv = lu_factor(A)\n\n    # --- Initial conditions: u(x,0)=0, uw(x,0)=0 ---\n    d = np.zeros(N_nodes)\n    p = np.zeros(N_nodes)\n\n    # --- Time integration loop (Backward Euler) ---\n    for _ in range(n_steps):\n        # Assemble the RHS vector b\n        b = np.zeros(N_dofs)\n        \n        # RHS from mechanical equation (constant force)\n        b[0:N_nodes] = F_ua\n        \n        # RHS from flow equation (dependent on previous step)\n        rhs_p = (1.0 / dt) * (Mww @ p + Kwu @ d)\n        b[N_nodes:N_dofs] = rhs_p\n        \n        # Apply BCs to RHS (both are zero-valued)\n        b[d_bc_idx] = 0.0\n        b[p_bc_idx] = 0.0\n\n        # Solve the system A * U_n+1 = b_n\n        solution = lu_solve((lu, piv), b, check_finite=False)\n\n        # Update state vectors\n        d = solution[0:N_nodes]\n        p = solution[N_nodes:N_dofs]\n\n    # --- Extract results ---\n    # Tip displacement u(L,T) is at the last displacement node (index Ne)\n    u_L = d[Ne]\n    # Midpoint pressure uw(L/2,T) is at the node Ne/2\n    p_mid = p[Ne // 2]\n    \n    return u_L, p_mid\n\ndef solve():\n    # Define test cases as per the problem statement\n    test_cases = {\n        'A': {'L': 1.0, 'E': 5.0e7, 'chi': 0.6, 'M': 1.0e-9, 'K': 1.0e-11, 'ua_star': 2.0e4, 'Ne': 20, 'dt': 1.0e-1, 'T': 1.0e1},\n        'B': {'L': 1.0, 'E': 5.0e7, 'chi': 0.6, 'M': 1.0e-9, 'K': 1.0e-11, 'ua_star': 0.0,   'Ne': 20, 'dt': 1.0e-1, 'T': 5.0},\n        'C': {'L': 1.0, 'E': 5.0e7, 'chi': 0.6, 'M': 1.0e-9, 'K': 1.0e-13, 'ua_star': 2.0e4, 'Ne': 20, 'dt': 1.0e-1, 'T': 5.0},\n        'D': {'L': 1.0e-1, 'E': 5.0e7, 'chi': 0.6, 'M': 1.0e-9, 'K': 1.0e-11, 'ua_star': 2.0e4, 'Ne': 10, 'dt': 1.0e-1, 'T': 5.0},\n    }\n\n    results = []\n    # Run the simulation for each case in the specified order A, B, C, D\n    for case_id in sorted(test_cases.keys()):\n        params = test_cases[case_id]\n        u_L, p_mid = run_simulation(**params)\n        results.extend([u_L, p_mid])\n\n    # Print the final result in the exact specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3542350"}]}