{"hands_on_practices": [{"introduction": "在我们完全信任像有限元法（FEM）这样的数值方法之前，理解它与精确解析解之间的关系至关重要。本练习针对一个简单案例——杆在自重作用下的情况，提供了一个直接的比较。通过推导精确解和单单元有限元近似解，我们可以具体地量化“离散误差”，并深入了解有限元近似的本质[@problem_id:3498577]。", "problem": "考虑一根棱柱形均匀杆，其长度为 $L$，横截面积为 $A$，杨氏模量为 $E$，沿空间坐标 $x \\in [0,L]$ 放置。该杆受到一个沿轴向作用的、大小恒定的单位体积体力 $b$。假设为小应变和线性弹性。左端 $x=0$ 处是固定的 ($u(0)=0$)，右端 $x=L$ 处在轴向是无面力的（即 $x=L$ 处的轴向力为零）。\n\n仅从轴向平衡和适用于计算岩土力学中一维杆的线性本构关系出发，推导满足边界条件的解析位移场 $u(x)$。然后，使用有限元法（FEM; Finite Element Method），通过一个跨越整个域 $[0,L]$ 的双节点线性杆单元，构建具有一致体力荷载表示和给定自然边界条件的单单元有限元位移场 $u_h(x)$。\n\n使用由一维线弹性内能引出的能量范数，通过相对能量范数量化离散误差，该相对能量范数定义为误差场的能量范数与精确解的能量范数之比。以无单位的纯数形式给出该相对误差的精确值。无需四舍五入。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n- 一根棱柱形均匀杆，其长度为 $L$，横截面积为 $A$，杨氏模量为 $E$。\n- 该杆沿 $x$ 轴方向，占据域 $x \\in [0,L]$。\n- 一个大小恒定的单位体积体力 $b$ 沿轴向作用。\n- 假设：小应变和线性弹性。\n- 边界条件：\n    1.  $x=0$ 处的固定端：$u(0)=0$。\n    2.  $x=L$ 处的无面力端：轴向力为零。\n- 任务是：\n    1.  推导解析位移场 $u(x)$。\n    2.  使用单个双节点线性单元推导有限元位移场 $u_h(x)$。\n    3.  使用相对能量范数 $\\eta = \\frac{||u-u_h||_E}{||u||_E}$ 量化离散误差。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据充分：** 该问题是固体力学和计算方法中的一个标准练习。它基于杆的轴向平衡、线性弹性（胡克定律，Hooke's Law）和有限元法（FEM）的基本原理。所有概念在计算岩土力学和工程领域都已牢固建立。\n- **适定的：** 该问题是一个二阶常微分方程，带有一个本质（狄利克雷，Dirichlet）边界条件 $u(0)=0$ 和一个自然（诺伊曼，Neumann）边界条件（$x=L$ 处力为零）。这种组合确保了唯一、稳定解的存在。\n- **客观的：** 问题陈述精确、量化，没有主观或模糊的语言。所有参数（$L, A, E, b$）都已明确定义。\n\n### 步骤 3：结论与行动\n该问题具有充分的科学依据、是适定的、客观且完整的。因此，它被判定为**有效**。将提供完整的解答。\n\n### 解析解推导\n受体力作用的一维杆的轴向平衡控制方程由微分元上的力平衡推導得出。用轴向应力 $\\sigma_{xx}$ 和单位体积体力 $b$ 表示的平衡方程为：\n$$ \\frac{d\\sigma_{xx}}{dx} + b = 0 $$\n对于线性弹性，本构关系（胡克定律，Hooke's Law）为：\n$$ \\sigma_{xx} = E \\epsilon_{xx} $$\n其中 $E$ 是杨氏模量，$\\epsilon_{xx}$ 是轴向应变。小应变下的应变-位移关系为：\n$$ \\epsilon_{xx} = \\frac{du}{dx} $$\n其中 $u(x)$ 是轴向位移场。\n将应变-位移关系和本构关系代入平衡方程，得到位移场 $u(x)$ 的控制微分方程：\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + b = 0 $$\n由于对于均匀杆 $E$ 是常数，方程简化为：\n$$ E \\frac{d^2u}{dx^2} = -b $$\n对 $x$ 积分一次，得到：\n$$ E \\frac{du}{dx} = -bx + C_1 $$\n其中 $C_1$ 是一个积分常数。再次积分，得到：\n$$ E u(x) = -\\frac{bx^2}{2} + C_1x + C_2 $$\n其中 $C_2$ 是第二个积分常数。这些常数通过应用边界条件来确定。\n\n1.  **$x=0$ 处的固定端**：$u(0) = 0$。\n    $$ E u(0) = -\\frac{b(0)^2}{2} + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n2.  **$x=L$ 处的无面力端**：轴向力 $N(x) = A\\sigma_{xx}(x)$ 在 $x=L$ 处必须为零。\n    $$ N(x) = A\\sigma_{xx} = A E \\frac{du}{dx} $$\n    使用第一次积分的结果：\n    $$ N(x) = A(-bx + C_1) $$\n    应用边界条件 $N(L)=0$：\n    $$ N(L) = A(-bL + C_1) = 0 \\implies C_1 = bL $$\n将 $C_1$ 和 $C_2$ 的值代回 $u(x)$ 的表达式，我们得到精确的解析解：\n$$ E u(x) = -\\frac{bx^2}{2} + bLx $$\n$$ u(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) $$\n\n### 有限元解推导\n我们使用一个跨越域 $[0,L]$ 的双节点线性单元来模拟该杆。节点位于 $x_1=0$ 和 $x_2=L$。位移场 $u_h(x)$ 由节点位移 $d_1$ 和 $d_2$ 使用线性形函数 $N_1(x)$ 和 $N_2(x)$ 插值得到：\n$$ u_h(x) = N_1(x)d_1 + N_2(x)d_2 $$\n形函数为：\n$$ N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L} $$\n单元刚度矩阵 $\\mathbf{k}$ 和一致体力向量 $\\mathbf{f}_b$ 由以下公式给出：\n$$ \\mathbf{k} = \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n$$ \\mathbf{f}_b = \\int_{V} \\mathbf{N}^T b \\, dV = \\int_0^L A \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} b \\, dx = Ab \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx $$\n$$ \\mathbf{f}_b = Ab \\left[ \\begin{matrix} x - \\frac{x^2}{2L} \\\\ \\frac{x^2}{2L} \\end{matrix} \\right]_0^L = Ab \\begin{pmatrix} L - L/2 \\\\ L/2 \\end{pmatrix} = \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n有限元方程组为 $\\mathbf{k}\\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{f} = \\mathbf{f}_{ext} + \\mathbf{f}_b$。外部节点荷载向量为 $\\mathbf{f}_{ext} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix}$，其中 $R_1$ 是固定节点1处的反作用力，由于无面力边界条件，节点2处的力为零。\n方程组为：\n$$ \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix} + \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n应用本质边界条件 $u(0)=0 \\implies d_1=0$。我们可以使用方程组的第二个方程求解未知位移 $d_2$：\n$$ \\frac{AE}{L} (-d_1 + d_2) = 0 + \\frac{AbL}{2} $$\n$$ \\frac{AE}{L} (0 + d_2) = \\frac{AbL}{2} \\implies d_2 = \\frac{AbL}{2} \\frac{L}{AE} = \\frac{bL^2}{2E} $$\n因此，有限元位移场为：\n$$ u_h(x) = N_1(x)(0) + N_2(x)d_2 = \\frac{x}{L} \\left( \\frac{bL^2}{2E} \\right) = \\frac{bL}{2E}x $$\n\n### 误差量化\n离散误差场为 $e(x) = u(x) - u_h(x)$：\n$$ e(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) - \\frac{bL}{2E}x = \\frac{b}{E} \\left( \\frac{Lx}{2} - \\frac{x^2}{2} \\right) = \\frac{b}{2E}(Lx - x^2) $$\n位移场 $v(x)$ 的能量范数定义为 $||v||_E = \\sqrt{\\int_0^L AE \\left(\\frac{dv}{dx}\\right)^2 dx}$。我们需要计算相对误差 $\\eta = \\frac{||e||_E}{||u||_E}$。我们首先计算范数的平方。\n\n精确解 $u(x)$ 的能量范数：\n$$ \\frac{du}{dx} = \\frac{b}{E}(L-x) $$\n$$ ||u||_E^2 = \\int_0^L AE \\left( \\frac{b}{E}(L-x) \\right)^2 dx = \\frac{Ab^2}{E} \\int_0^L (L-x)^2 dx $$\n$$ ||u||_E^2 = \\frac{Ab^2}{E} \\left[ -\\frac{(L-x)^3}{3} \\right]_0^L = \\frac{Ab^2}{E} \\left( 0 - \\left(-\\frac{L^3}{3}\\right) \\right) = \\frac{Ab^2L^3}{3E} $$\n\n误差场 $e(x)$ 的能量范数：\n$$ \\frac{de}{dx} = \\frac{b}{2E}(L-2x) $$\n$$ ||e||_E^2 = \\int_0^L AE \\left( \\frac{b}{2E}(L-2x) \\right)^2 dx = \\frac{Ab^2}{4E} \\int_0^L (L-2x)^2 dx $$\n$$ ||e||_E^2 = \\frac{Ab^2}{4E} \\left[ -\\frac{(L-2x)^3}{6} \\right]_0^L = \\frac{Ab^2}{4E} \\left( -\\frac{(-L)^3}{6} - \\left(-\\frac{L^3}{6}\\right) \\right) = \\frac{Ab^2}{4E} \\left( \\frac{L^3}{6} + \\frac{L^3}{6} \\right) = \\frac{Ab^2}{4E} \\frac{L^3}{3} = \\frac{Ab^2L^3}{12E} $$\n\n能量范数下的相对误差是两个范数的比值：\n$$ \\eta = \\frac{||e||_E}{||u||_E} = \\sqrt{\\frac{||e||_E^2}{||u||_E^2}} = \\sqrt{\\frac{Ab^2L^3/(12E)}{Ab^2L^3/(3E)}} = \\sqrt{\\frac{1/12}{1/3}} = \\sqrt{\\frac{3}{12}} = \\sqrt{\\frac{1}{4}} $$\n$$ \\eta = \\frac{1}{2} $$\n相对误差的精确值为 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3498577"}, {"introduction": "现实世界的问题通常涉及复杂的几何形状或非恒定的材料属性。本练习探讨了处理这种复杂性的两种关键技术：用于更好地捕捉解的变化的高阶（二次）单元，以及在横截面积等属性变化时精确计算单元刚度矩阵的数值积分。我们将量化积分规则的选择如何影响刚度矩阵本身的准确性[@problem_id:3498547]。", "problem": "考虑一个用于小应变线性弹性的有限元方法（FEM）中的三节点等参二次一维杆单元。杆的长度为 $L$，节点坐标为 $x_{1}=0$、$x_{2}=L/2$ 和 $x_{3}=L$。横截面积沿杆长线性变化，为 $A(x)=A_{1}+\\left(\\frac{A_{2}-A_{1}}{L}\\right)x$，杨氏模量为常数 $E$。局部等参坐标为 $\\xi \\in [-1,1]$，标准的二次 Lagrange 形函数为 $N_{1}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi-1)$、$N_{2}(\\xi)=1-\\xi^{2}$、$N_{3}(\\xi)=\\frac{1}{2}\\,\\xi\\,(\\xi+1)$，几何映射为 $x(\\xi)=\\sum_{i=1}^{3}N_{i}(\\xi)\\,x_{i}$。\n\n从基本原理和核心定义出发，使用小应变线性弹性本构关系 $\\sigma=E\\,\\varepsilon$、运动学关系 $\\varepsilon=\\frac{du}{dx}$ 以及虚功原理，推导单元刚度项，表示为沿杆的积分。然后，执行精确积分和近似积分，以比较单点和两点 Gauss 求积。\n\n给定参数为 $L=3\\ \\mathrm{m}$，$E=50\\times 10^{9}\\ \\mathrm{Pa}$，$A_{1}=0.01\\ \\mathrm{m}^{2}$，$A_{2}=0.025\\ \\mathrm{m}^{2}$。\n\n任务：\n1. 从虚功原理出发，推导单元刚度矩阵项 $K_{ij}$ 的表达式，该表达式用物理坐标 $x$ 上的积分表示，然后使用等参映射将其转换为局部坐标 $\\xi$。您的推导必须从弱形式和上述定义开始，不得引用预先推导好的单元矩阵。\n2. 通过对给定 $A(x)$ 和二次形函数的积分进行解析计算，求出精确的单元刚度矩阵。将最终的数值矩阵项以 $\\mathrm{N}/\\mathrm{m}$ 为单位表示。\n3. 使用 $[-1,1]$ 上的标准规则，计算单元刚度矩阵的单点 Gauss 求积近似和两点 Gauss 求积近似：对于单点，节点为 $\\xi_{1}=0$，权重为 $w_{1}=2$；对于两点，节点为 $\\xi_{1,2}=\\pm 1/\\sqrt{3}$，权重为 $w_{1,2}=1$。将得到的数值矩阵以 $\\mathrm{N}/\\mathrm{m}$ 为单位表示。\n4. 将 $n$ 点规则的相对求积误差定义为 $\\varepsilon_{n}=\\frac{\\|K^{(n)}-K\\|_{F}}{\\|K\\|_{F}}$，其中 $\\|\\,\\cdot\\,\\|_{F}$ 是 Frobenius 范数，$K$ 是精确刚度，$K^{(n)}$ 是 $n$ 点 Gauss 近似。计算 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$。\n\n将最终误差值 $\\varepsilon_{1}$ 和 $\\varepsilon_{2}$ 四舍五入到六位有效数字，并以小数形式表示。最终答案必须使用 LaTeX 的 pmatrix 环境报告为一个双分量行矩阵，矩阵内不含单位。", "solution": "该问题要求推导和计算具有可变横截面的三节点二次杆单元的刚度矩阵，然后比较数值积分方案。\n\n**任务1：单元刚度矩阵的推导**\n\n推导从虚功原理开始。对于承受轴向载荷的一维物体，内虚功 $\\delta W_{\\text{int}}$ 由虚应变能密度在体积 $V$ 上的积分给出。\n$$ \\delta W_{\\text{int}} = \\int_{V} \\delta\\varepsilon^{T} \\sigma \\, dV $$\n在此，$\\sigma$ 是轴向应力，$\\delta\\varepsilon$ 是虚轴向应变。对于杆单元，体积积分可以表示为沿长度 $L$ 的积分：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon \\sigma A(x) \\, dx $$\n其中 $A(x)$ 是位置 $x$ 处的横截面积。\n\n线性弹性的本构关系为 $\\sigma = E \\varepsilon$，其中 $E$ 是杨氏模量。将其代入虚功表达式，得到：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\varepsilon E \\varepsilon A(x) \\, dx $$\n\n在有限元框架内，位移场 $u(x)$ 使用形函数 $N_i(x)$ 和节点位移 $d_i$ 进行近似：\n$$ u(x) = \\sum_{j=1}^{3} N_j(x) d_j = \\mathbf{N}(x) \\mathbf{d} $$\n轴向应变 $\\varepsilon$ 是位移的空间导数：\n$$ \\varepsilon = \\frac{du}{dx} = \\sum_{j=1}^{3} \\frac{dN_j}{dx} d_j = \\mathbf{B}(x) \\mathbf{d} $$\n其中 $\\mathbf{B}(x) = \\left[ \\begin{matrix} \\frac{dN_1}{dx}  \\frac{dN_2}{dx}  \\frac{dN_3}{dx} \\end{matrix} \\right]$ 是应变-位移矩阵。\n类似地，虚位移和虚应变由以下公式给出：\n$$ \\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{d} \\quad \\text{and} \\quad \\delta\\varepsilon = \\mathbf{B}(x) \\delta\\mathbf{d} $$\n将 $\\varepsilon$ 和 $\\delta\\varepsilon$ 的离散形式代入内虚功方程：\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} (\\delta\\mathbf{d}^{T} \\mathbf{B}(x)^{T}) E (\\mathbf{B}(x) \\mathbf{d}) A(x) \\, dx $$\n$$ \\delta W_{\\text{int}} = \\delta\\mathbf{d}^{T} \\left( \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx \\right) \\mathbf{d} $$\n根据定义，$\\delta W_{\\text{int}} = \\delta\\mathbf{d}^T \\mathbf{K} \\mathbf{d}$，其中 $\\mathbf{K}$ 是单元刚度矩阵。因此：\n$$ \\mathbf{K} = \\int_{0}^{L} E A(x) \\mathbf{B}(x)^{T} \\mathbf{B}(x) \\, dx $$\n刚度矩阵的项为 $K_{ij} = \\int_{0}^{L} E A(x) \\frac{dN_i}{dx} \\frac{dN_j}{dx} \\, dx$。\n\n对于等参单元，物理坐标 $x$ 是通过使用与位移场相同的形函数从局部坐标 $\\xi \\in [-1,1]$ 映射而来的：\n$$ x(\\xi) = \\sum_{k=1}^{3} N_k(\\xi) x_k $$\n形函数关于 $x$ 的导数使用链式法则求得：$\\frac{dN_i}{dx} = \\frac{dN_i}{d\\xi} \\frac{d\\xi}{dx}$。项 $\\frac{dx}{d\\xi}$ 是变换的雅可比行列式，$J$。\n$$ J = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\sum_{k=1}^{3} N_k(\\xi) x_k \\right) = \\sum_{k=1}^{3} \\frac{dN_k}{d\\xi} x_k $$\n微分长度元为 $dx = J d\\xi$。刚度矩阵积分被转换到局部坐标系：\n$$ K_{ij} = \\int_{-1}^{1} E A(x(\\xi)) \\left( \\frac{1}{J} \\frac{dN_i}{d\\xi} \\right) \\left( \\frac{1}{J} \\frac{dN_j}{d\\xi} \\right) J \\, d\\xi = \\int_{-1}^{1} \\frac{E A(x(\\xi))}{J} \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} \\, d\\xi $$\n这就完成了任务1中要求的推导。\n\n**任务2：精确单元刚度矩阵**\n\n首先，我们确定此问题的具体函数。给定的二次形函数为：\n$N_{1}(\\xi)=\\frac{1}{2}\\xi(\\xi-1)$，$N_{2}(\\xi)=1-\\xi^{2}$，$N_{3}(\\xi)=\\frac{1}{2}\\xi(\\xi+1)$。\n它们关于 $\\xi$ 的导数为：\n$$ \\frac{dN_1}{d\\xi} = \\xi - \\frac{1}{2}, \\quad \\frac{dN_2}{d\\xi} = -2\\xi, \\quad \\frac{dN_3}{d\\xi} = \\xi + \\frac{1}{2} $$\n节点坐标为 $x_1=0$、$x_2=L/2$ 和 $x_3=L$。雅可比行列式 $J$ 为：\n$$ J = \\left(\\xi - \\frac{1}{2}\\right) (0) + (-2\\xi)\\left(\\frac{L}{2}\\right) + \\left(\\xi + \\frac{1}{2}\\right)(L) = -L\\xi + L\\xi + \\frac{L}{2} = \\frac{L}{2} $$\n由于中点节点位于几何中心，雅可比行列式是常数。坐标映射为：\n$$ x(\\xi) = N_1(\\xi)(0) + N_2(\\xi)\\left(\\frac{L}{2}\\right) + N_3(\\xi)(L) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}(\\xi^2+\\xi)L = \\frac{L}{2}(1+\\xi) $$\n横截面积 $A(x) = A_1 + \\frac{A_2-A_1}{L}x$。代入 $x(\\xi)$：\n$$ A(x(\\xi)) = A_1 + \\frac{A_2-A_1}{L} \\frac{L}{2}(1+\\xi) = A_1 + \\frac{A_2-A_1}{2} + \\frac{A_2-A_1}{2}\\xi = \\frac{A_1+A_2}{2} + \\frac{A_2-A_1}{2}\\xi $$\n令 $A_c = \\frac{A_1+A_2}{2}$ 且 $\\Delta A = \\frac{A_2-A_1}{2}$。则 $A(x(\\xi)) = A_c + \\Delta A \\xi$。\n刚度矩阵项为：\n$$ K_{ij} = \\int_{-1}^{1} \\frac{E (A_c + \\Delta A \\xi)}{L/2} \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi = \\frac{2E}{L} \\int_{-1}^{1} (A_c + \\Delta A \\xi) \\left(\\frac{dN_i}{d\\xi}\\right) \\left(\\frac{dN_j}{d\\xi}\\right) d\\xi $$\n项 $(\\frac{dN_i}{d\\xi})(\\frac{dN_j}{d\\xi})$ 是一个关于 $\\xi$ 的最高为2次的多项式。完整的被积函数是一个最高为3次的多项式。我们可以精确地积分它。令 $\\mathbf{B}_\\xi = [\\begin{matrix} \\xi-\\frac{1}{2}  -2\\xi  \\xi+\\frac{1}{2} \\end{matrix}]$。我们必须计算 $\\mathbf{K} = \\frac{2E}{L} \\int_{-1}^1 (A_c + \\Delta A \\xi) \\mathbf{B}_\\xi^T \\mathbf{B}_\\xi d\\xi$。\n这个精确积分的结果得出以下矩阵：\n$$ \\mathbf{K} = \\frac{E}{3L} \\begin{pmatrix} 7A_c - 4\\Delta A  -8A_c + 4\\Delta A  A_c \\\\ -8A_c + 4\\Delta A  16A_c  -8A_c - 4\\Delta A \\\\ A_c  -8A_c - 4\\Delta A  7A_c + 4\\Delta A \\end{pmatrix} $$\n使用给定参数：$L=3\\,\\mathrm{m}$，$E=50 \\times 10^9\\,\\mathrm{Pa}$，$A_1=0.01\\,\\mathrm{m}^2$，$A_2=0.025\\,\\mathrm{m}^2$。\n$A_c = \\frac{0.01+0.025}{2} = 0.0175\\,\\mathrm{m}^2 = \\frac{7}{400}\\,\\mathrm{m}^2$。\n$\\Delta A = \\frac{0.025-0.01}{2} = 0.0075\\,\\mathrm{m}^2 = \\frac{3}{400}\\,\\mathrm{m}^2$。\n将这些值代入矩阵公式：\n$\\frac{E}{3L} = \\frac{50 \\times 10^9}{9}$。\n$7A_c-4\\Delta A = 7(\\frac{7}{400}) - 4(\\frac{3}{400}) = \\frac{37}{400}$。\n$-8A_c+4\\Delta A = -8(\\frac{7}{400}) + 4(\\frac{3}{400}) = -\\frac{44}{400}$。\n$A_c = \\frac{7}{400}$。\n$16A_c = 16(\\frac{7}{400}) = \\frac{112}{400}$。\n$-8A_c-4\\Delta A = -8(\\frac{7}{400})-4(\\frac{3}{400}) = -\\frac{68}{400}$。\n$7A_c+4\\Delta A = 7(\\frac{7}{400})+4(\\frac{3}{400}) = \\frac{61}{400}$。\n$$ \\mathbf{K} = \\frac{50 \\times 10^9}{9} \\frac{1}{400} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} = \\frac{1.25 \\times 10^8}{9} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix} $$\n这可以写成 $\\mathbf{K} = \\frac{10^9}{72} \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$。\n\n**任务3：近似单元刚度矩阵**\n\n$n$ 点 Gauss 求积的通用公式为 $\\mathbf{K}^{(n)} = \\sum_{k=1}^{n} w_k \\left[ \\frac{E A(x(\\xi))}{J} \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=\\xi_k}$。\n\n**单点 Gauss 求积 ($n=1$)**：\n规则：$\\xi_1 = 0$，权重 $w_1=2$。\n$$ \\mathbf{K}^{(1)} = w_1 \\left[ \\frac{2E}{L} (A_c+\\Delta A\\xi) \\mathbf{B}_\\xi(\\xi)^T \\mathbf{B}_\\xi(\\xi) \\right]_{\\xi=0} $$\n在 $\\xi=0$ 处，我们有 $A(x(0)) = A_c$ 和 $\\mathbf{B}_\\xi(0) = [\\begin{matrix} -1/2  0  1/2 \\end{matrix}]$。\n$$ \\mathbf{K}^{(1)} = 2 \\cdot \\frac{2E A_c}{L} \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix} \\begin{pmatrix} -1/2  0  1/2 \\end{pmatrix} = \\frac{E A_c}{L} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\n代入数值：\n$\\frac{EA_c}{L} = \\frac{(50 \\times 10^9)(0.0175)}{3} = \\frac{7}{24} \\times 10^9$。\n$$ \\mathbf{K}^{(1)} = \\frac{7 \\times 10^9}{24} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} = \\frac{21 \\times 10^9}{72} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} $$\n\n**两点 Gauss 求积 ($n=2$)**：\n规则：$\\xi_{1,2} = \\pm 1/\\sqrt{3}$，权重 $w_{1,2}=1$。\n$K_{ij}$ 的被积函数是 $\\xi$ 的3次多项式。两点 Gauss 求积对于最高为 $2n-1 = 2(2)-1=3$ 次的多项式是精确的。因此，两点求积规则将精确地计算该积分。\n$$ \\mathbf{K}^{(2)} = \\mathbf{K} $$\n\n**任务4：相对求积误差**\n\n相对误差定义为 $\\varepsilon_{n}=\\frac{\\|\\mathbf{K}^{(n)}-\\mathbf{K}\\|_{F}}{\\|\\mathbf{K}\\|_{F}}$，其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数，$\\|\\mathbf{A}\\|_F = \\sqrt{\\sum_{i,j} |a_{ij}|^2}$。\n\n对于两点规则，由于 $\\mathbf{K}^{(2)} = \\mathbf{K}$，分子 $\\|\\mathbf{K}^{(2)}-\\mathbf{K}\\|_F = 0$。因此，\n$$ \\varepsilon_2 = 0 $$\n对于单点规则，我们计算误差 $\\varepsilon_1$。我们可以提出公因子 $C = \\frac{10^9}{72}$。\n令 $\\mathbf{M}_K = \\begin{pmatrix} 37  -44  7 \\\\ -44  112  -68 \\\\ 7  -68  61 \\end{pmatrix}$ 且 $\\mathbf{M}_{K1} = \\begin{pmatrix} 21  0  -21 \\\\ 0  0  0 \\\\ -21  0  21 \\end{pmatrix}$。\n则 $\\mathbf{K} = C \\mathbf{M}_K$ 且 $\\mathbf{K}^{(1)} = C \\mathbf{M}_{K1}$。\n误差为 $\\varepsilon_1 = \\frac{\\|C(\\mathbf{M}_{K1}-\\mathbf{M}_K)\\|_F}{\\|C\\mathbf{M}_K\\|_F} = \\frac{\\|\\mathbf{M}_{K1}-\\mathbf{M}_K\\|_F}{\\|\\mathbf{M}_K\\|_F}$。\n令 $\\Delta\\mathbf{M} = \\mathbf{M}_{K1}-\\mathbf{M}_K$：\n$$ \\Delta\\mathbf{M} = \\begin{pmatrix} 21-37  0-(-44)  -21-7 \\\\ 0-(-44)  0-112  0-(-68) \\\\ -21-7  0-(-68)  21-61 \\end{pmatrix} = \\begin{pmatrix} -16  44  -28 \\\\ 44  -112  68 \\\\ -28  68  -40 \\end{pmatrix} $$\n现在我们计算 Frobenius 范数的平方：\n$$ \\|\\mathbf{M}_K\\|_F^2 = 37^2 + (-44)^2 + 7^2 + (-44)^2 + 112^2 + (-68)^2 + 7^2 + (-68)^2 + 61^2 $$\n$$ \\|\\mathbf{M}_K\\|_F^2 = 1369 + 1936 + 49 + 1936 + 12544 + 4624 + 49 + 4624 + 3721 = 30852 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = (-16)^2 + 44^2 + (-28)^2 + 44^2 + (-112)^2 + 68^2 + (-28)^2 + 68^2 + (-40)^2 $$\n$$ \\|\\Delta\\mathbf{M}\\|_F^2 = 256 + 1936 + 784 + 1936 + 12544 + 4624 + 784 + 4624 + 1600 = 29088 $$\n相对误差 $\\varepsilon_1$ 为：\n$$ \\varepsilon_1 = \\sqrt{\\frac{\\|\\Delta\\mathbf{M}\\|_F^2}{\\|\\mathbf{M}_K\\|_F^2}} = \\sqrt{\\frac{29088}{30852}} \\approx \\sqrt{0.942823739} \\approx 0.970991136 $$\n四舍五入到六位有效数字，$\\varepsilon_1 = 0.970991$。\n最终误差值为 $\\varepsilon_1 = 0.970991$ 和 $\\varepsilon_2 = 0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.970991  0\n\\end{pmatrix}\n}\n$$", "id": "3498547"}, {"introduction": "我们最初的分析大多依赖于“小应变”假设，这一假设简化了数学处理，但在岩土力学等可能发生大变形的领域中并不总是有效。本练习超越了这一简化，进入了有限变形理论的范畴。通过为一个给定的非线性位移场计算精确的格林-拉格朗日应变（Green-Lagrange strain），我们为理解和最终模拟几何非线性问题建立了必要的概念工具[@problem_id:3498532]。", "problem": "考虑一根细长的一维杆，其参考构型由物质坐标 $X \\in [0,L]$ 参数化。设其运动由位形函数 $x(X) = X + u(X)$ 描述，其中位移场给定为 $u(X) = \\alpha X + \\beta X^{2}$，$\\alpha$ 和 $\\beta$ 为常数。从适用于一维连续介质的有限变形运动学的拉格朗日描述出发，并使用变形梯度和格林-拉格朗日应变的基本定义（不引入任何小应变近似），推导杆上局部轴向伸长率 $\\lambda(X)$ 和格林-拉格朗日应变 $E(X)$ 关于 $X$、$\\alpha$ 和 $\\beta$ 的精确表达式。以精确的符号形式给出你的最终表达式。不需要进行数值舍入。将最终答案表示为关于 $X$、$\\alpha$ 和 $\\beta$ 的闭式表达式。", "solution": "该问题陈述经评估是有效的。它在科学上基于连续介质力学的原理，问题提法恰当，为得到唯一解提供了充分信息，并且语言客观。该问题要求使用有限变形理论，从给定的位移场推导运动学量，这是连续介质研究中的一个标准步骤。\n\n该问题考虑一个一维杆，其物质点由参考构型中的坐标 $X$ 标识，其中 $X \\in [0, L]$。杆的运动由位形函数 $x(X, t)$ 描述，它将物质点 $X$ 映射到其在当前构型中的位置 $x$。由于问题是准静态的，我们只考虑对 $X$ 的依赖性。位形由 $x(X) = X + u(X)$ 给出，其中 $u(X)$ 是位移场。\n\n给定的位移场是物质坐标 $X$ 的二次函数：\n$$u(X) = \\alpha X + \\beta X^{2}$$\n其中 $\\alpha$ 和 $\\beta$ 是常数。\n\n第一步是计算变形梯度，记为 $F$。对于一维物体，变形梯度是一个标量场，定义为位形函数 $x(X)$ 对物质坐标 $X$ 的导数：\n$$F(X) = \\frac{dx}{dX}$$\n代入 $x(X)$ 的表达式：\n$$F(X) = \\frac{d}{dX}(X + u(X)) = 1 + \\frac{du}{dX}$$\n现在，我们计算给定 位移场 $u(X)$ 的导数：\n$$\\frac{du}{dX} = \\frac{d}{dX}(\\alpha X + \\beta X^{2}) = \\alpha + 2\\beta X$$\n将此结果代回变形梯度的表达式，得到：\n$$F(X) = 1 + \\alpha + 2\\beta X$$\n\n轴向伸长率 $\\lambda(X)$ 是局部长度变化的度量。在一维情况下，伸长率与变形梯度相同：\n$$\\lambda(X) = F(X)$$\n因此，杆上轴向伸长率的精确表达式为：\n$$\\lambda(X) = 1 + \\alpha + 2\\beta X$$\n\n接下来，我们推导格林-拉格朗日应变 $E(X)$。这种应变度量适用于有限变形，并根据变形梯度定义。在一维中，格林-拉格朗日应变是一个标量场，由下式给出：\n$$E(X) = \\frac{1}{2}(F(X)^{2} - 1)$$\n这个定义是精确的，不涉及任何小应变近似。\n\n我们现在将先前推导的 $F(X)$ 表达式代入此定义：\n$$E(X) = \\frac{1}{2}((1 + \\alpha + 2\\beta X)^{2} - 1)$$\n为了得到最终表达式，我们展开平方项。我们将各项分组为 $((1+\\alpha) + 2\\beta X)$：\n$$(1 + \\alpha + 2\\beta X)^{2} = (1+\\alpha)^{2} + 2(1+\\alpha)(2\\beta X) + (2\\beta X)^{2}$$\n$$(1 + \\alpha + 2\\beta X)^{2} = (1 + 2\\alpha + \\alpha^{2}) + (4\\beta + 4\\alpha\\beta)X + 4\\beta^{2}X^{2}$$\n现在，将此展开形式代回 $E(X)$ 的方程：\n$$E(X) = \\frac{1}{2}((1 + 2\\alpha + \\alpha^{2} + 4\\beta X + 4\\alpha\\beta X + 4\\beta^{2}X^{2}) - 1)$$\n括号内的常数 $1$ 被消去：\n$$E(X) = \\frac{1}{2}(2\\alpha + \\alpha^{2} + 4\\beta X + 4\\alpha\\beta X + 4\\beta^{2}X^{2})$$\n分配因子 $\\frac{1}{2}$ 得到格林-拉格朗日应变的最终表达式：\n$$E(X) = \\alpha + \\frac{1}{2}\\alpha^{2} + 2\\beta X + 2\\alpha\\beta X + 2\\beta^{2}X^{2}$$\n为了清晰起见，可以根据 $X$ 的幂次重新整理此表达式：\n$$E(X) = \\left(\\alpha + \\frac{1}{2}\\alpha^{2}\\right) + (2\\beta + 2\\alpha\\beta)X + 2\\beta^{2}X^{2}$$\n对 $X$ 项的系数进行因式分解，得到一个更紧凑的形式：\n$$E(X) = \\alpha\\left(1 + \\frac{1}{2}\\alpha\\right) + 2\\beta(1+\\alpha)X + 2\\beta^{2}X^{2}$$\n所有这些形式都是等价的。所要求的最终答案将呈现两个推导出的量，$\\lambda(X)$ 和 $E(X)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 + \\alpha + 2\\beta X  \\alpha + \\frac{1}{2}\\alpha^{2} + 2\\beta(1+\\alpha)X + 2\\beta^{2}X^{2} \\end{pmatrix}}$$", "id": "3498532"}]}