{"hands_on_practices": [{"introduction": "在有限元分析中，一个核心任务是将离散的节点位移与连续的应变场联系起来。本练习将通过一个二次机缘（$S_2$）单元，带您逐步完成这一基本过程。您将从形函数的定义出发，推导其在参考单元上的梯度，并学习如何构建应变-位移矩阵（$B$ 矩阵），最终在等参映射下计算特定位移场产生的应变 [@problem_id:3558296]。掌握这一流程是理解和应用等参有限元法进行岩土力学分析的基石。", "problem": "考虑参考方形单元 $\\hat{\\Omega} = \\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ 上的二次机缘族 $S_2$。$S_2$ 单元有8个节点：4个角节点和4个边中节点。设节点编号和参考坐标为\n$1:(-1,-1)$、$2:(1,-1)$、$3:(1,1)$、$4:(-1,1)$、$5:(0,-1)$、$6:(1,0)$、$7:(0,1)$、$8:(-1,0)$。\n在有限元法 (FEM) 中，$S_2$ 单元的形函数 $N_i(\\xi,\\eta)$ 是二次多项式，在这些节点上满足克罗内克-德尔塔性质和单位分解性质。\n\n任务：\n- 从等参插值和参考形函数性质的核心定义出发，推导参考单元上所有 $i \\in \\{1,\\dots,8\\}$ 的梯度 $\\nabla_{\\hat{\\Omega}} N_i(\\xi,\\eta) = \\left[\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\right]$ 的显式公式。\n- 使用等参概念，展示在映射 $\\boldsymbol{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\boldsymbol{x}_i$ 下，如何计算用于二维小应变运动学（平面应变）的应变-位移矩阵 $B$，其中 $\\boldsymbol{x}_i = (x_i,y_i)$ 是单元节点的物理坐标。基于链式法则和雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$ 进行推导。\n- 然后，考虑等参映射到物理四边形，其节点坐标（单位：米）如下：\n$1:(-2,-1)$、$2:(2,-1)$、$3:(2,1)$、$4:(-2,1)$、$5:(0,-1)$、$6:(2,0)$、$7:(0,1)$、$8:(-2,0)$。展示在单元中心 $(\\xi,\\eta)=(0,0)$ 处 $\\boldsymbol{J}$ 和 $\\boldsymbol{J}^{-1}$ 的计算过程。\n- 对于平面应变中的地质力学分析，应变-位移矩阵 $B(\\xi,\\eta)$ 的定义使得工程应变 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{x},\\,\\varepsilon_{y},\\,\\gamma_{xy}]^{\\mathsf{T}}$ 满足 $\\boldsymbol{\\varepsilon} = B\\,\\boldsymbol{u}$，其中 $\\boldsymbol{u}$ 叠加了 $i=1,\\dots,8$ 的节点位移分量 $u_{i,x}$ 和 $u_{i,y}$。使用你在 $(\\xi,\\eta)=(0,0)$ 处的 $B$ 矩阵，对给定的节点位移场（单位：米）计算单元中心的剪应变 $\\gamma_{xy}$：\n$u_{1,x}=0$, $u_{1,y}=0$, $u_{2,x}=0$, $u_{2,y}=0$, $u_{3,x}=0$, $u_{3,y}=0$, $u_{4,x}=0$, $u_{4,y}=0$, $u_{5,x}=1\\times 10^{-3}$, $u_{5,y}=0$, $u_{6,x}=0$, $u_{6,y}=3\\times 10^{-3}$, $u_{7,x}=2\\times 10^{-3}$, $u_{7,y}=0$, $u_{8,x}=0$, $u_{8,y}=-1\\times 10^{-3}$。\n\n将 $\\gamma_{xy}$ 的最终数值答案四舍五入到4位有效数字。应变是无量纲的；将答案表示为一个纯数（无单位）。", "solution": "该问题要求在二维平面应变地质力学问题的有限元法 (FEM) 背景下，对一个8节点二次机缘单元 ($S_2$) 进行多步分析。任务包括：1) 推导参考单元上形函数的梯度，2) 建立应变-位移矩阵 $B$ 的公式，3) 计算特定物理单元的雅可比矩阵 $\\boldsymbol{J}$，以及 4) 根据给定的位移场计算单元中心的剪应变 $\\gamma_{xy}$。\n\n**第1部分：$S_2$ 形函数的梯度**\n\n$S_2$ 单元在参考正方形 $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$ 上有8个节点。其中有4个角节点和4个边中节点。形函数 $N_i(\\xi, \\eta)$ 的定义使其在节点 $i$ 处为1，在所有其他节点处为0。\n\n角节点为 $i \\in \\{1, 2, 3, 4\\}$。其形函数由通用公式给出：\n$$N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(\\xi_i\\xi + \\eta_i\\eta - 1)$$\n其中 $(\\xi_i, \\eta_i)$ 是角节点 $i$ 的坐标。关于 $\\xi$ 和 $\\eta$ 的偏导数是：\n$$\\frac{\\partial N_i}{\\partial \\xi} = \\frac{1}{4}\\xi_i(1+\\eta_i\\eta)(2\\xi_i\\xi+\\eta_i\\eta) = \\frac{1}{4}(1+\\eta_i\\eta)(2\\xi+\\xi_i\\eta_i\\eta)$$\n$$\\frac{\\partial N_i}{\\partial \\eta} = \\frac{1}{4}\\eta_i(1+\\xi_i\\xi)(2\\eta_i\\eta+\\xi_i\\xi) = \\frac{1}{4}(1+\\xi_i\\xi)(2\\eta+\\eta_i\\xi_i\\xi)$$\n\n边中节点为 $i \\in \\{5, 6, 7, 8\\}$。其形函数由以下公式给出：\n对于边 $\\xi_i=0$ 上的节点（节点5, 7）：$N_i(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta_i\\eta)$\n对于边 $\\eta_i=0$ 上的节点（节点6, 8）：$N_i(\\xi, \\eta) = \\frac{1}{2}(1+\\xi_i\\xi)(1-\\eta^2)$\n\n边中节点的偏导数是：\n对于 $i=5$，坐标为 $(\\xi_5, \\eta_5) = (0, -1)$：$N_5 = \\frac{1}{2}(1-\\xi^2)(1-\\eta)$\n$$\\frac{\\partial N_5}{\\partial \\xi} = -\\xi(1-\\eta), \\quad \\frac{\\partial N_5}{\\partial \\eta} = -\\frac{1}{2}(1-\\xi^2)$$\n对于 $i=6$，坐标为 $(\\xi_6, \\eta_6) = (1, 0)$：$N_6 = \\frac{1}{2}(1+\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_6}{\\partial \\xi} = \\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_6}{\\partial \\eta} = -(1+\\xi)\\eta$$\n对于 $i=7$，坐标为 $(\\xi_7, \\eta_7) = (0, 1)$：$N_7 = \\frac{1}{2}(1-\\xi^2)(1+\\eta)$\n$$\\frac{\\partial N_7}{\\partial \\xi} = -\\xi(1+\\eta), \\quad \\frac{\\partial N_7}{\\partial \\eta} = \\frac{1}{2}(1-\\xi^2)$$\n对于 $i=8$，坐标为 $(\\xi_8, \\eta_8) = (-1, 0)$：$N_8 = \\frac{1}{2}(1-\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_8}{\\partial \\xi} = -\\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_8}{\\partial \\eta} = -(1-\\xi)\\eta$$\n\n**第2部分：应变-位移矩阵 $B$**\n\n在等参格式中，几何形状和位移场都使用相同的形函数进行插值。物理坐标 $(x,y)$ 和位移分量 $(u,v)$ 由下式给出：\n$$x(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) y_i$$\n$$u(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,x}, \\quad v(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,y}$$\n对于小应变运动学，工程应变为 $\\varepsilon_x = \\frac{\\partial u}{\\partial x}$，$\\varepsilon_y = \\frac{\\partial v}{\\partial y}$ 和 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。写成矩阵形式为：\n$$\\boldsymbol{\\varepsilon} = \\begin{Bmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial}{\\partial y} \\\\ \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial x} \\end{bmatrix} \\begin{Bmatrix} u \\\\ v \\end{Bmatrix} = \\boldsymbol{L} \\boldsymbol{d}$$\n关于物理坐标 $(x, y)$ 的导数通过链式法则与关于参考坐标 $(\\xi, \\eta)$ 的导数相关联，其中涉及到雅可比矩阵 $\\boldsymbol{J}$：\n$$\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix}$$\n其中标准雅可比矩阵定义为 $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}$。反转该关系可得：\n$$\\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = (\\boldsymbol{J}^{\\mathsf{T}})^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = (\\boldsymbol{J}^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix}$$\n使用位移插值，应变可以与节点位移 $\\boldsymbol{u}$ 联系起来。该关系为 $\\boldsymbol{\\varepsilon} = \\boldsymbol{B} \\boldsymbol{u}$，其中 $\\boldsymbol{B}$ 是一个 $3 \\times 16$ 的应变-位移矩阵，它是由 $3 \\times 2$ 的矩阵 $\\boldsymbol{B}_i$ 串联而成：\n$$\\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\dots, \\boldsymbol{B}_8]$$\n每个 $\\boldsymbol{B}_i$ 矩阵由下式给出：\n$$\\boldsymbol{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}$$\n其中形函数的物理导数计算如下：\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}$$\n\n**第3部分：在 $(\\xi, \\eta) = (0,0)$ 处计算 $\\boldsymbol{J}$ 和 $\\boldsymbol{J}^{-1}$**\n\n首先，我们计算单元中心 $(\\xi, \\eta) = (0,0)$ 处形函数的梯度：\n对于角节点 $i \\in \\{1,2,3,4\\}$：\n$$\\frac{\\partial N_i}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_i}{\\partial \\eta}(0,0) = 0$$\n对于边中节点 $i \\in \\{5,6,7,8\\}$：\n$$\\frac{\\partial N_5}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_5}{\\partial \\eta}(0,0) = -\\frac{1}{2}(1-0^2) = -\\frac{1}{2}$$\n$$\\frac{\\partial N_6}{\\partial \\xi}(0,0) = \\frac{1}{2}(1-0^2) = \\frac{1}{2}, \\quad \\frac{\\partial N_6}{\\partial \\eta}(0,0) = 0$$\n$$\\frac{\\partial N_7}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_7}{\\partial \\eta}(0,0) = \\frac{1}{2}(1-0^2) = \\frac{1}{2}$$\n$$\\frac{\\partial N_8}{\\partial \\xi}(0,0) = -\\frac{1}{2}(1-0^2) = -\\frac{1}{2}, \\quad \\frac{\\partial N_8}{\\partial \\eta}(0,0) = 0$$\n\n雅可比矩阵 $\\boldsymbol{J}$ 的分量是：\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{8} x_i \\frac{\\partial N_i}{\\partial \\xi}$，$J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{8} x_i \\frac{\\partial N_i}{\\partial \\eta}$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{8} y_i \\frac{\\partial N_i}{\\partial \\xi}$，$J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{8} y_i \\frac{\\partial N_i}{\\partial \\eta}$\n\n使用给定的物理坐标 $\\boldsymbol{x}_i=(x_i, y_i)$ 和在 $(0,0)$ 处的导数：\n$J_{11}(0,0) = x_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + x_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (2)(\\frac{1}{2}) + (-2)(-\\frac{1}{2}) = 1+1=2$\n$J_{12}(0,0) = x_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + x_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (0)(-\\frac{1}{2}) + (0)(\\frac{1}{2}) = 0$\n$J_{21}(0,0) = y_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + y_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (0)(\\frac{1}{2}) + (0)(-\\frac{1}{2}) = 0$\n$J_{22}(0,0) = y_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + y_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (-1)(-\\frac{1}{2}) + (1)(\\frac{1}{2}) = \\frac{1}{2}+\\frac{1}{2}=1$\n\n因此，在中心点的雅可比矩阵及其逆矩阵为：\n$$\\boldsymbol{J}(0,0) = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad \\boldsymbol{J}^{-1}(0,0) = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix}$$\n\n**第4部分：剪应变计算**\n\n剪应变为 $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$。使用插值函数：\n$$\\gamma_{xy} = \\sum_{i=1}^{8} u_{i,x} \\frac{\\partial N_i}{\\partial y} + \\sum_{i=1}^{8} u_{i,y} \\frac{\\partial N_i}{\\partial x}$$\n我们在 $(\\xi, \\eta) = (0,0)$ 处计算该值。首先，我们求出 $N_i$ 在该点的物理导数：\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x}(0,0) \\\\ \\frac{\\partial N_i}{\\partial y}(0,0) \\end{Bmatrix} = \\boldsymbol{J}^{-1}(0,0) \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{Bmatrix} \\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix}$$\n因此，在中心点，$\\gamma_{xy}$ 为：\n$$\\gamma_{xy}(0,0) = \\sum_{i=1}^{8} u_{i,x} \\left(\\frac{\\partial N_i}{\\partial \\eta}(0,0)\\right) + \\sum_{i=1}^{8} u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0)\\right)$$\n节点 1, 2, 3, 4 的节点位移为零。非零位移为：\n$u_{5,x}=1\\times 10^{-3}$, $u_{5,y}=0$\n$u_{6,x}=0$, $u_{6,y}=3\\times 10^{-3}$\n$u_{7,x}=2\\times 10^{-3}$, $u_{7,y}=0$\n$u_{8,x}=0$, $u_{8,y}=-1\\times 10^{-3}$\n\n第一个求和项变为（只有节点 5 和 7 的 $\\frac{\\partial N_i}{\\partial \\eta}$ 和 $u_{i,x}$ 非零）：\n$$\\sum u_{i,x} \\frac{\\partial N_i}{\\partial \\eta} = u_{5,x}\\frac{\\partial N_5}{\\partial \\eta}(0,0) + u_{7,x}\\frac{\\partial N_7}{\\partial \\eta}(0,0)$$\n$$= (1 \\times 10^{-3})(-\\frac{1}{2}) + (2 \\times 10^{-3})(\\frac{1}{2}) = (-0.5 + 1.0) \\times 10^{-3} = 0.5 \\times 10^{-3}$$\n第二个求和项变为（只有节点 6 和 8 的 $\\frac{\\partial N_i}{\\partial \\xi}$ 和 $u_{i,y}$ 非零）：\n$$\\sum u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}\\right) = u_{6,y}\\left(\\frac{1}{2}\\frac{\\partial N_6}{\\partial \\xi}(0,0)\\right) + u_{8,y}\\left(\\frac{1}{2}\\frac{\\partial N_8}{\\partial \\xi}(0,0)\\right)$$\n$$= (3 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot\\frac{1}{2}\\right) + (-1 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot(-\\frac{1}{2})\\right)$$\n$$= (3 \\times 10^{-3})(\\frac{1}{4}) + (-1 \\times 10^{-3})(-\\frac{1}{4}) = (0.75 + 0.25) \\times 10^{-3} = 1.0 \\times 10^{-3}$$\n总剪应变是这两项贡献之和：\n$$\\gamma_{xy}(0,0) = (0.5 \\times 10^{-3}) + (1.0 \\times 10^{-3}) = 1.5 \\times 10^{-3}$$\n问题要求答案四舍五入到4位有效数字。\n$$\\gamma_{xy}(0,0) = 0.001500 = 1.500 \\times 10^{-3}$$", "answer": "$$\\boxed{1.500 \\times 10^{-3}}$$", "id": "3558296"}, {"introduction": "等参映射为模拟复杂几何形状提供了强大的工具，但这种灵活性也伴随着限制。当单元几何形状发生严重扭曲时，从参考空间到物理空间的映射可能会失效。本练习 [@problem_id:3558295] 旨在通过一个具体的几何构造，探讨这一关键问题，您需要确定导致雅可比行列式为零的临界扭曲幅度。理解雅可比行列式作为单元质量的度量及其变为负值的后果，对于生成有效且可靠的有限元网格至关重要。", "problem": "在平面应变计算岩土力学中，考虑一个从母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的双单位正方形到物理 $(x,y)$ 平面的等参映射，该映射使用标准的二次八节点机缘族（将该族记为 $S_2$）。设四个角节点的物理坐标为\n$$\n\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(2,0),\\quad \\mathbf{x}_3=(-s,2),\\quad \\mathbf{x}_4=(0,2),\n$$\n其中 $s>0$ 是一个标量“翘曲振幅”参数，单位为米。四个边中节点位于相应边的物理中点，即，\n$$\n\\mathbf{x}_5=\\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2},\\quad \\mathbf{x}_6=\\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2},\\quad \\mathbf{x}_7=\\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2},\\quad \\mathbf{x}_8=\\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2}.\n$$\n仅使用等参映射的基本定义 $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,\\mathbf{x}_i$、标准二次机缘 ($S_2$) 形函数 $N_i(\\xi,\\eta)$ 以及雅可比矩阵的定义 $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$，推导单元中心 $(\\xi,\\eta)=(0,0)$ 处的雅可比行列式作为 $s$ 的函数，并确定使中心雅可比行列式为零的最小正翘曲振幅 $s=s_{\\mathrm{crit}}$（单位为米）。然后，基于等参映射和单元几何的基本原理，简要讨论为什么在此构造中 $s>s_{\\mathrm{crit}}$ 意味着局部雅可比行列式为负，并概述两种不同的修正策略（网格质量改进或替代映射选择）以在实践中避免此类局部反转。\n\n以米为单位表示 $s_{\\mathrm{crit}}$ 的最终数值结果。无需四舍五入；请提供精确值。", "solution": "该问题要求推导八节点二次机缘单元中心处的雅可比行列式，确定使该行列式为零的临界翘曲参数 $s_{\\mathrm{crit}}$，并讨论其影响与修正措施。\n\n求解过程分四个阶段：\n1.  定义单元几何形状、形函数及其导数。\n2.  计算单元中心 $(\\xi,\\eta)=(0,0)$ 处雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 的分量。\n3.  推导雅可比行列式 $\\det(\\mathbf{J}(0,0))$ 作为 $s$ 的函数，并求解 $s_{\\mathrm{crit}}$。\n4.  讨论负雅可比行列式的意义并提出修正策略。\n\n**1. 单元几何与形函数导数**\n\n从母域 $(\\xi,\\eta)$ 到物理域 $(x,y)$ 的映射由等参关系给出：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\mathbf{x}_i\n$$\n其中 $N_i$ 是 $S_2$ 族的形函数，$\\mathbf{x}_i=(x_i, y_i)$ 是节点坐标。八个节点的标准母坐标 $(\\xi_i, \\eta_i)$ 为：\n角节点：$(-1,-1)$, $(1,-1)$, $(1,1)$, $(-1,1)$ 分别对应节点 1, 2, 3, 4。\n边中节点：$(0,-1)$, $(1,0)$, $(0,1)$, $(-1,0)$ 分别对应节点 5, 6, 7, 8。\n\n物理坐标给定为：\n$\\mathbf{x}_1 = (0,0)$, $\\mathbf{x}_2 = (2,0)$, $\\mathbf{x}_3 = (-s,2)$, $\\mathbf{x}_4 = (0,2)$\n边中节点位于边的物理中点：\n$\\mathbf{x}_5 = \\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2} = \\frac{(0,0)+(2,0)}{2} = (1,0)$\n$\\mathbf{x}_6 = \\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2} = \\frac{(2,0)+(-s,2)}{2} = (1-\\frac{s}{2}, 1)$\n$\\mathbf{x}_7 = \\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2} = \\frac{(-s,2)+(0,2)}{2} = (-\\frac{s}{2}, 2)$\n$\\mathbf{x}_8 = \\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2} = \\frac{(0,2)+(0,0)}{2} = (0,1)$\n\n雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\ \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix}\n$$\n标准机缘形函数的一个关键性质是，角节点形函数（$N_1, N_2, N_3, N_4$）的导数在单元中心 $(\\xi,\\eta)=(0,0)$ 处为零。边中节点形函数（$N_5, N_6, N_7, N_8$）在中心处的导数非零，由下表给出：\n$$\n\\begin{array}{c|c|c}\ni & \\frac{\\partial N_i}{\\partial \\xi}\\Big|_{(0,0)} & \\frac{\\partial N_i}{\\partial \\eta}\\Big|_{(0,0)} \\\\\n\\hline\n5 & 0 & -1/2 \\\\\n6 & 1/2 & 0 \\\\\n7 & 0 & 1/2 \\\\\n8 & -1/2 & 0 \\\\\n\\end{array}\n$$\n\n**2. 单元中心处的雅可比矩阵**\n\n使用上述导数，雅可比矩阵在 $(\\xi,\\eta) = (0,0)$ 处的分量计算如下。求和简化为仅包含来自边中节点的项。\n\n$J_{11} = \\frac{\\partial x}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{\\partial N_6}{\\partial \\xi}x_6 + \\frac{\\partial N_8}{\\partial \\xi}x_8 = \\frac{1}{2}\\left(1-\\frac{s}{2}\\right) + \\left(-\\frac{1}{2}\\right)(0) = \\frac{1}{2}-\\frac{s}{4}$.\n\n$J_{12} = \\frac{\\partial x}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{\\partial N_5}{\\partial \\eta}x_5 + \\frac{\\partial N_7}{\\partial \\eta}x_7 = \\left(-\\frac{1}{2}\\right)(1) + \\frac{1}{2}\\left(-\\frac{s}{2}\\right) = -\\frac{1}{2}-\\frac{s}{4}$.\n\n$J_{21} = \\frac{\\partial y}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{\\partial N_6}{\\partial \\xi}y_6 + \\frac{\\partial N_8}{\\partial \\xi}y_8 = \\frac{1}{2}(1) + \\left(-\\frac{1}{2}\\right)(1) = 0$.\n\n$J_{22} = \\frac{\\partial y}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{\\partial N_5}{\\partial \\eta}y_5 + \\frac{\\partial N_7}{\\partial \\eta}y_7 = \\left(-\\frac{1}{2}\\right)(0) + \\frac{1}{2}(2) = 1$.\n\n中心处的雅可比矩阵为：\n$$\n\\mathbf{J}(0,0) = \\begin{pmatrix} \\frac{1}{2} - \\frac{s}{4} & -\\frac{1}{2} - \\frac{s}{4} \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n**3. 雅可比行列式与临界翘曲振幅**\n\n中心处的雅可比行列式为：\n$$\n\\det(\\mathbf{J}(0,0)) = J_{11}J_{22} - J_{12}J_{21} = \\left(\\frac{1}{2} - \\frac{s}{4}\\right)(1) - \\left(-\\frac{1}{2} - \\frac{s}{4}\\right)(0) = \\frac{1}{2} - \\frac{s}{4}\n$$\n当雅可比行列式为零或变为负值时，映射变得无效。临界翘曲振幅 $s_{\\mathrm{crit}}$ 是使行列式为零的最小正 $s$ 值。\n$$\n\\det(\\mathbf{J}(0,0)) = 0 \\implies \\frac{1}{2} - \\frac{s}{4} = 0\n$$\n求解 $s$：\n$$\n\\frac{s}{4} = \\frac{1}{2} \\implies s = 2\n$$\n因此，临界翘曲振幅为 $s_{\\mathrm{crit}} = 2$ 米。\n\n**4. 负雅可比行列式的讨论与修正策略**\n\n对于一个有效的一一等参映射，雅可比行列式必须在单元内处处为正，即 $\\det(\\mathbf{J}) > 0$。行列式表示物理空间中微分面积与母空间中微分面积的局部比率，$dA = \\det(\\mathbf{J}) d\\xi d\\eta$。正的行列式确保了局部坐标系的方向得以保持。\n\n在此构造中，行列式 $\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{s}{4}$ 是 $s$ 的一个连续函数。当 $s > s_{\\mathrm{crit}}=2$ 时，行列式变为负值。例如，如果 $s=4$，则 $\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{4}{4} = -0.5$。负的行列式意味着单元几何形状的局部反转或“折叠”。从几何上看，当 $s>2$ 时，项 $J_{11} = \\frac{\\partial x}{\\partial \\xi}|_{(0,0)} = \\frac{1}{2} - \\frac{s}{4}$ 变为负值。这意味着沿着单元的中心线（$\\eta=0$），母坐标 $\\xi$ 的增加（从节点8所在的边移动到节点6所在的边）会导致物理坐标 $x$ 的减少。单元几何形状变为自穿透，这对于连续体来说在物理上和数学上都是无效的。\n\n避免此类局部反转的两种不同修正策略是：\n\n1.  **网格质量改进：** 此方法侧重于修改网格以防止严重畸变。\n    *   **节点重定位（平滑）：** 导致单元无效的主要原因是角节点 $\\mathbf{x}_3=(-s,2)$ 的极端位置。可以采用网格生成或平滑算法来重新定位此节点（即，将 $s$ 的值减小到 $s_{\\mathrm{crit}}$ 以下），以确保网格中的所有单元都具有正的雅可比行列式。这是实践中最常见的方法。\n    *   **网格细化：** 可以用多个更小、形状更好的单元替换单个高度畸变的四边形单元。例如，该区域可以被细分为两个三角形单元或四个更小的四边形单元。这样做会增加自由度，但可以在不产生无效单元的情况下表示预期的几何形状。\n\n2.  **替代的公式或单元选择：** 此方法修改有限元公式本身，而不是网格几何形状。\n    *   **亚参公式：** 可以使用比场变量近似阶数更低的形函数进行几何映射。例如，使用一个线性的几何映射（仅基于四个角节点）和二次形函数来求解场。这样单元的边将是直的。这是一种亚参单元。然而，对于足够大的 $s$，由四个角节点定义的四边形会变得自相交（一个“交叉四边形”），即使使用线性映射，它仍然是无效的。\n    *   **使用低阶或更稳健的单元：** 更简单的单元通常对畸变有更强的抵抗力。可以使用由四节点线性四边形单元（$Q_1$）或三节点线性三角形单元（CST）组成的网格。这些单元因节点定位而失效的倾向较低，但代价是每个单元的精度会降低，尤其是在弯曲问题中。", "answer": "$$\\boxed{2}$$", "id": "3558295"}, {"introduction": "为了提高计算效率，有限元实践中常采用减缩积分格式来计算单元刚度矩阵。然而，这种简化并非没有代价。本练习 [@problem_id:3558309] 将揭示减缩积分的一个著名副作用：引入非物理的零能量变形模式，即“沙漏模式”。通过在一个简单的单元上使用 $1 \\times 1$ 的高斯积分，您将构造一个不产生任何应变能的位移模式，从而深入理解数值积分方案的选择如何影响有限元模型的稳定性和准确性。", "problem": "考虑一个均质、各向同性土体的小应变、平面应变、线性弹性响应，该土体由单个二阶机缘族 ($S_2$) 四边形等参有限元离散化。该单元在母坐标 $(\\xi,\\eta)$ 中占据方形参考域 $[-1,1]\\times[-1,1]$，对于本问题，等参映射为恒等映射，因此物理坐标 $(x,y)$ 与 $(\\xi,\\eta)$ 重合。该单元有八个节点：四个角节点位于 $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$，四个边中节点位于 $(\\xi,\\eta)=(0,-1),(1,0),(0,1),(-1,0)$。每个节点有两个位移自由度，$u_x$ 和 $u_y$。插值使用标准的 $S_2$ 机缘形函数。\n\n应变张量 $\\boldsymbol{\\varepsilon}$ 由小应变运动学定义，即 $\\boldsymbol{\\varepsilon}=\\operatorname{sym}(\\nabla \\boldsymbol{u})$，应变能密度为 $W(\\boldsymbol{\\varepsilon})=\\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{D}$ 是平面应变问题的对称正定弹性矩阵。单元刚度将通过使用 $1\\times 1$ 高斯求积法则（在参考正方形上，单个高斯点位于 $(\\xi,\\eta)=(0,0)$，权重为 $2\\times 2$）的减缩积分来计算，因此应变能仅取决于在 $(\\xi,\\eta)=(0,0)$ 处计算的应变。\n\n仅使用上述定义和标准的 $S_2$ 机缘形函数，推导高斯点 $(\\xi,\\eta)=(0,0)$ 处的应变-位移关系，并说明减缩积分如何能允许产生零应变能的位移模式（沙漏模式）。然后，将注意力限制在一种特定的位移模式上，其中除了右侧和左侧边中节点（分别为 $(\\xi,\\eta)=(1,0)$ 和 $(\\xi,\\eta)=(-1,0)$）的水平位移外，所有节点自由度均为零。将这两个非零自由度表示为 $u_{6x}=A$ 和 $u_{8x}=rA$，其中 $A\\neq 0$ 是一个任意振幅，$r$ 是一个实值比率。确定 $r$ 的值，使得由 $1\\times 1$ 求积法则计算的应变能恰好为零。将最终答案表示为单个实数。无需四舍五入，也无需报告物理单位。", "solution": "该问题是有效的，因为它科学地基于计算力学和有限元法的原理，是适定的、客观的，并为其解决提供了一套自洽和一致的数据与条件。\n\n有限元的总应变能 $U$ 由应变能密度 $W(\\boldsymbol{\\varepsilon})$ 在单元面积 $A_{e}$ 上的积分给出。由于问题指定了平面应变条件，我们考虑单位厚度的能量。等参映射为恒等映射，因此物理坐标 $(x,y)$ 与母坐标 $(\\xi,\\eta)$ 相同，且雅可比矩阵的行列式为 $|\\boldsymbol{J}|=1$。因此，积分为：\n$$U = \\int_{A_e} W(\\boldsymbol{\\varepsilon}) \\, dA = \\int_{-1}^{1} \\int_{-1}^{1} W(\\boldsymbol{\\varepsilon}(\\xi, \\eta)) \\, d\\xi \\, d\\eta$$\n问题指定单元刚度，也即应变能，是使用 $1 \\times 1$ 高斯求积法则计算的。该法则通过在参考域中心 $(\\xi, \\eta) = (0,0)$ 处计算被积函数的值，并乘以适当的权重来近似积分，对于参考正方形 $[-1,1]\\times[-1,1]$，该权重为 $2 \\times 2 = 4$。\n$$U \\approx 4 \\cdot W(\\boldsymbol{\\varepsilon}(0,0))$$\n应变能密度定义为 $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{D}$ 是对称正定弹性矩阵。由于 $\\boldsymbol{D}$ 是正定的，当且仅当应变张量 $\\boldsymbol{\\varepsilon}$ 为零张量时，$W(\\boldsymbol{\\varepsilon})$ 才为零。因此，当且仅当在高斯点处计算的应变张量为零时，由减缩积分方案近似的应变能才为零：\n$$\\boldsymbol{\\varepsilon}(0,0) = \\mathbf{0}$$\n为了评估此条件，我们必须首先建立在 $(\\xi, \\eta) = (0,0)$ 处的应变-位移关系。位移场 $\\boldsymbol{u}(\\xi,\\eta)$ 是通过使用 $S_2$ 机缘形函数 $N_i(\\xi, \\eta)$ 从节点位移 $\\boldsymbol{d}_i$ 插值得到的：\n$$\\boldsymbol{u}(\\xi,\\eta) = \\begin{pmatrix} u_x(\\xi,\\eta) \\\\ u_y(\\xi,\\eta) \\end{pmatrix} = \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix}$$\n在与 $(\\xi,\\eta)$ 重合的 $(x,y)$ 坐标系中，小应变张量的分量为：\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial u_x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} u_{ix}$$\n$$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial u_y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} u_{iy}$$\n$$\\gamma_{xy} = 2\\varepsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial u_x}{\\partial \\eta} + \\frac{\\partial u_y}{\\partial \\xi} = \\sum_{i=1}^{8} \\left( \\frac{\\partial N_i}{\\partial \\eta} u_{ix} + \\frac{\\partial N_i}{\\partial \\xi} u_{iy} \\right)$$\n这些表达式必须在高斯点 $(\\xi, \\eta) = (0,0)$ 处进行计算。这需要 $S_2$ 形函数在该点的导数。8节点机缘单元的形函数为：\n对于角节点 $i=1,2,3,4$（位于 $(\\xi_i, \\eta_i)$，其中 $\\xi_i, \\eta_i \\in \\{-1, 1\\}$）：$N_i = \\frac{1}{4}(1+\\xi\\xi_i)(1+\\eta\\eta_i)(\\xi\\xi_i+\\eta\\eta_i-1)$。\n对于边中节点 $i=5,7$（位于 $(0, \\eta_i)$，其中 $\\eta_i \\in \\{-1, 1\\}$）：$N_i = \\frac{1}{2}(1-\\xi^2)(1+\\eta\\eta_i)$。\n对于边中节点 $i=6,8$（位于 $(\\xi_i, 0)$，其中 $\\xi_i \\in \\{-1, 1\\}$）：$N_i = \\frac{1}{2}(1+\\xi\\xi_i)(1-\\eta^2)$。\n\n这些形函数在 $(\\xi, \\eta) = (0,0)$ 处的偏导数为：\n对于所有角节点 ($i=1,2,3,4$)：\n$$\\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)}=0, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)}=0$$\n对于边中节点 ($i=5,6,7,8$)：\n\\begin{itemize}\n    \\item 节点 $5$ 位于 $(0,-1)$: $\\frac{\\partial N_5}{\\partial \\xi}\\big|_{(0,0)}=0$, $\\frac{\\partial N_5}{\\partial \\eta}\\big|_{(0,0)}=-\\frac{1}{2}$\n    \\item 节点 $6$ 位于 $(1,0)$: $\\frac{\\partial N_6}{\\partial \\xi}\\big|_{(0,0)}=\\frac{1}{2}$, $\\frac{\\partial N_6}{\\partial \\eta}\\big|_{(0,0)}=0$\n    \\item 节点 $7$ 位于 $(0,1)$: $\\frac{\\partial N_7}{\\partial \\xi}\\big|_{(0,0)}=0$, $\\frac{\\partial N_7}{\\partial \\eta}\\big|_{(0,0)}=\\frac{1}{2}$\n    \\item 节点 $8$ 位于 $(-1,0)$: $\\frac{\\partial N_8}{\\partial \\xi}\\big|_{(0,0)}=-\\frac{1}{2}$, $\\frac{\\partial N_8}{\\partial \\eta}\\big|_{(0,0)}=0$\n\\end{itemize}\n将这些导数代入应变表达式，可以发现中心点的应变仅取决于边中节点的位移：\n$$\\varepsilon_{xx}(0,0) = \\frac{1}{2}u_{6x} - \\frac{1}{2}u_{8x}$$\n$$\\varepsilon_{yy}(0,0) = -\\frac{1}{2}u_{5y} + \\frac{1}{2}u_{7y}$$\n$$\\gamma_{xy}(0,0) = \\left(-\\frac{1}{2}u_{5x} + \\frac{1}{2}u_{7x}\\right) + \\left(\\frac{1}{2}u_{6y} - \\frac{1}{2}u_{8y}\\right)$$\n这一结果展示了减缩积分如何允许沙漏模式的出现。任何导致中心点应变为零的节点位移组合，即使单元正在变形，其计算出的应变能也将为零。例如，任何仅涉及角节点的位移模式都会产生 $\\boldsymbol{\\varepsilon}(0,0)=\\mathbf{0}$，因此在这种积分方案下是一种零能（沙漏）模式。\n\n问题要求分析一种特定的位移模式，其中除了两个节点自由度外，所有其他节点自由度均为零：\n$$u_{6x} = A \\quad (\\text{在节点 } 6, (\\xi,\\eta)=(1,0))$$\n$$u_{8x} = rA \\quad (\\text{在节点 } 8, (\\xi,\\eta)=(-1,0))$$\n这里，$A \\neq 0$，$r$ 是一个实值比率。对于这种特定模式，所有其他节点位移，如 $u_{5x}, u_{5y}, u_{6y}, u_{7x}, u_{7y}, u_{8y}$，均为零。\n将这些特定的节点位移代入 $(\\xi,\\eta)=(0,0)$ 处的应变方程：\n$$\\varepsilon_{xx}(0,0) = \\frac{1}{2}(A) - \\frac{1}{2}(rA) = \\frac{A}{2}(1-r)$$\n$$\\varepsilon_{yy}(0,0) = -\\frac{1}{2}(0) + \\frac{1}{2}(0) = 0$$\n$$\\gamma_{xy}(0,0) = (0+0)+(0+0) = 0$$\n因此，高斯点处的应变张量为：\n$$\\boldsymbol{\\varepsilon}(0,0) = \\begin{pmatrix} \\frac{A}{2}(1-r) \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n为了使计算出的应变能为零，该应变张量必须为零向量。这要求其唯一可能非零的分量为零：\n$$\\frac{A}{2}(1-r) = 0$$\n鉴于 $A \\neq 0$，该方程仅在以下情况下成立：\n$$1-r = 0$$\n解出 $r$ 得：\n$$r = 1$$\n因此，要使指定的位移模式在 $1 \\times 1$ 高斯求积下成为零能（沙漏）模式，比率 $r$ 必须等于 $1$。这对应于位移场 $u_x = A(1-\\eta^2)$ 和 $u_y=0$，这是该单元的一种经典的弯曲型沙漏模式。", "answer": "$$\\boxed{1}$$", "id": "3558309"}]}