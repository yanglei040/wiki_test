{"hands_on_practices": [{"introduction": "物质导数的概念是普适的，但其数学表达式却依赖于所选择的坐标系。本练习将引导你从物质导数最基本的定义出发，通过在球坐标系下进行推导，来巩固对这一核心概念的理解。掌握在不同坐标系（如处理井眼或隧道问题时常见的球坐标系）下转换和应用物质导数，是计算力学问题求解的一项基本功 [@problem_id:3542145]。", "problem": "考虑一个饱和多孔固体，在三维空间中具有球对称的径向渗流，其中孔隙流体速度场是纯径向的，由 $\\mathbf{v}(\\mathbf{x},t)=v_{r}(r,t)\\,\\mathbf{e}_{r}$ 给出，其中 $(r,\\theta,\\varphi)$ 是球坐标，$\\mathbf{e}_{r}$ 是径向单位向量，且 $r=|\\mathbf{x}|$。设 $\\phi(\\mathbf{x},t)$ 是孔隙流体的一个标量物质属性（例如，溶解示踪剂的浓度），该属性随流体一起输运。假设该标量场具有球对称性，因此 $\\phi(\\mathbf{x},t)=\\phi(r,t)$。\n\n仅从物质（或随体）时间导数定义为跟随物质粒子变化的时间变化率出发，\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t),\n$$\n并从以球坐标表示的粒子轨迹运动学 $\\mathbf{x}(t)\\leftrightarrow\\big(r(t),\\theta(t),\\varphi(t)\\big)$ 出发，完成以下任务：\n\n1. 使用链式法则和球坐标 $\\big(r,\\theta,\\varphi\\big)$，将 $\\frac{D\\phi}{Dt}$ 表示为 $\\frac{\\partial \\phi}{\\partial t}$、$\\phi$ 关于 $r$、$\\theta$ 和 $\\varphi$ 的偏导数，以及坐标时间变化率 $\\dot{r}$、$\\dot{\\theta}$ 和 $\\dot{\\varphi}$ 的函数。\n\n2. 将您的表达式应用于给定的具有纯径向流的球对称情况，并从运动学上论证哪些坐标时间变化率沿轨迹为零。然后，获得一个关于 $\\frac{\\partial \\phi}{\\partial t}$、$v_{r}(r,t)$ 和 $\\frac{\\partial \\phi}{\\partial r}$ 的 $\\frac{D\\phi}{Dt}$ 的显式闭合形式表达式。\n\n3. 引入一维笛卡尔坐标映射 $s=r$，一维速度 $u(s,t)=v_{r}(r,t)$，以及沿径向线的标量场 $\\psi(s,t)=\\phi(r,t)$。使用这些定义，证明您在第2步中得到的表达式与标量场的一维标准笛卡尔物质导数在形式上一致。\n\n将您的最终答案表示为关于 $\\frac{\\partial \\phi}{\\partial t}$、$v_{r}$ 和 $\\frac{\\partial \\phi}{\\partial r}$ 的 $\\frac{D\\phi}{Dt}$ 的单一闭合形式解析表达式。无需单位，也无需数值计算。", "solution": "该问题是有效的，因为它在科学上基于连续介质力学，是适定的、客观的且内部一致的。它提出了一个关于在特定曲线坐标系和对称约束下物质时间导数的标准推导练习。我将按顺序完成这三个任务来解答。\n\n第一个任务是推导物质（或随体）时间导数 $\\frac{D\\phi}{Dt}$ 在球坐标系中的一般表达式。其定义为跟随物质粒子轨迹 $\\mathbf{x}(t)$ 的标量场 $\\phi$ 的全时间导数：\n$$\n\\frac{D\\phi}{Dt} \\equiv \\frac{d}{dt}\\,\\phi(\\mathbf{x}(t),t)\n$$\n在球坐标系 $(r, \\theta, \\varphi)$ 中，粒子的位置由时间函数描述，$\\mathbf{x}(t) \\leftrightarrow \\big(r(t), \\theta(t), \\varphi(t)\\big)$。标量场 $\\phi$ 通常是这些坐标和时间的函数，$\\phi = \\phi(r, \\theta, \\varphi, t)$。为了求出 $\\phi\\big(r(t), \\theta(t), \\varphi(t), t\\big)$ 关于时间 $t$ 的全导数，我们应用多元链式法则：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t}\\frac{dt}{dt} + \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{dt} + \\frac{\\partial \\phi}{\\partial \\theta}\\frac{d\\theta}{dt} + \\frac{\\partial \\phi}{\\partial \\varphi}\\frac{d\\varphi}{dt}\n$$\n鉴于 $\\frac{dt}{dt}=1$，并使用点表示法表示坐标的时间导数，即 $\\dot{r} \\equiv \\frac{dr}{dt}$、$\\dot{\\theta} \\equiv \\frac{d\\theta}{dt}$ 和 $\\dot{\\varphi} \\equiv \\frac{d\\varphi}{dt}$，表达式变为：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\dot{r}\\frac{\\partial \\phi}{\\partial r} + \\dot{\\theta}\\frac{\\partial \\phi}{\\partial \\theta} + \\dot{\\varphi}\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\n这就是物质导数在球坐标系中的一般表达式，从而完成了第一个任务。\n\n第二个任务要求将此表达式应用于给定的具有纯径向流的球对称情况。根据定义，流体速度向量 $\\mathbf{v}$ 是粒子位置向量的时间导数，$\\mathbf{v} = \\frac{d\\mathbf{x}}{dt}$。在球坐标系中，速度向量与坐标时间变化率的关系如下：\n$$\n\\mathbf{v} = \\dot{r}\\,\\mathbf{e}_{r} + (r\\dot{\\theta})\\,\\mathbf{e}_{\\theta} + (r\\sin\\theta\\,\\dot{\\varphi})\\,\\mathbf{e}_{\\varphi}\n$$\n其中 $\\mathbf{e}_{r}$、$\\mathbf{e}_{\\theta}$ 和 $\\mathbf{e}_{\\varphi}$ 是标准正交基向量。问题陈述流是纯径向的，由 $\\mathbf{v}(\\mathbf{x}, t) = v_{r}(r,t)\\mathbf{e}_{r}$ 给出。为了在运动学上满足这个条件，我们必须将一般速度表达式的分量与给定表达式的分量相等：\n*   径向分量：$\\dot{r} = v_{r}(r,t)$。\n*   极向分量：$r\\dot{\\theta} = 0$。\n*   方位角分量：$r\\sin\\theta\\,\\dot{\\varphi} = 0$。\n对于不在原点 ($r > 0$) 的粒子，条件 $r\\dot{\\theta} = 0$ 意味着 $\\dot{\\theta} = 0$。对于不在极轴（$z$轴，此处 $\\sin\\theta = 0$）上的粒子，条件 $r\\sin\\theta\\,\\dot{\\varphi} = 0$ 意味着 $\\dot{\\varphi} = 0$。因此，纯径向流在运动学上要求移动流体粒子的角坐标保持不变，因此它们的时间变化率 $\\dot{\\theta}$ 和 $\\dot{\\varphi}$ 为零。\n\n此外，标量场 $\\phi$ 也具有球对称性，$\\phi(\\mathbf{x},t) = \\phi(r,t)$，这意味着它与 $\\theta$ 和 $\\varphi$ 无关。因此，它关于角坐标的偏导数为零：$\\frac{\\partial\\phi}{\\partial\\theta} = 0$ 和 $\\frac{\\partial\\phi}{\\partial\\varphi} = 0$。\n\n将运动学结果 $\\dot{r} = v_{r}$、$\\dot{\\theta} = 0$ 和 $\\dot{\\varphi} = 0$ 代入 $\\frac{D\\phi}{Dt}$ 的一般表达式中：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r} + (0)\\frac{\\partial \\phi}{\\partial \\theta} + (0)\\frac{\\partial \\phi}{\\partial \\varphi}\n$$\n该表达式简化为所需的闭合形式：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t)\\frac{\\partial \\phi}{\\partial r}\n$$\n\n第三个任务是使用所提供的映射：$s=r$、$u(s,t)=v_{r}(r,t)$ 和 $\\psi(s,t)=\\phi(r,t)$，证明此结果在形式上与一维笛卡尔物质导数等价。在一维笛卡尔坐标系中，坐标为 $s$，速度为 $u(s,t)$ 的标量场 $\\psi(s,t)$ 的物质导数为：\n$$\n\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + u(s,t) \\frac{\\partial \\psi}{\\partial s}\n$$\n该形式源于一般定义 $\\frac{D\\psi}{Dt} = \\frac{\\partial \\psi}{\\partial t} + \\mathbf{v} \\cdot \\nabla \\psi$，其中在一维情况下 $\\mathbf{v} = u(s,t)\\mathbf{e}_{s}$ 且 $\\nabla = \\mathbf{e}_{s}\\frac{\\partial}{\\partial s}$。现在，我们将给定的映射应用于此方程：\n*   由于 $\\psi(s,t) = \\phi(r(s),t)$ 且 $r=s$，保持 $s$ 不变等同于保持 $r$ 不变，所以 $\\frac{\\partial \\psi}{\\partial t} = \\frac{\\partial \\phi}{\\partial t}$。\n*   根据定义，$u(s,t) = v_{r}(r,t)$。\n*   根据链式法则，$\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}\\frac{dr}{ds}$。因为 $s=r$，所以 $\\frac{dr}{ds}=1$，故 $\\frac{\\partial \\psi}{\\partial s} = \\frac{\\partial \\phi}{\\partial r}$。\n将这些等价关系代回一维笛卡尔表达式 $\\frac{D\\psi}{Dt}$ 中，得到：\n$$\n\\frac{\\partial \\phi}{\\partial t} + v_{r}(r,t) \\frac{\\partial \\phi}{\\partial r}\n$$\n此结果与第二个任务中推导出的 $\\frac{D\\phi}{Dt}$ 表达式完全相同。这表明，球对称场在纯径向流作用下的对流在数学上类似于沿直线的一维对流问题。最终要求的表达式即为第二个任务的结果。", "answer": "$$\n\\boxed{\\frac{\\partial \\phi}{\\partial t} + v_{r} \\frac{\\partial \\phi}{\\partial r}}\n$$", "id": "3542145"}, {"introduction": "将连续介质力学中的控制方程应用于计算机求解，必然涉及离散化过程。物质导数中的对流项在数值上通常表现为平流输运，而其离散格式的稳定性是决定计算成败的关键。本练习旨在通过对一个典型的一维平流问题的分析，推导著名的 Courant-Friedrichs-Lewy (CFL) 稳定性条件 [@problem_id:3542201]。理解并能推导此类稳定性约束，对于在显式动力学或流体计算中合理选择时间步长至关重要。", "problem": "考虑一个标量场 $\\phi(x,t)$ 的一维平流主导输运，该标量场代表了计算岩土力学中的一个运动学孔隙尺度量（例如，在饱和土柱中以渗流速度移动的染料浓度）。物质时间导数定义为 $D\\phi/Dt = \\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x$，其中速度 $v$ 在整个区域内被认为是空间均匀且为正的。忽略扩散和源项，使得控制平衡方程简化为纯平流，并在一个周期性区域上采用间距为 $h$ 的均匀网格。使用应用于 $\\partial \\phi/\\partial t$ 的前向欧拉法对时间进行离散，并使用应用于 $v\\,\\partial \\phi/\\partial x$ 的一阶迎风差分对空间进行离散。假设离散场在单元中心 $\\{x_i\\}$ 处表示。\n\n从控制平衡方程和这些离散化选择出发，通过分析周期性边界条件下离散傅里叶模态的演化，推导此显式格式的稳定性要求。然后将您的结果具体化，为参数值 $h = 0.05\\,\\text{m}$ 和 $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$ 计算最大稳定时间步长 $\\Delta t_{\\max}$。最终答案以秒为单位表示，并将您的数值结果四舍五入到四位有效数字。您的最终答案必须是一个实数。", "solution": "### 步骤 1：提取已知条件\n- **控制方程**：物质时间导数为 $D\\phi/Dt = \\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x$。控制平衡方程为纯平流，因此 $D\\phi/Dt=0$。这给出了一维线性平流方程：$\\partial \\phi/\\partial t + v\\,\\partial \\phi/\\partial x = 0$。\n- **标量场**：$\\phi(x,t)$ 是一个标量场。\n- **速度**：$v$ 是一个空间均匀且为正的常量。\n- **区域**：在周期性区域上使用间距为 $h$ 的均匀网格。离散场在单元中心 $\\{x_i\\}$ 处表示。\n- **离散化方法**：\n    - **时间**：对 $\\partial \\phi/\\partial t$ 项使用前向欧拉法。\n    - **空间**：对 $v\\,\\partial \\phi/\\partial x$ 项使用一阶迎风差分。\n- **分析方法**：稳定性将使用周期性边界条件下的离散傅里叶模态进行分析（von Neumann 稳定性分析）。\n- **参数值**：\n    - 网格间距, $h = 0.05\\,\\text{m}$。\n    - 速度, $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$。\n- **目标**：\n    1. 推导指定显式格式的稳定性要求。\n    2. 为给定参数计算最大稳定时间步长 $\\Delta t_{\\max}$。\n    3. 将数值结果四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学依据**：该问题基于线性平流方程，这是物理学和工程学中的一个基本模型。离散化方法（前向欧拉法、一阶迎风法）和分析方法（von Neumann 稳定性分析）是偏微分方程数值分析中的标准、成熟的技术。物理参数对于岩土力学应用是合理的。该问题在科学上是合理的。\n- **适定的**：该问题提供了清晰的控制方程、明确的离散化规则、边界条件（周期性）、初始条件（隐含在傅里叶模态分析中）以及一个具体、明确的目标。存在唯一且有意义的解。\n- **客观性**：问题以精确、正式的语言陈述，没有主观性或模糊性。\n- **完整性**：提供了推导稳定性条件和计算数值答案所需的所有信息。假设 $v  0$ 是至关重要的，并且已说明，这使得迎风格式的选择是明确的。明确提到了周期性边界条件，这是指定的 von Neumann 分析的先决条件。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是一个适定的、有科学依据的、计算方法中的标准问题。现在开始求解过程。\n\n### 求解推导\n一维线性平流的控制偏微分方程 (PDE) 是：\n$$\n\\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0\n$$\n我们在一个均匀网格上离散化这个方程，其中 $x_i = i h$ 和 $t_n = n \\Delta t$。解 $\\phi(x_i, t_n)$ 由离散变量 $\\phi_i^n$ 近似。\n\n时间导数 $\\partial \\phi/\\partial t$ 使用前向欧拉法进行离散化：\n$$\n\\frac{\\partial \\phi}{\\partial t} \\bigg|_{i,n} \\approx \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t}\n$$\n空间导数 $\\partial \\phi/\\partial x$ 使用一阶迎风格式进行离散化。由于速度 $v$ 给定为正 ($v  0$)，“迎风”方向是 x 负方向，因此该格式使用节点 $i$ 和 $i-1$：\n$$\n\\frac{\\partial \\phi}{\\partial x} \\bigg|_{i,n} \\approx \\frac{\\phi_i^n - \\phi_{i-1}^n}{h}\n$$\n将这些离散近似代入控制 PDE，得到有限差分方程 (FDE)：\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} + v \\left(\\frac{\\phi_i^n - \\phi_{i-1}^n}{h}\\right) = 0\n$$\n为了分析稳定性，我们首先重排 FDE，用上一个时间步 $n$ 的值来表示 $\\phi_i^{n+1}$：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{v \\Delta t}{h} (\\phi_i^n - \\phi_{i-1}^n)\n$$\n我们定义库朗数 (Courant number) $C$ 为无量纲参数 $C = \\frac{v \\Delta t}{h}$。FDE 变为：\n$$\n\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)\n$$\n$$\n\\phi_i^{n+1} = (1 - C)\\phi_i^n + C\\phi_{i-1}^n\n$$\n对于 von Neumann 稳定性分析，我们考虑将单个傅里叶模态作为 FDE 的解：\n$$\n\\phi_i^n = \\hat{\\phi}^n(k) e^{I k x_i} = \\hat{\\phi}^n(k) e^{I k i h}\n$$\n其中 $\\hat{\\phi}^n(k)$ 是在时间步 $n$ 波数为 $k$ 的模态的振幅，而 $I = \\sqrt{-1}$ 是虚数单位。将此代入 FDE：\n$$\n\\hat{\\phi}^{n+1} e^{I k i h} = (1 - C) \\hat{\\phi}^n e^{I k i h} + C \\hat{\\phi}^n e^{I k (i-1) h}\n$$\n我们可以将整个方程除以 $e^{I k i h}$：\n$$\n\\hat{\\phi}^{n+1} = (1 - C) \\hat{\\phi}^n + C \\hat{\\phi}^n e^{-I k h}\n$$\n放大因子 $G(k)$ 由关系式 $\\hat{\\phi}^{n+1} = G(k) \\hat{\\phi}^n$ 定义。从上面的方程中，我们可以确定 $G(k)$ 为：\n$$\nG(k) = 1 - C + C e^{-I k h}\n$$\n为使格式稳定，对于所有可能的波数 $k$，放大因子的模都不能超过 1，即 $|G(k)| \\le 1$。我们分析模的平方 $|G(k)|^2$。使用欧拉公式 $e^{-I \\theta} = \\cos(\\theta) - I \\sin(\\theta)$，我们有：\n$$\nG(k) = 1 - C + C(\\cos(kh) - I \\sin(kh)) = (1 - C + C\\cos(kh)) - I(C\\sin(kh))\n$$\n模的平方是实部和虚部平方的和：\n$$\n|G(k)|^2 = (1 - C + C\\cos(kh))^2 + (-C\\sin(kh))^2\n$$\n$$\n|G(k)|^2 = (1 - C(1-\\cos(kh)))^2 + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1-\\cos(kh))^2 + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1 - 2\\cos(kh) + \\cos^2(kh)) + C^2\\sin^2(kh)\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(1 - 2\\cos(kh) + \\cos^2(kh) + \\sin^2(kh))\n$$\n使用恒等式 $\\cos^2(kh) + \\sin^2(kh) = 1$：\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + C^2(2 - 2\\cos(kh))\n$$\n$$\n|G(k)|^2 = 1 - 2C(1-\\cos(kh)) + 2C^2(1-\\cos(kh))\n$$\n$$\n|G(k)|^2 = 1 + (2C^2 - 2C)(1-\\cos(kh)) = 1 + 2C(C-1)(1-\\cos(kh))\n$$\n稳定性条件 $|G(k)|^2 \\le 1$ 变为：\n$$\n1 + 2C(C-1)(1-\\cos(kh)) \\le 1\n$$\n$$\n2C(C-1)(1-\\cos(kh)) \\le 0\n$$\n让我们分析这个不等式中的各项。\n- 库朗数 $C = \\frac{v \\Delta t}{h}$ 是正的，因为 $v  0$，$\\Delta t  0$ 且 $h  0$。\n- 项 $(1 - \\cos(kh))$ 总是非负的，因为 $\\cos(kh)$ 总是在 $-1$ 和 $1$ 之间。具体来说，$0 \\le 1-\\cos(kh) \\le 2$。\n由于 $C  0$ 和 $(1-\\cos(kh)) \\ge 0$，该不等式成立的充要条件是项 $(C-1)$ 是非正的：\n$$\nC - 1 \\le 0 \\implies C \\le 1\n$$\n这就是著名的一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件。稳定性要求是库朗数必须小于或等于 $1$。\n$$\n\\frac{v \\Delta t}{h} \\le 1\n$$\n为了找到最大稳定时间步长 $\\Delta t_{\\max}$，我们将库朗数设置为其最大允许值 $1$：\n$$\n\\Delta t \\le \\frac{h}{v} \\implies \\Delta t_{\\max} = \\frac{h}{v}\n$$\n现在我们代入给定的数值：$h = 0.05\\,\\text{m}$ 和 $v = 1.2 \\times 10^{-4}\\,\\text{m}/\\text{s}$。\n$$\n\\Delta t_{\\max} = \\frac{0.05}{1.2 \\times 10^{-4}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{5 \\times 10^{-2}}{1.2 \\times 10^{-4}} = \\frac{5}{1.2} \\times 10^{2} = \\frac{50}{12} \\times 100 = \\frac{25}{6} \\times 100\n$$\n$$\n\\Delta t_{\\max} = 4.1666... \\times 100 = 416.666... \\,\\text{s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 416.7 \\,\\text{s}\n$$", "answer": "$$\n\\boxed{416.7}\n$$", "id": "3542201"}, {"introduction": "在处理大变形等地质力学问题时，计算网格的运动可以独立于物质点的运动，这催生了任意拉格朗日-欧拉（ALE）方法。本练习将带你进入这一高级计算框架，探讨如何在ALE描述下精确计算物质导数。通过区分物质速度、网格速度与相对速度，你将推导并验证物质导数的两种等价计算形式，从而深刻理解其作为物理量的客观性——即它的值不应因观测者（计算网格）的运动而改变 [@problem_id:3542191]。", "problem": "考虑计算岩土力学中的大变形问题，采用任意拉格朗日-欧拉 (ALE) 框架。设空间坐标表示为 $x = (x_1, x_2) \\in \\mathbb{R}^2$，时间表示为 $t \\in \\mathbb{R}$。一个光滑的空间二阶张量场 $T(x,t) \\in \\mathbb{R}^{2 \\times 2}$，其分量由下式给出：\n$$\nT_{11}(x,t) = \\sin(\\alpha\\, t) + x_1^2 + x_2,\\quad\nT_{12}(x,t) = T_{21}(x,t) = \\tfrac{1}{2}\\cos(\\beta\\, t)\\, x_1 - \\tfrac{1}{4} x_2^2,\\quad\nT_{22}(x,t) = \\mathrm{e}^{\\mu\\, t} + x_1 x_2,\n$$\n其中 $\\alpha, \\beta, \\mu \\in \\mathbb{R}$ 是给定的常数。\n\n物理运动由一个在空间上仿射的空间速度场 $v^{m}(x,t) \\in \\mathbb{R}^2$ 描述，\n$$\nv^{m}(x,t) = B\\, x + c,\n$$\n其中 $B \\in \\mathbb{R}^{2 \\times 2}$ 和 $c \\in \\mathbb{R}^2$ 是不依赖于时间的常数。计算网格绕原点以角速度 $\\omega_g \\in \\mathbb{R}$ 进行刚性旋转，因此网格速度为\n$$\nv^{g}(x,t) = W_g\\, x,\\quad\\text{with}\\quad W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}.\n$$\n\n仅从基本定义出发，即空间张量场沿物理运动的物质时间导数是沿粒子轨迹的时间导数，以及不同描述之间的变量变换会引入带有相应输运速度的链式法则，完成以下任务：\n\n1. 使用固定空间点上的时间变化率和物理对流输运，推导 $T(x,t)$ 沿物理运动的物质时间导数的分量表达式。将该表达式完全用 $x$、$t$、固定 $x$ 处的 $\\partial T/\\partial t$、$T$ 的空间梯度以及 $v^{m}(x,t)$ 来表示。\n\n2. 使用固定网格坐标上的时间变化率和相对对流输运，推导同一个物质时间导数的分量表达式。将该表达式完全用 $x$、$t$、固定网格坐标上的时间变化率、$T$ 的空间梯度以及相对速度 $v^{r}(x,t) = v^{m}(x,t) - v^{g}(x,t)$ 来表示。\n\n3. 实现这两种表达式，并对下面的每个测试用例进行验证，确保即使在网格发生刚性旋转时，它们在数值容差 $\\delta = 10^{-10}$ 内也相等。对于给定的物理运动，此验证构成了所计算的物质时间导数相对于网格刚性运动的客观性检验。\n\n使用以下参数值：\n- 场参数：$\\alpha = 0.8$，$\\beta = 1.3$，$\\mu = 0.4$。\n- 默认物理速度参数（除非在测试用例中被覆盖）：$B = \\begin{bmatrix} d  s \\\\ -s  d \\end{bmatrix}$，其中 $d = 0.15$，$s = 0.35$，以及 $c = \\begin{bmatrix} 0.1 \\\\ -0.2 \\end{bmatrix}$。\n\n测试套件：\n- 用例 1：$x = (0.3, -0.5)$，$t = 0.7$，$\\omega_g = 1.2$，使用默认的 $B$ 和 $c$。\n- 用例 2：$x = (-1.0, 2.0)$，$t = 0.25$，$\\omega_g = 0.0$，使用默认的 $B$ 和 $c$。\n- 用例 3：$x = (2.0, 2.0)$，$t = 1.5$，$\\omega_g = 50.0$，使用默认的 $B$ 和 $c$。\n- 用例 4：$x = (0.0, 0.0)$，$t = 1.0$，$\\omega_g = -3.5$，使用默认的 $B$ 和 $c$。\n- 用例 5（纯刚体物理运动）：$x = (1.2, -0.7)$，$t = 0.9$，$\\omega_g = 4.0$，$B = \\begin{bmatrix} 0  s_0 \\\\ -s_0  0 \\end{bmatrix}$，其中 $s_0 = 2.0$，以及 $c = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$。\n\n对于每个用例，计算两种 $T$ 的物质时间导数实现之间的最大分量绝对差值，并返回一个布尔值，指示该差值是否严格小于 $\\delta$。\n\n最终输出格式：\n你的程序应产生一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，顺序与上述用例一致，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_k$ 是一个布尔值。", "solution": "该问题要求在任意拉格朗日-欧拉 (ALE) 框架中，推导并实现空间张量场物质时间导数的两种不同但等价的表达式。然后，必须对这两种表达式的等价性进行数值验证。\n\n一个表示为 $T(x,t)$ 的空间张量场，是空间坐标 $x \\in \\mathbb{R}^2$ 和时间 $t \\in \\mathbb{R}$ 的函数。物质时间导数 $\\frac{DT}{Dt}$ 衡量的是随物质粒子运动的观察者所感受到的该场的变化率。粒子的路径由 $x = \\chi_p(X, t)$ 给出，其中 $X$ 是标识该粒子的标签（例如，其在 $t=0$ 时的位置）。因此，物质的速度为 $v^m = \\frac{d\\chi_p}{dt}$。\n\n**1. 在欧拉描述中的推导**\n\n第一种公式基于纯欧拉描述，其中观察者在空间中是固定的。根据定义，物质时间导数是 $T(x,t)$ 沿粒子路径的全导数：\n$$\n\\frac{DT}{Dt} = \\frac{d}{dt} T(\\chi_p(X, t), t)\n$$\n应用多元链式法则，我们得到：\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T}{\\partial x_k} \\frac{dx_k}{dt} = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m\n$$\n此处，$\\frac{\\partial T}{\\partial t}|_x$ 是在固定点 $x$ 处的局部或空间时间导数，而 $(\\nabla_x T) \\cdot v^m$ 是对流项，表示由于粒子移动到 $T$ 值不同的新位置而引起的 $T$ 的变化。对于二阶张量 $T$，用分量表示法，这可以写为：\n$$\n\\left(\\frac{DT}{Dt}\\right)_{ij} = \\frac{\\partial T_{ij}}{\\partial t}\\bigg|_x + \\sum_{k=1}^{2} \\frac{\\partial T_{ij}}{\\partial x_k} v_k^m\n$$\n我们为给定的张量场 $T(x,t)$ 计算必要的项：\n$T_{11}(x,t) = \\sin(\\alpha t) + x_1^2 + x_2$\n$T_{12}(x,t) = T_{21}(x,t) = \\frac{1}{2}\\cos(\\beta t) x_1 - \\frac{1}{4} x_2^2$\n$T_{22}(x,t) = \\mathrm{e}^{\\mu t} + x_1 x_2$\n\n在固定空间点 $x$ 处的偏时间导数为：\n$$\n\\frac{\\partial T_{11}}{\\partial t} = \\alpha \\cos(\\alpha t) \\quad ; \\quad\n\\frac{\\partial T_{12}}{\\partial t} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 \\quad ; \\quad\n\\frac{\\partial T_{22}}{\\partial t} = \\mu \\mathrm{e}^{\\mu t}\n$$\n空间梯度为：\n$$\n\\nabla_x T_{11} = \\begin{pmatrix} 2x_1 \\\\ 1 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{12} = \\begin{pmatrix} \\frac{1}{2}\\cos(\\beta t) \\\\ -\\frac{1}{2}x_2 \\end{pmatrix} \\quad ; \\quad\n\\nabla_x T_{22} = \\begin{pmatrix} x_2 \\\\ x_1 \\end{pmatrix}\n$$\n物理速度场为 $v^m(x,t) = Bx + c$。设 $v^m = (v_1^m, v_2^m)^T$。第一种公式的分量（我们记为 $\\dot{T}^{(E)}$）是：\n$$\n\\dot{T}^{(E)}_{11} = \\alpha \\cos(\\alpha t) + 2x_1 v_1^m + v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{12} = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + \\frac{1}{2}\\cos(\\beta t) v_1^m - \\frac{1}{2}x_2 v_2^m\n$$\n$$\n\\dot{T}^{(E)}_{22} = \\mu \\mathrm{e}^{\\mu t} + x_2 v_1^m + x_1 v_2^m\n$$\n由于对称性，$\\dot{T}^{(E)}_{21} = \\dot{T}^{(E)}_{12}$。\n\n**2. 在任意拉格朗日-欧拉 (ALE) 描述中的推导**\n\nALE 描述引入了一个可以独立于物质运动的计算网格。网格运动由映射 $x = \\chi_g(\\xi, t)$ 描述，其中 $\\xi$ 是网格上的固定坐标。网格速度为 $v^g = \\frac{\\partial\\chi_g}{\\partial t}|_\\xi$。\n\n在固定网格坐标 $\\xi$ 处场 $T$ 的时间导数为：\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_\\xi = \\frac{d}{dt} T(\\chi_g(\\xi, t), t) = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot \\frac{\\partial \\chi_g}{\\partial t}\\bigg|_\\xi = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g\n$$\n这个基本关系允许我们将局部时间导数 $\\frac{\\partial T}{\\partial t}|_x$ 用基于网格的导数来表示：\n$$\n\\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g\n$$\n将此代入物质导数的欧拉表达式中：\n$$\n\\frac{DT}{Dt} = \\left( \\frac{\\partial T}{\\partial t}\\bigg|_\\xi - (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot v^m = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\n将物质与网格之间的相对速度定义为 $v^r = v^m - v^g$，我们便得到物质导数的 ALE 公式：\n$$\n\\frac{DT}{Dt} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r\n$$\n这个表达式构成了第二种公式。为了实现它，我们必须首先计算项 $\\frac{\\partial T}{\\partial t}|_\\xi$ 和相对速度 $v^r$。对于给定的网格速度 $v^g(x,t) = W_g x$（其中 $W_g = \\omega_g \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix}$），我们有 $v^g = (-\\omega_g x_2, \\omega_g x_1)^T$。$\\frac{\\partial T}{\\partial t}|_\\xi$ 的分量是：\n$$\n\\left(\\frac{\\partial T_{11}}{\\partial t}\\right)_\\xi = \\alpha \\cos(\\alpha t) + (2x_1)(-\\omega_g x_2) + (1)(\\omega_g x_1) = \\alpha \\cos(\\alpha t) + \\omega_g(x_1 - 2x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{12}}{\\partial t}\\right)_\\xi = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 + (\\frac{1}{2}\\cos(\\beta t))(-\\omega_g x_2) + (-\\frac{1}{2}x_2)(\\omega_g x_1) = -\\frac{1}{2}\\beta \\sin(\\beta t) x_1 - \\frac{1}{2}\\omega_g(x_2\\cos(\\beta t) + x_1x_2)\n$$\n$$\n\\left(\\frac{\\partial T_{22}}{\\partial t}\\right)_\\xi = \\mu \\mathrm{e}^{\\mu t} + (x_2)(-\\omega_g x_2) + (x_1)(\\omega_g x_1) = \\mu \\mathrm{e}^{\\mu t} + \\omega_g(x_1^2 - x_2^2)\n$$\n然后，通过将相对对流项 $(\\nabla_x T_{ij}) \\cdot v^r$ 添加到这些表达式中，计算出第二种公式的分量，记为 $\\dot{T}^{(ALE)}$。\n\n**3. 等价性验证**\n两种公式的代数恒等性 $\\dot{T}^{(E)} = \\dot{T}^{(ALE)}$ 可以通过从 ALE 形式出发并代入 $\\frac{\\partial T}{\\partial t}|_\\xi$ 和 $v^r$ 的定义来证明：\n$$\n\\dot{T}^{(ALE)} = \\frac{\\partial T}{\\partial t}\\bigg|_\\xi + (\\nabla_x T) \\cdot v^r = \\left(\\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g \\right) + (\\nabla_x T) \\cdot (v^m - v^g)\n$$\n$$\n= \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^g + (\\nabla_x T) \\cdot v^m - (\\nabla_x T) \\cdot v^g = \\frac{\\partial T}{\\partial t}\\bigg|_x + (\\nabla_x T) \\cdot v^m = \\dot{T}^{(E)}\n$$\n这两种表达式在数学上是恒等的。这证实了物质时间导数是一个客观量，其值不依赖于底层计算网格的运动。问题的数值部分旨在验证这两条不同计算路径的正确实现。在浮点精度限制下，它们的数值结果之间的差异应为零。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and verifies two formulations of the material time derivative\n    for a given tensor field in an ALE setting.\n    \"\"\"\n    \n    # Field parameters\n    alpha = 0.8\n    beta = 1.3\n    mu = 0.4\n    \n    # Numerical tolerance\n    delta = 1e-10\n\n    # Default physical velocity parameters\n    d_def = 0.15\n    s_def = 0.35\n    B_def = np.array([[d_def, s_def], [-s_def, d_def]])\n    c_def = np.array([0.1, -0.2])\n\n    test_cases = [\n        {'x': np.array([0.3, -0.5]), 't': 0.7, 'omega_g': 1.2, 'B': B_def, 'c': c_def},\n        {'x': np.array([-1.0, 2.0]), 't': 0.25, 'omega_g': 0.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([2.0, 2.0]), 't': 1.5, 'omega_g': 50.0, 'B': B_def, 'c': c_def},\n        {'x': np.array([0.0, 0.0]), 't': 1.0, 'omega_g': -3.5, 'B': B_def, 'c': c_def},\n        {'x': np.array([1.2, -0.7]), 't': 0.9, 'omega_g': 4.0, \n         'B': np.array([[0.0, 2.0], [-2.0, 0.0]]), 'c': np.array([0.0, 0.0])},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x, t, omega_g, B, c = case['x'], case['t'], case['omega_g'], case['B'], case['c']\n        x1, x2 = x[0], x[1]\n\n        # --- Calculate velocities ---\n        # Physical velocity: v^m = Bx + c\n        v_m = B @ x + c\n        \n        # Grid velocity: v^g = W_g * x\n        W_g = omega_g * np.array([[0, -1], [1, 0]])\n        v_g = W_g @ x\n        \n        # Relative velocity: v^r = v^m - v^g\n        v_r = v_m - v_g\n\n        # --- Calculate partial derivatives and gradients ---\n        # Partial time derivatives at fixed x\n        dT_dt = np.zeros((2, 2))\n        dT_dt[0, 0] = alpha * np.cos(alpha * t)\n        dT_dt[0, 1] = dT_dt[1, 0] = -0.5 * beta * np.sin(beta * t) * x1\n        dT_dt[1, 1] = mu * np.exp(mu * t)\n\n        # Spatial gradients\n        grad_T11 = np.array([2 * x1, 1.0])\n        grad_T12 = np.array([0.5 * np.cos(beta * t), -0.5 * x2])\n        grad_T22 = np.array([x2, x1])\n\n        # --- Formulation 1: Eulerian ---\n        # DT/Dt = dT/dt|_x + (grad_T) . v_m\n        DT_Dt_E = np.zeros((2, 2))\n        DT_Dt_E[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_m)\n        DT_Dt_E[0, 1] = DT_Dt_E[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_m)\n        DT_Dt_E[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_m)\n\n        # --- Formulation 2: ALE ---\n        # DT/Dt = dT/dt|_xi + (grad_T) . v_r\n        # First, find dT/dt|_xi = dT/dt|_x + (grad_T) . v_g\n        dT_dt_xi = np.zeros((2, 2))\n        dT_dt_xi[0, 0] = dT_dt[0, 0] + np.dot(grad_T11, v_g)\n        dT_dt_xi[0, 1] = dT_dt_xi[1, 0] = dT_dt[0, 1] + np.dot(grad_T12, v_g)\n        dT_dt_xi[1, 1] = dT_dt[1, 1] + np.dot(grad_T22, v_g)\n        \n        # Now, compute the full ALE derivative\n        DT_Dt_ALE = np.zeros((2, 2))\n        DT_Dt_ALE[0, 0] = dT_dt_xi[0, 0] + np.dot(grad_T11, v_r)\n        DT_Dt_ALE[0, 1] = DT_Dt_ALE[1, 0] = dT_dt_xi[0, 1] + np.dot(grad_T12, v_r)\n        DT_Dt_ALE[1, 1] = dT_dt_xi[1, 1] + np.dot(grad_T22, v_r)\n\n        # --- Verification ---\n        # Compute maximum absolute component-wise difference\n        max_abs_diff = np.max(np.abs(DT_Dt_E - DT_Dt_ALE))\n        \n        results.append(max_abs_diff  delta)\n\n    # Print the results in the required format\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n```", "id": "3542191"}]}