{"hands_on_practices": [{"introduction": "应变-位移关系是连续介质运动学分析的基石。本练习提供了一个直接应用这些关系的机会，从一个一般的线性位移场出发，推导应变张量。这个过程不仅是许多解析解和数值单元公式的基础，还有助于学生清晰地分辨引起变形的应变和不产生应变的刚体运动。[@problem_id:3533545]", "problem": "一个饱和土层的均匀平面应变变形可由位移场 $u_{x}=\\alpha x+\\beta y$、$u_{y}=\\gamma x+\\delta y$、$u_{z}=0$ 理想化表示，其中 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 是匀质常数，$(x,y,z)$ 是笛卡尔坐标。假设为小（无穷小）应变，并从以位移梯度表示的无穷小应变的定义出发，推导此变形的小应变张量 $\\epsilon$ 的所有分量。然后，根据匀质正应变、材料线元的剪切畸变、体积应变以及任何对 $\\epsilon$ 没有贡献的刚体运动，解释每个非零分量的物理意义。\n\n最终答案请以完整的 $3\\times 3$ 张量 $\\epsilon$ 形式给出，其元素用 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 的符号表示。不要四舍五入；结果需精确且不带单位。", "solution": "该问题陈述在科学上是合理的、适定的和客观的。它提出了一个连续介质力学中的标准练习，特别是在无穷小应变理论方面。所有必要信息均已提供，问题没有矛盾或歧义。因此，我们可以进行推导和分析。\n\n在笛卡尔坐标 $(x_1, x_2, x_3)$ 中，无穷小应变张量 $\\epsilon_{ij}$ 和位移矢量场 $u_i$ 之间的关系由应变-位移关系式给出：\n$$\n\\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\n其中 $i, j \\in \\{1, 2, 3\\}$。\n\n给定的位移场为：\n$u_x = u_1 = \\alpha x + \\beta y$\n$u_y = u_2 = \\gamma x + \\delta y$\n$u_z = u_3 = 0$\n\n在此，我们将坐标 $(x,y,z)$ 分别与 $(x_1, x_2, x_3)$ 对应。首先，我们计算位移梯度张量 $H_{ij} = \\frac{\\partial u_i}{\\partial x_j}$ 的分量：\n\n$\\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\frac{\\partial u_x}{\\partial y} = \\beta$\n$\\frac{\\partial u_x}{\\partial z} = 0$\n\n$\\frac{\\partial u_y}{\\partial x} = \\gamma$\n$\\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\frac{\\partial u_y}{\\partial z} = 0$\n\n$\\frac{\\partial u_z}{\\partial x} = 0$\n$\\frac{\\partial u_z}{\\partial y} = 0$\n$\\frac{\\partial u_z}{\\partial z} = 0$\n\n因此，位移梯度张量 $\\nabla \\mathbf{u}$ 为：\n$$\n\\nabla \\mathbf{u} =\n\\begin{pmatrix}\n\\frac{\\partial u_x}{\\partial x} & \\frac{\\partial u_x}{\\partial y} & \\frac{\\partial u_x}{\\partial z} \\\\\n\\frac{\\partial u_y}{\\partial x} & \\frac{\\partial u_y}{\\partial y} & \\frac{\\partial u_y}{\\partial z} \\\\\n\\frac{\\partial u_z}{\\partial x} & \\frac{\\partial u_z}{\\partial y} & \\frac{\\partial u_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha & \\beta & 0 \\\\\n\\gamma & \\delta & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n无穷小应变张量 $\\epsilon$ 是位移梯度张量的对称部分，即 $\\epsilon = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$。我们现在来明确计算其分量。\n\n对角分量（正应变）为：\n$\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\alpha$\n$\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\delta$\n$\\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = 0$\n\n非对角分量（剪应变）为：\n$\\epsilon_{xy} = \\epsilon_{yx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} (\\beta + \\gamma)$\n$\\epsilon_{xz} = \\epsilon_{zx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} \\right) = \\frac{1}{2} (0 + 0) = 0$\n$\\epsilon_{yz} = \\epsilon_{zy} = \\frac{1}{2} \\left( \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} \\right) = \\frac{1}{2} (0 + 0) = 0$\n\n将这些分量组合成一个 $3 \\times 3$ 矩阵，无穷小应变张量 $\\epsilon$ 为：\n$$\n\\epsilon =\n\\begin{pmatrix}\n\\alpha & \\frac{1}{2}(\\beta+\\gamma) & 0 \\\\\n\\frac{1}{2}(\\beta+\\gamma) & \\delta & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n\n接下来，我们解释各分量及相关量的物理意义。\n\n**非零应变分量的物理解释：**\n- $\\epsilon_{xx} = \\alpha$：这是沿 $x$ 轴的正应变。它表示初始平行于 $x$ 轴的材料线元的长度变化率。\n- $\\epsilon_{yy} = \\delta$：这是沿 $y$ 轴的正应变，表示初始平行于 $y$ 轴的材料线元的长度变化率。\n- $\\epsilon_{xy} = \\frac{1}{2}(\\beta+\\gamma)$：这是 $x-y$ 平面内的张量剪应变分量。工程剪应变 $\\gamma_{xy}$ 用于衡量沿 $x$ 轴和 $y$ 轴的两个初始垂直线元之间角度的变化，其表达式为 $\\gamma_{xy} = 2 \\epsilon_{xy} = \\beta + \\gamma$。此分量量化了材料在 $x-y$ 平面内的剪切畸变。\n\n零值分量（$\\epsilon_{zz}$、$\\epsilon_{xz}$、$\\epsilon_{yz}$）与“平面应变”条件一致，该条件规定在 $z$ 方向或包含 $z$ 轴的平面内没有变形。\n\n**体积应变：**\n体积应变，或称体胀 $\\epsilon_V$，是应变张量的迹，即 $\\epsilon_V = \\text{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$。它衡量体积的变化率。对于此变形：\n$$\n\\epsilon_V = \\alpha + \\delta + 0 = \\alpha + \\delta\n$$\n这表明材料元的体积会发生变化，除非 $\\alpha = -\\delta$，这种情况对应于 $x-y$ 平面内的等容（体积保持不变）变形。\n\n**刚体运动：**\n位移梯度张量 $\\nabla \\mathbf{u}$ 可以分解为一个对称的应变张量 $\\boldsymbol{\\epsilon}$ 和一个反对称的无穷小转动张量 $\\boldsymbol{\\omega}$：$\\nabla \\mathbf{u} = \\boldsymbol{\\epsilon} + \\boldsymbol{\\omega}$。无穷小转动张量 $\\boldsymbol{\\omega}$ 描述了材料的局部无穷小刚体旋转，它不对应变产生贡献。其计算公式为 $\\boldsymbol{\\omega} = \\frac{1}{2}(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^T)$。\n$$\n\\boldsymbol{\\omega} = \\frac{1}{2} \\left[\n\\begin{pmatrix}\n\\alpha & \\beta & 0 \\\\\n\\gamma & \\delta & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n\\alpha & \\gamma & 0 \\\\\n\\beta & \\delta & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\right]\n=\n\\frac{1}{2}\n\\begin{pmatrix}\n0 & \\beta - \\gamma & 0 \\\\\n\\gamma - \\beta & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\frac{1}{2}(\\beta - \\gamma) & 0 \\\\\n-\\frac{1}{2}(\\beta - \\gamma) & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n非零分量 $\\omega_{xy} = \\frac{1}{2}(\\beta - \\gamma)$ 代表了绕 $z$ 轴的无穷小刚体转动的速率。如果 $\\beta = \\gamma$，则流动是无旋的，剪切被称为“纯剪切”。如果 $\\beta \\neq \\gamma$，则变形包含一个旋转分量。这个刚体转动是整体运动的一部分，但根据定义，它不会引起材料的任何应变。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha & \\frac{1}{2}(\\beta+\\gamma) & 0 \\\\\n\\frac{1}{2}(\\beta+\\gamma) & \\delta & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "3533545"}, {"introduction": "在掌握了基本的应变分析之后，我们可以挑战一个反向问题：设计一个特定的位移场，以实现一个纯粹的应变状态（在此例中为纯体积应变）。这个练习将加深你对应变分解（即分解为体积应变和偏应变）的理解，这一概念在岩土力学中至关重要，是模拟固结和剪切破坏等现象的理论基础。[@problem_id:3533597]", "problem": "一个边长为 $L$ 的均匀、各向同性的立方体试样占据了参考域 $\\Omega = [0,L] \\times [0,L] \\times [0,L]$，其坐标为 $(x,y,z)$。假设运动学由微应变体系控制，其中位移场为 $\\boldsymbol{u}(x,y,z) = \\left(u_{x}(x,y,z), u_{y}(x,y,z), u_{z}(x,y,z)\\right)$，微应变张量由位移梯度的对称部分定义，\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\left(\\nabla \\boldsymbol{u}\\right)^{\\mathsf{T}}\\right).\n$$\n体积应变定义为应变张量的第一不变量（迹），\n$$\n\\epsilon_{v} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz},\n$$\n偏应变张量为\n$$\n\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\epsilon_{v}\\,\\boldsymbol{I}.\n$$\n\n要求你在边界 $\\partial\\Omega$ 上设计位移边界条件，以在 $\\Omega$ 内各处施加一个均匀的纯体积应变 $\\epsilon_{v}$ 且偏应变为零。请基于以上定义和微小变形运动学进行推导。你的设计必须消除刚体旋转和平移。然后，推导出一个用 $(x,y,z)$, $L$, 和 $\\epsilon_{v}$ 表示的单一闭式位移场 $\\boldsymbol{u}(x,y,z)$，该位移场与你的边界条件一致，并能产生所需的均匀应变状态。最后，从第一性原理出发，验证所得的应变场在 $\\Omega$ 内处处满足 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\epsilon_{v}$ 和 $\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$。\n\n位移分量以米为单位。无需进行数值计算；请以单一解析表达式的形式提供最终的位移场。在方框内的最终答案中不要包含单位。", "solution": "用户希望找到一个在立方体域内产生指定均匀应变状态的位移场。\n\n### 第1步：提取已知条件\n-   **域**：占据参考域 $\\Omega = [0,L] \\times [0,L] \\times [0,L]$ 的立方体试样。\n-   **坐标**：$(x,y,z)$。\n-   **运动学**：微应变体系。\n-   **位移场**：$\\boldsymbol{u}(x,y,z) = \\left(u_{x}(x,y,z), u_{y}(x,y,z), u_{z}(x,y,z)\\right)$。\n-   **微应变张量定义**：$\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\left(\\nabla \\boldsymbol{u}\\right)^{\\mathsf{T}}\\right)$。\n-   **体积应变定义**：$\\epsilon_{v} = \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$。\n-   **偏应变张量定义**：$\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\epsilon_{v}\\,\\boldsymbol{I}$。\n-   **要求的应变状态**：在 $\\Omega$ 内处处为均匀纯体积应变 $\\epsilon_{v}$ 且偏应变为零。这意味着 $\\epsilon_{v}$ 是一个常数，并且对于所有 $(x,y,z) \\in \\Omega$，$\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$。\n-   **约束条件**：设计的位移边界条件必须消除刚体旋转和平移。\n-   **要求输出**：单一的闭式位移场 $\\boldsymbol{u}(x,y,z)$ 以及对所得应变状态的验证。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它使用了连续介质力学和微应变理论的标准定义。该问题是适定的；特定的均匀应变状态要求，结合消除刚体运动的条件，足以确定唯一的位移场。问题陈述客观，并使用精确的数学语言。这是运动学中一个标准的、非平凡的练习，并且不包含说明中列出的任何使其无效的缺陷。\n\n### 第3步：结论和行动\n该问题有效。将提供完整的解答。\n\n### 位移场的推导\n\n问题要求一个应变状态，其特征是均匀的体积应变 $\\epsilon_v$ 和为零的偏应变 $\\boldsymbol{\\varepsilon}'$。条件 $\\boldsymbol{\\varepsilon}' = \\boldsymbol{0}$ 为应变张量 $\\boldsymbol{\\varepsilon}$ 提供了一个直接的关系。根据偏应变的定义：\n$$\n\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\epsilon_{v}\\,\\boldsymbol{I} = \\boldsymbol{0}\n$$\n这意味着应变张量必须是球形的（或膨胀的）：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{3}\\epsilon_{v}\\,\\boldsymbol{I}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量。在矩阵形式中，相对于笛卡尔坐标系 $(x,y,z)$，这表示为：\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} & \\varepsilon_{xy} & \\varepsilon_{xz} \\\\ \\varepsilon_{yx} & \\varepsilon_{yy} & \\varepsilon_{yz} \\\\ \\varepsilon_{zx} & \\varepsilon_{zy} & \\varepsilon_{zz} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}\\epsilon_{v} & 0 & 0 \\\\ 0 & \\frac{1}{3}\\epsilon_{v} & 0 \\\\ 0 & 0 & \\frac{1}{3}\\epsilon_{v} \\end{pmatrix}\n$$\n因此，应变张量的分量为：\n$$\n\\varepsilon_{xx} = \\varepsilon_{yy} = \\varepsilon_{zz} = \\frac{1}{3}\\epsilon_{v}\n$$\n$$\n\\varepsilon_{xy} = \\varepsilon_{yz} = \\varepsilon_{zx} = 0\n$$\n现在，我们使用微应变-位移关系将这些应变分量与位移场 $\\boldsymbol{u}$ 联系起来：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{1}{3}\\epsilon_{v} \\quad (1)\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{1}{3}\\epsilon_{v} \\quad (2)\n$$\n$$\n\\varepsilon_{zz} = \\frac{\\partial u_z}{\\partial z} = \\frac{1}{3}\\epsilon_{v} \\quad (3)\n$$\n对于剪切分量：\n$$\n2\\varepsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = 0 \\quad (4)\n$$\n$$\n2\\varepsilon_{yz} = \\frac{\\partial u_y}{\\partial z} + \\frac{\\partial u_z}{\\partial y} = 0 \\quad (5)\n$$\n$$\n2\\varepsilon_{zx} = \\frac{\\partial u_z}{\\partial x} + \\frac{\\partial u_x}{\\partial z} = 0 \\quad (6)\n$$\n我们分别对等式 $(1)$、$(2)$ 和 $(3)$ 关于 $x$、$y$ 和 $z$ 进行积分，以找到位移分量的一般形式：\n$$\nu_x(x,y,z) = \\frac{1}{3}\\epsilon_{v}x + f(y,z)\n$$\n$$\nu_y(x,y,z) = \\frac{1}{3}\\epsilon_{v}y + g(x,z)\n$$\n$$\nu_z(x,y,z) = \\frac{1}{3}\\epsilon_{v}z + h(x,y)\n$$\n其中 $f$、$g$ 和 $h$ 是任意的积分函数。将这些形式代入剪切应变关系可得：\n$$\n\\frac{\\partial f}{\\partial y} + \\frac{\\partial g}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial g}{\\partial z} + \\frac{\\partial h}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial h}{\\partial x} + \\frac{\\partial f}{\\partial z} = 0\n$$\n这些是零应变场的协调方程。场 $(f,g,h)$ 的通解对应于一个刚体运动，可以表示为一个恒定平移向量 $\\boldsymbol{d} = (d_x, d_y, d_z)$ 和一个微小转动 $\\boldsymbol{\\omega} \\times \\boldsymbol{x}$ 的叠加，其中 $\\boldsymbol{\\omega} = (\\omega_x, \\omega_y, \\omega_z)$ 是微小转动向量，$\\boldsymbol{x}=(x,y,z)$。\n所以，最一般的位移场是：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\frac{1}{3}\\epsilon_v \\boldsymbol{x} + \\boldsymbol{d} + \\boldsymbol{\\omega} \\times \\boldsymbol{x}\n$$\n以分量形式表示：\n$$\nu_x = \\frac{1}{3}\\epsilon_{v}x + d_x + \\omega_y z - \\omega_z y\n$$\n$$\nu_y = \\frac{1}{3}\\epsilon_{v}y + d_y + \\omega_z x - \\omega_x z\n$$\n$$\nu_z = \\frac{1}{3}\\epsilon_{v}z + d_z + \\omega_x y - \\omega_y x\n$$\n问题要求我们设计边界条件以消除刚体运动。这意味着我们必须施加约束，使得 $\\boldsymbol{d} = \\boldsymbol{0}$ 和 $\\boldsymbol{\\omega} = \\boldsymbol{0}$。\n为了消除平移（$\\boldsymbol{d}$），我们可以固定某一点的位移。一个方便的选择是原点 $(0,0,0)$：\n$$\n\\boldsymbol{u}(0,0,0) = \\boldsymbol{0}\n$$\n将 $(x,y,z)=(0,0,0)$ 代入通解得出 $\\boldsymbol{u}(0,0,0) = \\boldsymbol{d}$。因此，该条件强制 $\\boldsymbol{d} = \\boldsymbol{0}$。\n\n为了消除旋转（$\\boldsymbol{\\omega}$），我们必须约束旋转自由度。这可以通过固定其他点的位移来实现。例如，通过固定 $x$ 轴上一点（比如 $(L,0,0)$）位移的两个分量，我们可以确定两个旋转分量：\n在 $\\boldsymbol{d}=\\boldsymbol{0}$ 的情况下，我们有 $u_y(L,0,0) = \\omega_z L$ 和 $u_z(L,0,0) = -\\omega_y L$。设置 $u_y(L,0,0)=0$ 和 $u_z(L,0,0)=0$ 会强制 $\\omega_z=0$ 和 $\\omega_y=0$（因为 $L \\neq 0$）。\n为了找到最后一个分量，我们可以固定 $y$ 轴上一点（比如 $(0,L,0)$）的一个分量：\n在 $\\omega_y=\\omega_z=0$ 的情况下，我们有 $u_z(0,L,0) = \\omega_x L$。设置 $u_z(0,L,0)=0$ 会强制 $\\omega_x=0$。\n\n在 $\\boldsymbol{d}=\\boldsymbol{0}$ 和 $\\boldsymbol{\\omega}=\\boldsymbol{0}$ 的情况下，产生所需应变状态且没有刚体运动的唯一位移场是：\n$$\n\\boldsymbol{u}(x,y,z) = \\frac{1}{3}\\epsilon_{v}\\boldsymbol{x}\n$$\n其分量为：\n$$\nu_x(x,y,z) = \\frac{1}{3}\\epsilon_{v}x\n$$\n$$\nu_y(x,y,z) = \\frac{1}{3}\\epsilon_{v}y\n$$\n$$\nu_z(x,y,z) = \\frac{1}{3}\\epsilon_{v}z\n$$\n产生该场的边界条件是狄利克雷边界条件，其中位移是根据以下公式在整个边界 $\\partial\\Omega$ 上指定的：\n$$\n\\boldsymbol{u}(\\boldsymbol{x})|_{\\partial\\Omega} = \\frac{1}{3}\\epsilon_v \\boldsymbol{x}|_{\\partial\\Omega}\n$$\n这些边界条件唯一地确定了域内的位移场，并内在地满足了消除刚体运动所需的约束条件。立方体的边长 $L$ 定义了边界 $\\partial\\Omega$，但它不出现在通用点 $(x,y,z)$ 处位移场的表达式中。\n\n### 验证\n\n最后，我们必须从第一性原理出发，验证该位移场能产生所需的应变状态。\n位移场为 $\\boldsymbol{u}(x,y,z) = \\left(\\frac{1}{3}\\epsilon_{v}x, \\frac{1}{3}\\epsilon_{v}y, \\frac{1}{3}\\epsilon_{v}z\\right)$。\n首先，我们计算位移梯度张量 $\\nabla \\boldsymbol{u}$：\n$$\n\\nabla \\boldsymbol{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x} & \\frac{\\partial u_x}{\\partial y} & \\frac{\\partial u_x}{\\partial z} \\\\ \\frac{\\partial u_y}{\\partial x} & \\frac{\\partial u_y}{\\partial y} & \\frac{\\partial u_y}{\\partial z} \\\\ \\frac{\\partial u_z}{\\partial x} & \\frac{\\partial u_z}{\\partial y} & \\frac{\\partial u_z}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}\\epsilon_{v} & 0 & 0 \\\\ 0 & \\frac{1}{3}\\epsilon_{v} & 0 \\\\ 0 & 0 & \\frac{1}{3}\\epsilon_{v} \\end{pmatrix} = \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\n$$\n微应变张量 $\\boldsymbol{\\varepsilon}$ 是 $\\nabla \\boldsymbol{u}$ 的对称部分：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I} + \\left(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\\right)^{\\mathsf{T}}\\right)\n$$\n由于单位张量是对称的，$(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I})^{\\mathsf{T}} = \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}$。因此：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I} + \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\\right) = \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\n$$\n现在，我们验证应变状态的两个条件：\n1.  **体积应变：**\n    体积应变是 $\\boldsymbol{\\varepsilon}$ 的迹：\n    $$\n    \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\operatorname{tr}\\left(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\\right) = \\frac{1}{3}\\epsilon_{v} \\operatorname{tr}(\\boldsymbol{I}) = \\frac{1}{3}\\epsilon_{v}(1+1+1) = \\epsilon_{v}\n    $$\n    这在 $\\Omega$ 内处处成立，符合要求。\n\n2.  **偏应变：**\n    偏应变张量为 $\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I}$。代入我们的结果：\n    $$\n    \\boldsymbol{\\varepsilon}' = \\left(\\frac{1}{3}\\epsilon_{v}\\boldsymbol{I}\\right) - \\frac{1}{3}(\\epsilon_{v})\\boldsymbol{I} = \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I} - \\frac{1}{3}\\epsilon_{v}\\boldsymbol{I} = \\boldsymbol{0}\n    $$\n    这也在 $\\Omega$ 内处处成立，符合要求。\n\n推导出的位移场是正确的，并满足问题的所有条件。", "answer": "$$\n\\boxed{\n\\boldsymbol{u}(x,y,z) = \\begin{pmatrix}\n\\frac{1}{3} \\epsilon_{v} x \\\\\n\\frac{1}{3} \\epsilon_{v} y \\\\\n\\frac{1}{3} \\epsilon_{v} z\n\\end{pmatrix}\n}\n$$", "id": "3533597"}, {"introduction": "本练习将连续介质理论与有限元方法 (FEM) 的离散世界联系起来。面片检验 (Patch Test) 是确保数值单元能够精确表示基本变形模式的一个基本验证工具。通过这个动手编程实践，你将验证一个线性三角形单元是否能正确再现一个恒定应变状态，这是任何用于岩土力学分析的可靠有限元代码都必须满足的“金标准”。[@problem_id:3533534]", "problem": "考虑一个在有限元法 (FEM) 中使用线性三角形单元的二维小应变斑块检验。在位移场分量为 $u(x,y)$ 和 $v(x,y)$ 的一点，无穷小应变张量由对称梯度定义为：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right),\n$$\n其中位移向量为 $\\boldsymbol{u} = [u,v]^{\\mathsf{T}}$，应变分量为 $\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}$, $\\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}$ 和 $\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$。常应变三角形 (Constant Strain Triangle, CST) 是一种线性三角形单元，在线性位移场下，其形函数能在每个单元内产生一个常应变场。\n\n您必须为一个由2个线性三角形单元组成、覆盖单位正方形的网格演示斑块检验。节点坐标（单位：米）如下：\n- 节点 $1$：$(0,0)$，\n- 节点 $2$：$(1,0)$，\n- 节点 $3$：$(1,1)$，\n- 节点 $4$：$(0,1)$。\n\n单元连接关系为：\n- 单元 $1$：$(1,2,3)$，\n- 单元 $2$：$(1,3,4)$。\n\n对于一个分量为 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 的均匀目标小应变场、一个以米为单位的刚体平移 $\\boldsymbol{t} = (t_x, t_y)$ 以及一个以弧度为单位的小角度刚体转动 $\\theta$，通过叠加这些运动学贡献来定义节点位移场：\n$$\nu(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x, \\quad v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y.\n$$\n该场将对称应变与刚体部分（平移和转动）分离开来。在无穷小应变假设下，刚体部分不得对应变 $\\boldsymbol{\\varepsilon}$ 产生贡献。\n\n您的程序必须：\n- 使用从单元的线性形函数推导出的应变-位移关系，计算每个单元中的应变。\n- 对于每个测试用例，验证所计算的单元应变在每个单元的每个应变分量的绝对容差 $\\tau = 10^{-12}$ 内，等于目标均匀应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$。\n- 为每个测试用例返回一个布尔值，指明斑块中的两个单元是否都通过了检验（即，所有分量级别的比较都在容差范围内满足）。\n\n使用以下四组参数设计测试套件：\n- 测试用例 $1$（一般常应变，无刚体运动）：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$，$\\boldsymbol{t} = (0,0)$，$\\theta = 0$。\n- 测试用例 $2$（一般常应变加刚体平移）：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-2}, -2\\times 10^{-2}, 5\\times 10^{-3})$，$\\boldsymbol{t} = (3\\times 10^{-1}, -10^{-1})$，$\\theta = 0$。\n- 测试用例 $3$（纯刚体转动，零应变）：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (0,0,0)$，$\\boldsymbol{t} = (0,0)$，$\\theta = 2\\times 10^{-2}$。\n- 测试用例 $4$（极小常应变，无刚体运动）：$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}) = (10^{-12}, -10^{-12}, 5\\times 10^{-13})$，$\\boldsymbol{t} = (0,0)$，$\\theta = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$）的结果，其中每个 $result_i$ 是一个布尔值，表示测试用例 $i$ 是否通过了斑块检验。", "solution": "该问题要求对一个由两个线性三角形单元组成的二维网格执行斑块检验。斑块检验是有限元法 (FEM) 中的一个基本验证工具，用于确保单元公式能够精确再现常应变状态，这是保证收敛性的一个必要条件。\n\n该检验的核心原理是在一个单元“斑块”上施加一个线性位移场。线性位移场对应于常应变场。然后使用 FEM 程序根据指定的节点位移计算每个单元内的应变。如果单元公式正确，则每个单元中计算出的应变必须等于推导出位移时所用的常应变。无论网格几何形状如何，以及是否叠加了任何刚体运动（平移和转动），此条件都必须成立，前提是该运动与基本的小应变/小转动假设相符。\n\n问题将线性位移场 $(\\boldsymbol{u})$ 定义为常应变状态 $(\\boldsymbol{\\varepsilon})$ 和小刚体运动（平移 $\\boldsymbol{t}$ 和转动角 $\\theta$）的叠加。点 $(x,y)$ 处的位移分量 $u(x,y)$ 和 $v(x,y)$ 由以下公式给出：\n$$ u(x,y) = \\varepsilon_{xx}\\,x + \\varepsilon_{xy}\\,y - \\theta\\,y + t_x $$\n$$ v(x,y) = \\varepsilon_{xy}\\,x + \\varepsilon_{yy}\\,y + \\theta\\,x + t_y $$\n此处，$(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 是目标常应变张量的分量，$(t_x, t_y)$ 是刚体平移向量的分量，而 $\\theta$ 是小刚体转动角。从解析上讲，由此位移场导出的无穷小应变分量确实是 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\varepsilon_{xy}$，因为刚体运动项对应变没有贡献。\n\n解决方案的步骤是为常应变三角形 (CST)（也称为线性三角形单元）实现标准的 FEM 应变计算。对于一个节点 $i, j, k$ 坐标分别为 $(x_i, y_i)$、$(x_j, y_j)$ 和 $(x_k, y_k)$ 的 CST 单元，其内部的位移场是通过节点位移进行线性插值得到的。这种线性插值导致整个单元内产生一个常应变场。\n\n单元的应变向量 $\\boldsymbol{\\varepsilon}^e$ 与其节点位移向量 $\\boldsymbol{d}^e$ 之间的关系由以下矩阵方程给出：\n$$ \\boldsymbol{\\varepsilon}^e = \\boldsymbol{B} \\boldsymbol{d}^e $$\n在我们的二维情况下，一个三节点单元的节点位移向量为 $\\boldsymbol{d}^e = [u_i, v_i, u_j, v_j, u_k, v_k]^{\\mathsf{T}}$。使用工程剪切应变定义 $\\gamma_{xy} = 2\\varepsilon_{xy}$，应变向量为 $\\boldsymbol{\\varepsilon}^e = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$。应变-位移矩阵 $\\boldsymbol{B}$ 是节点坐标的函数：\n$$\n\\boldsymbol{B} = \\frac{1}{2A}\n\\begin{bmatrix}\ny_j-y_k & 0 & y_k-y_i & 0 & y_i-y_j & 0 \\\\\n0 & x_k-x_j & 0 & x_i-x_k & 0 & x_j-x_i \\\\\nx_k-x_j & y_j-y_k & x_i-x_k & y_k-y_i & x_j-x_i & y_i-y_j\n\\end{bmatrix}\n$$\n其中 $A$ 是单元的面积，计算公式为 $2A = x_i(y_j - y_k) + x_j(y_k - y_i) + x_k(y_i - y_j)$。为确保公式正确，节点 $i, j, k$ 必须按逆时针顺序排列。\n\n解决该问题的算法如下：\n1.  定义网格几何：存储节点1、2、3、4的节点坐标以及单元1和2的单元连接关系。给定的连接关系，单元1为(1,2,3)，单元2为(1,3,4)，均为逆时针顺序，确保面积计算为正值。\n2.  遍历所提供的四个测试用例。对每个用例：\n    a. 定义目标应变 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$、平移 $(t_x, t_y)$ 和转动 $\\theta$ 的参数。\n    b. 使用解析位移场方程计算网格中四个节点的精确节点位移 ($u_i, v_i$)。\n    c. 对斑块中的两个单元中的每一个：\n        i. 检索其三个节点的坐标。\n        ii. 使用这些坐标构建应变-位移矩阵 $\\boldsymbol{B}$。两个单元的面积 $A$ 均为 $0.5$ m$^2$。\n        iii. 从预先计算的全局节点位移中组装单元的节点位移向量 $\\boldsymbol{d}^e$。\n        iv. 通过矩阵-向量乘积 $\\boldsymbol{B} \\boldsymbol{d}^e$ 计算单元内的常应变向量。这将得到工程应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})$。通过除以2将工程剪切应变 $\\gamma_{xy}$ 转换为张量剪切应变 $\\varepsilon_{xy}$。\n        v. 将计算出的三个应变分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 与当前测试用例各自的目标值进行比较。比较时使用绝对容差 $\\tau = 10^{-12}$。\n3.  仅当*两个*单元中的所有三个应变分量都在指定容差内与其目标值匹配时，一个测试用例才被视为“通过”(True)。如果任何比较失败，则该测试用例被标记为“失败”(False)。\n4.  收集所有四个测试用例的布尔结果，并将其格式化为所需的输出字符串。\n\n此过程严格验证了 CST 单元公式能正确再现位移场中的常应变部分，同时对刚体运动不敏感，这是一个被称为 C0 完备性的关键属性，对于单元通过斑块检验至关重要。该实现使用 `numpy` 库来高效处理矩阵和向量运算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a 2D patch test for a mesh of two linear triangular elements.\n    \"\"\"\n    # Global definitions for the mesh\n    nodal_coords = {\n        1: (0.0, 0.0),\n        2: (1.0, 0.0),\n        3: (1.0, 1.0),\n        4: (0.0, 1.0)\n    }\n\n    element_connectivity = {\n        1: (1, 2, 3),  # CCW order\n        2: (1, 3, 4)   # CCW order\n    }\n\n    # Test cases: (eps_xx, eps_yy, eps_xy, t_x, t_y, theta)\n    test_cases = [\n        (1e-2, -2e-2, 5e-3, 0.0, 0.0, 0.0),\n        (1e-2, -2e-2, 5e-3, 3e-1, -1e-1, 0.0),\n        (0.0, 0.0, 0.0, 0.0, 0.0, 2e-2),\n        (1e-12, -1e-12, 5e-13, 0.0, 0.0, 0.0)\n    ]\n\n    tolerance = 1e-12\n    results = []\n\n    def calculate_element_strain(element_node_ids, all_coords, all_displacements):\n        \"\"\"\n        Calculates the constant strain tensor for a single linear triangular element.\n        \"\"\"\n        # 1. Get nodal coordinates for the element\n        n_i, n_j, n_k = element_node_ids\n        (xi, yi), (xj, yj), (xk, yk) = all_coords[n_i], all_coords[n_j], all_coords[n_k]\n\n        # 2. Calculate 2 * Area. Given connectivity is CCW, so area is positive.\n        two_A = xi * (yj - yk) + xj * (yk - yi) + xk * (yi - yj)\n        if abs(two_A)  1e-15:\n            raise ValueError(\"Degenerate element with zero area.\")\n        \n        # 3. Form the strain-displacement matrix B\n        B_matrix = (1.0 / two_A) * np.array([\n            [yj - yk, 0, yk - yi, 0, yi - yj, 0],\n            [0, xk - xj, 0, xi - xk, 0, xj - xi],\n            [xk - xj, yj - yk, xi - xk, yk - yi, xj - xi, yi - yj]\n        ])\n\n        # 4. Form the element nodal displacement vector d_e\n        (ui, vi), (uj, vj), (uk, vk) = all_displacements[n_i], all_displacements[n_j], all_displacements[n_k]\n        d_e = np.array([ui, vi, uj, vj, uk, vk])\n\n        # 5. Calculate engineering strain vector [exx, eyy, gxy]\n        eng_strain = B_matrix @ d_e\n\n        # 6. Convert to tensor strain [exx, eyy, exy] and return\n        tensor_strain = np.array([eng_strain[0], eng_strain[1], eng_strain[2] / 2.0])\n        return tensor_strain\n\n    for case in test_cases:\n        eps_xx_target, eps_yy_target, eps_xy_target, tx, ty, theta = case\n        target_strain = np.array([eps_xx_target, eps_yy_target, eps_xy_target])\n\n        # Calculate displacements for all nodes based on the analytical field\n        all_nodal_displacements = {}\n        for node_id, (x, y) in nodal_coords.items():\n            u = eps_xx_target * x + eps_xy_target * y - theta * y + tx\n            v = eps_xy_target * x + eps_yy_target * y + theta * x + ty\n            all_nodal_displacements[node_id] = (u, v)\n\n        case_passed = True\n        for elem_id, node_ids in element_connectivity.items():\n            # Compute strain for the current element\n            computed_strain = calculate_element_strain(\n                node_ids, nodal_coords, all_nodal_displacements\n            )\n            \n            # Verify if computed strain matches target strain within tolerance\n            # Use rtol=0 because target strains can be zero.\n            if not np.allclose(computed_strain, target_strain, rtol=0, atol=tolerance):\n                case_passed = False\n                break  # If one element fails, the whole patch test case fails\n\n        results.append(case_passed)\n\n    # Format and print the final results as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3533534"}]}