{"hands_on_practices": [{"introduction": "本“动手实践”章节将通过一系列精心设计的问题，帮助你巩固和应用关于初始应力和地应力 $K_0$ 状态的知识。我们从一个基本但至关重要的问题开始，它要求你从最基本的物理原理——静力平衡和自重——出发，推导并计算一个均质土层中的有效应力分布。通过解决这个问题 ([@problem_id:3533868])，你将掌握计算竖向有效应力 $\\sigma'_{v}$ 和利用静止土压力系数 $K_0$ 确定水平有效应力 $\\sigma'_{h}$ 的核心技能，为后续更复杂的分析奠定坚实基础。", "problem": "一个竖向、饱和、横向广延的土体，占据了标高 $z=0$ 的平坦地表下方的半空间，并延伸至 $z=50\\ \\text{m}$。该土柱在其自重作用下是均匀、各向同性且静止的，在所有深度均无侧向变形，表现为静止地应力状态。该连续体受静力平衡和Terzaghi有效应力原理的控制，其中有效应力定义为总应力减去孔隙水压力。在整个深度范围内，土体具有恒定的有效重度 $\\gamma' = 10\\ \\text{kN/m}^3$。静止土压力系数 (K₀) 与深度无关，其值为 $K_0=0.6$。\n\n以重力作用下连续体的竖向平衡和有效应力原理为基本依据，推导土体中的竖向有效应力分布 $\\sigma'_{v}(z)$ 以及由静止地应力条件决定的相关水平有效应力分布 $\\sigma'_{h}(z)$。然后，计算在深度 $z=10\\ \\text{m}$、$z=30\\ \\text{m}$ 和 $z=50\\ \\text{m}$ 处的 $\\sigma'_{v}$ 和 $\\sigma'_{h}$ 的值。\n\n所有应力值均以千帕 (kPa) 为单位表示。将数值结果四舍五入至四位有效数字。按顺序 $\\big[\\sigma'_{v}(10\\ \\text{m}),\\ \\sigma'_{h}(10\\ \\text{m}),\\ \\sigma'_{v}(30\\ \\text{m}),\\ \\sigma'_{h}(30\\ \\text{m}),\\ \\sigma'_{v}(50\\ \\text{m}),\\ \\sigma'_{h}(50\\ \\text{m})\\big]$ 将最终答案表示为单行矩阵。", "solution": "用户的要求是岩土力学领域中的一个适定问题，具体涉及初始地应力的确定。问题陈述具有科学依据、自成体系且客观。它基于静力平衡基本原理和Terzaghi的有效应力原理，这些都是土力学的基石。所有提供的数据都符合物理实际，且足以推导出唯一解。因此，该问题被认为是有效的，并将提供完整的解答。\n\n主要目标是推导均匀土体的竖向和水平有效应力分布 $\\sigma'_{v}(z)$ 和 $\\sigma'_{h}(z)$，然后计算它们在指定深度处的值。\n\n首先，我们推导竖向有效应力分布 $\\sigma'_{v}(z)$。我们从自重作用下连续体的竖向静力平衡原理出发。让我们考虑一个高度为 $dz$、水平单位面积为 $A=1$ 的无限小土体单元，该单元位于地表下深度 $z$ 处。$z$ 轴从地表 $z=0$ 处开始，向下为正。根据岩土工程的符号约定，压应力为正。\n\n作用在该单元上的竖向力包括：\n$1$. 由总竖向应力 $\\sigma_v(z)$ 引起的作用于顶面的向下的力。\n$2$. 由总竖向应力 $\\sigma_v(z+dz)$ 引起的作用于底面的向上的力。\n$3$. 由单元自重引起的向下的力，其大小为单元体积（$A \\cdot dz = dz$）乘以土的总重度 $\\gamma_t$。\n\n为满足静力平衡，竖向力的总和必须为零：\n$$ \\sigma_v(z) \\cdot A - \\sigma_v(z+dz) \\cdot A + \\gamma_t \\cdot A \\cdot dz = 0 $$\n两边同除以面积 $A$ 并重新整理可得：\n$$ \\frac{\\sigma_v(z+dz) - \\sigma_v(z)}{dz} = \\gamma_t $$\n在极限情况下，当 $dz \\to 0$ 时，这成为竖向平衡的微分方程：\n$$ \\frac{d\\sigma_v}{dz} = \\gamma_t $$\n为了求得总竖向应力 $\\sigma_v(z)$，我们将此方程从地表（$z=0$）积分到任意深度 $z$。边界条件是自由地表的应力为零，即 $\\sigma_v(0)=0$。\n$$ \\int_{\\sigma_v(0)}^{\\sigma_v(z)} d\\sigma_v = \\int_0^z \\gamma_t d\\zeta $$\n$$ \\sigma_v(z) - 0 = \\gamma_t z $$\n因此，任意深度 $z$ 处的总竖向应力为 $\\sigma_v(z) = \\gamma_t z$。\n\n接下来，我们应用Terzaghi的有效应力原理，该原理指出总应力是有效应力与孔隙水压力之和：$\\sigma = \\sigma' + u$。\n对于竖向应力，表达式为：\n$$ \\sigma_v(z) = \\sigma'_v(z) + u(z) $$\n土是饱和的，且处于静水压力条件下，因此深度 $z$ 处的孔隙水压力由 $u(z) = \\gamma_w z$ 给出，其中 $\\gamma_w$ 是水的重度。饱和土的总重度 $\\gamma_t$ 与有效（或浮）重度 $\\gamma'$ 的关系为 $\\gamma_t = \\gamma' + \\gamma_w$。将这些关系代入总应力方程中：\n$$ \\sigma'_v(z) + \\gamma_w z = (\\gamma' + \\gamma_w) z $$\n求解竖向有效应力 $\\sigma'_v(z)$ 可得：\n$$ \\sigma'_v(z) = (\\gamma' + \\gamma_w) z - \\gamma_w z = \\gamma' z $$\n问题给出了恒定的有效重度 $\\gamma' = 10\\ \\text{kN/m}^3$。因此，竖向有效应力分布为：\n$$ \\sigma'_{v}(z) = 10z $$\n其中 $z$ 的单位是米，$\\sigma'_{v}(z)$ 的单位是千帕 (kPa)，因为 $1\\ \\text{kN/m}^2 = 1\\ \\text{kPa}$。\n\n其次，我们推导水平有效应力分布 $\\sigma'_{h}(z)$。问题指出土体处于静止地应力状态，其特征为静止土压力系数 $K_0$。根据定义，$K_0$ 是水平有效应力与竖向有效应力的比值：\n$$ K_0 = \\frac{\\sigma'_{h}}{\\sigma'_{v}} $$\n这个条件源于在自重沉积和固结过程中侧向应变为零 ($\\epsilon_h=0$) 的约束。\n重新整理该定义，我们得到水平有效应力：\n$$ \\sigma'_{h}(z) = K_0 \\sigma'_{v}(z) $$\n代入推导出的 $\\sigma'_{v}(z)$ 表达式和给定的 $K_0 = 0.6$ 值：\n$$ \\sigma'_{h}(z) = K_0 \\gamma' z = (0.6)(10)z = 6z $$\n同样地，$z$ 的单位是米，$\\sigma'_{h}(z)$ 的单位是 kPa。\n\n最后，我们计算在指定深度 $z=10\\ \\text{m}$、$z=30\\ \\text{m}$ 和 $z=50\\ \\text{m}$ 处的所需应力值，并将结果四舍五入至四位有效数字。\n\n在深度 $z=10\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(10) = 10 \\times 10 = 100\\ \\text{kPa} $$\n$$ \\sigma'_{h}(10) = 0.6 \\times \\sigma'_{v}(10) = 0.6 \\times 100 = 60\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $100.0\\ \\text{kPa}$ 和 $60.00\\ \\text{kPa}$。\n\n在深度 $z=30\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(30) = 10 \\times 30 = 300\\ \\text{kPa} $$\n$$ \\sigma'_{h}(30) = 0.6 \\times \\sigma'_{v}(30) = 0.6 \\times 300 = 180\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $300.0\\ \\text{kPa}$ 和 $180.0\\ \\text{kPa}$。\n\n在深度 $z=50\\ \\text{m}$ 处：\n$$ \\sigma'_{v}(50) = 10 \\times 50 = 500\\ \\text{kPa} $$\n$$ \\sigma'_{h}(50) = 0.6 \\times \\sigma'_{v}(50) = 0.6 \\times 500 = 300\\ \\text{kPa} $$\n四舍五入至四位有效数字，这些值为 $500.0\\ \\text{kPa}$ 和 $300.0\\ \\text{kPa}$。\n\n最终答案是包含这六个值的单行矩阵，按指定顺序排列。", "answer": "$$\n\\boxed{\\begin{pmatrix} 100.0  60.00  300.0  180.0  500.0  300.0 \\end{pmatrix}}\n$$", "id": "3533868"}, {"introduction": "在掌握了基本计算之后，我们来探讨一个在计算岩土力学实践中更为微妙且关键的问题。静止土压力系数 $K_0$ 的取值直接影响着初始应力场的准确性，而它的确定方法却不止一种。这个练习 ([@problem_id:3533909]) 将让你对比基于弹性理论（通过泊松比 $\\nu$）和基于土体强度理论（通过有效摩擦角 $\\phi'$）的两种 $K_0$ 计算方法，并分析它们之间的差异及其对数值模型初始化的深远影响，从而培养你在工程建模中的批判性思维。", "problem": "一个在自重作用下的水平广延土体，需要在一个有限元(FE)分析中被初始化为地应力“静止”状态。该土体被理想化为一个承受重力作用的各向同性连续体，在任何结构或开挖作用之前没有侧向变形。静止土压力系数 $K_0$ 定义为有效应力之比 $K_0=\\sigma'_{\\mathrm{h}}/\\sigma'_{\\mathrm{v}}$，其中 $\\sigma'_{\\mathrm{h}}$ 是水平有效应力，而 $\\sigma'_{\\mathrm{v}}$ 是竖向有效应力。在计算岩土力学中，有两种广泛使用但概念上不同的方法来估算 $K_0$：一种是基于固结仪约束下的各向同性线弹性理论，另一种是基于一个仅依赖于峰值有效摩擦角 $\\phi'$ 的、针对正常固结摩擦性土的成熟相关式。\n\n从小应变下的各向同性线弹性本构方程和固结仪边界条件（零侧向应变）出发，推导用泊松比 $\\nu$ 表示的 $K_0$ 表达式。另外，从静止状态下正常固结摩擦性土的公认性状和 Mohr-Coulomb 框架出发，写出仅依赖于 $\\phi'$ 的 $K_0$ 闭合形式表达式。然后，对于一个泊松比 $\\nu=0.3$、摩擦角 $\\phi'=30^\\circ$（角度单位为度）的土体，计算这两种方法所对应的 $K_0$ 值，并确定它们之间的绝对差异 $\\Delta K_0$，定义为 $\\Delta K_0=\\left|K_{0,\\mathrm{friction}}-K_{0,\\mathrm{elastic}}\\right|$。用专业术语讨论这种差异将如何影响有限元模型中地应力场的初始化，包括弹性和塑性参数之间的相容性考虑。\n\n将你计算的 $\\Delta K_0$ 最终数值答案四舍五入至4位有效数字。$K_0$ 是无量纲的；请将最终答案表示为一个不带单位的纯数。", "solution": "该问题是有效的，因为它在科学上基于连续介质力学和土力学的原理，数据充分、提法得当，并且表述客观。\n\n解题过程分为四个部分：第一，从线弹性理论推导静止土压力系数 $K_0$；第二，陈述基于土体摩擦角的 $K_0$ 经验公式；第三，根据给定的土体参数计算这两个值之间的差异；第四，讨论此差异在有限元分析背景下的影响。\n\n**1. 从各向同性线弹性理论推导 $K_0$**\n\n我们从适用于土壤骨架（因此使用有效应力）的各向同性线弹性材料的广义胡克定律开始，其应变分量 ($\\epsilon_{ij}$) 表示为有效应力分量 ($\\sigma'_{ij}$) 的函数：\n$$\n\\epsilon_{ij} = \\frac{1+\\nu}{E} \\sigma'_{ij} - \\frac{\\nu}{E} \\sigma'_{kk} \\delta_{ij}\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比，$\\sigma'_{kk}$ 是有效应力张量的迹（有效正应力之和），$\\delta_{ij}$ 是克罗内克符号。\n\n对于地应力问题，我们将坐标系设置为z轴竖直，x轴和y轴水平。在水平广延土体中，自重作用下的地应力状态是轴对称的。因此，有效应力张量是对角的，主应力与坐标轴对齐。\n竖向有效应力表示为 $\\sigma'_{\\mathrm{v}} = \\sigma'_{zz}$，水平有效应力相等，即 $\\sigma'_{\\mathrm{h}} = \\sigma'_{xx} = \\sigma'_{yy}$。\n\n“静止”或侧限条件由零侧向应变约束定义。该条件源于将土单元理想化为无限半空间中的一部分，其侧向位移受到周围土体的约束。数学上表示为：\n$$\n\\epsilon_{xx} = 0 \\quad \\text{and} \\quad \\epsilon_{yy} = 0\n$$\n\n考虑应变分量 $\\epsilon_{xx}$。其本构关系为：\n$$\n\\epsilon_{xx} = \\frac{1}{E} \\left[ \\sigma'_{xx} - \\nu (\\sigma'_{yy} + \\sigma'_{zz}) \\right]\n$$\n将地应力条件（$\\sigma'_{xx} = \\sigma'_{yy} = \\sigma'_{\\mathrm{h}}$ 和 $\\sigma'_{zz} = \\sigma'_{\\mathrm{v}}$）和侧限应变条件（$\\epsilon_{xx} = 0$）代入此方程，得到：\n$$\n0 = \\frac{1}{E} \\left[ \\sigma'_{\\mathrm{h}} - \\nu (\\sigma'_{\\mathrm{h}} + \\sigma'_{\\mathrm{v}}) \\right]\n$$\n由于 $E \\neq 0$，括号中的项必须为零：\n$$\n\\sigma'_{\\mathrm{h}} - \\nu \\sigma'_{\\mathrm{h}} - \\nu \\sigma'_{\\mathrm{v}} = 0\n$$\n重新整理各项以求解比值 $\\sigma'_{\\mathrm{h}}/\\sigma'_{\\mathrm{v}}$：\n$$\n\\sigma'_{\\mathrm{h}}(1 - \\nu) = \\nu \\sigma'_{\\mathrm{v}}\n$$\n$$\n\\frac{\\sigma'_{\\mathrm{h}}}{\\sigma'_{\\mathrm{v}}} = \\frac{\\nu}{1 - \\nu}\n$$\n根据定义，$K_0 = \\sigma'_{\\mathrm{h}}/\\sigma'_{\\mathrm{v}}$。因此，基于线弹性理论的静止土压力系数表达式为：\n$$\nK_{0,\\mathrm{elastic}} = \\frac{\\nu}{1 - \\nu}\n$$\n\n**2. 基于摩擦强度的 $K_0$ 表达式**\n\n对于正常固结的摩擦性土，一个广泛使用且经过充分检验的经验相关式将 $K_0$ 与峰值有效摩擦角 $\\phi'$ 联系起来。该关系式通常称为 Jaky 公式，其形式如下：\n$$\nK_{0,\\mathrm{friction}} = 1 - \\sin(\\phi')\n$$\n该表达式植根于塑性理论，反映了土体在沉积和固结过程中的极限平衡状态，因此它是一个基于强度的度量，而非基于弹性的度量。\n\n**3. 差异 $\\Delta K_0$ 的计算**\n\n给定土体参数 $\\nu=0.3$ 和 $\\phi'=30^\\circ$。\n\n首先，我们计算 $K_{0,\\mathrm{elastic}}$ 的值：\n$$\nK_{0,\\mathrm{elastic}} = \\frac{0.3}{1 - 0.3} = \\frac{0.3}{0.7} = \\frac{3}{7}\n$$\n\n接着，我们计算 $K_{0,\\mathrm{friction}}$ 的值：\n$$\nK_{0,\\mathrm{friction}} = 1 - \\sin(30^\\circ)\n$$\n由于 $\\sin(30^\\circ) = 0.5$，我们得到：\n$$\nK_{0,\\mathrm{friction}} = 1 - 0.5 = 0.5\n$$\n\n绝对差异 $\\Delta K_0$ 定义为 $\\left|K_{0,\\mathrm{friction}}-K_{0,\\mathrm{elastic}}\\right|$。\n$$\n\\Delta K_0 = \\left| 0.5 - \\frac{3}{7} \\right| = \\left| \\frac{1}{2} - \\frac{3}{7} \\right| = \\left| \\frac{7 - 6}{14} \\right| = \\frac{1}{14}\n$$\n换算成小数，$\\frac{1}{14} \\approx 0.07142857...$。四舍五入到4位有效数字，我们得到：\n$$\n\\Delta K_0 \\approx 0.07143\n$$\n\n**4. 关于有限元初始化的讨论**\n\n计算出的差异 $\\Delta K_0 \\approx 0.07143$ 凸显了在使用诸如线性弹性理想塑性 Mohr-Coulomb 模型这类简单本构模型时，计算岩土力学中的一个基本相容性问题。这类模型需要将弹性参数（例如 $E$, $\\nu$）和塑性参数（例如 $c'$, $\\phi'$, $\\psi$）作为独立的输入。\n\n地应力场的初始化是有限元分析中的第一个关键步骤。其目标是建立一个与体力（重力）平衡并满足边界条件（例如，零侧向位移）的初始有效应力状态。差异的产生是因为在相同的地应力条件下，弹性和塑性参数分别对应着不同的平衡应力状态。\n\n如果使用 $K_0 = K_{0,\\mathrm{elastic}} = \\nu/(1-\\nu) \\approx 0.4286$ 来初始化应力：\n初始有效应力状态 $(\\sigma'_v, \\sigma'_h)$ 与弹性本构定律完全相容。当有限元求解器在第一个计算步（一个“空”步）中施加重力时，计算出的弹性应变 $\\epsilon_{xx}$ 和 $\\epsilon_{yy}$ 将精确为零，这正符合侧限条件的要求。这意味着不会发生伪初始变形或应力重分布。然而，这个 $K_0$ 值可能无法精确代表正常固结土的真实应力状态，而后者用其摩擦特性来描述更为贴切。\n\n如果使用 $K_0 = K_{0,\\mathrm{friction}} = 1-\\sin\\phi' = 0.5$ 来初始化应力：\n对于正常固结的摩擦性土，这个初始有效应力状态在岩土工程上更为真实。然而，它与指定的弹性参数 $\\nu=0.3$ 不相容。当有限元求解器执行其第一次平衡检查时，它将使用弹性参数来计算与初始有效应力相对应的隐式应变。由于 $\\sigma'_h / \\sigma'_v = 0.5 \\neq \\nu/(1-\\nu)$，求解器将计算出非零的侧向弹性应变。这表明初始应力状态不处于弹性平衡状态，从而导致一个“不平衡”力矢量。求解器随后会尝试纠正这种不平衡，这将在任何模拟施工或加载开始之前，导致模型中出现微小但非物理的初始变形和应力调整。\n\n在实践中，这种不相容性通常通过以下两种方式之一来处理：\n1.  使用更真实的 $K_0 = 1-\\sin\\phi'$，接受初始的微小不平衡力，并在第一个“重力加载”步骤后将初始位移重置为零，然后再进行主分析。\n2.  调整其中一个参数以强制实现相容性。例如，如果认为 $K_0=0.5$ 是正确的，则可以为初始化使用一个修正的泊松比 $\\nu_{\\text{init}}$，通过求解 $0.5 = \\nu_{\\text{init}} / (1 - \\nu_{\\text{init}})$ 计算得出 $\\nu_{\\text{init}} = 1/3$。然后，分析将使用真实的材料参数 $\\nu=0.3$ 继续进行。\n\n这种差异强调了简单本构模型的局限性，以及分析人员理解模型参数理论基础的重要性，以确保为数值模拟建立一个有效且稳定的初始状态。更高级的本构模型，如硬化土模型，通常包含应力相关的刚度，这内在地将弹性和塑性响应联系起来，从而缓解了这类不相容性。", "answer": "$$\n\\boxed{0.07143}\n$$", "id": "3533909"}, {"introduction": "最后，我们将理论知识与计算实践相结合，挑战一个更接近真实工程场景的综合性问题。真实的土体往往是分层的，其性质也随深度变化。这个练习 ([@problem_id:3533886]) 要求你设计一个数值程序，为一个具有深度依赖 $K_0(z)$ 分布的土柱建立一个完全自洽的初始地应力场。这需要你将平衡方程、变形协调条件和本构关系整合到一个算法中，是连接理论分析与计算实现的关键一步。", "problem": "任务是为一个在重力作用下的竖向土柱构建一维地应力初始化，该初始化能再现一个预设的随深度变化的静止土压力系数 (K0) 剖面，同时在每个深度都满足以下所有条件：(i) 平衡，(ii) 应变协调，以及 (iii) 线性各向同性弹性范围内的本构一致性。竖向坐标用 $z$ 表示，从地表 $z=0$ 处向下测量。总深度为 $H$。材料按层定义，每层具有恒定的重度和弹性模量。目标静止土压力系数 (K0) 是一个关于深度的函数，可以为常数或随 $z$ 线性变化。一个可选的均布附加荷载作用于地表。所有答案必须使用国际单位制 (SI) 表示，应力单位为帕斯卡（Pascals），位移单位为米（meters）。程序必须输出保留 $3$ 位小数的浮点数。\n\n您的设计必须基于以下基本原理：\n- 连续介质力学的局部静力平衡：在竖直方向上，Cauchy 动量平衡方程简化为一个包含重力体力的一维方程。\n- 一维小应变运动学：竖向应变是竖向位移对深度的导数，侧向应变受静止条件约束。\n- 线性各向同性弹性（Hooke’s law）：正应变通过杨氏模量和泊松比与正应力线性相关。\n\n您的目标是：\n- 施加自重和任何指定表面附加荷载下的竖向平衡，以确定带有地表边界条件的竖向应力剖面 $ \\sigma_v(z) $。\n- 通过设置与预设 $ K_0(z) $ 和计算出的 $ \\sigma_v(z) $ 一致的水平应力 $ \\sigma_h(z) $，来施加目标静止土压力系数。\n- 通过在静止状态下侧向应变为零来施加应变协调，并通过适当的局部弹性参数确保线性各向同性弹性范围内的本构一致性。\n- 计算满足运动协调性 $ w(0) = 0 $ 的竖向应变 $ \\varepsilon_v(z) $ 和竖向位移 $ w(z) $。\n- 对于每个测试用例，报告由底部竖向应力 $ \\sigma_v(H) $、底部水平应力 $ \\sigma_h(H) $ 和底部竖向位移 $ w(H) $ 组成的三元组。\n\n数学和物理定义：\n- 设重度为 $ \\gamma(z) $（单位体积的力），弹性模量为 $ E(z) $，静止土压力系数为 $ K_0(z) $。在每一层中，$ \\gamma(z) $ 和 $ E(z) $ 是常数，而 $ K_0(z) $ 随深度为常数或线性变化。表面附加荷载为 $ q_0 $（在 $ z=0 $ 处施加的均布竖向应力）。\n- 重力体力作用下的竖向平衡方程由带地表边界条件的一维平衡方程给出。目标水平应力受 $ K_0(z) $ 约束。\n- 应变协调要求在静止状态下侧向应变为零，并且竖向应变积分得到竖向位移。\n\n实现要求：\n- 您的数值方法必须沿 $ z $ 从 $ z=0 $ 到 $ z=H $ 对竖向平衡方程进行积分，并使用给定的地表边界条件来获得 $ \\sigma_v(z) $。使用目标 $ K_0(z) $ 来局部确定 $ \\sigma_h(z) $。在线性各向同性弹性中施加协调性和本构一致性，以确定竖向应变 $ \\varepsilon_v(z) $ 和竖向位移 $ w(z) $。使用足够精细的深度离散化，以便为所提供的数据获得稳定且收敛的结果；在 $ z $ 方向上采用均匀离散化是可接受的。\n- 对于每个测试用例，仅报告三元组 $ [\\sigma_v(H), \\sigma_h(H), w(H)] $，所有三个数值均四舍五入到小数点后 $3$ 位。应力单位为帕斯卡，位移单位为米。\n\n测试套件：\n对于每个案例，土柱由 $N$ 层组成，各层厚度为 $h_i$（$i=1,\\dots,N$），使得 $ \\sum_{i=1}^N h_i = H $。在第 $i$ 层内，$ \\gamma(z)=\\gamma_i $ 且 $ E(z)=E_i $。目标 $ K_0(z) $ 为常数 $ K_0(z) = K_{0,c} $ 或线性 $ K_0(z) = K_{0,0} + a z $。所有参数如下：\n\n- 案例 $1$（两层，线性 $K_0$，非零附加荷载）：\n  - $N = 2$，$[h_1,h_2] = [10, 15]$ 米，因此 $ H = 25 $ 米。\n  - $[\\gamma_1,\\gamma_2] = [19000, 21000]$ 牛顿/立方米。\n  - $[E_1,E_2] = [3.0\\times 10^7, 6.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.5 + 0.01 z $。\n  - $ q_0 = 50000 $ 帕斯卡。\n\n- 案例 $2$（单层，常数 $K_0$，零附加荷载）：\n  - $N = 1$，$[h_1] = [20]$ 米，因此 $ H = 20 $ 米。\n  - $[\\gamma_1] = [20000]$ 牛顿/立方米。\n  - $[E_1] = [1.0\\times 10^8]$ 帕斯卡。\n  - $ K_0(z) = 0.4 $。\n  - $ q_0 = 0 $ 帕斯卡。\n\n- 案例 $3$（三层，常数低 $K_0$，非零附加荷载）：\n  - $N = 3$, $[h_1,h_2,h_3] = [5, 5, 5]$ 米，因此 $ H = 15 $ 米。\n  - $[\\gamma_1,\\gamma_2,\\gamma_3] = [18000, 18000, 18000]$ 牛顿/立方米。\n  - $[E_1,E_2,E_3] = [5.0\\times 10^7, 5.0\\times 10^7, 5.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.05 $。\n  - $ q_0 = 10000 $ 帕斯卡。\n\n- 案例 $4$（单层，线性高 $K_0$，零附加荷载）：\n  - $N = 1$, $[h_1] = [30]$ 米，因此 $ H = 30 $ 米。\n  - $[\\gamma_1] = [22000]$ 牛顿/立方米。\n  - $[E_1] = [8.0\\times 10^7]$ 帕斯卡。\n  - $ K_0(z) = 0.6 + 0.004 z $。\n  - $ q_0 = 0 $ 帕斯卡。\n\n最终要求的输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个测试用例对应一个结果。每个结果本身是一个包含三个请求值 $[\\sigma_v(H), \\sigma_h(H), w(H)]$ 的列表，所有数值四舍五入到小数点后 $3$ 位，打印值中不包含单位。例如：\n- $[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$", "solution": "我们推导一个一致的数值地应力初始化方法，该方法能在满足平衡、协调和线性弹性本构关系的同时，再现一个预设的静止土压力系数。\n\n设定竖向坐标轴，使 $ z $ 从地表 $ z=0 $ 处开始向下递增，在基底处为 $ z=H $。设 $ \\gamma(z) $ 表示重度，$ E(z) $ 表示杨氏模量，$ K_0(z) $ 表示目标静止土压力系数。一个表面附加荷载 $ q_0 $ 施加于 $ z=0 $ 处。\n\n步骤 1：竖向应力平衡。\n在准静态条件下且无侧向体力时，竖向的 Cauchy 动量平衡方程简化为\n$$\n\\frac{d \\sigma_v}{d z} = \\gamma(z),\n$$\n其边界条件为\n$$\n\\sigma_v(0) = q_0.\n$$\n这是一个一阶常微分方程。给定按层分段常数的 $ \\gamma(z) $，我们从 $ z=0 $ 积分到 $ z=H $ 得到\n$$\n\\sigma_v(z) = q_0 + \\int_0^z \\gamma(s) \\, ds.\n$$\n在数值上，我们可以在一个均匀的深度网格 $ z_k = k \\,\\Delta z $ 上通过前向欧拉累积来近似该积分\n$$\n\\sigma_v(z_{k+1}) \\approx \\sigma_v(z_k) + \\gamma(z_k) \\,\\Delta z.\n$$\n\n步骤 2：目标静止水平应力。\n目标静止土压力系数被规定为一个函数 $ K_0(z) $，其形式为常数 $ K_0(z)=K_{0,c} $ 或线性 $ K_0(z) = K_{0,0} + a z $。施加\n$$\n\\sigma_h(z) = K_0(z)\\,\\sigma_v(z).\n$$\n\n步骤 3：协调性与本构一致性。\n采用小应变的线性各向同性弹性理论。在主方向上，正应变满足\n$$\n\\varepsilon_i = \\frac{1}{E}\\Big(\\sigma_i - \\nu (\\sigma_j + \\sigma_k)\\Big),\n$$\n对于 $ i\\neq j\\neq k\\in\\{x,y,z\\} $，其中 $ E $ 是杨氏模量，$ \\nu $ 是泊松比。对于一维土柱的静止状态，侧向应变为零：\n$$\n\\varepsilon_x = 0,\\quad \\varepsilon_y = 0.\n$$\n施加 $ \\varepsilon_x = 0 $ 得到\n$$\n0 = \\frac{1}{E}\\Big(\\sigma_h - \\nu (\\sigma_h + \\sigma_v)\\Big) \\;\\Rightarrow\\; \\sigma_h = \\frac{\\nu}{1-\\nu}\\,\\sigma_v.\n$$\n因此，为了与目标静止条件 $ \\sigma_h=K_0 \\sigma_v $ 保持一致，我们必须施加\n$$\nK_0(z) = \\frac{\\nu(z)}{1-\\nu(z)} \\;\\Rightarrow\\; \\nu(z) = \\frac{K_0(z)}{1+K_0(z)}.\n$$\n这种对 $ \\nu(z) $ 的局部选择保证了侧向应变为零，并维持了每个深度处静止应力比的本构一致性。因此，竖向应变为\n$$\n\\varepsilon_v(z) = \\frac{1}{E(z)}\\Big(\\sigma_v(z) - \\nu(z)\\big(\\sigma_h(z) + \\sigma_h(z)\\big)\\Big) = \\frac{1}{E(z)}\\Big(\\sigma_v(z) - 2\\,\\nu(z)\\,\\sigma_h(z)\\Big).\n$$\n给定 $ \\sigma_h(z) = K_0(z)\\,\\sigma_v(z) $ 和 $ \\nu(z) = \\dfrac{K_0(z)}{1+K_0(z)} $，上式简化为\n$$\n\\varepsilon_v(z) = \\frac{\\sigma_v(z)}{E(z)} \\left(1 - 2\\,\\nu(z)\\,K_0(z)\\right),\n$$\n该式可逐点计算。\n\n步骤 4：运动协调性与沉降。\n竖向应变是竖向位移 $ w(z) $ 的导数：\n$$\n\\varepsilon_v(z) = \\frac{d w}{d z},\\qquad w(0)=0.\n$$\n积分以获得位移：\n$$\nw(z) = \\int_0^z \\varepsilon_v(s)\\, ds.\n$$\n在数值上，在同一网格上，通过累积计算\n$$\nw(z_{k+1}) \\approx w(z_k) + \\varepsilon_v(z_k)\\,\\Delta z.\n$$\n\n算法总结：\n- 建立一个从 $ 0 $ 到 $ H $ 的均匀深度网格 $ z_k = k \\Delta z $；确定层索引以访问 $ \\gamma(z_k) $ 和 $ E(z_k) $。\n- 按规定（常数或线性）计算 $ K_0(z_k) $。\n- 初始化 $ \\sigma_v(0)=q_0 $ 和 $ w(0)=0 $。\n- 对每个增量 $ k \\to k+1 $：\n  - 更新竖向应力：$ \\sigma_v(z_{k+1}) = \\sigma_v(z_k) + \\gamma(z_k)\\,\\Delta z $。\n  - 计算水平应力：$ \\sigma_h(z_k) = K_0(z_k)\\,\\sigma_v(z_k) $。\n  - 计算泊松比：$ \\nu(z_k) = K_0(z_k)/(1+K_0(z_k)) $。\n  - 计算竖向应变：$ \\varepsilon_v(z_k) = \\big(\\sigma_v(z_k) - 2\\,\\nu(z_k)\\,\\sigma_h(z_k)\\big)/E(z_k) $。\n  - 更新位移：$ w(z_{k+1}) = w(z_k) + \\varepsilon_v(z_k)\\,\\Delta z $。\n- 在 $ z=H $ 处，报告 $ \\sigma_v(H) $，$ \\sigma_h(H)=K_0(H)\\,\\sigma_v(H) $ 和 $ w(H) $。\n\n正确性：\n- 通过积分平衡方程 $ d \\sigma_v/dz=\\gamma $ 并施加表面边界条件 $ \\sigma_v(0)=q_0 $ 来构建 $ \\sigma_v $，从而满足平衡条件。\n- 通过 $ \\varepsilon_v = d w/d z $ 和 $ \\varepsilon_x=\\varepsilon_y=0 $ 满足协调性条件。\n- 通过使用局部泊松比 $ \\nu(z)=K_0(z)/(1+K_0(z)) $ 的线性各向同性弹性理论，确保 $ \\sigma_h = K_0 \\sigma_v $ 与零侧向应变所隐含的静止条件一致，从而满足本构一致性。\n\n测试套件的输出：\n对于每个案例，程序计算三元组 $ [\\sigma_v(H), \\sigma_h(H), w(H)] $，将每个值四舍五入到小数点后 $3$ 位，并打印包含三元组列表的单行。应力单位为帕斯卡，位移单位为米。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef k0_function_factory(kind, params):\n    \"\"\"\n    Create a K0(z) function.\n    kind: 'constant' or 'linear'\n    params: dict with keys depending on kind:\n        - constant: {'k0_c': value}\n        - linear: {'k0_0': value, 'a': slope}\n    Returns: callable K0(z)\n    \"\"\"\n    if kind == 'constant':\n        k0_c = params['k0_c']\n        return lambda z: k0_c\n    elif kind == 'linear':\n        k00 = params['k0_0']\n        a = params['a']\n        return lambda z: k00 + a * z\n    else:\n        raise ValueError(\"Unknown K0 kind\")\n\ndef make_layer_functions(layer_thicknesses, gammas, moduli):\n    \"\"\"\n    Given piecewise-constant layers, return functions gamma(z) and E(z),\n    and the total depth H.\n    \"\"\"\n    thicknesses = np.array(layer_thicknesses, dtype=float)\n    gamma_vals = np.array(gammas, dtype=float)\n    E_vals = np.array(moduli, dtype=float)\n    z_interfaces = np.concatenate(([0.0], np.cumsum(thicknesses)))\n    H = z_interfaces[-1]\n\n    def find_layer_index(z):\n        # For z in [0,H], return the layer index\n        # Handle z == H to belong to last layer\n        if z >= H:\n            return len(thicknesses) - 1\n        # Find i such that z in [z_interfaces[i], z_interfaces[i+1])\n        i = np.searchsorted(z_interfaces, z, side='right') - 1\n        i = max(0, min(i, len(thicknesses)-1))\n        return i\n\n    def gamma_of_z(z):\n        i = find_layer_index(z)\n        return gamma_vals[i]\n\n    def E_of_z(z):\n        i = find_layer_index(z)\n        return E_vals[i]\n\n    return gamma_of_z, E_of_z, H\n\ndef geostatic_compute(layer_thicknesses, gammas, moduli, k0_kind, k0_params, q0,\n                      dz=0.01):\n    \"\"\"\n    Compute sigma_v(H), sigma_h(H), w(H) under the design outlined in the problem.\n    Units:\n      - gammas in N/m^3\n      - moduli in Pa\n      - q0 in Pa\n      - dz in m\n    Returns tuple (svH, shH, wH)\n    \"\"\"\n    gamma_z, E_z, H = make_layer_functions(layer_thicknesses, gammas, moduli)\n    K0 = k0_function_factory(k0_kind, k0_params)\n\n    # Depth grid\n    n_steps = int(np.ceil(H / dz))\n    # Ensure last point is exactly H\n    z = np.linspace(0.0, H, n_steps + 1)\n    dz_local = np.diff(z)  # size n_steps\n\n    # Initialize arrays\n    sigma_v = np.zeros_like(z)\n    w = np.zeros_like(z)\n\n    # Boundary conditions at surface\n    sigma_v[0] = q0\n    w[0] = 0.0\n\n    # March downwards\n    for k in range(n_steps):\n        zk = z[k]\n        dzk = dz_local[k]\n        gam = gamma_z(zk)\n        # Update vertical stress by equilibrium\n        sigma_v[k+1] = sigma_v[k] + gam * dzk\n\n        # Compute strains and update displacement using values at zk\n        k0_val = K0(zk)\n        # Guard against unphysical K0 values which are not expected in test cases\n        if k0_val  0:\n            k0_val = 0.0\n        nu = k0_val / (1.0 + k0_val)\n        sh = k0_val * sigma_v[k]\n        E = E_z(zk)\n        eps_v = (sigma_v[k] - 2.0 * nu * sh) / E\n        w[k+1] = w[k] + eps_v * dzk\n\n    # Bottom values\n    svH = sigma_v[-1]\n    k0H = K0(H)\n    shH = k0H * svH\n    wH = w[-1]\n    return svH, shH, wH\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Case 1\n    case1_layers = [10.0, 15.0]  # m\n    case1_gammas = [19000.0, 21000.0]  # N/m^3\n    case1_moduli = [3.0e7, 6.0e7]  # Pa\n    case1_k0_kind = 'linear'\n    case1_k0_params = {'k0_0': 0.5, 'a': 0.01}\n    case1_q0 = 50000.0  # Pa\n\n    # Case 2\n    case2_layers = [20.0]\n    case2_gammas = [20000.0]\n    case2_moduli = [1.0e8]\n    case2_k0_kind = 'constant'\n    case2_k0_params = {'k0_c': 0.4}\n    case2_q0 = 0.0\n\n    # Case 3\n    case3_layers = [5.0, 5.0, 5.0]\n    case3_gammas = [18000.0, 18000.0, 18000.0]\n    case3_moduli = [5.0e7, 5.0e7, 5.0e7]\n    case3_k0_kind = 'constant'\n    case3_k0_params = {'k0_c': 0.05}\n    case3_q0 = 10000.0\n\n    # Case 4\n    case4_layers = [30.0]\n    case4_gammas = [22000.0]\n    case4_moduli = [8.0e7]\n    case4_k0_kind = 'linear'\n    case4_k0_params = {'k0_0': 0.6, 'a': 0.004}\n    case4_q0 = 0.0\n\n    test_cases = [\n        (case1_layers, case1_gammas, case1_moduli, case1_k0_kind, case1_k0_params, case1_q0),\n        (case2_layers, case2_gammas, case2_moduli, case2_k0_kind, case2_k0_params, case2_q0),\n        (case3_layers, case3_gammas, case3_moduli, case3_k0_kind, case3_k0_params, case3_q0),\n        (case4_layers, case4_gammas, case4_moduli, case4_k0_kind, case4_k0_params, case4_q0),\n    ]\n\n    results = []\n    for layers, gammas, moduli, k0_kind, k0_params, q0 in test_cases:\n        svH, shH, wH = geostatic_compute(layers, gammas, moduli, k0_kind, k0_params, q0, dz=0.01)\n        results.append([svH, shH, wH])\n\n    # Format results to three decimals as required\n    formatted_cases = []\n    for triplet in results:\n        # Convert to float for formatting, then to string\n        formatted_triplet = [f\"{float(x):.3f}\" for x in triplet]\n        formatted_cases.append(f\"[{','.join(formatted_triplet)}]\")\n    # Final output as a list of lists of strings\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```", "id": "3533886"}]}