{"hands_on_practices": [{"introduction": "在组装全局方程系统之前，我们必须首先理解其最基本的构建模块。这项练习将引导您回归第一性原理，从虚功原理出发，为一个简单的一维杆单元推导其单元刚度矩阵 $K_e$ 和单元外荷载向量 $f_e$。通过这个过程，您将巩固物理原理与离散方程之间的联系，并理解有限元方法中的每一个数学项是如何源于对连续体力学定律的近似。[@problem_id:3501532]", "problem": "考虑一个用于等截面杆段一维轴向变形分析的双节点线性有限元。该杆段具有恒定的杨氏模量 $E$、恒定的横截面积 $A$ 和长度 $L$。设沿杆轴 $x \\in [0,L]$ 的轴向位移场为 $u(x)$。一个大小为 $b$ 的均布单位体积力沿轴向正方向作用。在右端 $x=L$ 处，一个给定的向外轴向牵引力 $\\bar{t}$（单位为应力）作用在端部横截面上，而在 $x=0$ 处没有外部牵引力作用。假设为小应变和线性弹性，应力 $\\sigma = E \\,\\varepsilon$，轴向应变 $\\varepsilon = du/dx$。\n\n从一维线性动量守恒的强形式和虚功原理出发，通过在单元域和边界上进行精确积分，推导协调的二乘二单元刚度矩阵 $K_{e}$ 和协调的双分量单元外力向量 $f_{\\mathrm{ext},e}$。对 $u(x)$ 及其在父域上的虚变分使用标准的双节点等参线性插值，但在物理坐标 $x$ 中精确执行所有积分。\n\n然后，使用您推导出的 $K_{e}$ 和 $f_{\\mathrm{ext},e}$，将单元势能泛函\n$$\n\\Pi_{e}(u_{1},u_{2}) \\;=\\; \\tfrac{1}{2}\\, \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} K_{e} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} \\;-\\; \\begin{bmatrix} u_{1}  u_{2} \\end{bmatrix} f_{\\mathrm{ext},e},\n$$\n写成一个关于 $E$, $A$, $L$, $b$, $\\bar{t}$, $u_{1}$ 和 $u_{2}$ 的闭式解析表达式。\n\n您的最终答案必须是 $\\Pi_{e}(u_{1},u_{2})$ 的单个闭式解析表达式。不要将中间矩阵或向量作为最终答案。不需要进行数值计算。最终答案请勿带单位。", "solution": "该问题陈述经证实具有科学依据、是适定的、客观、完整且可进行数学验证的。它代表了线性弹性静力学有限元法中的一个标准推导过程。所有给定的数据和定义（$E$、$A$、$L$、$b$、$\\bar{t}$）对于推导所要求的势能泛函都是一致且充分的。不存在矛盾、歧义或违反物理原理之处。\n\n我们从一维弹性体的虚功原理（PVW）开始，该原理将内虚功与外虚功相等。对于给定的体积为 $V_e$、边界面为 $\\partial V_e$ 的单元，虚功原理表达式为：\n$$\n\\int_{V_e} \\delta\\varepsilon \\, \\sigma \\, \\mathrm{d}V = \\int_{V_e} \\delta u \\, b \\, \\mathrm{d}V + \\int_{\\partial V_e} \\delta u \\, t \\, \\mathrm{d}S\n$$\n其中 $\\sigma$ 是轴向应力，$\\varepsilon$ 是轴向应变，$\\delta\\varepsilon$ 和 $\\delta u$ 分别是虚应变和虚位移，$b$ 是单位体积力，$t$ 是表面牵引力。\n\n对于长度为 $L$、横截面积恒为 $A$ 的一维等截面杆，该表达式得以简化。我们使用从 $0$ 到 $L$ 的物理坐标 $x$。体积微元为 $\\mathrm{d}V = A \\, \\mathrm{d}x$。虚功原理变为：\n$$\n\\int_0^L \\delta\\varepsilon(x) \\, \\sigma(x) \\, A \\, \\mathrm{d}x = \\int_0^L \\delta u(x) \\, b \\, A \\, \\mathrm{d}x + \\left[ \\delta u(x) \\, t(x) \\, A \\right]_{x=0}^{x=L}\n$$\n问题指定在 $x=L$ 处有给定的向外牵引力 $\\bar{t}$，而在 $x=0$ 处没有外部牵引力。因此，$t(L) = \\bar{t}$，且在 $x=0$ 处来自外部的牵引力为零。边界项变为 $A \\, \\bar{t} \\, \\delta u(L)$。使用线性本构关系 $\\sigma = E\\varepsilon$，虚功原理为：\n$$\n\\int_0^L \\delta\\varepsilon \\, A E \\varepsilon \\, \\mathrm{d}x = \\int_0^L \\delta u \\, A b \\, \\mathrm{d}x + A \\bar{t} \\, \\delta u(L)\n$$\n接下来，我们引入双节点单元上位移场 $u(x)$ 及其变分 $\\delta u(x)$ 的有限元近似。节点位于 $x_1=0$ 和 $x_2=L$，对应的节点位移为 $u_1$ 和 $u_2$。线性插值由下式给出：\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2\n$$\n其中 $N_1(x)$ 和 $N_2(x)$ 是线性形函数。它们必须满足 $N_1(0)=1$、$N_1(L)=0$、$N_2(0)=0$ 和 $N_2(L)=1$。唯一的线性函数是：\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\n用矩阵表示法，$u(x) = \\mathbf{N}(x) \\mathbf{u}_e$，其中 $\\mathbf{N}(x) = \\begin{bmatrix} N_1(x)  N_2(x) \\end{bmatrix}$ 且 $\\mathbf{u}_e = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$。虚位移遵循相同的插值方法：$\\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{u}_e$。\n\n应变 $\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$ 通过对形函数求导得到：\n$$\n\\varepsilon(x) = \\frac{\\mathrm{d}N_1}{\\mathrm{d}x} u_1 + \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} u_2 = \\left(-\\frac{1}{L}\\right) u_1 + \\left(\\frac{1}{L}\\right) u_2 = \\frac{u_2 - u_1}{L}\n$$\n以矩阵形式表示，$\\varepsilon(x) = \\mathbf{B} \\mathbf{u}_e$，其中应变-位移矩阵 $\\mathbf{B}$ 为：\n$$\n\\mathbf{B} = \\begin{bmatrix} \\frac{\\mathrm{d}N_1}{\\mathrm{d}x}  \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{bmatrix}\n$$\n虚应变为 $\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{u}_e$。将这些离散化表达式代入虚功原理：\n$$\n\\int_0^L (\\mathbf{B} \\delta\\mathbf{u}_e)^T A E (\\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}x = \\int_0^L (\\mathbf{N} \\delta\\mathbf{u}_e)^T A b \\, \\mathrm{d}x + (\\mathbf{N}(L) \\delta\\mathbf{u}_e)^T A \\bar{t}\n$$\n利用矩阵转置的性质，并提出常数节点位移向量 $\\mathbf{u}_e$ 和 $\\delta\\mathbf{u}_e$：\n$$\n\\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{B}^T A E \\mathbf{B} \\, \\mathrm{d}x \\right) \\mathbf{u}_e = \\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{N}^T A b \\, \\mathrm{d}x + \\mathbf{N}(L)^T A \\bar{t} \\right)\n$$\n由于此式必须对任意的 $\\delta\\mathbf{u}_e$ 都成立，我们得到单元方程组 $K_e \\mathbf{u}_e = \\mathbf{f}_{\\mathrm{ext},e}$，其中：\n$$\nK_e = \\int_0^L A E \\mathbf{B}^T \\mathbf{B} \\, \\mathrm{d}x \\quad \\text{and} \\quad \\mathbf{f}_{\\mathrm{ext},e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x + A \\bar{t} \\mathbf{N}(L)^T\n$$\n现在我们来精确计算这些积分。对于刚度矩阵 $K_e$：\n$$\n\\mathbf{B}^T \\mathbf{B} = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} \\begin{bmatrix} -1/L  1/L \\end{bmatrix} = \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n由于 $A$、$E$、$L$ 均为常数，被积函数也是常数：\n$$\nK_e = A E \\left( \\frac{1}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\int_0^L \\mathrm{d}x = \\frac{AE}{L^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} L = \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n对于外力向量 $\\mathbf{f}_{\\mathrm{ext},e}$，我们计算体积力和牵引力的分量。\n体积力向量 $\\mathbf{f}_{b,e}$ 为：\n$$\n\\mathbf{f}_{b,e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x = A b \\int_0^L \\begin{bmatrix} 1 - x/L \\\\ x/L \\end{bmatrix} \\mathrm{d}x = Ab \\begin{bmatrix} [x - x^2/(2L)]_0^L \\\\ [x^2/(2L)]_0^L \\end{bmatrix} = Ab \\begin{bmatrix} L - L/2 \\\\ L/2 \\end{bmatrix} = \\frac{ALb}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n牵引力向量 $\\mathbf{f}_{t,e}$ 为：\n$$\n\\mathbf{f}_{t,e} = A \\bar{t} \\mathbf{N}(L)^T = A \\bar{t} \\begin{bmatrix} N_1(L) \\\\ N_2(L) \\end{bmatrix} = A \\bar{t} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n总外力向量是两者的和：\n$$\n\\mathbf{f}_{\\mathrm{ext},e} = \\mathbf{f}_{b,e} + \\mathbf{f}_{t,e} = \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\n最后，我们组装单元势能泛函 $\\Pi_{e}(u_{1},u_{2})$，其表达式为：\n$$\n\\Pi_{e}(u_{1},u_{2}) = \\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e - \\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e}\n$$\n代入推导出的矩阵和向量：\n$$\n\\Pi_{e}(u_1, u_2) = \\frac{1}{2} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\left( \\frac{AE}{L} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\right) \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} - \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\n我们分别计算这两个项。第一项（应变能）是：\n$$\n\\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e = \\frac{1}{2} \\frac{AE}{L} \\begin{bmatrix} u_1  u_2 \\end{bmatrix} \\begin{bmatrix} u_1 - u_2 \\\\ -u_1 + u_2 \\end{bmatrix} = \\frac{AE}{2L} (u_1(u_1 - u_2) + u_2(-u_1 + u_2)) = \\frac{AE}{2L} (u_1^2 - 2u_1u_2 + u_2^2) = \\frac{AE}{2L}(u_2 - u_1)^2\n$$\n第二项（外力功势）是：\n$$\n\\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e} = u_1\\left(\\frac{ALb}{2}\\right) + u_2\\left(\\frac{ALb}{2} + A\\bar{t}\\right)\n$$\n结合这些结果，得到单元势能的最终闭式表达式：\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\left[ u_1 \\frac{ALb}{2} + u_2 \\left(\\frac{ALb}{2} + A\\bar{t}\\right) \\right]\n$$\n这个表达式可以通过展开各项来重写：\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\frac{ALb}{2}(u_1+u_2) - A\\bar{t}u_2\n$$\n两种形式是等效的。第一种形式突出了从推导出的力向量的贡献。为了清晰起见，我们将以展开形式呈现最终答案。\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_1^2 - 2 u_1 u_2 + u_2^2) - \\frac{ALb}{2}u_1 - \\left(\\frac{ALb}{2} + A\\bar{t}\\right)u_2\n$$", "answer": "$$\n\\boxed{\\frac{AE}{2L}(u_2 - u_1)^2 - \\frac{ALb}{2}(u_1 + u_2) - A\\bar{t}u_2}\n$$", "id": "3501532"}, {"introduction": "一旦我们获得了各个单元的矩阵，下一步就是将它们组合成一个单一的全局方程系统。这个被称为“组装”的过程，遵循一个基于网格连接性的精确“散布-相加”（scatter-add）算法。本练习通过为您提供预先计算好的单元矩阵，让您能够专注于掌握从局部自由度到全局自由度的映射逻辑，这是任何有限元分析（FEA）程序的核心。[@problem_id:3501567]", "problem": "考虑一个二维空间中的准静态小应变线性弹性问题，该问题由线性动量平衡和线性弹性固体的本构律控制。全局线性系统源于 Galerkin 弱形式，其中单元刚度矩阵由涉及运动学矩阵和弹性张量的双线性形式定义，单元载荷向量由涉及体力的线性形式定义。有限元法 (FEM) 通过基于网格连接性的分散-相加过程，对每个单元的贡献进行求和，从而组装全局刚度矩阵和载荷向量。\n\n一个小网格由 $4$ 个节点和连接它们的 $2$ 个三节点三角形单元组成。每个节点具有 $2$ 个位移自由度 (DOF)：水平位移 $u_{x}$ 和垂直位移 $u_{y}$。全局自由度的编号方式为：节点 $i$ 对应于全局自由度 $\\left(2i-1,\\,2i\\right)$。这些单元共享一条边，其节点连接性如下：\n- 单元 $1$：节点 $\\left(1,\\,2,\\,3\\right)$，\n- 单元 $2$：节点 $\\left(2,\\,4,\\,3\\right)$。\n\n每个单元的局部自由度顺序为 $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$，其中 $\\left(n_{1},\\,n_{2},\\,n_{3}\\right)$ 是单元的节点标签。\n\n给定以下单元刚度矩阵和单元载荷向量，它们已经通过对弱形式积分进行适当的数值积分计算得出：\n$$\n\\mathbf{K}^{(1)} \\;=\\;\n\\begin{pmatrix}\n6  0  -3  0  -3  0 \\\\\n0  6  0  -3  0  -3 \\\\\n-3  0  6  0  -3  0 \\\\\n0  -3  0  6  0  -3 \\\\\n-3  0  -3  0  6  0 \\\\\n0  -3  0  -3  0  6\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(1)} \\;=\\;\n\\begin{pmatrix}\n2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 3 \\\\ 2\n\\end{pmatrix},\n$$\n$$\n\\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(2)} \\;=\\;\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 4 \\\\ -1\n\\end{pmatrix}.\n$$\n\n请根据所提供的连接性和自由度顺序，通过分散相加单元贡献的方式，组装大小为 $8 \\times 8$ 的全局刚度矩阵 $\\mathbf{K}$ 和大小为 $8$ 的全局载荷向量 $\\mathbf{f}$。作为工作的一部分，请验证由每个单元的连接性引起的定义非零模式的行列索引对，并确认全局刚度矩阵的对称性。然后，确定单个全局刚度矩阵元素 $K_{7,5}$。\n\n只需报告组装后得到的 $K_{7,5}$ 的数值。以千牛顿每米 $\\left(\\mathrm{kN/m}\\right)$ 为单位表示您的最终答案。无需四舍五入，请提供精确值。", "solution": "该问题要求在二维线性弹性问题的有限元法 (FEM) 背景下，从单元刚度矩阵 $\\mathbf{K}^{(e)}$ 组装全局刚度矩阵 $\\mathbf{K}$。具体任务是确定全局矩阵的元素 $K_{7,5}$ 的值。\n\n组装过程基于叠加原理。全局刚度矩阵 $\\mathbf{K}$ 被初始化为适当大小的零矩阵。然后，对于每个单元 $e$，其局部刚度矩阵 $\\mathbf{K}^{(e)}$ 被加到全局矩阵中的相应元素上。局部和全局自由度 (DOF) 之间的映射决定了 $\\mathbf{K}^{(e)}$ 的每个元素放置的位置。全局元素 $K_{I,J}$ 的值是所有连接到全局自由度 $I$ 和全局自由度 $J$ 的单元贡献的总和。\n$$ K_{I,J} = \\sum_{e} K_{g^{(e)}(i), g^{(e)}(j)}^{(e)} = \\sum_{e} K_{i,j}^{(e)} \\quad \\text{其中 } I=g^{(e)}(i) \\text{ 且 } J=g^{(e)}(j) $$\n此处，$g^{(e)}$ 是单元 $e$ 的局部到全局自由度映射向量。\n\n首先，我们必须为这两个单元建立局部到全局的自由度映射。问题陈述，总共有 $4$ 个节点，每个节点有 $2$ 个自由度 ($u_x, u_y$)。节点 $i$ 的全局自由度由 $(2i-1, 2i)$ 给出。\n- 节点 $1$：全局自由度 $(1, 2)$。\n- 节点 $2$：全局自由度 $(3, 4)$。\n- 节点 $3$：全局自由度 $(5, 6)$。\n- 节点 $4$：全局自由度 $(7, 8)$。\n全局自由度的总数为 $2 \\times 4 = 8$，因此全局刚度矩阵 $\\mathbf{K}$ 的大小为 $8 \\times 8$。\n\n对于具有节点 $(n_1, n_2, n_3)$ 的三节点单元，其局部自由度顺序为 $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$，对应于局部自由度索引 $(1, 2, 3, 4, 5, 6)$。\n\n对于单元 $1$，其连接性为节点 $(1, 2, 3)$。\n- 局部自由度 $1, 2$ (来自节点 $1$) 映射到全局自由度 $1, 2$。\n- 局部自由度 $3, 4$ (来自节点 $2$) 映射到全局自由度 $3, 4$。\n- 局部自由度 $5, 6$ (来自节点 $3$) 映射到全局自由度 $5, 6$。\n单元 $1$ 的局部到全局映射向量为 $g^{(1)} = (1, 2, 3, 4, 5, 6)$。\n\n对于单元 $2$，其连接性为节点 $(2, 4, 3)$。\n- 局部自由度 $1, 2$ (来自节点 $2$) 映射到全局自由度 $3, 4$。\n- 局部自由度 $3, 4$ (来自节点 $4$) 映射到全局自由度 $7, 8$。\n- 局部自由度 $5, 6$ (来自节点 $3$) 映射到全局自由度 $5, 6$。\n单元 $2$ 的局部到全局映射向量为 $g^{(2)} = (3, 4, 7, 8, 5, 6)$。\n\n我们需要找到全局刚度元素 $K_{7,5}$ 的值。这是来自两个单元的贡献之和：\n$$ K_{7,5} = K_{7,5}^{\\text{from (1)}} + K_{7,5}^{\\text{from (2)}} $$\n\n来自单元 $1$ 的贡献：\n根据其映射向量 $g^{(1)}$，与单元 $1$ 相关的全局自由度是 $(1, 2, 3, 4, 5, 6)$。全局自由度 $7$ 与单元 $1$ 无关。因此，单元 $1$ 对全局矩阵 $\\mathbf{K}$ 的第 $7$ 行或第 $7$ 列中的任何元素都没有贡献。\n$$ K_{7,5}^{\\text{from (1)}} = 0 $$\n\n来自单元 $2$ 的贡献：\n根据其映射向量 $g^{(2)}$，与单元 $2$ 相关的全局自由度是 $(3, 4, 7, 8, 5, 6)$。为了找到对 $K_{7,5}$ 的贡献，我们必须确定单元 $2$ 中与全局索引 $I=7$ 和 $J=5$ 对应的局部索引 $i$ 和 $j$。\n- 对于全局行索引 $I=7$，我们在映射向量 $g^{(2)} = (3, 4, 7, 8, 5, 6)$ 中寻找 $7$。它是第 $3$ 个条目。因此，局部行索引为 $i=3$。\n- 对于全局列索引 $J=5$，我们在映射向量 $g^{(2)}$ 中寻找 $5$。它是第 $5$ 个条目。因此，局部列索引为 $j=5$。\n来自单元 $2$ 的贡献是其单元刚度矩阵 $\\mathbf{K}^{(2)}$ 中的元素 $K_{i,j}^{(2)} = K_{3,5}^{(2)}$。\n给定：\n$$ \\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7  0  -2  0  -5  0 \\\\\n0  7  0  -2  0  -5 \\\\\n-2  0  5  0  -3  0 \\\\\n0  -2  0  5  0  -3 \\\\\n-5  0  -3  0  8  0 \\\\\n0  -5  0  -3  0  8\n\\end{pmatrix}\n$$\n第 3 行、第 5 列的值是 $K_{3,5}^{(2)} = -3$。因此，$K_{7,5}^{\\text{from (2)}} = -3$。\n\n$K_{7,5}$ 的总值是各项贡献之和：\n$$ K_{7,5} = 0 + (-3) = -3 $$\n\n作为对方法的验证并确认组装后矩阵的对称性，我们可以计算元素 $K_{5,7}$。\n$$ K_{5,7} = K_{5,7}^{\\text{from (1)}} + K_{5,7}^{\\text{from (2)}} $$\n来自单元 $1$ 的贡献同样为 $0$，因为全局自由度 $7$ 不在其映射中。\n对于来自单元 $2$ 的贡献，我们找到对应于全局索引 $I=5$ 和 $J=7$ 的局部索引。\n- 对于 $I=5$，我们在 $g^{(2)} = (3, 4, 7, 8, 5, 6)$ 的第 $5$ 个位置找到 $5$，所以局部行索引是 $i=5$。\n- 对于 $J=7$，我们在 $g^{(2)}$ 的第 $3$ 个位置找到 $7$，所以局部列索引是 $j=3$。\n其贡献是 $K_{5,3}^{(2)}$。从矩阵 $\\mathbf{K}^{(2)}$ 中，该值为 $K_{5,3}^{(2)} = -3$。\n所以，$K_{5,7} = 0 + (-3) = -3$。\n由于 $K_{7,5} = K_{5,7} = -3$，组装后的矩阵对于这对索引是对称的，这与单元刚度矩阵是对称的以及组装操作保持对称性的事实相符。\n\n问题要求最终答案以千牛顿每米 $(\\mathrm{kN/m})$ 表示。给出的刚度矩阵数值没有单位。假设这些数值已经是以所需的单位 $\\mathrm{kN/m}$ 给出的。\n\n因此，全局刚度元素 $K_{7,5}$ 的数值为 $-3$。", "answer": "$$ \\boxed{-3} $$", "id": "3501567"}, {"introduction": "在实际的工程模拟中，组装后的全局刚度矩阵可能非常庞大，但它们通常也是稀疏的，即大部分元素为零。高效地存储和操作这些矩阵是实现高性能计算的关键。这项练习不仅将巩固二维问题的单元矩阵推导和组装过程，还将介绍压缩稀疏行（Compressed Sparse Row, CSR）格式，这是高性能科学计算中的一种重要数据结构，它将理论与实际软件实现联系起来。[@problem_id:3501554]", "problem": "考虑一个由达西定律和质量守恒定律控制的均质、各向同性土体区域中的稳态饱和渗流，对于水头$h$，这可以简化为标量拉普拉斯方程：在区域内 $\\nabla \\cdot \\left( k \\nabla h \\right) = 0$，其中导水系数$k$为常数。使用标准的伽辽金有限元法和线性三角形单元，全局系统由形式为 $K_{ij}^{(e)} = \\int_{\\Omega^{(e)}} k \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$ 的单元贡献组装而成，其中$N_{i}$是单元形函数。\n\n给定一个由4个节点组成的小网格，其坐标为$x_{1}=(0,0)$、$x_{2}=(1,0)$、$x_{3}=(1,1)$和$x_{4}=(0,1)$，该网格被划分为2个线性三角形单元，其连通性为$\\Omega^{(1)}=(1,2,3)$和$\\Omega^{(2)}=(1,3,4)$。为简化起见，假设$k=1$（无量纲单位）。无需施加边界条件；请组装无约束的全局刚度矩阵。\n\n任务：\n- 从弱形式和单元刚度项的定义出发，使用面积坐标和线性三角形的几何公式，推导每个三角形的恒定形函数梯度。然后计算每个单元的刚度矩阵$K^{(1)}$和$K^{(2)}$。\n- 使用给定的连通性，将单元贡献相加到相应的全局自由度中，组装全局刚度矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$。\n- 使用从0开始的索引和每行内升序的列索引，将$K$以压缩稀疏行（CSR）格式存储。明确指出由您的组装过程产生的CSR行指针数组$\\text{row\\_ptr}$、列索引数组$\\text{col\\_ind}$和值数组$\\text{val}$。\n- 最后，计算$\\text{val}$中非零值向量的欧几里得范数（即2-范数），定义为 $\\|\\text{val}\\|_{2} = \\sqrt{\\sum_{\\ell} \\text{val}_{\\ell}^{2}}$。\n\n请将您的最终答案以 $\\|\\text{val}\\|_{2}$ 的单个精确解析表达式形式给出。不要执行任何边界条件消除。不需要四舍五入，也不需要报告单位。", "solution": "用户希望我解决这个问题。我已经验证了它，并发现这是一个来自计算岩土力学的有效且适定的问题。我现在开始解答。\n\n该问题要求使用有限元法（FEM）为由拉普拉斯方程控制的稳态渗流问题组装全局刚度矩阵。步骤包括计算单元刚度矩阵，组装全局矩阵，将其表示为压缩稀疏行（CSR）格式，最后计算所得值数组的欧几里得范数。\n\n对于一个线性三角形单元 $\\Omega^{(e)}$，其单元刚度矩阵项由下式给出：\n$$K_{ij}^{(e)} = \\int_{\\Omega^{(e)}} k \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$$\n其中$N_i$是线性形函数，$k$是导水系数，$\\Omega^{(e)}$是单元域。对于线性三角形单元，梯度$\\nabla N_i$在每个单元内是恒定的。由于$k$也是恒定的，积分简化为：\n$$K_{ij}^{(e)} = k \\, (\\nabla N_i \\cdot \\nabla N_j) \\, A^{(e)}$$\n其中$A^{(e)}$是单元$\\Omega^{(e)}$的面积。\n\n与三角形的局部节点$i$（顶点为$(x_i, y_i)$、$(x_j, y_j)$和$(x_k, y_k)$，按逆时针顺序排列）相关联的形函数$N_i$的梯度由下式给出：\n$$\\nabla N_i = \\frac{1}{2A^{(e)}} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix} = \\frac{1}{2A^{(e)}} \\begin{pmatrix} b_i \\\\ c_i \\end{pmatrix}$$\n利用这个公式，单元刚度矩阵可以表示为：\n$$K_{ij}^{(e)} = \\frac{k}{4A^{(e)}} (b_i b_j + c_i c_j)$$\n我们已知$k=1$。\n\n**步骤1：计算单元刚度矩阵 $K^{(1)}$**\n\n单元$\\Omega^{(1)}$的全局节点为$(1,2,3)$，其坐标为$x_1=(0,0)$、$x_2=(1,0)$和$x_3=(1,1)$。我们分别将它们用作局部节点$(1,2,3)$。\n三角形的面积为 $A^{(1)} = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)| = \\frac{1}{2} |0(0-1) + 1(1-0) + 1(0-0)| = \\frac{1}{2}$。\n每个局部节点的系数$b_i$和$c_i$为：\n- $i=1$: $b_1 = y_2 - y_3 = 0 - 1 = -1$, $c_1 = x_3 - x_2 = 1 - 1 = 0$\n- $i=2$: $b_2 = y_3 - y_1 = 1 - 0 = 1$, $c_2 = x_1 - x_3 = 0 - 1 = -1$\n- $i=3$: $b_3 = y_1 - y_2 = 0 - 0 = 0$, $c_3 = x_2 - x_1 = 1 - 0 = 1$\n刚度矩阵的前置因子为 $\\frac{k}{4A^{(1)}} = \\frac{1}{4(\\frac{1}{2})} = \\frac{1}{2}$。\n让我们构建乘积矩阵 $(b_i b_j + c_i c_j)$：\n$$\n\\begin{pmatrix} b_1^2+c_1^2  b_1b_2+c_1c_2  b_1b_3+c_1c_3 \\\\ b_2b_1+c_2c_1  b_2^2+c_2^2  b_2b_3+c_2c_3 \\\\ b_3b_1+c_3c_1  b_3b_2+c_3c_2  b_3^2+c_3^2 \\end{pmatrix} = \\begin{pmatrix} (-1)^2+0^2  (-1)(1)+0(-1)  (-1)(0)+0(1) \\\\ (1)(-1)+(-1)(0)  1^2+(-1)^2  (1)(0)+(-1)(1) \\\\ (0)(-1)+(1)(0)  (0)(1)+(1)(-1)  0^2+1^2 \\end{pmatrix} = \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}\n$$\n因此，单元$\\Omega^{(1)}$的单元刚度矩阵为：\n$$K^{(1)} = \\frac{1}{2} \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}$$\n该矩阵对应于全局自由度$(1,2,3)$。\n\n**步骤2：计算单元刚度矩阵 $K^{(2)}$**\n\n单元$\\Omega^{(2)}$的全局节点为$(1,3,4)$，其坐标为$x_1=(0,0)$、$x_3=(1,1)$和$x_4=(0,1)$。我们将它们分别映射到局部节点$(1,2,3)$。用于局部计算的坐标为$(x'_1, y'_1)=(0,0)$、$(x'_2, y'_2)=(1,1)$和$(x'_3, y'_3)=(0,1)$。\n面积为 $A^{(2)} = \\frac{1}{2} |0(1-1) + 1(1-0) + 0(0-1)| = \\frac{1}{2}$。\n每个局部节点的系数$b_i$和$c_i$为：\n- $i=1$: $b_1 = y'_2 - y'_3 = 1-1=0$, $c_1 = x'_3 - x'_2 = 0-1=-1$\n- $i=2$: $b_2 = y'_3 - y'_1 = 1-0=1$, $c_2 = x'_1 - x'_3 = 0-0=0$\n- $i=3$: $b_3 = y'_1 - y'_2 = 0-1=-1$, $c_3 = x'_2 - x'_1 = 1-0=1$\n前置因子也为$\\frac{1}{2}$。乘积矩阵为：\n$$\n\\begin{pmatrix} 0^2+(-1)^2  0(1)+(-1)(0)  0(-1)+(-1)(1) \\\\ 1(0)+0(-1)  1^2+0^2  1(-1)+0(1) \\\\ (-1)(0)+1(-1)  (-1)(1)+1(0)  (-1)^2+1^2 \\end{pmatrix} = \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ -1  -1  2 \\end{pmatrix}\n$$\n因此，单元$\\Omega^{(2)}$的单元刚度矩阵为：\n$$K^{(2)} = \\frac{1}{2} \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ -1  -1  2 \\end{pmatrix}$$\n该矩阵对应于全局自由度$(1,3,4)$。\n\n**步骤3：组装全局刚度矩阵 $K$**\n\n我们通过将来自$K^{(1)}$和$K^{(2)}$的贡献根据其全局自由度映射添加到适当的位置，来组装全局$4 \\times 4$矩阵$K$。\n\n- 来自$K^{(1)}$（对应自由度1,2,3）：\n  $K_{11} \\mathrel{+}= \\frac{1}{2}$， $K_{12} \\mathrel{+}= -\\frac{1}{2}$， $K_{13} \\mathrel{+}= 0$\n  $K_{21} \\mathrel{+}= -\\frac{1}{2}$， $K_{22} \\mathrel{+}= 1$， $K_{23} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{31} \\mathrel{+}= 0$， $K_{32} \\mathrel{+}= -\\frac{1}{2}$， $K_{33} \\mathrel{+}= \\frac{1}{2}$\n- 来自$K^{(2)}$（对应自由度1,3,4）：\n  $K_{11} \\mathrel{+}= \\frac{1}{2}$， $K_{13} \\mathrel{+}= 0$， $K_{14} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{31} \\mathrel{+}= 0$， $K_{33} \\mathrel{+}= \\frac{1}{2}$， $K_{34} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{41} \\mathrel{+}= -\\frac{1}{2}$， $K_{43} \\mathrel{+}= -\\frac{1}{2}$， $K_{44} \\mathrel{+}= 1$\n\n将所有贡献相加：\n$K_{11} = \\frac{1}{2} + \\frac{1}{2} = 1$\n$K_{22} = 1$\n$K_{33} = \\frac{1}{2} + \\frac{1}{2} = 1$\n$K_{44} = 1$\n$K_{12} = K_{21} = -\\frac{1}{2}$\n$K_{13} = K_{31} = 0 + 0 = 0$\n$K_{14} = K_{41} = -\\frac{1}{2}$\n$K_{23} = K_{32} = -\\frac{1}{2}$\n$K_{24} = K_{42} = 0$\n$K_{34} = K_{43} = -\\frac{1}{2}$\n\n组装后的全局刚度矩阵$K$为：\n$$ K = \\begin{pmatrix} 1  -\\frac{1}{2}  0  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1  -\\frac{1}{2}  0 \\\\ 0  -\\frac{1}{2}  1  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  -\\frac{1}{2}  1 \\end{pmatrix} $$\n\n**步骤4：将 $K$ 存储为压缩稀疏行（CSR）格式**\n\n为了将$K$转换为从0开始索引的CSR格式，我们识别非零值（`val`）、它们的列索引（`col_ind`）和行起始指针（`row_ptr`）。每行内的列索引必须按升序排列。从全局节点ID $i$到矩阵索引的映射是$i-1$。\n\n- 第0行（节点1）：非零值位于第0、1、3列。值为：$1, -\\frac{1}{2}, -\\frac{1}{2}$。\n- 第1行（节点2）：非零值位于第0、1、2列。值为：$-\\frac{1}{2}, 1, -\\frac{1}{2}$。\n- 第2行（节点3）：非零值位于第1、2、3列。值为：$-\\frac{1}{2}, 1, -\\frac{1}{2}$。\n- 第3行（节点4）：非零值位于第0、2、3列。值为：$-\\frac{1}{2}, -\\frac{1}{2}, 1$。\n\n三个CSR数组为：\n- `val`：此数组按行存储非零值。\n  $$\\text{val} = \\left[ 1, -\\frac{1}{2}, -\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, -\\frac{1}{2}, -\\frac{1}{2}, 1 \\right]$$\n- `col_ind`：此数组存储与`val`中值对应的列索引。\n  $$\\text{col\\_ind} = [ 0, 1, 3, 0, 1, 2, 1, 2, 3, 0, 2, 3 ]$$\n- `row_ptr`：此数组存储每行在`val`中开始的索引。它有$N+1$个条目，其中$N=4$是行数。\n  $$\\text{row\\_ptr} = [ 0, 3, 6, 9, 12 ]$$\n\n**步骤5：计算`val`的欧几里得范数**\n\n最后的任务是计算`val`向量的欧几里得范数：\n$$\\|\\text{val}\\|_{2} = \\sqrt{\\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2}}$$\n`val`数组包含四个值为$1$和八个值为$-\\frac{1}{2}$。\n平方和为：\n$$ \\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2} = 4 \\times (1)^2 + 8 \\times \\left(-\\frac{1}{2}\\right)^2 $$\n$$ \\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2} = 4 \\times 1 + 8 \\times \\frac{1}{4} = 4 + 2 = 6 $$\n因此，欧几里得范数为：\n$$ \\|\\text{val}\\|_{2} = \\sqrt{6} $$", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "3501554"}]}