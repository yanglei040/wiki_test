{"hands_on_practices": [{"introduction": "要真正掌握广义-α方法，第一步是理解其在单个时间步内的代数运算。本练习将指导您从该方法的基本定义出发，推导求解时间步末端加速度所需的有效线性系统。通过为一个具体的双自由度系统计算有效刚度矩阵和有效荷载向量，您将把抽象的理论转化为实际的计算步骤。[@problem_id:3527564]", "problem": "考虑一个源于计算岩土力学的线性弹性动力学初值问题，其半离散运动方程为 $M \\, a(t) + C \\, v(t) + K \\, d(t) = f(t)$，其中 $M$ 是质量矩阵，$C$ 是阻尼矩阵，$K$ 是刚度矩阵，$d(t)$、$v(t)$、$a(t)$ 分别是位移、速度和加速度。需要使用广义-$\\alpha$ 方法（Hilber-Hughes-Taylor/广义-$\\alpha$ 族）及其参数 $\\alpha_m$、$\\alpha_f$、$\\beta$ 和 $\\gamma$，对从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步进行求解。假设该方法在加权意义上满足平衡方程 $M \\, a_{n+\\alpha_m} + C \\, v_{n+\\alpha_f} + K \\, d_{n+\\alpha_f} = f_{n+\\alpha_f}$，其中 $a_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n$，$v_{n+\\alpha_f} = (1-\\alpha_f) v_{n+1} + \\alpha_f v_n$，$d_{n+\\alpha_f} = (1-\\alpha_f) d_{n+1} + \\alpha_f d_n$，并且运动学更新采用参数为 $\\beta$ 和 $\\gamma$ 的 Newmark 族方法。外荷载 $f(t)$ 在时间步内是分段线性的，因此 $f_{n+\\alpha_f} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$。\n\n从运动方程和这些加权定义出发（不使用任何现成的更新公式），推导时间步末端的未知加速度 $a_{n+1}$ 的线性系统，其形式为 $\\hat{K} \\, a_{n+1} = \\hat{R}$。请确定有效刚度矩阵 $\\hat{K}$ 和有效荷载向量 $\\hat{R}$，并用 $M$、$C$、$K$、参数 $\\alpha_m$、$\\alpha_f$、$\\beta$、$\\gamma$、时间步长 $\\Delta t$ 以及在 $t_n$ 时刻的已知值来表示它们。然后，使用以下具体数据计算这些量：\n- $\\alpha_m = 0.1$，$\\alpha_f = 0.3$，$\\beta = 0.36$，$\\gamma = 0.7$ 及 $\\Delta t = 0.02$，\n- $M = \\begin{pmatrix} 2  0 \\\\ 0  1.5 \\end{pmatrix}$，$C = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix}$，$K = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix}$，\n- $d_n = \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix}$，$v_n = \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix}$，$a_n = \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix}$，\n- $f_n = \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix}$ 和 $f_{n+1} = \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix}$。\n\n明确计算有效刚度 $\\hat{K}$ 和有效荷载向量 $\\hat{R}$。作为您最终报告的量，请提供有效荷载向量 $\\hat{R}$ 的第一个分量，单位为牛顿。将您的答案四舍五入到四位有效数字，并以 N 为单位表示最终答案。在您最终报告的答案中不要包含任何其他量。", "solution": "用户要求使用广义 $\\alpha$ 时间积分方法，对线性弹性动力学问题中的单个时间步，推导并计算有效刚度矩阵和有效荷载向量。最终答案应为有效荷载向量的第一个分量。\n\n### 问题验证\n问题陈述是**有效**的。它为计算力学中一个定义明确的任务提供了一套完整且一致的方程、参数和数据。广义 $\\alpha$ 方法的控制方程和 Newmark 运动学更新是该领域的标准方法。所提供的数值对于一个两自由度系统是物理上合理的。该问题具有科学依据、是适定且客观的，不包含任何矛盾或含糊之处。\n\n### 第1部分：有效系统的推导\n\n半离散运动方程由下式给出：\n$$M a(t) + C v(t) + K d(t) = f(t)$$\n其中 $M$、$C$ 和 $K$ 分别是质量、阻尼和刚度矩阵，$d(t)$、$v(t)$、$a(t)$ 和 $f(t)$ 分别是位移、速度、加速度和外力向量。\n\n广义-$\\alpha$ 方法通过在某个中间时刻强制平衡，将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$：\n$$M a_{n+\\alpha_m} + C v_{n+\\alpha_f} + K d_{n+\\alpha_f} = f_{n+\\alpha_f}$$\n这些中间时刻的状态向量定义为加权平均值：\n$$a_{n+\\alpha_m} = (1-\\alpha_m) a_{n+1} + \\alpha_m a_n$$\n$$v_{n+\\alpha_f} = (1-\\alpha_f) v_{n+1} + \\alpha_f v_n$$\n$$d_{n+\\alpha_f} = (1-\\alpha_f) d_{n+1} + \\alpha_f d_n$$\n外荷载假定为分段线性的：\n$$f_{n+\\alpha_f} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$$\n\n位移、速度和加速度之间的关系由 Newmark 族积分公式给出：\n$$d_{n+1} = d_n + \\Delta t v_n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1} \\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[ (1 - \\gamma) a_n + \\gamma a_{n+1} \\right]$$\n\n目标是推导时间步末端未知加速度 $a_{n+1}$ 的线性系统，其形式为 $\\hat{K} a_{n+1} = \\hat{R}$。为此，我们必须用 $a_{n+1}$ 和来自 $t_n$ 时刻的已知量来表示 $d_{n+1}$ 和 $v_{n+1}$。Newmark 公式已经提供了这一点。\n\n首先，将加权平均定义代入平衡方程：\n$$M ((1-\\alpha_m) a_{n+1} + \\alpha_m a_n) + C ((1-\\alpha_f) v_{n+1} + \\alpha_f v_n) + K ((1-\\alpha_f) d_{n+1} + \\alpha_f d_n) = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$$\n\n重排方程，将包含 $t_{n+1}$ 时刻各量的项分离到左侧 (LHS)：\n$$(1-\\alpha_m) M a_{n+1} + (1-\\alpha_f) C v_{n+1} + (1-\\alpha_f) K d_{n+1} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n - \\alpha_m M a_n - \\alpha_f C v_n - \\alpha_f K d_n$$\n\n现在，将 $v_{n+1}$ 和 $d_{n+1}$ 的 Newmark 更新法则代入左侧：\n\\begin{align*} (1-\\alpha_m) M a_{n+1} + (1-\\alpha_f) C \\left( v_n + \\Delta t ((1 - \\gamma) a_n + \\gamma a_{n+1}) \\right) \\\\ + (1-\\alpha_f) K \\left( d_n + \\Delta t v_n + \\Delta t^2 ((\\frac{1}{2} - \\beta) a_n + \\beta a_{n+1}) \\right) = \\text{RHS} \\end{align*}\n\n我们将左侧所有乘以未知数 $a_{n+1}$ 的项组合在一起：\n$$ \\left( (1-\\alpha_m) M + (1-\\alpha_f) \\gamma \\Delta t C + (1-\\alpha_f) \\beta \\Delta t^2 K \\right) a_{n+1} = \\text{RHS} - (\\text{known terms from LHS})$$\n\n乘以 $a_{n+1}$ 的矩阵即为有效刚度矩阵 $\\hat{K}$：\n$$\\hat{K} = (1-\\alpha_m) M + (1-\\alpha_f) \\gamma \\Delta t C + (1-\\alpha_f) \\beta \\Delta t^2 K$$\n\n剩余的项构成了有效荷载向量 $\\hat{R}$。我们将所有已知量移到右侧：\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n - \\alpha_m M a_n - \\alpha_f C v_n - \\alpha_f K d_n \\\\ - (1-\\alpha_f) C \\left( v_n + \\Delta t(1 - \\gamma) a_n \\right) \\\\ - (1-\\alpha_f) K \\left( d_n + \\Delta t v_n + \\Delta t^2 (\\frac{1}{2} - \\beta) a_n \\right) \\end{align*}\n\n通过收集与 $a_n$、$v_n$ 和 $d_n$ 相关的项来简化：\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n \\\\ - \\left( \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right) a_n \\\\ - \\left( (\\alpha_f + 1 - \\alpha_f)C + (1-\\alpha_f)\\Delta t K \\right) v_n \\\\ - \\left( (\\alpha_f + 1 - \\alpha_f)K \\right) d_n \\end{align*}\n\n简化后得到：\n\\begin{align*} \\hat{R} = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n \\\\ - \\left[ \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right] a_n \\\\ - \\left[ C + (1-\\alpha_f)\\Delta t K \\right] v_n \\\\ - K d_n \\end{align*}\n\n为了方便计算，通常更简单的方法是分别计算每一项，然后将它们组合起来：\n$\\hat{R} = T_f - T_a - T_v - T_d$，其中：\n$T_f = (1-\\alpha_f) f_{n+1} + \\alpha_f f_n$\n$T_a = \\left[ \\alpha_m M + (1-\\alpha_f)(1-\\gamma)\\Delta t C + (1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 K \\right] a_n$\n$T_v = \\left[ C + (1-\\alpha_f)\\Delta t K \\right] v_n$\n$T_d = K d_n$\n\n### 第2部分：数值计算\n\n给定数据：\n$\\alpha_m = 0.1$，$\\alpha_f = 0.3$，$\\beta = 0.36$，$\\gamma = 0.7$，$\\Delta t = 0.02$。\n$M = \\begin{pmatrix} 2  0 \\\\ 0  1.5 \\end{pmatrix}$，$C = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix}$，$K = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix}$。\n$d_n = \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix}$，$v_n = \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix}$，$a_n = \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix}$。\n$f_n = \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix}$，$f_{n+1} = \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix}$。\n\n首先，我们计算有效荷载向量 $\\hat{R}$ 的系数：\n$1-\\alpha_f = 1 - 0.3 = 0.7$\n$\\alpha_f = 0.3$\n$\\alpha_m = 0.1$\n$1-\\gamma = 1 - 0.7 = 0.3$\n$\\frac{1}{2}-\\beta = 0.5 - 0.36 = 0.14$\n$(1-\\alpha_f)(1-\\gamma)\\Delta t = 0.7 \\times 0.3 \\times 0.02 = 0.0042$\n$(1-\\alpha_f)(\\frac{1}{2}-\\beta)\\Delta t^2 = 0.7 \\times 0.14 \\times (0.02)^2 = 0.0000392$\n$(1-\\alpha_f)\\Delta t = 0.7 \\times 0.02 = 0.014$\n\n现在计算 $\\hat{R}$ 的每一项：\n\n1.  力项 $T_f$：\n    $T_f = 0.7 f_{n+1} + 0.3 f_n = 0.7 \\begin{pmatrix} 120 \\\\ 48 \\end{pmatrix} + 0.3 \\begin{pmatrix} 100 \\\\ 50 \\end{pmatrix} = \\begin{pmatrix} 84 \\\\ 33.6 \\end{pmatrix} + \\begin{pmatrix} 30 \\\\ 15 \\end{pmatrix} = \\begin{pmatrix} 114 \\\\ 48.6 \\end{pmatrix}$\n\n2.  位移项 $T_d$：\n    $T_d = K d_n = \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix} \\begin{pmatrix} 0.005 \\\\ -0.002 \\end{pmatrix} = \\begin{pmatrix} 5 + 0.4 \\\\ -1 - 1.6 \\end{pmatrix} = \\begin{pmatrix} 5.4 \\\\ -2.6 \\end{pmatrix}$\n\n3.  速度项 $T_v$：\n    $T_v = \\left[ C + 0.014 K \\right] v_n$\n    $0.014 K = 0.014 \\begin{pmatrix} 1000  -200 \\\\ -200  800 \\end{pmatrix} = \\begin{pmatrix} 14  -2.8 \\\\ -2.8  11.2 \\end{pmatrix}$\n    $C + 0.014 K = \\begin{pmatrix} 0.8  0.1 \\\\ 0.1  0.5 \\end{pmatrix} + \\begin{pmatrix} 14  -2.8 \\\\ -2.8  11.2 \\end{pmatrix} = \\begin{pmatrix} 14.8  -2.7 \\\\ -2.7  11.7 \\end{pmatrix}$\n    $T_v = \\begin{pmatrix} 14.8  -2.7 \\\\ -2.7  11.7 \\end{pmatrix} \\begin{pmatrix} 0.1 \\\\ -0.05 \\end{pmatrix} = \\begin{pmatrix} 1.48 + 0.135 \\\\ -0.27 - 0.585 \\end{pmatrix} = \\begin{pmatrix} 1.615 \\\\ -0.855 \\end{pmatrix}$\n\n4.  加速度项 $T_a$：\n    $T_a = \\left[ 0.1 M + 0.0042 C + 0.0000392 K \\right] a_n$\n    $0.1 M = \\begin{pmatrix} 0.2  0 \\\\ 0  0.15 \\end{pmatrix}$\n    $0.0042 C = \\begin{pmatrix} 0.00336  0.00042 \\\\ 0.00042  0.0021 \\end{pmatrix}$\n    $0.0000392 K = \\begin{pmatrix} 0.0392  -0.00784 \\\\ -0.00784  0.03136 \\end{pmatrix}$\n    括号中的矩阵 = $\\begin{pmatrix} 0.2 + 0.00336 + 0.0392  0 + 0.00042 - 0.00784 \\\\ 0 + 0.00042 - 0.00784  0.15 + 0.0021 + 0.03136 \\end{pmatrix} = \\begin{pmatrix} 0.24256  -0.00742 \\\\ -0.00742  0.18346 \\end{pmatrix}$\n    $T_a = \\begin{pmatrix} 0.24256  -0.00742 \\\\ -0.00742  0.18346 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.00742 \\times 0.2 \\\\ 0.18346 \\times 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.001484 \\\\ 0.036692 \\end{pmatrix}$\n\n最后，组合有效荷载向量 $\\hat{R} = T_f - T_d - T_v - T_a$：\n$$\\hat{R} = \\begin{pmatrix} 114 \\\\ 48.6 \\end{pmatrix} - \\begin{pmatrix} 5.4 \\\\ -2.6 \\end{pmatrix} - \\begin{pmatrix} 1.615 \\\\ -0.855 \\end{pmatrix} - \\begin{pmatrix} -0.001484 \\\\ 0.036692 \\end{pmatrix}$$\n\n我们只需要第一个分量 $\\hat{R}_1$：\n$$\\hat{R}_1 = 114 - 5.4 - 1.615 - (-0.001484)$$\n$$\\hat{R}_1 = 114 - 5.4 - 1.615 + 0.001484$$\n$$\\hat{R}_1 = 108.6 - 1.615 + 0.001484$$\n$$\\hat{R}_1 = 106.985 + 0.001484$$\n$$\\hat{R}_1 = 106.986484$$\n\n问题要求四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$6$、$9$。第五位数字是 $8$，所以我们将第四位数字向上取整。\n$106.9 \\rightarrow 107.0$。结尾的零是有效数字。\n\n有效荷载向量的第一个分量是 $107.0$ N。", "answer": "$$\\boxed{107.0}$$", "id": "3527564"}, {"introduction": "广义-α和HHT方法的关键优势之一是它们能够引入可控的数值耗散，以抑制虚假的高频振荡。本练习通过一个理想化的思想实验，揭示了HHT-α参数影响系统如何“感知”瞬时荷载的内在机理。通过分析一个简化的单自由度系统，您将推导出该方法捕捉到的脉冲与真实脉冲之间的关系，从而深刻理解数值阻尼的本质。[@problem_id:3527601]", "problem": "考虑一个质量为 $m$ 的单自由度质点，在一个从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$、大小为 $\\Delta t$ 的时间步内，承受瞬态载荷 $f(t)$。假设刚度和阻尼为零，因此线性动量平衡方程简化为 $m \\ddot{u}(t) = f(t)$。该区间上的外载荷是一个窄直角三角形脉冲，作用于该时间步的最后一部分 $\\varepsilon \\Delta t$ 内，其中 $0  \\varepsilon  1$。其定义为：对于 $t \\in [t_n, t_{n+1} - \\varepsilon \\Delta t]$，$f(t) = 0$；而从 $t = t_{n+1} - \\varepsilon \\Delta t$ 时的 0 开始，$f(t)$ 线性增加到 $t = t_{n+1}$ 时的峰值 $F_0$。这在该时间步内产生一个精确冲量 $I_{\\mathrm{true}} = \\int_{t_n}^{t_{n+1}} f(t)\\, dt$。\n\n考虑两种时间积分格式：\n- Newmark 族格式，参数为 $\\gamma \\in [0,1]$。\n- Hilber–Hughes–Taylor (HHT) 方法，参数为 $\\alpha$ (Hilber–Hughes–Taylor (HHT))，其中为了数值耗散，$\\alpha \\leq 0$。\n\n对于每种格式，考虑在时间步末端施加动态平衡的标准单步法，以及常规的 Newmark 型速度更新。根据给定的 $f(t)$ 对 $f_n = f(t_n)$ 和 $f_{n+1} = f(t_{n+1})$ 进行一致性处理，并假设 $t_n$ 处的加速度满足 $m \\ddot{u}_n = f_n$。\n\n定义每种格式离散捕捉到的冲量为：Newmark 格式为 $I_{\\mathrm{NM}} = m(\\dot{u}_{n+1} - \\dot{u}_n)$，HHT 格式为 $I_{\\mathrm{HHT}} = m(\\dot{u}_{n+1} - \\dot{u}_n)$。仅从线性动量平衡 $m \\ddot{u}(t) = f(t)$ 和标准的 Newmark/HHT 更新结构出发，推导以下各项的闭式表达式：\n1. 用 $\\alpha$ 和 $\\gamma$ 表示的比率 $I_{\\mathrm{HHT}}/I_{\\mathrm{NM}}$。\n2. HHT 格式捕捉到的冲量相对于精确冲量的相对误差 $(I_{\\mathrm{HHT}} - I_{\\mathrm{true}})/I_{\\mathrm{true}}$，用 $\\alpha$、$\\gamma$ 和 $\\varepsilon$ 表示。\n\n以解析表达式形式给出最终答案。不需要进行数值计算或四舍五入。最终表达式是无量纲的，不要包含单位。将两个量一并以单个行向量的形式提供。", "solution": "首先将根据所需准则对问题陈述进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- 系统：质量为 $m$ 的单自由度质点。\n- 动力学：线性动量平衡为 $m \\ddot{u}(t) = f(t)$，刚度和阻尼为零。\n- 时间步：从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步。\n- 激励函数 $f(t)$：一个直角三角形脉冲。\n  - 对于 $t \\in [t_n, t_{n+1} - \\varepsilon \\Delta t]$，$f(t) = 0$，其中 $0  \\varepsilon  1$。\n  - 从 $t = t_{n+1} - \\varepsilon \\Delta t$ 时的 0 开始，$f(t)$ 线性增加到 $t = t_{n+1}$ 时的峰值 $F_0$。\n- 精确冲量：$I_{\\mathrm{true}} = \\int_{t_n}^{t_{n+1}} f(t)\\, dt$。\n- $t_n$ 处的初始条件：力为 $f_n = f(t_n)$，加速度为 $m \\ddot{u}_n = f_n$。\n- $t_{n+1}$ 处的结束条件：力为 $f_{n+1} = f(t_{n+1})$。\n- 时间积分格式：\n  1. Newmark 族格式，参数为 $\\gamma \\in [0,1]$。\n  2. Hilber–Hughes–Taylor (HHT) 方法，参数为 $\\alpha \\leq 0$。\n- 算法细节：两种格式都使用在时间步末端施加动态平衡的标准单步法和 Newmark 型速度更新。\n- 捕捉冲量定义：两种格式的捕捉冲量均为 $I_{\\mathrm{scheme}} = m(\\dot{u}_{n+1} - \\dot{u}_n)$（NM 代表 Newmark，HHT 代表 HHT）。\n- 目标：推导以下各项的闭式表达式：\n  1. 用 $\\alpha$ 和 $\\gamma$ 表示的比率 $I_{\\mathrm{HHT}}/I_{\\mathrm{NM}}$。\n  2. 用 $\\alpha$、$\\gamma$ 和 $\\varepsilon$ 表示的相对误差 $(I_{\\mathrm{HHT}} - I_{\\mathrm{true}})/I_{\\mathrm{true}}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在计算力学领域有充分的依据，重点分析了成熟的时间积分格式（Newmark, HHT）。其基本物理原理是牛顿第二定律。通过设置零刚度和零阻尼，是一种标准方法，用以隔离和分析积分器对于惯性项和力项的行为。\n- **适定性**：该问题是适定的。激励函数定义明确。控制方程已指定。算法是标准的，尽管在这种退化情况下需要仔细解释。目标清晰，要求推导可导出的解析表达式。预期存在唯一解。\n- **客观性**：语言正式、精确、客观。\n\n该问题是自洽且内部一致的。它没有违反任何基本原理，是指定领域内一个典型但具有挑战性的学术练习。\n\n**第 3 步：结论与行动**\n问题被判定为**有效**。将提供一个完整的、附有推理的解答。\n\n### 解答推导\n\n解答过程分为四个阶段：\n1. 激励函数的表征和真实冲量 $I_{\\mathrm{true}}$ 的计算。\n2. 分析 Newmark 格式以确定其捕捉到的冲量 $I_{\\mathrm{NM}}$。\n3. 分析 HHT 格式以确定其捕捉到的冲量 $I_{\\mathrm{HHT}}$。\n4. 计算两个要求的表达式。\n\n**1. 激励函数和真实冲量**\n\n外载荷 $f(t)$ 定义为一个直角三角形脉冲。\n时间步开始时 $t_n$ 处的力值为 $f_n = f(t_n) = 0$，因为 $t_n$ 落在力为零的区间内。\n时间步结束时 $t_{n+1}$ 处的力值为峰值 $f_{n+1} = f(t_{n+1}) = F_0$。\n\n精确冲量 $I_{\\mathrm{true}}$ 是力在该时间步上的时间积分，对应于力-时间曲线下的面积。该曲线是一个底为 $\\varepsilon \\Delta t$、高为 $F_0$ 的三角形。\n$$I_{\\mathrm{true}} = \\int_{t_n}^{t_{n+1}} f(t) \\, dt = \\frac{1}{2} \\times (\\text{底}) \\times (\\text{高}) = \\frac{1}{2} (\\varepsilon \\Delta t) F_0$$\n\n**2. Newmark 格式分析**\n\nNewmark 格式由离散运动方程以及速度和位移的更新规则组成。对于本问题，只需要速度更新。标准的 Newmark 速度更新为：\n$$\\dot{u}_{n+1} = \\dot{u}_n + (1-\\gamma)\\Delta t \\ddot{u}_n + \\gamma \\Delta t \\ddot{u}_{n+1}$$\n因此，离散冲量为 $I_{\\mathrm{NM}} = m(\\dot{u}_{n+1} - \\dot{u}_n) = m \\left( (1-\\gamma)\\Delta t \\ddot{u}_n + \\gamma \\Delta t \\ddot{u}_{n+1} \\right)$。\n\n为了求得 $I_{\\mathrm{NM}}$，我们必须确定加速度 $\\ddot{u}_n$ 和 $\\ddot{u}_{n+1}$。\n- 在 $t_n$ 处，问题陈述 $m \\ddot{u}_n = f_n$。由于 $f_n=0$，我们有 $\\ddot{u}_n = 0$。\n- 对于 Newmark 格式，平衡在时间步末端施加：$m \\ddot{u}_{n+1} = f_{n+1}$。由于 $f_{n+1}=F_0$，这得到 $\\ddot{u}_{n+1} = \\frac{F_0}{m}$。\n\n将这些加速度代入速度变化量的表达式中：\n$$\\dot{u}_{n+1} - \\dot{u}_n = (1-\\gamma)\\Delta t (0) + \\gamma \\Delta t \\left(\\frac{F_0}{m}\\right) = \\frac{\\gamma \\Delta t F_0}{m}$$\nNewmark 格式捕捉到的冲量为：\n$$I_{\\mathrm{NM}} = m(\\dot{u}_{n+1} - \\dot{u}_n) = m \\left(\\frac{\\gamma \\Delta t F_0}{m}\\right) = \\gamma \\Delta t F_0$$\n\n**3. Hilber–Hughes–Taylor (HHT) 格式分析**\n\nHHT 方法，也称为 $\\alpha$ 方法，通过修正离散运动方程来引入数值耗散。一个标准的公式是在中间时刻 $t_{n+1-\\alpha}$ 对完整的半离散方程进行求值。对于一个有刚度和阻尼的系统，方程为 $m\\ddot{u}_{n+1} + c\\dot{u}_{n+1-\\alpha} + ku_{n+1-\\alpha} = f_{n+1-\\alpha}$。在我们的特定情况下，刚度 ($k=0$) 和阻尼 ($c=0$) 均为零，该方程简化为：\n$$m\\ddot{u}_{n+1} = f_{n+1-\\alpha}$$\n中间时刻的力 $f_{n+1-\\alpha}$ 通常通过在时间步两端的值之间进行线性插值来定义：\n$$f_{n+1-\\alpha} = (1-\\alpha)f_{n+1} + \\alpha f_n$$\n这种解释与现代实现和问题结构最为一致，后者暗示了 HHT 和 Newmark 之间的差异。\n\n使用已知值 $f_n=0$ 和 $f_{n+1}=F_0$，HHT 格式的运动方程变为：\n$$m\\ddot{u}_{n+1} = (1-\\alpha)F_0 + \\alpha(0) = (1-\\alpha)F_0$$\n这给出了时间步末端的加速度：$\\ddot{u}_{n+1} = \\frac{(1-\\alpha)F_0}{m}$。\n\n问题陈述 HHT 格式使用相同的 Newmark 型速度更新。起始加速度 $\\ddot{u}_n=0$ 保持不变。我们在更新规则中使用新推导的 $\\ddot{u}_{n+1}$：\n$$\\dot{u}_{n+1} - \\dot{u}_n = (1-\\gamma)\\Delta t \\ddot{u}_n + \\gamma \\Delta t \\ddot{u}_{n+1} = 0 + \\gamma \\Delta t \\left(\\frac{(1-\\alpha)F_0}{m}\\right) = \\frac{\\gamma(1-\\alpha)\\Delta t F_0}{m}$$\nHHT 格式捕捉到的冲量为：\n$$I_{\\mathrm{HHT}} = m(\\dot{u}_{n+1} - \\dot{u}_n) = m \\left(\\frac{\\gamma(1-\\alpha)\\Delta t F_0}{m}\\right) = \\gamma(1-\\alpha)\\Delta t F_0$$\n\n**4. 最终表达式的计算**\n\n现在我们可以计算所需的两个量。\n\n**第一个量：比率 $I_{\\mathrm{HHT}}/I_{\\mathrm{NM}}$**\n这个比率直接从 $I_{\\mathrm{HHT}}$ 和 $I_{\\mathrm{NM}}$ 的表达式计算得出，假设 $\\gamma \\neq 0$。如果 $\\gamma=0$，则两个冲量都为零，比率是不确定的；我们在隐含的假设下继续，即选择该格式是为了捕捉冲量效应，即 $\\gamma>0$。\n$$\\frac{I_{\\mathrm{HHT}}}{I_{\\mathrm{NM}}} = \\frac{\\gamma(1-\\alpha)\\Delta t F_0}{\\gamma \\Delta t F_0} = 1-\\alpha$$\n\n**第二个量：HHT 冲量的相对误差**\nHHT 捕捉到的冲量相对于精确冲量的相对误差由 $(I_{\\mathrm{HHT}} - I_{\\mathrm{true}})/I_{\\mathrm{true}}$ 给出。\n$$\\frac{I_{\\mathrm{HHT}} - I_{\\mathrm{true}}}{I_{\\mathrm{true}}} = \\frac{I_{\\mathrm{HHT}}}{I_{\\mathrm{true}}} - 1$$\n我们首先计算比率 $I_{\\mathrm{HHT}}/I_{\\mathrm{true}}$：\n$$\\frac{I_{\\mathrm{HHT}}}{I_{\\mathrm{true}}} = \\frac{\\gamma(1-\\alpha)\\Delta t F_0}{\\frac{1}{2}\\varepsilon \\Delta t F_0} = \\frac{2\\gamma(1-\\alpha)}{\\varepsilon}$$\n将此代回相对误差的表达式中：\n$$\\frac{I_{\\mathrm{HHT}} - I_{\\mathrm{true}}}{I_{\\mathrm{true}}} = \\frac{2\\gamma(1-\\alpha)}{\\varepsilon} - 1$$\n该表达式如要求的那样，取决于 $\\alpha$、$\\gamma$ 和 $\\varepsilon$。\n问题要求将两个量作为单个行向量提供。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1-\\alpha  \\frac{2\\gamma(1-\\alpha)}{\\varepsilon} - 1\n\\end{pmatrix}\n}\n$$", "id": "3527601"}, {"introduction": "在计算地球力学和结构动力学中，区分和结合物理阻尼与数值耗散至关重要。本练习将引导您设计一个综合的阻尼模型，其中同时包含代表材料能量损失的瑞利（Rayleigh）阻尼和由广义-α方法提供以确保数值稳定性的算法耗散。您需要设计瑞利阻尼系数和广义-α方法的参数，以满足在不同频率下的特定阻尼要求，从而掌握如何在实际工程问题中协同使用这两种阻尼机制。[@problem_id:3527639]", "problem": "考虑一个源于计算岩土力学的线性半离散弹性动力学系统，其运动方程为 $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$，其中 $M$ 是对称正定质量矩阵，$C$ 是阻尼矩阵，$K$ 是对称正定刚度矩阵。假设采用比例（Rayleigh）阻尼 $C = a_0 M + a_1 K$，其中 $a_0$ 和 $a_1$ 是标量系数。令无阻尼模态问题 $K \\phi_j = \\omega_j^2 M \\phi_j$ 定义自振圆频率 $\\omega_j$ 和相应的相对于 $M$ 的标准正交模态向量 $\\phi_j$。\n\n您将比较 Rayleigh 阻尼和广义-$\\alpha$ 算法耗散（通过时间积分器减少高频成分）对模态阻尼比的影响，并设计 $(a_0,a_1,\\rho_\\infty)$ 以实现指定的低频和高频阻尼行为。广义-$\\alpha$ 方法是一种单步、二阶精度、无条件稳定的时间积分格式，通过对中间时刻 $t_{n+\\alpha_f}$ 的平衡和时刻 $t_{n+\\alpha_m}$ 的加速度进行加权得到，其参数 $\\alpha_m$ 和 $\\alpha_f$ 被选择以达到预设的高频谱半径 $\\rho_\\infty$；当 $\\alpha_m=0$ 且 $\\alpha_f=\\alpha$ 时，该方法可恢复为 Hilber–Hughes–Taylor (HHT) 方法的特例。\n\n从基本模态动力学方程 $m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$ 出发，其中 $m_j = \\phi_j^{\\top} M \\phi_j$，$k_j = \\phi_j^{\\top} K \\phi_j = m_j \\omega_j^2$ 和 $c_j = \\phi_j^{\\top} C \\phi_j$，推导模态阻尼比 $\\zeta_j$ 关于 $(a_0,a_1)$ 和 $\\omega_j$ 的表达式。然后，对于广义-$\\alpha$ 方法，分析无阻尼单模态方程 $\\ddot{q} + \\omega^2 q = 0$ 在该方法下的放大作用，并确定高频谱半径 $\\rho_\\infty$ 为放大因子在极限 $\\omega \\Delta t \\to \\infty$ 下的模，将其与 $(\\alpha_m,\\alpha_f)$ 联系起来，从而与预设的 $\\rho_\\infty$ 联系起来。\n\n设计 Rayleigh 阻尼系数以满足以下物理阻尼规格：\n- 在 $\\omega_L = 20$ 处，低频目标模态阻尼比为 $\\zeta(\\omega_L) = 0.05$，\n- 在 $\\omega_H = 200$ 处，高频目标模态阻尼比为 $\\zeta(\\omega_H) = 0.02$。\n\n此外，设计广义-$\\alpha$ 算法耗散，使其高频谱半径为 $\\rho_\\infty = \\dfrac{3}{5}$，并在讨论算法耗散时假设时间步长为 $\\Delta t = 0.005$，尽管 $\\rho_\\infty$ 本身的设计与 $\\Delta t$ 无关。\n\n比较物理 Rayleigh 模态阻尼比 $\\zeta(\\omega)$ 的频率依赖性与由 $\\rho_\\infty$ 表征的广义-$\\alpha$ 算法耗散，强调每种机制如何针对频谱的不同部分。\n\n将最终的设计三元组 $(a_0,a_1,\\rho_\\infty)$ 表示为精确值。报告 $a_0$ 的单位为 $\\text{s}^{-1}$，$a_1$ 的单位为 $\\text{s}$，而 $\\rho_\\infty$ 为无量纲。答案必须是使用 LaTeX $\\mathrm{pmatrix}$ 环境的单行矩阵。无需四舍五入。", "solution": "首先将根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n已知条件逐字摘录自问题陈述：\n-   运动方程：$M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$。\n-   $M$：对称正定质量矩阵。\n-   $C$：阻尼矩阵。\n-   $K$：对称正定刚度矩阵。\n-   比例 (Rayleigh) 阻尼：$C = a_0 M + a_1 K$。\n-   无阻尼模态问题：$K \\phi_j = \\omega_j^2 M \\phi_j$，定义了自振圆频率 $\\omega_j$ 和 M-标准正交模态向量 $\\phi_j$。\n-   齐次模态动力学：$m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$。\n-   模态质量、刚度和阻尼：$m_j = \\phi_j^{\\top} M \\phi_j$，$k_j = \\phi_j^{\\top} K \\phi_j = m_j \\omega_j^2$ 和 $c_j = \\phi_j^{\\top} C \\phi_j$。\n-   广义-$\\alpha$ 方法描述为一种单步、二阶精度、无条件稳定的时间积分格式，其参数 $(\\alpha_m, \\alpha_f)$ 被选择以达到预设的高频谱半径 $\\rho_\\infty$。\n-   物理阻尼规格：\n    -   低频目标：在 $\\omega_L = 20$ 处，$\\zeta(\\omega_L) = 0.05$。\n    -   高频目标：在 $\\omega_H = 200$ 处，$\\zeta(\\omega_H) = 0.02$。\n-   算法耗散规格：$\\rho_\\infty = \\frac{3}{5}$。\n-   供讨论用的时间步长：$\\Delta t = 0.005$。\n-   输出要求：设计三元组 $(a_0, a_1, \\rho_\\infty)$ 为精确值。\n\n**步骤 2：使用提取的已知条件进行验证**\n对照验证清单对问题进行评估：\n-   **有科学依据（关键）**：该问题从根本上基于线性弹性动力学、模态分析和数值时间积分（特别是 Rayleigh 阻尼和广义-$\\alpha$ 方法）的既定原理。这些是计算岩土力学和结构动力学中的标准课题。该问题在科学上是合理的。\n-   **适定的**：该问题提供了明确的目标和充分、一致的信息来确定所需的设计参数。用于求解 Rayleigh 阻尼系数的方程组有唯一解。$\\rho_\\infty$ 的值是一个明确给出的设计选择。该问题是适定的。\n-   **客观的（关键）**：该问题使用精确、定量且无偏见的技术语言进行陈述。它不含主观或基于观点的陈述。\n\n**步骤 3：结论与行动**\n经判定，该问题在科学上合理、适定、客观且完整。不存在使其无效的缺陷。可以继续进行求解过程。\n\n### 求解推导与设计\n\n#### 1. Rayleigh 阻尼的模态阻尼比\n\n分析始于齐次条件下第 $j$ 阶模态的解耦运动方程 $m_j \\ddot{q}_j + c_j \\dot{q}_j + k_j q_j = 0$。该方程可用模态质量 $m_j$ 进行归一化，得到：\n$$\n\\ddot{q}_j + \\frac{c_j}{m_j} \\dot{q}_j + \\frac{k_j}{m_j} q_j = 0\n$$\n根据模态问题的定义，我们有 $k_j = \\omega_j^2 m_j$，因此 $\\frac{k_j}{m_j} = \\omega_j^2$。有阻尼单自由度系统的标准形式为 $\\ddot{x} + 2\\zeta\\omega \\dot{x} + \\omega^2 x = 0$。通过比较系数，我们确定 $2\\zeta_j \\omega_j = \\frac{c_j}{m_j}$。\n\n模态阻尼系数 $c_j$ 由阻尼矩阵 $C$ 在模态基上的投影给出：$c_j = \\phi_j^{\\top} C \\phi_j$。代入 Rayleigh 阻尼模型 $C = a_0 M + a_1 K$ 可得：\n$$\nc_j = \\phi_j^{\\top} (a_0 M + a_1 K) \\phi_j = a_0 (\\phi_j^{\\top} M \\phi_j) + a_1 (\\phi_j^{\\top} K \\phi_j)\n$$\n使用模态质量 $m_j = \\phi_j^{\\top} M \\phi_j$ 和模态刚度 $k_j = \\phi_j^{\\top} K \\phi_j$ 的定义，上式变为：\n$$\nc_j = a_0 m_j + a_1 k_j\n$$\n现在，将 $c_j$ 的这个表达式代入阻尼比的关系式：\n$$\n2\\zeta_j \\omega_j = \\frac{a_0 m_j + a_1 k_j}{m_j} = a_0 + a_1 \\frac{k_j}{m_j}\n$$\n由于 $\\frac{k_j}{m_j} = \\omega_j^2$，我们有：\n$$\n2\\zeta_j \\omega_j = a_0 + a_1 \\omega_j^2\n$$\n将模态阻尼比 $\\zeta_j$ 解出为自振频率 $\\omega_j$ 的函数，即可得到所需的表达式：\n$$\n\\zeta_j \\equiv \\zeta(\\omega_j) = \\frac{1}{2\\omega_j}(a_0 + a_1 \\omega_j^2) = \\frac{a_0}{2\\omega_j} + \\frac{a_1 \\omega_j}{2}\n$$\n\n#### 2. Rayleigh 阻尼系数 $(a_0, a_1)$ 的设计\n\n系数 $a_0$ 和 $a_1$ 通过求解基于所提供规格的二元线性方程组来确定：\n1.  在 $\\omega_L = 20$ 处，$\\zeta(\\omega_L) = 0.05$。\n2.  在 $\\omega_H = 200$ 处，$\\zeta(\\omega_H) = 0.02$。\n\n将这些值代入 $\\zeta(\\omega)$ 的表达式中：\n1.  $0.05 = \\frac{a_0}{2(20)} + \\frac{a_1(20)}{2} \\implies 0.05 = \\frac{a_0}{40} + 10 a_1$\n2.  $0.02 = \\frac{a_0}{2(200)} + \\frac{a_1(200)}{2} \\implies 0.02 = \\frac{a_0}{400} + 100 a_1$\n\n我们来解这个方程组。将第一个方程乘以 $40$，第二个方程乘以 $400$：\n1.  $40 \\times 0.05 = a_0 + 400 a_1 \\implies 2 = a_0 + 400 a_1$\n2.  $400 \\times 0.02 = a_0 + 40000 a_1 \\implies 8 = a_0 + 40000 a_1$\n\n将变换后的第一个方程从第二个方程中减去，得到：\n$$\n(8-2) = (a_0 + 40000 a_1) - (a_0 + 400 a_1)\n$$\n$$\n6 = 39600 a_1\n$$\n$$\na_1 = \\frac{6}{39600} = \\frac{1}{6600}\n$$\n现在，将 $a_1$ 代回第一个变换后的方程（$2 = a_0 + 400 a_1$）中，求出 $a_0$：\n$$\n2 = a_0 + 400 \\left(\\frac{1}{6600}\\right) = a_0 + \\frac{4}{66} = a_0 + \\frac{2}{33}\n$$\n$$\na_0 = 2 - \\frac{2}{33} = \\frac{66-2}{33} = \\frac{64}{33}\n$$\nRayleigh 阻尼系数为 $a_0 = \\frac{64}{33} \\, \\text{s}^{-1}$ 和 $a_1 = \\frac{1}{6600} \\, \\text{s}$。\n\n#### 3. 广义-$\\alpha$ 方法中的算法耗散\n\n广义-$\\alpha$ 方法引入了由其参数控制的数值耗散。为保证二阶精度，参数 $\\beta$ 和 $\\gamma$ 与 $\\alpha_m$ 和 $\\alpha_f$ 相关联。该方法的显著特征是它能够通过谱半径 $\\rho_\\infty \\in [0, 1]$ 来控制高频耗散，谱半径是放大因子的模在频率与时间步长的乘积 $\\omega \\Delta t$ 趋于无穷大时的极限。$\\rho_\\infty$ 与主要参数 $(\\alpha_m, \\alpha_f)$ 之间的关系是设计该格式的定义性关系。对于期望的 $\\rho_\\infty$，参数选择如下：\n$$\n\\alpha_m = \\frac{2-\\rho_\\infty}{1+\\rho_\\infty}, \\quad \\alpha_f = \\frac{1}{1+\\rho_\\infty}\n$$\n这些选择确保了无条件稳定性和二阶精度。在本问题中，设计规格为 $\\rho_\\infty = \\frac{3}{5}$。因此，这个值是时间积分格式设计的直接输入。\n\n#### 4. 阻尼机制的比较\n\n这两种阻尼机制基于不同原理运作，并针对系统动力响应的不同方面。\n\n**Rayleigh 阻尼：**\n-   **性质**：表示材料内部或系统边界处的物理能量耗散。它是物理模型的一部分，由矩阵 $C = a_0 M + a_1 K$ 描述。\n-   **频率依赖性**：阻尼比 $\\zeta(\\omega) = \\frac{a_0}{2\\omega} + \\frac{a_1 \\omega}{2}$ 高度依赖于频率。质量比例项 ($a_0$) 提供的阻尼随频率增加而减小，而刚度比例项 ($a_1$) 提供的阻尼随频率增加而增加。这导致 $\\zeta(\\omega)$ 呈 U 形曲线，在 $\\omega = \\sqrt{a_0/a_1}$ 处有最小值。对于我们设计的参数，该最小值出现在 $\\omega = \\sqrt{(\\frac{64}{33}) / (\\frac{1}{6600})} \\approx 113.14 \\, \\text{rad/s}$。阻尼被调整为在特定频带内较低，而在极低和极高频率下都会增加。指定的阻尼值 $0.05$ 和 $0.02$ 相当低，这对于低应变下的地质材料是典型的。\n\n**广义-$\\alpha$ 算法耗散：**\n-   **性质**：这是时间积分算法的一种数值产物，而不是物理过程的表示。其目的纯粹是数学上的：抑制由空间离散化（例如，有限元网格划分）引起且无法被网格精确表示的虚假的、非物理的高频振荡。\n-   **频率依赖性**：该耗散被设计为选择性地作用于高频。对于 $\\omega \\Delta t \\ll 1$ 的低频模态，算法阻尼比可以忽略不计，从而确保物理上重要的慢动态能够以最小的人为阻尼被精确积分。随着频率 $\\omega$ 的增加，算法阻尼比单调增加，并趋近于由 $\\rho_\\infty$ 决定的最大值。当 $\\Delta t = 0.005 \\, \\text{s}$ 时，对于频率满足 $\\omega \\Delta t$ 在 $1$ 或更大数量级的模态（即 $\\omega \\ge \\frac{1}{0.005} = 200 \\, \\text{rad/s}$），其影响变得显著。\n-   **控制**：参数 $\\rho_\\infty$ 提供了对高频阻尼量的直接控制。$\\rho_\\infty = 1$ 的值对应于无耗散（能量守恒），而 $\\rho_\\infty = 0$ 对应于最大耗散（在一个步长内渐近地消除高频响应）。指定的 $\\rho_\\infty = \\frac{3}{5} = 0.6$ 提供了中等水平的高频阻尼。\n\n**比较总结：**\n-   **物理与数值**：Rayleigh 阻尼模拟物理现象。广义-$\\alpha$ 耗散是一种数值工具。\n-   **目标频谱**：如此处所设计的 Rayleigh 阻尼，在选定的低频和高频处提供特定的阻尼水平，具有特征性的 U 形剖面。广义-$\\alpha$ 耗散起到低通滤波器的作用，以递增的强度作用于某个阈值（由 $\\Delta t$ 决定）以上的所有频率，直至达到由 $\\rho_\\infty$ 设定的上限。\n-   **目的**：它们共同使用以实现两个不同的目标：模拟系统已知的物理能量损失（Rayleigh）和通过过滤高频数值噪声来确保数值鲁棒性（广义-$\\alpha$）。\n\n最终的设计三元组 $(a_0, a_1, \\rho_\\infty)$ 由计算出的 Rayleigh 系数和指定的谱半径组成。\n$a_0 = \\frac{64}{33}$\n$a_1 = \\frac{1}{6600}$\n$\\rho_\\infty = \\frac{3}{5}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{64}{33}  \\frac{1}{6600}  \\frac{3}{5} \\end{pmatrix}}\n$$", "id": "3527639"}]}