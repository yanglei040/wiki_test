{"hands_on_practices": [{"introduction": "在深入研究复杂的计算模型之前，我们必须首先掌握波在介质中传播的基本物理原理。土壤介质很少是完全均匀的，因此波在不同土层界面上的行为是岩土力学分析中的一个核心问题。本练习将通过一个经典场景——剪切波（SH波）在两个弹性土层界面上的斜入射，引导您动手计算反射和透射系数，并验证能量守恒原理。通过这个实践[@problem_id:3570860]，您将加深对波阻抗、Snell定律以及能量如何在界面处分配的理解，为分析更复杂的多层系统奠定坚实的基础。", "problem": "一束平面、时谐、水平偏振的剪切波（SH波）在一个软、均匀、各向同性、完全弹性的土层（介质$1$）中斜向传播，并入射到一个与硬、均匀、各向同性、完全弹性的半空间（介质$2$）焊接的平面界面上。界面位于 $z=0$，土层占据 $z<0$ 的区域，半空间占据 $z>0$ 的区域。设坐标 $z$ 向下为正。波从介质 $1$ 入射，入射角 $\\theta_1$ 是与界面法线（$+z$ 轴）的夹角。假设没有内在衰减，也没有波型转换（纯 SH 运动）。\n\n材料属性如下：\n- 介质 $1$（软土）：密度 $\\,\\rho_1 = 1700\\,\\mathrm{kg/m^3}\\,$，剪切波速 $\\,\\beta_1 = 250\\,\\mathrm{m/s}\\,$。\n- 介质 $2$（硬半空间）：密度 $\\,\\rho_2 = 2200\\,\\mathrm{kg/m^3}\\,$，剪切波速 $\\,\\beta_2 = 400\\,\\mathrm{m/s}\\,$。\n\n取入射角为 $\\theta_1 = 30^{\\circ}$（度）。您可以使用以下基本原理：\n- 线性动量平衡（动力学平衡）和线性弹性的胡克定律。\n- 平面波运动学 $\\,u_y(\\mathbf{x},t) = \\Re\\{A \\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)]\\}\\,$ 以及 SH 运动的本构关系 $\\,\\tau_{yz} = \\mu\\,\\partial u_y/\\partial z\\,$，其中 $\\mu = \\rho \\beta^2$。\n- 界面两侧切向位移和剪切牵引力的连续性。\n- 水平波数的守恒（斯涅尔定律）。\n\n定义位移振幅的平面波反射系数和透射系数为 $\\,R = A_r/A_i\\,$ 和 $\\,T = A_t/A_i\\,$，其中 $A_i$、$A_r$ 和 $A_t$ 分别是入射波、反射波和透射波的位移振幅。\n\n计算此结构下的 $R$ 和 $T$，然后评估能量平衡表达式\n$$\\mathcal{E} \\equiv |R|^2 + \\left(\\frac{Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1}\\right)|T|^2,$$\n其中 $\\,Z_j = \\rho_j \\beta_j\\,$，$\\theta_2$ 是由斯涅尔定律决定的介质 $2$ 中的透射角。将 $\\,\\mathcal{E}\\,$ 的值报告为一个无单位的数值，四舍五入到四位有效数字。角度应以度为单位处理。", "solution": "该问题陈述经核实具有科学依据、提法恰当且客观。它描述了剪切波在弹性界面上反射和透射的标准物理情景，对此存在唯一且有意义的解。所有必要的参数和控制原理都已提供，不存在内部矛盾或事实错误。\n\n问题要求评估一束水平偏振剪切波（SH波）入射到两个弹性介质之间的平面界面时的能量平衡表达式。\n\n设界面为平面 $z=0$。介质 $1$ 占据 $z<0$ 的区域，介质 $2$ 占据 $z>0$ 的区域。位移场 $u_y(x,z,t)$ 纯粹在 $y$ 方向上。介质 $1$ 中的总波场是入射波和反射波的叠加，而介质 $2$ 中的场由透射波组成。\n\n介质 $1$ 中的入射波由下式给出\n$$u_i(x,z,t) = A_i \\exp[i(k_x x + k_{z1} z - \\omega t)]$$\n介质 $1$ 中的反射波为\n$$u_r(x,z,t) = A_r \\exp[i(k_x x - k_{z1} z - \\omega t)]$$\n介质 $2$ 中的透射波为\n$$u_t(x,z,t) = A_t \\exp[i(k_x x + k_{z2} z - \\omega t)]$$\n其中 $A_i$、$A_r$ 和 $A_t$ 分别是入射波、反射波和透射波的复振幅。角频率为 $\\omega$。水平波数 $k_x$ 在界面两侧是守恒的。垂直波数在介质 $1$ 中为 $k_{z1}$，在介质 $2$ 中为 $k_{z2}$。\n\n波数与入射角 $\\theta_1$ 和透射角 $\\theta_2$（均从法线，即 $z$ 轴测量）的关系如下：\n$$k_x = k_1 \\sin\\theta_1 = k_2 \\sin\\theta_2$$\n$$k_{z1} = k_1 \\cos\\theta_1$$\n$$k_{z2} = k_2 \\cos\\theta_2$$\n其中 $k_j = \\omega/\\beta_j$ 是介质 $j$ ($j=1,2$) 中的总波数，$\\beta_j$ 是剪切波速。$k_x$ 的守恒导致斯涅尔定律：\n$$\\frac{\\sin\\theta_1}{\\beta_1} = \\frac{\\sin\\theta_2}{\\beta_2}$$\n\n在焊接界面（$z=0$）处，必须满足两个边界条件：\n$1$. 位移连续性：介质 $1$ 中的总位移必须等于介质 $2$ 中的位移。\n$$u_i(x,0,t) + u_r(x,0,t) = u_t(x,0,t)$$\n代入波形并消去公共指数项 $\\exp[i(k_x x - \\omega t)]$，得到：\n$$A_i + A_r = A_t$$\n两边同除以 $A_i$ 并使用定义 $R = A_r/A_i$ 和 $T = A_t/A_i$，我们得到第一个方程：\n$$1 + R = T$$\n\n$2$. 剪切牵引力连续性：剪切牵引力 $\\tau_{yz}$ 在界面两侧必须连续。本构关系为 $\\tau_{yz} = \\mu (\\partial u_y / \\partial z)$，其中 $\\mu = \\rho \\beta^2$ 是剪切模量。\n在介质 $1$ 中，总牵引力为 $\\tau_{yz,1} = \\mu_1 \\frac{\\partial}{\\partial z}(u_i + u_r) = \\mu_1(i k_{z1} u_i - i k_{z1} u_r)$。\n在介质 $2$ 中，牵引力为 $\\tau_{yz,2} = \\mu_2 \\frac{\\partial u_t}{\\partial z} = \\mu_2(i k_{z2} u_t)$。\n在 $z=0$ 处使牵引力相等：\n$$\\mu_1 k_{z1} (A_i - A_r) = \\mu_2 k_{z2} A_t$$\n代入 $k_{zj} = (\\omega/\\beta_j)\\cos\\theta_j$ 和 $\\mu_j = \\rho_j \\beta_j^2$：\n$$\\rho_1 \\beta_1^2 \\left(\\frac{\\omega}{\\beta_1}\\cos\\theta_1\\right) (A_i - A_r) = \\rho_2 \\beta_2^2 \\left(\\frac{\\omega}{\\beta_2}\\cos\\theta_2\\right) A_t$$\n简化后得到：\n$$(\\rho_1 \\beta_1 \\cos\\theta_1) (A_i - A_r) = (\\rho_2 \\beta_2 \\cos\\theta_2) A_t$$\n定义剪切波阻抗 $Z_j = \\rho_j \\beta_j$，方程变为：\n$$Z_1 \\cos\\theta_1 (A_i - A_r) = Z_2 \\cos\\theta_2 A_t$$\n两边同除以 $A_i$ 得到第二个方程：\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 T$$\n\n我们现在求解由两个方程组成的方程组，以求出 $R$ 和 $T$：\n$$1 + R = T$$\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 T$$\n将第一个方程代入第二个方程：\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 (1 + R)$$\n$$Z_1 \\cos\\theta_1 - R Z_1 \\cos\\theta_1 = Z_2 \\cos\\theta_2 + R Z_2 \\cos\\theta_2$$\n$$R (Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2) = Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2$$\n因此，反射系数为：\n$$R = \\frac{Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2}$$\n透射系数为：\n$$T = 1 + R = 1 + \\frac{Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2} = \\frac{2 Z_1 \\cos\\theta_1}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2}$$\n\n问题要求评估能量平衡表达式：\n$$\\mathcal{E} \\equiv |R|^2 + \\left(\\frac{Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1}\\right)|T|^2$$\n该表达式代表了垂直于界面的能量流守恒。第一项是能量流反射系数，第二项是能量流透射系数。对于一个无损系统，它们的和必须为1。我们将通过解析方法证明这一点。\n为方便起见，令 $Z'_1 = Z_1 \\cos\\theta_1$ 和 $Z'_2 = Z_2 \\cos\\theta_2$。则系数为 $R = (Z'_1 - Z'_2) / (Z'_1 + Z'_2)$ 和 $T = 2Z'_1 / (Z'_1 + Z'_2)$。所有物理参数（$\\rho_j, \\beta_j$）都是实数，只要不发生全内反射，$\\cos\\theta_2$ 就是实数。给定的参数为 $\\beta_1=250\\,\\mathrm{m/s}$，$\\beta_2=400\\,\\mathrm{m/s}$，$\\theta_1=30^{\\circ}$。斯涅尔定律给出 $\\sin\\theta_2 = (\\beta_2/\\beta_1)\\sin\\theta_1 = (400/250)\\sin(30^{\\circ}) = 1.6 \\times 0.5 = 0.8$。由于 $|\\sin\\theta_2|  1$，角度 $\\theta_2$ 是实数，因此 $R$ 和 $T$ 是实数值。因此， $|R|^2 = R^2$ 且 $|T|^2 = T^2$。\n\n将 $R$ 和 $T$ 的表达式代入 $\\mathcal{E}$：\n$$\\mathcal{E} = \\left(\\frac{Z'_1 - Z'_2}{Z'_1 + Z'_2}\\right)^2 + \\left(\\frac{Z'_2}{Z'_1}\\right)\\left(\\frac{2Z'_1}{Z'_1 + Z'_2}\\right)^2$$\n$$\\mathcal{E} = \\frac{(Z'_1 - Z'_2)^2}{(Z'_1 + Z'_2)^2} + \\frac{Z'_2}{Z'_1} \\frac{4(Z'_1)^2}{(Z'_1 + Z'_2)^2}$$\n简化第二项：\n$$\\mathcal{E} = \\frac{(Z'_1)^2 - 2Z'_1Z'_2 + (Z'_2)^2}{(Z'_1 + Z'_2)^2} + \\frac{4Z'_1Z'_2}{(Z'_1 + Z'_2)^2}$$\n合并公共分母上的分数：\n$$\\mathcal{E} = \\frac{(Z'_1)^2 - 2Z'_1Z'_2 + (Z'_2)^2 + 4Z'_1Z'_2}{(Z'_1 + Z'_2)^2}$$\n$$\\mathcal{E} = \\frac{(Z'_1)^2 + 2Z'_1Z'_2 + (Z'_2)^2}{(Z'_1 + Z'_2)^2}$$\n分子是 $(Z'_1 + Z'_2)^2$ 的展开式：\n$$\\mathcal{E} = \\frac{(Z'_1 + Z'_2)^2}{(Z'_1 + Z'_2)^2} = 1$$\n这证实了能量平衡表达式恒等于 $1$，反映了这个无损系统的能量守恒原理。问题中提供的数值与此物理原理一致。\n\n问题要求将 $\\mathcal{E}$ 的数值四舍五入到四位有效数字。由于 $\\mathcal{E}$ 解析上等于 $1$，其值就是精确的 $1$。表示为四位有效数字即为 $1.000$。", "answer": "$$\\boxed{1.000}$$", "id": "3570860"}, {"introduction": "虽然解析解为我们提供了深刻的物理洞见，但大多数真实的岩土工程问题因其复杂的几何和材料非均质性，必须依赖于数值方法，如有限元法（FEM）。然而，将连续的物理世界离散化会不可避免地引入数值误差。本练习[@problem_id:3570882]聚焦于波动模拟中最关键的数值伪影之一——数值频散。您将推导出一维有限元模型中波的传播速度如何因空间离散而变得依赖于频率，并量化这种相速度误差，最终确定为保证模拟精度所需的每个波长最少单元数。这个过程对于任何从事波动计算模拟的工程师或研究人员来说都是一项至关重要的技能。", "problem": "考虑在密度为 $\\rho$、剪切模量为 $G$ 的均匀线性弹性土中一维（$1$D）剪切波的传播。剪切波位移 $u(x,t)$ 满足二阶双曲型偏微分方程 $\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}} = G\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$，其中剪切波速为 $c_{s} = \\sqrt{G/\\rho}$。使用双节点线性形函数和一致质量矩阵的标准 Galerkin 有限元法（FEM），通过尺寸为 $h$ 的均匀网格对空间域进行离散化。假设网格是无限、均匀的，因此可以使用 Bloch 形式的行波拟设。\n\n从上述偏微分方程和标准 Galerkin 半离散格式出发，对于形式为 $u_{j}(t) = U \\exp\\!\\big(i (j K - \\Omega\\, c_{s} t / h)\\big)$（其中 $j$ 是节点索引）的谐波解，推导连接无量纲角频率 $\\Omega = \\omega h / c_{s}$ 和无量纲波数 $K = k h$ 的半离散数值色散关系。利用此色散关系，定义数值相速度 $c_{p}^{\\text{num}}(K) = \\omega/k = c_{s}\\,\\Omega/K$，并明确地将相对相速度误差 $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}(K)/c_{s} - 1 = \\Omega(K)/K - 1$ 表示为 $K$ 的函数。所有角度必须以弧度处理。\n\n最后，设每个波长内的有限元数量为 $n_{e} = \\lambda / h$，因此 $K = 2\\pi/n_{e}$。确定最小整数 $n_{e}$，使得相对相速度误差满足 $\\varepsilon_{p}(2\\pi/n_{e}) \\le 0.01$。报告每个波长的最小整数单元数。最终答案无需单位。", "solution": "该问题要求使用带线性单元的 Galerkin 有限元法（FEM）推导一维剪切波传播的数值色散关系，然后利用此关系找到每个波长的最小单元数 $n_e$，以使相对相速度误差保持在指定容差以下。\n\n首先，我们验证问题陈述的有效性。\n问题提供了一维剪切波传播的控制偏微分方程（PDE）：\n$\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}} = G\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$\n其中 $\\rho$ 是密度， $G$ 是剪切模量， $u(x,t)$ 是剪切位移。精确的剪切波速为 $c_{s} = \\sqrt{G/\\rho}$。空间域使用尺寸为 $h$ 的均匀网格进行离散化，并采用具有双节点线性形函数和一致质量矩阵的标准 Galerkin 有限元法。假设网格是无限的，允许使用 Bloch 形式的行波解 $u_{j}(t) = U \\exp\\!\\big(i (j K - \\Omega\\, c_{s} t / h)\\big)$，其中 $j$ 是节点索引，$K = k h$ 是无量纲波数，$\\Omega = \\omega h / c_{s}$ 是无量纲角频率。任务是推导相对相速度误差 $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}(K)/c_{s} - 1 = \\Omega(K)/K - 1$ 并找到最小整数 $n_{e} = \\lambda/h = 2\\pi/K$ 使得 $\\varepsilon_{p}(2\\pi/n_{e}) \\le 0.01$。\n\n该问题基于标准波动方程和有限元法，具有科学依据。它提法恰当、客观且自成体系。所有术语都明确定义，没有矛盾之处。无限网格的理想化是数值色散分析的标准程序。因此，该问题是有效的。\n\n我们首先建立偏微分方程的 Galerkin 弱形式。对于任意测试函数 $w(x)$，在长度为 $h$（从 $x_j$ 到 $x_{j+1}$）的单个有限元上的弱形式为：\n$$ \\int_{x_j}^{x_{j+1}} w \\left( \\rho \\frac{\\partial^2 u}{\\partial t^2} - G \\frac{\\partial^2 u}{\\partial x^2} \\right) dx = 0 $$\n对第二项进行分部积分得到：\n$$ \\int_{x_j}^{x_{j+1}} \\left( w \\rho \\frac{\\partial^2 u}{\\partial t^2} + \\frac{\\partial w}{\\partial x} G \\frac{\\partial u}{\\partial x} \\right) dx - \\left[ w G \\frac{\\partial u}{\\partial x} \\right]_{x_j}^{x_{j+1}} = 0 $$\n在 Galerkin 方法中，位移场 $u(x,t)$ 和测试函数 $w(x)$ 使用相同的形函数进行近似。对于一个双节点线性单元，设局部坐标为 $\\zeta = (x-x_{j})/h \\in [0, 1]$。位移近似为 $u(\\zeta, t) = N_j(\\zeta) u_j(t) + N_{j+1}(\\zeta) u_{j+1}(t)$，其中形函数为 $N_j(\\zeta) = 1-\\zeta$ 和 $N_{j+1}(\\zeta) = \\zeta$。\n以矩阵形式表示，$u(\\zeta, t) = \\mathbf{N}(\\zeta) \\mathbf{u}_e(t)$，其中 $\\mathbf{N} = \\begin{pmatrix} 1-\\zeta  \\zeta \\end{pmatrix}$ 且 $\\mathbf{u}_e = \\begin{pmatrix} u_j(t)  u_{j+1}(t) \\end{pmatrix}^T$。测试函数类似地选择为 $w(x) = \\mathbf{N}(\\zeta) \\mathbf{w}_e$，其中 $\\mathbf{w}_e$ 是任意节点值的向量。\n将这些近似代入一个单元的弱形式，得到单元方程 $\\mathbf{M}_e \\ddot{\\mathbf{u}}_e + \\mathbf{K}_e \\mathbf{u}_e = \\mathbf{f}_e$，其中 $\\mathbf{f}_e$ 表示分部积分产生的边界项。单元一致质量矩阵 $\\mathbf{M}_e$ 和刚度矩阵 $\\mathbf{K}_e$ 分别为：\n$$ \\mathbf{M}_e = \\int_{0}^{1} \\rho (\\mathbf{N}(\\zeta))^T \\mathbf{N}(\\zeta) \\, h \\, d\\zeta $$\n$$ \\mathbf{K}_e = \\int_{0}^{1} G \\left(\\frac{d\\mathbf{N}}{dx}\\right)^T \\frac{d\\mathbf{N}}{dx} \\, h \\, d\\zeta = \\int_{0}^{1} G \\left(\\frac{1}{h}\\frac{d\\mathbf{N}}{d\\zeta}\\right)^T \\left(\\frac{1}{h}\\fracd\\mathbf{N}}{d\\zeta}\\right) \\, h \\, d\\zeta = \\frac{G}{h} \\int_{0}^{1} (\\mathbf{N}'(\\zeta))^T \\mathbf{N}'(\\zeta) \\, d\\zeta $$\n$\\mathbf{N}'(\\zeta)$ 的分量为 $\\frac{dN_j}{d\\zeta}=-1$ 和 $\\frac{dN_{j+1}}{d\\zeta}=1$。\n计算积分得到：\n$$ \\mathbf{M}_e = \\rho h \\int_0^1 \\begin{pmatrix} (1-\\zeta)^2  \\zeta(1-\\zeta) \\\\ \\zeta(1-\\zeta)  \\zeta^2 \\end{pmatrix} d\\zeta = \\frac{\\rho h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n$$ \\mathbf{K}_e = \\frac{G}{h} \\int_0^1 \\begin{pmatrix} (-1)^2  (-1)(1) \\\\ (1)(-1)  (1)^2 \\end{pmatrix} d\\zeta = \\frac{G}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n对于无限网格，我们通过对两个相邻单元（单元 $j-1$ 跨越节点 $j-1, j$ 和单元 $j$ 跨越节点 $j, j+1$）的贡献求和，来组装一个通用内部节点 $j$ 的方程。单元间的边界项在组装时相互抵消。节点 $j$ 的最终半离散方程为：\n$$ \\frac{\\rho h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{G}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0 $$\n我们现在代入给定的谐波行波拟设 $u_j(t) = U \\exp(i(jK - \\omega t))$。其二阶时间导数为 $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$。将此式和拟设代入节点 $j$ 的方程中：\n$$ -\\omega^2 \\frac{\\rho h}{6} \\left( e^{i(j-1)K} + 4e^{ijK} + e^{i(j+1)K} \\right) + \\frac{G}{h} \\left( -e^{i(j-1)K} + 2e^{ijK} - e^{i(j+1)K} \\right) = 0 $$\n除以公因子 $e^{ijK}$ 得到：\n$$ -\\omega^2 \\frac{\\rho h}{6} (e^{-iK} + 4 + e^{iK}) + \\frac{G}{h} (-e^{-iK} + 2 - e^{iK}) = 0 $$\n使用 Euler 恒等式 $e^{iK} + e^{-iK} = 2\\cos(K)$，方程简化为：\n$$ -\\omega^2 \\frac{\\rho h}{6} (2\\cos(K) + 4) + \\frac{G}{h} (-2\\cos(K) + 2) = 0 $$\n求解 $\\omega^2$：\n$$ \\omega^2 \\rho h (2 + \\cos(K))/3 = \\frac{2G}{h} (1 - \\cos(K)) $$\n$$ \\omega^2 = \\frac{6G}{\\rho h^2} \\frac{1 - \\cos(K)}{2 + \\cos(K)} $$\n使用 $c_s^2 = G/\\rho$，我们得到数值色散关系：\n$$ \\omega^2 = c_s^2 \\frac{6}{h^2} \\frac{1 - \\cos(K)}{2 + \\cos(K)} $$\n为了得到无量纲形式，我们使用 $\\Omega = \\omega h / c_s$：\n$$ \\Omega^2 = \\frac{\\omega^2 h^2}{c_s^2} = \\frac{6(1-\\cos(K))}{2+\\cos(K)} $$\n数值相速度为 $c_{p}^{\\text{num}} = \\omega/k$。使用 $\\omega = \\Omega c_s / h$ 和 $k = K/h$，我们有 $c_{p}^{\\text{num}} = (\\Omega c_s / h) / (K/h) = c_s \\Omega/K$。\n相对相速度误差定义为 $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}/c_s - 1$：\n$$ \\varepsilon_{p}(K) = \\frac{\\Omega(K)}{K} - 1 = \\frac{1}{K} \\sqrt{\\frac{6(1-\\cos(K))}{2+\\cos(K)}} - 1 $$\n我们需要找到最小整数 $n_e$，使得当 $K=2\\pi/n_e$ 时 $\\varepsilon_{p}(K) \\le 0.01$。该不等式为：\n$$ \\frac{1}{2\\pi/n_e} \\sqrt{\\frac{6(1-\\cos(2\\pi/n_e))}{2+\\cos(2\\pi/n_e)}} - 1 \\le 0.01 $$\n设 $K = 2\\pi/n_e$。不等式变为 $\\frac{\\Omega(K)}{K} \\le 1.01$。两边平方：\n$$ \\left(\\frac{\\Omega(K)}{K}\\right)^2 = \\frac{6(1-\\cos(K))}{K^2(2+\\cos(K))} \\le (1.01)^2 = 1.0201 $$\n左边的函数是 $n_e$ 的递减函数（或对于小的 $K$ 是 $K$ 的递增函数）。我们需要找到满足条件的最小整数 $n_e$。我们可以测试 $n_e$ 的整数值。\n对于 $\\varepsilon_{p}(K)$ 在 $K=0$ 附近的 Taylor 级数展开，我们发现 $\\varepsilon_{p}(K) \\approx K^2/24$。通过求解 $(2\\pi/n_e)^2/24 \\approx 0.01$ 可以估算 $n_e$，得到 $n_e \\approx \\sqrt{(2\\pi)^2/(0.24)} \\approx 12.8$。这表明答案很可能是 $13$。\n\n我们来测试 $n_e=12$：\n$K = 2\\pi/12 = \\pi/6$。\n$\\cos(\\pi/6) = \\sqrt{3}/2$。\n$$ \\varepsilon_p(\\pi/6) = \\frac{6}{\\pi} \\sqrt{\\frac{6(1-\\sqrt{3}/2)}{2+\\sqrt{3}/2}} - 1 = \\frac{6}{\\pi} \\sqrt{\\frac{6(2-\\sqrt{3})}{4+\\sqrt{3}}} - 1 $$\n数值上，$\\sqrt{3} \\approx 1.73205$，$\\pi \\approx 3.14159$。\n$$ \\varepsilon_p(\\pi/6) \\approx \\frac{6}{3.14159} \\sqrt{\\frac{6(2-1.73205)}{4+1.73205}} - 1 \\approx 1.90986 \\sqrt{\\frac{1.6077}{5.73205}} - 1 $$\n$$ \\varepsilon_p(\\pi/6) \\approx 1.90986 \\sqrt{0.28048} - 1 \\approx 1.90986 \\times 0.5296 - 1 \\approx 1.0113 - 1 = 0.0113 $$\n由于 $0.0113  0.01$，所以 $n_e=12$ 是不够的。\n\n我们来测试 $n_e=13$：\n$K=2\\pi/13$。我们需要计算 $\\varepsilon_p(2\\pi/13) = \\frac{13}{2\\pi} \\sqrt{\\frac{6(1-\\cos(2\\pi/13))}{2+\\cos(2\\pi/13)}} - 1$。\n$2\\pi/13 \\approx 0.483307$ 弧度。\n$\\cos(2\\pi/13) \\approx 0.885451$。\n$$ \\varepsilon_p(2\\pi/13) \\approx \\frac{13}{2 \\times 3.14159} \\sqrt{\\frac{6(1 - 0.885451)}{2 + 0.885451}} - 1 \\approx 2.0690 \\sqrt{\\frac{6(0.114549)}{2.885451}} - 1 $$\n$$ \\varepsilon_p(2\\pi/13) \\approx 2.0690 \\sqrt{\\frac{0.687294}{2.885451}} - 1 \\approx 2.0690 \\sqrt{0.23819} - 1 $$\n$$ \\varepsilon_p(2\\pi/13) \\approx 2.0690 \\times 0.48805 - 1 \\approx 1.0097 - 1 = 0.0097 $$\n由于 $0.0097 \\le 0.01$，所以 $n_e=13$ 是足够的。\n随着 $n_e$ 的增加，误差减小，因此每个波长的最小整数单元数是 $13$。", "answer": "$$ \\boxed{13} $$", "id": "3570882"}, {"introduction": "在有限元动力分析的框架内，我们不仅要关注空间离散带来的影响，还需在不同的数值构造方案之间做出权衡。本练习[@problem_id:3570883]将引导您深入探讨动力问题的核心——质量矩阵的两种不同形式：一致质量矩阵和集中质量矩阵。通过对一个简单的双单元土柱模型进行特征频率分析，您将亲手推导和计算这两种方法所得的系统固有频率，并将其与精确解进行比较。这个实践将揭示不同质量矩阵对高阶振动模式精度的影响，帮助您理解在计算效率和求解精度之间进行明智选择的实际意义。", "problem": "考虑一维剪切波在长度为 $L$、横截面积为 $A$、质量密度为 $\\rho$、剪切模量为 $G$ 的均质土柱中的传播。位移场 $u(x,t)$ 在 $x \\in [0,L]$ 上满足一维剪切波方程 $\\rho A \\,\\frac{\\partial^{2} u}{\\partial t^{2}} = G A \\,\\frac{\\partial^{2} u}{\\partial x^{2}}$，其边界条件为固定底 $u(0,t)=0$ 和自由表面 $G \\,\\frac{\\partial u}{\\partial x}(L,t)=0$。使用标准的伽辽金有限元法（FE），在由2个等长（$h=L/2$）单元组成的均匀网格上采用线性形函数，执行以下步骤：\n\n1. 从自由振动的弱形式出发，推导一致质量公式和集中质量公式的半离散有限元方程。组装全局刚度矩阵和质量矩阵，施加 $x=0$ 处的基本边界条件，并将系统简化为关于剩余节点自由度的 $2 \\times 2$ 广义特征值问题。\n\n2. 引入剪切波速 $c=\\sqrt{G/\\rho}$ 和无量纲频率平方参数 $\\gamma = \\omega^{2} h^{2} / c^{2}$，其中 $\\omega$ 是圆频率。对两种质量公式（一致质量和集中质量）分别推导两个特征值 $\\gamma$，并指出每种情况下的最高特征值。\n\n3. 对于具有给定边界条件的连续系统，其精确固有频率为 $\\omega_{n} = \\frac{(2n-1)\\pi c}{2L}$，$n=1,2,\\dots$。计算第二阶模态的精确无量纲频率 $\\eta_{\\text{true}} = \\omega_{2} h / c$，以及两种质量公式下最高模态的有限元无量纲频率 $\\eta_{c}$ 和 $\\eta_{l}$，其中 $\\eta=\\sqrt{\\gamma}$。\n\n4. 将频率的相对误差大小定义为 $e = \\left|\\frac{\\eta - \\eta_{\\text{true}}}{\\eta_{\\text{true}}}\\right|$。计算最高模态下，一致质量公式和集中质量公式所得误差之间的标量差 $\\Delta = e_{c} - e_{l}$。\n\n将您计算出的 $\\Delta$ 的最终数值答案四舍五入到四位有效数字，并以无量纲小数表示。", "solution": "问题陈述已被解析和验证。所有提供的信息都是自洽的，科学上基于连续介质力学和有限元法的原理，并且是客观陈述的。该问题是适定的和完整的。因此，将推导求解。\n\n一维剪切波方程由下式给出：\n$$ \\rho A \\frac{\\partial^{2} u}{\\partial t^{2}} = G A \\frac{\\partial^{2} u}{\\partial x^{2}} \\quad \\text{for } x \\in [0, L] $$\n边界条件为固定底 $u(0,t)=0$ 和自由表面 $G \\frac{\\partial u}{\\partial x}(L,t)=0$。\n\n### 步骤1：推导半离散有限元方程\n\n我们首先建立控制方程的弱形式。将方程乘以一个满足基本边界条件（此处为 $v(0)=0$）的检验函数 $v(x)$，并在定义域 $[0, L]$ 上积分，得到：\n$$ \\int_{0}^{L} v(x) \\left( \\rho A \\frac{\\partial^{2} u}{\\partial t^{2}} - G A \\frac{\\partial^{2} u}{\\partial x^{2}} \\right) dx = 0 $$\n对第二项进行分部积分，得到：\n$$ \\int_{0}^{L} \\rho A v \\frac{\\partial^{2} u}{\\partial t^{2}} dx + \\int_{0}^{L} G A \\frac{\\partial v}{\\partial x} \\frac{\\partial u}{\\partial x} dx - \\left[ G A v \\frac{\\partial u}{\\partial x} \\right]_{0}^{L} = 0 $$\n边界项为 $G A v(L) \\frac{\\partial u}{\\partial x}(L,t) - G A v(0) \\frac{\\partial u}{\\partial x}(0,t)$。$x=L$ 处的自由表面条件使得第一项为零。$v(0)=0$ 的条件使得第二项为零。因此，自由振动的弱形式为：\n$$ \\int_{0}^{L} \\rho A v \\frac{\\partial^{2} u}{\\partial t^{2}} dx + \\int_{0}^{L} G A \\frac{\\partial v}{\\partial x} \\frac{\\partial u}{\\partial x} dx = 0 $$\n将定义域离散为两个等长的线性有限元，单元长度 $h = L/2$。节点位于 $x_0=0$，$x_1=h$ 和 $x_2=2h=L$。位移场近似为 $u(x,t) \\approx \\sum_{i=0}^{2} N_i(x) u_i(t)$，其中 $N_i$ 是全局形函数，$u_i$ 是节点位移。使用伽辽金法，我们令 $v(x) = N_j(x)$，其中 $j=0,1,2$。这得到半离散系统 $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$，其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{K}$ 是刚度矩阵，$\\mathbf{u} = \\{u_0, u_1, u_2\\}^T$。\n\n对于长度为 $h$ 的单个线性单元，其单元刚度矩阵 $\\mathbf{k}^e$ 和一致质量矩阵 $\\mathbf{m}_c^e$ 分别为：\n$$ \\mathbf{k}^e = \\frac{GA}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad \\mathbf{m}_c^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n对两个单元（节点 $0-1$ 和 $1-2$）的矩阵进行组装，得到全局 $3 \\times 3$ 矩阵：\n$$ \\mathbf{K} = \\frac{GA}{h} \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}, \\quad \\mathbf{M}_c = \\frac{\\rho A h}{6} \\begin{pmatrix} 2  1  0 \\\\ 1  4  1 \\\\ 0  1  2 \\end{pmatrix} $$\n集中质量矩阵 $\\mathbf{M}_l$ 是通过对 $\\mathbf{M}_c$ 的各行求和，并将结果置于对角线上得到的：\n第 0 行和：$\\frac{\\rho A h}{6}(2+1) = \\frac{\\rho A h}{2}$。第 1 行和：$\\frac{\\rho A h}{6}(1+4+1) = \\rho A h$。第 2 行和：$\\frac{\\rho A h}{6}(1+2) = \\frac{\\rho A h}{2}$。\n$$ \\mathbf{M}_l = \\rho A h \\begin{pmatrix} 1/2  0  0 \\\\ 0  1  0 \\\\ 0  0  1/2 \\end{pmatrix} $$\n基本边界条件 $u(0,t)=0$ 意味着 $u_0=0$。我们通过移除全局矩阵的第一行和第一列来简化系统。剩余的自由度为 $\\mathbf{d} = \\{u_1, u_2\\}^T$。\n简化后的 $2 \\times 2$ 刚度矩阵为：\n$$ \\mathbf{K}_{red} = \\frac{GA}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} $$\n简化后的 $2 \\times 2$ 一致质量矩阵为：\n$$ \\mathbf{M}_{c,red} = \\frac{\\rho A h}{6} \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} $$\n简化后的 $2 \\times 2$ 集中质量矩阵为：\n$$ \\mathbf{M}_{l,red} = \\rho A h \\begin{pmatrix} 1  0 \\\\ 0  1/2 \\end{pmatrix} $$\n对于简谐运动 $\\mathbf{d}(t) = \\hat{\\mathbf{d}} e^{i\\omega t}$，半离散方程变为一个广义特征值问题：$(\\mathbf{K}_{red} - \\omega^2 \\mathbf{M}_{red}) \\hat{\\mathbf{d}} = \\mathbf{0}$。\n\n### 步骤2：推导特征值 $\\gamma$\n\n我们引入剪切波速 $c = \\sqrt{G/\\rho}$ 和无量纲参数 $\\gamma = \\omega^2 h^2 / c^2 = \\omega^2 h^2 \\rho / G$。特征值问题可以写成 $\\det(\\mathbf{K}_{red} - \\omega^2 \\mathbf{M}_{red}) = 0$。\n\n**一致质量公式：**\n$$ \\det\\left( \\frac{GA}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} - \\omega^2 \\frac{\\rho A h}{6} \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} - \\frac{\\omega^2 \\rho h^2}{6G} \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} \\right) = 0 $$\n代入 $\\gamma = \\omega^2 \\rho h^2 / G$：\n$$ \\det\\left( \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} - \\frac{\\gamma}{6} \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} \\right) = \\det \\begin{pmatrix} 2 - \\frac{2\\gamma}{3}  -1 - \\frac{\\gamma}{6} \\\\ -1 - \\frac{\\gamma}{6}  1 - \\frac{\\gamma}{3} \\end{pmatrix} = 0 $$\n$$ \\left(2 - \\frac{2\\gamma}{3}\\right)\\left(1 - \\frac{\\gamma}{3}\\right) - \\left(-1 - \\frac{\\gamma}{6}\\right)^2 = 0 $$\n$$ 2 - \\frac{4\\gamma}{3} + \\frac{2\\gamma^2}{9} - \\left(1 + \\frac{\\gamma}{3} + \\frac{\\gamma^2}{36}\\right) = 0 $$\n$$ 1 - \\frac{5\\gamma}{3} + \\frac{7\\gamma^2}{36} = 0 \\implies 7\\gamma^2 - 60\\gamma + 36 = 0 $$\n方程的根为 $\\gamma_c = \\frac{60 \\pm \\sqrt{60^2 - 4(7)(36)}}{14} = \\frac{60 \\pm \\sqrt{3600-1008}}{14} = \\frac{60 \\pm \\sqrt{2592}}{14} = \\frac{60 \\pm 36\\sqrt{2}}{14} = \\frac{30 \\pm 18\\sqrt{2}}{7}$。\n最高特征值为 $\\gamma_{c,high} = \\frac{30 + 18\\sqrt{2}}{7}$。\n\n**集中质量公式：**\n$$ \\det\\left( \\frac{GA}{h} \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} - \\omega^2 \\rho A h \\begin{pmatrix} 1  0 \\\\ 0  1/2 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix} - \\frac{\\omega^2 \\rho h^2}{G} \\begin{pmatrix} 1  0 \\\\ 0  1/2 \\end{pmatrix} \\right) = 0 $$\n代入 $\\gamma$：\n$$ \\det \\begin{pmatrix} 2 - \\gamma  -1 \\\\ -1  1 - \\gamma/2 \\end{pmatrix} = 0 $$\n$$ (2 - \\gamma)(1 - \\gamma/2) - 1 = 0 \\implies 2 - 2\\gamma + \\frac{\\gamma^2}{2} - 1 = 0 $$\n$$ \\gamma^2 - 4\\gamma + 2 = 0 $$\n方程的根为 $\\gamma_l = \\frac{4 \\pm \\sqrt{16-8}}{2} = \\frac{4 \\pm 2\\sqrt{2}}{2} = 2 \\pm \\sqrt{2}$。\n最高特征值为 $\\gamma_{l,high} = 2 + \\sqrt{2}$。\n\n### 步骤3：无量纲频率\n\n连续系统的精确固有频率为 $\\omega_n = \\frac{(2n-1)\\pi c}{2L}$。对于第二阶模态（$n=2$）且 $L=2h$，我们有：\n$$ \\omega_2 = \\frac{(2(2)-1)\\pi c}{2(2h)} = \\frac{3\\pi c}{4h} $$\n第二阶模态的精确无量纲频率为 $\\eta_{\\text{true}} = \\frac{\\omega_2 h}{c}$：\n$$ \\eta_{\\text{true}} = \\frac{3\\pi}{4} $$\n最高模态（$n=2$）的有限元无量纲频率通过 $\\eta = \\sqrt{\\gamma}$ 计算。\n对于一致质量公式：\n$$ \\eta_c = \\sqrt{\\gamma_{c,high}} = \\sqrt{\\frac{30 + 18\\sqrt{2}}{7}} $$\n对于集中质量公式：\n$$ \\eta_l = \\sqrt{\\gamma_{l,high}} = \\sqrt{2 + \\sqrt{2}} $$\n\n### 步骤4：计算误差差值 $\\Delta$\n\n相对误差的大小定义为 $e = \\left|\\frac{\\eta - \\eta_{\\text{true}}}{\\eta_{\\text{true}}}\\right|$。\n数值上，$\\eta_{\\text{true}} = \\frac{3\\pi}{4} \\approx 2.3562$，$\\eta_c \\approx \\sqrt{7.9223} \\approx 2.8147$，以及 $\\eta_l \\approx \\sqrt{3.4142} \\approx 1.8478$。\n由于 $\\eta_c > \\eta_{\\text{true}}$ 且 $\\eta_l  \\eta_{\\text{true}}$：\n$$ e_c = \\frac{\\eta_c - \\eta_{\\text{true}}}{\\eta_{\\text{true}}} = \\frac{\\eta_c}{\\eta_{\\text{true}}} - 1 $$\n$$ e_l = \\frac{\\eta_{\\text{true}} - \\eta_l}{\\eta_{\\text{true}}} = 1 - \\frac{\\eta_l}{\\eta_{\\text{true}}} $$\n标量差 $\\Delta = e_c - e_l$ 为：\n$$ \\Delta = \\left(\\frac{\\eta_c}{\\eta_{\\text{true}}} - 1\\right) - \\left(1 - \\frac{\\eta_l}{\\eta_{\\text{true}}}\\right) = \\frac{\\eta_c + \\eta_l}{\\eta_{\\text{true}}} - 2 $$\n代入表达式：\n$$ \\Delta = \\frac{\\sqrt{\\frac{30 + 18\\sqrt{2}}{7}} + \\sqrt{2 + \\sqrt{2}}}{\\frac{3\\pi}{4}} - 2 = \\frac{4}{3\\pi}\\left(\\sqrt{\\frac{30 + 18\\sqrt{2}}{7}} + \\sqrt{2 + \\sqrt{2}}\\right) - 2 $$\n现在我们计算数值：\n$e_c = \\frac{\\sqrt{\\frac{30 + 18\\sqrt{2}}{7}}}{3\\pi/4} - 1 \\approx \\frac{2.81465155}{2.35619449} - 1 \\approx 1.19457490 - 1 = 0.19457490$\n$e_l = 1 - \\frac{\\sqrt{2 + \\sqrt{2}}}{3\\pi/4} \\approx 1 - \\frac{1.84775907}{2.35619449} \\approx 1 - 0.78421289 = 0.21578711$\n$$ \\Delta = e_c - e_l \\approx 0.19457490 - 0.21578711 \\approx -0.02121221 $$\n四舍五入到四位有效数字，结果为 $-0.02121$。", "answer": "$$\\boxed{-0.02121}$$", "id": "3570883"}]}