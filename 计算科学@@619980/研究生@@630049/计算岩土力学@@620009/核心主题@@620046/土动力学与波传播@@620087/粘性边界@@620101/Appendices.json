{"hands_on_practices": [{"introduction": "本练习从粘滞边界的核心原理——能量吸收——入手。通过将问题设定为一个优化任务，您将推导出 Lysmer-Kuhlemeyer 粘滞边界条件的理想参数。这个练习将帮助您直观地理解为何阻抗匹配是最小化人工边界上波反射的关键 [@problem_id:3570030]。", "problem": "您需要推导并实现一种用于 Lysmer-Kuhlemeyer 粘性边界的校准方法。Lysmer-Kuhlemeyer 边界是通过在弹性半空间的截断边界上施加法向和切向阻尼器来吸收向外传播的波。其边界牵引力定律由 $t_n = -\\alpha_n \\rho c_p v_n$ 和 $t_t = -\\alpha_t \\rho c_s v_t$ 给出，其中 $t_n$ 和 $t_t$ 分别是法向和切向牵引力，$\\rho$ 是质量密度，$c_p$ 是压缩波波速，$c_s$ 是剪切波波速，$v_n$ 和 $v_t$ 是边界质点速度的法向和切向分量，而 $\\alpha_n$ 和 $\\alpha_t$ 是待校准的无量纲缩放因子。您的目标是在特定测试问题的约束条件下，确定能使反射能量最小化的 $\\alpha_n$ 和 $\\alpha_t$ 的值。\n\n从线性弹性动力学和能量通量的有效基础出发。对于线性弹性介质中的平面波，牵引力-应力与质点速度通过波阻抗和传播方向相关联。对于一维时谐平面波，应力幅值通过阻抗 $Z=\\rho c$ 与质点速度幅值成正比，能量通量密度与 $Z v^2$ 成正比，其中 $v$ 是质点速度幅值。在上述阻尼器边界条件下，通过在边界上施加牵引力平衡，反射问题简化为在每个方向（法向和切向）上寻找与边界相关的振幅反射系数。\n\n使用牛顿第二定律和牵引力平衡，从第一性原理出发，推导边界在法向和切向上的振幅反射系数。然后，将反射能量表示为 $\\alpha_n$ 和 $\\alpha_t$ 的函数。最后，在测试套件中提供的 $\\alpha_n$ 和 $\\alpha_t$ 的边界条件下，最小化反射能量。您必须用 LaTeX 呈现所有数学实体，并且您的推导必须从所述基本基础开始，而不是从目标公式或中间捷径开始。\n\n为入射波的叠加定义反射能量泛函。对于一组具有规定边界速度分量的入射波，定义\n$$\nA_n = \\rho c_p \\sum_j v_{n,j}^2,\\quad\nA_t = \\rho c_s \\sum_j v_{t,j}^2,\n$$\n其中 $v_{n,j}$ 和 $v_{t,j}$ 是与入射波 $j$ 相关的边界质点速度的法向和切向分量。对于振幅为 $v_0$、极化角为 $\\theta$（质点运动相对于边界外法线的角度）的波，边界速度分量为 $v_n = v_0 \\cos(\\theta)$ 和 $v_t = v_0 \\sin(\\theta)$。假设叠加原理成立，且在边界阻尼器模型中模式不耦合，因此法向和切向的反射能量可以独立处理。\n\n您必须实现一个程序，该程序：\n- 从牵引力平衡条件推导法向和切向的振幅反射系数 $r_n(\\alpha_n)$ 和 $r_t(\\alpha_t)$。\n- 构建能量泛函\n$$\nE_{\\mathrm{ref}}(\\alpha_n,\\alpha_t) = A_n\\,r_n(\\alpha_n)^2 + A_t\\,r_t(\\alpha_t)^2,\n$$\n并在给定边界内关于 $\\alpha_n$ 和 $\\alpha_t$ 对其进行最小化。最小化的能量应表示为功率通量密度，单位为 $\\mathrm{J/(s\\cdot m^2)}$。\n- 使用下面的测试套件计算每种情况下的最优 $(\\alpha_n,\\alpha_t)$ 和最小化的反射能量。\n\n角度单位说明：所有角度 $\\theta$ 均以弧度给出，并且必须以弧度使用。物理单位：$\\rho$ 单位为 $\\mathrm{kg/m^3}$，$c_p$ 和 $c_s$ 单位为 $\\mathrm{m/s}$，$v_0$ 单位为 $\\mathrm{m/s}$，最终反射能量单位为 $\\mathrm{J/(s\\cdot m^2)}$。\n\n测试套件（每种情况指定 $(\\rho, c_p, c_s)$、入射波的振幅和角度，以及 $\\alpha_n$ 和 $\\alpha_t$ 的边界）：\n\n- 情况 1（典型土壤，混合入射）：\n    - $\\rho = 2000\\ \\mathrm{kg/m^3}$，$c_p = 2000\\ \\mathrm{m/s}$，$c_s = 800\\ \\mathrm{m/s}$。\n    - 入射P波：$v_{0,P} = 0.01\\ \\mathrm{m/s}$，角度为 $\\theta = 0$ 和 $\\theta = \\pi/6$。\n    - 入射S波（单个）：$v_{0,S} = 0.01\\ \\mathrm{m/s}$，角度为 $\\theta = \\pi/4$。\n    - 边界：$\\alpha_n \\in [0.5, 2.0]$，$\\alpha_t \\in [0.5, 2.0]$。\n\n- 情况 2（岩石，掠射入射加权切向运动）：\n    - $\\rho = 2700\\ \\mathrm{kg/m^3}$，$c_p = 6000\\ \\mathrm{m/s}$，$c_s = 3464\\ \\mathrm{m/s}$。\n    - 入射P波：$v_{0,P} = 0.005\\ \\mathrm{m/s}$，角度为 $\\theta = 1.3962634015954636$。\n    - 入射S波：$v_{0,S} = 0.008\\ \\mathrm{m/s}$，角度为 $\\theta = 0.3490658503988659$ 和 $\\theta = 1.3962634015954636$。\n    - 边界：$\\alpha_n \\in [0.8, 1.5]$，$\\alpha_t \\in [0.8, 1.5]$。\n\n- 情况 3（软土，约束边界不包含 1）：\n    - $\\rho = 1800\\ \\mathrm{kg/m^3}$，$c_p = 1500\\ \\mathrm{m/s}$，$c_s = 300\\ \\mathrm{m/s}$。\n    - 入射P波：$v_{0,P} = 0.02\\ \\mathrm{m/s}$，角度为 $\\theta = 1.0471975511965976$。\n    - 入射S波：$v_{0,S} = 0.015\\ \\mathrm{m/s}$，角度为 $\\theta = 1.3089969389957472$。\n    - 边界：$\\alpha_n \\in [1.2, 2.0]$，$\\alpha_t \\in [0.6, 0.9]$。\n\n- 情况 4（极小振幅，稳定性边界情况）：\n    - $\\rho = 2000\\ \\mathrm{kg/m^3}$，$c_p = 1700\\ \\mathrm{m/s}$，$c_s = 700\\ \\mathrm{m/s}$。\n    - 入射P波：$v_{0,P} = 1.0\\times10^{-6}\\ \\mathrm{m/s}$，角度为 $\\theta = 0.3490658503988659$。\n    - 入射S波：$v_{0,S} = 2.0\\times10^{-6}\\ \\mathrm{m/s}$，角度为 $\\theta = 0.17453292519943295$。\n    - 边界：$\\alpha_n \\in [1.5, 3.0]$，$\\alpha_t \\in [1.5, 3.0]$。\n\n您的程序应生成一行输出，包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是 $[\\alpha_n^\\star,\\alpha_t^\\star,E_{\\mathrm{ref}}^\\star]$ 形式的三个浮点数列表，并按测试用例的顺序排列。例如，程序必须打印类似 \"[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\" 的单行，行内任何地方都没有空格，其中 $a_k$、$b_k$ 和 $c_k$ 是为情况 $k$ 计算出的浮点数。", "solution": "该问题提法恰当且科学合理，基于线性弹性动力学和波传播的既定原理。Lysmer-Kuhlemeyer 边界条件是计算力学中用于模拟无界域的标准技术。所有需要的数据和约束都已提供。此问题有效。\n\n求解过程分两个阶段：首先，推导振幅反射系数；其次，构建并求解能量最小化问题。\n\n**1. 振幅反射系数的推导**\n\nLysmer-Kuhlemeyer 粘性边界由牵引力定律 $t_n = -\\alpha_n \\rho c_p v_n$ 和 $t_t = -\\alpha_t \\rho c_s v_t$ 定义。我们将推导法向分量的反射系数 $r_n$；切向分量 $r_t$ 的推导是类似的。\n\n考虑一个占据 $x \\le 0$ 区域的半无限弹性介质，其边界位于 $x=0$。介质的外法线方向为 $+x$ 方向。一列平面压缩波（P波）沿 $+x$ 方向朝边界传播。这是入射波。在边界处，部分波被反射，并沿 $-x$ 方向传播。\n\n对于角频率为 $\\omega$ 的时谐平面波，位移场可以用复数表示法写出。\n入射波，沿 $+x$ 方向传播，其形式为：\n$$ u_I(x, t) = \\hat{U}_I e^{i(\\omega t - k_p x)} $$\n其中 $\\hat{U}_I$ 是复位移振幅，而 $k_p = \\omega / c_p$ 是 P波波数。\n\n质点速度 $v_I(x,t)$ 和法向应力 $\\sigma_{xx,I}(x,t)$ 分别是：\n$$ v_I(x, t) = \\frac{\\partial u_I}{\\partial t} = i \\omega \\hat{U}_I e^{i(\\omega t - k_p x)} = i \\omega u_I(x,t) $$\n$$ \\sigma_{xx,I}(x,t) = (\\lambda+2\\mu) \\frac{\\partial u_I}{\\partial x} = -i k_p (\\lambda+2\\mu) \\hat{U}_I e^{i(\\omega t - k_p x)} $$\n使用 P波波速的定义 $c_p = \\sqrt{(\\lambda+2\\mu)/\\rho}$，我们可以写出 $\\lambda+2\\mu = \\rho c_p^2$。将此式和 $k_p = \\omega/c_p$ 代入应力方程：\n$$ \\sigma_{xx,I}(x,t) = -i \\frac{\\omega}{c_p} (\\rho c_p^2) u_I(x,t) = -i \\omega \\rho c_p u_I(x,t) $$\n将其与速度进行比较，我们发现入射波的应力与速度之间的关系：\n$$ \\sigma_{xx,I}(x,t) = -\\rho c_p v_I(x,t) $$\n项 $Z_p = \\rho c_p$ 是介质的 P波阻抗。\n\n反射波，沿 $-x$ 方向传播，其形式为：\n$$ u_R(x, t) = \\hat{U}_R e^{i(\\omega t + k_p x)} $$\n经过类似的推导，速度和应力为：\n$$ v_R(x,t) = i \\omega u_R(x,t) $$\n$$ \\sigma_{xx,R}(x,t) = (\\lambda+2\\mu) \\frac{\\partial u_R}{\\partial x} = +i k_p (\\lambda+2\\mu) u_R(x,t) = i \\omega \\rho c_p u_R(x,t) $$\n反射波的应力-速度关系为：\n$$ \\sigma_{xx,R}(x,t) = +\\rho c_p v_R(x,t) $$\n\n在边界 $x=0$ 处，总速度 $v_n$ 和总法向应力 $\\sigma_{xx}$ 是入射和反射分量的和：\n$$ v_n(t) = v(0,t) = v_I(0,t) + v_R(0,t) $$\n$$ \\sigma_{xx}(t) = \\sigma(0,t) = \\sigma_{xx,I}(0,t) + \\sigma_{xx,R}(0,t) = -\\rho c_p v_I(0,t) + \\rho c_p v_R(0,t) $$\n\n边界条件施加在牵引力上。在 $x=0$ 边界平面上的牵引力 $t_n$ 由 $t_n = \\sigma_{xx}(0,t)$ 给出。法向运动的 Lysmer-Kuhlemeyer 边界条件为：\n$$ t_n = -\\alpha_n \\rho c_p v_n(t) $$\n代入边界上的总应力和总速度表达式：\n$$ -\\rho c_p v_I(0,t) + \\rho c_p v_R(0,t) = -\\alpha_n \\rho c_p (v_I(0,t) + v_R(0,t)) $$\n除以非零的 $\\rho c_p$：\n$$ -v_I(0,t) + v_R(0,t) = -\\alpha_n (v_I(0,t) + v_R(0,t)) $$\n设 $V_I$ 和 $V_R$ 分别为边界上的速度振幅（即 $v_I(0,t)$ 和 $v_R(0,t)$）。该方程对所有时间 $t$ 都成立，因此我们可以为振幅写出此方程：\n$$ -V_I + V_R = -\\alpha_n V_I - \\alpha_n V_R $$\n$$ V_R(1 + \\alpha_n) = V_I(1 - \\alpha_n) $$\n振幅反射系数 $r_n$ 是反射速度振幅与入射速度振幅之比，$r_n = V_R / V_I$：\n$$ r_n(\\alpha_n) = \\frac{1 - \\alpha_n}{1 + \\alpha_n} $$\n对于质点运动与边界相切的剪切波（S波），使用 S波阻抗 $Z_s = \\rho c_s$ 进行类似的推导，可得到切向反射系数 $r_t$：\n$$ r_t(\\alpha_t) = \\frac{1 - \\alpha_t}{1 + \\alpha_t} $$\n\n**2. 能量最小化问题**\n\n目标是找到 $\\alpha_n$ 和 $\\alpha_t$ 的值，以最小化给定入射波组的反射能量。反射能量泛函由下式给出：\n$$ E_{\\mathrm{ref}}(\\alpha_n,\\alpha_t) = A_n\\,r_n(\\alpha_n)^2 + A_t\\,r_t(\\alpha_t)^2 $$\n其中 $A_n = \\rho c_p \\sum_j v_{n,j}^2$ 且 $A_t = \\rho c_s \\sum_j v_{t,j}^2$。\n代入推导出的反射系数：\n$$ E_{\\mathrm{ref}}(\\alpha_n,\\alpha_t) = A_n \\left( \\frac{1-\\alpha_n}{1+\\alpha_n} \\right)^2 + A_t \\left( \\frac{1-\\alpha_t}{1+\\alpha_t} \\right)^2 $$\n该目标函数是可分的，即它是一个仅依赖于 $\\alpha_n$ 的函数与一个仅依赖于 $\\alpha_t$ 的函数之和。\n$$ E_{\\mathrm{ref}}(\\alpha_n,\\alpha_t) = E_n(\\alpha_n) + E_t(\\alpha_t) $$\n我们可以独立地最小化 $E_n$ 和 $E_t$。让我们分析函数 $f(\\alpha) = \\left( \\frac{1-\\alpha}{1+\\alpha} \\right)^2$，其中 $\\alpha > 0$。由于 $A_n \\ge 0$ 和 $A_t \\ge 0$，最小化 $E_{\\mathrm{ref}}$ 等价于最小化 $f(\\alpha_n)$ 和 $f(\\alpha_t)$。\n\n函数 $f(\\alpha)$ 是非负的。当分子为零时，即 $\\alpha=1$ 时，它达到其绝对最小值 $0$。这对应于完美吸收，此时粘性阻尼器的阻抗与弹性介质的阻抗相匹配。\n\n该优化问题受边界约束：$\\alpha_n \\in [\\alpha_{n,\\min}, \\alpha_{n,\\max}]$ 和 $\\alpha_t \\in [\\alpha_{t,\\min}, \\alpha_{t,\\max}]$。\n为了在区间 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 上找到 $f(\\alpha)$ 的最小值，我们考察其导数：\n$$ f'(\\alpha) = \\frac{d}{d\\alpha} \\left( \\frac{1-\\alpha}{1+\\alpha} \\right)^2 = 2 \\left( \\frac{1-\\alpha}{1+\\alpha} \\right) \\frac{-1(1+\\alpha) - (1-\\alpha)(1)}{(1+\\alpha)^2} = \\frac{-4(1-\\alpha)}{(1+\\alpha)^3} $$\n对于 $\\alpha > 0$，$f'(\\alpha)$ 的符号由 $-(1-\\alpha) = \\alpha - 1$ 决定。\n- 如果 $\\alpha  1$，$f'(\\alpha)  0$，所以 $f(\\alpha)$ 是严格递减的。\n- 如果 $\\alpha  1$，$f'(\\alpha)  0$，所以 $f(\\alpha)$ 是严格递增的。\n这证实了全局最小值在 $\\alpha=1$ 处。\n\n对于约束问题，区间 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 上的最小值求解如下：\n- 如果无约束最小值 $\\alpha=1$ 位于区间内，即 $\\alpha_{\\min} \\le 1 \\le \\alpha_{\\max}$，则最优值为 $\\alpha^* = 1$。\n- 如果区间完全在 $1$ 的右侧，即 $1  \\alpha_{\\min}$，则函数在该区间上是递增的，所以最小值在左端点：$\\alpha^* = \\alpha_{\\min}$。\n- 如果区间完全在 $1$ 的左侧，即 $\\alpha_{\\max}  1$，则函数在该区间上是递减的，所以最小值在右端点：$\\alpha^* = \\alpha_{\\max}$。\n\n这个逻辑可以概括为在区间 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 中找到离 $1$ 最近的点。这等价于将值 $1$ 限制在给定范围内。\n因此，最优值 $\\alpha_n^*$ 和 $\\alpha_t^*$ 为：\n$$ \\alpha_n^* = \\max(\\alpha_{n,\\min}, \\min(1.0, \\alpha_{n,\\max})) $$\n$$ \\alpha_t^* = \\max(\\alpha_{t,\\min}, \\min(1.0, \\alpha_{t,\\max})) $$\n\n解决每个测试用例的算法如下：\n1.  对于每个振幅为 $v_{0,j}$、角度为 $\\theta_j$ 的入射波 $j$，计算速度分量 $v_{n,j} = v_{0,j} \\cos(\\theta_j)$ 和 $v_{t,j} = v_{0,j} \\sin(\\theta_j)$。\n2.  计算系数 $A_n = \\rho c_p \\sum_j v_{n,j}^2$ 和 $A_t = \\rho c_s \\sum_j v_{t,j}^2$。\n3.  通过将 $1.0$ 限制在其各自的边界区间内，确定最优因子 $\\alpha_n^*$ 和 $\\alpha_t^*$。\n4.  计算最小化的反射能量 $E_{\\mathrm{ref}}^* = A_n \\left( \\frac{1-\\alpha_n^*}{1+\\alpha_n^*} \\right)^2 + A_t \\left( \\frac{1-\\alpha_t^*}{1+\\alpha_t^*} \\right)^2$。\n5.  返回三元组 $[\\alpha_n^*, \\alpha_t^*, E_{\\mathrm{ref}}^*]$。\n\n对每个提供的测试用例都执行此程序。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Lysmer-Kuhlemeyer boundary calibration problem for a suite of test cases.\n    \"\"\"\n    \n    # Test suite data structure:\n    # (rho, cp, cs, list_of_waves, alpha_n_bounds, alpha_t_bounds)\n    # where list_of_waves is a list of (v0, theta) tuples.\n    test_cases = [\n        # Case 1\n        (2000.0, 2000.0, 800.0, \n         [(0.01, 0.0), (0.01, np.pi/6), (0.01, np.pi/4)],\n         (0.5, 2.0), (0.5, 2.0)),\n        # Case 2\n        (2700.0, 6000.0, 3464.0,\n         [(0.005, 1.3962634015954636), (0.008, 0.3490658503988659), (0.008, 1.3962634015954636)],\n         (0.8, 1.5), (0.8, 1.5)),\n        # Case 3\n        (1800.0, 1500.0, 300.0,\n         [(0.02, 1.0471975511965976), (0.015, 1.3089969389957472)],\n         (1.2, 2.0), (0.6, 0.9)),\n        # Case 4\n        (2000.0, 1700.0, 700.0,\n         [(1.0e-6, 0.3490658503988659), (2.0e-6, 0.17453292519943295)],\n         (1.5, 3.0), (1.5, 3.0)),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, cp, cs, waves, an_bounds, at_bounds = case\n        \n        # Step 1  2: Calculate An and At coefficients\n        sum_vn_sq = 0.0\n        sum_vt_sq = 0.0\n        \n        for v0, theta in waves:\n            vn = v0 * np.cos(theta)\n            vt = v0 * np.sin(theta)\n            sum_vn_sq += vn**2\n            sum_vt_sq += vt**2\n            \n        An = rho * cp * sum_vn_sq\n        At = rho * cs * sum_vt_sq\n        \n        # Step 3: Determine optimal alpha values\n        # The optimal alpha is 1.0, so we clamp 1.0 to the given bounds.\n        alpha_n_opt = max(an_bounds[0], min(1.0, an_bounds[1]))\n        alpha_t_opt = max(at_bounds[0], min(1.0, at_bounds[1]))\n        \n        # Step 4: Calculate minimized reflected energy\n        # Reflection coefficient r(alpha) = (1 - alpha) / (1 + alpha)\n        if alpha_n_opt == -1.0: # Avoid division by zero, though bounds prevent this\n            rn_opt_sq = 1.0\n        else:\n            rn_opt = (1.0 - alpha_n_opt) / (1.0 + alpha_n_opt)\n            rn_opt_sq = rn_opt**2\n\n        if alpha_t_opt == -1.0: # Avoid division by zero\n            rt_opt_sq = 1.0\n        else:\n            rt_opt = (1.0 - alpha_t_opt) / (1.0 + alpha_t_opt)\n            rt_opt_sq = rt_opt**2\n            \n        E_ref_min = An * rn_opt_sq + At * rt_opt_sq\n        \n        results.append([alpha_n_opt, alpha_t_opt, E_ref_min])\n    \n    # Final print statement in the exact required format\n    # Example: [[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\n    # Using a list comprehension and f-strings to ensure no spaces\n    result_strings = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3570030"}, {"introduction": "在掌握了阻抗匹配原理的基础上，本练习将转向实际的编程实现。您将开发一个算法，用于计算粘滞阻尼器施加在三维边界单元节点上的力。这项实践对于将粘滞边界集成到有限元等数值计算程序中至关重要，它要求您处理向量运算以及将运动分解为法向和切向分量 [@problem_id:3570002]。", "problem": "考虑一个线性弹性、均匀、各向同性的半空间，该半空间被一个人工边界截断，边界上根据 Lysmer-Kuhlemeyer 黏性边界模型施加了无反射阻尼器。设 $\\rho$ 表示质量密度，$c_p$ 表示压缩波速，$c_s$ 表示剪切波速。对于小应变线性弹性和单向行波，阻抗关系将沿外法向单位向量和切线方向的边界牵引力与质点速度等同起来。一个带有节点贡献面积的四边形边界单元将这些牵引力分配到节点力，且节点之间不产生耦合。假设在三维环境中，每个时间步都可以从诸如有限元法 (FEM) 的计算方案中获得节点外法向向量和节点速度向量。\n\n您的任务是，从基本原理出发，推导计算四边形边界单元每个节点上的节点阻尼器力向量所需的表达式，然后实现一个程序，对指定的测试套件执行这些计算。推导必须从以下原理开始：牵引力是作用在表面上的单位面积力；对于法向入射到线性弹性半空间边界上的平面波，牵引力通过力学阻抗与速度成正比。您必须仅使用以下基本依据：\n\n- 牛顿第二定律，即力等于质量乘以加速度，以及牵引力是单位面积上的力的定义。\n- 经过充分验证的一维弹性介质波传播的阻抗概念，其中力学阻抗定义为平面波的牵引力与质点速度之比。\n\n基于此，根据速度投影求出法向和切向牵引力分量的表达式，然后使用节点贡献面积组装节点力。请勿使用任何未基于这些依据的额外简化公式。\n\n实现要求：\n\n- 对于每个节点 $i$，其外法向向量为 $\\mathbf{n}_i$（不一定是单位长度），速度向量为 $\\mathbf{v}_i$，通过对 $\\mathbf{n}_i$ 进行归一化来计算单位法向量 $\\hat{\\mathbf{n}}_i$。计算标量法向速度 $v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$，法向速度向量 $\\mathbf{v}_{n,i} = v_{n,i}\\,\\hat{\\mathbf{n}}_i$，以及切向速度向量 $\\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i}$。\n- 根据阻抗关系，求出牵引力向量 $\\mathbf{t}_i$，并使用节点贡献面积 $A_i$ 组装节点阻尼器力 $\\mathbf{f}_i$。\n- 如果 $\\|\\mathbf{n}_i\\|=0$，则将 $\\hat{\\mathbf{n}}_i$ 视为未定义，并将该节点的 $\\mathbf{f}_i$ 设置为 $\\mathbf{0}$，因为边界方向是不适定的。\n\n单位与格式：\n\n- 所有力以牛顿（N）表示。速度必须以米/秒（m/s）为单位，密度以千克/立方米（kg/m$^3$）为单位，面积以平方米（m$^2$）为单位，波速以米/秒（m/s）为单位。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，且无空格。每个测试用例的结果必须是四个节点力向量的列表，其中每个节点力向量是一个包含三个浮点数 $[f_{x},f_{y},f_{z}]$ 的列表，四舍五入到六位小数。例如，单个测试用例的结果应如下所示：$[[f_{x,1},f_{y,1},f_{z,1}],[f_{x,2},f_{y,2},f_{z,2}],[f_{x,3},f_{y,3},f_{z,3}],[f_{x,4},f_{y,4},f_{z,4}]]$，总体输出为 $[$case1$,$case2$,$\\dots]$。\n\n测试套件规格：\n\n- 情况 $1$（一般情况，单位法向量）：\n  - $\\rho = 2000$ kg/m$^3$，$c_p = 3000$ m/s，$c_s = 1500$ m/s。\n  - $A_1=A_2=A_3=A_4=1.5$ m$^2$。\n  - $\\mathbf{n}_1=\\mathbf{n}_2=\\mathbf{n}_3=\\mathbf{n}_4=(0,0,1)$。\n  - $\\mathbf{v}_1=(0.2,0.0,-0.1)$ m/s, $\\mathbf{v}_2=(0.0,0.1,0.0)$ m/s, $\\mathbf{v}_3=(-0.1,-0.2,0.3)$ m/s, $\\mathbf{v}_4=(0.05,0.05,0.0)$ m/s。\n- 情况 $2$（零速度，混合法向量和面积）：\n  - $\\rho = 1800$ kg/m$^3$，$c_p = 2500$ m/s，$c_s = 1200$ m/s。\n  - $(A_1,A_2,A_3,A_4)=(0.8,1.2,1.0,0.9)$ m$^2$。\n  - $\\mathbf{n}_1=(1,0,0)$, $\\mathbf{n}_2=(0,1,0)$, $\\mathbf{n}_3=(0,0,1)$, $\\mathbf{n}_4=(1,1,0)$。\n  - $\\mathbf{v}_1=\\mathbf{v}_2=\\mathbf{v}_3=\\mathbf{v}_4=(0.0,0.0,0.0)$ m/s。\n- 情况 $3$（非单位法向量，一个零面积）：\n  - $\\rho = 2200$ kg/m$^3$，$c_p = 3200$ m/s，$c_s = 1600$ m/s。\n  - $(A_1,A_2,A_3,A_4)=(2.0,1.0,0.0,3.2)$ m$^2$。\n  - $\\mathbf{n}_1=(0,0,2)$, $\\mathbf{n}_2=(0,-3,0)$, $\\mathbf{n}_3=(1,0,1)$, $\\mathbf{n}_4=(-1,0,0)$。\n  - $\\mathbf{v}_1=(0.3,-0.1,0.4)$ m/s, $\\mathbf{v}_2=(-0.2,0.6,-0.1)$ m/s, $\\mathbf{v}_3=(0.0,0.0,0.5)$ m/s, $\\mathbf{v}_4=(-1.0,0.0,0.0)$ m/s。\n- 情况 $4$（高阻抗，斜法向量）：\n  - $\\rho = 2500$ kg/m$^3$，$c_p = 5000$ m/s，$c_s = 3000$ m/s。\n  - $A_1=A_2=A_3=A_4=0.1$ m$^2$。\n  - $\\mathbf{n}_1=(1,1,1)$, $\\mathbf{n}_2=(1,0,1)$, $\\mathbf{n}_3=(0,1,1)$, $\\mathbf{n}_4=(-1,1,0)$。\n  - $\\mathbf{v}_1=(2.0,-1.0,0.5)$ m/s, $\\mathbf{v}_2=(0.0,2.0,-2.0)$ m/s, $\\mathbf{v}_3=(-1.5,0.5,1.0)$ m/s, $\\mathbf{v}_4=(0.0,-0.5,0.5)$ m/s。\n\n您的程序必须计算每个测试用例中对应于一个时间步的瞬间的节点阻尼器力 $\\mathbf{f}_i$，并以指定格式生成所需的单行输出。不允许用户输入；测试套件中的所有参数必须在程序内部定义。", "solution": "该问题要求推导并实现 Lysmer-Kuhlemeyer 黏性边界在三维、线性弹性、均匀、各向同性介质中的节点阻尼器力。推导必须基于指定的基本原理。\n\n提供的基本原理是：\n$1$. 牵引力定义为单位面积上的力。\n$2$. 一维力学阻抗概念，该概念将弹性介质中传播的平面波的牵引力与质点速度联系起来。\n\n让我们开始推导。阻尼器是一个耗散元件；它施加在物体上的力与物体的速度成正比，且方向相反。对于代表远场介质的节点阻尼器，施加在计算网格节点 $i$ 上的力 $\\mathbf{f}_i$ 旨在吸收本会从人工边界反射的能量。这个力与该节点的牵引力 $\\mathbf{t}_i$ 相关。\n\n根据定义，牵引力是单位面积力的极限，$\\mathbf{t} = d\\mathbf{F}/dA$。在像有限元法这样的离散化数值模型中，我们考虑与节点 $i$ 相关联的有限节点贡献面积 $A_i$。该面积上的总力通过集中在节点上来近似。因此，节点 $i$ 上的阻尼器力 $\\mathbf{f}_i$ 与阻尼器为模拟无限介质而必须产生的牵引力 $\\mathbf{t}_i$ 相关。该牵引力必须与局部质点速度 $\\mathbf{v}_i$ 方向相反。因此，*阻尼器施加在节点上*的力为：\n$$ \\mathbf{f}_i = - A_i \\mathbf{t}_i $$\n这里，$\\mathbf{t}_i$ 是由于速度 $\\mathbf{v}_i$ 在无限介质中会产生的牵引力。我们的任务简化为求出该牵引力向量 $\\mathbf{t}_i$ 的表达式。\n\nLysmer-Kuhlemeyer 模型将出射波场近似为垂直于边界传播的平面压缩波（P波）和平面剪切波（S波）的叠加。对于一维波传播，牵引力与质点速度之比即为力学阻抗 $I$。对于P波，阻抗为 $I_p = \\rho c_p$，对于S波，阻抗为 $I_s = \\rho c_s$，其中 $\\rho$ 是质量密度，$c_p$ 是P波波速，$c_s$ 是S波波速。\n\n为了将这个一维概念应用于一般的三维边界，我们将节点 $i$ 处的质点速度向量 $\\mathbf{v}_i$ 分解为垂直于边界表面和与边界表面相切的分量。设节点 $i$ 处的外法向单位向量为 $\\hat{\\mathbf{n}}_i$。这是通过对给定的法向量 $\\mathbf{n}_i$ 进行归一化得到的：\n$$ \\hat{\\mathbf{n}}_i = \\frac{\\mathbf{n}_i}{\\|\\mathbf{n}_i\\|} \\quad \\text{对于 } \\|\\mathbf{n}_i\\| \\neq 0 $$\n如果 $\\|\\mathbf{n}_i\\| = 0$，则法向量未定义，问题指定力 $\\mathbf{f}_i$ 应为零向量，即 $\\mathbf{f}_i = \\mathbf{0}$。\n\n标量法向速度 $v_{n,i}$ 是 $\\mathbf{v}_i$ 在 $\\hat{\\mathbf{n}}_i$ 上的投影：\n$$ v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i $$\n法向速度向量 $\\mathbf{v}_{n,i}$ 则为：\n$$ \\mathbf{v}_{n,i} = v_{n,i} \\hat{\\mathbf{n}}_i = (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i $$\n切向速度向量 $\\mathbf{v}_{t,i}$ 是 $\\mathbf{v}_i$ 的剩余部分：\n$$ \\mathbf{v}_{t,i} = \\mathbf{v}_i - \\mathbf{v}_{n,i} $$\n\n根据 Lysmer-Kuhlemeyer 模型，速度的法向分量 $\\mathbf{v}_{n,i}$ 产生P波，从而引起法向牵引力 $\\mathbf{t}_{n,i}$。速度的切向分量 $\\mathbf{v}_{t,i}$ 产生S波，从而引起切向牵引力 $\\mathbf{t}_{t,i}$。我们将阻抗关系应用于每个分量：\n- 法向牵引力 $\\mathbf{t}_{n,i}$ 通过P波阻抗 $I_p$ 与法向速度 $\\mathbf{v}_{n,i}$ 相关：\n  $$ \\mathbf{t}_{n,i} = I_p \\mathbf{v}_{n,i} = (\\rho c_p) \\mathbf{v}_{n,i} $$\n- 切向牵引力 $\\mathbf{t}_{t,i}$ 通过S波阻抗 $I_s$ 与切向速度 $\\mathbf{v}_{t,i}$ 相关：\n  $$ \\mathbf{t}_{t,i} = I_s \\mathbf{v}_{t,i} = (\\rho c_s) \\mathbf{v}_{t,i} $$\n\n节点 $i$ 处的总牵引力向量 $\\mathbf{t}_i$ 是其法向和切向分量的向量和：\n$$ \\mathbf{t}_i = \\mathbf{t}_{n,i} + \\mathbf{t}_{t,i} = (\\rho c_p) \\mathbf{v}_{n,i} + (\\rho c_s) \\mathbf{v}_{t,i} $$\n\n将 $\\mathbf{v}_{n,i}$ 和 $\\mathbf{v}_{t,i}$ 的表达式代入 $\\mathbf{t}_i$ 的方程中：\n$$ \\mathbf{t}_i = (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) $$\n\n最后，我们将牵引力 $\\mathbf{t}_i$ 的这个表达式代入节点阻尼器力 $\\mathbf{f}_i$ 的方程中：\n$$ \\mathbf{f}_i = -A_i \\mathbf{t}_i = -A_i \\left[ (\\rho c_p) ((\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) + (\\rho c_s) (\\mathbf{v}_i - (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i) \\right] $$\n为了更高效地计算，可以重新整理此方程，将包含 $\\mathbf{v}_i$ 和 $(\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i$ 的项合并：\n$$ \\mathbf{f}_i = -A_i \\left[ (\\rho c_s) \\mathbf{v}_i + (\\rho c_p - \\rho c_s) (\\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i) \\hat{\\mathbf{n}}_i \\right] $$\n这是用于实现的最终表达式。\n\n计算给定节点 $i$ 的节点阻尼器力向量 $\\mathbf{f}_i$ 的算法如下：\n$1$. 获取节点的输入参数：材料属性 $\\rho$、$c_p$、$c_s$；节点贡献面积 $A_i$；节点外法向向量 $\\mathbf{n}_i$；以及节点速度向量 $\\mathbf{v}_i$。\n$2$. 计算法向量的模长 $N_i = \\|\\mathbf{n}_i\\|$。\n$3$. 如果 $N_i$ 等于 $0$，则方向是不适定的。将节点力设为 $\\mathbf{f}_i = (0, 0, 0)$ 并停止。\n$4$. 否则，计算单位法向量：$\\hat{\\mathbf{n}}_i = \\mathbf{n}_i / N_i$。\n$5$. 计算速度在单位法向量上的标量投影：$v_{n,i} = \\mathbf{v}_i \\cdot \\hat{\\mathbf{n}}_i$。\n$6$. 使用推导出的表达式计算节点力向量：\n    $$ \\mathbf{f}_i = -A_i \\rho \\left[ c_s \\mathbf{v}_i + (c_p - c_s) v_{n,i} \\hat{\\mathbf{n}}_i \\right] $$\n$7$. 如果所有输入量都使用问题陈述中指定的相干国际单位制单位，则所得向量 $\\mathbf{f}_i$ 的单位为力（牛顿）。对边界单元的所有节点重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal dashpot forces for a Lysmer-Kuhlemeyer viscous boundary\n    based on a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"rho\": 2000.0, \"cp\": 3000.0, \"cs\": 1500.0,\n            \"areas\": [1.5, 1.5, 1.5, 1.5],\n            \"normals\": [(0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0), (0.0, 0.0, 1.0)],\n            \"velocities\": [(0.2, 0.0, -0.1), (0.0, 0.1, 0.0), (-0.1, -0.2, 0.3), (0.05, 0.05, 0.0)],\n        },\n        {\n            \"rho\": 1800.0, \"cp\": 2500.0, \"cs\": 1200.0,\n            \"areas\": [0.8, 1.2, 1.0, 0.9],\n            \"normals\": [(1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0), (1.0, 1.0, 0.0)],\n            \"velocities\": [(0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2200.0, \"cp\": 3200.0, \"cs\": 1600.0,\n            \"areas\": [2.0, 1.0, 0.0, 3.2],\n            \"normals\": [(0.0, 0.0, 2.0), (0.0, -3.0, 0.0), (1.0, 0.0, 1.0), (-1.0, 0.0, 0.0)],\n            \"velocities\": [(0.3, -0.1, 0.4), (-0.2, 0.6, -0.1), (0.0, 0.0, 0.5), (-1.0, 0.0, 0.0)],\n        },\n        {\n            \"rho\": 2500.0, \"cp\": 5000.0, \"cs\": 3000.0,\n            \"areas\": [0.1, 0.1, 0.1, 0.1],\n            \"normals\": [(1.0, 1.0, 1.0), (1.0, 0.0, 1.0), (0.0, 1.0, 1.0), (-1.0, 1.0, 0.0)],\n            \"velocities\": [(2.0, -1.0, 0.5), (0.0, 2.0, -2.0), (-1.5, 0.5, 1.0), (0.0, -0.5, 0.5)],\n        }\n    ]\n\n    all_results_str = []\n    \n    for case_data in test_cases:\n        rho = case_data[\"rho\"]\n        cp = case_data[\"cp\"]\n        cs = case_data[\"cs\"]\n        \n        areas = np.array(case_data[\"areas\"], dtype=float)\n        normals = np.array(case_data[\"normals\"], dtype=float)\n        velocities = np.array(case_data[\"velocities\"], dtype=float)\n        \n        case_forces = []\n        for i in range(4): # Loop over the 4 nodes of the quadrilateral element\n            A_i = areas[i]\n            n_i = normals[i]\n            v_i = velocities[i]\n            \n            # If area is zero, force is zero.\n            if A_i == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n                case_forces.append(f_i)\n                continue\n                \n            norm_n = np.linalg.norm(n_i)\n            \n            # Handle ill-posed normal vector.\n            if norm_n == 0.0:\n                f_i = np.array([0.0, 0.0, 0.0])\n            else:\n                n_hat_i = n_i / norm_n\n                \n                # Calculate scalar normal velocity\n                v_n_i_scalar = np.dot(v_i, n_hat_i)\n                \n                # Calculate nodal force using the derived formula:\n                # f_i = -A_i * (rho * cs * v_i + rho * (cp - cs) * v_n_i_scalar * n_hat_i)\n                term1 = cs * v_i\n                term2 = (cp - cs) * v_n_i_scalar * n_hat_i\n                f_i = -A_i * rho * (term1 + term2)\n\n            case_forces.append(f_i)\n\n        # Format the result for the current test case according to output specifications.\n        # This involves creating a string representation without spaces.\n        node_force_strs = []\n        for force_vec in case_forces:\n            # Round each component to 6 decimal places\n            force_vec_rounded = np.round(force_vec, 6)\n            # Format as [fx,fy,fz]\n            force_str = f'[{\",\".join(map(str, force_vec_rounded))}]'\n            node_force_strs.append(force_str)\n        \n        # Format as [[...],[...],[...],[...]]\n        case_str = f'[{\",\".join(node_force_strs)}]'\n        all_results_str.append(case_str)\n    \n    # Final print statement in the exact required format: [case1_str,case2_str,...]\n    final_output = f'[{\",\".join(all_results_str)}]'\n    print(final_output)\n\nsolve()\n```", "id": "3570002"}, {"introduction": "尽管粘滞边界非常有效，但它本质上是一种近似方法。最后一个练习将引导您从批判性的视角出发，通过解析方法量化 Lysmer-Kuhlemeyer 模型在复杂波场下的误差。通过比较精确的连续介质边界牵引力与边界条件给出的近似牵引力，您将更深入地理解该方法的局限性及其在非正入射波情况下的性能 [@problem_id:3569961]。", "problem": "您需要为计算岩土力学中由 Lysmer 和 Kuhlemeyer (Lysmer-Kuhlemeyer (LK)) 引入的粘性边界构建和评估解析基准。考虑小应变情况下的线性弹性动力学。重点是在长度为 $L$ 的有限域内的驻波场，该波场入射到一个施加了形式为 $t = Z u_t$（阻抗乘以速度，其中 $u_t$ 表示位移的时间导数）的粘性牵引力的边界上。您的任务是为每个基准计算一个无量纲误差，该误差用于量化边界上连续介质牵引力与 LK 粘性边界牵引力之间的不匹配程度。\n\n基本原理和定义：\n- 一维（$1\\mathrm{D}$）弹性杆满足波动方程 $u_{tt} = c^2 u_{xx}$，其中纵波波速为 $c = \\sqrt{E/\\rho}$，$E$ 是杨氏模量，$\\rho$ 是质量密度。\n- 对于二维（$2\\mathrm{D}$）平面应变，弹性本构律为 $\\sigma = \\lambda \\, \\mathrm{tr}(\\varepsilon) \\, I + 2 \\mu \\varepsilon$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数 (Lamé parameters)，$\\varepsilon$ 是位移 $\\mathbf{u}$ 的对称梯度，$\\sigma$ 是应力张量，$I$ 是单位张量。压缩波和剪切波的波速分别为 $c_p = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$ 和 $c_s = \\sqrt{\\mu/\\rho}$。\n- LK 边界模型施加了局部阻尼器牵引力，对于具有外向き单位法向量 $\\mathbf{n}$ 的边界，该牵引力与速度的法向和切向分量成正比：牵引力矢量由法向速度分量 $v_n = \\mathbf{v} \\cdot \\mathbf{n}$ 和切向速度 $\\mathbf{v}_t = \\mathbf{v} - v_n \\mathbf{n}$ 构建，其类阻抗系数由 $\\rho c_p$ 和 $\\rho c_s$ 导出。\n\n待在边界 $x = 0$ 处评估的基准场：\n- 对于 $1\\mathrm{D}$ 情况，使用驻波叠加\n$$\nu(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right],\n$$\n其中 $k = n \\pi / L$，$\\omega = c k$，振幅 $A > 0$，相位偏移 $\\delta \\in [0, \\pi)$，整数模态指数 $n \\ge 1$，且 $L > 0$。\n- 对于 $2\\mathrm{D}$ 平面应变，使用两个反向传播的平面波的驻波叠加，入射角为 $\\theta$（从 $x$ 轴测量），传播坐标为 $s = x \\cos\\theta + y \\sin\\theta$：\n    - 压缩（$P$-波）位移场\n    $$\n    \\mathbf{u}(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, \\mathbf{p},\n    $$\n    其中 $\\mathbf{p} = (\\cos\\theta, \\sin\\theta)$，$k = n \\pi / L$，$\\omega = c_p k$，振幅 $A > 0$，相位偏移 $\\delta$，入射角 $\\theta$。\n    - 剪切（$S$-波）位移场\n    $$\n    \\mathbf{u}(x,y,t) = A \\left[\\cos(\\omega t - k s) + \\cos(\\omega t + k s + \\delta)\\right] \\, \\mathbf{s},\n    $$\n    其中 $\\mathbf{s} = (-\\sin\\theta, \\cos\\theta)$，$k = n \\pi / L$，$\\omega = c_s k$，振幅 $A > 0$，相位偏移 $\\delta$，入射角 $\\theta$。\n\n牵引力与误差定义：\n- 在边界 $x=0$ 处的连续介质牵引力矢量为 $\\mathbf{t} = \\sigma \\mathbf{n}$，其中 $\\mathbf{n} = (1, 0)$ 是边界的外向き法向量。\n- 速度为 $\\mathbf{v} = \\mathbf{u}_t$。边界上的 LK 牵引力矢量构建如下\n$$\n\\mathbf{t}_{\\mathrm{LK}} = -\\rho c_p (\\mathbf{v} \\cdot \\mathbf{n}) \\mathbf{n} - \\rho c_s \\left(\\mathbf{v} - (\\mathbf{v} \\cdot \\mathbf{n}) \\mathbf{n} \\right).\n$$\n- 定义残差矢量为 $\\mathbf{r} = \\mathbf{t} - \\mathbf{t}_{\\mathrm{LK}}$。无量纲 LK 误差是残差的均方根 (RMS) 范数与参考 LK 牵引力的 RMS 范数在一个时间周期内（对于 $2\\mathrm{D}$ 情况，还在 $y$ 方向上的一个空间周期内）的比值：\n    - 对于 $1\\mathrm{D}$ 情况：\n    $$\n    \\varepsilon_{1\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\left|E u_x(0,t) + \\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\left|\\rho c u_t(0,t)\\right|^2 \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}.\n    $$\n    - 对于 $2\\mathrm{D}$ 情况：\n    $$\n    \\varepsilon_{2\\mathrm{D}} = \\frac{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| \\mathbf{r}(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}}{\\left(\\int_0^{T} \\int_0^{Y_{\\mathrm{per}}} \\| \\mathbf{t}_{\\mathrm{LK}}(0, y, t)\\|^2 \\, dy \\, dt \\right)^{1/2}},\n    \\quad T = \\frac{2\\pi}{\\omega}, \\quad Y_{\\mathrm{per}} = \\frac{2\\pi}{k \\sin\\theta},\n    $$\n    其中 $\\|\\cdot\\|$ 表示向量的欧几里得范数。在所有情况下，将误差报告为无量纲浮点数。\n\n角度规定和单位：\n- 角度 $\\theta$ 使用度 (degrees)。\n- 物理单位必须一致：$L$ 的单位是米，$\\rho$ 的单位是千克/立方米，$E$、$\\lambda$ 和 $\\mu$ 的单位是帕斯卡，$A$ 的单位是米，时间单位是秒。\n- 将所有最终答案表示为四舍五入到六位小数的无量纲浮点数。\n\n测试套件：\n为以下五个参数集计算 LK 误差。\n- 情况 $1$ ($1\\mathrm{D}$，理想路径)：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0$。\n- 情况 $2$ ($1\\mathrm{D}$，相移驻波)：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = \\pi/2$。\n- 情况 $3$ ($1\\mathrm{D}$，近节点失配)：$\\rho = 2000$, $E = 4\\times 10^9$, $L = 100$, $A = 0.01$, $n = 1$, $\\delta = 0.9\\pi$。\n- 情况 $4$ ($2\\mathrm{D}$，$P$-波斜入射)：$\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = \\pi/3$, $\\theta = 30$ 度。\n- 情况 $5$ ($2\\mathrm{D}$，$S$-波近掠射)：$\\rho = 2000$, $\\lambda = 2\\times 10^9$, $\\mu = 1\\times 10^9$, $L = 100$, $A = 0.001$, $n = 1$, $\\delta = 0.8\\pi$, $\\theta = 75$ 度。\n\n最终输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按照上述测试套件的顺序排列，每个值都四舍五入到六位小数（例如，$[0.123456,1.234567,2.345678,3.456789,4.567890]$）。不应打印任何附加文本。", "solution": "问题陈述已经过验证，并被认为是合理的。它以线性弹性动力学原理为科学基础，具有完整且一致的定义和参数集，是一个适定的问题，并且其表述是客观的。任务是为特定驻波条件下的 Lysmer-Kuhlemeyer (LK) 粘性边界推导一个已定义误差度量的解析表达式，然后针对给定的测试套件评估此误差。\n\n一般方法包括推导边界 $x=0$ 处的连续介质牵引力矢量 $\\mathbf{t}$ 和 LK 牵引力矢量 $\\mathbf{t}_{\\mathrm{LK}}$ 的表达式。在问题的上下文中，通过误差公式的规定，残差矢量被定义为 $\\mathbf{r} = \\mathbf{t} - \\mathbf{t}_{\\mathrm{LK}}$，其中 $1\\mathrm{D}$ 残差使用 $E u_x + \\rho c u_t$。对于位于 $x0$ 域上、在 $x=0$ 处且外向き法向量为 $\\mathbf{n}=(1,0)$ 的边界，连续介质牵引力为 $\\mathbf{t}=\\sigma \\mathbf{n}|_{x=0}$，LK 牵引力为 $\\mathbf{t}_{\\mathrm{LK}} = -\\rho c_p (\\mathbf{v} \\cdot \\mathbf{n}) \\mathbf{n} - \\rho c_s (\\mathbf{v} - (\\mathbf{v} \\cdot \\mathbf{n}) \\mathbf{n})|_{x=0}$。对于 $1\\mathrm{D}$ 杆，这简化为 $t=E u_x|_{x=0}$ 和 $t_{\\mathrm{LK}} = -\\rho c u_t|_{x=0}$。在 $1\\mathrm{D}$ 误差公式中指定的残差 $E u_x + \\rho c u_t$ 正好是 $t - t_{\\mathrm{LK}}$。无量纲误差 $\\varepsilon$ 是残差的均方根 (RMS) 范数与参考 LK 牵引力的 RMS 范数的比值。\n\n**1. $1\\mathrm{D}$ 情况的分析**\n\n位移场为 $u(x,t) = A \\left[\\cos(\\omega t - k x) + \\cos(\\omega t + k x + \\delta)\\right]$。我们在边界 $x=0$ 处计算所需项。\n速度为 $u_t(x,t) = -A\\omega\\left[\\sin(\\omega t - k x) + \\sin(\\omega t + k x + \\delta)\\right]$。\n在 $x=0$ 处，$u_t(0,t) = -A\\omega\\left[\\sin(\\omega t) + \\sin(\\omega t + \\delta)\\right]$。\n空间导数为 $u_x(x,t) = Ak\\left[\\sin(\\omega t - k x) - \\sin(\\omega t + k x + \\delta)\\right]$。\n在 $x=0$ 处，$u_x(0,t) = Ak\\left[\\sin(\\omega t) - \\sin(\\omega t + \\delta)\\right]$。\n\n误差表达式的分子包含项 $R_{1\\mathrm{D}}(t) = E u_x(0,t) + \\rho c u_t(0,t)$。\n使用 $E = \\rho c^2$ 和 $\\omega = ck$，我们发现 $E k = \\rho c \\omega$。\n$R_{1\\mathrm{D}}(t) = (EAk)[\\sin(\\omega t) - \\sin(\\omega t + \\delta)] - (\\rho c A \\omega)[\\sin(\\omega t) + \\sin(\\omega t + \\delta)]$\n$R_{1\\mathrm{D}}(t) = EAk \\left\\{ [\\sin(\\omega t) - \\sin(\\omega t+\\delta)] - [\\sin(\\omega t) + \\sin(\\omega t+\\delta)] \\right\\}$\n$R_{1\\mathrm{D}}(t) = EAk [-2\\sin(\\omega t+\\delta)] = -2EAk \\sin(\\omega t+\\delta)$。\n\n分母包含参考项 $T_{\\mathrm{ref}}(t) = \\rho c u_t(0,t) = -\\rho c A\\omega[\\sin(\\omega t) + \\sin(\\omega t+\\delta)]$。\n$T_{\\mathrm{ref}}(t) = -EAk[\\sin(\\omega t) + \\sin(\\omega t) \\cos\\delta + \\cos(\\omega t) \\sin\\delta]$\n$T_{\\mathrm{ref}}(t) = -EAk[(1+\\cos\\delta)\\sin(\\omega t) + \\sin\\delta \\cos(\\omega t)]$。\n\n误差为 $\\varepsilon_{1\\mathrm{D}} = \\left( \\int_0^T R_{1\\mathrm{D}}(t)^2 dt / \\int_0^T T_{\\mathrm{ref}}(t)^2 dt \\right)^{1/2}$，其中 $T=2\\pi/\\omega$。\n残差分子平方的积分为：\n$\\int_0^T R_{1\\mathrm{D}}(t)^2 dt = \\int_0^T (-2EAk)^2 \\sin^2(\\omega t+\\delta) dt = 4(EAk)^2 (T/2) = 2T(EAk)^2$。\n参考项平方的积分使用恒等式 $\\int_0^T (C\\cos\\omega t+S\\sin\\omega t)^2 dt = (C^2+S^2)T/2$ 求得：\n$\\int_0^T T_{\\mathrm{ref}}(t)^2 dt = (-EAk)^2 \\frac{T}{2} [(1+\\cos\\delta)^2 + (\\sin\\delta)^2] = (EAk)^2 \\frac{T}{2} [1+2\\cos\\delta+\\cos^2\\delta+\\sin^2\\delta]$\n$= (EAk)^2 \\frac{T}{2} [2+2\\cos\\delta] = T(EAk)^2(1+\\cos\\delta)$。\n\n误差的平方是这些积分量的比值：\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2T(EAk)^2}{T(EAk)^2(1+\\cos\\delta)} = \\frac{2}{1+\\cos\\delta}$。\n使用半角恒等式 $1+\\cos\\delta = 2\\cos^2(\\delta/2)$，我们得到：\n$\\varepsilon_{1\\mathrm{D}}^2 = \\frac{2}{2\\cos^2(\\delta/2)} = \\sec^2(\\delta/2)$。\n由于 $\\delta \\in [0, \\pi)$，$\\delta/2 \\in [0, \\pi/2)$，在此区间余弦为非负，所以误差为：\n$\\varepsilon_{1\\mathrm{D}} = \\frac{1}{\\cos(\\delta/2)}$。\n这个结果与所有物理参数 $A, \\rho, E, L, n$ 无关，仅取决于相位偏移 $\\delta$。\n\n**2. $2\\mathrm{D}$ 情况的分析**\n\n位移场是两个反向传播平面波的叠加，表示为 $\\mathbf{u}(x,y,t) = A \\left[ \\cos(\\Psi_{in}) + \\cos(\\Psi_{out}) \\right] \\mathbf{d}$，其中 $\\Psi_{in} = \\omega t - k s$，$\\Psi_{out} = \\omega t + k s + \\delta$，$s = x\\cos\\theta + y\\sin\\theta$，且 $\\mathbf{d}$ 是偏振矢量。在边界 $x=0$ 处，$s=y\\sin\\theta$。\n\n我们定义函数 $S(t,y) = \\sin(\\omega t - ky\\sin\\theta) + \\sin(\\omega t + ky\\sin\\theta + \\delta)$ 和 $D(t,y) = \\sin(\\omega t - ky\\sin\\theta) - \\sin(\\omega t + ky\\sin\\theta + \\delta)$。\n在 $x=0$ 处的速度和空间导数为：\n$\\mathbf{v}(0,y,t) = \\mathbf{u}_t = -A\\omega S(t,y) \\mathbf{d}$\n$\\frac{\\partial \\mathbf{u}}{\\partial x}(0,y,t) = Ak\\cos\\theta D(t,y) \\mathbf{d}$\n$\\frac{\\partial \\mathbf{u}}{\\partial y}(0,y,t) = Ak\\sin\\theta D(t,y) \\mathbf{d}$\n\n函数 $S$ 和 $D$ 在一个时间周期 $T=2\\pi/\\omega$ 和一个空间周期 $Y_{\\mathrm{per}}=2\\pi/(k\\sin\\theta)$ 上是正交的，即 $\\int_0^T \\int_0^{Y_{\\mathrm{per}}} S(t,y)D(t,y) dy dt = 0$。它们平方的积分是 $\\int\\int S^2 dy dt = \\int\\int D^2 dy dt = T Y_{\\mathrm{per}}$。由于这种正交性，形式为 $\\mathbf{r} = D(t,y) \\mathbf{V}_1 - S(t,y) \\mathbf{V}_2$ 的残差的积分范数简化为 $\\int\\int \\|\\mathbf{r}\\|^2 dy dt = (\\|\\mathbf{V}_1\\|^2 + \\|\\mathbf{V}_2\\|^2) T Y_{\\mathrm{per}}$。\n\n**2.1. 2D P-波分析**\n偏振 $\\mathbf{d}=\\mathbf{p}=(\\cos\\theta, \\sin\\theta)$。在 $x=0$ 处所需的应变分量：\n$\\varepsilon_{xx} = Ak D(t,y)\\cos^2\\theta$，$\\varepsilon_{yy} = Ak D(t,y)\\sin^2\\theta$，$\\varepsilon_{xy} = Ak D(t,y)\\sin\\theta\\cos\\theta$。\n连续介质牵引力 $\\mathbf{t} = (\\sigma_{xx}, \\sigma_{xy})$ 为：\n$\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx}+\\lambda\\varepsilon_{yy} = AkD(t,y)[(\\lambda+2\\mu)\\cos^2\\theta+\\lambda\\sin^2\\theta]$。\n$\\sigma_{xy} = 2\\mu\\varepsilon_{xy} = AkD(t,y)[2\\mu\\sin\\theta\\cos\\theta]$。\n使用 $\\lambda+2\\mu=\\rho c_p^2$ 和 $\\mu=\\rho c_s^2$，$\\mathbf{t}=AkD(t,y) \\mathbf{V}_t$ 其中 $\\mathbf{V}_t = \\rho \\begin{pmatrix} c_p^2\\cos^2\\theta + (c_p^2-2c_s^2)\\sin^2\\theta \\\\ c_s^2 \\sin(2\\theta) \\end{pmatrix}$。\n速度分量为 $v_x = -A\\omega S(t,y)\\cos\\theta$ 和 $v_y = -A\\omega S(t,y)\\sin\\theta$。当 $\\omega=c_p k$ 时，LK 牵引力 $\\mathbf{t}_{\\mathrm{LK}}=(-\\rho c_p v_x, -\\rho c_s v_y)$ 变为 $\\mathbf{t}_{\\mathrm{LK}} = AkS(t,y)\\mathbf{V}_{\\mathrm{LK}}$ 其中 $\\mathbf{V}_{\\mathrm{LK}} = \\rho\\begin{pmatrix} c_p^2\\cos\\theta \\\\ c_p c_s \\sin\\theta \\end{pmatrix}$。\n残差为 $\\mathbf{r}=\\mathbf{t}-\\mathbf{t}_{\\mathrm{LK}} = Ak[D(t,y)\\mathbf{V}_t - S(t,y)\\mathbf{V}_{\\mathrm{LK}}]$。\n误差的平方变为：\n$\\varepsilon_{2\\mathrm{D},P}^2 = \\frac{\\int\\int \\|\\mathbf{r}\\|^2 dy dt}{\\int\\int \\|\\mathbf{t}_{\\mathrm{LK}}\\|^2 dy dt} = \\frac{(Ak)^2 T Y_{\\mathrm{per}}(\\|\\mathbf{V}_t\\|^2+\\|\\mathbf{V}_{\\mathrm{LK}}\\|^2)}{(Ak)^2 T Y_{\\mathrm{per}} \\|\\mathbf{V}_{\\mathrm{LK}}\\|^2} = 1 + \\frac{\\|\\mathbf{V}_t\\|^2}{\\|\\mathbf{V}_{\\mathrm{LK}}\\|^2}$。\n\n**2.2. 2D S-波分析**\n偏振 $\\mathbf{d}=\\mathbf{s}=(-\\sin\\theta, \\cos\\theta)$。在 $x=0$ 处所需的应变分量：\n$\\varepsilon_{xx} = -Ak D(t,y)\\sin\\theta\\cos\\theta$，$\\varepsilon_{yy} = Ak D(t,y)\\sin\\theta\\cos\\theta$，所以 $\\mathrm{tr}(\\varepsilon)=0$。\n$\\varepsilon_{xy} = \\frac{1}{2}Ak D(t,y) (\\cos^2\\theta-\\sin^2\\theta) = \\frac{1}{2}AkD(t,y)\\cos(2\\theta)$。\n连续介质牵引力 $\\mathbf{t}=(\\sigma_{xx}, \\sigma_{xy})$ 变为 $\\mathbf{t} = AkD(t,y) \\mathbf{W}_t$ 其中 $\\mathbf{W}_t = \\rho c_s^2 \\begin{pmatrix} -\\sin(2\\theta) \\\\ \\cos(2\\theta) \\end{pmatrix}$。\n速度分量为 $v_x = A\\omega S(t,y)\\sin\\theta$ 和 $v_y = -A\\omega S(t,y)\\cos\\theta$。当 $\\omega=c_s k$ 时，LK 牵引力 $\\mathbf{t}_{\\mathrm{LK}}$ 变为 $\\mathbf{t}_{\\mathrm{LK}} = AkS(t,y) \\mathbf{W}_{\\mathrm{LK}}$ 其中 $\\mathbf{W}_{\\mathrm{LK}} = \\rho\\begin{pmatrix} -c_p c_s \\sin\\theta \\\\ c_s^2 \\cos\\theta \\end{pmatrix}$。\n误差表达式具有相同的形式：$\\varepsilon_{2\\mathrm{D},S}^2 = 1+\\frac{\\|\\mathbf{W}_t\\|^2}{\\|\\mathbf{W}_{\\mathrm{LK}}\\|^2}$。\n范数 $\\|\\mathbf{W}_t\\|^2 = (\\rho c_s^2)^2$。误差平方的最终表达式为：\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{(\\rho c_s^2)^2}{\\rho^2(c_p^2 c_s^2 \\sin^2\\theta + c_s^4 \\cos^2\\theta)} = 1 + \\frac{c_s^2}{c_p^2\\sin^2\\theta + c_s^2\\cos^2\\theta}$。\n\n**数值评估**\n- 情况 1：$1\\mathrm{D}$，$\\delta=0$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0) = 1$。\n- 情况 2：$1\\mathrm{D}$，$\\delta=\\pi/2$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(\\pi/4) = \\sqrt{2} \\approx 1.414214$。\n- 情况 3：$1\\mathrm{D}$，$\\delta=0.9\\pi$。$\\varepsilon_{1\\mathrm{D}} = 1/\\cos(0.45\\pi) \\approx 6.392453$。\n- 情况 4：$2\\mathrm{D}$ P-波。$\\rho=2000$, $\\lambda=2\\cdot 10^9$, $\\mu=1\\cdot 10^9$, $\\theta=30^\\circ$。这得到 $c_p^2 = 2\\cdot 10^6$ 和 $c_s^2 = 0.5\\cdot 10^6$，所以 $c_p^2=4c_s^2$。对于该材料属性，可以证明对所有入射角 $\\theta$ 都有 $\\|\\mathbf{V}_t\\|^2 = \\|\\mathbf{V}_{\\mathrm{LK}}\\|^2$。因此 $\\varepsilon_{2\\mathrm{D},P}^2 = 1+1=2$，得到 $\\varepsilon_{2\\mathrm{D},P}=\\sqrt{2} \\approx 1.414214$。\n- 情况 5：$2\\mathrm{D}$ S-波。相同的材料属性，$\\theta=75^\\circ$。\n$\\varepsilon_{2\\mathrm{D},S}^2 = 1 + \\frac{1}{(c_p^2/c_s^2)\\sin^2\\theta+\\cos^2\\theta} = 1 + \\frac{1}{4\\sin^2(75^\\circ)+\\cos^2(75^\\circ)} = 1+\\frac{1}{1+3\\sin^2(75^\\circ)}$。\n这计算得出 $\\varepsilon_{2\\mathrm{D},S} \\approx 1.123932$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_1d_error(delta):\n    \"\"\"\n    Computes the dimensionless LK error for the 1D case.\n    The error is analytically found to be 1 / cos(delta/2).\n    \"\"\"\n    if np.cos(delta / 2.0) == 0:\n        return np.inf\n    return 1.0 / np.cos(delta / 2.0)\n\ndef calculate_2d_p_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D P-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    cp = np.sqrt(cp2)\n    cs = np.sqrt(cs2)\n    \n    theta_rad = np.radians(theta_deg)\n    s = np.sin(theta_rad)\n    c = np.cos(theta_rad)\n    s2 = s**2\n    c2 = c**2\n\n    # Vector V_t components (proportional to continuum traction)\n    vt_x = cp2 * c2 + (cp2 - 2.0 * cs2) * s2\n    vt_y = cs2 * 2.0 * s * c\n    norm_vt_sq = vt_x**2 + vt_y**2\n\n    # Vector V_LK components (proportional to LK traction)\n    vlk_x = cp2 * c\n    vlk_y = cp * cs * s\n    norm_vlk_sq = vlk_x**2 + vlk_y**2\n\n    if norm_vlk_sq == 0:\n        return np.inf\n\n    err_sq = 1.0 + norm_vt_sq / norm_vlk_sq\n    return np.sqrt(err_sq)\n\ndef calculate_2d_s_wave_error(rho, lam, mu, theta_deg):\n    \"\"\"\n    Computes the dimensionless LK error for the 2D S-wave case.\n    \"\"\"\n    cp2 = (lam + 2.0 * mu) / rho\n    cs2 = mu / rho\n    \n    theta_rad = np.radians(theta_deg)\n    s_sq = np.sin(theta_rad)**2\n    c_sq = np.cos(theta_rad)**2\n    \n    denominator = (cp2/cs2) * s_sq + c_sq\n    if denominator == 0:\n        return np.inf\n\n    err_sq = 1.0 + 1.0 / denominator\n    return np.sqrt(err_sq)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': np.pi/2}},\n        {'type': '1D', 'params': {'rho': 2000, 'E': 4e9, 'L': 100, 'A': 0.01, 'n': 1, 'delta': 0.9*np.pi}},\n        {'type': '2D_P', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': np.pi/3, 'theta': 30}},\n        {'type': '2D_S', 'params': {'rho': 2000, 'lambda': 2e9, 'mu': 1e9, 'L': 100, 'A': 0.001, 'n': 1, 'delta': 0.8*np.pi, 'theta': 75}},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == '1D':\n            result = calculate_1d_error(case['params']['delta'])\n        elif case['type'] == '2D_P':\n            p = case['params']\n            result = calculate_2d_p_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        elif case['type'] == '2D_S':\n            p = case['params']\n            result = calculate_2d_s_wave_error(p['rho'], p['lambda'], p['mu'], p['theta'])\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n        \n        results.append(result)\n\n    # Format results to six decimal places for the final output.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3569961"}]}