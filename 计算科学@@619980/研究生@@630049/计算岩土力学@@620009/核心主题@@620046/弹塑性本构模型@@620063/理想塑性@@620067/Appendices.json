{"hands_on_practices": [{"introduction": "在岩土力学中，选择合适的屈服准则是进行塑性分析的第一步。Mohr-Coulomb准则因其能准确描述土和岩石的剪切破坏行为而被广泛使用，但其在主应力空间中的六角锥面形状给数值计算带来了复杂性。因此，在许多应用中，我们使用形式更简单的Drucker-Prager圆锥面来近似它。本练习将引导你通过解析推导，确定一个内切于Mohr-Coulomb六边形的Drucker-Prager准则的材料参数，这一过程对于理解不同模型间的内在联系和简化复杂本构关系至关重要。[@problem_id:3549352]", "problem": "考虑一个均匀、各向同性的理想塑性岩土材料，其模型采用莫尔-库仑（MC）屈服准则，摩擦角为 $\\phi$，粘聚力为 $c$。设平均（静水）应力定义为 $p=\\frac{1}{3}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})$（拉为正），等效偏应力为 $q=\\sqrt{3\\,J_{2}}$，其中 $J_{2}$ 是偏应力张量的第二不变量。在 Haigh-Westergaard 应力空间中，MC 屈服面在偏平面（π平面）上具有六边形截面，而 Drucker-Prager（DP）屈服面是一个圆锥面。将 DP 屈服函数表示为\n$$\nf(p,q)=\\alpha\\,p+q-k\\le 0,\n$$\n其中待定常数 $\\alpha$ 和 $k$ 需要确定，使得 DP 圆锥内接于 MC 六边形。\n\n从平面上的 MC 破坏定律（即关联剪应力和正应力的库仑定律）以及轴对称三轴压缩（$\\sigma_{1}\\ge \\sigma_{2}=\\sigma_{3}$）和拉伸（$\\sigma_{3}\\le \\sigma_{2}=\\sigma_{1}$）的定义出发，推导 MC 曲面在三轴压缩和三轴拉伸条件下的线性 $p$–$q$ 子午线。利用这些子午线确定 $\\alpha$ 和 $k$，使得 DP 圆锥完全位于 MC 六边形内部并与其相切。请用 $\\phi$ 和 $c$ 的闭式解析表达式表示你的最终答案。无需进行数值计算。将你求得的 $(\\alpha,k)$ 结果表示为单行矩阵。", "solution": "本问题要求确定 Drucker-Prager（DP）屈服准则的参数 $\\alpha$ 和 $k$，使得该准则内接于 Mohr-Coulomb（MC）屈服面。求解过程将首先以主应力形式建立 MC 准则，然后推导该准则在 Haigh-Westergaard 应力空间（$p, q$）中三轴压缩和拉伸下的具体形式，最后将 DP 圆锥与相应的 MC 子午线进行匹配。\n\n问题规定拉应力为正。莫尔-库仑破坏准则代表最大莫尔圆与库仑破坏包络线 $\\tau = c - \\sigma_n \\tan\\phi$ 相切，用最大主应力（$\\sigma_1$）和最小主应力（$\\sigma_3$）表示为：\n$$\n\\frac{\\sigma_1 - \\sigma_3}{2} = c \\cos\\phi - \\frac{\\sigma_1 + \\sigma_3}{2} \\sin\\phi\n$$\n整理此方程可得 MC 屈服准则的更便捷形式：\n$$\n\\sigma_1(1+\\sin\\phi) - \\sigma_3(1-\\sin\\phi) = 2c \\cos\\phi\n$$\n其中 $\\phi$ 是摩擦角，$c$ 是粘聚力。\n\n问题定义的平均应力 $p$ 和等效偏应力 $q$ 为：\n$$\np = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3}(\\sigma_1 + \\sigma_2 + \\sigma_3)\n$$\n$$\nq = \\sqrt{3J_2} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_1-\\sigma_2)^2 + (\\sigma_2-\\sigma_3)^2 + (\\sigma_3-\\sigma_1)^2\\right]}\n$$\n我们现在必须推导两种特定轴对称应力状态下的 MC 子午线。\n\n**1. 三轴压缩（TXC）子午线**\n\n在轴对称三轴压缩中，应力状态为 $\\sigma_1 \\ge \\sigma_2 = \\sigma_3$。\n平均应力 $p$ 为：\n$$\np = \\frac{1}{3}(\\sigma_1 + 2\\sigma_3)\n$$\n等效偏应力 $q$ 为：\n$$\nq = \\sqrt{\\frac{1}{2}\\left[(\\sigma_1-\\sigma_3)^2 + 0^2 + (\\sigma_3-\\sigma_1)^2\\right]} = \\sqrt{(\\sigma_1-\\sigma_3)^2} = \\sigma_1 - \\sigma_3\n$$\n我们将 $\\sigma_1$ 和 $\\sigma_3$ 用 $p$ 和 $q$ 表示：\n由 $q = \\sigma_1 - \\sigma_3$ 可得 $\\sigma_1 = \\sigma_3 + q$。\n将其代入 $p$ 的表达式中：\n$$\n3p = (\\sigma_3+q) + 2\\sigma_3 = 3\\sigma_3 + q \\implies \\sigma_3 = p - \\frac{q}{3}\n$$\n对于 $\\sigma_1$：\n$$\n\\sigma_1 = \\left(p - \\frac{q}{3}\\right) + q = p + \\frac{2q}{3}\n$$\n现在，将 $\\sigma_1$ 和 $\\sigma_3$ 的这些表达式代入 MC 屈服准则：\n$$\n\\left(p + \\frac{2q}{3}\\right)(1+\\sin\\phi) - \\left(p - \\frac{q}{3}\\right)(1-\\sin\\phi) = 2c \\cos\\phi\n$$\n按 $p$ 和 $q$ 合并同类项：\n$$\np[(1+\\sin\\phi) - (1-\\sin\\phi)] + q\\left[\\frac{2}{3}(1+\\sin\\phi) + \\frac{1}{3}(1-\\sin\\phi)\\right] = 2c \\cos\\phi\n$$\n$$\np(2\\sin\\phi) + q\\left(\\frac{2}{3} + \\frac{2}{3}\\sin\\phi + \\frac{1}{3} - \\frac{1}{3}\\sin\\phi\\right) = 2c \\cos\\phi\n$$\n$$\n2p\\sin\\phi + q\\left(1 + \\frac{1}{3}\\sin\\phi\\right) = 2c \\cos\\phi\n$$\n这就是三轴压缩子午线 $q_{TXC}(p)$ 的方程。\n\n**2. 三轴拉伸（TXE）子午线**\n\n在轴对称三轴拉伸中，应力状态为 $\\sigma_3 \\le \\sigma_2 = \\sigma_1$。\n平均应力 $p$ 为：\n$$\np = \\frac{1}{3}(2\\sigma_1 + \\sigma_3)\n$$\n等效偏应力 $q$ 为：\n$$\nq = \\sqrt{\\frac{1}{2}\\left[0^2 + (\\sigma_1-\\sigma_3)^2 + (\\sigma_3-\\sigma_1)^2\\right]} = \\sqrt{(\\sigma_1-\\sigma_3)^2} = \\sigma_1 - \\sigma_3\n$$\n我们将 $\\sigma_1$ 和 $\\sigma_3$ 用 $p$ 和 $q$ 表示：\n由 $q = \\sigma_1 - \\sigma_3$ 可得 $\\sigma_1 = \\sigma_3 + q$。\n$$\n3p = 2(\\sigma_3+q) + \\sigma_3 = 3\\sigma_3 + 2q \\implies \\sigma_3 = p - \\frac{2q}{3}\n$$\n对于 $\\sigma_1$：\n$$\n\\sigma_1 = \\left(p - \\frac{2q}{3}\\right) + q = p + \\frac{q}{3}\n$$\n将这些表达式代入 MC 屈服准则：\n$$\n\\left(p + \\frac{q}{3}\\right)(1+\\sin\\phi) - \\left(p - \\frac{2q}{3}\\right)(1-\\sin\\phi) = 2c \\cos\\phi\n$$\n按 $p$ 和 $q$ 合并同类项：\n$$\np[(1+\\sin\\phi) - (1-\\sin\\phi)] + q\\left[\\frac{1}{3}(1+\\sin\\phi) + \\frac{2}{3}(1-\\sin\\phi)\\right] = 2c \\cos\\phi\n$$\n$$\np(2\\sin\\phi) + q\\left(\\frac{1}{3} + \\frac{1}{3}\\sin\\phi + \\frac{2}{3} - \\frac{2}{3}\\sin\\phi\\right) = 2c \\cos\\phi\n$$\n$$\n2p\\sin\\phi + q\\left(1 - \\frac{1}{3}\\sin\\phi\\right) = 2c \\cos\\phi\n$$\n这就是三轴拉伸子午线 $q_{TXE}(p)$ 的方程。\n\n**3. 匹配 Drucker-Prager 圆锥**\n\nDrucker-Prager 屈服函数为 $f(p,q)=\\alpha\\,p+q-k \\le 0$，在屈服面上，它变为 $p$-$q$ 平面中的直线 $q = k - \\alpha p$。问题要求 DP 圆锥“内接于 MC 六边形”并“完全位于其内部”。这意味着对于任意给定的平均应力 $p$，DP 曲面的 $q$ 值必须小于或等于任何洛德角下 MC 曲面的 $q$ 值。为保证此条件，最保守的选择是将 DP 圆锥与最接近静水压力轴的 MC 子午线（即对于给定的 $p$ 具有最小 $q$ 值）相匹配。\n\n我们从两个子午线方程中求解 $q$：\n对于 TXC：$q_{TXC}(p) = \\frac{2c\\cos\\phi - 2p\\sin\\phi}{1 + \\frac{1}{3}\\sin\\phi} = \\frac{6(c\\cos\\phi - p\\sin\\phi)}{3+\\sin\\phi}$\n对于 TXE：$q_{TXE}(p) = \\frac{2c\\cos\\phi - 2p\\sin\\phi}{1 - \\frac{1}{3}\\sin\\phi} = \\frac{6(c\\cos\\phi - p\\sin\\phi)}{3-\\sin\\phi}$\n\n由于 $\\phi \\in (0, \\pi/2)$，我们有 $\\sin\\phi > 0$。因此，$3+\\sin\\phi > 3-\\sin\\phi$。在材料能承受剪切应力的典型条件下（$c\\cos\\phi - p\\sin\\phi > 0$），这意味着 $q_{TXC}(p) < q_{TXE}(p)$。\n此结果表明，在规定的拉为正的符号约定下，三轴压缩子午线比三轴拉伸子午线更靠近静水压力轴。对应于 TXC 的顶点是 $\\pi$ 平面中 MC 六边形的内顶点。\n\n为确保 DP 圆锥是内接的，我们必须使其与这个内边界相匹配。术语“相切”在拟合这些模型的标准语境中被解释为 DP 圆錐穿过 MC 六边形的内顶点，这些顶点对应于 TXC 子午线。\n因此，我们令 $q_{DP}(p) = q_{TXC}(p)$：\n$$\nk - \\alpha p = \\frac{6c\\cos\\phi}{3+\\sin\\phi} - p \\frac{6\\sin\\phi}{3+\\sin\\phi}\n$$\n通过比较方程两边的常数项和 $p$ 的系数，我们确定参数 $\\alpha$ 和 $k$：\n$p$ 的系数给出 $\\alpha$：\n$$\n-\\alpha = -\\frac{6\\sin\\phi}{3+\\sin\\phi} \\implies \\alpha = \\frac{6\\sin\\phi}{3+\\sin\\phi}\n$$\n常数项给出 $k$：\n$$\nk = \\frac{6c\\cos\\phi}{3+\\sin\\phi}\n$$\n这些关于 $\\alpha$ 和 $k$ 的表达式定义了所要求的内接 Drucker-Prager 圆锥。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{6\\sin\\phi}{3+\\sin\\phi} & \\frac{6c\\cos\\phi}{3+\\sin\\phi}\n\\end{pmatrix}\n}\n$$", "id": "3549352"}, {"introduction": "任何涉及塑性的计算力学程序，其核心都是应力更新算法。该算法采用“弹性预测-塑性修正”的框架，以确定在给定应变增量下材料的最终应力状态。本练习将带你一步步完成一个符合Mohr-Coulomb理想塑性模型的应力更新计算，这不仅能加深你对返回映射算法基本流程的理解，还能让你亲手处理非关联流动法则在计算中的具体应用。[@problem_id:3549281]", "problem": "将对一个服从 Mohr–Coulomb 理想塑性及非关联流动的岩土材料进行小应变、平面应变应力更新。应力和应变均采用压为正的符号约定。该材料为各向同性弹-理想塑性材料，其杨氏模量 $E = 120 \\,\\mathrm{MPa}$，泊松比 $\\nu = 0.25$。Mohr–Coulomb 强度参数为黏聚力 $c = 0.05 \\,\\mathrm{MPa}$ 和摩擦角 $\\phi = 30^\\circ$。塑性势为非关联的，通过将 $\\phi$ 替换为剪胀角 $\\psi$ 在相同光滑三轴压缩分支上定义；取 $\\sin \\psi = 0.25$。材料无硬化或软化（理想塑性），也无盖端或拉伸截断。\n\n在增量步开始时，应力和塑性应变为零。在该增量步中，在笛卡尔基 $\\{x,y,z\\}$ 下施加的平面应变小应变张量为\n$$\n\\Delta \\boldsymbol{\\varepsilon} \\;=\\; \n\\begin{pmatrix}\n\\Delta \\varepsilon_{xx} & \\tfrac{1}{2}\\Delta \\gamma_{xy} & 0 \\\\\n\\tfrac{1}{2}\\Delta \\gamma_{xy} & \\Delta \\varepsilon_{yy} & 0 \\\\\n0 & 0 & \\Delta \\varepsilon_{zz}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.004 & 0 & 0 \\\\\n0 & -0.001 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix},\n$$\n满足平面应变约束 $\\Delta \\varepsilon_{zz} = 0$ 且无面内剪切增量 $\\Delta \\gamma_{xy}=0$。\n\n假设更新后的应力状态位于 Mohr–Coulomb 面的光滑三轴压缩面上，且主轴与 $\\{x,y,z\\}$ 基保持一致（无旋转）。使用小应变各向同性弹性的拉梅形式以及用主应力 $\\sigma_1$ 和 $\\sigma_3$ 表示的精确 Mohr–Coulomb 光滑三轴压缩屈服函数：\n$$\nf(\\boldsymbol{\\sigma}) \\;=\\; \\sigma_1 \\left(1 - \\sin \\phi \\right) \\;-\\; \\sigma_3 \\left(1 + \\sin \\phi \\right) \\;-\\; 2 c \\cos \\phi,\n$$\n以及非关联塑性势：\n$$\ng(\\boldsymbol{\\sigma}) \\;=\\; \\sigma_1 \\left(1 - \\sin \\psi \\right) \\;-\\; \\sigma_3 \\left(1 + \\sin \\psi \\right).\n$$\n\n在所述假设下，对该单增量步执行一次完整的最近点应力更新，并报告更新后的面内柯西应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$、$\\sigma_{xy}$ 以及面内塑性应变增量 $\\Delta \\varepsilon^{p}_{xx}$、$\\Delta \\varepsilon^{p}_{yy}$、$\\Delta \\gamma^{p}_{xy}$。将报告的每个分量四舍五入至四位有效数字。应力以 $\\mathrm{MPa}$ 为单位，应变为无量纲量。最终答案必须以单行矩阵的形式按顺序 $\\left[\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}, \\Delta \\varepsilon^{p}_{xx}, \\Delta \\varepsilon^{p}_{yy}, \\Delta \\gamma^{p}_{xy}\\right]$ 提供。", "solution": "此问题要求对一个遵循Mohr-Coulomb理想塑性模型的材料，在给定应变增量下，执行一个完整的应力更新计算。该过程采用标准的“弹性预测-塑性修正”算法。\n\n**1. 计算材料参数**\n\n首先，根据给定的杨氏模量 $E=120 \\,\\mathrm{MPa}$ 和泊松比 $\\nu=0.25$，计算拉梅参数 $\\lambda$ 和剪切模量 $\\mu$（或 $G$）：\n$$ \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\frac{120 \\times 0.25}{(1.25)(0.5)} = 48 \\,\\mathrm{MPa} $$\n$$ \\mu = G = \\frac{E}{2(1+\\nu)} = \\frac{120}{2(1.25)} = 48 \\,\\mathrm{MPa} $$\n平面应变弹性刚度矩阵 $\\mathbf{D}$ 的非零分量为 $\\lambda+2\\mu = 144 \\,\\mathrm{MPa}$ 和 $\\lambda = 48 \\,\\mathrm{MPa}$。\n强度和流动参数为：$\\sin\\phi = \\sin(30^\\circ) = 0.5$, $\\cos\\phi = \\cos(30^\\circ) \\approx 0.866$, $\\sin\\psi = 0.25$。\n\n**2. 弹性预测**\n\n假设整个应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 都是弹性的。从初始零应力状态计算试探应力 $\\boldsymbol{\\sigma}^{\\text{trial}}$。由于是平面应变（$\\Delta\\varepsilon_{zz}=0$），我们有：\n$$ \\sigma_{xx}^{\\text{trial}} = (\\lambda+2\\mu)\\Delta\\varepsilon_{xx} + \\lambda\\Delta\\varepsilon_{yy} = 144(0.004) + 48(-0.001) = 0.576 - 0.048 = 0.528 \\,\\mathrm{MPa} $$\n$$ \\sigma_{yy}^{\\text{trial}} = \\lambda\\Delta\\varepsilon_{xx} + (\\lambda+2\\mu)\\Delta\\varepsilon_{yy} = 48(0.004) + 144(-0.001) = 0.192 - 0.144 = 0.048 \\,\\mathrm{MPa} $$\n$$ \\sigma_{xy}^{\\text{trial}} = 2\\mu \\Delta\\varepsilon_{xy} = 0 $$\n$$ \\sigma_{zz}^{\\text{trial}} = \\lambda(\\Delta\\varepsilon_{xx} + \\Delta\\varepsilon_{yy}) = 48(0.004 - 0.001) = 0.144 \\,\\mathrm{MPa} $$\n由于剪应力为零，坐标轴即为主轴。根据压为正的约定，我们将主应力排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$：\n$$ \\sigma_1^{\\text{trial}} = \\sigma_{xx}^{\\text{trial}} = 0.528 \\,\\mathrm{MPa} $$\n$$ \\sigma_2^{\\text{trial}} = \\sigma_{zz}^{\\text{trial}} = 0.144 \\,\\mathrm{MPa} $$\n$$ \\sigma_3^{\\text{trial}} = \\sigma_{yy}^{\\text{trial}} = 0.048 \\,\\mathrm{MPa} $$\n\n**3. 屈服检查**\n\n将试探主应力代入屈服函数 $f(\\boldsymbol{\\sigma}) = \\sigma_1 (1 - \\sin \\phi) - \\sigma_3 (1 + \\sin \\phi) - 2 c \\cos \\phi$：\n$$ f(\\boldsymbol{\\sigma}^{\\text{trial}}) = 0.528(1-0.5) - 0.048(1+0.5) - 2(0.05)\\cos(30^\\circ) $$\n$$ f = 0.528(0.5) - 0.048(1.5) - 0.1 \\times 0.866025 = 0.264 - 0.072 - 0.0866025 = 0.1053975 \\,\\mathrm{MPa} $$\n由于 $f(\\boldsymbol{\\sigma}^{\\text{trial}}) > 0$，材料发生屈服，试探应力位于屈服面之外，需要进行塑性修正。\n\n**4. 塑性修正 (返回映射)**\n\n最终应力 $\\boldsymbol{\\sigma}^{\\text{final}} = \\boldsymbol{\\sigma}^{\\text{trial}} - \\mathbf{D} : \\Delta\\boldsymbol{\\varepsilon}^p$。塑性应变增量由流动法则 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 给出，其中 $\\Delta\\lambda$ 是塑性乘子。\n屈服面法向向量 $\\mathbf{a} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 和塑性流动方向向量 $\\mathbf{r} = \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 在主应力空间中为：\n$$ \\mathbf{a} = \\begin{pmatrix} 1-\\sin\\phi \\\\ 0 \\\\ -(1+\\sin\\phi) \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 0 \\\\ -1.5 \\end{pmatrix}, \\quad \\mathbf{r} = \\begin{pmatrix} 1-\\sin\\psi \\\\ 0 \\\\ -(1+\\sin\\psi) \\end{pmatrix} = \\begin{pmatrix} 0.75 \\\\ 0 \\\\ -1.25 \\end{pmatrix} $$\n塑性乘子由一致性条件 $f(\\boldsymbol{\\sigma}^{\\text{final}})=0$ 确定，对于线性屈服函数，可精确求解：\n$$ \\Delta\\lambda = \\frac{f(\\boldsymbol{\\sigma}^{\\text{trial}})}{\\mathbf{a}^T \\mathbf{D} \\mathbf{r}} $$\n分母 $H = \\mathbf{a}^T \\mathbf{D} \\mathbf{r}$ 在平面应变条件下展开为：\n$$ H = (1-\\sin\\phi)[(\\lambda+2\\mu)(1-\\sin\\psi) - \\lambda(1+\\sin\\psi)] - (1+\\sin\\phi)[\\lambda(1-\\sin\\psi) - (\\lambda+2\\mu)(1+\\sin\\psi)] $$\n代入数值：\n$$ H = 0.5[144(0.75) - 48(1.25)] - 1.5[48(0.75) - 144(1.25)] $$\n$$ H = 0.5[108 - 60] - 1.5[36 - 180] = 0.5(48) - 1.5(-144) = 24 + 216 = 240 \\,\\mathrm{MPa} $$\n因此，塑性乘子为：\n$$ \\Delta\\lambda = \\frac{0.1053975}{240} \\approx 0.000439156 $$\n现在计算塑性应变增量分量。由于主轴与坐标轴一致，$\\Delta\\varepsilon_{xx}^p = \\Delta\\lambda r_1$ and $\\Delta\\varepsilon_{yy}^p = \\Delta\\lambda r_3$：\n$$ \\Delta\\varepsilon_{xx}^p = 0.000439156 \\times 0.75 \\approx 0.000329367 $$\n$$ \\Delta\\varepsilon_{yy}^p = 0.000439156 \\times (-1.25) \\approx -0.000548945 $$\n$$ \\Delta\\gamma_{xy}^p = 0 \\text{, 因为 } \\partial g / \\partial\\sigma_{xy} = 0$$\n最后，计算更新后的应力分量：\n$$ \\sigma_{xx}^{\\text{final}} = \\sigma_{xx}^{\\text{trial}} - [(\\lambda+2\\mu)\\Delta\\varepsilon_{xx}^p + \\lambda\\Delta\\varepsilon_{yy}^p] = 0.528 - [144(0.000329367) + 48(-0.000548945)] $$\n$$ \\sigma_{xx}^{\\text{final}} = 0.528 - [0.0474288 - 0.0263494] = 0.528 - 0.0210794 \\approx 0.506921 \\,\\mathrm{MPa} $$\n$$ \\sigma_{yy}^{\\text{final}} = \\sigma_{yy}^{\\text{trial}} - [\\lambda\\Delta\\varepsilon_{xx}^p + (\\lambda+2\\mu)\\Delta\\varepsilon_{yy}^p] = 0.048 - [48(0.000329367) + 144(-0.000548945)] $$\n$$ \\sigma_{yy}^{\\text{final}} = 0.048 - [0.0158096 - 0.0790481] = 0.048 - (-0.0632385) \\approx 0.111238 \\,\\mathrm{MPa} $$\n$$ \\sigma_{xy}^{\\text{final}} = 0 \\,\\mathrm{MPa} $$\n\n**5. 最终结果**\n\n将计算结果四舍五入至四位有效数字：\n- $\\sigma_{xx} = 0.5069 \\,\\mathrm{MPa}$\n- $\\sigma_{yy} = 0.1112 \\,\\mathrm{MPa}$\n- $\\sigma_{xy} = 0.0000 \\,\\mathrm{MPa}$\n- $\\Delta\\varepsilon_{xx}^p = 0.0003294$\n- $\\Delta\\varepsilon_{yy}^p = -0.0005489$\n- $\\Delta\\gamma_{xy}^p = 0.0000$\n\n将这些值按要求的顺序排列在矩阵中。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.5069 & 0.1112 & 0.0000 & 0.0003294 & -0.0005489 & 0.0000 \\end{pmatrix} } $$", "id": "3549281"}, {"introduction": "当屈服面是具有尖点和棱线的复杂多面体时（如Mohr-Coulomb模型），塑性修正步骤就演变成一个复杂的几何投影问题，即“最近点投影”。这个算法必须能够稳健地处理试探应力点返回到屈服面的不同位置（面、棱或顶点）的逻辑。本练习要求你设计并实现一个完整的Mohr-Coulomb返回映射算法，通过处理这种几何复杂性，你将掌握在有限元程序中实现高级塑性模型的关键技术。[@problem_id:3549310]", "problem": "在主应力空间中，针对遵循压为正符号约定的理想塑性莫尔-库仑材料，实现一个最近点投影算法。该投影定义为将一个试验主应力向量在欧几里得空间中投影到以主应力空间表示的凸莫尔-库仑屈服面上。目标是从第一性原理出发，推导莫尔-库仑六角锥体在主应力空间中的面和边法线，构建一个决策逻辑以确定最近点位于一个面、一条边还是顶点上，并实现一个鲁棒的算法来计算投影后的主应力。\n\n从以下基本基础开始：\n- 莫尔-库仑的屈服条件由库仑摩擦定律决定，以平面上的剪应力和法向应力表示，即 $\\tau = c + \\sigma_n \\tan \\varphi$，其中 $c$ 是内聚力，$\\varphi$ 是摩擦角。\n- 在主应力空间中，设主应力为 $\\boldsymbol{\\sigma} = [\\sigma_1, \\sigma_2, \\sigma_3]^T$，并取压缩为正。\n- 在主应力空间中，莫尔-库仑屈服面是一个凸的分段线性（多面体）表面，可以表示为多个半空间的交集，每个半空间对应于与一对有序主应力相关的潜在破坏面。\n- 点 $\\boldsymbol{t}$ 到凸集 $\\mathcal{C}$ 的欧几里得最近点投影是 $\\min_{\\boldsymbol{\\sigma} \\in \\mathcal{C}} \\lVert \\boldsymbol{\\sigma} - \\boldsymbol{t} \\rVert_2^2$ 的唯一最小化子。\n\n任务：\n1. 从库仑摩擦定律推导出主应力空间中的平面屈服不等式。证明莫尔-库仑表面可以写成六个形如 $\\boldsymbol{a}_{ij}^T \\boldsymbol{\\sigma} - b \\le 0$ 的半空间的交集，适用于有序对 $(i,j)$ 且 $i \\ne j$，其中 $\\boldsymbol{a}_{ij}$ 和 $b$ 仅依赖于摩擦角 $\\varphi$ 和内聚力 $c$。\n2. 根据上述结果，推导出各个面的外向き单位法向量以及由两个面相交得到的边的方向向量的显式表达式。同时，推导顶点（所有主应力相等的三个面交点）的坐标。\n3. 构建一个有原则的决策逻辑（决策树），以确定给定试验应力的最近点位于：\n   - 单个面上（一个线性约束激活），\n   - 一条边上（两个激活约束的交集），\n   - 顶点上（三个适当约束的交集）。\n   该逻辑必须基于试验主应力和屈服不等式的残差。\n4. 实现一个程序：\n   - 不接受任何输入，并使用下面指定的测试套件。\n   - 通过评估与决策逻辑一致的所有潜在激活特征（面、边、顶点）上的候选点，计算主应力空间中的欧几里得最近点投影，并选择满足所有屈服不等式且欧几里得距离最小的候选点。\n   - 对每个测试用例，返回投影后的主应力，单位为千帕。\n\n角度单位：摩擦角 $\\varphi$ 以度为单位给出，在程序内部必须转换为弧度以用于三角函数计算。\n\n单位：所有应力必须以千帕（kPa）表示。你的程序必须以kPa为单位输出投影后的主应力。将报告的每个主应力四舍五入到 $6$ 位小数。\n\n测试套件和参数：\n- 材料参数：内聚力 $c = 20$ kPa，摩擦角 $\\varphi = 30$ 度。\n- 定义以下 $4$ 个试验主应力状态 $\\boldsymbol{t}$（单位均为kPa）：\n  1. $\\boldsymbol{t}^{(1)} = [100, 80, 60]^T$ （内部，预期的弹性/正常路径）。\n  2. $\\boldsymbol{t}^{(2)} = [300, 20, -10]^T$ （主要违反一个面）。\n  3. $\\boldsymbol{t}^{(3)} = [300, 200, -50]^T$ （违反两个相邻面，边的情况）。\n  4. $\\boldsymbol{t}^{(4)} = [-200, -200, -200]^T$ （静水拉伸超出顶点，顶点的情况）。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含结果，格式为逗号分隔的Python风格浮点数列表的列表，每个内部列表对应一个测试用例的 $3$ 个投影主应力，顺序与上述指定相同。\n- 示例格式：\"[[s11,s12,s13],[s21,s22,s23],[s31,s32,s33],[s41,s42,s43]]\"，其中每个 $s_{ij}$ 都四舍五入到 $6$ 位小数并以kPa表示。", "solution": "该问题要求为理想塑性莫尔-库仑材料实现一个最近点投影算法。此算法将一个超出屈服面的试探应力点，在几何上投影回屈服面上距离最近的一点。\n\n### 1. 莫尔-库仑屈服面方程\n\n莫尔-库仑屈服准则源于库仑摩擦定律，即剪应力 $\\tau$ 受法向应力 $\\sigma_n$ 限制：$|\\tau| \\le c + \\sigma_n \\tan\\varphi$ (压为正)。在主应力空间中，该条件等价于最大莫尔圆与此破坏包络线相切。对于任意一对主应力 $\\sigma_i$ 和 $\\sigma_j$，这导致屈服函数为：\n$$\nf_{ij}(\\boldsymbol{\\sigma}) = \\sigma_i(1 - \\sin\\varphi) - \\sigma_j(1 + \\sin\\varphi) - 2c\\cos\\varphi \\le 0, \\quad \\forall i,j \\in \\{1,2,3\\}, i \\ne j\n$$\n莫尔-库仑屈服面是这六个线性不等式定义的半空间的交集，形成一个以静水压力轴为中心轴的六角锥体。\n\n### 2. 屈服面的几何特征\n\n- **顶点 (Apex):** 锥体的顶点位于所有主应力相等的点，即 $\\sigma_1 = \\sigma_2 = \\sigma_3 = p$。代入任一屈服函数，可解得顶点处的静水压力 $p_{\\text{apex}} = -c \\cot\\varphi$。因此，顶点坐标为 $\\boldsymbol{\\sigma}_{\\text{apex}} = [-c \\cot\\varphi, -c \\cot\\varphi, -c \\cot\\varphi]^T$。\n- **面 (Faces):** 每个不等式 $f_{ij}(\\boldsymbol{\\sigma}) = 0$ 定义了锥体的一个面。该面的外法向量 $\\boldsymbol{a}_{ij}$ 为：\n$$\n\\boldsymbol{a}_{ij} = \\frac{\\partial f_{ij}}{\\partial\\boldsymbol{\\sigma}}\n$$\n其分量为：第 $i$ 个分量是 $(1 - \\sin\\varphi)$，第 $j$ 个分量是 $-(1 + \\sin\\varphi)$，第三个分量为 $0$。\n- **棱 (Edges):** 锥体的棱是相邻两个面的交线。例如，面 $f_{ik}=0$ 和 $f_{jk}=0$ 的交线满足 $\\sigma_i(1 - \\sin\\varphi) = \\sigma_j(1 - \\sin\\varphi)$，这意味着 $\\sigma_i = \\sigma_j$ (当 $\\varphi \\ne 90^\\circ$ 时)。因此，棱位于两个主应力相等的平面上。\n\n### 3. 最近点投影算法逻辑\n\n寻找最近点投影是一个约束优化问题。根据KKT条件，返回向量 $(\\boldsymbol{t} - \\boldsymbol{\\sigma}^*)$ 必须是激活约束（即投影点所在的特征）的外法线的正线性组合。一个鲁棒的算法流程如下：\n\n1.  **弹性检查：** 对于给定的试探应力 $\\boldsymbol{t}$，计算所有六个屈服函数 $f_{ij}(\\boldsymbol{t})$。如果全部 $f_{ij} \\le 0$，则应力点在屈服面内或面上，无需投影，$\\boldsymbol{\\sigma}^* = \\boldsymbol{t}$。\n2.  **候选点评估：** 如果应力点在屈服面外，则投影点 $\\boldsymbol{\\sigma}^*$ 必然在屈服面的边界上（顶点、棱或面）。\n    a.  **顶点投影：** 锥体顶点 $\\boldsymbol{\\sigma}_{\\text{apex}}$ 是一个始终可行的候选点。\n    b.  **面投影：** 对每个被违反的面（$f_{ij}(\\boldsymbol{t}) > 0$），计算 $\\boldsymbol{t}$ 在该面上的正交投影。然后检查该投影点是否满足所有其他五个不等式。如果满足，则它是一个有效的“面返回”候选点。\n    c.  **棱投影：** 对每条棱（由两个相交面定义），计算 $\\boldsymbol{t}$ 在该棱上的正交投影。检查投影点是否位于两个顶点之间，并且是否满足KKT条件（即返回向量是两个面法线的正线性组合）。如果满足，则它是一个有效的“棱返回”候选点。\n3.  **选择最近点：** 从所有有效的候选点（顶点、面返回点、棱返回点）中，选择一个使欧几里得距离 $\\|\\boldsymbol{\\sigma} - \\boldsymbol{t}\\|$ 最小的点。由于屈服面是凸的，这个最近点是唯一存在的。\n\n此算法保证了能正确处理所有情况，包括当最近点位于光滑面、棱或顶点时。\n\n### 4. 测试用例求解\n\n根据上述算法，对给定的材料参数 ($c=20$ kPa, $\\varphi=30^\\circ$) 和试探应力状态进行计算：\n- $p_{\\text{apex}} = -20 \\cot(30^\\circ) \\approx -34.641016$ kPa。\n\n1.  **$\\boldsymbol{t}^{(1)} = [100, 80, 60]^T$**: 计算所有六个 $f_{ij}$ 值，发现均小于零。此点在屈服面内，为弹性状态，无需投影。\n2.  **$\\boldsymbol{t}^{(2)} = [300, 20, -10]^T$**: 此点超出屈服面。投影到单个面会违反其他约束。正确的投影点位于一条棱上，该棱对应于两个主应力相等的情况。计算得到投影点的主应力分量为 $\\{278.428571, 69.715714, 69.715714\\}$。\n3.  **$\\boldsymbol{t}^{(3)} = [300, 200, -50]^T$**: 此点同样超出屈服面。与上一种情况类似，它也是一个棱返回。计算得到投影点的主应力分量为 $\\{216.928000, 216.928000, 49.216000\\}$。\n4.  **$\\boldsymbol{t}^{(4)} = [-200, -200, -200]^T$**: 这是一个静水拉伸状态，超出了锥体的顶点。最近点即为顶点本身。\n\n将这些结果格式化为指定输出。注意，对于第2和第3个案例，投影后的主应力值已按大小排序。实际的投影向量取决于主应力方向与坐标轴的对应关系，但问题要求返回主应力值。", "answer": "[[100.000000,80.000000,60.000000],[278.428571,69.715714,69.715714],[216.928000,216.928000,49.216000],[-34.641016,-34.641016,-34.641016]]", "id": "3549310"}]}