{"hands_on_practices": [{"introduction": "我们从一个基础性的练习开始，它将帮助我们直观地理解各向同性硬化的概念。通过经典的修正剑桥黏土（Modified Cam-Clay）模型，本练习旨在揭示过固结比（Overconsolidation Ratio, OCR）与屈服面演化之间的内在联系，这是岩土力学中的一个核心概念。通过推导[@problem_id:3536015]，您将清晰地看到先期固结压力 $p_c$ 作为状态变量，是如何量化弹性域大小并控制屈服起始点的。", "problem": "考虑一个由纯各向同性硬化的修正剑桥 (MCC) 模型描述的饱和黏性土。设应力不变量为平均有效应力 $p$ 和偏应力 $q$，其定义为 $p = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}')$ 和 $q = \\sqrt{\\frac{3}{2} \\boldsymbol{s}:\\boldsymbol{s}}$，其中 $\\boldsymbol{\\sigma}'$ 是有效应力张量，$\\boldsymbol{s} = \\boldsymbol{\\sigma}' - p \\boldsymbol{I}$ 是偏应力张量。MCC 屈服面由以下椭圆方程给出\n$$\nf(p,q,p_c) = \\left(\\frac{q}{M}\\right)^{2} + p\\,(p - p_c) = 0,\n$$\n其中 $M$ 是 $p$–$q$ 空间中临界状态线的斜率，$p_c$ 是当前的先期固结压力。土体的初始状态是在屈服面内，于平均有效应力 $p'_0$ 下各向同性固结，初始先期固结压力为 $p_{c0} > p'_0$。超固结比 (OCR) 定义为 $\\text{OCR} = \\frac{p_{c0}}{p'_0}$。\n\n施加静水加载（$q = 0$ 恒成立），当静水加载路径与屈服面相交时，开始发生屈服。屈服开始后，各向同性硬化根据 MCC 框架演化，即 $p_c$ 随着塑性体积应变的累积而增加。假设不存在运动硬化（即屈服面不在应力空间中平移；仅通过 $p_c$ 改变其大小）。\n\n仅使用上述定义和 MCC 屈服面几何的基本性质，完成以下任务：\n\n1. 推导超固结比 $\\text{OCR}$ 如何决定达到屈服开始所需的静水应力增量。\n2. 当先期固结压力因各向同性硬化从 $p_{c0}$ 变为 $p_c = p_{c0} + \\Delta p_c$ 时，量化 $p$–$q$ 平面中弹性域大小的变化。使用 $p$–$q$ 平面中屈服椭圆的面积作为域大小的度量。\n\n作为最终输出，提供弹性域面积相对变化量的单个闭式表达式，定义为\n$$\n\\delta = \\frac{A(p_c) - A(p_{c0})}{A(p_{c0})},\n$$\n用 $p_{c0}$ 和 $\\Delta p_c$ 表示。以简化的符号形式给出最终表达式。无需进行数值计算。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **模型**：修正剑桥 (MCC) 模型，纯各向同性硬化。\n- **应力不变量**：平均有效应力 $p = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}')$ 和偏应力 $q = \\sqrt{\\frac{3}{2} \\boldsymbol{s}:\\boldsymbol{s}}$。\n- **偏应力张量**：$\\boldsymbol{s} = \\boldsymbol{\\sigma}' - p \\boldsymbol{I}$。\n- **屈服面方程**：$f(p,q,p_c) = \\left(\\frac{q}{M}\\right)^{2} + p\\,(p - p_c) = 0$。\n- **模型参数**：$M$ 是临界状态线的斜率；$p_c$ 是先期固结压力。\n- **初始条件**：土体在平均有效应力 $p'_0$ 下各向同性固结。该状态位于屈服面内。初始先期固结压力为 $p_{c0}$，且 $p_{c0} > p'_0$。\n- **定义**：超固结比 (OCR) 为 $\\text{OCR} = \\frac{p_{c0}}{p'_0}$。\n- **加载路径**：静水加载，即 $q = 0$ 恒成立。\n- **硬化规律**：仅各向同性硬化，$p_c$ 增加。无运动硬化。\n- **任务1**：根据 OCR 推导达到屈服开始所需的静水应力增量。\n- **任务2**：当先期固结压力从 $p_{c0}$ 变为 $p_c = p_{c0} + \\Delta p_c$ 时，量化弹性域面积的相对变化量 $\\delta = \\frac{A(p_c) - A(p_{c0})}{A(p_{c0})}$。面积 $A$ 是 $p$–$q$ 平面中屈服椭圆的面积。\n- **最终输出**：一个用 $p_{c0}$ 和 $\\Delta p_c$ 表示 $\\delta$ 的单个闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题定义明确且有科学依据。\n- **科学依据**：修正剑桥模型是临界状态土力学的基石，是岩土力学中一个标准且完善的理论。所有定义和方程都是该模型的标准表示。\n- **良态问题**：该问题提供了清晰的初始状态 $(p'_0, 0)$、明确的屈服准则 $f(p, q, p_{c0}) = 0$ 和特定的加载路径 ($q=0$)。所提出的问题是精确的，并允许进行唯一的数学推导。条件 $p_{c0} > p'_0$ 确保了初始状态是弹性的，这与实际情况一致。\n- **客观性**：语言正式且无歧义。任务被表述为基于所提供的数学框架进行推导和量化。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n按照要求分两部分解决问题。\n\n**第一部分：达到屈服的静水应力增量**\n\n土体的初始应力状态由 $(p, q) = (p'_0, 0)$ 给出。初始屈服面由先期固结压力 $p_{c0}$ 和以下方程定义：\n$$ f(p, q, p_{c0}) = \\left(\\frac{q}{M}\\right)^{2} + p(p - p_{c0}) = 0 $$\n条件 $p_{c0} > p'_0$ 意味着初始状态位于屈服面内部，因为对于 $p=p'_0$ 和 $q=0$，我们有 $f(p'_0, 0, p_{c0}) = p'_0(p'_0 - p_{c0})  0$。\n\n加载路径是静水的，这意味着在整个加载过程中偏应力 $q$ 保持为零。因此，应力路径是 $p$–$q$ 平面中的一条水平线，从 $(p'_0, 0)$ 开始并沿 $p$ 轴移动。\n\n当应力状态达到屈服面时，屈服开始。我们通过将 $q=0$ 代入屈服函数来找到加载路径（$q=0$）与屈服面的交点：\n$$ \\left(\\frac{0}{M}\\right)^{2} + p(p - p_{c0}) = 0 $$\n$$ p(p - p_{c0}) = 0 $$\n该方程有两个解：$p=0$ 和 $p=p_{c0}$。点 $p=0$ 代表了原点处屈服椭圆的顶点。点 $p=p_{c0}$ 是椭圆与正 $p$ 轴的交点。由于加载从 $p'_0 > 0$ 开始，并随着静水应力的增加而进行，当平均有效应力 $p$ 达到值 $p_{c0}$ 时，土体将屈服。\n\n屈服开始时的平均有效应力为 $p_{yield} = p_{c0}$。\n初始平均有效应力为 $p_{initial} = p'_0$。\n所需的静水应力增量 $\\Delta p$ 是屈服应力与初始应力之差：\n$$ \\Delta p = p_{yield} - p_{initial} = p_{c0} - p'_0 $$\n题目要求用超固结比 $\\text{OCR} = \\frac{p_{c0}}{p'_0}$ 来表示这个增量。我们可以写成 $p_{c0} = \\text{OCR} \\cdot p'_0$。将其代入 $\\Delta p$ 的表达式中：\n$$ \\Delta p = (\\text{OCR} \\cdot p'_0) - p'_0 = (\\text{OCR} - 1)p'_0 $$\n该表达式给出了达到屈服面所需的静水应力增量。\n\n**第二部分：弹性域面积的相对变化**\n\n弹性域的大小由 $p$–$q$ 平面中屈服椭圆的面积来度量。屈服面的方程是：\n$$ \\left(\\frac{q}{M}\\right)^{2} + p(p - p_c) = 0 $$\n为了求面积，我们首先将此方程重写为椭圆的标准形式。我们对包含 $p$ 的项进行配方：\n$$ p^2 - p_c p = \\left(p - \\frac{p_c}{2}\\right)^2 - \\left(\\frac{p_c}{2}\\right)^2 $$\n将其代回屈服面方程：\n$$ \\left(\\frac{q}{M}\\right)^{2} + \\left(p - \\frac{p_c}{2}\\right)^2 - \\left(\\frac{p_c}{2}\\right)^2 = 0 $$\n整理各项，我们得到：\n$$ \\left(p - \\frac{p_c}{2}\\right)^2 + \\frac{q^2}{M^2} = \\left(\\frac{p_c}{2}\\right)^2 $$\n为了匹配标准形式 $\\frac{(x-h)^2}{a^2} + \\frac{(y-k)^2}{b^2} = 1$，我们两边同除以 $\\left(\\frac{p_c}{2}\\right)^2$：\n$$ \\frac{\\left(p - \\frac{p_c}{2}\\right)^2}{\\left(\\frac{p_c}{2}\\right)^2} + \\frac{q^2}{M^2 \\left(\\frac{p_c}{2}\\right)^2} = 1 $$\n这是一个中心位于 $(h, k) = (\\frac{p_c}{2}, 0)$ 的椭圆方程。$p$ 方向的半轴是 $a = \\frac{p_c}{2}$，$q$ 方向的半轴是 $b = M \\frac{p_c}{2}$。\n\n椭圆的面积由公式 $A = \\pi a b$ 给出。因此，MCC 屈服椭圆的面积，作为先期固结压力 $p_c$ 的函数，是：\n$$ A(p_c) = \\pi \\left(\\frac{p_c}{2}\\right) \\left(M \\frac{p_c}{2}\\right) = \\frac{\\pi M p_c^2}{4} $$\n弹性域的初始面积对应于初始先期固结压力 $p_{c0}$：\n$$ A(p_{c0}) = \\frac{\\pi M p_{c0}^2}{4} $$\n由于各向同性硬化，先期固结压力增加到 $p_c = p_{c0} + \\Delta p_c$。弹性域的新面积是：\n$$ A(p_c) = A(p_{c0} + \\Delta p_c) = \\frac{\\pi M (p_{c0} + \\Delta p_c)^2}{4} $$\n题目要求计算弹性域面积的相对变化量 $\\delta$，定义为：\n$$ \\delta = \\frac{A(p_c) - A(p_{c0})}{A(p_{c0})} $$\n代入面积的表达式：\n$$ \\delta = \\frac{\\frac{\\pi M (p_{c0} + \\Delta p_c)^2}{4} - \\frac{\\pi M p_{c0}^2}{4}}{\\frac{\\pi M p_{c0}^2}{4}} $$\n常数因子 $\\frac{\\pi M}{4}$ 从分子和分母中约去：\n$$ \\delta = \\frac{(p_{c0} + \\Delta p_c)^2 - p_{c0}^2}{p_{c0}^2} $$\n展开分子中的项：\n$$ \\delta = \\frac{(p_{c0}^2 + 2 p_{c0} \\Delta p_c + (\\Delta p_c)^2) - p_{c0}^2}{p_{c0}^2} $$\n$$ \\delta = \\frac{2 p_{c0} \\Delta p_c + (\\Delta p_c)^2}{p_{c0}^2} $$\n最后，通过将分子中的每一项除以 $p_{c0}^2$ 来简化表达式：\n$$ \\delta = 2 \\frac{\\Delta p_c}{p_{c0}} + \\left(\\frac{\\Delta p_c}{p_{c0}}\\right)^2 $$\n这是弹性域面积相对变化的最终闭式表达式，用初始先期固结压力 $p_{c0}$ 及其增量 $\\Delta p_c$ 表示。", "answer": "$$\n\\boxed{2 \\frac{\\Delta p_c}{p_{c0}} + \\left(\\frac{\\Delta p_c}{p_{c0}}\\right)^2}\n$$", "id": "3536015"}, {"introduction": "在理解了硬化的基本概念后，下一个关键步骤是连接理论模型与实验现实。本练习[@problem_id:3536081]将指导您如何从单调三轴压缩试验数据中确定各向同性硬化模量 $H$。您将运用基于最大似然估计的统计学原理，通过线性回归拟合数据，这不仅能帮助您从实验曲线中提取本构参数，还能让您掌握如何量化这些参数的不确定性。", "problem": "给定单调三轴压缩数据，包括偏应力 $q$ 作为等效塑性应变 $\\bar\\varepsilon^p$ 函数的测量值。假设采用关联的 von Mises（也称为 $J_2$）塑性模型，该模型具有线性各向同性硬化，其中偏应力空间中的屈服应力随塑性应变而演化。从关联流动下第二偏应力不变量和等效塑性应变的标准定义，以及塑性加载的一致性条件出发，构建一个基于统计原理的程序，用于从单调三轴压缩下的 $q$ 与 $\\bar\\varepsilon^p$ 的测量值中确定各向同性硬化模量 $H$。将 $q$ 的测量误差视为具有未知方差的独立同分布正态偏差。仅使用塑性力学和最大似然推断的基本概念，推导您将实现的参数估计器，以及 $H$ 在置信水平为 $0.95$ 时的置信区间。您的实现必须能够处理截距（初始屈服水平）的存在，并为 $H$ 提供不确定性量化。\n\n将您的程序实现为一个完整的、可运行的程序，该程序：\n- 使用以下数据集测试套件，每个数据集均以配对列表 $(\\bar\\varepsilon^p_i, q_i)$ 的形式给出。\n- 将 $\\bar\\varepsilon^p$ 解释为无量纲，将 $q$ 的单位解释为千帕 (kPa)。\n- 对于每个数据集，估计 $H$（单位为 kPa），并计算 $H$ 的双侧 $0.95$ 置信区间（单位为 kPa）。\n- 汇总所有数据集的结果，并将其在单行上打印为类 JSON 的列表之列表，每个内部列表的顺序为 $[H_{\\text{estimate}}, H_{\\text{lower}}, H_{\\text{upper}}]$，所有值均以 kPa 为单位，不含任何额外文本。\n\n您可以使用的基本原理：\n- 关联 $J_2$ 塑性与线性各向同性硬化下的屈服由一个对其参数平滑的屈服函数 $f(q, \\bar\\varepsilon^p) \\le 0$ 控制，塑性加载的特征为 $f = 0$ 和一致性条件 $\\dot f = 0$。\n- 对于单调塑性加载，应力状态保持在屈服面上。\n- 在 $J_2$ 塑性中，等效塑性应变 $\\bar\\varepsilon^p$ 是与各向同性硬化变量功共轭的度量。\n- 对于具有未知方差的加性独立高斯测量噪声下的参数估计，最大似然估计器与线性模型的普通最小二乘法一致。\n\n测试套件（为您的程序提供这些精确数据）：\n- 情况 A（典型噪声水平，良态）：\n  - $\\bar\\varepsilon^p$: $[0.0, 0.01, 0.02, 0.03, 0.04, 0.05]$\n  - $q$ (kPa): $[118.8, 152.1, 179.3, 211.5, 238.0, 270.3]$\n- 情况 B（接近无噪声，估计方差的最小样本）：\n  - $\\bar\\varepsilon^p$: $[0.0, 0.025, 0.05]$\n  - $q$ (kPa): $[80.0, 130.0, 180.0]$\n- 情况 C（低信噪比）：\n  - $\\bar\\varepsilon^p$: $[0.0, 0.01, 0.02, 0.03, 0.04, 0.05]$\n  - $q$ (kPa): $[100.8, 100.9, 104.6, 105.1, 109.0, 109.6]$\n- 情况 D（存在轻微异常值）：\n  - $\\bar\\varepsilon^p$: $[0.0, 0.01, 0.02, 0.03, 0.06]$\n  - $q$ (kPa): $[150.0, 180.0, 196.0, 228.0, 320.0]$\n\n算法要求：\n- 基于 $J_2$ 塑性下各向同性硬化的一致性条件，将塑性加载期间 $q$ 和 $\\bar\\varepsilon^p$ 之间的关系建模为 $\\bar\\varepsilon^p$ 的仿射函数，具有未知的截距和斜率。\n- 设参数向量为 $\\boldsymbol\\theta = [q_0, H]^\\top$，其中 $q_0$ 是截距（单位为 kPa），$H$ 是各向同性硬化模量（单位为 kPa）。\n- 假设观测模型为 $q_i = q(\\bar\\varepsilon^p_i; \\boldsymbol\\theta) + \\varepsilon_i$，其中 $\\varepsilon_i$ 是均值为 $0$、方差为未知 $\\sigma^2$ 的独立同分布正态随机变量。\n- 在正态误差模型下，基于估计器的抽样分布，使用最大似然估计获得 $\\widehat{\\boldsymbol\\theta}$ 以及 $H$ 在置信水平为 $0.95$ 时的双侧置信区间。\n- 如果残差平方和恰好为零，则报告 $H$ 的零宽度置信区间。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含格式为 $[[H_A, L_A, U_A],[H_B, L_B, U_B],[H_C, L_C, U_C],[H_D, L_D, U_D]]$ 的无逗号、紧凑的列表之列表形式的结果，其中下标表示情况 A 到 D，所有值均以千帕 (kPa) 为单位。对所有数字使用普通十进制表示法。\n\n所有关于 $H$ 及其置信区间的量均以千帕 (kPa) 作答。不涉及角度。输出中不要打印任何单位；数值必须隐含地以千帕 (kPa) 为单位。置信水平必须解释为 $0.95$（一个小数），而不是百分比。", "solution": "该问题要求制定并实施一个程序，用于从单调三轴压缩数据中估计各向同性硬化模量 $H$。此问题是在具有线性各向同性硬化的关联 von Mises ($J_2$) 塑性理论框架下提出的。估计过程必须符合统计学原理，包含最大似然估计，并为估计量提供置信区间。\n\n**1. 塑性力学理论基础**\n\nvon Mises 屈服准则在应力空间中定义了一个屈服面。对于各向同性材料，该屈服面取决于偏应力张量的第二不变量 $J_2$。在三轴试验的背景下，使用偏应力 $q$（定义为 $q = \\sqrt{3J_2}$）来表示该准则十分方便。屈服函数 $f$ 由下式给出：\n$$\nf(\\boldsymbol{\\sigma}, \\kappa) = q - q_y(\\kappa) \\le 0\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$q_y$ 是偏应力空间中的当前屈服应力，它依赖于一个内部状态变量 $\\kappa$。对于各向同性硬化，$\\kappa$ 是累积塑性变形的标量度量，对于关联 $J_2$ 塑性，它就是等效塑性应变 $\\bar\\varepsilon^p$。\n\n问题指定了*线性*各向同性硬化。这意味着屈服应力 $q_y$ 和等效塑性应变 $\\bar\\varepsilon^p$ 之间存在线性关系：\n$$\nq_y(\\bar\\varepsilon^p) = q_0 + H \\bar\\varepsilon^p\n$$\n这里，$q_0$ 是初始屈服应力（$\\bar\\varepsilon^p=0$ 时的 $q_y$ 值），$H$ 是各向同性硬化模量，它是一个材料常数，表示屈服应力随塑性应变增加的速率。\n\n在塑性加载过程中，必须满足两个条件：应力状态必须位于屈服面上（$f=0$），并且在持续加载时必须保持在该面上。后者由一致性条件 $\\dot f = 0$ 保证。对于发生塑性变形的单调加载，条件 $f=0$ 持续成立。将线性硬化定律代入屈服函数，得到：\n$$\nf(q, \\bar\\varepsilon^p) = q - (q_0 + H\\bar\\varepsilon^p) = 0\n$$\n这可以重新排列，以表达在单调塑性加载阶段，测量的偏应力 $q$ 与等效塑性应变 $\\bar\\varepsilon^p$ 之间的理论关系：\n$$\nq = q_0 + H\\bar\\varepsilon^p\n$$\n该方程为使用仿射函数对实验数据 $(\\bar\\varepsilon^p_i, q_i)$ 进行建模提供了物理基础。\n\n**2. 统计模型与参数估计**\n\n我们有 $n$ 对数据 $(\\bar\\varepsilon^p_i, q_i)$。问题陈述，$q$ 的测量值服从独立同分布 (i.i.d.) 的正态误差。因此，观测模型为：\n$$\nq_i = q_0 + H\\bar\\varepsilon^p_i + \\varepsilon_i, \\quad \\text{for } i = 1, \\dots, n\n$$\n其中，误差 $\\varepsilon_i$ 假定从均值为 $0$、方差为未知 $\\sigma^2$ 的正态分布中抽取，即 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这是一个标准的简单线性回归模型，其中响应变量是 $q$，预测变量是 $\\bar\\varepsilon^p$。待估计的参数是截距 $q_0$ 和斜率 $H$。\n\n如问题所述，对于此模型，参数 $(q_0, H)$ 的最大似然估计 (MLE) 与普通最小二乘 (OLS) 估计一致。OLS 估计量通过最小化误差平方和 (SSE) 求得：\n$$\nS(q_0, H) = \\sum_{i=1}^n (q_i - (q_0 + H\\bar\\varepsilon^p_i))^2\n$$\n最小化 $S(q_0, H)$ 的估计量 $\\hat{q}_0$ 和 $\\hat{H}$ 由著名的 OLS 公式给出：\n$$\n\\hat{H} = \\frac{\\sum_{i=1}^n (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)(q_i - \\bar{q})}{\\sum_{i=1}^n (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)^2} = \\frac{S_{\\varepsilon q}}{S_{\\varepsilon \\varepsilon}}\n$$\n$$\n\\hat{q}_0 = \\bar{q} - \\hat{H}\\bar{\\bar\\varepsilon}^p\n$$\n其中 $\\bar{\\bar\\varepsilon}^p = \\frac{1}{n} \\sum_{i=1}^n \\bar\\varepsilon^p_i$ 和 $\\bar{q} = \\frac{1}{n} \\sum_{i=1}^n q_i$ 是样本均值。\n\n**3. 硬化模量 H 的置信区间**\n\n为了量化估计值 $\\hat{H}$ 的不确定性，我们构建一个置信区间。在假定的正态误差模型下，估计量 $\\hat{H}$ 的抽样分布为：\n$$\n\\hat{H} \\sim \\mathcal{N}\\left(H, \\frac{\\sigma^2}{\\sum_{i=1}^n (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)^2}\\right)\n$$\n由于误差方差 $\\sigma^2$ 未知，必须从数据中进行估计。$\\sigma^2$ 的一个无偏估计量是均方误差 (MSE)，记作 $s^2$：\n$$\ns^2 = \\frac{SSE}{n-p} = \\frac{\\sum_{i=1}^n (q_i - \\hat{q}_i)^2}{n-2}\n$$\n其中 $\\hat{q}_i = \\hat{q}_0 + \\hat{H}\\bar\\varepsilon^p_i$ 是拟合值，$p=2$ 是估计参数（$q_0$ 和 $H$）的数量。分母 $n-2$ 表示残差的自由度。\n\n那么 $\\hat{H}$ 的估计标准误为：\n$$\nSE(\\hat{H}) = \\sqrt{\\frac{s^2}{\\sum_{i=1}^n (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)^2}}\n$$\n用估计方差 $s^2$ 代替真实方差 $\\sigma^2$ 后，标准化统计量服从自由度为 $n-2$ 的学生 $t$ 分布：\n$$\n\\frac{\\hat{H} - H}{SE(\\hat{H})} \\sim t_{n-2}\n$$\n置信水平为 $1-\\alpha$（此处为 $0.95$，因此 $\\alpha=0.05$）的 $H$ 的双侧置信区间构建如下：\n$$\n\\left[ \\hat{H} - t_{\\alpha/2, n-2} \\cdot SE(\\hat{H}), \\quad \\hat{H} + t_{\\alpha/2, n-2} \\cdot SE(\\hat{H}) \\right]\n$$\n其中 $t_{\\alpha/2, n-2}$ 是来自 $t$ 分布的临界值，它使上尾面积为 $\\alpha/2$。对于 $0.95$ 的置信水平，我们需要 $t_{0.025, n-2}$。\n\n如果数据点完全共线，则会出现一个特殊情况，即 $SSE=0$。在这种情况下，估计的误差方差 $s^2$ 为 $0$，因此 $SE(\\hat{H})=0$。模型完美拟合数据。遵循问题的指示， $H$ 的置信区间收缩为一个零宽度区间 $[\\hat{H}, \\hat{H}]$。这表示在数据真正无噪声的（强）假设下，对估计的斜率有完全的置信。\n\n**4. 算法步骤**\n\n对于每个提供的数据集 $(\\bar{\\boldsymbol{\\varepsilon}}^p, \\mathbf{q})$：\n1.  将 $\\bar{\\boldsymbol{\\varepsilon}}^p$ 视为预测变量向量，$\\mathbf{q}$ 视为响应变量向量。设 $n$ 为数据点数量。\n2.  计算样本均值 $\\bar{\\bar\\varepsilon}^p$ 和 $\\bar{q}$。\n3.  计算预测变量的平方和 $S_{\\varepsilon \\varepsilon} = \\sum (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)^2$ 和交叉乘积和 $S_{\\varepsilon q} = \\sum (\\bar\\varepsilon^p_i - \\bar{\\bar\\varepsilon}^p)(q_i - \\bar{q})$。\n4.  计算硬化模量的估计值：$\\hat{H} = S_{\\varepsilon q} / S_{\\varepsilon \\varepsilon}$。\n5.  计算初始屈服应力的估计值：$\\hat{q}_0 = \\bar{q} - \\hat{H}\\bar{\\bar\\varepsilon}^p$。\n6.  使用残差 $e_i = q_i - (\\hat{q}_0 + \\hat{H}\\bar\\varepsilon^p_i)$ 计算误差平方和 ($SSE$)。\n7.  如果 $SSE$ 在数值上为零（或低于一个小的容差），则置信区间的下限和上限均等于 $\\hat{H}$。\n8.  如果 $SSE > 0$：\n    a. 确定自由度，$df = n-2$。\n    b. 计算估计的误差方差，$s^2 = SSE / df$。\n    c. 计算斜率的标准误，$SE(\\hat{H}) = \\sqrt{s^2 / S_{\\varepsilon \\varepsilon}}$。\n    d. 使用统计库函数找到临界 t 值 $t_{0.025, df}$。\n    e. 计算误差范围，$ME = t_{0.025, df} \\cdot SE(\\hat{H})$。\n    f. 置信区间为 $[\\hat{H} - ME, \\hat{H} + ME]$。\n9.  为当前数据集存储三元组 $[\\hat{H}, \\text{下限}, \\text{上限}]$。\n10. 处理完所有数据集后，将结果汇总成一个列表之列表，并按照最终输出的指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Performs linear regression to estimate the isotropic hardening modulus H\n    and its 95% confidence interval from provided experimental data, based on\n    a von Mises plasticity model with linear isotropic hardening.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"ep_p\": [0.0, 0.01, 0.02, 0.03, 0.04, 0.05],\n            \"q_kPa\": [118.8, 152.1, 179.3, 211.5, 238.0, 270.3]\n        },\n        {\n            \"name\": \"Case B\",\n            \"ep_p\": [0.0, 0.025, 0.05],\n            \"q_kPa\": [80.0, 130.0, 180.0]\n        },\n        {\n            \"name\": \"Case C\",\n            \"ep_p\": [0.0, 0.01, 0.02, 0.03, 0.04, 0.05],\n            \"q_kPa\": [100.8, 100.9, 104.6, 105.1, 109.0, 109.6]\n        },\n        {\n            \"name\": \"Case D\",\n            \"ep_p\": [0.0, 0.01, 0.02, 0.03, 0.06],\n            \"q_kPa\": [150.0, 180.0, 196.0, 228.0, 320.0]\n        }\n    ]\n\n    all_results = []\n    \n    # Per-problem requirement for confidence level alpha\n    alpha = 0.05\n\n    for case in test_cases:\n        # Assign predictor (x) and response (y) variables\n        # x: equivalent plastic strain (bar_epsilon^p), dimensionless\n        # y: deviatoric stress (q), in kPa\n        x = np.array(case[\"ep_p\"])\n        y = np.array(case[\"q_kPa\"])\n        \n        n = len(x)\n        if n  3:\n            # Degrees of freedom would be = 0, cannot estimate variance.\n            # This case is not in the test suite but is a good practice check.\n            # For n=2, we have df=0, t-dist is undefined.\n            # OLS estimate is possible, but uncertainty is not quantifiable this way.\n            # For the purpose of this problem, we assume n>=3.\n            pass\n\n        # Calculate means\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n\n        # Calculate sum of squares S_xx and sum of products S_xy\n        s_xx = np.sum((x - x_mean)**2)\n        s_xy = np.sum((x - x_mean) * (y - y_mean))\n\n        # Estimate H (slope) and q0 (intercept)\n        # H is the isotropic hardening modulus in kPa.\n        # q0 is the initial yield stress in kPa.\n        h_estimate = s_xy / s_xx if s_xx != 0 else 0.0\n        q0_estimate = y_mean - h_estimate * x\n\n        # Calculate fitted values and residuals\n        y_fit = q0_estimate + h_estimate * x\n        residuals = y - y_fit\n        \n        # Calculate Sum of Squared Errors (SSE)\n        sse = np.sum(residuals**2)\n\n        # Degrees of freedom for the residuals (n - number of parameters)\n        df = n - 2\n        \n        # Handle the special case of a perfect fit (SSE = 0)\n        # using a small tolerance for floating point comparison.\n        if df = 0 or sse  1e-12:\n            h_lower = h_estimate\n            h_upper = h_estimate\n        else:\n            # Estimate the variance of the error term\n            error_variance = sse / df\n            \n            # Calculate the standard error of the H estimate\n            se_h = np.sqrt(error_variance / s_xx)\n            \n            # Find the critical t-value for a two-sided 95% CI\n            t_crit = t.ppf(1 - alpha/2, df)\n            \n            # Margin of error\n            margin_of_error = t_crit * se_h\n            \n            # Calculate confidence interval\n            h_lower = h_estimate - margin_of_error\n            h_upper = h_estimate + margin_of_error\n\n        # Format the inner list as a string, e.g., \"[H,L,U]\", without spaces.\n        result_string = f\"[{h_estimate},{h_lower},{h_upper}]\"\n        all_results.append(result_string)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3536081"}, {"introduction": "掌握了概念并获得了参数后，我们便可以将这些知识应用于计算框架中。本练习[@problem_id:3536010]要求您实现一个“返回映射”（return-mapping）算法，这是计算塑性力学的核心引擎。您将为一个包含各向同性与运动学联合硬化的Drucker-Prager模型编写代码，亲手实践在发生塑性变形时如何精确更新材料状态，并探索非关联流动法则中膨胀性参数 $\\beta$ 的影响。", "problem": "考虑一个摩擦性岩土材料的小应变平面应变压缩步，该材料由各向同性线弹性和一个带组合各向同性与运动硬化的非关联Drucker–Prager型塑性模型描述。使用拉伸应力和应变为正的符号约定，并将压缩为正的平均应力不变量定义为 $p = -\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$，偏应力不变量定义为 $q = \\sqrt{\\frac{3}{2}} \\lVert \\mathbf{s} \\rVert$，其中 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$，$\\mathbf{I}$ 是单位张量。弹性模量为体积模量 $K$ 和剪切模量 $G$，小应变下的弹性应力-应变算子为 $\\boldsymbol{\\sigma} = 2G \\boldsymbol{\\epsilon}^{e}_{\\mathrm{dev}} + K \\epsilon^{e}_{v}\\mathbf{I}$，其中 $\\epsilon^{e}_{v} = \\operatorname{tr}(\\boldsymbol{\\epsilon}^{e})$ 且 $\\boldsymbol{\\epsilon}^{e}_{\\mathrm{dev}} = \\boldsymbol{\\epsilon}^{e} - \\frac{1}{3}\\epsilon^{e}_{v}\\mathbf{I}$。在考虑组合硬化的 $p$–$q$ 空间中，屈服函数由下式给出\n$$\nf = (q - a) + \\eta\\, p - (q_{y0} + R),\n$$\n其中 $a$ 是运动硬化背应力（单位为应力），$R$ 是各向同性硬化变量（单位为应力），$\\eta$ 是摩擦斜率参数（无量纲），$q_{y0}$ 是屈服面在 $q$ 方向上的初始尺寸（单位为应力）。塑性加载满足标准的Karush–Kuhn–Tucker条件，$f \\le 0$，$\\lambda \\ge 0$，$\\lambda f = 0$，弹性域条件，以及当塑性加载发生时的一致性条件。非关联塑性势定义为\n$$\ng = q + \\beta\\, p,\n$$\n其中 $\\beta$ 是剪胀参数（无量纲），控制剪切作用下的体积塑性应变增量。塑性流动法则为 $\\mathrm{d}\\boldsymbol{\\epsilon}^{p} = \\lambda\\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，硬化法则为\n$$\n\\mathrm{d}R = H_{\\mathrm{iso}}\\, \\mathrm{d}\\bar{\\epsilon}^{p}, \\quad \\mathrm{d}a = H_{\\mathrm{kin}}\\, \\mathrm{d}\\bar{\\epsilon}^{p}, \\quad \\mathrm{d}\\bar{\\epsilon}^{p} = \\lambda,\n$$\n其中 $H_{\\mathrm{iso}}$ 和 $H_{\\mathrm{kin}}$ 是分别控制各向同性和运动硬化的模量（单位为应力），$\\mathrm{d}\\bar{\\epsilon}^{p}$ 是等效塑性应变增量，在本模型中等同于塑性乘子 $\\lambda$。计算任务是，在给定的平面应变总应变增量下，执行从弹性试探状态到屈服面的一致性返回映射步，并计算：\n- 塑性应变增量张量分量 $\\mathrm{d}\\epsilon^{p}_{xx}$、$\\mathrm{d}\\epsilon^{p}_{yy}$ 和 $\\mathrm{d}\\epsilon^{p}_{zz}$（无量纲），以及\n- 更新后的平均应力不变量 $p$（单位为MPa）和更新后的偏应力不变量 $q$（单位为MPa），\n展示剪胀参数 $\\beta$ 如何影响体积塑性应变和平均应力更新。\n\n从零初始应力、零初始塑性应变、零背应力 $a=0$ 和零各向同性硬化变量 $R=0$ 开始。假设平面应变下的总应变增量具有以下形式\n$$\n\\mathrm{d}\\boldsymbol{\\epsilon} = \\begin{bmatrix}\n\\mathrm{d}\\epsilon_{xx}  0  0 \\\\\n0  \\mathrm{d}\\epsilon_{yy}  0 \\\\\n0  0  0\n\\end{bmatrix},\n$$\n不含剪切分量且 $\\mathrm{d}\\epsilon_{zz} = 0$。\n\n您的程序必须实现以下科学上一致的步骤：\n1. 使用各向同性线弹性算子和给定的总应变增量，构建弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$（对于试探状态，在增量步内保持 $\\boldsymbol{\\epsilon}^{p}$ 不变）。从 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 计算 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$。\n2. 评估屈服函数 $f^{\\mathrm{tr}}$。如果 $f^{\\mathrm{tr}} \\le 0$，则该步为弹性步：将塑性应变增量设为零，并将 $p$ 和 $q$ 更新为其试探值。\n3. 如果 $f^{\\mathrm{tr}}  0$，则强制执行一致性条件并执行返回映射，以计算塑性乘子、塑性应变增量分量，并在考虑各向同性和运动硬化以及由 $g$ 的梯度决定的非关联流动方向的情况下更新 $p$ 和 $q$。\n4. 为保证数值鲁棒性，确保在 $q^{\\mathrm{tr}}$ 非常小时，处理任何通过 $q^{\\mathrm{tr}}$ 进行的归一化。\n\n使用以下参数集和平面应变增量的测试套件，其中应力以兆帕（MPa）表示，应变为无量纲：\n- 测试1（弹性基线）：$K = 100$ MPa，$G = 40$ MPa，$\\eta = 0.3$，$H_{\\mathrm{iso}} = 20$ MPa，$H_{\\mathrm{kin}} = 10$ MPa，$q_{y0} = 3.0$ MPa，$\\beta = 0.1$，$\\mathrm{d}\\epsilon_{xx} = -5\\times 10^{-6}$，$\\mathrm{d}\\epsilon_{yy} = -1\\times 10^{-6}$。\n- 测试2（塑性，剪胀）：$K = 100$ MPa，$G = 40$ MPa，$\\eta = 0.3$，$H_{\\mathrm{iso}} = 20$ MPa，$H_{\\mathrm{kin}} = 10$ MPa，$q_{y0} = 0.02$ MPa，$\\beta = -0.2$，$\\mathrm{d}\\epsilon_{xx} = -5\\times 10^{-4}$，$\\mathrm{d}\\epsilon_{yy} = -1\\times 10^{-4}$。\n- 测试3（塑性，剪缩）：$K = 100$ MPa，$G = 40$ MPa，$\\eta = 0.3$，$H_{\\mathrm{iso}} = 20$ MPa，$H_{\\mathrm{kin}} = 10$ MPa，$q_{y0} = 0.02$ MPa，$\\beta = 0.2$，$\\mathrm{d}\\epsilon_{xx} = -5\\times 10^{-4}$，$\\mathrm{d}\\epsilon_{yy} = -1\\times 10^{-4}$。\n- 测试4（接近屈服，中性剪胀）：$K = 100$ MPa，$G = 40$ MPa，$\\eta = 0.3$，$H_{\\mathrm{iso}} = 20$ MPa，$H_{\\mathrm{kin}} = 10$ MPa，$q_{y0} = 0.02$ MPa，$\\beta = 0.0$，$\\mathrm{d}\\epsilon_{xx} = -2\\times 10^{-4}$，$\\mathrm{d}\\epsilon_{yy} = -1\\times 10^{-4}$。\n\n最终输出格式要求：您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表，每个测试用例对应一个子列表，每个子列表按 $[\\mathrm{d}\\epsilon^{p}_{xx}, \\mathrm{d}\\epsilon^{p}_{yy}, \\mathrm{d}\\epsilon^{p}_{zz}, p, q]$ 的顺序列出，例如 $[[e_{xx},e_{yy},e_{zz},p,q],[\\dots],\\dots]$。所有应力值必须以MPa为单位，所有应变值均为无量纲。", "solution": "用户提供了一个计算岩土力学问题，要求为一个带组合各向同性与运动硬化的非关联Drucker-Prager塑性模型实现返回映射算法。\n\n问题陈述的验证如下：\n\n### 第一步：提取已知条件\n- **模型**：小应变、平面应变、各向同性线弹性、带组合各向同性与运动硬化的非关联Drucker-Prager塑性。\n- **符号约定**：拉伸应力和应变为正。\n- **应力不变量**：平均应力 $p = -\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$（压缩为正），偏应力 $q = \\sqrt{\\frac{3}{2}} \\lVert \\mathbf{s} \\rVert$，其中 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$。\n- **弹性定律**：$\\boldsymbol{\\sigma} = 2G \\boldsymbol{\\epsilon}^{e}_{\\mathrm{dev}} + K \\epsilon^{e}_{v}\\mathbf{I}$，其中体积模量为 $K$，剪切模量为 $G$。$\\epsilon^{e}_{v} = \\operatorname{tr}(\\boldsymbol{\\epsilon}^{e})$，$\\boldsymbol{\\epsilon}^{e}_{\\mathrm{dev}} = \\boldsymbol{\\epsilon}^{e} - \\frac{1}{3}\\epsilon^{e}_{v}\\mathbf{I}$。\n- **屈服函数**：$f = (q - a) + \\eta\\, p - (q_{y0} + R)$，其中 $\\eta$ 是摩擦斜率， $q_{y0}$ 是初始屈服应力， $a$ 是背应力， $R$ 是各向同性硬化变量。\n- **塑性势**：$g = q + \\beta\\, p$，其中 $\\beta$ 是剪胀参数。\n- **流动法则**：$\\mathrm{d}\\boldsymbol{\\epsilon}^{p} = \\lambda\\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中 $\\lambda$ 是塑性乘子。\n- **硬化法则**：$\\mathrm{d}R = H_{\\mathrm{iso}}\\, \\mathrm{d}\\bar{\\epsilon}^{p}$，$\\mathrm{d}a = H_{\\mathrm{kin}}\\, \\mathrm{d}\\bar{\\epsilon}^{p}$，其中硬化模量为 $H_{\\mathrm{iso}}$ 和 $H_{\\mathrm{kin}}$。\n- **等效塑性应变**：$\\mathrm{d}\\bar{\\epsilon}^{p} = \\lambda$。\n- **初始条件**：$\\boldsymbol{\\sigma}_0 = \\mathbf{0}$，$\\boldsymbol{\\epsilon}^{p}_0 = \\mathbf{0}$，$a_0 = 0$，$R_0 = 0$。\n- **加载**：平面应变增量 $\\mathrm{d}\\boldsymbol{\\epsilon} = \\operatorname{diag}(\\mathrm{d}\\epsilon_{xx}, \\mathrm{d}\\epsilon_{yy}, 0)$。\n- **任务**：计算塑性应变增量分量 $\\mathrm{d}\\epsilon^{p}_{xx}, \\mathrm{d}\\epsilon^{p}_{yy}, \\mathrm{d}\\epsilon^{p}_{zz}$ 和更新后的应力不变量 $p, q$。\n- **测试数据**：提供了四组材料参数和应变增量。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据（关键）**：该问题坚实地基于标准的弹塑性理论，特别是广泛用于岩土力学的Drucker-Prager模型。返回映射、非关联流动和组合硬化的概念都是计算塑性力学中的既定原则。该公式具有科学合理性。\n- **良定性**：该问题是良定的。所有必要的方程、材料参数、初始条件和加载增量都已指定，从而可以推导和计算出状态更新的唯一解。\n- **客观性（关键）**：问题陈述使用了精确的数学定义和客观语言，没有任何主观或模棱两可的术语。\n- **结论**：该问题是完整的、一致的、有科学依据且良定的。因此，它被判定为**有效**。\n\n### 第三步：裁定与行动\n问题有效。我将继续进行求解。\n\n### 基于原理的求解推导\n\n求解需要实现一个率无关塑性模型的单时间步，从一个已知状态（此处为零应力状态）开始，并施加一个总应变增量 $\\mathrm{d}\\boldsymbol{\\epsilon}$。该过程涉及一个弹性预测步和一个塑性修正步，通常称为返回映射算法。\n\n#### 1. 弹性预测（试探状态）\n首先，我们假设整个应变增量 $\\mathrm{d}\\boldsymbol{\\epsilon}$ 是纯弹性的。试探状态基于此假设进行计算。\n初始应力 $\\boldsymbol{\\sigma}_0$ 和初始塑性应变 $\\boldsymbol{\\epsilon}^p_0$ 均为零。\n试探弹性应变增量为 $\\mathrm{d}\\boldsymbol{\\epsilon}^e = \\mathrm{d}\\boldsymbol{\\epsilon}$。\n试探应力增量由弹性定律给出：$\\mathrm{d}\\boldsymbol{\\sigma} = \\mathbf{C} : \\mathrm{d}\\boldsymbol{\\epsilon}$，因此试探应力为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_0 + \\mathrm{d}\\boldsymbol{\\sigma} = \\mathbf{C} : \\mathrm{d}\\boldsymbol{\\epsilon}$。\n\n对于给定的平面应变增量 $\\mathrm{d}\\boldsymbol{\\epsilon} = \\operatorname{diag}(\\mathrm{d}\\epsilon_{xx}, \\mathrm{d}\\epsilon_{yy}, 0)$，体积应变增量为：\n$$ \\mathrm{d}\\epsilon_v = \\operatorname{tr}(\\mathrm{d}\\boldsymbol{\\epsilon}) = \\mathrm{d}\\epsilon_{xx} + \\mathrm{d}\\epsilon_{yy} $$\n偏应变增量张量分量为：\n$$ \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}} = \\mathrm{d}\\boldsymbol{\\epsilon} - \\frac{1}{3}\\mathrm{d}\\epsilon_v \\mathbf{I} \\implies \\begin{cases} \\mathrm{d}\\epsilon_{\\mathrm{dev},xx} = \\mathrm{d}\\epsilon_{xx} - \\frac{1}{3}\\mathrm{d}\\epsilon_v \\\\ \\mathrm{d}\\epsilon_{\\mathrm{dev},yy} = \\mathrm{d}\\epsilon_{yy} - \\frac{1}{3}\\mathrm{d}\\epsilon_v \\\\ \\mathrm{d}\\epsilon_{\\mathrm{dev},zz} = -\\frac{1}{3}\\mathrm{d}\\epsilon_v \\end{cases} $$\n试探应力张量为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = 2G \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}} + K \\mathrm{d}\\epsilon_v \\mathbf{I}$。\n试探应力不变量为：\n试探平均应力 $p^{\\mathrm{tr}}$：\n$$ p^{\\mathrm{tr}} = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = -\\frac{1}{3} \\operatorname{tr}(2G \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}} + K \\mathrm{d}\\epsilon_v \\mathbf{I}) = -\\frac{1}{3} (2G \\operatorname{tr}(\\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}}) + 3K \\mathrm{d}\\epsilon_v) = -K \\mathrm{d}\\epsilon_v $$\n试探偏应力张量为 $\\mathbf{s}^{\\mathrm{tr}} = 2G \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}}$。\n试探偏应力不变量 $q^{\\mathrm{tr}}$：\n$$ q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\mathbf{s}^{\\mathrm{tr}} : \\mathbf{s}^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} (4G^2 \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}} : \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}})} = 2G \\sqrt{\\frac{3}{2} (\\mathrm{d}\\epsilon_{\\mathrm{dev},xx}^2 + \\mathrm{d}\\epsilon_{\\mathrm{dev},yy}^2 + \\mathrm{d}\\epsilon_{\\mathrm{dev},zz}^2)} $$\n代入 $\\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}}$ 的分量并化简得到：\n$$ q^{\\mathrm{tr}} = 2G \\sqrt{\\mathrm{d}\\epsilon_{xx}^2 - \\mathrm{d}\\epsilon_{xx}\\mathrm{d}\\epsilon_{yy} + \\mathrm{d}\\epsilon_{yy}^2} $$\n\n#### 2. 屈服检查\n我们在试探状态下评估屈服函数。由于初始状态下 $a_0 = 0$ 且 $R_0 = 0$：\n$$ f^{\\mathrm{tr}} = (q^{\\mathrm{tr}} - a_0) + \\eta p^{\\mathrm{tr}} - (q_{y0} + R_0) = q^{\\mathrm{tr}} + \\eta p^{\\mathrm{tr}} - q_{y0} $$\n如果 $f^{\\mathrm{tr}} \\le 0$，则该步为弹性步。最终状态即为试探状态：\n- $\\mathrm{d}\\boldsymbol{\\epsilon}^p = \\mathbf{0}$\n- $p = p^{\\mathrm{tr}}$，$q = q^{\\mathrm{tr}}$\n\n#### 3. 塑性修正（返回映射）\n如果 $f^{\\mathrm{tr}}  0$，则发生塑性变形。最终状态 $(\\boldsymbol{\\sigma}, a, R)$ 必须位于屈服面上，满足一致性条件 $f=0$。从试探状态的更新为：\n$$ \\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\mathrm{d}\\boldsymbol{\\epsilon}^p $$\n塑性应变增量由非关联流动法则给出：\n$$ \\mathrm{d}\\boldsymbol{\\epsilon}^p = \\lambda \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\lambda \\left( \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} \\right) = \\lambda \\left( \\frac{3}{2q}\\mathbf{s} - \\frac{\\beta}{3}\\mathbf{I} \\right) $$\n将弹性算子 $\\mathbf{C}$ 应用于流动法则分量，得到应力修正：\n$$ \\mathbf{C} : \\mathrm{d}\\boldsymbol{\\epsilon}^p = \\lambda \\left( \\frac{3G}{q}\\mathbf{s} + K\\beta\\mathbf{I} \\right) $$\n在标准的返回映射假设下，即偏应力方向在修正过程中不发生改变（$\\mathbf{s}/q = \\mathbf{s}^{\\mathrm{tr}}/q^{\\mathrm{tr}}$），不变量的应力更新变为：\n$$ q = q^{\\mathrm{tr}} - 3G\\lambda $$\n$$ p = p^{\\mathrm{tr}} - K\\beta\\lambda $$\n硬化变量更新如下：\n$$ R = R_0 + H_{\\mathrm{iso}}\\lambda = H_{\\mathrm{iso}}\\lambda $$\n$$ a = a_0 + H_{\\mathrm{kin}}\\lambda = H_{\\mathrm{kin}}\\lambda $$\n将这些代入一致性条件 $f = (q-a) + \\eta p - (q_{y0} + R) = 0$：\n$$ (q^{\\mathrm{tr}} - 3G\\lambda - H_{\\mathrm{kin}}\\lambda) + \\eta(p^{\\mathrm{tr}} - K\\beta\\lambda) - (q_{y0} + H_{\\mathrm{iso}}\\lambda) = 0 $$\n重新整理以求解塑性乘子 $\\lambda$：\n$$ (q^{\\mathrm{tr}} + \\eta p^{\\mathrm{tr}} - q_{y0}) = \\lambda (3G + H_{\\mathrm{iso}} + H_{\\mathrm{kin}} + \\eta K\\beta) $$\n$$ \\lambda = \\frac{f^{\\mathrm{tr}}}{3G + H_{\\mathrm{iso}} + H_{\\mathrm{kin}} + \\eta K\\beta} $$\n在 $\\lambda$ 已知的情况下，使用它们的更新方程计算最终的应力不变量 $p$ 和 $q$。\n\n#### 4. 塑性应变增量计算\n需要计算塑性应变增量张量。使用返回映射近似 $\\mathbf{s}/q = \\mathbf{s}^{\\mathrm{tr}}/q^{\\mathrm{tr}}$ 并回顾 $\\mathbf{s}^{\\mathrm{tr}} = 2G \\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}}$：\n$$ \\mathrm{d}\\boldsymbol{\\epsilon}^p = \\lambda \\left( \\frac{3}{2q^{\\mathrm{tr}}}\\mathbf{s}^{\\mathrm{tr}} - \\frac{\\beta}{3}\\mathbf{I} \\right) = \\lambda \\left( \\frac{3G}{q^{\\mathrm{tr}}}\\mathrm{d}\\boldsymbol{\\epsilon}_{\\mathrm{dev}} - \\frac{\\beta}{3}\\mathbf{I} \\right) $$\n其分量为：\n$$ \\mathrm{d}\\epsilon^p_{xx} = \\lambda \\left( \\frac{3G}{q^{\\mathrm{tr}}} \\mathrm{d}\\epsilon_{\\mathrm{dev}, xx} - \\frac{\\beta}{3} \\right) $$\n$$ \\mathrm{d}\\epsilon^p_{yy} = \\lambda \\left( \\frac{3G}{q^{\\mathrm{tr}}} \\mathrm{d}\\epsilon_{\\mathrm{dev}, yy} - \\frac{\\beta}{3} \\right) $$\n$$ \\mathrm{d}\\epsilon^p_{zz} = \\lambda \\left( \\frac{3G}{q^{\\mathrm{tr}}} \\mathrm{d}\\epsilon_{\\mathrm{dev}, zz} - \\frac{\\beta}{3} \\right) $$\n对此公式的一个检验是体积塑性应变：$\\mathrm{d}\\epsilon^p_v = \\operatorname{tr}(\\mathrm{d}\\boldsymbol{\\epsilon}^p) = \\lambda (0 - 3\\frac{\\beta}{3}) = -\\lambda\\beta$。这正确地表明 $\\beta$ 控制塑性体积变化（$\\beta$ 为正表示压缩，$\\beta$ 为负表示剪胀）。计算算法将对每个测试用例实施这些推导出的公式。\n问题警告了关于用小的 $q^{\\mathrm{tr}}$ 进行归一化的问题。这对应于接近纯静水应力的试探状态。对于给定的测试用例，$\\mathrm{d}\\epsilon_{xx}$ 和 $\\mathrm{d}\\epsilon_{yy}$ 是不同的，确保了 $q^{\\mathrm{tr}}$ 不为零，因此不需要对顶点奇点进行特殊处理。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the return mapping problem for a Drucker-Prager model\n    with combined hardening for given test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Test 1 (elastic baseline)\n        {\n            \"K\": 100.0, \"G\": 40.0, \"eta\": 0.3, \"H_iso\": 20.0, \n            \"H_kin\": 10.0, \"q_y0\": 3.0, \"beta\": 0.1, \n            \"deps_xx\": -5e-6, \"deps_yy\": -1e-6\n        },\n        # Test 2 (plastic, dilation)\n        {\n            \"K\": 100.0, \"G\": 40.0, \"eta\": 0.3, \"H_iso\": 20.0, \n            \"H_kin\": 10.0, \"q_y0\": 0.02, \"beta\": -0.2, \n            \"deps_xx\": -5e-4, \"deps_yy\": -1e-4\n        },\n        # Test 3 (plastic, contraction)\n        {\n            \"K\": 100.0, \"G\": 40.0, \"eta\": 0.3, \"H_iso\": 20.0, \n            \"H_kin\": 10.0, \"q_y0\": 0.02, \"beta\": 0.2, \n            \"deps_xx\": -5e-4, \"deps_yy\": -1e-4\n        },\n        # Test 4 (near-yield, neutral dilatancy)\n        {\n            \"K\": 100.0, \"G\": 40.0, \"eta\": 0.3, \"H_iso\": 20.0, \n            \"H_kin\": 10.0, \"q_y0\": 0.02, \"beta\": 0.0, \n            \"deps_xx\": -2e-4, \"deps_yy\": -1e-4\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_step(params)\n        results.append(result)\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]},{r[3]},{r[4]}]\" for r in results]) + \"]\"\n    print(output_str)\n\ndef compute_step(params):\n    \"\"\"\n    Performs a single return-mapping step for one set of parameters.\n    \"\"\"\n    K, G, eta, H_iso, H_kin = params[\"K\"], params[\"G\"], params[\"eta\"], params[\"H_iso\"], params[\"H_kin\"]\n    q_y0, beta = params[\"q_y0\"], params[\"beta\"]\n    deps_xx, deps_yy = params[\"deps_xx\"], params[\"deps_yy\"]\n    deps_zz = 0.0  # Plane strain condition\n\n    # Step 1: Elastic Predictor (Trial State)\n    # Volumetric strain increment\n    deps_v = deps_xx + deps_yy + deps_zz\n\n    # Deviatoric strain increment components\n    deps_dev_xx = deps_xx - deps_v / 3.0\n    deps_dev_yy = deps_yy - deps_v / 3.0\n    deps_dev_zz = deps_zz - deps_v / 3.0\n\n    # Trial stress invariants (p_tr, q_tr)\n    p_tr = -K * deps_v\n    \n    # Using the simplified formula for plane strain q_tr\n    q_tr_term = deps_xx**2 - deps_xx * deps_yy + deps_yy**2\n    q_tr = 2.0 * G * np.sqrt(q_tr_term)\n\n    # Step 2: Yield Check\n    # Since initial state has R=0, a=0\n    f_tr = q_tr + eta * p_tr - q_y0\n\n    if f_tr = 0:\n        # Elastic step\n        d_eps_p_xx = 0.0\n        d_eps_p_yy = 0.0\n        d_eps_p_zz = 0.0\n        p_final = p_tr\n        q_final = q_tr\n    else:\n        # Plastic step\n        # Step 3: Compute plastic multiplier lambda\n        denominator = 3.0 * G + H_iso + H_kin + eta * K * beta\n        if abs(denominator)  1e-12:\n            # Avoid division by zero in case of perfect plasticity or softening models\n            # This case is not expected with the given parameters\n            raise ValueError(\"Denominator for lambda is zero or near-zero.\")\n        \n        plastic_multiplier = f_tr / denominator\n\n        # Step 4: Update stress invariants\n        p_final = p_tr - K * beta * plastic_multiplier\n        q_final = q_tr - 3.0 * G * plastic_multiplier\n        \n        # In case of numerical noise, ensure q is non-negative\n        q_final = max(0.0, q_final)\n\n        # Step 5: Compute plastic strain increment components\n        # A small tolerance to avoid division by zero if q_tr is very small\n        q_tr_safe = q_tr if q_tr > 1e-12 else 1e-12\n        \n        common_factor = 3.0 * G / q_tr_safe\n        beta_term = beta / 3.0\n\n        d_eps_p_xx = plastic_multiplier * (common_factor * deps_dev_xx - beta_term)\n        d_eps_p_yy = plastic_multiplier * (common_factor * deps_dev_yy - beta_term)\n        d_eps_p_zz = plastic_multiplier * (common_factor * deps_dev_zz - beta_term)\n\n    return [d_eps_p_xx, d_eps_p_yy, d_eps_p_zz, p_final, q_final]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3536010"}]}