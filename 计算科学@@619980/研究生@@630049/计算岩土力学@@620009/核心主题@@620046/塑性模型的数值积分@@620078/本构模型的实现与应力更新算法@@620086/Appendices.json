{"hands_on_practices": [{"introduction": "本练习以其最简单的形式介绍了返回映射算法：施加一个拉伸截断（tension cut-off）。对于像土壤这样不能承受拉力的材料，我们将任何“试探”拉应力投影回允许的、非受拉的区域。通过谱分解，直接对主应力进行操作，可以优雅地实现这一目标 [@problem_id:3531831]。", "problem": "为土体实现一个带有拉伸截断的小应变应力更新，以防止在卸载（例如，开挖）过程中出现虚假的拉伸应力。使用以下假设和要求来推导和实现该算法。\n\n假设与基本原理：\n- 采用标准的小应变运动学，包含对称应变张量 $\\boldsymbol{\\varepsilon}$ 和柯西应力张量 $\\boldsymbol{\\sigma}$。\n- 弹性预测步使用各向同性线弹性，其杨氏模量为 $E$，泊松比为 $\\nu$。弹性刚度由拉梅参数 $\\lambda$ 和 $\\mu$ 定义，其中 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 且 $\\mu = \\dfrac{E}{2(1+\\nu)}$，并且 $\\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$，此处 $\\mathbf{I}$ 是二阶单位张量，$\\text{tr}(\\cdot)$ 是迹。\n- 采用拉应力为正、压应力为负的符号约定。\n- 将土体模型化为无抗拉能力材料：在增量步结束时，更新后的应力必须位于容许集 $\\mathcal{K}$ 内，该集合由所有主应力均为非正（即张量为负半定）的要求定义。\n\n任务：\n- 给定前一时间步的应力状态 $\\boldsymbol{\\sigma}_n$ 和一个规定的应变增量 $\\Delta \\boldsymbol{\\varepsilon}$，计算弹性试探应力\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathbb{C}$ 是由 $E$ 和 $\\nu$ 决定的四阶各向同性弹性张量。\n- 通过将 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 返回（投影）到容许集 $\\mathcal{K}$ 来施加拉伸截断，该投影方式需与能量最小化一致且不产生拉伸主应力。将返回过程表述为弗罗贝尼乌斯范数下的最近点投影：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2.\n$$\n- 计算 $\\boldsymbol{\\sigma}_{n+1}$ 的三个主应力，并按降序排列。\n\n物理和数值单位：\n- 所有应力必须以千帕（kPa）为单位报告。\n- 此问题不涉及角度。\n- 最终答案以浮点数形式表示，单位为 kPa，保留三位小数。\n\n测试组：\n在所有情况下，使用 $E = 50\\,\\text{MPa}$ 和 $\\nu = 0.3$。对于各向同性状态，使用单位张量 $\\mathbf{I}$；对于剪切，使用标准小应变关系，其中工程剪应变 $\\gamma$ 对应于 $\\varepsilon_{12} = \\varepsilon_{21} = \\gamma/2$。\n\n定义以下四个测试用例，每个由 $(\\boldsymbol{\\sigma}_n, \\Delta \\boldsymbol{\\varepsilon})$ 指定：\n\n- 测试用例 1（压缩加载，弹性容许）：\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$。\n\n- 测试用例 2（开挖型卸载至受拉，需要截断）：\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$。\n\n- 测试用例 3（从零应力开始的纯剪切，混合主应力状态，需要截断）：\n  - $\\boldsymbol{\\sigma}_n = \\mathbf{0}$，\n  - 在 $1$-$2$ 平面内的工程剪应变 $\\gamma = 10^{-4}$，即 $\\Delta \\boldsymbol{\\varepsilon}_{12} = \\Delta \\boldsymbol{\\varepsilon}_{21} = \\gamma/2$，其他分量为零。\n\n- 测试用例 4（临界截断面的边界情况）：\n  - $\\boldsymbol{\\sigma}_n = -50\\,\\text{kPa}\\,\\mathbf{I}$，\n  - $\\Delta \\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个长度为 4 的列表（每个测试用例一项）。\n- 每个条目是一个包含 $\\boldsymbol{\\sigma}_{n+1}$ 的三个主应力的列表，单位为 kPa，保留三位小数并按降序排列。\n- 确切格式为单行，类似于\n  $$\n  [ [s_{1,1}, s_{1,2}, s_{1,3}], [s_{2,1}, s_{2,2}, s_{2,3}], [s_{3,1}, s_{3,2}, s_{3,3}], [s_{4,1}, s_{4,2}, s_{4,3}] ]\n  $$\n  以 Python 列表字面量的形式打印，不含任何额外文本。", "solution": "该问题要求为一种受拉伸截断条件约束的各向同性线弹性材料实现应力更新算法。这是计算塑性力学中的一个经典问题，特别是针对 Rankine 或无抗拉材料模型，该模型常用于模拟拉伸强度可忽略不计的岩土材料（如土壤或岩石）。解决方案将基于返回映射算法进行推导和实现，该算法通过在应力空间中的最近点投影来强制执行本构约束。拉应力规定为正值。\n\n**1. 本构框架**\n\n材料行为由两个部分描述：\n-   **弹性**：由各向同性线弹性控制。应力张量 $\\boldsymbol{\\sigma}$ 与应变张量 $\\boldsymbol{\\varepsilon}$ 通过胡克定律相关联，该定律可用拉梅参数 $\\lambda$ 和 $\\mu$ 写出：\n    $$\n    \\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}\n    $$\n    其中 $\\mathbf{I}$ 是二阶单位张量。材料参数 $E=50\\,\\text{MPa} = 50000\\,\\text{kPa}$ 和 $\\nu=0.3$ 给出：\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)} = \\frac{50000\\,\\text{kPa}}{2(1+0.3)} = \\frac{25000}{1.3} = \\frac{250000}{13}\\,\\text{kPa} \\approx 19230.769\\,\\text{kPa}\n    $$\n    $$\n    \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\frac{50000\\,\\text{kPa} \\cdot 0.3}{(1+0.3)(1-2 \\cdot 0.3)} = \\frac{15000}{1.3 \\cdot 0.4} = \\frac{15000}{0.52} = \\frac{375000}{13}\\,\\text{kPa} \\approx 28846.154\\,\\text{kPa}\n    $$\n\n-   **拉伸截断**：材料不能承受拉伸应力。这被表述为对更新后的应力张量 $\\boldsymbol{\\sigma}_{n+1}$ 的一个约束。其主应力，记为 $\\sigma_1, \\sigma_2, \\sigma_3$，必须全部为非正值。这定义了容许应力集 $\\mathcal{K}$：\n    $$\n    \\mathcal{K} = \\{ \\boldsymbol{\\sigma} \\in \\mathbb{S}^3 \\, | \\, \\sigma_i(\\boldsymbol{\\sigma}) \\le 0, \\forall i=1,2,3 \\}\n    $$\n    其中 $\\mathbb{S}^3$ 是三维对称二阶张量空间。\n\n**2. 返回映射算法**\n\n应力更新分两步执行：弹性预测步和塑性修正步（返回映射）。\n\n-   **弹性预测步**：给定增量开始时的应力状态 $\\boldsymbol{\\sigma}_n$ 和应变增量 $\\Delta\\boldsymbol{\\varepsilon}$，我们首先计算一个弹性试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$。此步骤假设材料在该增量内的响应是纯弹性的：\n    $$\n    \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}_n + \\lambda \\, \\text{tr}(\\Delta \\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\Delta \\boldsymbol{\\varepsilon}\n    $$\n\n-   **塑性修正步**：如果 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 违反了拉伸截断条件（即 $\\boldsymbol{\\sigma}^{\\text{tr}} \\notin \\mathcal{K}$），它必须被“返回”或“投影”到容许集 $\\mathcal{K}$ 上。问题规定此投影为在弗罗贝尼乌斯范数下最小化距离的投影，这是一个确保能量一致性的标准选择：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2\n    $$\n    这是将 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 到凸集 $\\mathcal{K}$ 上的最近点投影。\n\n**3. 谱分解投影**\n\n解决这个最小化问题的关键在于谱分解。弗罗贝尼乌斯范数和容许性条件都是应力张量的各向同性函数，意味着它们只依赖于其主值（特征值），而不依赖于其主方向（特征向量）。因此，投影后的应力 $\\boldsymbol{\\sigma}_{n+1}$ 与试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 具有相同的主方向。\n\n设试探应力的谱分解为：\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\sum_{i=1}^3 \\sigma_i^{\\text{tr}} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n其中 $\\sigma_i^{\\text{tr}}$ 是 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力，$\\mathbf{n}_i$ 是对应的标准正交主方向。更新后的应力 $\\boldsymbol{\\sigma}_{n+1}$ 具有以下形式：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\sum_{i=1}^3 \\sigma_{i, n+1} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\n最优化问题解耦为三个关于主应力的独立一维问题：\n$$\n\\sigma_{i, n+1} = \\operatorname*{arg\\,min}_{\\sigma_i \\le 0} (\\sigma_i - \\sigma_i^{\\text{tr}})^2 \\quad \\text{for } i=1,2,3\n$$\n其解是一个到非正实数轴上的简单投影：\n-   若 $\\sigma_i^{\\text{tr}} \\le 0$，则试探值已在容许域内，因此 $\\sigma_{i, n+1} = \\sigma_i^{\\text{tr}}$。\n-   若 $\\sigma_i^{\\text{tr}} > 0$，则试探值不在容许域内，最近的容许点是 $0$，因此 $\\sigma_{i, n+1} = 0$。\n\n这可以紧凑地表示为：\n$$\n\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)\n$$\n\n**算法摘要：**\n1.  对于每个测试用例，给定 $\\boldsymbol{\\sigma}_n$ 和 $\\Delta\\boldsymbol{\\varepsilon}$，计算试探应力张量 $\\boldsymbol{\\sigma}^{\\text{tr}}$。\n2.  计算 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力（特征值），记为 $\\{\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}\\}$。\n3.  对每个主试探应力应用拉伸截断：$\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)$。\n4.  集合 $\\{\\sigma_{1, n+1}, \\sigma_{2, n+1}, \\sigma_{3, n+1}\\}$ 构成了最终更新应力 $\\boldsymbol{\\sigma}_{n+1}$ 的主应力。\n5.  将这些最终主应力按降序排列，并四舍五入到三位小数。\n\n**测试用例计算：**\n\n**用例 1：** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = -3 \\times 10^{-4}$。应力增量是各向同性的：$\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (-3 \\times 10^{-4}) + 2\\mu \\cdot (-10^{-4}))\\mathbf{I} = -12.5\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} - 12.5\\,\\mathbf{I} = -112.5\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力是 $\\{-112.5, -112.5, -112.5\\}$。所有主应力均 $\\le 0$，因此无需投影。\n最终主应力，降序排列：$[-112.500, -112.500, -112.500]$。\n\n**用例 2：** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 9 \\times 10^{-3}$。应力增量是 $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (9 \\times 10^{-3}) + 2\\mu \\cdot (3 \\times 10^{-3}))\\mathbf{I} = 375\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} + 375\\,\\mathbf{I} = 275\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力是 $\\{275, 275, 275\\}$。所有主应力均 $> 0$。\n投影后的主应力：$\\{\\min(275, 0), \\min(275, 0), \\min(275, 0)\\} = \\{0, 0, 0\\}$。\n最终主应力，降序排列：$[0.000, 0.000, 0.000]$。\n\n**用例 3：** $\\boldsymbol{\\sigma}_n = \\mathbf{0}$，纯剪切 $\\gamma=10^{-4}$\n$\\Delta\\varepsilon_{12} = \\Delta\\varepsilon_{21} = 0.5 \\times 10^{-4}$，其他分量为零。$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})=0$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = 2\\mu\\Delta\\boldsymbol{\\varepsilon}$。唯一非零分量是 $\\sigma^{\\text{tr}}_{12} = \\sigma^{\\text{tr}}_{21} = 2\\mu \\Delta\\varepsilon_{12} = \\mu \\gamma = \\frac{250000}{13} \\cdot 10^{-4} = \\frac{25}{13} \\approx 1.923\\,\\text{kPa}$。\n此纯剪切状态的主应力是 $\\{ \\sigma^{\\text{tr}}_{12}, 0, -\\sigma^{\\text{tr}}_{12} \\} = \\{25/13, 0, -25/13\\}$。\n投影后的主应力：$\\{\\min(25/13, 0), \\min(0, 0), \\min(-25/13, 0)\\} = \\{0, 0, -25/13\\}$。\n最终主应力，降序排列：$[0.000, 0.000, -1.923]$。\n\n**用例 4：** $\\boldsymbol{\\sigma}_n = -50\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 12 \\times 10^{-4}$。应力增量是 $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (12 \\times 10^{-4}) + 2\\mu \\cdot (4 \\times 10^{-4}))\\mathbf{I} = 50\\,\\mathbf{I}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -50\\,\\mathbf{I} + 50\\,\\mathbf{I} = \\mathbf{0}\\,\\text{kPa}$。\n$\\boldsymbol{\\sigma}^{\\text{tr}}$ 的主应力是 $\\{0, 0, 0\\}$。所有主应力均 $\\le 0$。无需投影。\n最终主应力，降序排列：$[0.000, 0.000, 0.000]$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the updated stress state for a no-tension material model\n    using a return mapping algorithm based on spectral decomposition.\n    \"\"\"\n\n    # Material parameters\n    E_kPa = 50000.0  # Young's modulus in kPa\n    nu = 0.3         # Poisson's ratio\n\n    # Lamé parameters\n    mu = E_kPa / (2 * (1 + nu))\n    lambda_ = E_kPa * nu / ((1 + nu) * (1 - 2 * nu))\n\n    # Identity tensor\n    I = np.identity(3)\n\n    # Test cases definition\n    test_cases = [\n        {\n            \"sigma_n\": -100.0 * I,\n            \"delta_eps\": -1e-4 * I,\n        },\n        {\n            \"sigma_n\": -100.0 * I,\n            \"delta_eps\": 3e-3 * I,\n        },\n        {\n            \"sigma_n\": np.zeros((3, 3)),\n            \"delta_eps\": np.array([[0, 0.5e-4, 0], [0.5e-4, 0, 0], [0, 0, 0]]),\n        },\n        {\n            \"sigma_n\": -50.0 * I,\n            \"delta_eps\": 4e-4 * I,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_n = case[\"sigma_n\"]\n        delta_eps = case[\"delta_eps\"]\n\n        # 1. Elastic Predictor: Compute trial stress\n        tr_delta_eps = np.trace(delta_eps)\n        delta_sigma = lambda_ * tr_delta_eps * I + 2 * mu * delta_eps\n        sigma_tr = sigma_n + delta_sigma\n\n        # 2. Spectral Decomposition: Compute principal trial stresses (eigenvalues)\n        # Using eigvalsh for symmetric matrices\n        principal_stresses_tr = np.linalg.eigvalsh(sigma_tr)\n\n        # 3. Plastic Corrector: Apply tension cut-off (projection)\n        principal_stresses_n1 = np.minimum(principal_stresses_tr, 0.0)\n\n        # 4. Sort principal stresses in descending order\n        sorted_principal_stresses = np.sort(principal_stresses_n1)[::-1]\n        \n        # 5. Round results for output\n        # Handle -0.0 by adding 0.0\n        rounded_stresses = [round(s, 3) + 0.0 for s in sorted_principal_stresses]\n        results.append(rounded_stresses)\n\n    # Print the final result in the specified format\n    print(results)\n\nsolve()\n```", "id": "3531831"}, {"introduction": "本练习在预测-校正概念的基础上，探讨了经典的冯·米塞斯（von Mises, $J_2$）塑性模型。您将实现“径向返回”算法，这是计算塑性力学的基石，用于更新随塑性变形而硬化的材料的应力。核心任务是计算塑性乘子 $\\Delta\\lambda$，它量化了增量步内的塑性流动量 [@problem_id:3531837]。", "problem": "考虑一个不排水、各向同性、率无关材料的小应变单剪切问题，该材料采用基于偏应力第二不变量（通常称为 $J_2$ 塑性）并带有线性各向同性硬化的 von Mises 塑性模型进行建模。对于弹性响应，该材料遵循线性各向同性弹性规律，其剪切模量为 $G$，体积模量足够大，以至于在该增量步内体积应变可以忽略不计。该塑性模型采用相关联流动法则和硬化法则 $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$，其中 $\\sigma_y$ 是当前屈服应力，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是线性各向同性硬化模量，$\\kappa$ 是等效塑性应变。屈服函数定义为 $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa)$，其中 $\\boldsymbol{s}$ 是 Cauchy 应力的偏量部分，且 $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$。塑性流动方向为 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，并使用后向欧拉时间离散化处理塑性应变增量，因此 $\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\lambda\\, \\boldsymbol{n}_{n+1}$ 且 $\\kappa_{n+1} = \\kappa_n + \\sqrt{2/3}\\,\\Delta \\lambda$，其中 $\\Delta \\lambda \\ge 0$ 是塑性乘子。\n\n从状态 $n$ 到 $n+1$ 施加一个单一应变增量，其中只有工程剪切应变增量 $\\Delta \\gamma$ 非零，使得小应变张量增量满足 $\\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\Delta \\gamma/2$，且 $\\Delta \\boldsymbol{\\varepsilon}$ 的所有其他分量均为零。材料参数和初始条件如下：\n- 剪切模量 $G = 25$ MPa。\n- 初始屈服应力 $\\sigma_{y0} = 0.2$ MPa。\n- 线性各向同性硬化模量 $H = 5$ MPa。\n- 初始等效塑性应变 $\\kappa_n = 0$。\n- 初始应力 $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$ 和初始塑性应变 $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$。\n- 工程剪切应变增量 $\\Delta \\gamma = 0.03$。\n\n针对此单剪切增量步，使用后向欧拉积分实现径向回归应力更新。计算更新后的偏剪切应力分量 $s_{12,n+1}$（在纯剪切情况下，该值等于 Cauchy 剪切应力 $\\sigma_{12,n+1}$）和塑性乘子 $\\Delta \\lambda$。$s_{12,n+1}$ 以 MPa 为单位表示，$\\Delta \\lambda$ 为无量纲。将两个结果均四舍五入至五位有效数字。将最终数值以行矩阵 $\\begin{pmatrix} s_{12,n+1}  \\Delta \\lambda \\end{pmatrix}$ 的形式给出。", "solution": "求解过程涉及一个用于应力更新的标准预测-校正算法。首先，一个弹性预测步假设整个应变增量是弹性的，从而计算出一个试探应力。其次，根据屈服准则对该试探应力进行校核。如果表明发生了屈服，则应用一个塑性校正步，将应力状态返回到更新后的屈服面上。\n\n在增量步 $n$ 的初始状态由以下条件给出：\n初始应力：$\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$，这意味着偏应力也为零，$\\boldsymbol{s}_n = \\boldsymbol{0}$。\n初始等效塑性应变：$\\kappa_n = 0$。\n\n对于工程剪切应变增量 $\\Delta \\gamma = 0.03$ 的单剪切，施加的应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 由其非零分量给出：\n$$ \\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\frac{\\Delta \\gamma}{2} = \\frac{0.03}{2} = 0.015 $$\n由于应变增量张量的迹 $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}) = \\Delta\\varepsilon_{11} + \\Delta\\varepsilon_{22} + \\Delta\\varepsilon_{33} = 0$，该应变增量是纯偏量的。\n\n**第 1 步：弹性预测**\n\n在预测步中，假设整个应变增量是弹性的，因此 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$ 且 $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon}$。在增量步 $n+1$ 的试探偏应力，记为 $\\boldsymbol{s}^{\\text{trial}}_{n+1}$，使用弹性本构律计算：\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon}^e = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon} $$\n在 $\\boldsymbol{s}_n = \\boldsymbol{0}$ 和 $G=25$ MPa 的条件下：\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = 2(25 \\text{ MPa}) \\Delta\\boldsymbol{\\varepsilon} = 50 \\Delta\\boldsymbol{\\varepsilon} $$\n试探偏应力的仅有的非零分量是：\n$$ s^{\\text{trial}}_{12,n+1} = s^{\\text{trial}}_{21,n+1} = 50 \\times 0.015 = 0.75 \\text{ MPa} $$\n试探偏应力的范数计算为 $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{s_{ij}s_{ij}}$：\n$$ \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| = \\sqrt{(s^{\\text{trial}}_{12,n+1})^2 + (s^{\\text{trial}}_{21,n+1})^2} = \\sqrt{(0.75)^2 + (0.75)^2} = \\sqrt{2 \\times (0.75)^2} = 0.75\\sqrt{2} \\text{ MPa} $$\n数值上，$\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| \\approx 1.06066$ MPa。\n\n**第 2 步：屈服校核**\n\n我们校核该试探应力状态是否位于由屈服函数 $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa) \\le 0$ 定义的弹性域之外。校核使用增量步开始时的屈服应力 $\\sigma_y(\\kappa_n)$ 进行。\n硬化法则是 $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$。在 $\\kappa_n=0$，$\\sigma_{y0}=0.2$ MPa 和 $H=5$ MPa 的条件下：\n$$ \\sigma_y(\\kappa_n) = \\sigma_y(0) = \\sigma_{y0} = 0.2 \\text{ MPa} $$\n屈服函数的试探值为：\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_n) = 0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2) \\text{ MPa} $$\n数值上，$f^{\\text{trial}} \\approx 1.06066 - 0.81650 \\times 0.2 \\approx 1.06066 - 0.16330 = 0.89736$ MPa。\n由于 $f^{\\text{trial}} > 0$，弹性预测违反了屈服条件，需要进行塑性校正。\n\n**第 3 步：塑性校正（径向回归）**\n\n对于塑性加载，塑性乘子 $\\Delta \\lambda$ 必须大于零。对于后向欧拉积分方案，$\\Delta \\lambda$ 可从一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$ 求得。这导出了 $\\Delta \\lambda$ 的以下表达式：\n$$ \\Delta \\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\sigma_y(\\kappa_n)}{2G + \\frac{2}{3}H} $$\n代入给定值：\n$$ \\Delta \\lambda = \\frac{0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2)}{2(25) + \\frac{2}{3}(5)} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{50 + 10/3} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{160/3} $$\n数值上：\n$$ \\Delta \\lambda = \\frac{1.060660 - 0.163299}{53.333333} = \\frac{0.897361}{53.333333} = 0.0168255 $$\n四舍五入到五位有效数字，我们得到 $\\Delta \\lambda = 0.016826$。\n\n**第 4 步：应力更新**\n\n最终偏应力 $\\boldsymbol{s}_{n+1}$ 通过将试探应力径向返回到扩展后的屈服面来求得。回归映射方程为：\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\lambda \\boldsymbol{n}_{n+1} $$\n其中 $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}_{n+1}/\\|\\boldsymbol{s}_{n+1}\\|$。对于径向回归，最终应力的方向与试探应力的方向相同，因此 $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1}/\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$。\n分量 $s_{12,n+1}$ 为：\n$$ s_{12,n+1} = s^{\\text{trial}}_{12,n+1} - 2G\\Delta\\lambda \\frac{s^{\\text{trial}}_{12,n+1}}{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|} $$\n代入 $s^{\\text{trial}}_{12,n+1}$ 和 $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$ 的值：\n$$ s_{12,n+1} = 0.75 - 2(25)\\Delta\\lambda \\frac{0.75}{0.75\\sqrt{2}} = 0.75 - \\frac{50}{\\sqrt{2}}\\Delta\\lambda $$\n使用计算出的 $\\Delta\\lambda = 0.0168255...$ 值：\n$$ s_{12,n+1} = 0.75 - \\frac{50}{\\sqrt{2}}(0.0168255) = 0.75 - (35.355339)(0.0168255) = 0.75 - 0.594865 = 0.155135 \\text{ MPa} $$\n四舍五入到五位有效数字，我们得到 $s_{12,n+1} = 0.15513$ MPa。由于问题从零应力状态开始，且应变增量是纯偏量的，平均应力保持为零，所以 $\\sigma_{12,n+1} = s_{12,n+1}$。\n\n最终所求的值是 $s_{12,n+1}$ 和 $\\Delta \\lambda$。\n- $s_{12,n+1} = 0.15513$ MPa\n- $\\Delta \\lambda = 0.016826$\n我们按要求将它们以行矩阵形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.15513  0.016826 \\end{pmatrix}}\n$$", "id": "3531837"}, {"introduction": "本练习将重点从本构更新本身转移到其在更大规模模拟中的数值稳定性上。虽然前面的问题使用了无条件稳定的隐式方法，但许多代码使用更简单但有条件稳定的显式方法。本练习探讨了如何通过分析算法切线矩阵的特征值，来推导显式前向欧拉积分的最大稳定时间步长，从而将材料行为与计算约束直接联系起来 [@problem_id:3531860]。", "problem": "考虑一个砂土亚塑性模型，在恒定高应变率加载下的二维平面应变应力更新问题。设柯西应力矢量表示为 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^{\\mathsf{T}}$。该亚塑性模型规定了应力率的形式为 $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{h}(\\boldsymbol{\\sigma}, \\dot{\\boldsymbol{\\varepsilon}}, \\rho)$，其中 $\\dot{\\boldsymbol{\\varepsilon}}$ 是应变率张量，$\\rho$ 是密度。在快速单调加载情况下，若时间步内 $\\dot{\\boldsymbol{\\varepsilon}}$ 近似恒定且密度变化可忽略不计，则对当前状态 $(\\boldsymbol{\\sigma}_{n}, \\dot{\\boldsymbol{\\varepsilon}})$ 进行一阶线性化可得：\n$$\n\\dot{\\boldsymbol{\\sigma}} \\approx \\boldsymbol{A}\\,\\boldsymbol{\\sigma} + \\boldsymbol{c},\n$$\n其中 $\\boldsymbol{A} \\in \\mathbb{R}^{3 \\times 3}$ 是算法切线矩阵（即应力率函数在当前状态下对应力的雅可比矩阵），其元素的单位为 $\\mathrm{s}^{-1}$；$\\boldsymbol{c}$ 是一个取决于 $\\dot{\\boldsymbol{\\varepsilon}}$ 和当前状态的常数矢量。\n\n显式前向欧拉应力更新的实现方式如下：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n},\n$$\n其中时间步长 $\\Delta t > 0$ 为常数。为了评估在线性化齐次动力学（即忽略 $\\boldsymbol{c}$）下扰动增长的稳定性，请从线性化系统的齐次部分 $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}$ 出发，推导确保显式更新不会放大 $\\boldsymbol{\\sigma}$ 任何模态分量的 $\\Delta t$ 条件。\n\n对于平面应变条件下一个代表性的密实砂土亚塑性状态，其算法切线矩阵由下式给出：\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200  300  0 \\\\\n-500  -800  0 \\\\\n0  0  -1600\n\\end{pmatrix}\n\\quad \\text{元素的单位为 } \\mathrm{s}^{-1}。\n$$\n请仅使用线性系统显式时间积分的线性稳定性基本原理，确定应用于上述矩阵 $\\boldsymbol{A}$ 的前向欧拉应力更新的最大稳定时间步长 $\\Delta t_{\\max}$。您的推导应从显式更新映射和 $\\boldsymbol{A}$ 的特征结构出发，并应考虑到由非对称切线矩阵可能产生的复数特征值。\n\n报告 $\\Delta t_{\\max}$ 的最终值，四舍五入到四位有效数字，并以秒为单位表示。", "solution": "该问题要求确定一个线性化的亚塑性本构模型在使用前向欧拉方法进行应力更新时的最大稳定时间步长 $\\Delta t_{\\max}$。此分析基于常微分方程组(ODEs)数值积分的线性稳定性原理。\n\n为了进行稳定性分析，我们忽略常数项 $\\boldsymbol{c}$，此时应力状态的演化由以下齐次线性常微分方程组控制：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}\n$$\n我们使用显式前向欧拉法在时间步长 $\\Delta t$ 上对该系统进行积分。从时间 $t_n$ 的状态 $\\boldsymbol{\\sigma}_n$ 更新到时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $\\boldsymbol{\\sigma}_{n+1}$ 的规则如下：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n}\n$$\n代入控制常微分方程，我们得到：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t(\\boldsymbol{A}\\,\\boldsymbol{\\sigma}_{n}) = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\,\\boldsymbol{\\sigma}_{n}\n$$\n其中 $\\boldsymbol{I}$ 是 $3 \\times 3$ 的单位矩阵。矩阵 $\\boldsymbol{G} = \\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A}$ 被称为放大矩阵，因为它将解从一个时间步映射到下一个。\n\n为使数值格式稳定，任何初始扰动都不能在后续的时间步中被放大。这要求放大矩阵的谱半径 $\\rho(\\boldsymbol{G})$ 不大于1。谱半径是 $\\boldsymbol{G}$ 的所有特征值模的最大值：\n$$\n\\rho(\\boldsymbol{G}) = \\max_{k} |\\lambda_k(\\boldsymbol{G})| \\le 1\n$$\n设 $\\lambda_k$ 是矩阵 $\\boldsymbol{A}$ 的一个特征值，其对应的特征向量为 $\\boldsymbol{v}_k$。那么 $\\boldsymbol{A}\\boldsymbol{v}_k = \\lambda_k \\boldsymbol{v}_k$。矩阵 $\\boldsymbol{G}$ 作用于 $\\boldsymbol{v}_k$ 的结果为：\n$$\n\\boldsymbol{G}\\boldsymbol{v}_k = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\boldsymbol{v}_k = \\boldsymbol{v}_k + \\Delta t(\\boldsymbol{A}\\boldsymbol{v}_k) = \\boldsymbol{v}_k + \\Delta t(\\lambda_k \\boldsymbol{v}_k) = (1 + \\Delta t\\,\\lambda_k)\\boldsymbol{v}_k\n$$\n这表明 $\\boldsymbol{G}$ 的特征值与 $\\boldsymbol{A}$ 的特征值之间的关系为 $\\lambda_k(\\boldsymbol{G}) = 1 + \\Delta t\\,\\lambda_k$。因此，稳定性条件变为：\n$$\n|1 + \\Delta t\\,\\lambda_k| \\le 1 \\quad \\text{对 } \\boldsymbol{A} \\text{ 的所有特征值 } \\lambda_k\n$$\n这个不等式定义了前向欧拉法的稳定域。对于一个复数 $z = \\Delta t\\,\\lambda_k$，该区域是在复平面上以 $(-1, 0)$ 为中心、半径为 $1$ 的圆盘。我们必须找到最大的 $\\Delta t > 0$，使得对所有特征值 $\\lambda_k$，都有 $z_k = \\Delta t\\,\\lambda_k$ 位于该圆盘内。\n\n下一步是计算给定算法切线矩阵 $\\boldsymbol{A}$ 的特征值：\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200  300  0 \\\\\n-500  -800  0 \\\\\n0  0  -1600\n\\end{pmatrix}\n$$\n该矩阵是块对角的。一个特征值可以直接从右下角的 $1 \\times 1$ 块读出：\n$$\n\\lambda_1 = -1600 \\, \\mathrm{s}^{-1}\n$$\n另外两个特征值由左上角的 $2 \\times 2$ 块确定：\n$$\n\\boldsymbol{A}_{sub} =\n\\begin{pmatrix}\n-1200  300 \\\\\n-500  -800\n\\end{pmatrix}\n$$\n其特征方程为 $\\det(\\boldsymbol{A}_{sub} - \\lambda \\boldsymbol{I}) = 0$：\n$$\n(-1200 - \\lambda)(-800 - \\lambda) - (300)(-500) = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 960000 + 150000 = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 1110000 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{2000^2 - 4(1)(1110000)}}{2} = \\frac{-2000 \\pm \\sqrt{4000000 - 4440000}}{2}\n$$\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{-440000}}{2} = \\frac{-2000 \\pm 200i\\sqrt{11}}{2} = -1000 \\pm 100i\\sqrt{11} \\, \\mathrm{s}^{-1}\n$$\n现在我们将稳定性条件应用于每个特征值。\n\n对于实数特征值 $\\lambda_1 = -1600$：\n条件为 $|1 + \\Delta t(-1600)| \\le 1$，即 $|1 - 1600\\Delta t| \\le 1$。这等价于 $-1 \\le 1 - 1600\\Delta t \\le 1$。\n不等式的右边部分 $1 - 1600\\Delta t \\le 1$ 意味着 $-1600\\Delta t \\le 0$，这对于 $\\Delta t > 0$ 总是成立的。\n左边部分 $-1 \\le 1 - 1600\\Delta t$ 意味着 $-2 \\le -1600\\Delta t$，即 $2 \\ge 1600\\Delta t$。这给出了约束条件：\n$$\n\\Delta t \\le \\frac{2}{1600} = \\frac{1}{800} \\, \\mathrm{s}\n$$\n\n对于共轭复数对 $\\lambda_{2,3} = -1000 \\pm 100i\\sqrt{11}$：\n设 $\\lambda = x+iy$，其中 $x = -1000$，$y = \\pm 100\\sqrt{11}$。稳定性条件 $|1 + \\Delta t\\,\\lambda| \\le 1$ 变为 $|(1+\\Delta t\\,x) + i(\\Delta t\\,y)| \\le 1$。对模进行平方：\n$$\n(1+\\Delta t\\,x)^2 + (\\Delta t\\,y)^2 \\le 1\n$$\n$$\n1 + 2\\Delta t\\,x + (\\Delta t)^2 x^2 + (\\Delta t)^2 y^2 \\le 1\n$$\n$$\n2\\Delta t\\,x + (\\Delta t)^2 (x^2+y^2) \\le 0\n$$\n由于 $\\Delta t > 0$，我们可以用它来除不等式两边：\n$$\n2x + \\Delta t(x^2+y^2) \\le 0\n$$\n这给出了约束条件 $\\Delta t \\le \\frac{-2x}{x^2+y^2}$。我们计算 $x^2+y^2 = |\\lambda|^2$：\n$$\n|\\lambda|^2 = (-1000)^2 + (100\\sqrt{11})^2 = 1000000 + 10000 \\times 11 = 1110000\n$$\n对 $\\Delta t$ 的约束是：\n$$\n\\Delta t \\le \\frac{-2(-1000)}{1110000} = \\frac{2000}{1110000} = \\frac{2}{1110} = \\frac{1}{555} \\, \\mathrm{s}\n$$\n整体的最大稳定时间步长 $\\Delta t_{\\max}$ 必须同时满足所有特征值的条件。因此，$\\Delta t_{\\max}$ 是各个限制中的最小值：\n$$\n\\Delta t_{\\max} = \\min \\left(\\frac{1}{800}, \\frac{1}{555}\\right)\n$$\n为了比较这两个分数，我们比较它们的分母。由于 $800 > 555$，因此可得 $\\frac{1}{800}  \\frac{1}{555}$。最严格的条件是由纯实数特征值 $\\lambda_1$ 施加的。\n$$\n\\Delta t_{\\max} = \\frac{1}{800} \\, \\mathrm{s} = 0.00125 \\, \\mathrm{s}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} = 0.001250 \\, \\mathrm{s}\n$$", "answer": "$$\\boxed{0.001250}$$", "id": "3531860"}]}