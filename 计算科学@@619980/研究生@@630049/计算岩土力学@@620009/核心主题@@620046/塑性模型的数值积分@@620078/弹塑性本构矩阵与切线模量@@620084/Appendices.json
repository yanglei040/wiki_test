{"hands_on_practices": [{"introduction": "理解一致性切向模量的理论重要性是一回事，亲眼见证其在实践中的威力则是另一回事。本练习 [@problem_id:3522215] 将直接展示其强大之处。通过对比使用正确算法切线和使用简化弹性切线的牛顿求解器，你将亲眼观察到收敛速度的显著提升，从而巩固对这一概念为何对高效计算至关重要的理解。", "problem": "考虑一个具有线性各向同性硬化的一维、小应变、率无关弹塑性材料。设总应变为 $\\varepsilon$，应力为 $\\sigma$，弹性模量为 $E$（单位为 $\\mathrm{Pa}$），初始屈服应力为 $\\sigma_{y0}$（单位为 $\\mathrm{Pa}$），塑性模量为 $H$（单位为 $\\mathrm{Pa}$）。假设在拉伸状态下进行单调加载，因此塑性流动方向为正。该材料遵循应变增量分解和标准的小应变弹塑性理论，具有线性各向同性硬化、凸屈服函数、关联流动和 Kuhn–Tucker 条件。单个材料点承受给定的牵引力 $T$（单位为 $\\mathrm{Pa}$）；通过使用牛顿法求解标量方程 $R(\\varepsilon) = \\sigma(\\varepsilon) - T = 0$ 来获得 $\\varepsilon$ 以强制实现材料点的平衡。\n\n仅从率无关弹塑性、带线性各向同性硬化的凸屈服函数、关联流动和一致性条件的基本定义出发，推导应用于标量平衡方程 $R(\\varepsilon)=0$ 的牛顿法实现二次收敛所需的算法弹塑性切线模量 $D^{ep}$。然后，设计并实现一个基准测试来比较：\n- 一个在迭代中使用算法 $D^{ep}$（即一致切线模量）作为雅可比 $d\\sigma/d\\varepsilon$ 的牛顿求解器，\n- 与一个基于弹性预测-塑性修正且不使用一致切线的牛顿求解器，该求解器在整个迭代过程中（即使在屈服后）也使用弹性模量 $E$ 作为雅可比 $d\\sigma/d\\varepsilon$。\n\n您的程序必须：\n1. 基于标准的带线性各向同性硬化的回映算法概念，为所描述的材料点实现一个物理上可接受的应力-应变响应 $\\sigma(\\varepsilon)$，确保 $\\sigma(\\varepsilon)$ 在 $\\varepsilon$ 上是连续且分段可微的。\n2. 为标量方程 $R(\\varepsilon)=\\sigma(\\varepsilon)-T=0$ 实现两个牛顿求解器：\n   - 求解器 A：在塑性加载时使用算法弹塑性切线模量 $D^{ep}$ 作为雅可比 $d\\sigma/d\\varepsilon$，在弹性加载时使用弹性模量 $E$。\n   - 求解器 B：在所有迭代中仅使用弹性模量 $E$ 作为雅可比 $d\\sigma/d\\varepsilon$，即在塑性加载中不使用一致切线。\n3. 使用固定的残差容差 $10^{0}$ $\\mathrm{Pa}$，即当 $|R(\\varepsilon)| \\leq 10^{0}$ $\\mathrm{Pa}$ 时宣布收敛。使用最大牛顿迭代次数为 $1000$。\n4. 为每个测试用例计算并报告以下误差度量：\n   - 求解器 A 和求解器 B 直到收敛的牛顿迭代次数（均为整数）。\n   - 一个布尔值，指示求解器 A 和求解器 B 是否在迭代限制内实现收敛。\n   - 绝对应变误差 $|\\varepsilon_{\\text{num}} - \\varepsilon_{\\text{exact}}|$（无量纲），其中 $\\varepsilon_{\\text{exact}}$ 是通过强制执行从第一性原理推导出的弹性或塑性状态条件而解析获得的精确闭式解。\n   - 求解器 A 和求解器 B 终止时的最终残差 $|R(\\varepsilon)|$（单位为 $\\mathrm{Pa}$）。\n5. 使用以下测试套件，每个用例由 $(E,\\sigma_{y0},H,T)$ 定义，所有模量和牵引力的单位均为 $\\mathrm{Pa}$：\n   - 用例 1：$(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 300 \\times 10^6)$，一个弹性用例。\n   - 用例 2：$(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 400 \\times 10^6)$，位于弹塑性边界。\n   - 用例 3：$(200 \\times 10^9, 400 \\times 10^6, 10 \\times 10^9, 800 \\times 10^6)$，一个具有中等硬化的塑性用例。\n   - 用例 4：$(200 \\times 10^9, 400 \\times 10^6, 0.5 \\times 10^9, 800 \\times 10^6)$，一个具有弱硬化的塑性用例，强调了一致切线的必要性。\n   - 用例 5：$(200 \\times 10^9, 400 \\times 10^6, 100 \\times 10^9, 1200 \\times 10^6)$，一个具有强硬化、接近类弹性行为的塑性用例。\n6. 对所有测试用例使用初始猜测值 $\\varepsilon_0 = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例贡献一个形式为 $[\\text{itersA},\\text{itersB},\\text{convA},\\text{convB},\\text{errA},\\text{errB},\\text{resA},\\text{resB}]$ 的列表。\n因此，最终输出必须是五个此类列表的列表，每个测试用例一个，例如 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$。\n\n所有物理量均以指定单位作答：模量和应力以 $\\mathrm{Pa}$ 为单位，应变为无量纲。不涉及角度。所有布尔值必须是 Python 布尔值。所有浮点和整数输出必须是原始数值，不得四舍五入或带单位格式化。", "solution": "该问题被评估为有效。这是一个在计算塑性力学中提法得当、有科学依据的问题，为获得唯一解提供了所有必要的数据和条件。\n\n### 1. 基本本构关系\n该问题描述了一个具有线性各向同性硬化的一维、率无关弹塑性材料，在初始无应力状态下承受单调拉伸加载。其控制关系如下：\n\n- **应变分解**：总应变 $\\varepsilon$ 是弹性应变 $\\varepsilon^e$ 和塑性应变 $\\varepsilon^p$ 的和。\n  $$ \\varepsilon = \\varepsilon^e + \\varepsilon^p $$\n- **弹性定律**：应力 $\\sigma$ 通过胡克定律与弹性应变相关联，弹性模量为 $E$。\n  $$ \\sigma = E \\varepsilon^e $$\n- **屈服条件**：当应力达到当前屈服强度 $\\sigma_y$ 时，塑性流动开始。对于单调拉伸（$\\sigma \\ge 0$），屈服函数 $f$ 为：\n  $$ f(\\sigma, \\alpha) = \\sigma - \\sigma_y(\\alpha) \\le 0 $$\n- **线性各向同性硬化**：屈服强度 $\\sigma_y$ 随等效塑性应变 $\\alpha$ 线性演化，从初始屈服应力 $\\sigma_{y0}$ 开始，塑性模量为 $H$。\n  $$ \\sigma_y(\\alpha) = \\sigma_{y0} + H\\alpha $$\n- **流动法则和塑性应变**：对于此一维拉伸情况，关联流动法则简化为塑性应变率等于塑性乘子率，即 $\\dot{\\varepsilon}^p = \\dot{\\gamma}$。此外，等效塑性应变率为 $\\dot{\\alpha} = |\\dot{\\varepsilon}^p| = \\dot{\\varepsilon}^p$（因为 $\\dot{\\varepsilon}^p \\ge 0$）。从原始状态随时间积分，我们发现累积塑性应变等于等效塑性应变，即 $\\varepsilon^p = \\alpha$。\n  因此，屈服条件可以写成关于 $\\varepsilon^p$ 的形式：\n  $$ f = \\sigma - (\\sigma_{y0} + H\\varepsilon^p) \\le 0 $$\n\n### 2. 应力-应变关系 $\\sigma(\\varepsilon)$ 的推导\n对于从 $\\varepsilon=0$ 开始的单调拉伸加载下的给定总应变 $\\varepsilon$，我们可以确定应力 $\\sigma$。初始屈服应变为 $\\varepsilon_y = \\sigma_{y0}/E$。\n\n- **弹性区域** ($\\varepsilon \\le \\varepsilon_y$)：没有塑性变形发生 ($\\varepsilon^p=0$)。总应变完全是弹性的，$\\varepsilon = \\varepsilon^e$。\n  $$ \\sigma(\\varepsilon) = E\\varepsilon $$\n- **塑性区域** ($\\varepsilon > \\varepsilon_y$)：材料发生屈服。状态必须满足屈服条件，$\\sigma = \\sigma_y = \\sigma_{y0} + H\\varepsilon^p$。我们还有 $\\sigma = E\\varepsilon^e = E(\\varepsilon-\\varepsilon^p)$。将两个 $\\sigma$ 的表达式相等：\n  $$ E(\\varepsilon - \\varepsilon^p) = \\sigma_{y0} + H\\varepsilon^p $$\n  求解塑性应变 $\\varepsilon^p$：\n  $$ E\\varepsilon - \\sigma_{y0} = (E+H)\\varepsilon^p \\implies \\varepsilon^p = \\frac{E\\varepsilon - \\sigma_{y0}}{E+H} $$\n  将其代回弹性定律以求得 $\\sigma$ 与 $\\varepsilon$ 的关系：\n  $$ \\sigma(\\varepsilon) = E(\\varepsilon - \\varepsilon^p) = E\\left(\\varepsilon - \\frac{E\\varepsilon - \\sigma_{y0}}{E+H}\\right) = \\frac{E(E+H)\\varepsilon - E(E\\varepsilon - \\sigma_{y0})}{E+H} = \\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H} $$\n单调拉伸下完整、连续且分段可微的应力-应变关系 $\\sigma(\\varepsilon)$ 为：\n$$\n\\sigma(\\varepsilon) = \\begin{cases}\n    E\\varepsilon  \\text{如果 } \\varepsilon \\le \\sigma_{y0}/E \\\\\n    \\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H}  \\text{如果 } \\varepsilon > \\sigma_{y0}/E\n\\end{cases}\n$$\n\n### 3. 算法（一致）切线模量 $D^{ep}$ 的推导\n该问题要求使用牛顿法求解非线性平衡方程 $R(\\varepsilon) = \\sigma(\\varepsilon) - T = 0$。该方程的雅可比是 $R'(\\varepsilon) = d\\sigma/d\\varepsilon$。为了实现二次收敛，该雅可比必须是*一致切线模量*，即应力更新算法的精确导数。对于此一维率无关情况，这对应于上面推导的 $\\sigma(\\varepsilon)$ 函数的导数。\n\n- **弹性切线**：在弹性区域（$\\varepsilon \\le \\sigma_{y0}/E$）：\n  $$ D^e = \\frac{d}{d\\varepsilon}(E\\varepsilon) = E $$\n- **弹塑性切线**：在塑性区域（$\\varepsilon > \\sigma_{y0}/E$）：\n  $$ D^{ep} = \\frac{d}{d\\varepsilon}\\left(\\frac{EH\\varepsilon + E\\sigma_{y0}}{E+H}\\right) = \\frac{EH}{E+H} $$\n此 $D^{ep}$ 即为塑性加载的算法切线模量。\n\n### 4. 牛顿法和求解器实现\n用于找到满足 $R(\\varepsilon)=0$ 的 $\\varepsilon$ 的牛顿-拉夫逊迭代为：\n$$ \\varepsilon_{k+1} = \\varepsilon_{k} - \\frac{R(\\varepsilon_k)}{J_k} $$\n其中 $\\varepsilon_k$ 是第 $k$ 次迭代的应变，$R(\\varepsilon_k) = \\sigma(\\varepsilon_k) - T$ 是残差，$J_k$ 是雅可比。\n\n- **求解器 A（一致切线）**：使用真实的雅可比，从而实现二次收敛。\n  $$ J_k = \\frac{d\\sigma}{d\\varepsilon}\\bigg|_{\\varepsilon_k} = \\begin{cases} E  \\text{如果 } \\varepsilon_k \\le \\sigma_{y0}/E \\\\ \\frac{EH}{E+H}  \\text{如果 } \\varepsilon_k > \\sigma_{y0}/E \\end{cases} $$\n- **求解器 B（弹性切线）**：在所有迭代中都使用弹性模量 $E$ 作为雅可比。\n  $$ J_k = E $$\n  当材料处于塑性状态时，此雅可比是不正确的，收敛速度会降至线性。当一致切线 $D^{ep}$ 与弹性切线 $E$ 显著不同时（这发生在塑性模量 $H$ 值较低时），求解器 A 和 B 之间的性能差异最为明显。\n\n### 5. 精确解析解 $\\varepsilon_{\\text{exact}}$\n为了计算数值误差，我们推导满足 $\\sigma(\\varepsilon_{\\text{exact}}) = T$ 的精确解 $\\varepsilon_{\\text{exact}}$。\n\n- **如果 $T \\le \\sigma_{y0}$（弹性）**：\n  $$ E\\varepsilon_{\\text{exact}} = T \\implies \\varepsilon_{\\text{exact}} = \\frac{T}{E} $$\n- **如果 $T > \\sigma_{y0}$（塑性）**：\n  $$ \\frac{EH\\varepsilon_{\\text{exact}} + E\\sigma_{y0}}{E+H} = T \\implies EH\\varepsilon_{\\text{exact}} = T(E+H) - E\\sigma_{y0} $$\n  $$ \\varepsilon_{\\text{exact}} = \\frac{T(E+H) - E\\sigma_{y0}}{EH} = \\frac{T}{H} + \\frac{T}{E} - \\frac{\\sigma_{y0}}{H} $$\n  或者，使用应变分解 $\\varepsilon = \\varepsilon^e + \\varepsilon^p$：\n  $$ \\varepsilon^e = \\sigma/E = T/E $$\n  $$ \\sigma = T = \\sigma_{y0} + H\\varepsilon^p \\implies \\varepsilon^p = \\frac{T-\\sigma_{y0}}{H} $$\n  $$ \\varepsilon_{\\text{exact}} = \\varepsilon^e + \\varepsilon^p = \\frac{T}{E} + \\frac{T-\\sigma_{y0}}{H} $$\n  这两种塑性情况下的形式是相同的。该解析解提供了用于比较数值结果的基准。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the strain in a 1D elastoplastic material under a given traction,\n    comparing a Newton solver using the consistent tangent modulus with one\n    using only the elastic modulus as the Jacobian.\n    \"\"\"\n    \n    # Define the test suite as specified in the problem statement.\n    # Each case is a tuple: (E, sigma_y0, H, T) in Pa.\n    test_cases = [\n        (200e9, 400e6, 10e9, 300e6),    # Case 1: Elastic\n        (200e9, 400e6, 10e9, 400e6),    # Case 2: At yield boundary\n        (200e9, 400e6, 10e9, 800e6),    # Case 3: Plastic, moderate hardening\n        (200e9, 400e6, 0.5e9, 800e6),   # Case 4: Plastic, weak hardening\n        (200e9, 400e6, 100e9, 1200e6),  # Case 5: Plastic, strong hardening\n    ]\n\n    results = []\n\n    for E, sigma_y0, H, T in test_cases:\n        \n        # 1. Calculate the exact analytical solution for strain.\n        if T = sigma_y0:\n            # Elastic case\n            epsilon_exact = T / E\n        else:\n            # Plastic case: epsilon = elastic_strain + plastic_strain\n            # elastic_strain = T / E\n            # plastic_strain = (T - sigma_y0) / H\n            epsilon_exact = T / E + (T - sigma_y0) / H\n\n        # 2. Define the Newton solver.\n        def newton_solver(use_consistent_tangent):\n            \"\"\"\n            Performs Newton-Raphson iterations to solve R(e) = sigma(e) - T = 0.\n            \n            Args:\n                use_consistent_tangent (bool): If True, uses the algorithmic tangent\n                                               modulus (Solver A). If False, uses the\n                                               elastic modulus (Solver B).\n            Returns:\n                A tuple containing the final strain, number of iterations,\n                convergence status, and final residual.\n            \"\"\"\n            epsilon = 0.0\n            max_iter = 1000\n            tolerance = 1.0  # Pa, as specified\n            \n            def get_stress_and_tangent(current_epsilon):\n                \"\"\"\n                Computes stress and consistent tangent for a given total strain,\n                assuming monotonic loading from a virgin state.\n                \"\"\"\n                epsilon_yield = sigma_y0 / E\n                \n                # Check if the state is elastic or plastic\n                if current_epsilon = epsilon_yield:\n                    sigma = E * current_epsilon\n                    tangent = E\n                else:\n                    sigma = (E * H * current_epsilon + E * sigma_y0) / (E + H)\n                    tangent = (E * H) / (E + H)\n                return sigma, tangent\n\n            for i in range(max_iter):\n                sigma, tangent_consistent = get_stress_and_tangent(epsilon)\n                residual = sigma - T\n                \n                if abs(residual) = tolerance:\n                    return epsilon, i + 1, True, abs(residual)\n                \n                jacobian = tangent_consistent if use_consistent_tangent else E\n                \n                # Prevent division by zero, although not expected in these test cases\n                if abs(jacobian)  1e-12:\n                    break\n                    \n                delta_epsilon = -residual / jacobian\n                epsilon += delta_epsilon\n            \n            # If the loop completes without converging\n            final_sigma, _ = get_stress_and_tangent(epsilon)\n            final_residual = abs(final_sigma - T)\n            return epsilon, max_iter, False, final_residual\n\n        # 3. Run both solvers and collect metrics.\n        \n        # Solver A (Consistent Tangent)\n        eps_A, iters_A, conv_A, res_A = newton_solver(use_consistent_tangent=True)\n        err_A = abs(eps_A - epsilon_exact)\n\n        # Solver B (Elastic Tangent)\n        eps_B, iters_B, conv_B, res_B = newton_solver(use_consistent_tangent=False)\n        err_B = abs(eps_B - epsilon_exact)\n\n        # 4. Store the results for the current test case.\n        case_result = [iters_A, iters_B, conv_A, conv_B, err_A, err_B, res_A, res_B]\n        results.append(case_result)\n\n    # 5. Format and print the final output string.\n    # Using repr() to get an unambiguous string representation of the list of lists,\n    # then removing spaces to create a compact output as per the problem's implicit format.\n    final_output_str = repr(results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```", "id": "3522215"}, {"introduction": "在明确了其重要性之后，我们现在转向其规范的推导过程。本练习 [@problem_id:3522229] 要求你为广泛应用的 von Mises ($J_2$) 塑性模型推导一致性切向模量。核心任务是将四阶张量形式转换为有限元程序中实际使用的 $6 \\times 6$ Voigt 矩阵形式，这是一项连接连续介质力学理论与计算实践的关键技能。", "problem": "在有限元 (FE) 实现中，使用了一种小应变、各向同性、关联 von Mises（第二偏不变量，$J_{2}$）弹塑性材料，该材料具有线性各向同性硬化。弹性响应由体积模量 $K$ 和剪切模量 $G$ 定义，因此对于任何对称应变张量 $\\boldsymbol{\\epsilon}$，弹性应力为 $\\boldsymbol{\\sigma}^{e} = \\mathbb{C}^{e} : \\boldsymbol{\\epsilon}$，其中四阶弹性刚度为 $\\mathbb{C}^{e} = K\\,\\mathbf{I} \\otimes \\mathbf{I} + 2 G\\,\\mathbb{I}^{s}$。这里 $\\mathbf{I}$ 是二阶单位张量，$\\mathbb{I}^{s}$ 是对称四阶单位张量。屈服函数为 $f(\\boldsymbol{\\sigma},\\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y0} - H \\alpha$，其中 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\mathbf{I}$ 是偏应力，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是塑性模量，$\\alpha$ 是累积塑性应变。流动法则是关联的，$\\dot{\\boldsymbol{\\epsilon}}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，硬化定律为 $\\dot{\\alpha} = \\dot{\\lambda}$。\n\n在牛顿迭代中一个收敛的材料点上，假设处于塑性状态（$\\dot{\\lambda} \\ge 0$），并将单位偏应力方向表示为 $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$，塑性流动方向表示为 $\\boldsymbol{m} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}}\\,\\boldsymbol{n}$。算法一致性切线模量（四阶张量）定义为应力更新对应变增量的导数，与所选的材料速率一致，从而使内功率得以守恒，即 $\\dot{W} = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}}$。\n\n您的任务是，使用适用于有限元实现的六分量 Voigt 形式表示算法切线模量，对类应变向量使用工程剪切约定，并确保与所选材料时间速率的能量一致性。具体而言：\n\n1. 定义应变和应力的能量一致 Voigt 映射：\n   $$\\boldsymbol{\\epsilon}^{V} = \\begin{pmatrix}\\epsilon_{11} \\\\ \\epsilon_{22} \\\\ \\epsilon_{33} \\\\ 2\\,\\epsilon_{23} \\\\ 2\\,\\epsilon_{13} \\\\ 2\\,\\epsilon_{12}\\end{pmatrix}, \\qquad \\boldsymbol{\\sigma}^{V} = \\begin{pmatrix}\\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{13} \\\\ \\sigma_{12}\\end{pmatrix},$$\n   并验证 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\epsilon}}^{V}$。\n\n2. 从小应变运动学、各向同性弹性、关联流动法则以及 $J_{2}$ 模型的返回映射结构出发，推导塑性状态下的四阶算法切线，并证明其可以写为\n   $$\\mathbb{C}_{\\mathrm{alg}} = \\mathbb{C}^{e} - \\frac{4 G^{2}}{H + 3 G}\\,\\boldsymbol{m} \\otimes \\boldsymbol{m},$$\n   其中 $\\boldsymbol{m} = \\sqrt{\\frac{3}{2}}\\,\\boldsymbol{n}$。\n\n3. 使用能量一致映射和工程剪切约定，提供 $6 \\times 6$ Voigt 矩阵 $\\mathbf{C}_{\\mathrm{alg}}^{V}$，使得 $\\boldsymbol{\\sigma}^{V} = \\mathbf{C}_{\\mathrm{alg}}^{V}\\,\\boldsymbol{\\epsilon}^{V}$。将结果以闭合形式表示为弹性 Voigt 矩阵与一个由 $\\boldsymbol{m}$ 的类应力 Voigt 映射构建的秩一修正项之和，\n   $$\\boldsymbol{m}_{\\sigma}^{V} = \\begin{pmatrix}m_{11} \\\\ m_{22} \\\\ m_{33} \\\\ m_{23} \\\\ m_{13} \\\\ m_{12}\\end{pmatrix},$$\n   并确保该映射保持内功率 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\epsilon}}^{V}$。\n\n以 $K$、$G$、$H$ 和分量 $m_{ij}$ 表示 $\\mathbf{C}_{\\mathrm{alg}}^{V}$ 的单个闭合形式解析表达式作为最终答案。无需进行数值计算。", "solution": "该问题是有效的，因为它代表了计算塑性力学领域中一个标准且良态的推导过程。它具有科学依据，是客观的，并包含了推导 $J_2$-塑性模型所需的算法切线模量的所有必要信息。\n\n推导将分三个阶段进行：首先，验证指定的 Voigt 映射的能量一致性；其次，推导四阶算法切线张量 $\\mathbb{C}_{\\mathrm{alg}}$；第三，将此张量转换为其 $6 \\times 6$ Voigt 矩阵表示 $\\mathbf{C}_{\\mathrm{alg}}^{V}$。\n\n**1. 能量一致 Voigt 映射的验证**\n\n内功率，表示应力对应变率所做的功的速率，由双点积 $\\dot{W} = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}}$ 给出。对于对称应力 $\\boldsymbol{\\sigma}$ 和应变率 $\\dot{\\boldsymbol{\\epsilon}}$ 张量，此表达式展开为：\n$$\n\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\sigma_{ij} \\dot{\\epsilon}_{ij} = \\sigma_{11}\\dot{\\epsilon}_{11} + \\sigma_{22}\\dot{\\epsilon}_{22} + \\sigma_{33}\\dot{\\epsilon}_{33} + 2\\sigma_{12}\\dot{\\epsilon}_{12} + 2\\sigma_{13}\\dot{\\epsilon}_{13} + 2\\sigma_{23}\\dot{\\epsilon}_{23}\n$$\n问题定义的类应力和类应变 Voigt 向量如下：\n$$\n\\boldsymbol{\\sigma}^{V} = \\begin{pmatrix}\\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{13} \\\\ \\sigma_{12}\\end{pmatrix}, \\qquad \\dot{\\boldsymbol{\\epsilon}}^{V} = \\begin{pmatrix}\\dot{\\epsilon}_{11} \\\\ \\dot{\\epsilon}_{22} \\\\ \\dot{\\epsilon}_{33} \\\\ 2\\dot{\\epsilon}_{23} \\\\ 2\\dot{\\epsilon}_{13} \\\\ 2\\dot{\\epsilon}_{12}\\end{pmatrix}\n$$\n它们转置的点积为：\n$$\n(\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\epsilon}}^{V} = \\begin{pmatrix}\\sigma_{11}  \\sigma_{22}  \\sigma_{33}  \\sigma_{23}  \\sigma_{13}  \\sigma_{12}\\end{pmatrix} \\begin{pmatrix}\\dot{\\epsilon}_{11} \\\\ \\dot{\\epsilon}_{22} \\\\ \\dot{\\epsilon}_{33} \\\\ 2\\dot{\\epsilon}_{23} \\\\ 2\\dot{\\epsilon}_{13} \\\\ 2\\dot{\\epsilon}_{12}\\end{pmatrix}\n$$\n$$\n(\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\epsilon}}^{V} = \\sigma_{11}\\dot{\\epsilon}_{11} + \\sigma_{22}\\dot{\\epsilon}_{22} + \\sigma_{33}\\dot{\\epsilon}_{33} + \\sigma_{23}(2\\dot{\\epsilon}_{23}) + \\sigma_{13}(2\\dot{\\epsilon}_{13}) + \\sigma_{12}(2\\dot{\\epsilon}_{12})\n$$\n此表达式与基于张量的内功率相同。因此，条件 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\epsilon}} = (\\boldsymbol{\\sigma}^{V})^{\\mathsf{T}}\\dot{\\boldsymbol{\\epsilon}}^{V}$ 得到验证，确认了所选映射的能量一致性。这对于将本构张量正确转换为矩阵形式至关重要。\n\n**2. 四阶算法一致性切线张量的推导**\n\n算法切线模量是应力更新算法的精确线性化。对于具有线性硬化的 $J_2$-塑性模型，使用返回映射算法。我们考虑一个从 $t_n$ 到 $t_{n+1}$ 的离散时间步。为简单起见，省略下标 $n+1$。\n\n总应变 $\\boldsymbol{\\epsilon}$ 被加法分解为弹性和塑性部分：$\\boldsymbol{\\epsilon} = \\boldsymbol{\\epsilon}^e + \\boldsymbol{\\epsilon}^p$。应力由弹性定律给出：$\\boldsymbol{\\sigma} = \\mathbb{C}^e : \\boldsymbol{\\epsilon}^e$。\n该算法包括一个弹性试探步和一个塑性修正步。试探应力为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : (\\boldsymbol{\\epsilon} - \\boldsymbol{\\epsilon}_n^p)$。应力被分为其体积部分 $\\boldsymbol{p} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$ 和偏量部分 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\boldsymbol{p}$。\n弹性响应中，体积部分纯粹由体积模量 $K$ 决定，偏量部分纯粹由剪切模量 $G$ 决定。因此，$\\boldsymbol{p}^{\\mathrm{tr}} = K\\,\\mathrm{tr}(\\boldsymbol{\\epsilon} - \\boldsymbol{\\epsilon}_n^p)\\mathbf{I}$ 且 $\\boldsymbol{s}^{\\mathrm{tr}} = 2G\\,\\mathrm{dev}(\\boldsymbol{\\epsilon} - \\boldsymbol{\\epsilon}_n^p)$。塑性流动是纯偏量的，所以 $\\boldsymbol{p} = \\boldsymbol{p}^{\\mathrm{tr}}$。\n\n塑性修正仅影响偏应力。试探状态下的屈服条件是 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - (\\sigma_{y0} + H\\alpha_n)$，其中 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$。如果 $f^{\\mathrm{tr}}  0$，则发生塑性变形。通过在步末强制执行一致性条件 $f(\\boldsymbol{\\sigma}, \\alpha)=0$ 来找到塑性乘子增量 $\\Delta\\lambda$。\n偏应力通过以下方式返回到屈服面：\n$\\boldsymbol{s} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\Delta\\boldsymbol{\\epsilon}^p$。\n根据关联流动法则，$\\Delta\\boldsymbol{\\epsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\lambda\\,\\boldsymbol{m}$，其中 $\\boldsymbol{m} = \\sqrt{\\frac{3}{2}}\\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}$。对于径向返回，塑性流动的方向由试探状态决定，因此 $\\boldsymbol{m} = \\sqrt{\\frac{3}{2}}\\frac{\\boldsymbol{s}^{\\mathrm{tr}}}{\\|\\boldsymbol{s}^{\\mathrm{tr}}\\|} = \\frac{3}{2}\\frac{\\boldsymbol{s}^{\\mathrm{tr}}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}$。\n对该应力更新方程取等效应力度量，得到 $\\sigma_{\\mathrm{eq}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda$。\n更新后的屈服应力为 $\\sigma_y = \\sigma_{y0} + H\\alpha = \\sigma_{y0} + H(\\alpha_n + \\Delta\\lambda)$。\n一致性条件 $\\sigma_{\\mathrm{eq}} = \\sigma_y$ 得出：\n$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda = \\sigma_{y0} + H\\alpha_n + H\\Delta\\lambda$。\n求解 $\\Delta\\lambda$：$\\Delta\\lambda = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - (\\sigma_{y0} + H\\alpha_n)}{H+3G} = \\frac{f^{\\mathrm{tr}}}{H+3G}$。\n最终应力为 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - 2G\\Delta\\lambda\\,\\boldsymbol{m}$。\n算法切线模量为 $\\mathbb{C}_{\\mathrm{alg}} = \\frac{d\\boldsymbol{\\sigma}}{d\\boldsymbol{\\epsilon}}$。通过链式法则，$\\frac{d\\boldsymbol{\\sigma}}{d\\boldsymbol{\\epsilon}} = \\frac{d\\boldsymbol{\\sigma}}{d\\boldsymbol{\\sigma}^{\\mathrm{tr}}} : \\frac{d\\boldsymbol{\\sigma}^{\\mathrm{tr}}}{d\\boldsymbol{\\epsilon}}$。\n由于 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : (\\boldsymbol{\\epsilon} - \\boldsymbol{\\epsilon}_n^p)$，我们有 $d\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : d\\boldsymbol{\\epsilon}$。\n我们对应力更新方程关于 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 求导：\n$d\\boldsymbol{\\sigma} = d\\boldsymbol{\\sigma}^{\\mathrm{tr}} - 2G(d(\\Delta\\lambda)\\,\\boldsymbol{m} + \\Delta\\lambda\\,d\\boldsymbol{m})$。\n对于一致性切线，方向 $\\boldsymbol{m}$ 在刚刚完成的步骤的收敛状态下保持固定。这是算法切线的关键简化。因此，$d\\boldsymbol{m} = \\mathbf{0}$。\n$d\\boldsymbol{\\sigma} = d\\boldsymbol{\\sigma}^{\\mathrm{tr}} - 2G\\,d(\\Delta\\lambda)\\,\\boldsymbol{m}$。\n塑性乘子的微分为 $d(\\Delta\\lambda) = \\frac{df^{\\mathrm{tr}}}{H+3G} = \\frac{1}{H+3G} \\frac{\\partial f^{\\mathrm{tr}}}{\\partial \\boldsymbol{\\sigma}^{\\mathrm{tr}}} : d\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\frac{1}{H+3G}\\boldsymbol{m} : d\\boldsymbol{\\sigma}^{\\mathrm{tr}}$。\n将此代入 $d\\boldsymbol{\\sigma}$ 的表达式中：\n$d\\boldsymbol{\\sigma} = d\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\frac{2G}{H+3G}(\\boldsymbol{m}:d\\boldsymbol{\\sigma}^{\\mathrm{tr}})\\,\\boldsymbol{m} = \\left[ \\mathbb{I}^s - \\frac{2G}{H+3G}\\boldsymbol{m}\\otimes\\boldsymbol{m} \\right] : d\\boldsymbol{\\sigma}^{\\mathrm{tr}}$。\n这里，$\\mathbb{I}^s$ 是对称四阶单位张量。现在，我们将其与 $d\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}^e : d\\boldsymbol{\\epsilon}$ 复合：\n$\\mathbb{C}_{\\mathrm{alg}} = \\frac{d\\boldsymbol{\\sigma}}{d\\boldsymbol{\\epsilon}} = \\left[ \\mathbb{I}^s - \\frac{2G}{H+3G}\\boldsymbol{m}\\otimes\\boldsymbol{m} \\right] : \\mathbb{C}^e$。\n弹性刚度张量为 $\\mathbb{C}^e = K \\mathbf{I} \\otimes \\mathbf{I} + 2G \\mathbb{I}^s_d$，其中 $\\mathbb{I}^s_d = \\mathbb{I}^s - \\frac{1}{3}\\mathbf{I}\\otimes\\mathbf{I}$ 是四阶偏量投影算子。\n$\\mathbb{C}_{\\mathrm{alg}} = \\mathbb{C}^e - \\frac{2G}{H+3G}(\\boldsymbol{m}\\otimes\\boldsymbol{m}) : (K \\mathbf{I} \\otimes \\mathbf{I} + 2G \\mathbb{I}^s_d)$。\n由于 $\\boldsymbol{m}$ 是偏张量，$\\mathrm{tr}(\\boldsymbol{m})=0$，所以 $\\boldsymbol{m}:\\mathbf{I}=0$。这意味着 $(\\boldsymbol{m}\\otimes\\boldsymbol{m}):(\\mathbf{I}\\otimes\\mathbf{I}) = (\\boldsymbol{m}:\\mathbf{I})\\otimes(\\boldsymbol{m}:\\mathbf{I}) = 0$。\n此外，$(\\boldsymbol{m}\\otimes\\boldsymbol{m}):\\mathbb{I}^s_d$ 将张量 $\\boldsymbol{A}$ 映射到 $(\\boldsymbol{m}:\\mathrm{dev}(\\boldsymbol{A}))\\boldsymbol{m}$。由于 $\\boldsymbol{m}$ 是偏张量，这简化为 $(\\boldsymbol{m}:\\boldsymbol{A})\\boldsymbol{m}$，这意味着 $(\\boldsymbol{m}\\otimes\\boldsymbol{m}):\\mathbb{I}^s_d = \\boldsymbol{m}\\otimes\\boldsymbol{m}$。\n因此，表达式变为：\n$\\mathbb{C}_{\\mathrm{alg}} = \\mathbb{C}^e - \\frac{2G}{H+3G}(2G\\boldsymbol{m}\\otimes\\boldsymbol{m})$。\n这得出了期望的结果：\n$$\n\\mathbb{C}_{\\mathrm{alg}} = \\mathbb{C}^{e} - \\frac{4 G^{2}}{H + 3 G}\\,\\boldsymbol{m} \\otimes \\boldsymbol{m}\n$$\n\n**3. Voigt 矩阵表示**\n\n我们现在将四阶张量 $\\mathbb{C}_{\\mathrm{alg}}$ 转换为其 $6 \\times 6$ 矩阵形式 $\\mathbf{C}_{\\mathrm{alg}}^{V}$。Voigt 记法中的本构律为 $\\boldsymbol{\\sigma}^{V} = \\mathbf{C}_{\\mathrm{alg}}^{V} \\boldsymbol{\\epsilon}^{V}$。\n弹性部分 $\\mathbb{C}^e$ 映射到标准各向同性弹性矩阵 $\\mathbf{C}_e^V$。当 $\\lambda = K-\\frac{2}{3}G$ 时，它为：\n$$\n\\mathbf{C}_{e}^{V} =\n\\begin{pmatrix}\nK+\\frac{4}{3}G  K-\\frac{2}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K+\\frac{4}{3}G  K-\\frac{2}{3}G  0  0  0 \\\\\nK-\\frac{2}{3}G  K-\\frac{2}{3}G  K+\\frac{4}{3}G  0  0  0 \\\\\n0  0  0  G  0  0 \\\\\n0  0  0  0  G  0 \\\\\n0  0  0  0  0  G\n\\end{pmatrix}\n$$\n塑性修正项是一个秩一张量积 $\\boldsymbol{m}\\otimes\\boldsymbol{m}$。对于形式为 $\\mathbb{C} = \\boldsymbol{a} \\otimes \\boldsymbol{b}$ 的四阶张量，其中 $\\boldsymbol{a}$ 和 $\\boldsymbol{b}$ 是对称二阶张量，其对应变张量 $\\boldsymbol{\\epsilon}$ 的作用是 $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\epsilon} = (\\boldsymbol{b}:\\boldsymbol{\\epsilon})\\boldsymbol{a}$。\n使用能量一致 Voigt 映射，标量积变为 $\\boldsymbol{b}:\\boldsymbol{\\epsilon} = (\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\epsilon}^{V}$，其中 $\\boldsymbol{b}_{\\sigma}^{V}$ 是 $\\boldsymbol{b}$ 的类应力向量形式。\n得到的应力为 $\\boldsymbol{\\sigma} = [(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\epsilon}^{V}]\\boldsymbol{a}$。将 $\\boldsymbol{\\sigma}$ 转换为其类应力 Voigt 向量 $\\boldsymbol{\\sigma}^V$ 给出 $\\boldsymbol{\\sigma}^{V} = [(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}\\boldsymbol{\\epsilon}^{V}]\\boldsymbol{a}_{\\sigma}^{V}$。\n将其重新排列为矩阵-向量形式：$\\boldsymbol{\\sigma}^{V} = (\\boldsymbol{a}_{\\sigma}^{V}(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}})\\boldsymbol{\\epsilon}^{V}$。因此，$\\boldsymbol{a}\\otimes\\boldsymbol{b}$ 的 Voigt 矩阵是外积 $\\boldsymbol{a}_{\\sigma}^{V}(\\boldsymbol{b}_{\\sigma}^{V})^{\\mathsf{T}}$。\n\n对于塑性修正项，$\\boldsymbol{a}=\\boldsymbol{b}=\\boldsymbol{m}$。对应的 Voigt 矩阵是 $\\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}}$。\n向量 $\\boldsymbol{m}_{\\sigma}^{V}$ 给出为 $\\boldsymbol{m}_{\\sigma}^{V} = (m_{11}, m_{22}, m_{33}, m_{23}, m_{13}, m_{12})^{\\mathsf{T}}$。\n算法切线的完整 Voigt 表示是：\n$\\mathbf{C}_{\\mathrm{alg}}^{V} = \\mathbf{C}_{e}^{V} - \\frac{4G^2}{H+3G} \\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}}$。\n这是所需的闭合形式表达式。展开此式可得到完整的 $6 \\times 6$ 矩阵。设 $\\gamma' = \\frac{4G^2}{H+3G}$。矩阵 $(\\boldsymbol{m}_{\\sigma}^{V}(\\boldsymbol{m}_{\\sigma}^{V})^{\\mathsf{T}})_{IJ} = m_I m_J$，其中 $m_I$ 是 $\\boldsymbol{m}_{\\sigma}^{V}$ 的分量。最终矩阵是弹性矩阵与按 $\\gamma'$ 缩放的该秩一修正矩阵的负值之和。", "answer": "$$\n\\boxed{\n\\mathbf{C}_{\\mathrm{alg}}^{V} =\n\\begin{pmatrix}\nK+\\frac{4}{3}G   K-\\frac{2}{3}G   K-\\frac{2}{3}G   0   0   0 \\\\\nK-\\frac{2}{3}G   K+\\frac{4}{3}G   K-\\frac{2}{3}G   0   0   0 \\\\\nK-\\frac{2}{3}G   K-\\frac{2}{3}G   K+\\frac{4}{3}G   0   0   0 \\\\\n0   0   0   G   0   0 \\\\\n0   0   0   0   G   0 \\\\\n0   0   0   0   0   G\n\\end{pmatrix}\n- \\frac{4G^2}{H+3G}\n\\begin{pmatrix}\nm_{11}^2   m_{11}m_{22}   m_{11}m_{33}   m_{11}m_{23}   m_{11}m_{13}   m_{11}m_{12} \\\\\nm_{22}m_{11}   m_{22}^2   m_{22}m_{33}   m_{22}m_{23}   m_{22}m_{13}   m_{22}m_{12} \\\\\nm_{33}m_{11}   m_{33}m_{22}   m_{33}^2   m_{33}m_{23}   m_{33}m_{13}   m_{33}m_{12} \\\\\nm_{23}m_{11}   m_{23}m_{22}   m_{23}m_{33}   m_{23}^2   m_{23}m_{13}   m_{23}m_{12} \\\\\nm_{13}m_{11}   m_{13}m_{22}   m_{13}m_{33}   m_{13}m_{23}   m_{13}^2   m_{13}m_{12} \\\\\nm_{12}m_{11}   m_{12}m_{22}   m_{12}m_{33}   m_{12}m_{23}   m_{12}m_{13}   m_{12}^2\n\\end{pmatrix}\n}\n$$", "id": "3522229"}, {"introduction": "在岩土力学中，许多本构模型（如 Mohr-Coulomb 准则）的屈服面包含棱角，这带来了光滑模型（如 J2 塑性）所没有的复杂性。本问题 [@problem_id:3522274] 深入探讨了一致性切向在这些棱角（子午线）附近的行为。它要求你分析由此产生的数值问题，并评估用于稳健处理屈服面不同面之间切换的策略，这是构建可靠岩土力学仿真软件的关键考量。", "problem": "在采用 Mohr–Coulomb 准则建模的岩土材料小应变弹塑性理论中，一致（算法）弹塑性切线模量在 Newton–Raphson 解法中使用，以实现有限元法（FEM）平衡迭代的二次收敛。考虑一个各向同性弹性柔度，其体积模量为 $K$，剪切模量为 $G$；一个 Mohr–Coulomb 屈服函数，其在 Haigh–Westergaard 空间中是分段光滑的，在压缩子午线和拉伸子午线上有角点线；以及一个可能为非关联的塑性势，其剪胀角为 $\\psi$。应力由其不变量 $p$、$q$ 和 Lode 角 $\\theta \\in [-\\pi/6,\\pi/6]$ 描述，其中三轴压缩位于压缩子午线（$\\theta = -\\pi/6$），三轴拉伸位于拉伸子午线（$\\theta = +\\pi/6$）。假设在主应力空间中使用标准的返回映射算法，每次只有一个活动面，并且一致切线是通过返回映射对更新后应力的线性化构建的。\n\n根据具有分段光滑屈服面的率无关塑性理论的第一性原理，分析当应力路径从压缩子午线附近跨越到拉伸子午线附近（即跨越 $\\theta \\approx 0$）时，一致弹塑性切线会发生什么变化。然后，提出一个鲁棒且计算上一致的子午线切换准则，该准则可以在 Newton–Raphson 迭代中实现，以避免迭代抖动并保持在 $\\theta \\approx 0$ 附近的快速收敛性。选择最能同时捕捉一致切线跨子午线的正确行为和合理的切换准则的选项。\n\nA. 如果流动法则是关联的（即 $\\psi = \\phi$），则一致切线在压缩和拉伸子午线上保持相同。因此，不需要显式切换，可以选择任何子午线而不会影响收敛性。\n\nB. 一致切线是分段光滑的，并且通常在从压缩到拉伸的过渡中表现出跳跃，因为屈服和流动法线随活动面而变化。一个鲁棒的切换方法是使用试探 Lode 角 $\\theta^{\\mathrm{tr}}$ 的符号（或等效地，第三偏应力不变量 $J_3$ 的符号），并带有一个小的容差 $\\epsilon_\\theta  0$：如果 $\\theta^{\\mathrm{tr}}  -\\epsilon_\\theta$，选择压缩子午线；如果 $\\theta^{\\mathrm{tr}}  \\epsilon_\\theta$，选择拉伸子午线；对于 $|\\theta^{\\mathrm{tr}}| \\le \\epsilon_\\theta$ 的情况，选择产生较大塑性乘子增量的面，或将更新视为边返回。如果更新后的应力改变了 $\\theta$ 的符号，则用切换后的子午线重复该步骤以保持切线的一致性。\n\nC. 通过在过渡处取两个面法线的算术平均值，可以使一致切线在子午线上连续；一个合适的切换准则是根据迭代期间计算的体积塑性应变增量 $\\Delta \\varepsilon_{v}^{p}$ 的符号来选择子午线。\n\nD. 正确的切换准則是选择使彈性能量增量最小化的子午线，这保证了唯一且连续的一致切线，并在流动是关联的情况下退化为弹性刚度。\n\nE. 子午线应仅根据塑性修正后计算的 $J_3$ 的符号来选择；为了保持二次收敛，必须在 Newton 迭代期间禁用切换。一致切线不受此选择的影响，因为 $J_3$ 没有显式地出现在其定义中。", "solution": "## 问题验证\n\n### 第一步：提取已知条件\n- **模型：** 岩土材料的小应变弹塑性。\n- **本构 법칙：** Mohr–Coulomb 屈服准则。\n- **数值背景：** 在有限元法（FEM）平衡迭代中，使用一致（算法）弹塑性切线模量于 Newton–Raphson 方案中。\n- **弹性：** 各向同性，由体积模量 $K$ 和剪切模量 $G$ 定义。\n- **屈服面：** Mohr–Coulomb，在 Haigh–Westergaard 空间（$p, q, \\theta$）中被描述为分段光滑，角点线位于压缩子午线（$\\theta = -\\pi/6$）和拉伸子午线（$\\theta = +\\pi/6$）。\n- **流动法则：** 塑性势可能为非关联，由剪胀角 $\\psi$ 定义。\n- **应力不变量：** 平均应力 $p$、偏应力（von Mises 等效应力）$q$ 和 Lode 角 $\\theta \\in [-\\pi/6, \\pi/6]$。\n- **返回映射：** 假设在主应力空间中使用标准的返回映射算法，每次只考虑一个活动面。\n- **切线构建：** 一致切线由返回映射关于更新后应力的线性化构建。\n- **核心问题：** 问题要求分析当应力路径跨越 $\\theta \\approx 0$ 处的子午线时一致切线的行为，并确定一个鲁棒且计算上一致的子午线切换准则。\n\n### 第二步：使用提取的已知条件进行验证\n这是一个在计算岩土力学领域中高度专业化、定义明确的问题。\n\n- **科学基础（关键）：** 该问题牢固地植根于已建立的率无关塑性理论及其数值实现。所有概念——Mohr–Coulomb 准则、一致切线模量、返回映射、Haigh–Westergaard 坐标——都是高等固体力学和计算塑性学中的标准内容。与分段光滑屈服面（如 Mohr–Coulomb）相关的挑战是研究和实现的经典课题。\n- **定义明确：** 问题定义明确。它要求分析一个已知的数值现象（切线模量的不连续性）并评估处理它的准则。基于数值分析和塑性理论的原理，这有一个确定但复杂的答案。要求在选项中选择最佳描述的提问结构是标准的。\n- **客观性（关键）：** 问题陈述使用精确的技术语言表达，没有主观性或模糊性。在“从压缩子午线附近跨越到拉伸子午线附近（即，跨越 $\\theta \\approx 0$）”这一表述中，轻微的术语混淆已由括号内的“即，跨越 $\\theta \\approx 0$”澄清。这表明重点在于跨越屈服六边形两个面之间的中间子午线，而不是遍历整个 $\\theta$ 范围。\n\n### 第三步：结论与行动\n问题陈述是**有效的**。它解决了在对具有压力依赖性、非光滑屈服面的材料进行数值建模时一个真实而重要的问题。问题设定自洽、科学上合理且客观。我现在将进行求解。\n\n## 推导与选项分析\n\n### 基于原理的推导\n\n该问题涉及 Mohr–Coulomb 塑性模型的数值实现。在主应力空间（$\\sigma_1, \\sigma_2, \\sigma_3$）中，屈服面是一个不规则的六角锥体。在偏平面（$\\pi$-平面，对应恒定的平均应力 $p$）上，屈服面是一个六边形。这个六边形有角点。屈服函数 $f$ 和塑性势 $g$ 是分段定义的，六边形的六个面各自对应不同的函数形式。\n\n弹塑性步骤中的应力更新通常通过返回映射算法处理。首先，假设一个完全弹性的增量来计算试探应力：\n$$ \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbf{C}^{\\text{e}} : \\Delta\\boldsymbol{\\varepsilon} $$\n其中 $\\mathbf{C}^{\\text{e}}$ 是四阶弹性刚度张量，$\\boldsymbol{\\sigma}_n$ 是增量开始时的应力，$\\Delta\\boldsymbol{\\varepsilon}$ 是总应变增量。\n\n如果这个试探应力在弹性域之外，即 $f(\\boldsymbol{\\sigma}^{\\text{tr}})  0$，则必须将应力返回到屈服面上。对于单个活动面，更新后的应力 $\\boldsymbol{\\sigma}_{n+1}$ 由下式给出：\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\Delta\\gamma \\mathbf{C}^{\\text{e}} : \\mathbf{n}_g(\\boldsymbol{\\sigma}_{n+1}) $$\n其中 $\\Delta\\gamma$ 是塑性乘子（一个正标量），$\\mathbf{n}_g = \\partial g / \\partial \\boldsymbol{\\sigma}$ 是塑性流动方向，在最终应力状态下评估。塑性乘子由最终应力位于屈服面上的约束条件 $f(\\boldsymbol{\\sigma}_{n+1}) = 0$ 确定。\n\n一致（或算法）弹塑性切线模量是更新后应力 $\\boldsymbol{\\sigma}_{n+1}$ 相对于总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$（或等效地，总应变 $\\boldsymbol{\\varepsilon}_{n+1}$）的精确线性化：\n$$ \\mathbf{C}^{\\text{ep,alg}} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\boldsymbol{\\varepsilon}_{n+1}} $$\n$\\mathbf{C}^{\\text{ep,alg}}$ 的表达式取决于屈服函数 $\\mathbf{n}_f = \\partial f / \\partial \\boldsymbol{\\sigma}$ 和塑性势 $\\mathbf{n}_g = \\partial g / \\partial \\boldsymbol{\\sigma}$ 的梯度。\n\n问题聚焦于当应力状态跨越子午线（特别是在 $\\theta \\approx 0$ 附近）时发生的情况。Haigh–Westergaard 空间中的子午线对应于 Mohr–Coulomb 屈服锥体上的角点线。跨越这样一条线意味着从六边形的一个面切换到相邻的一个面。例如，应力排序可能从 $\\sigma_1  \\sigma_2  \\sigma_3$ 变为 $\\sigma_1  \\sigma_3  \\sigma_2$。由于 $f$ 和 $g$ 的数学表达式在这两种情况下是不同的，它们的梯度 $\\mathbf{n}_f$ 和 $\\mathbf{n}_g$ 也将不同。因为 $\\mathbf{C}^{\\text{ep,alg}}$ 是这些梯度的函数，所以当应力状态跨越角点线时，它会表现出不连续性（一个跳跃）。这是具有分段光滑屈服面的塑性模型的一个基本特征。\n\n为了在全局 Newton–Raphson 方案中实现鲁棒的二次收敛，返回映射算法必须一致地选择正确的面（或边/顶点）进行返回，这一点至关重要。一个糟糕的选择可能导致状态更新最终落在与假设不同的面上，从而引起状态更新与切线模量之间的不兼容，这反过来又可能导致“抖动”（在连续迭代中在不同面之间振荡）和二次收敛性的丧失。\n\n一个鲁棒的切换准则必须基于在迭代返回映射过程中固定的量。试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 是理想的候选者。返回映射执行到的屈服面区域由 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 的位置决定。具体来说，试探应力的 Lode 角 $\\theta^{\\text{tr}}$ 指示了 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 位于 $\\pi$-平面的哪个扇区。$\\theta^{\\text{tr}}$ 的符号（或等效地，第三偏应力不变量 $J_3^{\\text{tr}}$ 的符号，因为 $\\sin(3\\theta) \\propto -J_3$）被用来选择活动面。\n\n当 $\\theta^{\\text{tr}}$ 非常接近角点子午线（例如 $|\\theta^{\\text{tr}}| \\approx 0$）时，一个小的数值扰动可能会使其符号翻转。为了处理这种情况，通常会引入一个容差 $\\epsilon_\\theta  0$。如果 $|\\theta^{\\text{tr}}| \\le \\epsilon_\\theta$，则认为试探应力处于角点区域，此时应使用特殊程序，例如更复杂的边返回（其中塑性流动是两个相邻面法线的组合）或其他稳定的启发式方法。\n\n### 逐项分析\n\n**A. 如果流动法则是关联的（即 $\\psi = \\phi$），则一致切线在压缩和拉伸子午线上保持相同。因此，不需要显式切换，可以选择任何子午线而不会影响收敛性。**\n**不正确。** 这个陈述根本上是错误的。一致切线 $\\mathbf{C}^{\\text{ep,alg}}$ 取决于屈服面的法线 $\\mathbf{n}_f$。即使流动是关联的（$\\mathbf{n}_g \\propto \\mathbf{n}_f$），法向量 $\\mathbf{n}_f$ 本身在从一个面跨越角点到另一个面时也会不连续地变化。因此，切线模量不是相同的，并且会经历一个跳跃。一个显式且一致的切换准则是实现鲁棒收敛的必要条件。\n\n**B. 一致切线是分段光滑的，并且通常在从压缩到拉伸的过渡中表现出跳跃，因为屈服和流动法线随活动面而变化。一个鲁棒的切换方法是使用试探 Lode 角 $\\theta^{\\mathrm{tr}}$ 的符号（或等效地，第三偏应力不变量 $J_3$ 的符号），并带有一个小的容差 $\\epsilon_\\theta  0$：如果 $\\theta^{\\mathrm{tr}}  -\\epsilon_\\theta$，选择压缩子午线；如果 $\\theta^{\\mathrm{tr}}  \\epsilon_\\theta$，选择拉伸子午线；对于 $|\\theta^{\\mathrm{tr}}| \\le \\epsilon_\\theta$ 的情况，选择产生较大塑性乘子增量的面，或将更新视为边返回。如果更新后的应力改变了 $\\theta$ 的符号，则用切换后的子午线重复该步骤以保持切线的一致性。**\n**正确。** 这个选项准确地描述了其行为和最先进的数值策略。\n1. 它正确地指出，一致切线表现出跳跃，因为法线（$\\mathbf{n}_f, \\mathbf{n}_g$）在活动屈服面切换时会改变。\n2. 它正确地确定了一个基于试探应力 Lode 角 $\\theta^{\\text{tr}}$（或 $J_3^{\\text{tr}}$）的鲁棒切换准则，该准则在返回映射过程中是固定的。\n3. 它正确地建议使用一个容差 $\\epsilon_\\theta$ 并为角点区域采用特殊处理程序，如边返回，这是一种严谨的方法。\n4. 最后一句描述了一种可能（尽管复杂）的策略，用于在最终应力状态落入与试探状态不同的区域时强制实现完全的一致性。虽然存在其他策略，但这是一个有效的考虑。总的来说，这个选项呈现了最全面和正确的画面。（注意：对于 $\\theta \\approx 0$ 的情况，提及“压缩子午线”和“拉伸子午线”稍微不精确，但在相邻面之间切换的意图是明确的，并且所提出的机制对于该目的也是正确的）。\n\n**C. 通过在过渡处取两个面法线的算术平均值，可以使一致切线在子午线上连续；一个合适的切换准则是根据迭代期间计算的体积塑性应变增量 $\\Delta \\varepsilon_{v}^{p}$ 的符号来选择子午线。**\n**不正确。** 首先，对法线进行平均是一种修改本构模型本身的*平滑*技术。问题是关于分段光滑模型的。这种方法创建了一个近似，它没有解决原始模型的问题。其次，更关键的是，使用计算的结果（塑性应变增量 $\\Delta \\varepsilon_{v}^{p}$）来控制计算本身是循环论证。在选择返回映射的面并计算塑性乘子之前，无法知道 $\\Delta \\varepsilon_{v}^{p}$。这将导致一个不稳定的、迭代的决策过程，而这正是鲁棒准则试图避免的。\n\n**D. 正确的切换准則是选择使彈性能量增量最小化的子午线，这保证了唯一且连续的一致切线，并在流动是关联的情况下退化为弹性刚度。**\n**不正确。** 这个选项在几个方面都是错误的。面选择的准则不是基于最小化彈性能量增量。返回映射原理是最近点投影，但面的选择是由基于试探应力的空间运动学划分决定的。声称该准则“保证了唯一且连续的一致切线”是错误的；分段光滑模型的一致切线本质上是不连续的。声称切线在流动关联时“退化为弹性刚度”是荒谬的；弹塑性切线仅在弹性行为时等于弹性切线，而与是否关联无关。\n\n**E. 子午线应仅根据塑性修正后计算的 $J_3$ 的符号来选择；为了保持二次收敛，必须在 Newton 迭代期间禁用切换。一致切线不受此选择的影响，因为 $J_3$ 没有显式地出现在其定义中。**\n**不正确。** 这个选项包含多个错误。最严重的是建议基于塑性修正后计算的不变量（即基于 $\\boldsymbol{\\sigma}_{n+1}$）来选择子午线。如选项C的分析所述，这是导致数值振荡的根源，并破坏了鲁棒收敛性。声称应“禁用”切换是一种糟糕且过于简化的策略。最后，断言一致切线不受此选择的影响，因为“$J_3$ 没有显式地出现在其定义中”，这显然是错误的。子午线的选择决定了使用哪个面的法线（$\\mathbf{n}_f, \\mathbf{n}_g$）。这些法线是应力状态的函数，包括 Lode 角 $\\theta$，而 $\\theta$ 又是 $J_3$ 的函数。因此，切线直接受到这个选择的影响。", "answer": "$$\\boxed{B}$$", "id": "3522274"}]}