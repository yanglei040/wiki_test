{"hands_on_practices": [{"introduction": "真核生物的翻译起始是一个受严格调控的复杂过程，起始复合物在此过程中扫描mRNA以定位起始密码子。本练习将引导你基于随机过程的基本原理，构建一个翻译起始的动力学扫描模型。通过这个实践，你将学会如何量化“漏扫”和核糖体脱落等关键事件，从而理解上游开放阅读框（uORF）如何通过调节主蛋白质的翻译速率来发挥其重要的生物学功能。[@problem_id:3325094]", "problem": "信使核糖核酸 (mRNA) 由真核生物的 $43\\mathrm{S}$ 预起始复合物 (PIC) 翻译。该复合物在 $5^{\\prime}$ 端帽子处结合，并沿 $5^{\\prime}\\to 3^{\\prime}$ 方向扫描，以定位 AUG 起始密码子。假设以下经过充分检验的机制基础：(i) 扫描以恒定速度 $v$ (核苷酸/秒) 进行；(ii) 在局部 Kozak 上下文内识别 AUG 是一个无记忆 (泊松) 捕获过程，其速率与无量纲的 Kozak 强度 $s\\in[0,1]$ 成正比；(iii) 在扫描过程中，PIC 可能以恒定的风险率 $k_{\\text{off}}$ (每秒) 解离。这些假设意味着，在有限的识别窗口内未被捕获 (渗漏扫描) 的概率等于泊松过程的存活概率，而在 $5^{\\prime}$ 非翻译区上各站点之间的存活概率等于恒定风险率过程在相应扫描时间内的存活概率。\n\n考虑一个 mRNA，其上游有一个单一的上游开放阅读框 (uORF)，随后是主开放阅读框 (main ORF)。uAUG 位于帽子下游 $D$ 个核苷酸处，而主 AUG 位于 uAUG 下游额外的 $L$ 个核苷酸处。任何 AUG 周围的识别窗口宽度为 $w$ 个核苷酸。在 Kozak 强度为 $s$ 的 AUG 处的捕获率为 $k_{0}s$ (每秒)，其中 $k_{0}$ 是一个常数。PIC 以速率 $J_{0}$ (每秒) 加载到帽子上。假设 PIC 之间无相互作用 (无排队)，终止 uORF 后不发生重新起始，并且在 AUG 处的起始在捕获后是瞬时的。\n\n1. 从第一性原理出发，构建渗漏扫描概率 $p_{\\text{leak}}(s)$，将其表示为 Kozak 强度 $s$、识别窗口宽度 $w$、扫描速度 $v$ 和基础捕获率 $k_{0}$ 的函数。\n2. 使用您得到的 $p_{\\text{leak}}(s)$ 表达式以及扫描过程中的恒定风险率存活模型，推导在 uORF ($J_{\\mathrm{u}}$) 和主 ORF ($J_{\\mathrm{m}}$) 上的稳态起始率，将其表示为 $J_{0}$、$D$、$L$、$v$、$k_{\\text{off}}$、$k_{0}$、$w$ 以及各自的 Kozak 强度 $s_{\\mathrm{u}}$ 和 $s_{\\mathrm{m}}$ 的函数。\n3. 对参数集 $J_{0}=\\,$ $0.50$ $\\mathrm{s}^{-1}$，$v=\\,$ $10$ $\\mathrm{nt}\\cdot\\mathrm{s}^{-1}$，$w=\\,$ $12$ $\\mathrm{nt}$，$k_{0}=\\,$ $2.0$ $\\mathrm{s}^{-1}$，$k_{\\text{off}}=\\,$ $0.010$ $\\mathrm{s}^{-1}$，$D=\\,$ $60$ $\\mathrm{nt}$，$L=\\,$ $120$ $\\mathrm{nt}$，$s_{\\mathrm{u}}=\\,$ $0.60$ 和 $s_{\\mathrm{m}}=\\,$ $0.90$，数值计算 $J_{\\mathrm{u}}$ 和 $J_{\\mathrm{m}}$。\n\n以双元素行向量 $\\big(J_{\\mathrm{u}},\\,J_{\\mathrm{m}}\\big)$ 的形式报告这两个起始率，单位为 $\\mathrm{s}^{-1}$，并四舍五入到三位有效数字。", "solution": "问题陈述已经过验证，被认为是科学上合理的、问题定义良好的、客观的且自洽的。所提出的模型是真核翻译起始的标准简化表示，常用于计算系统生物学中。所有必要的参数和假设都已明确定义。\n\n### 第 1 部分：渗漏扫描概率 $p_{\\text{leak}}(s)$ 的推导\n\n问题将 AUG 密码子的识别定义为一个无记忆的泊松捕获过程。渗漏扫描概率 $p_{\\text{leak}}(s)$ 是指预起始复合物 (PIC) 扫描通过 AUG 周围的识别窗口而未被捕获的概率。这等同于 PIC 在窗口内停留期间，该泊松过程的存活概率。\n\n首先，我们确定 PIC 以恒定速度 $v$ 扫描宽度为 $w$ 的识别窗口所花费的时间 $\\Delta t$：\n$$ \\Delta t = \\frac{w}{v} $$\n捕获过程的速率为 $\\lambda$，由 $k_{0}s$ 给出，其中 $k_{0}$ 是基础捕获率常数，$s$ 是无量纲的 Kozak 强度。\n$$ \\lambda = k_{0}s $$\n对于一个速率恒为 $\\lambda$ 的泊松过程，在时间间隔 $\\Delta t$ 内观察到零个事件 (在此情况下为零次捕获事件) 的概率由下式给出：\n$$ P(N(\\Delta t)=0) = \\exp(-\\lambda \\Delta t) $$\n根据定义，这个概率就是渗漏扫描概率 $p_{\\text{leak}}(s)$。代入 $\\lambda$ 和 $\\Delta t$ 的表达式，我们得到：\n$$ p_{\\text{leak}}(s) = \\exp\\left(-k_{0}s \\frac{w}{v}\\right) $$\n该表达式给出了 PIC 未能在 AUG 密码子处起始的概率，作为 Kozak 强度 $s$ 和系统参数 $k_{0}$、$w$、$v$ 的函数。\n\n### 第 2 部分：稳态起始率 $J_{\\mathrm{u}}$ 和 $J_{\\mathrm{m}}$ 的推导\n\n我们将 PIC 沿 mRNA 的流动建模为一连串的随机事件。PIC 加载到 $5^{\\prime}$ 端帽子的速率是 $J_{0}$。\n\n**uORF 处的起始率 ($J_{\\mathrm{u}}$):**\n为了让一个 PIC 在上游 AUG (uAUG) 处起始，它必须首先成功地从 $5^{\\prime}$ 端帽子扫描到 uAUG，距离为 $D$ 个核苷酸，且不发生解离。所需时间为 $t_{D} = D/v$。解离是一个速率为 $k_{\\text{off}}$ 的恒定风险率过程。PIC 在此扫描段存活的概率为：\n$$ P_{\\text{surv}}(t_{D}) = \\exp(-k_{\\text{off}} t_{D}) = \\exp\\left(-\\frac{k_{\\text{off}} D}{v}\\right) $$\nPIC 到达 uAUG 识别窗口的速率是初始加载速率 $J_{0}$ 乘以该存活概率：\n$$ J_{\\text{arrive, u}} = J_{0} \\exp\\left(-\\frac{k_{\\text{off}} D}{v}\\right) $$\n到达后，PIC 以 $1 - p_{\\text{leak}}(s_{\\mathrm{u}})$ 的概率被捕获 (起始)，其中 $s_{\\mathrm{u}}$ 是 uAUG 的 Kozak 强度。在 uORF 处的稳态起始率 $J_{\\mathrm{u}}$ 是到达速率乘以捕获概率：\n$$ J_{\\mathrm{u}} = J_{\\text{arrive, u}} \\left(1 - p_{\\text{leak}}(s_{\\mathrm{u}})\\right) $$\n代入 $J_{\\text{arrive, u}}$ 和 $p_{\\text{leak}}(s_{\\mathrm{u}})$ 的表达式：\n$$ J_{\\mathrm{u}} = J_{0} \\exp\\left(-\\frac{k_{\\text{off}} D}{v}\\right) \\left[1 - \\exp\\left(-\\frac{k_{0} s_{\\mathrm{u}} w}{v}\\right)\\right] $$\n\n**主 ORF 处的起始率 ($J_{\\mathrm{m}}$):**\n为了让一个 PIC 在主 AUG (mAUG) 处起始，它必须首先经过 uAUG。这需要 PIC 到达 uAUG 然后发生渗漏扫描。PIC 渗漏过 uAUG 的速率是：\n$$ J_{\\text{leak, u}} = J_{\\text{arrive, u}} \\cdot p_{\\text{leak}}(s_{\\mathrm{u}}) = J_{0} \\exp\\left(-\\frac{k_{\\text{off}} D}{v}\\right) \\exp\\left(-\\frac{k_{0} s_{\\mathrm{u}} w}{v}\\right) $$\n这些 PIC 接下来必须扫描额外的距离 $L$ 以到达主 AUG。所需时间为 $t_{L} = L/v$，在该段扫描中不发生解离而存活的概率是：\n$$ P_{\\text{surv}}(t_{L}) = \\exp(-k_{\\text{off}} t_{L}) = \\exp\\left(-\\frac{k_{\\text{off}} L}{v}\\right) $$\nPIC 到达主 AUG 的速率是 uAUG 的渗漏速率乘以在距离 $L$ 上的存活概率：\n$$ J_{\\text{arrive, m}} = J_{\\text{leak, u}} \\cdot P_{\\text{surv}}(t_{L}) = J_{0} \\exp\\left(-\\frac{k_{\\text{off}} D}{v}\\right) \\exp\\left(-\\frac{k_{0} s_{\\mathrm{u}} w}{v}\\right) \\exp\\left(-\\frac{k_{\\text{off}} L}{v}\\right) $$\n合并指数项，到达主 AUG 的速率为：\n$$ J_{\\text{arrive, m}} = J_{0} \\exp\\left(-\\frac{k_{\\text{off}}(D+L) + k_{0} s_{\\mathrm{u}} w}{v}\\right) $$\n主 ORF 处的起始率 $J_{\\mathrm{m}}$ 是该到达速率乘以在主 AUG 处的捕获概率，主 AUG 的 Kozak 强度为 $s_{\\mathrm{m}}$：\n$$ J_{\\mathrm{m}} = J_{\\text{arrive, m}} \\left(1 - p_{\\text{leak}}(s_{\\mathrm{m}})\\right) $$\n代入 $J_{\\text{arrive, m}}$ 和 $p_{\\text{leak}}(s_{\\mathrm{m}})$ 的表达式，得到 $J_{\\mathrm{m}}$ 的最终表达式：\n$$ J_{\\mathrm{m}} = J_{0} \\exp\\left(-\\frac{k_{\\text{off}}(D+L) + k_{0} s_{\\mathrm{u}} w}{v}\\right) \\left[1 - \\exp\\left(-\\frac{k_{0} s_{\\mathrm{m}} w}{v}\\right)\\right] $$\n\n### 第 3 部分：数值计算\n\n我们有以下给定的参数值：\n$J_{0}=\\,$ $0.50$ $\\mathrm{s}^{-1}$\n$v=\\,$ $10$ $\\mathrm{nt}\\cdot\\mathrm{s}^{-1}$\n$w=\\,$ $12$ $\\mathrm{nt}$\n$k_{0}=\\,$ $2.0$ $\\mathrm{s}^{-1}$\n$k_{\\text{off}}=\\,$ $0.010$ $\\mathrm{s}^{-1}$\n$D=\\,$ $60$ $\\mathrm{nt}$\n$L=\\,$ $120$ $\\mathrm{nt}$\n$s_{\\mathrm{u}}=\\,$ $0.60$\n$s_{\\mathrm{m}}=\\,$ $0.90$\n\n首先，我们计算推导出的表达式中指数的值。\n对于 $J_{\\mathrm{u}}$：\n解离指数为 $-\\frac{k_{\\text{off}} D}{v} = -\\frac{0.010 \\times 60}{10} = -0.06$。\nuAUG 捕获指数为 $-\\frac{k_{0} s_{\\mathrm{u}} w}{v} = -\\frac{2.0 \\times 0.60 \\times 12}{10} = -1.44$。\n将这些值代入 $J_{\\mathrm{u}}$ 的表达式：\n$$ J_{\\mathrm{u}} = 0.50 \\times \\exp(-0.06) \\times [1 - \\exp(-1.44)] $$\n$$ J_{\\mathrm{u}} \\approx 0.50 \\times 0.94176 \\times (1 - 0.23693) $$\n$$ J_{\\mathrm{u}} \\approx 0.50 \\times 0.94176 \\times 0.76307 \\approx 0.35932 \\, \\mathrm{s}^{-1} $$\n\n对于 $J_{\\mathrm{m}}$：\n解离和渗漏扫描的组合指数为：\n$$ -\\frac{k_{\\text{off}}(D+L) + k_{0} s_{\\mathrm{u}} w}{v} = -\\frac{k_{\\text{off}}(60+120)}{10} - \\frac{k_{0} s_{\\mathrm{u}} w}{10} = -\\frac{0.010 \\times 180}{10} - 1.44 = -0.18 - 1.44 = -1.62 $$\n主 AUG 捕获指数为 $-\\frac{k_{0} s_{\\mathrm{m}} w}{v} = -\\frac{2.0 \\times 0.90 \\times 12}{10} = -2.16$。\n将这些值代入 $J_{\\mathrm{m}}$ 的表达式：\n$$ J_{\\mathrm{m}} = 0.50 \\times \\exp(-1.62) \\times [1 - \\exp(-2.16)] $$\n$$ J_{\\mathrm{m}} \\approx 0.50 \\times 0.19791 \\times (1 - 0.11533) $$\n$$ J_{\\mathrm{m}} \\approx 0.50 \\times 0.19791 \\times 0.88467 \\approx 0.08754 \\, \\mathrm{s}^{-1} $$\n\n将两个结果四舍五入到三位有效数字，我们得到：\n$J_{\\mathrm{u}} \\approx 0.359$ $\\mathrm{s}^{-1}$\n$J_{\\mathrm{m}} \\approx 0.0875$ $\\mathrm{s}^{-1}$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.359 & 0.0875 \\end{pmatrix} } $$", "id": "3325094"}, {"introduction": "细胞的正常功能依赖于精确的基因表达，而无义介导的mRNA降解（NMD）是确保蛋白质翻译保真度的关键质量控制机制。本练习要求你将翻译延伸动力学与mRNA稳定性联系起来，建立一个预测mRNA有效寿命的数学模型。通过这个练习，你将深入理解翻译过程中的随机终止事件如何根据其在mRNA上的位置触发降解途径，从而揭示NMD机制背后的定量原理。[@problem_id:3325004]", "problem": "请考虑一个专注于无义介导的mRNA降解 (NMD) 的翻译偶联信使核糖核酸 (mRNA) 监视的机制性随机模型。请使用以下基本依据：(i) 中心法则，即翻译沿着编码序列逐个密码子进行；(ii) 一阶无记忆衰变过程的风险率是可加的；(iii) 外显子连接复合体 (EJC) 在剪接过程中被沉积，如果翻译在至少一个下游EJC的足够上游位置提前终止，则会触发NMD，这与经典距离法则一致。您需要从嵌入在翻译动力学中的离散时间风险过程的第一性原理出发，形式化NMD触发的概率，然后计算由此产生的有效mRNA寿命，即总衰变率的倒数。\n\n使用的定义和假设：\n- 编码序列的长度为 $L$ 个密码子。密码子由 $i \\in \\{1,2,\\dots,L\\}$ 索引，其中 $i=L$ 是正常终止密码子，$i \\in \\{1,\\dots,L-1\\}$ 是可能发生提前终止的位置。\n- 密码子 $i$ 处的核糖体延伸速率为 $k_i$，单位为密码子/秒。在密码子 $i$ 处的驻留时间为 $1/k_i$ 秒。\n- 设 $\\eta$ 为单位时间内发生中止性终止的恒定风险，该风险与位置无关，代表导致提前终止事件（例如，无义密码子或应激下的中止性终止）的分子事件的总和。将每个密码子的提前终止概率建模为 $q_i = 1 - \\exp\\left(-\\eta/k_i\\right)$，这是根据在密码子 $i$ 处驻留时间 $1/k_i$ 内速率为 $\\eta$ 的泊松风险得出的。\n- 设 $S_{i}$ 表示在进入密码子 $i+1$ 之前翻译未提前终止的概率，其中 $S_0 = 1$ 且 $S_i = \\prod_{j=1}^{i} (1-q_j)$。\n- 外显子连接复合体 (EJC) 的位置以一组核苷酸坐标 $\\{e_m\\}$ 的形式提供，每个坐标都以核苷酸为单位，从翻译起始位点开始测量。在密码子 $i$ 处终止的核苷酸坐标为 $x_i = 3i$。\n- 经典触发条件的实现如下：在密码子 $i$ 处的提前终止会触发NMD，当且仅当存在至少一个坐标为 $e$ 的EJC，使得 $e - x_i \\ge d_{\\mathrm{thr}}$，其中 $d_{\\mathrm{thr}}$ 是以核苷酸为单位的阈值距离，这与经验上的约50–约55个核苷酸的“法则”一致。\n- 设 $\\delta_M$ 为基线一阶mRNA衰变率（单位为 $\\mathrm{s}^{-1}$），与翻译无关；设 $\\gamma$ 为每个转录本NMD偶联的额外衰变的强度（单位为 $\\mathrm{s}^{-1}$），该强度根据在一次给定的翻译尝试中触发NMD的概率进行缩放。\n- 定义一轮给定的翻译触发NMD的概率为 $p_{\\mathrm{PTC}} = \\sum_{i=1}^{L-1} \\left(S_{i-1} q_i \\cdot \\mathbf{1}\\{\\exists e: e - 3i \\ge d_{\\mathrm{thr}}\\}\\right)$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 总有效衰变率是来自基线衰变和NMD偶联衰变的独立风险之和。定义有效mRNA寿命 $\\tau$ 为该总速率的倒数。以秒表示 $\\tau$。\n\n您的任务：\n- 实现一个程序，对于每个提供的测试用例，通过首先根据上述定义计算 $p_{\\mathrm{PTC}}$，然后结合基线和NMD偶聯的衰变风险，来计算有效mRNA寿命 $\\tau$ (以秒为单位)。\n- 当提供单个值时，您的实现必须将标量 $k$ 视为所有密码子的统一速率；否则，当作为序列提供时，必须接受特定位置的值 $\\{k_i\\}$。\n- 对于NMD触发，请使用精确不等式 $e - 3i \\ge d_{\\mathrm{thr}}$。\n\n测试套件（每个测试用例是一个元组 $(L, k, \\{e_m\\}, d_{\\mathrm{thr}}, \\eta, \\delta_M, \\gamma)$）：\n- 案例A（具有下游EJC和统一延伸速率的通用“理想路径”）：$(L=\\,$$300$$,\\, k=\\,$$8$$,\\, \\{e_m\\}=\\{\\, $$500$$,\\, $$1200$$ \\,\\},\\, d_{\\mathrm{thr}}=\\,$$55$$,\\, \\eta=\\,$$0.008$$,\\, \\delta_M=\\,$$0.0002$$,\\, \\gamma=\\,$$0.0025$$)$。\n- 案例B（下游无EJC；NMD无法触发）：$(L=\\,$$400$$,\\, k=\\,$$10$$,\\, \\{e_m\\}=\\varnothing,\\, d_{\\mathrm{thr}}=\\,$$55$$,\\, \\eta=\\,$$0.01$$,\\, \\delta_M=\\,$$0.0003$$,\\, \\gamma=\\,$$0.003$$)$。\n- 案例C（提前终止风险集中在最后一个EJC之后）：$(L=\\,$$300$$,\\, k=\\,[\\, k_i \\,],\\, \\{e_m\\}=\\{\\, $$450$$ \\,\\},\\, d_{\\mathrm{thr}}=\\,$$55$$,\\, \\eta=\\,$$0.02$$,\\, \\delta_M=\\,$$0.00025$$,\\, \\gamma=\\,$$0.01$$)$ 其中 $k_i=\\,$$200$$ for $i \\le $$200$$ and $k_i=\\,$$2$$ for $i > $$200$$.\n- 案例D（EJC接近正常终止密码子的近阈值情景；风险集中在最后几个密码子）：$(L=\\,$$150$$,\\, k=\\,[\\, k_i \\,],\\, \\{e_m\\}=\\{\\, $$490$$ \\,\\},\\, d_{\\mathrm{thr}}=\\,$$55$$,\\, \\eta=\\,$$0.01$$,\\, \\delta_M=\\,$$0.0004$$,\\, \\gamma=\\,$$0.02$$)$ 其中 $k_i=\\,$$500$$ for $i \\le $$147$$ and $k_i=\\,$$1$$ for $i \\in \\{ $$148$$, $$149$$ \\}$.\n\n输出规格：\n- 对于每个测试用例，计算有效寿命 $\\tau$（以秒为单位），并将每个结果四舍五入到6位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为[案例A, 案例B, 案例C, 案例D]。例如，输出格式必须与 $[\\tau_A,\\tau_B,\\tau_C,\\tau_D]$ 完全一样，其中每个 $\\tau$ 都呈现为四舍五入到6位小数并以秒表示的十进制数。", "solution": "该问题已经过验证，被确定为具有科学依据、良定且自洽的。所提供的参数和定义与分子和系统生物学的既定原则一致，因此可以直接进行严谨的求解。\n\n核心任务是计算有效mRNA寿命 $\\tau$，其定义为总有效衰变率 $\\delta_{\\text{eff}}$ 的倒数。总衰变率是两个独立的一阶风险率之和：一个是基线的、与翻译无关的衰变率 $\\delta_M$，另一个是NMD偶联的衰变率。NMD偶联通路的贡献是其最大速率 $\\gamma$，按一轮给定的翻译成功触发NMD的概率 $p_{\\mathrm{PTC}}$ 进行缩放。\n\n因此，总有效衰变率由下式给出：\n$$\n\\delta_{\\text{eff}} = \\delta_M + \\gamma \\cdot p_{\\mathrm{PTC}}\n$$\n有效寿命为：\n$$\n\\tau = \\frac{1}{\\delta_{\\text{eff}}} = \\frac{1}{\\delta_M + \\gamma \\cdot p_{\\mathrm{PTC}}}\n$$\n问题的核心是根据问题陈述中的定义，从第一性原理计算 $p_{\\mathrm{PTC}}$。\n\n在单次翻译事件中触发NMD的概率 $p_{\\mathrm{PTC}}$，是所有可能的提前终止密码子 $i \\in \\{1, 2, \\dots, L-1\\}$ 上发生触发NMD的提前终止事件的概率之和。要在特定密码子 $i$ 处发生提前终止并触发NMD，必须满足两个条件：\n1. 核糖体必须不终止地翻译完密码子1到$i-1$，然后在密码子$i$处提前终止。\n2. 在密码子$i$处的终止必须满足NMD距离法则。\n\n让我们来形式化这些概率。\n核糖体在密码子 $j$ 的驻留时间是 $1/k_j$。给定一个恒定的提前终止风险率 $\\eta$，在遍历密码子 $j$ 期间终止的概率被建模为一个泊松过程。在时间间隔 $1/k_j$ 内发生一个或多个终止事件的概率是 $q_j = 1 - \\exp(-\\eta/k_j)$。因此，成功遍历密码子 $j$ 的概率是 $1-q_j$。\n\n从密码子1到$i-1$的翻译过程中存活下来的概率是每个密码子单独存活概率的乘积。这由 $S_{i-1}$ 给出，其中 $S_0=1$ 且对于 $i > 1$：\n$$\nS_{i-1} = \\prod_{j=1}^{i-1} (1-q_j)\n$$\n特别地在密码子 $i$ 处终止的概率是存活到密码子 $i$ （即到达它）的概率乘以在 $i$ 处终止的概率。这等于 $S_{i-1} \\cdot q_i$。\n\n接下来，我们纳入NMD触发条件。在密码子 $i$（核苷酸位置 $x_i = 3i$）处的提前终止会触发NMD，当且仅当在集合 $\\{e_m\\}$ 中存在至少一个位置为 $e$ 的外显子连接复合体 (EJC)，该位置在下游至少 $d_{\\mathrm{thr}}$ 个核苷酸处。这个条件使用指示函数 $\\mathbf{1}\\{\\cdot\\}$ 表示：\n$$\n\\mathbf{1}\\{\\exists e \\in \\{e_m\\} : e - 3i \\ge d_{\\mathrm{thr}}\\}\n$$\n如果对于 $\\{e_m\\}$ 中的任何 $e$，该条件为真，则此函数的值为1，否则为0。\n\n结合这些元素，触发NMD的总概率 $p_{\\mathrm{PTC}}$ 是对所有可能的提前终止位点 $i=1, \\dots, L-1$ 的求和：\n$$\np_{\\mathrm{PTC}} = \\sum_{i=1}^{L-1} \\left( S_{i-1} \\cdot q_i \\cdot \\mathbf{1}\\{\\exists e \\in \\{e_m\\} : e - 3i \\ge d_{\\mathrm{thr}}\\} \\right)\n$$\n\n对于每个测试用例，计算算法如下：\n1.  初始化 $p_{\\mathrm{PTC}} = 0$ 和存活概率跟踪器 $S = 1.0$（代表 $S_0$）。\n2.  为 $i \\in \\{1, \\dots, L-1\\}$ 构建位置特异性延伸速率向量 $\\{k_i\\}$。如果给定的是一个标量 $k$，则所有 $k_i$ 都设为此值。\n3.  从1到 $L-1$ 迭代 $i$：\n    a. 计算每个密码子的终止概率 $q_i = 1 - \\exp(-\\eta/k_i)$。\n    b. 检查NMD触发条件：确定在 $\\{e_m\\}$ 中是否存在任何EJC位置 $e$，使得 $e - 3i \\ge d_{\\mathrm{thr}}$。\n    c. 如果满足NMD条件，则将此特定事件的概率 $S \\cdot q_i$ 加到 $p_{\\mathrm{PTC}}$ 的运行总和中。注意，在迭代 $i$ 开始时，变量 $S$ 持有 $S_{i-1}$ 的值。\n    d. 为下一次迭代更新存活概率：$S \\leftarrow S \\cdot (1-q_i)$。这将值从 $S_{i-1}$ 更新为 $S_i$。\n4.  循环完成后，计算总有效衰变率 $\\delta_{\\text{eff}} = \\delta_M + \\gamma \\cdot p_{\\mathrm{PTC}}$。\n5.  最后，计算有效mRNA寿命 $\\tau = 1 / \\delta_{\\text{eff}}$。\n\n将此过程应用于所提供的四个测试用例中的每一个，从而得出所需的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective mRNA lifetime based on a stochastic model of\n    translation-coupled nonsense-mediated decay (NMD).\n    \"\"\"\n\n    def get_k_array_case_c(L):\n        k = np.zeros(L)\n        for i in range(1, L): # Codon indices 1 to L-1\n            if i = 200:\n                k[i] = 200.0\n            else:\n                k[i] = 2.0\n        return k\n\n    def get_k_array_case_d(L):\n        k = np.zeros(L)\n        for i in range(1, L): # Codon indices 1 to L-1\n            if i = 147:\n                k[i] = 500.0\n            elif i in [148, 149]:\n                k[i] = 1.0\n        return k\n\n    test_cases = [\n        (300, 8.0, {500, 1200}, 55, 0.008, 0.0002, 0.0025), # Case A\n        (400, 10.0, set(), 55, 0.01, 0.0003, 0.003),         # Case B\n        (300, get_k_array_case_c, {450}, 55, 0.02, 0.00025, 0.01), # Case C\n        (150, get_k_array_case_d, {490}, 55, 0.01, 0.0004, 0.02)  # Case D\n    ]\n\n    results = []\n    for params in test_cases:\n        L, k_param, e_m, d_thr, eta, delta_M, gamma = params\n\n        k_rates = np.zeros(L) \n        if isinstance(k_param, (int, float)):\n            k_rates[1:L] = k_param\n        elif callable(k_param):\n            k_rates = k_param(L)\n        \n        p_ptc = 0.0\n        S_i_minus_1 = 1.0 \n\n        for i in range(1, L):\n            k_i = k_rates[i]\n            \n            if k_i == 0:\n                continue\n\n            q_i = 1.0 - np.exp(-eta / k_i)\n            \n            x_i = 3 * i\n            is_nmd_competent = False\n            if e_m:\n                if any(e - x_i >= d_thr for e in e_m):\n                    is_nmd_competent = True\n            \n            if is_nmd_competent:\n                p_termination_at_i = S_i_minus_1 * q_i\n                p_ptc += p_termination_at_i\n            \n            S_i_minus_1 *= (1.0 - q_i)\n\n        delta_eff = delta_M + gamma * p_ptc\n        tau = 1.0 / delta_eff\n        \n        results.append(tau)\n\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "3325004"}, {"introduction": "理论模型的力量最终取决于我们通过实验验证和量化其参数的能力。本练习将带你从理论建模转向实验设计，应用数理统计中的核心工具——费雪信息矩阵（FIM）——来前瞻性地评估不同核糖体分析测序（Ribo-seq）实验方案的优劣。你将学会如何预测关键翻译参数（如起始速率 $\\alpha$ 和延伸速率 $e$）的置信区间，并基于最小化参数不确定性的目标来选择最佳的实验设计。[@problem_id:3325109]", "problem": "您需要设计并实现一个完整的、可运行的程序。该程序针对一组计划中的核糖体分析测序（Ribo-seq）实验设计，计算翻译起始率和延伸率估计的预期置信区间，并选择使参数不确定性最小的设计。该任务必须以纯数学术语进行描述，基于中心法则和核糖体动力学的基本原理，并且必须以精确格式单行输出结果。\n\n基本依据包括以下广为接受的原理和建模假设：\n\n- 中心法则指出，遗传信息从脱氧核糖核酸（DNA）流向核糖核酸（RNA），再到蛋白质。核糖体的翻译过程通过在起始密码子处起始，然后沿着密码子延伸，直至终止。\n- 在核糖体碰撞可忽略不计的低密度情况下，开放阅读框上的稳态核糖体足迹密度与起始通量和每个位置的驻留时间的乘积成正比。设起始率为 $\\alpha$（单位 $\\mathrm{s}^{-1}$），均一延伸速度为 $e$（单位 $\\mathrm{codons \\ per \\ s}$）。定义 $\\varphi = 1/e$（单位 $\\mathrm{s}/\\mathrm{codon}$）为每密码子驻留时间缩放参数。\n- 设 $m$ 表示用于分析的编码序列上的足迹位置数量，设 $s$ 表示由起始特异性分析技术（例如，Quantitative Translation Initiation sequencing）使用的起始区域位置数量。设 $\\mathbf{w} \\in \\mathbb{R}^m$ 为 Ribo-seq 位置的密码子特异性驻留权重的已知向量，$\\mathbf{h} \\in \\mathbb{R}^s$ 为起始特异性足迹的起始区域权重的已知向量。\n\n测量模型：\n\n- Ribo-seq 在位置 $i \\in \\{1,\\dots,m\\}$ 的预期足迹密度建模为 $f_i(\\alpha,\\varphi) = \\alpha\\,\\varphi\\,w_i$。\n- 在起始区域位置 $j \\in \\{1,\\dots,s\\}$ 的预期起始特异性足迹密度为 $g_j(\\alpha,\\varphi) = \\alpha\\,h_j$，与 $\\varphi$ 无关。\n\n噪声和重复实验：\n\n- 每个观测值都服从独立的零均值高斯噪声。Ribo-seq 测量的每个位置的方差为 $\\sigma_R^2$，起始特异性测量的每个位置的方差为 $\\sigma_Q^2$。\n- 对于 $n_R$ 次独立的 Ribo-seq 重复实验和 $n_Q$ 次独立的起始特异性重复实验，每个位置的有效方差分别变为 $\\sigma_R^2/n_R$ 和 $\\sigma_Q^2/n_Q$。\n\n参数推断和不确定性：\n\n- 考虑参数向量 $\\boldsymbol{\\theta} = [\\alpha,\\varphi]^\\top$。在高斯噪声模型以及 $\\mathbf{f}$ 和 $\\mathbf{g}$ 的平滑性假设下，加权最小二乘估计量 $\\hat{\\boldsymbol{\\theta}}$ 是渐近正态的，其协方差可通过费雪信息矩阵（FIM）的逆来近似。该FIM基于均值模型的雅可比矩阵和噪声协方差的逆。使用关于 $\\boldsymbol{\\theta}$ 的堆叠均值向量的雅可比矩阵 $\\mathbf{J}(\\alpha,\\varphi)$ 和包含有效方差倒数的对角权重矩阵 $\\mathbf{W}$。\n- 设 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}})$ 表示 $\\hat{\\boldsymbol{\\theta}}$ 的渐近协方差。$\\alpha$ 和 $e$ 的 $0.95$ 置信区间使用正态近似构建，临界值为 $z_{0.975}$，其中 $z_{0.975} \\approx 1.959964$。由于 $e = 1/\\varphi$，应用Delta方法将不确定性从 $\\varphi$ 转换到 $e$。\n\n设计选择目标：\n\n- 在由 $(n_R, n_Q)$ 对指定的有限候选设计集中，选择能够最小化最坏情况边际不确定性的设计。该不确定性定义为在名义真实参数下计算的 $\\alpha$（单位 $\\mathrm{s}^{-1}$）和 $e$（单位 $\\mathrm{codons \\ per \\ s}$）的两个置信区间半宽中的最大值。若出现平局，必须选择所提供列表中候选设计的最小索引。\n\n实现要求：\n\n- 对于每个测试用例，根据 $m$ 和 $s$ 按如下方式确定性地构建 $\\mathbf{w}$ 和 $\\mathbf{h}$：\n  - 对于 $i \\in \\{1,\\dots,m\\}$，定义 $w_i = 1 + 0.4\\,\\sin\\!\\left(\\frac{2\\pi i}{30}\\right) + 0.3\\,\\frac{i}{m}$。这将生成一个科学上合理、平滑变化且具有中等异质性的密码子驻留景观。\n  - 对于 $j \\in \\{1,\\dots,s\\}$，定义 $h_j = \\exp\\!\\left(-\\frac{j-1}{3}\\right)$。这模拟了起始区域上一个衰减的与起始相关的信号。\n- 对于每个候选设计 $(n_R, n_Q)$，使用上述框架计算 $\\alpha$ 和 $e$ 的预期 $0.95$ 置信区间半宽，并选择使最大半宽最小化的设计。$\\alpha$ 的半宽以 $\\mathrm{s}^{-1}$ 表示， $e$ 的半宽以 $\\mathrm{codons \\ per \\ s}$ 表示。对于数值报告，将每个半宽四舍五入到 $6$ 位小数。\n\n测试套件：\n\n- 案例 $1$：$m=50$, $s=8$, $\\alpha=0.05$ $\\mathrm{s}^{-1}$, $e=5.0$ $\\mathrm{codons \\ per \\ s}$, $\\sigma_R^2=0.02$, $\\sigma_Q^2=0.05$。候选设计：$(n_R,n_Q) \\in \\{(2,2),(3,2),(2,3)\\}$ 按此顺序列出。\n- 案例 $2$：$m=50$, $s=8$, $\\alpha=0.07$ $\\mathrm{s}^{-1}$, $e=4.5$ $\\mathrm{codons \\ per \\ s}$, $\\sigma_R^2=0.08$, $\\sigma_Q^2=0.12$。候选设计：$(n_R,n_Q) \\in \\{(2,1),(4,2),(3,3)\\}$ 按此顺序列出。\n- 案例 $3$：$m=100$, $s=10$, $\\alpha=0.03$ $\\mathrm{s}^{-1}$, $e=7.0$ $\\mathrm{codons \\ per \\ s}$, $\\sigma_R^2=0.005$, $\\sigma_Q^2=0.01$。候选设计：$(n_R,n_Q) \\in \\{(3,3),(5,1),(2,4)\\}$ 按此顺序列出。\n- 案例 $4$：$m=300$, $s=12$, $\\alpha=0.02$ $\\mathrm{s}^{-1}$, $e=6.5$ $\\mathrm{codons \\ per \\ s}$, $\\sigma_R^2=0.02$, $\\sigma_Q^2=0.04$。候选设计：$(n_R,n_Q) \\in \\{(4,4),(6,2),(3,5)\\}$ 按此顺序列出。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，输出一个形式为 $[\\text{design_index}, \\text{ci}_{\\alpha}, \\text{ci}_{e}]$ 的子列表，其中 $\\text{design_index}$ 是候选设计列表中的1-based索引，$\\text{ci}_{\\alpha}$ 是 $\\alpha$ 的 $0.95$ 置信区间半宽（单位 $\\mathrm{s}^{-1}$，四舍五入到6位小数），$\\text{ci}_{e}$ 是 $e$ 的 $0.95$ 置信区间半宽（单位 $\\mathrm{codons \\ per \\ s}$，四舍五入到6位小数）。因此，最后一行必须类似于 $[[d_1,c_{\\alpha,1},c_{e,1}],[d_2,c_{\\alpha,2},c_{e,2}],\\dots]$。", "solution": "该问题已经过仔细验证，并被确定为 **有效**。它在科学上基于分子生物学和统计推断的既定原则，问题陈述清晰，目标明确，并为获得唯一解提供了所有必要信息。\n\n我们现在开始进行形式化求解。目标是选择一个由重复实验次数对 $(n_R, n_Q)$ 定义的实验设计，以最小化翻译起始率 $\\alpha$ 和延伸速度 $e$ 估计中的最大预期不确定性。不确定性由 $0.95$ 置信区间半宽量化。该分析依赖于费雪信息矩阵（FIM）来近似参数估计量的协方差。\n\n**1. 模型设定**\n\n待估计的参数向量为 $\\boldsymbol{\\theta} = [\\alpha, \\varphi]^\\top$，其中 $\\alpha$ 是起始率，单位为 $\\mathrm{s}^{-1}$，$\\varphi = 1/e$ 是每密码子驻留时间缩放参数，单位为 $\\mathrm{s}/\\mathrm{codon}$。延伸速度 $e$ 的单位为 $\\mathrm{codons}/\\mathrm{s}$。\n\n实验包括两种类型的测量：\n- Ribo-seq，有 $m$ 个足迹位置。位置 $i$ 的预期足迹密度为 $f_i(\\alpha, \\varphi) = \\alpha \\varphi w_i$。\n- 起始特异性分析，有 $s$ 个起始区域位置。位置 $j$ 的预期密度为 $g_j(\\alpha, \\varphi) = \\alpha h_j$。\n\n权重向量 $\\mathbf{w} \\in \\mathbb{R}^m$ 和 $\\mathbf{h} \\in \\mathbb{R}^s$ 由所给公式确定：\n- $w_i = 1 + 0.4\\sin(\\frac{2\\pi i}{30}) + 0.3\\frac{i}{m}$ 对于 $i \\in \\{1, \\dots, m\\}$。\n- $h_j = \\exp(-\\frac{j-1}{3})$ 对于 $j \\in \\{1, \\dots, s\\}$。\n\n测量值服从独立的高斯噪声。对于 $n_R$ 次 Ribo-seq 重复实验和 $n_Q$ 次起始特异性重复实验，有效方差分别为 $\\sigma_{R,eff}^2 = \\sigma_R^2/n_R$ 和 $\\sigma_{Q,eff}^2 = \\sigma_Q^2/n_Q$。\n\n**2. 费雪信息矩阵 (FIM)**\n\nFIM，记为 $\\mathbf{F}$，量化了数据提供关于参数的信息量。对于带有高斯噪声模型的加权最小二乘问题，FIM由 $\\mathbf{F} = \\mathbf{J}^\\top \\mathbf{W} \\mathbf{J}$ 给出，其中 $\\mathbf{J}$ 是均值模型的雅可比矩阵，$\\mathbf{W}$ 是测量方差倒数矩阵。\n\n均值模型是所有预期测量的向量，$\\boldsymbol{\\mu}(\\boldsymbol{\\theta}) = [f_1, \\dots, f_m, g_1, \\dots, g_s]^\\top$。雅可比矩阵 $\\mathbf{J}$ 是 $\\boldsymbol{\\mu}$ 关于 $\\boldsymbol{\\theta} = [\\alpha, \\varphi]^\\top$ 的偏导数组成的 $(m+s) \\times 2$ 矩阵：\n$$\n\\mathbf{J} = \\frac{\\partial \\boldsymbol{\\mu}}{\\partial \\boldsymbol{\\theta}^\\top} =\n\\begin{pmatrix}\n\\frac{\\partial f_1}{\\partial \\alpha}  \\frac{\\partial f_1}{\\partial \\varphi} \\\\\n\\vdots  \\vdots \\\\\n\\frac{\\partial f_m}{\\partial \\alpha}  \\frac{\\partial f_m}{\\partial \\varphi} \\\\\n\\frac{\\partial g_1}{\\partial \\alpha}  \\frac{\\partial g_1}{\\partial \\varphi} \\\\\n\\vdots  \\vdots \\\\\n\\frac{\\partial g_s}{\\partial \\alpha}  \\frac{\\partial g_s}{\\partial \\varphi}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\varphi w_1  \\alpha w_1 \\\\\n\\vdots  \\vdots \\\\\n\\varphi w_m  \\alpha w_m \\\\\nh_1  0 \\\\\n\\vdots  \\vdots \\\\\nh_s  0\n\\end{pmatrix}\n$$\n权重矩阵 $\\mathbf{W}$ 是一个 $(m+s) \\times (m+s)$ 的对角矩阵，其对角线元素为有效方差的倒数：\n$$\n\\mathbf{W} = \\mathrm{diag}\\left(\\underbrace{\\frac{n_R}{\\sigma_R^2}, \\dots, \\frac{n_R}{\\sigma_R^2}}_{m \\text{ times}}, \\underbrace{\\frac{n_Q}{\\sigma_Q^2}, \\dots, \\frac{n_Q}{\\sigma_Q^2}}_{s \\text{ times}}\\right)\n$$\n$2 \\times 2$ FIM $\\mathbf{F} = \\mathbf{J}^\\top \\mathbf{W} \\mathbf{J}$ 的分量计算如下：\n$F_{11} = \\sum_{i=1}^m \\frac{n_R}{\\sigma_R^2} (\\varphi w_i)^2 + \\sum_{j=1}^s \\frac{n_Q}{\\sigma_Q^2} (h_j)^2 = \\frac{n_R \\varphi^2}{\\sigma_R^2} S_{w2} + \\frac{n_Q}{\\sigma_Q^2} S_{h2}$\n$F_{12} = F_{21} = \\sum_{i=1}^m \\frac{n_R}{\\sigma_R^2} (\\varphi w_i)(\\alpha w_i) = \\frac{n_R \\alpha \\varphi}{\\sigma_R^2} S_{w2}$\n$F_{22} = \\sum_{i=1}^m \\frac{n_R}{\\sigma_R^2} (\\alpha w_i)^2 = \\frac{n_R \\alpha^2}{\\sigma_R^2} S_{w2}$\n其中 $S_{w2} = \\sum_{i=1}^m w_i^2$ 且 $S_{h2} = \\sum_{j=1}^s h_j^2$。求和 $S_{h2} = \\sum_{j=1}^s (\\exp(-\\frac{j-1}{3}))^2 = \\sum_{k=0}^{s-1} (\\exp(-2/3))^k$ 是一个等比数列，其闭合形式为 $S_{h2} = \\frac{1 - \\exp(-2s/3)}{1 - \\exp(-2/3)}$。\n\n**3. 参数协方差和置信区间**\n\n估计量 $\\hat{\\boldsymbol{\\theta}}$ 的渐近协方差矩阵通过 FIM 的逆来近似：$\\mathrm{Cov}(\\hat{\\boldsymbol{\\theta}}) \\approx \\mathbf{F}^{-1}$。\n$\\mathbf{F}$ 的行列式为：\n$\\det(\\mathbf{F}) = F_{11}F_{22} - F_{12}^2 = \\frac{n_R n_Q \\alpha^2 S_{w2} S_{h2}}{\\sigma_R^2 \\sigma_Q^2}$。\n\n估计量 $\\hat{\\alpha}$ 和 $\\hat{\\varphi}$ 的方差是 $\\mathbf{F}^{-1}$ 的对角元素：\n$\\mathrm{Var}(\\hat{\\alpha}) = (\\mathbf{F}^{-1})_{11} = \\frac{F_{22}}{\\det(\\mathbf{F})} = \\frac{\\sigma_Q^2}{n_Q S_{h2}}$\n$\\mathrm{Var}(\\hat{\\varphi}) = (\\mathbf{F}^{-1})_{22} = \\frac{F_{11}}{\\det(\\mathbf{F})} = \\frac{\\varphi^2 \\sigma_Q^2}{n_Q \\alpha^2 S_{h2}} + \\frac{\\sigma_R^2}{n_R \\alpha^2 S_{w2}}$\n\n$\\alpha$ 的 $0.95$ 置信区间半宽由下式给出：\n$\\mathrm{CI}_{\\alpha} = z_{0.975} \\sqrt{\\mathrm{Var}(\\hat{\\alpha})} = z_{0.975} \\frac{\\sigma_Q}{\\sqrt{n_Q S_{h2}}}$\n其中 $z_{0.975} \\approx 1.959964$ 是标准正态分布的临界值。\n\n为了找到延伸速度 $e = 1/\\varphi$ 的置信区间，我们应用Delta方法。$\\hat{e}$ 的方差近似为：\n$\\mathrm{Var}(\\hat{e}) \\approx \\left(\\frac{de}{d\\varphi}\\right)^2 \\mathrm{Var}(\\hat{\\varphi}) = \\left(-\\frac{1}{\\varphi^2}\\right)^2 \\mathrm{Var}(\\hat{\\varphi}) = \\frac{1}{\\varphi^4} \\mathrm{Var}(\\hat{\\varphi})$。\n代入 $\\varphi = 1/e$ 和 $\\mathrm{Var}(\\hat{\\varphi})$ 的表达式：\n$\\mathrm{Var}(\\hat{e}) \\approx e^4 \\left( \\frac{(1/e)^2 \\sigma_Q^2}{n_Q \\alpha^2 S_{h2}} + \\frac{\\sigma_R^2}{n_R \\alpha^2 S_{w2}} \\right) = \\frac{e^2 \\sigma_Q^2}{n_Q \\alpha^2 S_{h2}} + \\frac{e^4 \\sigma_R^2}{n_R \\alpha^2 S_{w2}}$。\n$e$ 的置信区间半宽为：\n$\\mathrm{CI}_{e} = z_{0.975} \\sqrt{\\mathrm{Var}(\\hat{e})} = z_{0.975} \\sqrt{\\frac{e^2 \\sigma_Q^2}{n_Q \\alpha^2 S_{h2}} + \\frac{e^4 \\sigma_R^2}{n_R \\alpha^2 S_{w2}}}$。\n\n**4. 设计选择**\n\n对于每个测试用例和每个候选设计 $(n_R, n_Q)$，我们计算半宽 $\\mathrm{CI}_{\\alpha}$ 和 $\\mathrm{CI}_{e}$。最优设计是最小化目标函数 $\\max(\\mathrm{CI}_{\\alpha}, \\mathrm{CI}_{e})$ 的设计。如果出现平局，则选择所提供列表中索引最小的设计。最终报告的值是设计索引（1-based）以及对应的 $\\alpha$ 和 $e$ 的置信区间半宽，四舍五入到 $6$ 位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the experimental design problem for all test cases.\n    \"\"\"\n    \n    z_crit = 1.959964\n\n    test_cases = [\n        {\n            \"params\": {\"m\": 50, \"s\": 8, \"alpha\": 0.05, \"e\": 5.0, \"sigma_R_sq\": 0.02, \"sigma_Q_sq\": 0.05},\n            \"designs\": [(2, 2), (3, 2), (2, 3)]\n        },\n        {\n            \"params\": {\"m\": 50, \"s\": 8, \"alpha\": 0.07, \"e\": 4.5, \"sigma_R_sq\": 0.08, \"sigma_Q_sq\": 0.12},\n            \"designs\": [(2, 1), (4, 2), (3, 3)]\n        },\n        {\n            \"params\": {\"m\": 100, \"s\": 10, \"alpha\": 0.03, \"e\": 7.0, \"sigma_R_sq\": 0.005, \"sigma_Q_sq\": 0.01},\n            \"designs\": [(3, 3), (5, 1), (2, 4)]\n        },\n        {\n            \"params\": {\"m\": 300, \"s\": 12, \"alpha\": 0.02, \"e\": 6.5, \"sigma_R_sq\": 0.02, \"sigma_Q_sq\": 0.04},\n            \"designs\": [(4, 4), (6, 2), (3, 5)]\n        }\n    ]\n\n    final_results = []\n    \n    for case_data in test_cases:\n        params = case_data[\"params\"]\n        designs = case_data[\"designs\"]\n        \n        m = params[\"m\"]\n        s = params[\"s\"]\n        alpha = params[\"alpha\"]\n        e = params[\"e\"]\n        sigma_R_sq = params[\"sigma_R_sq\"]\n        sigma_Q_sq = params[\"sigma_Q_sq\"]\n\n        i_vals = np.arange(1, m + 1)\n        w = 1.0 + 0.4 * np.sin(2.0 * np.pi * i_vals / 30.0) + 0.3 * i_vals / m\n        S_w2 = np.sum(w**2)\n        \n        r = np.exp(-2.0 / 3.0)\n        if r == 1:\n            S_h2 = s\n        else:\n            S_h2 = (1.0 - r**s) / (1.0 - r)\n\n        min_max_ci = float('inf')\n        best_design_info = None\n\n        for idx, (n_R, n_Q) in enumerate(designs):\n            var_alpha = sigma_Q_sq / (n_Q * S_h2)\n            ci_alpha = z_crit * np.sqrt(var_alpha)\n\n            term1 = (e**2 * sigma_Q_sq) / (n_Q * alpha**2 * S_h2)\n            term2 = (e**4 * sigma_R_sq) / (n_R * alpha**2 * S_w2)\n            var_e = term1 + term2\n            ci_e = z_crit * np.sqrt(var_e)\n            \n            max_ci = max(ci_alpha, ci_e)\n            \n            if max_ci  min_max_ci:\n                min_max_ci = max_ci\n                best_design_info = {\n                    \"index\": idx + 1,\n                    \"ci_alpha\": ci_alpha,\n                    \"ci_e\": ci_e\n                }\n\n        result_tuple = [\n            best_design_info[\"index\"],\n            round(best_design_info[\"ci_alpha\"], 6),\n            round(best_design_info[\"ci_e\"], 6)\n        ]\n        final_results.append(str(result_tuple).replace(\" \", \"\"))\n\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3325109"}]}