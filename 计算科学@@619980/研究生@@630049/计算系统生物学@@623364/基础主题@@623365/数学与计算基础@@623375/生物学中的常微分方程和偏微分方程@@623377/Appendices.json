{"hands_on_practices": [{"introduction": "当我们构建生物化学网络模型时，所选择的反应速率常数并非任意。它们必须遵守基本的物理定律，例如热力学第二定律，以确保模型的物理真实性。本练习 [@problem_id:3335929] 提供了一个具体实践，通过应用细致平衡原理，对一个简单的环形反应网络强制施加这种热力学一致性，从而推导出韦格沙伊德条件（Wegscheider condition）。这确保了我们的模型在物理上是合理的，并且其平衡特性与热力学原理相符。", "problem": "考虑一个封闭、均匀混合的生物化学系统，其中包含$A$、$B$和$C$三个物种，它们通过三个可逆单分子反应$A \\rightleftharpoons B$、$B \\rightleftharpoons C$和$C \\rightleftharpoons A$在等温条件下相互连接。假设其遵循质量作用动力学，且速率常数和浓度均为严格正值。设$A \\to B$的正向速率常数为$k_{1}^{+}$，逆向速率常数为$k_{1}^{-}$；$B \\to C$的正向速率常数为$k_{2}^{+}$，逆向速率常数为$k_{2}^{-}$；$C \\to A$的正向速率常数为$k_{3}^{+}$，逆向速率常数为$k_{3}^{-}$。浓度向量为$\\mathbf{c}(t) = (c_{A}(t), c_{B}(t), c_{C}(t))$，其动力学遵循以下常微分方程：\n$$\n\\frac{dc_{A}}{dt} = -k_{1}^{+} c_{A} + k_{1}^{-} c_{B} - k_{3}^{-} c_{A} + k_{3}^{+} c_{C}, \\quad\n\\frac{dc_{B}}{dt} = k_{1}^{+} c_{A} - k_{1}^{-} c_{B} - k_{2}^{+} c_{B} + k_{2}^{-} c_{C}, \\quad\n\\frac{dc_{C}}{dt} = k_{2}^{+} c_{B} - k_{2}^{-} c_{C} + k_{3}^{-} c_{A} - k_{3}^{+} c_{C}.\n$$\n从热力学第二定律和稀溶液中化学势的定义出发，并利用质量作用动力学来形式化熵产生速率。无量纲的熵产生速率（由Boltzmann常数归一化），按反应定义为流-亲和势乘积之和，表达式为：\n$$\n\\sigma(\\mathbf{c}) = \\sum_{r=1}^{3} \\left( v_{r}^{+}(\\mathbf{c}) - v_{r}^{-}(\\mathbf{c}) \\right) \\ln\\!\\left( \\frac{v_{r}^{+}(\\mathbf{c})}{v_{r}^{-}(\\mathbf{c})} \\right),\n$$\n其中，对于反应$r$，正向和逆向的质量作用速率分别为$v_{r}^{+}(\\mathbf{c})$和$v_{r}^{-}(\\mathbf{c})$。\n\n给定数值$k_{1}^{+} = 4$，$k_{1}^{-} = 1$，$k_{2}^{+} = 3$，$k_{2}^{-} = 2$，$k_{3}^{-} = 5$，以及一个初始（待修正）值$k_{3}^{+}(0) = 6$。同时给定用于计算$\\sigma(\\mathbf{c})$的状态$\\mathbf{c} = (c_{A}, c_{B}, c_{C}) = (2, 1, 4)$。对于这个闭合循环，热力学一致性要求存在一个循环亲和势为零的细致平衡态，这意味着循环$A \\to B \\to C \\to A$须满足Wegscheider条件。\n\n任务：\n1. 通过在细致平衡下施加零循环亲和势的条件，从第一性原理推导出该单分子循环的Wegscheider条件，并用它来确定唯一的乘法修正因子$f$，使得修正后的正向速率常数$\\tilde{k}_{3}^{+} = f \\, k_{3}^{+}(0)$使该反应网络满足热力学一致性。\n2. 使用修正后的$\\tilde{k}_{3}^{+}$，推导在给定状态$\\mathbf{c}$下的无量纲熵产生速率$\\sigma(\\mathbf{c})$，证明其为非负，并计算其以自然对数表示的精确表达式。\n3. 在细致平衡点$\\mathbf{c}^{*}$处将动力学线性化，并将一个适当加权的雅可比矩阵的对称性与化学计量子空间上的稳定性约束联系起来，解释细致平衡如何意味着一个对称相似变换以及除守恒模式外为实数非正的谱。\n\n最终答案仅报告用于强制满足Wegscheider条件的乘法修正因子$f$的精确有理数值。将$f$表示为精确有理数形式。不包含单位，也不要四舍五入。", "solution": "该问题要求计算一个乘法修正因子$f$，以确保给定的一组反应速率常数是热力学一致的。这种一致性由Wegscheider条件强制满足，该条件源于平衡状态下闭合反应循环中的细致平衡原理。\n\n该系统由三个物种$A$、$B$和$C$组成，它们参与一个循环反应网络：\n$A \\underset{k_{1}^{-}}{\\stackrel{k_{1}^{+}}{\\rightleftharpoons}} B$\n$B \\underset{k_{2}^{-}}{\\stackrel{k_{2}^{+}}{\\rightleftharpoons}} C$\n$C \\underset{k_{3}^{-}}{\\stackrel{k_{3}^{+}}{\\rightleftharpoons}} A$\n\n问题指明速率定律是质量作用定律。每个反应$r$的正向和逆向速率分别记为$v_r^{+}$和$v_r^{-}$。\n对于反应1 ($A \\rightleftharpoons B$)：$v_{1}^{+} = k_{1}^{+} c_{A}$ 且 $v_{1}^{-} = k_{1}^{-} c_{B}$。\n对于反应2 ($B \\rightleftharpoons C$)：$v_{2}^{+} = k_{2}^{+} c_{B}$ 且 $v_{2}^{-} = k_{2}^{-} c_{C}$。\n对于反应3 ($C \\rightleftharpoons A$)：$v_{3}^{+} = k_{3}^{+} c_{C}$ 且 $v_{3}^{-} = k_{3}^{-} c_{A}$。这与所提供的常微分方程一致，特别是对$\\frac{dc_A}{dt}$有贡献的项$-k_{3}^{-} c_{A} + k_{3}^{+} c_{C}$。\n\n问题指出，热力学一致性要求存在一个细致平衡态。在细致平衡状态下，浓度记为$\\mathbf{c}^{*} = (c_{A}^{*}, c_{B}^{*}, c_{C}^{*})$，每个反应的净通量为零，这意味着对每个反应而言，其正向速率等于逆向速率：\n$v_{r}^{+}(\\mathbf{c}^{*}) = v_{r}^{-}(\\mathbf{c}^{*})$ for $r=1, 2, 3$.\n\n这给出了以下方程组：\n1. $k_{1}^{+} c_{A}^{*} = k_{1}^{-} c_{B}^{*}$\n2. $k_{2}^{+} c_{B}^{*} = k_{2}^{-} c_{C}^{*}$\n3. $k_{3}^{+} c_{C}^{*} = k_{3}^{-} c_{A}^{*}$\n\n从这些方程中，我们可以用速率常数来表示平衡浓度的比值：\n1. $\\frac{c_{B}^{*}}{c_{A}^{*}} = \\frac{k_{1}^{+}}{k_{1}^{-}}$\n2. $\\frac{c_{C}^{*}}{c_{B}^{*}} = \\frac{k_{2}^{+}}{k_{2}^{-}}$\n3. $\\frac{c_{A}^{*}}{c_{C}^{*}} = \\frac{k_{3}^{+}}{k_{3}^{-}}$\n\n为了使这三个方程对于一个非平凡平衡态（所有浓度均为正值）同时成立，速率常数必须满足一个一致性条件。我们可以通过将这三个比值相乘来看到这一点：\n$$ \\left(\\frac{c_{B}^{*}}{c_{A}^{*}}\\right) \\left(\\frac{c_{C}^{*}}{c_{B}^{*}}\\right) \\left(\\frac{c_{A}^{*}}{c_{C}^{*}}\\right) = 1 $$\n将用速率常数表示的表达式代入，即可得到此循环的Wegscheider条件：\n$$ \\left(\\frac{k_{1}^{+}}{k_{1}^{-}}\\right) \\left(\\frac{k_{2}^{+}}{k_{2}^{-}}\\right) \\left(\\frac{k_{3}^{+}}{k_{3}^{-}}\\right) = 1 $$\n这可以改写为：\n$$ k_{1}^{+} k_{2}^{+} k_{3}^{+} = k_{1}^{-} k_{2}^{-} k_{3}^{-} $$\n这个条件是对任何需要遵循细致平衡的闭合反应环路的动力学参数的一个基本约束。\n\n问题还要求从零循环亲和势原理推导出此条件。反应$r$的无量纲热力学亲和势由$\\mathcal{A}_r = \\ln(v_r^{+}/v_r^{-})$给出。循环$A \\to B \\to C \\to A$的总亲和势是正向步骤亲和势之和：\n$$ \\mathcal{A}_{cycle} = \\mathcal{A}_{A \\to B} + \\mathcal{A}_{B \\to C} + \\mathcal{A}_{C \\to A} $$\n各个亲和势为：\n$\\mathcal{A}_{A \\to B} = \\ln\\left(\\frac{v_{A \\to B}}{v_{B \\to A}}\\right) = \\ln\\left(\\frac{k_{1}^{+} c_{A}}{k_{1}^{-} c_{B}}\\right)$\n$\\mathcal{A}_{B \\to C} = \\ln\\left(\\frac{v_{B \\to C}}{v_{C \\to B}}\\right) = \\ln\\left(\\frac{k_{2}^{+} c_{B}}{k_{2}^{-} c_{C}}\\right)$\n$\\mathcal{A}_{C \\to A} = \\ln\\left(\\frac{v_{C \\to A}}{v_{A \\to C}}\\right) = \\ln\\left(\\frac{k_{3}^{+} c_{C}}{k_{3}^{-} c_{A}}\\right)$\n\n将这些相加得到循环亲和势：\n$$ \\mathcal{A}_{cycle} = \\ln\\left(\\frac{k_{1}^{+} c_{A}}{k_{1}^{-} c_{B}}\\right) + \\ln\\left(\\frac{k_{2}^{+} c_{B}}{k_{2}^{-} c_{C}}\\right) + \\ln\\left(\\frac{k_{3}^{+} c_{C}}{k_{3}^{-} c_{A}}\\right) = \\ln\\left( \\left(\\frac{k_{1}^{+} c_{A}}{k_{1}^{-} c_{B}}\\right) \\left(\\frac{k_{2}^{+} c_{B}}{k_{2}^{-} c_{C}}\\right) \\left(\\frac{k_{3}^{+} c_{C}}{k_{3}^{-} c_{A}}\\right) \\right) $$\n浓度项被消去，这是单分子（或伪单分子）循环的一个特有性质：\n$$ \\mathcal{A}_{cycle} = \\ln\\left(\\frac{k_{1}^{+} k_{2}^{+} k_{3}^{+}}{k_{1}^{-} k_{2}^{-} k_{3}^{-}}\\right) $$\n对于一个处于细致平衡的系统，不存在围绕任何闭合回路的物质或能量的净流动。这要求循环亲和势为零。\n$$ \\mathcal{A}_{cycle} = 0 \\implies \\ln\\left(\\frac{k_{1}^{+} k_{2}^{+} k_{3}^{+}}{k_{1}^{-} k_{2}^{-} k_{3}^{-}}\\right) = 0 \\implies \\frac{k_{1}^{+} k_{2}^{+} k_{3}^{+}}{k_{1}^{-} k_{2}^{-} k_{3}^{-}} = 1 $$\n这就重新推导出了Wegscheider条件。\n\n问题提供了一个初始的、可能不一致的速率常数$k_{3}^{+}(0) = 6$，并要求一个修正因子$f$，使得修正后的常数$\\tilde{k}_{3}^{+} = f \\cdot k_{3}^{+}(0)$使系统满足热力学一致性。我们必须使用这个修正后的常数来施加Wegscheider条件：\n$$ \\frac{k_{1}^{+} k_{2}^{+} \\tilde{k}_{3}^{+}}{k_{1}^{-} k_{2}^{-} k_{3}^{-}} = 1 $$\n代入$\\tilde{k}_{3}^{+} = f \\cdot k_{3}^{+}(0)$：\n$$ \\frac{k_{1}^{+} k_{2}^{+} \\left(f \\cdot k_{3}^{+}(0)\\right)}{k_{1}^{-} k_{2}^{-} k_{3}^{-}} = 1 $$\n现在我们可以求解修正因子$f$：\n$$ f = \\frac{k_{1}^{-} k_{2}^{-} k_{3}^{-}}{k_{1}^{+} k_{2}^{+} k_{3}^{+}(0)} $$\n问题提供了以下速率常数的数值：\n$k_{1}^{+} = 4$\n$k_{1}^{-} = 1$\n$k_{2}^{+} = 3$\n$k_{2}^{-} = 2$\n$k_{3}^{-} = 5$\n$k_{3}^{+}(0) = 6$\n\n将这些值代入$f$的表达式中：\n$$ f = \\frac{(1) \\cdot (2) \\cdot (5)}{(4) \\cdot (3) \\cdot (6)} $$\n$$ f = \\frac{10}{72} $$\n化简该分数得到：\n$$ f = \\frac{5}{36} $$\n这就是确保反应网络的速率常数满足细致平衡条件的唯一乘法修正因子。问题陈述中的其他任务，虽然是对该分析的有效扩展，但对于确定所要求的最终答案而言并非必需。", "answer": "$$\\boxed{\\frac{5}{36}}$$", "id": "3335929"}, {"introduction": "反应-扩散系统是生物学中空间格局形成（spatial pattern formation）的关键模型。当扩散速率远慢于反应动力学时，系统中可能出现急剧变化的模式，如边界层或移动波前。本练习 [@problem_id:3335892] 将应用匹配渐近展开（matched asymptotic expansions）这一强大分析工具，来解析求解一个具有边界层的定态问题，从而深刻理解在细胞或组织中，不同的空间区域是如何被建立和维持的。", "problem": "一个长度缩放为 $[0,1]$ 的细胞内，双稳态调节蛋白浓度 $u(x)$ 的一维无量纲反应扩散稳态由以下常微分方程建模：\n$$\nD\\,u''(x) + f(u(x)) = 0, \\quad x \\in (0,1),\n$$\n其中扩散系数参数 $D$ 很小，$0 < D \\ll 1$。反应项 $f(u) = u - u^{3}$ 源于具有两个稳定表达状态的粗粒化动力学。边界浓度被膜相关过程钳制，因此：\n$$\nu(0) = \\frac{4}{5}, \\qquad u(1) = 1.\n$$\n从稳态反应扩散系统的基本平衡（菲克定律的扩散通量以及浓度稳态意味着扩散通量散度与局部反应相平衡）出发，使用匹配渐近展开法来确定边界层必须在何处形成及其特征厚度。然后，推导领先阶外层解以及任意边界层附近的相应内层问题，并求解内层问题以获得与外层解相匹配的闭式表达式。最后，构建一个一致有效的领先阶复合近似解 $u_{\\mathrm{comp}}(x;D)$。\n\n以 $x$ 和 $D$ 表示的 $u_{\\mathrm{comp}}(x;D)$ 的单个闭式解析表达式形式提供您的最终答案。不要四舍五入；无需单位。", "solution": "所给问题是一个有效、自洽且适定的非线性常微分方程边值问题。它是反应扩散系统背景下的一个经典奇异摄动问题，这是计算系统生物学中的一个核心课题。我们可以使用匹配渐近展开法来求解。\n\n所给的稳态反应扩散方程为：\n$$D u''(x) + f(u(x)) = 0, \\quad x \\in (0, 1)$$\n其中反应项为 $f(u) = u - u^3$，边界条件为 $u(0) = 4/5$ 和 $u(1) = 1$。参数 $D$ 很小，$0 < D \\ll 1$。\n\n该方程可以解释为稳态质量平衡。设 $J(x) = -D u'(x)$ 为扩散通量（菲克定律）。方程变为 $\\frac{dJ}{dx} = -f(u)$，这表明通量的空间变化与局部反应速率相平衡。\n\n**第1步：外层解**\n在远离任何边界层的外层区域，我们假设解 $u(x)$ 变化缓慢。因此，与反应项 $f(u(x))$ 相比，$D u''(x)$ 项可以忽略不计。我们通过在原方程中令 $D=0$ 来求得领先阶外层解 $u_{out}(x)$：\n$$f(u_{out}(x)) = 0$$\n$$u_{out} - u_{out}^3 = 0 \\implies u_{out}(1 - u_{out}^2) = 0$$\n这个代数方程有三个常数解：$u_{out} = -1$，$u_{out} = 0$ 和 $u_{out} = 1$。由于 $u(x)$ 代表蛋白质浓度，它必须是非负的，所以我们只考虑 $u_{out}=0$ 和 $u_{out}=1$。\n\n对于一个反应扩散系统，外层解必须对应于反应动力学的一个稳定稳态，该稳态由常微分方程 $\\frac{du}{dt} = f(u)$ 描述。稳定性由 $f'(u) = 1 - 3u^2$ 的符号决定。\n- 对于 $u=0$，$f'(0) = 1 > 0$，所以这个状态是不稳定的。\n- 对于 $u=1$，$f'(1) = 1-3 = -2 < 0$，所以这个状态是稳定的。\n任何微小的扰动都会导致解偏离不稳定状态 $u=0$。因此，唯一有效的领先阶外层解是 $u_{out}(x) = 1$。\n\n我们用边界条件来检验这个外层解：\n- 在 $x=1$ 处，$u_{out}(1)=1$，与边界条件 $u(1)=1$ 匹配。\n- 在 $x=0$ 处，$u_{out}(0)=1$，与边界条件 $u(0)=4/5$ 不匹配。\n\n这种差异表明在 $x=0$ 处存在一个边界层，在该处解迅速变化以满足边界条件。在 $x=1$ 处不需要边界层。\n\n**第2步：内层解与边界层分析**\n为了分析 $x=0$ 处的边界层，我们引入一个拉伸的内层坐标 $X = \\frac{x}{\\delta(D)}$，其中 $\\delta(D)$ 是该层的特征厚度。设内层解为 $u_{in}(X) \\equiv u(x)$。导数变换如下：\n$$\\frac{du}{dx} = \\frac{1}{\\delta} \\frac{du_{in}}{dX}, \\qquad \\frac{d^2u}{dx^2} = \\frac{1}{\\delta^2} \\frac{d^2u_{in}}{dX^2}$$\n代入常微分方程得到：\n$$\\frac{D}{\\delta^2} \\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\n为了获得一个扩散项和反应项相平衡的特殊极限，我们必须将最高阶导数的系数设为1的量级。我们选择 $\\frac{D}{\\delta^2} = 1$，这意味着 $\\delta = \\sqrt{D}$。\n因此，边界层的特征厚度为 $O(\\sqrt{D})$ 量级，内层坐标为 $X = \\frac{x}{\\sqrt{D}}$。领先阶内层方程为：\n$$\\frac{d^2u_{in}}{dX^2} + u_{in} - u_{in}^3 = 0$$\n内层解必须满足在 $x=0$ 处的边界条件：\n$$u_{in}(X=0) = u(0) = \\frac{4}{5}$$\n当内层变量趋于无穷大时，它还必须与外层解相匹配。匹配条件为：\n$$\\lim_{X \\to \\infty} u_{in}(X) = \\lim_{x \\to 0^+} u_{out}(x) = 1$$\n为了求解二阶内层常微分方程，我们两边乘以 $\\frac{du_{in}}{dX}$ 并对 $X$ 积分：\n$$\\int \\frac{du_{in}}{dX}\\frac{d^2u_{in}}{dX^2} dX + \\int (u_{in} - u_{in}^3)\\frac{du_{in}}{dX} dX = C_1$$\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 + \\frac{1}{2}u_{in}^2 - \\frac{1}{4}u_{in}^4 = C_1$$\n我们使用无穷远处的匹配条件来求常数 $C_1$。当 $X \\to \\infty$ 时，$u_{in} \\to 1$ 并且其导数 $\\frac{du_{in}}{dX} \\to 0$。\n$$\\frac{1}{2}(0)^2 + \\frac{1}{2}(1)^2 - \\frac{1}{4}(1)^4 = C_1 \\implies C_1 = \\frac{1}{4}$$\n将 $C_1$ 代回：\n$$\\frac{1}{2}\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{4} - \\frac{1}{2}u_{in}^2 + \\frac{1}{4}u_{in}^4 = \\frac{1}{4}(1 - 2u_{in}^2 + u_{in}^4) = \\frac{1}{4}(1 - u_{in}^2)^2$$\n$$\\left(\\frac{du_{in}}{dX}\\right)^2 = \\frac{1}{2}(1 - u_{in}^2)^2 \\implies \\frac{du_{in}}{dX} = \\pm \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\n由于 $u_{in}(0) = 4/5$ 且当 $X \\to \\infty$ 时 $u_{in}$ 必须增加以接近 $1$，所以导数 $\\frac{du_{in}}{dX}$ 必须为正。对于在区间 $[4/5, 1)$ 内的 $u_{in}$，项 $1 - u_{in}^2$ 是正的。我们必须选择正号：\n$$\\frac{du_{in}}{dX} = \\frac{1}{\\sqrt{2}}(1 - u_{in}^2)$$\n这是一个可分离的一阶常微分方程。我们分离变量并积分：\n$$\\int \\frac{du_{in}}{1 - u_{in}^2} = \\int \\frac{1}{\\sqrt{2}} dX$$\n左边的积分是 $\\text{arctanh}(u_{in})$。\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + C_2$$\n我们使用边界条件 $u_{in}(0) = 4/5$ 来求积分常数 $C_2$：\n$$\\text{arctanh}\\left(\\frac{4}{5}\\right) = \\frac{0}{\\sqrt{2}} + C_2 \\implies C_2 = \\text{arctanh}\\left(\\frac{4}{5}\\right)$$\n这个常数的值可以使用反双曲正切的对数定义 $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$ 来简化：\n$$C_2 = \\frac{1}{2}\\ln\\left(\\frac{1+4/5}{1-4/5}\\right) = \\frac{1}{2}\\ln\\left(\\frac{9/5}{1/5}\\right) = \\frac{1}{2}\\ln(9) = \\ln(3)$$\n所以，内层解由下式给出：\n$$\\text{arctanh}(u_{in}) = \\frac{X}{\\sqrt{2}} + \\ln(3)$$\n$$u_{in}(X) = \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right)$$\n\n**第3步：一致有效的复合解**\n通过将外层解和内层解相加，再减去它们的公共部分（重叠区域），可以构造一个在整个定义域 $[0,1]$ 上一致有效的复合解 $u_{\\mathrm{comp}}(x;D)$。\n$$u_{\\mathrm{comp}}(x;D) = u_{out}(x) + u_{in}(X) - (\\text{公共部分})$$\n公共部分是内层解在 $X \\to \\infty$ 时的极限，它等于外层解在 $x \\to 0$ 时的极限：\n$$\\text{公共部分} = \\lim_{X \\to \\infty} u_{in}(X) = \\lim_{X \\to \\infty} \\tanh\\left(\\frac{X}{\\sqrt{2}} + \\ln(3)\\right) = 1$$\n这与外层解的值 $u_{out}(x) = 1$ 相匹配。\n代入各个部分：\n$$u_{\\mathrm{comp}}(x;D) = 1 + \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right) - 1$$\n最终的复合解是：\n$$u_{\\mathrm{comp}}(x;D) = \\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)$$\n该表达式为解 $u(x)$ 提供了一个在 $x \\in [0,1]$ 上有效的领先阶近似。它在 $x=0$ 处正确地简化为 $4/5$，并且对于 $x > O(\\sqrt{D})$，它渐近地接近 $1$，在极限 $D \\to 0$ 时满足两个边界条件。", "answer": "$$\\boxed{\\tanh\\left(\\frac{x}{\\sqrt{2D}} + \\ln(3)\\right)}$$", "id": "3335892"}, {"introduction": "虽然解析解能提供深刻的洞察，但大多数现实世界中的生物学偏微分方程必须通过数值方法求解。一个不恰当的数值格式可能导致计算不稳定或效率低下，尤其是在反应和扩散速率尺度差异巨大的刚性系统（stiff systems）中。本练习 [@problem_id:3335951] 将指导你构建并分析一种高效的“隐式-显式”（IMEX）混合格式，这是计算生物学中解决此类问题的标准工具，它能在保证数值稳定性的同时提高计算效率。", "problem": "考虑一个标量场 $\\,u(x,t)\\,$ 的反应扩散偏微分方程 (PDE) $\\,\\partial_t u = D \\Delta u + f(u)\\,$，它定义在一个长度为 $\\,L\\,$ 的一维周期性域上，具有恒定的扩散系数 $\\,D > 0\\,$ 和一个足够光滑的反应项 $\\,f(u)\\,$。假设一个具有 $\\,N\\,$ 个节点和间距 $\\,h = L/N\\,$ 的均匀空间网格，并定义具有周期性边界条件的标准二阶中心差分 schéma的离散拉普拉斯算子 $\\,\\Delta_h\\,$，其形式为 $\\,(\\Delta_h u)_i = \\dfrac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}\\,$，其中指数以 $\\,N\\,$ 为模进行循环。您的任务如下。\n\n1) 从质量平衡和扩散的 Fick 定律以及显式反应的前向 Euler 方法定义出发，构建一个半隐式隐-显 (IMEX) 有限差分格式，该格式对扩散项进行隐式处理，对反应项进行显式处理。用 $\\,\\Delta t > 0\\,$ 表示时间步长，并将离散未知量 $\\,u^n \\in \\mathbb{R}^N\\,$ 从层级 $\\,n\\,$ 到 $\\,n+1\\,$ 的更新写成如下形式\n$$\n\\left(I - \\Delta t\\, D\\, \\Delta_h\\right) u^{n+1} \\;=\\; u^n \\;+\\; \\Delta t\\, f(u^n).\n$$\n解释为什么在所述的离散化条件下，此格式与 PDE $\\,\\partial_t u = D \\Delta u + f(u)\\,$ 是相容的。\n\n2) 对满足 $\\,f(u^\\star) = 0\\,$ 的空间均匀稳态 $\\,u^\\star\\,$ 进行线性稳定性分析。将反应项线性化为 $\\,f(u) \\approx f(u^\\star) + f'(u^\\star)(u - u^\\star)\\,$ 并设 $\\,r = f'(u^\\star)\\,$。使用离散傅里叶模态 $\\,\\varphi_k(i) = \\exp\\!\\left(2\\pi \\mathrm{i}\\, k\\, i/N\\right)\\,$（其中 $\\,k \\in \\{0,1,\\dots,N-1\\}\\,$）来对角化 $\\,\\Delta_h\\,$，并回顾其对应的特征值为\n$$\n\\lambda_k \\;=\\; -\\frac{4}{h^2}\\,\\sin^2\\!\\left(\\frac{\\pi k}{N}\\right).\n$$\n推导出标量模态放大因子 $\\,G_k(\\Delta t)\\,$，并根据 $\\,\\max_k |G_k(\\Delta t)| \\le 1\\,$ 提出 IMEX 格式线性稳定的充分必要条件。证明最坏情况是零模态 $\\,k=0\\,$，并推导出最大线性稳定时间步长 $\\,\\Delta t_{\\max}\\,$ 作为 $\\,r\\,$ 的函数。对 $\\,r < 0\\,$, $\\,r = 0\\,$ 和 $\\,r > 0\\,$ 的情况，清楚地陈述您的结果。\n\n3) 实现与可测试输出。实现一个程序，对下面的每个测试用例，执行以下操作：\n- 使用您在第 2 部分中得到的公式，以秒为单位计算 $\\,\\Delta t_{\\max}\\,$。\n- 对于两个规定的测试步长 $\\,\\Delta t_1\\,$ 和 $\\,\\Delta t_2\\,$（均以秒为单位），使用上面的特征值 $\\,\\lambda_k\\,$，在所有离散傅里叶模态 $\\,k \\in \\{0,\\dots,N-1\\}\\,$ 上评估最大放大因子 $\\,\\max_k |G_k(\\Delta t_j)|\\,$，并返回两个布尔值，分别指示该格式在 $\\,\\Delta t_1\\,$ 时是否线性稳定，以及在 $\\,\\Delta t_2\\,$ 时是否线性不稳定。将稳定性定义为 $\\,\\max_k |G_k(\\Delta t_j)| \\le 1\\,$，不稳定性定义为 $\\,\\max_k |G_k(\\Delta t_j)| > 1\\,$。\n- 请注意，所有量必须以一致的单位处理。将 $\\,\\Delta t_{\\max}\\,$ 表示为以秒为单位的浮点数。\n\n您的程序必须处理以下测试套件。每个测试用例给出 $\\,L\\,$（长度单位）、$\\,N\\,$、$\\,D\\,$（平方长度每秒）以及一个确定 $\\,r\\,$ 的反应模型，连同两个探测时间步长 $\\,\\Delta t_1\\,$ 和 $\\,\\Delta t_2\\,$（秒）：\n- 测试用例 1（线性反应，负斜率）：$\\,L = 1.0\\,$, $\\,N = 64\\,$, $\\,D = 1.0 \\times 10^{-3}\\,$, $\\,f(u) = \\alpha u\\,$ 其中 $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$ 因此 $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$。\n- 测试用例 2（线性反应，r 相同但 D、N 不同）：$\\,L = 1.0\\,$, $\\,N = 257\\,$, $\\,D = 0.2\\,$, $\\,f(u) = \\alpha u\\,$ 其中 $\\,\\alpha = -10.0\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t_1 = 0.18\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.22\\,\\mathrm{s}\\,$。\n- 测试用例 3（线性反应，正斜率）：$\\,L = 1.0\\,$, $\\,N = 128\\,$, $\\,D = 0.01\\,$, $\\,f(u) = \\alpha u\\,$ 其中 $\\,\\alpha = +2.0\\,\\mathrm{s}^{-1}\\,$ 因此 $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 0.001\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.1\\,\\mathrm{s}\\,$。\n- 测试用例 4（稳定不动点处的逻辑斯谛反应）：$\\,L = 1.0\\,$, $\\,N = 100\\,$, $\\,D = 5.0 \\times 10^{-4}\\,$, $\\,f(u) = \\rho\\, u \\left(1 - \\dfrac{u}{K}\\right)\\,$ 其中 $\\,\\rho = 7.5\\,\\mathrm{s}^{-1}\\,$，在 $\\,u^\\star = K\\,$ 处线性化，因此 $\\,r = f'(K) = -\\rho\\,$, $\\,\\Delta t_1 = 0.25\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 0.28\\,\\mathrm{s}\\,$。\n- 测试用例 5（线性反应，弱负斜率）：$\\,L = 1.0\\,$, $\\,N = 32\\,$, $\\,D = 10.0\\,$, $\\,f(u) = \\alpha u\\,$ 其中 $\\,\\alpha = -0.1\\,\\mathrm{s}^{-1}\\,$ 因此 $\\,r = \\alpha\\,$, $\\,\\Delta t_1 = 10.0\\,\\mathrm{s}\\,$, $\\,\\Delta t_2 = 25.0\\,\\mathrm{s}\\,$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个长度为 $\\,5\\,$ 的顶层列表。每个条目本身是一个形式为 $[\\Delta t_{\\max}, s_1, s_2]$ 的列表，其中 $\\,\\Delta t_{\\max}\\,$ 是一个以秒为单位的浮点数，如果格式在 $\\,\\Delta t_1\\,$ 时是线性稳定的，则 $\\,s_1\\,$ 是一个等于 $\\,\\mathrm{True}\\,$ 的布尔值，否则为 $\\,\\mathrm{False}\\,$，如果格式在 $\\,\\Delta t_2\\,$ 时是线性不稳定的，则 $\\,s_2\\,$ 是一个等于 $\\,\\mathrm{True}\\,$ 的布尔值，否则为 $\\,\\mathrm{False}\\,$。例如，输出必须看起来像 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，条目之间用逗号分隔。", "solution": "该问题被验证为具有科学依据、适定且客观。它提出了一个偏微分方程数值分析中的标准任务，特别是在计算系统生物学领域，反应扩散模型在该领域普遍存在。参数和定义是完整且一致的。\n\n### 1. IMEX 格式的推导与相容性\n\n控制偏微分方程 (PDE) 是反应扩散方程 $\\partial_t u = D \\Delta u + f(u)$。我们的任务是在一维周期性域（长度为 $L$）上，使用包含 $N$ 个节点的均匀网格（网格间距为 $h=L/N$）对此方程进行离散化。\n\nPDE 的空间部分使用拉普拉斯算子的二阶中心差分进行离散化，得到常微分方程组 (ODE) 的半离散系统：\n$$\n\\frac{d u_i}{d t} = D (\\Delta_h u)_i + f(u_i) \\quad \\text{for } i=0, \\dots, N-1,\n$$\n其中 $u_i(t) \\approx u(x_i, t)$ 且 $(\\Delta_h u)_i = (u_{i+1} - 2u_i + u_{i-1})/h^2$。其向量形式为 $\\frac{d\\vec{u}}{dt} = D \\Delta_h \\vec{u} + \\vec{f}(\\vec{u})$，其中 $\\vec{u} = (u_0, \\dots, u_{N-1})^T$ 且 $\\vec{f}(\\vec{u}) = (f(u_0), \\dots, f(u_{N-1}))^T$。\n\n所期望的隐-显 (IMEX) 格式对刚性线性扩散项 ($D \\Delta_h \\vec{u}$) 进行隐式处理，对潜在非线性反应项 ($\\vec{f}(\\vec{u})$) 进行显式处理。这对应于对扩散项使用后向 Euler 方法，对反应项使用前向 Euler 方法。将此应用于从时间 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的半离散系统，我们将时间导数近似为 $(\\vec{u}^{n+1} - \\vec{u}^n)/\\Delta t$，在未来时间层级 $n+1$ 评估隐式项，在当前时间层级 $n$ 评估显式项：\n$$\n\\frac{\\vec{u}^{n+1} - \\vec{u}^n}{\\Delta t} = D \\Delta_h \\vec{u}^{n+1} + \\vec{f}(\\vec{u}^n).\n$$\n这构成了一个质量平衡，其中变化率被设定为隐式评估的扩散通量和显式评估的反应源项之和。重新整理方程，将未知项 $\\vec{u}^{n+1}$ 组合到左侧，得到：\n$$\n\\vec{u}^{n+1} - \\Delta t D \\Delta_h \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\n使用单位算子 $I$ 提出因子 $\\vec{u}^{n+1}$，我们得到所需的更新规则的矩阵形式：\n$$\n\\left(I - \\Delta t D \\Delta_h\\right) \\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\vec{f}(\\vec{u}^n).\n$$\n\n为了证明相容性，我们通过将精确解 $u(x_i, t_n)$ 代入有限差分方程来分析局部截断误差 $\\tau^n_i$：\n$$\n\\frac{u(x_i, t_{n+1}) - u(x_i, t_n)}{\\Delta t} = D \\Delta_h u(x_i, t_{n+1}) + f(u(x_i, t_n)).\n$$\n对于足够光滑的解 $u$，在 $(x_i, t_n)$ 附近使用泰勒展开：\n\\begin{itemize}\n    \\item $u(x_i, t_{n+1}) = u(x_i, t_n) + \\Delta t \\partial_t u + \\frac{(\\Delta t)^2}{2} \\partial_{tt} u + O((\\Delta t)^3)$。\n    \\item 左侧变为：$\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u + O((\\Delta t)^2)$。\n    \\item 对于右侧，离散拉普拉斯算子是连续拉普拉斯算子的二阶近似：$\\Delta_h \\phi(x_i) = \\partial_{xx} \\phi(x_i) + O(h^2)$。\n    \\item 因此，$D \\Delta_h u(x_i, t_{n+1}) = D (\\partial_{xx} u(x_i, t_{n+1}) + O(h^2)) = D (\\partial_{xx} u(x_i, t_n) + \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2) + O(h^2))$。\n\\end{itemize}\n截断误差是离散化 PDE 与精确 PDE $\\partial_t u - D \\partial_{xx} u - f(u) = 0$ 之间的差。代入展开式后，我们发现：\n$$\n\\tau_i^n = \\left(\\partial_t u + \\frac{\\Delta t}{2} \\partial_{tt} u \\right) - D\\left(\\partial_{xx} u + \\Delta t \\partial_{xx}\\partial_t u\\right) - f(u) + O((\\Delta t)^2) + O(D h^2).\n$$\n组合各项：\n$$\n\\tau_i^n = (\\partial_t u - D \\partial_{xx} u - f(u)) + \\frac{\\Delta t}{2} \\partial_{tt} u - D \\Delta t \\partial_{xx}\\partial_t u + O((\\Delta t)^2, h^2).\n$$\n第一个括号内的项为零。剩余的误差是 $\\tau_i^n = O(\\Delta t) + O(h^2)$。当 $\\Delta t \\to 0$ 和 $h \\to 0$ 时，截断误差消失。因此，该格式是相容的，具有时间上一阶精度和空间上二阶精度。\n\n### 2. 线性稳定性分析\n\n我们围绕一个空间均匀稳态 $u^\\star$（其中 $f(u^\\star) = 0$）分析格式的稳定性。令 $\\vec{u}^n = \\vec{u}^\\star + \\delta\\vec{u}^n$，其中 $\\vec{u}^\\star$ 是所有分量都等于 $u^\\star$ 的向量，$\\delta\\vec{u}^n$ 是一个小扰动。反应项线性化为 $f(u_i^n) \\approx f(u^\\star) + f'(u^\\star)\\delta u_i^n = r \\delta u_i^n$。代入格式中：\n$$\n(I - \\Delta t D \\Delta_h) (\\vec{u}^\\star + \\delta\\vec{u}^{n+1}) = (\\vec{u}^\\star + \\delta\\vec{u}^n) + \\Delta t \\vec{f}(\\vec{u}^\\star + \\delta\\vec{u}^n).\n$$\n使用线性化并注意到由于 $\\vec{u}^\\star$ 是常数，$\\Delta_h \\vec{u}^\\star = \\vec{0}$：\n$$\n\\vec{u}^\\star + (I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = \\vec{u}^\\star + \\delta\\vec{u}^n + \\Delta t r \\delta\\vec{u}^n.\n$$\n稳态 $\\vec{u}^\\star$ 消去，得到扰动的演化方程：\n$$\n(I - \\Delta t D \\Delta_h) \\delta\\vec{u}^{n+1} = (1 + r \\Delta t) \\delta\\vec{u}^n.\n$$\n为了进行 von Neumann 稳定性分析，我们将扰动 $\\delta\\vec{u}^n$ 分解为离散傅里叶模态 $\\vec{\\varphi}_k$，这些模态是循环矩阵 $\\Delta_h$ 的特征向量。令 $\\delta\\vec{u}^n = \\sum_{k=0}^{N-1} \\hat{u}_k^n \\vec{\\varphi}_k$。由于 $\\Delta_h \\vec{\\varphi}_k = \\lambda_k \\vec{\\varphi}_k$，将展开式代入扰动方程并利用线性性，使我们能够独立分析每个模态：\n$$\n(1 - \\Delta t D \\lambda_k) \\hat{u}_k^{n+1} \\vec{\\varphi}_k = (1 + r \\Delta t) \\hat{u}_k^n \\vec{\\varphi}_k.\n$$\n模态 $k$ 的放大因子为 $G_k(\\Delta t) = \\hat{u}_k^{n+1}/\\hat{u}_k^n$，由下式给出：\n$$\nG_k(\\Delta t) = \\frac{1 + r \\Delta t}{1 - \\Delta t D \\lambda_k}.\n$$\n为了线性稳定性，我们要求所有模态的放大因子的模不大于 1，即 $\\max_{k} |G_k(\\Delta t)| \\le 1$。特征值由 $\\lambda_k = -\\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{N})$ 给出，它们是实数且非正（$\\lambda_k \\le 0$）。因为 $D>0$ 和 $\\Delta t>0$，分母 $1 - \\Delta t D \\lambda_k$ 总是实数且大于或等于 $1$。放大因子的模为：\n$$\n|G_k(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - \\Delta t D \\lambda_k}.\n$$\n分子与模态指数 $k$ 无关。为了最大化 $|G_k(\\Delta t)|$，我们必须最小化分母 $1 - \\Delta t D \\lambda_k$。这发生在 $\\lambda_k$ 最大（负得最少）时，对应于模态 $k=0$，此时 $\\lambda_0 = 0$。因此，最坏情况（最大）放大因子是：\n$$\n\\max_{k} |G_k(\\Delta t)| = |G_0(\\Delta t)| = \\frac{|1 + r \\Delta t|}{1 - 0} = |1 + r \\Delta t|.\n$$\n这表明此 IMEX 格式的稳定性仅由反应项的显式处理决定，而与扩散系数 $D$ 和空间离散化 $h$ 无关。稳定性条件简化为 $|1 + r \\Delta t| \\le 1$。这等价于不等式 $-1 \\le 1 + r \\Delta t \\le 1$，可简化为 $-2 \\le r \\Delta t \\le 0$。\n\n现在我们根据 $r = f'(u^\\star)$ 的符号确定最大稳定时间步长 $\\Delta t_{\\max}$：\n\\begin{itemize}\n    \\item 情况 $r > 0$（不稳定反应）：由于 $\\Delta t > 0$, $r \\Delta t > 0$。条件 $r \\Delta t \\le 0$ 仅在 $\\Delta t = 0$ 时成立。对于任何 $\\Delta t > 0$，格式都是无条件不稳定的。因此, $\\Delta t_{\\max} = 0$。\n    \\item 情况 $r = 0$（中性稳定反应）：条件变为 $-2 \\le 0 \\le 0$，这总是成立。格式是无条件稳定的。因此, $\\Delta t_{\\max} = \\infty$。\n    \\item 情况 $r < 0$（稳定反应）：由于 $r$ 是负数，对于 $\\Delta t \\ge 0$, $r \\Delta t \\le 0$ 总是成立。剩下的条件是 $-2 \\le r \\Delta t$。除以负值 $r$ 会使不等式反向：$\\Delta t \\le -2/r$。因此，最大稳定时间步长是 $\\Delta t_{\\max} = -2/r$。\n\\end{itemize}\n\n### 3. 实现与可测试输出\n\n该实现使用推导出的公式计算 $\\Delta t_{\\max}$。然后，它通过检查最大放大因子 $|G_0(\\Delta t_j)| = |1 + r \\Delta t_j|$ 是否小于或等于 $1$ 来评估两个给定时间步长 $\\Delta t_1$ 和 $\\Delta t_2$ 的稳定性。分析表明，最坏情况的放大因子简化为与 $\\lambda_k$ 无关，因此参数 $L$、$N$ 和 $D$ 不影响此特定 IMEX 格式的线性稳定性。程序按规定为每个测试用例计算 $\\Delta t_{\\max}$ 和两个布尔稳定性/不稳定性指标。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n\n    def analyze_stability(L, N, D, r, dt1, dt2):\n        \"\"\"\n        Analyzes the stability of the IMEX scheme for a given set of parameters.\n\n        Args:\n            L (float): Domain length.\n            N (int): Number of grid nodes.\n            D (float): Diffusion coefficient.\n            r (float): Linearized reaction rate f'(u*).\n            dt1 (float): First test time step.\n            dt2 (float): Second test time step.\n\n        Returns:\n            list: A list containing [dt_max, s1, s2], where dt_max is the\n                  maximum stable time step, s1 is a boolean for stability at dt1,\n                  and s2 is a boolean for instability at dt2.\n        \"\"\"\n        # Part 1: Compute the maximum linearly stable time step (dt_max).\n        # The stability is governed by |1 + r*dt| <= 1, which means -2 <= r*dt <= 0.\n        if r > 0:\n            # Unconditionally unstable as r*dt > 0 cannot satisfy r*dt <= 0.\n            dt_max = 0.0\n        elif r == 0:\n            # Unconditionally stable as -2 <= 0 <= 0 is always true.\n            dt_max = np.inf\n        else:  # r < 0\n            # Condition simplifies to dt <= -2/r.\n            dt_max = -2.0 / r\n\n        # Part 2: Evaluate stability for dt1 and instability for dt2.\n        # The maximum amplification factor over all modes k is |G_0(dt)| = |1 + r*dt|.\n        # We don't need to compute eigenvalues as the k=0 mode is always the worst case.\n\n        # Check stability at dt1: max|G_k(dt1)| <= 1\n        max_amp_factor_1 = abs(1.0 + r * dt1)\n        is_stable_at_dt1 = max_amp_factor_1 <= 1.0\n\n        # Check instability at dt2: max|G_k(dt2)| > 1\n        max_amp_factor_2 = abs(1.0 + r * dt2)\n        is_unstable_at_dt2 = max_amp_factor_2 > 1.0\n\n        return [dt_max, is_stable_at_dt1, is_unstable_at_dt2]\n\n    test_cases = [\n        # Case 1: L=1.0, N=64, D=1.0e-3, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 64, 1.0e-3, -10.0, 0.18, 0.22),\n        # Case 2: L=1.0, N=257, D=0.2, r=-10.0, dt1=0.18, dt2=0.22\n        (1.0, 257, 0.2, -10.0, 0.18, 0.22),\n        # Case 3: L=1.0, N=128, D=0.01, r=2.0, dt1=0.001, dt2=0.1\n        (1.0, 128, 0.01, 2.0, 0.001, 0.1),\n        # Case 4: L=1.0, N=100, D=5e-4, r=-7.5, dt1=0.25, dt2=0.28\n        (1.0, 100, 5.0e-4, -7.5, 0.25, 0.28),\n        # Case 5: L=1.0, N=32, D=10.0, r=-0.1, dt1=10.0, dt2=25.0\n        (1.0, 32, 10.0, -0.1, 10.0, 25.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_stability(*case)\n        # For the final output, np.inf should be represented as \"inf\" as per typical JSON/list representation.\n        if result[0] == np.inf:\n            result[0] = float('inf')\n        # Ensure booleans are standard True/False\n        result[1] = bool(result[1])\n        result[2] = bool(result[2])\n        results.append(result)\n    \n    # Format according to the required output string.\n    # The requirement is a single line, list of lists.\n    # The default string representation of lists in Python is exactly this.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3335951"}]}