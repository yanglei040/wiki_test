{"hands_on_practices": [{"introduction": "确定一个代谢反应在细胞内的实际方向，是热力学分析的核心。本练习将引导你应用吉布斯自由能的基本方程，计算在特定细胞内代谢物浓度下，糖酵解途径中一个关键反应的实际反应吉布斯自由能变 $\\Delta_{r} G$，并判断其正向流是否在热力学上可行。通过这个计算，你将掌握连接标准态能量、反应商和实际能量变化的核心技能。", "problem": "糖酵解的一个核心步骤通过反应 3-磷酸甘油醛 (G3P) $+$ 无机磷酸 (Pi) $+$ 氧化型烟酰胺腺嘌呤二核苷酸 (NAD$^{+}$) $\\rightarrow$ 1,3-二磷酸甘油酸 (1,3-BPG) $+$ 还原型烟酰胺腺嘌呤二核苷酸 (NADH)，将一个氧化反应与一个高能酰基磷酸的形成相耦合。考虑该反应在细胞溶质中进行，温度 $T = 310 \\ \\mathrm{K}$，pH 缓冲在 $7$，水活度近似为 1，因此适用转换后的标准态。假设活度可以很好地用归一化到 $1 \\ \\mathrm{M}$ 标准态的浓度来近似（活度系数接近于 $1$），并取在这些条件下转换后的标准平衡常数为 $K^{\\circ \\prime} = 0.10$（无量纲）。\n\n代谢物浓度为：\n- $[ \\mathrm{G3P} ] = 5.0 \\times 10^{-4} \\ \\mathrm{M}$，\n- $[ \\mathrm{Pi} ] = 2.0 \\times 10^{-2} \\ \\mathrm{M}$，\n- $[ \\mathrm{NAD}^{+} ] = 1.0 \\times 10^{-3} \\ \\mathrm{M}$，\n- $[ \\mathrm{1,3\\text{-}BPG} ] = 1.0 \\times 10^{-6} \\ \\mathrm{M}$，\n- $[ \\mathrm{NADH} ] = 1.0 \\times 10^{-5} \\ \\mathrm{M}$。\n\n使用将反应的吉布斯能与化学势、平衡常数和活度联系起来的基本热力学关系，计算在这些非平衡条件下的反应吉布斯能 $\\Delta_{r} G$。使用理想气体常数 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$。然后，根据基于热力学的通量分析 (TFA) 的约束条件（即非零正向通量要求 $\\Delta_{r} G  0$），判断正向代谢通量在热力学上是否是允许的。\n\n以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位表示 $\\Delta_{r} G$，并将您的数值答案四舍五入到四位有效数字。", "solution": "该问题已根据所需标准进行验证。\n\n### 步骤1：提取已知条件\n- **反应**：3-磷酸甘油醛 (G3P) $+$ 无机磷酸 (Pi) $+$ 氧化型烟酰胺腺嘌呤二核苷酸 (NAD$^{+}$) $\\rightarrow$ 1,3-二磷酸甘油酸 (1,3-BPG) $+$ 还原型烟酰胺腺嘌呤二核苷酸 (NADH)\n- **温度**：$T = 310 \\ \\mathrm{K}$\n- **pH**：$7$\n- **水活度**：近似为 1\n- **状态**：适用转换后的标准态\n- **近似**：活度由归一化到 $1 \\ \\mathrm{M}$ 标准态的浓度来近似。\n- **转换后的标准平衡常数**：$K^{\\circ \\prime} = 0.10$ (无量纲)\n- **浓度**：\n  - $[\\mathrm{G3P}] = 5.0 \\times 10^{-4} \\ \\mathrm{M}$\n  - $[\\mathrm{Pi}] = 2.0 \\times 10^{-2} \\ \\mathrm{M}$\n  - $[\\mathrm{NAD}^{+}] = 1.0 \\times 10^{-3} \\ \\mathrm{M}$\n  - $[\\text{1,3-BPG}] = 1.0 \\times 10^{-6} \\ \\mathrm{M}$\n  - $[\\mathrm{NADH}] = 1.0 \\times 10^{-5} \\ \\mathrm{M}$\n- **理想气体常数**：$R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$\n- **约束条件**：非零正向通量要求 $\\Delta_{r} G  0$。\n- **要求输出**：反应吉布斯能 $\\Delta_{r} G$（以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位，四舍五入到四位有效数字），以及判断正向通量在热力学上是否允许。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据、问题明确且客观。它提供了一套完整且一致的数据，用于解决生物化学热力学中的一个标准问题。该反应是糖酵解中一个众所周知的一步，所提供的浓度在生理上是合理的，温度也是人体的典型温度。问题要求计算非平衡条件下的反应吉布斯能，这是一个基本概念。所有必要的常数和条件都已提供，没有矛盾、歧义或违反科学原理之处。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解决方案。\n\n化学反应可以写为：\n$$\n\\mathrm{G3P} + \\mathrm{Pi} + \\mathrm{NAD}^{+} \\rightleftharpoons \\mathrm{1,3\\text{-}BPG} + \\mathrm{NADH}\n$$\n在非平衡条件下，反应吉布斯能 $\\Delta_{r} G$ 通过基本热力学关系与转换后的标准反应吉布斯能 $\\Delta_{r} G^{\\circ \\prime}$ 和反应商 $Q^{\\prime}$ 相关联：\n$$\n\\Delta_{r} G = \\Delta_{r} G^{\\circ \\prime} + RT \\ln Q^{\\prime}\n$$\n转换后的标准吉布斯能 $\\Delta_{r} G^{\\circ \\prime}$ 可以使用以下方程，根据给定的转换后标准平衡常数 $K^{\\circ \\prime}$ 计算得出：\n$$\n\\Delta_{r} G^{\\circ \\prime} = -RT \\ln K^{\\circ \\prime}\n$$\n将第二个方程代入第一个方程，得到 $\\Delta_r G$、$Q^{\\prime}$ 和 $K^{\\circ \\prime}$ 之间的直接关系：\n$$\n\\Delta_{r} G = -RT \\ln K^{\\circ \\prime} + RT \\ln Q^{\\prime} = RT \\ln \\left( \\frac{Q^{\\prime}}{K^{\\circ \\prime}} \\right)\n$$\n反应商 $Q^{\\prime}$ 是根据给定的反应物和产物的非平衡浓度计算的。问题指明活度可以用摩尔浓度来近似。对于给定的反应，$Q^{\\prime}$ 是：\n$$\nQ^{\\prime} = \\frac{[\\mathrm{1,3\\text{-}BPG}] [\\mathrm{NADH}]}{[\\mathrm{G3P}] [\\mathrm{Pi}] [\\mathrm{NAD}^{+}]}\n$$\n代入给定的浓度值：\n$$\nQ^{\\prime} = \\frac{(1.0 \\times 10^{-6}) (1.0 \\times 10^{-5})}{(5.0 \\times 10^{-4}) (2.0 \\times 10^{-2}) (1.0 \\times 10^{-3})}\n$$\n$$\nQ^{\\prime} = \\frac{1.0 \\times 10^{-11}}{1.0 \\times 10^{-8}} = 1.0 \\times 10^{-3}\n$$\n反应商 $Q^{\\prime}$ 是无量纲的，因为它在形式上是活度的比值，而活度本身是无量纲的（浓度归一化到 $1 \\ \\mathrm{M}$ 标准态）。\n\n现在，我们可以使用推导出的表达式来计算 $\\Delta_{r} G$。给定值为 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$，$T = 310 \\ \\mathrm{K}$，$K^{\\circ \\prime} = 0.10$，我们计算出 $Q^{\\prime} = 1.0 \\times 10^{-3}$。\n$$\n\\Delta_{r} G = (8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}) (310 \\ \\mathrm{K}) \\ln \\left( \\frac{1.0 \\times 10^{-3}}{0.10} \\right)\n$$\n$$\n\\Delta_{r} G = (2577.48341... \\ \\mathrm{J \\ mol^{-1}}) \\ln(1.0 \\times 10^{-2})\n$$\n自然对数 $\\ln(1.0 \\times 10^{-2})$ 约等于 $-4.605170186...$。\n$$\n\\Delta_{r} G \\approx (2577.48341... \\ \\mathrm{J \\ mol^{-1}}) \\times (-4.605170186...)\n$$\n$$\n\\Delta_{r} G \\approx -11869.608 \\ \\mathrm{J \\ mol^{-1}}\n$$\n问题要求答案以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位。为了转换单位，我们除以 $1000$：\n$$\n\\Delta_{r} G \\approx -11.869608 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\n将该值四舍五入到四位有效数字，得到：\n$$\n\\Delta_{r} G \\approx -11.87 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\n问题的第二部分要求判断正向代谢通量在热力学上是否是允许的。给出的标准是，非零正向通量要求 $\\Delta_{r} G  0$。\n由于我们计算出的值为 $\\Delta_{r} G = -11.87 \\ \\mathrm{kJ \\ mol^{-1}}$，小于 $0$，因此正向反应在热力学上是自发的，在这些细胞条件下，正向通量是允许的。", "answer": "$$\\boxed{-11.87}$$", "id": "3355483"}, {"introduction": "细胞通过能量偶联机制，利用高能化合物（如ATP）水解释放的能量来驱动热力学上不利的过程。本练习模拟了一个典型的生物能量学问题：计算在真实的细胞质浓度下ATP水解所能释放的吉布斯自由能，并评估这部分能量是否足以驱动一个需要消耗特定能量的离子转运过程。这项实践将加深你对细胞如何利用“能量货币”维持生命活动的理解。", "problem": "三磷酸腺苷（ATP）水解提供化学功来驱动细胞过程。在 pH 为 $7$ 的转换生化标准状态下（水活度恒定且质子被缓冲），物质 $i$ 的化学势定义为 $ \\mu_{i} = \\mu_{i}^{\\circ'} + R T \\ln a_{i} $，其中 $ \\mu_{i}^{\\circ'} $ 是转换标准化学势，$ R $ 是通用气体常数，$ T $ 是绝对温度，$ a_{i} $ 是物质 $ i $ 的活度。反应的吉布斯自由能为 $ \\Delta G = \\sum_{i} \\nu_{i} \\mu_{i} $，其中 $ \\nu_{i} $ 是化学计量系数。对于在这些生化条件下的转换 ATP 水解反应，其转换标准吉布斯自由能为 $ \\Delta G^{\\circ'} $。\n\n给定以下测得的胞质浓度，为本次计算目的，假设其均匀且不随时间变化：\n- $[\\mathrm{ATP}] = 4.2\\,\\mathrm{mM}$，\n- $[\\mathrm{ADP}] = 22\\,\\mathrm{\\mu M}$，\n- $[P_{i}] = 0.77\\,\\mathrm{mM}$，\n\n以及温度 $ T = 310\\,\\mathrm{K} $。假设活度系数为1，因此活度可以用单位为 $\\mathrm{M}$ 的浓度来近似，这与转换生化标准状态一致。使用在 $ T = 310\\,\\mathrm{K} $ 时 ATP 水解的转换标准吉布斯自由能 $ \\Delta G_{\\mathrm{ATP}}^{\\circ'} = -30.5\\,\\mathrm{kJ\\,mol^{-1}} $（对于典型胞质离子强度下的镁络合物种）。一个转运蛋白通过水解一个 ATP 分子来完成单个转运循环，耦合完美且无滑移。在给定的细胞外和细胞内条件下，该转运过程每个循环需要最小吉布斯自由能输入 $ \\Delta G_{\\mathrm{req}} = +52\\,\\mathrm{kJ\\,mol^{-1}} $。\n\n从以上定义出发，计算在给定细胞内浓度和温度下 ATP 水解的转换吉布斯自由能 $ \\Delta G_{\\mathrm{ATP}} $。然后，基于每个循环一次 ATP 水解的能量耦合，评估该转运蛋白在这些条件下是否能够运行。\n\n将您的最终答案表示为一个行矩阵，其中包含：\n- $ \\Delta G_{\\mathrm{ATP}} $ 的数值，单位为 $\\mathrm{kJ\\,mol^{-1}}$，四舍五入到四位有效数字，以及\n- 一个可行性指标，其中 $1$ 表示操作可行，$0$ 表示操作不可行。\n\n使用自然对数。以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位提供能量。", "solution": "该问题要求在指定的细胞内条件下，计算 ATP 水解的转换吉布斯自由能 $\\Delta G_{\\mathrm{ATP}}$，并评估该能量是否足以驱动一个转运过程。\n\n在非标准条件下的反应转换吉布斯自由能（$\\Delta G$）与转换标准吉布斯自由能（$\\Delta G^{\\circ'}$）之间的基本关系由以下方程给出：\n$$ \\Delta G = \\Delta G^{\\circ'} + R T \\ln Q $$\n其中 $R$ 是通用气体常数，$T$ 是绝对温度，$Q$ 是反应商。\n\n对于 ATP 的水解，在转换生化标准状态下的反应表示为：\n$$ \\mathrm{ATP} \\rightleftharpoons \\mathrm{ADP} + \\mathrm{P}_i $$\n相应的反应商 $Q$ 以产物和反应物的活度来定义。\n$$ Q = \\frac{a_{\\mathrm{ADP}} \\cdot a_{\\mathrm{P}_i}}{a_{\\mathrm{ATP}}} $$\n问题陈述假设活度系数为1，因此活度（$a_i$）可以用摩尔浓度（$[i]$）来近似。浓度的标准状态是 $1\\,\\mathrm{M}$。因此，我们必须将给定的浓度从毫摩尔（$\\mathrm{mM}$）和微摩尔（$\\mathrm{\\mu M}$）转换为摩尔（$\\mathrm{M}$）。\n\n给定的浓度是：\n- $[\\mathrm{ATP}] = 4.2\\,\\mathrm{mM} = 4.2 \\times 10^{-3}\\,\\mathrm{M}$\n- $[\\mathrm{ADP}] = 22\\,\\mathrm{\\mu M} = 22 \\times 10^{-6}\\,\\mathrm{M}$\n- $[P_{i}] = 0.77\\,\\mathrm{mM} = 0.77 \\times 10^{-3}\\,\\mathrm{M}$\n\n将这些值代入 $Q$ 的表达式中：\n$$ Q = \\frac{(22 \\times 10^{-6}) \\cdot (0.77 \\times 10^{-3})}{4.2 \\times 10^{-3}} = \\frac{1.694 \\times 10^{-8}}{4.2 \\times 10^{-3}} \\approx 4.0333 \\times 10^{-6} $$\n$Q$ 的值是无量纲的，因为每个浓度都隐式地除以了 $1\\,\\mathrm{M}$ 的标准态浓度。\n\n接下来，我们计算 $R T \\ln Q$ 这一项。给定的参数是：\n- $\\Delta G_{\\mathrm{ATP}}^{\\circ'} = -30.5\\,\\mathrm{kJ\\,mol^{-1}}$\n- $T = 310\\,\\mathrm{K}$\n我们使用通用气体常数的值 $R = 8.314\\,\\mathrm{J\\,mol^{-1}K^{-1}}$，必须将其转换为 $\\mathrm{kJ\\,mol^{-1}K^{-1}}$ 以便与 $\\Delta G_{\\mathrm{ATP}}^{\\circ'}$ 的单位保持一致。\n$$ R = 8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}K^{-1}} $$\n现在，我们计算 $\\Delta G_{\\mathrm{ATP}}$：\n$$ \\Delta G_{\\mathrm{ATP}} = \\Delta G_{\\mathrm{ATP}}^{\\circ'} + R T \\ln Q $$\n$$ \\Delta G_{\\mathrm{ATP}} = -30.5\\,\\mathrm{kJ\\,mol^{-1}} + (8.314 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}K^{-1}}) \\times (310\\,\\mathrm{K}) \\times \\ln(4.0333 \\times 10^{-6}) $$\n$$ \\Delta G_{\\mathrm{ATP}} \\approx -30.5 + (2.57734) \\times (-12.4215)\\,\\mathrm{kJ\\,mol^{-1}} $$\n$$ \\Delta G_{\\mathrm{ATP}} \\approx -30.5 - 32.0105\\,\\mathrm{kJ\\,mol^{-1}} $$\n$$ \\Delta G_{\\mathrm{ATP}} \\approx -62.5105\\,\\mathrm{kJ\\,mol^{-1}} $$\n根据要求，将结果四舍五入到四位有效数字：\n$$ \\Delta G_{\\mathrm{ATP}} = -62.51\\,\\mathrm{kJ\\,mol^{-1}} $$\n这是最终答案的第一部分。\n\n对于第二部分，我们必须确定转运蛋白是否可以运行。一个 ATP 分子的水解释放的能量等于 $-\\Delta G_{\\mathrm{ATP}}$。\n$$ \\text{Energy released} = -(-62.51\\,\\mathrm{kJ\\,mol^{-1}}) = 62.51\\,\\mathrm{kJ\\,mol^{-1}} $$\n转运蛋白需要的最小能量输入为 $\\Delta G_{\\mathrm{req}} = +52\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n为了使耦合过程在热力学上可行，总的吉布斯自由能变化 $\\Delta G_{\\mathrm{total}}$ 必须为负（$\\Delta G_{\\mathrm{total}}  0$）。\n$$ \\Delta G_{\\mathrm{total}} = \\Delta G_{\\mathrm{ATP}} + \\Delta G_{\\mathrm{req}} $$\n$$ \\Delta G_{\\mathrm{total}} = -62.51\\,\\mathrm{kJ\\,mol^{-1}} + 52\\,\\mathrm{kJ\\,mol^{-1}} = -10.51\\,\\mathrm{kJ\\,mol^{-1}} $$\n由于 $\\Delta G_{\\mathrm{total}}$ 为负，整个耦合反应是自发的。或者，我们可以比较释放的能量大小与所需的能量大小：\n$$ |\\Delta G_{\\mathrm{ATP}}| = 62.51\\,\\mathrm{kJ\\,mol^{-1}} $$\n$$ \\Delta G_{\\mathrm{req}} = 52\\,\\mathrm{kJ\\,mol^{-1}} $$\n由于 $62.51\\,\\mathrm{kJ\\,mol^{-1}} > 52\\,\\mathrm{kJ\\,mol^{-1}}$，ATP 水解提供的能量足以驱动转运过程。因此，操作是可行的。可行性指标是 $1$。", "answer": "$$\\boxed{\\begin{pmatrix} -62.51  1 \\end{pmatrix}}$$", "id": "3355541"}, {"introduction": "在系统层面，热力学约束不仅作用于单个反应，还影响整个代谢网络的行为。一个关键挑战是识别并消除“无效循环”(futile cycles)——即那些在不产生任何净物质转换的情况下仅消耗能量的反应环路。本练习将指导你设计并实施一个基于线性规划的计算测试，以在代谢网络中检测这类由热力学驱动的无效循环，并量化消除这些循环对模型优化目标的影响，这是确保代谢模型物理真实性的高级应用。", "problem": "考虑一个处于稳态假设下的代谢网络，其中化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 编码了 $m$ 种代谢物和 $n$ 个反应的质量守恒，通量向量 $v \\in \\mathbb{R}^n$ 满足 $S v = 0$。每个反应 $r$ 都有一个相关的吉布斯自由能变（记为 $\\Delta G_r$），单位为 $\\mathrm{kJ/mol}$。在此，一个隐藏的无效循环被定义为一个非零通量向量 $v \\ne 0$，它满足 $S v = 0$ 且总能量耗散 $\\sum_{r=1}^n v_r \\Delta G_r  0$，同时遵守规定的反应可逆性约束。这种向量的存在意味着网络中存在不产生代谢物净转化的内部能量耗散通量回路，这可能会影响通量平衡分析（Flux Balance Analysis, FBA）中的优化结果。\n\n从稳态质量守恒 $S v = 0$ 和热力学第二定律（Clausius 不等式）出发，设计一个计算测试来检测隐藏的无效循环，然后在优化问题中添加一个热力学不等式约束来消除这些循环。热力学第二定律要求可行的自发方向会降低吉布斯自由能（即，如果没有耦合约束，正向通量 $v_r  0$ 要求 $\\Delta G_r  0$）。量化添加此约束后对最优目标值的影响。\n\n您的程序必须实现以下两个部分：\n\n1) 隐藏无效循环检测。构建并求解一个线性规划（Linear Programming, LP）问题，该问题在归一化约束 $\\sum_{r=1}^n |v_r| = 1$ 和反应方向性边界下，寻找 $v \\ne 0$ 且 $S v = 0$ 的解，以最小化能量总和 $\\sum_{r=1}^n v_r \\Delta G_r$，并在指定情况下强制执行仅正向不可逆性。报告最小值是否严格小于 $0$（使用 $10^{-9}$ 的数值公差），这表示存在隐藏的无效循环。\n\n2) 热力学消除对能量耗散目标的影响。考虑一个目标 $J(v) = -\\sum_{r=1}^n v_r \\Delta G_r$，单位为 $\\mathrm{kJ/mol}$，在 $S v = 0$ 和通量边界下待最大化。计算没有热力学消除时的最优值 $J_{\\mathrm{pre}}$。然后添加线性不等式约束 $\\sum_{r=1}^n v_r \\Delta G_r \\ge 0$ 来消除能量耗散循环，并计算新的最优值 $J_{\\mathrm{post}}$。报告 $J_{\\mathrm{pre}}$ 和 $J_{\\mathrm{post}}$（单位 $\\mathrm{kJ/mol}$），以及定义为 $J_{\\mathrm{pre}} - J_{\\mathrm{post}}$ 的影响（单位 $\\mathrm{kJ/mol}$）。如果在添加约束后不存在可行解，则影响应报告为浮点数“非数字”（NaN）。\n\n所有优化问题都必须以纯数学术语提出和求解。具体而言：\n- 对稳态使用等式约束（$S v = 0$）。\n- 归一化约束 $\\sum_{r=1}^n |v_r| = 1$ 仅用于检测 LP。\n- 对 $J(v)$ 的优化使用反应通量的显式下界和上界。\n- 在指定情况下，通过限制 $v_r$ 的符号来强制不可逆性。\n\n通过变量拆分 $v = v^+ - v^-$（其中 $v^+, v^- \\ge 0$）来实现检测 LP，这样 $\\sum_{r=1}^n |v_r| = \\sum_{r=1}^n (v_r^+ + v_r^-)$ 成为一个线性等式，$S v = 0$ 变为 $S v^+ - S v^- = 0$，而不可逆性 $v_r \\ge 0$ 通过固定 $v_r^- = 0$ 来表示。\n\n测试套件。使用以下三个测试用例，每个用例具有相同的 $S$ 但不同的 $\\Delta G$ 向量。在所有情况下，目标优化的通量边界为 $0 \\le v_r \\le 3$（无量纲的缩放通量单位），且反应是仅正向不可逆的。\n\n- 案例 1（存在能量耗散循环）：\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  -10 \\\\\n  -5 \\\\\n  -7\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n- 案例 2（不存在能量耗散循环；回路周围净能量为正）：\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  20 \\\\\n  -5 \\\\\n  -7\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n- 案例 3（接近热力学中性；回路周围净能量在数值公差范围内为零）：\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  -0.001 \\\\\n  -0.001 \\\\\n  0.002\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n\n输出要求：\n- 对于每个测试用例，生成一个列表 $[b, J_{\\mathrm{pre}}, J_{\\mathrm{post}}, \\Delta J]$，其中 $b$ 是一个布尔值，表示是否检测到隐藏循环；$J_{\\mathrm{pre}}$ 是添加热力学不等式前 $J(v)$ 的最优值；$J_{\\mathrm{post}}$ 是添加不等式后的最优值；$\\Delta J = J_{\\mathrm{pre}} - J_{\\mathrm{post}}$。\n- 所有与能量相关的量都必须以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到六位小数的实数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3}]$），其中每个 $\\text{resulti}$ 本身都是上述格式的列表。\n\n不应读取任何用户输入；所有参数都作为常量嵌入在程序中。使用 Scientific Python (SciPy) 的线性规划工具 `scipy.optimize.linprog` 和 Numerical Python (NumPy) 进行线性代数运算。通过严格执行所述约束并使用指定的单位报告能量相关输出来确保科学真实性。", "solution": "该问题要求开发一种计算方法，以检测并减轻代谢网络模型中由热力学驱动的隐藏无效循环的影响。解决方案分为两部分：首先，为循环检测构建一个线性规划（LP）问题；其次，构建 LP 来量化热力学约束对给定优化目标的影响。\n\n### 基本原理\n\n处于稳态的代谢网络受质量守恒定律支配，表示为 $S v = 0$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是 $m$ 种代谢物和 $n$ 个反应的化学计量矩阵，$v \\in \\mathbb{R}^n$ 是反应通量向量。$S$ 的零空间，记为 $\\mathrm{ker}(S)$，包含所有满足稳态条件的通量向量。\n\n热力学第二定律对自发过程的方向施加了约束。对于一个化学反应 $r$，吉布斯自由能变 $\\Delta G_r$ 决定了其自发性。网络中吉布斯自由能的总耗散率由 $\\sum_{r=1}^n v_r \\Delta G_r$ 给出。对于任何自发过程，该总和必须为负（$\\sum v_r \\Delta G_r  0$）。\n\n一个无效循环是一个非零通量向量 $v \\in \\mathrm{ker}(S)$ ($v \\neq 0$)，对应于网络中的一个内部回路。如果这样的循环在热力学上也是有利的（即 $\\Delta G^T v  0$），它代表了一条耗散能量但没有生物质或其他目标分子净生成的途径。这可能导致在像通量平衡分析（FBA）这样的优化框架中出现不切实际的解，因为目标函数可能会利用这种能量耗散来达到人为的高值。\n\n给定的化学计量矩阵是：\n$$\nS = \\begin{bmatrix}\n-1  0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{{bmatrix}\n$$\n$S$ 的零空间由向量 $v$ 组成，其中 $v_1 = v_2 = v_3$。该零空间的一个基是向量 $[1, 1, 1]^T$。因此，该网络中代表一个循环的任何通量向量的形式都为 $v = k \\cdot [1, 1, 1]^T$，其中 $k$ 是某个标量。\n\n### 第 1 部分：隐藏无效循环检测\n\n为了检测隐藏的无效循环，我们寻找一个满足稳态条件 $S v = 0$、遵守反应方向性并最小化吉布斯自由能耗散率 $\\Delta G^T v$ 的非平凡通量向量 $v \\neq 0$。一个严格为负的最小值表示存在一个热力学上可行的无效循环。\n\n该问题被构建为以下 LP：\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  Z_1 = \\sum_{r=1}^n v_r \\Delta G_r = \\Delta G^T v \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n \\sum_{r=1}^n |v_r| = 1 \\\\\n v_r \\ge 0, \\quad \\text{对所有 } r=1, \\dots, n\n\\end{aligned}\n$$\n归一化约束 $\\sum_{r=1}^n |v_r| = 1$ 确保了非平凡解（$v \\neq 0$）并使 LP 有界。由于测试用例指定所有反应都是仅正向不可逆的（$v_r \\ge 0$），绝对值得以简化，约束变为 $\\sum_{r=1}^n v_r = 1$。\n\n问题指出，应使用变量拆分来实现 LP，其中每个通量 $v_r$ 被拆分为一个正向分量 $v_r^+$ 和一个反向分量 $v_r^-$，使得 $v_r = v_r^+ - v_r^-$ 且 $v_r^+, v_r^- \\ge 0$。LP 随后采用以下通用形式：\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  \\sum_{r=1}^n (v_r^+ \\Delta G_r - v_r^- \\Delta G_r) = [\\Delta G^T, -\\Delta G^T] \\begin{bmatrix} v^+ \\\\ v^- \\end{bmatrix} \\\\\n\\text{约束条件} \\quad  S v^+ - S v^- = 0 \\\\\n \\sum_{r=1}^n (v_r^+ + v_r^-) = 1 \\\\\n v_r^+, v_r^- \\ge 0, \\quad \\text{对所有 } r\n\\end{aligned}\n$$\n对于给定的测试用例，所有反应都是不可逆的，因此 $v_r \\ge 0$。这通过为所有 $r$ 设置 $v_r^- = 0$ 来强制执行。该公式简化回只涉及 $v$（对应于 $v^+$）的形式。如果最优值 $Z_{1,opt}  -10^{-9}$，则检测到无效循环。\n\n对于特定的 $S$ 矩阵，其中 $v = k[1, 1, 1]^T$，约束 $\\sum v_r = 1$ 意味着 $3k=1$，所以 $k=1/3$。唯一的可行点是 $v = [1/3, 1/3, 1/3]^T$。目标值为 $Z_1 = (1/3)\\sum \\Delta G_r$。因此，当且仅当 $\\sum \\Delta G_r  0$ 时，会检测到循环。\n\n### 第 2 部分：热力学约束的影响评估\n\n这部分评估添加热力学约束如何影响目标函数的最优值。目标是最大化总能量耗散 $J(v) = -\\sum_{r=1}^n v_r \\Delta G_r$。这等同于最小化 $\\Delta G^T v$。\n\n**A. 约束前优化 ($J_{\\mathrm{pre}}$)**\n\n首先，我们找到没有热力学约束时的最优值。LP 为：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  J(v) = - \\Delta G^T v \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n 0 \\le v_r \\le 3, \\quad \\text{对所有 } r=1, \\dots, n\n\\end{aligned}\n$$\n这等同于最小化 $Z_2 = \\Delta G^T v$。约束前的最优值为 $J_{\\mathrm{pre}} = -\\min(Z_2)$。可行的通量向量是 $v=k[1,1,1]^T$，其中 $0 \\le k \\le 3$。目标变为 $Z_2 = k \\sum \\Delta G_r$。\n- 如果 $\\sum \\Delta G_r  0$，$Z_2$ 在最大可能的 $k$ 值处最小化，即 $k=3$。此时 $J_{\\mathrm{pre}} = -3 \\sum \\Delta G_r$。\n- 如果 $\\sum \\Delta G_r \\ge 0$，$Z_2$ 在最小的非负 $k$ 值处最小化，即 $k=0$。此时 $J_{\\mathrm{pre}} = 0$。\n\n**B. 约束后优化 ($J_{\\mathrm{post}}$)**\n\n接下来，我们添加消除能量耗散循环的热力学约束。该约束为 $\\sum_{r=1}^n v_r \\Delta G_r \\ge 0$。新的 LP 为：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  J(v) = - \\Delta G^T v \\\\\n\\text{约束条件} \\quad  S v = 0 \\\\\n 0 \\le v_r \\le 3, \\quad \\text{对所有 } r=1, \\dots, n \\\\\n \\Delta G^T v \\ge 0\n\\end{aligned}\n$$\n我们正在最大化 $J(v)$，同时也对其进行约束：条件 $\\Delta G^T v \\ge 0$ 等价于 $-\\Delta G^T v \\le 0$，即 $J(v) \\le 0$。问题变为最大化一个被约束为非正的函数。可能的最大值为 $0$。这个值可以在点 $v=0$ 处达到，该点总是可行的，因为它满足 $S \\cdot 0 = 0$、边界 $0 \\le 0 \\le 3$ 以及添加的约束 $\\Delta G^T \\cdot 0 = 0 \\ge 0$。因此，约束后的最优值始终为 $J_{\\mathrm{post}} = 0$。\n\n**C. 影响计算**\n\n影响 $\\Delta J$ 是应用约束前后最优值之间的差值：\n$$\n\\Delta J = J_{\\mathrm{pre}} - J_{\\mathrm{post}}\n$$\n如果约束后的问题不可行，影响将为 NaN。然而，对于给定的问题结构，它总是可行的。\n只有当 $J_{\\mathrm{pre}} > 0$ 时，影响才非零，这当且仅当存在一个热力学上有利的无效循环（$\\sum \\Delta G_r  0$），且无约束优化可以利用它时才会发生。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    S_matrix = np.array([\n        [-1, 0, 1],\n        [1, -1, 0],\n        [0, 1, -1]\n    ])\n\n    test_cases = [\n        # Case 1: Energy-dissipating cycle present\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([-10, -5, -7])\n        },\n        # Case 2: No energy-dissipating cycle\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([20, -5, -7])\n        },\n        # Case 3: Near thermodynamic neutrality\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([-0.001, -0.001, 0.002])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_network(case[\"S\"], case[\"delta_G\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list in Python includes spaces.\n    # To match the typical compact representation, we remove them.\n    # However, standard `str(list)` is often the intended format.\n    # Example in problem statement shows no spaces after commas.\n    # e.g., '[1.23,4.56]'\n    # Let's generate a string representation manually for full control.\n    def format_list(lst):\n        items = []\n        for item in lst:\n            if isinstance(item, bool):\n                # Python's str(True) is 'True', we need lowercase 'true' if specified, but problem implies Python bools\n                items.append(str(item))\n            elif isinstance(item, float):\n                # Format float to 6 decimal places, avoiding scientific notation for small numbers\n                items.append(f\"{item:.6f}\")\n            else:\n                items.append(repr(item)) # Fallback for other types\n        return f\"[{','.join(items)}]\"\n    \n    final_output_str = str(results).replace(\" \", \"\")\n\n    print(final_output_str)\n\n\ndef analyze_network(S, delta_G):\n    \"\"\"\n    Performs the two-part analysis for a given metabolic network setup.\n    1. Detects hidden futile cycles.\n    2. Quantifies the impact of thermodynamic constraints on an objective.\n\n    Args:\n        S (np.ndarray): The stoichiometric matrix (m x n).\n        delta_G (np.ndarray): The vector of Gibbs free energy changes (n,).\n\n    Returns:\n        list: [b, J_pre, J_post, delta_J]\n              b (bool): True if a futile cycle is detected.\n              J_pre (float): Optimal objective value before constraint.\n              J_post (float): Optimal objective value after constraint.\n              delta_J (float): Impact J_pre - J_post.\n    \"\"\"\n    n_reactions = S.shape[1]\n    n_metabolites = S.shape[0]\n    tolerance = 1e-9\n\n    # Part 1: Hidden Futile Cycle Detection\n    # Minimize: c_det^T * v = delta_G^T * v\n    # Subject to:\n    # S*v = 0\n    # sum(v) = 1 (since v_r = 0 for irreversible reactions)\n    # v_r = 0\n    c_det = delta_G\n    A_eq_det = np.vstack([S, np.ones((1, n_reactions))])\n    b_eq_det = np.zeros(n_metabolites + 1)\n    b_eq_det[-1] = 1\n    bounds_det = [(0, None) for _ in range(n_reactions)]\n\n    res_det = linprog(c=c_det, A_eq=A_eq_det, b_eq=b_eq_det, bounds=bounds_det, method='highs')\n    \n    is_cycle_detected = bool(res_det.success and res_det.fun  -tolerance)\n\n    # Part 2: Impact on Energy-Dissipation Objective\n    # Objective: Maximize J(v) = -delta_G^T * v, which is equivalent to\n    # minimizing Z(v) = delta_G^T * v.\n    c_opt = delta_G\n    A_eq_opt = S\n    b_eq_opt = np.zeros(n_metabolites)\n    bounds_opt = [(0, 3) for _ in range(n_reactions)]\n\n    # Compute J_pre (without thermodynamic constraint)\n    res_pre = linprog(c=c_opt, A_eq=A_eq_opt, b_eq=b_eq_opt, bounds=bounds_opt, method='highs')\n    \n    J_pre = -res_pre.fun if res_pre.success else np.nan\n\n    # Compute J_post (with thermodynamic constraint delta_G^T * v = 0)\n    # This constraint is written as -delta_G^T * v = 0 for linprog's A_ub\n    A_ub_post = -delta_G.reshape(1, -1)\n    b_ub_post = np.array([0])\n    \n    res_post = linprog(c=c_opt, A_eq=A_eq_opt, b_eq=b_eq_opt, \n                       A_ub=A_ub_post, b_ub=b_ub_post, \n                       bounds=bounds_opt, method='highs')\n                       \n    if res_post.status == 2: # Infeasible\n        J_post = np.nan\n        delta_J = np.nan\n    elif res_post.success:\n        J_post = -res_post.fun\n        # Handle potential floating point imprecision for results known to be zero\n        if abs(J_post)  tolerance:\n            J_post = 0.0\n        delta_J = J_pre - J_post\n    else: # Other failure\n        J_post = np.nan\n        delta_J = np.nan\n\n    # Round results to 6 decimal places\n    J_pre_rounded = round(J_pre, 6)\n    J_post_rounded = round(J_post, 6) if not np.isnan(J_post) else np.nan\n    delta_J_rounded = round(delta_J, 6) if not np.isnan(delta_J) else np.nan\n\n    return [is_cycle_detected, J_pre_rounded, J_post_rounded, delta_J_rounded]\n\n# This is a helper function to be called to generate the output string.\n# In the platform, it will be executed.\nif __name__ == '__main__':\n    solve()\n```", "id": "3355529"}]}