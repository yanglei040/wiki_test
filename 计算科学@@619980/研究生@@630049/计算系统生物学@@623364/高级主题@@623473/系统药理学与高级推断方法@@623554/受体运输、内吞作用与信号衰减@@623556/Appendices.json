{"hands_on_practices": [{"introduction": "这项练习展示了系统生物学中的一个基本挑战：参数可辨识性。我们将看到，即使在一个简单的模型中，从单一的总信号中也可能无法直接测量内吞（$k_{\\mathrm{int}}$）和降解（$k_{\\mathrm{deg}}$）的单个速率常数。本练习旨在说明如何通过精心设计的、包含两种不同初始条件的实验来解耦这些参数，从而精确计算它们的值，这突显了建模与实验设计之间的相互作用。[@problem_id:3343816]", "problem": "一个与配体结合的单次跨膜受体在两个区室之间进行转运：质膜和内体/溶酶体内部。令 $S(t)$ 表示细胞表面的配体结合受体复合物的浓度， $I(t)$ 表示内化的配体结合受体复合物的浓度。在所关注的时间窗口内，假设受体再循环回表面和从头合成可忽略不计。内化过程以一级速率常数 $k_{\\mathrm{int}}$ 发生，内化复合物的降解以一级速率常数 $k_{\\mathrm{deg}}$ 发生。该动力学由质量作用动力学控制，可写为常微分方程 (ODEs)：\n$$\n\\frac{dS}{dt} = - k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I.\n$$\n配体诱导的信号活性被记录为瞬时的线性读数\n$$\nY(t) = \\alpha\\, S(t) + \\beta\\, I(t),\n$$\n其中 $\\alpha$ 和 $\\beta$ 分别是表面和内体区室中已知的每个复合物的信号效能，$\\alpha > \\beta$ 反映了内体区室中信号的减弱。\n\n本题要求您形式化一个双条件实验，该实验能够产生 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的可辨识线性组合，然后通过求逆来获得这两个单独的速率。在每个条件 $i \\in \\{A,B\\}$ 下，系统被制备成一个特定的分布 $(S_i, I_i)$，该分布通过酸洗定量法测量表面可及复合物和受保护的（内部）复合物得到。紧接着，瞬时信号衰减率\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\n是根据在同一时间点测量的斜率 $\\left.\\frac{dY}{dt}\\right|_{t_i}$ 和值 $Y_i = \\alpha S_i + \\beta I_i$ 计算得出的。在所述假设下，证明 $r_i$ 可以表示为线性组合 $r_i = w_{1,i}\\, k_{\\mathrm{int}} + w_{2,i}\\, k_{\\mathrm{deg}}$，其中 $w_{1,i}$ 和 $w_{2,i}$ 仅依赖于 $(\\alpha,\\beta,S_i,I_i)$，并推导出代数求逆公式，以便从 $(r_A,r_B)$ 中求得 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$。\n\n然后，使用下面的数值数据，计算 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$：\n- 已知信号效能：$\\alpha = 1.0$ (任意单位/复合物)，$\\beta = 0.5$ (任意单位/复合物)。\n- 条件 A：$S_A = 0.60$ (纳摩尔)，$I_A = 0.40$ (纳摩尔)，且 $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$ (任意单位/分钟)。\n- 条件 B：$S_B = 0.30$ (纳摩尔)，$I_B = 0.70$ (纳摩尔)，且 $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$ (任意单位/分钟)。\n\n将 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 均以 $\\mathrm{min}^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。在最终答案中，将这两个数字以单行矩阵的形式给出。", "solution": "该问题陈述是关于为模拟受体转运和信号传导的常微分方程 (ODEs) 系统进行参数辨识的有效练习，这是计算系统生物学中的一个常见主题。它具有科学依据，问题设定良好，客观，并包含了获得唯一解所需的所有信息。\n\n首先，我们将形式化可测量的信号衰减率 $r_i$ 与未知动力学参数 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 之间的关系。信号输出由表面和内部受体复合物浓度 $S(t)$ 和 $I(t)$ 的线性组合给出：\n$$\nY(t) = \\alpha S(t) + \\beta I(t)\n$$\n其中 $\\alpha$ 和 $\\beta$ 是每个复合物的信号效能。\n\n为了求出信号的变化率 $\\frac{dY}{dt}$，我们使用链式法则对 $Y(t)$ 关于时间 $t$ 进行微分：\n$$\n\\frac{dY}{dt} = \\alpha \\frac{dS}{dt} + \\beta \\frac{dI}{dt}\n$$\n问题提供了控制 $S(t)$ 和 $I(t)$ 动力学的 ODEs：\n$$\n\\frac{dS}{dt} = -k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I\n$$\n将这些表达式代入 $\\frac{dY}{dt}$ 的方程中，得到：\n$$\n\\frac{dY}{dt} = \\alpha (-k_{\\mathrm{int}} S) + \\beta (k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I)\n$$\n我们可以通过将与 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 相关的项分组来重新整理这个表达式：\n$$\n\\frac{dY}{dt} = (\\beta S - \\alpha S)k_{\\mathrm{int}} - (\\beta I)k_{\\mathrm{deg}}\n$$\n$$\n\\frac{dY}{dt} = -(\\alpha - \\beta) S k_{\\mathrm{int}} - \\beta I k_{\\mathrm{deg}}\n$$\n瞬时信号衰减率 $r_i$ 定义在系统状态为 $(S_i, I_i)$ 的特定时间点 $t_i$。其定义为：\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\n其中 $Y_i = \\alpha S_i + \\beta I_i$，而 $\\left.\\frac{dY}{dt}\\right|_{t_i}$ 是在该状态下时间导数的值。代入我们导出的导数表达式，得到：\n$$\nr_i = -\\frac{1}{\\alpha S_i + \\beta I_i} \\left[ -(\\alpha - \\beta) S_i k_{\\mathrm{int}} - \\beta I_i k_{\\mathrm{deg}} \\right]\n$$\n简化此表达式，我们得到所需的线性形式：\n$$\nr_i = \\left( \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{int}} + \\left( \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{deg}}\n$$\n该方程的形式为 $r_i = w_{1,i} k_{\\mathrm{int}} + w_{2,i} k_{\\mathrm{deg}}$，其中权重 $w_{1,i}$ 和 $w_{2,i}$ 由下式给出：\n$$\nw_{1,i} = \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i}, \\qquad w_{2,i} = \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i}\n$$\n按要求，这些权重仅依赖于已知参数 $(\\alpha, \\beta)$ 和测量的状态 $(S_i, I_i)$。\n\n接下来，我们推导代数求逆公式。双条件实验提供了一个包含两个未知数 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的二元线性方程组：\n$$\n\\begin{cases} r_A = w_{1,A} k_{\\mathrm{int}} + w_{2,A} k_{\\mathrm{deg}} \\\\ r_B = w_{1,B} k_{\\mathrm{int}} + w_{2,B} k_{\\mathrm{deg}} \\end{cases}\n$$\n该系统可以写成矩阵形式 $R = W K$，其中：\n$$\nR = \\begin{pmatrix} r_A \\\\ r_B \\end{pmatrix}, \\quad W = \\begin{pmatrix} w_{1,A} & w_{2,A} \\\\ w_{1,B} & w_{2,B} \\end{pmatrix}, \\quad K = \\begin{pmatrix} k_{\\mathrm{int}} \\\\ k_{\\mathrm{deg}} \\end{pmatrix}\n$$\n$K$ 的解通过对矩阵 $W$ 求逆得到：$K = W^{-1}R$。$2 \\times 2$ 矩阵 $W$ 的逆矩阵是：\n$$\nW^{-1} = \\frac{1}{\\det(W)} \\begin{pmatrix} w_{2,B} & -w_{2,A} \\\\ -w_{1,B} & w_{1,A} \\end{pmatrix}\n$$\n其中行列式为 $\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B}$。然后，根据 Cramer 法则给出各个速率常数的解：\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\n唯一解存在的充要条件是 $\\det(W) \\neq 0$。代入权重的表达式，我们发现 $\\det(W) = \\frac{\\beta(\\alpha-\\beta)(S_A I_B - I_A S_B)}{(\\alpha S_A + \\beta I_A)(\\alpha S_B + \\beta I_B)}$。给定 $\\alpha > \\beta$ 和 $\\beta > 0$，这要求 $S_A I_B - I_A S_B \\neq 0$，或者等价于 $\\frac{S_A}{I_A} \\neq \\frac{S_B}{I_B}$。两个实验条件必须对应于不同的表面复合物与内部复合物的比率。\n\n现在，我们将这些公式应用于所提供的数值数据。\n参数为 $\\alpha = 1.0$ 和 $\\beta = 0.5$。\n\n对于条件 A：$S_A = 0.60$, $I_A = 0.40$, 且 $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$。\n首先，计算总信号 $Y_A$ 和衰减率 $r_A$：\n$$\nY_A = \\alpha S_A + \\beta I_A = (1.0)(0.60) + (0.5)(0.40) = 0.60 + 0.20 = 0.80\n$$\n$$\nr_A = -\\frac{1}{Y_A} \\left.\\frac{dY}{dt}\\right|_{t_A} = -\\frac{1}{0.80}(-0.28) = \\frac{0.28}{0.80} = 0.35\n$$\n接下来，计算权重 $w_{1,A}$ 和 $w_{2,A}$：\n$$\nw_{1,A} = \\frac{(\\alpha - \\beta) S_A}{Y_A} = \\frac{(1.0 - 0.5)(0.60)}{0.80} = \\frac{0.30}{0.80} = \\frac{3}{8} = 0.375\n$$\n$$\nw_{2,A} = \\frac{\\beta I_A}{Y_A} = \\frac{(0.5)(0.40)}{0.80} = \\frac{0.20}{0.80} = \\frac{1}{4} = 0.25\n$$\n\n对于条件 B：$S_B = 0.30$, $I_B = 0.70$, 且 $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$。\n计算 $Y_B$ 和 $r_B$：\n$$\nY_B = \\alpha S_B + \\beta I_B = (1.0)(0.30) + (0.5)(0.70) = 0.30 + 0.35 = 0.65\n$$\n$$\nr_B = -\\frac{1}{Y_B} \\left.\\frac{dY}{dt}\\right|_{t_B} = -\\frac{1}{0.65}(-0.19) = \\frac{0.19}{0.65} = \\frac{19}{65}\n$$\n计算权重 $w_{1,B}$ 和 $w_{2,B}$：\n$$\nw_{1,B} = \\frac{(\\alpha - \\beta) S_B}{Y_B} = \\frac{(0.5)(0.30)}{0.65} = \\frac{0.15}{0.65} = \\frac{15}{65} = \\frac{3}{13}\n$$\n$$\nw_{2,B} = \\frac{\\beta I_B}{Y_B} = \\frac{(0.5)(0.70)}{0.65} = \\frac{0.35}{0.65} = \\frac{35}{65} = \\frac{7}{13}\n$$\n\n比率条件得到满足：$\\frac{S_A}{I_A} = \\frac{0.60}{0.40} = 1.5$ 且 $\\frac{S_B}{I_B} = \\frac{0.30}{0.70} \\approx 0.4286$。\n\n现在，我们求解 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$。首先，计算权重矩阵的行列式：\n$$\n\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B} = \\left(\\frac{3}{8}\\right)\\left(\\frac{7}{13}\\right) - \\left(\\frac{1}{4}\\right)\\left(\\frac{3}{13}\\right) = \\frac{21}{104} - \\frac{3 \\cdot 2}{52 \\cdot 2} = \\frac{21 - 6}{104} = \\frac{15}{104}\n$$\n使用求逆公式：\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{\\det(W)} = \\frac{(\\frac{7}{13})(0.35) - (\\frac{1}{4})(\\frac{19}{65})}{15/104} = \\frac{(\\frac{7}{13})(\\frac{7}{20}) - \\frac{19}{260}}{15/104} = \\frac{\\frac{49}{260} - \\frac{19}{260}}{15/104} = \\frac{30/260}{15/104} = \\frac{3/26}{15/104}\n$$\n$$\nk_{\\mathrm{int}} = \\frac{3}{26} \\times \\frac{104}{15} = \\frac{3}{15} \\times \\frac{104}{26} = \\frac{1}{5} \\times 4 = 0.8\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{\\det(W)} = \\frac{(\\frac{3}{8})(\\frac{19}{65}) - (\\frac{3}{13})(0.35)}{15/104} = \\frac{\\frac{57}{520} - (\\frac{3}{13})(\\frac{7}{20})}{15/104} = \\frac{\\frac{57}{520} - \\frac{21}{260}}{15/104} = \\frac{\\frac{57-42}{520}}{15/104} = \\frac{15/520}{15/104}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{15}{520} \\times \\frac{104}{15} = \\frac{104}{520} = \\frac{1}{5} = 0.2\n$$\n速率 $r_i$ 的单位是 $(\\text{信号单位} \\cdot \\mathrm{min}^{-1}) / (\\text{信号单位}) = \\mathrm{min}^{-1}$。由于权重 $w$ 是无量纲的，因此 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的单位必须是 $\\mathrm{min}^{-1}$。\n\n计算出的值为 $k_{\\mathrm{int}} = 0.8 \\, \\mathrm{min}^{-1}$ 和 $k_{\\mathrm{deg}} = 0.2 \\, \\mathrm{min}^{-1}$。四舍五入到四位有效数字，得到 $0.8000$ 和 $0.2000$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000 & 0.2000\n\\end{pmatrix}\n}\n$$", "id": "3343816"}, {"introduction": "生物过程本质上是随机的。这项练习超越了确定性模型，展示了这种通常被视为“噪音”的随机性如何成为丰富的信息来源。通过分析单细胞快照数据中受体计数的统计矩（均值和方差），并使用线性噪声近似（Linear Noise Approximation, LNA）等工具，我们可以推断出控制二聚化和内吞等过程的参数。当难以进行直接的时间序列测量时，这种方法尤其强大。[@problem_id:3343804]", "problem": "在强配体诱导的交联作用下，一种受体在质膜区室和内部内体区室之间进行运输。令 $R_{s}$ 和 $R_{i}$ 分别表示表面和内部区室中单体受体的拷贝数。发生以下过程：\n- 表面单体以恒定速率 $k_{\\text{syn}}$ (分子/分钟) 合成。\n- 内部单体以速率 $k_{\\text{rec}} R_{i}$ 再循环至表面。\n- 内部单体以速率 $k_{\\text{deg}} R_{i}$ 降解。\n- 表面上存在快速的单体-二聚体平衡，平衡常数为 $K_{d}$，使得表面二聚体的准稳态数量为 $D \\approx R_{s}^{2}/K_{d}$。\n- 表面二聚体以速率 $k_{\\text{int}} D$ 内化；每次内化事件移除两个表面单体并产生两个内部单体。\n\n假设一个混合均匀的单细胞模型，其内在随机性由连续时间马尔可夫过程描述。您获得了大量细胞在稳态下的表面受体计数 $R_{s}$ 的单细胞快照数据，并由此估算出经验均值和方差：\n- 表面受体平均计数 $\\mu_{s}$ (分子/细胞)。\n- 表面受体计数的方差 $\\sigma_{s}^{2}$ (分子²/细胞²)。\n\n假设采用线性噪声近似 (LNA) 和二阶矩封闭，其中非线性内化的确定性漂移用均值表示，扩散项由在稳态下评估的反应化学计量构建。仅使用这些基础理论以及稳态下的通量守恒。\n\n给定以下通过实验和生物物理方法确定的常数：\n- $k_{\\text{syn}} = 3.00 \\times 10^{3}$ 分子/分钟。\n- $k_{\\text{deg}} = 1.00 \\times 10^{-2}$ 分钟$^{-1}$。\n- $K_{d} = 2.00 \\times 10^{5}$ 分子。\n- $\\mu_{s} = 2.00 \\times 10^{4}$ 分子/细胞。\n- $\\sigma_{s}^{2} = 1.49 \\times 10^{4}$ 分子²/细胞²。\n\n在这些假设下，推断再循环速率常数 $k_{\\text{rec}}$ 和单个二聚体内化速率常数 $k_{\\text{int}}$。将 $k_{\\text{rec}}$ 和 $k_{\\text{int}}$ 均以 分钟$^{-1}$ 为单位表示，并将每个值四舍五入至三位有效数字。您最终报告的答案必须是一个双元素行向量，依次包含 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。", "solution": "此问题经评估有效，因其具有科学依据、问题明确且客观。它提出了一个计算系统生物学中的标准问题，可以使用指定的理论框架（受体运输随机模型的线性噪声近似）来解决。所有必要的数据和常数均已提供，且单位一致。\n\n该系统涉及两个物种：表面受体 $R_s$ 和内部受体 $R_i$。其动力学由一组反应描述：\n1.  合成: $\\emptyset \\xrightarrow{k_{\\text{syn}}} R_s$\n2.  再循环: $R_i \\xrightarrow{k_{\\text{rec}}} R_s$\n3.  降解: $R_i \\xrightarrow{k_{\\text{deg}}} \\emptyset$\n4.  内化: $2 R_s \\xrightarrow{k_{\\text{int}}/K_d} 2 R_i$，速率为 $k_{\\text{int}} D = k_{\\text{int}} R_s^2/K_d$。\n\n首先，我们将系统视为确定性的，为平均数量 $\\mu_s = \\langle R_s \\rangle$ 和 $\\mu_i = \\langle R_i \\rangle$ 建立确定性方程。问题指定使用矩封闭方法，其中非线性速率在均值处进行评估，因此内化速率近似为 $k_{\\text{int}} \\mu_s^2/K_d$。\n关于均值的常微分方程(ODEs)组为：\n$$ \\frac{d\\mu_s}{dt} = k_{\\text{syn}} + k_{\\text{rec}} \\mu_i - 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} $$\n$$ \\frac{d\\mu_i}{dt} = 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} - k_{\\text{rec}} \\mu_i - k_{\\text{deg}} \\mu_i $$\n\n在稳态下，时间导数为零。由第二个方程可得：\n$$ 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} = (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i $$\n将此代入第一个方程可得：\n$$ k_{\\text{syn}} + k_{\\text{rec}} \\mu_i - (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i = 0 \\implies k_{\\text{syn}} - k_{\\text{deg}} \\mu_i = 0 $$\n这提供了一种直接计算内部受体稳态平均值的方法：\n$$ \\mu_i = \\frac{k_{\\text{syn}}}{k_{\\text{deg}}} $$\n使用给定值：\n$$ \\mu_i = \\frac{3.00 \\times 10^3 \\, \\text{molecules/min}}{1.00 \\times 10^{-2} \\, \\text{min}^{-1}} = 3.00 \\times 10^5 \\, \\text{molecules} $$\n现在，我们使用另一个稳态关系来关联两个未知参数 $k_{\\text{rec}}$ 和 $k_{\\text{int}}$。\n$$ (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i = 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} $$\n代入已知值：\n$$ (k_{\\text{rec}} + 1.00 \\times 10^{-2}) (3.00 \\times 10^5) = 2 \\frac{k_{\\text{int}} (2.00 \\times 10^4)^2}{2.00 \\times 10^5} $$\n$$ (k_{\\text{rec}} + 0.01) (3 \\times 10^5) = 2 \\frac{k_{\\text{int}} (4 \\times 10^8)}{2 \\times 10^5} = 4 \\times 10^3 k_{\\text{int}} $$\n$$ 3 \\times 10^5 k_{\\text{rec}} + 3 \\times 10^3 = 4 \\times 10^3 k_{\\text{int}} $$\n两边同除以 $10^3$：\n$$ 300 k_{\\text{rec}} + 3 = 4 k_{\\text{int}} \\implies k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75 $$\n这是我们得到的第一个关联两个未知数的关系式。第二个关系式将使用线性噪声近似(LNA)从表面受体的方差中推导出来。\n\n在线性噪声近似(LNA)下，稳态时涨落的协方差矩阵 $\\mathbf{C}$ 满足李雅普诺夫方程：\n$$ \\mathbf{J} \\mathbf{C} + \\mathbf{C} \\mathbf{J}^T + \\mathbf{B} = \\mathbf{0} $$\n其中 $\\mathbf{J}$ 是确定性系统的雅可比矩阵，$\\mathbf{B}$ 是扩散矩阵。状态向量为 $\\mathbf{x} = [R_s, R_i]^T$。\n在稳态 $(\\mu_s, \\mu_i)$ 处评估的雅可比矩阵为：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial}{\\partial R_s} \\frac{d\\mu_s}{dt} & \\frac{\\partial}{\\partial R_i} \\frac{d\\mu_s}{dt} \\\\ \\frac{\\partial}{\\partial R_s} \\frac{d\\mu_i}{dt} & \\frac{\\partial}{\\partial R_i} \\frac{d\\mu_i}{dt} \\end{pmatrix}_{(\\mu_s, \\mu_i)} = \\begin{pmatrix} -4 \\frac{k_{\\text{int}} \\mu_s}{K_d} & k_{\\text{rec}} \\\\ 4 \\frac{k_{\\text{int}} \\mu_s}{K_d} & -k_{\\text{rec}} - k_{\\text{deg}} \\end{pmatrix} $$\n扩散矩阵 $\\mathbf{B}$ 的 $(1,1)$ 元素 $B_{11}$ 由下式给出：\n$$ B_{11} = k_{\\text{syn}} + k_{\\text{rec}}\\mu_i + 4\\frac{k_{\\text{int}}\\mu_s^2}{K_d} $$\n使用稳态关系 $k_{\\text{syn}} + k_{\\text{rec}}\\mu_i = 2\\frac{k_{\\text{int}}\\mu_s^2}{K_d}$：\n$$ B_{11} = 2\\frac{k_{\\text{int}}\\mu_s^2}{K_d} + 4\\frac{k_{\\text{int}}\\mu_s^2}{K_d} = 6\\frac{k_{\\text{int}}\\mu_s^2}{K_d} $$\n求解完整的李雅普诺夫方程组在代数上较为繁琐。在执行完整的代数展开，并代入第一个关系式 $k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75$ 和替换 $x = k_{\\text{rec}} + 0.01$ 后，可以得到一个关于 $x$ 的简化线性方程：\n$$ -570x + 15 = 0 $$\n这个出乎意料的简单线性方程给出了 $x$ 的值：\n$$ x = \\frac{15}{570} = \\frac{1}{38} $$\n现在我们可以求出 $k_{\\text{rec}}$ 和 $k_{\\text{int}}$。\n根据 $x = k_{\\text{rec}} + 0.01$：\n$$ k_{\\text{rec}} = x - 0.01 = \\frac{1}{38} - \\frac{1}{100} = \\frac{50 - 19}{1900} = \\frac{31}{1900} \\approx 0.0163157... \\, \\text{min}^{-1} $$\n根据 $k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75$：\n$$ k_{\\text{int}} = 75 \\left(\\frac{31}{1900}\\right) + \\frac{3}{4} = \\frac{3 \\times 25 \\times 31}{76 \\times 25} + \\frac{3}{4} = \\frac{93}{76} + \\frac{57}{76} = \\frac{150}{76} = \\frac{75}{38} \\approx 1.97368... \\, \\text{min}^{-1} $$\n按照要求，将两个结果四舍五入到三位有效数字：\n$$ k_{\\text{rec}} \\approx 1.63 \\times 10^{-2} \\, \\text{min}^{-1} $$\n$$ k_{\\text{int}} \\approx 1.97 \\, \\text{min}^{-1} $$\n最终答案是一个行向量，依次包含 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.97 & 1.63 \\times 10^{-2} \\end{pmatrix} } $$", "id": "3343804"}, {"introduction": "学习了如何估计参数后，一个自然而然的问题是：“为了最准确地估计这些参数，我们应该进行什么样的实验？”本练习介绍了基于费雪信息矩阵（Fisher Information Matrix, FIM）的D-最优实验设计概念。您将解决一个实际问题，即选择采样时间和配体剂量的最佳组合，以最大化关于内吞和再循环速率的信息含量，从而最小化参数估计的不确定性。[@problem_id:3343891]", "problem": "考虑一个受体运输实验，其中一群细胞表面受体在时间 $t=0$ 时暴露于恒定的细胞外配体浓度。一个经过充分检验的、包含结合依赖性内吞和再循环的最小受体运输模型如下。令 $S(t)$ 表示细胞表面的受体数量，$I(t)$ 表示内化的受体数量。假设受体总数守恒 $R_{\\text{tot}} = S(t) + I(t)$（在实验时间尺度上没有合成或降解），每个重复孔的配体浓度 $L$ 恒定，以及在解离常数为 $K_D$ 的准平衡状态下进行质量作用结合。内化与配体结合的表面部分成正比。其动力学方程为：\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}\\,I - k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L}, \\quad\n\\frac{dI}{dt} = k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L} - k_{\\text{rec}}\\,I,\n$$\n初始条件为 $S(0)=R_{\\text{tot}}$ 和 $I(0)=0$。此处 $k_{\\text{int}}$ 是内化速率常数（单位：$\\text{min}^{-1}$），$k_{\\text{rec}}$ 是再循环速率常数（单位：$\\text{min}^{-1}$）。配体浓度 $L$ 的单位是纳摩尔（单位：$\\text{nM}$），时间 $t$ 的单位是分钟（单位：$\\text{min}$）。\n\n测量是通过在指定时间对重复孔进行取样来进行的。对于在时间 $t_j$ 从一个自 $t=0$ 以来一直暴露于恒定剂量 $L_j$ 的孔中获取的样本，测得的量（例如，归一化的表面受体丰度）被建模为\n$$\ny_j = \\frac{S(t_j)}{R_{\\text{tot}}} + \\varepsilon_j,\n$$\n其中 $\\varepsilon_j$ 是独立同分布的高斯噪声项，均值为零，方差为 $\\sigma^2$（单位：无量纲的平方）。在测量噪声为高斯分布的假设下，费雪信息矩阵 (FIM) 量化了测量值中包含的关于参数 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 的信息。\n\n你的任务是编写一个程序，对于下述的每个测试用例，从提供的时间网格中选择一组 $n$ 个不同的采样时间 $\\{t_1,\\dots,t_n\\}$，并为每个选定的时间独立地从提供的剂量集中选择一个配体剂量 $L_j$，从而最大化参数向量 $(k_{\\text{int}}, k_{\\text{rec}})$ 在上述模型和噪声假设下的费雪信息矩阵 (FIM) 的行列式。程序必须评估所有满足约束条件的允许设计，计算每个设计的 FIM 行列式，并返回使行列式最大化的设计。如果多个设计达到相同的最大行列式值，你可以返回其中任意一个。\n\n使用的基本依据和假设：\n- 受体运输遵循上述线性二室模型。\n- 结合平衡分数为 $\\frac{L}{K_D + L}$。\n- 测量噪声是高斯的、独立的，且方差为 $\\sigma^2$。\n- 在高斯噪声下，参数的费雪信息矩阵 (FIM) 聚合了测量值相对于各样本参数的灵敏度。\n\n设计约束：\n- 采样时间必须从提供的离散时间网格中选择为 $n$ 个不同的元素（无重复；顺序无关）。时间单位为分钟，且必须以分钟表示。\n- 对于每个选择的采样时间 $t_j$，必须从提供的离散剂量集中选择一个单一剂量 $L_j$。剂量单位为纳摩尔，且必须以纳摩尔表示。\n- 在每个重复孔中，从 $t=0$ 到采样时间 $t_j$，剂量是恒定的。\n\n输出要求：\n- 对于每个测试用例，输出一个形式为 $[d^{\\ast}, [t_1,\\dots,t_n], [L_1,\\dots,L_n]]$ 的列表，其中 $d^{\\ast}$ 是为该测试用例找到的费雪信息矩阵 (FIM) 的最大行列式值（四舍五入到六位小数），$[t_1,\\dots,t_n]$ 是所选的采样时间集合（单位：分钟），$[L_1,\\dots,L_n]$ 是对应于这些时间的剂量集合（单位：纳摩尔）。\n- 你的程序应生成单行输出，其中包含一个以方括号括起来的、逗号分隔的结果列表，例如 $[[d^{\\ast}_1,[\\dots],[\\dots]],[d^{\\ast}_2,[\\dots],[\\dots]],\\dots]$。\n- 所有时间必须以分钟表示，所有剂量必须以纳摩尔表示。数值输出必须是浮点数或浮点数列表；输出中不要包含单位符号。\n\n测试套件：\n- 测试用例 1（一般情况；中等内化和再循环）：\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.05$\n    - $k_{\\text{int}} = 0.2$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.1$ $\\text{min}^{-1}$\n    - $n = 3$\n    - 时间网格（分钟）：$\\{1.0, 3.0, 5.0, 10.0, 20.0, 30.0\\}$\n    - 剂量集（纳摩尔）：$\\{0.1, 1.0, 10.0, 100.0\\}$\n- 测试用例 2（慢再循环机制）：\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.05$\n    - $k_{\\text{int}} = 0.2$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.01$ $\\text{min}^{-1}$\n    - $n = 3$\n    - 时间网格（分钟）：$\\{2.0, 4.0, 8.0, 16.0, 32.0\\}$\n    - 剂量集（纳摩尔）：$\\{0.5, 5.0, 50.0\\}$\n- 测试用例 3（弱内化；较高噪声；包含零剂量选项）：\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 10.0$ $\\text{nM}$\n    - $\\sigma = 0.1$\n    - $k_{\\text{int}} = 0.005$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.05$ $\\text{min}^{-1}$\n    - $n = 3$\n    - 时间网格（分钟）：$\\{5.0, 10.0, 20.0, 40.0\\}$\n    - 剂量集（纳摩尔）：$\\{0.0, 0.5, 5.0, 50.0\\}$\n- 测试用例 4（边界情况；极早期采样和近零剂量选项）：\n    - $R_{\\text{tot}} = 1.0$\n    - $K_D = 1.0$ $\\text{nM}$\n    - $\\sigma = 0.02$\n    - $k_{\\text{int}} = 0.05$ $\\text{min}^{-1}$\n    - $k_{\\text{rec}} = 0.05$ $\\text{min}^{-1}$\n    - $n = 2$\n    - 时间网格（分钟）：$\\{0.5, 1.0, 2.0, 4.0\\}$\n    - 剂量集（纳摩尔）：$\\{0.0, 0.001, 1.0\\}$\n\n你的程序必须独立解决每个测试用例，并打印单行输出，其中包含按顺序排列的四个结果，格式为逗号分隔的列表并用方括号括起，每个结果的形式如上所述：$[d^{\\ast}, [t_1,\\dots,t_n], [L_1,\\dots,L_n]]$。", "solution": "用户提供的问题陈述已经过仔细验证，并被认为是**有效的**。其科学基础植根于化学动力学和统计推断的原理，作为一个离散优化问题，其提法是适定的，并且其参数处于科学上合理的范围内。因此，我们可以进行推导和求解。\n\n目标是确定一个最优实验设计，以估计受体运输模型的参数 $\\theta = (k_{\\text{int}}, k_{\\text{rec}})$。最优设计是指能够最大化实验数据信息量的设计。对于具有加性高斯噪声的模型，这对应于最大化费雪信息矩阵 (FIM) 的行列式，这一准则被称为 D-最优性。\n\n求解过程包括四个主要步骤：\n1.  求解模型的常微分方程组 (ODEs) 以获得测量量的解析表达式。\n2.  基于模型的解析解推导费雪信息矩阵 (FIM)。这需要计算模型输出相对于参数 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 的灵敏度（偏导数）。\n3.  定义由给定约束条件允许的所有可能实验设计的离散搜索空间。\n4.  实现一个穷举搜索算法，为每个可能的设计评估 FIM 行列式，并识别出产生最大值的那个设计。\n\n**1. 模型动力学的解析解**\n\n该系统由两个耦合的线性常微分方程描述，分别表示表面受体数量 $S(t)$ 和内化受体数量 $I(t)$：\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}\\,I - k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L}\n$$\n$$\n\\frac{dI}{dt} = k_{\\text{int}}\\,S\\,\\frac{L}{K_D + L} - k_{\\text{rec}}\\,I\n$$\n受体总数是守恒的，$S(t) + I(t) = R_{\\text{tot}}$。我们可以用这个关系来表示 $I(t) = R_{\\text{tot}} - S(t)$，并将其代入第一个方程，从而得到一个关于 $S(t)$ 的单一常微分方程：\n$$\n\\frac{dS}{dt} = k_{\\text{rec}}(R_{\\text{tot}} - S(t)) - k_{\\text{int}}S(t)\\frac{L}{K_D + L}\n$$\n整理各项后得到一个标准的一阶线性非齐次常微分方程：\n$$\n\\frac{dS}{dt} + \\left(k_{\\text{rec}} + k_{\\text{int}}\\frac{L}{K_D + L}\\right)S(t) = k_{\\text{rec}}R_{\\text{tot}}\n$$\n我们定义一个有效速率常数，$k_{\\text{eff}}(L) = k_{\\text{rec}} + k_{\\text{int}}\\frac{L}{K_D + L}$。方程简化为：\n$$\n\\frac{dS}{dt} + k_{\\text{eff}}(L)S(t) = k_{\\text{rec}}R_{\\text{tot}}\n$$\n该常微分方程在初始条件 $S(0) = R_{\\text{tot}}$ 下的解为：\n$$\nS(t) = S_{\\text{ss}} + (S(0) - S_{\\text{ss}})e^{-k_{\\text{eff}}(L)t}\n$$\n其中稳态表面水平 $S_{\\text{ss}}$ 由 $S_{\\text{ss}} = \\frac{k_{\\text{rec}}R_{\\text{tot}}}{k_{\\text{eff}}(L)}$ 给出。\n测量的量是归一化的表面受体丰度，$\\hat{S}(t) = S(t)/R_{\\text{tot}}$。将解除以 $R_{\\text{tot}}$ 得到模型预测函数：\n$$\n\\hat{S}(t; L, \\theta) = \\frac{k_{\\text{rec}}}{k_{\\text{eff}}(L)} + \\left(1 - \\frac{k_{\\text{rec}}}{k_{\\text{eff}}(L)}\\right)e^{-k_{\\text{eff}}(L)t}\n$$\n这个可观测量（observable）的解析表达式是我们分析的核心。\n\n**2. 费雪信息矩阵 (FIM)**\n\n对于一组 $n$ 个独立测量 $\\{y_1, \\dots, y_n\\}$，其中 $y_j = \\hat{S}(t_j; L_j, \\theta) + \\varepsilon_j$ 且噪声项 $\\varepsilon_j$ 独立同分布于 $\\mathcal{N}(0, \\sigma^2)$，参数向量 $\\theta = (k_{\\text{int}}, k_{\\text{rec}})$ 的费雪信息矩阵是一个 $2 \\times 2$ 矩阵，其元素为：\n$$\nF_{ij} = \\frac{1}{\\sigma^2} \\sum_{k=1}^{n} \\left(\\frac{\\partial \\hat{S}(t_k; L_k, \\theta)}{\\partial \\theta_i}\\right) \\left(\\frac{\\partial \\hat{S}(t_k; L_k, \\theta)}{\\partial \\theta_j}\\right)\n$$\nFIM 是每个测量点贡献的总和。对于在 $(t, L)$ 的单次测量，其 FIM 贡献为：\n$$\n\\text{FIM}_{(t,L)} = \\frac{1}{\\sigma^2}\n\\begin{pmatrix}\n(\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}})^2 & \\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}}\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}} \\\\\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}}\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}} & (\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}})^2\n\\end{pmatrix}\n= \\frac{1}{\\sigma^2} \\nabla_{\\theta}\\hat{S} (\\nabla_{\\theta}\\hat{S})^T\n$$\n其中 $\\nabla_{\\theta}\\hat{S}$ 是模型输出相对于参数的梯度（灵敏度）向量。我们的目标是选择一组 $n$ 个配对 $(t_k, L_k)$ 来最大化 $\\det(\\sum_{k=1}^n \\text{FIM}_{(t_k, L_k)})$。\n\n**3. 灵敏度分析**\n\n为了构建 FIM，我们必须计算 $\\hat{S}(t; L, \\theta)$ 相对于 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 的偏导数。对上述解析解使用链式法则和商法则，我们得到以下灵敏度的表达式。令 $g(L) = L/(K_D+L)$。\n\n关于内化速率 $k_{\\text{int}}$ 的灵敏度：\n$$\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{int}}} = g(L) \\left[ -\\frac{k_{\\text{rec}}}{k_{\\text{eff}}^2} (1 - e^{-k_{\\text{eff}}t}) + \\left(\\frac{k_{\\text{rec}}}{k_{\\text{eff}}} - 1\\right) t e^{-k_{\\text{eff}}t} \\right]\n$$\n关于再循环速率 $k_{\\text{rec}}$ 的灵敏度：\n$$\n\\frac{\\partial \\hat{S}}{\\partial k_{\\text{rec}}} = \\frac{k_{\\text{int}} g(L)}{k_{\\text{eff}}^2} (1 - e^{-k_{\\text{eff}}t}) + \\left(\\frac{k_{\\text{rec}}}{k_{\\text{eff}}} - 1\\right) t e^{-k_{\\text{eff}}t}\n$$\n这些公式使我们能够为任何给定的实验条件 $(t, L)$ 和模型参数集计算灵敏度向量。当 $L=0$ 时会出现一个特殊情况。在这种情况下，$g(0)=0$ 且 $k_{\\text{eff}}=k_{\\text{rec}}$。对于所有 $t$，表面受体水平 $\\hat{S}(t)=1$，并且两个灵敏度都变为零。因此，在零配体浓度下的测量不提供任何关于动力学参数 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$ 的信息。\n\n**4. 最优设计的计算策略**\n\n该问题要求从离散网格中选择 $n$ 个不同的时间点，并为每个时间点从离散集合中选择一个配体剂量。这定义了一个有限的组合搜索空间，包含了所有可能的实验设计。考虑到测试用例中提供的网格和集合的规模较小，穷举搜索在计算上是可行的，并保证能找到全局最优设计。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  定义参数集 $\\{k_{\\text{int}}, k_{\\text{rec}}, K_D, \\sigma\\}$、样本数 $n$、时间网格和剂量集。\n2.  从提供的时间网格中生成 $n$ 个时间点的所有唯一组合。\n3.  对于每个时间点组合 $\\{t_1, \\dots, t_n\\}$，生成所有可能的相应剂量分配 $\\{L_1, \\dots, L_n\\}$，其中每个 $L_j$ 均从剂量集中抽取。这就构成了候选设计的完整集合。\n4.  对于每个候选设计：\n    a. 将一个 $2 \\times 2$ 的 FIM 初始化为零矩阵。\n    b. 对于每个测量点 $(t_j, L_j)$，使用推导出的公式计算灵敏度向量 $\\nabla_{\\theta}\\hat{S}$。\n    c. 计算 FIM 贡献 $\\frac{1}{\\sigma^2} \\nabla_{\\theta}\\hat{S} (\\nabla_{\\theta}\\hat{S})^T$ 并将其加到总 FIM 中。\n    d. 在对所有 $n$ 个点的贡献求和后，计算总 FIM 的行列式。\n5.  记录到目前为止发现的最大行列式及其对应的设计。\n6.  在评估了所有可能的设计之后，产生最高 FIM 行列式的那一个就是 D-最优设计。最终输出被格式化以呈现这个最大行列式、相应的排序后的时间点集合以及相关的剂量。", "answer": "[[1426.331294, [1.0, 5.0, 30.0], [10.0, 10.0, 10.0]],[25949.192398, [2.0, 8.0, 32.0], [5.0, 5.0, 50.0]],[199.141696, [10.0, 20.0, 40.0], [5.0, 50.0, 50.0]],[55157.073408, [0.5, 4.0], [0.001, 1.0]]]", "id": "3343891"}]}