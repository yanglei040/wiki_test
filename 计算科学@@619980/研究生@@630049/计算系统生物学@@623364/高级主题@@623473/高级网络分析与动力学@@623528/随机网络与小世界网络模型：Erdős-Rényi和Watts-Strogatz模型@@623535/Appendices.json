{"hands_on_practices": [{"introduction": "Erdős-Rényi (ER) 随机图是网络科学的基石，它常常作为一个重要的零模型，用于判断真实世界网络（如生物网络）中的某些特性是否具有统计显著性。掌握 ER 模型的一个基本技能是计算特定小型子图（即“网络基序”）的期望数量。第一个练习 [@problem_id:3342456] 将引导你使用强大而简洁的期望线性性质，来计算 $G(n,p)$ 图中边、三角形和四元环的期望数量。", "problem": "在计算系统生物学中，随机图零模型有助于评估细胞网络（例如蛋白质-蛋白质相互作用网络）中观察到的模体丰度是否偏离随机性。考虑一个建立在 $n$ 个带标号顶点上的 Erdős–Rényi (ER) 模型 $G(n,p)$，其中每条可能的无向边都以概率 $p \\in (0,1)$ 独立出现。令 $m$ 表示边的总数，$T$ 表示三角形（简单3-圈）的总数，$C_4$ 表示简单无向4-圈的总数。对于 $C_4$ 的计数，每个不同的无向简单4-圈只计一次，不考虑遍历方向或起始顶点；该圈不必是诱导的，因此这4个顶点之间的额外弦不影响计数。\n\n仅从 $G(n,p)$ 的核心定义和期望的线性性出发，推导期望 $\\mathbb{E}[m]$、$\\mathbb{E}[T]$ 和 $\\mathbb{E}[C_4]$ 关于 $n$ 和 $p$ 的闭式表达式。将你的最终答案表示为仅包含 $n$ 和 $p$ 的闭式解析表达式。不需要数值近似。最终答案必须是单一对象：将三个表达式按 $\\mathbb{E}[m]$、$\\mathbb{E}[T]$、$\\mathbb{E}[C_4]$ 的顺序列在一个单行矩阵中。", "solution": "我们从 Erdős–Rényi (ER) 模型 $G(n,p)$ 的定义开始：对于一个大小为 $n$ 的带标号顶点集，$\\binom{n}{2}$ 条可能的无向边中的每一条都以概率 $p \\in (0,1)$ 独立地被包含。我们使用指示随机变量和期望的线性性来计算子图的期望计数。\n\n首先，计算边的期望数 $\\mathbb{E}[m]$。令 $X_{e}$ 为特定无向边 $e$ 存在的指示变量。则 $m = \\sum_{e} X_{e}$，其中求和遍历所有 $\\binom{n}{2}$ 条可能的边。根据独立性及 $G(n,p)$ 的定义，有 $\\mathbb{P}(X_{e}=1)=p$，因此 $\\mathbb{E}[X_{e}] = p$。根据期望的线性性，\n$$\n\\mathbb{E}[m] \\;=\\; \\sum_{e} \\mathbb{E}[X_{e}] \\;=\\; \\binom{n}{2}\\, p.\n$$\n\n其次，计算三角形的期望数 $\\mathbb{E}[T]$。一个三角形由一个包含3个元素的顶点子集确定。对于每个无序三元组 $\\{i,j,k\\}$，定义一个指示变量 $Y_{\\{i,j,k\\}}$，表示这三个顶点之间的三条边都存在。由于这3条边中的每一条都以概率 $p$ 独立出现，我们有 $\\mathbb{P}(Y_{\\{i,j,k\\}}=1)=p^{3}$，所以 $\\mathbb{E}[Y_{\\{i,j,k\\}}]=p^{3}$。无序三元组的总数为 $\\binom{n}{3}$。因此，\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{\\{i,j,k\\}} \\mathbb{E}[Y_{\\{i,j,k\\}}]\n\\;=\\; \\binom{n}{3}\\, p^{3}.\n$$\n\n第三，计算简单无向4-圈的期望数 $\\mathbb{E}[C_4]$，计数时不考虑方向或起点，且不要求是诱导的。有两种等价的计数方法。\n\n方法1（通过有序圈和自同构因子）：考虑由不同顶点组成的有序4元组 $(v_{1},v_{2},v_{3},v_{4})$。$v_{1}$ 有 $n$ 种选择，$v_{2}$ 有 $(n-1)$ 种选择，$v_{3}$ 有 $(n-2)$ 种选择，$v_{4}$ 有 $(n-3)$ 种选择，总共产生 $n(n-1)(n-2)(n-3)$ 个有序元组。当且仅当4条边 $\\{v_{1},v_{2}\\}$、$\\{v_{2},v_{3}\\}$、$\\{v_{3},v_{4}\\}$ 和 $\\{v_{4},v_{1}\\}$ 都存在时，每个这样的有序元组确定一个有向简单4-圈。这4条边独立出现，其概率为 $p^{4}$，因此有序简单4-圈的期望数为 $n(n-1)(n-2)(n-3)\\, p^{4}$。每个无向4-圈恰好对应8个有序元组（有4种旋转和2种方向），即该圈的自同构群的大小为8。因此，\n$$\n\\mathbb{E}[C_4] \\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8}\\, p^{4}.\n$$\n\n方法2（通过4-顶点子集）：对于每个包含4个元素的顶点子集，在该顶点集上恰好有3个不同的无向简单4-圈（在旋转和反射下，4个带标号顶点上的哈密顿圈数量为3）。对于任何一个这样的无向圈，其所需的4条边都存在的概率是 $p^{4}$（边是独立的）。对 $\\binom{n}{4}$ 个顶点子集以及每个子集上的3个圈求和，\n$$\n\\mathbb{E}[C_4] \\;=\\; 3 \\binom{n}{4} \\, p^{4}\n\\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8}\\, p^{4},\n$$\n这与方法1的结果一致，因为 $3 \\binom{n}{4} = \\frac{3 n(n-1)(n-2)(n-3)}{24} = \\frac{n(n-1)(n-2)(n-3)}{8}$。\n\n汇总结果，\n$$\n\\mathbb{E}[m] \\;=\\; \\binom{n}{2} p,\\quad\n\\mathbb{E}[T] \\;=\\; \\binom{n}{3} p^{3},\\quad\n\\mathbb{E}[C_4] \\;=\\; \\frac{n(n-1)(n-2)(n-3)}{8} p^{4}.\n$$\n这些表达式是关于 $n$ 和 $p$ 的闭式解，并且仅依赖于 $G(n,p)$ 的独立性结构和期望的线性性。", "answer": "$$\\boxed{\\begin{pmatrix}\\binom{n}{2}\\, p  \\binom{n}{3}\\, p^{3}  \\dfrac{n(n-1)(n-2)(n-3)}{8}\\, p^{4}\\end{pmatrix}}$$", "id": "3342456"}, {"introduction": "虽然知道子图的期望数量很有用，但这只揭示了部分情况。为了进行可靠的统计推断，我们还必须了解该平均值附近的变异性。下一个练习 [@problem_id:3342490] 将通过计算 ER 图中三角形数量的方差来深入探讨这一点。这个计算过程更为复杂，因为它要求你仔细处理重叠三角形之间的依赖关系，从而让你接触到二阶矩方法，并为理解正态近似何时适用于网络统计量奠定基础。", "problem": "在计算系统生物学中使用的蛋白质-蛋白质相互作用网络的粗粒度模型中，假设 $n$ 个蛋白质组成的网络被建模为一个无向 Erdős–Rényi (ER) 随机图 $G(n,p)$，其中 $\\binom{n}{2}$ 种可能的蛋白质-蛋白质相互作用中的每一种都以概率 $p \\in (0,1)$ 独立存在。一个完全相互作用的 3-蛋白质复合物对应于一个无向三角形（一个 3-团）。令 $T$ 表示计算 $G(n,p)$ 中三角形数量的随机变量。\n\n仅从核心定义和独立性结构出发，且不假设任何预先存在的子图计数公式：\n- 推导 $\\mathbb{E}[T]$。\n- 通过将 $T$ 写成指示随机变量之和，并仔细枚举所有依赖性贡献，推导出 $\\mathrm{Var}(T)$ 的精确闭式表达式。\n- 基于您的方差表达式，讨论当 $n \\to \\infty$ 时，在哪种关于 $p=p(n)$ 的渐近区域中，对中心化和标准化的变量 $T$ 进行正态近似是合理的。您的讨论应基于第一性原理，例如针对弱相关被加项的中心极限定理（CLT）启发式思想或依赖图视角，并应明确指出至少两个定性上不同的从稀疏到稠密的区域，在这些区域中，渐近方差由不同的项主导。\n\n您最终报告的答案必须是您得到的 $\\mathrm{Var}(T)$ 作为 $n$ 和 $p$ 的函数的精确闭式解析表达式。不需要数值近似。不包括单位。", "solution": "我们将模型形式化并从第一性原理出发。在一个顶点集为 $[n] = \\{1,2,\\dots,n\\}$ 的无向 Erdős–Rényi (ER) 随机图 $G(n,p)$ 中，$\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p \\in (0,1)$ 独立存在。一个三角形是由3个不同顶点组成的集合，这3个顶点两两之间的3条边都存在。\n\n定义指示随机变量如下。对每个 $|a| = 3$ 的无序三元组 $a = \\{i,j,k\\} \\subset [n]$，令\n$$\nI_{a} \\;=\\; \\mathbf{1}\\{\\text{i,j,k 之间的所有 3 条边都存在}\\}.\n$$\n那么三角形的总数是\n$$\nT \\;=\\; \\sum_{a \\in \\binom{[n]}{3}} I_{a},\n$$\n其中 $\\binom{[n]}{3}$ 表示所有 $\\binom{n}{3}$ 个无序三元组的集合。\n\n**期望**。对于任何固定的三元组 $a$，所需的3条边是独立的，且每条边都以概率 $p$ 存在，所以\n$$\n\\mathbb{E}[I_{a}] \\;=\\; p^{3}.\n$$\n根据期望的线性性，\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{a} \\mathbb{E}[I_{a}]\n\\;=\\; \\binom{n}{3} p^{3}.\n$$\n\n**方差**。我们使用恒等式 $\\mathrm{Var}(T) = \\sum_{a,b} \\mathrm{Cov}(I_a, I_b)$。其中 $a$ 和 $b$ 是顶点三元组。协方差 $\\mathrm{Cov}(I_a, I_b) = \\mathbb{E}[I_a I_b] - \\mathbb{E}[I_a]\\mathbb{E}[I_b]$ 仅在指示变量 $I_a$ 和 $I_b$ 不独立时才为非零。这发生在构成两个三角形的边集有重叠时，即当顶点集 $a$ 和 $b$ 的交集大小至少为2时。\n\n我们分情况讨论：\n1.  **$a = b$** (交集大小为3): 两个三元组相同。\n    - 这种项的数量为 $\\binom{n}{3}$。\n    - 协方差为 $\\mathrm{Var}(I_a) = \\mathbb{E}[I_a^2] - (\\mathbb{E}[I_a])^2 = p^3 - (p^3)^2 = p^3(1 - p^3)$。\n    - 此部分对总方差的贡献为 $\\binom{n}{3} p^3 (1-p^3)$。\n\n2.  **$|a \\cap b| = 2$**: 两个三角形共享一条边。\n    - 这种结构由4个顶点确定，其中两个顶点构成共享边。\n    - 这种有序对 $(a,b)$ 的数量是 $12 \\binom{n}{4}$ (选择4个顶点；选择一个有序对作为共享边；为每个三角形选择第三个顶点)。\n    - 对于这样的一对，两个三角形总共需要5条边。因此 $\\mathbb{E}[I_a I_b] = p^5$。\n    - 协方差为 $\\mathrm{Cov}(I_a, I_b) = \\mathbb{E}[I_a I_b] - \\mathbb{E}[I_a]\\mathbb{E}[I_b] = p^5 - p^3 p^3 = p^5(1-p)$。\n    - 此部分对总方差的贡献为 $12 \\binom{n}{4} p^5(1-p)$。\n\n3.  **$|a \\cap b|  2$**: 两个三角形最多共享一个顶点。\n    - 它们不共享任何边，因此 $I_a$ 和 $I_b$ 是独立的随机变量。\n    - 协方差 $\\mathrm{Cov}(I_a, I_b) = 0$。\n\n将这些贡献加起来，我们得到 $\\mathrm{Var}(T)$ 的精确表达式：\n$$\n\\mathrm{Var}(T) \\;=\\; \\binom{n}{3} p^3(1-p^3) + 12 \\binom{n}{4} p^5(1-p).\n$$\n\n**正态近似的讨论**。中心极限定理 (CLT) 适用于独立或弱相关随机变量之和。在这里，$T$ 是相关指示变量 $I_a$ 的和。其分布是否趋于正态，取决于相关性的强度，这可以通过比较方差的两个项来评估。\n- 方差的第一项 $\\binom{n}{3}p^3(1-p^3) \\sim \\frac{n^3}{6}p^3$ (忽略低阶项)。\n- 方差的第二项 $12\\binom{n}{4}p^5(1-p) \\sim \\frac{n^4}{2}p^5$。\n\n我们比较这两个项的量级：\n- **稀疏区域 ($p \\ll n^{-1/2}$)**: 在这个区域，$n^3 p^3 \\gg n^4 p^5$，即 $1 \\gg n p^2$。方差由第一项主导，$\\mathrm{Var}(T) \\approx \\mathbb{E}[T]$。这表明三角形是稀疏的，很少重叠。$T$ 的行为类似于泊松分布，而不是正态分布。\n- **稠密区域 ($p \\gg n^{-1/2}$)**: 在这个区域，$n^3 p^3 \\ll n^4 p^5$，即 $1 \\ll n p^2$。方差由第二项（协方差项）主导。这表示三角形之间的相关性很强。然而，在更广阔的依赖图（其中节点是三元组，边连接共享边的三元组对）中，每个节点的度相对较小。根据适用于弱相关变量的CLT变体，只要 $p$ 不是太接近1，正态近似通常是合理的。特别是当 $p$ 是常数或 $p \\gg n^{-1}$ 时，$T$ 的分布在中心化和标准化后将很好地近似于正态分布。\n\n因此，至少存在两个区域：一个是由泊松行为主导的极稀疏区域 ($np^2 \\to 0$)，另一个是CLT开始适用的更稠密区域 ($np^2 \\to \\infty$)，其中正态近似是合理的。", "answer": "$$\\boxed{\\binom{n}{3} \\, p^{3} \\left(1 - p^{3}\\right) \\;+\\; 12 \\binom{n}{4} \\, p^{5} \\left(1 - p\\right)}$$", "id": "3342490"}, {"introduction": "理论模型的最大威力在于其能够与真实世界的数据进行比较。虽然 ER 图提供了一个基准，但许多生物网络表现出“小世界”特性——高聚类系数和短平均路径长度，这些特性更适合用 Watts-Strogatz (WS) 等模型来捕捉。最后一个动手实践 [@problem_id:3342454] 让你扮演数据科学家的角色，任务是分别将 ER 和 WS 模型与观测到的网络统计数据进行拟合，并使用一个量化标准来判断哪个模型能更好地解释数据。这个练习突出了网络模型在表征和理解真实生物系统拓扑结构方面的实际应用。", "problem": "给定一个蛋白质-蛋白质相互作用网络的四个观测摘要统计量：节点数 $n$、边数 $m$、平均聚类系数 $C_{\\mathrm{obs}}$ 和平均最短路径长度 $L_{\\mathrm{obs}}$。您的任务是使用矩量法拟合程序将数据拟合到两个典型的网络模型，并判断哪个模型能更好地解释观测数据：\n\n- Erdős–Rényi 随机图 $G(n,p)$，其中每对节点以概率 $p$ 独立连接。\n- Watts–Strogatz 小世界模型，其参数为环形晶格度 $k$（假定为偶数）和重连概率 $\\beta$。\n\n将使用的基本核心定义：\n\n1. 在 Erdős–Rényi $G(n,p)$ 模型中，预期的边数为 $E[m] = p \\binom{n}{2}$，预期的聚类系数为 $C_{\\mathrm{ER}} \\approx p$。在连通区域 $np > 1$ 中，平均路径长度可以很好地近似为\n$$\nL_{\\mathrm{ER}} \\approx \\frac{\\ln n}{\\ln (np)}.\n$$\n\n2. 在 Watts–Strogatz 模型中，从一个度为偶数 $k$ 的环形晶格开始，并以概率 $\\beta$ 独立地重连每条边。在重连之前的规则环形晶格中，聚类系数为\n$$\nC_{\\mathrm{lat}}(k) = \\begin{cases}\n\\frac{3(k-2)}{4(k-1)},  k \\ge 2, \\\\\n0,  k  2,\n\\end{cases}\n$$\n平均路径长度近似为\n$$\nL_{\\mathrm{lat}}(k) \\approx \\frac{n}{2k}.\n$$\n以概率 $\\beta$ 进行重连后，一个广泛使用的聚类矩近似为\n$$\nC_{\\mathrm{WS}}(\\beta) \\approx C_{\\mathrm{lat}}(k) \\,(1-\\beta)^3,\n$$\n这反映了三角形的三条边都必须避免被重连，才能保持为三角形。对于平均路径长度，使用一个与晶格极限和类随机捷径极限一致的插值，\n$$\nL_{\\mathrm{rand}}(n,k) \\approx \\frac{\\ln n}{\\ln k}, \\quad k > 1,\n$$\n和\n$$\nL_{\\mathrm{WS}}(n,k,\\beta) \\approx L_{\\mathrm{lat}}(k)\\,\\exp\\!\\left(-\\frac{\\beta n k}{2}\\right) + L_{\\mathrm{rand}}(n,k)\\left(1 - \\exp\\!\\left(-\\frac{\\beta n k}{2}\\right)\\right),\n$$\n该插值使用捷径的预期数量 $\\beta m \\approx \\beta n k / 2$ 作为交叉尺度。\n\n矩量法拟合协议：\n\n- 对于 $G(n,p)$，通过恒等式 $E[m] = p \\binom{n}{2}$ 匹配观测到的 $m$ 来拟合 $p$。使用 $\\hat{p} = \\frac{2m}{n(n-1)}$，然后通过 $\\hat{C}_{\\mathrm{ER}} = \\hat{p}$ 预测聚类系数，并通过 $\\hat{L}_{\\mathrm{ER}} \\approx \\frac{\\ln n}{\\ln(n\\hat{p})}$ 预测平均路径长度（如果 $n\\hat{p} > 1$）；否则，取 $\\hat{L}_{\\mathrm{ER}} = +\\infty$ 作为非连通区域的渐近特征。\n\n- 对于 Watts–Strogatz，通过 $E[m] = \\frac{nk}{2}$ 匹配观测到的 $m$ 来拟合 $k$。使用 $\\hat{k} = \\mathrm{round}\\!\\left(\\frac{2m}{n}\\right)$，并调整到范围 $[2,n-1]$ 内最接近的偶数。然后，通过 $\\hat{\\beta} = 1 - \\left(\\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{lat}}(\\hat{k})}\\right)^{1/3}$ 匹配观测到的聚类系数来拟合 $\\beta$，并截断到区间 $[0,1]$。如果 $C_{\\mathrm{lat}}(\\hat{k}) = 0$ 且 $C_{\\mathrm{obs}} > 0$，则设置 $\\hat{\\beta} = 1$；如果 $C_{\\mathrm{lat}}(\\hat{k}) = 0$ 且 $C_{\\mathrm{obs}} = 0$，则设置 $\\hat{\\beta} = 0$。使用上述插值公式预测平均路径长度。\n\n模型选择标准：\n\n- 对于每个模型，定义平方相对误差\n$$\nE = \\left(\\frac{\\hat{C} - C_{\\mathrm{obs}}}{\\max(C_{\\mathrm{obs}}, \\epsilon)}\\right)^2 + \\left(\\frac{\\hat{L} - L_{\\mathrm{obs}}}{\\max(L_{\\mathrm{obs}}, \\epsilon)}\\right)^2,\n$$\n其中稳定化常数 $\\epsilon = 10^{-12}$。选择 $E$ 较小的模型。如果出现平局，则选择 Erdős–Rényi 模型。\n\n测试套件：\n\n在以下四个参数集 $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}})$ 上评估您的程序，这些参数表示为无量纲量：\n\n1. $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}}) = (800, 2920, 0.0092, 3.36)$,\n2. $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}}) = (1000, 5000, 0.4, 3.1)$,\n3. $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}}) = (500, 300, 0.002, 35.0)$,\n4. $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}}) = (2000, 8000, 0.5, 3.7)$.\n\n最终输出：\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目都是一个整数：如果 Erdős–Rényi $G(n,p)$ 模型能更好地解释数据，则为 $0$；如果 Watts–Strogatz $(k,\\beta)$ 模型能更好地解释数据，则为 $1$。对于上述测试套件，输出必须采用以下确切格式\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4].\n$$", "solution": "该问题的任务是，对于给定的四组网络统计数据 $(n,m,C_{\\mathrm{obs}},L_{\\mathrm{obs}})$，判断 Erdős–Rényi (ER) 模型和 Watts–Strogatz (WS) 模型哪个拟合得更好。我们将遵循问题中详细说明的矩量法拟合协议和模型选择标准来完成此任务。\n\n**通用分析流程**\n\n**第一部分：Erdős–Rényi 模型分析**\n\n1.  **参数拟合：** 通过将模型的预期边数 $E[m] = p \\frac{n(n-1)}{2}$ 与观测边数 $m$ 匹配，来拟合唯一的参数 $p$。估计值为 $\\hat{p} = \\frac{2m}{n(n-1)}$。\n\n2.  **预测：** 使用拟合的参数 $\\hat{p}$，预测聚类系数和平均路径长度。预测的聚类系数为 $\\hat{C}_{\\mathrm{ER}} = \\hat{p}$。预测的平均路径长度为 $\\hat{L}_{\\mathrm{ER}} = \\frac{\\ln n}{\\ln(n\\hat{p})}$ (若 $n\\hat{p} > 1$) 或 $\\infty$ (否则)。\n\n3.  **误差计算：** ER 模型的平方相对误差 $E_{\\mathrm{ER}}$ 按给定公式计算：\n    $$\n    E_{\\mathrm{ER}} = \\left(\\frac{\\hat{C}_{\\mathrm{ER}} - C_{\\mathrm{obs}}}{\\max(C_{\\mathrm{obs}}, \\epsilon)}\\right)^2 + \\left(\\frac{\\hat{L}_{\\mathrm{ER}} - L_{\\mathrm{obs}}}{\\max(L_{\\mathrm{obs}}, \\epsilon)}\\right)^2\n    $$\n\n**第二部分：Watts–Strogatz 模型分析**\n\n1.  **参数拟合 ($\\hat{k}$):** 通过将预期边数 $E[m] = \\frac{nk}{2}$ 与观测到的 $m$ 匹配来拟合度参数 $k$。首先计算 $\\frac{2m}{n}$，然后四舍五入到最近的偶数，并确保结果在 $[2, n-1]$ 范围内。\n\n2.  **参数拟合 ($\\hat{\\beta}$):** 通过将预测的聚类系数 $C_{\\mathrm{WS}}(\\beta) \\approx C_{\\mathrm{lat}}(\\hat{k})(1-\\beta)^3$ 与观测到的 $C_{\\mathrm{obs}}$ 匹配来拟合重连概率 $\\beta$。首先计算基础晶格的聚类系数 $C_{\\mathrm{lat}}(\\hat{k}) = \\frac{3(\\hat{k}-2)}{4(\\hat{k}-1)}$。然后求解 $\\beta$，得到 $\\hat{\\beta} = 1 - \\left(\\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{lat}}(\\hat{k})}\\right)^{1/3}$，并处理 $C_{\\mathrm{lat}}(\\hat{k})=0$ 的边缘情况，最后将 $\\hat{\\beta}$ 截断到 $[0, 1]$ 区间。\n\n3.  **预测：** 使用拟合的参数 $\\hat{k}$ 和 $\\hat{\\beta}$，预测聚类系数 $\\hat{C}_{\\mathrm{WS}} = C_{\\mathrm{lat}}(\\hat{k}) (1-\\hat{\\beta})^3$ 和平均路径长度 $\\hat{L}_{\\mathrm{WS}}$ (使用指定的插值公式)。\n\n4.  **误差计算：** WS 模型的平方相对误差 $E_{\\mathrm{WS}}$ 按相同公式计算。\n\n**第三部分：模型选择**\n\n对于每个测试案例，比较两个误差值 $E_{\\mathrm{ER}}$ 和 $E_{\\mathrm{WS}}$。\n- 如果 $E_{\\mathrm{WS}}  E_{\\mathrm{ER}}$，选择 Watts-Strogatz 模型（输出 $1$）。\n- 否则（$E_{\\mathrm{ER}} \\le E_{\\mathrm{WS}}$），选择 Erdős–Rényi 模型（输出 $0$）。\n\n**对测试套件的计算**\n\n应用上述流程于四个测试案例：\n1.  **案例 1: $(800, 2920, 0.0092, 3.36)$**\n    - ER模型：$\\hat{p} \\approx 0.00914$, $\\hat{C}_{\\mathrm{ER}} \\approx 0.00914$, $\\hat{L}_{\\mathrm{ER}} \\approx 3.360$。误差 $E_{\\mathrm{ER}}$ 非常小。\n    - WS模型：$\\hat{k}=8$, $\\hat{\\beta} \\approx 0.758$。$\\hat{C}_{\\mathrm{WS}} \\approx 0.0091$, $\\hat{L}_{\\mathrm{WS}} \\approx 3.214$。\n    - 比较：$E_{\\mathrm{ER}}  E_{\\mathrm{WS}}$。选择 **ER (0)**。\n\n2.  **案例 2: $(1000, 5000, 0.4, 3.1)$**\n    - ER模型：$\\hat{p} \\approx 0.01$。$\\hat{C}_{\\mathrm{ER}} \\approx 0.01$，与 $C_{\\mathrm{obs}}=0.4$ 相差甚远。误差 $E_{\\mathrm{ER}}$ 巨大。\n    - WS模型：$\\hat{k}=10$, $\\hat{\\beta} \\approx 0.157$。通过构造，$\\hat{C}_{\\mathrm{WS}}$ 接近 $C_{\\mathrm{obs}}$。$\\hat{L}_{\\mathrm{WS}} \\approx 3.0$，与 $L_{\\mathrm{obs}}=3.1$ 非常接近。误差 $E_{\\mathrm{WS}}$ 很小。\n    - 比较：$E_{\\mathrm{WS}}  E_{\\mathrm{ER}}$。选择 **WS (1)**。\n\n3.  **案例 3: $(500, 300, 0.002, 35.0)$**\n    - ER模型：$\\hat{p} \\approx 0.0024$。$\\hat{C}_{\\mathrm{ER}} \\approx 0.0024$，接近 $C_{\\mathrm{obs}}=0.002$。$n\\hat{p} \\approx 1.2 > 1$, $\\hat{L}_{\\mathrm{ER}} \\approx 34.1$，接近 $L_{\\mathrm{obs}}=35.0$。误差 $E_{\\mathrm{ER}}$ 较小。\n    - WS模型：$\\hat{k}=2$。$C_{\\mathrm{lat}}(2)=0$。由于 $C_{\\mathrm{obs}}>0$，$\\hat{\\beta}=1$。这导致 $\\hat{C}_{\\mathrm{WS}}=0$，$\\hat{L}_{\\mathrm{WS}} \\approx 8.96$。两者都与观测值相差很大。\n    - 比较：$E_{\\mathrm{ER}}  E_{\\mathrm{WS}}$。选择 **ER (0)**。\n\n4.  **案例 4: $(2000, 8000, 0.5, 3.7)$**\n    - ER模型：$\\hat{p} \\approx 0.004$。$\\hat{C}_{\\mathrm{ER}} \\approx 0.004$，与 $C_{\\mathrm{obs}}=0.5$ 相差甚远。误差 $E_{\\mathrm{ER}}$ 巨大。\n    - WS模型：$\\hat{k}=8$, $\\hat{\\beta} \\approx 0.081$。$\\hat{C}_{\\mathrm{WS}}$ 接近 $C_{\\mathrm{obs}}$。$\\hat{L}_{\\mathrm{WS}} \\approx 3.65$，与 $L_{\\mathrm{obs}}=3.7$ 非常接近。误差 $E_{\\mathrm{WS}}$ 很小。\n    - 比较：$E_{\\mathrm{WS}}  E_{\\mathrm{ER}}$。选择 **WS (1)**。\n\n综上所述，四个案例的最佳拟合模型分别为 ER、WS、ER、WS。", "answer": "$$\\boxed{[0,1,0,1]}$$", "id": "3342454"}]}