{"hands_on_practices": [{"introduction": "评估任何统计模型的第一步是量化其对观测数据的解释程度。本练习 [@problem_id:3303919] 提供了一个具体的机会，让你在一个完全指定的动态贝叶斯网络下计算时间序列数据集的对数似然。通过这个计算，你将对模型的结构和参数如何转化为数据拟合度的度量有一个基本的理解。", "problem": "一个基因调控模块被建模为一个动态贝叶斯网络（DBN），其中潜在的转录活动 $X_t$ 在离散时间点 $t = 1, \\dots, T$ 上驱动观察到的基因表达 $Y_t$。该DBN遵循一个双切片模板，其中 $X_t$ 具有一阶马尔可夫转移，$Y_t$ 给定 $X_t$ 具有条件发射，每个都由线性高斯族指定。具体来说，生物学假设是：\n- 潜在动态是一阶自回归（AR）的：$X_t \\mid X_{t-1} \\sim \\mathcal{N}(\\alpha X_{t-1}, \\sigma_x^2)$。\n- 观测模型是带有加性噪声的线性模型：$Y_t \\mid X_t \\sim \\mathcal{N}(\\gamma X_t, \\sigma_y^2)$。\n\n假设全文使用自然对数，并以奈特（nats）为单位表示最终数值答案。模型参数为 $T = 4$，$\\alpha = 0.5$，$\\gamma = 1.0$，$\\sigma_x^2 = 0.5$，以及 $\\sigma_y^2 = 0.5$。提供了一个完整数据时间序列（为此计算，潜在变量和观测变量均视为给定）：\n- 潜在状态：$(X_1, X_2, X_3, X_4) = (2, 1.1, 0.5, 0.1)$。\n- 观测值：$(Y_1, Y_2, Y_3, Y_4) = (1.8, 1.05, 0.6, 0.05)$。\n\n使用DBN双切片模板所隐含的标准概率分解和高斯族的定义，计算该序列在此模型下的完整数据对数似然。将您的最终数值答案四舍五入到五位有效数字，并以奈特（nats）表示。", "solution": "该问题被评估为有效。它在科学上基于动态贝叶斯网络（DBN）和线性高斯状态空间模型的既定理论，这些是计算系统生物学中的标准工具。该问题是适定的，提供了计算唯一、有意义的对数似然值所需的所有必要参数、模型定义和完整数据序列。术语是精确和客观的。\n\n潜在状态序列 $X_{1:T} = (X_1, \\dots, X_T)$ 和观测序列 $Y_{1:T} = (Y_1, \\dots, Y_T)$ 的完整数据对数似然是联合概率密度 $P(X_{1:T}, Y_{1:T})$ 的自然对数。给定由DBN双切片模板定义的条件依赖关系，该联合概率可分解为：\n$$P(X_{1:T}, Y_{1:T}) = P(X_1) \\left( \\prod_{t=2}^{T} P(X_t \\mid X_{t-1}) \\right) \\left( \\prod_{t=1}^{T} P(Y_t \\mid X_t) \\right)$$\n模型规范提供了转移概率 $P(X_t \\mid X_{t-1})$ 和发射概率 $P(Y_t \\mid X_t)$，但没有提供初始状态分布 $P(X_1)$。然而，问题提供了一个完整的数据轨迹，包括 $X_1$ 的值。在这种情况下，标准做法是计算序列其余部分在初始状态 $X_1$ 条件下的似然。因此，要计算的量是条件对数似然 $\\mathcal{L} = \\ln P(X_{2:T}, Y_{1:T} \\mid X_1)$。\n\n完整数据对数似然，按规定使用自然对数（单位：奈特），由下式给出：\n$$\\mathcal{L} = \\ln \\left[ \\left( \\prod_{t=2}^{T} P(X_t \\mid X_{t-1}) \\right) \\left( \\prod_{t=1}^{T} P(Y_t \\mid X_t) \\right) \\right] = \\sum_{t=2}^{T} \\ln P(X_t \\mid X_{t-1}) + \\sum_{t=1}^{T} \\ln P(Y_t \\mid X_t)$$\n这个表达式可以分解为两个部分：转移对数似然 $\\mathcal{L}_X$ 和发射对数似然 $\\mathcal{L}_Y$。\n$$\\mathcal{L} = \\mathcal{L}_X + \\mathcal{L}_Y$$\n高斯分布 $\\mathcal{N}(z \\mid \\mu, \\sigma^2)$ 的概率密度函数（PDF）是 $p(z) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(z-\\mu)^2}{2\\sigma^2}\\right)$。相应的对数概率密度函数是：\n$$\\ln p(z) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(z-\\mu)^2}{2\\sigma^2}$$\n\n首先，我们计算转移对数似然分量 $\\mathcal{L}_X$。\n转移模型是 $X_t \\mid X_{t-1} \\sim \\mathcal{N}(\\alpha X_{t-1}, \\sigma_x^2)$。给定参数是 $\\alpha = 0.5$ 和 $\\sigma_x^2 = 0.5$。时间序列长度为 $T=4$。\n$$\\mathcal{L}_X = \\sum_{t=2}^{4} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma_x^2) - \\frac{(X_t - \\alpha X_{t-1})^2}{2\\sigma_x^2} \\right]$$\n代入 $\\sigma_x^2 = 0.5$，每一项的表达式简化为：\n$$\\ln P(X_t \\mid X_{t-1}) = -\\frac{1}{2}\\ln(2\\pi \\cdot 0.5) - \\frac{(X_t - 0.5 X_{t-1})^2}{2 \\cdot 0.5} = -\\frac{1}{2}\\ln(\\pi) - (X_t - 0.5 X_{t-1})^2$$\n使用所提供的数据 $(X_1, X_2, X_3, X_4) = (2, 1.1, 0.5, 0.1)$：\n- 对于 $t=2$：$\\ln P(X_2 \\mid X_1) = -\\frac{1}{2}\\ln(\\pi) - (1.1 - 0.5 \\cdot 2)^2 = -\\frac{1}{2}\\ln(\\pi) - (1.1 - 1)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.01$。\n- 对于 $t=3$：$\\ln P(X_3 \\mid X_2) = -\\frac{1}{2}\\ln(\\pi) - (0.5 - 0.5 \\cdot 1.1)^2 = -\\frac{1}{2}\\ln(\\pi) - (0.5 - 0.55)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.0025$。\n- 对于 $t=4$：$\\ln P(X_4 \\mid X_3) = -\\frac{1}{2}\\ln(\\pi) - (0.1 - 0.5 \\cdot 0.5)^2 = -\\frac{1}{2}\\ln(\\pi) - (0.1 - 0.25)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.0225$。\n将这些项相加得到 $\\mathcal{L}_X$：\n$$\\mathcal{L}_X = 3 \\left(-\\frac{1}{2}\\ln(\\pi)\\right) - (0.01 + 0.0025 + 0.0225) = -\\frac{3}{2}\\ln(\\pi) - 0.035$$\n\n接下来，我们计算发射对数似然分量 $\\mathcal{L}_Y$。\n发射模型是 $Y_t \\mid X_t \\sim \\mathcal{N}(\\gamma X_t, \\sigma_y^2)$。给定参数是 $\\gamma = 1.0$ 和 $\\sigma_y^2 = 0.5$。\n$$\\mathcal{L}_Y = \\sum_{t=1}^{4} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma_y^2) - \\frac{(Y_t - \\gamma X_t)^2}{2\\sigma_y^2} \\right]$$\n代入 $\\sigma_y^2=0.5$ 和 $\\gamma=1.0$，每一项的表达式是：\n$$\\ln P(Y_t \\mid X_t) = -\\frac{1}{2}\\ln(2\\pi \\cdot 0.5) - \\frac{(Y_t - 1.0 \\cdot X_t)^2}{2 \\cdot 0.5} = -\\frac{1}{2}\\ln(\\pi) - (Y_t - X_t)^2$$\n使用所提供的数据 $(X_1, X_2, X_3, X_4) = (2, 1.1, 0.5, 0.1)$ 和 $(Y_1, Y_2, Y_3, Y_4) = (1.8, 1.05, 0.6, 0.05)$：\n- 对于 $t=1$：$\\ln P(Y_1 \\mid X_1) = -\\frac{1}{2}\\ln(\\pi) - (1.8 - 2)^2 = -\\frac{1}{2}\\ln(\\pi) - (-0.2)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.04$。\n- 对于 $t=2$：$\\ln P(Y_2 \\mid X_2) = -\\frac{1}{2}\\ln(\\pi) - (1.05 - 1.1)^2 = -\\frac{1}{2}\\ln(\\pi) - (-0.05)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.0025$。\n- 对于 $t=3$：$\\ln P(Y_3 \\mid X_3) = -\\frac{1}{2}\\ln(\\pi) - (0.6 - 0.5)^2 = -\\frac{1}{2}\\ln(\\pi) - (0.1)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.01$。\n- 对于 $t=4$：$\\ln P(Y_4 \\mid X_4) = -\\frac{1}{2}\\ln(\\pi) - (0.05 - 0.1)^2 = -\\frac{1}{2}\\ln(\\pi) - (-0.05)^2 = -\\frac{1}{2}\\ln(\\pi) - 0.0025$。\n将这些项相加得到 $\\mathcal{L}_Y$：\n$$\\mathcal{L}_Y = 4 \\left(-\\frac{1}{2}\\ln(\\pi)\\right) - (0.04 + 0.0025 + 0.01 + 0.0025) = -2\\ln(\\pi) - 0.055$$\n\n最后，总的完整数据对数似然是这两个分量的和：\n$$\\mathcal{L} = \\mathcal{L}_X + \\mathcal{L}_Y = \\left(-\\frac{3}{2}\\ln(\\pi) - 0.035\\right) + \\left(-2\\ln(\\pi) - 0.055\\right)$$\n$$\\mathcal{L} = -\\frac{7}{2}\\ln(\\pi) - 0.09$$\n为了获得数值，我们使用 $\\ln(\\pi) \\approx 1.1447298858$：\n$$\\mathcal{L} \\approx -3.5 \\times 1.1447298858 - 0.09 \\approx -4.0065546 - 0.09 = -4.0965546$$\n将结果四舍五入到五位有效数字，我们得到 $-4.0966$。", "answer": "$$\\boxed{-4.0966}$$", "id": "3303919"}, {"introduction": "生物系统是复杂的，通常有多个模型可以在不同程度上解释数据。本练习 [@problem_id:3303887] 介绍了模型选择这一关键任务，我们必须在模型的拟合优度和其复杂性之间取得平衡。通过应用赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC)，你将学习如何定量地比较不同的 DBN 结构，并选择那个能在避免欠拟合和过拟合之间提供最佳权衡的模型。", "problem": "一个基因调控过程在 $T=121$ 个等间隔时间点上对 $p=30$ 种信使核糖核酸 (mRNA) 进行了监测。你使用两个候选的动态贝叶斯网络 (DBN) 对其动态进行建模，该模型遵循高斯线性条件设定，排除了同期边缘，但允许所有滞后边缘，最大滞后阶数为模型的最大滞后 $L$。对于每个基因和每个滞后父节点，有一个回归系数，此外每个基因还有一个截距和一个噪声方差。模型如下：\n- $M_{1}$：最大滞后 $L=1$，\n- $M_{2}$：最大滞后 $L=2$。\n\n对于每个模型 $M_{L}$，在可用时间指数 $t=L+1,\\dots,T$ 上计算得到的最大化对数似然（自然对数）如下：\n- $\\ln \\mathcal{L}(M_{1})=-50500$，\n- $\\ln \\mathcal{L}(M_{2})=-49550$。\n\n假设贝叶斯信息准则 (BIC) 中使用的有效样本量是 DBN 似然中条件独立项的数量，$n_{L}=p\\,(T-L)$，并且所有对数都是自然对数。仅从赤池信息准则 (AIC) 作为期望库尔贝克-莱布勒散度的近似无偏估计，以及施瓦茨的贝叶斯信息准则 (BIC) 作为负两倍对数边际似然的大样本拉普拉斯近似的定义出发，完成以下任务：\n1. 根据最大化对数似然、自由参数数量 $k$ 和有效样本量 $n$，推导 AIC 和 BIC 的表达式。\n2. 在所述的 DBN 参数化下，计算 $M_{1}$ 和 $M_{2}$ 的总参数数量 $k_{1}$ 和 $k_{2}$。\n3. 使用你推导的表达式，计算 $M_{1}$ 和 $M_{2}$ 的 AIC 和 BIC，并确定每个准则偏好哪个模型。\n4. 定义 $\\Delta \\mathrm{BIC}=\\mathrm{BIC}(M_{2})-\\mathrm{BIC}(M_{1})$ 并计算其数值。\n\n以奈特 (nats) 为单位表示 $\\Delta \\mathrm{BIC}$ 的最终数值，并将最终答案四舍五入到四位有效数字。最终答案必须是一个实数。", "solution": "该问题经确认为具有科学依据、提法明确、客观且完整。所有进行所需推导和计算的必要信息均已提供。\n\n解答过程按题目要求分为四个部分。\n\n**1. AIC 和 BIC 表达式的推导**\n\n赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 都是用于模型选择的准则，它们在模型拟合度（通过最大化对数似然衡量）和模型复杂度（通过参数数量衡量）之间进行权衡。\n\n题目指出，AIC 是期望库尔贝克-莱布勒 (KL) 散度的近似无偏估计。KL 散度衡量了用一个模型来近似真实数据生成过程时所损失的信息。对于一个有 $k$ 个自由参数并拟合于数据，得到最大化对数似然 $\\ln \\mathcal{L}$ 的模型，Akaike 证明了期望 KL 散度的一个近似无偏估计（相差一个加性常数和一个因子 $2$）由以下公式给出：\n$$\n\\mathrm{AIC} = -2 \\ln \\mathcal{L} + 2k\n$$\n其中 $k$ 是模型中估计的参数数量。较低的 AIC 值表示在对复杂性进行惩罚后，模型拟合得更好。\n\n题目指出，BIC 源于对模型负两倍对数边际似然 $-2 \\ln P(\\text{data}|M)$ 的大样本拉普拉斯近似。边际似然 $P(\\text{data}|M)$ 涉及对模型参数 $\\theta$ 进行积分。对于大样本量 $n$ 的拉普拉斯近似导出了以下表达式：\n$$\n-2 \\ln P(\\text{data}|M) \\approx -2 \\ln \\mathcal{L} + k \\ln n\n$$\n这就是贝叶斯信息准则 (BIC)，也称为施瓦茨准则：\n$$\n\\mathrm{BIC} = -2 \\ln \\mathcal{L} + k \\ln n\n$$\n其中 $k$ 是参数数量，$\\ln \\mathcal{L}$ 是最大化对数似然，而 $n$ 是有效样本量。与 AIC 一样，更低的 BIC 值更优。\n\n**2. 总参数数量 ($k_1$ 和 $k_2$) 的计算**\n\nDBN 模型被指定为高斯线性系统。对于一个最大滞后为 $L$ 的模型，时间点 $t$ 时 $p$ 种 mRNA 中每一种的值被建模为在时间点 $t-1, \\dots, t-L$ 时所有 $p$ 种 mRNA 的线性函数。\n\n对于单个基因 $j \\in \\{1,\\dots,p\\}$，预测变量是在 $L$ 个滞后中每一个滞后的 $p$ 个物种。这给出了 $p \\times L$ 个预测变量。模型设定包括对每个预测变量的一个回归系数。此外，对每个基因，有一个截距项和一个噪声方差参数。\n因此，单个基因的参数数量为：\n$$\nk_{\\text{gene}} = (p \\times L)_{\\text{系数}} + 1_{\\text{截距}} + 1_{\\text{方差}} = pL + 2\n$$\n由于有 $p$ 个基因，并且它们的模型在 DBN 似然分解中是条件独立的，因此模型 $M_L$ 的总参数数量 $k_L$ 是所有 $p$ 个基因的参数之和：\n$$\nk_L = p \\times (pL + 2) = p^2 L + 2p\n$$\n给定 $p=30$。\n\n对于模型 $M_1$，最大滞后为 $L=1$。参数数量 $k_1$ 为：\n$$\nk_1 = p^2(1) + 2p = 30^2 + 2(30) = 900 + 60 = 960\n$$\n\n对于模型 $M_2$，最大滞后为 $L=2$。参数数量 $k_2$ 为：\n$$\nk_2 = p^2(2) + 2p = 2(30^2) + 2(30) = 2(900) + 60 = 1800 + 60 = 1860\n$$\n\n**3. AIC 和 BIC 的计算及模型偏好**\n\n首先，我们使用给定公式 $n_L = p(T-L)$ 计算有效样本量 $n_L$。我们有 $p=30$ 和 $T=121$。\n\n对于 $M_1$ ($L=1$)：\n$$\nn_1 = p(T-1) = 30(121-1) = 30 \\times 120 = 3600\n$$\n\n对于 $M_2$ ($L=2$)：\n$$\nn_2 = p(T-2) = 30(121-2) = 30 \\times 119 = 3570\n$$\n\n给定的最大化对数似然为：$\\ln \\mathcal{L}(M_{1})=-50500$ 和 $\\ln \\mathcal{L}(M_{2})=-49550$。\n\n现在，我们计算两个模型的 AIC：\n$$\n\\mathrm{AIC}(M_1) = -2\\ln\\mathcal{L}(M_1) + 2k_1 = -2(-50500) + 2(960) = 101000 + 1920 = 102920\n$$\n$$\n\\mathrm{AIC}(M_2) = -2\\ln\\mathcal{L}(M_2) + 2k_2 = -2(-49550) + 2(1860) = 99100 + 3720 = 102820\n$$\n比较 AIC 值，我们有 $\\mathrm{AIC}(M_2)  \\mathrm{AIC}(M_1)$。因此，**AIC 偏好模型 $M_2$**。\n\n接下来，我们计算两个模型的 BIC：\n$$\n\\mathrm{BIC}(M_1) = -2\\ln\\mathcal{L}(M_1) + k_1 \\ln(n_1) = -2(-50500) + 960 \\ln(3600) = 101000 + 960 \\ln(3600)\n$$\n$$\n\\mathrm{BIC}(M_2) = -2\\ln\\mathcal{L}(M_2) + k_2 \\ln(n_2) = -2(-49550) + 1860 \\ln(3570) = 99100 + 1860 \\ln(3570)\n$$\n为了比较这些值，我们可以近似计算：\n$\\ln(3600) \\approx 8.1887$，所以 $\\mathrm{BIC}(M_1) \\approx 101000 + 960 \\times 8.1887 \\approx 101000 + 7861.2 = 108861.2$。\n$\\ln(3570) \\approx 8.1802$，所以 $\\mathrm{BIC}(M_2) \\approx 99100 + 1860 \\times 8.1802 \\approx 99100 + 15215.2 = 114315.2$。\n比较 BIC 值，我们有 $\\mathrm{BIC}(M_1)  \\mathrm{BIC}(M_2)$。因此，**BIC 偏好模型 $M_1$**。与 AIC ($2k$) 相比，BIC 更强的惩罚项 ($k \\ln n$) 对 $M_2$ 更高的复杂性施加了更重的惩罚，从而压倒了其更好的拟合度（更高的似然）。\n\n**4. $\\Delta \\mathrm{BIC}$ 的计算**\n\n我们被要求计算 $\\Delta \\mathrm{BIC}=\\mathrm{BIC}(M_{2})-\\mathrm{BIC}(M_{1})$。使用上一步的表达式：\n$$\n\\Delta \\mathrm{BIC} = \\left( -2\\ln\\mathcal{L}(M_2) + k_2 \\ln(n_2) \\right) - \\left( -2\\ln\\mathcal{L}(M_1) + k_1 \\ln(n_1) \\right)\n$$\n$$\n\\Delta \\mathrm{BIC} = -2(\\ln\\mathcal{L}(M_2) - \\ln\\mathcal{L}(M_1)) + k_2 \\ln(n_2) - k_1 \\ln(n_1)\n$$\n代入给定值：\n$\\ln\\mathcal{L}(M_1) = -50500$\n$\\ln\\mathcal{L}(M_2) = -49550$\n$k_1 = 960$\n$k_2 = 1860$\n$n_1 = 3600$\n$n_2 = 3570$\n$$\n\\Delta \\mathrm{BIC} = -2(-49550 - (-50500)) + 1860 \\ln(3570) - 960 \\ln(3600)\n$$\n$$\n\\Delta \\mathrm{BIC} = -2(950) + 1860 \\ln(3570) - 960 \\ln(3600)\n$$\n$$\n\\Delta \\mathrm{BIC} = -1900 + 1860 \\ln(3570) - 960 \\ln(3600)\n$$\n现在，我们计算其数值：\n$$\n\\Delta \\mathrm{BIC} \\approx -1900 + 1860(8.1802014) - 960(8.1886888)\n$$\n$$\n\\Delta \\mathrm{BIC} \\approx -1900 + 15215.1746 - 7861.1412\n$$\n$$\n\\Delta \\mathrm{BIC} \\approx 5454.0334\n$$\n四舍五入到四位有效数字，我们得到 $5454$。正值证实了 BIC 偏好模型 $M_1$。由于使用了自然对数，单位是奈特 (nats)。", "answer": "$$\n\\boxed{5454}\n$$", "id": "3303887"}, {"introduction": "除了评估预先定义的模型，系统生物学的一个主要目标是直接从数据中*发现*调控网络。本练习 [@problem_id:3303898] 深入探讨了 DBN 的学习方面，特别是如何使用一种先进的优化技术来推断稀疏的网络结构。你将实现一个近端梯度更新步骤，这是使用 $\\ell_1$ 正则化学习模型的核心，该方法是识别复杂生物系统中最重要相互作用的有效手段。", "problem": "您的任务是为一个用于基因调控时间序列建模的动态贝叶斯网络（DBN）中的跨时间邻接矩阵的选定条目实现近端更新。DBN表示$n$个基因在时间$t$到$t+1$之间的有向依赖关系，其邻接矩阵为$A \\in \\mathbb{R}^{n \\times n}$，其中条目$A_{ij}$编码了基因$j$在时间$t$到基因$i$在时间$t+1$的有向影响强度。$A$中的稀疏结构对应于少数调控相互作用，这在生物学上是合理的。推断过程通过在$\\ell_1$正则化目标下的最大后验（MAP）估计进行，以鼓励$A$的稀疏性。一个近端梯度步使用从时间序列似然函数导出的梯度矩阵$G \\in \\mathbb{R}^{n \\times n}$和一个控制稀疏性的正则化参数来优化$A$。您的程序必须计算$A$的指定条目子集的近端更新，然后解释这些条目得到的稀疏性，说明其代表的潜在基因相互作用。\n\n请基于以下基本原理开始：\n- 动态贝叶斯网络（DBN）的定义，它是一种概率图模型，编码了跨连续时间点的基因表达变量之间的条件依赖关系。\n- 最大后验（MAP）估计原则，它通过$\\ell_1$惩罚项来平衡数据保真度（似然）和结构简约性，以鼓励稀疏性。\n- 用于$\\ell_1$正则化的近端算子概念，应用于基于梯度的迭代以产生稀疏更新。\n\n您不能使用或假设此处提供的任何特定闭式公式；相反，您必须遵循这些基本原理来实现正确的近端更新。\n\n您的程序必须处理以下测试套件，每个套件都有明确的参数。索引是基于零的，每对$(i,j)$表示对条目$A_{ij}$的更新，对应于基因$j$到基因$i$跨时间的有向影响。所有量都是无量纲的。\n\n测试用例 1：\n- 尺寸 $n = 3$。\n- 初始邻接矩阵\n$$\nA^{(1)} =\n\\begin{bmatrix}\n0  0.3  -0.1 \\\\\n0.2  0  0.05 \\\\\n-0.25  0.1  0\n\\end{bmatrix}.\n$$\n- 梯度\n$$\nG^{(1)} =\n\\begin{bmatrix}\n0  0.5  -0.2 \\\\\n-0.3  0  0.1 \\\\\n0.4  -0.05  0.2\n\\end{bmatrix}.\n$$\n- 步长 $\\alpha^{(1)} = 0.5$。\n- 正则化参数 $\\lambda^{(1)} = 0.2$。\n- 选定索引 $S^{(1)} = \\{(0,1),(1,0),(2,2),(2,1)\\}$。\n\n测试用例 2：\n- 尺寸 $n = 4$。\n- 初始邻接矩阵\n$$\nA^{(2)} =\n\\begin{bmatrix}\n0  0.4  0  -0.1 \\\\\n0.05  0  0.2  0 \\\\\n-0.15  0.1  0  0.8 \\\\\n0  -0.05  0.25  0\n\\end{bmatrix}.\n$$\n- 梯度\n$$\nG^{(2)} =\n\\begin{bmatrix}\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n0  0  0  0\n\\end{bmatrix}.\n$$\n- 步长 $\\alpha^{(2)} = 1.0$。\n- 正则化参数 $\\lambda^{(2)} = 0.5$。\n- 选定索引 $S^{(2)} = \\{(0,1),(2,3),(3,2),(1,2),(0,3)\\}$。\n\n测试用例 3：\n- 尺寸 $n = 2$。\n- 初始邻接矩阵\n$$\nA^{(3)} =\n\\begin{bmatrix}\n0  0.15 \\\\\n-0.05  0\n\\end{bmatrix}.\n$$\n- 梯度\n$$\nG^{(3)} =\n\\begin{bmatrix}\n0  0.2 \\\\\n0.2  0\n\\end{bmatrix}.\n$$\n- 步长 $\\alpha^{(3)} = 0.25$。\n- 正则化参数 $\\lambda^{(3)} = 0.4$。\n- 选定索引 $S^{(3)} = \\{(0,1),(1,0)\\}$。\n\n对于每个测试用例，您的程序必须：\n1. 使用给定的$A^{(k)}$, $G^{(k)}$, $\\alpha^{(k)}$和$\\lambda^{(k)}$，对$S^{(k)}$中选定的条目执行单次近端梯度更新。只有选定索引集中的条目应该被更新；所有其他条目必须保持不变。\n2. 完全按照它们在$S^{(k)}$中列出的顺序，提取选定条目的更新值，并将它们作为浮点数列表返回。\n3. 通过生成一个布尔值列表来解释这些选定条目的稀疏性，指示每个更新后的条目是否为非零（非零条目表示从基因$j$到基因$i$存在一个候选的有向相互作用）。\n4. 将更新后的选定条目中零的个数作为整数返回。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是包含三个元素的列表：\n- 按$S^{(k)}$顺序排列的更新后选定值的列表（浮点数）。\n- 指示这些条目是为非零（存在相互作用）还是零（无相互作用）的布尔值列表。\n- 这些条目中零的整数计数。\n\n最终输出格式必须严格为：\n$[$result\\_case\\_1,result\\_case\\_2,result\\_case\\_3$]$，\n其中每个 result\\_case\\_k 遵循上述结构。不涉及角度，也没有物理单位；所有报告的值都是无量纲的。程序必须使用基于零的索引来表示矩阵位置。", "solution": "该问题要求实现一个单步近端梯度更新，用于在基因调控的动态贝叶斯网络（DBN）模型中推断稀疏的跨时间邻接矩阵$A$。其背景是计算系统生物学，在这类模型中，利用时间序列基因表达数据来推断调控相互作用。矩阵条目$A_{ij}$表示基因$j$在时间$t$到基因$i$在时间$t+1$的有向影响。\n\n矩阵$A$的推断被表述为一个最大后验（MAP）估计问题。生物网络通常是稀疏的，这意味着一个基因仅受少数其他基因的调控。为了强制实现这种生物学上合理的结构，目标函数包含一个$\\ell_1$正则化项。需要最小化的目标函数$F(A)$形式如下：\n$$F(A) = L(A) + \\lambda \\sum_{i,j} |A_{ij}|$$\n这里，$L(A)$是给定网络结构$A$时数据的负对数似然，它是一个可微函数，用于衡量模型对观测到的时间序列数据的拟合程度。第二项是矩阵$A$的$\\ell_1$范数，由一个正则化参数$\\lambda > 0$加权。$\\ell_1$范数是矩阵条目绝对值之和，已知它能诱导稀疏性（即，驱使许多条目精确地变为零）。\n\n该目标函数由一个光滑、可微的项$L(A)$和一个非光滑、不可微但凸的项$\\lambda \\|A\\|_1$复合而成。近端梯度方法非常适合解决此类优化问题。从当前估计$A^{(k)}$开始的单步更新由下式给出：\n$$A^{(k+1)} = \\text{prox}_{\\alpha \\lambda \\|\\cdot\\|_1}(A^{(k)} - \\alpha \\nabla_A L(A^{(k)}))$$\n其中$\\alpha$是步长（学习率），$\\nabla_A L(A^{(k)})$是似然项的梯度（作为矩阵$G^{(k)}$提供），$\\text{prox}_{\\gamma f}(\\cdot)$是函数$f$的近端算子，参数为$\\gamma$。\n\n这个更新在概念上可以分解为两个阶段：\n1.  **梯度步**：我们首先对目标函数的光滑部分$L(A)$执行一个标准的梯度下降步。这会产生一个中间矩阵，我们称之为$Z$：\n    $$Z = A^{(k)} - \\alpha G^{(k)}$$\n    其中$G^{(k)} = \\nabla_A L(A^{(k)})$。\n\n2.  **近端映射步**：然后我们将与$\\ell_1$范数相关的近端算子应用于中间矩阵$Z$。对于缩放的$\\ell_1$范数$\\gamma \\|\\cdot\\|_1$，其近端算子是逐元素的软阈值算子，对于一个标量值$z$定义为：\n    $$S_\\gamma(z) = \\text{prox}_{\\gamma |\\cdot|}(z) = \\text{sign}(z) \\max(|z| - \\gamma, 0)$$\n    该算子将$z$的值向零收缩一个量$\\gamma$，如果其绝对值小于或等于$\\gamma$，则将其精确地设置为零。\n\n综合起来，单个条目$A_{ij}$的更新规则是：\n$$A_{ij}^{(k+1)} = S_{\\alpha^{(k)} \\lambda^{(k)}}(Z_{ij}) = S_{\\alpha^{(k)} \\lambda^{(k)}}(A_{ij}^{(k)} - \\alpha^{(k)} G_{ij}^{(k)})$$\n问题规定此更新仅应用于预先选择的索引集$S^{(k)}$。不在此集合中的条目保持不变。更新后的条目$A_{ij}^{(k+1)}$为非零意味着基因$j$到基因$i$存在一个持续的调控联系，而值为零则意味着在当前模型参数下不存在这种联系。\n\n现在我们将此过程应用于每个测试用例。\n\n**测试用例 1**\n- $A^{(1)} = \\begin{bmatrix} 0  0.3  -0.1 \\\\ 0.2  0  0.05 \\\\ -0.25  0.1  0 \\end{bmatrix}$, $G^{(1)} = \\begin{bmatrix} 0  0.5  -0.2 \\\\ -0.3  0  0.1 \\\\ 0.4  -0.05  0.2 \\end{bmatrix}$\n- $\\alpha^{(1)} = 0.5$, $\\lambda^{(1)} = 0.2$\n- $S^{(1)} = \\{(0,1),(1,0),(2,2),(2,1)\\}$\n- 软阈值参数为 $\\tau = \\alpha^{(1)} \\lambda^{(1)} = 0.5 \\times 0.2 = 0.1$。\n\n对于每个$(i,j) \\in S^{(1)}$：\n- $(0,1)$: $Z_{01} = 0.3 - 0.5 \\times 0.5 = 0.05$。 更新：$\\text{sign}(0.05) \\max(|0.05| - 0.1, 0) = 0.0$。\n- $(1,0)$: $Z_{10} = 0.2 - 0.5 \\times (-0.3) = 0.35$。 更新：$\\text{sign}(0.35) \\max(|0.35| - 0.1, 0) = 0.25$。\n- $(2,2)$: $Z_{22} = 0 - 0.5 \\times 0.2 = -0.1$。 更新：$\\text{sign}(-0.1) \\max(|-0.1| - 0.1, 0) = 0.0$。\n- $(2,1)$: $Z_{21} = 0.1 - 0.5 \\times (-0.05) = 0.125$。 更新：$\\text{sign}(0.125) \\max(|0.125| - 0.1, 0) = 0.025$。\n\n结果：\n- 更新后的值：$[0.0, 0.25, 0.0, 0.025]$\n- 非零状态：$[False, True, False, True]$\n- 零计数：$2$\n\n**测试用例 2**\n- $A^{(2)}$如给定， $G^{(2)}$是零矩阵。\n- $\\alpha^{(2)} = 1.0$, $\\lambda^{(2)} = 0.5$\n- $S^{(2)} = \\{(0,1),(2,3),(3,2),(1,2),(0,3)\\}$\n- 软阈值参数为 $\\tau = \\alpha^{(2)} \\lambda^{(2)} = 1.0 \\times 0.5 = 0.5$。\n- 由于$G^{(2)}$为零，所以$Z_{ij} = A_{ij}^{(2)}$。\n\n对于每个$(i,j) \\in S^{(2)}$：\n- $(0,1)$: $Z_{01} = 0.4$。 更新：$\\text{sign}(0.4) \\max(|0.4| - 0.5, 0) = 0.0$。\n- $(2,3)$: $Z_{23} = 0.8$。 更新：$\\text{sign}(0.8) \\max(|0.8| - 0.5, 0) = 0.3$。\n- $(3,2)$: $Z_{32} = 0.25$。 更新：$\\text{sign}(0.25) \\max(|0.25| - 0.5, 0) = 0.0$。\n- $(1,2)$: $Z_{12} = 0.2$。 更新：$\\text{sign}(0.2) \\max(|0.2| - 0.5, 0) = 0.0$。\n- $(0,3)$: $Z_{03} = -0.1$。 更新：$\\text{sign}(-0.1) \\max(|-0.1| - 0.5, 0) = 0.0$。\n\n结果：\n- 更新后的值：$[0.0, 0.3, 0.0, 0.0, 0.0]$\n- 非零状态：$[False, True, False, False, False]$\n- 零计数：$4$\n\n**测试用例 3**\n- $A^{(3)} = \\begin{bmatrix} 0  0.15 \\\\ -0.05  0 \\end{bmatrix}$, $G^{(3)} = \\begin{bmatrix} 0  0.2 \\\\ 0.2  0 \\end{bmatrix}$\n- $\\alpha^{(3)} = 0.25$, $\\lambda^{(3)} = 0.4$\n- $S^{(3)} = \\{(0,1),(1,0)\\}$\n- 软阈值参数为 $\\tau = \\alpha^{(3)} \\lambda^{(3)} = 0.25 \\times 0.4 = 0.1$。\n\n对于每个$(i,j) \\in S^{(3)}$：\n- $(0,1)$: $Z_{01} = 0.15 - 0.25 \\times 0.2 = 0.1$。 更新：$\\text{sign}(0.1) \\max(|0.1| - 0.1, 0) = 0.0$。\n- $(1,0)$: $Z_{10} = -0.05 - 0.25 \\times 0.2 = -0.1$。 更新：$\\text{sign}(-0.1) \\max(|-0.1| - 0.1, 0) = 0.0$。\n\n结果：\n- 更新后的值：$[0.0, 0.0]$\n- 非零状态：$[False, False]$\n- 零计数：$2$", "answer": "[[0.0, 0.25, 0.0, 0.025], [False, True, False, True], 2],[[0.0, 0.3, 0.0, 0.0, 0.0], [False, True, False, False, False], 4],[[0.0, 0.0], [False, False], 2]]", "id": "3303898"}]}