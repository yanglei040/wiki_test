{"hands_on_practices": [{"introduction": "要理解信息如何在信号网络中流动，我们首先必须能够对其进行量化。本练习提供了一个将信息论应用于生物学数据的基本实践。通过一个假定的联合概率分布，您将计算受体状态与基因表达水平之间的互信息，从而具体理解该指标如何衡量信号保真度，并揭示细胞通讯固有的噪声特性。[@problem_id:3319656]", "problem": "信号网络中的一个受体节点 $R$ 整合上游的生物化学信号，并产生一个具有三种状态 $R \\in \\{r_{0}, r_{1}, r_{2}\\}$ 的离散输出。一个下游基因 $G$ 以三种离散的表达水平 $G \\in \\{g_{0}, g_{1}, g_{2}\\}$ 作出响应。在大量细胞中，于稳态刺激下测得的经验联合分布 $p(R,G)$ 为\n$$\n\\begin{array}{c|ccc}\n  g_{0}  g_{1}  g_{2} \\\\\n\\hline\nr_{0}  \\frac{12}{32}  \\frac{3}{32}  \\frac{1}{32} \\\\\nr_{1}  \\frac{2}{32}  \\frac{8}{32}  \\frac{2}{32} \\\\\nr_{2}  \\frac{1}{32}  \\frac{2}{32}  \\frac{1}{32}\n\\end{array}\n$$\n假设系统是遍历且平稳的，并将 $p(R,G)$ 解读为观测到配对 $(R,G)$ 的长期频率。使用应用于生物化学信号传导的信息论基本定义，计算受体熵 $H(R)$、基因表达熵 $H(G)$ 以及 $R$ 和 $G$ 之间的互信息 $I(R;G)$。使用以2为底的对数，以便所有信息量都以比特为单位。将你的最终答案以比特表示，并可以保留为精确的对数形式。最后，从信号保真度的角度解读这些值，评论信息传输与受体状态数量所决定的上界有多接近。", "solution": "首先验证问题，以确保其具有科学依据、适定、客观和完整。\n\n### 步骤 1：提取已知条件\n- 一个具有三种状态的受体节点 $R$：$R \\in \\{r_{0}, r_{1}, r_{2}\\}$。\n- 一个具有三种表达水平的下游基因 $G$：$G \\in \\{g_{0}, g_{1}, g_{2}\\}$。\n- 经验联合概率分布 $p(R,G)$ 由以下矩阵给出：\n$$\n\\begin{pmatrix}\np(r_0, g_0)  p(r_0, g_1)  p(r_0, g_2) \\\\\np(r_1, g_0)  p(r_1, g_1)  p(r_1, g_2) \\\\\np(r_2, g_0)  p(r_2, g_1)  p(r_2, g_2)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{12}{32}  \\frac{3}{32}  \\frac{1}{32} \\\\\n\\frac{2}{32}  \\frac{8}{32}  \\frac{2}{32} \\\\\n\\frac{1}{32}  \\frac{2}{32}  \\frac{1}{32}\n\\end{pmatrix}\n$$\n- 假设系统是遍历且平稳的。\n- 任务是计算受体熵 $H(R)$、基因表达熵 $H(G)$ 和互信息 $I(R;G)$。\n- 所有信息量都将以比特为单位，使用以2为底的对数。\n- 任务的最后一部分是解读结果。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题很好地基于信息论原理，并应用于计算系统生物学。使用香农熵和互信息来分析信号网络是一种标准且有效的方法。\n- **适定性：** 该问题是适定的。联合概率分布已完全指定，且所有概率均为非负。所有项的总和为 $\\frac{12+3+1+2+8+2+1+2+1}{32} = \\frac{32}{32} = 1$，证实了这是一个有效的分布。要计算的量（$H(R)$、$H(G)$、$I(R;G)$）由所提供的分布唯一定义。\n- **客观性：** 该问题以精确的数值数据和数学定义客观地陈述。\n- **缺陷检查：** 该问题未违反任何无效性标准。它是完整、一致且科学上合理的。\n\n### 步骤 3：结论与行动\n问题有效。将继续进行解答。\n\n### 求解推导\n\n随机变量 $X$ 的香农熵以及两个随机变量 $R$ 和 $G$ 之间互信息的基本定义是：\n$$H(X) = -\\sum_{x} p(x) \\log_2(p(x))$$\n$$I(R;G) = \\sum_{r,g} p(r,g) \\log_2\\left(\\frac{p(r,g)}{p(r)p(g)}\\right) = H(R) + H(G) - H(R,G)$$\n其中 $H(R,G)$ 是联合熵。\n\n**1. 边际概率的计算**\n首先，我们通过分别对联合分布矩阵的行和列求和来计算 $R$ 和 $G$ 的边际概率分布。\n\n$R$ 的边际概率分布 $p(R)$ 为：\n$p(r_0) = \\sum_{j} p(r_0, g_j) = \\frac{12}{32} + \\frac{3}{32} + \\frac{1}{32} = \\frac{16}{32} = \\frac{1}{2}$\n$p(r_1) = \\sum_{j} p(r_1, g_j) = \\frac{2}{32} + \\frac{8}{32} + \\frac{2}{32} = \\frac{12}{32} = \\frac{3}{8}$\n$p(r_2) = \\sum_{j} p(r_2, g_j) = \\frac{1}{32} + \\frac{2}{32} + \\frac{1}{32} = \\frac{4}{32} = \\frac{1}{8}$\n因此，$p(R) = (\\frac{1}{2}, \\frac{3}{8}, \\frac{1}{8})$。总和为 $\\frac{4+3+1}{8} = 1$。\n\n$G$ 的边际概率分布 $p(G)$ 为：\n$p(g_0) = \\sum_{i} p(r_i, g_0) = \\frac{12}{32} + \\frac{2}{32} + \\frac{1}{32} = \\frac{15}{32}$\n$p(g_1) = \\sum_{i} p(r_i, g_1) = \\frac{3}{32} + \\frac{8}{32} + \\frac{2}{32} = \\frac{13}{32}$\n$p(g_2) = \\sum_{i} p(r_i, g_2) = \\frac{1}{32} + \\frac{2}{32} + \\frac{1}{32} = \\frac{4}{32} = \\frac{1}{8}$\n因此，$p(G) = (\\frac{15}{32}, \\frac{13}{32}, \\frac{4}{32})$。总和为 $\\frac{15+13+4}{32} = 1$。\n\n**2. 熵的计算**\n\n**受体熵 $H(R)$：**\n$$H(R) = -\\sum_{i=0}^{2} p(r_i) \\log_2(p(r_i))$$\n$$H(R) = -\\left[ \\frac{1}{2}\\log_2\\left(\\frac{1}{2}\\right) + \\frac{3}{8}\\log_2\\left(\\frac{3}{8}\\right) + \\frac{1}{8}\\log_2\\left(\\frac{1}{8}\\right) \\right]$$\n使用 $\\log_2(a/b) = \\log_2(a) - \\log_2(b)$：\n$$H(R) = -\\left[ \\frac{1}{2}(-1) + \\frac{3}{8}(\\log_2(3) - \\log_2(8)) + \\frac{1}{8}(-\\log_2(8)) \\right]$$\n$$H(R) = -\\left[ -\\frac{1}{2} + \\frac{3}{8}(\\log_2(3) - 3) - \\frac{1}{8}(3) \\right]$$\n$$H(R) = \\frac{1}{2} - \\frac{3}{8}\\log_2(3) + \\frac{9}{8} + \\frac{3}{8} = \\frac{4+9+3}{8} - \\frac{3}{8}\\log_2(3) = \\frac{16}{8} - \\frac{3}{8}\\log_2(3)$$\n$$H(R) = 2 - \\frac{3}{8}\\log_2(3) \\text{ 比特}$$\n\n**基因表达熵 $H(G)$：**\n$$H(G) = -\\sum_{j=0}^{2} p(g_j) \\log_2(p(g_j))$$\n$$H(G) = -\\left[ \\frac{15}{32}\\log_2\\left(\\frac{15}{32}\\right) + \\frac{13}{32}\\log_2\\left(\\frac{13}{32}\\right) + \\frac{4}{32}\\log_2\\left(\\frac{4}{32}\\right) \\right]$$\n$$H(G) = -\\frac{15}{32}(\\log_2(15)-5) - \\frac{13}{32}(\\log_2(13)-5) - \\frac{4}{32}(\\log_2(4)-5)$$\n$$H(G) = \\frac{5 \\cdot (15+13+4)}{32} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) - \\frac{4 \\cdot 2}{32}$$\n$$H(G) = \\frac{5 \\cdot 32}{32} - \\frac{8}{32} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13)$$\n$$H(G) = 5 - \\frac{1}{4} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13)$$\n$$H(G) = \\frac{19}{4} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) \\text{ 比特}$$\n\n**联合熵 $H(R,G)$：**\n$$H(R,G) = -\\sum_{i,j} p(r_i, g_j) \\log_2(p(r_i, g_j))$$\n我们可以将每个 $p(r_i, g_j)$ 表示为 $n_{ij}/32$。\n$$H(R,G) = -\\sum_{i,j} \\frac{n_{ij}}{32} \\log_2\\left(\\frac{n_{ij}}{32}\\right) = -\\frac{1}{32}\\sum n_{ij}(\\log_2(n_{ij})-5) = 5 - \\frac{1}{32}\\sum n_{ij}\\log_2(n_{ij})$$\n分子是 $\\{12, 3, 1, 2, 8, 2, 1, 2, 1\\}$。\n$$\\sum n_{ij}\\log_2(n_{ij}) = 12\\log_2(12) + 3\\log_2(3) + 3 \\cdot 1\\log_2(1) + 3 \\cdot 2\\log_2(2) + 8\\log_2(8)$$\n$$\\sum n_{ij}\\log_2(n_{ij}) = 12(\\log_2(4)+\\log_2(3)) + 3\\log_2(3) + 0 + 6(1) + 8(3)$$\n$$\\sum n_{ij}\\log_2(n_{ij}) = 12(2+\\log_2(3)) + 3\\log_2(3) + 6 + 24 = 24 + 12\\log_2(3) + 3\\log_2(3) + 30 = 54 + 15\\log_2(3)$$\n$$H(R,G) = 5 - \\frac{1}{32}(54 + 15\\log_2(3)) = 5 - \\frac{27}{16} - \\frac{15}{32}\\log_2(3)$$\n$$H(R,G) = \\frac{80-27}{16} - \\frac{15}{32}\\log_2(3) = \\frac{53}{16} - \\frac{15}{32}\\log_2(3) \\text{ 比特}$$\n\n**3. 互信息 $I(R;G)$ 的计算**\n使用关系式 $I(R;G) = H(R) + H(G) - H(R,G)$：\n$$I(R;G) = \\left(2 - \\frac{3}{8}\\log_2(3)\\right) + \\left(\\frac{19}{4} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13)\\right) - \\left(\\frac{53}{16} - \\frac{15}{32}\\log_2(3)\\right)$$\n合并常数项：\n$$2 + \\frac{19}{4} - \\frac{53}{16} = \\frac{32}{16} + \\frac{76}{16} - \\frac{53}{16} = \\frac{108 - 53}{16} = \\frac{55}{16}$$\n合并对数项：\n$$(-\\frac{3}{8}\\log_2(3)) - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) - (-\\frac{15}{32}\\log_2(3)) =$$\n$$(-\\frac{12}{32} + \\frac{15}{32})\\log_2(3) - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) = \\frac{3}{32}\\log_2(3) - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13)$$\n合并两部分：\n$$I(R;G) = \\frac{55}{16} + \\frac{3}{32}\\log_2(3) - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) \\text{ 比特}$$\n\n**4. 解读**\n熵 $H(R)$ 和 $H(G)$ 分别衡量了受体状态和基因表达水平的不确定性或可变性。\n$H(R) = 2 - \\frac{3}{8}\\log_2(3) \\approx 2 - 0.594 = 1.406$ 比特。\n$H(G) \\approx \\frac{19}{4} - \\frac{1}{32}(15 \\cdot 3.907 + 13 \\cdot 3.700) = 4.75 - \\frac{58.6 + 48.1}{32} = 4.75 - 3.33 = 1.42$ 比特。\n互信息 $I(R;G)$ 量化了在已知 $R$ 的状态下（反之亦然），关于 $G$ 状态的不确定性的减少量。它是从 $R$ 到 $G$ 的信号通道保真度的度量。\n$I(R;G) = \\frac{55}{16} + \\frac{1}{32}(3\\log_2(3) - 15\\log_2(15) - 13\\log_2(13)) \\approx 3.4375 + \\frac{1}{32}(3(1.585) - 15(3.907) - 13(3.700)) \\approx 3.4375 + \\frac{4.755 - 58.605 - 48.1}{32} \\approx 3.4375 - 3.186 = 0.2515$ 比特。\n\n信息传输的上界受限于信源的熵，而信源的熵最终受限于状态的数量。对于一个有3个状态的受体，最大可能熵为 $H_{max} = \\log_2(3) \\approx 1.585$ 比特。这种情况会在所有受体状态等可能且通道无噪声时发生。实际的信源熵是 $H(R) \\approx 1.406$ 比特。\n\n计算出的互信息 $I(R;G) \\approx 0.2515$ 比特，显著低于理论最大值 $\\log_2(3)$ 比特和实际信源熵 $H(R)$。这表明信号通道是含噪声的且保真度低。通过观察基因的表达水平，关于受体状态的大量初始不确定性并未被消除。传输的信源熵比例为 $I(R;G)/H(R) \\approx 0.2515/1.406 \\approx 0.179$，约 $17.9\\%$。这意味着超过 $82\\%$ 的输入信号信息容量在信号传导过程中丢失了。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2 - \\frac{3}{8}\\log_2(3)  \\frac{19}{4} - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13)  \\frac{55}{16} + \\frac{3}{32}\\log_2(3) - \\frac{15}{32}\\log_2(15) - \\frac{13}{32}\\log_2(13) \\end{pmatrix}\n}\n$$", "id": "3319656"}, {"introduction": "真实的生物通路是动态系统，信号在其中经过多个阶段的处理，每个阶段都可能引入噪声。本练习探讨了信息在连续信号级联中的流动，这是细胞网络中的一个常见模体。通过推导一个两步线性级联中初始输入与最终输出之间的互信息，您将直接量化中间噪声如何削弱信号并导致信息损失，为数据处理不等式在实际中的应用提供一个强有力的范例。[@problem_id:3319700]", "problem": "考虑单个细胞中的一个线性两步生化信号级联，其中上游分子浓度的波动驱动下游的响应。令上游输入为一个零均值高斯随机变量 $X \\sim \\mathcal{N}(0, \\sigma_{X}^{2})$。第一阶段通过线性增益 $k_{1} > 0$ 和与 $X$ 无关的加性噪声 $n_{1} \\sim \\mathcal{N}(0, \\sigma_{1}^{2})$ 产生一个中间信号 $S_{1}$，使得 $S_{1} = k_{1} X + n_{1}$。第二阶段通过线性增益 $k_{2} > 0$ 和与 $X$ 及 $n_{1}$ 均无关的加性噪声 $n_{2} \\sim \\mathcal{N}(0, \\sigma_{2}^{2})$ 产生最终输出 $Y$，使得 $Y = k_{2} S_{1} + n_{2}$。假设 $X$、$n_{1}$ 和 $n_{2}$ 相互独立，并且其高斯性源于中心极限定理和生化响应的线性化。\n\n从连续变量的 Shannon 互信息定义出发，推导输入 $X$ 和最终输出 $Y$ 之间的互信息 $I(X; Y)$ 的闭式表达式。然后，通过将 $\\Delta I$ 定义为在假设无中间噪声（即 $\\sigma_{1}^{2} = 0$，而 $k_{1}$、$k_{2}$、$\\sigma_{X}^{2}$ 和 $\\sigma_{2}^{2}$ 保持不变）情况下的互信息与实际双噪声级联中的互信息之差，来量化由中间噪声引起的信息损失。\n\n将 $I(X; Y)$ 和 $\\Delta I$ 表示为关于 $k_{1}$、$k_{2}$、$\\sigma_{X}^{2}$、$\\sigma_{1}^{2}$ 和 $\\sigma_{2}^{2}$ 的精确解析表达式。\n\n以奈特（nats）为单位表示互信息和信息损失。不要进行近似；请提供精确表达式。最终答案必须是单个解析表达式或一个解析表达式的行矩阵。", "solution": "该问题陈述经证实具有科学依据、是适定且客观的。它提出了一个计算系统生物学中的标准问题，涉及信息通过噪声线性级联的传输，该问题可以使用信息论的既定原理进行分析。所有参数和关系都已明确定义，从而导出一个唯一且有意义的解。不存在矛盾、歧义或事实不准确之处。\n\n目标是推导输入 $X$ 和输出 $Y$ 之间的互信息 $I(X; Y)$，以及由中间噪声源 $n_1$ 引起的信息损失 $\\Delta I$。\n\n两个连续随机变量 $X$ 和 $Y$ 之间的互信息定义为 $I(X; Y) = h(Y) - h(Y|X)$，其中 $h(\\cdot)$ 表示微分熵。对于一个方差为 $\\sigma_Z^2$ 的高斯随机变量 $Z$，其以奈特为单位的微分熵由 $h(Z) = \\frac{1}{2} \\ln(2 \\pi e \\sigma_Z^2)$ 给出。\n\n首先，我们刻画输出变量 $Y$。该系统由以下方程描述：\n$S_1 = k_1 X + n_1$\n$Y = k_2 S_1 + n_2$\n\n将 $S_1$ 的表达式代入 $Y$ 的方程，我们得到：\n$Y = k_2 (k_1 X + n_1) + n_2 = k_1 k_2 X + k_2 n_1 + n_2$\n\n输入 $X$、中间噪声 $n_1$ 和最终噪声 $n_2$ 被给定为相互独立的零均值高斯随机变量：\n$X \\sim \\mathcal{N}(0, \\sigma_X^2)$\n$n_1 \\sim \\mathcal{N}(0, \\sigma_1^2)$\n$n_2 \\sim \\mathcal{N}(0, \\sigma_2^2)$\n\n由于 $Y$ 是独立高斯变量的线性组合，它也是一个高斯变量。其均值为：\n$E[Y] = E[k_1 k_2 X + k_2 n_1 + n_2] = k_1 k_2 E[X] + k_2 E[n_1] + E[n_2] = 0 + 0 + 0 = 0$\n\n$Y$ 的方差，记为 $\\sigma_Y^2$，利用独立随机变量之和的方差等于其方差之和的性质进行计算：\n$\\sigma_Y^2 = \\text{Var}(Y) = \\text{Var}(k_1 k_2 X + k_2 n_1 + n_2)$\n$\\sigma_Y^2 = \\text{Var}(k_1 k_2 X) + \\text{Var}(k_2 n_1) + \\text{Var}(n_2)$\n$\\sigma_Y^2 = (k_1 k_2)^2 \\text{Var}(X) + k_2^2 \\text{Var}(n_1) + \\text{Var}(n_2)$\n$\\sigma_Y^2 = k_1^2 k_2^2 \\sigma_X^2 + k_2^2 \\sigma_1^2 + \\sigma_2^2$\n\n因此，$Y$ 的微分熵为：\n$h(Y) = \\frac{1}{2} \\ln(2 \\pi e \\sigma_Y^2) = \\frac{1}{2} \\ln(2 \\pi e (k_1^2 k_2^2 \\sigma_X^2 + k_2^2 \\sigma_1^2 + \\sigma_2^2))$\n\n接下来，我们确定条件熵 $h(Y|X)$。这需要求出在 $X$ 取特定值 $x$ 的条件下 $Y$ 的分布。当 $X=x$ 时，变量 $Y$ 变为：\n$Y|_{X=x} = k_1 k_2 x + k_2 n_1 + n_2$\n这是一个高斯变量，因为它是一个常数（$k_1 k_2 x$）加上独立高斯变量（$n_1$ 和 $n_2$）的线性组合。条件方差 $\\sigma_{Y|X}^2 = \\text{Var}(Y|X)$ 为：\n$\\sigma_{Y|X}^2 = \\text{Var}(k_1 k_2 x + k_2 n_1 + n_2) = \\text{Var}(k_2 n_1 + n_2)$\n$\\sigma_{Y|X}^2 = \\text{Var}(k_2 n_1) + \\text{Var}(n_2) = k_2^2 \\text{Var}(n_1) + \\text{Var}(n_2)$\n$\\sigma_{Y|X}^2 = k_2^2 \\sigma_1^2 + \\sigma_2^2$\n由于该方差不依赖于特定值 $x$，条件熵 $h(Y|X)$ 是一个常数：\n$h(Y|X) = \\frac{1}{2} \\ln(2 \\pi e \\sigma_{Y|X}^2) = \\frac{1}{2} \\ln(2 \\pi e (k_2^2 \\sigma_1^2 + \\sigma_2^2))$\n\n现在我们可以计算互信息 $I(X; Y)$：\n$I(X; Y) = h(Y) - h(Y|X)$\n$I(X; Y) = \\frac{1}{2} \\ln(2 \\pi e \\sigma_Y^2) - \\frac{1}{2} \\ln(2 \\pi e \\sigma_{Y|X}^2)$\n$I(X; Y) = \\frac{1}{2} \\ln\\left(\\frac{\\sigma_Y^2}{\\sigma_{Y|X}^2}\\right)$\n代入方差的表达式：\n$I(X; Y) = \\frac{1}{2} \\ln\\left(\\frac{k_1^2 k_2^2 \\sigma_X^2 + k_2^2 \\sigma_1^2 + \\sigma_2^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}\\right)$\n这可以改写为：\n$I(X; Y) = \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}\\right)$\n这是第一个所求的表达式。它表示在输出 $Y$ 处保留的关于输入 $X$ 的信息，并遵循 $\\frac{1}{2} \\ln(1 + \\text{SNR})$ 的特征形式，其中信噪比 (SNR) 是由信号 $X$ 引起的输出功率与所有噪声源引起的总输出功率之比。\n\n接下来，我们量化信息损失 $\\Delta I$。这是在假设无中间噪声（$\\sigma_1^2 = 0$）情况下的互信息与实际互信息之间的差值。令 $I_{hyp}$ 为 $\\sigma_1^2 = 0$ 时的互信息：\n$I_{hyp} = I(X; Y)|_{\\sigma_1^2 = 0} = \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 (0) + \\sigma_2^2}\\right) = \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{\\sigma_2^2}\\right)$\n\n信息损失 $\\Delta I$ 定义为 $\\Delta I = I_{hyp} - I(X; Y)$。\n$\\Delta I = \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{\\sigma_2^2}\\right) - \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}\\right)$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$\\Delta I = \\frac{1}{2} \\ln\\left(\\frac{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{\\sigma_2^2}}{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}}\\right)$\n这是第二个所求的表达式。由于 $k_2 > 0$ 和 $\\sigma_1^2 > 0$，对数内部表达式的分母小于分子，确保了 $\\Delta I \\ge 0$，这在物理上是符合预期的，因为增加噪声不能增加信息。\n\n两个最终表达式为：\n$I(X; Y) = \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}\\right)$\n$\\Delta I = \\frac{1}{2} \\ln\\left(\\frac{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{\\sigma_2^2}}{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}}\\right)$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} \\ln\\left(1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}\\right)  \\frac{1}{2} \\ln\\left(\\frac{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{\\sigma_2^2}}{1 + \\frac{k_1^2 k_2^2 \\sigma_X^2}{k_2^2 \\sigma_1^2 + \\sigma_2^2}}\\right) \\end{pmatrix}}\n$$", "id": "3319700"}, {"introduction": "动态模型是强大的工具，但其预测能力取决于我们能否从实验数据中估计其参数。本练习深入探讨了结构可辨识性这一关键概念。您将分析一个经典的磷酸化级联模型，并利用费雪信息矩阵 (Fisher Information Matrix) 来判断其动力学速率常数是否可以从输出观测中被唯一确定，从而揭示系统生物学建模中的一个根本性挑战。[@problem_id:3319713]", "problem": "考虑一个简单的双层磷酸化级联，将其作为更庞大的细胞内信号网络中的一个最小信号模块。一个强度恒为 $u_{0} > 0$ 的上游信号以有效速率常数 $k_{a}$ 激活激酶 $A$，$A$ 以速率常数 $k_{dA}$ 失活。激活的 $A$ 接着以有效速率常数 $k_{b}$ 磷酸化下游底物 $B$，磷酸化的 $B$ 以速率常数 $k_{dB}$ 去磷酸化。在质量作用动力学下的确定性动态由以下线性常微分方程建模：\n$$\n\\frac{dA}{dt} = k_{a} u_{0} - k_{dA} A, \\quad \\frac{dB}{dt} = k_{b} A - k_{dB} B,\n$$\n初始条件为 $A(0) = 0$ 和 $B(0) = 0$。假设仅在离散时间点 $t_{1}, t_{2}, \\ldots, t_{N}$ 测量磷酸化的下游底物 $B$，测量噪声为独立的加性高斯噪声，其均值为零，方差为 $\\sigma^{2}$。也就是说，测量模型为 $y_{n} = B(t_{n}; \\theta) + \\varepsilon_{n}$，其中 $\\varepsilon_{n} \\sim \\mathcal{N}(0, \\sigma^{2})$ 在 $n$ 上独立，未知参数向量为 $\\theta = (k_{a}, k_{b}, k_{dA}, k_{dB})$。\n\n从上述常微分方程的线性时不变系统解的定义以及独立高斯观测的费雪信息矩阵 (FIM) 的定义出发，推导 $B(t)$ 的闭式表达式，计算在任意时间点 $t_{n}$ 处 $B(t)$ 关于 $\\theta$ 的梯度，并构建费雪信息矩阵 (FIM)。利用此 FIM，在给定的测量设置以及不同的正时间点 $t_{n}$ 的通用选择下（其中 $k_{dA} \\neq k_{dB}$），评估速率常数的结构可辨识性。判断哪些速率常数不是独立可辨识的，并确定费雪信息矩阵 (FIM) 的秩。\n\n将你的最终答案表示为一个等于费雪信息矩阵 (FIM) 秩的整数。无需四舍五入。", "solution": "用户要求我分析一个双层磷酸化级联模型的结构可辨识性。\n\n**1. 问题验证**\n\n首先，我将验证问题陈述。\n\n-   **提取的已知条件：**\n    -   模型方程：$\\frac{dA}{dt} = k_{a} u_{0} - k_{dA} A$, $\\frac{dB}{dt} = k_{b} A - k_{dB} B$。\n    -   初始条件：$A(0) = 0$, $B(0) = 0$。\n    -   输入：恒定的上游信号 $u_{0} > 0$。\n    -   参数：$\\theta = (k_{a}, k_{b}, k_{dA}, k_{dB})$，均为正常数速率常数。\n    -   约束条件：$k_{dA} \\neq k_{dB}$。\n    -   测量模型：$y_{n} = B(t_{n}; \\theta) + \\varepsilon_{n}$，其中 $\\varepsilon_{n} \\sim \\mathcal{N}(0, \\sigma^{2})$ 是独立的。测量在不同的正时间点 $t_1, t_2, \\ldots, t_N$ 进行。\n\n-   **验证结论：**\n    -   该问题**具有科学依据**。它描述了一个标准的、简化的信号级联模型，使用了质量作用动力学，这是系统生物学的基石。\n    -   该问题是**适定的**。给定的具有初始条件的线性常微分方程组有唯一、稳定的解。用于参数估计的统计框架定义明确。\n    -   该问题是**客观的**，并使用了精确的数学语言。\n    -   它并非不完整、矛盾、不切实际或不适定。约束条件 $k_{dA} \\neq k_{dB}$ 对于确保非退化的解形式至关重要。使用费雪信息矩阵 (FIM) 来讨论结构可辨识性的问题是该领域的标准且不平凡的任务。\n\n该问题被认为是**有效的**。我将继续进行求解。\n\n**2. 求解推导**\n\n结构可辨识性的分析需要确定费雪信息矩阵 (FIM) 的秩。一个满秩的 FIM 意味着局部结构可辨识性。一个秩亏的 FIM 意味着不可辨识性。FIM 的秩由线性无关的灵敏度函数（模型输出关于参数的梯度）的数量决定。\n\n**步骤 2a：求解常微分方程组**\n\n首先，我们求解 $A(t)$。方程 $\\frac{dA}{dt} + k_{dA} A = k_{a} u_{0}$ 是一个一阶线性常微分方程。在初始条件 $A(0) = 0$下，解为：\n$$A(t) = \\frac{k_a u_0}{k_{dA}}(1 - \\exp(-k_{dA} t))$$\n接下来，我们将 $A(t)$ 代入第二个常微分方程来求解 $B(t)$：\n$$\\frac{dB}{dt} + k_{dB} B = k_b A(t) = k_b \\frac{k_a u_0}{k_{dA}}(1 - \\exp(-k_{dA} t))$$\n这也是一个一阶线性常微分方程。使用积分因子 $\\exp(k_{dB} t)$ 和初始条件 $B(0) = 0$，并且已知 $k_{dA} \\neq k_{dB}$，我们求解 $B(t)$。积分得到：\n$$B(t)\\exp(k_{dB}t) = \\int_{0}^{t} k_b \\frac{k_a u_0}{k_{dA}}(\\exp(k_{dB}\\tau) - \\exp((k_{dB}-k_{dA})\\tau)) d\\tau$$\n$$B(t)\\exp(k_{dB}t) = \\frac{k_a k_b u_0}{k_{dA}} \\left[ \\frac{1}{k_{dB}}(\\exp(k_{dB}t)-1) - \\frac{1}{k_{dB}-k_{dA}}(\\exp((k_{dB}-k_{dA})t)-1) \\right]$$\n两边乘以 $\\exp(-k_{dB}t)$ 并整理项，得到 $B(t)$ 的闭式表达式：\n$$B(t) = \\frac{k_a k_b u_0}{k_{dA} k_{dB}} - \\frac{k_a k_b u_0}{k_{dA}(k_{dB} - k_{dA})} \\exp(-k_{dA} t) + \\frac{k_a k_b u_0}{k_{dB}(k_{dB} - k_{dA})} \\exp(-k_{dB} t)$$\n我们可以合并项以获得更紧凑的形式：\n$$B(t) = \\frac{k_a k_b u_0}{k_{dA} k_{dB} (k_{dB}-k_{dA})} \\left[ (k_{dB}-k_{dA}) - k_{dB} \\exp(-k_{dA} t) + k_{dA} \\exp(-k_{dB} t) \\right]$$\n\n**步骤 2b：使用灵敏度分析法分析结构可辨识性**\n\n对于参数向量 $\\theta = (k_a, k_b, k_{dA}, k_{dB})$ 和 $N$ 次独立测量，费雪信息矩阵 $F$ 由下式给出：\n$$F_{ij} = \\sum_{n=1}^{N} \\frac{1}{\\sigma^2} \\frac{\\partial B(t_n; \\theta)}{\\partial \\theta_i} \\frac{\\partial B(t_n; \\theta)}{\\partial \\theta_j}$$\n$F$ 的秩由灵敏度矩阵（其行为 $\\nabla_\\theta B(t_n; \\theta)$）的线性无关列的数量决定。对于一般的时间点，这等价于线性无关的灵敏度函数 $S_i(t) = \\frac{\\partial B(t; \\theta)}{\\partial \\theta_i}$ 的数量。\n\n让我们检查灵敏度。输出 $B(t)$ 是乘积 $k_a k_b$ 的函数。令 $P = k_a k_b$。那么 $B(t)$ 可以写成 $B(t) = P \\cdot G(t; k_{dA}, k_{dB}, u_0)$，其中 $G$ 不依赖于 $k_a$ 或 $k_b$。\n我们计算关于 $k_a$ 和 $k_b$ 的灵敏度：\n$$\\frac{\\partial B}{\\partial k_a} = \\frac{\\partial (P \\cdot G)}{\\partial k_a} = \\frac{\\partial P}{\\partial k_a} \\cdot G = k_b \\cdot G = \\frac{1}{k_a} (k_a k_b G) = \\frac{1}{k_a} B(t)$$\n$$\\frac{\\partial B}{\\partial k_b} = \\frac{\\partial (P \\cdot G)}{\\partial k_b} = \\frac{\\partial P}{\\partial k_b} \\cdot G = k_a \\cdot G = \\frac{1}{k_b} (k_a k_b G) = \\frac{1}{k_b} B(t)$$\n从这两个表达式中，我们可以看到对于所有 $t$，灵敏度函数之间存在线性关系：\n$$k_a \\frac{\\partial B(t)}{\\partial k_a} - k_b \\frac{\\partial B(t)}{\\partial k_b} = k_a \\left(\\frac{1}{k_a} B(t)\\right) - k_b \\left(\\frac{1}{k_b} B(t)\\right) = B(t) - B(t) = 0$$\n这种线性依赖关系，$(k_a, -k_b, 0, 0) \\cdot \\nabla_{\\theta} B(t) = 0$，表明这四个灵敏度函数的集合是线性相关的。因此，FIM 必须是秩亏的。其秩最多为 $4-1=3$。这证明了该模型是结构不可辨识的。参数 $k_a$ 和 $k_b$ 不能被独立确定；只有它们的乘积 $k_a k_b$ 是可辨识的。\n\n**步骤 2c：确定 FIM 的确切秩**\n\n为了证明秩恰好为 $3$，我们必须证明三个灵敏度函数的一个子集是线性无关的。让我们选择集合 $\\left\\{ \\frac{\\partial B}{\\partial k_a}, \\frac{\\partial B}{\\partial k_{dA}}, \\frac{\\partial B}{\\partial k_{dB}} \\right\\}$。\n假设存在一个对所有 $t$ 都等于零的线性组合：\n$$ c_1 \\frac{\\partial B}{\\partial k_a} + c_2 \\frac{\\partial B}{\\partial k_{dA}} + c_3 \\frac{\\partial B}{\\partial k_{dB}} = 0 $$\n所涉及的函数是时间函数基组的线性组合。\n1.  $\\frac{\\partial B}{\\partial k_a} = \\frac{1}{k_a}B(t)$，它是 $\\{1, \\exp(-k_{dA} t), \\exp(-k_{dB} t)\\}$ 的线性组合。\n2.  $\\frac{\\partial B}{\\partial k_{dB}}$：$B(t)$ 对 $k_{dB}$ 的依赖性涉及诸如 $1/k_{dB}$ 和 $\\exp(-k_{dB} t)$ 的项。由于对 $\\exp(-k_{dB} t)$ 应用链式法则，对 $k_{dB}$ 求导将产生一个形如 $t \\exp(-k_{dB} t)$ 的项。一个完整的推导（或通过灵敏度方程分析）表明 $\\frac{\\partial B}{\\partial k_{dB}}$ 是 $\\{1, \\exp(-k_{dA} t), \\exp(-k_{dB} t), t\\exp(-k_{dB} t)\\}$ 的线性组合。\n3.  $\\frac{\\partial B}{\\partial k_{dA}}$：同样，对 $k_{dA}$ 求导将产生一个形如 $t \\exp(-k_{dA} t)$ 的项。因此，$\\frac{\\partial B}{\\partial k_{dA}}$ 是 $\\{1, \\exp(-k_{dA} t), \\exp(-k_{dB} t), t\\exp(-k_{dA} t)\\}$ 的线性组合。\n\n合并后的函数基组是 $\\{1, \\exp(-k_{dA}t), \\exp(-k_{dB}t), t\\exp(-k_{dA}t), t\\exp(-k_{dB}t)\\}$。对于 $k_{dA}, k_{dB} > 0$ 和 $k_{dA} \\neq k_{dB}$，这些函数是线性无关的。\n\n让我们再次审视这个线性组合方程：\n$$ c_1 \\frac{\\partial B}{\\partial k_a} + c_2 \\frac{\\partial B}{\\partial k_{dA}} + c_3 \\frac{\\partial B}{\\partial k_{dB}} = 0 $$\n-   项 $t\\exp(-k_{dA}t)$ 仅出现在 $\\frac{\\partial B}{\\partial k_{dA}}$ 中（系数非零）。要使和为零，其总系数必须为零，这意味着 $c_2 = 0$。\n-   项 $t\\exp(-k_{dB}t)$ 仅出现在 $\\frac{\\partial B}{\\partial k_{dB}}$ 中（系数非零）。要使和为零，其总系数必须为零，这意味着 $c_3 = 0$。\n-   方程简化为 $c_1 \\frac{\\partial B}{\\partial k_a} = 0$。由于 $B(t)$ (以及 $\\frac{\\partial B}{\\partial k_a}$) 对于 $t>0$ 不恒为零，我们必须有 $c_1=0$。\n\n由于唯一的解是 $c_1=c_2=c_3=0$，所以三个灵敏度函数的集合 $\\left\\{ \\frac{\\partial B}{\\partial k_a}, \\frac{\\partial B}{\\partial k_{dA}}, \\frac{\\partial B}{\\partial k_{dB}} \\right\\}$ 是线性无关的。\n因为四个灵敏度函数张成一个维度为 $3$ 的空间，所以对于任何至少包含 $3$ 个不同测量时间的一般集合，费雪信息矩阵的秩将为 $3$。\n\n**结论：**\n\n该模型是结构不可辨识的。速率常数 $k_a$ 和 $k_b$ 不是独立可辨识的；只有它们的乘积 $k_a k_b$ 可以从 $B(t)$ 的测量中确定。可辨识的参数组合集是 $\\{k_a k_b, k_{dA}, k_{dB}\\}$，其中有 $3$ 个元素。费雪信息矩阵 (FIM) 的秩等于线性无关的灵敏度函数的数量，即 $3$。", "answer": "$$\\boxed{3}$$", "id": "3319713"}]}