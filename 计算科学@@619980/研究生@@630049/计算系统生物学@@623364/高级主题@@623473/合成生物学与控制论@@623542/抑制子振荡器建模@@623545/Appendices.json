{"hands_on_practices": [{"introduction": "在建立了单个基因的调控模型后，下一步是将其扩展到整个三基因环路系统。然而，包含mRNA和蛋白质动态的完整模型（六个常微分方程）在分析上可能相当复杂。本练习将引导您应用计算系统生物学中的一个核心技术——准稳态近似（QSSA），来简化模型。您将亲手实践如何通过假设mRNA动态远快于蛋白质动态，将模型从六维降至三维，并进行无量纲化，从而揭示出决定系统行为的关键参数组合 [@problem_id:3328425]。", "problem": "考虑一个典型的三基因阻遏振荡子模型，其中每个基因的产物会阻遏循环中下一个基因的转录。设 $m_i(t)$ 表示基因 $i$ 的信使核糖核酸 (mRNA) 浓度，$P_i(t)$ 表示其对应蛋白质的浓度，其中 $i \\in \\{1,2,3\\}$ 且索引对 $3$ 取模，因此基因 $0$ 即为基因 $3$。假设转录阻遏遵循希尔函数，降解和翻译动力学为线性。每个节点的有量纲常微分方程 (ODE) 由基于质量作用降解、希尔型转录阻遏和一级翻译的标准形式给出：\n$$\\frac{dm_i}{dt} \\;=\\; -\\,\\gamma_m\\, m_i \\;+\\; \\alpha_0 \\;+\\; \\frac{\\alpha}{1 + \\left(\\dfrac{P_{i-1}}{K}\\right)^{n}}, \\qquad \\frac{dP_i}{dt} \\;=\\; -\\,\\gamma_p\\, P_i \\;+\\; k\\, m_i,$$\n其中 $\\gamma_m$ 是 mRNA 降解速率，$\\gamma_p$ 是蛋白质降解速率，$\\alpha_0$ 是基础转录速率，$\\alpha$ 是最大被阻遏转录贡献， $K$ 是阻遏阈值（半最大效应浓度），$n$ 是希尔系数，$k$ 是翻译速率常数。\n\n从这些有量纲方程出发，仅使用无量纲时间 $\\tau := \\gamma_p\\, t$ 和无量纲蛋白质浓度 $p_i := P_i/K$ 的定义，执行标准的快速mRNA简化（当mRNA的弛豫时间尺度远快于蛋白质时，对 $m_i$ 采用准稳态近似），以获得一个关于 $p_i(\\tau)$ 的单一 ODE，其右侧仅用 $p_{i-1}$、$p_i$ 和您必须从第一性原理确定的三个简化参数 $(\\tilde{\\alpha}, \\tilde{\\alpha}_0, n)$ 表示。在您的推导中，请定义mRNA与蛋白质的时间尺度比 $\\beta := \\gamma_m/\\gamma_p$ 以及通过结合翻译与阻遏阈值而自然产生的mRNA标度因子 $kK/\\gamma_m$。\n\n给定参数值 $\\gamma_m = 0.2$ min$^{-1}$，$\\gamma_p = 0.02$ min$^{-1}$，$K = 50$ nM，以及 $k = 0.5$ min$^{-1}$：\n1) 计算 $\\beta = \\gamma_m/\\gamma_p$。\n2) 计算mRNA标度因子 $kK/\\gamma_m$ 并以 nM 表示。\n3) 写出简化模型最终的无量纲方程 $dp_i/d\\tau$，用 $(\\tilde{\\alpha}, \\tilde{\\alpha}_0, n)$ 表示。\n\n将所有数值四舍五入至四位有效数字。对于第2项，以nM为单位表示该值。您的最终答案必须按顺序呈现 $\\beta$ 的值、$kK/\\gamma_m$ 的值（以nM为单位）以及所要求的无量纲方程 $dp_i/d\\tau$，形式为一个单行行向量。在最终的方框答案中不要包含单位。如有角度，请以弧度表示；在答案的任何地方都不要使用度或百分号。", "solution": "该问题要求推导阻遏振荡子基因回路的简化无量纲模型，并计算两个特定的参数组合。验证证实了该问题在科学上是合理的、适定的和客观的。这是计算系统生物学中的一个标准练习。\n\n首先，我们必须承认问题陈述中存在一个轻微的符号歧义。有量纲的蛋白质浓度在文本中最初表示为 $p_i(t)$，但无量纲蛋白质浓度的定义为 $p_i := P_i/K$，其中 $P_i$ 明确指出是有量纲的浓度。为保持清晰和严谨，我们在整个推导过程中将使用 $P_i(t)$ 表示有量纲的蛋白质浓度。因此，所提供的常微分方程 (ODE) 为：\n$$\n\\frac{dm_i}{dt} = -\\gamma_m m_i + \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{P_{i-1}}{K}\\right)^{n}}\n$$\n$$\n\\frac{dP_i}{dt} = -\\gamma_p P_i + k m_i\n$$\n\n第一步是执行‘快速mRNA简化’。这是应用于mRNA浓度的准稳态近似 (QSSA)，当mRNA降解远快于蛋白质降解时（即 $\\gamma_m \\gg \\gamma_p$），该近似是合理的。在此假设下，我们令 $\\frac{dm_i}{dt} = 0$，并求解稳态mRNA浓度，我们将其表示为 $m_i^{ss}$。\n$$\n0 = -\\gamma_m m_i^{ss} + \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{P_{i-1}}{K}\\right)^{n}}\n$$\n求解 $m_i^{ss}$：\n$$\n\\gamma_m m_i^{ss} = \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{P_{i-1}}{K}\\right)^{n}}\n$$\n$$\nm_i^{ss}(P_{i-1}) = \\frac{1}{\\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{P_{i-1}}{K}\\right)^{n}} \\right)\n$$\n该表达式表明，mRNA浓度会迅速平衡到一个由阻遏蛋白 $P_{i-1}$ 浓度决定的值。\n\n接下来，我们将这个准稳态表达式 $m_i$ 代入蛋白质浓度 $P_i$ 的ODE中。这将系统从 $6$ 个耦合的ODE减少到 $3$ 个。\n$$\n\\frac{dP_i}{dt} = -\\gamma_p P_i + k m_i^{ss} = -\\gamma_p P_i + \\frac{k}{\\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{P_{i-1}}{K}\\right)^{n}} \\right)\n$$\n这就是蛋白质动力学的简化有量纲模型。\n\n下一步是使用给定的定义对这个简化方程进行无量纲化：无量纲时间 $\\tau := \\gamma_p t$ 和无量纲蛋白质浓度 $p_i := P_i/K$。根据这些定义，我们有 $t = \\tau/\\gamma_p$ 和 $P_i = K p_i$。我们使用链式法则将时间导数 $\\frac{dP_i}{dt}$ 用无量纲变量表示：\n$$\n\\frac{dP_i}{dt} = \\frac{d(K p_i)}{d(\\tau/\\gamma_p)} = K \\frac{dp_i}{d\\tau} \\frac{d\\tau}{dt} = K \\gamma_p \\frac{dp_i}{d\\tau}\n$$\n现在，将无量纲变量和新的导数形式代入简化的ODE中：\n$$\nK \\gamma_p \\frac{dp_i}{d\\tau} = -\\gamma_p (K p_i) + \\frac{k}{\\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + \\left(\\frac{K p_{i-1}}{K}\\right)^{n}} \\right)\n$$\n简化希尔函数内部的项：\n$$\nK \\gamma_p \\frac{dp_i}{d\\tau} = -\\gamma_p K p_i + \\frac{k}{\\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + p_{i-1}^{n}} \\right)\n$$\n为了分离出 $\\frac{dp_i}{d\\tau}$，我们将整个方程除以 $K \\gamma_p$：\n$$\n\\frac{dp_i}{d\\tau} = \\frac{-\\gamma_p K p_i}{K \\gamma_p} + \\frac{1}{K \\gamma_p} \\frac{k}{\\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + p_{i-1}^{n}} \\right)\n$$\n$$\n\\frac{dp_i}{d\\tau} = -p_i + \\frac{k}{K \\gamma_p \\gamma_m} \\left( \\alpha_0 + \\frac{\\alpha}{1 + p_{i-1}^{n}} \\right)\n$$\n分配集总参数项得到：\n$$\n\\frac{dp_i}{d\\tau} = -p_i + \\frac{k \\alpha_0}{K \\gamma_p \\gamma_m} + \\frac{k \\alpha}{K \\gamma_p \\gamma_m (1 + p_{i-1}^{n})}\n$$\n问题指明最终的无量纲ODE应以三个简化参数 $(\\tilde{\\alpha}, \\tilde{\\alpha}_0, n)$ 表示。通过将我们推导的方程与目标形式 $\\frac{dp_i}{d\\tau} = -p_i + \\tilde{\\alpha}_0 + \\frac{\\tilde{\\alpha}}{1 + p_{i-1}^{n}}$ 进行比较，我们可以从第一性原理确定无量纲参数组 $\\tilde{\\alpha}_0$ 和 $\\tilde{\\alpha}$：\n$$\n\\tilde{\\alpha}_0 = \\frac{k \\alpha_0}{K \\gamma_p \\gamma_m}\n$$\n$$\n\\tilde{\\alpha} = \\frac{k \\alpha}{K \\gamma_p \\gamma_m}\n$$\n希尔系数 $n$ 本身是无量纲的，保持不变。因此，简化模型的最终无量纲ODE是：\n$$\n\\frac{dp_i}{d\\tau} = -p_i + \\tilde{\\alpha}_0 + \\frac{\\tilde{\\alpha}}{1 + p_{i-1}^n}\n$$\n这完成了第三个要求项的推导。\n\n最后，我们使用给定的参数计算前两项的数值：$\\gamma_m = 0.2 \\text{ min}^{-1}$，$\\gamma_p = 0.02 \\text{ min}^{-1}$，$K = 50 \\text{ nM}$，以及 $k = 0.5 \\text{ min}^{-1}$。\n\n1) 计算 $\\beta = \\gamma_m/\\gamma_p$：\n$$\n\\beta = \\frac{0.2 \\text{ min}^{-1}}{0.02 \\text{ min}^{-1}} = 10\n$$\n四舍五入到四位有效数字，我们得到 $10.00$。\n\n2) 计算mRNA标度因子 $kK/\\gamma_m$：\n$$\n\\frac{kK}{\\gamma_m} = \\frac{(0.5 \\text{ min}^{-1})(50 \\text{ nM})}{0.2 \\text{ min}^{-1}} = \\frac{25}{0.2} \\text{ nM} = 125 \\text{ nM}\n$$\n四舍五入到四位有效数字，我们得到 $125.0 \\text{ nM}$。\n\n最终答案的三个部分是 $\\beta$ 的值、$kK/\\gamma_m$ 的值（以nM为单位）和最终的无量纲方程。", "answer": "$$\n\\boxed{\\begin{pmatrix} 10.00  125.0  \\frac{dp_i}{d\\tau} = -p_i + \\tilde{\\alpha}_0 + \\frac{\\tilde{\\alpha}}{1 + p_{i-1}^{n}} \\end{pmatrix}}\n$$", "id": "3328425"}, {"introduction": "获得了一个简化的、无量纲的“压抑子”模型后，我们就可以开始分析它的动态行为了。任何动力学分析的起点都是确定系统的稳态，即固定点，这些点代表了系统中所有变量不随时间变化的状态。本练习要求您从理论上推导出对称固定点所满足的代数方程，并进一步通过编写程序，使用数值方法求解在不同参数条件下的固定点。这个实践将理论分析与计算实现相结合，是理解系统如何从稳态过渡到振荡的关键第一步 [@problem_id:3328450]。", "problem": "考虑一个经典的三基因环路转录抑制网络，即抑制子（repressilator），在蛋白质水平上，其环路中每个节点的模型由以下常微分方程（ODE）描述。对于基因索引 $i \\in \\{1,2,3\\}$，采用循环索引 $p_0 \\equiv p_3$，无量纲蛋白质浓度 $p_i(t)$ 的演化遵循以下方程\n$${\\frac{dp_i}{dt}} = -\\,p_i \\;+\\; \\frac{\\alpha}{1 + \\left(p_{i-1}\\right)^n} \\;+\\; \\alpha_0,$$\n其中 $\\alpha \\ge 0$ 是最大无量纲生产速率，$\\alpha_0 \\ge 0$ 是无量纲基础（泄漏）生产速率，而 $n \\ge 1$ 是希尔系数。假设存在一个对称不动点，满足 $p_1 = p_2 = p_3 = p^\\star$。\n\n你的任务是：\n- 从蛋白质动力学的基本建模原理（即生产速率减去降解速率）和环路拓扑中生产的希尔抑制形式出发，推导出在对称性假设下 $p^\\star$ 必须满足的标量不动点条件。\n- 实现一个数值方法，计算 $p^\\star$ 作为对称不动点的标量不动点条件的唯一非负解。\n- 通过在计算出的 $p^\\star$ 处评估 ODE 的右侧来验证该不动点，从而获得残差（如果计算是一致的，该残差在数值上应接近于零）。使用该残差的绝对值作为验证指标。\n\n使用以下参数集 $(\\alpha,\\alpha_0,n)$ 测试套件：\n- 测试 1：$(\\alpha,\\alpha_0,n) = (50,0,3)$。\n- 测试 2：$(\\alpha,\\alpha_0,n) = (10,0,3)$。\n- 测试 3：$(\\alpha,\\alpha_0,n) = (50,0,1)$。\n- 测试 4：$(\\alpha,\\alpha_0,n) = (50,5,3)$。\n- 测试 5：$(\\alpha,\\alpha_0,n) = (0,0,3)$。\n\n实现和数值要求：\n- 通过求解你推导出的对称不动点条件的一维求根问题来计算 $p^\\star$。使用一种区间法，该方法能保证在有限区间上的连续严格单调函数收敛。你的算法在 $\\alpha = 0$ 和/或 $\\alpha_0 = 0$ 时必须是鲁棒的。\n- 对于每个测试用例，按顺序输出两个量：首先是计算出的 $p^\\star$，然后是将 $p^\\star$ 代入任意节点（因为对称性意味着所有节点的值都相同）的 ODE 右侧得到的绝对残差。两个值都必须表示为四舍五入到10位小数的十进制数。\n- 所有变量都是无量纲的；不需要物理单位。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序连接测试1的对 $\\left(p^\\star,\\text{residual}\\right)$，然后是测试2的对，依此类推直到测试5。例如，你的输出必须如下所示\n$[\\text{p1},\\text{r1},\\text{p2},\\text{r2},\\text{p3},\\text{r3},\\text{p4},\\text{r4},\\text{p5},\\text{r5}]$\n其中每个 $\\text{p\\#}$ 和 $\\text{r\\#}$ 都四舍五入到10位小数。", "solution": "我们从计算系统生物学中蛋白质水平的标准平衡方程开始：蛋白质浓度的变化率等于生产速率减去降解速率。在抑制子（repressilator）中，每个基因产物抑制环路中的下一个基因，而这种抑制作用通常用希尔系数为 $n \\ge 1$ 的希尔函数来建模。使用无量纲蛋白质浓度 $p_i(t)$ 和时间 $t$，节点 $i \\in \\{1,2,3\\}$ 的常微分方程（ODE）为\n$$\\frac{dp_i}{dt} \\;=\\; -p_i \\;+\\; \\frac{\\alpha}{1 + \\left(p_{i-1}\\right)^n} \\;+\\; \\alpha_0,$$\n其中 $\\alpha \\ge 0$ 是最大生产参数，$\\alpha_0 \\ge 0$ 是基础（泄漏）生产参数，而 $n \\ge 1$ 代表抑制作用中的协同性。降解项是一阶的，系数为1，这与无量纲化处理是一致的。希尔抑制形式 $\\alpha/(1 + (p_{i-1})^n)$ 表示随着抑制物浓度的增加，生产速率会降低。\n\n一个不动点 $(p_1^\\star,p_2^\\star,p_3^\\star)$ 满足对所有 $i$ 都有 $\\frac{dp_i}{dt} = 0$。在对称不动点假设 $p_1^\\star = p_2^\\star = p_3^\\star = p^\\star$ 下，通过将 $p_i = p_{i-1} = p^\\star$ 代入方程右侧，可以得到单一的标量不动点条件：\n$$0 \\;=\\; -p^\\star \\;+\\; \\frac{\\alpha}{1 + \\left(p^\\star\\right)^n} \\;+\\; \\alpha_0.$$\n定义标量函数\n$$f(p) \\;=\\; -p \\;+\\; \\frac{\\alpha}{1 + p^n} \\;+\\; \\alpha_0.$$\n那么 $p^\\star$ 是 $f(p)=0$ 的任意非负根。对于 $\\alpha \\ge 0$, $\\alpha_0 \\ge 0$ 和 $n \\ge 1$，我们观察到 $f$ 在 $[0,\\infty)$ 上是严格递减的。求导可得，\n$$f'(p) \\;=\\; -1 \\;+\\; \\frac{d}{dp}\\!\\left(\\frac{\\alpha}{1+p^n}\\right) \\;=\\; -1 \\;-\\; \\frac{\\alpha\\,n\\,p^{n-1}}{(1+p^n)^2} \\;\\; 0,$$\n对于所有 $p \\ge 0$（只要 $\\alpha  0$ 和 $n \\ge 1$）。此外，\n$$f(0) \\;=\\; \\alpha + \\alpha_0 \\;\\ge\\; 0,$$\n且\n$$\\lim_{p\\to\\infty} f(p) \\;=\\; \\lim_{p\\to\\infty} \\left(-p + \\frac{\\alpha}{1+p^n} + \\alpha_0\\right) \\;=\\; -\\infty.$$\n根据介值定理和严格单调性，存在一个唯一的根 $p^\\star \\in [0,\\infty)$。在 $\\alpha = \\alpha_0 = 0$ 的特殊退化情况下，直接得到 $p^\\star = 0$。\n\n算法设计：\n- 对于给定的 $(\\alpha,\\alpha_0,n)$ 及其上述约束，求解在 $[0,\\infty)$ 上的 $f(p)=0$。\n- 处理 $f(0)=0$ 的退化情况，返回 $p^\\star = 0$。\n- 否则，找到一个括号区间 $[a,b]$，其中 $a=0$ 且 $b0$，使得 $f(a)\\cdot f(b)  0$。因为 $f(0)\\ge 0$ 且当 $p\\to\\infty$ 时 $f(p)\\to -\\infty$，所以对于有限的 $\\alpha_0$，这样的 $b$ 总是存在的。可以使用一个简单的加倍策略：从 $b=1$ 开始，重复设置 $b \\leftarrow 2b$ 直到 $f(b)0$。\n- 使用鲁棒的区间求根方法，如 Brent 方法，在 $[0,b]$ 内以高精度找到唯一的根 $p^\\star$。由于 $f$ 是连续且严格递减的，该方法能够可靠地收敛。\n- 通过将 $p^\\star$ 代入对称性下一个节点的 ODE 右侧（即表达式 $f(p^\\star)$）来验证该不动点，并报告绝对残差 $|f(p^\\star)|$，其数值上应接近于 $0$。\n\n测试套件和输出：\n- 我们计算 $(\\alpha,\\alpha_0,n)$ 分别等于 $(50,0,3)$、$(10,0,3)$、$(50,0,1)$、$(50,5,3)$ 和 $(0,0,3)$ 时的 $(p^\\star,\\text{residual})$。\n- 对于每个测试，我们输出 $p^\\star$ 和残差大小，两者都四舍五入到10位小数。\n- 最终输出为单行：一个用方括号括起来的逗号分隔列表，按顺序连接测试1的对，然后是测试2的对，依此类推直到测试5。\n\n这种方法是基于原理的：我们从生产减去降解模型和对称环路中的希尔抑制推导出了标量不动点条件，通过单调性证明了其唯一性，利用渐近行为构造了一个括号区间，并应用鲁棒的数值方法来计算和验证该不动点。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef fixed_point_symmetric(alpha: float, alpha0: float, n: int,\n                          rtol: float = 1e-12, atol: float = 1e-14, maxiter: int = 1000):\n    \"\"\"\n    Compute the symmetric fixed point p* for the repressilator scalar equation:\n      f(p) = -p + alpha/(1 + p^n) + alpha0 = 0\n    Returns (p_star, residual_abs).\n    \"\"\"\n    def f(p):\n        # Ensure nonnegative p during evaluations; bracketing will keep interval in [0, +inf)\n        # but allow any positive p input for robustness.\n        return -p + alpha / (1.0 + p**n) + alpha0\n\n    f0 = f(0.0)\n    if abs(f0) == 0.0:\n        # Degenerate trivial fixed point\n        p_star = 0.0\n        residual = abs(f(p_star))\n        return p_star, residual\n\n    # Find a bracket [0, hi] with f(0) = 0 and f(hi)  0\n    hi = 1.0\n    # To avoid infinite loops, limit the number of doublings\n    for _ in range(1000):\n        f_hi = f(hi)\n        if f_hi  0.0:\n            break\n        hi *= 2.0\n    else:\n        # If no sign change found (should not happen for finite alpha0), fall back to a large hi\n        f_hi = f(hi)\n\n    # Use Brent's method to find the unique root in [0, hi]\n    sol = root_scalar(f, bracket=[0.0, hi], method='brentq', rtol=rtol, xtol=atol, maxiter=maxiter)\n    if not sol.converged:\n        # As a fallback, attempt a slightly expanded bracket\n        hi *= 2.0\n        sol = root_scalar(f, bracket=[0.0, hi], method='brentq', rtol=rtol, xtol=atol, maxiter=maxiter)\n        if not sol.converged:\n            raise RuntimeError(\"Root finding did not converge for parameters \"\n                               f\"(alpha={alpha}, alpha0={alpha0}, n={n}).\")\n    p_star = sol.root\n    residual = abs(f(p_star))\n    return p_star, residual\n\ndef solve():\n    # Define the test cases: (alpha, alpha0, n)\n    test_cases = [\n        (50.0, 0.0, 3),  # Test 1\n        (10.0, 0.0, 3),  # Test 2\n        (50.0, 0.0, 1),  # Test 3\n        (50.0, 5.0, 3),  # Test 4\n        (0.0, 0.0, 3),   # Test 5\n    ]\n\n    results = []\n    for alpha, alpha0, n in test_cases:\n        p_star, residual = fixed_point_symmetric(alpha, alpha0, n)\n        results.append(f\"{p_star:.10f}\")\n        results.append(f\"{residual:.10f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3328450"}]}