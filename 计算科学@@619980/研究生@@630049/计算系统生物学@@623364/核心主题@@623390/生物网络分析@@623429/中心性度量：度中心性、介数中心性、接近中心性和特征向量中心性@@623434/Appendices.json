{"hands_on_practices": [{"introduction": "要真正掌握中心性度量，我们必须从理论走向实践。第一个练习将聚焦于度中心性，这是基于节点直接连接数量的最直观的重要性度量。通过将其应用于星形图——一种代表主调节蛋白及其靶标等系统的常见拓扑结构——你将从第一性原理出发计算中心性，并分析为何这种简单的局部度量能够识别核心节点，却无法捕捉更细微的结构差异。[@problem_id:3294657]", "problem": "考虑一个蛋白质-蛋白质相互作用（PPI）网络，其拓扑结构为一个具有 $N$ 个节点的星形图，模拟了一个单一的主调节蛋白 $h$ 与 $N-1$ 个外周蛋白 $\\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$ 相互作用。该网络是无向、简单（无自环或多重边）且无权的。设图为 $G = (V, E)$，其中 $V = \\{ h \\} \\cup \\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$ 且 $E = \\{ (h, \\ell_{j}) : j = 1, 2, \\dots, N-1 \\}$。\n\n仅使用适用于计算系统生物学的图论第一性原理，计算每个节点的度中心性，并根据一个具有 $N$ 个节点的简单无向图中的最大可能度进行归一化。然后，分析为什么这种基于度的度量能够正确识别中心节点 $h$，但对叶节点 $\\{ \\ell_{j} \\}$ 之间可能由生物异质性（例如，下游通路角色的差异）引起的任何结构差异不敏感，尽管这些差异在生物学解释中具有相关性。\n\n将任意节点 $i \\in V$ 的归一化度中心性 $C_{D}(i)$ 的最终答案，用 $N$ 和一个区分节点 $i$ 是中心节点 $h$ 还是叶节点的指示符，表示为单个闭式解析表达式。无需四舍五入。最终值为无量纲。", "solution": "问题陈述具有科学依据、自洽且定义明确。它基于图论的基本、无歧义的定义及其在计算系统生物学中的标准应用。因此，我们可以进行形式化的求解。\n\n问题将一个蛋白质-蛋白质相互作用网络描述为一个具有 $N$ 个节点的星形图 $G = (V, E)$。顶点集为 $V = \\{ h \\} \\cup \\{ \\ell_{1}, \\ell_{2}, \\dots, \\ell_{N-1} \\}$，其中 $h$ 是中心节点，$\\{ \\ell_{j} \\}_{j=1}^{N-1}$ 代表 $N-1$ 个外围叶节点的集合。节点总数为 $|V| = N$。边集为 $E = \\{ (h, \\ell_{j}) : j = 1, 2, \\dots, N-1 \\}$，表示中心节点 $h$ 连接到每个叶节点，且任意两个叶节点之间没有边。该图是简单且无向的。\n\n我们的首要任务是计算每个节点的度。节点 $i$ 的度记作 $\\deg(i)$，是与该节点相关联的边的数量。\n对于中心节点 $h$，它连接到所有 $N-1$ 个叶节点。因此其度为：\n$$\n\\deg(h) = N-1\n$$\n对于任意外围叶节点 $\\ell_{j}$，其中 $j \\in \\{1, 2, \\dots, N-1\\}$，它只连接到唯一的中心节点 $h$。因此其度为：\n$$\n\\deg(\\ell_{j}) = 1\n$$\n\n接下来，我们计算归一化度中心性 $C_{D}(i)$。问题指定了通过一个具有 $N$ 个节点的简单无向图中的最大可能度进行归一化。对于一个有 $N$ 个顶点的图，任何单个顶点最多可以连接到其他 $N-1$ 个顶点。因此，最大可能度为 $N-1$。\n节点 $i$ 的归一化度中心性定义为其度与这个最大可能度的比值：\n$$\nC_{D}(i) = \\frac{\\deg(i)}{N-1}\n$$\n\n将此公式应用于星形图的节点：\n对于中心节点 $h$：\n$$\nC_{D}(h) = \\frac{\\deg(h)}{N-1} = \\frac{N-1}{N-1} = 1\n$$\n对于任意叶节点 $\\ell_{j}$：\n$$\nC_{D}(\\ell_{j}) = \\frac{\\deg(\\ell_{j})}{N-1} = \\frac{1}{N-1}\n$$\n\n任务的第二部分是分析此度量的性质。\n度中心性度量成功地将中心节点 $h$ 识别为最核心的节点。其中心性值 $C_{D}(h) = 1$ 是任何简单图中的最大可能值，而任何叶节点的中心性为 $C_{D}(\\ell_{j}) = \\frac{1}{N-1}$。对于任何非平凡星形图（即 $N > 2$），我们有 $1 > \\frac{1}{N-1}$，因此中心节点的中心性严格大于任何其他节点。\n\n该度量对叶节点间差异的不敏感性是其定义的直接结果。度是一个纯粹的局部连通性度量；它只计算一个节点的直接邻居数量。在星形图拓扑中，从局部角度看，每个叶节点 $\\ell_{j}$ 在结构上都是相同的：每个都是度为1的节点，连接到一个邻居（中心节点）。因此，它们的度中心性都完全相同，$C_{D}(\\ell_{j}) = \\frac{1}{N-1}$。因此，该度量对叶节点所代表的蛋白质之间任何潜在的“生物异质性”或功能角色差异（例如，下游通路参与）是“盲目”的，因为这些角色并未编码在直接的局部拓扑结构中。这个局限性说明了为什么通常需要更全局性的中心性度量（这些度量考虑了整个网络结构中的路径和位置）以便在生物网络中获得对节点重要性的更细致的理解。\n\n为了将任意节点 $i \\in V$ 的归一化度中心性 $C_{D}(i)$ 表示为单个闭式表达式，我们引入一个指示函数。设 $\\delta_{i,h}$ 为 Kronecker delta，其定义为：如果节点 $i$ 是中心节点 $h$，则 $\\delta_{i,h} = 1$；如果节点 $i$ 是叶节点，则 $\\delta_{i,h} = 0$。然后我们可以通过结合两种情况的结果来写出 $C_D(i)$ 的通用表达式：\n$$\nC_{D}(i) = (1) \\cdot \\delta_{i,h} + \\left(\\frac{1}{N-1}\\right) \\cdot (1 - \\delta_{i,h})\n$$\n该表达式可以简化为更紧凑的形式：\n$$\nC_{D}(i) = \\delta_{i,h} + \\frac{1 - \\delta_{i,h}}{N-1}\n$$\n这个单一、紧凑的表达式根据图中任意节点 $i$ 的身份，正确地给出其中心性，满足了问题的要求。", "answer": "$$\n\\boxed{\\delta_{i,h} + \\frac{1 - \\delta_{i,h}}{N-1}}\n$$", "id": "3294657"}, {"introduction": "我们之前的练习揭示了度中心性在区分结构等价的外围节点方面的局限性。在这里，我们将探索一种更精细的度量——特征向量中心性，它不仅考虑连接的数量，还考虑这些连接的重要性。通过在同一个星形图上计算特征向量中心性，你将看到这种全局度量如何为节点影响力提供一个不同的视角，并定量地比较它与度中心性在区分核心与外围节点能力上的差异。[@problem_id:3294654]", "problem": "在一项基因调控模块的计算系统生物学分析中，考虑一个代表转录因子中心枢纽调控靶基因的无向、无权重星形网络：一个中心枢纽节点调控 $N-1$ 个靶基因，且靶基因之间无其他相互作用。该网络是具有 $N$ 个节点的星形图 $K_{1,N-1}$。令 $A$ 表示其邻接矩阵。\n\n仅使用以下基本定义：\n- 特征向量中心性向量 $x$ 是满足 $A x = \\lambda x$ 的任意正向量，其中 $\\lambda$ 是 $A$ 的最大特征值。\n- 节点 $i$ 的度中心性 $k_{i}$ 是其邻居的数量。\n\n从第一性原理出发，推导中心枢纽与任一叶节点的特征向量中心性比率，以及中心枢纽与任一叶节点的度中心性比率。然后将比较区分因子 $R(N)$ 定义为这两个比率之比：\n$$\nR(N) \\equiv \\frac{\\text{(hub-to-leaf eigenvector centrality ratio)}}{\\text{(hub-to-leaf degree centrality ratio)}}.\n$$\n提供 $R(N)$ 关于 $N$ 的闭式解析表达式。将最终答案表示为单一的精确表达式；无需四舍五入，也无单位。", "solution": "问题要求给出星形网络 $K_{1,N-1}$ 的比较区分因子 $R(N)$ 的闭式解析表达式。该因子定义为中心枢纽与叶节点的特征向量中心性比率与中心枢纽与叶节点的度中心性比率之比。我们将从所提供的第一性原理和定义出发推导此表达式。\n\n令节点集合为 $V = \\{v_1, v_2, \\dots, v_N\\}$。我们指定 $v_1$ 为中心枢纽节点，$\\{v_2, \\dots, v_N\\}$ 为 $N-1$ 个外围叶节点。该图是无向和无权重的。边仅存在于中心枢纽和每个叶节点之间。大小为 $N \\times N$ 的邻接矩阵 $A$（以中心枢纽为第一个索引）可以写成：\n$$\nA_{ij} =\n\\begin{cases}\n1  \\text{if } i=1, j > 1 \\\\\n1  \\text{if } j=1, i > 1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其分块矩阵形式为 $A = \\begin{pmatrix} 0  \\mathbf{1}_{N-1}^T \\\\ \\mathbf{1}_{N-1}  \\mathbf{0}_{N-1 \\times N-1} \\end{pmatrix}$，其中 $\\mathbf{1}_{N-1}$ 是一个包含 $N-1$ 个 1 的列向量，$\\mathbf{0}_{N-1 \\times N-1}$ 是 $(N-1) \\times (N-1)$ 的零矩阵。此分析对 $N \\ge 2$ 有效。\n\n首先，我们计算中心枢纽和叶节点的度中心性。节点 $v_i$ 的度中心性 $k_i$ 是其邻居的数量，即邻接矩阵第 $i$ 行的元素之和。\n\n对于中心枢纽节点 $v_1$：\n$$\nk_{hub} = k_1 = \\sum_{j=1}^{N} A_{1j} = \\sum_{j=2}^{N} 1 = N-1\n$$\n\n对于任意叶节点 $v_i$（其中 $i \\in \\{2, \\dots, N\\}$）：\n$$\nk_{leaf} = k_i = \\sum_{j=1}^{N} A_{ij} = A_{i1} = 1\n$$\n\n因此，中心枢纽与叶节点的度中心性比率为：\n$$\n\\frac{k_{hub}}{k_{leaf}} = \\frac{N-1}{1} = N-1\n$$\n\n接下来，我们计算特征向量中心性。根据所提供的定义，特征向量中心性向量 $x = (x_1, x_2, \\dots, x_N)^T$ 是一个正向量，它是邻接矩阵 $A$ 对应于最大特征值 $\\lambda$ 的特征向量。该方程为 $Ax = \\lambda x$。\n\n由于星形图的对称性，所有叶节点在拓扑上是等价的。因此，它们的特征向量中心性分量必须相等。令 $x_1 = x_{hub}$ 为中心枢纽的中心性，并令所有 $i \\in \\{2, \\dots, N\\}$ 的 $x_i = x_{leaf}$。\n\n我们可以将矩阵方程 $Ax = \\lambda x$ 写成一个标量方程组：\n对于中心枢纽节点（$i=1$）：\n$$\n\\sum_{j=1}^{N} A_{1j} x_j = \\lambda x_1 \\implies \\sum_{j=2}^{N} x_j = \\lambda x_1\n$$\n将 $j=2, \\dots, N$ 时的 $x_j=x_{leaf}$ 和 $x_1=x_{hub}$ 代入，我们得到：\n$$\n(N-1) x_{leaf} = \\lambda x_{hub} \\quad (1)\n$$\n\n对于任意叶节点（例如，$i=2$）：\n$$\n\\sum_{j=1}^{N} A_{2j} x_j = \\lambda x_2 \\implies A_{21} x_1 = \\lambda x_2\n$$\n将 $x_1=x_{hub}$ 和 $x_2=x_{leaf}$ 代入，我们得到：\n$$\nx_{hub} = \\lambda x_{leaf} \\quad (2)\n$$\n\n现在我们有一个关于 $x_{hub}$ 和 $x_{leaf}$ 的二元线性方程组。为了求特征值 $\\lambda$，我们将方程 $(2)$ 代入方程 $(1)$：\n$$\n(N-1) x_{leaf} = \\lambda (\\lambda x_{leaf}) = \\lambda^2 x_{leaf}\n$$\n由于特征向量中心性是为正向量 $x$ 定义的，我们必须有 $x_{leaf} > 0$。因此我们可以除以 $x_{leaf}$：\n$$\n\\lambda^2 = N-1\n$$\n这给出了两个可能的特征值，$\\lambda = \\sqrt{N-1}$ 和 $\\lambda = -\\sqrt{N-1}$。根据佩龙-弗罗贝尼乌斯定理的保证，一个连通图的邻接矩阵有唯一的最大特征值，且该特征值为正。因此，最大特征值为：\n$$\n\\lambda_{max} = \\sqrt{N-1}\n$$\n\n现在我们用这个特征值来求特征向量中心性。根据方程 $(2)$：\n$$\nx_{hub} = \\lambda_{max} \\cdot x_{leaf} = \\sqrt{N-1} \\cdot x_{leaf}\n$$\n中心枢纽与叶节点的特征向量中心性比率是它们在特征向量中对应分量的比率：\n$$\n\\frac{x_{hub}}{x_{leaf}} = \\frac{\\sqrt{N-1} \\cdot x_{leaf}}{x_{leaf}} = \\sqrt{N-1}\n$$\n\n最后，我们使用其定义来计算比较区分因子 $R(N)$：\n$$\nR(N) = \\frac{\\text{(hub-to-leaf eigenvector centrality ratio)}}{\\text{(hub-to-leaf degree centrality ratio)}}\n$$\n代入我们推导出的两个比率：\n$$\nR(N) = \\frac{\\sqrt{N-1}}{N-1}\n$$\n此表达式可以通过识别 $N-1 = (\\sqrt{N-1})^2$ 来简化：\n$$\nR(N) = \\frac{\\sqrt{N-1}}{(\\sqrt{N-1})^2} = \\frac{1}{\\sqrt{N-1}}\n$$\n这就是 $R(N)$ 关于 $N$ 的闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{N-1}}}\n$$", "id": "3294654"}, {"introduction": "一个节点的重要性也可以源于其在通讯通路中扮演的“桥梁”角色，这个概念由介数中心性（betweenness centrality）来捕捉。本练习在一个加权网络的背景下介绍这种基于路径的度量，这在系统生物学中是一个常见情景，因为相互作用具有不同的强度或效率。你将学习到边权重如何重新定义“最短”路径，以及这些路径中的“并列”情况如何影响节点的最终介数值，从而深入理解节点在网络信息流中的控制作用。[@problem_id:3294601]", "problem": "考虑一个无向加权网络基序，它代表了通路中相互作用的三个信号蛋白 $v_{1}$、$v_{2}$ 和 $v_{3}$。边权重表示有效路径长度（例如，复合延迟或信号流阻力），并且严格为正。该基序是一个带有一条重边的三角形：其边和权重分别为：边 $(v_{1},v_{2})$ 的权重为 $4$，边 $(v_{1},v_{3})$ 的权重为 $2$，边 $(v_{2},v_{3})$ 的权重为 $2$。假设加权最短路径的定义是最小化路径上边权重的总和，并且中介中心性只计算节点在源和目标之间严格作为中间节点的路径的贡献（端点不计入自身的中介性）。\n\n从加权图中测地线路径的基本定义以及基于测地线数量的中介中心性组合概念出发，计算该基序中每个节点 $v \\in \\{v_{1},v_{2},v_{3}\\}$ 的中介中心性 $C_{B}(v)$。在你的推理过程中，解释最短路径中的“平局”情况如何影响中间节点对中介性的贡献。\n\n请将最终数值答案按 $v_{1}$、$v_{2}$、$v_{3}$ 的顺序表示为行向量。无需四舍五入。", "solution": "问题陈述已经过验证，被认为是有效的。这是一个在图论和网络分析领域中定义明确、有科学依据的问题，提供了获得唯一解所需的所有信息。\n\n该问题要求计算一个给定的三节点无向加权图中每个节点 $v$ 的中介中心性 $C_B(v)$。节点为 $v_1$、$v_2$ 和 $v_3$。代表有效路径长度的边权重分别为 $w(v_1, v_2) = 4$，$w(v_1, v_3) = 2$ 和 $w(v_2, v_3) = 2$。\n\n节点 $v$ 的中介中心性定义为所有节点对之间通过 $v$ 的最短路径所占比例的总和。对于无向图中的未归一化中心性，其公式为：\n$$C_B(v) = \\sum_{s \\neq v \\neq t} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}$$\n其中，总和是针对所有不包含 $v$ 的不同无序节点对 $\\{s,t\\}$。这里，$\\sigma_{st}$ 是节点 $s$ 和 $t$ 之间的最短路径（测地线）总数，而 $\\sigma_{st}(v)$ 是这些最短路径中通过节点 $v$ 的数量。\n\n为了计算每个节点的中心性，我们必须首先确定图中所有节点对之间的所有最短路径。该图有 $\\binom{3}{2} = 3$ 对节点：$\\{v_1, v_2\\}$、$\\{v_1, v_3\\}$ 和 $\\{v_2, v_3\\}$。\n\n1.  **$v_1$ 和 $v_2$ 之间的最短路径：**\n    $v_1$ 和 $v_2$ 之间有两条可能的路径：\n    *   直接路径 $(v_1, v_2)$ 的长度等于其权重，即 $w(v_1, v_2) = 4$。\n    *   通过 $v_3$ 的间接路径，即 $(v_1, v_3, v_2)$，总长度为 $w(v_1, v_3) + w(v_3, v_2) = 2 + 2 = 4$。\n    由于两条路径具有相同的最小长度 $4$，因此 $v_1$ 和 $v_2$ 之间有两条最短路径。因此，$\\sigma_{v_1, v_2} = 2$。\n\n2.  **$v_1$ 和 $v_3$ 之间的最短路径：**\n    $v_1$ 和 $v_3$ 之间有两条可能的路径：\n    *   直接路径 $(v_1, v_3)$ 的长度为 $w(v_1, v_3) = 2$。\n    *   通过 $v_2$ 的间接路径，即 $(v_1, v_2, v_3)$，总长度为 $w(v_1, v_2) + w(v_2, v_3) = 4 + 2 = 6$。\n    最小长度的路径是直接路径。因此，$v_1$ 和 $v_3$ 之间只有一条最短路径。因此，$\\sigma_{v_1, v_3} = 1$。\n\n3.  **$v_2$ 和 $v_3$ 之间的最短路径：**\n    $v_2$ 和 $v_3$ 之间有两条可能的路径：\n    *   直接路径 $(v_2, v_3)$ 的长度为 $w(v_2, v_3) = 2$。\n    *   通过 $v_1$ 的间接路径，即 $(v_2, v_1, v_3)$，总长度为 $w(v_2, v_1) + w(v_1, v_3) = 4 + 2 = 6$。\n    最小长度的路径是直接路径。因此，$v_2$ 和 $v_3$ 之间只有一条最短路径。因此，$\\sigma_{v_2, v_3} = 1$。\n\n现在，我们可以计算每个节点的中介中心性。\n\n**$v_1$ 的中介中心性 $C_B(v_1)$：**\n节点 $v_1$ 只能作为 $v_2$ 和 $v_3$ 之间路径的中间节点。对 $C_B(v_1)$ 的贡献为 $\\frac{\\sigma_{v_2, v_3}(v_1)}{\\sigma_{v_2, v_3}}$。\n我们发现 $v_2$ 和 $v_3$ 之间只有一条最短路径，即直接边 $(v_2, v_3)$。这条路径不经过 $v_1$。\n因此，$\\sigma_{v_2, v_3}(v_1) = 0$。\n贡献为 $\\frac{0}{1} = 0$。\n所以，$C_B(v_1) = 0$。\n\n**$v_2$ 的中介中心性 $C_B(v_2)$：**\n节点 $v_2$ 只能作为 $v_1$ 和 $v_3$ 之间路径的中间节点。对 $C_B(v_2)$ 的贡献为 $\\frac{\\sigma_{v_1, v_3}(v_2)}{\\sigma_{v_1, v_3}}$。\n我们发现 $v_1$ 和 $v_3$ 之间只有一条最短路径，即直接边 $(v_1, v_3)$。这条路径不经过 $v_2$。\n因此，$\\sigma_{v_1, v_3}(v_2) = 0$。\n贡献为 $\\frac{0}{1} = 0$。\n所以，$C_B(v_2) = 0$。\n\n**$v_3$ 的中介中心性 $C_B(v_3)$：**\n节点 $v_3$ 只能作为 $v_1$ 和 $v_2$ 之间路径的中间节点。对 $C_B(v_3)$ 的贡献为 $\\frac{\\sigma_{v_1, v_2}(v_3)}{\\sigma_{v_1, v_2}}$。\n我们发现 $v_1$ 和 $v_2$ 之间有两条最短路径：直接路径 $(v_1, v_2)$ 和间接路径 $(v_1, v_3, v_2)$。\n在这两条路径中，只有路径 $(v_1, v_3, v_2)$ 经过 $v_3$。\n因此，通过 $v_3$ 的最短路径数量为 $\\sigma_{v_1, v_2}(v_3) = 1$。\n最短路径的总数为 $\\sigma_{v_1, v_2} = 2$。\n贡献为 $\\frac{1}{2}$。\n所以，$C_B(v_3) = \\frac{1}{2}$。\n\n此计算说明了最短路径中存在“平局”情况的影响。当源-目标对之间存在多条测地线时，一个仅位于这些路径子集上的中间节点会获得一个分数贡献，与它位于所有最短路径上的情况相比，该贡献被稀释了。在这里，$v_3$ 只位于 $v_1$ 和 $v_2$ 之间的两条最短路径中的一条上，因此它从这对节点获得的中介性贡献是 $\\frac{1}{2}$ 而不是 $1$。\n\n中介中心性的最终结果是：\n$C_B(v_1) = 0$\n$C_B(v_2) = 0$\n$C_B(v_3) = \\frac{1}{2}$\n\n按指定顺序 $(v_1, v_2, v_3)$ 将其表示为行向量，得到 $\\begin{pmatrix} 0  0  \\frac{1}{2} \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3294601"}]}