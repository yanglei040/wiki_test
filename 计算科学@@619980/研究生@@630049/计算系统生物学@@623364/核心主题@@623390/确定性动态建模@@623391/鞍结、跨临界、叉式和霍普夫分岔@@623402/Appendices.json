{"hands_on_practices": [{"introduction": "我们首先剖析一种基本的分岔类型：跨临界分岔。这个练习旨在磨练寻找系统平衡点并通过线性化评估其稳定性的核心技能，展示当一个控制参数改变时，稳定性如何在不同状态间交换。掌握这种分析方法 [@problem_id:3347442] 是理解更复杂系统变化的关键第一步。", "problem": "在计算系统生物学中，一个单物种调控模块的简化范式模型里，相互作用阈值附近的浓度动力学由以下一维常微分方程（ODE）建模：\n$$\n\\dot{x} = \\mu x - x^{2},\n$$\n其中，$x$ 是无量纲浓度，$\\mu$ 是一个代表净有效输入的实值控制参数。\n\n仅使用动力系统理论的基础定义，按以下步骤进行：\n- 通过求解 $\\dot{x}=0$ 时的 $x$ 来确定所有作为 $\\mu$ 函数的平衡点。\n- 对于每个平衡点以及当 $\\mu \\neq 0$ 时，通过在平衡点附近线性化该常微分方程，并利用雅可比矩阵（向量场对 $x$ 的导数）所得特征值的符号来评估其局部稳定性。\n- 证明在 $\\mu=0$ 处，平衡分支之间发生了稳定性交换。\n\n最后，定义诊断乘积\n$$\nP(\\mu) = \\lambda_{1}(\\mu)\\,\\lambda_{2}(\\mu),\n$$\n其中 $\\lambda_{1}(\\mu)$ 和 $\\lambda_{2}(\\mu)$ 是在 $\\mu \\neq 0$ 时，于两个不同平衡点处求得的一维雅可比矩阵（即方程右侧对 $x$ 的导数）的特征值。以 $\\mu$ 的函数形式，计算 $P(\\mu)$ 的精确闭式解。将您的最终答案表示为关于 $\\mu$ 的单个解析表达式。", "solution": "该问题提出了一个由下式给出的一维常微分方程（ODE）：\n$$\n\\dot{x} = \\mu x - x^{2},\n$$\n其中 $x$ 代表无量纲浓度，$\\mu$ 是一个实值控制参数。设该常微分方程的右侧为函数 $f(x, \\mu) = \\mu x - x^{2}$。\n\n首先，我们通过求解变化率 $\\dot{x}$ 为零时的 $x$ 值（记为 $x^*$）来确定系统的平衡点（或不动点）。\n$$\n\\dot{x} = f(x^*, \\mu) = 0\n$$\n$$\n\\mu x^* - (x^*)^{2} = 0\n$$\n对表达式进行因式分解，我们得到：\n$$\nx^*(\\mu - x^*) = 0\n$$\n该方程产生两个平衡解，它们是参数 $\\mu$ 的函数：\n1. 平凡平衡点：$x_1^* = 0$。\n2. 非平凡平衡点：$x_2^* = \\mu$。\n对于所有 $\\mu \\neq 0$ 的情况，这两个平衡点是不同的。它们在分岔点 $\\mu=0$ 处重合。\n\n接下来，我们评估每个平衡点在 $\\mu \\neq 0$ 时的局部稳定性。平衡点 $x^*$ 的局部稳定性由系统在 $x^*$ 处求值的雅可比矩阵的特征值的符号决定。对于一维系统，雅可比矩阵是一个 $1 \\times 1$ 的矩阵，其唯一的分量是 $f(x, \\mu)$ 对 $x$ 的导数。因此，特征值 $\\lambda$ 就是这个导数。\n$$\nJ(x) = \\frac{df}{dx} = \\frac{d}{dx}(\\mu x - x^{2}) = \\mu - 2x\n$$\n在平衡点 $x^*$ 处的特征值由 $\\lambda(x^*) = J(x^*) = \\mu - 2x^*$ 给出。如果 $\\lambda  0$，平衡点是局部稳定的；如果 $\\lambda > 0$，平衡点是局部不稳定的。如果 $\\lambda = 0$，平衡点是非双曲的，线性稳定性分析无法得出结论。\n\n现在我们为两个平衡分支中的每一个计算特征值。\n\n对于第一个平衡点 $x_1^* = 0$，其对应的特征值（我们记为 $\\lambda_1(\\mu)$）是：\n$$\n\\lambda_1(\\mu) = J(x_1^*) = J(0) = \\mu - 2(0) = \\mu\n$$\n该平衡点的稳定性取决于 $\\mu$ 的符号：\n- 如果 $\\mu  0$，则 $\\lambda_1(\\mu)  0$，平衡点 $x_1^* = 0$ 是稳定的。\n- 如果 $\\mu > 0$，则 $\\lambda_1(\\mu) > 0$，平衡点 $x_1^* = 0$ 是不稳定的。\n\n对于第二个平衡点 $x_2^* = \\mu$，其对应的特征值（记为 $\\lambda_2(\\mu)$）是：\n$$\n\\lambda_2(\\mu) = J(x_2^*) = J(\\mu) = \\mu - 2(\\mu) = -\\mu\n$$\n该平衡点的稳定性也取决于 $\\mu$ 的符号：\n- 如果 $\\mu  0$，则 $\\lambda_2(\\mu) > 0$，平衡点 $x_2^* = \\mu$ 是不稳定的。\n- 如果 $\\mu > 0$，则 $\\lambda_2(\\mu)  0$，平衡点 $x_2^* = \\mu$ 是稳定的。\n\n在 $\\mu=0$ 处，两个平衡分支之间发生了稳定性交换。在这个特定的参数值下，两个平衡点重合（$x_1^* = x_2^* = 0$），并且两个特征值都变为零（$\\lambda_1(0) = 0$ 和 $\\lambda_2(0) = 0$）。当参数 $\\mu$ 穿过 $0$ 变化时，两个分支的稳定性互换。具体来说，当 $\\mu$ 从负值增加到正值时：\n- 分支 $x_1^*=0$ 从稳定变为不稳定。\n- 分支 $x_2^*=\\mu$ 从不稳定变为稳定。\n这一现象是跨临界分岔的典型特征。\n\n最后，我们计算诊断乘积 $P(\\mu)$，其定义为在 $\\mu \\neq 0$ 时，于两个不同平衡点处求得的特征值的乘积。使用我们推导出的特征值 $\\lambda_1(\\mu)$ 和 $\\lambda_2(\\mu)$ 的表达式：\n$$\nP(\\mu) = \\lambda_1(\\mu) \\cdot \\lambda_2(\\mu)\n$$\n代入特征值的表达式：\n$$\nP(\\mu) = (\\mu) \\cdot (-\\mu)\n$$\n$$\nP(\\mu) = -\\mu^{2}\n$$\n这就是所要求的乘积 $P(\\mu)$ 作为 $\\mu$ 的函数的闭式表达式。", "answer": "$$\n\\boxed{-\\mu^{2}}\n$$", "id": "3347442"}, {"introduction": "在超越了平衡点的简单变化之后，我们现在将通过霍普夫分岔来探索振荡的产生。通过在极坐标下分析系统的范式，我们可以直接推导出稳定极限环出现的条件，这一现象是建立生物钟和节律模型的中心。这个练习 [@problem_id:3347394] 为理解动力系统中持续振荡如何产生提供了一个清晰的分析窗口。", "problem": "考虑一个源于生化反馈网络在霍普夫分岔附近中心流形上的降维描述的二维振子模型。在极坐标下，该降维系统由以下范式给出\n$$\n\\dot{r} = \\mu\\, r - r^{3}, \\qquad \\dot{\\theta} = \\omega,\n$$\n其中 $r$ 是振荡振幅，$\\theta$ 是以弧度为单位的相角，$\\mu$ 是分岔参数（平滑地依赖于一个潜在的生化控制参数），$\\omega$ 是自然振荡频率。使用自治常微分方程（ODE）系统中极限环的定义（状态空间中的一条闭合孤立轨道）以及通过振幅方程平衡点的一维线性化特征值的符号判断线性稳定性，推导当 $\\mu>0$ 时非平凡振荡（极限环）的存在性与稳定性，并解释这如何对应于原始二维系统中的超临界霍普夫分岔。请提供稳定极限环振幅 $r^{\\ast}$ 作为 $\\mu$ 的函数的闭式解析表达式作为您的最终答案。无需数值近似。", "solution": "给定系统是在中心流形上用极坐标表示的霍普夫分岔附近动力学的范式。相位动力学 $\\dot{\\theta}=\\omega$ 是解耦且恒定的，因此振荡的存在性与稳定性完全由振幅动力学 $\\dot{r}=\\mu r - r^{3}$ 决定。\n\n我们从平面自治常微分方程中极限环的定义开始：一条闭合的孤立轨道，附近的轨道可能向其收敛（稳定）或从其发散（不稳定）。在旋转对称范式的极坐标中，极限环对应于一个恒定振幅解 $r(t)\\equiv r^{\\ast}$，其中 $\\theta$ 均匀旋转，因此只需找到振幅方程的非零平衡点并评估其稳定性。\n\n考虑振幅常微分方程：\n$$\n\\dot{r} = f(r) = \\mu r - r^{3}.\n$$\n$r$ 的平衡点满足 $f(r)=0$。因式分解得到\n$$\nf(r) = r\\left(\\mu - r^{2}\\right).\n$$\n因此平衡点为\n$$\nr_{0}=0, \\qquad r_{\\pm}=\\pm\\sqrt{\\mu}.\n$$\n因为 $r$ 是一个振幅，所以对于 $\\mu>0$ 的情况，物理上相关的分支是 $r^{\\ast}=\\sqrt{\\mu}$。对于 $\\mu0$ 的情况，$\\pm\\sqrt{\\mu}$ 不是实数，所以唯一的实数平衡点是 $r=0$。\n\n为了确定这些平衡点在一维振幅方程中的稳定性，我们在每个平衡点处对 $f(r)$ 进行线性化，方法是计算其导数：\n$$\nf'(r) = \\mu - 3 r^{2}.\n$$\n在 $r=0$ 处，\n$$\nf'(0) = \\mu.\n$$\n因此，对于 $\\mu>0$，$f'(0)>0$，这意味着 $r=0$ 是振幅动力学的一个不稳定平衡点；$r$ 值较小的轨道会远离零点增加。对于 $\\mu0$，$f'(0)0$，所以 $r=0$ 是稳定的。\n\n在 $r^{\\ast}=\\sqrt{\\mu}$ 处（假设 $\\mu>0$，因此 $r^{\\ast}$ 是正实数），\n$$\nf'\\!\\left(r^{\\ast}\\right) = \\mu - 3\\left(\\sqrt{\\mu}\\right)^{2} = \\mu - 3\\mu = -2\\mu  0.\n$$\n因此，对于 $\\mu>0$，非平凡平衡点 $r^{\\ast}=\\sqrt{\\mu}$ 是线性稳定的。在完整的二维动力学中，这对应于一个稳定的周期性轨道（极限环），其在极坐标下的半径为 $r^{\\ast}=\\sqrt{\\mu}$，角速度恒为 $\\dot{\\theta}=\\omega$。\n\n我们现在对 $\\mu=0$ 处的霍普夫分岔进行分类。当平面系统线性化的一对共轭复特征值穿过虚轴时，霍普夫分岔发生，从而产生振荡。在范式振幅方程中，霍普夫分岔的性质（超临界或亚临界）由控制振幅饱和的主导非线性项的符号决定。具体来说，在振幅方程\n$$\n\\dot{r} = \\mu r - r^{3},\n$$\n中，$r^{3}$ 项的三次项系数为负（系数为-1），这意味着非线性饱和会抑制振幅的增长。当 $\\mu$ 穿过零点并增加时，$r=0$ 处的平衡点失去稳定性（$f'(0)=\\mu$ 的符号由负变正），对于 $\\mu>0$，一个振幅为 $r^{\\ast}=\\sqrt{\\mu}$ 的稳定小振幅极限环分支诞生了。这就是超临界霍普夫分岔的定义性特征：当参数通过临界值时，不动点变得不稳定，同时出现一个稳定的极限环。\n\n因此，存在条件是 $\\mu>0$，稳定极限环的振幅是 $r^{\\ast}=\\sqrt{\\mu}$，并且由于负的三次非线性以及新出现的环的稳定性，该霍普夫分岔是超临界的。\n\n所要求的最终结果是闭式振幅：\n$$\nr^{\\ast} = \\sqrt{\\mu}.\n$$", "answer": "$$\\boxed{\\sqrt{\\mu}}$$", "id": "3347394"}, {"introduction": "真实的生物系统通常面临随时间变化的输入，这种复杂性是静态参数分析无法捕捉的。本计算练习将研究当参数扫过鞍结分岔点时所产生的动态后果，揭示分岔延迟或动态磁滞现象。通过实施数值模拟 [@problem_id:3347406]，你将量化系统响应如何滞后于变化的输入，这是理解基因调控及其他过程中速率依赖性临界点的关键概念。", "problem": "考虑用于模拟时变输入下基因阈值诱导的鞍结分岔的典型一维范式，由常微分方程 $\\dot{x} = \\mu(t) + x^2$ 和线性斜坡 $\\mu(t) = \\nu t$ 给出，其中 $\\nu > 0$ 是扫描速率。对于 $t  0$，存在一个稳定的平衡分支 $x(t) = -\\sqrt{-\\mu(t)}$，该分支在 $t = 0$ 时消失。当系统扫过分岔点时，动态滞后（分岔延迟）可能导致系统在跃迁到大的 $x$ 正值之前出现有限的延迟。\n\n从常微分方程、平衡点稳定性以及动力系统中时变参数扫描等基本概念出发，实现一个数值程序，以量化由 $\\dot{x} = \\nu t + x^2$ 建模的基因诱导过程中的动态分岔延迟及其与扫描速率 $\\nu$ 的标度关系。请遵循以下要求进行操作：\n\n- 全程使用无量纲变量；无需物理单位。\n- 在瞬时稳定分支上，于时间 $t_0 = s_0 \\nu^{-1/3}$（其中 $s_0 = -8$）处初始化系统，初值为 $x(t_0) = -\\sqrt{-\\mu(t_0)} = -\\sqrt{-\\nu t_0}$。\n- 向前积分至时间 $t_{\\max} = s_{\\max} \\nu^{-1/3}$（其中 $s_{\\max} = 20$）。\n- 将逃逸时间 $t_{\\mathrm{esc}}$ 定义为 $x(t)$ 从下方达到诱导阈值 $x_{\\mathrm{th}} = 5$ 的第一个时间 $t \\ge 0$。控制参数的动态延迟为 $\\mu_{\\mathrm{esc}} = \\nu t_{\\mathrm{esc}}$。\n- 对于每个测试用例，计算归一化延迟比 $r = \\mu_{\\mathrm{esc}} / \\nu^{2/3}$。\n\n您的程序必须使用带有事件检测的稳健方法对常微分方程进行数值积分，以找到 $t_{\\mathrm{esc}}$。最终输出应为所提供测试套件的比率 $r$ 的列表，每个值四舍五入到六位小数。\n\n测试套件：\n- 情况 1: $\\nu = 1.0$。\n- 情况 2: $\\nu = 0.3$。\n- 情况 3: $\\nu = 0.1$。\n- 情况 4: $\\nu = 0.01$。\n- 情况 5: $\\nu = 0.001$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$）。每个 $r_i$ 必须是四舍五入到六位小数的浮点数。如果在任何情况下，系统在积分窗口内未达到逃逸阈值，则该情况返回字符串字面量 `nan` 以代替数值。", "solution": "该问题要求对一个由具有时变控制参数的鞍结分岔的典型范式所描述的系统，进行归一化动态延迟的数值计算。分析将通过使用具有事件检测功能的稳健数值积分器直接求解所给的常微分方程（ODE）来进行。\n\n系统状态变量 $x$ 的控制方程是一个非自治一阶常微分方程：\n$$\n\\frac{dx}{dt} = \\nu t + x^2\n$$\n其中 $\\nu > 0$ 是控制参数 $\\mu(t) = \\nu t$ 的扫描速率。\n\n问题指定了一组初始条件、一个积分窗口和一个“逃逸”条件，所有这些都与扫描速率 $\\nu$ 存在标度关系。这些定义如下：\n\n1.  **初始时间 $t_0$**：积分始于 $t_0 = s_0 \\nu^{-1/3}$，其中给定的无量纲常数 $s_0 = -8$。\n2.  **初始状态 $x(t_0)$**：系统在准静态稳定平衡分支上初始化。对于 $t0$，瞬时平衡点为 $x_{eq}(t) = \\pm\\sqrt{-\\mu(t)} = \\pm\\sqrt{-\\nu t}$。稳定分支是 $x_{stable}(t) = -\\sqrt{-\\nu t}$。因此，初始状态为 $x(t_0) = -\\sqrt{-\\nu t_0}$。代入 $t_0$ 的表达式，我们得到：$$x(t_0) = -\\sqrt{-\\nu (-8 \\nu^{-1/3})} = -\\sqrt{8 \\nu^{2/3}}$$\n3.  **终止时间 $t_{\\max}$**：积分进行到最大时间 $t_{\\max} = s_{\\max} \\nu^{-1/3}$，其中 $s_{\\max} = 20$。\n4.  **逃逸条件**：逃逸时间 $t_{\\mathrm{esc}}$ 被定义为状态变量 $x(t)$ 达到诱导阈值 $x_{\\mathrm{th}} = 5$ 的第一个时间 $t \\ge 0$。\n\n目标是计算多个 $\\nu$ 值对应的归一化延迟比 $r$。该比率定义为：\n$$\nr = \\frac{\\mu_{\\mathrm{esc}}}{\\nu^{2/3}}\n$$\n其中 $\\mu_{\\mathrm{esc}} = \\nu t_{\\mathrm{esc}}$ 是逃逸时刻控制参数的值。结合这些定义，目标量为：\n$$\nr = \\frac{\\nu t_{\\mathrm{esc}}}{\\nu^{2/3}} = \\nu^{1/3} t_{\\mathrm{esc}}\n$$\n\n针对每个给定的 $\\nu$ 值，解决此问题的数值步骤如下：\n\n1.  **建立初值问题（IVP）**：对于给定的 $\\nu$，计算具体的初始时间 $t_0$、初始状态 $x_0 = x(t_0)$ 以及积分时间区间 $[t_0, t_{\\max}]$。\n2.  **定义 ODE 和事件函数**：ODE 函数为 $f(t, x) = \\nu t + x^2$。标记逃逸的事件由条件 $x(t) - x_{\\mathrm{th}} = 0$ 定义。\n3.  **带事件检测的数值积分**：`scipy.integrate.solve_ivp` 函数非常适合此任务。它可以在从 $t_0$ 到 $t_{\\max}$ 积分 ODE 的同时，找到给定事件函数的根。\n    - 我们将事件配置为终止事件（`terminal=True`），这会指示求解器在检测到事件后立即停止积分。这可以提高效率。\n    - 我们指定穿越方向（`direction=1`），以确保事件仅在 $x(t)$ 从下方穿越阈值 $x_{\\mathrm{th}}$ 时触发，这符合问题的物理要求（从下方逃逸）。\n    - 为确保高精度，特别是考虑到标度分析，求解器的绝对和相对容差（`atol` 和 `rtol`）被设置为 $10^{-9}$ 的严格值。\n4.  **提取和处理结果**：积分后，我们检查求解器的输出。\n    - `sol.t_events` 属性将包含一个时间点数组，这些时间点满足事件条件。\n    - 我们必须筛选这些事件时间，以找到满足条件 $t \\ge 0$ 的第一个时间，即为 $t_{\\mathrm{esc}}$。\n    - 如果存在一个或多个这样的时间，我们取第一个，计算 $r = \\nu^{1/3} t_{\\mathrm{esc}}$，并将其四舍五入到六位小数。\n    - 如果 `sol.t_events` 数组为空或仅包含负数时间，则意味着在积分窗口内对于 $t \\ge 0$ 未达到阈值。在这种情况下，结果记录为字符串字面量 `nan`。\n5.  **迭代和报告**：对所提供测试套件中的每个 $\\nu$ 值重复此过程。最终结果被收集到一个列表中，并格式化为所需的单行字符串输出。\n\n该方法提供了一个直接且稳健的数值解法，忠实地实现了问题陈述中描述的条件。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Numerically solves for the dynamic bifurcation delay in a gene induction model.\n    The model is dx/dt = nu*t + x^2. The function calculates a normalized lag ratio\n    for a series of sweep rates (nu).\n    \"\"\"\n\n    # Test cases for the sweep rate nu\n    test_cases = [1.0, 0.3, 0.1, 0.01, 0.001]\n    \n    results = []\n\n    for nu in test_cases:\n        # Define problem-specific constants and dimensionless parameters\n        s0 = -8.0\n        s_max = 20.0\n        x_th = 5.0\n\n        # Calculate initial and final times based on nu\n        nu_pow_neg_1_3 = nu**(-1.0/3.0)\n        t0 = s0 * nu_pow_neg_1_3\n        t_max = s_max * nu_pow_neg_1_3\n\n        # Calculate the initial state x(t0) on the stable branch\n        # x(t0) = -sqrt(-nu * t0)\n        x0 = -np.sqrt(-nu * t0)\n\n        # Define the ordinary differential equation dx/dt = f(t, x)\n        def ode_func(t, x):\n            # x is a 1-element array, so we access x[0]\n            return nu * t + x[0]**2\n\n        # Define the event function to detect threshold crossing\n        # The event occurs when this function is zero.\n        def escape_event(t, x):\n            return x[0] - x_th\n        \n        # Stop integration when the event occurs\n        escape_event.terminal = True\n        # Trigger event only when x is increasing (crossing from below)\n        escape_event.direction = 1\n\n        # Integrate the ODE using a high-precision solver (RK45) with event detection\n        sol = solve_ivp(\n            fun=ode_func,\n            t_span=[t0, t_max],\n            y0=[x0],\n            events=escape_event,\n            dense_output=True,\n            atol=1e-9,  # Stricter tolerances for higher accuracy\n            rtol=1e-9\n        )\n\n        # Process the results from the solver\n        if sol.t_events[0].size  0:\n            # An event was detected. Find the first event time t = 0.\n            event_times = sol.t_events[0]\n            valid_escape_times = event_times[event_times = 0]\n\n            if valid_escape_times.size  0:\n                t_esc = valid_escape_times[0]\n                \n                # Calculate the control parameter lag mu_esc\n                mu_esc = nu * t_esc\n                \n                # Calculate the normalized lag ratio r\n                r = mu_esc / nu**(2.0/3.0)\n                \n                # Append the formatted result\n                results.append(f\"{r:.6f}\")\n            else:\n                # Event occurred, but only for t  0. Per problem, this is not an escape.\n                results.append(\"nan\")\n        else:\n            # No event was detected within the integration interval [t0, t_max].\n            results.append(\"nan\")\n    \n    # Print the final list of results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3347406"}]}