{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的练习开始：分析一个简单的负反馈回路的稳态行为。这个练习旨在通过求解一个描述蛋白质浓度动态变化的常微分方程，来确定其平衡点 [@problem_id:3345716]。通过这个过程，你将掌握如何从数学上描述生产速率和降解速率之间的平衡，这是理解任何调控网络如何维持其稳态的基础。", "problem": "考虑一个单基因负自调控回路，其中蛋白质浓度 $x(t)$ 遵循常微分方程 (ODE) $$\\frac{dx}{dt}=\\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}-\\beta x,$$ 其中 $\\alpha>0$ 是最大合成速率，$K>0$ 是一个类解离阈值，$n>0$ 是捕捉抑制作用有效协同性的希尔系数，$\\beta>0$ 是一个综合了稀释和降解的一级损失速率常数。从稳态的定义以及稳态等同于产生和损失通量的标准生物化学解释出发，推导稳态浓度 $x^{\\ast}$ 的稳态条件，并将其简化为一个方程，该方程的解对应于稳态浓度。在不援引初等实分析之外任何专门定理的情况下，分析生物学相关稳态 $x^{\\ast}>0$ 作为参数 $n$, $K$, $\\alpha$ 和 $\\beta$ 的函数的存在性和唯一性。明确陈述保证存在性和唯一性的参数条件，并指出在哪些参数范围（包括符号或极限值）下，如果放宽假设，存在性可能不成立或原则上可能出现多重解。最后，将问题特化到非协同情况 $n=1$，并以 $\\alpha$、$\\beta$ 和 $K$ 的函数形式，显式求解唯一的正稳态 $x^{\\ast}$ 的闭合解。在 $n=1$ 且 $\\alpha>0$, $\\beta>0$, $K>0$ 的情况下，以单一简化的解析表达式给出 $x^{\\ast}$ 的最终答案。最终表达式无需四舍五入，也无需单位。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：蛋白质浓度 $x(t)$ 由常微分方程 (ODE) $\\frac{dx}{dt}=\\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}-\\beta x$ 描述。\n- **参数与约束**：\n    - $\\alpha > 0$：最大合成速率。\n    - $K > 0$：类解离阈值。\n    - $n > 0$：希尔系数。\n    - $\\beta > 0$：一级损失速率常数。\n- **任务**：\n    1. 推导稳态浓度 $x^{\\ast}$ 的稳态条件。\n    2. 将此条件简化为代数方程。\n    3. 对于一般参数，分析生物学相关稳态 $x^{\\ast} > 0$ 的存在性和唯一性。\n    4. 陈述存在性和唯一性的条件。\n    5. 指出在假设放宽的情况下，唯一性可能不成立的区域。\n    6. 对于 $n=1$ 的特殊情况，显式求解唯一的正稳态 $x^{\\ast}$ 作为 $\\alpha$、$\\beta$ 和 $K$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学或事实合理性**：该问题在科学上是合理的。所提供的常微分方程是负向基因自调控的一个经典模型，基于由希尔函数推广的类米氏动力学。这是系统生物学和生物化学工程中的一个标准和基础模型。所有参数都具有明确定义的标准物理意义。\n- **适定性**：该问题是适定的。它要求分析给定常微分方程的稳态，这是动力系统理论中的标准程序。问题引导分析走向存在性和唯一性，这是研究此类系统的核心。\n- **客观性**：语言完全是数学化的和客观的。\n- **完备性与一致性**：该问题是自洽的。它提供了控制方程并定义了所有参数及其约束（$\\alpha>0, \\beta>0, K>0, n>0$）。没有矛盾之处。\n- **现实性**：该模型是一个被广泛接受的生物过程的理想化模型。参数约束在物理上是现实的。\n- **结构与清晰度**：问题结构清晰，术语明确。\n\n### 步骤 3：结论与行动\n该问题有效。这是一个数学化生物学中的标准、适定问题。我将继续进行求解。\n\n### 稳态条件的推导\n动力系统的稳态是指系统变量不随时间变化的状态。对于蛋白质浓度 $x(t)$，这个条件在数学上表示为 $\\frac{dx}{dt} = 0$。令 $x^{\\ast}$ 表示稳态浓度。将此代入给定的常微分方程，得到：\n$$\n\\frac{dx}{dt}\\bigg|_{x=x^{\\ast}} = 0 = \\frac{\\alpha}{1+\\left(\\frac{x^{\\ast}}{K}\\right)^{n}}-\\beta x^{\\ast}\n$$\n这个方程可以重新整理为\n$$\n\\frac{\\alpha}{1+\\left(\\frac{x^{\\ast}}{K}\\right)^{n}} = \\beta x^{\\ast}\n$$\n这就是稳态条件。它将蛋白质的合成速率（左侧，一个递减的希尔函数）与蛋白质的损失速率（右侧，一个线性函数）相等同。这与稳态是产生和损失通量之间平衡的生物化学解释完全一致。这个代数方程的解对应于系统的稳态浓度。\n\n### 正稳态存在性与唯一性的分析\n为了分析生物学相关稳态 $x^{\\ast} > 0$ 的存在性和唯一性，我们分析当 $x \\ge 0$ 时两个函数的交点：产生速率函数 $P(x) = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}$ 和损失速率函数 $L(x) = \\beta x$。\n\n我们来考察当 $x \\ge 0$ 时这两个函数的性质：\n1.  **产生速率, $P(x)$**：\n    - 在 $x=0$ 时，产生速率最大：$P(0) = \\frac{\\alpha}{1+0} = \\alpha$。由于 $\\alpha > 0$，$P(0)$ 为正。\n    - 当 $x \\to \\infty$ 时，项 $(\\frac{x}{K})^n \\to \\infty$（因为 $n>0, K>0$），所以 $P(x) \\to 0$。\n    - 对于 $x > 0$，函数 $P(x)$ 是严格单调递减的。其导数为 $P'(x) = \\frac{d}{dx}\\left[\\alpha\\left(1+\\left(\\frac{x}{K}\\right)^{n}\\right)^{-1}\\right] = -\\alpha\\left(1+\\left(\\frac{x}{K}\\right)^{n}\\right)^{-2} \\left(\\frac{nx^{n-1}}{K^n}\\right)$。由于所有参数 $\\alpha, n, K$ 均为正，且对于 $x>0$，我们有 $P'(x)  0$。\n\n2.  **损失速率, $L(x)$**：\n    - 在 $x=0$ 时，损失速率为 $L(0) = 0$。\n    - 函数 $L(x)$ 是一条穿过原点、斜率为正常数 $\\beta$ 的直线。\n\n为了找到稳态，我们需求解 $P(x) = L(x)$。我们定义一个新函数 $f(x) = P(x) - L(x) = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}} - \\beta x$。我们正在寻找当 $x  0$ 时 $f(x)=0$ 的根。\n\n- **存在性**：在 $x=0$ 处，我们有 $f(0) = P(0) - L(0) = \\alpha - 0 = \\alpha  0$。当 $x \\to \\infty$ 时，$P(x) \\to 0$ 且 $L(x) \\to \\infty$，因此 $f(x) \\to -\\infty$。由于 $f(x)$ 在 $x \\ge 0$ 上是连续函数，并且它的符号从 $x=0$ 处的正值变为大 $x$ 处的负值，根据介值定理，必然存在至少一个根 $x^{\\ast}  0$。因此，在给定的参数约束下，总存在一个正稳态。\n\n- **唯一性**：为了确立唯一性，我们考察 $f(x)$ 的导数：\n$$\nf'(x) = P'(x) - L'(x) = -\\frac{\\alpha n x^{n-1}}{K^n \\left(1+\\left(\\frac{x}{K}\\right)^{n}\\right)^2} - \\beta\n$$\n对于所有 $x \\ge 0$ 和给定的约束 $\\alpha0, \\beta0, K0, n0$，$f'(x)$ 表达式中的两项都是非正的。第一项在 $x=0$ 时为零（对于 $n1$）或趋近于一个有限负值（对于 $n=1$），并且对于 $x0$ 是严格为负的。第二项 $-\\beta$ 是一个严格为负的常数。因此，对于所有 $x \\ge 0$，$f'(x)  0$。\n一个连续且导数严格为负的函数是严格单调递减的。一个严格单调的函数与任何给定的水平线（在这里是 $x$ 轴，即 $f(x)=0$）最多相交一次。\n既然我们已经证明了至少存在一个根，现在又证明了最多只能存在一个根，我们得出结论：存在一个唯一的正稳态 $x^{\\ast}  0$。\n\n对于所有正的参数值：$\\alpha0, \\beta0, K0, n0$，这个存在性和唯一性都是有保证的。不需要任何进一步的条件。\n\n关于可能出现多重解的参数区域：对于所提供的负自调控特定数学模型 $\\frac{dx}{dt} = P(x) - L(x)$，其中 $P(x)$ 是单调递减的，$L(x)$ 是单调递增的，因此不可能存在多个稳态。函数 $f(x)=P(x)-L(x)$ 是严格递减的，保证了根的唯一性。多个稳态（双稳态）通常需要一个非单调的产生函数，这通常源于正反馈回路或协同激活基序，而不是如此处模型所示的简单负反馈。因此，在模型的既定假设下，没有任何参数区域会导致多个稳态。\n\n### 非协同情况（$n=1$）的显式解\n我们现在特化到 $n=1$ 的情况。稳态方程变为：\n$$\n\\frac{\\alpha}{1+\\frac{x^{\\ast}}{K}} = \\beta x^{\\ast}\n$$\n我们求解 $x^{\\ast}  0$。重新整理方程：\n$$\n\\alpha = \\beta x^{\\ast} \\left(1 + \\frac{x^{\\ast}}{K}\\right)\n$$\n$$\n\\alpha = \\beta x^{\\ast} + \\frac{\\beta}{K} (x^{\\ast})^2\n$$\n这是一个关于 $x^{\\ast}$ 的二次方程。我们将其写成标准形式 $ax^2 + bx + c = 0$：\n$$\n\\frac{\\beta}{K} (x^{\\ast})^2 + \\beta x^{\\ast} - \\alpha = 0\n$$\n我们使用二次方程求根公式 $x^{\\ast} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中系数为 $a = \\frac{\\beta}{K}$，$b = \\beta$，$c = -\\alpha$。\n$$\nx^{\\ast} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 - 4\\left(\\frac{\\beta}{K}\\right)(-\\alpha)}}{2\\left(\\frac{\\beta}{K}\\right)}\n$$\n$$\nx^{\\ast} = \\frac{-\\beta \\pm \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}}\n$$\n由于 $\\alpha$、$\\beta$ 和 $K$ 均为正值，判别式 $\\beta^2 + \\frac{4\\alpha\\beta}{K}$ 严格为正，确保了两个不同的实数解。我们需要一个生物学上相关的解，即 $x^{\\ast}0$。\n平方根下的项为 $\\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}  \\sqrt{\\beta^2} = |\\beta|$。由于 $\\beta0$，因此有 $\\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}  \\beta$。\n\n- 分子中带负号的解 $-\\beta - \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}$ 是负的。由于分母 $\\frac{2\\beta}{K}$ 是正的，整个解是负的，因此不具有生物学相关性。\n- 带正号的解 $-\\beta + \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}$ 是正的。这是唯一具有物理意义的稳态。\n\n我们取正根并简化表达式：\n$$\nx^{\\ast} = \\frac{-\\beta + \\sqrt{\\beta^2 + \\frac{4\\alpha\\beta}{K}}}{\\frac{2\\beta}{K}} = \\frac{K}{2\\beta} \\left(-\\beta + \\sqrt{\\beta^2\\left(1 + \\frac{4\\alpha}{\\beta K}\\right)}\\right)\n$$\n由于 $\\beta  0$，我们可以将其从平方根中提出来：\n$$\nx^{\\ast} = \\frac{K}{2\\beta} \\left(-\\beta + \\beta\\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n从括号中提出因子 $\\beta$：\n$$\nx^{\\ast} = \\frac{K\\beta}{2\\beta} \\left(-1 + \\sqrt{1 + \\frac{4\\alpha}{\\beta K}}\\right)\n$$\n$$\nx^{\\ast} = \\frac{K}{2} \\left(\\sqrt{1 + \\frac{4\\alpha}{\\beta K}} - 1\\right)\n$$\n这就是当 $n=1$ 时唯一正稳态的最终简化解析表达式。", "answer": "$$\n\\boxed{\\frac{K}{2} \\left(\\sqrt{1 + \\frac{4\\alpha}{\\beta K}} - 1\\right)}\n$$", "id": "3345716"}, {"introduction": "在确定了系统的稳态之后，下一个自然而然的问题是：这个稳态是稳定的吗？此实践引入了生物系统中普遍存在的一个关键因素——时间延迟——并探究它如何影响负反馈回路的稳定性 [@problem_id:3345691]。你将通过对一个含时滞的微分方程进行线性化分析，推导出导致系统失稳并产生持续振荡的临界条件，这对于理解生物节律（如昼夜节律）的产生机制至关重要。", "problem": "考虑一个单基因负自调控回路，其模型为一个延迟微分方程（DDE）：蛋白质浓度 $x(t)$ 遵循以下动力学\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} - \\beta\\, x(t),\n$$\n其中 $\\alpha$ 是最大合成速率，$K$ 是抑制剂的解离常数，$n$ 是捕捉抑制协同性的希尔系数，$\\beta$ 是一阶降解（和稀释）速率，$\\tau$ 是有效的转录-翻译延迟。假设通过选择 $\\alpha$ 使得对所有 $n$ 唯一的稳态都满足 $x^{\\ast} = K$，从而使系统在半饱和点运行。\n\n从微小信号线性化原理出发，将无量纲线性化环路增益定义为稳态下抑制性合成项的输入-输出斜率的绝对值与流出速率 $\\beta$ 的比值，并用 $n$ 来表示。然后，使用延迟负反馈的标准临界稳定性条件（角度以弧度为单位），通过确定一对复共轭特征值穿过虚轴时的临界希尔系数 $n_{\\mathrm{crit}}$，来评估稳态何时失去线性稳定性。特别地，对于给定的延迟\n$$\n\\tau = \\frac{3\\pi}{4\\,\\beta}.\n$$\n计算 $n_{\\mathrm{crit}}$。将 $n_{\\mathrm{crit}}$ 的最终答案表示为一个精确的解析表达式。不需要四舍五入，最终答案中不应包含单位。", "solution": "分析问题的有效性。\n\n**步骤1：提取已知条件**\n- **控制方程：** 蛋白质浓度 $x(t)$ 由延迟微分方程（DDE）建模：\n$$ \\frac{dx}{dt} = \\frac{\\alpha}{1 + \\left(\\frac{x(t-\\tau)}{K}\\right)^{n}} - \\beta\\, x(t) $$\n- **参数：**\n    - $\\alpha$：最大合成速率\n    - $K$：解离常数\n    - $n$：希尔系数\n    - $\\beta$：一阶降解速率\n    - $\\tau$：转录-翻译延迟\n- **稳态条件：** 系统存在唯一的稳态 $x^{\\ast}$，使得 $x^{\\ast} = K$。这通过适当选择 $\\alpha$ 来实现。\n- **特定延迟值：** $\\tau = \\frac{3\\pi}{4\\,\\beta}$。\n- **任务定义1：** 将无量纲线性化环路增益定义为稳态下抑制性合成项的输入-输出斜率的绝对值与流出速率 $\\beta$ 的比值。\n- **任务定义2：** 对于给定的延迟 $\\tau$，确定稳态失去线性稳定性时的临界希尔系数 $n_{\\mathrm{crit}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用一种类米氏方程（Michaelis-Menten-like）形式，结合用于抑制的希尔函数和时间延迟，来描述一个单基因负自调控回路。这是计算系统生物学中一个经典且成熟的模型（Goodwin振荡器的一个变体）。它在科学上是合理的，并且在生物振荡的研究中具有根本性的重要意义。\n- **适定性：** 该问题要求从一个明确定义的数学模型和标准的稳定性分析程序（线性化和临界稳定性）中推导出一个特定量 $n_{\\mathrm{crit}}$。所提供的约束和定义足以确定一个唯一的解。\n- **客观性：** 该问题以精确的数学和科学语言陈述，没有主观或模糊的术语。\n- **完整性和一致性：** 提供了所有必需的参数和条件。条件 $x^*=K$ 与模型一致，因为它可以通过设置 $\\alpha = 2\\beta K$ 来满足。$\\tau$ 的特定值是明确定义的。\n\n**步骤3：结论和行动**\n该问题被判定为 **有效**。这是一个理论系统生物学中的标准、适定问题，它在科学上是合理的、客观的并且是自洽的。可以进行求解过程。\n\n**求解推导**\n\n首先，我们确定由稳态条件 $x^{\\ast} = K$ 所施加的参数之间的关系。在稳态下，$\\frac{dx}{dt} = 0$，因此控制方程变为：\n$$ \\frac{\\alpha}{1 + \\left(\\frac{x^{\\ast}}{K}\\right)^{n}} - \\beta\\, x^{\\ast} = 0 $$\n代入 $x^{\\ast} = K$：\n$$ \\frac{\\alpha}{1 + \\left(\\frac{K}{K}\\right)^{n}} - \\beta\\, K = 0 $$\n$$ \\frac{\\alpha}{1 + 1} - \\beta\\, K = 0 $$\n$$ \\frac{\\alpha}{2} = \\beta\\, K \\implies \\alpha = 2\\beta K $$\n这证实了可以设置 $\\alpha$ 以确保对于任何希尔系数 $n$，稳态都位于 $x^{\\ast} = K$。\n\n接下来，我们围绕这个稳态对系统进行线性化。令 $x(t) = x^{\\ast} + \\delta x(t) = K + \\delta x(t)$。该DDE的形式为 $\\frac{dx}{dt} = f(x(t), x(t-\\tau))$。线性化得到：\n$$ \\frac{d(\\delta x)}{dt} \\approx \\left.\\frac{\\partial f}{\\partial x(t)}\\right|_{x^{\\ast}} \\delta x(t) + \\left.\\frac{\\partial f}{\\partial x(t-\\tau)}\\right|_{x^{\\ast}} \\delta x(t-\\tau) $$\n函数为 $f(u, v) = \\frac{\\alpha}{1 + (v/K)^n} - \\beta u$。其偏导数为：\n$$ \\frac{\\partial f}{\\partial x(t)} = \\frac{\\partial f}{\\partial u} = -\\beta $$\n$$ \\frac{\\partial f}{\\partial x(t-\\tau)} = \\frac{\\partial f}{\\partial v} = \\alpha \\cdot (-1) \\left(1 + \\left(\\frac{v}{K}\\right)^n\\right)^{-2} \\cdot n \\left(\\frac{v}{K}\\right)^{n-1} \\cdot \\frac{1}{K} $$\n在稳态 $(u, v) = (x^{\\ast}, x^{\\ast}) = (K, K)$ 处求值：\n$$ \\left.\\frac{\\partial f}{\\partial x(t)}\\right|_{x^{\\ast}} = -\\beta $$\n$$ \\left.\\frac{\\partial f}{\\partial x(t-\\tau)}\\right|_{x^{\\ast}} = -\\frac{\\alpha n}{K} \\frac{(K/K)^{n-1}}{(1+(K/K)^n)^2} = -\\frac{\\alpha n}{K} \\frac{1}{(1+1)^2} = -\\frac{\\alpha n}{4K} $$\n代入 $\\alpha = 2\\beta K$：\n$$ \\left.\\frac{\\partial f}{\\partial x(t-\\tau)}\\right|_{x^{\\ast}} = -\\frac{(2\\beta K)n}{4K} = -\\frac{n\\beta}{2} $$\n微扰 $\\delta x(t)$ 的线性化方程为：\n$$ \\frac{d(\\delta x)}{dt} = -\\beta\\, \\delta x(t) - \\frac{n\\beta}{2} \\delta x(t-\\tau) $$\n现在，我们求无量纲线性化环路增益。它被定义为合成项的输入-输出斜率的绝对值与流出速率的比值。合成项是 $S(x_{delay}) = \\frac{\\alpha}{1+(x_{delay}/K)^n}$。它在稳态下的斜率就是我们刚刚计算出的 $\\left.\\frac{\\partial f}{\\partial x(t-\\tau)}\\right|_{x^{\\ast}} = -\\frac{n\\beta}{2}$。该斜率的绝对值为 $|\\frac{-n\\beta}{2}| = \\frac{n\\beta}{2}$。流出速率是 $\\beta$。\n我们记为 $G$ 的无量纲线性化环路增益是：\n$$ G = \\frac{\\text{合成项斜率的绝对值}}{\\text{流出速率}} = \\frac{n\\beta/2}{\\beta} = \\frac{n}{2} $$\n为了评估稳定性，我们考察线性化DDE的特征方程。我们假设一个形式为 $\\delta x(t) = C e^{\\lambda t}$ 的解。将其代入线性化DDE得到：\n$$ \\lambda C e^{\\lambda t} = -\\beta C e^{\\lambda t} - \\frac{n\\beta}{2} C e^{\\lambda(t-\\tau)} $$\n除以 $C e^{\\lambda t}$（对于 $C \\neq 0$），得到特征值 $\\lambda$ 的特征方程：\n$$ \\lambda + \\beta + \\frac{n\\beta}{2} e^{-\\lambda\\tau} = 0 $$\n当一对复共轭特征值穿过虚轴时，系统失去稳定性。这是临界稳定性条件，其中 $\\lambda = i\\omega$，$\\omega  0$ 为某一实频率。在临界点，希尔系数为 $n = n_{\\mathrm{crit}}$。\n$$ i\\omega + \\beta + \\frac{n_{\\mathrm{crit}}\\beta}{2} e^{-i\\omega\\tau} = 0 $$\n使用欧拉公式 $e^{-i\\omega\\tau} = \\cos(\\omega\\tau) - i\\sin(\\omega\\tau)$：\n$$ i\\omega + \\beta + \\frac{n_{\\mathrm{crit}}\\beta}{2} (\\cos(\\omega\\tau) - i\\sin(\\omega\\tau)) = 0 $$\n我们将此方程分为实部和虚部：\n实部：$\\beta + \\frac{n_{\\mathrm{crit}}\\beta}{2}\\cos(\\omega\\tau) = 0 \\implies \\cos(\\omega\\tau) = -\\frac{2}{n_{\\mathrm{crit}}}$\n虚部：$\\omega - \\frac{n_{\\mathrm{crit}}\\beta}{2}\\sin(\\omega\\tau) = 0 \\implies \\sin(\\omega\\tau) = \\frac{2\\omega}{n_{\\mathrm{crit}}\\beta}$\n由于 $n_{\\mathrm{crit}}0$ 意味着 $\\cos(\\omega\\tau)  0$，且 $\\omega, \\beta, n_{\\mathrm{crit}}0$ 意味着 $\\sin(\\omega\\tau)0$，所以相位滞后 $\\omega\\tau$ 必须在第二象限。\n我们可以通过将两个方程相除来找到 $\\omega$ 和 $\\tau$ 之间的关系：\n$$ \\tan(\\omega\\tau) = \\frac{\\sin(\\omega\\tau)}{\\cos(\\omega\\tau)} = \\frac{2\\omega/(n_{\\mathrm{crit}}\\beta)}{-2/n_{\\mathrm{crit}}} = -\\frac{\\omega}{\\beta} $$\n这个条件等价于延迟负反馈的标准相位条件 $\\omega\\tau + \\arctan(\\omega/\\beta) = \\pi$。\n给定特定延迟 $\\tau = \\frac{3\\pi}{4\\beta}$。将其代入相位条件 $\\tan(\\omega\\tau) = -\\omega/\\beta$：\n$$ \\tan\\left(\\omega \\frac{3\\pi}{4\\beta}\\right) = -\\frac{\\omega}{\\beta} $$\n令 $u = \\omega/\\beta$。方程变为关于无量纲频率 $u$ 的超越方程：\n$$ \\tan\\left(\\frac{3\\pi}{4}u\\right) = -u $$\n我们可以通过观察找到解。让我们测试 $u=1$：\n左边：$\\tan\\left(\\frac{3\\pi}{4} \\cdot 1\\right) = \\tan\\left(\\frac{3\\pi}{4}\\right) = -1$。\n右边：$-1$。\n由于左边 = 右边，所以 $u=1$ 是一个解。函数 $g(u) = \\tan(\\frac{3\\pi}{4}u) + u$ 在相关区间内是严格递增的，因此这个解是唯一的。\n因此，临界振荡频率是 $\\omega = 1 \\cdot \\beta = \\beta$。\n\n现在我们使用恒等式 $\\sin^2(\\theta) + \\cos^2(\\theta) = 1$ 来求 $n_{\\mathrm{crit}}$：\n$$ \\left(\\frac{2\\omega}{n_{\\mathrm{crit}}^2\\beta^2}\\right)^2 + \\left(-\\frac{2}{n_{\\mathrm{crit}}}\\right)^2 = 1 $$\n$$ \\frac{4\\omega^2}{n_{\\mathrm{crit}}^2\\beta^2} + \\frac{4}{n_{\\mathrm{crit}}^2} = 1 $$\n$$ 4\\left(\\frac{\\omega^2}{\\beta^2} + 1\\right) = n_{\\mathrm{crit}}^2 $$\n代入临界频率 $\\omega=\\beta$：\n$$ n_{\\mathrm{crit}}^2 = 4\\left(\\frac{\\beta^2}{\\beta^2} + 1\\right) = 4(1+1) = 8 $$\n由于希尔系数 $n$ 必须为正，我们取正根：\n$$ n_{\\mathrm{crit}} = \\sqrt{8} = 2\\sqrt{2} $$", "answer": "$$\\boxed{2\\sqrt{2}}$$", "id": "3345691"}, {"introduction": "这项高阶实践将分析推导与计算机模拟相结合，体现了现代计算系统生物学的精髓。虽然简单的反馈回路可以实现稳态，但更复杂的功能，如对环境变化的精确适应（perfect adaptation），通常需要更精巧的线路设计 [@problem_id:3345735]。这个练习要求你首先从理论上推导出非相干前馈环路（incoherent feed-forward loop）如何补偿负反馈中的非线性以实现精确适应，然后编写程序来数值验证这一理论预测，从而深入理解复杂调控网络如何实现鲁棒的生物功能。", "problem": "考虑一个基因调控模块的最小动力学模型，该模型结合了一个饱和负反馈回路和一个非相干前馈回路。该系统接收一个外部输入信号 $u(t)$ 并产生一个输出 $y(t)$。负反馈由一个中间产物 $x(t)$ 介导，而非相干前馈抑制由一个中间产物 $w(t)$ 介导。假设所有调控都可以很好地由Hill型饱和函数描述，并且其动力学由常微分方程（ODEs）控制，这是质量作用定律下化学反应动力学的一个基础框架。\n\n该模型由以下三个耦合的常微分方程给出：\n$$\n\\frac{dy}{dt} \\;=\\; \\frac{k_y \\, A(u)}{\\left(1 + \\left(\\frac{x}{K_x}\\right)^n\\right)\\left(1 + \\left(\\frac{w}{K_{\\mathrm{inh}}}\\right)^q\\right)} \\;-\\; \\gamma_y \\, y,\n$$\n$$\n\\frac{dx}{dt} \\;=\\; k_x \\, B(y) \\;-\\; \\gamma_x \\, x,\n$$\n$$\n\\frac{dw}{dt} \\;=\\; k_w \\, H(u) \\;-\\; \\gamma_w \\, w,\n$$\n其中 $A(u)$ 是输入 $u$ 对 $y$ 的激活作用，$B(y)$ 是输出 $y$ 对反馈介质 $x$ 的激活作用，$H(u)$ 是输入 $u$ 对抑制剂 $w$ 的前馈激活作用。函数 $A$、$B$ 和 $H$ 通过Hill函数定义：\n$$\nh(z;K,p) \\;=\\; \\frac{z^p}{K^p + z^p},\n$$\n$$\nA(u) \\;=\\; A_0 \\;+\\; V_a \\, h(u;K_a,p_a), \\quad B(y) \\;=\\; h(y;K_b,m), \\quad H(u) \\;=\\; h(u;K_f,p_f),\n$$\n其中参数 $A_0$、$V_a$、$K_a$、$p_a$、$K_b$、$m$、$K_f$ 和 $p_f$ 均为正数。反馈非线性指数为 $n  0$，前馈抑制指数为 $q  0$。所有速率常数 $k_y$、$k_x$、$k_w$ 和降解速率 $\\gamma_y$、$\\gamma_x$、$\\gamma_w$ 均为正数。参数 $K_{\\mathrm{inh}}  0$ 用于标度前馈抑制的强度。\n\n假设输入 $u(t)$ 是一个阶跃信号：\n$$\nu(t) \\;=\\; \\begin{cases}\nu_0,  t  0, \\\\\nu_1 \\;=\\; u_0 + \\Delta u,  t \\ge 0,\n\\end{cases}\n$$\n其中 $u_0  0$ 且 $\\Delta u  0$。将稳态输出 $y_{\\mathrm{ss}}(u)$ 定义为在固定 $u$ 下，通过设置 $\\frac{dy}{dt} = 0$、$\\frac{dx}{dt} = 0$ 和 $\\frac{dw}{dt} = 0$ 得到的稳态方程的唯一根。因为中间产物会弛豫到作为 $y$ 和 $u$ 的函数的稳态，所以 $y$ 的稳态条件可以写成一个标量隐式方程：\n$$\nF(y,u) \\;\\equiv\\; \\gamma_y \\, y \\;-\\; \\frac{k_y \\, A(u)}{\\left(1 + \\phi(y)\\right)\\left(1 + \\psi(u)\\right)} \\;=\\; 0,\n$$\n其中\n$$\n\\phi(y) \\;=\\; \\left(\\frac{\\frac{k_x}{\\gamma_x} \\, B(y)}{K_x}\\right)^{n}, \\qquad \\psi(u) \\;=\\; \\left(\\frac{\\frac{k_w}{\\gamma_w} \\, H(u)}{K_{\\mathrm{inh}}}\\right)^{q}.\n$$\n\n将完美适应定义为对于阶跃扰动有 $y_{\\mathrm{ss}}(u_1) \\;=\\; y_{\\mathrm{ss}}(u_0)$。在实践中，对于饱和反馈，完美适应可能会失效；然而，如果调谐得当，非相干前馈可以在参考输入 $u_0$ 附近进行补偿。目标是确定非相干前馈基序是否能够抵消在饱和反馈下破坏完美适应的非线性，并推导在 $u_0$ 附近的近似线性化条件，在此条件下，组合基序能够恢复一阶适应性。\n\n任务：\n- 仅使用稳态的核心定义（$\\frac{dy}{dt}=\\frac{dx}{dt}=\\frac{dw}{dt}=0$）、隐函数定理和小信号线性化原理，推导出在 $u_0$ 处的近似条件，以确保当存在非相干前馈基序时，一阶灵敏度 $\\frac{d y_{\\mathrm{ss}}}{d u}\\big|_{u_0}$ 为零。将此条件用 $A(u)$、$\\psi(u)$ 及其在 $u_0$ 处对 $u$ 的导数表示，不假设除上述给出的Hill函数定义之外的任何特殊形式。推导必须从 $F(y,u)=0$ 出发，并遵循第一性原理进行。\n- 实现一个程序，在给定参数值的情况下，通过对每个固定的 $u$ 数值求解 $F(y,u)=0$ 来计算 $y_{\\mathrm{ss}}(u)$。在评估 $\\phi(y)$ 和 $\\psi(u)$ 时，使用关系式 $x_{\\mathrm{ss}}(y) \\;=\\; \\frac{k_x}{\\gamma_x} B(y)$ 和 $w_{\\mathrm{ss}}(u) \\;=\\; \\frac{k_w}{\\gamma_w} H(u)$。您的数值解必须找到物理相关的非负稳态 $y_{\\mathrm{ss}}(u) \\ge 0$。\n- 使用在 $u_0$ 处推导的线性化条件，通过设置 $q=1$ 并将 $\\psi(u)$ 表示为 $\\psi(u) \\;=\\; c \\, H(u)$ 来定义前馈抑制标度参数 $c$；然后设置 $K_{\\mathrm{inh}}$ 使得 $c \\;=\\; \\left(\\frac{k_w}{\\gamma_w}\\right)\\big/ K_{\\mathrm{inh}}$。对于需要调谐的测试用例，选择 $c$ 以满足在 $u_0$ 处推导的条件。对于未调谐的用例，将 $c$ 设置为指定值。\n- 对于每个测试用例，计算归一化适应误差\n$$\n\\varepsilon \\;=\\; \\frac{y_{\\mathrm{ss}}(u_1) - y_{\\mathrm{ss}}(u_0)}{y_{\\mathrm{ss}}(u_0)},\n$$\n表示为十进制数。同时计算在 $u_0$ 处的线性化失配\n$$\n\\delta \\;=\\; \\left.\\left(\\frac{d}{du} \\ln A(u) - \\frac{d}{du} \\ln\\left(1 + \\psi(u)\\right)\\right)\\right|_{u = u_0},\n$$\n表示为十进制数。\n\n您的程序必须产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。列表的每个元素都必须是对应于一个测试用例的由两个浮点数组成的列表 $[\\varepsilon, \\delta]$。例如，输出必须类似于 $[[\\varepsilon_1,\\delta_1],[\\varepsilon_2,\\delta_2],\\dots]$。\n\n除非另有说明，所有测试用例均使用以下参数值：\n- $k_y = 2.0$, $\\gamma_y = 1.0$, $A_0 = 0.2$, $V_a = 1.0$, $K_a = 1.0$, $p_a = 2$.\n- $k_x = 1.0$, $\\gamma_x = 1.0$, $K_b = 0.5$, $m = 2$, $K_x = 0.6$, $n = 2$.\n- $k_w = 1.0$, $\\gamma_w = 1.0$, $K_f = 1.0$, $p_f = 2$.\n- 对所有测试用例，设置 $q = 1$ 和 $\\psi(u) = c \\, H(u)$。\n\n定义测试套件如下：\n- 测试用例 1（$u_0$ 附近的理想情况）：$u_0 = 0.8$, $\\Delta u = 0.4$，选择 $c$ 以满足在 $u_0$ 处的线性化条件。\n- 测试用例 2（无前馈）：$u_0 = 0.8$, $\\Delta u = 0.4$，设置 $c = 0.0$。\n- 测试用例 3（过度补偿）：$u_0 = 0.8$, $\\Delta u = 0.4$，将 $c$ 设置为测试用例 1 中所用值的两倍。\n- 测试用例 4（低输入线性区，已调谐）：$u_0 = 0.2$, $\\Delta u = 0.05$，选择 $c$ 以满足在 $u_0$ 处的线性化条件。\n- 测试用例 5（高输入饱和区，未调谐）：$u_0 = 5.0$, $\\Delta u = 1.0$，设置 $c = 0.0$。\n\n所有量均为无量纲；不需要物理单位。不出现角度。百分比必须表示为小数。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个元素是对应测试用例的两个浮点数的列表 $[\\varepsilon,\\delta]$，顺序如上所示。", "solution": "该问题要求在一个结合了负反馈和非相干前馈的基因调控回路中，推导出一阶完美适应的条件。然后，该条件将用于数值评估系统的性能。推导过程必须从第一性原理出发，即稳态条件和隐函数定理。\n\n系统的稳态行为由隐式方程 $F(y, u) = 0$ 控制，其中 $y$ 代表给定输入 $u$ 下的稳态输出 $y_{\\mathrm{ss}}(u)$。该方程为：\n$$\nF(y, u) = \\gamma_y y - \\frac{k_y A(u)}{(1 + \\phi(y))(1 + \\psi(u))} = 0\n$$\n这里，$y$ 是 $u$ 的一个隐函数。为了找到输出 $y$ 相对于输入 $u$ 的灵敏度，我们计算 $F$ 对 $u$ 的全导数：\n$$\n\\frac{dF}{du} = \\frac{\\partial F}{\\partial y} \\frac{dy}{du} + \\frac{\\partial F}{\\partial u} = 0\n$$\n根据隐函数定理，导数 $\\frac{dy}{du}$ 由下式给出：\n$$\n\\frac{dy}{du} = - \\frac{\\partial F / \\partial u}{\\partial F / \\partial y}\n$$\n在参考输入 $u_0$ 处实现一阶完美适应的条件是灵敏度为零，即 $\\frac{dy}{du}\\big|_{u=u_0} = 0$。这要求表达式的分子为零，前提是分母不为零。\n\n首先，我们分析分母 $\\frac{\\partial F}{\\partial y}$：\n$$\n\\frac{\\partial F}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\gamma_y y - \\frac{k_y A(u)}{(1 + \\phi(y))(1 + \\psi(u))} \\right) = \\gamma_y - \\frac{k_y A(u)}{1 + \\psi(u)} \\frac{\\partial}{\\partial y} \\left( \\frac{1}{1 + \\phi(y)} \\right)\n$$\n$$\n\\frac{\\partial F}{\\partial y} = \\gamma_y + \\frac{k_y A(u)}{1 + \\psi(u)} \\frac{\\phi'(y)}{(1 + \\phi(y))^2}\n$$\n鉴于所有参数和状态变量（$y$）都是非负的，且Hill函数 $B(y)$ 是 $y$ 的单调递增函数，其导数以及因此产生的 $\\phi'(y)$ 都是非负的。由于所有速率常数和浓度都是正的，因此可以得出 $\\frac{\\partial F}{\\partial y}  0$。所以，分母不为零，一阶适应的条件简化为在 $(y_0, u_0)$ 处（其中 $y_0 = y_{\\mathrm{ss}}(u_0)$）$\\frac{\\partial F}{\\partial u} = 0$。\n\n接下来，我们计算分子 $\\frac{\\partial F}{\\partial u}$：\n$$\n\\frac{\\partial F}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\gamma_y y - \\frac{k_y A(u)}{(1 + \\phi(y))(1 + \\psi(u))} \\right)\n$$\n在偏微分过程中将 $y$ 视为常数，我们得到：\n$$\n\\frac{\\partial F}{\\partial u} = - \\frac{k_y}{1 + \\phi(y)} \\frac{\\partial}{\\partial u} \\left( \\frac{A(u)}{1 + \\psi(u)} \\right)\n$$\n对导数项使用商法则：\n$$\n\\frac{\\partial}{\\partial u} \\left( \\frac{A(u)}{1 + \\psi(u)} \\right) = \\frac{A'(u)(1 + \\psi(u)) - A(u)\\psi'(u)}{(1 + \\psi(u))^2}\n$$\n其中撇号表示对 $u$ 的微分。令 $\\frac{\\partial F}{\\partial u} = 0$ 要求该表达式的分子为零：\n$$\nA'(u)(1 + \\psi(u)) - A(u)\\psi'(u) = 0\n$$\n假设 $A(u)  0$ 和 $1 + \\psi(u)  0$（这在给定模型中成立），我们可以除以 $A(u)(1 + \\psi(u))$ 得到：\n$$\n\\frac{A'(u)}{A(u)} - \\frac{\\psi'(u)}{1 + \\psi(u)} = 0\n$$\n这个表达式可以用对数导数来写：\n$$\n\\frac{d}{du} \\ln\\left(A(u)\\right) = \\frac{d}{du} \\ln\\left(1 + \\psi(u)\\right)\n$$\n这就是从第一性原理推导出的完美适应所需的一阶条件。它表明，要实现适应，激活函数 $A(u)$ 的相对灵敏度必须被前馈抑制项 $(1 + \\psi(u))$ 的相对灵敏度精确平衡。\n\n对于实现部分，我们设置 $q=1$ 并定义 $\\psi(u) = c H(u)$。条件变为：\n$$\n\\frac{A'(u_0)}{A(u_0)} = \\frac{c H'(u_0)}{1 + c H(u_0)}\n$$\n解出调谐参数 $c$ 可得：\n$$\nA'(u_0)(1 + c H(u_0)) = c A(u_0) H'(u_0) \\implies A'(u_0) = c (A(u_0) H'(u_0) - A'(u_0) H(u_0))\n$$\n$$\nc = \\frac{A'(u_0)}{A(u_0) H'(u_0) - A'(u_0) H(u_0)}\n$$\n该公式用于为已调谐的测试用例计算 $c$。\n\n数值计算步骤包括：\n1. 对于给定的输入 $u$ 和参数集（包括 $c$），通过数值求解求根问题 $F(y, u, c)=0$ 来找到稳态输出 $y_{\\mathrm{ss}}(u)$，可以使用像Brent方法这样的鲁棒方法，因为函数 $F$ 对 $y$ 是单调的。\n2. 计算适应误差 $\\varepsilon = (y_{\\mathrm{ss}}(u_1) - y_{\\mathrm{ss}}(u_0)) / y_{\\mathrm{ss}}(u_0)$。\n3. 计算在 $u_0$ 处的线性化失配 $\\delta = \\frac{A'(u_0)}{A(u_0)} - \\frac{c H'(u_0)}{1 + c H(u_0)}$。对于已调谐的用例，$\\delta$ 根据构造为零。对于其他情况，其值量化了与理想适应条件的偏离程度。\n\n这些步骤在提供的Python代码中实现，以评估系统在指定测试用例下的行为。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the gene-regulatory model problem by deriving and applying a condition\n    for first-order perfect adaptation. It computes adaptation error and linearization\n    mismatch for several test cases.\n    \"\"\"\n    \n    # Define the common parameter set as a dictionary.\n    params = {\n        'k_y': 2.0, 'gamma_y': 1.0, 'A0': 0.2, 'Va': 1.0, 'Ka': 1.0, 'pa': 2,\n        'k_x': 1.0, 'gamma_x': 1.0, 'Kb': 0.5, 'm': 2, 'Kx': 0.6, 'n': 2,\n        'k_w': 1.0, 'gamma_w': 1.0, 'Kf': 1.0, 'pf': 2,\n        'q': 1 # Fixed as per problem statement\n    }\n\n    # --- Helper Functions ---\n\n    def h(z, K, p):\n        \"\"\"Hill function.\"\"\"\n        if z  0: return 0.0\n        z_p = z**p\n        K_p = K**p\n        return z_p / (K_p + z_p)\n\n    def A(u, p):\n        \"\"\"Activation function for y.\"\"\"\n        return p['A0'] + p['Va'] * h(u, p['Ka'], p['pa'])\n\n    def A_prime(u, p):\n        \"\"\"Derivative of A(u) with respect to u.\"\"\"\n        if u = 0: return 0.0\n        num = p['Va'] * p['pa'] * u**(p['pa'] - 1) * p['Ka']**p['pa']\n        den = (p['Ka']**p['pa'] + u**p['pa'])**2\n        return num / den\n\n    def B(y, p):\n        \"\"\"Activation function for x.\"\"\"\n        return h(y, p['Kb'], p['m'])\n\n    def H(u, p):\n        \"\"\"Activation function for w.\"\"\"\n        return h(u, p['Kf'], p['pf'])\n\n    def H_prime(u, p):\n        \"\"\"Derivative of H(u) with respect to u.\"\"\"\n        if u = 0: return 0.0\n        num = p['pf'] * u**(p['pf'] - 1) * p['Kf']**p['pf']\n        den = (p['Kf']**p['pf'] + u**p['pf'])**2\n        return num / den\n\n    def phi(y, p):\n        \"\"\"Feedback term.\"\"\"\n        val = (p['k_x'] / p['gamma_x'] * B(y, p)) / p['Kx']\n        return val**p['n']\n\n    def psi(u, c, p):\n        \"\"\"Feed-forward term.\"\"\"\n        return c * H(u, p)\n\n    def steady_state_func(y, u, c, p):\n        \"\"\"The function F(y,u)=0 to find the steady-state root y_ss.\"\"\"\n        if y  0: return -1e9 # Ensure physical domain\n        term1 = p['gamma_y'] * y\n        term2_num = p['k_y'] * A(u, p)\n        term2_den = (1.0 + phi(y, p)) * (1.0 + psi(u, c, p))\n        return term1 - term2_num / term2_den\n    \n    def get_yss(u, c, p):\n        \"\"\"Numerically solves for the steady-state y at a given u and c.\"\"\"\n        # Find a suitable search interval [y_low, y_high].\n        # F(y) is monotonically increasing. F(0)  0.\n        y_low = 1e-12\n        # An upper bound for y is k_y*(A0+Va)/gamma_y, roughly 2.4. \n        # A search up to 100.0 is more than safe.\n        y_high = 100.0\n        try:\n            return brentq(steady_state_func, y_low, y_high, args=(u, c, p))\n        except ValueError:\n            # This case should not be reached given the function's properties.\n            return np.nan\n            \n    def get_c_tuned(u0, p):\n        \"\"\"Calculates the c parameter for perfect first-order adaptation at u0.\"\"\"\n        A_u0 = A(u0, p)\n        Ap_u0 = A_prime(u0, p)\n        H_u0 = H(u0, p)\n        Hp_u0 = H_prime(u0, p)\n\n        numerator = Ap_u0\n        denominator = A_u0 * Hp_u0 - Ap_u0 * H_u0\n        \n        if np.abs(denominator)  1e-15:\n            return np.inf  # or handle as an error\n        return numerator / denominator\n    \n    def calculate_delta(u0, c, p):\n        \"\"\"Calculates the linearization mismatch delta.\"\"\"\n        A_u0 = A(u0, p)\n        Ap_u0 = A_prime(u0, p)\n        H_u0 = H(u0, p)\n        Hp_u0 = H_prime(u0, p)\n\n        term1 = Ap_u0 / A_u0 if A_u0 != 0 else 0\n        term2_num = c * Hp_u0\n        term2_den = 1.0 + c * H_u0\n        term2 = term2_num / term2_den if term2_den != 0 else 0\n        \n        return term1 - term2\n\n    # --- Main Logic ---\n\n    # Pre-calculate tuned c values required by test cases\n    c_tuned_case1 = get_c_tuned(0.8, params)\n    c_tuned_case4 = get_c_tuned(0.2, params)\n\n    test_cases = [\n        # (u0, Delta_u, c_value)\n        (0.8, 0.4, c_tuned_case1),        # Case 1: Tuned\n        (0.8, 0.4, 0.0),                  # Case 2: No FFL\n        (0.8, 0.4, 2.0 * c_tuned_case1),  # Case 3: Overcompensation\n        (0.2, 0.05, c_tuned_case4),       # Case 4: Tuned, low input\n        (5.0, 1.0, 0.0),                  # Case 5: Untuned, high input\n    ]\n\n    results = []\n    for u0, delta_u, c in test_cases:\n        u1 = u0 + delta_u\n        \n        yss_u0 = get_yss(u0, c, params)\n        yss_u1 = get_yss(u1, c, params)\n        \n        # Calculate adaptation error epsilon\n        epsilon = (yss_u1 - yss_u0) / yss_u0 if yss_u0 != 0 else np.inf\n        \n        # Calculate linearization mismatch delta\n        delta = calculate_delta(u0, c, params)\n        \n        results.append([epsilon, delta])\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([f\"[{e:.6f},{d:.6f}]\" for e, d in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3345735"}]}