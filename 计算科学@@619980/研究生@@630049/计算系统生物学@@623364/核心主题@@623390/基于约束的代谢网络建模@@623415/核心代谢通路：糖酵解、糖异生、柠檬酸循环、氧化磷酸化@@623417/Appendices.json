{"hands_on_practices": [{"introduction": "本节的第一个实践将重点放在新陈代谢的基础化学计量核算上。在构建复杂的计算模型之前，掌握电子和能量流的化学计量是至关重要的。本练习将引导您逐步计算一个葡萄糖分子完全氧化所产生的ATP总量，从而巩固您对糖酵解、三羧酸循环和氧化磷酸化等核心途径的投入产出关系的理解 [@problem_id:3298263]。", "problem": "一个典型的真核细胞通过以下途径，将一分子葡萄糖有氧完全氧化为二氧化碳和水：细胞溶胶中的糖酵解、丙酮酸转化为乙酰辅酶A、三羧酸循环（TCA）以及以分子氧为最终电子受体的氧化磷酸化（OXPHOS）。假设以下被广泛接受的化学计量事实和机理惯例：\n\n- 糖酵解将一分子葡萄糖转化为两分子丙酮酸，通过底物水平磷酸化净产生$2$分子三磷酸腺苷（ATP），并通过3-磷酸甘油醛脱氢酶产生$2$分子还原型烟酰胺腺嘌呤二核苷酸（NADH）。\n- 每分子丙酮酸被丙酮酸脱氢酶复合物氧化脱羧，生成一分子乙酰辅酶A和一分子NADH。\n- 每轮TCA循环将一分子乙酰辅酶A氧化为两分子二氧化碳，产生$3$分子NADH、$1$分子还原型黄素腺嘌呤二核苷酸（$\\text{FADH}_2$），并通过底物水平磷酸化产生$1$分子三磷酸鸟苷（GTP），其能量等同于$1$分子ATP。\n- 糖酵解产生的细胞溶胶NADH通过苹果酸-天冬氨酸穿梭系统转移到线粒体基质中，不直接消耗ATP，并再生为线粒体NADH。\n- 在OXPHOS中，每分子NADH向电子传递链提供$2$个电子，每氧化一分子NADH的磷氧比（P/O比）为$2.5$ ATP；每分子$\\text{FADH}_2$提供$2$个电子，每氧化一分子$\\text{FADH}_2$的P/O比为$1.5$ ATP。\n- 每分子还原型烟酰胺腺嘌呤二核苷酸（NADH）或$\\text{FADH}_2$携带$2$个电子，双氧分子接受电子形成水。\n\n利用质量和电子守恒定律以及上述化学计量事实，推导糖酵解、丙酮酸脱氢和TCA循环的电子平衡，以计算每氧化一分子葡萄糖转移给分子氧的总电子数，然后结合底物水平磷酸化和OXPHOS，使用给定的P/O比计算相应的每分子葡萄糖的总ATP产量。按顺序以两个数字报告你的最终结果：每分子葡萄糖转移给$\\text{O}_2$的总电子数，以及每分子葡萄糖形成的总ATP分子数。无需四舍五入。最终答案中不要包含单位。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 一分子葡萄糖有氧完全氧化为二氧化碳和水。\n- 途径顺序：糖酵解、丙酮酸脱氢酶复合物（PDC）、三羧酸循环（TCA）和氧化磷酸化（OXPHOS）。\n- 最终电子受体：分子氧（$\\text{O}_2$）。\n- 糖酵解：$1$分子葡萄糖 $\\rightarrow$ $2$分子丙酮酸，净产生$2$分子ATP（底物水平磷酸化，SLP）和$2$分子NADH。\n- PDC：$1$分子丙酮酸 $\\rightarrow$ $1$分子乙酰辅酶A + $1$分子NADH。\n- TCA循环：$1$分子乙酰辅酶A $\\rightarrow$ $2$分子$\\text{CO}_2$，产生$3$分子NADH、$1$分子$\\text{FADH}_2$和$1$分子GTP（等同于$1$分子ATP）。\n- 穿梭机制：来自糖酵解的细胞溶胶NADH通过苹果酸-天冬氨酸穿梭系统转移到线粒体基质，成为线粒体NADH。\n- OXPHOS P/O比：每分子NADH为$2.5$ ATP，每分子$\\text{FADH}_2$为$1.5$ ATP。\n- 电子载体：每分子NADH或$\\text{FADH}_2$携带$2$个电子。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它概述了真核生物有氧呼吸的标准模型。各途径中NADH、$\\text{FADH}_2$和ATP/GTP产量的化学计量系数与标准生物化学文献一致。使用现代的非整数P/O比（$2.5$和$1.5$）是科学上通用的。问题明确指出了苹果酸-天冬氨酸穿梭系统，这消除了歧义，使问题提法明确。先决条件是完整、一致的，并且不违反任何物理或生物学定律。该问题是系统生物学和生物化学中的一个标准的、可形式化的计算。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n根据要求，解答分为两部分：首先，计算转移的总电子数；其次，计算总ATP产量。\n\n**第一部分：总转移电子数计算**\n转移到分子氧的总电子数是在一分子葡萄糖完全氧化过程中产生的所有还原型辅酶NADH和$\\text{FADH}_2$所携带的电子总和。我们必须计算每个代谢阶段的产物。\n\n1.  **糖酵解：** 一分子葡萄糖氧化为两分子丙酮酸，在细胞溶胶中净产生$2$分子NADH。\n    $$\n    NADH_{\\text{glycolysis}} = 2\n    $$\n    问题指明，苹果酸-天冬氨酸穿梭系统将这些还原当量转移到线粒体基质中，再生$2$分子线粒体NADH。\n\n2.  **丙酮酸脱氢酶复合物（PDC）：** 糖酵解从一分子葡萄糖产生两分子丙酮酸。每分子丙酮酸转化为乙酰辅酶A，产生一分子NADH。因此，对于起始的一分子葡萄糖，此步骤产生：\n    $$\n    NADH_{\\text{PDC}} = 2 \\times 1 = 2\n    $$\n\n3.  **三羧酸（TCA）循环：** 从一分子葡萄糖生成的两分子乙酰辅酶A进入TCA循环。每轮循环氧化一分子乙酰辅酶A，产生$3$分子NADH和$1$分子$\\text{FADH}_2$。对于每分子葡萄糖进行两轮循环：\n    $$\n    NADH_{\\text{TCA}} = 2 \\times 3 = 6\n    $$\n    $$\n    FADH_{2, \\text{TCA}} = 2 \\times 1 = 2\n    $$\n\n4.  **还原型辅酶总量：** 从一分子葡萄糖产生的所有还原型辅酶分子总数是所有阶段的总和。\n    $$\n    NADH_{\\text{total}} = NADH_{\\text{glycolysis}} + NADH_{\\text{PDC}} + NADH_{\\text{TCA}} = 2 + 2 + 6 = 10\n    $$\n    $$\n    FADH_{2, \\text{total}} = FADH_{2, \\text{TCA}} = 2\n    $$\n\n5.  **总电子数：** 每分子NADH或$\\text{FADH}_2$携带$2$个电子。转移到电子传递链的总电子数（$N_e$）为：\n    $$\n    N_e = (NADH_{\\text{total}} \\times 2) + (FADH_{2, \\text{total}} \\times 2)\n    $$\n    $$\n    N_e = (10 \\times 2) + (2 \\times 2) = 20 + 4 = 24\n    $$\n    因此，共有$24$个电子转移给分子氧。这可以通过观察碳的氧化态变化来验证。在葡萄糖（$\\text{C}_6\\text{H}_{12}\\text{O}_6$）中，碳的平均氧化态为$0$。在二氧化碳（$\\text{CO}_2$）中，碳的氧化态为$+4$。对于来自葡萄糖的$6$个碳原子，总变化为$6 \\times (+4) = +24$，对应于失去$24$个电子。\n\n**第二部分：总ATP产量计算**\n总ATP产量是底物水平磷酸化（SLP）和氧化磷酸化（OXPHOS）产生的ATP之和。\n\n1.  **来自底物水平磷酸化的ATP：**\n    -   **糖酵解：** 问题陈述净产生$2$分子ATP。\n    -   **TCA循环：** 两轮循环中每轮产生$1$分子GTP，其能量等同于$1$分子ATP。这产生$2 \\times 1 = 2$分子ATP。\n    -   来自SLP的总ATP：\n        $$\n        ATP_{\\text{SLP}} = 2_{\\text{glycolysis}} + 2_{\\text{TCA}} = 4\n        $$\n\n2.  **来自氧化磷酸化的ATP：** 这是使用所产生的总NADH和$\\text{FADH}_2$的P/O比计算的。\n    -   我们有$10$分子NADH和$2$分子$\\text{FADH}_2$。\n    -   NADH的P/O比为$2.5$ ATP/NADH。\n    -   $\\text{FADH}_2$的P/O比为$1.5$ ATP/$\\text{FADH}_2$。\n    -   来自NADH的ATP：\n        $$\n        ATP_{\\text{NADH}} = 10 \\times 2.5 = 25\n        $$\n    -   来自$\\text{FADH}_2$的ATP：\n        $$\n        ATP_{\\text{FADH}_2} = 2 \\times 1.5 = 3\n        $$\n    -   来自OXPHOS的总ATP：\n        $$\n        ATP_{\\text{OXPHOS}} = ATP_{\\text{NADH}} + ATP_{\\text{FADH}_2} = 25 + 3 = 28\n        $$\n\n3.  **总ATP产量：** 总产量是两种磷酸化机制产生的ATP之和。\n    $$\n    ATP_{\\text{total}} = ATP_{\\text{SLP}} + ATP_{\\text{OXPHOS}} = 4 + 28 = 32\n    $$\n    因此，在指定条件下，一分子葡萄糖的完全有氧氧化总共产生$32$分子ATP。\n\n最终结果包含两个数字：每分子葡萄糖转移给$\\text{O}_2$的总电子数，为$24$；以及每分子葡萄糖形成的总ATP分子数，为$32$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n24  32\n\\end{pmatrix}\n}\n$$", "id": "3298263"}, {"introduction": "超越静态的化学计量，本实践将引入一个基于化学渗透理论的简单氧化磷酸化动态模型。您将使用一个线性模型来描述质子泵送、质子泄漏和ATP合成之间的关系。这个动手练习涉及根据模拟的实验数据拟合模型参数，并预测解偶联剂如何影响线粒体效率，这展示了计算系统生物学中的一个关键工作流程：模型构建、参数化和仿真分析 [@problem_id:3298291]。", "problem": "考虑一个关于线粒体氧化磷酸化的最小化稳态化学渗透模型，该模型基于化学渗透理论和线性非平衡态热力学的以下假设。电子传递给氧气（$\\text{O}_2$）驱动电子传递链跨线粒体内膜泵送质子，产生电势差$\\Delta \\psi$，在给定条件下，该电势差在质子动势中占主导地位。在接近稳态且不太偏离平衡时，每个通量都与其共轭热力学力呈线性关系。该模型包含以下组成部分：\n- 电子传递链质子泵电流$J_{\\text{pump}}$由有效电动势$E$驱动，并受到$\\Delta \\psi$的阻碍，其电导为$g_{\\text{pump}}$，因此$J_{\\text{pump}} = g_{\\text{pump}} (E - \\Delta \\psi)$。\n- 质子泄漏电流$J_{\\text{leak}}$遵循欧姆定律，其电导为$g_{\\text{leak}}$，因此$J_{\\text{leak}} = g_{\\text{leak}} \\Delta \\psi$。\n- 三磷酸腺苷（ATP）合酶（也称为$\\text{F}_1\\text{F}_0$-ATP合酶）每合成一个ATP消耗$n_{\\text{H,ATP}}$个质子，将其质子通量$J_{\\text{F}_1\\text{F}_0}$与ATP合成通量$J_{\\text{ATP}}$关联起来，即$J_{\\text{F}_1\\text{F}_0} = n_{\\text{H,ATP}} J_{\\text{ATP}}$。\n- 稳态下跨膜的电荷平衡要求$J_{\\text{pump}} = J_{\\text{leak}} + n_{\\text{H,ATP}} J_{\\text{ATP}}$。\n- 耗氧通量$J_{\\mathrm{O}_2}$通过化学计量关系与质子泵送耦合，即每消耗一个$\\mathrm{O}_2$分子泵送$n_{\\text{H,O}_2}$个质子，因此$J_{\\mathrm{O}_2} = J_{\\text{pump}} / n_{\\text{H,O}_2}$。\n- 解偶联剂根据线性滴定定律$g_{\\text{leak}}(c) = g_{\\text{basal}} + k_u c$增加质子泄漏电导，其中$c$是解偶联剂浓度。\n\n给定在固定ATP需求$J_{\\text{ATP}}$下、针对几个解偶联剂浓度$c$的滴定数据集，其中包括膜电位$\\Delta \\psi$（单位：毫伏, mV）和耗氧通量$J_{\\mathrm{O}_2}$（单位：nmol $\\mathrm{O}_2$ s$^{-1}$）的测量值。假设在每次测试中，$E$（单位：mV）、$g_{\\text{pump}}$（单位：nmol H$^+$ s$^{-1}$ mV$^{-1}$）、$n_{\\text{H,O}_2}$（单位：H$^+$每$\\mathrm{O}_2$）和$n_{\\text{H,ATP}}$（单位：H$^+$每ATP）是已知且恒定的。仅使用上述定义和稳态平衡，从$\\Delta \\psi$推断每个滴定点的$g_{\\text{leak}}$，通过最小二乘法拟合线性模型$g_{\\text{leak}}(c) = g_{\\text{basal}} + k_u c$以估计$g_{\\text{basal}}$和$k_u$，然后预测解偶联剂对表观磷氧比（每个氧原子的）的影响，该值定义为\n$$\n\\text{P/O}_{\\text{atom}} = \\frac{J_{\\text{ATP}}}{2 \\, J_{\\mathrm{O}_2}},\n$$\n这是一个无量纲量，必须以小数形式报告（而非百分比）。\n\n对于下方的每个测试案例：\n- 从滴定数据拟合$g_{\\text{basal}}$和$k_u$。\n- 使用拟合的参数，计算在$c = 0$和指定的评估浓度$c_{\\text{eval}}$下的稳态$\\Delta \\psi$、$J_{\\mathrm{O}_2}$和$\\text{P/O}_{\\text{atom}}$。\n- 对于每个测试案例，仅报告$\\text{P/O}_{\\text{atom}}$的两个值（在$c = 0$和$c = c_{\\text{eval}}$时）以及拟合的$g_{\\text{basal}}$和$k_u$。\n\n物理单位和说明：\n- 对$\\Delta \\psi$使用毫伏（mV）。对所有通量使用nmol s$^{-1}$。\n- 对解偶联剂浓度$c$使用微摩尔（uM）。\n- 将$\\text{P/O}_{\\text{atom}}$表示为小数。\n- 最终程序输出必须是单行，包含一个浮点数列表，按以下指定顺序排列。\n\n测试套件（三个独立案例）。对于每个案例，已知参数后跟着滴定数据和评估浓度：\n- 案例 A:\n  - $E = 180.0$ mV, $g_{\\text{pump}} = 1.2$ nmol H$^+$ s$^{-1}$ mV$^{-1}$, $n_{\\text{H,O}_2} = 20.0$, $n_{\\text{H,ATP}} = 3.67$, $J_{\\text{ATP}} = 10.0$ nmol s$^{-1}$。\n  - 滴定浓度$c$ (uM): $[0.0, 0.5, 1.0, 1.5, 2.0]$。\n  - 测量的$\\Delta \\psi$ (mV): $[137.9230769231, 133.8805970149, 129.9275362319, 126.2042253521, 122.8082191781]$。\n  - 测量的$J_{\\mathrm{O}_2}$ (nmol s$^{-1}$): $[2.5246153846, 2.7671641791, 3.0043478261, 3.2277464789, 3.4315068493]$。\n  - 评估浓度$c_{\\text{eval}} = 1.0$ uM。\n- 案例 B:\n  - $E = 180.0$ mV, $g_{\\text{pump}} = 1.2$ nmol H$^+$ s$^{-1}$ mV$^{-1}$, $n_{\\text{H,O}_2} = 20.0$, $n_{\\text{H,ATP}} = 3.67$, $J_{\\text{ATP}} = 0.0$ nmol s$^{-1}$。\n  - 滴定浓度$c$ (uM): $[0.0, 0.5, 1.0, 1.5, 2.0]$。\n  - 测量的$\\Delta \\psi$ (mV): $[163.6363636364, 160.4466501241, 157.6642335766, 154.8427672956, 152.1126760563]$。\n  - 测量的$J_{\\mathrm{O}_2}$ (nmol s$^{-1}$): $[0.9818181818, 1.1732009926, 1.3401459854, 1.5094339623, 1.6732394366]$。\n  - 评估浓度$c_{\\text{eval}} = 2.0$ uM。\n- 案例 C:\n  - $E = 180.0$ mV, $g_{\\text{pump}} = 1.2$ nmol H$^+$ s$^{-1}$ mV$^{-1}$, $n_{\\text{H,O}_2} = 20.0$, $n_{\\text{H,ATP}} = 3.67$, $J_{\\text{ATP}} = 30.0$ nmol s$^{-1}$。\n  - 滴定浓度$c$ (uM): $[0.0, 0.5, 1.0, 1.5, 2.0]$。\n  - 测量的$\\Delta \\psi$ (mV): $[82.734375, 79.0238805970, 75.6428571429, 72.5342465753, 69.6710526316]$。\n  - 测量的$J_{\\mathrm{O}_2}$ (nmol s$^{-1}$): $[5.8359375, 6.0585671642, 6.2614285714, 6.4479452055, 6.6197368421]$。\n  - 评估浓度$c_{\\text{eval}} = 1.5$ uM。\n\n每个案例的所需输出（按顺序）：\n- 拟合的$g_{\\text{basal}}$ (nmol H$^+$ s$^{-1}$ mV$^{-1}$)，\n- 拟合的$k_u$ (nmol H$^+$ s$^{-1}$ mV$^{-1}$ uM$^{-1}$)，\n- 在$c = 0$时的$\\text{P/O}_{\\text{atom}}$，\n- 在$c = c_{\\text{eval}}$时的$\\text{P/O}_{\\text{atom}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按案例 A、案例 B、案例 C 的顺序，将每个案例的四个结果连接成一个扁平列表（总共$12$个浮点数）。例如，格式为$[r_1,r_2,\\dots,r_{12}]$。", "solution": "我们从化学渗透理论和线性非平衡态热力学出发，这两者共同证明了在接近稳态时通量与力之间存在线性关系。电子传递链作为一个带有电动势$E$的源，泵送质子以建立电势$\\Delta \\psi$。最小线性关系如下：\n$$\nJ_{\\text{pump}} = g_{\\text{pump}} \\left(E - \\Delta \\psi \\right), \\quad J_{\\text{leak}} = g_{\\text{leak}} \\Delta \\psi, \\quad J_{\\text{F}_1\\text{F}_0} = n_{\\text{H,ATP}} J_{\\text{ATP}}.\n$$\n在稳态下，跨内膜的电荷守恒给出\n$$\nJ_{\\text{pump}} = J_{\\text{leak}} + n_{\\text{H,ATP}} J_{\\text{ATP}}.\n$$\n代入线性形式可得\n$$\ng_{\\text{pump}} \\left(E - \\Delta \\psi \\right) = g_{\\text{leak}} \\Delta \\psi + n_{\\text{H,ATP}} J_{\\text{ATP}}.\n$$\n在给定的$g_{\\text{leak}}$和$J_{\\text{ATP}}$下，为此方程求解$\\Delta \\psi$可得\n$$\n\\Delta \\psi = \\frac{g_{\\text{pump}} E - n_{\\text{H,ATP}} J_{\\text{ATP}}}{g_{\\text{pump}} + g_{\\text{leak}}}.\n$$\n或者，在稳态下给定一个测量的$\\Delta \\psi$，我们可以求解必须存在的泄漏电导：\n$$\ng_{\\text{leak}} = \\frac{g_{\\text{pump}} \\left(E - \\Delta \\psi \\right) - n_{\\text{H,ATP}} J_{\\text{ATP}}}{\\Delta \\psi}.\n$$\n这个关系是从滴定数据推断$g_{\\text{leak}}$的基础。质子泵送和耗氧之间的耦合由以下化学计量关系决定\n$$\nJ_{\\mathrm{O}_2} = \\frac{J_{\\text{pump}}}{n_{\\text{H,O}_2}} = \\frac{g_{\\text{pump}} \\left(E - \\Delta \\psi \\right)}{n_{\\text{H,O}_2}}.\n$$\n每个氧原子的表观磷氧比则为\n$$\n\\text{P/O}_{\\text{atom}} = \\frac{J_{\\text{ATP}}}{2 \\, J_{\\mathrm{O}_2}}.\n$$\n每个测试案例的算法步骤：\n- 步骤 1：对于每个浓度为$c_i$、测量值为$\\Delta \\psi_i$的滴定点$i$，计算\n$$\ng_{\\text{leak},i} = \\frac{g_{\\text{pump}} \\left(E - \\Delta \\psi_i \\right) - n_{\\text{H,ATP}} J_{\\text{ATP}}}{\\Delta \\psi_i}.\n$$\n- 步骤 2：通过普通最小二乘法拟合线性模型$g_{\\text{leak},i} \\approx g_{\\text{basal}} + k_u \\, c_i$来估计$g_{\\text{basal}}$和$k_u$。\n- 步骤 3：使用拟合的$g_{\\text{basal}}$和$k_u$，计算在$c = 0$和$c = c_{\\text{eval}}$时的$g_{\\text{leak}}$，然后通过以下公式计算相应的$\\Delta \\psi$\n$$\n\\Delta \\psi(c) = \\frac{g_{\\text{pump}} E - n_{\\text{H,ATP}} J_{\\text{ATP}}}{g_{\\text{pump}} + g_{\\text{leak}}(c)}.\n$$\n- 步骤 4：计算$J_{\\mathrm{O}_2}(c) = \\frac{g_{\\text{pump}} \\left(E - \\Delta \\psi(c) \\right)}{n_{\\text{H,O}_2}}$，最后计算$\\text{P/O}_{\\text{atom}}(c) = \\frac{J_{\\text{ATP}}}{2 \\, J_{\\mathrm{O}_2}(c)}$。\n- 步骤 5：报告四个量$[g_{\\text{basal}}, k_u, \\text{P/O}_{\\text{atom}}(0), \\text{P/O}_{\\text{atom}}(c_{\\text{eval}})]$。\n\n将这些步骤应用于所提供的合成数据：\n\n对于案例 A，其中$E = 180.0$, $g_{\\text{pump}} = 1.2$, $n_{\\text{H,O}_2} = 20.0$, $n_{\\text{H,ATP}} = 3.67$, $J_{\\text{ATP}} = 10.0$，推断出的$g_{\\text{leak},i}$值拟合得到$g_{\\text{basal}} \\approx 0.1$和$k_u \\approx 0.08$。在$c = 0$时预测的$\\text{P/O}_{\\text{atom}}$约为\n$$\n\\text{P/O}_{\\text{atom}}(0) = \\frac{10.0}{2 \\times 2.5246153846} \\approx 1.9811320755,\n$$\n在$c_{\\text{eval}} = 1.0$ uM 时约为\n$$\n\\text{P/O}_{\\text{atom}}(1.0) = \\frac{10.0}{2 \\times 3.0043478261} \\approx 1.6648351648.\n$$\n\n对于案例 B，其中$J_{\\text{ATP}} = 0.0$，拟合得到$g_{\\text{basal}} \\approx 0.12$和$k_u \\approx 0.05$。因为$J_{\\text{ATP}} = 0.0$，所以在$c = 0$和$c_{\\text{eval}} = 2.0$ uM 时，我们都有$\\text{P/O}_{\\text{atom}}(c) = 0.0$。\n\n对于案例 C，其中$J_{\\text{ATP}} = 30.0$，拟合得到$g_{\\text{basal}} \\approx 0.08$和$k_u \\approx 0.12$。在$c = 0$时预测的$\\text{P/O}_{\\text{atom}}$约为\n$$\n\\text{P/O}_{\\text{atom}}(0) = \\frac{30.0}{2 \\times 5.8359375} \\approx 2.5706940874,\n$$\n在$c_{\\text{eval}} = 1.5$ uM 时约为\n$$\n\\text{P/O}_{\\text{atom}}(1.5) = \\frac{30.0}{2 \\times 6.4479452055} \\approx 2.3264602790.\n$$\n\n解释：增加解偶联剂浓度会增加$g_{\\text{leak}}$，在固定的$J_{\\text{ATP}}$下，这会提高$J_{\\mathrm{O}_2}$，因为需要更多的质子泵送来平衡增加的泄漏。因此，表观$\\text{P/O}_{\\text{atom}}$随着解偶联剂剂量的增加而降低，反映了耦合效率的降低。在边界情况$J_{\\text{ATP}} = 0.0$（静息或类似状态4）下，根据定义$\\text{P/O}_{\\text{atom}}$为$0.0$，因为尽管由于泄漏而消耗了氧气，但没有ATP产生。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fit_g_leak_from_dpsi(E, g_pump, nH_O2, nH_ATP, J_ATP, c_array, dpsi_array):\n    \"\"\"\n    Infer g_leak at each titration point from measured delta-psi and fit\n    g_leak(c) = g_basal + k_u * c via least squares.\n\n    Returns:\n        g_basal, k_u\n    \"\"\"\n    # Compute inferred g_leak at each point:\n    # g_leak = [ g_pump * (E - dpsi) - nH_ATP * J_ATP ] / dpsi\n    dpsi = np.asarray(dpsi_array, dtype=float)\n    c = np.asarray(c_array, dtype=float)\n    g_leak_inferred = (g_pump * (E - dpsi) - nH_ATP * J_ATP) / dpsi\n\n    # Linear regression: g_leak = g_basal + k_u * c\n    X = np.column_stack((np.ones_like(c), c))\n    theta, *_ = np.linalg.lstsq(X, g_leak_inferred, rcond=None)\n    g_basal, k_u = theta[0], theta[1]\n    return g_basal, k_u\n\ndef steady_state_dpsi(E, g_pump, g_leak, nH_ATP, J_ATP):\n    # dpsi = (g_pump*E - nH_ATP*J_ATP) / (g_pump + g_leak)\n    return (g_pump * E - nH_ATP * J_ATP) / (g_pump + g_leak)\n\ndef jo2_from_dpsi(E, g_pump, nH_O2, dpsi):\n    # J_O2 = g_pump*(E - dpsi) / nH_O2\n    return g_pump * (E - dpsi) / nH_O2\n\ndef po_atom(J_ATP, J_O2):\n    # P/O per oxygen atom = J_ATP / (2 * J_O2)\n    # Handle J_O2 == 0 safely:\n    return (J_ATP / (2.0 * J_O2)) if J_O2 != 0.0 else 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case is a dictionary with parameters and data arrays\n        {\n            \"E\": 180.0,\n            \"g_pump\": 1.2,\n            \"nH_O2\": 20.0,\n            \"nH_ATP\": 3.67,\n            \"J_ATP\": 10.0,\n            \"c\": [0.0, 0.5, 1.0, 1.5, 2.0],\n            \"dpsi\": [137.9230769231, 133.8805970149, 129.9275362319, 126.2042253521, 122.8082191781],\n            \"jo2\": [2.5246153846, 2.7671641791, 3.0043478261, 3.2277464789, 3.4315068493],\n            \"c_eval\": 1.0,\n        },\n        {\n            \"E\": 180.0,\n            \"g_pump\": 1.2,\n            \"nH_O2\": 20.0,\n            \"nH_ATP\": 3.67,\n            \"J_ATP\": 0.0,\n            \"c\": [0.0, 0.5, 1.0, 1.5, 2.0],\n            \"dpsi\": [163.6363636364, 160.4466501241, 157.6642335766, 154.8427672956, 152.1126760563],\n            \"jo2\": [0.9818181818, 1.1732009926, 1.3401459854, 1.5094339623, 1.6732394366],\n            \"c_eval\": 2.0,\n        },\n        {\n            \"E\": 180.0,\n            \"g_pump\": 1.2,\n            \"nH_O2\": 20.0,\n            \"nH_ATP\": 3.67,\n            \"J_ATP\": 30.0,\n            \"c\": [0.0, 0.5, 1.0, 1.5, 2.0],\n            \"dpsi\": [82.734375, 79.0238805970, 75.6428571429, 72.5342465753, 69.6710526316],\n            \"jo2\": [5.8359375, 6.0585671642, 6.2614285714, 6.4479452055, 6.6197368421],\n            \"c_eval\": 1.5,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        g_pump = case[\"g_pump\"]\n        nH_O2 = case[\"nH_O2\"]\n        nH_ATP = case[\"nH_ATP\"]\n        J_ATP = case[\"J_ATP\"]\n        c = np.array(case[\"c\"], dtype=float)\n        dpsi = np.array(case[\"dpsi\"], dtype=float)\n        c_eval = float(case[\"c_eval\"])\n\n        # Fit g_basal and k_u from dpsi titration\n        g_basal, k_u = fit_g_leak_from_dpsi(E, g_pump, nH_O2, nH_ATP, J_ATP, c, dpsi)\n\n        # Compute P/O at c=0\n        g_leak_0 = g_basal + k_u * 0.0\n        dpsi_0 = steady_state_dpsi(E, g_pump, g_leak_0, nH_ATP, J_ATP)\n        jo2_0 = jo2_from_dpsi(E, g_pump, nH_O2, dpsi_0)\n        po0 = po_atom(J_ATP, jo2_0)\n\n        # Compute P/O at c=c_eval\n        g_leak_eval = g_basal + k_u * c_eval\n        dpsi_eval = steady_state_dpsi(E, g_pump, g_leak_eval, nH_ATP, J_ATP)\n        jo2_eval = jo2_from_dpsi(E, g_pump, nH_O2, dpsi_eval)\n        po_eval = po_atom(J_ATP, jo2_eval)\n\n        results.extend([g_basal, k_u, po0, po_eval])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3298291"}, {"introduction": "最后的这个实践将分析提升到网络层面，运用了基于约束的建模中的核心概念。您将探索代谢网络在关键酶被抑制时，如何通过利用旁路途径进行适应。通过将系统形式化为基本通量模式 (Elementary Flux Modes, EFMs) 并计算通量控制系数，您将定量地评估系统的鲁棒性以及旁路途径的重要性，从而阐明网络拓扑结构如何决定代谢功能 [@problem_id:3298294]。", "problem": "要求您形式化并分析一个最小化的氧化磷酸化网络，以检验在鱼藤酮（一种抑制烟酰胺腺嘌呤二核苷酸（还原型）脱氢酶复合物I的物质）存在的情况下，旁路脱氢酶是否能够维持观测到的三磷酸腺苷（ATP）合成通量。从以下计算系统生物学中的标准基础开始：\n\n- 稳态通量平衡：如果$\\mathbf{S}$是内部代谢物的化学计量矩阵，$\\mathbf{v}$是反应通量向量，则$\\mathbf{S}\\,\\mathbf{v} = \\mathbf{0}$。\n- 一个基本通量模式（EFM）是一个不可分解、可行、非零的通量向量，满足$\\mathbf{S}\\,\\mathbf{v} = \\mathbf{0}$和不可逆性约束，且其支撑集是最小的。\n- 电子传递链（ETC）由一个最小拓扑结构表示，其中包含一个用于质子动势（PMF）的伪代谢物，使得质子泵送步骤产生PMF，而ATP合成酶消耗PMF。\n\n网络定义。内部代谢物为：$\\mathrm{NADH}$、$\\mathrm{NAD^+}$、$\\mathrm{Q}$、$\\mathrm{QH_2}$、$\\mathrm{Cox}$、$\\mathrm{Cred}$、$\\mathrm{O_2}$、$\\mathrm{H_2O}$、$\\mathrm{PMF}$、$\\mathrm{ADP}$、$\\mathrm{ATP}$、$\\mathrm{Pi}$。外部交换反应提供$\\mathrm{NADH}$、$\\mathrm{ADP}$、$\\mathrm{Pi}$和$\\mathrm{O_2}$，并移除$\\mathrm{ATP}$和$\\mathrm{H_2O}$。不可逆内部反应：\n\n- 复合物I：$\\mathrm{NADH} + \\mathrm{Q} \\rightarrow \\mathrm{NAD^+} + \\mathrm{QH_2} + p_{\\mathrm{CI}}\\,\\mathrm{PMF}$。\n- 替代性NADH脱氢酶（旁路）：$\\mathrm{NADH} + \\mathrm{Q} \\rightarrow \\mathrm{NAD^+} + \\mathrm{QH_2}$。\n- 复合物III：$\\mathrm{QH_2} + 2\\,\\mathrm{Cox} \\rightarrow \\mathrm{Q} + 2\\,\\mathrm{Cred} + p_{\\mathrm{CIII}}\\,\\mathrm{PMF}$。\n- 复合物IV：$2\\,\\mathrm{Cred} + \\frac{1}{2}\\,\\mathrm{O_2} \\rightarrow 2\\,\\mathrm{Cox} + \\mathrm{H_2O} + p_{\\mathrm{CIV}}\\,\\mathrm{PMF}$。\n- ATP合成酶：$\\mathrm{ADP} + \\mathrm{Pi} + n_{\\mathrm{ATP}}\\,\\mathrm{PMF} \\rightarrow \\mathrm{ATP}$。\n\n假设所有反应在书写方向上都是不可逆的，并且在优化中$\\mathrm{PMF}$没有其他消耗途径（泄露被忽略，因为最大化$J_{\\text{ATP}}$会将其设置为零）。将$\\mathrm{NADH}$氧化与$\\mathrm{ATP}$合成耦合的两个最小EFM是：\n\n- 通过复合物I的EFM：$\\mathrm{NADH} \\rightarrow \\mathrm{QH_2} \\rightarrow \\mathrm{Cred} \\rightarrow \\mathrm{H_2O}$，每个$\\mathrm{NADH}$产生的PMF为$p_{\\mathrm{CI}} + p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}$，ATP产率为$Y_{\\mathrm{CI}} = \\dfrac{p_{\\mathrm{CI}} + p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}}{n_{\\mathrm{ATP}}}$。\n- 通过替代性脱氢酶的EFM：旁路复合物I，每个$\\mathrm{NADH}$产生的PMF为$p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}$，ATP产率为$Y_{\\mathrm{ALT}} = \\dfrac{p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}}{n_{\\mathrm{ATP}}}$。\n\n假设在任何拓扑结构中，为最大化$J_{\\text{ATP}}$而进行的还原当量优化分配会选择每个$\\mathrm{NADH}$具有更高ATP产率的EFM，并受其分步容量限制，因为复合物III和复合物IV是共享的，在高通量下会成为限制因素。设交换和酶促步骤的容量（上限）以一致的单位给出，并设鱼藤酮将复合物I的容量设置为零。\n\n对于给定的拓扑和容量，在以下约束条件下计算可实现的最大净ATP合成通量$J_{\\text{ATP}}^{\\max}$：\n\n- 对于EFM $k \\in \\{\\mathrm{CI}, \\mathrm{ALT}\\}$，链式$\\mathrm{NADH}$氧化通量受限于\n$$\nF_k = \\min\\Big( V_{\\mathrm{NADH}},\\; 2\\,V_{\\mathrm{O_2}},\\; V_{\\mathrm{CIII}},\\; V_{\\mathrm{CIV}},\\; V_k\\Big),\n$$\n其中$V_{\\mathrm{NADH}}$是$\\mathrm{NADH}$的供应能力，$V_{\\mathrm{O_2}}$是$\\mathrm{O_2}$的供应能力，$V_{\\mathrm{CIII}}$和$V_{\\mathrm{CIV}}$是复合物III和复合物IV的容量，$V_k$是路径$k$中脱氢酶的容量（$V_{\\mathrm{CI}}$或$V_{\\mathrm{ALT}}$）。因子$2$来自于每个$\\mathrm{NADH}$氧化需要$\\frac{1}{2}\\,\\mathrm{O_2}$的化学计量要求。\n- 通过EFM $k$的候选ATP通量为\n$$\nJ_k = Y_k\\,F_k,\n$$\n其中$Y_k$是如上定义的路径$k$中每个$\\mathrm{NADH}$的ATP产率。\n- 总ATP通量受到$\\mathrm{ADP}$、$\\mathrm{Pi}$和ATP合成酶容量的限制：\n$$\nJ_{\\text{ATP}}^{\\max} = \\min\\Big( V_{\\mathrm{ATPase}},\\; V_{\\mathrm{ADP}},\\; V_{\\mathrm{Pi}},\\; \\max_{k \\in \\mathcal{K}} J_k \\Big),\n$$\n其中$\\mathcal{K}$是拓扑中可用的EFM集合（如果存在鱼藤酮，则复合物I缺失；如果未表达，则替代性脱氢酶缺失）。\n\n将$J_{\\text{ATP}}$相对于容量参数$V$的操作通量控制系数定义为局部灵敏度\n$$\nC^{J}_{V} = \\frac{\\partial \\ln J_{\\text{ATP}}^{\\max}}{\\partial \\ln V},\n$$\n您应在给定的操作点使用$V$的一个小的相对扰动和有限差分进行数值近似。当$J_{\\text{ATP}}^{\\max}=0$时，定义$C^{J}_{V}=0$。\n\n您的任务是编写一个程序，对下面的每个测试用例执行以下操作：\n\n- 根据拓扑确定允许的EFM集合$\\mathcal{K}$（在鱼藤酮作用下去除复合物I；如果不存在则去除替代性脱氢酶）。\n- 根据给定的质子泵送化学计量和ATP合成酶的PMF需求，计算$Y_{\\mathrm{CI}}$和$Y_{\\mathrm{ALT}}$。\n- 使用上述规则计算$J_{\\text{ATP}}^{\\max}$。\n- 通过检查$J_{\\text{ATP}}^{\\max} \\ge J_{\\text{ATP}}^{\\mathrm{obs}}$来测试$J_{\\text{ATP}}^{\\max}$是否能维持观测到的ATP通量$J_{\\text{ATP}}^{\\mathrm{obs}}$。\n- 在给定的操作点，使用$V_{\\mathrm{ALT}}$的小扰动来计算控制系数$C^{J}_{V_{\\mathrm{ALT}}}$。\n- 所有ATP通量值以$\\text{nmol s}^{-1} \\text{mg}^{-1}$表示，四舍五入到三位小数。控制系数四舍五入到三位小数。可行性测试必须是布尔值。\n- 输出一行，包含每个测试用例的结果列表，其中每个结果的形式为$[\\mathrm{feasible}, J_{\\text{ATP}}^{\\max}, C^{J}_{V_{\\mathrm{ALT}}}]$。\n\n对所有测试用例使用以下固定的化学计量：\n- $p_{\\mathrm{CI}} = 4$, $p_{\\mathrm{CIII}} = 4$, $p_{\\mathrm{CIV}} = 2$, $n_{\\mathrm{ATP}} = 4$。\n\n测试套件。每个测试用例提供以下参数：\n- $\\mathrm{rotenone} \\in \\{\\mathrm{True}, \\mathrm{False}\\}$。\n- $\\mathrm{alt\\_present} \\in \\{\\mathrm{True}, \\mathrm{False}\\}$。\n- 容量，单位为$\\text{nmol s}^{-1} \\text{mg}^{-1}$：$V_{\\mathrm{NADH}}$, $V_{\\mathrm{O_2}}$, $V_{\\mathrm{CI}}$, $V_{\\mathrm{ALT}}$, $V_{\\mathrm{CIII}}$, $V_{\\mathrm{CIV}}$, $V_{\\mathrm{ATPase}}$, $V_{\\mathrm{ADP}}$, $V_{\\mathrm{Pi}}$。\n- 观测到的ATP通量$J_{\\text{ATP}}^{\\mathrm{obs}}$，单位为$\\text{nmol s}^{-1} \\text{mg}^{-1}$。\n\n提供以下测试用例：\n\n- 案例1（鱼藤酮作用下的正常路径）：$\\mathrm{rotenone}=\\mathrm{True}$，$\\mathrm{alt\\_present}=\\mathrm{True}$，$V_{\\mathrm{NADH}}=200$，$V_{\\mathrm{O_2}}=100$，$V_{\\mathrm{CI}}=120$，$V_{\\mathrm{ALT}}=80$，$V_{\\mathrm{CIII}}=100$，$V_{\\mathrm{CIV}}=100$，$V_{\\mathrm{ATPase}}=200$，$V_{\\mathrm{ADP}}=150$，$V_{\\mathrm{Pi}}=150$，$J_{\\text{ATP}}^{\\mathrm{obs}}=100$。\n- 案例2（鱼藤酮作用下替代性脱氢酶不足）：$\\mathrm{rotenone}=\\mathrm{True}$，$\\mathrm{alt\\_present}=\\mathrm{True}$，$V_{\\mathrm{NADH}}=200$，$V_{\\mathrm{O_2}}=100$，$V_{\\mathrm{CI}}=120$，$V_{\\mathrm{ALT}}=40$，$V_{\\mathrm{CIII}}=100$，$V_{\\mathrm{CIV}}=100$，$V_{\\mathrm{ATPase}}=200$，$V_{\\mathrm{ADP}}=150$，$V_{\\mathrm{Pi}}=150$，$J_{\\text{ATP}}^{\\mathrm{obs}}=100$。\n- 案例3（鱼藤酮作用下受$\\mathrm{ADP}$边界限制）：$\\mathrm{rotenone}=\\mathrm{True}$，$\\mathrm{alt\\_present}=\\mathrm{True}$，$V_{\\mathrm{NADH}}=200$，$V_{\\mathrm{O_2}}=100$，$V_{\\mathrm{CI}}=120$，$V_{\\mathrm{ALT}}=200$，$V_{\\mathrm{CIII}}=100$，$V_{\\mathrm{CIV}}=100$，$V_{\\mathrm{ATPase}}=200$，$V_{\\mathrm{ADP}}=70$，$V_{\\mathrm{Pi}}=300$，$J_{\\text{ATP}}^{\\mathrm{obs}}=70$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。例如，格式必须类似于$[[\\mathrm{True}, 120.000, 1.000],[\\mathrm{False}, 60.000, 1.000],[\\mathrm{True}, 70.000, 0.000]]$，浮点数保留三位小数，布尔文字大写。", "solution": "该问题是有效的，因为它科学地基于代谢建模的原理，问题设定良好，有清晰的算法路径可以得到唯一解，并且形式上规定了所有必要的参数和约束。它代表了计算系统生物学中的一个标准问题。\n\n解决方案首先基于所提供的网络拓扑和动力学约束，形式化计算最大ATP合成通量$J_{\\text{ATP}}^{\\max}$。随后，计算通量控制系数$C^{J}_{V_{\\mathrm{ALT}}}$，该系数用于量化替代性脱氢酶容量对ATP通量的控制程度。\n\n### 1. ATP产率 ($Y_k$) 的计算\n该模型定义了两种基本通量模式 (EFM)，用于将来自$\\mathrm{NADH}$的还原当量转化为ATP。每种EFM对每个氧化的$\\mathrm{NADH}$分子都有特定的ATP产率 ($Y$)，这取决于路径中复合物泵送的质子数量。\n\n固定的质子泵送化学计量给定为$p_{\\mathrm{CI}} = 4$，$p_{\\mathrm{CIII}} = 4$和$p_{\\mathrm{CIV}} = 2$。每个ATP分子合成时，ATP合成酶消耗的质子数为$n_{\\mathrm{ATP}} = 4$。\n\n-   **通过复合物I的EFM（CI路径）：** 该路径涉及复合物I、III和IV。每个$\\mathrm{NADH}$泵送的质子总数是每个复合物贡献的总和：$p_{\\mathrm{total, CI}} = p_{\\mathrm{CI}} + p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}$。因此，ATP产率为：\n    $$\n    Y_{\\mathrm{CI}} = \\frac{p_{\\mathrm{CI}} + p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}}{n_{\\mathrm{ATP}}} = \\frac{4 + 4 + 2}{4} = \\frac{10}{4} = 2.5 \\;\\;\\text{ATP}/\\mathrm{NADH}\n    $$\n\n-   **通过替代性脱氢酶的EFM（ALT路径）：** 该路径绕过复合物I，利用一个替代性脱氢酶，随后是复合物III和IV。泵送的质子总数为$p_{\\mathrm{total, ALT}} = p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}$。ATP产率为：\n    $$\n    Y_{\\mathrm{ALT}} = \\frac{p_{\\mathrm{CIII}} + p_{\\mathrm{CIV}}}{n_{\\mathrm{ATP}}} = \\frac{4 + 2}{4} = \\frac{6}{4} = 1.5 \\;\\;\\text{ATP}/\\mathrm{NADH}\n    $$\n\n### 2. 最大ATP通量 ($J_{\\text{ATP}}^{\\max}$) 的计算\n$J_{\\text{ATP}}^{\\max}$的计算是一个多步骤过程，考虑了网络拓扑和层级约束。\n\n-   **步骤2.1：确定活动路径 ($\\mathcal{K}$)**\n    可用EFM的集合$\\mathcal{K}$取决于给定条件。\n    -   如果存在鱼藤酮($\\mathrm{rotenone}=\\mathrm{True}$)，复合物I的容量$V_{\\mathrm{CI}}$实际上为零，因此CI路径不可用。\n    -   如果替代性脱氢酶未表达($\\mathrm{alt\\_present}=\\mathrm{False}$)，则ALT路径不可用。\n\n-   **步骤2.2：计算最大路径通量 ($F_k$)**\n    对于每个可用的EFM $k \\in \\mathcal{K}$，$\\mathrm{NADH}$氧化的最大速率$F_k$由链中最限制性的步骤决定。这通过取所有参与组分容量的最小值来找到。\n    $$\n    F_k = \\min\\Big( V_{\\mathrm{NADH}},\\; 2\\,V_{\\mathrm{O_2}},\\; V_{\\mathrm{CIII}},\\; V_{\\mathrm{CIV}},\\; V_k\\Big)\n    $$\n    这里，$V_k$是入口点脱氢酶（$V_{\\mathrm{CI}}$或$V_{\\mathrm{ALT}}$）的容量。$V_{\\mathrm{O_2}}$上的因子$2$源于复合物IV的化学计量，整个链中每氧化一个$\\mathrm{NADH}$消耗$1/2\\,\\mathrm{O_2}$（$v_{\\mathrm{NADH}} = 2\\,v_{\\mathrm{O_2}}$）。\n\n-   **步骤2.3：计算候选ATP通量 ($J_k$)**\n    来自每个路径$k$的潜在ATP合成通量是其最大$\\mathrm{NADH}$氧化通量$F_k$与其特定ATP产率$Y_k$的乘积。\n    $$\n    J_k = Y_k \\cdot F_k\n    $$\n\n-   **步骤2.4：确定最大ETC驱动的ATP通量**\n    问题假设为最大化ATP产量，系统会利用能产生最高ATP通量的可用EFM。计算方式如下：\n    $$\n    J_{\\mathrm{ETC}}^{\\max} = \\max_{k \\in \\mathcal{K}} J_k\n    $$\n    如果没有可用路径（$\\mathcal{K}$为空），则$J_{\\mathrm{ETC}}^{\\max} = 0$。\n\n-   **步骤2.5：应用最终约束**\n    总的最大ATP合成通量$J_{\\text{ATP}}^{\\max}$最终受到ATP合成酶自身容量($V_{\\mathrm{ATPase}}$)及其底物$\\mathrm{ADP}$和$\\mathrm{Pi}$供应($V_{\\mathrm{ADP}}$和$V_{\\mathrm{Pi}}$)的限制。\n    $$\n    J_{\\text{ATP}}^{\\max} = \\min\\Big( V_{\\mathrm{ATPase}},\\; V_{\\mathrm{ADP}},\\; V_{\\mathrm{Pi}},\\; J_{\\mathrm{ETC}}^{\\max} \\Big)\n    $$\n\n### 3. 可行性与控制系数\n-   **可行性检查：** 如果$J_{\\text{ATP}}^{\\max} \\ge J_{\\text{ATP}}^{\\mathrm{obs}}$，则认为系统能够维持观测到的ATP通量$J_{\\text{ATP}}^{\\mathrm{obs}}$。\n\n-   **通量控制系数 ($C^{J}_{V}$):** 该系数衡量通量($J_{\\text{ATP}}^{\\max}$)对容量参数($V$)的分数变化的响应。其定义为：\n    $$\n    C^{J}_{V} = \\frac{\\partial \\ln J_{\\text{ATP}}^{\\max}}{\\partial \\ln V}\n    $$\n    我们使用一个小的相对扰动$\\epsilon$通过数值有限差分法来近似它：\n    $$\n    C^{J}_{V} \\approx \\frac{\\ln\\big(J_{\\text{ATP}}^{\\max}(V \\cdot (1+\\epsilon))\\big) - \\ln\\big(J_{\\text{ATP}}^{\\max}(V)\\big)}{\\ln(V \\cdot (1+\\epsilon)) - \\ln(V)} = \\frac{\\ln\\left(\\frac{J_{\\text{ATP}}^{\\max}(V \\cdot (1+\\epsilon))}{J_{\\text{ATP}}^{\\max}(V)}\\right)}{\\ln(1+\\epsilon)}\n    $$\n    根据定义，如果$J_{\\text{ATP}}^{\\max} = 0$，则$C^{J}_{V} = 0$。如果在给定的操作点，参数$V$不限制通量，那么$V$的微小变化不会影响$J_{\\text{ATP}}^{\\max}$，导致$C^{J}_{V} = 0$。如果$V$是整个系统的唯一限制参数，则$C^{J}_{V} = 1$。\n\n上述逻辑被应用于每个测试用例以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the oxidative phosphorylation modeling problem for a suite of test cases.\n    \"\"\"\n\n    # Define fixed stoichiometric parameters as per the problem description.\n    # p_CI: Protons pumped by Complex I\n    # p_CIII: Protons pumped by Complex III\n    # p_CIV: Protons pumped by Complex IV\n    # n_ATP: Protons required by ATP synthase per ATP\n    p_CI = 4.0\n    p_CIII = 4.0\n    p_CIV = 2.0\n    n_ATP = 4.0\n\n    # Calculate ATP yields per NADH for each pathway.\n    # Y_CI: Yield for the pathway through Complex I.\n    # Y_ALT: Yield for the pathway through the alternative dehydrogenase.\n    Y_CI = (p_CI + p_CIII + p_CIV) / n_ATP\n    Y_ALT = (p_CIII + p_CIV) / n_ATP\n\n    def compute_j_atp_max(params):\n        \"\"\"\n        Computes the maximum ATP synthesis flux (J_ATP_max) for a given set of parameters.\n        \n        Args:\n            params (tuple): A tuple containing all model parameters for a single case.\n        \n        Returns:\n            float: The calculated maximum ATP flux.\n        \"\"\"\n        (rotenone, alt_present, V_NADH, V_O2, V_CI, V_ALT, V_CIII, V_CIV, \n         V_ATPase, V_ADP, V_Pi, _) = params\n\n        candidate_J_k = []\n\n        # Evaluate EFM via Complex I if available\n        if not rotenone:\n            # F_CI is the max NADH oxidation flux limited by pathway components\n            F_CI = min(V_NADH, 2 * V_O2, V_CIII, V_CIV, V_CI)\n            # J_CI is the candidate ATP flux from this pathway\n            J_CI = Y_CI * F_CI\n            candidate_J_k.append(J_CI)\n\n        # Evaluate EFM via alternative dehydrogenase if available\n        if alt_present:\n            # F_ALT is the max NADH oxidation flux limited by pathway components\n            F_ALT = min(V_NADH, 2 * V_O2, V_CIII, V_CIV, V_ALT)\n            # J_ALT is the candidate ATP flux from this pathway\n            J_ALT = Y_ALT * F_ALT\n            candidate_J_k.append(J_ALT)\n\n        # The max flux from the electron transport chain (ETC) is the max of available candidates\n        j_etc_max = 0.0\n        if candidate_J_k:\n            j_etc_max = max(candidate_J_k)\n\n        # The overall flux is also limited by ATP synthase and its substrates\n        j_atp_max = min(V_ATPase, V_ADP, V_Pi, j_etc_max)\n        \n        return j_atp_max\n\n    # Define the test cases from the problem statement.\n    # Format: (rotenone, alt_present, V_NADH, V_O2, V_CI, V_ALT, V_CIII, V_CIV,\n    #          V_ATPase, V_ADP, V_Pi, J_ATP_obs)\n    test_cases = [\n        (True, True, 200, 100, 120, 80, 100, 100, 200, 150, 150, 100),\n        (True, True, 200, 100, 120, 40, 100, 100, 200, 150, 150, 100),\n        (True, True, 200, 100, 120, 200, 100, 100, 200, 70, 300, 70),\n    ]\n\n    results = []\n    for case in test_cases:\n        J_ATP_obs = case[-1]\n        V_ALT_base = case[5]\n\n        # 1. Compute maximum ATP flux for the base case\n        j_atp_max_base = compute_j_atp_max(case)\n\n        # 2. Test feasibility\n        is_feasible = j_atp_max_base >= J_ATP_obs\n\n        # 3. Compute the flux control coefficient C_J_VALT\n        C_J_VALT = 0.0\n        # The coefficient is non-zero only if the flux and the parameter are non-zero.\n        if j_atp_max_base > 0 and V_ALT_base > 0:\n            epsilon = 1e-7  # Small relative perturbation\n\n            # Create a new parameter set with V_ALT perturbed\n            case_list_perturbed = list(case)\n            case_list_perturbed[5] *= (1 + epsilon)\n            case_perturbed = tuple(case_list_perturbed)\n            \n            # Compute flux for the perturbed case\n            j_atp_max_perturbed = compute_j_atp_max(case_perturbed)\n            \n            # If perturbation has no effect, coefficient is 0\n            if j_atp_max_perturbed != j_atp_max_base:\n                # Use the finite difference formula for the control coefficient\n                # C = (d ln J) / (d ln V)\n                numerator = np.log(j_atp_max_perturbed / j_atp_max_base)\n                denominator = np.log(1 + epsilon)\n                C_J_VALT = numerator / denominator\n\n        # Format and store the result for the current case\n        result_str = (f\"[{is_feasible}, \"\n                      f\"{j_atp_max_base:.3f}, \"\n                      f\"{C_J_VALT:.3f}]\")\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3298294"}]}