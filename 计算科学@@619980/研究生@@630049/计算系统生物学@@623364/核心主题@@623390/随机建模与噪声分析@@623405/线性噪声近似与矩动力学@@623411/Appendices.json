{"hands_on_practices": [{"introduction": "生灭过程是随机模型的基本构件，理解其噪声特性是掌握LNA的第一步。这个练习将指导你从化学主方程出发，通过van Kampen系统大小展开，为简单的生灭过程推导出扩散系数$D(\\phi)$。这能帮助你从根本上理解，离散的分子生灭事件是如何量化为描述宏观浓度波动的连续噪声项的。", "problem": "考虑一个体积为 $\\Omega$ 的充分混合区域中的单物种生灭过程，其分子数记为 $X$。反应方案为：生成 $\\varnothing \\to X$ 和消亡 $X \\to \\varnothing$。假设为标准的随机质量作用动力学，生成的倾向为 $a_{+}(X)=\\alpha \\Omega$，消亡的倾向为 $a_{-}(X)=k X$，其中 $\\alpha$ 和 $k$ 是正常数。通过 $X=\\Omega \\phi$ 定义宏观浓度 $\\phi$。使用 van Kampen 系统尺寸展开到线性噪声近似 (LNA)，令 $\\xi$ 表示由 $X=\\Omega \\phi + \\Omega^{1/2}\\xi$ 定义的浓度涨落。在线性噪声近似下，$\\xi$ 的概率密度遵循一个线性的 Fokker–Planck 方程，其状态依赖的扩散系数 $D(\\phi)$ 捕捉了浓度为 $\\phi$ 时的内禀噪声强度。\n\n从化学主方程和两个反应的化学计量定义出发，推导 $D(\\phi)$ 关于 $\\alpha$、$k$ 和 $\\phi$ 的显式表达式。然后，解释在宏观浓度 $\\phi$ 下，独立的生成和消亡反应如何对 $X$ 的瞬时方差增长做出贡献。将您的最终答案表示为 $D(\\phi)$ 的单个闭式解析表达式。无需进行数值计算，最终答案中也无需报告单位。", "solution": "该问题要求在线性噪声近似 (LNA) 框架内，推导单物种生灭过程的扩散系数 $D(\\phi)$。我们从化学主方程 (CME) 开始，它描述了在时间 $t$ 有 $X$ 个分子的概率 $P(X, t)$ 的时间演化。\n\n反应为：\n1. 生成：$\\varnothing \\xrightarrow{\\alpha\\Omega} X$，化学计量为 $S_+ = +1$，倾向为 $a_+(X) = \\alpha\\Omega$。\n2. 消亡：$X \\xrightarrow{kX} \\varnothing$，化学计量为 $S_- = -1$，倾向为 $a_-(X) = kX$。\n\n该系统的化学主方程为：\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = [a_+(X-1)P(X-1, t) - a_+(X)P(X, t)] + [a_-(X+1)P(X+1, t) - a_-(X)P(X, t)]\n$$\n代入给定的倾向：\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = [\\alpha\\Omega P(X-1, t) - \\alpha\\Omega P(X, t)] + [k(X+1)P(X+1, t) - kX P(X, t)]\n$$\n\n下一步是应用 van Kampen 系统尺寸展开。我们将分子数 $X$ 分解为一个确定性的宏观部分和一个随机的涨落部分：\n$$\nX(t) = \\Omega\\phi(t) + \\Omega^{1/2}\\xi(t)\n$$\n这里，$\\phi(t)$ 是宏观浓度，$\\xi(t)$ 是涨落变量。概率分布 $P(X, t)$ 被转换为涨落的分布 $\\Pi(\\xi, t)$，使得 $P(X, t)dX = \\Pi(\\xi, t)d\\xi$。由于 $dX = \\Omega^{1/2}d\\xi$，我们有 $P(X, t) = \\Omega^{-1/2}\\Pi(\\xi, t)$。\n\nCME 左侧的时间导数变换如下：\n$$\n\\frac{\\partial}{\\partial t} P(X, t) = \\frac{\\partial}{\\partial t} \\left(\\Omega^{-1/2}\\Pi(\\xi, t)\\right) = \\Omega^{-1/2}\\frac{\\partial \\Pi}{\\partial t} + \\Omega^{-1/2} \\frac{\\partial \\Pi}{\\partial \\xi} \\frac{\\partial \\xi}{\\partial t}\n$$\n根据 $\\xi$ 的定义，我们有 $\\frac{\\partial \\xi}{\\partial t} = -\\Omega^{1/2} \\frac{d\\phi}{dt}$。因此，左手边 (LHS) 变为：\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = \\Omega^{-1/2}\\frac{\\partial \\Pi}{\\partial t} - \\Omega^{1/2}\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi}\n$$\n\n现在我们展开 CME 右侧的项。我们使用 Kramers-Moyal 展开，它可以用移位算符 $E_X^n f(X) = f(X+n)$ 来表示。CME 可以写成：\n$$\n\\frac{\\partial P(X, t)}{\\partial t} = \\sum_{j \\in \\{+,-\\}} (E_X^{-S_j} - 1)[a_j(X) P(X, t)]\n$$\n作用于 $X$ 的函数的移位算符可以用关于 $\\xi$ 的导数来展开，使用 $\\frac{\\partial}{\\partial X} = \\Omega^{-1/2}\\frac{\\partial}{\\partial \\xi}$：\n$$\nE_X^{-S_j} = \\exp\\left(-S_j \\frac{\\partial}{\\partial X}\\right) = \\exp\\left(-S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi}\\right)\n$$\n将指数算符展开到二阶，得到：\n$$\nE_X^{-S_j} - 1 \\approx -S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi} + \\frac{1}{2} S_j^2 \\Omega^{-1} \\frac{\\partial^2}{\\partial \\xi^2}\n$$\n倾向项在宏观状态 $\\Omega\\phi$ 周围展开：\n$$\na_j(X) = a_j(\\Omega\\phi + \\Omega^{1/2}\\xi) \\approx a_j(\\Omega\\phi) + \\Omega^{1/2}\\xi \\frac{da_j}{dX}\\bigg|_{X=\\Omega\\phi}\n$$\n我们定义宏观速率函数 $F_j(\\phi) = \\Omega^{-1}a_j(\\Omega\\phi)$。\n对于生成反应：$F_+(\\phi) = \\Omega^{-1}(\\alpha\\Omega) = \\alpha$。\n对于消亡反应：$F_-(\\phi) = \\Omega^{-1}(k\\Omega\\phi) = k\\phi$。\n\nCME 中的项 $[a_j(X) P(X, t)]$ 展开为：\n$$\na_j(\\Omega\\phi + \\Omega^{1/2}\\xi) \\Omega^{-1/2}\\Pi(\\xi, t) \\approx [\\Omega F_j(\\phi) + \\dots] \\Omega^{-1/2}\\Pi = \\Omega^{1/2}F_j(\\phi)\\Pi(\\xi, t) + \\mathcal{O}(\\Omega^0)\n$$\n将这些展开式代入 CME 的右手边 (RHS)：\n$$\n\\sum_j \\left(-S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi} + \\frac{1}{2} S_j^2 \\Omega^{-1} \\frac{\\partial^2}{\\partial \\xi^2} + \\dots\\right) \\left[ (a_j(\\Omega\\phi) + \\dots)\\Omega^{-1/2}\\Pi \\right]\n$$\n我们按 $\\Omega$ 的幂次收集各项。\n\n最高阶项是 $\\Omega^{1/2}$。将左手边和右手边中此阶的项相等：\n$$\n-\\Omega^{1/2}\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi} = \\sum_j \\left( -S_j \\Omega^{-1/2} \\frac{\\partial}{\\partial \\xi}\\right) (a_j(\\Omega\\phi) \\Omega^{-1/2} \\Pi) = \\sum_j -S_j (\\Omega^{-1}a_j(\\Omega\\phi))\\Omega^{1/2}\\frac{\\partial\\Pi}{\\partial\\xi}\n$$\n$$\n-\\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi} = -\\left(\\sum_j S_j F_j(\\phi)\\right) \\frac{\\partial \\Pi}{\\partial \\xi}\n$$\n这对任何 $\\Pi$ 都必须成立，从而得到宏观速率方程：\n$$\n\\frac{d\\phi}{dt} = \\sum_j S_j F_j(\\phi) = S_+ F_+(\\phi) + S_- F_-(\\phi) = (+1)\\alpha + (-1)k\\phi = \\alpha - k\\phi\n$$\n这个方程描述了确定性宏观浓度的演化。\n\n为了求得扩散系数，我们考察 $\\Omega^0$ 阶的项。这需要对右手边进行更仔细的展开。\n$$\nRHS = \\sum_j \\left(E_X^{-S_j} - 1\\right)[a_j(X) P(X, t)]\n$$\n整个方程除以 $\\Omega^{-1/2}$ 后为：\n$$\n\\frac{\\partial \\Pi}{\\partial t} - \\Omega \\frac{d\\phi}{dt}\\frac{\\partial \\Pi}{\\partial \\xi} = \\sum_j \\left[ a_j(X-S_j)\\Pi(\\xi-S_j\\Omega^{-1/2},t) - a_j(X)\\Pi(\\xi,t) \\right]\n$$\n将右手边展开到下一阶，并与左手边的 $\\Omega^0$ 项匹配，得到线性的 Fokker-Planck 方程。从 van Kampen 展开得到的一个普遍结果是，$\\xi$ 的 Fokker-Planck 方程为：\n$$\n\\frac{\\partial \\Pi}{\\partial t} = -J(\\phi) \\frac{\\partial}{\\partial \\xi}(\\xi \\Pi) + \\frac{1}{2} D(\\phi) \\frac{\\partial^2 \\Pi}{\\partial \\xi^2}\n$$\n其中 $J(\\phi)$ 与宏观系统的雅可比矩阵有关，而 $D(\\phi)$ 是扩散系数。扩散系数由通用公式给出：\n$$\nD(\\phi) = \\sum_j S_j^2 F_j(\\phi)\n$$\n使用我们系统的化学计量向量和宏观速率：\n$S_+ = +1$, $F_+(\\phi) = \\alpha$\n$S_- = -1$, $F_-(\\phi) = k\\phi$\n我们可以计算 $D(\\phi)$：\n$$\nD(\\phi) = S_+^2 F_+(\\phi) + S_-^2 F_-(\\phi) = (+1)^2 (\\alpha) + (-1)^2 (k\\phi)\n$$\n$$\nD(\\phi) = \\alpha + k\\phi\n$$\n这就是在线性噪声近似下扩散系数的显式表达式。\n\n问题还要求解释生成和消亡反应的贡献。Fokker-Planck 方程中的扩散项 $\\frac{1}{2} D(\\phi) \\frac{\\partial^2 \\Pi}{\\partial \\xi^2}$ 控制着涨落方差的增长率。$\\xi$ 的方差的变化率，记为 $V_\\xi = \\langle \\xi^2 \\rangle - \\langle \\xi \\rangle^2$，由 $\\frac{dV_\\xi}{dt} = -2J(\\phi) V_\\xi + D(\\phi)$ 给出。$D(\\phi)$ 项表示由于反应的随机性，$\\xi$ 的方差的瞬时增长率。\n\n分子数 $X$ 的方差是 $\\text{Var}(X) = \\Omega V_\\xi$。由于随机事件，该方差的瞬时增长是 $\\Omega D(\\phi)$：\n$$\n\\text{Growth rate of Var}(X) = \\Omega D(\\phi) = \\Omega(\\alpha + k\\phi) = \\alpha\\Omega + k\\Omega\\phi\n$$\n我们可以识别出右手边的各项：\n- $\\alpha\\Omega = a_+(\\Omega\\phi)$ 是生成反应的宏观倾向。\n- $k\\Omega\\phi = a_-(\\Omega\\phi)$ 是消亡反应的宏观倾向。\n\n对于一组随机事件，方差的瞬时增长由 $\\sum_j (\\Delta X_j)^2 \\times (\\text{rate}_j)$ 给出，其中 $\\Delta X_j$ 是状态的变化，$\\text{rate}_j$ 是事件的频率。对于化学反应，这对应于 $\\sum_j S_j^2 a_j(X)$。在宏观水平上评估，即为 $\\sum_j S_j^2 a_j(\\Omega\\phi)$。\n- 生成反应贡献：$S_+^2 a_+(\\Omega\\phi) = (+1)^2 (\\alpha\\Omega) = \\alpha\\Omega$。\n- 消亡反应贡献：$S_-^2 a_-(\\Omega\\phi) = (-1)^2 (k\\Omega\\phi) = k\\Omega\\phi$。\n粒子数 $X$ 的总方差增长率是这些贡献的总和，即 $\\alpha\\Omega + k\\Omega\\phi$。浓度涨落 $\\xi$ 的扩散系数 $D(\\phi)$ 是这个总方差增长率按系统尺寸 $\\Omega$ 缩放后的结果。\n因此，$D(\\phi)$ 中的 $\\alpha$ 项是来自生成反应的缩放贡献，而 $k\\phi$ 项是来自消亡反应的缩放贡献。生成反应提供了一个恒定的噪声源，而来自消亡反应的噪声与浓度成正比。", "answer": "$$\n\\boxed{\\alpha + k\\phi}\n$$", "id": "3323858"}, {"introduction": "在掌握了单变量系统的基础后，我们将LNA的应用扩展到更真实的生物网络中，即基因表达的两阶段模型。本练习要求你应用完整的LNA矩阵形式，构建化学计量矩阵、雅可比矩阵和扩散矩阵，进而求解李雅普诺夫方程以获得蛋白质数量的稳态方差。这个过程不仅展示了LNA分析多物种系统噪声传播的威力，其结果本身也是系统生物学中的一个经典结论。", "problem": "考虑一个混合均匀的单细胞基因表达系统，其中包含两种化学物种：信使RNA（$\\mathrm{mRNA}$）和蛋白质（$\\mathrm{Protein}$）。该系统经历以下具有质量作用动力学的基元反应：转录 $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$，翻译 $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$，以及一级降解 $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$ 和 $\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$。设状态向量为 $\\phi(t) = (m(t), p(t))^{\\top}$，其中 $m(t)$ 和 $p(t)$ 表示确定性浓度或按固定系统体积缩放后的拷贝数均值。使用化学计量矩阵 $S$ 和宏观速率函数 $f(\\phi) = S\\,a(\\phi)$（其中 $a(\\phi)$ 为质量作用倾向）的标准定义，构建 $S$ 和在确定性稳态 $\\phi^{\\ast}$ 处求值的雅可比矩阵 $A(\\phi^{\\ast}) = \\left.\\frac{\\partial f}{\\partial \\phi}\\right|_{\\phi=\\phi^{\\ast}}$。然后，应用线性噪声近似（LNA），确定蛋白质拷贝数涨落的稳态方差，即围绕 $\\phi^{\\ast}$ 的涨落的稳态协方差矩阵的 $(2,2)$ 元。请用 $k_m$、$k_p$、$\\gamma_m$ 和 $\\gamma_p$ 表示您的最终答案，形式为单个闭式解析表达式。不要包含任何单位。无需进行数值计算。", "solution": "该系统包含两种物种，$\\mathrm{mRNA}$ 和 $\\mathrm{Protein}$，其浓度由状态向量 $\\phi(t) = (m(t), p(t))^{\\top}$ 表示。四个基元反应如下：\n1. 转录: $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$\n2. 翻译: $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$\n3. mRNA 降解: $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$\n4. 蛋白质降解: $\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$\n\n首先，我们构建化学计量矩阵 $S$，它描述了每个反应中物种拷贝数的净变化。将物种排序为 $(m, p)$，反应排序为 $(1, 2, 3, 4)$，净变化如下：\n$R_1: \\Delta m=1, \\Delta p=0$\n$R_2: \\Delta m=0, \\Delta p=1$\n$R_3: \\Delta m=-1, \\Delta p=0$\n$R_4: \\Delta m=0, \\Delta p=-1$\n化学计量矩阵 $S$ 是一个 $2 \\times 4$ 的矩阵：\n$$S = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix}$$\n倾向向量 $a(\\phi)$ 包含每个反应的速率，遵循质量作用动力学：\n$$a(\\phi) = \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix}$$\n宏观速率方程由 $\\frac{d\\phi}{dt} = f(\\phi) = S a(\\phi)$ 给出：\n$$\\frac{d\\phi}{dt} = \\begin{pmatrix} \\frac{dm}{dt} \\\\ \\frac{dp}{dt} \\end{pmatrix} = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix} \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix} = \\begin{pmatrix} k_m - \\gamma_m m \\\\ k_p m - \\gamma_p p \\end{pmatrix}$$\n为了找到确定性稳态 $\\phi^{\\ast} = (m^{\\ast}, p^{\\ast})^{\\top}$，我们令 $\\frac{d\\phi}{dt} = 0$:\n$$k_m - \\gamma_m m^{\\ast} = 0 \\implies m^{\\ast} = \\frac{k_m}{\\gamma_m}$$\n$$k_p m^{\\ast} - \\gamma_p p^{\\ast} = 0 \\implies p^{\\ast} = \\frac{k_p m^{\\ast}}{\\gamma_p} = \\frac{k_p}{\\gamma_p} \\left(\\frac{k_m}{\\gamma_m}\\right) = \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n接下来，我们计算在稳态 $\\phi^{\\ast}$ 处求值的雅可比矩阵 $A = \\frac{\\partial f}{\\partial \\phi}$：\n$$A = \\left.\\begin{pmatrix} \\frac{\\partial}{\\partial m}(k_m - \\gamma_m m)  \\frac{\\partial}{\\partial p}(k_m - \\gamma_m m) \\\\ \\frac{\\partial}{\\partial m}(k_p m - \\gamma_p p)  \\frac{\\partial}{\\partial p}(k_p m - \\gamma_p p) \\end{pmatrix}\\right|_{\\phi=\\phi^{\\ast}} = \\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix}$$\n雅可比矩阵与状态 $\\phi$ 无关，因此 $A(\\phi^{\\ast}) = A$。\n\n线性噪声近似（LNA）通过李雅普诺夫方程 $\\frac{dC}{dt} = A C + C A^{\\top} + E$ 来模拟涨落的协方差矩阵 $C(t)$ 的动力学。在稳态下，$\\frac{dC}{dt}=0$，因此稳态协方差矩阵 $C_{ss}$ 满足：\n$$A C_{ss} + C_{ss} A^{\\top} = -E$$\n扩散矩阵 $E$ 定义为 $E = S \\text{diag}(a(\\phi^{\\ast})) S^{\\top}$。首先，我们计算稳态下的倾向：\n$$a(\\phi^{\\ast}) = \\begin{pmatrix} k_m \\\\ k_p m^{\\ast} \\\\ \\gamma_m m^{\\ast} \\\\ \\gamma_p p^{\\ast} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ k_p \\frac{k_m}{\\gamma_m} \\\\ \\gamma_m \\frac{k_m}{\\gamma_m} \\\\ \\gamma_p \\frac{k_m k_p}{\\gamma_m \\gamma_p} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\\\ k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n现在我们计算 $E$：\n$$E = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix} \\begin{pmatrix} k_m  0  0  0 \\\\ 0  \\frac{k_m k_p}{\\gamma_m}  0  0 \\\\ 0  0  k_m  0 \\\\ 0  0  0  \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\\\ 0  -1 \\end{pmatrix}$$\n$$E = \\begin{pmatrix} k_m  0  -k_m  0 \\\\ 0  \\frac{k_m k_p}{\\gamma_m}  0  -\\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 2k_m  0 \\\\ 0  \\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n令 $C_{ss} = \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{21}  C_{22} \\end{pmatrix}$，其中 $C_{12} = C_{21}$。李雅普诺夫方程变为：\n$$\\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix} \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} + \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m  k_p \\\\ 0  -\\gamma_p \\end{pmatrix} = \\begin{pmatrix} -2k_m  0 \\\\ 0  -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n执行矩阵乘法得到：\n$$\\begin{pmatrix} -2\\gamma_m C_{11}  k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12} \\\\ k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12}  2k_p C_{12} - 2\\gamma_p C_{22} \\end{pmatrix} = \\begin{pmatrix} -2k_m  0 \\\\ 0  -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n这产生了一个包含三个线性方程的方程组：\n1.  $-2\\gamma_m C_{11} = -2k_m \\implies C_{11} = \\frac{k_m}{\\gamma_m}$\n2.  $k_p C_{11} - (\\gamma_m + \\gamma_p)C_{12} = 0 \\implies C_{12} = \\frac{k_p C_{11}}{\\gamma_m + \\gamma_p} = \\frac{k_p (k_m/\\gamma_m)}{\\gamma_m + \\gamma_p} = \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)}$\n3.  $2k_p C_{12} - 2\\gamma_p C_{22} = -\\frac{2k_m k_p}{\\gamma_m} \\implies \\gamma_p C_{22} = k_p C_{12} + \\frac{k_m k_p}{\\gamma_m}$\n\n我们想要求解 $C_{22}$，即协方差矩阵的 $(2,2)$ 元，它代表蛋白质拷贝数涨落的方差。根据方程 $(3)$：\n$$C_{22} = \\frac{k_p}{\\gamma_p} C_{12} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n将方程 $(2)$ 中 $C_{12}$ 的表达式代入：\n$$C_{22} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)} \\right) + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n为了合并各项，我们找到一个公分母：\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p (\\gamma_m + \\gamma_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n$$C_{22} = \\frac{k_m k_p^2 + k_m k_p \\gamma_m + k_m k_p \\gamma_p}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n从分子中提出公因子 $k_m k_p$ 得到最终表达式：\n$$C_{22} = \\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n该表达式代表蛋白质拷贝数涨落的稳态方差。", "answer": "$$\\boxed{\\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}}$$", "id": "3323872"}, {"introduction": "一个好的建模者不仅要会使用工具，更要清楚其局限性。本练习将引导你探索LNA的一个关键弱点：它在描述靠近吸收边界（例如种群灭绝）的随机过程时的失效。通过编程实现，你将直接对比LNA的高斯近似预测与化学主方程的精确解，从而量化在描述灭绝概率这类稀有事件时LNA的误差，并深刻理解其高斯假设的适用边界。", "problem": "考虑一个充分混合的单物种生化种群，其经历一个在零点有吸收边界的线性生灭过程。反应为：出生 $X \\to X + 1$，倾向为 $a_{b}(x) = \\lambda x$；死亡 $X \\to X - 1$，倾向为 $a_{d}(x) = \\mu x$，其中 $x \\in \\mathbb{Z}_{\\ge 0}$ 是分子数，$\\lambda$ 是单位分子出生率，$\\mu$ 是单位分子死亡率。假设种群是亚临界的，因此 $\\mu > \\lambda$，并设初始分子数为 $x(0) = n_{0} \\in \\mathbb{Z}_{\\ge 0}$。时间单位为秒，速率单位为 $\\mathrm{s}^{-1}$。\n\n你的任务是从随机化学动力学的第一性原理出发，推导在固定的观测时间 $T$ 种群灭绝（即在零点被吸收）的概率的两种独立预测：\n- 第一个预测必须从线性生灭过程的化学主方程 (CME) 推导得出，该过程被视为一个连续时间分支过程，从而得出在给定 $n_{0}$ 个独立初始分子的条件下，在时间 $T$ 的精确灭绝概率。\n- 第二个预测必须从线性噪声近似 (LNA) 推导得出，该近似假设围绕从宏观常微分方程 (ODE) 获得的确定性平均场轨迹存在高斯涨落。根据 LNA，计算 $X(T)$ 的均值 $m(T)$ 和方差 $v(T)$，然后利用这些值通过零点处的高斯左尾概率来近似灭绝概率。\n\n然后，你必须在单个程序中实现这两个推导出的公式，并对指定的测试套件量化它们之间的偏差。每个测试用例的偏差必须计算为精确的 CME 灭绝概率与 LNA 高斯近似值之间的绝对差。\n\n使用的基本原理：\n- CME 定义了具有给定倾向的马尔可夫跳跃过程中分子数概率的时间演化。\n- 线性生灭过程平均场动力学的宏观 ODE 为 $d\\phi/dt = (\\lambda - \\mu)\\phi$，在初始条件 $\\phi(0) = n_{0}$ 下的解为 $\\phi(t)$。\n- 线性系统的矩动力学可以从 CME 或等效的 Kramers–Moyal 展开中获得，而 LNA 假设高斯涨落由围绕宏观轨迹的线性化漂移和扩散决定。\n\n重要要求和说明：\n- 仔细推导两个预测，不使用任何预先提供的快捷公式。\n- 清楚地说明所有有量纲输入的单位，并确保输出的概率是无量纲的，并以小数形式表示（不带百分号）。\n- LNA 的近似必须实现为使用 $m(T)$ 和 $v(T)$ 在零点处求值的高斯累积分布函数 (cdf)。\n- 你的程序必须生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n\n测试套件：\n- 案例 1：$\\lambda = 0.4\\,\\mathrm{s}^{-1}$，$\\mu = 0.6\\,\\mathrm{s}^{-1}$，$n_{0} = 10$ 分子，$T = 2\\,\\mathrm{s}$。\n- 案例 2：$\\lambda = 0.95\\,\\mathrm{s}^{-1}$，$\\mu = 1.0\\,\\mathrm{s}^{-1}$，$n_{0} = 50$ 分子，$T = 1\\,\\mathrm{s}$。\n- 案例 3（纯死亡边缘情况）：$\\lambda = 0.0\\,\\mathrm{s}^{-1}$，$\\mu = 1.0\\,\\mathrm{s}^{-1}$，$n_{0} = 5$ 分子，$T = 0.2\\,\\mathrm{s}$。\n- 案例 4（长时间极限）：$\\lambda = 0.2\\,\\mathrm{s}^{-1}$，$\\mu = 0.4\\,\\mathrm{s}^{-1}$，$n_{0} = 20$ 分子，$T = 50\\,\\mathrm{s}$。\n\n最终输出格式：\n- 你的程序应输出一行，其中包含按上述顺序列出的四个测试用例的绝对偏差，格式为用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$）。", "solution": "### 精确灭绝概率的推导 (CME)\n\n从 $n_0$ 个个体开始的线性生灭过程，可以看作是 $n_0$ 个独立同分布的分支过程的叠加，每个过程都由单个个体引发。总种群在时间 $T$ 灭绝，当且仅当所有 $n_0$ 个独立的谱系都在时间 $T$ 前灭绝。\n\n设 $p_{\\text{ext},1}(t)$ 是由单个个体在时间 $t=0$ 时开始的谱系在时间 $t$ 前灭绝的概率。那么整个种群的灭绝概率为：\n$$P_{\\text{CME}}(T) = [p_{\\text{ext},1}(T)]^{n_0}$$\n\n为了求 $p_{\\text{ext},1}(t)$，我们可以分析处于状态 $x=0$ 的概率 $P_0(t)$ 的动力学。对于从一个个体开始的过程，$P_0(t) \\equiv p_{\\text{ext},1}(t)$。在时间 $t$ 有 $x$ 个个体的概率分布 $P_x(t)$ 的主方程为：\n$$\\frac{dP_x}{dt} = \\lambda(x-1)P_{x-1} + \\mu(x+1)P_{x+1} - (\\lambda+\\mu)xP_x \\quad \\text{for } x \\ge 1$$\n$$\\frac{dP_0}{dt} = \\mu P_1$$\n这个常微分方程组可以使用概率生成函数求解，但更直接的方法是推导灭绝概率 $p(t) \\equiv p_{\\text{ext},1}(t)$ 的后向 Kolmogorov 方程。从一个个体开始，在小时间间隔 $dt$ 内，该个体可以出生（概率为 $\\lambda dt$）、死亡（概率为 $\\mu dt$）或什么都不做。这导致了关于 $p(t)$ 的以下非线性常微分方程：\n$$\\frac{dp}{dt} = \\lambda p^2 - (\\lambda+\\mu)p + \\mu$$\n这可以改写为：\n$$\\frac{dp}{dt} = (\\mu - \\lambda p)(1 - p)$$\n这是一个可分离的一阶微分方程。我们用初始条件 $p(0)=0$（如果我们从一个粒子开始，在时间 0 时灭绝的概率为零）来求解它。\n$$\\int \\frac{dp}{(\\mu-\\lambda p)(1-p)} = \\int dt$$\n在左侧使用部分分式分解：\n$$\\frac{1}{(\\mu-\\lambda p)(1-p)} = \\frac{A}{\\mu-\\lambda p} + \\frac{B}{1-p}$$\n解出 $A$ 和 $B$ 得 $A = \\frac{\\lambda}{\\mu-\\lambda}$ 和 $B = \\frac{1}{\\mu-\\lambda}$。\n$$\\frac{1}{\\mu-\\lambda} \\int \\left( \\frac{\\lambda}{\\mu-\\lambda p} + \\frac{1}{1-p} \\right) dp = \\int dt$$\n对两边积分得到：\n$$\\frac{1}{\\mu-\\lambda} [-\\ln(\\mu - \\lambda p) - \\ln(1-p)] = t + C$$\n$$\\ln\\left(\\frac{1}{(\\mu-\\lambda p)(1-p)}\\right) = (\\mu-\\lambda)t + C'$$\n另一种方法是直接积分：\n$$\\frac{1}{\\mu-\\lambda}\\left[-\\ln(\\mu-\\lambda p) - (-\\ln(1-p))\\right]_0^p = t$$\n$$\\frac{1}{\\mu-\\lambda}\\left(\\ln(1-p) - \\ln(\\mu-\\lambda p) - (\\ln(1) - \\ln(\\mu))\\right) = t$$\n$$\\ln\\left(\\frac{\\mu(1-p)}{\\mu-\\lambda p}\\right) = (\\mu-\\lambda)t$$\n求解 $p$，即我们的 $p_{\\text{ext},1}(t)$：\n$$\\frac{\\mu(1-p)}{\\mu-\\lambda p} = e^{(\\mu-\\lambda)t}$$\n$$\\mu - \\mu p = (\\mu - \\lambda p)e^{(\\mu-\\lambda)t}$$\n$$\\mu - \\mu e^{(\\mu-\\lambda)t} = p(\\mu - \\lambda e^{(\\mu-\\lambda)t})$$\n$$p(t) = \\frac{\\mu(1 - e^{(\\mu-\\lambda)t})}{\\mu - \\lambda e^{(\\mu-\\lambda)t}}$$\n分子分母同乘以 $e^{-(\\mu-\\lambda)t}$ 得到一个对于大 $t$ 更稳定的形式：\n$$p_{\\text{ext},1}(t) = \\frac{\\mu(e^{(\\lambda-\\mu)t} - 1)}{\\mu e^{(\\lambda-\\mu)t} - \\lambda} = \\frac{\\mu(1 - e^{(\\mu-\\lambda)t})}{\\mu - \\lambda e^{(\\mu-\\lambda)t}}$$\n最适合计算的形式是：\n$$p_{\\text{ext},1}(T) = \\frac{\\mu(e^{(\\mu-\\lambda)T} - 1)}{\\mu e^{(\\mu-\\lambda)T} - \\lambda}$$\n最后，对于初始种群为 $n_0$ 的精确灭绝概率是：\n$$P_{\\text{CME}}(T) = \\left( \\frac{\\mu(e^{(\\mu-\\lambda)T} - 1)}{\\mu e^{(\\mu-\\lambda)T} - \\lambda} \\right)^{n_0}$$\n\n### 近似灭绝概率的推导 (LNA)\n\n线性噪声近似 (LNA) 通过一个由均值和方差方程控制的高斯过程来近似随机动力学。\n\n**1. 均值动力学：**\n分子平均数 $m(t)$ 的宏观速率方程可从倾向中获得：\n$$\\frac{dm}{dt} = (+1) a_b(m) + (-1) a_d(m) = \\lambda m - \\mu m = (\\lambda-\\mu)m$$\n在初始条件 $m(0) = n_0$ 下，解为：\n$$m(t) = n_0 e^{(\\lambda-\\mu)t}$$\n在观测时间 $T$，均值为 $m(T) = n_0 e^{(\\lambda-\\mu)T}$。\n\n**2. 方差动力学：**\n在 LNA 下，方差 $v(t)$ 的演化由 Lyapunov 方程给出：\n$$\\frac{dv}{dt} = 2 J(t) v(t) + D(t)$$\n其中 $J(t)$ 是速率方程的雅可比矩阵，$D(t)$ 是扩散项。\n- **雅可比矩阵**：$J(t) = \\frac{d}{dm}[(\\lambda-\\mu)m] = \\lambda-\\mu$。\n- **扩散**：$D(t) = \\sum_{k \\in \\{b,d\\}} \\nu_k^2 a_k(m(t)) = (+1)^2 (\\lambda m(t)) + (-1)^2 (\\mu m(t)) = (\\lambda+\\mu)m(t)$。\n\n将这些代入方差方程：\n$$\\frac{dv}{dt} = 2(\\lambda-\\mu)v + (\\lambda+\\mu)m(t)$$\n代入 $m(t)$ 的解：\n$$\\frac{dv}{dt} = 2(\\lambda-\\mu)v + (\\lambda+\\mu)n_0 e^{(\\lambda-\\mu)t}$$\n这是一个关于 $v(t)$ 的一阶线性常微分方程。我们使用初始条件 $v(0)=0$（假设初始状态已知）来求解。积分因子是 $I(t) = e^{-\\int 2(\\lambda-\\mu) dt} = e^{-2(\\lambda-\\mu)t}$。\n$$\\frac{d}{dt}\\left(v(t) e^{-2(\\lambda-\\mu)t}\\right) = (\\lambda+\\mu)n_0 e^{(\\lambda-\\mu)t} e^{-2(\\lambda-\\mu)t} = (\\lambda+\\mu)n_0 e^{-(\\lambda-\\mu)t}$$\n从 $0$ 到 $t$ 积分：\n$$v(t)e^{-2(\\lambda-\\mu)t} - v(0)e^0 = \\int_0^t (\\lambda+\\mu)n_0 e^{-(\\lambda-\\mu)\\tau} d\\tau$$\n$$v(t)e^{-2(\\lambda-\\mu)t} = (\\lambda+\\mu)n_0 \\left[ \\frac{e^{-(\\lambda-\\mu)\\tau}}{-(\\lambda-\\mu)} \\right]_0^t = \\frac{(\\lambda+\\mu)n_0}{-(\\lambda-\\mu)} (e^{-(\\lambda-\\mu)t} - 1)$$\n$$v(t) = \\frac{(\\lambda+\\mu)n_0}{\\mu-\\lambda} (1 - e^{-(\\lambda-\\mu)t}) e^{2(\\lambda-\\mu)t} = \\frac{(\\lambda+\\mu)n_0}{\\mu-\\lambda} (e^{2(\\lambda-\\mu)t} - e^{(\\lambda-\\mu)t})$$\n在观测时间 $T$，方差为：\n$$v(T) = n_0 \\frac{\\lambda+\\mu}{\\mu-\\lambda} (e^{2(\\lambda-\\mu)T} - e^{(\\lambda-\\mu)T}) = n_0 \\frac{\\lambda+\\mu}{\\mu-\\lambda} e^{(\\lambda-\\mu)T} (e^{(\\lambda-\\mu)T} - 1)$$\n\n**3. 灭绝的高斯近似：**\nLNA 将 $X(T)$ 的概率分布近似为高斯分布 $\\mathcal{N}(m(T), v(T))$。灭绝概率 $P(X(T)=0)$ 则通过该高斯分布在 $0$ 处的累积概率来近似：\n$$P_{\\text{LNA}}(T) = P(Y \\le 0) \\quad \\text{其中 } Y \\sim \\mathcal{N}(m(T), v(T))$$\n这使用标准正态累积分布函数 (CDF) $\\Phi(z)$ 来计算：\n$$P_{\\text{LNA}}(T) = \\Phi\\left(\\frac{0 - m(T)}{\\sqrt{v(T)}}\\right) = \\Phi\\left(-\\frac{m(T)}{\\sqrt{v(T)}}\\right)$$\n其中 $m(T)$ 和 $v(T)$ 是上面推导出的表达式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import ndtr\n\ndef solve():\n    \"\"\"\n    Solves for the discrepancy between CME and LNA extinction probabilities for a linear birth-death process.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (lambda, mu, n0, T)\n        (0.4, 0.6, 10, 2.0),\n        (0.95, 1.0, 50, 1.0),\n        (0.0, 1.0, 5, 0.2),\n        (0.2, 0.4, 20, 50.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        lmbda, mu, n0, T = case\n\n        # 1. CME Exact Extinction Probability\n        # For a subcritical process (mu > lmbda)\n        delta = mu - lmbda\n        \n        # Formula for the extinction probability of a single lineage\n        # p_ext_1 = (mu * (exp(delta*T) - 1)) / (mu * exp(delta*T) - lmbda)\n        # Numerically stable evaluation is important, especially for large T.\n        # However, for the given parameters, direct evaluation is fine.\n        exp_delta_T = np.exp(delta * T)\n        p_ext_1 = (mu * (exp_delta_T - 1)) / (mu * exp_delta_T - lmbda)\n        \n        # Total extinction probability for n0 independent lineages\n        p_cme = p_ext_1**n0\n\n        # 2. LNA Approximate Extinction Probability\n        # Mean m(T)\n        m_T = n0 * np.exp((lmbda - mu) * T)\n        \n        # Variance v(T)\n        # The term (lmbda-mu) is negative.\n        term1 = np.exp((lmbda - mu) * T)\n        term2 = np.exp(2 * (lmbda - mu) * T)\n        # Note: v_T formula is n0 * (lmbda+mu)/(mu-lmbda) * (exp((lmbda-mu)T) - exp(2*(lmbda-mu)T))\n        # Since lmbda-mu is negative, exp((lmbda-mu)T) > exp(2*(lmbda-mu)T), so the difference is positive.\n        v_T = n0 * (lmbda + mu) / (mu - lmbda) * (term1 - term2)\n\n        # The LNA can produce zero variance for T=0 or n0=0, but the test cases avoid this.\n        if v_T > 0:\n            # Argument for the standard normal CDF\n            z = -m_T / np.sqrt(v_T)\n            # Gaussian CDF evaluated at 0 for a N(m_T, v_T) distribution\n            # This is equivalent to Phi(z) for a standard normal distribution\n            p_lna = ndtr(z)\n        else:\n            # If variance is zero, the distribution is a delta function at the mean.\n            # If mean is positive, extinction probability is 0. If non-positive, it is 1.\n            p_lna = 0.0 if m_T > 0 else 1.0\n            \n        # 3. Discrepancy calculation\n        discrepancy = abs(p_cme - p_lna)\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    # Format results to a reasonable number of significant figures for consistent output.\n    formatted_results = [f\"{r:.12f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3323843"}]}