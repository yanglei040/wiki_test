{"hands_on_practices": [{"introduction": "在将理论模型与实验数据联系起来时，一个基本方法是矩量法（method of moments）。通过测量细胞群体中简单的统计量，例如信使核糖核酸（mRNA）分子的平均数（均值）和其在细胞间的变异性（Fano 因子），我们可以反向推断启动子转换的内在速率。本练习 [@problem_id:3356589] 将引导您从第一性原理出发，推导这些实验可观测量与动力学参数 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 之间的重要关系。", "problem": "考虑一个单基因中信使核糖核酸（mRNA）转录的标准双态启动子转换（电报）模型。启动子根据一个连续时间 Markov 过程在非激活状态（$0$，“OFF”）和激活状态（$1$，“ON”）之间切换，从 $0$ 到 $1$ 的转换速率为 $k_{\\text{on}}$，从 $1$ 到 $0$ 的转换速率为 $k_{\\text{off}}$。当启动子处于 ON 状态时，mRNA 以恒定速率 $s$ 合成；当启动子处于 OFF 状态时，没有 mRNA 合成。每个 mRNA 分子以速率 $\\gamma$ 独立降解。假设系统处于稳态，并且 $s$ 和 $\\gamma$ 是已知的正常数。\n\n您测量了细胞系综中 mRNA 拷贝数的稳态均值 $\\,\\mu\\,$ 和法诺因子 $\\,F\\,$（定义为稳态方差除以稳态均值）。从第一性原理出发（从电报模型的转换以及均值、二阶矩和交叉矩的定义开始），推导连接 $\\,\\mu\\,$ 和 $\\,F\\,$ 与 $\\,k_{\\text{on}}\\,$ 和 $\\,k_{\\text{off}}\\,$ 的稳态关系。利用这些关系：\n\n- 确定在测得的 $\\,\\mu\\,$ 和 $\\,F\\,$（给定已知的 $s$ 和 $\\gamma$）上，使得 $\\,k_{\\text{on}}\\,$ 和 $\\,k_{\\text{off}}\\,$ 可被识别为正的有限速率的充分必要条件。\n- 提供 $\\,k_{\\text{on}}\\,$ 和 $\\,k_{\\text{off}}\\,$ 的矩估计法的闭式解析表达式，用 $\\,\\mu\\,$, $\\,F\\,$, $\\,s\\,$ 和 $\\,\\gamma\\,$ 表示。\n\n您的最终答案应仅包含 $\\,k_{\\text{on}}\\,$ 和 $\\,k_{\\text{off}}\\,$ 的解析表达式。不需要进行数值计算。", "solution": "该问题是有效的，因为它在科学上基于标准的转录电报模型，是适定的、客观的，并包含了进行形式推导所需的所有信息。\n\n设 $z(t)$ 为启动子的状态，其中 $z=1$ 为 ON 状态， $z=0$ 为 OFF 状态。设 $n(t)$ 为 mRNA 分子的数量。系统动力学由以下转换和速率描述：\n\\begin{itemize}\n    \\item 启动子激活：$0 \\xrightarrow{k_{\\text{on}}} 1$\n    \\item 启动子失活：$1 \\xrightarrow{k_{\\text{off}}} 0$\n    \\item mRNA 合成：$\\emptyset \\xrightarrow{s} n$，仅当 $z=1$ 时发生\n    \\item mRNA 降解：$n \\xrightarrow{\\gamma} \\emptyset$，对每个分子\n\\end{itemize}\n我们从第一性原理出发，推导联合概率分布 $P(z, n, t)$ 的矩的时间演化。我们关心的是稳态，此时所有时间导数均为零。\n\n首先，我们考虑一阶矩：平均启动子状态 $\\langle z \\rangle$ 和平均 mRNA 数量 $\\langle n \\rangle$。期望值的动力学由以下公式给出：\n$$ \\frac{d\\langle z \\rangle}{dt} = k_{\\text{on}} \\langle 1-z \\rangle - k_{\\text{off}} \\langle z \\rangle = k_{\\text{on}} - (k_{\\text{on}} + k_{\\text{off}})\\langle z \\rangle $$\n$$ \\frac{d\\langle n \\rangle}{dt} = \\langle s \\cdot z - \\gamma n \\rangle = s\\langle z \\rangle - \\gamma\\langle n \\rangle $$\n在稳态（$\\frac{d}{dt}=0$）下，我们将启动子处于 ON 状态的稳态概率表示为 $p_{\\text{on}} = \\langle z \\rangle_{ss}$，平均 mRNA 数量表示为 $\\mu = \\langle n \\rangle_{ss}$。从第一个方程可得：\n$$ 0 = k_{\\text{on}} - (k_{\\text{on}} + k_{\\text{off}})p_{\\text{on}} \\implies p_{\\text{on}} = \\frac{k_{\\text{on}}}{k_{\\text{on}} + k_{\\text{off}}} $$\n从第二个方程可得：\n$$ 0 = s p_{\\text{on}} - \\gamma \\mu \\implies \\mu = \\frac{s}{\\gamma} p_{\\text{on}} $$\n将这些结合起来，得到均值与动力学速率之间的第一个关系：\n$$ \\mu = \\frac{s}{\\gamma} \\frac{k_{\\text{on}}}{k_{\\text{on}} + k_{\\text{off}}} $$\n\n接下来，我们推导二阶矩的动力学以求得方差 $\\sigma^2 = \\langle n^2 \\rangle_{ss} - \\mu^2$。我们需要 $\\langle n^2 \\rangle$ 和交叉矩 $\\langle nz \\rangle$ 的时间演化。\n每次反应中 $n^2$ 的变化是：\n\\begin{itemize}\n    \\item 合成（$n \\to n+1$）：$(n+1)^2 - n^2 = 2n+1$。这在 $z=1$ 时以速率 $s$ 发生。\n    \\item 降解（$n \\to n-1$）：$(n-1)^2 - n^2 = -2n+1$。这以速率 $\\gamma n$ 发生。\n\\end{itemize}\n因此，$\\langle n^2 \\rangle$ 的动力学是：\n$$ \\frac{d\\langle n^2 \\rangle}{dt} = \\langle (2n+1)sz \\rangle + \\langle (-2n+1)\\gamma n \\rangle = 2s\\langle nz \\rangle + s\\langle z \\rangle - 2\\gamma\\langle n^2 \\rangle + \\gamma\\langle n \\rangle $$\n每次反应中乘积 $nz$ 的变化是：\n\\begin{itemize}\n    \\item 合成（$n \\to n+1$）：$(n+1)z - nz = z$。速率是 $sz$。由于 $z$ 是 $0$ 或 $1$，所以 $z^2=z$。贡献是 $s\\langle z^2 \\rangle = s\\langle z \\rangle$。\n    \\item 降解（$n \\to n-1$）：$(n-1)z - nz = -z$。速率是 $\\gamma n$。贡献是 $\\langle -z(\\gamma n) \\rangle = -\\gamma \\langle nz \\rangle$。\n    \\item 激活（$z=0 \\to z=1$）：$n(1) - n(0) = n$。当 $z=0$ 时速率是 $k_{\\text{on}}$。贡献是 $k_{\\text{on}}\\langle n(1-z) \\rangle = k_{\\text{on}}(\\langle n \\rangle - \\langle nz \\rangle)$。\n    \\item 失活（$z=1 \\to z=0$）：$n(0) - n(1) = -n$。当 $z=1$ 时速率是 $k_{\\text{off}}$。贡献是 $k_{\\text{off}}\\langle -n z \\rangle = -k_{\\text{off}}\\langle nz \\rangle$。\n\\end{itemize}\n将这些贡献相加，得到 $\\langle nz \\rangle$ 的动力学：\n$$ \\frac{d\\langle nz \\rangle}{dt} = s\\langle z \\rangle - \\gamma\\langle nz \\rangle + k_{\\text{on}}\\langle n \\rangle - k_{\\text{on}}\\langle nz \\rangle - k_{\\text{off}}\\langle nz \\rangle = s\\langle z \\rangle + k_{\\text{on}}\\langle n \\rangle - (k_{\\text{on}}+k_{\\text{off}}+\\gamma)\\langle nz \\rangle $$\n在稳态下，将导数设为零：\n$$ 2s\\langle nz \\rangle_{ss} + s p_{\\text{on}} - 2\\gamma\\langle n^2 \\rangle_{ss} + \\gamma\\mu = 0 \\implies \\langle n^2 \\rangle_{ss} = \\frac{1}{2\\gamma} (2s\\langle nz \\rangle_{ss} + s p_{\\text{on}} + \\gamma\\mu) $$\n$$ s p_{\\text{on}} + k_{\\text{on}}\\mu - (k_{\\text{on}}+k_{\\text{off}}+\\gamma)\\langle nz \\rangle_{ss} = 0 \\implies \\langle nz \\rangle_{ss} = \\frac{s p_{\\text{on}} + k_{\\text{on}}\\mu}{k_{\\text{on}}+k_{\\text{off}}+\\gamma} $$\n将 $\\langle nz \\rangle_{ss}$ 的表达式代入 $\\langle n^2 \\rangle_{ss}$ 的表达式中：\n$$ \\langle n^2 \\rangle_{ss} = \\frac{s}{\\gamma} \\left( \\frac{s p_{\\text{on}} + k_{\\text{on}}\\mu}{k_{\\text{on}}+k_{\\text{off}}+\\gamma} \\right) + \\frac{s p_{\\text{on}}}{2\\gamma} + \\frac{\\mu}{2} $$\n使用 $\\mu = sp_{\\text{on}}/\\gamma$，我们有 $s p_{\\text{on}} = \\gamma\\mu$。\n$$ \\langle n^2 \\rangle_{ss} = \\frac{s}{\\gamma} \\left( \\frac{\\gamma\\mu + k_{\\text{on}}\\mu}{k_{\\text{on}}+k_{\\text{off}}+\\gamma} \\right) + \\frac{\\gamma\\mu}{2\\gamma} + \\frac{\\mu}{2} = \\frac{s\\mu(k_{\\text{on}}+\\gamma)}{\\gamma(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} + \\mu $$\n方差为 $\\sigma^2 = \\langle n^2 \\rangle_{ss} - \\mu^2$：\n$$ \\sigma^2 = \\mu + \\frac{s\\mu(k_{\\text{on}}+\\gamma)}{\\gamma(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} - \\mu^2 $$\n使用 $\\mu = \\frac{s}{\\gamma} \\frac{k_{\\text{on}}}{k_{\\text{on}}+k_{\\text{off}}}$，我们可以重新整理方差，得到一个更有洞察力的形式：\n$$ \\sigma^2 = \\mu + \\left(\\frac{s}{\\gamma}\\right)^2 \\frac{k_{\\text{on}}k_{\\text{off}}}{(k_{\\text{on}}+k_{\\text{off}})^2(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} $$\n法诺因子是 $F = \\sigma^2/\\mu$。\n$$ F = 1 + \\frac{1}{\\mu} \\left(\\frac{s}{\\gamma}\\right)^2 \\frac{k_{\\text{on}}k_{\\text{off}}}{(k_{\\text{on}}+k_{\\text{off}})^2(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} $$\n代入 $\\mu = \\frac{s}{\\gamma} \\frac{k_{\\text{on}}}{k_{\\text{on}}+k_{\\text{off}}}$：\n$$ F = 1 + \\frac{\\gamma(k_{\\text{on}}+k_{\\text{off}})}{s k_{\\text{on}}} \\left(\\frac{s}{\\gamma}\\right)^2 \\frac{k_{\\text{on}}k_{\\text{off}}}{(k_{\\text{on}}+k_{\\text{off}})^2(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} = 1 + \\frac{s k_{\\text{off}}}{(k_{\\text{on}}+k_{\\text{off}})(k_{\\text{on}}+k_{\\text{off}}+\\gamma)} $$\n这给出了我们的第二个关键关系。现在我们利用这两个关系求解 $k_{\\text{on}}$ 和 $k_{\\text{off}}$：\n1. $\\mu = \\frac{s}{\\gamma} \\frac{k_{\\text{on}}}{k_{\\text{on}}+k_{\\text{off}}}$\n2. $F-1 = \\frac{s k_{\\text{off}}}{(k_{\\text{on}}+k_{\\text{off}})(k_{\\text{on}}+k_{\\text{off}}+\\gamma)}$\n\n从 (1) 可得，我们有 $\\frac{\\gamma\\mu}{s} = \\frac{k_{\\text{on}}}{k_{\\text{on}}+k_{\\text{off}}} = p_{\\text{on}}$。\n这意味着 $1 - \\frac{\\gamma\\mu}{s} = \\frac{k_{\\text{off}}}{k_{\\text{on}}+k_{\\text{off}}} = p_{\\text{off}}$。$k_{\\text{on}}>0, k_{\\text{off}}>0$ 的一个必要条件是 $0 < p_{\\text{on}} < 1$，这要求 $0 < \\mu < s/\\gamma$。\n设 $K = k_{\\text{on}}+k_{\\text{off}}$。代入 (2)：\n$$ F-1 = \\frac{s(K p_{\\text{off}})}{K(K+\\gamma)} = \\frac{s p_{\\text{off}}}{K+\\gamma} = \\frac{s(1-p_{\\text{on}})}{K+\\gamma} = \\frac{s(1-\\frac{\\gamma\\mu}{s})}{K+\\gamma} = \\frac{s-\\gamma\\mu}{K+\\gamma} $$\n求解 $K$：\n$$ K+\\gamma = \\frac{s-\\gamma\\mu}{F-1} \\implies K = \\frac{s-\\gamma\\mu}{F-1} - \\gamma = \\frac{s-\\gamma\\mu - \\gamma(F-1)}{F-1} = \\frac{s+\\gamma-\\gamma(\\mu+F)}{F-1} $$\n为了使 $K$ 为正，给定 $F>1$（如果 $k_{\\text{off}}>0$ 则必须成立），分子必须为正：$s+\\gamma-\\gamma(\\mu+F) > 0$，简化为 $F < 1 + s/\\gamma - \\mu$。\n因此，对于可识别的正有限速率，对测得的 $(\\mu, F)$ 的充分必要条件是：\n- $F > 1$\n- $0 < \\mu < s/\\gamma$\n- $F < 1 + s/\\gamma - \\mu$\n\n在这些条件下，速率常数由以下公式给出：\n$k_{\\text{on}} = K \\cdot p_{\\text{on}} = K \\cdot \\frac{\\gamma\\mu}{s}$\n$k_{\\text{off}} = K \\cdot p_{\\text{off}} = K \\cdot \\left(1-\\frac{\\gamma\\mu}{s}\\right)$\n\n代入 $K$ 的表达式：\n$$ k_{\\text{on}} = \\frac{\\gamma\\mu}{s} \\left(\\frac{s+\\gamma-\\gamma(\\mu+F)}{F-1}\\right) $$\n$$ k_{\\text{off}} = \\frac{s-\\gamma\\mu}{s} \\left(\\frac{s+\\gamma-\\gamma(\\mu+F)}{F-1}\\right) $$\n这些是 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 的矩估计法的闭式解析表达式。", "answer": "$$ \\boxed{ \\begin{pmatrix} k_{\\text{on}} \\\\ k_{\\text{off}} \\end{pmatrix} = \\frac{s+\\gamma-\\gamma(\\mu+F)}{s(F-1)} \\begin{pmatrix} \\gamma\\mu \\\\ s-\\gamma\\mu \\end{pmatrix} } $$", "id": "3356589"}, {"introduction": "在第一个练习的基础上，我们现在提出一个更严谨的问题：我们是否能从单时间点的快照数据中唯一地确定*所有*模型参数？本练习 [@problem_id:3356617] 使用最大似然估计和费雪信息（Fisher Information）的框架来揭示一个根本性的限制。它将证明，即使我们拥有 mRNA 计数的完整分布，也只有生物物理参数的特定*组合*是可识别的，这突出了系统生物学建模中一个被称为“可识别性”（identifiability）的关键概念。", "problem": "一个基因由一个双态启动子转换过程（通常称为电报模型）建模，该模型具有启动子激活速率 $k_{\\text{on}}$、启动子失活速率 $k_{\\text{off}}$、活化态转录起始速率 $s$（分子/单位时间）和信使核糖核酸 (mRNA) 降解速率 $\\gamma$。在稳态下，以及在转录以短暂的活化片段形式发生、其间穿插着较长的非活化时期的转录爆发极限下，通过单分子荧光原位杂交 (smFISH) 测量的单细胞快照 mRNA 计数可以很好地用负二项分布来近似。在这种情况下，计数 $n \\in \\{0,1,2,\\dots\\}$ 的分布具有概率质量函数\n$$\nP(n \\mid r,p) \\;=\\; \\binom{n + r - 1}{n} \\,(1-p)^{r}\\, p^{n}\n$$\n其中形状参数 $r$ 和成功概率 $p$ 通过以下关系与底层的生物物理参数相关联\n$$\nr \\;=\\; \\frac{k_{\\text{on}}}{\\gamma}, \n\\qquad\np \\;=\\; \\frac{b}{1+b},\n\\qquad\nb \\;=\\; \\frac{s}{k_{\\text{off}}}.\n$$\n你在稳态下观察到 $N$ 个独立的单细胞计数 $\\{n_{i}\\}_{i=1}^{N}$。假设除了这些快照计数和上述负二项近似之外，没有可用的额外测量或外部先验。\n\n任务：\n1) 从负二项概率质量函数的定义和 $N$ 个细胞的独立性出发，仅使用上面给出的 $(r,p)$ 和 $\\theta$ 之间的关系，写出作为生物物理参数向量 $\\theta = (k_{\\text{on}},k_{\\text{off}},s,\\gamma)$ 函数的对数似然 $\\ell(k_{\\text{on}},k_{\\text{off}},s,\\gamma \\mid \\{n_{i}\\})$。\n\n2) 推导关于 $(r,p)$ 的得分函数，并通过链式法则使用雅可比矩阵 $\\partial(r,p)/\\partial\\theta$ 来表达关于 $\\theta$ 的得分函数。\n\n3) 使用费雪信息矩阵的标准定义，即对数似然的海森矩阵的负期望，将 $\\theta$ 的费雪信息用 $(r,p)$ 的费雪信息和参数映射的雅可比矩阵来表示。除了上述的爆发极限映射外，不要对参数作任何特殊值的假设。\n\n4) 在所描述的测量情景（仅 smFISH 快照）和上述负二项近似下，判断 $\\theta$ 是否可以从数据中被结构性辨识。特别地，确定在一般参数值下关于 $\\theta$ 的费雪信息矩阵的秩，并说明在大 $N$ 极限下 $\\theta$ 的渐近置信区域的维度。请将这些条件下 $\\theta$ 的费雪信息矩阵的秩作为你的最终答案报告。此秩无需四舍五入，也无需物理单位。", "solution": "该问题要求分析一个四参数转录生物物理模型的结构可辨识性，假定可观测的 mRNA 计数服从一个双参数的负二项分布。分析按要求分四部分进行。\n\n### 第1部分：对数似然函数\n\n单个细胞 mRNA 计数 $n$ 的负二项分布的概率质量函数 (PMF) 给出如下\n$$P(n \\mid r,p) = \\binom{n + r - 1}{n} (1-p)^{r} p^{n}$$\n其中 $r$ 是形状参数，$p$ 是成功概率。我们有 $N$ 个独立的单细胞计数 $\\{n_{i}\\}_{i=1}^{N}$。似然函数是各个概率的乘积：\n$$L(r,p \\mid \\{n_{i}\\}) = \\prod_{i=1}^{N} P(n_i \\mid r,p) = \\prod_{i=1}^{N} \\binom{n_i + r - 1}{n_i} (1-p)^{r} p^{n_i}$$\n对数似然，记作 $\\ell(r,p \\mid \\{n_{i}\\})$，是似然函数的自然对数：\n$$\\ell(r,p \\mid \\{n_{i}\\}) = \\ln L(r,p \\mid \\{n_{i}\\}) = \\sum_{i=1}^{N} \\left[ \\ln\\binom{n_i + r - 1}{n_i} + r\\ln(1-p) + n_i\\ln p \\right]$$\n使用恒等式 $\\binom{n+k-1}{k} = \\frac{\\Gamma(n+k)}{\\Gamma(n+1)\\Gamma(k)}$，其中 $\\Gamma(\\cdot)$ 是伽马函数，我们可以将对数似然重写为：\n$$\\ell(r,p \\mid \\{n_{i}\\}) = \\sum_{i=1}^{N} \\left[ \\ln\\Gamma(n_i + r) - \\ln\\Gamma(r) - \\ln\\Gamma(n_i + 1) + r\\ln(1-p) + n_i\\ln p \\right]$$\n问题指明了统计参数 $(r, p)$ 和生物物理参数 $\\theta = (k_{\\text{on}}, k_{\\text{off}}, s, \\gamma)$ 之间的关系：\n$$r = \\frac{k_{\\text{on}}}{\\gamma}$$\n$$p = \\frac{b}{1+b} \\quad \\text{其中} \\quad b = \\frac{s}{k_{\\text{off}}}$$\n代入 $b$，我们得到 $p = \\frac{s/k_{\\text{off}}}{1+s/k_{\\text{off}}} = \\frac{s}{k_{\\text{off}}+s}$。因此，$1-p = 1 - \\frac{s}{k_{\\text{off}}+s} = \\frac{k_{\\text{off}}}{k_{\\text{off}}+s}$。\n\n通过将 $r$、$p$ 和 $1-p$ 的这些表达式代入 $(r,p)$ 的对数似然函数，我们得到了作为生物物理参数向量 $\\theta$ 函数的对数似然：\n$$\\ell(\\theta \\mid \\{n_i\\}) = \\sum_{i=1}^{N} \\left[ \\ln\\Gamma\\left(n_i + \\frac{k_{\\text{on}}}{\\gamma}\\right) - \\ln\\Gamma\\left(\\frac{k_{\\text{on}}}{\\gamma}\\right) - \\ln\\Gamma(n_i + 1) + \\frac{k_{\\text{on}}}{\\gamma}\\ln\\left(\\frac{k_{\\text{off}}}{k_{\\text{off}}+s}\\right) + n_i\\ln\\left(\\frac{s}{k_{\\text{off}}+s}\\right) \\right]$$\n\n### 第2部分：得分向量\n\n得分向量是关于参数的对数似然函数的梯度。令 $\\psi(\\cdot)$ 表示双伽马函数，$\\psi(z) = \\frac{d}{dz}\\ln\\Gamma(z)$。关于 $(r,p)$ 的得分是 $S_{r,p} = \\nabla_{r,p} \\ell = \\left(\\frac{\\partial \\ell}{\\partial r}, \\frac{\\partial \\ell}{\\partial p}\\right)^T$。\n$$\\frac{\\partial \\ell}{\\partial r} = \\sum_{i=1}^{N} \\left[ \\psi(n_i + r) - \\psi(r) + \\ln(1-p) \\right]$$\n$$\\frac{\\partial \\ell}{\\partial p} = \\sum_{i=1}^{N} \\left[ -\\frac{r}{1-p} + \\frac{n_i}{p} \\right] = -\\frac{Nr}{1-p} + \\frac{\\sum_{i=1}^{N} n_i}{p}$$\n关于 $\\theta$ 的得分可以通过链式法则求得：\n$$S_{\\theta} = \\nabla_{\\theta} \\ell(\\theta) = J^T S_{r,p} = J^T \\nabla_{r,p} \\ell(r(\\theta), p(\\theta))$$\n其中 $J$ 是从 $\\theta$到 $(r,p)$ 变换的雅可比矩阵：\n$$J = \\frac{\\partial(r,p)}{\\partial\\theta} = \\begin{pmatrix} \\frac{\\partial r}{\\partial k_{\\text{on}}} & \\frac{\\partial r}{\\partial k_{\\text{off}}} & \\frac{\\partial r}{\\partial s} & \\frac{\\partial r}{\\partial \\gamma} \\\\ \\frac{\\partial p}{\\partial k_{\\text{on}}} & \\frac{\\partial p}{\\partial k_{\\text{off}}} & \\frac{\\partial p}{\\partial s} & \\frac{\\partial p}{\\partial \\gamma} \\end{pmatrix}$$\n我们计算雅可比矩阵的元素：\n- $\\frac{\\partial r}{\\partial k_{\\text{on}}} = \\frac{1}{\\gamma}$\n- $\\frac{\\partial r}{\\partial k_{\\text{off}}} = 0$\n- $\\frac{\\partial r}{\\partial s} = 0$\n- $\\frac{\\partial r}{\\partial \\gamma} = -\\frac{k_{\\text{on}}}{\\gamma^2}$\n- $\\frac{\\partial p}{\\partial k_{\\text{on}}} = 0$\n- $\\frac{\\partial p}{\\partial k_{\\text{off}}} = \\frac{\\partial}{\\partial k_{\\text{off}}}\\left(\\frac{s}{k_{\\text{off}}+s}\\right) = -\\frac{s}{(k_{\\text{off}}+s)^2}$\n- $\\frac{\\partial p}{\\partial s} = \\frac{\\partial}{\\partial s}\\left(\\frac{s}{k_{\\text{off}}+s}\\right) = \\frac{(k_{\\text{off}}+s) - s}{(k_{\\text{off}}+s)^2} = \\frac{k_{\\text{off}}}{(k_{\\text{off}}+s)^2}$\n- $\\frac{\\partial p}{\\partial \\gamma} = 0$\n\n雅可比矩阵为：\n$$J = \\begin{pmatrix} 1/\\gamma & 0 & 0 & -k_{\\text{on}}/\\gamma^2 \\\\ 0 & -s/(k_{\\text{off}}+s)^2 & k_{\\text{off}}/(k_{\\text{off}}+s)^2 & 0 \\end{pmatrix}$$\n\n### 第3部分：费雪信息矩阵\n\n参数向量 $\\phi$ 的费雪信息矩阵 (FIM) 定义为 $I(\\phi) = -E[\\nabla_{\\phi} \\nabla_{\\phi}^T \\ell(\\phi)]$。一个等价的定义是 $I(\\phi) = E[S_{\\phi} S_{\\phi}^T]$。对于重参数化 $\\phi = f(\\theta)$，$\\theta$ 的 FIM 通过公式 $I(\\theta) = J^T I(\\phi) J$ 与 $\\phi$ 的 FIM 相关联，其中 $J$ 是雅可比矩阵 $\\partial\\phi/\\partial\\theta$。\n\n在我们的案例中，可观测参数是 $\\phi=(r,p)$，生物物理参数是 $\\theta=(k_{\\text{on}}, k_{\\text{off}}, s, \\gamma)$。使用在第2部分中推导的雅可比矩阵 $J$ 的公式，$\\theta$ 的 FIM 用 $(r,p)$ 的 FIM 表示如下：\n$$I(\\theta) = J^T I(r,p) J$$\n\n### 第4部分：结构可辨识性与 FIM 秩\n\n如果一个参数向量 $\\theta$ 的值可以从理想（无限且无噪声的）数据中唯一确定，则称其为结构可辨识的。在最大似然估计的背景下，局部结构可辨识性要求费雪信息矩阵 $I(\\theta)$ 是非奇异的，即满秩。\n\n参数向量 $\\theta$ 的维度为 $4$。因此，$I(\\theta)$ 是一个 $4 \\times 4$ 的矩阵。参数向量 $(r,p)$ 的维度为 $2$，对于负二项分布，其 FIM, $I(r,p)$，对于任何有效的参数值（$r>0, 0<p<1$）是满秩的（即秩 2），并且是一个 $2 \\times 2$ 的矩阵。\n\n$\\theta$ 的 FIM 的秩由雅可比矩阵 $J$ 的秩决定，因为 $I(r,p)$ 是满秩的。根据线性代数，$\\text{rank}(A^T B A) = \\text{rank}(A)$，如果 $B$ 是满秩的。因此，$\\text{rank}(I(\\theta)) = \\text{rank}(J^T I(r,p) J) = \\text{rank}(J)$。\n我们来评估雅可比矩阵 $J$ 的秩。\n$$J = \\begin{pmatrix} 1/\\gamma & 0 & 0 & -k_{\\text{on}}/\\gamma^2 \\\\ 0 & -s/(k_{\\text{off}}+s)^2 & k_{\\text{off}}/(k_{\\text{off}}+s)^2 & 0 \\end{pmatrix}$$\n这是一个 $2 \\times 4$ 的矩阵。它的秩最多为 $\\min(2, 4) = 2$。只要矩阵的行不是零向量并且它们之间不是线性相关的，秩就恰好为 $2$。对于一般的生物物理参数值（即所有速率常数都为正且有限），第一行和第二行都是非零的。第一行在第 2 和第 3 个位置有零，而第二行在这些位置有非零项。因此，这两行是线性无关的。\n所以，$J$ 的秩为 $2$。\n\n这意味着 $I(\\theta)$ 的秩也为 $2$。由于 $\\theta$ 的维度是 $4$，而 FIM 的秩是 $2$，所以该矩阵是奇异的。渐近置信区域的维度等于 FIM 的秩，即 $2$。这表明参数是不可辨识的；具体来说，我们只能唯一地确定参数的两个组合（例如 $r$ 和 $p$），而不是所有四个单独的参数。存在一个维度为 $4 - 2 = 2$ 的不可辨识子空间。\n因此，FIM 的秩是 2。", "answer": "$$\\boxed{2}$$", "id": "3356617"}, {"introduction": "快照数据的局限性自然而然地将我们引向延时显微成像技术，该技术可以实时观察启动子活动。然而，收集此类数据本身也带来了挑战。本练习 [@problem_id:3356548] 深入探讨了实验设计的实际问题，迫使我们思考采样频率（帧率）$\\Delta t$ 的选择如何影响我们精确测量启动子停留时间的能力，并避免信号处理中被称为“混叠”（aliasing）的陷阱。", "problem": "您正在设计一个活体单细胞转录成像实验，该实验针对一个其启动子可以用双态启动子转换模型很好地描述的基因：该启动子作为一个连续时间马尔可夫链，在 OFF 态和 ON 态之间交替转换，其从 OFF 态到 ON 态的转换速率为 $k_{\\text{on}}$，从 ON 态到 OFF 态的转换速率为 $k_{\\text{off}}$。在 ON 态下，聚合酶起始的亮度足够高，因此在成像帧时刻可以通过阈值化处理来判断启动子状态，而不会出现状态错分。在每个状态的驻留时间均服从指数分布，OFF 态的平均驻留时间为 $1/k_{\\text{on}}$，ON 态的平均驻留时间为 $1/k_{\\text{off}}$。一个设计团队提议通过对连续长度（即在每个状态下观察到的连续帧数乘以帧间隔 $\\Delta t$）进行指数拟合来估计 $k_{\\text{on}}$ 和 $k_{\\text{off}}$。\n\n给定科学上合理的先验估计值：$k_{\\text{on}} = 0.06 \\ \\text{min}^{-1}$ 和 $k_{\\text{off}} = 0.50 \\ \\text{min}^{-1}$。为了选择一个既能分辨 ON 和 OFF 驻留时间，又不会产生显著混叠的帧间隔，该团队采用了以下保守标准：无论启动子在时间间隔开始时处于何种状态，在单个帧间隔内观察到两次或两次以上状态转换的概率最多为 $1\\%$。假设小 $\\Delta t$ 近似对于界定此类概率是有效的。\n\n基于连续时间双态马尔可夫转换的基本原理和所述的估计方法，下列哪个选项是满足设计标准的最大帧间隔 $\\Delta t$？如果数据是在 $\\Delta t = 1 \\ \\text{min}$ 的条件下采集，并按上文所述通过对观测到的连续长度进行朴素指数拟合来分析，那么混叠引起的推断速率偏差的定性方向是什么？\n\nA. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会低估 $k_{\\text{on}}$ 和 $k_{\\text{off}}$，因为短暂的中断被合并到更长的表观连续长度中。\n\nB. $\\Delta t_{\\max} \\approx 2 \\ \\text{min}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会高估 $k_{\\text{off}}$ 并低估 $k_{\\text{on}}$。\n\nC. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会高估 $k_{\\text{on}}$ 和 $k_{\\text{off}}$，因为长的连续长度被碎片化了。\n\nD. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合使 $k_{\\text{on}}$ 近似无偏，但会低估 $k_{\\text{off}}$。", "solution": "用户希望我解决一个关于如何从延时成像数据中估计双态启动子转换模型参数的问题。\n\n### 问题陈述验证\n\n首先，我将验证问题陈述。\n\n**第一步：提取给定信息**\n*   **模型：** 用于描述启动子在 OFF 态和 ON 态之间转换的连续时间马尔可夫链。\n*   **参数：**\n    *   OFF 到 ON 的转换速率：$k_{\\text{on}}$\n    *   ON 到 OFF 的转换速率：$k_{\\text{off}}$\n*   **驻留时间分布：**\n    *   在 OFF 态的时间服从指数分布，平均值为 $1/k_{\\text{on}}$。\n    *   在 ON 态的时间服从指数分布，平均值为 $1/k_{\\text{off}}$。\n*   **观测：** 在离散的帧时刻以间隔 $\\Delta t$ 观测启动子状态。状态分类是完美的（无错分）。\n*   **估计方法：** 对观测到的连续长度进行指数分布拟合。连续长度等于一个状态下的连续帧数乘以 $\\Delta t$。\n*   **先验估计：** $k_{\\text{on}} = 0.06 \\ \\text{min}^{-1}$ 和 $k_{\\text{off}} = 0.50 \\ \\text{min}^{-1}$。\n*   **设计标准：** 在单个帧间隔 $\\Delta t$ 内观测到两次或两次以上状态转换的概率必须最多为 $1\\%$ ($0.01$)，无论起始状态如何。\n*   **近似：** 认为小 $\\Delta t$ 近似对于界定这些概率是有效的。\n*   **问题：**\n    1.  满足设计标准的最大帧间隔 $\\Delta t_{\\max}$ 是多少？\n    2.  如果数据是在 $\\Delta t = 1 \\ \\text{min}$ 的条件下采集的，那么通过所述的朴素拟合方法推断出的速率，其偏差的定性方向是什么？\n\n**第二步：使用提取的给定信息进行验证**\n*   **科学依据：** 启动子动力学的双态模型是计算系统生物学中描述转录爆发的一个基础且广泛使用的模型。将该系统描述为具有指数驻留时间的连续时间马尔可夫链是标准的数学表述。给定的参数值对于真核基因是符合生物学实际的。\n*   **良态性：** 问题是良态的（定义明确的）。它提供了一个清晰的数学模型、足够的数据和一个量化标准来确定一个具体的值（$\\Delta t_{\\max}$）。它还要求对一个明确定义的场景（混叠）进行定性分析。可以推导出一个唯一的解。\n*   **客观性：** 问题以精确、技术性的语言陈述，没有主观性或歧义。像“朴素指数拟合”这样的术语在问题设定的背景下是清晰的。\n\n**第三步：结论与行动**\n问题陈述在科学上是合理的、良态的且客观的。它不包含任何使其无效的缺陷。我将着手解决它。\n\n### 解题推导\n\n该问题包含两部分：计算最大允许帧间隔 $\\Delta t_{\\max}$，以及分析使用一个更容易产生混叠的较大帧间隔所带来的偏差。\n\n**第一部分：计算 $\\Delta t_{\\max}$**\n\n标准是在一个间隔 $\\Delta t$ 内观测到两次或两次以上状态转换的概率最多为 $P_{\\text{crit}} = 0.01$。这必须在无论起始状态是 ON 还是 OFF 的情况下都成立。问题明确指出这是一个“保守标准”，并且“小 $\\Delta t$ 近似是有效的”。\n\n我们首先推导两次或多次转换的概率。对于一个小间隔 $\\Delta t$，三次或更多次转换的概率是 $(\\Delta t)^3$ 或更高阶的，可以忽略不计。因此，$P(\\ge 2 \\text{ 次转换}) \\approx P(2 \\text{ 次转换})$。\n\n考虑系统从 OFF 态开始。要发生两次转换，序列必须是 OFF $\\to$ ON $\\to$ OFF。在 $\\Delta t$ 内发生此序列的概率为：\n$$ P(2 \\text{ 次转换 } | \\text{从 OFF 开始}) = \\int_0^{\\Delta t} k_{\\text{on}} e^{-k_{\\text{on}}t_1} \\left( 1 - e^{-k_{\\text{off}}(\\Delta t - t_1)} \\right) dt_1 $$\n对于小 $\\Delta t$，我们可以近似被积函数：$e^{-k_{\\text{on}}t_1} \\approx 1$ 和 $1 - e^{-k_{\\text{off}}(\\Delta t - t_1)} \\approx k_{\\text{off}}(\\Delta t - t_1)$。\n$$ P(2 \\text{ 次转换 } | \\text{从 OFF 开始}) \\approx \\int_0^{\\Delta t} k_{\\text{on}} k_{\\text{off}}(\\Delta t - t_1) dt_1 = \\frac{1}{2} k_{\\text{on}} k_{\\text{off}} (\\Delta t)^2 $$\n对于从 ON 态开始的对称论证（序列 ON $\\to$ OFF $\\to$ ON）得出：\n$$ P(2 \\text{ 次转换 } | \\text{从 ON 开始}) \\approx \\frac{1}{2} k_{\\text{off}} k_{\\text{on}} (\\Delta t)^2 $$\n对于两种起始状态，一阶近似是相同的。\n\n然而，问题使用了“保守标准”一词。这表明应采用一个更简单、更严格的界限。在此类问题中，一种常见的保守方法是通过考虑最坏情况来界定概率。速率是不对称的：$k_{\\text{off}} = 0.50 \\ \\text{min}^{-1} > k_{\\text{on}} = 0.06 \\ \\text{min}^{-1}$。较高的速率常数导致更快的动力学。可以通过将所有速率替换为最大速率 $k_{\\max} = \\max(k_{\\text{on}}, k_{\\text{off}}) = k_{\\text{off}}$ 来建立一个保守界限。两次转换的概率将由一个速率为 $k_{\\text{off}}$ 的对称系统中的概率来界定。\n$$ P(\\ge 2 \\text{ 次转换}) \\le P_{\\text{bound}} \\approx \\frac{1}{2} (k_{\\max})^2 (\\Delta t)^2 = \\frac{1}{2} k_{\\text{off}}^2 (\\Delta t)^2 $$\n应用该标准：$\\frac{1}{2} (0.50 \\ \\text{min}^{-1})^2 (\\Delta t)^2 \\le 0.01$，这得出 $\\Delta t \\le \\sqrt{0.08} \\approx 0.283 \\ \\text{min} \\approx 17 \\ \\text{s}$。这与一个选项答案很接近。\n\n一个更简单且更常见的对“保守标准”的解释，是在信号处理中建立一个经验法则，以限制由更快过程引起的哪怕是单次转换的概率。一个非常常见的经验法则是，无量纲量 $k \\Delta t$ 应该很小，例如 $\\le 0.1$。如果我们将标准 $P(\\ge 2 \\text{ 次转换}) \\le 0.01$ 解释为由一个粗略的界限如 $(k_{\\max}\\Delta t)^2 \\le 0.01$ 来近似，我们得到：\n$$ (k_{\\text{off}} \\Delta t)^2 \\le 0.01 $$\n$$ k_{\\text{off}} \\Delta t \\le \\sqrt{0.01} = 0.1 $$\n这是一个众所周知的启发式方法，用于确保随机过程的模拟是稳定和准确的。让我们解出 $\\Delta t$：\n$$ \\Delta t \\le \\frac{0.1}{k_{\\text{off}}} = \\frac{0.1}{0.50 \\ \\text{min}^{-1}} = 0.2 \\ \\text{min} $$\n转换为秒：\n$$ \\Delta t_{\\max} = 0.2 \\ \\text{min} \\times 60 \\ \\frac{\\text{s}}{\\text{min}} = 12 \\ \\text{s} $$\n这个结果与选项 A、C 和 D 中的值完全匹配，使其成为最有可能的预期计算路径。\n\n**第二部分：对 $\\Delta t = 1 \\ \\text{min}$ 的定性偏差分析**\n\n现在我们分析使用 $\\Delta t = 1 \\ \\text{min}$ 进行采样的后果，这个时间远长于计算出的 $\\Delta t_{\\max}$。\n\n真实的平均驻留时间是：\n*   平均 ON 时间：$T_{\\text{ON}} = 1/k_{\\text{off}} = 1/0.50 \\ \\text{min}^{-1} = 2 \\ \\text{min}$。\n*   平均 OFF 时间：$T_{\\text{OFF}} = 1/k_{\\text{on}} = 1/0.06 \\ \\text{min}^{-1} \\approx 16.7 \\ \\text{min}$。\n\n采样间隔 $\\Delta t = 1 \\ \\text{min}$ 应与这些时间尺度进行比较：\n*   $\\Delta t$ 远小于平均 OFF 时间（$1 \\ \\text{min} \\ll 16.7 \\ \\text{min}$）。大多数 OFF 时期将被正确捕获。\n*   $\\Delta t$ 与平均 ON 时间在同一数量级（$1 \\ \\text{min}$ vs $2 \\ \\text{min}$）。由于驻留时间的指数分布，相当一部分的 ON 时期将短于 $\\Delta t$。ON 驻留时间小于 $1 \\ \\text{min}$ 的概率是 $P(T_{\\text{ON}} < 1 \\ \\text{min}) = 1 - e^{-k_{\\text{off}} \\times 1} = 1 - e^{-0.5} \\approx 0.39$。\n\n这种短 ON 时期的频繁出现导致时间混叠。\n1.  **错失事件：** 一个在两个连续成像帧之间（例如，在 $t=0$ 和 $t=1 \\ \\text{min}$）开始和结束的 ON 时期将被完全错过。系统在这两个时间点都将被观测为 OFF 态。\n2.  **对连续长度测量的影响：** 当一个较长的 OFF 时期中的短暂 ON“中断”被错过时，分析软件会看到一个单一、连续的 OFF 连续段。这人为地将本应是两个独立的 OFF 连续段和一个 ON 连续段合并在一起。\n\n**估计参数中的偏差：**\n“朴素指数拟合”将观测到的连续长度的分布当作是真实的驻留时间分布。\n*   **$k_{\\text{on}}$ 的偏差：** 速率 $k_{\\text{on}}$ 是从观测到的平均 OFF 时间估计的（$k_{\\text{on, est}} = 1/\\bar{T}_{\\text{OFF, obs}}$）。因为一些 OFF 连续段由于错过了 ON 事件而被合并从而被人为地拉长，所以观测到的平均 OFF 时间将长于真实的平均 OFF 时间（$\\bar{T}_{\\text{OFF, obs}} > \\bar{T}_{\\text{OFF, true}}$）。因此，估计的速率 $k_{\\text{on, est}}$ 将小于真实速率 $k_{\\text{on}}$。**$k_{\\text{on}}$ 被低估了。**\n*   **$k_{\\text{off}}$ 的偏差：** 速率 $k_{\\text{off}}$ 是从观测到的平均 ON 时间估计的（$k_{\\text{off, est}} = 1/\\bar{T}_{\\text{ON, obs}}$）。采样过程系统性地无法检测到最短的 ON 事件。因此，观测到的 ON 连续段集合是一个有偏样本，只包含足够长以被检测到的连续段。这导致对平均 ON 时间的高估（$\\bar{T}_{\\text{ON, obs}} > \\bar{T}_{\\text{ON, true}}$）。因此，估计的速率 $k_{\\text{off, est}}$ 将小于真实速率 $k_{\\text{off}}$。**$k_{\\text{off}}$ 被低估了。**\n\n两种速率都被低估了，因为混叠效应（错过短暂的中断）使得观测到的 ON 和 OFF 连续段平均看起来都更长。\n\n### 逐项分析\n\n*   **A. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会低估 $k_{\\text{on}}$ 和 $k_{\\text{off}}$，因为短暂的中断被合并到更长的表观连续长度中。**\n    *   $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$ 的计算与对“保守标准”的合理解释是一致的。\n    *   偏差分析正确地指出 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 都被低估了。\n    *   给出的原因，“短暂的中断被合并到更长的表观连续长度中”，是对偏差的正确物理解释。\n    *   **结论：正确。**\n\n*   **B. $\\Delta t_{\\max} \\approx 2 \\ \\text{min}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会高估 $k_{\\text{off}}$ 并低估 $k_{\\text{on}}$。**\n    *   $\\Delta t_{\\max} \\approx 2 \\ \\text{min} = 120 \\ \\text{s}$ 是不正确的；这个值太大了。\n    *   偏差分析不正确；一个关键效应是 $k_{\\text{off}}$ 的低估，而不是高估。\n    *   **结论：不正确。**\n\n*   **C. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合会高估 $k_{\\text{on}}$ 和 $k_{\\text{off}}$，因为长的连续长度被碎片化了。**\n    *   $\\Delta t_{\\max}$ 的值是正确的。\n    *   偏差分析不正确；两种速率都被低估了。给出的原因（“碎片化”）与由错失事件引起的实际合并效应相反。碎片化是由状态错分引起的，而问题排除了这一点。\n    *   **结论：不正确。**\n\n*   **D. $\\Delta t_{\\max} \\approx 12 \\ \\text{s}$；在 $\\Delta t = 1 \\ \\text{min}$ 时，朴素连续长度拟合使 $k_{\\text{on}}$ 近似无偏，但会低估 $k_{\\text{off}}$。**\n    *   $\\Delta t_{\\max}$ 的值是正确的。\n    *   偏差分析部分不正确。虽然它正确地指出 $k_{\\text{off}}$ 被低估，但它错误地声称 $k_{\\text{on}}$ 近似无偏。OFF 连续段的合并导致对 $k_{\\text{on}}$ 的显著低估。\n    *   **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3356548"}]}