{"hands_on_practices": [{"introduction": "在计算系统生物学中，我们经常处理基因数量 $p$ 远大于样本数量 $n$ 的高维数据集。这种“$p \\gg n$”的情形对主成分分析（PCA）施加了一个基本的数学约束。本练习旨在通过线性代数的基本原理，揭示样本协方差矩阵的秩与样本数量之间的内在联系，从而确定在数据中心化后可能存在的非零特征值的最大数量。理解这一固有的维度限制，对于正确解释PCA结果和避免将噪声误判为信号至关重要。 [@problem_id:3302515]", "problem": "您正在计算系统生物学中分析一个转录组数据集，其中测量了 $p$ 个基因在 $n$ 个生物样本中的表达水平，且 $p \\gg n$。令 $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$ 表示样本-基因数据矩阵，其 $(i,j)$ 元素是基因 $j$ 在样本 $i$ 中的表达水平。令 $\\mathbf{X}_{c}$ 表示列中心化矩阵，该矩阵通过从 $\\mathbf{X}$ 中为每个基因 $j$ 减去其样本均值得到，因此 $\\mathbf{X}_{c}$ 的每一列在样本间的均值为 0。考虑特征-特征样本协方差矩阵\n$$\n\\mathbf{S} \\;=\\; \\frac{1}{n-1}\\,\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c} \\;\\in\\; \\mathbb{R}^{p \\times p},\n$$\n这是在主成分分析 (PCA) 中被对角化的对象，其中主成分分析 (PCA) 是沿着由 $\\mathbf{S}$ 的特征向量定义的主方向对特征方差进行的正交分解。仅使用基本的线性代数定义以及中心化和协方差的性质，确定在 $p \\gg n$ 的情况下，$\\mathbf{S}$ 的非零特征值的最大可能数量。通过明确解释跨 $n$ 个样本的中心化操作在 $\\mathbf{X}_{c}$ 的列之间引入的线性相关性结构，来证明此限制的合理性。以一个关于 $n$ 和 $p$ 的、针对 $p \\gg n$ 情况的单一闭式表达式给出您的最终答案。无需四舍五入，也不涉及单位。", "solution": "目标是确定特征-特征样本协方差矩阵 $\\mathbf{S} = \\frac{1}{n-1}\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c}$ 的非零特征值的最大可能数量。\n\n线性代数中的一个基本定理指出，任何方阵的非零特征值的数量等于其秩。因此，问题等价于确定矩阵 $\\mathbf{S}$ 的最大可能秩。\n\n矩阵 $\\mathbf{S}$ 定义为 $\\mathbf{S} = \\frac{1}{n-1}\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c}$。标量因子 $\\frac{1}{n-1}$ 是非零的（假设 $n > 1$，这是计算协方差所必需的），并且不影响矩阵的秩。因此，我们有：\n$$\n\\text{rank}(\\mathbf{S}) = \\text{rank}\\left(\\frac{1}{n-1}\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c}\\right) = \\text{rank}(\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c})\n$$\n线性代数的另一个基本性质指出，对于任何矩阵 $\\mathbf{A}$，$\\mathbf{A}^{\\top}\\mathbf{A}$ 的秩等于 $\\mathbf{A}$ 的秩。即 $\\text{rank}(\\mathbf{A}^{\\top}\\mathbf{A}) = \\text{rank}(\\mathbf{A})$。将此性质应用于矩阵 $\\mathbf{X}_{c} \\in \\mathbb{R}^{n \\times p}$，我们得到：\n$$\n\\text{rank}(\\mathbf{S}) = \\text{rank}(\\mathbf{X}_{c}^{\\top}\\mathbf{X}_{c}) = \\text{rank}(\\mathbf{X}_{c})\n$$\n问题现在简化为求列中心化数据矩阵 $\\mathbf{X}_{c}$ 的最大可能秩。\n\n矩阵 $\\mathbf{X}_{c}$ 的维度是 $n \\times p$。任何矩阵的秩都不能超过其行数和列数的最小值。因此，$\\text{rank}(\\mathbf{X}_{c}) \\le \\min(n, p)$。在给定的 $p \\gg n$ 情况下，这意味着 $\\min(n, p) = n$，所以我们有一个初始上界：\n$$\n\\text{rank}(\\mathbf{X}_{c}) \\le n\n$$\n然而，我们必须考虑列中心化操作所施加的约束。问题指出，$\\mathbf{X}_{c}$ 是通过从原始数据矩阵 $\\mathbf{X}$ 的每一列中减去样本均值得到的。令 $\\mathbf{x}_{c,j}$ 表示 $\\mathbf{X}_{c}$ 的第 $j$ 列，它是一个 $\\mathbb{R}^n$ 中的向量。中心化条件意味着每列向量中元素的和为零：\n$$\n\\sum_{i=1}^{n} (\\mathbf{X}_{c})_{ij} = 0 \\quad \\text{for all } j \\in \\{1, 2, \\dots, p\\}\n$$\n这可以用向量表示法来表达。令 $\\mathbf{1}_{n} \\in \\mathbb{R}^n$ 为一个包含 $n$ 个 1 的列向量。中心化条件等价于每个列向量 $\\mathbf{x}_{c,j}$ 都与 $\\mathbf{1}_{n}$ 正交的陈述：\n$$\n\\mathbf{1}_{n}^{\\top}\\mathbf{x}_{c,j} = 0 \\quad \\text{for all } j \\in \\{1, 2, \\dots, p\\}\n$$\n这个约束有一个关键的几何解释：矩阵 $\\mathbf{X}_{c}$ 的所有 $p$ 个列向量都必须位于 $\\mathbb{R}^n$ 中与向量 $\\mathbf{1}_{n}$ 正交的子空间内。这个子空间通常表示为 $\\mathbf{1}_{n}^{\\perp}$，其维度为 $n-1$。\n\n矩阵的秩定义为其列空间的维度。$\\mathbf{X}_{c}$ 的列空间是由其 $p$ 个列向量 $\\text{span}\\{\\mathbf{x}_{c,1}, \\mathbf{x}_{c,2}, \\dots, \\mathbf{x}_{c,p}\\}$ 张成的向量空间。由于这些向量中的每一个都局限于一个 $(n-1)$ 维的子空间中，它们张成的空间的维度不能超过 $n-1$。因此，$\\mathbf{X}_{c}$ 的秩的上界为 $n-1$：\n$$\n\\text{rank}(\\mathbf{X}_{c}) \\le n-1\n$$\n如果原始数据 $\\mathbf{X}$ 足够通用，这个上界是可以达到的。例如，如果我们取 $\\mathbf{X}$ 的 $n-1$ 个列是线性无关的，并且不完全位于 $\\mathbf{1}_n$ 的张成空间中，它们在子空间 $\\mathbf{1}_{n}^{\\perp}$ 上的投影也将是线性无关的。因此，$\\mathbf{X}_{c}$ 的*最大可能*秩恰好是 $n-1$。\n\n$p \\gg n$ 的情况是关键。由于 $p > n-1$，我们有一组 $p$ 个向量位于一个 $(n-1)$ 维空间中。这保证了 $\\mathbf{X}_{c}$ 的列向量集合必须是线性相关的，并且矩阵的秩受限于这个子空间的维度 ($n-1$)，而不是特征的数量 ($p$)。\n\n总结如下：\n1. $\\mathbf{S}$ 的非零特征值的数量等于 $\\text{rank}(\\mathbf{S})$。\n2. $\\text{rank}(\\mathbf{S}) = \\text{rank}(\\mathbf{X}_{c})$。\n3. 中心化操作将 $\\mathbf{X}_{c}$ 的列约束在 $\\mathbb{R}^n$ 的一个 $(n-1)$ 维子空间中。\n4. 因此，$\\mathbf{X}_{c}$ 的最大可能秩是 $n-1$。\n\n在 $p \\gg n$ 的情况下，$\\mathbf{S}$ 的非零特征值的最大可能数量是 $n-1$。", "answer": "$$\n\\boxed{n-1}\n$$", "id": "3302515"}, {"introduction": "主成分分析不仅是一种探索性工具，也常被用作构建预测模型的降维预处理步骤。然而，当将PCA整合到交叉验证工作流中时，一个常见的严重错误是“数据泄漏”。本练习通过对比两种流程，阐明了为何必须在每个训练折叠（training fold）上重新拟合PCA，以及为何未能这样做会导致模型性能评估出现乐观偏差，甚至扭曲对生物学重要性的解释。掌握在验证框架内正确应用PCA的方法，是从数据探索到构建可靠预测模型的关键一步。 [@problem_id:3321102]", "problem": "一个研究团队正在分析一个单细胞核糖核酸测序（RNA-seq）数据集，以发现与免疫刺激相关的通路级别变异。该数据集包含一个基因表达矩阵，其中有 $n = 2000$ 个细胞和 $p = 10000$ 个基因，以及一个二元条件标签，用于指示刺激组与对照组。他们计划使用主成分分析（PCA）进行降维，然后使用一个通过 $K$-折交叉验证（其中 $K = 5$）评估的分类器。预处理流程包括对每个基因进行中心化和缩放。\n\n考虑了两种流程：\n\n- 流程 $\\mathcal{T}$：在每一折中，仅使用该折的训练数据重新拟合PCA，以估计载荷和中心化/缩放参数。留出的细胞通过应用训练折的中心化/缩放并投影到训练折的载荷上进行转换，以获得主成分分数。分类器在训练折的分数上进行训练，并在留出分数上进行评估。\n\n- 流程 $\\mathcal{L}$：PCA使用所有 $n$ 个细胞拟合一次，以估计载荷和中心化/缩放参数。在每一折中，训练细胞和留出细胞都使用这些全局参数和载荷进行转换。分类器的训练和评估方式与流程 $\\mathcal{T}$ 中相同。\n\n经验上，当使用 $m = 20$ 个主成分时，流程 $\\mathcal{L}$ 产生的交叉验证的受试者工作特征曲线下面积（AUROC）比流程 $\\mathcal{T}$ 稍高，并且研究团队还观察到前几个主成分与条件标签高度一致。\n\n基于PCA的核心定义（即训练数据协方差的方差最大化标准正交方向）以及交叉验证估计要求从训练中派生的转换与留出评估之间保持独立的原则，回答以下多项选择题：\n\n关于为什么PCA必须仅在训练折上重新拟合，并且留出分数需要通过投影计算，以及数据泄漏如何引入解释性偏差，以下哪些陈述是正确的？\n\nA. 在$K$-折交叉验证中，对所有$n$个样本拟合PCA会导致数据泄漏，因为特征向量依赖于留出数据，这使得下游的性能估计（例如AUROC）产生乐观偏差。\n\nB. 获取留出主成分分数的有效方法是，使用训练折的统计数据对留出样本进行中心化和缩放，然后投影到训练折的载荷向量上；这保持了无偏风险估计所需的独立性。\n\nC. 因为PCA是无监督的且不使用标签，所以在交叉验证中对完整数据集拟合PCA是可接受的，并且不会引入数据泄漏。\n\nD. PCA中的数据泄漏会使生物学解释产生偏差：具有较大绝对载荷的基因可能会被过分强调其对于条件分离具有生物学重要性，因为载荷受到了留出数据结构的影响，从而混淆了探索性分析和验证性分析。\n\nE. 在每个折的训练数据上重新拟合PCA会使得不同折之间的成分方向不可比较，从而使得通路级别的解释在形式上无效，即使存在跨折一致的模式。\n\n选择所有适用项。", "solution": "问题陈述展示了一个在$K$-折交叉验证框架内，比较两种数据分析流程（$\\mathcal{T}$ 和 $\\mathcal{L}$）处理单细胞RNA-seq数据集的场景。问题的核心在于如何正确应用主成分分析（PCA）作为后续分类任务的预处理步骤，以及不正确应用（数据泄漏）对性能评估和生物学解释的影响。\n\n首先，我们来形式化这个过程。数据集是一个矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$，其中有 $n=2000$ 个细胞和 $p=10000$ 个基因。每个细胞都有一个二元标签。$K$-折交叉验证的目标是将数据划分为 $K$ 个折，对于每一折 $k \\in \\{1, ..., K\\}$，将第 $k$ 折作为留出的测试集，其余 $K-1$ 折作为训练集。这个过程重复 $K$ 次，然后将性能指标（如AUROC）在所有折上取平均。其基本原则是，任何一折的测试集都必须与整个模型拟合过程完全独立，这包括任何依赖于数据的预处理步骤。\n\n流程 $\\mathcal{L}$ 违反了这一原则。它在交叉验证循环*之前*对整个数据集 $\\mathbf{X}$ 进行PCA拟合。这意味着中心化参数（均值 $\\boldsymbol{\\mu}$）、缩放参数（标准差 $\\boldsymbol{\\sigma}$）和PCA载荷向量（整个数据集协方差矩阵的特征向量，我们可以表示为 $\\mathbf{W}$）都是使用所有 $n$ 个细胞的信息来确定的。在每个交叉验证折中，留出的数据都是用于计算 $\\boldsymbol{\\mu}$、$\\boldsymbol{\\sigma}$ 和 $\\mathbf{W}$ 的数据集的一部分。这就构成了数据泄漏。\n\n流程 $\\mathcal{T}$ 代表了正确的程序。在每一折 $k$ 中，中心化参数 $\\boldsymbol{\\mu}^{(k)}$、缩放参数 $\\boldsymbol{\\sigma}^{(k)}$ 和载荷向量 $\\mathbf{W}^{(k)}$ *仅*使用该折的训练数据来估计。然后，使用这些预先确定的、特定于训练折的参数来转换留出的数据。这模拟了一个真实世界的应用场景：在可用数据上训练模型流程，然后应用于新的、未见过的数据，从而提供对模型泛化性能的无偏估计。\n\n经验观察到流程 $\\mathcal{L}$ 比流程 $\\mathcal{T}$ 产生更高的AUROC，这是数据泄漏的典型症状。流程 $\\mathcal{L}$ 中的模型具有不公平的优势，因为它使用的特征空间（主成分）是在部分了解测试集数据结构的情况下构建的。\n\n在确立了这些原则之后，我们来评估每个陈述。\n\n**A. 在$K$-折交叉验证中，对所有$n$个样本拟合PCA会导致数据泄漏，因为特征向量依赖于留出数据，这使得下游的性能估计（例如AUROC）产生乐观偏差。**\n\n这个陈述是正确的。PCA找到数据协方差矩阵的特征向量（载荷）。在流程 $\\mathcal{L}$ 中，协方差矩阵是根据所有 $n$ 个样本计算的。因此，对于任何给定的折，留出集中的数据都影响了这些特征向量的计算。这些特征向量定义了所有数据（包括留出数据）被投影到的坐标系。因为应用于留出数据的转换依赖于该数据本身，所以无偏性能估计所需的独立性被破坏了。这种从测试集到模型训练过程的信息泄漏通常会导致过于乐观的性能估计。观察到流程 $\\mathcal{L}$ 具有更高的AUROC是这种乐观偏差的直接后果。\n**结论：正确。**\n\n**B. 获取留出主成分分数的有效方法是，使用训练折的统计数据对留出样本进行中心化和缩放，然后投影到训练折的载荷向量上；这保持了无偏风险估计所需的独立性。**\n\n这个陈述准确地描述了正确的程序，即流程 $\\mathcal{T}$ 所体现的程序。为了获得泛化误差（或风险）的无偏估计，整个模型拟合过程必须对测试集“不可见”。这个“过程”包括所有依赖于数据的转换。因此，用于中心化和缩放的统计数据（均值和标准差）以及PCA载荷向量必须仅从给定折的训练数据中计算。然后，使用这些固定的、从训练中派生的参数来转换留出的数据。这个程序保持了模型开发生态系统与用于评估的数据之间的关键独立性，这是有效交叉验证的基石。\n**结论：正确。**\n\n**C. 因为PCA是无监督的且不使用标签，所以在交叉验证中对完整数据集拟合PCA是可接受的，并且不会引入数据泄漏。**\n\n这个陈述是错误的，它阐述了一个常见但至关重要的谬误。PCA是“无监督的”（即它不使用类别标签 $\\mathbf{y}$）这一事实与在此背景下的数据泄漏问题无关。泄漏之所以发生，是因为关于测试集*特征*的信息（其分布和协方差结构）被用来定义特征转换（主成分）。任何数据驱动的转换，无论是否是监督的，都必须包含在交叉验证循环内，并且只从数据的训练部分学习，以确保无偏的性能估计。主成分是特征工程步骤的参数，和所有模型参数一样，它们必须在不接触测试集的情况下学习。\n**结论：不正确。**\n\n**D. PCA中的数据泄漏会使生物学解释产生偏差：具有较大绝对载荷的基因可能会被过分强调其对于条件分离具有生物学重要性，因为载荷受到了留出数据结构的影响，从而混淆了探索性分析和验证性分析。**\n\n这个陈述是正确的。数据泄漏的后果不仅限于虚高的性能指标，还延伸到从模型中得出的科学结论。在生物信息学中，PCA载荷通常被解释以识别哪些原始变量（基因）驱动了主成分所捕获的方差。问题陈述中提到，前几个主成分与条件标签一致。在泄漏的流程 $\\mathcal{L}$ 中，这些主成分被定义为在*整个*数据集上最大化方差。因此，它们“不自然地”与分离条件对齐，因为它们是在预知测试数据结构的情况下构建的。当研究人员解释这样一个“泄漏”PC的基因载荷时，他们可能会错误地将强烈的生物学重要性归因于那些似乎能分离条件的基因。这个结论是有偏的，因为成分本身受到了测试集信息的污染。它混淆了探索性阶段（在训练数据中寻找模式）和验证性阶段（在测试数据上验证模式），可能导致不可重复的科学主张。\n**结论：正确。**\n\n**E. 在每个折的训练数据上重新拟合PCA会使得不同折之间的成分方向不可比较，从而使得通路级别的解释在形式上无效，即使存在跨折一致的模式。**\n\n这个陈述是错误的。虽然在 $K$ 个折中重新拟合PCA确实会产生 $K$ 组不同的载荷向量（即，第1折的PC1与第2折的PC1并非严格相同），但这并不会使解释无效。交叉验证（流程 $\\mathcal{T}$）的主要目的是为整个建模策略获得一个稳健的*性能*估计。模型的生物学意义的解释通常是在建模策略被验证后，对在*整个数据集*上训练的最终模型进行的。此外，观察到不同折之间存在一致的模式（例如，如果每个折中的PC1都能持续地分离条件，并且由相似的一组基因驱动）实际上会*增强*对生物学解释的信心，因为它表明该发现对于训练数据的特定抽样是稳健的。声称这个程序使得解释“在形式上无效”是一种夸大其词，并且歪曲了最佳实践。\n**结论：不正确。**", "answer": "$$\\boxed{ABD}$$", "id": "3321102"}, {"introduction": "标准PCA通过在欧几里得空间中最大化方差来工作，这隐含地假设所有特征（例如基因）具有可比的尺度和噪声水平。然而，在生物学测量中，我们常常知道不同特征的测量精度或重要性各不相同。本练习将PCA推广到更一般的情形，引入马氏（Mahalanobis）距离度量来对不同特征进行加权，从而引出广义主成分分析（Generalized PCA）的概念。通过推导并求解相应的广义特征值问题，您将学习如何将关于数据结构的先验知识融入PCA框架，从而获得对该方法更深刻和灵活的理解。 [@problem_id:3302534]", "problem": "在一项通过单细胞RNA测序(scRNA-seq)分析三基因信号模块的研究中，假设基因在细胞间的对数表达量的样本协方差由一个对称正定矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$ 建模，并且已知的基因特异性测量噪声水平定义了一个正定马氏度量 $M \\in \\mathbb{R}^{3 \\times 3}$。在马氏度量下的第一个广义主成分被定义为在归一化约束 $v^{\\top} M v = 1$ 条件下，使样本方差 $v^{\\top} S v$ 最大化的方向 $v \\in \\mathbb{R}^{3}$。\n\n请仅从方差、协方差和马氏范数的定义出发，推导在马氏度量下广义主成分分析(PCA)的约束最大化原理，然后通过适当的白化变换将其简化为一个标准特征值问题。最后，计算给定矩阵\n$$\nS \\;=\\; \\begin{pmatrix}\n3.2  1.2  0.0 \\\\\n1.2  2.5  0.0 \\\\\n0.0  0.0  1.6\n\\end{pmatrix},\n\\qquad\nM \\;=\\; \\begin{pmatrix}\n1.0  0.0  0.0 \\\\\n0.0  0.5  0.0 \\\\\n0.0  0.0  2.0\n\\end{pmatrix}\n$$\n的最大广义方差的精确值（即最大广义主成分方差）。\n请以最大广义方差的单个闭式解析表达式形式提供您的最终答案。答案中不应包含单位，且不要进行四舍五入。", "solution": "该问题要求在归一化约束 $g(v) = v^{\\top} M v - 1 = 0$ 的条件下，找到使广义方差 $f(v) = v^{\\top} S v$ 最大化的向量 $v \\in \\mathbb{R}^3$。\n\n**第1部分：约束最大化原理的推导**\n\n这是一个约束优化问题，可以使用拉格朗日乘数法求解。我们定义拉格朗日函数 $\\mathcal{L}(v, \\lambda)$：\n$$\n\\mathcal{L}(v, \\lambda) = f(v) - \\lambda g(v) = v^{\\top} S v - \\lambda(v^{\\top} M v - 1)\n$$\n其中 $\\lambda$ 是拉格朗日乘数。为求极值，我们将 $\\mathcal{L}$ 关于 $v$ 的梯度设为零。鉴于 $S$ 和 $M$ 是对称矩阵，二次型的梯度为 $\\nabla_v(v^{\\top} S v) = 2Sv$ 和 $\\nabla_v(v^{\\top} M v) = 2Mv$。\n将拉格朗日函数的梯度设为零：\n$$\n\\nabla_v \\mathcal{L}(v, \\lambda) = 2Sv - \\lambda (2Mv) = 0 \\implies Sv = \\lambda Mv\n$$\n这是一个广义特征值问题。满足此方程的向量 $v$ 是矩阵对 $(S, M)$ 的广义特征向量，$\\lambda$ 是对应的广义特征值。\n将方程 $Sv = \\lambda Mv$ 左乘 $v^{\\top}$ 得到 $v^{\\top} S v = \\lambda (v^{\\top} M v)$。应用约束条件 $v^{\\top} M v = 1$，我们发现：\n$$\nv^{\\top} S v = \\lambda\n$$\n这表明沿着广义特征向量 $v$ 的方差等于相应的广义特征值 $\\lambda$。因此，为了最大化方差 $v^{\\top} S v$，我们必须选择最大的广义特征值 $\\lambda_{\\text{max}}$。\n\n**第2部分：简化为标准特征值问题**\n\n由于 $M$ 是对称正定矩阵，它允许进行Cholesky分解 $M = LL^{\\top}$，其中 $L$ 可逆。将此代入广义特征值方程 $Sv = \\lambda Mv$：\n$Sv = \\lambda LL^{\\top}v$。\n用 $L^{-1}$ 左乘得到 $L^{-1}Sv = \\lambda L^{\\top}v$。\n定义“白化”向量 $u = L^{\\top}v$（即 $v = L^{-\\top}u$），代入方程得：\n$L^{-1}S(L^{-\\top}u) = \\lambda u \\implies (L^{-1}SL^{-\\top})u = \\lambda u$。\n这是一个关于对称矩阵 $S' = L^{-1}SL^{-\\top}$ 的标准特征值问题。$S'$ 的特征值 $\\lambda$ 与矩阵对 $(S, M)$ 的广义特征值相同。\n\n**第3部分：计算最大广义方差**\n\n我们需要通过求解特征方程 $\\det(S - \\lambda M) = 0$ 来找到最大的广义特征值 $\\lambda$。\n给定矩阵 $S$ 和 $M$，我们计算 $S - \\lambda M$：\n$$\nS - \\lambda M = \\begin{pmatrix}\n3.2 - 1.0\\lambda  & 1.2  & 0.0 \\\\\n1.2  & 2.5 - 0.5\\lambda  & 0.0 \\\\\n0.0  & 0.0  & 1.6 - 2.0\\lambda\n\\end{pmatrix}\n$$\n由于矩阵是块对角形式，其行列式为：\n$$\n\\det(S - \\lambda M) = (1.6 - 2.0\\lambda) \\left| \\begin{matrix} 3.2 - \\lambda  & 1.2 \\\\ 1.2  & 2.5 - 0.5\\lambda \\end{matrix} \\right| = 0\n$$\n行列式为零意味着其中一个因子必须为零。\n\n情况1：线性因子为零。\n$1.6 - 2.0\\lambda = 0 \\implies 2\\lambda = 1.6 \\implies \\lambda_1 = 0.8$\n\n情况2：$2 \\times 2$ 子矩阵的行列式为零。\n$$\n(3.2 - \\lambda)(2.5 - 0.5\\lambda) - (1.2)^2 = 0\n$$\n$$\n8.0 - 1.6\\lambda - 2.5\\lambda + 0.5\\lambda^2 - 1.44 = 0\n$$\n$$\n0.5\\lambda^2 - 4.1\\lambda + 6.56 = 0\n$$\n两边乘以 $2$ 以简化：\n$$\n\\lambda^2 - 8.2\\lambda + 13.12 = 0\n$$\n使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{-(-8.2) \\pm \\sqrt{(-8.2)^2 - 4(1)(13.12)}}{2(1)} = \\frac{8.2 \\pm \\sqrt{67.24 - 52.48}}{2} = \\frac{8.2 \\pm \\sqrt{14.76}}{2}\n$$\n将根式化简，我们有 $\\sqrt{14.76} = \\sqrt{1476/100} = \\sqrt{36 \\times 41}/10 = 6\\sqrt{41}/10 = 3\\sqrt{41}/5$。\n代入可得：\n$$\n\\lambda = \\frac{8.2 \\pm \\frac{3\\sqrt{41}}{5}}{2} = 4.1 \\pm \\frac{3\\sqrt{41}}{10} = \\frac{41}{10} \\pm \\frac{3\\sqrt{41}}{10} = \\frac{41 \\pm 3\\sqrt{41}}{10}\n$$\n因此，另外两个特征值为 $\\lambda_2 = \\frac{41 + 3\\sqrt{41}}{10}$ 和 $\\lambda_3 = \\frac{41 - 3\\sqrt{41}}{10}$。\n\n三个广义特征值为 $\\left\\{ 0.8, \\frac{41 + 3\\sqrt{41}}{10}, \\frac{41 - 3\\sqrt{41}}{10} \\right\\}$。\n为了找到最大值，我们比较这三个数。由于 $\\sqrt{41} > \\sqrt{36} = 6$，所以 $3\\sqrt{41} > 18$。\n$$\n\\lambda_2 = \\frac{41 + 3\\sqrt{41}}{10} > \\frac{41 + 18}{10} = 5.9\n$$\n$$\n\\lambda_3 = \\frac{41 - 3\\sqrt{41}}{10}  \\frac{41 - 18}{10} = 2.3\n$$\n由于 $\\lambda_1 = 0.8$，最大的广义特征值显然是 $\\lambda_2$。\n最大广义方差即为最大的广义特征值 $\\lambda_{\\text{max}}$。\n$$\n\\lambda_{\\text{max}} = \\frac{41 + 3\\sqrt{41}}{10}\n$$", "answer": "$$\\boxed{\\frac{41 + 3\\sqrt{41}}{10}}$$", "id": "3302534"}]}