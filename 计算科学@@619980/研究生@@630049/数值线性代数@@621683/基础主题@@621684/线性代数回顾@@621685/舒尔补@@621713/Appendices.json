{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。要真正掌握舒尔补，最好的起点是亲自动手进行一次具体的计算。这个练习将抽象的公式 $S = D - CA^{-1}B$ 应用到一个简单的 $3 \\times 3$ 矩阵上，通过分块和直接计算，让您对舒尔补的结构和形成过程有一个直观的认识。", "problem": "考虑 $3 \\times 3$ 实矩阵 $M$ 定义如下：\n$$\nM = \\begin{bmatrix}\n4 & 1 & 2 \\\\\n3 & 5 & 6 \\\\\n4 & 7 & 8\n\\end{bmatrix}.\n$$\n将 $M$ 分块，其中左上分块 $A$ 为 $1 \\times 1$ 矩阵，右上分块 $B$ 为 $1 \\times 2$ 矩阵，左下分块 $C$ 为 $2 \\times 1$ 矩阵，右下分块 $D$ 为 $2 \\times 2$ 矩阵。使用分块高斯消元法，计算 $M$ 中关于 $A$ 的舒尔补，记为 $S = D - C A^{-1} B$。求所得的 $2 \\times 2$ 舒尔补矩阵 $S$ 的第二行第一列的元素。", "solution": "1. 将矩阵 $M$ 分块如下：\n$$\nM=\\begin{pmatrix} A & B \\\\[6pt] C & D \\end{pmatrix},\n\\quad\nA=[4],\\;\nB=\\begin{bmatrix} 1 & 2 \\end{bmatrix},\\;\nC=\\begin{pmatrix}3\\\\4\\end{pmatrix},\\;\nD=\\begin{pmatrix}5 & 6\\\\7 & 8\\end{pmatrix}.\n$$\n2. 由于 $A$ 是标量 $4$，其逆为\n$$\nA^{-1} = \\frac{1}{4}.\n$$\n3. 计算乘积 $CA^{-1}B$：\n$$\nCB = \\begin{pmatrix}3\\\\4\\end{pmatrix} \\begin{bmatrix} 1 & 2 \\end{bmatrix}\n= \\begin{pmatrix}3\\cdot1 & 3\\cdot2\\\\ 4\\cdot1 & 4\\cdot2\\end{pmatrix}\n= \\begin{pmatrix}3 & 6\\\\4 & 8\\end{pmatrix},\n$$\n$$\nCA^{-1}B = \\frac{1}{4}\\begin{pmatrix}3 & 6\\\\4 & 8\\end{pmatrix}\n= \\begin{pmatrix}\\frac{3}{4} & \\frac{3}{2}\\\\ 1 & 2\\end{pmatrix}.\n$$\n4. 舒尔补为\n$$\nS = D - CA^{-1}B\n= \\begin{pmatrix}5 & 6\\\\7 & 8\\end{pmatrix}\n- \\begin{pmatrix}\\frac{3}{4} & \\frac{3}{2}\\\\ 1 & 2\\end{pmatrix}\n= \\begin{pmatrix}5-\\frac{3}{4} & 6-\\frac{3}{2} \\\\ 7-1 & 8-2\\end{pmatrix}\n= \\begin{pmatrix}\\frac{17}{4} & \\frac{9}{2}\\\\ 6 & 6\\end{pmatrix}.\n$$\n5. $S$ 的第二行第一列的元素为\n$$\nS_{2,1} = 6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1074949"}, {"introduction": "在理解了舒尔补的定义之后，一个自然而然的问题是：在实际计算中，构造它需要多大的代价？[@problem_id:1074949] 这个练习将我们的视角从“是什么”转向“效率如何”，这是一个在科学计算中至关重要的问题。通过分析计算一个稠密分块矩阵的舒尔补所需的浮点运算（flops），您将学会评估算法的计算成本，并理解为何在数值算法中我们倾向于避免显式计算矩阵的逆。", "problem": "一位计算科学家正在进行一项大规模模拟，该模拟需要求解一个形式为 $M\\mathbf{u} = \\mathbf{f}$ 的线性方程组。矩阵 $M$ 是一个稠密的 $2n \\times 2n$ 矩阵，具有如下的自然分块结构：\n$$\nM =\n\\begin{pmatrix}\nA & B \\\\\nC & D\n\\end{pmatrix}\n$$\n其中 $A, B, C,$ 和 $D$ 均为稠密的 $n \\times n$ 矩阵。向量 $\\mathbf{u}$ 和 $\\mathbf{f}$ 相应地分块为 $\\mathbf{u} = (\\mathbf{u}_1^T, \\mathbf{u}_2^T)^T$ 和 $\\mathbf{f} = (\\mathbf{f}_1^T, \\mathbf{f}_2^T)^T$，其中 $\\mathbf{u}_1, \\mathbf{u}_2, \\mathbf{f}_1, \\mathbf{f}_2$ 是长度为 $n$ 的向量。\n\n为了高效地求解该系统，该科学家决定使用分块消元法，这涉及构造块 $A$ 的舒尔补。$M$ 中关于 $A$ 的舒尔补（记作 $S$）被定义为在针对未知向量 $\\mathbf{u}_2$ 的简化系统中出现的矩阵。\n\n在你的分析中，假设浮点运算（flops）的标准成本如下，其中一次 flop 定义为一次乘法和一次加法：\n1.  两个稠密的 $n \\times n$ 矩阵进行标准矩阵-矩阵乘法的成本为 $2n^3$ 次 flops。\n2.  求解一个稠密的 $n \\times n$ 线性系统 $A\\mathbf{y} = \\mathbf{z}$ 以得到 $\\mathbf{y}$ 的成本（这涉及对 $A$ 进行 LU 分解，然后进行前向和后向代换）主要由分解决定，成本为 $\\frac{2}{3}n^3$ 次 flops。\n3.  当需要求解多个具有相同矩阵 $A$ 的系统时（例如，对于 $i=1, \\dots, k$ 的 $A\\mathbf{y}_i = \\mathbf{z}_i$），LU 分解只执行一次。使用前向/后向代换求解 $k$ 个右端项中的每一个，每个右端项的成本为 $2n^2$ 次 flops。\n\n假设矩阵 $A$ 是可逆的，请确定计算舒尔补矩阵 $S$ 所需的总 flops 数的主阶项。将你的答案表示为关于 $n$ 的解析表达式。", "solution": "我们必须计算 $M$ 中关于 $A$ 的舒尔补，即 $n \\times n$ 矩阵\n$$\nS = D - C A^{-1} B.\n$$\n为了高效地构造 $S$，我们避免显式地计算 $A^{-1}$，而是如给定的成本模型所暗示的那样，使用 $A$ 的 LU 分解和三角求解。整个过程可以分解为三个主要步骤：\n\n1.  **计算 $A$ 的 LU 分解**：这是为了准备求解形如 $A\\mathbf{y}=\\mathbf{z}$ 的系统。根据题目假设，对 $n \\times n$ 矩阵 $A$ 进行 LU 分解的成本是\n    $$\n    \\frac{2}{3} n^{3} \\text{ flops}.\n    $$\n2.  **计算 $X = A^{-1} B$**：我们不是先计算 $A^{-1}$ 再做矩阵乘法，而是通过求解线性系统 $AX=B$ 来得到矩阵 $X$。由于 $B$ 是一个 $n \\times n$ 矩阵，这相当于求解 $n$ 个以 $A$ 为系数矩阵、以 $B$ 的各列为右端项的线性系统。利用第一步得到的 LU 分解，对每个右端项进行前向和后向代换的成本是 $2n^2$ 次 flops。因为有 $n$ 个右端项，此步骤的总成本是\n    $$\n    n \\times (2 n^{2}) = 2 n^{3} \\text{ flops}.\n    $$\n3.  **计算最终的舒尔补**：现在我们计算乘积 $CX$，然后从 $D$ 中减去它。计算 $CX$ 是两个 $n \\times n$ 稠密矩阵的乘法，其成本由题目给定为\n    $$\n    2 n^{3} \\text{ flops}.\n    $$\n    最后的矩阵减法 $D - (CX)$ 需要 $n^2$ 次减法，其成本为 $\\mathcal{O}(n^{2})$ 次 flops，阶数低于 $n^{3}$，因此对主阶项没有贡献。\n\n将所有主阶项的成本相加，得到计算舒尔补 $S$ 的总 flops 数：\n$$\n\\text{总成本} = \\frac{2}{3} n^{3} (\\text{LU 分解}) + 2 n^{3} (\\text{求解 } AX=B) + 2 n^{3} (\\text{矩阵乘法 } CX) = \\left(\\frac{2}{3} + 2 + 2\\right) n^{3} = \\frac{14}{3} n^{3}.\n$$\n因此，计算 $S$ 所需的 flop 计数的主阶项是 $\\frac{14}{3} n^{3}$。", "answer": "$$\\boxed{\\frac{14}{3}\\,n^{3}}$$", "id": "2160771"}, {"introduction": "对于大规模问题，显式地计算并存储舒尔补矩阵 $S$ 往往是不可行的，因为它可能非常稠密且巨大。[@problem_id:2160771] 这个练习将介绍一种在现代迭代方法中至关重要的“无矩阵”（matrix-free）技术。您将学习如何在不直接构造 $S$ 的情况下，通过一系列矩阵向量乘积和线性系统求解，实现其逆（或其本身）对一个向量的作用，这是许多高级数值算法（如区域分解法）的核心思想。", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 可被相应地分块为\n$$\nA \\;=\\; \\begin{bmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{bmatrix},\n$$\n其中 $A_{11} \\in \\mathbb{R}^{n_1 \\times n_1}$ 是非奇异的，$A_{22} \\in \\mathbb{R}^{n_2 \\times n_2}$，且 $n_1 + n_2 = n$。假设 $A_{11}$ 的一个LU分解（Lower–Upper decomposition）$A_{11} = L_{11} U_{11}$ 是已知的，其中 $L_{11}$ 和 $U_{11}$ 是三角且非奇异的矩阵。$A$ 中关于 $A_{11}$ 的舒尔补（Schur complement）记为 $S_{22\\cdot 11} \\in \\mathbb{R}^{n_2 \\times n_2}$。给定一个向量 $v \\in \\mathbb{R}^{n_2}$，要求在不显式构造 $S_{22\\cdot 11}$ 的情况下，实现计算 $y = S_{22\\cdot 11}^{-1} v$。\n\n你被允许使用的基本操作有：\n- 使用 $L_{11}$ 和 $U_{11}$ 进行三角求解（因此，对于给定的 $t \\in \\mathbb{R}^{n_1}$，你可以通过求解 $L_{11} s = t$ 和 $U_{11} w = s$ 来计算 $w = A_{11}^{-1} t$），\n- 与 $A_{21}$ 和 $A_{12}$ 的矩阵-向量乘积，\n- 与 $A_{22}$ 的矩阵-向量乘积，\n- 标准的迭代线性求解器，它仅需要将线性算子应用于向量的能力。\n\n根据数值线性代数中分块高斯消元法和基于算子的迭代方法的基本原理，在不构造 $S_{22\\cdot 11}$ 的前提下，以下哪种策略在所述约束下正确地实现了 $y = S_{22\\cdot 11}^{-1} v$？\n\nA. 使用Krylov子空间方法求解 $S_{22\\cdot 11} y = v$，其中算子作用 $z \\mapsto S_{22\\cdot 11} z$ 的实现如下：给定 $z \\in \\mathbb{R}^{n_2}$，计算 $t = A_{12} z$，求解 $L_{11} s = t$ 和 $U_{11} w = s$ 以获得 $w = A_{11}^{-1} t$，计算 $r = A_{21} w$，并返回 $A_{22} z - r$。\n\nB. 使用Krylov子空间方法求解 $S_{22\\cdot 11} y = v$，其中算子作用 $z \\mapsto S_{22\\cdot 11} z$ 的实现如下：给定 $z \\in \\mathbb{R}^{n_2}$，计算 $t = A_{12} z$，求解 $L_{11} s = t$ 和 $U_{11} w = s$ 以获得 $w = A_{11}^{-1} t$，计算 $r = A_{21} w$，并返回 $A_{22} z + r$。\n\nC. 求解镶边系统 $A \\begin{bmatrix} x \\\\ y \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ v \\end{bmatrix}$，方法是首先计算 $y = A_{22}^{-1} v$，然后通过三角求解计算 $x = -A_{11}^{-1} A_{12} y$，并将得到的 $y$ 作为 $S_{22\\cdot 11}^{-1} v$。\n\nD. 使用Sherman–Morrison–Woodbury恒等式精确计算 $y = A_{22}^{-1} v - A_{22}^{-1} A_{21} A_{11}^{-1} A_{12} A_{22}^{-1} v$，其中使用对 $A_{11}$ 的三角求解以及与 $A_{21}$、$A_{12}$ 和 $A_{22}$ 的矩阵-向量乘积。", "solution": "问题的目标是计算 $y = S_{22\\cdot 11}^{-1} v$，这等价于求解线性系统 $S_{22\\cdot 11} y = v$。由于我们不能显式地构造舒尔补矩阵 $S_{22\\cdot 11}$，直接求解方法（如 LU 分解）是不可行的。因此，我们应该采用迭代方法，例如 Krylov 子空间方法（如 GMRES）。这类方法的核心要求是能够计算矩阵与任意向量的乘积，即实现一个算子，对于给定的向量 $z \\in \\mathbb{R}^{n_2}$，能计算出 $S_{22\\cdot 11} z$。\n\n让我们根据舒尔补的定义来推导这个算子的作用过程：\n$S_{22\\cdot 11} = A_{22} - A_{21}A_{11}^{-1}A_{12}$。\n因此，它对向量 $z$ 的作用是：\n$S_{22\\cdot 11} z = (A_{22} - A_{21}A_{11}^{-1}A_{12})z = A_{22}z - A_{21}(A_{11}^{-1}(A_{12}z))$。\n\n为了在不显式计算 $A_{11}^{-1}$ 的情况下实现这一过程，我们按照括号的顺序，利用给定的基本操作来计算：\n1.  计算矩阵-向量乘积 $t = A_{12} z$。\n2.  计算 $w = A_{11}^{-1} t$。这等价于求解线性系统 $A_{11} w = t$。由于 $A_{11}$ 的 LU 分解 $A_{11} = L_{11} U_{11}$ 是已知的，我们可以通过一次前向代换（求解 $L_{11} s = t$）和一次后向代换（求解 $U_{11} w = s$）来高效地求得 $w$。\n3.  计算矩阵-向量乘积 $r = A_{21} w$。\n4.  最后，计算最终结果 $A_{22}z - r$。这包括一次矩阵-向量乘积和一次向量减法。\n\n现在我们来分析各个选项：\n\nA. 该选项描述的步骤是：计算 $t = A_{12} z$，求解 $A_{11}w=t$ 得到 $w$，计算 $r = A_{21} w$，最后返回 $A_{22} z - r$。这与我们上面推导的无矩阵（matrix-free）算子作用过程完全吻合。因此，该策略是正确的。\n\nB. 该选项最后返回 $A_{22} z + r$，符号错误。因此不正确。\n\nC. 该选项提议求解一个镶边系统，但其方法中包含计算 $y = A_{22}^{-1} v$，这需要对 $A_{22}$ 求逆或求解以 $A_{22}$ 为系数的系统，而这并不是题目允许的基本操作。此外，它对分块系统求解的逻辑也是不正确的。因此不正确。\n\nD. 该选项引用了 Sherman–Morrison–Woodbury 恒等式，但该恒等式通常用于计算矩阵逆的更新，其形式与本问题不直接匹配。更重要的是，它也需要计算 $A_{22}^{-1}v$，这是一个不被允许的操作。因此不正确。\n\n综上所述，只有选项 A 提供了在给定约束下正确实现 $y = S_{22\\cdot 11}^{-1} v$ 的有效策略。", "answer": "$$\\boxed{A}$$", "id": "3595834"}]}