{"hands_on_practices": [{"introduction": "秩-零度定理是线性代数中的一个基本恒等式，它优美地揭示了矩阵的列空间维度（秩）与其零空间维度（零度）之间的内在联系。通过一个具体的托普利茨矩阵（Toeplitz matrix）来直接验证该定理，是巩固理论理解并建立计算信心的第一步。这个练习将引导你亲手计算一个矩阵的秩和零度，并确认它们的和恰好等于矩阵的列数。", "problem": "考虑如下给定的 $3 \\times 3$ 托普利茨矩阵：\n\n$$\nA = \\begin{bmatrix} \n2  1  0 \\\\ \n1  2  1 \\\\ \n0  1  2 \n\\end{bmatrix}.\n$$\n\n秩-零度定理指出，对于任意矩阵 $A$，$A$ 的秩与 $A$ 的零度之和等于 $A$ 的列数。计算矩阵 $A$ 的这个和。", "solution": "为了计算 $A$ 的秩与零度之和，我们首先通过将 $A$ 行化简为行阶梯形矩阵来确定其秩。\n\n从以下矩阵开始：\n\n$$\nA = \\begin{bmatrix} \n2  1  0 \\\\ \n1  2  1 \\\\ \n0  1  2 \n\\end{bmatrix},\n$$\n\n执行行变换 $R_2 \\leftarrow 2R_2 - R_1$：\n\n$$\n2R_2 = \\begin{bmatrix} 2  4  2 \\end{bmatrix}, \\quad 2R_2 - R_1 = \\begin{bmatrix} 2-2  4-1  2-0 \\end{bmatrix} = \\begin{bmatrix} 0  3  2 \\end{bmatrix}.\n$$\n\n矩阵变为：\n\n$$\n\\begin{bmatrix} \n2  1  0 \\\\ \n0  3  2 \\\\ \n0  1  2 \n\\end{bmatrix}.\n$$\n\n接下来，执行 $R_3 \\leftarrow 3R_3 - R_2$：\n\n$$\n3R_3 = \\begin{bmatrix} 0  3  6 \\end{bmatrix}, \\quad 3R_3 - R_2 = \\begin{bmatrix} 0  3-3  6-2 \\end{bmatrix} = \\begin{bmatrix} 0  0  4 \\end{bmatrix}.\n$$\n\n行阶梯形矩阵为：\n\n$$\n\\begin{bmatrix} \n2  1  0 \\\\ \n0  3  2 \\\\ \n0  0  4 \n\\end{bmatrix}.\n$$\n\n该矩阵有三个非零行，因此 $A$ 的秩为 $3$。\n\n为了求零度，我们使用行阶梯形矩阵求解 $A\\mathbf{x} = \\mathbf{0}$。该方程组为：\n\\begin{align*}\n2x + y = 0, \\\\\n3y + 2z = 0, \\\\\n4z = 0.\n\\end{align*}\n由 $4z = 0$ 可得 $z = 0$。代入 $3y + 2z = 0$ 得到 $3y = 0$，所以 $y = 0$。然后 $2x + y = 0$ 意味着 $2x = 0$，所以 $x = 0$。唯一的解是零解，所以零空间为 $\\{ \\mathbf{0} \\}$，零度为 $0$。\n\n秩与零度之和为 $3 + 0 = 3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "1061213"}, {"introduction": "在数值计算中，矩阵很少是孤立存在的，它们经常会受到扰动的影响。理解秩和零度在扰动下的变化是评估算法稳定性的核心，而秩一扰动为此提供了一个最简洁的分析模型[@problem_id:3558884]。此练习将挑战你从理论上剖析秩一扰动对矩阵零度的影响，并辨析在有限精度计算中确定秩的实际挑战。", "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 是一个实矩阵， $u \\in \\mathbb{R}^{m}$ 和 $v \\in \\mathbb{R}^{n}$ 是实向量， $\\alpha \\in \\mathbb{R}$ 是一个实标量。考虑秩一扰动 $A + \\alpha u v^{T}$。仅使用矩阵的像、核、秩和零度的核心定义，推断这种扰动对零度的影响，并构造达到极值变化的具体例子。此外，评估关于在有限精度算术中（包括奇异值分解 (SVD)）数值验证秩和零度的陈述。\n\n选择所有正确的陈述。\n\nA. 对于任何 $A \\in \\mathbb{R}^{m \\times n}$、$u \\in \\mathbb{R}^{m}$、$v \\in \\mathbb{R}^{n}$ 和 $\\alpha \\in \\mathbb{R}$，差值 $\\mathrm{nullity}(A + \\alpha u v^{T}) - \\mathrm{nullity}(A)$ 的绝对值不超过 $1$。\n\nB. 存在 $A \\in \\mathbb{R}^{n \\times n}$ 其 $\\mathrm{nullity}(A) = 1$，以及 $u, v, \\alpha$ 的选择，使得 $A + \\alpha u v^{T}$ 可逆，从而使零度减少 $1$。例如，当 $n = 2$ 时，取 $A = \\begin{pmatrix}1  0 \\\\ 0  0 \\end{pmatrix}$，$u = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，$v = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，以及 $\\alpha = 1$，我们得到 $A + \\alpha u v^{T} = \\begin{pmatrix}1  0 \\\\ 0  1 \\end{pmatrix}$。\n\nC. 存在可逆矩阵 $A \\in \\mathbb{R}^{n \\times n}$，对于它，无论如何选择 $u, v$ 和 $\\alpha$，每个秩一扰动 $A + \\alpha u v^{T}$ 都保持可逆。\n\nD. 如果 $A \\in \\mathbb{R}^{n \\times n}$ 可逆且 $1 + v^{T} A^{-1} u = 0$，那么对于 $\\alpha = 1$，矩阵 $A + \\alpha u v^{T}$ 是奇异的，其零度增加 $1$。\n\nE. 在通过奇异值分解 (SVD) 数值计算 $\\mathrm{rank}(A)$ 时，计算恰好等于 $0$ 的奇异值的数量是一个可靠的标准，并且不受 $A$ 的缩放影响。\n\nF. 包含关系 $\\mathrm{Im}(A + \\alpha u v^{T}) \\subseteq \\mathrm{Im}(A) + \\mathrm{span}\\{u\\}$ 意味着 $\\mathrm{rank}(A + \\alpha u v^{T}) \\le \\mathrm{rank}(A) + 1$。\n\nG. 当 $m \\ne n$ 时，一个秩一扰动 $A + \\alpha u v^{T}$ 最多能使 $\\mathrm{nullity}(A)$ 改变 $2$（但不会更多）。", "solution": "该问题陈述是线性代数中的一个有效练习，旨在评估矩阵秩一扰动的性质。所有术语都有明确定义，且各项陈述均为无歧义的命题，可以被严格证明或证伪。我们将逐一分析每个陈述。\n\n我们将使用的基本关系是对于矩阵 $M \\in \\mathbb{R}^{m \\times n}$ 的秩-零度定理：\n$$ \\mathrm{rank}(M) + \\mathrm{nullity}(M) = n $$\n其中 $n$ 是 $M$ 的列数。我们还将反复使用一个性质，即两个矩阵之和的秩小于或等于它们的秩之和，即 $\\mathrm{rank}(X+Y) \\le \\mathrm{rank}(X) + \\mathrm{rank}(Y)$。由两个非零向量的外积定义的矩阵 $\\alpha u v^T$（其中 $\\alpha \\ne 0$、$u \\ne 0$、$v \\ne 0$）的秩等于 $1$。如果 $\\alpha, u, v$ 中任何一个为零，其秩为 $0$。因此，在所有情况下，$\\mathrm{rank}(\\alpha u v^T) \\le 1$。\n\n**A. 对于任何 $A \\in \\mathbb{R}^{m \\times n}$、$u \\in \\mathbb{R}^{m}$、$v \\in \\mathbb{R}^{n}$ 和 $\\alpha \\in \\mathbb{R}$，差值 $\\mathrm{nullity}(A + \\alpha u v^{T}) - \\mathrm{nullity}(A)$ 的绝对值不超过 $1$。**\n\n令 $B = A + \\alpha u v^{T}$。我们首先确定 $B$ 的秩的界。\n使用秩的次可加性：\n$$ \\mathrm{rank}(B) = \\mathrm{rank}(A + \\alpha u v^{T}) \\le \\mathrm{rank}(A) + \\mathrm{rank}(\\alpha u v^{T}) $$\n因为 $\\mathrm{rank}(\\alpha u v^{T}) \\le 1$，我们有：\n$$ \\mathrm{rank}(B) \\le \\mathrm{rank}(A) + 1 $$\n类似地，我们可以将 $A$ 表示为 $B$ 的秩一扰动：$A = B - \\alpha u v^{T}$。\n$$ \\mathrm{rank}(A) \\le \\mathrm{rank}(B) + \\mathrm{rank}(-\\alpha u v^{T}) $$\n因为 $\\mathrm{rank}(-\\alpha u v^{T}) = \\mathrm{rank}(\\alpha u v^{T}) \\le 1$，我们有：\n$$ \\mathrm{rank}(A) \\le \\mathrm{rank}(B) + 1 \\implies \\mathrm{rank}(B) \\ge \\mathrm{rank}(A) - 1 $$\n结合这两个不等式可得：\n$$ \\mathrm{rank}(A) - 1 \\le \\mathrm{rank}(B) \\le \\mathrm{rank}(A) + 1 $$\n这等价于 $|\\mathrm{rank}(B) - \\mathrm{rank}(A)| \\le 1$。\n\n现在，我们应用秩-零度定理，该定理指出对于任何 $M \\in \\mathbb{R}^{m \\times n}$，$\\mathrm{rank}(M) = n - \\mathrm{nullity}(M)$。\n将此代入我们的秩不等式中：\n$$ |(n - \\mathrm{nullity}(B)) - (n - \\mathrm{nullity}(A))| \\le 1 $$\n$$ |-\\mathrm{nullity}(B) + \\mathrm{nullity}(A)| \\le 1 $$\n$$ |\\mathrm{nullity}(A) - \\mathrm{nullity}(B)| \\le 1 $$\n用 $A + \\alpha u v^{T}$ 替换 $B$：\n$$ |\\mathrm{nullity}(A) - \\mathrm{nullity}(A + \\alpha u v^{T})| \\le 1 $$\n这表明零度的变化量 $\\mathrm{nullity}(A + \\alpha u v^{T}) - \\mathrm{nullity}(A)$ 是一个绝对值最多为 $1$ 的整数。它可以是 $-1$、$0$ 或 $1$。因此，该陈述是正确的。\n\n**结论：正确**\n\n**B. 存在 $A \\in \\mathbb{R}^{n \\times n}$ 其 $\\mathrm{nullity}(A) = 1$，以及 $u, v, \\alpha$ 的选择，使得 $A + \\alpha u v^{T}$ 可逆，从而使零度减少 $1$。例如，当 $n = 2$ 时，取 $A = \\begin{pmatrix}1  0 \\\\ 0  0 \\end{pmatrix}$，$u = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，$v = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，以及 $\\alpha = 1$，我们得到 $A + \\alpha u v^{T} = \\begin{pmatrix}1  0 \\\\ 0  1 \\end{pmatrix}$。**\n\n让我们验证所提供的例子。\n矩阵是 $A = \\begin{pmatrix}1  0 \\\\ 0  0 \\end{pmatrix}$，它属于 $\\mathbb{R}^{2 \\times 2}$。\n其秩显然是 $1$。对 $n=2$ 使用秩-零度定理：$\\mathrm{nullity}(A) = 2 - \\mathrm{rank}(A) = 2 - 1 = 1$。其核空间由向量 $\\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$ 生成。\n扰动的参数为 $u = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，$v = \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix}$，以及 $\\alpha = 1$。\n秩一矩阵是 $\\alpha u v^{T} = 1 \\cdot \\begin{pmatrix}0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix}0  1 \\end{pmatrix} = \\begin{pmatrix}0  0 \\\\ 0  1 \\end{pmatrix}$。\n扰动后的矩阵是：\n$$ A + \\alpha u v^{T} = \\begin{pmatrix}1  0 \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix}0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix}1  0 \\\\ 0  1 \\end{pmatrix} = I_2 $$\n得到的矩阵是 $2 \\times 2$ 单位矩阵，它是可逆的。\n一个可逆的 $2 \\times 2$ 矩阵的秩为 $2$，零度为 $0$。\n初始零度是 $\\mathrm{nullity}(A) = 1$。最终零度是 $\\mathrm{nullity}(A + \\alpha u v^{T}) = 0$。\n零度的变化是 $0 - 1 = -1$。\n这个例子正确地证明了秩一扰动可以使零度减少 $1$，从而使一个奇异矩阵变为可逆。\n\n**结论：正确**\n\n**C. 存在可逆矩阵 $A \\in \\mathbb{R}^{n \\times n}$，对于它，无论如何选择 $u, v$ 和 $\\alpha$，每个秩一扰动 $A + \\alpha u v^{T}$ 都保持可逆。**\n\n一个可逆矩阵如果其零度从 $0$ 增加到至少 $1$，则变为奇异矩阵。我们研究对于任何可逆矩阵 $A$，是否总能引发这种情况。\n设 $A \\in \\mathbb{R}^{n \\times n}$ 是可逆的。考虑扰动后的矩阵 $B = A + \\alpha u v^T$。如果存在一个非零向量 $x \\in \\mathbb{R}^n$ 使得 $Bx=0$，则 $B$ 是奇异的。\n$$ (A + \\alpha u v^T)x = 0 \\implies Ax = -\\alpha u (v^T x) $$\n由于 $A$ 是可逆的，我们可以左乘 $A^{-1}$：\n$$ x = -A^{-1}(\\alpha u (v^T x)) = -\\alpha(v^T x) A^{-1}u $$\n项 $(v^T x)$ 是一个标量。我们假设 $u \\neq 0$，$v \\neq 0$ 且 $\\alpha \\neq 0$，否则扰动为零且 $B=A$ 保持可逆。为了存在非零解 $x$，我们必须有 $v^T x \\ne 0$，否则 $x=0$。\n从左边用 $v^T$ 乘以关于 $x$ 的方程：\n$$ v^T x = -\\alpha(v^T x) (v^T A^{-1}u) $$\n由于 $v^T x \\ne 0$，我们可以用它来除：\n$$ 1 = -\\alpha (v^T A^{-1}u) \\implies 1 + \\alpha v^T A^{-1}u = 0 $$\n这就是奇异性的条件。这个结果与 Sherman-Morrison 公式有关。\n该陈述声称存在一个矩阵 $A$，对于任何 $u, v, \\alpha$ 的选择，这个条件都永远无法满足。\n让我们看看对于任意可逆矩阵 $A$，我们是否总能找到 $u, v, \\alpha$ 来满足这个条件。\n我们选择 $\\alpha=1$。条件是 $1 + v^T A^{-1}u = 0$，或 $v^T(A^{-1}u) = -1$。\n我们选择任意非零向量 $u \\in \\mathbb{R}^n$。由于 $A$ 可逆，$A^{-1}$ 也可逆，所以 $w = A^{-1}u$ 也是一个非零向量。\n条件变为 $v^T w = -1$。由于 $w \\neq 0$，我们总能找到这样一个向量 $v$。例如，我们可以选择 $v = -w / \\|w\\|_2^2$。那么 $v^T w = (-w^T/\\|w\\|_2^2)w = -\\|w\\|_2^2/\\|w\\|_2^2 = -1$。\n因此，对于任何可逆矩阵 $A$，我们可以选择一个非零的 $u$，构造 $w=A^{-1}u$，构造 $v = -w/\\|w\\|_2^2$，并设 $\\alpha=1$。这样的 $u, v, \\alpha$ 选择将使 $A+\\alpha u v^T$ 变为奇异矩阵。\n因此，没有可逆矩阵能免于通过秩一扰动变为奇异矩阵。该陈述是错误的。\n\n**结论：错误**\n\n**D. 如果 $A \\in \\mathbb{R}^{n \\times n}$ 可逆且 $1 + v^{T} A^{-1} u = 0$，那么对于 $\\alpha = 1$，矩阵 $A + \\alpha u v^{T}$ 是奇异的，其零度增加 $1$。**\n\n令 $B = A + u v^T$。\n根据对陈述C的分析，条件 $1 + v^{T} A^{-1} u = 0$（对于 $\\alpha=1$）正是 $B$ 成为奇异矩阵的条件。这意味着 $\\mathrm{rank}(B)  n$，或者等价地，$\\mathrm{nullity}(B) \\ge 1$。\n初始矩阵 $A$ 是可逆的，所以 $\\mathrm{nullity}(A) = 0$。\n根据对陈述A的分析，我们知道 $|\\mathrm{nullity}(B) - \\mathrm{nullity}(A)| \\le 1$。\n代入 $\\mathrm{nullity}(A) = 0$，我们得到 $|\\mathrm{nullity}(B)| \\le 1$。由于零度不能为负，这意味着 $0 \\le \\mathrm{nullity}(B) \\le 1$。\n我们已经确定 $B$ 是奇异的，所以 $\\mathrm{nullity}(B) \\ge 1$。\n唯一的可能性是 $\\mathrm{nullity}(B) = 1$。\n零度从 $0$ 变为 $1$，恰好增加了 $1$。\n为了更严谨，我们来求 $B$ 的核。设 $x \\in \\mathrm{Ker}(B)$。则 $(A+uv^T)x=0$。如在C中所示，这 implicates $x = -(v^T x)A^{-1}u$。这意味着核中的任何向量都必须是向量 $w_0 = A^{-1}u$ 的标量倍。所以 $\\mathrm{Ker}(B) \\subseteq \\mathrm{span}\\{w_0\\}$。\n我们来检查 $w_0$ 是否在核中：\n$Bw_0 = (A+uv^T)(A^{-1}u) = AA^{-1}u + u(v^T A^{-1}u) = u + u(v^T A^{-1}u) = u(1 + v^T A^{-1}u)$。\n给定的条件是 $1 + v^T A^{-1}u = 0$。所以，$Bw_0 = u(0) = 0$。\n向量 $w_0$ 在 $B$ 的核中。$w_0$ 是非零的吗？如果 $w_0=A^{-1}u=0$，那么因为 $A^{-1}$ 是可逆的，$u$ 必须为 $0$。如果 $u=0$，条件 $1 + v^T A^{-1} u = 0$ 变为 $1=0$，这是一个矛盾。所以 $u \\ne 0$，因此 $w_0 \\ne 0$。\n由于核包含非零向量 $w_0$ 并且是一维空间 $\\mathrm{span}\\{w_0\\}$ 的子空间，所以核必须恰好是 $\\mathrm{span}\\{w_0\\}$。\n因此，$\\mathrm{dim}(\\mathrm{Ker}(B)) = \\mathrm{nullity}(B) = 1$。\n$A$ 的零度是 $0$，$B$ 的零度是 $1$。增加了 $1$。该陈述是正确的。\n\n**结论：正确**\n\n**E. 在通过奇异值分解 (SVD) 数值计算 $\\mathrm{rank}(A)$ 时，计算恰好等于 $0$ 的奇异值的数量是一个可靠的标准，并且不受 $A$ 的缩放影响。**\n\n这个陈述有两部分。\n1. 在“数值计算”中，“计算恰好等于 $0$ 的奇异值的数量是一个可靠的标准”。\n矩阵的秩等于其非零奇异值的数量。在数值计算中，它使用有限精度的浮点运算，舍入误差是不可避免的。一个解析上为零的奇异值几乎总会被计算为一个小的非零数（例如，在机器ε的量级上）。反之，一个矩阵可能是“数值奇异的”（即，非常病态的），具有一个非常小但非零的奇异值。因此，检查奇异值是否*恰好*为零不是确定秩的可靠数值方法。一个稳健的方法需要选择一个容差 $\\tau > 0$ 并计算奇异值 $\\sigma_i > \\tau$ 的数量。$\\tau$ 的选择并非易事。陈述的这一部分是错误的。\n\n2. “【这个标准】不受 $A$ 的缩放影响。”\n设 $A$ 的奇异值为 $\\sigma_i$。令 $B = cA$，其中 $c \\in \\mathbb{R}$ 为某个标量。$B$ 的奇异值为 $|c|\\sigma_i$。如果 $A$ 的某个奇异值 $\\sigma_j$ 恰好为 $0$，那么 $B$ 对应的奇异值是 $|c|\\sigma_j = 0$。如果 $\\sigma_k \\ne 0$，那么 $|c|\\sigma_k \\ne 0$（对于 $c \\ne 0$）。所以，在精确算术中，零奇异值的数量确实不受非零缩放的影响。然而，这对于数值秩问题实际上是无关紧要的。如果 $\\sigma_j$ 是一个非常小的数 $\\epsilon$，用一个大因子 $|c|$ 缩放 $A$ 会得到一个奇异值 $|c|\\epsilon$，这个值现在可能高于容差 $\\tau$。反之，用一个小因子缩放可以将一个奇异值移到容差以下。因此，有效的数值秩*会*受缩放影响。\n\n由于在数值计算的背景下，这个合取式的第一部分是明确错误的，所以整个陈述是不正确的。\n\n**结论：错误**\n\n**F. 包含关系 $\\mathrm{Im}(A + \\alpha u v^{T}) \\subseteq \\mathrm{Im}(A) + \\mathrm{span}\\{u\\}$ 意味着 $\\mathrm{rank}(A + \\alpha u v^{T}) \\le \\mathrm{rank}(A) + 1$。**\n\n令 $B = A + \\alpha u v^{T}$。\n前提是包含关系 $\\mathrm{Im}(B) \\subseteq \\mathrm{Im}(A) + \\mathrm{span}\\{u\\}$。让我们首先从第一性原理出发建立这个包含关系。$B$ 的像是所有形如 $y = Bx$（其中 $x \\in \\mathbb{R}^n$）的向量的集合。\n$y = (A + \\alpha u v^T)x = Ax + \\alpha u (v^T x)$。\n根据定义，向量 $Ax$ 在 $A$ 的像空间 $\\mathrm{Im}(A)$ 中。向量 $\\alpha u (v^T x)$ 是 $u$ 的标量倍，所以它属于由 $u$ 生成的子空间 $\\mathrm{span}\\{u\\}$。\n因此，$\\mathrm{Im}(B)$ 中的任何向量 $y$ 都可以写成一个来自 $\\mathrm{Im}(A)$ 的向量和一个来自 $\\mathrm{span}\\{u\\}$ 的向量的和。这意味着 $\\mathrm{Im}(B) \\subseteq \\mathrm{Im}(A) + \\mathrm{span}\\{u\\}$，所以前提总是为真。\n\n现在我们检查结论是否能从前提中得出。\n矩阵的秩是其像空间的维数。$\\mathrm{rank}(B) = \\dim(\\mathrm{Im}(B))$。\n如果子空间 $W_1$ 包含于子空间 $W_2$，那么 $\\dim(W_1) \\le \\dim(W_2)$。\n从前提我们有 $\\dim(\\mathrm{Im}(B)) \\le \\dim(\\mathrm{Im}(A) + \\mathrm{span}\\{u\\})$。\n使用子空间和的维数性质，$\\dim(W_1+W_2) \\le \\dim(W_1) + \\dim(W_2)$。\n$$ \\dim(\\mathrm{Im}(A) + \\mathrm{span}\\{u\\}) \\le \\dim(\\mathrm{Im}(A)) + \\dim(\\mathrm{span}\\{u\\}) $$\n我们知道 $\\dim(\\mathrm{Im}(A)) = \\mathrm{rank}(A)$。子空间 $\\mathrm{span}\\{u\\}$ 由单个向量生成，所以其维数最多为1。\n$$ \\dim(\\mathrm{Im}(A) + \\mathrm{span}\\{u\\}) \\le \\mathrm{rank}(A) + 1 $$\n结合这些不等式：\n$$ \\mathrm{rank}(B) = \\dim(\\mathrm{Im}(B)) \\le \\dim(\\mathrm{Im}(A) + \\mathrm{span}\\{u\\}) \\le \\mathrm{rank}(A) + 1 $$\n所以，$\\mathrm{rank}(A + \\alpha u v^{T}) \\le \\mathrm{rank}(A) + 1$。\n这个蕴含关系在逻辑上是合理的。前提（它总是为真）正确地导出了结论。\n\n**结论：正确**\n\n**G. 当 $m \\ne n$ 时，一个秩一扰动 $A + \\alpha u v^{T}$ 最多能使 $\\mathrm{nullity}(A)$ 改变 $2$（但不会更多）。**\n\n这个陈述与陈述A的结论相矛盾。在对陈述A的推导中，我们证明了 $|\\mathrm{nullity}(A + \\alpha u v^{T}) - \\mathrm{nullity}(A)| \\le 1$。\n该推导依赖于两个关键事实：\n1. 秩不等式：$|\\mathrm{rank}(A+B) - \\mathrm{rank}(A)| \\le \\mathrm{rank}(B)$。对于 $B = \\alpha u v^T$，这给出 $|\\mathrm{rank}(A+\\alpha u v^T) - \\mathrm{rank}(A)| \\le 1$。\n2. 秩-零度定理：$\\mathrm{rank}(M) + \\mathrm{nullity}(M) = n$。\n\n这两者都不依赖于矩阵是方阵 ($m=n$)。秩不等式对任何可以定义和运算的矩阵维度都成立。秩-零度定理对任何 $m \\times n$ 矩阵都成立，其中 $n$ 是列数。\n因此，结果 $|\\mathrm{nullity}(A + \\alpha u v^{T}) - \\mathrm{nullity}(A)| \\le 1$ 对任何 $m \\times n$ 矩阵都成立。零度的变化总是在 $\\{-1, 0, 1\\}$ 中的整数。\n关于零度最多能改变2的陈述是错误的。条件 $m \\ne n$ 不会改变这个结论。\n\n**结论：错误**\n\n**结论摘要**\n- A: 正确\n- B: 正确\n- C: 错误\n- D: 正确\n- E: 错误\n- F: 正确\n- G: 错误\n\n正确的陈述是 A、B、D 和 F。", "answer": "$$\\boxed{ABDF}$$", "id": "3558884"}, {"introduction": "与会改变矩阵秩的扰动相反，某些变换能够保持秩和零度不变，正交变换就是其中最重要的一类。这个练习从证明一个核心理论——左乘一个正交矩阵不改变原矩阵的零空间——出发，进而引导你设计一个计算实验[@problem_id:3558929]。你将亲自验证，虽然理论秩不变，但这种变换可以极大地改善数值秩的计算精度，这揭示了预处理技术在解决数值稳定性问题中的强大威力。", "problem": "考虑一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个正交矩阵 $Q \\in \\mathbb{R}^{m \\times m}$，其中正交矩阵定义为 $Q^{\\top} Q = I_m$。零空间 $\\mathcal{N}(A)$ 定义为 $\\{ x \\in \\mathbb{R}^n : A x = 0 \\}$，矩阵 $A$ 的秩是 $A$ 的列空间的维数。秩-零度定理指出，对于任何由矩阵 $A$ 表示的线性映射 $T : \\mathbb{R}^n \\to \\mathbb{R}^m$，都有 $\\mathrm{rank}(A) + \\mathrm{nullity}(A) = n$。\n\n您的任务是：\n\n- 从第一性原理出发（仅使用核心定义和广为接受的事实）证明，对于任何正交矩阵 $Q$，零空间在被 $Q$ 左乘后保持不变，即 $\\mathcal{N}(A) = \\mathcal{N}(Q A)$。由此推断，$A$ 的零度和秩在被 $Q$ 左乘后也保持不变。\n\n- 设计一个计算实验，以测试当使用一个刻意避免主元选择的算法时，随机正交前乘（用一个随机正交矩阵 $Q$ 左乘）是否能改善实际的数值秩检测。使用一个无主元选择的高斯消元启发式算法来估计数值秩：在步骤 $k$（从 $k=0$ 开始），如果对角线元素 $|A_{k,k}|  \\tau$，则将其视为主元，并在该主元下方执行消元，不进行任何行或列主元选择；将接受的主元数量作为估计的秩。容差 $\\tau$ 是一个固定的正阈值。\n\n- 实现以下具有受控低秩结构和结构化行突发噪声的矩阵测试套件。对于每个测试用例，将 $A$ 构建为 $A_0 + E$ 的和，其中 $A_0$ 的精确秩为 $r$，并通过在底部 $r$ 行和左侧 $r$ 列放置一个单位块来形成：\n  $$\n  (A_0)_{m-r+i,\\, i} = 1 \\quad \\text{for} \\quad i=0,1,\\dots,r-1\n  $$\n  其他位置为零。噪声 $E$ 仅添加到 $K$ 个随机选择的行上；在每个选定的行上，为每个元素添加方差为 $\\sigma^2$ 的独立同分布高斯噪声。\n\n- 对于每个测试用例，生成一个随机正交矩阵 $Q$（例如，通过计算一个稠密高斯矩阵的 QR 分解中的正交因子）。使用指定的无主元选择消元法，在相同的容差 $\\tau$ 下，估计 $A$ 和 $Q A$ 的秩。将每个测试用例的改进度量定义为一个整数：\n  $$\n  \\mathrm{improve} =\n  \\begin{cases}\n    1  \\text{如果前乘后的估计值等于真实秩 } r \\text{ 而前乘前的估计值不等于, } \\\\\n    -1  \\text{如果前乘前的估计值等于 } r \\text{ 而前乘后的估计值不等于, } \\\\\n    0  \\text{其他情况。}\n  \\end{cases}\n  $$\n  真实的零度是 $n - r$。测试套件如下：\n\n  - 测试用例 1：$m=50$, $n=40$, $r=30$, $K=3$, $\\sigma=10^{-6}$, $\\tau=10^{-3}$, 随机种子 $123$。\n  - 测试用例 2：$m=40$, $n=50$, $r=30$, $K=3$, $\\sigma=10^{-6}$, $\\tau=10^{-3}$, 随机种子 $234$。\n  - 测试用例 3：$m=60$, $n=60$, $r=60$, $K=4$, $\\sigma=10^{-6}$, $\\tau=10^{-3}$, 随机种子 $345$。\n  - 测试用例 4：$m=80$, $n=20$, $r=18$, $K=2$, $\\sigma=10^{-6}$, $\\tau=10^{-3}$, 随机种子 $456$。\n\n您的程序应生成单行输出，其中包含四个测试用例的改进值，格式为方括号内以逗号分隔的列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是如上定义的整数，取值于 $\\{-1,0,1\\}$。程序必须是自包含的，使用指定的库，并且不接受任何输入。", "solution": "该问题提出了一个理论证明，并附带一个关于矩阵的秩及其在正交变换下行为的计算实验。将按要求分两部分进行验证和解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$。\n- 一个正交矩阵 $Q \\in \\mathbb{R}^{m \\times m}$，定义为 $Q^{\\top} Q = I_m$。\n- 零空间定义：$\\mathcal{N}(A) = \\{ x \\in \\mathbb{R}^n : A x = 0 \\}$。\n- 秩定义：$A$ 的列空间的维数。\n- 秩-零度定理：$\\mathrm{rank}(A) + \\mathrm{nullity}(A) = n$。\n- 理论任务：证明 $\\mathcal{N}(A) = \\mathcal{N}(Q A)$ 并推导出 $\\mathrm{nullity}(A) = \\mathrm{nullity}(QA)$ 和 $\\mathrm{rank}(A) = \\mathrm{rank}(QA)$。\n- 计算任务：设计并实现一个实验，以测试随机正交前乘对特定数值秩估计算法的影响。\n- 秩估计算法：一种无主元选择的高斯消元启发式算法。如果在步骤 $k$，对角线元素 $|A_{k,k}| > \\tau$，则计为一个主元。在主元下方进行消元。估计的秩是此类主元的总数。不执行行或列交换。\n- 实验矩阵构造：$A = A_0 + E$。\n  - $A_0$ 是一个精确秩为 $r$ 的矩阵，其 $(A_0)_{m-r+i, i} = 1$（对于 $i=0, 1, \\dots, r-1$），其他位置为零。\n  - $E$ 是一个噪声矩阵，其中 $K$ 个随机选择的行包含均值为 $0$、方差为 $\\sigma^2$ 的独立同分布高斯噪声。\n- 改进度量：一个整数，如果对 $QA$ 的估计正确（等于 $r$）而对 $A$ 的估计不正确，则定义为 $1$；如果对 $A$ 的估计正确而对 $QA$ 的估计不正确，则为 $-1$；否则为 $0$。\n- 测试用例：\n  1. $m=50, n=40, r=30, K=3, \\sigma=10^{-6}, \\tau=10^{-3}$, 随机种子 $123$。\n  2. $m=40, n=50, r=30, K=3, \\sigma=10^{-6}, \\tau=10^{-3}$, 随机种子 $234$。\n  3. $m=60, n=60, r=60, K=4, \\sigma=10^{-6}, \\tau=10^{-3}$, 随机种子 $345$。\n  4. $m=80, n=20, r=18, K=2, \\sigma=10^{-6}, \\tau=10^{-3}$, 随机种子 $456$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地植根于线性代数（秩、零空间、正交矩阵）和数值线性代数（秩确定、数值稳定性、预处理）的基本原理。这些概念都是标准的，并且在科学上是合理的。\n- **良定性**：所要求的理论证明是一个标准结果。计算实验被精心定义，所有参数、矩阵结构、算法和评估指标都已指定。使用随机种子确保了计算实验具有唯一、可复现的结果。\n- **客观性**：语言精确且数学化，没有任何主观或基于观点的断言。\n\n该问题没有表现出任何科学不合理、模糊不清、信息缺失或矛盾等缺陷。测试矩阵 $A_0$ 的构造是一个经过深思熟虑的复杂选择，它创造了一个旨在让朴素的秩估计算法失效的场景，从而使得对改进的测试变得有意义。这是一个定义良好且具有实质内容的问题。\n\n**步骤3：结论与行动**\n该问题是有效的。将提供完整的解决方案。\n\n### 解答\n\n**第1部分：理论证明**\n\n我们的任务是证明对于一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个正交矩阵 $Q \\in \\mathbb{R}^{m \\times m}$，零空间在被 $Q$ 左乘后保持不变，即 $\\mathcal{N}(A) = \\mathcal{N}(Q A)$。我们将通过证明互包含关系来完成此证明。\n\n1.  **证明 $\\mathcal{N}(A) \\subseteq \\mathcal{N}(Q A)$**：\n    设 $x$ 是 $A$ 的零空间中的任意向量，即 $x \\in \\mathcal{N}(A)$。根据定义，这意味着：\n    $$A x = 0$$\n    其中 $0$ 是 $\\mathbb{R}^m$ 中的零向量。用矩阵 $Q$ 左乘该方程，我们得到：\n    $$Q (A x) = Q 0$$\n    使用矩阵乘法的结合律，我们有：\n    $$(Q A) x = 0$$\n    这个方程表明向量 $x$ 位于矩阵 $QA$ 的零空间中。因此，$x \\in \\mathcal{N}(Q A)$。因为 $x$ 是 $\\mathcal{N}(A)$ 中的任意元素，我们得出结论 $\\mathcal{N}(A) \\subseteq \\mathcal{N}(Q A)$。\n\n2.  **证明 $\\mathcal{N}(Q A) \\subseteq \\mathcal{N}(A)$**：\n    设 $y$ 是 $QA$ 的零空间中的任意向量，即 $y \\in \\mathcal{N}(Q A)$。根据定义：\n    $$(Q A) y = 0$$\n    给定矩阵 $Q$ 是正交的，这意味着 $Q^{\\top} Q = I_m$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。此性质意味着 $Q$ 是可逆的，且其逆是其转置，即 $Q^{-1} = Q^{\\top}$。用 $Q^{\\top}$ 左乘该方程，我们得到：\n    $$Q^{\\top} (Q A) y = Q^{\\top} 0$$\n    再次使用矩阵乘法的结合律：\n    $$(Q^{\\top} Q) A y = 0$$\n    代入 $Q^{\\top} Q = I_m$：\n    $$I_m A y = 0$$\n    $$A y = 0$$\n    这个方程表明向量 $y$ 位于矩阵 $A$ 的零空间中。因此，$y \\in \\mathcal{N}(A)$。因为 $y$ 是 $\\mathcal{N}(Q A)$ 中的任意元素，我们得出结论 $\\mathcal{N}(Q A) \\subseteq \\mathcal{N}(A)$。\n\n结合两个包含关系，我们证明了这两个集合是相同的：\n$$\\mathcal{N}(A) = \\mathcal{N}(Q A)$$\n\n**对零度和秩的影响**\n\n-   **零度**：矩阵的零度定义为其零空间的维数，$\\mathrm{nullity}(M) = \\dim(\\mathcal{N}(M))$。既然我们已经证明 $\\mathcal{N}(A) = \\mathcal{N}(Q A)$，它们的维数必须相等。因此：\n    $$\\mathrm{nullity}(A) = \\dim(\\mathcal{N}(A)) = \\dim(\\mathcal{N}(Q A)) = \\mathrm{nullity}(Q A)$$\n    零度在被正交矩阵左乘后保持不变。\n\n-   **秩**：秩-零度定理指出，对于任何矩阵 $M \\in \\mathbb{R}^{m \\times n}$，其秩与零度之和等于列数 $n$：\n    $$\\mathrm{rank}(M) + \\mathrm{nullity}(M) = n$$\n    将此定理应用于矩阵 $A$：\n    $$\\mathrm{rank}(A) = n - \\mathrm{nullity}(A)$$\n    将其应用于矩阵 $QA$：\n    $$\\mathrm{rank}(Q A) = n - \\mathrm{nullity}(Q A)$$\n    由于我们刚刚证明了 $\\mathrm{nullity}(A) = \\mathrm{nullity}(Q A)$，可以直接得出：\n    $$\\mathrm{rank}(A) = \\mathrm{rank}(Q A)$$\n    秩在被正交矩阵左乘后也保持不变。这便完成了理论证明。\n\n**第2部分：计算实验设计与实现**\n\n该实验旨在展示这一理论结果的一个实际方面。虽然 $\\mathrm{rank}(A)$ 和 $\\mathrm{rank}(QA)$ 在理论上是相同的，但它们的数值估计可能会因算法和矩阵结构的不同而显著差异。\n\n所选择的秩估计算法，一种无主元选择的高斯消元法，是刻意设计得比较朴素的。它的成功完全取决于在主对角线上找到足够大的元素。矩阵 $A$ 被构造为 $A_0 + E$。基础矩阵 $A_0$ 其唯一的非零项（全部等于 $1$）位于左下角，具体位置为 $(m-r+i, i)$（对于 $i \\in \\{0, \\dots, r-1\\}$）。这确保了 $A_0$ 的前 $\\min(m, n, r)$ 个对角线元素均为零。添加的噪声 $E$ 幅值很小（$\\sigma=10^{-6}$），因此它本身不太可能产生大于容差 $\\tau=10^{-3}$ 的对角线元素。因此，预计这个朴素算法在处理矩阵 $A$ 时会失败，估计出的秩远低于真实秩 $r$。\n\n用一个随机正交矩阵 $Q$ 左乘 $A$，实际上是对 $A$ 的行进行了一次随机的旋转/反射。这种“打乱”操作混合了各行，将 $A_0$ 左下角的大数值分布到 $QA$ 的许多行中。这极有可能在 $QA$ 的对角线上产生大数值的元素，从而使朴素算法能够正确识别主元并将秩估计为 $r$。\n\n实现将遵循这一逻辑，执行四个指定的测试用例并为每个用例计算改进度量。如果随机前乘“修正”了秩的估计，则该度量为 $1$；如果它“破坏”了估计，则为 $-1$；否则为 $0$。鉴于这种设置，我们预期在大多数（如果不是全部）初始结构使算法失效的情况下，改进值为 $1$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import qr\n\ndef solve():\n    \"\"\"\n    Executes the computational experiment to test the effect of orthogonal\n    premultiplication on a naive rank estimation algorithm.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    # Format: (m, n, r, K, sigma, tau, random_seed)\n    test_cases = [\n        (50, 40, 30, 3, 1e-6, 1e-3, 123),\n        (40, 50, 30, 3, 1e-6, 1e-3, 234),\n        (60, 60, 60, 4, 1e-6, 1e-3, 345),\n        (80, 20, 18, 2, 1e-6, 1e-3, 456),\n    ]\n\n    results = []\n\n    def estimate_rank_naive(matrix, tolerance):\n        \"\"\"\n        Estimates the rank of a matrix using a pivot-free Gaussian elimination\n        heuristic. The rank is the number of diagonal pivots with magnitude\n        greater than the tolerance. No pivoting is performed.\n        \"\"\"\n        M = matrix.copy()\n        m, n = M.shape\n        num_pivots = 0\n        max_pivots = min(m, n)\n        \n        for k in range(max_pivots):\n            # Check if the diagonal element can be accepted as a pivot\n            if np.abs(M[k, k]) > tolerance:\n                num_pivots += 1\n                pivot_val = M[k, k]\n                # Perform elimination on the rows below the pivot\n                for i in range(k + 1, m):\n                    factor = M[i, k] / pivot_val\n                    M[i, k:] -= factor * M[k, k:]\n        return num_pivots\n\n    for m, n, r, K, sigma, tau, seed in test_cases:\n        # Initialize the random number generator for reproducibility of the case\n        rng = np.random.default_rng(seed)\n\n        # 1. Construct the matrix A = A0 + E\n        # A0 has rank r with an identity block in the bottom-left\n        A0 = np.zeros((m, n))\n        if r > 0 and r = m and r = n:\n            row_indices = np.arange(m - r, m)\n            col_indices = np.arange(r)\n            A0[row_indices, col_indices] = 1.0\n\n        # E is zero except for K randomly chosen rows with Gaussian noise\n        E = np.zeros((m, n))\n        noise_row_indices = rng.choice(m, size=K, replace=False)\n        for row_idx in noise_row_indices:\n            E[row_idx, :] = rng.normal(loc=0.0, scale=sigma, size=n)\n\n        A = A0 + E\n\n        # 2. Generate a random orthogonal matrix Q of size m x m\n        # A standard method is to take the Q factor of a random Gaussian matrix's QR decomposition.\n        Z = rng.standard_normal((m, m))\n        Q, _ = qr(Z)\n\n        # 3. Estimate rank of A and QA\n        rank_A_est = estimate_rank_naive(A, tau)\n        \n        QA = Q @ A\n        rank_QA_est = estimate_rank_naive(QA, tau)\n\n        # 4. Calculate the improvement metric\n        est_A_correct = (rank_A_est == r)\n        est_QA_correct = (rank_QA_est == r)\n        \n        improvement = 0\n        if est_QA_correct and not est_A_correct:\n            improvement = 1\n        elif est_A_correct and not est_QA_correct:\n            improvement = -1\n        \n        results.append(improvement)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3558929"}]}