{"hands_on_practices": [{"introduction": "要真正掌握机器 epsilon 和单位舍入误差，最好的方法莫过于从头开始推导它们。这个练习将指导你为广泛使用的 `binary32`（单精度）系统计算这些关键值。通过探究为何在浮点运算中 $1+\\mathrm{eps} \\gt 1$ 而 $1+\\frac{1}{2}\\mathrm{eps} = 1$，你将亲身体验到舍入规则对计算结果的直接影响。[@problem_id:3558422]", "problem": "考虑电气和电子工程师协会 (IEEE) 的 binary32 浮点系统，其基数 $\\beta=2$，精度 $p=24$，使用规格化尾数，并采用四舍五入到最近的偶数（ties to even）的舍入规则。\n\n请基于规格化浮点表示和四舍五入到最近的标准定义进行推导，不要假设任何预先推导出的关于间距或误差的公式。\n\n设机器 epsilon $\\mathrm{eps}$ 定义为在该系统中 $1$ 与大于 $1$ 的最小浮点数之间的距离。\n设单位舍入误差 $u$ 定义为满足以下条件的最小正实数 $u$：对于在 $[1,2)$ 区间内的任意实数 $x$，在采用四舍五入到最近的偶数的规则下，其舍入后的浮点数 $\\mathrm{fl}(x)$ 满足不等式 $|\\mathrm{fl}(x)-x| \\leq u\\,|x|$。\n\n任务：\n- 根据指数为 $0$ 时的规格化二进制表示和尾数的结构推导出 $\\mathrm{eps}$。\n- 从第一性原理出发，推导出在指数区间 $[1,2)$ 内由四舍五入到最近的偶数规则所引起的最坏情况舍入误差界限 $u$。\n- 使用你的推导结果，解释为什么在浮点运算中 $1+\\mathrm{eps}>1$，而由于“tie-to-even”（平局向偶）规则，$1+\\frac{1}{2}\\mathrm{eps}$ 在相同的运算中会舍入为 $1$。\n\n将 $\\mathrm{eps}$ 和 $u$ 表示为 2 的精确幂。将你的最终答案以行向量 $(\\mathrm{eps},\\,u)$ 的形式报告。", "solution": "问题陈述是有效的。这是一个在数值分析领域中提法得当、有科学依据的问题，具体涉及 IEEE 754 binary32 浮点标准。所有必要的参数都已提供，并且机器 epsilon 和单位舍入误差的定义都是标准定义。\n\n在 IEEE binary32 系统中，一个规格化浮点数具有以下形式：\n$$ f = (-1)^s \\times (1.m)_{2} \\times 2^{E} $$\n其中 $s$ 是符号位，$(1.m)_2$ 是尾数（significand 或 mantissa），$E$ 是指数。该系统由基数 $\\beta=2$ 和精度 $p=24$ 定义。这意味着尾数总共有 $p=24$ 位：一个隐含的前导位（对于规格化数总是 $1$）和 $p-1=23$ 个显式的分数位。因此，尾数的形式为 $(1.d_1 d_2 \\dots d_{23})_2$。\n\n**1. 机器 Epsilon ($\\mathrm{eps}$) 的推导**\n\n机器 epsilon, $\\mathrm{eps}$，定义为 $1$ 与下一个可表示的更大浮点数之间的距离。\n数字 $1$ 在此系统中的表示是指数 $E=0$，尾数的小数部分全为零。其表示为：\n$$ 1 = (1.000\\dots0)_2 \\times 2^0 $$\n在这里，尾数在二进制小数点后有 $23$ 个零。\n\n下一个可表示的更大浮点数，我们称之为 $x_{\\text{next}}$，必须具有相同的指数 $E=0$，但其尾数要有尽可能小的增量。这可以通过将小数部分的最低有效位（LSB）从 $0$ 变为 $1$ 来实现。LSB 对应于二进制小数点后的第 $23$ 位，其权重为 $2^{-23}$。\n因此，$x_{\\text{next}}$ 的尾数是：\n$$ (1.000\\dots01)_2 $$\n其中 $1$ 在第 $23$ 位上。这个数的值是：\n$$ x_{\\text{next}} = (1.000\\dots01)_2 \\times 2^0 = 1 \\times 2^0 + 1 \\times 2^{-23} = 1 + 2^{-23} $$\n根据其定义，机器 epsilon 是 $x_{\\text{next}}$ 和 $1$ 之间的差：\n$$ \\mathrm{eps} = x_{\\text{next}} - 1 = (1 + 2^{-23}) - 1 = 2^{-23} $$\n这个结果可以推广到任何基数为 $\\beta=2$ 且精度为 $p$ 的系统。$1$ 之后的下一个数是 $1 + \\beta^{-(p-1)}$，所以 $\\mathrm{eps} = \\beta^{-(p-1)}$。对于 $\\beta=2$ 和 $p=24$，这得到 $\\mathrm{eps} = 2^{-(24-1)} = 2^{-23}$。\n\n**2. 单位舍入误差 ($u$) 的推导**\n\n单位舍入误差 $u$ 是将一个实数舍入为其浮点表示时所产生的最大相对误差。问题将其定义为满足以下条件的最小正数 $u$：对于每个实数 $x \\in [1, 2)$，舍入误差满足 $|\\mathrm{fl}(x) - x| \\leq u|x|$。这等同于寻找最大相对误差：\n$$ u = \\max_{x \\in [1, 2)} \\frac{|\\mathrm{fl}(x) - x|}{|x|} $$\n在区间（或指数区间 binade）$[1, 2)$ 中，所有浮点数的指数均为 $E=0$。可表示的数的形式为 $f_k = (1.d_1 d_2 \\dots d_{23})_2 \\times 2^0$。\n在这个指数区间中，任意两个连续浮点数之间的间距是均匀的。这个间距等于尾数 LSB 的值乘以指数项 $2^E = 2^0$。LSB 的权重是 $2^{-23}$。因此，间距为 $\\Delta = 2^{-23}$，这等于 $\\mathrm{eps}$。\n\n舍入规则是“四舍五入到最近”。对于一个实数 $x$，绝对误差 $|\\mathrm{fl}(x) - x|$ 最多是界定 $x$ 的两个浮点数之间间距的一半。\n$$ |\\mathrm{fl}(x) - x| \\leq \\frac{\\Delta}{2} = \\frac{\\mathrm{eps}}{2} $$\n因此，在指数区间 $[1, 2)$ 内舍入的最大绝对误差是：\n$$ \\max_{x \\in [1, 2)} |\\mathrm{fl}(x) - x| = \\frac{\\mathrm{eps}}{2} = \\frac{2^{-23}}{2} = 2^{-24} $$\n为了找到最大相对误差，我们必须将绝对误差除以 $|x|$，并在 $x \\in [1, 2)$ 上最大化该结果：\n$$ \\frac{|\\mathrm{fl}(x) - x|}{|x|} \\leq \\frac{2^{-24}}{|x|} $$\n当分母 $|x|$ 最小时，该表达式达到最大值。在区间 $[1, 2)$ 中，$|x|$ 的最小值为 $1$。\n因此，最大相对误差是：\n$$ u = \\frac{2^{-24}}{1} = 2^{-24} $$\n这表明 $u = \\frac{1}{2}\\mathrm{eps}$。\n\n**3. 算术结果的解释**\n\n我们使用推导出的值 $\\mathrm{eps} = 2^{-23}$ 和 $u = 2^{-24}$。\n\n*   **情况 1: `1 + eps`**\n    需要表示的实数是 $x = 1 + \\mathrm{eps} = 1 + 2^{-23}$。\n    在二进制中，这个数是 $(1.00\\dots01)_2$，其中 $1$ 在二进制小数点后的第 $23$ 位。其尾数是 $(1.m)$，其中 $m$ 是一个 23 位的字符串。这个数可以在 binary32 格式中精确表示，因为它的尾数正好需要 $p-1=23$ 个小数位。\n    由于 $1 + \\mathrm{eps}$ 是一个精确的浮点数，因此不需要舍入。\n    $$ \\mathrm{fl}(1 + \\mathrm{eps}) = 1 + \\mathrm{eps} = 1 + 2^{-23} $$\n    因为 $2^{-23} > 0$，结果 $1 + \\mathrm{eps}$ 严格大于 $1$。\n\n*   **情况 2: `1 + 0.5 * eps`**\n    需要表示的实数是 $x = 1 + \\frac{1}{2}\\mathrm{eps} = 1 + \\frac{1}{2}(2^{-23}) = 1 + 2^{-24}$。\n    在二进制中，这个数是 $(1.00\\dots001)_2$，其中 $1$ 在二进制小数点后的第 $24$ 位。这种表示需要 24 个小数位，比 binary32 尾数中可用的 $p-1=23$ 位多一位。因此，该数不能被精确表示，必须进行舍入。\n    数 $x = 1 + 2^{-24}$ 正好位于两个最近的可表示浮点数的中间：\n    $$ f_{\\text{lower}} = (1.00\\dots00)_2 \\times 2^0 = 1 $$\n    $$ f_{\\text{upper}} = (1.00\\dots01)_2 \\times 2^0 = 1 + 2^{-23} = 1 + \\mathrm{eps} $$\n    中点是 $f_{\\text{lower}} + \\frac{1}{2}(f_{\\text{upper}}-f_{\\text{lower}}) = 1 + \\frac{1}{2}(2^{-23}) = 1 + 2^{-24} = x$。\n    这是一个平局（tie）。舍入规则是“四舍五入到最近的偶数”。这意味着我们必须选择其尾数 LSB 为 $0$ 的那个可表示的数。\n    $f_{\\text{lower}}$ 的尾数是 $(1.00\\dots00)_2$。其第 $23$ 个小数位是 $0$。\n    $f_{\\text{upper}}$ 的尾数是 $(1.00\\dots01)_2$。其第 $23$ 个小数位是 $1$。\n    “偶数”的选择是 $f_{\\text{lower}}$，因为它的 LSB 是 $0$。\n    因此，$\\mathrm{fl}(1 + \\frac{1}{2}\\mathrm{eps})$ 向下舍入为 $1$。\n\n推导证实了 $\\mathrm{eps}=2^{-23}$ 和 $u=2^{-24}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 2^{-23}  2^{-24} \\end{pmatrix} } $$", "id": "3558422"}, {"introduction": "数值的舍入行为并非普适不变，而是取决于浮点系统的具体结构，特别是其基数和精度。这个思维实验要求你比较同一个实数在两种不同系统——一个简单的二进制系统和一个简单的十进制系统——中是如何被表示和舍入的。通过这个练习，你将深刻理解基数 $\\beta$ 和精度 $p$ 的选择如何从根本上决定了可表示数的集合，并最终影响舍入结果。[@problem_id:3558413]", "problem": "考虑两个规格化浮点数系统，每个系统由一个基数 $\\beta$、一个精度 $p$（尾数中基为$\\beta$的数字的总位数）和一个共用的指数范围 $e \\in \\{-2,-1,0,1,2\\}$ 定义。不允许出现非规格化数，舍入规则为舍入到最近值，平局时则选择使最后一位存储的尾数数字为偶数的表示。\n\n系统 $\\mathcal{F}_{A}$ 是二进制系统，其 $\\beta_{A} = 2$ 且 $p_{A} = 4$。系统 $\\mathcal{F}_{B}$ 是十进制系统，其 $\\beta_{B} = 10$ 且 $p_{B} = 2$。因此，这两个系统具有相同的动态范围，因为它们允许使用相同的指数 $e \\in \\{-2,-1,0,1,2\\}$，但它们的基数和精度不同。\n\n仅从浮点数系统 $\\mathcal{F}(\\beta,p,e_{\\min},e_{\\max})$ 的基本定义、规格化表示 $x = \\pm m \\beta^{e}$ (其中 $m \\in [1,\\beta)$)、机器 epsilon $\\varepsilon_{M} = \\beta^{1-p}$ ($1$与下一个更大的浮点数之间的间隙)，以及用于舍入到最近值的单位舍入误差 $u = \\tfrac{1}{2}\\,\\varepsilon_{M}$ 出发，确定实数 $x = 1.23$ 在每个系统中的舍入值。该数应被解释为一个规格化数，其指数 $e$ 与 $x \\in [1,\\beta)$ 一致。请以精确小数形式提供这两个舍入值。\n\n您的最终答案必须是一个单行向量，按顺序包含 $\\mathcal{F}_{A}$ 和 $\\mathcal{F}_{B}$ 的两个舍入值。除了上述浮点模型所隐含的舍入之外，不需要进行任何进一步的舍入。", "solution": "问题要求我们确定实数 $x=1.23$ 在两个不同的规格化浮点数系统 $\\mathcal{F}_{A}$ 和 $\\mathcal{F}_{B}$ 中的舍入值。舍入规则是舍入到最近值，平局时选择使尾数最后一位为偶数的表示。\n\n一个规格化浮点数表示为 $\\pm m \\times \\beta^{e}$，其中 $\\beta$ 是基数，$p$ 是精度（尾数 $m$ 的位数），$e$ 是指数。尾数 $m$ 必须满足 $1 \\le m  \\beta$。\n\n对于数字 $x = 1.23$，我们必须首先在每个系统中确定指数 $e$，以使尾数处于规格化范围内。由于 $1 \\le 1.23  2$ 且 $1 \\le 1.23  10$，对于系统 $\\mathcal{F}_A$ ($\\beta_A=2$) 和系统 $\\mathcal{F}_B$ ($\\beta_B=10$)，合适的指数均为 $e=0$。这意味着我们需要在每个系统中表示尾数 $m = 1.23$。\n\n**系统 $\\mathcal{F}_{A}$ (二进制)**\n\n系统 $\\mathcal{F}_{A}$ 由基数 $\\beta_{A} = 2$ 和精度 $p_{A} = 4$ 定义。\n要表示的数是 $x = 1.23$。我们已经确定其表示形式为 $m_{A} \\times 2^{0}$，其中尾数 $m_{A}$ 是以基数 $2$ 表示的 $1.23$ 的值。\n\n首先，我们将 $1.23$ 从十进制转换为二进制。\n整数部分为 $1_{10} = 1_{2}$。\n小数部分 $0.23$ 通过重复乘以 $2$ 进行转换：\n$0.23 \\times 2 = 0.46$ (第一个二进制小数位是 $0$)\n$0.46 \\times 2 = 0.92$ (第二位是 $0$)\n$0.92 \\times 2 = 1.84$ (第三位是 $1$)\n$0.84 \\times 2 = 1.68$ (第四位是 $1$)\n$0.68 \\times 2 = 1.36$ (第五位是 $1$)\n依此类推。这给出了二进制表示：\n$1.23_{10} = 1.00111..._{2}$\n\n精度 $p_{A}=4$ 意味着尾数可以有 $4$ 个二进制位。对于一个规格化数，其形式为 $(1.d_{1}d_{2}d_{3})_{2}$。\n我们这个数的尾数是 $(1.00111...)_{2}$。我们必须将其舍入到总共 $4$ 位。\n在 $\\mathcal{F}_{A}$ 中，两个最接近的可表示尾数是：\n1.  $m_{-} = (1.001)_{2}$\n2.  $m_{+} = (1.010)_{2}$\n\n让我们将它们转换回十进制，看看哪个更接近 $1.23$。\n$m_{-} = 1 \\times 2^{0} + 0 \\times 2^{-1} + 0 \\times 2^{-2} + 1 \\times 2^{-3} = 1 + \\frac{1}{8} = 1.125$。\n$m_{+} = 1 \\times 2^{0} + 0 \\times 2^{-1} + 1 \\times 2^{-2} + 0 \\times 2^{-3} = 1 + \\frac{1}{4} = 1.25$。\n\n现在我们应用“舍入到最近值”规则。我们计算 $1.23$ 到这两个值的距离：\n$|1.23 - m_{-}| = |1.23 - 1.125| = 0.105$。\n$|1.23 - m_{+}| = |1.23 - 1.25| = |-0.02| = 0.02$。\n\n由于 $0.02  0.105$，数字 $1.23$ 更接近 $1.25$。因此，在系统 $\\mathcal{F}_{A}$ 中的舍入值为 $1.25$。这不是平局情况，因此不使用平局处理规则。\n\n$\\mathcal{F}_{A}$ 中的浮点表示是 $(1.010)_{2} \\times 2^{0}$，对应十进制值 $1.25$。\n\n**系统 $\\mathcal{F}_{B}$ (十进制)**\n\n系统 $\\mathcal{F}_{B}$ 由基数 $\\beta_{B} = 10$ 和精度 $p_{B} = 2$ 定义。\n要表示的数是 $x = 1.23$，指数为 $e=0$，因此尾数是 $m_B = 1.23$。\n\n精度 $p_{B}=2$ 意味着尾数可以有 $2$ 个十进制位。对于一个规格化数，其中 $d_0 \\neq 0$，其形式为 $(d_{0}.d_{1})_{10}$。\n我们的尾数是 $1.23$。我们需要将其舍入到 $2$ 位。\n在 $\\mathcal{F}_{B}$ 中，两个最接近的可表示尾数是：\n1.  $m_{-} = 1.2$\n2.  $m_{+} = 1.3$\n\n我们通过计算距离来应用“舍入到最近值”规则：\n$|1.23 - m_{-}| = |1.23 - 1.2| = 0.03$。\n$|1.23 - m_{+}| = |1.23 - 1.3| = |-0.07| = 0.07$。\n\n由于 $0.03  0.07$，数字 $1.23$ 更接近 $1.2$。因此，在系统 $\\mathcal{F}_{B}$ 中的舍入值是 $1.2$。\n\n另外，使用基于数字的基数10舍入方法：我们检查要舍弃的第一个数字。这个数字是 $1.23$。我们保留 $2$ 位数字，所以我们考虑 $1.2|3$。第一个被舍弃的数字是 $3$。由于 $3$ 小于基数的一半 ($\\beta_B/2 = 10/2 = 5$)，我们向下舍入。将 $1.23$ 向下舍入到 $2$ 位有效数字得到 $1.2$。\n\n$\\mathcal{F}_{B}$ 中的浮点表示是 $(1.2)_{10} \\times 10^{0}$，对应十进制值 $1.2$。\n\n总结：\n- 在系统 $\\mathcal{F}_{A}$ 中，$1.23$ 的舍入值是 $1.25$。\n- 在系统 $\\mathcal{F}_{B}$ 中，$1.23$ 的舍入值是 $1.2$。\n\n问题要求将这两个值表示为一个单行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.25  1.2\n\\end{pmatrix}\n}\n$$", "id": "3558413"}, {"introduction": "在掌握了基本概念之后，我们将目光投向现代科学计算的基石——`binary64`（双精度）标准。本练习不仅要求你为这个更复杂的系统推导 $\\mathrm{eps}$ 和 $u$，更进一步要求你给出其十六进制表示。这个任务将帮助你打通浮点数的数学理论与其在计算机内存中实际位级编码之间的隔阂，从而建立更完整的知识体系。[@problem_id:3558455]", "problem": "考虑电气和电子工程师协会 (IEEE) 754 binary64 浮点系统，其基数 $\\beta=2$，精度 $p=53$，并采用向最近舍入、偶数优先的舍入规则。令 $\\mathrm{eps}$ 表示机器 Epsilon (machine epsilon)，定义为在该系统中，$1$ 与严格大于 $1$ 的下一个可表示的浮点数之间的差值。令 $u$ 表示单位舍入误差 (unit roundoff)，定义为在 $1$ 的邻域内，当实数根据偶数优先规则舍入到该系统中最接近的可表示浮点数时，所产生的最大相对舍入误差。\n\n仅使用这些定义以及 IEEE 754 binary64 对规格化数的编码结构（符号位、偏置为 $1023$ 的偏置指数、以及一个带有隐藏前导 $1$ 的 $52$ 位小数字段），确定：\n- $\\mathrm{eps}$ 和 $u$ 以 $2$ 的幂表示的精确值，以及\n- 浮点数 $\\mathrm{fl}(1+\\mathrm{eps})$ 和 $\\mathrm{fl}(1+u)$ 在该系统中的精确 $64$ 位十六进制编码（表示为 $16$ 位的十六进制数字字），其中 $\\mathrm{fl}(\\cdot)$ 表示向最近的可表示浮点数舍入，并遵循偶数优先规则。\n\n将您的最终答案表示为一个单行向量，按顺序包含 $\\mathrm{eps}$、$u$、$\\mathrm{fl}(1+\\mathrm{eps})$ 的十六进制编码以及 $\\mathrm{fl}(1+u)$ 的十六进制编码。您的答案中不需要进行数值舍入。将“十六进制编码”解释为规范的 $64$ 位字，表示为一个以 $0$x 为前缀的 $16$ 位十六进制数字字符串，按通常的最高有效十六进制位在前的顺序表示符号、指数和小数字段。", "solution": "在尝试提供解决方案之前，将根据指定标准对问题进行验证。\n\n### 第一步：提取已知条件\n- **系统**：IEEE 754 binary64 浮点系统\n- **基数**：$\\beta=2$\n- **精度**：$p=53$\n- **舍入规则**：向最近舍入，偶数优先\n- **机器 Epsilon 定义 ($\\mathrm{eps}$)**：1 与大于 1 的下一个可表示的浮点数之间的差值。\n- **单位舍入误差定义 ($u$)**：在 1 的邻域内，向最近的可表示数舍入时的最大相对舍入误差。\n- **编码结构**：规格化数使用一个符号位、一个偏置为 $1023$ 的偏置指数，以及一个带有隐藏前导 $1$ 的 $52$ 位小数字段。\n- **任务**：确定 $\\mathrm{eps}$ 和 $u$ 的精确值，以及 $\\mathrm{fl}(1+\\mathrm{eps})$ 和 $\\mathrm{fl}(1+u)$ 的 $64$ 位十六进制编码。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题完全基于 IEEE 754 标准，这是浮点算术的一个基本且普遍接受的规范。机器 Epsilon、单位舍入误差和数值表示等概念是数值分析的核心。该问题是科学上合理的。\n- **适定性**：该问题提供了精确的定义和所有必要的参数（$\\beta=2$，$p=53$，偏置=$1023$，舍入规则），以唯一确定所要求的值。问题清晰明确，并导向一个唯一的、稳定的解。\n- **客观性**：问题陈述使用正式、客观的语言。它不含任何主观论断、偏见或意见。\n- **结论**：该问题是自包含的、一致的且定义明确的。它符合所有有效性标准。\n\n### 第三步：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 求解过程\n一个规格化浮点数 $x$ 的 IEEE 754 binary64 格式由 $x = (-1)^s \\times (1.f)_2 \\times 2^E$ 给出，其中 $s$ 是符号位，$(1.f)_2$ 是尾数 (significand 或 mantissa)，$E$ 是指数。尾数精度为 $p=53$ 位，包括一个隐藏的前导位（对于规格化数，该位总是 $1$）和 $52$ 个显式的小数位，用位串 $f$ 表示。指数 $E$ 以偏置值 $e = E + 1023$ 的形式存储。\n\n首先，我们确定机器 Epsilon $\\mathrm{eps}$ 的值。\n数字 $1$ 在此系统中的表示为：$s=0$，指数 $E=0$，小数字段 $f$ 全为零。$1$ 的值为：$x_1 = (-1)^0 \\times (1.00...0)_2 \\times 2^0 = 1$。尾数为 $1.0$，总共有 $p=53$ 位（$1$ 个隐藏位，$52$ 个显式零位）。\n下一个更大的可表示数 $x_{next}$ 是通过将尾数的最低有效位 (LSB) 加一形成的。尾数变为 $(1.0...01)_2$，其中最后的 $1$ 位于小数点后第 $52$ 位。该位的值为 $2^{-52}$。\n$x_{next}$ 的值为：$x_{next} = (-1)^0 \\times (1.0 + 2^{-52}) \\times 2^0 = 1 + 2^{-52}$。根据定义，机器 Epsilon 是这两个数之差：\n$\\mathrm{eps} = x_{next} - x_1 = (1 + 2^{-52}) - 1 = 2^{-52}$。\n\n接下来，我们确定单位舍入误差 $u$。\n单位舍入误差是将一个实数舍入到最近的浮点数时产生的最大相对误差。对于一个数 $x$，误差的界限是 $x$ 周围可表示数之间间距的一半。两个连续机器数之间的间距称为“末位单位”或 ULP。对于任何数 $y \\in [1, 2)$，ULP 是恒定的，等于 $2^{-52}$，这恰好是 $\\mathrm{eps}$。\n因此，对于 $[1, 2)$ 中的一个数，最大绝对舍入误差为 $\\frac{1}{2} \\text{ULP}(1) = \\frac{1}{2}\\mathrm{eps}$。当分母最小时，即对于此区间中最小的数（即一个恰好大于 $1$ 的数），相对误差最大。因此，最大相对舍入误差为：\n$u = \\frac{\\frac{1}{2}\\mathrm{eps}}{1} = \\frac{1}{2}\\mathrm{eps} = \\frac{1}{2} \\times 2^{-52} = 2^{-53}$。\n\n现在我们确定 $\\mathrm{fl}(1+\\mathrm{eps})$ 的十六进制编码。\n我们有 $\\mathrm{eps} = 2^{-52}$。要表示的值是 $1 + \\mathrm{eps} = 1 + 2^{-52}$。如 $\\mathrm{eps}$ 的推导所示，这恰好是 $1$ 之后的下一个可表示的浮点数。由于它是一个精确可表示的数，舍入函数 $\\mathrm{fl}(\\cdot)$ 返回该数本身：\n$\\mathrm{fl}(1+\\mathrm{eps}) = 1 + 2^{-52}$。\n为了找到它的编码，我们确定其组成部分：\n- 符号：该数为正，所以符号位 $s=0$。\n- 指数：值为 $(1+2^{-52}) \\times 2^0$，所以真实指数为 $E=0$。偏置指数为 $e = E + 1023 = 1023$。在 $11$ 位二进制中，$1023 = (01111111111)_2$。\n- 小数部分：尾数是 $1+2^{-52} = (1.00...01)_2$。隐藏的前导 $1$ 不被存储。$52$ 位的小数字段 $f$ 由 $51$ 个零后跟一个 $1$ 组成，即 $f = (00...001)_2$。\n$64$ 位表示是 $s | e | f$ 的串联：\n$0 | 01111111111 | 00...001$（小数字段中有 $51$ 个零）。\n将这些位分组为 $16$ 个十六进制数字，得到十六进制字符串 $3FF0000000000001$。\n\n最后，我们确定 $\\mathrm{fl}(1+u)$ 的十六进制编码。\n我们有 $u = 2^{-53}$。要表示的值是 $1 + u = 1 + 2^{-53}$。这个数不能被精确表示。它恰好位于两个连续的可表示数 $x_1 = 1$ 和 $x_{next} = 1 + 2^{-52}$ 的正中间。\n中点是 $\\frac{x_1 + x_{next}}{2} = \\frac{1 + (1 + 2^{-52})}{2} = \\frac{2 + 2^{-52}}{2} = 1 + 2^{-53}$。\n我们遇到了一个平局 (tie)。舍入规则是“向最近舍入，偶数优先”。这意味着我们必须舍入到其尾数的最低有效位为 $0$ 的那个邻近数。\n- $x_1 = 1$ 的尾数是 $(1.00...0)_2$。其小数字段全为零，所以其 LSB 是 $0$。\n- $x_{next} = 1+2^{-52}$ 的尾数是 $(1.00...01)_2$。其小数字段的 LSB 是 $1$。\n“偶数”的选择是 $x_1 = 1$。因此，$\\mathrm{fl}(1+u) = 1$。\n数字 $1$ 的十六进制表示如下找到：\n- 符号：$s=0$。\n- 指数：$E=0$，所以偏置指数为 $e=1023 = (01111111111)_2$。\n- 小数部分：尾数是 $1.0$，所以小数字段 $f$ 全为零：$f=(00...000)_2$。\n$64$ 位表示为：\n$0 | 01111111111 | 00...000$（小数字段中有 $52$ 个零）。\n分组为十六进制数字，得到十六进制字符串 $3FF0000000000000$。\n\n最终答案由这四个结果组成一个单行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2^{-52}  2^{-53}  \\text{3FF0000000000001}  \\text{3FF0000000000000}\n\\end{pmatrix}\n}\n$$", "id": "3558455"}]}