{"hands_on_practices": [{"introduction": "掌握共轭梯度法的第一步是亲手实践其核心计算过程。本练习将引导你对一个简单的二维对称正定系统，从零开始完整计算第一步迭代所需的所有量。通过这个具体计算 [@problem_id:3371621]，你将深入理解算法中各个参数（如步长 $\\alpha_0$ 和方向更新系数 $\\beta_0$）是如何从优化原理中自然导出的，从而为理解更复杂的应用奠定坚实基础。", "problem": "考虑一个由计算流体力学中的椭圆算子（例如在最小控制体格式上的压力泊松方程）的对称正定离散化所产生的线性系统。设矩阵为 $A=\\begin{pmatrix}4  1 \\\\ 1  3\\end{pmatrix}$，右端项为 $b=\\begin{pmatrix}1\\\\2\\end{pmatrix}$，初始迭代向量为 $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$。共轭梯度法 (CG) 是通过在克里洛夫子空间上最小化二次泛函 $\\phi(x)=\\frac{1}{2}x^{\\top}Ax-b^{\\top}x$ 推导出来的，其中残差为 $r_{k}=b-Ax_{k}$，搜索方向是相互 A-共轭的，并且步长的选择使得新的残差在欧几里得内积下与当前搜索方向正交。从这些基本原理出发，并且不假设任何简化公式，为给定的 $A$、$b$ 和 $x_{0}$ 显式地计算第一步的量 $\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。提供精确值，不要进行舍入。报告时，将最终答案表示为行向量 $\\left(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0}\\right)$，其中 $x_{1,i}$ 和 $r_{1,i}$ 分别表示 $x_{1}$ 和 $r_{1}$ 的分量。", "solution": "该问题是适定的且在科学上是合理的。它要求计算给定线性系统的共轭梯度 (CG) 法的第一次迭代，从算法的基本原理出发，而不是依赖于现成的算法总结。\n\n待求解的系统是 $Ax=b$，其中矩阵 $A$ 是对称正定 (SPD) 的。CG 方法通过最小化二次泛函 $\\phi(x) = \\frac{1}{2}x^{\\top}Ax - b^{\\top}x$ 来迭代地构造解。该泛函的梯度是 $\\nabla\\phi(x) = Ax - b$，即残差 $r(x) = b - Ax$ 的负值。因此，最小化 $\\phi(x)$ 等价于找到满足 $\\nabla\\phi(x) = 0$ 的 $x$，这正是 $Ax=b$ 的解。\n\n给定的量如下：\n矩阵 $A = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n右端向量 $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n解的初始猜测 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n对于迭代 $k=0, 1, 2, ...$，CG 算法按以下步骤进行：\n1. 更新解：$x_{k+1} = x_{k} + \\alpha_{k} p_{k}$\n2. 更新残差：$r_{k+1} = r_{k} - \\alpha_{k} A p_{k}$\n3. 更新搜索方向：$p_{k+1} = r_{k+1} + \\beta_{k} p_{k}$\n\n参数 $\\alpha_k$ 和 $\\beta_k$ 是从核心原理推导得出的。\n\n**步骤 0：初始化**\n\n首先，我们根据初始猜测 $x_0$ 计算初始残差 $r_0$。\n$$r_{0} = b - Ax_{0}$$\n当 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 时，初始残差就是 $b$：\n$$r_{0} = b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n第一个搜索方向 $p_0$ 选择为最速下降方向，即初始残差：\n$$p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n\n**步骤 1：第一次迭代 ($k=0$)**\n\n我们需要计算 $\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。\n\n**计算步长 $\\alpha_{0}$**\n选择步长 $\\alpha_{0}$ 是为了沿着搜索方向 $p_0$ 最小化 $\\phi(x_{1}) = \\phi(x_{0} + \\alpha_{0} p_{0})$。当新的残差 $r_{1}$ 与当前搜索方向 $p_{0}$ 正交时，即 $p_{0}^{\\top}r_{1} = 0$，达到最小值。\n新的残差由 $r_{1} = b - Ax_{1} = b - A(x_{0} + \\alpha_{0} p_{0}) = (b - Ax_{0}) - \\alpha_{0}Ap_{0} = r_0 - \\alpha_0 A p_0$ 给出。\n将此代入正交性条件：\n$$p_{0}^{\\top}(r_{0} - \\alpha_{0} A p_{0}) = 0$$\n$$p_{0}^{\\top}r_{0} - \\alpha_{0} p_{0}^{\\top}A p_{0} = 0$$\n解出 $\\alpha_0$ 得到：\n$$\\alpha_{0} = \\frac{p_{0}^{\\top}r_{0}}{p_{0}^{\\top}A p_{0}}$$\n因为 $p_0 = r_0$，上式变为：\n$$\\alpha_{0} = \\frac{r_{0}^{\\top}r_{0}}{r_{0}^{\\top}A r_{0}}$$\n我们计算必要的量：\n$r_{0}^{\\top}r_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (1)(1) + (2)(2) = 1 + 4 = 5$。\n$A p_{0} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) \\\\ 1(1) + 3(2) \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$。\n$p_{0}^{\\top}A p_{0} = r_{0}^{\\top}A p_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (1)(6) + (2)(7) = 6 + 14 = 20$。\n代入这些值：\n$$\\alpha_{0} = \\frac{5}{20} = \\frac{1}{4}$$\n\n**计算新的迭代向量 $x_{1}$**\n新的解的估计值 $x_1$ 是通过从 $x_0$ 沿方向 $p_0$ 移动步长 $\\alpha_0$ 得到的：\n$$x_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{2}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$$\n所以，$x_{1,1} = \\frac{1}{4}$ 并且 $x_{1,2} = \\frac{1}{2}$。\n\n**计算新的残差 $r_{1}$**\n新的残差 $r_1$ 可以使用更新公式计算：\n$$r_{1} = r_{0} - \\alpha_{0} A p_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{1}{4} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{6}{4} \\\\ 2 - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{4} - \\frac{6}{4} \\\\ \\frac{8}{4} - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{4} \\\\ \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$$\n所以，$r_{1,1} = -\\frac{1}{2}$ 并且 $r_{1,2} = \\frac{1}{4}$。\n\n**计算系数 $\\beta_{0}$**\n系数 $\\beta_0$ 用于构造下一个搜索方向 $p_1 = r_1 + \\beta_0 p_0$。基本原理是新的搜索方向 $p_1$ 必须与前一个方向 $p_0$ A-共轭，即 $p_{1}^{\\top}A p_{0} = 0$。\n$$(r_{1} + \\beta_{0} p_{0})^{\\top}A p_{0} = 0$$\n$$r_{1}^{\\top}A p_{0} + \\beta_{0} p_{0}^{\\top}A p_{0} = 0$$\n解出 $\\beta_0$：\n$$\\beta_{0} = -\\frac{r_{1}^{\\top}A p_{0}}{p_{0}^{\\top}A p_{0}}$$\n我们从前面的计算中得到：$A p_0 = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$ 和 $p_{0}^{\\top}A p_{0} = 20$。\n我们需要计算分子：\n$r_{1}^{\\top}A p_{0} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (-\\frac{1}{2})(6) + (\\frac{1}{4})(7) = -3 + \\frac{7}{4} = -\\frac{12}{4} + \\frac{7}{4} = -\\frac{5}{4}$。\n现在我们可以计算 $\\beta_0$：\n$$\\beta_{0} = - \\frac{-\\frac{5}{4}}{20} = \\frac{5}{4 \\cdot 20} = \\frac{5}{80} = \\frac{1}{16}$$\n\n所要求的量是 $\\alpha_{0} = \\frac{1}{4}$，$x_{1} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$，$r_{1} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$ 和 $\\beta_{0} = \\frac{1}{16}$。\n最终答案被组合成指定的行向量格式 $(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0})$。\n这就得到了行向量 $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{2}, -\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{16})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{16} \\end{pmatrix}}$$", "id": "3371621"}, {"introduction": "共轭梯度法之所以如此高效，其核心在于它构建了一组 $A$-共轭的搜索方向。本练习将通过一个对角矩阵的简单例子，让你亲自推导并验证这一关键性质 [@problem_id:3371638]。通过显式计算并确认搜索方向 $p_0$ 和 $p_1$ 满足 $p_{0}^{T} A p_{1} = 0$，你将对“共轭”这一概念的几何与代数意义有更深刻的认识。", "problem": "考虑一个源于计算流体力学 (CFD) 的线性系统，其中一个预处理扩散算子的局部对角块被建模为一个对称正定 (SPD) 矩阵。设二次泛函为 $f(x) = \\frac{1}{2} x^{T} A x - b^{T} x$，其中 $A = \\mathrm{diag}(1, 2, 3)$，$b = (1, 1, 1)^{T}$，初始猜测值为 $x_{0} = (0, 0, 0)^{T}$。从第一性原理出发——即通过最速下降法确定初始方向以最小化 $f(x)$，并对后续方向强制施加 $A$-共轭条件——执行以下操作：\n\n1. 应用于 $f(x)$ 的最速下降原理，计算初始残差 $r_{0}$ 和第一个搜索方向 $p_{0}$。\n2. 通过沿 $p_{0}$ 方向的精确线搜索确定步长 $\\alpha_{0}$，更新 $x_{1}$ 并计算新的残差 $r_{1}$。\n3. 通过在搜索方向之间施加 $A$-共轭条件来确定标量 $\\beta_{0}$，并据此构造 $p_{1}$。\n4. 显式地验证 $p_{0}^{T} A p_{1} = 0$。\n\n将 $p_{0}^{T} A p_{1}$ 的值作为最终答案报告。无需四舍五入。将最终答案表示为不带单位的纯数字。", "solution": "该问题被验证为具有科学依据、适定、客观且完整。这是共轭梯度算法初始步骤的一个标准应用，该算法是求解线性系统的数值方法的基石，尤其是在计算流体力学 (CFD) 等领域。所提供的矩阵 $A$ 是对称的，其特征值为对角线元素 $1$、$2$ 和 $3$，它们都是正数。因此，如题所述，$A$ 是对称正定 (SPD) 的，这确保了问题的适定性。我们可以继续进行求解。\n\n该问题要求从第一性原理出发，执行共轭梯度法的第一步迭代。目标是找到二次泛函 $f(x) = \\frac{1}{2} x^{T} A x - b^{T} x$ 的最小值。$f(x)$ 的最小化子是线性系统 $Ax = b$ 的解。该泛函的梯度为 $\\nabla f(x) = Ax - b$。系统的残差定义为 $r(x) = b - Ax$。因此，残差是负梯度，即 $r(x) = -\\nabla f(x)$，所以它指向 $f(x)$ 的最速下降方向。\n\n给定的数据是：\n矩阵 $A = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix}$。\n向量 $b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n初始猜测值 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n我们遵循要求的步骤。\n\n1.  计算初始残差 $r_{0}$ 和第一个搜索方向 $p_{0}$。\n\n初始残差 $r_0$ 是在初始猜测值 $x_0$ 处计算的：\n$$r_{0} = b - A x_{0}$$\n代入给定值：\n$$r_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n在共轭梯度法中，第一个搜索方向 $p_0$ 取为最速下降方向，即初始残差 $r_0$：\n$$p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n\n2.  确定步长 $\\alpha_{0}$，更新 $x_{1}$，并计算新的残差 $r_{1}$。\n\n下一个迭代点由 $x_{1} = x_{0} + \\alpha_{0} p_{0}$ 给出。最优步长 $\\alpha_0$ 是通过最小化 $f(x_1)$ 关于 $\\alpha_0$ 的值来找到的。这是一个精确线搜索。我们将 $f(x_0 + \\alpha p_0)$ 关于 $\\alpha$ 的导数设为零。\n$$\\frac{d}{d\\alpha} f(x_{0} + \\alpha p_{0}) = \\nabla f(x_{0} + \\alpha p_{0})^{T} p_{0} = 0$$\n使用 $\\nabla f(x) = Ax - b$，我们得到：\n$$(A(x_{0} + \\alpha_{0} p_{0}) - b)^{T} p_{0} = 0$$\n$$(A x_{0} - b + \\alpha_{0} A p_{0})^{T} p_{0} = 0$$\n因为 $r_0 = b - Ax_0$ 且 $p_0 = r_0$：\n$$(-r_{0} + \\alpha_{0} A p_{0})^{T} p_{0} = 0$$\n$$-r_{0}^{T} p_{0} + \\alpha_{0} p_{0}^{T} A p_{0} = 0$$\n解出 $\\alpha_0$：\n$$\\alpha_{0} = \\frac{r_{0}^{T} p_{0}}{p_{0}^{T} A p_{0}}$$\n因为 $p_0=r_0$，这可以简化为：\n$$\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{r_{0}^{T} A r_{0}}$$\n我们计算必要的点积：\n$$r_{0}^{T} r_{0} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 = 3$$\n$$A r_{0} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$$\n$$r_{0}^{T} A r_{0} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = 1 \\cdot 1 + 1 \\cdot 2 + 1 \\cdot 3 = 6$$\n步长为：\n$$\\alpha_{0} = \\frac{3}{6} = \\frac{1}{2}$$\n现在我们更新解向量 $x_1$：\n$$x_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$$\n并计算新的残差 $r_1$：\n$$r_{1} = b - A x_{1} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix}$$\n\n3.  确定标量 $\\beta_{0}$ 并构造 $p_{1}$。\n\n下一个搜索方向 $p_1$ 是新残差 $r_1$ 和前一个搜索方向 $p_0$ 的线性组合：\n$$p_{1} = r_{1} + \\beta_{0} p_{0}$$\n选择标量 $\\beta_0$ 以强制 $p_1$ 和 $p_0$ 之间满足 $A$-共轭（也称为 $A$-正交），即条件 $p_{0}^{T} A p_{1} = 0$：\n$$p_{0}^{T} A (r_{1} + \\beta_{0} p_{0}) = 0$$\n$$p_{0}^{T} A r_{1} + \\beta_{0} p_{0}^{T} A p_{0} = 0$$\n解出 $\\beta_0$：\n$$\\beta_{0} = - \\frac{p_{0}^{T} A r_{1}}{p_{0}^{T} A p_{0}}$$\n由于 A 是对称的，$p_{0}^{T} A r_{1} = (A p_{0})^{T} r_{1}$。\n分母之前已经计算过：$p_{0}^{T} A p_{0} = r_{0}^{T} A r_{0} = 6$。\n我们计算分子：\n$$A p_{0} = A r_0 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$$\n$$(A p_{0})^{T} r_{1} = \\begin{pmatrix} 1  2  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix} = 1 \\cdot \\frac{1}{2} + 2 \\cdot 0 + 3 \\cdot \\left(-\\frac{1}{2}\\right) = \\frac{1}{2} - \\frac{3}{2} = -1$$\n因此，我们求得 $\\beta_0$：\n$$\\beta_{0} = - \\frac{-1}{6} = \\frac{1}{6}$$\n现在我们构造新的搜索方向 $p_1$：\n$$p_{1} = r_{1} + \\beta_{0} p_{0} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2} \\end{pmatrix} + \\frac{1}{6} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} + \\frac{1}{6} \\\\ 0 + \\frac{1}{6} \\\\ -\\frac{1}{2} + \\frac{1}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{3+1}{6} \\\\ \\frac{1}{6} \\\\ \\frac{-3+1}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{6} \\\\ \\frac{1}{6} \\\\ -\\frac{2}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix}$$\n\n4.  显式地验证 $p_{0}^{T} A p_{1} = 0$。\n\n这最后一步确认了我们计算出的 $\\beta_0$ 值正确地施加了 $A$-共轭性。我们用已求得的向量直接进行计算。\n$$p_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\quad \\text{和} \\quad p_{1} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix}$$\n首先，计算 $A p_1$：\n$$A p_{1} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{6} \\\\ -\\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot \\frac{2}{3} \\\\ 2 \\cdot \\frac{1}{6} \\\\ 3 \\cdot (-\\frac{1}{3}) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{2}{6} \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ -1 \\end{pmatrix}$$\n现在，计算点积 $p_0^T (A p_1)$：\n$$p_{0}^{T} A p_{1} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ -1 \\end{pmatrix} = 1 \\cdot \\frac{2}{3} + 1 \\cdot \\frac{1}{3} + 1 \\cdot (-1) = \\frac{2}{3} + \\frac{1}{3} - 1 = \\frac{3}{3} - 1 = 1 - 1 = 0$$\n计算证实了 $p_0$ 和 $p_1$ 是 $A$-共轭的。表达式 $p_{0}^{T} A p_{1}$ 的值恰好为 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3371638"}, {"introduction": "在实际应用中，我们不仅关心算法如何工作，更关心其收敛速度。共轭梯度法的收敛性与线性系统矩阵的谱条件数 $\\kappa(A)$ 密切相关。本练习 [@problem_id:3371645] 提供了一个具体场景，要求你利用经典的收敛上界理论，来估算达到特定误差精度所需的迭代次数。这让你能够将抽象的矩阵理论与算法的实际计算成本联系起来，并理解为什么预处理技术（旨在降低 $\\kappa(A)$）在科学计算中至关重要。", "problem": "考虑一个对称正定线性系统 $A x = b$，该系统源于不可压缩流中稳态压力泊松方程在均匀网格上的单元中心有限体积离散化。其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，其谱条件数 $\\kappa(A)$ 定义为 $\\kappa(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$。对此系统应用共轭梯度法 (CG)，计算过程采用精确算术且无预处理。假设已知谱条件数为 $\\kappa(A) = 10^{4}$。使用共轭梯度法在$A$-范数下关于$\\kappa(A)$的标准最坏情况误差界，确定最小的整数迭代次数$k$，使得该界保证从任意初始误差开始，$A$-范数误差缩减因子最多为$10^{-6}$。将最终的迭代次数表示为一个不带单位的整数。", "solution": "问题要求确定共轭梯度法 (CG) 为保证线性系统 $A x = b$ 达到指定的误差缩减所需满足的最小整数迭代次数，记为 $k$。给定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的。分析依赖于 CG 方法的标准最坏情况收敛界。\n\n第 $k$ 次迭代的误差定义为 $e_k = x_k - x$，其中 $x_k$ 是第 $k$ 次迭代的近似解，$x$ 是精确解。误差用 $A$-范数来衡量，对于任意向量 $v \\in \\mathbb{R}^n$，$A$-范数定义为 $\\|v\\|_A = \\sqrt{v^T A v}$。CG 方法经过 $k$ 次迭代后，$A$-范数下的相对误差缩减的经典上界由以下不等式给出：\n$$ \\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k $$\n其中 $e_0$ 是初始误差，$\\kappa(A)$ 是矩阵 $A$ 的谱条件数，定义为其最大特征值与最小特征值之比，即 $\\kappa(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。\n\n问题提供了以下数据：\n1. 谱条件数为 $\\kappa(A) = 10^4$。\n2. 期望的误差缩减因子最多为 $10^{-6}$。这意味着我们要寻找最小的 $k$，使得误差比的上界小于或等于这个值：$\\frac{\\|e_k\\|_A}{\\|e_0\\|_A} \\leq 10^{-6}$。\n\n我们必须找到满足以下不等式的最小整数 $k$，其中理论界的右侧受所需缩减因子的约束：\n$$ 2 \\left( \\frac{\\sqrt{\\kappa(A)} - 1}{\\sqrt{\\kappa(A)} + 1} \\right)^k \\leq 10^{-6} $$\n我们代入给定的值 $\\kappa(A) = 10^4$。首先，计算条件数的平方根：\n$$ \\sqrt{\\kappa(A)} = \\sqrt{10^4} = 10^2 = 100 $$\n将此代入不等式，得到：\n$$ 2 \\left( \\frac{100 - 1}{100 + 1} \\right)^k \\leq 10^{-6} $$\n$$ 2 \\left( \\frac{99}{101} \\right)^k \\leq 10^{-6} $$\n为了求解整数 $k$，我们首先分离出以 $k$ 为幂的项：\n$$ \\left( \\frac{99}{101} \\right)^k \\leq \\frac{1}{2} \\times 10^{-6} $$\n接下来，我们对不等式两边取自然对数。由于自然对数 $\\ln(x)$ 对于 $x0$ 是一个单调递增函数，所以不等式的方向保持不变：\n$$ \\ln\\left[ \\left( \\frac{99}{101} \\right)^k \\right] \\leq \\ln\\left( \\frac{1}{2} \\times 10^{-6} \\right) $$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$，我们得到：\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq \\ln\\left( \\frac{1}{2} \\right) + \\ln(10^{-6}) $$\n$$ k \\ln\\left( \\frac{99}{101} \\right) \\leq -\\ln(2) - 6 \\ln(10) $$\n由于项 $\\ln(99/101)$ 的参数 $99/101$ 小于 1，所以该项为负数。因此，当我们两边同除以 $\\ln(99/101)$ 来分离 $k$ 时，必须反转不等号的方向：\n$$ k \\geq \\frac{-\\ln(2) - 6 \\ln(10)}{\\ln(99/101)} $$\n为了方便计算，可以将分子和分母同乘以 $-1$，并利用性质 $-\\ln(x/y) = \\ln(y/x)$，从而得到表达式：\n$$ k \\geq \\frac{\\ln(2) + 6 \\ln(10)}{\\ln(101/99)} $$\n为了求出 $k$ 的这个下界的数值，我们使用自然对数的标准值：$\\ln(2) \\approx 0.693147$ 和 $\\ln(10) \\approx 2.302585$。\n分子是：\n$$ \\ln(2) + 6 \\ln(10) \\approx 0.693147 + 6 \\times (2.302585) = 0.693147 + 13.81551 = 14.508657 $$\n分母是：\n$$ \\ln\\left(\\frac{101}{99}\\right) = \\ln(101) - \\ln(99) \\approx 4.6151205 - 4.5951198 = 0.0200007 $$\n现在，我们计算比率：\n$$ k \\geq \\frac{14.508657}{0.0200007} \\approx 725.409 $$\n迭代次数 $k$ 必须是一个整数。不等式 $k \\geq 725.409$ 要求我们找到满足此条件的最小整数。这可以通过对数值向上取整得到：\n$$ k = \\lceil 725.409 \\rceil = 726 $$\n因此，最坏情况界保证误差缩减最多为 $10^{-6}$ 所需的最小迭代次数为 $726$ 次。", "answer": "$$\\boxed{726}$$", "id": "3371645"}]}