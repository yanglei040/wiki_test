{"hands_on_practices": [{"introduction": "理论学习之后，通过一个具体的例子来手动执行雅可比迭代是理解其工作原理的最佳方式。这个练习 [@problem_id:3581650] 将引导你从第一性原理出发，为一个简单的 $2 \\times 2$ 系统构建雅可比迭代格式，并计算前两次迭代的结果。通过将迭代解与精确解进行比较，你可以直观地感受到误差是如何随迭代变化的。", "problem": "设 $A=\\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}$，$b=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，初始迭代值为 $x^{0}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。从求解线性系统 $A x = b$ 的定常迭代法的定义出发，通过分裂 $A=M-N$ 产生一个仿射迭代 $x^{k+1}=G x^{k}+c$，请通过选择合适的 $M$ 和 $N$ 将此构造具体化为雅可比方法，并为此 $A$ 和 $b$ 推导相应的迭代矩阵和仿射项。然后，仅使用此第一性原理构造，执行两步雅可比方法以获得 $x^{1}$ 和 $x^{2}$。计算 $A x=b$ 的精确解 $x^{\\star}$，并由此计算误差向量 $e^{1}=x^{1}-x^{\\star}$ 和 $e^{2}=x^{2}-x^{\\star}$。最后，以精确形式确定欧几里得范数 $\\|e^{2}\\|_{2}$。请给出精确值（无四舍五入）。您最终报告的答案必须是 $\\|e^{2}\\|_{2}$ 的单个精确值，不带任何额外评论。", "solution": "用户提供了一个数值线性代数中的适定问题。问题陈述科学合理、自洽且客观。求解所需的所有数据均已给出且一致。我将继续进行求解。\n\n问题要求使用雅可比方法求解线性系统 $A x = b$，其中\n$$A=\\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \\quad b=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$$\n初始猜测值为 $x^{0}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n定常迭代法源于将矩阵 $A$ 分裂为 $A = M-N$，其中 $M$ 是非奇异的。迭代公式为 $M x^{k+1} = N x^{k} + b$，可重写为\n$$x^{k+1} = M^{-1}N x^{k} + M^{-1}b$$\n这对应于一般仿射迭代形式 $x^{k+1} = Gx^k + c$，其中迭代矩阵为 $G=M^{-1}N$，仿射项为 $c=M^{-1}b$。\n\n雅可比方法基于矩阵分裂 $A=M-N$。根据本文的约定，我们将 $A$ 分解为 $A = D-L-U$，其中 $D$ 是对角部分，$-L$ 是严格下三角部分，$-U$ 是严格上三角部分。对于给定的矩阵 $A$，我们有：\n$$D = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix}, \\quad L = \\begin{pmatrix}0  0 \\\\ 1  0\\end{pmatrix}, \\quad U = \\begin{pmatrix}0  1 \\\\ 0  0\\end{pmatrix}$$\n雅可比方法的分裂选择为 $M=D$ 和 $N=L+U$。因此，迭代公式为 $D x^{k+1} = (L+U) x^{k} + b$。\n相应的迭代矩阵 $G_J$ 和向量 $c_J$ 为：\n$$G_J = M^{-1}N = D^{-1}(L+U)$$\n$$c_J = M^{-1}b = D^{-1}b$$\n首先，我们求 $D$ 的逆矩阵：\n$$D^{-1} = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix}^{-1} = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix}$$\n接下来，我们计算 $G_J$：\n$$L+U = \\begin{pmatrix}0  0 \\\\ 1  0\\end{pmatrix} + \\begin{pmatrix}0  1 \\\\ 0  0\\end{pmatrix} = \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}$$\n$$G_J = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix} = \\begin{pmatrix}0  \\frac{1}{2} \\\\ \\frac{1}{2}  0\\end{pmatrix}$$\n现在，我们计算 $c_J$：\n$$c_J = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix}$$\n针对此特定问题的雅可比迭代为 $x^{k+1} = G_J x^{k} + c_J$：\n$$x^{k+1} = \\begin{pmatrix}0  \\frac{1}{2} \\\\ \\frac{1}{2}  0\\end{pmatrix} x^k + \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix}$$\n我们被要求从 $x^{0} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 开始，执行此方法两步。\n\n第 1 步 (k=0):\n$$x^{1} = G_J x^{0} + c_J = \\begin{pmatrix}0  \\frac{1}{2} \\\\ \\frac{1}{2}  0\\end{pmatrix} \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} + \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix} + \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix}$$\n所以，$x^{1} = \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix}$。\n\n第 2 步 (k=1):\n$$x^{2} = G_J x^{1} + c_J = \\begin{pmatrix}0  \\frac{1}{2} \\\\ \\frac{1}{2}  0\\end{pmatrix} \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} + \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix} + \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{4}\\end{pmatrix}$$\n所以，$x^{2} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{4}\\end{pmatrix}$。\n\n接下来，我们计算 $Ax=b$ 的精确解 $x^{\\star}$。\n$$\\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}x_1 \\\\ x_2\\end{pmatrix} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$$\n这得到线性方程组：\n$$2x_1 - x_2 = 1$$\n$$-x_1 + 2x_2 = 0$$\n从第二个方程，我们得到 $x_1 = 2x_2$。将此代入第一个方程：\n$$2(2x_2) - x_2 = 1 \\implies 4x_2 - x_2 = 1 \\implies 3x_2 = 1 \\implies x_2 = \\frac{1}{3}$$\n然后，$x_1 = 2(\\frac{1}{3}) = \\frac{2}{3}$。\n精确解为 $x^{\\star} = \\begin{pmatrix}\\frac{2}{3} \\\\ \\frac{1}{3}\\end{pmatrix}$。\n\n现在，我们计算误差向量 $e^{1} = x^{1} - x^{\\star}$ 和 $e^{2} = x^{2} - x^{\\star}$。\n$$e^{1} = \\begin{pmatrix}\\frac{1}{2} \\\\ 0\\end{pmatrix} - \\begin{pmatrix}\\frac{2}{3} \\\\ \\frac{1}{3}\\end{pmatrix} = \\begin{pmatrix}\\frac{3}{6} - \\frac{4}{6} \\\\ 0 - \\frac{1}{3}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{6} \\\\ -\\frac{1}{3}\\end{pmatrix}$$\n$$e^{2} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{4}\\end{pmatrix} - \\begin{pmatrix}\\frac{2}{3} \\\\ \\frac{1}{3}\\end{pmatrix} = \\begin{pmatrix}\\frac{3}{6} - \\frac{4}{6} \\\\ \\frac{3}{12} - \\frac{4}{12}\\end{pmatrix} = \\begin{pmatrix}-\\frac{1}{6} \\\\ -\\frac{1}{12}\\end{pmatrix}$$\n最后，我们计算误差向量 $e^{2}$ 的欧几里得范数，记为 $\\|e^{2}\\|_{2}$。\n$$\\|e^{2}\\|_{2} = \\sqrt{\\left(-\\frac{1}{6}\\right)^2 + \\left(-\\frac{1}{12}\\right)^2} = \\sqrt{\\frac{1}{36} + \\frac{1}{144}}$$\n为了将分数相加，我们找到一个公分母，即 $144$。\n$$\\|e^{2}\\|_{2} = \\sqrt{\\frac{4}{144} + \\frac{1}{144}} = \\sqrt{\\frac{5}{144}} = \\frac{\\sqrt{5}}{\\sqrt{144}} = \\frac{\\sqrt{5}}{12}$$\n两次迭代后误差的欧几里得范数的精确值为 $\\frac{\\sqrt{5}}{12}$。", "answer": "$$\\boxed{\\frac{\\sqrt{5}}{12}}$$", "id": "3581650"}, {"introduction": "不同的平稳迭代法其收敛速度为何有差异？答案隐藏在它们各自的迭代矩阵中。本练习 [@problem_id:3581651] 将深入探讨收敛性的核心，即迭代矩阵的谱半径。你将为一个具有代表性的三对角矩阵，分别推导出雅可比、高斯-赛德尔和SOR方法的迭代矩阵，并精确计算它们的谱半径，从而从理论上量化它们的收敛性能。", "problem": "考虑线性系统 $A x = b$，其中\n$$\nA = \\begin{pmatrix}\n3  -1  0 \\\\\n-1  3  -1 \\\\\n0  -1  3\n\\end{pmatrix}.\n$$\n使用标准分裂 $A = D - L - U$，其中 $D$ 是 $A$ 的对角部分，$L$ 是 $A$ 的具有非负元素的严格下三角部分，$U$ 是 $A$ 的具有非负元素的严格上三角部分。从求解 $A x = b$ 的 Jacobi、Gauss–Seidel 和逐次超松弛 (Successive Over-Relaxation, SOR) 迭代矩阵的核心定义出发，\n- Jacobi: $T_{J} = D^{-1} (L + U)$,\n- Gauss–Seidel: $T_{\\mathrm{GS}} = (D - L)^{-1} U$,\n- 逐次超松弛 (SOR): $T_{\\mathrm{SOR}} = (D - \\omega L)^{-1} \\bigl( (1 - \\omega) D + \\omega U \\bigr)$，其中松弛因子为 $\\omega$,\n\n推导出当 $\\omega = 1.2$ 时，显式的 $3 \\times 3$ 矩阵 $T_{J}$、$T_{\\mathrm{GS}}$ 和 $T_{\\mathrm{SOR}}$。然后，精确计算它们的谱半径（即其特征值的最大绝对值）。将这三个谱半径按 $\\rho(T_{J})$、$\\rho(T_{\\mathrm{GS}})$、$\\rho(T_{\\mathrm{SOR}})$ 的顺序以单行矩阵的形式报告。以精确形式表示你的最终答案；不要四舍五入。", "solution": "所述问题是适定的，具有科学依据，并为获得唯一解提供了所有必要信息。我们首先分解给定的矩阵 $A$，然后继续推导迭代矩阵及其谱半径。\n\n线性系统为 $A x = b$，其矩阵为\n$$\nA = \\begin{pmatrix}\n3  -1  0 \\\\\n-1  3  -1 \\\\\n0  -1  3\n\\end{pmatrix}.\n$$\n使用标准分裂 $A = D - L - U$，其中 $D$ 是 $A$ 的对角部分，$L$ 是具有非负元素的严格下三角矩阵，$U$ 是具有非负元素的严格上三角矩阵。根据 $A$ 的结构，我们确定这些矩阵为：\n$$\nD = \\begin{pmatrix}\n3  0  0 \\\\\n0  3  0 \\\\\n0  0  3\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n0  0  0 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n注意，$-L$ 和 $-U$ 分别对应于 $A$ 的严格下三角和严格上三角部分，并且按照规定，$L$ 和 $U$ 具有非负元素。\n\n**Jacobi 迭代**\n\nJacobi 迭代矩阵定义为 $T_{J} = D^{-1} (L + U)$。\n对角矩阵 $D$ 的逆矩阵可以轻易求得：\n$$\nD^{-1} = \\begin{pmatrix}\n1/3  0  0 \\\\\n0  1/3  0 \\\\\n0  0  1/3\n\\end{pmatrix} = \\frac{1}{3} I.\n$$\n和 $L + U$ 为：\n$$\nL + U = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\n因此，Jacobi 矩阵 $T_J$ 为：\n$$\nT_{J} = \\frac{1}{3} \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix} = \\begin{pmatrix}\n0  1/3  0 \\\\\n1/3  0  1/3 \\\\\n0  1/3  0\n\\end{pmatrix}.\n$$\n为了求出谱半径 $\\rho(T_J)$，我们通过求解特征方程 $\\det(T_J - \\lambda I) = 0$ 来计算 $T_J$ 的特征值：\n$$\n\\det \\begin{pmatrix}\n-\\lambda  1/3  0 \\\\\n1/3  -\\lambda  1/3 \\\\\n0  1/3  -\\lambda\n\\end{pmatrix} = 0.\n$$\n沿第一行展开行列式：\n$$\n-\\lambda \\left( (-\\lambda)(-\\lambda) - (1/3)(1/3) \\right) - (1/3) \\left( (1/3)(-\\lambda) - 0 \\right) = 0\n$$\n$$\n-\\lambda (\\lambda^2 - 1/9) + \\lambda/9 = 0\n$$\n$$\n-\\lambda^3 + \\lambda/9 + \\lambda/9 = 0\n$$\n$$\n-\\lambda^3 + \\frac{2}{9}\\lambda = 0\n$$\n$$\n-\\lambda \\left(\\lambda^2 - \\frac{2}{9}\\right) = 0.\n$$\n特征值为 $\\lambda_1 = 0$，$\\lambda_2 = \\sqrt{2/9} = \\frac{\\sqrt{2}}{3}$ 和 $\\lambda_3 = -\\sqrt{2/9} = -\\frac{\\sqrt{2}}{3}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(T_J) = \\max \\left\\{ |0|, \\left|\\frac{\\sqrt{2}}{3}\\right|, \\left|-\\frac{\\sqrt{2}}{3}\\right| \\right\\} = \\frac{\\sqrt{2}}{3}.\n$$\n\n**Gauss–Seidel 迭代**\n\nGauss–Seidel 迭代矩阵为 $T_{\\mathrm{GS}} = (D - L)^{-1} U$。\n首先，我们求矩阵 $D - L$：\n$$\nD - L = \\begin{pmatrix}\n3  0  0 \\\\\n-1  3  0 \\\\\n0  -1  3\n\\end{pmatrix}.\n$$\n我们通过对单位矩阵的列使用向前代入法来计算逆矩阵 $(D - L)^{-1}$：\n$$\n(D - L)^{-1} = \\begin{pmatrix}\n1/3  0  0 \\\\\n1/9  1/3  0 \\\\\n1/27  1/9  1/3\n\\end{pmatrix}.\n$$\n现在，我们计算 $T_{\\mathrm{GS}}$：\n$$\nT_{\\mathrm{GS}} = \\begin{pmatrix}\n1/3  0  0 \\\\\n1/9  1/3  0 \\\\\n1/27  1/9  1/3\n\\end{pmatrix}\n\\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0  1/3  0 \\\\\n0  1/9  1/3 \\\\\n0  1/27  1/9\n\\end{pmatrix}.\n$$\n特征值由 $\\det(T_{\\mathrm{GS}} - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{pmatrix}\n-\\lambda  1/3  0 \\\\\n0  1/9-\\lambda  1/3 \\\\\n0  1/27  1/9-\\lambda\n\\end{pmatrix} = 0.\n$$\n沿第一列展开：\n$$\n-\\lambda \\left( (1/9 - \\lambda)^2 - (1/3)(1/27) \\right) = 0\n$$\n$$\n-\\lambda \\left( (1/9 - \\lambda)^2 - 1/81 \\right) = 0.\n$$\n一个特征值是 $\\lambda_1 = 0$。其他特征值满足 $(1/9 - \\lambda)^2 = 1/81$，这给出 $1/9 - \\lambda = \\pm 1/9$。\n如果 $1/9 - \\lambda = 1/9$，则 $\\lambda_2 = 0$。\n如果 $1/9 - \\lambda = -1/9$，则 $\\lambda_3 = 2/9$。\n特征值为 $0, 0, 2/9$。谱半径是：\n$$\n\\rho(T_{\\mathrm{GS}}) = \\max \\left\\{ |0|, |2/9| \\right\\} = \\frac{2}{9}.\n$$\n对于像 $A$ 这样的三对角矩阵，如果它是相容排序的，那么已知 $\\rho(T_{\\mathrm{GS}}) = (\\rho(T_{J}))^2$。我们的结果证实了这一点：$(\\frac{\\sqrt{2}}{3})^2 = \\frac{2}{9}$。\n\n**逐次超松弛 (SOR) 迭代**\n\nSOR 迭代矩阵是 $T_{\\mathrm{SOR}} = (D - \\omega L)^{-1} \\bigl( (1 - \\omega) D + \\omega U \\bigr)$，其中 $\\omega = 1.2$。\n我们首先计算显式矩阵 $T_{\\mathrm{SOR}}$。我们使用 $\\omega = 1.2 = 6/5$。\n第一项是 $(D - \\omega L)$：\n$$\nD - \\omega L = \\begin{pmatrix} 3  0  0 \\\\ -6/5  3  0 \\\\ 0  -6/5  3 \\end{pmatrix}.\n$$\n它的逆矩阵是：\n$$\n(D - \\omega L)^{-1} = \\begin{pmatrix} 1/3  0  0 \\\\ 2/15  1/3  0 \\\\ 4/75  2/15  1/3 \\end{pmatrix}.\n$$\n第二项是 $(1 - \\omega) D + \\omega U = (1 - 6/5) D + (6/5) U = (-1/5)D + (6/5)U$：\n$$\n(-1/5)D + (6/5)U = \\begin{pmatrix} -3/5  0  0 \\\\ 0  -3/5  0 \\\\ 0  0  -3/5 \\end{pmatrix} + \\begin{pmatrix} 0  6/5  0 \\\\ 0  0  6/5 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} -3/5  6/5  0 \\\\ 0  -3/5  6/5 \\\\ 0  0  -3/5 \\end{pmatrix}.\n$$\n现在，我们将这两个矩阵相乘得到 $T_{\\mathrm{SOR}}$：\n$$\nT_{\\mathrm{SOR}} = \\begin{pmatrix} 1/3  0  0 \\\\ 2/15  1/3  0 \\\\ 4/75  2/15  1/3 \\end{pmatrix} \\begin{pmatrix} -3/5  6/5  0 \\\\ 0  -3/5  6/5 \\\\ 0  0  -3/5 \\end{pmatrix} = \\begin{pmatrix} -1/5  2/5  0 \\\\ -2/25  -1/25  2/5 \\\\ -4/125  -2/125  -1/25 \\end{pmatrix}.\n$$\n为了求谱半径，我们可以求 $T_{\\mathrm{SOR}}$ 的特征值。然而，由于 $A$ 是相容排序的，我们可以使用已知的 $T_{\\mathrm{SOR}}$ 的特征值 $\\lambda$ 和 $T_J$ 的特征值 $\\mu$ 之间的关系：\n$$\n(\\lambda + \\omega - 1)^2 = \\lambda \\omega^2 \\mu^2.\n$$\n我们有 $\\omega = 6/5$，并且 $T_J$ 的特征值为 $\\mu \\in \\{0, \\pm\\sqrt{2}/3\\}$。因此，$\\mu^2 \\in \\{0, 2/9\\}$。\n情况 1：$\\mu^2 = 0$。\n该关系式变为 $(\\lambda + \\omega - 1)^2 = 0$，这给出 $\\lambda = 1 - \\omega$。\n当 $\\omega = 1.2$ 时，我们得到一个特征值 $\\lambda_1 = 1 - 1.2 = -0.2 = -1/5$。\n\n情况 2：$\\mu^2 = 2/9$。\n关系式为 $(\\lambda + 1.2 - 1)^2 = \\lambda (1.2)^2 (2/9)$。为确保精度，使用分数进行计算：\n$$\n(\\lambda + 1/5)^2 = \\lambda (6/5)^2 (2/9)\n$$\n$$\n\\lambda^2 + \\frac{2}{5}\\lambda + \\frac{1}{25} = \\lambda \\left(\\frac{36}{25}\\right) \\left(\\frac{2}{9}\\right) = \\lambda \\frac{8}{25}\n$$\n$$\n\\lambda^2 + \\left(\\frac{10}{25} - \\frac{8}{25}\\right)\\lambda + \\frac{1}{25} = 0\n$$\n$$\n\\lambda^2 + \\frac{2}{25}\\lambda + \\frac{1}{25} = 0\n$$\n$$\n25\\lambda^2 + 2\\lambda + 1 = 0.\n$$\n使用二次公式，我们求出另外两个特征值：\n$$\n\\lambda_{2,3} = \\frac{-2 \\pm \\sqrt{2^2 - 4(25)(1)}}{2(25)} = \\frac{-2 \\pm \\sqrt{4 - 100}}{50} = \\frac{-2 \\pm \\sqrt{-96}}{50}.\n$$\n化简根式，$\\sqrt{-96} = \\sqrt{16 \\cdot 6 \\cdot (-1)} = 4i\\sqrt{6}$。\n$$\n\\lambda_{2,3} = \\frac{-2 \\pm 4i\\sqrt{6}}{50} = \\frac{-1 \\pm 2i\\sqrt{6}}{25}.\n$$\n$T_{\\mathrm{SOR}}$ 的特征值是 $\\lambda_1 = -1/5$，$\\lambda_2 = \\frac{-1}{25} + i\\frac{2\\sqrt{6}}{25}$ 和 $\\lambda_3 = \\frac{-1}{25} - i\\frac{2\\sqrt{6}}{25}$。\n我们计算它们的绝对值：\n$|\\lambda_1| = |-1/5| = 1/5$。\n$|\\lambda_{2,3}| = \\sqrt{\\left(-\\frac{1}{25}\\right)^2 + \\left(\\pm\\frac{2\\sqrt{6}}{25}\\right)^2} = \\sqrt{\\frac{1}{625} + \\frac{4 \\cdot 6}{625}} = \\sqrt{\\frac{1+24}{625}} = \\sqrt{\\frac{25}{625}} = \\sqrt{\\frac{1}{25}} = \\frac{1}{5}$。\n所有三个特征值的模都相同。谱半径是：\n$$\n\\rho(T_{\\mathrm{SOR}}) = \\frac{1}{5}.\n$$\n这三个谱半径是 $\\rho(T_J) = \\frac{\\sqrt{2}}{3}$，$\\rho(T_{\\mathrm{GS}}) = \\frac{2}{9}$ 和 $\\rho(T_{\\mathrm{SOR}}) = \\frac{1}{5}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{3}  \\frac{2}{9}  \\frac{1}{5} \\end{pmatrix}}\n$$", "id": "3581651"}, {"introduction": "理论分析为我们提供了指导，但数值方法的真正威力在于其计算实现。这个综合性练习 [@problem_id:3199057] 要求你编写代码，在更大切规模的典型问题（离散泊松方程）上实现并比较雅可比、高斯-赛德尔和SOR方法的性能。通过记录达到指定精度所需的迭代次数，你不仅能凭经验验证理论上的收敛速度差异，还能探索SOR方法中松弛因子 $\\omega$ 的选择对收敛效率的关键影响。", "problem": "考虑一个对称正定 (SPD) Toeplitz 线性系统，其矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 定义为 $A = \\mathrm{tridiag}(-1,2,-1)$，右端向量 $b \\in \\mathbb{R}^n$ 定义为对所有索引 $i \\in \\{1,\\dots,n\\}$ 都有 $b_i = 1$。任务是使用三种从零向量 $x^{(0)} = 0$ 开始的定常迭代法求解 $A x = b$，量化它们的迭代次数，并比较它们的行为：\n\n- 雅可比 (Jacobi) 迭代法。\n- 高斯-赛德尔 (Gauss–Seidel) 迭代法。\n- 带松弛因子 $\\omega$ 的逐次超松弛 (SOR) 迭代法。\n\n从基础分解 $A = D - L - U$ 开始，其中 $D$ 是 $A$ 的对角部分，$L$ 是 $A$ 的严格下三角部分，$U$ 是 $A$ 的严格上三角部分。基于此，推导雅可比、高斯-赛德尔和逐次超松弛方法的更新规则，并实现它们以生成迭代解 $x^{(k)}$。\n\n使用欧几里得范数通过 $\\|r^{(k)}\\|_2 / \\|b\\|_2$ 来衡量相对残差 $r^{(k)} = b - A x^{(k)}$。对于每种方法，计算首次满足 $\\|r^{(k)}\\|_2 / \\|b\\|_2 \\le \\varepsilon$ 所需的迭代次数 $k$，其中 $\\varepsilon$ 是预设的容差。如果方法在规定的最大迭代次数 $K_{\\max}$ 内未能达到容差，或者如果它表现出发散（例如，当松弛因子 $\\omega$ 超出收敛范围时），则该方法返回整数 $-1$。所有运行都使用相同的初始猜测 $x^{(0)} = 0$。\n\n测试套件定义如下，每个案例都是一个元组 $(n, \\varepsilon, K_{\\max}, \\Omega)$，其中 $\\Omega$ 是用于逐次超松弛方法的松弛因子 $\\omega$ 的列表：\n\n- 案例 1：$(n, \\varepsilon, K_{\\max}, \\Omega) = (32, 10^{-8}, 10000, [0.8, 1.0, 1.2, 1.5, 1.9])$。\n- 案例 2：$(n, \\varepsilon, K_{\\max}, \\Omega) = (64, 10^{-6}, 15000, [0.9, 1.0, 1.3, 1.8])$。\n- 案例 3：$(n, \\varepsilon, K_{\\max}, \\Omega) = (50, 10^{-8}, 15000, [0.1, 1.0, 1.99, 2.1])$。\n\n对于每个案例，计算：\n- 雅可比迭代法达到容差前的迭代次数 $k_J$（或返回 $-1$）。\n- 高斯-赛德尔迭代法达到容差前的迭代次数 $k_{GS}$（或返回 $-1$）。\n- 对于 $\\Omega$ 中的每个 $\\omega$，逐次超松弛迭代法达到容差前的迭代次数 $k_{\\mathrm{SOR}}(\\omega)$（或返回 $-1$）。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例一个条目，顺序与上面列出的一致。每个条目必须是格式为 $[k_J, k_{GS}, k_{\\mathrm{SOR}}(\\omega_1), k_{\\mathrm{SOR}}(\\omega_2), \\dots]$ 的整数列表。例如，输出必须具有确切的结构形式 $[[\\cdot,\\cdot,\\cdot,\\dots],[\\cdot,\\cdot,\\cdot,\\dots],[\\cdot,\\cdot,\\cdot,\\dots]]$，其中每个 $\\cdot$ 是一个如上定义的整数。本问题不涉及任何物理单位、角度单位或百分比，所有数值答案都必须是整数，用 $-1$ 表示在 $K_{\\max}$ 内未收敛或观察到发散。", "solution": "所述问题在科学上是合理的，数学上是适定的，并且没有任何歧义。它涉及使用标准的定常迭代法对一个特定的对称正定 (SPD) 线性系统进行数值求解，这是计算科学中的一个基本课题。我们将直接进行推导和实现。\n\n问题是求解线性系统 $A x = b$，其中未知向量为 $x \\in \\mathbb{R}^n$。该系统定义如下：\n- 矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是三对角托普利兹矩阵，由 $A = \\mathrm{tridiag}(-1, 2, -1)$ 给出。其元素为 $A_{ii} = 2$，$A_{i, i\\pm 1} = -1$，其他情况 $A_{ij} = 0$。已知该矩阵是对称且正定的。\n- 右端向量 $b \\in \\mathbb{R}^n$ 定义为对所有索引 $i \\in \\{1, \\dots, n\\}$ 都有 $b_i = 1$。\n- 所有方法的迭代都从零向量 $x^{(0)} = 0$ 开始。\n\n雅可比、高斯-赛德尔和逐次超松弛 (SOR) 方法的核心在于将矩阵 $A$ 分解为其对角、严格下三角和严格上三角部分。按照问题的约定，该分解为 $A = D - L - U$，其中：\n- $D$ 是 $A$ 的对角部分。对于我们的特定矩阵，$D$ 是一个所有对角线元素都等于 $2$ 的对角矩阵。\n- $-L$ 是 $A$ 的严格下三角部分。因此，$L$ 是一个元素为 $L_{i, i-1} = 1$ 且其他位置为零的矩阵。\n- $-U$ 是 $A$ 的严格上三角部分。因此，$U$ 是一个元素为 $U_{i, i+1} = 1$ 且其他位置为零的矩阵。\n\n从方程 $(D - L - U)x = b$，我们可以推导出每种迭代方法的更新规则。迭代法计算一个收敛于真实解 $x$ 的近似序列 $x^{(k)}$。\n\n**1. 雅可比 (Jacobi) 迭代法**\n\n雅可比方法仅使用前一次迭代 $x^{(k)}$ 的值来求解下一次迭代 $x^{(k+1)}$。\n$$D x^{(k+1)} = (L+U) x^{(k)} + b$$\n$$x^{(k+1)} = D^{-1}(L+U) x^{(k)} + D^{-1} b$$\n迭代矩阵为 $T_J = D^{-1}(L+U)$。由于 $D$ 是对角矩阵，其逆 $D^{-1}$ 很容易计算。对于分量 $i$，更新规则为：\n$$x_i^{(k+1)} = \\frac{1}{A_{ii}} \\left( b_i - \\sum_{j \\neq i} A_{ij} x_j^{(k)} \\right)$$\n对于我们的特定矩阵，其中 $A_{ii} = 2$，$A_{i, i\\pm 1} = -1$，且 $b_i=1$，这简化为：\n$$x_i^{(k+1)} = \\frac{1}{2} \\left( 1 - (-1 \\cdot x_{i-1}^{(k)}) - (-1 \\cdot x_{i+1}^{(k)}) \\right) = \\frac{1}{2} \\left( 1 + x_{i-1}^{(k)} + x_{i+1}^{(k)} \\right)$$\n对于 $i=1$ 和 $i=n$ 的边界情况（使用 $x_0 = x_{n+1} = 0$，这与矩阵定义一致）：\n$$x_1^{(k+1)} = \\frac{1}{2} (1 + x_2^{(k)})$$\n$$x_n^{(k+1)} = \\frac{1}{2} (1 + x_{n-1}^{(k)})$$\n\n**2. 高斯-赛德尔 (GS) 迭代法**\n\n高斯-赛德尔方法通过在同一次迭代中使用最新计算出的值来改进雅可比方法。在计算 $x_i^{(k+1)}$ 时，它使用 $j  i$ 的 $x_j^{(k+1)}$ 和 $j  i$ 的 $x_j^{(k)}$。\n$$(D - L) x^{(k+1)} = U x^{(k)} + b$$\n$$x^{(k+1)} = (D-L)^{-1} U x^{(k)} + (D-L)^{-1} b$$\n迭代矩阵为 $T_{GS} = (D-L)^{-1} U$。分量形式的更新规则为：\n$$x_i^{(k+1)} = \\frac{1}{A_{ii}} \\left( b_i - \\sum_{j  i} A_{ij} x_j^{(k+1)} - \\sum_{j  i} A_{ij} x_j^{(k)} \\right)$$\n对于我们的特定系统，这变为：\n$$x_i^{(k+1)} = \\frac{1}{2} \\left( 1 + x_{i-1}^{(k+1)} + x_{i+1}^{(k)} \\right)$$\n该方法的实现涉及在一个对其分量的单循环内对向量 $x^{(k)}$ 进行原地更新。\n\n**3. 逐次超松弛 (SOR) 迭代法**\n\nSOR 是高斯-赛德尔方法的一种外推，由松弛因子 $\\omega$ 控制。它计算 GS 迭代解（我们可以表示为 $\\tilde{x}^{(k+1)}$），然后与前一次迭代解 $x^{(k)}$ 形成加权平均。\n$$x_i^{(k+1)} = (1-\\omega) x_i^{(k)} + \\omega \\tilde{x}_i^{(k+1)}$$\n代入 GS 迭代分量 $\\tilde{x}_i^{(k+1)}$ 的表达式：\n$$x_i^{(k+1)} = (1-\\omega) x_i^{(k)} + \\frac{\\omega}{A_{ii}} \\left( b_i - \\sum_{j  i} A_{ij} x_j^{(k+1)} - \\sum_{j  i} A_{ij} x_j^{(k)} \\right)$$\n对于我们的系统，这变为：\n$$x_i^{(k+1)} = (1-\\omega) x_i^{(k)} + \\frac{\\omega}{2} \\left( 1 + x_{i-1}^{(k+1)} + x_{i+1}^{(k)} \\right)$$\n矩阵形式为 $x^{(k+1)} = (D-\\omega L)^{-1}((1-\\omega)D + \\omega U)x^{(k)} + \\omega (D-\\omega L)^{-1} b$。对于像 $A$ 这样的 SPD 矩阵，SOR 方法保证对任何 $\\omega \\in (0, 2)$ 收敛。高斯-赛德尔是 SOR 在 $\\omega=1$ 时的特例。$\\omega$ 在 $(0, 2)$ 范围之外的值将导致发散。\n\n**算法与收敛**\n\n对于每种方法，算法流程如下：\n1. 初始化 $x^{(0)} = 0$。\n2. 计算右端向量的范数 $\\|b\\|_2$。\n3. 对于 $k = 1, 2, \\dots, K_{\\max}$：\n    a. 使用各自的更新规则（雅可比、GS 或 SOR）计算下一次迭代 $x^{(k)}$。\n    b. 对于 $\\omega \\ge 2$ 的 SOR 方法，检查数值溢出（发散）。如果检测到，则终止并返回 $-1$。\n    c. 计算残差 $r^{(k)} = b - A x^{(k)}$。\n    d. 计算相对残差范数 $\\|r^{(k)}\\|_2 / \\|b\\|_2$。\n    e. 如果相对残差范数小于或等于容差 $\\varepsilon$，则终止并返回迭代次数 $k$。\n4. 如果循环完成但未收敛，说明已达到最大迭代次数 $K_{\\max}$。终止并返回 $-1$。\n\n实现将包含针对每种方法的独立函数，遵循这些推导出的更新规则和总体算法结构。高斯-赛德尔方法和 $\\omega=1.0$ 时的 SOR 方法在理论上是相同的，这一事实将作为实现正确性的一个有用的健全性检查。\n\n以下是实现上述逻辑的 Python 代码。\n```python\nimport numpy as np\n\ndef solve_jacobi(A, b, n, epsilon, k_max):\n    \"\"\"\n    Solves Ax=b using the Jacobi method for A = tridiag(-1, 2, -1).\n    \"\"\"\n    x_k = np.zeros(n)\n    norm_b = np.linalg.norm(b)\n    if norm_b == 0:\n        return 0\n\n    x_next = np.zeros(n)\n    for k in range(1, k_max + 1):\n        for i in range(n):\n            sum_val = (x_k[i - 1] if i > 0 else 0) + (x_k[i + 1] if i  n - 1 else 0)\n            x_next[i] = 0.5 * (b[i] + sum_val)\n        x_k = x_next.copy()\n\n        res_norm = np.linalg.norm(b - A @ x_k)\n        if res_norm / norm_b = epsilon:\n            return k\n    return -1\n\ndef solve_gauss_seidel(A, b, n, epsilon, k_max):\n    \"\"\"\n    Solves Ax=b using the Gauss-Seidel method for A = tridiag(-1, 2, -1).\n    \"\"\"\n    x_k = np.zeros(n)\n    norm_b = np.linalg.norm(b)\n    if norm_b == 0:\n        return 0\n\n    for k in range(1, k_max + 1):\n        x_old = x_k.copy()\n        for i in range(n):\n            sum_lower = x_k[i - 1] if i > 0 else 0\n            sum_upper = x_old[i + 1] if i  n - 1 else 0\n            x_k[i] = 0.5 * (b[i] + sum_lower + sum_upper)\n\n        res_norm = np.linalg.norm(b - A @ x_k)\n        if res_norm / norm_b = epsilon:\n            return k\n    return -1\n\ndef solve_sor(A, b, n, omega, epsilon, k_max):\n    \"\"\"\n    Solves Ax=b using the SOR method for A = tridiag(-1, 2, -1).\n    \"\"\"\n    x_k = np.zeros(n)\n    norm_b = np.linalg.norm(b)\n    if norm_b == 0:\n        return 0\n\n    for k in range(1, k_max + 1):\n        x_old = x_k.copy()\n        for i in range(n):\n            sum_lower = x_k[i - 1] if i > 0 else 0\n            sum_upper = x_old[i + 1] if i  n - 1 else 0\n            gs_update = 0.5 * (b[i] + sum_lower + sum_upper)\n            x_k[i] = (1 - omega) * x_old[i] + omega * gs_update\n        \n        if np.any(np.isinf(x_k)) or np.any(np.isnan(x_k)):\n            return -1\n\n        res_norm = np.linalg.norm(b - A @ x_k)\n        if res_norm / norm_b = epsilon:\n            return k\n    return -1\n```", "answer": "[[2110, 1056, 2643, 1056, 698, 423, 177], [6184, 3093, 4124, 3093, 1761, 511], [5126, 2564, -1, 2564, 1083, -1]]", "id": "3199057"}]}