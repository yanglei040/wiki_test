{"hands_on_practices": [{"introduction": "这个基础练习旨在通过具体计算来揭示理论。通过在一个小的厄米特矩阵上逐步执行 Arnoldi 和 Lanczos 迭代，你将能亲眼见证更通用的 Arnoldi 过程如何简化为 Lanczos 过程高效的三项递推关系 [@problem_id:3573190]。这个过程有助于消除理论的神秘感，并建立对两者等价性的直观认识。", "problem": "设 $A \\in \\mathbb{C}^{5 \\times 5}$ 是一个埃尔米特矩阵，即 $A = A^{*}$，其中 $^{*}$ 表示共轭转置。考虑一个具体的选择\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0  0  0 \\\\\n1  3  1  0  0 \\\\\n0  1  4  1  0 \\\\\n0  0  1  3  1 \\\\\n0  0  0  1  2\n\\end{pmatrix},\n$$\n以及初始单位向量 $v_{1} = e_{1} = (1,0,0,0,0)^{\\top}$。仅使用构造标准正交克里洛夫基的阿诺尔迪过程和兰佐斯过程的核心定义，执行恰好两次阿诺尔迪迭代（以获得 $v_{2}$ 和 $v_{3}$）和两次兰佐斯步骤（以获得 $v_{2}$ 和 $v_{3}$）。显式计算这些构造中出现的所有相关标量系数（在阿诺尔迪过程中：海森堡矩阵的元素 $h_{11}$、$h_{21}$、$h_{12}$、$h_{22}$、$h_{32}$；在兰佐斯过程中：三对角矩阵的元素 $\\alpha_{1}$、$\\beta_{1}$、$\\alpha_{2}$、$\\beta_{2}$）。然后，确定幺模标量 $c \\in \\mathbb{C}$（即 $|c| = 1$），使得 $v_{3}^{\\mathrm{Arnoldi}} = c \\, v_{3}^{\\mathrm{Lanczos}}$。\n\n请给出 $c$ 的精确值作为最终答案（无需四舍五入）。", "solution": "用户要求我解决一个数值线性代数问题。\n\n我的计划如下：\n1.  **验证问题：**\n    *   **提取已知条件：** 我将列出所有给定信息：矩阵 A、其性质（埃尔米特）、初始向量 v1，以及执行两步阿诺尔迪迭代和两步兰佐斯迭代的任务。\n    *   **检查有效性：**\n        *   **科学依据：** 该问题涉及数值线性代数中的标准算法（阿诺尔迪和兰佐斯）。矩阵定义明确且为埃尔米特矩阵。这是一个标准的教科书式问题。\n        *   **适定性：** 该问题要求进行特定的计算并得出最终标量 c。步骤定义清晰。克里洛夫子空间及其生成的标准正交基的存在性和唯一性（最多相差一个相位因子）是公认的。该问题是适定的。\n        *   **客观性：** 语言正式且精确，没有主观因素。\n        *   **完整性：** 矩阵 A、初始向量 v1 和迭代次数都已指定。该问题是自洽的。\n        *   **一致性：** 给定矩阵 A 是埃尔米特矩阵。我们来检查一下：\n            `A = [[2, 1, 0, 0, 0], [1, 3, 1, 0, 0], [0, 1, 4, 1, 0], [0, 0, 1, 3, 1], [0, 0, 0, 1, 2]]`\n            A 是一个实对称矩阵。由于 A 是实数矩阵，`A^T = A`。对于实数矩阵，共轭转置 `A*` 就是转置 `A^T`。所以 `A = A*`。条件满足。\n        *   该问题有效。\n\n2.  **解决问题：**\n    *   我需要执行两步阿诺尔迪迭代和两步兰佐斯迭代。\n    *   目标是通过两种方法找到 `v2` 和 `v3` 以及相关的系数。\n    *   最后，我需要找到标量 c，使得 `v3^(Arnoldi) = c * v3^(Lanczos)`。\n\n### 第1部分：阿诺尔迪迭代\n\n阿诺尔迪迭代为克里洛夫子空间 $\\mathcal{K}_k(A, v_1) = \\text{span}\\{v_1, Av_1, \\dots, A^{k-1}v_1\\}$ 构建一个标准正交基 $\\{v_1, v_2, \\dots, v_k\\}$。其关系由 $AV_k = V_{k+1} \\tilde{H}_k$ 给出，其中 $V_k = [v_1, \\dots, v_k]$ 且 $\\tilde{H}_k$ 是一个上海森堡矩阵。\n\n核心算法如下：\n1.  从一个单位向量 $v_1$ 开始。\n2.  对于 $j = 1, 2, \\dots, k$：\n    a.  计算 $w = Av_j$。\n    b.  对于 $i = 1, \\dots, j$：\n        i.  $h_{ij} = v_i^* w$。\n        ii. $w = w - h_{ij}v_i$。\n    c.  $h_{j+1, j} = \\|w\\|_2$。\n    d.  如果 $h_{j+1, j} = 0$，停止。\n    e.  $v_{j+1} = w / h_{j+1, j}$。\n\n**已知：**\n$A = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix}$\n$v_1 = e_1 = (1, 0, 0, 0, 0)^\\top$。$\\|v_1\\|_2 = 1$。\n\n**迭代 j=1 (求 v2):**\na.  $w = Av_1 = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nb.  $h_{11} = v_1^* w = (1, 0, 0, 0, 0) \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2$。\n    $w = w - h_{11}v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nc.  $h_{21} = \\|w\\|_2 = \\sqrt{0^2 + 1^2 + 0^2 + 0^2 + 0^2} = 1$。\nd.  $h_{21} \\neq 0$。\ne.  $v_2 = w / h_{21} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} / 1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_2$。\n\n因此，$v_2^{\\mathrm{Arnoldi}} = e_2$。\n系数：$h_{11} = 2$，$h_{21} = 1$。\n\n**迭代 j=2 (求 v3):**\na.  $w = Av_2 = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nb.  $h_{12} = v_1^* w = (1, 0, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$。\n    $h_{22} = v_2^* w = (0, 1, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 3$。\n    $w = w - h_{12}v_1 - h_{22}v_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 3-3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nc.  $h_{32} = \\|w\\|_2 = \\sqrt{0^2 + 0^2 + 1^2 + 0^2 + 0^2} = 1$。\nd.  $h_{32} \\neq 0$。\ne.  $v_3 = w / h_{32} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} / 1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_3$。\n\n因此，$v_3^{\\mathrm{Arnoldi}} = e_3$。\n系数：$h_{12} = 1$，$h_{22} = 3$，$h_{32} = 1$。\n\n阿诺尔迪过程结果总结：\n$v_1^{\\mathrm{Arnoldi}} = e_1$\n$v_2^{\\mathrm{Arnoldi}} = e_2$\n$v_3^{\\mathrm{Arnoldi}} = e_3$\n$h_{11}=2, h_{21}=1, h_{12}=1, h_{22}=3, h_{32}=1$。\n\n问题指出，对于埃尔米特矩阵 A，阿诺尔迪过程简化为兰佐斯过程。海森堡矩阵变为三对角且对称的矩阵。\n$H_k = \\begin{pmatrix} h_{11}  h_{12}  \\dots \\\\ h_{21}  h_{22}  \\dots \\\\ 0  h_{32}  \\dots \\\\ \\vdots  \\ddots  \\ddots \\end{pmatrix}$\n对于埃尔米特矩阵 A，$H_k$ 也是埃尔米特矩阵，因此 $h_{ij} = \\overline{h_{ji}}$。\n由于 $H_k$ 是海森堡矩阵，这意味着它必须是三对角矩阵。对于 $i > j+1$，$h_{ij}=0$。根据埃尔米特性质，对于 $j > i+1$，$h_{ji}=0$。\n$h_{12} = \\overline{h_{21}}$。我们来检查：$h_{12}=1$，$h_{21}=1$。正确。\n$h_{23} = \\overline{h_{32}}$。我们没有计算 $h_{23}$，但我们有 $h_{32}=1$。\n矩阵 $H_3$ 将是 $\\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  h_{33} \\end{pmatrix}$。这确实是一个实对称三对角矩阵，符合预期。\n\n### 第2部分：兰佐斯迭代\n\n兰佐斯迭代是阿诺尔迪迭代在埃尔米特矩阵上的特例。\n递推关系为：\n$\\beta_{j} v_{j+1} = A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$\n其中 $\\alpha_j = v_j^* A v_j$ 且 $\\beta_j = \\|A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\\|_2$。\n设 $\\beta_0 = 0$ 且 $v_0 = 0$。\n\n**已知：**\n$A = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix}$ （埃尔米特矩阵，特别是实对称矩阵）\n$v_1 = e_1 = (1, 0, 0, 0, 0)^\\top$。\n\n**步骤 j=1 (求 v2):**\n$\\beta_0 = 0$，$v_0 = 0$。\n$Av_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\alpha_1 = v_1^* A v_1 = (1, 0, 0, 0, 0) \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2$。\n我们将未归一化的下一个向量称为 $\\tilde{v}_2$。\n$\\tilde{v}_2 = A v_1 - \\alpha_1 v_1 - \\beta_0 v_0 = Av_1 - \\alpha_1 v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_1 = \\|\\tilde{v}_2\\|_2 = 1$。\n$v_2 = \\tilde{v}_2 / \\beta_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_2$。\n\n因此，$v_2^{\\mathrm{Lanczos}} = e_2$。\n系数：$\\alpha_1=2$，$\\beta_1=1$。\n\n这与阿诺尔迪过程的结果相符：\n兰佐斯过程中的 $\\alpha_1$ 对应于阿诺尔迪过程中的 $h_{11}$。$\\alpha_1=2, h_{11}=2$。正确。\n兰佐斯过程中的 $\\beta_1$ 对应于阿诺尔迪过程中的 $h_{21}$。$\\beta_1=1, h_{21}=1$。正确。\n并且 $v_2^{\\mathrm{Lanczos}} = v_2^{\\mathrm{Arnoldi}}$。\n\n**步骤 j=2 (求 v3):**\n$\\beta_1 = 1$, $v_1 = e_1$, $v_2 = e_2$。\n$Av_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\alpha_2 = v_2^* A v_2 = (0, 1, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 3$。\n$\\tilde{v}_3 = A v_2 - \\alpha_2 v_2 - \\beta_1 v_1 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 3-3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_2 = \\|\\tilde{v}_3\\|_2 = 1$。\n$v_3 = \\tilde{v}_3 / \\beta_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_3$。\n\n因此，$v_3^{\\mathrm{Lanczos}} = e_3$。\n系数：$\\alpha_2=3$，$\\beta_2=1$。\n\n这也与阿诺尔迪过程的结果相符：\n兰佐斯过程中的 $\\alpha_2$ 对应于阿诺尔迪过程中的 $h_{22}$。$\\alpha_2=3, h_{22}=3$。正确。\n兰佐斯过程中的 $\\beta_2$ 对应于阿诺尔迪过程中的 $h_{32}$。$\\beta_2=1, h_{32}=1$。正确。\n阿诺尔迪过程中的另一个系数 $h_{12}$ 与 $\\beta_1$ 相关，因为对于埃尔米特矩阵，$H_k$ 是三对角且埃尔米特的。因此 $h_{12} = \\overline{h_{21}} = h_{21}$，因为它是实数。这里 $h_{21} = \\beta_1$。所以 $h_{12}=\\beta_1=1$。这也相符。\n\n兰佐斯过程结果总结：\n$v_1^{\\mathrm{Lanczos}} = e_1$\n$v_2^{\\mathrm{Lanczos}} = e_2$\n$v_3^{\\mathrm{Lanczos}} = e_3$\n$\\alpha_1=2, \\beta_1=1, \\alpha_2=3, \\beta_2=1$。\n\n### 第3部分：比较结果并求 c\n\n我们发现：\n$v_3^{\\mathrm{Arnoldi}} = e_3 = (0,0,1,0,0)^\\top$。\n$v_3^{\\mathrm{Lanczos}} = e_3 = (0,0,1,0,0)^\\top$。\n\n问题要求找到幺模标量 $c$，使得 $v_3^{\\mathrm{Arnoldi}} = c \\, v_3^{\\mathrm{Lanczos}}$。\n所以，我们有：\n$e_3 = c \\cdot e_3$\n$(0,0,1,0,0)^\\top = c \\cdot (0,0,1,0,0)^\\top$。\n这意味着 $1 = c \\cdot 1$，所以 $c=1$。\n\n$c$ 的值必须是 $1$。\n我是否遗漏了什么细节？这个问题似乎暗示 $c$ 可能不为 1。\n\"确定幺模标量 $c \\in \\mathbb{C}$（即 $|c| = 1$），使得 $v_{3}^{\\mathrm{Arnoldi}} = c \\, v_{3}^{\\mathrm{Lanczos}}$。\"\n\n让我们仔细重读问题。“仅使用核心定义...”。\n\n在两种标准定义中，下一个向量都是通过对一个向量进行归一化得到的。归一化过程 $u/\\|u\\|$ 唯一地确定结果，最多相差一个符号（对于实向量）或一个相位因子 $e^{i\\theta}$（对于复向量）。“标准”定义通常意味着对范数取正实数平方根，因此归一化因子 $1/\\|u\\|$ 是正实数。在这种情况下，向量序列是唯一确定的。\n\n我们再次追踪计算过程。\n阿诺尔迪：\n$v_1 = e_1$\n$w_1 = Av_1 - (v_1^*Av_1)v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 e_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$h_{21} = \\|w_1\\| = 1$。\n$v_2^{\\mathrm{Arnoldi}} = w_1/h_{21} = e_2$。\n\n$w_2 = Av_2 - (v_1^*Av_2)v_1 - (v_2^*Av_2)v_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - (e_1^* \\dots) e_1 - (e_2^* \\dots) e_2$\n$e_1^*Av_2 = 1$。\n$e_2^*Av_2 = 3$。\n$w_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 e_1 - 3 e_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$h_{32} = \\|w_2\\| = 1$。\n$v_3^{\\mathrm{Arnoldi}} = w_2/h_{32} = e_3$。\n\n兰佐斯：\n$v_1 = e_1$\n$\\alpha_1 = v_1^*Av_1 = 2$。\n$\\tilde{v}_2 = Av_1 - \\alpha_1 v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2e_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_1 = \\|\\tilde{v}_2\\| = 1$。\n$v_2^{\\mathrm{Lanczos}} = \\tilde{v}_2/\\beta_1 = e_2$。\n\n$\\alpha_2 = v_2^*Av_2 = e_2^* A e_2 = 3$。\n$\\tilde{v}_3 = Av_2 - \\alpha_2 v_2 - \\beta_1 v_1 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 e_2 - 1 e_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_2 = \\|\\tilde{v}_3\\| = 1$。\n$v_3^{\\mathrm{Lanczos}} = \\tilde{v}_3/\\beta_2 = e_3$。\n\n所以确实，$v_3^{\\mathrm{Arnoldi}} = v_3^{\\mathrm{Lanczos}} = e_3$。因此 $c=1$。\n\n也许在系数的定义上存在细微的差别。\n我们查阅一下教科书，例如 Saad 的《稀疏线性系统迭代方法》或 Trefethen  Bau 的《数值线性代数》。\n\nTrefethen  Bau，第33讲（阿诺尔迪）：\n$w = Av_j$\n对于 $i=1 \\dots j$：$h_{ij} = v_i^* w$，$w = w - h_{ij} v_i$\n$h_{j+1, j} = \\|w\\|$\n$v_{j+1} = w / h_{j+1, j}$\n\nTrefethen  Bau，第36讲（兰佐斯）：\n设 $\\beta_0=0, v_0=0$。\n$w = Av_j$\n$\\alpha_j = v_j^* w$\n$w = w - \\alpha_j v_j - \\beta_{j-1}v_{j-1}$\n$\\beta_j = \\|w\\|$\n$v_{j+1} = w / \\beta_j$\n\n我们来比较一下这两种算法在埃尔米特矩阵上的表现。\n假设我们已经计算出 $v_1, \\dots, v_j$ 并且它们对于两种算法是相同的。\n阿诺尔迪过程在第 $j$ 步：\n$w_{Arn} = Av_j$\n对于 $i=1 \\dots j$：\n$h_{ij} = v_i^* w_{Arn} = v_i^* A v_j$。\n$w'_{Arn} = w_{Arn} - h_{ij}v_i$。（这是对w的连续更新）\n最终的 w 是 $w_{Arn}^{(final)} = Av_j - \\sum_{i=1}^j (v_i^* A v_j) v_i$。\n$h_{j+1,j} = \\|w_{Arn}^{(final)}\\|$。\n$v_{j+1}^{\\text{Arn}} = w_{Arn}^{(final)} / h_{j+1,j}$。\n\n兰佐斯过程在第 $j$ 步：\n$w_{Lan} = Av_j$\n$\\alpha_j = v_j^* w_{Lan} = v_j^* A v_j$。\n$w_{Lan}^{(final)} = w_{Lan} - \\alpha_j v_j - \\beta_{j-1}v_{j-1}$。\n$\\beta_j = \\|w_{Lan}^{(final)}\\|$。\n$v_{j+1}^{\\text{Lan}} = w_{Lan}^{(final)} / \\beta_j$。\n\n关键在于证明 $w_{Arn}^{(final)} = w_{Lan}^{(final)}$。\n$w_{Arn}^{(final)} = Av_j - \\sum_{i=1}^j h_{ij} v_i$。\n对于埃尔米特矩阵，我们知道对于 $i  j-1$，$h_{ij} = v_i^* A v_j=0$。\n所以求和项为 $Av_j - h_{j-1, j}v_{j-1} - h_{jj} v_j$。\n$w_{Arn}^{(final)} = Av_j - h_{jj}v_j - h_{j-1, j}v_{j-1}$。\n我们有 $h_{jj} = v_j^* A v_j = \\alpha_j$。\n所以 $w_{Arn}^{(final)} = Av_j - \\alpha_j v_j - h_{j-1, j}v_{j-1}$。\n我们需要知道 $h_{j-1,j}$ 是什么。\n$h_{j-1,j} = v_{j-1}^* A v_j$。\n根据埃尔米特性质，$h_{j-1,j} = (A v_{j-1})^* v_j = \\overline{v_j^* A v_{j-1}} = \\overline{h_{j,j-1}}$。\n阿诺尔迪过程定义 $h_{j,j-1} = \\|Av_{j-2} - \\sum_{k=1}^{j-2} h_{k, j-2}v_k\\|$。这是一个非负实数。\n所以 $h_{j-1,j} = h_{j,j-1}$。\n让我们看看 $h_{j, j-1}$ 在兰佐斯迭代中对应什么。\n$h_{j,j-1}$ 来自阿诺尔迪过程的第 $j-1$ 步。$h_{j,j-1} = \\| w_{Arn}^{(final, j-1)} \\|$。\n$w_{Arn}^{(final, j-1)} = Av_{j-1} - h_{j-1,j-1}v_{j-1} - h_{j-2,j-1}v_{j-2}$。\n在兰佐斯过程的第 $j-1$ 步：\n$w_{Lan}^{(final, j-1)} = Av_{j-1} - \\alpha_{j-1}v_{j-1} - \\beta_{j-2}v_{j-2}$。\n$\\beta_{j-1} = \\|w_{Lan}^{(final, j-1)}\\|$。\n如果我们通过归纳法假设算法在第 $j-1$ 步之前都是相同的，那么如果 $k=l$ 则 $h_{k,l}=\\alpha_k$；如果 $l=k-1$ 则 $h_{k,l}=\\beta_{k-1}$；如果 $k=l+1$ 则 $h_{k,l}=\\beta_l$。\n$h_{j-1,j-1} = \\alpha_{j-1}$。\n$h_{j-2,j-1} = \\beta_{j-2}$。（这是对于 $l=j-1, k=j-2$，所以 $k=l-1$，但我对 beta 的记法是 $\\beta_l$，所以 $\\beta_{j-1}$ 在次对角线上）。\n让我们使用 Trefethen  Bau 的记法。\n三对角矩阵是 $T_j = \\begin{pmatrix} \\alpha_1  \\beta_1   \\\\ \\beta_1  \\alpha_2  \\ddots  \\\\  \\ddots  \\ddots  \\beta_{j-1} \\\\   \\beta_{j-1}  \\alpha_j \\end{pmatrix}$。\n兰佐斯递推式是 $\\beta_j v_{j+1} = Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$。\n对于埃尔米特矩阵 A，阿诺尔迪递推式是 $h_{j+1,j} v_{j+1} = Av_j - h_{jj} v_j - h_{j-1, j} v_{j-1}$。\n通过归纳法，假设对于 $k \\le j$，$v_k$ 是相同的。\n$\\alpha_j = v_j^* A v_j = h_{jj}$。\n$h_{j-1, j} = v_{j-1}^* A v_j = (A v_{j-1})^* v_j$。\n从第 $j-1$ 步的递推式：$\\beta_{j-1} v_j = Av_{j-1} - \\alpha_{j-1}v_{j-1} - \\beta_{j-2}v_{j-2}$。\n所以 $(Av_{j-1})^* = (\\beta_{j-1}v_j + \\dots)^* = \\beta_{j-1} v_j^* + \\dots$。\n$(A v_{j-1})^* v_j = \\beta_{j-1}$。\n所以 $h_{j-1,j} = \\beta_{j-1}$。\n因此，对于埃尔米特矩阵 A，阿诺尔迪递推式是 $h_{j+1,j} v_{j+1} = Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$。\n如果我们能证明 $h_{j+1,j} = \\beta_j$，这与兰佐斯递推式完全相同。\n$h_{j+1,j} = \\| Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1} \\|$。\n$\\beta_j = \\| Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1} \\|$。\n它们被相同地定义为同一向量的范数。\n由于范数非负，$h_{j+1,j} = \\beta_j$。\n假设使用标准定义，对于埃尔米特矩阵，这两种算法在数学上是等价的。\n\n所以我的计算结果 $c=1$ 必定是正确的。\n也许这个问题有点像一个陷阱问题，用来测试是否知道阿诺尔迪过程在埃尔米特矩阵上会简化为兰佐斯过程。\n一位严谨的教授会首先确立这一理论上的等价性，然后说明计算是多余的，但仍会按照问题的要求执行计算以确保无误。\n\n我将清晰地写下解题过程，展示两种过程的步骤，然后进行比较。\n结构将是：1. 验证（问题有效）。2. 阿诺尔迪计算。3. 兰佐斯计算。4. 证明在此情况下它们等价的理论论证。5. 比较并求 c。\n\n问题要求显式计算系数。我需要在解答主体中列出它们。\n阿诺尔迪：$h_{11}=2, h_{21}=1, h_{12}=1, h_{22}=3, h_{32}=1$。\n兰佐斯：$\\alpha_1=2, \\beta_1=1, \\alpha_2=3, \\beta_2=1$。\n我将确保呈现所有这些。对应关系是：\n$h_{11} = \\alpha_1$\n$h_{21} = \\beta_1$\n$h_{22} = \\alpha_2$\n$h_{32} = \\beta_2$\n问题也要求 $h_{12}$。$h_{12} = v_1^* A v_2 = e_1^T A e_2 = 1$。兰佐斯过程没有显式计算这个量，但对于实对称矩阵，它通过 $h_{12} = h_{21}$ 隐式关联，也就是 $\\beta_1$。\n问题要求的是“在这些构造中出现的”系数。\n对于阿诺尔迪：对于 $i \\le j+1$ 的 $h_{ij}$。所以对于 $j=1$ 是 $h_{11}, h_{21}$，对于 $j=2$ 是 $h_{12}, h_{22}, h_{32}$。\n对于兰佐斯：$\\alpha_j, \\beta_j$。所以对于 $j=1$ 是 $\\alpha_1, \\beta_1$，对于 $j=2$ 是 $\\alpha_2, \\beta_2$。\n\n一切看起来都井然有序。这个问题是两个基本算法的直接应用，关键的洞察在于，在标准定义下，它们对于埃尔米特矩阵是等价的。结果 $c=1$ 是可靠的。\n最后检查一下问题陈述，确保我没有遗漏任何细微之处：\n- $A \\in \\mathbb{C}^{5 \\times 5}$ 是埃尔米特矩阵。（好的，我的矩阵是实对称的，一个特例）。\n- $A$ 和 $v_1$ 的具体选择。（好的）。\n- “...仅使用核心定义...”。这个措辞强化了使用标准教科书算法的想法，我正是这么做的。\n- “执行恰好两次...迭代/步骤”。完成。\n- “显式计算所有相关标量系数”。完成。\n- “确定幺模标量 $c$”。完成。\n这个问题似乎就是它表面上的样子。没有发现深层隐藏的陷阱。\n我将继续撰写解答。", "answer": "$$\\boxed{1}$$", "id": "3573190"}, {"introduction": "本练习将探讨一个关键现象：算法的提前终止。克雷洛夫子空间方法并非总是执行最大可能的步数，通过一个精心设计的例子 [@problem_id:3573173]，我们将演示所谓的“幸运截断”（happy breakdown）。你会发现，算法上的事件（例如，Lanczos 迭代中的系数 $\\beta_k=0$）与一个深刻的几何概念——克雷洛夫子空间成为矩阵的一个不变子空间——紧密相连。", "problem": "设 $A \\in \\mathbb{R}^{5 \\times 5}$ 是一个实对称矩阵\n$$\nA = \\operatorname{diag}(1,3,5,7,11),\n$$\n且设 $b \\in \\mathbb{R}^{5}$ 为\n$$\nb = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}.\n$$\n考虑克里洛夫子空间 $\\mathcal{K}_{k}(A,b) = \\operatorname{span}\\{b, Ab, \\dots, A^{k-1}b\\}$，以及在精确计算下，由以 $v_{1} = b/\\|b\\|$ 开始的 Lanczos 迭代（针对对称矩阵 $A$）和 Arnoldi 迭代（针对一般矩阵 $A$）生成的标准正交基。仅使用数值线性代数的基本定义，包括克里洛夫子空间的定义、不变子空间的概念，以及对于对称矩阵 $A$，Arnoldi 过程会简化为生成对称三对角投影的三项 Lanczos 递推这一基本性质。\n\n任务：\n- 解释为什么存在一个最小的正整数 $k$，使得对于给定的 $(A,b)$ 对，Lanczos 迭代在精确计算下产生 $v_{k+1} = 0$，并从 $\\mathcal{K}_{k}(A,b)$ 捕获不变子空间的角度阐明其几何原因。\n- 解释为什么 Arnoldi 迭代在同一步会表现出“幸运中断”（happy breakdown），并将其与对称矩阵 $A$ 的 Arnoldi 和 Lanczos 迭代之间的关系联系起来。\n- 对于给定的 $A$ 和 $b$，明确求出这个最小的 $k$。\n\n你的最终答案应该是 $k$ 的单个整数值（无单位）。最终答案中不要提供任何不等式或方程式。如果你选择计算任何中间数值，请保留精确值，无需四舍五入。在你的推理中提供几何解释，但最终答案必须只是整数 $k$。", "solution": "问题要求解释对于给定的对称矩阵 $A$ 和起始向量 $b$，Lanczos 和 Arnoldi 迭代的终止原因，并确定该终止发生的步数 $k$。\n\n首先，我们讨论这些迭代方法终止的理论基础。Lanczos 和 Arnoldi 迭代是为嵌套的克里洛夫子空间序列 $\\mathcal{K}_j(A,b) = \\operatorname{span}\\{b, Ab, \\dots, A^{j-1}b\\}$（其中 $j=1, 2, \\dots, m$）构建一个标准正交基 $\\{v_1, v_2, \\dots, v_m\\}$ 的算法。该过程从 $v_1 = b / \\|b\\|$ 开始。在精确计算中，只要克里洛夫子空间的维数在每一步都增加，即 $\\dim(\\mathcal{K}_{j+1}(A,b)) = \\dim(\\mathcal{K}_j(A,b)) + 1$，迭代就会继续。\n\n克里洛夫子空间的维数不能无限增加，因为它是有限维空间 $\\mathbb{R}^5$ 的一个子空间。设 $k$ 是使得向量集 $\\{b, Ab, \\dots, A^{k-1}b, A^k b\\}$ 线性相关的最小正整数。这意味着 $A^k b$ 可以写成前面向量的线性组合：\n$$\nA^k b = \\sum_{i=0}^{k-1} c_i A^i b\n$$\n对于某些系数 $c_i$。这意味着关于向量 $b$ 的 $A$ 的最小多项式（即满足 $p(A)b = 0$ 的次数最低的唯一首一多项式 $p(t)$）的次数为 $k$。这种多项式的存在性是得到保证的，因为在一个 $n$ 维空间中，$n+1$ 个向量 $b, Ab, \\dots, A^n b$ 必须是线性相关的。\n\n当 $A^k b \\in \\mathcal{K}_k(A,b)$ 时，克里洛夫子空间稳定下来：$\\mathcal{K}_{k+1}(A,b) = \\mathcal{K}_k(A,b)$，因此对于所有 $j  k$，都有 $\\mathcal{K}_j(A,b) = \\mathcal{K}_k(A,b)$。最大克里洛夫子空间的维数为 $k$。\n\n对于对称矩阵 $A$，Lanczos 迭代由三项递推关系控制：\n$$\n\\beta_j v_{j+1} = A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\n$$\n其中 $\\alpha_j = v_j^T A v_j$ 且 $\\beta_j = \\|A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\\|_2$。如果 $\\beta_k=0$，则迭代在第 $j=k$ 步终止。这意味着向量 $v_{k+1}$ 是零向量（在归一化之前）。$\\beta_k$ 的值为零意味着 $A v_k$ 位于 $v_1, \\dots, v_k$ 的张成空间中。由于 $\\{v_1, \\dots, v_k\\}$ 是 $\\mathcal{K}_k(A,b)$ 的一个标准正交基，这意味着 $A v_k \\in \\mathcal{K}_k(A,b)$。因为基向量 $v_j$ 是由 $\\{b, Ab, \\dots, A^{j-1}b\\}$ 的线性组合构建的，所以条件 $A v_k \\in \\mathcal{K}_k(A,b)$ 等价于 $A (\\mathcal{K}_k(A,b)) \\subseteq \\mathcal{K}_k(A,b)$。\n因此，终止的几何原因是克里洛夫子空间 $\\mathcal{K}_k(A,b)$ 成为了一个 $A$-不变子空间。最小的这样的 $k$ 对应于由 $A$ 和 $b$ 生成的完整克里洛夫子空间的维数。\n\n对于一般矩阵，Arnoldi 迭代生成一个标准正交基 $V_k = [v_1, \\dots, v_k]$，满足关系式 $AV_k = V_{k+1} \\tilde{H}_k$，展开为 $AV_k = V_k H_k + h_{k+1,k} v_{k+1} e_k^T$，其中 $H_k$ 是一个 $k \\times k$ 的上 Hessenberg 矩阵。如果在第 $k$ 步，系数 $h_{k+1,k}$ 为零，则发生“幸运中断”。在这种情况下，递推关系简化为 $AV_k = V_k H_k$，这同样意味着 $A(\\operatorname{span}\\{v_1, \\dots, v_k\\}) \\subseteq \\operatorname{span}\\{v_1, \\dots, v_k\\}$。子空间 $\\mathcal{K}_k(A,b)$ 是 $A$-不变的。\n当 $A$ 是对称矩阵时，Arnoldi 过程简化为 Lanczos 过程。上 Hessenberg 矩阵 $H_k$ 变成一个对称三对角矩阵 $T_k$，且系数之间有关系 $\\beta_j = h_{j+1,j}$。因此，Lanczos 的终止条件（$\\beta_k=0$）与 Arnoldi 的幸运中断条件（$h_{k+1,k}=0$）是相同的。\n\n为了找到给定 $(A,b)$ 对的最小整数 $k$，我们必须确定克里洛夫子空间 $\\mathcal{K}(A,b)$ 的维数。矩阵 $A = \\operatorname{diag}(1,3,5,7,11)$ 是对角矩阵，所以其特征值为 $\\lambda_1=1, \\lambda_2=3, \\lambda_3=5, \\lambda_4=7, \\lambda_5=11$，对应的特征向量是标准基向量 $e_1, e_2, e_3, e_4, e_5$。\n\n起始向量 $b$ 由下式给出：\n$$\nb = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = 1 \\cdot e_1 + 1 \\cdot e_2 + 0 \\cdot e_3 + 0 \\cdot e_4 + 0 \\cdot e_5\n$$\n所以，$b$ 是前两个特征向量 $e_1$ 和 $e_2$ 的线性组合。\n我们来构建克里洛夫向量 $A^j b$：\n$$\nA^j b = A^j (e_1 + e_2) = A^j e_1 + A^j e_2 = \\lambda_1^j e_1 + \\lambda_2^j e_2 = 1^j e_1 + 3^j e_2 = e_1 + 3^j e_2\n$$\n前几个克里洛夫向量是：\n对于 $j=0$：$b = e_1 + e_2 = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n对于 $j=1$：$Ab = e_1 + 3e_2 = \\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n对于 $j=2$：$A^2 b = e_1 + 3^2 e_2 = e_1 + 9e_2 = \\begin{pmatrix}1 \\\\ 9 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n\n克里洛夫子空间 $\\mathcal{K}_j(A,b)$ 中的任何向量都是这些向量的线性组合，这意味着它将始终具有 $\\alpha e_1 + \\beta e_2$ 的形式，其中 $\\alpha$ 和 $\\beta$ 是某个标量。因此，整个克里洛夫子空间序列都包含在二维子空间 $\\operatorname{span}\\{e_1, e_2\\}$ 内。$\\mathcal{K}(A,b)$ 的维数最多为 $2$。\n\n为了找到确切的维数，我们检查线性无关性。\n集合 $\\{b\\}$ 是线性无关的，因为 $b \\neq 0$。维数至少为 $1$。\n集合 $\\{b, Ab\\}$ 由向量 $\\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $\\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 组成。它们是线性无关的，因为它们不是彼此的标量倍数。维数至少为 $2$。\n\n既然我们已经确定维数最多为 $2$ 并且至少为 $2$，那么最大克里洛夫子空间的维数必须恰好是 $2$。\n这意味着集合 $\\{b, Ab, A^2 b\\}$ 必须是线性相关的。我们来验证这一点：\n我们寻找系数 $c_0, c_1, c_2$ 使得 $c_2 A^2 b + c_1 Ab + c_0 b = 0$。这对应于找到关于 $b$ 的 $A$ 的最小多项式。该多项式的根是 $A$ 中对应于 $b$ 中所含特征向量分量的特征值，即 $\\lambda_1=1$ 和 $\\lambda_2=3$。\n因此，最小多项式为 $(t-1)(t-3) = t^2 - 4t + 3$。该多项式的次数为 $k=2$。\n这意味着 $(A^2 - 4A + 3I)b = 0$，或 $A^2 b = 4Ab - 3b$。\n我们来检验一下：\n$$\n4Ab - 3b = 4\\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} - 3\\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}4 \\\\ 12 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} - \\begin{pmatrix}3 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1 \\\\ 9 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = A^2 b\n$$\n该关系成立。由于 $A^2 b$ 是 $b$ 和 $Ab$ 的线性组合，克里洛夫序列在这一步变得线性相关。克里洛夫子空间的维数为 $k=2$。\n因此，Lanczos/Arnoldi 过程将成功生成一个由两个向量 $\\{v_1, v_2\\}$ 组成的标准正交基，张成这个二维不变子空间。在第二步结束时（即，对于 $j=2$），算法将尝试计算 $v_3$。它会发现相应的非对角系数 $\\beta_2$（或 $h_{3,2}$）为零。这标志着终止。因此，使得迭代产生 $v_{k+1}=0$ 的最小正整数 $k$ 是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3573173"}, {"introduction": "这个练习从代数的角度对算法的终止现象给出了更深层次的解释。克雷洛夫子空间的最终维度，也就是迭代过程的步数，并非是随意的，而是由矩阵 $A$ 关于初始向量 $v$ 的最小多项式的次数精确决定的。通过解决这个问题 [@problem_id:3573197]，你将把这个抽象的代数概念与迭代算法的实际行为联系起来，从而获得更完整的理解。", "problem": "令 $A \\in \\mathbb{R}^{6 \\times 6}$ 为对称矩阵\n$$\nA \\;=\\; \\operatorname{diag}\\big(0,\\,1,\\,2,\\,2,\\,2,\\,2\\big),\n$$\n并令 $v_{1} \\in \\mathbb{R}^{6}$ 为单位向量\n$$\nv_{1} \\;=\\; \\frac{1}{\\sqrt{3}}\\big(e_{1} + e_{2} + e_{3}\\big),\n$$\n其中 $\\{e_{j}\\}_{j=1}^{6}$ 表示 $\\mathbb{R}^{6}$ 的标准基。考虑在精确算术下对 $(A,v_{1})$ 应用 Arnoldi 迭代。\n\n仅使用数值线性代数中的基本定义（Krylov 子空间、相对于向量的最小多项式以及 Arnoldi 关系的定义），完成以下任务：\n\n1. 从克里洛夫子空间 $\\mathcal{K}_{m}(A,v_{1}) = \\operatorname{span}\\{v_{1}, A v_{1}, \\dots, A^{m-1} v_{1}\\}$ 的定义和 $(A,v_{1})$ 的首一最小多项式 $p$ 的定义（即满足 $p(A)v_{1} = 0$ 的次数最低的唯一首一多项式）出发，论证为什么 Arnoldi 迭代必须在 $\\mathcal{K}_{m}(A,v_{1})$ 的维数停止增加时恰好以零残差终止，以及为什么这个停止指标等于 $p$ 的次数。\n\n2. 仅利用 $A$ 的对称性和 Arnoldi 基 $\\{v_{j}\\}$ 的标准正交性，推断为什么投影矩阵 $H_{m} = V_{m}^{\\top} A V_{m}$ 是对称且上 Hessenberg 的，因此是三对角的，从而 Arnoldi 关系在终止前简化为三项递推关系（即 Lanczos 关系）。\n\n3. 明确地确定 $(A,v_{1})$ 的首一最小多项式 $p$。你的最终答案必须是这个多项式 $p(x)$，写成一个单一的闭式解析表达式。\n\n不需要进行数值舍入。请将你的最终答案以单一解析表达式的形式给出。", "solution": "所陈述的问题是适定的、有科学依据的，并包含了唯一解所需的所有信息。所描述的定义和对象在数值线性代数中是标准的。因此，将提供一个解。\n\n按照要求，该问题分三部分进行解答。\n\n**1. Arnoldi 终止、Krylov 子空间维数与最小多项式次数之间的关系**\n\n令 $\\mathcal{K}_{m}(A,v_{1}) = \\operatorname{span}\\{v_{1}, A v_{1}, \\dots, A^{m-1} v_{1}\\}$ 是由矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和起始向量 $v_{1} \\in \\mathbb{R}^{n}$ 生成的 $m$ 阶克里洛夫子空间。该子空间的维数 $\\dim(\\mathcal{K}_{m}(A,v_{1}))$ 是 $m$ 的一个非递减函数。维数在第一个满足 $\\dim(\\mathcal{K}_{d+1}(A,v_{1})) = \\dim(\\mathcal{K}_{d}(A,v_{1}))$ 的整数 $m=d$ 处停止增加。这发生在向量 $A^{d}v_{1}$ 与前面的向量 $\\{v_{1}, A v_{1}, \\dots, A^{d-1} v_{1}\\}$ 线性相关时。这种线性相关性意味着存在系数 $c_0, c_1, \\dots, c_{d-1}$ 使得：\n$$\nA^{d}v_{1} = -c_{d-1} A^{d-1} v_{1} - \\dots - c_1 A v_{1} - c_0 v_{1}\n$$\n这可以重新排列为 $(A^{d} + c_{d-1} A^{d-1} + \\dots + c_1 A + c_0 I)v_{1} = 0$。\n\n根据定义，$(A,v_{1})$ 的首一最小多项式 $p(x)$ 是满足 $p(A)v_{1} = 0$ 的次数最低的唯一首一多项式。上述条件表明存在一个次数为 $d$ 的首一多项式，即 $p(x) = x^d + c_{d-1}x^{d-1} + \\dots + c_0$，它零化 $v_1$。由于 $d$ 是出现这种线性相关性的*第一个*整数，集合 $\\{v_{1}, A v_{1}, \\dots, A^{d-1}v_{1}\\}$ 是线性无关的。因此，任何次数小于 $d$ 的非零多项式都不能零化 $v_1$。所以，$d$ 就是最小多项式 $p(x)$ 的次数。因此，$(A,v_{1})$ 的最小多项式的次数恰好是克里洛夫子空间 $\\mathcal{K}_{m}(A,v_{1})$ 维数稳定时的整数 $d$。\n\nArnoldi 迭代为 $\\mathcal{K}_{m}(A,v_{1})$ 构建了一个标准正交基 $\\{v_{1}, v_{2}, \\dots, v_{m}\\}$。算法在第 $m$ 步的核心步骤是通过将 $Av_m$ 与已有的基向量 $\\{v_1, \\dots, v_m\\}$ 正交化来计算一个新向量 $\\tilde{v}_{m+1}$：\n$$\n\\tilde{v}_{m+1} = Av_{m} - \\sum_{i=1}^{m} h_{i,m} v_{i}, \\quad \\text{其中} \\quad h_{i,m} = v_{i}^{\\top} A v_{m}\n$$\n如果 $\\tilde{v}_{m+1} \\neq 0$，则将其归一化以得到 $v_{m+1} = \\tilde{v}_{m+1} / h_{m+1,m}$，其中 $h_{m+1,m} = \\|\\tilde{v}_{m+1}\\|_2$。当且仅当 $\\tilde{v}_{m+1}=0$ 时，迭代在第 $m$ 步终止。这通常被称为“幸运分解”(lucky breakdown)。\n\n如果 $\\tilde{v}_{m+1}=0$，这意味着 $Av_{m} = \\sum_{i=1}^{m} h_{i,m} v_{i}$。这表明 $Av_{m}$ 位于子空间 $\\mathcal{K}_{m}(A,v_{1}) = \\operatorname{span}\\{v_1, \\dots, v_m\\}$ 内。由于每个 $v_j \\in \\mathcal{K}_j(A,v_1) \\subseteq \\mathcal{K}_m(A,v_1)$，这意味着对于任何向量 $u \\in \\mathcal{K}_{m}(A,v_{1})$，向量 $Au$ 也位于 $\\mathcal{K}_{m}(A,v_{1})$ 内。换句话说，$\\mathcal{K}_{m}(A,v_{1})$ 成为 $A$ 的一个不变子空间。这意味着 $A^m v_1 \\in \\mathcal{K}_m(A,v_1)$，即 $A^m v_1$ 是 $\\{v_{1}, A v_{1}, \\dots, A^{m-1}v_{1}\\}$ 的一个线性组合。这正是克里洛夫子空间序列维数停止增加的条件。因此，停止指标 $m$ 等于 $d$，即最小多项式的次数。\n\n总而言之，Arnoldi 迭代在第 $m=d$ 步终止，因为这是新候选向量是先前基向量的线性组合的第一步。这种情况恰好在 $\\mathcal{K}_{d}(A,v_{1})$ 是一个不变子空间时发生，这等价于克里洛夫子空间序列的维数在 $d$ 处稳定。根据定义，这个指标 $d$ 就是 $(A,v_{1})$ 的最小多项式的次数。\n\n**2. 对称矩阵 A 的 Lanczos 关系推导**\n\nArnoldi 迭代生成一个标准正交矩阵 $V_m = [v_1 | v_2 | \\dots | v_m]$ 和一个上 Hessenberg 矩阵 $H_m$，使得 $V_m^\\top V_m = I_m$。投影矩阵 $H_m$ 由其元素 $h_{i,j} = v_{i}^{\\top} A v_{j}$ 定义。用矩阵形式表示，即为 $H_m = V_m^{\\top} A V_m$。\n\n已知矩阵 $A$ 是对称的，我们有 $A^{\\top} = A$。我们可以通过取 $H_m$ 的转置来检验其对称性：\n$$\nH_m^{\\top} = (V_m^{\\top} A V_m)^{\\top} = V_m^{\\top} A^{\\top} (V_m^{\\top})^{\\top} = V_m^{\\top} A V_m\n$$\n由于 $A^{\\top}=A$ 且 $(V_m^{\\top})^{\\top}=V_m$，我们发现 $H_m^{\\top} = H_m$。因此，矩阵 $H_m$ 是对称的。\n\n根据构造，Arnoldi 过程产生一个上 Hessenberg 矩阵 $H_m$，这意味着其元素对所有 $i  j+1$ 满足 $h_{i,j} = 0$。一个既是对称又是上 Hessenberg 的矩阵必须是三对角的。对称性意味着 $h_{i,j} = h_{j,i}$。如果我们取 $i  j+1$，上 Hessenberg 性质意味着 $h_{i,j}=0$。对称性则进一步意味着对于 $i  j+1$ 有 $h_{j,i}=0$。令 $k=j$ 和 $l=i$，这意味着对于 $l  k+1$ 有 $h_{k,l}=0$，也就是说第一超对角线上方的所有元素都为零。根据定义，一个除了主对角线、第一亚对角线和第一超对角线上的元素外，所有其他元素都为零的矩阵是三对角矩阵。\n\n完整的 Arnoldi 关系是 $A V_m = V_m H_m + h_{m+1,m}v_{m+1}e_m^{\\top}$。考察该矩阵方程的第 $j$ 列，得到向量递推关系：\n$$\nA v_j = \\sum_{i=1}^{j+1} h_{i,j} v_i\n$$\n由于 $H_m$ 是三对角的，唯一非零的系数 $h_{i,j}$ 是对于 $i \\in \\{j-1, j, j+1\\}$ 的情况。我们采用标准的 Lanczos 记法：$\\alpha_j = h_{j,j}$ 和 $\\beta_j = h_{j,j-1}$。由于对称性，$h_{j-1,j} = h_{j,j-1} = \\beta_j$。此外，我们记 $\\beta_{j+1} = h_{j+1,j}$。递推关系简化为：\n$$\nA v_j = h_{j-1,j} v_{j-1} + h_{j,j} v_j + h_{j+1,j} v_{j+1} = \\beta_j v_{j-1} + \\alpha_j v_j + \\beta_{j+1} v_{j+1}\n$$\n（约定 $\\beta_1 v_0 = 0$）。这就是 Lanczos 迭代特有的三项递推关系。因此，对于对称矩阵 $A$，Arnoldi 迭代简化为 Lanczos 迭代。\n\n**3. 确定 (A, v1) 的首一最小多项式**\n\n我们寻求最低次数 $d$ 的首一多项式 $p(x)$，使得 $p(A)v_1=0$。这等价于找到最小的 $d$，使得向量集合 $\\{v_1, Av_1, \\dots, A^{d-1}v_1, A^d v_1\\}$ 是线性相关的。让我们来计算这些向量。\n\n给定 $A = \\operatorname{diag}(0, 1, 2, 2, 2, 2)$ 和 $v_1 = \\frac{1}{\\sqrt{3}}(e_1 + e_2 + e_3)$。\n$A$ 对标准基向量的作用是 $Ae_1 = 0 \\cdot e_1 = 0$，$Ae_2 = 1 \\cdot e_2 = e_2$，以及 $Ae_3 = 2 \\cdot e_3 = 2e_3$。\n\n我们来计算克里洛夫序列中的前几个向量：\n- $v_1 = \\frac{1}{\\sqrt{3}}(e_1 + e_2 + e_3)$\n- $Av_1 = A \\frac{1}{\\sqrt{3}}(e_1 + e_2 + e_3) = \\frac{1}{\\sqrt{3}}(Ae_1 + Ae_2 + Ae_3) = \\frac{1}{\\sqrt{3}}(0 + e_2 + 2e_3) = \\frac{1}{\\sqrt{3}}(e_2 + 2e_3)$\n- $A^2v_1 = A(Av_1) = A \\frac{1}{\\sqrt{3}}(e_2 + 2e_3) = \\frac{1}{\\sqrt{3}}(Ae_2 + 2Ae_3) = \\frac{1}{\\sqrt{3}}(e_2 + 2(2e_3)) = \\frac{1}{\\sqrt{3}}(e_2 + 4e_3)$\n- $A^3v_1 = A(A^2v_1) = A \\frac{1}{\\sqrt{3}}(e_2 + 4e_3) = \\frac{1}{\\sqrt{3}}(Ae_2 + 4Ae_3) = \\frac{1}{\\sqrt{3}}(e_2 + 4(2e_3)) = \\frac{1}{\\sqrt{3}}(e_2 + 8e_3)$\n\n向量 $v_1, Av_1, A^2v_1, \\dots$ 都位于子空间 $\\operatorname{span}\\{e_1, e_2, e_3\\}$ 中，这是一个 3 维空间。因此，这些向量中任意 4 个或更多的集合都必须是线性相关的。最小多项式的次数最多为 3。\n\n我们检查 $\\{v_1, Av_1, A^2v_1\\}$ 的线性无关性。忽略公共因子 $\\frac{1}{\\sqrt{3}}$，我们检查向量 $u_0 = e_1+e_2+e_3$，$u_1 = e_2+2e_3$ 和 $u_2 = e_2+4e_3$。将它们在基 $\\{e_1, e_2, e_3\\}$ 中表示，我们构成矩阵：\n$$\nM = \\begin{pmatrix} 1  0  0 \\\\ 1  1  1 \\\\ 1  2  4 \\end{pmatrix}\n$$\n行列式为 $\\det(M) = 1 \\cdot (1 \\cdot 4 - 1 \\cdot 2) - 0 + 0 = 2 \\neq 0$。因此，$\\{v_1, Av_1, A^2v_1\\}$ 是一个线性无关集。最小多项式的次数至少为 3。\n\n由于次数至少为 3 且最多为 3，它必须恰好为 $d=3$。最小多项式的形式为 $p(x) = x^3 + c_2 x^2 + c_1 x + c_0$。我们通过求解 $p(A)v_1 = 0$ 来找到系数，这等价于 $A^3v_1 + c_2 A^2v_1 + c_1 Av_1 + c_0 v_1 = 0$。\n代入计算出的向量（并消去因子 $\\frac{1}{\\sqrt{3}}$）：\n$$\n(e_2 + 8e_3) + c_2(e_2 + 4e_3) + c_1(e_2 + 2e_3) + c_0(e_1 + e_2 + e_3) = 0\n$$\n我们收集每个基向量的项：\n- $e_1$ 的系数： $c_0 = 0$\n- $e_2$ 的系数： $1 + c_2 + c_1 + c_0 = 0$\n- $e_3$ 的系数： $8 + 4c_2 + 2c_1 + c_0 = 0$\n\n我们得到一个关于 $c_0, c_1, c_2$ 的线性方程组：\n1. $c_0 = 0$\n2. $c_1 + c_2 = -1$\n3. $2c_1 + 4c_2 = -8 \\implies c_1 + 2c_2 = -4$\n\n从方程(3)中减去方程(2)：\n$(c_1 + 2c_2) - (c_1 + c_2) = -4 - (-1)$\n$c_2 = -3$\n\n将 $c_2 = -3$ 代入方程(2)：\n$c_1 + (-3) = -1 \\implies c_1 = 2$\n\n系数为 $c_0 = 0$，$c_1 = 2$ 和 $c_2 = -3$。因此，首一最小多项式为：\n$$\np(x) = x^3 - 3x^2 + 2x\n$$\n这个多项式可以分解为 $p(x) = x(x-1)(x-2)$。其根是 $A$ 的特征值（0, 1, 2），对应于在 $v_1$ 的展开式中具有非零分量的特征向量（$e_1, e_2, e_3$）。这为结果提供了一个概念上的验证。", "answer": "$$\n\\boxed{x^3 - 3x^2 + 2x}\n$$", "id": "3573197"}]}