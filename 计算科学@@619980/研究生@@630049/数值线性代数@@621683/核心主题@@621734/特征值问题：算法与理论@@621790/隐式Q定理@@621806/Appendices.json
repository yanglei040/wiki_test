{"hands_on_practices": [{"introduction": "存在多种算法可用于计算矩阵的 Hessenberg 分解。本练习探讨了一个基本问题：这些不同的路径是否会通向相同的终点？通过比较 Arnoldi 过程和 Householder 变换这两种方法，我们可以直接验证隐式 Q 定理核心的唯一性原理，该原理是稳健特征值算法的基石。[@problem_id:3589448]", "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 由下式给出\n$$\nA = \\begin{pmatrix}\n2  -1  0  3 \\\\\n4  1  -2  0 \\\\\n1  5  3  -1 \\\\\n-2  0  4  2\n\\end{pmatrix}.\n$$\n一个实矩阵 $H \\in \\mathbb{R}^{n \\times n}$ 被称为上Hessenberg矩阵，如果对于所有 $i \\geq j+2$ 都有 $H_{i,j} = 0$。一个正交相似变换 $Q^{\\top} A Q$ 被称为 $A$ 的Hessenberg约化，如果 $Q \\in \\mathbb{R}^{n \\times n}$ 是正交的且 $Q^{\\top} A Q$ 是上Hessenberg矩阵。\n\n使用两种不同的消元顺序，构造 $A$ 到一个上Hessenberg矩阵的两种不同Hessenberg约化：\n- 约化 I (左右Householder相似变换)：对于 $j = 1,2,3$，定义一个Householder反射矩阵 $U_j \\in \\mathbb{R}^{4 \\times 4}$，它仅对行和列 $j+1,\\dots,4$ 进行非平凡操作，并消去当前迭代矩阵第 $j$ 列中第一副对角线下方的所有元素。令 $Q_H := U_1 U_2 U_3$ 且 $H_H := Q_H^{\\top} A Q_H$。采用符号约定，使得 $H_H$ 的每个副对角线元素都为非负。\n- 约化 II (完整Arnoldi过程)：从 $q_1 := e_1 \\in \\mathbb{R}^4$ 开始，对于 $k=1,2,3$，计算 $w := A q_k$，通过 $h_{j,k} := q_j^{\\top} w$ 和 $w := w - \\sum_{j=1}^{k} h_{j,k} q_j$ 进行正交化，然后令 $h_{k+1,k} := \\|w\\|_2$，并令 $q_{k+1} := w / h_{k+1,k}$。收集列向量构成 $Q_A := [q_1,q_2,q_3,q_4] \\in \\mathbb{R}^{4 \\times 4}$，并通过 $A Q_A = Q_A H_A$ 定义 $H_A$，因此 $H_A = Q_A^{\\top} A Q_A$。注意，根据构造，$H_A$ 是上Hessenberg矩阵且 $h_{k+1,k} \\geq 0$。\n\n在整个过程中，假设两个过程都能无故障地完成，并且得到的Hessenberg矩阵是不可约的，即所有副对角线元素都非零。\n\n从正交相似性、Hessenberg结构和Arnoldi关系的核心定义出发，证明如果 $Q_H e_1 = Q_A e_1$ 且两种副对角线元素的符号约定都如上所述被强制执行，那么这两个Hessenberg矩阵是重合的，即 $H_H = H_A$。最后，计算Frobenius范数 $\\|H_H - H_A\\|_F$ 作为一个精确的实数。你的最终答案必须是一个实数。不需要四舍五入。", "solution": "问题要求证明一个矩阵 $A$ 的两种Hessenberg约化——一种通过Householder变换（$H_H$）构造，另一种通过Arnoldi过程（$H_A$）构造——在特定条件下是相同的。随后，要求计算它们差的Frobenius范数 $\\|H_H - H_A\\|_F$。\n\n该论证依赖于Hessenberg分解的一个基本唯一性属性。这个属性通常被称为隐式Q定理，它指出，如果由正交矩阵 $Q_1$ 和 $Q_2$ 定义的两个正交相似变换，分别将矩阵 $A$ 约化为不可约的上Hessenberg形式 $H_1$ 和 $H_2$，并且如果 $Q_1$ 和 $Q_2$ 的第一列相同，且 $H_1$ 和 $H_2$ 的副对角线元素符号相同，那么这两个变换是相同的，即 $Q_1 = Q_2$ 且 $H_1 = H_2$。\n\n我们将按要求从第一性原理出发来证明这个原则。设 $n=4$。\n两种Hessenberg约化由下式给出：\n$1.$ $H_H = Q_H^{\\top} A Q_H$，可重写为 $A Q_H = Q_H H_H$。\n$2.$ $H_A = Q_A^{\\top} A Q_A$，可重写为 $A Q_A = Q_A H_A$。\n\n这里，$Q_H, Q_A \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$H_H, H_A \\in \\mathbb{R}^{n \\times n}$ 是上Hessenberg矩阵。设正交矩阵的列向量为 $Q_H = [q_{H,1}, q_{H,2}, \\dots, q_{H,n}]$ 和 $Q_A = [q_{A,1}, q_{A,2}, \\dots, q_{A,n}]$。\n\n问题给出了以下关键条件：\n- **起始向量：** $Q_H e_1 = Q_A e_1$。这意味着第一列是相同的：$q_{H,1} = q_{A,1}$。我们用 $q_1$ 表示这个共同的向量。在这个具体问题中，Arnoldi过程以 $q_{A,1} = e_1$ 开始，而针对第一列的Householder构造对第一个分量进行平凡操作，也确保了 $q_{H,1}=e_1$。因此 $q_1 = e_1$。\n- **不可约形式：** $H_H$ 和 $H_A$ 都是不可约的，意味着它们的副对角线元素都非零。对于 $k=1, \\dots, n-1$，我们有 $(H_H)_{k+1,k} \\neq 0$ 和 $(H_A)_{k+1,k} \\neq 0$。\n- **符号约定：** $H_H$ 和 $H_A$ 的副对角线元素都是非负的。对于 $k=1, \\dots, n-1$，我们有 $(H_H)_{k+1,k} > 0$ 和 $(H_A)_{k+1,k} > 0$。\n\n矩阵方程 $A Q = Q H$ 意味着 $Q$ 的列向量和 $H$ 的元素之间存在关系。该方程的第 $k$ 列是 $A q_k = \\sum_{i=1}^n q_i H_{i,k}$。由于 $H$ 是上Hessenberg矩阵，对于 $i > k+1$ 有 $H_{i,k} = 0$。因此，该关系简化为Arnoldi递推关系：\n$$A q_k = \\sum_{i=1}^{k+1} q_i H_{i,k} = H_{1,k} q_1 + \\dots + H_{k,k} q_k + H_{k+1,k} q_{k+1}$$\n这个递推关系是我们归纳证明的基础。我们将证明对于所有 $k=1, \\dots, n$，$q_{H,k}=q_{A,k}$ 并且 $H_H$ 和 $H_A$ 的第 $k$ 列是相同的。\n\n**归纳证明：**\n\n**基础情况：$k=1$**\n我们从给定条件 $q_{H,1} = q_{A,1} = q_1$ 开始。\n对于 $k=1$，两种约化的Arnoldi递推关系为：\n$A q_1 = (H_H)_{1,1} q_1 + (H_H)_{2,1} q_{H,2}$\n$A q_1 = (H_A)_{1,1} q_1 + (H_A)_{2,1} q_{A,2}$\n用 $q_1$ 对两边取内积，并利用列向量的正交性（$q_1^{\\top}q_1=1$, $q_1^{\\top}q_{H,2}=0$, $q_1^{\\top}q_{A,2}=0$），我们确定对角线元素 $(H)_{1,1}$：\n$(H_H)_{1,1} = q_1^{\\top} A q_1$\n$(H_A)_{1,1} = q_1^{\\top} A q_1$\n因此，$(H_H)_{1,1} = (H_A)_{1,1}$。设此值为 $h_{1,1}$。\n\n现在我们重新整理递推关系以找到下一个向量：\n$(H_H)_{2,1} q_{H,2} = A q_1 - h_{1,1} q_1$\n$(H_A)_{2,1} q_{A,2} = A q_1 - h_{1,1} q_1$\n等式右边是相同的。设 $w_1 = A q_1 - h_{1,1} q_1$。对两边取欧几里得范数：\n$|(H_H)_{2,1}| \\cdot \\|q_{H,2}\\|_2 = \\|w_1\\|_2 \\implies |(H_H)_{2,1}| = \\|w_1\\|_2$\n$|(H_A)_{2,1}| \\cdot \\|q_{A,2}\\|_2 = \\|w_1\\|_2 \\implies |(H_A)_{2,1}| = \\|w_1\\|_2$\n根据所施加的符号约定，副对角线元素是非负的。这消除了符号的模糊性：\n$(H_H)_{2,1} = \\|w_1\\|_2$\n$(H_A)_{2,1} = \\|w_1\\|_2$\n因此，$(H_H)_{2,1} = (H_A)_{2,1}$。设此值为 $h_{2,1}$。\n\n问题说明了矩阵是不可约的，所以 $h_{2,1} > 0$。我们现在可以解出下一个向量：\n$q_{H,2} = \\frac{w_1}{h_{2,1}}$\n$q_{A,2} = \\frac{w_1}{h_{2,1}}$\n这证明了 $q_{H,2}=q_{A,2}$。基础情况成立。\n\n**归纳步骤：**\n假设对于某个 $k \\le n-1$，我们已经证明了对于 $j=1, \\dots, k$ 有 $q_{H,j} = q_{A,j}$，并且 $H_H$ 和 $H_A$ 的前 $k-1$ 列是相同的。我们现在证明这对于Hessenberg矩阵的第 $k$ 列和正交矩阵的第 $k+1$ 个向量也成立。\n\n设 $q_j$ 表示对于 $j \\leq k$ 的共同向量 $q_{H,j}=q_{A,j}$。对于第 $k$ 列的Arnoldi关系是：\n$A q_k = \\sum_{i=1}^{k} (H_H)_{i,k} q_i + (H_H)_{k+1,k} q_{H,k+1}$\n$A q_k = \\sum_{i=1}^{k} (H_A)_{i,k} q_i + (H_A)_{k+1,k} q_{A,k+1}$\n\n对于任何 $j \\in \\{1, \\dots, k\\}$，我们与 $q_j$ 取内积。利用正交性（$q_j^{\\top}q_i = \\delta_{ij}$ 和 $q_j^{\\top}q_{H,k+1} = q_j^{\\top}q_{A,k+1} = 0$），我们得到：\n$(H_H)_{j,k} = q_j^{\\top} A q_k$\n$(H_A)_{j,k} = q_j^{\\top} A q_k$\n因此，对于 $j=1, \\dots, k$，有 $(H_H)_{j,k} = (H_A)_{j,k}$。这表明两个矩阵第 $k$ 列对角线及其上方的元素是相同的。\n\n接下来，我们分离出表示下一个向量的项：\n$(H_H)_{k+1,k} q_{H,k+1} = A q_k - \\sum_{i=1}^{k} (H_H)_{i,k} q_i$\n$(H_A)_{k+1,k} q_{A,k+1} = A q_k - \\sum_{i=1}^{k} (H_A)_{i,k} q_i$\n因为我们刚刚证明了对于 $i \\leq k$，有 $(H_H)_{i,k}=(H_A)_{i,k}$，所以等式右边是相同的。设这个向量为 $w_k$。\n取范数，我们找到副对角线元素：\n$|(H_H)_{k+1,k}| = \\|w_k\\|_2$\n$|(H_A)_{k+1,k}| = \\|w_k\\|_2$\n再次，非负符号约定强制要求 $(H_H)_{k+1,k} = (H_A)_{k+1,k}$。设此值为 $h_{k+1,k}$。不可约的假设保证了 $h_{k+1,k} > 0$。\n\n我们现在可以唯一地确定下一个向量：\n$q_{H,k+1} = \\frac{w_k}{h_{k+1,k}}$\n$q_{A,k+1} = \\frac{w_k}{h_{k+1,k}}$\n这证明了 $q_{H,k+1} = q_{A,k+1}$，完成了归纳步骤。\n\n**证明结论：**\n通过归纳，我们证明了对于所有 $k=1, \\dots, n$，有 $q_{H,k} = q_{A,k}$，这意味着 $Q_H = Q_A$。我们还证明了 $H_H$ 和 $H_A$ 的前 $n-1$ 列是相同的。对于最后一列 $k=n$，Arnoldi递推关系是 $A q_n = \\sum_{i=1}^n (H)_{i,n} q_i$。与 $q_j$（对于 $j=1, \\dots, n$）取内积得到 $(H)_{j,n} = q_j^{\\top} A q_n$。由于两种过程的 $q_j$ 都相同，最后一列也相同。\n因此，在给定条件下，这两个Hessenberg矩阵必须相同：$H_H = H_A$。\n\n**Frobenius范数的计算：**\n问题要求计算 $\\|H_H - H_A\\|_F$ 的值。根据上面的证明，我们得出结论 $H_H = H_A$。它们的差是 $4 \\times 4$ 的零矩阵，记为 $\\mathbf{0}$。\n$$H_H - H_A = \\mathbf{0} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix}$$\n一个矩阵 $M \\in \\mathbb{R}^{m \\times n}$ 的Frobenius范数定义为 $\\|M\\|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n |M_{i,j}|^2}$。\n对于零矩阵，这个计算是微不足道的：\n$$\\|H_H - H_A\\|_F = \\|\\mathbf{0}\\|_F = \\sqrt{\\sum_{i=1}^4 \\sum_{j=1}^4 0^2} = \\sqrt{0} = 0$$\n得出这个结论并不需要矩阵 $A$ 的具体数值，因为这个结果源于一个关于Hessenberg形式唯一性的一般性定理。", "answer": "$$\n\\boxed{0}\n$$", "id": "3589448"}, {"introduction": "深刻理解一个定理不仅需要知道它何时适用，还需要了解它何时会*失效*。本练习将揭示为何隐式 Q 定理中的“非约化”条件并非一个无关紧要的技术细节。通过构造一个使用*约化* Hessenberg 矩阵的反例，你将看到唯一性是如何被破坏的，从而允许存在一个连续的变换族来保持 Hessenberg 结构。[@problem_id:3589422]", "problem": "思考以下定义：上Hessenberg矩阵 (upper Hessenberg matrix) 是一种方形矩阵，其第一副对角线以下的所有元素均为零；未约化上Hessenberg矩阵 (unreduced upper Hessenberg matrix) 是一种每个副对角线元素都非零的上Hessenberg矩阵；约化上Hessenberg矩阵 (reduced upper Hessenberg matrix) 是一种至少有一个零副对角线元素的上Hessenberg矩阵；酉矩阵 (unitary matrix) 是一个满足 $\\mathcal{U}^{*}\\mathcal{U}=I$ 的方形矩阵 $\\mathcal{U}$，其中 $I$ 是单位矩阵，$\\mathcal{U}^{*}$ 表示共轭转置。隐式 $Q$ 定理断言了在适当条件下，保持未约化Hessenberg形式的酉相似变换具有唯一性，并且其未约化性假设是必要的。你的任务是在未约化性不成立时，明确地构造一个唯一性的反例，并计算一个标量来验证该构造。\n\n设\n$$\nH=\\begin{pmatrix}\n0  1  4  0 \\\\\n2  0  5  6 \\\\\n0  0  2  1 \\\\\n0  0  1  3\n\\end{pmatrix},\n$$\n这是一个上Hessenberg矩阵，在位置 $(3,2)$ 处有一个为零的副对角线元素，因此是约化的。对于角度 $\\theta\\in\\mathbb{R}$，定义酉矩阵族\n$$\nU(\\theta)=\\operatorname{diag}\\!\\big(1,\\,1,\\,R(\\theta)\\big),\\quad R(\\theta)=\\begin{pmatrix}\\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta\\end{pmatrix}.\n$$\n显然，对于所有 $\\theta$，$U(\\theta)e_{1}=e_{1}$。你将证明对于所有 $\\theta$，$U(\\theta)^{*}HU(\\theta)$ 都是上Hessenberg矩阵，但对于一个非零的 $\\theta$ 选择，$U(\\theta)$ 却不是对角矩阵。\n\n从第一性原理推导保证上Hessenberg形式在此相似变换下得以保持的结构不变性，然后确定唯一的 $\\theta\\in(0,\\pi/2)$（以弧度为单位），使得 $U(\\theta)^{*}HU(\\theta)$ 的 $(4,3)$ 元素等于 $0$。请以弧度为单位，用闭式解析表达式提供你的最终答案。不需要四舍五入，最终的方框表达式内不应包含单位。构造和推导的细节必须根据所述定义以及酉相似性和分块矩阵的基本性质来证明。", "solution": "该问题要求在未约化Hessenberg假设不满足时，为隐式 $Q$ 定理的唯一性条款构造一个反例。我们给定一个约化的上Hessenberg矩阵 $H$ 和一个酉矩阵族 $U(\\theta)$，我们必须证明相似变换 $U(\\theta)^* H U(\\theta)$ 对所有 $\\theta$ 都保持上Hessenberg形式，从而证明唯一性的失效。最后，我们必须计算一个特定的 $\\theta$ 值，使得变换后矩阵的某个特定元素为零。\n\n首先，我们验证给定信息。矩阵 $H$ 由下式给出\n$$\nH=\\begin{pmatrix}\n0  1  4  0 \\\\\n2  0  5  6 \\\\\n0  0  2  1 \\\\\n0  0  1  3\n\\end{pmatrix}.\n$$\n这是一个上Hessenberg矩阵，因为所有满足 $i > j+1$ 的元素都为零。具体来说，元素 $h_{31}$、$h_{41}$ 和 $h_{42}$ 均为零。该矩阵是约化的，因为次对角线元素 $h_{32}$ 为 $0$。矩阵族 $U(\\theta)$ 由下式给出\n$$\nU(\\theta)=\\operatorname{diag}\\!\\big(1,\\,1,\\,R(\\theta)\\big) = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  \\cos\\theta  -\\sin\\theta \\\\\n0  0  \\sin\\theta  \\cos\\theta\n\\end{pmatrix}.\n$$\n对于每个 $\\theta \\in \\mathbb{R}$，$U(\\theta)$ 是一个实正交矩阵，因此是酉矩阵。它的共轭转置就是它的转置，$U(\\theta)^* = U(\\theta)^T$。条件 $U(\\theta)e_1 = e_1$ 对所有 $\\theta$ 都满足，因为 $U(\\theta)$ 的第一列是 $(1,0,0,0)^T$。\n\n这个问题的关键结构特征源于零次对角线元素 $h_{32}=0$。这使我们能够对矩阵 $H$ 和 $U(\\theta)$ 进行相容的分块。我们使用一个 $2 \\times 2$ 的分块结构，其中每个块都是一个 $2 \\times 2$ 的矩阵。\n$$\nH = \\begin{pmatrix} H_{11}  H_{12} \\\\ H_{21}  H_{22} \\end{pmatrix}, \\quad U(\\theta) = \\begin{pmatrix} I_2  0 \\\\ 0  R(\\theta) \\end{pmatrix},\n$$\n其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵，$0$ 是 $2 \\times 2$ 的零矩阵。$H$ 的分块是：\n$$\nH_{11} = \\begin{pmatrix} 0  1 \\\\ 2  0 \\end{pmatrix}, \\quad H_{12} = \\begin{pmatrix} 4  0 \\\\ 5  6 \\end{pmatrix}, \\quad H_{21} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}, \\quad H_{22} = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}.\n$$\n关键的观察是 $H_{21}$ 是零矩阵。这是元素 $h_{31}, h_{41}, h_{32}, h_{42}$ 均为零的直接结果。特别地，在 $h_{32}$ 处指定的零元素对于此分块结构至关重要。\n\n现在，我们来计算相似变换 $\\tilde{H}(\\theta) = U(\\theta)^*HU(\\theta)$。由于 $U(\\theta)$ 是实矩阵，所以 $U(\\theta)^* = U(\\theta)^T$。\n$$\n\\tilde{H}(\\theta) = \\begin{pmatrix} I_2  0 \\\\ 0  R(\\theta)^T \\end{pmatrix} \\begin{pmatrix} H_{11}  H_{12} \\\\ H_{21}  H_{22} \\end{pmatrix} \\begin{pmatrix} I_2  0 \\\\ 0  R(\\theta) \\end{pmatrix}.\n$$\n使用分块矩阵乘法规则：\n$$\n\\tilde{H}(\\theta) = \\begin{pmatrix} I_2 H_{11} I_2  I_2 H_{12} R(\\theta) \\\\ R(\\theta)^T H_{21} I_2  R(\\theta)^T H_{22} R(\\theta) \\end{pmatrix} = \\begin{pmatrix} H_{11}  H_{12} R(\\theta) \\\\ R(\\theta)^T H_{21}  R(\\theta)^T H_{22} R(\\theta) \\end{pmatrix}.\n$$\n由于 $H_{21}$ 是零矩阵，所以 $R(\\theta)^T H_{21}$ 也是零矩阵。因此，变换后的矩阵具有以下形式：\n$$\n\\tilde{H}(\\theta) = \\begin{pmatrix} H_{11}  H_{12} R(\\theta) \\\\ 0  R(\\theta)^T H_{22} R(\\theta) \\end{pmatrix}.\n$$\n这是一个分块上三角矩阵。在 $(2,1)$ 块位置的零矩阵意味着元素 $\\tilde{h}_{31}, \\tilde{h}_{41}, \\tilde{h}_{32}, \\tilde{h}_{42}$ 都为零。上Hessenberg矩阵的条件是当 $i > j+1$ 时，元素 $\\tilde{h}_{ij}$ 为零。这个零块确保了对于 $(i,j) \\in \\{(3,1), (4,1), (4,2)\\}$ 这是成立的。因此，对于所有 $\\theta$ 值，$\\tilde{H}(\\theta)$ 都是一个上Hessenberg矩阵。这展示了结构不变性。对于任何 $\\theta \\in (0, \\pi)$，矩阵 $U(\\theta)$ 都不是对角矩阵，然而 $U(\\theta)e_1=e_1$ 且 $U(\\theta)^*HU(\\theta)$ 是Hessenberg矩阵。这个变换族可以作为隐式Q定理唯一性部分的一个反例，如果 $H$ 是未约化的，该定理会迫使 $U(\\theta)$ 成为对角矩阵。\n\n下一个任务是找到唯一的 $\\theta \\in (0, \\pi/2)$，使得 $\\tilde{H}(\\theta)$ 的 $(4,3)$ 元素为零。整个矩阵 $\\tilde{H}(\\theta)$ 的 $(4,3)$ 元素是分块 $\\tilde{H}_{22}(\\theta) = R(\\theta)^T H_{22} R(\\theta)$ 的 $(2,1)$ 元素。我们必须计算这个元素并令其为零。\n令 $c = \\cos\\theta$ 和 $s = \\sin\\theta$。我们有：\n$$\n\\tilde{H}_{22}(\\theta) = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix}.\n$$\n让我们首先计算乘积 $H_{22}R(\\theta)$：\n$$\nH_{22}R(\\theta) = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix} = \\begin{pmatrix} 2c+s  -2s+c \\\\ c+3s  -s+3c \\end{pmatrix}.\n$$\n现在，我们用 $R(\\theta)^T$ 左乘：\n$$\n\\tilde{H}_{22}(\\theta) = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 2c+s  -2s+c \\\\ c+3s  -s+3c \\end{pmatrix}.\n$$\n该乘积的 $(2,1)$ 元素，即对应于 $\\tilde{h}_{43}$ 的元素，由第一个矩阵的第二行与第二个矩阵的第一列的点积给出：\n$$\n\\tilde{h}_{43}(\\theta) = (-s)(2c+s) + (c)(c+3s) = -2sc - s^2 + c^2 + 3sc = c^2 - s^2 + sc.\n$$\n使用二倍角三角恒等式 $\\cos(2\\theta) = \\cos^2\\theta - \\sin^2\\theta$ 和 $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$，我们可以将其重写为：\n$$\n\\tilde{h}_{43}(\\theta) = \\cos(2\\theta) + \\frac{1}{2}\\sin(2\\theta).\n$$\n我们需要找到 $\\theta \\in (0, \\pi/2)$ 使得 $\\tilde{h}_{43}(\\theta) = 0$。\n$$\n\\cos(2\\theta) + \\frac{1}{2}\\sin(2\\theta) = 0.\n$$\n这可以重新整理为 $\\frac{1}{2}\\sin(2\\theta) = -\\cos(2\\theta)$。对于 $\\theta \\in (0, \\pi/2)$，$2\\theta \\in (0, \\pi)$。在此区间内，$\\cos(2\\theta)$ 仅在 $2\\theta=\\pi/2$ 时为零，此时 $\\sin(2\\theta)=1$，因此方程不满足。所以我们可以安全地两边同除以 $\\cos(2\\theta)$：\n$$\n\\frac{\\sin(2\\theta)}{\\cos(2\\theta)} = \\tan(2\\theta) = -2.\n$$\n我们正在寻找在区间 $(0, \\pi/2)$ 内的 $\\theta$ 的解，这意味着 $2\\theta$ 在区间 $(0, \\pi)$ 内。正切函数在第二象限为负，所以 $2\\theta$ 必须在 $(\\pi/2, \\pi)$ 内。$\\tan(x) = y$ 的通解是 $x = \\arctan(y) + k\\pi$，其中 $k$ 为整数。\n$$\n2\\theta = \\arctan(-2) + k\\pi.\n$$\n由于 $\\arctan(-2)$ 位于 $(-\\pi/2, 0)$ 内，我们必须选择 $k=1$ 以使 $2\\theta$ 落在期望的区间 $(0, \\pi)$ 内。\n$$\n2\\theta = \\pi - \\arctan(2).\n$$\n使用恒等式 $\\arctan(-x) = -\\arctan(x)$，我们有：\n$$\n2\\theta = \\pi - \\arctan(2).\n$$\n这个值位于 $(\\pi/2, \\pi)$ 内，正如所期望的。最后，解出 $\\theta$：\n$$\n\\theta = \\frac{1}{2}\\left(\\pi - \\arctan(2)\\right).\n$$\n这个值位于 $(\\pi/4, \\pi/2)$ 内，这在指定的区间 $(0, \\pi/2)$ 之内。", "answer": "$$ \\boxed{\\frac{1}{2}\\left(\\pi - \\arctan(2)\\right)} $$", "id": "3589422"}, {"introduction": "隐式 Q 定理不仅仅是一个优美的理论结果，它更是驱动高效、带位移 QR 算法的引擎。本练习邀请你通过分步分析“凸起追逐”（bulge-chasing）过程来剖析这个引擎。你将证明由初始位移隐式定义的一系列 Givens 旋转如何巧妙地恢复 Hessenberg 形式，从而展示该定理的实际应用。[@problem_id:3589432]", "problem": "设 $H \\in \\mathbb{C}^{n \\times n}$ 是一个不可约上Hessenberg矩阵，这意味着 $H$ 是上Hessenberg矩阵，并且对于 $1 \\leq i \\leq n-1$，每个次对角元 $h_{i+1,i}$ 都是非零的。设 $\\sigma \\in \\mathbb{C}$ 是一个给定的位移，并定义 $x^{(1)} = (H - \\sigma I)e_1 \\in \\mathbb{C}^{n}$，其中 $e_1$ 是第一个标准基向量，$I$ 是单位矩阵。一个作用于指标 $\\{k,k+1\\}$ 的酉Givens旋转是一个酉矩阵 $G_k \\in \\mathbb{C}^{n \\times n}$，它仅在行和列 $\\{k,k+1\\}$ 上的 $2 \\times 2$ 主子矩阵处与单位矩阵不同，其形式为 $\\begin{pmatrix} c_k  s_k \\\\ -\\overline{s_k}  c_k \\end{pmatrix}$，其中 $c_k \\in \\mathbb{R}_{\\ge 0}$，$s_k \\in \\mathbb{C}$，并且 $c_k^2 + |s_k|^2 = 1$。考虑如下递归定义的序列 $(G_k)_{k=1}^{n-1}$：对于每个 $k = 1,2,\\dots,n-1$，令 $x^{(k)} = G_{k-1}^{*}\\cdots G_1^{*}(H - \\sigma I)e_1$，并选择 $G_k$ 使得其在分量 $(x^{(k)}_k, x^{(k)}_{k+1})$ 上的 $2 \\times 2$ 作用将它们映射到 $(\\alpha_k, 0)$，其中 $\\alpha_k \\in \\mathbb{R}_{\\ge 0}$，即 $G_k^{*} x^{(k)}$ 的第 $k$ 个分量等于 $\\alpha_k$，第 $(k+1)$ 个分量等于零。定义相似序列 $H^{(j)} = G_j^{*}\\cdots G_1^{*} \\, H \\, G_1 \\cdots G_j$，其中 $j = 1,2,\\dots,n-1$。\n\n仅使用不可约上Hessenberg结构、酉相似和Givens旋转的定义，完成以下任务：\n\n1. 对 $j$ 使用数学归纳法证明每个 $H^{(j)}$ 都是上Hessenberg矩阵。你的证明必须论证，在每一步中，对上Hessenberg结构唯一可能的偏离是一个单一的次对角线凸起，该凸起立即被下一次左乘向下追逐一个位置，从而保持了结构。\n\n2. 解释为什么对于一个不可约上Hessenberg矩阵 $H$，上述构造在每个 $G_k$ 可左乘一个作用于 $2 \\times 2$ 块的对角单位模标量的意义下，唯一地确定了序列 $(G_k)_{k=1}^{n-1}$，并由此与通常称为隐式Q定理的陈述（由 $(H - \\sigma I)e_1$ 构造的相似变换下Hessenberg形式的唯一性）联系起来。\n\n最后，根据 $x^{(1)}$ 的前两个分量（记作 $x^{(1)}_1$ 和 $x^{(1)}_2$），确定第一个Givens旋转 $G_1$ 的余弦参数 $c_1$ 的闭式解析表达式。你的最终答案必须是单个精确表达式。不需要四舍五入，也不涉及单位。", "solution": "所提供的问题将分三部分来解决：首先，关于矩阵序列 $H^{(j)}$ 结构的证明；其次，关于所涉及的Givens旋转的唯一性及其与隐式Q定理联系的解释；第三，参数 $c_1$ 的闭式表达式的推导。\n\n在证明第1部分之前，需要澄清一个关键点。问题要求证明每个 $H^{(j)}$ 都是上Hessenberg矩阵，但同时也描述了“凸起”的出现。在凸起追逐的过程中，对于 $j=1, \\dots, n-2$ 的中间矩阵 $H^{(j)}$ 实际上并非严格的上Hessenberg矩阵，而是带有次对角线下方一个额外非零元（一个“凸起”）的上Hessenberg矩阵。因此，本证明将精确地展示这个凸起追逐过程如何系统地将凸起向下移动，使得最终的矩阵 $H^{(n-1)}$ 恢复为真正的上Hessenberg形式，从而遵循问题的描述和意图。\n\n### 第1部分：结构保持性证明\n\n我们将通过归纳法证明，对于 $j=1, \\dots, n-2$，矩阵 $H^{(j)}$ 是上Hessenberg形式，只是在位置 $(j+2, j)$ 有一个单一的非零“凸起”。该过程最终得到 $H^{(n-1)}$，这是一个真正的上Hessenberg矩阵。Givens旋转 $G_k$ 被选择作用于第 $k$ 和 $k+1$ 行/列。在显式凸起追逐算法中，$G_k$ 被定义为消去一个特定元素。正如我们将在第2部分讨论的，问题中给出的 $G_k$ 的隐式定义是等价的。对于本证明，我们考虑这些旋转对矩阵结构的影响。\n\n设初始矩阵为 $H^{(0)} = H$，它是一个不可约上Hessenberg矩阵。\n\n**基础情形 ($j=1$):**\n我们分析 $H^{(1)} = G_1^{*} H G_1$ 的结构。旋转 $G_1$ 作用于指标 $\\{1,2\\}$。\n1.  考虑矩阵 $A = G_1^{*} H$。由于 $G_1^*$ 作用于第1行和第2行，因此对于所有 $i > 2$，$A_{ik} = H_{ik}$。第 $i=1,2$ 行是原始第1、2行的线性组合。一个上Hessenberg矩阵在这种操作下仍然是上Hessenberg矩阵。所以，$A = G_1^* H$ 是一个上Hessenberg矩阵。\n2.  现在考虑 $H^{(1)} = A G_1$。右乘 $G_1$ 形成第1列和第2列的线性组合。对于任何 $k > 2$ 的列，该列不变：对于 $k > 2$，$(H^{(1)})_{ik} = A_{ik}$。由于 $A$ 是上Hessenberg矩阵，这些列满足Hessenberg条件。\n3.  我们检查 $i > 1+1 = 2$ 的元素 $(H^{(1)})_{i,1}$。$H^{(1)}$ 的第一列由 $(H^{(1)})_{\\cdot,1} = c_1 A_{\\cdot,1} - \\overline{s_1} A_{\\cdot,2}$ 给出。\n    对于 $i > 2$ 的一个元素 $(i,1)$，其值为 $(H^{(1)})_{i,1} = c_1 A_{i,1} - \\overline{s_1} A_{i,2}$。\n    由于 $A=G_1^*H$ 且 $i>2$，第 $i$ 行不受 $G_1^*$ 影响。因此，$A_{i,1} = H_{i,1}$ 且 $A_{i,2} = H_{i,2}$。\n    由于 $H$ 是上Hessenberg矩阵，对于 $i > 2$ 有 $H_{i,1} = 0$，对于 $i > 3$ 有 $H_{i,2} = 0$。\n    -   对于 $i=3$：$(H^{(1)})_{3,1} = c_1 H_{3,1} - \\overline{s_1} H_{3,2} = c_1 (0) - \\overline{s_1} h_{32} = -\\overline{s_1} h_{32}$。由于 $H$ 是不可约的，$h_{32} \\neq 0$。参数 $s_1$ 由将 $(H-\\sigma I)e_1 = (h_{11}-\\sigma)e_1 + h_{21}e_2$ 的第二个分量置零的需求所确定。由于 $h_{21} \\neq 0$，所以 $s_1$ 将是非零的。因此，$(H^{(1)})_{3,1} \\neq 0$。这就是位置 $(1+2, 1)$ 处的“凸起”。\n    -   对于 $i>3$：$(H^{(1)})_{i,1} = c_1 H_{i,1} - \\overline{s_1} H_{i,2} = c_1(0) - \\overline{s_1}(0) = 0$。\n因此，$H^{(1)}$ 是上Hessenberg矩阵，除了在 $(3,1)$ 处的单个凸起。基础情形成立。\n\n**归纳步骤：**\n假设对于某个 $1 \\le j-1  n-2$ 的 $j-1$，矩阵 $H^{(j-1)}$ 是上Hessenberg形式，除了在位置 $(j+1, j-1)$ 处有一个单个凸起。我们想要证明 $H^{(j)} = G_j^{*} H^{(j-1)} G_j$ 是上Hessenberg形式，除了在位置 $(j+2, j)$ 处有一个凸起。旋转 $G_j$ 作用于指标 $\\{j, j+1\\}$。\n\n1.  考虑 $B = G_j^{*} H^{(j-1)}$。这将混合第 $j$ 行和第 $j+1$ 行。$H^{(j-1)}$ 中的凸起位于 $(j+1, j-1)$，因此它位于受 $G_j^*$ 影响的一行中。选择旋转 $G_j$ 是为了消去这个凸起。也就是说，$G_j$ 的构造使得 $(B)_{j+1, j-1} = 0$。这个特定的构造定义了 $G_j$。$H^{(j-1)}$ 中次对角线下的所有其他元素都为零，并且此操作不会在次对角线下方创建新的非零元，除非可能在第 $j$ 行第 $j-1$ 列。具体来说，$(B)_{j,j-1}$ 变为非零。矩阵 $B$ 现在是上Hessenberg形式，除了在 $(j, j-1)$ 处有一个非零元。\n2.  现在考虑 $H^{(j)} = B G_j$。这将混合第 $j$ 列和第 $j+1$ 列。\n    -   位置 $(j+1, j-1)$ 处的元素保持为零，因为第 $j-1$ 列不受 $G_j$ 影响：$(H^{(j)})_{j+1, j-1} = B_{j+1, j-1} = 0$。位置 $(j+1, j-1)$ 处的凸起已被移除。\n    -   让我们检查是否在 $(j+2, j)$ 处创建了新的凸起。其值为 $(H^{(j)})_{j+2, j} = c_j B_{j+2, j} - \\overline{s_j} B_{j+2, j+1}$。\n    -   左乘 $G_j^*$ 没有触及第 $j+2$ 行，所以对于所有 $k$，$B_{j+2,k} = (H^{(j-1)})_{j+2,k}$。\n    -   因此，$(H^{(j)})_{j+2, j} = c_j (H^{(j-1)})_{j+2, j} - \\overline{s_j} (H^{(j-1)})_{j+2, j+1}$。\n    -   根据归纳假设，$H^{(j-1)}$ 在其凸起下方是上Hessenberg形式，所以 $(H^{(j-1)})_{j+2, j}=0$。\n    -   元素 $(H^{(j-1)})_{j+2, j+1}$ 位于 $H^{(j-1)}$ 的次对角线上。从不可约Hessenberg矩阵出发的酉相似变换会保持次对角线元素的非零特性。因此，$(H^{(j-1)})_{j+2, j+1} \\neq 0$。同时，$s_j \\neq 0$，因为它被用来消去一个非零凸起。\n    -   所以，$(H^{(j)})_{j+2, j} = -\\overline{s_j} (H^{(j-1)})_{j+2, j+1} \\neq 0$。这就在 $(j+2, j)$ 处创建了新的凸起。\n    -   类似的详细检查证实，次对角线下没有其他元素变为非零。\n\n归纳成立。对于 $j=n-2$，$H^{(n-2)}$ 在 $(n, n-2)$ 处有一个凸起。最后一步是计算 $H^{(n-1)} = G_{n-1}^{*} H^{(n-2)} G_{n-1}$。$G_{n-1}$ 作用于 $\\{n-1, n\\}$。它被选择用来消去 $(n, n-2)$ 处的凸起。右乘 $G_{n-1}$ 会试图在 $(n+1, n-1)$ 处创建一个新的凸起，但这超出了矩阵的维度。因此，$H^{(n-1)}$ 是一个真正的上Hessenberg矩阵。\n\n### 第2部分：唯一性与隐式Q定理\n\nGivens旋转 $(G_k)_{k=1}^{n-1}$ 的构造与Hessenberg形式唯一性之间的联系是隐式Q定理的核心。\n\n关于（不可约）Hessenberg约化唯一性的定理陈述如下：设 $A \\in \\mathbb{C}^{n \\times n}$。如果 $Q$ 和 $V$ 是两个酉矩阵，使得 $Q^* A Q = H$ 和 $V^* A V = K$ 都是不可约上Hessenberg矩阵，并且如果 $Q$ 和 $V$ 的第一列相等，$Qe_1 = Ve_1$，那么存在某个对角酉矩阵 $D$，使得 $V = QD$ 且 $K=D^*HD$。\n\n在我们的问题中，Givens旋转序列 $G_1, \\dots, G_{n-1}$ 构造了一个酉矩阵 $Q = G_1 G_2 \\cdots G_{n-1}$。相似变换的结果是 $\\tilde{H} = Q^* H Q = H^{(n-1)}$，正如第1部分所示，它是一个上Hessenberg矩阵。\n\n$Q$ 的第一列是 $Qe_1 = (G_1 \\cdots G_{n-1})e_1$。由于 $G_k$ 作用于指标 $\\{k,k+1\\}$，对于 $k > 1$，$G_k e_1 = e_1$。因此，$Qe_1 = G_1 e_1$。\n\n问题通过向量 $x^{(1)} = (H-\\sigma I)e_1$ 来定义 $G_1$。具体来说，选择 $G_1^*$ 将 $x^{(1)}$ 旋转成 $e_1$ 的倍数：$G_1^* x^{(1)} = \\alpha_1 e_1$，其中 $\\alpha_1 \\in \\mathbb{R}_{\\ge 0}$。这意味着 $x^{(1)} = \\alpha_1 G_1 e_1$。因此，我们的变换矩阵 $Q$ 的第一列由 $H-\\sigma I$ 的第一列确定：\n$$Qe_1 = G_1 e_1 = \\frac{1}{\\alpha_1} x^{(1)} = \\frac{1}{\\| (H-\\sigma I)e_1 \\|_2} (H-\\sigma I)e_1$$\n这个向量 $Qe_1$ 是新基的起始向量。该过程构造了一个以该向量为第一列的矩阵 $Q$，使得 $Q^*HQ$ 是上Hessenberg矩阵。\n\n唯一性定理保证，对于一个不可约的 $H$，任何这样的酉矩阵 $Q$ 由其第一列 $Qe_1$ 唯一确定（相差一些相位因子）。\n\n我们在第1部分中用作指导的显式凸起追逐算法，也定义了一个Givens旋转序列（我们称之为 $\\{G'_k\\}$）来恢复Hessenberg形式。第一个旋转 $G'_1$ 的选择是为了开始 $H-\\sigma I$ 的QR分解，这与定义 $G_1$ 的条件完全相同。因此，$G'_1 = G_1$。由于整个旋转序列由起始条件（矩阵 $H$ 和第一列 $Qe_1$）唯一确定，因此由向量 $x^{(k)}$ 隐式定义的旋转序列 $G_k$ 必须与通过追逐凸起显式定义的序列 $G'_k$ 相同。这就是为什么该方法被称为“隐式Q”定理：变换 $Q$ 是由 $(H-\\sigma I)e_1$ 隐式确定的，而无需显式地构造矩阵 $H-\\sigma I$ 或其QR分解。\n\n关于Givens旋转本身的唯一性：问题要求选择 $G_k$，使其伴随矩阵 $G_k^*$ 将向量 $(a,b)^T$ 映射到 $(\\alpha_k, 0)^T$，其中 $\\alpha_k \\ge 0$，并且旋转具有 $\\begin{pmatrix} c_k  s_k \\\\ -\\overline{s_k}  c_k \\end{pmatrix}$ 的形式，其中 $c_k \\in \\mathbb{R}_{\\ge 0}$。这组条件唯一地确定了 $c_k$ 和 $s_k$。例如，从方程组 $-s_k a + c_k b = 0$ 和 $c_k^2 + |s_k|^2 = 1$ 中，我们得到 $c_k = |a|/\\sqrt{|a|^2+|b|^2}$ 和 $s_k = c_k(b/a) = \\overline{a}b/(|a|\\sqrt{|a|^2+|b|^2})$。$c_k \\ge 0$ 的条件是自动满足的，且此选择是唯一的。问题中提到的“在每个 $G_k$ 可左乘一个对角单位模标量的意义下唯一”指的是Givens旋转的一种更一般的定义，其中 $c_k$ 不被限制为实数和非负数，而问题的严格定义已经消除了这种自由度。\n\n### 第3部分：$c_1$ 的表达式\n\n我们需要求出第一个Givens旋转 $G_1$ 的余弦参数 $c_1$。\n旋转 $G_1$ 由其对向量 $x^{(1)} = (H-\\sigma I)e_1$ 的前两个分量的作用来定义。\n向量 $x^{(1)}$ 的分量为：\n$$x^{(1)}_1 = h_{11} - \\sigma$$\n$$x^{(1)}_2 = h_{21}$$\n所有其他分量 $x^{(1)}_i$ 对于 $i > 2$ 都为零，因为 $H$ 是上Hessenberg矩阵。\n\nGivens旋转 $G_1$ 作用于由 $\\{e_1, e_2\\}$ 张成的子空间。其伴随矩阵 $G_1^*$ 应用于 $x^{(1)}$ 以将其第二个分量置零。设 $a = x^{(1)}_1$ 和 $b = x^{(1)}_2$。\n我们有 $G_1^{*} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} \\alpha_1 \\\\ 0 \\end{pmatrix}$，其中 $G_1^*$ 的 $2 \\times 2$ 定义部分是 $\\begin{pmatrix} c_1  \\overline{s_1} \\\\ -s_1  c_1 \\end{pmatrix}$。\n结果的第二个分量为零的条件是：\n$$-s_1 a + c_1 b = 0$$\n旋转是酉的，所以我们还有约束条件：\n$$c_1^2 + |s_1|^2 = 1$$\n从第一个方程，假设 $a \\neq 0$，我们有 $s_1 = c_1 \\frac{b}{a}$。将此代入第二个方程：\n$$c_1^2 + \\left|c_1 \\frac{b}{a}\\right|^2 = 1$$\n$$c_1^2 \\left(1 + \\frac{|b|^2}{|a|^2}\\right) = 1$$\n$$c_1^2 \\frac{|a|^2 + |b|^2}{|a|^2} = 1$$\n$$c_1^2 = \\frac{|a|^2}{|a|^2 + |b|^2}$$\n问题陈述 $c_1 \\in \\mathbb{R}_{\\ge 0}$，所以我们取正平方根：\n$$c_1 = \\frac{|a|}{\\sqrt{|a|^2 + |b|^2}}$$\n如果 $a=0$，那么从 $-s_1 a + c_1 b = 0$ 我们得到 $c_1 b = 0$。由于 $H$ 是不可约的，$b=h_{21}\\neq 0$，所以我们必须有 $c_1=0$。该公式在这种情况下也成立。\n\n将 $a = x^{(1)}_1$ 和 $b = x^{(1)}_2$ 代入，得到 $c_1$ 的最终表达式。\n$$c_1 = \\frac{|x^{(1)}_1|}{\\sqrt{|x^{(1)}_1|^2 + |x^{(1)}_2|^2}}$$", "answer": "$$\\boxed{\\frac{|x^{(1)}_1|}{\\sqrt{|x^{(1)}_1|^2 + |x^{(1)}_2|^2}}}$$", "id": "3589432"}]}