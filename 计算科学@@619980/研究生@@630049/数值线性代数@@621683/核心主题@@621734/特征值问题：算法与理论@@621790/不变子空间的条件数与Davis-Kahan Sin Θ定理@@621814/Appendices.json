{"hands_on_practices": [{"introduction": "理论学习的最佳方式之一是从一个可以手动求解的具体例子开始。这项练习将引导你分析一个简单的 $2 \\times 2$ 厄米特矩阵系统，这是理解不变量子空间摄动理论的理想起点。通过精确计算子空间之间的主交角并将其与 Davis-Kahan 定理的预测进行比较，你将亲手验证该定理的核心思想，并理解其界限在何种意义上是“紧”的 [@problem_id:3540476]。", "problem": "设 $A=\\mathrm{diag}(\\alpha,\\beta)\\in\\mathbb{C}^{2\\times 2}$ 是一个埃尔米特矩阵，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 且 $\\alpha>\\beta$，并设 $E=\\epsilon\\begin{bmatrix}0 & 1 \\\\ 1 & 0\\end{bmatrix}$，其中 $\\epsilon\\in\\mathbb{R}$。考虑扰动后的埃尔米特矩阵 $A+E=\\begin{bmatrix}\\alpha & \\epsilon \\\\ \\epsilon & \\beta\\end{bmatrix}$。定义 $A$ 的一维不变子空间为 $\\mathcal{U}=\\mathrm{span}\\{u\\}$，其中 $u=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$（对应于特征值 $\\alpha$ 的特征向量），并设 $\\mathcal{V}=\\mathrm{span}\\{v\\}$ 是 $A+E$ 的一维不变子空间，与它的较大特征值相关联，其中 $v$ 是一个单位特征向量。设 $\\theta\\in[0,\\pi/2]$ 表示 $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主夹角（以弧度为单位），使得 $\\sin\\theta=\\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$，其中 $P_{\\mathcal{U}^{\\perp}}$ 是到 $\\mathcal{U}$ 的正交补空间上的正交投影算子。\n\n从埃尔米特矩阵的特征值/特征向量、子空间的主夹角以及矩阵的谱范数（最大奇异值）的基本定义出发，执行以下操作：\n\n- 计算 $\\sin\\theta$ 关于 $\\alpha$、$\\beta$ 和 $\\epsilon$ 的精确闭式表达式。\n- 使用第一性原理，推导此实例的不等式 $\\sin\\theta\\le \\|E\\|_{2}/|\\alpha-\\beta|$，并通过分析极限比值 $\\displaystyle\\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{\\|E\\|_{2}/|\\alpha-\\beta|}$ 来解释为什么这个例子是近乎紧致的。\n\n将您的最终答案表示为 $\\sin\\theta$ 关于 $\\alpha$、$\\beta$ 和 $\\epsilon$ 的单一闭式解析表达式。无需四舍五入，不涉及物理单位。角度应以弧度解释。", "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n-   埃尔米特矩阵 $A=\\mathrm{diag}(\\alpha,\\beta)\\in\\mathbb{C}^{2\\times 2}$，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 且 $\\alpha>\\beta$。\n-   扰动矩阵 $E=\\epsilon\\begin{bmatrix}0 & 1\\\\1 & 0\\end{bmatrix}$，其中 $\\epsilon\\in\\mathbb{R}$。\n-   扰动后的埃尔米特矩阵 $A+E=\\begin{bmatrix}\\alpha & \\epsilon\\\\\\epsilon & \\beta\\end{bmatrix}$。\n-   $A$ 的一维不变子空间 $\\mathcal{U}=\\mathrm{span}\\{u\\}$，其中 $u=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ 是对应于特征值 $\\alpha$ 的特征向量。\n-   $A+E$ 的一维不变子空间 $\\mathcal{V}=\\mathrm{span}\\{v\\}$，其中 $v$ 是与 $A+E$ 的较大特征值相关联的单位特征向量。\n-   $\\mathcal{U}$ 和 $\\mathcal{V}$ 之间的主夹角 $\\theta\\in[0,\\pi/2]$。\n-   主夹角的定义：$\\sin\\theta=\\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$，其中 $P_{\\mathcal{U}^{\\perp}}$ 是到 $\\mathcal{U}^{\\perp}$ 上的正交投影算子。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是数值线性代数中的一个标准练习，特别是矩阵扰动理论。矩阵和概念（埃尔米特矩阵、特征值、特征向量、不变子空间、主夹角、谱范数）在该领域中都得到了很好的定义并且是基础性的。所有前提在事实上都是正确的。\n-   **适定性：** 问题陈述清晰，包含了求解 $\\sin\\theta$ 唯一解所需的所有必要信息。谱定理保证了埃尔米特矩阵的特征值和特征向量的存在性。\n-   **客观性：** 语言精确且数学化，没有任何主观或基于观点的陈述。\n-   该问题是自洽且内部一致的。所提供的定义与标准数学文献一致。任务是具体且可形式化的。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整的解决方案。\n\n**第 1 部分：计算 $\\sin\\theta$**\n\n首先，我们求出扰动矩阵 $A+E$ 的特征值和相关特征向量。特征方程为 $\\det(A+E - \\lambda I) = 0$。\n$$\n\\det\\left(\\begin{bmatrix} \\alpha-\\lambda & \\epsilon \\\\ \\epsilon & \\beta-\\lambda \\end{bmatrix}\\right) = (\\alpha-\\lambda)(\\beta-\\lambda) - \\epsilon^2 = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程：$\\lambda^2 - (\\alpha+\\beta)\\lambda + \\alpha\\beta - \\epsilon^2 = 0$。\n$\\lambda$ 的解由二次公式给出：\n$$\n\\lambda = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha+\\beta)^2 - 4(\\alpha\\beta - \\epsilon^2)}}{2} = \\frac{(\\alpha+\\beta) \\pm \\sqrt{\\alpha^2+2\\alpha\\beta+\\beta^2 - 4\\alpha\\beta + 4\\epsilon^2}}{2}\n$$\n$$\n\\lambda = \\frac{(\\alpha+\\beta) \\pm \\sqrt{(\\alpha-\\beta)^2 + 4\\epsilon^2}}{2}\n$$\n问题指明 $\\mathcal{V}$ 与较大的特征值相关联，我们将其表示为 $\\lambda_{+}$。\n$$\n\\lambda_{+} = \\frac{\\alpha+\\beta}{2} + \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2 + 4\\epsilon^2}\n$$\n接下来，我们求对应于 $\\lambda_{+}$ 的特征向量 $v$。设 $v = \\begin{bmatrix}v_1 \\\\ v_2\\end{bmatrix}$。特征向量方程为 $(A+E)v = \\lambda_{+}v$，这给出了方程组：\n$$\n(\\alpha-\\lambda_{+})v_1 + \\epsilon v_2 = 0\n$$\n$$\n\\epsilon v_1 + (\\beta-\\lambda_{+})v_2 = 0\n$$\n这两个方程是线性相关的。从第一个方程，假设 $\\epsilon \\neq 0$，我们有 $v_2 = -\\frac{\\alpha-\\lambda_{+}}{\\epsilon}v_1$。因此，特征向量与 $\\begin{bmatrix} 1 \\\\ -(\\alpha-\\lambda_{+})/\\epsilon \\end{bmatrix}$ 成比例。我们定义 $c = -\\frac{\\alpha-\\lambda_{+}}{\\epsilon}$。\n$$\n\\alpha - \\lambda_{+} = \\alpha - \\left(\\frac{\\alpha+\\beta}{2} + \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\\right) = \\frac{\\alpha-\\beta}{2} - \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\n$$\n所以，$c = -\\frac{1}{\\epsilon}\\left(\\frac{\\alpha-\\beta}{2} - \\frac{1}{2}\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}\\right) = \\frac{-(\\alpha-\\beta) + \\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}{2\\epsilon}$。\n单位特征向量 $v$ 是：\n$$\nv = \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 1 \\\\ c \\end{bmatrix}\n$$\n不变子空间 $\\mathcal{U}$ 是由 $u = \\begin{bmatrix}1\\\\0\\end{bmatrix}$ 张成的。正交补空间 $\\mathcal{U}^{\\perp}$ 是由 $u^{\\perp} = \\begin{bmatrix}0\\\\1\\end{bmatrix}$ 张成的。到 $\\mathcal{U}^{\\perp}$ 上的正交投影算子是 $P_{\\mathcal{U}^{\\perp}} = u^{\\perp}(u^{\\perp})^T = \\begin{bmatrix}0 & 0 \\\\ 0 & 1\\end{bmatrix}$。\n$\\sin\\theta$ 的定义是 $\\sin\\theta = \\|P_{\\mathcal{U}^{\\perp}} v\\|_{2}$。\n$$\nP_{\\mathcal{U}^{\\perp}} v = \\begin{bmatrix}0 & 0 \\\\ 0 & 1\\end{bmatrix} \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 1 \\\\ c \\end{bmatrix} = \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 0 \\\\ c \\end{bmatrix}\n$$\n$$\n\\sin\\theta = \\left\\| \\frac{1}{\\sqrt{1+c^2}} \\begin{bmatrix} 0 \\\\ c \\end{bmatrix} \\right\\|_{2} = \\frac{|c|}{\\sqrt{1+c^2}}\n$$\n这可以通过三角换元来简化。设 $\\delta = \\alpha-\\beta > 0$。则 $c = \\frac{-\\delta + \\sqrt{\\delta^2+4\\epsilon^2}}{2\\epsilon}$。\n设 $\\phi \\in [0, \\pi/2)$ 是一个角，使得 $\\tan\\phi = \\frac{2|\\epsilon|}{\\delta}$。\n则 $\\sqrt{\\delta^2+4\\epsilon^2} = \\sqrt{\\delta^2(1 + 4\\epsilon^2/\\delta^2)} = \\delta\\sqrt{1+\\tan^2\\phi} = \\delta\\sec\\phi$。\n将此代入 $c$ 的表达式：\n$$\nc = \\frac{-\\delta + \\delta\\sec\\phi}{2\\epsilon}\n$$\n若 $\\epsilon > 0$，则 $\\frac{\\delta}{2\\epsilon} = \\frac{1}{\\tan\\phi} = \\cot\\phi$。\n$c = \\cot\\phi(\\sec\\phi - 1) = \\frac{\\cos\\phi}{\\sin\\phi}\\left(\\frac{1}{\\cos\\phi}-1\\right) = \\frac{1-\\cos\\phi}{\\sin\\phi} = \\tan(\\phi/2)$。\n若 $\\epsilon < 0$，则 $\\frac{\\delta}{2\\epsilon} = -\\cot\\phi$，所以 $c = -\\tan(\\phi/2)$。\n在两种情况下，都有 $|c| = \\tan(\\phi/2)$。由于 $\\theta\\in[0,\\pi/2]$ 且 $\\phi/2\\in[0,\\pi/4)$，$\\sin\\theta$ 和 $\\tan(\\phi/2)$ 都是非负的。\n$$\n\\sin\\theta = \\frac{\\tan(\\phi/2)}{\\sqrt{1+\\tan^2(\\phi/2)}} = \\frac{\\tan(\\phi/2)}{\\sec(\\phi/2)} = \\sin(\\phi/2)\n$$\n我们可以使用半角恒等式 $\\sin^2(\\phi/2) = \\frac{1-\\cos\\phi}{2}$ 将 $\\sin(\\phi/2)$ 用 $\\alpha, \\beta, \\epsilon$ 表示。\n从 $\\tan\\phi = \\frac{2|\\epsilon|}{\\alpha-\\beta}$，我们得到 $\\cos\\phi = \\frac{1}{\\sqrt{1+\\tan^2\\phi}} = \\frac{1}{\\sqrt{1 + \\frac{4\\epsilon^2}{(\\alpha-\\beta)^2}}} = \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}$。\n因此，\n$$\n\\sin^2\\theta = \\sin^2(\\phi/2) = \\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)\n$$\n由于 $\\theta \\in [0, \\pi/2]$，$\\sin\\theta \\ge 0$。取平方根得到 $\\sin\\theta$ 的最终表达式：\n$$\n\\sin\\theta = \\sqrt{\\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)}\n$$\n\n**第 2 部分：不等式及其紧致性**\n\n这部分涉及不等式 $\\sin\\theta \\le \\frac{\\|E\\|_{2}}{|\\alpha-\\beta|}$。\n首先，我们计算谱范数 $\\|E\\|_2$。$\\|E\\|_2$ 是 $E$ 的最大奇异值，即 $\\sqrt{\\lambda_{\\max}(E^TE)}$。\n$E = \\epsilon\\begin{bmatrix}0 & 1\\\\1 & 0\\end{bmatrix}$，所以 $E^T = E$。\n$E^TE = E^2 = \\epsilon^2\\begin{bmatrix}0 & 1\\\\1 & 0\\end{bmatrix}\\begin{bmatrix}0 & 1\\\\1 & 0\\end{bmatrix} = \\epsilon^2\\begin{bmatrix}1 & 0\\\\0 & 1\\end{bmatrix} = \\epsilon^2I$。\n$E^2$ 的特征值均为 $\\epsilon^2$。最大特征值为 $\\lambda_{\\max}(E^2) = \\epsilon^2$。\n所以，$\\|E\\|_2 = \\sqrt{\\epsilon^2} = |\\epsilon|$。\n不等式为 $\\sin\\theta \\le \\frac{|\\epsilon|}{\\alpha-\\beta}$（因为 $\\alpha>\\beta$，所以 $|\\alpha-\\beta|=\\alpha-\\beta$）。\n设 $x = \\frac{|\\epsilon|}{\\alpha-\\beta}$。不等式变为 $\\sin\\theta \\le x$。\n在第 1 部分，我们得到 $\\sin\\theta = \\sin(\\phi/2)$，其中 $\\tan\\phi = \\frac{2|\\epsilon|}{\\alpha-\\beta} = 2x$。\n我们需要证明 $\\sin(\\phi/2) \\le x$。\n设 $t = \\tan(\\phi/2)$。根据正切的倍角恒等式 $\\tan\\phi = \\frac{2\\tan(\\phi/2)}{1-\\tan^2(\\phi/2)}$，我们有 $2x = \\frac{2t}{1-t^2}$，所以 $x = \\frac{t}{1-t^2}$。\n正弦函数可以用半角的正切表示为 $\\sin(\\phi/2) = \\frac{t}{\\sqrt{1+t^2}}$。\n我们希望证明的不等式是 $\\frac{t}{\\sqrt{1+t^2}} \\le \\frac{t}{1-t^2}$。\n由于 $\\phi \\in [0, \\pi/2)$，我们有 $t = \\tan(\\phi/2) \\in [0, 1)$。因此，$t \\ge 0$ 且 $1-t^2 > 0$。\n若 $t=0$（即 $\\epsilon=0$），不等式为 $0 \\le 0$，成立。\n若 $t > 0$，我们可以两边同除以 $t$ 得到 $\\frac{1}{\\sqrt{1+t^2}} \\le \\frac{1}{1-t^2}$，这等价于 $1-t^2 \\le \\sqrt{1+t^2}$。\n由于对于 $t \\in (0,1)$，两边都为正，我们可以平方两边：\n$(1-t^2)^2 \\le 1+t^2$\n$1 - 2t^2 + t^4 \\le 1+t^2$\n$t^4 - 3t^2 \\le 0$\n$t^2(t^2 - 3) \\le 0$。\n由于 $t^2 \\ge 0$，此不等式成立当且仅当 $t^2 - 3 \\le 0$，即 $t^2 \\le 3$。\n由于 $t = \\tan(\\phi/2)$ 且 $\\phi/2 \\in [0, \\pi/4)$，我们有 $t < 1$，所以 $t^2 < 1$。因此条件 $t^2 \\le 3$ 总是满足的。这证实了该不等式。\n\n为分析其紧致性，我们评估以下极限：\n$$\n\\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{\\|E\\|_{2}/|\\alpha-\\beta|} = \\lim_{\\epsilon\\to 0}\\frac{\\sin\\theta}{|\\epsilon|/(\\alpha-\\beta)}\n$$\n使用上面的记号，这就是 $\\lim_{x\\to 0} \\frac{\\sin(\\phi/2)}{x}$。\n当 $\\epsilon \\to 0$ 时，$x \\to 0$，这意味着 $\\phi \\to 0$ 且 $t=\\tan(\\phi/2) \\to 0$。\n比值为 $\\frac{\\sin(\\phi/2)}{x} = \\frac{t/\\sqrt{1+t^2}}{t/(1-t^2)} = \\frac{1-t^2}{\\sqrt{1+t^2}}$。\n$$\n\\lim_{t\\to 0} \\frac{1-t^2}{\\sqrt{1+t^2}} = \\frac{1-0}{\\sqrt{1+0}} = 1\n$$\n由于比值的极限为 1，该不等式是渐近紧致的。对于小的 $\\epsilon$，$\\sin\\theta$ 可以很好地由 $\\|E\\|_{2}/|\\alpha-\\beta|$ 近似。这个例子表明 Davis-Kahan $\\sin\\theta$ 定理提供的界可以是锐的。", "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{2}\\left(1 - \\frac{\\alpha-\\beta}{\\sqrt{(\\alpha-\\beta)^2+4\\epsilon^2}}\\right)}}\n$$", "id": "3540476"}, {"introduction": "在通过一个具体例子建立了直观理解后，我们现在转向更一般性的理论分析。这项练习要求你思考 Davis-Kahan 界限达到渐近尖锐的条件，即在何种情况下，子空间的转动幅度最大化。通过分析摄动矩阵的结构及其与谱隙的相互作用，你将深入理解不变量子空间条件数的本质，并学会判断哪些类型的摄动最值得关注 [@problem_id:3540444]。", "problem": "设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个 Hermitian 矩阵。假设 $A$ 的谱被划分为两个集合 $\\Lambda_{1}$ 和 $\\Lambda_{2}$，对应于一个正交分解 $\\mathbb{C}^{n} = \\mathcal{U} \\oplus \\mathcal{U}^{\\perp}$，其中 $\\mathcal{U}$ 是与 $\\Lambda_{1}$ 相关联的 $A$ 的不变子空间，而 $\\mathcal{U}^{\\perp}$ 与 $\\Lambda_{2}$ 相关联。设 $P$ 是到 $\\mathcal{U}$ 上的正交投影算子。定义这两个集合之间的谱隙为 $g := \\inf\\{ |\\mu - \\lambda| : \\lambda \\in \\Lambda_{1}, \\mu \\in \\Lambda_{2} \\} > 0$。考虑一个 Hermitian 扰动 $E$，使得 $A + E$ 有一个与 $\\mathcal{U}$ 维数相同的不变子空间 $\\widehat{\\mathcal{U}}$，并设 $\\widehat{P}$ 是到 $\\widehat{\\mathcal{U}}$ 上的正交投影算子。通过 $(I - P)\\widehat{P}$ 的奇异值定义 $\\mathcal{U}$ 和 $\\widehat{\\mathcal{U}}$ 之间主角的正弦，并记作 $\\|\\sin\\Theta\\| := \\|(I - P)\\widehat{P}\\|_{2}$。\n\n一个被称为 Davis-Kahan sin $\\theta$ 不等式的界表明，在适当的分离假设下，不变子空间的旋转由扰动大小与谱隙之比控制。在本题中，如果对于一个谱隙为 $g$ 的族 $(A_{t}, E_{t})$，当 $\\|E_{t}\\| \\to 0$ 时，比率 $\\|\\sin\\Theta(A_{t}, E_{t})\\| \\, g / \\|E_{t}\\| \\to 1$，则称该界是渐近紧的。\n\n从上述基本概念（Hermitian谱分解、不变子空间的正交投影算子、主角、谱隙）出发，通过约化到一个使 $A$ 相对于 $\\mathcal{U}$ 和 $\\mathcal{U}^{\\perp}$ 呈块对角形式的基，来分析小的 Hermitian 扰动，并将扰动后的不变子空间建模为一个线性映射 $X : \\mathcal{U} \\to \\mathcal{U}^{\\perp}$ 的图像，该映射由一个涉及谱隙的 Sylvester 算子确定其主阶项。利用此方法推断一阶子空间旋转，并找出使 Davis-Kahan 界为渐近紧的族。\n\n下列哪个族 $(A_{t}, E_{t})$ 在上述意义下产生渐近紧的行为？选择所有适用的选项。\n\nA. 对于每个 $g > 0$，设 $A_{t} = \\begin{bmatrix} 0  0 \\\\ 0  g \\end{bmatrix}$ 及 $E_{t} = t \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$，其中 $t \\to 0$。考虑 $\\mathcal{U} = \\operatorname{span}\\{e_{1}\\}$，即 $A_{t}$ 较小特征值的不变子空间，以及 $\\widehat{\\mathcal{U}}$ 为 $A_{t} + E_{t}$ 的相应不变子空间。\n\nB. 固定整数 $k, m \\geq 1$，选择 $\\lambda \\in \\mathbb{R}$ 和 $g > 0$，并设 $A = \\operatorname{diag}(\\lambda I_{k}, (\\lambda + g) I_{m})$。设 $E = \\begin{bmatrix} 0  T \\\\ T^{*}  0 \\end{bmatrix}$，其中 $T \\in \\mathbb{C}^{m \\times k}$ 的谱范数为 $\\|T\\| = t \\to 0$，并且是秩为1的矩阵，其奇异向量与坐标轴对齐。取 $\\mathcal{U}$ 为 $\\lambda$-特征空间，$\\widehat{\\mathcal{U}}$ 为 $A + E$ 的相应不变子空间。\n\nC. 设 $A$ 为对角矩阵，其特征值如上所述分为由 $g > 0$ 分隔的两个簇，并取 $E$ 为对角矩阵（因此 $E$ 与 $A$ 可交换），且 $\\|E\\| \\to 0$。取 $\\mathcal{U}$ 为第一个簇的不变子空间。\n\nD. 对于每个 $g > 0$，设 $A_{t} = \\begin{bmatrix} 0  0 \\\\ 0  g \\end{bmatrix}$ 及 $E_{t} = t \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix}$，其中 $t \\to 0$。考虑 $\\mathcal{U} = \\operatorname{span}\\{e_{1}\\}$ 和 $\\widehat{\\mathcal{U}}$ 如选项 A 中所述。\n\nE. 设 $A = \\operatorname{diag}(\\Lambda_{1}, \\Lambda_{2})$，其中 $\\Lambda_{1} = \\operatorname{diag}(\\lambda_{1}, \\dots, \\lambda_{k})$ 和 $\\Lambda_{2} = \\operatorname{diag}(\\mu_{1}, \\dots, \\mu_{m})$ 是实对角块。设 $g = \\min_{i, j} |\\mu_{j} - \\lambda_{i}| > 0$。选择 $E = \\begin{bmatrix} 0  T \\\\ T^{*}  0 \\end{bmatrix}$，其中 $T = t \\, u v^{*}$，$t \\to 0$，$u$ 和 $v$是单位坐标向量，与达到最小间距 $|\\mu_{j^{*}} - \\lambda_{i^{*}}| = g$ 的配对 $(i^{*}, j^{*})$ 对齐。取 $\\mathcal{U}$ 为 $\\Lambda_{1}$ 的不变子空间，$\\widehat{\\mathcal{U}}$ 为 $A + E$ 的相应不变子空间。\n\n通过选择正确的选项来回答。", "solution": "我们首先为不变子空间的小 Hermitian 扰动问题做好准备。设 $A$ 是一个具有不变子空间 $\\mathcal{U}$（维数为 $k$）及其正交补 $\\mathcal{U}^{\\perp}$（维数为 $m = n - k$）的 Hermitian 矩阵，其对应的投影算子为 $P$ 和 $I-P$。在一个适应于此分解的标准正交基中，我们写作\n$$\nA = \\begin{bmatrix} A_{11}  0 \\\\ 0  A_{22} \\end{bmatrix}, \\quad E = \\begin{bmatrix} E_{11}  E_{12} \\\\ E_{21}  E_{22} \\end{bmatrix},\n$$\n其中 $A_{11} \\in \\mathbb{R}^{k \\times k}$，$A_{22} \\in \\mathbb{R}^{m \\times m}$ 是 Hermitian 矩阵，并且 $E$ 是 Hermitian 矩阵，因此 $E_{21} = E_{12}^{*}$。$\\Lambda_{1} = \\sigma(A_{11})$ 和 $\\Lambda_{2} = \\sigma(A_{22})$ 之间的谱隙为 $g := \\inf\\{|\\mu - \\lambda| : \\lambda \\in \\Lambda_{1}, \\mu \\in \\Lambda_{2}\\} > 0$。\n\n对于小的 $\\|E\\|$，$A+E$ 的不变子空间 $\\widehat{\\mathcal{U}}$ 可以表示为一个线性映射 $X : \\mathcal{U} \\to \\mathcal{U}^{\\perp}$ 的图像：矩阵 $\\begin{bmatrix} I \\\\ X \\end{bmatrix}$ 的列向量张成 $\\widehat{\\mathcal{U}}$。子空间扰动理论表明 $X$ 满足一个矩阵 Riccati 方程\n$$\nA_{22} X - X A_{11} + E_{22} X - X E_{11} + E_{21} - X E_{12} X = 0.\n$$\n在 $\\|E\\|$ 的主阶上，我们忽略涉及 $X$ 和 $E$ 乘积的高阶项，得到 Sylvester 方程\n$$\nA_{22} X - X A_{11} = - E_{21}.\n$$\n在谱分离假设 $g > 0$ 下，Sylvester 算子是可逆的，并得出界\n$$\n\\|X\\| \\leq \\frac{\\|E_{21}\\|}{g}.\n$$\n此外，$\\mathcal{U}$ 和该图像子空间之间主角的正弦最大值，在主阶上等于 $X$ 的算子范数。更精确地，写出到该图像子空间上的正交投影算子，我们得到\n$$\n\\widehat{P} = \\begin{bmatrix} (I + X^{*} X)^{-1}  & (I + X^{*} X)^{-1} X^{*} \\\\ X (I + X^{*} X)^{-1}  & X (I + X^{*} X)^{-1} X^{*} \\end{bmatrix},\n$$\n所以\n$$\n(I - P) \\widehat{P} = \\begin{bmatrix} 0  & 0 \\\\ X (I + X^{*} X)^{-1}  & X (I + X^{*} X)^{-1} X^{*} \\end{bmatrix}.\n$$\n因此\n$$\n\\|(I - P) \\widehat{P}\\| = \\|X (I + X^{*} X)^{-1/2}\\| = \\|X\\| + \\mathcal{O}(\\|X\\|^{3}).\n$$\n结合这些关系，我们得出结论，对于小的 $\\|E\\|$\n$$\n\\|\\sin\\Theta\\| = \\|(I - P)\\widehat{P}\\| = \\frac{\\|E_{21}\\|}{g} + \\text{高阶项}.\n$$\n这就建立了渐近紧性发生的机制：当扰动完全位于谱划分的非对角块上，并且 Sylvester 算子在主导方向上的作用相当于乘以标量 $g$ 时，主阶项 $\\|X\\| = \\|E_{21}\\|/g$ 就被达到了，因此当 $\\|E\\| \\to 0$ 时，$\\|\\sin\\Theta\\| g / \\|E\\| \\to 1$。我们现在分析每个选项。\n\n选项 A：这里\n$$\nA_{t} = \\begin{bmatrix} 0  & 0 \\\\ 0  & g \\end{bmatrix}, \\quad E_{t} = t \\begin{bmatrix} 0  & 1 \\\\ 1  & 0 \\end{bmatrix}, \\quad t \\to 0.\n$$\n我们考虑 $\\mathcal{U} = \\operatorname{span}\\{ e_{1} \\}$。扰动后的矩阵是\n$$\nA_{t} + E_{t} = \\begin{bmatrix} 0  & t \\\\ t  & g \\end{bmatrix}.\n$$\n特征值为 $\\lambda_{\\pm}(t) = \\frac{g \\pm \\sqrt{g^{2} + 4 t^{2}}}{2}$；对应于 $\\lambda_{-}(t)$ 的特征向量与 $\\begin{bmatrix} t / \\lambda_{-}(t) \\\\ 1 \\end{bmatrix}$ 成比例。$\\operatorname{span}\\{e_{1}\\}$ 与该特征向量之间的夹角 $\\theta(t)$ 满足\n$$\n\\tan \\theta(t) = \\frac{|1|}{|t / \\lambda_{-}(t)|} = \\frac{|\\lambda_{-}(t)|}{|t|}.\n$$\n对小 $t$ 进行展开，\n$$\n\\sqrt{g^{2} + 4 t^{2}} = g \\left( 1 + \\frac{2 t^{2}}{g^{2}} + \\mathcal{O}\\left(\\frac{t^{4}}{g^{4}}\\right) \\right), \\quad \\lambda_{-}(t) = \\frac{g - \\sqrt{g^{2} + 4 t^{2}}}{2} = - \\frac{t^{2}}{g} + \\mathcal{O}\\left(\\frac{t^{4}}{g^{3}}\\right).\n$$\n因此\n$$\n\\tan \\theta(t) = \\frac{t}{g} + \\mathcal{O}\\left(\\frac{t^{3}}{g^{3}}\\right), \\quad \\sin \\theta(t) = \\frac{t}{g} + \\mathcal{O}\\left(\\frac{t^{3}}{g^{3}}\\right).\n$$\n由于 $\\|E_{t}\\|_{2} = |t|$，我们得到\n$$\n\\frac{\\|\\sin\\Theta\\| \\, g}{\\|E_{t}\\|} = \\frac{(\\sin \\theta(t)) g}{|t|} = 1 + \\mathcal{O}\\left(\\frac{t^{2}}{g^{2}}\\right) \\to 1 \\quad \\text{as } t \\to 0.\n$$\n因此选项 A 表现出渐近紧的行为。结论：正确。\n\n选项 B：这里 $A = \\operatorname{diag}(\\lambda I_{k}, (\\lambda + g) I_{m})$ 且 $E = \\begin{bmatrix} 0  & T \\\\ T^{*}  & 0 \\end{bmatrix}$，其中 $\\|T\\| = t \\to 0$ 且 $T$ 是与坐标轴对齐的秩为1的矩阵。在分块基中，主阶图像映射 $X$ 的 Sylvester 方程为\n$$\n(\\lambda + g) I_{m} \\, X - X \\, \\lambda I_{k} = - T^{*} \\quad \\Rightarrow \\quad g X = - T^{*} \\quad \\Rightarrow \\quad X = - \\frac{1}{g} T^{*}.\n$$\n因此 $\\|X\\| = \\|T\\| / g = t / g$。如上所述，\n$$\n\\|\\sin\\Theta\\| = \\|X (I + X^{*} X)^{-1/2}\\| = \\frac{t}{g} + \\mathcal{O}\\left(\\frac{t^{3}}{g^{3}}\\right).\n$$\n高阶项源于 Riccati 校正项 $- X E_{12} X = - X T X$，其量级为 $\\mathcal{O}(t^{3}/g^{2})$，因为 $X = \\mathcal{O}(t/g)$ 且 $T$ 是 $\\mathcal{O}(t)$。由于 $\\|E\\| = \\|T\\| = t$，我们得出结论\n$$\n\\frac{\\|\\sin\\Theta\\| \\, g}{\\|E\\|} = 1 + \\mathcal{O}\\left(\\frac{t^{2}}{g^{2}}\\right) \\to 1 \\quad \\text{as } t \\to 0.\n$$\n因此选项 B 是渐近紧的。结论：正确。\n\n选项 C：这里 $A$ 是对角矩阵，其特征值由 $g>0$ 分隔为两个簇，并且 $E$ 是对角矩阵，其范数 $\\|E\\| \\to 0$，因此 $E$ 与 $A$ 可交换。在分块基中，\n$$\nE = \\begin{bmatrix} E_{11}  & 0 \\\\ 0  & E_{22} \\end{bmatrix}, \\quad E_{21} = 0.\n$$\nSylvester 方程简化为 $A_{22} X - X A_{11} = - E_{21} = 0$，所以主阶项 $X=0$。事实上，因为 $E$ 是块对角矩阵，它不耦合 $\\mathcal{U}$ 和 $\\mathcal{U}^{\\perp}$，并且 $A$ 的不变子空间 $\\mathcal{U}$ 仍然是 $A+E$ 的不变子空间；因此 $\\widehat{\\mathcal{U}} = \\mathcal{U}$ 并且\n$$\n\\|\\sin\\Theta\\| = 0 \\quad \\Rightarrow \\quad \\frac{\\|\\sin\\Theta\\| \\, g}{\\|E\\|} = 0.\n$$\n这个比率不会趋近于 1，除非 $\\|E\\| \\to 0$ 平凡地得到 0。因此选项 C 不是渐近紧的。结论：不正确。\n\n选项 D：对于 $A_{t} = \\begin{bmatrix} 0  & 0 \\\\ 0  & g \\end{bmatrix}$ 和 $E_{t} = t \\begin{bmatrix} 1  & 0 \\\\ 0  & -1 \\end{bmatrix}$，我们再次得到 $E_{21}=0$。扰动改变了特征值，但保持特征向量 $e_{1}, e_{2}$ 不变，所以 $\\widehat{\\mathcal{U}} = \\mathcal{U}$ 并且 $\\|\\sin\\Theta\\| = 0$。因此，\n$$\n\\frac{\\|\\sin\\Theta\\| \\, g}{\\|E_{t}\\|} = 0,\n$$\n并且这个族不是渐近紧的。结论：不正确。\n\n选项 E：这里 $A = \\operatorname{diag}(\\Lambda_{1}, \\Lambda_{2})$，其中 $\\Lambda_{1} = \\operatorname{diag}(\\lambda_{1}, \\dots, \\lambda_{k})$ 和 $\\Lambda_{2} = \\operatorname{diag}(\\mu_{1}, \\dots, \\mu_{m})$，并且 $g = \\min_{i, j} |\\mu_{j} - \\lambda_{i}| > 0$。扰动为 $E = \\begin{bmatrix} 0  & T \\\\ T^{*}  & 0 \\end{bmatrix}$，其中 $T = t \\, u v^{*}$，$u = e_{j^{*}} \\in \\mathbb{C}^{m}$，$v = e_{i^{*}} \\in \\mathbb{C}^{k}$ 与达到最小间距 $|\\mu_{j^{*}} - \\lambda_{i^{*}}| = g$ 的配对 $(i^{*}, j^{*})$ 对齐。Sylvester 方程\n$$\n\\Lambda_{2} X - X \\Lambda_{1} = - T^{*}\n$$\n按元素解耦：\n$$\n(\\mu_{j} - \\lambda_{i}) X_{j i} = - \\overline{T_{i j}}.\n$$\n由于 $T = t \\, u v^{*}$ 仅在 $(i^{*}, j^{*})$ 位置有非零元，我们得到\n$$\nX_{j i} = 0 \\quad \\text{对于 } (j, i) \\neq (j^{*}, i^{*}), \\quad X_{j^{*} i^{*}} = - \\frac{t}{\\mu_{j^{*}} - \\lambda_{i^{*}}} = - \\frac{t}{g}.\n$$\n因此 $X$ 是秩为 1 的矩阵，其范数为 $\\|X\\| = |t|/g$。如前所述，\n$$\n\\|\\sin\\Theta\\| = \\|X (I + X^{*} X)^{-1/2}\\| = \\frac{|t|}{g} + \\mathcal{O}\\left(\\frac{|t|^{3}}{g^{3}}\\right),\n$$\n而 $\\|E\\| = \\|T\\| = |t|$。因此\n$$\n\\frac{\\|\\sin\\Theta\\| \\, g}{\\|E\\|} = 1 + \\mathcal{O}\\left(\\frac{t^{2}}{g^{2}}\\right) \\to 1 \\quad \\text{as } t \\to 0,\n$$\n这表明即使当块 $\\Lambda_1, \\Lambda_2$ 不是标量矩阵时，也表现出渐近紧的行为。$u, v$ 与实现最小分离的配对对齐，确保了 Sylvester 算子在扰动模式上的作用是乘以 $g$，从而实现了主阶常数 $1/g$。结论：正确。\n\n总之，选项 A、B 和 E 构造的族中，扰动纯粹位于谱划分的非对角块上，并与最小分离方向对齐，因此 Sylvester 方程的一阶解达到了常数 $1/g$，Davis-Kahan 界是渐近紧的。选项 C 和 D 缺少非对角耦合，因此不会产生不变子空间的旋转。", "answer": "$$\\boxed{ABE}$$", "id": "3540444"}, {"introduction": "理论的价值最终体现在其解决实际问题的能力上。这项计算实践将不变量子空间摄动理论应用于数值分析的一个核心问题：有限精度算术的影响。你将学习如何将计算中的舍入误差建模为矩阵摄动，并使用 Davis-Kahan 定理的洞见来预测其后果，最终为确保计算结果的可靠性而提出一个合理的精度分配策略 [@problem_id:3540430]。", "problem": "您将获得一个用于研究有限精度算术下不变子空间条件作用的框架。核心任务是量化算术精度的降低如何增加埃尔米特矩阵的有效扰动范数 $\\|E\\|_2$，并因此增加由 $\\|\\sin \\Theta\\|_2$ 量化的子空间旋转。您必须实现一个模拟，该模拟使用多个预设的单位舍入水平来建模有限精度效应，计算不变子空间的旋转，并提出一个有原则的精度分配建议，以保持子空间的病态性在可接受范围内。\n\n您的解决方案必须仅从以下基本事实和定义出发，并且不得假设任何超出可从中推导出的范围的特殊快捷公式：\n\n- 一个实对称（埃尔米特）矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 容许一个正交对角化 $A = Q \\Lambda Q^\\top$，其中 $Q^\\top Q = I$ 且 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，$\\lambda_i \\in \\mathbb{R}$。\n- 与特征值子集相关联的不变子空间是相应特征向量的列空间。\n- 到一个具有标准正交基 $U \\in \\mathbb{R}^{n \\times k}$ 的子空间上的正交投影算子是 $P = U U^\\top$。\n- 由 $U, V \\in \\mathbb{R}^{n \\times k}$ 的标准正交列张成的两个子空间之间的主角是通过 $U^\\top V$ 的奇异值定义的；这些角的正弦值量化了子空间的旋转。量 $\\|\\sin \\Theta\\|_2$ 表示主角正弦构成的对角矩阵的谱范数，且等于 $\\sin(\\theta_{\\max})$，其中 $\\theta_{\\max}$ 是以弧度为单位测量的最大主角。\n- 对于一个实对称扰动 $E$，扰动后的矩阵为 $\\widehat{A} = A + E$。谱范数是次乘性的并且是酉不变的。到不相交谱簇上的谱投影算子之差可以用预解积分表示，从而得出一个以 $\\|E\\|_2$ 和一个必须从这些原则推导出的谱分离（间隙）表示的界。\n- 具有单位舍入 $u$ 的有限精度算术会引入相对的逐元素扰动；一个常见的模型是逐元素的对称扰动 $E$，其元素为 $E_{ij} = \\xi_{ij} A_{ij}$，其中 $|\\xi_{ij}| \\le u$，并且当 $A$ 是对称的时，$E$ 也是对称的。\n\n仅使用这些原则，您必须：\n\n1. 按如下方式构建测试矩阵。对于每个测试用例，使用一个固定的种子生成一个随机正交矩阵 $Q \\in \\mathbb{R}^{n \\times n}$，并设置 $A = Q \\Lambda Q^\\top$，其中 $\\Lambda$ 的对角线元素在下面指定。对于每个用例，选择与 $k$ 个最小特征值相关联的特征向量所张成的空间作为目标不变子空间。\n2. 通过构建一个对称相对扰动 $E$ 来建模工作精度效应，其元素为 $E_{ij} = \\xi_{ij} A_{ij}$，其中对于 $i \\le j$，$\\xi_{ij}$ 是在 $[-u,u]$ 上均匀分布的独立随机变量，且 $E_{ji} = E_{ij}$，对于一个预设的单位舍入 $u$。定义 $\\widehat{A} = A + E$。\n3. 分别计算与 $A$ 和 $\\widehat{A}$ 的 $k$ 个最小特征值相关联的不变子空间的标准正交基 $U$ 和 $\\widehat{U}$。\n4. 以弧度为单位计算 $\\mathrm{range}(U)$ 和 $\\mathrm{range}(\\widehat{U})$ 之间的主角，并返回 $\\|\\sin \\Theta\\|_2$ 作为观测到的子空间旋转。\n5. 推导并实现 $\\|\\sin \\Theta\\|_2$ 的一个有效上界 $B$，用 $\\|E\\|_2$ 和一个您必须根据 $A$ 的特征值数据严格定义的谱分离参数来表示。该界必须从允许的基本事实中得到证明（例如，通过对谱投影算子的预解积分进行界定）。您必须确保 $B \\in [0,1]$。\n6. 提出一种精度分配策略：对于 $\\|\\sin \\Theta\\|_2$ 的一个预设容差 $\\tau$，为给定矩阵推荐一个最大允许单位舍入 $u^\\star$，以确保 $\\|\\sin \\Theta\\|_2 \\lesssim \\tau$。通过从您采样的 $E$ 中经验性地估计 $\\|E\\|_2 \\approx c u$ 中的比例常数 $c$ 来校准 $u^\\star$（即，设置 $c := \\|E\\|_2/u$，然后设置 $u^\\star := \\tau \\cdot \\mathrm{gap} / c$，其中谱分离 $\\mathrm{gap}$ 与您在界中使用的间隙相同）。\n\n角度单位要求：所有角度均以弧度为单位测量。最终的量 $\\|\\sin \\Theta\\|_2$、$B$ 和 $u^\\star$ 是无单位的实数。\n\n测试套件。请精确使用以下三个测试用例，每个用例都有其自己的种子以保证可复现性：\n\n- 用例 1：$n = 6$，$\\lambda = [0, 0.1, 0.2, 2.0, 2.5, 3.0]$，$k = 3$，$u = 2^{-24}$，$\\tau = 10^{-2}$，正交生成器种子 $42$，扰动种子 $1001$。\n- 用例 2：$n = 6$，$\\lambda = [0, 0.05, 0.1, 0.3, 0.35, 0.9]$，$k = 3$，$u = 2^{-24}$，$\\tau = 10^{-2}$，正交生成器种子 $43$，扰动种子 $1002$。\n- 用例 3：$n = 6$，$\\lambda = [0, 0.001, 0.002, 0.003, 1.0, 1.5]$，$k = 3$，$u = 2^{-11}$，$\\tau = 10^{-2}$，正交生成器种子 $44$，扰动种子 $1003$。\n\n要求的最终输出格式。您的程序应生成单行输出，包含三个用例的结果列表。每个用例必须贡献一个包含三个浮点数的列表，顺序为 $[\\|\\sin \\Theta\\|_2, B, u^\\star]$。整个输出必须是包含三个列表的单个列表，序列化为无空格的单行，例如：\n[[obs1,bnd1,ustar1],[obs2,bnd2,ustar2],[obs3,bnd3,ustar3]]\n\n您的程序必须是完全自包含的，并且不得接受任何输入。它必须实现上述所有计算，并以精确要求的格式在单行上打印最终输出。", "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个适定的、有科学依据的数值线性代数领域的问题，具体涉及埃尔米特矩阵不变子空间的扰动理论。为获得唯一且可验证的解所需的所有必要数据和条件均已提供。任务是客观且可形式化的。我们开始进行求解。\n\n问题的核心是量化一个对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 在被扰动为 $\\widehat{A} = A + E$ 时其不变子空间的扰动。我们被要求推导子空间旋转（由 $\\|\\sin \\Theta\\|_2$ 衡量）的一个界，并用它来提出一个数值精度要求。\n\n### 1. 理论基础：子空间扰动界的推导\n\n设对称矩阵 $A$ 具有特征分解 $A = Q \\Lambda Q^\\top$，其中 $Q = [q_1, \\dots, q_n]$ 是一个由特征向量构成的正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_n)$ 是由实特征值构成的对角矩阵，按非递减顺序排序：$\\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$。\n\n我们将 $A$ 的谱划分为两个不相交的集合：$\\mathrm{spec}_1 = \\{\\lambda_1, \\dots, \\lambda_k\\}$ 和 $\\mathrm{spec}_2 = \\{\\lambda_{k+1}, \\dots, \\lambda_n\\}$。目标不变子空间 $\\mathcal{U}$ 是与 $\\mathrm{spec}_1$ 相关联的子空间。$\\mathcal{U}$ 的一个标准正交基由前 $k$ 个特征向量给出，$U = [q_1, \\dots, q_k] \\in \\mathbb{R}^{n \\times k}$。其正交补 $\\mathcal{U}^\\perp$ 由 $U_\\perp = [q_{k+1}, \\dots, q_n]$ 张成。\n\n扰动矩阵为 $\\widehat{A} = A + E$，其中 $E$ 是一个对称扰动。对于足够小的扰动，$\\widehat{A}$ 的谱也将有相应的划分。设 $\\widehat{U}$ 是与源自 $\\mathrm{spec}_1$ 的 $k$ 个特征值相关联的 $\\widehat{A}$ 的不变子空间的一个标准正交基。子空间 $\\mathcal{U} = \\mathrm{range}(U)$ 和 $\\widehat{\\mathcal{U}} = \\mathrm{range}(\\widehat{U})$ 之间的角由主角矩阵 $\\Theta$ 量化。需要界定的量是 $\\|\\sin \\Theta\\|_2$，即最大主角的正弦值。\n\n该界的推导，即著名的 Davis-Kahan $\\sin\\Theta$ 定理，可以通过分析 $\\widehat{\\mathcal{U}}$ 的不变性条件得到。$\\widehat{\\mathcal{U}}$ 中的任何向量都可以表示为来自 $\\mathcal{U}$ 和 $\\mathcal{U}^\\perp$ 的基向量的线性组合。因此，基 $\\widehat{U}$ 可以写成 $\\widehat{U} = U X + U_\\perp Y$，其中 $X \\in \\mathbb{R}^{k \\times k}$ 和 $Y \\in \\mathbb{R}^{(n-k) \\times k}$ 是某个矩阵。根据定义，$Y$ 的奇异值是主角的正切值，如果角度很小，则约等于正弦值。一个更直接的关系表明，$U_\\perp^\\top \\widehat{U} = Y$ 的奇异值精确地是主角的正弦值。因此，$\\|\\sin\\Theta\\|_2 = \\|Y\\|_2$。\n\n不变性条件是 $\\widehat{A}\\widehat{U} = \\widehat{U}\\widehat{\\Lambda}_1$，其中 $\\widehat{\\Lambda}_1 \\in \\mathbb{R}^{k \\times k}$ 是一个矩阵，其特征值是对应于 $\\mathrm{spec}_1$ 的扰动后的特征值。代入 $\\widehat{A} = A+E$ 和 $\\widehat{U} = UX + U_\\perp Y$：\n$$ (A+E)(UX + U_\\perp Y) = (UX + U_\\perp Y)\\widehat{\\Lambda}_1 $$\n左乘 $U_\\perp^\\top$ 并利用 $U_\\perp^\\top U = 0$、$U_\\perp^\\top A U = U_\\perp^\\top (U \\Lambda_1 U^\\top) U = 0$ 以及 $U_\\perp^\\top A U_\\perp = \\Lambda_2$（其中 $\\Lambda_1 = \\mathrm{diag}(\\lambda_1,...,\\lambda_k)$，$\\Lambda_2 = \\mathrm{diag}(\\lambda_{k+1},...,\\lambda_n)$）这些事实：\n$$ U_\\perp^\\top E U X + U_\\perp^\\top E U_\\perp Y + \\Lambda_2 Y = Y \\widehat{\\Lambda}_1 $$\n这是一个关于 $Y$ 的 Sylvester 方程：\n$$ \\Lambda_2 Y - Y \\widehat{\\Lambda}_1 = -U_\\perp^\\top E U X - U_\\perp^\\top E U_\\perp Y $$\n对于一阶近似（假设 $\\|E\\|_2$ 很小），子空间的扰动很小，这意味着 $X \\approx I_k$ 且 $\\|Y\\|_2$ 很小。特征值也受到轻微扰动，因此 $\\widehat{\\Lambda}_1 \\approx \\Lambda_1$。方程变为：\n$$ \\Lambda_2 Y - Y \\Lambda_1 \\approx -U_\\perp^\\top E U $$\n如果 $\\Lambda_1$ 和 $\\Lambda_2$ 的谱是不相交的，则算子 $L(Y) = \\Lambda_2 Y - Y \\Lambda_1$ 是可逆的。逆算子的范数是 $\\|L^{-1}\\| = 1 / \\min_{i>k, j\\le k} |\\lambda_i - \\lambda_j|$。我们定义谱分离，或称间隙，为：\n$$ \\mathrm{gap} = \\min_{i>k, j\\le k} |\\lambda_i - \\lambda_j| = \\lambda_{k+1} - \\lambda_k $$\n因为特征值是排序的。对近似的 Sylvester 方程取范数：\n$$ \\|Y\\|_2 \\lesssim \\frac{\\|U_\\perp^\\top E U\\|_2}{\\mathrm{gap}} $$\n由于 $\\|\\sin\\Theta\\|_2 = \\|Y\\|_2$ 且 $\\|U_\\perp^\\top E U\\|_2 \\le \\|U_\\perp^\\top\\|_2 \\|E\\|_2 \\|U\\|_2 = \\|E\\|_2$，我们得到如下界：\n$$ \\|\\sin \\Theta\\|_2 \\le \\frac{\\|E\\|_2}{\\mathrm{gap}} $$\n当扰动与间隙相比很小时，这个界是有效的。对于一般情况，该界不能超过 $1$。因此，我们将我们的可计算界 $B$ 定义为：\n$$ B = \\min\\left(1, \\frac{\\|E\\|_2}{\\mathrm{gap}}\\right) $$\n\n### 2. 计算方法论\n\n对于每个测试用例，该模拟遵循以下步骤序列。\n\n1.  **矩阵构建**：使用带有指定种子的 `scipy.stats.ortho_group.rvs` 生成一个随机正交矩阵 $Q \\in \\mathbb{R}^{n \\times n}$。然后，对于给定的特征值 $\\lambda$，构造对称矩阵 $A$ 为 $A = Q \\Lambda Q^\\top$，其中 $\\Lambda = \\mathrm{diag}(\\lambda)$。\n\n2.  **扰动生成**：创建一个对称扰动矩阵 $E$ 来建模有限精度效应。生成一个随机系数矩阵 $\\Xi \\in \\mathbb{R}^{n \\times n}$，其中对于 $i \\le j$，$\\Xi_{ij}$ 是来自均匀分布 $U[-u, u]$ 的独立样本，并且 $\\Xi_{ji} = \\Xi_{ij}$ 以确保对称性。然后扰动为 $E_{ij} = \\Xi_{ij} A_{ij}$，使用哈达玛积可以写作 $E = \\Xi \\circ A$。\n\n3.  **子空间计算**：\n    *   未扰动不变子空间的标准正交基 $U$ 由 $Q$ 的前 $k$ 列组成。\n    *   扰动矩阵为 $\\widehat{A} = A+E$。使用 `numpy.linalg.eigh` 计算其完全特征分解，该函数适用于对称矩阵并返回排序后的特征值。扰动不变子空间的标准正交基 $\\widehat{U}$ 由得到的特征向量矩阵的前 $k$ 列组成。\n\n4.  **观测到的子空间旋转**：观测到的旋转 $\\|\\sin \\Theta\\|_2$ 直接从基 $U$ 和 $\\widehat{U}$ 计算。根据主角的定义，这些角的余弦值 $\\cos(\\theta_i)$ 是矩阵 $U^\\top \\widehat{U}$ 的奇异值。最大主角 $\\theta_{\\max}$ 对应于最小奇异值 $\\sigma_{\\min}(U^\\top \\widehat{U})$。因此，$\\cos(\\theta_{\\max}) = \\sigma_{\\min}$。所求的量则为：\n    $$ \\|\\sin \\Theta\\|_2 = \\sin(\\theta_{\\max}) = \\sqrt{1 - \\cos^2(\\theta_{\\max})} = \\sqrt{1 - \\sigma_{\\min}^2(U^\\top \\widehat{U})} $$\n\n5.  **界的计算**：计算理论界 $B = \\min(1, \\|E\\|_2 / \\mathrm{gap})$。谱范数 $\\|E\\|_2$ 通过数值方法计算，间隙 $\\mathrm{gap} = \\lambda_{k+1} - \\lambda_k$ 从输入的特征值确定。\n\n6.  **精度推荐**：基于子空间旋转的目标容差 $\\tau$ 来确定推荐的单位舍入 $u^\\star$。我们通过从单个模拟实例中计算 $c = \\|E\\|_2 / u$ 来建立一个经验关系 $\\|E\\|_2 \\approx c u$。为确保界保持在容差以下，即 $\\|\\sin\\Theta\\|_2 \\le \\frac{\\|E\\|_2}{\\mathrm{gap}} = \\frac{c u}{\\mathrm{gap}} \\lesssim \\tau$，我们求解最大允许的 $u$：\n    $$ u^\\star = \\frac{\\tau \\cdot \\mathrm{gap}}{c} $$\n这为在指定容差内保持不变子空间完整性所需的算术精度提供了一个实用估计。", "answer": "[[1.3418461756543152e-09,1.3216145311038178e-07,0.004509748611116674],[4.545199659357488e-08,5.789072105571255e-08,0.010294931818274025],[0.00010901511210986926,0.10874013444408782,4.49033669643197e-05]]", "id": "3540430"}]}