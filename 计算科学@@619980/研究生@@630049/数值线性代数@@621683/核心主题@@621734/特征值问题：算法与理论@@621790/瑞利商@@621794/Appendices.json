{"hands_on_practices": [{"introduction": "对于厄米特矩阵（Hermitian matrix），瑞利商的值总是有界于其最大和最小特征值之间。然而，对于非正规矩阵（non-normal matrix），情况则大不相同。本练习通过一个具体的例子 [@problem_id:3595108]，展示了瑞利商的值（作为数值范围的一部分）可以超出由谱半径定义的复平面区域，从而加深对数值范围（numerical range）这一重要概念的理解。", "problem": "令 $A \\in \\mathbb{C}^{2 \\times 2}$ 为严格上三角矩阵\n$$\nA \\;=\\; \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix},\n$$\n并令 $x \\in \\mathbb{C}^{2}$ 为单位向量\n$$\nx \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n从谱半径 $\\rho(A)$、瑞利商 $R_A(x)$ 和数值范围 $W(A)$ 的核心定义出发：\n- 谱半径为 $\\rho(A) \\equiv \\max\\{\\,|\\lambda| : \\lambda \\text{ 是 } A \\text{ 的一个特征值}\\,\\}$。\n- 瑞利商为 $R_A(x) \\equiv \\dfrac{x^{*} A x}{x^{*} x}$。\n- 数值范围为 $W(A) \\equiv \\{\\,x^{*} A x : x \\in \\mathbb{C}^{2}, \\, \\|x\\|_{2} = 1\\,\\}$。\n\n仅使用这些定义以及特征值和共轭转置的基本性质，完成以下操作：\n1. 通过检验 $A^{*}A \\neq A A^{*}$ 来验证 $A$ 是非正规矩阵。\n2. 通过显式地求出 $A$ 的特征值来确定 $\\rho(A)$。\n3. 计算给定单位向量 $x$ 的瑞利商 $R_A(x)$，并证明 $\\big|R_A(x)\\big| > \\rho(A)$，从而说明对于非正规矩阵，其数值范围可以超出谱半径的范围。\n\n将 $R_A(x)$ 的值报告为精确数。无需四舍五入。你的最终答案必须是一个实数值。", "solution": "题目要求我们对给定的矩阵 $A \\in \\mathbb{C}^{2 \\times 2}$ 和向量 $x \\in \\mathbb{C}^{2}$ 执行三个具体任务。我们将使用所提供的定义依次解决每个任务。\n\n给定的矩阵是\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n给定的向量是\n$$\nx = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n\n首先，我们验证 $x$ 是一个单位向量。$x$ 的 2-范数的平方由 $x^{*}x$ 给出，其中 $x^{*}$ 是 $x$ 的共轭转置。\n对于给定的 $x$，我们有 $x^{*} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\end{pmatrix}$。\n$$\nx^{*}x = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) + \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) = \\frac{1}{2} + \\frac{1}{2} = 1.\n$$\n由于 $\\|x\\|_{2}^{2} = x^{*}x = 1$，所以 $x$ 确实是一个单位向量。\n\n1.  通过检验 $A^{*}A \\neq A A^{*}$ 来验证 $A$ 是非正规矩阵。\n一个矩阵 $A$ 如果与其共轭转置 $A^{*}$ 交换，即 $A^{*}A = AA^{*}$，则称其为正规矩阵。我们首先计算 $A$ 的共轭转置。\n$$\nA^{*} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}^{*} = \\begin{pmatrix} \\overline{0}  \\overline{0} \\\\ \\overline{1}  \\overline{0} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}.\n$$\n现在，我们计算乘积 $A^{*}A$ 和 $AA^{*}$。\n$$\nA^{*}A = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} (0)(0)+(0)(0)  (0)(1)+(0)(0) \\\\ (1)(0)+(0)(0)  (1)(1)+(0)(0) \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n$$\nAA^{*} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} (0)(0)+(1)(1)  (0)(0)+(1)(0) \\\\ (0)(0)+(0)(1)  (0)(0)+(0)(0) \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n比较这两个结果矩阵，我们看到\n$$\n\\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} \\neq \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n因此，$A^{*}A \\neq AA^{*}$，我们已经验证了 $A$ 是一个非正规矩阵。\n\n2.  通过求出 $A$ 的特征值来确定谱半径 $\\rho(A)$。\n$A$ 的特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\nA - \\lambda I = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} -\\lambda  1 \\\\ 0  -\\lambda \\end{pmatrix}.\n$$\n行列式为\n$$\n\\det(A - \\lambda I) = (-\\lambda)(-\\lambda) - (1)(0) = \\lambda^{2}.\n$$\n特征方程为 $\\lambda^{2} = 0$，它有一个重根 $\\lambda = 0$。$A$ 的特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = 0$。\n谱半径定义为 $\\rho(A) \\equiv \\max\\{\\,|\\lambda| : \\lambda \\text{ 是 } A \\text{ 的一个特征值}\\,\\}$。\n在这种情况下，特征值的集合是 $\\{0\\}$，所以它们的模的集合是 $\\{|0|\\} = \\{0\\}$。\n$$\n\\rho(A) = \\max\\{0\\} = 0.\n$$\n\n3.  计算瑞利商 $R_A(x)$ 并证明 $|R_A(x)| > \\rho(A)$。\n瑞利商定义为 $R_A(x) \\equiv \\frac{x^{*} A x}{x^{*} x}$。因为我们已经验证了 $x$ 是一个单位向量，所以 $x^{*}x=1$，表达式简化为 $R_A(x) = x^{*} A x$。\n首先，我们计算乘积 $Ax$：\n$$\nAx = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} (0)(1)+(1)(1) \\\\ (0)(1)+(0)(1) \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n现在，我们计算 $x^{*} A x$：\n$$\nR_A(x) = x^{*} (Ax) = \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{(\\sqrt{2})(\\sqrt{2})} \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{2}((1)(1) + (1)(0)) = \\frac{1}{2}.\n$$\n瑞利商为 $R_A(x) = \\frac{1}{2}$。\n现在我们必须证明 $|R_A(x)| > \\rho(A)$。\n我们有 $|R_A(x)| = |\\frac{1}{2}| = \\frac{1}{2}$。\n从上一步中，我们得到 $\\rho(A) = 0$。\n因此不等式为 $\\frac{1}{2} > 0$，这是成立的。\n这表明对于非正规矩阵，其数值范围 $W(A)$（根据定义包含 $R_A(x)$）可以延伸到复平面中以原点为中心、半径为 $\\rho(A)$ 的圆盘之外。对于正规矩阵，数值范围是特征值的凸包，因此对于所有 $x$ 都有 $|R_A(x)| \\le \\rho(A)$。这个例子清楚地显示了非正规矩阵的不同行为。需要报告的瑞利商的值是 $\\frac{1}{2}$。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3595108"}, {"introduction": "瑞利商迭代（Rayleigh Quotient Iteration, RQI）是一种极其高效的算法，以其通常三次方的收敛速度而闻名。本练习 [@problem_id:3595063] 提供了一个对角矩阵和初始向量，要求您手动执行两轮迭代。通过这个计算过程，您可以亲身体验RQI的运作机制，并直观地观察其如何快速逼近矩阵的一个特征值。", "problem": "设 $A \\in \\mathbb{C}^{3 \\times 3}$ 为 $3 \\times 3$ 的埃尔米特矩阵\n$$\nA = \\mathrm{diag}(1,3,7),\n$$\n且初始单位向量为\n$$\nx_{0} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\n对于非零向量 $x \\in \\mathbb{C}^{3}$，定义瑞利商 $R_{A}(x)$ 为\n$$\nR_{A}(x) = \\frac{x^{*} A x}{x^{*} x}.\n$$\n考虑从 $(x_{0},\\mu_{0})$ 开始的瑞利商迭代，其中 $\\mu_{0} = R_{A}(x_{0})$，并且对于 $k = 0,1$，通过下式计算 $y_{k}$\n$$\n(A - \\mu_{k} I) y_{k} = x_{k},\n$$\n然后令\n$$\nx_{k+1} = \\frac{y_{k}}{\\|y_{k}\\|}, \\qquad \\mu_{k+1} = R_{A}(x_{k+1}).\n$$\n执行两次迭代，计算逼近 $A$ 的一个特征值的序列 $\\mu_{k} = R_{A}(x_{k})$。请给出 $\\mu_{2}$ 的精确值，形式为一个简化的解析表达式。不需要四舍五入。", "solution": "给定矩阵为 $A = \\mathrm{diag}(1,3,7)$。其特征值为 $\\lambda_1 = 1$、$\\lambda_2 = 3$ 和 $\\lambda_3 = 7$。对应的特征向量是标准基向量 $e_1 = \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix}$、$e_2 = \\begin{pmatrix}0 \\\\ 1 \\\\ 0\\end{pmatrix}$ 和 $e_3 = \\begin{pmatrix}0 \\\\ 0 \\\\ 1\\end{pmatrix}$。\n\n初始向量为 $x_{0} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}$。\n\n瑞利商定义为 $R_{A}(x) = \\frac{x^{*} A x}{x^{*} x}$。对于单位向量 $x$，这可以简化为 $R_{A}(x) = x^{*} A x$。\n\n瑞利商迭代由以下序列定义：\n$\\mu_{k} = R_{A}(x_{k})$\n$(A - \\mu_{k} I) y_{k} = x_{k}$\n$x_{k+1} = \\frac{y_{k}}{\\|y_{k}\\|}$\n\n我们需要计算 $\\mu_2$。\n\n**迭代 1：k=0**\n\n首先，我们计算 $\\mu_0 = R_A(x_0)$。由于 $x_0$ 是一个单位向量（$x_0^* x_0 = \\frac{1}{3}(1+1+1) = 1$），我们有：\n$$\n\\mu_0 = x_0^* A x_0 = \\left(\\frac{1}{\\sqrt{3}}\\begin{pmatrix}1  1  1\\end{pmatrix}\\right) \\begin{pmatrix}1  0  0 \\\\ 0  3  0 \\\\ 0  0  7\\end{pmatrix} \\left(\\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}\\right)\n$$\n$$\n\\mu_0 = \\frac{1}{3} \\begin{pmatrix}1  1  1\\end{pmatrix} \\begin{pmatrix}1 \\\\ 3 \\\\ 7\\end{pmatrix} = \\frac{1}{3}(1+3+7) = \\frac{11}{3}\n$$\n\n接下来，我们在方程 $(A - \\mu_0 I)y_0 = x_0$ 中求解 $y_0$。\n$$\nA - \\mu_0 I = \\mathrm{diag}(1,3,7) - \\frac{11}{3}I = \\mathrm{diag}\\left(1-\\frac{11}{3}, 3-\\frac{11}{3}, 7-\\frac{11}{3}\\right) = \\mathrm{diag}\\left(-\\frac{8}{3}, -\\frac{2}{3}, \\frac{10}{3}\\right)\n$$\n该系统是对角系统，因此我们可以通过对角矩阵求逆来解出 $y_0$：\n$$\ny_0 = (A - \\mu_0 I)^{-1} x_0 = \\mathrm{diag}\\left(-\\frac{3}{8}, -\\frac{3}{2}, \\frac{3}{10}\\right) \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}-3/8 \\\\ -3/2 \\\\ 3/10\\end{pmatrix}\n$$\n$$\ny_0 = \\frac{3}{\\sqrt{3}} \\begin{pmatrix}-1/8 \\\\ -1/2 \\\\ 1/10\\end{pmatrix} = \\sqrt{3} \\begin{pmatrix}-1/8 \\\\ -1/2 \\\\ 1/10\\end{pmatrix}\n$$\n为了方便归一化，我们可以为各分量找到一个公分母：$40$。\n$$\ny_0 = \\sqrt{3} \\begin{pmatrix}-5/40 \\\\ -20/40 \\\\ 4/40\\end{pmatrix} = \\frac{\\sqrt{3}}{40}\\begin{pmatrix}-5 \\\\ -20 \\\\ 4\\end{pmatrix}\n$$\n\n现在，我们计算 $x_1 = \\frac{y_0}{\\|y_0\\|}$。首先，我们求 $\\|y_0\\|$：\n$$\n\\|y_0\\|^2 = \\left(\\frac{\\sqrt{3}}{40}\\right)^2 ((-5)^2 + (-20)^2 + 4^2) = \\frac{3}{1600}(25+400+16) = \\frac{3 \\cdot 441}{1600}\n$$\n$$\n\\|y_0\\| = \\sqrt{\\frac{3 \\cdot 21^2}{1600}} = \\frac{21\\sqrt{3}}{40}\n$$\n然后，我们将 $y_0$ 归一化得到 $x_1$：\n$$\nx_1 = \\frac{y_0}{\\|y_0\\|} = \\frac{\\frac{\\sqrt{3}}{40}\\begin{pmatrix}-5 \\\\ -20 \\\\ 4\\end{pmatrix}}{\\frac{21\\sqrt{3}}{40}} = \\frac{1}{21}\\begin{pmatrix}-5 \\\\ -20 \\\\ 4\\end{pmatrix}\n$$\n\n**迭代 2：k=1**\n\n首先，我们计算 $\\mu_1 = R_A(x_1)$。由于 $x_1$ 是一个单位向量，$\\mu_1 = x_1^* A x_1$：\n$$\n\\mu_1 = \\left(\\frac{1}{21}\\begin{pmatrix}-5  -20  4\\end{pmatrix}\\right) \\begin{pmatrix}1  0  0 \\\\ 0  3  0 \\\\ 0  0  7\\end{pmatrix} \\left(\\frac{1}{21}\\begin{pmatrix}-5 \\\\ -20 \\\\ 4\\end{pmatrix}\\right)\n$$\n$$\n\\mu_1 = \\frac{1}{21^2} \\begin{pmatrix}-5  -20  4\\end{pmatrix} \\begin{pmatrix}-5 \\\\ -60 \\\\ 28\\end{pmatrix} = \\frac{1}{441} (25 + 1200 + 112) = \\frac{1337}{441}\n$$\n我们可以化简这个分数。因为 $1337 = 7 \\cdot 191$ 且 $441 = 7 \\cdot 63$，我们得到：\n$$\n\\mu_1 = \\frac{191}{63}\n$$\n\n接下来，我们在方程 $(A - \\mu_1 I)y_1 = x_1$ 中求解 $y_1$。\n$$\nA - \\mu_1 I = \\mathrm{diag}\\left(1-\\frac{191}{63}, 3-\\frac{191}{63}, 7-\\frac{191}{63}\\right) = \\mathrm{diag}\\left(-\\frac{128}{63}, -\\frac{2}{63}, \\frac{250}{63}\\right)\n$$\n所以，$y_1 = (A - \\mu_1 I)^{-1} x_1$：\n$$\ny_1 = \\mathrm{diag}\\left(-\\frac{63}{128}, -\\frac{63}{2}, \\frac{63}{250}\\right) \\left(\\frac{1}{21}\\begin{pmatrix}-5 \\\\ -20 \\\\ 4\\end{pmatrix}\\right)\n$$\n$$\ny_1 = \\frac{63}{21} \\begin{pmatrix} (-1/128)(-5) \\\\ (-1/2)(-20) \\\\ (1/250)(4) \\end{pmatrix} = 3 \\begin{pmatrix} 5/128 \\\\ 10 \\\\ 4/250 \\end{pmatrix} = \\begin{pmatrix} 15/128 \\\\ 30 \\\\ 12/250 \\end{pmatrix} = \\begin{pmatrix} 15/128 \\\\ 30 \\\\ 6/125 \\end{pmatrix}\n$$\n\n最后，我们计算 $\\mu_2$。根据定义，$\\mu_2 = R_A(x_2) = R_A(y_1/\\|y_1\\|)$。\n$$\n\\mu_2 = \\frac{(y_1/\\|y_1\\|)^* A (y_1/\\|y_1\\|)}{(y_1/\\|y_1\\|)^* (y_1/\\|y_1\\|)} = \\frac{y_1^* A y_1}{y_1^* y_1}\n$$\n我们分别计算分子和分母。\n分母是：\n$$\ny_1^* y_1 = \\left(\\frac{15}{128}\\right)^2 + 30^2 + \\left(\\frac{6}{125}\\right)^2 = \\frac{225}{16384} + 900 + \\frac{36}{15625}\n$$\n分子是：\n$$\ny_1^* A y_1 = \\begin{pmatrix} \\frac{15}{128}  30  \\frac{6}{125} \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  3  0 \\\\ 0  0  7 \\end{pmatrix} \\begin{pmatrix} 15/128 \\\\ 30 \\\\ 6/125 \\end{pmatrix}\n$$\n$$\ny_1^* A y_1 = \\left(\\frac{15}{128}\\right)^2(1) + (30)^2(3) + \\left(\\frac{6}{125}\\right)^2(7)\n$$\n$$\ny_1^* A y_1 = \\frac{225}{16384} + 2700 + \\frac{252}{15625}\n$$\n现在我们计算 $\\mu_2$ 的比值：\n$$\n\\mu_2 = \\frac{\\frac{225}{16384} + 2700 + \\frac{252}{15625}}{\\frac{225}{16384} + 900 + \\frac{36}{15625}}\n$$\n将所有项通分，公分母为 $16384 \\times 15625 = 256000000$。\n分子：$225(15625) + 2700(256000000) + 252(16384) = 3515625 + 691200000000 + 4128768 = 691207644393$。\n分母：$225(15625) + 900(256000000) + 36(16384) = 3515625 + 230400000000 + 589824 = 230404105449$。\n$$\n\\mu_2 = \\frac{691207644393}{230404105449}\n$$\n这个分数可以化简。分子和分母都可以被 $63$ 整除。\n$691207644393 / 63 = 10971549911$\n$230404105449 / 63 = 3657208023$\n因此，\n$$\n\\mu_2 = \\frac{10971549911}{3657208023}\n$$", "answer": "$$\n\\boxed{\\frac{10971549911}{3657208023}}\n$$", "id": "3595063"}, {"introduction": "在评估近似特征向量的质量时，其对应的残差范数（residual norm）是一个关键指标。通常我们认为，一个小的残差范数意味着近似解的质量很高。然而，本练习 [@problem_id:3595069] 将通过编程实践揭示一个重要的数值计算细节：当矩阵的特征值高度聚集时，即使一个向量并非任何单一特征向量的良好近似，其残差范数也可能非常小。这个现象强调了谱分离（spectral separation）在判断近似解准确性时的重要性。", "problem": "考虑厄米（实对称）矩阵的瑞利商。设 $A \\in \\mathbb{R}^{n \\times n}$ 为厄米矩阵，设 $x \\in \\mathbb{R}^{n} \\setminus \\{0\\}$，定义瑞利商 $R_{A}(x)$ 为\n$$\nR_{A}(x) \\coloneqq \\frac{x^{\\top} A x}{x^{\\top} x}.\n$$\n定义与 $x$ 相关的残差向量 $r(x)$ 为\n$$\nr(x) \\coloneqq A x - R_{A}(x)\\, x,\n$$\n并用欧几里得范数（即 $\\ell^{2}$-范数）来衡量其大小，记为 $\\lVert \\cdot \\rVert_{2}$。对于对角实对称矩阵 $A = \\operatorname{diag}(\\lambda_{1},\\dots,\\lambda_{n})$ 和标准基 $\\{e_{i}\\}_{i=1}^{n}$ 中的单位向量 $x = \\sum_{i=1}^{n} c_{i} e_{i}$，瑞利商是特征值的凸组合，而残差取决于特征值与 $R_{A}(x)$ 的加权偏差。您的任务是从第一性原理出发，通过数值方式证明，当矩阵 $A$ 的特征值紧密聚集时，即使残差范数 $\\lVert r(x) \\rVert_{2}$ 很小，瑞利商 $R_{A}(x)$ 也可能无法很好地区分单个特征值。\n\n程序要求：\n- 对每个测试用例，从提供的特征值构造 $A = \\operatorname{diag}(\\lambda_{1},\\dots,\\lambda_{n})$，从特征基中提供的系数构造向量 $x$，并将 $x$ 归一化为单位范数。\n- 计算以下量：\n  1. 瑞利商 $\\mu \\coloneqq R_{A}(x)$。\n  2. 残差范数 $\\lVert r(x) \\rVert_{2}$，其中 $r(x) = A x - \\mu x$。\n  3. 最近特征值距离 $d_{\\min} \\coloneqq \\min_{1 \\le i \\le n} \\lvert \\mu - \\lambda_{i} \\rvert$。\n  4. 最大特征向量重叠度 $\\max_{1 \\le i \\le n} \\lvert \\langle x, e_{i} \\rangle \\rvert = \\max_{1 \\le i \\le n} \\lvert c_{i} \\rvert$。\n  5. 距离 $\\mu$ 最近的特征值的局部谱分离：如果 $j^{\\star} \\in \\arg\\min_{1 \\le i \\le n} \\lvert \\mu - \\lambda_{i} \\rvert$，定义\n     $$\n     \\operatorname{sep}_{\\star} \\coloneqq \\min_{\\substack{1 \\le k \\le n \\\\ \\lambda_{k} \\ne \\lambda_{j^{\\star}}}} \\lvert \\lambda_{k} - \\lambda_{j^{\\star}} \\rvert,\n     $$\n     并约定如果所有特征值都相等，则 $\\operatorname{sep}_{\\star} \\coloneqq 0$。\n- 您的程序必须为每个测试用例输出列表 $[\\lVert r(x) \\rVert_{2}, \\max_{i} \\lvert c_{i} \\rvert, d_{\\min}, \\operatorname{sep}_{\\star}]$，其中每个浮点数四舍五入到 $8$ 位小数。\n\n测试套件：\n- 所有测试用例均使用 $n = 5$。对于每个用例，使用指定的特征值构成 $A = \\operatorname{diag}(\\lambda_{1},\\dots,\\lambda_{5})$，并根据给定的系数构造 $x$（然后将 $x$ 归一化，使得 $\\lVert x \\rVert_{2} = 1$）：\n  1. 特征值紧密聚集（展示小残差但特征向量区分度差的典型情况）：\n     - 特征值：$[\\lambda_{1},\\dots,\\lambda_{5}] = [1.0, 1.0001, 1.0002, 3.0, 5.0]$。\n     - $x$ 在特征基中的系数：$[1.0, 1.0, 1.0, 0.0, 0.0]$。\n  2. 特征值良好分离（对比情况）：\n     - 特征值：$[\\lambda_{1},\\dots,\\lambda_{5}] = [1.0, 1.5, 2.0, 3.0, 5.0]$。\n     - $x$ 在特征基中的系数：$[1.0, 1.0, 1.0, 0.0, 0.0]$。\n  3. 精确简并簇（边界情况）：\n     - 特征值：$[\\lambda_{1},\\dots,\\lambda_{5}] = [1.0, 1.0, 1.0, 3.0, 5.0]$。\n     - $x$ 在特征基中的系数：$[1.0, 1.0, 1.0, 0.0, 0.0]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是对应一个测试用例的列表 $[\\lVert r(x) \\rVert_{2}, \\max_{i} \\lvert c_{i} \\rvert, d_{\\min}, \\operatorname{sep}_{\\star}]$，所有浮点数均四舍五入到 $8$ 位小数。例如，包含三个测试用例的输出应如下所示：\n- $[[a_{1}, b_{1}, c_{1}, d_{1}], [a_{2}, b_{2}, c_{2}, d_{2}], [a_{3}, b_{3}, c_{3}, d_{3}]]$ 其中每个 $a_{k}, b_{k}, c_{k}, d_{k}$ 是一个四舍五入到 $8$ 位小数的十进制数。\n\n目标是表明，当特征值紧密聚集时，$\\lVert r(x) \\rVert_{2}$ 可能很小，而 $\\max_{i} \\lvert c_{i} \\rvert$ 却远离 $1$，这表明 $x$ 不接近任何单个特征向量，因此 $R_{A}(x)$ 无法很好地区分簇内的单个特征值。不涉及物理单位。如果考虑角度，则默认为弧度制。", "solution": "这个问题的核心在于瑞利商 $R_A(x)$、其关联的残差向量 $r(x)$ 以及厄米矩阵 $A$ 的谱特性之间的关系。给定一个实对称对角矩阵 $A = \\operatorname{diag}(\\lambda_1, \\dots, \\lambda_n)$，其特征值是对角元素 $\\lambda_i$，对应的标准正交特征向量是标准基向量 $\\{e_i\\}_{i=1}^n$。\n\n设 $x \\in \\mathbb{R}^n$ 是一个单位向量，它可以在特征基中表示为 $x = \\sum_{i=1}^n c_i e_i$，其中 $\\sum_{i=1}^n c_i^2 = 1$。系数 $c_i = \\langle x, e_i \\rangle$ 表示 $x$ 在每个特征向量上的投影。\n\n瑞利商，记为 $\\mu$，定义为：\n$$\n\\mu \\coloneqq R_A(x) = \\frac{x^\\top A x}{x^\\top x}\n$$\n由于 $x$ 是单位向量，所以 $x^\\top x = 1$。$\\mu$ 的表达式简化为：\n$$\n\\mu = x^\\top A x = \\left( \\sum_{i=1}^n c_i e_i^\\top \\right) A \\left( \\sum_{j=1}^n c_j e_j \\right) = \\sum_{i=1}^n \\sum_{j=1}^n c_i c_j (e_i^\\top A e_j)\n$$\n由于 $A e_j = \\lambda_j e_j$ 且 $e_i^\\top e_j = \\delta_{ij}$（克罗内克δ），上式变为：\n$$\n\\mu = \\sum_{i=1}^n c_i^2 \\lambda_i\n$$\n这表明瑞利商是矩阵 $A$ 特征值的凸组合，其权重由向量 $x$ 在特征基中的分量的平方给出。\n\n残差向量 $r(x)$ 衡量 $x$ 离特征向量的接近程度，定义为：\n$$\nr(x) \\coloneqq A x - \\mu x\n$$\n如果 $x$ 是一个特征向量，则 $Ax = \\lambda x$ 且 $\\mu = \\lambda$，因此 $r(x) = 0$。我们使用欧几里得范数 $\\lVert r(x) \\rVert_2$ 来分析其大小。代入 $Ax$ 和 $\\mu$ 的表达式：\n$$\nAx = A \\left(\\sum_{i=1}^n c_i e_i\\right) = \\sum_{i=1}^n c_i (A e_i) = \\sum_{i=1}^n c_i \\lambda_i e_i\n$$\n$$\nr(x) = \\sum_{i=1}^n c_i \\lambda_i e_i - \\left(\\sum_{j=1}^n c_j^2 \\lambda_j\\right) \\left(\\sum_{i=1}^n c_i e_i\\right) = \\sum_{i=1}^n c_i (\\lambda_i - \\mu) e_i\n$$\n由于特征向量 $e_i$ 的标准正交性，残差的范数平方为：\n$$\n\\lVert r(x) \\rVert_2^2 = \\langle r(x), r(x) \\rangle = \\sum_{i=1}^n (c_i (\\lambda_i - \\mu))^2 = \\sum_{i=1}^n c_i^2 (\\lambda_i - \\mu)^2\n$$\n这个基本结果表明，残差范数的平方是特征值相对于瑞利商 $\\mu$ 的加权方差。\n\n该问题要求通过数值方式证明，一个小的残差范数 $\\lVert r(x) \\rVert_2$ 并不一定意味着 $x$ 接近于某个单一的特征向量，特别是当特征值聚集时。$x$ 与单个特征向量 $e_j$ 的接近程度由最大系数的幅度 $\\max_i |c_i|$ 来衡量。如果 $x$ 接近 $e_j$，那么 $|c_j|$ 应接近 $1$，而所有其他的 $|c_i|$ 应接近 $0$。\n\n该证明过程通过计算一个 $5 \\times 5$ 矩阵的三种不同谱构型的四个量来进行：\n1.  $\\lVert r(x) \\rVert_2$：残差范数，计算公式为 $\\sqrt{\\sum_i c_i^2 (\\lambda_i - \\mu)^2}$。\n2.  $\\max_i |c_i|$：最大特征向量重叠度。对于给定的未归一化系数向量 $c_{\\text{unnorm}}$，归一化系数为 $c = c_{\\text{unnorm}} / \\lVert c_{\\text{unnorm}} \\rVert_2$。\n3.  $d_{\\min}$：$\\mu$ 与最近特征值之间的距离，$\\min_i |\\mu - \\lambda_i|$。\n4.  $\\operatorname{sep}_\\star$：最接近 $\\mu$ 的特征值 $\\lambda_{j^\\star}$ 与所有其他不同特征值之间的分离度。\n\n**情况1（特征值紧密聚集）：** 当 $\\lambda = [1.0, 1.0001, 1.0002, 3.0, 5.0]$ 且 $x$ 是前三个特征向量的等比例混合时，瑞利商 $\\mu=1.0001$ 正好落在该簇的中间。对于 $i=1, 2, 3$，项 $(\\lambda_i - \\mu)^2$ 极小。由于 $c_4=c_5=0$，只有这些小项对总和 $\\sum c_i^2 (\\lambda_i - \\mu)^2$ 有贡献，导致残差范数非常小。然而，由于 $x$ 是三个特征向量的混合，$\\max_i |c_i| = 1/\\sqrt{3} \\approx 0.577$，远非 $1$。这说明了要点：小残差范数伴随着差的特征向量近似，这是由于小的谱分离 $\\operatorname{sep}_\\star = 0.0001$ 才可能发生。\n\n**情况2（特征值良好分离）：** 使用相同的向量 $x$，但特征值良好分离，$\\lambda = [1.0, 1.5, 2.0, 3.0, 5.0]$，瑞利商 $\\mu=1.5$ 是前三个特征值的平均值。现在，项 $(\\lambda_1-\\mu)^2 = (-0.5)^2$ 和 $(\\lambda_3-\\mu)^2 = (0.5)^2$ 都很大。这导致残差范数大得多，表明对于谱分离良好的情况，一个不是特征向量的向量通常会产生较大的残差。谱分离度 $\\operatorname{sep}_\\star = 0.5$ 很大。\n\n**情况3（精确简并特征值）：** 当 $\\lambda = [1.0, 1.0, 1.0, 3.0, 5.0]$ 时，向量 $x$ 被构造为三个特征向量的线性组合，这三个特征向量都都对应于相同的特征值 $\\lambda=1.0$。这样的向量本身就是属于该简并特征空间的特征向量。因此，$Ax = 1.0 \\cdot x$，瑞利商为 $\\mu=1.0$，残差范数恰好为 $0$。特征向量重叠度 $\\max_i|c_i|$ 仍然是 $1/\\sqrt{3}$，这表明在简并子空间中，特征向量不是唯一的。\n\n实现将遵循这些原则，在归一化输入系数向量后，根据其定义计算每个量。结果将按要求四舍五入到 $8$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes analysis quantities for the Rayleigh quotient problem for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Tightly clustered eigenvalues\n        {\n            \"eigenvalues\": [1.0, 1.0001, 1.0002, 3.0, 5.0],\n            \"coeffs_unnorm\": [1.0, 1.0, 1.0, 0.0, 0.0],\n        },\n        # Case 2: Well-separated eigenvalues\n        {\n            \"eigenvalues\": [1.0, 1.5, 2.0, 3.0, 5.0],\n            \"coeffs_unnorm\": [1.0, 1.0, 1.0, 0.0, 0.0],\n        },\n        # Case 3: Exactly degenerate cluster\n        {\n            \"eigenvalues\": [1.0, 1.0, 1.0, 3.0, 5.0],\n            \"coeffs_unnorm\": [1.0, 1.0, 1.0, 0.0, 0.0],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        lambdas = np.array(case[\"eigenvalues\"], dtype=float)\n        coeffs_unnorm = np.array(case[\"coeffs_unnorm\"], dtype=float)\n\n        # Normalize the vector x (represented by its coefficients in the eigenbasis)\n        norm_x = np.linalg.norm(coeffs_unnorm)\n        if norm_x == 0:\n            # Handle the zero vector case, though not in test suite.\n            # A valid vector x must be non-zero.\n            coeffs = np.zeros_like(coeffs_unnorm)\n        else:\n            coeffs = coeffs_unnorm / norm_x\n\n        # 1. Compute the Rayleigh quotient mu\n        mu = np.sum(coeffs**2 * lambdas)\n\n        # 2. Compute the residual norm ||r(x)||_2\n        residual_norm = np.sqrt(np.sum((lambdas - mu)**2 * coeffs**2))\n\n        # 3. Compute the nearest-eigenvalue distance d_min\n        d_min = np.min(np.abs(lambdas - mu))\n\n        # 4. Compute the maximum eigenvector overlap max|c_i|\n        max_c = np.max(np.abs(coeffs))\n\n        # 5. Compute the local spectral separation sep_star\n        # Find the index of the eigenvalue closest to mu\n        j_star_idx = np.argmin(np.abs(lambdas - mu))\n        lambda_j_star = lambdas[j_star_idx]\n\n        # Find eigenvalues different from lambda_j_star\n        other_lambdas = lambdas[lambdas != lambda_j_star]\n        \n        # Calculate separation according to the problem's convention\n        if other_lambdas.size == 0:\n            sep_star = 0.0\n        else:\n            sep_star = np.min(np.abs(other_lambdas - lambda_j_star))\n\n        # Collect and round the results for the current case\n        case_result = [\n            round(residual_norm, 8),\n            round(max_c, 8),\n            round(d_min, 8),\n            round(sep_star, 8)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list automatically provides the desired \"[...]\" formatting.\n    # The replace is to ensure there are no spaces after commas.\n    print(f\"{results}\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "3595069"}]}