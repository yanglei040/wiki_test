{"hands_on_practices": [{"introduction": "理论的掌握最终需要通过实践来巩固。这项练习将带领您亲手执行未移位的QR算法的几个步骤。通过对一个小型对称矩阵进行精确计算，您将熟悉QR分解（通过Gram-Schmidt过程）和后续矩阵乘法这两个核心阶段，从而深刻理解算法在每一步的具体操作。", "problem": "考虑对实对称矩阵\n$$\nA_0=\\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix}\n$$\n应用非位移正交三角(QR)算法。\n非位移QR迭代定义如下。在迭代索引为$k$时，计算正交三角(QR)分解$A_k=Q_k R_k$，其中$Q_k$是正交矩阵（因此$Q_k^{\\top}Q_k=I$），$R_k$是上三角矩阵，然后形成$A_{k+1}=R_k Q_k$。已知此过程会产生一系列通过相似变换连接的矩阵，并用于迭代地揭示特征值信息。\n\n仅使用满秩方阵的正交三角(QR)分解的基本定义和正交性$Q_k^{\\top}Q_k=I$，从$A_0$开始，精确执行两次非位移QR迭代，从而构造出$A_1$和$A_2$。在每一步中，明确确认连接$A_{k+1}$和$A_k$的相似关系。\n\n你必须精确计算这些分解和乘积，除了正交三角(QR)分解和正交性的定义属性外，不得借助任何预先陈述的算法捷径。将你的最终结果表示为精确的有理数。\n\n$A_2$的$(1,1)$元素的确切值是多少？", "solution": "该问题要求对矩阵$A_0 = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$执行两次非位移QR算法迭代。该算法由序列$A_k = Q_k R_k$和$A_{k+1} = R_k Q_k$定义，其中$A_k = Q_k R_k$是$A_k$的正交三角(QR)分解。\n\n首先，我们来分析给定的矩阵。矩阵$A_0$是一个$2 \\times 2$的实对称矩阵。\n$$\nA_0 = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n其行列式为$\\det(A_0) = (2)(2) - (1)(1) = 3 \\neq 0$，因此该矩阵是满秩的，并且存在唯一的QR分解（在符号上可能不同）。\n\n**迭代 1：计算 $A_1$**\n\n我们首先计算$A_0$的QR分解。设$A_0$的列向量为$a_1 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$和$a_2 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。我们对$A_0$的列向量应用Gram-Schmidt过程来找到正交矩阵$Q_0$。\n\n设$Q_0$的列向量为$q_1$和$q_2$。\n第一个未归一化的正交向量$u_1$就是$a_1$：\n$$\nu_1 = a_1 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n其范数的平方为$\\|u_1\\|^2 = 2^2 + 1^2 = 5$。范数为$\\|u_1\\| = \\sqrt{5}$。\n$Q_0$的第一列是归一化向量$q_1$：\n$$\nq_1 = \\frac{u_1}{\\|u_1\\|} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n第二个未归一化的正交向量$u_2$通过从$a_2$中减去其在$u_1$上的投影得到：\n$$\nu_2 = a_2 - \\frac{a_2^{\\top} u_1}{u_1^{\\top} u_1} u_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{(1)(2) + (2)(1)}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{4}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{8}{5} \\\\ 2 - \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{3}{5} \\\\ \\frac{6}{5} \\end{pmatrix}\n$$\n其范数的平方为$\\|u_2\\|^2 = (-\\frac{3}{5})^2 + (\\frac{6}{5})^2 = \\frac{9}{25} + \\frac{36}{25} = \\frac{45}{25} = \\frac{9}{5}$。范数为$\\|u_2\\| = \\sqrt{\\frac{9}{5}} = \\frac{3}{\\sqrt{5}}$。\n$Q_0$的第二列是归一化向量$q_2$：\n$$\nq_2 = \\frac{u_2}{\\|u_2\\|} = \\frac{1}{3/\\sqrt{5}} \\begin{pmatrix} -3/5 \\\\ 6/5 \\end{pmatrix} = \\frac{\\sqrt{5}}{3} \\frac{3}{5} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n因此，正交矩阵$Q_0$是：\n$$\nQ_0 = [q_1 \\ q_2] = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  -1 \\\\ 1  2 \\end{pmatrix}\n$$\n上三角矩阵$R_0$由$A_0 = Q_0 R_0 \\implies R_0 = Q_0^{\\top} A_0$得到，因为$Q_0$是正交的（$Q_0^{\\top}Q_0 = I$）。\n$$\nR_0 = \\left(\\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  1 \\\\ -1  2 \\end{pmatrix}\\right) \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} (2)(2)+(1)(1)  (2)(1)+(1)(2) \\\\ (-1)(2)+(2)(1)  (-1)(1)+(2)(2) \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5  4 \\\\ 0  3 \\end{pmatrix}\n$$\n找到$Q_0$和$R_0$后，我们计算序列中的下一个矩阵$A_1$：\n$$\nA_1 = R_0 Q_0 = \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5  4 \\\\ 0  3 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2  -1 \\\\ 1  2 \\end{pmatrix} \\right) = \\frac{1}{5} \\begin{pmatrix} (5)(2)+(4)(1)  (5)(-1)+(4)(2) \\\\ (0)(2)+(3)(1)  (0)(-1)+(3)(2) \\end{pmatrix}\n$$\n$$\nA_1 = \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix}\n$$\n为确认相似关系，我们证明$A_1 = Q_0^{\\top} A_0 Q_0$。根据定义，$A_1 = R_0 Q_0$且$R_0 = Q_0^{\\top} A_0$。将第二个式子代入第一个，得到$A_1 = (Q_0^{\\top} A_0) Q_0$，这正是所求的关系。由于$A_0$是对称的，$A_1$也必须是对称的，我们的结果证实了这一点。\n\n**迭代 2：计算 $A_2$**\n\n我们现在对$A_1 = \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix}$重复这个过程。设其列向量为$a'_1 = \\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}$和$a'_2 = \\frac{1}{5} \\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix}$。我们计算QR分解$A_1 = Q_1 R_1$。\n\n第一个未归一化的向量$u'_1$：\n$$\nu'_1 = a'_1 = \\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}\n$$\n其范数的平方为$\\|u'_1\\|^2 = (\\frac{1}{5})^2 (14^2 + 3^2) = \\frac{1}{25}(196+9) = \\frac{205}{25} = \\frac{41}{5}$。范数为$\\|u'_1\\|=\\sqrt{\\frac{41}{5}} = \\frac{\\sqrt{205}}{5}$。\n$Q_1$的第一列是$q'_1$：\n$$\nq'_1 = \\frac{u'_1}{\\|u'_1\\|} = \\frac{\\frac{1}{5} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}}{\\frac{\\sqrt{205}}{5}} = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix}\n$$\n第二个未归一化的向量$u'_2$是：\n$$\nu'_2 = a'_2 - \\frac{{a'_2}^{\\top} u'_1}{{u'_1}^{\\top} u'_1} u'_1\n$$\n点积为${a'_2}^{\\top} u'_1 = (\\frac{1}{5})^2 ((3)(14)+(6)(3)) = \\frac{1}{25}(42+18) = \\frac{60}{25} = \\frac{12}{5}$。\n$$\nu'_2 = \\frac{1}{5}\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - \\frac{12/5}{41/5} \\left( \\frac{1}{5}\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} \\right) = \\frac{1}{5}\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - \\frac{12}{41} \\frac{1}{5}\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} = \\frac{1}{205} \\left( 41\\begin{pmatrix} 3 \\\\ 6 \\end{pmatrix} - 12\\begin{pmatrix} 14 \\\\ 3 \\end{pmatrix} \\right)\n$$\n$$\nu'_2 = \\frac{1}{205} \\begin{pmatrix} 123-168 \\\\ 246-36 \\end{pmatrix} = \\frac{1}{205}\\begin{pmatrix} -45 \\\\ 210 \\end{pmatrix} = \\frac{15}{205}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix} = \\frac{3}{41}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}\n$$\n其范数的平方为$\\|u'_2\\|^2 = (\\frac{3}{41})^2 ((-3)^2+14^2) = \\frac{9}{41^2}(9+196) = \\frac{9 \\cdot 205}{41^2} = \\frac{9 \\cdot 5 \\cdot 41}{41^2} = \\frac{45}{41}$。范数为$\\|u'_2\\| = \\sqrt{\\frac{45}{41}} = \\frac{3\\sqrt{5}}{\\sqrt{41}} = \\frac{3\\sqrt{205}}{41}$。\n$Q_1$的第二列是$q'_2$：\n$$\nq'_2 = \\frac{u'_2}{\\|u'_2\\|} = \\frac{\\frac{3}{41}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}}{\\frac{3\\sqrt{205}}{41}} = \\frac{1}{\\sqrt{205}}\\begin{pmatrix} -3 \\\\ 14 \\end{pmatrix}\n$$\n正交矩阵$Q_1$是：\n$$\nQ_1 = [q'_1 \\ q'_2] = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  -3 \\\\ 3  14 \\end{pmatrix}\n$$\n上三角矩阵$R_1 = Q_1^{\\top} A_1$：\n$$\nR_1 = \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  3 \\\\ -3  14 \\end{pmatrix} \\right) \\left( \\frac{1}{5} \\begin{pmatrix} 14  3 \\\\ 3  6 \\end{pmatrix} \\right) = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 14^2+3^2  (14)(3)+(3)(6) \\\\ (-3)(14)+(14)(3)  (-3)(3)+(14)(6) \\end{pmatrix}\n$$\n$$\nR_1 = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 196+9  42+18 \\\\ -42+42  -9+84 \\end{pmatrix} = \\frac{1}{5\\sqrt{205}} \\begin{pmatrix} 205  60 \\\\ 0  75 \\end{pmatrix} = \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 41  12 \\\\ 0  15 \\end{pmatrix}\n$$\n现在我们计算$A_2 = R_1 Q_1$：\n$$\nA_2 = \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 41  12 \\\\ 0  15 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{205}} \\begin{pmatrix} 14  -3 \\\\ 3  14 \\end{pmatrix} \\right) = \\frac{1}{205} \\begin{pmatrix} (41)(14)+(12)(3)  (41)(-3)+(12)(14) \\\\ (0)(14)+(15)(3)  (0)(-3)+(15)(14) \\end{pmatrix}\n$$\n$$\nA_2 = \\frac{1}{205} \\begin{pmatrix} 574+36  -123+168 \\\\ 45  210 \\end{pmatrix} = \\frac{1}{205} \\begin{pmatrix} 610  45 \\\\ 45  210 \\end{pmatrix}\n$$\n提取公因数（所有元素和分母$205=5 \\times 41$都能被$5$整除）：\n$$\nA_2 = \\frac{5}{205} \\begin{pmatrix} 122  9 \\\\ 9  42 \\end{pmatrix} = \\frac{1}{41} \\begin{pmatrix} 122  9 \\\\ 9  42 \\end{pmatrix}\n$$\n和之前一样，相似关系$A_2 = Q_1^{\\top} A_1 Q_1$由构造过程保证。由于$A_1$是对称的，$A_2$也必须是对称的，我们的结果证实了这一点。\n\n问题要求$A_2$的$(1,1)$元素。根据上面推导出的矩阵$A_2$，该值为：\n$$\n(A_2)_{11} = \\frac{122}{41}\n$$\n该分数是不可约分的，因为$41$是质数，且$122 = 2 \\times 61$。", "answer": "$$\\boxed{\\frac{122}{41}}$$", "id": "3598477"}, {"introduction": "QR算法的收敛速度并非对所有矩阵都一视同仁。本练习探讨了一个“困难情况”：一个接近于不可对角化的若尔当块的矩阵。通过计算一次迭代后的次对角线元素 [@problem_id:2219199]，您可以直接观察到当特征值非常接近时，算法向三角形式收敛的过程是如何受到阻碍的，这为理解收敛性提供了具体的例证。", "problem": "非移位QR算法是计算矩阵特征值的一种基本方法。该算法从 $A_0 = A$ 开始，生成一个矩阵序列 $\\{A_k\\}$。每一步包括计算当前矩阵的QR分解 $A_k = Q_k R_k$，然后反转因子顺序以构成下一个矩阵 $A_{k+1} = R_k Q_k$。其中，$Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。为确保分解的唯一性，我们施加一个条件，即 $R_k$ 的对角线元素必须为正。\n\n众所周知，对于特征值大小几乎相等的矩阵，该算法的收敛速度很慢。对于接近于不可对角化（亏损）的矩阵，这种行为尤其明显。亏损矩阵的一个典型例子是Jordan块。\n\n考虑矩阵 $A$，它是Jordan块的一个小扰动：\n$$\nA = \\begin{pmatrix} \\lambda  1 \\\\ \\delta^2  \\lambda \\end{pmatrix}\n$$\n其中 $\\lambda$ 是一个正实数，$\\delta$ 是一个满足 $0  |\\delta| \\ll \\lambda$ 的实参数。当 $\\delta \\to 0$ 时，该矩阵趋近于一个在 $\\lambda$ 处有二重特征值的亏损Jordan块。\n\n设 $A_0 = A$。执行一次完整的非移位QR算法迭代以获得矩阵 $A_1$。次对角线元素 $(A_1)_{2,1}$ 是算法在寻找特征值方面进展的关键指标。请确定此元素 $(A_1)_{2,1}$ 作为 $\\lambda$ 和 $\\delta$ 的函数的精确表达式。", "solution": "我们将 $A$ 按列写为 $A=[a_{1}\\ a_{2}]$，其中 $a_{1}=\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$ 且 $a_{2}=\\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}$。$R$ 中对角线元素为正的QR分解可通过Gram–Schmidt方法得到：\n1) 计算 $r_{11}=\\|a_{1}\\|_{2}=\\sqrt{\\lambda^{2}+\\delta^{4}}0$ 和 $q_{1}=a_{1}/r_{11}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$。\n2) 计算 $r_{12}=q_{1}^{\\top}a_{2}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\left(\\lambda\\cdot 1+\\delta^{2}\\cdot \\lambda\\right)=\\frac{\\lambda(1+\\delta^{2})}{\\sqrt{\\lambda^{2}+\\delta^{4}}}$。\n3) 构造 $u_{2}=a_{2}-q_{1}r_{12}$。使用 $r_{11}^{2}=\\lambda^{2}+\\delta^{4}$，\n$$\nu_{2}= \\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}-\\frac{\\lambda(1+\\delta^{2})}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}\n=\\frac{\\lambda^{2}-\\delta^{2}}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}-\\delta^{2}\\\\ \\lambda\\end{pmatrix}.\n$$\n因此 $r_{22}=\\|u_{2}\\|_{2}=\\left|\\frac{\\lambda^{2}-\\delta^{2}}{\\lambda^{2}+\\delta^{4}}\\right|\\sqrt{\\lambda^{2}+\\delta^{4}}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}0$，且 $q_{2}=u_{2}/r_{22}$（其显式形式是不需要的）。\n对于 $A=QR$ 和 $A_{1}=RQ}$，次对角线元素是 $(A_{1})_{2,1}=(RQ)_{2,1} = r_{22}Q_{2,1}$，因为 $R_{2,1}=0$。使用 $Q_{2,1}=\\delta^{2}/\\sqrt{\\lambda^{2}+\\delta^{4}}$ 以及 $r_{22}$ 的表达式，\n$$\n(A_{1})_{2,1}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\cdot \\frac{\\delta^{2}}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\n=\\frac{\\delta^{2}\\,|\\lambda^{2}-\\delta^{2}|}{\\lambda^{2}+\\delta^{4}}.\n$$\n在给定条件 $0  |\\delta| \\ll \\lambda$ 且 $\\lambda0$ 的情况下，我们有 $\\lambda^{2}-\\delta^{2}0$，所以可以去掉绝对值，得到\n$$\n(A_{1})_{2,1}=\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}.\n$$", "answer": "$$\\boxed{\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}}$$", "id": "2219199"}, {"introduction": "在观察到收敛缓慢之后，一个自然的问题是“究竟有多慢？”。这项练习将分析提升到新的层次，它利用QR算法与同时迭代之间的联系来推导非对角线元素衰减的精确速率 [@problem_id:3598462]。这使我们能够预测达到所需精度所需的迭代次数，从而将对收敛性的定性感觉转化为定量预测。", "problem": "考虑应用于一个实对称 $3 \\times 3$ 矩阵 $A$ 的非移位正交三角 (QR) 算法，其迭代定义为 $A^{(k)} = Q^{(k)} R^{(k)}$ 和 $A^{(k+1)} = R^{(k)} Q^{(k)}$，其中 $Q^{(k)}$ 是正交矩阵，$R^{(k)}$ 是上三角矩阵。记 $a_{ij}^{(k)}$ 为 $A^{(k)}$ 的 $(i,j)$ 元素。设\n$$\n\\Lambda = \\operatorname{diag}(2, 1, \\tfrac{1}{3}), \\quad\nV = \\begin{pmatrix}\n\\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2}  0 \\\\\n\\frac{\\sqrt{2}}{2}  \\phantom{-}\\frac{\\sqrt{2}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nA = V \\Lambda V^{\\top}.\n$$\n从 $A^{(0)} = A$ 和 $Q^{(0)} = I$ 开始，利用非移位 QR 算法与对正规矩阵的同步正交迭代的等价性，从第一性原理出发，推导出一个关于 $k$ 的 $|a_{21}^{(k)}|$ 的显式表达式，并由此导出一个形式为 $|a_{21}^{(k)}| \\leq C r^{k}$（其中 $r \\in (0,1)$）的几何速率界，其中常数 $C$ 和比率 $r$ 必须根据谱数据和由 $V$ 导出的初始基来确定。然后，使用你推导出的界，计算满足 $|a_{21}^{(k)}| \\leq \\varepsilon$（其中 $\\varepsilon = 1.0 \\times 10^{-6}$）的最小整数 $k$。你的最终答案必须仅为 $k$ 的值；对于这个整数输出，不需要进行四舍五入。", "solution": "该问题要求分析由非移位 QR 算法生成的矩阵 $A^{(k)}$ 的 $(2,1)$ 元素的收敛性。解决方案的核心在于利用 QR 算法和同步正交迭代之间的等价性。\n\n非移位 QR 迭代定义为 $A^{(k)} = Q^{(k)}R^{(k)}$ 和 $A^{(k+1)} = R^{(k)}Q^{(k)}$，其中 $A^{(0)} = A$。这意味着 $A^{(k+1)} = (Q^{(k)})^{\\top} A^{(k)} Q^{(k)}$。通过归纳法，如果我们定义累积正交矩阵 $\\mathcal{Q}^{(k)} = Q^{(0)}Q^{(1)}\\cdots Q^{(k-1)}$，那么 $A^{(k)} = (\\mathcal{Q}^{(k)})^{\\top} A \\mathcal{Q}^{(k)}$。QR 算法的一个关键恒等式是 $A^k = \\mathcal{Q}^{(k)} \\mathcal{R}^{(k)}$，其中 $\\mathcal{R}^{(k)} = R^{(k-1)}\\cdots R^{(0)}$。这意味着 $\\mathcal{Q}^{(k)}$ 是矩阵幂 $A^k$ 的 QR 分解中的正交因子。\n\n同步正交迭代从标准基（由单位矩阵 $I$ 表示）开始，通过对 $A^k$ 的列应用格拉姆-施密特过程，生成一个正交矩阵序列。得到的正交矩阵恰好是 $\\mathcal{Q}^{(k)}$。我们将利用这一事实来推导 $\\mathcal{Q}^{(k)}$ 的列的表达式。\n\n矩阵 $A$ 由其谱分解 $A = V \\Lambda V^{\\top}$ 给出，其中特征值为 $\\lambda_1 = 2$，$\\lambda_2 = 1$，$\\lambda_3 = 1/3$，对应的标准正交特征向量矩阵为\n$$\nV = \\begin{pmatrix} v_1  v_2  v_3 \\end{pmatrix} = \\begin{pmatrix}\n\\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2}  0 \\\\\n\\frac{\\sqrt{2}}{2}  \\phantom{-}\\frac{\\sqrt{2}}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n矩阵 $V$ 是正交的，所以 $V^{-1}=V^{\\top}$。矩阵幂 $A^k$ 是 $A^k = (V \\Lambda V^{\\top})^k = V \\Lambda^k V^{\\top}$。\n\n设 $q_j^{(k)}$ 表示 $\\mathcal{Q}^{(k)}$ 的第 $j$ 列。这些列是通过对 $A^k$ 的列（即 $A^k e_j$，$j=1, 2, 3$）应用格拉姆-施密特过程得到的。\n\n让我们找出 $A^k$ 的前两列：\n第一列是 $A^k e_1 = V \\Lambda^k V^{\\top} e_1$。$V^{\\top}$ 的第一列是 $(\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2}, 0)^{\\top}$。\n$$\nA^k e_1 = V \\begin{pmatrix} 2^k  0  0 \\\\ 0  1^k  0 \\\\ 0  0  (1/3)^k \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\\\ 0 \\end{pmatrix} = V \\begin{pmatrix} \\frac{\\sqrt{2}}{2} 2^k \\\\ -\\frac{\\sqrt{2}}{2} 1^k \\\\ 0 \\end{pmatrix} = \\frac{\\sqrt{2}}{2} (2^k v_1 - 1^k v_2) = \\frac{\\sqrt{2}}{2} 2^k (v_1 - (\\tfrac{1}{2})^k v_2).\n$$\n$\\mathcal{Q}^{(k)}$ 的第一列 $q_1^{(k)}$ 是通过对 $A^k e_1$ 进行归一化得到的。由于 $v_1$ 和 $v_2$ 是正交单位向量，\n$$\nq_1^{(k)} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\|v_1 - (\\tfrac{1}{2})^k v_2\\|} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\sqrt{\\|v_1\\|^2 + ((\\tfrac{1}{2})^k)^2 \\|v_2\\|^2}} = \\frac{v_1 - (\\tfrac{1}{2})^k v_2}{\\sqrt{1 + (\\tfrac{1}{4})^k}}.\n$$\n$A^k$ 的第二列是 $A^k e_2 = V \\Lambda^k V^{\\top} e_2$。$V^{\\top}$ 的第二列是 $(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0)^{\\top}$。\n$$\nA^k e_2 = V \\begin{pmatrix} 2^k  0  0 \\\\ 0  1^k  0 \\\\ 0  0  (1/3)^k \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ \\frac{\\sqrt{2}}{2} \\\\ 0 \\end{pmatrix} = V \\begin{pmatrix} \\frac{\\sqrt{2}}{2} 2^k \\\\ \\frac{\\sqrt{2}}{2} 1^k \\\\ 0 \\end{pmatrix} = \\frac{\\sqrt{2}}{2} (2^k v_1 + 1^k v_2) = \\frac{\\sqrt{2}}{2} 2^k (v_1 + (\\tfrac{1}{2})^k v_2).\n$$\n为了找到 $q_2^{(k)}$，我们首先将 $A^k e_2$ 对 $q_1^{(k)}$ 进行正交化。我们记 $\\rho = \\tfrac{1}{2}$。未归一化的向量分别与 $\\tilde{q}_1 = v_1 - \\rho^k v_2$ 和 $\\tilde{y}_2 = v_1 + \\rho^k v_2$ 成比例。正交化后的向量是 $\\tilde{q}_2 = \\tilde{y}_2 - \\frac{\\langle \\tilde{y}_2, \\tilde{q}_1 \\rangle}{\\langle \\tilde{q}_1, \\tilde{q}_1 \\rangle} \\tilde{q}_1$。\n$$\n\\langle \\tilde{y}_2, \\tilde{q}_1 \\rangle = \\langle v_1 + \\rho^k v_2, v_1 - \\rho^k v_2 \\rangle = \\|v_1\\|^2 - \\rho^{2k}\\|v_2\\|^2 = 1 - \\rho^{2k}.\n$$\n$$\n\\langle \\tilde{q}_1, \\tilde{q}_1 \\rangle = \\|v_1 - \\rho^k v_2\\|^2 = \\|v_1\\|^2 + \\rho^{2k}\\|v_2\\|^2 = 1 + \\rho^{2k}.\n$$\n$$\n\\tilde{q}_2 = (v_1 + \\rho^k v_2) - \\frac{1 - \\rho^{2k}}{1 + \\rho^{2k}}(v_1 - \\rho^k v_2) = \\frac{(1+\\rho^{2k}) - (1-\\rho^{2k})}{1+\\rho^{2k}}v_1 + \\frac{\\rho^k(1+\\rho^{2k}) + \\rho^k(1-\\rho^{2k})}{1+\\rho^{2k}}v_2 = \\frac{2\\rho^{2k}}{1+\\rho^{2k}}v_1 + \\frac{2\\rho^k}{1+\\rho^{2k}}v_2.\n$$\n这个向量与 $\\rho^k v_1 + v_2$ 成比例。对此向量进行归一化得到 $q_2^{(k)}$：\n$$\nq_2^{(k)} = \\frac{\\rho^k v_1 + v_2}{\\|\\rho^k v_1 + v_2\\|} = \\frac{(\\tfrac{1}{2})^k v_1 + v_2}{\\sqrt{(\\tfrac{1}{4})^k + 1}}.\n$$\n$A^{(k)}$ 的元素 $a_{21}^{(k)}$ 由 $a_{21}^{(k)} = (q_2^{(k)})^{\\top} A q_1^{(k)}$ 给出。首先，我们计算 $A q_1^{(k)}$：\n$$\nA q_1^{(k)} = A \\frac{v_1 - \\rho^k v_2}{\\sqrt{1 + \\rho^{2k}}} = \\frac{A v_1 - \\rho^k A v_2}{\\sqrt{1 + \\rho^{2k}}} = \\frac{\\lambda_1 v_1 - \\rho^k \\lambda_2 v_2}{\\sqrt{1 + \\rho^{2k}}}.\n$$\n现在，我们计算与 $(q_2^{(k)})^{\\top}$ 的点积：\n$$\na_{21}^{(k)} = \\frac{(\\rho^k v_1^{\\top} + v_2^{\\top})}{\\sqrt{1+\\rho^{2k}}} \\frac{(\\lambda_1 v_1 - \\rho^k \\lambda_2 v_2)}{\\sqrt{1 + \\rho^{2k}}} = \\frac{1}{1+\\rho^{2k}} (\\rho^k \\lambda_1 v_1^{\\top}v_1 - \\rho^{2k}\\lambda_2 v_1^{\\top}v_2 + \\lambda_1 v_2^{\\top}v_1 - \\rho^k\\lambda_2 v_2^{\\top}v_2).\n$$\n使用 $v_i^{\\top}v_j = \\delta_{ij}$，我们得到：\n$$\na_{21}^{(k)} = \\frac{1}{1+\\rho^{2k}} (\\rho^k \\lambda_1 - 0 + 0 - \\rho^k \\lambda_2) = \\frac{\\rho^k (\\lambda_1 - \\lambda_2)}{1+\\rho^{2k}}.\n$$\n代入 $\\lambda_1 = 2$，$\\lambda_2 = 1$ 和 $\\rho = \\lambda_2/\\lambda_1 = 1/2$：\n$$\n|a_{21}^{(k)}| = a_{21}^{(k)} = \\frac{(\\tfrac{1}{2})^k (2 - 1)}{1+(\\tfrac{1}{2})^{2k}} = \\frac{(\\tfrac{1}{2})^k}{1+(\\tfrac{1}{4})^k}.\n$$\n这就是所要求的 $|a_{21}^{(k)}|$ 的显式表达式。\n\n接下来，我们推导一个几何速率界 $|a_{21}^{(k)}| \\leq C r^{k}$。从上面的表达式，我们有 $|a_{21}^{(k)}| = \\frac{1}{1+(1/4)^k} (\\frac{1}{2})^k$。由于 $k \\geq 0$，$(1/4)^k > 0$，所以 $1+(1/4)^k > 1$。因此，$\\frac{1}{1+(1/4)^k}  1$。我们可以用 $r=1/2$ 建立这个界：\n$$\n|a_{21}^{(k)}| \\leq 1 \\cdot (\\tfrac{1}{2})^k.\n$$\n因此，我们可以选择常数 $C=1$ 和比率 $r=1/2$。\n\n最后，我们必须找到满足 $|a_{21}^{(k)}| \\leq \\varepsilon = 1.0 \\times 10^{-6}$ 的最小整数 $k$。\n$$\n\\frac{(\\tfrac{1}{2})^k}{1+(\\tfrac{1}{4})^k} \\leq 10^{-6}.\n$$\n由于 $1+(1/4)^k > 1$，一个稍微宽松但充分的条件是 $(\\tfrac{1}{2})^k \\leq 10^{-6}$。解此不等式可得 $k$ 的一个下界。\n$$\n-k \\ln(2) \\leq \\ln(10^{-6}) = -6 \\ln(10).\n$$\n$$\nk \\geq \\frac{6 \\ln(10)}{\\ln(2)}.\n$$\n使用数值 $\\ln(10) \\approx 2.302585$ 和 $\\ln(2) \\approx 0.693147$，我们发现：\n$$\nk \\geq \\frac{6 \\times 2.302585}{0.693147} \\approx 19.93156.\n$$\n由于 $k$ 必须是整数，最小可能值为 $k=20$。我们可以用原始不等式来验证这个选择。\n对于 $k=19$：$|a_{21}^{(19)}| = \\frac{(1/2)^{19}}{1+(1/4)^{19}} \\approx (1/2)^{19} \\approx 1.907 \\times 10^{-6} > 10^{-6}$。\n对于 $k=20$：$|a_{21}^{(20)}| = \\frac{(1/2)^{20}}{1+(1/4)^{20}} \\approx (1/2)^{20} \\approx 0.953 \\times 10^{-6}  10^{-6}$。\n因此，最小的整数 $k$ 是 $20$。", "answer": "$$\\boxed{20}$$", "id": "3598462"}]}