{"hands_on_practices": [{"introduction": "理解算法的计算成本是数值分析中的一项基本功。本练习将引导你从第一性原理出发，精确推导求解稠密对称正定线性系统时，Cholesky 分解以及相关的三角求解过程所需的浮点运算（flop）总数。通过这个练习，你将亲自验证稠密矩阵分解的复杂度为 $\\mathcal{O}(n^3)$，并为后续更复杂的算法分析打下坚实的基础 [@problem_id:3370813]。", "problem": "考虑对称正定线性系统 $A x = b$，该系统由均匀网格上的二维泊松方程等一致椭圆型偏微分方程 (PDE) 经过有限差分法离散化得到。假设 $A \\in \\mathbb{R}^{n \\times n}$ 被视为稠密矩阵，并通过 Cholesky 分解 $A = L L^{\\top}$ 进行因式分解，其中 $L$ 是具有正对角元的下三角矩阵。采用以下算术成本模型：每次浮点加法、减法、乘法、除法和平方根运算计为 $1$ 次浮点运算 (flop)。\n\n任务：\n- 从使用内积逐列计算 $L$ 的标准非分块 Cholesky 算法出发，从第一性原理推导分解 $A$ 所需的精确总浮点运算次数，表示为关于 $n$ 的多项式，并由此证明其为 $n^{3}/3 + \\mathcal{O}(n^{2})$。\n- 使用标准的前向代入法求解 $L y = b$ 和回代法求解 $L^{\\top} x = y$，推导每次三角求解的精确浮点运算次数。\n- 结合您的结果，得到一个关于 $n$ 的单一简化闭式表达式，表示通过 Cholesky 分解对 $A$ 进行因式分解，然后通过前向代入和回代法求解单个右端项的 $A x = b$ 所需的精确总浮点运算次数。\n\n最终答案仅报告合并步骤得出的精确总浮点运算次数，并简化为关于 $n$ 的单个多项式。无需四舍五入。", "solution": "根据指定标准审查问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 方程组为线性系统 $A x = b$。\n- 矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 的，并被视为稠密矩阵。\n- 该系统将使用 Cholesky 分解 $A = L L^{\\top}$ 求解，其中 $L$ 是一个具有正对角元的下三角矩阵。\n- 求解过程包括三个阶段：\n    1.  Cholesky 分解：$A \\to L$。\n    2.  前向代入：求解 $L y = b$ 得到 $y$。\n    3.  回代：求解 $L^{\\top} x = y$ 得到 $x$。\n- 算术成本模型将一次浮点运算 (flop) 定义为一次加法、减法、乘法、除法或平方根运算。\n- 任务是：\n    1.  使用基于内积的标准逐列算法，推导 Cholesky 分解的精确总浮点运算次数，并将结果表示为关于 $n$ 的多项式。\n    2.  推导前向代入和回代步骤的精确浮点运算次数。\n    3.  将所有运算次数合并为一个单一的简化闭式表达式，用于表示求解 $A x = b$ 所需的总浮点运算次数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础：** 该问题基于数值线性代数中的基本和标准概念——Cholesky 分解和三角求解。浮点运算次数分析是科学计算中的一个典型练习。\n- **适定性：** 问题明确指定了算法、成本模型和期望的输出形式。这种结构确保了唯一且有意义的解的存在。\n- **客观性：** 问题使用精确、无歧义的数学语言陈述，不含主观内容。\n\n该问题没有说明中列出的任何缺陷，如科学上不健全、不完整、矛盾或含糊不清。这是一个数值分析中定义明确的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供详细的解答。\n\n### 解答推导\n\n设 $A = (a_{ij})$ 和 $L = (l_{ij})$ 为 $n \\times n$ 矩阵，其中当 $j > i$ 时 $l_{ij}=0$。Cholesky 分解由矩阵方程 $A = L L^{\\top}$ 定义。这对应于标量方程：\n$$a_{ij} = \\sum_{k=1}^{\\min(i,j)} l_{ik} l_{jk}$$\n我们将推导所需三个阶段中每个阶段的浮点运算次数。\n\n**1. Cholesky 分解 ($A = L L^{\\top}$) 的浮点运算次数**\n\n问题指定了一种使用内积的逐列算法。对于每一列 $j = 1, 2, \\dots, n$，我们计算元素 $l_{jj}$ 以及当 $i > j$ 时的元素 $l_{ij}$。\n\n对于对角元 $l_{jj}$：\n从 $a_{jj} = \\sum_{k=1}^{j} l_{jk}^2 = \\sum_{k=1}^{j-1} l_{jk}^2 + l_{jj}^2$，我们求解 $l_{jj}$：\n$$l_{jj} = \\sqrt{a_{jj} - \\sum_{k=1}^{j-1} l_{jk}^2}$$\n- 求和 $\\sum_{k=1}^{j-1} l_{jk}^2$ 涉及 $j-1$ 次乘法和 $j-2$ 次加法（对于 $j>1$）。\n- 计算 $l_{jj}$ 还需要一次减法和一次平方根。\n- 因此，对于 $j>1$，计算 $l_{jj}$ 的浮点运算次数为 $(j-1) + (j-2) + 1 + 1 = 2j-1$ 次。对于 $j=1$，成本是 $1$ 次浮点运算（一次平方根）。公式 $2j-1$ 在 $j=1$ 时也得到 $1$，因此它普遍适用。\n\n对于非对角元 $l_{ij}$（$i > j$）：\n从 $a_{ij} = \\sum_{k=1}^{j} l_{ik} l_{jk} = \\sum_{k=1}^{j-1} l_{ik} l_{jk} + l_{ij} l_{jj}$，我们求解 $l_{ij}$：\n$$l_{ij} = \\frac{1}{l_{jj}} \\left( a_{ij} - \\sum_{k=1}^{j-1} l_{ik} l_{jk} \\right)$$\n- 求和 $\\sum_{k=1}^{j-1} l_{ik} l_{jk}$ 是两个长度为 $j-1$ 的向量的内积，需要 $j-1$ 次乘法和 $j-2$ 次加法（对于 $j>1$）。\n- 计算 $l_{ij}$ 接着需要一次减法和一次除法。\n- 计算单个 $l_{ij}$ 的浮点运算次数为 $(j-1) + (j-2) + 1 + 1 = 2j-1$ 次浮点运算（对于 $j>1$）。对于 $j=1$，成本是 $1$ 次浮点运算（一次除法），这也由公式 $2j-1$ 给出。\n\n第 $j$ 列的总浮点运算次数是计算 $l_{jj}$ 和 $n-j$ 个元素 $l_{ij}$（其中 $i=j+1, \\dots, n$）的成本之和。\n第 $j$ 列的成本：\n$$C_j = (2j-1) + (n-j)(2j-1) = (1+n-j)(2j-1)$$\n\n分解的总浮点运算次数 $C_{fact}$ 是所有列的成本之和：\n$$C_{fact} = \\sum_{j=1}^{n} (n-j+1)(2j-1) = \\sum_{j=1}^{n} (-2j^2 + (2n+3)j - (n+1))$$\n使用标准幂和公式 $\\sum j = \\frac{n(n+1)}{2}$ 和 $\\sum j^2 = \\frac{n(n+1)(2n+1)}{6}$：\n$$C_{fact} = -2 \\left( \\frac{n(n+1)(2n+1)}{6} \\right) + (2n+3) \\left( \\frac{n(n+1)}{2} \\right) - n(n+1)$$\n$$C_{fact} = n(n+1) \\left[ -\\frac{2n+1}{3} + \\frac{2n+3}{2} - 1 \\right] = n(n+1) \\left[ \\frac{-2(2n+1) + 3(2n+3) - 6}{6} \\right]$$\n$$C_{fact} = n(n+1) \\left[ \\frac{(-4n - 2) + (6n + 9) - 6}{6} \\right] = n(n+1) \\left[ \\frac{2n+1}{6} \\right] = \\frac{n(n+1)(2n+1)}{6}$$\n将此多项式展开得到：\n$$C_{fact} = \\frac{n(2n^2 + 3n + 1)}{6} = \\frac{2n^3 + 3n^2 + n}{6} = \\frac{n^3}{3} + \\frac{n^2}{2} + \\frac{n}{6}$$\n这表明分解成本确实是 $\\frac{n^3}{3} + \\mathcal{O}(n^2)$。\n\n**2. 三角求解的浮点运算次数**\n\n**前向代入 ($L y = b$):**\n我们求解 $y_i$（其中 $i=1, \\dots, n$）：\n$$y_i = \\frac{1}{l_{ii}} \\left( b_i - \\sum_{j=1}^{i-1} l_{ij} y_j \\right)$$\n对于每个 $i$，计算内积需要 $i-1$ 次乘法和 $i-2$ 次加法。然后进行一次减法和一次除法。总计 $(i-1) + (i-2) + 1 + 1 = 2i-1$ 次浮点运算（对于 $i>1$）。对于 $i=1$，是 1 次除法。\n总次数 $C_{fwd} = 1 + \\sum_{i=2}^{n} (2i-1) = n^2$。\n\n**回代 ($L^{\\top} x = y$):**\n求解过程的结构与前向代入对称，因此浮点运算次数相同。\n$$C_{bwd} = n^2$$\n\n**3. 总浮点运算次数**\n\n对 $A$ 进行因式分解并求解 $A x = b$ 的总浮点运算次数是三个阶段成本的总和：\n$$C_{total} = C_{fact} + C_{fwd} + C_{bwd}$$\n$$C_{total} = \\left( \\frac{2n^3 + 3n^2 + n}{6} \\right) + n^2 + n^2$$\n$$C_{total} = \\frac{2n^3 + 3n^2 + n + 12n^2}{6}$$\n$$C_{total} = \\frac{2n^3 + 15n^2 + n}{6}$$\n这就是精确总浮点运算次数的简化闭式多项式表达式。", "answer": "$$\\boxed{\\frac{2n^3 + 15n^2 + n}{6}}$$", "id": "3370813"}, {"introduction": "在掌握了标准的“分解-求解”流程的成本后，一个自然的问题是：如果我们先计算出矩阵的逆，然后直接用矩阵乘法来求解，会不会更高效，尤其是在处理多个右端项时？本练习将通过计算显式求逆的代价，来深入探讨这一问题。你将量化比较“分解-求解”与“分解-求逆-应用”这两种策略的计算成本，从而揭示数值线性代数中的一个重要准则 [@problem_id:3562008]。", "problem": "考虑一个稠密对称正定矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和一个稠密右端矩阵 $B \\in \\mathbb{R}^{n \\times p}$。您希望计算满足 $A X = B$ 的矩阵 $X \\in \\mathbb{R}^{n \\times p}$。假设采用以下浮点运算计数模型：每次标量加法、减法、乘法或除法计为一次浮点运算（flop），并忽略数据移动和内存效应。\n\n考虑以下两种策略：\n\n1. 分解并求解：计算 Cholesky 分解 $A = L L^{\\top}$（其中 $L$ 为下三角矩阵），然后通过前向替换求解 $L Y = B$，再通过回代求解 $L^{\\top} X = Y$。\n2. 分解-求逆-应用：计算 Cholesky 分解 $A = L L^{\\top}$，然后通过三角矩阵求逆（求解 $L Z = I$ 得到 $Z = L^{-1}$）显式地构造 $L^{-1}$，最后计算 $Y = L^{-1} B$ 和 $X = L^{-\\top} Y$。\n\n从运算计数的第一性原理出发，通过将三角矩阵求逆 $L^{-1}$ 建模为求解以单位矩阵的各列作为右端的 $n$ 个三角方程组，来推导其浮点运算次数。仔细计算每列所需的算术运算次数，然后对所有列求和，以获得一个关于 $n$ 的闭式表达式。然后比较这两种策略的总浮点运算次数，并提取对于稠密数据，策略 2 相对于策略 1 的首项额外成本。\n\n请将您的最终答案表示为策略 2 相对于策略 1 的额外浮点运算次数的单个简化首项（关于 $n$ 的项）。无需四舍五入，也不涉及单位。", "solution": "该问题要求比较求解线性系统族 $AX=B$ 两种策略的浮点运算（flop）成本。我们将分别计算两种策略的总成本，然后求其差值的主导项。\n\n### 策略 1：分解并求解\n\n该策略包含三个步骤，其主导项成本是数值线性代数中的标准结果：\n1.  **Cholesky 分解 $A=LL^\\top$**：成本 $C_{chol} = \\frac{1}{3}n^3 + \\mathcal{O}(n^2)$ 次浮点运算。\n2.  **前向替换求解 $LY=B$**：这相当于对 $p$ 个右端向量分别进行前向替换。单次前向替换成本为 $n^2$ 次浮点运算。因此，总成本 $C_{fwd} = p n^2 + \\mathcal{O}(pn)$。\n3.  **回代求解 $L^\\top X=Y$**：与前向替换类似，总成本 $C_{bwd} = p n^2 + \\mathcal{O}(pn)$。\n\n策略 1 的总成本 $C_1$ 是以上各项之和：\n$$ C_1 = \\left(\\frac{1}{3}n^3\\right) + (pn^2) + (pn^2) + \\mathcal{O}(n^2) = \\frac{1}{3}n^3 + 2pn^2 + \\mathcal{O}(n^2) $$\n\n### 策略 2：分解-求逆-应用\n\n根据问题描述，该策略包含四个步骤：\n1.  **Cholesky 分解 $A=LL^\\top$**：成本与策略 1 相同，即 $C_{chol} = \\frac{1}{3}n^3 + \\mathcal{O}(n^2)$。\n\n2.  **显式构造 $L^{-1}$**：这需要求解矩阵方程 $LZ=I$，其中 $Z=L^{-1}$。由于 $L$ 是下三角矩阵，其逆 $Z$ 也是下三角矩阵。我们可以逐列计算 $Z$。对于第 $j$ 列 $z_j$，我们求解 $Lz_j = e_j$，其中 $e_j$ 是单位矩阵的第 $j$ 列。\n    -   对角元素 $z_{jj}$ 由 $L_{jj}z_{jj} = 1$ 得到，需要 1 次除法。\n    -   对于 $i > j$ 的非对角元素 $z_{ij}$，由方程的第 $i$ 行 $\\sum_{k=j}^{i} L_{ik}z_{kj} = 0$ 得到 $z_{ij} = -\\frac{1}{L_{ii}}\\sum_{k=j}^{i-1} L_{ik}z_{kj}$。计算此项需要 $i-j$ 次乘法和 $i-j-1$ 次加法，再加上一次减法（或乘-1）和一次除法，总计 $2(i-j)$ 次浮点运算。\n    -   计算第 $j$ 列的总成本为 $1 + \\sum_{i=j+1}^{n} 2(i-j)$。令 $k=i-j$，则该和为 $1 + \\sum_{k=1}^{n-j} 2k = 1 + 2\\frac{(n-j)(n-j+1)}{2} = 1 + (n-j)(n-j+1)$。\n    -   求逆的总成本 $C_{invL}$ 是对所有列的成本求和：\n        $$ C_{invL} = \\sum_{j=1}^{n} \\left(1 + (n-j)(n-j+1)\\right) $$\n        其主导项为 $\\sum_{j=1}^{n} (n-j)^2$。令 $k=n-j$，则求和变为 $\\sum_{k=0}^{n-1} k^2 = \\frac{(n-1)n(2n-1)}{6} = \\frac{1}{3}n^3 + \\mathcal{O}(n^2)$。\n    因此，显式构造 $L^{-1}$ 的成本为 $\\frac{1}{3}n^3 + \\mathcal{O}(n^2)$。\n\n3.  **计算 $Y=L^{-1}B$**：这是下三角矩阵与稠密矩阵的乘法。对于 $B$ 的每一列 $b_k$，计算 $y_k = L^{-1}b_k$ 需要 $n^2$ 次浮点运算。因此，总成本 $C_{mult1} = pn^2 + \\mathcal{O}(pn)$。\n\n4.  **计算 $X=L^{-\\top}Y$**：这是上三角矩阵与稠密矩阵的乘法，成本与上一步类似，$C_{mult2} = pn^2 + \\mathcal{O}(pn)$。\n\n策略 2 的总成本 $C_2$ 是以上各项之和：\n$$ C_2 = \\left(\\frac{1}{3}n^3\\right) + \\left(\\frac{1}{3}n^3\\right) + (pn^2) + (pn^2) + \\mathcal{O}(n^2) = \\frac{2}{3}n^3 + 2pn^2 + \\mathcal{O}(n^2) $$\n\n### 成本比较\n\n策略 2 相对于策略 1 的额外成本是 $C_2 - C_1$。我们只关心主导项：\n$$ \\text{额外成本} = C_2 - C_1 = \\left(\\frac{2}{3}n^3 + 2pn^2\\right) - \\left(\\frac{1}{3}n^3 + 2pn^2\\right) + \\mathcal{O}(n^2) $$\n$$ \\text{额外成本} = \\frac{1}{3}n^3 + \\mathcal{O}(n^2) $$\n\n因此，策略 2 相对于策略 1 的额外浮点运算次数的首项是 $\\frac{n^3}{3}$。这笔巨大的额外开销来自于显式计算 $L$ 的逆矩阵，而这在策略 1 中通过高效的三角求解得以避免。这说明了数值线性代数中的一个基本原则：应尽可能求解线性系统，而不是计算并使用显式逆矩阵。", "answer": "$$\\boxed{\\frac{n^3}{3}}$$", "id": "3562008"}, {"introduction": "对于大规模问题，稠密矩阵的 $\\mathcal{O}(n^3)$ 复杂度是难以接受的。幸运的是，许多科学与工程应用（如偏微分方程数值解）产生的矩阵是稀疏的，这为降低计算复杂度提供了可能。本练习将带你领略矩阵排序算法的威力，特别是针对稀疏矩阵的嵌套剖分（nested dissection）方法。你将通过建立并求解一个递推关系，来分析稀疏 Cholesky 分解的计算量 [@problem_id:3561956]。这个过程会让你明白，通过利用矩阵的结构，我们如何能将计算复杂度从 $\\mathcal{O}(n^3)$ 显著降低至 $\\mathcal{O}(n^{3/2})$。", "problem": "考虑一个方形网格图上的二维离散化，有 $n$ 个未知数，其中 $n$ 假定为2的幂，即对于某个整数 $k \\geq 0$，有 $n = 2^{k}$。其对应的矩阵是对称正定（SPD）矩阵。一种基于平面图分隔符的嵌套剖分排序通过移除一个大小为 $s = \\alpha \\sqrt{n}$（其中 $\\alpha \\in (0,\\infty)$ 为某个固定常数）的分隔符，将图划分为两个大小各为 $n/2$ 的子图。假设在消去每个子图的内部节点后，分隔块是维度为 $s \\times s$ 的稠密矩阵，并且其Cholesky分解的成本为 $(1/3) s^{3}$ 次浮点运算（flops），这与经过充分检验的SPD矩阵的稠密Cholesky代价模型一致。所有其他与分隔符相关的操作（例如更新限制在分隔符上的舒尔补）均假定为低阶项，并可以被归入相同的常数倍数中。\n\n1. 仅使用分隔符属性 $s = \\alpha \\sqrt{n}$ 和稠密Cholesky代价模型，为嵌套剖分下稀疏Cholesky分解的总浮点运算次数 $T(n)$ 建立一个形如\n$$\nT(n) \\;=\\; 2\\,T\\!\\left(\\frac{n}{2}\\right) \\;+\\; c\\,n^{3/2},\n$$\n的递推关系，并用 $\\alpha$ 显式表达常数 $c$。\n\n2. 在基准条件 $T(1) = 0$下，为 $n = 2^{k}$ 精确求解该递推关系，并将结果化简为关于 $n$ 和 $c$ 的单一闭式表达式。你的最终答案必须以这个单一的闭式解析表达式给出；不需要也不允许进行数值近似。", "solution": "该问题要求完成两项任务：首先，为一个特定问题类别上使用嵌套剖分的稀疏Cholesky分解的总浮点运算（flop）次数建立一个递推关系；其次，求解这个递推关系。对问题陈述的验证证实了它具有科学依据、是良定的、客观的且内部一致的。它提出了一个用于分析嵌套剖分复杂度的标准（尽管是简化的）模型。\n\n第一部分：建立递推关系。\n\n对于一个大小为 $n$ 的问题，总浮点运算次数（记为 $T(n)$）由一个分治策略确定。嵌套剖分算法将未知数图划分为两个大小为 $n/2$ 的子图和一个分隔符。总计算代价是递归处理两个子图的代价与处理分隔符的代价之和。\n\n递归调用对总代价的贡献为 $2 T(n/2)$。\n\n在给定的递归层级，与分隔符相关的代价据称主要由对应于分隔节点的稠密矩阵的Cholesky分解决定。该矩阵是在子图的内部节点被消去后产生的，这个过程在分隔变量上形成了舒尔补。\n\n问题为确定此代价提供了以下已知条件：\n1. 分隔符的大小为 $s = \\alpha \\sqrt{n}$，其中 $\\alpha$ 是一个正常数。\n2. $s \\times s$ 维稠密分隔块的Cholesky分解代价为 $(1/3) s^3$ 次浮点运算。\n3. 根据问题陈述的简化，所有其他与分隔符相关的代价都是低阶的，在主阶分析中可以忽略。\n\n令 $W(n)$ 为在递归顶层对大小为 $n$ 的问题所做的工作量。根据所提供的模型，这项工作是分解稠密分隔块的代价：\n$$\nW(n) = \\frac{1}{3}s^3\n$$\n将分隔符大小 $s$ 关于 $n$ 的表达式代入：\n$$\nW(n) = \\frac{1}{3} (\\alpha \\sqrt{n})^3 = \\frac{1}{3} \\alpha^3 (n^{1/2})^3 = \\frac{1}{3} \\alpha^3 n^{3/2}\n$$\n总代价 $T(n)$ 是递归调用的代价与当前层级工作量之和：\n$$\nT(n) = 2 T\\left(\\frac{n}{2}\\right) + W(n) = 2 T\\left(\\frac{n}{2}\\right) + \\frac{\\alpha^3}{3} n^{3/2}\n$$\n问题要求此递推关系的形式为 $T(n) = 2 T(n/2) + c n^{3/2}$。通过直接比较，我们可以确定常数 $c$：\n$$\nc = \\frac{\\alpha^3}{3}\n$$\n\n第二部分：求解递推关系。\n\n我们被要求求解递推关系\n$$\nT(n) = 2 T\\left(\\frac{n}{2}\\right) + c n^{3/2}\n$$\n其基准条件为 $T(1) = 0$，对于 $n = 2^k$，其中 $k$ 是一个非负整数。\n\n令 $n = 2^k$。则 $k = \\log_2 n$。该递推关系可以用 $k$ 重写：\n$$\nT(2^k) = 2 T(2^{k-1}) + c (2^k)^{3/2} = 2 T(2^{k-1}) + c 2^{3k/2}\n$$\n我们通过展开递推式（也称为迭代法）来求解：\n$$\n\\begin{aligned}\nT(n) = T(2^k) = 2 T(2^{k-1}) + c (2^k)^{3/2} \\\\\n= 2 \\left[ 2 T(2^{k-2}) + c (2^{k-1})^{3/2} \\right] + c (2^k)^{3/2} \\\\\n= 2^2 T(2^{k-2}) + 2 c (2^{k-1})^{3/2} + c (2^k)^{3/2} \\\\\n= 2^3 T(2^{k-3}) + 2^2 c (2^{k-2})^{3/2} + 2 c (2^{k-1})^{3/2} + c (2^k)^{3/2} \\\\\n\\;\\;\\vdots \\\\\n= 2^i T(2^{k-i}) + \\sum_{j=0}^{i-1} 2^j c (2^{k-j})^{3/2}\n\\end{aligned}\n$$\n我们展开直到达到基准情形，即 $n=1$ 或 $2^0$。这对应于设置 $i=k$：\n$$\nT(n) = T(2^k) = 2^k T(2^0) + \\sum_{j=0}^{k-1} 2^j c (2^{k-j})^{3/2}\n$$\n给定基准条件 $T(1) = T(2^0) = 0$，第一项为零。我们剩下求和部分：\n$$\nT(n) = \\sum_{j=0}^{k-1} 2^j c (2^{k-j})^{3/2}\n$$\n我们来化简求和式中的项：\n$$\n2^j c (2^{k-j})^{3/2} = c \\cdot 2^j \\cdot (2^k)^{3/2} \\cdot (2^{-j})^{3/2} = c \\cdot n^{3/2} \\cdot 2^j \\cdot 2^{-3j/2} = c \\cdot n^{3/2} \\cdot 2^{-j/2}\n$$\n将此代回求和式：\n$$\nT(n) = \\sum_{j=0}^{k-1} c n^{3/2} 2^{-j/2} = c n^{3/2} \\sum_{j=0}^{k-1} \\left(2^{-1/2}\\right)^j = c n^{3/2} \\sum_{j=0}^{k-1} \\left(\\frac{1}{\\sqrt{2}}\\right)^j\n$$\n该求和是一个有限几何级数，首项 $a=1$，公比 $r = 1/\\sqrt{2}$，共有 $k$ 项。其和由公式 $\\sum_{j=0}^{k-1} r^j = \\frac{1-r^k}{1-r}$ 给出。\n$$\n\\sum_{j=0}^{k-1} \\left(\\frac{1}{\\sqrt{2}}\\right)^j = \\frac{1 - (1/\\sqrt{2})^k}{1 - 1/\\sqrt{2}}\n$$\n我们用 $n$ 来表示 $(1/\\sqrt{2})^k$。因为 $k = \\log_2 n$：\n$$\n\\left(\\frac{1}{\\sqrt{2}}\\right)^k = (2^{-1/2})^k = 2^{-k/2} = (2^k)^{-1/2} = n^{-1/2}\n$$\n将此代入求和公式：\n$$\n\\text{和} = \\frac{1 - n^{-1/2}}{1 - 1/\\sqrt{2}}\n$$\n现在，将此代回 $T(n)$ 的表达式中：\n$$\nT(n) = c n^{3/2} \\left( \\frac{1 - n^{-1/2}}{1 - 1/\\sqrt{2}} \\right)\n$$\n为了得到所要求的单一闭式表达式，我们化简此结果。\n首先，化简常数因子：\n$$\n\\frac{1}{1 - 1/\\sqrt{2}} = \\frac{1}{\\frac{\\sqrt{2}-1}{\\sqrt{2}}} = \\frac{\\sqrt{2}}{\\sqrt{2}-1}\n$$\n为了有理化分母，我们将分子和分母同乘以共轭式 $(\\sqrt{2}+1)$：\n$$\n\\frac{\\sqrt{2}}{\\sqrt{2}-1} \\times \\frac{\\sqrt{2}+1}{\\sqrt{2}+1} = \\frac{\\sqrt{2}(\\sqrt{2}+1)}{(\\sqrt{2})^2 - 1^2} = \\frac{2+\\sqrt{2}}{2-1} = 2+\\sqrt{2}\n$$\n现在，我们可以将 $T(n)$ 写为：\n$$\nT(n) = c (2+\\sqrt{2}) n^{3/2} (1 - n^{-1/2})\n$$\n分配 $n^{3/2}$ 项：\n$$\nT(n) = c (2+\\sqrt{2}) (n^{3/2} \\cdot 1 - n^{3/2} \\cdot n^{-1/2}) = c (2+\\sqrt{2}) (n^{3/2} - n^1)\n$$\n这就得到了关于 $n$ 和 $c$ 的总浮点运算次数的最终闭式表达式：\n$$\nT(n) = c(2+\\sqrt{2})(n^{3/2} - n)\n$$", "answer": "$$\n\\boxed{c(2+\\sqrt{2})(n^{3/2}-n)}\n$$", "id": "3561956"}]}