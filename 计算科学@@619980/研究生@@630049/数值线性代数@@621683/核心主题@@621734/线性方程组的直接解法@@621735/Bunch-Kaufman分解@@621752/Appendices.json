{"hands_on_practices": [{"introduction": "在处理对称不定矩阵时，一个核心的挑战是确保数值稳定性。天真地选择对角线上一个很小的元素作为主元，可能会导致计算过程中元素的灾难性增长，从而严重破坏精度。本练习旨在通过一个精心设计的例子，清晰地揭示这一风险，并展示 Bunch-Kaufman 算法的 $2 \\times 2$ 分块主元策略是如何有效控制误差增长、保证分解过程的稳定性的。[@problem_id:3535905]", "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是对称不定矩阵\n$$\nA(\\delta,M,t) \\;=\\;\n\\begin{pmatrix}\n\\delta   M  0  0 \\\\\nM  \\delta  t  t \\\\\n0  t  \\delta  t \\\\\n0  t  t  \\delta\n\\end{pmatrix},\n$$\n其中 $\\delta  0$ 很小，$M  0$ 很大，且 $t  0$ 的数量级为 $1$。考虑对 $A$ 进行两种第一步对称消去：\n\n1.  不使用主元选择的朴素对称高斯消去法，它使用 $1 \\times 1$ 主元 $a_{11} = \\delta$。\n\n2.  Bunch–Kaufman (BK) 分解，它使用索引 $\\{1,2\\}$ 上的 $2 \\times 2$ 主元，即前导分块\n$$\nB \\;=\\; \\begin{pmatrix} \\delta   M \\\\ M   \\delta \\end{pmatrix},\n$$\n并在消去前两行和前两列后形成尾随舒尔补。\n\n为第一步消去定义以下元素增长度量：\n\n- 朴素增长因子\n$$\n\\gamma_{\\mathrm{naive}} \\;=\\; \\frac{\\max\\{\\,|a_{ij}^{(1)}| \\text{ 在第一次舒尔补更新中产生的}\\,\\}}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $a_{ij}^{(1)}$ 表示在第一个舒尔补中产生的元素。\n\n- Bunch–Kaufman 增长因子\n$$\n\\gamma_{\\mathrm{BK}} \\;=\\; \\frac{\\max\\{\\,|s_{ij}| \\text{ 在第一个尾随舒尔补中}\\,\\}}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $S = (s_{ij})$ 是通过消去 $2 \\times 2$ 主元 $B$ 得到的第一个尾随舒尔补。\n\n仅使用高斯消去法、舒尔补和对称矩阵分块消去法的基本定义，推导 $\\gamma_{\\mathrm{naive}}$ 和 $\\gamma_{\\mathrm{BK}}$ 关于 $\\delta$、$M$ 和 $t$ 的显式表达式。然后，对于具体参数 $\\delta = 10^{-8}$、$M = 10^{4}$ 和 $t = 1$，计算比率\n$$\nG \\;=\\; \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}.\n$$\n将 $G$ 的最终数值四舍五入到四位有效数字。最终答案以纯数形式表示（无单位）。", "solution": "本题要求我们分析在给定矩阵 $A$ 上两种不同对称消去方法的第一步，推导元素增长因子，并为特定参数值计算它们的比率。\n\n### 第一步：提取已知条件\n- 矩阵是 $A \\in \\mathbb{R}^{4 \\times 4}$，对称不定：\n$$\nA(\\delta,M,t) =\n\\begin{pmatrix}\n\\delta   M  0  0 \\\\\nM  \\delta  t  t \\\\\n0  t  \\delta  t \\\\\n0  t  t  \\delta\n\\end{pmatrix}\n$$\n- 参数为 $\\delta  0$ (小值)，$M  0$ (大值)，以及 $t  0$ (数量级为 $1$ )。\n- 用于计算的具体参数值：$\\delta = 10^{-8}$，$M = 10^{4}$，和 $t = 1$。\n- 方法1 (朴素法)：使用 $1 \\times 1$ 主元 $a_{11} = \\delta$ 的对称高斯消去法。\n- 方法2 (Bunch-Kaufman)：使用 $2 \\times 2$ 主元 $B = \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}$ 的对称消去法。\n- 朴素增长因子定义：\n$$\n\\gamma_{\\mathrm{naive}} = \\frac{\\max\\{\\,|a_{ij}^{(1)}| \\text{ 在第一个舒尔补中}\\,\\}}{\\max_{i,j} |a_{ij}|}\n$$\n- Bunch-Kaufman 增长因子定义：\n$$\n\\gamma_{\\mathrm{BK}} = \\frac{\\max\\{\\,|s_{ij}| \\text{ 在第一个尾随舒尔补中}\\,\\}}{\\max_{i,j} |a_{ij}|}\n$$\n- 最终任务是计算比率 $G = \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}$ 并将其四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是科学严谨、适定且客观的。\n1.  **科学严谨性**：问题源于数值线性代数，涉及高斯消去法、Bunch-Kaufman 分解、舒尔补和数值稳定性（元素增长）等标准、成熟的概念。所有定义和过程都是标准的。\n2.  **适定性**：矩阵和所有参数都已明确定义。推导表达式和计算比率的任务是明确的，可以得到唯一且有意义的解。\n3.  **客观性**：问题以精确的数学语言陈述，没有任何主观性或歧义。参数的条件（$\\delta$ 很小，$M$ 很大，$t$ 的数量级为 $1$）是分析数值算法在挑战性场景下行为的典型设置。\n\n问题是有效的。\n\n### 第三步：推导与求解\n\n过程将是首先推导 $\\gamma_{\\mathrm{naive}}$ 和 $\\gamma_{\\mathrm{BK}}$ 的解析表达式，然后推导它们的比率 $G$ 的表达式，最后计算 $G$ 的数值。\n\n两个增长因子的分母都需要原始矩阵 $A$ 中元素的最大绝对值。鉴于 $M$ 很大，$\\delta$ 很小，$t$ 的数量级为 $1$：\n$$\n\\max_{i,j} |a_{ij}| = \\max\\{|\\delta|, |M|, |0|, |t|\\} = M\n$$\n\n**1. 朴素对称消去增长因子 ($\\gamma_{\\mathrm{naive}}$)**\n\n我们使用 $1 \\times 1$ 主元 $a_{11} = \\delta$ 执行一步对称高斯消去法。矩阵 $A$ 分块如下：\n$$\nA = \\begin{pmatrix} a_{11}  v^T \\\\ v  A_{22} \\end{pmatrix} = \\begin{pmatrix} \\delta  \\begin{pmatrix} M  0  0 \\end{pmatrix} \\\\ \\begin{pmatrix} M \\\\ 0 \\\\ 0 \\end{pmatrix}  \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} \\end{pmatrix}\n$$\n第一个舒尔补 $A^{(1)}$ 由下式给出：\n$$\nA^{(1)} = A_{22} - \\frac{1}{a_{11}} v v^T = \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} M \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} M  0  0 \\end{pmatrix}\n$$\n$$\nA^{(1)} = \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} M^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\delta - \\frac{M^2}{\\delta}  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix}\n$$\n该舒尔补中元素的最大绝对值为：\n$$\n\\max |a_{ij}^{(1)}| = \\max \\left\\{ \\left|\\delta - \\frac{M^2}{\\delta}\\right|, |t|, |\\delta| \\right\\}\n$$\n因为 $\\delta  0$ 很小且 $M  0$ 很大，所以 $M^2/\\delta \\gg \\delta$ 且 $M^2/\\delta \\gg t$。因此：\n$$\n\\max |a_{ij}^{(1)}| = \\left|\\delta - \\frac{M^2}{\\delta}\\right| = \\frac{M^2}{\\delta} - \\delta\n$$\n朴素增长因子为：\n$$\n\\gamma_{\\mathrm{naive}} = \\frac{\\max |a_{ij}^{(1)}|}{\\max |a_{ij}|} = \\frac{\\frac{M^2}{\\delta} - \\delta}{M} = \\frac{M}{\\delta} - \\frac{\\delta}{M}\n$$\n\n**2. Bunch-Kaufman 增长因子 ($\\gamma_{\\mathrm{BK}}$)**\n\n我们使用 $2 \\times 2$ 分块主元 $B = \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}$。矩阵 $A$ 分块如下：\n$$\nA = \\begin{pmatrix} B  C^T \\\\ C  D \\end{pmatrix} = \\begin{pmatrix} \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}  \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix} \\\\ \\begin{pmatrix} 0  t \\\\ 0  t \\end{pmatrix}  \\begin{pmatrix} \\delta  t \\\\ t  \\delta \\end{pmatrix} \\end{pmatrix}\n$$\n尾随舒尔补 $S$ 由 $S = D - C B^{-1} C^T$ 给出。首先，我们计算 $B$ 的逆矩阵：\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix} = \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix}\n$$\n现在，我们计算乘积 $C B^{-1} C^T$：\n$$\nC B^{-1} C^T = \\begin{pmatrix} 0  t \\\\ 0  t \\end{pmatrix} \\left( \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix} \\right) \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix}\n$$\n$$\n= \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} -Mt  \\delta t \\\\ -Mt  \\delta t \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix} = \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta t^2  \\delta t^2 \\\\ \\delta t^2  \\delta t^2 \\end{pmatrix}\n$$\n舒尔补 $S = (s_{ij})$ 是：\n$$\nS = \\begin{pmatrix} \\delta  t \\\\ t  \\delta \\end{pmatrix} - \\frac{\\delta t^2}{\\delta^2 - M^2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} \\delta - \\frac{\\delta t^2}{\\delta^2-M^2}  t - \\frac{\\delta t^2}{\\delta^2-M^2} \\\\ t - \\frac{\\delta t^2}{\\delta^2-M^2}  \\delta - \\frac{\\delta t^2}{\\delta^2-M^2} \\end{pmatrix}\n$$\n$S$ 中元素的最大绝对值是 $\\max|s_{ij}|$。因为 $\\delta^2 - M^2  0$，我们可以写成 $s_{12} = t + \\frac{\\delta t^2}{M^2 - \\delta^2}$。由于 $\\delta, t  0$ 且 $M  \\delta$，第二项是一个小的正数。由于 $t$ 的数量级为 $1$ 而 $\\delta$ 很小，量级最大的元素将是 $|s_{12}| = |s_{21}|$。\n$$\n\\max |s_{ij}| = \\left| t - \\frac{\\delta t^2}{\\delta^2 - M^2} \\right| = \\left| t + \\frac{\\delta t^2}{M^2 - \\delta^2} \\right| = t + \\frac{\\delta t^2}{M^2 - \\delta^2}\n$$\nBunch-Kaufman 增长因子是：\n$$\n\\gamma_{\\mathrm{BK}} = \\frac{\\max |s_{ij}|}{\\max |a_{ij}|} = \\frac{t + \\frac{\\delta t^2}{M^2 - \\delta^2}}{M} = \\frac{t}{M} + \\frac{\\delta t^2}{M(M^2 - \\delta^2)}\n$$\n\n**3. 比率 $G$**\n\n我们计算比率 $G = \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}$。\n$$\nG = \\frac{\\frac{M}{\\delta} - \\frac{\\delta}{M}}{\\frac{t}{M} + \\frac{\\delta t^2}{M(M^2 - \\delta^2)}} = \\frac{\\frac{M^2 - \\delta^2}{M\\delta}}{\\frac{t(M^2-\\delta^2) + \\delta t^2}{M(M^2 - \\delta^2)}}\n$$\n$$\nG = \\frac{M^2 - \\delta^2}{M\\delta} \\cdot \\frac{M(M^2 - \\delta^2)}{t(M^2 - \\delta^2) + \\delta t^2} = \\frac{(M^2 - \\delta^2)^2}{\\delta \\left( t(M^2 - \\delta^2) + \\delta t^2 \\right)}\n$$\n这是 $G$ 的最终解析表达式。\n\n**4. 数值计算**\n\n我们代入给定值：$\\delta = 10^{-8}$，$M = 10^{4}$，和 $t = 1$。\n首先，我们计算关键部分：\n- $M^2 = (10^4)^2 = 10^8$\n- $\\delta^2 = (10^{-8})^2 = 10^{-16}$\n- $M^2 - \\delta^2 = 10^8 - 10^{-16}$\n\n现在代入 $G$ 的表达式：\n$$\nG = \\frac{(10^8 - 10^{-16})^2}{10^{-8} \\left( 1 \\cdot (10^8 - 10^{-16}) + 1^2 \\cdot 10^{-8} \\right)}\n$$\n$$\nG = \\frac{(10^8 - 10^{-16})^2}{10^{-8} (10^8 - 10^{-16} + 10^{-8})} = \\frac{(10^8 - 10^{-16})^2}{1 - 10^{-24} + 10^{-16}}\n$$\n让我们通过分解出主导项来分析该表达式。\n先验近似为 $G \\approx \\frac{(M^2)^2}{\\delta(t M^2)} = \\frac{M^2}{t \\delta} = \\frac{10^8}{1 \\cdot 10^{-8}} = 10^{16}$。\n让我们找一个更精确的值。\n$$\nG = \\frac{10^{16}(1 - 10^{-24})^2}{1 + 10^{-16} - 10^{-24}} \\approx \\frac{10^{16}(1 - 2 \\cdot 10^{-24})}{1 + 10^{-16}}\n$$\n对于小 $x$ 使用近似 $\\frac{1}{1+x} \\approx 1-x$：\n$$\nG \\approx 10^{16}(1 - 2 \\cdot 10^{-24})(1 - 10^{-16}) \\approx 10^{16}(1 - 10^{-16} - 2 \\cdot 10^{-24}) = 10^{16} - 1 - 2 \\cdot 10^{-8}\n$$\n该值非常接近 $10^{16} - 1$。\n从精确表达式计算值：\n$G = 9999999999999998.99999998...$\n用科学记数法表示，这是 $9.9999999999999989... \\times 10^{15}$。\n我们需要将这个值四舍五入到四位有效数字。前四位有效数字是 $9.999$。第五位有效数字是 $9$，它 $\\ge 5$。因此，我们将第四位数字向上取整。\n将 $9.999$ 向上取整得到 $10.00$。\n所以，四舍五入到四位有效数字的值是 $10.00 \\times 10^{15}$。\n这必须用标准的科学记数法表示，其中有效数在 $1$ 和 $10$ 之间。\n$10.00 \\times 10^{15} = (1.000 \\times 10^1) \\times 10^{15} = 1.000 \\times 10^{16}$。", "answer": "$$ \\boxed{1.000 \\times 10^{16}} $$", "id": "3535905"}, {"introduction": "理解了 Bunch-Kaufman 算法背后的稳定性动机后，亲自动手完成一次完整的分解是掌握其核心机制的最佳方式。本练习将引导你对一个 $4 \\times 4$ 对称不定矩阵进行完整的手动分解，重点实践主元选择的判断准则（涉及参数 $\\alpha$），并熟练掌握针对 $1 \\times 1$ 和 $2 \\times 2$ 两种主元类型的分块消元过程。[@problem_id:3535826]", "problem": "考虑由下式给出的对称不定矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$：\n$$\nA \\;=\\; \\begin{pmatrix}\n0   2  0  0 \\\\\n2  1  1  0 \\\\\n0  1  3  1 \\\\\n0  0  1  2\n\\end{pmatrix}.\n$$\n使用 Bunch–Kaufman (BK) 对角主元法，并取标准阈值参数 $\\alpha \\,=\\, \\dfrac{1+\\sqrt{17}}{8}$，手动对 $A$ 进行形式为\n$$\nA \\;=\\; P^{\\top} \\, L \\, D \\, L^{\\top} \\, P,\n$$\n的对称不定分解，其中 $P$ 是一个置换矩阵，$L$ 是单位下三角矩阵（其中可能的 $2 \\times 2$ 主元耦合反映在次对角块列中），$D$ 是块对角矩阵，其对角块为 $1 \\times 1$ 和 $2 \\times 2$ 的对称块。明确地给出 $P$、$L$ 和 $D$。然后，仅使用你的分解结果（不通过其他方式直接展开 $\\det(A)$），计算 $A$ 的行列式，将其表示为一个精确的标量值。将最终答案表示为一个精确的整数。不要进行四舍五入。", "solution": "本题的目标是找到矩阵 $A$ 的 Bunch-Kaufman 分解，然后计算其行列式。\n\n### 问题验证\n给定问题是数值线性代数中一个定义明确的练习。\n- **已知**:\n    - 矩阵 $A = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  1  0 \\\\ 0  1  3  1 \\\\ 0  0  1  2 \\end{pmatrix}$。\n    - 算法为 Bunch-Kaufman 对角主元法。\n    - 阈值参数为 $\\alpha = \\frac{1+\\sqrt{17}}{8}$。\n    - 分解形式为 $A = P^{\\top} L D L^{\\top} P$。\n- **验证**:\n    - 该问题具有科学依据，使用了数值线性代数中的标准算法。\n    - 这是一个适定问题，提供了所有必要信息，可以根据算法的确定性步骤推导出唯一解。\n    - 问题是客观的，没有歧义。\n    - 所有前提条件都是事实正确的；$A$ 按要求是对称的，并且 $\\alpha$ 是一个有效的参数选择，因为 $0  \\alpha  1$。\n问题是有效的，并且可以解决。\n\n### 解题步骤\nBunch-Kaufman 分解是迭代执行的。我们旨在找到 $P$、$L$ 和 $D$，使得 $P A P^{\\top} = L D L^{\\top}$。初始时，我们设置 $P=I$，$L=I$，待分解的矩阵为 $A^{(1)} = A$。\n\n**第 1 步：选择第一个主元 (k=1)**\n\n我们处理矩阵 $A^{(1)} = A$ 的第一列。\n$$\nA^{(1)} \\;=\\; \\begin{pmatrix}\n0   2  0  0 \\\\\n2  1  1  0 \\\\\n0  1  3  1 \\\\\n0  0  1  2\n\\end{pmatrix}\n$$\n对角元素为 $a_{11}^{(1)} = 0$。我们找到第一列中绝对值最大的非对角元素：\n$$\n\\lambda_1 \\;=\\; \\max_{j1} |a_{j1}^{(1)}| \\;=\\; \\max(|2|, |0|, |0|) \\;=\\; 2\n$$\n该最大值出现在第 $r=2$ 行。\n\nBunch-Kaufman 主元选择策略需要将 $|a_{11}^{(1)}|$ 与 $\\alpha \\lambda_1$ 进行比较：\n$$\n|a_{11}^{(1)}| \\;=\\; 0 \\quad \\text{且} \\quad \\alpha \\lambda_1 \\;=\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2 \\;=\\; \\frac{1+\\sqrt{17}}{4}\n$$\n因为 $\\sqrt{17}  1$，我们有 $1+\\sqrt{17}  2$，所以 $\\frac{1+\\sqrt{17}}{4}  \\frac{1}{2}$。显然，$0  \\frac{1+\\sqrt{17}}{4}$，所以条件 $|a_{11}^{(1)}| \\ge \\alpha \\lambda_1$ 不成立。我们必须考虑行/列交换或使用一个 $2 \\times 2$ 主元。\n\n接下来，我们找到第 $r=2$ 列中最大的非对角元素（不包括第 $r=2$ 行自身的元素）：\n$$\n\\sigma_2 \\;=\\; \\max_{j \\ge 1, j \\ne 2} |a_{j2}^{(1)}| \\;=\\; \\max(|a_{12}^{(1)}|, |a_{32}^{(1)}|, |a_{42}^{(1)}|) \\;=\\; \\max(|2|, |1|, |0|) \\;=\\; 2\n$$\n第二个测试是 $|a_{11}^{(1)}| \\sigma_2 \\ge \\alpha \\lambda_1^2$：\n$$\n|0| \\cdot 2 \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2^2 \\;\\implies\\; 0 \\;\\ge\\; \\frac{1+\\sqrt{17}}{2}\n$$\n这不成立。\n\n第三个测试是 $|a_{rr}^{(1)}| \\ge \\alpha \\sigma_r$，即 $|a_{22}^{(1)}| \\ge \\alpha \\sigma_2$：\n$$\n|1| \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2 \\;\\implies\\; 1 \\;\\ge\\; \\frac{1+\\sqrt{17}}{4}\n$$\n这等价于 $4 \\ge 1+\\sqrt{17}$，或 $3 \\ge \\sqrt{17}$。由于 $3^2=9$ 且 $(\\sqrt{17})^2=17$，我们有 $9 \\not\\ge 17$。该条件不成立。\n\n由于所有三个测试都失败了，我们必须使用一个 $2 \\times 2$ 主元。主元是由第 $k=1$ 行和第 $r=2$ 行以及相应的列构成的子矩阵。置换矩阵将涉及交换第 $k+1=2$ 行与第 $r=2$ 行，这意味着没有进行实际的置换。因此，$P$ 保持为单位矩阵 $I_4$。\n$D$ 的第一个主元块是：\n$$\nD_1 \\;=\\; \\begin{pmatrix} a_{11}^{(1)}  a_{12}^{(1)} \\\\ a_{21}^{(1)}  a_{22}^{(1)} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix}\n$$\n现在，我们进行块消元。我们需要找到乘数，使得变换后元素 $a_{31}, a_{32}, a_{41}, a_{42}$ 变为零。这些乘数构成了 $L$ 的次对角线元素。\n乘数 $(l_{31}, l_{32})$ 通过求解以下方程确定：\n$$\n\\begin{pmatrix} -l_{31}  -l_{32} \\end{pmatrix} \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix} + \\begin{pmatrix} a_{31}  a_{32} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -l_{31}  -l_{32} \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} + \\begin{pmatrix} 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n这给出了方程组：\n$-2l_{32} + 0 = 0 \\implies l_{32}=0$。\n$-2l_{31} - l_{32} + 1 = 0 \\implies -2l_{31} - 0 + 1 = 0 \\implies l_{31}=1/2$。\n\n对于乘数 $(l_{41}, l_{42})$：\n$$\n\\begin{pmatrix} -l_{41}  -l_{42} \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} + \\begin{pmatrix} a_{41}  a_{42} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -l_{41}  -l_{42} \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} + \\begin{pmatrix} 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n这给出 $l_{41}=0$ 和 $l_{42}=0$。\n\n舒尔补 $S$ 是待分解的剩余子矩阵，由 $A$ 的右下角块减去更新项得到。\n$\nS = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} l_{31}  l_{32} \\\\ l_{41}  l_{42} \\end{pmatrix} D_1 \\begin{pmatrix} l_{31}  l_{32} \\\\ l_{41}  l_{42} \\end{pmatrix}^{\\top} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix}\n$\n$\n= \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1/2  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}\n$\n此阶段后的矩阵是 $A^{(2)} = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  0  0 \\\\ 0  0  3  1 \\\\ 0  0  1  2 \\end{pmatrix}$。\n\n**第 2 步：选择第二个主元 (k=3)**\n\n我们现在处理子矩阵 $S = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$，它对应于第 3 行和第 4 行以及相应的列。\n对角元素为 $s_{11}=3$。$S$ 的第一列中最大的非对角元素是 $|s_{21}| = 1$。我们称之为 $\\lambda_3=1$。\n我们检验条件 $|s_{11}| \\ge \\alpha \\lambda_3$：\n$$\n|3| \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 1 \\;\\implies\\; 24 \\;\\ge\\; 1+\\sqrt{17} \\;\\implies\\; 23 \\;\\ge\\; \\sqrt{17}\n$$\n由于 $23^2 = 529$ 且 $(\\sqrt{17})^2 = 17$，条件 $529 \\ge 17$ 成立。\n因此，我们使用一个 $1 \\times 1$ 主元，$d_3 = s_{11}=3$。不需要进行置换。\n\n我们对 $S$ 进行高斯消元。乘数为 $l = s_{21} / d_3 = 1/3$。这将是完整 $L$ 矩阵中的元素 $l_{43}$。\n更新后的元素 $s'_{22}$ 为 $s_{22} - l \\cdot s_{12} = 2 - (1/3) \\cdot 1 = 5/3$。这是我们最后的主元，$d_4 = 5/3$。\n\n**最终的分解矩阵**\n\n置换矩阵 $P$ 是单位矩阵，因为没有进行任何交换操作。\n$$\nP \\;=\\; \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\n矩阵 $D$ 是块对角矩阵，其对角块是我们找到的主元：\n$$\nD \\;=\\; \\begin{pmatrix}\n0  2  0  0 \\\\\n2  1  0  0 \\\\\n0  0  3  0 \\\\\n0  0  0  5/3\n\\end{pmatrix}\n$$\n单位下三角矩阵 $L$ 由乘数构造而成。$2 \\times 2$ 主元耦合了第 1 列和第 2 列。\n$$\nL \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\nl_{31}  l_{32}  1  0 \\\\\nl_{41}  l_{42}  l_{43}  1\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n1/2  0  1  0 \\\\\n0  0  1/3  1\n\\end{pmatrix}\n$$\n分解结果为 $A = L D L^{\\top}$。\n\n**行列式计算**\n$A$ 的行列式可以从分解式 $A = P^{\\top} L D L^{\\top} P$ 计算得出：\n$$\n\\det(A) \\;=\\; \\det(P^{\\top}) \\det(L) \\det(D) \\det(L^{\\top}) \\det(P)\n$$\n- $\\det(P) = \\det(I_4) = 1$，所以 $\\det(P^T)=1$。\n- $L$ 和 $L^{\\top}$ 是单位三角矩阵，所以它们的行列式是其对角元素的乘积，即为 $1$。\n- 因此，$\\det(A) = \\det(D)$。\n\n块对角矩阵 $D$ 的行列式是其对角块行列式的乘积：\n$$\n\\det(D) \\;=\\; \\det\\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} \\cdot \\det\\begin{pmatrix} 3  0 \\\\ 0  5/3 \\end{pmatrix}\n$$\n$$\n\\det(D) \\;=\\; \\left((0)(1) - (2)(2)\\right) \\cdot \\left((3)(5/3)\\right) \\;=\\; (-4) \\cdot (5) \\;=\\; -20\n$$\n所以，$A$ 的行列式是 $-20$。\n\n最终的显式矩阵：\n$P = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}$\n$L = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 1/2  0  1  0 \\\\ 0  0  1/3  1 \\end{pmatrix}$\n$D = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  5/3 \\end{pmatrix}$\n行列式为 $-20$。", "answer": "$$\\boxed{-20}$$", "id": "3535826"}, {"introduction": "矩阵分解的一个强大应用是诊断矩阵本身的性质，例如奇异性。本练习将演示 Bunch-Kaufman 分解如何通过产生一个零主元来直接揭示矩阵的奇异性。更重要的是，它将向你展示如何利用分解得到的因子（$L$ 和 $D$ 矩阵）来高效地计算该矩阵零空间的一个基向量，这是线性代数中的一项基本而重要的任务。[@problem_id:3535898]", "problem": "考虑由下式定义的对称矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n1   1  1  3\n\\end{pmatrix}.\n$$\n从一个基本事实出发：对称矩阵可以进行 Bunch–Kaufman 分解，也称为带对称主元选取的下三角-对角-下三角转置 (LDL$^{\\top}$) 分解，即 $A = P^{\\top} L D L^{\\top} P$，其中 $P$ 是一个置换矩阵，$L$ 是单位下三角矩阵，$D$ 是由 $1 \\times 1$ 和 $2 \\times 2$ 块构成的分块对角矩阵。Bunch–Kaufman 主元选取准则使用一个阈值参数 $\\alpha$ (经典取值为 $\\alpha = \\frac{1 + \\sqrt{17}}{8}$) 来决定选择 $1 \\times 1$ 主元还是 $2 \\times 2$ 主元。如果在第 $k$ 步的当前活动子矩阵中，满足 $|a_{kk}| \\ge \\alpha \\max_{i  k} |a_{ik}|$，则接受 $1 \\times 1$ 主元；否则，继续检验是否可采用 $2 \\times 2$ 主元。假设算术是精确的。\n\n将 Bunch–Kaufman 准则逐步应用于 $A$，以确定主元的序列（包括是否需要对称置换），并相应地执行 LDL$^{\\top}$ 分解。利用完成的分解，通过利用结构 $A = P^{\\top} L D L^{\\top} P$，推导出一个非零向量 $x \\in \\mathbb{R}^{4}$ 使得 $A x = 0$。用精确的整数分量表示你的最终向量 $x$。不需要四舍五入。你的最终答案必须是单个行向量。", "solution": "该问题要求对给定的对称矩阵 $A$ 执行 Bunch-Kaufman ($LDL^{\\top}$) 分解，然后利用该分解找到 $A$ 的零空间中的一个非零向量 $x \\in \\mathbb{R}^{4}$。\n\n给定的矩阵 $A$ 为：\n$$\nA = A^{(1)} = \\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n1   1  1  3\n\\end{pmatrix}\n$$\nBunch-Kaufman 算法通过迭代选择 $1 \\times 1$ 或 $2 \\times 2$ 主元并更新后续子矩阵来进行。该选择由一个阈值参数 $\\alpha = \\frac{1 + \\sqrt{17}}{8}$ 控制。如果当前活动子矩阵的对角元素 $a_{kk}$ 满足 $|a_{kk}| \\ge \\alpha \\max_{i  k} |a_{ik}|$，则选择 $1 \\times 1$ 主元。由于 $4^2 = 16$ 和 $5^2 = 25$，我们有 $4  \\sqrt{17}  5$。因此，$\\frac{1+4}{8}  \\alpha  \\frac{1+5}{8}$，这意味着 $0.625  \\alpha  0.75$。因此，条件 $1 \\ge \\alpha$ 是满足的。\n\n分解形式为 $A = P^{\\top}L D L^{\\top}P$。我们用 $P=I_{4}$，$L=I_{4}$ 初始化。\n\n**第一步：$A$ 的分解**\n\n**迭代 $k=1$:**\n活动矩阵是 $A^{(1)} = A$。我们考虑第一列和对角元素 $a_{11}^{(1)} = 1$。\n第一列中最大的非对角元素是 $\\lambda_1 = \\max_{i1} |a_{i1}^{(1)}| = \\max(|0|, |0|, |1|) = 1$。\n我们检查 $1 \\times 1$ 主元的条件：\n$$\n|a_{11}^{(1)}| \\ge \\alpha \\lambda_1 \\implies |1| \\ge \\alpha \\cdot 1\n$$\n由于 $1 \\ge \\alpha$，该条件满足。我们选择一个 $1 \\times 1$ 主元，$d_1 = a_{11}^{(1)} = 1$。不需要置换，因此 $P$ 仍然是单位矩阵。\n\n$L$ 的第一列的乘子按 $l_{i1} = a_{i1}^{(1)}/d_1$ (对于 $i1$) 计算：\n$l_{21} = 0/1 = 0$\n$l_{31} = 0/1 = 0$\n$l_{41} = 1/1 = 1$\n$L$ 的第一列对角线下方部分为 $(0, 0, 1)^{\\top}$。\n\n使用舒尔补更新后续子矩阵。设 $v_1 = (a_{21}, a_{31}, a_{41})^{\\top} = (0, 0, 1)^{\\top}$。\n$$\nA^{(2)} = A_{2:4,2:4}^{(1)} - \\frac{1}{d_1} v_1 v_1^{\\top} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  3 \\end{pmatrix} - \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\end{pmatrix}\n$$\n$$\nA^{(2)} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  3 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n\n**迭代 $k=2$:**\n活动矩阵是 $A^{(2)}$，索引为 $\\{2, 3, 4\\}$。我们考虑其第一列和元素 $a_{22}^{(2)} = 1$。\n该列中最大的非对角元素是 $\\lambda_2 = \\max_{i2} |a_{i2}^{(2)}| = \\max(|0|, |1|) = 1$。\n我们检查 $1 \\times 1$ 主元的条件：\n$$\n|a_{22}^{(2)}| \\ge \\alpha \\lambda_2 \\implies |1| \\ge \\alpha \\cdot 1\n$$\n这个条件也满足。我们选择一个 $1 \\times 1$ 主元，$d_2 = a_{22}^{(2)} = 1$。不需要置换。\n\n$L$ 的第二列的乘子为 $l_{i2} = a_{i2}^{(2)}/d_2$ (对于 $i2$)：\n$l_{32} = 0/1 = 0$\n$l_{42} = 1/1 = 1$\n$L$ 的第二列对角线下方部分为 $(0, 1)^{\\top}$。\n\n更新后续子矩阵。设 $v_2 = (a_{32}^{(2)}, a_{42}^{(2)})^{\\top} = (0, 1)^{\\top}$。\n$$\nA^{(3)} = A_{3:4,3:4}^{(2)} - \\frac{1}{d_2} v_2 v_2^{\\top} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} - \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix}\n$$\n$$\nA^{(3)} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n**迭代 $k=3$:**\n活动矩阵是 $A^{(3)}$，索引为 $\\{3, 4\\}$。我们考虑 $a_{33}^{(3)} = 1$。\n最大的（也是唯一的）非对角元素是 $\\lambda_3 = |a_{43}^{(3)}| = |1| = 1$。\n我们检查 $1 \\times 1$ 主元的条件：\n$$\n|a_{33}^{(3)}| \\ge \\alpha \\lambda_3 \\implies |1| \\ge \\alpha \\cdot 1\n$$\n该条件满足。主元是 $d_3 = a_{33}^{(3)} = 1$。不需要置换。\n\n$L$ 的第三列的乘子为 $l_{43} = a_{43}^{(3)}/d_3 = 1/1 = 1$。\n\n更新最后的 $1 \\times 1$ 子矩阵。设 $v_3 = (a_{43}^{(3)}) = (1)$。\n$$\nA^{(4)} = (a_{44}^{(3)}) - \\frac{1}{d_3} v_3 v_3^{\\top} = (1) - \\frac{1}{1} (1)(1) = 1 - 1 = 0\n$$\n最后一个主元是 $d_4 = A^{(4)} = 0$。\n\n**分解结果：**\n没有进行置换，因此 $P=I_4$。分解为 $A = LDL^{\\top}$。\n分块对角矩阵 $D$ 由我们找到的主元组成：\n$$\nD = \\begin{pmatrix}\n1   0  0  0 \\\\\n0   1  0  0 \\\\\n0   0  1  0 \\\\\n0   0  0  0\n\\end{pmatrix}\n$$\n单位下三角矩阵 $L$ 由乘子构成：\n$$\nL = \\begin{pmatrix}\n1   0  0  0 \\\\\nl_{21}   1  0  0 \\\\\nl_{31}   l_{32}  1  0 \\\\\nl_{41}   l_{42}  l_{43}  1\n\\end{pmatrix} = \\begin{pmatrix}\n1   0  0  0 \\\\\n0   1  0  0 \\\\\n0   0  1  0 \\\\\n1   1  1  1\n\\end{pmatrix}\n$$\n$A$ 的奇异性由零主元 $d_4=0$ 证实。\n\n**第二步：找到一个非零向量 $x$ 使得 $Ax=0$**\n\n我们需要求解 $Ax = 0$。使用分解，这等价于 $LDL^{\\top}x = 0$。\n令 $z = L^{\\top}x$。方程变为 $LDz = 0$。由于 $L$ 是可逆的（它是单位下三角矩阵），这等价于 $Dz=0$。\n我们需要找到一个满足 $Dz=0$ 的非零向量 $z$：\n$$\n\\begin{pmatrix}\n1   0  0  0 \\\\\n0   1  0  0 \\\\\n0   0  1  0 \\\\\n0   0  0  0\n\\end{pmatrix}\n\\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\\\ z_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到 $z_1=0$，$z_2=0$，$z_3=0$，以及 $0 \\cdot z_4 = 0$。最后一个方程对任何 $z_4$ 都成立。为了找到一个非零向量 $z$，我们可以为 $z_4$ 选择任何非零值。我们选择 $z_4=1$。\n所以，一个合适的向量是 $z = (0, 0, 0, 1)^{\\top}$。\n\n现在，我们从 $L^{\\top}x = z$ 求解 $x$：\n$$\nL^{\\top} = \\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n0   0  0  1\n\\end{pmatrix}\n$$\n方程组为：\n$$\n\\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n0   0  0  1\n\\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n我们通过回代法求解这个上三角系统：\n从最后一行：$x_4 = 1$。\n从第三行：$x_3 + x_4 = 0 \\implies x_3 + 1 = 0 \\implies x_3 = -1$。\n从第二行：$x_2 + x_4 = 0 \\implies x_2 + 1 = 0 \\implies x_2 = -1$。\n从第一行：$x_1 + x_4 = 0 \\implies x_1 + 1 = 0 \\implies x_1 = -1$。\n因此，$A$ 的零空间中的一个非零向量是 $x = (-1, -1, -1, 1)^{\\top}$。分量是所要求的整数。\n\n最终答案应为一个行向量。\n$x^{\\top} = \\begin{pmatrix} -1  -1  -1  1 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  -1  -1  1\n\\end{pmatrix}\n}\n$$", "id": "3535898"}]}