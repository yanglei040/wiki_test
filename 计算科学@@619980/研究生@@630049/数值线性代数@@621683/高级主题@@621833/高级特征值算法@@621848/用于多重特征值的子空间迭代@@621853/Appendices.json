{"hands_on_practices": [{"introduction": "子空间迭代的收敛性不仅仅是一个抽象的理论概念，更是一个可以被精确量化的几何过程。此练习旨在通过计算主角度来具体衡量迭代子空间与目标不变子空间之间的“距离”，并观察这个距离是如何随着迭代而缩小的。这个实践将帮助你将收敛的抽象思想与具体的数值计算联系起来，从而更深刻地理解算法的动态行为。", "problem": "考虑一个实对称矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，它有一个与两个最大特征值相关的二维不变子空间。设 $U \\in \\mathbb{R}^{4 \\times 2}$ 的列是标准正交的，且张成这个精确的不变子空间。设 $Q_k \\in \\mathbb{R}^{4 \\times 2}$ 是通过块子空间迭代产生的标准正交子空间迭代，其中在 $Q_0$ 和 $Q_1$ 之间应用了一次多项式滤波器。$U$、$Q_0$ 和 $Q_1$ 的列在 $\\mathbb{R}^{4}$ 的标准基下由下式给出：\n$$\nU \\;=\\;\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0 \\\\\n0  0\n\\end{pmatrix},\\qquad\nQ_0 \\;=\\;\n\\begin{pmatrix}\n\\frac{4}{5}  0 \\\\\n0  \\frac{12}{13} \\\\\n\\frac{3}{5}  0 \\\\\n0  \\frac{5}{13}\n\\end{pmatrix},\\qquad\nQ_1 \\;=\\;\n\\begin{pmatrix}\n\\frac{15}{17}  0 \\\\\n0  \\frac{35}{37} \\\\\n\\frac{8}{17}  0 \\\\\n0  \\frac{12}{37}\n\\end{pmatrix}.\n$$\n由具有标准正交列的矩阵的列张成的两个子空间之间的主角是通过奇异值分解（SVD）定义的：如果 $Q, U \\in \\mathbb{R}^{n \\times r}$ 具有标准正交列，则 $Q^{\\ast} U$ 的奇异值 $\\sigma_i$ 满足 $\\sigma_i = \\cos(\\theta_i)$，其中 $\\theta_i \\in [0,\\frac{\\pi}{2}]$ 是主角。假设所有角度都以弧度为单位。\n\n仅使用此定义和 SVD 的基本性质，完成以下操作：\n1. 对于 $k \\in \\{0,1\\}$，计算由 $Q_k$ 和 $U$ 的列张成的子空间之间的最大主角 $\\theta_{\\max}^{(k)}$。\n2. 定义子空间迭代收缩因子\n$$\n\\rho \\;=\\; \\frac{\\tan\\big(\\theta_{\\max}^{(1)}\\big)}{\\tan\\big(\\theta_{\\max}^{(0)}\\big)}.\n$$\n将 $\\rho$ 的精确值报告为简化表达式。不需要数值四舍五入。最终答案必须是单个实值数或单个无单位的闭式解析表达式。", "solution": "我们从两个子空间之间主角的核心定义开始。如果 $Q, U \\in \\mathbb{R}^{n \\times r}$ 具有标准正交列，那么 $Q^{\\ast} U \\in \\mathbb{R}^{r \\times r}$ 的奇异值 $\\sigma_i$ 等于 $\\cos(\\theta_i)$，其中 $\\theta_i \\in [0,\\frac{\\pi}{2}]$ 是 $\\mathrm{range}(Q)$ 和 $\\mathrm{range}(U)$ 之间的主角。最大主角对应于 $Q^{\\ast} U$ 的最小奇异值。\n\n我们将此应用于 $Q_0$ 和 $U$。计算 $Q_0^{\\ast} U$：\n$$\nQ_0^{\\ast} U \\;=\\;\n\\begin{pmatrix}\n\\frac{4}{5}  0  \\frac{3}{5}  0 \\\\\n0  \\frac{12}{13}  0  \\frac{5}{13}\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0 \\\\\n0  0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\frac{4}{5}  0 \\\\\n0  \\frac{12}{13}\n\\end{pmatrix}.\n$$\n这已经是一个对角矩阵，对角线元素非负，所以其奇异值为\n$$\n\\sigma_1^{(0)} \\;=\\; \\max\\!\\left\\{\\frac{4}{5}, \\frac{12}{13}\\right\\} \\;=\\; \\frac{12}{13},\\qquad\n\\sigma_2^{(0)} \\;=\\; \\min\\!\\left\\{\\frac{4}{5}, \\frac{12}{13}\\right\\} \\;=\\; \\frac{4}{5}.\n$$\n因此，主角满足\n$$\n\\cos\\!\\big(\\theta_1^{(0)}\\big) \\;=\\; \\frac{12}{13},\\qquad\n\\cos\\!\\big(\\theta_2^{(0)}\\big) \\;=\\; \\frac{4}{5}.\n$$\n最大主角是 $\\theta_{\\max}^{(0)} = \\max\\{\\theta_1^{(0)}, \\theta_2^{(0)}\\}$。因为 $\\cos$ 在 $[0,\\frac{\\pi}{2}]$ 上是递减的，所以最大角度对应于最小的余弦值，即 $\\frac{4}{5}$。因此\n$$\n\\theta_{\\max}^{(0)} \\;=\\; \\arccos\\!\\left(\\frac{4}{5}\\right).\n$$\n为了准备计算收缩因子，我们计算 $\\tan\\!\\big(\\theta_{\\max}^{(0)}\\big)$。使用勾股三元组，$\\sin\\!\\big(\\arccos(\\frac{4}{5})\\big) = \\frac{3}{5}$，因此\n$$\n\\tan\\!\\big(\\theta_{\\max}^{(0)}\\big) \\;=\\; \\frac{\\sin\\!\\big(\\theta_{\\max}^{(0)}\\big)}{\\cos\\!\\big(\\theta_{\\max}^{(0)}\\big)} \\;=\\; \\frac{\\frac{3}{5}}{\\frac{4}{5}} \\;=\\; \\frac{3}{4}.\n$$\n\n接下来，我们对 $Q_1$ 执行相同的步骤：\n$$\nQ_1^{\\ast} U \\;=\\;\n\\begin{pmatrix}\n\\frac{15}{17}  0  \\frac{8}{17}  0 \\\\\n0  \\frac{35}{37}  0  \\frac{12}{37}\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0 \\\\\n0  0\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\frac{15}{17}  0 \\\\\n0  \\frac{35}{37}\n\\end{pmatrix}.\n$$\n同样，这是一个对角矩阵，其奇异值为\n$$\n\\sigma_1^{(1)} \\;=\\; \\max\\!\\left\\{\\frac{15}{17}, \\frac{35}{37}\\right\\} \\;=\\; \\frac{35}{37},\\qquad\n\\sigma_2^{(1)} \\;=\\; \\min\\!\\left\\{\\frac{15}{17}, \\frac{35}{37}\\right\\} \\;=\\; \\frac{15}{17}.\n$$\n因此\n$$\n\\cos\\!\\big(\\theta_1^{(1)}\\big) \\;=\\; \\frac{35}{37},\\qquad\n\\cos\\!\\big(\\theta_2^{(1)}\\big) \\;=\\; \\frac{15}{17},\\qquad\n\\theta_{\\max}^{(1)} \\;=\\; \\arccos\\!\\left(\\frac{15}{17}\\right).\n$$\n我们计算 $\\tan\\!\\big(\\theta_{\\max}^{(1)}\\big)$。使用勾股三元组，$\\sin\\!\\big(\\arccos(\\frac{15}{17})\\big) = \\frac{8}{17}$，所以\n$$\n\\tan\\!\\big(\\theta_{\\max}^{(1)}\\big) \\;=\\; \\frac{\\frac{8}{17}}{\\frac{15}{17}} \\;=\\; \\frac{8}{15}.\n$$\n\n收缩因子定义为\n$$\n\\rho \\;=\\; \\frac{\\tan\\!\\big(\\theta_{\\max}^{(1)}\\big)}{\\tan\\!\\big(\\theta_{\\max}^{(0)}\\big)} \\;=\\; \\frac{\\frac{8}{15}}{\\frac{3}{4}} \\;=\\; \\frac{8}{15} \\cdot \\frac{4}{3} \\;=\\; \\frac{32}{45}.\n$$\n\n解释：在针对多个特征值的子空间迭代中，与目标不变子空间的主角在每次迭代中都会收缩，其收缩速率渐近地由谱隙信息决定。计算出的值 $\\rho = \\frac{32}{45}$ 为前两次迭代之间最差（最大）主角的这种收缩提供了一个定量度量，表明收敛，因为 $\\rho \\in (0,1)$。", "answer": "$$\\boxed{\\frac{32}{45}}$$", "id": "3582669"}, {"introduction": "在理解了子空间迭代的理想收敛过程之后，我们必须面对在有限精度计算机上实现该算法的实际挑战。正交化是子空间迭代中的关键步骤，而选择不同的正交化方法（如经典格拉姆-施密特法、修正的格拉姆-施密特法或豪斯霍尔德QR分解）会对算法的数值稳定性和最终精度产生深远影响。本练习将探讨这些方法在面对病态矩阵时的表现，帮助你理解为何在实际应用中，看似微不足道的实现选择至关重要。", "problem": "考虑一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其特征值为 $\\lambda_1 \\ge \\lambda_2 \\ge \\cdots \\ge \\lambda_n$。假设目标是使用子空间迭代来近似与 $p$ 个最大特征值相关的不变子空间。一个标准的迭代过程是先形成 $Y_{k+1} = A Q_k$，然后进行正交化步骤 $Y_{k+1} \\mapsto Q_{k+1}$，使得 $Q_{k+1}$ 的列构成 $\\operatorname{range}(Y_{k+1})$ 的一个标准正交基。在精确算术中，经典Gram-Schmidt、修正Gram-Schmidt和Householder $QR$ 分解会产生相同的子空间。然而，在单位舍入误差为 $u$ 的有限精度算术中，它们的稳定性性质有所不同，并且正交化方法的选择会影响 $Q_{k+1}$ 的精度（由 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2$ 衡量）以及子空间迭代的整体收敛行为，特别是当目标特征值紧密聚集，导致 $Y_{k+1}$ 随着 $k$ 的增长而变得越来越病态时。\n\n仅使用正交投影的基本定义、单位舍入误差为 $u$ 的浮点算术模型以及Householder变换作为正交映射的特性，判断以下关于子空间迭代中正交化步骤的有限精度稳定性的陈述哪些是正确的。选择所有适用项。\n\nA. 在有限精度下，对 $Y_{k+1}$ 进行单遍经典Gram-Schmidt所产生的 $Q_{k+1}$，其正交性的损失可能与 $\\kappa_2(Y_{k+1})\\,u$ 成比例增长（或更糟）。因此，当目标特征值聚集且 $Y_{k+1}$ 病态时，与Householder $QR$ 或带重正交化的修正Gram-Schmidt相比，该方法是不安全的。\n\nB. Householder $QR$ 产生的 $Q_{k+1}$ 满足 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2 = \\mathcal{O}(u)$，且这与 $Y_{k+1}$ 的条件数无关；其分块形式利用了3级基本线性代数子程序（BLAS），因此在子空间迭代中通常既更稳定又更高效。\n\nC. 无论 $Y_{k+1}$ 的条件数如何，单遍修正Gram-Schmidt总能达到 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2 = \\mathcal{O}(u)$，因此即使特征值紧密聚集，重正交化也是不必要的。\n\nD. 执行两次经典Gram-Schmidt（即，第二遍重正交化）所得到的 $Q_{k+1}$ 的正交性可与Householder $QR$ 相媲美（在常数因子乘以 $u$ 的范围内），但其内积和投影的计算成本大约是单遍的两倍。\n\nE. 在子空间迭代中，QR分解的列主元选择是强制性的；若无主元选择，该方法无法收敛到不变子空间，因为正交化步骤将无法移除沿已收敛方向的分量。\n\n选择正确选项。", "solution": "用户需要对在子空间迭代算法中用于寻找特征值的不同正交化方法的稳定性进行详细分析，特别是在有限精度算术的背景下。\n\n问题的核心在于矩阵 $Y_{k+1} = A Q_k$ 的性质。在子空间迭代中，矩阵 $Q_k$ 的列是标准正交向量，它们张成所需不变子空间的一个近似。随着迭代次数 $k$ 的增加，子空间 $\\operatorname{range}(Q_k)$ 收敛到与 $A$ 的 $p$ 个最大特征值相关的不变子空间。因此，$A$ 对 $Q_k$ 的作用会使 $Y_{k+1}$ 的列更强烈地对齐到相应的特征向量上。如果某些目标特征值是聚集的（即，对于某些 $j \\le p$ 有 $\\lambda_j \\approx \\lambda_{j+1}$），则 $Y_{k+1}$ 的相应列将变得近似线性相关。这使得矩阵 $Y_{k+1}$ 随着 $k$ 的增加而变得越来越病态，意味着其条件数 $\\kappa_2(Y_{k+1})$ 变得非常大。任务是对这个病态矩阵的列进行正交化。这个正交化步骤的稳定性对于算法的整体性能和准确性至关重要。\n\n我们在此背景下分析所提及的三种方法——经典Gram-Schmidt（CGS）、修正Gram-Schmidt（MGS）和Householder QR——的稳定性。正交性的损失由量 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2$ 来衡量，其中 $Q_{k+1}$ 是计算出的标准正交向量矩阵，而 $u$ 是浮点系统的单位舍入误差。\n\n### 选项 A 分析\n\n陈述：在有限精度下，对 $Y_{k+1}$ 进行单遍经典Gram-Schmidt所产生的 $Q_{k+1}$，其正交性的损失可能与 $\\kappa_2(Y_{k+1})\\,u$ 成比例增长（或更糟）。因此，当目标特征值聚集且 $Y_{k+1}$ 病态时，与Householder $QR$ 或带重正交化的修正Gram-Schmidt相比，该方法是不安全的。\n\n这个陈述是正确的。数值线性代数中的一个标准结果（最初由 Björck 提出）是，对于由经典Gram-Schmidt从矩阵 $Y$ 计算出的矩阵 $Q$，其正交性损失的界为：\n$$\n\\|I - Q^\\top Q\\|_2 \\le c \\cdot n \\cdot \\kappa_2(Y) u\n$$\n其中 $c$ 是一个不大的常数，$n$ 是列数。更悲观的分析甚至可能显示出对 $\\kappa_2(Y)^2$ 的依赖性。无论如何，正交性的损失直接依赖于输入矩阵 $Y$ 的条件数。在具有聚集特征值的子空间迭代背景下，$Y_{k+1}$ 变得病态，因此 $\\kappa_2(Y_{k+1})$ 很大。这意味着 $\\kappa_2(Y_{k+1})u$ 可能远大于 $u$，导致 $Q_{k+1}$ 的正交性严重损失。这种行为使得单遍CGS在数值上不稳定，因此对于此应用是“不安全的”。相比之下，Householder QR能达到机器精度（$\\mathcal{O}(u)$）的正交性，而带重正交化的MGS（或带重正交化的CGS）也能将正交性恢复到类似水平。因此，所做的比较是有效的。\n\n结论：**正确**。\n\n### 选项 B 分析\n\n陈述：Householder $QR$ 产生的 $Q_{k+1}$ 满足 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2 = \\mathcal{O}(u)$，且这与 $Y_{k+1}$ 的条件数无关；其分块形式利用了3级基本线性代数子程序（BLAS），因此在子空间迭代中通常既更稳定又更高效。\n\n这个陈述是正确的。Householder QR分解通过应用一系列Householder反射器来实现正交化，这些反射器是初等正交矩阵。这些正交矩阵的乘积就是最终的 $Q$ 矩阵。因为正交变换是完美条件化的且数值稳定，所以计算出的 $Q_{k+1}$ 中的累积误差很小。正交性的损失有界：\n$$\n\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2 = \\mathcal{O}(u)\n$$\n这个界与条件数 $\\kappa_2(Y_{k+1})$ 无关。这使得Householder QR在维持正交性方面成为最稳健的方法。\n此外，Householder QR可以以分块方式实现（例如，使用WY表示法），这将反射器的应用组合成矩阵-矩阵乘法。这些操作对应于3级BLAS，它们为具有内存层次结构的现代计算机体系结构进行了高度优化，从而比Gram-Schmidt方法中占主导地位的基于向量的操作（1级和2级BLAS）带来显著的性能提升。\n卓越的数值稳定性和潜在的更高效率相结合，使Householder QR成为一个非常有吸引力的选择。\n\n结论：**正确**。\n\n### 选项 C 分析\n\n陈述：无论 $Y_{k+1}$ 的条件数如何，单遍修正Gram-Schmidt总能达到 $\\|I - Q_{k+1}^\\top Q_{k+1}\\|_2 = \\mathcal{O}(u)$，因此即使特征值紧密聚集，重正交化也是不必要的。\n\n这个陈述是错误的。虽然修正Gram-Schmidt（MGS）在实践中比经典Gram-Schmidt（CGS）稳定得多，但其正交性的损失仍然依赖于输入矩阵的条件数。单遍MGS的标准界是：\n$$\n\\|I - Q^\\top Q\\|_2 \\approx \\mathcal{O}(\\kappa_2(Y)u)\n$$\n尽管常数因子通常比CGS的好得多，但对 $\\kappa_2(Y)$ 的依赖性依然存在。当 $Y_{k+1}$ 因特征值聚集而病态时，$\\kappa_2(Y_{k+1})$ 可能大到足以使 $\\kappa_2(Y_{k+1})u$ 不再是机器精度的数量级。例如，如果 $\\kappa_2(Y_{k+1}) \\approx 10^8$ 且 $u \\approx 10^{-16}$，那么正交性的损失可能在 $10^{-8}$ 左右。这与真正的正交性有显著偏差。因此，如果需要高精度，在处理病态矩阵时，通常也建议对MGS进行重正交化。声称它“总能达到”$\\mathcal{O}(u)$ 的正交性并且重正交化是“不必要的”是错误的。\n\n结论：**错误**。\n\n### 选项 D 分析\n\n陈述：执行两次经典Gram-Schmidt（即，第二遍重正交化）所得到的 $Q_{k+1}$ 的正交性可与Householder $QR$ 相媲美（在常数因子乘以 $u$ 的范围内），但其内积和投影的计算成本大约是单遍的两倍。\n\n这个陈述是正确的。这就是著名的Gram-Schmidt“两次就够”原则。设 $Q^{(1)}$ 是对 $Y$ 应用一次CGS的结果。其正交性损失为 $\\|I - (Q^{(1)})^\\top Q^{(1)}\\|_2 = \\mathcal{O}(\\kappa_2(Y)u)$。现在，对矩阵 $Q^{(1)}$（它比 $Y$ 的条件要好得多）再进行一次CGS，产生最终矩阵 $Q^{(2)}$。仔细的分析表明，$Q^{(2)}$ 的正交性损失为：\n$$\n\\|I - (Q^{(2)})^\\top Q^{(2)}\\|_2 = \\mathcal{O}(u)\n$$\n这个结论成立的前提是初始的正交性损失不能太大（例如，$\\kappa_2(Y)u < 1$）。最终得到的正交性确实可以与Householder QR相媲美。CGS的成本主要由内积和向量更新（投影）主导。执行该过程两次仅仅意味着将这个操作序列执行两次，因此计算成本大约是单遍的两倍。陈述的两个部分都是准确的。这种方法通常被称为CGS2。\n\n结论：**正确**。\n\n### 选项 E 分析\n\n陈述：在子空间迭代中，QR分解的列主元选择是强制性的；若无主元选择，该方法无法收敛到不变子空间，因为正交化步骤将无法移除沿已收敛方向的分量。\n\n这个陈述是错误的。QR分解中的列主元选择，即计算 $YP = QR$（其中 $P$ 是一个置换矩阵），是一种处理秩亏矩阵的策略，通过确保 $Q$ 的初始列张成 $Y$ 的列空间中最主要的部分。然而，在子空间迭代中，目标是为子空间 $\\operatorname{range}(Y_{k+1})$ 找到*一个*标准正交基。在该子空间内选择的具体基不影响子空间本身。子空间迭代的收敛是由类似幂法的 $A$ 的应用来保证的，这确保了 $\\operatorname{range}(A^k Y_0)$ 收敛到所需的不变子空间。正交化步骤仅仅是在每一步 $k$ 为这个演化中的子空间提供一个数值稳定的表示。\n\n任何能够成功为 $\\operatorname{range}(Y_{k+1})$ 生成标准正交基的方法都足够了。像Householder QR或带重正交化的CGS这样的稳健方法可以在不需要重排各列的情况下计算出这样一个基。声称没有主元选择方法就“无法收敛”是错误的。所提供的理由也是有缺陷的；正交化并不是“移除沿已收敛方向的分量”——它的功能是产生一个标准正交基。收敛是整个迭代过程 $Y_{k+1}=AQ_k$ 的一个涌现特性。主元选择是在特定情境下（如秩揭示QR）用于数值稳定性的工具，但它不是子空间迭代算法本身收敛的强制性组成部分。\n\n结论：**错误**。", "answer": "$$\\boxed{ABD}$$", "id": "3582668"}, {"introduction": "一个鲁棒的算法不仅要在理想条件下工作，还必须能够应对乃至克服最坏情况的挑战。如果子空间迭代收敛的核心条件——谱隙不存在，将会发生什么？本练习构建了一个此类“最坏情况”的场景，此时由于关键特征值的模长相等，标准迭代过程会停滞不前。通过分析这一失效模式，你将学习如何运用谱变换技术（如多项式滤波器）来人为地创造出谱分离，从而恢复算法的快速收敛性，这体现了数值线性代数中解决难题的优雅与智慧。", "problem": "考虑一个可对角化矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 的分块子空间迭代，该迭代旨在寻找一个 $s$ 维不变子空间，使用的块大小为 $m$，且 $m = s$。设迭代定义为 $Y_{k+1} = \\mathrm{orth}(A Y_k)$，其中 $\\mathrm{orth}(\\cdot)$ 表示通过 QR（正交-三角）分解进行的正交规范化，而 $Y_k \\in \\mathbb{C}^{n \\times m}$ 的列向量是正交规范的，张成当前的迭代子空间。假设 $Y_0$ 在所需的不变子空间中有非零分量。设特征分解为 $A = X \\Lambda X^{-1}$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，$X$ 是特征向量矩阵。对于一个正规矩阵 $A$（其中 $X$ 是酉矩阵），迭代子空间与任何固定不变子空间之间的主角在 $A$ 的作用下的演化，取决于模 $\\{|\\lambda_i|\\}$ 如何缩放相应分量，之后再进行正交规范化。\n\n您被要求构造一个最坏情况的光谱，其中 (i) 重数 $s$ 等于块大小 $m$，且 (ii) 相关特征值的模相等，并解释为什么在这种情况下，收敛缓慢或完全停滞，并且仅由正交规范化引起的混合所驱动。然后，确定一些从根本上改变迭代所见光谱以恢复分离并加速收敛的方法。\n\n选择下面所有在此意义上正确的陈述（每个陈述可能包括一个构造、对缓慢收敛机制的解释，和/或一个补救措施）：\n\nA. 取一个酉矩阵 $A$，满足 $A = Q \\Lambda Q^{*}$ 和 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，其中对于所有 $i \\in \\{1,\\dots,n\\}$ 都有 $|\\lambda_i| = 1$。当 $m = s$ 时，通过模的大小来确定任何 $s$ 维不变子空间是不适定的，因为 $|\\lambda_s| = |\\lambda_{s+1}|$，导致没有谱收缩。子空间迭代 $Y_{k+1} = \\mathrm{orth}(A Y_k)$ 仅表现出由正交规范化引起的旋转和混合，而目标子空间之外的分量没有衰减。一个合适的补救措施是通过应用有理或多项式滤波器来转换问题，例如用 $(A - \\sigma I)^{-1}$ 替换 $A$（对于一个合适的位移 $\\sigma \\in \\mathbb{C}$），使得靠近 $\\sigma$ 的特征值在模上占主导地位，或者使用一个多项式 $p(A)$，使得 $|p(\\lambda)|$ 在所需簇上的值严格大于其他地方的值。\n\nB. 取 $A = \\mathrm{diag}(1,\\dots,1, 1 - \\varepsilon, \\dots)$，其中有 $s$ 个 $1$，其余特征值等于 $1 - \\varepsilon$（对于一个小的 $\\varepsilon > 0$），并使用 $m = s$ 进行子空间迭代。收敛不会发生，因为正交规范化移除了主导分量；为了补救这一点，应该完全禁用正交规范化。\n\nC. 在模相等的情况下，即 $|\\lambda_1| = \\dots = |\\lambda_n|$，简单地将块大小从 $m=s$ 增加到 $m=s+1$ 就能保证以严格小于 $1$ 的速率线性收敛，因为此时块大小超过了重数。\n\nD. 对于一个谱为 $\\{-1,1\\}$ 的埃尔米特矩阵 $A$，当 $m=s$ 并以 $+1$ 不变子空间为目标时，分块幂迭代无法通过模的大小区分 $\\{-1\\}$ 和 $\\{+1\\}$，因为 $|-1| = |+1|$。应用一个简单的多项式滤波器 $p(t) = t + 1$ 会得到 $p(A)$，其特征值为 $\\{0,2\\}$，从而引入了一个严格的谱间隙，并恢复了子空间迭代到 $+1$ 特征空间的快速收敛。\n\nE. 当 $|\\lambda_s| = |\\lambda_{s+1}|$ 时，只要在每一步都使用完全重正交化，Ritz 提取（即投影到迭代子空间上，然后求解降维后的特征问题）仍将以严格小于 $1$ 的线性速率收敛到所需的不变子空间，即使不修改谱也是如此。", "solution": "题目要求分析分块子空间迭代方法的一个最坏情况场景，特别是在目标特征值和非目标特征值的模相等，导致收敛停滞时。题目还要求找出可以补救这种情况的方法。\n\n首先验证题目陈述。\n\n### 第1步：提取已知条件\n- **方法**：对一个可对角化矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 进行分块子空间迭代。\n- **目标**：找到一个 $s$ 维不变子空间。\n- **块大小**：$m=s$。\n- **迭代公式**：$Y_{k+1} = \\mathrm{orth}(A Y_k)$，其中 $Y_k \\in \\mathbb{C}^{n \\times m}$ 的列向量是正交规范的，$\\mathrm{orth}(\\cdot)$ 表示通过 QR 分解进行的正交规范化。\n- **初始条件**：$Y_0$ 在所需的不变子空间中有非零分量。\n- **特征分解**：$A = X \\Lambda X^{-1}$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_n)$。\n- **收敛原理**：对于一个正规矩阵 $A$，收敛是由特征值模 $|\\lambda_i|$ 对分量的缩放驱动的。\n- **任务**：构造一个最坏情况的光谱，其中 (i) 重数 $s$ 等于块大小 $m$，并且 (ii) 相关特征值的模相等。解释由此导致的缓慢/停滞收敛，并确定补救措施。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题牢固地植根于数值线性代数。对子空间迭代、其对幂方法的依赖、其基于谱分离的收敛性质，以及谱变换概念的描述，都是标准且公认的原理。\n- **适定性**：问题是适定的。它描述了一个标准算法的一个已知的特定失效模式，并要求解释和讨论纠正措施。这是该领域的标准概念性问题。\n- **客观性**：语言技术性强、精确，没有歧义或主观声明。\n\n题目陈述在科学上是合理的、适定的和客观的。没有矛盾、缺失信息或其他缺陷。\n\n### 第3步：结论与行动\n问题是**有效的**。将推导出一个解。\n\n### 基于原理的推导\n简单子空间迭代 $Y_{k+1} = \\mathrm{orth}(A Y_k)$ 的收敛性是简单幂方法的扩展。该方法旨在找到与 $A$ 的 $m$ 个模最大的特征值对应的不变子空间。设特征值排序为 $|\\lambda_1| \\ge |\\lambda_2| \\ge \\dots \\ge |\\lambda_s| \\ge |\\lambda_{s+1}| \\ge \\dots \\ge |\\lambda_n|$。由 $Y_k$ 的列向量张成的子空间，记作 $\\mathcal{S}_k = \\mathrm{span}(Y_k)$，收敛于由对应于 $\\{\\lambda_1, \\dots, \\lambda_s\\}$ 的特征向量张成的不变子空间（假设 $m=s$）。\n\n收敛速率由所需集合内外的特征值的模的分离程度决定。具体来说，$\\mathcal{S}_k$ 与目标不变子空间之间角度的收敛由比率 $|\\lambda_{s+1}|/|\\lambda_s|$ 控制。如果 $|\\lambda_s| > |\\lambda_{s+1}|$，那么基向量在“不想要的”特征向量（对应于 $\\lambda_{s+1}, \\dots, \\lambda_n$）方向上的分量在每一步相对于“想要的”分量都会被衰减。\n\n收敛的最坏情况发生在当这个比率接近或等于 $1$ 时，即 $|\\lambda_s| \\approx |\\lambda_{s+1}|$ 或 $|\\lambda_s| = |\\lambda_{s+1}|$。在后一种情况下，幂方法步骤 $Z_{k+1} = AY_k$ 无法优先放大子空间的期望分量。迭代不会系统地减小子空间与目标不变子空间之间的角度。正交规范化步骤 $Y_{k+1} = \\mathrm{orth}(Z_{k+1})$ 仅仅是一个稳定化程序，以防止基向量变得共线并失去数值秩；在这种停滞的情况下，它本身并不能驱动向目标子空间的收敛。\n\n要恢复收敛，必须应用谱变换。这涉及将一个针对 $A$ 的慢收敛问题替换为一个针对相关矩阵 $f(A)$ 的快收敛问题，其中 $f$ 是一个被选择的函数，使得 $f(A)$ 的特征值（即 $f(\\lambda_i)$）具有良好的分离度。目标是选择 $f$，使得 $|f(\\lambda_{s+1})| / |f(\\lambda_s)| \\ll 1$。$f$ 的常见选择是有理函数（如在位移-反演方法中）或多项式（如在切比雪夫迭代中）。\n\n### 逐项分析\n\n**A. 取一个酉矩阵 $A$，满足 $A = Q \\Lambda Q^{*}$ 和 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，其中对于所有 $i \\in \\{1,\\dots,n\\}$ 都有 $|\\lambda_i| = 1$。当 $m = s$ 时，通过模的大小来确定任何 $s$ 维不变子空间是不适定的，因为 $|\\lambda_s| = |\\lambda_{s+1}|$，导致没有谱收缩。子空间迭代 $Y_{k+1} = \\mathrm{orth}(A Y_k)$ 仅表现出由正交规范化引起的旋转和混合，而目标子空间之外的分量没有衰减。一个合适的补救措施是通过应用有理或多项式滤波器来转换问题，例如用 $(A - \\sigma I)^{-1}$ 替换 $A$（对于一个合适的位移 $\\sigma \\in \\mathbb{C}$），使得靠近 $\\sigma$ 的特征值在模上占主导地位，或者使用一个多项式 $p(A)$，使得 $|p(\\lambda)|$ 在所需簇上的值严格大于其他地方的值。**\n\n- **分析**：酉矩阵是这种最坏情况的一个完美例子，因为它的所有特征值都位于复平面的单位圆上，所以对所有 $i$ 都有 $|\\lambda_i|=1$。因此，对于任何 $s < n$，我们有 $|\\lambda_s| = |\\lambda_{s+1}| = 1$。控制收敛的比率是 $|\\lambda_{s+1}|/|\\lambda_s| = 1$，所以简单的子空间迭代会停滞。关于迭代退化为旋转（由酉算子 $A$ 引起）和重正交化的解释在物理上和数学上都是正确的。所提出的补救措施，即使用 $(A - \\sigma I)^{-1}$ 的位移-反演和使用 $p(A)$ 的多项式滤波，是标准、有效的技术，可以创造谱间隙并加速收敛。如果选择 $\\sigma$ 接近于某个期望的特征值 $\\lambda_j$，那么 $|(\\lambda_j - \\sigma)^{-1}|$ 会变得非常大，从而将其与其他变换后的特征值分离开来。类似地，可以设计一个多项式来放大谱的特定区域。\n- **结论**：**正确**。\n\n**B. 取 $A = \\mathrm{diag}(1,\\dots,1, 1 - \\varepsilon, \\dots)$，其中有 $s$ 个 $1$，其余特征值等于 $1 - \\varepsilon$（对于一个小的 $\\varepsilon > 0$），并使用 $m = s$ 进行子空间迭代。收敛不会发生，因为正交规范化移除了主导分量；为了补救这一点，应该完全禁用正交规范化。**\n\n- **分析**：在这种情况下，$\\lambda_s = 1$ 且 $\\lambda_{s+1} = 1 - \\varepsilon$。收敛比率为 $|\\lambda_{s+1}|/|\\lambda_s| = 1-\\varepsilon$。因为 $\\varepsilon > 0$，这个比率严格小于 $1$。收敛将会发生，尽管如果 $\\varepsilon$ 很小，速度会很慢。“收敛不会发生”的说法是错误的。“正交规范化移除了主导分量”的说法是无稽之谈；正交规范化是为了维持基向量的线性无关性，这对于表示一个 $s$ 维子空间至关重要。提议的“完全禁用正交规范化”的补救措施是致命的缺陷。没有正交规范化，迭代就变成了同时幂迭代，所有的列向量会迅速收敛到主导特征向量（特征值为 $1$）的方向，导致基向量变得秩亏，无法捕捉整个 $s$ 维子空间。\n- **结论**：**不正确**。\n\n**C. 在模相等的情况下，即 $|\\lambda_1| = \\dots = |\\lambda_n|$，简单地将块大小从 $m=s$ 增加到 $m=s+1$ 就能保证以严格小于 $1$ 的速率线性收敛，因为此时块大小超过了重数。**\n\n- **分析**：该陈述建议使用大小为 $m=s+1$ 的块来寻找一个 $s$ 维子空间。这个 $(s+1)$ 维子空间迭代的收敛由比率 $|\\lambda_{m+1}|/|\\lambda_m| = |\\lambda_{s+2}|/|\\lambda_{s+1}|$ 控制。在所有 $|\\lambda_i|$ 都相等的“模相等情况”下，这个比率也是 $1$。用于 $(s+1)$ 维子空间的迭代将因与用于 $s$ 维子空间的迭代完全相同的原因而停滞。增加块大小是一种用于处理模相近但不完全相等的特征值簇的策略。它不能解决模完全相等时的根本问题。“保证”收敛的说法是错误的。\n- **结论**：**不正确**。\n\n**D. 对于一个谱为 $\\{-1,1\\}$ 的埃尔米特矩阵 $A$，当 $m=s$ 并以 $+1$ 不变子空间为目标时，分块幂迭代无法通过模的大小区分 $\\{-1\\}$ 和 $\\{+1\\}$，因为 $|-1| = |+1|$。应用一个简单的多项式滤波器 $p(t) = t + 1$ 会得到 $p(A)$，其特征值为 $\\{0,2\\}$，从而引入了一个严格的谱间隙，并恢复了子空间迭代到 $+1$ 特征空间的快速收敛。**\n\n- **分析**：这是一个具体的、构造良好的例子。矩阵 $A$ 的特征值为 $\\pm 1$。目标特征值为 $\\lambda_s = 1$，模第二大的特征值为 $\\lambda_{s+1} = -1$。模的比率为 $|-1|/|1| = 1$，所以简单的子空间迭代会停滞，正如陈述所正确指出的。提议的补救措施是一个多项式滤波器 $p(t) = t+1$。新的矩阵是 $p(A) = A+I$。它的特征值是 $\\{ p(-1), p(1) \\} = \\{-1+1, 1+1\\} = \\{0, 2\\}$。$A$ 的目标 $+1$ 特征空间现在是 $A+I$ 的 $2$ 特征空间。$A$ 的不想要的 $-1$ 特征空间现在是 $A+I$ 的 $0$ 特征空间。控制向目标子空间收敛的新比率是 $|0|/|2| = 0$。收敛比为 $0$ 意味着在精确算术中一次迭代即可收敛。这就是“快速收敛”的定义。该陈述完全正确。\n- **结论**：**正确**。\n\n**E. 当 $|\\lambda_s| = |\\lambda_{s+1}|$ 时，只要在每一步都使用完全重正交化，Ritz 提取（即投影到迭代子空间上，然后求解降维后的特征问题）仍将以严格小于 $1$ 的线性速率收敛到所需的不变子空间，即使不修改谱也是如此。**\n\n- **分析**：Ritz 提取是从给定子空间中找到特征对的最佳近似的过程。在子空间迭代中，我们从当前子空间 $\\mathcal{S}_k = \\mathrm{span}(Y_k)$ 计算 Ritz 对。这些 Ritz 对收敛到 $A$ 的真实特征对，依赖于子空间 $\\mathcal{S}_k$ 收敛到真实不变子空间。如果底层的子空间迭代 $Y_{k+1} = \\mathrm{orth}(AY_k)$ 因为 $|\\lambda_s| = |\\lambda_{s+1}|$ 而停滞，子空间 $\\mathcal{S}_k$ 就不会改善。Ritz 提取只能在*当前不改善的子空间内*提供最佳答案。它不是一种加速子空间本身收敛的机制。声称它将以线性速率收敛是错误的；如果子空间不收敛，Ritz 对也不会收敛。完全重正交化是为了数值稳定性，并不会改变这个基本的收敛理论。\n- **结论**：**不正确**。", "answer": "$$\\boxed{AD}$$", "id": "3582701"}]}