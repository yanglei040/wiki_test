{"hands_on_practices": [{"introduction": "隐式重启 Lanczos 方法的核心是 Lanczos 过程本身。在深入研究“重启”的精妙之处前，我们必须首先掌握这个基础。本练习将引导你逐步完成一个具体的 Lanczos 分解计算 [@problem_id:3590006]，通过一个给定的矩阵和初始向量，亲手构建出关键的三对角矩阵 $T$。这将帮助你巩固对三项递推关系和标准正交基生成过程的理解。", "problem": "考虑在隐式重启 Lanczos 方法 (IRLM) 内部使用的核心 Krylov 子空间构造，其中对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 被投影到一个标准正交基 $\\{v_1, v_2, \\dots\\}$ 上，通过一个由对称性和正交性约束导出的三项递推关系，形成一个三对角矩阵 $T$。设矩阵 $A = \\mathrm{diag}(5,4,3,2,1) \\in \\mathbb{R}^{5 \\times 5}$，初始向量为 $v_1 = (1,1,1,1,1)^{\\top}$。使用标准的对称 Lanczos 过程，该过程强制基向量相互正交，并确保投影算子是三对角的。从将给定初始向量归一化为单位 $2$-范数得到的 $v_1$ 开始，执行两步 Lanczos 过程，以确定三对角投影的前两个对角元和第一个次对角元（记为 $\\alpha_1$、$\\beta_2$ 和 $\\alpha_2$），以及相应的 Lanczos 基向量 $v_2$ 和 $v_3$。使用根式和有理数精确表示所有量；不需要四舍五入。将您的最终答案以单个行矩阵的形式给出，其中按顺序包含 $\\alpha_1$、$\\beta_2$、$\\alpha_2$、$v_2$ 的五个分量以及 $v_3$ 的五个分量。", "solution": "该问题被验证为是自洽的、有科学依据且良定的。任务是对于一个给定的对称矩阵 $A$ 和一个指定的初始向量，执行两步完整的对称 Lanczos 算法。\n\n对称 Lanczos 算法是一种迭代方法，它为 Krylov 子空间 $\\mathcal{K}_k(A, v_1) = \\mathrm{span}\\{v_1, Av_1, \\dots, A^{k-1}v_1\\}$ 构造一个标准正交基 $\\{v_j\\}_{j=1}^k$，并生成一个实对称三对角矩阵 $T_k$。该算法的核心是三项递推关系。对于单个向量 $v_j$，该关系为：\n$$A v_j = \\beta_j v_{j-1} + \\alpha_j v_j + \\beta_{j+1} v_{j+1}$$\n系数 $\\alpha_j = v_j^\\top A v_j$。未归一化的下一个向量为 $r_j = A v_j - \\alpha_j v_j - \\beta_j v_{j-1}$，次对角元为 $\\beta_{j+1} = \\|r_j\\|_2$。算法以 $\\beta_1=0$ 和 $v_0$ 为零向量开始。\n\n我们已知矩阵 $A = \\mathrm{diag}(5,4,3,2,1)$ 和一个待归一化的初始向量。\n\n**步骤 0：初始化**\n未归一化的起始向量是 $u = (1,1,1,1,1)^\\top$。我们首先计算其欧几里得范数：\n$$\\|u\\|_2 = \\sqrt{1^2 + 1^2 + 1^2 + 1^2 + 1^2} = \\sqrt{5}$$\n第一个 Lanczos 向量 $v_1$ 是通过归一化 $u$ 得到的：\n$$v_1 = \\frac{u}{\\|u\\|_2} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n\n**步骤 1：第一次迭代 ($j=1$)**\n我们开始 Lanczos 过程的第一步。首先，我们计算乘积 $w_1 = A v_1$：\n$$w_1 = A v_1 = \\begin{pmatrix} 5  0  0  0  0 \\\\ 0  4  0  0  0 \\\\ 0  0  3  0  0 \\\\ 0  0  0  2  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n接下来，我们计算三对角矩阵 $T$ 的第一个对角元 $\\alpha_1$：\n$$\\alpha_1 = v_1^\\top w_1 = v_1^\\top A v_1 = \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1  1  1  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{5}(5+4+3+2+1) = \\frac{15}{5} = 3$$\n现在我们计算未归一化的残差向量 $r_1$，回顾一下 $\\beta_1=0$：\n$$r_1 = w_1 - \\alpha_1 v_1 = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} - 3 \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5-3 \\\\ 4-3 \\\\ 3-3 \\\\ 2-3 \\\\ 1-3 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix}$$\n第一个次对角元 $\\beta_2$ 是 $r_1$ 的 $2$-范数：\n$$\\beta_2 = \\|r_1\\|_2 = \\left\\| \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{5}} \\sqrt{2^2 + 1^2 + 0^2 + (-1)^2 + (-2)^2} = \\frac{1}{\\sqrt{5}} \\sqrt{4+1+0+1+4} = \\frac{\\sqrt{10}}{\\sqrt{5}} = \\sqrt{2}$$\n最后，我们通过归一化 $r_1$ 计算第二个 Lanczos 向量 $v_2$：\n$$v_2 = \\frac{r_1}{\\beta_2} = \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix}$$\n\n**步骤 2：第二次迭代 ($j=2$)**\n我们进行第二步。首先，计算 $w_2 = A v_2$：\n$$w_2 = A v_2 = \\begin{pmatrix} 5  0  0  0  0 \\\\ 0  4  0  0  0 \\\\ 0  0  3  0  0 \\\\ 0  0  0  2  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix}$$\n接下来，我们计算第二个对角元 $\\alpha_2$：\n$$\\alpha_2 = v_2^\\top w_2 = v_2^\\top A v_2 = \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2  1  0  -1  -2 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} \\right) = \\frac{1}{10}(20+4+0+2+4) = \\frac{30}{10} = 3$$\n现在我们计算未归一化的残差向量 $r_2 = w_2 - \\alpha_2 v_2 - \\beta_2 v_1$：\n$$r_2 = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} - 3 \\cdot \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} - \\sqrt{2} \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n为了简化减法运算，我们将所有向量表示为带有公因子 $\\frac{1}{\\sqrt{10}}$ 的形式。注意，$\\frac{\\sqrt{2}}{\\sqrt{5}} = \\frac{2}{\\sqrt{10}}$。\n$$r_2 = \\frac{1}{\\sqrt{10}} \\left( \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} - \\begin{pmatrix} 6 \\\\ 3 \\\\ 0 \\\\ -3 \\\\ -6 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 2 \\\\ 2 \\\\ 2 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10-6-2 \\\\ 4-3-2 \\\\ 0-0-2 \\\\ -2-(-3)-2 \\\\ -2-(-6)-2 \\end{pmatrix} = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix}$$\n为了找到 $v_3$，我们首先计算 $\\beta_3 = \\|r_2\\|_2$：\n$$\\beta_3 = \\|r_2\\|_2 = \\left\\| \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{10}} \\sqrt{2^2 + (-1)^2 + (-2)^2 + (-1)^2 + 2^2} = \\frac{1}{\\sqrt{10}} \\sqrt{4+1+4+1+4} = \\frac{\\sqrt{14}}{\\sqrt{10}}$$\n最后，我们通过归一化 $r_2$ 来计算第三个 Lanczos 向量 $v_3$：\n$$v_3 = \\frac{r_2}{\\beta_3} = \\frac{1}{\\frac{\\sqrt{14}}{\\sqrt{10}}} \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{14}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix}$$\n\n所需的量为 $\\alpha_1$、$\\beta_2$、$\\alpha_2$，以及 $v_2$ 和 $v_3$ 各自的五个分量。\n$\\alpha_1 = 3$\n$\\beta_2 = \\sqrt{2}$\n$\\alpha_2 = 3$\n$v_2$ 的五个分量是 $\\frac{2}{\\sqrt{10}}$、$\\frac{1}{\\sqrt{10}}$、$0$、$-\\frac{1}{\\sqrt{10}}$ 和 $-\\frac{2}{\\sqrt{10}}$。\n$v_3$ 的五个分量是 $\\frac{2}{\\sqrt{14}}$、$-\\frac{1}{\\sqrt{14}}$、$-\\frac{2}{\\sqrt{14}}$、$-\\frac{1}{\\sqrt{14}}$ 和 $\\frac{2}{\\sqrt{14}}$。\n这些值被组合成一个单行矩阵作为最终答案。", "answer": "$$ \\boxed{ \\begin{pmatrix} 3  \\sqrt{2}  3  \\frac{2}{\\sqrt{10}}  \\frac{1}{\\sqrt{10}}  0  -\\frac{1}{\\sqrt{10}}  -\\frac{2}{\\sqrt{10}}  \\frac{2}{\\sqrt{14}}  -\\frac{1}{\\sqrt{14}}  -\\frac{2}{\\sqrt{14}}  -\\frac{1}{\\sqrt{14}}  \\frac{2}{\\sqrt{14}} \\end{pmatrix} } $$", "id": "3590006"}, {"introduction": "IRLM 中的“重启”并非随意为之，而是一个精巧的滤波过程。本练习将深入探讨其背后的理论核心 [@problem_id:3590045]，揭示对三对角矩阵施加位移（shifts）等价于对初始向量应用一个多项式滤波器。通过计算该多项式对不同特征值的影响，你将深刻理解 IRLM 是如何抑制不需要的特征向量分量，从而加速向目标特征向量收敛的。", "problem": "考虑一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其特征分解为 $A = U \\Lambda U^{\\top}$，其中 $U$ 是正交矩阵，$\\Lambda = \\operatorname{diag}(\\lambda_{1}, \\dots, \\lambda_{n})$。Lanczos方法使用起始向量 $v_{1}$ 构建一个Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$，并生成一个三对角矩阵 $T_{m}$，该矩阵满足Lanczos关系 $A V_{m} = V_{m} T_{m} + \\beta_{m+1} v_{m+1} e_{m}^{\\top}$，其中 $V_{m}$ 的列是标准正交的，构成了 $\\mathcal{K}_{m}(A, v_{1})$ 的一个基，$e_{m}$ 是第 $m$ 个标准基向量，且 $\\beta_{m+1} \\in \\mathbb{R}$。\n\n在隐式重启Lanczos方法（IRLM）中，对 $T_{m}$ 应用一系列（$s$ 个）带位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 的隐式位移正交变换（每次变换对应一个带位移的正交-三角或正交-相似步骤），然后进行截断，以新的起始向量重启该过程。这个过程的核心在于，对小矩阵 $T_m$ 施加一个带位移 $\\sigma_j$ 的QR步骤，在数学上等价于对Krylov子空间的基进行一次变换，其效果等同于将原始起始向量 $v_1$ 变换为与 $(A - \\sigma_j I)v_1$ 成比例的新向量。基于此，推导出描述重启后的起始向量如何形成为 $p(A) v_{1}$ 的显式标量滤波多项式 $p(\\lambda)$，并解释为什么沿着特征向量 $u_{i}$ 的分量被缩放了 $p(\\lambda_{i})$ 倍。\n\n然后，对于一个假设的矩阵 $A$，其谱由以下十个特征值组成：\n$$\n\\lambda_{1} = -2,\\ \\lambda_{2} = -1,\\ \\lambda_{3} = 0,\\ \\lambda_{4} = \\frac{1}{2},\\ \\lambda_{5} = 1,\\ \\lambda_{6} = \\frac{3}{2},\\ \\lambda_{7} = 2,\\ \\lambda_{8} = \\frac{5}{2},\\ \\lambda_{9} = 3,\\ \\lambda_{10} = 4,\n$$\n以及对于使用三个位移量\n$$\n\\sigma_{1} = 1,\\ \\sigma_{2} = 2,\\ \\sigma_{3} = 3,\n$$\n的一次隐式重启Lanczos扫描，计算 $i = 1, \\dots, 10$ 时各 $|p(\\lambda_{i})|$ 的大小。\n\n将最终值按照上面给出的特征值的顺序，以单行矩阵的形式呈现。无需四舍五入；将所有值精确地表示为整数或有理数。", "solution": "问题要求完成两个主要任务：首先，推导在隐式重启Lanczos方法（IRLM）中使用的滤波多项式 $p(\\lambda)$，并解释它对起始向量在矩阵 $A$ 的特征基中的分量的影响；其次，对于给定的一组位移，计算该多项式在指定特征值处的幅值。\n\n让我们从推导开始。IRLM是一种迭代过程，用于寻找大型矩阵 $A$ 的少数几个特征值和特征向量。它首先使用Lanczos算法构建一个维度为 $m$ 的Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$，该算法生成一个标准正交基 $V_{m} = [v_{1}, v_{2}, \\dots, v_{m}]$ 和一个满足Lanczos关系的实对称三对角矩阵 $T_{m} \\in \\mathbb{R}^{m \\times m}$：\n$$A V_{m} = V_{m} T_{m} + \\beta_{m+1} v_{m+1} e_{m}^{\\top}$$\n此处，$V_{m}^{\\top} A V_{m} = T_{m}$，意味着 $T_{m}$ 是 $A$ 在Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$ 上的投影。\n\nIRLM的“重启”部分涉及优化起始向量 $v_{1}$，以更好地逼近所需的特征空间。这是通过对 $T_{m}$ 应用 $s$ 个隐式位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 来完成的。每次位移的应用对应于“凸起追踪”QR算法的一步。\n\n关键的洞见在于，这一系列在小三对角矩阵 $T_m$ 上的操作，等价于在原始高维空间中对起始向量 $v_1$ 应用一个多项式滤波器。对 $T_m$ 应用一次带位移 $\\sigma_j$ 的隐式QR步骤，其最终效果是产生一个新的起始向量，该向量与 $(A - \\sigma_j I) v_1$ 成正比（相差一个归一化常数）。\n\n当应用一系列 $s$ 个位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 时，这个过程被重复。第二步产生一个与 $(A - \\sigma_{2} I) v_{1}^{(+)}$ 成比例的向量，该向量又与 $(A - \\sigma_{2} I)(A - \\sigma_{1} I) v_{1}$ 成比例。在应用所有 $s$ 个位移后，截断和重启之前的所得向量，我们称之为 $\\tilde{v}_{1}$，由下式给出：\n$$\\tilde{v}_{1} = c \\prod_{j=1}^{s} (A - \\sigma_{j} I) v_{1}$$\n其中 $c$ 是一个累积的归一化常数。\n这定义了一个多项式算子 $p(A) = \\prod_{j=1}^{s} (A - \\sigma_{j} I)$。相应的标量滤波多项式为：\n$$p(\\lambda) = \\prod_{j=1}^{s} (\\lambda - \\sigma_{j})$$\n重启后的起始向量是 $\\frac{p(A)v_{1}}{\\|p(A)v_{1}\\|}$。\n\n现在，我们解释为什么起始向量沿着特征向量 $u_i$ 的分量被缩放了 $p(\\lambda_i)$ 倍。设初始向量 $v_1$ 在 $A$ 的标准正交特征基 $\\{u_{i}\\}_{i=1}^{n}$ 中展开为：\n$$v_{1} = \\sum_{i=1}^{n} \\alpha_{i} u_{i}$$\n其中 $\\alpha_{i} = u_{i}^{\\top} v_{1}$ 是沿着 $u_{i}$ 的分量的系数。\n将多项式算子 $p(A)$ 应用于 $v_{1}$：\n$$p(A) v_{1} = p(A) \\left( \\sum_{i=1}^{n} \\alpha_{i} u_{i} \\right) = \\sum_{i=1}^{n} \\alpha_{i} p(A) u_{i}$$\n由于 $u_{i}$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda_{i}$（即 $A u_{i} = \\lambda_{i} u_{i}$），它也是 $A$ 的任何多项式的特征向量。具体来说：\n$$p(A) u_{i} = \\left( \\prod_{j=1}^{s} (A - \\sigma_{j} I) \\right) u_{i} = \\left( \\prod_{j=1}^{s} (\\lambda_{i} - \\sigma_{j}) \\right) u_{i} = p(\\lambda_{i}) u_{i}$$\n将此结果代回，我们得到：\n$$p(A) v_{1} = \\sum_{i=1}^{n} \\alpha_{i} (p(\\lambda_{i}) u_{i}) = \\sum_{i=1}^{n} (\\alpha_{i} p(\\lambda_{i})) u_{i}$$\n这表明 $v_{1}$ 沿着 $u_{i}$ 的原始分量 $\\alpha_{i} u_{i}$ 被变换为新的分量 $(\\alpha_{i} p(\\lambda_{i})) u_{i}$。因此，该分量被标量因子 $p(\\lambda_{i})$ 缩放。IRLM 的目的是选择与不想要的特征值相对应的位移 $\\sigma_{j}$，使得相应的 $|p(\\lambda_{i})|$ 值很小，从而有效地抑制那些分量，并使起始向量在所期望的特征分量上得到富集。\n\n对于问题的第二部分，我们给定 $s=3$ 个位移：$\\sigma_{1} = 1$, $\\sigma_{2} = 2$, $\\sigma_{3} = 3$。滤波多项式为：\n$$p(\\lambda) = (\\lambda - 1)(\\lambda - 2)(\\lambda - 3)$$\n我们必须为给定的10个特征值计算 $|p(\\lambda_{i})|$。\n\n- 对于 $\\lambda_{1} = -2$：\n$p(-2) = (-2 - 1)(-2 - 2)(-2 - 3) = (-3)(-4)(-5) = -60$。所以，$|p(\\lambda_{1})| = 60$。\n\n- 对于 $\\lambda_{2} = -1$：\n$p(-1) = (-1 - 1)(-1 - 2)(-1 - 3) = (-2)(-3)(-4) = -24$。所以，$|p(\\lambda_{2})| = 24$。\n\n- 对于 $\\lambda_{3} = 0$：\n$p(0) = (0 - 1)(0 - 2)(0 - 3) = (-1)(-2)(-3) = -6$。所以，$|p(\\lambda_{3})| = 6$。\n\n- 对于 $\\lambda_{4} = \\frac{1}{2}$：\n$p(\\frac{1}{2}) = (\\frac{1}{2} - 1)(\\frac{1}{2} - 2)(\\frac{1}{2} - 3) = (-\\frac{1}{2})(-\\frac{3}{2})(-\\frac{5}{2}) = -\\frac{15}{8}$。所以，$|p(\\lambda_{4})| = \\frac{15}{8}$。\n\n- 对于 $\\lambda_{5} = 1$：\n$p(1) = (1 - 1)(1 - 2)(1 - 3) = (0)(-1)(-2) = 0$。所以，$|p(\\lambda_{5})| = 0$。\n\n- 对于 $\\lambda_{6} = \\frac{3}{2}$：\n$p(\\frac{3}{2}) = (\\frac{3}{2} - 1)(\\frac{3}{2} - 2)(\\frac{3}{2} - 3) = (\\frac{1}{2})(-\\frac{1}{2})(-\\frac{3}{2}) = \\frac{3}{8}$。所以，$|p(\\lambda_{6})| = \\frac{3}{8}$。\n\n- 对于 $\\lambda_{7} = 2$：\n$p(2) = (2 - 1)(2 - 2)(2 - 3) = (1)(0)(-1) = 0$。所以，$|p(\\lambda_{7})| = 0$。\n\n- 对于 $\\lambda_{8} = \\frac{5}{2}$：\n$p(\\frac{5}{2}) = (\\frac{5}{2} - 1)(\\frac{5}{2} - 2)(\\frac{5}{2} - 3) = (\\frac{3}{2})(\\frac{1}{2})(-\\frac{1}{2}) = -\\frac{3}{8}$。所以，$|p(\\lambda_{8})| = \\frac{3}{8}$。\n\n- 对于 $\\lambda_{9} = 3$：\n$p(3) = (3 - 1)(3 - 2)(3 - 3) = (2)(1)(0) = 0$。所以，$|p(\\lambda_{9})| = 0$。\n\n- 对于 $\\lambda_{10} = 4$：\n$p(4) = (4 - 1)(4 - 2)(4 - 3) = (3)(2)(1) = 6$。所以，$|p(\\lambda_{10})| = 6$。\n\n按顺序列出的所得幅值为 $\\{60, 24, 6, \\frac{15}{8}, 0, \\frac{3}{8}, 0, \\frac{3}{8}, 0, 6\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  24  6  \\frac{15}{8}  0  \\frac{3}{8}  0  \\frac{3}{8}  0  6\n\\end{pmatrix}\n}\n$$", "id": "3590045"}, {"introduction": "Lanczos 过程的产物是一个小规模的三对角矩阵，其特征值（即里兹值）是对原始大矩阵特征值的近似。本练习将 Lanczos 过程的力学步骤与其最终目标——特征值近似——联系起来 [@problem_id:3590016]。你将计算里兹值及其残差范数，学习后者如何作为衡量近似质量的关键指标，并亲眼见证一个“幸运中断”（lucky breakdown）的场景，即算法在特定条件下如何精确地找到特征值。", "problem": "考虑隐式重启动 Lanczos 方法 (IRLM)，该方法首先构造一个维度为 $m$ 的短 Lanczos 分解，然后再应用隐式位移。在精确算术中，对于一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，Lanczos 过程从一个单位范数向量 $q_1$ 开始，生成一个标准正交基 $Q_m = [q_1,\\dots,q_m]$ 以及一个对称三对角投影 $T_m \\in \\mathbb{R}^{m \\times m}$。$T_m$ 的特征对被称为 Ritz 对，它们在原始空间中相关的 Ritz 向量为 $Q_m y$，其中 $y$ 是 $T_m$ 的一个特征向量。这些 Ritz 对的残差范数决定了对 $A$ 的特征对的近似质量。\n\n对于实对称矩阵 $A = \\mathrm{diag}(10,9,1,0) \\in \\mathbb{R}^{4 \\times 4}$，起始向量 $v_1 = (1,1,0,0)^{\\top}$，目标子空间维度 $m=2$ 的具体情况，请根据 Lanczos 过程的基本定义：\n\n1. 将 $v_1$ 标准化以获得 $q_1$，并执行两步 Lanczos 过程来构造三对角投影 $T_2$。\n2. 计算 $T_2$ 的 Ritz 值。\n3. 在 Lanczos 投影的意义下，计算相应 Ritz 对的残差范数。\n4. 基于这些计算，评估二维 Lanczos 子空间能够很好地近似 $A$ 的哪些特征值。\n\n将最终答案表示为一个单行矩阵，按顺序包含 $T_2$ 的四个元素（按行主序）、两个 Ritz 值和两个残差范数。无需进行四舍五入。", "solution": "问题要求我们对给定的实对称矩阵 $A$ 和起始向量 $v_1$ 执行 Lanczos 过程的前两步，然后分析得到的二维 Lanczos 子空间。该分析涉及计算 Ritz 值及其对应的残差范数。\n\n对于对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和起始向量 $v_1$，Lanczos 算法生成一个标准正交向量序列 $q_j$（Lanczos 向量）和一个对称三对角矩阵 $T_m$。该过程由以下递推关系定义，从 $q_1 = v_1/\\|v_1\\|_2$，$\\beta_1=0$ 和 $q_0 = \\mathbf{0}$ 开始：\n对于 $j=1, 2, \\dots, m$：\n1. $w_j = A q_j$\n2. $\\alpha_j = q_j^{\\top} w_j$\n3. $\\hat{w}_j = w_j - \\alpha_j q_j - \\beta_j q_{j-1}$\n4. $\\beta_{j+1} = \\|\\hat{w}_j\\|_2$\n5. 如果 $\\beta_{j+1}=0$，算法终止。\n6. $q_{j+1} = \\hat{w}_j / \\beta_{j+1}$\n\n生成的对称三对角矩阵为 $T_m = \\begin{pmatrix} \\alpha_1  \\beta_2   \\\\ \\beta_2  \\alpha_2  \\ddots  \\\\  \\ddots  \\ddots  \\beta_m \\\\   \\beta_m  \\alpha_m \\end{pmatrix}$。\n\n给定的矩阵是 $A = \\mathrm{diag}(10,9,1,0)$，起始向量是 $v_1 = (1,1,0,0)^{\\top}$。目标维度是 $m=2$。\n\n**1. 构造三对角投影 $T_2$**\n\n首先，我们将起始向量 $v_1$ 标准化以获得 $q_1$。\n$v_1$ 的欧几里得范数是 $\\|v_1\\|_2 = \\sqrt{1^2 + 1^2 + 0^2 + 0^2} = \\sqrt{2}$。\n因此，第一个 Lanczos 向量是：\n$$q_1 = \\frac{v_1}{\\|v_1\\|_2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n\n现在，我们执行 Lanczos 算法的第一步 ($j=1$)。\n$$w_1 = A q_1 = \\begin{pmatrix} 10  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第一个对角元素是 $\\alpha_1$：\n$$\\alpha_1 = q_1^{\\top} w_1 = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)^{\\top} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{2} (1 \\cdot 10 + 1 \\cdot 9) = \\frac{19}{2}$$\n接下来，我们计算未标准化的下一个 Lanczos 向量，其中 $\\beta_1=0$：\n$$\\hat{w}_1 = w_1 - \\alpha_1 q_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{19}{2} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{19}{2} \\\\ 9 - \\frac{19}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第一个次对角元素是 $\\beta_2$：\n$$\\beta_2 = \\|\\hat{w}_1\\|_2 = \\left\\| \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{2}} \\sqrt{\\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{1}{2}} = \\frac{1}{2}$$\n第二个 Lanczos 向量是：\n$$q_2 = \\frac{\\hat{w}_1}{\\beta_2} = \\frac{ \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1/2 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} }{1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n现在，我们执行 Lanczos 算法的第二步 ($j=2$)。\n$$w_2 = A q_2 = \\begin{pmatrix} 10  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第二个对角元素是 $\\alpha_2$：\n$$\\alpha_2 = q_2^{\\top} w_2 = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)^{\\top} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{2} (1 \\cdot 10 + (-1) \\cdot (-9)) = \\frac{1}{2}(10+9) = \\frac{19}{2}$$\n我们现在已经计算出 $T_2$ 的所有元素：\n$$T_2 = \\begin{pmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{19}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{19}{2} \\end{pmatrix}$$\n\n**2. 计算 $T_2$ 的 Ritz 值**\n\nRitz 值是 $T_2$ 的特征值。我们通过求解特征方程 $\\det(T_2 - \\theta I) = 0$ 来找到它们。\n$$\\det \\begin{pmatrix} \\frac{19}{2} - \\theta  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{19}{2} - \\theta \\end{pmatrix} = 0$$\n$$\\left(\\frac{19}{2} - \\theta\\right)^2 - \\left(\\frac{1}{2}\\right)^2 = 0$$\n$$\\left(\\frac{19}{2} - \\theta - \\frac{1}{2}\\right) \\left(\\frac{19}{2} - \\theta + \\frac{1}{2}\\right) = 0$$\n$$\\left(\\frac{18}{2} - \\theta\\right) \\left(\\frac{20}{2} - \\theta\\right) = 0$$\n$$(9 - \\theta)(10 - \\theta) = 0$$\nRitz 值是 $\\theta_1 = 10$ 和 $\\theta_2 = 9$。\n\n**3. 计算残差范数**\n\n对于一个给定的 Ritz 对 $(\\theta_k, y^{(k)})$，其中 $T_m y^{(k)} = \\theta_k y^{(k)}$ 且 $\\|y^{(k)}\\|=1$，其对应的 Ritz 向量 $x^{(k)} = Q_m y^{(k)}$ 的残差范数由 $\\|A x^{(k)} - \\theta_k x^{(k)}\\|_2 = |\\beta_{m+1}| |e_m^{\\top} y^{(k)}|$ 给出，其中 $e_m$ 是第 $m$ 个标准基向量。在我们的例子中，$m=2$，所以公式为 $\\|r_k\\|_2 = |\\beta_3| |e_2^{\\top} y^{(k)}| = |\\beta_3| |y_2^{(k)}|$。\n\n为了找到残差范数，我们必须计算 $\\beta_3 = \\|\\hat{w}_2\\|_2$。我们继续 $j=2$ 的 Lanczos 过程：\n$$\\hat{w}_2 = w_2 - \\alpha_2 q_2 - \\beta_2 q_1$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{19}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) - \\frac{1}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\left[ \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 19/2 \\\\ -19/2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right]$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{19}{2} - \\frac{1}{2} \\\\ -9 + \\frac{19}{2} - \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{20}{2} \\\\ -9 + \\frac{18}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - 10 \\\\ -9 + 9 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n由于 $\\hat{w}_2$ 是零向量，其范数 $\\beta_3 = \\|\\hat{w}_2\\|_2 = 0$。\n\n这种情况被称为“幸运中断”(lucky breakdown)。它意味着 Krylov 子空间 $\\mathcal{K}_2(A, q_1) = \\mathrm{span}\\{q_1, q_2\\}$ 是 $A$ 的一个不变子空间。\n每个 Ritz 对的残差范数是 $\\|r_k\\|_2 = |\\beta_3| |y_2^{(k)}| = 0 \\cdot |y_2^{(k)}| = 0$。\n因此，两个 Ritz 对的残差范数都为 $0$。\n\n**4. 特征值近似的评估**\n\n$A$ 的特征值是 $10$、$9$、$1$ 和 $0$。计算出的 Ritz 值是 $10$ 和 $9$。\n一个 Ritz 对的残差范数为零，当且仅当该 Ritz 对是矩阵 $A$ 的一个精确特征对。\n由于两个残差范数都为 $0$，二维 Lanczos 子空间已经得出了精确的特征值 $10$ 和 $9$。\n这是起始向量 $v_1 = (1,1,0,0)^{\\top}$ 仅仅是对应于这两个特征值（即 $e_1=(1,0,0,0)^{\\top}$ 和 $e_2=(0,1,0,0)^{\\top}$）的特征向量的线性组合的直接结果。\n\n最终要求的量是：\n- $T_2$ 的四个元素（按行主序）：$\\alpha_1=\\frac{19}{2}$，$\\beta_2=\\frac{1}{2}$，$\\beta_2=\\frac{1}{2}$，$\\alpha_2=\\frac{19}{2}$。\n- 两个 Ritz 值（降序排列）：$\\theta_1=10$，$\\theta_2=9$。\n- 两个对应的残差范数：$0$，$0$。\n将它们组合成一个单行矩阵。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{19}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{19}{2}  10  9  0  0 \\end{pmatrix} } $$", "id": "3590016"}]}