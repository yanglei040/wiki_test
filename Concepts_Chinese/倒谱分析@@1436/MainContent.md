## 引言
在从声学到通信的许多领域中，信号通常是源与滤波器的纠缠混合体——比如被声道塑造的人声，或是被房间回声扭曲的声音。分离这些卷积信号是一项基本的挑战。传统方法在处理噪声和复杂性时常常力不从心，但一种被称为倒谱分析的强大技术通过改变游戏规则本身，提供了一个优雅的解决方案。本文通过引入一种非线性的同态方法来解决解卷积的核心问题，该方法将这项艰巨的任务转变为一个简单的分离问题。

在接下来的章节中，您将进入一个乘法变为加法的新领域。“原理与机制”一章将揭示其理论的奥秘，解释傅里叶变换、对数运算和另一次傅里叶变换如何结合起来创造出倒谱并解开信号的纠缠。随后，“应用与跨学科联系”一章将展示这一卓越工具如何被用于检测回声、分析人类语音，并为现代音频识别系统提供支持。

## 原理与机制

假设您在一个空旷的大厅里喊一声“喂！”。您听到的回声不仅仅是您的声音，而是一系列回声——您最初的“喂”声之后跟着更微弱、延迟的副本。到达您耳朵的声音是您原始语音信号与房间响应的*卷积*，在这个简单案例中，房间响应是一系列脉冲。或者想一想人声本身：声带（源）的振动穿过喉咙和口腔，后者充当滤波器，将声音塑造成元音和辅音。同样，最终的声音是源和滤波器的卷积。

在科学和工程的众多领域，从声学、地震学到通信，我们都面临着这个基本问题：如何将两个通过卷积混合在一起的信号解开？这似乎是一项极其困难的任务。如果您有一个信号 $x[n]$ 是 $p[n] * h[n]$ 的结果，您怎么可能仅通过观察 $x[n]$ 就恢复 $p[n]$ 和 $h[n]$ 呢？直接解卷积对噪声极其敏感，并且通常需要我们已经知道其中一个信号。我们需要一种更巧妙、更鲁棒的方法。我们需要改变这个问题本身。

### 解开信号的艺术：同态处理

让我们思考一下卷积的性质。在时域中，它是一个复杂的操作。但我们从 Joseph Fourier 的杰出工作中得知，如果我们将信号转换到频域，奇迹就会发生。时域中复杂的卷积在频域中变成了简单的乘法。如果 $x[n] = p[n] * h[n]$，那么它们的傅里叶变换关系为 $X(\omega) = P(\omega) \cdot H(\omega)$。

这是巨大的一步！乘法比卷积简单得多。但我们仍然面临两个东西相乘的问题。我们如何将它们分开？是否存在一种能将乘法变为加法的数学运算？当然有：**对数**。

如果我们对频域表达式取对数，会得到：
$$ \ln(X(\omega)) = \ln(P(\omega) \cdot H(\omega)) = \ln(P(\omega)) + \ln(H(\omega)) $$
就是这样。我们终于做到了。我们找到了一个空间，一个变换域，在这个域中，两个曾经通过卷积纠缠在一起的信号现在只是简单地相加。这就是**同态信号处理**的核心思想：找到一个变换，将一个复杂的操作（如卷积）映射到一个更简单的操作（如加法）。

### 新领域之旅：倒谱

现在，我们的两个信号分量被一个加号清晰地分开了。但它们处于一个奇怪的域——频域的对数域。这个空间到底是什么样的？为了更直观地理解它，让我们做一个信号处理工程师在面对频域表示时总会做的事：进行傅里叶逆变换，看看它在“时间”上是什么样子。

这最后一次变换将我们带入一个新世界，一个有其独特规则和术语的世界。对数谱的傅里叶逆变换的结果被称为**倒谱 (cepstrum)**（注意“spectrum”的前四个字母被颠倒了）。倒谱的自变量，其单位是时间，被戏称为**倒频率 (quefrency)**（“frequency”的字母被打乱了）。

$$ c_x[n] = \mathcal{F}^{-1}\{ \ln(X(\omega)) \} = \mathcal{F}^{-1}\{ \ln(|X(\omega)|) \} + j \mathcal{F}^{-1}\{ \arg(X(\omega)) \} $$

对于许多应用，我们最感兴趣的是频谱的幅度，因此我们关注**实倒谱 (real cepstrum)**，它仅使用对数幅度定义：
$$ c_r[n] = \mathcal{F}^{-1}\{ \ln(|X(\omega)|) \} $$

在倒谱域中，信号“看起来”是怎样的？倒频率轴告诉我们*在频域中*事物变化的快慢。
- 频谱中**缓慢变化**的分量（例如滤波器的宽泛形状）的能量将集中在**低倒频率**处（靠近 $n=0$）。
- 频谱中**快速变化**的周期性分量（例如精细的波纹或谐波梳）将在**高倒频率**处表现为一个明显的峰值。该峰值的位置对应于频域中波纹的周期。

这种分离是倒谱力量的关键。

### 分离不可分之物：基频与共振峰

让我们回到人声的例子。声道（您的口腔和咽喉）充当一个滤波器。其频率响应有几个宽泛的峰值，称为**共振峰 (formants)**，它们决定了元音。这是一个缓慢变化的谱包络。对于浊音，声源是声带的周期性振动，产生一个脉冲串。在频域中，周期性脉冲串变成了另一个脉冲串——一系列定义声音**基频 (pitch)**的尖锐、等距谐波。

最终的语音谱是平滑的声道包络与来自声源的尖锐谐波梳的乘积。当我们取对数谱时，这个乘积变成了一个和：平滑的对数包络加上由谐波产生的周期性波纹。

在倒谱域中，这被完美地转换了：
- 平滑的声道包络表现为**低倒频率**（$n$ 接近 0）处的一组系数。
- 来自基频谐波的周期性波纹在**高倒频率** $n_p$ 处产生一个强烈而尖锐的峰值，其中 $n_p$ 正是声音一个基本周期内的采样点数！[@problem_id:1730572]

想象一下，分析一段以 $9600 \text{ Hz}$ 采样的元音，发现其倒谱除了在原点附近有一些小凸起外，大部分为零，并且在倒频率索引 $n_p = 121$ 处有一个强烈的尖峰。这立刻告诉我们，基频周期是 $T_0 = 121 / 9600 \text{ s}$，对应的基频为 $F_0 = 1/T_0 \approx 79.3 \text{ Hz}$。我们刚刚测量了说话者的基频！

一旦分量按倒频率分开，我们就可以在倒谱域中使用滤波器将它们分离出来——这个操作被称为**倒谱提升 (liftering)**（这是对“filtering”的另一个文字游戏）。一个保留低倒频率分量的低通倒谱提升器可以分离出声道信息。一个高通倒谱提升器则可以分离出基频信息。这使我们能够独立分析语音产生的两个分量，而当它们被卷积在一起时，这项任务似乎是不可能完成的 [@problem_id:1730579]。

### 一个奇异新游戏的规则

在我们得意忘形之前，必须认识到倒谱变换不同于我们在入门课程中学习的熟悉的线性时不变（LTI）系统。倒谱算子 $\mathcal{T}\{x[n]\} = c[n]$ 有着根本的不同。例如，如果将输入信号加倍，$2x[n]$，输出的倒谱并*不会*加倍。对数的存在打破了线性。仔细分析表明，倒谱算子是**非线性、时变、非因果且不稳定的** [@problem_id:1712191]。这并不会降低它的用处；只是意味着我们必须小心。我们不是在传统意义上对信号进行“滤波”，而是在进行非线性分析。

这种变换背后的数学也与复变函数的性质紧密相连。倒谱的Z变换 $\hat{X}(z) = \ln(X(z))$，只有在原始变换 $X(z)$ 既解析（没有极点）又非零（没有零点）的区域内才能是良态的（解析的）。$X(z)$ 的一个零点会成为 $\hat{X}(z)$ 的一个对数奇点，即它“爆炸”至无穷大的点。这意味着，为了使倒谱在z平面的一个环形区域内有良好定义，该区域必须完全没有原始信号变换的极点和零点 [@problem_id:1745106]。

这带来了一个非凡的见解：信号的因果性与其倒谱的因果性之间存在直接联系。一个右边（因果）信号将有一个右边（因果）的复倒谱，当且仅当该信号是**最小相位**的——即其所有的极点*和*所有的零点都在单位圆内部 [@problem_id:1749242]。一个非最小相位的零点（单位圆外的一个零点）将产生一个延伸到负时间的倒谱分量。从某种意义上说，倒谱“知道”它所来自的系统的相位特性。

### 倒谱的超能力：从灰烬中重建

幅度和相位之间的这种深刻联系，正是倒谱揭示其真正超能力的地方。请注意，实倒谱 $c_r[n]$ *只依赖于*频谱的幅度 $|X(\omega)|$。它完全忽略了相位！然而，对于一个最小相位系统，幅度和相位并非相互独立；它们通过一种称为希尔伯特变换的关系联系在一起。

这意味着我们可以做一些不可思议的事情。我们可以仅从幅度谱 $|X(\omega)|$ 出发，计算出实倒谱 $c_r[n]$，然后据此完美地重建出具有完全相同幅度响应的唯一最小相位系统的复倒谱 $\widehat{c}_{\text{min}}[n]$。该过程涉及从偶对称序列 $c_r[n]$ 创建一个因果序列：我们保留 $n=0$ 处的值，将 $n>0$ 的值加倍，并将所有 $n<0$ 的值设为零 [@problem_id:2864820]。对这个新序列进行傅里叶变换，我们得到 $\ln(\widehat{H}_{\text{min}}(\omega))$，这是一个复对数谱，其幅度部分与我们的原始幅度谱相匹配，而相位部分则完全符合最小相位条件。

想一想这有多强大。在实际实验中，我们对幅度和相位的测量可能都带有噪声。相位是出了名的难以精确测量；它通常被“卷绕”在 $(-\pi, \pi]$ 区间内，在有噪声的情况下正确地解卷绕是一场噩梦。倒谱方法为我们提供了一条出路。我们可以采用我们带有噪声但更鲁棒的幅度测量值，计算出实倒谱，并用它来生成唯一真实、干净、解卷绕的、并与之相符的最小相位。我们基本上是扔掉了带噪声的相位，并从幅度数据的灰烬中重建了一个完美的相位。这是一种在现实世界中执行谱分解和系统辨识的极其鲁棒的方法 [@problem_-id:2883562] [@problem_id:2906380]。

### 分析师的权衡：加窗与分辨率

与所有强大的工具一样，倒谱分析并非没有实际应用的考量。整个理论都基于傅里叶变换，而傅里叶变换假定我们观察的是一个无限长的信号。在实践中，我们必须分析信号的短时、有限长度的片段，这是通过将我们的信号与一个**窗函数**相乘来实现的。

这个看似无害的步骤会产生深远的影响。时域中的乘法是频域中的卷积。这意味着我们真实、完美的频谱会被窗函数的傅里叶变换所卷积，或者说“涂抹”。窗函数的频谱有一个主瓣和多个旁瓣。如果主瓣太宽，它会抹掉我们信号频谱的精细细节。

考虑我们的基频检测问题。我们需要看到频谱中的周期性波纹才能得到一个倒谱峰。但是如果我们使用的窗太短，其频谱会有一个非常宽的主瓣。这个宽主瓣会将语音谱涂抹得如此严重，以至于完全冲刷掉谐波波纹！信息丢失了，倒谱将不会显示出基频峰。这就产生了一个根本性的权衡：短窗能提供好的时间分辨率（精确定位声音发生的*时间*），但频率分辨率差，可能会丢失基频。长窗能提供出色的频率分辨率，但它会在一个较长的时间段内对信号的属性进行平均，这假设了基频没有改变。[@problem_id:1736399]。使用常见的汉宁窗 (Hanning window) 来解析基频的一个经验法则是，分析窗必须足够长，以覆盖至少四个完整的基频周期 [@problem_id:1724183]。

这是每个信号分析师都必须做出的权衡。倒谱为我们提供了一个非凡的透镜来窥视卷积信号的结构，但我们看到的景象总是被我们选择观察的窗口所塑造。

