## 引言
重构生命恢弘的历史——一个关于迁徙、分裂和融合的故事——一直是演化生物学的核心目标之一。虽然简单的谱系树很有用，但它们往往无法捕捉到历史的一个关键方面：基因混合，即先前分离的群体之间的混合。这种遗传上的融合打破了简单树模型的假设，需要一个更复杂的框架来揭示真实而错综复杂的血缘之网。本文全面概述了混合图——一种为描绘这些复杂历史而设计的强大统计工具。第一章**原理与机制**将深入探讨该方法的数学基础，解释如何利用源自等位基因频率的统计数据来量化遗传漂变并明确检测基因混合。随后，关于**应用与跨学科联系**的章节将展示这些模型在实践中的应用，揭示对人类起源、尼安德特人种间杂交以及整个生命之树中演化过程的深刻见解。我们将从探索支撑整个领域的核心几何思想开始。

## 原理与机制
### 基因的几何学

我们如何描绘生命那宏大而 sprawling 的迁徙、分裂和融合史？秘密在于一种遗传几何学。想象一下，两个群体从一个共同的祖先分裂开来。随着世代的推移，随机、独立的突变和基因频率的波动——我们称之为**遗传漂变**（genetic drift）的过程——使它们分化。它们分离的时间越长，彼此的差异就越大。

我们可以用一个简单而优美的想法来量化这种分化。对于基因组中任何一个人们可能拥有两种不同DNA碱基（等位基因）之一的位置，我们可以测量其中一个碱基在每个群体中的频率。假设在群体 A 中，频率是 $p_A$，在群体 B 中是 $p_B$。平方差 $(p_A - p_B)^2$ 为我们提供了它们在这一点上差异程度的度量。如果我们在整个基因组的成千上万个位点上对这个值取平均，我们就能得到一个稳健的统计量，称为 **$f_2$**。

$$f_2(A, B) = \mathbb{E}[(p_A - p_B)^2]$$

这个 **$f_2$ 统计量**是我们“距离”的基本单位。它代表了分离两个群体的独立演化总量，即累积的漂变。值得注意的是，这些距离是**可加的**。如果群体 C 从通往 A 和 B 的谱系中分裂出来，那么从 A 到 B 的遗传距离 $f_2(A,B)$ 就是从它们的共同祖先到 A 的距离加上从同一个祖先到 B 的距离。这意味着，对于任何由简单分裂关联起来的三个群体，它们两两之间的遗传距离应该形成一个完美的树，就像路线图上的距离一样 [@problem_id:2790145] [@problem_id:2743223]。

### 当树模型失效：基因混合的信号

很长一段时间里，我们认为群体历史是一棵分枝清晰的树。但是，当树枝不仅分裂，还会合并时，会发生什么呢？这就是**基因混合**（admixture），一个先前分离的两个群体相遇并混合，创造出一个新的混合群体的过程。

当这种情况发生时，我们简单的几何学就失效了。这个混合群体，我们称之为 $X$，不再是地图上一个新的、独立的点。它的遗传构成是其亲本的混合体。如果它由与群体 $A$ 和 $B$ 相关的源群体形成，其中 $\alpha$ 比例的祖源来自类 $A$ 的源，而 $1-\alpha$ 来自类 $B$ 的源，那么它的等位基因频率将是一个加权平均值：

$$p_X = \alpha p_A + (1-\alpha) p_B$$

这个简单的线性关系是接下来一切的关键。混合群体在遗传上介于其源群体之间。这种“中间性”是我们寻找的确凿证据。一棵简单的树无法容纳一个在某种意义上同时处于两个位置的群体。为了描述这样的历史，我们需要一种新的地图：**混合图**（admixture graph）。混合图是一种允许网状结构（reticulations）的谱系树——即边重新合并在一起，代表这些古老的混合事件 [@problem_id:2691893]。这些图不仅仅是定性的卡通图；它们是明确的数学模型，其参数我们可以估计：每个分支上的漂变（边长）和混合比例（$\alpha$ 值）。

但是我们如何检测这种中间性并估计这些参数呢？$f_2$ 距离并非最合适的工具。我们需要更精细的方法。

### 解读蛛丝马迹：四群体检验的力量

为了寻找混合，我们需要能够像敏感探针一样探测历史关系的统计量。其中第一个是 **$f_3$ 统计量**：

$$f_3(C; A, B) = \mathbb{E}[(p_C - p_A)(p_C - p_B)]$$

看看它在测量什么。如果群体 $C$ 是与 $A$ 和 $B$ 相关的源群体的混合体，那么对于任何给定的基因，其频率 $p_C$ 会倾向于介于 $p_A$ 和 $p_B$ 之间。这意味着 $(p_C - p_A)$ 或 $(p_C - p_B)$ 中的一项为正，另一项为负。因此，它们的乘积将为负。当我们在整个基因组中对此进行平均时，一个显著为**负的 $f_3(C; A, B)$** 值是一个强有力且明确的信号，表明 $C$ 是与 $A$ 和 $B$ 相关的谱系之间发生基因混合的结果 [@problem_id:2743229]。

一个更通用的工具是 **$f_4$ 统计量**，也称为 D-统计量。它涉及四个群体，并作为“树性”（treeness）的检验：

$$f_4(A, B; C, D) = \mathbb{E}[(p_A - p_B)(p_C - p_D)]$$

想象一个简单的历史，其中一个祖先分裂成两个谱系，一个通向 $(A, B)$，另一个通向 $(C, D)$。在这种情况下，任何在通往 $A$ 和 $B$ 的路径上发生的遗传漂变都与通往 $C$ 和 $D$ 的路径上发生的漂变完全无关。这两个差异项 $(p_A - p_B)$ 和 $(p_C - p_D)$ 将是不相关的。它们的平均乘积 $f_4$ 应该为零。

一个非零的 $f_4$ 统计量告诉我们这个简单的树是错误的！例如，一个正的 $f_4(A, B; C, D)$ 意味着存在正相关：在 $A$ 中比在 $B$ 中更常见的等位基因，也倾向于在 $C$ 中比在 $D$ 中更常见。这暗示了通向 $A$ 和 $C$ 的谱系在它们从 $B$ 和 $D$ 的谱系分离后，共享了一段共同的历史。这是 $(A, C)$ 相对于 $(B, D)$ 构成一个演化支的树的标志。因此，$f_4$ 统计量可以区分相互竞争的树拓扑。

更重要的是，它可以检测基因混合。如果，比如说，$C$ 和 $A$ 之间存在基因流，它会在它们之间产生过多的共享等位基因，使得 $f_4(A, B; C, D)$ 偏离零。这个简单的统计量是构建和检验复杂混合图的基础构件。

我们甚至可以用它来精确量化混合量。假设我们怀疑群体 $X$ 是与 $B$ 相关的源（比例为 $\alpha$）和另一个与 $A$ 相关的源的混合体。通过巧妙地安排外群，我们可以构建 **$f_4$ 比率估计量**。它依赖于一个优美的代数技巧，可以分离出混合比例 [@problem_id:2743229] [@problem_id:2692263]：

$$\alpha = \frac{f_4(\text{Outgroup}_1, A; X, \text{Outgroup}_2)}{f_4(\text{Outgroup}_1, A; B, \text{Outgroup}_2)}$$

分母测量了将源 $B$ 与源 $A$ 分开的总遗传漂变。分子测量了在混合群体 $X$ 中“看到”的特定漂变的多少。它们的比率就是混合比例 $\alpha$！这正是用于提供第一个稳健估计，即非非洲现代人携带约 0.02 尼安德特人 DNA 的方法。我们甚至可以使用真实的（或假设的）等位基因频率数据来进行这些计算，并自己推导出混合比例 [@problem_id:2743307]。

### 构建完整的历史图景：从统计量到图

有了这些工具，我们就可以超越检验简单的假设，尝试重构整个群体历史。这是像 `qpGraph` 这样的软件的工作 [@problem_id:2790145]。你提出一个特定的混合图拓扑结构——谁从谁分裂，谁与谁混合。然后程序根据你提出的图计算所有可能的 $f_4$ 统计量的*期望*值。它找到最佳拟合的枝长和混合比例，使期望的统计量与从你的真实数据中观察到的统计量相匹配。

然后程序会给你一个分数：拟合得有多好？如果拟合很差，你假设的历史就是错误的，你必须回到起点重新开始。如果拟合得很好，你的模型就是真实历史的一个合理解释。这个提出、检验和改进模型的过程是现代古基因组学的核心。这是一种进行历史科学的量化方法，很像侦探拼凑线索来破案。当然，处理真实数据，特别是来自古代骨骼的数据，需要特别小心，比如要考虑 DNA 损伤和低数据质量 [@problem_id:2790145]。

### 机器中的幽灵

有时，无论我们如何排列我们采样的群体，都没有一个图能拟合数据。$f$-统计量呈现出一个悖论，一组无法同时满足的约束。这时，故事发生了有趣的转折。这通常意味着我们缺少了谜题的一部分：一个未被采样的“幽灵”群体。

想象一个已经灭绝的古人类谱系，我们尚未找到其化石，但它曾与某个现代人群体的祖先杂交。来自这个幽灵谱系的 DNA，当被引入现代群体时，会扰动所有涉及该群体的 $f$-统计量。它增加了一个新的共享遗传漂变来源，而这并不在我们最初的模型中 [@problem_id:2724562]。通过假设这样一个幽灵的存在，并找到它必须连接到我们图的哪个位置才能解决悖论，我们实际上可以“检测”并刻画我们从未直接见过的灭绝谱系。一个简单模型的失败变成了一项发现。

有一种更深刻的方式来思考这个问题，它利用了线性代数的力量 [@problem_id:2691840]。我们可以将我们所有的 $f_4$ 统计量排列成一个大矩阵。这个矩阵的数学**秩**——衡量其独立行或列数量的指标——告诉我们一些深刻的事情。事实证明，这个矩阵的秩比创造我们正在研究的群体所需的最少不同祖先“流”或“波”的数量少一。所以，甚至不用尝试构建一个图，我们就可以计算这个秩，然后说：“要解释这些群体的历史，我们至少需要 $m$ 个不同的祖先来源。”这就像拥有一个水晶球，能告诉我们过去的一个基本属性，这是数学推理应用于我们起源的杰作。

### 一点警示：阴影与模拟

与任何强大的工具一样，我们必须小心谨慎。我们解读的信号并不总是它们看起来的那样。有几个混淆因素可以产生模仿基因混合的模式。

首先是**不可识别性**（non-identifiability）问题。有时，两种不同的历史情景——两种不同的混合图——可能会产生完全相同的 $f$-统计量集合 [@problem_id:2691931]。例如，从群体 $B$ 到 $X$ 的基因流看起来可能与从 $B$ 的直系祖先到 $X$ 的基因流非常相似。为了解决这种模糊性，我们需要更多信息，比如我们样本的精确放射性碳测年数据，或者来自长而不间断的DNA片段（单倍型）的数据，这可以帮助确定混合事件的年代 [@problem_id:2790145]。

其次，其他生物过程也可以在没有任何基因混合的情况下产生非零的 D-统计量或 $f_4$ 统计量。如果一个产生了几个其他群体的创始群体本身具有亚结构，这种**祖先结构**（ancestral structure）可能会造成共享祖源的不平衡，并持續数百万年 [@problem_id:2544518]。另一个常见的混淆因素是**不完全谱系分选**（Incomplete Lineage Sorting, ILS）。当物种在短时间内相继分裂时，基因组不同部分的基因树并不总是与物种树相匹配。这是一个随机过程，但如果它对称发生，就不应偏向 D-统计量。然而，技术问题，如突变率偏倚或在识别祖先等位基因时的错误，可能会产生看起来像真实信号的不对称性 [@problem-id:2743242] [@problem_id:2544518]。

因此，群体遗传学家的工作就像一个细心的侦探。我们必须使用这些卓越的统计工具，但也要意识到它们的局限性，检验混淆因素，并结合多条证据线来构建一幅稳健的过去图景。正是通过这个严谨、富有创造性且有时令人沮丧的过程，我们慢慢揭示了生命历史那错综复杂而又美丽的织锦。

