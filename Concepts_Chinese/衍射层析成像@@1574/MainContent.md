## 引言
在纳米尺度上获得世界的三维视图——从活细胞内复杂的机器到高科技合金的原子晶格——是现代科学最重大的挑战之一。传统的显微技术通常需要对样品进行物理切片，这会破坏我们希望研究的原始环境，或者只能看到表面。衍射层析成像作为一项革命性的解决方案应运而生，它提供了一种无需透镜、无损地观察物体完整三维内部结构的方法。它通过计算解释X射线或电子等波从物体散射的方式来实现这一目标。

然而，这项强大的技术必须首先克服一个被称为“相位问题”的基本障碍。当波穿过一个基本透明的物体时，携带最多信息的是波的相位，而不是其亮度。然而，所有探测器都是“相位盲”的，只能记录亮度而丢弃了这一关键数据。本文将阐述衍射层析成像如何巧妙地解决这个问题。首先，我们将探讨其**原理与机制**，详细介绍用于恢复丢失的相位信息并将二维图样组装成三维图像的物理和计算技巧。接着，我们将深入了解其**应用与跨学科联系**，揭示该方法如何在从生物学、材料科学到纳米技术的各个领域提供前所未有的见解。

## 原理与机制

好了，让我们进入正题。我们已经了解了“衍射层析成像”这个奇妙的概念，一种无需透镜就能观察微小事物三维内部世界的方法。这到底是怎么做到的？听起来有点像魔法，但如同所有最精彩的魔法一样，它建立在一些优美、简单而深刻的物理学原理之上。我们理解它的过程有点像一个侦探故事。我们调查的对象就在那里，但它用一种我们无法直接解读的语言隐藏着自己的秘密。我们的任务就是破解这个密码。

### 不可见的挑战：振幅与相位

想象一下，你正试图描述一块完全透明、无色的玻璃。如果你以白色为背景为它拍一张简单的照片，你会得到什么？一张白色的照片。这块玻璃不怎么吸收光线，所以不会投下很强的影子。在纳米尺度上，构成生物和材料世界的大部分物质——水中的活细胞、聚合物共混物、精细的纳米颗粒——对于X射线或电子束来说，就像这块透明玻璃。我们称它们为**相位物体**。它们不会显著改变穿过它们波的**振幅**（即亮度），但会使其速度稍稍减慢。这种“减慢”就是波的**相位**移动。

把波想象成一队行进的士兵。振幅是士兵的身高，而相位是他们的步调——左、右、左、右。一个透明的物体不会让士兵变矮，只会让穿过它的士兵与旁边的士兵步调稍有错乱。这种步调的不一致，即相位移动 $\phi(\mathbf{r})$，携带了关于物体结构的所有信息。

这就是最大的问题，我们侦探故事的核心谜团：我们拥有的每一个探测器，从我们自己的眼睛到最精密的CCD或像素阵列探测器，本质上都是“相位盲”的。它们只测量**强度**，即波振幅的平方。它们告诉我们士兵有多*高*，但完全没有告诉我们他们是否步调一致。这就是物理学中臭名昭著的**相位问题**。我们记录下了一幅美丽而复杂的衍射图样，却丢掉了一半的信息——而且可以说是更重要的那一半！[@problem_id:1281201]

所以，我们的首要任务是找到一种方法，让不可见的东西变得可见。我们如何将这些无法探测的相位移动转换成我们能实际测量的东西，比如亮度的变化？

### 经典解决方案：在全息术中利用干涉

大自然仁慈地给了我们一个美丽的工具来做到这一点：**干涉**。如果有两束波在同一点相遇，它们会叠加起来。如果它们的波峰对齐，它们会相互加强，形成一个亮点。如果波峰与波谷相遇，它们会相互抵消，形成一个暗点。关键在于，最终的强度至关重要地取决于两束波之间的*相位差*。

这就是由 Dennis Gabor 发明的全息术背后的天才之处。为了“看见”穿过我们物体的波（我们称之为**物波**）的相位，我们可以将它与第二束我们完全了解其属性的原始波混合在一起。这就是**参考波**。当物波和参考波在探测器上发生干涉时，它们会产生一个复杂的条纹图样，称为**全息图**。这个图样现在包含了物体的相位信息，编码在条纹的精确位置和间距中。

通过对全息图进行数学“解码”，我们可以完全重构物波，找回其振幅和宝贵的相位。不同的全息装置使用不同类型的参考波——简单的平面波或更复杂的球面波——这反过来又改变了重构的确切数学过程。例如，一种被称为“无透镜傅里叶变换全息术”的巧妙设置使用球面参考波，将最终的重构步骤简化为单次快速傅里叶变换（FFT），这是一种高效的计算机算法。[@problem_id:2226048] 因此，全息术是解决相位问题的一种绝妙的物理技巧。

### 无透镜成像与计算“透镜”

全息术很强大，但如果建立一个干净、稳定的参考波很困难或不切实际怎么办？对于现代的X射线和电子源来说，情况往往如此。还有别的方法吗？我们能否在没有参考波的情况下解决相位问题？

答案惊人地是肯定的。这就引出了**相干衍射成像（CDI）**。在CDI中，我们只记录孤立物体本身的衍射图样。我们有强度 $| \tilde{O}(\mathbf{q}) |^2$，其中 $\tilde{O}(\mathbf{q})$ 是我们物体散射性质的傅里叶变换，但我们没有相位。看起来我们又回到了原点。

但我们有一个王牌：计算机。而且我们还有其他信息——我们的“约束条件”。我们了解物体在**实空间**（我们生活的空间）中的一些情况。例如，我们知道我们成像的物体是有限的。它不会延伸到无穷远；它存在于一个已知的边界内，通常称为“支撑区”。在这个边界之外，只有真空。

所以，我们可以设计一种像计算透镜一样工作的迭代算法。它的过程大致如下：
1. 我们从**傅里叶空间**（也叫倒易空间）开始，这里有我们测量的衍射振幅 $| \tilde{O}(\mathbf{q}) |$。由于我们不知道相位，我们做一个完全的猜测——比如说，把它们全部设为零，或者随机选择。
2. 现在我们在傅里叶空间有了一个完整的复函数。我们进行逆傅里叶变换回到实空间。得到的结果当然是一团糟。它看起来不像我们的物体，因为我们的相位猜测是错误的。
3. 但是现在，在实空间中，我们应用我们的约束条件。我们知道我们的物体只存在于“支撑区”内部，所以我们把这个边界之外的所有东西都设为零。我们可能还知道物体的密度不能是负的，所以我们也强制执行这一点。我们刚刚根据我们所知的物理事实“清理”了我们杂乱的图像。
4. 现在我们把这个清理过的实空间图像进行傅里叶变换，回到傅里叶空间。我们现在有了一组新的振幅和一组新的相位。
5. 这是关键的一步。我们丢弃刚刚计算出的新振幅，用我们实际在探测器上*测量*到的原始振幅替换它们。但是——这就是魔力所在——我们*保留*了新的相位！它们是我们改进后的猜测。
6. 现在我们一遍又一遍地重复这个循环——逆变换，应用实空间约束，正变换，应用傅里叶空间约束。

这听起来简单得几乎不像是可行的，但在很多情况下，这个过程会收敛！相位信息被隐含地包含在衍射图样的结构和实空间约束中。该算法通过在两个域之间来回切换，成功地“恢复”了丢失的相位，并重构出物体的高保真图像。[@problem_id:1281201] 我们建造了一个不是用玻璃，而是用逻辑构成的透镜。

### 建立三维图像：傅里叶切片定理

到目前为止我们讨论的方法给了我们一个美丽的、物体的二维*投影*。但我们想要的是完整的、壮丽的三维结构。这就是衍射层析成像中“层析成像（tomography）”的意义所在。

这个原理非常直观，并且在另一种超分辨率显微技术——结构光照明显微术（SIM）——中有一个强有力的类比。在SIM中，为了获得更高分辨率的二维图像，样品被条纹光图案照亮。这种图案使显微镜能够“看到”它通常无法看到的精细细节（高空间频率）。但是，为了看到*所有*方向上的*所有*精细细节，你必须物理旋转条纹图案并拍摄多张图像。图案的每个方向都捕获了一部分不同的高频信息。然后，计算机在傅里叶空间中将所有这些部分拼接在一起，构建出一个完整的、高分辨率的二维图像。[@problem_id:2339973]

衍射层析成像的工作原理完全相同，但应用于三维。单个二维衍射图样（经过相位恢复后）为我们提供了物体三维傅里叶空间的一个“切片”。这种基本关系被一个优美的数学定理——**傅里叶切片定理**——所体现。该定理指出，一个物体的投影的二维傅里叶变换，完全等同于穿过该物体三维傅里叶变换原点的一个二维切片。

因此，为了在三维中重构物体，我们做的正是你直觉上会想到的事情：我们旋转物体，并在每个角度记录一个二维衍射图样。一旦我们解决了每个图样的相位问题，它就为我们提供了三维傅里愈信息的一个新切片。通过在不同方向收集数百或数千个这样的切片，我们可以填充物体的三维傅里叶空间。一旦这个空间被充分填充，一次三维逆傅里叶变换就揭示了物体完整的三维结构，就像从大量的二维横截面组装成一个三维拼图一样。

### 提醒一句：单次散射假设

这整个优雅的框架，从简单的傅里叶关系到傅里叶切片定理，都建立在一个关键的物理假设之上：入射波在物体内部*最多只散射一次*。这被称为**运动学近似**或第一玻恩近似。它假设散射波仅仅是离开物体，而不会再次散射。

对于许多应用来说，这是一个极好的近似。例如，当我们对生物样品使用X射线时，X射线光子与原子（主要是碳和氧等轻元素）之间的相互作用非常弱。散射的概率非常低，以至于即使在几十微米厚的样品中，一个光子几乎肯定只会散射一次（如果发生散射的话）。运动学近似完美成立。[@problem_id:2839288]

然而，如果我们将探针换成电子，情况就大不相同了。电子与原子的静电势——包括原子核和电子云——相互作用，这种相互作用比X射线强数千倍。在这种情况下，一个电子进入一个即使只有几十纳米厚的样品，也极有可能发生多次散射。此外，散射的电子波可能足够强，以至于与原始光束以及彼此之间发生相互作用，这种现象被称为**动力学散射**。

当多重散射和动力学散射变得显著时，物体与其衍射图样之间的简单傅里叶关系就不再成立。问题变得非常、非常困难。这并不意味着不可能解决——科学家们已经开发出更复杂的理论和算法来处理这些情况——但它提醒我们，我们模型的优美简洁性有其局限性。理解这些局限性与理解原理本身同样重要，因为正是在这些前沿领域，下一代的科学发现才得以开启。

