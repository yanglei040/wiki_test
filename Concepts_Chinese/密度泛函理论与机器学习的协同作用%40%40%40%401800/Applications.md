## 应用与跨学科联系

在上一章中，我们打开了物理学家的工具箱，审视了密度泛函理论和机器学习的复杂机制。我们看到，前者为观察原子世界提供了一个强大但并非完美的量子透镜，而后者则提供了一种从数据中学习模式的通用方法。现在，真正的乐趣开始了。当您将这些工具结合起来时会发生什么？您能开展哪些新的科学研究？这就像给一位工匠大师配上了一位革命性的新学徒——这位学徒能从大师的作品中学习，预见问题，甚至提出全新的建造方式。

DFT与ML之间的这种合作不仅仅是一个小小的改进；它正在引发一场遍及各个科学领域的静悄悄的革命。其应用主要分为两个方向。首先，我们可以将工具向内，利用ML来锐化、完善甚至重建DFT本身。其次，我们可以将它们向外，挥舞这些“超级充电”的计算显微镜来解决实际问题，从设计新材料到发现拯救生命的药物。让我们踏上这段穿越新前沿的旅程。

### I. 铸造更好的“通用工具”：寻求完美的泛函

DFT的核心是交换相关（$E_{xc}$）泛函——这是解释电子间极其复杂舞蹈的“秘方”。几十年来，物理学家和化学家一直在英勇地寻求找到那个唯一的、真正的泛函，这项努力类似于建造一把能完美适配所有量子螺母和螺栓的通用扳手。我们现有的泛函，如PBE，是了不起的成就，但它们是近似的。它们对许多系统效果很好，但对其他系统可能会失败。

这正是机器学习作为一种新型理论家助手登场的地方。我们不再仅仅试图从第一性原理推导出完美的泛函，而是可以*教给*机器它应该是什么样子。这个想法既简单又深刻。我们可以选取一系列我们已知其*精确*能量（或从一种昂贵得多的理论得到的非常精确的能量）的分子。然后，我们用一个标准的、近似的泛函计算其能量。两者之间的差异就是误差。我们可以训练一个ML模型来学习这个误差作为电子密度的函数。结果就是一个机器学习的校正项，当加到我们的标准泛函上时，会给出一个更准确的答案。

这在实践中意味着什么？这意味着数字会改变，而对化学家来说，数字就是一切。想象一下比较一个分子分解成其组成原子所需的能量——即原子化能。一个经过ML增强的泛函可能会对这个能量给出与标准泛函不同的预测。对于像$\mathrm{H}_2$或$\mathrm{N}_2$这样的简单分子，这种校正可能会使预测的键能发生微小但化学上显著的变化，使其更接近实验现实[@problem_id:2903804]。

但为什么要止步于此？也许一个单一的、“一刀切”的泛函的想法是错误的。也许完美的扳手不是一个单一的工具，而是一个能根据每个特定螺栓调整其形状的智能工具。这是ML的另一个前沿。我们可以设计灵活的泛函形式，比如“双杂化”泛函，它将不同的理论成分按一定比例混合，这些比例由$a_x$和$a_c$等参数控制。传统上，这些参数是固定的。但现在，我们可以训练一个ML模型来观察一个分子，分析其特征，并预测针对该特定分子的$a_x$和$a_c$的*最优*值[@problem_id:2454342]。泛函变成了一个动态的、自适应的实体，为每个新的化学挑战量身定制。这是一个美丽的例子，展示了ML如何为我们的物理理论引入新的复杂性和个性化水平。

最终的挑战在于处理DFT中最基本和最困难的部分，这些部分几十年来一直困扰着人类的努力。其中一个“圣杯”是无相互作用动能泛函$T_s$。虽然我们可以为给定系统精确计算它，但拥有一个准确的关于$T_s$的密度泛函将开辟全新的DFT方法，特别是对于使用像“冻结密度嵌入”（Frozen Density Embedding）[@problem_id:2892989]这样的“子系统”方法处理巨大系统。这些方法通过将一个大系统（如蛋白质中的药物）分解成更小、可管理的部分来工作。困难在于描述这些部分之间的量子相互作用，这一项关键地依赖于一个非加和的动能势。在这里，ML不仅仅是拟合曲线；它被用来构建一个必须遵循一系列精确物理定律的函数——标度条件、不变性原理和像可积性这样的数学性质。通过将这些定律构建到ML模型的结构中，我们不仅仅是在寻找一个答案；我们正在发现一块新的基础物理学。

### II. 运用工具：从模拟材料到设计药物

一旦我们有了更好的工具——无论是通过改进DFT本身还是仅仅接受其威力——我们就可以用它来探索世界。然而，最大的挑战一直是成本。一次精确的DFT计算可能需要在超级计算机上花费数小时或数天。模拟一个蛋白质的折叠或一个电池的充电将需要数十亿次这样的计算，这远远超出了我们的能力范围。这正是ML提供其第二个巨大馈赠的地方：根本性的加速。

#### A. 闪电般的量子领域：加速模拟

想象一下，你想设计一个更好的电池。一个关键部件是电解质，即离子穿行的材料。一些最有前途的候选者是被称为“超离子导体”的固体，其中像锂这样的原子可以以惊人的速度在晶格中穿行。为了理解和设计这些材料，我们需要看到离子的运动。我们需要制作一个原子运动的“电影”，我们通过一种叫做分子动力学（MD）的技术来实现。为了使这部电影逼真，每一帧中原子上的力都必须使用DFT以量子力学精度计算。这被称为*从头算*MD（AIMD）。问题是什么？你可能在花费数周的计算机时间后，只能模拟电影的几皮秒——也就是几帧。你看到了晃动，但你永远看不到离子从一个位置跳到另一个位置的罕见而关键的事件。

ML势应运而生。我们可以使用DFT生成一个高质量的“训练集”数据——即一系列原子排列及其对应的力。然后，我们训练一个ML模型，通常是一个复杂的神经网络，来学习这个力场。这个机器学习原子间势（MLIP）然后可以比DFT快几个数量级地预测原子上的力，而精度几乎相同。突然之间，你的电影可以运行的不是皮秒，而是纳秒或更长。你可以看到离子跳跃，你可以测量它们扩散得多快，你可以计算材料的电导率。你终于可以看到你提议的材料是否是超离子导体[@problem_id:2526598]。当然，创建一个*好的*MLIP本身就是一门艺术。你必须巧妙地选择你的训练数据，确保它包括对应于离子跳跃的高能“鞍点”构型。你必须正确处理在离子材料中普遍存在的长程静电力。而且你必须有一种量化模型不确定性的方法，这样你才能知道何时可以信任它的预测。

这种加速的力量也深入到化学领域。化学反应同样关乎运动——原子重排，化学键断裂和形成。要理解反应的速率，我们需要知道反应物必须攀越的能垒高度。对于像氢这样的轻原子，甚至会发生更奇怪的事情：它们可以“隧穿”过能垒，这是一种纯粹的量子力学效应。为了捕捉这些量子核效应，化学家使用强大的模拟技术，如路径积分分子动力学。就像AIMD一样，当这些方法与DFT结合时，它们极其昂贵。但是，通过用预先训练好的ML势取代即时DFT计算，我们可以运行这些复杂的量子模拟，并准确预测像动力学同位素效应这样的微妙现象，即用氢的重同位素氘取代氢可以显著减慢反应[@problem_D:2677491]。这是理论的完美结合：ML提供了快速、准确的势能面，而量子统计力学提供了探索它的引擎。

ML加速的另一个出奇简单的应用是克服“基组”问题。任何量子化学计算的准确性都取决于用于表示轨道的数学基组的大小。更大的基组更准确，但成本也高得多。最终目标是“完全基组”（$E_{\mathrm{CBS}}$）极限。估计这个极限的一个常用策略是用几个尺寸递增的基组进行计算并外推。机器学习提供了一条捷径。通过在一个大型分子数据库上训练模型，它可以学习与一个小型、廉价基组相关的典型误差。然后，模型可以仅从*一次*小基组计算中预测达到$E_{\mathrm{CBS}}$极限所需的校正[@problem_id:2450764]。这种“Δ-学习”策略，即机器学会预测*校正*而不是整个量，是一个反复出现的强大主题。它让廉价的物理模型承担繁重的工作，而ML模型则提供最后、微妙的精修。

#### B. 解读分子语言：预测性质和功能

在另一类应用中，DFT不是最终答案，而是高质量数据的生成器。其目标是预测一个宏观性质——分子的酸度、颜色、生物活性——这些性质太复杂以至于无法直接计算。这里的策略是使用DFT计算一组我们认为与目标性质相关的基本量子性质或“描述符”。这些描述符然后成为ML模型的输入特征，由ML模型学习最终的联系。DFT提供词汇，ML学习语法。

一个引人注目的例子来自药物发现领域。当你服用药物时，你的身体会努力分解并消除它，这个过程称为新陈代谢。负责这一过程的一个主要酶家族是细胞色素P450。预测一个潜在候选药物被这些酶代谢的速度是一个价值数十亿美元的问题。在许多这些反应中，主要步骤是氧化——即移除一个电子。一个分子被氧化的难易程度与其电离势有关。虽然对成千上万的候选药物测量这个值很困难，但我们可以使用DFT近似计算它。根据可追溯到Koopmans定理的一个原理，最高占据分子轨道的能量$-\epsilon_{\mathrm{HOMO}}$可以作为电离势的一个很好的替代。因此，我们可以计算一系列药物分子的$-\epsilon_{\mathrm{HOMO}}$，并将其作为ML模型中的一个关键特征来预测它们的代谢率[@problem_id:2456977]。这在分子的量子结构与其在人体内的命运之间建立了一个直接、可计算的联系。当然，反应性不仅仅与整个分子有关。一个更复杂的模型还会包括*局部*描述符，这些描述符告诉我们分子的*哪个部分*最容易受到攻击，以及描述药物如何与酶的活性位点结合的其他特征[@problem_id:2456977]。

同样的理念适用于无数的化学性质。以酸度为例，用$\mathrm{p}K_{\mathrm{a}}$衡量。例如，苯酚的酸度对其芳环上连接的化学基团极其敏感。这些基团影响电子结构，进而决定去质子化形式的稳定性。碰巧的是，原子核的NMR化学位移也是其局部电子环境的一个极其敏感的探针。一个增加酸度的吸电子基团也会以特征性的方式改变附近碳和质子核的化学位移。这种联系是直接而物理的。因此，我们可以训练一个ML模型，输入从DFT计算中得到的*计算出的*NMR化学位移集，并让它预测实验的$\mathrm{p}K_{\mathrm{a}}$[@problem_id:2459369]。我们正在使用一个计算出的性质来预测另一个，通常更难测量的实验性质。

这些联系甚至可能更加微妙。分子不是静止的；它们在不断振动和旋转。绕化学键旋转的能垒决定了分子的柔韧性。这可能很难直接计算。然而，另一个NMR参数，即自旋-自旋耦合常数（$^3J$），已知其对连接耦合原子核的键的二面角非常敏感——这一关系最早由Martin Karplus描绘出来。我们能反过来利用这一点吗？我们能把计算出的$J$-耦合常数作为特征来训练一个ML模型，以预测扭转能垒吗？答案是，原则上可以。能垒和耦合常数都是相同底层电子结构的结果。虽然来自平衡结构的一个单一耦合值可能不足以唯一确定能垒，但通过向模型提供更多信息——比如耦合常数如何随角度变化——我们确实可以训练它学习这种光谱性质与分子构象能量学之间的深层联系[@problem_id:2459353]。

#### C. 量子现实的新视野：精炼我们的概念

也许所有应用中最迷人的一项，不是预测一个数字，而是改变我们对量子世界本身的看法。从Kohn-Sham DFT计算中产生的轨道，严格来说，是数学上的辅助量。它们不是在光电发射实验中电子被敲出的“真实”轨道。那个更具物理意义的对象叫做戴森轨道（Dyson orbital），其定义是分子的多电子波函数与所得离子的多电子波函数之间的重叠。戴森轨道包含有关电子相关的信息，并具有正确的物理行为，例如远离分子时的正确指数衰减。

我们能否使用ML来“修正”一个Kohn-Sham轨道，并将其转换为相应的戴森轨道？这是一个比预测单个数字远为宏大的任务。这是一个函数到函数的映射。在这里，一个复杂的、旋转等变的神经网络可以在来自高水平理论的KS和戴森轨道对上进行训练。但我们能做的不仅仅是向它展示例子。我们可以*教给*网络物理定律。我们可以构建一个损失函数，它不仅奖励模型匹配目标戴森轨道的形状，而且如果其输出不具有由电离势决定的正确渐近衰减，或者其范数不等于已知的谱学因子，还会明确地惩罚它[@problem_id:2456904]。这是物理信息机器学习最优雅的形式。它是一个不仅从数据中学习，也从原理中学习的工具。它在我们近似的理论和更严谨的物理现实之间架起了一座桥梁，为我们提供了一个被修正、更清晰的视野。

### 结论

我们所经历的旅程是非凡的。我们见证了机器学习以多种方式充当密度泛函理论的合作伙伴：作为理论家，共同设计更准确和自适应的泛函；作为不知疲倦的助手，将材料和反应的大规模模拟加速几个数量级；作为大师级的解释者，解读分子的量子语言以预测其真实世界的行为，甚至精炼我们的基本概念。

令人兴奋的是，这并非故事的结局，而恰恰是开端。我们讨论的每一个应用都是一个活跃且蓬勃发展的研究领域。当物理学的结构化知识与现代人工智能灵活、强大的学习能力相结合时，我们才刚刚开始发现由此产生的可能性。前方的道路不是用机器取代人类科学家，而是创造一种新型的科学伙伴关系。这种伙伴关系有望加速发现的步伐，解开我们曾认为无法处理的复杂性，并继续揭示支配我们宇宙的法则的深刻之美和统一性。