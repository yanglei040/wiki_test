## 引言
[偏微分方程](@entry_id:141332) (PDEs) 的数值解是现代科学与工程的基石。虽然像连续[有限元法](@entry_id:749389)这样的传统技术一直是基础，但它们对连续性的严格要求在处理复杂几何形状和[并行计算](@entry_id:139241)时会带来挑战。间断 Galerkin (DG) 方法作为一种强大而灵活的替代方案应运而生，它通过接纳而非避免不连续性来解决这些限制。本文对这一创新方法进行了全面的探讨。在第一章“原理与机制”中，我们将深入研究 DG 方法的核心思想，从允许破碎解所获得的自由到[数值通量](@entry_id:752791)在确保物理一致性和稳定性方面的关键作用。随后，“应用与跨学科联系”一章将展示该方法的多功能性，揭示它如何统一旧有技术、驾驭激波等复杂物理现象，并与从[地球物理学](@entry_id:147342)到机器学习的各个领域建立联系。

## 原理与机制

### 不连续的自由

让我们从工程和物理学领域一个熟悉的画面开始：连续有限元法 (FEM)，也被称为**连续 Galerkin (CG) 方法**。想象一下，你被赋予一项任务，要为像飞机机翼这样的复杂物理对象建立一个计算机模型。一种标准方法是将复杂形状分解成由立方体或四面体等更简单、更小的形状组成的网格——这些就是有限**单元**。在每个单元内，你用一个简单的函数（如多项式）来近似解（比如温度或应力）。CG 方法的基本规则是严格的一致性：相邻单元的多项式片段必须在它们的边界上完美地拼接在一起，从而在整个对象上形成一个单一、完整、连续的函数。这是一个非常自然且强大的约束。

但如果我们打破这个规则呢？这就是**间断 Galerkin (DG) 方法**核心处激进而美丽的想法。我们抛弃了对严格连续性的要求。我们允许我们的近似在单元之间的边界处是“破碎”的。我们构建的解可以在这些界面上存在跳跃，即**不连续**。[@problem_id:2375621]

起初，这似乎是一种倒退。我们为什么会想要一个故意破碎的解呢？答案是自由。通过放宽连续性的严格约束，我们获得了巨大的灵活性。我们可以自由地使用大小和形状各异的单元紧挨在一起。我们可以轻易地拥有“[悬挂节点](@entry_id:149024)”，即一个大单元的角点与几个小单元的边相接。对于希望执行 **h-加密**（即在特定区域添加更小的单元以捕捉精细细节，如机翼边缘附近的[湍流](@entry_id:151300)，而无需改变整个网格）的科学家和工程师来说，这是一个梦想。在 DG 框架中，这种复杂而强大的技术变得出奇地自然。[@problem_id:3328245]

### 单元的巴别塔与翻译器的需求

然而，这种自由是有代价的。如果每个单元都是一座孤岛，其局部解完全不了解其邻居，那么我们就没有一个单一、连贯的物理系统模型。我们只有一堆独立的问题。力如何在界面上平衡？波如何从一个单元传播到下一个单元？物理学的核心——系统不同部分之间的相互作用——就丢失了。[@problem_id:2375621]

问题从根本上说在于模糊性。在任意两个单元（比如 $K^+$ 和 $K^-$）之间的界面上，我们破碎的解现在有两个不同的值，我们可以称之为 $u^+$ 和 $u^-$。因此，物理通量——无论是热流、动量还是[电磁场](@entry_id:265881)分量——的定义就变得不明确了。为了计算跨越边界的流量，我们应该使用左边的值 $u^-$，还是右边的值 $u^+$？

DG 方法的核心角色就在此时登场了：**[数值通量](@entry_id:752791)**，通常用 $\hat{f}$ 表示。数值通量是一个精确定义的数学规则——一个函数——它解决了这种模糊性。它取界面两侧的两个状态 $u^+$ 和 $u^-$，并为跨越该边界的通量生成一个单一、明确的值。它扮演着通用翻译器的角色，一种通信协议，使得孤立的岛屿单元能够以明确且具有物理意义的方式相互“交谈”。[@problem_id:2420785] 整个 DG 方法都建立在这个概念之上；[数值通量](@entry_id:752791)的选择定义了方法的具体特性和行为。

### 通信法则

这个翻译器，即[数值通量](@entry_id:752791)，不能是任意的。为了发挥作用，它必须遵守与物理原理直接对应的基本法则。其中两条法则是不可协商的。[@problem_id:3364308] [@problem_id:3373459]

首先是**守恒**定律。这是物理学中最深刻的原理之一：流入的必须等于流出的。对于数值方法而言，这转化为一个简单的规则，适用于任意两个相邻单元 $K_1$ 和 $K_2$ 之间的通量：[数值通量](@entry_id:752791)所说的离开 $K_1$ 的量必须与它所说的进入 $K_2$ 的量完全相等。在单元之间无限小的空间里，不能凭空产生或消失任何质量、动量或能量。如果 $n$ 是在共享面上指向 $K_1$ 外部的[法向量](@entry_id:264185)，那么指向 $K_2$ 外部的法向量就是 $-n$。[数值通量](@entry_id:752791)的[守恒定律](@entry_id:269268)便以优美的对称形式表达为：$\hat{f}(u_1, u_2, n) = -\hat{f}(u_2, u_1, -n)$。这一性质确保了当我们将所有单元的变化相加时，内部边界上的通量会完美抵消，域内的总量仅因最外层边界的通量而改变——正如真实世界一样。[@problem id:3364308]

其次是**一致性**定律。该定律确保我们实际上是在解决正确的问题。它规定，如果在界面上没有分歧——也就是说，如果解恰好在那里是连续的（$u^+ = u^-$）——那么我们这个特殊的翻译器就应该让开，让真正的物理学说话。在这种情况下，[数值通量](@entry_id:752791)必须简化为真正的物理通量。在数学上，这写作 $\hat{f}(u, u, n) = f(u) \cdot n$。这是一个健全性检查，将我们的[数值近似](@entry_id:161970)与我们最初要解决的[偏微分方程](@entry_id:141332)联系起来。

### 驯服流动：波与平衡的稳定性

有了一个既守恒又一致的通信协议，我们还面临最后一个关键问题：单元之间由此产生的对话是否稳定？还是说微小的误差会放大并增长，导致混乱、无意义的结果？确保稳定性的策略在很大程度上取决于我们所建模的物理类型。

#### 双曲问题：风的智慧

双曲方程，如平流方程 $u_t + a u_x = 0$，描述了具有明确传播方向的现象——水上的波浪、空气中的声音，或河流携带的污染物。这些系统的物理学全都与信息的流动有关。如果风从左向右吹（$a > 0$），那么在你所在位置发生的事情是由你左边*上游*发生的事情决定的，而不是由你右边下游发生的事情决定的。

**[迎风通量](@entry_id:143931)**正是这种物理直觉的巧妙数值实现。在界面处，它通过简单地选择来自“上游”方向——即信息流动的方向——的值来解决模糊性。对于 $a>0$，它规定通量应使用来自左侧单元的状态 $u^-$ 来计算。这个简单、基于物理动机的选择非同寻常。它不仅是一致和守恒的，而且还引入了恰到好处的[数值耗散](@entry_id:168584)（可以把它想象成一种微小的、起稳定作用的阻力），以抑制虚假的[振荡](@entry_id:267781)并保证方法的稳定性。可以证明，数值解的总能量不会随时间增长。[@problem_id:2375621] [@problem_id:3373459] [@problem_id:2679430]。这与简单地平均左右状态的天真“中心”通量形成鲜明对比。虽然[中心通量](@entry_id:747204)是守恒的，但它不包含耗散，并且是出了名的不稳定，就像一支完美平衡的铅笔注定要倒下一样。[@problem_id:3373459]

#### [椭圆问题](@entry_id:146817)：为跳跃付出代价

现在考虑[椭圆方程](@entry_id:169190)，如[泊松方程](@entry_id:143763) $-\Delta u = f$。这些方程描述处于平衡状态的系统，例如房间内的[稳态温度分布](@entry_id:176266)或桥梁在负载下的静态变形。在这些问题中，没有“上游”方向。信息同时向四面八方传播以建立全局平衡。

我们的 DG 解仍然是不连续的，但其底层的物理是连续的。我们如何能鼓励我们的数值解尊重这一点呢？**[对称内部罚](@entry_id:755719) Galerkin (SIPG) 方法**使用了一个非常直观的想法：我们让解的不连续变得代价高昂。我们在方程中添加一个**罚项**，该项与界面处跳跃的平方成正比，即 $\eta \llbracket u \rrbracket^2$。你可以把这想象成用微小而坚硬的弹簧连接我们解的断裂边缘。如果解试图在界面上产生大的跳跃，那么“弹簧”就会用力回拉，为系统的总“能量”增加一个巨大的成本。通过选择一个足够大的罚参数 $\eta$，我们可以从数学上证明整个系统是稳定的并且有唯一解。这个被称为**矫顽性**的性质是[椭圆问题](@entry_id:146817)稳定性的基石，它确保了不相连的单元被迫合作以找到一个合理的全局平衡。[@problem_id:2679430] [@problem_id:3401201]

### 回报：一个为现代而生的方法

这个由精心设计的数值通量耦合的不连续单元框架可能看起来错综复杂，但其回报是巨大的。它使得 DG 方法特别适合应对现代计算科学的挑战。

*   **极致的灵活性**：DG 对[不连续性](@entry_id:144108)的内在容忍性使其天然适用于复杂几何形状，以及最重要的**自适应网格加密**。模拟可以自动在需要的地方——例如激波附近或高应力区域——精确地添加更小、更精细的单元，而无需担心由此产生的不匹配界面。[@problem_id:3328245]

*   **高阶的威力**：在每个单元内部，解不仅仅是一个常数或一条直线，而可以是一个高次多项式 ($p$)。这种在单个单元内表示复杂变化的能力，即**[p-加密](@entry_id:173797)**，使得 DG 方法能够用比低阶方法少得多的单元达到极高的精度。为了充分发挥这种威力，必须在实现中小心谨慎，例如，使用足够精度的[数值求积](@entry_id:136578)法则来计算单元积分，以避免引入新的误差。[@problem_id:3405888]

*   **并行计算的超级明星**：或许 DG 在 21 世纪最重要的优势是其为并行计算而生的优美结构。绝大多数的计算工作——在每个单元体积内计算的积分——是完全局部的。一个单元在执行这项工作时不需要来自任何其他单元的信息。唯一需要的通信是与其直接相邻的面邻居交换数据以计算数值通量。这导致了非常低的**通信计算比**。当为了追求更高精度而增加多项式次数 $p$ 时，局部工作量（计算量，在三维情况下对于许多格式其缩放级别为 $O(p^6)$）的增长速度远快于需要跨处理器通信的数据量（其缩放级别与表面积相关，为 $O(p^2)$）。这意味着超级计算机上的处理器将时间花在做有用的工作上，而不是等待来自远方的数据。这就是 DG 方法在世界上最大的[并行计算](@entry_id:139241)机上展现出卓越扩展性能的原因。[@problem_id:3401248]

从[波的传播](@entry_id:144063)到结构力学，从简单区域到复杂、[自适应加密](@entry_id:746260)的网格，间断 Galerkin 方法提供了一个单一、优雅且强大的框架。它始于接纳不连续性的颠覆性想法，并通过巧妙设计局部通信规则——即数值通量——构建了一个稳健、高精度且可大规模并行的工具，用于求解科学和工程中的方程。这是一个深刻的例子，说明了允许局部的“无序”如何能够产生更强大、更灵活的全局秩序。

