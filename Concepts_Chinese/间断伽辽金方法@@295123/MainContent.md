## 引言
几十年来，连续伽辽金（CG）[有限元法](@entry_id:749389)一直是[求解偏微分方程](@entry_id:138485)的基石，它通过在整个问题域上强制实现完美的连续性来提供优雅的解决方案。然而，当面对激波或尖锐锋面等现象时，这种数学上的优雅却成了一个致命的弱点，因为严格的连续性要求可能导致灾难性的[数值不稳定性](@entry_id:137058)。这一局限性催生了对一种新方法的需求，这种方法需要能够稳健而高效地处理此类[不连续性](@entry_id:144108)。

本文探讨了间断伽辽金（DG）方法，这是一种革命性的[范式](@entry_id:161181)，它通过拥抱间断性来弥补这一空白。我们将首先在 **“原理与机制”** 一章中揭示使 DG 方法奏效的基础概念，探讨它如何解放单元并利用[数值通量](@entry_id:752791)来维持秩序。随后，**“应用与跨学科联系”** 一章将展示该方法在广阔的科学和工程挑战领域中非凡的通用性和强大威力。

## 原理与机制

要真正领会间断伽辽金（DG）方法，我们必须首先理解它所脱离的世界：一个连续性的世界。几十年来，工程和物理学问题的主流方法一直是连续伽辽金（CG）[有限元法](@entry_id:749389)。可以把它想象成用完美互锁的砖块建造一座结构。每一块砖都是一个定义在小空间区域（一个单元）上的简单数学函数（一个多项式）。CG 的基本规则是，这些砖块必须在它们的边缘无缝拼接，从而在整个域上创建一个单一的、连续的函数。

这种全局连续性的要求在数学上是优雅的。它是通过从一种特殊的[函数空间](@entry_id:143478)——Sobolev 空间 $H^1(\Omega)$ 中选择我们的近似解来实现的，该空间包含的函数不仅是平方可积的，而且其一阶导数在整个域 $\Omega$ 上也是平方可积的 [@problem_id:3584974]。对于许多物理现象，比如热量的缓慢扩散，这是一种完全自然且有效的方式。

但是，当物理过程不那么“温柔”时会发生什么呢？考虑一个波或一个尖锐的锋面在介质中传播。这由一个双曲方程来描述，比如线性[平流方程](@entry_id:144869) $u_t + a u_x = 0$。在这里，信息以决定性的方式朝一个方向流动。事实证明，CG 方法的刚性连续性可能正是其致命弱点。当我们使用标准 CG 方法离散[平流方程](@entry_id:144869)并应用一个简单、直观的时间步进方法（如前向欧拉法）时，可怕的事情发生了：该格式是无条件不稳定的。微小的数值误差非但没有被抑制，反而在每一步都被放大，演变成剧烈的、非物理的[振荡](@entry_id:267781)，最终摧毁解 [@problem_id:3395029]。这在数值上等同于塔科马海峡大桥（Tacoma Narrows Bridge）的悲剧，一个结构本身完美无缺，却因与风产生灾难性的共振而坍塌。罪魁祸首深藏于数学之中：CG 空间算子是**斜伴随**的，意味着它的[特征值](@entry_id:154894)是纯虚数。对于[前向欧拉法](@entry_id:141238)，这保证了任何[振荡](@entry_id:267781)模式的振幅都会无一例外地增长 [@problem_id:3395029]。

正是在这里，DG 哲学提出了一个激进的建议：如果我们打破连续性的枷锁会怎样？

### 间断的自由

想象一下，不是用互锁的砖块建造，而是用并排放置的简单木块。每个木块都是独立的，不需要与邻居连接。这就是 DG 的基本思想。我们将[基函数](@entry_id:170178)定义为只存在于单个单元内部、而在其他任何地方都为零的多项式 [@problem_id:2375621]。我们完全放弃了对单一[连续函数](@entry_id:137361)的要求。

这使我们摆脱了 $H^1(\Omega)$ 空间的束缚。我们的新舞台是更大的**破碎 Sobolev 空间**，通常写作 $H^1(\mathcal{T}_h)$，它仅仅是所有函数的一个集合，这些函数在我们的网格 $\mathcal{T}_h$ 的每个单元 $K$ *内部* 表现良好且具有平方可积的导数，而完全不考虑边界上发生什么 [@problem_id:3378054]，[@problem_id:3584974]。当然，如果我们的函数是破碎的，那么我们测量它们的方式也必须是破碎的。依赖于全局导数的标准 $H^1$ 范数不再有定义。我们必须转而采用一种**破碎范数**，通过将每个单元的贡献相加来测量函数的大小 [@problem_id:2389376]。

这种自由令人振奋。我们现在可以在不同单元中使用不同阶数的多项式，这种技术称为 **p-自适应**。我们可以处理具有扭曲单元的极其复杂的几何形状，因为一个单元的质量不再直接影响其邻居的[基函数](@entry_id:170178)。而且因为大部分数学运算都在每个孤立的单元内进行，该方法天然地适合并行计算。

但这种自由是有代价的。在解放单元的同时，我们也隔离了它们。[微分方程](@entry_id:264184)——这个从根本上说明了一个点的函数如何与其近邻相关的陈述——已经失去了意义。我们有了一堆独立的单元，却没有一个“[偏微分方程](@entry_id:141332)”可解。我们需要教会这些单元如何相互交谈。

### 通过通量进行通信

解决方案在于我们推导该方法时出现的那些项。在标准 CG 方法中，当我们进行分部积分时，由于强制的连续性，单元边界上产生的项会与相邻单元的项完美抵消。在 DG 中，这种抵消不会发生。在任意两个单元之间的界面上，我们的解有两个不同的值：一个来自左边（$u^-$），一个来自右边（$u^+$）。

这些遗留的、未抵消的边界项不是一个需要修复的问题；它们是一个可以利用的机会。它们是我们孤立的单元进行通信的渠道。挑战在于为这种通信定义一个单一、明确的规则。我们需要用一个单一的、明确定义的值来取代界面上双值的物理量。这个值就是**[数值通量](@entry_id:752791)**。

数值通量，用 $\hat{f}$ 或 $\hat{u}$ 等符号表示，是一个函数，它接受界面两侧的两个状态 $u^-$ 和 $u^+$，并将它们组合起来，为穿过该界面的通量生成一个单一的值 [@problem_id:2375621]。这是支配相邻单元如何相互作用的“契约”或“协议”。这种通量的设计是 DG 方法的艺术与科学所在。任何合理的数值通量的一个基本要求是它必须是**相容的**：如果碰巧解在界面上是连续的（$u^- = u^+$），数值通量必须简化为真实的物理通量 [@problem_id:3373459]。

### [平流](@entry_id:270026)问题的[迎风](@entry_id:756372)艺术

那么，我们如何设计一个好的通信协议呢？让我们回到平流方程 $u_t + a u_x = 0$，其中信息以速度 $a$ 流动。如果 $a>0$，信息从左向右传播。理所当然地，界面上的状态应该由*流向*它的东西决定，而不是由另一边的东西决定。这就是**迎风**原理——一个极其简单却又威力无穷的原则。

**[迎风](@entry_id:756372)数值通量**正是这样做的。在任何界面上，它只选择来自上游（[迎风](@entry_id:756372)）一侧的值 [@problem_id:2375621]。如果一个面上的法向量 $n$ 从“$-$”侧指向“$+$”侧，那么量 $au$ 的[迎风通量](@entry_id:143931)在数学上定义为：

$$
\widehat{a u} = \begin{cases} a \, u^{-},  \text{if } a \cdot n \ge 0 \text{ (流向与法向一致)}, \\ a \, u^{+},  \text{if } a \cdot n \lt 0 \text{ (流向与法向相反)}. \end{cases}
$$

这可以用一个单一、优雅的公式写成 $\frac{1}{2} (a \cdot n)(u^{-} + u^{+}) + \frac{1}{2} |a \cdot n| (u^{-} - u^{+})$ [@problem_id:3441754]。第一部分是一个简单的平均（[中心通量](@entry_id:747204)），第二部分是一个与解的跳跃成比例的耗散项。

这个耗散项是成功的秘诀。虽然一个简单的[中心通量](@entry_id:747204)是[能量守恒](@entry_id:140514)的，并导致与 CG 方法相同类型的不稳定性，但[迎风通量](@entry_id:143931)以一种非常聪明的方式引入了**[数值耗散](@entry_id:168584)**。对系统能量的分析表明，[迎风通量](@entry_id:143931)恰好在存在跳跃的界面上耗散能量，并且耗散量与跳跃大小的平方成正比，即 $|a|(u^- - u^+)^2$ [@problem_id:3373459]。这种有针对性的阻尼消除了困扰 CG 方法的[伪振荡](@entry_id:152404)，从而稳定了整个格式。

这使我们得到了数值分析中最优美的结果之一：**Lax 等价定理**。它指出，对于一个适定的线性问题，一个数值方法收敛到真解，当且仅当它既是**相容的**（它近似了正确的物理过程）又是**稳定的**（误差不会无界增长）。标准的 CG 平流方法之所以失败，是因为它虽然相容，却不稳定。带有[迎风通量](@entry_id:143931)的 DG 方法之所以成功，是因为它既相容，又 благодаря [迎风通量](@entry_id:143931)的智能耗散而稳定 [@problem_id:3395029]。

### 驯服[扩散](@entry_id:141445)：罚函数与[混合方法](@entry_id:163463)

迎风的思想对于[平流](@entry_id:270026)问题是完美的，但对于[扩散](@entry_id:141445)问题又如何呢？例如由泊松方程或热方程 $-\nabla \cdot (\kappa \nabla u) = f$ 描述的[扩散](@entry_id:141445)。在这里，信息不是单向流动；它从所有点向外[扩散](@entry_id:141445)。因此需要一种不同的通信协议。两大类 DG 方法应运而生来处理这种情况。

第一种是**[对称内部罚](@entry_id:755719)函数伽辽金（SIPG）**方法。这种方法直接处理二阶方程。梯度的[数值通量](@entry_id:752791)由平均值构成，但关键成分是一个额外的项，它惩罚解本身在界面上的跳跃。这个**罚项**就像一组连接[不连续函数](@entry_id:143848)值的弹簧，将它们拉到一起，防止它们偏离太远。正是这个罚项确保了方法的稳定性 [@problem_id:2440329]。“对称”这个名称指的是格式的精心构造，它产生了一个对称的全局矩阵——这是[计算效率](@entry_id:270255)上一个非常理想的属性 [@problem_id:3377363]。

第二种是**[局部间断伽辽金](@entry_id:751395)（[LDG](@entry_id:751395)）**方法。这种方法采取了一种极其聪明的策略。它不是直接处理二阶方程，而是首先将其重写为一个一阶[方程组](@entry_id:193238)。我们为通量引入一个新变量 $\boldsymbol{q} = -\kappa \nabla u$，然后同时求解 $u$ 和它的通量 $\boldsymbol{q}$ [@problem_id:3401201]。这种方法的最大优点是，由此产生的格式在构造上是**局部守恒**的。这意味着对于网格中的每一个单元，流出其边界的总[数值通量](@entry_id:752791)完美地平衡了其内部的源——这是一个物理上优美、而 SIPG 方法不能自动保证的属性 [@problem_id:3377363]。

尽管 SIPG 和 [LDG](@entry_id:751395) 似乎源于不同的哲学——一个是原始方法，另一个是[混合方法](@entry_id:163463)——但它们之间有着深刻的联系。在一个展示了数学统一原理的惊人例子中，可以证明在特定条件下，并且通过精心选择[数值通量](@entry_id:752791)，这两种方法在代数上可以变得完全相同 [@problem_id:3377363]。这揭示了离散化相同物理定律的不同方式之间隐藏的统一性。

归根结底，[间断伽辽金方法](@entry_id:748369)是一种建立在权衡之上的强大哲学：它拥抱局部的简单性以实现卓越的全局灵活性。通过允许函数间断，我们获得了轻松建模复杂几何形状的自由，能够用不同大小的单元和多项式阶数进行局部[网格加密](@entry_id:168565)（$h/p$-自适应）[@problem_id:3378054]，并能设计出完美适用于现代[并行计算](@entry_id:139241)机的算法。这种自由的代价是必须深思熟虑地设计通信协议——即[数值通量](@entry_id:752791)——其中编码了问题的物理性质和方法的稳定性。这种局部自由与受控通信之间的优美相互作用，正是[间断伽辽金方法](@entry_id:748369)的核心与灵魂。

