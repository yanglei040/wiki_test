{"hands_on_practices": [{"introduction": "A fundamental task in computational finance is simulating future asset prices. This exercise guides you through deriving the exact solution for the stock price $S_T$ at a future time $T$, a cornerstone for Monte Carlo methods. Mastering this allows for efficient simulation by generating the terminal price directly, bypassing the need to simulate the entire intervening path [@problem_id:1304946].", "id": "1304946", "problem": "A quantitative analyst is building a Monte Carlo simulation model for a non-dividend-paying stock. The price of the stock, $S_t$, is assumed to follow a Geometric Brownian Motion (GBM), which is a stochastic process governed by the stochastic differential equation:\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\nwhere $S_t$ is the stock price at time $t$, $\\mu$ is the constant drift rate (expected return), $\\sigma$ is the constant volatility, and $W_t$ is a standard Wiener process.\n\nFor computational efficiency, the analyst wants to simulate the stock price $S_T$ at a future time $T > 0$ directly from the initial price $S_0$ without simulating the entire price path from $t=0$ to $t=T$. This method involves generating a single random number $Z$ from a standard normal distribution, $N(0,1)$, and using it in a closed-form expression for $S_T$.\n\nGiven the initial stock price $S_0$, the drift $\\mu$, the volatility $\\sigma$, the time horizon $T$, and a standard normal random variable $Z$, determine the correct expression for the final stock price $S_T$.\n\n", "solution": "We start from the geometric Brownian motion SDE for the stock price $S_t$:\n$$\ndS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t.\n$$\nApply It\\^{o}'s lemma to $X_t=\\ln S_t$. For $f(x)=\\ln x$, we have $f'(x)=\\frac{1}{x}$ and $f''(x)=-\\frac{1}{x^{2}}$. It\\^{o}'s lemma gives\n$$\nd\\ln S_t=\\frac{1}{S_t}\\,dS_t+\\frac{1}{2}\\left(-\\frac{1}{S_t^{2}}\\right)(dS_t)^{2}.\n$$\nSubstitute $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$ and use $(dW_t)^{2}=dt$ to obtain\n$$\n(dS_t)^{2}=\\sigma^{2}S_t^{2}(dW_t)^{2}=\\sigma^{2}S_t^{2}\\,dt,\n$$\nso\n$$\nd\\ln S_t=\\frac{1}{S_t}(\\mu S_t\\,dt+\\sigma S_t\\,dW_t)-\\frac{1}{2}\\frac{1}{S_t^{2}}(\\sigma^{2}S_t^{2}\\,dt)\n=(\\mu-\\tfrac{1}{2}\\sigma^{2})\\,dt+\\sigma\\,dW_t.\n$$\nIntegrating from $0$ to $T$ yields\n$$\n\\ln S_T-\\ln S_0=(\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma(W_T-W_0).\n$$\nWith $W_0=0$ and $W_T\\sim \\sqrt{T}\\,Z$ where $Z\\sim \\mathcal{N}(0,1)$, this becomes\n$$\n\\ln S_T=\\ln S_0+(\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z.\n$$\nExponentiating gives the direct simulation formula for the terminal price:\n$$\nS_T=S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z\\right).\n$$", "answer": "$$\\boxed{S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z\\right)}$$"}, {"introduction": "Financial instruments are often functions of an underlying asset, such as a leveraged exchange-traded fund (ETF) whose value might be proportional to the square of a stock index. This practice challenges you to apply Itô's lemma to determine how the dynamics of a process change when it's a power of a Geometric Brownian Motion process, like $Y_t = (S_t)^k$. Solving this is key to understanding how leverage and other nonlinear transformations affect an asset's risk and return profile [@problem_id:1304922].", "id": "1304922", "problem": "In financial mathematics, a common model for the price $S_t$ of a non-dividend-paying stock is the Geometric Brownian Motion (GBM), whose dynamics are described by the stochastic differential equation (SDE):\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\nHere, $\\mu$ is the constant expected rate of return (drift), $\\sigma$ is the constant volatility, and $W_t$ is a standard Wiener process.\n\nConsider a derivative security whose value at time $t$ is given by the process $Y_t = (S_t)^k$, where $k$ is a non-zero real constant. This represents a leveraged position or a fractional claim on the underlying asset. It can be shown that the process $Y_t$ also follows a Geometric Brownian Motion, with an SDE of the form:\n$$dY_t = \\mu_Y Y_t dt + \\sigma_Y Y_t dW_t$$\nYour task is to determine the new drift coefficient $\\mu_Y$ and the new volatility coefficient $\\sigma_Y$ for the process $Y_t$.\n\nExpress your answer as a row matrix containing the expressions for $\\mu_Y$ and $\\sigma_Y$ in that order, in terms of $\\mu$, $\\sigma$, and $k$.\n\n", "solution": "We are given that $S_{t}$ follows the stochastic differential equation of a Geometric Brownian Motion:\n$$\ndS_{t}=\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t}.\n$$\nDefine $Y_{t}=f(S_{t})$ with $f(s)=s^{k}$ where $k\\neq 0$. By It\\^o's lemma for a twice continuously differentiable function $f$,\n$$\ndY_{t}=f'(S_{t})\\,dS_{t}+\\frac{1}{2}f''(S_{t})\\,(dS_{t})^{2},\n$$\nusing the stochastic calculus identities $(dW_{t})^{2}=dt$, $dt\\,dW_{t}=0$, and $(dt)^{2}=0$.\n\nCompute the derivatives:\n$$\nf'(s)=k s^{k-1},\\qquad f''(s)=k(k-1)s^{k-2}.\n$$\nCompute $(dS_{t})^{2}$ from the given SDE:\n$$\n(dS_{t})^{2}=(\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t})^{2}=(\\sigma S_{t}\\,dW_{t})^{2}=\\sigma^{2}S_{t}^{2}\\,dt.\n$$\nSubstitute into It\\^o's formula:\n\\begin{align*}\ndY_{t}\n&=k S_{t}^{k-1}(\\mu S_{t}\\,dt+\\sigma S_{t}\\,dW_{t})+\\frac{1}{2}k(k-1)S_{t}^{k-2}\\left(\\sigma^{2}S_{t}^{2}\\,dt\\right)\\\\\n&=k\\mu S_{t}^{k}\\,dt+k\\sigma S_{t}^{k}\\,dW_{t}+\\frac{1}{2}k(k-1)\\sigma^{2}S_{t}^{k}\\,dt\\\\\n&=\\left(k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2}\\right)S_{t}^{k}\\,dt+k\\sigma S_{t}^{k}\\,dW_{t}.\n\\end{align*}\nSince $Y_{t}=S_{t}^{k}$, we can write\n$$\ndY_{t}=\\mu_{Y}Y_{t}\\,dt+\\sigma_{Y}Y_{t}\\,dW_{t},\n$$\nwith the coefficients identified as\n$$\n\\mu_{Y}=k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2},\\qquad \\sigma_{Y}=k\\sigma.\n$$\nThus, expressed as a row matrix in the order $(\\mu_{Y},\\sigma_{Y})$, the result is\n$$\n\\begin{pmatrix}\nk\\mu+\\frac{1}{2}k(k-1)\\sigma^{2} & k\\sigma\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}k\\mu+\\frac{1}{2}k(k-1)\\sigma^{2} & k\\sigma\\end{pmatrix}}$$"}, {"introduction": "Perhaps the most crucial concept in modern quantitative finance is the distinction between the real-world measure (used for forecasting) and the risk-neutral measure (used for pricing). This exercise solidifies your understanding of why we use the expected return $\\mu$ to predict an asset's future statistical behavior but must switch to the risk-free rate $r$ for arbitrage-free derivative pricing. Grasping this distinction is essential for correctly applying financial models in both predictive and valuation contexts [@problem_id:2397890].", "id": "2397890", "problem": "Consider an arbitrage-free, frictionless market with a constant risk-free rate $r$. Let the underlying asset price $(S_t)_{t \\in [0,T]}$ follow a geometric Brownian motion (GBM) under the physical (real-world) probability measure $\\mathbb{P}$ with dynamics\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\nwhere $\\mu$ is the real-world drift, $\\sigma > 0$ is the volatility, and $(W_t^{\\mathbb{P}})_{t \\ge 0}$ is a standard Brownian motion under $\\mathbb{P}$. Under the risk-neutral measure $\\mathbb{Q}$ associated with $r$, the dynamics are\n$$\n\\mathrm{d}S_t = r S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\nwith the same $\\sigma$ and a $(W_t^{\\mathbb{Q}})_{t \\ge 0}$ that is a standard Brownian motion under $\\mathbb{Q}$. Let $S_0 > 0$ be given.\n\nTwo distinct computational tasks are considered:\n(i) computing the no-arbitrage price at time $0$ of a European call option with maturity $T$ and strike $K > 0$, whose payoff is $h(S_T) = \\max(S_T - K, 0)$, and\n(ii) forecasting the expected future price $\\mathbb{E}^{\\mathbb{P}}[S_T]$ as a real-world statistical target.\n\nAssume one can simulate exact time-$T$ samples of $S_T$ from either the $\\mathbb{P}$-dynamics or the $\\mathbb{Q}$-dynamics, and that numerical discounting at rate $r$ is available.\n\nSelect all statements that are correct.\n\nA. For task (i), simulating $S_T$ under the risk-neutral drift $r$ and using the discounted sample mean of $h(S_T)$ converges to the correct no-arbitrage price as the number of Monte Carlo (MC) paths grows.\n\nB. For task (ii), simulating with drift $r$ is appropriate for forecasting $\\mathbb{E}^{\\mathbb{P}}[S_T]$, because market prices imply risk neutrality.\n\nC. If one naively simulates under the real-world drift $\\mu$ and discounts at rate $r$ to price the European call, the result generally differs from the correct no-arbitrage price unless $\\mu = r$.\n\nD. Under the risk-neutral measure $\\mathbb{Q}$, the discounted asset $e^{-rt} S_t$ is a martingale; under the real-world measure $\\mathbb{P}$, $e^{-rt} S_t$ is generally not a martingale when $\\mu \\neq r$.\n\nE. The volatility parameter used for pricing under $\\mathbb{Q}$ must be a distinct “risk-neutral volatility,” different from the real-world $\\sigma$ even when $\\sigma$ is constant.", "solution": "We start from first principles of the geometric Brownian motion (GBM) model and the fundamental theorem of asset pricing.\n\nUnder $\\mathbb{P}$, the GBM satisfies\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\nand its exact solution is\n$$\nS_T = S_0 \\exp\\!\\Big( \\big(\\mu - \\tfrac{1}{2}\\sigma^2\\big) T + \\sigma W_T^{\\mathbb{P}} \\Big).\n$$\nHence,\n$$\n\\mathbb{E}^{\\mathbb{P}}[S_T] = S_0 e^{\\mu T}.\n$$\nUnder $\\mathbb{Q}$, the GBM satisfies\n$$\n\\mathrm{d}S_t = r S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\nwith solution\n$$\nS_T = S_0 \\exp\\!\\Big( \\big(r - \\tfrac{1}{2}\\sigma^2\\big) T + \\sigma W_T^{\\mathbb{Q}} \\Big),\n$$\nso\n$$\n\\mathbb{E}^{\\mathbb{Q}}[S_T] = S_0 e^{r T}.\n$$\n\nBy the fundamental theorem of asset pricing in this complete, arbitrage-free setting with constant $r$, the time-$0$ no-arbitrage price $V_0$ of a contingent claim with payoff $h(S_T)$ equals\n$$\nV_0 = \\mathbb{E}^{\\mathbb{Q}}\\!\\big[ e^{-rT} h(S_T) \\big].\n$$\n\nWe now assess each statement.\n\nA. For task (i), risk-neutral pricing requires evaluating $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$. If we simulate $S_T$ under the $\\mathbb{Q}$-dynamics and compute the sample mean of $e^{-rT} h(S_T)$, the law of large numbers implies convergence of the MC estimator to $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$ as the number of paths grows, assuming exact sampling of $S_T$ under GBM. Therefore, the estimator converges to the correct no-arbitrage price. Verdict: Correct.\n\nB. For task (ii), the target is the real-world expectation $\\mathbb{E}^{\\mathbb{P}}[S_T] = S_0 e^{\\mu T}$. Simulating with drift $r$ yields $\\mathbb{E}^{\\mathbb{Q}}[S_T] = S_0 e^{rT}$, which generally differs from the real-world expectation unless $\\mu = r$. Market prices implying risk neutrality pertains to pricing, not to real-world statistical forecasting. Verdict: Incorrect.\n\nC. If one simulates under $\\mathbb{P}$ with drift $\\mu$ and simply discounts at $r$, the estimate converges to $\\mathbb{E}^{\\mathbb{P}}[ e^{-rT} h(S_T) ]$, not $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$. These differ in general because the distributions of $S_T$ under $\\mathbb{P}$ and $\\mathbb{Q}$ are not the same when $\\mu \\neq r$. For example, even for the linear payoff $h(S_T) = S_T$, we have\n$$\n\\mathbb{E}^{\\mathbb{P}}[ e^{-rT} S_T ] = e^{-rT} S_0 e^{\\mu T} \\neq S_0 = \\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} S_T ]\n$$\nunless $\\mu = r$. Thus naive $\\mathbb{P}$-simulation plus discounting is generally incorrect without an explicit change-of-measure adjustment. Verdict: Correct.\n\nD. Consider the discounted process $X_t := e^{-rt} S_t$. Under $\\mathbb{Q}$, applying Itô’s lemma yields\n$$\n\\mathrm{d}X_t = \\mathrm{d}(e^{-rt} S_t) = e^{-rt}(-r S_t \\,\\mathrm{d}t) + e^{-rt} \\,\\mathrm{d}S_t = e^{-rt}\\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\nwhich has zero drift, hence $(X_t)_{t \\ge 0}$ is a $\\mathbb{Q}$-martingale. Under $\\mathbb{P}$,\n$$\n\\mathrm{d}X_t = e^{-rt}(-r S_t \\,\\mathrm{d}t) + e^{-rt}(\\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}}) = e^{-rt}(\\mu - r) S_t \\,\\mathrm{d}t + e^{-rt}\\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\nwhich has nonzero drift when $\\mu \\neq r$, so it is generally not a $\\mathbb{P}$-martingale. Verdict: Correct.\n\nE. In the GBM model, Girsanov’s theorem changes the drift but preserves the diffusion coefficient; the volatility parameter $\\sigma$ is the same under $\\mathbb{P}$ and $\\mathbb{Q}$. While market-implied volatility inferred from option prices may differ from a historical estimate, within the model the instantaneous volatility entering the $\\mathbb{P}$- and $\\mathbb{Q}$-dynamics is the same constant $\\sigma$. Verdict: Incorrect.\n\nTherefore, the correct statements are A, C, and D.", "answer": "$$\\boxed{ACD}$$"}]}