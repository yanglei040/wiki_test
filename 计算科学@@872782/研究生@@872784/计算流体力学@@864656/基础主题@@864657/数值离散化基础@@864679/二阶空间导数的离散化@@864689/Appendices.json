{"hands_on_practices": [{"introduction": "在计算流体动力学中，精度是数值模拟成败的关键。直接从泰勒级数展开出发，使用待定系数法是构建高阶差分格式的一项基本功。这项练习将指导你从第一性原理推导一个高阶对称差分格式，这不仅能加深你对截断误差概念的理解，也为你将来设计满足特定精度要求的定制化格式奠定基础。[@problem_id:3311335]", "problem": "考虑一个在区间上至少八次连续可微的光滑标量场 $u(x)$，该场在网格间距为 $h > 0$ 的均匀网格 $x_i = x_0 + i h$ 上进行采样。在计算流体动力学 (CFD) 中，空间导数的高阶精度离散对于减少数值色散和耗散至关重要。从 $u(x)$ 在 $x_i$ 点的泰勒级数展开出发，使用待定系数法，在模板 $\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$ 上构建二阶导数 $u''(x_i)$ 的一个七点对称有限差分近似，使其形式截断误差达到 $\\mathcal{O}(h^6)$ 阶。\n\n假设该近似具有以下形式\n$$\n\\frac{1}{h^2}\\bigl[a_0\\,u(x_i) + a_1\\bigl(u(x_{i+1}) + u(x_{i-1})\\bigr) + a_2\\bigl(u(x_{i+2}) + u(x_{i-2})\\bigr) + a_3\\bigl(u(x_{i+3}) + u(x_{i-3})\\bigr)\\bigr],\n$$\n其中 $a_0, a_1, a_2, a_3$ 是待定的实系数，其选择应使得该近似以 $u''(x_i)$ 为目标，并消除所有与形式截断误差为 $\\mathcal{O}(h^6)$ 一致的低阶误差项。从第一性原理出发，通过将 $u(x_{i \\pm m})$ 在 $x_i$ 点展开为泰勒级数，并施加由二阶导数定义所隐含的必要的一致性和精度条件。\n\n将最终答案表示为一个单行矩阵，其中包含分别对应于 $u(x_i)$、$u(x_{i\\pm 1})$、$u(x_{i\\pm 2})$ 和 $u(x_{i\\pm 3})$ 系数的四个模板权重 $(a_0, a_1, a_2, a_3)$。无需四舍五入；请提供精确值。归一化方式是离散算子为上述加权和乘以 $1/h^2$，因此请勿在行矩阵中包含因子 $1/h^2$。", "solution": "用户希望找到二阶导数 $u''(x_i)$ 的一个七点对称有限差分近似，其截断误差为 $\\mathcal{O}(h^6)$。\n\n首先验证该问题，以确保其科学上合理、适定且完整。\n\n### 步骤 1：提取已知条件\n- **标量场**：$u(x)$，至少八次连续可微 ($u \\in C^8$)。\n- **网格**：均匀网格，$x_i = x_0 + i h$，间距为 $h > 0$。\n- **目标导数**：$u''(x_i)$。\n- **模板**：七点对称：$\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$。\n- **近似形式**：离散算子 $D_h^2 u_i$ 由下式给出\n$$D_h^2 u_i = \\frac{1}{h^2}\\bigl[a_0\\,u(x_i) + a_1\\bigl(u(x_{i+1}) + u(x_{i-1})\\bigr) + a_2\\bigl(u(x_{i+2}) + u(x_{i-2})\\bigr) + a_3\\bigl(u(x_{i+3}) + u(x_{i-3})\\bigr)\\bigr]$$\n- **精度要求**：截断误差 $T = D_h^2 u_i - u''(x_i)$ 必须为 $\\mathcal{O}(h^6)$ 阶。\n- **方法**：使用泰勒级数展开的待定系数法。\n- **待求系数**：$a_0, a_1, a_2, a_3$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是数值分析中推导高阶有限差分格式的一个标准练习。待定系数法是完成此项任务的合适技术。该问题指定了一个光滑函数 ($u \\in C^8$)、一个对称模板以及一个目标精度阶数，提供了一套完整且一致的约束条件，以唯一确定四个未知系数。该问题具有科学依据，是适定、客观的，并且不包含任何模糊或矛盾之处。\n\n### 步骤 3：结论与行动\n该问题是有效的。现在开始推导求解。\n\n为了构建有限差分公式，我们使用待定系数法。这涉及到将每一项 $u(x_{i \\pm m})$ 在点 $x_i$ 周围展开为泰勒级数。令 $u_i = u(x_i)$ 且 $u_i^{(k)} = \\frac{d^k u}{dx^k}\\bigr|_{x=x_i}$。\n$u(x_{i+m}) = u(x_i + mh)$ 和 $u(x_{i-m}) = u(x_i - mh)$ 的泰勒级数展开为：\n$$u(x_{i+m}) = u_i + (mh)u_i^{(1)} + \\frac{(mh)^2}{2!}u_i^{(2)} + \\frac{(mh)^3}{3!}u_i^{(3)} + \\frac{(mh)^4}{4!}u_i^{(4)} + \\dots$$\n$$u(x_{i-m}) = u_i - (mh)u_i^{(1)} + \\frac{(mh)^2}{2!}u_i^{(2)} - \\frac{(mh)^3}{3!}u_i^{(3)} + \\frac{(mh)^4}{4!}u_i^{(4)} - \\dots$$\n\n指定的近似形式使用对称对 $u(x_{i+m}) + u(x_{i-m})$。将这两个级数相加会消去所有奇数阶导数项：\n$$u(x_{i+m}) + u(x_{i-m}) = 2u_i + \\frac{2(mh)^2}{2!}u_i^{(2)} + \\frac{2(mh)^4}{4!}u_i^{(4)} + \\frac{2(mh)^6}{6!}u_i^{(6)} + \\frac{2(mh)^8}{8!}u_i^{(8)} + \\mathcal{O}(h^{10})$$\n简化阶乘项，我们得到：\n$$u(x_{i+m}) + u(x_{i-m}) = 2u_i + (mh)^2 u_i^{(2)} + \\frac{(mh)^4}{12}u_i^{(4)} + \\frac{(mh)^6}{360}u_i^{(6)} + \\frac{(mh)^8}{20160}u_i^{(8)} + \\mathcal{O}(h^{10})$$\n由于函数 $u(x)$ 至少是 $C^8$ 的，这个展开是有效的。\n\n现在，我们将其代入给定的近似形式中，我们将其表示为 $L_h(u_i)$：\n$$L_h(u_i) = a_0 u_i + a_1\\bigl(u_{i+1} + u_{i-1}\\bigr) + a_2\\bigl(u_{i+2} + u_{i-2}\\bigr) + a_3\\bigl(u_{i+3} + u_{i-3}\\bigr)$$\n代入 $m=1, 2, 3$ 的级数：\n$$L_h(u_i) = a_0u_i + a_1\\left(2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} + \\frac{h^8}{20160}u_i^{(8)} + \\dots \\right)$$\n$$+ a_2\\left(2u_i + (2h)^2 u_i^{(2)} + \\frac{(2h)^4}{12}u_i^{(4)} + \\frac{(2h)^6}{360}u_i^{(6)} + \\frac{(2h)^8}{20160}u_i^{(8)} + \\dots \\right)$$\n$$+ a_3\\left(2u_i + (3h)^2 u_i^{(2)} + \\frac{(3h)^4}{12}u_i^{(4)} + \\frac{(3h)^6}{360}u_i^{(6)} + \\frac{(3h)^8}{20160}u_i^{(8)} + \\dots \\right)$$\n\n我们按 $u_i$ 的导数对各项进行分组：\n$$L_h(u_i) = u_i \\left( a_0 + 2a_1 + 2a_2 + 2a_3 \\right)$$\n$$+ u_i^{(2)} h^2 \\left( a_1 \\cdot 1^2 + a_2 \\cdot 2^2 + a_3 \\cdot 3^2 \\right)$$\n$$+ u_i^{(4)} \\frac{h^4}{12} \\left( a_1 \\cdot 1^4 + a_2 \\cdot 2^4 + a_3 \\cdot 3^4 \\right)$$\n$$+ u_i^{(6)} \\frac{h^6}{360} \\left( a_1 \\cdot 1^6 + a_2 \\cdot 2^6 + a_3 \\cdot 3^6 \\right)$$\n$$+ u_i^{(8)} \\frac{h^8}{20160} \\left( a_1 \\cdot 1^8 + a_2 \\cdot 2^8 + a_3 \\cdot 3^8 \\right) + \\mathcal{O}(h^{10})$$\n\n总的近似是 $D_h^2 u_i = \\frac{1}{h^2} L_h(u_i)$。我们要求它等于 $u_i^{(2)}$，且截断误差为 $\\mathcal{O}(h^6)$。这意味着：\n$$\\frac{1}{h^2}L_h(u_i) = u_i^{(2)} + \\mathcal{O}(h^6)$$\n或\n$$L_h(u_i) = h^2 u_i^{(2)} + \\mathcal{O}(h^8)$$\n\n通过比较 $L_h(u_i)$ 展开式中各导数的系数与目标 $h^2 u_i^{(2)}$，我们得到了一个关于系数 $a_0, a_1, a_2, a_3$ 的线性方程组：\n1. $u_i$ 的系数：$a_0 + 2a_1 + 2a_2 + 2a_3 = 0$\n2. $u_i^{(2)} h^2$ 的系数：$a_1 + 4a_2 + 9a_3 = 1$\n3. $u_i^{(4)} h^4$ 的系数：$a_1 + 16a_2 + 81a_3 = 0$\n4. $u_i^{(6)} h^6$ 的系数：$a_1 + 64a_2 + 729a_3 = 0$\n\n我们首先求解关于 $a_1, a_2, a_3$ 的 $3 \\times 3$ 系统：\n方程 (3) 减去方程 (2)：\n$$(a_1 + 16a_2 + 81a_3) - (a_1 + 4a_2 + 9a_3) = 0 - 1 \\implies 12a_2 + 72a_3 = -1 \\quad (5)$$\n方程 (4) 减去方程 (3)：\n$$(a_1 + 64a_2 + 729a_3) - (a_1 + 16a_2 + 81a_3) = 0 - 0 \\implies 48a_2 + 648a_3 = 0$$\n两边除以 $48$：\n$$a_2 + \\frac{648}{48}a_3 = 0 \\implies a_2 + \\frac{27}{2}a_3 = 0 \\implies a_2 = -\\frac{27}{2}a_3 \\quad (6)$$\n将 (6) 代入 (5)：\n$$12\\left(-\\frac{27}{2}a_3\\right) + 72a_3 = -1$$\n$$-162a_3 + 72a_3 = -1$$\n$$-90a_3 = -1 \\implies a_3 = \\frac{1}{90}$$\n现在，从 (6) 中求出 $a_2$：\n$$a_2 = -\\frac{27}{2} \\left(\\frac{1}{90}\\right) = -\\frac{27}{180} = -\\frac{3 \\cdot 9}{20 \\cdot 9} = -\\frac{3}{20}$$\n从 (2) 中求出 $a_1$：\n$$a_1 = 1 - 4a_2 - 9a_3 = 1 - 4\\left(-\\frac{3}{20}\\right) - 9\\left(\\frac{1}{90}\\right)$$\n$$a_1 = 1 + \\frac{12}{20} - \\frac{9}{90} = 1 + \\frac{3}{5} - \\frac{1}{10}$$\n$$a_1 = \\frac{10}{10} + \\frac{6}{10} - \\frac{1}{10} = \\frac{15}{10} = \\frac{3}{2}$$\n最后，从 (1) 中求出 $a_0$：\n$$a_0 = -2(a_1 + a_2 + a_3) = -2\\left(\\frac{3}{2} - \\frac{3}{20} + \\frac{1}{90}\\right)$$\n和的公分母是 $180$：\n$$a_0 = -2\\left(\\frac{3 \\cdot 90}{180} - \\frac{3 \\cdot 9}{180} + \\frac{1 \\cdot 2}{180}\\right) = -2\\left(\\frac{270 - 27 + 2}{180}\\right)$$\n$$a_0 = -2\\left(\\frac{245}{180}\\right) = -2\\left(\\frac{49 \\cdot 5}{36 \\cdot 5}\\right) = -2\\left(\\frac{49}{36}\\right) = -\\frac{49}{18}$$\n\n系数为：\n$$a_0 = -\\frac{49}{18}, \\quad a_1 = \\frac{3}{2}, \\quad a_2 = -\\frac{3}{20}, \\quad a_3 = \\frac{1}{90}$$\n主截断误差项是我们没有消去的第一个非零项，它对应于 $u_i^{(8)}$ 的系数。\n$$T = \\frac{1}{h^2} \\left( \\frac{h^8}{20160} \\left( a_1 \\cdot 1^8 + a_2 \\cdot 2^8 + a_3 \\cdot 3^8 \\right) u_i^{(8)} + \\dots \\right)$$\n$$T = \\frac{h^6}{20160} \\left( a_1 + 256a_2 + 6561a_3 \\right) u_i^{(8)} + \\mathcal{O}(h^8)$$\n系数是：\n$$\\frac{3}{2} + 256\\left(-\\frac{3}{20}\\right) + 6561\\left(\\frac{1}{90}\\right) = \\frac{3}{2} - \\frac{192}{5} + \\frac{729}{10} = \\frac{15 - 384 + 729}{10} = \\frac{360}{10} = 36$$\n因此，截断误差为 $T = \\frac{36}{20160}h^6 u_i^{(8)} + \\mathcal{O}(h^8) = \\frac{1}{560}h^6 u_i^{(8)} + \\mathcal{O}(h^8)$。这证实了精度阶数为 $\\mathcal{O}(h^6)$。\n\n最终的系数集 $(a_0, a_1, a_2, a_3)$ 为 $(-\\frac{49}{18}, \\frac{3}{2}, -\\frac{3}{20}, \\frac{1}{90})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{49}{18} & \\frac{3}{2} & -\\frac{3}{20} & \\frac{1}{90}\n\\end{pmatrix}\n}\n$$", "id": "3311335"}, {"introduction": "仅仅推导出差分格式是不够的，我们还必须分析其性能。傅里叶分析（或称谱分析）是评估离散算子如何处理不同尺度（波数）波动的强大工具。这项练习通过“修正波数”的概念，让你深入比较两种广泛使用的四阶精度格式——一种是显式格式，另一种是紧致格式——在谱分辨率上的差异，从而揭示紧致格式在模拟湍流和波传播等精细结构时为何更具优势。[@problem_id:3311379]", "problem": "一个长度为 $L$ 的一维周期性域被一个均匀网格离散化，其网格间距为 $h$，节点为 $x_j = j h$，其中 $j$ 是整数，且对于某个整数 $N$ 有 $N h = L$。在计算流体动力学 (CFD) 中，离散算子的频谱分辨率是通过它们对傅里叶模式的作用来评估的。考虑一个网格函数 $u_j = \\exp(i k x_j)$，其连续波数为 $k$，并定义无量纲波数 $\\theta = k h \\in [0,\\pi]$。对于这样一个傅里叶模式，任何对二阶空间导数的线性、平移不变的离散近似都会产生 $D(\\theta) u_j$ 形式的响应，其中 $D(\\theta)$ 是该算子的离散傅里叶符号。连续二阶导数产生 $-k^2 u_j$，因此可以通过 $D(\\theta) = -k_*^2$ 定义一个修正波数 $k_*$，并使用比率 $(k_* h)^2 / \\theta^2$ 作为频谱分辨率的度量。\n\n考虑以下两种二阶导数的四阶精确近似：\n\n(1) 一种显式、中心、五点模板：\n应用算子\n$$\n\\frac{-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2}}{h^2}.\n$$\n\n(2) 一种紧致、中心、三对角格式，其中离散二阶导数值 $u''_j$ 满足\n$$\n\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} \\;=\\; \\frac{c}{h^2}\\,\\big(u_{j-1} - 2 u_j + u_{j+1}\\big),\n$$\n其中选择系数 $\\alpha$ 和 $c$ 以使形式截断误差为 $\\mathcal{O}(h^4)$。\n\n使用泰勒级数相容性确定 $\\alpha$ 和 $c$，并在周期性网格上使用离散傅里叶分析推导每种格式的修正波数，然后通过在代表性波数 $\\theta = \\pi/2$ 和 $\\theta = \\pi$ 处计算比率 $(k_* h)^2 / \\theta^2$ 来比较它们的频谱分辨率。下列哪个陈述是正确的？\n\nA. 在周期性均匀网格上，$\\alpha = \\frac{1}{10}$ 和 $c = \\frac{6}{5}$ 的四阶紧致格式的傅里叶符号为 $-k_c^2$，其中\n$$\n(k_c h)^2 \\;=\\; \\frac{12}{5}\\,\\frac{1 - \\cos \\theta}{1 + \\frac{1}{5} \\cos \\theta},\n$$\n其产生的 $(k_c h)^2/\\theta^2$ 在 $\\theta \\in [0,\\pi]$ 上比显式五点模板的\n$$\n(k_e h)^2 \\;=\\; \\frac{8}{3}\\,(1 - \\cos \\theta)\\;-\\;\\frac{1}{6}\\,(1 - \\cos 2\\theta),\n$$\n更接近1（例如，在 $\\theta = \\pi/2$ 时，比率分别约为 $0.973$ 和 $0.946$，在 $\\theta = \\pi$ 时，它们分别为 $0.608$ 和 $0.540$）。\n\nB. 显式五点模板在奈奎斯特频率 $\\theta = \\pi$ 处精确再现了连续二阶导数，即 $(k_e h)^2 = \\pi^2$，而紧致格式则低估了它。\n\nC. 两种格式在 $(k_* h)^2 = \\theta^2 - C\\,\\theta^6 + \\mathcal{O}(\\theta^8)$ 中具有相同的低波数误差，其中 $C = \\frac{1}{180}$，这意味着在低波数下没有频谱分辨率优势。\n\nD. 紧致格式的分母 $1 + \\frac{1}{5} \\cos \\theta$ 在周期性网格上的某个 $\\theta \\in (0,\\pi)$ 处为零，导致椭圆性丧失和非实数的修正波数。", "solution": "用户提供了一个关于两种二阶空间导数有限差分格式的谱分析问题。我将首先验证问题陈述，然后进行完整求解，包括对每个选项的评估。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   域：一维，周期性，长度 $L$。\n*   网格：均匀，间距 $h$，节点 $x_j = j h$， $N h = L$。\n*   测试函数：网格函数 $u_j = \\exp(i k x_j)$，连续波数 $k$。\n*   无量纲波数：$\\theta = k h \\in [0,\\pi]$。\n*   离散算子响应：$D(\\theta) u_j$。\n*   修正波数 $k_*$：$D(\\theta) = -k_*^2$。\n*   频谱分辨率度量：比率 $(k_* h)^2 / \\theta^2$。\n*   格式 (1)，显式5点：$\\frac{-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2}}{h^2}$。\n*   格式 (2)，紧致三对角：$\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} \\;=\\; \\frac{c}{h^2}\\,\\big(u_{j-1} - 2 u_j + u_{j+1}\\big)$，其中选择 $\\alpha, c$ 以获得 $\\mathcal{O}(h^4)$ 的形式截断误差。\n\n任务是确定 $\\alpha$ 和 $c$，求出两种格式的修正波数，并在 $\\theta = \\pi/2$ 和 $\\theta = \\pi$ 处比较它们的频谱分辨率。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题是数值分析领域，特别是计算流体动力学 (CFD) 领域的标准练习。有限差分、泰勒级数分析、截断误差和离散傅里叶分析（或 von Neumann 分析）等概念都是基本且公认的原理。\n*   **适定性：** 问题定义清晰。它要求使用指定方法（泰勒级数相容性）确定未知系数，推导解析表达式（修正波数），并基于这些表达式进行定量比较。存在唯一解。\n*   **客观性：** 问题使用精确、客观的数学语言陈述。它没有歧义和主观论断。\n*   **完整性：** 所有必要信息都已提供，包括显式格式的模板系数和紧致格式的符号形式。确定紧致格式未知系数的标准也已明确说明。\n\n**步骤 3：结论和行动**\n\n问题陈述是有效的。它在科学上是合理的、适定的、客观的和自洽的。我现在开始求解。\n\n### 求解过程\n\n求解过程包括三个主要步骤：(1) 确定紧致格式的系数，(2) 推导每种格式的修正波数，以及 (3) 比较它们的频谱分辨率比率 $(k_*h)^2/\\theta^2$。\n\n**1. 确定紧致格式（格式 2）的系数**\n\n该格式为 $\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} = \\frac{c}{h^2}(u_{j-1} - 2u_j + u_{j+1})$。为了找到能得到四阶精度的系数 $\\alpha$ 和 $c$，我们分析截断误差。方法是将精确解 $u(x)$ 及其导数代入格式中，并将所有项在 $x_j$ 周围展开成泰勒级数。\n\n设 $T_j$ 为截断误差：\n$$ T_j = \\left( \\alpha u''(x_{j-1}) + u''(x_j) + \\alpha u''(x_{j+1}) \\right) - \\frac{c}{h^2}\\left( u(x_{j-1}) - 2u(x_j) + u(x_{j+1}) \\right) $$\n我们在 $x_j$ 周围展开各项：\n$$u(x_{j\\pm 1}) = u(x_j) \\pm h u'(x_j) + \\frac{h^2}{2}u''(x_j) \\pm \\frac{h^3}{6}u'''(x_j) + \\frac{h^4}{24}u''''(x_j) + \\frac{h^6}{720}u^{(6)}(x_j) + \\mathcal{O}(h^8)$$\n$$u''(x_{j\\pm 1}) = u''(x_j) \\pm h u'''(x_j) + \\frac{h^2}{2}u''''(x_j) \\pm \\frac{h^3}{6}u^{(5)}(x_j) + \\frac{h^4}{24}u^{(6)}(x_j) + \\mathcal{O}(h^6)$$\n\n右侧 (RHS) 项变为：\n$$ \\frac{c}{h^2} \\left( h^2 u'' + \\frac{h^4}{12}u'''' + \\frac{h^6}{360}u^{(6)} + \\mathcal{O}(h^8) \\right) = c \\left( u'' + \\frac{h^2}{12}u'''' + \\frac{h^4}{360}u^{(6)} + \\mathcal{O}(h^6) \\right) $$\n左侧 (LHS) 项变为：\n$$ \\alpha(2u'' + h^2 u'''' + \\frac{h^4}{12}u^{(6)} + \\mathcal{O}(h^6)) + u'' = (1+2\\alpha)u'' + \\alpha h^2 u'''' + \\frac{\\alpha h^4}{12}u^{(6)} + \\mathcal{O}(h^6) $$\n将展开后的 LHS 和 RHS 项代入 $T_j$ 的表达式中：\n$$ T_j = (1+2\\alpha-c)u'' + (\\alpha - \\frac{c}{12})h^2 u'''' + (\\frac{\\alpha}{12} - \\frac{c}{360})h^4 u^{(6)} + \\mathcal{O}(h^6) $$\n为了达到四阶精度 ($\\mathcal{O}(h^4)$)，$u''$ 和 $u''''$ 的系数必须为零。\n1.  $u''$ 的项：$1+2\\alpha-c=0 \\implies c = 1+2\\alpha$\n2.  $h^2 u''''$ 的项：$\\alpha - \\frac{c}{12} = 0 \\implies c = 12\\alpha$\n\n解这个方程组：$12\\alpha = 1+2\\alpha \\implies 10\\alpha = 1 \\implies \\alpha = \\frac{1}{10}$。\n则 $c = 12\\alpha = \\frac{12}{10} = \\frac{6}{5}$。\n这些值与选项 A 中提供的值相符。\n\n**2. 推导修正波数**\n\n对于网格函数 $u_j = e^{ikx_j} = e^{ikjh}$，一个近似二阶导数的离散算子给出 $L_h u_j = D(\\theta) u_j = -k_*^2 u_j$，其中 $\\theta=kh$。\n\n**格式 (1)：显式5点**\n算子为 $L_e u_j = \\frac{1}{h^2} (-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2})$。\n将其应用于 $u_j=e^{ikjh}$：\n$$ L_e u_j = \\frac{u_j}{h^2} \\left( -\\frac{1}{12}e^{-i2\\theta} + \\frac{4}{3}e^{-i\\theta} - \\frac{5}{2} + \\frac{4}{3}e^{i\\theta} - \\frac{1}{12}e^{i2\\theta} \\right) $$\n$$ -k_e^2 = \\frac{1}{h^2} \\left( \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta) - \\frac{5}{2} \\right) $$\n$$(k_e h)^2 = -\\left( \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta) - \\frac{5}{2} \\right) = \\frac{5}{2} - \\frac{8}{3}\\cos\\theta + \\frac{1}{6}\\cos(2\\theta) $$\n为了与选项 A 中的形式匹配，我们重写表达式：\n$$ (k_e h)^2 = \\left(\\frac{8}{3} - \\frac{1}{6}\\right) - \\frac{8}{3}\\cos\\theta + \\frac{1}{6}\\cos(2\\theta) = \\frac{8}{3}(1-\\cos\\theta) - \\frac{1}{6}(1-\\cos(2\\theta)) $$\n选项 A 中 $(k_e h)^2$ 的表达式是正确的。\n\n**格式 (2)：紧致三对角**\n该格式为 $\\alpha u''_{j-1} + u''_j + \\alpha u''_{j+1} = \\frac{c}{h^2}(u_{j-1} - 2u_j + u_{j+1})$。\n代入 $u_j = e^{ikjh}$ 和 $u''_j = -k_c^2 u_j$：\n$$ \\alpha(-k_c^2)e^{ik(j-1)h} + (-k_c^2)e^{ikjh} + \\alpha(-k_c^2)e^{ik(j+1)h} = \\frac{c}{h^2}(e^{ik(j-1)h} - 2e^{ikjh} + e^{ik(j+1)h}) $$\n除以 $e^{ikjh}$：\n$$ -k_c^2 (\\alpha e^{-i\\theta} + 1 + \\alpha e^{i\\theta}) = \\frac{c}{h^2}(e^{-i\\theta} - 2 + e^{i\\theta}) $$\n$$ -k_c^2 (1 + 2\\alpha\\cos\\theta) = \\frac{c}{h^2}(2\\cos\\theta - 2) = -\\frac{2c}{h^2}(1-\\cos\\theta) $$\n$$(k_c h)^2 = \\frac{2c(1-\\cos\\theta)}{1+2\\alpha\\cos\\theta} $$\n代入 $\\alpha=1/10$ 和 $c=6/5$：\n$$ (k_c h)^2 = \\frac{2(6/5)(1-\\cos\\theta)}{1+2(1/10)\\cos\\theta} = \\frac{\\frac{12}{5}(1-\\cos\\theta)}{1+\\frac{1}{5}\\cos\\theta} $$\n这个 $(k_c h)^2$ 的表达式也与选项 A 中的相符。\n\n**3. 比较频谱分辨率比率 ($R(\\theta) = (k_*h)^2/\\theta^2$)**\n\n一个理想的格式会给出 $(k_*h)^2 = \\theta^2$，因此 $R(\\theta) = 1$。\n\n**在\n$\\theta = \\pi/2$ 时：**\n*   理想值：$\\theta^2 = (\\pi/2)^2 \\approx 2.4674$。\n*   格式 (1)，显式：$(k_e h)^2 = \\frac{8}{3}(1-\\cos(\\frac{\\pi}{2})) - \\frac{1}{6}(1-\\cos(\\pi)) = \\frac{8}{3}(1) - \\frac{1}{6}(1 - (-1)) = \\frac{8}{3} - \\frac{2}{6} = \\frac{8}{3} - \\frac{1}{3} = \\frac{7}{3} \\approx 2.3333$。\n    $R_e(\\pi/2) = \\frac{7/3}{(\\pi/2)^2} = \\frac{28}{3\\pi^2} \\approx 0.9457$。\n*   格式 (2)，紧致：$(k_c h)^2 = \\frac{12/5(1-\\cos(\\frac{\\pi}{2}))}{1+1/5\\cos(\\frac{\\pi}{2})} = \\frac{12}{5(1)} = \\frac{12}{5} = 2.4$。\n    $R_c(\\pi/2) = \\frac{12/5}{(\\pi/2)^2} = \\frac{48}{5\\pi^2} \\approx 0.9727$。\n\n在 $\\theta=\\pi/2$ 时，$R_c \\approx 0.973$ 比 $R_e \\approx 0.946$ 更接近 1。\n\n**在\n$\\theta = \\pi$ 时：**\n*   理想值：$\\theta^2 = \\pi^2 \\approx 9.8696$。\n*   格式 (1)，显式：$(k_e h)^2 = \\frac{8}{3}(1-\\cos\\pi) - \\frac{1}{6}(1-\\cos(2\\pi)) = \\frac{8}{3}(2) - \\frac{1}{6}(0) = \\frac{16}{3} \\approx 5.3333$。\n    $R_e(\\pi) = \\frac{16/3}{\\pi^2} = \\frac{16}{3\\pi^2} \\approx 0.5404$。\n*   格式 (2)，紧致：$(k_c h)^2 = \\frac{12/5(1-\\cos\\pi)}{1+1/5\\cos\\pi} = \\frac{12/5(2)}{1-1/5} = \\frac{24/5}{4/5} = 6$。\n    $R_c(\\pi) = \\frac{6}{\\pi^2} \\approx 0.6079$。\n\n在 $\\theta=\\pi$ 时，$R_c \\approx 0.608$ 比 $R_e \\approx 0.540$ 更接近 1。\n\n**选项分析**\n\n*   **A. 在周期性均匀网格上，$\\alpha = \\frac{1}{10}$ 和 $c = \\frac{6}{5}$ 的四阶紧致格式的傅里叶符号为 $-k_c^2$，其中 $(k_c h)^2 = \\frac{12}{5}\\,\\frac{1 - \\cos \\theta}{1 + \\frac{1}{5} \\cos \\theta}$，其产生的 $(k_c h)^2/\\theta^2$ 在 $\\theta \\in [0,\\pi]$ 上比显式五点模板的 $(k_e h)^2 = \\frac{8}{3}\\,(1 - \\cos \\theta)\\;-\\;\\frac{1}{6}\\,(1 - \\cos 2\\theta)$ 更接近1（例如，在 $\\theta = \\pi/2$ 时，比率分别约为 $0.973$ 和 $0.946$，在 $\\theta = \\pi$ 时，它们分别为 $0.608$ 和 $0.540$）。**\n    我们的推导证实了系数 $\\alpha$ 和 $c$ 对于四阶格式是正确的。$(k_e h)^2$ 和 $(k_c h)^2$ 的公式是正确的。在 $\\theta=\\pi/2$ 和 $\\theta=\\pi$ 处的数值例子是正确的，它们支持了紧致格式具有更好频谱分辨率（比率更接近1）的论点。该陈述与我们的详细分析完全一致。\n    **结论：正确。**\n\n*   **B. 显式五点模板在奈奎斯特频率 $\\theta = \\pi$ 处精确再现了连续二阶导数，即 $(k_e h)^2 = \\pi^2$，而紧致格式则低估了它。**\n    在 $\\theta=\\pi$ 时，精确算子给出 $-k^2 = -(\\pi/h)^2$，所以理想的修正波数平方是 $(kh)^2=\\pi^2$。我们计算出对于显式格式，$(k_e h)^2 = 16/3 \\approx 5.33$，这不等于 $\\pi^2 \\approx 9.87$。该陈述是错误的。\n    **结论：不正确。**\n\n*   **C. 两种格式在 $(k_* h)^2 = \\theta^2 - C\\,\\theta^6 + \\mathcal{O}(\\theta^8)$ 中具有相同的低波数误差，其中 $C = \\frac{1}{180}$，这意味着在低波数下没有频谱分辨率优势。**\n    我们可以通过对小 $\\theta$ 的 $(k_* h)^2$ 表达式进行泰勒展开来找到主导误差项。对于显式格式：$(k_e h)^2 = \\theta^2 - \\frac{1}{90}\\theta^6 + \\mathcal{O}(\\theta^8)$。所以 $C_e = 1/90$。对于紧致格式：$(k_c h)^2 = \\theta^2 - \\frac{1}{240}\\theta^6 + \\mathcal{O}(\\theta^8)$。所以 $C_c = 1/240$。误差系数不相同，且两者都不等于 $1/180$。紧致格式具有更小的主导误差系数，使其在低波数下具有频谱分辨率优势。\n    **结论：不正确。**\n\n*   **D. 紧致格式的分母 $1 + \\frac{1}{5} \\cos \\theta$ 在周期性网格上的某个 $\\theta \\in (0,\\pi)$ 处为零，导致椭圆性丧失和非实数的修正波数。**\n    分母是 $1 + \\frac{1}{5}\\cos\\theta$。要使其为零，需要 $\\cos\\theta = -5$。由于余弦函数的值域是 $[-1, 1]$，不存在满足此条件的实数 $\\theta$。分母始终严格为正，其范围从 $\\theta=0$ 时的 $1+1/5=6/5$ 到 $\\theta=\\pi$ 时的 $1-1/5=4/5$。因此，它永远不会为零。\n    **结论：不正确。**\n\n基于详细分析，只有选项 A 是正确的。", "answer": "$$\\boxed{A}$$", "id": "3311379"}, {"introduction": "当我们将离散化从一维推广到多维时，会遇到新的挑战，其中之一便是各向异性误差，即数值误差会因波传播方向相对于网格轴线的角度而变化。这项练习将指导你分析二维拉普拉斯算子的傅里叶符号，以量化标准5点格式和经过改进的9点格式的各向异性。理解并控制这种方向性偏差对于在复杂几何中获得可靠且无网格依赖性的解至关重要。[@problem_id:3311368]", "problem": "在二维空间中，拉普拉斯算子 $\\nabla^2$ 出现在计算流体动力学（CFD）的许多控制方程中，例如不可压缩流动的压力泊松方程和粘性扩散项。考虑一个在 $x$ 和 $y$ 方向上间距均为 $h$ 的均匀笛卡尔网格，以及在该网格上对拉普拉斯算子的两种经典有限差分近似：一种是仅使用轴向相邻点的5点格式，另一种是也使用对角线相邻点的9点格式。为便于比较，将5点离散拉普拉斯算子 $\\mathcal{L}_5$ 定义为使用轴向相邻点的标准二阶格式，并将9点离散拉普拉斯算子 $\\mathcal{L}_9$ 定义为一种二阶各向同性改进格式，其轴向相邻点的权重为 $a = 4/6$，对角线相邻点的权重为 $b = 1/6$，且满足通常的相容性约束。假设各向同性改进的选择为 $a = 4/6$ 和 $b = 1/6$，且中心点系数的选择使得离散算子作用于常数场时其系数和为零。\n\n表征离散微分算子的方向性（各向异性）误差的一种标准方法是通过其傅里叶符号。对于作用在网格函数 $u_{i,j}$ 上的离散算子 $\\mathcal{L}$，考虑平面波（傅里叶）模态 $u_{i,j} = \\exp\\!\\big(\\mathrm{i}(i \\,\\xi_x + j \\,\\xi_y)\\big)$，其中无量纲波数分量为 $\\xi_x = k_x h$ 和 $\\xi_y = k_y h$。此模态的连续拉普拉斯算子符号为 $\\sigma_c(\\boldsymbol{\\xi}) = -|\\boldsymbol{k}|^2 = -(\\xi_x^2 + \\xi_y^2)/h^2$。离散符号 $\\sigma_d(\\boldsymbol{\\xi})$ 由 $\\mathcal{L} u_{i,j} = \\sigma_d(\\boldsymbol{\\xi}) \\, u_{i,j}$ 定义。在固定的模 $|\\boldsymbol{\\xi}|$ 下，各向同性误差可以通过归一化比率 $r(\\boldsymbol{\\xi}) = \\sigma_d(\\boldsymbol{\\xi})/\\sigma_c(\\boldsymbol{\\xi})$ 来量化，其随 $\\boldsymbol{\\xi}$ 方向的角度变化表示方向偏差。为分离纯粹的方向效应，通过将 $\\boldsymbol{\\xi}(\\phi) = (\\cos\\phi,\\sin\\phi)$（$\\phi \\in [0,2\\pi)$）参数化，在无量纲波数空间的单位圆 $|\\boldsymbol{\\xi}| = 1$ 上评估 $r(\\phi)$，并比较5点和9点格式的角度变化范围。\n\n下列哪个陈述正确地比较了在单位圆 $|\\boldsymbol{\\xi}| = 1$ 上评估的5点和9点拉普拉斯算子的各向同性误差？\n\nA. 对于5点格式，在 $|\\boldsymbol{\\xi}|=1$ 上的归一化比率 $r(\\phi)$ 在大约 $0.9194$ 到 $0.9590$ 之间变化，而对于9点格式，仅在大约 $0.9194$ 到 $0.9211$ 之间变化；最小值出现在轴向方向 $\\phi \\approx 0$ 或 $\\phi \\approx \\pi/2$ 附近，并且9点格式的角度变化大约比5点格式的小一个数量级。\n\nB. 两种格式在单位圆上都是完全各向同性的：对于所有 $\\phi$，$r(\\phi) \\equiv 1$。\n\nC. 在单位圆上，5点格式比9点格式表现出更小的角度变化，$r_5(\\phi)$ 的范围仅在 $[0.919,\\,0.921]$ 内，而 $r_9(\\phi)$ 的范围在 $[0.919,\\,0.959]$ 内。\n\nD. 9点格式的角度变化大于5点格式，其 $r_9(\\phi)$ 沿轴向最大，沿对角线最小。", "solution": "用户希望我扮演一位严谨的STEM教授，解决一个关于拉普拉斯算子有限差分近似的各向同性误差的问题。\n\n### 步骤 1：验证问题陈述\n\n我将首先根据指定程序验证问题陈述。\n\n#### 已知条件提取\n- **算子**：二维空间中的拉普拉斯算子 $\\nabla^2$。\n- **网格**：在 $x$ 和 $y$ 方向上间距均为 $h$ 的均匀笛卡尔网格。\n- **5点离散拉普拉斯算子（$\\mathcal{L}_5$）**：仅使用轴向相邻点的标准二阶格式。\n- **9点离散拉普拉斯算子（$\\mathcal{L}_9$）**：一种二阶各向同性改进格式，轴向相邻点权重 $a = 4/6$，对角线相邻点权重 $b = 1/6$，中心点系数的选择使得离散算子作用于常数场时系数和为零。\n- **分析方法**：使用平面波模态 $u_{i,j} = \\exp\\!\\big(\\mathrm{i}(i \\,\\xi_x + j \\,\\xi_y)\\big)$ 进行傅里叶分析。\n- **无量纲波数**：$\\xi_x = k_x h$ 和 $\\xi_y = k_y h$，构成向量 $\\boldsymbol{\\xi} = (\\xi_x, \\xi_y)$。\n- **连续符号**：$\\sigma_c(\\boldsymbol{\\xi}) = -|\\boldsymbol{k}|^2 = -(\\xi_x^2 + \\xi_y^2)/h^2$。\n- **离散符号**：由关系式 $\\mathcal{L} u_{i,j} = \\sigma_d(\\boldsymbol{\\xi}) \\, u_{i,j}$ 定义的 $\\sigma_d(\\boldsymbol{\\xi})$。\n- **各向同性误差度量**：归一化比率 $r(\\boldsymbol{\\xi}) = \\sigma_d(\\boldsymbol{\\xi})/\\sigma_c(\\boldsymbol{\\xi})$。\n- **评估轨迹**：无量纲波数空间中的单位圆 $|\\boldsymbol{\\xi}| = 1$，由 $\\boldsymbol{\\xi}(\\phi) = (\\cos\\phi,\\sin\\phi)$（$\\phi \\in [0, 2\\pi)$）参数化。\n- **问题**：比较5点和9点格式在此圆上 $r(\\phi)$ 的角度变化范围。\n\n#### 验证结论\n- **科学依据**：该问题是偏微分方程数值分析中的一个标准练习，是计算科学与工程（包括CFD）的核心课题。有限差分格式、傅里叶符号和各向异性误差等概念是成熟且基础的。为9点格式选择的权重是“各向同性改进”格式的一个已知例子。该问题在科学上是合理的。\n- **适定性**：该问题提供了所有必要的定义、常数和约束，以唯一确定离散算子及其傅里叶符号。问题要求进行一个具体的、可计算的比较。存在唯一且有意义的解。\n- **客观性**：该问题以精确的技术语言陈述，没有任何主观性或歧义。\n\n问题陈述是**有效的**，因为它科学合理、适定、客观且完整。我将继续进行推导。\n\n### 步骤 2：求解推导\n\n问题的核心是推导并比较两种离散拉普拉斯算子的傅里叶符号。\n\n#### 离散算子定义\n拉普拉斯算子的标准5点格式由下式给出：\n$$ \\mathcal{L}_5 u_{i,j} = \\frac{u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4u_{i,j}}{h^2} $$\n对于9点格式，轴向和对角线相邻点的权重分别为 $a=4/6$ 和 $b=1/6$。系数之和必须为零，所以中心点权重 $c_0$ 是 $c_0 = -4(a+b) = -4(4/6 + 1/6) = -4(5/6) = -20/6$。该算子是：\n$$ \\mathcal{L}_9 u_{i,j} = \\frac{1}{h^2} \\left[ \\frac{4}{6}(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}) + \\frac{1}{6}(u_{i+1,j+1} + u_{i-1,j+1} + u_{i+1,j-1} + u_{i-1,j-1}) - \\frac{20}{6} u_{i,j} \\right] $$\n$$ \\mathcal{L}_9 u_{i,j} = \\frac{1}{6h^2} \\left[ 4(u_{i+1,j} + \\dots) + 1(u_{i+1,j+1} + \\dots) - 20 u_{i,j} \\right] $$\n\n#### 傅里叶符号的推导\n我们将每个算子应用于傅里叶模态 $u_{i,j} = \\exp\\!\\big(\\mathrm{i}(i \\,\\xi_x + j \\,\\xi_y)\\big)$。利用平移性质 $u_{i+p,j+q} = u_{i,j} \\exp(\\mathrm{i}(p\\xi_x+q\\xi_y))$，我们求出离散符号 $\\sigma_d(\\boldsymbol{\\xi})$。\n\n对于**5点格式（$\\mathcal{L}_5$）**：\n$$ \\sigma_{d,5}(\\boldsymbol{\\xi}) = \\frac{1}{h^2} \\left( e^{\\mathrm{i}\\xi_x} + e^{-\\mathrm{i}\\xi_x} + e^{\\mathrm{i}\\xi_y} + e^{-\\mathrm{i}\\xi_y} - 4 \\right) = \\frac{2}{h^2} \\left( \\cos\\xi_x + \\cos\\xi_y - 2 \\right) $$\n\n对于**9点格式（$\\mathcal{L}_9$）**：\n$$ \\sigma_{d,9}(\\boldsymbol{\\xi}) = \\frac{1}{6h^2} \\left[ 4(e^{\\mathrm{i}\\xi_x} + e^{-\\mathrm{i}\\xi_x} + e^{\\mathrm{i}\\xi_y} + e^{-\\mathrm{i}\\xi_y}) + (e^{\\mathrm{i}(\\xi_x+\\xi_y)} + e^{\\mathrm{i}(-\\xi_x+\\xi_y)} + e^{\\mathrm{i}(\\xi_x-\\xi_y)} + e^{\\mathrm{i}(-\\xi_x-\\xi_y)}) - 20 \\right] $$\n对角项的和为 $e^{\\mathrm{i}\\xi_y}(e^{\\mathrm{i}\\xi_x}+e^{-\\mathrm{i}\\xi_x}) + e^{-\\mathrm{i}\\xi_y}(e^{\\mathrm{i}\\xi_x}+e^{-\\mathrm{i}\\xi_x}) = (2\\cos\\xi_y)(2\\cos\\xi_x) = 4\\cos\\xi_x\\cos\\xi_y$。\n$$ \\sigma_{d,9}(\\boldsymbol{\\xi}) = \\frac{1}{6h^2} \\left[ 4(2\\cos\\xi_x + 2\\cos\\xi_y) + 4\\cos\\xi_x\\cos\\xi_y - 20 \\right] = \\frac{2}{3h^2} \\left( 2\\cos\\xi_x + 2\\cos\\xi_y + \\cos\\xi_x\\cos\\xi_y - 5 \\right) $$\n\n#### 归一化比率 $r(\\phi)$ 的评估\n归一化比率是 $r(\\boldsymbol{\\xi}) = \\sigma_d(\\boldsymbol{\\xi}) / \\sigma_c(\\boldsymbol{\\xi})$。连续符号是 $\\sigma_c(\\boldsymbol{\\xi}) = -(\\xi_x^2 + \\xi_y^2)/h^2$。在单位圆 $|\\boldsymbol{\\xi}|=1$ 上，我们有 $\\xi_x^2 + \\xi_y^2 = 1$，因此 $\\sigma_c = -1/h^2$。比率变为 $r(\\boldsymbol{\\xi}) = -h^2\\sigma_d(\\boldsymbol{\\xi})$。\n我们用 $\\xi_x = \\cos\\phi$ 和 $\\xi_y = \\sin\\phi$ 进行参数化。\n\n对于**5点格式**，比率 $r_5(\\phi)$ 是：\n$$ r_5(\\phi) = -h^2 \\left( \\frac{2}{h^2} (\\cos(\\cos\\phi) + \\cos(\\sin\\phi) - 2) \\right) = 2(2 - \\cos(\\cos\\phi) - \\cos(\\sin\\phi)) $$\n\n对于**9点格式**，比率 $r_9(\\phi)$ 是：\n$$ r_9(\\phi) = -h^2 \\left( \\frac{2}{3h^2} (2\\cos(\\cos\\phi) + 2\\cos(\\sin\\phi) + \\cos(\\cos\\phi)\\cos(\\sin\\phi) - 5) \\right) $$\n$$ r_9(\\phi) = -\\frac{2}{3} (2\\cos(\\cos\\phi) + 2\\cos(\\sin\\phi) + \\cos(\\cos\\phi)\\cos(\\sin\\phi) - 5) $$\n\n#### 角度变化分析\n我们在各向异性的极值点评估这些函数，对于笛卡尔网格，这些极值点出现在轴线（$\\phi=0, \\pi/2, \\dots$）和对角线（$\\phi=\\pi/4, 3\\pi/4, \\dots$）上。\n\n- **轴向方向（$\\phi=0$）**：$\\xi_x=1, \\xi_y=0$。\n  $r_5(0) = 2(2 - \\cos(1) - \\cos(0)) = 2(1 - \\cos(1))$。使用 $\\cos(1) \\approx 0.540302$，我们得到 $r_5(0) \\approx 2(1 - 0.540302) = 0.919395$。\n  $r_9(0) = -\\frac{2}{3}(2\\cos(1) + 2\\cos(0) + \\cos(1)\\cos(0) - 5) = -\\frac{2}{3}(3\\cos(1) - 3) = 2(1 - \\cos(1)) \\approx 0.919395$。\n  正如预期的那样，两种格式沿网格轴线给出相同的结果。这将是两种比率的最小值。\n\n- **对角线方向（$\\phi=\\pi/4$）**：$\\xi_x = \\xi_y = 1/\\sqrt{2}$。\n  $r_5(\\pi/4) = 2(2 - \\cos(1/\\sqrt{2}) - \\cos(1/\\sqrt{2})) = 4(1 - \\cos(1/\\sqrt{2}))$。使用 $\\cos(1/\\sqrt{2}) \\approx 0.760245$，我们得到 $r_5(\\pi/4) \\approx 4(1 - 0.760245) = 0.95902$。\n  $r_9(\\pi/4) = -\\frac{2}{3}(2\\cos(1/\\sqrt{2}) + 2\\cos(1/\\sqrt{2}) + \\cos^2(1/\\sqrt{2}) - 5) = -\\frac{2}{3}(4\\cos(1/\\sqrt{2}) + \\cos^2(1/\\sqrt{2}) - 5)$。使用 $\\cos(1/\\sqrt{2})$ 的值，我们得到 $r_9(\\pi/4) \\approx -\\frac{2}{3}(4(0.760245) + (0.760245)^2 - 5) \\approx -\\frac{2}{3}(3.04098 + 0.57797 - 5) \\approx -\\frac{2}{3}(-1.38105) \\approx 0.92070$。\n\n#### 结果总结\n- **5点格式**：比率 $r_5(\\phi)$ 从最小值约 $0.9194$（在轴线上）变化到最大值约 $0.9590$（在对角线上）。变化范围是 $0.9590 - 0.9194 = 0.0396$。\n- **9点格式**：比率 $r_9(\\phi)$ 从最小值约 $0.9194$（在轴线上）变化到最大值约 $0.9207$（在对角线上）。变化范围是 $0.9207 - 0.9194 = 0.0013$。\n\n各向同性改进的9点格式的角度变化为 $0.0013$，这明显小于5点格式的变化 $0.0396$。变化范围的比率为 $0.0396 / 0.0013 \\approx 30.5$，证实了9点格式的误差变化要小一个数量级以上。\n\n### 步骤 3：逐项分析选项\n\n**A. 对于5点格式，在 $|\\boldsymbol{\\xi}|=1$ 上的归一化比率 $r(\\phi)$ 在大约 $0.9194$ 到 $0.9590$ 之间变化，而对于9点格式，仅在大约 $0.9194$ 到 $0.9211$ 之间变化；最小值出现在轴向方向 $\\phi \\approx 0$ 或 $\\phi \\approx \\pi/2$ 附近，并且9点格式的角度变化大约比5点格式的小一个数量级。**\n\n- 计算出的5点格式范围 $[0.9194, 0.9590]$ 与选项中的值完全匹配。\n- 计算出的9点格式范围是 $[0.9194, 0.9207]$。选项陈述为 $[0.9194, 0.9211]$。这是一个非常小的差异（$0.0004$），可能是由于四舍五入或未指定的略有不同（但实际上等效）的定义所致。一致性非常好。\n- 关于最小值出现在轴向方向的陈述是正确的。我们的分析表明它们精确地在轴线上。\n- 关于9点格式的角度变化大约小一个数量级的陈述是正确的。我们的计算给出的比率约为 $30.5$。使用选项中的数字，比率为 $(0.9590 - 0.9194) / (0.9211 - 0.9194) = 0.0396 / 0.0017 \\approx 23.3$，这也是一个数量级。\n此选项与我们的推导一致。\n**结论：正确。**\n\n**B. 两种格式在单位圆上都是完全各向同性的：对于所有 $\\phi$，$r(\\phi) \\equiv 1$。**\n\n这是不正确的。完全各向同性意味着 $r(\\phi)$ 是一个常数。我们的计算表明 $r_5(\\phi)$ 和 $r_9(\\phi)$ 随 $\\phi$ 变化。此外，这些值并不恒等于 $1$，表明即使对于符号的各向同性部分也存在截断误差。\n**结论：不正确。**\n\n**C. 在单位圆上，5点格式比9点格式表现出更小的角度变化，$r_5(\\phi)$ 的范围仅在 $[0.919,\\,0.921]$ 内，而 $r_9(\\phi)$ 的范围在 $[0.919,\\,0.959]$ 内。**\n\n这个陈述在两方面与我们的发现相矛盾。首先，5点格式的角度变化*更大*，而不是更小。其次，它交换了两种格式计算出的范围。\n**结论：不正确。**\n\n**D. 9点格式的角度变化大于5点格式，其 $r_9(\\phi)$ 沿轴向最大，沿对角线最小。**\n\n这个陈述在两点上也是不正确的。9点格式的角度变化要小得多。此外，对于这两种格式，比率沿轴向最小，沿对角线最大。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3311368"}]}