{"hands_on_practices": [{"introduction": "对一个数值格式的属性进行分析是理解其行为的基础，而傅里叶分析是完成此任务的强大工具。这项练习将指导你使用傅里叶分析来确定混合导数标准中心差分格式的精度和方向依赖性（各向异性）。这是评估和比较数值方法的一项核心技能，可以让你深入了解离散算子在不同波长和方向上的表现。 [@problem_id:3310598]", "problem": "考虑一个均匀笛卡尔网格，其在 $x$ 和 $y$ 方向上的网格间距分别为 $h_x$ 和 $h_y$，以及一个足够光滑的标量场 $u(x,y)$。在计算流体力学中，混合正应力和旋转扩散通量经常引入混合二阶导数算子 $\\frac{\\partial^2 u}{\\partial x \\partial y}$。在网格上，使用一个9点中心差分模板在内部节点 $(i,j)$ 处近似该算子，该模板的非零系数仅位于四个对角相邻点上：\n$$\n\\left(D_{xy}^{h} u\\right)_{i,j} \\;=\\; \\frac{1}{4 h_x h_y} \\left( u_{i+1,j+1} \\;-\\; u_{i+1,j-1} \\;-\\; u_{i-1,j+1} \\;+\\; u_{i-1,j-1} \\right).\n$$\n您的任务是：\n- 使用作用于离散傅里叶模态 $u_{i,j} = \\exp\\!\\big(i(k_x\\, i\\, h_x + k_y\\, j\\, h_y)\\big)$ 的线性、位移不变算子的离散傅里叶符号定义，推导 $D_{xy}^{h}$ 的精确离散傅里叶符号 $\\sigma_h(k_x,k_y)$。\n- 从作用于 $u(x,y) = \\exp\\!\\big(i(k_x x + k_y y)\\big)$ 的连续算子 $\\frac{\\partial^2}{\\partial x \\partial y}$ 所对应的连续符号 $\\sigma_c(k_x,k_y)$ 出发，通过小波数展开来比较 $\\sigma_h(k_x,k_y)$ 和 $\\sigma_c(k_x,k_y)$，并确定主阶截断误差以及关于 $h_x$ 和 $h_y$ 的相应形式精度阶。\n- 为了评估方向各向异性，将问题特殊化到各向同性网格，其中 $h_x = h_y = h$，并引入极坐标波数 $k_x = k \\cos\\theta$ 和 $k_y = k \\sin\\theta$，其中 $k \\ge 0$ 且 $\\theta \\in [0,2\\pi)$。定义精确相对符号 \n$$\nR(kh,\\theta) \\;=\\; \\frac{\\sigma_h(k\\cos\\theta,\\,k\\sin\\theta)}{\\sigma_c(k\\cos\\theta,\\,k\\sin\\theta)}.\n$$\n通过解释 $R(kh,\\theta)$ 在 $kh$ 较小时的角度依赖性来量化各向异性。\n\n答案格式要求：作为您的最终答案，请提供 $R(kh,\\theta)$ 关于 $k$、$h$ 和 $\\theta$ 的单一闭式解析表达式。不包含任何单位。无需进行数值四舍五入。", "solution": "所给问题要求对混合偏导数 $\\frac{\\partial^2 u}{\\partial x \\partial y}$ 的一个有限差分模板进行多部分分析。该分析涉及傅里叶分析，以确定该格式的离散符号、精度阶和方向各向异性。该问题是适定的且在科学上是合理的，因此我们可以开始求解。\n\n### 第1部分：离散傅里叶符号的推导\n\n问题给出了作用于网格函数 $u_{i,j}$ 的离散算子 $(D_{xy}^{h})$：\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{1}{4 h_x h_y} ( u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1} ) $$\n离散傅里叶符号 $\\sigma_h(k_x,k_y)$ 是通过算子作用于单个傅里叶模态 $u_{i,j} = \\exp(i(k_x i h_x + k_y j h_y))$ 来定义的，使得 $(D_{xy}^{h} u)_{i,j} = \\sigma_h(k_x, k_y) u_{i,j}$。\n\n为了求得 $\\sigma_h$，我们首先计算给定傅里叶模态下模板中的各项。任何位移项 $u_{i+m, j+n}$ 都可以写成：\n$$ u_{i+m,j+n} = \\exp(i(k_x(i+m)h_x + k_y(j+n)h_y)) = \\exp(i(k_x i h_x + k_y j h_y)) \\exp(i(m k_x h_x + n k_y h_y)) = u_{i,j} \\exp(i(m k_x h_x + n k_y h_y)) $$\n将此应用于模板中的四个点，得到：\n$u_{i+1,j+1} = u_{i,j} \\exp(i(k_x h_x + k_y h_y))$\n$u_{i+1,j-1} = u_{i,j} \\exp(i(k_x h_x - k_y h_y))$\n$u_{i-1,j+1} = u_{i,j} \\exp(i(-k_x h_x + k_y h_y))$\n$u_{i-1,j-1} = u_{i,j} \\exp(i(-k_x h_x - k_y h_y))$\n\n将这些代入算子定义中：\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{u_{i,j}}{4 h_x h_y} \\left[ \\exp(i(k_x h_x + k_y h_y)) - \\exp(i(k_x h_x - k_y h_y)) - \\exp(i(-k_x h_x + k_y h_y)) + \\exp(i(-k_x h_x - k_y h_y)) \\right] $$\n让我们通过因式分解来简化方括号中的表达式：\n$$ \\exp(ik_xh_x)(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) - \\exp(-ik_xh_x)(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) $$\n$$ = (\\exp(ik_xh_x) - \\exp(-ik_xh_x))(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) $$\n使用欧拉恒等式 $\\exp(i\\phi) - \\exp(-i\\phi) = 2i\\sin(\\phi)$，该表达式变为：\n$$ (2i \\sin(k_x h_x)) (2i \\sin(k_y h_y)) = 4i^2 \\sin(k_x h_x) \\sin(k_y h_y) = -4 \\sin(k_x h_x) \\sin(k_y h_y) $$\n将此结果代回关于 $(D_{xy}^{h} u)_{i,j}$ 的方程中：\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{u_{i,j}}{4 h_x h_y} [-4 \\sin(k_x h_x) \\sin(k_y h_y)] = \\left( -\\frac{\\sin(k_x h_x) \\sin(k_y h_y)}{h_x h_y} \\right) u_{i,j} $$\n由此，我们确定离散傅里叶符号为：\n$$ \\sigma_h(k_x, k_y) = -\\frac{\\sin(k_x h_x) \\sin(k_y h_y)}{h_x h_y} $$\n\n### 第2部分：截断误差和精度阶\n\n首先，我们确定作用于连续模态 $u(x,y) = \\exp(i(k_x x + k_y y))$ 的连续算子 $L = \\frac{\\partial^2}{\\partial x \\partial y}$ 的连续符号 $\\sigma_c(k_x, k_y)$。\n$$ \\frac{\\partial^2 u}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial u}{\\partial y} \\right) = \\frac{\\partial}{\\partial x} (ik_y u) = (ik_y)(ik_x) u = -k_x k_y u $$\n根据定义，$L u = \\sigma_c u$，所以连续符号是：\n$$ \\sigma_c(k_x, k_y) = -k_x k_y $$\n为了确定截断误差，我们对 $\\sigma_h(k_x, k_y)$ 进行关于小波数（即小的 $k_x h_x$ 和 $k_y h_y$）的泰勒级数展开。正弦函数的泰勒级数是 $\\sin(z) = z - z^3/6 + O(z^5)$。\n$$ \\sigma_h(k_x, k_y) = -\\frac{1}{h_x h_y} \\left( k_x h_x - \\frac{(k_x h_x)^3}{6} + \\dots \\right) \\left( k_y h_y - \\frac{(k_y h_y)^3}{6} + \\dots \\right) $$\n$$ \\sigma_h(k_x, k_y) = -\\left( k_x - \\frac{k_x^3 h_x^2}{6} + \\dots \\right) \\left( k_y - \\frac{k_y^3 h_y^2}{6} + \\dots \\right) $$\n$$ \\sigma_h(k_x, k_y) = -\\left( k_x k_y - \\frac{k_x k_y^3 h_y^2}{6} - \\frac{k_y k_x^3 h_x^2}{6} + \\text{高阶项} \\right) $$\n$$ \\sigma_h(k_x, k_y) = -k_x k_y + \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\text{高阶项} $$\n离散符号与连续符号之差为 $\\sigma_h - \\sigma_c$：\n$$ \\sigma_h - \\sigma_c = \\left( -k_x k_y + \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\dots \\right) - (-k_x k_y) = \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\dots $$\n主阶截断误差的符号是 $\\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2)$。由于误差与 $h_x^2$ 和 $h_y^2$ 成正比，该离散算子的形式精度阶为二阶，记为 $O(h_x^2, h_y^2)$。\n\n### 第3部分：方向各向异性\n\n现在我们专门考虑各向同性网格，其中 $h_x = h_y = h$。离散和连续符号变为：\n$$ \\sigma_h(k_x, k_y) = -\\frac{\\sin(k_x h) \\sin(k_y h)}{h^2} $$\n$$ \\sigma_c(k_x, k_y) = -k_x k_y $$\n相对符号 $R$ 定义为比值 $\\sigma_h / \\sigma_c$：\n$$ R(k_x, k_y) = \\frac{\\sigma_h(k_x, k_y)}{\\sigma_c(k_x, k_y)} = \\frac{-\\sin(k_x h) \\sin(k_y h)/h^2}{-k_x k_y} = \\frac{\\sin(k_x h) \\sin(k_y h)}{h^2 k_x k_y} = \\left(\\frac{\\sin(k_x h)}{k_x h}\\right) \\left(\\frac{\\sin(k_y h)}{k_y h}\\right) $$\n接下来，我们引入极坐标波数 $k_x = k \\cos\\theta$ 和 $k_y = k \\sin\\theta$。将它们代入 $R$ 的表达式中：\n$$ R(kh, \\theta) = \\left(\\frac{\\sin((k \\cos\\theta) h)}{(k \\cos\\theta) h}\\right) \\left(\\frac{\\sin((k \\sin\\theta) h)}{(k \\sin\\theta) h}\\right) $$\n该表达式表示离散放大因子与连续放大因子之比，是无量纲波数 $kh$ 和波传播角 $\\theta$ 的函数。这就是所要求的最终解析表达式。\n\n为了解释各向异性，我们可以对小 $kh$ 展开 $R(kh, \\theta)$。令 $\\xi = kh$。\n$$ R(\\xi, \\theta) = \\left(1 - \\frac{(\\xi \\cos\\theta)^2}{6} + \\dots\\right) \\left(1 - \\frac{(\\xi \\sin\\theta)^2}{6} + \\dots\\right) \\approx 1 - \\frac{\\xi^2}{6}(\\cos^2\\theta + \\sin^2\\theta) = 1 - \\frac{\\xi^2}{6} $$\n在主阶上，误差仅取决于波数的大小 ($k$)，而不取决于其方向 ($\\theta$)。这表明该格式在主阶误差上是各向同性的。然而，展开到下一阶则揭示了各向异性：\n$$ R(kh, \\theta) \\approx 1 - \\frac{(kh)^2}{6} + (kh)^4 \\frac{7 - \\cos(4\\theta)}{720} $$\n$O((kh)^4)$ 项通过 $\\cos(4\\theta)$ 依赖于 $\\theta$，表明该格式的精度在这个更高阶上是与方向相关的。对于与网格轴对齐的波（$\\theta = n\\pi/2$），误差最小；对于与网格对角线对齐的波（$\\theta = \\pi/4 + n\\pi/2$），误差最大。\n\n最终答案仅需要 $R(kh, \\theta)$ 的闭式表达式。\n$$ R(kh, \\theta) = \\frac{\\sin(kh \\cos\\theta)}{kh \\cos\\theta} \\frac{\\sin(kh \\sin\\theta)}{kh \\sin\\theta} $$", "answer": "$$\n\\boxed{\\frac{\\sin(kh \\cos\\theta)}{kh \\cos\\theta} \\frac{\\sin(kh \\sin\\theta)}{kh \\sin\\theta}}\n$$", "id": "3310598"}, {"introduction": "一个优秀的数值格式不仅应保证精度，还应尊重其所近似的连续算子的基本对称性。通过将一个候选算子应用于一个其连续混合导数为零的特定函数，本练习揭示了如何检验离散旋转对称性。这项实践提供了一种具体的方法来理解设计不佳的格式如何引入非物理误差，从而加深对算子设计原则的认识。 [@problem_id:3310640]", "problem": "在计算流体动力学 (CFD) 中，混合偏导数自然地出现在坐标变换方程以及具有非对角扩散张量的各向异性扩散问题中。考虑一个光滑标量场 $u(x,y)$，它可以模拟速度势或温度。回想一下，对于任何纯径向二次场 $u(r)=r^{2}=x^{2}+y^{2}$，其混合偏导数 $\\frac{\\partial^{2} u}{\\partial x \\partial y}$ 在连续统中为零。在一个网格间距为 $\\Delta x$ 和 $\\Delta y$、节点坐标为 $(x_{i},y_{j})=(x_{0}+i\\,\\Delta x,\\;y_{0}+j\\,\\Delta y)$ 的均匀笛卡尔网格上，评估以下旨在近似节点 $(i,j)$ 处混合偏导数的候选线性模板的离散旋转对称性：\n$$\n\\mathcal{L}_{xy}[u]_{i,j} \\;=\\; \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha\\big(u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}\\big) \\;+\\; \\beta\\big(u_{i+1,j}-u_{i-1,j}\\big) \\;+\\; \\gamma\\big(u_{i,j+1}-u_{i,j-1}\\big) \\Big),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是无量纲权重。当 $u(x,y)=x^{2}+y^{2}$ 时，计算 $\\mathcal{L}_{xy}[u]_{i,j}$ 的精确闭式表达式，该表达式用 $\\alpha$、$\\beta$、$\\gamma$、$\\Delta x$、$\\Delta y$、$x_{i}$ 和 $y_{j}$ 表示。您的答案必须是一个单一的解析表达式。基于您计算出的表达式，解释与零的偏差如何量化该模板对离散旋转对称性的破坏。不需要进行数值舍入，最终表达式中也不应包含任何单位。", "solution": "该问题被认为是有效的，因为它在科学上基于数值分析的原理，特别是关于偏微分方程的有限差分法研究。这是一个适定、客观的问题，并包含了计算出唯一且有意义的解所需的所有信息。该问题要求对特定函数上的一个离散算子进行求值，并在离散对称性的背景下解释结果，这是分析数值模板的标准程序。\n\n任务是为标量场 $u(x,y) = x^2+y^2$ 计算离散算子 $\\mathcal{L}_{xy}[u]_{i,j}$ 的精确闭式表达式。该算子定义如下：\n$$\n\\mathcal{L}_{xy}[u]_{i,j} \\;=\\; \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha\\big(u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}\\big) \\;+\\; \\beta\\big(u_{i+1,j}-u_{i-1,j}\\big) \\;+\\; \\gamma\\big(u_{i,j+1}-u_{i,j-1}\\big) \\Big)\n$$\n网格坐标由 $x_k = x_i + (k-i)\\Delta x$ 和 $y_l = y_j + (l-j)\\Delta y$ 给出。对于函数 $u(x,y) = x^2+y^2$，在通用网格节点 $(x_k, y_l)$ 处的值为 $u_{k,l} = x_k^2 + y_l^2$。\n\n我们通过计算算子定义内部的各项来继续。我们将分别分析和的三个分量，它们分别对应权重 $\\alpha$、$\\beta$ 和 $\\gamma$。\n\n首先，考虑乘以 $\\alpha$ 的项：\n$u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}$。\n让我们计算其构成差异项：\n$u_{i+1,j+1} - u_{i+1,j-1} = \\left((x_i+\\Delta x)^2+(y_j+\\Delta y)^2\\right) - \\left((x_i+\\Delta x)^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = (y_j^2+2y_j\\Delta y+\\Delta y^2) - (y_j^2-2y_j\\Delta y+\\Delta y^2) = 4y_j\\Delta y$。\n\n$u_{i-1,j+1} - u_{i-1,j-1} = \\left((x_i-\\Delta x)^2+(y_j+\\Delta y)^2\\right) - \\left((x_i-\\Delta x)^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = 4y_j\\Delta y$。\n\n结合这些，$\\alpha$ 的项为：\n$(u_{i+1,j+1}-u_{i+1,j-1}) - (u_{i-1,j+1}-u_{i-1,j-1}) = 4y_j\\Delta y - 4y_j\\Delta y = 0$。\n因此，无论 $\\alpha$ 的值是多少，$\\alpha$ 项对算子的贡献都为零。这是一个重要的发现，因为 $\\frac{\\partial^2 u}{\\partial x \\partial y}$ 的标准中心差分近似对应于模板中 $\\alpha=1/4$ 的这部分。\n\n接下来，考虑乘以 $\\beta$ 的项：\n$u_{i+1,j} - u_{i-1,j} = \\left((x_i+\\Delta x)^2+y_j^2\\right) - \\left((x_i-\\Delta x)^2+y_j^2\\right)$\n$= (x_i+\\Delta x)^2 - (x_i-\\Delta x)^2 = (x_i^2+2x_i\\Delta x+\\Delta x^2) - (x_i^2-2x_i\\Delta x+\\Delta x^2) = 4x_i\\Delta x$。\n\n最后，考虑乘以 $\\gamma$ 的项：\n$u_{i,j+1} - u_{i,j-1} = \\left(x_i^2+(y_j+\\Delta y)^2\\right) - \\left(x_i^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = (y_j^2+2y_j\\Delta y+\\Delta y^2) - (y_j^2-2y_j\\Delta y+\\Delta y^2) = 4y_j\\Delta y$。\n\n现在，我们将这些结果代回到 $\\mathcal{L}_{xy}[u]_{i,j}$ 的定义中：\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha(0) + \\beta(4x_i\\Delta x) + \\gamma(4y_j\\Delta y) \\Big)\n$$\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{1}{\\Delta x\\,\\Delta y}\\Big( 4\\beta x_i\\Delta x + 4\\gamma y_j\\Delta y \\Big)\n$$\n将前导因子 $\\frac{1}{\\Delta x\\Delta y}$ 分配到括号中的每一项，得到：\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i\\Delta x}{\\Delta x\\Delta y} + \\frac{4\\gamma y_j\\Delta y}{\\Delta x\\Delta y}\n$$\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}\n$$\n这就是离散算子作用于函数 $u(x,y)=x^2+y^2$ 的最终闭式表达式。\n\n问题还要求解释这个结果如何量化对离散旋转对称性的破坏。在连续统中，函数 $u(x,y)=x^2+y^2$ 是纯径向的（旋转对称），其混合偏导数恒等于零：\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial}{\\partial y}(x^2+y^2)\\right) = \\frac{\\partial}{\\partial x}(2y) = 0\n$$\n一个旨在近似 $\\frac{\\partial^2}{\\partial x \\partial y}$ 的理想离散算子应该保持这个基本性质，这意味着当它应用于旋转对称二次场的离散样本时，也应该得到零。这是对算子离散对称性质的一个检验。\n\n我们计算出的结果是 $\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$。要使该表达式对所有网格点 $(x_i, y_j)$ 都为零，其充要条件是 $x_i$ 和 $y_j$ 的系数都为零。这要求 $\\beta=0$ 和 $\\gamma=0$。\n\n任何非零的 $\\beta$ 或 $\\gamma$ 值都会导致一个非零的结果。这个非零值 $\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$ 代表了在这种特定情况下离散算子的误差。这个误差明确地破坏了旋转对称性，因为它的值分别依赖于坐标 $x_i$ 和 $y_j$，而不是径向距离 $r_i = \\sqrt{x_i^2+y_j^2}$。例如，沿着 $x$ 轴 ($y_j=0$)，误差为 $\\frac{4\\beta x_i}{\\Delta y}$，而沿着 $y$ 轴 ($x_i=0$)，误差为 $\\frac{4\\gamma y_j}{\\Delta x}$。一个旋转不变的误差应该只依赖于 $r_i$。\n\n因此，表达式 $\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$ 是对该模板未能保持其旨在近似的连续统算子所固有的旋转对称性的一个直接、定量的度量。非零 $\\beta$ 和 $\\gamma$ 的存在，用类似于一阶导数算子（$\\beta$ 项是 $\\frac{\\partial}{\\partial x}$ 的一个按比例缩放的中心差分，$\\gamma$ 项是 $\\frac{\\partial}{\\partial y}$ 的）的项“污染”了混合导数模板，而这些项本身不是旋转不变的。$\\alpha$ 项的计算结果为零，这一事实表明，用于混合导数的标准九点模板（$\\beta=\\gamma=0$）确实正确地保持了这种离散旋转对称性。", "answer": "$$\\boxed{\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}}$$", "id": "3310640"}, {"introduction": "虽然连续偏导数是可交换的，但它们的离散对应物却未必如此，尤其是在实际CFD应用中常见的非均匀网格上。这个问题提供了一个在拉伸网格上离散导数算子不可交换性的具体例子。通过计算对易子，你将直接量化一个非均匀网格特有的误差来源，并理解它与网格几何形状的联系。 [@problem_id:3310685]", "problem": "考虑一个定义在二维物理域上的光滑标量场 $u(x,y)$，并回想一下连续情况下的事实：对于足够光滑的 $u$，其混合偏导数可以交换，即 $\\frac{\\partial^{2} u}{\\partial x \\partial y} = \\frac{\\partial^{2} u}{\\partial y \\partial x}$。在计算流体力学中，偏导数在网格上通过离散算子进行近似。在非均匀网格上，这类离散算子不一定交换。\n\n设网格是具有索引 $(i,j)$ 的结构化网格，节点 $(i,j)$ 的物理位置定义为 $x_{i,j} = \\alpha_{j}\\, i\\, h$ 和 $y_{i,j} = \\beta_{i}\\, j\\, h$，其中 $(\\alpha_{j})_{j\\in\\mathbb{Z}}$ 和 $(\\beta_{i})_{i\\in\\mathbb{Z}}$ 分别是编码 $x$ 方向和 $y$ 方向网格拉伸的严格正序列，而 $h>0$ 是一个参考间距。因此，沿坐标线的局部间距为 $h^{x}_{i-1/2}(j) = x_{i,j} - x_{i-1,j} = \\alpha_{j}\\, h$ 和 $h^{y}_{j+1/2}(i) = y_{i,j+1} - y_{i,j} = \\beta_{i}\\, h$。在 $(i,j)$ 处定义离散一阶导数算子，采用 $x$ 方向的一阶后向差分和 $y$ 方向的一阶前向差分：\n$$\nD_{x} u(i,j) = \\frac{u_{i,j} - u_{i-1,j}}{h^{x}_{i-1/2}(j)} = \\frac{u_{i,j} - u_{i-1,j}}{\\alpha_{j}\\, h}, \n\\qquad\nD_{y} u(i,j) = \\frac{u_{i,j+1} - u_{i,j}}{h^{y}_{j+1/2}(i)} = \\frac{u_{i,j+1} - u_{i,j}}{\\beta_{i}\\, h}.\n$$\n这些选择代表了通量守恒离散化中常用的单边离散梯度。\n\n设测试场为双线性函数 $u(x,y) = x\\, y$，因此 $u_{i,j} = u(x_{i,j}, y_{i,j}) = x_{i,j}\\, y_{i,j}$。考虑一个内部节点 $(i,j)$，其邻居节点 $(i-1,j)$ 和 $(i,j+1)$ 可用。\n\n定义网格拉伸比\n$$\nr_{x}(j) = \\frac{\\alpha_{j+1}}{\\alpha_{j}}, \n\\qquad\nr_{y}(i) = \\frac{\\beta_{i-1}}{\\beta_{i}},\n$$\n这些比率量化了在横向方向上移动一个索引时，间距如何变化。\n\n任务：从上述定义出发，并且不使用任何预先推导的离散交换子恒等式，在一般内部节点 $(i,j)$ 处计算 $D_{x} D_{y} u(i,j)$ 和 $D_{y} D_{x} u(i,j)$，并简化它们的差值 $[D_{x}, D_{y}]\\, u(i,j) := D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j)$。将你的最终答案仅用 $i$、$j$、$r_{x}(j)$ 和 $r_{y}(i)$ 的闭式解析表达式表示。无需进行数值计算。", "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观，并包含一套完整且一致的定义。它展示了偏微分方程数值分析领域中一个标准但详细的计算。我们可以开始求解。\n\n任务是在给定的非均匀网格上，针对指定的测试场 $u(x,y) = x\\,y$，计算离散导数算子的交换子 $[D_{x}, D_{y}]\\, u(i,j) = D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j)$。\n\n首先，我们使用网格坐标的定义 $x_{i,j} = \\alpha_{j}\\,i\\,h$ 和 $y_{i,j} = \\beta_{i}\\,j\\,h$ 来表示离散场 $u_{i,j}$。\n$$\nu_{i,j} = u(x_{i,j}, y_{i,j}) = x_{i,j} y_{i,j} = (\\alpha_{j}\\,i\\,h)(\\beta_{i}\\,j\\,h) = i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2}\n$$\n我们将分别计算交换子的两项，$D_{x} D_{y} u(i,j)$ 和 $D_{y} D_{x} u(i,j)$。\n\n我们先计算 $D_{x} D_{y} u(i,j)$。首先计算内部运算 $v(i,j) = D_{y} u(i,j)$。\n算子 $D_{y}$ 定义为：\n$$\nD_{y} u(i,j) = \\frac{u_{i,j+1} - u_{i,j}}{\\beta_{i}\\,h}\n$$\n我们需要节点 $(i, j+1)$ 处的 $u$ 值：\n$$\nu_{i,j+1} = x_{i,j+1} y_{i,j+1} = (\\alpha_{j+1}\\,i\\,h)(\\beta_{i}\\,(j+1)\\,h) = i\\,(j+1)\\,\\alpha_{j+1}\\,\\beta_{i}\\,h^{2}\n$$\n将 $u_{i,j}$ 和 $u_{i,j+1}$ 代入 $D_{y} u(i,j)$ 的表达式中：\n$$\nv(i,j) = D_{y} u(i,j) = \\frac{i\\,(j+1)\\,\\alpha_{j+1}\\,\\beta_{i}\\,h^{2} - i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2}}{\\beta_{i}\\,h}\n$$\n提出公因式：\n$$\nv(i,j) = \\frac{i\\,\\beta_{i}\\,h^{2} \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\beta_{i}\\,h} = i\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)\n$$\n现在，我们将 $D_{x}$ 算子作用于 $v(i,j)$。算子 $D_{x}$ 定义为：\n$$\nD_{x} v(i,j) = \\frac{v(i,j) - v(i-1,j)}{\\alpha_{j}\\,h}\n$$\n我们需要 $v(i-1,j)$，它通过将 $v(i,j)$ 表达式中的 $i$ 替换为 $i-1$ 得到：\n$$\nv(i-1,j) = (i-1)\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)\n$$\n将 $v(i,j)$ 和 $v(i-1,j)$ 代入 $D_{x}v(i,j)$ 的表达式中：\n$$\nD_{x} D_{y} u(i,j) = \\frac{i\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right) - (i-1)\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}\\,h}\n$$\n提出分子中的公因项：\n$$\nD_{x} D_{y} u(i,j) = \\frac{(i - (i-1))\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}\\,h} = \\frac{\\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}}\n$$\n$$\nD_{x} D_{y} u(i,j) = (j+1)\\,\\frac{\\alpha_{j+1}}{\\alpha_{j}} - j\n$$\n使用给定的网格拉伸比 $r_{x}(j) = \\frac{\\alpha_{j+1}}{\\alpha_{j}}$，我们得到：\n$$\nD_{x} D_{y} u(i,j) = (j+1)\\,r_{x}(j) - j\n$$\n\n接下来，我们计算 $D_{y} D_{x} u(i,j)$。首先计算内部运算 $w(i,j) = D_{x} u(i,j)$。\n$$\nD_{x} u(i,j) = \\frac{u_{i,j} - u_{i-1,j}}{\\alpha_{j}\\,h}\n$$\n我们需要节点 $(i-1, j)$ 处的 $u$ 值：\n$$\nu_{i-1,j} = x_{i-1,j} y_{i-1,j} = (\\alpha_{j}\\,(i-1)\\,h)(\\beta_{i-1}\\,j\\,h) = j\\,(i-1)\\,\\alpha_{j}\\,\\beta_{i-1}\\,h^{2}\n$$\n将 $u_{i,j}$ 和 $u_{i-1,j}$ 代入 $D_{x} u(i,j)$ 的表达式中：\n$$\nw(i,j) = D_{x} u(i,j) = \\frac{i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2} - j\\,(i-1)\\,\\alpha_{j}\\,\\beta_{i-1}\\,h^{2}}{\\alpha_{j}\\,h}\n$$\n提出公因式：\n$$\nw(i,j) = \\frac{j\\,\\alpha_{j}\\,h^{2} \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\alpha_{j}\\,h} = j\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)\n$$\n现在，我们将 $D_{y}$ 算子作用于 $w(i,j)$：\n$$\nD_{y} w(i,j) = \\frac{w(i,j+1) - w(i,j)}{\\beta_{i}\\,h}\n$$\n我们需要 $w(i,j+1)$，它通过将 $w(i,j)$ 表达式中的 $j$ 替换为 $j+1$ 得到：\n$$\nw(i,j+1) = (j+1)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)\n$$\n将 $w(i,j)$ 和 $w(i,j+1)$ 代入 $D_{y}w(i,j)$ 的表达式中：\n$$\nD_{y} D_{x} u(i,j) = \\frac{(j+1)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right) - j\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\beta_{i}\\,h}\n$$\n提出分子中的公因项：\n$$\nD_{y} D_{x} u(i,j) = \\frac{((j+1) - j)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\beta_{i}\\,h} = \\frac{i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}}{\\beta_{i}}\n$$\n$$\nD_{y} D_{x} u(i,j) = i - (i-1)\\,\\frac{\\beta_{i-1}}{\\beta_{i}}\n$$\n使用给定的网格拉伸比 $r_{y}(i) = \\frac{\\beta_{i-1}}{\\beta_{i}}$，我们得到：\n$$\nD_{y} D_{x} u(i,j) = i - (i-1)\\,r_{y}(i)\n$$\n\n最后，我们计算差值以求得交换子：\n$$\n[D_{x}, D_{y}]\\, u(i,j) = D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j) = \\left((j+1)\\,r_{x}(j) - j\\right) - \\left(i - (i-1)\\,r_{y}(i)\\right)\n$$\n$$\n[D_{x}, D_{y}]\\, u(i,j) = (j+1)\\,r_{x}(j) - j - i + (i-1)\\,r_{y}(i)\n$$\n这个表达式可以重排为一个更有启发性的形式，通过分离出与均匀网格（其中 $r_x=1$ 且 $r_y=1$）的偏差。\n我们将第一项重写为：\n$$\n(j+1)\\,r_{x}(j) - j = (j+1)\\,r_{x}(j) - (j+1) + 1 = (j+1)(r_x(j) - 1) + 1\n$$\n我们将第二项重写为：\n$$\ni - (i-1)\\,r_{y}(i) = i - (i-1) - (i-1)(r_y(i) - 1) = 1 - (i-1)(r_y(i) - 1) = 1 + (i-1)(1 - r_y(i))\n$$\n从重写后的第一项中减去重写后的第二项：\n$$\n[D_{x}, D_{y}]\\, u(i,j) = \\left( (j+1)(r_x(j) - 1) + 1 \\right) - \\left( 1 + (i-1)(1 - r_y(i)) \\right)\n$$\n$$\n[D_{x}, D_{y}]\\, u(i,j) = (j+1)(r_x(j) - 1) - (i-1)(1 - r_y(i))\n$$\n$$\n[D_{x}, D_{y}]\\, u(i,j) = (j+1)(r_x(j) - 1) + (i-1)(r_y(i) - 1)\n$$\n这个最终形式清楚地表明，如果网格在两个方向上都是均匀的（即 $r_x(j)=1$ 且 $r_y(i)=1$），则交换子为零。", "answer": "$$\n\\boxed{(j+1)(r_x(j) - 1) + (i-1)(r_y(i) - 1)}\n$$", "id": "3310685"}]}