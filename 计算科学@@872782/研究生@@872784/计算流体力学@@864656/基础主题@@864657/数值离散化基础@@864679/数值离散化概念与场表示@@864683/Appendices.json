{"hands_on_practices": [{"introduction": "当我们将微分方程离散化时，会引入误差，这些误差可能表现为非物理效应，例如数值色散和耗散。此练习 [@problem_id:3350130] 提供了一个动手实践的机会，使用傅里叶分析来量化两种基本格式（中心差分和迎风差分）的这些效应。通过计算数值相速度和振幅衰减，您将更深入地理解格式的设计选择如何影响解的质量。", "problem": "考虑一维空间中的常系数线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a>0$，该方程定义在周期性域上。场在均匀网格 $x_{j} = j\\,\\Delta x$ 上表示，节点值为 $u_{j}(t) \\approx u(x_{j}, t)$，时间以大小为 $\\Delta t$ 的步长推进。空间导数 $u_{x}$ 通过二阶中心差分 $\\delta_{x}^{c} u_{j} = \\left(u_{j+1} - u_{j-1}\\right)/(2\\,\\Delta x)$ 或（对于 $a>0$ 的）一阶迎风差分 $\\delta_{x}^{u} u_{j} = \\left(u_{j} - u_{j-1}\\right)/\\Delta x$ 来近似。由此得到的半离散线方法系统为 $u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$（中心差分）和 $u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$（迎风差分）。考虑离散傅里叶模态 $u_{j}(t) = \\hat{u}(t)\\exp(ij\\theta)$，其中无量纲波数为 $\\theta = k\\,\\Delta x \\in [0,\\pi]$，$k$ 是连续波数。使用此表示法和离散空间算子的基本定义，推导中心和迎风半离散系统的数值色散关系 $\\omega(\\theta)$，并将其与单步放大因子 $G(\\theta) = \\exp(-i\\,\\omega(\\theta)\\,\\Delta t)$ 联系起来。由此定义数值相速度 $c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$，其中 $\\omega_{R}$ 是 $\\omega$ 的实部，以及每步振幅阻尼因子 $\\left|G(\\theta)\\right|$。对于中心格式，定义相速度误差比 $E_{c}(\\theta) = c_{\\text{num}}(\\theta)/a - 1$。对于迎风格式（$a>0$），定义每步振幅阻尼因子 $D_{u}(\\theta) = \\left|G(\\theta)\\right|$。假设库朗-弗里德里希-列维 (CFL) 数 $\\nu = a\\,\\Delta t / \\Delta x$ 已指定且等于 $\\nu = 0.3$。在 $\\theta = \\pi/3$ 处评估离散模态，并计算单个标量 $S = E_{c}(\\theta) + D_{u}(\\theta)$。将最终结果表示为无量纲数，并四舍五入到六位有效数字。", "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n-   控制方程：$u_{t} + a\\,u_{x} = 0$，平流速度 $a>0$，定义在周期性域上。\n-   网格和场表示：均匀网格 $x_{j} = j\\,\\Delta x$，节点值为 $u_{j}(t) \\approx u(x_{j}, t)$。\n-   时间步长：$\\Delta t$。\n-   $u_{x}$ 的二阶中心差分算子：$\\delta_{x}^{c} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$。\n-   $u_{x}$ 的一阶迎风差分算子（$a>0$）：$\\delta_{x}^{u} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$。\n-   半离散系统：$u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$（中心）和 $u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$（迎风）。\n-   离散傅里叶模态表示：$u_{j}(t) = \\hat{u}(t)\\exp(ij\\theta)$。\n-   无量纲波数：$\\theta = k\\,\\Delta x \\in [0, \\pi]$，其中 $k$ 是连续波数。\n-   数值色散关系：$\\omega(\\theta)$。\n-   单步放大因子：$G(\\theta) = \\exp(-i\\,\\omega(\\theta)\\,\\Delta t)$。\n-   数值相速度：$c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$，其中 $\\omega_{R}$ 是 $\\omega$ 的实部。\n-   相速度误差比（中心格式）：$E_{c}(\\theta) = c_{\\text{num}}(\\theta)/a - 1$。\n-   每步振幅阻尼因子（迎风格式）：$D_{u}(\\theta) = |G(\\theta)|$。\n-   库朗-弗里德里希-列维 (CFL) 数：$\\nu = a\\,\\Delta t / \\Delta x = 0.3$。\n-   计算点：$\\theta = \\pi/3$。\n-   目标量：在 $\\theta=\\pi/3$ 处计算的 $S = E_{c}(\\theta) + D_{u}(\\theta)$。\n-   所需输出格式：四舍五入到六位有效数字的无量纲数。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是针对线性平流方程的有限差分格式进行傅里叶分析（或冯·诺依曼分析）的一个标准基础练习。所有定义、方程和概念在偏微分方程数值分析和计算流体力学领域都是标准的。\n-   **良态的：** 该问题提供了唯一确定所需量的所有必要定义、常数和参数。求解路径清晰明确。\n-   **客观的：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n-   **完整性和一致性：** 设置是自洽且内部一致的。没有信息缺失或矛盾。\n\n**步骤3：结论与行动**\n问题有效。将提供详细解答。\n\n**量的推导**\n\n我们首先推导所需的量 $E_{c}(\\theta)$ 和 $D_{u}(\\theta)$。\n\n**1. 中心差分格式分析**\n中心格式的半离散方程为：\n$$u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$$\n我们将离散傅里叶模态 $u_{j}(t) = \\hat{u}(t)\\exp(ij\\theta)$ 代入此方程。时间导数为 $u_{j}'(t) = \\hat{u}'(t)\\exp(ij\\theta)$。空间项变为：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = a\\,\\frac{\\hat{u}(t)\\exp(i(j+1)\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta)}{2\\,\\Delta x}$$\n提出公因式：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = a\\,\\frac{\\hat{u}(t)\\exp(ij\\theta)(\\exp(i\\theta) - \\exp(-i\\theta))}{2\\,\\Delta x}$$\n使用欧拉公式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们得到：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,u_{j}(t)$$\n代回半离散方程：\n$$\\hat{u}'(t)\\exp(ij\\theta) + i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,\\hat{u}(t)\\exp(ij\\theta) = 0$$\n两边除以 $\\exp(ij\\theta)$，得到关于模态振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\\hat{u}'(t) = -i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,\\hat{u}(t)$$\n对于波状解，我们假设 $\\hat{u}(t) \\propto \\exp(-i\\omega t)$，这意味着 $\\hat{u}'(t) = -i\\omega\\,\\hat{u}(t)$。将此与上述方程比较，我们确定中心格式的数值色散关系 $\\omega_{c}(\\theta)$：\n$$\\omega_{c}(\\theta) = \\frac{a\\sin(\\theta)}{\\Delta x}$$\n这个色散关系是纯实数的，所以 $\\omega_{R}(\\theta) = \\omega_{c}(\\theta)$。数值相速度定义为 $c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$。使用关系式 $\\theta = k\\,\\Delta x$，我们有 $k = \\theta/\\Delta x$。\n$$c_{\\text{num},c}(\\theta) = \\frac{\\omega_{c}(\\theta)}{k} = \\frac{a\\sin(\\theta)/\\Delta x}{\\theta/\\Delta x} = a\\,\\frac{\\sin(\\theta)}{\\theta}$$\n那么相速度误差比 $E_{c}(\\theta)$ 是：\n$$E_{c}(\\theta) = \\frac{c_{\\text{num},c}(\\theta)}{a} - 1 = \\frac{a\\,\\sin(\\theta)/\\theta}{a} - 1 = \\frac{\\sin(\\theta)}{\\theta} - 1$$\n\n**2. 迎风差分格式分析**\n（对于 $a>0$ 的）迎风格式的半离散方程为：\n$$u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$$\n我们再次代入傅里叶模态 $u_{j}(t) = \\hat{u}(t)\\exp(ij\\theta)$。空间项是：\n$$a\\,\\delta_{x}^{u} u_{j}(t) = a\\,\\frac{u_{j}(t) - u_{j-1}(t)}{\\Delta x} = a\\,\\frac{\\hat{u}(t)\\exp(ij\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta)}{\\Delta x}$$\n提出公因式：\n$$a\\,\\delta_{x}^{u} u_{j}(t) = a\\,\\frac{\\hat{u}(t)\\exp(ij\\theta)(1 - \\exp(-i\\theta))}{\\Delta x} = \\frac{a}{\\Delta x}\\,(1 - \\exp(-i\\theta))\\,u_{j}(t)$$\n半离散方程变为：\n$$\\hat{u}'(t) = -\\frac{a}{\\Delta x}\\,(1 - \\exp(-i\\theta))\\,\\hat{u}(t)$$\n使用 $1 - \\exp(-i\\theta) = 1 - (\\cos\\theta - i\\sin\\theta) = (1 - \\cos\\theta) + i\\sin\\theta$：\n$$\\hat{u}'(t) = -\\frac{a}{\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta)\\,\\hat{u}(t)$$\n再次与 $\\hat{u}'(t) = -i\\omega_{u}(\\theta)\\,\\hat{u}(t)$ 比较，我们找到迎风格式的数值色散关系 $\\omega_{u}(\\theta)$：\n$$-i\\omega_{u}(\\theta) = -\\frac{a}{\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta)$$\n$$\\omega_{u}(\\theta) = \\frac{a}{i\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta) = \\frac{a}{\\Delta x}\\,(\\sin\\theta - i(1 - \\cos\\theta))$$\n这个关系是复数，实部为 $\\omega_{R}(\\theta) = \\frac{a\\sin\\theta}{\\Delta x}$，虚部为 $\\omega_{I}(\\theta) = -\\frac{a(1-\\cos\\theta)}{\\Delta x}$。\n\n单步放大因子是 $G(\\theta) = \\exp(-i\\,\\omega(\\theta)\\,\\Delta t)$。对于迎风格式：\n$$G_{u}(\\theta) = \\exp(-i\\,\\omega_{u}(\\theta)\\,\\Delta t) = \\exp(-i\\,\\left(\\frac{a}{\\Delta x}\\,(\\sin\\theta - i(1 - \\cos\\theta))\\right)\\Delta t)$$\n$$G_{u}(\\theta) = \\exp\\left(-\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta - \\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)$$\n每步振幅阻尼因子是放大因子的模，$D_{u}(\\theta) = |G_{u}(\\theta)|$。\n$$D_{u}(\\theta) = \\left|\\exp\\left(-\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta\\right)\\,\\exp\\left(-\\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)\\right|$$\n因为对于任何实数 $x$，都有 $|\\exp(-ix)| = 1$，所以模由指数的实部决定：\n$$D_{u}(\\theta) = \\exp\\left(-\\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)$$\n使用 CFL 数的定义 $\\nu = a\\,\\Delta t/\\Delta x$，我们得到阻尼因子的最终表达式：\n$$D_{u}(\\theta) = \\exp(-\\nu(1 - \\cos\\theta))$$\n\n**3. 数值计算**\n我们需要计算当 $\\theta = \\pi/3$ 和 $\\nu = 0.3$ 时，$S = E_{c}(\\theta) + D_{u}(\\theta)$ 的值。\n\n首先，我们计算 $E_{c}(\\pi/3)$：\n$$E_{c}(\\pi/3) = \\frac{\\sin(\\pi/3)}{\\pi/3} - 1 = \\frac{\\sqrt{3}/2}{\\pi/3} - 1 = \\frac{3\\sqrt{3}}{2\\pi} - 1$$\n接下来，我们计算 $D_{u}(\\pi/3)$：\n$$D_{u}(\\pi/3) = \\exp(-\\nu(1 - \\cos(\\pi/3))) = \\exp(-0.3(1 - 1/2)) = \\exp(-0.3 \\times 0.5) = \\exp(-0.15)$$\n量 $S$ 是这两个值的和：\n$$S = \\left(\\frac{3\\sqrt{3}}{2\\pi} - 1\\right) + \\exp(-0.15)$$\n我们现在计算数值。\n$$\\frac{3\\sqrt{3}}{2\\pi} \\approx \\frac{3 \\times 1.73205081}{2 \\times 3.14159265} \\approx \\frac{5.19615243}{6.2831853} \\approx 0.82699334$$\n所以，$E_{c}(\\pi/3) \\approx 0.82699334 - 1 = -0.17300666$。\n并且，$\\exp(-0.15) \\approx 0.86070798$。\n将这些值相加：\n$$S \\approx -0.17300666 + 0.86070798 = 0.68770132$$\n四舍五入到六位有效数字，我们得到 $0.687701$。", "answer": "$$\\boxed{0.687701}$$", "id": "3350130"}, {"introduction": "如果一个数值格式不稳定，那么即使它很精确也毫无用处，因为微小的误差会被放大并摧毁解。此练习 [@problem_id:3350077] 介绍了冯·诺依曼稳定性分析，这是一种确定显式时间推进格式稳定性约束的强大工具。通过为热方程的二阶格式推导时间步长限制，您将学到任何 CFD 实际模拟中的一项关键技能。", "problem": "考虑一个长度为 $L$ 的周期性区域上的一维热方程 $u_{t}=\\alpha\\,u_{xx}$，其中 $u(x,t)$ 是一个标量场，$\\alpha>0$ 是恒定的热扩散系数。设空间网格是均匀的，间距为 $\\Delta x$，节点为 $x_{j}=j\\,\\Delta x$，时间层为 $t^{n}=n\\,\\Delta t$。仅使用时间层 $t^{n}$ 的信息，从 $u(x_{j},t^{n+1})$ 在 $t^{n}$ 处的泰勒展开式出发，利用控制方程及其时间导数替换 $u_{t}$ 和 $u_{tt}$，并用二阶中心差分离散化空间导数，从而在节点 $x_{j}$ 处构建一个显式时间二阶有限差分更新格式。将离散二阶导数记为\n$$\n\\delta_{xx}u^{n}_{j}=\\frac{u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}}{(\\Delta x)^{2}},\n$$\n离散四阶导数记为\n$$\n\\delta_{xxxx}u^{n}_{j}=\\frac{u^{n}_{j+2}-4u^{n}_{j+1}+6u^{n}_{j}-4u^{n}_{j-1}+u^{n}_{j-2}}{(\\Delta x)^{4}}.\n$$\n通过代入单个傅里叶模态 $u^{n}_{j}=\\hat{u}^{n}\\exp(\\mathrm{i}k x_{j})$（其中 $k$ 是实数波数），对此显式二阶格式进行冯·诺依曼分析 (von Neumann analysis, VNA)，并推导出放大因子 $G(k)$，使得 $\\hat{u}^{n+1}=G(k)\\,\\hat{u}^{n}$。然后，确定时间步长 $\\Delta t$ 需满足的条件，以使 $|G(k)|\\leq 1$ 对离散网格上的所有容许波数成立。将稳定性约束表示为以 $\\alpha$ 和 $\\Delta x$ 表示的显式最大时间步长 $\\Delta t_{\\max}$。请以 $\\Delta t_{\\max}$ 的单个闭式解析表达式的形式提供您的答案。无需四舍五入，也无需单位。", "solution": "该问题要求推导一个针对一维热方程 $u_{t}=\\alpha\\,u_{xx}$ 的特定的显式时间二阶有限差分格式，并对其进行稳定性分析。\n\n首先，我们构建数值格式。出发点是 $u(x,t)$ 在节点 $x_j$ 和时间 $t^{n+1}$ 处关于时间 $t^n$ 的泰勒级数展开：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t(x_j, t^n) + \\frac{(\\Delta t)^2}{2} \\, u_{tt}(x_j, t^n) + \\mathcal{O}((\\Delta t)^3)\n$$\n其中 $u_t = \\frac{\\partial u}{\\partial t}$ 且 $u_{tt} = \\frac{\\partial^2 u}{\\partial t^2}$。\n\n控制偏微分方程 (PDE) 是 $u_t = \\alpha u_{xx}$。我们可以通过将该 PDE 对时间 $t$ 求导来找到 $u_{tt}$ 的表达式：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(u_t) = \\frac{\\partial}{\\partial t}(\\alpha u_{xx}) = \\alpha \\frac{\\partial^2}{\\partial x^2}(u_t)\n$$\n假设函数足够光滑，我们可以交换求导顺序。现在，我们将 PDE 再次代入这个 $u_{tt}$ 的表达式中：\n$$\nu_{tt} = \\alpha \\frac{\\partial^2}{\\partial x^2}(\\alpha u_{xx}) = \\alpha^2 u_{xxxx}\n$$\n其中 $u_{xxxx} = \\frac{\\partial^4 u}{\\partial x^4}$。\n\n接下来，我们将 $u_t$ 和 $u_{tt}$ 的表达式代回泰勒展开式：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t (\\alpha u_{xx})|_{x_j, t^n} + \\frac{(\\Delta t)^2}{2} (\\alpha^2 u_{xxxx})|_{x_j, t^n} + \\mathcal{O}((\\Delta t)^3)\n$$\n在此阶截断级数，并用其离散近似 $u_j^n$ 替换精确解 $u(x_j, t^n)$，我们得到半离散格式。然后，我们用所给定的二阶中心有限差分算子替换连续空间导数：\n$$\nu_{xx}|_{x_j, t^n} \\approx \\delta_{xx}u^{n}_{j}=\\frac{u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}}{(\\Delta x)^{2}}\n$$\n$$\nu_{xxxx}|_{x_j, t^n} \\approx \\delta_{xxxx}u^{n}_{j}=\\frac{u^{n}_{j+2}-4u^{n}_{j+1}+6u^{n}_{j}-4u^{n}_{j-1}+u^{n}_{j-2}}{(\\Delta x)^{4}}\n$$\n代入这些离散算子得到完全离散的显式格式：\n$$\nu_j^{n+1} = u_j^n + \\alpha \\Delta t \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right) + \\frac{\\alpha^2 (\\Delta t)^2}{2} \\left( \\frac{u_{j+2}^n - 4u_{j+1}^n + 6u_j^n - 4u_{j-1}^n + u_{j-2}^n}{(\\Delta x)^4} \\right)\n$$\n这就是所求的显式时间二阶有限差分格式。\n\n现在，我们进行冯·诺依曼稳定性分析。我们将单个傅里叶模态 $u_j^n = \\hat{u}^n \\exp(\\mathrm{i}k x_j)$ 代入格式中，其中 $x_j = j \\Delta x$。目标是找到放大因子 $G(k)$，使得 $\\hat{u}^{n+1} = G(k)\\hat{u}^n$。\n模板中的项可以写为：\n$$\nu_{j+m}^n = \\hat{u}^n \\exp(\\mathrm{i}k(j+m)\\Delta x) = \\hat{u}^n \\exp(\\mathrm{i}kj\\Delta x) \\exp(\\mathrm{i}m\\theta) = u_j^n \\exp(\\mathrm{i}m\\theta)\n$$\n其中 $\\theta = k \\Delta x$ 是无量纲波数。\n将傅里叶模态代入格式中，并除以 $u_j^n = \\hat{u}^n \\exp(\\mathrm{i}kj\\Delta x)$，得到放大因子 $G(k) = \\hat{u}^{n+1}/\\hat{u}^n$：\n$$\nG(k) = 1 + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta)) + \\frac{\\alpha^2 (\\Delta t)^2}{2(\\Delta x)^4} (\\exp(\\mathrm{i}2\\theta) - 4\\exp(\\mathrm{i}\\theta) + 6 - 4\\exp(-\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}2\\theta))\n$$\n使用欧拉恒等式 $\\cos(\\phi) = \\frac{\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi)}{2}$，我们化简括号中的项。\n第一个括号是：$\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta) = 2\\cos(\\theta) - 2 = -2(1-\\cos(\\theta)) = -4\\sin^2(\\theta/2)$。\n第二个括号是第一个括号的平方：$(\\exp(\\mathrm{i}\\theta) - 2 + \\exp(-\\mathrm{i}\\theta))^2 = (2\\cos(\\theta)-2)^2$。\n因此，令 $\\sigma = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 为扩散数。放大因子变为：\n$$\nG(k) = 1 + \\sigma (2\\cos(\\theta) - 2) + \\frac{\\sigma^2}{2} (2\\cos(\\theta) - 2)^2\n$$\n代入 $2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$：\n$$\nG(k) = 1 + \\sigma(-4\\sin^2(\\theta/2)) + \\frac{\\sigma^2}{2}(-4\\sin^2(\\theta/2))^2 = 1 - 4\\sigma\\sin^2(\\theta/2) + 8\\sigma^2\\sin^4(\\theta/2)\n$$\n为了保证稳定性，我们需要对所有容许的波数 $k$ 都有 $|G(k)| \\le 1$。对于离散网格，无量纲波数 $\\theta=k\\Delta x$ 的范围是 $[-\\pi, \\pi]$。令 $S = \\sin^2(\\theta/2)$。当 $\\theta$ 从 $-\\pi$ 变化到 $\\pi$ 时，$\\theta/2$ 从 $-\\pi/2$ 变化到 $\\pi/2$，而 $S$ 在区间 $[0, 1]$ 上变化。\n因此我们必须确保对于所有 $S \\in [0, 1]$，都有 $|g(S)| \\le 1$，其中 $g(S)$ 是多项式：\n$$\ng(S) = 1 - 4\\sigma S + 8\\sigma^2 S^2\n$$\n条件 $|g(S)| \\le 1$ 等价于两个不等式：$-1 \\le g(S)$ 和 $g(S) \\le 1$。\n\n1.  上界：$g(S) \\le 1$\n    $$\n    1 - 4\\sigma S + 8\\sigma^2 S^2 \\le 1 \\implies 8\\sigma^2 S^2 - 4\\sigma S \\le 0 \\implies 4\\sigma S (2\\sigma S - 1) \\le 0\n    $$\n    由于 $\\sigma > 0$ 且 $S \\ge 0$，项 $4\\sigma S$ 是非负的。该不等式成立当且仅当 $2\\sigma S - 1 \\le 0$，即 $S \\le \\frac{1}{2\\sigma}$。为了使这对所有 $S \\in [0, 1]$ 成立，它必须对最大值 $S=1$ 成立。\n    $$\n    1 \\le \\frac{1}{2\\sigma} \\implies 2\\sigma \\le 1 \\implies \\sigma \\le \\frac{1}{2}\n    $$\n\n2.  下界：$g(S) \\ge -1$\n    $$\n    1 - 4\\sigma S + 8\\sigma^2 S^2 \\ge -1 \\implies 8\\sigma^2 S^2 - 4\\sigma S + 2 \\ge 0 \\implies 4\\sigma^2 S^2 - 2\\sigma S + 1 \\ge 0\n    $$\n    这是一个关于 $S$ 的二次式，表示一个开口向上的抛物线。它在区间 $[0, 1]$ 上的最小值必须是非负的。抛物线 $aS^2+bS+c$ 的顶点位于 $S_v = -b/(2a)$。这里 $a=4\\sigma^2$ 且 $b = -2\\sigma$，所以 $S_v = -(-2\\sigma)/(2 \\cdot 4\\sigma^2) = \\frac{1}{4\\sigma}$。\n    如果顶点在 $[0, 1]$ 内（即 $\\sigma \\ge 1/4$），则最小值在 $S_v$ 处取得：\n    $4\\sigma^2(\\frac{1}{4\\sigma})^2 - 2\\sigma(\\frac{1}{4\\sigma}) + 1 = 4\\sigma^2(\\frac{1}{16\\sigma^2}) - \\frac{1}{2} + 1 = \\frac{1}{4} - \\frac{1}{2} + 1 = \\frac{3}{4} \\ge 0$。\n    如果顶点在 $[0, 1]$ 外（即 $\\sigma  1/4$，因为我们知道 $\\sigma0$），则在 $[0, 1]$ 上的最小值在端点处取得。由于当 $S  S_v$ 时抛物线是递减的，所以最小值在 $S=1$ 处。其值为 $4\\sigma^2 - 2\\sigma + 1$。这个关于 $\\sigma$ 的二次式的判别式是 $(-2)^2 - 4(4)(1) = -12  0$，这意味着该二次式恒为正。\n    因此，对于所有 $\\sigma  0$，下界条件 $g(S) \\ge -1$ 都满足。\n\n综合上界和下界的结果，稳定性的唯一条件是 $\\sigma \\le 1/2$。\n最后，我们将这个约束用 $\\Delta t$ 来表示。\n$$\n\\sigma = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n解出 $\\Delta t$ 得到：\n$$\n\\Delta t \\le \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n因此，最大允许时间步长 $\\Delta t_{\\max}$ 是这个不等式的上限。\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$", "answer": "$$\n\\boxed{\\frac{(\\Delta x)^{2}}{2\\alpha}}\n$$", "id": "3350077"}, {"introduction": "我们如何确信我们的 CFD 代码正在产生正确的结果？网格收敛性研究是验证的基本程序。在此练习 [@problem_id:3350102] 中，您将扮演一位研究人员，分析模拟数据以确认代码的性能，使用一系列加密网格上的解来计算观测到的精度阶并外插一个更精确的收敛值估计。这种做法对于建立任何数值模拟的可信度至关重要。", "problem": "一位研究人员正在验证用于计算中等雷诺数 (Re) 下二维圆柱体无量纲阻力系数的稳态不可压缩纳维-斯托克斯方程的有限体积法（FVM）解的网格加密过程。网格被均匀加密，使得特征单元尺寸满足 $h_2 = h_1 / r$ 和 $h_3 = h_2 / r$，其中加密比 $r  1$ 为常数。在三套网格上计算出的阻力系数分别为 $Q_1$、$Q_2$ 和 $Q_3$，且 $Q_1  Q_2  Q_3$，证实了单调收敛。假设数值解处于渐近收敛范围内，且离散误差满足主阶模型 $Q(h) = Q_{\\infty} + C h^{p}$，其中 $Q_{\\infty}$ 是网格收敛值，$C$ 是一个常数，$p$ 是观测到的精度阶。\n\n给定加密比 $r = 2$以及数值解 $Q_1 = 1.24520$、$Q_2 = 1.23528$ 和 $Q_3 = 1.23403$，使用与上述模型和单调收敛相一致的三套网格方法，确定观测到的精度阶 $p$ 和网格收敛外推值 $Q_{\\text{ext}}$。\n\n报告 $p$ 值，保留四位有效数字；报告 $Q_{\\text{ext}}$ 值，保留六位有效数字。阻力系数是无量纲的；将最终的 $Q_{\\text{ext}}$ 表示为无单位的纯数。最终答案仅提供两个数字。", "solution": "用户提供了一个来自计算流体动力学领域的关于网格收敛性分析的问题。该问题要求根据在三套系统加密的网格上进行的一组模拟，确定一个计算量的观测精度阶和网格收敛外推值。\n\n首先，对问题陈述进行验证。\n\n**步骤1：提取给定条件**\n- 离散误差模型：$Q(h) = Q_{\\infty} + C h^{p}$，其中 $Q(h)$ 是在特征单元尺寸为 $h$ 的网格上计算出的量，$Q_{\\infty}$ 是当 $h \\to 0$ 时离散方程的精确解，$C$ 是一个常数，$p$ 是精度阶。\n- 网格加密序列：三套网格，其特征单元尺寸分别为 $h_1$、$h_2$ 和 $h_3$。\n- 加密关系：$h_2 = h_1 / r$ 和 $h_3 = h_2 / r = h_1 / r^2$。\n- 加密比：$r = 2$。\n- 计算解：在网格1上为 $Q_1 = 1.24520$，在网格2上为 $Q_2 = 1.23528$，在网格3上为 $Q_3 = 1.23403$。\n- 收敛行为：单调收敛，且 $Q_1  Q_2  Q_3$。\n- 目标：确定观测到的精度阶 $p$ 和外推值 $Q_{\\text{ext}}$，后者是 $Q_{\\infty}$ 的一个估计值。\n- 报告精度：$p$ 保留四位有效数字，$Q_{\\text{ext}}$ 保留六位有效数字。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据：** 该问题使用了计算科学中的标准验证方法，特别是用于网格加密研究的理查森外推法。误差模型是在渐近收敛范围内进行此分析的一个基本假设。上下文（圆柱体上的阻力）是一个典型问题。该问题在科学上是合理的。\n- **适定性：** 该问题提供了三个数据点（$Q_1, Q_2, Q_3$）和加密比 $r$，这使得可以确定两个主要未知数 $p$ 和 $Q_{\\infty}$。该系统是完全确定的，并存在唯一解。\n- **客观性：** 该问题使用精确的数值数据和形式化的数学模型进行陈述，没有任何主观或模糊的语言。\n\n**步骤3：结论与行动**\n该问题是有效的。将推导解答。\n\n**求解过程**\n分析始于对三套网格中每一套网格的假设误差模型：\n$Q_1 = Q(h_1) = Q_{\\infty} + C h_1^{p}$\n$Q_2 = Q(h_2) = Q_{\\infty} + C h_2^{p} = Q_{\\infty} + C (h_1/r)^{p} = Q_{\\infty} + C \\frac{h_1^{p}}{r^p}$\n$Q_3 = Q(h_3) = Q_{\\infty} + C h_3^{p} = Q_{\\infty} + C (h_2/r)^{p} = Q_{\\infty} + C \\frac{h_1^{p}}{r^{2p}}$\n\n为了确定观测到的精度阶 $p$，我们首先计算连续解之间的差值。\n粗网格和中等网格上的解之差为：\n$$ Q_1 - Q_2 = (Q_{\\infty} + C h_1^{p}) - \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^p}\\right) = C h_1^{p} \\left(1 - \\frac{1}{r^p}\\right) $$\n中等网格和细网格上的解之差为：\n$$ Q_2 - Q_3 = \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^p}\\right) - \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^{2p}}\\right) = C \\frac{h_1^{p}}{r^p} \\left(1 - \\frac{1}{r^p}\\right) $$\n接下来，我们计算这两个差值的比率。这个代数操作消去了未知项 $C$ 和 $h_1$：\n$$ \\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{C h_1^{p} \\left(1 - \\frac{1}{r^p}\\right)}{C \\frac{h_1^{p}}{r^p} \\left(1 - \\frac{1}{r^p}\\right)} = r^p $$\n现在我们可以通过对两边取自然对数来解出 $p$：\n$$ \\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) = \\ln(r^p) = p \\ln(r) $$\n$$ p = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)} $$\n代入给定的数值：\n$r = 2$\n$Q_1 = 1.24520$\n$Q_2 = 1.23528$\n$Q_3 = 1.23403$\n\n差值为：\n$Q_1 - Q_2 = 1.24520 - 1.23528 = 0.00992$\n$Q_2 - Q_3 = 1.23528 - 1.23403 = 0.00125$\n\n现在，我们计算 $p$：\n$$ p = \\frac{\\ln\\left(\\frac{0.00992}{0.00125}\\right)}{\\ln(2)} = \\frac{\\ln(7.936)}{\\ln(2)} \\approx \\frac{2.071353}{0.693147} \\approx 2.988353 $$\n按要求，四舍五入到四位有效数字，得到 $p = 2.988$。\n\n接下来，我们使用理查森外推法确定外推值 $Q_{\\text{ext}} = Q_{\\infty}$。标准做法是使用两套最细的网格（$h_2$ 和 $h_3$）进行外推，因为它们代表了最精确的解，并且最有可能处于渐近收敛范围内。外推公式由 $Q_2$ 和 $Q_3$ 的方程导出：\n$Q_2 = Q_{\\infty} + C h_2^p$\n$Q_3 = Q_{\\infty} + C h_3^p = Q_{\\infty} + C (h_2/r)^p$\n\n从第一个方程可知，中等网格上的误差为 $E_2 = Q_2 - Q_{\\infty} = C h_2^p$。\n细网格上的误差为 $E_3 = Q_3 - Q_{\\infty} = C h_3^p$。\n误差之比为 $\\frac{E_2}{E_3} = \\frac{C h_2^p}{C h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$。\n所以，$Q_2 - Q_{\\infty} = r^p (Q_3 - Q_{\\infty})$。\n重新整理以求解 $Q_{\\infty}$：\n$Q_2 - Q_{\\infty} = r^p Q_3 - r^p Q_{\\infty}$\n$Q_{\\infty} (r^p - 1) = r^p Q_3 - Q_2$\n$$ Q_{\\infty} = \\frac{r^p Q_3 - Q_2}{r^p - 1} $$\n这可以被重写为更常用且数值上更稳定的形式：\n$$ Q_{\\text{ext}} = Q_{\\infty} = Q_3 + \\frac{Q_3 - Q_2}{r^p - 1} $$\n我们可以直接从之前的计算中代入 $r^p$ 的值，其中 $r^p = \\frac{Q_1 - Q_2}{Q_2 - Q_3} = 7.936$。\n使用给定的 $Q_2$ 和 $Q_3$ 的值：\n$Q_3 - Q_2 = 1.23403 - 1.23528 = -0.00125$\n$$ Q_{\\text{ext}} = 1.23403 + \\frac{-0.00125}{7.936 - 1} = 1.23403 - \\frac{0.00125}{6.936} $$\n$$ Q_{\\text{ext}} \\approx 1.23403 - 0.000180219146... = 1.2338497808... $$\n按要求，四舍五入到六位有效数字，得到 $Q_{\\text{ext}} = 1.23385$。\n\n观测到的精度阶为 $p \\approx 2.988$，网格收敛外推值为 $Q_{\\text{ext}} \\approx 1.23385$。", "answer": "$$ \\boxed{\\begin{pmatrix} 2.988  1.23385 \\end{pmatrix}} $$", "id": "3350102"}]}