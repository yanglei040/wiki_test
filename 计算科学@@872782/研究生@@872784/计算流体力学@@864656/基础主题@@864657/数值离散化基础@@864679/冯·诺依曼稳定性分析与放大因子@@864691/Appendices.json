{"hands_on_practices": [{"introduction": "本练习是冯·诺依曼稳定性分析的一个经典应用，旨在为二维抛物型偏微分方程建立稳定性约束。通过分析使用前向欧拉法和标准五点拉普拉斯算子离散的二维热传导方程 [@problem_id:3388993]，您将推导出保证数值解不会发散的时间步长上限。这个实践不仅巩固了您对稳定性理论的理解，还展示了如何将一维分析推广到多维问题中，这是计算流体力学中一项至关重要的基本技能。", "problem": "考虑二维扩散方程，这是计算流体力学 (CFD) 中的一个典型模型，其扩散系数可能为各向异性的常数，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\alpha_{x}\\,\\frac{\\partial^{2}u}{\\partial x^{2}} \\;+\\; \\alpha_{y}\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\n$$\n其中 $u(x,y,t)$ 是一个标量场，且 $\\alpha_{x} \\gt 0$, $\\alpha_{y} \\gt 0$。在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格上对空间进行离散，并用整数 $j,k$ 对网格进行索引，使得 $x_{j} = j\\,\\Delta x$, $y_{k} = k\\,\\Delta y$。使用时间步长为 $\\Delta t$ 的前向欧拉法进行时间推进，并用标准的五点模板来近似拉普拉斯算子。这得到了完全离散的显式格式\n$$\nU^{n+1}_{j,k} \\;=\\; U^{n}_{j,k} \\;+\\; \\Delta t \\left[ \\alpha_{x}\\,\\frac{U^{n}_{j+1,k} - 2\\,U^{n}_{j,k} + U^{n}_{j-1,k}}{(\\Delta x)^{2}} \\;+\\; \\alpha_{y}\\,\\frac{U^{n}_{j,k+1} - 2\\,U^{n}_{j,k} + U^{n}_{j,k-1}}{(\\Delta y)^{2}} \\right],\n$$\n对于整数 $j,k$，其中 $U^{n}_{j,k}$ 是在时间层 $t^{n} = n\\,\\Delta t$ 上对 $u(x_{j},y_{k},t^{n})$ 的近似。假设边界条件是周期性的，以便应用离散傅里叶分析。\n\n进行 von Neumann 稳定性分析：代入单模离散傅里叶拟设 $U^{n}_{j,k} = \\hat{U}^{n} \\exp\\!\\big( \\mathrm{i}(j\\,\\theta_{x} + k\\,\\theta_{y}) \\big)$，其中 $(\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi] \\times [-\\pi,\\pi]$，以推导该格式一个时间步的放大因子 $G(\\theta_{x},\\theta_{y})$。然后，使用应用于此扩散算子的前向欧拉法的绝对稳定性条件，推导出保证对所有 $(\\theta_{x},\\theta_{y})$ 都有 $|G(\\theta_{x},\\theta_{y})| \\leq 1$ 的时间步长 $\\Delta t$ 的精确上界。\n\n将你的最终答案表示为关于最大稳定时间步长 $\\Delta t_{\\max}$ 的单个闭式解析表达式，该表达式应以 $\\alpha_{x}$、$\\alpha_{y}$、$\\Delta x$ 和 $\\Delta y$ 表示。无需四舍五入，最终表达式中也不要包含任何物理单位。", "solution": "用户要求我对二维各向异性扩散方程进行 von Neumann 稳定性分析，该方程采用时间上前向欧拉格式和空间上标准五点模板进行离散。\n\n### 步骤 1：提取已知条件\n-   **控制偏微分方程 (PDE)**：\n    $$\n    \\frac{\\partial u}{\\partial t} \\;=\\; \\alpha_{x}\\,\\frac{\\partial^{2}u}{\\partial x^{2}} \\;+\\; \\alpha_{y}\\,\\frac{\\partial^{2}u}{\\partial y^{2}}\n    $$\n-   **物理常数**：$\\alpha_{x} > 0$ 和 $\\alpha_{y} > 0$ 是恒定扩散系数。\n-   **网格离散化**：均匀笛卡尔网格，间距为 $\\Delta x$ 和 $\\Delta y$。网格点由 $(j,k)$ 索引，其中 $x_{j} = j\\,\\Delta x$ 且 $y_{k} = k\\,\\Delta y$。时间离散为 $t^n = n\\,\\Delta t$。\n-   **有限差分格式**：\n    $$\n    U^{n+1}_{j,k} \\;=\\; U^{n}_{j,k} \\;+\\; \\Delta t \\left[ \\alpha_{x}\\,\\frac{U^{n}_{j+1,k} - 2\\,U^{n}_{j,k} + U^{n}_{j-1,k}}{(\\Delta x)^{2}} \\;+\\; \\alpha_{y}\\,\\frac{U^{n}_{j,k+1} - 2\\,U^{n}_{j,k} + U^{n}_{j,k-1}}{(\\Delta y)^{2}} \\right]\n    $$\n-   **边界条件**：周期性，允许进行傅里叶分析。\n-   **分析工具**：Von Neumann 稳定性分析。\n-   **傅里叶拟设**：\n    $$\n    U^{n}_{j,k} = \\hat{U}^{n} \\exp\\!\\big( \\mathrm{i}(j\\,\\theta_{x} + k\\,\\theta_{y}) \\big)\n    $$\n    相位角 $(\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi] \\times [-\\pi,\\pi]$。\n-   **目标**：推导放大因子 $G(\\theta_{x},\\theta_{y})$，并用它来找到确保稳定性（即 $|G(\\theta_{x},\\theta_{y})| \\leq 1$）的时间步长的精确上界 $\\Delta t_{\\max}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n所给问题是偏微分方程数值分析领域中的一个标准典型练习，特别是在计算流体力学的背景下。\n-   **科学依据**：该问题基于成熟的扩散方程和标准的数值离散格式（FTCS：时间前向，空间中心）。Von Neumann 稳定性分析法是分析有限差分格式稳定性的基本工具。该问题没有任何科学不准确之处或伪科学内容。\n-   **适定性**：问题陈述清晰，提供了所有必要组成部分——偏微分方程、离散格式、分析方法和明确的目标。它自成体系，其结构可以导出一个唯一的解析解。\n-   **目标**：问题使用精确的数学语言陈述，没有任何主观性或模糊性。\n\n该问题不违反任何无效性标准。它不是不完整的、矛盾的、不切实际的、不适定的、琐碎的或不可验证的。这是应用数学中一个形式化的、可解决的任务。\n\n### 步骤 3：结论与行动\n问题有效。可以开始求解过程。\n\n### 求解推导\n目标是确定给定数值格式对时间步长 $\\Delta t$ 的稳定性约束。我们采用 von Neumann 稳定性分析。该方法的核心是研究单个傅里叶模式的振幅如何在一个时间步内演变。\n\n首先，我们将傅里叶拟设 $U^{n}_{j,k} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))$ 代入有限差分方程。在时间层 $n$ 的模式振幅是 $\\hat{U}^n$，在时间层 $n+1$ 的模式振幅是 $\\hat{U}^{n+1}$。放大因子定义为 $G(\\theta_x, \\theta_y) = \\frac{\\hat{U}^{n+1}}{\\hat{U}^n}$。\n\n对于格式的左侧，我们有：\n$$\nU^{n+1}_{j,k} = \\hat{U}^{n+1} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) = G \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))\n$$\n对于右侧的各项，我们注意到以下代换：\n$$\nU^{n}_{j,k} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))\n$$\n$$\nU^{n}_{j \\pm 1, k} = \\hat{U}^{n} \\exp(\\mathrm{i}((j \\pm 1)\\theta_x + k\\theta_y)) = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\exp(\\pm \\mathrm{i}\\theta_x)\n$$\n$$\nU^{n}_{j, k \\pm 1} = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + (k \\pm 1)\\theta_y)) = \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\exp(\\pm \\mathrm{i}\\theta_y)\n$$\n将这些表达式代入数值格式：\n\\begin{align*}\nG \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) =  \\; \\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y)) \\\\\n + \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} \\left[ \\hat{U}^{n} e^{\\mathrm{i}(j\\theta_x+k\\theta_y)}(e^{\\mathrm{i}\\theta_x} - 2 + e^{-\\mathrm{i}\\theta_x}) \\right] \\\\\n + \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} \\left[ \\hat{U}^{n} e^{\\mathrm{i}(j\\theta_x+k\\theta_y)}(e^{\\mathrm{i}\\theta_y} - 2 + e^{-\\mathrm{i}\\theta_y}) \\right]\n\\end{align*}\n我们可以除以公共的非零因子 $\\hat{U}^{n} \\exp(\\mathrm{i}(j\\theta_x + k\\theta_y))$ 来分离出放大因子 $G$：\n$$\nG(\\theta_x, \\theta_y) = 1 + \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} (e^{\\mathrm{i}\\theta_x} - 2 + e^{-\\mathrm{i}\\theta_x}) + \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} (e^{\\mathrm{i}\\theta_y} - 2 + e^{-\\mathrm{i}\\theta_y})\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}\\phi} + e^{-\\mathrm{i}\\phi} = 2\\cos(\\phi)$，括号中的项简化为：\n$$\ne^{\\mathrm{i}\\phi} - 2 + e^{-\\mathrm{i}\\phi} = 2\\cos(\\phi) - 2 = -2(1 - \\cos(\\phi))\n$$\n将此应用于我们关于 $G$ 的表达式：\n$$\nG(\\theta_x, \\theta_y) = 1 - 2 \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} (1 - \\cos(\\theta_x)) - 2 \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} (1 - \\cos(\\theta_y))\n$$\n为了进一步简化，我们使用三角半角恒等式 $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$：\n$$\nG(\\theta_x, \\theta_y) = 1 - 4 \\frac{\\alpha_x \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) - 4 \\frac{\\alpha_y \\Delta t}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\n这就是该格式的放大因子。注意 $G$ 是一个实值函数，因为所有参数 $\\alpha_x, \\alpha_y, \\Delta t, \\Delta x, \\Delta y$ 都是实数，且 $\\sin^2(\\cdot)$ 是实数。\n\n为了数值稳定性，对于任何可能的模式，放大因子的模都不能超过 1，否则误差将呈指数级增长。这个条件是 $|G(\\theta_x, \\theta_y)| \\leq 1$。由于 $G$ 是实数，这等价于两个不等式：\n$$\n-1 \\leq G(\\theta_x, \\theta_y) \\leq 1\n$$\n我们来考察右侧不等式 $G \\leq 1$：\n$$\n1 - 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\leq 1\n$$\n$$\n- 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\leq 0\n$$\n因为 $\\Delta t > 0$、$\\alpha_x > 0$、$\\alpha_y > 0$ 且 $\\sin^2(\\cdot) \\geq 0$，所以方括号中的项总是非负的。因此，左侧总是非正的，条件 $G \\leq 1$ 总是满足的。\n\n现在我们考察左侧不等式 $G \\geq -1$，它提供了实际的稳定性约束：\n$$\n1 - 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right] \\geq -1\n$$\n重新整理各项以求解 $\\Delta t$：\n$$\n2 \\geq 4 \\Delta t \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]\n$$\n$$\n\\Delta t \\leq \\frac{2}{4 \\left[ \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right]}\n$$\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\frac{\\alpha_y}{(\\Delta y)^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)}\n$$\n这个不等式必须对所有可能的波数都成立，即对所有 $(\\theta_x, \\theta_y) \\in [-\\pi, \\pi] \\times [-\\pi, \\pi]$ 都成立。为了找到对 $\\Delta t$ 最严格的单一上界，我们必须找到右侧表达式的最小值。当分母最大化时，该最小值出现。\n\n当项 $\\sin^2(\\theta_x/2)$ 和 $\\sin^2(\\theta_y/2)$ 达到其最大值时，分母被最大化。$\\theta_x/2$ 和 $\\theta_y/2$ 的范围都是 $[-\\pi/2, \\pi/2]$。在此区间内，$\\sin^2(\\cdot)$ 的最大值是 $1$，这发生在端点 $\\pm \\pi/2$ 处（对应于 $\\theta_x = \\pm \\pi$ 和 $\\theta_y = \\pm \\pi$）。这些值对应于可以在网格上表示的最高频率模式（“锯齿”波）。\n\n将 $\\sin^2(\\theta_x/2)=1$ 和 $\\sin^2(\\theta_y/2)=1$ 代入不等式，得到对 $\\Delta t$ 最严格的条件：\n$$\n\\Delta t \\leq \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} (1) + \\frac{\\alpha_y}{(\\Delta y)^2} (1) \\right)}\n$$\n时间步长的精确上界 $\\Delta t_{\\max}$ 是使上式成为等式的值：\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\left( \\frac{\\alpha_x}{(\\Delta x)^2} + \\frac{\\alpha_y}{(\\Delta y)^2} \\right)}\n$$\n这就是应用于二维各向异性扩散方程的 FTCS 格式的稳定性极限。", "answer": "$$\n\\boxed{\\frac{1}{2 \\left(\\frac{\\alpha_{x}}{(\\Delta x)^{2}} + \\frac{\\alpha_{y}}{(\\Delta y)^{2}}\\right)}}\n$$", "id": "3388993"}, {"introduction": "对于模拟波动现象的对流方程，仅仅保证稳定性是不够的，准确地模拟波的传播速度同样至关重要。本练习 [@problem_id:3388991] 深入探讨了蛙跳格式（一种无耗散的中心差分格式）的色散特性。您将通过推导其离散色散关系，计算出数值群速度，并量化其与真实物理波速的误差，从而深刻理解数值色散是如何影响波包在离散网格上传播的。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数。该方程在均匀网格 $x_{j} = j\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$ 上进行离散化。蛙跳平流格式通过以下方式更新 $u_{j}^{n}$：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数 $C$ 定义为 $C = a\\,\\Delta t/\\Delta x$。通过考虑傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$（其中网格波数 $\\theta \\in \\mathbb{R}$ 以弧度表示）进行 von Neumann 稳定性和色散分析。令放大因子表示为 $\\lambda = \\exp\\!\\left(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t\\right)$ 的形式，这定义了离散时间频率 $\\omega(\\theta)$，单位为弧度/单位时间。推导该格式所蕴含的离散色散关系 $\\omega(\\theta)$，然后求出群速度 $v_{g}(\\theta) = \\dfrac{d\\omega}{dk}$，其中 $k = \\theta/\\Delta x$ 是物理波数。最后，将 $v_{g}(\\theta)$ 与精确平流速度 $a$ 进行比较，并提供一个关于群速度误差\n$$\n\\Delta v_{g}(\\theta) = v_{g}(\\theta) - a\n$$\n的闭式解析表达式，该表达式用 $a$、$C$ 和 $\\theta$ 表示。$\\theta$ 以弧度表示。你的最终答案必须是 $\\Delta v_{g}(\\theta)$ 的简化解析表达式；最终的方框答案中不要包含任何单位。", "solution": "我们从线性平流方程 $u_{t} + a\\,u_{x} = 0$ 及其蛙跳离散格式开始：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - C\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right), \\quad C = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n为了进行 von Neumann 分析，我们代入傅里叶假设 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$，其中网格波数 $\\theta$ 以弧度为单位。于是\n$$\nu_{j\\pm 1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} (j\\pm 1)\\theta\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i} j \\theta\\right)\\,\\exp\\!\\left(\\pm \\mathrm{i} \\theta\\right).\n$$\n代入格式中并提出公因子 $\\exp\\!\\left(\\mathrm{i} j \\theta\\right)$，得到\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - C\\,\\hat{u}^{n}\\left(\\exp\\!\\left(\\mathrm{i} \\theta\\right) - \\exp\\!\\left(-\\mathrm{i} \\theta\\right)\\right).\n$$\n利用 $\\exp\\!\\left(\\mathrm{i} \\theta\\right) - \\exp\\!\\left(-\\mathrm{i} \\theta\\right) = 2 \\mathrm{i} \\sin(\\theta)$，我们得到\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - 2 \\mathrm{i} C \\sin(\\theta)\\,\\hat{u}^{n}.\n$$\n设每个时间步长的放大因子为 $\\lambda$，使得 $\\hat{u}^{n+1} = \\lambda\\,\\hat{u}^{n}$ 且 $\\hat{u}^{n-1} = \\lambda^{-1}\\,\\hat{u}^{n}$。代入可得\n$$\n\\lambda\\,\\hat{u}^{n} = \\lambda^{-1}\\,\\hat{u}^{n} - 2 \\mathrm{i} C \\sin(\\theta)\\,\\hat{u}^{n} \\quad \\Rightarrow \\quad \\lambda - \\lambda^{-1} = -2 \\mathrm{i} C \\sin(\\theta).\n$$\n两边乘以 $\\lambda$ 得到关于 $\\lambda$ 的二次方程：\n$$\n\\lambda^{2} + 2 \\mathrm{i} C \\sin(\\theta)\\,\\lambda - 1 = 0.\n$$\n两个根为\n$$\n\\lambda = - \\mathrm{i} C \\sin(\\theta) \\pm \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}.\n$$\n为了保证稳定性和得到在 $\\theta = 0$ 处连续的物理相关分支，我们选择在 $\\theta$ 较小时实部为正的根。将 $\\lambda$ 写成极坐标形式 $\\lambda = \\exp\\!\\left(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t\\right)$，其中 $\\omega(\\theta)$ 为实数，我们匹配其实部和虚部：\n$$\n\\lambda = \\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) - \\mathrm{i} \\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right).\n$$\n与 $\\lambda = - \\mathrm{i} C \\sin(\\theta) + \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}$ 比较，得到\n$$\n\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta), \\qquad \\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}.\n$$\n因此，离散色散关系由下式隐式定义：\n$$\n\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta).\n$$\n等价地，在主分支上，\n$$\n\\omega(\\theta) = \\frac{1}{\\Delta t}\\,\\arcsin\\!\\left(C\\,\\sin(\\theta)\\right).\n$$\n群速度定义为 $v_{g}(\\theta) = \\dfrac{d\\omega}{dk}$，其中物理波数为 $k = \\theta/\\Delta x$。根据链式法则，\n$$\nv_{g}(\\theta) = \\frac{d\\omega}{d\\theta}\\,\\frac{d\\theta}{dk} = \\Delta x\\,\\frac{d\\omega}{d\\theta}.\n$$\n对隐式关系 $\\sin\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = C\\,\\sin(\\theta)$ 关于 $\\theta$ 求导：\n$$\n\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right)\\,\\Delta t\\,\\frac{d\\omega}{d\\theta} = C\\,\\cos(\\theta).\n$$\n因此，\n$$\n\\frac{d\\omega}{d\\theta} = \\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right)}.\n$$\n利用 $\\cos\\!\\left(\\omega(\\theta)\\,\\Delta t\\right) = \\sqrt{1 - C^{2}\\sin^{2}(\\theta)}$，我们得到\n$$\n\\frac{d\\omega}{d\\theta} = \\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\n因此，\n$$\nv_{g}(\\theta) = \\Delta x\\,\\frac{C\\,\\cos(\\theta)}{\\Delta t\\,\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\n回顾 $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$，所以\n$$\nv_{g}(\\theta) = a\\,\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}}.\n$$\n线性平流的精确群速度为 $a$。因此，群速度误差为\n$$\n\\Delta v_{g}(\\theta) = v_{g}(\\theta) - a = a\\left(\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}} - 1\\right).\n$$\n这就是所求的用 $a$、$C$ 和 $\\theta$（其中 $\\theta$ 以弧度为单位）表示的闭式解析表达式。", "answer": "$$\\boxed{a\\left(\\frac{\\cos(\\theta)}{\\sqrt{1 - C^{2}\\sin^{2}(\\theta)}} - 1\\right)}$$", "id": "3388991"}, {"introduction": "不同的离散方法会引入不同类型的数值误差，理解并控制这些误差是设计高保真数值格式的核心。本练习 [@problem_id:3388948] 提供了一个关于数值格式设计的实践问题，要求您对比两种稳定对流项的常用策略：采用具有内蕴数值耗散的一阶迎风格式，以及为中心格式添加显式的人工滤波。通过求解最优的滤波强度，使两种格式在奈奎斯特频率下的阻尼特性相匹配，您将学会如何运用放大因子的理论来“工程化”地设计具有特定属性的数值格式。", "problem": "考虑一个被动标量的一维线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n其中平流速度 $a>0$ 为常数，方程在一个间距为 $\\Delta x$ 的均匀网格上进行离散，显式时间步长为 $\\Delta t$。令库朗-弗里德里希斯-列维（CFL）数为 $C = a \\Delta t / \\Delta x$，并假设 $0 \\leq C \\leq 1$。您将分析和比较两种显式格式的冯·诺伊曼放大因子：\n\n- 采用向前欧拉时间步进的一阶迎风空间离散格式，\n- 采用向前欧拉时间步进的二阶中心空间离散格式，并在每个时间更新后施加一个离散拉普拉斯形式的显式对称滤波器。\n\n迎风格式根据以下公式更新 $u_j^n$：\n$$\nu_j^{n+1} = u_j^n - C \\left( u_j^n - u_{j-1}^n \\right),\n$$\n其中 $j$ 是空间网格的索引，$n$ 是时间步的索引。中心格式首先执行向前欧拉步：\n$$\nu_j^{n+1/2} = u_j^n - \\frac{C}{2} \\left( u_{j+1}^n - u_{j-1}^n \\right),\n$$\n然后施加一个对称的显式滤波器：\n$$\nu_j^{n+1} = u_j^{n+1/2} + \\varepsilon \\left( u_{j+1}^{n+1/2} - 2 u_j^{n+1/2} + u_{j-1}^{n+1/2} \\right),\n$$\n其中 $\\varepsilon \\geq 0$ 是一个可调的滤波器强度。\n\n使用冯·诺伊曼稳定性分析，考虑单个傅里叶模式 $u_j^n = \\hat{u}^n \\exp(\\mathrm{i} j \\theta)$，其中无量纲波数为 $\\theta = k \\Delta x \\in [-\\pi,\\pi]$。将迎风格式和中心加滤波器格式的放大因子分别表示为 $G_{\\mathrm{up}}(\\theta)$ 和 $G_{\\mathrm{cf}}(\\theta;\\varepsilon)$。施加设计约束，要求在奈奎斯特波数 $\\theta = \\pi$ 处，两个放大因子的模相等：\n$$\n\\left| G_{\\mathrm{cf}}(\\pi;\\varepsilon) \\right| = \\left| G_{\\mathrm{up}}(\\pi) \\right|.\n$$\n在所有满足此奈奎斯特模匹配约束的 $\\varepsilon$ 中，选择能够最小化中等波数下相位误差的 $\\varepsilon$ 值；具体来说，优先选择能避免由滤波器引起的任何额外 $\\pi$ 相位翻转，从而在所有 $\\theta \\in [0,\\pi]$ 上保持中心格式放大因子相角的选项。推导出最终的最优滤波器强度 $\\varepsilon^\\star$ 关于 $C$ 的闭式解析表达式。\n\n您的最终答案必须是这个关于 $\\varepsilon^\\star$ 的单一解析表达式。不要包含单位。", "solution": "用户希望找到最优滤波器强度，记为 $\\varepsilon^\\star$，其形式为关于库朗数 $C$ 的闭式解析表达式。该问题是适定的且科学上合理的，因为它涉及求解偏微分方程（PDE）的标准数值方法及其稳定性分析。\n\n问题陈述如下：\n- **偏微分方程（PDE）**：$\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$，其中平流速度 $a > 0$ 为常数。\n- **网格参数**：空间步长 $\\Delta x$，时间步长 $\\Delta t$。\n- **CFL数**：$C = \\frac{a \\Delta t}{\\Delta x}$，其中 $0 \\leq C \\leq 1$。\n- **一阶迎风格式**：$u_j^{n+1} = u_j^n - C ( u_j^n - u_{j-1}^n )$。\n- **带显式滤波器的二阶中心格式**：\n  - 第1步（中心平流）：$u_j^{n+1/2} = u_j^n - \\frac{C}{2} ( u_{j+1}^n - u_{j-1}^n )$。\n  - 第2步（滤波）：$u_j^{n+1} = u_j^{n+1/2} + \\varepsilon ( u_{j+1}^{n+1/2} - 2 u_j^{n+1/2} + u_{j-1}^{n+1/2} )$，其中滤波器强度 $\\varepsilon \\geq 0$。\n- **冯·诺伊曼分析**：一个傅里叶模式表示为 $u_j^n = \\hat{u}^n \\exp(\\mathrm{i} j \\theta)$，其中 $\\theta = k \\Delta x$ 是无量纲波数。\n- **设计约束**：在奈奎斯特波数 $\\theta = \\pi$ 处，放大因子的模必须相等，即 $| G_{\\mathrm{cf}}(\\pi;\\varepsilon) | = | G_{\\mathrm{up}}(\\pi) |$。\n- **优化目标**：在满足约束的 $\\varepsilon$ 值中，选择一个能够防止滤波器在任何 $\\theta \\in [0, \\pi]$ 处引起 $\\pi$ 相位翻转的值。\n\n该问题是有效的，可以通过以下步骤解决：\n1.  推导迎风格式的放大因子 $G_{\\mathrm{up}}(\\theta)$。\n2.  推导中心加滤波器格式的放大因子 $G_{\\mathrm{cf}}(\\theta;\\varepsilon)$。\n3.  应用奈奎斯特模匹配约束，以找到 $\\varepsilon$ 关于 $C$ 的可能值。\n4.  应用相位误差约束，以选择唯一的最优值 $\\varepsilon^\\star$。\n\n### 步骤 1：迎风格式的放大因子\n我们将傅里叶模式 $u_j^n = \\hat{u}^n \\exp(\\mathrm{i} j \\theta)$ 代入迎风格式的方程：\n$$\n\\hat{u}^{n+1} \\exp(\\mathrm{i} j \\theta) = \\hat{u}^n \\exp(\\mathrm{i} j \\theta) - C \\left( \\hat{u}^n \\exp(\\mathrm{i} j \\theta) - \\hat{u}^n \\exp(\\mathrm{i} (j-1) \\theta) \\right)\n$$\n放大因子为 $G_{\\mathrm{up}}(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n}$。将方程两边同除以 $\\hat{u}^n \\exp(\\mathrm{i} j \\theta)$：\n$$\nG_{\\mathrm{up}}(\\theta) = 1 - C \\left( 1 - \\exp(-\\mathrm{i} \\theta) \\right)\n$$\n$$\nG_{\\mathrm{up}}(\\theta) = 1 - C(1 - \\cos\\theta + \\mathrm{i}\\sin\\theta) = (1 - C + C\\cos\\theta) - \\mathrm{i}C\\sin\\theta\n$$\n\n### 步骤 2：中心加滤波器格式的放大因子\n该格式包含两个连续的操作。总放大因子 $G_{\\mathrm{cf}}$ 是中心平流步骤的放大因子 $G_{\\mathrm{c}}$ 和滤波步骤的放大因子 $G_{\\mathrm{f}}$ 的乘积。因此，$G_{\\mathrm{cf}}(\\theta;\\varepsilon) = G_{\\mathrm{f}}(\\theta;\\varepsilon) G_{\\mathrm{c}}(\\theta)$。\n\n首先，对于中心平流步骤，$u_j^{n+1/2} = u_j^n - \\frac{C}{2} ( u_{j+1}^n - u_{j-1}^n )$：\n$$\n\\hat{u}^{n+1/2} \\exp(\\mathrm{i} j \\theta) = \\hat{u}^n \\exp(\\mathrm{i} j \\theta) - \\frac{C}{2} \\left( \\hat{u}^n \\exp(\\mathrm{i} (j+1) \\theta) - \\hat{u}^n \\exp(\\mathrm{i} (j-1) \\theta) \\right)\n$$\n两边同除以 $\\hat{u}^n \\exp(\\mathrm{i} j \\theta)$，得到 $G_{\\mathrm{c}}(\\theta) = \\frac{\\hat{u}^{n+1/2}}{\\hat{u}^n}$：\n$$\nG_{\\mathrm{c}}(\\theta) = 1 - \\frac{C}{2} (\\exp(\\mathrm{i} \\theta) - \\exp(-\\mathrm{i} \\theta)) = 1 - \\frac{C}{2} (2\\mathrm{i}\\sin\\theta) = 1 - \\mathrm{i}C\\sin\\theta\n$$\n\n接下来，对于滤波步骤，$u_j^{n+1} = u_j^{n+1/2} + \\varepsilon ( u_{j+1}^{n+1/2} - 2 u_j^{n+1/2} + u_{j-1}^{n+1/2} )$：\n$$\n\\hat{u}^{n+1} \\exp(\\mathrm{i} j \\theta) = \\hat{u}^{n+1/2} \\exp(\\mathrm{i} j \\theta) + \\varepsilon \\left( \\hat{u}^{n+1/2} \\exp(\\mathrm{i} (j+1) \\theta) - 2\\hat{u}^{n+1/2} \\exp(\\mathrm{i} j \\theta) + \\hat{u}^{n+1/2} \\exp(\\mathrm{i} (j-1) \\theta) \\right)\n$$\n两边同除以 $\\hat{u}^{n+1/2} \\exp(\\mathrm{i} j \\theta)$，得到 $G_{\\mathrm{f}}(\\theta;\\varepsilon) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n+1/2}}$：\n$$\nG_{\\mathrm{f}}(\\theta;\\varepsilon) = 1 + \\varepsilon (\\exp(\\mathrm{i} \\theta) - 2 + \\exp(-\\mathrm{i} \\theta)) = 1 + \\varepsilon (2\\cos\\theta - 2) = 1 - 2\\varepsilon(1 - \\cos\\theta)\n$$\n使用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\frac{\\theta}{2})$，上式变为：\n$$\nG_{\\mathrm{f}}(\\theta;\\varepsilon) = 1 - 4\\varepsilon\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n总放大因子为：\n$$\nG_{\\mathrm{cf}}(\\theta;\\varepsilon) = \\left(1 - 4\\varepsilon\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) (1 - \\mathrm{i}C\\sin\\theta)\n$$\n\n### 步骤 3：奈奎斯特模匹配约束\n约束条件为 $|G_{\\mathrm{cf}}(\\pi;\\varepsilon)| = |G_{\\mathrm{up}}(\\pi)|$。我们在奈奎斯特波数 $\\theta = \\pi$ 处计算每一边。\n\n对于迎风格式，在 $\\theta = \\pi$ 处：\n$$\nG_{\\mathrm{up}}(\\pi) = 1 - C(1 - \\exp(-\\mathrm{i}\\pi)) = 1 - C(1 - (-1)) = 1 - 2C\n$$\n其模为 $|G_{\\mathrm{up}}(\\pi)| = |1 - 2C|$。\n\n对于中心加滤波器格式，在 $\\theta = \\pi$ 处：\n中心平流部分为 $G_{\\mathrm{c}}(\\pi) = 1 - \\mathrm{i}C\\sin(\\pi) = 1$。\n滤波部分为 $G_{\\mathrm{f}}(\\pi;\\varepsilon) = 1 - 4\\varepsilon\\sin^2(\\frac{\\pi}{2}) = 1 - 4\\varepsilon(1)^2 = 1 - 4\\varepsilon$。\n因此，$G_{\\mathrm{cf}}(\\pi;\\varepsilon) = G_{\\mathrm{f}}(\\pi;\\varepsilon)G_{\\mathrm{c}}(\\pi) = 1 - 4\\varepsilon$。\n其模为 $|G_{\\mathrm{cf}}(\\pi;\\varepsilon)| = |1 - 4\\varepsilon|$。\n\n令两者的模相等：\n$$\n|1 - 4\\varepsilon| = |1 - 2C|\n$$\n\n### 步骤 4：相位误差约束与最优 $\\varepsilon^\\star$ 的选择\n问题指定选择 $\\varepsilon$ 以避免由滤波器引起的额外 $\\pi$ 相位翻转。中心加滤波器格式的放大因子为 $G_{\\mathrm{cf}} = G_{\\mathrm{f}} G_{\\mathrm{c}}$。其相位为 $\\arg(G_{\\mathrm{cf}}) = \\arg(G_{\\mathrm{f}}) + \\arg(G_{\\mathrm{c}})$。如果滤波器的放大因子 $G_{\\mathrm{f}}(\\theta;\\varepsilon)$ 在某个 $\\theta$ 处变为负值，则会引入一个额外的 $\\pi$ 相位翻转。由于 $G_{\\mathrm{f}}(\\theta;\\varepsilon)$ 是一个实值函数，这种情况对应于 $\\arg(G_{\\mathrm{f}}) = \\pi$。\n为避免这种情况，我们必须强制要求对于所有 $\\theta \\in [0, \\pi]$，都有 $G_{\\mathrm{f}}(\\theta;\\varepsilon) \\geq 0$。\n$$\nG_{\\mathrm{f}}(\\theta;\\varepsilon) = 1 - 4\\varepsilon\\sin^2\\left(\\frac{\\theta}{2}\\right) \\geq 0\n$$\n由于 $\\varepsilon \\geq 0$，项 $4\\varepsilon\\sin^2(\\frac{\\theta}{2})$ 始终为非负。函数 $\\sin^2(\\frac{\\theta}{2})$ 在 $\\theta = \\pi$ 时达到其最大值 $1$。因此，该条件必须对这个“最坏情况”的波数成立。我们必须要求：\n$$\nG_{\\mathrm{f}}(\\pi;\\varepsilon) = 1 - 4\\varepsilon \\geq 0\n$$\n这施加了约束 $\\varepsilon \\leq \\frac{1}{4}$。\n\n现在我们回到模匹配方程 $|1 - 4\\varepsilon| = |1 - 2C|$。由于我们必须有 $1 - 4\\varepsilon \\geq 0$，左侧的绝对值可以去掉：\n$$\n1 - 4\\varepsilon = |1 - 2C|\n$$\n求解 $\\varepsilon$：\n$$\n4\\varepsilon = 1 - |1 - 2C|\n$$\n$$\n\\varepsilon = \\frac{1 - |1 - 2C|}{4}\n$$\n此表达式给出了所求的最优滤波器强度 $\\varepsilon^\\star$。我们来验证这个结果是否与约束条件一致。\n- 由于 $0 \\leq C \\leq 1$，我们有 $-1 \\leq 1 - 2C \\leq 1$，所以 $0 \\leq |1 - 2C| \\leq 1$。\n- 这意味着 $0 \\leq 1 - |1 - 2C| \\leq 1$。\n- 因此，$0 \\leq \\varepsilon \\leq \\frac{1}{4}$，这同时满足了 $\\varepsilon \\geq 0$ 和无相位翻转条件 $\\varepsilon \\leq \\frac{1}{4}$。\n\n这个表达式可以写成分段函数形式以去掉绝对值：\n- 如果 $0 \\leq C \\leq \\frac{1}{2}$，则 $|1 - 2C| = 1 - 2C$，所以 $\\varepsilon^\\star = \\frac{1 - (1 - 2C)}{4} = \\frac{2C}{4} = \\frac{C}{2}$。\n- 如果 $\\frac{1}{2}  C \\leq 1$，则 $|1 - 2C| = -(1 - 2C) = 2C - 1$，所以 $\\varepsilon^\\star = \\frac{1 - (2C - 1)}{4} = \\frac{2 - 2C}{4} = \\frac{1 - C}{2}$。\n\n单一解析表达式 $\\frac{1 - |1 - 2C|}{4}$ 正确地描述了在整个 $C$ 值范围内的这种行为，并且是所要求的解。", "answer": "$$\\boxed{\\frac{1 - |1 - 2C|}{4}}$$", "id": "3388948"}]}