{"hands_on_practices": [{"introduction": "物质导数巧妙地结合了固定点的局部变化率和因在非均匀场中运动而引起的变化。本练习提供了一个具体的场景来剖析这两个分量。通过计算一个简单拉伸流中的物质导数，您将对流体质点所经历的变化如何同时受到场的时间演化和空间变化的影响，获得更深刻的物理直觉。[@problem_id:3376233]", "problem": "在计算流体动力学 (CFD) 中，物质导数衡量的是跟随流体运动的流体质点所经历的某个输运量的时间变化率。考虑一个一维、不可压缩、无粘性的运动学设定，其中的速度场和一个输运标量场分别由欧拉场 $u(x,t)$ 和 $\\phi(x,t)$ 给出。设速度场为 $u(x,t)=a\\,x$，其中 $a$ 是一个实常数，标量场为 $\\phi(x,t)=x^{2}\\,t$。流体质点轨迹 $x(t)$ 由运动学关系 $\\mathrm{d}x/\\mathrm{d}t=u(x,t)$ 定义，而 $\\phi$ 在欧拉点 $(x,t)$ 的物质导数是当质点经过该点时其所经历的 $\\phi$ 的时间变化率。\n\n请仅使用质点路径的基本运动学定义和应用于复合函数 $\\phi(x(t),t)$ 的链式法则，推导在任意欧拉点 $(x,t)$ 处求值的 $\\phi$ 的物质导数的显式表达式。然后，根据运动的流体质点在此流场中的经历，解释你结果的符号和结构。\n\n请以一个包含 $x$、$t$ 和 $a$ 的单一闭式解析表达式的形式给出你的最终结果。不需要进行数值近似或四舍五入。", "solution": "该问题要求在给定的一维速度场中，对一个指定的标量场推导并解释其物质导数。该过程从验证问题陈述开始。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   **物理设定**：一维、不可压缩、无粘性的运动学设定。\n-   **欧拉速度场**：$u(x,t) = a\\,x$，其中 $a$ 是一个实常数。\n-   **欧拉标量场**：$\\phi(x,t) = x^{2}\\,t$。\n-   **质点路径定义**：流体质点的轨迹，记为 $x(t)$，由常微分方程 $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = u(x(t),t)$ 控制。\n-   **主要任务**：通过对复合函数 $\\phi(x(t),t)$ 应用链式法则，推导 $\\phi$ 在欧拉点 $(x,t)$ 的物质导数。\n-   **次要任务**：解释所得表达式的符号和结构。\n\n**第2步：使用提取的已知条件进行验证**\n这个问题在科学上基于连续介质力学和流体动力学的原理。欧拉场、质点路径和物质导数的概念是这些学科的基础。所提供的函数是良态的，可以直接进行推导。\n\n一个小的争议点是，对于速度场 $u(x,t) = ax$，同时指定了“一维”和“不可压缩”流动。对于一维流动，不可压缩条件 $\\nabla \\cdot \\mathbf{u} = 0$ 简化为 $\\frac{\\partial u}{\\partial x} = 0$。对于给定的场，$\\frac{\\partial u}{\\partial x} = a$。因此，一维的严格不可压缩性要求 $a=0$，但这会使问题的对流方面变得微不足道。然而，“运动学设定”的提法意味着速度场是预先给定的，其目标是研究此流场内的输运特性，而不管该场是否满足所有的动力学和守恒定律。此外，$u(x,t) = ax$ 可以代表一个更高维度不可压缩流的一个分量。这个细微的不一致性并不妨碍数学任务的完成，而这正是问题的核心。因此，该问题对于运动学分析是适定的和有效的。\n\n**结论**：该问题有效。\n\n### 物质导数的推导\n\n物质导数，记为 $\\frac{D\\phi}{Dt}$，衡量的是随流运动的流体质点所经历的标量 $\\phi$ 的总变化率。问题要求我们通过将 $\\phi$ 视为时间的复合函数 $\\phi(x(t),t)$ 来推导它，其中 $x(t)$ 是质点的轨迹。使用多元链式法则，该复合函数的全时间导数为：\n$$\n\\frac{d}{dt}\\phi(x(t), t) = \\frac{\\partial \\phi}{\\partial x} \\frac{dx}{dt} + \\frac{\\partial \\phi}{\\partial t} \\frac{dt}{dt}\n$$\n根据定义，流体质点的速度由 $\\frac{dx}{dt} = u(x(t),t)$ 给出。将此代入链式法则表达式，并注意到 $\\frac{dt}{dt} = 1$，我们得到应用于 $\\phi$ 的物质导数算子的标准欧拉形式：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + u(x,t) \\frac{\\partial \\phi}{\\partial x}\n$$\n该表达式在质点于时间 $t$ 经过的欧拉点 $(x,t)$ 处求值。\n\n给定标量场 $\\phi(x,t) = x^{2}t$。我们计算其偏导数：\n1.  当地（或非定常）时间导数：\n    $$\n    \\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t}(x^{2}t) = x^{2}\n    $$\n2.  空间梯度：\n    $$\n    \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x}(x^{2}t) = 2xt\n    $$\n我们还已知速度场 $u(x,t) = ax$。\n\n现在，我们将这些表达式代入物质导数的公式中：\n$$\n\\frac{D\\phi}{Dt} = (x^{2}) + (ax)(2xt)\n$$\n化简第二项得到：\n$$\n\\frac{D\\phi}{Dt} = x^{2} + 2ax^{2}t\n$$\n提出公因式 $x^{2}$，得到在欧拉点 $(x,t)$ 的物质导数的最终闭式表达式：\n$$\n\\frac{D\\phi}{Dt} = x^{2}(1 + 2at)\n$$\n\n### 结果解释\n\n物质导数的表达式 $\\frac{D\\phi}{Dt} = x^{2} + 2ax^{2}t$ 由两个不同的物理贡献组成：\n\n1.  **当地变化率**：第一项 $\\frac{\\partial \\phi}{\\partial t} = x^{2}$ 代表在固定空间位置 $x$ 处 $\\phi$ 的变化率。由于 $x^{2} \\ge 0$，在空间中的每一点，标量场的值都随时间非递减。一个固定在任意位置 $x \\neq 0$ 的观察者会看到 $\\phi$ 的值随时间增加。\n\n2.  **对流变化率**：第二项 $u \\frac{\\partial \\phi}{\\partial x} = 2ax^{2}t$ 代表流体质点因其在空间非均匀场中运动而经历的 $\\phi$ 的变化。\n    -   场的空间梯度为 $\\frac{\\partial \\phi}{\\partial x} = 2xt$。对于 $t0$，当远离原点 $x=0$ 时，$\\phi$ 的值增加。\n    -   速度为 $u=ax$。流动的性质取决于常数 $a$ 的符号。\n        -   如果 $a  0$，流动是远离原点的拉伸流（对于 $x  0$，$u  0$；对于 $x  0$，$u  0$）。质点正从原点移向 $\\phi$ 值更高的区域（对于 $t  0$）。因此，对于 $t0$，对流项 $2ax^{2}t$ 为正，导致质点所经历的 $\\phi$ 值增加。\n        -   如果 $a  0$，流动是向原点汇集的压缩流。质点向原点移动，进入 $\\phi$ 值更低的区域（对于 $t0$）。因此，对于 $t  0$，对流项 $2ax^{2}t$ 为负，导致质点所经历的 $\\phi$ 值减小。\n\n**质点经历的总变化**：净变化率 $\\frac{D\\phi}{Dt} = x^{2}(1 + 2at)$ 是这两种效应的总和。总变化的符号取决于因子 $(1 + 2at)$。\n\n-   如果 $a  0$（拉伸流），那么对于 $t \\ge 0$，当地项和对流项都是非负的。流体质点由于当地场的演化以及其向更高 $\\phi$ 值区域的运动，都会经历 $\\phi$ 值的增加。\n-   如果 $a  0$（压缩流），对于 $t  0$，这两种效应是相反的。当地项 $x^2$ 是正的，而对流项 $2ax^2t$ 是负的。\n    -   如果 $1 + 2at  0$（即，对于 $t  \\frac{-1}{2a}$），当地增加占主导，质点经历 $\\phi$ 值的净增加。\n    -   如果 $1 + 2at  0$（即，对于 $t > \\frac{-1}{2a}$），对流减少占主导，质点经历 $\\phi$ 值的净减少。\n    -   在特定时间 $t = \\frac{-1}{2a}$，当地增加与对流减少完全平衡，物质导数为零。质点没有经历 $\\phi$ 的瞬时变化。\n\n总之，推导出的表达式优雅地捕捉了标量场的当地、随时间演化与运动流体质点对标量的对流输运之间的竞争关系。", "answer": "$$\\boxed{x^{2}(1 + 2at)}$$", "id": "3376233"}, {"introduction": "物质导数的一个核心应用是求解对流方程，其中标量沿着流体轨迹守恒。本练习要求您从欧拉速度场出发，反向求解拉格朗日粒子路径。通过追踪流体粒子的初始位置，您可以确定守恒标量的当前值，从而重构整个标量场随时间的演变。[@problem_id:3376241]", "problem": "在计算流体动力学 (CFD) 中，考虑一个角速度为 $\\omega0$ 的二维不可压缩刚体旋转，其速度场由 $\\boldsymbol{u}(x,y,t)=\\left(\\omega y,\\,-\\omega x\\right)$ 描述。一个被动标量场 $\\phi(x,y,t)$ 沿着流体轨迹是物质守恒的，其初始条件为 $\\phi(x,y,0)=x$。仅使用满足 $\\dot{\\boldsymbol{X}}(t)=\\boldsymbol{u}(\\boldsymbol{X}(t),t)$ 的拉格朗日流体轨迹 $\\boldsymbol{X}(t)$ 的定义，以及物质守恒标量在跟随运动时保持恒定的原理，推导出对所有 $t\\ge 0$ 和所有 $(x,y)\\in\\mathbb{R}^{2}$ 都有效的 $\\phi(x,y,t)$ 的显式解析表达式。然后，从第一性原理出发，验证物质时间变化率 $D\\phi/Dt$ 在每个点 $(x,y,t)$ 都恒等于零。将你的最终答案表示为 $\\phi(x,y,t)$ 的单个闭式解析表达式。无需四舍五入，也无需单位。", "solution": "该问题是有效的。它提出了一个流体力学中定义明确、有科学依据的问题，涉及被动标量在刚体旋转流中的平流。所有必要的数据和条件都已给出，问题是自洽且一致的。\n\n核心任务是根据给定的初始状态 $\\phi(x,y,0)$ 和对其进行平流输运的速度场 $\\boldsymbol{u}(x,y,t)$ 来确定被动标量场 $\\phi(x,y,t)$。物质守恒原理指出，与特定流体质点相关联的 $\\phi$ 值在该质点移动时保持不变。设 $\\boldsymbol{X}(t_0; t)$ 是一个在时间 $t_0$ 位于位置 $\\boldsymbol{x}_0$ 的流体质点在时间 $t$ 的位置。物质守恒意味着 $\\phi(\\boldsymbol{X}(t_0; t), t) = \\phi(\\boldsymbol{x}_0, t_0)$。\n\n在这个问题中，我们想要求出在任意欧拉点 $(x,y)$ 和时间 $t$ 的 $\\phi(x,y,t)$。设当前位于 $(x,y)$ 的流体质点在时间 $t=0$ 时源于位置 $(x_0, y_0)$。物质守恒原理给出：\n$$\n\\phi(x,y,t) = \\phi(x_0, y_0, 0)\n$$\n问题给出的初始条件是 $\\phi(x,y,0) = x$。将其应用于初始位置 $(x_0, y_0)$，我们得到：\n$$\n\\phi(x_0, y_0, 0) = x_0\n$$\n因此，我们关于标量场的表达式变为：\n$$\n\\phi(x,y,t) = x_0\n$$\n为了找到 $\\phi(x,y,t)$ 的显式表达式，我们必须找到初始位置 $x_0$ 作为当前位置 $(x,y)$ 和时间 $t$ 的函数。这可以通过求解拉格朗日流体轨迹来实现。一条轨迹 $\\boldsymbol{X}(t) = (X(t), Y(t))$ 由微分方程 $\\dot{\\boldsymbol{X}}(t) = \\boldsymbol{u}(\\boldsymbol{X}(t),t)$ 控制。给定的速度场是 $\\boldsymbol{u}(x,y,t) = (\\omega y, -\\omega x)$。轨迹的常微分方程组 (ODEs) 是：\n$$\n\\frac{dX}{dt} = \\omega Y\n$$\n$$\n\\frac{dY}{dt} = -\\omega X\n$$\n这是一个线性一阶常微分方程组。我们可以通过对第一个方程关于 $t$ 求导，并代入第二个方程来求解它：\n$$\n\\frac{d^2X}{dt^2} = \\omega \\frac{dY}{dt} = \\omega (-\\omega X) = -\\omega^2 X\n$$\n这给出了 $X(t)$ 的二阶常微分方程：\n$$\n\\frac{d^2X}{dt^2} + \\omega^2 X = 0\n$$\n其通解为 $X(t) = C_1 \\cos(\\omega t) + C_2 \\sin(\\omega t)$。我们可以从第一个常微分方程中求出 $Y(t)$：$Y(t) = \\frac{1}{\\omega} \\frac{dX}{dt} = \\frac{1}{\\omega} (-C_1 \\omega \\sin(\\omega t) + C_2 \\omega \\cos(\\omega t)) = -C_1 \\sin(\\omega t) + C_2 \\cos(\\omega t)$。\n\n常数 $C_1$ 和 $C_2$ 由质点在 $t=0$ 时的初始位置 $(x_0, y_0)$ 决定。\n在 $t=0$ 时：\n$X(0) = x_0 \\implies C_1 \\cos(0) + C_2 \\sin(0) = C_1 = x_0$。\n$Y(0) = y_0 \\implies -C_1 \\sin(0) + C_2 \\cos(0) = C_2 = y_0$。\n\n所以，从 $(x_0, y_0)$ 出发的质点的轨迹由下式给出：\n$$\nX(t) = x_0 \\cos(\\omega t) + y_0 \\sin(\\omega t)\n$$\n$$\nY(t) = -x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t)\n$$\n我们关心的是在时间 $t$ 位于位置 $(x,y)$ 的质点。因此，我们设 $X(t)=x$ 和 $Y(t)=y$，并求解关于 $(x_0, y_0)$ 的方程组：\n$$\nx = x_0 \\cos(\\omega t) + y_0 \\sin(\\omega t) \\quad (1)\n$$\n$$\ny = -x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t) \\quad (2)\n$$\n为了求解 $x_0$，我们可以将方程(1)乘以 $\\cos(\\omega t)$，将方程(2)乘以 $-\\sin(\\omega t)$，然后将它们相加：\n$$\nx \\cos(\\omega t) - y \\sin(\\omega t) = (x_0 \\cos^2(\\omega t) + y_0 \\sin(\\omega t)\\cos(\\omega t)) - (-x_0 \\sin^2(\\omega t) + y_0 \\cos(\\omega t)\\sin(\\omega t))\n$$\n$$\nx \\cos(\\omega t) - y \\sin(\\omega t) = x_0 (\\cos^2(\\omega t) + \\sin^2(\\omega t)) + y_0 (\\sin(\\omega t)\\cos(\\omega t) - \\cos(\\omega t)\\sin(\\omega t))\n$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$，我们得到：\n$$\nx_0 = x \\cos(\\omega t) - y \\sin(\\omega t)\n$$\n将此代回到我们关于 $\\phi(x,y,t)$ 的表达式中，我们得到显式解析表达式：\n$$\n\\phi(x,y,t) = x \\cos(\\omega t) - y \\sin(\\omega t)\n$$\n接下来，我们必须从第一性原理出发验证物质时间变化率 $D\\phi/Dt$ 恒等于零。物质导数的定义为：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla\\phi = \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y}\n$$\n其中速度分量为 $u = \\omega y$ 和 $v = -\\omega x$。\n我们计算我们推导出的 $\\phi$ 表达式的偏导数：\n1.  关于时间 $t$ 的偏导数：\n    $$\n    \\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t} (x \\cos(\\omega t) - y \\sin(\\omega t)) = -x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t)\n    $$\n2.  关于空间坐标 $x$ 的偏导数：\n    $$\n    \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} (x \\cos(\\omega t) - y \\sin(\\omega t)) = \\cos(\\omega t)\n    $$\n3.  关于空间坐标 $y$ 的偏导数：\n    $$\n    \\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} (x \\cos(\\omega t) - y \\sin(\\omega t)) = -\\sin(\\omega t)\n    $$\n现在，将这些导数和速度分量代入物质导数公式：\n$$\n\\frac{D\\phi}{Dt} = (-x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t)) + (\\omega y)(\\cos(\\omega t)) + (-\\omega x)(-\\sin(\\omega t))\n$$\n$$\n\\frac{D\\phi}{Dt} = -x \\omega \\sin(\\omega t) - y \\omega \\cos(\\omega t) + \\omega y \\cos(\\omega t) + \\omega x \\sin(\\omega t)\n$$\n合并同类项后，我们看到它们相互抵消：\n$$\n\\frac{D\\phi}{Dt} = (-x \\omega \\sin(\\omega t) + \\omega x \\sin(\\omega t)) + (-y \\omega \\cos(\\omega t) + \\omega y \\cos(\\omega t)) = 0 + 0 = 0\n$$\n这证实了对于所有的 $(x,y,t)$，$D\\phi/Dt = 0$，正如物质守恒标量所要求的那样。推导出的表达式是正确的。\n最终答案是 $\\phi(x,y,t)$ 的显式表达式。", "answer": "$$\n\\boxed{x \\cos(\\omega t) - y \\sin(\\omega t)}\n$$", "id": "3376241"}, {"introduction": "在计算流体动力学中，连续的算子必须被转换为离散的近似，这一过程不可避免地会引入误差。本练习探讨了物质导数中对流项的常用一阶迎风格式。通过进行截断误差分析，您将揭示该格式中隐藏的“数值扩散”——这是理解对流问题数值解的行为和局限性的一个关键概念。[@problem_id:3376237]", "problem": "考虑一个被动标量场 $\\phi(x,t)$，它在一个间距为 $\\Delta x$ 的均匀一维网格上以恒定速度 $u$ 平流。其物质导数为 $D \\phi / D t = \\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x$。关注对流项 $u \\, \\partial \\phi / \\partial x$，并假设 $\\phi$ 足够光滑以至于泰勒级数展开有效。\n\n从第一性原理出发，不使用任何预先推导的离散化格式，构建在均匀网格节点 $x_i$ 处对 $u \\, \\partial \\phi / \\partial x$ 的一阶迎风半离散近似。你的表达式必须对 $u$ 的任意符号都有效，并写成一个不显式地根据符号进行分支的单一公式。然后，使用关于 $x_i$ 的泰勒级数展开进行主阶截断误差分析，将你的离散对流算子重写为精确对流算子加上一系列高阶导数修正项。利用此结果，确定等效主阶数值耗散项 $\\kappa_{\\mathrm{num}} \\, \\partial^2 \\phi / \\partial x^2$ 的系数 $\\kappa_{\\mathrm{num}}$，该项需要被添加到连续方程中以匹配迎风离散化的主截断效应。\n\n以 $u$ 和 $\\Delta x$ 表示的单个闭式解析表达式的形式提供你的最终答案 $\\kappa_{\\mathrm{num}}$。最终答案中不应包含单位。不需要进行数值舍入。", "solution": "用户要求我按照以下步骤解决问题：\n1.  **验证问题**：检查其科学合理性、自洽性和适定性。\n2.  如果有效，**解决问题**：\n    a.  构建在节点 $x_i$ 处对 $u \\, \\partial \\phi / \\partial x$ 的一阶迎风半离散近似。该公式必须是适用于 $u$ 任意符号的单一表达式。\n    b.  使用泰勒级数展开进行主阶截断误差分析。\n    c.  从主误差项中确定数值耗散系数 $\\kappa_{\\mathrm{num}}$。\n3.  根据指定规则格式化输出，包括强制性的 LaTeX 和特定的 XML 标签。\n\n### 步骤1：提取已知条件\n\n-   标量场：$\\phi(x,t)$\n-   速度：$u$，恒定\n-   网格：均匀一维，间距为 $\\Delta x$\n-   物质导数：$D \\phi / D t = \\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x$\n-   待离散项：$u \\, \\partial \\phi / \\partial x$\n-   假设：$\\phi$ 足够光滑，泰勒级数展开有效\n-   求值点：节点 $x_i$\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题是计算流体动力学（CFD）和数值分析领域的一个基础练习。它涉及标准的、公认的概念：平流方程、迎风离散化、泰勒级数分析、截断误差和数值耗散。所有原理都是合理的。\n-   **适定性**：问题陈述清晰，提供了所有必要信息。目标是推导一个特定的解析表达式，这是一个明确定义的任务。存在唯一解。\n-   **客观性**：语言精确、技术性强，没有任何主观性或歧义。所用术语均为该领域的标准术语。\n-   **其他缺陷**：问题是自洽的、一致的且科学上可行的。它不具有任何列出的无效标准。这是一个标准的、非平凡的问题，用于测试对数值方法核心理解的掌握程度。\n\n### 步骤3：结论与行动\n\n问题是**有效**的。我将继续进行求解。\n\n问题要求为对流项 $u \\frac{\\partial \\phi}{\\partial x}$ 构建一阶迎风离散格式，并通过截断误差分析确定主阶数值耗散系数。令 $\\phi_i(t)$ 表示网格节点 $x_i$ 处的标量场值，即 $\\phi_i(t) = \\phi(x_i, t)$。\n\n迎风格式的原理是使用来自流动上游方向的信息。我们根据速度 $u$ 的符号考虑两种情况。\n\n情况1：$u  0$。流动方向为从左到右。相对于 $x_i$ 的“迎风”节点是 $x_{i-1}$。在 $x_i$ 处空间导数 $\\frac{\\partial \\phi}{\\partial x}$ 的一阶近似由一阶后向差分公式给出：\n$$ \\left. \\frac{\\partial \\phi}{\\partial x} \\right|_i \\approx \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n因此，离散化的对流项为：\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n\n情况2：$u  0$。流动方向为从右到左。相对于 $x_i$ 的“迎风”节点是 $x_{i+1}$。空间导数的一阶近似由一阶前向差分公式给出：\n$$ \\left. \\frac{\\partial \\phi}{\\partial x} \\right|_i \\approx \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n因此，离散化的对流项为：\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n\n为了将这两种情况合并成一个没有显式分支的单一公式，我们可以将迎风格式表示为一个中心差分格式与一个人工耗散项的和。一阶导数的二阶中心差分近似是 $u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x}$，二阶导数的二阶中心差分近似是 $\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2}$。一阶迎风格式的一个合适的单一公式表示为：\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} - \\frac{|u|\\Delta x}{2} \\left( \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} \\right) $$\n我们来验证这个形式。\n如果 $u  0$，则 $|u| = u$。表达式变为：\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} - \\frac{u\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{u}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1} - (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1})) = \\frac{u}{2\\Delta x}(2\\phi_i - 2\\phi_{i-1}) = u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} $$\n这与 $u0$ 时的后向差分格式相匹配。\n如果 $u  0$，则 $|u| = -u$。表达式变为：\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} - \\frac{(-u)\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{u}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1} + (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1})) = \\frac{u}{2\\Delta x}(2\\phi_{i+1} - 2\\phi_i) = u \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} $$\n这与 $u0$ 时的前向差分格式相匹配。因此，该单一公式得到了验证。\n\n接下来，我们进行截断误差分析。我们使用 $\\phi_{i+1}$ 和 $\\phi_{i-1}$ 在点 $x_i$ 附近的泰勒级数展开。为简洁起见，我们将 $\\left. \\frac{\\partial^n \\phi}{\\partial x^n} \\right|_{x_i}$ 记为 $\\phi_x^{(n)}$。\n$$ \\phi_{i+1} = \\phi(x_i + \\Delta x) = \\phi_i + \\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{2} \\phi_x^{(2)} + \\frac{(\\Delta x)^3}{6} \\phi_x^{(3)} + O((\\Delta x)^4) $$\n$$ \\phi_{i-1} = \\phi(x_i - \\Delta x) = \\phi_i - \\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{2} \\phi_x^{(2)} - \\frac{(\\Delta x)^3}{6} \\phi_x^{(3)} + O((\\Delta x)^4) $$\n我们将这些展开式代入我们的离散算子各项中。\n\n对于中心差分部分：\n$$ \\phi_{i+1} - \\phi_{i-1} = 2\\Delta x \\phi_x^{(1)} + \\frac{(\\Delta x)^3}{3} \\phi_x^{(3)} + O((\\Delta x)^5) $$\n$$ u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x} = u \\left( \\phi_x^{(1)} + \\frac{(\\Delta x)^2}{6} \\phi_x^{(3)} + O((\\Delta x)^4) \\right) = u \\frac{\\partial \\phi}{\\partial x} + u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 \\phi}{\\partial x^3} + O((\\Delta x)^4) $$\n\n对于人工耗散部分：\n$$ \\phi_{i+1} - 2\\phi_i + \\phi_{i-1} = (\\Delta x)^2 \\phi_x^{(2)} + \\frac{(\\Delta x)^4}{12} \\phi_x^{(4)} + O((\\Delta x)^6) $$\n$$ \\frac{|u|\\Delta x}{2} \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = \\frac{|u|\\Delta x}{2} \\left( \\phi_x^{(2)} + \\frac{(\\Delta x)^2}{12} \\phi_x^{(4)} + O((\\Delta x)^4) \\right) = \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{|u|(\\Delta x)^3}{24} \\frac{\\partial^4 \\phi}{\\partial x^4} + O((\\Delta x)^5) $$\n\n综合这些结果，离散算子变为：\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx \\left( u \\frac{\\partial \\phi}{\\partial x} + u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 \\phi}{\\partial x^3} + \\dots \\right) - \\left( \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{|u|(\\Delta x)^3}{24} \\frac{\\partial^4 \\phi}{\\partial x^4} + \\dots \\right) $$\n按导数阶数重新排列各项：\n$$ \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i \\approx u \\frac{\\partial \\phi}{\\partial x} - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\n截断误差 $\\tau$ 是离散算子与精确算子之间的差：\n$$ \\tau = \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i - u \\frac{\\partial \\phi}{\\partial x} = - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\n截断误差的主阶项是 $- \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2}$。此项为 $O(\\Delta x)$ 阶，证实了迎风格式是一阶精度的。\n\n纯平流方程的半离散形式是 $\\frac{d\\phi_i}{dt} + \\left( u \\frac{\\partial \\phi}{\\partial x} \\right)_i = 0$。代入我们离散算子的展开式，我们得到实际求解的修正微分方程：\n$$ \\frac{d\\phi_i}{dt} + \\left( u \\frac{\\partial \\phi}{\\partial x} - \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) \\right) = 0 $$\n$$ \\left( \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} \\right) = \\frac{|u|\\Delta x}{2} \\frac{\\partial^2 \\phi}{\\partial x^2} + O((\\Delta x)^2) $$\n左边的项是物质导数，$\\frac{D\\phi}{Dt}$。主阶截断误差在方程右边引入了一个具有耗散项形式的项。带有附加物理耗散项的连续方程写作 $\\frac{D\\phi}{Dt} = \\kappa \\frac{\\partial^2 \\phi}{\\partial x^2}$。通过将其与修正方程进行比较，我们可以确定等效数值耗散系数 $\\kappa_{\\mathrm{num}}$ 为：\n$$ \\kappa_{\\mathrm{num}} = \\frac{|u|\\Delta x}{2} $$\n这种数值耗散是一阶迎风离散化的产物，并导致了该格式的耗散特性。", "answer": "$$\n\\boxed{\\frac{|u|\\Delta x}{2}}\n$$", "id": "3376237"}]}