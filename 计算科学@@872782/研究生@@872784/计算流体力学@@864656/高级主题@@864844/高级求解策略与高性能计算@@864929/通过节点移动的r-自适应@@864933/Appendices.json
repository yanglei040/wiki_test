{"hands_on_practices": [{"introduction": "r-refinement的核心思想是等分布原则，即移动网格节点，使得每个单元都能捕捉到等量的、用于特征检测的监控函数。本实践提供了一个具体的一维数值练习来实现这一原则。通过求解满足等分布方程的节点位置，您将亲身体验r-refinement的基本机制。[@problem_id:3355747]", "problem": "考虑计算流体动力学 (CFD) 中通过节点移动实现的 r-自适应，其中物理域 $[0,1]$ 通过一个单调函数 $x(s)$ 从一个均匀的计算坐标 $s \\in [0,1]$ 映射而来。设解的代理函数为 $u(x) = \\tanh\\!\\big(\\beta(x - 0.5)\\big)$，其中 $\\beta$ 是一个给定的正参数，并定义监控函数 $M(x) = 1 + \\alpha \\lvert u_x(x) \\rvert$，其中 $\\alpha \\ge 0$ 是一个给定的参数，$u_x$ 表示 $u$ 相对于 $x$ 的导数。r-自适应的目标是移动节点 $\\{x_i\\}_{i=0}^{N-1}$ 以均分监控函数 $M$，使得物理域中的每个区间都分配到等量的监控函数值，同时与固定端点 $x_0 = 0$ 和 $x_{N-1} = 1$ 保持一致。\n\n从均分的定义出发，并根据计算坐标中的均匀划分 $s_i = i/(N-1)$（其中 $i = 0,1,\\dots,N-1$）映射到物理节点 $\\{x_i\\}$ 时每个区间的监控函数测度相等这一要求，推导节点 $\\{x_i\\}$ 必须满足的隐式方程。然后，使用 $u(x) = \\tanh\\!\\big(\\beta(x - 0.5)\\big)$，为 $N = 10$ 计算以下每个测试用例的节点 $\\{x_i\\}$，结果表示为浮点数值的列表：\n1. $\\alpha = 0$, $\\beta = 5$.\n2. $\\alpha = 2$, $\\beta = 10$.\n3. $\\alpha = 5$, $\\beta = 50$.\n4. $\\alpha = 10^{-6}$, $\\beta = 20$.\n5. $\\alpha = 3$, $\\beta = 0$.\n\n所有计算必须基于均分原理和上面给出的 $M(x)$ 的数学形式。当不存在闭式反演时，您的程序必须数值求解这些隐式方程，确保节点保持在域 $[0,1]$ 内并按升序排序。最终的节点位置必须表示为四舍五入到八位小数的浮点数。\n\n您的程序应生成单行输出，其中包含一个由列表组成的逗号分隔列表，每个内部列表对应一个测试用例的 $N$ 个节点位置，并用方括号括起来。例如，输出格式必须与以下完全一样：\n$[ [x_{0}^{(1)}, x_{1}^{(1)}, \\dots, x_{9}^{(1)}], [x_{0}^{(2)}, \\dots, x_{9}^{(2)}], \\dots ]$\n但逗号后不带空格打印。此问题的数值域没有物理单位，所有角度（如果有）均以弧度为单位；但此处未使用角度。\n\n所有答案都必须通过数值计算得出，并以要求的格式返回，每个节点四舍五入到八位小数。程序不得读取输入；它必须在内部使用指定的测试套件并打印单行结果。", "solution": "计算流体动力学 (CFD) 中通过节点移动实现的 r-自适应原理，依赖于通过一个单调函数 $x(s)$ 将均匀的计算网格映射到物理网格，其中 $s \\in [0,1]$ 是计算坐标，$x \\in [0,1]$ 是物理坐标。均分原理指出，用于衡量解的局部特征（如梯度）的监控函数 $M(x)$，应在每个物理区间上均分。这意味着相邻节点之间 $M$ 的累积测度是相等的。\n\n设 $s_i = i/(N-1)$ 为均匀分布的计算节点（$i = 0,1,\\dots,N-1$）。均分要求可以表示为：每个物理区间接收到等量的监控函数 $M$ 的测度。定义累积监控函数\n$$\nF(x) = \\int_{0}^{x} M(\\xi)\\,\\mathrm{d}\\xi.\n$$\n均分原理可以写作如下映射关系\n$$\nF\\big(x(s)\\big) = s\\,F(1),\n$$\n这对于离散节点意味着\n$$\nF(x_i) = s_i\\,F(1) = \\frac{i}{N-1}\\,F(1), \\quad i=0,1,\\dots,N-1.\n$$\n这就提供了节点 $x_i$ 必须满足的隐式方程。将 $F(x(s)) = s\\,F(1)$ 对 $s$ 求导，得到\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}s} F\\big(x(s)\\big) = F(1) \\quad \\Rightarrow \\quad M\\big(x(s)\\big)\\,\\frac{\\mathrm{d}x}{\\mathrm{d}s} = F(1),\n$$\n这表明乘积 $M(x)\\,x_s$ 是一个常数，与监控函数在 $s$ 坐标上的均分是一致的。\n\n对于给定的 $u(x) = \\tanh\\!\\big(\\beta(x - 0.5)\\big)$，其导数为\n$$\nu_x(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\tanh\\!\\big(\\beta(x - 0.5)\\big) = \\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(x - 0.5)\\big).\n$$\n由于 $\\operatorname{sech}^2$ 是非负的，$\\lvert u_x(x) \\rvert = \\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(x - 0.5)\\big)$。因此，监控函数为\n$$\nM(x) = 1 + \\alpha\\,\\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(x - 0.5)\\big).\n$$\n我们需要累积积分 $F(x)$:\n$$\nF(x) = \\int_{0}^{x} \\left[1 + \\alpha\\,\\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(\\xi - 0.5)\\big)\\right] \\mathrm{d}\\xi\n= \\int_{0}^{x} 1\\,\\mathrm{d}\\xi + \\alpha \\int_{0}^{x} \\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(\\xi - 0.5)\\big) \\mathrm{d}\\xi.\n$$\n使用恒等式 $\\frac{\\mathrm{d}}{\\mathrm{d}\\xi} \\tanh\\!\\big(\\beta(\\xi - 0.5)\\big) = \\beta\\,\\operatorname{sech}^2\\!\\big(\\beta(\\xi - 0.5)\\big)$，积分计算为\n$$\nF(x) = x + \\alpha\\left[\\tanh\\!\\big(\\beta(x - 0.5)\\big) - \\tanh\\!\\big(\\beta(0 - 0.5)\\big)\\right]\n= x + \\alpha\\left[\\tanh\\!\\big(\\beta(x - 0.5)\\big) + \\tanh\\!\\big(\\beta/2\\big)\\right],\n$$\n因为 $\\tanh(-z) = -\\tanh(z)$。总累积测度为\n$$\nF(1) = 1 + \\alpha\\left[\\tanh\\!\\big(\\beta(1 - 0.5)\\big) - \\tanh\\!\\big(\\beta(0 - 0.5)\\big)\\right]\n= 1 + \\alpha\\left[\\tanh\\!\\big(\\beta/2\\big) - \\big(-\\tanh\\!\\big(\\beta/2\\big)\\big)\\right]\n= 1 + 2\\alpha\\,\\tanh\\!\\big(\\beta/2\\big).\n$$\n\n因此，节点的隐式方程为\n$$\nF(x_i) = \\frac{i}{N-1}\\,F(1),\n$$\n即\n$$\nx_i + \\alpha\\left[\\tanh\\!\\big(\\beta(x_i - 0.5)\\big) + \\tanh\\!\\big(\\beta/2\\big)\\right] = \\frac{i}{N-1}\\left[1 + 2\\alpha\\,\\tanh\\!\\big(\\beta/2\\big)\\right], \\quad i = 0,1,\\dots,N-1.\n$$\n该方程必须对每个 $x_i$ 求解。函数 $F(x)$ 在 $[0,1]$ 上是严格递增的，因为对于 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$，$M(x) > 0$ 成立，所以 $F$ 是可逆的。对于 $i=0$，我们有 $F(x_0) = 0$，这给出 $x_0 = 0$。对于 $i = N-1$，我们有 $F(x_{N-1}) = F(1)$，这给出 $x_{N-1} = 1$。对于内部节点 $i = 1,2,\\dots,N-2$，可以求解 $F(x_i) = \\tau_i$，其目标值为\n$$\n\\tau_i = \\frac{i}{N-1} F(1) = \\frac{i}{N-1}\\left(1 + 2\\alpha\\,\\tanh\\!\\big(\\beta/2\\big)\\right).\n$$\n由于 $F$ 是单调的，可以使用标准的数值求根方法（如二分法）在区间 $[0,1]$ 上求解 $F(x_i) - \\tau_i = 0$。对于单调函数，二分法是稳健的，并能确保解 $x_i$ 位于 $[0,1]$ 内。计算过程如下：\n1. 计算 $F(1) = 1 + 2\\alpha\\,\\tanh\\!\\big(\\beta/2\\big)$。\n2. 对每个 $i$，设置 $\\tau_i = \\frac{i}{N-1} F(1)$。\n3. 对 $i=0$ 和 $i=N-1$，直接设置 $x_0 = 0$ 和 $x_{N-1} = 1$。\n4. 对 $i=1,2,\\dots,N-2$，使用二分法在 $x \\in [0,1]$ 上求解 $F(x) - \\tau_i = 0$：\n   - 初始化 $a=0$, $b=1$，计算 $G(a) = F(a) - \\tau_i$, $G(b) = F(b) - \\tau_i$；它们符号相反或 $G(a) \\le 0 \\le G(b)$。\n   - 迭代直至收敛：$m = (a+b)/2$，计算 $G(m)$，并根据 $G(m)$ 的符号用 $m$ 替换 $a$ 或 $b$。\n   - 当区间宽度或残差低于某个容差时停止，并取 $x_i \\approx m$。\n\n该过程得到均分了监控函数 $M$ 的节点位置 $\\{x_i\\}_{i=0}^{N-1}$。对于 $N=10$ 的五个测试用例，程序计算并以指定的单行格式打印节点列表，每个节点四舍五入到八位小数。这些用例包括均匀网格（当 $\\alpha = 0$ 或 $\\beta = 0$ 时）、近似均匀网格（当 $\\alpha$ 非常小时），以及在 $x=0.5$ 附近为大 $\\beta$ 和中到大 $\\alpha$ 值设置的强分级网格，从而测试了算法的正常路径和边界行为。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cumulative_F(x: float, alpha: float, beta: float) -> float:\n    \"\"\"\n    Cumulative integral F(x) = ∫_0^x M(ξ) dξ with\n    M(x) = 1 + alpha * beta * sech^2(beta * (x - 0.5)).\n    Using analytical integration:\n    F(x) = x + alpha * [tanh(beta*(x - 0.5)) + tanh(beta/2)]\n    \"\"\"\n    return x + alpha * (np.tanh(beta * (x - 0.5)) + np.tanh(beta / 2.0))\n\ndef total_F1(alpha: float, beta: float) -> float:\n    \"\"\"\n    F(1) = ∫_0^1 M(ξ) dξ = 1 + 2*alpha*tanh(beta/2)\n    \"\"\"\n    return 1.0 + 2.0 * alpha * np.tanh(beta / 2.0)\n\ndef equidistributed_nodes(alpha: float, beta: float, N: int) -> list:\n    \"\"\"\n    Compute N nodes x_i in [0,1] that equidistribute M(x) = 1 + alpha*|u_x|,\n    with u_x = beta * sech^2(beta*(x-0.5)).\n    Nodes satisfy F(x_i) = (i/(N-1)) * F(1), with F cumulative monitor.\n    Uses bisection to invert F for interior nodes. Returns list of floats.\n    \"\"\"\n    # Ensure parameters are nonnegative to keep M positive\n    if alpha < 0 or beta < 0:\n        raise ValueError(\"alpha and beta must be nonnegative.\")\n\n    nodes = [0.0] * N\n    F1 = total_F1(alpha, beta)\n\n    # Endpoints\n    nodes[0] = 0.0\n    nodes[-1] = 1.0\n\n    # Tolerance settings for bisection\n    tol = 1e-12\n    max_iter = 200\n\n    # Compute interior nodes\n    for i in range(1, N - 1):\n        tau_i = (i / (N - 1)) * F1\n\n        # Bisection bracket [a,b] = [0,1]\n        a, b = 0.0, 1.0\n        Fa = cumulative_F(a, alpha, beta) - tau_i\n        Fb = cumulative_F(b, alpha, beta) - tau_i\n\n        # Handle trivial cases if tau_i is at endpoints due to numerical round-off\n        if abs(Fa) < tol:\n            nodes[i] = a\n            continue\n        if abs(Fb) < tol:\n            nodes[i] = b\n            continue\n\n        # Ensure valid bracket: Fa <= 0 <= Fb\n        # Due to monotonicity of F, this should hold.\n        # If not, adjust slightly (robustness).\n        if Fa > 0 and Fb > 0:\n            # Both positive: move a left slightly (not possible in [0,1]); fallback to a\n            nodes[i] = a\n            continue\n        if Fa < 0 and Fb < 0:\n            # Both negative: move b right slightly (not possible); fallback to b\n            nodes[i] = b\n            continue\n\n        # Bisection loop\n        for _ in range(max_iter):\n            m = 0.5 * (a + b)\n            Fm = cumulative_F(m, alpha, beta) - tau_i\n\n            # Check convergence\n            if abs(Fm) < tol or (b - a) < tol:\n                nodes[i] = m\n                break\n\n            # Update bracket\n            if Fm < 0:\n                a = m\n                Fa = Fm\n            else:\n                b = m\n                Fb = Fm\n        else:\n            # If max_iter exhausted, take midpoint\n            nodes[i] = 0.5 * (a + b)\n\n    return nodes\n\ndef format_nested_lists(nested_lists, decimals=8):\n    \"\"\"\n    Format a list of lists of floats into a single-line string with:\n    - Outer brackets and inner brackets preserved\n    - Commas with no spaces\n    - Floats rounded to the specified number of decimals\n    Example: [[0.0,0.1],[0.2,0.3]]\n    \"\"\"\n    def fmt_float(x):\n        # Round and format ensuring fixed decimal places\n        return f\"{round(x, decimals):.{decimals}f}\"\n    inner_strs = []\n    for lst in nested_lists:\n        nums = [fmt_float(v) for v in lst]\n        inner = \"[\" + \",\".join(nums) + \"]\"\n        inner_strs.append(inner)\n    return \"[\" + \",\".join(inner_strs) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (alpha, beta, N)\n    test_cases = [\n        (0.0, 5.0, 10),         # Uniform due to alpha=0\n        (2.0, 10.0, 10),        # Strong clustering near x=0.5\n        (5.0, 50.0, 10),        # Extreme clustering near x=0.5\n        (1e-6, 20.0, 10),       # Nearly uniform\n        (3.0, 0.0, 10),         # Uniform due to beta=0\n    ]\n\n    results = []\n    for alpha, beta, N in test_cases:\n        nodes = equidistributed_nodes(alpha, beta, N)\n        results.append(nodes)\n\n    # Final print statement in the exact required format.\n    print(format_nested_lists(results, decimals=8))\n\nsolve()\n```", "id": "3355747"}, {"introduction": "实现节点移动的一种有效方法是将网格视为一个伪弹性固体，通过改变材料的刚度来控制节点的聚集程度。本练习通过解析求解简化一维域中的节点位移，来探索这种弹性类比。这将阐明如何设计空间变化的拉梅参数（Lamé parameters）以实现期望的网格自适应效果。[@problem_id:3355764]", "problem": "考虑一个计算流体动力学（CFD）中的网格运动问题，该问题采用伪固体线性弹性方法，通过节点移动进行$r$-自适应。计算域为单位正方形 $\\Omega = [0,1] \\times [0,1]$，其笛卡尔坐标为 $(x,y)$。该网格被建模为一个处于平面应变状态下的均匀、各向同性的线性弹性固体，其空间变化的拉梅参数 $\\lambda(x)$ 和 $\\mu(x)$ 由下式给出\n$$\n\\mu(x) = \\mu_{0} \\left(1 + \\alpha x \\right), \\quad \\lambda(x) = \\kappa \\, \\mu(x),\n$$\n其中 $\\mu_{0} > 0$，$\\alpha > -1$ 和 $\\kappa > 0$ 是常数。\n\n不存在体力，左边界在 $x$ 方向上发生均匀位移，该位移是一个在 $y$ 方向上为常数的已知函数：\n$$\nu_{x}(0,y) = U_{0}, \\quad u_{y}(0,y) = 0,\n$$\n其中 $U_{0} > 0$ 为常数。右边界是固定的：\n$$\nu_{x}(1,y) = 0, \\quad u_{y}(1,y) = 0,\n$$\n上下边界被约束为没有垂直运动：\n$$\nu_{y}(x,0) = 0, \\quad u_{y}(x,1) = 0.\n$$\n假设一个与这些边界条件和对称性一致的一维简化，即 $u_{x}(x,y) = u(x)$（与 $y$ 无关）且 $u_{y}(x,y) = 0$。\n\n从线性弹性的静态平衡基本方程和相应的本构关系出发，推导关于 $u(x)$ 的常微分方程，并对其进行解析求解，以获得在 $x \\in [0,1]$ 上的内部节点位移剖面 $u(x)$ 的闭式表达式。以 $u(x)$ 的单一闭式解析表达式的形式给出最终答案。\n\n此外，简要描述当 $\\alpha > 0$ 时，位移剖面如何作为 $x$ 的函数定性地分布内部节点的移动，并评述当 $\\alpha \\to 0^{+}$ 时您表达式的极限行为。\n\n你的最终答案必须是 $u(x)$ 的单一闭式解析表达式（无需单位）。无需进行四舍五入。", "solution": "首先对问题进行验证，以确保其在科学上是合理的、自洽的和适定的。\n\n**步骤 1：提取已知条件**\n- **域：** $\\Omega = [0,1] \\times [0,1]$，笛卡尔坐标为 $(x,y)$。\n- **模型：** 处于平面应变状态的均匀、各向同性的线性弹性固体。\n- **拉梅参数：** $\\mu(x) = \\mu_{0} \\left(1 + \\alpha x \\right)$ 和 $\\lambda(x) = \\kappa \\, \\mu(x)$，其中常数 $\\mu_{0} > 0$，$\\alpha > -1$，且 $\\kappa > 0$。\n- **力：** 无体力。\n- **边界条件：**\n    - 左侧 ($x=0$)：$u_{x}(0,y) = U_{0}$ (常数 $U_0 > 0$), $u_{y}(0,y) = 0$。\n    - 右侧 ($x=1$)：$u_{x}(1,y) = 0$, $u_{y}(1,y) = 0$。\n    - 底部 ($y=0$)：$u_{y}(x,0) = 0$。\n    - 顶部 ($y=1$)：$u_{y}(x,1) = 0$。\n- **简化假设：** 一维位移场 $u_{x}(x,y) = u(x)$ 和 $u_{y}(x,y)=0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题基于成熟的线性弹性理论，这是一种CFD中用于r-自适应网格加密的标准方法。所提供的拉梅参数在物理上是可接受的，因为对于 $x \\in [0,1]$，条件 $\\alpha > -1$ 保证了 $\\mu(x) = \\mu_0(1+\\alpha x) > 0$。一维位移场 $u_x(x,y) = u(x)$ 和 $u_y(x,y)=0$ 的假设与给定边界条件下的完整二维平面应变平衡方程是一致的，因为它恒等地满足 $y$ 方向的平衡方程，并将 $x$ 方向的方程简化为一个定义明确的常微分方程。边界条件足以确定该常微分方程的唯一解。因此，该问题是有科学依据的、适定的和客观的。\n\n**步骤 3：结论与行动**\n该问题是有效的。将推导详细的解。\n\n在没有体力的情况下，静态平衡的控制方程由柯西应力张量 $\\boldsymbol{\\sigma}$ 的散度为零给出：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}\n$$\n对于均匀、各向同性的线性弹性材料，应力张量通过本构关系（胡克定律）与应变张量 $\\boldsymbol{\\varepsilon}$ 相关联：\n$$\n\\boldsymbol{\\sigma} = \\lambda (\\text{tr}(\\boldsymbol{\\varepsilon})) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}\n$$\n其中 $\\mathbf{u} = (u_x, u_y)$ 是位移向量，$\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$ 是无穷小应变张量，$\\mathbf{I}$ 是单位张量，$\\lambda$ 和 $\\mu$ 是拉梅参数。\n\n我们应用位移场是一维的简化假设：$u_{x}(x,y) = u(x)$ 和 $u_{y}(x,y) = 0$。应变张量的分量为：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{du}{dx} = u'(x)\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = 0\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}(0 + 0) = 0\n$$\n问题被指定为平面应变问题，其应力张量的面内分量为：\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx} + \\lambda \\varepsilon_{yy} = (\\lambda(x) + 2\\mu(x)) u'(x)\n$$\n$$\n\\sigma_{yy} = \\lambda \\varepsilon_{xx} + (\\lambda + 2\\mu) \\varepsilon_{yy} = \\lambda(x) u'(x)\n$$\n$$\n\\sigma_{xy} = 2\\mu \\varepsilon_{xy} = 0\n$$\n笛卡尔坐标系中的静态平衡方程为：\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} = 0\n$$\n代入应力分量后，第二个方程恒等地得到满足：\n$$\n\\frac{\\partial (0)}{\\partial x} + \\frac{\\partial}{\\partial y} [\\lambda(x) u'(x)] = 0 + 0 = 0\n$$\n第一个方程得到关于 $u(x)$ 的控制常微分方程 (ODE)：\n$$\n\\frac{d}{dx} \\left[ (\\lambda(x) + 2\\mu(x)) u'(x) \\right] + \\frac{\\partial (0)}{\\partial y} = 0\n$$\n$$\n\\frac{d}{dx} \\left[ (\\lambda(x) + 2\\mu(x)) u'(x) \\right] = 0\n$$\n将此方程对 $x$ 积分一次，得到：\n$$\n(\\lambda(x) + 2\\mu(x)) u'(x) = C_1\n$$\n其中 $C_1$ 是一个积分常数。我们已知空间变化的拉梅参数为：\n$$\n\\mu(x) = \\mu_{0} (1 + \\alpha x), \\quad \\lambda(x) = \\kappa \\mu(x) = \\kappa \\mu_{0} (1 + \\alpha x)\n$$\n将这些参数代入积分后的方程中：\n$$\n(\\kappa \\mu_0 (1 + \\alpha x) + 2\\mu_0 (1 + \\alpha x)) u'(x) = C_1\n$$\n$$\n(\\kappa + 2) \\mu_0 (1 + \\alpha x) u'(x) = C_1\n$$\n求解 $u'(x)$：\n$$\nu'(x) = \\frac{C_1}{(\\kappa + 2) \\mu_0 (1 + \\alpha x)}\n$$\n为了求得 $u(x)$，我们对 $x$ 进行积分。我们必须考虑 $\\alpha \\neq 0$ 和 $\\alpha = 0$ 的情况。问题要求解以及当 $\\alpha \\to 0^+$ 时的极限，因此我们先处理 $\\alpha \\neq 0$ 的情况。\n$$\nu(x) = \\int \\frac{C_1}{(\\kappa + 2) \\mu_0 (1 + \\alpha x)} \\, dx\n$$\n$$\nu(x) = \\frac{C_1}{(\\kappa + 2) \\mu_0} \\int \\frac{1}{1 + \\alpha x} \\, dx\n$$\n积分为 $\\frac{1}{\\alpha}\\ln(1 + \\alpha x)$，因为对于 $x \\in [0,1]$ 和 $\\alpha > -1$，对数的参数总是正的。\n$$\nu(x) = \\frac{C_1}{\\alpha (\\kappa + 2) \\mu_0} \\ln(1 + \\alpha x) + C_2\n$$\n其中 $C_2$ 是第二个积分常数。我们将对数前面的常数组合成一个单一常数 $A = \\frac{C_1}{\\alpha (\\kappa + 2) \\mu_0}$。\n$$\nu(x) = A \\ln(1 + \\alpha x) + C_2\n$$\n现在我们应用边界条件来确定 $A$ 和 $C_2$。\n位移场 $u(x)$ 的边界条件是：\n$$\nu(0) = U_0, \\quad u(1) = 0\n$$\n在 $x=0$ 处应用第一个条件：\n$$\nu(0) = A \\ln(1 + \\alpha \\cdot 0) + C_2 = A \\ln(1) + C_2 = 0 + C_2 = U_0\n$$\n这得到 $C_2 = U_0$。\n在 $x=1$ 处应用第二个条件：\n$$\nu(1) = A \\ln(1 + \\alpha) + C_2 = A \\ln(1 + \\alpha) + U_0 = 0\n$$\n求解 $A$（对于 $\\alpha \\neq 0$）：\n$$\nA = -\\frac{U_0}{\\ln(1 + \\alpha)}\n$$\n将常数 $A$ 和 $C_2$ 代回 $u(x)$ 的表达式中：\n$$\nu(x) = -\\frac{U_0}{\\ln(1 + \\alpha)} \\ln(1 + \\alpha x) + U_0\n$$\n提出公因子 $U_0$ 得到位移剖面的最终闭式表达式：\n$$\nu(x) = U_0 \\left( 1 - \\frac{\\ln(1 + \\alpha x)}{\\ln(1 + \\alpha)} \\right)\n$$\n对于 $\\alpha > 0$，刚度与 $(1 + \\alpha x)$ 成正比，从左到右增加。应变 $u'(x) = -\\frac{U_0 \\alpha}{\\ln(1+\\alpha)}\\frac{1}{1+\\alpha x}$，在 $x=0$ 处其绝对值最大，在 $x=1$ 处最小。这意味着材料在更“软”（刚度更低）的地方被压缩得更多。对于网格运动，初始节点间距 $\\Delta X$ 变形为新的间距 $\\Delta x \\approx \\Delta X (1 + u'(x))$。由于 $u'(x)$ 是负的，并且其绝对值在 $x=0$ 处最大，因此节点间距将在 $x=0$ 处最小。因此，对于 $\\alpha > 0$，网格节点将在左边界（$x=0$）附近聚集，并向右边界（$x=1$）方向逐渐变得更加分散，这是一种在指定刚度较低的区域提高分辨率的常用策略。\n\n为了分析当 $\\alpha \\to 0^+$ 时的极限行为，我们计算解中分数部分的极限。这是一个 $0/0$ 的不定型：\n$$\n\\lim_{\\alpha \\to 0^+} \\frac{\\ln(1 + \\alpha x)}{\\ln(1 + \\alpha)}\n$$\n使用洛必达法则，我们对分子和分母关于 $\\alpha$ 求导：\n$$\n\\lim_{\\alpha \\to 0^+} \\frac{\\frac{d}{d\\alpha} \\ln(1 + \\alpha x)}{\\frac{d}{d\\alpha} \\ln(1 + \\alpha)} = \\lim_{\\alpha \\to 0^+} \\frac{\\frac{x}{1 + \\alpha x}}{\\frac{1}{1 + \\alpha}} = \\frac{x/1}{1/1} = x\n$$\n因此，极限情况下的位移剖面是：\n$$\n\\lim_{\\alpha \\to 0^+} u(x) = U_0 (1 - x)\n$$\n这是一个线性位移剖面，对应于均匀应变。这个结果是正确的，因为 $\\alpha = 0$ 对应于常数拉梅参数，这导致在给定边界条件下的常微分方程为 $u''(x)=0$，其解确实是 $u(x) = U_0(1-x)$。", "answer": "$$\n\\boxed{U_0 \\left( 1 - \\frac{\\ln(1+\\alpha x)}{\\ln(1+\\alpha)} \\right)}\n$$", "id": "3355764"}, {"introduction": "r-refinement中的一个关键挑战是确保节点移动不会导致单元缠绕或翻转，从而使网格失效。在数学上，通过为所有单元维持一个正的雅可比行列式（Jacobian determinant）可以保证网格的有效性。本实践将指导您推导出一个关于节点移动步长的充分条件，以防止单元翻转，这是开发稳健网格运动算法的基本概念。[@problem_id:3355703]", "problem": "在计算流体动力学 (CFD) 中，通过节点移动实现的$r$-refinement必须保持网格的有效性，其定义为每个单元的局部雅可比行列式 $J_e$ 均为正值。考虑一个二维三角形有限元，其顶点位于 $\\mathbb{R}^2$ 中的 $\\mathbf{x}_1, \\mathbf{x}_2$ 和 $\\mathbf{x}_3$ 位置，并考虑一个从参考三角形出发的线性等参映射。该映射由雅可比矩阵 $\\mathbf{F} = \\nabla_{\\boldsymbol{\\xi}} \\mathbf{x}(\\boldsymbol{\\xi})$ 及其行列式 $J_e = \\det(\\mathbf{F})$ 表征，对于线性形函数，该行列式在整个单元上为常数。有效性的有向面积准则要求 $J_e > 0$，这等价于单元具有正的有向面积并保持其方向。\n\n假设单元节点根据 $\\mathbf{x}_i(\\alpha) = \\mathbf{x}_i + \\alpha \\mathbf{w}_i$ 移动，其中 $\\alpha \\ge 0$ 是一个无量纲步长，$\\mathbf{w}_i$ 是与 $r$ 网格细化相关的给定节点速度。从线性三角形单元的雅可比行列式的基本定义和有向面积公式出发，推导一个关于节点移动的充分条件，该条件以 $\\alpha$ 的保守界限形式给出，并保证更新后单元的 $J_e(\\alpha) > 0$。\n\n然后，对于节点为\n$\\mathbf{x}_1 = (0, 0)$、$\\mathbf{x}_2 = (1, 0)$ 和 $\\mathbf{x}_3 = (0.3, 0.8)$，\n以及节点速度为\n$\\mathbf{w}_1 = (0, 0)$、$\\mathbf{w}_2 = (0.4, -0.6)$ 和 $\\mathbf{w}_3 = (-0.1, -0.1)$\n的特定三角形，根据你推导的充分条件，计算保证 $J_e(\\alpha) > 0$ 的最大保守界限 $\\alpha_{\\max}$。将最终的 $\\alpha_{\\max}$ 值四舍五入至四位有效数字。将最终答案表示为无量纲量。", "solution": "如果二维线性三角形单元的有向面积保持为正，则其有效性得以维持。对于线性等参映射，雅可比行列式 $J_e$ 在整个单元上为常数，并且与该有向面积成正比。我们可以将 $J_e$ 表示为由从一个公共顶点出发的两个三角形边向量所构成矩阵的行列式。设顶点为 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3$。我们定义边向量 $\\mathbf{e}_{12} = \\mathbf{x}_2 - \\mathbf{x}_1$ 和 $\\mathbf{e}_{13} = \\mathbf{x}_3 - \\mathbf{x}_1$。雅可比行列式则由下式给出：\n$$J_e = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13})$$\n其中 $\\mathbf{e}_{12}$ 和 $\\mathbf{e}_{13}$ 被视为列向量。网格有效性准则是 $J_e > 0$。\n\n节点位置根据规则 $\\mathbf{x}_i(\\alpha) = \\mathbf{x}_i + \\alpha \\mathbf{w}_i$ 进行更新，其中步长 $\\alpha \\ge 0$ 为非负数。作为 $\\alpha$ 的函数，新的边向量为：\n$$ \\mathbf{e}_{12}(\\alpha) = \\mathbf{x}_2(\\alpha) - \\mathbf{x}_1(\\alpha) = (\\mathbf{x}_2 + \\alpha \\mathbf{w}_2) - (\\mathbf{x}_1 + \\alpha \\mathbf{w}_1) = (\\mathbf{x}_2 - \\mathbf{x}_1) + \\alpha (\\mathbf{w}_2 - \\mathbf{w}_1) = \\mathbf{e}_{12} + \\alpha \\Delta\\mathbf{w}_{12} $$\n$$ \\mathbf{e}_{13}(\\alpha) = \\mathbf{x}_3(\\alpha) - \\mathbf{x}_1(\\alpha) = (\\mathbf{x}_3 + \\alpha \\mathbf{w}_3) - (\\mathbf{x}_1 + \\alpha \\mathbf{w}_1) = (\\mathbf{x}_3 - \\mathbf{x}_1) + \\alpha (\\mathbf{w}_3 - \\mathbf{w}_1) = \\mathbf{e}_{13} + \\alpha \\Delta\\mathbf{w}_{13} $$\n其中 $\\Delta\\mathbf{w}_{ij} = \\mathbf{w}_j - \\mathbf{w}_i$。\n\n更新后单元的雅可比行列式 $J_e(\\alpha)$ 为：\n$$ J_e(\\alpha) = \\det(\\mathbf{e}_{12}(\\alpha), \\mathbf{e}_{13}(\\alpha)) = \\det(\\mathbf{e}_{12} + \\alpha \\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13} + \\alpha \\Delta\\mathbf{w}_{13}) $$\n利用行列式的双线性性质，我们可以展开这个表达式：\n$$ J_e(\\alpha) = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) + \\alpha \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\alpha \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) + \\alpha^2 \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) $$\n这表明 $J_e(\\alpha)$ 是一个关于 $\\alpha$ 的二次多项式：\n$$ J_e(\\alpha) = A_2 \\alpha^2 + A_1 \\alpha + A_0 $$\n其中系数为：\n$$ A_0 = J_e(0) = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) $$\n$$ A_1 = \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) $$\n$$ A_2 = \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) $$\n对于一个初始有效的单元，$A_0 > 0$。我们需要找到一个能保证 $J_e(\\alpha) > 0$ 的 $\\alpha$ 界限。这等价于确保雅可比行列式的变化量 $\\Delta J_e(\\alpha) = J_e(\\alpha) - J_e(0) = A_1 \\alpha + A_2 \\alpha^2$ 不会变得过负：\n$$ A_1 \\alpha + A_2 \\alpha^2 > -A_0 $$\n为了导出一个总是保守的充分条件，我们可以对变化量的量级进行限制。一个稳健的充分条件是要求变化量的绝对值小于初始值 $A_0$：\n$$ |\\Delta J_e(\\alpha)| < A_0 \\implies |A_1 \\alpha + A_2 \\alpha^2| < A_0 $$\n对左侧使用三角不等式，可以得到一个更严格，因此也更保守的条件：\n$$ |A_1 \\alpha + A_2 \\alpha^2| \\le |A_1|\\alpha + |A_2|\\alpha^2 $$\n因此，我们强制执行以下充分条件：\n$$ |A_1|\\alpha + |A_2|\\alpha^2 < A_0 $$\n这个不等式为 $\\alpha$ 定义了一个保守范围。在此条件下，允许的最大步长 $\\alpha_{\\max}$ 是以下二次方程的正根：\n$$ |A_2|\\alpha^2 + |A_1|\\alpha - A_0 = 0 $$\n使用求根公式求解 $\\alpha > 0$ 可得：\n$$ \\alpha_{\\max} = \\frac{-|A_1| + \\sqrt{|A_1|^2 - 4(|A_2|)(-A_0)}}{2|A_2|} = \\frac{-|A_1| + \\sqrt{A_1^2 + 4|A_2|A_0}}{2|A_2|} $$\n这就是 $\\alpha$ 的保守界限的通用表达式。\n\n现在，我们将此应用于给定的具体情况。\n初始节点位置为 $\\mathbf{x}_1 = (0, 0)$、$\\mathbf{x}_2 = (1, 0)$ 和 $\\mathbf{x}_3 = (0.3, 0.8)$。\n节点速度为 $\\mathbf{w}_1 = (0, 0)$、$\\mathbf{w}_2 = (0.4, -0.6)$ 和 $\\mathbf{w}_3 = (-0.1, -0.1)$。\n\n首先，我们计算初始边向量和速度差向量：\n$$ \\mathbf{e}_{12} = \\mathbf{x}_2 - \\mathbf{x}_1 = (1, 0) - (0, 0) = (1, 0) $$\n$$ \\mathbf{e}_{13} = \\mathbf{x}_3 - \\mathbf{x}_1 = (0.3, 0.8) - (0, 0) = (0.3, 0.8) $$\n$$ \\Delta\\mathbf{w}_{12} = \\mathbf{w}_2 - \\mathbf{w}_1 = (0.4, -0.6) - (0, 0) = (0.4, -0.6) $$\n$$ \\Delta\\mathbf{w}_{13} = \\mathbf{w}_3 - \\mathbf{w}_1 = (-0.1, -0.1) - (0, 0) = (-0.1, -0.1) $$\n接下来，我们使用二维行列式公式 $\\det((u_x, u_y), (v_x, v_y)) = u_x v_y - u_y v_x$ 计算系数 $A_0$、$A_1$ 和 $A_2$。\n$$ A_0 = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) = \\det\\begin{pmatrix} 1 & 0.3 \\\\ 0 & 0.8 \\end{pmatrix} = (1)(0.8) - (0)(0.3) = 0.8 $$\n由于 $A_0 > 0$，初始单元是有效的。\n$$ A_1 = \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) $$\n$$ \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) = \\det\\begin{pmatrix} 1 & -0.1 \\\\ 0 & -0.1 \\end{pmatrix} = (1)(-0.1) - (0)(-0.1) = -0.1 $$\n$$ \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) = \\det\\begin{pmatrix} 0.4 & 0.3 \\\\ -0.6 & 0.8 \\end{pmatrix} = (0.4)(0.8) - (-0.6)(0.3) = 0.32 + 0.18 = 0.5 $$\n$$ A_1 = -0.1 + 0.5 = 0.4 $$\n$$ A_2 = \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) = \\det\\begin{pmatrix} 0.4 & -0.1 \\\\ -0.6 & -0.1 \\end{pmatrix} = (0.4)(-0.1) - (-0.6)(-0.1) = -0.04 - 0.06 = -0.1 $$\n我们得到值 $A_0 = 0.8$、$A_1 = 0.4$ 和 $A_2 = -0.1$。\n现在我们为充分条件求它们的绝对值：$|A_1| = 0.4$ 和 $|A_2| = 0.1$。\n我们必须求解方程 $|A_2|\\alpha^2 + |A_1|\\alpha - A_0 = 0$：\n$$ 0.1\\alpha^2 + 0.4\\alpha - 0.8 = 0 $$\n为简化计算，两边乘以 $10$：\n$$ \\alpha^2 + 4\\alpha - 8 = 0 $$\n正根给出了 $\\alpha_{\\max}$：\n$$ \\alpha_{\\max} = \\frac{-4 + \\sqrt{4^2 - 4(1)(-8)}}{2(1)} = \\frac{-4 + \\sqrt{16 + 32}}{2} = \\frac{-4 + \\sqrt{48}}{2} $$\n化简平方根：$\\sqrt{48} = \\sqrt{16 \\times 3} = 4\\sqrt{3}$。\n$$ \\alpha_{\\max} = \\frac{-4 + 4\\sqrt{3}}{2} = -2 + 2\\sqrt{3} = 2(\\sqrt{3} - 1) $$\n为了获得数值，我们使用 $\\sqrt{3} \\approx 1.7320508...$：\n$$ \\alpha_{\\max} = 2(1.7320508... - 1) = 2(0.7320508...) = 1.4641016... $$\n四舍五入到四位有效数字，我们得到 $\\alpha_{\\max} = 1.464$。", "answer": "$$\\boxed{1.464}$$", "id": "3355703"}]}