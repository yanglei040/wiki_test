{"hands_on_practices": [{"introduction": "代数多重网格（AMG）方法的核心优势在于其能够自动“感知”问题中的强耦合方向并相应地构建粗化策略。这一过程始于定义节点间的“连接强度”。本练习 [@problem_id:3290884] 将引导你探索经典的 Ruge-Stüben 强度准则，分析阈值参数 $\\theta$ 如何根据问题的各向异性来调整连接强度图，从而决定粗化方向。", "problem": "在用于计算流体力学 (CFD) 的经典代数多重网格 (AMG) 预处理中，考虑由常系数偏微分方程 $-\\nabla \\cdot \\left(K \\nabla u\\right) = f$ 产生的离散各向异性扩散算子。该算子作用于一个在两个方向上间距均为 $h$ 的均匀笛卡尔网格上，其中 $K = \\mathrm{diag}(a_{x}, a_{y})$，各向异性比定义为 $\\alpha = a_{x}/a_{y} \\geq 1$。使用标准的 $5$ 点有限差分格式，内部节点的矩阵行具有正的对角线元素和连接到 $4$ 个直接邻居的负的非对角线耦合。在代数多重网格 (AMG) 的经典 Ruge–Stüben 连接强度定义中，如果 $-a_{ij} \\geq \\theta \\max_{k \\neq i} \\left(-a_{ik}\\right)$（对于阈值 $\\theta \\in (0,1)$）成立，则邻居 $j$ 是节点 $i$ 的强邻居。\n\n从这些定义和各向异性扩散算子的均匀网格 $5$ 点离散化出发，通过确定一个通用内部节点的四个邻居中哪些是强邻居（作为 $\\theta$ 和 $\\alpha$ 的函数），来构建该节点的强度图。然后，定性分析粗/细 (CF) 分割（粗点与细点）和所导致的粗化方向如何依赖于仅水平耦合是强的，还是水平和垂直耦合都是强的。\n\n作为最终答案，提供临界阈值 $\\theta_{c}(\\alpha)$ 的解析简化表达式，在该阈值下，强度图从有四个强邻居变为只有两个水平邻居被标记为强。不需要进行数值评估，也不需要四舍五入。最终答案必须是单一的封闭形式表达式。", "solution": "我们从均匀网格上的常系数各向异性扩散算子开始\n$$\n-\\frac{\\partial}{\\partial x}\\left(a_{x}\\frac{\\partial u}{\\partial x}\\right) \\;-\\; \\frac{\\partial}{\\partial y}\\left(a_{y}\\frac{\\partial u}{\\partial y}\\right) \\;=\\; f,\n$$\n其中 $a_{x} > 0$，$a_{y} > 0$，且各向异性比为 $\\alpha = a_{x}/a_{y} \\geq 1$。在两个方向上间距均为 $h$ 的均匀网格上，标准的 $5$ 点有限差分离散化在内部节点 $i$ 处给出与最近邻居相关的以下 $4$ 个非对角线系数：\n- 左侧和右侧（水平）邻居：$a_{i,i\\pm \\hat{x}} = -\\frac{a_{x}}{h^{2}}$，\n- 底部和顶部（垂直）邻居：$a_{i,i\\pm \\hat{y}} = -\\frac{a_{y}}{h^{2}}$，\n以及一个正的对角线元素 $a_{ii} = \\frac{2(a_{x} + a_{y})}{h^{2}}$。\n\n根据 Ruge–Stüben 连接强度定义，如果\n$$\n-a_{ij} \\;\\geq\\; \\theta \\max_{k \\neq i} \\left(-a_{ik}\\right), \\qquad \\theta \\in (0,1),\n$$\n则邻居 $j$ 是节点 $i$ 的强邻居。\n因为该矩阵来自具有负非对角线元素的 $M$-矩阵离散化，所以 $-a_{ij}$ 是从 $i$ 到 $j$ 的耦合强度的大小。对于 $5$ 点格式，节点 $i$ 处非对角线元素的大小集合为\n$$\n\\left\\{ \\frac{a_{x}}{h^{2}}, \\frac{a_{x}}{h^{2}}, \\frac{a_{y}}{h^{2}}, \\frac{a_{y}}{h^{2}} \\right\\}.\n$$\n由于 $\\alpha = a_{x}/a_{y} \\geq 1$，我们有 $a_{x} \\geq a_{y}$，因此\n$$\n\\max_{k \\neq i} \\left(-a_{ik}\\right) \\;=\\; \\frac{a_{x}}{h^{2}}.\n$$\n\n我们现在为每种邻居类型测试强度条件。\n\n水平邻居：对于 $j = i \\pm \\hat{x}$，\n$$\n-a_{ij} \\;=\\; \\frac{a_{x}}{h^{2}} \\;\\geq\\; \\theta \\cdot \\frac{a_{x}}{h^{2}} \\quad \\Longleftrightarrow \\quad 1 \\;\\geq\\; \\theta.\n$$\n因为 $\\theta \\in (0,1)$，这个不等式总是成立。因此，对于任何允许的 $\\theta$，两个水平邻居总是被标记为强邻居。\n\n垂直邻居：对于 $j = i \\pm \\hat{y}$，\n$$\n-a_{ij} \\;=\\; \\frac{a_{y}}{h^{2}} \\;\\geq\\; \\theta \\cdot \\frac{a_{x}}{h^{2}} \\quad \\Longleftrightarrow \\quad \\theta \\;\\leq\\; \\frac{a_{y}}{a_{x}} \\;=\\; \\frac{1}{\\alpha}.\n$$\n因此，当且仅当 $\\theta \\leq 1/\\alpha$ 时，垂直邻居被标记为强邻居。\n\n从这两种情况来看，一个通用内部节点的强度图对 $\\theta$ 有如下依赖关系：\n- 如果 $\\theta \\leq \\frac{1}{\\alpha}$，那么所有四个邻居（左、右、下、上）都是强邻居。\n- 如果 $\\theta > \\frac{1}{\\alpha}$，那么只有两个水平邻居（左和右）是强邻居。\n\n因此，区分这两种情况的临界阈值是\n$$\n\\theta_{c}(\\alpha) \\;=\\; \\frac{1}{\\alpha}.\n$$\n\n粗/细 (CF) 分割和粗化方向的含义源自强度图的结构。在经典 AMG 中，CF 分割必须确保每个细 (F) 点在其强连接中有足够的粗 (C) 邻居，以支持精确的插值。当 $\\theta > 1/\\alpha$ 时，只有水平耦合是强的，因此强度图分解为几乎独立的水平链。然后 CF 分割沿 $x$ 方向逐行确定，粗化主要沿着这些水平链进行，从而有效地生成在 $x$ 方向上更粗、而在 $y$ 方向上保持相对较细的网格。相比之下，当 $\\theta \\leq 1/\\alpha$ 时，所有四个耦合都是强的，产生一个更各向同性的强度图；CF 分割可以在两个方向上分布 C 点，所导致的粗化更接近各向同性。\n\n由于问题要求临界阈值的封闭形式表达式，我们报告\n$$\n\\theta_{c}(\\alpha) \\;=\\; \\frac{1}{\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\alpha}}$$", "id": "3290884"}, {"introduction": "在确定了粗细网格点之后，我们需要建立在这些层级之间传递信息的机制，即“转移算子”。本练习 [@problem_id:3290960] 将具体展示如何为一个简单的模型问题构建 prolongation（插值）算子 $P$ 和 restriction（限制）算子 $R$。通过计算伽辽金乘积 $A_c = RAP$，你将亲手构造出粗网格算子，并理解其谱特性与细网格算子的关系，这是保证多重网格收敛性的关键。", "problem": "考虑计算流体动力学 (CFD) 中的一维压力泊松方程 $- \\partial_{x}^{2} p = f$，该方程定义在单位区间上，两端均为齐次狄利克雷边界条件。使用二阶中心差分近似，在具有 $3$ 个内部未知数和无量纲间距 $h = 1$ 的均匀细网格上对该方程进行离散化。这将产生一个对称正定 (SPD) 的细网格算子 $A \\in \\mathbb{R}^{3 \\times 3}$，即标准的三对角离散拉普拉斯算子。在代数多重网格 (AMG) 的背景下，定义一个由与细网格点 $1$ 和 $3$ 对齐的 $2$ 个粗网格点组成的粗网格，并通过线性插值构造一个延拓算子 $P \\in \\mathbb{R}^{3 \\times 2}$，该算子通过 $u_{f}^{1} = u_{C}^{1}$，$u_{f}^{2} = \\frac{1}{2} u_{C}^{1} + \\frac{1}{2} u_{C}^{2}$ 和 $u_{f}^{3} = u_{C}^{2}$ 将粗网格未知数 $\\begin{pmatrix} u_{C}^{1} \\\\ u_{C}^{2} \\end{pmatrix}$ 映射到细网格未知数 $\\begin{pmatrix} u_{f}^{1} \\\\ u_{f}^{2} \\\\ u_{f}^{3} \\end{pmatrix}$。使用对称 Galerkin 选择来定义限制算子 $R = P^{\\top}$。从有限差分离散和离散拉普拉斯算子的 SPD 性质出发，显式地构造 $R$ 和 $P$，计算粗网格算子 $A_{c} = R A P$，并确定 $A$ 和 $A_{c}$ 的谱（特征值集合）。然后，使用 SPD 矩阵的 Ritz 值的基本原理，验证粗网格特征值与细网格特征值交错。作为最终报告结果，请提供 $A_{c}$ 的两个粗网格特征值的精确值。无需四舍五入；由于 $h = 1$，答案是无量纲的。", "solution": "一维压力泊松方程为 $- \\partial_{x}^{2} p = f$，带有齐次狄利克雷边界条件。使用二阶中心差分格式 $\\frac{-p_{i-1} + 2p_i - p_{i+1}}{h^2}$，在具有 $N=3$ 个内部点和无量纲网格间距 $h=1$ 的均匀网格上离散化该方程，得到线性系统 $A\\mathbf{p} = \\mathbf{f}$。矩阵 $A$ 是 $3 \\times 3$ 的离散拉普拉斯算子。给定 $p_0=0$ 和 $p_4=0$，细网格算子 $A$ 为：\n$$\nA = \\begin{pmatrix} 2  & -1 & 0 \\\\ -1 & 2  & -1 \\\\ 0  & -1 & 2 \\end{pmatrix}\n$$\n该矩阵是对称的，并且从其特征值可以看出，它是正定的。\n\n问题定义了一个延拓（插值）算子 $P \\in \\mathbb{R}^{3 \\times 2}$，它将一个包含 $2$ 个未知数的粗网格向量 $u_C = \\begin{pmatrix} u_C^1 \\\\ u_C^2 \\end{pmatrix}$ 映射到一个包含 $3$ 个未知数的细网格向量 $u_f = \\begin{pmatrix} u_f^1 \\\\ u_f^2 \\\\ u_f^3 \\end{pmatrix}$。该映射定义为：\n$u_f^1 = u_C^1$\n$u_f^2 = \\frac{1}{2} u_C^1 + \\frac{1}{2} u_C^2$\n$u_f^3 = u_C^2$\n以矩阵形式 $u_f = P u_C$ 表示，延拓算子为：\n$$\nP = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix}\n$$\n限制算子 $R$ 使用对称 Galerkin 选择构造，即 $R = P^{\\top}$。因此，$R \\in \\mathbb{R}^{2 \\times 3}$ 为：\n$$\nR = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix}\n$$\n粗网格算子 $A_c$ 通过 Galerkin 投影 $A_c = R A P = P^{\\top} A P$ 形成。我们分两步计算这个乘积。首先，我们计算 $A P$：\n$$\nA P = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2  & -1 \\\\ 0  & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2(1) - 1(\\frac{1}{2}) & 2(0) - 1(\\frac{1}{2}) \\\\ -1(1) + 2(\\frac{1}{2}) & -1(0) + 2(\\frac{1}{2}) - 1(1) \\\\ 0(1) - 1(\\frac{1}{2}) & 0(0) - 1(\\frac{1}{2}) + 2(1) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\n接下来，我们左乘 $R$ 来求得 $A_c$：\n$$\nA_c = R (A P) = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 1(\\frac{3}{2}) + \\frac{1}{2}(0) + 0(-\\frac{1}{2}) & 1(-\\frac{1}{2}) + \\frac{1}{2}(0) + 0(\\frac{3}{2}) \\\\ 0(\\frac{3}{2}) + \\frac{1}{2}(0) + 1(-\\frac{1}{2}) & 0(-\\frac{1}{2}) + \\frac{1}{2}(0) + 1(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\n现在，我们确定 $A$ 和 $A_c$ 的谱。细网格算子 $A$ 的特征值，记为 $\\lambda_A$，是特征方程 $\\det(A - \\lambda_A I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} 2-\\lambda_A & -1 & 0 \\\\ -1 & 2-\\lambda_A & -1 \\\\ 0 & -1 & 2-\\lambda_A \\end{pmatrix} = (2-\\lambda_A)((2-\\lambda_A)^2 - 1) - (-1)(-(2-\\lambda_A)) = (2-\\lambda_A)((2-\\lambda_A)^2 - 2) = 0\n$$\n这给出一个特征值 $\\lambda_A = 2$，另外两个来自 $(2-\\lambda_A)^2 = 2$，即 $2-\\lambda_A = \\pm\\sqrt{2}$，或 $\\lambda_A = 2 \\mp \\sqrt{2}$。$A$ 的排序后的特征值为：\n$\\lambda_1(A) = 2 - \\sqrt{2}$\n$\\lambda_2(A) = 2$\n$\\lambda_3(A) = 2 + \\sqrt{2}$\n所有特征值均为正，证实了 $A$ 是正定的。\n\n粗网格算子 $A_c$ 的特征值，记为 $\\lambda_c$，是方程 $\\det(A_c - \\lambda_c I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} \\frac{3}{2}-\\lambda_c & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2}-\\lambda_c \\end{pmatrix} = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\frac{1}{4} = 0\n$$\n这意味着 $\\left(\\frac{3}{2}-\\lambda_c\\right)^2 = \\frac{1}{4}$，所以 $\\frac{3}{2}-\\lambda_c = \\pm\\frac{1}{2}$。由此得出特征值 $\\lambda_c = \\frac{3}{2} \\mp \\frac{1}{2}$。$A_c$ 的排序后的特征值为：\n$\\lambda_1(A_c) = \\frac{3}{2} - \\frac{1}{2} = 1$\n$\\lambda_2(A_c) = \\frac{3}{2} + \\frac{1}{2} = 2$\n\n最后，我们验证特征值交错性质。对于 SPD 矩阵，柯朗-费舍尔（Courant-Fischer）极小极大原理指出，伽辽金投影系统的特征值与原系统的特征值交错。对于一个 $n \\times n$ 的 SPD 矩阵 $A$ 和一个 $n \\times m$ 的满秩延拓矩阵 $P$ ($m  n$)，广义特征值问题 $P^{\\top}AP y = \\mu (P^{\\top}P) y$ 的特征值 $\\mu_k$ 与 $A$ 的特征值 $\\lambda_k$ 交错。即，对于 $k=1, \\dots, m$，有 $\\lambda_k(A) \\le \\mu_k \\le \\lambda_{k+n-m}(A)$。这些 $\\mu_k$ 是真正的 Ritz 值。问题要求我们验证 $A_c$ 的标准特征值 $\\lambda_k(A_c)$ 是否具有此性质。我们直接进行检验。\n在这里，$n=3$，$m=2$。我们必须验证对于 $k=1, 2$，是否有 $\\lambda_k(A) \\le \\lambda_k(A_c) \\le \\lambda_{k+1}(A)$。\n对于 $k=1$：\n$$\n\\lambda_1(A) \\le \\lambda_1(A_c) \\le \\lambda_2(A) \\implies 2 - \\sqrt{2} \\le 1 \\le 2\n$$\n由于 $1  \\sqrt{2}  2$，我们有 $0  2-\\sqrt{2}  1$。因此，$2 - \\sqrt{2} \\le 1$ 成立。同时，$1 \\le 2$ 也成立。第一个交错条件得到满足。\n对于 $k=2$：\n$$\n\\lambda_2(A) \\le \\lambda_2(A_c) \\le \\lambda_3(A) \\implies 2 \\le 2 \\le 2 + \\sqrt{2}\n$$\n这个条件也得到满足。因此，对于这个特定问题，$A_c$ 的标准特征值满足交错性质。\n\n$A_c$ 的两个粗网格特征值是 $1$ 和 $2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$", "id": "3290960"}, {"introduction": "代数多重网格的另一个关键组成部分是“光滑器”，其作用并非直接求解线性系统，而是在每个网格层级上高效地衰减误差的高频分量。本练习 [@problem_id:3290959] 将让你亲手操作一个常用的光滑器——不完全 LU 分解（ILU(0)）。通过对给定的残差向量执行一步光滑操作并计算残差范数的降低，你将深入理解光滑过程的力学原理及其在迭代中的角色。", "problem": "考虑在计算流体力学(CFD)压力修正中出现的三维离散泊松方程，该方程在具有齐次狄利克雷边界条件的均匀笛卡尔网格上进行离散化。得到的线性系统是对称正定(SPD)的，具有经典的7点差分格式：每个内部网格点与其六个坐标轴对齐的邻居点耦合，系数为$-1$，且对角线系数为$6$。设计算域为尺寸为 $2 \\times 2 \\times 2$ 的最小非平凡三维网格，采用字典序 $(i,j,k)$，其中对于 $i,j,k \\in \\{1,2\\}$，索引映射为 $p = i + 2(j-1) + 4(k-1)$。相应的稀疏矩阵 $\\mathbf{A} \\in \\mathbb{R}^{8 \\times 8}$ 的对角线元素为6，当且仅当两个节点在 $2 \\times 2 \\times 2$ 网格内沿x、y或z方向相邻时，非对角线元素为$-1$。这个矩阵 $\\mathbf{A}$ 是对称正定的，并且具有限制在该域上的7点差分格式模式。\n\n在代数多重网格(AMG)方法中，一种常见的光滑子是零填充不完全LU分解，记作不完全LU (ILU(0))，它作为预处理的理查森步骤应用。通过对 $\\mathbf{A}$ 进行不完全LU分解来定义ILU(0)预处理器 $\\mathbf{M}$，其中在超出 $\\mathbf{A}$ 原始稀疏模式的位置进行零填充，并使用给定的字典序。对残差 $\\mathbf{r}$ 的光滑步骤是松弛参数 $\\omega = 1$ 的预处理理查森更新：通过对单位下三角因子进行前向替换和对上三角因子进行后向替换来计算 $\\delta \\mathbf{x} = \\mathbf{M}^{-1} \\mathbf{r}$，然后形成更新后的残差 $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}\\,\\delta \\mathbf{x}$。残差范数缩减因子定义为欧几里得范数比 $\\rho = \\|\\mathbf{r}'\\|_{2} / \\|\\mathbf{r}\\|_{2}$。\n\n从上述基本离散算子定义出发，在所述的排序和模式限制下，显式构造 $\\mathbf{A}$ 的ILU(0)因子。然后，对于特定的残差向量\n$$\n\\mathbf{r} = \\begin{pmatrix} 1  0  0  0  0  0  0  0 \\end{pmatrix}^{\\top},\n$$\n执行恰好一次如定义的ILU(0)光滑步骤，并计算残差范数缩减因子 $\\rho$。将您关于 $\\rho$ 的最终答案表示为单一的精确解析表达式（不要四舍五入）。量 $\\rho$ 是无量纲的；不要在最终答案中包含任何单位。", "solution": "该问题在科学上是合理的并且是适定的。我们按步骤求解。\n\n### 第1步：构造系统矩阵 $\\mathbf{A}$\n\n根据字典序 $p = i + 2(j-1) + 4(k-1)$ 和7点差分格式，我们构造 $8 \\times 8$ 的矩阵 $\\mathbf{A}$。对角线元素均为6，相邻节点的非对角线元素为-1。\n$$\n\\mathbf{A} = \\begin{pmatrix}\n6  -1  -1  0  -1  0  0  0 \\\\\n-1  6  0  -1  0  -1  0  0 \\\\\n-1  0  6  -1  0  0  -1  0 \\\\\n0  -1  -1  6  0  0  0  -1 \\\\\n-1  0  0  0  6  -1  -1  0 \\\\\n0  -1  0  0  -1  6  0  -1 \\\\\n0  0  -1  0  -1  0  6  -1 \\\\\n0  0  0  -1  0  -1  -1  6\n\\end{pmatrix}\n$$\n\n### 第2步：计算ILU(0)分解 $\\mathbf{M} = \\mathbf{L}\\mathbf{U}$\n\n我们计算 $\\mathbf{M}=\\mathbf{L}\\mathbf{U}$，其中 $\\mathbf{L}$ 是单位下三角矩阵，$\\mathbf{U}$ 是上三角矩阵，它们的稀疏模式与 $\\mathbf{A}$ 的下三角和上三角部分相同。\n通过计算，我们得到 $\\mathbf{U}$ 的对角线元素为：\n$U_{11} = 6$\n$U_{22} = A_{22} - (A_{21}/U_{11})A_{12} = 6 - (-1/6)(-1) = 35/6$\n$U_{33} = A_{33} - (A_{31}/U_{11})A_{13} = 6 - (-1/6)(-1) = 35/6$\n$U_{44} = A_{44} - (A_{42}/U_{22})A_{24} - (A_{43}/U_{33})A_{34} = 6 - (-1/(35/6))(-1) - (-1/(35/6))(-1) = 6 - 12/35 = 198/35$\n$U_{55} = A_{55} - (A_{51}/U_{11})A_{15} = 6 - (-1/6)(-1) = 35/6$\n$U_{66} = A_{66} - (A_{62}/U_{22})A_{26} - (A_{65}/U_{55})A_{56} = 6 - (-1/(35/6))(-1) - (-1/(35/6))(-1) = 198/35$\n$U_{77} = A_{77} - (A_{73}/U_{33})A_{37} - (A_{75}/U_{55})A_{57} = 6 - (-1/(35/6))(-1) - (-1/(35/6))(-1) = 198/35$\n$U_{88} = A_{88} - (A_{84}/U_{44})A_{48} - (A_{86}/U_{66})A_{68} - (A_{87}/U_{77})A_{78} = 6 - 3(-1/(198/35))(-1) = 6 - 105/198 = 1083/198 = 361/66$\n\n$\\mathbf{L}$ 的非对角线元素为 $L_{ij} = A_{ij} / U_{jj}$（当 $A_{ij}$ 非零时）。例如，$L_{21} = -1/6$, $L_{42} = -1/(35/6) = -6/35$。\n\n### 第3步：执行光滑步骤 $\\delta \\mathbf{x} = \\mathbf{M}^{-1} \\mathbf{r}$\n\n给定 $\\mathbf{r} = (1, 0, 0, 0, 0, 0, 0, 0)^{\\top}$。我们首先求解 $\\mathbf{L}\\mathbf{y} = \\mathbf{r}$（前向替换），然后求解 $\\mathbf{U}\\delta \\mathbf{x} = \\mathbf{y}$（后向替换）。\n\n**前向替换 $\\mathbf{L}\\mathbf{y} = \\mathbf{r}$**:\n$y_1 = 1$\n$y_2 = -L_{21}y_1 = 1/6$\n$y_3 = -L_{31}y_1 = 1/6$\n$y_4 = -L_{42}y_2 - L_{43}y_3 = -(-6/35)(1/6) - (-6/35)(1/6) = 2/35$\n$y_5 = -L_{51}y_1 = 1/6$\n$y_6 = -L_{62}y_2 - L_{65}y_5 = -(-6/35)(1/6) - (-6/35)(1/6) = 2/35$\n$y_7 = -L_{73}y_3 - L_{75}y_5 = -(-6/35)(1/6) - (-6/35)(1/6) = 2/35$\n$y_8 = -L_{84}y_4 - L_{86}y_6 - L_{87}y_7 = -(-35/198)(2/35) \\times 3 = 6/198 = 1/33$\n$\\mathbf{y} = (1, 1/6, 1/6, 2/35, 1/6, 2/35, 2/35, 1/33)^{\\top}$\n\n**后向替换 $\\mathbf{U}\\delta \\mathbf{x} = \\mathbf{y}$**:\n$\\delta x_8 = y_8 / U_{88} = (1/33) / (361/66) = 2/361$\n$\\delta x_7 = (y_7 - U_{78}\\delta x_8)/U_{77} = (2/35 - (-1)(2/361)) / (198/35) = 4/361$\n$\\delta x_6 = (y_6 - U_{68}\\delta x_8)/U_{66} = (2/35 - (-1)(2/361)) / (198/35) = 4/361$\n$\\delta x_5 = (y_5 - U_{56}\\delta x_6 - U_{57}\\delta x_7)/U_{55} = (1/6 - (-1)(4/361) - (-1)(4/361)) / (35/6) = 409/12635$\n$\\delta x_4 = (y_4 - U_{48}\\delta x_8)/U_{44} = (2/35 - (-1)(2/361)) / (198/35) = 4/361$\n$\\delta x_3 = (y_3 - U_{34}\\delta x_4 - U_{37}\\delta x_7)/U_{33} = (1/6 - (-1)(4/361) - (-1)(4/361)) / (35/6) = 409/12635$\n$\\delta x_2 = (y_2 - U_{24}\\delta x_4 - U_{26}\\delta x_6)/U_{22} = (1/6 - (-1)(4/361) - (-1)(4/361)) / (35/6) = 409/12635$\n$\\delta x_1 = (y_1 - U_{12}\\delta x_2 - U_{13}\\delta x_3 - U_{15}\\delta x_5)/U_{11} = (1 - (-1)(409/12635) \\times 3) / 6 = 6931/37905$\n\n### 第4步：计算残差范数缩减因子 $\\rho$\n\n更新后的残差为 $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}\\delta\\mathbf{x} = (\\mathbf{M}-\\mathbf{A})\\delta\\mathbf{x}$。矩阵 $\\mathbf{N} = \\mathbf{M}-\\mathbf{A}$ 是ILU(0)分解的误差矩阵，其非零元素对应于高斯消去过程中的“填充”项。\n$\\mathbf{r}' = \\mathbf{N}\\delta\\mathbf{x}$ 的分量计算如下：\n$r'_1 = 0$\n$r'_2 = N_{23}\\delta x_3 + N_{25}\\delta x_5 = (1/6)\\delta x_3 + (1/6)\\delta x_5 = (1/3)(409/12635) = 409/37905$\n$r'_3 = N_{32}\\delta x_2 + N_{35}\\delta x_5 = 409/37905$\n$r'_4 = N_{46}\\delta x_6 + N_{47}\\delta x_7 = (6/35)\\delta x_6 + (6/35)\\delta x_7 = (12/35)(4/361) = 48/12635$\n$r'_5 = N_{52}\\delta x_2 + N_{53}\\delta x_3 = 409/37905$\n$r'_6 = N_{64}\\delta x_4 + N_{67}\\delta x_7 = 48/12635$\n$r'_7 = N_{74}\\delta x_4 + N_{76}\\delta x_6 = 48/12635$\n$r'_8 = 0$\n\n$\\|\\mathbf{r}\\|_2 = 1$。因此 $\\rho = \\|\\mathbf{r}'\\|_2$。\n$\\|\\mathbf{r}'\\|_2^2 = 3 \\times (409/37905)^2 + 3 \\times (48/12635)^2$\n$= 3 \\times (409/37905)^2 + 3 \\times ((48 \\times 3)/(12635 \\times 3))^2$\n$= 3 \\times (409/37905)^2 + 3 \\times (144/37905)^2$\n$= \\frac{3}{37905^2} (409^2 + 144^2)$\n$= \\frac{3}{37905^2} (167281 + 20736) = \\frac{3 \\times 188017}{37905^2} = \\frac{564051}{37905^2}$\n\n因此，残差范数缩减因子为\n$$ \\rho = \\sqrt{\\frac{564051}{37905^2}} = \\frac{\\sqrt{564051}}{37905} $$", "answer": "$$\\boxed{\\frac{\\sqrt{564051}}{37905}}$$", "id": "3290959"}]}