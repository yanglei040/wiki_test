{"hands_on_practices": [{"introduction": "多重网格方法的效率在很大程度上取决于其光滑器消除高频误差分量的能力。局部傅里叶分析 (Local Fourier Analysis, LFA) 是定量评估和优化光滑器性能的基石。通过这项练习 [@problem_id:3323378]，你将运用 LFA 推导加权雅可比光滑器的最优阻尼参数，并计算其对应的光滑因子，从而掌握分析多重网格核心构件的基本方法。", "problem": "考虑在不可压缩流求解器中出现的压力泊松子问题，此处用区间 $[0,1]$ 上带齐次狄利克雷边界条件的一维 ($1\\mathrm{D}$) 泊松方程 $-u''(x)=f(x)$ 对其进行建模。在一个包含 $n$ 个内部点、间距为 $h=1/(n+1)$ 的均匀网格上，使用标准的二阶中心差分近似对该方程进行离散化，得到一个线性系统 $A u = f$，其中 $A$ 是与模板 $\\left(-1,\\,2,\\,-1\\right)$ 相关联并按 $1/h^{2}$ 缩放的三对角矩阵。考虑用于几何多重网格的加权雅可比光滑子，它由误差传播关系 $e^{k+1} = \\left(I - \\omega D^{-1} A\\right) e^{k}$ 定义，其中 $D$ 是 $A$ 的对角部分，$\\omega \\in (0,1)$ 是阻尼参数。\n\n使用局部傅里叶分析 (LFA)，假设一个无限均匀网格，并分析光滑子对傅里叶误差模式 $e_{j} = \\exp\\!\\left(\\mathrm{i} j \\theta\\right)$ 的作用，其中 $j \\in \\mathbb{Z}$ 且 $\\theta \\in (0,\\pi]$ 是傅里叶频率。定义两网格高频集 $\\Theta_{\\mathrm{hf}} = [\\pi/2,\\pi]$，并令光滑因子为 $\\mu(\\omega) = \\max_{\\theta \\in \\Theta_{\\mathrm{hf}}} \\left|g(\\theta,\\omega)\\right|$，其中 $g(\\theta,\\omega)$ 是加权雅可比误差传播算子的傅里叶符号。从第一性原理推导傅里叶符号 $g(\\theta,\\omega)$，确定在 $\\Theta_{\\mathrm{hf}}$ 上使 $\\mu(\\omega)$ 最小化的阻尼参数 $\\omega$ 的值，然后计算在最优 $\\omega$ 下，最高频模式 $\\theta=\\pi$ 的光滑因子 $\\mu^{\\star}$。\n\n只需提供 $\\mu^{\\star}$ 的最终数值，以最简分数形式表示。无需四舍五入，也不使用单位。", "solution": "起点是在 $[0,1]$ 上带齐次狄利克雷边界条件的一维泊松边值问题 $-u''(x) = f(x)$。在一个间距为 $h = 1/(n+1)$、内部索引为 $j=1,\\dots,n$ 的均匀网格上，二阶中心差分近似给出了标准线性系统 $A u = f$，其中 $A$ 对应于模板 $\\left(-1,\\,2,\\,-1\\right)/h^{2}$。$A$ 的对角部分为 $D = \\frac{2}{h^{2}} I$。\n\n针对该线性系统的加权雅可比松弛通过\n$$\ne^{k+1} = \\left(I - \\omega D^{-1} A\\right) e^{k},\n$$\n作用于误差 $e^{k}$，其中 $\\omega \\in (0,1)$ 是阻尼（松弛）参数。目标是使用局部傅里叶分析 (LFA) 来理解在此迭代下傅里叶误差模式的放大情况，并选择 $\\omega$ 以最小化高频范围内的光滑因子。\n\n在无限均匀网格上，考虑傅里叶模式 $e_{j} = \\exp\\!\\left(\\mathrm{i} j \\theta\\right)$，其中 $j \\in \\mathbb{Z}$ 且 $\\theta \\in (0,\\pi]$。因为 $A$ 具有常系数，这些模式在某种意义上将算子对角化，即每个模式都是相关卷积算子的特征向量。由模板 $\\left(-1,\\,2,\\,-1\\right)/h^{2}$ 定义的离散拉普拉斯算子具有傅里叶符号\n$$\n\\widehat{A}(\\theta) = \\frac{1}{h^{2}}\\left(2 - 2\\cos(\\theta)\\right).\n$$\n对角部分 $D$ 的符号为 $\\widehat{D} = \\frac{2}{h^{2}}$，因此 $D^{-1}A$ 的符号为\n$$\n\\widehat{D^{-1}A}(\\theta) = \\frac{\\widehat{A}(\\theta)}{\\widehat{D}} = \\frac{2 - 2\\cos(\\theta)}{2} = 1 - \\cos(\\theta).\n$$\n因此，误差传播算子 $S(\\omega) = I - \\omega D^{-1}A$ 的傅里叶符号为\n$$\ng(\\theta,\\omega) = 1 - \\omega \\left(1 - \\cos(\\theta)\\right) = 1 - \\omega + \\omega \\cos(\\theta).\n$$\n\n在几何多重网格中，光滑因子关注的是衰减那些在粗网格上不能很好表示的高频误差分量。对于标准的双网格转移，一维中常见的高频集是 $\\Theta_{\\mathrm{hf}} = [\\pi/2,\\pi]$。光滑因子定义为\n$$\n\\mu(\\omega) = \\max_{\\theta \\in [\\pi/2,\\pi]} \\left|g(\\theta,\\omega)\\right| = \\max_{\\theta \\in [\\pi/2,\\pi]} \\left|1 - \\omega + \\omega \\cos(\\theta)\\right|.\n$$\n在 $\\theta \\in [\\pi/2,\\pi]$ 上，$\\cos(\\theta)$ 从 $0$ 单调递减到 $-1$。由于 $g(\\theta,\\omega)$ 关于 $\\cos(\\theta)$ 是仿射的，函数 $g(\\theta,\\omega)$ 在此区间上关于 $\\theta$ 是单调递减的。因此，其幅值的极值出现在端点处：\n$$\ng\\!\\left(\\frac{\\pi}{2},\\omega\\right) = 1 - \\omega, \\qquad g(\\pi,\\omega) = 1 - 2\\omega.\n$$\n因此\n$$\n\\mu(\\omega) = \\max\\left\\{|1 - \\omega|,\\;|1 - 2\\omega|\\right\\}.\n$$\n\n我们现在选择 $\\omega$ 来最小化 $\\mu(\\omega)$。对于 $\\omega \\in (0,1)$，$1 - \\omega \\geq 0$。量 $1 - 2\\omega$ 在 $\\omega = \\frac{1}{2}$ 处变号。对于 $\\omega \\geq \\frac{1}{2}$，有 $|1 - 2\\omega| = 2\\omega - 1$。通过令两个自变量相等，可以实现在 $\\omega \\in [\\frac{1}{2},1]$ 上最小化 $\\max\\left\\{1 - \\omega,\\; 2\\omega - 1\\right\\}$：\n$$\n1 - \\omega = 2\\omega - 1 \\quad \\Longrightarrow \\quad 2 = 3\\omega \\quad \\Longrightarrow \\quad \\omega^{\\star} = \\frac{2}{3}.\n$$\n将 $\\omega^{\\star}$ 代回，我们得到\n$$\n\\mu(\\omega^{\\star}) = \\max\\left\\{1 - \\frac{2}{3},\\; 2\\cdot\\frac{2}{3} - 1\\right\\} = \\max\\left\\{\\frac{1}{3},\\; \\frac{1}{3}\\right\\} = \\frac{1}{3}.\n$$\n\n题目要求在最优阻尼下，最高频模式（即 $\\theta = \\pi$）的光滑因子。使用 $g(\\pi,\\omega) = 1 - 2\\omega$，\n$$\n\\mu^{\\star} = \\left|g(\\pi,\\omega^{\\star})\\right| = \\left|1 - 2\\cdot\\frac{2}{3}\\right| = \\left|1 - \\frac{4}{3}\\right| = \\frac{1}{3}.\n$$\n因此，在最优加权雅可比参数下，最高频模式的光滑因子为 $\\mu^{\\star} = \\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3323378"}, {"introduction": "在光滑步骤之后，残差被转移到粗网格上，这一过程的准确性对于粗网格校正的成功至关重要。理想情况下，粗网格问题应精确表示细网格误差。本练习 [@problem_id:3323349] 将引导你通过泰勒展开分析，探究在狄利克雷边界附近，全加权限制算子与在粗网格上重新离散化算子之间的一致性。这个过程揭示了边界条件如何影响网格间传递的精度，这是设计稳健多重网格求解器时必须考虑的关键细节。", "problem": "考虑计算流体动力学 (CFD) 中出现的一维域 $[0,1]$ 上带齐次狄利克雷边界条件的离散压力泊松子问题。设 $u(x)$ 是一个解析函数，满足边值问题 $-u''(x) = f(x)$，其中 $x \\in (0,1)$，$u(0) = 0$ 且 $u(1) = 0$。用间距为 $h$ 的均匀细网格将该区间离散化，节点为 $x_i = i h$，$i = 0,1,\\dots,N$，其中 $h = 1/N$，$u_0 = 0$ 和 $u_N = 0$ 为施加的边界条件。在细网格上，用标准的二阶三点格式来近似内部节点处的 $-u''(x)$：\n$$\nA_h u_i \\equiv \\frac{-u_{i-1} + 2 u_i - u_{i+1}}{h^2}, \\quad i = 1,2,\\dots,N-1.\n$$\n将内部节点 $i$ 处的细网格残差定义为 $r_i \\equiv f(x_i) - A_h u_i$，其值使用在网格点上采样的精确连续解 $u(x)$ 计算。通过以因子 2 进行粗化来构建粗网格，因此 $H = 2h$，且粗网格节点与偶数索引的细网格节点重合。在粗网格上，用相同的三点格式重新离散化算子：\n$$\nA_H u_I \\equiv \\frac{-u_{I-1} + 2 u_I - u_{I+1}}{H^2},\n$$\n并将由精确解计算出的粗网格残差定义为 $\\rho_I \\equiv f(X_I) - A_H u_I$，其中 $X_I = 2 I h$ 且 $u_I = u(X_I)$。\n\n使用全加权限制将细网格残差映射到粗网格上：\n$$\n(R r)_I \\equiv \\frac{1}{4} r_{2I-1} + \\frac{1}{2} r_{2I} + \\frac{1}{4} r_{2I+1},\n$$\n并关注紧邻左边界的第一个粗网格内部节点，即位于 $X_1 = 2h$ 处的 $I=1$。仅从控制方程 $-u'' = f$、齐次狄利克雷边界条件以及关于 $x = 2h$ 的泰勒展开出发，推导在 $I=1$ 处限制后的细网格残差与重新离散化的粗网格残差之差的领阶渐近表达式（当 $h \\to 0$ 时），\n$$\nE_1(h) \\equiv (R r)_1 - \\rho_1.\n$$\n用 $h$ 和在 $x=2h$ 处求值的 $u$ 的导数，将最终结果表示为单个闭式解析表达式。无需进行数值计算。最终答案必须是单个解析表达式。", "solution": "我们从边值问题 $-u''(x) = f(x)$ 及边界条件 $u(0)=0$ 和 $u(1)=0$ 开始。内部节点 $i$ 处的细网格离散算子为\n$$\nA_h u_i = \\frac{-u_{i-1} + 2 u_i - u_{i+1}}{h^2}.\n$$\n用在节点上采样的精确连续解计算细网格残差，可得\n$$\nr_i = f(x_i) - A_h u_i.\n$$\n使用控制方程 $f(x_i) = -u''(x_i)$，残差即为应用于 $u$ 的格式的局部截断误差。关于 $x = x_i$ 的泰勒展开得到标准的二阶差分近似\n$$\n\\frac{u_{i-1} - 2 u_i + u_{i+1}}{h^2} = u''(x_i) + \\frac{h^2}{12} u^{(4)}(x_i) + \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6).\n$$\n因此，\n$$\nA_h u_i = -\\left[u''(x_i) + \\frac{h^2}{12} u^{(4)}(x_i) + \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6)\\right],\n$$\n且细网格残差为\n$$\nr_i = -u''(x_i) - A_h u_i = \\frac{h^2}{12} u^{(4)}(x_i) + \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6).\n$$\n\n现在我们使用全加权将细网格残差限制到粗网格。对于 $I = 1$，粗网格节点为 $X_1 = 2h$，并且\n$$\n(R r)_1 = \\frac{1}{4} r_{1} + \\frac{1}{2} r_{2} + \\frac{1}{4} r_{3}.\n$$\n代入在 $x_1 = h$，$x_2 = 2h$ 和 $x_3 = 3h$ 处的截断误差展开式，可得\n$$\n(R r)_1 = \\frac{h^2}{12} \\left[\\frac{1}{4} u^{(4)}(x_1) + \\frac{1}{2} u^{(4)}(x_2) + \\frac{1}{4} u^{(4)}(x_3)\\right] + \\frac{h^4}{360} \\left[\\frac{1}{4} u^{(6)}(x_1) + \\frac{1}{2} u^{(6)}(x_2) + \\frac{1}{4} u^{(6)}(x_3)\\right] + \\mathcal{O}(h^6).\n$$\n\n在间距为 $H = 2h$ 的粗网格上，对应用于 $u$ 且在 $X_1 = 2h$ 处的粗网格算子进行相同的分析，可得\n$$\nA_H u_1 = -\\left[u''(X_1) + \\frac{H^2}{12} u^{(4)}(X_1) + \\frac{H^4}{360} u^{(6)}(X_1) + \\mathcal{O}(H^6)\\right],\n$$\n因此粗网格残差（再次使用 $f(X_1) = -u''(X_1)$）为\n$$\n\\rho_1 = \\frac{H^2}{12} u^{(4)}(X_1) + \\frac{H^4}{360} u^{(6)}(X_1) + \\mathcal{O}(H^6) = \\frac{(2h)^2}{12} u^{(4)}(x_2) + \\frac{(2h)^4}{360} u^{(6)}(x_2) + \\mathcal{O}(h^6),\n$$\n即，\n$$\n\\rho_1 = \\frac{h^2}{3} u^{(4)}(x_2) + \\frac{2}{45} h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6).\n$$\n\n为了比较 $(R r)_1$ 和 $\\rho_1$，我们使用泰勒级数将 $u^{(4)}(x_1)$ 和 $u^{(4)}(x_3)$ 在 $x_2 = 2h$ 处展开。因为 $u$ 是解析函数，\n\\begin{align*}\n\\frac{1}{4} u^{(4)}(x_1) + \\frac{1}{2} u^{(4)}(x_2) + \\frac{1}{4} u^{(4)}(x_3)  = \\frac{1}{4} \\left(u^{(4)}(x_2) - h u^{(5)}(x_2) + \\frac{h^2}{2}u^{(6)}(x_2) + \\dots\\right) \\\\  \\quad + \\frac{1}{2} u^{(4)}(x_2) + \\frac{1}{4} \\left(u^{(4)}(x_2) + h u^{(5)}(x_2) + \\frac{h^2}{2}u^{(6)}(x_2) + \\dots\\right) \\\\  = u^{(4)}(x_2) + \\frac{h^2}{4}u^{(6)}(x_2) + \\mathcal{O}(h^4).\n\\end{align*}\n类似地，对于 $u^{(6)}$ 项，\n$$\n\\frac{1}{4} u^{(6)}(x_1) + \\frac{1}{2} u^{(6)}(x_2) + \\frac{1}{4} u^{(6)}(x_3) = u^{(6)}(x_2) + \\mathcal{O}(h^2),\n$$\n这在我们所要求的阶数上是足够的。代入 $(R r)_1$ 中，\n\\begin{align*}\n(R r)_1  = \\frac{h^2}{12} \\left[u^{(4)}(x_2) + \\frac{h^2}{4} u^{(6)}(x_2) + \\mathcal{O}(h^4)\\right] + \\frac{h^4}{360} \\left[u^{(6)}(x_2) + \\mathcal{O}(h^2)\\right] + \\mathcal{O}(h^6) \\\\\n = \\frac{h^2}{12} u^{(4)}(x_2) + \\left(\\frac{h^4}{48} + \\frac{h^4}{360}\\right) u^{(6)}(x_2) + \\mathcal{O}(h^6) \\\\\n = \\frac{h^2}{12} u^{(4)}(x_2) + \\frac{17}{720} h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6).\n\\end{align*}\n我们已经有\n$$\n\\rho_1 = \\frac{h^2}{3} u^{(4)}(x_2) + \\frac{2}{45} h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6) = \\frac{h^2}{3} u^{(4)}(x_2) + \\frac{32}{720} h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6).\n$$\n因此，在紧邻边界的第一个粗网格内部节点上的差值为\n\\begin{align*}\nE_1(h)  \\equiv (R r)_1 - \\rho_1 \\\\\n = \\left(\\frac{h^2}{12} - \\frac{h^2}{3}\\right) u^{(4)}(x_2) + \\left(\\frac{17}{720} - \\frac{32}{720}\\right) h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6) \\\\\n = -\\frac{3}{12} h^2 u^{(4)}(x_2) - \\frac{15}{720} h^4 u^{(6)}(x_2) + \\mathcal{O}(h^6) \\\\\n = -\\frac{h^2}{4} u^{(4)}(x_2) - \\frac{h^4}{48} u^{(6)}(x_2) + \\mathcal{O}(h^6).\n\\end{align*}\n因此，当 $h \\to 0$ 时的领阶项为\n$$\nE_1(h) = -\\frac{h^2}{4} u^{(4)}(2h) + \\mathcal{O}(h^4).\n$$\n这量化了当在粗网格上使用重新离散化时，齐次狄利克雷边界对边界附近全加权限制精度的影响：在紧邻边界的粗网格节点上，限制后的残差比重新离散化的粗网格残差低估了一个领阶量，该量级正比于 $-\\frac{h^2}{4} u^{(4)}$。所要求的闭式领阶表达式是在 $x=2h$ 处的系数以及对 $u^{(4)}$ 的依赖关系。", "answer": "$$\\boxed{-\\frac{h^{2}}{4}\\,u^{(4)}(2h)}$$", "id": "3323349"}, {"introduction": "设计一个高效的多重网格求解器不仅需要优质的构件（如光滑器和传递算子），还需要明智的策略来组合它们。V-循环是基本标准，但在处理难以收敛的低频误差时，W-循环等更复杂的循环类型可能更具优势。本练习 [@problem_id:3323329] 要求你量化地分析从V-循环切换到W-循环的利弊，通过计算每个循环的计算功并预测收敛因子的改善，从而为算法选择提供一个基于分析的决策依据。", "problem": "考虑一个几何多重网格求解器，应用于均匀三维网格上不可压缩流问题中出现的压力泊松方程的对称正定 (SPD) 离散化。该层级结构在每个空间方向上以 $r=2$ 的因子进行粗化（因此，对于空间维度 $d=3$，每个层级的未知数数量以 $r^{d}=8$ 的因子减少）。转移算子采用标准的线性插值进行延拓，采用全加权进行限制，并使用一个前平滑和一个后平滑步骤，平滑器为加权 Jacobi 平滑器，其阻尼参数 $\\omega$ 使得局部傅里叶分析 (LFA) 预测的每步高频平滑因子为 $\\mu=1/5$。对于当前的细网格层级循环，使用一次粗网格访问（标准的 V-循环）所观察到的双网格收敛性很勉强：测量得到的误差传播算子的谱半径为 $\\rho(E_{\\mathrm{V}})=9/10$，并且已知这主要是由光滑误差模式上的粗网格校正主导，而不是由高频平滑主导（即，组合平滑因子远小于 $9/10$）。\n\n您需要通过量化工作量膨胀和预期的收敛性改善，来决定从 V-循环切换到 W-循环是否合理。请使用以下基于标准多重网格理论的建模原则：\n\n- 对于包含一个前平滑和一个后平滑步骤的循环，其误差传播算子可以建模为 $E=S_{\\mathrm{post}}\\,C\\,S_{\\mathrm{pre}}$，其中 $S_{\\mathrm{pre}}$ 和 $S_{\\mathrm{post}}$ 表示平滑算子，$C=I-P A_{H}^{-1} R A_{h}$ 表示粗网格校正算子，$A_{h}$ 和 $A_{H}$ 分别是细网格和粗网格算子，$R$ 和 $P$ 分别是限制和延拓算子。谱半径 $\\rho(E)$ 是每循环的渐近收敛因子。\n- 对于在 $d=3$ 维空间中以 $r=2$ 进行均匀粗化的层级结构，且层级成本与未知数数量成正比，每循环的总工作量满足递推关系：V-循环为 $T_{\\mathrm{V}}(n)=a\\,n+T_{\\mathrm{V}}(n/8)$，W-循环为 $T_{\\mathrm{W}}(n)=a\\,n+2\\,T_{\\mathrm{W}}(n/8)$，其中 $a0$ 汇集了与该层级自由度 $n$ 成正比的层级相关成本（平滑、残差计算、限制/延拓）。\n- 当用两次递归的粗网格访问（一个 W-循环）替代单次粗网格访问时，粗网格校正算子在一个细网格层级循环中被有效地应用了两次。在标准假设下，即 $C$ 的主导光滑模式因子在主阶上与平滑可交换，W-循环中粗网格校正的光滑模式收缩因子近似为 $\\gamma_{\\mathrm{W}}\\approx\\gamma_{\\mathrm{V}}^{2}$，其中 $\\gamma_{\\mathrm{V}}$ 是在 V-循环中主导 $\\rho(E_{\\mathrm{V}})$ 的光滑模式因子。包含一个前平滑和一个后平滑步骤的组合高频平滑因子是 $\\mu^{2}$。\n\n仅使用这些原则和给定数据，计算以下两个量：\n1. 对于 $d=3$ 和 $r=2$ 的工作量膨胀因子 $T_{\\mathrm{W}}(n)/T_{\\mathrm{V}}(n)$。\n2. 循环谱半径的预期减少量，定义为 $\\rho(E_{\\mathrm{V}})-\\rho(E_{\\mathrm{W}})$，其中 $\\rho(E_{\\mathrm{W}})$ 由上述模型预测。\n\n将您的最终答案表示为一个使用 $\\mathrm{pmatrix}$ 环境的二元行矩阵，各项按 $\\left(T_{\\mathrm{W}}(n)/T_{\\mathrm{V}}(n)\\ \\ \\ \\rho(E_{\\mathrm{V}})-\\rho(E_{\\mathrm{W}})\\right)$ 的顺序排列。无需四舍五入，报告的值中不包含单位。确保您的推导过程科学一致，所有步骤均基于所述原则，不要引用未声明的快捷公式。", "solution": "任务是计算两个量：从 V-循环切换到 W-循环时的工作量膨胀因子，以及渐近收敛因子（误差传播算子的谱半径）的预期减少量。\n\n首先，我们计算工作量膨胀因子 $\\frac{T_{\\mathrm{W}}(n)}{T_{\\mathrm{V}}(n)}$。问题给出了在具有 $n$ 个自由度的网格上，V-循环 $T_{\\mathrm{V}}(n)$ 和 W-循环 $T_{\\mathrm{W}}(n)$ 的计算工作量的递推关系：\n$$T_{\\mathrm{V}}(n) = a\\,n + T_{\\mathrm{V}}(n/8)$$\n$$T_{\\mathrm{W}}(n) = a\\,n + 2\\,T_{\\mathrm{W}}(n/8)$$\n这些关系适用于一个网格层级结构，其中每个更粗的层级的未知数数量是更细层级的 $1/8$（$d=3$, $r=2$）。项 $a\\,n$ 表示在当前层级上完成的工作（平滑、残差计算、网格间转移），而递归项表示在所有更粗层级上完成的工作。我们可以通过展开来求解这些递推关系，假设层级结构很深。\n\n对于 V-循环，我们有：\n$$T_{\\mathrm{V}}(n) = a\\,n + T_{\\mathrm{V}}(n/8) = a\\,n + \\left(a\\frac{n}{8} + T_{\\mathrm{V}}\\left(\\frac{n}{8^2}\\right)\\right) = a\\,n + a\\frac{n}{8} + a\\frac{n}{8^2} + \\dots$$\n这形成一个几何级数：\n$$T_{\\mathrm{V}}(n) = a\\,n \\sum_{k=0}^{\\infty} \\left(\\frac{1}{8}\\right)^k$$\n这个无穷几何级数的和是 $\\frac{1}{1 - 1/8} = \\frac{1}{7/8} = \\frac{8}{7}$。因此，V-循环的总工作量是：\n$$T_{\\mathrm{V}}(n) = a\\,n \\left(\\frac{8}{7}\\right)$$\n\n对于 W-循环，递推关系是：\n$$T_{\\mathrm{W}}(n) = a\\,n + 2\\,T_{\\mathrm{W}}(n/8) = a\\,n + 2\\left(a\\frac{n}{8} + 2\\,T_{\\mathrm{W}}\\left(\\frac{n}{8^2}\\right)\\right) = a\\,n + 2a\\frac{n}{8} + 4a\\frac{n}{8^2} + \\dots$$\n这也形成一个几何级数：\n$$T_{\\mathrm{W}}(n) = a\\,n \\sum_{k=0}^{\\infty} \\left(\\frac{2}{8}\\right)^k = a\\,n \\sum_{k=0}^{\\infty} \\left(\\frac{1}{4}\\right)^k$$\n这个级数的和是 $\\frac{1}{1 - 1/4} = \\frac{1}{3/4} = \\frac{4}{3}$。因此，W-循环的总工作量是：\n$$T_{\\mathrm{W}}(n) = a\\,n \\left(\\frac{4}{3}\\right)$$\n\n工作量膨胀因子是 W-循环工作量与 V-循环工作量的比率：\n$$\\frac{T_{\\mathrm{W}}(n)}{T_{\\mathrm{V}}(n)} = \\frac{a\\,n \\left(\\frac{4}{3}\\right)}{a\\,n \\left(\\frac{8}{7}\\right)} = \\frac{4/3}{8/7} = \\frac{4}{3} \\times \\frac{7}{8} = \\frac{28}{24} = \\frac{7}{6}$$\n\n接下来，我们计算循环谱半径的预期减少量 $\\rho(E_{\\mathrm{V}}) - \\rho(E_{\\mathrm{W}})$。标准多重网格理论将渐近收敛因子 $\\rho(E)$ 建模为高频误差分量的平滑因子和低频（光滑）误差分量的粗网格校正因子中的最大值。\n对于一个前平滑和一个后平滑步骤，平滑在每个循环中应用两次，因此有效高频平滑因子由 $\\mu^2$ 给出。我们已知 $\\mu = 1/5$，所以高频因子是：\n$$\\mu^2 = \\left(\\frac{1}{5}\\right)^2 = \\frac{1}{25}$$\n设 $\\gamma_{\\mathrm{V}}$ 为 V-循环中光滑模式的粗网格校正的收敛因子。则 V-循环的总谱半径近似为：\n$$\\rho(E_{\\mathrm{V}}) \\approx \\max(\\mu^2, \\gamma_{\\mathrm{V}})$$\n我们已知 $\\rho(E_{\\mathrm{V}}) = 9/10$，并且它由粗网格校正主导。这是合理的，因为 $\\mu^2 = 1/25 = 0.04$，远小于 $9/10 = 0.9$。因此，我们可以推断出 V-循环的粗网格校正因子：\n$$\\gamma_{\\mathrm{V}} = \\frac{9}{10}$$\n\n对于 W-循环，平滑部分保持不变，所以高频因子仍然是 $\\mu^2 = 1/25$。问题指出，W-循环根据模型 $\\gamma_{\\mathrm{W}} \\approx \\gamma_{\\mathrm{V}}^2$ 改善了光滑模式的粗网格校正因子。使用我们找到的 $\\gamma_{\\mathrm{V}}$ 的值：\n$$\\gamma_{\\mathrm{W}} \\approx \\left(\\frac{9}{10}\\right)^2 = \\frac{81}{100}$$\nW-循环的预期谱半径则为：\n$$\\rho(E_{\\mathrm{W}}) \\approx \\max(\\mu^2, \\gamma_{\\mathrm{W}}) = \\max\\left(\\frac{1}{25}, \\frac{81}{100}\\right) = \\max\\left(\\frac{4}{100}, \\frac{81}{100}\\right) = \\frac{81}{100}$$\nW-循环的收敛也由粗网格校正主导，但其因子得到了显著改善。\n\n循环谱半径的减少量是：\n$$\\rho(E_{\\mathrm{V}}) - \\rho(E_{\\mathrm{W}}) = \\frac{9}{10} - \\frac{81}{100} = \\frac{90}{100} - \\frac{81}{100} = \\frac{9}{100}$$\n\n要求的两个量是工作量膨胀因子 $\\frac{7}{6}$ 和谱半径的减少量 $\\frac{9}{100}$。工作量增加 $\\frac{7}{6} \\approx 1.167$（约 $17\\%$）使收敛因子从 $0.9$ 改善到 $0.81$。达到给定容差所需的迭代次数与 $1 / |\\ln(\\rho)|$ 成正比。迭代次数的比率是 $\\frac{\\ln(0.9)}{\\ln(0.81)} \\approx \\frac{-0.1054}{-0.2107} \\approx \\frac{1}{2}$，意味着 W-循环大约需要一半的迭代次数。求解的总工作量与（每循环工作量）$\\times$（迭代次数）成正比。总工作量的比率是 $\\frac{W_W}{W_V} = \\frac{T_W N_W}{T_V N_V} \\approx \\frac{7/6 T_V}{T_V} \\times \\frac{1/2 N_V}{N_V} = \\frac{7}{12} \\approx 0.58$。这表明总计算量大幅减少，从而证明了转换的合理性。\n最终答案由这两个计算值组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{7}{6}  \\frac{9}{100}\n\\end{pmatrix}\n}\n$$", "id": "3323329"}]}