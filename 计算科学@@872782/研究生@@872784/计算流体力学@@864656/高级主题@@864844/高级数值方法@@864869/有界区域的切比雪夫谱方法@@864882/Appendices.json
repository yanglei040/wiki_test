{"hands_on_practices": [{"introduction": "在谱方法中，积分的精确计算是核心，因为它直接关系到能量范数等物理量的离散表示。本练习旨在通过一个具体的例子，探讨Clenshaw-Curtis求积法则的精度，让您亲手推导其能够精确计算一个由切比雪夫多项式构成的函数积分的条件[@problem_id:3300679]。这有助于您深入理解谱方法中离散和连续世界之间的桥梁，以及“谱精度”的来源。", "problem": "在有界域上的计算流体动力学（CFD）中，Chebyshev谱方法通常用Chebyshev多项式来表示场，并通过标准$L^{2}$范数的平方来度量解的能量。考虑一维有界域$[-1,1]$，并将标量场$u$的连续能量定义为\n$$\nE \\equiv \\|u\\|^{2} = \\int_{-1}^{1} |u(x)|^{2} \\, dx.\n$$\n在实际的谱配置法中，使用一种基于求积的离散能量。设Chebyshev-Gauss-Lobatto (CGL) 节点为 $x_{j} = \\cos\\!\\left(\\frac{j\\pi}{N}\\right)$（其中 $j=0,1,\\dots,N$），并设 $\\{w_{j}\\}_{j=0}^{N}$ 为用于通过以下方式近似无权积分 $\\int_{-1}^{1} f(x)\\,dx$ 的 Clenshaw-Curtis (CC) 求积权重\n$$\nQ_{N}(f) \\equiv \\sum_{j=0}^{N} w_{j}\\, f(x_{j}).\n$$\n将基于求积的离散能量定义为\n$$\nE_{N} \\equiv \\sum_{j=0}^{N} w_{j}\\, |u(x_{j})|^{2}.\n$$\n\n从第一类Chebyshev多项式 $T_{m}(x) = \\cos\\!\\left(m\\arccos x\\right)$ 的定义、将 $[-1,1]$ 映射到 $[0,\\pi]$ 且 $dx=-\\sin\\theta\\, d\\theta$ 的变量替换 $x=\\cos\\theta$，以及三角函数在 $[0,\\pi]$ 上的基本正交性出发，完成以下任务：\n\n1. 对于 $u(x) = T_{m}(x)$，其中 $m \\ge 1$ 为一个固定整数，计算精确的连续能量 $E$。\n\n2. 仅利用Chebyshev展开的结构以及具有 $N+1$ 个CGL节点的Clenshaw-Curtis求积对次数至多为 $N$ 的任何代数多项式都是精确的这一事实，确定一个关于 $N$ 的条件（用 $m$ 表示），使得对于该 $u$，有 $E_{N} = E$。\n\n3. 在你在第2部分中找到的条件下，以单个关于 $m$ 的封闭形式表达式给出 $E_{N}$ 和 $E$ 的共同值。\n\n你的最终答案必须是第3部分的封闭形式表达式。无需单位。不要四舍五入；请提供一个精确表达式。", "solution": "该问题是有效的，因为它在谱方法和数值求积的完善理论中有科学依据，是适定的（提供了所有必要信息），并且是客观陈述的。我们可以着手进行形式求解。\n\n该问题要求三个部分：特定场 $u(x)$ 的精确连续能量 $E$，离散能量 $E_N$ 等于 $E$ 时对求积点数 $N+1$ 的条件，以及由此得到的共同值。\n\n首先，我们计算标量场 $u(x) = T_{m}(x)$ 的精确连续能量 $E$，其中 $T_m(x)$ 是 $m$ 次第一类Chebyshev多项式，且 $m$ 是一个满足 $m \\ge 1$ 的固定整数。连续能量定义为：\n$$\nE = \\int_{-1}^{1} |u(x)|^{2} \\, dx = \\int_{-1}^{1} (T_{m}(x))^{2} \\, dx\n$$\n由于 $x \\in [-1,1]$，$T_m(x)$ 是实值的，因此 $|T_m(x)|^2 = (T_m(x))^2$。\n\n为了计算这个积分，我们可以将被积函数 $(T_m(x))^2$ 表示为Chebyshev多项式的线性组合。使用定义 $T_m(x) = \\cos(m\\arccos x)$，我们可以进行替换 $x = \\cos\\theta$。这得到 $T_m(\\cos\\theta) = \\cos(m\\theta)$。被积函数变为：\n$$\n(T_m(x))^2 \\to (\\cos(m\\theta))^2\n$$\n使用三角恒等式 $\\cos^2\\alpha = \\frac{1}{2}(1 + \\cos(2\\alpha))$，我们有：\n$$\n(\\cos(m\\theta))^2 = \\frac{1}{2} (1 + \\cos(2m\\theta))\n$$\n认识到 $1 = T_0(x)$ 且 $\\cos(2m\\theta) = T_{2m}(\\cos\\theta) = T_{2m}(x)$，我们可以在Chebyshev基中写出 $(T_m(x))^2$ 的展开式：\n$$\n(T_m(x))^2 = \\frac{1}{2} T_0(x) + \\frac{1}{2} T_{2m}(x)\n$$\n现在我们可以将其代回到 $E$ 的积分中：\n$$\nE = \\int_{-1}^{1} \\left( \\frac{1}{2} T_0(x) + \\frac{1}{2} T_{2m}(x) \\right) dx = \\frac{1}{2} \\int_{-1}^{1} T_0(x) \\, dx + \\frac{1}{2} \\int_{-1}^{1} T_{2m}(x) \\, dx\n$$\n我们分别计算每个积分。对于第一个积分：\n$$\n\\int_{-1}^{1} T_0(x) \\, dx = \\int_{-1}^{1} 1 \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2\n$$\n对于第二个积分，我们计算整数 $k  0$ 时的一般情况 $\\int_{-1}^{1} T_k(x) \\, dx$。使用替换 $x = \\cos\\theta$，其中 $dx = -\\sin\\theta \\, d\\theta$：\n$$\n\\int_{-1}^{1} T_k(x) \\, dx = \\int_{\\pi}^{0} T_k(\\cos\\theta) (-\\sin\\theta) \\, d\\theta = \\int_{0}^{\\pi} \\cos(k\\theta) \\sin\\theta \\, d\\theta\n$$\n使用积化和差恒等式 $\\cos A \\sin B = \\frac{1}{2}(\\sin(A+B) - \\sin(A-B))$：\n$$\n\\int_{0}^{\\pi} \\cos(k\\theta) \\sin\\theta \\, d\\theta = \\frac{1}{2} \\int_{0}^{\\pi} \\left( \\sin((k+1)\\theta) - \\sin((k-1)\\theta) \\right) d\\theta\n$$\n对于一个非零整数 $n$，$\\int_0^\\pi \\sin(n\\theta) d\\theta = \\left[-\\frac{\\cos(n\\theta)}{n}\\right]_0^\\pi = \\frac{1 - \\cos(n\\pi)}{n} = \\frac{1 - (-1)^n}{n}$。\n如果 $k$ 是一个大于1的奇数，那么 $k+1$ 和 $k-1$ 都是非零偶数。在这种情况下，$1 - (-1)^{k+1} = 0$ 且 $1 - (-1)^{k-1} = 0$，所以积分为0。如果 $k=1$，积分为 $\\frac{1}{2}\\int_0^\\pi \\sin(2\\theta) d\\theta = 0$。因此对于任何奇数 $k \\ge 1$，积分为0。\n如果 $k$ 是一个偶数（$k \\ge 2$），那么 $k+1$ 和 $k-1$ 都是奇数。因此 $1 - (-1)^{k+1} = 2$ 且 $1 - (-1)^{k-1} = 2$。积分变为：\n$$\n\\frac{1}{2} \\left( \\frac{2}{k+1} - \\frac{2}{k-1} \\right) = \\frac{1}{k+1} - \\frac{1}{k-1} = \\frac{(k-1) - (k+1)}{(k+1)(k-1)} = \\frac{-2}{k^2-1}\n$$\n在我们的情况下，我们需要计算 $k = 2m$ 时的积分。由于 $m \\ge 1$，$k=2m$ 是一个大于或等于2的偶数。因此：\n$$\n\\int_{-1}^{1} T_{2m}(x) \\, dx = \\frac{-2}{(2m)^2 - 1} = \\frac{-2}{4m^2 - 1}\n$$\n将积分的值代回到 $E$ 的表达式中：\n$$\nE = \\frac{1}{2}(2) + \\frac{1}{2} \\left( \\frac{-2}{4m^2 - 1} \\right) = 1 - \\frac{1}{4m^2 - 1} = \\frac{(4m^2 - 1) - 1}{4m^2 - 1} = \\frac{4m^2 - 2}{4m^2 - 1}\n$$\n这就完成了问题的第一部分。\n\n第二，我们确定离散能量 $E_N$ 等于连续能量 $E$ 时对 $N$ 的条件。离散能量 $E_N$ 是通过将 Clenshaw-Curtis 求积法则应用于函数 $|u(x)|^2$ 来定义的：\n$$\nE_{N} \\equiv \\sum_{j=0}^{N} w_{j}\\, |u(x_{j})|^{2} = Q_N(|u|^2)\n$$\n等式 $E_N = E$ 等价于求积法则对被积函数是精确的这一陈述，即，\n$$\nQ_N(|u|^2) = \\int_{-1}^{1} |u(x)|^{2} \\, dx\n$$\n被积函数为 $f(x) = |u(x)|^2 = (T_m(x))^2$。如前所示，$(T_m(x))^2 = \\frac{1}{2}T_0(x) + \\frac{1}{2}T_{2m}(x)$。由于 $T_k(x)$ 是一个 $k$ 次代数多项式，被积函数是一个 $2m$ 次代数多项式。问题陈述，具有 $N+1$ 个节点的Clenshaw-Curtis求积对次数至多为 $N$ 的任何代数多项式都是精确的。为了使求积对我们的被积函数是精确的，被积函数的次数必须小于或等于该求积法则精确的最大次数。这给出了条件：\n$$\n\\text{degree}((T_m(x))^2) \\le N\n$$\n由于 $\\text{degree}((T_m(x))^2) = 2m$，对 $N$ 的条件是：\n$$\n2m \\le N\n$$\n\n第三，在条件 $N \\ge 2m$ 下，我们有 $E_N = E$。问题要求的是这个共同值。这正是我们在第一部分计算出的 $E$ 的值。对于任何整数 $m \\ge 1$，这个能量的封闭形式表达式是：\n$$\nE = E_N = \\frac{4m^2 - 2}{4m^2 - 1}\n$$\n这就是最终所需的表达式。", "answer": "$$\\boxed{\\frac{4m^{2}-2}{4m^{2}-1}}$$", "id": "3300679"}, {"introduction": "将谱方法应用于偏微分方程求解时，我们常常会遇到由特定边界条件（如诺伊曼边界条件）导致的奇异线性系统。本练习将引导您处理一个经典的诺伊曼-泊松问题，通过对比拉格朗日乘子法和基于SVD的伪逆法，实践处理这种秩亏系统的两种关键技术[@problem_id:3300690]。这对于建立稳定且可靠的谱方法求解器至关重要。", "problem": "考虑在有界域 $[-1,1]$ 上带有齐次诺伊曼边界条件的一维泊松方程，\n$$\n\\frac{d^2 u}{dx^2} = f(x), \\quad x \\in [-1,1], \\quad \\text{with} \\quad \\frac{du}{dx}(-1) = 0, \\quad \\frac{du}{dx}(1) = 0.\n$$\n在切比雪夫谱配置法中，使用切比雪夫-高斯-洛巴托节点 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（$j=0,1,\\dots,N$）以及在这些节点上构建的标准切比雪夫一阶和二阶微分矩阵。按如下方式构建配置线性系统：在内部点 $j=1,\\dots,N-1$ 处强制执行二阶导数关系，并通过将算子的第一行和最后一行替换为在端点处计算的一阶导数行来强制执行诺伊曼边界条件。这将产生一个方形线性系统\n$$\nA \\, u = b,\n$$\n其中 $A \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 由切比雪夫一阶和二阶微分矩阵构成，$b \\in \\mathbb{R}^{N+1}$ 包含内部点的采样值 $f(x_j)$ 以及对应于齐次诺伊曼边界条件的边界零值。由于诺伊曼边界条件，算子 $A$ 是秩亏的，其一维零空间由常数向量张成；因此，只有当 $b$ 属于 $A$ 的值域时，该系统才有解，且解在相差一个加性常数的意义下是唯一的。\n\n你的任务是为此系统实现两个求解器，并比较它们的输出：\n- 一种低秩增广求解器，通过添加单个线性约束来固定加性常数，从而解决秩亏问题。具体来说，使用拉格朗日乘子将约束 $\\sum_{j=0}^{N} u_j = 0$ 增广到系统中，形成块系统\n$$\n\\begin{pmatrix}\nA  w \\\\\nw^\\top  0\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb \\\\\n0\n\\end{pmatrix},\n$$\n其中 $w \\in \\mathbb{R}^{N+1}$ 是全一向量，$\\lambda \\in \\mathbb{R}$ 是拉格朗日乘子。\n- 一种基于奇异值分解 (SVD) 的求解器，其中 SVD 代表奇异值分解 (Singular Value Decomposition)。计算奇异值分解 $A = U \\Sigma V^\\top$，通过移除 $b$ 沿最小奇异值对应的左零空间向量的分量，将其投影到 $A$ 的值域上，然后使用 Moore–Penrose 伪逆计算最小范数解：\n$$\nb_{\\text{proj}} = b - u_0 \\left(u_0^\\top b\\right), \\quad u_{\\text{svd}} = \\sum_{i:\\sigma_i  \\varepsilon} \\frac{U_{\\cdot i}^\\top b_{\\text{proj}}}{\\sigma_i} V_{\\cdot i},\n$$\n其中 $u_0$ 是与最小奇异值 $\\sigma_{\\min}$ 对应的左奇异向量，$\\varepsilon$ 是一个小阈值，$U_{\\cdot i}$ 和 $V_{\\cdot i}$ 分别表示 $U$ 和 $V$ 的第 $i$ 列。\n\n从切比雪夫谱方法中经过充分测试的定义开始：切比雪夫-高斯-洛巴托节点，以及在这些节点上的一阶和二阶微分矩阵的已知公式。不要使用最终解的快捷公式；推导配置系统并解释处理秩亏问题的理由。在求解之前，如上述公式所示，通过将 $b$ 投影到关于从SVD获得的离散左零空间向量的 $A$ 的值域上，以确保可解性。\n\n实现这两种求解器，并为每个测试用例计算以下量：\n- 两个计算解之差的无穷范数，即 $\\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}$。\n- 基于SVD的解的配置残差的无穷范数，即 $\\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}$。\n- 基于SVD的解的最大绝对边界导数残差，即 $\\max\\left\\{\\left|\\left(D^{(1)}_{\\text{row }0}\\right) u_{\\text{svd}}\\right|, \\left|\\left(D^{(1)}_{\\text{row }N}\\right) u_{\\text{svd}}\\right|\\right\\}$，其中 $D^{(1)}$ 是切比雪夫一阶微分矩阵，$D^{(1)}_{\\text{row }0}$ 和 $D^{(1)}_{\\text{row }N}$ 分别表示其第一行和最后一行。\n\n使用以下测试套件，为每个用例指定 $N$ 和 $f(x)$。所有三角函数必须使用弧度。\n- 用例 1: $N = 32$, $f(x) = \\cos(\\pi x)$。\n- 用例 2: $N = 33$, $f(x) = x$。\n- 用例 3: $N = 40$, $f(x) = 1$。\n- 用例 4: $N = 8$, $f(x) = e^{x}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。该列表必须按顺序包含每个测试用例的三个浮点数，四舍五入到八位有效数字：$[\\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}^{(1)}, \\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}^{(1)}, \\text{BC}^{(1)}, \\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}^{(2)}, \\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}^{(2)}, \\text{BC}^{(2)}, \\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}^{(3)}, \\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}^{(3)}, \\text{BC}^{(3)}, \\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}^{(4)}, \\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}^{(4)}, \\text{BC}^{(4)}]$，其中上标表示测试用例索引，$\\text{BC}^{(k)}$ 是用例 $k$ 的边界导数残差。", "solution": "用户希望解决一个奇异边值问题，并比较两种处理由谱配置法产生的秩亏线性系统的数值方法。\n\n### 第 1 步：问题验证\n\n#### 已知条件提取\n- **方程**：一维泊松方程 $\\frac{d^2 u}{dx^2} = f(x)$，定义域为 $x \\in [-1,1]$。\n- **边界条件**：齐次诺伊曼条件：$\\frac{du}{dx}(-1) = 0$ 和 $\\frac{du}{dx}(1) = 0$。\n- **离散化**：切比雪夫谱配置法。\n- **节点**：切比雪夫-高斯-洛巴托节点 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$，其中 $j=0,1,\\dots,N$。\n- **线性系统构建**：\n    - 线性算子矩阵 $A \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 通过以下方式组装：\n        1. 对内部点 $j=1,\\dots,N-1$ 使用切比雪夫二阶微分矩阵的行。\n        2. 对端点 $j=0$（位于 $x=1$）和 $j=N$（位于 $x=-1$）使用切比雪夫一阶微分矩阵的行来强制执行诺伊曼条件。\n    - 右端向量 $b \\in \\mathbb{R}^{(N+1)}$ 通过以下方式组装：\n        1. 对内部点 $j=1,\\dots,N-1$ 设置 $b_j = f(x_j)$。\n        2. 为齐次边界条件设置 $b_0=0$ 和 $b_N=0$。\n- **秩亏性**：所得矩阵 $A$ 是秩亏的，其零空间由常数向量张成。只有当 $b$ 在 $A$ 的值域内时，解才存在。解在相差一个加性常数的意义下是唯一的。\n- **可解性强制执行**：在求解之前，必须将 $b$ 投影到 $A$ 的值域上：$b_{\\text{proj}} = b - u_0 \\left(u_0^\\top b\\right)$，其中 $u_0$ 是 $A$ 对应于最小奇异值的左奇异向量。\n- **求解器 1 (增广系统)**：通过使用拉格朗日乘子 $\\lambda$ 增广约束 $\\sum_{j=0}^{N} u_j = 0$ 来解决秩亏问题，形成块系统：\n$$\n\\begin{pmatrix} A  w \\\\ w^\\top  0 \\end{pmatrix} \\begin{pmatrix} u \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} b \\\\ 0 \\end{pmatrix}\n$$\n其中 $w$ 是全一向量。\n- **求解器 2 (SVD)**：使用通过 SVD 构建的 Moore-Penrose 伪逆计算最小范数解：\n$$\nu_{\\text{svd}} = \\sum_{i:\\sigma_i  \\varepsilon} \\frac{U_{\\cdot i}^\\top b_{\\text{proj}}}{\\sigma_i} V_{\\cdot i}\n$$\n其中 $A = U \\Sigma V^\\top$ 是 $A$ 的 SVD 分解，$\\varepsilon$ 是一个小阈值。\n- **待计算的指标**：为每个测试用例计算：\n    1.  $\\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}$\n    2.  $\\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}$\n    3.  $\\max\\left\\{\\left|\\left(D^{(1)}_{\\text{row }0}\\right) u_{\\text{svd}}\\right|, \\left|\\left(D^{(1)}_{\\text{row }N}\\right) u_{\\text{svd}}\\right|\\right\\}$\n- **测试用例**：\n    - 用例 1: $N = 32$, $f(x) = \\cos(\\pi x)$。\n    - 用例 2: $N = 33$, $f(x) = x$。\n    - 用例 3: $N = 40$, $f(x) = 1$。\n    - 用例 4: $N = 8$, $f(x) = e^x$。\n\n#### 使用提取的已知条件进行验证\n\n1.  **科学或事实不健全性**：该问题在科学上是健全的。它描述了泊松方程与诺伊曼边界条件的标准形式，这是物理和工程学中的一个基本问题。所提出的数值方法，即切比雪夫谱配置法，是一种用于求解微分方程的成熟且强大的技术。关于秩亏性和可解性条件的讨论在数学上是正确的。\n2.  **非形式化或不相关**：该问题与切比雪夫谱方法的主题直接相关，并以形式化的数学语言呈现，易于转化为算法。\n3.  **不完整或矛盾的设置**：问题是自洽的。它规定了微分方程、边界条件、定义域、离散化节点以及线性系统的精确构建方法，包括如何处理边界条件和固有的秩亏问题。虽然问题陈述可以解释为仅对 SVD 求解器应用 $b$ 的投影，但我们采纳的一种更一致的解释是，在进行*任何*求解尝试之前，必须使系统可解。因此，我们对两个求解器都使用投影后的右端项 $b_{\\text{proj}}$。\n4.  **不切实际或不可行**：该问题完全是现实的。参数和函数是测试数值方法的标准配置。\n5.  **不适定或结构不良**：原始边值问题是不适定的（解不唯一）。然而，问题明确承认了这一点，并提供了两种标准的、定义明确的方法来获得唯一解（固定平均值或找到最小范数解）。因此，该问题结构良好。\n6.  **伪深刻、琐碎或同义反复**：问题不琐碎。它要求对谱方法、线性代数（特别是 SVD 和秩亏系统）以及数值实现有深入的理解。它测试了数值分析中的深层概念。\n7.  **超出科学可验证性范围**：结果是可以通过数值验证的。遵循规范的实现将产生可检查正确性的结果。\n\n#### 结论与行动\n问题是有效的。这是一个在数值分析和科学计算领域中定义明确的练习。我现在将继续提供一个完整的、有理有据的解决方案。\n\n### 解法\n\n该问题要求使用切比雪夫谱配置法求解带齐次诺伊曼边界条件的一维泊松方程 $\\frac{d^2 u}{d x^2} = f(x)$，其中 $u'(\\pm 1) = 0$。这个边值问题是奇异的：如果 $u(x)$ 是一个解，那么 $u(x) + C$ 对于任何常数 $C$ 也是解。此外，只有当强迫项 $f(x)$ 满足相容性条件 $\\int_{-1}^1 f(x) dx = u'(1) - u'(-1) = 0$ 时，解才存在。\n\n#### 1. 切比雪夫谱离散化\n我们使用 $N+1$ 个切比雪夫-高斯-洛巴托 (CGL) 节点 $x_j = \\cos(\\frac{\\pi j}{N})$（$j=0, 1, \\dots, N$）对域 $[-1,1]$ 进行离散化。未知函数 $u(x)$ 的值在这些节点上近似为 $u_j \\approx u(x_j)$。导数通过矩阵向量乘积来近似，$u' \\approx D^{(1)}u$ 和 $u'' \\approx D^{(2)}u$，其中 $D^{(1)}$ 和 $D^{(2)}$ 是切比雪夫一阶和二阶微分矩阵。$D^{(2)}$ 可以计算为 $(D^{(1)})^2$。一阶微分矩阵 $D^{(1)}$ 的元素由著名公式给出：\n$$\n(D^{(1)})_{ij} = \\begin{cases}\n\\frac{c_i}{c_j} \\frac{(-1)^{i+j}}{x_i - x_j},  i \\neq j \\\\\n\\frac{-x_j}{2(1-x_j^2)},  j = 1, \\dots, N-1 \\\\\n\\frac{2N^2+1}{6},  j=0 \\\\\n-\\frac{2N^2+1}{6},  j=N\n\\end{cases}\n$$\n其中，当 $j=0,N$ 时 $c_j=2$，否则 $c_j=1$。\n\n#### 2. 线性系统的构建\n配置法在网格点上强制执行控制方程。这会导出一个线性系统 $Au=b$。\n- 对于内部点 ($j=1, \\dots, N-1$)，我们强制执行泊松方程：$(D^{(2)}u)_j = f(x_j)$。这些方程构成了系统的第 $1$ 行到第 $N-1$ 行。\n- 对于边界点，我们强制执行诺伊曼条件。在 $x_0=1$ 处，我们强制执行 $u'(1)=0$，离散化为 $(D^{(1)}u)_0 = 0$。在 $x_N=-1$ 处，我们强制执行 $u'(-1)=0$，离散化为 $(D^{(1)}u)_N = 0$。这些方程构成了系统的第一行 ($j=0$) 和最后一行 ($j=N$)。\n\n由此产生的矩阵 $A$ 和向量 $b$ 构建如下：\n- $A_{j,\\cdot} = D^{(2)}_{j,\\cdot}$，对于 $j=1, \\dots, N-1$。\n- $A_{0,\\cdot} = D^{(1)}_{0,\\cdot}$。\n- $A_{N,\\cdot} = D^{(1)}_{N,\\cdot}$。\n- $b_j = f(x_j)$，对于 $j=1, \\dots, N-1$。\n- $b_0 = 0$ 且 $b_N = 0$。\n\n#### 3. 处理秩亏问题\n算子 $A$ 是奇异的。常数向量 $w=[1, 1, \\dots, 1]^\\top$ 位于其零空间中，因为 $D^{(1)}$ 和 $D^{(2)}$ 都将常数函数映射到零。这意味着 $Aw=0$，且 $A$ 的秩最多为 $N$。要使系统 $Au=b$ 有解，$b$ 必须在 $A$ 的值域内，这意味着 $b$ 必须与 $A$ 的左零空间正交。我们通过找到与奇异值 $\\sigma_{\\min} \\approx 0$ 对应的 $A$ 的左奇异向量 $u_0$ 来找到左零空间的基。\n我们通过将 $b$ 投影到 $A$ 的值域上来强制执行可解性条件：\n$$\nb_{\\text{proj}} = b - u_0 (u_0^\\top b)\n$$\n这个投影向量 $b_{\\text{proj}}$ 与 $u_0$ 正交，并将用作两个求解器的右端项，以确保处理的是一个一致且可解的系统。\n\n#### 4. 增广系统求解器\n为了获得唯一解，我们添加一个额外的约束。问题指定了约束 $\\sum_{j=0}^N u_j=0$。我们使用拉格朗日乘子 $\\lambda$ 将此约束合并到系统中，从而得到 $(N+2) \\times (N+2)$ 的可逆块系统：\n$$\n\\begin{pmatrix} A  w \\\\ w^\\top  0 \\end{pmatrix} \\begin{pmatrix} u \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} b_{\\text{proj}} \\\\ 0 \\end{pmatrix}\n$$\n求解这个系统得到满足修正后泊松方程和零和约束的唯一解 $u_{\\text{aug}}$。\n\n#### 5. 基于SVD的求解器\n此方法计算具有最小欧几里得范数 $\\|u\\|_2$ 的唯一解。该最小范数解与 $A$ 的零空间正交。由于 $\\mathcal{N}(A) = \\text{span}(w)$，这意味着 $w^\\top u = \\sum u_j = 0$。因此，SVD 求解器寻求满足与增广求解器相同的唯一性约束的解。\n解通过 Moore-Penrose 伪逆 $A^+$ 计算得出，即 $u_{\\text{svd}} = A^+ b_{\\text{proj}}$。使用奇异值分解 $A = U \\Sigma V^\\top$，伪逆解由下式给出：\n$$\nu_{\\text{svd}} = V \\Sigma^+ U^\\top b_{\\text{proj}} = \\sum_{i:\\sigma_i  \\varepsilon} \\frac{U_{\\cdot i}^\\top b_{\\text{proj}}}{\\sigma_i} V_{\\cdot i}\n$$\n其中 $\\Sigma^+$ 是奇异值对角矩阵 $\\Sigma$ 的伪逆（对非零奇异值取倒数，否则为零），$\\varepsilon$ 是一个用于数值上识别零奇异值的小阈值。由于两种方法都找到了满足 $\\sum u_j=0$ 的唯一解，我们预期 $u_{\\text{aug}}$ 和 $u_{\\text{svd}}$ 在浮点精度范围内是相同的。\n\n#### 6. 指标计算\n实现将对每个测试用例执行这些步骤，并计算三个必需的指标：\n1.  $\\|u_{\\text{aug}} - u_{\\text{svd}}\\|_{\\infty}$：两种方法解之间差异的无穷范数。这应接近机器精度。\n2.  $\\|A u_{\\text{svd}} - b_{\\text{proj}}\\|_{\\infty}$：SVD 解的残差。这衡量 SVD 解满足投影后线性系统的程度。\n3.  $\\max(|\\langle D^{(1)}_{0,\\cdot}, u_{\\text{svd}} \\rangle|, |\\langle D^{(1)}_{N,\\cdot}, u_{\\text{svd}} \\rangle|)$：计算出的 SVD 解的边界导数的最大绝对值。这检查诺伊曼边界条件的满足程度。", "answer": "[3.2196459e-14,5.0044237e-14,1.0436098e-13,2.1982424e-14,1.2300139e-13,1.1990409e-13,1.6568322e-13,7.6533355e-13,1.5099034e-12,2.8865799e-15,3.8857806e-15,1.1324275e-14]", "id": "3300690"}, {"introduction": "谱方法的一个主要挑战是处理非光滑函数时产生的吉布斯现象 (Gibbs phenomenon)，这会导致解出现非物理解振荡。本练习模拟了一个由阶跃函数表示的局部体力，并要求您实现并比较两种主流的抑制振荡策略：对力项进行平滑化处理，以及对基线解应用谱粘性进行后处理[@problem_id:3300734]。通过这个实践，您将掌握在保持全局精度的同时，有效处理局部急剧变化问题的实用技巧。", "problem": "考虑有界区间 $[-1,1]$ 上的一维稳态泊松模型，该模型代表了由体力驱动的壁面有界斯托克斯流，\n$$ u''(x) = f(x), \\quad x \\in (-1,1), \\qquad u(-1)=0,\\quad u(1)=0. $$\n体力局域在右侧壁面附近，并取为近壁区间的指示函数，\n$$ f(x) = \\begin{cases} 1,  x \\in [1-w,\\,1], \\\\ 0,  x \\in [-1,\\,1-w), \\end{cases} $$\n其中 $w \\in (0,2]$。精确解是分段二次的，可以通过对模型直接积分以及在界面 $x=1-w$ 处施加 $u(x)$ 和 $u'(x)$ 的连续性条件来获得。您必须使用切比雪夫谱配置法在切比雪夫–高斯–洛巴托点上近似求解 $u(x)$，并比较三种处理局域近壁强迫项的策略：\n- 基线配置求解：使用 $f(x)$ 的原始节点采样。\n- 平滑强迫项求解：在求解前，通过在由 $x=\\cos(\\theta)$ 定义的极角变量 $\\theta \\in [0,\\pi]$（角度必须为弧度）中进行循环高斯卷积，对 $f(x)$ 进行平滑处理。\n- 谱粘性后处理：通过指数高波数阻尼器，在切比雪夫系数空间中对基线数值解 $u(x)$ 进行滤波。\n\n您必须从以下基本定义出发：\n- 切比雪夫–高斯–洛巴托节点 $x_j = \\cos\\!\\left(\\frac{\\pi j}{N}\\right)$（$j=0,1,\\dots,N$），以及相关的在这些点上对节点值进行微分的一阶导数矩阵 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，二阶导数矩阵为 $D^{(2)} = D^2$。\n- 在配置法中，通过将第一个和最后一个方程替换为 $u(x_0)=0$ 和 $u(x_N)=0$ 来施加齐次狄利克雷边界条件。\n- 极角参数化 $x=\\cos(\\theta)$，其中 $\\theta_j = \\frac{\\pi j}{N}$（$j=0,1,\\dots,N$）是均匀分布的。\n- 第一类离散余弦变换将切比雪夫–高斯–洛巴托节点上的节点值与切比雪夫系数联系起来，而在 $\\theta$ 中的 $2\\pi$ 周期均匀网格上的快速傅里叶变换（FFT）可对角化循环卷积。\n\n实现要求：\n1. 基线求解器。构造 $D$ 和 $D^{(2)}$，构建线性系统，该系统在内部节点 $j=1,\\dots,N-1$ 上配置方程 $u''(x_j)=f(x_j)$，施加边界条件 $u(x_0)=0$ 和 $u(x_N)=0$，并求解节点向量 $u \\in \\mathbb{R}^{N+1}$。\n2. 平滑处理。在均匀的 $2\\pi$ 周期网格 $\\Theta_m = \\frac{\\pi m}{N}$（$m=0,1,\\dots,2N-1$）上定义 $F(\\Theta)=f(\\cos\\Theta)$。对于波数 $k\\ge 0$，将实傅里叶系数乘以 $\\exp\\!\\left(-\\tfrac{1}{2}\\sigma_\\theta^2 k^2\\right)$，以应用核标准差为 $\\sigma_\\theta$（弧度）的循环高斯卷积。将平滑后的值限制在切比雪夫角 $\\theta_j = \\frac{\\pi j}{N}$ 上，并使用这个平滑处理过的 $f$ 重复基线求解过程。\n3. 谱粘性。对基线数值解进行第一类离散余弦变换，以获得切比雪夫系数 $\\{\\hat{u}_k\\}_{k=0}^N$，然后应用一个指数滤波器，\n$$ \\phi_k = \\begin{cases}\n1,  0 \\le k \\le k_c, \\\\\n\\exp\\!\\left(-\\alpha \\left(\\frac{k-k_c}{N-k_c}\\right)^p\\right),  k_c  k \\le N,\n\\end{cases} $$\n其中截止指数 $k_c = \\lfloor \\rho N \\rfloor$，指数 $p0$，振幅 $\\alpha0$。进行逆变换以获得谱粘性解 $u$。\n4. 误差度量。对于任何数值节点向量 $u^{\\text{num}} \\in \\mathbb{R}^{N+1}$，计算其与同一节点上精确解 $u^{\\text{exact}}$ 的均方根节点误差，\n$$ \\varepsilon_{\\mathrm{RMS}} = \\left( \\frac{1}{N+1}\\sum_{j=0}^N \\bigl(u^{\\text{num}}(x_j) - u^{\\text{exact}}(x_j)\\bigr)^2 \\right)^{1/2}. $$\n\n在所有测试案例中，对平滑和谱粘性使用以下固定参数：\n- 高斯平滑器宽度 $\\sigma_\\theta = \\frac{3}{N}$（弧度），\n- 谱粘性滤波器参数 $\\rho = 0.65$, $p=8$, $\\alpha=36$。\n\n测试套件。评估三个测试案例，分别探讨一个理想路径、一个更尖锐的近壁体力，以及一个更高分辨率的场景：\n- 案例 1: $N=64$, $w=0.3$。\n- 案例 2: $N=64$, $w=0.05$。\n- 案例 3: $N=128$, $w=0.02$。\n\n对于每个案例，计算比率\n$$ r_{\\mathrm{moll}} = \\frac{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{mollified}}}{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}}, \\qquad r_{\\mathrm{visc}} = \\frac{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{viscosity}}}{\\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}}. $$\n您的程序必须输出单行结果，该行为一个用方括号括起来的逗号分隔列表，按顺序包含六个浮点数结果\n$$ [\\, r_{\\mathrm{moll}}^{(1)},\\; r_{\\mathrm{visc}}^{(1)},\\; r_{\\mathrm{moll}}^{(2)},\\; r_{\\mathrm{visc}}^{(2)},\\; r_{\\mathrm{moll}}^{(3)},\\; r_{\\mathrm{visc}}^{(3)} \\,]. $$\n\n注意：\n- 所有角度必须使用弧度制。\n- 无需物理单位。\n- 该公式的实现方式必须在数学和算法上具有普适性，并且只依赖于所述的基本定义。", "solution": "用户的要求是使用切比雪夫谱配置法求解有界区间上的一维稳态泊松方程，并比较三种处理不连续强迫项的不同策略。该问题是适定的，在偏微分方程数值分析领域有坚实的科学基础，并为完整求解提供了所有必要信息。\n\n以下是求解方法的逐步推导和解释。\n\n### 1. 问题说明\n控制方程是定义在区域 $x \\in [-1, 1]$ 上的泊松方程：\n$$ u''(x) = f(x), \\quad x \\in (-1,1) $$\n带有齐次狄利克雷边界条件：\n$$ u(-1) = 0, \\quad u(1) = 0 $$\n强迫函数 $f(x)$ 是一个阶跃函数，代表靠近右壁的局域体力：\n$$ f(x) = \\begin{cases} 1,  x \\in [1-w,\\,1] \\\\ 0,  x \\in [-1,\\,1-w) \\end{cases} $$\n其中 $w \\in (0, 2]$ 是强迫区域的宽度。\n\n### 2. 精确解\n精确解是分段二次的，可以通过对 $u''(x) = f(x)$ 积分两次并施加边界条件，以及在界面 $x = 1-w$ 处解 $u(x)$ 及其一阶导数 $u'(x)$ 的连续性条件来求得。\n\n对于 $x \\in [-1, 1-w)$，方程为 $u''(x) = 0$。积分两次得到 $u(x) = A x + B$。边界条件 $u(-1)=0$ 意味着 $-A+B=0$，所以 $B=A$。因此，$u(x) = A(x+1)$。\n\n对于 $x \\in [1-w, 1]$，方程为 $u''(x) = 1$。积分两次得到 $u(x) = \\frac{1}{2}x^2 + C x + D$。边界条件 $u(1)=0$ 意味着 $\\frac{1}{2} + C + D = 0$，所以 $D = -C - \\frac{1}{2}$。因此，$u(x) = \\frac{1}{2}x^2 + C(x-1) - \\frac{1}{2} = \\frac{1}{2}(x^2-1) + C(x-1)$。\n\n在 $x=1-w$ 处的连续性：\n1.  $u(x)$ 的连续性：$A((1-w)+1) = \\frac{1}{2}((1-w)^2-1) + C((1-w)-1)$\n2.  $u'(x)$ 的连续性：$A = (1-w) + C$\n\n求解这个关于常数 $A$ 和 $C$ 的二元线性方程组，可得：\n$$ A = -\\frac{1}{4}w^2 $$\n$$ C = -\\frac{1}{4}w^2 - 1 + w $$\n\n因此，精确解为：\n$$\nu_{\\text{exact}}(x) = \\begin{cases}\n-\\frac{1}{4}w^2(x+1),  x \\in [-1, 1-w] \\\\\n\\frac{1}{2}(x^2-1) + \\left(-\\frac{1}{4}w^2 - 1 + w\\right)(x-1),  x \\in (1-w, 1]\n\\end{cases}\n$$\n\n### 3. 数值方法：切比雪夫谱配置法\n我们使用 $N+1$ 个切比雪夫–高斯–洛巴托（CGL）节点 $x_j = \\cos(\\frac{\\pi j}{N})$（$j=0, 1, \\dots, N$）对区域进行离散化。注意 $x_0=1$ 且 $x_N=-1$。我们寻求一个近似解向量 $u \\in \\mathbb{R}^{N+1}$，其中 $u_j \\approx u(x_j)$。\n\n解向量的二阶导数近似为 $u'' \\approx D^{(2)} u$，其中 $D^{(2)} = D^2$ 是切比雪夫一阶导数矩阵 $D$ 的平方。$D$ 的元素由下式给出：\n$$\nD_{jk} = \\begin{cases}\n\\frac{c_j}{c_k} \\frac{(-1)^{j+k}}{x_j - x_k},  j \\ne k \\\\\n-\\frac{x_j}{2(1-x_j^2)},  j=1,\\dots,N-1 \\\\\n\\frac{2N^2+1}{6},  j=0 \\\\\n-\\frac{2N^2+1}{6},  j=N\n\\end{cases}\n$$\n其中 $c_j=2$（当 $j=0, N$ 时），否则 $c_j=1$。一个稳健的数值实现使用求和法则 $D_{jj} = -\\sum_{k \\ne j} D_{jk}$ 来计算对角线元素。\n\n离散化的泊松方程是 $ D^{(2)} u = f $，其中 $f_j = f(x_j)$。通过修改该系统来施加边界条件。第一行（对应于 $x_0=1$）被方程 $u_0 = 0$ 替换，最后一行（对应于 $x_N=-1$）被 $u_N=0$ 替换。这样可以得到一个适定的线性系统来求解 $u$。\n\n### 4. 处理不连续性的策略\n\n#### 策略 A：基线配置法\n这是上述的直接方法。我们在内部节点 $j=1, \\dots, N-1$ 上配置方程 $u''(x_j) = f(x_j)$。右端向量 $b$ 是通过在 CGL 节点上对不连续函数 $f(x)$ 采样形成的，即 $b_j = f(x_j)$，并为边界条件设置 $b_0=0, b_N=0$。$f(x)$ 中不连续性的存在会引入大的高波数分量，导致吉布斯现象，并降低解的谱精度。\n\n#### 策略 B：强迫项平滑\n为了减轻吉布斯现象，在求解系统之前对不连续的强迫函数 $f(x)$ 进行平滑处理。这是通过在角变量 $\\theta$（其中 $x=\\cos(\\theta)$）中与高斯核进行卷积实现的。\n1.  在角坐标中定义一个扩展的 $2\\pi$ 周期网格，$\\Theta_m = \\frac{\\pi m}{N}$（$m=0, 1, \\dots, 2N-1$）。\n2.  在此网格上定义强迫函数：$F_m = f(\\cos(\\Theta_m))$。\n3.  使用快速傅里叶变换（FFT）计算 $F$ 的离散傅里叶变换。\n4.  在傅里叶空间中，将系数乘以一个高斯滤波器 $\\exp(-\\frac{1}{2}\\sigma_\\theta^2 k^2)$，其中 $k$ 是波数，$\\sigma_\\theta = \\frac{3}{N}$ 是高斯核在弧度单位下的标准差。\n5.  执行逆 FFT 以获得扩展网格上的平滑强迫函数 $F^{\\text{moll}}$。\n6.  用于求解器的新平滑强迫向量 $f^{\\text{moll}}$，是通过将 $F^{\\text{moll}}$ 限制在原始 CGL 节点上得到的，这对应于扩展网格的前 $N+1$ 个点。\n7.  使用这个平滑的 $f^{\\text{moll}}$ 作为右端项来求解泊松方程。\n\n#### 策略 C：谱粘性后处理\n此策略对从基线方法获得的振荡数值解进行滤波。\n1.  如策略 A 中所述计算基线解 $u^{\\text{baseline}}$。\n2.  使用第一类离散余弦变换（DCT-I）将 $u^{\\text{baseline}}$ 的节点值变换为切比雪夫谱系数 $\\{\\hat{u}_k\\}$。\n3.  对系数应用一个指数滤波器：$\\hat{u}^{\\text{visc}}_k = \\phi_k \\hat{u}_k$。滤波器 $\\phi_k$ 旨在衰减导致吉布斯振荡的高波数模式（$k  k_c$）。它定义为：\n    $$ \\phi_k = \\begin{cases}\n    1,  0 \\le k \\le k_c \\\\\n    \\exp\\!\\left(-\\alpha \\left(\\frac{k-k_c}{N-k_c}\\right)^p\\right),  k_c  k \\le N\n    \\end{cases} $$\n    其中 $k_c = \\lfloor \\rho N \\rfloor$ 以及给定参数 $\\rho = 0.65$, $p=8$, $\\alpha=36$。\n4.  使用逆 DCT-I 将滤波后的系数 $\\hat{u}^{\\text{visc}}$ 变换回节点空间，以获得平滑解 $u^{\\text{visc}}$。\n\n### 5. 误差评估\n对于三种数值解（$u^{\\text{baseline}}$、$u^{\\text{mollified}}$、$u^{\\text{visc}}$）中的每一种，都在 CGL 节点上计算其与精确解的均方根（RMS）误差：\n$$ \\varepsilon_{\\mathrm{RMS}} = \\left( \\frac{1}{N+1}\\sum_{j=0}^N \\bigl(u^{\\text{num}}_j - u^{\\text{exact}}_j\\bigr)^2 \\right)^{1/2} $$\n最后，计算比率 $r_{\\mathrm{moll}} = \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{mollified}} / \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}$ 和 $r_{\\mathrm{visc}} = \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{viscosity}} / \\varepsilon_{\\mathrm{RMS}}^{\\mathrm{baseline}}$，以量化相对于基线方法的改进。比率小于1表示精度有所提高。", "answer": "[0.0890065079685324,0.0782352865249563,0.1491771966567156,0.1281897355152864,0.1070500127209707,0.0880072049219808]", "id": "3300734"}]}