{"hands_on_practices": [{"introduction": "TENO 格式最显著的特点是其对候选模板采取的“全或无”的二进制选择策略。本练习 ([@problem_id:3369887]) 将引导您直接、具体地演练这一核心机制。通过处理给定的光滑度指示量和 TENO 参数的具体数值，您将亲手计算不连续性检测子并应用截断阈值，从而精确地理解该格式是如何筛选掉可能引起振荡的模板的。", "problem": "考虑一个一维守恒型双曲偏微分方程，以及在单元交界面上采用多个候选模板 $\\{S_k\\}$（索引为 $k \\in \\{0,1,2,3\\}$）的高阶有限体积重构。目标本质无振荡 (TENO) 格式旨在通过排除表现出非光滑行为的模板，同时仅保留那些被认为足够光滑的模板，从而在间断附近强制实现本质无振荡属性。令 $\\beta_k$ 表示与模板 $S_k$ 相关联的光滑度指示子（在加权本质无振荡 (WENO) 方法中使用），$\\tau$ 为全局光滑度参考尺度，$q$ 为灵敏度指数，$C_T$ 为截断阈值，$\\epsilon$ 为一个小的正则化参数。\n\n定义 TENO 间断检测器\n$$\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q},$$\n和二进制接纳掩模\n$$\n\\chi_k = \\begin{cases}\n1,  \\text{if } \\delta_k > C_T \\\\\n0,  \\text{if } \\delta_k \\le C_T\n\\end{cases}\n$$\n这样只有满足 $\\chi_k = 1$ 的模板才被接纳用于重构。\n\n从一个可接纳的模板必须显著比全局参考更光滑的原则出发，论证为何上述检测器可作为一个合适的单调选择机制，然后用以下数值输入计算得到的 $\\chi_k$：\n$$(\\beta_0,\\beta_1,\\beta_2,\\beta_3) = \\left(1.0 \\times 10^{-6},\\, 1.0 \\times 10^{-3},\\, 5.0 \\times 10^{-2},\\, 0.5\\right),$$\n$$\\tau = 0.5,\\quad q = 4,\\quad C_T = 1.0 \\times 10^{3},\\quad \\epsilon = 1.0 \\times 10^{-10}。$$\n\n确定被接纳模板的子集 $\\{k:\\chi_k=1\\}$，并将最终答案表示为单个行矩阵，其前四个条目是 $\\chi_0,\\chi_1,\\chi_2,\\chi_3$，随后是按升序排列的被接纳模板的索引。无需四舍五入，且不涉及物理单位。", "solution": "首先对问题进行有效性检查。\n\n### 第1步：提取已知条件\n- **背景**：一维守恒型双曲偏微分方程，高阶有限体积重构。\n- **候选模板**：$\\{S_k\\}$，索引为 $k \\in \\{0,1,2,3\\}$。\n- **光滑度指示子**：$\\beta_k$，用于每个模板 $S_k$。\n- **全局光滑度参考尺度**：$\\tau$。\n- **灵敏度指数**：$q$。\n- **截断阈值**：$C_T$。\n- **正则化参数**：$\\epsilon$。\n- **TENO 间断检测器**：$\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q}$。\n- **二进制接纳掩模**：$\\chi_k = \\begin{cases} 1,  \\text{if } \\delta_k > C_T \\\\ 0,  \\text{if } \\delta_k \\le C_T \\end{cases}$\n- **数值输入**：\n  - $(\\beta_0,\\beta_1,\\beta_2,\\beta_3) = \\left(1.0 \\times 10^{-6},\\, 1.0 \\times 10^{-3},\\, 5.0 \\times 10^{-2},\\, 0.5\\right)$\n  - $\\tau = 0.5$\n  - $q = 4$\n  - $C_T = 1.0 \\times 10^{3}$\n  - $\\epsilon = 1.0 \\times 10^{-10}$\n- **任务**：\n  1. 基于可接纳模板必须显著比全局参考更光滑的原则，解释为何该检测器是合适的单调选择机制。\n  2. 对给定的输入计算 $\\chi_k$。\n  3. 确定被接纳模板的子集 $\\{k:\\chi_k=1\\}$。\n  4. 将最终答案表示为单个行矩阵，其中包含 $(\\chi_0,\\chi_1,\\chi_2,\\chi_3)$，随后是被接纳模板的索引。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题植根于计算流体动力学这一成熟领域，具体涉及双曲守恒律的高阶数值方法。目标本质无振荡 (TENO) 格式、其参数（$\\beta_k$, $\\tau$, $q$, $C_T$）以及所定义的检测器均是标准的，并且根据科学文献（例如，Fu et al., Journal of Computational Physics, 2016）得到了准确的表述。\n- **适定性**：该问题是完全指定的。获得唯一解所需的所有定义、参数和数值均已提供。\n- **客观性**：问题陈述使用精确、客观和技术性的语言表达，没有任何主观性或偏见。\n- **完整性与一致性**：问题设定是完整的且内部一致。没有缺失数据或矛盾的约束。\n- **主题相关性**：该问题明确且正确地围绕“目标本质无振荡格式”这一主题。\n\n### 第3步：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解答与论证\n\n目标本质无振荡 (TENO) 格式的核心原则是使用候选模板的组合来构建高阶重构，但前提是必须先滤除任何受到间断或强梯度污染的模板。光滑度指示子 $\\beta_k$ 量化了了解在模板 $S_k$ 上的振荡行为水平。较小的 $\\beta_k$ 值表示在该模板上的函数更光滑，而较大的值则表明存在振荡或间断。\n\n问题指出，一个可接纳的模板必须“显著比全局参考更光滑”。这意味着我们要求 $\\beta_k$ 远小于全局光滑度参考尺度 $\\tau$。TENO 间断检测器 $\\delta_k = \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q}$ 正是为测量这种相对光滑度而设计的。\n\n我们来分析函数 $\\delta_k(\\beta_k)$。\n1.  **比率**：项 $\\frac{\\tau}{\\beta_k + \\epsilon}$ 将模板的光滑度与参考尺度进行比较。正则化参数 $\\epsilon$ 是一个小的正常数，用于防止在 $\\beta_k = 0$（这发生在常数或线性场中）时出现除以零的情况。如果模板 $S_k$ 非常光滑（即 $\\beta_k \\ll \\tau$），这个比率将是一个很大的正数。如果模板不光滑（即 $\\beta_k$ 与 $\\tau$ 同阶或更大），这个比率将是 $1$ 或更小。\n2.  **灵敏度指数**：指数 $q$（其中 $q > 1$，这里 $q=4$）用于放大“光滑”和“非光滑”模板之间的差异。大于 $1$ 的比率在取 $q$ 次幂后会变得更大，而小于 $1$ 的比率则会变得更小。这为接纳与否创造了一个更清晰、更具决定性的标准。\n3.  **单调性**：检测器 $\\delta_k$ 是光滑度指示子 $\\beta_k$ 的严格单调递减函数。为了正式证明这一点，我们可以考察它对 $\\beta_k$ 的导数：\n    $$ \\frac{d\\delta_k}{d\\beta_k} = \\frac{d}{d\\beta_k} \\left[ \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q} \\right] = q \\left(\\frac{\\tau}{\\beta_k + \\epsilon}\\right)^{q-1} \\cdot \\left( -\\frac{\\tau}{(\\beta_k + \\epsilon)^2} \\right) = -q \\frac{\\tau^q}{(\\beta_k + \\epsilon)^{q+1}} $$\n    由于 $\\tau > 0$、$q > 0$ 且 $\\beta_k + \\epsilon > 0$，导数 $\\frac{d\\delta_k}{d\\beta_k}$ 总是负的。这证实了随着模板变得不那么光滑（即 $\\beta_k$ 增大），其检测器 $\\delta_k$ 的值会减小。\n\n这种单调关系使 $\\delta_k$ 成为一个理想的选择机制。一个简单的阈值测试 $\\delta_k > C_T$ 直接转化为对可接受的非光滑度 $\\beta_k$ 的一个上界。通过设置一个大的截断阈值 $C_T$，TENO 格式确保只有那些比参考尺度光滑得多（从而导致一个非常大的 $\\delta_k$）的模板被接纳，从而有力地防止了间断附近的伪振荡。\n\n现在，我们使用提供的数值输入为每个模板计算接纳掩模 $\\chi_k$：\n- $\\tau = 0.5$\n- $q = 4$\n- $C_T = 1.0 \\times 10^{3}$\n- $\\epsilon = 1.0 \\times 10^{-10}$\n- $(\\beta_0, \\beta_1, \\beta_2, \\beta_3) = (1.0 \\times 10^{-6}, 1.0 \\times 10^{-3}, 5.0 \\times 10^{-2}, 0.5)$\n\n对于每个 $k \\in \\{0,1,2,3\\}$，我们计算 $\\delta_k$ 并将其与 $C_T$ 进行比较。项 $\\epsilon$ 比任何给定的 $\\beta_k$ 都小很多个数量级（除了这里未出现的理想情况），因此 $\\beta_k + \\epsilon \\approx \\beta_k$。\n\n- **模板 $S_0$ ($k=0$):**\n  $\\beta_0 = 1.0 \\times 10^{-6}$\n  $$ \\delta_0 = \\left(\\frac{0.5}{1.0 \\times 10^{-6} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{1.0 \\times 10^{-6}}\\right)^4 = (5.0 \\times 10^5)^4 = 625 \\times 10^{20} = 6.25 \\times 10^{22} $$\n  因为 $6.25 \\times 10^{22} > 1.0 \\times 10^{3}$，我们有 $\\delta_0 > C_T$。因此，$\\chi_0 = 1$。模板 $S_0$ 被接纳。\n\n- **模板 $S_1$ ($k=1$):**\n  $\\beta_1 = 1.0 \\times 10^{-3}$\n  $$ \\delta_1 = \\left(\\frac{0.5}{1.0 \\times 10^{-3} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{1.0 \\times 10^{-3}}\\right)^4 = (5.0 \\times 10^2)^4 = 625 \\times 10^8 = 6.25 \\times 10^{10} $$\n  因为 $6.25 \\times 10^{10} > 1.0 \\times 10^{3}$，我们有 $\\delta_1 > C_T$。因此，$\\chi_1 = 1$。模板 $S_1$ 被接纳。\n\n- **模板 $S_2$ ($k=2$):**\n  $\\beta_2 = 5.0 \\times 10^{-2}$\n  $$ \\delta_2 = \\left(\\frac{0.5}{5.0 \\times 10^{-2} + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{5.0 \\times 10^{-2}}\\right)^4 = \\left(\\frac{5.0 \\times 10^{-1}}{5.0 \\times 10^{-2}}\\right)^4 = (10)^4 = 1.0 \\times 10^4 $$\n  因为 $1.0 \\times 10^4 > 1.0 \\times 10^{3}$，我们有 $\\delta_2 > C_T$。因此，$\\chi_2 = 1$。模板 $S_2$ 被接纳。\n\n- **模板 $S_3$ ($k=3$):**\n  $\\beta_3 = 0.5$\n  $$ \\delta_3 = \\left(\\frac{0.5}{0.5 + 1.0 \\times 10^{-10}}\\right)^4 \\approx \\left(\\frac{0.5}{0.5}\\right)^4 = 1^4 = 1 $$\n  因为 $1 \\le 1.0 \\times 10^{3}$，我们有 $\\delta_3 \\le C_T$。因此，$\\chi_3 = 0$。模板 $S_3$ 被拒绝。\n\n由此得到的二进制接纳掩模向量是 $(\\chi_0, \\chi_1, \\chi_2, \\chi_3) = (1, 1, 1, 0)$。\n被接纳模板的子集对应于 $\\chi_k=1$ 的索引，即 $\\{k: \\chi_k = 1\\} = \\{0, 1, 2\\}$。\n\n最终答案要求一个行矩阵，其中包含接纳掩模的分量，随后是按升序排列的被接纳模板的索引。这对应于序列 $(1, 1, 1, 0, 0, 1, 2)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  1  1  0  0  1  2 \\end{pmatrix} } $$", "id": "3369887"}, {"introduction": "在理解 TENO 如何选择模板后，我们必须分析这种选择所带来的后果。本练习 [@problem_id:3369863] 探究了当一个模板在光滑区域被舍弃时，对格式形式精度的影响。通过泰勒级数分析，您将确定权重的重新归一化如何改变截断误差，从而揭示在鲁棒性与保持高阶精度之间的重要权衡。", "problem": "考虑常系数线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中 $a  0$），该方程定义在间距为 $\\Delta x$、网格点为 $x_{i} = i\\,\\Delta x$ 的均匀网格上。在有限差分 (FD) 格式中，右界面 $x_{i+\\frac{1}{2}}$ 处的数值通量是使用五阶形式精度目标本质无振荡 (TENO) 格式 (TENO5) 从单元中心点值 $\\{u_{i+m}\\}$ 重构的。TENO5 重构采用基于以下三个三点模板构建的三个候选二次多项式：\n- $S_{0} = \\{i-2, i-1, i\\}$,\n- $S_{1} = \\{i-1, i, i+1\\}$,\n- $S_{2} = \\{i, i+1, i+2\\}$.\n\n通过在这些模板上进行拉格朗日插值，定义 $x_{i+\\frac{1}{2}}$ 处的三个候选界面重构：\n- $p_{0} = \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i}$,\n- $p_{1} = -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1}$,\n- $p_{2} = \\frac{3}{8}\\,u_{i} + \\frac{3}{4}\\,u_{i+1} - \\frac{1}{8}\\,u_{i+2}$.\n\n当所有三个候选模板都被接纳时，能提供五阶线性迎风通量的最优线性权重为 $d_{0} = \\frac{1}{10}$、$d_{1} = \\frac{6}{10}$ 和 $d_{2} = \\frac{3}{10}$。在 TENO 的目标选择步骤中，准入掩码 $\\boldsymbol{\\chi}$ 在权重归一化之前保留或排除候选模板。考虑特定的准入掩码\n$$\n\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,],\n$$\n该掩码排除了右偏模板 $S_{2}$，同时接纳了 $S_{0}$ 和 $S_{1}$。\n\n任务：\n1. 通过在接纳集合上对 $\\{d_{0}, d_{1}\\}$进行归一化，并将被排除的权重设置为零，计算接纳模板的重计算线性权重 $\\tilde{d}_{k}$。\n2. 使用关于 $x_{i+\\frac{1}{2}}$ 的泰勒级数分析，确定由凸组合 $\\tilde{d}_{0}\\,p_{0} + \\tilde{d}_{1}\\,p_{1}$ 形成的界面重构的截断误差中 $\\Delta x$ 的主导幂，从而确定该界面值在光滑区域的最终形式精度阶 $p$。\n\n将最终答案表示为单个行矩阵，其中包含按顺序排列的三个重计算权重 $(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2})$，后跟整数 $p$。无需四舍五入，也无需单位。", "solution": "用户希望解决一个基于特定数值格式的问题。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n-   **方程：** 常系数线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a  0$。\n-   **网格：** 间距为 $\\Delta x$，网格点为 $x_{i} = i\\,\\Delta x$ 的均匀网格。\n-   **格式：** 五阶形式精度目标本质无振荡 (TENO) 格式 (TENO5)。\n-   **候选模板：**\n    -   $S_{0} = \\{i-2, i-1, i\\}$\n    -   $S_{1} = \\{i-1, i, i+1\\}$\n    -   $S_{2} = \\{i, i+1, i+2\\}$\n-   **$x_{i+\\frac{1}{2}}$ 处的候选重构：**\n    -   $p_{0} = \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i}$\n    -   $p_{1} = -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1}$\n    -   $p_{2} = \\frac{3}{8}\\,u_{i} + \\frac{3}{4}\\,u_{i+1} - \\frac{1}{8}\\,u_{i+2}$\n-   **五阶最优线性权重：** $d_{0} = \\frac{1}{10}$，$d_{1} = \\frac{6}{10}$，$d_{2} = \\frac{3}{10}$。\n-   **准入掩码：** $\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,]$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它是计算流体力学领域内的一个标准分析问题，特别涉及高阶有限差分方法。所有提供的数据，包括候选模板的拉格朗日插值系数和最优线性权重，均与关于 TENO 和 WENO 格式的既有文献一致。任务定义清晰，并提供了所有必要信息。因此，该问题有效。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n**第 1 部分：计算重计算的线性权重 $\\tilde{d}_{k}$**\n\n五阶格式的初始线性权重集为 $\\{d_{0}, d_{1}, d_{2}\\} = \\{\\frac{1}{10}, \\frac{6}{10}, \\frac{3}{10}\\}$。准入掩码 $\\boldsymbol{\\chi} = [\\,1,\\,1,\\,0\\,]$ 表示候选模板 $S_{0}$ 和 $S_{1}$ 被接纳，而 $S_{2}$ 被排除。\n\n根据所述程序，通过对接纳模板的原始权重进行归一化来找到重计算权重 $\\{\\tilde{d}_{k}\\}$。被排除模板的权重设置为零。\n\n接纳模板的原始权重之和为：\n$$\nd_{\\text{admitted}} = d_{0} + d_{1} = \\frac{1}{10} + \\frac{6}{10} = \\frac{7}{10}\n$$\n接纳模板的重计算权重为：\n$$\n\\tilde{d}_{0} = \\frac{d_{0}}{d_{\\text{admitted}}} = \\frac{1/10}{7/10} = \\frac{1}{7}\n$$\n$$\n\\tilde{d}_{1} = \\frac{d_{1}}{d_{\\text{admitted}}} = \\frac{6/10}{7/10} = \\frac{6}{7}\n$$\n被排除模板的权重设置为零：\n$$\n\\tilde{d}_{2} = 0\n$$\n因此，重计算权重的向量为 $(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2}) = (\\frac{1}{7}, \\frac{6}{7}, 0)$。\n\n**第 2 部分：确定形式精度阶 $p$**\n\n新的界面重构 $u_{i+\\frac{1}{2}}^{\\text{recon}}$ 是接纳的候选重构的凸组合：\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = \\tilde{d}_{0}\\,p_{0} + \\tilde{d}_{1}\\,p_{1} + \\tilde{d}_{2}\\,p_{2} = \\frac{1}{7}\\,p_{0} + \\frac{6}{7}\\,p_{1}\n$$\n代入 $p_{0}$ 和 $p_{1}$ 的表达式：\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = \\frac{1}{7} \\left( \\frac{3}{8}\\,u_{i-2} - \\frac{5}{4}\\,u_{i-1} + \\frac{15}{8}\\,u_{i} \\right) + \\frac{6}{7} \\left( -\\frac{1}{8}\\,u_{i-1} + \\frac{3}{4}\\,u_{i} + \\frac{3}{8}\\,u_{i+1} \\right)\n$$\n我们收集每个点值 $u_{j}$ 的系数：\n-   $u_{i-2}$ 的系数： $\\frac{1}{7} \\cdot \\frac{3}{8} = \\frac{3}{56}$\n-   $u_{i-1}$ 的系数： $\\frac{1}{7} \\left(-\\frac{5}{4}\\right) + \\frac{6}{7} \\left(-\\frac{1}{8}\\right) = -\\frac{5}{28} - \\frac{6}{56} = -\\frac{10}{56} - \\frac{6}{56} = -\\frac{16}{56}$\n-   $u_{i}$ 的系数： $\\frac{1}{7} \\left(\\frac{15}{8}\\right) + \\frac{6}{7} \\left(\\frac{3}{4}\\right) = \\frac{15}{56} + \\frac{18}{28} = \\frac{15}{56} + \\frac{36}{56} = \\frac{51}{56}$\n-   $u_{i+1}$ 的系数： $\\frac{6}{7} \\left(\\frac{3}{8}\\right) = \\frac{18}{56}$\n\n因此，重构为：\n$$\nu_{i+\\frac{1}{2}}^{\\text{recon}} = c_{i-2}u_{i-2} + c_{i-1}u_{i-1} + c_{i}u_{i} + c_{i+1}u_{i+1}\n$$\n其中 $\\{c_{i-2}, c_{i-1}, c_i, c_{i+1}\\} = \\{\\frac{3}{56}, -\\frac{16}{56}, \\frac{51}{56}, \\frac{18}{56}\\}$。\n\n为了找到精度阶，我们围绕界面点 $x_{i+\\frac{1}{2}}$ 对每个 $u_{j}$ 进行泰勒级数展开。设 $u(x)$ 是一个光滑函数。值 $u_{j} = u(x_{j})$可以围绕 $x_{i+\\frac{1}{2}}$ 展开为：\n$$\nu_{j} = u(x_{i+\\frac{1}{2}} + (j-i-\\frac{1}{2})\\Delta x) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_{i+\\frac{1}{2}})}{k!} \\left((j-i-\\frac{1}{2})\\Delta x\\right)^k\n$$\n重构 $u_{i+\\frac{1}{2}}^{\\text{recon}}$ 逼近真值 $u(x_{i+\\frac{1}{2}})$。截断误差 $E$ 为 $u_{i+\\frac{1}{2}}^{\\text{recon}} - u(x_{i+\\frac{1}{2}})$。\n$$\nE = \\left(\\sum_{j} c_{j} - 1\\right) u + \\left(\\sum_{j} c_{j} s_{j} \\right) u' \\Delta x + \\frac{1}{2!} \\left(\\sum_{j} c_{j} s_{j}^{2} \\right) u'' (\\Delta x)^{2} + \\frac{1}{3!} \\left(\\sum_{j} c_{j} s_{j}^{3} \\right) u''' (\\Delta x)^{3} + \\dots\n$$\n其中 $u$ 及其导数在 $x_{i+\\frac{1}{2}}$ 处求值，而 $s_j$ 是网格点到界面的无量纲距离：\n-   $s_{i-2} = \\frac{x_{i-2} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i-2) - (i+\\frac{1}{2}) = -\\frac{5}{2}$\n-   $s_{i-1} = \\frac{x_{i-1} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i-1) - (i+\\frac{1}{2}) = -\\frac{3}{2}$\n-   $s_{i} = \\frac{x_{i} - x_{i+\\frac{1}{2}}}{\\Delta x} = i - (i+\\frac{1}{2}) = -\\frac{1}{2}$\n-   $s_{i+1} = \\frac{x_{i+1} - x_{i+\\frac{1}{2}}}{\\Delta x} = (i+1) - (i+\\frac{1}{2}) = \\frac{1}{2}$\n\n我们计算矩 $\\sum c_{j} s_{j}^{k}$：\n-   $k=0$：$\\sum c_{j} = \\frac{3 - 16 + 51 + 18}{56} = \\frac{56}{56} = 1$。误差中 $u$ 的系数为 $1-1=0$。\n-   $k=1$：$\\sum c_{j} s_{j} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2}) - 16(-\\frac{3}{2}) + 51(-\\frac{1}{2}) + 18(\\frac{1}{2}) \\right] = \\frac{1}{112} [-15 + 48 - 51 + 18] = \\frac{0}{112} = 0$。\n-   $k=2$：$\\sum c_{j} s_{j}^{2} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2})^{2} - 16(-\\frac{3}{2})^{2} + 51(-\\frac{1}{2})^{2} + 18(\\frac{1}{2})^{2} \\right] = \\frac{1}{56 \\cdot 4} [3(25) - 16(9) + 51(1) + 18(1)] = \\frac{1}{224} [75 - 144 + 51 + 18] = \\frac{144 - 144}{224} = 0$。\n-   $k=3$：$\\sum c_{j} s_{j}^{3} = \\frac{1}{56} \\left[ 3(-\\frac{5}{2})^{3} - 16(-\\frac{3}{2})^{3} + 51(-\\frac{1}{2})^{3} + 18(\\frac{1}{2})^{3} \\right] = \\frac{1}{56 \\cdot 8} [3(-125) - 16(-27) + 51(-1) + 18(1)] = \\frac{1}{448} [-375 + 432 - 51 + 18] = \\frac{450 - 426}{448} = \\frac{24}{448} = \\frac{3}{56}$。\n\n由于 $k=3$ 时的矩是第一个非零矩，因此截断误差中的主导项为：\n$$\nE = \\frac{1}{3!} \\left(\\sum_{j} c_{j} s_{j}^{3} \\right) u'''(\\Delta x)^{3} + O((\\Delta x)^{4}) = \\frac{1}{6} \\left(\\frac{3}{56}\\right) u'''(\\Delta x)^{3} + O((\\Delta x)^{4}) = \\frac{1}{112} u'''(\\Delta x)^{3} + O((\\Delta x)^{4})\n$$\n截断误差中 $\\Delta x$ 的主导幂是 $3$。因此，界面重构的形式精度阶为 $p=3$。\n\n最终答案将重计算的权重和精度阶组合成一个单行矩阵：$(\\tilde{d}_{0}, \\tilde{d}_{1}, \\tilde{d}_{2}, p)$。\n$$\n(\\frac{1}{7}, \\frac{6}{7}, 0, 3)\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{7}  \\frac{6}{7}  0  3\n\\end{pmatrix}\n}\n$$", "id": "3369863"}, {"introduction": "最后的练习将理论付诸实践。您将实现 TENO5 格式，并使用“人工解方法”(Method of Manufactured Solutions, MMS)进行网格加密研究——这是数值程序验证的标准流程。通过这项练习 [@problem_id:3369896]，您将能够通过实验验证格式在不同条件下的精度阶，并观察 TENO 截断参数对结果的直接影响，从而巩固从前一个练习 [@problem_id:3369863] 中获得的分析性见解。", "problem": "考虑一维线性平流方程与周期性边界条件，\n$$\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,$$\n在域 $[0,1]$ 上，其中平流速度 $a0$ 为常数。设一个光滑的构造解由下式给出\n$$u(x,t) = \\sin\\left(2\\pi\\left(x - a t\\right)\\right) + 0.1 \\sin\\left(4\\pi\\left(x - a t\\right)\\right),$$\n并考虑其在 $t=0$ 时的时间导数，该导数满足\n$$\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0} = -a \\left.\\frac{\\partial u}{\\partial x}\\right|_{t=0}, \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{t=0} = 2\\pi \\cos(2\\pi x) + 0.4\\pi \\cos(4\\pi x).$$\n\n使用具有 $N$ 个点的均匀网格，网格间距为 $\\Delta x = 1/N$，网格节点为 $x_i = i \\Delta x$，其中 $i = 0,1,\\dots,N-1$。定义一个半离散有限差分通量差分算子\n$$\\mathcal{L}_h(u)_i = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},$$\n其中 $F_{i+\\frac{1}{2}}$ 是界面 $x_{i+\\frac{1}{2}}$ 处的数值通量。对于 $a0$，使用 $u$ 的左偏重构得到 $u_{i+\\frac{1}{2}}^{-}$，并设置 $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$。该重构必须采用五阶目标本质无振荡 (TENO) 格式 (TENO5)。$x_{i+\\frac{1}{2}}$ 处的 TENO5 重构使用三个三点子模板，\n$$S_0=\\{i-2,i-1,i\\},\\quad S_1=\\{i-1,i,i+1\\},\\quad S_2=\\{i,i+1,i+2\\},$$\n具有以下候选界面值，\n$$p_0 = \\frac{2u_{i-2} - 7u_{i-1} + 11u_i}{6},\\quad p_1 = \\frac{-u_{i-1} + 5u_i + 2u_{i+1}}{6},\\quad p_2 = \\frac{2u_i + 5u_{i+1} - u_{i+2}}{6},$$\n及相应的线性权重\n$$d_0 = \\frac{1}{10},\\quad d_1 = \\frac{6}{10},\\quad d_2 = \\frac{3}{10}.$$\nJiang–Shu 光滑度指示子为\n$$\\beta_0 = \\frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \\frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2,$$\n$$\\beta_1 = \\frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \\frac{1}{4}(u_{i-1} - u_{i+1})^2,$$\n$$\\beta_2 = \\frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \\frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2,$$\n而全局光滑度指示子为\n$$\\tau_5 = |\\beta_0 - \\beta_2|.$$\n定义类 WENO-Z 的预权重，其指数为 $q$，小参数为 $\\epsilon$，如下所示\n$$\\tilde{w}_k = d_k \\left(1 + \\left(\\frac{\\tau_5}{\\beta_k + \\epsilon}\\right)^q\\right), \\quad k\\in\\{0,1,2\\},$$\n然后归一化以获得\n$$w_k = \\frac{\\tilde{w}_k}{\\sum_{j=0}^{2} \\tilde{w}_j}.$$\nTENO 模板剔除机制引入一个截断阈值 $C_T \\in (0,1)$ 并定义一个二元选择子\n$$\n\\chi_k = \\begin{cases}\n1,  \\text{if } w_k \\ge C_T \\\\\n0,  \\text{if } w_k  C_T\n\\end{cases}\n$$\n最终的 TENO 权重为\n$$\\alpha_k = \\frac{d_k \\chi_k}{\\sum_{j=0}^{2} d_j \\chi_j},$$\n约定如果 $\\sum_{j=0}^{2} d_j \\chi_j = 0$，则没有模板被选中，此时回退到使用线性权重，即 $\\alpha_k = d_k$。重构的界面值为\n$$u_{i+\\frac{1}{2}}^{-} = \\sum_{k=0}^{2} \\alpha_k\\, p_k.$$\n\n在网格节点 $x_i$ 处定义基于残差的误差\n$$\\mathcal{E}_i = \\mathcal{L}_h(u)_i - \\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i},$$\n并测量残差的离散 $L^1$-范数\n$$E(N) = \\sum_{i=0}^{N-1} |\\mathcal{E}_i| \\,\\Delta x.$$\n对于 $[0,N-1]$ 之外的所有索引，假设为周期性延拓。\n\n实现一个程序，针对一组网格尺寸和三种重构模式，通过对 $\\log(E(N))$ 与 $\\log(\\Delta x)$ 进行最小二乘拟合直线来计算实验精度阶，其斜率即为观测到的阶数。这三种模式是：\n- 模式 A (标准 TENO5)：目标本质无振荡格式，截断阈值 $C_T = 0.01$，指数 $q = 6$，小参数 $\\epsilon = 10^{-40}$，以及 $a = 1$。\n- 模式 B (Linear5 无剔除)：无模板剔除，即对所有 $k$ 设置 $\\chi_k = 1$，使用相同的 $a = 1$。\n- 模式 C (激进 TENO5)：与模式 A 相同，但使用更大的截断阈值 $C_T = 0.2$ 以在光滑区域引发模板剔除。\n\n使用网格尺寸 $N \\in \\{40,80,160,320\\}$。对于每种模式，计算所有 $N$ 对应的残差范数 $E(N)$ 列表，并将观测到的阶数确定为在 $\\left(\\log(\\Delta x), \\log(E(N))\\right)$ 空间中最佳拟合直线的斜率。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序为 $\\left[\\text{order}_{\\text{A}}, \\text{order}_{\\text{B}}, \\text{order}_{\\text{C}}\\right]$，其中每个条目都是一个浮点数。例如，一个有效的输出格式是 $[\\text{float},\\text{float},\\text{float}]$。\n\n要实现的测试套件：\n- 构造解参数：振幅 $1$ 和 $0.1$，波数 $2\\pi$ 和 $4\\pi$，平流速度 $a=1$。\n- 模式和参数：模式 A，参数为 $C_T=0.01$, $q=6$, $\\epsilon=10^{-40}$；模式 B，无剔除；模式 C，参数为 $C_T=0.2$, $q=6$, $\\epsilon=10^{-40}$。\n- 网格尺寸：$N=\\{40,80,160,320\\}$。\n\n所有数值结果都是无量纲的；不需要物理单位。最终输出必须是浮点数。三种模式的基于残差的观测阶数必须以上述单行格式报告。", "solution": "该问题要求实现并验证一个用于一维线性平流方程 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$（其中平流速度 $a  0$ 为常数）的五阶目标本质无振荡 (TENO5) 格式。验证过程使用构造解方法 (MMS) 进行，即预设一个光滑的解析解，并将其代入控制方程以定义源项，或者如本例中，定义初始值和精确导数值。目标是计算数值离散化的实验精度阶。\n\n问题在具有 $N$ 个点 $x_i = i \\Delta x$（其中 $\\Delta x = 1/N$）的均匀网格上进行离散化。在每个网格节点 $i$ 处，偏微分方程的半离散形式为 $\\frac{d u_i}{dt} = \\mathcal{L}_h(u)_i$，其中 $\\mathcal{L}_h(u)_i$ 是对空间导数项 $-a \\frac{\\partial u}{\\partial x}$ 的数值近似。对于此问题，$\\mathcal{L}_h(u)_i$ 由一个守恒的有限差分通量差分公式定义：\n$$\n\\mathcal{L}_h(u)_i = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}\n$$\n在单元 $i$ 和 $i+1$ 之间的界面 $x_{i+\\frac{1}{2}}$ 处的数值通量 $F_{i+\\frac{1}{2}}$ 是使用迎风方法确定的。由于平流速度 $a  0$，信息从左向右传播，通量定义为 $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$，其中 $u_{i+\\frac{1}{2}}^{-}$ 是在界面处对解 $u$ 的高阶重构，使用来自上游模板的数据。\n\n问题的核心在于使用 TENO5 格式计算这个重构值 $u_{i+\\frac{1}{2}}^{-}$。该格式旨在解的光滑区域实现高阶精度，同时避免在间断附近产生伪振荡。它分几个步骤进行：\n1.  **候选模板**：对于五阶重构，需要一个五点模板。TENO5 建立在 WENO 格式的基础上，通过考虑三个更小的三点子模板：$S_0=\\{i-2,i-1,i\\}$, $S_1=\\{i-1,i,i+1\\}$, 和 $S_2=\\{i,i+1,i+2\\}$。每个子模板 $S_k$ 用于构造一个二次多项式，然后在界面 $x_{i+\\frac{1}{2}}$ 处求值，得到一个候选重构值 $p_k$。这些候选值的特定线性组合，$u_{lin} = \\sum_{k=0}^{2} d_k p_k$，其中 $d_k$ 是最优线性权重，可以恢复五阶迎风重构。对于给定的左偏模板，权重为 $d_0=0.1$, $d_1=0.6$, $d_2=0.3$。\n\n2.  **光滑度测量**：解在每个子模板 $S_k$ 内的光滑度由 Jiang-Shu 光滑度指示子 $\\beta_k$ 测量。这些是每个模板的插值多项式的缩放导数的平方和。在光滑区域，$\\beta_k = O((\\Delta x)^4)$。\n\n3.  **非线性权重计算**：TENO5 格式与 WENO 格式一样，计算依赖于光滑度指示子 $\\beta_k$ 的非线性权重 $w_k$。一个大的 $\\beta_k$（表示一个较不光滑的模板，可能包含激波）会导致一个小的 $w_k$。问题指定了类 WENO-Z 权重，它还包含一个全局光滑度指示子 $\\tau_5 = |\\beta_0 - \\beta_2|$，以提高临界点附近的精度。\n\n4.  **模板选择（TENO 机制）**：这是 TENO 的决定性特征。TENO 不像 WENO 那样混合所有候选模板，而是旨在当解光滑时使用最优线性权重，并丢弃被间断污染的模板。根据截断阈值 $C_T$ 定义一个二元选择子 $\\chi_k$：\n    $$\n    \\chi_k = \\begin{cases} 1,  \\text{if } w_k \\ge C_T \\\\ 0,  \\text{if } w_k  C_T \\end{cases}\n    $$\n    这充当一个过滤器。如果一个模板的非线性权重 $w_k$ 大于或等于该阈值，它就被认为“足够好”，可以包含在最终的重构中。\n\n5.  **最终重构**：最终的 TENO 权重 $\\alpha_k$ 是通过对所选模板的线性权重进行重新归一化得到的：$\\alpha_k = d_k \\chi_k / \\sum_j d_j \\chi_j$。如果没有模板被选中（即 $\\sum_j d_j \\chi_j = 0$），格式会回退到五阶线性格式（$\\alpha_k=d_k$）以确保稳健性。最终的重构值为 $u_{i+\\frac{1}{2}}^{-} = \\sum_{k=0}^{2} \\alpha_k p_k$。\n\n误差由残差 $\\mathcal{E}_i = \\mathcal{L}_h(u)_i - \\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i}$ 来量化，其中 $\\mathcal{L}_h(u)_i$ 中的 $u$ 值和精确导数 $\\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0,i}$ 均由构造解 $u(x,t) = \\sin(2\\pi(x - at)) + 0.1 \\sin(4\\pi(x - at))$ 在时间 $t=0$ 时得到。总误差是离散 $L^1$-范数，$E(N) = \\sum_{i=0}^{N-1} |\\mathcal{E}_i| \\,\\Delta x$。\n\n精度阶 $p$ 是通过关系式 $E(N) \\approx C (\\Delta x)^p$ 实验确定的，这意味着 $\\log(E) \\approx \\log(C) + p \\log(\\Delta x)$。通过为一系列网格尺寸 $N \\in \\{40,80,160,320\\}$ 计算 $E(N)$，我们可以对 $(\\log(\\Delta x), \\log(E))$ 数据进行线性最小二乘回归。所得直线的斜率即为实验精度阶 $p$。\n\n三种模式测试了该格式的不同方面：\n-   **模式 A (标准 TENO5)**：当 $C_T=0.01$ 时，所有线性权重 $d_k$ 都大于 $C_T$。对于光滑解，非线性权重 $w_k$ 将收敛到 $d_k$。因此，所有模板都将被选中（$\\chi_k=1$），格式将恢复为五阶线性格式，预期精度阶接近 5。\n-   **模式 B (Linear5 无剔除)**：此模式强制 $\\chi_k=1$，明确使得 $\\alpha_k = d_k$。这是纯粹的五阶迎风线性格式，应表现出 5 阶的精度。\n-   **模式 C (激进 TENO5)**：使用较高的截断阈值 $C_T=0.2$，线性权重 $d_0=0.1$ 小于 $C_T$。在光滑区域，$w_0 \\approx d_0$，导致模板 $S_0$ 被剔除（$\\chi_0=0$）。最终的重构则由 $p_1$ 和 $p_2$ 的重新加权形成，通过泰勒级数分析可以表明，这会将局部重构降至二阶精度。预计这将导致整个格式的精度阶为 2。\n\n实现将使用 `numpy` 进行向量化以提高效率。对于每种模式，将为每个网格尺寸计算 $L^1$ 误差。然后，将使用 `scipy.stats.linregress` 找到对数-对数误差图的斜率，从而提供所需的精度阶。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Computes the experimental order of accuracy for TENO5 and related schemes\n    applied to the 1D linear advection equation using a manufactured solution.\n    \"\"\"\n\n    # --------------- Helper Functions ---------------\n\n    def u_exact(x, t, a):\n        \"\"\"Calculates the manufactured solution u(x,t).\"\"\"\n        return np.sin(2 * np.pi * (x - a * t)) + 0.1 * np.sin(4 * np.pi * (x - a * t))\n\n    def dudt_exact_t0(x, a):\n        \"\"\"Calculates the exact time derivative at t=0.\"\"\"\n        # dudx at t=0\n        dudx_t0 = 2 * np.pi * np.cos(2 * np.pi * x) + 0.4 * np.pi * np.cos(4 * np.pi * x)\n        # dudt = -a * dudx\n        return -a * dudx_t0\n\n    def compute_l1_residual(N, mode_params):\n        \"\"\"\n        Computes the L1-norm of the residual for a given grid size N and scheme mode.\n        \"\"\"\n        a = mode_params['a']\n        CT = mode_params['CT']\n        q = mode_params['q']\n        eps = mode_params['eps']\n        no_rejection = mode_params.get('no_rejection', False)\n\n        # 1. Grid and Initial Condition\n        dx = 1.0 / N\n        x = np.arange(N) * dx\n        u0 = u_exact(x, 0, a)\n        dudt_grid = dudt_exact_t0(x, a)\n\n        # 2. Vectorized Reconstruction\n        # Get stencil values with periodic boundary conditions using np.roll\n        u_im2 = np.roll(u0, 2)\n        u_im1 = np.roll(u0, 1)\n        u_i = u0\n        u_ip1 = np.roll(u0, -1)\n        u_ip2 = np.roll(u0, -2)\n\n        # Candidate reconstructions (polynomials p_k)\n        p0 = (2*u_im2 - 7*u_im1 + 11*u_i) / 6.0\n        p1 = (-u_im1 + 5*u_i + 2*u_ip1) / 6.0\n        p2 = (2*u_i + 5*u_ip1 - u_ip2) / 6.0\n        p_matrix = np.vstack([p0, p1, p2])\n\n        # Linear weights\n        d_weights = np.array([0.1, 0.6, 0.3]).reshape(3, 1)\n\n        if no_rejection:\n            # Mode B: corresponds to a standard 5th-order linear upwind scheme\n            alpha_weights = d_weights\n        else:\n            # Modes A and C: TENO5 scheme logic\n            # Smoothness indicators beta_k\n            b0 = (13./12.) * (u_im2 - 2*u_im1 + u_i)**2 + 0.25 * (u_im2 - 4*u_im1 + 3*u_i)**2\n            b1 = (13./12.) * (u_im1 - 2*u_i + u_ip1)**2 + 0.25 * (u_im1 - u_ip1)**2\n            b2 = (13./12.) * (u_i - 2*u_ip1 + u_ip2)**2 + 0.25 * (3*u_i - 4*u_ip1 + u_ip2)**2\n            beta_matrix = np.vstack([b0, b1, b2])\n\n            # Global smoothness indicator tau_5\n            tau5 = np.abs(b0 - b2)\n\n            # WENO-Z-like unnormalized weights\n            w_tilde = d_weights * (1.0 + (tau5 / (beta_matrix + eps))**q)\n            \n            # Normalized weights w_k\n            w_sum = np.sum(w_tilde, axis=0)\n            w_sum[w_sum == 0] = 1.0  # Avoid division by zero\n            w = w_tilde / w_sum\n\n            # TENO selector chi_k\n            chi = (w = CT).astype(float)\n            \n            # Final TENO weights alpha_k\n            d_chi = d_weights * chi\n            sum_d_chi = np.sum(d_chi, axis=0)\n            \n            alpha_weights = np.zeros_like(d_chi)\n            \n            # Identify indices for fallback and standard TENO\n            zero_mask = (sum_d_chi == 0)\n            nonzero_mask = ~zero_mask\n            \n            # Apply TENO weights for non-fallback cases\n            if np.any(nonzero_mask):\n                alpha_weights[:, nonzero_mask] = d_chi[:, nonzero_mask] / sum_d_chi[nonzero_mask]\n            \n            # Apply fallback (linear weights) where no stencils were selected\n            if np.any(zero_mask):\n                alpha_weights[:, zero_mask] = d_weights\n\n        # 3. Compute Fluxes and Residual\n        # Reconstructed interface values u_{i+1/2}^{-}\n        u_iphalf = np.sum(alpha_weights * p_matrix, axis=0)\n\n        # Numerical fluxes F_{i+1/2}\n        F_iphalf = a * u_iphalf\n        \n        # Fluxes at i-1/2 are a periodic shift of F_{i+1/2}\n        F_imhalf = np.roll(F_iphalf, 1)\n        \n        # Semi-discrete operator L_h(u)\n        Lh = -(F_iphalf - F_imhalf) / dx\n        \n        # Residual error at each node\n        error_i = Lh - dudt_grid\n        \n        # L1 norm of the residual\n        l1_norm = np.sum(np.abs(error_i)) * dx\n        \n        return l1_norm\n\n    # ------------------- Main Logic -------------------\n\n    # Define the grid sizes for the convergence study\n    N_vals = np.array([40, 80, 160, 320])\n    dx_vals = 1.0 / N_vals\n    \n    # Define the parameters for the three test modes\n    test_cases = [\n        {'name': 'A', 'a': 1.0, 'CT': 0.01, 'q': 6, 'eps': 1e-40},\n        {'name': 'B', 'a': 1.0, 'no_rejection': True, 'CT': 0, 'q': 1, 'eps': 1e-40},\n        {'name': 'C', 'a': 1.0, 'CT': 0.2, 'q': 6, 'eps': 1e-40},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        errors = []\n        for N in N_vals:\n            error = compute_l1_residual(N, case)\n            errors.append(error)\n        \n        errors = np.array(errors)\n        \n        # Perform linear regression on log-log data to find the order of accuracy\n        log_dx = np.log(dx_vals)\n        log_errors = np.log(errors)\n        \n        # The slope of the line is the experimental order of accuracy\n        slope, _, _, _, _ = stats.linregress(log_dx, log_errors)\n        \n        results.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]}]\")\n\nsolve()\n```", "id": "3369896"}]}