{"hands_on_practices": [{"introduction": "高阶有限体积法 (FVM) 的精度核心在于如何从单元的平均值出发，重构出单元内部解的分布。这是实现高阶格式的基本步骤，尤其对于像 MUSCL 这样的流行格式而言至关重要。此练习将引导你通过对三个相邻单元的平均值进行二次多项式拟合，从而推导出一种三阶精度的空间重构方法。通过这个实践，你将深刻理解单元平均值与解的逐点表示之间的联系，这是掌握高阶方法问题解决能力的关键一步 [@problem_id:3328997]。", "problem": "考虑一个由一维守恒律控制的光滑标量守恒量 $u(x)$，并使用有限体积法（FVM）进行离散化。设计算域被划分为一个均匀网格，网格间距为 $\\Delta x$，单元中心为 $x_i$，界面为 $x_{i\\pm \\frac{1}{2}} = x_i \\pm \\frac{\\Delta x}{2}$。单元 $i$ 内的单元平均值定义为 $\\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x) \\, dx$。假设 $u(x)$ 足够光滑，适合进行多项式重构，并忽略任何非线性限制。\n\n您的任务是为一个目标单元 $i$ 推导一个三阶精度的空间重构。方法是拟合一个二次多项式，记为 $p_i(x)$，形式为 $p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$，使得 $p_i(x)$ 在三个单元 $i-1$、$i$ 和 $i+1$ 上的单元平均值与给定值 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 相匹配。从单元平均值的定义和基本积分恒等式出发，推导系数 $a_i$、$b_i$ 和 $c_i$ 关于 $\\bar{u}_{i-1}$、$\\bar{u}_i$、$\\bar{u}_{i+1}$ 和 $\\Delta x$ 的表达式，然后计算左右界面值 $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$ 和 $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$。\n\n将您关于对 $\\left(p_i^{-},\\, p_i^{+}\\right)$ 的最终答案表示为关于 $\\bar{u}_{i-1}$、$\\bar{u}_i$、$\\bar{u}_{i+1}$ 和 $\\Delta x$ 的封闭形式代数表达式。无需四舍五入。", "solution": "该问题是有效的。它是守恒律数值方法领域中的一个标准的、适定的问题，具体涉及有限体积法（FVM）的高阶空间重构。\n\n设单元 $i$ 的二次重构多项式由下式给出\n$$p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$$\n其中 $x_i$ 是单元 $i$ 的中心。系数 $a_i$、$b_i$ 和 $c_i$ 是通过强制 $p_i(x)$ 在单元 $i-1$、$i$ 和 $i+1$ 上的单元平均值分别与已知的单元平均值 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 相匹配来确定的。这导出了一个三方程系统。\n\n在一个具有均匀网格间距 $\\Delta x$ 的通用单元 $j$ 上，$p_i(x)$ 的单元平均值为\n$$ \\frac{1}{\\Delta x} \\int_{x_j - \\frac{\\Delta x}{2}}^{x_j + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\bar{u}_j $$\n为了简化积分，我们引入一个局部无量纲坐标 $\\xi = \\frac{x-x_i}{\\Delta x}$，因此 $x = x_i + \\xi \\Delta x$ 且 $dx = \\Delta x \\, d\\xi$。多项式变为\n$$p_i(x(\\xi)) = a_i + b_i (\\Delta x \\xi) + c_i (\\Delta x \\xi)^2$$\n在单元 $j$ 上的积分是在区间 $\\xi \\in [\\frac{x_j-x_i}{\\Delta x} - \\frac{1}{2}, \\frac{x_j-x_i}{\\Delta x} + \\frac{1}{2}]$ 上进行的。\n\n我们现在将此应用于模板中的三个单元：$j=i$，$j=i-1$ 和 $j=i+1$。\n\n对于单元 $i$ ($j=i$):\n积分范围是 $x \\in [x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$，对应于 $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$。\n$$ \\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_i - \\frac{\\Delta x}{2}}^{x_i + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_i = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{1}{2}}^{\\frac{1}{2}} $$\n$$ \\bar{u}_i = a_i(1) + \\frac{1}{2} b_i \\Delta x (0) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(\\frac{1}{2}\\right)^3 - \\left(-\\frac{1}{2}\\right)^3 \\right) = a_i + \\frac{c_i (\\Delta x)^2}{12} \\quad (1)$$\n\n对于单元 $i-1$ ($j=i-1$):\n积分范围是 $x \\in [x_{i-1} - \\frac{\\Delta x}{2}, x_{i-1} + \\frac{\\Delta x}{2}] = [x_i - \\frac{3\\Delta x}{2}, x_i - \\frac{\\Delta x}{2}]$，对应于 $\\xi \\in [-\\frac{3}{2}, -\\frac{1}{2}]$。\n$$ \\bar{u}_{i-1} = \\int_{-\\frac{3}{2}}^{-\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i-1} = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{3}{2}}^{-\\frac{1}{2}} $$\n$$ \\bar{u}_{i-1} = a_i(1) + \\frac{1}{2} b_i \\Delta x \\left( \\left(-\\frac{1}{2}\\right)^2 - \\left(-\\frac{3}{2}\\right)^2 \\right) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(-\\frac{1}{2}\\right)^3 - \\left(-\\frac{3}{2}\\right)^3 \\right) $$\n$$ \\bar{u}_{i-1} = a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (2)$$\n\n对于单元 $i+1$ ($j=i+1$):\n积分范围是 $x \\in [x_{i+1} - \\frac{\\Delta x}{2}, x_{i+1} + \\frac{\\Delta x}{2}] = [x_i + \\frac{\\Delta x}{2}, x_i + \\frac{3\\Delta x}{2}]$，对应于 $\\xi \\in [\\frac{1}{2}, \\frac{3}{2}]$。\n$$ \\bar{u}_{i+1} = \\int_{\\frac{1}{2}}^{\\frac{3}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i+1} = a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (3)$$\n\n我们现在得到了一个关于 $a_i, b_i, c_i$ 的三元线性方程组：\n(1) $a_i + \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i$\n(2) $a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i-1}$\n(3) $a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i+1}$\n\n方程(3)减去方程(2)：\n$$ (\\bar{u}_{i+1} - \\bar{u}_{i-1}) = 2 b_i \\Delta x $$\n$$ b_i = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} $$\n\n方程(2)与方程(3)相加：\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2a_i + \\frac{13}{6} c_i (\\Delta x)^2 $$\n由方程(1)，我们有 $a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2$。将此代入相加后的方程：\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\left(\\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2\\right) + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i - \\frac{1}{6} c_i (\\Delta x)^2 + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i + \\frac{12}{6} c_i (\\Delta x)^2 = 2\\bar{u}_i + 2 c_i (\\Delta x)^2 $$\n求解 $c_i$：\n$$ 2 c_i (\\Delta x)^2 = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} $$\n$$ c_i = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} $$\n\n最后，我们使用方程(1)和 $c_i$ 的表达式来求 $a_i$：\n$$ a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i - \\frac{1}{12} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 $$\n$$ a_i = \\bar{u}_i - \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{24} = \\frac{24\\bar{u}_i - \\bar{u}_{i+1} + 2\\bar{u}_i - \\bar{u}_{i-1}}{24} $$\n$$ a_i = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} $$\n\n在确定了系数之后，我们可以求出界面值。\n左界面值为 $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$。在 $x = x_{i-\\frac{1}{2}} = x_i - \\frac{\\Delta x}{2}$ 处：\n$$ p_i^{-} = a_i - b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i - \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\n右界面值为 $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$。在 $x = x_{i+\\frac{1}{2}} = x_i + \\frac{\\Delta x}{2}$ 处：\n$$ p_i^{+} = a_i + b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i + \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\n\n我们来计算包含 $b_i$ 和 $c_i$ 的项：\n$$ \\frac{b_i \\Delta x}{2} = \\frac{1}{2} \\left( \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} \\right) \\Delta x = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} $$\n$$ \\frac{c_i (\\Delta x)^2}{4} = \\frac{1}{4} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n\n将这些项和 $a_i$ 代入 $p_i^{-}$ 的表达式中：\n$$ p_i^{-} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} - \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n通分，公分母为 $24$：\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) - 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-1+6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1-6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ 8\\bar{u}_{i-1} + 20\\bar{u}_i - 4\\bar{u}_{i+1} \\right] = \\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6} $$\n\n类似地，对于 $p_i^{+}$：\n$$ p_i^{+} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} + \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) + 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-1-6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1+6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ -4\\bar{u}_{i-1} + 20\\bar{u}_i + 8\\bar{u}_{i+1} \\right] = \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6} $$\n重构的左右界面值的最终表达式为：\n$$ p_i^{-} = \\frac{1}{6}(2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}) $$\n$$ p_i^{+} = \\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6}  \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6}\n\\end{pmatrix}\n}\n$$", "id": "3328997"}, {"introduction": "构建高阶格式之后，理解其引入的数值误差特性至关重要。局部截断误差 (LTE) 揭示了数值解与真实解之间的偏差，这些偏差在计算流体动力学中表现为色散（导致非物理振荡）和耗散（导致数值阻尼）效应。本练习将通过分析一个四阶中心差分格式的修正方程，让你亲手分离并识别其主导的色散和耗散误差项。这项实践能够让你深刻理解数值解出现伪振荡或过度耗散的根本原因，并学会如何从数学上描述这些效应 [@problem_id:3329059]。", "problem": "考虑一维（1D）线性平流偏微分方程（PDE）$u_{t} + a\\,u_{x} = 0$，其中平流速度 $a$ 为常数，解 $u(x,t)$ 足够光滑。该方程在间距为 $h$ 的均匀网格 $x_{i} = x_{0} + i h$ 上进行离散化。在计算流体力学（CFD）中，一种常用的一阶导数 $u_{x}$ 的高阶空间离散方法是在网格点 $x_{i}$ 处定义的四阶中心差分算子：\n$$D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h}。$$\n从该偏微分方程和局部截断误差（LTE）的定义（将精确解代入半离散格式得到的残差）出发，推导半离散格式 $u_{t} + a\\,D^{(1)}_{4} u = 0$ 的 LTE 的主阶表达式，用 $u$ 在 $x_{i}$ 处的空间导数来表示。然后，使用基于修正方程或傅里叶符号分析的数值色散和耗散的原则性表征，识别并表示与此空间离散相关的主色散误差项和主耗散误差项。您的最终答案应按以下顺序报告三项内容：达到 $h^{4}$ 阶的 LTE、主色散误差项和主耗散误差项，每一项都应是包含 $a$、$h$ 以及 $u$ 对 $x$ 的导数的单个闭式解析表达式。不需要进行数值舍入，最终表达式中也不应包含物理单位。", "solution": "该问题已经过验证，并被确定为有效。这是一个在计算流体力学领域中适定的、有科学依据的问题，要求对一种数值格式进行标准分析。\n\n分析按问题陈述的要求分三部分进行：首先，推导局部截断误差（LTE）；其次，推导主色散误差项；第三，识别主耗散误差项。\n\n1.  **局部截断误差（LTE）**\n\n半离散格式为 $\\frac{\\partial u}{\\partial t} + a\\,D^{(1)}_{4} u = 0$。在网格点 $x_i$ 处的局部截断误差 $\\tau_i$ 是将连续偏微分方程 $u_t + a\\,u_x = 0$ 的精确解 $u(x,t)$ 代入半离散格式后得到的残差。\n$$ \\tau_i = \\left(\\frac{\\partial u}{\\partial t}\\right)_i + a\\,D^{(1)}_{4} u_i $$\n对于精确解 $u(x,t)$，我们有 $\\left(\\frac{\\partial u}{\\partial t}\\right)_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i$。将此代入 LTE 的表达式中，得到：\n$$ \\tau_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i + a\\,D^{(1)}_{4} u_i = a \\left( D^{(1)}_{4} u_i - \\left(\\frac{\\partial u}{\\partial x}\\right)_i \\right) $$\n因此，半离散格式的 LTE 是平流速度 $a$ 乘以空间有限差分算子 $D^{(1)}_{4}$ 的截断误差。为求此截断误差，我们对点 $x_i$ 周围的项 $u_{i \\pm 1}$ 和 $u_{i \\pm 2}$ 进行泰勒级数展开。由于我们预期这是一个四阶格式，因此我们将展开到包含五阶导数的项。令 $u^{(n)} \\equiv \\frac{\\partial^n u}{\\partial x^n}\\big|_{x_i}$。\n$$ u_{i+k} = u(x_i+kh) = u_i + (kh)u^{(1)} + \\frac{(kh)^2}{2!}u^{(2)} + \\frac{(kh)^3}{3!}u^{(3)} + \\frac{(kh)^4}{4!}u^{(4)} + \\frac{(kh)^5}{5!}u^{(5)} + O(h^6) $$\n我们展开四个必要的项：\n$$ u_{i+1} = u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} + \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-1} = u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} - \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i+2} = u_i + 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} + \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} + \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-2} = u_i - 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} - \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} - \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n现在，我们将这些展开式代入算子 $D^{(1)}_{4} u_{i}$ 的定义中：\n$$ D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h} $$\n我们按 $u$ 的导数阶数将分子中的项分组：\n-   $u^{(0)}$ 项：$(-1 + 8 - 8 + 1)u_i = 0$。\n-   $u^{(1)}$ 项：$(-2h + 8(h) - 8(-h) + (-2h))u^{(1)} = ( -2 + 8 + 8 - 2 )h u^{(1)} = 12h u^{(1)}$。\n-   $u^{(2)}$ 项：$(-\\frac{4h^2}{2} + 8\\frac{h^2}{2} - 8\\frac{h^2}{2} + \\frac{4h^2}{2})u^{(2)} = ( -2 + 4 - 4 + 2 )h^2 u^{(2)} = 0$。\n-   $u^{(3)}$ 项：$(-\\frac{8h^3}{6} + 8\\frac{h^3}{6} - 8(-\\frac{h^3}{6}) - \\frac{8h^3}{6})u^{(3)} = ( -8 + 8 + 8 - 8 )\\frac{h^3}{6} u^{(3)} = 0$。\n-   $u^{(4)}$ 项：$(-\\frac{16h^4}{24} + 8\\frac{h^4}{24} - 8\\frac{h^4}{24} + \\frac{16h^4}{24})u^{(4)} = ( -16 + 8 - 8 + 16 )\\frac{h^4}{24} u^{(4)} = 0$。\n-   $u^{(5)}$ 项：$(-\\frac{32h^5}{120} + 8\\frac{h^5}{120} - 8(-\\frac{h^5}{120}) - \\frac{32h^5}{120})u^{(5)} = ( -32 + 8 + 8 - 32 )\\frac{h^5}{120} u^{(5)} = -48 \\frac{h^5}{120} u^{(5)} = -\\frac{2}{5} h^5 u^{(5)}$。\n\n将这些结果代回 $D^{(1)}_{4} u_{i}$ 的表达式中：\n$$ D^{(1)}_{4} u_{i} = \\frac{1}{12h} \\left( 12h u^{(1)} - \\frac{2}{5} h^5 u^{(5)} + O(h^7) \\right) = u^{(1)} - \\frac{2}{5 \\cdot 12} h^4 u^{(5)} + O(h^6) $$\n$$ D^{(1)}_{4} u_{i} = \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\n空间算子的截断误差是差值 $D^{(1)}_{4} u_{i} - (\\frac{\\partial u}{\\partial x})_i$，即 $-\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6)$。\n因此，半离散格式的 LTE 为：\n$$ \\tau_i = a \\left( -\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nLTE 的主阶项是 $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$。\n\n2.  **色散和耗散误差项**\n\n为了识别色散和耗散误差项，我们推导修正方程。修正方程是一个偏微分方程，数值格式对其的求解精度比对原始偏微分方程更高。它是通过将离散算子的泰勒展开式代入数值格式得到的。\n$$ \\frac{\\partial u}{\\partial t} + a D^{(1)}_{4} u = 0 \\implies \\frac{\\partial u}{\\partial t} + a \\left( \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = 0 $$\n将此方程重新整理，使左侧与原始偏微分方程的形式匹配：\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\n右侧的项代表了数值格式的误差。具有奇数阶空间导数的误差项是色散的，而具有偶数阶空间导数的项是耗散的（或反耗散的）。\n\n主误差项是 $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$。由于空间导数的阶数是 $5$（一个奇数），这是一个**色散误差项**。\n\n为了找到主耗散误差项，我们寻找误差展开式中最低阶的偶数阶导数项。算子 $D^{(1)}_{4}$ 是一个对称中心差分模板。这类用于逼近一阶导数的模板的一个特性是，其泰勒级数展开中的所有偶数阶导数项都会抵消。正如我们的推导所示，$u^{(2)}$ 和 $u^{(4)}$ 的系数都为零。这种模式对所有更高阶的偶数阶导数（$u^{(6)}, u^{(8)}, \\ldots$）都成立。因此，$D^{(1)}_{4}$ 的截断误差只包含奇数阶导数项：\n$$ D^{(1)}_{4} u - u_x = C_5 h^4 u^{(5)} + C_7 h^6 u^{(7)} + C_9 h^8 u^{(9)} + \\dots $$\n因此，修正方程的右侧将只包含奇数阶空间导数。不存在偶数阶导数项。由于耗散误差与偶数阶导数相关，该格式没有内在的数值耗散。\n\n因此，主色散误差项是 $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$，主耗散误差项是 $0$。\n\n所要求的三个表达式是：\n1.  LTE：$-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n2.  主色散误差项：$\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n3.  主耗散误差项：$0$", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}  \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}  0 \\end{pmatrix} } $$", "id": "3329059"}, {"introduction": "高阶格式在处理光滑流动时表现优异，但在激波等不连续处却容易产生伪振荡。现代数值方法需要一种“智能”机制来探测这些区域并局部地施加稳定化处理。本练习将介绍一种为间断伽辽金 (DG) 方法设计的模态光滑度探测器，它利用解在多项式基函数上的能量分布来量化解的光滑度。通过推导这一探测器，你将掌握一种连接谱方法理论与激波捕捉实践的强大技术，为构建稳健的自适应 CFD 求解器打下基础 [@problem_id:3329004]。", "problem": "考虑一个一维标量守恒律，该守恒律在参考单元 $\\left[-1,1\\right]$ 上使用 $p$ 次多项式空间通过间断伽辽金（DG）方法进行离散。设DG近似在一个$L^{2}$-正交模态基 $\\{\\phi_{k}(x)\\}_{k=0}^{p}$（例如，正交化的勒让德多项式）中展开，使得\n$$\nu_{h}(x) \\;=\\; \\sum_{k=0}^{p} a_{k} \\,\\phi_{k}(x),\n$$\n其模态系数为 $\\{a_{k}\\}_{k=0}^{p}$。从单元上的 $L^{2}$ 能量的定义 $E \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx$ 和基的正交性出发，推导一个模态光滑度传感器，该传感器用于比较最高次多项式模态（即 $k=p$）所包含的能量与总能量。您的推导必须引入一个无量纲光滑度指示器 $s$，该指示器使用一个适当的能量比的以10为底的对数来表示，并且即使在最高阶模态系数为零时也保持良定义。\n\n接下来，仅使用对于一个足够光滑的函数，当 $k \\to \\infty$ 时其模态振幅渐近衰减如 $a_{k} \\sim C\\,k^{-q}$（其中 $q0$）的假设，推导一个依赖于多项式次数的阈值 $s_{\\mathrm{th}}(p)$，当 $s  s_{\\mathrm{th}}(p)$ 时激活人工粘性。指定一个实用的渐变策略，使得粘性在两个依赖于次数的阈值 $s_{0}(p)$ 和 $s_{1}(p)$（其中 $s_{0}(p)  s_{1}(p)$）之间从零过渡到最大值 $\\nu_{\\max}$。\n\n最后，对于一个多项式次数为 $p = 5$ 且模态系数为\n$$\na_{0} = 1.2,\\quad a_{1} = 0.3,\\quad a_{2} = 0.08,\\quad a_{3} = 0.02,\\quad a_{4} = 0.004,\\quad a_{5} = 0.001,\n$$\n的特定单元，计算该单元上传感器 $s$ 的值。将您的答案四舍五入到4位有效数字。该传感器是无量纲的；只报告数值。", "solution": "该问题要求为间断伽辽金（DG）方法推导一个模态光滑度传感器、一个用于激活人工粘性的相关阈值，并对一个特定情况下的传感器进行数值评估。我们将首先验证问题陈述的有效性，然后提供一个严谨的、分步的解答。\n\n该问题被认定是有效的。它在科学上基于守恒律数值方法的既定理论，特别是高阶DG方法和激波捕捉。其前提，包括使用正交模态基和光滑函数的模态系数渐近衰减，是该领域的标准做法。该问题是自洽的、适定的和客观的，没有明显的矛盾或歧义。\n\n我们现在开始解答。\n\n首先，我们推导用模态系数表示的单元上的 $L^2$ 能量 $E$ 的表达式。DG近似由 $u_{h}(x) = \\sum_{k=0}^{p} a_{k} \\phi_{k}(x)$ 给出。在参考单元 $[-1, 1]$ 上的能量 $E$ 定义为：\n$$\nE \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx\n$$\n代入 $u_h(x)$ 的模态展开式：\n$$\nE = \\int_{-1}^{1} \\left( \\sum_{j=0}^{p} a_{j} \\phi_{j}(x) \\right) \\left( \\sum_{k=0}^{p} a_{k} \\phi_{k}(x) \\right) \\,dx\n$$\n根据线性性质，我们可以交换求和与积分的顺序：\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx\n$$\n基函数 $\\{\\phi_k(x)\\}$ 被规定为 $L^2$-正交的，这意味着它们的内积满足 $\\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克δ函数。应用此性质可简化能量的表达式：\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\delta_{jk} = \\sum_{k=0}^{p} a_{k}^{2}\n$$\n这个结果是帕塞瓦尔定理的有限维版本。总能量 $E_{\\mathrm{total}}$ 是模态系数的平方和。单个模态 $k$ 中包含的能量就是 $E_k = a_k^2$。\n\n接下来，我们推导模态光滑度传感器 $s$。该传感器需要将最高阶模态（$k=p$）中的能量 $E_p=a_p^2$ 与总能量 $E_{\\mathrm{total}} = \\sum_{k=0}^{p} a_{k}^{2}$ 进行比较。我们定义比率 $\\mathcal{R}$ 为：\n$$\n\\mathcal{R} = \\frac{E_p}{E_{\\mathrm{total}}} = \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}}\n$$\n我们假设数值解不恒为零，所以 $\\sum_{k=0}^{p} a_{k}^{2}  0$。光滑度指示器 $s$ 用该比率的以10为底的对数定义：\n$$\ns = \\log_{10}(\\mathcal{R}) = \\log_{10} \\left( \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}} \\right)\n$$\n该指示器是无量纲的，符合要求。对于一个带有不连续性（激波）的解，大部分能量被散射到高频模态中，使得 $a_p$ 相对较大。在函数完全由最高阶模态构成（例如 $u_h \\propto \\phi_p$）的极限情况下，我们有 $\\mathcal{R}=1$ 和 $s=0$。对于一个非常光滑的解，模态系数快速衰减，使得 $a_p$ 非常小，这会导致 $s$ 成为一个大的负值。问题要求传感器即使在 $a_p=0$ 时也保持良定义。在这种情况下，$\\mathcal{R}=0$。当 $x \\to 0^+$ 时，$\\log_{10}(x)$ 的极限是 $-\\infty$。这个极限值在数学上是良定义的，并正确地表示了一个相对于 $p$ 次多项式基是完全光滑的解（即，它是一个次数至多为 $p-1$ 的多项式）。因此，这个公式满足了所述要求。\n\n第二，我们推导依赖于多项式次数的阈值 $s_{\\mathrm{th}}(p)$。我们将使用这样的假设：对于一个足够光滑的函数，当 $k \\to \\infty$ 时，其模态系数衰减为 $a_k \\sim C k^{-q}$，其中 $C$ 和 $q0$ 是常数。这个渐近行为将被用来表征一个良解析数值解的传感器值。使用这个关系对 $k \\in \\{1, \\dots, p\\}$，我们可以近似这些系数。系数 $a_0$ 代表解的平均值，通常不遵循这个衰减规律。最高阶模态的能量是 $a_p^2 \\approx C^2 p^{-2q}$。总能量是 $\\sum_{k=0}^{p} a_k^2 = a_0^2 + \\sum_{k=1}^{p} a_k^2$。对于一个快速收敛的级数（大的 $q$），总能量由前几项主导，所以 $E_{\\mathrm{total}} \\approx a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}$。\n因此，对于一个光滑函数，比率 $\\mathcal{R}$ 为：\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2 p^{-2q}}{a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}}\n$$\n假设解是良解析的，能量由常数模态 $a_0$ 主导，所以 $a_0^2 \\gg C^2\\sum_{k=1}^{p} k^{-2q}$。这简化了比率为：\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2}{a_0^2} p^{-2q}\n$$\n阈值 $s_{\\mathrm{th}}(p)$ 是此类光滑函数的传感器值：\n$$\ns_{\\mathrm{th}}(p) = \\log_{10}(\\mathcal{R}_{\\mathrm{smooth}}(p)) \\approx \\log_{10}\\left(\\frac{C^2}{a_0^2} p^{-2q}\\right) = \\log_{10}\\left(\\frac{C^2}{a_0^2}\\right) - 2q \\log_{10}(p)\n$$\n这个推导产生了一个形式为 $s_{\\mathrm{th}}(p) = K_1 - K_2 \\log_{10}(p)$ 的阈值，其中 $K_1 = \\log_{10}((C/a_0)^2)$ 和 $K_2 = 2q$ 是依赖于被解析的特定函数及其光滑度的常数。如要求所述，已经建立了对多项式次数 $p$ 的函数依赖关系。当测得的传感器值 $s$ 超过此阈值，即当 $s  s_{\\mathrm{th}}(p)$ 时，人工粘性被激活，这表明解比良解析流所预期的要不光滑。\n\n第三，我们为人工粘性 $\\nu$ 指定一个实用的渐变策略。粘性应在两个阈值 $s_0(p)$ 和 $s_1(p)$（其中 $s_0(p)  s_1(p)$）定义的范围内从 $\\nu=0$ 平滑过渡到最大值 $\\nu_{\\max}$。根据问题，当 $s  s_{\\mathrm{th}}(p)$ 时激活粘性，所以我们设置下阈值 $s_0(p) = s_{\\mathrm{th}}(p)$。上阈值 $s_1(p)$ 通常根据实际考虑来设置，例如 $s_1(p) = s_0(p) + \\Delta s$（对于某个范围 $\\Delta s  0$），或者 $s_1(p)$ 可以设置为一个常数值，如 $0$。一个通用的渐变策略可以表述如下：\n$$\n\\nu =\n\\begin{cases}\n    0  \\text{if } s \\leq s_{0}(p) \\\\\n    \\nu_{\\max} \\cdot f\\left(\\frac{s - s_{0}(p)}{s_{1}(p) - s_{0}(p)}\\right)  \\text{if } s_{0}(p)  s  s_{1}(p) \\\\\n    \\nu_{\\max}  \\text{if } s \\geq s_{1}(p)\n\\end{cases}\n$$\n其中 $f(\\xi)$ 是一个单调函数，满足 $f(0)=0$ 和 $f(1)=1$。一个简单实用的选择是线性斜坡 $f(\\xi) = \\xi$。使用像 $f(\\xi) = \\frac{1}{2}(1 - \\cos(\\pi\\xi))$ 这样的函数可以实现更平滑的渐变（为 $\\nu$ 提供 $C^1$ 连续性）。\n\n最后，我们计算在多项式次数为 $p=5$ 且模态系数为：\n$a_{0} = 1.2$，$a_{1} = 0.3$，$a_{2} = 0.08$，$a_{3} = 0.02$，$a_{4} = 0.004$ 和 $a_{5} = 0.001$ 的特定情况下的传感器 $s$ 的值。\n\n最高阶模态是 $p=5$，所以我们需要计算 $a_5^2$:\n$$\na_5^2 = (0.001)^2 = (1 \\times 10^{-3})^2 = 1 \\times 10^{-6}\n$$\n接下来，我们计算总能量 $\\sum_{k=0}^{5} a_k^2$:\n$$\n\\sum_{k=0}^{5} a_k^2 = (1.2)^2 + (0.3)^2 + (0.08)^2 + (0.02)^2 + (0.004)^2 + (0.001)^2 \\\\\n= 1.44 + 0.09 + 0.0064 + 0.0004 + 0.000016 + 0.000001 \\\\\n= 1.536817\n$$\n现在我们可以计算比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{a_5^2}{\\sum_{k=0}^{5} a_k^2} = \\frac{1 \\times 10^{-6}}{1.536817} \\approx 6.506935 \\times 10^{-7}\n$$\n传感器 $s$ 的值是该比率的以10为底的对数：\n$$\ns = \\log_{10}(6.506935 \\times 10^{-7}) \\approx -6.18663\n$$\n四舍五入到4位有效数字，我们得到 $s = -6.187$。", "answer": "$$\\boxed{-6.187}$$", "id": "3329004"}]}