{"hands_on_practices": [{"introduction": "第一个练习为整个有限元方法奠定了基础。通过在参考单元上手动构建标准正交基并推导物理质量矩阵，你将具体理解抽象的多项式空间如何映射到物理计算域上，这是间断 Galerkin 方法的核心机制。[@problem_id:3372733]", "problem": "考虑在二维四边形网格上用于计算流体动力学 (CFD) 的间断 Galerkin 有限元方法 (DG FEM)。令参考单元为正方形 $\\hat{K} = [-1,1] \\times [-1,1]$。令 $P^{k}(\\hat{K})$ 表示所有总次数至多为 $k$ 的二元多项式空间，并为 $P^{k}(\\hat{K})$ 配备定义在 $\\hat{K}$ 上的 $L^{2}$ 内积，其定义为 $\\langle f, g \\rangle_{L^{2}(\\hat{K})} = \\int_{\\hat{K}} f(\\hat{\\boldsymbol{x}}) g(\\hat{\\boldsymbol{x}}) \\,\\mathrm{d}\\hat{\\boldsymbol{x}}$。\n\n从 $L^{2}$ 内积的定义和仿射映射下的积分变换出发，构造一个关于 $\\langle \\cdot, \\cdot \\rangle_{L^{2}(\\hat{K})}$ 的 $P^{1}(\\hat{K})$ 的显式标准正交基，并解释物理单元上的质量矩阵是如何通过拉回和求积得到的。通过仿射映射 $F_{K} : \\hat{K} \\to K$ 定义物理单元 $K$，该映射由 $F_{K}(\\hat{\\boldsymbol{x}}) = A \\hat{\\boldsymbol{x}} + \\boldsymbol{b}$ 给出，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个常数矩阵，$\\boldsymbol{b} \\in \\mathbb{R}^{2}$ 是一个向量。局部质量矩阵 $M^{K}$ 的元素为 $M^{K}_{ij} = \\int_{K} \\phi_{i}^{K}(\\boldsymbol{x}) \\,\\phi_{j}^{K}(\\boldsymbol{x}) \\,\\mathrm{d}\\boldsymbol{x}$，其中 $\\{\\phi_{i}^{K}\\}$ 是物理单元 $K$ 上的基函数，由参考单元 $\\hat{K}$ 上的参考基 $\\{\\hat{\\phi}_{i}\\}$ 拉回得到。\n\n在 $\\hat{K}$ 的每个坐标方向上使用张量积高斯求积来近似定义 $M^{K}$ 的积分，并证明当 $k=1$ 时为保证精确性所需的求积阶数。最后，对于给定的特定仿射映射\n$$\nA = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\qquad \\boldsymbol{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix},\n$$\n确定当 $k=1$ 时物理单元质量矩阵 $M^{K}$ 的行列式。将最终答案表示为精确值，不进行四舍五入且不带单位。", "solution": "该问题是适定且自洽的，是间断 Galerkin 有限元方法构建中的一个标准练习。所有术语均按常规定义，所要求的计算在数学上是合理的，并且与该领域相关。因此，我们可以开始求解。\n\n该问题要求四个主要部分：\n1.  构造多项式空间 $P^{1}(\\hat{K})$ 的一个标准正交基。\n2.  解释物理单元质量矩阵 $M^K$ 是如何推导出来的。\n3.  证明当 $k=1$ 时，为精确计算质量矩阵元素所需的求积阶数是合理的。\n4.  计算一个特定质量矩阵 $M^K$ 的行列式。\n\n我们将依次解决这些问题。\n\n首先，我们构造空间 $P^{1}(\\hat{K})$ 的一个标准正交基。这是关于两个变量 $\\hat{x}$ 和 $\\hat{y}$ 的，总次数至多为 $1$ 的多项式空间。$P^{1}(\\hat{K})$ 的一个典范单项式基是 $\\{\\hat{\\psi}_{1}, \\hat{\\psi}_{2}, \\hat{\\psi}_{3}\\} = \\{1, \\hat{x}, \\hat{y}\\}$。这个空间的维数是 $3$。我们寻求一个关于参考单元 $\\hat{K} = [-1,1] \\times [-1,1]$ 上的 $L^{2}$ 内积的标准正交基 $\\{\\hat{\\phi}_{1}, \\hat{\\phi}_{2}, \\hat{\\phi}_{3}\\}$：\n$$ \\langle f, g \\rangle_{L^{2}(\\hat{K})} = \\int_{-1}^{1} \\int_{-1}^{1} f(\\hat{x}, \\hat{y}) g(\\hat{x}, \\hat{y}) \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} $$\n我们对该单项式基应用 Gram-Schmidt 标准正交化过程。\n\n令 $\\hat{\\phi}_{1}$ 为 $\\hat{\\psi}_{1} = 1$ 的标准化结果：\n$$ \\|\\hat{\\psi}_{1}\\|^2_{L^{2}(\\hat{K})} = \\langle 1, 1 \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} 1 \\cdot 1 \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = (2)(2) = 4 $$\n所以，$\\|\\hat{\\psi}_{1}\\|_{L^{2}(\\hat{K})} = 2$。第一个标准正交基函数是：\n$$ \\hat{\\phi}_{1}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{1}}{\\|\\hat{\\psi}_{1}\\|} = \\frac{1}{2} $$\n\n接下来，我们将 $\\hat{\\psi}_{2} = \\hat{x}$ 对 $\\hat{\\phi}_{1}$ 进行正交化：\n$$ \\langle \\hat{\\psi}_{2}, \\hat{\\phi}_{1} \\rangle = \\left\\langle \\hat{x}, \\frac{1}{2} \\right\\rangle = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{1}{2} \\left(\\int_{-1}^{1} \\hat{x} \\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = \\frac{1}{2} \\cdot 0 \\cdot 2 = 0 $$\n由于 $\\hat{\\psi}_{2}$ 已经与 $\\hat{\\phi}_{1}$ 正交，我们只需要将其标准化：\n$$ \\|\\hat{\\psi}_{2}\\|^2_{L^{2}(\\hat{K})} = \\langle \\hat{x}, \\hat{x} \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x}^{2} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\left(\\int_{-1}^{1} \\hat{x}^{2} \\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\hat{y}\\right) = \\left[\\frac{\\hat{x}^{3}}{3}\\right]_{-1}^{1} \\cdot 2 = \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) \\cdot 2 = \\frac{2}{3} \\cdot 2 = \\frac{4}{3} $$\n所以，$\\|\\hat{\\psi}_{2}\\|_{L^{2}(\\hat{K})} = \\frac{2}{\\sqrt{3}}$。第二个标准正交基函数是：\n$$ \\hat{\\phi}_{2}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{2}}{\\|\\hat{\\psi}_{2}\\|} = \\frac{\\sqrt{3}}{2}\\hat{x} $$\n\n最后，我们将 $\\hat{\\psi}_{3} = \\hat{y}$ 对 $\\hat{\\phi}_{1}$ 和 $\\hat{\\phi}_{2}$ 进行正交化。根据对称性，积分为零：\n$$ \\langle \\hat{\\psi}_{3}, \\hat{\\phi}_{1} \\rangle = \\left\\langle \\hat{y}, \\frac{1}{2} \\right\\rangle = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{y} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = 0 $$\n$$ \\langle \\hat{\\psi}_{3}, \\hat{\\phi}_{2} \\rangle = \\left\\langle \\hat{y}, \\frac{\\sqrt{3}}{2}\\hat{x} \\right\\rangle = \\frac{\\sqrt{3}}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\hat{x}\\hat{y} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{\\sqrt{3}}{2} \\left(\\int_{-1}^{1} \\hat{x}\\,\\mathrm{d}\\hat{x}\\right) \\left(\\int_{-1}^{1} \\hat{y}\\,\\mathrm{d}\\hat{y}\\right) = 0 $$\n因此，我们只需要将 $\\hat{\\psi}_{3}$ 标准化。其计算过程与 $\\hat{\\psi}_{2}$ 的计算过程对称：\n$$ \\|\\hat{\\psi}_{3}\\|^2_{L^{2}(\\hat{K})} = \\langle \\hat{y}, \\hat{y} \\rangle = \\int_{-1}^{1} \\int_{-1}^{1} \\hat{y}^{2} \\,\\mathrm{d}\\hat{x} \\,\\mathrm{d}\\hat{y} = \\frac{4}{3} $$\n所以，$\\|\\hat{\\psi}_{3}\\|_{L^{2}(\\hat{K})} = \\frac{2}{\\sqrt{3}}$。第三个标准正交基函数是：\n$$ \\hat{\\phi}_{3}(\\hat{x}, \\hat{y}) = \\frac{\\hat{\\psi}_{3}}{\\|\\hat{\\psi}_{3}\\|} = \\frac{\\sqrt{3}}{2}\\hat{y} $$\n$P^{1}(\\hat{K})$ 的标准正交基是 $\\{\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\hat{x}, \\frac{\\sqrt{3}}{2}\\hat{y}\\}$。\n\n第二，我们解释物理单元质量矩阵 $M^K$ 的推导过程。其元素定义为 $M^{K}_{ij} = \\int_{K} \\phi_{i}^{K}(\\boldsymbol{x}) \\,\\phi_{j}^{K}(\\boldsymbol{x}) \\,\\mathrm{d}\\boldsymbol{x}$。物理单元 $K$ 上的基函数 $\\phi_{i}^{K}$ 是通过仿射映射 $F_K$ 的逆，从参考基函数 $\\hat{\\phi}_{i}$ 拉回得到的。也就是说，$\\phi_{i}^{K} = \\hat{\\phi}_{i} \\circ F_{K}^{-1}$。为了计算在 $K$ 上的积分，我们使用 $\\boldsymbol{x} = F_{K}(\\hat{\\boldsymbol{x}})$ 进行变量替换，将积分变换到参考单元 $\\hat{K}$ 上。微分元变换为 $\\mathrm{d}\\boldsymbol{x} = |\\det(J_{F_K})|\\,\\mathrm{d}\\hat{\\boldsymbol{x}}$，其中 $J_{F_K}$ 是映射 $F_K$ 的雅可比矩阵。对于仿射映射 $F_{K}(\\hat{\\boldsymbol{x}}) = A \\hat{\\boldsymbol{x}} + \\boldsymbol{b}$，其雅可比矩阵是常数矩阵 $A$。因此，$\\mathrm{d}\\boldsymbol{x} = |\\det(A)|\\,\\mathrm{d}\\hat{\\boldsymbol{x}}$。\n\n将这些代入 $M^{K}_{ij}$ 的积分中：\n$$ M^{K}_{ij} = \\int_{\\hat{K}} \\phi_{i}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) \\phi_{j}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) \\,|\\det(A)|\\,\\mathrm{d}\\hat{\\boldsymbol{x}} $$\n根据拉回的定义，$\\phi_{i}^{K}(F_{K}(\\hat{\\boldsymbol{x}})) = (\\hat{\\phi}_{i} \\circ F_{K}^{-1})(F_{K}(\\hat{\\boldsymbol{x}})) = \\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}})$。表达式简化为：\n$$ M^{K}_{ij} = |\\det(A)| \\int_{\\hat{K}} \\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}}) \\hat{\\phi}_{j}(\\hat{\\boldsymbol{x}}) \\,\\mathrm{d}\\hat{\\boldsymbol{x}} = |\\det(A)| \\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_{L^{2}(\\hat{K})} $$\n由于基 $\\{\\hat{\\phi}_{i}\\}$ 是标准正交的，我们有 $\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_{L^{2}(\\hat{K})} = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 δ。因此，质量矩阵的元素由 $M^{K}_{ij} = |\\det(A)| \\delta_{ij}$ 给出。这表明物理质量矩阵是单位矩阵的一个标量倍：$M^K = |\\det(A)| I$。这些积分的计算是使用数值求积来执行的。\n\n第三，我们证明求积阶数的合理性。需要计算的积分是 $\\int_{\\hat{K}} \\hat{\\phi}_{i} \\hat{\\phi}_{j} \\,\\mathrm{d}\\hat{\\boldsymbol{x}}$。对于 $k=1$，基函数 $\\hat{\\phi}_i$ 是总次数至多为 $1$ 的多项式。因此，被积函数 $\\hat{\\phi}_{i}(\\hat{\\boldsymbol{x}}) \\hat{\\phi}_{j}(\\hat{\\boldsymbol{x}})$ 是一个总次数至多为 $1+1=2$ 的多项式。例如，$\\hat{\\phi}_{2}\\hat{\\phi}_{2} = (\\frac{\\sqrt{3}}{2}\\hat{x})^{2} = \\frac{3}{4}\\hat{x}^{2}$，其次数为 $2$。一个在每个坐标方向上采用 $N_p$ 个点的张量积高斯求积法则可以对每个变量分别精确地积分最高 $2N_p - 1$ 次的多项式。为了在正方形上精确积分任何总次数为 $2$ 的多项式，我们需要确保该法则对于所有满足 $a+b \\le 2$ 的单项式 $\\hat{x}^a \\hat{y}^b$ 都是精确的。单个变量中的最高次数是 $2$（来自像 $\\hat{x}^2$ 和 $\\hat{y}^2$ 这样的项）。因此，我们要求一维高斯法则对最高 $2$ 次的多项式是精确的。这要求 $2N_p - 1 \\ge 2$，从而得到 $2N_p \\ge 3$，即 $N_p \\ge 1.5$。由于点数 $N_p$ 必须是整数，我们必须选择 $N_p=2$。每个方向上的 2 点高斯法则（一个 $2 \\times 2$ 的张量积法则）对每个变量最高 3 次的多项式都是精确的，这足以精确计算质量矩阵。\n\n第四，我们计算由 $A = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$ 给出的特定仿射映射的 $M^K$ 的行列式。$A$ 的行列式是：\n$$ \\det(A) = (2)(2) - (1)(1) = 4 - 1 = 3 $$\n其绝对值为 $|\\det(A)| = 3$。多项式空间 $P^{1}(\\hat{K})$ 的维数是 $3$，所以质量矩阵 $M^K$ 是一个 $3 \\times 3$ 的矩阵。如上所推导， $M^K = |\\det(A)| I_3$，其中 $I_3$ 是 $3 \\times 3$ 的单位矩阵。\n$$ M^K = 3 \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  3  0 \\\\ 0  0  3 \\end{pmatrix} $$\n该矩阵的行列式为：\n$$ \\det(M^K) = \\det(3 I_3) = 3^3 \\det(I_3) = 27 \\cdot 1 = 27 $$\n物理单元质量矩阵的行列式是 $27$。", "answer": "$$\\boxed{27}$$", "id": "3372733"}, {"introduction": "在将空间域离散化之后，下一个关键步骤是确保时间演化的稳定性。本练习深入探讨了 DG 空间算子的谱分析，引导你推导 Courant-Friedrichs-Lewy (CFL) 条件。该条件将网格尺寸、多项式阶数和问题的物理特性与稳定模拟所允许的最大时间步长联系起来。[@problem_id:3372693]", "problem": "考虑定义在周期区间上的一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，该区间使用单元尺寸为 $h$ 的均匀网格进行离散。在每个单元上使用 $k$ 次多项式、由参考单元上适当缩放的 Legendre 多项式构成的标准正交模态基以及迎风数值通量，应用间断 Galerkin (DG) 有限元方法。令半离散系统写作 $U'(t) = \\mathcal{L}\\,U(t)$，其中 $U(t)$ 汇集了所有模态自由度，$\\mathcal{L}$ 是全局 DG 空间算子。\n\n从每个单元上的弱形式出发，并映射到参考单元，推导迎风通量下半离散算子的单元级结构，并展示其如何组装成全局算子 $\\mathcal{L}$。仅使用 Legendre 多项式的性质、每个单元上的精确对角质量矩阵，以及适用于均匀网格上多项式的范数等价性和反估计，给出一个关于 $a$、$h$ 和 $k$ 的谱半径 $\\rho(\\mathcal{L})$ 的严格估计。你可以使用 Gershgorin 型论证和与 Legendre 多项式基中的微分算子相关的已知紧致界来得出一个紧致的估计。\n\n然后，引用显式 Runge-Kutta (RK) 方法的强稳定性保持 (SSP) 理论。将强稳定性保持 (SSP) Runge-Kutta (RK) 方法定义为在向前欧拉时间步长限制下，在给定范数中保持收缩性质的显式 RK 方法，其 SSP 系数决定了其允许的时间步长是向前欧拉界限的倍数。对于 SSP 系数 $C_{\\mathrm{SSP}} = 1$ 的经典三阶段三阶 SSP Runge-Kutta 方法，推导关于 $a$、$h$ 和 $k$ 的 Courant-Friedrichs-Lewy (CFL) 时间步长限制。\n\n你的最终答案必须是一个单行矩阵，包含：\n- 谱半径 $\\rho(\\mathcal{L})$ 的解析表达式，\n- 以及在所选 SSP Runge-Kutta 方法下的最大稳定时间步长 $\\Delta t$ 的解析表达式。\n\n如果 $a$ 的单位是米/秒，$h$ 的单位是米，则时间步长界限以秒为单位表示。不需要四舍五入。", "solution": "该问题要求对一维线性平流方程的间断 Galerkin (DG) 方法进行三部分的推导和分析。首先，我们必须验证问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **PDE:** $u_{t} + a\\,u_{x} = 0$\n-   **域:** 一维周期性区间。\n-   **离散化:** 间断 Galerkin (DG) 有限元方法。\n-   **网格:** 单元尺寸为 $h$ 的均匀网格。\n-   **多项式空间:** 每个单元上的 $k$ 次多项式。\n-   **基:** 每个单元上的标准正交模态基，由参考单元上缩放的 Legendre 多项式构成。\n-   **数值通量:** 迎风数值通量。\n-   **半离散系统:** $U'(t) = \\mathcal{L}\\,U(t)$，其中 $U(t)$ 是所有模态自由度的向量，$\\mathcal{L}$ 是全局 DG 空间算子。\n-   **任务1:** 推导 $\\mathcal{L}$ 的单元级结构及其组装过程。\n-   **任务2:** 根据 $a$、$h$ 和 $k$ 估计谱半径 $\\rho(\\mathcal{L})$，使用 Legendre 多项式的性质、对角质量矩阵、范数等价性、反估计以及 Legendre 基中微分算子的已知紧致界。\n-   **任务3:** 定义强稳定性保持 (SSP) Runge-Kutta (RK) 方法。\n-   **任务4:** 对于 SSP 系数 $C_{\\mathrm{SSP}} = 1$ 的经典三阶段三阶 SSP RK 方法，推导 Courant-Friedrichs-Lewy (CFL) 时间步长限制。\n-   **最终答案:** 一个包含 $\\rho(\\mathcal{L})$ 和最大稳定时间步长 $\\Delta t$ 的解析表达式的单行矩阵。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题牢固地植根于偏微分方程数值分析的既定理论，特别关注间断 Galerkin 方法、所得算子的谱特性以及使用 SSP Runge-Kutta 方法的稳定时间积分。所有概念在计算流体力学和应用数学中都是标准的。\n-   **适定性：** 问题陈述清晰，并提供了进行推导所需的所有必要信息。它要求基于一个明确定义的设置给出具体的解析表达式。使用“已知的紧致界”是高级问题中的标准做法，指导解题者使用文献中已建立的、非平凡的结果，而不是从第一性原理重新推导它们。\n-   **客观性：** 语言正式、精确，没有任何主观或模棱两可的术语。\n\n该问题未违反任何无效性标准。这是一个数值方法分析中的标准（尽管是高级的）问题。\n\n**步骤3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n### 解答推导\n\n设计算域 $\\Omega$ 被划分为单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$，其尺寸均匀为 $h = x_{j+1/2} - x_{j-1/2}$。DG 有限元空间为 $V_h = \\{ v \\in L^2(\\Omega) : v|_{K_j} \\in P_k(K_j) \\text{ 对于每个 } K_j \\}$，其中 $P_k(K_j)$ 是单元 $K_j$ 上次数至多为 $k$ 的多项式空间。\n\n**1. 半离散算子 $\\mathcal{L}$ 的推导**\n\n在单元 $K_j$ 上，PDE $u_t + a u_x = 0$ 的弱形式通过乘以一个测试函数 $v_h \\in V_h$ 并在 $K_j$ 上积分得到：\n$$ \\int_{K_j} (u_h)_t v_h \\, dx + \\int_{K_j} a (u_h)_x v_h \\, dx = 0 $$\n对第二项进行分部积分得到：\n$$ \\int_{K_j} (u_h)_t v_h \\, dx - a \\int_{K_j} u_h (v_h)_x \\, dx + a [u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0 $$\n边界项使用来自 $K_j$ 内部的单侧极限来书写：\n$$ [u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} = u_h(x_{j+1/2}^-) v_h(x_{j+1/2}^-) - u_h(x_{j-1/2}^+) v_h(x_{j-1/2}^+) $$\n在 DG 方法中，单元界面处的函数 $u_h$ 被一个数值通量（记为 $\\hat{u}$）所取代。该公式变为：\n$$ \\int_{K_j} (u_h)_t v_h \\, dx = a \\int_{K_j} u_h (v_h)_x \\, dx - a [\\hat{u} v_h]_{\\partial K_j} $$\n其中 $[\\hat{u} v_h]_{\\partial K_j} = \\hat{u}(x_{j+1/2}) v_h(x_{j+1/2}^-) - \\hat{u}(x_{j-1/2}) v_h(x_{j-1/2}^+)$。\n问题指定了迎风通量。对于 $a0$，信息从左向右传播，因此界面处的通量由上游（左侧）单元的值确定：\n$$ \\hat{u}(x_{j+1/2}) = u_h(x_{j+1/2}^-) \\quad \\text{和} \\quad \\hat{u}(x_{j-1/2}) = u_h(x_{j-1/2}^-) $$\n项 $u_h(x_{j-1/2}^-)$ 是来自单元 $K_{j-1}$ 的解在界面处的值。\n\n在每个单元 $K_j$ 上，我们在一个标准正交基 $\\{\\phi_l(x)\\}_{l=0}^k$ 中展开解 $u_h(x,t)$。\n$$ u_h(x,t)|_{K_j} = \\sum_{l=0}^k u_{j,l}(t) \\phi_l(x) $$\n基函数是缩放后的 Legendre 多项式。参考单元是 $\\hat{K} = [-1, 1]$。对于标准 $L^2$ 内积，$\\hat{K}$ 上的一个标准正交基是 $\\{\\hat{\\phi}_l(\\xi) = \\sqrt{(2l+1)/2} P_l(\\xi)\\}_{l=0}^k$。物理基函数 $\\phi_l(x)$ 通过映射 $x(\\xi) = x_j + (h/2)\\xi$ 和缩放与 $\\hat{\\phi}_l(\\xi)$ 相关联，以确保在 $K_j$ 上的标准正交性：$\\int_{K_j} \\phi_l \\phi_m dx = \\delta_{lm}$。这种缩放是 $\\phi_l(x) = (1/\\sqrt{h/2})\\hat{\\phi}_l(\\xi(x))$。\n使用标准正交基，单元质量矩阵 $M_{ml}^{(j)} = \\int_{K_j} \\phi_l \\phi_m dx = \\delta_{lm}$ 是单位矩阵。\n\n将 $u_h$ 的展开式代入弱形式并使用 $v_h = \\phi_m$ 得到单元 $j$ 中第 $m$ 个自由度的方程：\n$$ \\frac{d u_{j,m}}{dt} = a \\sum_{l=0}^k u_{j,l} \\int_{K_j} \\phi_l (\\phi_m)_x dx - a\\left( \\big(\\sum_{l=0}^k u_{j,l} \\phi_l(x_{j+1/2})\\big) \\phi_m(x_{j+1/2}) - \\big(\\sum_{l=0}^k u_{j-1,l} \\phi_l(x_{j-1/2})\\big) \\phi_m(x_{j-1/2}) \\right) $$\n在这里，包含 $u_{j-1,l}$ 的项代表了来自上游单元 $K_{j-1}$ 在其右边界处求值的贡献，该贡献在其左边界处与单元 $K_j$ 耦合。\n映射到参考单元 $\\hat{K}$，我们有 $(\\phi_m)_x = (2/h)(\\hat{\\phi}_m)_\\xi$ 和 $dx = (h/2)d\\xi$。单元 $j$ 的系数 $U_j = (u_{j,0}, \\dots, u_{j,k})^T$ 的方程变为（对于 $a0$）：\n$$ \\frac{dU_j}{dt} = \\mathcal{L}_{jj} U_j + \\mathcal{L}_{j,j-1} U_{j-1} $$\n其中 $\\mathcal{L}_{jj}$ 和 $\\mathcal{L}_{j,j-1}$ 是表示单元内和单元间贡献的 $(k+1) \\times (k+1)$ 矩阵。全局算子 $\\mathcal{L}$ 是一个由这些单元级算子组成的块矩阵。对于周期性域，$\\mathcal{L}$ 是一个块循环矩阵。\n\n**2. $\\mathcal{L}$ 的谱半径估计**\n\n块循环矩阵的谱是由傅里叶分解形成的较小矩阵的谱的并集。$\\mathcal{L}$ 的特征值是 $\\Lambda(\\theta) = \\mathcal{L}_{jj} + e^{-i\\theta} \\mathcal{L}_{j,j-1}$（对于 $\\theta \\in [0, 2\\pi)$）的特征值的集合。对这些矩阵的详细分析是复杂的，但问题允许使用“已知的紧致界”。\n\n对于使用 $k$ 次 DG 方法、标准正交 Legendre 基和迎风通量离散的一维线性平流方程，半离散算子 $\\mathcal{L}$ 的谱半径已被严格确定。这个紧致界是：\n$$ \\rho(\\mathcal{L}) = \\frac{|a|(2k+1)}{h} $$\n这个结果来自于对算子的仔细谱分析，该分析表明特征值的最大模（它决定了谱半径）与多项式次数 $k$ 成线性关系，与网格尺寸 $h$ 成反比关系。\n\n**3. SSP-RK 方法的 CFL 时间步长限制**\n\n问题要求显式 SSP Runge-Kutta 方法的时间步长限制。SSP 方法的定义性属性是它保持了向前欧拉方法的收缩性质。\n半离散系统为 $U'(t) = \\mathcal{L}U(t)$。对于向前欧拉方法 $U^{n+1} = U^n + \\Delta t \\mathcal{L}U^n$，要在 $L^2$-范数下是收缩的（即 $\\|U^{n+1}\\|_2 \\le \\|U^n\\|_2$），放大算子的谱 $\\sigma(I+\\Delta t \\mathcal{L})$ 必须位于复平面的单位圆盘内。这意味着对于所有特征值 $\\lambda \\in \\sigma(\\mathcal{L})$，都有 $|1+\\Delta t \\lambda| \\le 1$。\n对于带迎风通量的 DG 算子，已知所有特征值都具有非正实部，$\\Re(\\lambda) \\le 0$。对于 $\\lambda = x+iy$ 且 $x \\le 0$，条件 $|1+\\Delta t \\lambda| \\le 1$ 转化为：\n$$ \\Delta t \\le \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} $$\n这必须对所有特征值成立，因此向前欧拉时间步长限制为：\n$$ \\Delta t_{FE} = \\min_{\\lambda \\in \\sigma(\\mathcal{L}), \\lambda \\ne 0} \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} $$\n一个 SSP 系数为 $C_{\\mathrm{SSP}}$ 的 SSP-RK 方法在时间步长 $\\Delta t_{RK} \\le C_{\\mathrm{SSP}} \\Delta t_{FE}$ 内是收缩的。\n问题指定了 SSP 系数为 $C_{\\mathrm{SSP}} = 1$ 的经典三阶段三阶 SSP-RK 方法。因此，其最大稳定时间步长与向前欧拉限制相同：\n$$ \\Delta t = \\Delta t_{FE} $$\n对于所考虑的特定 DG 算子，这个最小值也是文献中一个已知的紧致结果，与特征值谱的结构有关。它由下式给出：\n$$ \\min_{\\lambda \\in \\sigma(\\mathcal{L}), \\lambda \\ne 0} \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} = \\frac{h}{|a|(2k+1)} $$\n这个特定的值表明了限制稳定性的特征值在复平面内的位置。\n综合这些结果，最大稳定时间步长为：\n$$ \\Delta t = 1 \\cdot \\Delta t_{FE} = \\frac{h}{|a|(2k+1)} $$\n单位是一致的：如果 $h$ 的单位是米，$a$ 的单位是米/秒，则 $\\Delta t$ 的单位是秒。\n\n我们已经推导出了两个所需的表达式：谱半径 $\\rho(\\mathcal{L})$ 和最大稳定时间步长 $\\Delta t$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{|a|(2k+1)}{h}  \\frac{h}{|a|(2k+1)} \\end{pmatrix} } $$", "id": "3372693"}, {"introduction": "虽然像 DG 这样的高阶方法在光滑区域非常精确，但在非线性守恒律解的间断（激波）附近会产生非物理振荡。本练习介绍了一种至关重要的实用工具——总变差有界 (TVB) 斜率限制器——来应对这一挑战，演示了如何选择性地控制解的梯度以确保稳定性和物理真实性，同时又不牺牲其他地方的精度。[@problem_id:3372706]", "problem": "考虑标量一维双曲守恒律 $u_{t} + f(u)_{x} = 0$，在一个单元宽度为 $h$ 的均匀网格上，使用间断 Galerkin (DG) 有限元方法进行离散，并在每个单元中使用次数为 $k$ 的分片多项式。设每个单元 $I_{i}$ 通过 $\\xi = \\frac{2}{h}(x-x_{i})$ 仿射映射到参考区间 $\\xi \\in [-1,1]$，并将 $I_{i}$ 中的解表示为 Legendre 多项式的模态展开，$u_{h}\\big|_{I_{i}}(\\xi) = \\sum_{m=0}^{k} \\hat{u}_{i,m} P_{m}(\\xi)$，其中 $\\hat{u}_{i,0} = \\bar{u}_{i}$ 是单元平均值。需要使用限制器来保证振荡的物理有界性，并控制间断附近的总变差增长，同时在光滑区域保持高阶精度。\n\n从总变差有界 (TVB) 的概念和 DG 重构的结构出发，推导一个一维 TVB 斜率限制器，该限制器通过将重构斜率与基于邻居的割线斜率进行比较，并采用一个经 TVB 修正的 minmod 算子，来修改单元 $I_{i}$ 中多项式的线性部分。具体来说：\n- 推导一个 TVB minmod 算子，该算子通过引入一个由 TVB 参数 $M$ 控制的容差来保护光滑极值点，并解释该容差由光滑函数的 Taylor 展开产生的随网格尺寸 $h$ 的缩放关系。\n- 构建一个基于单元平均值二阶差分（并由 $h^{2}$ 缩放）的光滑度指示器，该指示器仅在存在陡峭梯度时激活限制器。\n- 展示如何将受限的斜率映射回 $[-1,1]$ 上 Legendre 基中的线性模态系数 $\\hat{u}_{i,1}$。\n\n然后，对于单元 $I_{i}$ 中次数为 $k=2$ 且使用 Legendre 基的具体情况，取数值数据\n$\\bar{u}_{i-1} = 1.0$，$\\bar{u}_{i} = 1.2$，$\\bar{u}_{i+1} = 1.5$，$h = 0.2$，$\\hat{u}_{i,1} = 0.25$，$\\hat{u}_{i,2} = -0.05$，以及 TVB 参数 $M = 0.5$。使用您推导的限制器和光滑度指示器，计算受限的线性模态系数 $\\hat{u}_{i,1}^{\\text{new}}$。最终答案以纯数字形式表示，不带单位，除非必要，否则不要四舍五入。", "solution": "该问题要求为间断 Galerkin (DG) 方法推导一个一维总变差有界 (TVB) 斜率限制器，并将其应用于一个具体的数值案例。验证过程确认了该问题具有科学依据、良定且客观。我们可以开始求解。\n\n解答结构如下：\n1.  TVB 斜率限制器的推导，包括经 TVB 修正的 minmod 算子及其缩放关系。\n2.  构建用于选择性应用限制器的光滑度指示器。\n3.  解释物理斜率与模态 Legendre 系数之间的关系。\n4.  将推导出的限制器和指示器应用于所提供的数值数据。\n\n### 第一部分：TVB 斜率限制器的推导\n\nDG 方法的斜率限制器旨在控制每个单元 $I_i = [x_i - h/2, x_i + h/2]$ 内多项式重构的斜率，以防止在间断附近出现伪振荡。这是通过修改多项式表示的模态系数 $u_h\\big|_{I_i}(\\xi) = \\sum_{m=0}^{k} \\hat{u}_{i,m} P_{m}(\\xi)$ 来实现的，其中 $\\xi = \\frac{2}{h}(x-x_i)$ 是参考单元 $[-1, 1]$ 上的坐标。\n\n解的“斜率”主要由多项式的线性部分决定。Legendre 基多项式为 $P_0(\\xi)=1$ 和 $P_1(\\xi)=\\xi$。单元 $I_i$ 中重构的线性部分为 $u_h^{lin}(x) = \\hat{u}_{i,0}P_0(\\xi) + \\hat{u}_{i,1}P_1(\\xi) = \\bar{u}_i + \\hat{u}_{i,1}\\xi$。\n\n该线性部分的物理斜率在整个单元内是恒定的：\n$$ s_i = \\frac{d}{dx} u_h^{lin}(x) = \\frac{d}{d\\xi}(\\bar{u}_i + \\hat{u}_{i,1}\\xi) \\frac{d\\xi}{dx} = \\hat{u}_{i,1} \\cdot \\frac{2}{h} $$\n这表明物理斜率 $s_i$ 与线性模态系数 $\\hat{u}_{i,1}$ 之间存在直接关系。作用于斜率 $s_i$ 的限制器等效于作用于系数 $\\hat{u}_{i,1}$ 的限制器。为了与标准文献保持一致并简化比较，我们将以 $\\hat{u}_{i,1}$ 的形式来构建限制器。\n\n限制器将由 $\\hat{u}_{i,1}$ 表示的内部“斜率”信息与来自相邻单元平均值的“斜率”信息进行比较。项 $\\hat{u}_{i,1}$ 表示解在参考单元上从单元中心到单元边界的变化，即 $u_h^{lin}(\\xi=1) - u_h^{lin}(\\xi=0) = \\hat{u}_{i,1}$。为了进行比较，我们使用相邻单元平均值差的一半，这对应于在距离 $h/2$ 上的平均变化：\n-   前向差分比较量：$\\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_i)$\n-   后向差分比较量：$\\frac{1}{2}(\\bar{u}_i - \\bar{u}_{i-1})$\n\n受限系数 $\\hat{u}_{i,1}^{\\text{new}}$ 通过一个经 TVB 修正的 minmod 算子获得：\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}_{TVB} \\left( \\hat{u}_{i,1}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{2}, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{2} \\right) $$\n\n经 TVB 修正的 minmod 算子 $\\text{minmod}_{TVB}$ 定义为：\n$$ \\text{minmod}_{TVB}(a, b, c) = \\begin{cases} a  \\text{若 } |a| \\le M h^2 \\\\ \\text{minmod}(a, b, c)  \\text{否则} \\end{cases} $$\n其中 $\\text{minmod}(a,b,c)$ 是标准的 minmod 函数，如果所有参数符号相同，则返回绝对值最小的参数，否则返回零。\n\n容差 $M h^2$ 对于保护光滑极值点不被削平至关重要。对于一个光滑函数 $u(x)$，考虑其在局部极值点 $x_c$ 附近的 Taylor 展开。对于该极值点附近的一个单元 $I_i$，函数值与单元平均值之差 $u(x)-\\bar{u}_i$ 可以被证明是 $O(h^2)$ 阶的。例如，对于 $u(x) = c(x-x_c)^2$，在单元边界 $x_i \\pm h/2$ 处的偏差是 $O(h^2)$ 阶的。DG 模态系数 $\\hat{u}_{i,1}$ 是解的线性部分投影的高阶近似；在一个对称极值点（$x_c=x_i$）处，$\\hat{u}_{i,1}$ 将为零。更一般地，在极值点附近，$\\hat{u}_{i,1}$ 是 $O(h^2)$ 阶或更小。通过设置一个 $Mh^2$ 的容差，我们规定如果“斜率”系数 $\\hat{u}_{i,1}$ 已经小到与光滑极值点相符，则不应对其进行修改。TVB 参数 $M$ 是一个用户定义的常数，通常选择与解的预期最大二阶导数的估计值 $\\max|u_{xx}|$ 成比例。\n\n### 第二部分：光滑度指示器\n\n在所有地方都应用限制器会降低光滑区域的精度。使用光滑度指示器仅在“问题”单元（即那些靠近陡峭梯度或间断的单元）中激活限制。\n\n一个鲁棒的指示器可以由单元平均值的二阶差分构建：$\\Delta^2_i \\bar{u} = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}$。\n对于光滑函数，Taylor 级数展开表明 $\\Delta^2_i \\bar{u} \\approx u''(x_i) h^2$。因此，在光滑区域，该量是 $O(h^2)$ 阶的。然而，在间断附近，二阶差分要大得多，通常是 $O(h)$ 阶的。\n\n这种缩放上的差异使我们能够构建一个简单而有效的指示器。我们可以将 $|\\Delta^2_i \\bar{u}|$ 与用于保护极值点的相同 TVB 容差 $Mh^2$ 进行比较。如果由单元平均值估计的局部曲率超过此阈值，单元 $I_i$ 将被标记为问题单元，并应用限制。\n当满足以下条件时激活限制器：\n$$ |\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}| > M h^2 $$\n这个条件将限制器的激活与其工作原理联系起来：当单元平均值的局部行为与由参数 $M$ 表征的光滑极值点的假设不一致时，应用限制。\n\n### 第三部分：斜率与系数之间的映射\n\n如第一部分所述，线性重构的物理斜率 $s_i$ 与模态系数 $\\hat{u}_{i,1}$ 成正比：\n$$ s_i = \\frac{2 \\hat{u}_{i,1}}{h} $$\n如果我们计算出受限斜率 $s_i^{\\text{new}}$，相应的新模态系数可以通过反转此关系找到：\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\frac{h}{2} s_i^{\\text{new}} $$\n我们选择的直接限制 $\\hat{u}_{i,1}$ 的公式隐式地包含了这种映射。比较量 $(\\bar{u}_{i+1} - \\bar{u}_i)/2$ 和 $(\\bar{u}_i - \\bar{u}_{i-1})/2$ 等效于将割线斜率 $\\sigma_F = (\\bar{u}_{i+1} - \\bar{u}_i)/h$ 和 $\\sigma_B = (\\bar{u}_i - \\bar{u}_{i-1})/h$ 乘以 $h/2$。\n\n### 第四部分：数值计算\n\n我们将推导的步骤应用于给定数据：\n- 单元平均值：$\\bar{u}_{i-1} = 1.0$，$\\bar{u}_{i} = 1.2$，$\\bar{u}_{i+1} = 1.5$。\n- 单元宽度：$h = 0.2$。\n- 初始模态系数：$\\hat{u}_{i,1} = 0.25$，$\\hat{u}_{i,2} = -0.05$。\n- TVB 参数：$M = 0.5$。\n\n**步骤 1：检查光滑度指示器。**\n首先，我们计算单元平均值的二阶差分：\n$$ \\Delta^2_i \\bar{u} = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} = 1.5 - 2(1.2) + 1.0 = 1.5 - 2.4 + 1.0 = 0.1 $$\n接下来，我们计算指示器的阈值：\n$$ M h^2 = 0.5 \\times (0.2)^2 = 0.5 \\times 0.04 = 0.02 $$\n我们将二阶差分的绝对值与此阈值进行比较：\n$$ |\\Delta^2_i \\bar{u}| = |0.1| = 0.1 $$\n由于 $0.1 > 0.02$，条件 $|\\Delta^2_i \\bar{u}| > M h^2$ 成立。因此，必须对单元 $I_i$ 激活限制器。\n\n**步骤 2：应用 TVB 斜率限制器。**\n我们计算 $\\text{minmod}_{TVB}$ 函数的参数：\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}_{TVB}(a, b, c) $$\n- 待限制的系数：$a = \\hat{u}_{i,1} = 0.25$。\n- 前向差分比较量：$b = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{2} = \\frac{1.5 - 1.2}{2} = \\frac{0.3}{2} = 0.15$。\n- 后向差分比较量：$c = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{2} = \\frac{1.2 - 1.0}{2} = \\frac{0.2}{2} = 0.1$。\n\n现在，我们计算 $\\text{minmod}_{TVB}$ 算子。首先，检查容差条件：$|a| \\le M h^2$ 是否成立？\n$$ |0.25| \\le 0.02 $$\n这不成立。在给定的容差下，该系数太大，不能被视为光滑极值点的一部分。因此，我们继续应用标准的 `minmod` 函数：\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\text{minmod}(0.25, 0.15, 0.1) $$\n所有参数均为正数。对于正参数，标准 minmod 函数返回最小值：\n$$ \\hat{u}_{i,1}^{\\text{new}} = \\min(0.25, 0.15, 0.1) = 0.1 $$\n\n受限的线性模态系数是 $0.1$。问题只要求新的线性系数 $\\hat{u}_{i,1}^{\\text{new}}$。根据限制器的具体实现，二次系数 $\\hat{u}_{i,2}$ 可能会被设置为零或保持不变。根据题目要求，我们只提供 $\\hat{u}_{i,1}$ 的结果。", "answer": "$$\\boxed{0.1}$$", "id": "3372706"}]}