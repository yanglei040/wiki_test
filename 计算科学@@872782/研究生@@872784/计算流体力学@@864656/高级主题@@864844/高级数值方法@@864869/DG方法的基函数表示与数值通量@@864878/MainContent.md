## 引言
间断伽辽金（Discontinuous Galerkin, DG）方法作为一种[高阶数值方法](@entry_id:142601)，已在计算流体动力学（CFD）及其他科学与工程计算领域获得了广泛的关注和应用。其结合了有限元方法的几何灵活性与有限体积方法的局部守恒性和激波捕捉能力，为求解复杂的[偏微分方程](@entry_id:141332)提供了强有力的工具。然而，DG方法的强大功能源于其设计上的高度灵活性，特别是其两个核心构建模块：用于在单元内表示解的**[基函数](@entry_id:170178)**，以及用于在单元间传递信息并确保稳定性的**[数值通量](@entry_id:752791)**。对这两个模块的选择和理解上的细微差别，可能导致最终数值格式在精度、效率和鲁棒性上产生巨大差异。因此，深入理解这些选择背后的原理与机制，是有效运用并发展DG方法的关键。

本文旨在系统性地剖析这两个核心要素，为读者构建一个关于[DG方法](@entry_id:748369)内部工作原理的清晰图景。在“**原理与机制**”一章中，我们将从[DG方法](@entry_id:748369)的[弱形式](@entry_id:142897)出发，详细阐述其如何实现局部守恒，并深入探讨不同[基函数](@entry_id:170178)（[模态基](@entry_id:752055)与[节点基](@entry_id:752522)）的表示方式及其对离散算子的影响，同时对各种数值通量的设计理念及其在确保稳定性中的作用进行剖析。随后，在“**应用与跨学科连接**”一章中，我们将展示这些理论概念如何在[可压缩气体动力学](@entry_id:169361)、复杂几何处理、自适应计算以及[多物理场耦合](@entry_id:171389)等前沿应用场景中发挥作用，揭示理论与实践的紧密联系。最后，通过一系列精心设计的“**动手实践**”问题，读者将有机会亲手计算和分析DG方法的关键组成部分，从而将理论知识转化为实践能力。

## 原理与机制

本章旨在深入探讨间断伽辽金（Discontinuous Galerkin, DG）方法的核心原理与关键机制。我们将从其独特的[弱形式](@entry_id:142897)出发，揭示该方法如何在单元层面实现局部守恒，并阐述其对数值通量的依赖性。随后，我们将详细讨论[基函数](@entry_id:170178)的选择及其对离散算子性质的影响，并对各种[数值通量](@entry_id:752791)的设计理念及其在求解[复杂流动](@entry_id:747569)问题中的作用进行剖析。最后，我们将介绍DG方法的一些高阶理论性质，如[熵稳定性](@entry_id:749023)和超收敛性，这些性质是其在计算流体动力学（CFD）领域获得成功的关键。

### [间断伽辽金弱形式](@entry_id:748377)的构建

[DG方法](@entry_id:748369)的基础在于其处理[偏微分方程](@entry_id:141332)（PDE）积分形式的独特方式。考虑一个一维[标量守恒律](@entry_id:754532)：
$$
\partial_t u + \partial_x f(u) = 0
$$
其中 $u$ 是[守恒变量](@entry_id:747720)，$f(u)$ 是其对应的通量函数。与在整个求解域上构建[弱形式](@entry_id:142897)的连续伽辽金（Continuous Galerkin, CG）方法不同，[DG方法](@entry_id:748369)在每个不重叠的计算单元 $K$ 上独立构建弱形式。

我们首先将守恒律方程乘以一个测试函数 $v$，并在单元 $K$ 上进行积分：
$$
\int_{K} (\partial_t u_h) v \, dx + \int_{K} (\partial_x f(u_h)) v \, dx = 0
$$
此处，$u_h$ 是 $u$ 在一个分片多项式[函数空间](@entry_id:143478)中的近似解。DG方法的核心步骤在于对包含空间导数的第二项应用**[分部积分](@entry_id:136350)** [@problem_id:3295168]。这会产生一个单元内部的积分项和一个边界项：
$$
\int_{K} (\partial_x f(u_h)) v \, dx = [f(u_h)v]_{\partial K} - \int_{K} f(u_h) (\partial_x v) \, dx
$$
将此式代回原[弱形式](@entry_id:142897)，得到：
$$
\int_{K} (\partial_t u_h) v \, dx - \int_{K} f(u_h) (\partial_x v) \, dx + [f(u_h)v]_{\partial K} = 0
$$
此处的边界项 $[f(u_h)v]_{\partial K}$ 是在单元 $K$ 的边界 $\partial K$ 上计算的。关键在于，[DG方法](@entry_id:748369)允许解 $u_h$ 在单元边界上是间断的。这意味着在任意一个单元交界面上，$u_h$ 会有两个迹——分别来自左右两个相邻单元，我们记为 $u_h^-$ 和 $u_h^+$。因此，物理通量 $f(u_h)$ 在交界面上不是唯一确定的。

为了解决这个问题，DG方法引入了**数值通量 (numerical flux)** 的概念，记为 $\widehat{f}(u_h^-, u_h^+)$。数值通量是一个单值函数，其值依赖于交界面两侧的解的状态，旨在近似真实的物理通量，并为相邻单元提供耦合机制。用[数值通量](@entry_id:752791)替换边界项中的物理通量，我们得到[DG方法](@entry_id:748369)的标准[弱形式](@entry_id:142897) [@problem_id:3295168]：
$$
\int_{K} (\partial_t u_h) v \, dx - \int_{K} f(u_h) (\partial_x v) \, dx + \int_{\partial K} \widehat{f}(u_h^-, u_h^+) v \, n_K \, ds = 0
$$
其中 $n_K$ 是单元 $K$ 的单位外法向向量。这个公式是[DG方法](@entry_id:748369)所有性质的出发点。与CG方法相比，CG方法的[基函数](@entry_id:170178)是全局连续的，导致分部积分后所有内部单元交界面的边界项都因数值和测试[函数的连续性](@entry_id:193744)而精确抵消，从而失去了在单元交界面引入[物理信息](@entry_id:152556)（如[迎风](@entry_id:756372)特性）的直接机制 [@problem_id:3295184]。DG方法通过引入数值通量，恰恰保留了这种可能性，赋予了其独特的灵活性和强大的功能。

### DG方法的基石：守恒性与稳定性

[DG方法](@entry_id:748369)最引人注目的优点之一是其天然的局部守恒性。这一性质直接源于其弱形式的构建方式，并通过对数值通量的精心设计得以保证。

#### 局部与全局守恒性

在DG的[弱形式](@entry_id:142897)中，如果我们选择一个特殊的测试函数，即在当前单元 $K$ 上 $v \equiv 1$ 且在其他所有单元上为零（这在DG的分片函数空间中是允许的），那么测试函数的导数项 $\partial_x v$ 就为零。此时，弱形式方程简化为 [@problem_id:3295184]：
$$
\frac{d}{dt} \int_{K} u_h \, dx + \int_{\partial K} \widehat{f} \, n_K \, ds = 0
$$
这个方程有一个清晰的物理解释：单元 $K$ 内守恒量 $u_h$ 的总量随时间的变化率，精确地等于通过该单元边界的净数值通量。这正是**离散局部守恒性 (discrete local conservation)** 的数学表述。

将所有单元的局部守恒方程相加，我们可以考察全局守恒性。对于任意一个内部交界面，它被两个相邻单元共享。根据DG的构造，这两个单元在此交界面上使用完全相同的[数值通量](@entry_id:752791)值，但它们的单位外法向向量恰好相反 ($n_L = -n_R$)。因此，在求和过程中，所有内部交界面上的通量项都会成对抵消。最终，总量的变化只取决于整个计算域物理边界上的通量，这证明了方法的**全局守恒性 (global conservation)** [@problem_id:3295184]。这种严格的守恒性对于正确模拟包含激波等间断的流动至关重要，因为它能确保间断的传播速度遵循正确的物理规律（如[Rankine-Hugoniot条件](@entry_id:181986)）。

#### [数值通量](@entry_id:752791)的基本性质

数值通量的选择对[DG方法](@entry_id:748369)的稳定性和精度起着决定性作用。一个设计良好的[数值通量](@entry_id:752791)通常需要满足以下几个基本性质 [@problem_id:3295131]：

*   **相容性 (Consistency)**：当交界面两侧的状态相同时，即 $u_L = u_R = u$，数值通量必须退化为物理通量：$\widehat{f}(u,u) = f(u)$。这是保证离散格式在解光滑时能够收敛到原[偏微分方程](@entry_id:141332)的必要条件。

*   **守恒性 (Conservation)**：如前所述，数值通量在交界面上的[单值性](@entry_id:174849)是保证离散格式守恒的关键。这通常通过要求数值通量函数对于其左右状态的交换和法向反转具有某种对称性来实现，例如 $\widehat{f}(u_L, u_R; n) = -\widehat{f}(u_R, u_L; -n)$。

*   **[单调性](@entry_id:143760) (Monotonicity)**：对于[标量守恒律](@entry_id:754532)，如果一个数值通量 $\widehat{f}(u_L, u_R)$ 关于其第一个参数 $u_L$ 是单调不减的，关于第二个参数 $u_R$ 是单调不增的，即 $\partial\hat{f}/\partial u_L \ge 0$ 和 $\partial\hat{f}/\partial u_R \le 0$，则称该通量是单调的。对于[一阶精度](@entry_id:749410)（$p=0$）的[DG格式](@entry_id:178043)，单调通量可以保证格式不产生新的[极值](@entry_id:145933)，从而避免在激波附近产生非物理的[振荡](@entry_id:267781)。对于高阶[DG格式](@entry_id:178043)，虽然格式本身不是单调的，但单调通量构成了其稳定化（如[斜率限制器](@entry_id:638003)）的理论基础，对于捕捉强间断至关重要。

### 实践应用：[基函数](@entry_id:170178)表示与离散算子

将[DG弱形式](@entry_id:748377)转化为可计算的代数系统，需要选择一组[基函数](@entry_id:170178)来表示每个单元内的解，并由此形成离散的矩阵和向量。

#### [基函数](@entry_id:170178)的选择：模态与节点

在DG方法中，主要使用两类[基函数](@entry_id:170178) [@problem_id:3295140]：

*   **[模态基](@entry_id:752055) (Modal Basis)**：这类[基函数](@entry_id:170178)通常是一组在[参考单元](@entry_id:168425)上相互正交的多项式，例如**[勒让德多项式](@entry_id:141510) (Legendre polynomials)** $\{P_m(x)\}_{m=0}^k$。解的表示为 $u_h(x) = \sum_{m=0}^k \hat{u}_m P_m(x)$，其中系数 $\{\hat{u}_m\}$ 称为**[模态系数](@entry_id:752057)**，代表了解在不同“模式”上的投影。[模态基](@entry_id:752055)的一个主要优点是，由于其正交性，离散化后得到的**[质量矩阵](@entry_id:177093) (mass matrix)** 是对角的，这在代数上非常优雅，简化了理论分析和某些计算。

*   **[节点基](@entry_id:752522) (Nodal Basis)**：这类[基函数](@entry_id:170178)是与单元内一组特定节点相关联的[拉格朗日插值多项式](@entry_id:176861) $\{\ell_i(x)\}_{i=0}^k$。常用的节点是**[高斯-洛巴托-勒让德](@entry_id:749736) ([Gauss-Lobatto-Legendre](@entry_id:749736), GLL) 点**。解的表示为 $u_h(x) = \sum_{i=0}^k u(\xi_i) \ell_i(x)$，其系数直接就是解在这些节点上的物理值，称为**节点值**。这种表示非常直观。虽然使用精确积分时其[质量矩阵](@entry_id:177093)是稠密的，但如果采用与[基函数](@entry_id:170178)节点相同的GLL点进行[数值积分](@entry_id:136578)，质量矩阵会奇迹般地也变成对角矩阵。这个过程被称为**[质量集中](@entry_id:175432) (mass lumping)**，它极大地提高了[显式时间推进](@entry_id:749180)格式的计算效率，因为[对角质量矩阵](@entry_id:173002)的求逆是平凡的 [@problem_id:3295117]。

这两套基之间可以通过一个[线性变换矩阵](@entry_id:186379)进行转换。例如，对于 $k=3$ 的情况，从4个模态勒让德系数到4个GLL节点值的[变换矩阵](@entry_id:151616)可以通过在GLL节点上计算[勒让德多项式](@entry_id:141510)的值得到 [@problem_id:3295140]。

#### 矩阵形式的[半离散系统](@entry_id:754680)

将解的[基函数](@entry_id:170178)展开式代入弱形式，并依次令测试函数 $v$ 等于每个[基函数](@entry_id:170178) $\phi_i$，我们便得到一个[常微分方程](@entry_id:147024)（ODE）组，其矩阵形式通常写作 [@problem_id:3295138]：
$$
\mathbf{M}\,\dot{\mathbf{u}} = \mathbf{R}(\mathbf{u})
$$
其中 $\mathbf{u}$ 是包含所有[模态系数](@entry_id:752057)或节点值的向量，$\mathbf{M}$ 是质量矩阵，其元素为 $M_{ij} = \int_K \phi_i \phi_j \,dx$。右端项 $\mathbf{R}(\mathbf{u})$ 包含了所有空间相关的项，通常可以分解为一个与单元内部相关的**刚度矩阵 (stiffness matrix)** $\mathbf{S}$ 和一个来自边界数值通量的贡献。例如，对于线性平流方程 $u_t + a u_x = 0$，[半离散系统](@entry_id:754680)可以写为 $\mathbf{M}\,\dot{\mathbf{u}} = -a\mathbf{S}\mathbf{u} + \mathbf{B}(\hat{f})$，其中 $S_{ij} = \int_K \phi_j \phi'_i \,dx$（经过分部积分后）。

以一阶勒让德[基函数](@entry_id:170178)（$k=1$，$\phi_0=1, \phi_1=x$）在参考单元 $[-1,1]$ 上为例，我们可以显式地计算出[对角质量矩阵](@entry_id:173002) $\mathbf{M}$ 和（非对角的）刚度矩阵 $\mathbf{S}$，从而将抽象的理论具体化 [@problem_id:3295138]。

### [数值通量](@entry_id:752791)的深入探讨

[数值通量](@entry_id:752791)是[DG方法](@entry_id:748369)的核心机制，其设计直接影响到方法的耗散性、[色散](@entry_id:263750)性以及处理特定物理现象的能力。

#### [迎风](@entry_id:756372)思想与基本通量

对于双曲问题，信息沿特征线传播。**[迎风](@entry_id:756372) (upwind)** 思想就是让离散格式能够感知并顺应这种定向传播。在[DG方法](@entry_id:748369)中，这通过设计数值通量来实现。对于线性[平流方程](@entry_id:144869) $u_t + a u_x = 0$ 且 $a>0$，信息从左向右传播，因此在交界面上，上游（左侧）的状态 $u^-$ 决定了下游的状态。[迎风通量](@entry_id:143931)据此定义为 $\widehat{f} = f(u^-) = a u^-$ [@problem_id:3295168]。

另一个常见的通量是**[Rusanov通量](@entry_id:637224)**（或称**局部Lax-Friedrichs通量**），其形式为 $\widehat{f} = \frac{1}{2}(f(u^-)+f(u^+)) - \frac{1}{2}\alpha(u^+ - u^-)$，其中 $\alpha$ 是最大[特征速度](@entry_id:165394)的估计。有趣的是，对于线性[平流方程](@entry_id:144869) $u_t + a u_x = 0$ ($a>0$)，取 $\alpha=|a|=a$，[Rusanov通量](@entry_id:637224)在代数上恰好等价于[迎风通量](@entry_id:143931) [@problem_id:3295144]。

#### 针对复杂系统的通量：[近似黎曼求解器](@entry_id:267136)

对于像[欧拉方程](@entry_id:177914)这样的[方程组](@entry_id:193238)，物理现象（如声波、[接触间断](@entry_id:194702)、剪切波）更加复杂。此时，数值通量通常由一个**[近似黎曼求解器](@entry_id:267136) (approximate Riemann solver)** 给出。常见的例子包括 [@problem_id:3295207]：

*   **[HLL通量](@entry_id:750354)**：这是一个简单的双波模型，它只考虑最左和最右的波（通常是声波），并将它们之间的所有中间结构（如接触间断和剪切波）“模糊化”。因此，[HLL通量](@entry_id:750354)[耗散性](@entry_id:162959)较强，无法精确解析接触间断。

*   **[HLLC通量](@entry_id:750350)**：这是HLL的改进版（C代表Contact），它在双波模型中显式地加入了一道中间波，专门用于捕捉[接触间断](@entry_id:194702)和剪切波。因此，HLLC能够清晰地解析这些线性退化波。

*   **[Roe通量](@entry_id:754409)**：该通量通过在交界面处构造一个[局部线性化](@entry_id:169489)的黎曼问题来获得，它能够分辨完整的波结构。因此，[Roe通量](@entry_id:754409)也能精确地解析[接触间断](@entry_id:194702)。

考虑一个仅包含静止接触间断的[黎曼问题](@entry_id:171440)（例如，两侧压力和速度相同，但密度不同）。使用[HLL通量](@entry_id:750354)的DG方法会由于其内在的数值耗散而使密度跳跃变得模糊不清，而HLLC和[Roe通量](@entry_id:754409)则能保持间断的清晰度。这清晰地展示了为特定物理现象选择合适通量的重要性 [@problem_id:3295207]。

#### [熵守恒](@entry_id:749018)与[能量稳定性](@entry_id:748991)

对于[非线性](@entry_id:637147)守恒律，即使是光滑初值也可能发展出间断解（激波）。物理上合理的激波必须满足**[熵增原理](@entry_id:142282)**。在数值上，这意味着格式需要具有某种形式的耗散来抑制非物理的膨胀激波。

一个更强的概念是**[熵守恒](@entry_id:749018)**。对于一个给定的熵函数 $\eta(u)$，可以构造一个**[熵守恒通量](@entry_id:749013) (entropy-conservative flux)**，这种通量在离散层面上精确地守恒熵（对于光滑解）。Tadmor为此提供了一个判据：[数值通量](@entry_id:752791)乘以熵变量的跳跃等于一个所谓的“通量势”的跳跃 [@problem_id:3295156]。基于此，我们可以为[Burgers方程](@entry_id:177995) $u_t + (u^2/2)_x = 0$ 推导出其[熵守恒通量](@entry_id:749013)为 $\widehat{f}^{\mathrm{ec}}(u_L, u_R) = \frac{1}{3}(u_L^2 + u_L u_R + u_R^2)$。[熵守恒通量](@entry_id:749013)本身没有耗散，但它是构造[熵稳定格式](@entry_id:749017)（即保证熵耗散的格式）的基础。

与熵相关的另一个概念是**[能量稳定性](@entry_id:748991)**。对于某些特定的[DG格式](@entry_id:178043)，例如在GLL节点上使用[节点基](@entry_id:752522)，并采用一种特殊的“斜对称”分裂形式来处理[非线性](@entry_id:637147)项时，可以证明格式的离散能量是守恒的（在周期边界条件下）。这依赖于离散微分算子所具有的**[分部求和](@entry_id:185335) (summation-by-parts, SBP)** 性质，它在离散层面完美地模拟了分部积分 [@problem_id:3295117]。这种[能量稳定性](@entry_id:748991)是格式长期[数值积分](@entry_id:136578)稳定性的有力保证。

### [DG方法](@entry_id:748369)的高阶性质

除了局部守恒和灵活性，DG方法还具备一些不那么直观但非常强大的高阶理论性质。

#### [色散](@entry_id:263750)与耗散

所有数值格式在逼近波动问题时都会引入误差，这些误差可以分解为**耗散误差 (dissipation error)**（波幅衰减）和**[色散误差](@entry_id:748555) (dispersion error)**（波速依赖于波长，导致波形变形）。通过对离散算子进行傅里叶分析（或称[Bloch波](@entry_id:144558)分析），可以得到格式的[数值色散关系](@entry_id:752786) $\omega_{\text{num}}(k)$，并将其与真实[色散关系](@entry_id:140395) $\omega_{\text{real}}(k)$ 对比。数值相速度 $c_{\text{num}} = \operatorname{Re}(\omega_{\text{num}})/k$ 与真实相速度的差异反映了[色散误差](@entry_id:748555)。分析表明，[DG格式](@entry_id:178043)的阶数越高，其在给定的分辨率下能准确模拟的波数范围就越广 [@problem_id:3295144]。

#### 超收敛

一般而言，对于光滑解，DG-$P^k$ 方法（使用 $k$ 阶多项式）的 $L^2$ 范数误差以 $h^{k+1}$ 的速率收敛，其中 $h$ 是单元尺寸。然而，一个令人惊讶的现象是，在每个单元内部的某些特定点上，点误差的[收敛速度](@entry_id:636873)会比[全局误差](@entry_id:147874)的[收敛阶](@entry_id:146394)更高，达到 $h^{k+2}$ 甚至更高。这种现象被称为**超收敛 (superconvergence)** [@problem_id:3295134]。

对于线性平流方程，研究表明，DG解的误差在单元内的[分布](@entry_id:182848)并非随机，而是具有一个确定的多项式结构。这个误差结构的主导项与一类特殊的正交多项式——**Radau多项式**——有关。超收敛点正是这些Radau多项式的零点。例如，对于DG-$P^1$ 方法，在每个单元的参考坐标 $\xi = -1/3$ 处，点[误差收敛](@entry_id:137755)阶为3阶（$\mathcal{O}(h^3)$）。对于DG-$P^2$ 方法，在 $\xi = (-1 \pm \sqrt{6})/5$ 这两个点，[误差收敛](@entry_id:137755)阶为4阶（$\mathcal{O}(h^4)$）。超收敛现象不仅在理论上非常有趣，也为开发更高精度的后处理技术和自适应方法提供了基础。