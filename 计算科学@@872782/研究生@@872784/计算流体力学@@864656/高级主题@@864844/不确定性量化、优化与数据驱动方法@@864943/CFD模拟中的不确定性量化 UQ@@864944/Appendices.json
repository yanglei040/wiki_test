{"hands_on_practices": [{"introduction": "在深入研究复杂的不确定性传播方法之前，一个至关重要的步骤是评估不同不确定性来源的相对重要性。本练习将指导您完成一个标准的验证流程，使用网格收敛指数 (Grid Convergence Index, GCI) 来量化离散不确定性，并将其与输入参数不确定性的简单估计进行比较。这项实践有助于回答一个关键问题：“我的模拟不确定性主要是由数值误差主导，还是由物理输入的不确定性主导？” [@problem_id:3385630]", "problem": "在一项计算流体动力学 (CFD) 的稳态层流模拟中，预测了一个标量关注量 (QoI)，记为 $Q$。该预测是在$3$个几何加密比为 $r = 2$ 的连续加密、均匀拉伸的网格上进行的。假设解处于网格收敛的渐近范围内，因此截断误差可用模型 $Q(h) = Q_{0} + C h^{p}$ 表示，其中 $h$ 是一个代表性的网格间距，$Q_{0}$ 是连续介质（零网格尺寸）极限值，$C$ 是一个常数，$p$ 是观测到的精度阶数。在粗、中、细网格上的QoI值分别为\n$Q_{1} = 0.590$、$Q_{2} = 0.542$ 和 $Q_{3} = 0.530$。\n\n要求：\n- 使用渐近误差模型，根据三套网格的数据推断观测到的阶数 $p$。\n- 从第一性原理出发，利用三套网格的结构和已知的加密比 $r$ 消除 $C$ 和 $h$，从而获得连续介质外推值 $Q_{0}$。\n- 使用美国机械工程师学会 (ASME) 标准化的网格收敛指数 (GCI) 方法，量化细网格上的离散不确定度，其中安全系数为 $\\beta = 1.25$。将GCI视为围绕 $Q_{3}$ 的一个相对半宽。\n\n一个不确定的输入参数 $\\alpha$ 被建模为高斯随机变量，其均值为 $\\alpha_{0}$，标准差为 $\\sigma_{\\alpha} = 0.020$。在 $\\alpha_{0}$ 附近的局部灵敏度分析得出 $\\left.\\frac{\\partial Q}{\\partial \\alpha}\\right|_{\\alpha_{0}} = S = 0.160$。在 $\\alpha_{0}$ 邻域内，$Q$ 对 $\\alpha$ 呈线性响应的假设下，将由输入引起的 $Q$ 的标准差建模为 $U_{\\mathrm{in}} = |S| \\,\\sigma_{\\alpha}$。\n\n定义细网格上的离散不确定度与输入不确定度之比为 $\\rho = \\dfrac{U_{\\mathrm{disc}}}{U_{\\mathrm{in}}}$，其中 $U_{\\mathrm{disc}}$ 是从GCI推断出的与 $Q_{3}$ 相关的绝对（非相对）离散不确定度，$U_{\\mathrm{in}}$ 的定义如上。\n\n最终答案只报告 $\\rho$ 的值，该值应四舍五入到4位有效数字，并作为一个无量纲数。最终答案中不应报告任何其他量。", "solution": "问题要求计算来自计算流体动力学 (CFD) 模拟中关注量 (QoI) $Q$ 的离散不确定度与输入参数不确定度之比。\n\n首先，我们验证问题陈述。\n**步骤1：提取已知条件**\n- 误差模型: $Q(h) = Q_{0} + C h^{p}$\n- 网格加密比: $r = 2$\n- 粗网格 ($h_1$) 上的QoI: $Q_1 = 0.590$\n- 中等网格 ($h_2$) 上的QoI: $Q_2 = 0.542$\n- 细网格 ($h_3$) 上的QoI: $Q_3 = 0.530$\n- GCI安全系数: $\\beta = 1.25$\n- 输入参数标准差: $\\sigma_{\\alpha} = 0.020$\n- QoI对输入参数的灵敏度: $S = \\left.\\frac{\\partial Q}{\\partial \\alpha}\\right|_{\\alpha_{0}} = 0.160$\n- 输入引起的不确定度模型: $U_{\\mathrm{in}} = |S| \\,\\sigma_{\\alpha}$\n- 离散不确定度: $U_{\\mathrm{disc}}$，从GCI推导出的细网格上的绝对不确定度。\n- 待计算的比率: $\\rho = \\dfrac{U_{\\mathrm{disc}}}{U_{\\mathrm{in}}}$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了CFD中验证和不确定度量化的标准方法（理查森外推法，网格收敛指数）。这是一个适定问题，为获得唯一解提供了所有必要数据。语言客观而精确。该问题有效。\n\n我们开始求解。\n\n第一步是根据三套网格的数据确定观测到的精度阶数 $p$。三套网格上的QoI可以写为：\n$$Q_1 = Q(h_1) = Q_0 + C h_1^p$$\n$$Q_2 = Q(h_2) = Q_0 + C h_2^p$$\n$$Q_3 = Q(h_3) = Q_0 + C h_3^p$$\n网格间距通过加密比 $r$ 相关联，其中 $h_1 = r h_2 = r^2 h_3$。让我们考虑连续网格之间QoI的差值：\n$$Q_1 - Q_2 = C(h_1^p - h_2^p) = C( (r h_2)^p - h_2^p) = C h_2^p (r^p - 1)$$\n$$Q_2 - Q_3 = C(h_2^p - h_3^p) = C( (r h_3)^p - h_3^p) = C h_3^p (r^p - 1)$$\n对这些差值取比值，可以消去常数 $C$ 和项 $(r^p - 1)$：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{C h_2^p (r^p - 1)}{C h_3^p (r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\n我们可以通过取自然对数来求解 $p$：\n$$p \\ln(r) = \\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)$$\n$$p = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}$$\n代入给定值 $Q_1=0.590$、$Q_2=0.542$、$Q_3=0.530$ 和 $r=2$：\n$$Q_1 - Q_2 = 0.590 - 0.542 = 0.048$$\n$$Q_2 - Q_3 = 0.542 - 0.530 = 0.012$$\n$$p = \\frac{\\ln\\left(\\frac{0.048}{0.012}\\right)}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{2\\ln(2)}{\\ln(2)} = 2$$\n观测到的精度阶数为 $p=2$。\n\n接下来，我们量化细网格 ($h_3$) 上的离散不确定度 $U_{\\mathrm{disc}}$。这是从网格收敛指数 (GCI) 方法推导出来的。细网格上的估计误差 $E_3 = Q_3 - Q_0$ 可以与细网格和中等网格上的解之差相关联。根据上面推导的 $Q_2 - Q_3$ 的方程：\n$$Q_2 - Q_3 = C h_3^p (r^p - 1)$$\n误差 $E_3$ 近似为 $E_3 \\approx C h_3^p$。将此代入前一个方程得到：\n$$Q_2 - Q_3 \\approx E_3 (r^p - 1)$$\n求解细网格上的估计误差：\n$$E_3 \\approx \\frac{Q_2 - Q_3}{r^p - 1}$$\n问题指出 $U_{\\mathrm{disc}}$ 是绝对离散不确定度，通过将安全系数 $\\beta$ 应用于估计误差的绝对值得到。\n$$U_{\\mathrm{disc}} = \\beta |E_3| = \\beta \\left|\\frac{Q_2 - Q_3}{r^p - 1}\\right|$$\n代入已知值 $\\beta=1.25$、$p=2$、$r=2$ 和差值 $Q_2 - Q_3 = 0.012$：\n$$U_{\\mathrm{disc}} = 1.25 \\times \\left|\\frac{0.012}{2^2 - 1}\\right| = 1.25 \\times \\frac{0.012}{3} = 1.25 \\times 0.004 = 0.005$$\n\n接下来，我们计算由输入引起的不确定度 $U_{\\mathrm{in}}$。问题提供了基于一阶灵敏度分析的模型：\n$$U_{\\mathrm{in}} = |S| \\,\\sigma_{\\alpha}$$\n代入给定值 $S=0.160$ 和 $\\sigma_{\\alpha}=0.020$：\n$$U_{\\mathrm{in}} = |0.160| \\times 0.020 = 0.160 \\times 0.020 = 0.0032$$\n\n最后，我们计算离散不确定度与输入不确定度之比 $\\rho$：\n$$\\rho = \\frac{U_{\\mathrm{disc}}}{U_{\\mathrm{in}}}$$\n代入计算出的 $U_{\\mathrm{disc}}$ 和 $U_{\\mathrm{in}}$ 的值：\n$$\\rho = \\frac{0.005}{0.0032} = \\frac{500}{320} = \\frac{50}{32} = \\frac{25}{16} = 1.5625$$\n问题要求将此值四舍五入到4位有效数字。将 $1.5625$ 四舍五入到四位有效数字得到 $1.563$。", "answer": "$$\\boxed{1.563}$$", "id": "3385630"}, {"introduction": "一旦我们确定输入不确定性是显著的，下一步就是找出哪些输入对输出方差的贡献最大。本练习介绍了一种强大的技术——基于方差的全局敏感性分析 (Global Sensitivity Analysis, GSA)，通过为一个简单模型解析计算索博尔指数 (Sobol' indices) 来实现。这项实践将揭示我们如何将输出不确定性归因于单个输入及其交互作用，这是将UQ工作集中在最关键之处的基石。[@problem_id:3385687]", "problem": "考虑在计算流体力学 (CFD) 中对一个无量纲的目标量 $Q$ 进行基于方差的全局敏感性分析，其中 $Q$ 代表，例如，来自稳态模拟的归一化壁面剪切应力。假设 $Q$ 由双线性代理模型 $Q(X_{1},X_{2}) = a X_{1} + b X_{2} + c X_{1} X_{2}$ 近似，其中 $X_{1}$ 和 $X_{2}$ 是独立的不确定性输入，均在 $[0,1]$ 上服从均匀分布，且 $a$、$b$、$c$ 是通过对模拟数据进行回归分析得到的固定实常数。使用由方差分析 (ANOVA) 表示法导出的方差分解框架以及 Sobol’ 指数关于条件期望和方差的标准定义，确定 $X_{1}$ 和 $X_{2}$ 的一阶 Sobol’ 指数 $S_{1}$ 和 $S_{2}$，以及 $X_{1}$ 的全阶 Sobol’ 指数 $S_{T_{1}}$，并以 $a$、$b$ 和 $c$ 的函数形式表示为闭式解。所有变量和常数均为无量纲。将最终答案表示为关于三元组 $\\left(S_{1}, S_{2}, S_{T_{1}}\\right)$ 的单一解析表达式。", "solution": "题目陈述已经过严格评估并被确定为有效。它在科学上基于不确定性量化和统计学原理，特别是基于方差的全局敏感性分析 (GSA)。该问题是适定的，提供了推导所求 Sobol’ 指数的唯一解析解所需的所有信息。其语言是客观的，设定在数学上是一致的。\n\n目标量 $Q$ 由代理模型 $Q(X_{1},X_{2}) = a X_{1} + b X_{2} + c X_{1} X_{2}$ 给出。输入 $X_{1}$ 和 $X_{2}$ 是独立的随机变量，在区间 $[0,1]$ 上服从均匀分布。对于一个随机变量 $X \\sim U[0,1]$，其前两阶矩为：\n$$E[X] = \\int_{0}^{1} x \\, dx = \\frac{1}{2}$$\n$$E[X^2] = \\int_{0}^{1} x^2 \\, dx = \\frac{1}{3}$$\n$X$ 的方差为：\n$$\\text{Var}(X) = E[X^2] - (E[X])^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{12}$$\n\nSobol' 敏感性指数基于对 $Q(X_{1}, X_{2})$ 的方差分析 (ANOVA) 或函数分解：\n$$Q(X_{1}, X_{2}) = f_0 + f_1(X_1) + f_2(X_2) + f_{12}(X_1, X_2)$$\n其中各项定义如下：\n- 常数项是 $Q$ 的总均值：$f_0 = E[Q]$。\n- 一阶项为：$f_1(X_1) = E_{X_2}[Q|X_1] - f_0$ 和 $f_2(X_2) = E_{X_1}[Q|X_2] - f_0$。\n- 二阶交互项为：$f_{12}(X_1, X_2) = Q - f_0 - f_1(X_1) - f_2(X_2)$。\n\n根据构造，这些项是正交的，意味着它们乘积的期望为零。这就导出了方差分解：\n$$V = \\text{Var}(Q) = \\text{Var}(f_1) + \\text{Var}(f_2) + \\text{Var}(f_{12}) = V_1 + V_2 + V_{12}$$\n\nSobol’ 指数定义为这些部分方差与总方差的比值：\n- $X_i$ 的一阶指数：$S_i = \\frac{V_i}{V} = \\frac{\\text{Var}(f_i)}{V}$\n- 二阶指数：$S_{12} = \\frac{V_{12}}{V} = \\frac{\\text{Var}(f_{12})}{V}$\n- $X_i$ 的全阶指数：$S_{T_i}$ 是包含 $X_i$ 的所有项的指数之和。对于本问题，$S_{T_1} = S_1 + S_{12}$。\n\n首先，我们计算给定函数 $Q$ 的 ANOVA 项。\n常数项 $f_0$ 为：\n$$f_0 = E[a X_{1} + b X_{2} + c X_{1} X_{2}] = a E[X_{1}] + b E[X_{2}] + c E[X_{1}]E[X_{2}]$$\n$$f_0 = a\\left(\\frac{1}{2}\\right) + b\\left(\\frac{1}{2}\\right) + c\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{a}{2} + \\frac{b}{2} + \\frac{c}{4}$$\n条件期望 $E_{X_2}[Q|X_1]$ 为：\n$$E_{X_2}[Q|X_1] = E_{X_2}[a X_{1} + b X_{2} + c X_{1} X_{2}] = aX_1 + bE[X_2] + cX_1E[X_2] = aX_1 + \\frac{b}{2} + \\frac{cX_1}{2}$$\n所以，一阶项 $f_1(X_1)$ 为：\n$$f_1(X_1) = \\left(aX_1 + \\frac{b}{2} + \\frac{cX_1}{2}\\right) - \\left(\\frac{a}{2} + \\frac{b}{2} + \\frac{c}{4}\\right) = \\left(a + \\frac{c}{2}\\right)X_1 - \\left(\\frac{a}{2} + \\frac{c}{4}\\right) = \\left(a + \\frac{c}{2}\\right) \\left(X_1 - \\frac{1}{2}\\right)$$\n根据对称性，将 $a$ 与 $b$ 交换，将 $X_1$ 与 $X_2$ 交换：\n$$f_2(X_2) = \\left(b + \\frac{c}{2}\\right) \\left(X_2 - \\frac{1}{2}\\right)$$\n交互项 $f_{12}(X_1, X_2)$ 为：\n$$f_{12}(X_1, X_2) = Q - f_0 - f_1(X_1) - f_2(X_2)$$\n$$f_{12}(X_1, X_2) = (a X_{1} + b X_{2} + c X_{1} X_{2}) - \\left(\\frac{a}{2} + \\frac{b}{2} + \\frac{c}{4}\\right) - \\left(a + \\frac{c}{2}\\right) \\left(X_1 - \\frac{1}{2}\\right) - \\left(b + \\frac{c}{2}\\right) \\left(X_2 - \\frac{1}{2}\\right)$$\n展开并化简得到：\n$$f_{12}(X_1, X_2) = c X_1 X_2 - \\frac{c X_1}{2} - \\frac{c X_2}{2} + \\frac{c}{4} = c\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right)$$\n\n接下来，我们计算这些项的方差。\n对于 $f_1(X_1)$：\n$$V_1 = \\text{Var}(f_1) = \\text{Var}\\left[\\left(a + \\frac{c}{2}\\right) \\left(X_1 - \\frac{1}{2}\\right)\\right] = \\left(a + \\frac{c}{2}\\right)^2 \\text{Var}\\left(X_1 - \\frac{1}{2}\\right) = \\left(a + \\frac{c}{2}\\right)^2 \\text{Var}(X_1)$$\n$$V_1 = \\frac{1}{12}\\left(a + \\frac{c}{2}\\right)^2 = \\frac{(2a+c)^2}{48}$$\n对于 $f_2(X_2)$：\n$$V_2 = \\text{Var}(f_2) = \\frac{1}{12}\\left(b + \\frac{c}{2}\\right)^2 = \\frac{(2b+c)^2}{48}$$\n对于 $f_{12}(X_1, X_2)$：\n$$V_{12} = \\text{Var}(f_{12}) = \\text{Var}\\left[c\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right)\\right] = c^2 \\text{Var}\\left[\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right)\\right]$$\n由于 $X_1$ 和 $X_2$ 是独立的且 $E[X_i - 1/2] = 0$，我们有：\n$$\\text{Var}\\left[\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right)\\right] = E\\left[\\left(X_1 - \\frac{1}{2}\\right)^2\\left(X_2 - \\frac{1}{2}\\right)^2\\right] = E\\left[\\left(X_1 - \\frac{1}{2}\\right)^2\\right]E\\left[\\left(X_2 - \\frac{1}{2}\\right)^2\\right]$$\n$$ = \\text{Var}(X_1)\\text{Var}(X_2) = \\left(\\frac{1}{12}\\right)\\left(\\frac{1}{12}\\right) = \\frac{1}{144}$$\n因此，交互方差为：\n$$V_{12} = \\frac{c^2}{144}$$\n总方差 $V$ 是这些部分方差之和：\n$$V = V_1 + V_2 + V_{12} = \\frac{(2a+c)^2}{48} + \\frac{(2b+c)^2}{48} + \\frac{c^2}{144}$$\n为了合并这些项，我们找到公分母 $144$：\n$$V = \\frac{3(2a+c)^2}{144} + \\frac{3(2b+c)^2}{144} + \\frac{c^2}{144}$$\n$$V = \\frac{3(4a^2+4ac+c^2) + 3(4b^2+4bc+c^2) + c^2}{144} = \\frac{12a^2+12ac+3c^2 + 12b^2+12bc+3c^2 + c^2}{144}$$\n$$V = \\frac{12a^2 + 12b^2 + 12ac + 12bc + 7c^2}{144}$$\n令 $D = 12a^2 + 12b^2 + 12ac + 12bc + 7c^2$。则 $V = \\frac{D}{144}$。\n\n现在我们可以计算 Sobol’ 指数。\n$X_1$ 的一阶指数为：\n$$S_1 = \\frac{V_1}{V} = \\frac{(2a+c)^2/48}{D/144} = \\frac{144}{48} \\frac{(2a+c)^2}{D} = \\frac{3(2a+c)^2}{D}$$\n$X_2$ 的一阶指数为：\n$$S_2 = \\frac{V_2}{V} = \\frac{(2b+c)^2/48}{D/144} = \\frac{144}{48} \\frac{(2b+c)^2}{D} = \\frac{3(2b+c)^2}{D}$$\n$X_1$ 的全阶指数是所有包含 $X_1$ 的项（即 $f_1$ 和 $f_{12}$）的贡献之和。\n$$S_{T_1} = S_1 + S_{12} = \\frac{V_1 + V_{12}}{V}$$\n分子是：\n$$V_1 + V_{12} = \\frac{(2a+c)^2}{48} + \\frac{c^2}{144} = \\frac{3(2a+c)^2 + c^2}{144} = \\frac{3(4a^2+4ac+c^2) + c^2}{144} = \\frac{12a^2+12ac+3c^2+c^2}{144} = \\frac{12a^2+12ac+4c^2}{144}$$\n所以，$S_{T_1}$ 是：\n$$S_{T_1} = \\frac{(12a^2+12ac+4c^2)/144}{D/144} = \\frac{12a^2+12ac+4c^2}{D} = \\frac{4(3a^2+3ac+c^2)}{D}$$\n最终的表达式，使用公分母 $D = 12a^2 + 12b^2 + 12ac + 12bc + 7c^2$，为：\n$$S_1 = \\frac{3(2a+c)^2}{12a^2 + 12b^2 + 12ac + 12bc + 7c^2}$$\n$$S_2 = \\frac{3(2b+c)^2}{12a^2 + 12b^2 + 12ac + 12bc + 7c^2}$$\n$$S_{T_1} = \\frac{4(3a^2+3ac+c^2)}{12a^2 + 12b^2 + 12ac + 12bc + 7c^2}$$\n题目要求得到三元组 $(S_1, S_2, S_{T_1})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3(2a+c)^2}{12a^2+12b^2+12ac+12bc+7c^2} & \\frac{3(2b+c)^2}{12a^2+12b^2+12ac+12bc+7c^2} & \\frac{4(3a^2+3ac+c^2)}{12a^2+12b^2+12ac+12bc+7c^2}\n\\end{pmatrix}\n}\n$$", "id": "3385687"}]}