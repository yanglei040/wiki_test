{"hands_on_practices": [{"introduction": "要理解大涡模拟（LES），我们必须首先掌握空间滤波这一核心概念。本练习提供了一个基础性的推导 [@problem_id:3338942]，要求您将一个简单的箱式滤波器应用于一个正弦波。通过推导滤波后的场及其传递函数，您将对滤波器如何在物理空间和谱空间中衰减小尺度信息建立起具体的认识，这是LES的核心机制。", "problem": "在大涡模拟 (LES) 中，空间滤波被定义为一个场与一个滤波核的卷积。考虑一个一维的空间均匀滤波器，其核函数为 $G(x;\\Delta)$，具有宽度为 $\\Delta$ 的紧支集。滤波后的场 $\\bar{\\phi}(x)$ 通过卷积定义为 $\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。取箱式核 $G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| \\le \\Delta/2}$ 和标量场 $\\phi(x) = \\sin(k x)$，其中 $k$ 是一个实波数。仅从卷积的定义和基本的三角恒等式出发，推导 $\\bar{\\phi}(x)$ 作为 $k$、$\\Delta$ 和 $x$ 的函数的封闭形式表达式。然后，将有效谱截断波数 $k_c$ 定义为使得滤波器一维传递函数的大小消失的最小正波数 $k$，并给出相应的无量纲乘积 $k_c \\Delta$ 的表达式。请将你的最终答案以一个单行向量的形式给出，其第一个条目是 $\\bar{\\phi}(x)$ 的精确表达式，第二个条目是 $k_c \\Delta$ 的精确值。不需要四舍五入，最终答案中不应包含单位。", "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **空间滤波的定义：** 滤波后的场 $\\bar{\\phi}(x)$ 是场 $\\phi(x)$ 与滤波核 $G(x;\\Delta)$ 的卷积：$\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。\n- **滤波核：** 一维箱式滤波核，$G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| \\le \\Delta/2}$，其中 $\\mathbb{1}$ 是指示函数，$\\Delta$ 是滤波器宽度。\n- **标量场：** 单一波数的正弦场，$\\phi(x) = \\sin(k x)$，其中 $k$ 是一个实波数。\n- **截断波数的定义：** 有效谱截断波数 $k_c$ 是使得滤波器一维传递函数的大小消失的最小正波数 $k$。\n- **任务：** 推导 $\\bar{\\phi}(x)$ 的封闭形式表达式，并求出无量纲乘积 $k_c \\Delta$ 的值。\n\n### 步骤 2：使用已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学性：** 该问题是大涡模拟 (LES) 数学基础中的一个标准练习，LES 是计算流体动力学的一个主要课题。卷积、滤波核和传递函数的概念是信号处理和湍流理论中的基本原理。\n- **适定性：** 提供了所有必要的函数 ($G$, $\\phi$)、定义 (卷积, $k_c$) 和约束条件。该问题是自洽的，其结构可以得出一个唯一的解。\n- **客观性：** 语言正式且精确，没有主观或含糊的陈述。\n- **未检测到其他缺陷：** 该问题并非不健全、不完整、自相矛盾、不切实际或不适定的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n第一步是通过计算卷积分来推导滤波后场 $\\bar{\\phi}(x)$ 的表达式。\n滤波后场的定义为：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr\n$$\n代入给定的滤波核 $G(r;\\Delta)$ 和标量场 $\\phi(x)$ 的表达式：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} \\left(\\frac{1}{\\Delta}\\,\\mathbb{1}_{|r| \\le \\Delta/2}\\right) \\sin(k(x-r))\\,dr\n$$\n指示函数 $\\mathbb{1}_{|r| \\le \\Delta/2}$ 在 $-\\Delta/2 \\le r \\le \\Delta/2$ 时等于 $1$，否则等于 $0$。此性质限制了积分的上下限：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(k(x-r))\\,dr\n$$\n为了计算这个积分，我们使用差角正弦的三角恒等式：$\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$。令 $A = kx$ 和 $B = kr$。\n$$\n\\sin(k(x-r)) = \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr)\n$$\n将其代入积分中：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\left[ \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr) \\right]\\,dr\n$$\n由于 $\\sin(kx)$ 和 $\\cos(kx)$ 不依赖于积分变量 $r$，它们可以从积分中提出：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr - \\frac{\\cos(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr\n$$\n我们现在分别计算这两个积分。\n第一个积分涉及到一个偶函数 $\\cos(kr)$ 在对称区间上的积分：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr = \\left[ \\frac{\\sin(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{\\sin(k\\Delta/2)}{k} - \\frac{\\sin(-k\\Delta/2)}{k}\n$$\n由于 $\\sin(-z) = -\\sin(z)$，上式可简化为：\n$$\n\\frac{\\sin(k\\Delta/2)}{k} + \\frac{\\sin(k\\Delta/2)}{k} = \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right)\n$$\n第二个积分涉及到一个奇函数 $\\sin(kr)$ 在对称区间上的积分。这样的积分总是为零。我们可以明确地验证这一点：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr = \\left[ -\\frac{\\cos(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = -\\frac{\\cos(k\\Delta/2)}{k} - \\left(-\\frac{\\cos(-k\\Delta/2)}{k}\\right)\n$$\n由于 $\\cos(-z) = \\cos(z)$，上式可简化为：\n$$\n-\\frac{\\cos(k\\Delta/2)}{k} + \\frac{\\cos(k\\Delta/2)}{k} = 0\n$$\n将这些结果代回 $\\bar{\\phi}(x)$ 的表达式中：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\left( \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\right) - \\frac{\\cos(kx)}{\\Delta} (0)\n$$\n$$\n\\bar{\\phi}(x) = \\frac{2}{k\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\sin(kx)\n$$\n为了突出滤波器的传递函数，可以方便地重写该表达式。通过重新排列各项，我们得到了所需答案的第一部分：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx)\n$$\n\n第二步是确定无量纲乘积 $k_c \\Delta$。\n将滤波器应用于单个傅里叶模式 $\\exp(ikx)$ 会导致该模式乘以滤波器的传递函数 $\\hat{G}(k)$。对于像 $\\phi(x) = \\sin(kx)$ 这样的实值场，假设核函数 $G(x)$ 是实偶函数（这对于箱式核是成立的），则滤波后的场为 $\\bar{\\phi}(x) = \\hat{G}(k)\\phi(x)$。\n通过将我们推导出的 $\\bar{\\phi}(x)$ 表达式与形式 $\\hat{G}(k)\\phi(x) = \\hat{G}(k)\\sin(kx)$ 进行比较，我们可以确定传递函数：\n$$\n\\hat{G}(k) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2}\n$$\n这是归一化的 sinc 函数，$\\text{sinc}(k\\Delta/2)$。\n根据问题定义，$k_c$ 是使得传递函数的大小 $|\\hat{G}(k)|$ 为零的最小正波数 $k$。由于 $\\hat{G}(k)$ 是实数，这等价于找到使 $\\hat{G}(k) = 0$ 的最小正波数 $k$。\n$$\n\\frac{\\sin(k_c\\Delta/2)}{k_c\\Delta/2} = 0\n$$\n要使此表达式为零，分子必须为零，而分母不为零（$k_c=0$ 的情况被排除，因为我们寻求的是正波数，并且在极限 $k\\to 0$ 时，$\\hat{G}(k) \\to 1$）。\n因此，条件是：\n$$\n\\sin\\left(\\frac{k_c\\Delta}{2}\\right) = 0\n$$\n$\\sin(\\theta) = 0$ 的通解是 $\\theta = n\\pi$，其中 $n$ 为任意整数。因此：\n$$\n\\frac{k_c\\Delta}{2} = n\\pi, \\quad n \\in \\mathbb{Z}\n$$\n我们寻求最小的正波数 $k_c$。由于滤波器宽度 $\\Delta$ 是正的，我们必须有 $n > 0$。最小的正整数是 $n=1$。\n$$\n\\frac{k_c\\Delta}{2} = \\pi\n$$\n求解无量纲乘积 $k_c \\Delta$，得到所需答案的第二部分：\n$$\nk_c \\Delta = 2\\pi\n$$\n其物理解释是，箱式滤波器完全移除了波长 $\\lambda = 2\\pi/k_c$ 等于滤波器宽度 $\\Delta$ 的波，即 $\\lambda_c = \\Delta$。\n\n最终答案由 $\\bar{\\phi}(x)$ 的表达式和 $k_c \\Delta$ 的值组成。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx)  2\\pi \\end{pmatrix}}\n$$", "id": "3338942"}, {"introduction": "在理解了滤波器的工作原理后，我们现在将其置于湍流的物理背景中。本练习 [@problem_id:3338969] 要求您基于Kolmogorov理论，估算一个给定的大涡模拟能解析出湍流能量级串的多大一部分。通过这个实践，您将深化对“尺度分离”这一LES核心思想的理解，并明白滤波器宽度的选择如何直接关联到所建模的能量动力学过程。", "problem": "一个边长为 $L$ 的立方、三维周期性域中，包含在盒子尺度上受强迫的统计平稳、均匀各向同性的不可压缩湍流。大尺度（积分）波数为 $k_0 = 2\\pi/L$。在 $k_0$ 和柯尔莫哥洛夫波数 $k_{\\eta} = 1/\\eta$ 之间的惯性区内，一维能谱遵循柯尔莫哥洛夫形式 $E(k) \\propto \\varepsilon^{2/3} k^{-5/3}$，其中 $\\varepsilon$ 是单位质量的平均能量耗散率。宽度为 $\\Delta$ 的大涡模拟（LES）滤波器在 $k_c \\approx \\pi/\\Delta$ 处施加了一个尖锐的谱截断。\n\n仅使用量纲推理和湍流理论的核心定义，完成以下任务：\n\n1) 从 $E(k)$ 的惯性区形式和尺度局域涡翻转时间 $\\tau(k)$ 的定义出发，推导波数在 $[k_0, K]$ 范围内的累积正向能量传输率的表达式，估计为 $\\Pi(K) \\sim \\int_{k_0}^{K} E(k)/\\tau(k)\\, \\mathrm{d}k$，并证明大涡模拟解析的累积传输与整个惯性区的总累积传输之比，\n$$\nf \\equiv \\frac{\\Pi(k_c)}{\\Pi(k_{\\eta})},\n$$\n可以完全用大尺度波数、截断波数和柯尔莫哥洛夫波数来表示。\n\n2) 采用以下模型假设来封闭该问题：\n- 尺度 $k$ 处的涡翻转时间满足 $\\tau(k) \\sim \\alpha\\, \\varepsilon^{-1/3} k^{-2/3}$，其中 $\\alpha$ 是一个 $\\mathcal{O}(1)$ 的常数。\n- 大尺度耗散系数为 $C_{\\varepsilon} = \\mathcal{O}(1)$，可取 $C_{\\varepsilon} = 1$，因此 $\\eta/L \\approx \\mathrm{Re}_L^{-3/4}$，其中 $\\mathrm{Re}_L \\equiv U L/\\nu$ 是大尺度雷诺数，特征速度为 $U$，运动粘度为 $\\nu$。\n\n给定 $L/\\Delta = 64$ 和 $\\mathrm{Re}_L = 10^{4}$，计算分数\n$$\nf = \\frac{\\Pi(k_c)}{\\Pi(k_{\\eta})}\n$$\n的值，结果为无量纲小数，并四舍五入到四位有效数字。使用 $k_c \\approx \\pi/\\Delta$、$k_0 = 2\\pi/L$ 和 $k_{\\eta} = 1/\\eta$，并在 $C_{\\varepsilon} = 1$ 的条件下使用 $\\eta/L \\approx \\mathrm{Re}_L^{-3/4}$。\n\n将最终答案表示为一个无单位的实数，并四舍五入到四位有效数字。", "solution": "该问题将按要求分两部分解决。首先，基于给定的定义对分数 $f$ 进行符号推导。其次，使用给定的参数对该分数进行数值计算。\n\n### 第1部分：解析的能量传输分数的符号推导\n\n问题指出，在由波数 $k$ 定义的湍流惯性区（满足 $k_0 \\le k \\le k_{\\eta}$）内，一维能谱遵循柯尔莫哥洛夫形式：\n$$\nE(k) = C_K \\varepsilon^{2/3} k^{-5/3}\n$$\n其中 $C_K$ 是无量纲的柯尔莫哥洛夫常数，其量级为1，而 $\\varepsilon$ 是单位质量的平均能量耗散率。\n\n问题还提供了尺度局域涡翻转时间 $\\tau(k)$ 的标度律：\n$$\n\\tau(k) = \\alpha \\varepsilon^{-1/3} k^{-2/3}\n$$\n其中 $\\alpha$ 是另一个量级为1的无量纲常数。该标度律与基于柯尔莫哥洛夫理论的量纲分析一致。\n\n从大尺度（对应波数 $k_0$）到波数 $K$ 的累积正向能量传输率由以下积分估计：\n$$\n\\Pi(K) \\sim \\int_{k_0}^{K} \\frac{E(k)}{\\tau(k)} \\, \\mathrm{d}k\n$$\n我们首先通过代入 $E(k)$ 和 $\\tau(k)$ 的表达式来计算被积函数：\n$$\n\\frac{E(k)}{\\tau(k)} = \\frac{C_K \\varepsilon^{2/3} k^{-5/3}}{\\alpha \\varepsilon^{-1/3} k^{-2/3}} = \\frac{C_K}{\\alpha} \\varepsilon^{(2/3 - (-1/3))} k^{(-5/3 - (-2/3))} = \\frac{C_K}{\\alpha} \\varepsilon^{1} k^{-1}\n$$\n量 $\\frac{C_K}{\\alpha}$ 是一个无量纲常数。我们将其记为 $C_{\\Pi} = \\frac{C_K}{\\alpha}$。被积函数简化为 $C_{\\Pi} \\varepsilon k^{-1}$。\n\n现在我们可以计算积分以求得累积能量传输率 $\\Pi(K)$：\n$$\n\\Pi(K) = \\int_{k_0}^{K} C_{\\Pi} \\varepsilon k^{-1} \\, \\mathrm{d}k = C_{\\Pi} \\varepsilon \\int_{k_0}^{K} \\frac{1}{k} \\, \\mathrm{d}k\n$$\n进行积分可得：\n$$\n\\Pi(K) = C_{\\Pi} \\varepsilon \\left[ \\ln(k) \\right]_{k_0}^{K} = C_{\\Pi} \\varepsilon (\\ln(K) - \\ln(k_0)) = C_{\\Pi} \\varepsilon \\ln\\left(\\frac{K}{k_0}\\right)\n$$\n问题将分数 $f$ 定义为大涡模拟解析的累积传输 $\\Pi(k_c)$ 与整个惯性区的总累积传输 $\\Pi(k_{\\eta})$ 之比。大涡模拟的截断波数是 $k_c$，惯性区的终点由柯尔莫哥洛夫波数 $k_{\\eta}$ 标记。\n$$\nf = \\frac{\\Pi(k_c)}{\\Pi(k_{\\eta})}\n$$\n代入我们关于 $\\Pi(K)$ 的表达式：\n$$\nf = \\frac{C_{\\Pi} \\varepsilon \\ln\\left(\\frac{k_c}{k_0}\\right)}{C_{\\Pi} \\varepsilon \\ln\\left(\\frac{k_{\\eta}}{k_0}\\right)}\n$$\n前置因子 $C_{\\Pi} \\varepsilon$ 被消去，留下一个仅依赖于问题特征波数的表达式：大涡尺度波数 $k_0$、大涡模拟滤波器截断尺度波数 $k_c$ 和柯尔莫哥洛夫耗散尺度波数 $k_{\\eta}$。\n$$\nf = \\frac{\\ln\\left(\\frac{k_c}{k_0}\\right)}{\\ln\\left(\\frac{k_{\\eta}}{k_0}\\right)}\n$$\n这就完成了问题的第一部分。\n\n### 第2部分：数值计算\n\n我们被要求使用给定参数计算 $f$：\n-   盒子尺寸与滤波宽度之比：$L/\\Delta = 64$。\n-   大尺度雷诺数：$\\mathrm{Re}_L = 10^4$。\n\n我们使用给定的波数定义：\n-   大尺度波数：$k_0 = 2\\pi/L$。\n-   大涡模拟截断波数：$k_c \\approx \\pi/\\Delta$。\n-   柯尔莫哥洛夫波数：$k_{\\eta} = 1/\\eta$。\n\n首先，我们计算比率 $k_c/k_0$：\n$$\n\\frac{k_c}{k_0} \\approx \\frac{\\pi/\\Delta}{2\\pi/L} = \\frac{\\pi}{\\Delta} \\frac{L}{2\\pi} = \\frac{1}{2} \\left(\\frac{L}{\\Delta}\\right)\n$$\n使用给定值 $L/\\Delta = 64$：\n$$\n\\frac{k_c}{k_0} \\approx \\frac{1}{2}(64) = 32\n$$\n\n接下来，我们计算比率 $k_{\\eta}/k_0$。\n$$\n\\frac{k_{\\eta}}{k_0} = \\frac{1/\\eta}{2\\pi/L} = \\frac{L}{2\\pi\\eta} = \\frac{1}{2\\pi} \\left(\\frac{L}{\\eta}\\right)\n$$\n我们得到了柯尔莫哥洛夫长度尺度 $\\eta$ 与积分长度尺度 $L$ 的比值关系，在 $C_{\\varepsilon} = 1$ 的条件下为 $\\eta/L \\approx \\mathrm{Re}_L^{-3/4}$。这意味着其反比为：\n$$\n\\frac{L}{\\eta} \\approx (\\mathrm{Re}_L^{-3/4})^{-1} = \\mathrm{Re}_L^{3/4}\n$$\n代入给定的雷诺数 $\\mathrm{Re}_L = 10^4$：\n$$\n\\frac{L}{\\eta} \\approx (10^4)^{3/4} = 10^{(4 \\times 3/4)} = 10^3 = 1000\n$$\n现在我们可以计算波数比 $k_{\\eta}/k_0$：\n$$\n\\frac{k_{\\eta}}{k_0} \\approx \\frac{1}{2\\pi} (1000) = \\frac{500}{\\pi}\n$$\n\n最后，我们将这些数值比率代入 $f$ 的表达式中：\n$$\nf = \\frac{\\ln(32)}{\\ln\\left(\\frac{500}{\\pi}\\right)}\n$$\n我们计算分子和分母的值：\n$$\n\\ln(32) = \\ln(2^5) = 5\\ln(2) \\approx 5 \\times 0.69314718 = 3.4657359\n$$\n$$\n\\frac{500}{\\pi} \\approx \\frac{500}{3.14159265} \\approx 159.154943\n$$\n$$\n\\ln\\left(\\frac{500}{\\pi}\\right) \\approx \\ln(159.154943) \\approx 5.0698003\n$$\n现在我们计算分数 $f$：\n$$\nf \\approx \\frac{3.4657359}{5.0698003} \\approx 0.68361304\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nf \\approx 0.6836\n$$\n这个结果表明，对于给定的参数，大涡模拟解析了大约 $68.36\\%$ 的发生在惯性区内的累积能量传输，剩余部分是亚格子尺度的，需要一个模型来处理。", "answer": "$$\n\\boxed{0.6836}\n$$", "id": "3338969"}, {"introduction": "最后一步是通过解决亚格子尺度（SGS）封闭问题，将理论与计算实践联系起来。本编程练习 [@problem_id:3339012] 要求您使用给定的合成直接数值模拟（DNS）数据，实现并评估经典的SGS模型，如尺度相似模型和混合模型。通过将模型计算的应力和能量通量与精确值进行比较，您将在SGS建模的实际挑战与目标方面获得宝贵的实践经验。", "problem": "考虑二维空间中的不可compress流以及大涡模拟（LES）的框架。从滤波后的方程出发，子格子尺度（SGS）应力张量由基于直接数值模拟（DNS）数据的精确关系定义为$$\\tau_{ij}^{\\mathrm{exact}} = \\overline{u_i u_j} - \\overline{u}_i \\,\\overline{u}_j,$$ 其中 $\\overline{\\cdot}$ 表示在 LES 滤波尺度上的空间滤波。尺度相似（SS）模型（也称为 Bardina 模型）仅使用已解的滤波场和测试滤波器来定义模型应力，如下所示：$$\\tau_{ij}^{\\mathrm{SS}} = \\widehat{\\overline{u}_i \\,\\overline{u}_j} - \\widehat{\\overline{u}}_i \\,\\widehat{\\overline{u}}_j,$$ 其中帽子符号表示在更大尺度上的第二次滤波（测试滤波）。在混合模型中，添加了涡粘性贡献来修正平均能量传递，该贡献由 Boussinesq 假设定义：$$\\tau_{ij}^{\\mathrm{EV}} = -2 \\nu_t S_{ij},\\quad \\nu_t = \\left(C_s \\,\\Delta\\right)^2 \\,\\lvert S \\rvert,$$ 其中可解尺度应变率为$$S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\overline{u}_i}{\\partial x_j} + \\frac{\\partial \\overline{u}_j}{\\partial x_i}\\right),\\quad \\lvert S \\rvert = \\sqrt{2\\,S_{ij} S_{ij}},$$ 模型常数为 $C_s$，滤波宽度为 $\\Delta$。混合应力为$$\\tau_{ij}^{\\mathrm{mix}} = \\tau_{ij}^{\\mathrm{SS}} - 2 \\nu_t S_{ij}.$$\n\n您将需要在一个离散的、周期性的、二维网格上实现这些定义，其无量纲间距 $h = 1$，并对任何三角函数求值使用弧度。设域为一个 $N \\times N$ 的网格，索引为 $(m,n)$，$m,n \\in \\{0,1,\\ldots,N-1\\}$。将 DNS 速度分量确定性地定义为网格指数的函数：\n$$u(m,n) = \\sin\\!\\left(\\frac{2\\pi f_x}{N}\\,m\\right)\\cos\\!\\left(\\frac{2\\pi f_y}{N}\\,n\\right) + 0.3\\,\\sin\\!\\left(\\frac{4\\pi f_x}{N}\\,m\\right)\\sin\\!\\left(\\frac{6\\pi f_y}{N}\\,n\\right),$$\n$$v(m,n) = -\\cos\\!\\left(\\frac{2\\pi f_x}{N}\\,m\\right)\\sin\\!\\left(\\frac{2\\pi f_y}{N}\\,n\\right) + 0.25\\,\\cos\\!\\left(\\frac{4\\pi f_x}{N}\\,m\\right)\\cos\\!\\left(\\frac{4\\pi f_y}{N}\\,n\\right).$$\n所有三角函数参数均以弧度为单位。\n\n使用离散、可分离的顶帽（箱式）滤波器，并采用周期性边界条件。设 LES 滤波器的半径为 $r_f \\in \\mathbb{N}$，则窗口大小为 $N_f = 2 r_f + 1$。标量场 $\\phi$ 的滤波后场 $\\overline{\\phi}$ 是以每个网格点为中心的 $(2r_f+1)\\times(2r_f+1)$ 邻域内的平均值，使用周期性环绕。测试滤波器的半径为 $r_t = \\alpha\\,r_f$，其中 $\\alpha \\ge 1$ 为整数，窗口大小为 $N_t = 2 r_t + 1$。对帽子滤波器使用相同的离散平均规则。\n\n通过对 DNS 的乘积和速度进行指定的滤波来计算 LES 滤波尺度下的精确 SGS 应力分量，并通过对 LES 滤波后速度的乘积应用测试滤波器来计算 SS 模型分量。使用二阶中心差分和周期性边界条件，以及网格间距 $h=1$，从 LES 滤波后的速度计算可解尺度应变率 $S_{ij}$。\n\n将从可解尺度到子格子尺度的无量纲瞬时能量通量在每个网格点上定义为\n$$\\Pi = -\\sum_{i,j=1}^{2} \\tau_{ij} S_{ij}.$$\n在二维且张量对称的情况下，这可以实现为\n$$\\Pi = -\\left(\\tau_{11} S_{11} + \\tau_{22} S_{22} + 2\\,\\tau_{12} S_{12}\\right).$$\n通过对所有网格点上的 $\\Pi$ 进行平均来计算域平均值 $\\langle \\Pi \\rangle$。\n\n您的任务：\n- 对于每个测试案例，计算精确剪切应力分量 $\\tau_{12}^{\\mathrm{exact}}$ 和 SS 模型预测 $\\tau_{12}^{\\mathrm{SS}}$ 的展平数组之间的皮尔逊相关系数 $r$。\n- 计算精确应力、SS 模型应力和包含涡粘性的混合模型应力的域平均能量通量 $\\langle \\Pi \\rangle$。\n\n所有能量通量均以无量纲单位表示，角度以弧度表示。输出必须为浮点数。\n\n测试套件：\n- 案例 1：$N = 64$, $f_x = 2$, $f_y = 3$, $r_f = 1$ (即 $N_f = 3$), $\\alpha = 2$, $C_s = 0.0$。\n- 案例 2：$N = 64$, $f_x = 2$, $f_y = 3$, $r_f = 1$ (即 $N_f = 3$), $\\alpha = 2$, $C_s = 0.18$。\n- 案例 3：$N = 64$, $f_x = 8$, $f_y = 9$, $r_f = 2$ (即 $N_f = 5$), $\\alpha = 2$, $C_s = 0.18$。\n- 案例 4：$N = 64$, $f_x = 4$, $f_y = 5$, $r_f = 4$ (即 $N_f = 9$), $\\alpha = 2$, $C_s = 0.18$。\n\n程序中要使用的定义：\n- LES 滤波宽度为 $\\Delta = N_f \\, h$，其中 $h = 1$。\n- 用于导数的中心差分使用周期性环绕：对于场 $\\phi$，$$\\frac{\\partial \\phi}{\\partial x} \\approx \\frac{\\phi(m,n+1) - \\phi(m,n-1)}{2h},\\quad \\frac{\\partial \\phi}{\\partial y} \\approx \\frac{\\phi(m+1,n) - \\phi(m-1,n)}{2h},$$ 其中索引以 $N$ 为模，且 $h=1$。\n- 相关系数 $r$ 使用两个展平数组之间的标准皮尔逊公式计算。\n\n您的程序应生成单行输出，其中包含所有测试案例的汇总结果，格式为方括号括起来的逗号分隔列表。对于每个测试案例，按顺序将四个浮点数 $[r,\\langle \\Pi \\rangle_{\\mathrm{exact}},\\langle \\Pi \\rangle_{\\mathrm{SS}},\\langle \\Pi \\rangle_{\\mathrm{mix}}]$ 追加到这个单列表中，从而为四个案例生成一个长度为 16 的扁平列表。角度必须以弧度为单位，能量通量必须是无量纲浮点数。", "solution": "用户提供的问题是计算流体力学领域一个定义明确的计算练习，特别关注大涡模拟（LES）的基础。该问题具有科学依据，所有定义均符合标准的LES文献，尽管为教学目的采用了一些非标准的符号选择。提供了所有必需的数据和参数，从而能够得到唯一的、确定性的解。问题有效性得到确认。\n\n解决方案通过逐步实现指定的模型和数值方法来进行。\n\n### 1. 网格和速度场生成\n建立一个大小为 $N \\times N$ 的二维周期性域。网格索引为 $(m,n)$，其中 $m, n \\in \\{0, 1, \\dots, N-1\\}$。问题将合成的直接数值模拟（DNS）场的速度分量 $u_1$ 和 $u_2$（在问题中表示为 $u$ 和 $v$）定义为这些网格索引的确定性函数。\n速度向量为 $\\mathbf{u} = (u_1, u_2)$，其中：\n$$u_1(m,n) = \\sin\\left(\\frac{2\\pi f_x}{N}m\\right)\\cos\\left(\\frac{2\\pi f_y}{N}n\\right) + 0.3\\sin\\left(\\frac{4\\pi f_x}{N}m\\right)\\sin\\left(\\frac{6\\pi f_y}{N}n\\right)$$\n$$u_2(m,n) = -\\cos\\left(\\frac{2\\pi f_x}{N}m\\right)\\sin\\left(\\frac{2\\pi f_y}{N}n\\right) + 0.25\\cos\\left(\\frac{4\\pi f_x}{N}m\\right)\\cos\\left(\\frac{4\\pi f_y}{N}n\\right)$$\n这些场作为 LES 模型分析的高分辨率“真值”数据。\n\n### 2. 算子离散化\n需要两个关键算子：空间滤波器和微分算子。\n\n**空间滤波：** 定义了一个离散、可分离的顶帽（箱式）滤波器。对于给定的场 $\\phi$，在某个网格点上的 LES 滤波场 $\\overline{\\phi}$ 是一个大小为 $N_f \\times N_f$ 的正方形邻域上的平均值，其中 $N_f = 2r_f+1$，$r_f$ 是滤波器半径。同样，用帽子符号（$\\widehat{\\cdot}$）表示的测试滤波器也使用相同的滤波操作，但半径更大，$r_t = \\alpha r_f$。此操作在数值上通过沿每个轴顺序应用一维移动平均并遵守周期性边界条件来实现。\n\n**空间微分：** 问题定义了关于坐标 $x$ 和 $y$ 的偏导数的二阶中心差分格式。这里使用了一个非标准的映射：$\\partial/\\partial x$ 的导数沿网格的第二个索引（$n$）计算，而 $\\partial/\\partial y$ 则沿第一个索引（$m$）计算：\n$$\\frac{\\partial\\phi}{\\partial x}(m,n) \\approx \\frac{\\phi(m,n+1) - \\phi(m,n-1)}{2h}$$\n$$\\frac{\\partial\\phi}{\\partial y}(m,n) \\approx \\frac{\\phi(m+1,n) - \\phi(m-1,n)}{2h}$$\n其中 $h=1$ 是网格间距，索引取模 $N$ 以强制周期性。当关联到张量索引表示法 $\\partial/\\partial x_j$ 时，我们将 $\\partial/\\partial x_1 \\to \\partial/\\partial x$ 和 $\\partial/\\partial x_2 \\to \\partial/\\partial y$ 进行映射。\n\n### 3. 子格子尺度（SGS）应力张量\n定义了算子之后，我们计算各种 SGS 应力张量。\n\n**精确 SGS 应力 ($\\tau_{ij}^{\\mathrm{exact}}$):** 这是根据 DNS 数据计算的。首先，对 DNS 速度场 $\\mathbf{u}$进行滤波以获得可解的 LES 速度场 $\\overline{\\mathbf{u}}$。DNS 速度分量的张量积 ($u_i u_j$) 也被计算出来，然后进行滤波。精确 SGS 应力定义为：\n$$\\tau_{ij}^{\\mathrm{exact}} = \\overline{u_i u_j} - \\overline{u}_i \\overline{u}_j$$\n\n**尺度相似（SS）模型应力 ($\\tau_{ij}^{\\mathrm{SS}}$):** 这个模型，也称为 Bardina 模型，仅使用可解尺度场来近似 SGS 应力。它对 LES 场应用第二个更宽的“测试”滤波器。\n$$\\tau_{ij}^{\\mathrm{SS}} = \\widehat{\\overline{u}_i \\overline{u}_j} - \\widehat{\\overline{u}}_i \\widehat{\\overline{u}}_j$$\n为了计算，这需要对已经经过 LES 滤波的场（$\\overline{u}_i$）及其乘积（$\\overline{u}_i \\overline{u}_j$）应用测试滤波器（半径为 $r_t$）。\n\n### 4. 相关性分析\nLES 建模的一个主要目标是生成与精确应力良好相关的模型应力。皮尔逊相关系数 $r$ 在精确剪切应力分量 $\\tau_{12}^{\\mathrm{exact}}$ 和其 SS 模型对应物 $\\tau_{12}^{\\mathrm{SS}}$ 之间计算。\n$$r(\\tau_{12}^{\\mathrm{exact}}, \\tau_{12}^{\\mathrm{SS}}) = \\frac{\\mathrm{cov}(\\tau_{12}^{\\mathrm{exact}}, \\tau_{12}^{\\mathrm{SS}})}{\\sigma_{\\tau_{12}^{\\mathrm{exact}}} \\sigma_{\\tau_{12}^{\\mathrm{SS}}}}$$\n这是在将应力值数组展平为一维向量后计算的。\n\n### 5. SGS 能量通量 ($\\Pi$)\nLES 模型的另一个关键方面是其正确预测可解尺度和子格子尺度之间能量传递的能力。这通过 SGS 能量通量 $\\Pi = -\\tau_{ij} S_{ij}$ 来量化，其中 $S_{ij}$ 是可解尺度应变率张量。\n\n**可解尺度应变率 ($S_{ij}$):** 该张量由 LES 滤波后的速度场 $\\overline{\\mathbf{u}}$ 计算得出：\n$$S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\overline{u}_i}{\\partial x_j} + \\frac{\\partial \\overline{u}_j}{\\partial x_i}\\right)$$\n使用指定的离散微分规则来计算速度梯度。其分量为：\n$$S_{11} = \\frac{\\partial \\overline{u}_1}{\\partial x_1}, \\quad S_{22} = \\frac{\\partial \\overline{u}_2}{\\partial x_2}, \\quad S_{12} = \\frac{1}{2}\\left(\\frac{\\partial \\overline{u}_1}{\\partial x_2} + \\frac{\\partial \\overline{u}_2}{\\partial x_1}\\right)$$\n\n**混合模型应力 ($\\tau_{ij}^{\\mathrm{mix}}$):** 已知 SS 模型的耗散性很差。为了纠正这一点，添加了一个涡粘性项，形成一个混合模型。\n$$\\tau_{ij}^{\\mathrm{mix}} = \\tau_{ij}^{\\mathrm{SS}} - 2 \\nu_t S_{ij}$$\n涡粘性 $\\nu_t$ 使用 Smagorinsky 公式建模：\n$$\\nu_t = (C_s \\Delta)^2 |\\overline{S}|, \\quad \\text{其中} \\quad |\\overline{S}| = \\sqrt{2 S_{ij} S_{ij}}$$\n这里，$C_s$ 是 Smagorinsky 常数，$\\Delta = N_f h$ 是 LES 滤波宽度。\n\n**能量通量计算：** 为每个模型计算 SGS 能量通量，并在域上取平均。在二维中，通量为：\n$$\\Pi = -(\\tau_{11}S_{11} + \\tau_{22}S_{22} + 2\\tau_{12}S_{12})$$\n我们为每个测试案例计算域平均值 $\\langle \\Pi_{\\mathrm{exact}} \\rangle$、$\\langle \\Pi_{\\mathrm{SS}} \\rangle$ 和 $\\langle \\Pi_{\\mathrm{mix}} \\rangle$。对于混合模型，通量可以方便地计算为：\n$$\\Pi_{\\mathrm{mix}} = \\Pi_{\\mathrm{SS}} + 2 \\nu_t S_{ij}S_{ij} = \\Pi_{\\mathrm{SS}} + \\nu_t |\\overline{S}|^2 = \\Pi_{\\mathrm{SS}} + (C_s \\Delta)^2 |\\overline{S}|^3$$\n\n实现过程首先为滤波和微分操作创建函数，然后处理每个测试案例以计算所需的四个量：相关系数 $r$ 和三个平均能量通量。", "answer": "```python\nimport numpy as np\n\ndef box_filter_2d(phi, r):\n    \"\"\"\n    Applies a 2D separable box filter with periodic boundary conditions.\n    \n    Args:\n        phi (np.ndarray): The 2D input field.\n        r (int): The filter radius (window size will be 2*r+1).\n        \n    Returns:\n        np.ndarray: The filtered field.\n    \"\"\"\n    if r == 0:\n        return phi\n        \n    window_size = 2 * r + 1\n    \n    # Filter along axis 0 (m-index)\n    phi_temp = np.zeros_like(phi, dtype=np.float64)\n    for i in range(-r, r + 1):\n        phi_temp += np.roll(phi, i, axis=0)\n    \n    # Filter along axis 1 (n-index)\n    phi_filtered = np.zeros_like(phi_temp, dtype=np.float64)\n    for i in range(-r, r + 1):\n        phi_filtered += np.roll(phi_temp, i, axis=1)\n    \n    # Normalize by total window area\n    phi_filtered /= (window_size * window_size)\n    \n    return phi_filtered\n\ndef calculate_derivatives(phi):\n    \"\"\"\n    Calculates spatial derivatives using second-order central differences\n    with periodic boundaries, following the problem's unconventional definitions.\n    \n    h=1 is assumed.\n    - d/dx is defined as difference along axis 1 (n-index).\n    - d/dy is defined as difference along axis 0 (m-index).\n    \n    Args:\n        phi (np.ndarray): The 2D input field.\n        \n    Returns:\n        tuple[np.ndarray, np.ndarray]: (d(phi)/dx, d(phi)/dy)\n    \"\"\"\n    h = 1.0\n    # d/dx is defined as difference along axis 1 (n-index)\n    d_dx = (np.roll(phi, -1, axis=1) - np.roll(phi, 1, axis=1)) / (2 * h)\n    \n    # d/dy is defined as difference along axis 0 (m-index)\n    d_dy = (np.roll(phi, -1, axis=0) - np.roll(phi, 1, axis=0)) / (2 * h)\n    \n    return d_dx, d_dy\n    \ndef process_case(N, fx, fy, rf, alpha, Cs):\n    \"\"\"\n    Processes a single test case and returns the required metrics.\n    \n    Returns:\n        tuple[float, float, float, float]: \n            (r,", "id": "3339012"}]}