## 引言
在[大涡模拟](@entry_id:153702)（Large Eddy Simulation, LES）中，对未解析的亚格子尺度（SGS）运动如何影响已解流场进行精确建模，是[湍流模拟](@entry_id:187401)成功的关键。传统的涡粘性模型虽然能保证[数值稳定性](@entry_id:146550)，但往往以牺牲物理保真度为代价，无法捕捉[湍流](@entry_id:151300)中复杂的结构和能量交换过程。[尺度相似性](@entry_id:754548)模型作为一类重要的结构型[SGS模型](@entry_id:754720)，正是为了弥补这一不足而提出的，它试图利用已解尺度中的信息来更真实地重构未解析尺度的影响。本文旨在系统性地剖析[尺度相似性](@entry_id:754548)模型，从其物理基础到前沿应用，为读者提供一个全面而深入的理解。

本文将分为三个核心章节。在“原理与机制”中，我们将通过Leonard分解深入SGS应力的内部结构，阐明[尺度相似性](@entry_id:754548)假设的物理起源，并详细分析以[Bardina模型](@entry_id:746673)为代表的经典模型的构建、性能及其固有的不稳定性问题，最后介绍[混合模型](@entry_id:266571)和动态程序等先进的解决方案。接下来，“应用与跨学科联系”一章将展示该模型如何在可压缩流、壁[湍流](@entry_id:151300)等[复杂流体](@entry_id:198415)问题中进行扩展，并跨越学科边界，在地球物理、天体物理乃至信号处理等领域发挥重要作用。最后，“动手实践”部分将提供一系列精心设计的编程练习，引导读者从零开始实现基础模型、处理[数值守恒](@entry_id:175179)性问题，并最终构建一个完整的动态自适应模型。通过这三个层层递进的章节，读者将不仅掌握[尺度相似性](@entry_id:754548)模型的理论精髓，更能领会其在现代[科学计算](@entry_id:143987)中的实践价值和广阔前景。

## 原理与机制

在[大涡模拟](@entry_id:153702)（Large Eddy Simulation, LES）的理论框架中，通过[空间滤波](@entry_id:202429)将流场变量分解为已解尺度和亚格子尺度（Subgrid-Scale, SGS）两部分。这一过程在控制方程中引入了未封闭的项，即亚格子应力张量，它代表了未解析的[湍流](@entry_id:151300)脉动对已解尺度运动的影响。对该项进行精确建模是LES方法的核心。[尺度相似性](@entry_id:754548)模型（Scale-Similarity Models）是基于[湍流](@entry_id:151300)能级串过程中尺度间相互作用的物理图像而构建的一类重要的结构型[SGS模型](@entry_id:754720)。本章将深入探讨[尺度相似性](@entry_id:754548)模型的核心原理、理论基础、内在挑战以及相应的解决方案。

### 亚格子应力的分解：Leonard、交叉与[Reynolds应力](@entry_id:268635)

为了理解亚格子应力的物理构成，我们首先对其进行精确的分解。根据定义，亚格子应力张量 $\tau_{ij}$ 是通过对速度分量乘积进行滤波，然后减去已滤波速度分量的乘积得到的：
$$
\tau_{ij} = \overline{u_i u_j} - \bar{u}_i \bar{u}_j
$$
其中，上划线 $\overline{(\cdot)}$ 代表特征尺度为 $\Delta$ 的网格滤波操作。

为了揭示 $\tau_{ij}$ 的内在结构，我们将瞬时速度场 $u_i$ 分解为已解部分 $\bar{u}_i$ 和亚格子部分 $u'_i = u_i - \bar{u}_i$。将此分解代入 $\overline{u_i u_j}$ 项中，并利用滤波算子的线性性质，我们得到：
$$
\overline{u_i u_j} = \overline{(\bar{u}_i + u'_i)(\bar{u}_j + u'_j)} = \overline{\bar{u}_i \bar{u}_j} + \overline{\bar{u}_i u'_j} + \overline{u'_i \bar{u}_j} + \overline{u'_i u'_j}
$$
将此表达式代回 $\tau_{ij}$ 的定义，并重新整理，即可得到著名的 **Leonard分解** [@problem_id:3360693]：
$$
\tau_{ij} = (\overline{\bar{u}_i \bar{u}_j} - \bar{u}_i \bar{u}_j) + (\overline{\bar{u}_i u'_j} + \overline{u'_i \bar{u}_j}) + \overline{u'_i u'_j}
$$
这个表达式将亚格子应力精确地分解为三个部分，每一部分都有明确的物理意义：

1.  **Leonard应力 ($L_{ij} = \overline{\bar{u}_i \bar{u}_j} - \bar{u}_i \bar{u}_j$)**：该项代表了已解尺度之间的相互作用。由于滤波操作与[非线性](@entry_id:637147)乘法通常不可交换（即 $\overline{fg} \neq \bar{f}\bar{g}$），这一项通常不为零。它完全由已解[速度场](@entry_id:271461) $\bar{u}_i$ 决定，因此是可计算的。

2.  **[交叉](@entry_id:147634)应力 ($C_{ij} = \overline{\bar{u}_i u'_j} + \overline{u'_i \bar{u}_j}$)**：该项代表了已解尺度与亚格子尺度之间的相互作用。它描述了能量在已解尺度和未解尺度之间的传递。

3.  **亚格子[Reynolds应力](@entry_id:268635) ($R_{ij} = \overline{u'_i u'_j}$)**：该项代表了亚格子尺度内部的相互作用，在结构上类似于传统[Reynolds平均](@entry_id:754341)方法中的[Reynolds应力](@entry_id:268635)，但作用于亚格子尺度。

在这三项中，只有Leonard应力是完全由计算得到的 $\bar{u}_i$ 决定的。[交叉](@entry_id:147634)应力和亚格子[Reynolds应力](@entry_id:268635)都包含未解析的 $u'_i$ 项，因此是未知的，必须被建模。

### [尺度相似性](@entry_id:754548)假设与[Bardina模型](@entry_id:746673)

[尺度相似性](@entry_id:754548)假设的物理基础源于Kolmogorov的[湍流](@entry_id:151300)能级串理论，该理论认为在[惯性子区](@entry_id:273327)内，[湍流](@entry_id:151300)的统计特性在不同尺度上是[自相似](@entry_id:274241)的。据此推断，引起亚格子应力 $\tau_{ij}$ 的、发生在网格尺度 $\Delta$ 附近的尺度间相互作用，在结构上应该与发生在更大尺度上的、完全处于已解范围内的尺度间相互作用相似 [@problem_id:3360687]。

为了将这一思想数学化，我们引入第二个滤波操作，称为 **测试滤波 (test filter)**，记为 $\tilde{(\cdot)}$，其特征宽度为 $\tilde{\Delta}$，且通常取 $\tilde{\Delta} > \Delta$（例如 $\tilde{\Delta} = 2\Delta$）。这个测试滤波器被施加在已经求解的 $\bar{u}_i$ 场上。通过这种方式，我们可以在已解尺度范围内构造一个类似于 $\tau_{ij}$ 的[应力张量](@entry_id:148973)，这个张量只依赖于可计算的量。这个新构造的张量就是我们在前一节中定义的Leonard应力，但现在是在测试滤波尺度上对已解场进行计算 [@problem_id:3360718]：
$$
L_{ij}^{\text{test}} = \widetilde{\bar{u}_i \bar{u}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j
$$
[尺度相似性](@entry_id:754548)假设的核心就是：亚格子应力 $\tau_{ij}$ 在结构上与 $L_{ij}^{\text{test}}$ 相似。最简单的[尺度相似性](@entry_id:754548)模型，即 **[Bardina模型](@entry_id:746673)**，直接用 $L_{ij}^{\text{test}}$ 来模化 $\tau_{ij}$：
$$
\tau_{ij}^{\text{model}} = C_B L_{ij}^{\text{test}} = C_B (\widetilde{\bar{u}_i \bar{u}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j)
$$
其中 $C_B$ 是一个模型系数，通常取为1。

在此需要明确区分 **网格滤波** $\overline{(\cdot)}$ 和 **测试滤波** $\tilde{(\cdot)}$ 的角色 [@problem_id:3360718]：
*   **网格滤波** 是LES的基本定义操作，它将流场划分为已解和未解部分，并直接导致了亚格子应力 $\tau_{ij}$ 的出现，从而产生了封闭问题。其尺度 $\Delta$ 与[计算网格](@entry_id:168560)的尺寸直接相关。
*   **测试滤波** 是一个纯粹用于建模的数学工具。它被施加在已解场上，用以探测比网格尺度稍大的尺度上的[湍流](@entry_id:151300)结构信息。通过比较两个不同已解尺度（$\Delta$ 和 $\tilde{\Delta}$）上的信息，为未解尺度建立模型。

[Bardina模型](@entry_id:746673)具有一些优良的性质。由于它是由速度的二次型之差构建的，因此该模型自然满足 **对称性**（$\tau_{ij}^{\text{model}} = \tau_{ji}^{\text{model}}$）和 **伽利略不变性** [@problem_id:3360718]。后者保证了模型在不同[惯性参考系](@entry_id:276742)下的形式保持不变，这是一个重要的物理约束。

### 模型的理论依据与性能

[尺度相似性](@entry_id:754548)模型之所以有效，并非偶然。其背后有深刻的理论支持，并且其性能与[湍流](@entry_id:151300)的物理特性及滤波器的选择密切相关。

#### 梯度展开与结构相似性

通过对滤波算子进行泰勒级数展开，我们可以揭示为什么[Bardina模型](@entry_id:746673)能够很好地捕捉真实亚格子应力的结构。对于一个光滑的已解[速度场](@entry_id:271461) $\bar{u}_i$ 和一个具有对称[核函数](@entry_id:145324)的线性滤波器，可以证明Leonard应力 $L_{ij}^{\text{test}}$ 的[主导项](@entry_id:167418)与已解[速度梯度](@entry_id:261686)的二次型成正比 [@problem_id:3360685]：
$$
L_{ij}^{\text{test}} \approx C_M \tilde{\Delta}^2 (\partial_k \bar{u}_i \partial_k \bar{u}_j)
$$
其中 $C_M$ 是一个由滤波器二阶矩决定的常数。惊人的是，对真实的亚格子应力 $\tau_{ij}$ 进行类似的分析，会发现其[主导项](@entry_id:167418)也具有完全相同的张量结构，只是尺度变为 $\Delta$：
$$
\tau_{ij} \approx C_M \Delta^2 (\partial_k \bar{u}_i \partial_k \bar{u}_j)
$$
这意味着，[Bardina模型](@entry_id:746673)与真实的亚格子应力在主导阶上具有相同的张量结构和主轴方向。这从根本上解释了为什么*先验*研究（即使用DNS数据直接比较模型和真实SGS应力）发现两者之间具有非常高的相关性。模型准确地再现了由已解[速度梯度](@entry_id:261686)决定的局部应力张量几何形态。

#### 与[Kolmogorov理论](@entry_id:200055)的相容性

[尺度相似性](@entry_id:754548)模型的有效性也植根于其与Kolmogorov[惯性子区](@entry_id:273327)理论的相容性 [@problem_id:3360687]。在充分发展的[湍流](@entry_id:151300)[惯性子区](@entry_id:273327)中，速度的特征尺度与长度尺度 $r$ 的关系为 $\delta u(r) \sim (\varepsilon r)^{1/3}$，其中 $\varepsilon$ 是[能量耗散](@entry_id:147406)率。由于应力的量纲是速度的平方，亚格子应力的量级应为 $\lVert \tau \rVert \sim (\delta u(\Delta))^2 \sim (\varepsilon\Delta)^{2/3}$。通过对[Bardina模型](@entry_id:746673)进行同样的[量纲分析](@entry_id:140259)，可以发现其预测的应力量级也遵循 $(\varepsilon\Delta)^{2/3}$ 标度律。因此，该模型在标度律上与[湍流](@entry_id:151300)的基本物理法则是自洽的。

模型的性能与滤波器的选择息息相关。
*   **[雷诺数](@entry_id:136372)和滤波器位置**：[尺度相似性](@entry_id:754548)假设在[惯性子区](@entry_id:273327)最为有效。因此，当滤波尺度 $\Delta$ 远离[能量尺度](@entry_id:196201) $L$ 和耗散尺度 $\eta$ 时，模型的预测相关性最高。随着雷诺数的增加，[惯性子区](@entry_id:273327)范围扩大，模型的适用性也越好 [@problem_id:3360687]。
*   **滤波器类型和宽度比**：为了在已解场中获得有意义的结构信息，测试滤波宽度 $\tilde{\Delta}$ 必须大于网格滤波宽度 $\Delta$。然而，宽度比 $\alpha = \tilde{\Delta}/\Delta$ 不宜过大。过大的 $\alpha$ 会导致测试滤波后的场与网格滤波后的场失相关，破坏了“相邻尺度”相似的前提。通常，$\alpha$ 取在 $1.5$ 到 $2$ 之间效果较好。此外，相比于具有[频谱](@entry_id:265125)泄露问题的箱式滤波器（box filter），具有光滑衰减特性的高斯滤波器（Gaussian filter）通常能更好地保持不同尺度间的结构相关性，从而提高模型精度 [@problem_id:3360724]。

### 不稳定性来源：能量反传与[可实现性](@entry_id:193701)

尽管[尺度相似性](@entry_id:754548)模型在结构预测上表现出色，但纯粹的结构模型在实际LES应用中却面临着严峻的挑战，主要源于能量反传和模型的[可实现性](@entry_id:193701)问题。

#### 能量反传与[数值稳定性](@entry_id:146550)

为了分析[SGS模型](@entry_id:754720)对已解尺度能量的影响，我们考察已解动能 $k = \frac{1}{2}\bar{u}_i \bar{u}_i$ 的[输运方程](@entry_id:756133)。方程中的SGS项可以写成一个SGS耗散项 $\Pi = -\tau_{ij}\bar{S}_{ij}$，其中 $\bar{S}_{ij}$ 是已解应变率张量 [@problem_id:3360694, 3367184]。$\Pi$ 代表了已解尺度与亚格子尺度之间的能量交换速率。

*   **正向散射 (Forward Scatter, $\Pi > 0$)**: 能量从已解尺度流向亚格子尺度。这是[湍流能量级串](@entry_id:194234)的主导方向，[SGS模型](@entry_id:754720)应主要扮演能量“汇”的角色，以保证数值稳定。
*   **[反向散射](@entry_id:142561) (Backscatter, $\Pi < 0$)**: 能量从亚格子尺度流回已解尺度。这是一种真实的物理现象，通常是局部的、间歇性的，代表小尺度涡结构组织起来为大尺度运动提供能量。

传统的 **功能型模型**（如[Smagorinsky模型](@entry_id:276289)）通过构造 $\tau_{ij} = -2\nu_t \bar{S}_{ij}$ 的形式，强制保证 $\Pi = 2\nu_t \bar{S}_{ij}\bar{S}_{ij} \ge 0$（假设涡粘性系数 $\nu_t \ge 0$）。这类模型是纯耗散的，虽然保证了数值稳定性，但完全无法描述物理上存在的能量反传现象 [@problem_id:3367184]。

与此相反，**结[构型模型](@entry_id:747676)**（如[Bardina模型](@entry_id:746673)）由于其构造方式，$\tau_{ij}^{\text{model}}$ 与 $\bar{S}_{ij}$ 之间没有固定的相位关系，因此 $\Pi$ 的符号不确定。这使得模型能够物理地再现能量反传，这是其一大优点。然而，这也正是其不稳定的根源。如果模型预测了过度的、持续的能量反传（$\Pi < 0$），SGS项就会成为已解动能方程中的一个能量“源”。在分子粘性耗散不足以平衡这种能量注入的情况下，能量会在网格截止尺度附近（即最高波数处）堆积，最终导致计算发散 [@problem_id:3360751]。

#### [可实现性](@entry_id:193701) (Realizability)

另一个关键问题是 **[可实现性](@entry_id:193701)**。由于 $\tau_{ij}$ 本质上是未解析速度脉动的协方差矩阵，它必须是一个半[正定张量](@entry_id:204409)。这意味着它的所有[特征值](@entry_id:154894)都必须非负。特别地，其对角元 $\tau_{ii}$ (no sum) 代表了速度分量 $u'_i$ 的[方差](@entry_id:200758)，物理上必须大于等于零。

然而，由[Bardina模型](@entry_id:746673)计算出的 $\tau_{ij}^{\text{model}}$ 并不能保证满足此条件。在某些流动区域，计算出的对角元可能出现负值，这显然是违背物理的 [@problem_id:3360682]。例如，假设在某点计算得到 $L_{11} = -0.012$，$L_{22} = 0.016$，$L_{33} = 0.004$。若取 $\tau_{ij}^{\text{model}} = L_{ij}$，则 $\tau_{11}^{\text{model}}$ 为负，违反了[可实现性](@entry_id:193701)。一个简单的修复方法是进行 **迹正则化**，即向模型张量添加一个纯各向同性的部分：
$$
\tau_{ij}^{\text{reg}} = \tau_{ij}^{\text{model}} + \lambda \delta_{ij}
$$
通过选择合适的 $\lambda$（例如，使其等于最负[特征值](@entry_id:154894)的[绝对值](@entry_id:147688)，在上述例子中 $\lambda=0.012$），可以保证正则化后的张量 $\tau_{ij}^{\text{reg}}$ 是半正定的，同时保持原模型的[偏应力](@entry_id:163323)部分不变 [@problem_id:3360682]。

### 解决方案：混合模型与动态程序

为了克服纯结构模型的稳定性问题，同时保留其对[湍流](@entry_id:151300)结构的高保真度，研究者们发展了 **[混合模型](@entry_id:266571)** (Mixed Models) [@problem_id:3360751]。[混合模型](@entry_id:266571)将结构模型与功能型（耗散）模型结合起来：
$$
\tau_{ij}^{\text{model}} = \tau_{ij}^{\text{structural}} + \tau_{ij}^{\text{dissipative}}
$$
例如，一个典型的[混合模型](@entry_id:266571)形式为：
$$
\tau_{ij} = C \tau_{ij}^{\text{sim}} - 2 \nu_t \bar{S}_{ij}
$$
这里的 $\tau_{ij}^{\text{sim}}$ 是[尺度相似性](@entry_id:754548)部分，负责准确捕捉应力结构和能量反传；而涡粘性项 $-2 \nu_t \bar{S}_{ij}$ 则提供必要的耗散，以消耗掉多余的能量，保证[数值稳定性](@entry_id:146550) [@problem_id:3360751, 3367184]。

这种方法的关键在于如何确定模型系数 $C$ 和 $\nu_t$。如果将它们设为常数，模型的普适性将很差。**动态程序** (Dynamic Procedure) 提供了一个优雅的解决方案，它利用流场自身的演化来动态地确定这些系数。

动态程序的核心是 **[Germano恒等式](@entry_id:749887)**。该恒等式提供了一个在网格滤波尺度和测试滤波尺度之间精确的代数关系，完全由已解量构成：
$$
L_{ij} \equiv \widetilde{\bar{u}_i \bar{u}_j} - \tilde{\bar{u}}_i \tilde{\bar{u}}_j = T_{ij} - \tilde{\tau}_{ij}
$$
其中 $T_{ij} = \widetilde{u_i u_j} - \tilde{u}_i \tilde{u}_j$ 是在测试滤波尺度上的亚格子应力，而 $\tilde{\tau}_{ij}$ 是对网格尺度亚格子应力 $\tau_{ij}$ 进行测试滤波的结果。

动态程序的步骤如下 [@problem_id:3360744]：
1.  假设混合模型形式在不同尺度下成立。即 $\tau_{ij}$ 和 $T_{ij}$ 均可由[混合模型](@entry_id:266571)表示，只是尺度和系数不同。
2.  将模型表达式代入[Germano恒等式](@entry_id:749887)中的 $\tau_{ij}$ 和 $T_{ij}$。这会得到一个包含模型系数（例如 $C$ 和 $\nu_t$ 中的 $c_\nu$）和完全由已解速度场 $\bar{u}_i$ 计算的张量项的方程。
3.  这个方程通常是一个过[约束系统](@entry_id:164587)，因为一个张量方程包含多个分量，而我们只有少数几个待定系数。因此，通过最小二乘法求解这个方程，得到在局部流场中最优的系数。

例如，对于[混合模型](@entry_id:266571) $\tau_{ij} = C \tau_{ij}^{\text{sim}} - 2 c_\nu \Delta^2 |\bar{S}| \bar{S}_{ij}$，代入[Germano恒等式](@entry_id:749887)后会得到一个形如 $L_{ij} \approx C A_{ij} + c_\nu B_{ij}$ 的[线性方程](@entry_id:151487)，其中 $A_{ij}$ 和 $B_{ij}$ 是由 $\bar{u}_i$ 计算得到的复杂张量。[最小二乘解](@entry_id:152054)给出了 $C$ 和 $c_\nu$ 的表达式，这些表达式是耦合的，包含了 $A_{ij}$ 和 $B_{ij}$ 之间的[交叉](@entry_id:147634)相关项 [@problem_id:3360744]。这种方法使得模型能够自动适应当地流动条件，例如在层流区域自动关闭[SGS模型](@entry_id:754720)（系数趋于零），在壁面附近调整系数，并能够计算出局部为负的涡粘性以模拟能量反传，同时通过平均化等手段控制其幅度以维持整体稳定。

### 实现注记：交换误差

在上述所有理论推导中，我们通常假设滤波和求导操作可以交换顺序，即 $\overline{\partial_j u_i} = \partial_j \bar{u}_i$。这个假设的成立是有条件的 [@problem_id:3360686]。

对于在无限或周期性域上、具有平移不变核函数和恒定滤波宽度的显式滤波，这个[交换性](@entry_id:140240)是精确成立的。然而，在以下常见情况中，**交换误差** 会出现：
1.  **[非均匀网格](@entry_id:752607)**：当滤波宽度 $\Delta$ 随空间位置变化时（$\Delta = \Delta(x)$），[交换性](@entry_id:140240)不再成立，交换误差与 $\partial_j \Delta$ 成正比。
2.  **壁面附近**：在有界域中，即使滤波宽度恒定，滤波核在靠近壁面处也会被截断，导致积分换序时产生非零的边界项，从而破坏交换性。
3.  **隐式滤波**：在许多实际计算中，并没有进行显式的卷积滤波，而是由[离散化格式](@entry_id:153074)和网格本身充当一个“隐式”滤波器。在[非均匀网格](@entry_id:752607)上，这种隐式滤波操作与离散[微分](@entry_id:158718)操作通常是不可交换的。

虽然在许多情况下交换误差被认为是高阶小量而被忽略，但在需要高精度或[网格质量](@entry_id:151343)较差的模拟中，它可能成为一个不可忽视的误差来源。在发展和应用[尺度相似性](@entry_id:754548)模型，特别是依赖于多层滤波的动态模型时，对这一假设的有效性应保持审慎。