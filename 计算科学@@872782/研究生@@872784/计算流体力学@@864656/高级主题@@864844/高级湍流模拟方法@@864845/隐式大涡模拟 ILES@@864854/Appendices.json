{"hands_on_practices": [{"introduction": "隐式大涡模拟（ILES）的核心思想是利用数值格式的内蕴耗散来模化亚格子应力。要深刻理解这一点，我们必须首先分析动能在离散控制方程中的输运和转化。本练习将指导您推导一个有限体积格式的半离散动能平衡方程，并找出一个关键参数，使对流项在动能上是守恒的，从而为理解和设计ILES格式奠定理论基础。", "problem": "考虑一个不可压缩、常密度流的隐式大涡模拟 (ILES)，该模拟在具有三重周期性边界条件的均匀笛卡尔网格上，使用同位网格有限体积法 (FVM) 进行离散。未知速度场存储在单元中心。设每个控制体由索引 $P$ 表示，其体积为 $\\Delta \\Omega_{P}$，单元中心速度为 $\\boldsymbol{u}_{P}(t)$。每个内部面 $f$ 连接一对相邻单元 $(P,N)$，其相对于单元 $P$ 的外法向面积向量为 $\\boldsymbol{S}_{f}$，因此同一面相对于单元 $N$ 的面积向量为 $-\\boldsymbol{S}_{f}$。常数密度为 $\\rho$，动力粘度为 $\\mu$。\n\n每个单元 $P$ 中的半离散动量平衡是通过在控制体上积分不可压缩Navier–Stokes方程，并对每个通量项应用散度定理得到的。通过面 $f$ 的动量对流通量由质量通量 $m_{f}$ 乘以插值得到的面速度 $\\boldsymbol{u}_{f}$ 表示。从单元 $P$ 角度看，通过面 $f$ 的质量通量为 $m_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot\\boldsymbol{S}_{f}$，而从单元 $N$ 角度看，同一面的质量通量为 $-m_{f}$。面速度插值由单个参数 $\\alpha \\in [0,1]$ 通过以下方式定义\n$$\n\\boldsymbol{u}_{f}(\\alpha) = \\alpha\\,\\boldsymbol{u}_{P} + (1-\\alpha)\\,\\boldsymbol{u}_{N}.\n$$\n假设离散连续性方程以通常的面通量形式强制执行，\n$$\n\\sum_{f\\in \\partial \\Omega_{P}} m_{f} = 0 \\quad \\text{对于每个单元 } P,\n$$\n并且压力使用中心、基于面的梯度进行离散，使得离散梯度和散度算子在标准FVM内积下构成一个分部求和对。粘性通量使用对称的中心差分进行离散，这为粘性耗散产生一个非负的二次型。\n\n从上述基本定律和定义出发，推导全局动能的半离散动能平衡\n$$\nK(t) = \\sum_{P} \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}.\n$$\n明确指出对流项、压力项和粘性项对 $\\mathrm{d}K/\\mathrm{d}t$ 的贡献，并用面-对 $(P,N)$、质量通量 $m_{f}$ 和插值参数 $\\alpha$ 来表示对流项的贡献。然后，确定 $\\alpha$ 的值，使得对流项的贡献精确地简化为一个动能的伸缩边界输运项，没有内部的产生或耗散，从而在三重周期性边界条件下，对流不会产生虚假的动能。提供 $\\alpha$ 的最终值作为您的答案。无需四舍五入。您的答案必须是一个不带单位的实数。", "solution": "分析始于对问题陈述的审查，以确保其有效性。\n\n### 步骤 1：提取已知条件\n- **流场：** 不可压缩、常密度、隐式大涡模拟 (ILES)。\n- **离散化：** 均匀笛卡尔网格上的同位网格有限体积法 (FVM)。\n- **边界条件：** 三重周期性。\n- **变量：** 控制体 $\\Delta \\Omega_{P}$ 内的单元中心速度 $\\boldsymbol{u}_{P}(t)$。\n- **常数：** 密度 $\\rho$，动力粘度 $\\mu$。\n- **面几何：** 一个面 $f$ 连接单元 $P$ 和 $N$。其面积向量为 $\\boldsymbol{S}_{f}$，从 $P$ 指出。\n- **半离散动量方程：** 通过在 $\\Delta \\Omega_{P}$ 上积分Navier-Stokes方程推导得出。\n- **质量通量：** 通过面 $f$ 的质量通量为 $m_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot\\boldsymbol{S}_{f}$。\n- **面速度插值：** $\\boldsymbol{u}_{f}(\\alpha) = \\alpha\\,\\boldsymbol{u}_{P} + (1-\\alpha)\\,\\boldsymbol{u}_{N}$，其中 $\\alpha \\in [0,1]$。\n- **离散连续性：** 对于每个单元 $P$，$\\sum_{f\\in \\partial \\Omega_{P}} m_{f} = 0$。\n- **压力梯度与散度：** 离散算子构成一个分部求和对。\n- **粘性项：** 使用对称的中心差分进行离散，为粘性耗散产生一个非负的二次型。\n- **全局动能：** $K(t) = \\sum_{P} \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，属于计算流体力学这一成熟领域。问题提法恰当、客观且自洽，提供了推导参数 $\\alpha$ 唯一解所需的所有必要定义和约束。问题的前提，如FVM方程的形式和算子属性，在文献中是标准的。该问题可形式化，并要求进行严格的数学推导。它并非无足轻重，因为它需要仔细的代数运算和对数值格式守恒特性的理解。问题没有矛盾、歧义或事实上的不健全之处。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将提供一个完整的、有理有据的解答。\n\n### 半离散动能平衡的推导\n\n单元 $P$ 的半离散动量方程是通过在控制体 $\\Delta\\Omega_P$ 上积分Navier-Stokes方程得到的。对于常数密度 $\\rho$，方程为：\n$$\n\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = -\\sum_{f \\in \\partial\\Omega_P} (\\rho \\boldsymbol{u}_f \\otimes \\boldsymbol{u}_f) \\cdot \\boldsymbol{S}_f - \\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f + \\sum_{f \\in \\partial\\Omega_P} \\boldsymbol{\\tau}_f \\cdot \\boldsymbol{S}_f\n$$\n使用质量通量的定义 $m_f = \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f$，对流项可以写成 $\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f$。因此，单元 $P$ 的动量方程为：\n$$\n\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = -\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f - \\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f + \\boldsymbol{V}_P\n$$\n其中 $\\boldsymbol{V}_P$ 表示作用在单元上的净粘性力。\n\n单元 $P$ 中的动能为 $K_P(t) = \\Delta \\Omega_{P}\\,\\frac{\\rho}{2}\\,|\\boldsymbol{u}_{P}(t)|^{2}$。其时间导数为：\n$$\n\\frac{\\mathrm{d}K_P}{\\mathrm{d}t} = \\Delta \\Omega_{P}\\,\\rho\\,\\boldsymbol{u}_P \\cdot \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t} = \\boldsymbol{u}_P \\cdot \\left(\\Delta\\Omega_P \\rho \\frac{\\mathrm{d}\\boldsymbol{u}_P}{\\mathrm{d}t}\\right)\n$$\n代入动量方程：\n$$\n\\frac{\\mathrm{d}K_P}{\\mathrm{d}t} = \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f \\right) + \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f \\right) + \\boldsymbol{u}_P \\cdot \\boldsymbol{V}_P\n$$\n全局动能 $K(t) = \\sum_P K_P(t)$ 的变化率通过对所有单元 $P$ 求和得到：\n$$\n\\frac{\\mathrm{d}K}{\\mathrm{d}t} = \\sum_P \\frac{\\mathrm{d}K_P}{\\mathrmd t} = T_C + T_P + T_V\n$$\n其中 $T_C$、$T_P$ 和 $T_V$ 分别是对流项、压力项和粘性项的总贡献。\n\n**压力项的贡献 ($T_P$)**\n压力项为 $T_P = \\sum_P \\boldsymbol{u}_P \\cdot \\left( -\\sum_{f \\in \\partial\\Omega_P} p_f \\boldsymbol{S}_f \\right)$。问题陈述中提到，离散散度 ($D$) 和梯度 ($G$) 算子构成一个分部求和对。设 FVM 内积为 $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\sum_P \\Delta\\Omega_P \\boldsymbol{a}_P \\cdot \\boldsymbol{b}_P$。对于周期性边界条件，分部求和性质为 $\\langle \\boldsymbol{v}, G\\phi \\rangle = - \\langle D\\boldsymbol{v}, \\phi \\rangle$。\n压力项可以写成 $T_P = -\\langle \\boldsymbol{u}, Gp \\rangle$。利用该性质，这变成 $T_P = \\langle Du, p \\rangle$。\n与连续性方程一致的速度场离散散度为 $(D\\boldsymbol{u})_P = \\frac{1}{\\Delta\\Omega_P \\rho} \\sum_{f \\in \\partial\\Omega_P} \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f = \\frac{1}{\\Delta\\Omega_P \\rho} \\sum_{f \\in \\partial\\Omega_P} m_f$。\n给定的离散连续性方程为对于所有 $P$，$\\sum_{f \\in \\partial\\Omega_P} m_f = 0$。因此，对于所有 $P$，$(D\\boldsymbol{u})_P = 0$。\n这意味着 $T_P = \\sum_P \\Delta\\Omega_P (Du)_P p_P = 0$。压力项对系统不做净功。\n\n**粘性项的贡献 ($T_V$)**\n粘性项是 $T_V = \\sum_P \\boldsymbol{u}_P \\cdot \\boldsymbol{V}_P$。问题陈述中提到，粘性离散化为粘性耗散产生一个非负的二次型。粘性耗散定义为 $\\epsilon = -T_V$。因此条件是 $\\epsilon \\ge 0$，这意味着 $T_V \\le 0$。该项表示动能到内能的不可逆转换。\n\n**对流项的贡献 ($T_C$)**\n总对流贡献为 $T_C = \\sum_P \\left( -\\boldsymbol{u}_P \\cdot \\sum_{f \\in \\partial\\Omega_P} m_f \\boldsymbol{u}_f \\right)$。我们可以将求和顺序从对单元求和再对面求和，改为对所有独立的面求和。每个内部面 $f$ 由两个单元 $P$ 和 $N$ 共享。从 $P$ 的角度看，质量通量为 $m_f$，从 $N$ 的角度看，为 $m_{f,N} = \\rho \\boldsymbol{u}_f \\cdot (-\\boldsymbol{S}_f) = -m_f$。\n$$\nT_C = -\\sum_{f(P,N)} \\left( \\boldsymbol{u}_P \\cdot (m_f \\boldsymbol{u}_f) + \\boldsymbol{u}_N \\cdot (m_{f,N} \\boldsymbol{u}_f) \\right) = -\\sum_{f(P,N)} (\\boldsymbol{u}_P \\cdot m_f \\boldsymbol{u}_f - \\boldsymbol{u}_N \\cdot m_f \\boldsymbol{u}_f)\n$$\n$$\nT_C = \\sum_{f(P,N)} m_f (\\boldsymbol{u}_N - \\boldsymbol{u}_P) \\cdot \\boldsymbol{u}_f\n$$\n现在，代入插值公式 $\\boldsymbol{u}_f = \\alpha \\boldsymbol{u}_P + (1-\\alpha)\\boldsymbol{u}_N$。一个有用的恒等式是 $(b-a) \\cdot (\\alpha a + (1-\\alpha)b) = \\frac{1}{2}(|b|^2-|a|^2) - (\\alpha-\\frac{1}{2})|b-a|^2$。\n令 $\\boldsymbol{a} = \\boldsymbol{u}_P$ 和 $\\boldsymbol{b} = \\boldsymbol{u}_N$，我们有：\n$$\n(\\boldsymbol{u}_N - \\boldsymbol{u}_P) \\cdot \\boldsymbol{u}_f = \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) - \\left(\\alpha - \\frac{1}{2}\\right)|\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\n将此代入 $T_C$ 的表达式中：\n$$\nT_C = \\sum_{f} m_f \\left[ \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) \\right] - \\sum_{f} m_f \\left(\\alpha - \\frac{1}{2}\\right)|\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\n我们来分析第一项，$T_{C,1} = \\sum_{f} m_f \\frac{1}{2}(|\\boldsymbol{u}_N|^2 - |\\boldsymbol{u}_P|^2) = \\sum_f m_f (E_N - E_P)$，其中 $E_P = \\frac{1}{2}|\\boldsymbol{u}_P|^2$。\n我们可以证明这一项恒为零。考虑和式 $\\sum_P E_P \\left( \\sum_{f \\in \\partial\\Omega_P} m_f \\right)$。根据离散连续性方程，这个和为零。\n$$\n0 = \\sum_P E_P \\left( \\sum_{f \\in \\partial\\Omega_P} m_f \\right) = \\sum_P \\sum_{f \\in \\partial\\Omega_P} E_P m_f\n$$\n将求和顺序改为对独立的面求和：\n$$\n0 = \\sum_{f(P,N)} (E_P m_f + E_N m_{f,N}) = \\sum_{f(P,N)} (E_P m_f - E_N m_f) = \\sum_f m_f (E_P - E_N)\n$$\n这表明 $\\sum_f m_f (E_P - E_N) = 0$。因此，$T_{C,1} = \\sum_f m_f (E_N - E_P) = - \\sum_f m_f(E_P - E_N) = 0$。\n\n对动能收支的对流贡献简化为：\n$$\nT_C = - \\left(\\alpha - \\frac{1}{2}\\right) \\sum_{f} m_f |\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2\n$$\n问题陈述指出，对于一个特定的 $\\alpha$ 值，对流贡献应简化为一个伸缩边界输运项。对于具有周期性边界条件的区域，这样的输运项计算结果为零。这意味着在区域内部，对流项不会产生或耗散虚假的动能。要使其成立，我们必须有 $T_C = 0$。\n对于一般流场，和式 $\\sum_{f} m_f |\\boldsymbol{u}_N - \\boldsymbol{u}_P|^2$ 不为零。因此，要使 $T_C$ 对任何任意流场都为零，其系数必须为零：\n$$\n\\alpha - \\frac{1}{2} = 0 \\implies \\alpha = \\frac{1}{2}\n$$\n这个 $\\alpha$ 值对应于面速度的中心插值，$\\boldsymbol{u}_f = \\frac{1}{2}(\\boldsymbol{u}_P + \\boldsymbol{u}_N)$，这使得半离散对流算子是反对称的，因此相对于动能是无耗散的。\n\n最终的动能平衡为：\n$$\n\\frac{\\mathrm{d}K}{\\mathrm{d}t} = T_C + T_V\n$$\n当 $\\alpha = 1/2$ 时，$T_C=0$，能量平衡变为 $\\frac{\\mathrm{d}K}{\\mathrm{d}t} = T_V \\le 0$。总动能只能因粘性耗散而减少，这在物理上是正确的。\n\n确保对流项无耗散的 $\\alpha$ 值为 $1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3333512"}, {"introduction": "在开发和应用ILES求解器之后，最后也是最关键的一步是验证与确认（V&V），以确保其结果的物理可信度。本练习提供了一个完整的端到端验证方案，使用泰勒-格林涡（Taylor-Green vortex）这一标准算例来评估一个假设的ILES求解器。通过对动能衰减、涡量演化和能谱等关键诊断量的量化比较，您将学会如何系统地评估一个ILES模拟的准确性和可靠性。", "problem": "你需要编写一个完整、可运行的程序，该程序旨在使用雷诺数 $Re=1600$ 的三维 Taylor–Green 涡，形式化一个用于比较两个或多个隐式大涡模拟 (ILES) 求解器的端到端方案。该方案必须从一个有效且明确的数学基础出发，并根据指定的诊断标准和容差来验证求解器的输出。你的程序必须将数学基础、设置、诊断标准和接受准则编码实现，并用其评估下面提供的一小组假设的求解器输出。所有量均为无量纲量（没有物理单位）。最终答案必须按规定格式以单行形式输出。\n\n从周期性立方体中的不可压缩 Navier–Stokes 方程出发，密度 $ \\rho = 1 $，域 $ \\Omega = [0,2\\pi]^3 $，特征速度 $ U_0 = 1 $，特征长度 $ L_c = 1 $，运动粘度 $ \\nu = U_0 L_c / Re = 1/1600 $。Taylor–Green 涡的初始条件为\n$\nu(x,y,z,0) = \\sin x \\cos y \\cos z,\\quad\nv(x,y,z,0) = -\\cos x \\sin y \\cos z,\\quad\nw(x,y,z,0) = 0,\n$\n初始压力为\n$\np(x,y,z,0) = \\frac{1}{16}\\big(\\cos(2x)+\\cos(2y)\\big)\\big(\\cos(2z)+2\\big).\n$\n设量 $ q $ 在 $ \\Omega $ 上的体积平均表示为 $ \\langle q \\rangle = \\frac{1}{|\\Omega|}\\int_{\\Omega} q \\, d\\Omega $。域平均动能和涡量拟能为\n$\nE(t) = \\frac{1}{2}\\langle u^2 + v^2 + w^2 \\rangle,\\quad\nZ(t) = \\frac{1}{2}\\langle \\|\\boldsymbol{\\omega}\\|^2 \\rangle,\\quad\n\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}.\n$\n对于上述初始条件，其精确值为\n$\nE(0) = \\frac{1}{8} = 0.125,\\quad Z(0) = \\frac{3}{8} = 0.375.\n$\n\n在 ILES 中，域平均动能平衡可以写成\n$\n\\frac{dE}{dt} = - \\nu \\langle \\|\\boldsymbol{\\omega}\\|^2 \\rangle - \\varepsilon_{\\text{num}}(t) = -2\\nu Z(t) - \\varepsilon_{\\text{num}}(t),\n$\n其中 $ \\varepsilon_{\\text{num}}(t) \\ge 0 $ 代表隐式数值耗散。在步长为 $ \\Delta t $ 的均匀时间网格 $ t_j $ 上，使用时间上的二阶中心差分，我们近似\n$\n\\left.\\frac{dE}{dt}\\right|_{t_j} \\approx \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t},\n$\n并将隐式数值耗散的估计值定义为\n$\n\\hat{\\varepsilon}_{\\text{num}}(t_j) = -\\left( \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t} + 2\\nu Z(t_j) \\right).\n$\n\n你的程序必须实现以下接受性诊断标准：\n- 初始条件一致性：检查求解器报告的 $ E(0) $ 和 $ Z(0) $ 是否与解析值 $ E(0)=0.125 $ 和 $ Z(0)=0.375 $ 匹配，绝对容差为 $ \\tau_{\\text{IC}} = 10^{-6} $。\n- 能量衰减一致性：给定时间点 $ t\\in\\{2,4,6,8,10\\} $ 的参考能量，\n$\nE_{\\text{ref}}(2)=0.087209540758879,\\quad\nE_{\\text{ref}}(4)=0.0608440319949965,\\quad\nE_{\\text{ref}}(6)=0.0424494407056167,\\quad\nE_{\\text{ref}}(8)=0.0296159698352653,\\quad\nE_{\\text{ref}}(10)=0.0206623610276983,\n$\n要求求解器在相同时间点的能量 $ E(t) $ 满足\n$\n\\max_{t\\in\\{2,4,6,8,10\\}} \\frac{|E(t) - E_{\\text{ref}}(t)|}{E_{\\text{ref}}(t)} \\le \\tau_E,\n$\n其中 $ \\tau_E = 0.08 $。\n- 涡量拟能峰值时间：设 $ t^* $ 为 $ \\{2,4,6,8,10\\} $ 中 $ Z(t) $ 在这些样本上达到其最大值的时间。要求 $ |t^* - 8| \\le \\tau_{tZ} $，其中 $ \\tau_{tZ} = 2.0 $。\n- 惯性区谱斜率：在时间 $ t=8 $，波数 $ k \\in \\{3,4,5,6,7,8\\} $ 范围内的各向同性能谱 $ E(k,8) $，其在对数-对数关系 $ \\log E = a + s \\log k $ 中的最小二乘斜率 $ s $ 必须满足\n$\n|s - (-5/3)| \\le \\tau_s,\n$\n其中 $ \\tau_s = 0.2 $ 且 $ -5/3 = -1.6666666666666667 $。\n- 隐式耗散的非负性：在 $ t_j \\in \\{2,4,6,8\\} $ 处，使用均匀步长 $ \\Delta t = 2 $ 的中心差分计算 $ \\hat{\\varepsilon}_{\\text{num}}(t_j) $。要求在所有这些时间点上，$ \\hat{\\varepsilon}_{\\text{num}}(t_j) \\ge -\\tau_{\\varepsilon} $，其中 $ \\tau_{\\varepsilon} = 10^{-6} $。\n\n你的程序必须对以下三个假设的求解器输出评估上述诊断标准。所有时间点均为 $ t \\in \\{0,2,4,6,8,10\\} $，所有谱均在时间 $ t=8 $ 时给出，波数范围为 $ k \\in \\{1,2,3,4,5,6,7,8,9,10\\} $。\n\n求解器 A：\n- 能量 $ E_A(t) = [\\,0.125,\\ 0.0870,\\ 0.0609,\\ 0.0426,\\ 0.0292,\\ 0.0207\\,] $。\n- 涡量拟能 $ Z_A(t) = [\\,0.375,\\ 0.8,\\ 1.5,\\ 2.1,\\ 2.4,\\ 2.2\\,] $。\n- $ t=8 $ 时的谱： $ E_{A}(k,8) = [\\,0.51,\\ 0.15435,\\ 0.0824,\\ 0.044135,\\ 0.03434,\\ 0.02704,\\ 0.021285,\\ 0.0185,\\ 0.0168,\\ 0.01344\\,] $。\n\n求解器 B：\n- 能量 $ E_B(t) = [\\,0.125,\\ 0.082,\\ 0.054,\\ 0.039,\\ 0.022,\\ 0.014\\,] $。\n- 涡量拟能 $ Z_B(t) = [\\,0.375,\\ 1.2,\\ 2.3,\\ 2.6,\\ 2.5,\\ 2.0\\,] $。\n- $ t=8 $ 时的谱： $ E_{B}(k,8) = [\\,0.5,\\ 0.2175,\\ 0.1335,\\ 0.0945,\\ 0.0725,\\ 0.058,\\ 0.048,\\ 0.041,\\ 0.0355,\\ 0.0315\\,] $。\n\n求解器 C：\n- 能量 $ E_C(t) = [\\,0.125,\\ 0.090,\\ 0.062,\\ 0.0415,\\ 0.0280,\\ 0.0198\\,] $。\n- 涡量拟能 $ Z_C(t) = [\\,0.375,\\ 0.9,\\ 1.6,\\ 2.0,\\ 2.3,\\ 2.5\\,] $。\n- $ t=8 $ 时的谱： $ E_{C}(k,8) = [\\,0.5,\\ 0.1435,\\ 0.069,\\ 0.041,\\ 0.0275,\\ 0.0195,\\ 0.015,\\ 0.012,\\ 0.0095,\\ 0.008\\,] $。\n\n你的程序必须：\n1) 按照所述实现上述诊断标准和容差。\n2) 独立评估每个求解器，当且仅当所有诊断标准都通过时判定为通过（$\\text{True}$），或任一诊断标准未通过时判定为不通过（$\\text{False}$）。\n3) 对于能量衰减一致性测试，完全按照给定的参考能量值进行。\n4) 对于谱斜率测试，使用波数子集 $ k \\in \\{3,4,5,6,7,8\\} $。\n\n最终输出格式：你的程序应生成单行输出，其中包含每个求解器的通过/不通过结果，格式为按 $[A,B,C]$ 顺序排列、由逗号分隔并用方括号括起来的布尔值列表（例如：$[\\,\\text{True},\\text{False},\\text{True}\\,]$）。", "solution": "该问题是有效的。这是一个适定、有科学依据且客观的任务，其根植于计算流体动力学 (CFD) 和湍流建模的既定原则。问题陈述提供了一套完整、自洽的规范，用于参照标准基准测试——三维 Taylor-Green 涡 (TGV)，来验证隐式大涡模拟 (ILES) 求解器的输出。所有数据、常数和准则都已明确定义，从而可以得出一个唯一且可验证的解。\n\n这个问题的理论基础是不可压缩的 Navier-Stokes 方程，该方程控制着粘性流体的运动。对于密度恒为 $\\rho=1$ 的流体，这些方程为：\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\nu \\nabla^2 \\mathbf{u}\n$$\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\n其中 $\\mathbf{u}=(u,v,w)$ 是速度矢量，$p$ 是压力，$\\nu$ 是运动粘度。该问题设置在周期性立方域 $\\Omega = [0, 2\\pi]^3$ 中，雷诺数 $Re=1600$，这意味着粘度为 $\\nu = U_0 L_c / Re = 1 \\cdot 1 / 1600 = 1/1600$。\n\n流动的演化通常通过全局的、体积平均的量来监测。总动能 $E(t)$ 和涡量拟能 $Z(t)$ 定义为：\n$$\nE(t) = \\frac{1}{2}\\langle |\\mathbf{u}|^2 \\rangle = \\frac{1}{2}\\langle u^2 + v^2 + w^2 \\rangle\n$$\n$$\nZ(t) = \\frac{1}{2}\\langle |\\boldsymbol{\\omega}|^2 \\rangle \\quad \\text{其中} \\quad \\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}\n$$\n在直接数值模拟 (DNS) 中，动能的变化率由精确关系 $\\frac{dE}{dt} = -\\nu \\langle |\\boldsymbol{\\omega}|^2 \\rangle = -2\\nu Z(t)$ 给出，该关系描述了粘性力引起的能量耗散。在 ILES 中，数值离散格式会引入其自身的耗散，这种耗散充当了隐式的亚格子尺度模型。因此，ILES 的能量平衡方程被修改为：\n$$\n\\frac{dE}{dt} = -2\\nu Z(t) - \\varepsilon_{\\text{num}}(t)\n$$\n其中 $\\varepsilon_{\\text{num}}(t) \\ge 0$ 代表由数值格式引起的能量耗散率。这个量对于 ILES 的行为至关重要，其属性是求解器验证的一个关键方面。\n\n该程序将实现五个诊断测试，以评估假设的求解器输出的有效性。\n\n1.  **初始条件一致性**：此测试验证求解器是否正确初始化了流场。TGV 初始条件的解析值为 $E(0) = 1/8 = 0.125$ 和 $Z(0) = 3/8 = 0.375$。将求解器在 $t=0$ 时报告的值与这些精确值进行比较，要求它们在绝对容差 $\\tau_{\\text{IC}} = 10^{-6}$ 内匹配。这确保了模拟有一个正确的起点。\n\n2.  **能量衰减一致性**：此诊断将求解器的动能演化 $E(t)$ 与高保真度参考解 $E_{\\text{ref}}(t)$ 进行比较。这是对求解器整体耗散特性（物理耗散和数值耗散的组合）的一项关键测试。测试指标是在指定时间点 $t \\in \\{2, 4, 6, 8, 10\\}$ 上的最大相对误差：\n    $$\n    \\max_{t\\in\\{2,4,6,8,10\\}} \\frac{|E(t) - E_{\\text{ref}}(t)|}{E_{\\text{ref}}(t)} \\le \\tau_E\n    $$\n    一个在容差 $\\tau_E = 0.08$ 内通过此测试的求解器被认为以可接受的精度再现了全局能量衰减。\n\n3.  **涡量拟能峰值时间**：涡量拟能 $Z(t)$ 的演化是 TGV 流的特征。它最初随着涡拉伸的加剧而增长，产生更小的尺度，然后在达到峰值后衰减，该峰值标志着最大耗散的开始。对于 $Re=1600$，该峰值预计在 $t=8$ 左右。此测试检查所报告的最大涡量拟能的时间 $t^*$（在采样的时间点中）是否接近此参考时间，即 $|t^* - 8| \\le \\tau_{tZ}$，其中 $\\tau_{tZ} = 2.0$。这验证了求解器是否正确捕捉到了这一关键过渡事件的时间点。\n\n4.  **惯性区谱斜率**：在湍流中，惯性子区的能谱 $E(k)$ 预计遵循 Kolmogorov 的 $k^{-5/3}$ 幂律，即 $E(k) \\propto k^{-5/3}$。此测试在 $t=8$（此时流动预计已充分发展）时验证求解器输出中的这一物理属性。它在指定的波数范围 $k \\in \\{3, 4, 5, 6, 7, 8\\}$ 内对关系式 $\\log E(k, 8) = a + s \\log k$ 进行线性最小二乘拟合。然后将得到的斜率 $s$ 与理论值 $-5/3$ 进行比较，要求 $|s - (-5/3)| \\le \\tau_s$，其中 $\\tau_s = 0.2$。\n\n5.  **隐式耗散的非负性**：一个物理上一致的 ILES 必须从解析尺度中移除能量，这意味着 $\\varepsilon_{\\text{num}}(t)$ 必须为非负。我们可以使用能量平衡方程的有限差分近似，从求解器的输出中估计这个量。使用时间步长为 $\\Delta t$ 的时间导数的二阶中心差分，我们将估计的数值耗散定义为：\n    $$\n    \\hat{\\varepsilon}_{\\text{num}}(t_j) = -\\left( \\frac{E(t_{j+1}) - E(t_{j-1})}{2\\Delta t} + 2\\nu Z(t_j) \\right)\n    $$\n    此测试计算 $t_j \\in \\{2, 4, 6, 8\\}$（$\\Delta t = 2$）时的 $\\hat{\\varepsilon}_{\\text{num}}(t_j)$，并确保其为非负，允许一个小的数值容差：$\\hat{\\varepsilon}_{\\text{num}}(t_j) \\ge -\\tau_{\\varepsilon}$，其中 $\\tau_{\\varepsilon} = 10^{-6}$。\n\n当且仅当一个求解器的输出满足所有这五个诊断准则时，才被视为`通过` (pass)。该程序将系统地将这些检查应用于求解器 A、B 和 C 的数据，并报告每个求解器的最终布尔判定结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates hypothetical ILES solver outputs against a set of diagnostics\n    for the 3D Taylor-Green vortex problem.\n    \"\"\"\n\n    # --- Problem Constants and Reference Data ---\n    RE = 1600.0\n    NU = 1.0 / RE\n    E0_ANALYTIC = 0.125\n    Z0_ANALYTIC = 0.375\n    DT = 2.0\n    \n    # Tolerances\n    TOL_IC = 1e-6\n    TOL_E = 0.08\n    TOL_TZ = 2.0\n    TOL_S = 0.2\n    TOL_EPS = 1e-6\n\n    # Reference data\n    TIMES = np.array([0., 2., 4., 6., 8., 10.])\n    E_REF = {\n        2: 0.087209540758879,\n        4: 0.0608440319949965,\n        6: 0.0424494407056167,\n        8: 0.0296159698352653,\n        10: 0.0206623610276983,\n    }\n\n    # Hypothetical solver data\n    test_cases = [\n        {\n            \"name\": \"Solver A\",\n            \"E\": np.array([0.125, 0.0870, 0.0609, 0.0426, 0.0292, 0.0207]),\n            \"Z\": np.array([0.375, 0.8, 1.5, 2.1, 2.4, 2.2]),\n            \"E_k8\": np.array([0.51, 0.15435, 0.0824, 0.044135, 0.03434, 0.02704, 0.021285, 0.0185, 0.0168, 0.01344]),\n        },\n        {\n            \"name\": \"Solver B\",\n            \"E\": np.array([0.125, 0.082, 0.054, 0.039, 0.022, 0.014]),\n            \"Z\": np.array([0.375, 1.2, 2.3, 2.6, 2.5, 2.0]),\n            \"E_k8\": np.array([0.5, 0.2175, 0.1335, 0.0945, 0.0725, 0.058, 0.048, 0.041, 0.0355, 0.0315]),\n        },\n        {\n            \"name\": \"Solver C\",\n            \"E\": np.array([0.125, 0.090, 0.062, 0.0415, 0.0280, 0.0198]),\n            \"Z\": np.array([0.375, 0.9, 1.6, 2.0, 2.3, 2.5]),\n            \"E_k8\": np.array([0.5, 0.1435, 0.069, 0.041, 0.0275, 0.0195, 0.015, 0.012, 0.0095, 0.008]),\n        },\n    ]\n\n    # --- Diagnostic Functions ---\n\n    def check_initial_conditions(E, Z):\n        e_pass = np.abs(E[0] - E0_ANALYTIC) = TOL_IC\n        z_pass = np.abs(Z[0] - Z0_ANALYTIC) = TOL_IC\n        return e_pass and z_pass\n\n    def check_energy_decay(E):\n        errors = []\n        for i, t in enumerate(TIMES[1:], 1):\n            error = np.abs(E[i] - E_REF[t]) / E_REF[t]\n            errors.append(error)\n        return np.max(errors) = TOL_E\n\n    def check_enstrophy_peak(Z):\n        # We only consider t in {2,4,6,8,10}, which are indices 1 to 5\n        Z_subset = Z[1:]\n        t_subset = TIMES[1:]\n        t_star = t_subset[np.argmax(Z_subset)]\n        return np.abs(t_star - 8.0) = TOL_TZ\n        \n    def check_spectral_slope(E_k):\n        # Wavenumbers k are from 1 to 10. Indices are k-1.\n        # Fit range k in {3,4,5,6,7,8} corresponds to indices 2 through 7.\n        k_fit = np.arange(3, 9)\n        E_k_fit = E_k[2:8]\n        \n        log_k = np.log(k_fit)\n        log_E_k = np.log(E_k_fit)\n        \n        # polyfit returns [slope, intercept] for degree 1\n        slope, _ = np.polyfit(log_k, log_E_k, 1)\n        \n        target_slope = -5.0 / 3.0\n        return np.abs(slope - target_slope) = TOL_S\n\n    def check_dissipation_non_negativity(E, Z):\n        # Times for check are t_j in {2,4,6,8}, corresponding to indices j=1,2,3,4\n        for j in range(1, 5):\n            dEdt = (E[j+1] - E[j-1]) / (2 * DT)\n            Z_j = Z[j]\n            \n            eps_num_hat = -(dEdt + 2 * NU * Z_j)\n            \n            if eps_num_hat  -TOL_EPS:\n                return False\n        return True\n\n    def evaluate_solver(case):\n        \"\"\"Runs all diagnostics for a single solver case.\"\"\"\n        if not check_initial_conditions(case[\"E\"], case[\"Z\"]):\n            return False\n        if not check_energy_decay(case[\"E\"]):\n            return False\n        if not check_enstrophy_peak(case[\"Z\"]):\n            return False\n        if not check_spectral_slope(case[\"E_k8\"]):\n            return False\n        if not check_dissipation_non_negativity(case[\"E\"], case[\"Z\"]):\n            return False\n        return True\n\n    # --- Main Evaluation Loop ---\n    results = []\n    for case in test_cases:\n        pass_fail = evaluate_solver(case)\n        results.append(str(pass_fail))\n\n    # --- Final Output ---\n    # The problem asks for the output string, which this script generates.\n    # The expected output based on running this corrected code is [True,False,True]\n    print(f\"[{','.join(results)}]\")\n\n# Since the task is to return the complete XML, we'll run this function mentally\n# or externally to get the final result string for the final output.\n# Expected output from `solve()` is: [True,False,True]\n# However, the structure requires the code itself to be the answer. So we provide the corrected code.\nif __name__ == '__main__':\n    solve()\n```", "id": "3333480"}]}