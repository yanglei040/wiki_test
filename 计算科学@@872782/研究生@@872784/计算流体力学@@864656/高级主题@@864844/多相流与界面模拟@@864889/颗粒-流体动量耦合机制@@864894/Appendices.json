{"hands_on_practices": [{"introduction": "理解单个颗粒如何响应变化的流场是多相流动力学的基础。这个实践的核心是斯托克斯数（Stokes number, $St$），这是一个关键的无量纲参数，它比较了颗粒的响应时间与流场的时间尺度。通过这个练习，您将亲手推导在低$St$（一种常见情况）下的简化模型，并严格检验其准确性，从而锻炼物理建模和误差分析的能力。[@problem_id:3350836]", "problem": "考虑一个半径为 $a$、密度为 $\\rho_{p}$ 的刚性球形颗粒，悬浮在动力粘度为 $\\mu$ 的粘性不可压缩流体中。假设颗粒雷诺数很小，因此阻力由斯托克斯定律给出。令 $u(t)$ 表示施加的一维流体速度场，令 $v_{p}(t)$ 表示颗粒速度。颗粒的运动由牛顿第二定律和斯托克斯阻力支配：\n$$\nm_{p}\\,\\frac{d v_{p}}{dt} \\;=\\; 6\\pi \\mu a \\,\\big(u(t) - v_{p}(t)\\big),\n$$\n其中 $m_{p} = \\frac{4}{3}\\pi a^{3}\\rho_{p}$ 是颗粒质量。定义颗粒弛豫时间\n$$\n\\tau_{p} \\;=\\; \\frac{m_{p}}{6\\pi \\mu a} \\;=\\; \\frac{2 a^{2}\\rho_{p}}{9\\mu},\n$$\n和滑移速度\n$$\nu_{s}(t) \\;=\\; u(t) - v_{p}(t).\n$$\n令斯托克斯数 (St) 定义为 $\\mathrm{St} = \\tau_{p}/T_{f}$，其中 $T_{f}$ 是流动的特征时间尺度，并考虑渐近区域 $\\mathrm{St} \\ll 1$。\n\n从上述牛顿第二定律和斯托克斯阻力定律出发，使用与极限 $\\mathrm{St} \\ll 1$ 一致的多尺度分析，推导滑移速度 $u_{s}(t)$ 关于流体物质加速度的领导阶简化模型。然后，对于特定的施加流\n$$\nu(t) \\;=\\; U_{0}\\,\\sin(\\omega t),\n$$\n使用从控制方程推导出的滑移动力学精确解，求得瞬态衰减后的稳态周期性滑移 $u_{s}^{\\mathrm{exact}}(t)$。通过计算在一个周期 $T = 2\\pi/\\omega$ 内的相对平方可积 $L^{2}$ 误差，来量化领导阶简化模型 $u_{s}^{(0)}(t)$ 的准确性，\n$$\n\\mathcal{E} \\;=\\; \\frac{\\left(\\int_{0}^{T} \\big(u_{s}^{\\mathrm{exact}}(t) - u_{s}^{(0)}(t)\\big)^{2}\\,dt\\right)^{1/2}}{\\left(\\int_{0}^{T} \\big(u_{s}^{\\mathrm{exact}}(t)\\big)^{2}\\,dt\\right)^{1/2}}.\n$$\n\n对于参数值 $a = 50\\times 10^{-6}\\,\\mathrm{m}$、$\\rho_{p} = 1050\\,\\mathrm{kg\\,m^{-3}}$、$\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s}$、$U_{0} = 0.2\\,\\mathrm{m\\,s^{-1}}$ 和 $\\omega = 50\\,\\mathrm{s^{-1}}$，计算 $\\mathcal{E}$ 的值。将您的 $\\mathcal{E}$ 最终答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "该问题要求对非定常流体流中的颗粒运动进行多步分析，最终量化一个领导阶模型的误差。\n\n首先，我们验证问题陈述的有效性。该问题基于牛顿第二定律和斯托克斯阻力，这是一个用于描述低雷诺数下粘性流体中颗粒运动的成熟模型。控制方程是一个标准的一阶线性常微分方程。推导近似模型、求解特定情况下的精确解以及计算它们之间误差的任务是适定的，并且在数学上是合理的。所提供的物理参数是符合实际的。因此，该问题被认为是有效的，我们可以继续求解。\n\n颗粒的运动由以下方程支配：\n$$\nm_{p}\\,\\frac{d v_{p}}{dt} \\;=\\; 6\\pi \\mu a \\,\\big(u(t) - v_{p}(t)\\big)\n$$\n使用颗粒弛豫时间 $\\tau_{p} = m_{p}/(6\\pi \\mu a)$ 的定义，该方程可以重写为：\n$$\n\\tau_{p}\\,\\frac{d v_{p}}{dt} \\;=\\; u(t) - v_{p}(t)\n$$\n我们关心的是滑移速度，定义为 $u_{s}(t) = u(t) - v_{p}(t)$。根据这个定义，我们有 $v_{p}(t) = u(t) - u_{s}(t)$。将其代入前面的方程，得到一个关于滑移速度的方程：\n$$\n\\tau_{p}\\,\\frac{d}{dt}\\big(u(t) - u_{s}(t)\\big) \\;=\\; u_{s}(t)\n$$\n展开导数并重新整理各项，我们得到滑移速度的精确控制方程：\n$$\nu_{s}(t) + \\tau_{p}\\,\\frac{d u_{s}}{dt} \\;=\\; \\tau_{p}\\,\\frac{d u}{dt}\n$$\n项 $\\frac{du}{dt}$ 代表当地流体加速度。\n\n问题要求在斯托克斯数 $\\mathrm{St} = \\tau_{p}/T_{f} \\ll 1$ 的渐近区域内推导 $u_{s}(t)$ 的领导阶模型，其中 $T_{f}$ 是流动的特征时间尺度。这个条件意味着颗粒弛豫时间远小于流动时间尺度。我们可以通过考虑 $u_{s}$ 对小参数 $\\tau_{p}$ 的幂次的正则微扰展开来找到领导阶模型。\n令 $u_{s}(t) = u_{s}^{(0)}(t) + \\tau_{p} u_{s}^{(1)}(t) + O(\\tau_{p}^{2})$。将此展开式代入 $u_{s}$ 的精确方程：\n$$\n(u_{s}^{(0)} + \\tau_{p} u_{s}^{(1)} + \\dots) + \\tau_{p}\\,\\frac{d}{dt}(u_{s}^{(0)} + \\tau_{p} u_{s}^{(1)} + \\dots) \\;=\\; \\tau_{p}\\,\\frac{d u}{dt}\n$$\n收集 $\\tau_{p}$ 的同阶项：\n在 $O(1)$ 阶：\n$$\nu_{s}^{(0)}(t) = 0\n$$\n这对应于颗粒完全跟随流体的平凡情况。然而，问题要求一个用物质加速度表示的模型。这意味着我们正在寻找能够捕捉领导阶滑移动力学的下一阶修正。一个更合适的尺度分析是认识到 $u_{s}$ 本身必须是小的，量级为 $O(\\tau_{p})$。\n从精确方程中我们可以看到，如果 $\\tau_p \\to 0$，那么 $u_s \\to 0$。我们可以用这个来进行迭代。通过忽略与其他项相比是更高阶 $O(\\tau_p^2)$ 的项 $\\tau_{p}\\frac{du_s}{dt}$，可以找到一阶近似（领导阶模型）。这给出了领导阶简化模型：\n$$\nu_{s}^{(0)}(t) \\;=\\; \\tau_{p}\\,\\frac{d u}{dt}\n$$\n该模型表明，领导阶滑移速度与颗粒弛豫时间和流体加速度成正比。\n\n接下来，我们考虑特定的施加流 $u(t) = U_{0}\\,\\sin(\\omega t)$。特征流动时间尺度为 $T_f = 1/\\omega$。流体加速度为 $\\frac{du}{dt} = U_{0}\\omega\\cos(\\omega t)$。\n滑移速度的领导阶模型是：\n$$\nu_{s}^{(0)}(t) \\;=\\; \\tau_{p} (U_{0}\\omega\\cos(\\omega t)) \\;=\\; U_{0}\\omega\\tau_{p}\\cos(\\omega t)\n$$\n为了找到精确的稳态周期解 $u_{s}^{\\mathrm{exact}}(t)$，我们必须求解给定强迫项的 $u_s$ 的完整常微分方程：\n$$\n\\frac{d u_{s}}{dt} + \\frac{1}{\\tau_{p}} u_{s} \\;=\\; U_{0}\\omega\\cos(\\omega t)\n$$\n这是一个一阶线性常微分方程。我们寻求稳态周期特解。我们使用待定系数法，假设解的形式为 $u_{s}^{\\mathrm{exact}}(t) = A\\cos(\\omega t) + B\\sin(\\omega t)$。将其代入常微分方程得到：\n$$\n(-A\\omega\\sin(\\omega t) + B\\omega\\cos(\\omega t)) + \\frac{1}{\\tau_{p}}(A\\cos(\\omega t) + B\\sin(\\omega t)) = U_{0}\\omega\\cos(\\omega t)\n$$\n令 $\\cos(\\omega t)$ 和 $\\sin(\\omega t)$ 的系数相等：\n$$\n\\mathrm{cos}(\\omega t): \\quad B\\omega + \\frac{A}{\\tau_{p}} = U_{0}\\omega \\quad \\implies \\quad A + (\\omega\\tau_p)B = U_0 \\omega \\tau_p\n$$\n$$\n\\mathrm{sin}(\\omega t): \\quad -A\\omega + \\frac{B}{\\tau_{p}} = 0 \\quad \\implies \\quad B = A \\omega \\tau_p\n$$\n将第二个方程代入第一个方程：\n$$\nA + (\\omega \\tau_p)(A \\omega \\tau_p) = U_0 \\omega \\tau_p \\quad \\implies \\quad A(1 + (\\omega\\tau_{p})^{2}) = U_{0}\\omega\\tau_{p}\n$$\n求解 $A$ 和 $B$：\n$$\nA = \\frac{U_{0}\\omega\\tau_{p}}{1 + (\\omega\\tau_{p})^{2}}, \\quad B = \\frac{U_{0}(\\omega\\tau_{p})^{2}}{1 + (\\omega\\tau_{p})^{2}}\n$$\n精确的稳态周期滑移速度是：\n$$\nu_{s}^{\\mathrm{exact}}(t) \\;=\\; \\frac{U_{0}\\omega\\tau_{p}}{1 + (\\omega\\tau_{p})^{2}}\\cos(\\omega t) + \\frac{U_{0}(\\omega\\tau_{p})^{2}}{1 + (\\omega\\tau_{p})^{2}}\\sin(\\omega t)\n$$\n现在，我们计算在一个周期 $T=2\\pi/\\omega$ 上的相对 $L^{2}$ 误差 $\\mathcal{E}$。令 $S = \\omega\\tau_p$ 为此流动的斯托克斯数。\n误差为 $u_{s}^{\\mathrm{exact}}(t) - u_{s}^{(0)}(t)$：\n$$\nu_{s}^{\\mathrm{exact}}(t) - u_{s}^{(0)}(t) = \\left( \\frac{U_{0}S}{1+S^{2}} - U_0 S \\right)\\cos(\\omega t) + \\frac{U_{0}S^{2}}{1+S^{2}}\\sin(\\omega t)\n$$\n$$\n= \\left( \\frac{U_{0}S - U_0 S(1+S^2)}{1+S^{2}} \\right)\\cos(\\omega t) + \\frac{U_{0}S^{2}}{1+S^{2}}\\sin(\\omega t) = \\frac{-U_{0}S^{3}}{1+S^{2}}\\cos(\\omega t) + \\frac{U_{0}S^{2}}{1+S^{2}}\\sin(\\omega t)\n$$\n我们需要计算 $L^2$ 范数的平方。使用积分恒等式 $\\int_{0}^{T}\\cos^{2}(\\omega t)\\,dt = \\frac{T}{2}$，$\\int_{0}^{T}\\sin^{2}(\\omega t)\\,dt = \\frac{T}{2}$，以及 $\\int_{0}^{T}\\sin(\\omega t)\\cos(\\omega t)\\,dt = 0$：\n误差的范数平方为：\n$$\n\\int_{0}^{T} \\big(u_{s}^{\\mathrm{exact}}(t) - u_{s}^{(0)}(t)\\big)^{2}\\,dt = \\left(\\frac{-U_{0}S^{3}}{1+S^{2}}\\right)^{2}\\frac{T}{2} + \\left(\\frac{U_{0}S^{2}}{1+S^{2}}\\right)^{2}\\frac{T}{2} = \\frac{T}{2}\\frac{U_{0}^{2}S^{4}(S^{2}+1)}{(1+S^{2})^{2}} = \\frac{T}{2}\\frac{U_{0}^{2}S^{4}}{1+S^{2}}\n$$\n精确解的范数平方为：\n$$\n\\int_{0}^{T} \\big(u_{s}^{\\mathrm{exact}}(t)\\big)^{2}\\,dt = \\left(\\frac{U_{0}S}{1+S^{2}}\\right)^{2}\\frac{T}{2} + \\left(\\frac{U_{0}S^{2}}{1+S^{2}}\\right)^{2}\\frac{T}{2} = \\frac{T}{2}\\frac{U_{0}^{2}S^{2}(1+S^{2})}{(1+S^{2})^{2}} = \\frac{T}{2}\\frac{U_{0}^{2}S^{2}}{1+S^{2}}\n$$\n相对误差的平方是这两个量的比值：\n$$\n\\mathcal{E}^{2} = \\frac{\\frac{T}{2}\\frac{U_{0}^{2}S^{4}}{1+S^{2}}}{\\frac{T}{2}\\frac{U_{0}^{2}S^{2}}{1+S^{2}}} = S^{2}\n$$\n因此，相对误差就是斯托克斯数，$\\mathcal{E} = S = \\omega\\tau_{p}$（因为 $S > 0$）。\n\n最后，我们使用给定的参数值计算 $\\mathcal{E}$。首先，我们计算颗粒弛豫时间 $\\tau_{p}$：\n$$\n\\tau_{p} \\;=\\; \\frac{2 a^{2}\\rho_{p}}{9\\mu} \\;=\\; \\frac{2 (50\\times 10^{-6}\\,\\mathrm{m})^{2}(1050\\,\\mathrm{kg\\,m^{-3}})}{9 (1.0\\times 10^{-3}\\,\\mathrm{Pa\\,s})}\n$$\n$$\n\\tau_{p} \\;=\\; \\frac{2 (2.5 \\times 10^{-9}\\,\\mathrm{m}^{2})(1050\\,\\mathrm{kg\\,m^{-3}})}{9 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}} \\;=\\; \\frac{5.25 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-1}}}{9 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}}\n$$\n$$\n\\tau_{p} \\;=\\; 0.58333...\\times 10^{-3}\\,\\mathrm{s}\n$$\n相对误差 $\\mathcal{E}$ 是斯托克斯数 $S = \\omega\\tau_{p}$：\n$$\n\\mathcal{E} \\;=\\; \\omega\\tau_{p} \\;=\\; (50\\,\\mathrm{s^{-1}}) \\times (0.58333...\\times 10^{-3}\\,\\mathrm{s})\n$$\n$$\n\\mathcal{E} \\;=\\; 0.0291666...\n$$\n四舍五入到四位有效数字，结果是 $0.02917$。", "answer": "$$\\boxed{0.02917}$$", "id": "3350836"}, {"introduction": "在掌握了颗粒对流场时间变化的响应之后，我们现在转向空间变化的影响。在非均匀流场中，颗粒的有限尺寸会产生不可忽视的效应，导致简单模型无法捕捉的滑移速度，这一现象由法克林定律（Faxén's laws）描述。这项实践揭示了一个微妙但至关重要的物理效应——由流场曲率引起的颗粒滞后，它将加深您对简单点-颗粒模型为何在真实剪切流中失效的理解。[@problem_id:3350832]", "problem": "一个半径为 $a$ 的中性悬浮、刚性、无滑移球体，悬浮在动力粘度为 $\\mu$ 的不可压缩牛顿流体中。该流体在 $y=\\pm H$ 处的两个无限大平行平板之间进行稳态、层流的平面泊肃叶流（Poiseuille flow）。流动方向为 $x$ 方向，速度场为\n$$\n\\boldsymbol{u}(\\boldsymbol{x})=u_{x}(y)\\,\\boldsymbol{e}_{x},\\quad u_{x}(y)=U_{c}\\left(1-\\frac{y^{2}}{H^{2}}\\right),\\quad u_{y}=0,\\quad u_{z}=0,\n$$\n其中 $U_{c}$ 是中心线速度。球心位于 $y=y_{0}$ 位置，其中 $a\\ll H$ 且 $|y_{0}|\\ll H$，因此壁面效应可以忽略不计。基于 $a$ 和局部滑移速度的颗粒雷诺数足够小，因此蠕动流假设适用。假设颗粒不受外力且不受力矩，并且环境流场在颗粒尺度上变化缓慢，因此领头阶有限尺寸效应可由领头阶Faxén修正表示。\n\n从牛顿第二定律所蕴含的力平衡、Stokes流的线性特性以及刚性球形颗粒的领头阶Faxén修正的定义出发，推导领头阶流向滑移速度分量 $U_{\\text{slip},x}$，其定义为 $U_{\\text{slip},x}=U_{p,x}-u_{x}(y_{0})$，其中 $U_{p,x}$ 是颗粒在 $x$ 方向的平移速度分量。保留至 $\\mathcal{O}(a^{2}/H^{2})$ 阶的项，并忽略环境流场更高阶的空间导数。明确说明滑移的正负号及其物理释义。\n\n将您的最终答案表示为关于 $a$、$H$ 和 $U_{c}$ 的单个闭式解析表达式。使用国际单位制。无需进行数值四舍五入。\n\n在您的解答中，请简要解释您的结果对于粗网格计算流体动力学(CFD)模拟中双向耦合准确性的影响（这类模拟将颗粒视为点力且不进行Faxén修正），但最终报告的答案必须仅为上文指定的 $U_{\\text{slip},x}$ 的解析表达式。", "solution": "该问题要求在蠕动流条件下，推导稳态平面泊肃叶流中中性悬浮刚性球体的领头阶流向滑移速度。分析始于Stokes流中球形颗粒所受流体动力的基本表达式，该表达式包含了Faxén定律。\n\n对于不受外力的颗粒，牛顿第二定律规定其所受合力为零。作用在颗粒上的主要力是流体动力阻力 $\\boldsymbol{F}$。对于蠕动流中半径为 $a$ 的刚性球体，该力由Stokes定律的推广形式给出：\n$$\n\\boldsymbol{F} = 6 \\pi \\mu a \\left( \\langle\\boldsymbol{u}\\rangle_{\\mathcal{S}} - \\boldsymbol{U}_p \\right)\n$$\n其中 $\\mu$ 是流体的动力粘度，$\\boldsymbol{U}_p$ 是颗粒中心的平移速度，$\\langle\\boldsymbol{u}\\rangle_{\\mathcal{S}}$ 是未受扰动的环境流体速度场 $\\boldsymbol{u}(\\boldsymbol{x})$ 在颗粒所占据的球体表面上的平均值。\n\n问题说明颗粒不受外力，因此 $\\boldsymbol{F} = \\boldsymbol{0}$。这意味着颗粒速度与表面平均环境速度之间达到平衡：\n$$\n\\boldsymbol{U}_p = \\langle\\boldsymbol{u}\\rangle_{\\mathcal{S}}\n$$\n为了计算 $\\langle\\boldsymbol{u}\\rangle_{\\mathcal{S}}$，我们使用领头阶Faxén修正，该修正是通过将环境流场 $\\boldsymbol{u}$ 在颗粒中心 $\\boldsymbol{x}_p$ 附近进行泰勒级数展开得到的。问题指出，环境流场在颗粒尺度上变化缓慢（$a \\ll H$），这为截断级数提供了依据。领头阶修正是：\n$$\n\\langle\\boldsymbol{u}\\rangle_{\\mathcal{S}} \\approx \\boldsymbol{u}(\\boldsymbol{x}_p) + \\frac{a^2}{6} \\nabla^2 \\boldsymbol{u}|_{\\boldsymbol{x}_p}\n$$\n其中 $\\nabla^2$ 是拉普拉斯算子。结合这些方程，可得颗粒的速度：\n$$\n\\boldsymbol{U}_p \\approx \\boldsymbol{u}(\\boldsymbol{x}_p) + \\frac{a^2}{6} \\nabla^2 \\boldsymbol{u}|_{\\boldsymbol{x}_p}\n$$\n未受扰动的环境流是给定的平面泊肃叶流：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = u_x(y) \\boldsymbol{e}_x = U_c \\left(1 - \\frac{y^2}{H^2}\\right) \\boldsymbol{e}_x\n$$\n我们必须计算该速度场的拉普拉斯。拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$。由于 $u_x$ 仅依赖于坐标 $y$，其关于 $x$ 和 $z$ 的偏导数均为零。向量场 $\\boldsymbol{u}$ 的拉普拉斯为：\n$$\n\\nabla^2 \\boldsymbol{u} = \\left( \\nabla^2 u_x \\right) \\boldsymbol{e}_x = \\left( \\frac{\\partial^2 u_x}{\\partial y^2} \\right) \\boldsymbol{e}_x\n$$\n我们计算 $u_x(y)$ 关于 $y$ 的二阶导数：\n$$\n\\frac{\\partial u_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_c \\left(1 - \\frac{y^2}{H^2}\\right) \\right] = U_c \\left( -\\frac{2y}{H^2} \\right)\n$$\n$$\n\\frac{\\partial^2 u_x}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ -\\frac{2 U_c y}{H^2} \\right] = -\\frac{2 U_c}{H^2}\n$$\n这个结果是一个常数，证实了更高阶的空间导数为零，这与问题的假设一致。\n\n将此结果代入颗粒速度 $\\boldsymbol{U}_p$ 的表达式，并在颗粒中心位置 $\\boldsymbol{x}_p$ (其中 $y=y_0$) 处求值，我们得到：\n$$\n\\boldsymbol{U}_p \\approx u_x(y_0)\\boldsymbol{e}_x + \\frac{a^2}{6} \\left( -\\frac{2 U_c}{H^2} \\right) \\boldsymbol{e}_x\n$$\n颗粒的平移速度完全在 $x$ 方向上。其 $x$ 分量 $U_{p,x}$ 为：\n$$\nU_{p,x} \\approx u_x(y_0) - \\frac{a^2 U_c}{3 H^2}\n$$\n问题要求的是流向滑移速度，定义为 $U_{\\text{slip},x} = U_{p,x} - u_x(y_0)$。使用我们刚刚推导出的 $U_{p,x}$ 的表达式：\n$$\nU_{\\text{slip},x} = \\left( u_x(y_0) - \\frac{a^2 U_c}{3 H^2} \\right) - u_x(y_0)\n$$\n$$\nU_{\\text{slip},x} = -\\frac{a^2 U_c}{3 H^2}\n$$\n该表达式是 $\\mathcal{O}(a^2/H^2)$ 阶的，符合要求。\n\n滑移速度的符号为负。这意味着 $U_{p,x}  u_x(y_0)$，表明颗粒的水平平移速度慢于其中心线处的未受扰动流体。这种现象被称为“颗粒滞后”，是背景流剖面曲率的直接结果。泊肃叶剖面是凹的（$u_x''(y)  0$），因此在靠近通道中心线的一侧，流体速度较大，而在靠近壁面的一侧，流体速度较小。颗粒周围流动的这种不对称性产生了一个与主流方向相反的净阻力，导致颗粒滞后。Faxén修正项 $\\frac{a^2}{6} \\nabla^2 \\boldsymbol{u}$ 精确地解释了这种效应。\n\n这对计算流体动力学(CFD)的影响是显著的。在许多实现双向耦合的粗网格模拟中，小于网格分辨率的颗粒被建模为“点颗粒”。一个简化的点颗粒模型可能仅基于颗粒中心的局部流体速度来计算阻力，即 $\\boldsymbol{F} \\propto (\\boldsymbol{u}(\\boldsymbol{x}_p) - \\boldsymbol{U}_p)$。对于不受外力的颗粒，该模型会错误地预测 $\\boldsymbol{U}_p = \\boldsymbol{u}(\\boldsymbol{x}_p)$，这意味着滑移速度为零。我们的结果表明，真实的滑移速度非零，并且取决于流场曲率（$\\nabla^2 \\boldsymbol{u}$）和颗粒尺寸（$a$）。忽略Faxén修正会导致高估颗粒速度，并且未能捕捉到颗粒滞后现象。这可能在预测非均匀流中的颗粒轨迹、弥散和浓度分布时导致显著误差。精确的模型必须包含亚网格尺度的物理过程，例如Faxén修正，以正确地表示颗粒-流体相互作用。", "answer": "$$\n\\boxed{-\\frac{a^{2} U_{c}}{3H^{2}}}\n$$", "id": "3350832"}, {"introduction": "将物理原理转化为可靠的计算是最终的挑战，因为仿真的优劣取决于其对基本定律的忠实程度。本练习的核心是牛顿第三定律，即作用力与反作用力原理：在一个耦合模拟中，颗粒施加给流体的力必须精确地平衡颗粒动量的变化（以及任何外力）。通过这项实践，您将实现一个数值验证测试，以确认一个模拟的颗粒-流体系统在机器精度内是动量守恒的，这是任何有效的双向耦合代码都必须通过的基本检验。[@problem_id:3350807]", "problem": "要求您在计算流体力学（CFD）高级研究生课程的水平上，为粒子-流体耦合中的动量守恒实现一个独立的数值验证测试。目的是在离散时间内，检验当考虑了作用在粒子上的任何非相间外力后，粒子对流体施加的净力是否等于总粒子动量时间变化率的负值。该验证必须纯粹以数学和算法的形式提出和解决，并且最终输出必须是可量化的。所有结果必须使用国际单位制（SI）计算：质量单位为千克（kg），速度单位为米/秒（m/s），时间单位为秒（s），加速度单位为米/秒平方（m/s$^2$），力单位为牛顿（N）。最终程序输出必须是单行，包含一个布尔值列表，指示每个测试用例是否通过验证。\n\n基本原理：使用牛顿第二运动定律和牛顿第三运动定律。假设有 $N$ 个粒子，每个粒子的质量为 $m_i$，速度为 $\\mathbf{u}_i(t)$，其中 $\\mathbf{u}_i$ 是 $\\mathbb{R}^3$ 中的一个向量。设 $\\Delta t$ 是从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的一个离散时间步长。定义总粒子动量为 $\\mathbf{P}_p(t) = \\sum_{i=1}^{N} m_i \\mathbf{u}_i(t)$。设 $\\mathbf{F}^{p \\to f}_i$ 表示粒子 $i$ 施加于流体的力（粒子-流体相间作用力），并设 $\\mathbf{F}^{\\text{ext}}_i$ 表示作用于粒子 $i$ 的任何非经由流体介导的外力（例如重力）。采用第一性原理的离散时间检验，您的任务是为每个测试用例确定以下一致性条件是否在双精度机器精度下得到满足：残差向量（定义为粒子-流体净力加上总粒子动量的有限差分时间导数减去作用于粒子的总外力）的欧几里得范数小于或等于一个基于机器 epsilon 和各项自然数量级的容差。具体来说，通过以下方式定义残差向量 $\\mathbf{r} \\in \\mathbb{R}^3$：\n- 将所有粒子-流体作用力对粒子求和，得到 $\\sum_{i=1}^{N} \\mathbf{F}^{p \\to f}_i$，\n- 计算有限差分 $\\left(\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}\\right)/\\Delta t$，\n- 将外力求和 $\\sum_{i=1}^{N} \\mathbf{F}^{\\text{ext}}_i$（如果需要，可解释为在时间步长 $\\Delta t$ 内的时间平均值），\n- 并将前两项之和减去第三项，构成 $\\mathbf{r}$。\n\n使用以下容差标准进行通过/失败的判定：设 $\\epsilon$ 为双精度机器 epsilon，并设 $\\|\\cdot\\|_2$ 表示欧几里得范数。定义相对容差 $r_{\\text{tol}} = 500\\,\\epsilon$ 和绝对容差 $a_{\\text{tol}} = 500\\,\\epsilon$。设尺度为 $S = \\max\\left(\\|\\sum_i \\mathbf{F}^{p \\to f}_i\\|_2, \\left\\|\\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}}{\\Delta t}\\right\\|_2, \\left\\|\\sum_i \\mathbf{F}^{\\text{ext}}_i\\right\\|_2, 1\\right)$。当且仅当 $\\|\\mathbf{r}\\|_2 \\le a_{\\text{tol}} + r_{\\text{tol}}\\, S$ 时，宣布测试用例通过。该标准旨在反映“达到机器精度”的验证。\n\n实现一个程序，为下述每个测试用例计算一个布尔值，指示上述一致性条件是否通过。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔的布尔值列表，例如 $[\\text{True},\\text{False}]$。\n\n重要实现说明：\n- 将 $\\mathbf{F}^{p \\to f}_i$ 解释为在时间步长内粒子 $i$ 施加于流体的力；根据牛顿第三定律，流体施加于粒子的力为 $-\\mathbf{F}^{p \\to f}_i$。\n- 有限差分导数必须构造成 $\\left(\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}\\right)/\\Delta t$ 的形式，其中 $\\mathbf{P}_p^{n} = \\sum_{i=1}^{N} m_i \\mathbf{u}_i^n$ 且 $\\mathbf{P}_p^{n+1} = \\sum_{i=1}^{N} m_i \\mathbf{u}_i^{n+1}$。\n- 所有向量均为三维。使用标准欧几里得范数。\n- 所有计算都应以双精度（IEEE $754$ binary64）进行。\n- 本问题不涉及角度。\n- 当存在外力时，应将其视为在时间步长 $\\Delta t$ 内已知且恒定。\n\n测试套件：\n对于每个测试用例，您将获得或必须构建以下输入：\n- $N$，粒子数量。\n- $\\Delta t$，单位为秒。\n- 质量 $\\{m_i\\}_{i=1}^N$，单位为千克。\n- 初始速度 $\\{\\mathbf{u}_i^n\\}_{i=1}^N$，单位为米/秒。\n- 粒子-流体作用力 $\\{\\mathbf{F}^{p \\to f}_i\\}_{i=1}^N$，单位为牛顿。\n- 外力 $\\{\\mathbf{F}^{\\text{ext}}_i\\}_{i=1}^N$，单位为牛顿（如果未指定，则为零）。\n- 最终速度 $\\{\\mathbf{u}_i^{n+1}\\}_{i=1}^N$，单位为米/秒。在某些测试用例中，您将使用上述基本定律根据其他量计算这些速度。\n\n您的程序必须按顺序处理以下五个测试用例，并以单行输出一个布尔值列表 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$：\n\n- 测试用例 1（双向耦合，无外力；如果实现正确，预期通过）：\n  - $N = 2$。\n  - $\\Delta t = 10^{-3}\\ \\text{s}$。\n  - 质量：$[\\,m_1, m_2\\,] = [\\,1.2,\\ 0.8\\,]\\ \\text{kg}$。\n  - 初始速度：\n    - $\\mathbf{u}_1^n = [\\,1.0,\\ -0.5,\\ 0.2\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_2^n = [\\,0.0,\\ 2.0,\\ -1.0\\,]\\ \\text{m/s}$。\n  - 粒子-流体作用力：\n    - $\\mathbf{F}^{p \\to f}_1 = [\\,0.5,\\ -1.3,\\ 0.7\\,]\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_2 = [\\,-0.2,\\ 0.4,\\ -0.1\\,]\\ \\text{N}$。\n  - 外力：$\\mathbf{F}^{\\text{ext}}_1 = \\mathbf{0}$，$\\mathbf{F}^{\\text{ext}}_2 = \\mathbf{0}$。\n  - 最终速度：使用离散时间的牛顿第二定律计算，其中作用在粒子上的唯一力是流体-粒子作用力，即对于每个粒子 $i$，设置 $\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^{n} + \\Delta t\\,\\mathbf{a}_i$，其中 $\\mathbf{a}_i$ 满足 $m_i \\mathbf{a}_i = -\\mathbf{F}^{p \\to f}_i$。等效地，$\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^{n} - \\Delta t\\,\\mathbf{F}^{p \\to f}_i/m_i$。\n\n- 测试用例 2（单向耦合，流体上无反作用力；预期验证失败）：\n  - $N = 2$。\n  - $\\Delta t = 10^{-3}\\ \\text{s}$。\n  - 质量：$[\\,1.2,\\ 0.8\\,]\\ \\text{kg}$。\n  - 初始速度：\n    - $\\mathbf{u}_1^n = [\\,1.0,\\ -0.5,\\ 0.2\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_2^n = [\\,0.0,\\ 2.0,\\ -1.0\\,]\\ \\text{m/s}$。\n  - 粒子-流体作用力：\n    - $\\mathbf{F}^{p \\to f}_1 = \\mathbf{0}\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_2 = \\mathbf{0}\\ \\text{N}$。\n  - 外力：$\\mathbf{F}^{\\text{ext}}_1 = \\mathbf{0}$，$\\mathbf{F}^{\\text{ext}}_2 = \\mathbf{0}$。\n  - 最终速度：指定\n    - $\\mathbf{u}_1^{n+1} = [\\,1.002,\\ -0.498,\\ 0.198\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_2^{n+1} = [\\,-0.001,\\ 2.001,\\ -1.001\\,]\\ \\text{m/s}$。\n\n- 测试用例 3（以重力为外力的双向耦合；如果实现正确，预期通过）：\n  - $N = 3$。\n  - $\\Delta t = 2\\times 10^{-3}\\ \\text{s}$。\n  - 质量：$[\\,m_1, m_2, m_3\\,] = [\\,0.5,\\ 1.5,\\ 0.25\\,]\\ \\text{kg}$。\n  - 初始速度：\n    - $\\mathbf{u}_1^n = [\\,0.2,\\ 0.0,\\ -0.1\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_2^n = [\\,1.0,\\ -0.5,\\ 0.3\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_3^n = [\\,-0.3,\\ 0.7,\\ 0.0\\,]\\ \\text{m/s}$。\n  - 粒子-流体作用力：\n    - $\\mathbf{F}^{p \\to f}_1 = [\\,-0.3,\\ 0.1,\\ 0.05\\,]\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_2 = [\\,0.2,\\ -0.4,\\ 0.1\\,]\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_3 = [\\,0.0,\\ 0.0,\\ -0.02\\,]\\ \\text{N}$。\n  - 外力（重力加速度为 $\\mathbf{g} = [\\,0,\\ -9.81,\\ 0\\,]\\ \\text{m/s}^2$）：对于每个粒子 $i$，$\\mathbf{F}^{\\text{ext}}_i = m_i\\,\\mathbf{g}$。\n  - 最终速度：使用 $\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^n + \\Delta t\\,\\mathbf{a}_i$ 为每个粒子计算，其中 $m_i \\mathbf{a}_i = -\\mathbf{F}^{p \\to f}_i + \\mathbf{F}^{\\text{ext}}_i$。等效地，$\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^{n} - \\Delta t\\,\\mathbf{F}^{p \\to f}_i/m_i + \\Delta t\\,\\mathbf{g}$。\n\n- 测试用例 4（使用极小时间步长探测数值精度的双向耦合；如果实现正确，预期通过）：\n  - $N = 3$。\n  - $\\Delta t = 10^{-12}\\ \\text{s}$。\n  - 质量：$[\\,2.0,\\ 1.0,\\ 0.5\\,]\\ \\text{kg}$。\n  - 初始速度：\n    - $\\mathbf{u}_1^n = [\\,0.0,\\ 0.0,\\ 0.0\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_2^n = [\\,0.1,\\ -0.1,\\ 0.1\\,]\\ \\text{m/s}$，\n    - $\\mathbf{u}_3^n = [\\,-0.2,\\ 0.2,\\ -0.2\\,]\\ \\text{m/s}$。\n  - 粒子-流体作用力：\n    - $\\mathbf{F}^{p \\to f}_1 = [\\,10^3,\\ -2\\times 10^3,\\ 3\\times 10^3\\,]\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_2 = [\\,-1.5\\times 10^3,\\ 2.5\\times 10^3,\\ -3.5\\times 10^3\\,]\\ \\text{N}$，\n    - $\\mathbf{F}^{p \\to f}_3 = [\\,2\\times 10^3,\\ -10^3,\\ 5\\times 10^2\\,]\\ \\text{N}$。\n  - 外力：全部为零。\n  - 最终速度：使用 $\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^{n} - \\Delta t\\,\\mathbf{F}^{p \\to f}_i/m_i$ 计算。\n\n- 测试用例 5（多粒子的统计覆盖；如果实现正确，预期通过）：\n  - $N = 50$。\n  - $\\Delta t = 3\\times 10^{-4}\\ \\text{s}$。\n  - 使用固定种子进行随机化构建以确保可复现性：\n    - 使用以 $12345$ 为种子的伪随机数生成器。\n    - 质量：从区间 $[\\,0.1,\\ 3.0\\,]\\ \\text{kg}$ 中均匀抽取 $N$ 个独立样本。\n    - 初始速度：抽取 $N$ 个独立向量，其每个分量从 $[\\, -1.0,\\ 1.0\\,]\\ \\text{m/s}$ 中均匀抽取。\n    - 粒子-流体作用力：抽取 $N$ 个独立向量，其每个分量从 $[\\, -10.0,\\ 10.0\\,]\\ \\text{N}$ 中均匀抽取。\n    - 外力：全部为零。\n    - 最终速度：使用 $\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^{n} - \\Delta t\\,\\mathbf{F}^{p \\to f}_i/m_i$ 计算。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\,\\text{True},\\text{False},\\text{True},\\text{True},\\text{True}\\,]$）。每个条目都是一个布尔值，指示相应的测试用例是否在指定容差内满足所述的一致性条件。所有计算必须如所述使用 SI 单位进行，并且结果必须完全按照规定打印。", "solution": "问题陈述要求为离散时间粒子-流体系统中的动量守恒实现一个数值验证测试。该测试的有效性建立在牛顿力学的基础原理之上。\n\n被验证的基本原理是动量平衡。对于一个由 $N$ 个与流体相互作用并受到外力作用的粒子组成的系统，应用于单个粒子 $i$ 的牛顿第二定律指出，其动量变化率等于作用在其上的总力：\n$$\nm_i \\frac{d\\mathbf{u}_i}{dt} = \\mathbf{F}_{\\text{total}, i}\n$$\n其中 $m_i$ 是粒子 $i$ 的质量，$\\mathbf{u}_i(t)$ 是其速度。总力是流体作用于粒子的力 $\\mathbf{F}^{f \\to p}_i$ 与任何其他外力 $\\mathbf{F}^{\\text{ext}}_i$ 的总和：\n$$\nm_i \\frac{d\\mathbf{u}_i}{dt} = \\mathbf{F}^{f \\to p}_i + \\mathbf{F}^{\\text{ext}}_i\n$$\n根据牛顿第三定律，流体施加于粒子的力等于粒子施加于流体的力 $\\mathbf{F}^{p \\to f}_i$ 的大小，方向相反。因此，\n$$\n\\mathbf{F}^{f \\to p}_i = -\\mathbf{F}^{p \\to f}_i\n$$\n将此代入粒子 $i$ 的运动方程，得到：\n$$\nm_i \\frac{d\\mathbf{u}_i}{dt} = -\\mathbf{F}^{p \\to f}_i + \\mathbf{F}^{\\text{ext}}_i\n$$\n为了得到整个粒子系的方程，我们将此方程对所有 $N$ 个粒子求和：\n$$\n\\sum_{i=1}^{N} m_i \\frac{d\\mathbf{u}_i}{dt} = -\\sum_{i=1}^{N} \\mathbf{F}^{p \\to f}_i + \\sum_{i=1}^{N} \\mathbf{F}^{\\text{ext}}_i\n$$\n认识到总粒子动量为 $\\mathbf{P}_p(t) = \\sum_{i=1}^{N} m_i \\mathbf{u}_i(t)$，且质量 $m_i$ 是恒定的，左侧是总粒子动量的时间导数 $\\frac{d\\mathbf{P}_p}{dt}$。该方程可以重新排列，以表明所有力（粒子-流体力、粒子动量变化率和外力）的总和为零：\n$$\n\\left(\\sum_{i=1}^{N} \\mathbf{F}^{p \\to f}_i\\right) + \\frac{d\\mathbf{P}_p}{dt} - \\left(\\sum_{i=1}^{N} \\mathbf{F}^{\\text{ext}}_i\\right) = \\mathbf{0}\n$$\n该方程表示连续时间下的精确动量平衡。计算流体力学模拟必须以其离散形式满足这种平衡。问题要求我们在从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的单个时间步长内验证这一点。我们使用一阶有限差分来近似时间导数：\n$$\n\\frac{d\\mathbf{P}_p}{dt} \\approx \\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}}{\\Delta t}\n$$\n其中 $\\mathbf{P}_p^n = \\sum_{i=1}^{N} m_i \\mathbf{u}_i^n$ 且 $\\mathbf{P}_p^{n+1} = \\sum_{i=1}^{N} m_i \\mathbf{u}_i^{n+1}$。力 $\\mathbf{F}^{p \\to f}_i$ 和 $\\mathbf{F}^{\\text{ext}}_i$ 在区间 $\\Delta t$ 内被视作常数。\n\n验证测试检查动量平衡方程的离散版本是否成立。我们将残差向量 $\\mathbf{r} \\in \\mathbb{R}^3$ 定义为该方程的离散形式：\n$$\n\\mathbf{r} = \\left(\\sum_{i=1}^{N} \\mathbf{F}^{p \\to f}_i\\right) + \\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}}{\\Delta t} - \\left(\\sum_{i=1}^{N} \\mathbf{F}^{\\text{ext}}_i\\right)\n$$\n从解析上讲，如果粒子速度根据牛顿定律的离散形式更新，这个残差应为零。例如，对粒子 $i$ 使用前向欧拉时间积分方案：\n$$\nm_i \\frac{\\mathbf{u}_i^{n+1} - \\mathbf{u}_i^n}{\\Delta t} = -\\mathbf{F}^{p \\to f}_i + \\mathbf{F}^{\\text{ext}}_i\n$$\n对所有粒子求和，我们发现 $\\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^n}{\\Delta t} = -\\sum_{i=1}^N \\mathbf{F}^{p \\to f}_i + \\sum_{i=1}^N \\mathbf{F}^{\\text{ext}}_i$。将此代入 $\\mathbf{r}$ 的定义，使得 $\\mathbf{r}$ 在解析上等于 $\\mathbf{0}$。测试用例 1、3、4 和 5 都是这样构建的，因此它们测试 $\\mathbf{r}$ 是否在数值精度范围内为零。测试用例 2 违反了这种构造，导致解析上非零的残差。\n\n由于有限精度的浮点运算，数值计算出的 $\\mathbf{r}$ 不会精确为零。因此，验证过程是检查残差的欧几里得范数 $\\|\\mathbf{r}\\|_2$ 是否足够小。一个稳健的标准是将 $\\|\\mathbf{r}\\|_2$ 与一个随相关项量级变化的容差进行比较。问题指定了容差检查：\n$$\n\\|\\mathbf{r}\\|_2 \\le a_{\\text{tol}} + r_{\\text{tol}} S\n$$\n其中 $a_{\\text{tol}} = 500\\epsilon$ 是绝对容差，$r_{\\text{tol}} = 500\\epsilon$ 是相对容差，$\\epsilon$ 是双精度数的机器 epsilon，而 $S$ 是一个定义如下的尺度因子：\n$$\nS = \\max\\left(\\left\\|\\sum_i \\mathbf{F}^{p \\to f}_i\\right\\|_2, \\left\\|\\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^{n}}{\\Delta t}\\right\\|_2, \\left\\|\\sum_i \\mathbf{F}^{\\text{ext}}_i\\right\\|_2, 1\\right)\n$$\n\n解决该问题的算法如下：\n1. 对于每个测试用例，定义所有给定参数：$N, \\Delta t$, $\\{m_i\\}$, $\\{\\mathbf{u}_i^n\\}$, $\\{\\mathbf{F}^{p \\to f}_i\\}$ 和 $\\{\\mathbf{F}^{\\text{ext}}_i\\}$。\n2. 如果未提供最终速度 $\\{\\mathbf{u}_i^{n+1}\\}$，则使用离散运动方程计算它们：$\\mathbf{u}_i^{n+1} = \\mathbf{u}_i^n + \\frac{\\Delta t}{m_i} (-\\mathbf{F}^{p \\to f}_i + \\mathbf{F}^{\\text{ext}}_i)$。对于测试用例 5，这涉及首先使用指定的种子生成随机输入。\n3. 计算在时间 $t^n$ 和 $t^{n+1}$ 的总动量：$\\mathbf{P}_p^n = \\sum_i m_i \\mathbf{u}_i^n$ 和 $\\mathbf{P}_p^{n+1} = \\sum_i m_i \\mathbf{u}_i^{n+1}$。\n4. 计算残差的各项：总粒子-流体作用力 $\\sum_i \\mathbf{F}^{p \\to f}_i$，总动量的离散时间导数 $\\frac{\\mathbf{P}_p^{n+1} - \\mathbf{P}_p^n}{\\Delta t}$，以及总外力 $\\sum_i \\mathbf{F}^{\\text{ext}}_i$。\n5. 组装残差向量 $\\mathbf{r}$。\n6. 计算 $\\mathbf{r}$ 的欧几里得范数和尺度因子 $S$。\n7. 检查是否满足通过条件 $\\|\\mathbf{r}\\|_2 \\le 500\\epsilon + 500\\epsilon S$。\n8. 如果满足条件，则返回 `True`，否则返回 `False`。\n此过程将应用于五个测试用例中的每一个，并收集和打印布尔结果。", "answer": "```python\nimport numpy as np\n\ndef run_verification_test(N, dt, masses, u_n, F_pf, F_ext, u_np1=None):\n    \"\"\"\n    Performs the momentum conservation verification for a single test case.\n    \n    Args:\n        N (int): Number of particles.\n        dt (float): Time step.\n        masses (np.ndarray): Array of particle masses, shape (N,).\n        u_n (np.ndarray): Array of initial velocities, shape (N, 3).\n        F_pf (np.ndarray): Array of particle-to-fluid forces, shape (N, 3).\n        F_ext (np.ndarray): Array of external forces, shape (N, 3).\n        u_np1 (np.ndarray, optional): Array of final velocities, shape (N, 3). \n                                     If None, they are computed.\n\n    Returns:\n        bool: True if the test passes, False otherwise.\n    \"\"\"\n    # Ensure all inputs are float64 for precision\n    masses = np.array(masses, dtype=np.float64)\n    u_n = np.array(u_n, dtype=np.float64)\n    F_pf = np.array(F_pf, dtype=np.float64)\n    F_ext = np.array(F_ext, dtype=np.float64)\n\n    # Step 2: Compute final velocities if not provided\n    if u_np1 is None:\n        u_np1 = np.zeros_like(u_n, dtype=np.float64)\n        for i in range(N):\n            # Discrete Newton's Second Law: m*a = F_total\n            # F_total_i = F_fluid_on_particle_i + F_ext_i\n            # F_fluid_on_particle_i = -F_particle_on_fluid_i\n            # a_i = (-F_pf_i + F_ext_i) / m_i\n            # u_np1_i = u_n_i + a_i * dt\n            u_np1[i] = u_n[i] + (dt / masses[i]) * (-F_pf[i] + F_ext[i])\n    else:\n        u_np1 = np.array(u_np1, dtype=np.float64)\n\n    # Step 3: Calculate total momentum at t^n and t^{n+1}\n    # Use np.newaxis to make masses a column vector for broadcasting\n    P_p_n = np.sum(masses[:, np.newaxis] * u_n, axis=0)\n    P_p_np1 = np.sum(masses[:, np.newaxis] * u_np1, axis=0)\n    \n    # Step 4: Compute terms for the residual\n    dP_p_dt = (P_p_np1 - P_p_n) / dt\n    sum_F_pf = np.sum(F_pf, axis=0)\n    sum_F_ext = np.sum(F_ext, axis=0)\n    \n    # Step 5: Assemble the residual vector r\n    r = sum_F_pf + dP_p_dt - sum_F_ext\n    \n    # Step 6: Calculate norm of r and the scale factor S\n    r_norm = np.linalg.norm(r)\n    \n    S = max(np.linalg.norm(sum_F_pf), \n            np.linalg.norm(dP_p_dt), \n            np.linalg.norm(sum_F_ext), \n            1.0)\n            \n    # Step 7: Check pass condition\n    eps = np.finfo(np.float64).eps\n    r_tol = 500.0 * eps\n    a_tol = 500.0 * eps\n    \n    return r_norm = a_tol + r_tol * S\n\ndef solve():\n    \"\"\"\n    Defines and runs the five test cases, then prints the results.\n    \"\"\"\n    results = []\n\n    # Test Case 1\n    N1 = 2\n    dt1 = 1e-3\n    masses1 = np.array([1.2, 0.8])\n    u_n1 = np.array([[1.0, -0.5, 0.2], [0.0, 2.0, -1.0]])\n    F_pf1 = np.array([[0.5, -1.3, 0.7], [-0.2, 0.4, -0.1]])\n    F_ext1 = np.zeros((N1, 3))\n    results.append(run_verification_test(N1, dt1, masses1, u_n1, F_pf1, F_ext1))\n\n    # Test Case 2\n    N2 = 2\n    dt2 = 1e-3\n    masses2 = np.array([1.2, 0.8])\n    u_n2 = np.array([[1.0, -0.5, 0.2], [0.0, 2.0, -1.0]])\n    F_pf2 = np.zeros((N2, 3))\n    F_ext2 = np.zeros((N2, 3))\n    u_np1_2 = np.array([[1.002, -0.498, 0.198], [-0.001, 2.001, -1.001]])\n    results.append(run_verification_test(N2, dt2, masses2, u_n2, F_pf2, F_ext2, u_np1_2))\n    \n    # Test Case 3\n    N3 = 3\n    dt3 = 2e-3\n    masses3 = np.array([0.5, 1.5, 0.25])\n    u_n3 = np.array([[0.2, 0.0, -0.1], [1.0, -0.5, 0.3], [-0.3, 0.7, 0.0]])\n    F_pf3 = np.array([[-0.3, 0.1, 0.05], [0.2, -0.4, 0.1], [0.0, 0.0, -0.02]])\n    g = np.array([0.0, -9.81, 0.0])\n    F_ext3 = masses3[:, np.newaxis] * g\n    results.append(run_verification_test(N3, dt3, masses3, u_n3, F_pf3, F_ext3))\n\n    # Test Case 4\n    N4 = 3\n    dt4 = 1e-12\n    masses4 = np.array([2.0, 1.0, 0.5])\n    u_n4 = np.array([[0.0, 0.0, 0.0], [0.1, -0.1, 0.1], [-0.2, 0.2, -0.2]])\n    F_pf4 = np.array([[1e3, -2e3, 3e3], [-1.5e3, 2.5e3, -3.5e3], [2e3, -1e3, 5e2]])\n    F_ext4 = np.zeros((N4, 3))\n    results.append(run_verification_test(N4, dt4, masses4, u_n4, F_pf4, F_ext4))\n\n    # Test Case 5\n    N5 = 50\n    dt5 = 3e-4\n    seed = 12345\n    rng = np.random.default_rng(seed)\n    masses5 = rng.uniform(low=0.1, high=3.0, size=N5)\n    u_n5 = rng.uniform(low=-1.0, high=1.0, size=(N5, 3))\n    F_pf5 = rng.uniform(low=-10.0, high=10.0, size=(N5, 3))\n    F_ext5 = np.zeros((N5, 3))\n    results.append(run_verification_test(N5, dt5, masses5, u_n5, F_pf5, F_ext5))\n\n    # Final print statement\n    # Convert Python bools to lowercase strings for the required format\n    bool_strings = [str(r).lower() for r in results]\n    print(f\"[{','.join(bool_strings)}]\")\n\nsolve()\n```", "id": "3350807"}]}