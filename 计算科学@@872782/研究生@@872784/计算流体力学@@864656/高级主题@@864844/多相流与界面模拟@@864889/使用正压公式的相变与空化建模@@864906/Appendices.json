{"hands_on_practices": [{"introduction": "本练习旨在建立一个基础概念：空化流中的混合声速。通过第一性原理推导和计算，您将发现即使是微量的气相也可能急剧降低混合声速，这对数值模拟的稳定性有着深远的影响。这项实践将理论与计算流体动力学（CFD）中一个核心的实际问题——显式格式的时间步长限制——直接联系起来。[@problem_id:3351428]", "problem": "一个正压、均匀平衡的两相混合物模型被用于描述一维（1-D）显式有限体积模拟中的空化流。假定每一相都是正压的，具有等熵声速，且混合物共享共同的压力和速度（无滑移，无界面压力不平衡）。基本的混合物组分包括：\n- 对于每一相 $k \\in \\{l,v\\}$ 的相体积模量定义：$K_k = \\rho_k c_k^{2}$，其中 $\\rho_k$ 是相密度，$c_k$ 是该相的等熵声速。\n- 混合物密度：$\\rho_m = \\alpha \\rho_v + (1-\\alpha)\\rho_l$，其中 $\\alpha$ 是蒸汽体积分数。\n- 在共同压力下（声学时间尺度内为小的等熵扰动和固定的体积分数），混合物体积柔度具有可加性：总体积应变等于各组分应变的体积分数加权和。\n\n从这些基础以及等熵压缩性和混合物体积应变可加性的第一性原理出发，推导混合物声速 $c_m$ 关于 $\\rho_l$、$c_l$、$\\rho_v$、$c_v$ 和 $\\alpha$ 的表达式。然后，对于下面的数值数据，计算 $c_m$ 并估算一维显式有限体积更新的 Courant–Friedrichs–Lewy (CFL) 限制的时间步长：\n- 液体密度 $\\rho_l = 997 \\text{ kg}\\,\\text{m}^{-3}$，\n- 液体声速 $c_l = 1482 \\text{ m}\\,\\text{s}^{-1}$，\n- 蒸汽密度 $\\rho_v = 0.023 \\text{ kg}\\,\\text{m}^{-3}$，\n- 蒸汽声速 $c_v = 430 \\text{ m}\\,\\text{s}^{-1}$，\n- 蒸汽体积分数 $\\alpha = 0.001$,\n- 单元中心的混合物速度 $u = 10 \\text{ m}\\,\\text{s}^{-1}$，\n- 均匀单元尺寸 $\\Delta x = 5.0 \\times 10^{-4} \\text{ m}$，\n- Courant–Friedrichs–Lewy (CFL) 数 $\\mathrm{CFL} = 0.6$.\n\n假设控制显式稳定性边界的特征信号速度为一维对流-声学系统的最大特征值大小，取为 $\\lvert u \\rvert + c_m$。使用稳定性要求\n$$\n\\Delta t \\le \\mathrm{CFL}\\,\\frac{\\Delta x}{\\lvert u \\rvert + c_m}.\n$$\n报告：\n- 混合物声速 $c_m$，单位为米每秒，\n- 时间步长 $\\Delta t$，单位为微秒。\n\n将两个所求量四舍五入到四位有效数字。以行向量 $\\left(c_m,\\ \\Delta t_{\\mu s}\\right)$ 的形式按此顺序提供您的最终答案，其中 $\\Delta t_{\\mu s}$ 表示以微秒（而非秒）为单位的时间步长。", "solution": "问题要求推导均匀平衡两相模型的混合物声速，并随后对该速度及相应的显式时间步长限制进行数值计算。该问题被验证为有科学依据、适定且客观。\n\n**第 1 部分：混合物声速 $c_m$ 的推导**\n\n介质中的声速 $c$ 由等熵关系 $c^2 = (\\partial p / \\partial \\rho)_s$ 定义，其中 $p$ 是压力，$\\rho$ 是密度，下标 $s$ 表示恒定熵。这可以使用等熵体积模量 $K$ 表示为 $c^2 = K/\\rho$。对于混合物，我们有 $c_m^2 = K_m / \\rho_m$，其中 $c_m$、$K_m$ 和 $\\rho_m$ 分别是混合物的声速、体积模量和密度。我们的目标是找到 $c_m$ 的表达式。\n\n问题陈述了两个关键定义和一个核心原理：\n1.  混合物密度是相密度的体积分数加权平均值：\n    $$ \\rho_m = \\alpha \\rho_v + (1-\\alpha)\\rho_l $$\n    其中 $\\alpha$ 是蒸汽体积分数，下标 $l$ 和 $v$ 分别表示液相和汽相。\n\n2.  每一相 $k \\in \\{l,v\\}$ 的体积模量定义为：\n    $$ K_k = \\rho_k c_k^2 $$\n\n3.  在共同压力的假设下，混合物的体积应变是组分应变的体积分数加权和。\n\n让我们正式推导这第三个原理的推论。质量为 $M$ 的混合物微团的总容积 $V$ 是其组分相体积之和，$V = V_l + V_v$。体积分数定义为 $\\alpha = V_v/V$ 和 $1-\\alpha = V_l/V$。\n\n总体积的微分变化是 $dV = dV_l + dV_v$。混合物的体积应变定义为 $\\epsilon_m = dV/V$。将体积变化方程两边除以 $V$ 得到：\n$$ \\epsilon_m = \\frac{dV}{V} = \\frac{dV_l}{V} + \\frac{dV_v}{V} $$\n我们可以用组分应变 $\\epsilon_l = dV_l/V_l$ 和 $\\epsilon_v = dV_v/V_v$ 来重写它：\n$$ \\epsilon_m = \\left(\\frac{V_l}{V}\\right) \\frac{dV_l}{V_l} + \\left(\\frac{V_v}{V}\\right) \\frac{dV_v}{V_v} = (1-\\alpha)\\epsilon_l + \\alpha\\epsilon_v $$\n这证实了关于应变可加性的陈述。\n\n等熵体积模量 $K$ 通过 $K = -V(dp/dV)$ 将压力变化 $dp$ 与产生的体积应变 $\\epsilon=dV/V$ 联系起来，这意味着 $\\epsilon = -dp/K$。将此应用于混合物和每一相（都经历相同的压力变化 $dp$）：\n$$ \\epsilon_m = -\\frac{dp}{K_m}, \\quad \\epsilon_l = -\\frac{dp}{K_l}, \\quad \\epsilon_v = -\\frac{dp}{K_v} $$\n将这些关系代入应变可加性方程：\n$$ -\\frac{dp}{K_m} = (1-\\alpha)\\left(-\\frac{dp}{K_l}\\right) + \\alpha\\left(-\\frac{dp}{K_v}\\right) $$\n假设 $dp \\ne 0$，我们可以消去两边的 $-dp$ 项，这就得出了柔度（体积模量的倒数）的可加性法则：\n$$ \\frac{1}{K_m} = \\frac{1-\\alpha}{K_l} + \\frac{\\alpha}{K_v} $$\n现在我们代入体积模量的定义，$K_k = \\rho_k c_k^2$ 和 $K_m = \\rho_m c_m^2$：\n$$ \\frac{1}{\\rho_m c_m^2} = \\frac{1-\\alpha}{\\rho_l c_l^2} + \\frac{\\alpha}{\\rho_v c_v^2} $$\n解出 $c_m^2$ 得：\n$$ c_m^2 = \\frac{1}{\\rho_m \\left( \\frac{1-\\alpha}{\\rho_l c_l^2} + \\frac{\\alpha}{\\rho_v c_v^2} \\right)} $$\n最后，代入混合物密度 $\\rho_m$ 的表达式，得到混合物声速的完整公式：\n$$ c_m = \\left[ (\\alpha \\rho_v + (1-\\alpha)\\rho_l) \\left( \\frac{1-\\alpha}{\\rho_l c_l^2} + \\frac{\\alpha}{\\rho_v c_v^2} \\right) \\right]^{-\\frac{1}{2}} $$\n这就是所要求的表达式。\n\n**第 2 部分：数值计算**\n\n给定以下数值数据：\n- $\\rho_l = 997 \\text{ kg}\\,\\text{m}^{-3}$\n- $c_l = 1482 \\text{ m}\\,\\text{s}^{-1}$\n- $\\rho_v = 0.023 \\text{ kg}\\,\\text{m}^{-3}$\n- $c_v = 430 \\text{ m}\\,\\text{s}^{-1}$\n- $\\alpha = 0.001$\n- $u = 10 \\text{ m}\\,\\text{s}^{-1}$\n- $\\Delta x = 5.0 \\times 10^{-4} \\text{ m}$\n- $\\mathrm{CFL} = 0.6$\n\n首先，我们计算混合物密度 $\\rho_m$：\n$$ \\rho_m = (0.001)(0.023) + (1-0.001)(997) = 0.000023 + (0.999)(997) = 0.000023 + 996.003 = 996.003023 \\text{ kg}\\,\\text{m}^{-3} $$\n\n接下来，我们计算柔度求和中的各项。\n液相体积模量为 $K_l = \\rho_l c_l^2 = 997 \\times (1482)^2 = 997 \\times 2196324 = 2189735028 \\text{ Pa}$。\n汽相体积模量为 $K_v = \\rho_v c_v^2 = 0.023 \\times (430)^2 = 0.023 \\times 184900 = 4252.7 \\text{ Pa}$。\n柔度和为：\n$$ \\frac{1-\\alpha}{K_l} + \\frac{\\alpha}{K_v} = \\frac{0.999}{2189735028} + \\frac{0.001}{4252.7} \\approx 4.5621 \\times 10^{-10} + 2.3515 \\times 10^{-7} \\approx 2.3560 \\times 10^{-7} \\text{ Pa}^{-1} $$\n我们可以看到柔度主要由汽相决定，即使其体积分数很小。\n\n现在，我们计算 $c_m^2$：\n$$ c_m^2 = \\frac{1}{996.003023 \\times (2.3560 \\times 10^{-7})} \\approx \\frac{1}{0.00023466} \\approx 4261.4 \\text{ m}^2\\,\\text{s}^{-2} $$\n取平方根求得 $c_m$：\n$$ c_m = \\sqrt{4261.4} \\approx 65.2796 \\text{ m}\\,\\text{s}^{-1} $$\n四舍五入到四位有效数字，混合物声速为 $c_m = 65.28 \\text{ m}\\,\\text{s}^{-1}$。\n\n接下来，我们计算 CFL 限制的时间步长 $\\Delta t$。稳定性条件是：\n$$ \\Delta t \\le \\mathrm{CFL}\\,\\frac{\\Delta x}{\\lvert u \\rvert + c_m} $$\n特征信号速度为 $|u| + c_m = |10| + 65.2796 = 75.2796 \\text{ m}\\,\\text{s}^{-1}$。\n我们计算最大允许时间步长：\n$$ \\Delta t = 0.6 \\times \\frac{5.0 \\times 10^{-4}}{75.2796} = \\frac{3.0 \\times 10^{-4}}{75.2796} \\approx 3.98514 \\times 10^{-6} \\text{ s} $$\n问题要求时间步长以微秒（$\\mu$s）为单位。$1 \\text{ s} = 10^6 \\mu$s。\n$$ \\Delta t \\approx 3.98514 \\text{ } \\mu\\text{s} $$\n四舍五入到四位有效数字，时间步长为 $\\Delta t = 3.985 \\text{ } \\mu\\text{s}$。\n\n最终答案以行向量 $(c_m, \\Delta t_{\\mu s})$ 的形式呈现。", "answer": "$$ \\boxed{ \\begin{pmatrix} 65.28  3.985 \\end{pmatrix} } $$", "id": "3351428"}, {"introduction": "虽然正压假设在计算上十分高效，但它忽略了相变过程中的热效应。这个编程练习将挑战您量化这种简化所带来的误差，通过将其与一个完整的热力学模型进行对比，从而让您对正压公式的有效性范围获得批判性的见解。理解正压模型的局限性对于在工程应用中做出明智的建模决策至关重要。[@problem_id:3351412]", "problem": "您的任务是量化在空化模型中因采用正压假设（忽略能量方程）而引入的建模误差，方法是与一个完整的热力学均相平衡模型进行比较。构建一个计算程序，针对每个测试案例，使用以下方法计算空化混合物的压力和声速：\n- 一种将压力仅视为密度函数的正压公式。\n- 一种在能量守恒下强制实现相平衡的完整热力学公式。\n\n起点和定义：\n- 使用均相平衡模型（HEM），其中各相共享共同的压力和温度，且混合物被视为单一连续介质。\n- 液相状态方程（Tait方程）：$$p + B = B \\left(\\frac{\\rho_l}{\\rho_0}\\right)^n$$ 其中 $B$ 和 $n$ 为常数，$\\rho_0$ 为参考密度。\n- 气相状态方程（理想气体）：$$p = \\rho_v R_v T$$ 其中 $R_v$ 是水蒸气的比气体常数。\n- 饱和压力模型（积分形式的克劳修斯-克拉佩龙方程）：$$p_{\\mathrm{sat}}(T) = p_{\\mathrm{sat,ref}} \\exp\\left(\\frac{L_0}{R_v}\\left(\\frac{1}{T_{\\mathrm{sat,ref}}} - \\frac{1}{T}\\right)\\right)$$ 其中 $L_0$ 是参考状态下的蒸发潜热，$p_{\\mathrm{sat,ref}}$ 是在 $T_{\\mathrm{sat,ref}}$ 下的参考饱和压力。\n- 均相条件下的混合物密度闭合关系：$$\\rho_{\\mathrm{mix}} = \\alpha_l \\rho_l + \\alpha_v \\rho_v$$ 其中 $\\alpha_l$ 和 $\\alpha_v$ 分别是液体和蒸汽的体积分数，满足 $\\alpha_l + \\alpha_v = 1$。\n- 混合物比焓闭合关系：$$h_{\\mathrm{mix}} = Y_l h_l(T) + Y_v h_v(T), \\quad Y_v = \\frac{\\alpha_v \\rho_v}{\\rho_{\\mathrm{mix}}}, \\quad Y_l = 1 - Y_v$$ 使用 $h_l(T) = c_{p,l}(T - T_{\\mathrm{h,ref}})$ 和 $h_v(T) = L_0 + c_{p,v}(T - T_{\\mathrm{h,ref}})$，其中 $c_{p,l}$ 和 $c_{p,v}$ 分别是液体和蒸汽的定压比热容，$T_{\\mathrm{h,ref}}$ 是焓参考温度。\n- 由Tait方程得到的液相声速：$$c_l^2 = n \\frac{p + B}{\\rho_l}$$\n- 气相声速（理想气体）：$$c_v^2 = \\gamma_v R_v T$$ 其中 $\\gamma_v$ 是蒸汽的比热比。\n- 混合物声速（Wood公式）：$$\\frac{1}{\\rho_{\\mathrm{mix}} c_{\\mathrm{mix}}^2} = \\frac{\\alpha_l}{\\rho_l c_l^2} + \\frac{\\alpha_v}{\\rho_v c_v^2}$$\n\n正压公式：\n- 定义正压压力 $p_{\\mathrm{bar}}(\\rho_{\\mathrm{mix}})$ 如下：\n  - 如果 $\\rho_{\\mathrm{mix}} \\ge \\rho_l(p_{\\mathrm{sat}}(T_0))$（纯液体），则对Tait方程求逆：$$p_{\\mathrm{bar}} = B\\left(\\left(\\frac{\\rho_{\\mathrm{mix}}}{\\rho_0}\\right)^n - 1\\right)$$ 且 $$c_{\\mathrm{bar}} = \\sqrt{n\\frac{p_{\\mathrm{bar}} + B}{\\rho_{\\mathrm{mix}}}}.$$\n  - 否则（两相平台区），设置 $$p_{\\mathrm{bar}} = p_{\\mathrm{sat}}(T_0),$$ 计算 $$\\rho_l^{(0)} = \\rho_l\\left(p_{\\mathrm{sat}}(T_0)\\right), \\quad \\rho_v^{(0)} = \\frac{p_{\\mathrm{sat}}(T_0)}{R_v T_0}, \\quad \\alpha_v^{(0)} = \\frac{\\rho_{\\mathrm{mix}} - \\rho_l^{(0)}}{\\rho_v^{(0)} - \\rho_l^{(0)}},$$ 然后使用在 $p_{\\mathrm{sat}}(T_0)$ 下的 $c_l$ 和在 $T_0$ 下的 $c_v$，通过Wood公式计算 $$c_{\\mathrm{bar}}$$。\n\n能量守恒下的完整热力学平衡：\n- 设上游全液相温度为 $T_0$；上游混合物的比焓为 $$h_0 = h_l(T_0) = c_{p,l}(T_0 - T_{\\mathrm{h,ref}})。$$\n- 如果 $\\rho_{\\mathrm{mix}} \\ge \\rho_l(p_{\\mathrm{sat}}(T_0))$（纯液体），对Tait方程求逆得到 $$p_{\\mathrm{full}} = B\\left(\\left(\\frac{\\rho_{\\mathrm{mix}}}{\\rho_0}\\right)^n - 1\\right), \\quad c_{\\mathrm{full}} = \\sqrt{n\\frac{p_{\\mathrm{full}} + B}{\\rho_{\\mathrm{mix}}}}.$$\n- 否则（两相），强制 $p = p_{\\mathrm{sat}}(T)$ 和 $\\rho_{\\mathrm{mix}} = \\alpha_l \\rho_l + \\alpha_v \\rho_v$ 以表示 $$\\alpha_v(T) = \\frac{\\rho_{\\mathrm{mix}} - \\rho_l\\left(p_{\\mathrm{sat}}(T)\\right)}{\\rho_v\\left(p_{\\mathrm{sat}}(T), T\\right) - \\rho_l\\left(p_{\\mathrm{sat}}(T)\\right)}.$$ 使用此式计算 $Y_v(T)$ 和 $h_{\\mathrm{mix}}(T)$；然后在物理合理的区间内求解 $$h_{\\mathrm{mix}}(T) = h_0$$ 以得到 $T$。设置 $$p_{\\mathrm{full}} = p_{\\mathrm{sat}}(T)$$ 并根据求解出的温度下密度闭合关系所隐含的 $(\\alpha_l, \\alpha_v)$，通过Wood公式计算 $$c_{\\mathrm{full}}$$。\n\n常数和单位：\n- 使用以下常数：$$\\rho_0 = 998 \\, \\mathrm{kg/m^3}, \\quad B = 3.0 \\times 10^8 \\, \\mathrm{Pa}, \\quad n = 7.15, \\quad R_v = 461.5 \\, \\mathrm{J/(kg\\cdot K)}, \\quad \\gamma_v = 1.33,$$ $$c_{p,l} = 4180 \\, \\mathrm{J/(kg\\cdot K)}, \\quad c_{p,v} = 1880 \\, \\mathrm{J/(kg\\cdot K)}, \\quad L_0 = 2.5 \\times 10^6 \\, \\mathrm{J/kg},$$ $$T_{\\mathrm{h,ref}} = 300 \\, \\mathrm{K}, \\quad T_{\\mathrm{sat,ref}} = 373.15 \\, \\mathrm{K}, \\quad p_{\\mathrm{sat,ref}} = 101325 \\, \\mathrm{Pa}。$$\n- 所有压力单位为帕斯卡，所有声速单位为米/秒。最终报告的偏差必须是无量纲小数。\n\n测试套件：\n- 四个测试案例由上游温度 $T_0$ 和目标混合物密度 $\\rho_{\\mathrm{mix}}$ 指定（两者均采用国际单位制）：\n  1) $T_0 = 450.0 \\, \\mathrm{K}, \\ \\rho_{\\mathrm{mix}} = 100.0 \\, \\mathrm{kg/m^3}$\n  2) $T_0 = 450.0 \\, \\mathrm{K}, \\ \\rho_{\\mathrm{mix}} = 300.0 \\, \\mathrm{kg/m^3}$\n  3) $T_0 = 350.0 \\, \\mathrm{K}, \\ \\rho_{\\mathrm{mix}} = 900.0 \\, \\mathrm{kg/m^3}$\n  4) $T_0 = 300.0 \\, \\mathrm{K}, \\ \\rho_{\\mathrm{mix}} = 995.0 \\, \\mathrm{kg/m^3}$\n\n程序要求：\n- 对于每个测试案例，计算如上定义的 $p_{\\mathrm{bar}}$、$c_{\\mathrm{bar}}$、$p_{\\mathrm{full}}$ 和 $c_{\\mathrm{full}}$。\n- 对于每个案例，报告两个无量纲偏差：\n  - 压力偏差：$$\\delta_p = \\frac{p_{\\mathrm{bar}} - p_{\\mathrm{full}}}{p_{\\mathrm{full}}}.$$\n  - 声速偏差：$$\\delta_c = \\frac{c_{\\mathrm{bar}} - c_{\\mathrm{full}}}{c_{\\mathrm{full}}}.$$\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素对应一个测试案例，并且本身是一个包含 $[\\delta_p,\\delta_c]$ 顺序偏差的双元素列表。例如：`[[d_{p,1},d_{c,1}],[d_{p,2},d_{c,2}],[d_{p,3},d_{c,3}],[d_{p,4},d_{c,4}]]`。\n\n科学真实性约束：\n- 确保求解方法遵循所述的物理模型。能量守恒的完整模型必须求解与密度闭合关系和饱和压力定律一致的标量温度平衡；正压公式不得包含温度变化。\n- 不使用角度单位。输出中不应出现百分比；偏差必须是无量纲小数。", "solution": "该问题要求对空化液汽混合物的正压模型和完整热力学模型进行定量比较。比较的依据是针对给定的上游条件（温度 $T_0$）和指定的混合物密度 $\\rho_{\\mathrm{mix}}$ 所预测的压力和声速。这是一个计算流体力学中适定的问题，旨在评估一种常见简化假设（即解耦动量方程和能量方程的正压定律）的有效性。\n\n解决方案通过构建两个不同的计算模型来实现，遵循问题描述。所有计算均使用提供的水和水蒸气的物理常数。\n\n### 1. 物理性质子模型\n\n首先，我们根据提供的状态方程和热力学关系定义材料属性的函数。这些函数是两种主要模型的构建基础。\n\n-   **饱和压力, $p_{\\mathrm{sat}}(T)$**：基于积分形式的克劳修斯-克拉佩龙方程：\n    $$p_{\\mathrm{sat}}(T) = p_{\\mathrm{sat,ref}} \\exp\\left(\\frac{L_0}{R_v}\\left(\\frac{1}{T_{\\mathrm{sat,ref}}} - \\frac{1}{T}\\right)\\right)$$\n-   **液体密度, $\\rho_l(p)$**：通过对Tait状态方程求逆得到：\n    $$p + B = B \\left(\\frac{\\rho_l}{\\rho_0}\\right)^n \\implies \\rho_l(p) = \\rho_0 \\left(\\frac{p + B}{B}\\right)^{1/n}$$\n-   **蒸汽密度, $\\rho_v(p, T)$**：根据理想气体定律：\n    $$\\rho_v(p, T) = \\frac{p}{R_v T}$$\n-   **液相声速, $c_l(p, \\rho_l)$**：\n    $$c_l^2 = n \\frac{p + B}{\\rho_l}$$\n-   **气相声速, $c_v(T)$**：\n    $$c_v^2 = \\gamma_v R_v T$$\n-   **相比焓, $h_l(T)$ 和 $h_v(T)$**：\n    $$h_l(T) = c_{p,l}(T - T_{\\mathrm{h,ref}})$$\n    $$h_v(T) = L_0 + c_{p,v}(T - T_{\\mathrm{h,ref}})$$\n\n### 2. 正压公式\n\n正压模型假设流体过程是等温的，温度固定在上游值 $T_0$。因此，压力仅是混合物密度的函数, $p_{\\mathrm{bar}} = p(\\rho_{\\mathrm{mix}}; T_0)$。\n\n第一步是确定状态是纯液体还是两相混合物。这通过将给定的混合物密度 $\\rho_{\\mathrm{mix}}$ 与对应于 $T_0$ 的饱和条件下的液体密度 $\\rho_{l,\\mathrm{sat}}(T_0) = \\rho_l(p_{\\mathrm{sat}}(T_0))$ 进行比较来决定。\n\n-   **情况1：纯液体 ($\\rho_{\\mathrm{mix}} \\ge \\rho_{l,\\mathrm{sat}}(T_0)$)**\n    在这种情况下，流体是压缩液体。压力 $p_{\\mathrm{bar}}$ 通过直接使用 $\\rho_l = \\rho_{\\mathrm{mix}}$ 计算 Tait 方程得到：\n    $$p_{\\mathrm{bar}} = B\\left(\\left(\\frac{\\rho_{\\mathrm{mix}}}{\\rho_0}\\right)^n - 1\\right)$$\n    声速 $c_{\\mathrm{bar}}$ 是此状态下的液相声速：\n    $$c_{\\mathrm{bar}} = \\sqrt{n\\frac{p_{\\mathrm{bar}} + B}{\\rho_{\\mathrm{mix}}}}$$\n\n-   **情况2：两相混合物 ($\\rho_{\\mathrm{mix}}  \\rho_{l,\\mathrm{sat}}(T_0)$)**\n    假设压力恒定，等于固定温度 $T_0$ 下的饱和压力：\n    $$p_{\\mathrm{bar}} = p_{\\mathrm{sat}}(T_0)$$\n    相属性在此状态 $(p_{\\mathrm{bar}}, T_0)$ 下进行评估。令 $\\rho_l^{(0)} = \\rho_l(p_{\\mathrm{bar}})$ 且 $\\rho_v^{(0)} = \\rho_v(p_{\\mathrm{bar}}, T_0)$。蒸汽体积分数 $\\alpha_v^{(0)}$ 由混合物密度闭合关系确定：\n    $$\\rho_{\\mathrm{mix}} = (1-\\alpha_v^{(0)})\\rho_l^{(0)} + \\alpha_v^{(0)}\\rho_v^{(0)} \\implies \\alpha_v^{(0)} = \\frac{\\rho_{\\mathrm{mix}} - \\rho_l^{(0)}}{\\rho_v^{(0)} - \\rho_l^{(0)}}$$\n    然后使用 Wood 公式计算声速 $c_{\\mathrm{bar}}$，其中相属性在 $(p_{\\mathrm{bar}}, T_0)$ 下评估：\n    $$\\frac{1}{\\rho_{\\mathrm{mix}} c_{\\mathrm{bar}}^2} = \\frac{1-\\alpha_v^{(0)}}{\\rho_l^{(0)} (c_l^{(0)})^2} + \\frac{\\alpha_v^{(0)}}{\\rho_v^{(0)} (c_v^{(0)})^2}$$\n    其中 $(c_l^{(0)})^2 = n(p_{\\mathrm{bar}} + B)/\\rho_l^{(0)}$ 且 $(c_v^{(0)})^2 = \\gamma_v R_v T_0$。\n\n### 3. 完整热力学公式\n\n该模型考虑了能量守恒。基本原理是对于一个等焓过程（如通过阀门的节流过程，这会导致空化），混合物的比焓保持恒定，等于上游的比焓, $h_0 = h_l(T_0)$。\n\n其逻辑再次在纯液区和两相区之间划分。\n\n-   **情况1：纯液体 ($\\rho_{\\mathrm{mix}} \\ge \\rho_{l,\\mathrm{sat}}(T_0)$)**\n    对于纯液相，没有发生相变，如果温度不变，则能量方程自然满足。$p_{\\mathrm{full}}$ 和 $c_{\\mathrm{full}}$ 的计算与纯液体情况下的 $p_{\\mathrm{bar}}$ 和 $c_{\\mathrm{bar}}$ 相同。\n\n-   **情况2：两相混合物 ($\\rho_{\\mathrm{mix}}  \\rho_{l,\\mathrm{sat}}(T_0)$)**\n    在两相区域，发生蒸发，导致温度下降。最终状态是在某个温度 $T  T_0$ 和相应的饱和压力 $p_{\\mathrm{full}} = p_{\\mathrm{sat}}(T)$ 下的平衡状态。这个平衡温度 $T$ 是通过求解代表能量守恒的非线性标量方程找到的：\n    $$h_{\\mathrm{mix}}(T) = h_0$$\n    其中 $h_0 = c_{p,l}(T_0 - T_{\\mathrm{h,ref}})$ 是初始比焓。混合物比焓 $h_{\\mathrm{mix}}(T)$ 是未知温度 $T$ 的函数：\n    $$h_{\\mathrm{mix}}(T) = Y_l(T) h_l(T) + Y_v(T) h_v(T)$$\n    质量分数 $Y_l(T)$ 和 $Y_v(T)$ 通过体积分数 $\\alpha_v(T)$ 依赖于 $T$：\n    $$Y_v(T) = \\frac{\\alpha_v(T) \\rho_v(p_{\\mathrm{sat}}(T), T)}{\\rho_{\\mathrm{mix}}}$$\n    并且体积分数 $\\alpha_v(T)$ 也由混合物密度闭合关系确定，但此时相密度是在未知的平衡温度 $T$ 下评估的：\n    $$\\alpha_v(T) = \\frac{\\rho_{\\mathrm{mix}} - \\rho_l(p_{\\mathrm{sat}}(T))}{\\rho_v(p_{\\mathrm{sat}}(T), T) - \\rho_l(p_{\\mathrm{sat}}(T))}$$\n    方程 $h_{\\mathrm{mix}}(T) - h_0 = 0$ 使用数值求根算法（例如 Brent 方法）在一个物理上有意义的区间内（如 $[273.16 \\, \\mathrm{K}, T_0]$）求解 $T$。\n    一旦找到平衡温度 $T_{eq}$，完整模型的压力即为 $p_{\\mathrm{full}} = p_{\\mathrm{sat}}(T_{eq})$。声速 $c_{\\mathrm{full}}$ 使用 Wood 公式计算，其中所有相属性都在此平衡状态 $(p_{\\mathrm{full}}, T_{eq})$ 下进行评估。\n\n### 4. 偏差计算\n\n对于每个测试案例 $(T_0, \\rho_{\\mathrm{mix}})$，我们计算对 $(p_{\\mathrm{bar}}, c_{\\mathrm{bar}})$ 和 $(p_{\\mathrm{full}}, c_{\\mathrm{full}})$。然后按规定计算相对偏差：\n-   压力偏差：$\\delta_p = \\frac{p_{\\mathrm{bar}} - p_{\\mathrm{full}}}{p_{\\mathrm{full}}}$\n-   声速偏差：$\\delta_c = \\frac{c_{\\mathrm{bar}} - c_{\\mathrm{full}}}{c_{\\mathrm{full}}}$\n\n对问题陈述中提供的每个测试案例执行这些步骤，以生成最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Computes pressure and speed-of-sound deviations between a barotropic and a\n    full thermodynamic model for cavitating flow, for a given set of test cases.\n    \"\"\"\n\n    # Physical constants\n    C = {\n        'rho0': 998.0,         # kg/m^3\n        'B': 3.0e8,           # Pa\n        'n': 7.15,            # dimensionless\n        'Rv': 461.5,          # J/(kg.K)\n        'gamma_v': 1.33,      # dimensionless\n        'cp_l': 4180.0,       # J/(kg.K)\n        'cp_v': 1880.0,       # J/(kg.K)\n        'L0': 2.5e6,          # J/kg\n        'T_h_ref': 300.0,     # K (enthalpy reference)\n        'T_sat_ref': 373.15,  # K\n        'p_sat_ref': 101325.0 # Pa\n    }\n\n    # --- Helper functions for physical properties ---\n\n    def p_sat(T, C):\n        \"\"\"Saturation pressure (Pa) as a function of temperature (K).\"\"\"\n        return C['p_sat_ref'] * np.exp((C['L0'] / C['Rv']) * (1/C['T_sat_ref'] - 1/T))\n\n    def rho_l(p, C):\n        \"\"\"Liquid density (kg/m^3) as a function of pressure (Pa).\"\"\"\n        return C['rho0'] * ((p + C['B']) / C['B'])**(1/C['n'])\n\n    def rho_v(p, T, C):\n        \"\"\"Vapor density (kg/m^3) from ideal gas law.\"\"\"\n        return p / (C['Rv'] * T)\n\n    def c_l_sq(p, rho_l_val, C):\n        \"\"\"Squared liquid speed of sound (m^2/s^2).\"\"\"\n        return C['n'] * (p + C['B']) / rho_l_val\n    \n    def c_v_sq(T, C):\n        \"\"\"Squared vapor speed of sound (m^2/s^2).\"\"\"\n        return C['gamma_v'] * C['Rv'] * T\n\n    def h_l(T, C):\n        \"\"\"Liquid specific enthalpy (J/kg).\"\"\"\n        return C['cp_l'] * (T - C['T_h_ref'])\n\n    def h_v(T, C):\n        \"\"\"Vapor specific enthalpy (J/kg).\"\"\"\n        return C['L0'] + C['cp_v'] * (T - C['T_h_ref'])\n\n    # --- Model Solvers ---\n\n    def solve_barotropic(T0, rho_mix, C):\n        \"\"\"Computes pressure and speed of sound using the barotropic model.\"\"\"\n        p_sat_T0 = p_sat(T0, C)\n        rho_l_sat_T0 = rho_l(p_sat_T0, C)\n\n        if rho_mix >= rho_l_sat_T0: # Pure liquid\n            p_bar = C['B'] * ((rho_mix / C['rho0'])**C['n'] - 1)\n            c_bar_sq = c_l_sq(p_bar, rho_mix, C)\n            c_bar = np.sqrt(c_bar_sq)\n        else: # Two-phase mixture\n            p_bar = p_sat_T0\n            rho_v_T0 = rho_v(p_bar, T0, C)\n            \n            alpha_v = (rho_mix - rho_l_sat_T0) / (rho_v_T0 - rho_l_sat_T0)\n            alpha_l = 1.0 - alpha_v\n\n            cl2 = c_l_sq(p_bar, rho_l_sat_T0, C)\n            cv2 = c_v_sq(T0, C)\n            \n            # Wood's formula: 1/(rho_mix * c_mix^2) = ...\n            c_bar_sq_inv = (alpha_l / (rho_l_sat_T0 * cl2)) + (alpha_v / (rho_v_T0 * cv2))\n            c_bar = np.sqrt(1 / (rho_mix * c_bar_sq_inv))\n        \n        return p_bar, c_bar\n\n    def solve_full_thermo(T0, rho_mix, C):\n        \"\"\"Computes pressure and speed of sound using the full thermodynamic model.\"\"\"\n        p_sat_T0 = p_sat(T0, C)\n        rho_l_sat_T0 = rho_l(p_sat_T0, C)\n\n        if rho_mix >= rho_l_sat_T0: # Pure liquid\n            p_full = C['B'] * ((rho_mix / C['rho0'])**C['n'] - 1)\n            c_full_sq = c_l_sq(p_full, rho_mix, C)\n            c_full = np.sqrt(c_full_sq)\n        else: # Two-phase mixture\n            h0 = h_l(T0, C)\n\n            def residual(T):\n                \"\"\"Objective function for root finding: h_mix(T) - h0 = 0.\"\"\"\n                if T = 0: return np.inf # Avoid unphysical temperatures\n                p = p_sat(T, C)\n                rho_l_T = rho_l(p, C)\n                rho_v_T = rho_v(p, T, C)\n\n                if rho_v_T - rho_l_T == 0: return np.inf # Avoid division by zero\n                alpha_v_T = (rho_mix - rho_l_T) / (rho_v_T - rho_l_T)\n                \n                # Check for physical consistency\n                if not (0  alpha_v_T  1): return np.inf \n\n                Y_v_T = alpha_v_T * rho_v_T / rho_mix\n                \n                h_mix_T = (1 - Y_v_T) * h_l(T, C) + Y_v_T * h_v(T, C)\n                return h_mix_T - h0\n\n            # Solve for equilibrium temperature T_eq\n            try:\n                # Bracket [T_triple_point, T0]\n                T_eq = optimize.brentq(residual, 273.16, T0, xtol=1e-8, rtol=1e-8)\n            except ValueError:\n                # This may happen if the residual does not change sign in the bracket,\n                # indicating the model assumptions or inputs might be at their limits.\n                # For this problem set, a solution is expected to exist.\n                return float('nan'), float('nan')\n\n            # Calculate properties at equilibrium\n            p_full = p_sat(T_eq, C)\n            rho_l_eq = rho_l(p_full, C)\n            rho_v_eq = rho_v(p_full, T_eq, C)\n            alpha_v_eq = (rho_mix - rho_l_eq) / (rho_v_eq - rho_l_eq)\n            alpha_l_eq = 1.0 - alpha_v_eq\n\n            cl2_eq = c_l_sq(p_full, rho_l_eq, C)\n            cv2_eq = c_v_sq(T_eq, C)\n\n            c_full_sq_inv = (alpha_l_eq / (rho_l_eq * cl2_eq)) + \\\n                            (alpha_v_eq / (rho_v_eq * cv2_eq))\n            c_full = np.sqrt(1 / (rho_mix * c_full_sq_inv))\n            \n        return p_full, c_full\n\n    # --- Main computation loop ---\n    \n    test_cases = [\n        (450.0, 100.0),\n        (450.0, 300.0),\n        (350.0, 900.0),\n        (300.0, 995.0),\n    ]\n\n    results = []\n    for T0, rho_mix in test_cases:\n        p_bar, c_bar = solve_barotropic(T0, rho_mix, C)\n        p_full, c_full = solve_full_thermo(T0, rho_mix, C)\n\n        delta_p = (p_bar - p_full) / p_full\n        delta_c = (c_bar - c_full) / c_full\n\n        results.append([delta_p, delta_c])\n\n    # Final print statement in the exact required format\n    # The format '[[dp1,dc1],[dp2,dc2],...]' avoids spaces after commas.\n    print(f\"[{','.join([f'[{r[0]},{r[1]}]' for r in results])}]\")\n\nsolve()\n\n```", "id": "3351412"}]}