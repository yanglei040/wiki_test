{"hands_on_practices": [{"introduction": "在多相流中，相间动量交换（曳力）可能非常强，导致松弛时间尺度非常小。这会在控制方程中引入数值“刚度”，使得标准显式时间步进格式不稳定，除非使用不切实际的极小时间步长。本练习将指导您开发一种半隐式（IMEX）格式，该格式对刚性项进行隐式处理，从而确保无条件稳定性并允许使用实际的时间步长。这是现代双流体模型求解器中的一项关键技术 [@problem_id:3336701]。", "problem": "考虑一个用于计算流体动力学 (CFD) 中相间动量交换的单单元、一维、双流体模型。两个不可混溶的相，即气相和液相，占据的体积分数分别为气相的 $\\alpha \\in (0,1)$ 和液相的 $1-\\alpha$。相密度为常数 $\\rho_{\\mathrm{g}}$ 和 $\\rho_{\\mathrm{l}}$（单位为 $\\mathrm{kg/m^3}$），相速度为 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$（单位为 $\\mathrm{m/s}$）。相间动量交换由一个形式为 $K(\\alpha)\\,(u_{\\mathrm{g}}-u_{\\mathrm{l}})$ 的封闭模型来建模，其中 $K(\\alpha)$ 的单位为 $\\mathrm{kg/(m^3\\,s)}$，并且是 $\\alpha$ 的非负函数。忽略所有其他的力和源项。令 $m_{\\mathrm{g}}=\\alpha\\,\\rho_{\\mathrm{g}}$ 和 $m_{\\mathrm{l}}=(1-\\alpha)\\,\\rho_{\\mathrm{l}}$ 表示单位体积的相质量。\n\n从各相的 Newton 第二定律和相动量守恒出发，构建一个在时间步长 $\\Delta t$ 上的一阶时间推进格式。该格式通过隐式-显式 (IMEX) 策略处理刚性的相间交换项：所有非刚性或缺失的项采用显式处理，而相间动量交换则通过半隐式方法处理，即采用保证非负性的线性化来计算阻力系数，并对速度差进行隐式处理。使用以下建模选择作为基本依据：\n- 单位体积的相动量方程为 $m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$ 和 $m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$，这源于 Newton 第二定律以及 Newton 第三定律中大小相等、方向相反的相间作用-反作用力对。\n- 半隐式线性化必须在已知状态下计算 $K(\\alpha)$，以确保 $K^\\star \\ge 0$，从而使得到的离散算子是正定的，并保持相关系数的正性。\n- 双流体能量一致性意味着相间功在内部交换，不产生或破坏总混合物动量，并且在 $K^\\star\\ge 0$ 的条件下，对于任何 $\\Delta t0$，单位体积的离散动能 $E=\\dfrac{1}{2}\\left(m_{\\mathrm{g}}\\,u_{\\mathrm{g}}^2+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}^2\\right)$ 必须非增。\n\n你的任务：\n1. 根据上述相动量平衡和 IMEX 设计，从已知的 $u_{\\mathrm{g}}^{n}$ 和 $u_{\\mathrm{l}}^{n}$ 推导出一个时间步长内速度 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 的耦合更新公式，使用 $K^\\star=K(\\alpha^n)$ 且 $\\alpha^n=\\alpha$。证明该格式守恒混合物动量 $m_{\\mathrm{g}}\\,u_{\\mathrm{g}}+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}$，并证明对于任何 $\\Delta t0$ 和任何非负的 $K^\\star$，单位体积的离散动能不增加。\n2. 实现推导出的更新，并为下面的每个测试用例计算 $u_{\\mathrm{g}}^{n+1}$、 $u_{\\mathrm{l}}^{n+1}$（单位为 $\\mathrm{m/s}$）和 $E^{n+1}$（单位为 $\\mathrm{J/m^3}$）。使用封闭模型 $K(\\alpha)=K_0\\,\\alpha\\,(1-\\alpha)$，其中 $K_0$ 的单位为 $\\mathrm{kg/(m^3\\,s)}$。\n3. 你的程序必须生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果是一个三元组 $\\left[u_{\\mathrm{g}}^{n+1},u_{\\mathrm{l}}^{n+1},E^{n+1}\\right]$。输出必须是这些三元组的逗号分隔列表，并用方括号括起来，例如 $\\left[\\left[u_{\\mathrm{g}}^{(1)},u_{\\mathrm{l}}^{(1)},E^{(1)}\\right],\\left[u_{\\mathrm{g}}^{(2)},u_{\\mathrm{l}}^{(2)},E^{(2)}\\right],\\dots\\right]$。\n4. 在输出中，将所有速度（单位 $\\mathrm{m/s}$）和所有能量（单位 $\\mathrm{J/m^3}$）表示为不带单位的普通十进制数。\n\n测试套件（所有量均采用一致的国际单位制单位）：\n- 测试 A（中等刚度，非对称质量）：$\\rho_{\\mathrm{g}}=5$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.2$, $u_{\\mathrm{g}}^{n}=2$, $u_{\\mathrm{l}}^{n}=0$, $K_0=1\\times 10^{5}$, $\\Delta t=1\\times 10^{-3}$。\n- 测试 B（刚性）：与测试 A 相同，但 $K_0=1\\times 10^{8}$。\n- 测试 C（无耦合）：与测试 A 相同，但 $K_0=0$。\n- 测试 D（接近纯气相组分，平衡刚度）：$\\rho_{\\mathrm{g}}=1$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.999$, $u_{\\mathrm{g}}^{n}=10$, $u_{\\mathrm{l}}^{n}=-1$, $K_0=1\\times 10^{6}$, $\\Delta t=1\\times 10^{-3}$。\n- 测试 E（极大时间步长与强耦合）：$\\rho_{\\mathrm{g}}=5$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.2$, $u_{\\mathrm{g}}^{n}=2$, $u_{\\mathrm{l}}^{n}=0$, $K_0=1\\times 10^{6}$, $\\Delta t=5\\times 10^{-1}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的结果三元组的逗号分隔列表，例如：$\\left[\\left[u_{\\mathrm{g}}^{(A)},u_{\\mathrm{l}}^{(A)},E^{(A)}\\right],\\left[u_{\\mathrm{g}}^{(B)},u_{\\mathrm{l}}^{(B)},E^{(B)}\\right],\\left[u_{\\mathrm{g}}^{(C)},u_{\\mathrm{l}}^{(C)},E^{(C)}\\right],\\left[u_{\\mathrm{g}}^{(D)},u_{\\mathrm{l}}^{(D)},E^{(D)}\\right],\\left[u_{\\mathrm{g}}^{(E)},u_{\\mathrm{l}}^{(E)},E^{(E)}\\right]\\right]$。", "solution": "问题经验证是自洽的、有科学依据且适定的。所有提供的数据都是一致的，并且足以推导出唯一解。\n\n### 步骤 1：提取已知条件\n- **相：**气相 (g) 和液相 (l)，不可混溶。\n- **体积分数：**气相 $\\alpha \\in (0,1)$，液相 $1-\\alpha$。\n- **密度：**恒定的相密度 $\\rho_{\\mathrm{g}}$ 和 $\\rho_{\\mathrm{l}}$ ($\\mathrm{kg/m^3}$)。\n- **速度：**相速度 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$ ($\\mathrm{m/s}$)。\n- **单位体积相质量：**$m_{\\mathrm{g}}=\\alpha\\,\\rho_{\\mathrm{g}}$， $m_{\\mathrm{l}}=(1-\\alpha)\\,\\rho_{\\mathrm{l}}$。\n- **相间动量交换项：**$K(\\alpha)\\,(u_{\\mathrm{g}}-u_{\\mathrm{l}})$，其中 $K(\\alpha)$ 的单位为 $\\mathrm{kg/(m^3\\,s)}$ 且为非负。\n- **相动量方程（单位体积）：**\n  - $m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$\n  - $m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$\n- **数值格式：**在 $\\Delta t$ 上的一阶时间推进。IMEX 策略，其中非刚性项是显式的（此处不存在），而刚性相间项是半隐式的。\n- **半隐式处理：**$K(\\alpha)$ 在已知状态 $n$ 处求值，即 $K^\\star=K(\\alpha^n)$。速度差 $u_{\\mathrm{g}}-u_{\\mathrm{l}}$ 在未来状态 $n+1$ 处求值。\n- **单位体积动能：**$E=\\dfrac{1}{2}\\left(m_{\\mathrm{g}}\\,u_{\\mathrm{g}}^2+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}^2\\right)$。\n- **阻力封闭模型：**$K(\\alpha)=K_0\\,\\alpha\\,(1-\\alpha)$。\n- **任务：**\n  1. 从 $(u_{\\mathrm{g}}^{n}, u_{\\mathrm{l}}^{n})$ 推导 $(u_{\\mathrm{g}}^{n+1}, u_{\\mathrm{l}}^{n+1})$ 的更新公式。\n  2. 证明混合物动量 $m_{\\mathrm{g}}\\,u_{\\mathrm{g}}+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}$ 守恒。\n  3. 证明对于任何 $\\Delta t0$ 和 $K^\\star\\ge 0$，动能 $E$ 非增。\n  4. 实现该格式并为给定的测试用例计算 $(u_{\\mathrm{g}}^{n+1}, u_{\\mathrm{l}}^{n+1}, E^{n+1})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**该问题基于应用于双流体模型的 Newton 第二和第三定律，这是多相流理论和 CFD 中的一种标准和基本方法。动量守恒、动能和相间阻力的概念是流体动力学的核心。IMEX 格式是处理刚性常微分方程 (ODE) 的一种成熟的数值技术。该问题在科学上是合理的。\n- **适定性：**该问题提供了一整套常微分方程、初始条件以及对数值离散化的明确指令。这种设置可以导出一个关于更新后速度的可解线性系统，从而确保存在唯一解。所要求的证明是分析数值格式稳定性和守恒性的标准步骤。该问题是适定的。\n- **客观性：**该问题使用精确的数学和物理术语进行陈述，没有歧义或主观论断。任务是具体且可量化的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 1. IMEX 格式的推导\n我们从给定的关于相速度 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$ 的常微分方程组开始：\n$$m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$$\n$$m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$$\n我们使用一阶格式在时间步长 $\\Delta t$ 上对这些方程进行时间离散化。令 $u^n$ 表示变量 $u$ 在时间 $t^n$ 的值，$u^{n+1}$ 表示在时间 $t^{n+1}=t^n+\\Delta t$ 的值。时间导数用向前差分近似，即 $\\frac{du}{dt} \\approx \\frac{u^{n+1}-u^n}{\\Delta t}$。\n\n遵循 IMEX 策略，非刚性项（在本例中不存在）进行显式处理，而刚性的相间动量交换项则进行半隐式处理。这意味着阻力系数 $K(\\alpha)$ 在已知时间层 $n$ 求值，记为 $K^\\star=K(\\alpha^n)$，而速度差在未知时间层 $n+1$ 求值。离散化后的方程为：\n$$m_{\\mathrm{g}}\\,\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t}=-K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right)$$\n$$m_{\\mathrm{l}}\\,\\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t}=+K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right)$$\n这是关于未知速度 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 的两个耦合线性方程。我们将其重排，把未知项归到左侧：\n$$m_{\\mathrm{g}}\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}\\right) + \\Delta t K^\\star\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n$$m_{\\mathrm{l}}\\left(u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}\\right) - \\Delta t K^\\star\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\nm_{\\mathrm{g}} + \\Delta t K^\\star   -\\Delta t K^\\star \\\\\n-\\Delta t K^\\star   m_{\\mathrm{l}} + \\Delta t K^\\star\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{\\mathrm{g}}^{n+1} \\\\\nu_{\\mathrm{l}}^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nm_{\\mathrm{g}} u_{\\mathrm{g}}^{n} \\\\\nm_{\\mathrm{l}} u_{\\mathrm{l}}^{n}\n\\end{pmatrix}\n$$\n为求解这个 $2 \\times 2$ 系统，我们可以求矩阵的逆。系数矩阵的行列式为：\n$$\\det(A) = (m_{\\mathrm{g}} + \\Delta t K^\\star)(m_{\\mathrm{l}} + \\Delta t K^\\star) - (-\\Delta t K^\\star)^2 = m_{\\mathrm{g}}m_{\\mathrm{l}} + m_{\\mathrm{g}}\\Delta t K^\\star + m_{\\mathrm{l}}\\Delta t K^\\star + (\\Delta t K^\\star)^2 - (\\Delta t K^\\star)^2$$\n$$\\det(A) = m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})$$\n由于 $m_{\\mathrm{g}}, m_{\\mathrm{l}}  0$，$\\Delta t  0$ 且 $K^\\star \\ge 0$，行列式严格为正，确保了唯一解的存在。应用逆矩阵可得到更新后速度的显式表达式：\n$$\n\\begin{pmatrix}\nu_{\\mathrm{g}}^{n+1} \\\\\nu_{\\mathrm{l}}^{n+1}\n\\end{pmatrix}\n=\n\\frac{1}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}\n\\begin{pmatrix}\nm_{\\mathrm{l}} + \\Delta t K^\\star   \\Delta t K^\\star \\\\\n\\Delta t K^\\star   m_{\\mathrm{g}} + \\Delta t K^\\star\n\\end{pmatrix}\n\\begin{pmatrix}\nm_{\\mathrm{g}} u_{\\mathrm{g}}^{n} \\\\\nm_{\\mathrm{l}} u_{\\mathrm{l}}^{n}\n\\end{pmatrix}\n$$\n展开上式，得到最终的更新公式：\n$$u_{\\mathrm{g}}^{n+1} = \\frac{(m_{\\mathrm{l}} + \\Delta t K^\\star)m_{\\mathrm{g}} u_{\\mathrm{g}}^{n} + (\\Delta t K^\\star)m_{\\mathrm{l}} u_{\\mathrm{l}}^{n}}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}$$\n$$u_{\\mathrm{l}}^{n+1} = \\frac{(\\Delta t K^\\star)m_{\\mathrm{g}} u_{\\mathrm{g}}^{n} + (m_{\\mathrm{g}} + \\Delta t K^\\star)m_{\\mathrm{l}} u_{\\mathrm{l}}^{n}}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}$$\n\n### 2. 动量守恒的证明\n为证明总混合物动量守恒，我们将两个离散化的动量方程相加：\n$$m_{\\mathrm{g}}\\,\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t} + m_{\\mathrm{l}}\\,\\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t} = -K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) + K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n两边乘以 $\\Delta t$ 得：\n$$m_{\\mathrm{g}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}) + m_{\\mathrm{l}}(u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}) = 0$$\n重新整理各项，我们得到：\n$$m_{\\mathrm{g}}u_{\\mathrm{g}}^{n+1} + m_{\\mathrm{l}}u_{\\mathrm{l}}^{n+1} = m_{\\mathrm{g}}u_{\\mathrm{g}}^{n} + m_{\\mathrm{l}}u_{\\mathrm{l}}^{n}$$\n此等式表明，在时间 $t^{n+1}$ 的单位体积混合物动量与在时间 $t^n$ 时相同。因此，该格式对于混合物动量是守恒的。\n\n### 3. 能量稳定性证明（动能非增）\n单位体积混合物的总动能由 $E = \\frac{1}{2}(m_{\\mathrm{g}}u_{\\mathrm{g}}^2 + m_{\\mathrm{l}}u_{\\mathrm{l}}^2)$ 给出。我们可以将此能量分解为两部分：质心运动的动能和两相之间相对运动的动能。\n令 $M_{tot} = m_{\\mathrm{g}}+m_{\\mathrm{l}}$ 为单位体积的总质量，$u_c = \\frac{m_{\\mathrm{g}}u_{\\mathrm{g}}+m_{\\mathrm{l}}u_{\\mathrm{l}}}{M_{tot}}$ 为质心速度。总动量为 $M_{tot}u_c$。如上所示，混合物动量守恒，因此 $u_c^{n+1}=u_c^{n}$。\n动能可以表示为：\n$$E = \\frac{1}{2}M_{tot}u_c^2 + \\frac{1}{2}\\mu(\\Delta u)^2$$\n其中 $\\mu = \\frac{m_{\\mathrm{g}}m_{\\mathrm{l}}}{m_{\\mathrm{g}}+m_{\\mathrm{l}}}$ 是单位体积的折合质量，$\\Delta u = u_{\\mathrm{g}}-u_{\\mathrm{l}}$ 是相对速度。\n从 $t^n$ 到 $t^{n+1}$ 的动能变化为：\n$$\\Delta E = E^{n+1} - E^n = \\left(\\frac{1}{2}M_{tot}(u_c^{n+1})^2 + \\frac{1}{2}\\mu(\\Delta u^{n+1})^2\\right) - \\left(\\frac{1}{2}M_{tot}(u_c^{n})^2 + \\frac{1}{2}\\mu(\\Delta u^{n})^2\\right)$$\n由于 $u_c^{n+1}=u_c^{n}$，上式简化为：\n$$\\Delta E = \\frac{1}{2}\\mu\\left((\\Delta u^{n+1})^2 - (\\Delta u^{n})^2\\right)$$\n为计算此值，我们推导相对速度 $\\Delta u$ 的更新方程。我们将第一个离散动量方程除以 $m_{\\mathrm{g}}$，第二个除以 $m_{\\mathrm{l}}$，然后用第一个减去第二个：\n$$\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t} - \\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t} = -\\frac{K^\\star}{m_{\\mathrm{g}}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}) - \\frac{K^\\star}{m_{\\mathrm{l}}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})$$\n$$\\frac{(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})-(u_{\\mathrm{g}}^{n}-u_{\\mathrm{l}}^{n})}{\\Delta t} = -K^\\star\\left(\\frac{1}{m_{\\mathrm{g}}}+\\frac{1}{m_{\\mathrm{l}}}\\right)(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})$$\n使用 $\\Delta u^k = u_{\\mathrm{g}}^{k}-u_{\\mathrm{l}}^{k}$：\n$$\\frac{\\Delta u^{n+1}-\\Delta u^{n}}{\\Delta t} = -K^\\star\\left(\\frac{m_{\\mathrm{g}}+m_{\\mathrm{l}}}{m_{\\mathrm{g}}m_{\\mathrm{l}}}\\right)\\Delta u^{n+1}$$\n$$\\Delta u^{n+1} \\left(1 + \\Delta t K^\\star \\frac{m_{\\mathrm{g}}+m_{\\mathrm{l}}}{m_{\\mathrm{g}}m_{\\mathrm{l}}}\\right) = \\Delta u^n$$\n$$\\Delta u^{n+1} = \\frac{\\Delta u^n}{1 + \\frac{\\Delta t K^\\star}{\\mu}}$$\n令 $\\gamma = \\left(1 + \\frac{\\Delta t K^\\star}{\\mu}\\right)^{-1}$。由于 $\\Delta t  0$，$K^\\star \\ge 0$ 且 $\\mu  0$，我们有 $0  \\le \\gamma \\le 1$。具体来说，如果 $K^\\star=0$，则 $\\gamma=1$；当 $\\Delta t K^\\star \\to \\infty$ 时，$\\gamma \\to 0$。\n现在将 $\\Delta u^{n+1} = \\gamma \\Delta u^n$ 代入 $\\Delta E$ 的表达式中：\n$$\\Delta E = \\frac{1}{2}\\mu\\left((\\gamma \\Delta u^{n})^2 - (\\Delta u^{n})^2\\right) = \\frac{1}{2}\\mu(\\Delta u^{n})^2(\\gamma^2-1)$$\n由于 $0 \\le \\gamma \\le 1$，我们有 $\\gamma^2-1 \\le 0$。同时，$\\mu  0$ 且 $(\\Delta u^n)^2 \\ge 0$。因此，对于任何 $\\Delta t  0$ 和 $K^\\star \\ge 0$，都有 $\\Delta E \\le 0$。这证明了离散动能是非增的，从而保证了格式的数值稳定性。能量仅通过相间阻力耗散，这在物理上是正确的。\n\n### 4. 实现细节\nPython 实现将定义一个函数，该函数接收单个测试用例的物理参数作为输入。在该函数内部：\n1.  它计算单位体积的相质量 $m_{\\mathrm{g}}$ 和 $m_{\\mathrm{l}}$。\n2.  它计算半隐式阻力系数 $K^\\star = K_0 \\alpha (1-\\alpha)$。\n3.  它实现推导出的 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 的显式公式。可以处理 $K_0=0$（因此 $K^\\star=0$）的特殊情况，此时速度保持不变，不过通用公式是稳健的，并且能正确处理这种情况。\n4.  它计算新的动能 $E^{n+1} = \\frac{1}{2}(m_{\\mathrm{g}}(u_{\\mathrm{g}}^{n+1})^2 + m_{\\mathrm{l}}(u_{\\mathrm{l}}^{n+1})^2)$。\n5.  脚本的主体部分将遍历提供的测试套件，为每个用例调用计算函数，并收集结果。\n6.  最后，它将把收集到的结果格式化为指定的字符串格式 `[[...],[...],...]` 并打印到标准输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the two-fluid model problem for all test cases.\n    \"\"\"\n\n    # Test suite (all quantities in coherent SI units):\n    # (rho_g, rho_l, alpha, u_g_n, u_l_n, K0, dt)\n    test_cases = [\n        # Test A: moderate stiffness, asymmetric masses\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e5, 1.0e-3),\n        # Test B: stiff\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e8, 1.0e-3),\n        # Test C: no coupling\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 0.0, 1.0e-3),\n        # Test D: near-pure gas fraction, balanced stiffness\n        (1.0, 1000.0, 0.999, 10.0, -1.0, 1.0e6, 1.0e-3),\n        # Test E: very large time step with strong coupling\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e6, 5.0e-1)\n    ]\n\n    results = []\n    for case in test_cases:\n        result_triple = calculate_update(*case)\n        results.append(list(result_triple))\n\n    # Format the final output as a comma-separated list of triples\n    # enclosed in square brackets. Example: [[a,b,c],[d,e,f]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef calculate_update(rho_g, rho_l, alpha, u_g_n, u_l_n, K0, dt):\n    \"\"\"\n    Calculates the updated velocities and kinetic energy for a single time step.\n\n    Parameters:\n    rho_g (float): Gas density [kg/m^3]\n    rho_l (float): Liquid density [kg/m^3]\n    alpha (float): Gas volume fraction\n    u_g_n (float): Gas velocity at time n [m/s]\n    u_l_n (float): Liquid velocity at time n [m/s]\n    K0 (float): Drag coefficient constant [kg/(m^3 s)]\n    dt (float): Time step size [s]\n\n    Returns:\n    tuple: (u_g_n1, u_l_n1, E_n1)\n           u_g_n1: Gas velocity at time n+1 [m/s]\n           u_l_n1: Liquid velocity at time n+1 [m/s]\n           E_n1: Kinetic energy at time n+1 [J/m^3]\n    \"\"\"\n\n    # Calculate phase masses per unit volume\n    m_g = alpha * rho_g\n    m_l = (1.0 - alpha) * rho_l\n\n    # Calculate semi-implicit drag parameter\n    K_star = K0 * alpha * (1.0 - alpha)\n\n    # If there is no coupling, velocities do not change.\n    # This check avoids potential division by zero if m_g or m_l were zero,\n    # though the problem constraints ensure they are positive. The general\n    # formula below is also valid for K_star = 0.\n    if K_star == 0.0:\n        u_g_n1 = u_g_n\n        u_l_n1 = u_l_n\n    else:\n        # Denominator of the update formula\n        denominator = m_g * m_l + dt * K_star * (m_g + m_l)\n\n        # Numerator for u_g_n1\n        num_g = (m_l + dt * K_star) * m_g * u_g_n + (dt * K_star) * m_l * u_l_n\n\n        # Numerator for u_l_n1\n        num_l = (dt * K_star) * m_g * u_g_n + (m_g + dt * K_star) * m_l * u_l_n\n\n        # Updated velocities\n        u_g_n1 = num_g / denominator\n        u_l_n1 = num_l / denominator\n\n    # Calculate the new kinetic energy per unit volume\n    E_n1 = 0.5 * (m_g * u_g_n1**2 + m_l * u_l_n1**2)\n\n    return u_g_n1, u_l_n1, E_n1\n\n# Run the solver\nsolve()\n```", "id": "3336701"}, {"introduction": "相间传递闭合模型本质上是经验性的，依赖于必须根据实验数据进行校准的参数。本练习超越了简单的曲线拟合，引入了贝叶斯推断作为参数估计和不确定性量化的严谨框架。通过这个例子，您将学习如何将先验知识与实验数据相结合，以获得对闭合参数的概率性理解，并将该不确定性传播到模型预测中。这是开发预测性数字孪生的一项关键技能 [@problem_id:3336723]。", "problem": "考虑一个一维、稳态、等温的双流体混合物，其中分散的气泡与周围液体交换动量和组分。使用第一性原理建立一个简化的基于封闭关系的正向模型，然后在给定有限数据的情况下进行贝叶斯推断以校准相间封闭关系并量化不确定性，最后将此不确定性传播到新工况下的双流体预测中。所有对数均为自然对数。\n\n从基本定律和核心定义开始：\n- 牛顿第二定律意味着体积相间动量源密度等于相间的类似曳力的耦合；在标准封闭关系下，将标量相间动量源写作 $S_m = K\\,\\lvert u_g - u_\\ell \\rvert$，其中 $K$ 是一个未知的动量交换系数。量 $S_m$ 的单位是 $\\mathrm{N\\,m^{-3}}$，$\\lvert u_g - u_\\ell \\rvert$ 的单位是 $\\mathrm{m\\,s^{-1}}$。\n- 带有界面传递封闭关系的组分守恒意味着体积相间组分传递速率为 $N = k_L\\,a_i\\,\\Delta C$，其中 $k_L$ 是未知的液侧传质系数，$a_i$ 是未知的界面面积密度，$\\Delta C$ 是浓度驱动力。量 $N$ 的单位是 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$，$k_L$ 的单位是 $\\mathrm{m\\,s^{-1}}$，$a_i$ 的单位是 $\\mathrm{m^{-1}}$，$\\Delta C$ 的单位是 $\\mathrm{kg\\,m^{-3}}$。\n\n假设在已知的工况点上，可以获得有限的 $S_m$ 和 $N$ 的实验测量值。为了在保持非负性和乘法结构的同时实现线性高斯贝叶斯推断，将测量噪声建模为对数空间中的加性高斯噪声。具体来说，定义参数向量 $\\boldsymbol{\\xi} = \\begin{bmatrix} \\log K \\\\ \\log k_L \\\\ \\log a_i \\end{bmatrix}$，并使用对数转换后的正向封闭关系构建 $\\boldsymbol{\\xi}$ 的线性观测方程：\n- 对于动量数据点 $i$：$\\log S_{m,i} = \\log K + \\log \\lvert u_{\\mathrm{rel},i} \\rvert + \\varepsilon_i$，即 $\\underbrace{\\left(\\log S_{m,i} - \\log \\lvert u_{\\mathrm{rel},i} \\rvert\\right)}_{y_i} = \\begin{bmatrix}100\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_i$。\n- 对于传质数据点 $j$：$\\log N_j = \\log k_L + \\log a_i + \\log \\Delta C_j + \\varepsilon_j$，即 $\\underbrace{\\left(\\log N_j - \\log \\Delta C_j\\right)}_{y_j} = \\begin{bmatrix}011\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_j$。\n假设噪声 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的，且标准差 $\\sigma$ 已知。\n\n对 $\\boldsymbol{\\xi}$ 采用高斯先验，其均值为 $\\boldsymbol{\\mu}_0$，协方差为 $\\mathbf{\\Sigma}_0$，且各分量之间独立。\n\n在这些基础上，进行贝叶斯推断，计算给定实验数据下 $\\boldsymbol{\\xi}$ 的高斯后验 $\\mathcal{N}(\\boldsymbol{\\mu},\\mathbf{\\Sigma})$。然后，通过注意到 $S_m = \\lvert u_{\\mathrm{rel}} \\rvert \\exp(\\xi_1)$ 和 $N = \\Delta C \\exp(\\xi_2+\\xi_3)$（在高斯后验下它们是对数正态的），将后验不确定性传播到新工况 $(\\lvert u_{\\mathrm{rel}} \\rvert,\\Delta C)$ 下 $S_m$ 和 $N$ 的预测分布中。报告预测均值和标准差。\n\n使用以下数据和超参数（所有数字均为明确给出；所有对数均为自然对数）：\n- 对数空间中的先验均值和协方差：\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} \\log(1000.0) \\\\ \\log(1.0\\times 10^{-4}) \\\\ \\log(150.0) \\end{bmatrix}$，\n  - $\\mathbf{\\Sigma}_0 = \\mathrm{diag}\\left([1.0^2,\\,1.0^2,\\,1.0^2]\\right)$。\n- 对数空间中的似然噪声标准差：$\\sigma = 0.1$。\n- 动量数据（每对数据为 $\\lvert u_{\\mathrm{rel}} \\rvert$（单位 $\\mathrm{m\\,s^{-1}}$），$S_m$（单位 $\\mathrm{N\\,m^{-3}}$））：\n  - $(0.05,\\,40.0)$，\n  - $(0.10,\\,80.0)$，\n  - $(0.20,\\,160.0)$。\n- 传质数据（每对数据为 $\\Delta C$（单位 $\\mathrm{kg\\,m^{-3}}$），$N$（单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$））：\n  - $(0.5,\\,0.02)$，\n  - $(1.0,\\,0.04)$，\n  - $(0.2,\\,0.008)$。\n\n为以下工况测试集生成后验预测摘要（每对数据为 $(\\lvert u_{\\mathrm{rel}} \\rvert,\\Delta C)$）：\n- 情况 1：$(0.12,\\,0.6)$，\n- 情况 2：$(0.0,\\,0.6)$，\n- 情况 3：$(0.08,\\,0.01)$。\n\n对于每种情况，计算并返回：\n- $S_m$ 的预测均值，单位 $\\mathrm{N\\,m^{-3}}$，\n- $S_m$ 的预测标准差，单位 $\\mathrm{N\\,m^{-3}}$，\n- $N$ 的预测均值，单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$，\n- $N$ 的预测标准差，单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。\n\n所有输出均使用上述指定的物理单位。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[结果1,结果2,结果3]$）。请使用确切的顺序：\n$[$$S_{m,\\mathrm{mean}}^{(1)}$, $S_{m,\\mathrm{std}}^{(1)}$, $N_{\\mathrm{mean}}^{(1)}$, $N_{\\mathrm{std}}^{(1)}$, $S_{m,\\mathrm{mean}}^{(2)}$, $S_{m,\\mathrm{std}}^{(2)}$, $N_{\\mathrm{mean}}^{(2)}$, $N_{\\mathrm{std}}^{(2)}$, $S_{m,\\mathrm{mean}}^{(3)}$, $S_{m,\\mathrm{std}}^{(3)}$, $N_{\\mathrm{mean}}^{(3)}$, $N_{\\mathrm{std}}^{(3)}$$]$。\n\n所有数值答案必须以指定单位的浮点数值返回。此问题不涉及角度或百分比。", "solution": "用户提供了一个问题，要求使用贝叶斯推断来校准计算流体动力学（CFD）封闭模型中的参数，然后将所得的不确定性传播到新的预测中。我将首先验证问题陈述，然后提供一个完整的解决方案。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- **参数向量**: $\\boldsymbol{\\xi} = \\begin{bmatrix} \\log K \\\\ \\log k_L \\\\ \\log a_i \\end{bmatrix}$\n- **观测模型**: \n  - 动量: $y_{m,i} = \\log S_{m,i} - \\log \\lvert u_{\\mathrm{rel},i} \\rvert = \\begin{bmatrix}100\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_i$\n  - 传质: $y_{N,j} = \\log N_j - \\log \\Delta C_j = \\begin{bmatrix}011\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_j$\n- **噪声模型**: $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$，其中 $\\sigma = 0.1$。\n- **先验分布**: $\\boldsymbol{\\xi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0)$\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} \\log(1000.0) \\\\ \\log(1.0\\times 10^{-4}) \\\\ \\log(150.0) \\end{bmatrix}$\n  - $\\mathbf{\\Sigma}_0 = \\mathrm{diag}\\left([1.0^2,\\,1.0^2,\\,1.0^2]\\right) = \\mathbf{I}_3$\n- **动量数据** $(\\lvert u_{\\mathrm{rel}} \\rvert, S_m)$: $(0.05, 40.0)$, $(0.10, 80.0)$, $(0.20, 160.0)$。\n- **传质数据** $(\\Delta C, N)$: $(0.5, 0.02)$, $(1.0, 0.04)$, $(0.2, 0.008)$。\n- **预测测试用例** $(\\lvert u_{\\mathrm{rel}} \\rvert, \\Delta C)$: $(0.12, 0.6)$, $(0.0, 0.6)$, $(0.08, 0.01)$。\n- **要求输出**: 每个测试用例中 $S_m$ 和 $N$ 的预测均值和标准差。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n该问题具有科学依据，使用了多相流的标准（尽管是简化的）封闭模型和典型的贝叶斯线性回归框架。目标明确，语言精确。所有必要的数据和超参数都已提供，使得问题自洽且适定。预测阶段中 $\\lvert u_{\\mathrm{rel}} \\rvert = 0$ 的特殊情况并未使问题无效；它需要通过回归到基本物理模型 $S_m = K \\lvert u_{\\mathrm{rel}} \\rvert$ 来谨慎处理，该模型确定性地得出 $S_m=0$。这是物理学的特性，而非问题描述中的缺陷。该问题与指定的相间传递封闭关系主题相关。未发现任何缺陷。\n\n**第 3 步：结论与行动**\n\n问题有效。将提供完整解答。\n\n### 解题推导\n\n该问题是一个标准的贝叶斯线性回归问题。目标是在给定先验分布和一组观测值的情况下，求出参数向量 $\\boldsymbol{\\xi}$ 的后验分布。\n\n**1. 贝叶斯线性回归框架**\n\n标准的贝叶斯线性模型定义如下：\n- 先验: $\\boldsymbol{\\xi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0)$\n- 似然: $\\mathbf{y} = \\mathbf{H}\\boldsymbol{\\xi} + \\boldsymbol{\\varepsilon}$，其中噪声 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$。\n\n在给定观测向量 $\\mathbf{y}$ 的情况下，$\\boldsymbol{\\xi}$ 的后验分布也是高斯分布 $\\boldsymbol{\\xi}|\\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$，其后验协方差 $\\mathbf{\\Sigma}$ 和后验均值 $\\boldsymbol{\\mu}$ 由下式给出：\n$$ \\mathbf{\\Sigma} = \\left(\\mathbf{\\Sigma}_0^{-1} + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}\\right)^{-1} $$\n$$ \\boldsymbol{\\mu} = \\mathbf{\\Sigma} \\left( \\mathbf{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0 + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y} \\right) $$\n\n**2. 组装模型组件**\n\n- **参数向量**: $\\boldsymbol{\\xi}$ 是一个 $3 \\times 1$ 向量。\n- **先验**: $\\boldsymbol{\\mu}_0$ 已给出，且 $\\mathbf{\\Sigma}_0 = \\mathbf{I}_3$，因此 $\\mathbf{\\Sigma}_0^{-1} = \\mathbf{I}_3$。\n- **观测向量 $\\mathbf{y}$**: 我们有 3 个动量数据点和 3 个传质数据点，总共 $M=6$ 个观测值。\n  - 从动量数据看，$S_{m,i} / \\lvert u_{\\mathrm{rel},i} \\rvert = 40.0/0.05 = 80.0/0.10 = 160.0/0.20 = 800$。\n    $\\mathbf{y}$ 的前三个元素是 $y_i = \\log(800)$，对于 $i=1, 2, 3$。\n  - 从传质数据看，$N_j / \\Delta C_j = 0.02/0.5 = 0.04/1.0 = 0.008/0.2 = 0.04$。\n    $\\mathbf{y}$ 的后三个元素是 $y_j = \\log(0.04)$，对于 $j=4, 5, 6$。\n- **观测矩阵 $\\mathbf{H}$**: 这是一个 $6 \\times 3$ 的矩阵，由观测方程的行向量堆叠而成：\n  $$ \\mathbf{H} = \\begin{bmatrix} 1  0  0 \\\\ 1  0  0 \\\\ 1  0  0 \\\\ 0  1  1 \\\\ 0  1  1 \\\\ 0  1  1 \\end{bmatrix} $$\n- **噪声协方差 $\\mathbf{R}$**: 噪声是独立同分布的，因此 $\\mathbf{R} = \\sigma^2 \\mathbf{I}_6$，其中 $\\sigma=0.1$。所以 $\\mathbf{R}^{-1} = \\frac{1}{\\sigma^2} \\mathbf{I}_6 = 100 \\cdot \\mathbf{I}_6$。\n\n**3. 计算后验分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$**\n\n首先，计算项 $\\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}$：\n$$ \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H} = \\frac{1}{\\sigma^2} \\mathbf{H}^T \\mathbf{H} = 100 \\begin{bmatrix} 3  0  0 \\\\ 0  3  3 \\\\ 0  3  3 \\end{bmatrix} = \\begin{bmatrix} 300  0  0 \\\\ 0  300  300 \\\\ 0  300  300 \\end{bmatrix} $$\n接下来，求后验精度矩阵 $\\mathbf{\\Sigma}^{-1}$：\n$$ \\mathbf{\\Sigma}^{-1} = \\mathbf{\\Sigma}_0^{-1} + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} + \\begin{bmatrix} 300  0  0 \\\\ 0  300  300 \\\\ 0  300  300 \\end{bmatrix} = \\begin{bmatrix} 301  0  0 \\\\ 0  301  300 \\\\ 0  300  301 \\end{bmatrix} $$\n对该矩阵求逆，得到后验协方差 $\\mathbf{\\Sigma}$：\n$$ \\mathbf{\\Sigma} = (\\mathbf{\\Sigma}^{-1})^{-1} = \\begin{bmatrix} 1/301  0  0 \\\\ 0  301/601  -300/601 \\\\ 0  -300/601  301/601 \\end{bmatrix} $$\n现在，计算项 $\\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y}$：\n$$ \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y} = \\frac{1}{\\sigma^2} \\mathbf{H}^T \\mathbf{y} = 100 \\begin{bmatrix} 3\\log(800) \\\\ 3\\log(0.04) \\\\ 3\\log(0.04) \\end{bmatrix} = \\begin{bmatrix} 300\\log(800) \\\\ 300\\log(0.04) \\\\ 300\\log(0.04) \\end{bmatrix} $$\n最后，计算后验均值 $\\boldsymbol{\\mu}$：\n$$ \\boldsymbol{\\mu} = \\mathbf{\\Sigma} (\\mathbf{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0 + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y}) = \\mathbf{\\Sigma} \\left( \\boldsymbol{\\mu}_0 + \\begin{bmatrix} 300\\log(800) \\\\ 300\\log(0.04) \\\\ 300\\log(0.04) \\end{bmatrix} \\right) $$\n将 $\\boldsymbol{\\mu}_0$、$\\mathbf{\\Sigma}$ 和对数值的数值代入，即可得到后验均值向量 $\\boldsymbol{\\mu} = [\\mu_1, \\mu_2, \\mu_3]^T$。\n\n**4. 不确定性传播到预测**\n\n我们感兴趣的量 $S_m$ 和 $N$ 与指数化后的参数相关。如果一个随机变量 $X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$，那么 $Y = C e^X$ 服从一个尺度化的对数正态分布。其均值和标准差为：\n$$ E[Y] = C \\exp(\\mu_X + \\sigma_X^2/2) $$\n$$ \\mathrm{StdDev}[Y] = C \\sqrt{\\exp(\\sigma_X^2) - 1} \\exp(\\mu_X + \\sigma_X^2/2) $$\n\n- **动量预测 ($S_m$)**: 对于新的工况 $u_{\\mathrm{rel}}^*$，预测值为 $S_m^* = u_{\\mathrm{rel}}^* \\exp(\\xi_1)$。由于 $\\xi_1 \\sim \\mathcal{N}(\\mu_1, \\Sigma_{11})$，我们可以使用上述公式，其中 $C=u_{\\mathrm{rel}}^*$，$\\mu_X=\\mu_1$，$\\sigma_X^2=\\Sigma_{11}$。\n对于 $u_{\\mathrm{rel}}^*=0$ 的特殊情况，物理模型 $S_m = K u_{\\mathrm{rel}}^*$ 决定了 $S_m^*=0$ 是确定性的。均值和标准差均为 0。\n\n- **传质预测 ($N$)**: 对于新的工况 $\\Delta C^*$，预测值为 $N^* = \\Delta C^* \\exp(\\xi_2 + \\xi_3)$。我们定义一个新的高斯变量 $\\eta = \\xi_2 + \\xi_3 = \\mathbf{c}^T \\boldsymbol{\\xi}$，其中 $\\mathbf{c}=[0, 1, 1]^T$。\n  - $\\eta$ 的均值为 $\\mu_\\eta = \\mathbf{c}^T \\boldsymbol{\\mu} = \\mu_2 + \\mu_3$。\n  - $\\eta$ 的方差为 $\\sigma_\\eta^2 = \\mathbf{c}^T \\mathbf{\\Sigma} \\mathbf{c} = \\Sigma_{22} + \\Sigma_{33} + 2\\Sigma_{23}$。\n代入 $\\mathbf{\\Sigma}$ 中的值：\n$$ \\sigma_\\eta^2 = \\frac{301}{601} + \\frac{301}{601} + 2\\left(\\frac{-300}{601}\\right) = \\frac{602 - 600}{601} = \\frac{2}{601} $$\n然后我们可以使用对数正态公式，其中 $C=\\Delta C^*$，$\\mu_X=\\mu_\\eta$，$\\sigma_X^2=\\sigma_\\eta^2$。\n\n最后一步是针对三个指定的测试用例，用数值方法实现这些公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Bayesian inference to calibrate CFD closure models and propagates\n    uncertainty to new predictions.\n    \"\"\"\n\n    # 1. Define Givens from the problem statement\n    \n    # Prior distribution parameters for xi = [log(K), log(k_L), log(a_i)]\n    mu_0 = np.array([\n        np.log(1000.0),\n        np.log(1.0e-4),\n        np.log(150.0)\n    ])\n    Sigma_0 = np.diag([1.0**2, 1.0**2, 1.0**2])\n\n    # Likelihood noise standard deviation\n    sigma = 0.1\n    noise_var = sigma**2\n\n    # Experimental data\n    mom_data = [\n        (0.05, 40.0),\n        (0.10, 80.0),\n        (0.20, 160.0)\n    ]\n    mass_data = [\n        (0.5, 0.02),\n        (1.0, 0.04),\n        (0.2, 0.008)\n    ]\n\n    # Test cases for prediction\n    test_cases = [\n        (0.12, 0.6),  # Case 1\n        (0.0, 0.6),   # Case 2\n        (0.08, 0.01)  # Case 3\n    ]\n\n    # 2. Construct Bayesian Linear Regression Model Components\n\n    # Observation vector y\n    y_mom = [np.log(sm) - np.log(urel) for urel, sm in mom_data]\n    y_mass = [np.log(n) - np.log(dc) for dc, n in mass_data]\n    y = np.array(y_mom + y_mass)\n\n    # Observation matrix H\n    H = np.array([\n        [1, 0, 0], [1, 0, 0], [1, 0, 0],  # Momentum observations\n        [0, 1, 1], [0, 1, 1], [0, 1, 1]   # Mass transfer observations\n    ])\n\n    # Noise covariance R and its inverse\n    num_obs = len(y)\n    R_inv = np.identity(num_obs) / noise_var\n    \n    Sigma_0_inv = np.linalg.inv(Sigma_0)\n\n    # 3. Compute Posterior Distribution N(mu, Sigma)\n\n    # Posterior covariance Sigma\n    Sigma_inv = Sigma_0_inv + H.T @ R_inv @ H\n    Sigma = np.linalg.inv(Sigma_inv)\n\n    # Posterior mean mu\n    mu = Sigma @ (Sigma_0_inv @ mu_0 + H.T @ R_inv @ y)\n    \n    # 4. Propagate Uncertainty and Compute Predictive Statistics\n\n    results = []\n    \n    # Lognormal distribution properties\n    def lognormal_stats(C, mu_p, var_p):\n        \"\"\"Calculates mean and std dev for a scaled lognormal distribution.\"\"\"\n        if C == 0:\n            return 0.0, 0.0\n        \n        # Mean: C * exp(mu_p + var_p/2)\n        mean_val = C * np.exp(mu_p + var_p / 2.0)\n        \n        # Standard deviation: sqrt(exp(var_p) - 1) * Mean\n        # This is more numerically stable than the full formula for small var_p\n        # np.expm1(x) calculates exp(x) - 1\n        std_dev = np.sqrt(np.expm1(var_p)) * mean_val\n        \n        return mean_val, std_dev\n\n    for case in test_cases:\n        urel_star, delta_c_star = case\n\n        # --- Momentum Prediction (S_m) ---\n        # Special case: u_rel = 0 implies S_m = 0 deterministically\n        if urel_star == 0.0:\n            sm_mean, sm_std = 0.0, 0.0\n        else:\n            mu_p_sm = mu[0]\n            var_p_sm = Sigma[0, 0]\n            sm_mean, sm_std = lognormal_stats(urel_star, mu_p_sm, var_p_sm)\n        \n        # --- Mass Transfer Prediction (N) ---\n        # For N = dC * exp(xi_2 + xi_3), we need stats for eta = xi_2 + xi_3\n        # eta = c^T * xi, with c = [0, 1, 1]\n        c = np.array([0, 1, 1])\n        mu_p_n = c.T @ mu\n        var_p_n = c.T @ Sigma @ c\n        \n        n_mean, n_std = lognormal_stats(delta_c_star, mu_p_n, var_p_n)\n\n        results.extend([sm_mean, sm_std, n_mean, n_std])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3336723"}]}