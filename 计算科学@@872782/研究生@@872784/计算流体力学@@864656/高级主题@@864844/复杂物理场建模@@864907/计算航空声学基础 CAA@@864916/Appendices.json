{"hands_on_practices": [{"introduction": "高保真度的气动声学仿真要求数值格式能够在长距离传播声波时保持极低的误差。本练习将深入探讨计算气动声学（CAA）的核心，通过分析一种高阶有限差分与时间积分组合格式的性能。通过量化数值色散（相位误差）和数值耗散（振幅误差），您将对如何选择和验证适用于波传播问题的数值格式建立起基本的理解 [@problem_id:3303457]。", "problem": "设计并实现一个完整、可运行的程序，对应用于一维线性声学系统的高阶有限差分和时间积分格式进行色散-耗散分析。目标是针对单个傅里叶模式，量化数值相位和振幅误差，将其表示为无量纲波数 $k \\Delta x$ 和 Courant–Friedrichs–Lewy ($\\mathrm{CFL}$) 数的函数。\n\n您必须从以下物理和数学基本出发点开始：\n- 针对均匀平均态（具有恒定密度 $\\rho_0$ 和声速 $c$）周围的小扰动 $(p',u')$ 的一维、等熵、线性化声学方程：\n$$\n\\partial_t p' + \\rho_0 c^2 \\, \\partial_x u' = 0, \\quad\n\\partial_t u' + \\frac{1}{\\rho_0} \\, \\partial_x p' = 0.\n$$\n- 对角化该系统的黎曼不变量 $w^\\pm$ 的定义，它能产生两个传播速度为 $\\pm c$ 的解耦平流方程。\n- 在间距为 $\\Delta x$ 的均匀网格上，使用 4 阶中心有限差分格式对 $\\partial_x$ 进行空间离散化。\n- 采用经典的 4 阶显式 Runge–Kutta 方法进行时间积分。\n\n您的程序必须：\n1. 针对单个波数 $k$ 进行平面波（傅里叶）分析，将节点索引为 $j$ 的空间网格傅里叶模式写为 $e^{i j \\theta}$，其中 $\\theta = k \\Delta x$ 且 $i^2 = -1$。从 4 阶中心差分模板中，为解耦的右行和左行声学模式推导离散空间导数符号及相应的半离散特征值。\n2. 将半离散算子与 4 阶 Runge–Kutta 时间积分器相结合，为每个模式获得单步放大因子 $R(z)$，其中 $z$ 是一个取决于 $\\theta$ 和 $\\mathrm{CFL} = c \\Delta t / \\Delta x$ 的适当无量纲化特征值。\n3. 为每个测试用例定义并计算以下两个输出：\n   - 每时间步的振幅误差，\n     $$\n     \\delta(\\theta,\\mathrm{CFL}) = \\left| R(z) \\right| - 1,\n     $$\n     其中 $\\left| \\cdot \\right|$ 表示复数模。\n   - 每时间步的相对相速度误差，\n     $$\n     \\varepsilon_c(\\theta,\\mathrm{CFL}) = \\frac{c_{\\mathrm{num}}}{c} - 1,\n     $$\n     其中数值相速度 $c_{\\mathrm{num}}$ 通过 $R(z)$ 的主辐角（以弧度为单位）定义为\n     $$\n     c_{\\mathrm{num}} = - \\frac{\\arg(R(z))}{k \\Delta t}.\n     $$\n     使用恒等式 $k \\Delta t = \\mathrm{CFL} \\, \\theta / 1$，以便\n     $$\n     \\frac{c_{\\mathrm{num}}}{c} = - \\frac{\\arg(R(z))}{\\mathrm{CFL}\\,\\theta}.\n     $$\n     辐角必须以弧度计算。注意，对于奈奎斯特模式 $\\theta = \\pi$，在 4 阶中心差分下，离散空间导数会湮灭该模式，导致 $c_{\\mathrm{num}} = 0$，因此对于任何 $\\mathrm{CFL} > 0$，都有 $\\varepsilon_c(\\pi,\\mathrm{CFL}) = -1$。\n4. 在代码中实现上述定义，不使用任何外部输入。角度必须以弧度处理，且所有输出均为无量纲。\n\n测试套件：\n- 使用以下 5 个测试用例，每个用例由一对 $(\\theta,\\mathrm{CFL})$ 指定，其中 $\\theta = k \\Delta x$ 以弧度为单位，$\\mathrm{CFL} = c \\Delta t / \\Delta x$：\n  - 用例 1：$(\\theta,\\mathrm{CFL}) = \\left(\\frac{\\pi}{8},\\, 0.5\\right)$\n  - 用例 2：$(\\theta,\\mathrm{CFL}) = \\left(\\frac{\\pi}{2},\\, 0.5\\right)$\n  - 用例 3：$(\\theta,\\mathrm{CFL}) = \\left(\\pi,\\, 0.5\\right)$\n  - 用例 4：$(\\theta,\\mathrm{CFL}) = \\left(10^{-3},\\, 0.9\\right)$\n  - 用例 5：$(\\theta,\\mathrm{CFL}) = \\left(\\frac{\\pi}{2},\\, 3.0\\right)$\n\n覆盖性设计：\n- 用例 1 和 2 探测中等 $\\mathrm{CFL}$ 数下典型的可分辨模式。\n- 用例 3 探测奈奎斯特边缘模式，在该模式下，4 阶中心差分表现出奇偶解耦。\n- 用例 4 探测小波数极限。\n- 用例 5 探测超出 4 阶 Runge–Kutta 方法虚轴稳定性范围的大 $\\mathrm{CFL}$ 数，以展示（误差）增长。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例的结果必须是按顺序排列的双元素列表 $[\\delta,\\varepsilon_c]$。因此，总输出是按照测试套件顺序排列的列表之列表，例如：\n`[[\\delta_1,\\varepsilon_{c,1}],[\\delta_2,\\varepsilon_{c,2}],[\\delta_3,\\varepsilon_{c,3}],[\\delta_4,\\varepsilon_{c,4}],[\\delta_5,\\varepsilon_{c,5}]]`\n- 角度必须是弧度，值 $\\delta$ 和 $\\varepsilon_c$ 必须以十进制数（浮点数）形式打印。不产生任何其他文本。根据构造，单位是无量纲的，因此不需要物理单位。", "solution": "用户希望对应用于一维线性化声学方程的数值格式进行色散-耗散分析。这是计算航空声学 (CAA) 和计算流体动力学 (CFD) 中评估数值方法质量的标准程序。该分析涉及研究格式如何表示单个傅里叶模式的传播。\n\n过程如下：\n1.  将控制方程分解为更简单的形式。\n2.  对简化后的方程在空间和时间上进行离散化。\n3.  推导单个傅里叶模式的单步放大因子。\n4.  从放大因子计算数值误差度量（振幅和相位误差）。\n\n### 步骤 1：声学系统的对角化\n\n给定的一维线性化声学系统为：\n$$\n\\partial_t p' + \\rho_0 c^2 \\, \\partial_x u' = 0\n$$\n$$\n\\partial_t u' + \\frac{1}{\\rho_0} \\, \\partial_x p' = 0\n$$\n该系统可以写成向量形式 $\\partial_t \\mathbf{q} + \\mathbf{A} \\partial_x \\mathbf{q} = \\mathbf{0}$，其中 $\\mathbf{q} = [p', u']^T$。通过定义黎曼不变量 $w^\\pm = p' \\pm \\rho_0 c u'$，该系统被对角化为两个独立的标量平流方程：\n$$\n\\partial_t w^+ + c \\, \\partial_x w^+ = 0 \\quad (\\text{右行波})\n$$\n$$\n\\partial_t w^- - c \\, \\partial_x w^- = 0 \\quad (\\text{左行波})\n$$\n应用于向量系统的格式的数值特性，可以通过研究其在一般标量平流方程 $\\partial_t w + a \\, \\partial_x w = 0$ 上的应用来理解，其中平流速度为 $a = \\pm c$。对 $a=c$ 的分析是充分的，因为 $a=-c$ 的结果将是对称的。\n\n### 步骤 2：半离散化（空间）\n\n我们在均匀网格 $x_j = j \\Delta x$ 上使用 4 阶中心有限差分格式离散化空间导数 $\\partial_x w$：\n$$\n(\\partial_x w)_j \\approx \\frac{-w_{j+2} + 8w_{j+1} - 8w_{j-1} + w_{j-2}}{12 \\Delta x}\n$$\n为了分析单个傅里叶模式的行为，我们代入 $w_j(t) = \\hat{w}(t) e^{ij\\theta}$，其中 $\\theta = k \\Delta x$ 是无量纲波数。该代入将偏微分算子转换为代数算子：\n$$\n\\partial_x w \\rightarrow \\hat{w}(t) e^{ij\\theta} \\left[ \\frac{-e^{i2\\theta} + 8e^{i\\theta} - 8e^{-i\\theta} + e^{-i2\\theta}}{12 \\Delta x} \\right]\n$$\n使用欧拉恒等式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，方括号中的项简化为：\n$$\n\\frac{8(2i\\sin\\theta) - (2i\\sin(2\\theta))}{12\\Delta x} = \\frac{i}{\\Delta x} \\left( \\frac{8\\sin\\theta - \\sin(2\\theta)}{6} \\right)\n$$\n$w(x,t) = \\hat{w}(t) e^{ikx}$ 的精确空间导数是 $ikw$。数值格式将精确波数 $k$ 替换为有效波数 $k_{\\text{eff}} = \\frac{1}{\\Delta x} \\frac{8\\sin\\theta - \\sin(2\\theta)}{6}$。我们定义无量纲修正波数 $\\theta' = k_{\\text{eff}} \\Delta x$。\n$$\n\\theta'(\\theta) = \\frac{8\\sin\\theta - \\sin(2\\theta)}{6} = \\frac{\\sin\\theta(4-\\cos\\theta)}{3}\n$$\n傅里叶振幅 $\\hat{w}(t)$ 的半离散方程变为一个常微分方程 (ODE)：\n$$\n\\frac{d\\hat{w}}{dt} + a \\left( \\frac{i \\theta'}{\\Delta x} \\right) \\hat{w} = 0 \\implies \\frac{d\\hat{w}}{dt} = \\lambda \\hat{w} \\quad \\text{其中} \\quad \\lambda = -a \\frac{i\\theta'}{\\Delta x}\n$$\n\n### 步骤 3：全离散分析（时间积分）\n\nODE $\\frac{d\\hat{w}}{dt} = \\lambda \\hat{w}$ 使用经典的 4 阶 Runge-Kutta (RK4) 方法进行时间积分。对于这个线性 ODE，单个时间步 $\\Delta t$ 将解更新为 $\\hat{w}_{n+1} = R(z) \\hat{w}_n$，其中 $R(z)$ 是放大因子，$z = \\lambda \\Delta t$。RK4 的多项式为：\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}\n$$\n参数 $z$ 可以用 CFL 数 $\\mathrm{CFL} = c \\Delta t / \\Delta x$ 表示。对于右行波 ($a=c$)：\n$$\nz = \\left(-c \\frac{i\\theta'}{\\Delta x}\\right) \\Delta t = -i \\left(\\frac{c\\Delta t}{\\Delta x}\\right) \\theta' = -i \\, \\mathrm{CFL} \\, \\theta'\n$$\n这个 $z$ 值是纯虚数。令 $Y = -\\mathrm{CFL} \\cdot \\theta'$。则 $z=iY$，放大因子为：\n$$\nR(iY) = \\left(1 - \\frac{Y^2}{2} + \\frac{Y^4}{24}\\right) + i \\left(Y - \\frac{Y^3}{6}\\right)\n$$\n\n### 步骤 4：数值误差度量\n\n放大因子 $R(z)$ 是一个复数，描述了数值解的振幅和相位在一个时间步长内的变化。对于无耗散的波传播，理想的格式应具有放大因子 $R_{\\text{exact}} = e^{i\\phi}$，其模为 1，相位角 $\\phi$ 对应于精确的波传播。\n对于模式 $e^{ikx}$，方程 $\\partial_t w + c \\partial_x w = 0$ 的精确解在一个时间步长内演化因子为 $e^{-ick\\Delta t}$。数值格式给出的因子为 $R(z)$。\n\n1.  **振幅误差 ($\\delta$)**：这衡量了每时间步的振幅变化，对应于数值耗散（如果 $|R|  1$）或不稳定性（如果 $|R| > 1$）。理想格式的 $|R|=1$。误差定义为：\n    $$\n    \\delta(\\theta, \\mathrm{CFL}) = |R(z)| - 1\n    $$\n\n2.  **相对相速度误差 ($\\varepsilon_c$)**：这衡量了波传播速度的误差。在一个时间步 $\\Delta t$ 内的精确相位变化是 $\\phi_{\\text{exact}} = -ck\\Delta t$。数值相位变化是 $\\phi_{\\text{num}} = \\arg(R(z))$。物理相速度是 $c = -\\phi_{\\text{exact}}/(k\\Delta t)$。数值相速度的定义类似：\n    $$\n    c_{\\text{num}} = -\\frac{\\phi_{\\text{num}}}{k\\Delta t} = -\\frac{\\arg(R(z))}{k\\Delta t}\n    $$\n    相对相速度误差为 $\\varepsilon_c = \\frac{c_{\\text{num}}}{c} - 1$。使用恒等式 $k\\Delta t = \\mathrm{CFL} \\cdot \\theta$，我们得到：\n    $$\n    \\frac{c_{\\text{num}}}{c} = \\frac{-\\arg(R(z))/k\\Delta t}{c} = -\\frac{\\arg(R(z))}{ck\\Delta t} = -\\frac{\\arg(R(z))}{\\mathrm{CFL} \\cdot \\theta}\n    $$\n    因此，相位误差的最终表达式为：\n    $$\n    \\varepsilon_c(\\theta, \\mathrm{CFL}) = -\\frac{\\arg(R(z))}{\\mathrm{CFL} \\cdot \\theta} - 1\n    $$\n    注意，对于奈奎斯特频率 $\\theta=\\pi$，4 阶中心格式得到 $\\theta'=0$，这导致 $z=0$ 和 $R(z)=1$。这意味着 $\\arg(R)=0$，所以 $c_{\\text{num}}=0$ 且 $\\varepsilon_c = -1$，正如问题描述中正确指出的。振幅误差为 $\\delta = |1|-1 = 0$。这些结果由通用公式捕获，无需特殊处理。\n\n程序将为给定的测试用例实现这些公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a dispersion-dissipation analysis for a 4th-order finite-difference\n    and 4th-order Runge-Kutta scheme applied to the 1D linear acoustic system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case is a tuple (theta, CFL)\n        # theta = k * delta_x, CFL = c * delta_t / delta_x\n        (np.pi / 8.0, 0.5),    # Case 1: Well-resolved mode, moderate CFL\n        (np.pi / 2.0, 0.5),    # Case 2: Poorly-resolved mode, moderate CFL\n        (np.pi, 0.5),          # Case 3: Nyquist mode\n        (1e-3, 0.9),           # Case 4: Long-wavelength limit\n        (np.pi / 2.0, 3.0),    # Case 5: Unstable case (high CFL)\n    ]\n\n    results = []\n    for theta, cfl in test_cases:\n        # Handle the trivial case of zero wavenumber (uniform field).\n        # The numerical scheme is exact, so errors are zero.\n        # This also prevents division by zero in the phase error calculation.\n        if np.isclose(theta, 0.0):\n            delta = 0.0\n            eps_c = 0.0\n            results.append([delta, eps_c])\n            continue\n\n        # Calculate the modified wavenumber for the 4th-order centered difference scheme.\n        # The symbol of the discrete derivative operator divided by i is k_eff.\n        # theta_prime = k_eff * delta_x\n        theta_prime = (8.0 * np.sin(theta) - np.sin(2.0 * theta)) / 6.0\n\n        # Argument for the RK4 amplification factor, z = lambda * dt.\n        # For the semi-discrete equation dw/dt = lambda * w, the eigenvalue is\n        # lambda = -a * (i * k_eff), where a is the advection speed (+/- c).\n        # We analyze the right-traveling wave (a=c).\n        # z = (-i * c * k_eff) * dt = -i * (c * dt / dx) * (k_eff * dx)\n        # z = -i * CFL * theta_prime\n        z = -1j * cfl * theta_prime\n\n        # RK4 amplification factor (stability polynomial):\n        # R(z) = 1 + z + z^2/2! + z^3/3! + z^4/4!\n        R = 1.0 + z + (z**2)/2.0 + (z**3)/6.0 + (z**4)/24.0\n\n        # 1. Amplitude error per time step: delta = |R(z)| - 1\n        # This measures numerical dissipation or instability.\n        delta = np.abs(R) - 1.0\n\n        # 2. Relative phase-speed error per time step: eps_c = c_num/c - 1\n        # The relative numerical phase speed is c_num/c = -arg(R(z)) / (CFL * theta).\n        arg_R = np.angle(R)\n        \n        # Denominator CFL * theta = (c*dt/dx) * (k*dx) = c*k*dt.\n        # This term is the exact phase shift for speed 'c' in dimensionless units.\n        denominator = cfl * theta\n        \n        # The case theta=pi is handled correctly by the general formulas:\n        # For theta=pi, the 4th-order centered scheme gives theta_prime=0.\n        # This leads to z=0, R=1, arg(R)=0, so c_num/c=0 and eps_c = -1.\n        eps_c = -arg_R / denominator - 1.0\n\n        results.append([delta, eps_c])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    # e.g., [[d1,e1],[d2,e2],...] without extra spaces inside the inner lists.\n    formatted_results = [f\"[{d},{e}]\" for d, e in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3303457"}, {"introduction": "为了模拟开放环境中的声传播，我们必须用能吸收外传波而不产生伪反射的人工边界来截断计算域。本练习将指导您基于线性化欧拉方程的特征变量法，推导一种经典的无反射边界条件（NRBC）。更重要的是，您将接着分析其在斜入射波下的性能，从而揭示为多维问题创建完美NRBC的根本挑战 [@problem_id:3303462]。", "problem": "考虑由线性化欧拉方程 (LEE) 控制的均匀、稳定、二维、无粘性流动的等熵小扰动。设均匀平均流沿 $x$ 轴方向，速度为 $u_0$，声速为 $c_0$，亚音速马赫数 $M = u_0/c_0 \\in (0,1)$。扰动场为压力 $p'(x,y,t)$、密度 $\\rho'(x,y,t)$ 以及速度分量 $u'(x,y,t)$ 和 $v'(x,y,t)$。假设为等熵声学，因此 $p' = c_0^2 \\rho'$。控制方程为质量守恒和线性动量平衡方程，\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0,\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0,\\quad\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0,\n$$\n其中 $\\rho_0$ 是均匀平均密度。您将使用沿 $x$ 方向的特征变量来构建一个无反射边界条件，然后评估其对于斜向平面波入射的反射特性。\n\n任务 A (推导)。仅从上述 LEE 和定义 $p' = c_0^2 \\rho'$ 出发，推导沿 $x$ 方向的一维特征变量并确定特征速度。使用这些变量，在一个外法线单位向量指向 $+x$ 方向的平面边界上构建一个边界条件，该条件对于垂直于边界的一维传播，能在亚音速出流处消除传入的声学特征。您的推导必须确定在严格一维情况下，实现此目标的边界法向速度扰动 $u'$ 和压力扰动 $p'$ 之间的特定线性关系。\n\n任务 B (反射分析)。现在考虑一个以斜角入射到此边界上的时谐平面声波。设总声场是一个出射（从域内部朝向边界）的入射波和一个传入（从边界返回域内）的反射波的叠加，两者形式均为\n$$\n\\Re\\left\\{ \\hat{p} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\},\n$$\n具有相同的实角频率 $\\omega > 0$ 和跨边界共享的切向波数 $k_y$。使用 LEE，推导均匀流中的声学色散关系以及平面波的 $u'$ 和 $p'$ 之间的线性关系，用波数分量和 $\\omega$ 表示。利用此关系，推导复压力反射系数 $R$ 的表达式，其定义为边界上反射复压力振幅与入射复压力振幅之比，\n$$\nR = \\frac{\\hat{p}_{\\mathrm{ref}}}{\\hat{p}_{\\mathrm{inc}}},\n$$\n该系数是由在边界上施加任务 A 中推导的边界条件得出的。您的推导必须对任何斜入射角和均匀亚音速平均流都有效。\n\n任务 C (计算评估)。实现一个程序，通过以下步骤为一组指定的测试用例评估反射系数的模 $|R|$：\n\n1. 入射参数化。将入射角 $\\theta$ 定义为在平均流静止坐标系中，入射波矢量与边界外法线（$+x$ 方向）之间的夹角。对于入射波，通过 $k_y = k_x \\tan\\theta$ 关联波数分量。对入射波强制使用色散关系，以确定出射（朝向边界）分支的 $k_x$。用 $\\theta$ 和这个 $k_x$ 表示 $k_y$。\n2. 反射分支选择。对于反射波，强制使用相同的 $\\omega$ 和 $k_y$，并为 $k_x$ 选择色散关系的另一个实根，该根对应于传入分支（对于亚音速出流，为负 $k_x$）。\n3. 线性 $u'$–$p'$ 关系。使用来自 LEE 的平面波关系，为每个分支计算边界法向速度振幅与压力振幅之比，用 $(\\omega, k_x, k_y, u_0, c_0)$ 表示。\n4. 将任务 A 中的边界条件应用于边界上的叠加场，以获得 $R$ 的闭合形式表达式，并评估其模 $|R|$。\n\n物理和数值单位及约定：\n\n- 使用 $c_0$ 和 $u_0$ 的单位为 $\\mathrm{m/s}$，$\\omega$ 的单位为 $\\mathrm{s}^{-1}$，$\\theta$ 的单位为弧度。\n- 输出量 $|R|$ 是无量纲的。将每个结果表示为小数点后六位四舍五入的十进制数。\n\n测试套件和最终输出格式：\n\n为以下五个测试用例评估 $|R|$，每个用例指定为 $(c_0, M, \\omega, \\theta)$，其中 $u_0 = M c_0$：\n\n- 用例 1：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 0.0\\,\\mathrm{rad})$。\n- 用例 2：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/6\\,\\mathrm{rad})$。\n- 用例 3：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/3\\,\\mathrm{rad})$。\n- 用例 4：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.7, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, \\pi/4\\,\\mathrm{rad})$。\n- 用例 5：$(c_0, M, \\omega, \\theta) = (340\\,\\mathrm{m/s}, 0.2, 2\\pi\\times 1000\\,\\mathrm{s}^{-1}, 1.3962634015954636\\,\\mathrm{rad})$。\n\n您的程序应生成一行输出，其中包含反射系数模的结果，形式为方括号内以逗号分隔的浮点数列表，每个浮点数四舍五入到小数点后六位，并与测试用例的顺序相同，例如，`[r_1,r_2,r_3,r_4,r_5]`。", "solution": "问题陈述被认为是有效的，因为它科学地基于流体动力学和声学原理，是适定的、客观的，并包含了唯一解所需的所有必要信息。我们按要求分三个任务进行求解。\n\n### 任务 A：一维无反射边界条件的推导\n\n我们从给定的二维线性化欧拉方程 (LEE) 开始，该方程描述了速度为 $(u_0, 0)$ 的均匀平均流。\n控制方程为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0\\left(\\frac{\\partial u'}{\\partial x} + \\frac{\\partial v'}{\\partial y}\\right) = 0 \\quad (\\text{质量})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0 \\quad (x\\text{-动量})\n$$\n$$\n\\rho_0\\left(\\frac{\\partial v'}{\\partial t} + u_0 \\frac{\\partial v'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial y} = 0 \\quad (y\\text{-动量})\n$$\n等熵假设将压力和密度扰动联系起来：$p' = c_0^2 \\rho'$。\n\n为了分析沿 $x$ 轴的一维传播，我们假设在 $y$ 方向上没有变化，即 $\\frac{\\partial}{\\partial y} = 0$，因此横向速度扰动 $v'$ 为零。方程简化为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + u_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\n使用 $p' = c_0^2 \\rho'$，我们将 $\\rho'$ 替换为 $p'/c_0^2$：\n$$\n\\frac{1}{c_0^2}\\left(\\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n$$\n\\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0\n$$\n这些方程可以写成矩阵形式。设状态向量为 $\\mathbf{q} = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$。该系统为 $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$，其中：\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} + \\begin{pmatrix} u_0  \\rho_0 c_0^2 \\\\ 1/\\rho_0  u_0 \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} p' \\\\ u' \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n特征速度是矩阵 $\\mathbf{A} = \\begin{pmatrix} u_0  \\rho_0 c_0^2 \\\\ 1/\\rho_0  u_0 \\end{pmatrix}$ 的特征值 $\\lambda$。它们由 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$ 求得：\n$$\n(u_0 - \\lambda)^2 - (\\rho_0 c_0^2)(1/\\rho_0) = (u_0 - \\lambda)^2 - c_0^2 = 0\n$$\n这得到 $u_0 - \\lambda = \\pm c_0$，因此特征速度为 $\\lambda_1 = u_0 + c_0$ 和 $\\lambda_2 = u_0 - c_0$。\n\n特征变量由 $\\mathbf{A}$ 的左特征向量 $\\mathbf{l}$ 确定。对于一个特征值 $\\lambda$，相应的特征方程为 $\\mathbf{l}^T \\left(\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x}\\right) = \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial t} + \\lambda \\mathbf{l}^T \\frac{\\partial \\mathbf{q}}{\\partial x} = 0$。\n左特征向量对于 $\\lambda_1 = u_0 + c_0$ 是 $\\mathbf{l}_1^T = \\begin{pmatrix} 1  \\rho_0 c_0 \\end{pmatrix}$，对于 $\\lambda_2 = u_0 - c_0$ 是 $\\mathbf{l}_2^T = \\begin{pmatrix} 1  -\\rho_0 c_0 \\end{pmatrix}$。\n特征变量在其各自的特征路径上是恒定的，是 $p'$ 和 $u'$ 的组合。其微分形式为：\n沿 $\\frac{dx}{dt} = u_0 + c_0$，$d\\mathcal{C}_1 = dp' + \\rho_0 c_0 du' = 0$。\n沿 $\\frac{dx}{dt} = u_0 - c_0$，$d\\mathcal{C}_2 = dp' - \\rho_0 c_0 du' = 0$。\n\n对于亚音速出流（$0  M  1$，因此 $0  u_0  c_0$）且边界外法线指向 $+x$ 方向的情况，计算域通常为 $x  x_{bdy}$。\n特征速度 $\\lambda_1 = u_0 + c_0 > 0$ 对应于离开计算域的波（出射波）。\n特征速度 $\\lambda_2 = u_0 - c_0  0$ 对应于从边界进入计算域的波（传入波）。\n无反射边界条件旨在防止从边界返回到计算域的伪反射。这通过在边界处将传入特征的振幅设置为零来实现。相应的特征不变量通常称为黎曼不变量。\n我们强制传入的特征扰动为零：\n$$\n\\mathcal{C}_2' = p' - \\rho_0 c_0 u' = 0\n$$\n这就为一维情况提供了边界法向速度扰动 $u'$ 和压力扰动 $p'$ 之间的特定线性关系，该关系定义了无反射边界条件：\n$$\nu' = \\frac{1}{\\rho_0 c_0} p'\n$$\n\n### 任务 B：斜入射的反射系数分析\n\n现在我们考虑任何扰动变量 $q'$ 的二维时谐平面波解，其形式为 $\\Re\\left\\{ \\hat{q} \\exp\\left(i\\left[\\omega t - k_x x - k_y y\\right]\\right)\\right\\}$。将此拟设代入 LEE 涉及变换 $\\frac{\\partial}{\\partial t} \\to i\\omega$、$\\frac{\\partial}{\\partial x} \\to -ik_x$ 和 $\\frac{\\partial}{\\partial y} \\to -ik_y$。这为复振幅 $(\\hat{p}, \\hat{u}, \\hat{v})$ 产生了一个代数系统：\n$$\n\\frac{i(\\omega - u_0 k_x)}{c_0^2}\\hat{p} + \\rho_0(-ik_x \\hat{u} - ik_y \\hat{v}) = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{u} + (-ik_x)\\hat{p} = 0\n$$\n$$\n\\rho_0 i(\\omega - u_0 k_x)\\hat{v} + (-ik_y)\\hat{p} = 0\n$$\n从动量方程中，我们以压力振幅的形式找到速度振幅：\n$$\n\\hat{u} = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)} \\hat{p} \\quad \\text{和} \\quad \\hat{v} = \\frac{k_y}{\\rho_0(\\omega - u_0 k_x)} \\hat{p}\n$$\n因此，边界法向速度与压力之间的关系为 $\\hat{u} = Z(k_x) \\hat{p}$，其中 $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$。\n将这些代入质量守恒方程，得到色散关系：\n$$\n\\frac{\\omega - u_0 k_x}{c_0^2} - \\rho_0 \\left( \\frac{k_x^2}{\\rho_0(\\omega - u_0 k_x)} + \\frac{k_y^2}{\\rho_0(\\omega - u_0 k_x)} \\right) = 0\n$$\n$$\n(\\omega - u_0 k_x)^2 = c_0^2 (k_x^2 + k_y^2)\n$$\n在边界处，总声场是入射波和反射波的叠加：$\\hat{p} = \\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}}$ 和 $\\hat{u} = \\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}}$。我们应用任务 A 中的一维无反射边界条件：$\\hat{u} = \\frac{1}{\\rho_0 c_0} \\hat{p}$。\n$$\n\\hat{u}_{\\mathrm{inc}} + \\hat{u}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\n对两个波使用平面波关系 $\\hat{u} = Z(k_x) \\hat{p}$，它们各自的法向波数为 $k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$：\n$$\nZ(k_{x, \\mathrm{inc}}) \\hat{p}_{\\mathrm{inc}} + Z(k_{x, \\mathrm{ref}}) \\hat{p}_{\\mathrm{ref}} = \\frac{1}{\\rho_0 c_0} (\\hat{p}_{\\mathrm{inc}} + \\hat{p}_{\\mathrm{ref}})\n$$\n重新排列以求解反射系数 $R = \\hat{p}_{\\mathrm{ref}} / \\hat{p}_{\\mathrm{inc}}$：\n$$\n\\hat{p}_{\\mathrm{ref}} \\left( Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0} \\right) = \\hat{p}_{\\mathrm{inc}} \\left( \\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}}) \\right)\n$$\n$$\nR = \\frac{\\frac{1}{\\rho_0 c_0} - Z(k_{x, \\mathrm{inc}})}{Z(k_{x, \\mathrm{ref}}) - \\frac{1}{\\rho_0 c_0}} = - \\frac{Z(k_{x, \\mathrm{inc}}) - 1/(\\rho_0 c_0)}{Z(k_{x, \\mathrm{ref}}) - 1/(\\rho_0 c_0)}\n$$\n代入 $Z(k_x) = \\frac{k_x}{\\rho_0(\\omega - u_0 k_x)}$：\n$$\nR = - \\frac{\\frac{k_{x, \\mathrm{inc}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{inc}})} - \\frac{1}{\\rho_0 c_0}}{\\frac{k_{x, \\mathrm{ref}}}{\\rho_0(\\omega - u_0 k_{x, \\mathrm{ref}})} - \\frac{1}{\\rho_0 c_0}} = - \\frac{\\frac{c_0 k_{x, \\mathrm{inc}} - (\\omega - u_0 k_{x, \\mathrm{inc}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{inc}})}}{\\frac{c_0 k_{x, \\mathrm{ref}} - (\\omega - u_0 k_{x, \\mathrm{ref}})}{\\rho_0 c_0 (\\omega - u_0 k_{x, \\mathrm{ref}})}}\n$$\n$$\nR = - \\frac{(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega}{(u_0+c_0)k_{x, \\mathrm{ref}} - \\omega} \\cdot \\frac{\\omega - u_0 k_{x, \\mathrm{ref}}}{\\omega - u_0 k_{x, \\mathrm{inc}}}\n$$\n这是反射系数的最终表达式。\n\n### 任务 C：计算评估程序\n\n反射系数的模 $|R|$ 按如下方式评估：\n1.  对于每个测试用例 $(c_0, M, \\omega, \\theta)$，计算平均流速度 $u_0 = M c_0$。\n2.  入射波由角度 $\\theta$ 表征。波数分量通过 $k_y = k_x \\tan\\theta$ 相关联。将此代入色散关系得到 $(\\omega - u_0 k_{x, \\mathrm{inc}})^2 = c_0^2 k_{x, \\mathrm{inc}}^2 (1+\\tan^2\\theta) = c_0^2 k_{x, \\mathrm{inc}}^2 \\sec^2\\theta$。取平方根，$\\omega - u_0 k_{x, \\mathrm{inc}} = \\pm c_0 k_{x, \\mathrm{inc}} \\sec\\theta$。“出射”分支对应于群速度 $v_{g,x}  0$。该分支被发现为 $\\omega = (u_0 + c_0 \\sec\\theta)k_{x, \\mathrm{inc}}$，这得到：\n    $$\n    k_{x, \\mathrm{inc}} = \\frac{\\omega}{u_0 + c_0 \\sec\\theta}\n    $$\n    然后切向波数为 $k_y = k_{x, \\mathrm{inc}} \\tan\\theta$。此 $k_y$ 在反射时守恒。\n3.  反射波数 $k_{x, \\mathrm{ref}}$ 是色散关系的第二个根，对于给定的 $\\omega$ 和 $k_y$，这是一个关于 $k_x$ 的二次方程：$(u_0^2 - c_0^2) k_x^2 - 2u_0\\omega k_x + (\\omega^2 - c_0^2 k_y^2) = 0$。根据韦达定理，根的和为 $k_{x, \\mathrm{inc}} + k_{x, \\mathrm{ref}} = \\frac{2 u_0 \\omega}{u_0^2 - c_0^2} = \\frac{2 M \\omega}{c_0(M^2-1)}$。因此，反射波数为：\n    $$\n    k_{x, \\mathrm{ref}} = \\frac{2 M \\omega}{c_0(M^2 - 1)} - k_{x, \\mathrm{inc}}\n    $$\n4.  计算出 $k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$ 后，任务 B 中推导的 $R$ 表达式中的所有项就都已知了。计算 $R$ 的数值。由于所有输入参数都是实数，对于给定条件，$k_{x, \\mathrm{inc}}$ 和 $k_{x, \\mathrm{ref}}$ 也是实数，使得 $R$ 是一个实数。模 $|R|$ 是其绝对值。\n对于法向入射（$\\theta=0$）的特殊情况，$k_y=0$。入射波是纯一维的。边界条件被设计为在这种情况下完全无反射，所以 $R=0$。分子项 $(u_0+c_0)k_{x, \\mathrm{inc}} - \\omega$ 变为 $(u_0+c_0)\\frac{\\omega}{u_0+c_0} - \\omega = 0$，证实了 $R=0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnitude of the reflection coefficient for a set of test cases\n    based on the derived formula for an aeroacoustic nonreflecting boundary condition.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c0, M, omega, theta)\n    test_cases = [\n        (340.0, 0.2, 2 * np.pi * 1000, 0.0),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 6),\n        (340.0, 0.2, 2 * np.pi * 1000, np.pi / 3),\n        (340.0, 0.7, 2 * np.pi * 1000, np.pi / 4),\n        (340.0, 0.2, 2 * np.pi * 1000, 1.3962634015954636),\n    ]\n\n    results = []\n    \n    for c0, M, omega, theta in test_cases:\n        # Calculate mean flow speed\n        u0 = M * c0\n\n        # For normal incidence (theta=0), the 1D BC is perfectly non-reflecting.\n        # The reflection coefficient R is identically zero.\n        if theta == 0.0:\n            results.append(0.0)\n            continue\n        \n        # Calculate trigonometric functions of the incidence angle\n        cos_theta = np.cos(theta)\n        sec_theta = 1.0 / cos_theta\n\n        # Step 1: Calculate the normal wavenumber for the incident wave (kx_inc)\n        # This corresponds to the outgoing wave branch with group velocity vg_x  0.\n        kx_inc = omega / (u0 + c0 * sec_theta)\n\n        # Step 2: Calculate the normal wavenumber for the reflected wave (kx_ref)\n        # It is the other root of the quadratic dispersion relation for kx.\n        # We use Vieta's formula kx_inc + kx_ref = -B/A to find it robustly.\n        # A = u0^2 - c0^2, B = -2*u0*omega\n        sum_of_roots = (2 * u0 * omega) / (u0**2 - c0**2)\n        # which can be simplified to:\n        # sum_of_roots = (2 * M * omega) / (c0 * (M**2 - 1))\n        kx_ref = sum_of_roots - kx_inc\n\n        # Step 3: Calculate the complex reflection coefficient R\n        # R = - [((u0+c0)*kx_inc - omega) / ((u0+c0)*kx_ref - omega)] * [(omega - u0*kx_ref) / (omega - u0*kx_inc)]\n        # Since all parameters are real, R will be a real number.\n        \n        # Numerator and denominator of the first term in the expression for R\n        term1_num = (u0 + c0) * kx_inc - omega\n        term1_den = (u0 + c0) * kx_ref - omega\n        \n        # Numerator and denominator of the second term (ratio of Doppler-shifted frequencies)\n        term2_num = omega - u0 * kx_ref\n        term2_den = omega - u0 * kx_inc\n\n        # Ensure no division by zero, although not expected for these physical parameters\n        if term1_den == 0 or term2_den == 0:\n            # A singularity in R implies a resonance or instability at the boundary\n            R = np.inf\n        else:\n            R = - (term1_num / term1_den) * (term2_num / term2_den)\n\n        # Step 4: Calculate the magnitude of R and add to results\n        abs_R = np.abs(R)\n        results.append(abs_R)\n\n    # Format the final list of results to 6 decimal places per the problem specification.\n    # The final print statement must produce only the specified output format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3303462"}, {"introduction": "许多CAA方法的基础是声学比拟理论，它将复杂的流动物理与相对简单的声波传播分离开来。本练习通过指导您计算Lighthill四极子源项张量，将这两个领域联系起来，该张量模拟了湍流运动如何产生声音。您将处理一个仿真的大涡模拟（LES）数据，并探索在精确量化声源时，数值微分和滤波所带来的实际挑战 [@problem_id:3303443]。", "problem": "您的任务是建立一个基于可压缩流基本原理的计算工作流程，用于构建声学比拟中的四极子源张量，并量化其对数值微分和大涡模拟（LES）滤波的敏感性。以可压缩纳维-斯托克斯方程和牛顿本构定律为基本出发点。具体来说，使用质量和动量守恒定律以及带有斯托克斯假设的牛顿黏性应力，推导出在Lighthill声学比拟中充当源项的张量。在人工合成但物理上合理的三维场上对推导出的表达式进行数值实现，并通过与谱方法参考值进行比较，量化其对微分格式和LES滤波宽度的敏感性。\n\n人工合成的LES场定义在一个周期性立方体域上，每个方向的长度为 $L$，每个方向的网格分辨率为 $N$ 个点。在间距为 $\\Delta x = L/N$ 的均匀网格上定义笛卡尔坐标 $\\{x,y,z\\}$。使用以下物理上一致且平滑的场来模拟经过滤波的LES量：\n- 速度分量：\n$$u_x(x,y,z) = \\sin(x)\\cos(y)\\cos(z),\\quad u_y(x,y,z) = \\cos(x)\\sin(y)\\cos(z),\\quad u_z(x,y,z) = \\cos(x)\\cos(y)\\sin(z).$$\n- 密度：\n$$\\rho(x,y,z) = \\rho_0 + \\varepsilon_\\rho \\cos(x)\\cos(y)\\cos(z).$$\n- 压力：\n$$p(x,y,z) = c^2 \\rho(x,y,z) + \\varepsilon_p \\cos(2x)\\cos(2y)\\cos(2z).$$\n\n您必须从第一性原理出发，推导出与Lighthill声学比拟相关的四极子源张量表达式；该张量必须完全用基本场 $\\rho$、$p$、$\\boldsymbol{u}$、声速 $c$ 以及由带有斯托克斯假设的牛顿定律定义的黏性应力张量 $\\boldsymbol{\\sigma}$ 来表示。推导过程必须从守恒方程和定义开始，不能在开始时直接假设或陈述目标表达式。然后，实现一个数值算法，在离散网格上通过以下步骤计算该张量：\n- 在指定的网格上构建人工合成场。\n- 对场 $\\rho$、$p$ 和 $\\boldsymbol{u}$ 的每个分量应用一个标准差为 $\\sigma_f$ 的三维高斯LES滤波器，该滤波器具有空间不变、可分离和周期性的核。在傅里叶空间中，该滤波器应等效于乘以 $\\exp\\left[-\\tfrac{1}{2}\\sigma_f^2\\left(k_x^2+k_y^2+k_z^2\\right)\\right]$，其中 $\\{k_x,k_y,k_z\\}$ 是在长度为 $L$ 的域上满足周期性的角波数。\n- 通过以下三种格式之一计算 $\\boldsymbol{\\sigma}$ 所需的空间导数：\n    1. 周期性网格上的二阶中心差分格式。\n    2. 周期性网格上的四阶中心差分格式。\n    3. 通过快速傅里叶变换（FFT）的谱方法求导，对于周期性域，它通过将傅里叶变换乘以 $\\mathrm{i}k_x$（对于 $y$ 和 $z$ 也类似）来计算 $\\partial/\\partial x$，然后进行逆变换。\n\n将带有斯托克斯假设的牛顿黏性应力定义为\n$$\\sigma_{ij} = \\mu\\left(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}\\right) - \\frac{2}{3}\\mu\\left(\\nabla\\cdot\\boldsymbol{u}\\right)\\delta_{ij},$$\n其中 $\\mu$ 是动力黏度，$\\delta_{ij}$ 是克罗内克（Kronecker）δ函数。在您推导的四极子源张量表达式中使用此 $\\boldsymbol{\\sigma}$。\n\n使用与室温条件下的空气和标准声学实践一致的参数值：\n- 域长度：$L = 2\\pi$ 米。\n- 网格分辨率：每个方向 $N = 32$ 个点，因此 $\\Delta x = L/N$ 米。\n- 声速：$c = 340$ 米/秒。\n- 基准密度：$\\rho_0 = 1.2$ 千克/立方米。\n- 密度扰动振幅：$\\varepsilon_\\rho = 0.05$ 千克/立方米。\n- 压力偏差振幅：$\\varepsilon_p = 10$ 帕斯卡。\n- 动力黏度：$\\mu = 1.8\\times 10^{-5}$ 帕斯卡-秒。\n\n为了评估敏感性，定义一个使用谱方法求导格式且不进行滤波计算的参考张量，并报告由给定格式与滤波器组合生成的张量与参考张量之间的相对均方根（RMS）差异。对于张量场 $\\boldsymbol{T}$ 及其参考值 $\\boldsymbol{T}^{\\mathrm{ref}}$，将相对RMS差异定义为\n$$E = \\frac{\\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2}{\\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2},$$\n其中范数是所有网格点和所有张量分量的欧几里得范数，\n$$\\left\\|\\boldsymbol{A}\\right\\|_2 = \\left(\\sum_{i=1}^3\\sum_{j=1}^3\\sum_{\\text{grid}} A_{ij}^2\\right)^{1/2}.$$\n\n实现一个程序，该程序构建场、应用滤波、计算导数和黏性应力、形成四极子源张量，并为以下测试套件评估 $E$。每个测试案例由一个微分格式和一个以米为单位的高斯滤波器标准差来标识。滤波器宽度值以 $\\Delta x$ 表示：\n- 案例1：格式 $\\mathrm{spectral}$，$\\sigma_f = 0\\Delta x$。\n- 案例2：格式 $\\mathrm{central2}$，$\\sigma_f = 0\\Delta x$。\n- 案例3：格式 $\\mathrm{central4}$，$\\sigma_f = 0\\Delta x$。\n- 案例4：格式 $\\mathrm{central2}$，$\\sigma_f = 2\\Delta x$。\n- 案例5：格式 $\\mathrm{spectral}$，$\\sigma_f = 2\\Delta x$。\n- 案例6：格式 $\\mathrm{central2}$，$\\sigma_f = 5\\Delta x$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按案例1到6的顺序排列结果，每个数值结果四舍五入到六位小数，例如，`[0.000000,0.012345,0.006789,0.123456,0.234567,0.345678]`。报告的量 $E$ 是无量纲的，因此不应打印任何物理单位。角度（如果在您的推导中出现）应被视为以弧度为单位的无量纲相位，但输出不需要角度。在推导过程中，用所述的物理单位表达所有中间和最终的数学推理，但程序输出必须是指定的无量纲浮点数。", "solution": "该问题是有效的，因为它科学地基于可压缩流体动力学和计算航空声学的原理，其参数和定义完整且一致，问题提法适定，并提出了一个客观且非平凡的计算任务。\n\n核心任务是推导并数值实现Lighthill四极子源张量 $T_{ij}$，并分析其对数值近似的敏感性。推导从可压缩流体的基本守恒定律开始：质量守恒（连续性方程）和动量守恒。\n\n连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u_j)}{\\partial x_j} = 0\n$$\n其中 $\\rho$ 是流体密度，$\\boldsymbol{u}$ 是速度矢量，其分量为 $u_j$，$t$ 是时间，$x_j$ 是笛卡尔坐标。对重复的指标使用了爱因斯坦求和约定。\n\n可压缩黏性流体的动量方程为：\n$$\n\\frac{\\partial (\\rho u_i)}{\\partial t} + \\frac{\\partial (\\rho u_i u_j)}{\\partial x_j} = -\\frac{\\partial p}{\\partial x_i} + \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\n$$\n这里，$p$ 是静压，$\\sigma_{ij}$ 是黏性应力张量。\n\n为了推导Lighthill声学比拟，我们将这些方程重排为非齐次波动方程的形式。我们对连续性方程求时间导数，并对动量方程求散度（关于 $x_i$ 的导数）。\n连续性方程的时间导数：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_j)}{\\partial x_j}\\right) = 0\n$$\n动量方程的散度：\n$$\n\\frac{\\partial}{\\partial x_i}\\left(\\frac{\\partial (\\rho u_i)}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\frac{\\partial^2 p}{\\partial x_i^2} + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n假设场足够平滑，我们可以交换第一项的微分顺序，得到 $\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial (\\rho u_i)}{\\partial x_i}\\right)$。从连续性方程可知，$\\frac{\\partial (\\rho u_j)}{\\partial x_j} = -\\frac{\\partial \\rho}{\\partial t}$。将此代入处理后的动量方程，得到：\n$$\n\\frac{\\partial}{\\partial t}\\left(-\\frac{\\partial \\rho}{\\partial t}\\right) + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n$$\n-\\frac{\\partial^2 \\rho}{\\partial t^2} + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} = -\\nabla^2 p + \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n重新整理，并将除密度时间导数外的所有项移到右侧，得到一个从纳维-斯托克斯方程推导出的精确方程：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} = \\nabla^2 p + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n为了构成波动方程，我们引入参考声速 $c$，并从两侧减去项 $c^2 \\nabla^2 \\rho$：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\nabla^2 p - c^2 \\nabla^2 \\rho + \\frac{\\partial^2 (\\rho u_i u_j)}{\\partial x_i \\partial x_j} - \\frac{\\partial^2 \\sigma_{ij}}{\\partial x_i \\partial x_j}\n$$\n左侧是作用于密度的线性波算子。右侧包含了所有的声源项。我们将右侧的所有项归入一个二阶空间散度 $\\frac{\\partial^2}{\\partial x_i \\partial x_j}$ 之下。为此，我们注意到对于任何标量场 $S$，其拉普拉斯算子可以写成 $\\nabla^2 S = \\frac{\\partial^2 (S \\delta_{ij})}{\\partial x_i \\partial x_j}$，其中 $\\delta_{ij}$ 是克罗内克（Kronecker）δ函数。将此应用于项 $(\\nabla^2 p - c^2 \\nabla^2 \\rho) = \\nabla^2(p - c^2 \\rho)$，我们可以写出：\n$$\n\\frac{\\partial^2 \\rho}{\\partial t^2} - c^2 \\nabla^2 \\rho = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left[ \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij} \\right]\n$$\n这就是Lighthill方程。方括号中的项是Lighthill四极子源张量 $T_{ij}$：\n$$\nT_{ij} = \\rho u_i u_j + (p - c^2 \\rho)\\delta_{ij} - \\sigma_{ij}\n$$\n$T_{ij}$ 中的三项代表了物理上不同的声生成机制：雷诺应力项 $\\rho u_i u_j$（在高速流中占主导地位），与非等熵压力脉动或熵相关的项 $(p - c^2\\rho)\\delta_{ij}$，以及黏性应力项 $-\\sigma_{ij}$（在高雷诺数流动的声生成中通常可以忽略，但为完整性起见仍包含在内）。问题为压力 $p$ 提供了一个显式形式，使得 $p - c^2 \\rho$ 是一个给定的解析函数，从而简化了其计算。\n\n数值实现是基于这些原理设计的。\n首先，在边长为 $L = 2\\pi$ 米的周期性域上建立一个离散网格，每个方向有 $N = 32$ 个点，网格间距为 $\\Delta x = L/N = \\pi/16$ 米。在这个三维网格上填充人工合成的速度 $\\boldsymbol{u}$、密度 $\\rho$ 和压力 $p$ 场。\n\n其次，分析的一个关键部分涉及通过应用滤波器来模拟大涡模拟（LES）。使用了一个三维高斯滤波器，它在傅里叶空间中实现效率最高。一个场 $\\phi$ 通过进行快速傅里叶变换（FFT），将其乘以滤波器传递函数 $G(\\boldsymbol{k}) = \\exp(-\\frac{1}{2}\\sigma_f^2 |\\boldsymbol{k}|^2)$，然后进行逆FFT来进行滤波。这里，$\\boldsymbol{k} = (k_x, k_y, k_z)$ 是角波数矢量，$\\sigma_f$ 是滤波器宽度。此操作正确地模拟了从流场中去除小尺度信息的过程。\n\n第三，计算 $T_{ij}$ 需要空间导数来形成黏性应力张量 $\\sigma_{ij}$。问题指定了三种格式：\n1. 谱方法求导：这在傅里叶空间中执行，通过将场的FFT乘以 $\\mathrm{i}k_x$（用于 $\\partial/\\partial x$）、$\\mathrm{i}k_y$（用于 $\\partial/\\partial y$）等，然后进行逆变换。对于周期性的平滑函数，此方法非常精确，仅受网格分辨率（混叠效应）的限制，使其成为参考解的理想选择。\n2. 二阶中心差分：一种有限差分近似，例如 $\\frac{\\partial f}{\\partial x} \\approx \\frac{f(x+\\Delta x) - f(x-\\Delta x)}{2\\Delta x}$。这是一种常见且计算成本低的格式。\n3. 四阶中心差分：一种更高精度的有限差分格式，例如 $\\frac{\\partial f}{\\partial x} \\approx \\frac{-f(x+2\\Delta x) + 8f(x+\\Delta x) - 8f(x-\\Delta x) + f(x-2\\Delta x)}{12\\Delta x}$。与二阶格式相比，它以更高的计算成本提供了更好的精度。\n周期性通过循环数组移位（例如，`numpy.roll`）来处理。\n\n利用滤波后的场和选定的微分格式，组装Lighthill张量 $T_{ij}$。首先计算速度梯度张量 $\\partial u_i / \\partial x_j$。由此构造出速度散度 $\\nabla\\cdot\\boldsymbol{u}$ 和黏性应力张量 $\\sigma_{ij} = \\mu(\\frac{\\partial u_i}{\\partial x_j}+\\frac{\\partial u_j}{\\partial x_i}) - \\frac{2}{3}\\mu(\\nabla\\cdot\\boldsymbol{u})\\delta_{ij}$。最后，根据其推导出的公式，在每个网格点上计算 $T_{ij}$ 的所有分量。\n\n为了量化敏感性，使用最精确的组合计算参考张量 $T^{\\mathrm{ref}}$：谱方法求导且不进行滤波（$\\sigma_f = 0$）。对于每个测试案例，计算相应的张量 $T$，并使用相对均方根（RMS）差异 $E = \\left\\|\\boldsymbol{T}-\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2 / \\left\\|\\boldsymbol{T}^{\\mathrm{ref}}\\right\\|_2$ 与参考值进行比较。范数 $\\left\\|\\cdot\\right\\|_2$ 是在所有9个张量分量和所有网格点上计算的标准欧几里得范数。该度量提供了一个单一的标量值，量化了由给定的数值格式和滤波器宽度引入的总误差。案例1（谱方法，$\\sigma_f=0$）作为基准，根据定义，其误差 $E$ 为 $0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, computes, and analyzes the Lighthill quadrupole source tensor.\n    \"\"\"\n    #\n    # Define parameters and computational domain\n    #\n    L = 2.0 * np.pi  # Domain length [m]\n    N = 32           # Grid resolution\n    C = 340.0        # Speed of sound [m/s]\n    RHO_0 = 1.2      # Baseline density [kg/m^3]\n    EPS_RHO = 0.05   # Density perturbation amplitude [kg/m^3]\n    EPS_P = 10.0     # Pressure deviation amplitude [Pa]\n    MU = 1.8e-5      # Dynamic viscosity [Pa.s]\n\n    DX = L / N\n\n    #\n    # Construct grid and wavenumber arrays\n    #\n    x = np.arange(N) * DX\n    X, Y, Z = np.meshgrid(x, x, x, indexing='ij')\n\n    # Angular wavenumbers\n    k_vals = 2 * np.pi * np.fft.fftfreq(N, d=DX)\n    Kx, Ky, Kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n\n    #\n    # Generate synthetic flow fields\n    #\n    ux = np.sin(X) * np.cos(Y) * np.cos(Z)\n    uy = np.cos(X) * np.sin(Y) * np.cos(Z)\n    uz = np.cos(X) * np.cos(Y) * np.sin(Z)\n    rho = RHO_0 + EPS_RHO * np.cos(X) * np.cos(Y) * np.cos(Z)\n    p = C**2 * rho + EPS_P * np.cos(2*X) * np.cos(2*Y) * np.cos(2*Z)\n\n    def apply_filter(field, sigma_f):\n        \"\"\"Applies a 3D Gaussian filter in Fourier space.\"\"\"\n        if sigma_f == 0:\n            return field\n        K2 = Kx**2 + Ky**2 + Kz**2\n        filter_kernel = np.exp(-0.5 * sigma_f**2 * K2)\n        field_hat = np.fft.fftn(field)\n        filtered_hat = field_hat * filter_kernel\n        return np.real(np.fft.ifftn(filtered_hat))\n\n    def compute_gradient(field, scheme, dx):\n        \"\"\"Computes the gradient of a scalar field using a specified scheme.\"\"\"\n        grad = np.zeros((3, N, N, N))\n        if scheme == 'spectral':\n            field_hat = np.fft.fftn(field)\n            grad[0] = np.real(np.fft.ifftn(1j * Kx * field_hat))\n            grad[1] = np.real(np.fft.ifftn(1j * Ky * field_hat))\n            grad[2] = np.real(np.fft.ifftn(1j * Kz * field_hat))\n        elif scheme == 'central2':\n            grad[0] = (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2 * dx)\n            grad[1] = (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2 * dx)\n            grad[2] = (np.roll(field, -1, axis=2) - np.roll(field, 1, axis=2)) / (2 * dx)\n        elif scheme == 'central4':\n            grad[0] = (-np.roll(field, -2, axis=0) + 8 * np.roll(field, -1, axis=0) -\n                       8 * np.roll(field, 1, axis=0) + np.roll(field, 2, axis=0)) / (12 * dx)\n            grad[1] = (-np.roll(field, -2, axis=1) + 8 * np.roll(field, -1, axis=1) -\n                       8 * np.roll(field, 1, axis=1) + np.roll(field, 2, axis=1)) / (12 * dx)\n            grad[2] = (-np.roll(field, -2, axis=2) + 8 * np.roll(field, -1, axis=2) -\n                       8 * np.roll(field, 1, axis=2) + np.roll(field, 2, axis=2)) / (12 * dx)\n        return grad\n\n    def compute_lighthill_tensor(scheme, sigma_f_factor):\n        \"\"\"Computes the Lighthill tensor for a given scheme and filter width.\"\"\"\n        sigma_f = sigma_f_factor * DX\n\n        # 1. Apply LES filter to fields\n        u_f = np.array([\n            apply_filter(ux, sigma_f),\n            apply_filter(uy, sigma_f),\n            apply_filter(uz, sigma_f)\n        ])\n        rho_f = apply_filter(rho, sigma_f)\n        p_f = apply_filter(p, sigma_f)\n\n        # 2. Compute velocity gradient tensor: grad_u[i, j] = du_i / dx_j\n        grad_u = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            grad_ui = compute_gradient(u_f[i], scheme, DX)\n            for j in range(3):\n                grad_u[i, j, ...] = grad_ui[j, ...]\n\n        # 3. Compute viscous stress tensor sigma_ij\n        div_u = grad_u[0, 0] + grad_u[1, 1] + grad_u[2, 2]\n        grad_u_T = np.transpose(grad_u, (1, 0, 2, 3, 4))\n        sigma = MU * (grad_u + grad_u_T)\n        for i in range(3):\n            sigma[i, i, ...] -= (2.0/3.0) * MU * div_u\n\n        # 4. Assemble Lighthill tensor T_ij = rho u_i u_j + (p - c^2 rho)delta_ij - sigma_ij\n        T = np.zeros((3, 3, N, N, N))\n        for i in range(3):\n            for j in range(3):\n                T[i, j, ...] = rho_f * u_f[i] * u_f[j]\n        T -= sigma\n        p_term = p_f - C**2 * rho_f\n        for i in range(3):\n            T[i, i, ...] += p_term\n            \n        return T\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'scheme': 'spectral', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 0},\n        {'scheme': 'central4', 'sigma_f_factor': 0},\n        {'scheme': 'central2', 'sigma_f_factor': 2},\n        {'scheme': 'spectral', 'sigma_f_factor': 2},\n        {'scheme': 'central2', 'sigma_f_factor': 5},\n    ]\n\n    # Compute reference tensor using the most accurate method (spectral, no filter)\n    T_ref = compute_lighthill_tensor(scheme='spectral', sigma_f_factor=0)\n    norm_T_ref = np.sqrt(np.sum(T_ref**2))\n\n    results = []\n    for case in test_cases:\n        if case['scheme'] == 'spectral' and case['sigma_f_factor'] == 0:\n            # The reference case has zero error by definition\n            E = 0.0\n        else:\n            T_case = compute_lighthill_tensor(case['scheme'], case['sigma_f_factor'])\n            diff_norm = np.sqrt(np.sum((T_case - T_ref)**2))\n            E = diff_norm / norm_T_ref if norm_T_ref > 0 else 0.0\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3303443"}]}