{"hands_on_practices": [{"introduction": "在基于小火焰的燃烧模型中，燃烧状态通常通过守恒标量（如混合分数 $Z$）进行参数化。理解混合分数 $Z$、局部当量比 $\\phi$ 和标量耗散率 $\\chi_{st}$ 之间的关系是掌握该方法的基础。本练习 [@problem_id:3318846] 将通过推导一个部分预混系统中的这些核心参数之间的关系，来巩固您对这些概念的理解，并展示部分预混如何影响火焰位置及其熄火特性。", "problem": "在计算流体力学 (CFD) 的湍流燃烧小火焰模型中，反应混合物的局部状态由混合分数 $Z$ 参数化，它是两股流混合过程中的一个守恒标量。考虑一个经典的双流配置：一股燃料流和一股氧化剂流混合，但不发生反应，通过线性叠加产生局部的反应前质量分数 $Y_{F}(Z)$ 和 $Y_{O}(Z)$。局部当量比 $\\phi$ 定义为实际燃料与氧化剂质量比与其化学计量值的比率，其中单步化学反应表示为 $F + s\\,O \\rightarrow \\text{products}$，$s$ 是化学计量氧化剂与燃料的质量比。为标量输运之目的，假设路易斯数 (Lewis numbers) 为1且密度恒定。\n\n设燃料流的组成为 $Y_{F,F}$ 和 $Y_{O,F}$，氧化剂流的组成为 $Y_{F,O}$ 和 $Y_{O,O}$。假设混合分数在逆流混合层中的空间依赖关系由下式给出\n$$\nZ(\\xi) = \\frac{1}{2}\\left[1 - \\tanh(\\alpha \\,\\xi)\\right],\n$$\n其中常数 $\\alpha  0$，$\\xi$ 是垂直于驻点平面的坐标。分子扩散系数为常数 $D  0$。标量耗散率为\n$$\n\\chi(\\xi) = 2 D \\left|\\frac{dZ}{d\\xi}\\right|^{2}.\n$$\n在非预混小火焰的意义上，当化学计量表面处的标量耗散率 $\\chi_{st} \\equiv \\chi(\\xi_{st})$（其中 $Z(\\xi_{st}) = Z_{st}$）超过一个与化学反应相关的临界值 $\\chi_{\\text{ext,crit}}$ 时，就会发生熄火。\n\n您需要通过允许氧化剂流中存在非零的燃料背景（量化为 $Y_{F,O}  0$）来分析部分预混。仅使用上述定义和线性双流混合作为基本基础，按以下步骤进行：\n\n1) 对于具有 $Y_{F,F}$、$Y_{O,F}$、$Y_{F,O}$ 和 $Y_{O,O}$ 的通用双流混合，推导局部当量比 $\\phi$ 和混合分数 $Z$ 之间的映射关系 $\\phi(Z)$。\n\n2) 专门针对甲烷-氧气化学替代物，其中 $s = 4$，流组分如下：\n- 燃料流: $Y_{F,F} = 1$，$Y_{O,F} = 0$。\n- 氧化剂流氧气质量分数: $Y_{O,O} = 0.21$。\n比较两种氧化剂情况：\n(a) 无背景燃料: $Y_{F,O} = 0$。\n(b) 部分预混: $Y_{F,O} = 0.02$。\n对于每种情况，通过强制执行化学计量混合条件并确定 $\\phi(Z_{st}) = 1$ 的位置，来确定化学计量混合分数 $Z_{st}$。\n\n3) 利用上面给出的 $Z(\\xi)$ 剖面，将 $\\chi_{st}$ 表示为仅关于 $Z_{st}$、$D$ 和 $\\alpha$ 的函数，并计算比率\n$$\nR \\equiv \\frac{\\chi_{st}\\ \\text{（当}\\ Y_{F,O} = 0.02\\text{时})}{\\chi_{st}\\ \\text{（当}\\ Y_{F,O} = 0\\text{时})},\n$$\n在比较中保持 $D$、$\\alpha$ 和 $\\chi_{\\text{ext,crit}}$ 不变。该比率量化了由氧化剂流中的背景燃料引起的混合控制熄火倾向的变化。\n\n请提供您的最终数值 $R$，四舍五入至四位有效数字。将您的答案表示为一个无单位的无量纲数。", "solution": "解答按照问题陈述的要求分为三个部分。\n\n#### 1) 推导映射关系 $\\phi(Z)$\n\n燃料的局部质量分数 $Y_F(Z)$ 和氧化剂的局部质量分数 $Y_O(Z)$ 由燃料流（在 $Z=1$ 处）和氧化剂流（在 $Z=0$ 处）之间的线性混合规则给出。在问题的符号表示中，流组分上下文中的燃料流用下标F表示，氧化剂流用下标O表示，混合规则为：\n$$\nY_F(Z) = Z \\cdot Y_{F,F} + (1-Z) \\cdot Y_{F,O}\n$$\n$$\nY_O(Z) = Z \\cdot Y_{O,F} + (1-Z) \\cdot Y_{O,O}\n$$\n局部当量比 $\\phi$ 定义为实际燃料-氧化剂比与化学计量燃料-氧化剂比（$1/s$）的归一化：\n$$\n\\phi = s \\frac{Y_F}{Y_O}\n$$\n将 $Y_F(Z)$ 和 $Y_O(Z)$ 的线性混合规则代入 $\\phi$ 的定义，得到映射关系 $\\phi(Z)$：\n$$\n\\phi(Z) = s \\frac{Z Y_{F,F} + (1-Z) Y_{F,O}}{Z Y_{O,F} + (1-Z) Y_{O,O}}\n$$\n这是给定双流混合配置下局部当量比和混合分数之间的一般关系。\n\n#### 2) 确定化学计量混合分数 $Z_{st}$\n\n化学计量混合分数 $Z_{st}$ 是混合物处于化学计量状态时的 $Z$ 值，即 $\\phi(Z_{st}) = 1$。将 $\\phi(Z)$ 的表达式设为1，得到：\n$$\n1 = s \\frac{Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O}}{Z_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O}}\n$$\n为求解 $Z_{st}$，我们重新整理方程：\n$$\nZ_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O} = s \\left( Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O} \\right)\n$$\n$$\nZ_{st} Y_{O,F} + Y_{O,O} - Z_{st} Y_{O,O} = s Z_{st} Y_{F,F} + s Y_{F,O} - s Z_{st} Y_{F,O}\n$$\n将包含 $Z_{st}$ 的项分组：\n$$\nY_{O,O} - s Y_{F,O} = Z_{st} \\left( s Y_{F,F} - s Y_{F,O} - Y_{O,F} + Y_{O,O} \\right)\n$$\n分离出 $Z_{st}$ 得到通解：\n$$\nZ_{st} = \\frac{Y_{O,O} - s Y_{F,O}}{s Y_{F,F} + Y_{O,O} - Y_{O,F} - s Y_{F,O}}\n$$\n现在我们使用给定的数值进行特化：$s=4$，$Y_{F,F}=1$，$Y_{O,F}=0$，$Y_{O,O}=0.21$。$Z_{st}$ 的表达式变为：\n$$\nZ_{st} = \\frac{0.21 - 4 Y_{F,O}}{4(1) + 0.21 - 0 - 4 Y_{F,O}} = \\frac{0.21 - 4 Y_{F,O}}{4.21 - 4 Y_{F,O}}\n$$\n我们对两种指定情况分别进行求值。\n\n(a) 无背景燃料：$Y_{F,O} = 0$。\n$$\nZ_{st,a} = \\frac{0.21 - 4(0)}{4.21 - 4(0)} = \\frac{0.21}{4.21}\n$$\n\n(b) 部分预混：$Y_{F,O} = 0.02$。\n$$\nZ_{st,b} = \\frac{0.21 - 4(0.02)}{4.21 - 4(0.02)} = \\frac{0.21 - 0.08}{4.21 - 0.08} = \\frac{0.13}{4.13}\n$$\n\n#### 3) 计算比率 $R$\n\n首先，我们推导标量耗散率 $\\chi_{st}$ 作为 $Z_{st}$ 的函数表达式。标量耗散率由 $\\chi(\\xi) = 2 D |dZ/d\\xi|^2$ 给出。我们需要从给定的剖面 $Z(\\xi) = \\frac{1}{2}[1 - \\tanh(\\alpha \\xi)]$ 中求出导数 $dZ/d\\xi$。\n$$\n\\frac{dZ}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{1}{2} - \\frac{1}{2}\\tanh(\\alpha \\xi) \\right) = -\\frac{1}{2} \\text{sech}^2(\\alpha \\xi) \\cdot \\alpha = -\\frac{\\alpha}{2} \\text{sech}^2(\\alpha \\xi)\n$$\n我们需要用 $Z$ 来表示这个导数。根据 $Z(\\xi)$ 的定义，我们有 $2Z = 1 - \\tanh(\\alpha\\xi)$，这给出 $\\tanh(\\alpha\\xi) = 1-2Z$。使用恒等式 $\\text{sech}^2(x) = 1 - \\tanh^2(x)$，我们发现：\n$$\n\\text{sech}^2(\\alpha\\xi) = 1 - \\left(1-2Z\\right)^2 = 1 - \\left(1 - 4Z + 4Z^2\\right) = 4Z - 4Z^2 = 4Z(1-Z)\n$$\n将此代入导数表达式：\n$$\n\\frac{dZ}{d\\xi} = -\\frac{\\alpha}{2} \\left[ 4Z(1-Z) \\right] = -2\\alpha Z(1-Z)\n$$\n现在，我们可以将 $\\chi$ 写成 $Z$ 的函数：\n$$\n\\chi(Z) = 2 D \\left| -2\\alpha Z(1-Z) \\right|^2 = 2 D \\left[ 4\\alpha^2 Z^2(1-Z)^2 \\right] = 8D\\alpha^2 Z^2(1-Z)^2\n$$\n化学计量表面处的标量耗散率 $\\chi_{st}$ 是通过在 $Z=Z_{st}$ 处求此表达式的值得到的：\n$$\n\\chi_{st} = 8D\\alpha^2 Z_{st}^2(1-Z_{st})^2\n$$\n我们需要计算比率 $R \\equiv \\frac{\\chi_{st}\\ \\text{（当}\\ Y_{F,O} = 0.02\\text{时})}{\\chi_{st}\\ \\text{（当}\\ Y_{F,O} = 0\\text{时})}$。使用 $\\chi_{st}$ 的表达式，并分别用下标 $b$ 和 $a$ 表示这两种情况：\n$$\nR = \\frac{8D\\alpha^2 Z_{st,b}^2(1-Z_{st,b})^2}{8D\\alpha^2 Z_{st,a}^2(1-Z_{st,a})^2}\n$$\n常数 $8D\\alpha^2$ 被抵消，因为它们保持不变：\n$$\nR = \\left( \\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\right)^2\n$$\n让我们为每种情况计算 $Z(1-Z)$ 项。\n对于情况 (a)：\n$$\nZ_{st,a}(1-Z_{st,a}) = \\frac{0.21}{4.21} \\left(1 - \\frac{0.21}{4.21}\\right) = \\frac{0.21}{4.21} \\left(\\frac{4.21-0.21}{4.21}\\right) = \\frac{0.21 \\times 4.00}{(4.21)^2} = \\frac{0.84}{(4.21)^2}\n$$\n对于情况 (b)：\n$$\nZ_{st,b}(1-Z_{st,b}) = \\frac{0.13}{4.13} \\left(1 - \\frac{0.13}{4.13}\\right) = \\frac{0.13}{4.13} \\left(\\frac{4.13-0.13}{4.13}\\right) = \\frac{0.13 \\times 4.00}{(4.13)^2} = \\frac{0.52}{(4.13)^2}\n$$\n现在我们计算这些项的比率：\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} = \\frac{0.52 / (4.13)^2}{0.84 / (4.21)^2} = \\frac{0.52}{0.84} \\times \\left(\\frac{4.21}{4.13}\\right)^2\n$$\n现在我们计算数值：\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\approx \\frac{0.52}{0.84} \\times (1.019370...)^2 \\approx 0.619047... \\times 1.039116... \\approx 0.643265...\n$$\n最后，我们将这个值平方来计算 $R$：\n$$\nR = (0.643265...)^2 \\approx 0.413790...\n$$\n四舍五入到四位有效数字，我们得到 $R \\approx 0.4138$。", "answer": "$$\\boxed{0.4138}$$", "id": "3318846"}, {"introduction": "当在大涡模拟（LES）中使用小火焰模型时，会出现代表湍流与化学反应之间亚格子尺度相互作用的未封闭项。对反应进度变量方差的生成项进行建模，对于准确捕捉部分预混火焰的传播至关重要。本练习 [@problem_id:3318856] 提供了推导和标定亚格子尺度封闭模型的实践经验，您将使用一个基于梯度的模型，并根据合成的直接数值模拟（DNS）数据对其系数进行标定，从而将理论建模与在高级CFD中的实际应用联系起来。", "problem": "您的任务是，使用基于火焰面 (flamelet-based) 的方法，为湍流反应流的大涡模拟 (Large-Eddy Simulation, LES) 推导、实现和标定一个用于 Favre 滤波的进度变量方差生成的子网格模型。考虑进度变量被定义为产物质量分数的归一化线性组合，用 $c$ 表示，其中 $0 \\le c \\le 1$，其反应源项用 $\\dot{\\omega}_c$ 表示。在基于火焰面的建模框架中，滤波后的源项 $\\tilde{\\dot{\\omega}}_c$ 是通过查阅预先计算的层流稳态火焰面库获得的，作为混合分数及其矩的函数；然而，在本问题中，所需的滤波后梯度是直接给出的。\n\n从 $c$ 的滤波 (Favre) 方差开始，记为 $\\widetilde{c''^2}$，其中 $c'' = c - \\tilde{c}$ 表示 $c$ 的 Favre 脉动。方差生成的一个贡献项来自 $c$ 和 $\\dot{\\omega}_c$ 之间的协方差，即 $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$。对 $c$ 和 $\\dot{\\omega}_c$ 之间的未解析协方差使用形式如下的广义梯度模型\n$$\n\\tau(c,\\dot{\\omega}_c) \\equiv \\widetilde{c \\, \\dot{\\omega}_c} - \\tilde{c} \\, \\tilde{\\dot{\\omega}}_c \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c,\n$$\n其中 $C_g$ 是一个待标定的未知无量纲模型系数，$\\Delta$ 是 LES 滤波器宽度 (单位为 $\\mathrm{m}$)，重复的下标表示求和。假设密度变化适中，因此对于给定的数据集，Favre 协方差和 Reynolds 协方差近似相等，并且分子输运效应不显式地进入当前的标定过程。\n\n您的任务是：\n1. 推导由子网格热释放引起的方差生成项 $P_\\omega$ 的模型表达式，用 $C_g$、$\\Delta$、$\\nabla \\tilde{c}$ 和 $\\nabla \\tilde{\\dot{\\omega}}_c$ 表示。明确说明 $P_\\omega$ 的单位。\n2. 通过最小化直接数值模拟 (DNS, Direct Numerical Simulation) 对 $\\tau(c,\\dot{\\omega}_c)$ 的估计值与广义梯度模型预测值 $C_g \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ 之间的均方误差来标定 $C_g$。使用以下标定数据集，该数据集代表了在不同 $\\Delta$ 下滤波的引燃射流火焰 DNS 数据：\n   - 情况 $\\#1$：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.6666666666666668 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 $\\#2$：$\\Delta = 1.5 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [800, \\, 600, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 30, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.0875 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 $\\#3$：$\\Delta = 0.8 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [-500, \\, 400, \\, 100] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, -120, \\, 40] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = -7.68 \\times 10^{-3} \\ \\mathrm{s}^{-1}$。\n   - 情况 $\\#4$：$\\Delta = 1.2 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [0, \\, 1000, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 100, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = 1.2 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n   - 情况 $\\#5$：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [300, \\, -400, \\, 500] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [-150, \\, 200, \\, -250] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$，$\\tau_{\\mathrm{DNS}} = -2.0833333333333334 \\times 10^{-2} \\ \\mathrm{s}^{-1}$。\n3. 标定 $C_g$ 后，对以下每个测试用例预测生成项 $P_\\omega$。将所有最终结果以浮点数形式表示，单位为 $\\mathrm{s}^{-1}$。\n   - 测试 $\\#\\mathrm{A}$ (正常路径)：$\\Delta = 1.1 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [700, \\, 200, \\, 100] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [70, \\, 40, \\, 10] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 $\\#\\mathrm{B}$ (边界，零源项梯度)：$\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 $\\#\\mathrm{C}$ (反向对齐梯度)：$\\Delta = 0.9 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [400, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [-100, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n   - 测试 $\\#\\mathrm{D}$ (滤波器宽度缩放)：$\\Delta = 2.0 \\times 10^{-3} \\ \\mathrm{m}$，$\\nabla \\tilde{c} = [500, \\, 500, \\, 0] \\ \\mathrm{m}^{-1}$，$\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 50, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$。\n\n实现要求：\n- 您的程序必须根据标定集计算最小二乘估计值 $C_g^\\star$，然后为每个测试用例计算 $P_\\omega = 2 \\, C_g^\\star \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$。\n- 此问题不涉及角度。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 分别是测试 $\\#\\mathrm{A}$ 到测试 $\\#\\mathrm{D}$ 的预测 $P_\\omega$ 值，单位为 $\\mathrm{s}^{-1}$。\n\n测试套件覆盖范围说明：\n- 测试 $\\#\\mathrm{A}$ 是一个通用的非退化配置。\n- 测试 $\\#\\mathrm{B}$ 强制了当 $\\nabla \\tilde{\\dot{\\omega}}_c$ 为零时生成项为零的边界条件。\n- 测试 $\\#\\mathrm{C}$ 检查对于反向对齐梯度的符号敏感性。\n- 测试 $\\#\\mathrm{D}$ 检验模型预测的 $\\Delta^2$ 缩放关系。\n\n所有物理量必须使用国际单位制 (SI) 处理，最终输出的单位必须是 $\\mathrm{s}^{-1}$。", "solution": "### 第 1 部分：方差生成模型的推导\n\n该问题涉及为 Favre 滤波的进度变量方差 $\\widetilde{c''^2}$ 的输运方程中的一个项进行建模。我们感兴趣的项是由化学源项引起的方差生成，我们将其表示为 $P_\\omega$。该项由 $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$ 给出。\n\n进度变量 $c$ 的 Favre 脉动定义为 $c'' = c - \\tilde{c}$。类似地，对于源项 $\\dot{\\omega}_c$，我们有 $\\dot{\\omega}_c'' = \\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c$。项 $\\widetilde{c'' \\dot{\\omega}_c''}$ 代表了 $c$ 和 $\\dot{\\omega}_c$ 脉动的 Favre 滤波协方差。它可以展开为：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{(c - \\tilde{c})(\\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c)} = \\widetilde{c \\dot{\\omega}_c - c \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\dot{\\omega}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c}\n$$\n利用滤波算子的线性和对于任意量 $A$ 和 $B$ 都具有 $\\widetilde{\\tilde{A} B} = \\tilde{A} \\tilde{B}$ 的性质，我们可以简化该表达式：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{c \\dot{\\omega}_c} - \\widetilde{c \\tilde{\\dot{\\omega}}_c} - \\widetilde{\\tilde{c} \\dot{\\omega}_c} + \\widetilde{\\tilde{c} \\tilde{\\dot{\\omega}}_c} = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\tilde{\\dot{\\omega}}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c\n$$\n这个结果表达式恰好是为未解析协方差 $\\tau(c, \\dot{\\omega}_c)$ 提供的定义。因此，我们有以下恒等式：\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\tau(c, \\dot{\\omega}_c)\n$$\n因此，方差生成项为 $P_\\omega = 2 \\, \\tau(c, \\dot{\\omega}_c)$。\n\n问题为 $\\tau(c, \\dot{\\omega}_c)$ 提供了一个广义梯度模型：\n$$\n\\tau(c, \\dot{\\omega}_c) \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c = C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n其中 $C_g$ 是一个无量纲模型系数，$\\Delta$ 是滤波器宽度，梯度是针对滤波后物理量的。\n\n将此模型代入 $P_\\omega$ 的表达式，我们得到方差生成的最终模型表达式：\n$$\nP_\\omega \\approx 2 \\, C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n\n为确定 $P_\\omega$ 的单位，我们分析表达式中每一项的单位：\n- $C_g$: 无量纲。\n- $\\Delta$: $\\mathrm{m}$，所以 $\\Delta^2$: $\\mathrm{m}^2$。\n- 进度变量 $\\tilde{c}$ 是无量纲的，所以其梯度 $\\nabla \\tilde{c}$ 的单位是 $\\mathrm{m}^{-1}$。\n- 源项 $\\tilde{\\dot{\\omega}}_c$ 是一个速率，单位为 $\\mathrm{s}^{-1}$，所以其梯度 $\\nabla \\tilde{\\dot{\\omega}}_c$ 的单位是 $\\mathrm{m}^{-1} \\mathrm{s}^{-1}$。\n- 点积 $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ 的单位是 $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^{-1} \\mathrm{s}^{-1}) = \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n\n因此 $P_\\omega$ 的单位是 $(\\mathrm{m}^2) \\cdot (\\mathrm{m}^{-2} \\mathrm{s}^{-1}) = \\mathrm{s}^{-1}$。\n\n### 第 2 部分：模型系数 $C_g$ 的标定\n\n系数 $C_g$ 通过最小化协方差的 DNS 数据 $\\tau_{\\mathrm{DNS}}$ 与模型预测值 $\\tau_{\\text{model}} = C_g \\, M$ 之间的平方误差和来标定，其中对于每个标定情况 $i$，$M_i = \\Delta_i^2 \\, (\\nabla \\tilde{c}_i \\cdot \\nabla \\tilde{\\dot{\\omega}}_{c,i})$。\n平方误差和为 $S = \\sum_{i=1}^{N} (\\tau_{\\mathrm{DNS}, i} - C_g M_i)^2$。为了最小化 $S$ 关于 $C_g$ 的值，我们将其导数设为零：\n$$\n\\frac{dS}{dC_g} = \\sum_{i=1}^{N} 2 (\\tau_{\\mathrm{DNS}, i} - C_g M_i) (-M_i) = 0\n$$\n解出最优系数 $C_g^\\star$：\n$$\nC_g^\\star = \\frac{\\sum_{i=1}^{N} \\tau_{\\mathrm{DNS}, i} M_i}{\\sum_{i=1}^{N} M_i^2}\n$$\n我们首先为 $N=5$ 个标定情况中的每一个计算 $M_i$ 的值。\n- 情况 1：$M_1 = (1.0 \\times 10^{-3})^2 (1000 \\cdot 200) = 10^{-6} \\cdot 2 \\times 10^5 = 0.2 \\, \\mathrm{s}^{-1}$。\n- 情况 2：$M_2 = (1.5 \\times 10^{-3})^2 (800 \\cdot 50 + 600 \\cdot 30) = 2.25 \\times 10^{-6} \\cdot 58000 = 0.1305 \\, \\mathrm{s}^{-1}$。\n- 情况 3：$M_3 = (0.8 \\times 10^{-3})^2 (-500 \\cdot 200 + 400 \\cdot (-120) + 100 \\cdot 40) = 0.64 \\times 10^{-6} \\cdot (-144000) = -0.09216 \\, \\mathrm{s}^{-1}$。\n- 情况 4：$M_4 = (1.2 \\times 10^{-3})^2 (1000 \\cdot 100) = 1.44 \\times 10^{-6} \\cdot 10^5 = 0.144 \\, \\mathrm{s}^{-1}$。\n- 情况 5：$M_5 = (1.0 \\times 10^{-3})^2 (300 \\cdot (-150) - 400 \\cdot 200 + 500 \\cdot (-250)) = 10^{-6} \\cdot (-250000) = -0.25 \\, \\mathrm{s}^{-1}$。\n\n经过检查可以发现，所提供的 DNS 数据 $\\tau_{\\mathrm{DNS},i}$ 与模型预测值在常数系数 $C_g = 1/12 \\approx 0.08333...$ 下完全对应：\n- 情况 1：$(1/12) M_1 = 0.2/12 = 1/60 \\approx 0.01666...$，与 $\\tau_{\\mathrm{DNS},1}$ 匹配。\n- 情况 2：$(1/12) M_2 = 0.1305/12 = 0.010875$，与 $\\tau_{\\mathrm{DNS},2}$ 匹配。\n- 情况 3：$(1/12) M_3 = -0.09216/12 = -0.00768$，与 $\\tau_{\\mathrm{DNS},3}$ 匹配。\n- 情况 4：$(1/12) M_4 = 0.144/12 = 0.012$，与 $\\tau_{\\mathrm{DNS},4}$ 匹配。\n- 情况 5：$(1/12) M_5 = -0.25/12 = -1/48 \\approx -0.020833...$，与 $\\tau_{\\mathrm{DNS},5}$ 匹配。\n由于对于每个数据点，当 $C_g = 1/12$ 时误差为零，因此最小二乘法最小化过程将精确地得到这个值。所以，$C_g^\\star = 1/12$。\n\n### 第 3 部分：对测试用例的方差生成进行预测\n\n使用标定后的系数 $C_g^\\star = 1/12$，方差生成的模型为：\n$$\nP_\\omega = 2 \\cdot \\frac{1}{12} \\cdot \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c) = \\frac{1}{6} \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n我们将此公式应用于每个测试用例。\n- **测试 A**：\n  - $\\Delta^2 = (1.1 \\times 10^{-3})^2 = 1.21 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (700 \\cdot 70 + 200 \\cdot 40 + 100 \\cdot 10) = 49000 + 8000 + 1000 = 58000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,A} = \\frac{1}{6} (1.21 \\times 10^{-6})(58000) = \\frac{0.07018}{6} \\approx 0.0116966... \\, \\mathrm{s}^{-1}$。\n\n- **测试 B**：\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (1000 \\cdot 0) = 0$。\n  - $P_{\\omega,B} = 0 \\, \\mathrm{s}^{-1}$。\n\n- **测试 C**：\n  - $\\Delta^2 = (0.9 \\times 10^{-3})^2 = 0.81 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (400 \\cdot (-100)) = -40000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,C} = \\frac{1}{6} (0.81 \\times 10^{-6})(-40000) = \\frac{-0.0324}{6} = -0.0054 \\, \\mathrm{s}^{-1}$。\n\n- **测试 D**：\n  - $\\Delta^2 = (2.0 \\times 10^{-3})^2 = 4.0 \\times 10^{-6} \\, \\mathrm{m}^2$。\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (500 \\cdot 50 + 500 \\cdot 50) = 25000 + 25000 = 50000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$。\n  - $P_{\\omega,D} = \\frac{1}{6} (4.0 \\times 10^{-6})(50000) = \\frac{0.2}{6} = \\frac{1}{30} \\approx 0.033333... \\, \\mathrm{s}^{-1}$。\n\n下面的代码将以编程方式执行这些计算。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, calibrates, and applies a subgrid model for progress-variable\n    variance production in LES of turbulent combustion.\n    \"\"\"\n\n    # ----------------------------------------------------------------------\n    # Part 1: Calibration of the model coefficient C_g\n    # ----------------------------------------------------------------------\n\n    # The model for the unresolved covariance is:\n    # tau_model = Cg * M, where M = Delta^2 * (grad(c) . grad(omega_c))\n    # We calibrate Cg using the provided DNS dataset.\n\n    calibration_cases = [\n        # (Delta, grad_c, grad_omega_c, tau_dns)\n        (1.0e-3, np.array([1000, 0, 0]), np.array([200, 0, 0]), 1.6666666666666668e-2),\n        (1.5e-3, np.array([800, 600, 0]), np.array([50, 30, 0]), 1.0875e-2),\n        (0.8e-3, np.array([-500, 400, 100]), np.array([200, -120, 40]), -7.68e-3),\n        (1.2e-3, np.array([0, 1000, 0]), np.array([0, 100, 0]), 1.2e-2),\n        (1.0e-3, np.array([300, -400, 500]), np.array([-150, 200, -250]), -2.0833333333333334e-2),\n    ]\n\n    M_cal = []\n    tau_dns_cal = []\n\n    for case in calibration_cases:\n        delta, grad_c, grad_omega_c, tau_dns = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        M = delta**2 * dot_product\n        M_cal.append(M)\n        tau_dns_cal.append(tau_dns)\n\n    M_cal_vec = np.array(M_cal)\n    tau_dns_cal_vec = np.array(tau_dns_cal)\n\n    # The optimal coefficient Cg* is found by minimizing the sum of\n    # squared errors, leading to the least-squares formula:\n    # Cg* = sum(tau_i * M_i) / sum(M_i^2)\n    # Using np.dot for vectorized summation.\n    sum_tau_M = np.dot(tau_dns_cal_vec, M_cal_vec)\n    sum_M_sq = np.dot(M_cal_vec, M_cal_vec)\n\n    # Since the data is noise-free, any non-zero M_i can determine Cg.\n    # Cg_star = tau_dns_cal_vec[0] / M_cal_vec[0]\n    # For robustness and generality, use the least-squares formula.\n    if sum_M_sq == 0:\n        # Avoid division by zero, although not expected for this dataset\n        Cg_star = 0.0\n    else:\n        Cg_star = sum_tau_M / sum_M_sq\n\n    # ----------------------------------------------------------------------\n    # Part 2: Prediction for the test cases\n    # ----------------------------------------------------------------------\n    \n    # The production term model is P_omega = 2 * Cg* * Delta^2 * (grad(c) . grad(omega_c))\n    \n    test_cases = [\n        # (Delta, grad_c, grad_omega_c)\n        (1.1e-3, np.array([700, 200, 100]), np.array([70, 40, 10])), # Test A\n        (1.0e-3, np.array([1000, 0, 0]), np.array([0, 0, 0])),        # Test B\n        (0.9e-3, np.array([400, 0, 0]), np.array([-100, 0, 0])),      # Test C\n        (2.0e-3, np.array([500, 500, 0]), np.array([50, 50, 0])),       # Test D\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, grad_c, grad_omega_c = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        \n        # P_omega = 2 * Cg_star * M\n        M = delta**2 * dot_product\n        p_omega = 2.0 * Cg_star * M\n        results.append(p_omega)\n    \n    # Format the final output as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    # This print statement is for verification; the final answer is returned.\n    # print(output_str)\n\nsolve()\n```", "answer": "[0.011696666666666668,0.0,-0.0054,0.03333333333333333]", "id": "3318856"}]}