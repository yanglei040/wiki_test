{"hands_on_practices": [{"introduction": "理解Oldroyd-B模型独特的流变学预测是至关重要的第一步。本练习聚焦于在简单剪切流中分析推导第一和第二法向应力差，这是粘弹性流体的一个标志性行为，而在牛顿流体中则不存在。通过完成这个基础练习[@problem_id:3388262]，您将直接洞察该模型的数学结构如何引出关键的非牛顿现象。", "problem": "考虑在简单剪切流中，由 Oldroyd–B 本构框架建模的均匀、不可压缩粘弹性流体。其速度场由 $\\boldsymbol{v} = (\\dot{\\gamma} y,\\, 0,\\, 0)$ 给出，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。Oldroyd–B 流体由粘度为 $\\eta_{s}$ 的牛顿溶剂和由胡克哑铃描述的聚合物贡献组成，其松弛时间为 $\\lambda_{1}$，聚合物粘度为 $\\eta_{p}$。总附加应力为 $\\boldsymbol{\\tau} = \\boldsymbol{\\tau}_{s} + \\boldsymbol{\\tau}_{p}$，其中溶剂应力为 $\\boldsymbol{\\tau}_{s} = 2 \\eta_{s} \\boldsymbol{D}$，$\\boldsymbol{D} = \\frac{1}{2}\\left( \\nabla \\boldsymbol{v} + (\\nabla \\boldsymbol{v})^{\\top} \\right)$，聚合物应力通过 $\\boldsymbol{\\tau}_{p} = \\frac{\\eta_{p}}{\\lambda_{1}}(\\boldsymbol{C} - \\boldsymbol{I})$ 与聚合物构象张量 $\\boldsymbol{C}$ 相关。$\\boldsymbol{C}$ 的演化由上随流导数方程控制\n$$\n\\frac{\\partial \\boldsymbol{C}}{\\partial t} + \\boldsymbol{v} \\cdot \\nabla \\boldsymbol{C} - \\nabla \\boldsymbol{v} \\cdot \\boldsymbol{C} - \\boldsymbol{C} \\cdot (\\nabla \\boldsymbol{v})^{\\top} = -\\frac{1}{\\lambda_{1}}(\\boldsymbol{C} - \\boldsymbol{I}),\n$$\n其中 $\\boldsymbol{I}$ 是单位张量。在稳态、均匀的简单剪切流中，定义第一和第二法向应力差为 $N_{1} = \\tau_{xx} - \\tau_{yy}$ 和 $N_{2} = \\tau_{yy} - \\tau_{zz}$。从所给的控制方程出发，推导 Oldroyd–B 流体中 $N_{1}$ 和 $N_{2}$ 关于 $\\eta_{s}$、$\\eta_{p}$、$\\lambda_{1}$ 和 $\\dot{\\gamma}$ 的闭合形式表达式，并阐明您使用的任何假设。您的最终答案必须是单个解析表达式或包含 $N_{1}$ 和 $N_{2}$ 的行矩阵。无需四舍五入，且最终答案框中不应包含单位。如果您同时提供 $N_{1}$ 和 $N_{2}$，请按 $\\left(N_{1},\\, N_{2}\\right)$ 的顺序列为行矩阵。", "solution": "该问题要求推导在稳态、均匀简单剪切流中 Oldroyd–B 流体的第一和第二法向应力差 $N_{1}$ 和 $N_{2}$。推导过程从所提供的基本方程开始。\n\n首先，我们建立给定简单剪切流的运动学张量。速度场为 $\\boldsymbol{v} = (\\dot{\\gamma} y,\\, 0,\\, 0)$，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。速度梯度张量 $\\nabla \\boldsymbol{v}$ 在笛卡尔坐标系下由下式给出：\n$$\n\\nabla \\boldsymbol{v} = \n\\begin{pmatrix} \n\\frac{\\partial v_x}{\\partial x}  \\frac{\\partial v_x}{\\partial y}  \\frac{\\partial v_x}{\\partial z} \\\\\n\\frac{\\partial v_y}{\\partial x}  \\frac{\\partial v_y}{\\partial y}  \\frac{\\partial v_y}{\\partial z} \\\\\n\\frac{\\partial v_z}{\\partial x}  \\frac{\\partial v_z}{\\partial y}  \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n= \n\\begin{pmatrix} \n0  \\dot{\\gamma}  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n应变率张量 $\\boldsymbol{D}$ 定义为 $\\boldsymbol{D} = \\frac{1}{2}\\left( \\nabla \\boldsymbol{v} + (\\nabla \\boldsymbol{v})^{\\top} \\right)$。使用速度梯度张量及其转置，我们得到：\n$$\n\\boldsymbol{D} = \\frac{1}{2} \\left( \n\\begin{pmatrix} \n0  \\dot{\\gamma}  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n+\n\\begin{pmatrix} \n0  0  0 \\\\\n\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\right) = \\frac{1}{2}\n\\begin{pmatrix} \n0  \\dot{\\gamma}  0 \\\\\n\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\n接下来，我们确定聚合物构象张量 $\\boldsymbol{C}$。其演化由以下方程控制：\n$$\n\\frac{\\partial \\boldsymbol{C}}{\\partial t} + \\boldsymbol{v} \\cdot \\nabla \\boldsymbol{C} - \\nabla \\boldsymbol{v} \\cdot \\boldsymbol{C} - \\boldsymbol{C} \\cdot (\\nabla \\boldsymbol{v})^{\\top} = -\\frac{1}{\\lambda_{1}}(\\boldsymbol{C} - \\boldsymbol{I})\n$$\n问题指定了稳态流，因此所有时间导数均为零：$\\frac{\\partial \\boldsymbol{C}}{\\partial t} = \\boldsymbol{0}$。流场也是均匀的，这意味着物理量不随位置变化。因此，构象张量的空间梯度为零：$\\nabla \\boldsymbol{C} = \\boldsymbol{0}$。这将平流项简化为 $\\boldsymbol{v} \\cdot \\nabla \\boldsymbol{C} = \\boldsymbol{0}$。\n因此，演化方程简化为关于 $\\boldsymbol{C}$ 的一个代数方程：\n$$\n- \\nabla \\boldsymbol{v} \\cdot \\boldsymbol{C} - \\boldsymbol{C} \\cdot (\\nabla \\boldsymbol{v})^{\\top} = -\\frac{1}{\\lambda_{1}}(\\boldsymbol{C} - \\boldsymbol{I})\n$$\n两边乘以 $-\\lambda_{1}$ 并重新整理，得到：\n$$\n\\boldsymbol{C} - \\boldsymbol{I} = \\lambda_{1} \\left( \\nabla \\boldsymbol{v} \\cdot \\boldsymbol{C} + \\boldsymbol{C} \\cdot (\\nabla \\boldsymbol{v})^{\\top} \\right)\n$$\n我们现在求解对称张量 $\\boldsymbol{C} = \\begin{pmatrix} C_{xx}  C_{xy}  C_{xz} \\\\ C_{xy}  C_{yy}  C_{yz} \\\\ C_{xz}  C_{yz}  C_{zz} \\end{pmatrix}$ 的分量。右侧项计算如下：\n$$\n\\nabla \\boldsymbol{v} \\cdot \\boldsymbol{C} + \\boldsymbol{C} \\cdot (\\nabla \\boldsymbol{v})^{\\top} = \n\\begin{pmatrix} \n0  \\dot{\\gamma}  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\begin{pmatrix} \nC_{xx}  C_{xy}  C_{xz} \\\\ \nC_{xy}  C_{yy}  C_{yz} \\\\ \nC_{xz}  C_{yz}  C_{zz} \n\\end{pmatrix}\n+\n\\begin{pmatrix} \nC_{xx}  C_{xy}  C_{xz} \\\\ \nC_{xy}  C_{yy}  C_{yz} \\\\ \nC_{xz}  C_{yz}  C_{zz} \n\\end{pmatrix}\n\\begin{pmatrix} \n0  0  0 \\\\\n\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n$$\n= \n\\begin{pmatrix} \n\\dot{\\gamma} C_{xy}  \\dot{\\gamma} C_{yy}  \\dot{\\gamma} C_{yz} \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n+\n\\begin{pmatrix} \n\\dot{\\gamma} C_{xy}  0  0 \\\\\n\\dot{\\gamma} C_{yy}  0  0 \\\\\n\\dot{\\gamma} C_{yz}  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix} \n2\\dot{\\gamma} C_{xy}  \\dot{\\gamma} C_{yy}  \\dot{\\gamma} C_{yz} \\\\\n\\dot{\\gamma} C_{yy}  0  0 \\\\\n\\dot{\\gamma} C_{yz}  0  0\n\\end{pmatrix}\n$$\n将此代入关于 $\\boldsymbol{C}$ 的代数方程，得到：\n$$\n\\begin{pmatrix} \nC_{xx}-1  C_{xy}  C_{xz} \\\\ \nC_{xy}  C_{yy}-1  C_{yz} \\\\ \nC_{xz}  C_{yz}  C_{zz}-1 \n\\end{pmatrix}\n= \\lambda_{1}\n\\begin{pmatrix} \n2\\dot{\\gamma} C_{xy}  \\dot{\\gamma} C_{yy}  \\dot{\\gamma} C_{yz} \\\\\n\\dot{\\gamma} C_{yy}  0  0 \\\\\n\\dot{\\gamma} C_{yz}  0  0\n\\end{pmatrix}\n$$\n令各分量相等，得到一个方程组：\n由 $(y,z)$ 和 $(z,z)$ 分量可得：\n$C_{yz} = \\lambda_{1} (0) \\implies C_{yz} = 0$。\n$C_{zz}-1 = \\lambda_{1} (0) \\implies C_{zz} = 1$。\n由 $(x,z)$ 分量可得：\n$C_{xz} = \\lambda_{1} (\\dot{\\gamma} C_{yz})$。由于 $C_{yz}=0$，我们得到 $C_{xz} = 0$。\n由 $(y,y)$ 分量可得：\n$C_{yy}-1 = \\lambda_{1} (0) \\implies C_{yy} = 1$。\n由 $(x,y)$ 分量可得：\n$C_{xy} = \\lambda_{1} (\\dot{\\gamma} C_{yy})$。由于 $C_{yy}=1$，我们得到 $C_{xy} = \\lambda_{1} \\dot{\\gamma}$。\n由 $(x,x)$ 分量可得：\n$C_{xx}-1 = \\lambda_{1} (2\\dot{\\gamma} C_{xy})$。代入 $C_{xy} = \\lambda_{1} \\dot{\\gamma}$，我们得到 $C_{xx}-1 = 2\\lambda_{1}\\dot{\\gamma}(\\lambda_{1}\\dot{\\gamma}) = 2\\lambda_{1}^2\\dot{\\gamma}^2$。\n因此，$C_{xx} = 1 + 2\\lambda_{1}^2\\dot{\\gamma}^2$。\n\n构象张量为：\n$$\n\\boldsymbol{C} = \n\\begin{pmatrix} \n1 + 2\\lambda_{1}^2\\dot{\\gamma}^2  \\lambda_{1}\\dot{\\gamma}  0 \\\\ \n\\lambda_{1}\\dot{\\gamma}  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n现在我们计算应力贡献。聚合物应力 $\\boldsymbol{\\tau}_{p}$ 为：\n$$\n\\boldsymbol{\\tau}_{p} = \\frac{\\eta_{p}}{\\lambda_{1}}(\\boldsymbol{C} - \\boldsymbol{I}) = \\frac{\\eta_{p}}{\\lambda_{1}} \n\\begin{pmatrix} \n2\\lambda_{1}^2\\dot{\\gamma}^2  \\lambda_{1}\\dot{\\gamma}  0 \\\\ \n\\lambda_{1}\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n= \n\\begin{pmatrix} \n2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2  \\eta_{p}\\dot{\\gamma}  0 \\\\ \n\\eta_{p}\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n溶剂应力 $\\boldsymbol{\\tau}_{s}$ 为：\n$$\n\\boldsymbol{\\tau}_{s} = 2 \\eta_{s} \\boldsymbol{D} = 2 \\eta_{s} \\left(\\frac{1}{2}\n\\begin{pmatrix} \n0  \\dot{\\gamma}  0 \\\\ \n\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n\\right) = \n\\begin{pmatrix} \n0  \\eta_{s}\\dot{\\gamma}  0 \\\\ \n\\eta_{s}\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n总附加应力张量 $\\boldsymbol{\\tau}$ 是 $\\boldsymbol{\\tau}_{s}$ 和 $\\boldsymbol{\\tau}_{p}$ 的和：\n$$\n\\boldsymbol{\\tau} = \n\\begin{pmatrix} \n0  \\eta_{s}\\dot{\\gamma}  0 \\\\ \n\\eta_{s}\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n+\n\\begin{pmatrix} \n2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2  \\eta_{p}\\dot{\\gamma}  0 \\\\ \n\\eta_{p}\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n=\n\\begin{pmatrix} \n2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2  (\\eta_{s}+\\eta_{p})\\dot{\\gamma}  0 \\\\ \n(\\eta_{s}+\\eta_{p})\\dot{\\gamma}  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n总应力的分量为 $\\tau_{xx} = 2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2$，$\\tau_{yy} = 0$ 和 $\\tau_{zz} = 0$。\n\n最后，我们使用其定义来计算法向应力差：\n第一法向应力差 $N_{1}$：\n$$\nN_{1} = \\tau_{xx} - \\tau_{yy} = 2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2 - 0 = 2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^2\n$$\n第二法向应力差 $N_{2}$：\n$$\nN_{2} = \\tau_{yy} - \\tau_{zz} = 0 - 0 = 0\n$$\nOldroyd-B 模型预测了在剪切速率上呈二次关系的非零第一法向应力差，以及零值的第二法向应力差，这些是其在简单剪切流中的特征。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\eta_{p}\\lambda_{1}\\dot{\\gamma}^{2}  0\n\\end{pmatrix}\n}\n$$", "id": "3388262"}, {"introduction": "一个有效的本构模型必须在适当的物理极限下与更简单、已建立的模型保持一致。本练习[@problem_id:3388289]提供了一个动手实践的数值任务，以验证Oldroyd-B模型在流体弹性特性消失时能正确收敛到牛顿流体行为。通过为聚合物应力张量实现一个求解器，您将探索这种极限行为，并培养将理论概念转化为计算验证的技能。", "problem": "考虑由 Oldroyd-B 本构模型描述的不可压缩粘弹性流体。令 $\\boldsymbol{u}(\\boldsymbol{x})$ 表示速度场，$\\boldsymbol{D} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$ 为形变率张量，并将总额外应力分解为溶剂部分和聚合物部分。Oldroyd-B 聚合物应力 $\\boldsymbol{\\tau}_p$ 由上随体 Maxwell (UCM) 关系式控制，对于定常流，该关系式为\n$$\n\\boldsymbol{\\tau}_p + \\lambda \\left( \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{\\tau}_p - (\\nabla \\boldsymbol{u}) \\boldsymbol{\\tau}_p - \\boldsymbol{\\tau}_p (\\nabla \\boldsymbol{u})^{\\top} \\right) = 2 \\eta_p \\boldsymbol{D},\n$$\n其中 $\\lambda$ 是松弛时间，$\\eta_p$ 是聚合物粘度，满足 $\\eta_p = (1-\\beta)\\,\\eta$，$\\beta \\in (0,1]$ 为溶剂粘度分数，$\\eta = \\eta_s + \\eta_p$ 为总粘度。在极限情况 $\\beta \\to 1$ 和 $\\lambda \\to 0$ 下，聚合物应力应趋于零，流体行为应退化为牛顿溶剂行为。\n\n您的任务是，对于具有恒定速度梯度的定常均匀流，当 $\\beta \\to 1$ 和 $\\lambda \\to 0$ 时，实现一个数值验证，证明聚合物应力在空间域 $\\Omega$ 上一致收敛于 $\\boldsymbol{\\tau}_p \\to \\boldsymbol{0}$。使用以下科学合理的设置：\n\n- 区域：$\\Omega = [0,1]\\times[0,1]$（单位：米），离散到至少 $16\\times 16$ 个点的任意均匀网格上以评估一致性。由于速度梯度是恒定的，解在空间上是均匀的；尽管如此，仍需在网格上计算聚合物应力，并取所有网格点的上确界范数以显式评估一致收敛性。\n- 物理参数：总粘度 $\\eta = 1\\,\\text{Pa}\\cdot\\text{s}$，简单剪切流的剪切速率 $\\dot{\\gamma} = 1\\,\\text{s}^{-1}$，平面拉伸流的拉伸速率 $\\epsilon = 0.5\\,\\text{s}^{-1}$。\n- 待分析的流场：\n  1. 简单剪切流：$\\boldsymbol{u}(x,y) = (\\dot{\\gamma} y, 0)$，因此 $\\nabla \\boldsymbol{u} = \\begin{pmatrix} 0  \\dot{\\gamma} \\\\ 0  0 \\end{pmatrix}$ 且 $\\boldsymbol{D} = \\frac{1}{2}\\begin{pmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{pmatrix}$。\n  2. 平面拉伸流：$\\boldsymbol{u}(x,y) = (\\epsilon x, -\\epsilon y)$，因此 $\\nabla \\boldsymbol{u} = \\begin{pmatrix} \\epsilon  0 \\\\ 0  -\\epsilon \\end{pmatrix}$ 且 $\\boldsymbol{D} = \\begin{pmatrix} \\epsilon  0 \\\\ 0  -\\epsilon \\end{pmatrix}$。\n\n对于每种流场，从上述定常 UCM 定义出发，在 $\\nabla \\boldsymbol{u}$ 恒定和 $\\boldsymbol{\\tau}_p$ 空间均匀的假设下，推导出一个关于 $\\boldsymbol{\\tau}_p$ 的线性矩阵方程，形式如下\n$$\n\\boldsymbol{\\tau}_p - \\lambda \\left( (\\nabla \\boldsymbol{u})\\, \\boldsymbol{\\tau}_p + \\boldsymbol{\\tau}_p\\, (\\nabla \\boldsymbol{u})^{\\top} \\right) = 2 \\eta_p \\boldsymbol{D}.\n$$\n然后，通过使用适用于矩阵的向量化方法，将此 $2\\times 2$ 线性矩阵方程转换为一个 $4\\times 4$ 线性系统，并为此系统实现一个求解器（您必须自行推导此变换）。对于每对参数，在网格上评估 $\\boldsymbol{\\tau}_p$，计算每个网格点上的 Frobenius 范数，并报告在 $\\Omega$ 上的上确界。所有报告的应力量级均以帕斯卡 (Pascal) 为单位表示。\n\n设计一套参数值测试用例，用于探究极限 $\\beta \\to 1$ 和 $\\lambda \\to 0$ 以及边界情况：\n\n- 在所有情况下，使用固定的总粘度 $\\eta = 1\\,\\text{Pa}\\cdot\\text{s}$。对于每种情况，设置 $\\eta_p = (1-\\beta)\\eta$。\n- 对于简单剪切流，评估以下 $(\\beta,\\lambda)$ 对的 $\\|\\boldsymbol{\\tau}_p\\|_F$ 的上确界：\n  1. $(\\beta,\\lambda) = (0.8, 0.2\\,\\text{s})$ (一般情况)。\n  2. $(\\beta,\\lambda) = (0.999, 0.001\\,\\text{s})$ (趋近极限)。\n  3. $(\\beta,\\lambda) = (0.9999, 10^{-4}\\,\\text{s})$ (更接近极限)。\n  4. $(\\beta,\\lambda) = (1.0, 0.0\\,\\text{s})$ (精确极限情况)。\n  5. $(\\beta,\\lambda) = (0.8, 0.0\\,\\text{s})$ (边界情况，表明仅 $\\lambda \\to 0$ 并不意味着 $\\boldsymbol{\\tau}_p \\to \\boldsymbol{0}$，除非 $\\beta \\to 1$）。\n- 对于平面拉伸流，评估以下 $(\\beta,\\lambda)$ 对的 $\\|\\boldsymbol{\\tau}_p\\|_F$ 的上确界：\n  6. $(\\beta,\\lambda) = (0.8, 0.2\\,\\text{s})$ (一般情况)。\n  7. $(\\beta,\\lambda) = (0.999, 0.001\\,\\text{s})$ (趋近极限)。\n  8. $(\\beta,\\lambda) = (0.9999, 10^{-4}\\,\\text{s})$ (更接近极限)。\n  9. $(\\beta,\\lambda) = (1.0, 0.0\\,\\text{s})$ (精确极限情况)。\n  10. $(\\beta,\\lambda) = (0.8, 0.0\\,\\text{s})$ (与上述相同的边界情况)。\n\n您的程序必须为这 10 个测试用例中的每一个计算 Frobenius 范数 $\\|\\boldsymbol{\\tau}_p(\\boldsymbol{x})\\|_F$ 在 $\\Omega$ 上的上确界范数，并以帕斯卡为单位报告这些值，四舍五入到八位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,...,result10]”）。结果必须按照上面列出的测试用例的顺序排列（首先是五个简单剪切流的案例，然后是五个平面拉伸流的案例）。", "solution": "用户提供的问题经评估有效。它在科学上基于连续介质力学和计算流体动力学的原理，特别是关于 Oldroyd-B 本构模型。该问题是适定的、客观的且自洽的，提供了所有必要的物理参数、方程和边界条件，以得出一个唯一的、有意义的解。其中没有矛盾、歧义或不科学的前提。\n\n求解过程如下：首先，针对指定的流动条件，简化聚合物应力张量的控制方程。其次，将此张量方程转换为一个标准的 $4 \\times 4$ 线性系统。第三，针对简单剪切流和平面拉伸流这两种情况，对该系统进行特化。最后，概述一个数值程序，用于求解给定测试用例的该系统，并计算所需的应力范数。\n\n稳态聚合物应力 $\\boldsymbol{\\tau}_p$ 的控制方程由上随体 Maxwell (UCM) 模型给出：\n$$\n\\boldsymbol{\\tau}_p + \\lambda \\left( \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{\\tau}_p - (\\nabla \\boldsymbol{u}) \\boldsymbol{\\tau}_p - \\boldsymbol{\\tau}_p (\\nabla \\boldsymbol{u})^{\\top} \\right) = 2 \\eta_p \\boldsymbol{D}\n$$\n该问题考虑的是具有恒定速度梯度 $\\nabla\\boldsymbol{u}$ 的均匀流。对于此类流动，聚合物应力 $\\boldsymbol{\\tau}_p$ 在空间上也是均匀的，意味着其梯度为零，即 $\\nabla\\boldsymbol{\\tau}_p = \\boldsymbol{0}$。因此，对流项 $\\boldsymbol{u}\\cdot\\nabla \\boldsymbol{\\tau}_p$ 消失。控制方程简化为一个线性矩阵方程：\n$$\n\\boldsymbol{\\tau}_p - \\lambda \\left( (\\nabla \\boldsymbol{u}) \\boldsymbol{\\tau}_p + \\boldsymbol{\\tau}_p (\\nabla \\boldsymbol{u})^{\\top} \\right) = 2 \\eta_p \\boldsymbol{D}\n$$\n必须求解此方程以获得未知的 $2 \\times 2$ 张量 $\\boldsymbol{\\tau}_p$。为了便于数值求解，我们将此矩阵方程转换为 $\\boldsymbol{M}\\vec{\\tau} = \\vec{f}$ 形式的标准线性系统。令 $\\boldsymbol{L} = \\nabla\\boldsymbol{u}$。张量分量表示为：\n$$\n\\boldsymbol{\\tau}_p = \\begin{pmatrix} \\tau_{11}  \\tau_{12} \\\\ \\tau_{21}  \\tau_{22} \\end{pmatrix}, \\quad \\boldsymbol{L} = \\begin{pmatrix} L_{11}  L_{12} \\\\ L_{21}  L_{22} \\end{pmatrix}, \\quad \\boldsymbol{D} = \\begin{pmatrix} D_{11}  D_{12} \\\\ D_{21}  D_{22} \\end{pmatrix}\n$$\n我们将 $\\boldsymbol{\\tau}_p$ 向量化为 $\\vec{\\tau} = (\\tau_{11}, \\tau_{12}, \\tau_{21}, \\tau_{22})^\\top$。按分量写出矩阵方程，得到四个线性方程：\n\\begin{align*}\n\\tau_{11} - \\lambda(2L_{11}\\tau_{11} + L_{12}\\tau_{21} + L_{12}\\tau_{12}) = 2\\eta_p D_{11} \\\\\n\\tau_{12} - \\lambda(L_{11}\\tau_{12} + L_{12}\\tau_{22} + L_{21}\\tau_{11} + L_{22}\\tau_{12}) = 2\\eta_p D_{12} \\\\\n\\tau_{21} - \\lambda(L_{21}\\tau_{11} + L_{22}\\tau_{21} + L_{11}\\tau_{21} + L_{12}\\tau_{22}) = 2\\eta_p D_{21} \\\\\n\\tau_{22} - \\lambda(L_{21}\\tau_{12} + L_{22}\\tau_{22} + L_{21}\\tau_{21} + L_{22}\\tau_{22}) = 2\\eta_p D_{22}\n\\end{align*}\n将这些方程重排为 $\\boldsymbol{M}\\vec{\\tau} = \\vec{f}$ 的形式，其中 $\\vec{f} = 2\\eta_p(D_{11}, D_{12}, D_{21}, D_{22})^\\top$，则 $4 \\times 4$ 的系数矩阵 $\\boldsymbol{M}$ 为：\n$$\n\\boldsymbol{M} = \\begin{pmatrix}\n1 - 2\\lambda L_{11}  -\\lambda L_{12}  -\\lambda L_{12}  0 \\\\\n-\\lambda L_{21}  1 - \\lambda(L_{11}+L_{22})  0  -\\lambda L_{12} \\\\\n-\\lambda L_{21}  0  1 - \\lambda(L_{11}+L_{22})  -\\lambda L_{12} \\\\\n0  -\\lambda L_{21}  -\\lambda L_{21}  1 - 2\\lambda L_{22}\n\\end{pmatrix}\n$$\n问题指定区域 $\\Omega = [0,1]\\times[0,1]$ 在一个网格上离散化。由于 $\\nabla\\boldsymbol{u}$ 是恒定的，所得的应力张量 $\\boldsymbol{\\tau}_p$ 在整个区域内也是恒定的。因此，其在 $\\Omega$ 上的范数的上确界就是该范数在任意一点的值。\n\n求解策略是为每个测试用例构建并求解线性系统 $\\boldsymbol{M}\\vec{\\tau} = \\vec{f}$。\n物理参数是固定的：总粘度 $\\eta = 1\\,\\text{Pa}\\cdot\\text{s}$，剪切速率 $\\dot{\\gamma} = 1\\,\\text{s}^{-1}$，以及拉伸速率 $\\epsilon = 0.5\\,\\text{s}^{-1}$。聚合物粘度为 $\\eta_p = (1-\\beta)\\eta$。\n\n**1. 简单剪切流**\n对于简单剪切流 $\\boldsymbol{u}(x,y) = (\\dot{\\gamma} y, 0)$，速度梯度和形变率张量为：\n$$\n\\boldsymbol{L} = \\begin{pmatrix} 0  \\dot{\\gamma} \\\\ 0  0 \\end{pmatrix}, \\quad \\boldsymbol{D} = \\frac{1}{2}\\begin{pmatrix} 0  \\dot{\\gamma} \\\\ \\dot{\\gamma}  0 \\end{pmatrix}\n$$\n将 $L_{11}=0, L_{12}=\\dot{\\gamma}, L_{21}=0, L_{22}=0$ 代入 $\\boldsymbol{M}$：\n$$\n\\boldsymbol{M}_{\\text{shear}} = \\begin{pmatrix}\n1  -\\lambda \\dot{\\gamma}  -\\lambda \\dot{\\gamma}  0 \\\\\n0  1  0  -\\lambda \\dot{\\gamma} \\\\\n0  0  1  -\\lambda \\dot{\\gamma} \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n右侧向量为 $\\vec{f}_{\\text{shear}} = 2\\eta_p (0, \\dot{\\gamma}/2, \\dot{\\gamma}/2, 0)^\\top = \\eta_p (0, \\dot{\\gamma}, \\dot{\\gamma}, 0)^\\top$。求解 $\\boldsymbol{M}_{\\text{shear}}\\vec{\\tau} = \\vec{f}_{\\text{shear}}$ 可得到聚合物应力分量。\n\n**2. 平面拉伸流**\n对于平面拉伸流 $\\boldsymbol{u}(x,y) = (\\epsilon x, -\\epsilon y)$，张量为：\n$$\n\\boldsymbol{L} = \\begin{pmatrix} \\epsilon  0 \\\\ 0  -\\epsilon \\end{pmatrix}, \\quad \\boldsymbol{D} = \\begin{pmatrix} \\epsilon  0 \\\\ 0  -\\epsilon \\end{pmatrix}\n$$\n将 $L_{11}=\\epsilon, L_{12}=0, L_{21}=0, L_{22}=-\\epsilon$ 代入 $\\boldsymbol{M}$：\n$$\n\\boldsymbol{M}_{\\text{ext}} = \\begin{pmatrix}\n1 - 2\\lambda\\epsilon  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 + 2\\lambda\\epsilon\n\\end{pmatrix}\n$$\n右侧为 $\\vec{f}_{\\text{ext}} = 2\\eta_p (\\epsilon, 0, 0, -\\epsilon)^\\top$。系统 $\\boldsymbol{M}_{\\text{ext}}\\vec{\\tau} = \\vec{f}_{\\text{ext}}$ 是对角阵，易于求解。注意，如果 $1 - 2\\lambda\\epsilon = 0$，则会出现奇异点。对于给定的参数 $\\epsilon = 0.5\\,\\text{s}^{-1}$，这发生在 $\\lambda = 1\\,\\text{s}$ 时，该值不在测试用例值中。\n\n对于每个由 $(\\beta, \\lambda)$ 定义的测试用例，使用相应的 $\\boldsymbol{L}$ 和 $\\boldsymbol{D}$ 来构建和求解关于 $\\vec{\\tau}$ 的线性系统。将得到的向量重塑为 $2 \\times 2$ 矩阵 $\\boldsymbol{\\tau}_p$，并计算其 Frobenius 范数 $\\|\\boldsymbol{\\tau}_p\\|_F = \\sqrt{\\sum_{i,j} |\\tau_{ij}|^2}$。该值在整个区域上是恒定的，即为所求的上确界范数。计算所有 10 种情况的结果，并按要求格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the polymer stress in an Oldroyd-B fluid under simple shear and\n    planar extensional flows for a range of parameters.\n    \"\"\"\n\n    def calculate_stress_norm(beta, lam, flow_type, eta, gamma_dot, epsilon):\n        \"\"\"\n        Calculates the Frobenius norm of the polymer stress tensor.\n\n        Args:\n            beta (float): Solvent viscosity fraction.\n            lam (float): Relaxation time in seconds.\n            flow_type (str): 'shear' or 'extension'.\n            eta (float): Total viscosity in Pa.s.\n            gamma_dot (float): Shear rate in 1/s.\n            epsilon (float): Extension rate in 1/s.\n\n        Returns:\n            float: The Frobenius norm of the polymer stress tensor in Pa.\n        \"\"\"\n        eta_p = (1.0 - beta) * eta\n\n        if eta_p == 0.0:\n            return 0.0\n\n        if flow_type == 'shear':\n            L = np.array([[0., gamma_dot], [0., 0.]])\n            D = 0.5 * np.array([[0., gamma_dot], [gamma_dot, 0.]])\n        elif flow_type == 'extension':\n            L = np.array([[epsilon, 0.], [0., -epsilon]])\n            D = np.array([[epsilon, 0.], [0., -epsilon]])\n        else:\n            raise ValueError(\"Invalid flow type specified.\")\n\n        L11, L12 = L[0, 0], L[0, 1]\n        L21, L22 = L[1, 0], L[1, 1]\n        \n        # Construct the 4x4 coefficient matrix M\n        M = np.zeros((4, 4))\n        \n        # Equation for tau_11\n        M[0, 0] = 1.0 - 2.0 * lam * L11\n        M[0, 1] = -lam * L12\n        M[0, 2] = -lam * L12\n        \n        # Equation for tau_12\n        M[1, 0] = -lam * L21\n        M[1, 1] = 1.0 - lam * (L11 + L22)\n        M[1, 3] = -lam * L12\n\n        # Equation for tau_21\n        M[2, 0] = -lam * L21\n        M[2, 2] = 1.0 - lam * (L11 + L22)\n        M[2, 3] = -lam * L12\n\n        # Equation for tau_22\n        M[3, 1] = -lam * L21\n        M[3, 2] = -lam * L21\n        M[3, 3] = 1.0 - 2.0 * lam * L22\n\n        # Construct the right-hand side vector f\n        f = 2.0 * eta_p * np.array([D[0, 0], D[0, 1], D[1, 0], D[1, 1]])\n\n        # Solve the linear system M * tau_vec = f\n        tau_vec = np.linalg.solve(M, f)\n        \n        # Reshape the solution vector to a 2x2 matrix\n        tau_p = tau_vec.reshape((2, 2))\n\n        # Compute and return the Frobenius norm\n        return np.linalg.norm(tau_p, 'fro')\n\n    # Define physical parameters\n    eta = 1.0        # Pa.s\n    gamma_dot = 1.0  # 1/s\n    epsilon = 0.5    # 1/s\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Simple Shear cases\n        {'beta': 0.8, 'lambda': 0.2, 'flow': 'shear'},\n        {'beta': 0.999, 'lambda': 0.001, 'flow': 'shear'},\n        {'beta': 0.9999, 'lambda': 1e-4, 'flow': 'shear'},\n        {'beta': 1.0, 'lambda': 0.0, 'flow': 'shear'},\n        {'beta': 0.8, 'lambda': 0.0, 'flow': 'shear'},\n        # Planar Extension cases\n        {'beta': 0.8, 'lambda': 0.2, 'flow': 'extension'},\n        {'beta': 0.999, 'lambda': 0.001, 'flow': 'extension'},\n        {'beta': 0.9999, 'lambda': 1e-4, 'flow': 'extension'},\n        {'beta': 1.0, 'lambda': 0.0, 'flow': 'extension'},\n        {'beta': 0.8, 'lambda': 0.0, 'flow': 'extension'},\n    ]\n\n    results = []\n    for case in test_cases:\n        norm = calculate_stress_norm(\n            case['beta'],\n            case['lambda'],\n            case['flow'],\n            eta,\n            gamma_dot,\n            epsilon\n        )\n        results.append(np.round(norm, 8))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3388289"}, {"introduction": "为像Oldroyd-B这样的复杂模型开发稳健的数值求解器需要严谨的验证技术。这个高级实践介绍了人造解方法（Method of Manufactured Solutions, MMS），这是一个用于评估数值离散化精度的强大框架[@problem_id:3388305]。您将为一组修正后的控制方程构建一个精确的解析解，并用它来精确测量您代码的收敛阶，这是任何计算科学家都应具备的一项基本技能。", "problem": "要求您通过在周期性方形区域上使用构造解方法（Method of Manufactured Solutions），验证稳态 Oldroyd–B 粘弹性模型二阶有限差分格式的观测精度阶数。请使用无量纲单位，以使所有物理量均为无量纲。出发点是稳态不可压缩动量平衡方程、Oldroyd–B 模型的稳态构象张量输运方程，以及不可压缩性条件：\n- 连续性方程为 $\\nabla \\cdot \\mathbf{u} = 0$。\n- 动量方程为 $\\rho \\, (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\eta_s \\nabla^2 \\mathbf{u} + \\nabla \\cdot \\boldsymbol{\\tau}_p + \\mathbf{f}$，其中 $\\rho$ 是质量密度，$\\eta_s$ 是溶剂粘度，$p$ 是压力，$\\mathbf{f}$ 是体积力。\n- 聚合物附加应力为 $\\boldsymbol{\\tau}_p = \\dfrac{\\eta_p}{\\lambda} \\left(\\mathbf{C} - \\mathbf{I}\\right)$，其中 $\\eta_p$ 是聚合物粘度，$\\lambda$ 是松弛时间，$\\mathbf{C}$ 是构象张量，$\\mathbf{I}$ 是单位张量。\n- 稳态构象张量演化方程（上随体导数）为 $\\mathbf{u}\\cdot \\nabla \\mathbf{C} - (\\nabla \\mathbf{u})\\,\\mathbf{C} - \\mathbf{C}\\,(\\nabla \\mathbf{u})^\\top = -\\dfrac{1}{\\lambda} \\left(\\mathbf{C}-\\mathbf{I}\\right)$。\n\n您的任务是通过在周期性单位方块 $\\Omega = [0,1]\\times[0,1]$（两个方向上的周期均为 1）上指定一个精确无散的速度场 $\\mathbf{u}(\\mathbf{x})$ 和一个对称正定（SPD）的构象张量 $\\mathbf{C}(\\mathbf{x})$，来构造一个人工解，然后计算体积力 $\\mathbf{f}(\\mathbf{x})$，使得在 $p(\\mathbf{x}) \\equiv 0$ 的条件下，稳态动量方程精确成立。使用此人工构造的配置来评估二阶有限差分格式对以下各项的观测精度阶数：\n- $\\mathbf{u}$ 的动量残差。\n- 聚合物应力的散度 $\\nabla \\cdot \\boldsymbol{\\tau}_p$。\n\n按以下步骤进行：\n- 设流函数为 $\\psi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y)$，并通过 $\\mathbf{u}(x,y) = \\left(\\dfrac{\\partial \\psi}{\\partial y}, -\\dfrac{\\partial \\psi}{\\partial x}\\right)$ 定义无散速度场。这得到 $\\mathbf{u}(x,y) = \\left(2\\pi \\cos(2\\pi y)\\sin(2\\pi x),\\, -2\\pi \\cos(2\\pi x)\\sin(2\\pi y)\\right)$。\n- 指定对称正定构象张量 $\\mathbf{C}(x,y)$，其分量为\n  $C_{11}(x,y) = 1 + \\varepsilon \\left(2 + \\cos(2\\pi x) + \\sin(2\\pi y)\\right)$,\n  $C_{22}(x,y) = 1 + \\varepsilon \\left(2 + \\sin(2\\pi x) + \\cos(2\\pi y)\\right)$,\n  $C_{12}(x,y) = C_{21}(x,y) = \\varepsilon \\left(\\dfrac{1}{2}\\sin(2\\pi x)\\sin(2\\pi y)\\right)$,\n  其中 $\\varepsilon$ 是一个小的振幅参数，其选择应确保对所有 $(x,y)\\in\\Omega$，$\\mathbf{C}$ 都是对称正定的。\n- 设 $p(x,y) \\equiv 0$，并通过精确地强制满足稳态动量平衡来定义体积力 $\\mathbf{f}(x,y)$：\n  $\\mathbf{f} = \\rho \\, (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} - \\eta_s \\nabla^2 \\mathbf{u} - \\nabla \\cdot \\boldsymbol{\\tau}_p$。\n\n在 $N\\times N$ 点的均匀周期性网格上，使用网格间距为 $h = 1/N$ 的标准中心二阶有限差分来离散化所有空间导数。对一阶导数使用 $\\mathcal{O}(h^2)$ 阶中心差分，对二阶导数使用标准的 5 点拉普拉斯算子，并使用环绕索引来强制周期性。为了提供构造 $\\mathbf{f}$ 以及计算 $\\nabla \\cdot \\boldsymbol{\\tau}_p$ 和 $\\nabla^2 \\mathbf{u}$ 参考值所需的导数的参考“精确”评估，请在同一网格上使用傅里叶谱方法微分：对于具有离散傅里叶变换 $\\hat{q}(k_x,k_y)$ 和波数 $k_x, k_y \\in 2\\pi \\mathbb{Z}$ 的标量场 $q(x,y)$，将 $\\dfrac{\\partial q}{\\partial x}$ 计算为 $\\mathrm{i}k_x \\hat{q}$ 的逆变换，$\\dfrac{\\partial q}{\\partial y}$ 计算为 $\\mathrm{i}k_y \\hat{q}$ 的逆变换，$\\nabla^2 q$ 计算为 $-(k_x^2+k_y^2)\\hat{q}$ 的逆变换。\n\n定义离散动量残差\n$\\mathbf{R}_{\\text{mom}}^{(N)} = \\rho \\left(\\mathbf{u}\\cdot \\nabla_h\\right)\\mathbf{u} - \\eta_s \\nabla_h^2 \\mathbf{u} - \\nabla_h \\cdot \\boldsymbol{\\tau}_p - \\mathbf{f}$，\n其中 $\\nabla_h$ 和 $\\nabla_h^2$ 分别表示离散中心差分梯度和拉普拉斯算子，而 $(\\mathbf{u}\\cdot \\nabla_h)\\mathbf{u}$ 按分量形式 $u_x \\dfrac{\\partial \\mathbf{u}}{\\partial x}\\big|_h + u_y \\dfrac{\\partial \\mathbf{u}}{\\partial y}\\big|_h$ 构成。同时，定义聚合物应力的离散散度误差（相对于谱方法参考值）为\n$\\mathbf{E}_{\\text{div}\\,\\tau}^{(N)} = \\left(\\nabla_h \\cdot \\boldsymbol{\\tau}_p\\right) - \\left(\\nabla \\cdot \\boldsymbol{\\tau}_p\\right)_{\\text{spec}}$。\n使用网格上的离散均方根范数来度量误差，即对于在网格上采样的向量场 $\\mathbf{a}(x,y)$，使用 $\\left\\|\\mathbf{a}\\right\\|_{2} = \\sqrt{\\dfrac{1}{N^2}\\sum_{i,j}\\left(a_x^2 + a_y^2\\right)}$。\n\n使用一系列网格，$N \\in \\{16,32,64,128\\}$，对每个 $N$ 计算误差 $\\left\\|\\mathbf{R}_{\\text{mom}}^{(N)}\\right\\|_{2}$ 和 $\\left\\|\\mathbf{E}_{\\text{div}\\,\\tau}^{(N)}\\right\\|_{2}$，并通过\n$p \\approx \\log_2\\left(\\dfrac{E^{(N)}}{E^{(2N)}}\\right)$ 估计连续加密网格之间的观测精度阶数。\n对于测试套件中的每个参数集，报告使用最密的两个网格 $N=64$ 和 $N=128$ 计算得到的动量残差和聚合物应力散度的观测精度阶数，结果四舍五入到三位小数。\n\n使用以下参数测试套件：\n- 测试 1：$\\rho = 1$, $\\eta_s = 0.5$, $\\eta_p = 0.3$, $\\lambda = 0.7$, $\\varepsilon = 0.2$。\n- 测试 2：$\\rho = 1$, $\\eta_s = 0.5$, $\\eta_p = 1.0$, $\\lambda = 0.2$, $\\varepsilon = 0.2$。\n- 测试 3：$\\rho = 1$, $\\eta_s = 0.5$, $\\eta_p = 2.0$, $\\lambda = 2.0$, $\\varepsilon = 0.1$。\n\n您的程序必须实现：\n- 如上文所述，在周期性网格上构造 $\\mathbf{u}$ 和 $\\mathbf{C}$。\n- 计算 $\\boldsymbol{\\tau}_p$。\n- 使用谱方法微分来构造体积力 $\\mathbf{f}$ 和参考值 $\\left(\\nabla \\cdot \\boldsymbol{\\tau}_p\\right)_{\\text{spec}}$。\n- 使用二阶中心差分算子来构成离散动量残差和 $\\boldsymbol{\\tau}_p$ 的离散散度。\n- $N=64$ 和 $N=128$ 之间的误差范数和观测阶数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含两个观测阶数 $[p_{\\text{mom}}, p_{\\text{div}\\,\\tau}]$ 的双元素列表。例如，整体输出应类似于 $[[p_{1,\\text{mom}},p_{1,\\text{div}\\,\\tau}],[p_{2,\\text{mom}},p_{2,\\text{div}\\,\\tau}],[p_{3,\\text{mom}},p_{3,\\text{div}\\,\\tau}]]$，其中每个 $p$ 值都四舍五入到三位小数。", "solution": "我们从由 Oldroyd–B 方程建模的稳态、不可压缩、粘弹性流动的基本平衡定律开始。核心要素是：\n- 不可压缩性约束 $\\nabla \\cdot \\mathbf{u} = 0$，它对不可压缩流体强制执行质量守恒。\n- 动量平衡 $\\rho (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\eta_s \\nabla^2 \\mathbf{u} + \\nabla \\cdot \\boldsymbol{\\tau}_p + \\mathbf{f}$，它源于 Newton 第二定律，其中包含粘性溶剂应力 $\\eta_s \\nabla^2 \\mathbf{u}$ 和粘弹性聚合物应力 $\\boldsymbol{\\tau}_p$。\n- Oldroyd–B 本构关系 $\\boldsymbol{\\tau}_p = \\dfrac{\\eta_p}{\\lambda}(\\mathbf{C}-\\mathbf{I})$，其中 $\\mathbf{C}$ 满足稳态上随体导数方程 $\\mathbf{u}\\cdot \\nabla \\mathbf{C} - (\\nabla \\mathbf{u}) \\mathbf{C} - \\mathbf{C}(\\nabla \\mathbf{u})^\\top = -\\dfrac{1}{\\lambda}(\\mathbf{C}-\\mathbf{I})$。尽管构象输运方程是基础，但我们的人工解只要求 $\\mathbf{C}$ 是对称正定且光滑的，以确保 $\\boldsymbol{\\tau}_p$ 及其散度是良定义的。\n\n构造解方法（Method of Manufactured Solutions）的流程是，首先指定满足所需结构特性的光滑场 $\\mathbf{u}$ 和 $\\mathbf{C}$，然后定义体积力 $\\mathbf{f}$，使得稳态动量方程在连续介质中精确满足。在我们的例子中：\n- 我们选择 $\\psi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y)$ 并设 $\\mathbf{u} = \\left(\\dfrac{\\partial \\psi}{\\partial y}, -\\dfrac{\\partial \\psi}{\\partial x}\\right)$。这保证了 $\\nabla \\cdot \\mathbf{u} = 0$，因为 $\\nabla \\cdot \\left(\\partial_y \\psi, -\\partial_x \\psi\\right) = \\partial_{xy} \\psi - \\partial_{yx} \\psi = 0$。显式地，$\\mathbf{u}(x,y) = \\left(2\\pi \\cos(2\\pi y)\\sin(2\\pi x),\\, -2\\pi \\cos(2\\pi x)\\sin(2\\pi y)\\right)$，它在单位方块上是 $C^\\infty$（无穷次可导）且周期性的。\n- 我们选择 $\\mathbf{C}(x,y)$，其分量为 $C_{11} = 1 + \\varepsilon (2 + \\cos(2\\pi x) + \\sin(2\\pi y))$, $C_{22} = 1 + \\varepsilon (2 + \\sin(2\\pi x) + \\cos(2\\pi y))$, $C_{12} = C_{21} = \\varepsilon \\left(\\dfrac{1}{2}\\sin(2\\pi x)\\sin(2\\pi y)\\right)$。对于足够小的 $\\varepsilon$（例如 $\\varepsilon \\le 0.2$），这个对称矩阵保持严格对角占优，对角元为正，且行列式有界不为零，从而确保它对所有 $(x,y)\\in \\Omega$ 都是对称正定的。\n\n设 $p \\equiv 0$，我们将体积力构造为 $\\mathbf{f} = \\rho (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} - \\eta_s \\nabla^2 \\mathbf{u} - \\nabla \\cdot \\boldsymbol{\\tau}_p$。根据定义，这确保了精确的光滑场在连续介质层面上恒等地满足稳态动量方程，因此真实的动量残差为零。\n\n为验证数值精度，我们在间距为 $h = 1/N$ 的均匀周期性网格上进行离散化，并使用二阶中心差分（根据泰勒级数分析，对于足够光滑的函数，其截断误差为 $\\mathcal{O}(h^2)$）来近似一阶导数和拉普拉斯算子。具体来说：\n- 对于标量场 $q_{i,j}$，中心近似为 $\\left.\\dfrac{\\partial q}{\\partial x}\\right|_{i,j} \\approx \\dfrac{q_{i,j+1} - q_{i,j-1}}{2h}$ 和 $\\left.\\dfrac{\\partial q}{\\partial y}\\right|_{i,j} \\approx \\dfrac{q_{i+1,j} - q_{i-1,j}}{2h}$，拉普拉斯算子为 $\\left.\\nabla^2 q\\right|_{i,j} \\approx \\dfrac{q_{i,j+1} + q_{i,j-1} + q_{i+1,j} + q_{i-1,j} - 4 q_{i,j}}{h^2}$，并使用周期性环绕索引。\n- 对于具有分量 $\\tau_{11}, \\tau_{12}, \\tau_{21}, \\tau_{22}$ 的张量 $\\boldsymbol{\\tau}_p$，离散散度为 $(\\nabla_h \\cdot \\boldsymbol{\\tau}_p)_x \\approx \\dfrac{\\partial \\tau_{11}}{\\partial x}\\big|_h + \\dfrac{\\partial \\tau_{12}}{\\partial y}\\big|_h$ 和 $(\\nabla_h \\cdot \\boldsymbol{\\tau}_p)_y \\approx \\dfrac{\\partial \\tau_{21}}{\\partial x}\\big|_h + \\dfrac{\\partial \\tau_{22}}{\\partial y}\\big|_h$。\n- 离散对流项按分量构成：$\\left[(\\mathbf{u}\\cdot \\nabla_h)\\mathbf{u}\\right]_\\alpha = u_x \\dfrac{\\partial u_\\alpha}{\\partial x}\\big|_h + u_y \\dfrac{\\partial u_\\alpha}{\\partial y}\\big|_h$，其中 $\\alpha \\in \\{x,y\\}$。\n\n评估人工体积力以及计算参考散度和拉普拉斯算子所需的“精确”参考值由傅里叶谱方法微分提供。对于在整数波数上的形如 $\\sin(2\\pi x)$ 和 $\\cos(2\\pi x)$ 的周期性三角函数，只要网格能够解析这些波数，该方法就能达到机器精度。谱方法微分通过在傅里叶空间中将傅里叶系数乘以 $\\mathrm{i}k_x$ 或 $\\mathrm{i}k_y$ 来计算导数，将系数乘以 $-(k_x^2+k_y^2)$ 来计算拉普拉斯算子，然后进行逆变换。\n\n然后我们定义两个误差度量：\n- 动量残差误差 $\\mathbf{R}_{\\text{mom}}^{(N)} = \\rho (\\mathbf{u}\\cdot \\nabla_h)\\mathbf{u} - \\eta_s \\nabla_h^2 \\mathbf{u} - \\nabla_h \\cdot \\boldsymbol{\\tau}_p - \\mathbf{f}$，对于作用于光滑场的二阶格式，当 $h \\to 0$ 时，该误差应以二阶速率收敛到 $\\mathbf{0}$，即 $\\|\\mathbf{R}_{\\text{mom}}^{(N)}\\|_2 = \\mathcal{O}(h^2)$。\n- 聚合物应力散度误差 $\\mathbf{E}_{\\text{div}\\,\\tau}^{(N)} = (\\nabla_h \\cdot \\boldsymbol{\\tau}_p) - (\\nabla \\cdot \\boldsymbol{\\tau}_p)_{\\text{spec}}$，该误差也应为 $\\mathcal{O}(h^2)$。\n\n为计算两个连续网格之间的观测阶数，我们使用 $p \\approx \\log_2\\left(\\dfrac{E^{(N)}}{E^{(2N)}}\\right)$，其中 $E^{(N)}$ 是相关误差的离散均方根范数。在网格加密 $h \\mapsto h/2$ 的情况下，一个二阶方法会表现出 $E^{(2N)} \\approx E^{(N)}/4$，因此 $p \\approx 2$。\n\n算法概述：\n- 对于每个参数集 $(\\rho, \\eta_s, \\eta_p, \\lambda, \\varepsilon)$ 和 $N \\in \\{16,32,64,128\\}$，构建网格并根据人工构造的定义逐点评估 $\\mathbf{u}$ 和 $\\mathbf{C}$。\n- 形成 $\\boldsymbol{\\tau}_p = \\dfrac{\\eta_p}{\\lambda}(\\mathbf{C}-\\mathbf{I})$。\n- 计算谱方法导数来组装强迫项 $\\mathbf{f} = \\rho (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} - \\eta_s \\nabla^2 \\mathbf{u} - \\nabla \\cdot \\boldsymbol{\\tau}_p$，以及参考值 $(\\nabla \\cdot \\boldsymbol{\\tau}_p)_{\\text{spec}}$。\n- 计算中心有限差分近似来构建 $\\mathbf{R}_{\\text{mom}}^{(N)}$ 和 $(\\nabla_h \\cdot \\boldsymbol{\\tau}_p)$。\n- 计算离散均方根范数 $\\|\\mathbf{R}_{\\text{mom}}^{(N)}\\|_2$ 和 $\\|(\\nabla_h \\cdot \\boldsymbol{\\tau}_p) - (\\nabla \\cdot \\boldsymbol{\\tau}_p)_{\\text{spec}}\\|_2$（对于每个 $N$）。\n- 使用对 $(N,2N)$ 估计观测阶数，并报告使用 $N=64$ 和 $N=128$ 的最密网格估计值。\n\n由于人工构造的场是光滑的三角函数且网格是周期性的，谱方法导数提供了机器精度的参考值，而二阶中心差分将对动量残差和聚合物应力散度都表现出接近 2 的观测阶数。对 $(\\eta_p,\\lambda)$ 的依赖仅通过 $\\boldsymbol{\\tau}_p$ 的缩放进入，并且根据微分的线性性质，不应改变收敛率，尽管与聚合物相关的项的绝对误差将按 $(\\eta_p/\\lambda)$ 进行缩放。\n\n该程序实现了所有步骤，并为每个测试用例输出一对观测阶数 $[p_{\\text{mom}}, p_{\\text{div}\\,\\tau}]$（四舍五入到三位小数），并汇总为包含这些对的单行列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef streamfunction_u(x, y):\n    # u = (dpsi/dy, -dpsi/dx) with psi = sin(2π x) sin(2π y)\n    two_pi = 2.0 * np.pi\n    ux = two_pi * np.cos(two_pi * y) * np.sin(two_pi * x)\n    uy = -two_pi * np.cos(two_pi * x) * np.sin(two_pi * y)\n    return ux, uy\n\ndef conformation_C(x, y, eps):\n    # SPD C with smooth periodic entries\n    two_pi = 2.0 * np.pi\n    C11 = 1.0 + eps * (2.0 + np.cos(two_pi * x) + np.sin(two_pi * y))\n    C22 = 1.0 + eps * (2.0 + np.sin(two_pi * x) + np.cos(two_pi * y))\n    C12 = eps * 0.5 * np.sin(two_pi * x) * np.sin(two_pi * y)\n    return C11, C22, C12  # C12 == C21\n\ndef tau_p_from_C(C11, C22, C12, eta_p, lam):\n    factor = eta_p / lam\n    tau11 = factor * (C11 - 1.0)\n    tau22 = factor * (C22 - 1.0)\n    tau12 = factor * (C12)\n    return tau11, tau22, tau12\n\ndef spectral_wavevectors(N, L=1.0):\n    dx = L / N\n    k1 = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)  # angular wavenumbers\n    kx, ky = np.meshgrid(k1, k1, indexing='xy')\n    return kx, ky\n\ndef spectral_gradients(f, kx, ky):\n    F = np.fft.fft2(f)\n    dfdx = np.fft.ifft2(1j * kx * F).real\n    dfdy = np.fft.ifft2(1j * ky * F).real\n    return dfdx, dfdy\n\ndef spectral_laplacian(f, kx, ky):\n    F = np.fft.fft2(f)\n    lap = np.fft.ifft2(-(kx**2 + ky**2) * F).real\n    return lap\n\ndef ddx_central(f, dx):\n    return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2.0 * dx)\n\ndef ddy_central(f, dy):\n    return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2.0 * dy)\n\ndef laplacian_central(f, dx, dy):\n    termx = (np.roll(f, -1, axis=1) - 2.0 * f + np.roll(f, 1, axis=1)) / (dx * dx)\n    termy = (np.roll(f, -1, axis=0) - 2.0 * f + np.roll(f, 1, axis=0)) / (dy * dy)\n    return termx + termy\n\ndef divergence_tau_central(tau11, tau22, tau12, dx, dy):\n    # tau is symmetric: tau21 == tau12\n    divx = ddx_central(tau11, dx) + ddy_central(tau12, dy)\n    divy = ddx_central(tau12, dx) + ddy_central(tau22, dy)\n    return divx, divy\n\ndef divergence_tau_spectral(tau11, tau22, tau12, kx, ky):\n    dt11dx, _ = spectral_gradients(tau11, kx, ky)\n    _, dt12dy = spectral_gradients(tau12, kx, ky)\n    dt12dx, _ = spectral_gradients(tau12, kx, ky)\n    _, dt22dy = spectral_gradients(tau22, kx, ky)\n    divx = dt11dx + dt12dy\n    divy = dt12dx + dt22dy\n    return divx, divy\n\ndef advection_term(u_x, u_y, dux_dx, dux_dy, duy_dx, duy_dy):\n    # (u · ∇) u componentwise\n    adv_x = u_x * dux_dx + u_y * dux_dy\n    adv_y = u_x * duy_dx + u_y * duy_dy\n    return adv_x, adv_y\n\ndef rms_norm(vecx, vecy):\n    return np.sqrt(np.mean(vecx**2 + vecy**2))\n\ndef compute_errors_for_params(rho, eta_s, eta_p, lam, eps, N_list):\n    errs_mom = []\n    errs_divtau = []\n    L = 1.0\n    for N in N_list:\n        dx = L / N\n        dy = L / N\n        x = np.linspace(0.0, L, N, endpoint=False)\n        y = np.linspace(0.0, L, N, endpoint=False)\n        X, Y = np.meshgrid(x, y, indexing='xy')\n\n        ux, uy = streamfunction_u(X, Y)\n        C11, C22, C12 = conformation_C(X, Y, eps)\n        tau11, tau22, tau12 = tau_p_from_C(C11, C22, C12, eta_p, lam)\n\n        # Spectral references\n        kx, ky = spectral_wavevectors(N, L=L)\n        dux_dx_spec, dux_dy_spec = spectral_gradients(ux, kx, ky)\n        duy_dx_spec, duy_dy_spec = spectral_gradients(uy, kx, ky)\n        lap_ux_spec = spectral_laplacian(ux, kx, ky)\n        lap_uy_spec = spectral_laplacian(uy, kx, ky)\n        advx_spec, advy_spec = advection_term(ux, uy, dux_dx_spec, dux_dy_spec, duy_dx_spec, duy_dy_spec)\n        divtau_x_spec, divtau_y_spec = divergence_tau_spectral(tau11, tau22, tau12, kx, ky)\n\n        # Manufactured body force (continuum-exact on the grid)\n        fx = rho * advx_spec - eta_s * lap_ux_spec - divtau_x_spec\n        fy = rho * advy_spec - eta_s * lap_uy_spec - divtau_y_spec\n\n        # Discrete central differences\n        dux_dx_h = ddx_central(ux, dx)\n        dux_dy_h = ddy_central(ux, dy)\n        duy_dx_h = ddx_central(uy, dx)\n        duy_dy_h = ddy_central(uy, dy)\n        advx_h, advy_h = advection_term(ux, uy, dux_dx_h, dux_dy_h, duy_dx_h, duy_dy_h)\n        lap_ux_h = laplacian_central(ux, dx, dy)\n        lap_uy_h = laplacian_central(uy, dx, dy)\n        divtau_x_h, divtau_y_h = divergence_tau_central(tau11, tau22, tau12, dx, dy)\n\n        # Momentum residual error using discrete operators minus manufactured forcing\n        Rmx = rho * advx_h - eta_s * lap_ux_h - divtau_x_h - fx\n        Rmy = rho * advy_h - eta_s * lap_uy_h - divtau_y_h - fy\n        err_mom = rms_norm(Rmx, Rmy)\n        errs_mom.append(err_mom)\n\n        # Divergence of tau error vs spectral reference\n        Etaux = divtau_x_h - divtau_x_spec\n        Etauy = divtau_y_h - divtau_y_spec\n        err_divtau = rms_norm(Etaux, Etauy)\n        errs_divtau.append(err_divtau)\n\n    # Compute observed orders between successive refinements\n    orders_mom = []\n    orders_divtau = []\n    for i in range(len(N_list) - 1):\n        E1 = errs_mom[i]\n        E2 = errs_mom[i + 1]\n        orders_mom.append(np.log2(E1 / E2))\n        E1t = errs_divtau[i]\n        E2t = errs_divtau[i + 1]\n        orders_divtau.append(np.log2(E1t / E2t))\n\n    # Return the finest-grid observed orders (between N=64 and N=128 if provided)\n    return orders_mom[-1], orders_divtau[-1]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (rho, eta_s, eta_p, lambda, epsilon)\n        (1.0, 0.5, 0.3, 0.7, 0.2),\n        (1.0, 0.5, 1.0, 0.2, 0.2),\n        (1.0, 0.5, 2.0, 2.0, 0.1),\n    ]\n    N_list = [16, 32, 64, 128]\n\n    results = []\n    for rho, eta_s, eta_p, lam, eps in test_cases:\n        p_mom, p_divtau = compute_errors_for_params(rho, eta_s, eta_p, lam, eps, N_list)\n        # Round to three decimals as required\n        p_mom_r = round(float(p_mom), 3)\n        p_divtau_r = round(float(p_divtau), 3)\n        results.append([p_mom_r, p_divtau_r])\n\n    # Final print statement in the exact required format.\n    # Ensure single-line output with comma-separated list enclosed in brackets.\n    # Convert to string without spaces for strict formatting\n    def list_to_str(lst):\n        # Recursively convert nested lists to compact string\n        if isinstance(lst, list):\n            return \"[\" + \",\".join(list_to_str(el) for el in lst) + \"]\"\n        else:\n            return str(lst)\n\n    print(list_to_str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3388305"}]}