{"hands_on_practices": [{"introduction": "我们从任何网格最基本的构建单元——三角形——开始。本练习要求您推导出一个与面扫过的体积变化率相一致的精确的面法向速度，这在任意拉格朗日-欧拉（ALE）方法中至关重要。掌握这一推导是构建符合几何守恒律（GCL）的有限体积求解器的第一步。[@problem_id:3344771]", "problem": "考虑一个由平面界定的移动控制体的三维任意拉格朗日-欧拉（ALE）离散化。设其中一个面是三角形，其顶点位置为 $\\boldsymbol{x}_{1}(t)$、$\\boldsymbol{x}_{2}(t)$ 和 $\\boldsymbol{x}_{3}(t)$，在给定的时间区间内，这些顶点对所有时刻 $t$ 保持不共线，因此该面在每个瞬间都是平面的。设顶点速度 $\\boldsymbol{v}_{i}(t) = d\\boldsymbol{x}_{i}/dt$ 在此区间内是时间的线性函数。通过有向面积矢量 $\\boldsymbol{S}_{f}(t) = \\frac{1}{2}\\left(\\boldsymbol{x}_{2}(t)-\\boldsymbol{x}_{1}(t)\\right)\\times\\left(\\boldsymbol{x}_{3}(t)-\\boldsymbol{x}_{1}(t)\\right)$ 定义该三角形面的瞬时单位法向量 $\\boldsymbol{n}_{f}(t)$ 和面积 $A_{f}(t)$，其中 $\\boldsymbol{n}_{f}(t) = \\boldsymbol{S}_{f}(t)/\\|\\boldsymbol{S}_{f}(t)\\|$ 且 $A_{f}(t) = \\|\\boldsymbol{S}_{f}(t)\\|$。假设面上的网格速度使用三角形的标准重心形函数在空间上线性分布，即对于时刻 $t$ 面上的任意点 $\\boldsymbol{x}$，\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = N_{1}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{1}(t) + N_{2}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{2}(t) + N_{3}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{3}(t),\n$$\n其中 $N_{i}(\\boldsymbol{x},t)$ 是线性形函数，在时刻 $t$ 满足 $N_{i}(\\boldsymbol{x}_{j}(t),t) = \\delta_{ij}$ 且在面上 $N_{1}+N_{2}+N_{3}=1$。\n\n从 Reynolds 输运定理和几何守恒律出发，推导一个精确的标量面法向速度 $w_{f}(t)$，使得移动面贡献的瞬时体积变化率等于网格速度法向分量的面积分，\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA,\n$$\n在区间内的所有时刻均成立。然后证明，在顶点运动是时间线性的以及面上空间线性插值的既定假设下，对于顶点速度的每一种可能选择，该 $w_{f}(t)$ 在所有能再现相同瞬时扫掠体积的从 $\\{\\boldsymbol{v}_{1}(t),\\boldsymbol{v}_{2}(t),\\boldsymbol{v}_{3}(t)\\}$ 到面法向速度的标量映射中是唯一的。\n\n将您的最终答案表示为 $w_{f}(t)$ 关于 $\\boldsymbol{n}_{f}(t)$ 和 $\\boldsymbol{v}_{i}(t)$（$i=1,2,3$）的闭式解析表达式。", "solution": "该问题在计算流体力学领域，特别是在任意拉格朗日-欧拉（ALE）方法和几何守恒律（GCL）方面，是适定的且有科学依据的。所提供的假设对于在移动网格上建立和分析二阶精确数值格式是标准的。因此，我们可以进行推导和证明。\n\n问题分为两部分：首先，推导标量面法向速度 $w_f(t)$ 的表达式；其次，在给定条件下证明该表达式的唯一性。\n\n**第一部分：面法向速度 $w_f(t)$ 的推导**\n\n我们从问题陈述中给出的定义方程开始，该方程将标量面速度 $w_f(t)$ 与面上的网格速度场 $\\boldsymbol{v}_g(\\boldsymbol{x}, t)$ 联系起来：\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n此处，$A_f(t)$ 是三角形面的面积，$\\boldsymbol{n}_f(t)$ 是其单位法向量。\n\n面上任意点 $\\boldsymbol{x}$ 处的网格速度 $\\boldsymbol{v}_g$ 由顶点速度 $\\boldsymbol{v}_i(t)$ 使用重心形函数 $N_i(\\boldsymbol{x},t)$ 进行线性插值得到：\n$$\n\\boldsymbol{v}_{g}(\\boldsymbol{x},t) = \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t)\n$$\n将 $\\boldsymbol{v}_g(\\boldsymbol{x}, t)$ 的这个表达式代入积分方程中，得到：\n$$\nA_{f}(t)\\,w_{f}(t) = \\int_{A_{f}(t)} \\left( \\sum_{i=1}^{3} N_{i}(\\boldsymbol{x},t)\\,\\boldsymbol{v}_{i}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n顶点速度 $\\boldsymbol{v}_i(t)$ 和面法向量 $\\boldsymbol{n}_f(t)$ 是时间 $t$ 的函数，但在任何给定瞬间，它们相对于面 $A_f(t)$ 上的空间积分变量 $\\boldsymbol{x}$ 是常数。因此，我们可以将它们移到积分号外。根据积分和点积的线性性质：\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n下一步是计算形函数在三角形面积上的积分。对于线性三角形单元，形函数 $N_i$ 与对应于顶点 $i$ 的重心坐标相同。有限元理论中的一个标准结果是，第 $i$ 个重心坐标在三角形面积上的积分等于总面积的三分之一。即：\n$$\n\\int_{A_{f}(t)} N_{i}(\\boldsymbol{x},t) \\, dA = \\frac{A_{f}(t)}{3}\n$$\n对每个 $i \\in \\{1, 2, 3\\}$ 都成立。这可以通过注意到线性函数 $N_i$ 在三角形上的平均值是其在形心的值（即 $1/3$）来理解。\n\n将此结果代回我们关于 $w_f(t)$ 的方程中：\n$$\nA_{f}(t)\\,w_{f}(t) = \\sum_{i=1}^{3} \\left( \\frac{A_{f}(t)}{3} \\right) (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n问题陈述中指出顶点保持不共线，这确保了面面积 $A_f(t)$ 严格为正。因此，我们可以将方程两边同除以 $A_f(t)$：\n$$\nw_{f}(t) = \\sum_{i=1}^{3} \\frac{1}{3} (\\boldsymbol{v}_{i}(t) \\cdot \\boldsymbol{n}_{f}(t))\n$$\n通过提取常数和法向量，可以更紧凑地写为：\n$$\nw_{f}(t) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n该表达式将标量面法向速度定义为面顶点平均速度在面法向方向上的分量。请注意，对于瞬时速度的此番推导，并不需要顶点运动是时间线性的假设。\n\n**第二部分：唯一性证明**\n\n我们现在证明，所推导的 $w_f(t)$ 表达式，在所有从顶点速度集合 $\\{\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)\\}$ 到面法向速度的可能标量映射中是唯一的，其条件是该映射必须对*每一种*可能的顶点速度选择，都能再现正确的瞬时扫掠体积变化率。\n\n设该标量映射表示为 $\\mathcal{W}$，使得 $w_f(t) = \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t))$。面扫掠的瞬时体积变化率由运动学定义给出，即速度场法向分量在该表面上的面积分。在具有指定网格速度插值的 ALE 方法背景下，该变化率为：\n$$\n\\dot{V}_f(t) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n问题要求由映射 $\\mathcal{W}$ 生成的标量速度 $w_f(t)$ 再现相同的变化率：\n$$\nA_f(t) w_f(t) = \\dot{V}_f(t)\n$$\n因此，对映射 $\\mathcal{W}$ 的条件是：\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA\n$$\n正如在第一部分中确立的，右侧的积分计算结果为：\n$$\n\\int_{A_{f}(t)} \\boldsymbol{v}_{g}(\\boldsymbol{x},t)\\cdot \\boldsymbol{n}_{f}(t)\\, dA = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n将此代入关于 $\\mathcal{W}$ 的条件中：\n$$\nA_f(t) \\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{A_f(t)}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n由于 $A_f(t) \\neq 0$，我们可以用它来除方程两边，从而得到 $\\mathcal{W}$ 必须采用的显式函数形式：\n$$\n\\mathcal{W}(\\boldsymbol{v}_1(t), \\boldsymbol{v}_2(t), \\boldsymbol{v}_3(t)) = \\frac{1}{3} \\left( \\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t) \\right) \\cdot \\boldsymbol{n}_{f}(t)\n$$\n该方程为任何给定的速度输入集合 $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$ 指定了映射 $\\mathcal{W}$ 必须产生的确切值。由于该条件必须对这些速度的*所有*可能选择都成立，因此该函数形式是唯一确定的。任何其他映射 $\\mathcal{W}'$，如果对任何一组速度产生不同的值，都将违反再现由线性插值网格速度的积分所定义的正确瞬时扫掠体积变化率的基本要求。\n\n因此，所推导的 $w_f(t)$ 表达式不仅是一个有效的选择，而且是与所述前提一致的唯一选择。", "answer": "$$\n\\boxed{\\frac{1}{3} \\boldsymbol{n}_{f}(t) \\cdot \\left(\\boldsymbol{v}_{1}(t) + \\boldsymbol{v}_{2}(t) + \\boldsymbol{v}_{3}(t)\\right)}\n$$", "id": "3344771"}, {"introduction": "现代计算流体动力学求解器越来越多地使用多面体网格，以利用其灵活性和效率。本实践将三角形的原理推广到任意多边形网格面，这是迈向实际应用的关键一步。您将推导出一个适用于任何多面体单元的面法向速度公式，从而展示GCL框架的强大功能和普适性。[@problem_id:3344765]", "problem": "考虑一个在三维移动多面体网格上的任意拉格朗日-欧拉 (ALE) 有限体积格式。设单元 $i$ 具有边界面 $f \\in \\partial i$。每个面 $f$ 是一个具有 $N_{f} \\ge 3$ 个顶点的平面多边形，顶点由 $k=1,\\dots,N_{f}$ 循环标记，其顶点位置为 $\\mathbf{r}_{f,k}(t) \\in \\mathbb{R}^{3}$，顶点网格速度为 $\\mathbf{v}_{f,k}(t) = \\frac{d \\mathbf{r}_{f,k}}{dt}$。用 $\\mathbf{n}_{f}$ 表示面的外向き单位法向量，用 $A_{f}$ 表示面面积，用 $\\mathbf{c}_{f}$ 表示面心，定义为该多边形的面积形心。\n\n假设面内部的网格速度 $\\mathbf{v}(\\mathbf{x},t)$ 是通过在面的三角剖分上对顶点速度进行分片线性插值来构造的，该三角剖分是通过将面扇形分解为三角形 $\\left[ \\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1} \\right]$（$k=1,\\dots,N_{f}$）得到的（约定 $\\mathbf{r}_{f,N_{f}+1} \\equiv \\mathbf{r}_{f,1}$）。对于扇形中的每个三角形，令其投影到面法向量上的有向面积为\n$$\nA_{f,[\\mathbf{c}_{f},k,k+1]} \\equiv \\frac{1}{2}\\,\\mathbf{n}_{f} \\cdot \\left[ \\left(\\mathbf{r}_{f,k} - \\mathbf{c}_{f}\\right) \\times \\left(\\mathbf{r}_{f,k+1} - \\mathbf{c}_{f}\\right) \\right],\n$$\n以至于 $\\sum_{k=1}^{N_{f}} A_{f,[\\mathbf{c}_{f},k,k+1]} = A_{f}$，其中面的方向由 $A_{f,[\\mathbf{c}_{f},k,k+1]}$ 的符号编码。定义顶点“星形”面积权重为\n$$\nA_{f,k}^{\\star} \\equiv A_{f,[\\mathbf{c}_{f},k-1,k]} + A_{f,[\\mathbf{c}_{f},k,k+1]}, \\quad k=1,\\dots,N_{f},\n$$\n其中采用循环约定 $\\mathbf{r}_{f,0} \\equiv \\mathbf{r}_{f,N_{f}}$。\n\n从第一性原理——Reynolds输运定理和散度定理——出发，可以证明ALE框架中单元体积的精确几何守恒律 (GCL) 施加了离散恒等式\n$$\n\\frac{d V_{i}}{dt} \\;=\\; \\sum_{f \\in \\partial i} A_{f}\\, w_{f},\n$$\n其中 $w_{f}$ 是面法向网格速度，定义为 $\\mathbf{v}(\\mathbf{x},t)$ 在面上的法向分量的面积平均值。在每个面内给定分片线性插值的条件下，推导一个完全用顶点速度 $\\mathbf{v}_{f,k}$、面单位法向量 $\\mathbf{n}_{f}$、面面积 $A_{f}$ 和星形权重 $A_{f,k}^{\\star}$ 表示的 $w_{f}$ 的闭式表达式。您的表达式必须对任何多面体单元和任何与上述线性面插值一致的顶点运动都有效，并且必须精确保证离散GCL $\\frac{d V_{i}}{dt} = \\sum_{f} A_{f} w_{f}$。\n\n请将您的最终答案表示为关于 $\\left\\{ \\mathbf{v}_{f,k} \\right\\}$, $\\mathbf{n}_{f}$, $A_{f}$ 和 $\\left\\{ A_{f,k}^{\\star} \\right\\}$ 的单个 $w_{f}$ 解析公式。不需要进行数值计算。如果您引入任何额外的量，请将它们明确定义为给定几何数据的函数。最终答案必须是单个闭式表达式。不需要单位。角度单位不适用。", "solution": "根据定义，面法向网格速度 $w_{f}$ 是网格速度场 $\\mathbf{v}(\\mathbf{x},t)$ 的法向分量在面 $f$ 上的面积加权平均值。在数学上，这表示为：\n$$\nw_{f} = \\frac{1}{A_{f}} \\int_{A_{f}} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_{f} \\, dA\n$$\n根据问题描述，面 $A_f$ 上的积分是通过将面分解为以面心 $\\mathbf{c}_f$ 和面顶点 $[\\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1}]$ 构成的扇形三角形 $T_{f,k}$（$k = 1, \\dots, N_f$）来计算的。因此，积分可以写成在这些三角形上的积分之和：\n$$\nA_{f} w_{f} = \\sum_{k=1}^{N_{f}} \\int_{T_{f,k}} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_{f} \\, dA\n$$\n在每个三角形 $T_{f,k}$ 内，速度场 $\\mathbf{v}(\\mathbf{x},t)$ 是其三个顶点（面心 $\\mathbf{c}_f$、顶点 $\\mathbf{r}_{f,k}$ 和 $\\mathbf{r}_{f,k+1}$）处速度的线性插值。设面心速度为 $\\mathbf{v}_c \\equiv \\mathbf{v}(\\mathbf{c}_f, t)$。对于三角形上的线性函数，其积分等于三角形的面积乘以其在三个顶点处值的算术平均值。将此性质应用于速度场 $\\mathbf{v}(\\mathbf{x},t)$，我们得到：\n$$\n\\int_{T_{f,k}} \\mathbf{v}(\\mathbf{x},t) \\, dA = A_{f,[k]} \\frac{\\mathbf{v}_c + \\mathbf{v}_{f,k} + \\mathbf{v}_{f,k+1}}{3}\n$$\n此处，为简洁起见，我们将三角形 $[\\mathbf{c}_{f}, \\mathbf{r}_{f,k}, \\mathbf{r}_{f,k+1}]$ 的有向面积表示为 $A_{f,[k]}$。与法向量 $\\mathbf{n}_f$ 取点积，并对所有三角形求和：\n$$\nA_{f} w_{f} = \\sum_{k=1}^{N_{f}} \\left( A_{f,[k]} \\frac{\\mathbf{v}_c + \\mathbf{v}_{f,k} + \\mathbf{v}_{f,k+1}}{3} \\right) \\cdot \\mathbf{n}_{f}\n$$\n通过分离来自 $\\mathbf{v}_c$ 和顶点速度的贡献来重排此和：\n$$\n3 A_{f} w_{f} = (\\mathbf{v}_c \\cdot \\mathbf{n}_f) \\sum_{k=1}^{N_{f}} A_{f,[k]} + \\sum_{k=1}^{N_{f}} \\left( A_{f,[k]} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f) + A_{f,[k]} (\\mathbf{v}_{f,k+1} \\cdot \\mathbf{n}_f) \\right)\n$$\n由于 $\\sum_{k=1}^{N_{f}} A_{f,[k]} = A_f$，并且通过对第二个和重新索引，可以发现顶点速度 $\\mathbf{v}_{f,j}$ 的贡献系数恰好是 $A_{f,[j-1]} + A_{f,[j]}$，这正是顶点“星形”面积权重 $A_{f,j}^{\\star}$ 的定义。因此，方程变为：\n$$\n3 A_{f} w_{f} = A_{f} (\\mathbf{v}_c \\cdot \\mathbf{n}_f) + \\sum_{j=1}^{N_{f}} A_{f,j}^{\\star} (\\mathbf{v}_{f,j} \\cdot \\mathbf{n}_f)\n$$\n这个表达式仍包含未知的面心法向速度 $\\mathbf{v}_c \\cdot \\mathbf{n}_f$。为消除它，我们利用线性插值的一个关键性质：对于平面上的任何线性函数，其在面积形心处的值等于该函数的面积平均值。将此性质应用于法向速度分量 $\\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_f$：\n$$\n\\mathbf{v}_c \\cdot \\mathbf{n}_f = \\mathbf{v}(\\mathbf{c}_f, t) \\cdot \\mathbf{n}_f = \\frac{1}{A_f} \\int_{A_f} \\mathbf{v}(\\mathbf{x},t) \\cdot \\mathbf{n}_f \\, dA = w_f\n$$\n我们将此关键恒等式 $\\mathbf{v}_c \\cdot \\mathbf{n}_f = w_f$ 代入先前的方程中：\n$$\n3 A_{f} w_{f} = A_{f} w_{f} + \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n最后，解出 $w_f$：\n$$\n2 A_{f} w_{f} = \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n$$\nw_{f} = \\frac{1}{2 A_{f}} \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_f)\n$$\n该表达式完全用给定的量表示了面法向速度 $w_f$，并且对于给定的网格速度定义，它精确地满足了GCL。", "answer": "$$\n\\boxed{w_{f} = \\frac{1}{2 A_{f}} \\sum_{k=1}^{N_{f}} A_{f,k}^{\\star} (\\mathbf{v}_{f,k} \\cdot \\mathbf{n}_{f})}\n$$", "id": "3344765"}, {"introduction": "几何守恒不仅仅是空间离散化的问题，它与时间积分方法紧密相连。本问题探讨了时空几何守恒律（space-time GCL）的概念，要求您分析网格和流场的不同时间步进策略如何能够保持或破坏自由流条件。理解这种相互作用对于避免在移动边界的长时间模拟中出现细微但重大的错误至关重要。[@problem_id:3344776]", "problem": "一个可压缩流求解器以任意拉格朗日-欧拉 (ALE) 有限体积形式编写在变形网格上。设一个控制体用 $K(t)$ 表示，其面 $f$ 上的外向单位法向量为 $\\boldsymbol{n}_f(t)$，面面积为 $A_f(t)$，面网格速度为 $\\boldsymbol{v}_{m,f}(t)$。在大小为 $\\Delta t$ 的时间步 $[t^n,t^{n+1}]$ 内，守恒状态 $\\boldsymbol{U}$ 的更新通过一个分区算法执行：网格运动由一个时间积分器推进，而流场未知量由另一个时间积分器推进，两者可能具有不同的时间节点和权重。假设通量在移动控制体上进行评估，并且当 $\\boldsymbol{U}$ 是均匀自由来流时，流场求解器退化为纯粹的几何效应。\n\n从雷诺输运定理和移动控制体的积分守恒形式出发，论证自由来流保持施加了一个离散条件，该条件将网格运动的时间积分与流场更新的时间积分耦合起来。考虑以下关于网格运动和流场更新的显式与隐式时间积分，以及分区方法在何种条件下会违反时空几何守恒律 (GCL) 的陈述。选择所有正确的陈述。\n\nA. 如果用于积分流场残差的时间节点和权重与用于演化网格几何的时间节点和权重相同，并且提供给每个流场阶段的几何数据取自完全相同的时间点，那么无论任一子系统是显式实现还是隐式实现，离散时空GCL都成立。\n\nB. 为网格运动选择隐式时间积分器，同时为流场使用显式Runge–Kutta方法，总能保持时空GCL，因为隐式方法能更准确地解析网格运动学。\n\nC. 当用于流场残差中几何通量的时间求积不同于用于更新控制体几何的求积时，分区算法就会违反时空GCL，从而导致单元体积的离散时间导数和通过边界的净网格通量不由相同的时间权重和时间点来匹配。\n\nD. 如果每个时间步内的网格运动在时间上是严格线性的，并且所有面都进行刚性运动，那么任何二阶精度积分器的配对（例如，流场使用梯形法则，网格使用2阶向后差分格式）都会自动满足时空GCL，即使流场残差使用的是滞后于$t^n$的几何数据。\n\nE. 确保时空GCL的唯一方法是采用整体耦合推进，其中流场状态和网格坐标在每个隐式阶段同时求解；否则，分区方法必然违反GCL。\n\n你的推理必须从移动控制体上的积分守恒陈述和自由来流保持的定义开始，进而推导出时间积分和几何数据必须满足的离散条件。然后根据这个条件评估每个选项。通过选择所有正确选项来回答。", "solution": "该问题要求分析分区任意拉格朗日-欧拉 (ALE) 有限体积格式的几何守恒律 (GCL)，特别是在保持均匀自由来流的背景下。\n\n### 几何守恒律 (GCL) 的推导\n\n在随时间变化的控制体 $K(t)$ 上，某个量 $\\boldsymbol{U}$ 的守恒律的积分形式由雷诺输运定理给出，并包含在一个守恒陈述中：\n$$\n\\frac{d}{dt} \\int_{K(t)} \\boldsymbol{U} \\, dV + \\oint_{\\partial K(t)} [\\boldsymbol{f}(\\boldsymbol{U}) - \\boldsymbol{U} \\boldsymbol{v}_m^T] \\cdot \\boldsymbol{n} \\, dS = 0\n$$\n其中 $\\boldsymbol{f}(\\boldsymbol{U})$ 是标准的欧拉通量张量，$\\boldsymbol{v}_m$ 是控制体边界的速度（即网格速度）。\n\n自由来流保持原理指出，如果初始条件是均匀流场 $\\boldsymbol{U}(\\boldsymbol{x}, t=0) = \\boldsymbol{U}_\\infty = \\text{constant}$，那么解必须在所有时间都保持为 $\\boldsymbol{U}(\\boldsymbol{x}, t) = \\boldsymbol{U}_\\infty$，无论网格运动 $\\boldsymbol{v}_m(\\boldsymbol{x}, t)$ 如何。\n\n将常数状态 $\\boldsymbol{U} = \\boldsymbol{U}_\\infty$ 代入守恒律，$\\boldsymbol{U}_\\infty$ 和相应的欧拉通量 $\\boldsymbol{f}(\\boldsymbol{U}_\\infty)$ 在整个区域内都是常数。它们可以从空间积分中提出来：\n$$\n\\frac{d}{dt} (\\boldsymbol{U}_\\infty V_K(t)) + \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\oint_{\\partial K(t)} \\boldsymbol{n} \\, dS - \\boldsymbol{U}_\\infty \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0\n$$\n其中 $V_K(t) = \\int_{K(t)} 1 \\, dV$ 是控制体的体积。\n\n根据散度定理，闭合曲面上法向量的积分为零：$\\oint_{\\partial K(t)} \\boldsymbol{n} \\, dS = 0$。方程简化为：\n$$\n\\boldsymbol{U}_\\infty \\frac{d V_K(t)}{dt} - \\boldsymbol{U}_\\infty \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0\n$$\n由于这对于任何非平凡的自由来流 $\\boldsymbol{U}_\\infty \\neq 0$ 都必须成立，因此余下的表达式必须为零：\n$$\n\\frac{d V_K(t)}{dt} - \\oint_{\\partial K(t)} (\\boldsymbol{v}_m \\cdot \\boldsymbol{n}) \\, dS = 0 \\quad \\implies \\quad \\frac{d V_K(t)}{dt} = \\oint_{\\partial K(t)} \\boldsymbol{v}_m \\cdot \\boldsymbol{n} \\, dS\n$$\n这就是**连续时空几何守恒律 (GCL)**。它是一个纯粹的几何约束，表明体积的变化率必须等于边界速度的净通量。\n\n### 离散GCL与分区格式\n\n现在，我们考虑离散形式。对于一个有限体积单元 $K_i$，其半离散守恒律为：\n$$\n\\frac{d(V_i \\boldsymbol{U}_i)}{dt} + \\sum_{f \\in \\partial K_i} \\left( \\mathcal{F}(\\boldsymbol{U}_L, \\boldsymbol{U}_R) - \\mathcal{U}_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) = 0\n$$\n其中 $\\mathcal{F}$ 是数值无粘通量，$\\mathcal{U}_f$ 是用于面 $f$ 处几何通量项的状态。从时间 $t^n$ 积分到 $t^{n+1} = t^n + \\Delta t$：\n$$\n(V_i \\boldsymbol{U}_i)^{n+1} - (V_i \\boldsymbol{U}_i)^{n} + \\int_{t^n}^{t^{n+1}} \\left( \\sum_{f \\in \\partial K_i} \\left( \\mathcal{F}_f - \\mathcal{U}_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) \\right) dt = 0\n$$\n为了保持自由来流，我们设置 $\\boldsymbol{U}_i^n = \\boldsymbol{U}_\\infty$ 并要求 $\\boldsymbol{U}_i^{n+1} = \\boldsymbol{U}_\\infty$。在均匀流中，$\\mathcal{F}_f = \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\boldsymbol{n}_f A_f$ 且 $\\mathcal{U}_f = \\boldsymbol{U}_\\infty$。方程变为：\n$$\nV_i^{n+1} \\boldsymbol{U}_\\infty - V_i^n \\boldsymbol{U}_\\infty + \\int_{t^n}^{t^{n+1}} \\left( \\boldsymbol{f}(\\boldsymbol{U}_\\infty) \\cdot \\sum_{f \\in \\partial K_i} \\boldsymbol{n}_f A_f - \\boldsymbol{U}_\\infty \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\right) dt = 0\n$$\n假设离散几何在所有时刻都是封闭的，即 $\\sum_{f \\in \\partial K_i} \\boldsymbol{n}_f A_f = 0$，则通量项消失。我们得到：\n$$\n\\boldsymbol{U}_\\infty \\left( (V_i^{n+1} - V_i^n) - \\int_{t^n}^{t^{n+1}} \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\, dt \\right) = 0\n$$\n这就导出了**离散时空GCL**：\n$$\nV_i^{n+1} - V_i^n = \\int_{t^n}^{t^{n+1}} \\sum_{f \\in \\partial K_i} (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) \\, dt\n$$\n在一个分区格式中，左侧的 $V_i^{n+1} - V_i^n$ 由用于推进网格几何的时间积分器确定。右侧是几何通量的时间积分，由流场求解器的时间积分器计算。当且仅当这两个计算产生完全相同的结果时，GCL才得以满足。如果用于从网格运动计算体积变化的数值求积（时间节点和权重）与用于积分流场残差中几何通量项的求积不一致，就会发生违反。\n\n### 选项评估\n\n**A. 如果用于积分流场残差的时间节点和权重与用于演化网格几何的时间节点和权重相同，并且提供给每个流场阶段的几何数据取自完全相同的时间点，那么无论任一子系统是显式实现还是隐式实现，离散时空GCL都成立。**\n\n这个陈述描述了一个完全同步的分区格式。假设网格和流场的时间积分都由一个具有权重 $w_k$ 和时间节点 $t_k$ 的求积法则定义。网格被推进到 $t^{n+1}$，得到体积 $V_i^{n+1}$。流场求解器使用相同的求积法则计算几何通量的积分：$\\Delta t \\sum_k w_k (\\sum_f \\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f)_{t=t_k}$。如果在每个阶段 $k$，流场求解器使用的几何数据 $(\\boldsymbol{v}_{m,f}, \\boldsymbol{n}_f, A_f)$ 与网格积分器在同一阶段产生的几何形状一致，并且离散体积计算本身与边界运动一致（即，离散散度定理对几何成立），那么计算出的体积变化将与计算出的积分通量完全匹配。只要保持这种同步，积分器的具体性质（显式或隐式）是无关紧要的。这描述了所谓的“GCL一致”分区格式背后的原理。\n**结论：正确。**\n\n**B. 为网格运动选择隐式时间积分器，同时为流场使用显式Runge–Kutta方法，总能保持时空GCL，因为隐式方法能更准确地解析网格运动学。**\n\n这个陈述是错误的。GCL是一个一致性问题，而不是精度问题。一个用于网格的隐式积分器（如后向欧拉法）实际上使用在 $t^{n+1}$ 处的单点求积来确定体积变化 $V^{n+1}-V^n$。而一个用于流场的显式多级Runge-Kutta方法则使用一个具有特定中间时间节点和权重的多点求积法则来积分通量残差。这两种求积法则是根本不同的。网格求解器计算的 $V^{n+1}-V^n$ 将不匹配流场求解器计算的积分几何通量。因此，GCL将被违反。隐式方法更高的精度与这种一致性要求无关。\n**结论：错误。**\n\n**C. 当用于流场残差中几何通量的时间求积不同于用于更新控制体几何的求积时，分区算法就会违反时空GCL，从而导致单元体积的离散时间导数和通过边界的净网格通量不由相同的时间权重和时间点来匹配。**\n\n这个陈述是对上面推导出的GCL违反条件的精确表述。“单元体积的离散时间导数”代表由网格演化格式执行的 $(V_i^{n+1}-V_i^n)/\\Delta t$ 的计算。“通过边界的净网格通量”指的是由流场求解器计算的时间平均值 $\\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} \\sum_f (\\boldsymbol{v}_{m,f} \\cdot \\boldsymbol{n}_f A_f) dt$。如果这两个计算所基于的数值求积（由时间权重和时间点定义）不同，它们的结果将不相等，GCL将被违反。\n**结论：正确。**\n\n**D. 如果每个时间步内的网格运动在时间上是严格线性的，并且所有面都进行刚性运动，那么任何二阶精度积分器的配对（例如，流场使用梯形法则，网格使用2阶向后差分格式）都会自动满足时空GCL，即使流场残差使用的是滞后于$t^n$的几何数据。**\n\n这个陈述包含几个缺陷。首先，假设网格运动在时间上是严格线性的（恒定速度），这与使用像BDF2这样的通用多步积分器来推进网格动力学是不一致的，因为后者只在非常刻意的情况下才会产生线性运动。其次，更关键的是，使用滞后于 $t^n$ 的几何数据是GCL误差的一个主要来源。如果几何通量率在时间上不是恒定的，流场求解器会将积分近似为 $(\\text{在 } t^n \\text{ 处的通量率}) \\times \\Delta t$，而从 $t^n$ 到 $t^{n+1}$ 的实际体积变化将是不同的。即使在线性运动（恒定通量率，比如 $C$）的限制性假设下，精确积分为 $C \\Delta t$ 且滞后近似为 $C^n \\Delta t = C \\Delta t$，“任何配对”的积分器都有效的说法也过于强烈，并且忽略了其自身前提中的矛盾。这个说法通常不成立。\n**结论：错误。**\n\n**E. 确保时空GCL的唯一方法是采用整体耦合推进，其中流场状态和网格坐标在每个隐式阶段同时求解；否则，分区方法必然违反GCL。**\n\n这个陈述过于绝对且事实不符。虽然整体（完全耦合）格式通过在单个方程组内求解几何和流场状态，从而内在地满足GCL，但它们并不是“唯一的方法”。正如在对选项A的分析中所确立的，可以构建分区格式来完美地满足GCL。这些通常被称为“序贯一致”或“运动学一致”的分区格式，其中子问题（网格和流场）使用相同的时间积分公式推进，并且在每个阶段都传递一致的数据。因此，分区方法并不“必然”违反GCL。\n**结论：错误。**", "answer": "$$\\boxed{AC}$$", "id": "3344776"}]}