{"hands_on_practices": [{"introduction": "这项实践练习是有限体积法的一项基础训练。通过对一个四面体控制体手动应用散度定理，你将把连续的散度算子转化为离散的、跨越单元所有面的通量之和。这项动手计算 [@problem_id:3291622] 旨在巩固你对守恒律如何被离散化的理解，并突显数值积分在近似表示这些通量的面积分中所扮演的角色。", "problem": "考虑计算流体动力学 (CFD) 中有限体积法 (FVM) 的一个控制体：一个四面体 $K$，其顶点为 $\\mathbf{v}_0=(0,0,0)$、$\\mathbf{v}_1=(1,0,0)$、$\\mathbf{v}_2=(0,2,0)$ 和 $\\mathbf{v}_3=(0,0,3)$。设向量场为 $\\mathbf{F}(\\mathbf{x})=[x^2,xy,y^2]^{\\mathsf{T}}$。通过在 $K$ 上应用散度定理，并对每个三角形面使用单点形心积分法则（1次精度）来近似每个面的通量，从而定义单元 $P$ 处的离散散度：对于每个面 $f$，其形心为 $\\mathbf{x}_f^{c}$，外法向面积向量为 $\\mathbf{a}_f=\\int_{f}\\mathbf{n}\\,\\mathrm{d}S$，将 $\\int_{f}\\mathbf{F}\\cdot\\mathbf{n}\\,\\mathrm{d}S$ 近似为 $\\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f$，并设\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P \\equiv \\frac{1}{|K|}\\sum_{f\\subset \\partial K} \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f.\n$$\n对上述四面体 $K$ 精确计算 $(\\nabla_h\\cdot \\mathbf{F})_P$。然后，独立计算精确的单元平均散度 $\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K$ 并进行比较，解释存在的任何差异。将 $(\\nabla_h\\cdot \\mathbf{F})_P$ 的最终数值结果精确地表示为一个有理数（不要四舍五入）。无需单位。", "solution": "我们从散度定理开始，该定理指出，对于一个足够光滑的向量场 $\\mathbf{F}$ 和一个具有边界 $\\partial K$ 和单位外法向量 $\\mathbf{n}$ 的控制体 $K$，\n$$\n\\int_{K} \\nabla\\cdot \\mathbf{F}\\,\\mathrm{d}V \\;=\\; \\oint_{\\partial K} \\mathbf{F}\\cdot \\mathbf{n}\\,\\mathrm{d}S.\n$$\n在有限体积法 (FVM) 中，与控制体 $K$ 相关联的单元 $P$ 处的离散散度是通过近似边界通量得到的。在每个三角形面 $f$ 上使用单点形心求积，我们近似\n$$\n\\int_{f} \\mathbf{F}\\cdot \\mathbf{n}\\,\\mathrm{d}S \\;\\approx\\; \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f,\n$$\n其中 $\\mathbf{a}_f=\\int_{f}\\mathbf{n}\\,\\mathrm{d}S=\\mathbf{n}_f A_f$ 是面 $f$ 的外法向面积向量（对于平面是常数），$\\mathbf{x}_f^{c}$ 是面心。因此，\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P \\;=\\; \\frac{1}{|K|}\\sum_{f\\subset \\partial K} \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f.\n$$\n\n步骤 $1$：四面体 $K$ 的几何属性。\n设顶点为 $\\mathbf{v}_0=(0,0,0)$、$\\mathbf{v}_1=(1,0,0)$、$\\mathbf{v}_2=(0,2,0)$ 和 $\\mathbf{v}_3=(0,0,3)$。体积为\n$$\n|K| \\;=\\; \\frac{1}{6}\\,\\det\\big[\\mathbf{v}_1-\\mathbf{v}_0,\\;\\mathbf{v}_2-\\mathbf{v}_0,\\;\\mathbf{v}_3-\\mathbf{v}_0\\big]\n\\;=\\; \\frac{1}{6}\\,\\det\\begin{bmatrix}1&0&0\\\\ 0&2&0\\\\ 0&0&3\\end{bmatrix}\n\\;=\\; \\frac{1}{6}\\cdot 6 \\;=\\; 1.\n$$\n\n步骤 $2$：列举各个面、形心和外法向面积向量。\n我们取每个顶点所对的四个三角形面：\n- 面 $f_0$ 对应顶点 $\\mathbf{v}_0$：三角形 $(\\mathbf{v}_1,\\mathbf{v}_2,\\mathbf{v}_3)$。\n- 面 $f_1$ 对应顶点 $\\mathbf{v}_1$：三角形 $(\\mathbf{v}_0,\\mathbf{v}_2,\\mathbf{v}_3)$。\n- 面 $f_2$ 对应顶点 $\\mathbf{v}_2$：三角形 $(\\mathbf{v}_0,\\mathbf{v}_3,\\mathbf{v}_1)$。\n- 面 $f_3$ 对应顶点 $\\mathbf{v}_3$：三角形 $(\\mathbf{v}_0,\\mathbf{v}_1,\\mathbf{v}_2)$。\n\n对于一个顶点为 $(\\mathbf{a},\\mathbf{b},\\mathbf{c})$ 的面，一个面积向量为\n$$\n\\mathbf{a}_{\\text{raw}} \\;=\\; \\frac{1}{2}\\,(\\mathbf{b}-\\mathbf{a})\\times(\\mathbf{c}-\\mathbf{a}),\n$$\n其方向通过确保 $\\mathbf{a}_f\\cdot(\\mathbf{v}_{\\text{opp}}-\\mathbf{x}_f^{c})$ 的符号正确来校正为朝外，其中 $\\mathbf{v}_{\\text{opp}}$ 是相对的顶点，$\\mathbf{x}_f^{c}=(\\mathbf{a}+\\mathbf{b}+\\mathbf{c})/3$ 是面心。如果原始向量朝内，则翻转其符号。\n\n计算面心：\n- $f_0$: $\\mathbf{x}_{f_0}^{c}=\\big(\\frac{1}{3},\\frac{2}{3},1\\big)$。\n- $f_1$: $\\mathbf{x}_{f_1}^{c}=\\big(0,\\frac{2}{3},1\\big)$。\n- $f_2$: $\\mathbf{x}_{f_2}^{c}=\\big(\\frac{1}{3},0,1\\big)$。\n- $f_3$: $\\mathbf{x}_{f_3}^{c}=\\big(\\frac{1}{3},\\frac{2}{3},0\\big)$。\n\n计算面积向量：\n\n对于面 $f_0$，其顶点为 $(\\mathbf{v}_1,\\mathbf{v}_2,\\mathbf{v}_3)$：\n$$\n(\\mathbf{v}_2-\\mathbf{v}_1) = (-1,2,0),\\quad (\\mathbf{v}_3-\\mathbf{v}_1)=(-1,0,3),\n$$\n$$\n(\\mathbf{v}_2-\\mathbf{v}_1)\\times(\\mathbf{v}_3-\\mathbf{v}_1) = (6,3,2),\\quad \\mathbf{a}_{f_0,\\text{raw}}=\\frac{1}{2}(6,3,2)=(3,\\tfrac{3}{2},1).\n$$\n对于 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_0$ 和 $\\mathbf{x}_{f_0}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},1)$，\n$$\n\\mathbf{a}_{f_0,\\text{raw}}\\cdot(\\mathbf{v}_0-\\mathbf{x}_{f_0}^{c})=(3,\\tfrac{3}{2},1)\\cdot(-\\tfrac{1}{3},-\\tfrac{2}{3},-1)=-3  0,\n$$\n所以 $\\mathbf{a}_{f_0}=(3,\\tfrac{3}{2},1)$ 已经是朝外的。\n\n对于面 $f_1$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_2,\\mathbf{v}_3)$：\n$$\n(\\mathbf{v}_2-\\mathbf{v}_0)=(0,2,0),\\quad (\\mathbf{v}_3-\\mathbf{v}_0)=(0,0,3),\n$$\n$$\n(\\mathbf{v}_2-\\mathbf{v}_0)\\times(\\mathbf{v}_3-\\mathbf{v}_0)=(6,0,0),\\quad \\mathbf{a}_{f_1,\\text{raw}}=(3,0,0).\n$$\n对于 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_1$ 和 $\\mathbf{x}_{f_1}^{c}=(0,\\tfrac{2}{3},1)$，\n$$\n\\mathbf{a}_{f_1,\\text{raw}}\\cdot(\\mathbf{v}_1-\\mathbf{x}_{f_1}^{c})=(3,0,0)\\cdot(1,-\\tfrac{2}{3},-1)=3 > 0,\n$$\n所以 $\\mathbf{a}_{f_1}=-(3,0,0)=(-3,0,0)$ 是朝外的。\n\n对于面 $f_2$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_3,\\mathbf{v}_1)$：\n$$\n(\\mathbf{v}_3-\\mathbf{v}_0)=(0,0,3),\\quad (\\mathbf{v}_1-\\mathbf{v}_0)=(1,0,0),\n$$\n$$\n(\\mathbf{v}_3-\\mathbf{v}_0)\\times(\\mathbf{v}_1-\\mathbf{v}_0)=(0,3,0),\\quad \\mathbf{a}_{f_2,\\text{raw}}=(0,\\tfrac{3}{2},0).\n$$\n对于 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_2$ 和 $\\mathbf{x}_{f_2}^{c}=(\\tfrac{1}{3},0,1)$，\n$$\n\\mathbf{a}_{f_2,\\text{raw}}\\cdot(\\mathbf{v}_2-\\mathbf{x}_{f_2}^{c})=(0,\\tfrac{3}{2},0)\\cdot(-\\tfrac{1}{3},2,-1)=3 > 0,\n$$\n所以 $\\mathbf{a}_{f_2}=-(0,\\tfrac{3}{2},0)=(0,-\\tfrac{3}{2},0)$ 是朝外的。\n\n对于面 $f_3$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_1,\\mathbf{v}_2)$：\n$$\n(\\mathbf{v}_1-\\mathbf{v}_0)=(1,0,0),\\quad (\\mathbf{v}_2-\\mathbf{v}_0)=(0,2,0),\n$$\n$$\n(\\mathbf{v}_1-\\mathbf{v}_0)\\times(\\mathbf{v}_2-\\mathbf{v}_0)=(0,0,2),\\quad \\mathbf{a}_{f_3,\\text{raw}}=(0,0,1).\n$$\n对于 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_3$ 和 $\\mathbf{x}_{f_3}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},0)$，\n$$\n\\mathbf{a}_{f_3,\\text{raw}}\\cdot(\\mathbf{v}_3-\\mathbf{x}_{f_3}^{c})=(0,0,1)\\cdot(-\\tfrac{1}{3},-\\tfrac{2}{3},3)=3 > 0,\n$$\n所以 $\\mathbfa_{f_3}=-(0,0,1)=(0,0,-1)$ 是朝外的。\n\n步骤 $3$：在面心处计算 $\\mathbf{F}$ 并近似通量。\n向量场为 $\\mathbf{F}=[x^2,xy,y^2]^{\\mathsf{T}}$。在形心处求值：\n\n- 在面 $f_0$ 上，$\\mathbf{x}_{f_0}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},1)$：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_0}^{c})=\\Big[\\big(\\tfrac{1}{3}\\big)^2,\\;\\tfrac{1}{3}\\cdot \\tfrac{2}{3},\\;\\big(\\tfrac{2}{3}\\big)^2\\Big]=\\Big[\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big].\n$$\n通量近似：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_0}^{c})\\cdot \\mathbf{a}_{f_0}=\\Big(\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big)\\cdot \\Big(3,\\tfrac{3}{2},1\\Big)=\\tfrac{3}{9}+\\tfrac{3}{9}+\\tfrac{4}{9}=\\tfrac{10}{9}.\n$$\n\n- 在面 $f_1$ 上，$\\mathbf{x}_{f_1}^{c}=(0,\\tfrac{2}{3},1)$：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_1}^{c})=\\big[0,\\;0,\\;\\tfrac{4}{9}\\big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_1}^{c})\\cdot \\mathbf{a}_{f_1}=\\big(0,0,\\tfrac{4}{9}\\big)\\cdot(-3,0,0)=0.\n$$\n\n- 在面 $f_2$ 上，$\\mathbf{x}_{f_2}^{c}=(\\tfrac{1}{3},0,1)$：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_2}^{c})=\\big[\\tfrac{1}{9},\\;0,\\;0\\big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_2}^{c})\\cdot \\mathbf{a}_{f_2}=\\big(\\tfrac{1}{9},0,0\\big)\\cdot(0,-\\tfrac{3}{2},0)=0.\n$$\n\n- 在面 $f_3$ 上，$\\mathbf{x}_{f_3}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},0)$：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_3}^{c})=\\Big[\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_3}^{c})\\cdot \\mathbf{a}_{f_3}=\\Big(\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big)\\cdot(0,0,-1)=-\\tfrac{4}{9}.\n$$\n\n对近似的面通量求和：\n$$\n\\sum_{f}\\mathbf{F}(\\mathbf{x}_{f}^{c})\\cdot \\mathbf{a}_{f}=\\tfrac{10}{9}+0+0-\\tfrac{4}{9}=\\tfrac{6}{9}=\\tfrac{2}{3}.\n$$\n由于 $|K|=1$，我们得到\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P=\\frac{1}{|K|}\\sum_{f}\\mathbf{F}(\\mathbf{x}_{f}^{c})\\cdot \\mathbf{a}_{f}=\\tfrac{2}{3}.\n$$\n\n步骤 $4$：精确的单元平均散度及比较。\n计算解析散度：\n$$\n\\nabla\\cdot \\mathbf{F}=\\frac{\\partial}{\\partial x}(x^2)+\\frac{\\partial}{\\partial y}(xy)+\\frac{\\partial}{\\partial z}(y^2)=2x+x+0=3x.\n$$\n精确的单元平均值为\n$$\n\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K \\;=\\; \\frac{1}{|K|}\\int_{K} 3x\\,\\mathrm{d}V \\;=\\; 3\\,\\bar{x}_K,\n$$\n其中 $\\bar{x}_K$ 是 $x$ 在 $K$ 上的体平均值。对于四面体，线性函数的体平均值等于其在形心处的值，而形心是顶点的平均值。因此\n$$\n\\bar{x}_K=\\frac{x_0+x_1+x_2+x_3}{4}=\\frac{0+1+0+0}{4}=\\frac{1}{4},\n$$\n所以\n$$\n\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K=3\\cdot \\frac{1}{4}=\\frac{3}{4}.\n$$\n因此，使用1次面求积的有符号差异是\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P-\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K=\\frac{2}{3}-\\frac{3}{4}=-\\frac{1}{12}.\n$$\n出现非零误差的原因是，被积函数 $\\mathbf{F}\\cdot \\mathbf{n}$ 在每个平面三角形面上是二次多项式，而单点形心法则在三角形上仅能对最高1次的多项式进行精确积分。一个2次精确的三角形求积法则将能精确地积分每个面通量，从而对于此处的 $\\mathbf{F}$ 和 $K$，离散平均散度与精确平均散度将相等。", "answer": "$$\\boxed{\\tfrac{2}{3}}$$", "id": "3291622"}, {"introduction": "在离散化计算域内部后，我们必须正确处理区域的边界。本问题聚焦于在有限体积法框架内实现边界条件这一关键任务。你将推导出一个施加了对流（Robin）条件的边界面对单元残差的代数贡献，从而将物理边界数据与离散方程联系起来 [@problem_id:3291615]。这项练习展示了方程组是如何封闭的，以及外部环境参数是如何被整合到模拟中的。", "problem": "考虑在计算流体动力学（CFD）的有限体积法（FVM）框架内，一个由守恒形式的对流-扩散方程控制的被动标量 $\\phi$ 的稳态输运。令 $V_{P}$ 为与单元中心 $P$ 相关联的控制体，其边界 $\\partial V_{P}$ 包含一个面积为 $A_{b}$、外向单位法向量为 $\\boldsymbol{n}_{b}$ 的平坦边界面 $b$。单元 $P$ 的总残差定义为\n$$\nR_{P}(\\phi)\\;:=\\;\\oint_{\\partial V_{P}}\\left(\\rho\\,\\boldsymbol{u}\\,\\phi-\\Gamma\\,\\nabla\\phi\\right)\\cdot\\boldsymbol{n}\\,\\mathrm{d}A\\;-\\;\\int_{V_{P}}S_{\\phi}\\,\\mathrm{d}V,\n$$\n其中 $\\rho$ 是密度，$\\boldsymbol{u}$ 是速度，$\\Gamma$ 是扩散系数，$S_{\\phi}$ 是体积源项。假设 $\\rho$ 和 $\\Gamma$ 在 $P$ 附近为常数。面 $b$ 位于出口边界上，其法向速度分量 $u_{n}:=\\boldsymbol{u}\\cdot\\boldsymbol{n}_{b}$ 满足 $u_{n} > 0$。在该边界上，标量 $\\phi$ 满足一个对流（Robin）边界条件\n$$\n-\\Gamma\\,\\frac{\\partial\\phi}{\\partial n}\\Big|_{b}\\;=\\;h\\left(\\phi_{b}-\\phi_{\\infty}\\right),\n$$\n其中 $\\partial\\phi/\\partial n:=\\nabla\\phi\\cdot\\boldsymbol{n}_{b}$，$h$ 是给定的传输系数，$\\phi_{b}$ 是 $\\phi$ 在边界面上的值，$\\phi_{\\infty}$ 是一个指定的外部环境值。\n\n仅使用散度定理、上述积分控制体陈述以及以下两个封闭关系：\n- 对于 $b$ 处的对流项，使用一阶迎风插值，因此由于 $u_{n} > 0$，面上的值等于迎风单元的值；\n- 对于 $b$ 处的扩散项，假设 $\\phi$ 在垂直于该面的方向上呈一维线性变化，其中 $d_{Pb}$ 表示从单元中心 $P$ 沿 $\\boldsymbol{n}_{b}$ 到面 $b$ 的距离，\n\n推导边界面对残差 $R_{P}(\\phi)$ 的贡献 $R_{b}(\\phi_{P})$ 的闭合形式表达式，该表达式仅用 $\\phi_{P}$、$\\phi_{\\infty}$ 以及已知参数 $A_{b}$、$\\rho$、$u_{n}$、$\\Gamma$、$h$ 和 $d_{Pb}$ 表示。此处，$\\phi_{P}$ 表示 $P$ 中的单元中心值。你的答案必须是单个闭合形式的解析表达式。最终答案中不要包含任何单位。", "solution": "该问题要求推导单个边界面 $b$ 对控制体 $V_{P}$ 的总残差 $R_{P}(\\phi)$ 的贡献。这个贡献，我们称之为 $R_{b}$，是通过面 $b$ 的标量 $\\phi$ 的总通量。根据所提供的残差的积分定义，通过边界 $\\partial V_{P}$ 的总通量由面积分给出。因此，来自面 $b$ 的贡献是：\n$$\nR_{b} = \\int_{b}\\left(\\rho\\,\\boldsymbol{u}\\,\\phi-\\Gamma\\,\\nabla\\phi\\right)\\cdot\\boldsymbol{n}_{b}\\,\\mathrm{d}A\n$$\n其中 $\\boldsymbol{n}_{b}$ 是面 $b$ 的外向单位法向量。总通量由对流部分和扩散部分组成。我们可以将积分分成两个分量：\n$$\nR_{b} = \\int_{b}\\left(\\rho\\,\\boldsymbol{u}\\cdot\\boldsymbol{n}_{b}\\right)\\phi\\,\\mathrm{d}A + \\int_{b}\\left(-\\Gamma\\,\\nabla\\phi\\cdot\\boldsymbol{n}_{b}\\right)\\,\\mathrm{d}A\n$$\n我们将对流通量贡献表示为 $R_{b,adv}$，扩散通量贡献表示为 $R_{b,diff}$。\n\n首先，我们离散化对流项 $R_{b,adv}$：\n$$\nR_{b,adv} = \\int_{b}\\left(\\rho\\,\\boldsymbol{u}\\cdot\\boldsymbol{n}_{b}\\right)\\phi\\,\\mathrm{d}A\n$$\n问题陈述密度 $\\rho$ 是常数。面 $b$ 是平坦的，面积为 $A_{b}$，我们可以假设法向速度分量 $u_{n} := \\boldsymbol{u}\\cdot\\boldsymbol{n}_{b}$ 在整个面上是均匀的。面上的 $\\phi$ 值表示为 $\\phi_{b}$。因此积分简化为：\n$$\nR_{b,adv} = \\rho\\, u_{n}\\, \\phi_{b} \\, A_{b}\n$$\n问题指定对流项使用一阶迎风插值格式。由于流动是出口流，特征为 $u_{n} > 0$，因此迎风单元是内部单元 $P$。所以，面上的标量值取为单元中心值 $\\phi_{P}$：\n$$\n\\phi_{b} = \\phi_{P} \\quad (\\text{用于对流})\n$$\n将此代入对流通量的表达式中，得到：\n$$\nR_{b,adv} = \\rho\\, u_{n}\\, \\phi_{P}\\, A_{b}\n$$\n\n接下来，我们离散化扩散项 $R_{b,diff}$：\n$$\nR_{b,diff} = \\int_{b}\\left(-\\Gamma\\,\\nabla\\phi\\cdot\\boldsymbol{n}_{b}\\right)\\,\\mathrm{d}A\n$$\n量 $-\\Gamma\\,\\nabla\\phi\\cdot\\boldsymbol{n}_{b}$ 是通过面的扩散通量密度。问题在面 $b$ 上提供了一个对流（Robin）边界条件：\n$$\n-\\Gamma\\,\\frac{\\partial\\phi}{\\partial n}\\Big|_{b} = h\\left(\\phi_{b}-\\phi_{\\infty}\\right)\n$$\n其中 $\\partial\\phi/\\partial n := \\nabla\\phi\\cdot\\boldsymbol{n}_{b}$ 是法向导数。假设传输系数 $h$ 和外部环境值 $\\phi_{\\infty}$ 在整个面上是均匀的，我们可以直接用面值 $\\phi_{b}$ 来写出扩散通量贡献：\n$$\nR_{b,diff} = \\int_{b} h(\\phi_{b} - \\phi_{\\infty}) \\,\\mathrm{d}A = h\\,A_{b}\\,(\\phi_{b} - \\phi_{\\infty})\n$$\n这个表达式仍然包含未知的面值 $\\phi_{b}$。为了消去它，我们使用提供的第二个封闭关系：假设 $\\phi$ 在垂直于面的方向上呈一维线性变化。这使我们能够使用单元中心值 $\\phi_{P}$ 和面值 $\\phi_{b}$ 来近似面上的法向导数：\n$$\n\\frac{\\partial\\phi}{\\partial n}\\Big|_{b} \\approx \\frac{\\phi_{b} - \\phi_{P}}{d_{Pb}}\n$$\n其中 $d_{Pb}$ 是从单元中心 $P$ 到面 $b$ 的法向距离。现在我们可以为扩散通量密度写出另一个表达式：\n$$\n-\\Gamma\\,\\frac{\\partial\\phi}{\\partial n}\\Big|_{b} \\approx -\\Gamma\\,\\frac{\\phi_{b} - \\phi_{P}}{d_{Pb}}\n$$\n通过将扩散通量密度的两个表达式（来自 Robin 条件和线性剖面假设）相等，我们可以解出 $\\phi_{b}$：\n$$\nh\\left(\\phi_{b}-\\phi_{\\infty}\\right) = -\\Gamma\\,\\frac{\\phi_{b} - \\phi_{P}}{d_{Pb}}\n$$\n乘以 $d_{Pb}$ 以消去分数：\n$$\nh\\,d_{Pb}\\,(\\phi_{b}-\\phi_{\\infty}) = -\\Gamma\\,(\\phi_{b}-\\phi_{P})\n$$\n$$\nh\\,d_{Pb}\\,\\phi_{b} - h\\,d_{Pb}\\,\\phi_{\\infty} = -\\Gamma\\,\\phi_{b} + \\Gamma\\,\\phi_{P}\n$$\n现在，我们合并含有 $\\phi_{b}$ 的项：\n$$\n(h\\,d_{Pb} + \\Gamma)\\,\\phi_{b} = \\Gamma\\,\\phi_{P} + h\\,d_{Pb}\\,\\phi_{\\infty}\n$$\n解出 $\\phi_{b}$：\n$$\n\\phi_{b} = \\frac{\\Gamma\\,\\phi_{P} + h\\,d_{Pb}\\,\\phi_{\\infty}}{\\Gamma + h\\,d_{Pb}}\n$$\n现在我们将这个 $\\phi_{b}$ 的表达式代回到我们的扩散通量方程 $R_{b,diff} = h\\,A_{b}\\,(\\phi_{b} - \\phi_{\\infty})$ 中：\n$$\nR_{b,diff} = h\\,A_{b}\\left(\\frac{\\Gamma\\,\\phi_{P} + h\\,d_{Pb}\\,\\phi_{\\infty}}{\\Gamma + h\\,d_{Pb}} - \\phi_{\\infty}\\right)\n$$\n为了简化括号中的项，我们通分：\n$$\n\\frac{\\Gamma\\,\\phi_{P} + h\\,d_{Pb}\\,\\phi_{\\infty} - \\phi_{\\infty}(\\Gamma + h\\,d_{Pb})}{\\Gamma + h\\,d_{Pb}} = \\frac{\\Gamma\\,\\phi_{P} + h\\,d_{Pb}\\,\\phi_{\\infty} - \\Gamma\\,\\phi_{\\infty} - h\\,d_{Pb}\\,\\phi_{\\infty}}{\\Gamma + h\\,d_{Pb}}\n$$\n$$\n= \\frac{\\Gamma\\,\\phi_{P} - \\Gamma\\,\\phi_{\\infty}}{\\Gamma + h\\,d_{Pb}} = \\frac{\\Gamma\\,(\\phi_{P} - \\phi_{\\infty})}{\\Gamma + h\\,d_{Pb}}\n$$\n将此代回到 $R_{b,diff}$ 的表达式中：\n$$\nR_{b,diff} = h\\,A_{b}\\,\\left(\\frac{\\Gamma\\,(\\phi_{P} - \\phi_{\\infty})}{\\Gamma + h\\,d_{Pb}}\\right) = \\frac{h\\,\\Gamma\\,A_{b}}{\\Gamma + h\\,d_{Pb}}(\\phi_{P} - \\phi_{\\infty})\n$$\n最后，总的边界面贡献 $R_{b}(\\phi_{P})$ 是对流和扩散贡献之和：\n$$\nR_{b}(\\phi_{P}) = R_{b,adv} + R_{b,diff}\n$$\n$$\nR_{b}(\\phi_{P}) = \\rho\\, u_{n}\\, \\phi_{P}\\, A_{b} + \\frac{h\\,\\Gamma\\,A_{b}}{\\Gamma + h\\,d_{Pb}}(\\phi_{P} - \\phi_{\\infty})\n$$\n这个表达式可以重新排列，以合并 $\\phi_{P}$ 和 $\\phi_{\\infty}$ 的系数：\n$$\nR_{b}(\\phi_{P}) = \\left(\\rho\\, u_{n}\\, A_{b} + \\frac{h\\,\\Gamma\\,A_{b}}{\\Gamma + h\\,d_{Pb}}\\right)\\phi_{P} - \\frac{h\\,\\Gamma\\,A_{b}}{\\Gamma + h\\,d_{Pb}}\\phi_{\\infty}\n$$\n提出公因式 $A_{b}$ 得到最终的闭合形式表达式：\n$$\nR_{b}(\\phi_{P}) = A_{b}\\left[ \\left(\\rho\\,u_{n} + \\frac{h\\,\\Gamma}{\\Gamma + h\\,d_{Pb}}\\right)\\phi_{P} - \\left(\\frac{h\\,\\Gamma}{\\Gamma + h\\,d_{Pb}}\\right)\\phi_{\\infty} \\right]\n$$", "answer": "$$\n\\boxed{A_{b}\\left[ \\left(\\rho\\,u_{n} + \\frac{h\\,\\Gamma}{\\Gamma + h\\,d_{Pb}}\\right)\\phi_{P} - \\frac{h\\,\\Gamma\\,\\phi_{\\infty}}{\\Gamma + h\\,d_{Pb}} \\right]}\n$$", "id": "3291615"}, {"introduction": "在实际的CFD应用中，为了贴合复杂几何形状，计算网格往往是非正交的，这会降低扩散通量中梯度计算的准确性。这项高级练习介绍了一种应对此问题的标准技术：使用非正交修正。通过在一个倾斜的四边形单元上计算扩散残差 [@problem_id:3291658]，你将深入了解在工程分析中遇到的复杂网格上，如何确保有限体积法的鲁棒性和准确性。", "problem": "在计算流体动力学的二维有限体积法设置中，考虑一个倾斜的四边形控制体，其顶点按逆时针顺序列于 $(0,0)$、$(2,0)$、$(3,1)$ 和 $(0,1)$。令控制体中心 $\\boldsymbol{x}_{P}$ 为多边形的质心。令每个面的中心 $\\boldsymbol{x}_{f}$ 为其两端点的中点。将每个面上的外向面面积矢量 $\\boldsymbol{S}_{f}$ 定义为一个矢量，其长度等于面长，垂直于该面，并指向控制体外部。具体来说，对于从 $(x_{i},y_{i})$ 到 $(x_{i+1},y_{i+1})$ 的一条有向边，取边矢量 $\\boldsymbol{t}_{i}=(x_{i+1}-x_{i},\\,y_{i+1}-y_{i})$ 并设置 $\\boldsymbol{S}_{f}=(y_{i+1}-y_{i},\\, -(x_{i+1}-x_{i}))$。对于每个面，通过将主中心点 $\\boldsymbol{x}_{P}$ 关于面中心点 $\\boldsymbol{x}_{f}$ 作镜像来定义面另一侧的相邻单元中心 $\\boldsymbol{x}_{N} = 2\\,\\boldsymbol{x}_{f} - \\boldsymbol{x}_{P}$，并定义 $\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P}$ 和 $\\boldsymbol{e}_{d} = \\boldsymbol{d}/|\\boldsymbol{d}|$。\n\n假设扩散系数为常数 $\\Gamma = 1$（无量纲），标量场为 $\\phi(x,y) = x^{2} + y^{2}$（无量纲）。使用带有面法向梯度正交修正项的有限体积法 (FVM)，将控制体中的扩散残差近似为所有面上扩散通量贡献的总和\n$$\nR_{\\mathrm{disc}} \\approx \\sum_{f} \\Gamma \\left[ \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right) \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|} \\;+\\; \\left(\\boldsymbol{S}_{f} - \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right)\\boldsymbol{e}_{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right],\n$$\n其中 $\\phi_{P}=\\phi(\\boldsymbol{x}_{P})$，$\\phi_{N}=\\phi(\\boldsymbol{x}_{N})$，并且 $\\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}}$ 是在 $\\boldsymbol{x}_{P}$ 和 $\\boldsymbol{x}_{N}$ 处计算的精确单元中心梯度的算术平均值。作为对比，在控制体上积分的精确扩散散度为\n$$\nR_{\\mathrm{exact}} \\;=\\; \\int_{V} \\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) \\, \\mathrm{d}V.\n$$\n\n将所有量视为无量纲。计算 $R_{\\mathrm{disc}}$ 的数值。您的最终答案必须是一个实数。不需要四舍五入。", "solution": "该问题要求计算给定四边形控制体和标量场下的离散化扩散残差 $R_{\\mathrm{disc}}$。该残差的计算公式为控制体所有面上的求和：\n$$\nR_{\\mathrm{disc}} = \\sum_{f} \\Gamma \\left[ \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right) \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|} \\;+\\; \\left(\\boldsymbol{S}_{f} - \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right)\\boldsymbol{e}_{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right]\n$$\n鉴于 $\\boldsymbol{e}_d = \\boldsymbol{d}/|\\boldsymbol{d}|$，该表达式可以重写以避免显式计算单位矢量及其相关的平方根，从而简化算术运算：\n$$\nR_{\\mathrm{disc}} = \\sum_{f} \\Gamma \\left[ \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|^2} (\\boldsymbol{S}_{f} \\cdot \\boldsymbol{d}) \\;+\\; \\left(\\boldsymbol{S}_{f} - \\frac{\\boldsymbol{S}_{f} \\cdot \\boldsymbol{d}}{|\\boldsymbol{d}|^2}\\boldsymbol{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right]\n$$\n给定常数扩散系数 $\\Gamma = 1$。标量场为 $\\phi(x,y) = x^2 + y^2$，其梯度为 $\\nabla\\phi(x,y) = (2x, 2y)$。\n\n首先，我们确定控制体中心 $\\boldsymbol{x}_P$，即顶点为 $V_1(0,0)$、$V_2(2,0)$、$V_3(3,1)$ 和 $V_4(0,1)$ 的四边形的质心。我们可以通过将四边形分解为两个三角形 $T_1 = (V_1, V_2, V_3)$ 和 $T_2 = (V_1, V_3, V_4)$，找出它们各自的质心和面积，然后计算加权平均值来求得质心。\n\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形的面积为 $A = \\frac{1}{2}|x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|$。其质心为 $C = \\frac{1}{3}((x_1,y_1)+(x_2,y_2)+(x_3,y_3))$。\n\n对于三角形 $T_1((0,0), (2,0), (3,1))$：\n面积 $A_1 = \\frac{1}{2}|0(0-1) + 2(1-0) + 3(0-0)| = 1$。\n质心 $C_1 = \\frac{1}{3}((0,0)+(2,0)+(3,1)) = (\\frac{5}{3}, \\frac{1}{3})$。\n\n对于三角形 $T_2((0,0), (3,1), (0,1))$：\n面积 $A_2 = \\frac{1}{2}|0(1-1) + 3(1-0) + 0(0-1)| = \\frac{3}{2}$。\n质心 $C_2 = \\frac{1}{3}((0,0)+(3,1)+(0,1)) = (1, \\frac{2}{3})$。\n\n总面积为 $A = A_1+A_2 = 1+\\frac{3}{2} = \\frac{5}{2}$。控制体中心为：\n$\\boldsymbol{x}_P = \\frac{A_1 C_1 + A_2 C_2}{A} = \\frac{1(\\frac{5}{3}, \\frac{1}{3}) + \\frac{3}{2}(1, \\frac{2}{3})}{\\frac{5}{2}} = \\frac{(\\frac{5}{3}+\\frac{3}{2}, \\frac{1}{3}+1)}{\\frac{5}{2}} = \\frac{(\\frac{19}{6}, \\frac{4}{3})}{\\frac{5}{2}} = (\\frac{19}{15}, \\frac{8}{15})$。\n\n接下来，我们在 $\\boldsymbol{x}_P$ 处计算 $\\phi$ 和 $\\nabla\\phi$ 的值：\n$\\phi_P = \\phi(\\boldsymbol{x}_P) = (\\frac{19}{15})^2 + (\\frac{8}{15})^2 = \\frac{361+64}{225} = \\frac{425}{225} = \\frac{17}{9}$。\n$\\nabla\\phi(\\boldsymbol{x}_P) = (2 \\cdot \\frac{19}{15}, 2 \\cdot \\frac{8}{15}) = (\\frac{38}{15}, \\frac{16}{15})$。\n\n现在，我们计算四个面上各自的贡献。\n\n面 1：从 $V_1(0,0)$ 到 $V_2(2,0)$。\n$\\boldsymbol{x}_{f1} = \\frac{1}{2}((0,0)+(2,0)) = (1,0)$。\n$\\boldsymbol{S}_{f1} = (0-0, -(2-0)) = (0, -2)$。\n$\\boldsymbol{x}_{N1} = 2\\boldsymbol{x}_{f1} - \\boldsymbol{x}_P = 2(1,0) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{11}{15}, -\\frac{8}{15})$。\n$\\phi_{N1} = (\\frac{11}{15})^2 + (-\\frac{8}{15})^2 = \\frac{121+64}{225} = \\frac{185}{225} = \\frac{37}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N1}) = (2 \\cdot \\frac{11}{15}, 2 \\cdot (-\\frac{8}{15})) = (\\frac{22}{15}, -\\frac{16}{15})$。\n$\\boldsymbol{d}_1 = \\boldsymbol{x}_{N1} - \\boldsymbol{x}_P = (\\frac{11}{15}-\\frac{19}{15}, -\\frac{8}{15}-\\frac{8}{15}) = (-\\frac{8}{15}, -\\frac{16}{15})$。\n$|\\boldsymbol{d}_1|^2 = (-\\frac{8}{15})^2 + (-\\frac{16}{15})^2 = \\frac{64+256}{225} = \\frac{320}{225} = \\frac{64}{45}$。\n$\\phi_{N1}-\\phi_P = \\frac{37}{45} - \\frac{17}{9} = \\frac{37-85}{45} = -\\frac{48}{45} = -\\frac{16}{15}$。\n$\\boldsymbol{S}_{f1} \\cdot \\boldsymbol{d}_1 = (0,-2)\\cdot(-\\frac{8}{15}, -\\frac{16}{15}) = \\frac{32}{15}$。\n正交项：$\\frac{\\phi_{N1}-\\phi_P}{|\\boldsymbol{d}_1|^2}(\\boldsymbol{S}_{f1} \\cdot \\boldsymbol{d}_1) = \\frac{-16/15}{64/45}(\\frac{32}{15}) = -\\frac{16}{15}\\frac{45}{64}\\frac{32}{15} = -\\frac{1 \\cdot 3 \\cdot 32}{1 \\cdot 4 \\cdot 15} = - \\frac{8}{5}$。\n$(\\nabla \\phi)_{f1}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{22}{15},-\\frac{16}{15})) = \\frac{1}{2}(\\frac{60}{15}, 0) = (2,0)$。\n非正交矢量投影：$\\frac{\\boldsymbol{S}_{f1}\\cdot\\boldsymbol{d}_1}{|\\boldsymbol{d}_1|^2}\\boldsymbol{d}_1 = \\frac{32/15}{64/45}(-\\frac{8}{15}, -\\frac{16}{15}) = \\frac{3}{2}(-\\frac{8}{15}, -\\frac{16}{15}) = (-\\frac{4}{5}, -\\frac{8}{5})$。\n非正交矢量：$\\boldsymbol{S}_f - (\\dots) = (0,-2) - (-\\frac{4}{5}, -\\frac{8}{5}) = (\\frac{4}{5}, -\\frac{2}{5})$。\n非正交项：$(\\frac{4}{5}, -\\frac{2}{5}) \\cdot (2,0) = \\frac{8}{5}$。\n面 1 的通量贡献：$-\\frac{8}{5} + \\frac{8}{5} = 0$。\n\n面 2：从 $V_2(2,0)$ 到 $V_3(3,1)$。\n$\\boldsymbol{x}_{f2} = \\frac{1}{2}((2,0)+(3,1)) = (\\frac{5}{2},\\frac{1}{2})$。\n$\\boldsymbol{S}_{f2} = (1-0, -(3-2)) = (1, -1)$。\n$\\boldsymbol{x}_{N2} = 2(\\frac{5}{2},\\frac{1}{2}) - (\\frac{19}{15},\\frac{8}{15}) = (5,1) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{56}{15}, \\frac{7}{15})$。\n$\\phi_{N2} = (\\frac{56}{15})^2+(\\frac{7}{15})^2 = \\frac{3136+49}{225} = \\frac{3185}{225} = \\frac{637}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N2}) = (\\frac{112}{15}, \\frac{14}{15})$。\n$\\boldsymbol{d}_2 = (\\frac{56-19}{15}, \\frac{7-8}{15}) = (\\frac{37}{15}, -\\frac{1}{15})$。\n$|\\boldsymbol{d}_2|^2 = (\\frac{37}{15})^2+(-\\frac{1}{15})^2 = \\frac{1369+1}{225} = \\frac{1370}{225} = \\frac{274}{45}$。\n$\\phi_{N2}-\\phi_P = \\frac{637}{45} - \\frac{17}{9} = \\frac{637-85}{45} = \\frac{552}{45} = \\frac{184}{15}$。\n$\\boldsymbol{S}_{f2} \\cdot \\boldsymbol{d}_2 = (1,-1)\\cdot(\\frac{37}{15}, -\\frac{1}{15}) = \\frac{38}{15}$。\n正交项：$\\frac{184/15}{274/45}(\\frac{38}{15}) = \\frac{184 \\cdot 3 \\cdot 38}{274 \\cdot 15} = \\frac{3496}{685}$。\n$(\\nabla \\phi)_{f2}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{112}{15},\\frac{14}{15})) = \\frac{1}{2}(\\frac{150}{15}, \\frac{30}{15}) = (5,1)$。\n非正交矢量投影：$\\frac{38/15}{274/45}(\\frac{37}{15}, -\\frac{1}{15}) = \\frac{57}{137}(\\frac{37}{15}, -\\frac{1}{15}) = (\\frac{703}{685}, -\\frac{19}{685})$。\n非正交矢量：$(1,-1) - (\\frac{703}{685}, -\\frac{19}{685}) = (-\\frac{18}{685}, -\\frac{666}{685})$。\n非正交项：$(-\\frac{18}{685}, -\\frac{666}{685}) \\cdot (5,1) = \\frac{-90-666}{685} = -\\frac{756}{685}$。\n面 2 的通量贡献：$\\frac{3496}{685} - \\frac{756}{685} = \\frac{2740}{685} = 4$。\n\n面 3：从 $V_3(3,1)$ 到 $V_4(0,1)$。\n$\\boldsymbol{x}_{f3} = \\frac{1}{2}((3,1)+(0,1)) = (\\frac{3}{2},1)$。\n$\\boldsymbol{S}_{f3} = (1-1, -(0-3)) = (0, 3)$。\n$\\boldsymbol{x}_{N3} = 2(\\frac{3}{2},1) - (\\frac{19}{15},\\frac{8}{15}) = (3,2) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{26}{15}, \\frac{22}{15})$。\n$\\phi_{N3} = (\\frac{26}{15})^2+(\\frac{22}{15})^2 = \\frac{676+484}{225} = \\frac{1160}{225} = \\frac{232}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N3}) = (\\frac{52}{15}, \\frac{44}{15})$。\n$\\boldsymbol{d}_3 = (\\frac{26-19}{15}, \\frac{22-8}{15}) = (\\frac{7}{15}, \\frac{14}{15})$。\n$|\\boldsymbol{d}_3|^2 = (\\frac{7}{15})^2+(\\frac{14}{15})^2 = \\frac{49+196}{225} = \\frac{245}{225} = \\frac{49}{45}$。\n$\\phi_{N3}-\\phi_P = \\frac{232}{45} - \\frac{17}{9} = \\frac{232-85}{45} = \\frac{147}{45} = \\frac{49}{15}$。\n$\\boldsymbol{S}_{f3} \\cdot \\boldsymbol{d}_3 = (0,3)\\cdot(\\frac{7}{15}, \\frac{14}{15}) = \\frac{42}{15} = \\frac{14}{5}$。\n正交项：$\\frac{49/15}{49/45}(\\frac{14}{5}) = 3 \\cdot \\frac{14}{5} = \\frac{42}{5}$。\n$(\\nabla \\phi)_{f3}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{52}{15},\\frac{44}{15})) = \\frac{1}{2}(\\frac{90}{15}, \\frac{60}{15}) = (3,2)$。\n非正交矢量投影：$\\frac{14/5}{49/45}(\\frac{7}{15}, \\frac{14}{15}) = \\frac{18}{7}(\\frac{7}{15}, \\frac{14}{15}) = (\\frac{6}{5}, \\frac{12}{5})$。\n非正交矢量：$(0,3) - (\\frac{6}{5}, \\frac{12}{5}) = (-\\frac{6}{5}, \\frac{3}{5})$。\n非正交项：$(-\\frac{6}{5}, \\frac{3}{5}) \\cdot (3,2) = \\frac{-18+6}{5} = -\\frac{12}{5}$。\n面 3 的通量贡献：$\\frac{42}{5} - \\frac{12}{5} = \\frac{30}{5} = 6$。\n\n面 4：从 $V_4(0,1)$ 到 $V_1(0,0)$。\n$\\boldsymbol{x}_{f4} = \\frac{1}{2}((0,1)+(0,0)) = (0, \\frac{1}{2})$。\n$\\boldsymbol{S}_{f4} = (0-1, -(0-0)) = (-1, 0)$。\n$\\boldsymbol{x}_{N4} = 2(0,\\frac{1}{2}) - (\\frac{19}{15},\\frac{8}{15}) = (0,1) - (\\frac{19}{15},\\frac{8}{15}) = (-\\frac{19}{15}, \\frac{7}{15})$。\n$\\phi_{N4} = (-\\frac{19}{15})^2+(\\frac{7}{15})^2 = \\frac{361+49}{225} = \\frac{410}{225} = \\frac{82}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N4}) = (-\\frac{38}{15}, \\frac{14}{15})$。\n$\\boldsymbol{d}_4 = (\\boldsymbol{x}_{N4} - \\boldsymbol{x}_{P}) = (-\\frac{19}{15}-\\frac{19}{15}, \\frac{7}{15}-\\frac{8}{15}) = (-\\frac{38}{15}, -\\frac{1}{15})$。\n$|\\boldsymbol{d}_4|^2 = (-\\frac{38}{15})^2+(-\\frac{1}{15})^2 = \\frac{1444+1}{225} = \\frac{1445}{225} = \\frac{289}{45}$。\n$\\phi_{N4}-\\phi_P = \\frac{82}{45} - \\frac{17}{9} = \\frac{82-85}{45} = -\\frac{3}{45} = -\\frac{1}{15}$。\n$\\boldsymbol{S}_{f4} \\cdot \\boldsymbol{d}_4 = (-1,0)\\cdot(-\\frac{38}{15}, -\\frac{1}{15}) = \\frac{38}{15}$。\n正交项：$\\frac{-1/15}{289/45}(\\frac{38}{15}) = -\\frac{3}{289}(\\frac{38}{15}) = -\\frac{38}{1445}$。\n$(\\nabla \\phi)_{f4}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(-\\frac{38}{15},\\frac{14}{15})) = \\frac{1}{2}(0, \\frac{30}{15}) = (0,1)$。\n非正交矢量投影：$\\frac{38/15}{289/45}(-\\frac{38}{15}, -\\frac{1}{15}) = \\frac{114}{289}(-\\frac{38}{15}, -\\frac{1}{15}) = (-\\frac{1444}{1445}, -\\frac{38}{1445})$。\n非正交矢量：$(-1,0) - (-\\frac{1444}{1445}, -\\frac{38}{1445}) = (-\\frac{1}{1445}, \\frac{38}{1445})$。\n非正交项：$(-\\frac{1}{1445}, \\frac{38}{1445}) \\cdot (0,1) = \\frac{38}{1445}$。\n面 4 的通量贡献：$-\\frac{38}{1445} + \\frac{38}{1445} = 0$。\n\n最后，我们将四个面的贡献相加：\n$R_{\\mathrm{disc}} = 0 + 4 + 6 + 0 = 10$。\n\n精确积分为 $R_{\\mathrm{exact}} = \\int_V \\nabla \\cdot (\\Gamma \\nabla \\phi) \\,dV$。对于 $\\Gamma=1$ 和 $\\phi=x^2+y^2$，我们有 $\\nabla\\phi=(2x,2y)$ 和 $\\nabla\\cdot\\nabla\\phi=4$。因此，$R_{\\mathrm{exact}} = \\int_V 4 \\,dV = 4 \\times \\text{Area}(V) = 4 \\times \\frac{5}{2} = 10$。所选的数值格式对于此二次场是精确的，这验证了结果。", "answer": "$$\\boxed{10}$$", "id": "3291658"}]}