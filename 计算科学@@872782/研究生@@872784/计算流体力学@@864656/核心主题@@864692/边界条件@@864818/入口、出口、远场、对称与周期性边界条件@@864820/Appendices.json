{"hands_on_practices": [{"introduction": "在雷诺平均纳维-斯托克斯（RANS）模拟中，仅在入口处指定平均流场是不够的，还必须为湍流模型变量提供初始值。本练习演示了如何将物理上直观的湍流特征，如湍流强度 $I$ 和积分长度尺度 $L$，转换为特定湍流模型（此处为 $k$–$\\omega$ 模型）所需的量，即湍动能 $k$ 和比耗散率 $\\omega$ [@problem_id:3335042]。掌握这种转换是建立真实且稳定的CFD模拟的基本技能，可以确保湍流场从入口开始便能进行符合物理规律的演化。", "problem": "考虑一个统计定常、不可压缩、高雷诺数的流动，该流动使用由两方程湍流模型——湍动能-比耗散率模型（$k$–$\\omega$）——封闭的雷诺平均Navier-Stokes (RANS) 方程进行模拟。在入口处，平均流向速度是均匀的，大小为 $U_{\\infty}$，湍流强度为 $I$（定义为速度脉动的均方根与平均速率之比），积分长度尺度为 $L$（假设代表湍流生成尺度，并与入口处的湍流长度尺度相当）。假设入口湍流近似为各向同性。\n\n从基本定义和广为接受的关系出发，推导入口处的湍动能 $k$ 和比耗散率 $\\omega$ 的值。使用 $k=\\tfrac{3}{2}(I U_{\\infty})^{2}$，并得到一个以 $k$、$L$ 和一个与湍动能-耗散率模型（$k$–$\\varepsilon$）中的涡粘性封闭相关的模型常数 $C_{\\mu}$ 表示的 $\\omega$ 的表达式。您可以使用经过充分检验的平衡关系来连接 $k$–$\\varepsilon$ 和 $k$–$\\omega$ 封闭。讨论您指定的入口湍流与平均流边界条件的一致性，并阐述所选择的入口 $k$ 和 $\\omega$ 如何与其他边界类型（如出口、远场、对称和周期性边界）相关联，以维持RANS问题的物理和数学兼容性。\n\n请将入口比耗散率 $\\omega_{\\text{in}}$ 的最终表达式报告为一个仅包含 $I$、$U_{\\infty}$、$L$ 和 $C_{\\mu}$ 的单一闭合形式解析表达式。不要代入数值。无需四舍五入。最终表达式中不要包含单位；但是，请将 $\\omega_{\\text{in}}$ 在物理上解释为具有反比于时间的量纲。", "solution": "用户希望我解决以下问题：\n考虑一个统计定常、不可压缩、高雷诺数的流动，该流动使用由两方程湍流模型——湍动能-比耗散率模型（$k$–$\\omega$）——封闭的雷诺平均Navier-Stokes (RANS) 方程进行模拟。在入口处，平均流向速度是均匀的，大小为 $U_{\\infty}$，湍流强度为 $I$（定义为速度脉动的均方根与平均速率之比），积分长度尺度为 $L$（假设代表湍流生成尺度，并与入口处的湍流长度尺度相当）。假设入口湍流近似为各向同性。\n\n从基本定义和广为接受的关系出发，推导入口处的湍动能 $k$ 和比耗散率 $\\omega$ 的值。使用 $k=\\tfrac{3}{2}(I U_{\\infty})^{2}$，并得到一个以 $k$、$L$ 和一个与湍动能-耗散率模型（$k$–$\\varepsilon$）中的涡粘性封闭相关的模型常数 $C_{\\mu}$ 表示的 $\\omega$ 的表达式。您可以使用经过充分检验的平衡关系来连接 $k$–$\\varepsilon$ 和 $k$–$\\omega$ 封闭。讨论您指定的入口湍流与平均流边界条件的一致性，并阐述所选择的入口 $k$ 和 $\\omega$ 如何与其他边界类型（如出口、远场、对称和周期性边界）相关联，以维持RANS问题的物理和数学兼容性。\n\n请将入口比耗散率 $\\omega_{\\text{in}}$ 的最终表达式报告为一个仅包含 $I$、$U_{\\infty}$、$L$ 和 $C_{\\mu}$ 的单一闭合形式解析表达式。不要代入数值。无需四舍五入。最终表达式中不要包含单位；但是，请将 $\\omega_{\\text{in}}$ 在物理上解释为具有反比于时间的量纲。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 流动类型：统计定常、不可压缩、高雷诺数。\n- 控制方程：雷诺平均Navier-Stokes (RANS) 方程。\n- 湍流模型：湍动能-比耗散率模型 ($k$–$\\omega$)。\n- 入口平均流向速度：均匀，大小为 $U_{\\infty}$。\n- 入口湍流强度：$I$。\n- 入口积分长度尺度：$L$。\n- 入口湍流假设：近似各向同性。\n- 入口湍动能：$k = \\frac{3}{2}(I U_{\\infty})^{2}$。\n- 任务：推导入口比耗散率 $\\omega_{\\text{in}}$。\n- 推导约束：$\\omega$ 的表达式必须用 $k$、$L$ 和 $k$–$\\varepsilon$ 模型中的模型常数 $C_{\\mu}$ 表示。\n- 方法提示：使用经过充分检验的平衡关系来连接 $k$–$\\varepsilon$ 和 $k$–$\\omega$ 封闭。\n- 讨论主题：推导出的入口条件与平均流边界条件的一致性，以及与其他边界条件（出口、远场、对称、周期性）的关系。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题牢固地建立在计算流体动力学 (CFD) 和湍流模拟的原理之上。RANS方程、$k$–$\\omega$ 和 $k$–$\\varepsilon$ 模型，以及湍流强度、长度尺度和湍动能等概念都是该领域的标准和基础内容。\n- **适定性**：该问题是适定的。它要求从一组给定的参数（$I$, $U_{\\infty}$, $L$, $C_{\\mu}$）出发，利用已建立的理论关系推导出某个特定的量（$\\omega_{\\text{in}}$）。一个唯一的解析解是可以实现的。\n- **客观性**：该问题使用流体力学和CFD中精确、客观和标准的术语进行陈述。没有主观或含糊的陈述。\n- **一致性和完整性**：所提供的信息是自洽且充分的。给出的 $k$ 的关系与各向同性湍流的湍流强度定义一致。使用平衡关系和 $k$–$\\varepsilon$ 模型中的常数 $C_{\\mu}$ 的指令为推导提供了清晰的路径。\n- **有效性检查**：该问题不违反任何无效性标准。它在科学上是合理的、适定的、客观的、完整的，并且与CFD边界条件的指定主题相关。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解答。\n\n### 解题推导\n\n目标是确定在使用 $k$–$\\omega$ 湍流模型进行RANS模拟时，比耗散率 $\\omega_{\\text{in}}$ 的入口边界条件。推导将基于所提供的入口参数和湍流模拟理论中的标准关系。\n\n首先，我们建立 $k$–$\\omega$ 模型和 $k$–$\\varepsilon$ 模型之间的联系。两者都是引入涡（或湍流）粘度 $\\nu_t$ 来封闭RANS方程的两方程模型。Boussinesq假设通过这个涡粘度将雷诺应力与平均应变率关联起来。\n\n在标准 $k$–$\\omega$ 模型中，涡粘度定义为：\n$$ \\nu_t = \\frac{k}{\\omega} $$\n在标准 $k$–$\\varepsilon$ 模型中，涡粘度定义为：\n$$ \\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon} $$\n其中 $k$ 是湍动能，$\\omega$ 是比耗散率，$\\varepsilon$ 是湍流耗散率，$C_{\\mu}$ 是一个经验模型常数（通常 $C_{\\mu} \\approx 0.09$）。\n\n通过将这两个针对同一物理量 $\\nu_t$ 的表达式相等，我们建立了 $\\omega$ 和 $\\varepsilon$ 之间的一个“封闭层面上的”关系：\n$$ \\frac{k}{\\omega} = C_{\\mu} \\frac{k^2}{\\varepsilon} $$\n假设 $k \\ne 0$，我们可以重新整理这个表达式来解出 $\\varepsilon$（用 $\\omega$ 表示）或者反之：\n$$ \\varepsilon = C_{\\mu} k \\omega $$\n这个方程提供了两个模型变量之间的基本桥梁。\n\n接下来，我们必须将这些湍流量与给定的积分长度尺度 $L$ 联系起来。对于高雷诺数湍流，特别是那些接近平衡状态（即湍流生成率约等于耗散率）的流动，含能涡的特征长度尺度 $L_t$ 可以与 $k$ 和 $\\varepsilon$ 相关联。这种关系源于量纲分析：$\\varepsilon$ 的量纲为 $[(长度)^2(时间)^{-3}]$，$k$ 的量纲为 $[(长度)^2(时间)^{-2}]$。唯一能产生 $\\varepsilon$ 量纲的 $k$ 和长度尺度 $L_t$ 的组合是 $\\frac{k^{3/2}}{L_t}$。\n\n一个被广泛使用的关系式，它是 $k$–$\\varepsilon$ 模型公式的基石，并与简单剪切流中的观测结果一致，通过模型常数 $C_{\\mu}$ 将长度尺度 $L$、湍动能 $k$ 和耗散率 $\\varepsilon$ 联系起来：\n$$ \\varepsilon = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L} $$\n在这里，我们将问题给定的积分长度尺度 $L$ 等同于特征湍流长度尺度。对于指定代表已发展湍流的入口条件，这是一个常见且合理的假设。\n\n现在我们有了两个关于 $\\varepsilon$ 的不同表达式。通过让它们相等，我们可以解出 $\\omega$：\n$$ C_{\\mu} k \\omega = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L} $$\n解出 $\\omega$ 得：\n$$ \\omega = \\frac{C_{\\mu}^{3/4}}{C_{\\mu}} \\frac{k^{3/2}}{k L} = C_{\\mu}^{3/4 - 1} \\frac{k^{1/2}}{L} = C_{\\mu}^{-1/4} \\frac{k^{1/2}}{L} $$\n这个表达式按要求提供了用 $k$、$L$ 和常数 $C_{\\mu}$ 表示的比耗散率 $\\omega$。\n\n最后一步是将给定的入口湍动能 $k_{\\text{in}}$ 的表达式代入我们推导出的 $\\omega$ 的公式中。问题陈述：\n$$ k_{\\text{in}} = \\frac{3}{2}(I U_{\\infty})^{2} $$\n将此代入 $\\omega$ 的方程中：\n$$ \\omega_{\\text{in}} = C_{\\mu}^{-1/4} \\frac{\\left( \\frac{3}{2}(I U_{\\infty})^{2} \\right)^{1/2}}{L} $$\n简化表达式得：\n$$ \\omega_{\\text{in}} = C_{\\mu}^{-1/4} \\frac{\\sqrt{\\frac{3}{2}} |I U_{\\infty}|}{L} $$\n由于湍流强度 $I$ 和平均速率 $U_{\\infty}$ 是非负物理量，绝对值是多余的。\n$$ \\omega_{\\text{in}} = \\sqrt{\\frac{3}{2}} C_{\\mu}^{-1/4} \\frac{I U_{\\infty}}{L} $$\n这是入口比耗散率的最终解析表达式。\n\n### 关于边界条件的讨论\n\n**与平均流边界条件的一致性：**\n入口指定了均匀的平均速度剖面 $U_{\\infty}$，这是一种“柱塞流”条件。推导出的湍流量 $k_{\\text{in}}$ 和 $\\omega_{\\text{in}}$ 在整个入口上也是均匀的。这种均匀性是自洽的；对于一个平衡的入口条件，指定一个空间变化的湍流场而平均流是均匀的，这在物理上是不协调的。推导出的 $k_{\\textin}$ 和 $\\omega_{\\text{in}}$ 的值代表了近平衡各向同性湍流的状态，这是一个物理上合理且稳定的状态来初始化流场，可以防止湍流在入口下游立即发生不符合物理规律的快速衰减或增长。\n\n**与其他边界条件类型的关系：**\n- **出口：** 出口边界旨在让流动以最小的上游影响离开计算域。一个常见的处理方法是为所有输运变量（包括 $k$ 和 $\\omega$）应用零梯度（Neumann）条件，即 $\\frac{\\partial \\phi}{\\partial n} = 0$。这假设流动在出口处是“充分发展”的。此处推导的入口指定与零梯度出口是兼容的，前提是计算域足够长，允许流动从其入口状态演化为充分发展的状态。\n- **远场：** 对于外部空气动力学模拟，远场边界条件指定了自由流状态。施加的条件与此处推导的入口条件在形式上是相同的：一个均匀的速度 $U_{\\infty}$，以及由自由流湍流强度 $I_{\\infty}$ 和特征长度尺度 $L_{\\infty}$ 计算出的湍流特性（$k_{\\infty}$, $\\omega_{\\infty}$）。因此，推导出的公式直接适用于远场边界。\n- **对称：** 对称平面强制边界上无通量条件（$\\vec{v} \\cdot \\vec{n} = 0$）以及所有标量场的法向梯度为零（$\\frac{\\partial k}{\\partial n} = 0$，$\\frac{\\partial \\omega}{\\partial n} = 0$）。这是对流场结构的局部约束。它在数学上独立于入口条件设定的全局湍流水平，并且与之兼容。\n- **周期性：** 周期性边界强制一个边界上的流动状态与别处相应边界上的状态相同。这用于具有空间周期性的几何体，如叶栅或充分发展的管道流。在这种情况下，没有传统意义上的“入口”；流动以其离开时的属性重新进入域。因此，指定入口 $k$ 和 $\\omega$ 的概念与在主流动方向上使用周期性边界是相互排斥的。因此，推导的入口条件适用于非周期性问题。\n\n总而言之，为 $k$ 和 $\\omega$ 推导的入口指定是初始化RANS模拟的一种标准的、有物理依据的方法。它确保了与CFD中使用的其他常见边界条件类型的数学和物理兼容性，从而构成了一个适定的问题设置。", "answer": "$$ \\boxed{\\sqrt{\\frac{3}{2}} C_{\\mu}^{-\\frac{1}{4}} \\frac{I U_{\\infty}}{L}} $$", "id": "3335042"}, {"introduction": "压力出口边界是一种常见的设定，但当流动在出口处重新进入计算域（即回流）时，问题就变得极具挑战性，因为这可能引发数值不稳定性。本练习将指导您从第一性原理出发，设计一个复杂的混合边界条件，该条件能在出流的零梯度条件和入流的指定狄利克雷（Dirichlet）条件之间平滑过渡 [@problem_id:3334975]。该设计基于能量稳定性分析和局部的对流-扩散平衡，实现这样的边界条件可以显著增强CFD求解器的鲁棒性，使其能够可靠地处理出口附近存在再循环区的复杂流动问题。", "problem": "您的任务是为雷诺平均纳维-斯托克斯 (RANS) 计算设计、论证和实现一个压力出口边界条件，在该条件下，湍流标量——湍动能 $k$ 及其耗散率 $\\varepsilon$——在出口处受到回流保护。该实现必须从第一性原理推导，为回流情况生成一个鲁棒的切换规则，并量化再附区附近的稳定性和偏差。最终输出必须是一个单行列表，聚合所有提供的测试用例的结果。\n\n从围绕出口边界的一个薄层内的通用湍流量 $\\phi \\in \\{k,\\varepsilon\\}$ 的标量输运方程开始，该边界的向外单位法向量为 $\\mathbf{n}$，法向速度分量为 $u_n = \\mathbf{u}\\cdot \\mathbf{n}$：\n$$\n\\frac{\\partial \\phi}{\\partial t} + u_n \\frac{\\partial \\phi}{\\partial n} \\;=\\; \\frac{\\partial}{\\partial n}\\left( D \\frac{\\partial \\phi}{\\partial n}\\right) + S_\\phi,\n$$\n其中 $D = \\nu_t + \\nu$ 是湍流粘度 $\\nu_t$ 和分子粘度 $\\nu$ 的和，$S_\\phi$ 表示在边界切换准则中未显式使用的源项。假设一个压力出口边界，对于纯流出 ($u_n > 0$)，通常应用零梯度条件 $\\partial \\phi/\\partial n = 0$；对于纯流入 ($u_n  0$)，则施加狄利克雷远场值，以防止内部湍流量的不符合物理的再循环。\n\n您的任务包括：\n\n1. 从第一性原理推导一个平滑的切换规则，该规则基于局部 $u_n$ 的符号和大小，以及局部的对流-扩散平衡，来决定在每个出口节点上为 $\\phi \\in \\{k,\\varepsilon\\}$ 选择狄利克雷行为还是零梯度行为。使用以下标量方程的基本能量估计：将输运方程乘以 $\\phi$ 并在邻近边界的薄层上进行分部积分，得到边界贡献项\n$$\nB_\\phi \\;=\\; \\frac{u_n \\,\\phi_b^2}{2} \\;-\\; D \\,\\phi_b \\left.\\frac{\\partial \\phi}{\\partial n}\\right|^-,\n$$\n其中 $\\phi_b$ 是施加的边界值，$\\left.\\frac{\\partial \\phi}{\\partial n}\\right|^-$ 是单侧内部法向导数。为保证流入 ($u_n  0$) 条件下的稳定性，边界贡献应为非正，即对于所有 $u_n0$ 的节点，$B_\\phi \\le 0$。\n\n2. 在此基础上，定义：\n   - 一个基于 $u_n$ 符号的回流指示器，\n     $$\n     I(u_n) \\;=\\; \\frac{1}{2}\\left(1 - \\tanh\\!\\left(\\frac{u_n}{\\delta_u}\\right)\\right),\n     $$\n     其中平滑参数 $\\delta_u  0$，单位为 m/s。\n   - 一个无量纲的对流-扩散比\n     $\n     \\Pi \\;=\\; \\dfrac{|u_n|\\,\\Delta}{D},\n     $\n     其中 $\\Delta$ 是局部网格间距，单位为 m，$D = \\nu_t + \\nu$ 的单位为 $m^2/s$。\n   - 一个关于 $\\Pi$ 的平滑激活函数，\n     $$\n     S(\\Pi) \\;=\\; \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{\\Pi - \\Pi_{\\min}}{\\Delta \\Pi}\\right)\\right),\n     $$\n     其中阈值 $\\Pi_{\\min}  0$ 和平滑宽度 $\\Delta \\Pi  0$。\n   - 一个狄利克雷权重\n     $\n     w_D \\;=\\; I(u_n)\\,S(\\Pi).\n     $\n\n3. 应用每个湍流标量 $\\phi \\in \\{k,\\varepsilon\\}$ 的混合边界值：\n   $$\n   \\phi_b \\;=\\; \\max\\!\\left(0,\\; w_D\\,\\phi_{\\mathrm{ref}} + (1 - w_D)\\,\\phi_{\\mathrm{int}}\\right),\n   $$\n   其中 $\\phi_{\\mathrm{ref}}$ 是远场参考值，$\\phi_{\\mathrm{int}}$ 是内部迹值。如果 $w_D \\ge 0.5$，则将边界条件分类为狄利克雷条件，否则为零梯度条件。正性约束反映了 $k$ 和 $\\varepsilon$ 的物理非负性。\n\n4. 量化再附区附近的偏差。定义一个再附窗口 $|u_n| \\le u_{\\mathrm{rea}}$，其中 $u_{\\mathrm{rea}}  0$，单位为 m/s。计算此窗口内每个 $\\phi$ 的最大相对偏差，\n   $$\n   \\mathrm{bias}_{\\max}(\\phi) \\;=\\; \\max_{|u_n|\\le u_{\\mathrm{rea}}} \\frac{|\\phi_b - \\phi_{\\mathrm{int}}|}{\\max(\\phi_{\\mathrm{int}}, \\phi_{\\mathrm{floor}})},\n   $$\n   其中 $\\phi_{\\mathrm{floor}}  0$ 是一个小的下限值，以防止除以零。\n\n5. 将上述逻辑实现为一个程序，对于每个测试用例，输出：\n   - 分类为 $k$ 的狄利克雷条件的节点比例，\n   - 分类为 $\\varepsilon$ 的狄利克雷条件的节点比例，\n   - $k$ 的最大再附窗口偏差，\n   - $\\varepsilon$ 的最大再附窗口偏差，\n   - 一个布尔标志，指示在所有 $u_n0$ 的节点上，流入稳定性准则 $B_k \\le 0$ 和 $B_\\varepsilon \\le 0$ 是否成立。\n\n物理单位必须严格按照下文规定使用。输出值为无量纲分数和布尔值；输出不需要单位。本问题不涉及角度。最终打印结果必须是包含所有测试用例结果的单行，该行是一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身也是一个相同格式的列表。\n\n对所有测试用例使用以下相同的常量：\n- $u_n$ 的平滑处理：$\\delta_u = 0.5$ (m/s)。\n- $\\Pi$ 的阈值和平滑处理：$\\Pi_{\\min} = 0.3$ 和 $\\Delta \\Pi = 0.1$ (无量纲)。\n- 再附窗口：$u_{\\mathrm{rea}} = 0.2$ (m/s)。\n- 下限值：$k_{\\mathrm{floor}} = 10^{-12}$ 和 $\\varepsilon_{\\mathrm{floor}} = 10^{-12}$。\n\n测试套件：\n\n- 用例 1 (以流出为主，带有一个小的回流区)：\n  - 法向速度 $u_n$ (m/s): $\\{15.0, 12.0, 8.0, 5.0, 2.0, -0.5, 1.0, 4.0, 7.0, 10.0\\}$。\n  - 湍流粘度 $\\nu_t$ ($m^2/s$): $\\{0.008, 0.009, 0.010, 0.010, 0.011, 0.012, 0.010, 0.009, 0.008, 0.009\\}$。\n  - 分子粘度 $\\nu$ ($m^2/s$): $\\{1.5\\times 10^{-5}\\}$ (均匀)。\n  - 网格间距 $\\Delta$ (m): $\\{0.05\\}$ (均匀)。\n  - 内部迹值 $k_{\\mathrm{int}}$ ($m^2/s^2$): $\\{1.8, 1.7, 1.6, 1.55, 1.5, 1.6, 1.7, 1.75, 1.8, 1.85\\}$。\n  - 内部迹值 $\\varepsilon_{\\mathrm{int}}$ ($m^2/s^3$): $\\{0.55, 0.53, 0.50, 0.48, 0.47, 0.49, 0.51, 0.52, 0.54, 0.56\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial k}{\\partial n}\\right|^-$ ($(m^2/s^2)/m$): $\\{-0.20, -0.15, -0.10, -0.08, -0.05, -0.02, -0.06, -0.09, -0.12, -0.18\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial \\varepsilon}{\\partial n}\\right|^-$ ($(m^2/s^3)/m$): $\\{-0.10, -0.09, -0.08, -0.07, -0.06, -0.05, -0.06, -0.07, -0.08, -0.09\\}$。\n  - 远场参考值: $k_{\\mathrm{ref}} = 1.5$ ($m^2/s^2$), $\\varepsilon_{\\mathrm{ref}} = 0.602$ ($m^2/s^3$)。\n\n- 用例 2 (再附区，具有小的 $|u_n|$ 和高的 $\\nu_t$):\n  - 法向速度 $u_n$ (m/s): $\\{-0.10, -0.05, 0.0, 0.05, 0.10, -0.02, 0.02, -0.08, 0.08, 0.0\\}$。\n  - 湍流粘度 $\\nu_t$ ($m^2/s$): $\\{0.05, 0.05, 0.05, 0.05, 0.05, 0.06, 0.06, 0.05, 0.05, 0.05\\}$。\n  - 分子粘度 $\\nu$ ($m^2/s$): $\\{1.5\\times 10^{-5}\\}$ (均匀)。\n  - 网格间距 $\\Delta$ (m): $\\{0.02\\}$ (均匀)。\n  - 内部迹值 $k_{\\mathrm{int}}$ ($m^2/s^2$): $\\{1.2, 1.19, 1.18, 1.17, 1.16, 1.15, 1.16, 1.17, 1.18, 1.19\\}$。\n  - 内部迹值 $\\varepsilon_{\\mathrm{int}}$ ($m^2/s^3$): $\\{0.50, 0.49, 0.48, 0.47, 0.46, 0.45, 0.46, 0.47, 0.48, 0.49\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial k}{\\partial n}\\right|^-$ ($(m^2/s^2)/m$): $\\{0.00, -0.01, -0.02, -0.01, 0.00, 0.01, -0.01, 0.00, -0.02, 0.01\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial \\varepsilon}{\\partial n}\\right|^-$ ($(m^2/s^3)/m$): $\\{0.00, -0.005, -0.008, -0.006, -0.004, -0.002, -0.005, -0.004, -0.007, -0.003\\}$。\n  - 远场参考值: $k_{\\mathrm{ref}} = 0.135$ ($m^2/s^2$), $\\varepsilon_{\\mathrm{ref}} = 0.027$ ($m^2/s^3$)。\n\n- 用例 3 (强回流事件):\n  - 法向速度 $u_n$ (m/s): $\\{-3.0, -5.0, -2.0, -1.0, -4.0, -6.0, -3.0, -0.8, -1.2, -2.5\\}$。\n  - 湍流粘度 $\\nu_t$ ($m^2/s$): $\\{0.005, 0.005, 0.006, 0.006, 0.005, 0.004, 0.005, 0.006, 0.006, 0.005\\}$。\n  - 分子粘度 $\\nu$ ($m^2/s$): $\\{1.5\\times 10^{-5}\\}$ (均匀)。\n  - 网格间距 $\\Delta$ (m): $\\{0.05\\}$ (均匀)。\n  - 内部迹值 $k_{\\mathrm{int}}$ ($m^2/s^2$): $\\{1.0, 0.95, 0.90, 0.85, 0.80, 0.78, 0.82, 0.88, 0.92, 0.96\\}$。\n  - 内部迹值 $\\varepsilon_{\\mathrm{int}}$ ($m^2/s^3$): $\\{0.30, 0.28, 0.26, 0.24, 0.22, 0.21, 0.23, 0.25, 0.27, 0.29\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial k}{\\partial n}\\right|^-$ ($(m^2/s^2)/m$): $\\{0.05, 0.04, 0.03, 0.02, 0.01, 0.01, 0.02, 0.03, 0.04, 0.05\\}$。\n  - 单侧内部法向导数 $\\left.\\frac{\\partial \\varepsilon}{\\partial n}\\right|^-$ ($(m^2/s^3)/m$): $\\{0.02, 0.018, 0.015, 0.012, 0.010, 0.009, 0.011, 0.013, 0.016, 0.019\\}$。\n  - 远场参考值: $k_{\\mathrm{ref}} = 0.96$ ($m^2/s^2$), $\\varepsilon_{\\mathrm{ref}} = 0.385$ ($m^2/s^3$)。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个列表，按顺序包含以下五个条目：分类为 $k$ 的狄利克雷条件的节点比例（浮点数），分类为 $\\varepsilon$ 的狄利克雷条件的节点比例（浮点数），$k$ 的最大再附窗口偏差（浮点数），$\\varepsilon$ 的最大再附窗口偏差（浮点数），以及流入稳定性标志（布尔值）。例如，输出应如下所示：\n$$\n\\texttt{[[f_{k,1},f_{\\varepsilon,1},b_{k,1},b_{\\varepsilon,1},\\mathrm{stable}_1],[f_{k,2},f_{\\varepsilon,2},b_{k,2},b_{\\varepsilon,2},\\mathrm{stable}_2],[f_{k,3},f_{\\varepsilon,3},b_{k,3},b_{\\varepsilon,3},\\mathrm{stable}_3]]}\n$$\n显示在单行上，无任何附加文本。", "solution": "用户要求在雷诺平均纳维-斯托克斯 (RANS) 模拟的背景下，为湍动能 $k$ 及其耗散率 $\\varepsilon$ 设计、论证和实现一个鲁棒的压力出口边界条件。核心任务是开发一个混合条件，该条件能在流出的零梯度条件和流入的狄利克雷条件之间平滑过渡，同时确保数值稳定并量化潜在的偏差。\n\n分析始于垂直于出口边界的一维标量输运方程，该方程适用于通用湍流量 $\\phi \\in \\{k, \\varepsilon\\}$：\n$$\n\\frac{\\partial \\phi}{\\partial t} + u_n \\frac{\\partial \\phi}{\\partial n} \\;=\\; \\frac{\\partial}{\\partial n}\\left( D \\frac{\\partial \\phi}{\\partial n}\\right) + S_\\phi\n$$\n这里，$u_n$ 是垂直于边界的速度，$n$ 是法向坐标，$D = \\nu_t + \\nu$ 是有效扩散率（湍流粘度与分子粘度之和），$S_\\phi$ 代表源项。\n\n**1. 混合边界条件的推导与论证**\n\n压力出口面临的根本挑战是处理流动反转或回流 ($u_n  0$)。对于纯流出 ($u_n > 0$)，通常假设法向梯度为零，即 $\\partial\\phi/\\partial n = 0$。这反映了充分发展流动的状态，其中对流占主导地位，物理量在流向方向上不再变化。然而，对于流入，施加零梯度条件会允许计算域内的湍流量被输运回域内，从而产生一个不符合物理的反馈回路，可能导致数值不稳定。标准的解决方法是指定狄利克雷条件，$\\phi_b = \\phi_{\\text{ref}}$，其中 $\\phi_b$ 是边界值，$\\phi_{\\text{ref}}$ 是一个物理上合适的远场或环境值。\n\n一个鲁棒的边界条件必须在这两种行为之间平滑切换。所提出的公式通过一种混合方法实现这一点：\n$$\n\\phi_b \\;=\\; w_D\\,\\phi_{\\mathrm{ref}} + (1 - w_D)\\,\\phi_{\\mathrm{int}}\n$$\n其中 $\\phi_{\\mathrm{int}}$ 是与边界相邻的内部单元中的 $\\phi$ 值，$w_D \\in [0, 1]$ 是一个混合因子或狄利克雷权重。$w_D = 0$ 时恢复为零梯度条件（因为边界值被设置为内部值，在有限体积法中近似于 $\\partial\\phi/\\partial n = 0$），而 $w_D=1$ 时则施加纯狄利克雷条件。通过取 $\\phi_b = \\max(0, \\text{混合值})$ 来强制保证 $k$ 和 $\\varepsilon$ 的非负性。\n\n权重 $w_D$ 被设计为两个平滑函数的乘积，$w_D = I(u_n)S(\\Pi)$，每个函数都针对一个特定的物理考虑。\n\n- **流入检测：** 回流指示器 $I(u_n)$ 用于隔离回流区域。\n  $$\n  I(u_n) \\;=\\; \\frac{1}{2}\\left(1 - \\tanh\\!\\left(\\frac{u_n}{\\delta_u}\\right)\\right)\n  $$\n  该函数从强流入 ($u_n \\ll -\\delta_u$) 时的 $I \\approx 1$ 平滑地变化到强流出 ($u_n \\gg \\delta_u$) 时的 $I \\approx 0$。参数 $\\delta_u$ 控制了 $u_n=0$ 附近过渡区域的宽度。\n\n- **对流-扩散平衡：** 激活函数 $S(\\Pi)$ 使得狄利克雷条件的应用取决于局部流态，该流态由网格佩克莱数表征：\n  $$\n  \\Pi \\;=\\; \\dfrac{|u_n|\\,\\Delta}{D}\n  $$\n  这个无量纲比值比较了在尺寸为 $\\Delta$ 的网格单元上对流 ($|u_n|$) 与扩散 ($D$) 的强度。激活函数定义为：\n  $$\n  S(\\Pi) \\;=\\; \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{\\Pi - \\Pi_{\\min}}{\\Delta \\Pi}\\right)\\right)\n  $$\n  仅当 $\\Pi$ 显著大于阈值 $\\Pi_{\\min}$，即对流占主导地位时，此函数才会激活 ($S \\to 1$)。当扩散占主导地位时 ($\\Pi \\ll \\Pi_{\\min}$)，$S \\to 0$，即使存在流入，边界条件也会回归到类似零梯度的形式。这可以防止在缓慢的、扩散主导的区域施加可能过于严苛的远场值，从而提高求解器的稳定性。\n\n综合来看，权重 $w_D$ 仅在同时存在显著流入且流动为对流主导时才接近于 1，从而提供了一个基于物理且数值上平滑的切换机制。\n\n**2. 稳定性和偏差的量化**\n\n- **稳定性：** 流入期间边界条件的稳定性使用提供的标量能量平衡的边界贡献项来评估：\n  $$\n  B_\\phi \\;=\\; \\frac{u_n \\,\\phi_b^2}{2} \\;-\\; D \\,\\phi_b \\left.\\frac{\\partial \\phi}{\\partial n}\\right|^-.\n  $$\n  为保证稳定性，我们要求对于所有经历流入的节点 ($u_n  0$)，$B_\\phi \\le 0$。第一项代表“能量”的对流通量，对于流入而言本质上是稳定的（负值）。第二项代表扩散通量，可以是正值或负值。如果稳定的对流通量足以克服任何不稳定的扩散通量，则满足该条件。我们将计算所有流入节点的 $B_k$ 和 $B_\\varepsilon$ 以验证此准则。\n\n- **偏差：** 在流动再附区，即 $u_n$ 很小的地方，边界条件可能通过强制 $\\phi_b$ 为一个不同于自然内部解 $\\phi_{\\text{int}}$ 的值而引入显著偏差。该偏差量化为：\n  $$\n  \\mathrm{bias}_{\\max}(\\phi) \\;=\\; \\max_{|u_n|\\le u_{\\mathrm{rea}}} \\frac{|\\phi_b - \\phi_{\\mathrm{int}}|}{\\max(\\phi_{\\mathrm{int}}, \\phi_{\\mathrm{floor}})}\n  $$\n  该度量计算在指定的速度窗口 $|u_n| \\le u_{\\mathrm{rea}}$（该窗口是再附点的特征）内，施加的边界值与内部值之间的最大相对偏差。一个小的下限值 $\\phi_{\\mathrm{floor}}$ 可以防止除以零。\n\n**3. 算法实现**\n\n通过处理每个测试用例的节点数据来实施该分析。对于出口边界上的 $N$ 个节点中的每一个：\n1.  计算总扩散率 $D_i = \\nu_{t,i} + \\nu$。\n2.  计算无量纲对流-扩散比 $\\Pi_i = |u_{n,i}|\\Delta / D_i$。\n3.  评估流入指示器 $I(u_{n,i})$ 和激活函数 $S(\\Pi_i)$。\n4.  确定狄利克雷权重 $w_{D,i} = I(u_{n,i})S(\\Pi_i)$。对于给定节点，该权重对 $k$ 和 $\\varepsilon$ 是相同的。\n5.  使用各自的参考值 ($\\phi_{\\mathrm{ref}}$) 和内部迹值 ($\\phi_{\\mathrm{int}}$) 计算混合边界值 $k_{b,i}$ 和 $\\varepsilon_{b,i}$。\n6.  如果 $w_{D,i} \\ge 0.5$，则将每个节点分类为“狄利克雷”条件，否则为“零梯度”条件。狄利克雷节点的比例即为此类节点的数量除以 $N$。\n7.  对于再附窗口内的节点 ($|u_{n,i}| \\le u_{\\mathrm{rea}}$)，计算相对偏差。记录这些节点中的最大偏差。如果没有节点落入此窗口，则偏差为 0。\n8.  对于有流入的节点 ($u_{n,i}  0$)，使用计算出的 $\\phi_{b,i}$ 和给定的内部导数 $\\left.\\frac{\\partial \\phi}{\\partial n}\\right|^-_i$ 计算 $B_{k,i}$ 和 $B_{\\varepsilon,i}$。仅当对于所有此类节点和两种标量，$B_\\phi \\le 0$ 时，稳定性标志才为 `True`。\n\n此过程将应用于所提供的三个测试用例中的每一个。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the boundary condition metrics across all test cases.\n    \"\"\"\n\n    # Define constants\n    constants = {\n        'delta_u': 0.5,      # m/s\n        'Pi_min': 0.3,       # dimensionless\n        'delta_Pi': 0.1,     # dimensionless\n        'u_rea': 0.2,        # m/s\n        'k_floor': 1e-12,    # m^2/s^2\n        'eps_floor': 1e-12,  # m^2/s^3\n        'nu': 1.5e-5,        # m^2/s\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Predominant outflow\n        {\n            'u_n': np.array([15.0, 12.0, 8.0, 5.0, 2.0, -0.5, 1.0, 4.0, 7.0, 10.0]),\n            'nu_t': np.array([0.008, 0.009, 0.010, 0.010, 0.011, 0.012, 0.010, 0.009, 0.008, 0.009]),\n            'delta': 0.05,\n            'k_int': np.array([1.8, 1.7, 1.6, 1.55, 1.5, 1.6, 1.7, 1.75, 1.8, 1.85]),\n            'eps_int': np.array([0.55, 0.53, 0.50, 0.48, 0.47, 0.49, 0.51, 0.52, 0.54, 0.56]),\n            'dk_dn': np.array([-0.20, -0.15, -0.10, -0.08, -0.05, -0.02, -0.06, -0.09, -0.12, -0.18]),\n            'deps_dn': np.array([-0.10, -0.09, -0.08, -0.07, -0.06, -0.05, -0.06, -0.07, -0.08, -0.09]),\n            'k_ref': 1.5,\n            'eps_ref': 0.602,\n        },\n        # Case 2: Reattachment region\n        {\n            'u_n': np.array([-0.10, -0.05, 0.0, 0.05, 0.10, -0.02, 0.02, -0.08, 0.08, 0.0]),\n            'nu_t': np.array([0.05, 0.05, 0.05, 0.05, 0.05, 0.06, 0.06, 0.05, 0.05, 0.05]),\n            'delta': 0.02,\n            'k_int': np.array([1.2, 1.19, 1.18, 1.17, 1.16, 1.15, 1.16, 1.17, 1.18, 1.19]),\n            'eps_int': np.array([0.50, 0.49, 0.48, 0.47, 0.46, 0.45, 0.46, 0.47, 0.48, 0.49]),\n            'dk_dn': np.array([0.00, -0.01, -0.02, -0.01, 0.00, 0.01, -0.01, 0.00, -0.02, 0.01]),\n            'deps_dn': np.array([0.00, -0.005, -0.008, -0.006, -0.004, -0.002, -0.005, -0.004, -0.007, -0.003]),\n            'k_ref': 0.135,\n            'eps_ref': 0.027,\n        },\n        # Case 3: Strong backflow\n        {\n            'u_n': np.array([-3.0, -5.0, -2.0, -1.0, -4.0, -6.0, -3.0, -0.8, -1.2, -2.5]),\n            'nu_t': np.array([0.005, 0.005, 0.006, 0.006, 0.005, 0.004, 0.005, 0.006, 0.006, 0.005]),\n            'delta': 0.05,\n            'k_int': np.array([1.0, 0.95, 0.90, 0.85, 0.80, 0.78, 0.82, 0.88, 0.92, 0.96]),\n            'eps_int': np.array([0.30, 0.28, 0.26, 0.24, 0.22, 0.21, 0.23, 0.25, 0.27, 0.29]),\n            'dk_dn': np.array([0.05, 0.04, 0.03, 0.02, 0.01, 0.01, 0.02, 0.03, 0.04, 0.05]),\n            'deps_dn': np.array([0.02, 0.018, 0.015, 0.012, 0.010, 0.009, 0.011, 0.013, 0.016, 0.019]),\n            'k_ref': 0.96,\n            'eps_ref': 0.385,\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Unpack data\n        u_n = case['u_n']\n        num_nodes = len(u_n)\n\n        # Step 1: Calculate intermediate quantities\n        D = case['nu_t'] + constants['nu']\n        Pi = np.abs(u_n) * case['delta'] / D\n        \n        # Step 2: Calculate weights\n        I_un = 0.5 * (1.0 - np.tanh(u_n / constants['delta_u']))\n        S_Pi = 0.5 * (1.0 + np.tanh((Pi - constants['Pi_min']) / constants['delta_Pi']))\n        w_D = I_un * S_Pi\n        \n        # Step 3: Calculate blended boundary values\n        k_b = np.maximum(0.0, w_D * case['k_ref'] + (1.0 - w_D) * case['k_int'])\n        eps_b = np.maximum(0.0, w_D * case['eps_ref'] + (1.0 - w_D) * case['eps_int'])\n\n        # Step 4: Calculate output metrics\n        \n        # Metric 1  2: Fraction of Dirichlet nodes\n        # The weight w_D is the same for k and eps, so fractions are identical.\n        dirichlet_k_frac = np.sum(w_D >= 0.5) / num_nodes\n        dirichlet_eps_frac = dirichlet_k_frac\n\n        # Metric 3  4: Maximum reattachment-window bias\n        reattachment_mask = np.abs(u_n) = constants['u_rea']\n        \n        max_bias_k = 0.0\n        max_bias_eps = 0.0\n\n        if np.any(reattachment_mask):\n            k_b_rea = k_b[reattachment_mask]\n            k_int_rea = case['k_int'][reattachment_mask]\n            bias_k_nodes = np.abs(k_b_rea - k_int_rea) / np.maximum(k_int_rea, constants['k_floor'])\n            max_bias_k = np.max(bias_k_nodes)\n\n            eps_b_rea = eps_b[reattachment_mask]\n            eps_int_rea = case['eps_int'][reattachment_mask]\n            bias_eps_nodes = np.abs(eps_b_rea - eps_int_rea) / np.maximum(eps_int_rea, constants['eps_floor'])\n            max_bias_eps = np.max(bias_eps_nodes)\n\n        # Metric 5: Inflow stability\n        inflow_mask = u_n  0\n        is_stable = True\n        if np.any(inflow_mask):\n            B_k = (u_n[inflow_mask] * k_b[inflow_mask]**2 / 2.0) - \\\n                  (D[inflow_mask] * k_b[inflow_mask] * case['dk_dn'][inflow_mask])\n            \n            B_eps = (u_n[inflow_mask] * eps_b[inflow_mask]**2 / 2.0) - \\\n                    (D[inflow_mask] * eps_b[inflow_mask] * case['deps_dn'][inflow_mask])\n            \n            if not (np.all(B_k = 0) and np.all(B_eps = 0)):\n                is_stable = False\n        \n        # Assemble results for this case\n        case_results = [\n            dirichlet_k_frac, \n            dirichlet_eps_frac, \n            max_bias_k, \n            max_bias_eps, \n            is_stable\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Convert each inner list to its string representation\n    results_str = [str(res) for res in all_results]\n    # Join them with commas and enclose in brackets\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "3334975"}]}