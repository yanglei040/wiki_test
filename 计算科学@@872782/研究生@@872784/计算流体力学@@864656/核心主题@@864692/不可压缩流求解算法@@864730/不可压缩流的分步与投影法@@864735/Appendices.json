{"hands_on_practices": [{"introduction": "掌握分数步法的核心在于理解投影步骤如何精确地实施无散场约束。本练习 [@problem_id:3321950] 旨在通过一个解析问题来巩固这一基本原理。你将从第一性原理出发，为一个给定的非螺线管速度场推导并求解压力泊松方程，从而亲手将一个速度场投影到无散空间上。", "problem": "考虑一个二维、常密度、不可压缩的流场，其位于一个周期性域中，并由不可压缩的纳维-斯托克斯方程（Navier–Stokes equations）控制。在无量纲变量下进行计算，因此密度为 $1$，时间步长为 $\\Delta t = 1$。计算域为 $\\Omega = [0,2\\pi]\\times[0,2\\pi]$，在两个方向上都具有周期性边界条件。在一个标准的分数步法中，首先在没有压力的情况下推进一个临时速度场 $\\,\\boldsymbol{u}^{\\ast}\\,$，然后通过压力更新对其进行修正，以强制满足不可压缩性。\n\n从不可压缩流的基本约束和投影步的定义出发：修正后的速度满足 $\\,\\nabla\\cdot \\boldsymbol{u}^{n+1} = 0\\,$，并且它是通过从临时速度中减去一个时间步长内的压力梯度得到的。使用这些基础，推导在修正后强制不可压缩性时，压力在周期性边界条件下必须满足的椭圆边界值问题，推导过程不应假设任何预先推导出的公式。\n\n设给定的临时速度为\n$$\n\\boldsymbol{u}^{\\ast}(x,y) = \\big(2\\sin(x)\\cos(y),\\; -\\cos(x)\\sin(y)\\big), \\quad (x,y)\\in\\Omega.\n$$\n在域 $\\Omega$ 上对压力施加标准的零均值条件，以确保其唯一性。\n\n使用以上信息，计算：\n- 在一步投影后强制不可压缩性的压力场 $\\,p(x,y)\\,$，以及\n- 散度的缩减因子 $\\,r\\,$，其定义为\n$$\nr \\equiv \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}},\n$$\n其中 $\\|f\\|_{L^{2}(\\Omega)} \\equiv \\left(\\int_{\\Omega} |f|^{2}\\, \\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}$。\n\n以数对形式报告你的最终答案，该数对由 $\\,p(x,y)\\,$ 的闭式表达式和标量 $\\,r\\,$ 组成。由于进行了无量纲化，因此不需要单位。答案必须是包含这两个条目的单行矩阵。不需要四舍五入。", "solution": "用户要求我解决一个计算流体动力学问题，该问题涉及用于不可压缩流的分数步法投影法。\n\n### 步骤 1：提取给定信息\n-   **控制方程**：不可压缩的纳维-斯托克斯方程（隐含）。\n-   **流动性质**：二维（$2$D），常密度（$\\rho=1$）。\n-   **时间步长**：$\\Delta t = 1$。\n-   **计算域**：$\\Omega = [0, 2\\pi] \\times [0, 2\\pi]$。\n-   **边界条件**：在 $x$ 和 $y$ 方向上均为周期性。\n-   **分数步法**：临时速度 $\\boldsymbol{u}^{\\ast}$ 被修正为 $\\boldsymbol{u}^{n+1}$。\n-   **修正步定义**：$\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\Delta t \\nabla p$。\n-   **不可压缩性约束**：$\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。\n-   **临时速度场**：$\\boldsymbol{u}^{\\ast}(x,y) = (2\\sin(x)\\cos(y), -\\cos(x)\\sin(y))$。\n-   **压力唯一性条件**：域上的零均值压力，$\\int_{\\Omega} p(x,y)\\, \\mathrm{d}A = 0$。\n-   **要求输出**：\n    1.  压力场 $p(x,y)$。\n    2.  散度缩减因子 $r \\equiv \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}}$，其中 $\\|f\\|_{L^{2}(\\Omega)} \\equiv \\left(\\int_{\\Omega} |f|^{2}\\, \\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}$。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，是不可压缩流投影法理论中的一个标准练习。它是一个适定问题；计算域、边界条件和压力的唯一性约束都已指定，这确保了待推导的椭圆问题存在唯一解。该问题是客观的，并使用了精确的数学语言。不存在矛盾、信息缺失或违反物理原理的情况。因此，该问题是有效的。\n\n### 步骤 3：推导与求解\n\n**第 1 部分：压力泊松方程的推导**\n\n投影法包括两个基本步骤。首先，计算一个中间速度场 $\\boldsymbol{u}^{\\ast}$。其次，将该场投影到无散度向量场的空间上，以获得下一时间步的速度 $\\boldsymbol{u}^{n+1}$。该投影是通过减去一个标量场的梯度来实现的，该标量场被识别为压力 $p$。\n\n修正后的速度 $\\boldsymbol{u}^{n+1}$ 与临时速度 $\\boldsymbol{u}^{\\ast}$ 之间的关系如下：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\Delta t \\nabla p\n$$\n鉴于时间步长为 $\\Delta t = 1$，上式简化为：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\nabla p\n$$\n修正后的速度场必须满足不可压缩性约束：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0\n$$\n为了找到控制压力 $p$ 的方程，我们对修正步方程取散度：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{\\ast} - \\nabla p)\n$$\n利用散度算子的线性性质，我们得到：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\nabla \\cdot (\\nabla p)\n$$\n代入不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ 并认识到 $\\nabla \\cdot (\\nabla p)$ 是拉普拉斯算子 $\\nabla^2 p$，我们得到：\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\nabla^2 p\n$$\n这就得到了压力的椭圆边界值问题，即所谓的压力泊松方程（PPE）：\n$$\n\\nabla^2 p = \\nabla \\cdot \\boldsymbol{u}^{\\ast}\n$$\n\n**第 2 部分：求解压力场 $p(x,y)$**\n\n首先，我们必须计算 PPE 的源项，即给定临时速度场 $\\boldsymbol{u}^{\\ast} = (u^{\\ast}, v^{\\ast})$ 的散度。\n临时速度的分量为 $u^{\\ast}(x,y) = 2\\sin(x)\\cos(y)$ 和 $v^{\\ast}(x,y) = -\\cos(x)\\sin(y)$。\n其散度为：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{\\ast} = \\frac{\\partial u^{\\ast}}{\\partial x} + \\frac{\\partial v^{\\ast}}{\\partial y} = \\frac{\\partial}{\\partial x}(2\\sin(x)\\cos(y)) + \\frac{\\partial}{\\partial y}(-\\cos(x)\\sin(y))\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u}^{\\ast} = 2\\cos(x)\\cos(y) - \\cos(x)\\cos(y) = \\cos(x)\\cos(y)\n$$\n因此，需要求解的 PPE 为：\n$$\n\\nabla^2 p(x,y) = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = \\cos(x)\\cos(y)\n$$\n该问题定义在周期性域上。由于源项是三角函数形式，我们可以寻找一个类似形式的解，$p(x,y) = A\\cos(x)\\cos(y)$，其中 $A$ 是一个待定常数。这种形式自动满足周期性边界条件。\n我们计算此试探解的偏导数：\n$$\n\\frac{\\partial^2 p}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2} (A\\cos(x)\\cos(y)) = -A\\cos(x)\\cos(y)\n$$\n$$\n\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2} (A\\cos(x)\\cos(y)) = -A\\cos(x)\\cos(y)\n$$\n将这些代入 PPE：\n$$\n\\nabla^2 p = -A\\cos(x)\\cos(y) - A\\cos(x)\\cos(y) = -2A\\cos(x)\\cos(y)\n$$\n我们将其等同于源项：\n$$\n-2A\\cos(x)\\cos(y) = \\cos(x)\\cos(y)\n$$\n这意味着 $-2A = 1$，所以 $A = -\\frac{1}{2}$。\n压力的一般解是这个特解与满足周期性边界条件的齐次方程 $\\nabla^2 p_h = 0$ 的任意解之和。唯一的此类解是常数。因此，一般解为：\n$$\np(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y) + C\n$$\n为了求出常数 $C$，我们应用零均值条件：\n$$\n\\int_{\\Omega} p(x,y) \\, \\mathrm{d}x\\,\\mathrm{d}y = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left(-\\frac{1}{2}\\cos(x)\\cos(y) + C\\right) \\, \\mathrm{d}x\\,\\mathrm{d}y = 0\n$$\n$$\n-\\frac{1}{2} \\left( \\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x \\right) \\left( \\int_{0}^{2\\pi} \\cos(y) \\, \\mathrm{d}y \\right) + C \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\, \\mathrm{d}x\\,\\mathrm{d}y = 0\n$$\n余弦函数在整个周期上的定积分为零：$\\int_{0}^{2\\pi} \\cos(t) \\, \\mathrm{d}t = [\\sin(t)]_{0}^{2\\pi} = 0$。\n方程简化为：\n$$\n-\\frac{1}{2}(0)(0) + C \\cdot (2\\pi)^2 = 0 \\implies C = 0\n$$\n因此，唯一的压力场是：\n$$\np(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y)\n$$\n\n**第 3 部分：计算散度缩减因子 $r$**\n\n缩减因子定义为 $r = \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}}$。\n\n分子涉及修正后速度场的散度 $\\nabla \\cdot \\boldsymbol{u}^{n+1}$。根据构造，投影步的设计目的就是将其强制为零。如第 1 部分所示，$\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\nabla^2 p$。由于我们求解了 $\\nabla^2 p = \\nabla \\cdot \\boldsymbol{u}^{\\ast}$，因此可以得出 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。\n零函数的 $L^2$-范数为零：\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)} = \\|0\\|_{L^{2}(\\Omega)} = 0\n$$\n\n分母需要临时速度散度的 $L^2$-范数，$\\nabla \\cdot \\boldsymbol{u}^{\\ast} = \\cos(x)\\cos(y)$。\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}^2 = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} |\\cos(x)\\cos(y)|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y\n$$\n$$\n= \\int_{0}^{2\\pi} \\cos^2(x) \\, \\mathrm{d}x \\int_{0}^{2\\pi} \\cos^2(y) \\, \\mathrm{d}y\n$$\n为了计算该积分，我们使用恒等式 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$：\n$$\n\\int_{0}^{2\\pi} \\cos^2(\\theta) \\, \\mathrm{d}\\theta = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2\\theta)) \\, \\mathrm{d}\\theta = \\frac{1}{2} \\left[ \\theta + \\frac{1}{2}\\sin(2\\theta) \\right]_{0}^{2\\pi} = \\frac{1}{2}(2\\pi - 0) = \\pi\n$$\n因此，范数的平方为：\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}^2 = (\\pi)(\\pi) = \\pi^2\n$$\n范数本身为 $\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)} = \\sqrt{\\pi^2} = \\pi$。\n该值非零，因此缩减因子 $r$ 是良定义的。\n代入分子和分母：\n$$\nr = \\frac{0}{\\pi} = 0\n$$\n缩减因子为 $0$，这表示当精确求解时，投影步完全消除了速度场的散度，这与理论要求一致。\n\n最终答案由数对 $(p(x,y), r)$ 组成。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2}\\cos(x)\\cos(y)  0 \\end{pmatrix}}\n$$", "id": "3321950"}, {"introduction": "从理论到可靠的数值实现，代码验证是不可或缺的一环。本练习 [@problem_id:3322036] 介绍了“人造解方法”（Method of Manufactured Solutions），这是一种强大而通用的代码验证技术。通过为一个已知的精确解反向推导所需的体力项和边界条件，你可以系统地测试和调试你的程序，特别是对于投影法中至关重要但又微妙的压力边界条件的处理。", "problem": "考虑无量纲形式的二维不可压缩纳维-斯托克斯方程，描述了在单位正方形区域 $\\Omega = [0,1] \\times [0,1]$ 上，时间 $t \\ge 0$ 的速度场 $\\mathbf{u}(x,y,t) = (u(x,y,t), v(x,y,t))$ 和压力 $p(x,y,t)$，\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t), \\qquad \\nabla\\cdot\\mathbf{u} = 0,\n$$\n其中 $\\nu > 0$ 是运动粘度，$\\mathbf{f}(x,y,t)$ 是体力。假设在 $\\partial\\Omega$ 的所有四条边上施加了连续边界条件。您希望通过“制造解方法”（Method of Manufactured Solutions）来测试分数步投影法（fractional-step projection method）的分裂误差。\n\n给定由流函数 $\\psi(x,y,t)$ 定义的制造解，\n$$\n\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t),\n$$\n其中 $A>0$ 和 $\\omega>0$ 是常数，速度场由此构造为\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t), \\qquad v(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t).\n$$\n压力场规定为\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t),\n$$\n其中 $B>0$ 是常数。在底部边界 $y=0$ 上的单位外法线向量为 $\\mathbf{n} = (0,-1)$。\n\n任务：\n- 从不可压缩纳维-斯托克斯方程作为基本定律出发，验证所制造的速度场是无散的（solenoidal）。\n- 推导体力 $\\mathbf{f}(x,y,t)$，使得给定的 $(\\mathbf{u},p)$ 在所有时间 $t\\ge 0$ 内于 $\\Omega$ 中精确满足动量方程。\n- 通过在边界上强制动量平衡的法向分量，推导经典投影步骤中所需的压力泊松方程的诺伊曼边界数据，即在 $y=0$ 上定义的函数 $g(x,t)$，使得在 $y=0$ 处有 $\\partial p/\\partial n = g(x,t)$。\n\n将最终的边界数据 $g(x,t)$ 表示为包含 $A$、$B$、$\\omega$、$\\nu$、$\\pi$、$x$ 和 $t$ 的单个闭式解析表达式。无需进行数值计算。所有量均为无量纲；表达式中不应包含单位。", "solution": "该问题要求分析给定的二维不可压缩纳维-斯托克斯方程的制造解。任务是验证速度场的无散条件，推导相应的体力项，并确定区域底部边界上压力的诺伊曼边界条件。\n\n控制方程是动量方程和不可压缩性约束：\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t)\n$$\n$$\n\\nabla\\cdot\\mathbf{u} = 0\n$$\n\n所提供的制造解由流函数 $\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$ 定义，速度场 $\\mathbf{u} = (u,v)$ 由此推导得出：\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t)\n$$\n$$\nv(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t)\n$$\n压力场给出如下：\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n\n首先，我们依次处理这三个任务。\n\n**任务1：验证无散条件**\n\n如果速度场 $\\mathbf{u}$ 的散度为零，即 $\\nabla\\cdot\\mathbf{u} = 0$，则该速度场是无散的。在二维情况下，即为 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$。我们计算速度分量的偏导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) \\right) = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) \\right) = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)\n$$\n散度是这两项的和：\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t) - A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t) = 0\n$$\n对于所有的 $(x,y,t)$，该速度场确实是无散的。这个结果是预料之中的，因为任何通过流函数 $\\psi$ 经由 $u = \\partial\\psi/\\partial y$ 和 $v = -\\partial\\psi/\\partial x$ 推导出的二维速度场，只要 $\\psi$ 是二次连续可微的，根据克莱罗定理（Clairaut's theorem）关于混合偏导数相等的性质，即 $\\frac{\\partial^2\\psi}{\\partial x \\partial y} = \\frac{\\partial^2\\psi}{\\partial y \\partial x}$，它就自动满足不可压缩条件。\n\n**任务2：推导体力**\n\n体力 $\\mathbf{f}(x,y,t)$ 通过重新整理动量方程来确定：\n$$\n\\mathbf{f} = \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p\n$$\n我们计算右侧的每一项。\n\n1.  **时间导数项, $\\frac{\\partial \\mathbf{u}}{\\partial t}$**：\n    $$\n    \\frac{\\partial u}{\\partial t} = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial v}{\\partial t} = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n\n2.  **对流项, $(\\mathbf{u}\\cdot\\nabla)\\mathbf{u}$**：\n    其分量为 $(u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y})$ 和 $(u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y})$。我们需要 $\\mathbf{u}$ 对空间坐标的偏导数：\n    $\\frac{\\partial u}{\\partial x} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial u}{\\partial y} = -A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial x} = A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial y} = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)$\n\n    x-分量：\n    $u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t)[\\cos^2(\\pi y) + \\sin^2(\\pi y)] = A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t)$\n\n    y-分量：\n    $u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t)[\\sin^2(\\pi x) + \\cos^2(\\pi x)] = A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t)$\n\n3.  **粘性项, $-\\nu \\nabla^{2}\\mathbf{u}$**：\n    $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) - A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) = -2 \\pi^2 u$\n    $\\nabla^2 v = \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} = A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) + A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) = -2 \\pi^2 v$\n    所以，$-\\nu \\nabla^2 \\mathbf{u} = 2\\nu\\pi^2\\mathbf{u}$。\n\n4.  **压力梯度项, $\\nabla p$**：\n    $$\n    \\frac{\\partial p}{\\partial x} = -B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial p}{\\partial y} = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n    $$\n\n将这些项组合起来，得到体力 $\\mathbf{f}=(f_x, f_y)$ 的分量：\n$$\nf_x = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t) + 2\\nu\\pi^2 u - B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n$$\nf_y = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t) + 2\\nu\\pi^2 v + B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\n\n**任务3：推导压力诺伊曼边界条件**\n\n最后一个任务是推导压力泊松方程的诺伊曼边界数据 $g(x,t)$，使得在底部边界 $y=0$ 上有 $\\frac{\\partial p}{\\partial n} = g(x,t)$。在该边界上的单位外法线向量为 $\\mathbf{n} = (0,-1)$。\n\n投影法中的压力诺伊曼条件是通过在边界上强制施加动量平衡的法向分量来推导的。根据动量方程，我们有：\n$$\n\\nabla p = \\mathbf{f} - \\frac{\\partial \\mathbf{u}}{\\partial t} - (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\nabla^{2}\\mathbf{u}\n$$\n与法向量 $\\mathbf{n}$ 做点积，得到压力的法向导数：\n$$\n\\frac{\\partial p}{\\partial n} = \\mathbf{n} \\cdot \\nabla p = \\mathbf{n} \\cdot \\left( \\mathbf{f} - \\frac{\\partial \\mathbf{u}}{\\partial t} - (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nu \\nabla^{2}\\mathbf{u} \\right)\n$$\n这个表达式提供了与动力学一致的诺伊曼边界条件。由于制造解 $(\\mathbf{u}, p)$ 是已知的，并且 $\\mathbf{f}$ 被定义为精确满足动量方程，因此该表达式必须与直接从给定压力场 $p(x,y,t)$ 计算出的 $\\mathbf{n} \\cdot \\nabla p$ 的值完全相同。这为求解提供了一条直接的路径。\n\n因此，边界数据 $g(x,t)$ 为：\n$$\ng(x,t) = \\frac{\\partial p}{\\partial n}\\bigg|_{y=0} = \\nabla p(x,0,t) \\cdot \\mathbf{n}\n$$\n当 $\\mathbf{n}=(0,-1)$ 时，我们有：\n$$\ng(x,t) = \\left( \\frac{\\partial p}{\\partial x}, \\frac{\\partial p}{\\partial y} \\right)\\bigg|_{y=0} \\cdot (0,-1) = - \\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\n$$\n现在我们计算 $p$ 对 $y$ 的偏导数，并在 $y=0$ 处求值。\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) \\right) = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\n在 $y=0$ 处对该表达式求值：\n$$\n\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = B \\pi \\cos(\\pi x)\\cos(0)\\sin(\\omega t) = B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\n最后，诺伊曼边界数据 $g(x,t)$ 是该结果的负值：\n$$\ng(x,t) = - B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\n在数值模拟中，为了匹配精确的制造解，必须将此函数指定为 $y=0$ 边界上压力的诺伊曼边界条件。该推导与在边界上强制动量平衡是一致的。", "answer": "$$\\boxed{-B \\pi \\cos(\\pi x)\\sin(\\omega t)}$$", "id": "3322036"}, {"introduction": "在实践中，数值格式的选择对求解的稳定性和准确性有深远影响。本练习 [@problem_id:3322014] 深入探讨了在并置网格（collocated grid）上一个经典的数值难题：压力-速度解耦。你将分析并推导 Rhie-Chow 插值格式中的关键参数，理解它是如何通过保证离散算子的一致性来抑制非物理的棋盘状压力震荡，这是开发稳健的有限体积或有限差分求解器的关键一步。", "problem": "考虑在长度为 $L$ 的周期性域上的一维不可压缩流动，流体密度 $\\rho$ 为常数。该区域由一个均匀的、并置的（collocated）网格离散化，该网格有 $N$ 个网格中心，其位置为 $x_i = i h$，其中 $i = 0, 1, \\dots, N-1$，$h = L/N$。不可压缩Navier–Stokes方程通过分数步（投影）法进行离散：首先通过推进不含压力梯度的动量方程获得一个中间速度 $u^{*}$，然后通过压力修正将速度投影到一个无散场上。速度修正假设与压力梯度呈线性关系，\n$$\nu^{n+1} = u^{*} - \\alpha \\nabla p,\n$$\n其中 $\\alpha = \\Delta t/\\rho$，$\\Delta t$ 为时间步长，$\\rho$ 为恒定密度。在并置网格上，离散连续性方程使用面法向通量，因此，进入网格中心离散散度的面速度是通过对网格中心量的插值来构造的。\n\n在均匀网格上定义以下离散算子：\n- 面心的离散压力梯度，\n$$\nG_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}.\n$$\n- 网格中心的离散压力梯度，\n$$\nG_{\\mathrm{cell}} p\\big|_{i} = \\frac{p_{i+1} - p_{i-1}}{2 h}.\n$$\n- 中间速度的线性面插值，\n$$\n\\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} = \\frac{u^{*}_i + u^{*}_{i+1}}{2}.\n$$\n- 面速度的网格中心离散散度，\n$$\nD u\\big|_{i} = \\frac{u\\big|_{i+\\frac{1}{2}} - u\\big|_{i-\\frac{1}{2}}}{h}.\n$$\n\n为避免并置网格上的压力-速度解耦，引入了一种Rhie–Chow型插值，该插值通过混合在面上计算的压力梯度和网格中心梯度的平均值来实现。具体来说，考虑单参数族\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta\\, G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta)\\, \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2},\n$$\n其中 $\\theta \\in \\mathbb{R}$，并定义用于连续性方程的面速度为\n$$\nu\\big|_{i+\\frac{1}{2}} = \\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} - \\alpha\\, g_{i+\\frac{1}{2}}^{(\\theta)}.\n$$\n\n从不可压缩性约束和投影法出发，分析上述Rhie–Chow型插值在抑制压力-速度解耦中的作用。推导在周期性边界条件（无边界）下的离散梯度-散度一致性条件，方法是要求由修正项 $-\\alpha\\, g_{i+\\frac{1}{2}}^{(\\theta)}$ 产生的、对离散散度 $D u$ 的压力贡献，对于任意离散压力场 $p$，都与通过组合 $D$ 和 $G_{\\mathrm{face}}$ 得到的标准离散拉普拉斯算子相一致：\n$$\nD\\Big(-\\alpha\\, G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha\\, g^{(\\theta)}\\Big).\n$$\n\n确定混合参数 $\\theta$ 的唯一标量值，该值使得在周期性网格上，对于所有网格能解析的傅里叶模态，此一致性条件都得以满足。在你的推导中，明确展示 $\\theta$ 的选择如何影响作用于 $p$ 的离散算子，并解释Rhie–Chow构造如何避免棋盘格压力-速度解耦。你的最终答案必须是单个实数 $\\theta$；不需要单位。", "solution": "本任务要求确定Rhie–Chow型插值格式中的一个特定参数 $\\theta$。$\\theta$ 的值必须确保，对于应用于一维不可压缩Navier–Stokes方程（在周期性并置网格上）的分数步法，一个离散一致性条件得以满足。\n\n首先，我们对问题陈述进行强制性验证。\n\n### 第一步：提取已知条件\n- **流动与流体**：一维不可压缩流，恒定密度 $\\rho$。\n- **区域与网格**：长度为 $L$ 的周期性域，由一个均匀的、并置的网格离散化，该网格有 $N$ 个网格中心，位置为 $x_i = i h$，其中 $i = 0, \\dots, N-1$，$h = L/N$。\n- **数值方法**：分数步投影法。\n- **速度修正**：$u^{n+1} = u^{*} - \\alpha \\nabla p$，其中 $\\alpha = \\Delta t/\\rho$。\n- **离散算子**：\n  - 面心梯度：$G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}$。\n  - 网格中心梯度：$G_{\\mathrm{cell}} p\\big|_{i} = \\frac{p_{i+1} - p_{i-1}}{2 h}$。\n  - 速度的面插值：$\\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} = \\frac{u^{*}_i + u^{*}_{i+1}}{2}$。\n  - 网格中心的散度：$D u\\big|_{i} = \\frac{u\\big|_{i+\\frac{1}{2}} - u\\big|_{i-\\frac{1}{2}}}{h}$。\n- **Rhie–Chow插值**：\n  - 混合压力梯度：$g_{i+\\frac{1}{2}}^{(\\theta)} = \\theta\\, G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta)\\, \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2}$。\n  - 用于连续性方程的面速度：$u\\big|_{i+\\frac{1}{2}} = \\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} - \\alpha\\, g_{i+\\frac{1}{2}}^{(\\theta)}$。\n- **一致性条件**：在周期性边界条件下，对于任意离散压力场 $p$，压力对离散散度的贡献必须满足 $D\\Big(-\\alpha\\, G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha\\, g^{(\\theta)}\\Big)$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题牢固地植根于计算流体动力学领域。分数步法、并置网格布置、压力-速度解耦和Rhie–Chow插值都是标准的、成熟的概念。\n- **适定性**：该问题是适定的。它为所有离散算子提供了清晰的定义，并给出了一个需要满足的精确数学条件。目标是基于此条件找到一个唯一参数。\n- **客观性**：该问题是使用精确的数学和技术语言客观陈述的。\n\n该问题没有表现出验证标准中列出的任何缺陷（例如，科学上不合理、不完整、模糊不清）。它是流体动力学数值分析领域一个标准的、非平凡的问题。\n\n### 第三步：结论与行动\n问题是有效的。我们开始求解。\n\n问题的核心是找到满足一致性条件的 $\\theta$ 值：\n$$\nD\\Big(-\\alpha\\, G_{\\mathrm{face}} p\\Big) = D\\Big(-\\alpha\\, g^{(\\theta)}\\Big)\n$$\n这个恒等式必须对任何离散压力场 $p$ 成立。两边的常数标量因子 $-\\alpha$ 可以消去，得到算子恒等式：\n$$\nD\\left(G_{\\mathrm{face}} p\\right) = D\\left(g^{(\\theta)}\\right)\n$$\n我们的策略是推导此方程两边算子的显式格式，然后确定使它们相等的 $\\theta$ 值。\n\n首先，我们展开左侧（LHS），它代表标准的离散拉普拉斯算子。\n$$\n\\text{LHS} = D\\left(G_{\\mathrm{face}} p\\right)\\Big|_i = \\frac{G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} - G_{\\mathrm{face}} p\\big|_{i-\\frac{1}{2}}}{h}\n$$\n使用 $G_{\\mathrm{face}}$ 的定义，我们有 $G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}$ 和 $G_{\\mathrm{face}} p\\big|_{i-\\frac{1}{2}} = \\frac{p_i - p_{i-1}}{h}$。将这些代入散度表达式中，得到：\n$$\n\\text{LHS} = \\frac{1}{h} \\left( \\frac{p_{i+1} - p_i}{h} - \\frac{p_i - p_{i-1}}{h} \\right) = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}\n$$\n这是二阶导数的紧凑三点格式。\n\n接下来，我们展开右侧（RHS），它涉及到混合梯度 $g^{(\\theta)}$。\n$$\n\\text{RHS} = D\\left(g^{(\\theta)}\\right)\\Big|_i = \\frac{g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)}}{h}\n$$\n我们必须首先用压力值 $p_j$ 写出 $g_{i+\\frac{1}{2}}^{(\\theta)}$ 的表达式。\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta\\, G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta)\\, \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2}\n$$\n代入梯度算子的定义：\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta \\left( \\frac{p_{i+1} - p_i}{h} \\right) + (1-\\theta) \\frac{1}{2} \\left( \\frac{p_{i+1} - p_{i-1}}{2h} + \\frac{p_{i+2} - p_i}{2h} \\right)\n$$\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\frac{\\theta}{h}(p_{i+1} - p_i) + \\frac{1-\\theta}{4h}(p_{i+2} + p_{i+1} - p_i - p_{i-1})\n$$\n为了计算散度，我们还需要 $g_{i-\\frac{1}{2}}^{(\\theta)}$，这可以通过将索引 $i$ 移至 $i-1$ 找到：\n$$\ng_{i-\\frac{1}{2}}^{(\\theta)} = \\frac{\\theta}{h}(p_{i} - p_{i-1}) + \\frac{1-\\theta}{4h}(p_{i+1} + p_{i} - p_{i-1} - p_{i-2})\n$$\n现在，我们计算差值并除以 $h$：\n$$\n\\text{RHS} = \\frac{1}{h} \\left( g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)} \\right)\n$$\n让我们分开与 $\\theta$ 和 $(1-\\theta)$ 成比例的项。\n与 $\\theta$ 相关的项：\n$$\n\\frac{1}{h} \\left[ \\frac{\\theta}{h}(p_{i+1} - p_i) - \\frac{\\theta}{h}(p_i - p_{i-1}) \\right] = \\frac{\\theta}{h^2} (p_{i+1} - 2p_i + p_{i-1})\n$$\n与 $(1-\\theta)$ 相关的项：\n$$\n\\frac{1}{h} \\left[ \\frac{1-\\theta}{4h}(p_{i+2} + p_{i+1} - p_i - p_{i-1}) - \\frac{1-\\theta}{4h}(p_{i+1} + p_i - p_{i-1} - p_{i-2}) \\right]\n$$\n$$\n= \\frac{1-\\theta}{4h^2} \\left[ (p_{i+2} + p_{i+1} - p_i - p_{i-1}) - (p_{i+1} + p_i - p_{i-1} - p_{i-2}) \\right]\n$$\n$$\n= \\frac{1-\\theta}{4h^2} (p_{i+2} - 2p_i + p_{i-2})\n$$\n合并两项，RHS的完整表达式为：\n$$\n\\text{RHS} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n现在我们强制执行一致性条件，LHS = RHS：\n$$\n\\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n重新整理各项，我们得到：\n$$\n(1-\\theta) \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n这个方程必须对任何离散压力场 $p$ 成立。两边的算子是拉普拉斯算子的不同离散近似。我们记 $L_{3pt} p_i = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}$ 和 $L_{5pt} p_i = \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}$。条件是 $(1-\\theta) L_{3pt} p = (1-\\theta) L_{5pt} p$。\n这可以重写为 $(1-\\theta)(L_{3pt} - L_{5pt})p = 0$。\n算子 $L_{3pt} - L_{5pt}$ 不是零算子。例如，将其应用于一个四次场 $p_i = (ih)^4$ 会得到一个非零结果。因为等式必须对任意场 $p$ 成立，唯一的可能性是标量系数为零：\n$$\n1-\\theta = 0\n$$\n因此，混合参数的唯一值是 $\\theta = 1$。\n\n最后，我们解释这个选择在抑制压力-速度解耦方面的作用。\n在并置网格上，压力-速度解耦表现为离散系统无法控制压力场中的高频、非物理振荡。一个“棋盘格”压力模态，其中 $p_i = C(-1)^i$（$C$为某个常数），是主要例子。一种朴素的离散化方法可能导致一个对此模态不敏感的离散压力泊松算子，这意味着棋盘格模态位于其零空间中。如果这样，棋盘格压力场可能出现并增长，而不受不可压缩性约束（$D u=0$）的惩罚，从而导致伪解。\n\n问题的根源在于用于构成压力泊松方程的算子 $\\mathcal{L}_p p = D(\\dots)$。在一种朴素的格式中，人们可能会将网格中心的压力梯度插值到面上，这对应于给定插值族中 $\\theta=0$ 的情况。这导致作用于压力的算子等效于 $D \\circ \\mathcal{I} \\circ G_{\\text{cell}}$。将此算子应用于棋盘格模态 $p_i = (-1)^i$，得到：\n1. $G_{\\mathrm{cell}} p\\big|_i = \\frac{p_{i+1} - p_{i-1}}{2h} = \\frac{(-1)^{i+1} - (-1)^{i-1}}{2h} = \\frac{-(-1)^i - (-(-1)^i)}{2h} = 0$。\n2. 由于梯度处处为零，它的插值和随后的散度也为零。\n因此，对于 $\\theta=0$，得到的压力泊松算子的零空间包含棋盘格模态，该格式是不稳定的。\n\n通过设置 $\\theta = 1$，一致性条件 $D(g^{(1)}) = D(G_{\\mathrm{face}} p)$ 得以满足。因此，由投影步产生的压力泊松方程为 $D(G_{\\mathrm{face}} p) = \\frac{1}{\\alpha} D(\\mathcal{I}u^*)$。作用于压力的离散拉普拉斯算子是 $\\mathcal{L}_p = D \\circ G_{\\mathrm{face}}$。\n我们来测试此算子在棋盘格模态 $p_i = (-1)^i$ 上的作用：\n$$\n\\mathcal{L}_p p_i = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = \\frac{(-1)^{i+1} - 2(-1)^i + (-1)^{i-1}}{h^2} = \\frac{-(-1)^i - 2(-1)^i - (-1)^i}{h^2} = -\\frac{4(-1)^i}{h^2}\n$$\n这个结果是非零的。紧凑拉普拉斯算子 $D \\circ G_{\\mathrm{face}}$ 正确地“看到”并惩罚了棋盘格模态。通过确保有效的压力算子是这个特定的、表现良好的离散拉普拉斯算子，$\\theta = 1$ 的Rhie–Chow插值将相邻网格的压力值耦合起来，并从零空间中消除了伪棋盘格模态，从而稳定了并置网格方法。", "answer": "$$\n\\boxed{1}\n$$", "id": "3322014"}]}