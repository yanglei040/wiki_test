{"hands_on_practices": [{"introduction": "在深入研究复杂的数值算法之前，我们必须首先确保我们的问题是适定的。对于不可压缩流，散度定理要求速度场在整个求解域边界 $\\partial\\Omega$ 上必须满足全局质量守恒，即 $\\oint_{\\partial\\Omega} \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0$。本练习将向您展示如何检验和修正边界条件以满足这一基本约束，从而确保模拟设置在物理上和数学上都是有效的。[@problem_id:3353815]", "problem": "考虑一个矩形域 $\\Omega = [0,L]\\times[0,H]$ 内的二维不可压缩流，其中 $L$ 和 $H$ 的单位为米。其运动学约束由连续性方程 $\\nabla\\cdot\\mathbf{u}=0$ 控制，其中 $\\mathbf{u}(x,y)=(u(x,y),v(x,y))$ 是速度场。边界 $\\partial\\Omega$ 包括位于 $x=0$ 的左侧入流边界、位于 $x=L$ 的右侧出流边界，以及位于 $y=0$ 和 $y=H$ 的不可渗透无滑移壁面。单位外法向量用 $\\mathbf{n}$ 表示。\n\n不可压缩流的基本守恒要求全局通量平衡 $\\int_{\\partial\\Omega}\\mathbf{u}\\cdot\\mathbf{n}\\,dS=0$。考虑以下给定的数据：\n- 域尺寸：$L=1.0$ 米 和 $H=0.4$ 米。\n- 左边界 ($x=0$) 入流条件：$u(0,y)=u_{\\text{in}}(y)$，$v(0,y)=0$，其中\n$$\nu_{\\text{in}}(y)=U_{0}\\left[1-\\left(2\\frac{y}{H}-1\\right)^{2}\\right],\\quad U_{0}=1.2\\ \\text{meters per second},\\quad 0\\le y\\le H.\n$$\n- 右边界 ($x=L$) 出流条件：$u(L,y)=u_{\\text{out}}(y)$，$v(L,y)=0$，其中\n$$\nu_{\\text{out}}(y)=U_{1},\\quad U_{1}=0.7\\ \\text{meters per second},\\quad 0\\le y\\le H.\n$$\n- 顶部和底部壁面 ($y=H$ 和 $y=0$)：不可渗透，因此 $\\mathbf{u}\\cdot\\mathbf{n}=0$。\n\n这些边界数据违反了全局不可压缩性通量平衡。仅以连续性方程和散度定理为基本依据，推导要添加到出流剖面上的唯一均匀修正量 $\\delta$，使得修正后的出流为 $u_{\\text{out}}^{\\text{corr}}(y) = u_{\\text{out}}(y) + \\delta$，从而确保 $\\int_{\\partial\\Omega}\\mathbf{u}\\cdot\\mathbf{n}\\,dS=0$ 并恢复压力-速度耦合的可解性。计算 $\\delta$ 并以米/秒为单位给出其值。将最终结果四舍五入到四位有效数字。", "solution": "该问题陈述被评估为具有科学依据、适定且客观。它提出了计算流体动力学中的一个标准场景，即不可压缩流模拟的边界条件必须进行调整以满足全局连续性约束。该问题是有效的，并且可以推导出解。\n\n不可压缩流的基本原理是连续性方程，该方程指出速度场 $\\mathbf{u}$ 的散度为零：\n$$\n\\nabla\\cdot\\mathbf{u} = 0\n$$\n将散度定理应用于域 $\\Omega$ 上的速度场 $\\mathbf{u}$，可得：\n$$\n\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}) \\,dV = \\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS\n$$\n其中 $\\partial\\Omega$ 是域 $\\Omega$ 的边界，$\\mathbf{n}$ 是指向外部的单位法向量。由于在 $\\Omega$ 内处处有 $\\nabla\\cdot\\mathbf{u}=0$，因此体积分为零。这对速度的边界值施加了一个全局守恒约束：\n$$\n\\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\n该方程表明，穿过域边界的净体积通量必须为零。为使问题可解，给定的边界条件必须满足此约束。\n\n矩形域 $\\Omega = [0,L]\\times[0,H]$ 的边界 $\\partial\\Omega$ 由四个部分组成：\n1.  左边界（入流）：$x=0$，对于 $0 \\le y \\le H$。\n2.  右边界（出流）：$x=L$，对于 $0 \\le y \\le H$。\n3.  底边界（壁面）：$y=0$，对于 $0 \\le x \\le L$。\n4.  顶边界（壁面）：$y=H$，对于 $0 \\le x \\le L$。\n\n总边界积分可以分为四个部分：\n$$\n\\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = \\int_{\\text{left}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{right}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{bottom}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{top}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\n我们计算每个积分：\n- 在顶部和底部壁面上，问题陈述它们是不可渗透的，所以 $\\mathbf{u}\\cdot\\mathbf{n}=0$。在底部壁面 ($y=0$) 上，外法向量是 $\\mathbf{n}=(0,-1)$，所以 $\\mathbf{u}\\cdot\\mathbf{n} = -v(x,0)$。在顶部壁面 ($y=H$) 上，外法向量是 $\\mathbf{n}=(0,1)$，所以 $\\mathbf{u}\\cdot\\mathbf{n} = v(x,H)$。不可渗透条件意味着 $v(x,0)=0$ 和 $v(x,H)=0$。因此，通过顶部和底部壁面的通量为零：\n$$\n\\int_{\\text{bottom}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0 \\quad \\text{and} \\quad \\int_{\\text{top}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\n- 在左边界 ($x=0$) 上，外法向量是 $\\mathbf{n}=(-1,0)$。速度矢量是 $\\mathbf{u}(0,y)=(u_{\\text{in}}(y), 0)$。点积是 $\\mathbf{u}\\cdot\\mathbf{n} = u_{\\text{in}}(y)(-1) + (0)(0) = -u_{\\text{in}}(y)$。表面积的微分元是 $dS=dy$。通过左边界的总通量是：\n$$\nQ_{\\text{in, raw}} = \\int_{0}^{H} -u_{\\text{in}}(y) \\,dy\n$$\n这代表离开域的通量。进入域的体积流量是 $Q_{\\text{in}} = -Q_{\\text{in, raw}} = \\int_{0}^{H} u_{\\text{in}}(y) \\,dy$。\n\n- 在右边界 ($x=L$) 上，外法向量是 $\\mathbf{n}=(1,0)$。修正后的速度矢量是 $\\mathbf{u}(L,y)=(u_{\\text{out}}^{\\text{corr}}(y), 0) = (U_1+\\delta, 0)$。点积是 $\\mathbf{u}\\cdot\\mathbf{n} = (U_1+\\delta)(1) + (0)(0) = U_1+\\delta$。通过右边界的通量是：\n$$\nQ_{\\text{out, corr}} = \\int_{0}^{H} (U_1+\\delta) \\,dy\n$$\n\n将这些代入全局平衡方程：\n$$\n\\int_{0}^{H} -u_{\\text{in}}(y) \\,dy + \\int_{0}^{H} (U_1+\\delta) \\,dy + 0 + 0 = 0\n$$\n这可以重排为熟悉的表述，即入流体积流量必须等于出流体积流量：\n$$\n\\int_{0}^{H} u_{\\text{in}}(y) \\,dy = \\int_{0}^{H} (U_1+\\delta) \\,dy\n$$\n我们现在计算每个积分。首先，入流速率 $Q_{\\text{in}}$：\n$$\nQ_{\\text{in}} = \\int_{0}^{H} U_{0}\\left[1-\\left(2\\frac{y}{H}-1\\right)^{2}\\right] \\,dy\n$$\n我们可以展开被积函数并逐项积分：\n$$\nu_{\\text{in}}(y) = U_{0}\\left[1-\\left(\\frac{4y^2}{H^2} - \\frac{4y}{H} + 1\\right)\\right] = U_{0}\\left(\\frac{4y}{H} - \\frac{4y^2}{H^2}\\right)\n$$\n$$\nQ_{\\text{in}} = \\int_{0}^{H} U_{0}\\left(\\frac{4y}{H} - \\frac{4y^2}{H^2}\\right) \\,dy = U_{0} \\left[ \\frac{4y^2}{2H} - \\frac{4y^3}{3H^2} \\right]_{0}^{H}\n$$\n$$\nQ_{\\text{in}} = U_{0} \\left( \\frac{2H^2}{H} - \\frac{4H^3}{3H^2} \\right) = U_{0} \\left( 2H - \\frac{4}{3}H \\right) = U_{0}H\\left(2 - \\frac{4}{3}\\right) = \\frac{2}{3}U_{0}H\n$$\n接下来，我们计算修正后的出流速率 $Q_{\\text{out}}^{\\text{corr}}$：\n$$\nQ_{\\text{out}}^{\\text{corr}} = \\int_{0}^{H} (U_1+\\delta) \\,dy = (U_1+\\delta)[y]_{0}^{H} = (U_1+\\delta)H\n$$\n令入流和出流速率相等：\n$$\n\\frac{2}{3}U_{0}H = (U_1+\\delta)H\n$$\n域高度 $H$ 是一个非零常数，可以从两边消去：\n$$\n\\frac{2}{3}U_{0} = U_1+\\delta\n$$\n解出修正项 $\\delta$：\n$$\n\\delta = \\frac{2}{3}U_{0} - U_1\n$$\n给定数值 $U_{0}=1.2$ 米/秒 和 $U_{1}=0.7$ 米/秒。代入这些值：\n$$\n\\delta = \\frac{2}{3}(1.2) - 0.7 = 2(0.4) - 0.7 = 0.8 - 0.7 = 0.1\n$$\n修正值为 $\\delta = 0.1$ 米/秒。问题要求答案四舍五入到四位有效数字。这得到 $0.1000$。这个正值表明原始出流速度太低，无法平衡入流，因此需要增加。\n经过修正后，平均入流速度为 $\\bar{u}_{\\text{in}} = \\frac{Q_{\\text{in}}}{H} = \\frac{2}{3}U_0 = \\frac{2}{3}(1.2) = 0.8$ 米/秒。修正后的出流速度为 $u_{\\text{out}}^{\\text{corr}} = U_1 + \\delta = 0.7 + 0.1 = 0.8$ 米/秒，该速度是均匀的。该修正确保了平均出流速度等于平均入流速度，从而满足全局质量守恒。", "answer": "$$\n\\boxed{0.1000}\n$$", "id": "3353815"}, {"introduction": "投影法通过首先预测一个不满足无散条件的中间速度场 $\\mathbf{u}^*$，然后通过求解压力泊松方程 $\\nabla^2 p = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^*$ 来获得压力场，并最终校正速度场以满足不可压缩性。本练习将引导您完成这一校正阶段的核心步骤：构建压力泊松方程的右端项，并执行一次迭代求解，这是确保流场无散的关键。[@problem_id:3353803]", "problem": "考虑在均匀笛卡尔网格上使用 Marker-and-Cell (MAC) 布局离散的不可压缩 Navier–Stokes 方程。设计算域被划分为一个 $3\\times 3$ 的控制体数组，其单元中心索引为 $(i,j)\\in\\{1,2,3\\}\\times\\{1,2,3\\}$，均匀间距为 $\\Delta x=\\Delta y = h$，流体密度为 $\\rho$。面心的中间速度（在平流-扩散之后，投影之前）在垂直面上表示为 $u^{*}_{i+1/2,j}$，在水平面上表示为 $v^{*}_{i,j+1/2}$。不可压缩约束通过求解从投影步中得到的压力泊松方程来强制执行。\n\n从不可压缩性的运动学约束 $\\nabla\\cdot \\boldsymbol{u}^{n+1}=0$ 和将 $\\boldsymbol{u}^{*}$ 标准投影到无散空间出发，推导压力场的泊松方程。然后，采用二阶有限体积/MAC离散算子：\n- 在单元 $(i,j)$ 处的离散散度计算如下\n$$\n(\\nabla\\cdot \\boldsymbol{u}^{*})_{i,j}\\;\\approx\\;\\frac{u^{*}_{i+1/2,j}-u^{*}_{i-1/2,j}}{\\Delta x}\\;+\\;\\frac{v^{*}_{i,j+1/2}-v^{*}_{i,j-1/2}}{\\Delta y},\n$$\n- 用于单元中心压力未知量的五点拉普拉斯算子，其中 Dirichlet 压力边界条件应用于 $3\\times 3$ 单元中心域的外边界：\n$$\n\\frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{h^{2}}+\\frac{p_{i,j+1}-2p_{i,j}+p_{i,j-1}}{h^{2}} \\;=\\; b_{i,j},\n$$\n其中 $b_{i,j}$ 是泊松方程的离散右端项。\n\n假设中心单元 $(i,j)=(2,2)$ 所需的唯一的面心中间速度如下所示（国际单位制），其中 $\\Delta x=\\Delta y=h$：\n- $u^{*}_{3/2,\\,2} \\;=\\; 0\\,\\mathrm{m/s}$，\n- $u^{*}_{5/2,\\,2} \\;=\\; 2\\,\\mathrm{m/s}$，\n- $v^{*}_{2,\\,3/2} \\;=\\; 1\\,\\mathrm{m/s}$，\n- $v^{*}_{2,\\,5/2} \\;=\\; 3\\,\\mathrm{m/s}$。\n\n设密度为 $\\rho=1\\,\\mathrm{kg/m^{3}}$，时间步长为 $\\Delta t = 0.5\\,\\mathrm{s}$，网格间距为 $h=1\\,\\mathrm{m}$。对所有内部单元，将压力迭代初始值设为 $p_{i,j}^{(0)}=0$，并在 $3\\times 3$ 域的外边界上施加齐次 Dirichlet 压力。\n\n任务：\n1. 仅使用上述数据，计算中心单元的离散散度 $(\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2}$，并为标准投影法中的压力泊松方程构建相应的右端项 $b_{2,2}$。\n2. 写出五点拉普拉斯算子的 Jacobi 迭代式，并使用指定的初始迭代值和边界条件，在中心单元执行一次 Jacobi 更新以获得 $p^{(1)}_{2,2}$。\n\n以帕斯卡（Pascals）为单位表示最终更新的中心单元压力 $p^{(1)}_{2,2}$。无需四舍五入；报告精确值。全程使用国际单位制（SI units）。", "solution": "本问题要求在计算流体动力学背景下，计算压力泊松方程的右端项，并对特定单元的压力执行一次 Jacobi 迭代。该问题是适定的，并包含了完成所要求任务的所有必要信息。\n\n首先，我们建立压力场 $p$、中间速度场 $\\boldsymbol{u}^*$ 和最终的无散速度场 $\\boldsymbol{u}^{n+1}$ 之间的关系。投影法使用压力梯度来校正中间速度。投影步的一个常见公式是：\n$$ \\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^*}{\\Delta t} = - \\frac{1}{\\rho} \\nabla p^{n+1} $$\n其中 $\\rho$ 是流体密度，$\\Delta t$ 是时间步长，而 $p^{n+1}$ 是新时间层上的压力。这可以重排以表示最终速度为：\n$$ \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho} \\nabla p^{n+1} $$\n流体流动的不可压缩约束要求最终速度场是无散的，即 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。对上述方程应用散度算子得到：\n$$ \\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^* - \\nabla \\cdot \\left(\\frac{\\Delta t}{\\rho} \\nabla p^{n+1}\\right) $$\n令 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ 并假设 $\\rho$ 和 $\\Delta t$ 在空间上是常数，我们得到压力泊松方程：\n$$ \\nabla^2 p^{n+1} = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^* $$\n其中 $\\nabla^2$ 是拉普拉斯算子。\n\n问题给出了此方程的离散形式，其中在 Marker-and-Cell (MAC) 网格上对拉普拉斯算子使用五点模板，对散度使用有限体积近似。在单元中心 $(i,j)$ 处的离散方程为：\n$$ \\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{\\Delta x^2} + \\frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{\\Delta y^2} = \\frac{\\rho}{\\Delta t} \\left( \\frac{u^{*}_{i+1/2,j}-u^{*}_{i-1/2,j}}{\\Delta x} + \\frac{v^{*}_{i,j+1/2}-v^{*}_{i,j-1/2}}{\\Delta y} \\right) $$\n考虑到网格间距是均匀的，$\\Delta x = \\Delta y = h$，这可以简化为问题中陈述的形式：\n$$ \\frac{1}{h^2}(p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4p_{i,j}) = b_{i,j} $$\n其中右端项 $b_{i,j}$ 定义为：\n$$ b_{i,j} = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\boldsymbol{u}^*)_{i,j} $$\n且 $(\\nabla \\cdot \\boldsymbol{u}^*)_{i,j}$ 是离散散度。\n\n**任务1：计算 $(\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2}$ 和 $b_{2,2}$**\n\n我们需要计算 $3 \\times 3$ 域的中心单元 $(i,j) = (2,2)$ 的这些量。所需数据如下：\n- $u^{*}_{3/2,\\,2} = 0\\,\\mathrm{m/s}$\n- $u^{*}_{5/2,\\,2} = 2\\,\\mathrm{m/s}$\n- $v^{*}_{2,\\,3/2} = 1\\,\\mathrm{m/s}$\n- $v^{*}_{2,\\,5/2} = 3\\,\\mathrm{m/s}$\n- $h = 1\\,\\mathrm{m}$\n- $\\rho = 1\\,\\mathrm{kg/m^{3}}$\n- $\\Delta t = 0.5\\,\\mathrm{s}$\n\n使用提供的在 $(i,j)=(2,2)$ 处的离散散度公式：\n$$ (\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2} = \\frac{u^{*}_{2+1/2,2}-u^{*}_{2-1/2,2}}{h} + \\frac{v^{*}_{2,2+1/2}-v^{*}_{2,2-1/2}}{h} = \\frac{u^{*}_{5/2,2}-u^{*}_{3/2,2}}{h} + \\frac{v^{*}_{2,5/2}-v^{*}_{2,3/2}}{h} $$\n代入给定的数值：\n$$ (\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2} = \\frac{2 - 0}{1} + \\frac{3 - 1}{1} = 2 + 2 = 4\\,\\mathrm{s}^{-1} $$\n现在，我们可以计算压力泊松方程的右端项 $b_{2,2}$：\n$$ b_{2,2} = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\boldsymbol{u}^*)_{2,2} = \\frac{1\\,\\mathrm{kg/m^{3}}}{0.5\\,\\mathrm{s}} \\times (4\\,\\mathrm{s}^{-1}) = 2\\,\\mathrm{s}^{-1} \\times 4\\,\\mathrm{s}^{-1} \\times 1\\,\\mathrm{kg/m^{3}} = 8\\,\\mathrm{kg/(m^3 \\cdot s^2)} $$\n单位是一致的，因为 $1\\,\\mathrm{Pa/m^2} = 1\\,\\mathrm{kg/(m^3 \\cdot s^2)}$。\n\n**任务2：为 $p^{(1)}_{2,2}$ 执行一次 Jacobi 更新**\n\nJacobi 迭代法用于求解泊松方程离散化产生的线性方程组。在迭代步 $k+1$ 时，压力 $p_{i,j}$ 的更新规则是通过从离散方程中分离出 $p_{i,j}$ 推导得出的：\n$$ p_{i,j}^{(k+1)} = \\frac{1}{4} \\left( p_{i+1,j}^{(k)} + p_{i-1,j}^{(k)} + p_{i,j+1}^{(k)} + p_{i,j-1}^{(k)} - h^2 b_{i,j} \\right) $$\n我们需要计算中心单元 $(i,j)=(2,2)$ 的第一次迭代值 $p^{(1)}_{2,2}$。公式变为：\n$$ p_{2,2}^{(1)} = \\frac{1}{4} \\left( p_{3,2}^{(0)} + p_{1,2}^{(0)} + p_{2,3}^{(0)} + p_{2,1}^{(0)} - h^2 b_{2,2} \\right) $$\n问题指定了所有内部单元的初始猜测值为 $p_{i,j}^{(0)} = 0$。该域由索引为 $(i,j) \\in \\{1,2,3\\} \\times \\{1,2,3\\}$ 的单元组成。单元 $(2,2)$ 的邻居是 $(3,2)$、$(1,2)$、$(2,3)$ 和 $(2,1)$，它们都是内部单元。因此，它们的初始压力值为零：\n- $p_{3,2}^{(0)} = 0$\n- $p_{1,2}^{(0)} = 0$\n- $p_{2,3}^{(0)} = 0$\n- $p_{2,1}^{(0)} = 0$\n\n我们还有 $h=1\\,\\mathrm{m}$ 和 $b_{2,2} = 8\\,\\mathrm{kg/(m^3 \\cdot s^2)}$。将所有值代入 Jacobi 更新方程：\n$$ p_{2,2}^{(1)} = \\frac{1}{4} \\left( 0 + 0 + 0 + 0 - (1\\,\\mathrm{m})^2 \\times (8\\,\\mathrm{kg/(m^3 \\cdot s^2)}) \\right) $$\n$$ p_{2,2}^{(1)} = \\frac{1}{4} ( -8\\,\\mathrm{kg/(m \\cdot s^2)} ) $$\n单位 $\\mathrm{kg/(m \\cdot s^2)}$ 在量纲上等同于帕斯卡（Pascal，Pa），这是国际单位制（SI）中的压力单位。\n$$ p_{2,2}^{(1)} = -2\\,\\mathrm{Pa} $$\n最终更新的中心单元压力 $p^{(1)}_{2,2}$ 是 $-2\\,\\mathrm{Pa}$。\n为外边界指定的齐次 Dirichlet 边界条件并未在此特定计算中明确使用，因为 $p_{2,2}$ 的模板仅涉及其他内部单元，而这些单元的初始猜测值已被指定为 $p^{(0)}_{i,j}=0$。", "answer": "$$\n\\boxed{-2}\n$$", "id": "3353803"}, {"introduction": "离散化格式的选择可能会引入非物理的人为现象。在同位网格（collocated grid）布置中，一个臭名昭著的问题是无法被标准中心差分梯度算子“看见”的“压力棋盘格”模式，例如 $p_{i,j} = P_0 (-1)^{i+j}$。本练习提供了一个动手分析的机会，旨在揭示这种压力-速度解耦现象，并展示 Rhie–Chow 插值格式如何通过巧妙地重构面心速度来恢复耦合，从而抑制伪振荡。[@problem_id:3353857]", "problem": "考虑一个在$4\\times 4$大小的均匀同位网格上离散化的二维不可压缩流。该网格在两个方向上都具有周期性边界，在$x$和$y$方向上的网格间距为$h0$，且密度为常数。设速度和压力存储在由整数$(i,j)$索引的单元中心，其中$i,j\\in\\{0,1,2,3\\}$，且周期性以4为模。假设在一个预测步中，离散动量方程被线性化，并为每个单元组装一个严格为正的均匀对角系数$a_p0$，该系数代表瞬态项和扩散项的隐式贡献。在本分析中，忽略体积力和对流输运。定义单元$(i,j)$中心的离散压力梯度为二阶中心差分，即$(\\partial p/\\partial x)_{i,j}$近似为$(p_{i+1,j}-p_{i-1,j})/(2h)$，$(\\partial p/\\partial y)_{i,j}$近似为$(p_{i,j+1}-p_{i,j-1})/(2h)$，其中索引以4为模。\n\n在这种同位布置中，离散连续性方程中使用的面法向速度计算如下。\n\n- 不使用Rhie–Chow稳定化（RC）时，内部面上的面法向速度是相邻单元中心速度的算术平均值。例如，在单元$(i,j)$和$(i+1,j)$之间的东面上，$x$方向面速度为$u_{i+1/2,j}=\\tfrac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right)$，其他面以及南北面上的$v$也类似。单元中心速度是通过将带有系数$a_p$的离散压力梯度应用于预测速度得到的，即$u_{i,j}=u^{*}_{i,j}-\\frac{1}{a_p}\\left(\\partial p/\\partial x\\right)_{i,j}$和$v_{i,j}=v^{*}_{i,j}-\\frac{1}{a_p}\\left(\\partial p/\\partial y\\right)_{i,j}$，其中$u^{*}_{i,j}$和$v^{*}_{i,j}$是由非压力项产生的临时速度。\n\n- 使用Rhie–Chow稳定化（RC）时，面法向速度包含一个基于压力差的修正项，以避免压力奇偶解耦。在均匀网格上使用标准对称形式，东面上的$x$方向面速度为\n$$\nu^{\\text{RC}}_{i+1/2,j}=\\tfrac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right)-\\overline{d}_{i+1/2,j}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}-\\tfrac{1}{2}\\left(\\left.\\frac{\\partial p}{\\partial x}\\right|_{i,j}+\\left.\\frac{\\partial p}{\\partial x}\\right|_{i+1,j}\\right)\\right],\n$$\n其中$\\overline{d}_{i+1/2,j}=\\tfrac{1}{2}\\left(\\tfrac{1}{a_p}+\\tfrac{1}{a_p}\\right)=\\tfrac{1}{a_p}$，并且在$y$方向上对$v^{\\text{RC}}_{i,j+1/2}$有类似公式，其中$\\overline{d}=\\tfrac{1}{a_p}$，$h$为$y$方向的网格间距。单元$(i,j)$处的离散连续性方程使用离散散度的标准二阶面对差分形式，\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=\\frac{u_{i+1/2,j}-u_{i-1/2,j}}{h}+\\frac{v_{i,j+1/2}-v_{i,j-1/2}}{h}.\n$$\n\n现在施加一个振幅为$P_00$的纯棋盘格压力模式，\n$$\np_{i,j}=P_0\\,(-1)^{i+j},\n$$\n并对所有$(i,j)$取$u^{*}_{i,j}=0$和$v^{*}_{i,j}=0$，以分离出压力-速度耦合的影响。\n\n定义伪模式振幅$M$为一个标量，使得每个单元的离散散度等于由$M$缩放的棋盘格模式，\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=(-1)^{i+j}\\,M.\n$$\n\n仅使用给定的离散化和定义，在不使用和使用Rhie–Chow稳定化的情况下，推导出$M$作为$P_0$、$a_p$和$h$的显式函数。将您的最终答案表示为二分量行向量$\\left(M_{\\text{before}},\\,M_{\\text{after}}\\right)$，其中$M_{\\text{before}}$对应于不使用Rhie–Chow稳定化的情况，$M_{\\text{after}}$对应于使用Rhie–Chow稳定化的情况。无需进行数值计算；请提供一个封闭形式的符号表达式。", "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于计算流体动力学的原理，特别是关于同位网格上的压力-速度耦合。该问题是适定的、客观的，并包含获得唯一解所需的所有必要信息。\n\n目标是确定由棋盘格压力场$p_{i,j}=P_0\\,(-1)^{i+j}$产生的伪散度场的振幅$M$，该散度场由$(\\nabla\\cdot \\mathbf{u})_{i,j}=(-1)^{i+j}\\,M$定义。给定预测速度为$u^{*}_{i,j}=0$和$v^{*}_{i,j}=0$。我们将分析两种情况：不使用和使用Rhie-Chow稳定化。\n\n首先，我们计算给定压力场$p_{i,j} = P_0(-1)^{i+j}$的离散单元中心压力梯度。由于周期性，索引以4为模。对于单元$(i,j)$处的$x$方向：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h}\n$$\n代入压力场：\n$$\np_{i+1,j} = P_0(-1)^{i+1+j} = -P_0(-1)^{i+j}\n$$\n$$\np_{i-1,j} = P_0(-1)^{i-1+j} = -P_0(-1)^{i+j}\n$$\n因此，$x$方向的离散压力梯度为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{-P_0(-1)^{i+j} - (-P_0(-1)^{i+j})}{2h} = 0\n$$\n根据对称性，$y$方向的离散压力梯度也为零：\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h} = \\frac{-P_0(-1)^{i+j} - (-P_0(-1)^{i+j})}{2h} = 0\n$$\n棋盘格场的二阶中心差分梯度为零，这个结果是同位网格上出现压力-速度解耦的根本原因。\n\n接下来，我们使用给定的关系式确定单元中心速度$u_{i,j}$和$v_{i,j}$：\n$$\nu_{i,j} = u^{*}_{i,j} - \\frac{1}{a_p}\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = 0 - \\frac{1}{a_p}(0) = 0\n$$\n$$\nv_{i,j} = v^{*}_{i,j} - \\frac{1}{a_p}\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = 0 - \\frac{1}{a_p}(0) = 0\n$$\n因此，对于任何单元$(i,j)$，单元中心的速度处处为零。\n\n现在我们可以继续计算两种指定情况下的离散散度。\n\n**情况1：不使用Rhie-Chow稳定化 ($M_{\\text{before}}$)**\n\n在这种情况下，面法向速度是相邻单元中心速度的算术平均值。对于单元$(i,j)$的东面：\n$$\nu_{i+1/2,j} = \\frac{1}{2}\\left(u_{i,j} + u_{i+1,j}\\right) = \\frac{1}{2}\\left(0 + 0\\right) = 0\n$$\n类似地，$u_{i-1/2,j} = 0$，$v_{i,j+1/2} = 0$，以及$v_{i,j-1/2} = 0$。\n那么单元$(i,j)$处的离散散度为：\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j} = \\frac{u_{i+1/2,j}-u_{i-1/2,j}}{h}+\\frac{v_{i,j+1/2}-v_{i,j-1/2}}{h} = \\frac{0-0}{h} + \\frac{0-0}{h} = 0\n$$\n根据题意，$\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=(-1)^{i+j}\\,M_{\\text{before}}$。这意味着$0 = (-1)^{i+j}M_{\\text{before}}$。由于这必须对所有的$(i,j)$都成立，我们得出结论：\n$$\nM_{\\text{before}} = 0\n$$\n\n**情况2：使用Rhie-Chow稳定化 ($M_{\\text{after}}$)**\n\n单元中心速度仍然是$u_{i,j}=0$和$v_{i,j}=0$。然而，面法向速度是使用Rhie-Chow公式计算的。对于单元$(i,j)$的东面，我们有：\n$$\nu^{\\text{RC}}_{i+1/2,j} = \\frac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right) - \\overline{d}_{i+1/2,j}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}-\\frac{1}{2}\\left(\\left.\\frac{\\partial p}{\\partial x}\\right|_{i,j}+\\left.\\frac{\\partial p}{\\partial x}\\right|_{i+1,j}\\right)\\right]\n$$\n代入已知值：$u_{i,j}=u_{i+1,j}=0$，$(\\partial p/\\partial x)|_{i,j}=(\\partial p/\\partial x)|_{i+1,j}=0$，以及$\\overline{d}_{i+1/2,j} = 1/a_p$。表达式简化为：\n$$\nu^{\\text{RC}}_{i+1/2,j} = -\\frac{1}{a_p}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}\\right] = -\\frac{1}{a_p h}(p_{i+1,j}-p_{i,j})\n$$\n我们计算压力差：\n$$\np_{i+1,j}-p_{i,j} = P_0(-1)^{i+1+j} - P_0(-1)^{i+j} = P_0(-1)^{i+j}(-1-1) = -2P_0(-1)^{i+j}\n$$\n所以，面速度为：\n$$\nu^{\\text{RC}}_{i+1/2,j} = -\\frac{1}{a_p h}(-2P_0(-1)^{i+j}) = \\frac{2P_0}{a_p h}(-1)^{i+j}\n$$\n对于西面速度$u^{\\text{RC}}_{i-1/2,j}$，我们需要压力差$p_{i,j}-p_{i-1,j}$：\n$$\np_{i,j}-p_{i-1,j} = P_0(-1)^{i+j} - P_0(-1)^{i-1+j} = P_0(-1)^{i+j}(1-(-1)) = 2P_0(-1)^{i+j}\n$$\n西面上的速度为：\n$$\nu^{\\text{RC}}_{i-1/2,j} = -\\frac{1}{a_p h}(p_{i,j}-p_{i-1,j}) = -\\frac{1}{a_p h}(2P_0(-1)^{i+j}) = -\\frac{2P_0}{a_p h}(-1)^{i+j}\n$$\n散度的$x$分量是：\n$$\n\\frac{u^{\\text{RC}}_{i+1/2,j}-u^{\\text{RC}}_{i-1/2,j}}{h} = \\frac{1}{h}\\left[ \\frac{2P_0}{a_p h}(-1)^{i+j} - \\left(-\\frac{2P_0}{a_p h}(-1)^{i+j}\\right) \\right] = \\frac{4P_0}{a_p h^2}(-1)^{i+j}\n$$\n由于问题在$x$和$y$方向上的对称性，散度的$y$分量是相同的：\n$$\n\\frac{v^{\\text{RC}}_{i,j+1/2}-v^{\\text{RC}}_{i,j-1/2}}{h} = \\frac{4P_0}{a_p h^2}(-1)^{i+j}\n$$\n单元$(i,j)$处的总离散散度是这两个分量之和：\n$$\n(\\nabla\\cdot \\mathbf{u}^{\\text{RC}})_{i,j} = \\frac{4P_0}{a_p h^2}(-1)^{i+j} + \\frac{4P_0}{a_p h^2}(-1)^{i+j} = \\frac{8P_0}{a_p h^2}(-1)^{i+j}\n$$\n根据题意，$(\\nabla\\cdot \\mathbf{u}^{\\text{RC}})_{i,j}=(-1)^{i+j}\\,M_{\\text{after}}$。令这两个表达式相等，可得：\n$$\nM_{\\text{after}} = \\frac{8P_0}{a_p h^2}\n$$\n最终答案是二分量行向量$(M_{\\text{before}}, M_{\\text{after}})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{8P_0}{a_p h^2}\n\\end{pmatrix}\n}\n$$", "id": "3353857"}]}