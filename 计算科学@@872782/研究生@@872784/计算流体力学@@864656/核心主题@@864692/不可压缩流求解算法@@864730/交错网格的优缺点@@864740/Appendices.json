{"hands_on_practices": [{"introduction": "在深入探讨交错网格复杂的行为之前，验证其基本数值精度至关重要。本练习将引导你使用经典的截断误差分析方法，并结合一个“人造解”（manufactured solution），来证明交错的马可和赛尔（Marker-and-Cell, MAC）格式中的离散算子具有二阶精度[@problem_id:3289961]。这一特性是交错网格得以广泛应用的一个关键优势。", "problem": "考虑一个受质量守恒定律支配的二维不可压缩流，其中速度场的散度必须为零，且压力梯度出现在动量平衡中。在一个两个方向空间步长均为 $h$ 的均匀矩形网格上，采用 Marker-and-Cell (MAC) 交错排布：压力 $p$ 位于单元中心 $(x_i,y_j)$，水平速度分量 $u$ 位于垂直面中心 $(x_{i+\\frac{1}{2}},y_j)$，垂直速度分量 $v$ 位于水平面中心 $(x_i,y_{j+\\frac{1}{2}})$。\n\n设构造的光滑场为\n$$\nu(x,y) = \\sin(\\alpha x)\\sin(\\beta y), \\quad v(x,y) = \\cos(\\alpha x)\\cos(\\beta y), \\quad p(x,y) = \\sin(\\alpha x)\\cos(\\beta y),\n$$\n其中常数 $\\alpha>0$ 且 $\\beta>0$。将单元中心 $(x_0,y_0)$ 处的离散 MAC 散度定义为\n$$\nD_h[u,v](x_0,y_0) \\equiv \\frac{u(x_0+\\frac{h}{2},y_0)-u(x_0-\\frac{h}{2},y_0)}{h} + \\frac{v(x_0,y_0+\\frac{h}{2})-v(x_0,y_0-\\frac{h}{2})}{h},\n$$\n并将离散 MAC 压力梯度分量定义为\n$$\nG_h^x[p](x_0+\\tfrac{h}{2},y_0) \\equiv \\frac{p(x_0+h,y_0)-p(x_0,y_0)}{h}, \\qquad G_h^y[p](x_0,y_0+\\tfrac{h}{2}) \\equiv \\frac{p(x_0,y_0+h)-p(x_0,y_0)}{h}.\n$$\n\n从空间导数的定义出发，使用在计算点处锚定的泰勒级数展开，进行截断误差分析，以获得在均匀网格上 $D_h[u,v](x_0,y_0)$、$G_h^x[p](x_0+\\tfrac{h}{2},y_0)$ 和 $G_h^y[p](x_0,y_0+\\tfrac{h}{2})$ 的局部截断误差关于 $h$ 幂次的主阶项。明确证明这些主阶项与 $\\mathcal{O}(h^2)$ 同阶，从而展示均匀网格上的交错 MAC 散度和压力梯度在空间上具有二阶相合性。简要说明这种二阶相合性如何与交错网格的一个优点相关联，并指出一个与实现相关的缺点。\n\n最后，计算在点 $(x_0,y_0) = \\left(\\frac{1}{3},\\frac{1}{4}\\right)$ 处的主阶截断误差之和\n$$\nS(h) \\equiv \\operatorname{TE}_{\\mathrm{div}}(x_0,y_0) + \\operatorname{TE}_{\\mathrm{grad},x}(x_0+\\tfrac{h}{2},y_0) + \\operatorname{TE}_{\\mathrm{grad},y}(x_0,y_0+\\tfrac{h}{2}),\n$$\n并将 $S(h)$ 表示为关于 $\\alpha$、$\\beta$ 和 $h$ 的单个闭式解析表达式。精确表达最终答案；无需四舍五入，且此处的量不带物理单位。", "solution": "该问题要求对用于散度和压力梯度的 Marker-and-Cell (MAC) 交错网格有限差分算子进行截断误差分析，讨论该方法的性质，并对给定的一组构造场，显式计算主阶误差项之和。\n\n对于一个函数 $f$，逼近连续微分算子 $L$ 的离散算子 $L_h$ 的局部截断误差 (TE) 定义为 $\\operatorname{TE}[f] \\equiv L_h[f] - L[f]$。截断误差的主阶项决定了离散化的精度阶数。\n\n**1. 离散散度 $D_h[u,v]$ 的截断误差分析**\n\n单元中心 $(x_0, y_0)$ 处的离散散度由下式给出：\n$$\nD_h[u,v](x_0,y_0) = \\frac{u(x_0+\\frac{h}{2},y_0)-u(x_0-\\frac{h}{2},y_0)}{h} + \\frac{v(x_0,y_0+\\frac{h}{2})-v(x_0,y_0-\\frac{h}{2})}{h}\n$$\n相应的连续算子是在 $(x_0, y_0)$ 处计算的散度 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}$。\n\n我们对 $u$ 和 $v$ 在点 $(x_0, y_0)$ 附近进行泰勒级数展开。对于涉及 $u$ 的第一项，我们有：\n$$\nu(x_0 \\pm \\frac{h}{2}, y_0) = u(x_0,y_0) \\pm \\frac{h}{2}\\frac{\\partial u}{\\partial x}\\bigg|_{(x_0,y_0)} + \\frac{1}{2!}\\left(\\frac{h}{2}\\right)^2\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{(x_0,y_0)} \\pm \\frac{1}{3!}\\left(\\frac{h}{2}\\right)^3\\frac{\\partial^3 u}{\\partial x^3}\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^4)\n$$\n将两个展开式相减可得：\n$$\nu(x_0+\\frac{h}{2},y_0) - u(x_0-\\frac{h}{2},y_0) = h\\frac{\\partial u}{\\partial x}\\bigg|_{(x_0,y_0)} + \\frac{h^3}{24}\\frac{\\partial^3 u}{\\partial x^3}\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^5)\n$$\n两边除以 $h$，我们得到 $\\frac{\\partial u}{\\partial x}$ 的近似：\n$$\n\\frac{u(x_0+\\frac{h}{2},y_0)-u(x_0-\\frac{h}{2},y_0)}{h} = \\frac{\\partial u}{\\partial x}\\bigg|_{(x_0,y_0)} + \\frac{h^2}{24}\\frac{\\partial^3 u}{\\partial x^3}\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^4)\n$$\n对 $v$ 分量关于 $y$ 进行相同的分析可得：\n$$\n\\frac{v(x_0,y_0+\\frac{h}{2})-v(x_0,y_0-\\frac{h}{2})}{h} = \\frac{\\partial v}{\\partial y}\\bigg|_{(x_0,y_0)} + \\frac{h^2}{24}\\frac{\\partial^3 v}{\\partial y^3}\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^4)\n$$\n将这两个结果相加，得到离散散度算子的展开式：\n$$\nD_h[u,v](x_0,y_0) = \\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right)\\bigg|_{(x_0,y_0)} + \\frac{h^2}{24}\\left(\\frac{\\partial^3 u}{\\partial x^3} + \\frac{\\partial^3 v}{\\partial y^3}\\right)\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^4)\n$$\n截断误差为 $\\operatorname{TE}_{\\mathrm{div}} = D_h[u,v] - (\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y})$。主阶项为：\n$$\n\\operatorname{TE}_{\\mathrm{div}}(x_0,y_0) = \\frac{h^2}{24}\\left(\\frac{\\partial^3 u}{\\partial x^3} + \\frac{\\partial^3 v}{\\partial y^3}\\right)\\bigg|_{(x_0,y_0)} + \\mathcal{O}(h^4)\n$$\n此项为 $\\mathcal{O}(h^2)$ 阶，因此该算子是二阶精确的。\n\n**2. 离散压力梯度 $G_h[p]$ 的截断误差分析**\n\n压力梯度的离散 x 分量在 $u$ 速度位置 $(x_0+\\frac{h}{2},y_0)$ 处计算：\n$$\nG_h^x[p](x_0+\\tfrac{h}{2},y_0) = \\frac{p(x_0+h,y_0)-p(x_0,y_0)}{h}\n$$\n我们通过将 $p(x_0+h, y_0)$ 和 $p(x_0, y_0)$ 在计算点 $(x_0+\\frac{h}{2}, y_0)$ 附近展开来分析此式。令 $x' = x_0+\\frac{h}{2}$。则模板点为 $x'+\\frac{h}{2}$ 和 $x'-\\frac{h}{2}$。\n$$\np(x' \\pm \\frac{h}{2}, y_0) = p(x',y_0) \\pm \\frac{h}{2}\\frac{\\partial p}{\\partial x}\\bigg|_{(x',y_0)} + \\frac{h^2}{8}\\frac{\\partial^2 p}{\\partial x^2}\\bigg|_{(x',y_0)} \\pm \\frac{h^3}{48}\\frac{\\partial^3 p}{\\partial x^3}\\bigg|_{(x',y_0)} + \\mathcal{O}(h^4)\n$$\n标准的中心差分公式给出：\n$$\nG_h^x[p](x',y_0) = \\frac{\\partial p}{\\partial x}\\bigg|_{(x',y_0)} + \\frac{h^2}{24}\\frac{\\partial^3 p}{\\partial x^3}\\bigg|_{(x',y_0)} + \\mathcal{O}(h^4)\n$$\n代入 $x' = x_0+\\frac{h}{2}$，主阶截断误差为：\n$$\n\\operatorname{TE}_{\\mathrm{grad},x}(x_0+\\tfrac{h}{2},y_0) = \\frac{h^2}{24}\\frac{\\partial^3 p}{\\partial x^3}\\bigg|_{(x_0+h/2,y_0)} + \\mathcal{O}(h^4)\n$$\n该算子也是二阶精确的。根据对称性，对在 $(x_0, y_0+\\frac{h}{2})$ 处计算的梯度 y 分量进行分析，可得：\n$$\n\\operatorname{TE}_{\\mathrm{grad},y}(x_0,y_0+\\tfrac{h}{2}) = \\frac{h^2}{24}\\frac{\\partial^3 p}{\\partial y^3}\\bigg|_{(x_0,y_0+h/2)} + \\mathcal{O}(h^4)\n$$\n这证明了在均匀交错网格上，离散散度和压力梯度算子都具有二阶相合性。\n\n**3. 交错网格的优点和缺点**\n\n交错网格排布的一个重要优点是它在压力和速度之间建立了强的、自然的耦合。对于同位网格（所有变量位于同一节点），压力梯度的简单中心差分只涉及不相邻的压力节点（例如，用 $p_{i+1}$ 和 $p_{i-1}$ 计算节点 $i$ 处的梯度）。这可能导致解耦，使得压力场中的高频、非物理“棋盘”振荡不能被离散梯度算子“感知”，因此不影响速度场。交错网格通过使用相邻单元中的压力值来计算单元面上的速度（例如，$u_{i+1/2}$ 由 $p_{i+1}-p_i$ 驱动），从而防止了这种情况，确保了穿过单元的压力差直接影响通过它的流动。\n\n一个主要缺点是实现复杂性的增加。管理不同变量的位置需要更复杂的数据结构和索引逻辑。边界条件的实现也更复杂，因为不同变量距离物理边界的距离不同。在非笛卡尔网格上，这种复杂性会加剧。\n\n**4. 主阶截断误差之和的计算**\n\n我们需要计算主阶截断误差项之和 $S(h)$：\n$$\nS(h) = \\frac{h^2}{24}\\left[ \\left(\\frac{\\partial^3 u}{\\partial x^3} + \\frac{\\partial^3 v}{\\partial y^3}\\right)\\bigg|_{(x_0,y_0)} + \\frac{\\partial^3 p}{\\partial x^3}\\bigg|_{(x_0+h/2,y_0)} + \\frac{\\partial^3 p}{\\partial y^3}\\bigg|_{(x_0,y_0+h/2)} \\right]\n$$\n首先，我们从给定的构造解中计算所需的三阶导数：\n$u(x,y) = \\sin(\\alpha x)\\sin(\\beta y)$\n$v(x,y) = \\cos(\\alpha x)\\cos(\\beta y)$\n$p(x,y) = \\sin(\\alpha x)\\cos(\\beta y)$\n\n导数是：\n$\\frac{\\partial^3 u}{\\partial x^3} = -\\alpha^3 \\cos(\\alpha x)\\sin(\\beta y)$\n$\\frac{\\partial^3 v}{\\partial y^3} = \\beta^3 \\cos(\\alpha x)\\sin(\\beta y)$\n$\\frac{\\partial^3 p}{\\partial x^3} = -\\alpha^3 \\cos(\\alpha x)\\cos(\\beta y)$\n$\\frac{\\partial^3 p}{\\partial y^3} = \\beta^3 \\sin(\\alpha x)\\sin(\\beta y)$\n\n现在，我们组合 $S(h)$ 的表达式：\n$$\nS(h) = \\frac{h^2}{24}\\left[ \\left(-\\alpha^3 \\cos(\\alpha x)\\sin(\\beta y) + \\beta^3 \\cos(\\alpha x)\\sin(\\beta y)\\right)\\bigg|_{(x_0,y_0)} \\right. \\\\ \\left. + \\left(-\\alpha^3 \\cos(\\alpha x)\\cos(\\beta y)\\right)\\bigg|_{(x_0+h/2,y_0)} + \\left(\\beta^3 \\sin(\\alpha x)\\sin(\\beta y)\\right)\\bigg|_{(x_0,y_0+h/2)} \\right]\n$$\n简化第一项：\n$$\nS(h) = \\frac{h^2}{24}\\left[ (\\beta^3 - \\alpha^3)\\cos(\\alpha x_0)\\sin(\\beta y_0) - \\alpha^3 \\cos\\left(\\alpha(x_0+\\frac{h}{2})\\right)\\cos(\\beta y_0) \\right. \\\\ \\left. + \\beta^3 \\sin(\\alpha x_0)\\sin\\left(\\beta(y_0+\\frac{h}{2})\\right) \\right]\n$$\n最后，我们代入指定的点 $(x_0, y_0) = (\\frac{1}{3}, \\frac{1}{4})$：\n$$\nS(h) = \\frac{h^2}{24}\\left[ (\\beta^3 - \\alpha^3)\\cos\\left(\\frac{\\alpha}{3}\\right)\\sin\\left(\\frac{\\beta}{4}\\right) - \\alpha^3 \\cos\\left(\\alpha\\left(\\frac{1}{3}+\\frac{h}{2}\\right)\\right)\\cos\\left(\\frac{\\beta}{4}\\right) \\right. \\\\ \\left. + \\beta^3 \\sin\\left(\\frac{\\alpha}{3}\\right)\\sin\\left(\\beta\\left(\\frac{1}{4}+\\frac{h}{2}\\right)\\right) \\right]\n$$\n这是主阶截断误差之和的最终闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{h^2}{24} \\left[ (\\beta^3 - \\alpha^3)\\cos\\left(\\frac{\\alpha}{3}\\right)\\sin\\left(\\frac{\\beta}{4}\\right) - \\alpha^3 \\cos\\left(\\frac{\\alpha}{3}+\\frac{\\alpha h}{2}\\right)\\cos\\left(\\frac{\\beta}{4}\\right) + \\beta^3 \\sin\\left(\\frac{\\alpha}{3}\\right)\\sin\\left(\\frac{\\beta}{4}+\\frac{\\beta h}{2}\\right) \\right]}\n$$", "id": "3289961"}, {"introduction": "理论分析之后，我们通过一个实际的计算练习来探索交错网格最著名的优点。同位网格（collocated grid）在处理不可压缩流时，常常会受到非物理的“棋盘格”压力振荡的困扰，而交错网格能够自然地抑制这种现象。通过这个练习，你将亲手实现并对比两种网格布置下的算子，直观地观察到同位网格的失效，并验证交错网格的稳健性[@problem_id:3289986]。", "problem": "考虑计算流体力学 (CFD) 中的二维不可压缩压力-速度耦合问题，其中压力梯度驱动速度更新，离散散度算子强制执行质量守恒。当中心差分使用不当时，同位网格配置中会出现奇偶解耦和压力棋盘格现象，而交错网格配置则能抑制这些模式。设计一个人造解和离散算子，在纯数学的环境下量化这一现象。\n\n使用一个方形周期性域 $[0,1]\\times[0,1]$，将其离散为 $N\\times N$ 个大小为 $\\Delta x=\\Delta y=1/N$ 的均匀单元。压力 $p$ 定义在单元中心 $(x_i,y_j)$ 处，其中 $x_i=(i+\\tfrac{1}{2})\\Delta x$，$y_j=(j+\\tfrac{1}{2})\\Delta y$，索引 $i,j\\in\\{0,1,\\dots,N-1\\}$。\n\n人造解：\n- 棋盘格（奈奎斯特）模式：$p_{i,j}=(-1)^{i+j}$，这对应于网格尺度上的交替模式。\n- 平滑模式：$p_{i,j}=\\sin(2\\pi x_i)\\sin(2\\pi y_j)$。\n\n具有周期性边界条件的离散算子：\n1. 单元中心的同位中心差分梯度和散度：\n   - 中心点梯度：\n     $$G_{x}^{c}(i,j)=\\frac{p_{i+1,j}-p_{i-1,j}}{2\\Delta x},\\quad G_{y}^{c}(i,j)=\\frac{p_{i,j+1}-p_{i,j-1}}{2\\Delta y}.$$\n   - 中心点梯度的散度：\n     $$D^{c}G^{c}(i,j)=\\frac{G_{x}^{c}(i+1,j)-G_{x}^{c}(i-1,j)}{2\\Delta x}+\\frac{G_{y}^{c}(i,j+1)-G_{y}^{c}(i,j-1)}{2\\Delta y}.$$\n2. 面上的交错梯度和到中心的散度（通量差分）：\n   - 面梯度：\n     $$G_{x}^{s}(i+\\tfrac{1}{2},j)=\\frac{p_{i+1,j}-p_{i,j}}{\\Delta x},\\quad G_{y}^{s}(i,j+\\tfrac{1}{2})=\\frac{p_{i,j+1}-p_{i,j}}{\\Delta y}.$$\n   - 面梯度到中心的散度：\n     $$D^{s}G^{s}(i,j)=\\frac{G_{x}^{s}(i+\\tfrac{1}{2},j)-G_{x}^{s}(i-\\tfrac{1}{2},j)}{\\Delta x}+\\frac{G_{y}^{s}(i,j+\\tfrac{1}{2})-G_{y}^{s}(i,j-\\tfrac{1}{2})}{\\Delta y}.$$\n\n定义五点离散拉普拉斯算子作为参考算子：\n$$L p_{i,j}=\\frac{p_{i+1,j}+p_{i-1,j}+p_{i,j+1}+p_{i,j-1}-4p_{i,j}}{\\Delta x^{2}}.$$\n\n为网格函数 $q_{i,j}$ 定义离散 $L^{2}$ 范数如下\n$$\\|q\\|_{2}=\\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} q_{i,j}^{2}\\,\\Delta x\\,\\Delta y}.$$\n\n对于每个测试案例，计算：\n- $L^{2}$ 误差 $E=\\|D^{\\star}G^{\\star}p-Lp\\|_{2}$，其中 $\\star\\in\\{c,s\\}$ 表示同位或交错。\n- 棋盘格振幅比 $A=\\|D^{\\star}G^{\\star}p\\|_{2}/\\|Lp\\|_{2}$。\n\n待研究的科学原理：\n- 证明同位算子 $D^{c}G^{c}$ 能消除奈奎斯特棋盘格模式，即得到 $A\\approx 0$，这展示了奇偶解耦和伪压力模式。\n- 证明交错算子 $D^{s}G^{s}$ 在两种模式下都与参考拉普拉斯算子匹配，即得到 $A\\approx 1$ 和 $E\\approx 0$，从而抑制了棋盘格现象。\n\n物理和数值单位：\n- 无物理单位；所有量均为无量纲。角度（若有）以弧度为单位，但只使用无量纲参数的三角函数。\n\n测试套件：\n- 案例 1：$N=8$，棋盘格模式，同位网格。\n- 案例 2：$N=8$，棋盘格模式，交错网格。\n- 案例 3：$N=32$，棋盘格模式，同位网格。\n- 案例 4：$N=4$，棋盘格模式，同位网格（边界粗网格）。\n- 案例 5：$N=32$，平滑模式，同位网格。\n- 案例 6：$N=32$，平滑模式，交错网格。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例的结果必须是按顺序包含浮点数 $[E,A]$ 的双元素列表。例如，输出格式必须为\n$$[ [E_{1},A_{1}], [E_{2},A_{2}], \\dots ]$$\n无任何附加文本。", "solution": "用户提供了有效的问题陈述。所有给定条件均已提取并验证。\n\n### **问题验证**\n\n**1. 提取给定条件：**\n- **域：** 一个方形周期性域 $[0,1]\\times[0,1]$。\n- **离散化：** 一个 $N\\times N$ 的均匀网格，单元尺寸为 $\\Delta x=\\Delta y=1/N$。\n- **网格点：** 压力 $p$ 定义在单元中心 $(x_i,y_j)$，其中 $x_i=(i+\\frac{1}{2})\\Delta x$ 且 $y_j=(j+\\frac{1}{2})\\Delta y$，对于 $i,j\\in\\{0,1,\\dots,N-1\\}$。\n- **人造解：**\n    - 棋盘格模式：$p_{i,j}=(-1)^{i+j}$。\n    - 平滑模式：$p_{i,j}=\\sin(2\\pi x_i)\\sin(2\\pi y_j)$。\n- **离散算子（周期性）：**\n    - 同位梯度-散度：$D^{c}G^{c}(i,j)=\\frac{G_{x}^{c}(i+1,j)-G_{x}^{c}(i-1,j)}{2\\Delta x}+\\frac{G_{y}^{c}(i,j+1)-G_{y}^{c}(i,j-1)}{2\\Delta y}$，其中 $G_{x}^{c}(i,j)=\\frac{p_{i+1,j}-p_{i-1,j}}{2\\Delta x}$ 且 $G_{y}^{c}(i,j)=\\frac{p_{i,j+1}-p_{i,j-1}}{2\\Delta y}$。\n    - 交错梯度-散度：$D^{s}G^{s}(i,j)=\\frac{G_{x}^{s}(i+\\frac{1}{2},j)-G_{x}^{s}(i-\\frac{1}{2},j)}{\\Delta x}+\\frac{G_{y}^{s}(i,j+\\frac{1}{2})-G_{y}^{s}(i,j-\\frac{1}{2})}{\\Delta y}$，其中 $G_{x}^{s}(i+\\frac{1}{2},j)=\\frac{p_{i+1,j}-p_{i,j}}{\\Delta x}$ 且 $G_{y}^{s}(i,j+\\frac{1}{2})=\\frac{p_{i,j+1}-p_{i,j}}{\\Delta y}$。\n- **参考算子（拉普拉斯算子）：** $L p_{i,j}=\\frac{p_{i+1,j}+p_{i-1,j}+p_{i,j+1}+p_{i,j-1}-4p_{i,j}}{\\Delta x^{2}}$。\n- **范数：** 离散 $L^{2}$ 范数 $\\|q\\|_{2}=\\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} q_{i,j}^{2}\\,\\Delta x\\,\\Delta y}$。\n- **度量指标：** 误差 $E=\\|D^{\\star}G^{\\star}p-Lp\\|_{2}$ 和振幅比 $A=\\|D^{\\star}G^{\\star}p\\|_{2}/\\|Lp\\|_{2}$，其中 $\\star\\in\\{c,s\\}$。\n- **测试案例：** 指定了六个测试案例，改变了 $N$、压力模式和算子类型。\n\n**2. 验证：**\n- **科学合理性：** 该问题在科学上是合理的。它构建了一个经典的数值分析实验，用以研究同位网格有限差分格式中的奇偶解耦现象，这是计算流体力学中的一个基本课题。所用的算子和人造解是标准的验证工具。\n- **适定性：** 该问题是适定的。所有的数学对象（域、网格、算子、范数）都有精确的定义。任务是定量的，并且对每个测试案例都能得出一个唯一、可计算的结果。\n- **客观性：** 问题陈述是客观的，使用了没有歧义或主观论断的形式化数学语言。\n- **结论：** 该问题是有效的和自洽的。\n\n**3. 行动：** 继续进行求解。\n\n### **理论分析与求解方法**\n\n目标是量化同位和交错网格配置对特定压力场的响应。分析的核心在于展开复合的“散度-梯度”算子 $D^{\\star}G^{\\star}$，并将其与参考的五点拉普拉斯算子 $L$ 进行比较。所有索引运算均按模 N 执行，以强制施加周期性边界条件。\n\n**交错算子分析**\n首先，我们分析交错算子 $D^{s}G^{s}$。通过将面梯度的定义代入散度表达式，我们得到该算子对压力场 $p_{i,j}$ 的作用。\n散度的 $x$ 分量为：\n$$ \\frac{G_{x}^{s}(i+\\frac{1}{2},j)-G_{x}^{s}(i-\\frac{1}{2},j)}{\\Delta x} = \\frac{1}{\\Delta x} \\left( \\frac{p_{i+1,j}-p_{i,j}}{\\Delta x} - \\frac{p_{i,j}-p_{i-1,j}}{\\Delta x} \\right) = \\frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{\\Delta x^2} $$\n$y$ 分量是类似的。将它们相加并注意到 $\\Delta x = \\Delta y$，我们发现：\n$$ D^{s}G^{s}p_{i,j} = \\frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{\\Delta x^2} + \\frac{p_{i,j+1}-2p_{i,j}+p_{i,j-1}}{\\Delta y^2} = \\frac{p_{i+1,j}+p_{i-1,j}+p_{i,j+1}+p_{i,j-1}-4p_{i,j}}{\\Delta x^2} $$\n该表达式与参考的五点拉普拉斯算子 $Lp_{i,j}$ 的定义完全相同。\n$$ D^{s}G^{s}p_{i,j} \\equiv Lp_{i,j} $$\n因此，对于交错配置，误差 $E=\\|D^{s}G^{s}p-Lp\\|_{2}$ 将恒等于零（在机器精度范围内），并且对于任何满足 $\\|Lp\\|_2 \\neq 0$ 的压力场，振幅比 $A=\\|D^{s}G^{s}p\\|_{2}/\\|Lp\\|_{2}$ 将恒等于一。此格式能正确地表示压力拉普拉斯算子。\n\n**同位算子分析**\n接下来，我们分析同位算子 $D^{c}G^{c}$。我们将中心差分梯度代入中心差分散度中。\n散度的 $x$ 分量为：\n$$ \\frac{G_{x}^{c}(i+1,j)-G_{x}^{c}(i-1,j)}{2\\Delta x} = \\frac{1}{2\\Delta x} \\left( \\frac{p_{i+2,j}-p_{i,j}}{2\\Delta x} - \\frac{p_{i,j}-p_{i-2,j}}{2\\Delta x} \\right) = \\frac{p_{i+2,j}-2p_{i,j}+p_{i-2,j}}{4\\Delta x^2} $$\n$y$ 分量是类似的。将它们相加得到：\n$$ D^{c}G^{c}p_{i,j} = \\frac{p_{i+2,j}+p_{i-2,j}+p_{i,j+2}+p_{i,j-2}-4p_{i,j}}{4\\Delta x^2} $$\n该算子是一个五点拉普拉斯算子，但它作用于间距为 $2\\Delta x$ 的模板上，而不是 $\\Delta x$。模板上的这种差异是解耦现象的根本原因。\n\n**在人造解上的应用**\n\n1. 棋盘格（奈奎斯特）模式：$p_{i,j} = (-1)^{i+j}$\n   - **同位算子：** 我们应用展开后的 $D^{c}G^{c}$ 算子。注意 $p_{i\\pm 2,j} = (-1)^{(i\\pm 2)+j} = (-1)^2 (-1)^{i+j} = p_{i,j}$。类似地，$p_{i,j\\pm 2} = p_{i,j}$。将这些代入算子表达式得到：\n     $$ D^{c}G^{c}p_{i,j} = \\frac{p_{i,j}+p_{i,j}+p_{i,j}+p_{i,j}-4p_{i,j}}{4\\Delta x^2} = 0 $$\n     同位算子消除了棋盘格模式。它位于算子的零空间中。这意味着 $\\|D^{c}G^{c}p\\|_{2} = 0$，因此振幅比 $A=0$。这是奇偶解耦的数学特征：一个非零的压力模式产生了零压力梯度，无法驱动流体运动。\n   - **参考拉普拉斯算子：** 将 $L$ 应用于棋盘格模式：$p_{i\\pm 1, j} = -p_{i,j}$ 且 $p_{i, j\\pm 1} = -p_{i,j}$。\n     $$ Lp_{i,j} = \\frac{-p_{i,j}-p_{i,j}-p_{i,j}-p_{i,j}-4p_{i,j}}{\\Delta x^2} = \\frac{-8p_{i,j}}{\\Delta x^2} = -8N^2 p_{i,j} $$\n     这显然是非零的。误差为 $E = \\|D^{c}G^{c}p - Lp\\|_{2} = \\|0 - Lp\\|_{2} = \\|Lp\\|_{2}$。\n     我们可以计算这个范数：\n     $$ \\|Lp\\|_{2}^2 = \\sum_{i,j=0}^{N-1} (-8N^2 p_{i,j})^2 \\Delta x \\Delta y = \\sum_{i,j=0}^{N-1} 64N^4 ((-1)^{i+j})^2 \\frac{1}{N^2} = \\frac{64N^4}{N^2} \\sum_{i,j=0}^{N-1} 1 = 64N^2 \\cdot N^2 = 64N^4 $$\n     因此，$E = \\|Lp\\|_{2} = \\sqrt{64N^4} = 8N^2$。\n   - **交错算子：** 如前所示，$D^s G^s p = Lp$。因此，$E=0$ 且 $A=1$。交错格式能正确地解析棋盘格模式。\n\n2. 平滑模式：$p_{i,j} = \\sin(2\\pi x_i)\\sin(2\\pi y_j)$\n   - **交错算子：** 同样，$D^s G^s p = Lp$，所以 $E=0$ 且 $A=1$。该算子相对于参考拉普拉斯算子是精确的。\n   - **同位算子：** 算子 $D^c G^c$ 和 $L$ 都是连续拉普拉斯算子 $\\nabla^2$ 的二阶精确近似。但是，它们并不相同。它们的截断误差不同。\n     对于一个平滑函数 $f(x)$，主导误差项为：\n     $$ Lf - f'' = \\frac{\\Delta x^2}{12} f^{(4)} + O(\\Delta x^4) $$\n     $$ (D^c G^c f)_{\\text{1D}} - f'' = \\frac{(2\\Delta x)^2}{12} f^{(4)} + O(\\Delta x^4) = \\frac{4\\Delta x^2}{12} f^{(4)} + O(\\Delta x^4) $$\n     同位算子的截断误差大四倍。它们的差值 $D^c G^c p - Lp$ 是非零的，导致非零误差 $E$。由于对于这种平滑的长波模式，两个算子都为同一个底层连续算子提供了合理的近似，它们的范数将是相似的，从而导致振幅比 $A \\approx 1$。\n\n**预测总结**\n- **案例 1, 3, 4 (棋盘格, 同位网格):** $A=0$, $E=8N^2$。\n- **案例 2 (棋盘格, 交错网格):** $A=1$, $E=0$。\n- **案例 5 (平滑, 同位网格):** $A \\approx 1$, $E > 0$。\n- **案例 6 (平滑, 交错网格):** $A=1$, $E=0$。\n\n这些理论预测将通过数值实现来验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_case(N, mode, op_type):\n    \"\"\"\n    Computes the error E and amplitude ratio A for a single test case.\n    \n    Args:\n        N (int): Number of grid cells in each dimension.\n        mode (str): Type of manufactured solution ('checkerboard' or 'smooth').\n        op_type (str): Type of discrete operator ('collocated' or 'staggered').\n\n    Returns:\n        tuple: A tuple containing the L2 error (E) and amplitude ratio (A).\n    \"\"\"\n    dx = 1.0 / N\n    dy = 1.0 / N\n\n    # Define grid indices and coordinates\n    i_indices = np.arange(N)\n    j_indices = np.arange(N)\n    ii, jj = np.meshgrid(i_indices, j_indices, indexing='ij')\n\n    # Construct the pressure field p\n    if mode == 'checkerboard':\n        p = (-1.0)**(ii + jj)\n    elif mode == 'smooth':\n        # Cell-centered coordinates\n        x = (ii + 0.5) * dx\n        y = (jj + 0.5) * dy\n        p = np.sin(2.0 * np.pi * x) * np.sin(2.0 * np.pi * y)\n    else:\n        raise ValueError(\"Unknown mode type\")\n\n    # --- Operator Calculations ---\n\n    # Periodic shifts for stencils\n    # i-direction shifts\n    p_ip1 = np.roll(p, -1, axis=0) # Index i+1\n    p_im1 = np.roll(p,  1, axis=0) # Index i-1\n    # j-direction shifts\n    p_jp1 = np.roll(p, -1, axis=1) # Index j+1\n    p_jm1 = np.roll(p,  1, axis=1) # Index j-1\n\n    # 1. Reference 5-point Laplacian (Lp)\n    # Since dx = dy, we use dx**2\n    Lp = (p_ip1 + p_im1 + p_jp1 + p_jm1 - 4.0 * p) / (dx**2)\n\n    # 2. Divergence-of-Gradient operator (DGp)\n    if op_type == 'collocated':\n        # Expanded form of D^c G^c operator\n        # This stencil uses points at i±2 and j±2\n        p_ip2 = np.roll(p, -2, axis=0)\n        p_im2 = np.roll(p,  2, axis=0)\n        p_jp2 = np.roll(p, -2, axis=1)\n        p_jm2 = np.roll(p,  2, axis=1)\n        DGp = (p_ip2 + p_im2 + p_jp2 + p_jm2 - 4.0 * p) / (4.0 * dx**2)\n    elif op_type == 'staggered':\n        # Expanded form of D^s G^s operator, which is identical to Lp\n        DGp = (p_ip1 + p_im1 + p_jp1 + p_jm1 - 4.0 * p) / (dx**2)\n    else:\n        raise ValueError(\"Unknown operator type\")\n\n    # --- Metric Calculations ---\n\n    def l2_norm(q_grid):\n        \"\"\"Computes the discrete L2 norm of a grid function.\"\"\"\n        cell_area = dx * dy\n        return np.sqrt(np.sum(q_grid**2 * cell_area))\n\n    # Calculate norms of the operator outputs\n    norm_Lp = l2_norm(Lp)\n    norm_DGp = l2_norm(DGp)\n    \n    # Calculate the L2 error E\n    error_field = DGp - Lp\n    E = l2_norm(error_field)\n\n    # Calculate the amplitude ratio A\n    # Avoid division by zero\n    if norm_Lp > 1e-15:\n        A = norm_DGp / norm_Lp\n    else:\n        # If Lp is zero, A is undefined.\n        # If DGp is also zero, 1.0 is a plausible convention (0/0 -> 1).\n        # If DGp is non-zero, the ratio is infinite.\n        A = 1.0 if norm_DGp  1e-15 else np.inf\n\n    return E, A\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (N, mode, operator_type)\n        (8, 'checkerboard', 'collocated'),\n        (8, 'checkerboard', 'staggered'),\n        (32, 'checkerboard', 'collocated'),\n        (4, 'checkerboard', 'collocated'),\n        (32, 'smooth', 'collocated'),\n        (32, 'smooth', 'staggered'),\n    ]\n\n    results = []\n    for N, mode, op_type in test_cases:\n        E, A = compute_case(N, mode, op_type)\n        results.append([E, A])\n\n    # Format the output as a list of lists string\n    # e.g., [[E1,A1],[E2,A2],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3289986"}]}