{"hands_on_practices": [{"introduction": "本练习是理解数值格式的基石。通过从基本原理出发，推导一阶迎风格式的守恒通量形式，证明其质量守恒性，并通过修正方程分析量化其内禀的人工扩散，您将为分析更复杂的方法打下坚实的基础。这个过程将揭示该格式作为计算流体动力学基本工具的核心特性。[@problem_id:3292605]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其波速为正常数 $a0$，定义在周期性域上，并在均匀网格 $x_{i} = i\\,\\Delta x$ 和时间层 $t_{n} = n\\,\\Delta t$ 上进行离散化。定义 Courant–Friedrichs–Lewy (CFL) 数 $C = a\\,\\Delta t/\\Delta x$。对于 $a0$ 的情况，显式一阶迎风法通过在上游方向上进行差分，将单元中心值 $u_{i}^{n}$ 更新为 $u_{i}^{n+1}$。\n\n从这些基本原理出发，并且不援引任何预先给定的通量公式：\n- 推导更新式的通量差分表示形式 $u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$，并确定当 $a0$ 时相容的数值通量 $F_{i+1/2}^{\\,n}$。\n- 仅使用此通量差分形式和周期性边界条件，通过计算 $M^{n+1} - M^{n}$ 来证明总质量的离散守恒，其中 $M^{n} = \\sum_{i} u_{i}^{n}\\,\\Delta x$，并解释导致守恒的机制。\n- 进行形式化的修正方程分析，直至并包含 $\\mathcal{O}(\\Delta x, \\Delta t)$ 阶的项，以确定主导的人工扩散系数 $D_{\\mathrm{art}}$，使得数值解满足 $u_{t} + a\\,u_{x} = D_{\\mathrm{art}}\\,u_{xx} + \\text{更高阶项}$。\n\n请以关于 $a$、$\\Delta x$ 和 $\\Delta t$ 的单个闭合形式符号表达式提供您的最终答案 $D_{\\mathrm{art}}$。不要包含单位，也不要进行数值计算。", "solution": "该问题陈述已经过验证，被认为是合理的。这是一个在偏微分方程数值分析领域（特别是计算流体力学）中的标准、适定的问题。它具有科学依据，客观，并包含了进行唯一且有意义的求解所需的所有必要信息。\n\n按要求，分析分三部分进行：通量差分形式的推导、离散质量守恒的证明，以及通过修正方程分析求取人工扩散系数。\n\n### 第1部分：通量差分形式的推导\n\n一维线性平流方程由下式给出：\n$$u_{t} + a\\,u_{x} = 0$$\n其中波速 $a$ 是一个正常数 ($a0$)。\n\n我们在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上离散化此方程。在网格点 $x_i = i\\,\\Delta x$ 和时间 $t_n = n\\,\\Delta t$ 上的解的值表示为 $u_i^n$。\n\n对时间导数使用向前差分格式：\n$$u_t \\approx \\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t}$$\n\n对于空间导数 $u_x$，采用一阶迎风法。由于 $a  0$，波从左向右传播，因此“迎风”方向是点 $x_i$ 的左侧。因此，我们使用一阶向后差分：\n$$u_x \\approx \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}$$\n\n将这些离散化代入偏微分方程，得到一阶迎风格式的有限差分方程：\n$$\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a\\left(\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\\right) = 0$$\n\n重新整理以求解 $u_i^{n+1}$：\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)$$\n\n我们被要求将其表示为通量差分形式：\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n比较 $u_i^{n+1}$ 的两个表达式，我们可以令乘以 $\\frac{\\Delta t}{\\Delta x}$ 的项相等：\n$$F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n} = a\\left(u_{i}^{n} - u_{i-1}^{n}\\right) = a\\,u_{i}^{n} - a\\,u_{i-1}^{n}$$\n\n通过观察，我们可以确定在单元界面上的数值通量函数 $F$。在界面 $j+1/2$ （单元 $j$ 和 $j+1$ 之间）的通量由下式给出：\n$$F_{j+1/2}^{\\,n} = a\\,u_{j}^{n}$$\n这是迎风通量，对于 $a0$ 的情况，它选择来自“上游”状态的值，即左侧状态 $u_j^n$。将此确定应用于我们的差分方程：\n- 单元 $i$ 右边界（界面 $i+1/2$）的通量为 $F_{i+1/2}^{\\,n} = a\\,u_{i}^{n}$。\n- 单元 $i$ 左边界（界面 $i-1/2$）的通量为 $F_{i-1/2}^{\\,n} = a\\,u_{i-1}^{n}$。\n\n将这些代入通量差分形式可以正确地重现该格式。因此，对于 $a0$ 的一阶迎风格式，相容的数值通量为 $F_{i+1/2}^{\\,n} = a\\,u_{i}^{n}$。\n\n### 第2部分：离散质量守恒\n\n在时间 $t_n$ 的总离散质量定义为 $M^{n} = \\sum_{i} u_{i}^{n}\\,\\Delta x$，其中求和遍历周期性域中的所有网格单元。设域包含 $N$ 个单元，索引从 $i=1$ 到 $N$。\n\n从时间 $t_n$ 到 $t_{n+1}$ 的总质量变化为：\n$$M^{n+1} - M^{n} = \\sum_i u_{i}^{n+1}\\,\\Delta x - \\sum_i u_{i}^{n}\\,\\Delta x = \\Delta x \\sum_i \\left(u_{i}^{n+1} - u_{i}^{n}\\right)$$\n\n使用第1部分中推导的通量差分形式：\n$$u_{i}^{n+1} - u_{i}^{n} = -\\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n将此代入质量变化的表达式中：\n$$M^{n+1} - M^{n} = \\Delta x \\sum_{i=1}^{N} \\left[-\\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)\\right] = -\\Delta t \\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right)$$\n\n右侧的求和是一个伸缩求和：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = (F_{3/2}^{\\,n} - F_{1/2}^{\\,n}) + (F_{5/2}^{\\,n} - F_{3/2}^{\\,n}) + \\dots + (F_{N+1/2}^{\\,n} - F_{N-1/2}^{\\,n})$$\n这简化为：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = F_{N+1/2}^{\\,n} - F_{1/2}^{\\,n}$$\n\n域是周期性的，这意味着网格点 $i=0$ 等价于 $i=N$，而 $i=N+1$ 等价于 $i=1$。因此，状态 $u_0^n = u_N^n$。通量 $F_{i+1/2}^{\\,n}$ 定义为 $a\\,u_i^n$。\n因此：\n-   $F_{N+1/2}^{\\,n} = a\\,u_{N}^{n}$\n-   $F_{1/2}^{\\,n} = a\\,u_{0}^{n}$\n\n由于周期性边界条件 $u_0^n = u_N^n$，我们有 $F_{1/2}^{\\,n} = F_{N+1/2}^{\\,n}$。伸缩求和的结果为零：\n$$\\sum_{i=1}^{N} \\left(F_{i+1/2}^{\\,n} - F_{i-1/2}^{\\,n}\\right) = a\\,u_{N}^{n} - a\\,u_{0}^{n} = 0$$\n\n因此，总质量的变化为零：\n$$M^{n+1} - M^{n} = -\\Delta t \\times 0 = 0$$\n这证明了 $M^{n+1} = M^n$，并且该格式在每个时间步都守恒总质量。\n\n守恒的机制在于离散化的通量守恒形式。任何单元中量 $u$ 的变化都完全由穿过其边界的 $u$ 的净通量来解释。当在整个域上求和时，所有内部界面上的通量相互抵消。周期性边界条件确保了离开域末端边界的通量与进入其起始边界的通量相同，从而导致完美平衡和总积分量的净变化为零。\n\n### 第3部分：修正方程分析\n\n我们从离散更新方程开始：\n$$\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = 0$$\n\n为了找到修正方程，我们对 $u_i^{n+1}$ 和 $u_{i-1}^n$ 在点 $(x_i, t_n)$ 附近进行泰勒级数展开，假设 $u$ 是一个足够光滑的函数。令 $u(x_i, t_n)$ 及其导数表示为 $u, u_t, u_x, u_{tt}, u_{xx}$ 等。\n\n对 $u_i^{n+1} = u(x_i, t_n + \\Delta t)$ 的时间展开：\n$$u_i^{n+1} = u + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3)$$\n\n对 $u_{i-1}^n = u(x_i - \\Delta x, t_n)$ 的空间展开：\n$$u_{i-1}^n = u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n\n将这些展开代入离散格式中：\n$$\\frac{1}{\\Delta t}\\left( \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x}\\left( u - \\left(u - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) \\right) = 0$$\n$$\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\right) + \\frac{a}{\\Delta x}\\left( \\Delta x\\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots \\right) = 0$$\n$$u_t + \\frac{\\Delta t}{2} u_{tt} + a\\, u_x - \\frac{a\\,\\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, (\\Delta x)^2) = 0$$\n\n重新整理这些项，得到“截断微分方程”：\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\text{H.O.T.}$$\n其中 H.O.T. 代表高阶项。这个方程揭示了格式的截断误差。\n\n为了获得能更好地表示数值解行为的“修正方程”，我们必须消去高阶时间导数（如 $u_{tt}$），用空间导数来代替。我们通过对方程本身反复求导并回代来实现这一点。\n从我们方程的最低阶近似（即原始偏微分方程）可知，$u_t = -a\\,u_x + \\mathcal{O}(\\Delta x, \\Delta t)$。\n对时间求导：\n$$u_{tt} = \\frac{\\partial}{\\partial t} (-a\\,u_x + \\dots) = -a\\,u_{xt} = -a\\,\\frac{\\partial}{\\partial x}(u_t)$$\n现在再次代入 $u_t = -a\\,u_x + \\dots$：\n$$u_{tt} = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_x + \\dots) = a^2 u_{xx} + \\mathcal{O}(\\Delta x, \\Delta t)$$\n\n现在，我们将 $u_{tt}$ 的这个表达式代回到截断微分方程中：\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} \\left(a^2 u_{xx} + \\mathcal{O}(\\Delta x, \\Delta t)\\right) + \\text{H.O.T.}$$\n$$u_t + a\\, u_x = \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{a^2 \\Delta t}{2} u_{xx} + \\text{H.O.T.}$$\n\n合并具有二阶空间导数 $u_{xx}$ 的项：\n$$u_t + a\\,u_x = \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) u_{xx} + \\text{H.O.T.}$$\n\n这就是直到二阶导数项的修正方程。主导误差项具有扩散项 $D_{\\mathrm{art}}\\,u_{xx}$ 的形式。通过将我们的结果与目标形式 $u_t + a\\,u_x = D_{\\mathrm{art}}\\,u_{xx} + \\text{H.O.T.}$ 进行比较，我们确定人工扩散系数为：\n$$D_{\\mathrm{art}} = \\frac{a\\,\\Delta x}{2} - \\frac{a^2 \\Delta t}{2}$$\n这一项是一阶迎风格式中固有的数值耗散的原因。", "answer": "$$\\boxed{\\frac{a\\,\\Delta x}{2} - \\frac{a^{2}\\,\\Delta t}{2}}$$", "id": "3292605"}, {"introduction": "数值格式的特性不仅取决于其空间离散化，还取决于时间积分方法。本实践将指导您比较迎风格式的显式和隐式版本，揭示即使空间算子相同，时间步进方法的选择也会改变人工扩散的大小。此分析突出了在稳定性、精度和计算成本之间的关键权衡。[@problem_id:3292657]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a0$ 为正常数，网格为均匀网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。定义 Courant–Friedrichs–Lewy (CFL) 数为 $C = a\\,\\Delta t / \\Delta x$。考虑两种一阶迎风有限差分格式：\n\n1. 一种显式格式，时间上使用前向欧拉法，空间上使用后向（迎风）差分，表示为 $u^{n+1}_{i} = u^{n}_{i} - C\\left(u^{n}_{i} - u^{n}_{i-1}\\right)$。\n\n2. 一种隐式格式，时间上使用后向欧拉法，空间上使用后向（迎风）差分，表示为 $u^{n+1}_{i} = u^{n}_{i} - C\\left(u^{n+1}_{i} - u^{n+1}_{i-1}\\right)$。\n\n从连续平流方程出发，使用与每种格式阶数相符的泰勒级数展开，推导每种格式的修正方程，保留至包含 $u_{xx}$ 和 $u_{xxx}$ 的乘积项。根据这些修正方程，确定主导的人工耗散系数 $D_{\\text{exp}}$ 和 $D_{\\text{imp}}$（$u_{xx}$ 的系数）以及主导的色散系数 $E_{\\text{exp}}$ 和 $E_{\\text{imp}}$（$u_{xxx}$ 的系数），每个系数都用 $a$、$\\Delta x$ 和 $C$ 表示。\n\n在固定的 CFL 数 $C \\in (0,1]$ 下，计算比率 $D_{\\text{imp}}/D_{\\text{exp}}$，结果表示为关于 $C$ 的封闭形式表达式。将最终答案表示为单个无单位的解析表达式。无需四舍五入。", "solution": "基本出发点是连续平流方程 $u_{t} + a\\,u_{x} = 0$。修正方程分析的步骤是：将离散格式在时空中的一个公共点进行展开，并将离散更新重写为一个等效的连续偏微分方程，其中包含代表截断误差的附加项。这些附加项表现为人工耗散（与 $u_{xx}$ 成正比）和色散（与 $u_{xxx}$ 成正比）。\n\n我们首先回顾由平流方程所蕴含的时间导数。将 $u_{t} = -a\\,u_{x}$ 对时间求导，并利用混合偏导数的交换性，可得\n$$\nu_{tt} = \\partial_{t}(-a\\,u_{x}) = -a\\,u_{xt} = -a\\,\\partial_{x}u_{t} = -a\\,\\partial_{x}(-a\\,u_{x}) = a^{2}\\,u_{xx}.\n$$\n类似地，\n$$\nu_{ttt} = \\partial_{t}(u_{tt}) = \\partial_{t}(a^{2}\\,u_{xx}) = a^{2}\\,\\partial_{t}u_{xx} = a^{2}\\,\\partial_{x}^{2}u_{t} = a^{2}\\,\\partial_{x}^{2}(-a\\,u_{x}) = -a^{3}\\,u_{xxx}.\n$$\n\n显式迎风格式（时间上为前向欧拉法，空间上为后向差分）：\n格式为\n$$\nu^{n+1}_{i} = u^{n}_{i} - C\\left(u^{n}_{i} - u^{n}_{i-1}\\right), \\quad C = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n两边同除以 $\\Delta t$ 可写为\n$$\n\\frac{u^{n+1}_{i} - u^{n}_{i}}{\\Delta t} = -a\\,\\frac{u^{n}_{i} - u^{n}_{i-1}}{\\Delta x}.\n$$\n将左侧在点 $(x_{i},t_{n})$ 处使用前向时间泰勒级数展开：\n$$\n\\frac{u^{n+1}_{i} - u^{n}_{i}}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2}\\,u_{tt} + \\frac{\\Delta t^{2}}{6}\\,u_{ttt} + \\mathcal{O}(\\Delta t^{3}).\n$$\n将时间 $t_{n}$ 处的后向空间差分展开：\n$$\n\\frac{u^{n}_{i} - u^{n}_{i-1}}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2}\\,u_{xx} + \\frac{\\Delta x^{2}}{6}\\,u_{xxx} + \\mathcal{O}(\\Delta x^{3}).\n$$\n因此，\n$$\nu_{t} + \\frac{\\Delta t}{2}\\,u_{tt} + \\frac{\\Delta t^{2}}{6}\\,u_{ttt} = -a\\,u_{x} + \\frac{a\\,\\Delta x}{2}\\,u_{xx} - \\frac{a\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\cdots.\n$$\n代入 $u_{tt} = a^{2}\\,u_{xx}$ 和 $u_{ttt} = -a^{3}\\,u_{xxx}$：\n$$\nu_{t} + \\frac{a^{2}\\,\\Delta t}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{2}}{6}\\,u_{xxx} = -a\\,u_{x} + \\frac{a\\,\\Delta x}{2}\\,u_{xx} - \\frac{a\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\cdots.\n$$\n将 $-a\\,u_{x}$ 移到左侧，得到标准形式的修正方程 $u_{t} + a\\,u_{x} = D_{\\text{exp}}\\,u_{xx} + E_{\\text{exp}}\\,u_{xxx} + \\cdots$：\n$$\nu_{t} + a\\,u_{x} = \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^{2}\\,\\Delta t}{2}\\right)u_{xx} + \\left(-\\frac{a\\,\\Delta x^{2}}{6} + \\frac{a^{3}\\,\\Delta t^{2}}{6}\\right)u_{xxx} + \\cdots.\n$$\n使用 $a\\,\\Delta t = C\\,\\Delta x$ 将系数用 $C$ 表示：\n$$\nD_{\\text{exp}} = \\frac{a\\,\\Delta x}{2}\\,(1 - C), \\qquad E_{\\text{exp}} = \\frac{a\\,\\Delta x^{2}}{6}\\,(C^{2} - 1).\n$$\n\n隐式迎风格式（时间上为后向欧拉法，空间上为 $t^{n+1}$ 时刻的后向差分）：\n格式为\n$$\n\\frac{u^{n+1}_{i} - u^{n}_{i}}{\\Delta t} = -a\\,\\frac{u^{n+1}_{i} - u^{n+1}_{i-1}}{\\Delta x}.\n$$\n将左侧在点 $(x_{i},t_{n+1})$ 处使用后向时间泰勒级数展开：\n$$\n\\frac{u^{n+1}_{i} - u^{n}_{i}}{\\Delta t} = u_{t} - \\frac{\\Delta t}{2}\\,u_{tt} + \\frac{\\Delta t^{2}}{6}\\,u_{ttt} + \\mathcal{O}(\\Delta t^{3}).\n$$\n将时间 $t_{n+1}$ 处的后向空间差分展开：\n$$\n\\frac{u^{n+1}_{i} - u^{n+1}_{i-1}}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2}\\,u_{xx} + \\frac{\\Delta x^{2}}{6}\\,u_{xxx} + \\mathcal{O}(\\Delta x^{3}).\n$$\n于是，\n$$\nu_{t} - \\frac{\\Delta t}{2}\\,u_{tt} + \\frac{\\Delta t^{2}}{6}\\,u_{ttt} = -a\\,u_{x} + \\frac{a\\,\\Delta x}{2}\\,u_{xx} - \\frac{a\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\cdots.\n$$\n代入 $u_{tt} = a^{2}\\,u_{xx}$ 和 $u_{ttt} = -a^{3}\\,u_{xxx}$：\n$$\nu_{t} - \\frac{a^{2}\\,\\Delta t}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{2}}{6}\\,u_{xxx} = -a\\,u_{x} + \\frac{a\\,\\Delta x}{2}\\,u_{xx} - \\frac{a\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\cdots.\n$$\n将 $-a\\,u_{x}$ 移到左侧并合并同类项：\n$$\nu_{t} + a\\,u_{x} = \\left(\\frac{a\\,\\Delta x}{2} + \\frac{a^{2}\\,\\Delta t}{2}\\right)u_{xx} + \\left(-\\frac{a\\,\\Delta x^{2}}{6} + \\frac{a^{3}\\,\\Delta t^{2}}{6}\\right)u_{xxx} + \\cdots.\n$$\n再次使用 $a\\,\\Delta t = C\\,\\Delta x$ 可得\n$$\nD_{\\text{imp}} = \\frac{a\\,\\Delta x}{2}\\,(1 + C), \\qquad E_{\\text{imp}} = \\frac{a\\,\\Delta x^{2}}{6}\\,(C^{2} - 1).\n$$\n\n在固定 $C$ 下的比较：\n- 人工耗散：$D_{\\text{exp}} = (a\\,\\Delta x/2)(1 - C)$ 和 $D_{\\text{imp}} = (a\\,\\Delta x/2)(1 + C)$。对于 $C \\in (0,1]$，$D_{\\text{imp}}  D_{\\text{exp}}$，这反映出隐式迎风格式对高频分量有更强的阻尼作用。\n- 色散项：$E_{\\text{exp}} = E_{\\text{imp}} = (a\\,\\Delta x^{2}/6)(C^{2} - 1)$，因此在给定的 $C$ 值下，两种格式具有相同符号和量级的主阶色散误差。\n\n所求的比率为\n$$\n\\frac{D_{\\text{imp}}}{D_{\\text{exp}}} = \\frac{(a\\,\\Delta x/2)(1 + C)}{(a\\,\\Delta x/2)(1 - C)} = \\frac{1 + C}{1 - C}.\n$$\n\n在固定 $C$ 下的精度与耗散权衡：\n两种格式在时间和空间上都是一阶精确的。在固定的 $C$ 下，隐式迎风格式引入的人工耗散是显式格式的 $(1 + C)/(1 - C)$ 倍，这可以提高鲁棒性和单调性，但代价是更强的振幅衰减和可能导致陡峭梯度的模糊化。由于主导色散系数相同，相位误差的差异由高阶项主导；在固定的 $C$ 下，主要权衡在于稳定性鲁棒性（隐式）和减少的数值耗散（显式）之间。", "answer": "$$\\boxed{\\frac{1 + C}{1 - C}}$$", "id": "3292657"}, {"introduction": "迎风格式只是构建数值通量的众多方法之一。本练习将其与经典的Lax-Friedrichs格式进行对比，后者使用对称的模板。通过推导和比较它们各自的数值扩散系数，您将深入了解不同的设计理念及其在精度和通用性之间的权衡。[@problem_id:3318493]", "problem": "考虑一个关于被动标量的一维线性平流方程，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n其中平流速度 $a0$ 为常数。该区域通过均匀网格进行离散，空间步长为 $\\Delta x$，显式时间步长为 $\\Delta t$。一个守恒的有限体积更新具有以下形式\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right),\n$$\n其中 $F_{i\\pm\\frac{1}{2}}^{n}$ 是单元界面处的数值通量。考虑两种通量选择：\n- 一阶迎风通量：对于 $a0$，$F_{i+\\frac{1}{2}}^{n} = a\\,u_{i}^{n}$ 且 $F_{i-\\frac{1}{2}}^{n} = a\\,u_{i-1}^{n}$。\n- 原始Lax–Friedrichs通量：\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\big(a\\,u_{i}^{n} + a\\,u_{i+1}^{n}\\big) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\big(u_{i+1}^{n} - u_{i}^{n}\\big),\n$$\n对于 $F_{i-\\frac{1}{2}}^{n}$，通过平移索引可得到类似形式。\n\n使用关于点 $(x_{i},t_{n})$ 的泰勒级数修正方程分析，并在右侧保留至二阶空间导数项，通过将离散更新与以下形式的等效连续方程进行匹配，来为每个格式定义其主阶数值扩散系数 $\\nu$：\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{更高阶项}.\n$$\n令Courant–Friedrichs–Lewy (CFL) 数为 $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$。推导两种格式的主阶数值扩散系数，然后计算比值\n$$\nR(C) = \\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{up}}},\n$$\n，作为仅含 $C$ 的闭式表达式。以仅含 $C$ 的单个解析表达式的形式给出你的最终答案。在你的推导过程中，解释这两种通量所隐含的精度和鲁棒性之间的权衡。最终表达式无需四舍五入，也不应包含单位。", "solution": "目标是推导应用于线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中平流速度 $a  0$）的一阶迎风格式和Lax-Friedrichs格式的主阶数值扩散系数。这是通过修正方程分析来完成的，该分析涉及将离散的有限体积更新展开为泰勒级数，以恢复该格式有效求解的连续偏微分方程。然后，我们将计算这些系数的比值。\n\n有限体积更新由下式给出：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\right)\n$$\n其中 $u_{i}^{n}$ 近似解 $u(x_i, t_n)$，$\\Delta x$ 是空间步长，$\\Delta t$ 是时间步长，而 $F$ 是数值通量。Courant–Friedrichs–Lewy (CFL) 数定义为 $C = \\frac{a\\,\\Delta t}{\\Delta x}$。\n\n首先，我们分析一阶迎风格式。对于 $a  0$，迎风方向来自左侧，因此通量基于界面左侧单元的平均值。\n通量由 $F_{i+\\frac{1}{2}}^{n} = a\\,u_{i}^{n}$ 和 $F_{i-\\frac{1}{2}}^{n} = a\\,u_{i-1}^{n}$ 给出。\n将这些代入有限体积更新公式，得到：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(a\\,u_{i}^{n} - a\\,u_{i-1}^{n}\\right)\n$$\n使用CFL数 $C$ 的定义，上式可简化为：\n$$\nu_{i}^{n+1} = u_{i}^{n} - C\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\n为了进行修正方程分析，我们将每一项在点 $(x_{i}, t_{n})$ 附近展开为泰勒级数：\n$$\nu_{i}^{n+1} = u(x_i, t_n + \\Delta t) = u + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu_{i-1}^{n} = u(x_i - \\Delta x, t_n) = u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^4)\n$$\n这里，$u$ 及其偏导数 $u_t, u_x, u_{tt}, \\dots$ 均在点 $(x_{i}, t_{n})$ 处取值。\n将这些展开式代入离散格式：\n$$\nu + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = u - C\\left(u - \\left(u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\dots\\right)\\right)\n$$\n$$\n\\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = -C\\left(\\Delta x\\,u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\\right)\n$$\n两边同除以 $\\Delta t$ 并代入 $C/\\Delta t = (a\\,\\Delta t/\\Delta x)/\\Delta t = a/\\Delta x$：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -\\frac{a}{\\Delta x}\\left(\\Delta x\\,u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\\right)\n$$\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -a\\,u_x + \\frac{a\\,\\Delta x}{2}u_{xx} - \\dots\n$$\n重新整理以匹配目标形式 $u_t + a\\,u_x = \\nu\\,u_{xx} + \\dots$：\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{a\\,\\Delta x}{2}u_{xx} + \\dots\n$$\n为了消去时间导数 $u_{tt}$，我们对修正方程的最低阶近似 $u_t \\approx -a\\,u_x$ 进行微分。这得到 $u_{tt} \\approx -a(u_x)_t = -a(u_t)_x \\approx -a(-a\\,u_x)_x = a^2\\,u_{xx}$。\n将此关系代回方程中：\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}(a^2\\,u_{xx}) + \\frac{a\\,\\Delta x}{2}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^2\\,\\Delta t}{2}\\right)u_{xx} + \\dots\n$$\n提出公因式 $\\frac{a\\,\\Delta x}{2}$：\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a\\,\\Delta t}{\\Delta x}\\right)u_{xx} + \\dots = \\frac{a\\,\\Delta x}{2}(1 - C)u_{xx} + \\dots\n$$\n通过与 $u_t + a\\,u_x = \\nu_{\\mathrm{up}}\\,u_{xx} + \\dots$ 进行比较，我们确定迎风格式的数值扩散系数为：\n$$\n\\nu_{\\mathrm{up}} = \\frac{a\\,\\Delta x}{2}(1-C)\n$$\n\n接下来，我们分析Lax–Friedrichs (LF) 格式。其通量由下式给出：\n$$\nF_{i+\\frac{1}{2}}^{n} = \\frac{1}{2}\\left(a\\,u_{i}^{n} + a\\,u_{i+1}^{n}\\right) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\left(u_{i+1}^{n} - u_{i}^{n}\\right)\n$$\n左侧界面 $F_{i-\\frac{1}{2}}^{n}$ 处的通量通过平移索引得到：\n$$\nF_{i-\\frac{1}{2}}^{n} = \\frac{1}{2}\\left(a\\,u_{i-1}^{n} + a\\,u_{i}^{n}\\right) - \\frac{1}{2}\\frac{\\Delta x}{\\Delta t}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n$$\n通量差为：\n$$\nF_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n} = \\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\Delta x}{2\\,\\Delta t}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\n$$\n将此代入有限体积更新：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left[\\frac{a}{2}(u_{i+1}^{n} - u_{i-1}^{n}) - \\frac{\\Delta x}{2\\,\\Delta t}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\\right]\n$$\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}(u_{i+1}^{n} - u_{i-1}^{n}) + \\frac{1}{2}(u_{i+1}^{n} - 2u_i^n + u_{i-1}^{n})\n$$\n这可以被重新整理为Lax-Friedrichs格式的标准形式：\n$$\nu_{i}^{n+1} = \\frac{1}{2}(u_{i+1}^{n} + u_{i-1}^{n}) - \\frac{C}{2}(u_{i+1}^{n} - u_{i-1}^{n})\n$$\n我们现在将各项在点 $(x_i, t_n)$ 附近展开为泰勒级数：\n$$\nu_{i \\pm 1}^{n} = u \\pm \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} \\pm \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^4)\n$$\n这给出了以下组合：\n$$\n\\frac{1}{2}(u_{i+1}^{n} + u_{i-1}^{n}) = u + \\frac{(\\Delta x)^2}{2}u_{xx} + O((\\Delta x)^4)\n$$\n$$\n\\frac{1}{2}(u_{i+1}^{n} - u_{i-1}^{n}) = \\Delta x\\,u_x + \\frac{(\\Delta x)^3}{6}u_{xxx} + O((\\Delta x)^5)\n$$\n将这些代入格式中：\n$$\nu + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = \\left(u + \\frac{(\\Delta x)^2}{2}u_{xx}\\right) - C\\left(\\Delta x\\,u_x + \\frac{(\\Delta x)^3}{6}u_{xxx}\\right) + \\dots\n$$\n$$\n\\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = -C\\,\\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\n$$\n使用 $C\\,\\Delta x = (a\\,\\Delta t/\\Delta x)\\,\\Delta x = a\\,\\Delta t$ 并两边同除以 $\\Delta t$：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -a\\,u_x + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n再次代入 $u_{tt} \\approx a^2\\,u_{xx}$：\n$$\nu_t + a\\,u_x = -\\frac{a^2\\,\\Delta t}{2}u_{xx} + \\frac{(\\Delta x)^2}{2\\,\\Delta t}u_{xx} + \\dots\n$$\n$$\nu_t + a\\,u_x = \\left(\\frac{(\\Delta x)^2}{2\\,\\Delta t} - \\frac{a^2\\,\\Delta t}{2}\\right)u_{xx} + \\dots\n$$\n提出公因式 $\\frac{a\\,\\Delta x}{2}$：\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}\\left(\\frac{\\Delta x}{a\\,\\Delta t} - \\frac{a\\,\\Delta t}{\\Delta x}\\right)u_{xx} + \\dots = \\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)u_{xx} + \\dots\n$$\n因此，Lax-Friedrichs格式的数值扩散系数为：\n$$\n\\nu_{\\mathrm{LF}} = \\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)\n$$\n\n最后，我们计算比值 $R(C) = \\nu_{\\mathrm{LF}} / \\nu_{\\mathrm{up}}$：\n$$\nR(C) = \\frac{\\frac{a\\,\\Delta x}{2}\\left(\\frac{1}{C} - C\\right)}{\\frac{a\\,\\Delta x}{2}(1-C)} = \\frac{\\frac{1-C^2}{C}}{1-C}\n$$\n对分子进行因式分解，$1 - C^2 = (1 - C)(1 + C)$。对于 $C \\neq 1$，我们可以简化为：\n$$\nR(C) = \\frac{(1-C)(1+C)}{C(1-C)} = \\frac{1+C}{C}\n$$\n这个比值揭示了这两种格式的行为特性。\n两种格式的稳定性条件都要求 $0  C \\le 1$。在此范围内，$R(C) = \\frac{1}{C} + 1 \\ge 2$。这表明Lax-Friedrichs格式的数值扩散性总是一阶迎风格式的至少两倍。对于实际的CFL数（例如，$C$ 约为 $0.5$），$\\nu_{\\mathrm{LF}}$ 显著大于 $\\nu_{\\mathrm{up}}$。\n\n这种差异凸显了一个基本的权衡。一阶迎风格式在引入较少数值扩散方面更为精确，从而能更好地保持陡峭的梯度。然而，它的构建依赖于知道波的传播方向（即 $a$ 的符号）。Lax-Friedrichs格式更“鲁棒”或更通用，因为它的公式是对称的，并且不需要关于波传播特性的信息。这使得它更容易应用于复杂的方程组或多维问题，在这些问题中确定迎风方向并非易事。这种通用性和简单性是以显著更高的数值扩散为代价的，这往往会过度地模糊解。", "answer": "$$\n\\boxed{\\frac{1+C}{C}}\n$$", "id": "3318493"}]}