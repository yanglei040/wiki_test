{"hands_on_practices": [{"introduction": "理论是必不可少的，但真正的理解始于实践。本练习将指导您手动执行拉克斯-弗里德里希斯格式的一个完整时间步更新，以此来开启我们的动手实践之旅。我们将针对经典的无粘性伯格斯方程，通过计算一个网格单元的值，来深入理解有限体积法中数值通量的具体作用，特别是中心平均项和数值耗散项是如何协同工作的。这个基础计算是掌握更复杂数值方法的第一步。[@problem_id:3413890]", "problem": "考虑标量守恒律 $u_t + \\partial_x f(u) = 0$，其通量为 $f(u) = \\frac{u^2}{2}$（无粘性伯格斯方程），定义在一个空间步长为 $\\Delta x$、显式时间步长为 $\\Delta t$ 的一维均匀网格上。从控制体上的守恒积分形式和基于一致界面数值通量的有限体积更新出发，通过强制与 $f(u)$ 的一致性并添加一个由特征速度界限缩放的线性耗散项，推导标量守恒律的一阶 Lax–Friedrichs 中心格式数值通量。使用特征速度界限 $\\alpha_{i+1/2}$，其值等于界面两侧局部特征速度绝对值的最大值，其中无粘性伯格斯方程的特征速度为 $f'(u) = u$；即，取 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$。\n\n给定时间层 $n=0$ 时三个相邻单元的离散初始廓线：$u_4^0 = 1.2$，$u_5^0 = 0.4$ 和 $u_6^0 = -0.8$，以及 $\\Delta x = 0.1$ 和 $\\Delta t = 0.05$。使用基于推导出的 Lax–Friedrichs 中心格式数值通量的有限体积显式更新，计算一个时间步后更新的值 $u_5^1$。将最终答案表示为单个实数。无需四舍五入。", "solution": "用户需要解决一个涉及无粘性伯格斯方程的 Lax-Friedrichs 格式的数值问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   标量守恒律：$u_t + \\partial_x f(u) = 0$。\n-   通量函数：$f(u) = \\frac{u^2}{2}$（无粘性伯格斯方程）。\n-   具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的一维均匀网格。\n-   任务 1：推导一阶 Lax-Friedrichs 中心格式数值通量。\n    -   从守恒的积分形式开始。\n    -   使用基于一致界面数值通量的有限体积更新。\n    -   添加一个由特征速度界限缩放的线性耗散项。\n    -   无粘性伯格斯方程的特征速度为 $f'(u) = u$。\n    -   界面 $i+1/2$ 处的特征速度界限由 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$ 给出。\n-   任务 2：计算更新值 $u_5^1$。\n-   给定 $n=0$ 时的离散初始廓线：$u_4^0 = 1.2$，$u_5^0 = 0.4$ 和 $u_6^0 = -0.8$。\n-   给定常数：$\\Delta x = 0.1$ 和 $\\Delta t = 0.05$。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题描述了有限体积法（特别是局部 Lax-Friedrichs 格式或 Rusanov 格式）在典型的双曲守恒律（无粘性伯格斯方程）上的标准应用。所有概念都是数值偏微分方程领域的基础。该问题在科学上是合理的。\n-   **适定性：** 所有必要的数据（$u_i^0$ 值，$\\Delta x$，$\\Delta t$）、通量函数和数值格式的具体定义都已提供。问题要求计算单个值 $u_5^1$，该值由所提供的信息唯一确定。\n-   **客观性：** 问题使用精确、无歧义的数学语言陈述。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它具有科学依据、适定性、客观性和完整性。我将继续进行求解。\n\n### 推导与求解\n\n该问题分为两部分：首先，推导 Lax-Friedrichs 数值通量；其次，用它来计算一个时间步后的单元值。\n\n**第一部分：Lax–Friedrichs 格式的推导**\n\n我们从标量守恒律 $u_t + \\partial_x f(u) = 0$ 在控制体 $C_i = [x_{i-1/2}, x_{i+1/2}]$ 上，从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的积分形式开始。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^{n+1}) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx + \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt = 0 $$\n我们将时间 $t^n$ 时单元 $C_i$ 上 $u$ 的单元平均值定义为 $u_i^n = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx$，其中 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。将积分方程除以 $\\Delta x$ 并使用单元平均值的定义，我们得到：\n$$ u_i^{n+1} - u_i^n + \\frac{1}{\\Delta x} \\left( \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt \\right) = 0 $$\n我们引入一个数值通量函数 $F_{i+1/2}$，它近似了单元界面 $x_{i+1/2}$ 处的时间平均通量：\n$$ F_{i+1/2} \\approx \\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt $$\n将此代入单元平均值的方程中，得到通用的有限体积更新格式：\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nLax–Friedrichs 格式基于对通量项的中心近似，并添加了人工粘性或耗散项以确保稳定性。在单元 $i$（左状态 $u_L = u_i^n$）和单元 $i+1$（右状态 $u_R = u_{i+1}^n$）之间的界面上的数值通量 $F_{i+1/2}$ 由下式给出：\n$$ F_{i+1/2} = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)] - \\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n] $$\n此处，项 $\\frac{1}{2} [f(u_i^n) + f(u_{i+1}^n)]$ 是两个相邻单元通量的简单中心平均。第二项 $-\\frac{1}{2} \\alpha_{i+1/2} [u_{i+1}^n - u_i^n]$ 是数值耗散。系数 $\\alpha_{i+1/2}$ 必须是界面处传播特征速度的一个界限。\n问题指定了无粘性伯格斯方程的通量 $f(u) = \\frac{u^2}{2}$，其特征速度为 $f'(u) = u$。问题进一步指定局部耗散系数为 $\\alpha_{i+1/2} = \\max(|u_i^n|, |u_{i+1}^n|)$。这是一个常见的选择，它导出了局部 Lax-Friedrichs 格式，也称为 Rusanov 格式。\n\n**第二部分：$u_5^1$ 的计算**\n\n我们需要使用有限体积更新公式计算 $u_5^1$ 的值：\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n已知条件为：$u_4^0 = 1.2$，$u_5^0 = 0.4$，$u_6^0 = -0.8$，$\\Delta x = 0.1$ 和 $\\Delta t = 0.05$。步长比为 $\\frac{\\Delta t}{\\Delta x} = \\frac{0.05}{0.1} = 0.5$。\n\n首先，我们计算单元 $5$ 和单元 $6$ 之间界面上的数值通量 $F_{5+1/2}$。\n左右状态为 $u_L = u_5^0 = 0.4$ 和 $u_R = u_6^0 = -0.8$。\n物理通量为 $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$ 和 $f(u_6^0) = \\frac{(-0.8)^2}{2} = \\frac{0.64}{2} = 0.32$。\n耗散系数为 $\\alpha_{5+1/2} = \\max(|u_5^0|, |u_6^0|) = \\max(|0.4|, |-0.8|) = \\max(0.4, 0.8) = 0.8$。\n现在我们计算通量 $F_{5+1/2}$：\n$$ F_{5+1/2} = \\frac{1}{2} [f(u_5^0) + f(u_6^0)] - \\frac{1}{2} \\alpha_{5+1/2} [u_6^0 - u_5^0] $$\n$$ F_{5+1/2} = \\frac{1}{2} [0.08 + 0.32] - \\frac{1}{2} (0.8) [-0.8 - 0.4] $$\n$$ F_{5+1/2} = \\frac{1}{2} (0.40) - 0.4 (-1.2) $$\n$$ F_{5+1/2} = 0.20 + 0.48 = 0.68 $$\n\n接下来，我们计算单元 $4$ 和单元 $5$ 之间界面上的数值通量 $F_{4+1/2}$。\n左右状态为 $u_L = u_4^0 = 1.2$ 和 $u_R = u_5^0 = 0.4$。\n物理通量为 $f(u_4^0) = \\frac{(1.2)^2}{2} = \\frac{1.44}{2} = 0.72$ 和 $f(u_5^0) = \\frac{(0.4)^2}{2} = \\frac{0.16}{2} = 0.08$。\n耗散系数为 $\\alpha_{4+1/2} = \\max(|u_4^0|, |u_5^0|) = \\max(|1.2|, |0.4|) = \\max(1.2, 0.4) = 1.2$。\n现在我们计算通量 $F_{4+1/2}$：\n$$ F_{4+1/2} = \\frac{1}{2} [f(u_4^0) + f(u_5^0)] - \\frac{1}{2} \\alpha_{4+1/2} [u_5^0 - u_4^0] $$\n$$ F_{4+1/2} = \\frac{1}{2} [0.72 + 0.08] - \\frac{1}{2} (1.2) [0.4 - 1.2] $$\n$$ F_{4+1/2} = \\frac{1}{2} (0.80) - 0.6 (-0.8) $$\n$$ F_{4+1/2} = 0.40 + 0.48 = 0.88 $$\n\n最后，我们使用计算出的通量更新 $u_5^1$ 的值：\n$$ u_5^1 = u_5^0 - \\frac{\\Delta t}{\\Delta x} (F_{5+1/2} - F_{4+1/2}) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (0.68 - 0.88) $$\n$$ u_5^1 = 0.4 - 0.5 \\times (-0.20) $$\n$$ u_5^1 = 0.4 + 0.1 $$\n$$ u_5^1 = 0.5 $$\n一个时间步后，单元 $5$ 的更新值为 $0.5$。", "answer": "$$ \\boxed{0.5} $$", "id": "3413890"}, {"introduction": "在应用一个数值格式时，我们不仅要关心计算结果，更要理解其内在的数学性质。冯·诺伊曼稳定性分析是一种强大的工具，它使我们能够量化一个格式如何处理不同尺度的波。本练习将引导您通过傅里叶分析，推导线性平流方程下Lax-Friedrichs格式的放大因子$G(\\theta)$，并计算其幅度和相位。通过这个过程，您将揭示该格式的数值耗散和色散误差的来源，从而深刻理解其稳定性和精度的本质。[@problem_id:3375332]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，该方程在具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上进行离散化。Lax–Friedrichs 格式通过以下方式更新网格函数 $u_{j}^{n}$：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\n令 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$，并考虑离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$，其中 $\\theta \\in \\mathbb{R}$ 是无量纲波数。定义单步放大因子 $G(\\theta)$ 为 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$。\n\n从该格式的定义出发，使用傅里叶模拟设，推导 $G(\\theta)$ 的表达式，并计算其模 $\\lvert G(\\theta)\\rvert$ 和辐角 $\\arg(G(\\theta))$（在 $(-\\pi,\\pi]$ 内的主值），作为 $\\theta$ 和 $\\nu$ 的闭式解析函数。你的最终答案必须以两个表达式给出：一个用于 $\\lvert G(\\theta)\\rvert$，另一个用于 $\\arg(G(\\theta))$。如果你使用一个依赖于分支的辐角公式，则必须明确写出，以确保其值位于 $(-\\pi,\\pi]$ 区间内。将你的最终答案表示为符号表达式，不要包含任何单位。", "solution": "该问题要求推导应用于一维线性平流方程的 Lax–Friedrichs 格式的放大因子 $G(\\theta)$、其模 $|G(\\theta)|$ 以及其辐角 $\\arg(G(\\theta))$。\n\n线性平流方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $a > 0$ 是一个常数。\n\nLax–Friedrichs 格式为：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n令 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$。该格式可以写成：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n\n我们通过将离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$ 代入该格式来进行 von Neumann 稳定性分析。格式中的各项变为：\n- $u_{j}^{n+1} = \\hat{u}^{n+1}\\exp(i j \\theta)$\n- $u_{j+1}^{n} = \\hat{u}^{n}\\exp(i (j+1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta)$\n- $u_{j-1}^{n} = \\hat{u}^{n}\\exp(i (j-1) \\theta) = \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)$\n\n将这些代入格式方程中：\n$$\n\\hat{u}^{n+1}\\exp(i j \\theta) = \\frac{1}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) + \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\hat{u}^{n}\\exp(i j \\theta)\\exp(i \\theta) - \\hat{u}^{n}\\exp(i j \\theta)\\exp(-i \\theta)\\right)\n$$\n公共因子 $\\exp(i j \\theta)$ 可以从每一项中消去：\n$$\n\\hat{u}^{n+1} = \\frac{\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu\\hat{u}^{n}}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n根据定义，放大因子 $G(\\theta)$ 满足 $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^{n}$。两边同除以 $\\hat{u}^{n}$（假设 $\\hat{u}^{n} \\neq 0$）：\n$$\nG(\\theta) = \\frac{1}{2}\\left(\\exp(i \\theta) + \\exp(-i \\theta)\\right) - \\frac{\\nu}{2}\\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$ 和 $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$，我们可以简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = \\cos(\\theta) - \\frac{\\nu}{2}(2i\\sin(\\theta))\n$$\n$$\nG(\\theta) = \\cos(\\theta) - i\\nu\\sin(\\theta)\n$$\n\n接下来，我们计算模 $|G(\\theta)|$。对于复数 $z = x+iy$，其模为 $|z| = \\sqrt{x^2 + y^2}$。此处，实部为 $\\mathrm{Re}(G(\\theta)) = \\cos(\\theta)$，虚部为 $\\mathrm{Im}(G(\\theta)) = -\\nu\\sin(\\theta)$。\n$$\n|G(\\theta)| = \\sqrt{(\\cos(\\theta))^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)}\n$$\n这个表达式是正确的，但可以使用余弦的倍角公式写成更紧凑的形式。使用 $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ 和 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$：\n$$\n|G(\\theta)|^2 = \\frac{1+\\cos(2\\theta)}{2} + \\nu^2\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) = \\frac{1}{2}(1 + \\cos(2\\theta) + \\nu^2 - \\nu^2\\cos(2\\theta))\n$$\n$$\n|G(\\theta)|^2 = \\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)\n$$\n因此，模为：\n$$\n|G(\\theta)| = \\sqrt{\\frac{1+\\nu^2}{2} + \\frac{1-\\nu^2}{2}\\cos(2\\theta)}\n$$\n为使格式稳定，我们需要对所有 $\\theta$ 都有 $|G(\\theta)| \\le 1$。这导出了 CFL 条件 $|\\nu| \\le 1$。\n\n最后，我们计算 $G(\\theta)$ 的辐角（或相位），记作 $\\arg(G(\\theta))$。问题要求的是位于区间 $(-\\pi, \\pi]$ 内的主值。令 $\\phi(\\theta) = \\arg(G(\\theta))$。辐角由实部和虚部的符号决定。\n- 实部：$X = \\cos(\\theta)$\n- 虚部：$Y = -\\nu\\sin(\\theta)$\n辐角由 `atan2` 函数给出，$\\phi(\\theta) = \\mathrm{atan2}(Y, X) = \\mathrm{atan2}(-\\nu\\sin(\\theta), \\cos(\\theta))$。问题要求将其写成一个显式公式。我们在 $\\theta$ 的一个周期内，例如 $\\theta \\in (-\\pi, \\pi]$，分段构造这个公式。\n1.  如果 $X > 0$，即 $\\cos(\\theta) > 0$，对于 $\\theta \\in (-\\pi, \\pi]$ 意味着 $\\theta \\in (-\\pi/2, \\pi/2)$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) = \\arctan(-\\nu\\tan(\\theta))$。\n2.  如果 $X < 0$，即 $\\cos(\\theta) < 0$，对于 $\\theta \\in (-\\pi, \\pi]$ 意味着 $\\theta \\in (\\pi/2, \\pi] \\cup (-\\pi, -\\pi/2)$。\n    - 如果 $Y \\ge 0$，即 $-\\nu\\sin(\\theta) \\ge 0$，由于 $\\nu > 0$ 这意味着 $\\sin(\\theta) \\le 0$。这对应于 $\\theta \\in (-\\pi, -\\pi/2)$ 或 $\\theta=\\pi$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) + \\pi = \\arctan(-\\nu\\tan(\\theta)) + \\pi$。在 $\\theta = \\pi$ 时，$Y=0$ 且 $X=-1$，所以 $\\phi(\\pi) = \\pi$。\n    - 如果 $Y < 0$，即 $-\\nu\\sin(\\theta) < 0$，这意味着 $\\sin(\\theta) > 0$。这对应于 $\\theta \\in (\\pi/2, \\pi)$。辐角为 $\\phi(\\theta) = \\arctan(Y/X) - \\pi = \\arctan(-\\nu\\tan(\\theta)) - \\pi$。\n3.  如果 $X = 0$，即 $\\cos(\\theta) = 0$，对于 $\\theta \\in (-\\pi, \\pi]$ 意味着 $\\theta = \\pm \\pi/2$。\n    - 如果 $\\theta = \\pi/2$，那么 $Y = -\\nu\\sin(\\pi/2) = -\\nu < 0$。辐角为 $\\phi(\\pi/2) = -\\pi/2$。\n    - 如果 $\\theta = -\\pi/2$，那么 $Y = -\\nu\\sin(-\\pi/2) = \\nu > 0$。辐角为 $\\phi(-\\pi/2) = \\pi/2$。\n\n综合这些情况，可以得到 $\\arg(G(\\theta))$ 在 $\\theta \\in (-\\pi, \\pi]$ 上的显式分段公式：\n$$\n\\arg(G(\\theta)) = \\begin{cases}\n \\arctan(-\\nu\\tan\\theta) + \\pi  &\\text{若 } \\theta \\in (-\\pi, -\\pi/2) \\\\\n \\pi/2  &\\text{若 } \\theta = -\\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta)  &\\text{若 } \\theta \\in (-\\pi/2, \\pi/2) \\\\\n -\\pi/2  &\\text{若 } \\theta = \\pi/2 \\\\\n \\arctan(-\\nu\\tan\\theta) - \\pi  &\\text{若 } \\theta \\in (\\pi/2, \\pi) \\\\\n \\pi  &\\text{若 } \\theta = \\pi\n\\end{cases}\n$$\n这个函数正确地给出了区间 $(-\\pi, \\pi]$ 内的主辐角。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n|G(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\nu^2\\sin^2(\\theta)} & \\arg(G(\\theta)) = \\begin{cases} \\arctan(-\\nu\\tan\\theta) + \\pi & \\text{对于 } \\cos\\theta < 0, \\sin\\theta < 0 \\\\ \\pi/2 & \\text{对于 } \\cos\\theta = 0, \\sin\\theta = -1 \\\\ \\arctan(-\\nu\\tan\\theta) & \\text{对于 } \\cos\\theta > 0 \\\\ -\\pi/2 & \\text{对于 } \\cos\\theta = 0, \\sin\\theta = 1 \\\\ \\arctan(-\\nu\\tan\\theta) - \\pi & \\text{对于 } \\cos\\theta < 0, \\sin\\theta > 0 \\\\ \\pi & \\text{对于 } \\cos\\theta = -1, \\sin\\theta = 0 \\end{cases} \\end{pmatrix}\n}\n$$", "id": "3375332"}, {"introduction": "标准的Lax-Friedrichs格式虽然稳健，但其固有的数值耗散常常会过度模糊解的细节，尤其是在平滑区域。为了克服这一缺点，我们可以设计一种“智能”的自适应数值粘性，使其能够根据局部流场特征进行调整。本练习将指导您构建并实现一种基于特征速度的局部利普希茨常数的自适应粘性项。您不仅需要从理论上证明这种新构造的格式在$\\lambda \\ge 1$时依然保持稳定性，还将通过数值实验直观地看到它如何在保持激波清晰的同时，显著减少光滑区域的耗散。[@problem_id:3375314]", "problem": "考虑标量守恒律 $u_t + (f(u))_x = 0$，其通量 $f \\in C^2(\\mathbb{R})$ 为充分光滑的凸函数，该方程构建于一维周期性区域 $x \\in [0,1]$ 上。设 $f(u) = \\tfrac{1}{2} u^2$（无粘伯格斯方程），因此 $f'(u) = u$。我们使用一个包含 $N$ 个点的均匀网格对空间进行离散化，网格间距为 $\\Delta x = \\tfrac{1}{N}$，并采用周期性索引。定义显式有限体积更新格式\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\n其中数值通量为局部 Lax–Friedrichs (Rusanov) 通量\n$$\nF_{i+\\tfrac{1}{2}}^n = \\frac{1}{2} \\left( f(u_i^n) + f(u_{i+1}^n) \\right) - \\frac{1}{2} \\alpha_{i+\\tfrac{1}{2}}^n \\left( u_{i+1}^n - u_i^n \\right).\n$$\n你需要通过以下方式，基于局部流场特征构造一个时空自适应的数值粘性 $\\alpha(x,t)$：\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda\\, \\mathrm{Lip}_x\\!\\left( f'(u(\\cdot,t^n)) \\right)\\Big|_{[x_i,x_{i+1}]},\n$$\n其中 $\\lambda > 0$ 是一个可调参数，$\\mathrm{Lip}_x(\\cdot)\\big|_{[x_i,x_{i+1}]}$ 表示在局部空间区间 $[x_i,x_{i+1}]$ 上对 $f'(u(x,t))$ 的 Lipschitz 常数的一个一致离散估计。在以下针对无粘伯格斯通量的具体且可实现的近似下进行：\n$$\n\\mathrm{Lip}_x\\!\\left( f'(u(\\cdot,t^n)) \\right)\\Big|_{[x_i,x_{i+1}]} \\approx \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x}.\n$$\n对于 $f'(u) = u$，这简化为\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|u_i^n\\right|, \\left|u_{i+1}^n\\right| \\right) + \\frac{1}{2} \\left|u_{i+1}^n - u_i^n\\right| \\right).\n$$\n从标量守恒律、单调数值通量和 Lax–Friedrichs 格式的定义出发，完成以下任务：\n\n- 推导局部 Lax–Friedrichs 格式的充分单调性和稳定性条件，该条件将 $\\alpha_{i+\\tfrac{1}{2}}^n$ 与守恒律的特征速度界联系起来。解释为什么条件 $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} \\left| f'(\\xi) \\right|$ 能产生一个在 $\\ell^1$ 范数下非线性稳定的单调格式，并说明显式 Courant–Friedrichs–Lewy (CFL) 时间步长限制 $\\Delta t \\le \\mathrm{CFL} \\, \\Delta x / \\max_{i} \\alpha_{i+\\tfrac{1}{2}}^n$（其中 $0 < \\mathrm{CFL} < 1$）是如何产生的。\n\n- 使用上述离散 Lipschitz 构造，证明对于 $\\lambda \\ge 1$，选择\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\cdot \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x} \\right)\n$$\n满足单调性界 $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} \\left| f'(\\xi) \\right|$，因此能得到一个稳定的格式。论证 $\\lambda = 1$ 在界面层级上，在满足稳定性的前提下，最小化了数值耗散，而更大的 $\\lambda$ 会增加耗散。\n\n- 对 $\\lambda$ 的作用进行敏感性分析，对比光滑区域（$f'(u)$ 的空间变化小）与激波区域（$f'(u)$ 的空间变化大）的情况，量化说明附加项 $\\tfrac{\\Delta x}{2} \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| / \\Delta x$ 如何在强梯度附近增大 $\\alpha_{i+\\tfrac{1}{2}}^n$ 并在光滑区域几乎不改变它。\n\n实现该格式并根据下面的测试套件生成数值证据。使用周期性边界条件。在每一步，时间步长 $\\Delta t$ 应根据 CFL 条件自适应选择，其中 $\\mathrm{CFL} = 0.9$。\n\n测试套件的初始数据和参数：\n\n- 光滑情况：$u(x,0) = \\tfrac{1}{2} + \\tfrac{1}{2} \\sin(2\\pi x)$，最终时间 $T = 0.1$，网格点数 $N = 256$，参数值 $\\lambda \\in \\{ 0.8, 1.0, 2.0 \\}$。\n\n- 激波情况：$u(x,0) = 1$ 对于 $x < 0.5$，$u(x,0) = 0$ 对于 $x \\ge 0.5$，最终时间 $T = 0.05$，网格点数 $N = 256$，参数值 $\\lambda \\in \\{ 0.8, 1.0, 2.0 \\}$。\n\n对于每次运行，计算以下定量诊断指标：\n\n- 总变差比率 $\\mathrm{TV}(u(\\cdot,T))/\\mathrm{TV}(u(\\cdot,0))$，其中 $\\mathrm{TV}(u) = \\sum_{i=0}^{N-1} \\left| u_{i+1} - u_i \\right|$，采用周期性索引。以浮点数形式报告。\n\n- 激波情况下最终时刻的激波厚度代理指标：$u(x_i,T) \\in [0.1,0.9]$ 的网格点整数计数。\n\n- 最大值原理违背幅值：$\\max\\!\\left( 0, \\max_i u_i(T) - \\max_i u_i(0) \\right) + \\max\\!\\left( 0, \\min_i u_i(0) - \\min_i u_i(T) \\right)$，以浮点数形式报告。\n\n您的程序应生成单行输出，包含一个逗号分隔的结果列表，用方括号括起来，顺序如下：\n$$\n\\Big[ \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}0.8), \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}1.0), \\mathrm{TV}_{\\mathrm{smooth}}(\\lambda{=}2.0), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}0.8), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}1.0), \\mathrm{Thick}_{\\mathrm{shock}}(\\lambda{=}2.0), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}0.8), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}1.0), \\mathrm{MPV}_{\\mathrm{smooth}}(\\lambda{=}2.0), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}0.8), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}1.0), \\mathrm{MPV}_{\\mathrm{shock}}(\\lambda{=}2.0) \\Big].\n$$\n输出必须是单行，包含按指定顺序排列的数字，使用上述无量纲公式导出的单位和值，不含任何附加文本。", "solution": "该问题是有效的，因为它基于双曲守恒律数值方法的理论，是适定的，并为理论分析和数值实现提供了一套完整且一致的定义和参数。\n\n该问题涉及在周期性区域 $x \\in [0,1]$ 上标量守恒律的数值解：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0.\n$$\n对于本分析，通量函数是凸二次通量 $f(u) = \\frac{1}{2}u^2$，对应于无粘伯格斯方程，其特征速度为 $f'(u) = u$。\n\n区域被离散化为 $N$ 个宽度为 $\\Delta x = 1/N$ 的均匀单元，单元中心为 $x_i = i\\Delta x$，$i=0, \\dots, N-1$。在单元 $i$ 中于时间 $t^n$ 的解表示为 $u_i^n$。有限体积法通过守恒公式更新解：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\n其中 $u_i^{n+1}$ 是时间 $t^{n+1} = t^n + \\Delta t$ 的解，$F_{i\\pm\\tfrac{1}{2}}^n$ 是单元界面处的数值通量。问题指定了局部 Lax–Friedrichs（或 Rusanov）数值通量：\n$$\nF_{i+\\tfrac{1}{2}}^n = F(u_i^n, u_{i+1}^n) = \\frac{1}{2} \\left[ f(u_i^n) + f(u_{i+1}^n) \\right] - \\frac{1}{2} \\alpha_{i+\\tfrac{1}{2}}^n \\left[ u_{i+1}^n - u_i^n \\right],\n$$\n其中 $\\alpha_{i+\\tfrac{1}{2}}^n$ 是单元 $i$ 和 $i+1$ 之间界面的数值粘性系数。\n\n### 单调性、稳定性及 CFL 条件\n\n如果更新后的解 $u_i^{n+1}$ 是其在上一时间步模板值的非减函数，即 $u_i^{n+1} = H(u_{i-1}^n, u_i^n, u_{i+1}^n)$ 且 $\\frac{\\partial H}{\\partial u_j^n} \\ge 0$ 对于 $j \\in \\{i-1, i, i+1\\}$，则称标量守恒律的数值格式是单调的。\n\n格式单调的一个充分条件是，数值通量函数 $F(u_L, u_R)$ 必须是其第一个参数 $u_L$ 的非减函数和其第二个参数 $u_R$ 的非增函数。让我们计算给定通量 $F(u_L, u_R)$ 的偏导数：\n$$\n\\frac{\\partial F}{\\partial u_L} = \\frac{1}{2} f'(u_L) + \\frac{1}{2} \\alpha.\n$$\n$$\n\\frac{\\partial F}{\\partial u_R} = \\frac{1}{2} f'(u_R) - \\frac{1}{2} \\alpha.\n$$\n条件 $\\frac{\\partial F}{\\partial u_L} \\ge 0$ 和 $\\frac{\\partial F}{\\partial u_R} \\le 0$ 分别意味着：\n$$\n\\alpha \\ge -f'(u_L) \\quad \\text{和} \\quad \\alpha \\ge f'(u_R).\n$$\n为同时满足两者，状态 $u_L$ 和 $u_R$ 之间界面的数值粘性 $\\alpha$ 必须满足 $\\alpha \\ge \\max(f'(u_R), -f'(u_L))$。为了稳定性，这必须对解中任意一对相邻状态都成立。一个更通用和鲁棒的条件，涵盖了这一点，是要求 $\\alpha$ 是从 $u_L$ 和 $u_R$ 之间的黎曼问题产生的所有可能特征速度的上界。对于凸标量通量，$\\xi \\in [u_L, u_R]$（或 $[u_R, u_L]$）的特征速度 $f'(\\xi)$ 是单调的。因此，最大绝对速度在该区间的边界上达到。因此，单调通量的充分条件是：\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n, u_{i+1}^n]} |f'(\\xi)| = \\max\\left(|f'(u_i^n)|, |f'(u_{i+1}^n)|\\right).\n$$\n这是通量单调所需的条件。现在，让我们分析整个格式的单调性。我们已经确定对于 $j=i\\pm 1$，$\\frac{\\partial H}{\\partial u_j^n} \\ge 0$。我们还必须检查 $u_i^n$ 的系数：\n$u_i^{n+1} = H(u_{i-1}^n, u_i^n, u_{i+1}^n) = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F(u_i^n, u_{i+1}^n) - F(u_{i-1}^n, u_i^n)\\right)$。\n$$\n\\frac{\\partial H}{\\partial u_i^n} = 1 - \\frac{\\Delta t}{\\Delta x}\\left(\\frac{\\partial F(u_i^n, u_{i+1}^n)}{\\partial u_i^n} - \\frac{\\partial F(u_{i-1}^n, u_i^n)}{\\partial u_i^n}\\right).\n$$\n使用我们之前计算的偏导数，其中对于第二项，$u_i^n$ 是“右”状态：\n$$\n\\frac{\\partial H}{\\partial u_i^n} = 1 - \\frac{\\Delta t}{\\Delta x}\\left[ \\left(\\frac{1}{2}f'(u_i^n) + \\frac{1}{2}\\alpha_{i+\\tfrac{1}{2}}^n\\right) - \\left(\\frac{1}{2}f'(u_i^n) - \\frac{1}{2}\\alpha_{i-\\tfrac{1}{2}}^n\\right) \\right] = 1 - \\frac{\\Delta t}{2\\Delta x}\\left(\\alpha_{i+\\tfrac{1}{2}}^n + \\alpha_{i-\\tfrac{1}{2}}^n\\right).\n$$\n条件 $\\frac{\\partial H}{\\partial u_i^n} \\ge 0$ 导致时间步长限制：\n$$\n\\Delta t \\le \\frac{2\\Delta x}{\\alpha_{i+\\tfrac{1}{2}}^n + \\alpha_{i-\\tfrac{1}{2}}^n}.\n$$\n为确保这对所有单元 $i$ 都成立，施加一个基于最大粘性的全局限制：\n$$\n\\Delta t \\le \\frac{\\Delta x}{\\max_i \\alpha_{i+\\tfrac{1}{2}}^n}.\n$$\n在实践中，会引入一个 Courant–Friedrichs–Lewy (CFL) 安全因子，$0 < \\mathrm{CFL} < 1$，从而得到显式时间步长限制 $\\Delta t \\le \\mathrm{CFL} \\, \\Delta x / \\max_{i} \\alpha_{i+\\tfrac{1}{2}}^n$。\n\n一个单调格式满足离散最大值原理，确保不会产生新的极值，这意味着在 $\\ell^\\infty$ 范数下的稳定性。对于有限区域上的守恒格式，$\\ell^\\infty$ 稳定性意味着 $\\ell^1$ 稳定性。此外，根据 Harten 定理，单调格式也是总变差递减（TVD）的。对于标量守恒律，一个一致、守恒且 TVD 的格式保证会收敛到唯一的弱熵解。因此，证明单调性是建立该格式的稳定性和收敛性质的关键。\n\n### 所提数值粘性的验证\n\n问题提出了数值粘性系数的一种具体形式：\n$$\n\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( \\max\\!\\left( \\left|f'(u_i^n)\\right|, \\left|f'(u_{i+1}^n)\\right| \\right) + \\frac{\\Delta x}{2} \\cdot \\frac{ \\left| f'(u_{i+1}^n) - f'(u_i^n) \\right| }{\\Delta x} \\right).\n$$\n我们必须证明，对于 $\\lambda \\ge 1$，这个选择满足单调性条件 $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\sup_{\\xi \\in [u_i^n,u_{i+1}^n]} | f'(\\xi) |$。\n如前所述，对于凸通量，这简化为 $\\alpha_{i+\\tfrac{1}{2}}^n \\ge \\max(|f'(u_i^n)|, |f'(u_{i+1}^n)|)$。\n令 $M_{i+\\tfrac{1}{2}} = \\max(|f'(u_i^n)|, |f'(u_{i+1}^n)|)$ 和 $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2} |f'(u_{i+1}^n) - f'(u_i^n)|$。$\\alpha$ 的表达式简化为 $\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}})$。\n我们需要证明 $\\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) \\ge M_{i+\\tfrac{1}{2}}$。\n给定 $\\lambda \\ge 1$：\n$$\n\\lambda (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) \\ge 1 \\cdot (M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}) = M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}.\n$$\n由于 $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2} |f'(u_{i+1}^n) - f'(u_i^n)| \\ge 0$，因此有 $M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}} \\ge M_{i+\\tfrac{1}{2}}$。\n因此，对于任意 $\\lambda \\ge 1$，所提出的粘性系数满足单调性条件，格式是非线性稳定的。\n\n数值耗散的大小与 $\\alpha_{i+\\tfrac{1}{2}}^n$ 成正比。由于对于 $\\lambda \\ge 1$ 稳定性得到保证，因此选择 $\\lambda = 1$ 提供了基于此公式满足条件的最小 $\\alpha_{i+\\tfrac{1}{2}}^n$ 值。因此，在维持单调格式的前提下，$\\lambda = 1$ 在界面层级上最小化了数值耗散。任何 $\\lambda > 1$ 都会增加耗散，导致对激波和接触间断等解特征的表示更加模糊。\n\n### $\\lambda$ 的敏感性分析\n\n粘性由 $\\alpha_{i+\\tfrac{1}{2}}^n = \\lambda \\left( M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}} \\right)$ 给出。项 $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2}|f'(u_{i+1}^n) - f'(u_i^n)|$ 被设计为对特征速度 $f'(u)$ 的局部梯度敏感。\n\n-   **光滑区域**：在解 $u$ 光滑的区域，相邻单元之间的变化很小。泰勒展开给出 $u_{i+1}^n - u_i^n = u_x \\Delta x + O(\\Delta x^2)$。类似地，$f'(u_{i+1}^n) - f'(u_i^n) \\approx f''(u_i^n)(u_{i+1}^n - u_i^n) = O(\\Delta x)$。项 $\\Delta_{i+\\tfrac{1}{2}}$ 是 $O(\\Delta x)$ 阶，使其成为一个小的修正。粘性主要由主导项决定，$\\alpha_{i+\\tfrac{1}{2}}^n \\approx \\lambda M_{i+\\tfrac{1}{2}}$，这是由 $\\lambda$ 缩放的标准 Rusanov 粘性。附加项提供了最小量的额外耗散。\n\n-   **激波区域**：在间断（激波）附近，跳跃 $|u_{i+1}^n - u_i^n|$ 是 $O(1)$ 阶的。因此，项 $\\Delta_{i+\\tfrac{1}{2}} = \\frac{1}{2}|f'(u_{i+1}^n) - f'(u_i^n)|$ 也是 $O(1)$ 阶的。该项显著增大了数值粘性 $\\alpha_{i+\\tfrac{1}{2}}^n$。增强后的粘性与基础 Rusanov 粘性的比率为\n$$\n\\frac{M_{i+\\tfrac{1}{2}} + \\Delta_{i+\\tfrac{1}{2}}}{M_{i+\\tfrac{1}{2}}} = 1 + \\frac{\\Delta_{i+\\tfrac{1}{2}}}{M_{i+\\tfrac{1}{2}}}.\n$$\n在激波区域，该分数的分子和分母都是 $O(1)$ 阶的，因此粘性被增加了一个 $O(1)$ 因子。这种大量耗散的增加被局限在高梯度区域，而这正是需要它来抑制伪振荡（吉布斯现象）并稳定数值解的地方，从而产生一个尖锐但单调的激波剖面。参数 $\\lambda$ 在此自适应机制上充当全局缩放因子。$\\lambda < 1$ 有不稳定和振荡的风险，而 $\\lambda > 1$ 则会产生比稳定性所需更宽、更弥散的激波。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the Lax-Friedrichs scheme with adaptive viscosity for the\n    inviscid Burgers' equation and runs a suite of tests.\n    \"\"\"\n\n    def run_simulation(u0, T_final, N, lam, cfl, is_shock_case):\n        \"\"\"\n        Runs a single simulation for a given set of parameters.\n        \"\"\"\n        dx = 1.0 / N\n        u = np.copy(u0)\n        t = 0.0\n        \n        # Initial diagnostics\n        u_max0 = np.max(u0)\n        u_min0 = np.min(u0)\n        tv0 = np.sum(np.abs(np.roll(u0, -1) - u0))\n        if tv0 == 0:\n            tv0 = 1.0 # Avoid division by zero for constant initial data\n\n        while t < T_final:\n            # Periodic boundary conditions for neighbors\n            u_right = np.roll(u, -1)  # u_{i+1}\n\n            # For Burgers' equation, f'(u) = u\n            f_prime_u = u\n            f_prime_u_right = u_right\n\n            # Calculate adaptive numerical viscosity alpha_{i+1/2}\n            alpha_half = lam * (\n                np.maximum(np.abs(f_prime_u), np.abs(f_prime_u_right)) +\n                0.5 * np.abs(f_prime_u_right - f_prime_u)\n            )\n\n            # Adaptive time step based on CFL condition\n            alpha_max = np.max(alpha_half)\n            if alpha_max == 0:\n                # If all velocities are zero, solution is static\n                dt = T_final - t\n            else:\n                dt = cfl * dx / alpha_max\n            \n            dt = min(dt, T_final - t)\n\n            # Flux calculation f(u) = 0.5 * u^2\n            f_u = 0.5 * u**2\n            f_u_right = 0.5 * u_right**2\n\n            # Lax-Friedrichs (Rusanov) numerical flux F_{i+1/2}\n            flux_half = 0.5 * (f_u + f_u_right) - 0.5 * alpha_half * (u_right - u)\n            \n            # Flux at the left interface F_{i-1/2}\n            flux_half_left = np.roll(flux_half, 1)\n\n            # Finite volume update\n            u = u - (dt / dx) * (flux_half - flux_half_left)\n            \n            t += dt\n\n        # Final diagnostics\n        tv_final = np.sum(np.abs(np.roll(u, -1) - u))\n        tv_ratio = tv_final / tv0\n        \n        mpv = max(0, np.max(u) - u_max0) + max(0, u_min0 - np.min(u))\n\n        if is_shock_case:\n            thickness = np.sum((u >= 0.1)  (u = 0.9))\n            return tv_ratio, thickness, mpv\n        else:\n            return tv_ratio, 0, mpv\n\n    # Test suite parameters\n    N = 256\n    T_smooth = 0.1\n    T_shock = 0.05\n    cfl = 0.9\n    lambdas = [0.8, 1.0, 2.0]\n    x = np.linspace(0, 1, N, endpoint=False)\n\n    # Test cases\n    test_cases = [\n        {\n            'name': 'smooth',\n            'ic': 0.5 + 0.5 * np.sin(2 * np.pi * x),\n            'T': T_smooth,\n            'is_shock_case': False\n        },\n        {\n            'name': 'shock',\n            'ic': np.where(x  0.5, 1.0, 0.0),\n            'T': T_shock,\n            'is_shock_case': True\n        }\n    ]\n\n    results_tv_smooth = []\n    results_thick_shock = []\n    results_mpv_smooth = []\n    results_mpv_shock = []\n\n    for case in test_cases:\n        for lam in lambdas:\n            tv_ratio, thickness, mpv = run_simulation(\n                case['ic'], case['T'], N, lam, cfl, case['is_shock_case']\n            )\n            if case['name'] == 'smooth':\n                results_tv_smooth.append(tv_ratio)\n                results_mpv_smooth.append(mpv)\n            elif case['name'] == 'shock':\n                results_thick_shock.append(thickness)\n                results_mpv_shock.append(mpv)\n    \n    # Assemble the final list in the specified order\n    final_results = (\n        results_tv_smooth +\n        results_thick_shock +\n        results_mpv_smooth +\n        results_mpv_shock\n    )\n\n    # Format the output as a comma-separated string in brackets\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3375314"}]}