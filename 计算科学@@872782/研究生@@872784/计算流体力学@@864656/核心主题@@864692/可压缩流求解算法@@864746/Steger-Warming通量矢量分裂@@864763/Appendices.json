{"hands_on_practices": [{"introduction": "要理解像Steger-Warming这样复杂的数值格式，最好的方法通常是从一个更简单的模型开始。无粘性伯格斯方程（Burgers' equation）提供了一个完美的试验平台。这个练习将指导您从第一性原理出发，推导一个标量非线性方程的分裂通量。它清晰地揭示了基于特征速度符号进行通量分裂的核心逻辑，这也是该方法的基础。[@problem_id:3366264]", "problem": "考虑由无粘伯格斯方程给出的标量非线性双曲守恒律，$u_{t} + f(u)_{x} = 0$，其中 $f(u) = \\tfrac{1}{2} u^{2}$。局部特征速度定义为通量关于守恒变量的导数，即 $a(u) \\equiv \\dfrac{d f}{d u}(u)$。Steger–Warming 通量矢量分裂方法通过将特征速度分解为右行和左行部分，并分别使用来自左、右状态的相应分裂通量，来构造单元交界面上的数值通量。具体而言，交界面上的数值通量取为 $f^{+}(u_{L}) + f^{-}(u_{R})$，其中 $f^{\\pm}(u)$ 分别是特征速度正部和负部的原函数，并经过归一化使得 $f^{+}(0) = 0$ 和 $f^{-}(0) = 0$。\n\n从这些原理和定义出发（不使用任何现成的通量分裂公式），推导无粘伯格斯方程的 $f^{+}(u)$ 和 $f^{-}(u)$ 的显式表达式。然后，对于左状态为 $u_{L} = 2$、右状态为 $u_{R} = -1$ 的黎曼交界面，计算数值通量 $f^{+}(u_{L}) + f^{-}(u_{R})$。\n\n此外，在你的推导过程中，请解释对于给定的每个状态，哪一侧（左侧或右侧）为交界面提供了迎风信息，并根据特征速度的符号证明这一解释的合理性。你最终报告的答案必须是通量的单一数值。不要对答案进行四舍五入。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 守恒律：$u_{t} + f(u)_{x} = 0$。\n- 通量函数：$f(u) = \\tfrac{1}{2} u^{2}$。\n- 特征速度：$a(u) \\equiv \\dfrac{d f}{d u}(u)$。\n- Steger-Warming 数值通量定义：$F = f^{+}(u_{L}) + f^{-}(u_{R})$。\n- 分裂通量定义：$\\dfrac{d f^{+}}{d u}(u) = a^{+}(u)$，其中 $a^{+}(u)$ 是 $a(u)$ 的正部；以及 $\\dfrac{d f^{-}}{d u}(u) = a^{-}(u)$，其中 $a^{-}(u)$ 是 $a(u)$ 的负部。\n- 归一化条件：$f^{+}(0) = 0$ 和 $f^{-}(0) = 0$。\n- 黎曼问题的交界面状态：左状态 $u_{L} = 2$ 和右状态 $u_{R} = -1$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为无粘伯格斯方程是非线性双曲偏微分方程的典型模型，而 Steger-Warming 通量矢量分裂是计算流体动力学中一种成熟的数值方法。所提供的特征速度定义和分裂通量的构造是标准的，并且在数学上是一致的。该问题是适定的，提供了推导唯一数值答案所需的所有必要信息（偏微分方程、通量函数、定义、归一化条件和具体状态）。语言客观、精确。该问题未违反任何指定的无效标准。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解答。\n\n解答过程分为三个部分：首先，推导分裂通量函数 $f^{+}(u)$ 和 $f^{-}(u)$；其次，对给定状态的迎风贡献进行物理解释；最后，计算数值通量。\n\n**第一部分：分裂通量函数的推导**\n\n标量守恒律由 $u_{t} + (f(u))_x = 0$ 给出，通量函数为 $f(u) = \\frac{1}{2}u^2$。\n特征速度 $a(u)$ 是通量函数关于守恒变量 $u$ 的导数：\n$$\na(u) = \\frac{d f}{d u} = \\frac{d}{d u} \\left(\\frac{1}{2}u^2\\right) = u\n$$\nSteger-Warming 分裂格式将此速度分解为其正部和负部，分别记为 $a^{+}(u)$ 和 $a^{-}(u)$。\n$$\na^{+}(u) = \\max(a(u), 0) = \\max(u, 0)\n$$\n$$\na^{-}(u) = \\min(a(u), 0) = \\min(u, 0)\n$$\n这些可以分段表示为：\n$$\na^{+}(u) = \n\\begin{cases}\n    u  \\text{if } u  0 \\\\\n    0  \\text{if } u \\le 0\n\\end{cases}\n$$\n$$\na^{-}(u) = \n\\begin{cases}\n    0  \\text{if } u  0 \\\\\n    u  \\text{if } u \\le 0\n\\end{cases}\n$$\n分裂通量函数 $f^{+}(u)$ 和 $f^{-}(u)$ 分别是 $a^{+}(u)$ 和 $a^{-}(u)$ 的原函数。我们使用指定的归一化条件 $f^{+}(0) = 0$ 和 $f^{-}(0) = 0$ 来确定积分常数。这等价于计算从 $0$ 到 $u$ 的定积分。\n\n对于 $f^{+}(u)$：\n$$\nf^{+}(u) = \\int_{0}^{u} a^{+}(s) \\, ds\n$$\n如果 $u  0$，积分路径上的值为正，此时 $a^{+}(s) = s$：\n$$\nf^{+}(u) = \\int_{0}^{u} s \\, ds = \\left[ \\frac{1}{2}s^2 \\right]_{0}^{u} = \\frac{1}{2}u^2\n$$\n如果 $u \\le 0$，积分路径上的值为非正，此时 $a^{+}(s) = 0$：\n$$\nf^{+}(u) = \\int_{0}^{u} 0 \\, ds = 0\n$$\n将这些组合起来，我们得到正分裂通量的表达式：\n$$\nf^{+}(u) = \n\\begin{cases}\n    \\frac{1}{2}u^2  \\text{if } u  0 \\\\\n    0  \\text{if } u \\le 0\n\\end{cases}\n$$\n对于 $f^{-}(u)$：\n$$\nf^{-}(u) = \\int_{0}^{u} a^{-}(s) \\, ds\n$$\n如果 $u  0$，积分路径上的值为正，此时 $a^{-}(s) = 0$：\n$$\nf^{-}(u) = \\int_{0}^{u} 0 \\, ds = 0\n$$\n如果 $u \\le 0$，积分路径上的值为非正，此时 $a^{-}(s) = s$：\n$$\nf^{-}(u) = \\int_{0}^{u} s \\, ds = \\left[ \\frac{1}{2}s^2 \\right]_{0}^{u} = \\frac{1}{2}u^2\n$$\n将这些组合起来，我们得到负分裂通量的表达式：\n$$\nf^{-}(u) = \n\\begin{cases}\n    0  \\text{if } u  0 \\\\\n    \\frac{1}{2}u^2  \\text{if } u \\le 0\n\\end{cases}\n$$\n作为一致性检验，我们验证 $f^{+}(u) + f^{-}(u) = f(u)$。对于 $u  0$，$f^{+}(u) + f^{-}(u) = \\frac{1}{2}u^2 + 0 = \\frac{1}{2}u^2$。对于 $u \\le 0$，$f^{+}(u) + f^{-}(u) = 0 + \\frac{1}{2}u^2 = \\frac{1}{2}u^2$。该性质对所有 $u \\in \\mathbb{R}$ 成立。\n\n**第二部分：迎风信息的解释**\n\n特征速度 $a(u)$ 决定了信息传播的方向。\n- 如果 $a(u)  0$，信息从左向右传播。“迎风”方向来自左侧。\n- 如果 $a(u)  0$，信息从右向左传播。“迎风”方向来自右侧。\n\nSteger-Warming 通量 $F = f^{+}(u_{L}) + f^{-}(u_{R})$ 正是基于此原理构造的。$f^{+}(u_{L})$ 项与右行波（正速度）相关，因此使用来自左状态 $u_L$ 的信息。$f^{-}(u_{R})$ 项与左行波（负速度）相关，因此使用来自右状态 $u_R$ 的信息。\n\n对于给定的黎曼问题，我们有 $u_L = 2$ 和 $u_R = -1$。\n- 对于左状态 $u_L=2$：特征速度为 $a(u_L) = u_L = 2$。由于 $a(u_L)  0$，源于左状态的信息在交界面处向右传播。因此，左状态为右行波提供了迎风信息。分裂方法通过在通量中使用 $f^{+}(u_L)$ 来捕捉这一点。\n- 对于右状态 $u_R=-1$：特征速度为 $a(u_R) = u_R = -1$。由于 $a(u_R)  0$，源于右状态的信息在交界面处向左传播。因此，右状态为左行波提供了迎风信息。分裂方法通过在通量中使用 $f^{-}(u_R)$ 来捕捉这一点。\n\n在这个具体案例中，来自交界面左、右两侧的特征线都指向交界面，这是激波的一个特征。左、右两个状态 $u_L$ 和 $u_R$ 都为交界面提供了迎风信息。\n\n**第三部分：数值通量的计算**\n\n交界面上的数值通量由 $F = f^{+}(u_{L}) + f^{-}(u_{R})$ 给出。我们将给定值 $u_{L} = 2$ 和 $u_{R} = -1$ 代入推导出的 $f^{+}$ 和 $f^{-}$ 表达式中。\n\n首先，我们计算 $f^{+}(u_{L}) = f^{+}(2)$。由于 $u_{L} = 2  0$，我们使用 $f^{+}$ 公式对应的分支：\n$$\nf^{+}(2) = \\frac{1}{2}(2)^2 = \\frac{1}{2}(4) = 2\n$$\n接下来，我们计算 $f^{-}(u_{R}) = f^{-}(-1)$。由于 $u_{R} = -1 \\le 0$，我们使用 $f^{-}$ 公式对应的分支：\n$$\nf^{-}(-1) = \\frac{1}{2}(-1)^2 = \\frac{1}{2}(1) = \\frac{1}{2}\n$$\n最后，我们将这两个分量相加，得到总的数值通量：\n$$\nF = f^{+}(2) + f^{-}(-1) = 2 + \\frac{1}{2} = \\frac{5}{2}\n$$\n交界面上的数值通量为 $\\frac{5}{2}$。", "answer": "$$\\boxed{\\frac{5}{2}}$$", "id": "3366264"}, {"introduction": "没有一种数值方法是完美的，理解一个方法的局限性与理解其构造同样重要。Steger-Warming格式的一个众所周知的问题是它在某些类型的波上会产生过度的数值耗散，尤其是在接触间断处。这项高级练习要求您通过推导和计算一个“有效耗散系数”来量化这种数值误差。通过分析接触间断处的通量，您将深入了解该格式的行为及其缺陷的原因，而这些缺陷也正是推动更先进方法发展的动力。[@problem_id:3366237]", "problem": "考虑理想气体的一维可压缩欧拉方程，它是一个守恒律系统，构成了关于守恒状态向量 $U = [\\rho, \\rho u, E]^\\top$ 的偏微分方程 (PDE) 系统，其中 $\\rho$ 为密度，$u$ 为速度，$E$ 为总能量。通量为 $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^\\top$，其中 $p$ 是热力学压力，受理想气体定律 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$ 的约束，$\\gamma$ 为比热比。控制方程可以写作 $\\partial_t U + \\partial_x F(U) = 0$。这个设定在计算流体动力学 (CFD) 中是经典的。\n\n您需要分析使用 Steger–Warming 通量矢量分裂 (FVS) 方法对接触间断的解析情况。在欧拉方程的纯接触间断中，速度 $u$ 和压力 $p$ 在间断两侧是均匀的，而密度 $\\rho$ 是间断的。假设在两个相邻网格之间存在一个黎曼界面，其左状态为 $U_L$，右状态为 $U_R$，使得接触间断在给定时间到达该界面。Steger–Warming (FVS) 界面通量是通过根据特征波的方向性对通量贡献进行分裂而形成的，这需要使用通量雅可比矩阵 $A(U) = \\partial F/\\partial U$ 的特征分解：\n- 定义 $A(U)$ 的右特征向量矩阵 $R(U)$ 和特征值矩阵 $\\Lambda(U)$，使得 $A(U) = R(U)\\Lambda(U)R(U)^{-1}$，其中特征值为 $\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$，而 $c = \\sqrt{\\gamma p/\\rho}$ 是当地声速。\n- 通过 $\\Lambda^+(U) = \\mathrm{diag}(\\max(\\lambda_1,0), \\max(\\lambda_2,0), \\max(\\lambda_3,0))$ 和 $\\Lambda^-(U) = \\mathrm{diag}(\\min(\\lambda_1,0), \\min(\\lambda_2,0), \\min(\\lambda_3,0))$ 定义对角特征值矩阵的正部和负部。\n- 定义分裂通量算子 $A^\\pm(U) = R(U)\\Lambda^\\pm(U)R(U)^{-1}$ 和分裂通量 $F^\\pm(U) = A^\\pm(U)U$。\n- 那么，Steger–Warming 界面通量为 $F_{\\mathrm{SW}}(U_L,U_R) = F^+(U_L) + F^-(U_R)$。\n\n当具有均匀 $u$ 和 $p$ 的接触间断到达界面时，穿过界面的精确物理质量通量等于 $f_{\\text{up}} = u\\,\\rho_{\\text{up}}$，其中 $\\rho_{\\text{up}}$ 是迎风密度，即如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_L$；如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_R$。Steger–Warming 通量 $F_{\\mathrm{SW}}$ 通常会引入数值扩散，从而抹平接触间断。通过在界面处使用离散菲克关系定义一个有效扩散系数 $D_{\\mathrm{eff}}$，来量化质量守恒方程中的数值扩散量：\n$$\nf_{\\mathrm{SW,\\,mass}} \\;=\\; f_{\\text{up}} \\;-\\; D_{\\mathrm{eff}}\\,\\frac{\\rho_R - \\rho_L}{\\Delta x},\n$$\n其中 $f_{\\mathrm{SW,\\,mass}}$ 是 $F_{\\mathrm{SW}}(U_L,U_R)$ 的质量分量（第一个分量），$\\Delta x$ 是均匀的网格尺寸。求解 $D_{\\mathrm{eff}}$：\n$$\nD_{\\mathrm{eff}} \\;=\\; \\frac{f_{\\text{up}} - f_{\\mathrm{SW,\\,mass}}}{(\\rho_R - \\rho_L)/\\Delta x}.\n$$\n\n本问题中的所有变量都是无量纲的，因此不需要物理单位。不出现角度。不出现百分比。\n\n任务：\n- 从欧拉方程的守恒律形式和基于通量雅可比矩阵特征分解的 Steger–Warming 通量矢量分裂定义出发，实现一个程序，用于计算在代表接触间断（相同的 $u$ 和 $p$，不同的 $\\rho$）的一组给定左右状态下，单个界面上的 $D_{\\mathrm{eff}}$。\n- 对每个测试用例，使用上述 $D_{\\mathrm{eff}}$ 的定义来量化接触间断的扩散。\n\n测试套件：\n对于每个测试用例，给定 $(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x)$：\n- 用例 1：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.5,\\, 1.0,\\, 1.0,\\, 2.0,\\, 1.0\\,)$。\n- 用例 2：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, -0.5,\\, 1.0,\\, 2.0,\\, 1.0,\\, 1.0\\,)$。\n- 用例 3：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.0,\\, 1.0,\\, 0.8,\\, 1.2,\\, 0.5\\,)$。\n- 用例 4：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.5324471805,\\, 1.0,\\, 1.0,\\, 4.0,\\, 1.0\\,)$。\n\n约束和指令：\n- 在每种情况下，将气体视为理想气体，并使用给定的 $\\gamma$。\n- 对于每一侧，使用 $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2}\\rho u^2$ 从 $(\\rho, u, p)$ 构建 $U_L$ 和 $U_R$。\n- 严格按照 $F^+(U_L) + F^-(U_R)$ 计算 $F_{\\mathrm{SW}}$，其中 $F^\\pm(U) = R(U)\\Lambda^\\pm(U)R(U)^{-1}U$ 是通过相应侧的欧拉通量雅可比矩阵的特征分解定义的。\n- 计算 $f_{\\text{up}} = u\\,\\rho_{\\text{up}}$，其中如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_L$；如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_R$；如果 $u = 0$，则 $f_{\\text{up}} = 0$。\n- 使用上面的表达式计算 $D_{\\mathrm{eff}}$。您可以假设在测试套件中 $\\rho_R \\ne \\rho_L$，因此分母不为零。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的 $D_{\\mathrm{eff}}$ 结果，格式为用方括号括起来的逗号分隔列表，每个数字都四舍五入到小数点后八位。例如，正确格式的输出行是 $[\\;d_1, d_2, d_3, d_4\\;]$，其中每个 $d_k$ 都格式化为八位小数。\n- 程序必须完全自包含，不接受任何输入，并直接打印结果行。\n\n目标是通过分析接触间断到达界面时的离散通量，以一种有原则的方式评估 Steger–Warming 通量矢量分裂如何扩散接触间断，并为指定情况量化数值扩散为 $D_{\\mathrm{eff}}$。", "solution": "该问题要求计算当 Steger–Warming 通量矢量分裂 (FVS) 格式应用于一维欧拉方程中的接触间断时，其有效数值扩散系数 $D_{\\mathrm{eff}}$。该设定涉及一个左状态 $U_L$ 和一个右状态 $U_R$ 之间的界面，其特征是均匀的速度 $u$ 和压力 $p$，但密度不连续，$\\rho_L \\neq \\rho_R$。\n\n有效扩散系数 $D_{\\mathrm{eff}}$ 由以下关系定义：\n$$\nf_{\\mathrm{SW,\\,mass}} \\;=\\; f_{\\text{up}} \\;-\\; D_{\\mathrm{eff}}\\,\\frac{\\rho_R - \\rho_L}{\\Delta x}\n$$\n其中 $f_{\\mathrm{SW,\\,mass}}$ 是 Steger–Warming 界面通量 $F_{\\mathrm{SW}}(U_L, U_R)$ 的质量通量分量，$f_{\\text{up}}$ 是精确的迎风质量通量，$\\Delta x$ 是网格间距。重新整理得到 $D_{\\mathrm{eff}}$：\n$$\nD_{\\mathrm{eff}} \\;=\\; \\frac{f_{\\text{up}} - f_{\\mathrm{SW,\\,mass}}}{(\\rho_R - \\rho_L)/\\Delta x}\n$$\n主要任务是推导出 $f_{\\mathrm{SW,\\,mass}}$ 的显式表达式，以便于计算。\n\nSteger–Warming 界面通量定义为 $F_{\\mathrm{SW}}(U_L, U_R) = F^+(U_L) + F^-(U_R)$。分裂通量 $F^\\pm(U)$ 由 $F^\\pm(U) = A^\\pm(U) U$ 给出，其中 $A^\\pm(U) = R(U) \\Lambda^\\pm(U) R(U)^{-1}$。此处，$R(U)$ 是通量雅可比矩阵 $A(U) = \\partial F/\\partial U$ 的右特征向量矩阵，而 $\\Lambda^\\pm(U)$ 是包含 $A(U)$ 特征值正部和负部的对角矩阵。\n\n一个更直接计算 $F^\\pm(U)$ 的方法是利用状态向量 $U$ 在 $A(U)$ 的右特征向量基 $\\{r_1, r_2, r_3\\}$ 上的展开：\n$$\nU = \\sum_{k=1}^{3} \\alpha_k r_k\n$$\n其中系数 $\\alpha_k$ 是向量 $R^{-1}U$ 的分量。应用算子 $A^\\pm(U)$ 可得：\n$$\nF^\\pm(U) = A^\\pm(U) U = \\left(R \\Lambda^\\pm R^{-1}\\right) \\left(\\sum_{k=1}^{3} \\alpha_k r_k\\right) = R \\Lambda^\\pm \\left(\\sum_{k=1}^{3} \\alpha_k (R^{-1}r_k)\\right)\n$$\n由于 $R^{-1}r_k$ 是第 $k$ 个标准基向量 $e_k$，上式可简化为：\n$$\nF^\\pm(U) = R \\left(\\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm e_k\\right) = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm (R e_k) = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm r_k\n$$\n其中 $\\lambda_k^\\pm$ 是特征值 $\\lambda_k$ 的正部/负部。\n\n对于一维欧拉方程，$A(U)$ 的特征值为 $\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$，其中 $c = \\sqrt{\\gamma p/\\rho}$ 是声速。相应的右特征向量 $r_k$（$R$ 的列）和特征系数 $\\alpha_k$（$R^{-1}U$ 的分量）是标准结果：\n$$\nr_1 = \\begin{pmatrix} 1 \\\\ u-c \\\\ H-uc \\end{pmatrix}, \\quad r_2 = \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix}, \\quad r_3 = \\begin{pmatrix} 1 \\\\ u+c \\\\ H+uc \\end{pmatrix}\n$$\n和\n$$\n\\alpha_1 = \\frac{\\rho}{2\\gamma}, \\quad \\alpha_2 = \\rho\\left(\\frac{\\gamma-1}{\\gamma}\\right), \\quad \\alpha_3 = \\frac{\\rho}{2\\gamma}\n$$\n其中 $H = \\frac{E+p}{\\rho} = \\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}$ 是总焓。\n\n我们关心的是质量通量分量，即通量向量的第一个分量。每个右特征向量 $r_k$ 的第一个分量都是 1。因此，分裂通量 $F^\\pm(U)$ 的质量分量是：\n$$\n(F^\\pm(U))_1 = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm (r_k)_1 = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm\n$$\n代入 $\\alpha_k$ 的表达式：\n$$\n(F^\\pm(U))_1 = \\frac{\\rho}{2\\gamma}\\lambda_1^\\pm + \\rho\\left(\\frac{\\gamma-1}{\\gamma}\\right)\\lambda_2^\\pm + \\frac{\\rho}{2\\gamma}\\lambda_3^\\pm\n$$\n界面上的总 Steger–Warming 质量通量是来自左状态的正部和来自右状态的负部之和：\n$$\nf_{\\mathrm{SW,\\,mass}} = (F^+(U_L))_1 + (F^-(U_R))_1\n$$\n其中\n$$\n(F^+(U_L))_1 = \\frac{\\rho_L}{2\\gamma}\\lambda_{1,L}^+ + \\rho_L\\frac{\\gamma-1}{\\gamma}\\lambda_{2,L}^+ + \\frac{\\rho_L}{2\\gamma}\\lambda_{3,L}^+\n$$\n$$\n(F^-(U_R))_1 = \\frac{\\rho_R}{2\\gamma}\\lambda_{1,R}^- + \\rho_R\\frac{\\gamma-1}{\\gamma}\\lambda_{2,R}^- + \\frac{\\rho_R}{2\\gamma}\\lambda_{3,R}^-\n$$\n特征值是为每个状态计算的：$\\lambda_{k,L}$ 使用 $(u, c_L)$ 计算，$\\lambda_{k,R}$ 使用 $(u, c_R)$ 计算，其中 $c_L = \\sqrt{\\gamma p/\\rho_L}$ 和 $c_R = \\sqrt{\\gamma p/\\rho_R}$。分裂特征值为 $\\lambda_k^+ = \\max(\\lambda_k, 0)$ 和 $\\lambda_k^- = \\min(\\lambda_k, 0)$。\n\n精确的迎风质量通量 $f_{\\text{up}}$ 定义为：\n$$\nf_{\\text{up}} =\n\\begin{cases}\nu\\,\\rho_L  \\text{if } u  0 \\\\\nu\\,\\rho_R  \\text{if } u  0 \\\\\n0  \\text{if } u = 0\n\\end{cases}\n$$\n有了这些表达式，就可以通过以下步骤为每个测试用例计算 $D_{\\mathrm{eff}}$：\n1.  对于每个状态（L 和 R），计算声速 $c$ 和特征值 $\\lambda_1, \\lambda_2, \\lambda_3$。\n2.  对于左状态，计算特征值的正部 $\\lambda_{k,L}^+$ 并计算 $(F^+(U_L))_1$。\n3.  对于右状态，计算特征值的负部 $\\lambda_{k,R}^-$ 并计算 $(F^-(U_R))_1$。\n4.  将这些贡献相加得到 $f_{\\mathrm{SW,\\,mass}}$。\n5.  根据 $u$ 的符号计算 $f_{\\text{up}}$。\n6.  将所有值代入 $D_{\\mathrm{eff}}$ 的公式中。\n\n这个过程为解决该问题提供了一个完整而系统的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef _calculate_split_flux_mass(rho, u, p, gamma, is_positive_part):\n    \"\"\"\n    Calculates the mass component of the split Euler flux F^+ or F^-.\n\n    This function implements the formula:\n    (F^±)_1 = Σ (α_k * λ_k^±)\n    where α are characteristic coefficients and λ are eigenvalues.\n\n    Args:\n        rho (float): Density.\n        u (float): Velocity.\n        p (float): Pressure.\n        gamma (float): Ratio of specific heats.\n        is_positive_part (bool): If True, computes F^+ component.\n                                 If False, computes F^- component.\n\n    Returns:\n        float: The mass component of the specified split flux.\n    \"\"\"\n    c = np.sqrt(gamma * p / rho)\n\n    # Eigenvalues of the flux Jacobian\n    lambda_1 = u - c\n    lambda_2 = u\n    lambda_3 = u + c\n\n    # Split eigenvalues\n    if is_positive_part:\n        lambda_split_1 = max(lambda_1, 0.0)\n        lambda_split_2 = max(lambda_2, 0.0)\n        lambda_split_3 = max(lambda_3, 0.0)\n    else:  # Negative part\n        lambda_split_1 = min(lambda_1, 0.0)\n        lambda_split_2 = min(lambda_2, 0.0)\n        lambda_split_3 = min(lambda_3, 0.0)\n\n    # Characteristic coefficients for the mass component\n    alpha_1 = rho / (2.0 * gamma)\n    alpha_2 = rho * (gamma - 1.0) / gamma\n    alpha_3 = rho / (2.0 * gamma)\n    \n    # Mass flux component is the sum of (alpha_k * lambda_k^±)\n    flux_mass = (alpha_1 * lambda_split_1 +\n                 alpha_2 * lambda_split_2 +\n                 alpha_3 * lambda_split_3)\n    \n    return flux_mass\n\ndef solve():\n    \"\"\"\n    Computes the effective numerical diffusivity for the Steger-Warming scheme\n    at a contact discontinuity for a given set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (gamma, u, p, rho_L, rho_R, delta_x)\n        (1.4, 0.5, 1.0, 1.0, 2.0, 1.0),\n        (1.4, -0.5, 1.0, 2.0, 1.0, 1.0),\n        (1.4, 0.0, 1.0, 0.8, 1.2, 0.5),\n        (1.4, 0.5324471805, 1.0, 1.0, 4.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, u, p, rho_L, rho_R, dx = case\n\n        # 1. Calculate the exact upwind mass flux\n        if u > 0.0:\n            f_up = u * rho_L\n        elif u  0.0:\n            f_up = u * rho_R\n        else:\n            f_up = 0.0\n\n        # 2. Calculate the Steger-Warming mass flux at the interface\n        # F_sw = F^+(U_L) + F^-(U_R)\n        f_sw_mass_p_L = _calculate_split_flux_mass(rho_L, u, p, gamma, is_positive_part=True)\n        f_sw_mass_m_R = _calculate_split_flux_mass(rho_R, u, p, gamma, is_positive_part=False)\n        \n        f_sw_mass = f_sw_mass_p_L + f_sw_mass_m_R\n        \n        # 3. Calculate the effective numerical diffusivity\n        # Denominator is guaranteed to be non-zero by problem constraints.\n        density_gradient = (rho_R - rho_L) / dx\n        D_eff = (f_up - f_sw_mass) / density_gradient\n        \n        results.append(D_eff)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3366237"}]}