{"hands_on_practices": [{"introduction": "通量矢量分裂方法的核心思想是利用流体控制方程的特征结构来构建迎风格式。本练习将带您回到第一性原理，推导一维欧拉方程的特征波速。理解这些波速（即通量雅可比矩阵的特征值 $u$, $u-a$, 和 $u+a$）的物理意义和数学推导，是掌握任何基于特征分解的数值方法（包括 Steger-Warming 格式）的基石。[@problem_id:3366221]", "problem": "考虑保守形式下理想气体的一维可压缩欧拉方程，其守恒状态向量为 $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量向量为 $\\mathbf{F}(\\mathbf{U}) = \\big(\\rho u, \\rho u^{2} + p, u(E + p)\\big)^{\\mathsf{T}}$。压力 $p$ 通过理想气体状态方程 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2} \\rho u^{2}\\right)$ 与总能量密度 $E$ 和密度 $\\rho$ 相关联，其中 $\\gamma$ 是比热比。声速 $a$ 在热力学上定义为 $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$，即在熵 $s$ 恒定时压力对密度的导数。计算流体力学（CFD）的框架通常采用通量雅可比矩阵的特征信息来构建迎风格式，例如 Steger–Warming 通量矢量分裂法，该方法根据波速的符号来分离通量贡献。\n\n从上述基本定律和定义出发，不引用任何预先给出的特征公式，首先推导一维欧拉方程的特征波速以及理想气体的声速 $a$ 关于 $\\gamma$、$p$ 和 $\\rho$ 的表达式。然后，对于特定的均匀状态 $(\\rho, u, p) = (1.0, 0.3, 1.0)$ 且 $\\gamma = 1.4$，数值计算声速 $a$ 和三个特征速度 $u - a$、$u$ 和 $u + a$。假设变量是无量纲的，因此不需要物理单位。将您的数值答案四舍五入到六位有效数字。将您的最终答案以 $[a,\\ u - a,\\ u,\\ u + a]$ 的顺序表示为单行矩阵。", "solution": "该问题要求推导一维欧拉方程的特征波速和理想气体声速的表达式，然后对特定状态进行数值计算。步骤如下。\n\n首先，我们推导该系统的特征速度。保守形式的一维欧拉方程由下式给出：\n$$ \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0 $$\n其中 $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 是守恒变量向量，$\\mathbf{F} = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$ 是通量向量。变量分别是密度 $\\rho$、速度 $u$、单位体积总能量 $E$ 和压力 $p$。该系统由理想气体状态方程 $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$ 封闭，其中 $\\gamma$ 是比热比。\n\n特征波速是通量雅可比矩阵 $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ 的特征值。直接计算此雅可比矩阵在代数上很繁琐。一个更系统的方法是使用原始变量向量，如 $\\mathbf{W} = (\\rho, u, p)^{\\mathsf{T}}$，将方程转换为拟线性形式。\n\n使用链式法则，欧拉方程可以写成：\n$$ \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0 $$\n令 $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ 和 $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$。方程变为 $\\mathbf{M} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$。左乘 $\\mathbf{M}^{-1}$ 得到拟线性形式 $\\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{M}^{-1}\\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$。特征速度 $\\lambda$ 是矩阵 $\\mathbf{A} = \\mathbf{M}^{-1}\\mathbf{B}$ 的特征值，它们是广义特征值问题 $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$ 的根。\n\n我们来计算矩阵 $\\mathbf{M}$ 和 $\\mathbf{B}$。首先，我们将守恒变量 $\\mathbf{U}$ 用原始变量 $\\mathbf{W}$ 表示：\n$U_1 = \\rho$\n$U_2 = \\rho u$\n$U_3 = E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$\n矩阵 $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ 是：\n$$ \\mathbf{M} = \\frac{\\partial(U_1, U_2, U_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} 1  0  0 \\\\ u  \\rho  0 \\\\ \\frac{1}{2}u^2  \\rho u  \\frac{1}{\\gamma-1} \\end{pmatrix} $$\n接下来，我们将通量向量 $\\mathbf{F}$ 用 $\\mathbf{W}$ 表示：\n$F_1 = \\rho u$\n$F_2 = \\rho u^2 + p$\n$F_3 = u(E+p) = u\\left(\\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2 + p\\right) = u\\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\\right) = \\frac{\\gamma u p}{\\gamma-1} + \\frac{1}{2}\\rho u^3$\n矩阵 $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$ 是：\n$$ \\mathbf{B} = \\frac{\\partial(F_1, F_2, F_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} u  \\rho  0 \\\\ u^2  2\\rho u  1 \\\\ \\frac{1}{2}u^3  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2  \\frac{\\gamma u}{\\gamma-1} \\end{pmatrix} $$\n现在我们求解特征方程 $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$：\n$$ \\det\\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ u^2 - \\lambda u  2\\rho u - \\lambda \\rho  1 \\\\ \\frac{1}{2}u^3 - \\frac{\\lambda}{2}u^2  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u}{\\gamma-1} - \\frac{\\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\n第一列的每一项都包含因子 $(u-\\lambda)$，因此 $(u-\\lambda)$ 是行列式的一个因子，这意味着 $\\lambda_1 = u$ 是一个特征值。对于 $\\lambda \\neq u$，我们可以通过代数余子式展开并提出公因子 $(u-\\lambda)$ 来简化行列式。\n$$ (u-\\lambda)\\left\\{\\left[\\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda\\rho u\\right)\\right] - \\rho\\left[u\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}\\right]\\right\\} = 0 $$\n对于 $\\lambda \\neq u$，大括号中的表达式必须为零。我们展开并简化此表达式。首先将该表达式乘以 $(\\gamma-1)$：\n$$ \\rho(2u-\\lambda)(\\gamma u-\\lambda) - \\gamma p - \\frac{3}{2}(\\gamma-1)\\rho u^2 + (\\gamma-1)\\lambda\\rho u - \\rho u(\\gamma u-\\lambda) + \\frac{1}{2}(\\gamma-1)\\rho u^2 = 0 $$\n展开所有项并按 $\\lambda$ 的幂次进行组织：\n$$ \\lambda^2(\\rho) + \\lambda(-\\rho(2+\\gamma)u + (\\gamma-1)\\rho u + \\rho u) + (2\\rho\\gamma u^2 - \\gamma p - \\frac{3}{2}(\\gamma-1)\\rho u^2 - \\rho\\gamma u^2 + \\frac{1}{2}(\\gamma-1)\\rho u^2) = 0 $$\n简化各项系数：\n- $\\lambda^1$ 的系数: $-\\rho(2+\\gamma)u + (\\gamma-1)\\rho u + \\rho u = (-2\\rho - \\rho\\gamma + \\rho\\gamma - \\rho + \\rho)u = -2\\rho u$。\n- $\\lambda^0$ 的系数: $2\\rho\\gamma u^2 - \\gamma p - \\frac{3}{2}(\\gamma-1)\\rho u^2 - \\rho\\gamma u^2 + \\frac{1}{2}(\\gamma-1)\\rho u^2 = \\rho\\gamma u^2 - \\gamma p - (\\gamma-1)\\rho u^2 = \\rho\\gamma u^2 - \\gamma p - (\\rho\\gamma u^2 - \\rho u^2) = \\rho u^2 - \\gamma p$。\n因此，关于剩余特征值的方程简化为：\n$$ \\rho\\lambda^2 - 2\\rho u \\lambda + (\\rho u^2 - \\gamma p) = 0 $$\n除以 $\\rho$（非零）：\n$$ \\lambda^2 - 2u\\lambda + u^2 - \\frac{\\gamma p}{\\rho} = 0 $$\n$$ (\\lambda - u)^2 = \\frac{\\gamma p}{\\rho} $$\n$$ \\lambda - u = \\pm\\sqrt{\\frac{\\gamma p}{\\rho}} $$\n这给出了另外两个特征值：$\\lambda_{2,3} = u \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n\n其次，我们推导声速 $a$ 的表达式。问题将其定义为 $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$，其中导数是在熵 $s$ 恒定时取的。对于量热完全理想气体，等熵过程由关系式 $p = K\\rho^\\gamma$ 控制，其中 $K$ 是常数。这个关系源于热力学第一定律 $de = Tds - p d(1/\\rho)$，其中 $e$ 是比内能。对于理想气体，$e=c_v T$ 且 $p=\\rho R T$。对于等熵过程（$ds=0$），这导致 $p/\\rho^\\gamma = \\text{const}$。\n对 $p$ 关于 $\\rho$ 求偏导数：\n$$ a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\frac{\\partial}{\\partial \\rho}(K\\rho^\\gamma) = K\\gamma\\rho^{\\gamma-1} $$\n代入 $K = p/\\rho^\\gamma$：\n$$ a^2 = \\left(\\frac{p}{\\rho^\\gamma}\\right)\\gamma\\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho} $$\n因此，声速为 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n一维欧拉方程的三个特征波速因此是 $\\lambda_1 = u$，$\\lambda_2 = u - a$ 和 $\\lambda_3 = u + a$。\n\n第三，我们为给定的均匀状态计算这些速度：$\\rho = 1.0$，$u = 0.3$，$p = 1.0$，以及 $\\gamma = 1.4$。所有变量都是无量纲的。\n\n声速 $a$ 为：\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.183215956... $$\n四舍五入到六位有效数字，我们得到 $a \\approx 1.18322$。\n\n三个特征速度是：\n1.  $u - a = 0.3 - \\sqrt{1.4} \\approx 0.3 - 1.183215956... = -0.883215956...$\n    四舍五入到六位有效数字，$u - a \\approx -0.883216$。\n2.  $u = 0.3$。表示为六位有效数字，即 $0.300000$。\n3.  $u + a = 0.3 + \\sqrt{1.4} \\approx 0.3 + 1.183215956... = 1.483215956...$\n    四舍五入到六位有效数字，$u + a \\approx 1.48322$。\n\n最终结果按 $[a,\\ u-a,\\ u,\\ u+a]$ 的顺序列出。", "answer": "$$ \\boxed{\\begin{pmatrix} 1.18322  -0.883216  0.300000  1.48322 \\end{pmatrix}} $$", "id": "3366221"}, {"introduction": "早期的通量矢量分裂格式（如 Steger-Warming）虽然开创了迎风思想，但在处理接触间断等流动结构时会引入过多的数值耗散。本练习将向您介绍一种更先进的格式——AUSM+（Advection Upstream Splitting Method Plus）。通过一个精心设计的接触间断算例，您将亲身体验 AUSM+ 格式如何通过分离对流通量和压力通量，实现对接触间断的精确捕捉，从而展示现代通量分裂格式的优势。[@problem_id:3320913]", "problem": "考虑理想气体的一维欧拉方程，其比热比 $\\gamma = 1.4$。设一个平面界面（与计算面法线对齐，即理想对齐）两侧的左右状态表示一个纯接触间断：\n- 左侧状态：密度 $\\rho_{L} = 1.0$，速度 $u_{L} = 600$，压力 $p_{L} = 1.0 \\times 10^{5}$。\n- 右侧状态：密度 $\\rho_{R} = 0.8$，速度 $u_{R} = 600$，压力 $p_{R} = 1.0 \\times 10^{5}$。\n所有物理量均采用国际单位制（SI）：$\\rho$ 单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$u$ 单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$p$ 单位为 $\\mathrm{Pa}$。\n\n利用平流上游分裂方法+（AUSM+）的通量矢量分裂原理，并从欧拉通量和理想气体定律的定义出发，推导界面上的 AUSM+ 数值通量矢量 $\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(F_{1},\\,F_{2},\\,F_{3}\\right)$，其中 $F_{1}$、$F_{2}$ 和 $F_{3}$ 分别为在给定界面处计算的质量、动量和能量通量。在您的推导中，解释为什么在理想对齐和给定接触间断的条件下，AUSM+ 能够实现接触间断的精确输运。然后计算给定状态下 $\\left(F_{1},\\,F_{2},\\,F_{3}\\right)$ 的数值。\n\n将 $F_{1}$ 以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 表示，$F_{2}$ 以 $\\mathrm{N}\\,\\mathrm{m}^{-2}$ 表示，$F_{3}$ 以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 表示。以精确值（无需四舍五入）给出最终的数值通量矢量。", "solution": "我们从一维欧拉方程及其通量开始。对于守恒变量 $\\boldsymbol{U} = \\left(\\rho,\\,\\rho u,\\,E\\right)$，$x$ 方向上的物理通量矢量为\n$$\n\\boldsymbol{F}(\\boldsymbol{U}) = \\left(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\right),\n$$\n其中 $E = \\rho e + \\tfrac{1}{2}\\rho u^{2}$ 是单位体积的总能量，$e$ 是单位质量的内能，理想气体定律将压力和内能联系起来：\n$$\np = (\\gamma - 1)\\rho e \\quad \\Rightarrow \\quad \\rho e = \\frac{p}{\\gamma - 1}.\n$$\n因此，\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}.\n$$\n\n通量矢量分裂方法通过将对流输运与声学（压力）贡献分离开来，并基于马赫数相关的分裂进行信息上游化，来构造数值界面通量 $\\boldsymbol{F}^{\\mathrm{num}}$。在平流上游分裂方法+（AUSM+）中，对流量使用马赫数分裂进行上游化，而声学量则以一种避免伪振荡并在理想对齐下保持接触间断精确输运的方式进行分裂。\n\n平流上游分裂方法+（AUSM+）在界面处采用以下通用结构：\n- 质量通量 $F_{1}$ 写为对流通量 $m$，\n- 动量通量 $F_{2}$ 是对流部分 $m u_{f}$ 和压力部分 $p_{f}$ 的和，\n- 能量通量 $F_{3}$ 是由 $m$ 引起的总焓的对流输运。\n\nAUSM+ 的一个关键特性是，当界面理想对齐（面法线与间断法线对齐），且左右状态具有相同的速度和压力时，它能精确输运接触间断。在这种情况下，接触波以流体速度移动，并且没有声学跳跃（$p_{L} = p_{R}$）。AUSM+ 恢复了精确的上游对流输运和界面处的一致压力：\n- 对于 $u  0$ 的超音速流，马赫数分裂产生纯粹来自左侧的上游对流，即质量通量简化为 $m = \\rho_{L} u_{L}$，界面压力为 $p_{f} = p_{L}$，能量对流通量使用左侧状态的总焓 $h_{t,L} = (E_{L} + p_{L})/\\rho_{L}$，因此 $F_{3} = m h_{t,L} = u_{L}(E_{L} + p_{L})$。\n\n我们验证给定状态在两侧确实是超音速的。声速为\n$$\na = \\sqrt{\\gamma \\frac{p}{\\rho}}.\n$$\n左侧：\n$$\na_{L} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{1.0}} = \\sqrt{1.4 \\times 10^{5}}.\n$$\n右侧：\n$$\na_{R} = \\sqrt{1.4 \\cdot \\frac{1.0 \\times 10^{5}}{0.8}} = \\sqrt{1.75 \\times 10^{5}}.\n$$\n数值上，\n$$\na_{L} = \\sqrt{140000} \\approx 374.1657387, \\quad a_{R} = \\sqrt{175000} \\approx 418.3300133.\n$$\n当 $u_{L} = u_{R} = 600$ 时，马赫数为\n$$\nM_{L} = \\frac{u_{L}}{a_{L}} \\approx \\frac{600}{374.1657387} \\approx 1.603, \\quad M_{R} = \\frac{u_{R}}{a_{R}} \\approx \\frac{600}{418.3300133} \\approx 1.435,\n$$\n两者都严格大于 $1$，证实了流动是超音速的。\n\n对于 AUSM+，在 $u  0$ 的超音速区域，分裂函数简化，使得界面处的整个对流输运都源于左侧状态（纯上游），而声学（压力）部分等于左侧压力。因此，在给定的接触间断（$u_{L} = u_{R}$，$p_{L} = p_{R}$）和理想对齐条件下，AUSM+ 实现了接触间断的精确输运：\n- 精确质量通量：\n$$\nF_{1} = m = \\rho_{L} u_{L}.\n$$\n- 精确动量通量：\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L}.\n$$\n- 精确能量通量：\n$$\nF_{3} = u_{L}(E_{L} + p_{L}), \\quad \\text{其中} \\quad E_{L} = \\frac{p_{L}}{\\gamma - 1} + \\frac{1}{2}\\rho_{L} u_{L}^{2}.\n$$\n\n我们现在计算数值。\n\n计算 $E_{L}$：\n$$\nE_{L} = \\frac{1.0 \\times 10^{5}}{1.4 - 1} + \\frac{1}{2} \\cdot 1.0 \\cdot 600^{2} = \\frac{1.0 \\times 10^{5}}{0.4} + \\frac{1}{2} \\cdot 360000 = 2.5 \\times 10^{5} + 1.8 \\times 10^{5} = 4.3 \\times 10^{5}.\n$$\n则\n$$\nE_{L} + p_{L} = 4.3 \\times 10^{5} + 1.0 \\times 10^{5} = 5.3 \\times 10^{5}.\n$$\n\n质量通量：\n$$\nF_{1} = \\rho_{L} u_{L} = 1.0 \\cdot 600 = 600.\n$$\n\n动量通量：\n$$\nF_{2} = \\rho_{L} u_{L}^{2} + p_{L} = 1.0 \\cdot 600^{2} + 1.0 \\times 10^{5} = 360000 + 100000 = 460000.\n$$\n\n能量通量：\n$$\nF_{3} = u_{L}(E_{L} + p_{L}) = 600 \\cdot 5.3 \\times 10^{5} = 3.18 \\times 10^{8}.\n$$\n\n因此，界面处的 AUSM+ 数值通量矢量为\n$$\n\\boldsymbol{F}^{\\mathrm{AUSM+}} = \\left(600,\\,460000,\\,3.18 \\times 10^{8}\\right),\n$$\n这表示在超音速区域的理想对齐条件下，接触间断的精确上游输运。", "answer": "$$\\boxed{\\begin{pmatrix}600  460000  3.18 \\times 10^{8}\\end{pmatrix}}$$", "id": "3320913"}]}