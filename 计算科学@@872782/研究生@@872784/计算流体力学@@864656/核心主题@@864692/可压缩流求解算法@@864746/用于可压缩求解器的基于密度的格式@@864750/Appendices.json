{"hands_on_practices": [{"introduction": "密度基求解器通过演化守恒变量（如密度 $\\rho$、动量密度 $\\rho u$ 和总能量密度 $\\rho E$）来求解流动问题。然而，为了计算通量或进行物理解释，我们通常需要压力 $p$ 和温度 $T$ 等原始变量。本练习将引导你完成从守恒状态向量中恢复热力学状态的基本代数推导，这是在每个时间步的每个阶段都必须执行的核心操作。[@problem_id:3307255]", "problem": "考虑一种单组分、无粘性、可压缩的理想气体，在计算流体动力学（CFD）中采用三维（$3$D）密度基公式进行建模。单位体积的守恒变量为质量密度 $\\rho$、动量密度 $\\rho u$、$\\rho v$、$\\rho w$ 以及总能量密度 $\\rho E$，其中 $E$ 是单位质量的总能量。原始变量为速度分量 $u$、$v$、$w$、压力 $p$ 和温度 $T$。假设该气体是量热完全气体，其比热比 $\\gamma  1$ 和比气体常数 $R  0$ 均为常数。密度基更新会推进守恒变量，而原始变量必须由这些守恒变量重构得出。\n\n从以下基本原理出发：\n- 总比能 $E$ 定义为比内能 $e$ 与比动能之和，\n- 理想气体状态方程 $p = \\rho R T$，\n- 以及量热完全气体的热量关系式 $e = c_{v} T$，其中 $c_{v} = \\frac{R}{\\gamma - 1}$，\n\n推导温度 $T$ 关于守恒变量和热力学参数的封闭形式表达式，并解释（定性地，无需数值实现细节）在密度基求解器中，每次更新守恒变量后，应如何一致地重构并保持 $p$、$T$ 和 $E$ 之间的一致性。您的推导必须从所述的基本关系式开始，并利用对密度基公式有效的定义来消除非原始量。\n\n请提供 $T$ 的最终表达式作为答案。无需进行数值计算。请将最终答案表示为单个解析表达式。最终的方框答案中不应包含任何单位。", "solution": "该问题陈述经评估为**有效**。它在科学上基于热力学和流体动力学原理，特别是量热完全理想气体模型。问题设定良好、客观，并提供了推导所要求的表达式和提供后续解释所需的全部且一致的定义和关系。该任务是计算流体动力学领域的一个标准推导，不包含验证标准中列出的任何缺陷。\n\n目标是推导温度 $T$ 关于单位体积守恒变量的封闭形式表达式：质量密度 $\\rho$、动量密度 $\\rho u$、$\\rho v$、$\\rho w$ 以及总能量密度 $\\rho E$。推导从所提供的基本原理开始。\n\n设守恒变量向量为 $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$。\n\n第一个原理是单位质量总能量 $E$ 的定义，其为比内能 $e$ 与比动能 $K$ 之和。\n$$E = e + K$$\n对于三维流动，比动能由下式给出：\n$$K = \\frac{1}{2} (u^2 + v^2 + w^2)$$\n因此，单位质量总能量为：\n$$E = e + \\frac{1}{2} (u^2 + v^2 + w^2)$$\n为了处理单位体积的量，根据密度基公式的惯例，我们乘以质量密度 $\\rho$：\n$$\\rho E = \\rho e + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\n第二个原理是量热完全气体的热量状态方程，它将比内能 $e$ 与温度 $T$ 联系起来：\n$$e = c_v T$$\n其中 $c_v$ 是定容比热。问题给出了 $c_v$ 关于比气体常数 $R$ 和比热比 $\\gamma$ 的关系式：\n$$c_v = \\frac{R}{\\gamma - 1}$$\n将 $e$ 的表达式代入 $\\rho E$ 的方程中：\n$$\\rho E = \\rho (c_v T) + \\frac{1}{2} \\rho (u^2 + v^2 + w^2)$$\n\n下一步是用守恒变量表示右侧除 $T$ 以外的所有项。速度分量 $u$、$v$ 和 $w$ 本身不是守恒变量，但它们与守恒的动量密度和质量密度相关：\n$$u = \\frac{\\rho u}{\\rho}, \\quad v = \\frac{\\rho v}{\\rho}, \\quad w = \\frac{\\rho w}{\\rho}$$\n单位体积动能 $\\frac{1}{2} \\rho (u^2 + v^2 + w^2)$ 可以用守恒量重写为：\n$$\\frac{1}{2} \\rho (u^2 + v^2 + w^2) = \\frac{1}{2} \\rho \\left( \\left(\\frac{\\rho u}{\\rho}\\right)^2 + \\left(\\frac{\\rho v}{\\rho}\\right)^2 + \\left(\\frac{\\rho w}{\\rho}\\right)^2 \\right)$$\n$$= \\frac{1}{2} \\rho \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{\\rho^2}$$\n$$= \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n现在，将动能项的这个表达式代回总能量密度 $\\rho E$ 的方程中：\n$$\\rho E = \\rho c_v T + \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n\n目标是解此方程求出温度 $T$。我们分离出包含 $T$ 的项：\n$$\\rho c_v T = \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho}$$\n两边同除以 $\\rho c_v$ 得到 $T$ 的表达式：\n$$T = \\frac{1}{\\rho c_v} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n最后，代入 $c_v = \\frac{R}{\\gamma - 1}$ 的表达式：\n$$T = \\frac{1}{\\rho \\left(\\frac{R}{\\gamma - 1}\\right)} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n$$T = \\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)$$\n这就是所求的温度 $T$ 的封闭形式表达式，它完全由守恒变量和气体常数参数 $\\gamma$ 和 $R$ 表示。\n\n关于问题的第二部分，从守恒变量（$\\rho E$ 等）一致地重构原始变量（$p, T$）是任何密度基求解器中的一个基本过程。守恒定律（例如，欧拉方程）是为守恒变量向量 $\\mathbf{U} = [\\rho, \\rho u, \\rho v, \\rho w, \\rho E]^T$ 进行数值求解的。这意味着在每个时间步（或 Runge-Kutta 阶段）结束时，求解器会产生一个更新后的状态向量 $\\mathbf{U}^{n+1}$。\n\n为了计算下一个时间步所需的量，例如通量（它依赖于像压力 $p$ 这样的原始变量），或用于后处理，必须从 $\\mathbf{U}^{n+1}$ 中恢复原始变量 $\\mathbf{W} = [\\rho, u, v, w, p, T]^T$。这种重构，通常称为“状态向量解码”，是一个确定性过程，它确保了所有热力学和运动学性质之间的一致性。其步骤如下：\n\n1.  更新后的密度 $\\rho$ 直接从 $\\mathbf{U}^{n+1}$ 的第一个分量中获得。\n2.  速度分量通过将动量密度除以质量密度来计算：$u = (\\rho u)/\\rho$，$v = (\\rho v)/\\rho$，$w = (\\rho w)/\\rho$。\n3.  总能量密度 $\\rho E$ 从 $\\mathbf{U}^{n+1}$ 的第五个分量中可知。单位体积动能由已求出的密度和动量密度计算得出。然后通过减法求出内能密度：$\\rho e = \\rho E - \\frac{1}{2\\rho}((\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2)$。\n4.  然后使用热量关系式 $e = c_v T$ 从内能计算出温度 $T$，这等同于使用上面推导出的 $T$ 的显式公式。这一步直接且唯一地将热状态（$T$）与总能量状态（$\\rho E$）和运动状态（动量密度）联系起来。\n5.  最后，使用理想气体状态方程计算压力 $p$：$p = \\rho R T$。\n\n$p$、$T$ 和 $E$ 之间的一致性不是需要主动“维持”的东西，就好像它们是可能偏离的独立变量一样。相反，一致性是由这个顺序重构过程内在保证的。在密度基方案中，原始变量 $p$ 和 $T$ 不是独立的、演化的量；它们是诊断变量，完全由任意时刻守恒变量的状态决定。通过从 $\\rho E$ 的组成部分推导出 $T$，然后从 $T$ 推导出 $p$，连接它们的热力学关系在每次更新后，根据定义在流场的每一点都得到满足。这个过程保证了用于计算通量的压力场与正在被守恒和演化的能量场完全一致。任何其他方法都将违反基本的物理模型。", "answer": "$$\n\\boxed{\\frac{\\gamma - 1}{\\rho R} \\left( \\rho E - \\frac{(\\rho u)^2 + (\\rho v)^2 + (\\rho w)^2}{2\\rho} \\right)}\n$$", "id": "3307255"}, {"introduction": "高阶数值格式需要使用限制器来抑制非物理振荡，但选择在哪个变量空间（守恒变量或原始变量）中应用限制器并非易事。本练习将探讨这一选择如何影响求解器的鲁棒性，特别是对密度和压力正值的保持。通过一个具体的数值算例，它揭示了在守恒变量空间中进行线性插值，可能会如何导致非物理状态的出现。[@problem_id:3307215]", "problem": "考虑计算流体动力学 (CFD) 中可压缩欧拉方程的有限体积 (FV) 离散化下的一个一维单元。基于密度的格式推进守恒变量 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$，其中 $\\rho$ 是密度，$u$ 是速度，$E$ 是单位质量总能量。原始变量为 $\\boldsymbol{W} = (\\rho, u, p)$，其中 $p$ 是压力。理想气体的状态方程为 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\dfrac{(\\rho u)^{2}}{\\rho}\\right)$，其中 $\\gamma$ 是比热比。\n\n你将一个带有参数 $\\theta \\in [0,1]$ 的线性缩放限制器应用于相对于单元平均状态的候选面状态，这可以在守恒空间或原始空间中进行。具体来说，对于守恒变量限制，定义 $\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta\\left(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}\\right)$；对于原始变量限制，定义 $\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta\\left(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}}\\right)$。此处，$\\bar{\\boldsymbol{U}}$ 和 $\\bar{\\boldsymbol{W}}$ 分别是单元平均的守恒状态和原始状态，而 $\\boldsymbol{U}^{*}$ 和 $\\boldsymbol{W}^{*}$ 是相应空间中未经限制的候选面状态。\n\n从可压缩欧拉方程和理想气体状态方程出发，从第一性原理推导在守恒变量限制与原始变量限制下，为保持密度和压力的严格正性（即 $\\rho(\\theta)  0$ 和 $p(\\theta)  0$）所需的 $\\theta$ 条件。你的推导必须从守恒变量和原始变量的定义以及状态方程开始，且不得引用任何预先推导的限制器公式。解释在守恒变量限制下，$p(\\theta)$ 的非线性如何导致比原始变量限制更严格的约束，并利用此推理提出一个选择限制空间的准则，该准则在保持 $\\rho(\\theta)  0$ 和 $p(\\theta)  0$ 的同时最大化鲁棒性。\n\n然后，对于以下物理上合理的数据，评估由守恒变量正性条件决定的允许的 $\\theta$ 值：\n\n- 比热比：$\\gamma = 1.4$。\n- 单元平均原始状态：$\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$。\n- 单元平均守恒状态：$\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$，其中 $\\bar{m} = \\bar{\\rho}\\bar{u}$ 且 $\\bar{\\tau} = \\bar{\\rho} \\bar{E}$，$\\bar{E} = \\dfrac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\dfrac{1}{2}\\bar{u}^{2}$。\n- 未经限制的候选面守恒状态：$\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$。\n- 未经限制的候选面原始状态：$\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}}) = (0.05, 6000, 1000)$。\n\n计算守恒正性条件 $p(\\theta)  0$ 的最小正根，并将其表示为 $\\theta_{+}^{\\mathrm{cons}}$。以纯数字形式表达你的最终数值答案。将答案四舍五入至四位有效数字。", "solution": "该问题陈述被评估为具有科学依据、良定、客观且自洽。它是计算流体动力学数值方法分析中的一个标准问题。所提供的数据是一致且物理上合理的。因此，该问题被认为是有效的，下面提供完整解答。\n\n核心任务是推导并比较在线性缩放限制器应用于原始变量 $\\boldsymbol{W} = (\\rho, u, p)$ 或守恒变量 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)$ 时，保持密度 $\\rho$ 和压力 $p$ 正性的条件。\n\n首先，我们定义变量之间的关系。守恒变量为 $\\boldsymbol{U} = (\\rho, m, \\tau)$，其中 $m = \\rho u$ 是动量密度，$\\tau = \\rho E$ 是总能量密度。单位质量总能量 $E$ 是单位质量内能 $e$ 和单位质量动能之和，$E = e + \\frac{1}{2}u^2$。对于理想气体，压力 $p$ 与内能的关系为 $p = (\\gamma-1)\\rho e$。代入 $e = E - \\frac{1}{2}u^2$ 得到 $p = (\\gamma-1)(\\rho E - \\frac{1}{2}\\rho u^2)$。直接用守恒变量表示此式，即可得到给定的状态方程：\n$$p = (\\gamma - 1)\\left(\\tau - \\frac{1}{2}\\frac{m^2}{\\rho}\\right)$$\n\n### 原始变量限制的正性条件\n\n当对原始变量 $\\boldsymbol{W} = (\\rho, u, p)$ 进行限制时，受限状态 $\\boldsymbol{W}(\\theta)$ 是单元平均状态 $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p})$ 和未经限制的面状态 $\\boldsymbol{W}^{*} = (\\rho^{*}_{\\mathrm{prim}}, u^{*}_{\\mathrm{prim}}, p^{*}_{\\mathrm{prim}})$ 之间的线性插值。\n$$\\boldsymbol{W}(\\theta) = \\bar{\\boldsymbol{W}} + \\theta(\\boldsymbol{W}^{*} - \\bar{\\boldsymbol{W}})$$\n受限状态的分量为：\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho})$$\n$$p(\\theta) = \\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p})$$\n正性约束 $\\rho(\\theta)  0$ 和 $p(\\theta)  0$ 是关于 $\\theta$ 的线性不等式。\n\n对于密度正性，$\\bar{\\rho} + \\theta(\\rho^{*}_{\\mathrm{prim}} - \\bar{\\rho})  0$。如果 $\\rho^{*}_{\\mathrm{prim}} \\ge \\bar{\\rho}$，由于 $\\bar{\\rho}  0$，此式对于 $\\theta \\ge 0$ 恒成立。如果 $\\rho^{*}_{\\mathrm{prim}}  \\bar{\\rho}$，条件变为 $\\theta  \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}_{\\mathrm{prim}}}$。\n\n对于压力正性，$\\bar{p} + \\theta(p^{*}_{\\mathrm{prim}} - \\bar{p})  0$。如果 $p^{*}_{\\mathrm{prim}} \\ge \\bar{p}$，由于 $\\bar{p}  0$，此式对于 $\\theta \\ge 0$ 恒成立。如果 $p^{*}_{\\mathrm{prim}}  \\bar{p}$，条件为 $\\theta  \\frac{\\bar{p}}{\\bar{p} - p^{*}_{\\mathrm{prim}}}$。\n\n由于 $\\theta \\in [0, 1]$，总体要求是 $\\theta$ 必须小于1以及从这些线性不等式导出的任何上界。关键的观察是，如果单元平均状态（$\\theta=0$）和未经限制的面状态（$\\theta=1$）都具有正的密度和压力，那么任何 $\\theta \\in [0, 1]$ 的线性组合也将具有正的密度和压力。\n\n### 守恒变量限制的正性条件\n\n当对守恒变量 $\\boldsymbol{U} = (\\rho, m, \\tau)$ 进行限制时，受限状态为：\n$$\\boldsymbol{U}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}})$$\n令 $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$，各分量为：\n$$\\rho(\\theta) = \\bar{\\rho} + \\theta\\Delta\\rho$$\n$$m(\\theta) = \\bar{m} + \\theta\\Delta m$$\n$$\\tau(\\theta) = \\bar{\\tau} + \\theta\\Delta\\tau$$\n\n密度正性约束 $\\rho(\\theta)  0$ 的形式与原始变量情况相同：\n$$\\bar{\\rho} + \\theta\\Delta\\rho  0$$\n这是一个关于 $\\theta$ 的线性不等式。如果 $\\Delta\\rho  0$，它施加的约束为 $\\theta  \\frac{\\bar{\\rho}}{-\\Delta\\rho} = \\frac{\\bar{\\rho}}{\\bar{\\rho} - \\rho^{*}}$。\n\n压力正性约束 $p(\\theta)  0$ 更为复杂。我们使用带有受限守恒变量的状态方程。由于 $\\gamma-1  0$，条件 $p(\\theta)  0$ 等价于：\n$$\\tau(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)}  0$$\n为了避免除以一个依赖于 $\\theta$ 的项，我们乘以 $2\\rho(\\theta)$。由于我们正在强制要求 $\\rho(\\theta)  0$，这不会改变不等式的方向：\n$$2\\rho(\\theta)\\tau(\\theta) - m(\\theta)^2  0$$\n代入受限守恒变量的线性表达式：\n$$2(\\bar{\\rho} + \\theta\\Delta\\rho)(\\bar{\\tau} + \\theta\\Delta\\tau) - (\\bar{m} + \\theta\\Delta m)^2  0$$\n展开此表达式得到一个关于 $\\theta$ 的二次不等式，形式为 $A\\theta^2 + B\\theta + C  0$：\n$$2(\\bar{\\rho}\\bar{\\tau} + \\theta(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho) + \\theta^2\\Delta\\rho\\Delta\\tau) - (\\bar{m}^2 + 2\\theta\\bar{m}\\Delta m + \\theta^2(\\Delta m)^2)  0$$\n按 $\\theta$ 的幂次整理：\n$$(2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2)\\theta^2 + 2(\\bar{\\rho}\\Delta\\tau+\\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)\\theta + (2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2)  0$$\n系数为：\n$$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2$$\n$$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m)$$\n$$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2$$\n常数项 $C$ 对应于 $\\theta=0$ 时的状态。我们可以验证它与单元平均压力成正比：\n$$C = 2\\bar{\\rho}(\\bar{\\rho}\\bar{E}) - (\\bar{\\rho}\\bar{u})^2 = 2\\bar{\\rho}^2(\\bar{E} - \\frac{1}{2}\\bar{u}^2) = 2\\bar{\\rho}^2\\left(\\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}}\\right) = \\frac{2\\bar{\\rho}\\bar{p}}{\\gamma - 1}$$\n由于对于一个有效的单元平均值，$\\bar{\\rho}  0$ 且 $\\bar{p}  0$，因此 $C  0$。\n\n### 鲁棒性的比较和准则\n\n在守恒变量限制下 $p(\\theta)$ 的非线性源于动能项 $\\frac{1}{2}\\rho u^2 = \\frac{1}{2}m^2/\\rho$。当 $m$ 和 $\\rho$ 是 $\\theta$ 的线性函数时，它们的比值不是。这导致了压力正性的二次不等式。一个二次函数 $f(\\theta) = A\\theta^2 + B\\theta + C$ 是一条抛物线。即使 $p(0)  0$（即 $C  0$）和 $p(1)  0$，如果抛物线在此区间内有根且开口向下（$A  0$），压力 $p(\\theta)$ 也可能在某个 $\\theta \\in (0,1)$ 变为负值。这是鲁棒性的一个严重失效。相比之下，在原始变量中进行限制会得到 $\\rho(\\theta)$ 和 $p(\\theta)$ 均为线性函数。一个连接两个正端点的线性函数保证在整个区间内都为正。\n\n因此，更严格的约束来自于守恒变量限制下压力可能出现的非单调行为。为了在保持正性的同时最大化鲁棒性，准则是**在原始变量 $(\\rho, u, p)$ 的空间中执行限制过程**。这确保了正性约束是线性的且容易满足。一个常见的鲁棒算法是：1) 将原始变量重构到单元面，2) 对原始变量应用限制器以获得受限的面状态，以及 3) 将受限的原始面状态转换回守恒变量以进行通量计算。\n\n### 守恒变量限制的数值评估\n\n给定以下数据：\n- $\\gamma = 1.4$\n- $\\bar{\\boldsymbol{W}} = (\\bar{\\rho}, \\bar{u}, \\bar{p}) = (0.1, 1000, 10000)$\n- $\\boldsymbol{U}^{*} = (\\rho^{*}, m^{*}, \\tau^{*}) = (0.05, 300, 10000)$\n\n首先，我们计算单元平均守恒状态 $\\bar{\\boldsymbol{U}} = (\\bar{\\rho}, \\bar{m}, \\bar{\\tau})$。\n$\\bar{\\rho} = 0.1$\n$\\bar{m} = \\bar{\\rho}\\bar{u} = 0.1 \\times 1000 = 100$\n单位质量总能量为 $\\bar{E} = \\frac{\\bar{p}}{(\\gamma - 1)\\bar{\\rho}} + \\frac{1}{2}\\bar{u}^{2}$:\n$\\bar{E} = \\frac{10000}{(1.4 - 1) \\times 0.1} + \\frac{1}{2}(1000)^2 = \\frac{10000}{0.04} + 500000 = 250000 + 500000 = 750000$\n总能量密度为 $\\bar{\\tau} = \\bar{\\rho}\\bar{E} = 0.1 \\times 750000 = 75000$。\n所以, $\\bar{\\boldsymbol{U}} = (0.1, 100, 75000)$。\n\n接下来，我们计算差值 $\\Delta\\boldsymbol{U} = \\boldsymbol{U}^{*} - \\bar{\\boldsymbol{U}}$。\n$\\Delta\\rho = \\rho^{*} - \\bar{\\rho} = 0.05 - 0.1 = -0.05$\n$\\Delta m = m^{*} - \\bar{m} = 300 - 100 = 200$\n$\\Delta\\tau = \\tau^{*} - \\bar{\\tau} = 10000 - 75000 = -65000$\n\n现在，我们为二次不等式 $p(\\theta)0$ 计算系数 $A, B, C$。\n$A = 2\\Delta\\rho\\Delta\\tau - (\\Delta m)^2 = 2(-0.05)(-65000) - (200)^2 = 6500 - 40000 = -33500$\n$B = 2(\\bar{\\rho}\\Delta\\tau + \\bar{\\tau}\\Delta\\rho - \\bar{m}\\Delta m) = 2(0.1(-65000) + 75000(-0.05) - 100(200))$\n$B = 2(-6500 - 3750 - 20000) = 2(-30250) = -60500$\n$C = 2\\bar{\\rho}\\bar{\\tau} - \\bar{m}^2 = 2(0.1)(75000) - (100)^2 = 15000 - 10000 = 5000$\n\n压力正性条件是二次不等式：\n$$-33500\\theta^2 - 60500\\theta + 5000  0$$\n两边同除以 $-500$ 会使不等号反向：\n$$67\\theta^2 + 121\\theta - 10  0$$\n二次方程 $67\\theta^2 + 121\\theta - 10 = 0$ 的根由求根公式 $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 给出：\n$$\\theta = \\frac{-121 \\pm \\sqrt{121^2 - 4(67)(-10)}}{2(67)} = \\frac{-121 \\pm \\sqrt{14641 + 2680}}{134} = \\frac{-121 \\pm \\sqrt{17321}}{134}$$\n两个根是：\n$$\\theta_1 = \\frac{-121 - \\sqrt{17321}}{134} \\approx \\frac{-121 - 131.609}{134} \\approx -1.8851$$\n$$\\theta_2 = \\frac{-121 + \\sqrt{17321}}{134} \\approx \\frac{-121 + 131.609}{134} \\approx 0.079174$$\n由于抛物线 $67\\theta^2 + 121\\theta - 10$ 开口向上，该不等式在两根之间成立，即对于 $\\theta \\in (\\theta_1, \\theta_2) \\approx (-1.8851, 0.079174)$ 成立。\n参数 $\\theta$ 也必须在区间 $[0, 1]$ 内。这些范围的交集是 $[0, \\theta_2)$。因此，$\\theta$ 的上限是二次方程的最小正根，我们将其表示为 $\\theta_{+}^{\\mathrm{cons}}$。\n$$\\theta_{+}^{\\mathrm{cons}} = \\frac{-121 + \\sqrt{17321}}{134} \\approx 0.0791736...$$\n为完整起见，密度正性条件为 $\\rho(\\theta) = 0.1 - 0.05\\theta  0$，这给出 $\\theta  \\frac{0.1}{0.05}=2$。这是一个比压力约束弱得多的约束。\n$\\theta$ 的容许值受压力约束的限制。界定可接受范围的最小正根是 $\\theta_{+}^{\\mathrm{cons}}$。四舍五入到四位有效数字，我们得到 $0.07917$。", "answer": "$$\n\\boxed{0.07917}\n$$", "id": "3307215"}, {"introduction": "隐式求解器依赖于雅可比矩阵来实现高效收敛，尤其是在求解刚性问题时。本练习深入探讨了计算粘性通量雅可比矩阵的复杂性，特别是当输运性质（如粘度）强烈依赖于温度时（例如Sutherland定律）。通过比较简化的“冻结粘度”方法与完全一致的线性化方法，本练习突出了在具有挑战性的高超声速流动条件下，精确的雅可比矩阵对牛顿法收敛速度的显著影响。[@problem_id:3307208]", "problem": "您需要分析在可压缩流的基于密度的格式中，黏性-温度线性化对黏性通量雅可比矩阵的影响。考虑一个垂直于壁面的一维、定常高超声速边界层段，其中的变量在计算流体力学(CFD)基于密度的守恒变量集中定义。您将处理一个简化的黏性子系统，其中密度被视为给定的常数，未知量为单位体积的守恒$x$-动量$m$和总能量$E_{\\mathrm{tot}}$。热力学模型为量热完全理想气体。输运性质遵循Sutherland定律。\n\n使用的基本原理和定义：\n- 理想气体热力学：$p = \\rho R T$，$c_p - c_v = R$，以及 $\\gamma = \\frac{c_p}{c_v}$。对于量热完全空气，取 $R = 287\\,\\mathrm{J/(kg\\cdot K)}$，$\\gamma = 1.4$，因此 $c_v = \\frac{R}{\\gamma - 1}$ 且 $c_p = c_v + R$。\n- 守恒变量：$\\rho$是密度，$m = \\rho u$是$x$-动量，$E_{\\mathrm{tot}} = \\rho E$其中$E = e + \\frac{1}{2}u^2$是比总能，$e = c_v T$是比内能。\n- 温度作为守恒变量的函数：\n$$\nT(U) = \\frac{1}{c_v}\\left(\\frac{E_{\\mathrm{tot}}}{\\rho} - \\frac{1}{2}\\left(\\frac{m}{\\rho}\\right)^2\\right).\n$$\n- 动力黏度的Sutherland定律：\n$$\n\\mu(T) = \\mu_{\\mathrm{ref}}\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)^{3/2}\\frac{T_{\\mathrm{ref}} + S}{T + S},\n$$\n对于空气，$\\mu_{\\mathrm{ref}} = 1.716\\times 10^{-5}\\,\\mathrm{kg/(m\\cdot s)}$，$T_{\\mathrm{ref}} = 273.15\\,\\mathrm{K}$，以及 $S = 110.4\\,\\mathrm{K}$。\n- 通过普朗特数(Prandtl number (Pr))计算热导率：$k(T) = \\mu(T)\\,c_p/\\mathrm{Pr}$，其中$\\mathrm{Pr} = 0.72$。\n- 通过跨越控制体厚度$y$的线性梯度建模的黏性剪切应力和热通量：\n$$\n\\tau = \\mu(T)\\frac{u - u_w}{y},\\quad q = -\\,k(T)\\frac{T - T_w}{y},\n$$\n其中$u_w$和$T_w$分别为壁面速度和壁面温度。\n\n由牛顿法驱动至零的非线性残差定义在单个控制体上，相对于由一个给定的“真实”高超声速边界层状态构建的目标黏性通量：\n- 动量残差：\n$$\nR_1(m,E_{\\mathrm{tot}}) = \\mu(T(U))\\frac{u(U) - u_w}{y} - \\tau_{\\mathrm{target}},\n$$\n- 能量残差：\n$$\nR_2(m,E_{\\mathrm{tot}}) = -\\,k(T(U))\\frac{T(U) - T_w}{y} - q_{\\mathrm{target}},\n$$\n其中 $u(U) = m/\\rho$，目标值 $\\tau_{\\mathrm{target}}$ 和 $q_{\\mathrm{target}}$ 是通过相同的本构关系由给定的“真实”状态 $(u_{\\mathrm{true}},T_{\\mathrm{true}})$ 计算得出。\n\n您的任务：\n1. 从第一性原理出发，通过应用链式法则来包含通过Sutherland定律体现的$T(U)$依赖关系，推导一致的黏性通量雅可比矩阵项 $\\frac{\\partial R_i}{\\partial m}$ 和 $\\frac{\\partial R_i}{\\partial E_{\\mathrm{tot}}}$，$i=1,2$。同时，推导“冻结黏性”线性化，其中黏性在对温度求导时被视为常数（即，忽略 $\\mathrm{d}\\mu/\\mathrm{d}T$），但保留梯度中出现的对$u(U)$和$T(U)$的依赖关系。\n2. 对以下每个测试用例，实现两种雅可比矩阵，并从一个初始猜测值 $U_0 = (m_0, E_{\\mathrm{tot},0})$ 执行单步牛顿迭代 $\\Delta U$。对于每个用例，计算欧几里得范数下降比\n$$\nr = \\frac{\\left\\|\\mathbf{R}(U_0 + \\Delta U)\\right\\|_2}{\\left\\|\\mathbf{R}(U_0)\\right\\|_2},\n$$\n其中 $\\mathbf{R} = (R_1,R_2)$。使用一致性雅可比矩阵计算 $r_{\\mathrm{consistent}}$，使用冻结黏性雅可比矩阵计算 $r_{\\mathrm{frozen}}$。这些比率是无量纲的，应以浮点数形式报告。\n\n科学真实性和单位：\n- 在国际单位制（SI）中使用上述常数和关系式。所有输入和计算都必须使用SI单位。报告的比率是无量纲的。\n\n测试套件（每个用例均使用所提供的常数；目标值由“真实”状态计算得出）：\n- 用例1（中等高超声速梯度）：\n    - $\\rho = 0.25\\,\\mathrm{kg/m^3}$，$y = 1.0\\times 10^{-4}\\,\\mathrm{m}$，$u_w = 0\\,\\mathrm{m/s}$，$T_w = 300\\,\\mathrm{K}$，\n    - $u_{\\mathrm{true}} = 1500\\,\\mathrm{m/s}$，$T_{\\mathrm{true}} = 2000\\,\\mathrm{K}$，\n    - 初始猜测值：$u_0 = 750\\,\\mathrm{m/s}$，$T_0 = 1150\\,\\mathrm{K}$。\n- 用例2（强高超声速加热，更薄的层）：\n    - $\\rho = 0.18\\,\\mathrm{kg/m^3}$，$y = 5.0\\times 10^{-5}\\,\\mathrm{m}$，$u_w = 0\\,\\mathrm{m/s}$，$T_w = 300\\,\\mathrm{K}$，\n    - $u_{\\mathrm{true}} = 2500\\,\\mathrm{m/s}$，$T_{\\mathrm{true}} = 3500\\,\\mathrm{K}$，\n    - 初始猜测值：$u_0 = 1750\\,\\mathrm{m/s}$，$T_0 = 1900\\,\\mathrm{K}$。\n- 用例3（壁面加热的冷却层）：\n    - $\\rho = 0.15\\,\\mathrm{kg/m^3}$，$y = 2.0\\times 10^{-4}\\,\\mathrm{m}$，$u_w = 0\\,\\mathrm{m/s}$，$T_w = 1000\\,\\mathrm{K}$，\n    - $u_{\\mathrm{true}} = 2000\\,\\mathrm{m/s}$，$T_{\\mathrm{true}} = 600\\,\\mathrm{K}$，\n    - 初始猜测值：$u_0 = 1200\\,\\mathrm{m/s}$，$T_0 = 800\\,\\mathrm{K}$。\n\n对于每个用例，构建\n- $m_{\\mathrm{true}} = \\rho\\,u_{\\mathrm{true}}$ 和 $E_{\\mathrm{tot},\\mathrm{true}} = \\rho\\left(c_v T_{\\mathrm{true}} + \\frac{1}{2}u_{\\mathrm{true}}^2\\right)$,\n- $m_0 = \\rho\\,u_0$ 和 $E_{\\mathrm{tot},0} = \\rho\\left(c_v T_0 + \\frac{1}{2}u_0^2\\right)$,\n- $\\tau_{\\mathrm{target}} = \\mu(T_{\\mathrm{true}})\\frac{u_{\\mathrm{true}} - u_w}{y}$ 和 $q_{\\mathrm{target}} = -\\,k(T_{\\mathrm{true}})\\frac{T_{\\mathrm{true}} - T_w}{y}$。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起，依次对应于用例1到3的六个比率 $\\left[r_{\\mathrm{consistent}}^{(1)}, r_{\\mathrm{frozen}}^{(1)}, r_{\\mathrm{consistent}}^{(2)}, r_{\\mathrm{frozen}}^{(2)}, r_{\\mathrm{consistent}}^{(3)}, r_{\\mathrm{frozen}}^{(3)}\\right]$。例如，“[r1_consistent,r1_frozen,r2_consistent,r2_frozen,r3_consistent,r3_frozen]”。", "solution": "该问题是有效的，因为它在科学上基于计算流体力学的原理，是适定的，并包含了唯一解所需的所有信息。所提供的模型和常数是分析可压缩流的标准。\n\n任务是分析牛顿-拉夫逊迭代在求解代表一维高超声速边界层中黏性通量的两个非线性方程组时的性能。我们将比较使用完全一致的雅可比矩阵与“冻结黏性”近似时的收敛行为。\n\n我们系统的状态向量是 $U = \\begin{pmatrix} m \\\\ E_{\\mathrm{tot}} \\end{pmatrix}$，其中 $m$ 是单位体积动量，$E_{\\mathrm{tot}}$ 是单位体积总能量。密度 $\\rho$ 被视为给定的常数参数。待求解的非线性残差系统为 $\\mathbf{R}(U) = \\mathbf{0}$，其中：\n$$\n\\mathbf{R}(U) = \\begin{pmatrix} R_1(U) \\\\ R_2(U) \\end{pmatrix} = \\begin{pmatrix} \\mu(T)\\frac{u - u_w}{y} - \\tau_{\\mathrm{target}} \\\\ -k(T)\\frac{T - T_w}{y} - q_{\\mathrm{target}} \\end{pmatrix}\n$$\n\n速度 $u$ 和温度 $T$ 是状态向量 $U$ 的函数。该关系从守恒变量的定义中导出：\n$m = \\rho u \\implies u(U) = m/\\rho$。\n$E_{\\mathrm{tot}} = \\rho (e + \\frac{1}{2}u^2) = \\rho(c_v T + \\frac{1}{2} (m/\\rho)^2)$。\n求解温度可得：\n$$\nT(U) = \\frac{1}{c_v} \\left( \\frac{E_{\\mathrm{tot}}}{\\rho} - \\frac{m^2}{2\\rho^2} \\right)\n$$\n\n牛顿法的单步迭代将初始猜测值 $U_0$ 更新为新状态 $U_1 = U_0 + \\Delta U$，其中更新量 $\\Delta U$ 通过求解线性系统得到：\n$$\nJ(U_0) \\Delta U = -\\mathbf{R}(U_0)\n$$\n此处，$J(U_0)$ 是残差向量 $\\mathbf{R}$ 在状态 $U_0$ 处求值的雅可比矩阵：\n$$\nJ = \\frac{\\partial \\mathbf{R}}{\\partial U} = \\begin{pmatrix} \\frac{\\partial R_1}{\\partial m}  \\frac{\\partial R_1}{\\partial E_{\\mathrm{tot}}} \\\\ \\frac{\\partial R_2}{\\partial m}  \\frac{\\partial R_2}{\\partial E_{\\mathrm{tot}}} \\end{pmatrix}\n$$\n\n为了推导雅可比矩阵的各项，我们首先需要原始变量 $u$ 和 $T$ 相对于守恒变量 $m$ 和 $E_{\\mathrm{tot}}$ 的偏导数：\n$\\frac{\\partial u}{\\partial m} = \\frac{1}{\\rho}$\n$\\frac{\\partial u}{\\partial E_{\\mathrm{tot}}} = 0$\n$\\frac{\\partial T}{\\partial m} = \\frac{1}{c_v} \\left( -\\frac{2m}{2\\rho^2} \\right) = -\\frac{m}{c_v\\rho^2} = -\\frac{u}{c_v\\rho}$\n$\\frac{\\partial T}{\\partial E_{\\mathrm{tot}}} = \\frac{1}{c_v} \\left( \\frac{1}{\\rho} \\right) = \\frac{1}{c_v\\rho}$\n\n接下来，我们需要黏度 $\\mu$ 对温度 $T$ 的导数。Sutherland定律由 $\\mu(T) = \\mu_{\\mathrm{ref}}\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right)^{3/2}\\frac{T_{\\mathrm{ref}} + S}{T + S}$ 给出。其导数为：\n$$\n\\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} = \\mu(T) \\left[ \\frac{3}{2T} - \\frac{1}{T+S} \\right] = \\mu(T) \\frac{3(T+S) - 2T}{2T(T+S)} = \\mu(T) \\frac{T + 3S}{2T(T+S)}\n$$\n热导率为 $k(T) = \\mu(T) c_p / \\mathrm{Pr}$，因此其导数为 $\\frac{\\mathrm{d}k}{\\mathrm{d}T} = \\frac{c_p}{\\mathrm{Pr}} \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T}$。\n\n**1. 一致性雅可比矩阵推导**\n\n一致性雅可比矩阵考虑了所有依赖关系，包括 $\\mu(T(U))$ 和 $k(T(U))$。我们应用链式法则和乘法法则。\n\n雅可比矩阵项 $\\frac{\\partial R_1}{\\partial m}$：\n$$\n\\frac{\\partial R_1}{\\partial m} = \\frac{1}{y} \\frac{\\partial}{\\partial m} \\left[ \\mu(T) (u - u_w) \\right] = \\frac{1}{y} \\left[ \\frac{\\partial \\mu}{\\partial m}(u - u_w) + \\mu \\frac{\\partial u}{\\partial m} \\right]\n$$\n使用链式法则 $\\frac{\\partial \\mu}{\\partial m} = \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} \\frac{\\partial T}{\\partial m}$：\n$$\n\\frac{\\partial R_1}{\\partial m} = \\frac{1}{y} \\left[ \\left(\\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} \\frac{\\partial T}{\\partial m}\\right)(u - u_w) + \\mu \\frac{\\partial u}{\\partial m} \\right] = \\frac{1}{y} \\left[ \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} \\left(-\\frac{u}{c_v\\rho}\\right) (u - u_w) + \\mu \\frac{1}{\\rho} \\right] = \\frac{1}{y\\rho} \\left[ \\mu - \\frac{u(u-u_w)}{c_v}\\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} \\right]\n$$\n\n雅可比矩阵项 $\\frac{\\partial R_1}{\\partial E_{\\mathrm{tot}}}$：\n$$\n\\frac{\\partial R_1}{\\partial E_{\\mathrm{tot}}} = \\frac{1}{y} \\frac{\\partial}{\\partial E_{\\mathrm{tot}}} \\left[ \\mu(T) (u - u_w) \\right] = \\frac{1}{y} \\left[ \\frac{\\partial \\mu}{\\partial E_{\\mathrm{tot}}}(u - u_w) + \\mu \\frac{\\partial u}{\\partial E_{\\mathrm{tot}}} \\right]\n$$\n由于 $\\frac{\\partial u}{\\partial E_{\\mathrm{tot}}} = 0$ 且 $\\frac{\\partial \\mu}{\\partial E_{\\mathrm{tot}}} = \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T}\\frac{\\partial T}{\\partial E_{\\mathrm{tot}}}$：\n$$\n\\frac{\\partial R_1}{\\partial E_{\\mathrm{tot}}} = \\frac{1}{y} \\left[ \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} \\left(\\frac{1}{c_v\\rho}\\right) (u - u_w) \\right] = \\frac{u-u_w}{y c_v \\rho} \\frac{\\mathrm{d}\\mu}{\\mathrm{d}T}\n$$\n\n雅可比矩阵项 $\\frac{\\partial R_2}{\\partial m}$：\n$$\n\\frac{\\partial R_2}{\\partial m} = -\\frac{1}{y} \\frac{\\partial}{\\partial m} \\left[ k(T)(T - T_w) \\right] = -\\frac{1}{y} \\left[ \\frac{\\partial k}{\\partial m}(T - T_w) + k \\frac{\\partial T}{\\partial m} \\right]\n$$\n使用链式法则 $\\frac{\\partial k}{\\partial m} = \\frac{\\mathrm{d}k}{\\mathrm{d}T}\\frac{\\partial T}{\\partial m}$：\n$$\n\\frac{\\partial R_2}{\\partial m} = -\\frac{1}{y} \\left[ \\frac{\\mathrm{d}k}{\\mathrm{d}T}\\frac{\\partial T}{\\partial m}(T - T_w) + k \\frac{\\partial T}{\\partial m} \\right] = -\\frac{1}{y} \\frac{\\partial T}{\\partial m} \\left[ (T - T_w)\\frac{\\mathrm{d}k}{\\mathrm{dT}} + k \\right]\n$$\n代入 $\\frac{\\partial T}{\\partial m} = -u/(c_v\\rho)$：\n$$\n\\frac{\\partial R_2}{\\partial m} = \\frac{u}{y c_v \\rho} \\left[ k + (T - T_w)\\frac{\\mathrm{d}k}{\\mathrm{d}T} \\right]\n$$\n\n雅可比矩阵项 $\\frac{\\partial R_2}{\\partial E_{\\mathrm{tot}}}$：\n$$\n\\frac{\\partial R_2}{\\partial E_{\\mathrm{tot}}} = -\\frac{1}{y} \\frac{\\partial}{\\partial E_{\\mathrm{tot}}} \\left[ k(T)(T - T_w) \\right] = -\\frac{1}{y} \\left[ \\frac{\\partial k}{\\partial E_{\\mathrm{tot}}}(T - T_w) + k \\frac{\\partial T}{\\partial E_{\\mathrm{tot}}} \\right]\n$$\n与上述类似，我们提出因子 $\\frac{\\partial T}{\\partial E_{\\mathrm{tot}}}$：\n$$\n\\frac{\\partial R_2}{\\partial E_{\\mathrm{tot}}} = -\\frac{1}{y} \\frac{\\partial T}{\\partial E_{\\mathrm{tot}}} \\left[ (T - T_w)\\frac{\\mathrm{d}k}{\\mathrm{d}T} + k \\right] = -\\frac{1}{y c_v \\rho} \\left[ k + (T - T_w)\\frac{\\mathrm{d}k}{\\mathrm{dT}} \\right]\n$$\n\n**2. 冻结黏性雅可比矩阵推导**\n\n“冻结黏性”雅可比矩阵是CFD求解器中一种常见的简化。它通过在微分过程中将输运性质 $\\mu$ 和 $k$ 视为关于 $T$ 的常数（即，设置 $\\frac{\\mathrm{d}\\mu}{\\mathrm{d}T} = 0$ 和 $\\frac{\\mathrm{d}k}{\\mathrm{d}T} = 0$）来获得。$\\mu$ 和 $k$ 的值本身仍然在当前温度 $T(U_0)$ 下计算。将此简化应用于一致性雅可比矩阵表达式，可得：\n\n$\\frac{\\partial R_1}{\\partial m} = \\frac{1}{y\\rho} \\left[ \\mu \\right]$\n$\\frac{\\partial R_1}{\\partial E_{\\mathrm{tot}}} = 0$\n$\\frac{\\partial R_2}{\\partial m} = \\frac{u}{y c_v \\rho} \\left[ k \\right]$\n$\\frac{\\partial R_2}{\\partial E_{\\mathrm{tot}}} = -\\frac{1}{y c_v \\rho} \\left[ k \\right]$\n\n这个简化的雅可比矩阵是下三角矩阵，这可以提供计算上的优势。然而，其精度的降低通常会导致牛顿-拉夫逊方法的收敛速度变慢，这一点将通过计算指定测试用例下两种雅可比矩阵公式的残差范数下降比 $r = \\frac{\\left\\|\\mathbf{R}(U_0 + \\Delta U)\\right\\|_2}{\\left\\|\\mathbf{R}(U_0)\\right\\|_2}$ 来证明。", "answer": "[0.00078726,0.01358331,0.00000000,0.48518928,0.00000454,1.48834459]", "id": "3307208"}]}