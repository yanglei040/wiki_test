{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本练习旨在将 HLLC 黎曼求解器的抽象公式转化为具体的计算步骤。通过为一个给定的黎曼问题手动计算 HLLC 数值通量，您将熟悉求解器的内部工作机制，包括如何估算波速、如何确定界面所处的区域，以及如何计算“星区”（star region）状态，从而为您更深入的探索打下坚实的基础。", "problem": "考虑理想气体的一维欧拉方程，其比热比为 $\\gamma$，守恒变量为 $U = (\\rho,\\ \\rho u,\\ E)^{\\mathsf{T}}$，由通量 $F(U) = \\big(\\rho u,\\ \\rho u^{2} + p,\\ u\\,(E + p)\\big)^{\\mathsf{T}}$ 控制，其中 $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2}\\,\\rho\\,u^{2}$。界面上的黎曼问题具有左右原始状态 $U_{L} = (\\rho_{L}, u_{L}, p_{L})$ 和 $U_{R} = (\\rho_{R}, u_{R}, p_{R})$。假设理想气体的声速为 $a = \\sqrt{\\gamma p/\\rho}$。设数值状态为 $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (0.8,\\ 1.0,\\ 0.5)$，$U_{R} = (\\rho_{R}, u_{R}, p_{R}) = (1.2,\\ -0.5,\\ 0.7)$，且 $\\gamma = 1.4$。\n\n使用 Harten–Lax–van Leer–Contact (HLLC) 接触间断分解黎曼求解器，确定在界面处 HLLC 数值通量的动量通量分量，该分量表示为 $F_{\\mathrm{HLLC}}(U_{L}, U_{R})$ 的第二个分量，为一个标量。为使波速估计具体化，使用 Davis 估计来计算边界信号速度，$S_{L} = \\min\\{u_{L} - a_{L},\\ u_{R} - a_{R}\\}$ 和 $S_{R} = \\max\\{u_{L} + a_{L},\\ u_{R} + a_{R}\\}$，其中 $a_{L} = \\sqrt{\\gamma p_{L}/\\rho_{L}}$ 和 $a_{R} = \\sqrt{\\gamma p_{R}/\\rho_{R}}$。根据波速的符号确定适当的 HLLC 分支，构建由跨波的郎金-雨贡纽条件施加的星区状态和星区通量，然后计算界面处 $F_{\\mathrm{HLLC}}$ 的动量通量分量。\n\n将您的最终数值答案以单一无量纲标量的形式报告，并四舍五入到四位有效数字。", "solution": "该问题要求确定由给定的左右状态定义的黎曼问题在界面处的 Harten–Lax–van Leer–Contact (HLLC) 数值通量 $F_{\\mathrm{HLLC}}$ 的动量通量分量。控制方程为理想气体的一维欧拉方程。\n\n守恒变量向量为 $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量向量为 $F(U) = (\\rho u, \\rho u^2 + p, u(E + p))^{\\mathsf{T}}$。总能量密度 $E$ 通过理想气体状态方程与压力 $p$ 相关：$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2$。\n\nHLLC 通量 $F_{\\mathrm{HLLC}}(U_L, U_R)$ 是关于比率 $x/t=0$ 的分段常数函数，由波速估计 $S_L$、$S_M$ (接触间断) 和 $S_R$ 定义。在单元界面处（$x/t=0$），HLLC 通量的公式为：\n$$\nF_{\\text{HLLC}} =\n\\begin{cases}\nF_L  & \\text{if } 0 \\le S_L \\\\\nF_L^*  & \\text{if } S_L \\le 0 \\le S_M \\\\\nF_R^*  & \\text{if } S_M \\le 0 \\le S_R \\\\\nF_R  & \\text{if } S_R \\le 0\n\\end{cases}\n$$\n在单元界面处，我们计算 $x/t=0$ 处的通量。具体使用哪个公式取决于 $S_L$、$S_M$ 和 $S_R$ 的符号。我们必须首先计算这些波速。\n\n给定的原始变量是：\n左状态：$(\\rho_L, u_L, p_L) = (0.8, 1.0, 0.5)$\n右状态：$(\\rho_R, u_R, p_R) = (1.2, -0.5, 0.7)$\n比热比：$\\gamma = 1.4$\n\n首先，我们使用公式 $a = \\sqrt{\\gamma p / \\rho}$ 计算左右状态的声速。\n$$ a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 0.5}{0.8}} = \\sqrt{0.875} \\approx 0.935414 $$\n$$ a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 0.7}{1.2}} = \\sqrt{\\frac{0.98}{1.2}} \\approx 0.903696 $$\n\n接下来，我们计算最快左行和右行信号速度的 Davis 估计值 $S_L$ 和 $S_R$。\n$$ S_L = \\min\\{u_L - a_L, u_R - a_R\\} = \\min\\{1.0 - 0.935414, -0.5 - 0.903696\\} $$\n$$ S_L = \\min\\{0.064586, -1.403696\\} = -1.403696 $$\n$$ S_R = \\max\\{u_L + a_L, u_R + a_R\\} = \\max\\{1.0 + 0.935414, -0.5 + 0.903696\\} $$\n$$ S_R = \\max\\{1.935414, 0.403696\\} = 1.935414 $$\n\n现在，我们计算接触波的速度 $S_M$。其公式是通过强制星区中的压力 $p_L^*$ 和 $p_R^*$ 相等而导出的。\n$$ S_M = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)} $$\n我们计算分子和分母中的各项：\n分子：\n$$ N = (0.7 - 0.5) + (0.8)(1.0)(-1.403696 - 1.0) - (1.2)(-0.5)(1.935414 - (-0.5)) $$\n$$ N = 0.2 + 0.8(-2.403696) - (-0.6)(2.435414) $$\n$$ N = 0.2 - 1.922957 + 1.461248 = -0.261709 $$\n分母：\n$$ D = 0.8(-2.403696) - 1.2(2.435414) $$\n$$ D = -1.922957 - 2.922497 = -4.845454 $$\n所以，接触波速度为：\n$$ S_M = \\frac{-0.261709}{-4.845454} \\approx 0.054012 $$\n\n根据波速 $S_L \\approx -1.404$、$S_M \\approx 0.054$ 和 $S_R \\approx 1.935$，我们可以确定在 $x/t=0$ 处的界面位于哪个区域。我们观察到 $S_L  0  S_M$。因此，适用的通量是左星区的通量 $F_L^*$，因为满足条件 $S_L \\le 0 \\le S_M$。\n\n问题要求的是该通量向量的第二个分量，它代表动量通量。星区 $K \\in \\{L, R\\}$ 中的通量向量由 $F_K^* = (\\rho_K^* S_M, \\rho_K^* S_M^2 + p^*, S_M(E_K^* + p^*))^{\\mathsf{T}}$ 给出，其中 $u^*=S_M$ 和 $p^*$ 是星区中的均匀速度和压力。动量通量分量是第二个分量：\n$$ (F_L^*)_2 = \\rho_L^* S_M^2 + p^* $$\n我们需要计算左星区中的压力 $p^*$ 和密度 $\\rho_L^*$。\n压力 $p^*$ 由跨越 $S_L$ 波的郎金-雨贡纽条件给出：\n$$ p^* = p_L + \\rho_L(u_L - S_L)(u_L - S_M) $$\n$$ p^* = 0.5 + 0.8(1.0 - (-1.403696))(1.0 - 0.054012) $$\n$$ p^* = 0.5 + 0.8(2.403696)(0.945988) $$\n$$ p^* = 0.5 + 1.819397 \\approx 2.31940 $$\n\n密度 $\\rho_L^*$ 可通过跨越 $S_L$ 的质量守恒跳跃条件求得：\n$$ \\rho_L^* = \\rho_L \\frac{S_L - u_L}{S_L - S_M} $$\n$$ \\rho_L^* = 0.8 \\frac{-1.403696 - 1.0}{-1.403696 - 0.054012} = 0.8 \\frac{-2.403696}{-1.457708} $$\n$$ \\rho_L^* = 0.8 \\times 1.64901 \\approx 1.31921 $$\n\n最后，我们计算动量通量分量：\n$$ (F_L^*)_2 = p^* + \\rho_L^* S_M^2 $$\n$$ (F_L^*)_2 \\approx 2.31940 + (1.31921)(0.054012)^2 $$\n$$ (F_L^*)_2 \\approx 2.31940 + (1.31921)(0.0029173) $$\n$$ (F_L^*)_2 \\approx 2.31940 + 0.003848 $$\n$$ (F_L^*)_2 \\approx 2.323248 $$\n将结果四舍五入到四位有效数字，得到 $2.323$。", "answer": "$$\\boxed{2.323}$$", "id": "3330293"}, {"introduction": "一个优秀的数值格式不仅要准确，还必须在极端物理条件下保持鲁棒性，例如在天体物理学中常见的近真空状态。本练习 [@problem_id:3330269] 挑战您推导并应用 HLLC 公式于一个低密度、低压强的场景，并评估其保持物理量正性的能力。这不仅是对计算能力的考验，更是对数值格式在严苛应用中可靠性的一次深刻洞察。", "problem": "考虑理想气体的一维欧拉方程，其比热比为 $\\gamma$，并使用 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器。给定一个黎曼问题，其左右状态为 $U_{L}=(\\rho_{L},u_{L},p_{L})$ 和 $U_{R}=(\\rho_{R},u_{R},p_{R})$，其中声速为 $a=\\sqrt{\\gamma p/\\rho}$。HLLC 结构包含三个波，其波速为 $S_{L}", "solution": "本题要求推导 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器的关键量，并将其应用于一个特定的近真空状态。\n\n### 第 1 步：问题验证\n#### 第 1.1 步：提取的已知条件\n-   **系统：** 一维理想气体欧拉方程。\n-   **常数：** 比热比 $\\gamma$。\n-   **求解器：** Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器。\n-   **初始条件：** 一个黎曼问题，其左状态为 $U_{L}=(\\rho_{L},u_{L},p_{L})$，右状态为 $U_{R}=(\\rho_{R},u_{R},p_{R})$。\n-   **状态方程：** 声速 $a=\\sqrt{\\gamma p/\\rho}$。\n-   **HLLC 结构：** 三个波，波速为 $S_{L}", "answer": "$$\n\\boxed{\\begin{pmatrix} 6.312 \\times 10^{-4}  1.818 \\times 10^{-7}  1 \\end{pmatrix}}\n$$", "id": "3330269"}, {"introduction": "要真正理解一个数值方法的精髓，一种有效的方式是观察当其关键部件被扰动时会发生什么。本练习 [@problem_id:3330267] 是一个精巧的数值实验，它通过在 HLLC 求解器中故意引入接触波速 $S_M$ 的误差，来探究其对被动标量输运的影响。通过量化由此产生的非物理过冲（overshoot），您将亲身体会到精确解析接触间断对于维持解的物理真实性的至关重要性，从而深刻理解“接触间断解析”（contact-resolving）这一名称的含义。", "problem": "考虑附加了一个被动平流标量的一维可压缩欧拉方程，该方程作为一个守恒律系统，定义在空间域 $[0,1]$ 和时间 $t \\ge 0$ 上。未知守恒变量矢量为 $U = [\\rho, \\rho u, E, \\rho Y]^{\\top}$，其中 $\\rho$ 是密度， $u$ 是速度， $E$ 是总能量密度， $Y \\in [0,1]$ 是一个无量纲的被动质量分数。通量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(E + p), \\rho Y u]^{\\top}$，热力学封闭关系由理想气体定律 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ 给出，其中 $\\gamma  1$ 是比热比。被动标量 $Y$ 通过守恒变量 $\\rho Y$ 进行输运，并且不影响欧拉子系统的动力学。\n\n您将为欧拉子系统实现一个采用 Harten-Lax-van Leer with Contact (HLLC) 黎曼求解器的一阶有限体积法，并对被动标量进行一致的守恒通量计算。每个界面上的数值通量必须是由左、右状态构成的三波黎曼扇推导出的 HLLC 通量，使用根据局部信号速度计算的标准双边波速界和一个接触波速 $S_M$。为分离出接触波的作用，我们研究一个纯接触间断：两侧压力和速度相等，但密度和被动标量分数不同，因此其精确解是一个以速度 $u$ 移动的单一接触波，其中 $Y$ 被被动平流。在精确算术和精确的接触波速估计下，HLLC 求解器不应产生超出初始区间 $[Y_{\\min}, Y_{\\max}]$ 的被动标量值；然而，如果接触波速 $S_M$ 估算错误，$\\rho$ 和 $\\rho Y$ 的守恒更新会变得不一致，并导致 $Y = (\\rho Y)/\\rho$ 出现越界。我们通过在每个界面和时间步对接触波速估计引入一个受控扰动 $\\Delta S_M$来量化此效应，即将 HLLC 通量中的 $S_M$ 替换为 $S_M' = S_M + \\Delta S_M$。其中，$S_M$ 是从动量和压力平衡推导出的标准 HLLC 接触波速估计，而 $\\Delta S_M$ 是每个测试用例指定的恒定误差。\n\n您的实现必须：\n- 用 $N$ 个宽度为 $\\Delta x = 1/N$ 的均匀单元离散化计算域。\n- 在空间上使用周期性边界条件。\n- 使用显式向前欧拉时间积分器，Courant-Friedrichs-Lewy (CFL) 数为 $0.5$，以及自适应时间步长 $\\Delta t = \\text{CFL}\\cdot \\Delta x / \\max_{i} \\lambda_i$，其中 $\\lambda_i$ 是局部界面信号速度（取每个界面上左、右 HLL 速度绝对值的最大值）。\n- 对于每个界面黎曼问题，使用左、右守恒状态、给定 $\\gamma$ 的理想气体、基于局部速度和声速的 Davis 型左、右波速 $S_L$ 和 $S_R$ 双边估计，以及星区的压力和动量平衡得到的名义接触波速 $S_M$，来计算欧拉子系统的 HLLC 通量。然后，通过设置 $S_M' = S_M + \\Delta S_M$ 来强制使用扰动后的接触波速，并在包括 $\\rho Y$ 在内的所有守恒量的 HLLC 星区状态和通量公式中一致地使用 $S_M'$。\n- 在 $x_0 = 0.5$ 处初始化一个单一接触间断，其两侧具有均匀的压力和速度，但密度和被动标量不同，具体数值由以下每个测试用例指定。\n- 推进到指定的最终时间 $T$，移动距离不超过计算域的一小部分，以避免与第二个周期性间断相互作用。\n\n对于每次模拟，按如下方式定义被动标量超调。设 $Y_{\\text{num}}(x_i, T)$ 为时间 $T$ 时单元 $i$ 中的数值被动标量，并设 $Y_{\\min} = \\min(Y_L, Y_R)$ 和 $Y_{\\max} = \\max(Y_L, Y_R)$ 为初始物理边界。定义单元 $i$ 处的非负越界量为\n$$\n\\delta_i^{+} = \\max\\{\\,Y_{\\text{num}}(x_i,T) - Y_{\\max},\\, 0\\,\\}, \\quad\n\\delta_i^{-} = \\max\\{\\,Y_{\\min} - Y_{\\text{num}}(x_i,T),\\, 0\\,\\}.\n$$\n然后定义标量超调幅度为\n$$\n\\mathcal{O} = \\max_i \\left( \\max\\{ \\delta_i^{+}, \\delta_i^{-} \\} \\right).\n$$\n为将超调与接触波速误差联系起来，定义归一化灵敏度\n$$\n\\kappa = \\frac{\\mathcal{O}}{|\\Delta S_M| + \\varepsilon},\n$$\n其中 $\\varepsilon = 10^{-12}$ 是为了避免在精确接触情况 $\\Delta S_M = 0$ 时出现除零错误。\n\n您的任务是实现上述方法，并为以下五个测试用例中的每一个计算 $(\\mathcal{O}, \\kappa)$。所有用例均使用 $N = 200$ 个单元、$\\text{CFL} = 0.5$ 和最终时间 $T = 0.001$ 秒。所有物理量均采用国际单位制单位：密度单位为 $\\text{kg}/\\text{m}^3$，速度单位为 $\\text{m}/\\text{s}$，压力单位为 $\\text{Pa}$，时间单位为 $\\text{s}$。输出量 $\\mathcal{O}$ 和 $\\kappa$ 是无量纲的。\n\n测试套件（每个用例指定 $(\\rho_L, \\rho_R, u, p, Y_L, Y_R, \\gamma, \\Delta S_M)$）：\n- 用例 1: $(1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, 0.0)$\n- 用例 2: $(1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, 50.0)$\n- 用例 3: $(1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, -50.0)$\n- 用例 4: $(0.5, 5.0, 50.0, 100000.0, 0.0, 1.0, 1.4, 30.0)$\n- 用例 5: $(1.0, 3.0, 0.0, 100000.0, 0.1, 0.9, 1.4, 30.0)$\n\n算法要求和接受标准：\n- 从守恒律原理和理想气体关系出发；除上述规定外，不要引入额外的数值限制器或后处理。\n- 必须使用 HLLC 黎曼求解器进行通量计算，并且在星区状态构造和所有守恒量的通量计算中一致地应用扰动后的接触波速 $S_M' = S_M + \\Delta S_M$。\n- 对于每个测试用例，报告两个浮点数：超调幅度 $\\mathcal{O}$ 和归一化灵敏度 $\\kappa$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按 $[\\mathcal{O}_1, \\kappa_1, \\mathcal{O}_2, \\kappa_2, \\mathcal{O}_3, \\kappa_3, \\mathcal{O}_4, \\kappa_4, \\mathcal{O}_5, \\kappa_5]$ 的顺序排列。\n- 您的程序必须是一个完整、可运行的实现，它能生成所需的单行输出，不含任何额外文本。", "solution": "该问题要求实现一个一阶有限体积法，用于求解附加了被动平流标量的一维欧拉方程。该方法的核心是 Harten-Lax-van Leer with Contact (HLLC) 黎曼求解器，其中接触波速的估计值被有意扰动，以研究其对被动标量正定性的影响。\n\n### 1. 控制方程\n\n守恒律系统由 $\\partial_t U + \\partial_x F(U) = 0$ 给出，其中 $U$ 是守恒变量矢量，$F(U)$ 是通量矢量。它们定义如下：\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\\\ \\rho Y \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\\\ \\rho u Y \\end{pmatrix}\n$$\n此处，$\\rho$ 是质量密度，$u$ 是流体速度，$E$ 是单位体积的总能量，$Y$ 是被动标量的质量分数，且 $Y \\in [0, 1]$。该系统通过理想气体状态方程封闭，该方程将压力 $p$ 与守恒变量联系起来：\n$$\np = (\\gamma - 1) \\left( E - \\frac{1}{2}\\rho u^2 \\right) = (\\gamma - 1) \\left( E - \\frac{(\\rho u)^2}{2\\rho} \\right)\n$$\n其中 $\\gamma$ 是比热比。第四个方程 $\\partial_t(\\rho Y) + \\partial_x(\\rho u Y) = 0$ 描述了标量 $Y$ 的被动平流。\n\n### 2. 有限体积离散化\n\n空间域 $[0, 1]$ 被离散化为 $N$ 个均匀单元，索引为 $i$，每个单元宽度为 $\\Delta x = 1/N$。时间 $t$ 时的单元平均守恒量表示为 $U_i(t) \\approx \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} U(x, t) dx$。单元 $i$ 的半离散有限体积格式为：\n$$\n\\frac{dU_i}{dt} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\n其中 $F_{i+1/2}$ 是单元 $i$ 和单元 $i+1$ 之间界面上的数值通量。我们使用显式向前欧拉方法进行时间积分：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right)\n$$\n时间步长 $\\Delta t$ 通过自适应方式选择，以满足 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\Delta t = \\text{CFL} \\frac{\\Delta x}{\\max_{j} |\\lambda_{\\max, j}|}\n$$\n其中 $\\text{CFL}=0.5$，$|\\lambda_{\\max, j}|$ 是所有界面 $j$ 上的最大波速（绝对值）。\n\n### 3. HLLC 黎曼求解器\n\n数值通量 $F_{i+1/2}$是通过求解界面处的黎曼问题计算得出的，其左状态为 $U_L = U_i^n$，右状态为 $U_R = U_{i+1}^n$。HLLC 黎曼求解器用一个三波模型来近似解，该模型包含一个左行波、一个右行波以及在它们之间移动的一个接触间断。\n\n#### 3.1. 波速估计\n首先，我们将左（$L$）和右（$R$）守恒状态 $U_K$（其中 $K \\in \\{L, R\\}$）转换为原始变量 $W_K = [\\rho_K, u_K, p_K, Y_K]^\\top$。每个状态下的声速为 $c_K = \\sqrt{\\gamma p_K / \\rho_K}$。最左侧（$S_L$）和最右侧（$S_R$）波的速度使用 Davis 公式进行估计：\n$$\nS_L = \\min(u_L - c_L, u_R - c_R)\n$$\n$$\nS_R = \\max(u_L + c_L, u_R + c_R)\n$$\n\n#### 3.2. 扰动后的接触波速\nHLLC 求解器引入了一个中间波，即接触间断，其速度为 $S_M$。$S_M$ 的标准估计值是从星区（star region）的动量和压力平衡推导出来的：\n$$\nS_M = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L(S_L - u_L) - \\rho_R(S_R - u_R)}\n$$\n对于纯接触间断的特定初始条件（$p_L=p_R$, $u_L=u_R=u$），该公式简化为 $S_M = u$，即精确接触速度。问题要求对此估计引入一个受控扰动 $\\Delta S_M$。扰动后的接触波速 $S_M'$ 将在整个 HLLC 通量计算中使用：\n$$\nS_M' = S_M + \\Delta S_M\n$$\n\n#### 3.3. 星区状态和通量\nHLLC 近似在波之间定义了两个中间“星”状态，$U_L^*$ 和 $U_R^*$。在整个星区，压力 $p^*$ 和速度 $u^*$ 是恒定的，且 $u^*=S_M'$。压力 $p^*$ 是通过确保跨越左、右波的 Rankine-Hugoniot 条件的一致性来求得的：\n$$\np^* = p_L + \\rho_L (u_L - S_L)(u_L - S_M') = p_R + \\rho_R(u_R - S_R)(u_R - S_M')\n$$\n我们可以使用左状态计算 $p^*$。然后可以计算星区状态 $U_K^*$（对于 $K=L,R$）。一种高效的方法是首先定义一个辅助矢量 $P^* = [0, p^*, p^*S_M', 0]^\\top$，然后计算：\n$$\nU_K^* = \\frac{S_K U_K - F(U_K) + P^*}{S_K - S_M'}\n$$\n这个公式正确地构造了星区状态，包括守恒的被动标量 $(\\rho Y)_K^* = \\rho_K^* Y_K$，因为 $Y$ 跨接触波是恒定的（$Y_L^* = Y_L, Y_R^* = Y_R$），且 $P^*$ 的第四个分量为零。星区的密度为 $\\rho_K^* = \\rho_K \\frac{S_K - u_K}{S_K - S_M'}$。当 $S_M'$ 不是真实的接触速度时，对 $\\rho$ 和 $\\rho Y$ 的更新可能变得不一致，从而可能导致 $Y = (\\rho Y)/\\rho$ 出现非物理值。\n\n最终的 HLLC 数值通量 $F_{HLLC}$ 由界面（速度为 $0$）相对于波速 $S_L$、$S_M'$ 和 $S_R$ 的位置确定：\n$$\nF_{HLLC} = \\begin{cases}\n    F_L = F(U_L)  \\text{if } 0 \\le S_L \\\\\n    F_L^* = F_L + S_L(U_L^* - U_L)  \\text{if } S_L  0 \\le S_M' \\\\\n    F_R^* = F_R + S_R(U_R^* - U_R)  \\text{if } S_M'  0 \\le S_R \\\\\n    F_R = F(U_R)  \\text{if } S_R  0\n\\end{cases}\n$$\n\n### 4. 模拟与分析\n\n对于每个测试用例，算法流程如下：\n1.  **初始化**：在包含 $N=200$ 个单元的网格上设置分段恒定的初始状态，间断位于 $x=0.5$。对于中心 $x_i  0.5$ 的单元，状态为 $(\\rho_L, u, p, Y_L)$；对于 $x_i \\ge 0.5$ 的单元，状态为 $(\\rho_R, u, p, Y_R)$。将这些原始变量转换为守恒变量矢量 $U$。\n2.  **时间推进**：将系统从 $t=0$ 演化到最终时间 $T=0.001$。在每个时间步中：\n    a.  计算所有界面上的最大波速 $|\\lambda_{\\max}|$，同时考虑周期性边界条件。\n    b.  使用 CFL 条件计算时间步长 $\\Delta t$。\n    c.  对于每个界面，使用指定的 $\\Delta S_M$ 计算 HLLC 通量 $F_{i+1/2}$。\n    d.  使用向前欧拉法更新所有单元的状态矢量 $U_i$。\n3.  **后处理**：在时间 $T$，计算每个单元的被动标量 $Y_{\\text{num}}(x_i, T) = (\\rho Y)_i / \\rho_i$。\n4.  **指标计算**：确定初始标量的最小值和最大值 $Y_{\\min}$ 和 $Y_{\\max}$。按照问题描述中定义的方式计算超调幅度 $\\mathcal{O}$ 和归一化灵敏度 $\\kappa$：\n    $$\n    \\mathcal{O} = \\max_i \\left( \\max\\{ Y_{\\text{num}}(x_i,T) - Y_{\\max}, 0 \\}, \\max\\{ Y_{\\min} - Y_{\\text{num}}(x_i,T), 0 \\} \\right)\n    $$\n    $$\n    \\kappa = \\frac{\\mathcal{O}}{|\\Delta S_M| + \\varepsilon}, \\quad \\text{with } \\varepsilon = 10^{-12}\n    $$\n为五个测试用例中的每一个计算 $(\\mathcal{O}, \\kappa)$ 对。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main solver function to run the CFD simulation for all test cases.\n    \"\"\"\n\n    def primitive_to_conserved(W, gamma):\n        \"\"\"Converts primitive variables [rho, u, p, Y] to conserved [rho, rho*u, E, rho*Y].\"\"\"\n        rho, u, p, Y = W\n        U = np.zeros(4)\n        U[0] = rho\n        U[1] = rho * u\n        U[2] = p / (gamma - 1.0) + 0.5 * rho * u**2\n        U[3] = rho * Y\n        return U\n\n    def conserved_to_primitive(U, gamma):\n        \"\"\"Converts conserved variables [rho, rho*u, E, rho*Y] to primitive [rho, u, p, Y].\"\"\"\n        W = np.zeros(4)\n        rho = U[0]\n        if rho = 0: # Avoid division by zero or negative density\n            return np.array([1e-9, 0.0, 1e-9, 0.0])\n        \n        u = U[1] / rho\n        p = (gamma - 1.0) * (U[2] - 0.5 * rho * u**2)\n        Y = U[3] / rho\n        W[0] = rho\n        W[1] = u\n        W[2] = p if p > 0 else 1e-9\n        W[3] = Y\n        return W\n\n    def get_flux(U, gamma):\n        \"\"\"Computes the flux vector F(U).\"\"\"\n        F = np.zeros(4)\n        rho, u, p, _ = conserved_to_primitive(U, gamma)\n        E = U[2]\n        rhoY = U[3]\n\n        F[0] = rho * u\n        F[1] = rho * u**2 + p\n        F[2] = u * (E + p)\n        F[3] = u * rhoY\n        return F\n\n    def hllc_flux(U_L, U_R, gamma, delta_S_M):\n        \"\"\"Computes the HLLC flux given left and right states.\"\"\"\n        W_L = conserved_to_primitive(U_L, gamma)\n        W_R = conserved_to_primitive(U_R, gamma)\n\n        rho_L, u_L, p_L, _ = W_L\n        rho_R, u_R, p_R, _ = W_R\n\n        c_L = np.sqrt(gamma * p_L / rho_L)\n        c_R = np.sqrt(gamma * p_R / rho_R)\n\n        # Davis wave speed estimates\n        S_L = min(u_L - c_L, u_R - c_R)\n        S_R = max(u_L + c_L, u_R + c_R)\n        \n        # Nominal contact wave speed\n        num_S_M = p_R - p_L + rho_L * u_L * (S_L - u_L) - rho_R * u_R * (S_R - u_R)\n        den_S_M = rho_L * (S_L - u_L) - rho_R * (S_R - u_R)\n        S_M = num_S_M / den_S_M if abs(den_S_M) > 1e-9 else (u_L + u_R) / 2.0\n\n        # Perturbed contact wave speed\n        S_M_prime = S_M + delta_S_M\n\n        if 0.0 = S_L:\n            return get_flux(U_L, gamma)\n        if S_R = 0.0:\n            return get_flux(U_R, gamma)\n\n        F_L = get_flux(U_L, gamma)\n        F_R = get_flux(U_R, gamma)\n        \n        p_star = p_L + rho_L * (u_L - S_L) * (u_L - S_M_prime)\n\n        if S_L  0.0 = S_M_prime:\n            P_star_vec = np.array([0., p_star, p_star * S_M_prime, 0.])\n            den = S_L - S_M_prime\n            if abs(den)  1e-9: den = -1e-9\n            U_L_star = (S_L * U_L - F_L + P_star_vec) / den\n            return F_L + S_L * (U_L_star - U_L)\n        \n        elif S_M_prime  0.0 = S_R:\n            P_star_vec = np.array([0., p_star, p_star * S_M_prime, 0.])\n            den = S_R - S_M_prime\n            if abs(den)  1e-9: den = 1e-9\n            U_R_star = (S_R * U_R - F_R + P_star_vec) / den\n            return F_R + S_R * (U_R_star - U_R)\n            \n        return np.zeros(4) # Should not happen if S_L  0  S_R\n\n    # Simulation parameters\n    N = 200\n    CFL = 0.5\n    T_final = 0.001\n    epsilon = 1e-12\n    domain_length = 1.0\n    dx = domain_length / N\n\n    test_cases = [\n        # (rho_L, rho_R, u, p, Y_L, Y_R, gamma, delta_S_M)\n        (1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, 0.0),\n        (1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, 50.0),\n        (1.0, 2.0, 200.0, 100000.0, 0.2, 0.8, 1.4, -50.0),\n        (0.5, 5.0, 50.0, 100000.0, 0.0, 1.0, 1.4, 30.0),\n        (1.0, 3.0, 0.0, 100000.0, 0.1, 0.9, 1.4, 30.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        rho_L, rho_R, u_contact, p_contact, Y_L, Y_R, gamma, delta_S_M = case\n\n        # Initial conditions\n        W_L = np.array([rho_L, u_contact, p_contact, Y_L])\n        W_R = np.array([rho_R, u_contact, p_contact, Y_R])\n        U_L = primitive_to_conserved(W_L, gamma)\n        U_R = primitive_to_conserved(W_R, gamma)\n\n        U = np.zeros((4, N))\n        x = (np.arange(N) + 0.5) * dx\n        \n        # Discontinuity at x=0.5\n        U[:, x  0.5] = U_L[:, np.newaxis]\n        U[:, x >= 0.5] = U_R[:, np.newaxis]\n\n        t = 0.0\n        while t  T_final:\n            max_lambda = 0.0\n            \n            # Calculate max wave speed for dt\n            for i in range(N):\n                U_i = U[:, i]\n                U_j = U[:, (i + 1) % N]\n                W_i = conserved_to_primitive(U_i, gamma)\n                W_j = conserved_to_primitive(U_j, gamma)\n                \n                c_i = np.sqrt(gamma * W_i[2] / W_i[0])\n                c_j = np.sqrt(gamma * W_j[2] / W_j[0])\n\n                s_l_local = min(W_i[1] - c_i, W_j[1] - c_j)\n                s_r_local = max(W_i[1] + c_i, W_j[1] + c_j)\n                max_lambda = max(max_lambda, abs(s_l_local), abs(s_r_local))\n            \n            dt = CFL * dx / max_lambda if max_lambda > 0 else T_final\n            if t + dt > T_final:\n                dt = T_final - t\n            \n            # Compute fluxes at interfaces\n            fluxes = np.zeros((4, N))\n            for i in range(N):\n                U_i_L = U[:, i]\n                U_i_R = U[:, (i + 1) % N]\n                fluxes[:, i] = hllc_flux(U_i_L, U_i_R, gamma, delta_S_M)\n            \n            # Update states\n            U_next = np.copy(U)\n            for i in range(N):\n                flux_L = fluxes[:, (i - 1 + N) % N]\n                flux_R = fluxes[:, i]\n                U_next[:, i] = U[:, i] - (dt / dx) * (flux_R - flux_L)\n            \n            U = U_next\n            t += dt\n\n        # Post-processing\n        Y_num = U[3, :] / U[0, :]\n        Y_min_init = min(Y_L, Y_R)\n        Y_max_init = max(Y_L, Y_R)\n\n        overshoot = np.maximum(Y_num - Y_max_init, 0.0)\n        undershoot = np.maximum(Y_min_init - Y_num, 0.0)\n        \n        O = np.max(np.maximum(overshoot, undershoot))\n        kappa = O / (abs(delta_S_M) + epsilon)\n        \n        results.extend([O, kappa])\n\n    print(f\"[{','.join(f'{x:.6g}' for x in results)}]\")\n\nsolve()\n```", "id": "3330267"}]}