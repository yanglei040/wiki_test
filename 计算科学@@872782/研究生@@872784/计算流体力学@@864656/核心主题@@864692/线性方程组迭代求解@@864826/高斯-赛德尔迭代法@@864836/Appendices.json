{"hands_on_practices": [{"introduction": "本练习将物理边界条件与离散系统的数学性质直接联系起来。通过分析一个一维扩散问题，您将推导出一个Robin边界参数必须满足的条件，以确保系统矩阵是对称正定的（Symmetric Positive Definite, SPD），从而保证高斯-赛德尔方法的收敛性。这项实践强调了从第一性原理出发进行分析的重要性，以在求解之前预测和保证数值方法的稳定性。[@problem_id:3374017]", "problem": "考虑在区间 $x \\in [0,L]$ 上，标量场 $u(x)$ 的稳态一维扩散。该过程由守恒定律 $\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right)=0$ 控制，其中扩散系数 $k0$ 为常数。使用有限体积法（FVM）在包含 $N$ 个控制体积的均匀网格上离散此方程。网格中心位于 $x_i = \\left(i-\\frac{1}{2}\\right)h$（$i=1,2,\\dots,N$），均匀间距为 $h = \\frac{L}{N}$。在左边界 $x=0$ 处，施加一个罗宾（对流）边界条件 $-k \\frac{du}{dx}\\big|_{x=0} = h_c \\left(u(0) - u_{\\infty}\\right)$，其中对流系数为 $h_c$，环境值为 $u_{\\infty}$。在右边界 $x=L$ 处，施加一个狄利克雷边界条件 $u(L)=0$。使用与 FVM 一致的二阶界面通量，为未知的网格中心值向量 $\\boldsymbol{u}=(u_1,\\dots,u_N)^{\\top}$ 组装线性系统 $\\boldsymbol{A}\\boldsymbol{u}=\\boldsymbol{b}$。\n\n根据基本守恒和界面通量平衡，推导内部界面和边界界面处的离散算子系数，并分析所得到的三对角矩阵 $\\boldsymbol{A}$ 的对角占优性。然后，利用与扩散相关的离散能量形式和罗宾边界的贡献，通过确保系数矩阵为对称正定（SPD），确定罗宾系数 $h_c$ 的参数范围，在此范围内不带松弛的高斯-赛德尔迭代法（GS）保证收敛。\n\n最后，提取罗宾系数 $h_c$ 的两个临界值（表示为 $k$ 和 $h$ 的函数），这两个值描绘了您所确定的收敛区域的边界。将最终答案表示为单个行矩阵中的一对符号表达式。无需进行数值取整。", "solution": "用户要求我解决一个关于一维扩散方程离散化的问题，并分析高斯-赛德尔方法的收敛性。\n\n### 步骤 1：问题验证\n所给问题是计算流体动力学（CFD）和数值分析中的一个标准练习。它涉及对具有指定罗宾和狄利克雷边界条件的稳态一维扩散方程进行有限体积法（FVM）离散化。任务是组装得到的线性系统，分析系数矩阵的性质，并确定边界条件参数（$h_c$）的范围，以保证高斯-赛德尔迭代法的收敛。收敛判据被指定为矩阵是对称正定（SPD）的。\n\n**已知条件：**\n1.  **控制方程：** $\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right)=0$，在 $x \\in [0,L]$ 上。\n2.  **扩散系数：** $k0$，为常数。\n3.  **网格：** 均匀网格，包含 $N$ 个控制体积，网格间距 $h = \\frac{L}{N}$，网格中心位于 $x_i = \\left(i-\\frac{1}{2}\\right)h$（$i=1, \\dots, N$）。\n4.  **左边界条件 ($x=0$)：** 罗宾条件，$-k \\frac{du}{dx}\\big|_{x=0} = h_c \\left(u(0) - u_{\\infty}\\right)$。\n5.  **右边界条件 ($x=L$)：** 狄利克雷条件，$u(L)=0$。\n6.  **任务：** 组装线性系统 $\\boldsymbol{A}\\boldsymbol{u}=\\boldsymbol{b}$，分析矩阵 $\\boldsymbol{A}$，并通过确保 $\\boldsymbol{A}$ 是 SPD 来找到保证高斯-赛德尔方法收敛的 $h_c$ 的范围。\n7.  **最终输出：** 限定收敛区域的两个 $h_c$ 临界值。\n\n**验证：**\n-   **科学基础：** 该问题牢固地植根于传热/扩散和数值方法（FVM，高斯-赛德尔）的原理。所有方面都是标准的且科学合理的。\n-   **适定性：** 该问题提供了完整的信息集（方程、域、边界条件、离散化方法），足以推导出一个唯一的线性系统并执行所要求的分析。目标明确定义。\n-   **客观性：** 语言正式、精确，没有任何主观或模棱两可的术语。\n\n该问题被认为是 **有效的**。我们可以继续进行求解。\n\n### 步骤 2：有限体积离散化\n我们将控制方程在一个内部控制体积 $i$ 上进行积分，从界面 $x_{i-1/2}$ 到 $x_{i+1/2}$：\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(k \\frac{du}{dx}\\right) dx = 0 \\implies \\left[k \\frac{du}{dx}\\right]_{x_{i+1/2}} - \\left[k \\frac{du}{dx}\\right]_{x_{i-1/2}} = 0 $$\n界面处的通量使用二阶中心差分进行近似：\n$$ k \\frac{du}{dx}\\bigg|_{x_{i+1/2}} \\approx k \\frac{u_{i+1}-u_i}{h} \\quad , \\quad k \\frac{du}{dx}\\bigg|_{x_{i-1/2}} \\approx k \\frac{u_i-u_{i-1}}{h} $$\n将这些代入内部节点（$i=2, \\dots, N-1$）的平衡方程中：\n$$ k \\frac{u_{i+1}-u_i}{h} - k \\frac{u_i-u_{i-1}}{h} = 0 \\implies -\\frac{k}{h} u_{i-1} + \\frac{2k}{h} u_i - \\frac{k}{h} u_{i+1} = 0 $$\n\n### 步骤 3：边界条件\n**右边界（节点 N）：** $x=L$ 处的边界对应于界面 $x_{N+1/2}$。条件是 $u(L)=0$。单元 $N$ 的通量平衡为：\n$$ \\left[k \\frac{du}{dx}\\right]_{x_{N+1/2}} - \\left[k \\frac{du}{dx}\\right]_{x_{N-1/2}} = 0 $$\n右边界界面处的通量近似为 $k \\frac{u(L)-u_N}{h/2} = k \\frac{0-u_N}{h/2} = -\\frac{2k}{h} u_N$。\n$$ - \\frac{2k}{h} u_N - k \\frac{u_N-u_{N-1}}{h} = 0 \\implies -\\frac{k}{h} u_{N-1} + \\frac{3k}{h} u_N = 0 $$\n\n**左边界（节点 1）：** $x=0$ 处的边界对应于界面 $x_{1/2}$。单元 $1$ 的通量平衡为：\n$$ \\left[k \\frac{du}{dx}\\right]_{x_{3/2}} - \\left[k \\frac{du}{dx}\\right]_{x_{1/2}} = 0 $$\n西界面的通量 $J_w = k \\frac{du}{dx}|_{x=0}$ 由罗宾条件给出：$-J_w = h_c(u(0)-u_\\infty)$。\n因此，$k \\frac{u_2-u_1}{h} - J_w = 0 \\implies k \\frac{u_2-u_1}{h} + h_c(u(0)-u_\\infty) = 0$。\n边界界面值 $u(0)$ 是未知的。我们通过假设它们之间呈线性变化，将其与网格中心值 $u_1$ 相关联。边界通量可以用两种方式写出：\n1.  根据罗宾条件：$J_w = -h_c(u(0)-u_\\infty)$。\n2.  根据网格中心和界面之间的傅里叶定律：$J_w = k \\frac{u_1-u(0)}{h/2}$。\n\n将这两个表达式相等，可以消去 $u(0)$：\n$$ k \\frac{u_1-u(0)}{h/2} = -h_c(u(0)-u_\\infty) \\implies \\frac{2k}{h}(u_1-u(0)) = -h_c u(0) + h_c u_\\infty $$\n$$ u(0) \\left(h_c - \\frac{2k}{h}\\right) = h_c u_\\infty - \\frac{2k}{h} u_1 \\implies u(0) = \\frac{h_c u_\\infty - \\frac{2k}{h} u_1}{h_c - \\frac{2k}{h}} $$\n将此代回通量表达式 $J_w = k \\frac{u_1-u(0)}{h/2}$ 中：\n$$ J_w = \\frac{k}{h/2} \\left( u_1 - \\frac{h_c u_\\infty - \\frac{2k}{h} u_1}{h_c - \\frac{2k}{h}} \\right) = \\frac{2k}{h} \\frac{u_1(h_c - \\frac{2k}{h}) - h_c u_\\infty + \\frac{2k}{h} u_1}{h_c - \\frac{2k}{h}} $$\n$$ J_w = \\frac{2k}{h} \\frac{u_1 h_c - h_c u_\\infty}{h_c - \\frac{2k}{h}} = \\frac{2k h_c(u_1-u_\\infty)}{h h_c - 2k} = - \\frac{2k h_c}{2k - h h_c} (u_1-u_\\infty) $$\n单元 1 的方程是 $k \\frac{u_2-u_1}{h} - J_w = 0$，所以：\n$$ k \\frac{u_2-u_1}{h} + \\frac{2k h_c}{2k - h h_c} (u_1-u_\\infty) = 0 $$\n整理成 $A_{11}u_1 + A_{12}u_2 = b_1$ 的形式：\n$$ \\left(-\\frac{k}{h} + \\frac{2k h_c}{2k - h h_c}\\right)u_1 + \\frac{k}{h}u_2 = -\\frac{2k h_c u_\\infty}{2k - h h_c} $$\n在这个标准推导中存在一个符号错误。使用一致的符号约定（流出为正）更好。\n流出东界面的通量：$J_e = k \\frac{u_1-u_2}{h}$。\n流出西界面的通量：$J_w = -k \\frac{du}{dx}|_{x=0} = h_c(u(0)-u_\\infty)$。\n使用 $J_w = \\frac{2kh_c(u_1-u_\\infty)}{hh_c+2k}$ （通过一致的通量方向类似地推导得出）：\n$J_e+J_w=0$。\n$k \\frac{u_1-u_2}{h} + \\frac{2kh_c}{hh_c+2k}(u_1-u_\\infty)=0$。\n$$ \\left(\\frac{k}{h} + \\frac{2kh_c}{hh_c+2k}\\right)u_1 - \\frac{k}{h} u_2 = \\frac{2kh_c u_\\infty}{hh_c+2k} $$\n这种公式化导出一个对称矩阵 $\\boldsymbol{A}$。\n\n### 步骤 4：矩阵分析与收敛性\n矩阵 $\\boldsymbol{A}$ 是三对角且对称的。其元素为：\n-   $A_{11} = \\frac{k}{h} + \\frac{2kh_c}{hh_c+2k}$\n-   $A_{i,i} = \\frac{2k}{h}$ 对于 $i=2, \\dots, N-1$\n-   $A_{N,N} = \\frac{3k}{h}$\n-   $A_{i,i\\pm1} = -\\frac{k}{h}$ 对于相邻单元。\n\n如果矩阵 $\\boldsymbol{A}$ 是对称正定（SPD）的，则高斯-赛德尔方法保证收敛。$\\boldsymbol{A}$ 是对称的。我们需要找到使其为正定的 $h_c$ 的范围。如果一个矩阵的关联二次型（离散能量）$\\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u}$ 对于所有非零向量 $\\boldsymbol{u}$ 都为正，则该矩阵是正定的。\n\n二次型为：\n$$ \\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u} = \\sum_{i,j} A_{ij}u_i u_j = \\frac{k}{h} \\sum_{i=1}^{N-1}(u_i-u_{i+1})^2 + \\left(A_{11}-\\frac{k}{h}\\right)u_1^2 + \\left(A_{NN}-\\frac{k}{h}\\right)u_N^2 $$\n代入 $A_{11}$ 和 $A_{NN}$ 的表达式：\n$$ A_{11}-\\frac{k}{h} = \\frac{2kh_c}{hh_c+2k} $$\n$$ A_{NN}-\\frac{k}{h} = \\frac{3k}{h}-\\frac{k}{h} = \\frac{2k}{h} $$\n离散能量形式为：\n$$ \\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u} = \\frac{k}{h} \\sum_{i=1}^{N-1}(u_i-u_{i+1})^2 + \\left(\\frac{2kh_c}{hh_c+2k}\\right) u_1^2 + \\frac{2k}{h} u_N^2 $$\n为了使此形式对任何非零 $\\boldsymbol{u}=(u_1, \\dots, u_N)^\\top$ 都为正，我们分析其各项。\n-   求和项 $\\frac{k}{h} \\sum_{i=1}^{N-1}(u_i-u_{i+1})^2$ 代表内部的耗散，并且始终为非负（$\\ge 0$）。\n-   项 $\\frac{2k}{h} u_N^2$ 代表右边界的耗散，并且始终为非负（$\\ge 0$）。\n-   项 $\\left(\\frac{2kh_c}{hh_c+2k}\\right) u_1^2$ 代表罗宾边界处的能量交换。其符号取决于 $h_c$。\n\n保证对于 $\\boldsymbol{u} \\neq 0$ 有 $\\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u}  0$ 的一个充分条件是所有项都非负。这要求 $u_1^2$ 的系数为非负：\n$$ \\frac{2kh_c}{hh_c+2k} \\ge 0 $$\n由于 $k0$，这简化为 $\\frac{h_c}{hh_c+2k} \\ge 0$。当分子和分母同号（或分子为零）时，此不等式成立。\n1.  $h_c \\ge 0$ 且 $hh_c+2k  0$。由于 $h0, k0$，如果 $h_c \\ge 0$，分母总是正的。这种情况在 $h_c \\ge 0$ 时成立。\n2.  $h_c \\le 0$ 且 $hh_c+2k  0$。这意味着 $hh_c  -2k$，所以 $h_c  -\\frac{2k}{h}$。\n\n结合这些，SPD 的充分条件是 $h_c \\in (-\\infty, -2k/h) \\cup [0, \\infty)$。\n如果此条件成立，$\\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u}$ 是一系列非负项之和。如果 $\\boldsymbol{u}^\\top \\boldsymbol{A} \\boldsymbol{u} = 0$，则每一项都必须为零。\n-   $\\frac{2k}{h} u_N^2=0 \\implies u_N=0$。\n-   $\\frac{k}{h} \\sum(u_i-u_{i+1})^2=0 \\implies u_i=u_{i+1}$ 对于所有 $i$。\n-   综合起来，$u_1=u_2=\\dots=u_N=0$。所以 $\\boldsymbol{u}=\\boldsymbol{0}$。\n这证实了对于 $h_c \\in (-\\infty, -2k/h) \\cup [0, \\infty)$，矩阵 $\\boldsymbol{A}$ 是 SPD。请注意，当 $h_c=-2k/h$ 时，系数的分母变为零，因此矩阵本身在此离散化下没有良好定义。这个值必须是一个边界。\n\n因此，高斯-赛德尔方法的收敛区域保证为 $h_c \\in (-\\infty, -2k/h) \\cup [0, \\infty)$。描绘该区域边界的两个临界值是 $h_c = -2k/h$ 和 $h_c = 0$。按升序排列，它们是 $-2k/h$ 和 $0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{2k}{h}  0 \\end{pmatrix}}\n$$", "id": "3374017"}, {"introduction": "理论上的收敛是一回事，但在有限精度下的实际计算则完全是另一回事。本练习探讨了为何高斯-赛德尔迭代在非常精细的网格上会看似“停滞”，即残差在下降到一定程度后便不再减小。您将分析浮点数的舍入误差如何为计算出的残差设置一个无法逾越的“下限”，并探索一种标准的缓解策略——缺陷校正法（defect correction）。[@problem_id:3374015]", "problem": "您正在求解区间 $[0,1]$ 上的一维泊松问题 $-u'' = f$，其边界条件为均匀狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。该区域使用 $N$ 个内部点和均匀的网格间距 $h = 1/(N+1)$ 进行离散化，得到标准的二阶中心差分线性系统 $A u = b$，其中对于内部索引 $i$，\n$$(A u)_i = -\\frac{1}{h^2} u_{i-1} + \\frac{2}{h^2} u_i - \\frac{1}{h^2} u_{i+1}, \\quad b_i = f(x_i), \\quad x_i = i h.$$\n您在有限精度算术中应用逐点Gauss-Seidel迭代来逼近离散解。设单位舍入误差为 $\\epsilon_{\\text{mach}}$（对于电气和电子工程师协会（IEEE）双精度，$\\epsilon_{\\text{mach}} \\approx 1.11\\times 10^{-16}$）。在第 $k$ 次迭代解 $u^{(k)}$ 处的残差定义为 $r^{(k)} = b - A u^{(k)}$。\n\n在非常精细的网格（小 $h$）上，实践者经常观察到，经过多次Gauss-Seidel扫描后，计算出的残差范数 $\\|r^{(k)}\\|_2$ 不再减小，尽管在精确算术中，真实的代数误差 $e^{(k)} = u^\\star - u^{(k)}$（其中 $A u^\\star = b$）仍然可以被减小。该现象归因于在形成Gauss-Seidel更新和残差时发生的相消和有效位数损失。\n\n从第一性原理出发，不引用任何专门的预推导稳定化公式，请论述：\n- 离散算子各项的量级如何随 $h$ 变化，\n- 在Gauss-Seidel更新和残差形成 $r = b - A u$ 过程中的浮点舍入如何导致计算残差出现一个依赖于 $h$ 和 $\\epsilon_{\\text{mach}}$ 的停滞平台，\n- 以及何种计算策略能够通过将残差评估中的舍入效应与后续的校正步骤分离开来，以缓解这种明显的停滞现象。\n\n哪个选项最能准确地描述停滞平台的正确 $h$-缩放机制，并提出一种适用于计算流体力学工作流程的、合理的残差校正（亏损校正）策略？\n\nA. 因为 $a_{ii} = 2/h^2$ 且 $a_{i,i\\pm 1} = -1/h^2$，每次Gauss-Seidel更新和残差计算中的中间求和都涉及量级为 $\\mathcal{O}(h^{-2})$ 的项之间的相消。在浮点运算中，每个此类求和的绝对误差为 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$，因此 $u_i$ 的更新误差为 $\\mathcal{O}(\\epsilon_{\\text{mach}})$，计算出的残差平台为 $\\|r\\|_2 \\sim \\mathcal{O}(\\epsilon_{\\text{mach}} \\|A\\|_2 \\|u\\|_2) = \\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$。一种稳健的缓解方法是采用亏损校正：周期性地使用补偿点积或扩展精度重新计算 $r = b - A u$ 以抑制相消，然后从 $e=0$ 开始，用几次Gauss-Seidel扫描近似求解 $A e = r$，并更新 $u \\leftarrow u + e$。此外，对系统进行对角缩放以使 $a_{ii} \\approx 1$（例如，两边同乘以 $h^2$ 以处理数量级为1的项），这会进一步减少后续迭代中的相消。\n\nB. 在更精细的网格上，由于离散化是二阶的，计算残差平台会像 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{2})$ 那样减小；因此，通过在Gauss-Seidel中增加超松弛因子 $\\omega  1$ 以推动更新越过舍入误差，就可以消除明显的停滞，而无需任何特殊的残差重计算。\n\nC. 从Gauss-Seidel切换到Jacobi可以消除相消，因为Jacobi只使用旧的迭代值；因此，计算出的残差总能被降低到与 $h$ 无关的机器精度水平，并且不需要亏损校正步骤。\n\nD. 停滞是停止准则造成的一种假象；将容差收紧一个因子 $h^{2}$ 就足够了。将残差计算为 $A u - b$ 而不是 $b - A u$ 也可以避免相消，因此不需要求解校正方程。", "solution": "用户提供了一个关于使用Gauss-Seidel方法数值求解一维泊松方程的问题陈述。问题的核心是解释在精细网格上观察到的残差范数停滞现象，并确定一种正确的缓解策略。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n-   **问题：** 区间 $[0,1]$ 上的一维泊松方程 $-u'' = f$。\n-   **边界条件：** 均匀狄利克雷条件，$u(0) = 0$ 和 $u(1) = 0$。\n-   **离散化：** $N$ 个内部点，均匀网格间距 $h = 1/(N+1)$。\n-   **线性系统：** $A u = b$。\n    -   $(A u)_i = -\\frac{1}{h^2} u_{i-1} + \\frac{2}{h^2} u_i - \\frac{1}{h^2} u_{i+1}$。\n    -   $b_i = f(x_i)$，其中 $x_i = i h$。\n-   **方法：** 有限精度算术中的逐点Gauss-Seidel迭代。\n-   **单位舍入误差：** $\\epsilon_{\\text{mach}}$。\n-   **定义：** 残差 $r^{(k)} = b - A u^{(k)}$。\n-   **观察：** 在非常精细的网格上（小 $h$），计算残差的范数 $\\|r^{(k)}\\|_2$ 出现停滞。\n-   **问题：** 解释算子项的缩放、由舍入误差引起的残差停滞平台的缩放，并确定一种缓解该现象的计算策略。\n\n**步骤2：使用提取的已知信息进行验证**\n-   **科学性：** 该问题基于偏微分方程数值分析的标准、公认的原理。泊松方程的有限差分离散化和Gauss-Seidel方法的使用是经典示例。在病态系统中，由于浮点舍入误差导致的残差停滞是科学计算中一个真实且重要的话题。矩阵 $A$ 是一个对称正定矩阵（具体来说，是一个缩放后的正定M-矩阵），保证了Gauss-Seidel方法在精确算术中的收敛性。\n-   **适定性：** 该问题是适定的。它要求对一个数值假象进行定性和定量解释，并确定一种合适的校正方法。这需要从数值线性代数和浮点算术的第一性原理出发进行推理。\n-   **客观性：** 问题以客观、正式且明确的语言陈述。\n-   **完整性：** 问题提供了分析该现象所需的所有必要信息。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、适定的和完整的。我将继续推导解决方案。\n\n### 推导与分析\n\n该问题要求解释离散化泊松方程的Gauss-Seidel方法中出现的残差停滞现象。这需要分析有限精度算术对所涉及计算的影响。\n\n**1. 算子项的缩放**\n矩阵 $A$ 来自于负二阶导数的二阶中心差分近似，并按 $1/h^2$ 进行了缩放。其各项由下式给出：\n$$ a_{ii} = \\frac{2}{h^2} $$\n$$ a_{i,i\\pm 1} = -\\frac{1}{h^2} $$\n随着网格的加密，网格间距 $h = 1/(N+1)$ 趋近于0。因此，矩阵 $A$ 的非零项的量级按 $\\mathcal{O}(h^{-2})$ 缩放。这意味着对于精细网格，矩阵包含非常大的数值。该矩阵的条件数 $\\kappa(A)$ 也按 $\\mathcal{O}(h^{-2})$ 缩放，表明随着 $h \\to 0$，系统变得越来越病态。\n\n**2. 残差停滞与浮点误差**\n对于给定的近似解 $u$，残差为 $r = b - Au$。让我们分析在浮点算术中计算矩阵向量积的单个分量 $(Au)_i$ 的过程。设 $\\text{fl}(\\cdot)$ 表示浮点计算的结果。\n$$ (Au)_i = \\frac{1}{h^2} (-u_{i-1} + 2u_i - u_{i+1}) $$\n随着迭代收敛，离散解 $u$ 逼近真实的离散解 $u^\\star$，而 $u^\\star$ 是真实连续解的一个二阶精确近似。泰勒展开表明，对于一个光滑解 $u(x)$，项 $-u(x_{i-1}) + 2u(x_i) - u(x_{i+1})$ 是对 $-h^2 u''(x_i)$ 的近似。\n由于 $-u'' = f$，我们有 $-u_{i-1} + 2u_i - u_{i+1} \\approx h^2 f(x_i) = h^2 b_i$。\n因此，$(Au)_i \\approx \\frac{1}{h^2}(h^2 b_i) = b_i$。\n计算 $(Au)_i$ 涉及将量级为 $\\mathcal{O}(h^{-2}\\|u\\|_{\\infty})$ 的项相加，其和的结果量级为 $\\mathcal{O}(\\|b\\|_{\\infty})$。这是一个经典的灾难性相消案例：通过减去几乎相等的大数来获得一个小数。\n\n标准的浮点误差分析指出，计算一个和的误差与 $\\epsilon_{\\text{mach}}$ 乘以各项绝对值之和成正比。\n$(Au)_i$ 的计算值，我们称之为 $\\widehat{(Au)_i}$，将具有一个绝对误差：\n$$ |\\widehat{(Au)_i} - (Au)_i| \\approx \\epsilon_{\\text{mach}} \\cdot \\text{fl} \\left( \\frac{1}{h^2} (|u_{i-1}| + |2u_i| + |u_{i+1}|) \\right) $$\n假设 $\\|u\\|_{\\infty}$ 的量级为 $\\mathcal{O}(1)$，这个绝对误差的量级为 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$。\n计算出的残差分量是 $\\hat{r}_i = \\text{fl}(b_i - \\widehat{(Au)_i})$。当真实残差 $r_i = b_i - (Au)_i$ 的量级变得与计算 $(Au)_i$ 的误差相当时，计算出的残差 $\\hat{r}_i$ 将被这个浮点噪声所主导。进一步的迭代无法减小真实误差，因为驱动迭代校正的计算残差不再携带关于真实残差的有意义信息。\n因此，计算残差的范数 $\\|\\hat{r}\\|$ 会在这个由噪声水平决定的“平台”上停滞。这个平台的大小与舍入误差的大小成比例，即 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$。范数的精确缩放（例如 $\\|\\cdot\\|_2$）取决于对这些误差求和，但主导因子是 $h^{-2}$。\n\n**3. 缓解策略**\n核心问题是由于灾难性相消导致残差 $r = b - Au$ 的计算不准确。一个稳健的策略必须正面解决这个问题。\n\n**策略1：迭代求精（亏损校正）**\n这是一种用于改进线性系统解的通用技术。步骤如下：\n-   i. 给定一个计算解 $u$。\n-   ii. 使用 **扩展精度** 或补偿求和算法（如Kahan求和）计算残差 $r = b - Au$。这是关键步骤，它能在存在相消的情况下计算出准确的残差。\n-   iii. 求解校正方程 $Ae = r$ 以得到误差向量 $e$。由于我们已有 $A$ 的（近似）分解或求解器，这一步在计算上是可行的。通常 $e$ 的一个近似解就足够了，所以可以使用几轮Gauss-Seidel扫描。\n-   iv. 更新解：$u \\leftarrow u + e$。\n这个过程将高精度要求（步骤 ii）与主求解器（步骤 iii）分离开来，使得大部分工作可以使用标准精度完成。\n\n**策略2：系统缩放**\n一个更简单且通常非常有效的策略是重新缩放线性系统以改善其条件数。我们可以将整个方程 $Au=b$ 乘以 $h^2$：\n$$ (h^2 A) u = h^2 b $$\n令 $A' = h^2 A$ 和 $b' = h^2 b$。新矩阵 $A'$ 的项为：\n$$ a'_{ii} = 2, \\quad a'_{i, i\\pm 1} = -1 $$\n这些项的量级为 $\\mathcal{O}(1)$ 且与 $h$ 无关。在计算缩放后的残差 $r' = b' - A'u$ 时，矩阵向量积 $A'u$ 不再涉及会相消的大量级中间项。计算 $A'u$ 的舍入误差现在与 $\\epsilon_{\\text{mach}} \\|u\\|_{\\infty}$ 成正比，而不是 $\\epsilon_{\\text{mach}} h^{-2} \\|u\\|_{\\infty}$。这极大地降低了残差平台，通常使其接近机器精度乘以 $\\|b'\\|$ 的水平，从而允许迭代收敛到更精确的解。这是计算流体力学（CFD）和其他领域的常见做法。\n\n### 选项评估\n\n**A. 因为 $a_{ii} = 2/h^2$ 且 $a_{i,i\\pm 1} = -1/h^2$，每次Gauss-Seidel更新和残差计算中的中间求和都涉及量级为 $\\mathcal{O}(h^{-2})$ 的项之间的相消。在浮点运算中，每个此类求和的绝对误差为 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$，因此 $u_i$ 的更新误差为 $\\mathcal{O}(\\epsilon_{\\text{mach}})$，计算出的残差平台为 $\\|r\\|_2 \\sim \\mathcal{O}(\\epsilon_{\\text{mach}} \\|A\\|_2 \\|u\\|_2) = \\mathcal{O}(\\epsilon_{\\text{mach}} h^{-2})$。一种稳健的缓解方法是采用亏损校正：周期性地使用补偿点积或扩展精度重新计算 $r = b - A u$ 以抑制相消，然后从 $e=0$ 开始，用几次Gauss-Seidel扫描近似求解 $A e = r$，并更新 $u \\leftarrow u + e$。此外，对系统进行对角缩放以使 $a_{ii} \\approx 1$（例如，两边同乘以 $h^2$ 以处理数量级为1的项），这会进一步减少后续迭代中的相消。**\n-   此选项正确地指出了 $\\mathcal{O}(h^{-2})$ 的矩阵项缩放以及由此产生的相消。\n-   它正确地推断出，在计算矩阵向量积和残差时的绝对误差导致了一个按 $\\epsilon_{\\text{mach}} h^{-2}$ 缩放的平台。关于更新误差和残差平台的推理是合理的。\n-   它提出了使用高精度残差计算的亏损校正，这是标准的、正确的技术。\n-   它还提出了系统缩放（乘以 $h^2$）作为另一个有效且强大的策略。\n-   该选项在其诊断和提出的解决方案方面都是全面且准确的。\n-   **结论：正确**\n\n**B. 在更精细的网格上，由于离散化是二阶的，计算残差平台会像 $\\mathcal{O}(\\epsilon_{\\text{mach}} h^{2})$ 那样减小；因此，通过在Gauss-Seidel中增加超松弛因子 $\\omega  1$ 以推动更新越过舍入误差，就可以消除明显的停滞，而无需任何特殊的残差重计算。**\n-   所声称的残差平台缩放 $\\mathcal{O}(h^2)$ 是不正确的。对于更精细的网格（更小的 $h$），该平台实际上是*增加*的，按 $\\mathcal{O}(h^{-2})$ 缩放。该陈述混淆了离散误差（截断误差）（为 $\\mathcal{O}(h^2)$）与浮点舍入误差。\n-   使用超松弛迭代（SOR）和 $\\omega  1$ 会加速精确算术中的收敛，但不能解决残差计算中灾难性相消的根本问题。停滞仍将在相似的水平上发生。\n-   **结论：不正确**\n\n**C. 从Gauss-Seidel切换到Jacobi可以消除相消，因为Jacobi只使用旧的迭代值；因此，计算出的残差总能被降低到与 $h$ 无关的机器精度水平，并且不需要亏损校正步骤。**\n-   在Jacobi和Gauss-Seidel之间的选择影响了更新序列，但并不影响残差 $r = b - Au$ 的计算。无论是检查收敛性还是形成更新，都必须计算相同的矩阵向量积 $Au$，并且无论采用何种迭代方案，它都会遭受同样的灾难性相消。声称Jacobi能消除相消是错误的。\n-   因此，残差不能被降低到与 $h$ 无关的机器精度水平。将会遇到相同的停滞平台。\n-   **结论：不正确**\n\n**D. 停滞是停止准则造成的一种假象；将容差收紧一个因子 $h^{2}$ 就足够了。将残差计算为 $A u - b$ 而不是 $b - A u$ 也可以避免相消，因此不需要求解校正方程。**\n-   停滞是有限精度算术的一个真实限制，而不是停止准则造成的假象。计算出的解会停止改善。降低容差不会使迭代克服这个物理限制；它只会导致求解器运行直到达到停滞平台，然后无法终止或报告虚假收敛。\n-   计算 $Au - b$ 而不是 $b - Au$ 仅仅改变了结果的符号。它对浮点误差的大小或在计算 $Au$ 期间发生的相消没有任何影响。这种说法是荒谬的。\n-   **结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "3374015"}, {"introduction": "对于计算流体力学（CFD）中常见的病态（ill-conditioned）系统，一个小的残差范数并不总意味着一个小的真实误差。本练习挑战您批判性地思考何时应停止迭代求解器。您将分析为何简单的归一化残差准则会产生误导，并识别出基于后向误差分析和条件数估计的更稳健的停止准则。[@problem_id:3374029]", "problem": "在计算流体力学 (CFD) 的不可压缩流求解器的压力-速度耦合步骤中，压力泊松方程在均匀网格上被离散化，产生一个稀疏线性系统 $A x = b$。其中 $A$ 是对称正定矩阵，并且随着网格的加密而变得越来越病态。使用像 Gauss-Seidel 迭代法这样的经典光滑子来近似求解 $A x = b$。设第 $k$ 次迭代解为 $x_k$，精确解为 $x_\\star$，误差为 $e_k = x_k - x_\\star$，残差为 $r_k = b - A x_k$。当满足形如 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$ 的归一化残差准则时（其中 $\\tau  0$ 是一个指定的容差），许多代码会终止 Gauss-Seidel 迭代。\n\n从基本原理出发，解释为什么这种仅基于残差的准则对于 CFD 离散化中出现的病态系统可能具有误导性，并找出包含了问题缩放或 $\\lVert A^{-1} \\rVert$ 估计量的鲁棒停止准则。选择所有有效且有科学依据的选项。\n\nA. 当 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$ 时终止，因为残差直接衡量前向误差，且与条件数无关。\n\nB. 当范数后向误差很小时终止，即当\n$$\n\\frac{\\lVert r_k \\rVert_2}{\\lVert A \\rVert_2 \\lVert x_k \\rVert_2 + \\lVert b \\rVert_2} \\le \\tau,\n$$\n成立时终止。该准则衡量的是能使 $x_k$ 成为精确解的 $A$ 和 $b$ 的最小扰动的相对大小。\n\nC. 如果有一个估计量 $\\gamma_k \\approx \\lVert A^{-1} \\rVert_2$ 可用（例如，通过范数估计算法或预处理器质量指标得到），则当\n$$\n\\frac{\\gamma_k \\, \\lVert r_k \\rVert_2}{\\lVert x_k \\rVert_2} \\le \\tau,\n$$\n成立时终止。该准则是相对前向误差的一个可计算的上界。\n\nD. 当连续迭代解的变化很小时终止，即 $\\lVert x_{k+1} - x_k \\rVert_2 / \\lVert x_{k+1} \\rVert_2 \\le \\tau$，因为即使对于病态系统，这也总能约束前向误差。\n\nE. 通过构造一个非奇异对角缩放矩阵 $D$（例如，$D = \\mathrm{diag}(A)$）来应用对角平衡，并用 Gauss-Seidel 法求解缩放后的系统 $D^{-1} A x = D^{-1} b$；然后在当前迭代解的缩放范数后向误差满足\n$$\n\\frac{\\lVert D^{-1} r_k \\rVert_\\infty}{\\lVert D^{-1} A \\rVert_\\infty \\lVert x_k \\rVert_\\infty + \\lVert D^{-1} b \\rVert_\\infty} \\le \\tau,\n$$\n时终止。该方法减少了对不良变量缩放和单位差异的敏感性，而这在多物理场 CFD 模型中很常见。\n\n选择所有适用的选项。", "solution": "该问题要求解释为什么一个简单的归一化残差停止准则对于病态线性系统（例如由 CFD 中压力泊松方程离散化产生的系统）是不够的，并从给定的选项列表中找出更鲁棒的停止准则。\n\n### 问题陈述的验证\n\n**步骤1：提取已知条件**\n- **背景**：计算流体力学 (CFD) 中不可压缩流求解器的压力-速度耦合。\n- **方程**：压力泊松方程在均匀网格上被离散化。\n- **系统**：这产生一个稀疏线性系统 $A x = b$。\n- **矩阵性质**：$A$ 是对称正定 (SPD) 的。\n- **条件**：随着网格加密，$A$ 变得越来越病态。\n- **迭代方法**：使用 Gauss-Seidel 方法作为光滑子。\n- **符号**：\n    -   第 $k$ 次迭代解：$x_k$。\n    -   精确解：$x_\\star$，其中 $A x_\\star = b$。\n    -   误差：$e_k = x_k - x_\\star$。\n    -   残差：$r_k = b - A x_k$。\n- **标准准则**：$\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$，容差 $\\tau  0$。\n- **问题**：解释为什么这个准则对病态系统具有误导性，并找出包含了问题缩放或 $\\lVert A^{-1} \\rVert$ 估计量的鲁棒停止准则。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在数值线性代数及其在 CFD 中的应用方面有充分的依据。众所周知，在细网格上离散化诸如泊松方程之类的椭圆偏微分方程会产生大型、稀疏、对称正定且病态的线性系统。使用像 Gauss–Seidel 这样的迭代方法作为光滑子（例如，在多重网格循环中）是标准做法。前向误差、残差、后向误差和条件数的概念是数值分析的基础。\n- **良定性**：该问题是良定的。它要求进行定性解释并评估几个明确定义的数学准则，这些准则可以从基本原理进行分析。\n- **客观性**：语言精确、技术性强且没有主观性。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、良定的、客观的，并描述了科学计算中一个现实而重要的场景。我现在将开始解答。\n\n### 推导与分析\n\n问题的核心在于可计算的残差 $r_k$ 与我们希望控制但无法直接计算的真实误差 $e_k$ 之间的关系（因为计算 $e_k$ 需要未知的精确解 $x_\\star$）。\n\n定义如下：\n1.  误差：$e_k = x_k - x_\\star$\n2.  残差：$r_k = b - A x_k$\n\n由于精确解满足 $A x_\\star = b$，我们可以将残差与误差联系起来：\n$$\nr_k = A x_\\star - A x_k = A(x_\\star - x_k) = -A e_k\n$$\n根据这个基本关系，通过乘以 $A$ 的逆矩阵（因为 $A$ 是正定的，所以逆矩阵存在），我们可以用残差表示误差：\n$$\ne_k = -A^{-1} r_k\n$$\n对两边取向量范数，我们得到一个不等式：\n$$\n\\lVert e_k \\rVert \\le \\lVert A^{-1} \\rVert \\lVert r_k \\rVert\n$$\n这个不等式是理解问题的关键。它表明误差范数 $\\lVert e_k \\rVert$ 的上界是残差范数 $\\lVert r_k \\rVert$ 乘以逆矩阵的范数 $\\lVert A^{-1} \\rVert$。\n\n矩阵 $A$ 的条件数定义为 $\\kappa(A) = \\lVert A \\rVert \\lVert A^{-1} \\rVert$。对于一个病态矩阵，$\\kappa(A)$ 非常大。正如问题所述，对于离散化的泊松方程，随着网格加密，$A$ 变得越来越病态，这意味着 $\\kappa(A)$ 以及 $\\lVert A^{-1} \\rVert$ 会变得很大。\n\n因此，即使残差范数 $\\lVert r_k \\rVert$ 非常小，如果 $\\lVert A^{-1} \\rVert$ 很大，误差范数 $\\lVert e_k \\rVert$ 仍然可能很大。对于病态系统，小残差并不能保证小误差。\n\n我们来研究一下具体的准则 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$。这是一个归一化残差。我们通常关心的是相对误差 $\\lVert e_k \\rVert_2 / \\lVert x_\\star \\rVert_2$。它们之间的关系可以写成：\n$$\n\\frac{\\lVert e_k \\rVert_2}{\\lVert x_\\star \\rVert_2} \\le \\lVert A^{-1} \\rVert_2 \\frac{\\lVert r_k \\rVert_2}{\\lVert x_\\star \\rVert_2} = (\\lVert A \\rVert_2 \\lVert A^{-1} \\rVert_2) \\frac{\\lVert r_k \\rVert_2}{\\lVert A \\rVert_2 \\lVert x_\\star \\rVert_2} = \\kappa_2(A) \\frac{\\lVert r_k \\rVert_2}{\\lVert A \\rVert_2 \\lVert x_\\star \\rVert_2}\n$$\n使用 $\\lVert b \\rVert_2 = \\lVert Ax_\\star \\rVert_2 \\le \\lVert A \\rVert_2 \\lVert x_\\star \\rVert_2$，我们有 $\\frac{1}{\\lVert A \\rVert_2 \\lVert x_\\star \\rVert_2} \\le \\frac{1}{\\lVert b \\rVert_2}$。因此：\n$$\n\\frac{\\lVert e_k \\rVert_2}{\\lVert x_\\star \\rVert_2} \\le \\kappa_2(A) \\frac{\\lVert r_k \\rVert_2}{\\lVert b \\rVert_2}\n$$\n这最后一个不等式表明，相对误差的上界是归一化相对残差乘以条件数 $\\kappa_2(A)$。如果 $\\kappa_2(A)$ 很大（例如 $10^8$），那么 $\\tau = 10^{-6}$ 的归一化残差仍然可能对应高达 $10^2$ 的相对误差，这是不可接受的。这就是为什么仅基于残差的准则对于病态系统具有误导性。\n\n### 逐项分析\n\n**A. 当 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$ 时终止，因为残差直接衡量前向误差，且与条件数无关。**\n\n如上所述，前向误差 $e_k$ 和残差 $r_k$ 之间的关系是 $e_k = -A^{-1} r_k$。这种关系从根本上依赖于矩阵 $A$（及其逆矩阵），因此也依赖于其条件数。声称残差“直接衡量前向误差”并且“独立于条件数”在事实上是错误的。这个准则正是被指出的具有误导性的那个。\n\n**结论：错误。**\n\n**B. 当范数后向误差很小时终止，即当 $\\frac{\\lVert r_k \\rVert_2}{\\lVert A \\rVert_2 \\lVert x_k \\rVert_2 + \\lVert b \\rVert_2} \\le \\tau$ 成立时终止。该准则衡量的是能使 $x_k$ 成为精确解的 $A$ 和 $b$ 的最小扰动的相对大小。**\n\n该选项建议使用范数相对后向误差作为停止准则。对于一个近似解 $x_k$，后向误差问的是，对于问题数据 $(A, b)$，最小的扰动 $(\\Delta A, \\Delta b)$ 是什么，能使得 $x_k$ 成为受扰动系统 $(A+\\Delta A)x_k = b+\\Delta b$ 的精确解。数值线性代数中的一个标准结果给出了范数相对后向误差为：\n$$\n\\eta(x_k) = \\frac{\\lVert b - A x_k \\rVert}{\\lVert A \\rVert \\lVert x_k \\rVert + \\lVert b \\rVert} = \\frac{\\lVert r_k \\rVert}{\\lVert A \\rVert \\lVert x_k \\rVert + \\lVert b \\rVert}\n$$\n选项中的表达式（使用 $2$-范数）正是这个定义。其给出的物理解释也是正确的。这个准则被认为是鲁棒的，因为它与 $A$ 的条件数无关。它将问题从“$x_k$ 与 $x_\\star$ 有多接近？”（前向误差）重新定义为“$x_k$ 是否是一个邻近问题的精确解？”。如果输入数据 $A$ 和 $b$ 本身就存在不确定性（例如，离散化误差、测量误差），那么找到一个在该不确定性范围内的问题的精确解通常就足够了。一个小的后向误差能保证这一点。这是一个有科学依据且鲁棒的停止准则。\n\n**结论：正确。**\n\n**C. 如果有一个估计量 $\\gamma_k \\approx \\lVert A^{-1} \\rVert_2$ 可用（例如，通过范数估计算法或预处理器质量指标得到），则当 $\\frac{\\gamma_k \\, \\lVert r_k \\rVert_2}{\\lVert x_k \\rVert_2} \\le \\tau$ 成立时终止。该准则是相对前向误差的一个可计算的上界。**\n\n这个准则直接解决了病态问题。如初始推导所示，前向误差范数满足 $\\lVert e_k \\rVert_2 \\le \\lVert A^{-1} \\rVert_2 \\lVert r_k \\rVert_2$。为了得到相对前向误差 $\\lVert e_k \\rVert_2 / \\lVert x_\\star \\rVert_2$ 的估计值，可以使用近似 $\\lVert A^{-1} \\rVert_2 \\approx \\gamma_k$ 和 $\\lVert x_\\star \\rVert_2 \\approx \\lVert x_k \\rVert_2$（假设迭代已进行足够长的时间，使得 $x_k$ 是 $x_\\star$ 的一个合理近似）。这就得到了近似的相对误差：\n$$\n\\frac{\\lVert e_k \\rVert_2}{\\lVert x_\\star \\rVert_2} \\approx \\frac{\\gamma_k \\, \\lVert r_k \\rVert_2}{\\lVert x_k \\rVert_2}\n$$\n因此，选项中的准则是相对前向误差的一个可计算的估计。通过明确包含考虑了逆矩阵大范数的项 $\\gamma_k$，它避免了被小残差误导。这是一个标准的基于误差的停止准则，被认为是鲁棒的。逆矩阵的范数通常可以被高效地估计，例如，使用迭代的 Lanczos 类型方法或从预处理器的性质中得到。\n\n**结论：正确。**\n\n**D. 当连续迭代解的变化很小时终止，即 $\\lVert x_{k+1} - x_k \\rVert_2 / \\lVert x_{k+1} \\rVert_2 \\le \\tau$，因为即使对于病态系统，这也总能约束前向误差。**\n\n这个准则使用连续迭代解之间的差异作为收敛的代理指标。对于一个定常迭代法 $x_{k+1} = G x_k + c$，误差与迭代解的变化量之间的关系为 $e_k = (I-G)^{-1}(x_{k+1} - x_k)$。那么误差的范数上界为 $\\lVert e_k \\rVert \\le \\lVert (I-G)^{-1} \\rVert \\lVert x_{k+1} - x_k \\rVert$。项 $\\lVert (I-G)^{-1} \\rVert$ 取决于方法的收敛速度。对于收敛缓慢的方法，迭代矩阵的谱半径 $\\rho(G)$ 接近于 $1$，这使得 $\\lVert (I-G)^{-1} \\rVert$ 非常大。如问题所述的病态系统，对于像 Gauss–Seidel 这样的经典光滑子，会导致收敛缓慢（当网格尺寸 $h \\to 0$ 时，$\\rho(G) \\to 1$）。因此，一个非常小的变化量 $\\lVert x_{k+1} - x_k \\rVert$ 仍可能对应一个非常大的误差 $\\lVert e_k \\rVert$。声称这“即使对于病态系统也总能约束前向误差”是错误的。对于这类问题，这个准则以不可靠而著称。\n\n**结论：错误。**\n\n**E. 通过构造一个非奇异对角缩放矩阵 $D$（例如，$D = \\mathrm{diag}(A)$）来应用对角平衡，并用 Gauss-Seidel 法求解缩放后的系统 $D^{-1} A x = D^{-1} b$；然后在当前迭代解的缩放范数后向误差满足 $\\frac{\\lVert D^{-1} r_k \\rVert_\\infty}{\\lVert D^{-1} A \\rVert_\\infty \\lVert x_k \\rVert_\\infty + \\lVert D^{-1} b \\rVert_\\infty} \\le \\tau$ 时终止。该方法减少了对不良变量缩放和单位差异的敏感性，而这在多物理场 CFD 模型中很常见。**\n\n该选项提出了一个两步策略：先进行平衡处理，然后对缩放后的系统使用一个鲁棒的停止准则。\n1.  **平衡处理**：通过 $D^{-1}$（其中 $D$ 通常是 $A$ 的对角线）来缩放系统，将 $Ax=b$ 转换为 $\\hat{A}x = \\hat{b}$，其中 $\\hat{A} = D^{-1}A$ 且 $\\hat{b} = D^{-1}b$。这是一种标准的预处理技术，用于平衡矩阵的行，使得 $\\hat{A}$ 的对角线元素等于 $1$。这在多物理场问题中尤其重要，因为不同的方程（行）可能具有截然不同的单位和尺度，这会使任何基于范数的准则表现不佳。\n2.  **停止准则**：应用的准则是针对*缩放后*的系统 $\\hat{A}x = \\hat{b}$ 的范数相对后向误差（如选项 B），使用的是 $\\infty$-范数。缩放后系统的残差为 $\\hat{r}_k = \\hat{b} - \\hat{A} x_k = D^{-1}b - D^{-1}A x_k = D^{-1}r_k$。所给出的公式正是这个缩放后问题的后向误差。使用 $\\infty$-范数是实用且计算成本低的。\n\n这种组合方法非常鲁棒。平衡步骤解决了不良缩放和单位差异的问题，而后向误差准则为缩放后的问题提供了一个与条件数无关的解质量度量。这是一种复杂且有科学依据的方法。\n\n**结论：正确。**", "answer": "$$\\boxed{BCE}$$", "id": "3374029"}]}