{"hands_on_practices": [{"introduction": "共轭梯度（CG）法是求解对称正定（SPD）线性系统的基石，在计算流体动力学中尤其常见于压力泊松方程的求解。通过这个练习，你将亲手执行CG算法的最初几次迭代，从第一性原理出发，计算步长和搜索方向。这项实践不仅能巩固你对CG算法核心机制的理解，还能让你直观地看到残差是如何在$A$-正交方向上逐步被消除的。[@problem_id:3338514]", "problem": "在计算流体动力学中，用于不可压缩流的投影法，每个时间步的压力场是通过求解具有齐次狄利克雷边界条件的离散泊松方程得到的。考虑单位区间上的一个一维模型问题，其具有零狄利克雷边界条件，并在一个包含 $n=5$ 个内部点的均匀网格上进行离散化，这导出了一个稀疏对称正定线性系统 $A x = b$，其采用标准的三点模板。使用无量纲化的离散算子，该算子将网格间距因子吸收到右侧项中，因此系数矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 是一个三对角矩阵，其对角线上为 $2$，第一亚对角线和第一超对角线上为 $-1$，即：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}.\n$$\n假设在第一个内部节点处有局部强迫项，因此右侧项为 $b = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix}^{T}$，并选择初始猜测值 $x_{0} = \\begin{pmatrix} 0  0  0  0  0 \\end{pmatrix}^{T}$。\n\n从克雷洛夫子空间迭代法和共轭梯度 (CG) 法的第一性原理出发——即，$A$ 是对称正定的，残差为 $r_{k} = b - A x_{k}$，搜索方向是 $A$-共轭的，并且每一步都在仿射子空间上最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{T} A x - b^{T} x$——推导应用于此系统的 CG 法的前两次迭代。具体来说，构造 $p_{0}$，通过沿 $p_{0}$ 执行线搜索最小化来计算步长 $\\alpha_{0}$，更新 $x_{1}$ 和 $r_{1}$，通过强制 $p_{1}$ 与 $p_{0}$ 的 $A$-共轭性来推导系数 $\\beta_{0}$，然后计算 $\\alpha_{1}$、$x_{2}$ 和 $r_{2}$。\n\n按以下方式报告最终结果：\n- 提供 $x_{2}$ 的五个分量，后跟 $\\|r_{2}\\|_{2}$ 的值，所有值均为精确的有理数值。\n- 将最终答案表示为单行，使用括号，按顺序列出 $x_{2}$ 的各项，然后将 $\\|r_{2}\\|_{2}$ 作为最后一项，不带单位。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定的、客观的，并包含推导唯一解所需的所有必要信息。所描述的线性系统和共轭梯度 (CG) 法是数值线性代数和计算科学中的标准课题。\n\n任务是计算线性系统 $A x = b$ 的共轭梯度 (CG) 法的前两次迭代，其中矩阵 $A$、右侧向量 $b$ 和初始猜测值 $x_0$ 由下式给出：\n$$ A = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n矩阵 $A$ 是对称正定的，这是 CG 方法的先决条件。CG 算法迭代地构造一个近似解序列 $x_k$，该序列最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^T A x - b^T x$。\n\n**初始化 ($k=0$)**\n\n首先，我们计算初始残差 $r_0$。残差定义为 $r_k = b - A x_k$。\n对于 $k=0$，我们有：\n$$ r_0 = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n初始搜索方向 $p_0$ 设置为等于初始残差：\n$$ p_0 = r_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第一次迭代 ($k=0$)**\n\n第一步是计算最优步长 $\\alpha_0$，它最小化 $\\phi(x_0 + \\alpha_0 p_0)$。这个条件等价于使新残差 $r_1$ 与搜索方向 $p_0$ 正交，即 $r_1^T p_0 = 0$。因为 $r_1 = r_0 - \\alpha_0 A p_0$，我们有 $(r_0 - \\alpha_0 A p_0)^T p_0 = 0$，这给出了 $\\alpha_0$ 的公式：\n$$ \\alpha_0 = \\frac{r_0^T p_0}{p_0^T A p_0} $$\n由于 $p_0 = r_0$，这简化为 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$。首先，我们计算分子：\n$$ r_0^T r_0 = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1 $$\n接下来，我们计算矩阵向量积 $A p_0$：\n$$ A p_0 = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n现在，我们计算 $\\alpha_0$ 的分母：\n$$ p_0^T A p_0 = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2 $$\n因此，步长 $\\alpha_0$ 是：\n$$ \\alpha_0 = \\frac{1}{2} $$\n我们现在可以更新解向量 $x_1$：\n$$ x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n以及残差向量 $r_1$：\n$$ r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 1 \\\\ 0 - (-\\frac{1}{2}) \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**第二次迭代 ($k=1$)**\n\n首先，我们确定新的搜索方向 $p_1 = r_1 + \\beta_0 p_0$。选择系数 $\\beta_0$ 以强制 $p_1$ 和 $p_0$ 之间 $A$-共轭，即 $p_1^T A p_0 = 0$。\n$$ (r_1 + \\beta_0 p_0)^T A p_0 = 0 \\implies r_1^T A p_0 + \\beta_0 p_0^T A p_0 = 0 $$\n解出 $\\beta_0$：\n$$ \\beta_0 = - \\frac{r_1^T A p_0}{p_0^T A p_0} $$\n我们有前一步得到的向量 $r_1$、$A p_0$ 和值 $p_0^T A p_0=2$。分子是：\n$$ r_1^T A p_0 = \\begin{pmatrix} 0  1/2  0  0  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = -\\frac{1}{2} $$\n因此，$\\beta_0$ 是：\n$$ \\beta_0 = - \\frac{-1/2}{2} = \\frac{1}{4} $$\n一个常见的替代公式是 $\\beta_0 = (r_1^T r_1) / (r_0^T r_0)$。我们来验证一下：$r_1^T r_1 = (1/2)^2 = 1/4$ 且 $r_0^T r_0 = 1$，得到 $\\beta_0 = 1/4$，这与之前的结果一致。\n\n现在我们构造新的搜索方向 $p_1$：\n$$ p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n接下来，我们计算步长 $\\alpha_1$：\n$$ \\alpha_1 = \\frac{r_1^T r_1}{p_1^T A p_1} $$\n分子是 $r_1^T r_1 = 1/4$。对于分母，我们首先需要 $A p_1$：\n$$ A p_1 = \\begin{pmatrix}{ 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(\\frac{1}{4}) - 1(\\frac{1}{2}) \\\\ -1(\\frac{1}{4}) + 2(\\frac{1}{2}) \\\\ 0 - 1(\\frac{1}{2}) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n那么，分母是：\n$$ p_1^T A p_1 = \\begin{pmatrix} 1/4  1/2  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = (\\frac{1}{4})(0) + (\\frac{1}{2})(\\frac{3}{4}) = \\frac{3}{8} $$\n所以步长 $\\alpha_1$ 是：\n$$ \\alpha_1 = \\frac{1/4}{3/8} = \\frac{1}{4} \\cdot \\frac{8}{3} = \\frac{2}{3} $$\n我们更新解得到 $x_2$：\n$$ x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3/6 + 1/6 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2/3 \\\\ 1/3 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n最后，我们计算新的残差 $r_2$：\n$$ r_2 = r_1 - \\alpha_1 A p_1 = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{2}{3} \\begin{pmatrix} 0 \\\\ 3/4 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1/2 \\\\ -1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1/3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n问题要求 $x_2$ 的五个分量和 $r_2$ 的欧几里得范数，记作 $\\|r_2\\|_2$。\n$x_2$ 的分量是 $\\frac{2}{3}$、$\\frac{1}{3}$、$0$、$0$、$0$。\n$r_2$ 的范数是：\n$$ \\|r_2\\|_2 = \\sqrt{0^2 + 0^2 + (1/3)^2 + 0^2 + 0^2} = \\sqrt{\\frac{1}{9}} = \\frac{1}{3} $$\n最终结果由 $x_2$ 的五个分量和 $\\|r_2\\|_2$ 的值组成。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3}  0  0  0  \\frac{1}{3} \\end{pmatrix}} $$", "id": "3338514"}, {"introduction": "当系统矩阵非对称时（例如，当处理包含对流项的方程时），共轭梯度法不再适用，此时广义最小残差（GMRES）法便成为首选。这个练习将引导你完成GMRES的单次迭代，为一个小规模非对称系统构建一维克雷洛夫子空间，并求解最小二乘问题以最小化残差。通过这个过程，你将掌握GMRES的核心思想——在克雷洛夫子空间中寻找最优近似解。[@problem_id:3338495]", "problem": "在计算流体动力学 (CFD) 中，输运-扩散算子的隐式时间积分和线性化会产生形如 $A x = b$ 的线性系统，该系统必须被高效求解。克雷洛夫子空间迭代法通过在由系统矩阵的重复作用生成的空间中最小化残差来构造近似解。考虑由 $3 \\times 3$ 矩阵\n$$\nA = \\begin{pmatrix}\n4  1  0 \\\\\n0  3  1 \\\\\n0  0  2\n\\end{pmatrix}\n$$\n以及右端项\n$$\nb = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix},\n$$\n定义的线性系统，其初始近似解为 $x_{0} = \\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$。使用广义最小残差法 (GMRES)，执行恰好一次迭代（即，构造一维克雷洛夫子空间，并基于使用欧几里得内积的Arnoldi过程计算相应的 GMRES 更新）以获得 $x_{1}$。然后，计算残差 $r_{1} = b - A x_{1}$ 的欧几里得范数。\n\n以精确形式表示最终的残差范数，不要四舍五入。无需物理单位。", "solution": "该问题定义明确，要求应用广义最小残差法 (GMRES) 进行一次迭代。给定矩阵 $A$、右端向量 $b$ 和初始近似解 $x_0$。我们必须计算一次迭代后的残差的欧几里得范数 $\\|r_1\\|_2$。\n\nGMRES 方法从仿射空间 $x_0 + \\mathcal{K}_m(A, r_0)$ 中生成一个近似解 $x_m$，其中 $\\mathcal{K}_m(A, r_0)$ 是 $m$ 阶克雷洛夫子空间。选择解 $x_m$ 以最小化残差的欧几里得范数 $\\|b - A x_m\\|_2$。我们执行一次迭代的步骤，即 $m=1$。\n\n首先，我们计算初始残差 $r_0$。\n$$\nr_0 = b - A x_0\n$$\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$，项 $A x_0$ 是零向量。因此，初始残差等于 $b$：\n$$\nr_0 = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n接下来，我们计算 $r_0$ 的欧几里得范数：\n$$\n\\|r_0\\|_2 = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\nGMRES 方法使用 Arnoldi 过程为克雷洛夫子空间 $\\mathcal{K}_1(A, r_0) = \\text{span}\\{r_0\\}$ 构造一个标准正交基。对于 $m=1$，该基由单个向量 $v_1$ 组成，它是归一化的初始残差。\n$$\nv_1 = \\frac{r_0}{\\|r_0\\|_2} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n更新后的近似解 $x_1$ 的形式为 $x_1 = x_0 + z_1$，其中 $z_1 \\in \\mathcal{K}_1(A, r_0)$。这意味着 $z_1$ 可以写成 $v_1$ 的标量倍数，即对于某个标量 $y_1 \\in \\mathbb{R}$，有 $z_1 = y_1 v_1$。GMRES 方法通过求解一个最小二乘问题来找到最优的 $y_1$。\n近似解为 $x_1 = x_0 + y_1 v_1$。相应的残差为 $r_1 = b - A x_1 = b - A(x_0 + y_1 v_1) = (b - A x_0) - y_1 A v_1 = r_0 - y_1 A v_1$。选择系数 $y_1$ 以最小化 $\\|r_1\\|_2 = \\|r_0 - y_1 A v_1\\|_2$。这是一个经典的线性最小二乘问题，我们要在由 $A v_1$ 张成的子空间中寻找向量 $r_0$ 的最佳近似。解 $y_1 A v_1$ 是 $r_0$ 在 $A v_1$ 上的正交投影。这导出了正规方程：\n$$\n(A v_1)^T (r_0 - y_1 A v_1) = 0\n$$\n求解 $y_1$ 可得：\n$$\ny_1 = \\frac{(A v_1)^T r_0}{(A v_1)^T (A v_1)} = \\frac{(A v_1)^T r_0}{\\|A v_1\\|_2^2}\n$$\n我们计算必要的组成部分。首先，计算向量 $A v_1$：\n$$\nA v_1 = \\begin{pmatrix} 4  1  0 \\\\ 0  3  1 \\\\ 0  0  2 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n现在，我们计算 $y_1$ 表达式的分子：\n$$\n(A v_1)^T r_0 = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5  4  2 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{3}}(5 \\cdot 1 + 4 \\cdot 1 + 2 \\cdot 1) = \\frac{11}{\\sqrt{3}}\n$$\n接下来，我们计算分母：\n$$\n\\|A v_1\\|_2^2 = \\left\\| \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} \\right\\|_2^2 = \\frac{1}{(\\sqrt{3})^2} (5^2 + 4^2 + 2^2) = \\frac{1}{3}(25 + 16 + 4) = \\frac{45}{3} = 15\n$$\n现在我们可以计算 $y_1$ 了：\n$$\ny_1 = \\frac{11/\\sqrt{3}}{15} = \\frac{11}{15\\sqrt{3}}\n$$\n我们现在可以找到新的近似解 $x_1$：\n$$\nx_1 = x_0 + y_1 v_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{11}{15\\sqrt{3}} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{15 \\cdot 3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n问题要求计算残差 $r_1 = b - A x_1$ 的欧几里得范数。让我们来计算 $r_1$：\n$$\nA x_1 = \\begin{pmatrix} 4  1  0 \\\\ 0  3  1 \\\\ 0  0  2 \\end{pmatrix} \\left( \\frac{11}{45} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{11}{45} \\begin{pmatrix} 4(1)+1(1)+0(1) \\\\ 0(1)+3(1)+1(1) \\\\ 0(1)+0(1)+2(1) \\end{pmatrix} = \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n$$\nr_1 = b - A x_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{11}{45} \\begin{pmatrix} 5 \\\\ 4 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{55}{45} \\\\ 1 - \\frac{44}{45} \\\\ 1 - \\frac{22}{45} \\end{pmatrix} = \\begin{pmatrix} \\frac{45-55}{45} \\\\ \\frac{45-44}{45} \\\\ \\frac{45-22}{45} \\end{pmatrix} = \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{pmatrix}\n$$\n最后，我们计算 $r_1$ 的欧几里得范数：\n$$\n\\|r_1\\|_2 = \\left\\| \\frac{1}{45} \\begin{pmatrix} -10 \\\\ 1 \\\\ 23 \\end{pmatrix} \\right\\|_2 = \\frac{1}{45} \\sqrt{(-10)^2 + 1^2 + 23^2}\n$$\n平方根内的各项是：\n$(-10)^2 = 100$\n$1^2 = 1$\n$23^2 = 529$\n将这些项相加得到 $100 + 1 + 529 = 630$。所以，\n$$\n\\|r_1\\|_2 = \\frac{\\sqrt{630}}{45}\n$$\n为简化表达式，我们对数字 $630$ 进行因式分解：\n$$\n630 = 63 \\times 10 = (9 \\times 7) \\times (2 \\times 5) = 3^2 \\times 70\n$$\n因此，$\\sqrt{630} = \\sqrt{3^2 \\times 70} = 3\\sqrt{70}$。\n将此代入范数的表达式中：\n$$\n\\|r_1\\|_2 = \\frac{3\\sqrt{70}}{45} = \\frac{\\sqrt{70}}{15}\n$$\n这就是 GMRES 一次迭代后残差的欧几里得范数的最终精确值。", "answer": "$$\n\\boxed{\\frac{\\sqrt{70}}{15}}\n$$", "id": "3338495"}, {"introduction": "克雷洛夫子空间方法的收敛行为可能非常微妙，并且不仅仅取决于矩阵的谱。此练习旨在揭示初始猜测值$x_0$如何通过影响初始残差$r_0 = b - A x_0$来塑造整个克雷洛夫子空间，进而决定迭代的路径和效率。通过比较两种不同初始猜测下的GMRES迭代结果，你将深入理解算法性能与初始条件之间的深刻联系。[@problem_id:3338517]", "problem": "一个源于对三个无耦合控制体上的标量扩散问题进行解耦有限体积离散化所产生的线性代数子问题，其线性系统为 $A x = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 由 $A = \\operatorname{diag}(1, 2, 4)$ 给出，而 $b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。考虑应用一次广义最小残差方法（GMRES, Generalized Minimal Residual）的迭代来近似求解，该迭代在仿射空间 $x_{0} + \\mathcal{K}_{1}(A, r_{0})$ 上最小化残差，其中 $\\mathcal{K}_{k}(A, r_{0})$ 表示由 $A$ 和初始残差 $r_{0} = b - A x_{0}$ 生成的 $k$ 步克雷洛夫子空间。提出了两种不同的初始猜测：\n- $x_{0}^{(a)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$，\n- $x_{0}^{(b)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix}$。\n\n从第一性原理出发——即残差 $r = b - A x$ 的定义、欧几里得范数以及单步克雷洛夫子空间 $\\mathcal{K}_{1}(A, r_{0}) = \\operatorname{span}\\{r_{0}\\}$ 的特性——推导与单步 GMRES 更新相关的一阶残差多项式 $p_{1}(z)$ 的一般形式，并利用它为每个初始猜测显式计算 $p_{1}(z)$。然后，计算两种初始猜测下所得的单步残差的欧几里得范数，并给出比值的精确值\n$$\n\\frac{\\|r_{1}^{(b)}\\|_{2}}{\\|r_{1}^{(a)}\\|_{2}} \\, .\n$$\n在您的推理中，解释初始猜测 $x_{0}$ 的选择如何改变生成的克雷洛夫子空间 $\\mathcal{K}_{k}(A, r_{0})$ 和可达到的残差多项式。最终答案必须以单个精确表达式的形式给出，不得进行四舍五入。", "solution": "该问题要求在两种不同的初始猜测 $x_{0}^{(a)}$ 和 $x_{0}^{(b)}$ 下，对特定线性系统 $A x = b$ 分析广义最小残差方法 (GMRES) 的一次迭代。我们必须首先验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 线性系统：$A x = b$\n- 系统矩阵：$A = \\operatorname{diag}(1, 2, 4) \\in \\mathbb{R}^{3 \\times 3}$\n- 右端向量：$b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n- 方法：一次 GMRES 迭代\n- 克雷洛夫子空间：$\\mathcal{K}_{k}(A, r_{0}) = \\operatorname{span}\\{r_{0}, A r_{0}, \\dots, A^{k-1} r_{0}\\}$\n- 迭代空间：第 $k$ 次迭代的解 $x_k$ 位于仿射空间 $x_{0} + \\mathcal{K}_{k}(A, r_{0})$ 中。对于本问题，$k=1$，因此 $x_1 \\in x_0 + \\mathcal{K}_1(A, r_0)$。\n- 初始残差：$r_{0} = b - A x_{0}$\n- 第一个初始猜测：$x_{0}^{(a)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n- 第二个初始猜测：$x_{0}^{(b)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix}$\n- 目标：计算精确比值 $\\frac{\\|r_{1}^{(b)}\\|_{2}}{\\|r_{1}^{(a)}\\|_{2}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是数值线性代数中的一个标准练习，将成熟的 GMRES 算法应用于一个简单、明确定义的线性系统。所有概念都是计算科学的基础。\n- **适定性：** 矩阵 $A$ 是对角矩阵，且对角元素非零（$\\operatorname{det}(A) = 1 \\cdot 2 \\cdot 4 = 8 \\neq 0$），因此它是可逆的，系统 $A x = b$ 有唯一解。GMRES 迭代是一个确定性过程，会产生唯一的结果。该问题是适定的。\n- **目标：** 问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n- **不完整或矛盾的设置：** 提供了所有必要的信息，没有矛盾之处。\n\n**步骤 3：结论与行动**\n该问题是有效的。我将进行完整的理论推导和求解。\n\n### 推导与求解\n\nGMRES 方法通过在仿射空间 $x_0 + \\mathcal{K}_k(A, r_0)$ 上最小化残差的欧几里得范数 $\\|r_k\\|_2 = \\|b - A x_k\\|_2$ 来构造系统 $A x = b$ 的近似解 $x_k$。对于一次迭代（$k=1$），搜索空间为 $x_0 + \\mathcal{K}_1(A, r_0)$。单步克雷洛夫子空间定义为 $\\mathcal{K}_1(A, r_0) = \\operatorname{span}\\{r_0\\}$。\n\n因此，第一次迭代的解 $x_1$ 具有形式 $x_1 = x_0 + \\alpha r_0$，其中 $\\alpha \\in \\mathbb{R}$ 是一个标量。相应的残差 $r_1$ 由下式给出：\n$$ r_1 = b - A x_1 = b - A(x_0 + \\alpha r_0) = (b - A x_0) - \\alpha A r_0 = r_0 - \\alpha A r_0 $$\nGMRES 通过求解一维最小二乘问题来确定最优的 $\\alpha$：\n$$ \\min_{\\alpha \\in \\mathbb{R}} \\|r_1\\|_2^2 = \\min_{\\alpha \\in \\mathbb{R}} \\|r_0 - \\alpha A r_0\\|_2^2 $$\n当 $r_1$ 与搜索方向 $A r_0$ 所张成的子空间正交时，达到最小值。因此，我们必须有 $(A r_0)^T r_1 = 0$。\n$$ (A r_0)^T (r_0 - \\alpha A r_0) = 0 $$\n$$ (A r_0)^T r_0 - \\alpha (A r_0)^T (A r_0) = 0 $$\n求解 $\\alpha$ 可得：\n$$ \\alpha = \\frac{(A r_0)^T r_0}{(A r_0)^T (A r_0)} = \\frac{(A r_0)^T r_0}{\\|A r_0\\|_2^2} $$\n单步残差为 $r_1 = (I - \\alpha A)r_0$。这可以用残差多项式表示。对于一个 $k$ 步 GMRES 过程，残差多项式 $p_k(z)$ 是一个次数至多为 $k$ 且满足 $p_k(0) = 1$ 的多项式。对于 $k=1$，多项式为 $p_1(z) = 1 - \\alpha z$。残差为 $r_1 = p_1(A)r_0$。因此，一阶残差多项式的一般形式为：\n$$ p_1(z) = 1 - \\left( \\frac{(A r_0)^T r_0}{\\|A r_0\\|_2^2} \\right) z $$\n这个多项式是最优的，因为它在所有次数至多为 1 且满足 $p_1(0)=1$ 的多项式中，最小化了 $\\|p_1(A)r_0\\|_2$。\n\n现在，我们将此框架应用于两个指定的初始猜测。\n\n**情况 (a)：初始猜测 $x_0^{(a)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$**\n\n首先，我们计算初始残差 $r_0^{(a)}$：\n$$ r_0^{(a)} = b - A x_0^{(a)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n接下来，我们计算向量 $A r_0^{(a)}$：\n$$ A r_0^{(a)} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} $$\n现在我们求最优系数 $\\alpha^{(a)}$：\n$$ \\alpha^{(a)} = \\frac{(A r_0^{(a)})^T r_0^{(a)}}{\\|A r_0^{(a)}\\|_2^2} = \\frac{\\begin{pmatrix} 1  2  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}}{1^2 + 2^2 + 0^2} = \\frac{1 \\cdot 1 + 2 \\cdot 1 + 0 \\cdot 0}{1 + 4} = \\frac{3}{5} $$\n此情况下的残差多项式为 $p_1^{(a)}(z) = 1 - \\frac{3}{5}z$。得到的残差 $r_1^{(a)}$ 是：\n$$ r_1^{(a)} = r_0^{(a)} - \\alpha^{(a)} A r_0^{(a)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\frac{3}{5} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{3}{5} \\\\ 1 - \\frac{6}{5} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{5} \\\\ -\\frac{1}{5} \\\\ 0 \\end{pmatrix} $$\n该残差的欧几里得范数的平方是：\n$$ \\|r_1^{(a)}\\|_2^2 = \\left(\\frac{2}{5}\\right)^2 + \\left(-\\frac{1}{5}\\right)^2 + 0^2 = \\frac{4}{25} + \\frac{1}{25} = \\frac{5}{25} = \\frac{1}{5} $$\n因此，$\\|r_1^{(a)}\\|_2 = \\sqrt{\\frac{1}{5}} = \\frac{1}{\\sqrt{5}}$。\n\n**情况 (b)：初始猜测 $x_0^{(b)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix}$**\n\n类似地，我们计算初始残差 $r_0^{(b)}$：\n$$ r_0^{(b)} = b - A x_0^{(b)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} $$\n接下来，我们计算向量 $A r_0^{(b)}$：\n$$ A r_0^{(b)} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ -4 \\end{pmatrix} $$\n现在我们求最优系数 $\\alpha^{(b)}$：\n$$ \\alpha^{(b)} = \\frac{(A r_0^{(b)})^T r_0^{(b)}}{\\|A r_0^{(b)}\\|_2^2} = \\frac{\\begin{pmatrix} 1  2  -4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix}}{1^2 + 2^2 + (-4)^2} = \\frac{1 \\cdot 1 + 2 \\cdot 1 + (-4) \\cdot (-1)}{1 + 4 + 16} = \\frac{1+2+4}{21} = \\frac{7}{21} = \\frac{1}{3} $$\n此情况下的残差多项式为 $p_1^{(b)}(z) = 1 - \\frac{1}{3}z$。得到的残差 $r_1^{(b)}$ 是：\n$$ r_1^{(b)} = r_0^{(b)} - \\alpha^{(b)} A r_0^{(b)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 2 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{1}{3} \\\\ 1 - \\frac{2}{3} \\\\ -1 + \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix} $$\n该残差的欧几里得范数的平方是：\n$$ \\|r_1^{(b)}\\|_2^2 = \\left(\\frac{2}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 = \\frac{4}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{6}{9} = \\frac{2}{3} $$\n因此，$\\|r_1^{(b)}\\|_2 = \\sqrt{\\frac{2}{3}}$。\n\n按要求，我们解释初始猜测 $x_0$ 的作用。$x_0$ 的选择决定了初始残差 $r_0 = b - Ax_0$。克雷洛夫子空间 $\\mathcal{K}_k(A, r_0)$ 由这个初始残差生成。因此，不同的 $x_0$ 会导致不同的 $r_0$，进而生成不同的克雷洛夫子空间。残差范数的最小化是在这个子空间上进行的。最优残差多项式 $p_k(z)$ 的选择是为了最小化 $\\|p_k(A)r_0\\|_2$。由于向量 $r_0$ 和要最小化的量都依赖于 $x_0$，因此最优多项式本身也依赖于初始猜测。在本问题中，我们找到了两个不同的最优多项式 $p_1^{(a)}(z) \\neq p_1^{(b)}(z)$，因为初始残差 $r_0^{(a)}$ 和 $r_0^{(b)}$ 是不同的。具体来说，$r_0^{(a)}$ 在第三个特征向量的方向上没有分量，因此情况 (a) 的单步 GMRES 过程对特征值 $\\lambda_3=4$ 是“盲”的。相比之下，$r_0^{(b)}$ 在所有三个特征方向上都有分量，因此最小化过程必须考虑 $A$ 的所有三个特征值。\n\n最后，我们计算范数的比值：\n$$ \\frac{\\|r_{1}^{(b)}\\|_{2}}{\\|r_{1}^{(a)}\\|_{2}} = \\frac{\\sqrt{\\frac{2}{3}}}{\\sqrt{\\frac{1}{5}}} = \\sqrt{\\frac{2/3}{1/5}} = \\sqrt{\\frac{2}{3} \\cdot \\frac{5}{1}} = \\sqrt{\\frac{10}{3}} $$\n这就是所要求的精确值。", "answer": "$$\\boxed{\\sqrt{\\frac{10}{3}}}$$", "id": "3338517"}]}