{"hands_on_practices": [{"introduction": "理论是必要的，但真正的理解来自于实践。本节将通过求解一个经典的流体动力学问题——斯托克斯第一问题，来指导你完成向后欧拉法的第一个动手实践。这个练习的核心在于将偏微分方程离散化为一个线性方程组，并通过求解该方程组来推进一个时间步长，从而让你亲身体验隐式方法的核心机制。[@problem_id:3293764]", "problem": "考虑在脉冲式启动的无限大平板上方，不可压缩牛顿流体的 Stokes 第一问题。设位于 $y=0$ 的平板在时间 $t=0^{+}$ 时，以恒定速度 $U$ 沿 $x$ 方向开始运动，在 $t=0$ 时 $y>0$ 区域的流体处于静止状态。在标准的单向、流向均匀假设和零流向压力梯度下，$x$ 方向的动量平衡简化为扩散偏微分方程（PDE）\n$$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0,$$\n其初始条件和边界条件为\n$$u(y,0)=0,\\quad u(0,t)=U,\\quad \\lim_{y\\to\\infty}u(y,t)=0.$$\n对于有限域数值近似，将域截断为 $y\\in[0,L]$，其中 $L$ 足够大，并施加 $u(L,t)=0$ 作为远场边界条件。将 $[0,L]$ 均匀离散化为 $M$ 个等长子区间，每个子区间大小为 $h=L/M$，得到网格点 $y_{j}=j\\,h$，其中 $j=0,1,\\dots,M$。令 $u_{j}^{n}\\approx u(y_{j},t^{n})$，其中 $t^{n}=n\\,\\Delta t$。使用后向欧拉时间积分和空间上的二阶中心有限差分法，在内部节点 $j=1,\\dots,M-1$ 处近似该偏微分方程：\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}.$$\n假设在新的时间层级上施加脉冲边界条件，$u_{0}^{n+1}=U$（对于 $n\\ge 0$），而远场边界条件为 $u_{M}^{n+1}=0$；初始内部状态为静止，$u_{j}^{0}=0$（对于 $j=1,\\dots,M-1$）。\n\n取以下具体的、物理上一致的参数\n$$\\nu=0.01\\,\\mathrm{m^{2}/s},\\quad U=1\\,\\mathrm{m/s},\\quad L=0.3\\,\\mathrm{m},\\quad M=3,\\quad \\Delta t=1\\,\\mathrm{s}.$$\n这些参数意味着 $h=L/M=0.1\\,\\mathrm{m}$ 以及 $y_{1}=0.1\\,\\mathrm{m}$，$y_{2}=0.2\\,\\mathrm{m}$。执行从 $t^{0}=0$ 到 $t^{1}=\\Delta t$ 的单个后向欧拉步，精确求解得到的关于内部未知数 $u_{1}^{1}$ 和 $u_{2}^{1}$ 的线性系统。\n\nStokes 第一问题的精确解析解为\n$$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg),$$\n其中 $\\mathrm{erfc}$ 表示互补误差函数。使用该解析解，计算在时间 $t^{1}$ 时内部节点上的离散均方根（RMS）误差，\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}.$$\n\n计算指定参数下的 $E_{\\mathrm{RMS}}$。最终答案以 $\\mathrm{m/s}$ 为单位，并四舍五入到四位有效数字。", "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：$x$ 方向的动量平衡由扩散偏微分方程给出：\n    $$\\frac{\\partial u}{\\partial t}=\\nu\\,\\frac{\\partial^{2}u}{\\partial y^{2}},\\quad y\\ge 0,\\; t>0$$\n-   **初始和边界条件（解析）**：\n    -   初始条件：$u(y,0)=0$。\n    -   边界条件：$u(0,t)=U$，$\\lim_{y\\to\\infty}u(y,t)=0$。\n-   **数值离散化**：\n    -   截断域：$y\\in[0,L]$。\n    -   离散化参数：$M$ 个子区间，$h=L/M$，$y_j=j\\,h$ 对于 $j=0,1,\\dots,M$。\n    -   时间步长：$\\Delta t$，$t^n = n\\,\\Delta t$。\n    -   记法：$u_j^n \\approx u(y_j, t^n)$。\n    -   有限差分格式（时间上为后向欧拉法，空间上为二阶中心差分）：\n        $$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\n    -   数值初始条件：$u_j^0 = 0$ 对于 $j=1,\\dots,M-1$。\n    -   数值边界条件：$u_0^{n+1}=U$ 对于 $n\\ge 0$，$u_M^{n+1}=0$。\n-   **物理和数值参数**：\n    -   运动粘度：$\\nu=0.01\\,\\mathrm{m^{2}/s}$。\n    -   平板速度：$U=1\\,\\mathrm{m/s}$。\n    -   区域长度：$L=0.3\\,\\mathrm{m}$。\n    -   子区间数量：$M=3$。\n    -   时间步长：$\\Delta t=1\\,\\mathrm{s}$。\n-   **精确解析解**：\n    $$u(y,t)=U\\,\\mathrm{erfc}\\!\\Bigg(\\frac{y}{2\\sqrt{\\nu t}}\\Bigg)$$\n-   **误差度量**：在 $t^1$ 时刻内部节点上的离散均方根（RMS）误差。\n    $$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}}$$\n-   **任务**：计算给定参数下的 $E_{\\mathrm{RMS}}$，并四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于 Stokes 第一问题，这是 Navier-Stokes 方程的一个基本精确解，可用扩散（或热）方程建模。所使用的数值方法，后向欧拉法，是一种标准的、经过充分分析的隐式格式。所有原理在科学上和数学上都是合理的。\n2.  **适定性**：该偏微分方程及其给定的初始和边界条件是一个经典的适定问题。数值任务也是适定的；后向欧拉法是无条件稳定的，对于给定参数，它会产生一个非奇异的线性方程组，保证了唯一解的存在。\n3.  **客观性**：问题以精确、定量和客观的语言陈述，没有歧义或主观性陈述。\n4.  **完整性和一致性**：所有必要的数据、方程和条件都已提供。参数在物理上是一致的。任务定义明确。\n5.  **非病态或结构不良**：问题结构清晰，引导求解者从数值设置到误差计算。问题没有歧义。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个计算流体力学和数值分析中的标准、定义明确的练习。现在开始求解过程。\n\n#### $t^1$ 时的数值解\n所提供的有限差分格式为：\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{h^{2}}$$\n我们重排此方程，以分离出新时间层级 $n+1$ 的项：\n$$u_{j}^{n+1} - \\frac{\\nu \\Delta t}{h^2} \\left(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}\\right) = u_{j}^{n}$$\n令 $r = \\frac{\\nu \\Delta t}{h^2}$ 为扩散数。方程变为：\n$$-r u_{j-1}^{n+1} + (1+2r)u_{j}^{n+1} - r u_{j+1}^{n+1} = u_{j}^{n}$$\n给定参数 $\\nu=0.01\\,\\mathrm{m^2/s}$, $L=0.3\\,\\mathrm{m}$, $M=3$, 和 $\\Delta t=1\\,\\mathrm{s}$。空间网格间距 $h$ 为：\n$$h = \\frac{L}{M} = \\frac{0.3}{3} = 0.1\\,\\mathrm{m}$$\n扩散数 $r$ 为：\n$$r = \\frac{(0.01\\,\\mathrm{m^2/s})(1\\,\\mathrm{s})}{(0.1\\,\\mathrm{m})^2} = \\frac{0.01}{0.01} = 1$$\n我们想要求解第一个时间步 $t^1 = \\Delta t = 1\\,\\mathrm{s}$ 时的解。未知数是内部节点处的速度 $u_1^1$ 和 $u_2^1$（因为 $M=3$，内部节点为 $j=1,2$）。初始条件为 $u_1^0 = 0$ 和 $u_2^0 = 0$。在时间 $t^1$ 时的边界条件为 $u_0^1 = U = 1$ 和 $u_3^1 = 0$。\n\n我们为每个内部节点 $j=1,2$ 写出格式：\n对于 $j=1$：\n$$-r u_{0}^{1} + (1+2r)u_{1}^{1} - r u_{2}^{1} = u_{1}^{0}$$\n代入已知值（$r=1$, $u_0^1=1$, $u_1^0=0$）：\n$$-(1)(1) + (1+2(1))u_{1}^{1} - (1)u_{2}^{1} = 0 \\implies 3u_{1}^{1} - u_{2}^{1} = 1$$\n对于 $j=2$：\n$$-r u_{1}^{1} + (1+2r)u_{2}^{1} - r u_{3}^{1} = u_{2}^{0}$$\n代入已知值（$r=1$, $u_3^1=0$, $u_2^0=0$）：\n$$-(1)u_{1}^{1} + (1+2(1))u_{2}^{1} - (1)(0) = 0 \\implies -u_{1}^{1} + 3u_{2}^{1} = 0$$\n我们现在求解这个 $2 \\times 2$ 线性系统：\n$$3u_{1}^{1} - u_{2}^{1} = 1$$\n$$-u_{1}^{1} + 3u_{2}^{1} = 0$$\n由第二个方程，得 $u_{1}^{1} = 3u_{2}^{1}$。代入第一个方程：\n$$3(3u_{2}^{1}) - u_{2}^{1} = 1 \\implies 9u_2^1 - u_2^1 = 1 \\implies 8u_2^1 = 1 \\implies u_2^1 = \\frac{1}{8} = 0.125$$\n则，$u_{1}^{1} = 3 \\left(\\frac{1}{8}\\right) = \\frac{3}{8} = 0.375$。\n数值解为 $u_1^1 = 0.375\\,\\mathrm{m/s}$ 和 $u_2^1 = 0.125\\,\\mathrm{m/s}$。\n\n#### $t^1$ 时的精确解\n精确解为 $u(y,t)=U\\,\\mathrm{erfc}\\!\\left(\\frac{y}{2\\sqrt{\\nu t}}\\right)$。\n我们在 $t^1 = 1\\,\\mathrm{s}$ 时，对内部节点 $y_1=h=0.1\\,\\mathrm{m}$ 和 $y_2=2h=0.2\\,\\mathrm{m}$ 进行求值。\nerfc 函数的参数为 $\\frac{y}{2\\sqrt{\\nu t}} = \\frac{y}{2\\sqrt{(0.01)(1)}} = \\frac{y}{0.2} = 5y$。\n当 $U=1$ 时，$u(y,1) = \\mathrm{erfc}(5y)$。\n\n对于 $j=1$ ($y_1=0.1\\,\\mathrm{m}$):\n$$u(y_1, t^1) = \\mathrm{erfc}(5 \\times 0.1) = \\mathrm{erfc}(0.5) \\approx 0.47950012$$\n对于 $j=2$ ($y_2=0.2\\,\\mathrm{m}$):\n$$u(y_2, t^1) = \\mathrm{erfc}(5 \\times 0.2) = \\mathrm{erfc}(1.0) \\approx 0.15729921$$\n\n#### RMS 误差计算\nRMS 误差由下式给出：\n$$E_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{M-1}\\sum_{j=1}^{M-1}\\Big(u_{j}^{1}-u(y_{j},t^{1})\\Big)^{2}} = \\sqrt{\\frac{1}{2}\\left[\\left(u_1^1 - u(y_1,t^1)\\right)^2 + \\left(u_2^1 - u(y_2,t^1)\\right)^2\\right]}$$\n每个节点的误差为：\n$$e_1 = u_1^1 - u(y_1,t^1) = 0.375 - 0.47950012 = -0.10450012$$\n$$e_2 = u_2^1 - u(y_2,t^1) = 0.125 - 0.15729921 = -0.03229921$$\n现在我们计算 RMS 误差：\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[(-0.10450012)^2 + (-0.03229921)^2\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[0.010920275 + 0.001043239\\right]}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}(0.011963514)}$$\n$$E_{\\mathrm{RMS}} = \\sqrt{0.005981757}$$\n$$E_{\\mathrm{RMS}} \\approx 0.077341814\\,\\mathrm{m/s}$$\n四舍五入到四位有效数字，结果为 $0.07734$。", "answer": "$$ \\boxed{0.07734} $$", "id": "3293764"}, {"introduction": "在真实的计算流体动力学（CFD）应用中，我们常常需要处理包含多种物理过程的复杂方程，例如对流和扩散。这个练习将引导你实现并比较一种混合隐式-显式（IMEX）方案和一个全隐式方案，用于求解对流-扩散方程。通过在不同物理参数下对比它们的精度和计算成本，你将深入理解在刚性项（如扩散）和非刚性项（如对流）之间进行权衡的实用策略。[@problem_id:3293758]", "problem": "考虑一维线性平流-扩散初值问题，定义在周期性域上：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in [0,L], \\quad t \\ge 0,\n$$\n具有周期性边界条件和初始条件\n$$\nu(x,0) = \\sin\\!\\big(2\\pi k_0 x\\big).\n$$\n你将构建并分析一个隐式-显式（IMEX）时间积分格式，该格式用后向欧拉法隐式处理扩散项，并显式处理平流项。你还将把它与一个全隐式的后向欧拉格式进行比较，后者同时隐式处理平流项和扩散项。空间离散化必须在均匀的周期性网格上使用一致的有限差分模板进行，时间步进必须应用于得到的线方法半离散系统。\n\n你必须按以下步骤从基本原理出发。\n\n- 从偏微分方程开始，在具有 $N$ 个点和网格间距 $\\Delta x = L/N$ 的均匀周期性网格上对空间进行离散化。\n- 使用一阶迎风差分近似平流导数（假设 $a \\ge 0$）：\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}.\n$$\n- 使用标准的中心二阶差分近似扩散二阶导数：\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}.\n$$\n- 在线方法的意义上，构建从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的一个时间步的 IMEX 后向欧拉-前向欧拉更新格式：\n$$\n\\big(I - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t \\, a \\, D_\\text{up} \\, \\mathbf{u}^n,\n$$\n其中 $D_\\text{up}$ 是迎风一阶导数矩阵，$D_2$ 是周期性网格上的中心二阶导数矩阵。\n- 构建同时隐式处理两项的全隐式后向欧拉更新格式：\n$$\n\\big(I + \\Delta t \\, a \\, D_\\text{up} - \\Delta t \\, \\nu D_2\\big) \\, \\mathbf{u}^{n+1} = \\mathbf{u}^n.\n$$\n\n通过 von Neumann 分析，推导 IMEX 格式的显式平流稳定性限制，并证明时间步长必须满足\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}.\n$$\n清楚地说明推导中使用的任何假设，以及为什么用后向欧拉法处理扩散项时不会引入额外的限制。\n\n你将使用周期性均匀网格和周期性差分算子实现这两种格式。为了在周期性网格上进行线性求解的效率和数值精确性，你必须通过离散傅里叶变换对循环算子进行对角化，并使用 $D_\\text{up}$ 和 $D_2$ 的符号在傅里叶空间中逐个模式地实现这些步骤：\n$$\n\\widehat{D_\\text{up}}(\\theta) = \\frac{1 - e^{-i\\theta}}{\\Delta x}, \\qquad \\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2},\n$$\n其中 $\\theta = 2\\pi m/N$，对于 $m \\in \\{0,1,\\dots,N-1\\}$。\n\n使用所选初始条件的连续问题的精确解，\n$$\nu_\\text{exact}(x,t) = \\exp\\!\\big(-\\nu (2\\pi k_0)^2 t\\big) \\, \\sin\\!\\big(2\\pi k_0 (x - a t)\\big),\n$$\n来计算最终时间 $T$ 的离散 $L^2$ 误差：\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}.\n$$\n\n你的程序必须实现以下具有共享参数和多种粘性系数方案的测试套件：\n- 共享参数：$L = 1$，$a = 1$，$k_0 = 2$，$N = 256$，$T = 0.5$。\n- 粘性系数值：$\\nu \\in \\{10^{-4}, 10^{-2}, 10^{-1}\\}$。\n\n对于测试套件中的每个粘性系数 $\\nu$：\n- 计算你的推导所隐含的显式 Courant–Friedrichs–Lewy 时间步长限制 $\\Delta t_\\text{CFL} = \\Delta x / |a|$。\n- 使用 $\\Delta t = 0.9 \\, \\Delta t_\\text{CFL}$ 运行 IMEX 格式，采用统一的步数以精确达到 $T$（即，选择步数 $M = \\lceil T/\\Delta t \\rceil$，然后设置 $\\Delta t = T/M$）。\n- 使用与 IMEX 运行相同的 $\\Delta t$ 和步数 $M$ 运行全隐式格式。\n- 此外，使用一个四倍大的名义步长 $\\tilde{\\Delta t} = 4 \\times 0.9 \\, \\Delta t_\\text{CFL}$ 运行全隐式格式，同样选择步数 $\\tilde{M} = \\lceil T/\\tilde{\\Delta t} \\rceil$，然后设置 $\\tilde{\\Delta t} = T/\\tilde{M}$。\n\n对于每个粘性系数 $\\nu$，报告以下七个量：\n- 稳定性界限 $\\Delta t_\\text{CFL}$。\n- 在时间 $T$ 时，使用上述 $\\Delta t$ 的 IMEX 格式的离散 $L^2$ 误差。\n- 在时间 $T$ 时，使用相同 $\\Delta t$ 的全隐式格式的离散 $L^2$ 误差。\n- 在时间 $T$ 时，使用较粗步长 $\\tilde{\\Delta t}$ 的全隐式格式的离散 $L^2$ 误差。\n- IMEX 运行使用的时间步数 $M$。\n- 在相同 $\\Delta t$ 下全隐式运行使用的时间步数 $M$。\n- 在较粗步长下全隐式运行使用的时间步数 $\\tilde{M}$。\n\n最终输出格式要求：\n- 你的程序应生成单行输出，其中包含所有粘性系数的结果，按测试套件中粘性系数的顺序连接，作为一个用方括号括起来的逗号分隔列表。例如，输出应如下所示：\n$$\n[\\Delta t_{\\text{CFL},1}, \\|e\\|_{\\text{IMEX},1}, \\|e\\|_{\\text{IMP},1}, \\|e\\|_{\\text{IMP-4x},1}, M_1, M_1, \\tilde{M}_1, \\Delta t_{\\text{CFL},2}, \\dots ].\n$$\n所有报告的值必须是实数或整数。此问题中不使用角度，也无需报告物理单位，因为所有参数通过构造都是无量纲的。", "solution": "该问题要求对周期性域上的一维线性平流-扩散方程构建、分析并实现两种数值格式。验证过程确认了该问题在科学上是合理的、适定的和自洽的，所有必要的参数、方程和方法都已明确指定。我们着手进行求解。\n\n### 1. 问题构建与空间离散化\n\n控制偏微分方程 (PDE) 是线性平流-扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n对于 $x \\in [0,L]$ 和 $t \\ge 0$，其中平流系数 $a \\ge 0$，粘性系数 $\\nu \\ge 0$，并具有周期性边界条件。初始条件由单个正弦模式给出：\n$$\nu(x,0) = \\sin(2\\pi k_0 x)\n$$\n\n我们使用一个包含 $N$ 个点 $x_j = j \\Delta x$（$j=0, 1, \\dots, N-1$）的均匀网格对空间域 $[0,L]$ 进行离散化，网格间距为 $\\Delta x = L/N$。设 $u_j(t)$ 为 $u(x_j, t)$ 的数值近似。\n\n空间导数按指定方式使用有限差分进行近似：\n- 一阶平流导数使用一阶迎风格式近似（因为 $a \\ge 0$）：\n$$\na \\left(\\frac{\\partial u}{\\partial x}\\right)_{x_j} \\approx a \\frac{u_j(t) - u_{j-1}(t)}{\\Delta x}\n$$\n- 二阶扩散导数使用二阶中心差分格式近似：\n$$\n\\nu \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{x_j} \\approx \\nu \\frac{u_{j+1}(t) - 2u_j(t) + u_{j-1}(t)}{\\Delta x^2}\n$$\n由于是周期性边界条件，指数对 $N$ 取模，即 $u_{-1} \\equiv u_{N-1}$ 和 $u_N \\equiv u_0$。\n\n将这些近似代入 PDE，得到一个耦合常微分方程组 (ODEs)，这种技术被称为线方法：\n$$\n\\frac{d u_j}{dt} = -a \\left(\\frac{u_j - u_{j-1}}{\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right)\n$$\n该系统可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{u}}{dt} = -a D_{\\text{up}} \\mathbf{u} + \\nu D_2 \\mathbf{u} \\equiv \\mathcal{L}(\\mathbf{u})\n$$\n其中 $\\mathbf{u}(t) = [u_0(t), u_1(t), \\dots, u_{N-1}(t)]^T$，$D_{\\text{up}}$ 和 $D_2$ 分别是表示迎风一阶导数和中心二阶导数算子的循环矩阵。\n\n### 2. 时间积分格式\n\n我们使用均匀的时间步长 $\\Delta t$ 对时间进行离散化。设 $\\mathbf{u}^n$ 表示在时间 $t^n = n \\Delta t$ 的解向量。\n\n**a) IMEX 后向欧拉-前向欧拉格式**\n该格式隐式处理扩散项（使用后向欧拉以保证稳定性），并显式处理平流项（使用前向欧拉以求简便）。从 $t^n$ 到 $t^{n+1}$ 的更新为：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^n + \\nu D_2 \\mathbf{u}^{n+1}\n$$\n重新整理以求解未知状态 $\\mathbf{u}^{n+1}$：\n$$\n\\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t a D_{\\text{up}} \\mathbf{u}^n\n$$\n$$\n\\big(I - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\big(I - \\Delta t a D_{\\text{up}}\\big) \\mathbf{u}^n\n$$\n这与问题陈述中给出的形式相符。\n\n**b) 全隐式后向欧拉格式**\n该格式同时隐式处理平流项和扩散项：\n$$\n\\frac{\\mathbf{u}^{n+1} - \\mathbf{u}^n}{\\Delta t} = -a D_{\\text{up}} \\mathbf{u}^{n+1} + \\nu D_2 \\mathbf{u}^{n+1}\n$$\n重新整理以求解 $\\mathbf{u}^{n+1}$：\n$$\n\\mathbf{u}^{n+1} + \\Delta t a D_{\\text{up}} \\mathbf{u}^{n+1} - \\Delta t \\nu D_2 \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\n$$\n\\big(I + \\Delta t a D_{\\text{up}} - \\Delta t \\nu D_2\\big) \\mathbf{u}^{n+1} = \\mathbf{u}^n\n$$\n这也与所提供的形式相符。\n\n### 3. IMEX 格式的 von Neumann 稳定性分析\n\n为推导稳定性限制，我们进行 von Neumann 分析。我们将单个傅里叶模式 $u_j^n = G^n e^{ikx_j} = G^n e^{ij\\theta}$ 代入离散化的 IMEX 更新规则中，其中 $G$ 是放大因子，$k$ 是波数，$\\theta = k\\Delta x$ 是归一化波数。\n\n单个分量 $u_j$ 的离散更新规则是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\nu \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} \\right)\n$$\n代入傅里叶模式：\n$$\n\\frac{G - 1}{\\Delta t} e^{ij\\theta} = -a \\left( \\frac{e^{ij\\theta} - e^{i(j-1)\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i(j+1)\\theta} - 2e^{ij\\theta} + e^{i(j-1)\\theta}}{\\Delta x^2} \\right)\n$$\n两边同除以 $e^{ij\\theta}$ 得：\n$$\n\\frac{G - 1}{\\Delta t} = -a \\left( \\frac{1 - e^{-i\\theta}}{\\Delta x} \\right) + \\nu G \\left( \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} \\right)\n$$\n这可以用差分算子的符号（特征值）$\\widehat{D_{\\text{up}}}(\\theta)$ 和 $\\widehat{D_2}(\\theta)$ 来写：\n$$\n\\frac{G - 1}{\\Delta t} = -a \\widehat{D_{\\text{up}}}(\\theta) + \\nu G \\widehat{D_2}(\\theta)\n$$\n求解放大因子 $G(\\theta)$：\n$$\nG(1 - \\Delta t \\nu \\widehat{D_2}(\\theta)) = 1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta) \\implies G(\\theta) = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta)}\n$$\n为保证稳定性，我们需要对所有 $\\theta \\in [0, 2\\pi)$ 都有 $|G(\\theta)| \\le 1$。\n\n我们来分析分母。二阶导数的符号为 $\\widehat{D_2}(\\theta) = \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{\\Delta x^2} = \\frac{2\\cos\\theta - 2}{\\Delta x^2} = -\\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$。对于所有 $\\theta$，这都是一个非正实数。由于 $\\Delta t \\ge 0$ 和 $\\nu \\ge 0$，分母 $1 - \\Delta t \\nu \\widehat{D_2}(\\theta) = 1 + \\Delta t \\nu \\frac{4\\sin^2(\\theta/2)}{\\Delta x^2}$ 是实数且始终大于或等于 $1$。这证明了对扩散项的隐式处理是无条件稳定的，其本身不会对 $\\Delta t$ 施加限制。\n\n稳定性条件 $|G(\\theta)| \\le 1$ 变为 $|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le |1 - \\Delta t \\nu \\widehat{D_2}(\\theta)|$。由于分母的模至少为 $1$，稳定性的一个充分条件是分子的模至多为 $1$：\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)| \\le 1\n$$\n设 $C = \\frac{a \\Delta t}{\\Delta x}$ 为 Courant 数。分子是：\n$1 - \\Delta t a \\frac{1 - e^{-i\\theta}}{\\Delta x} = 1 - C(1 - \\cos\\theta + i\\sin\\theta) = (1 - C + C\\cos\\theta) - iC\\sin\\theta$。\n其模的平方是：\n$$\n|1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n= (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n= 1 - 2C + C^2 + 2C\\cos\\theta - 2C^2\\cos\\theta + C^2 = 1 - 2C(1-\\cos\\theta) + 2C^2(1-\\cos\\theta)\n$$\n$$\n= 1 + 2(C^2-C)(1-\\cos\\theta)\n$$\n为了使其小于或等于 $1$，我们需要 $2(C^2-C)(1-\\cos\\theta) \\le 0$。因为 $1-\\cos\\theta \\ge 0$，这要求 $C^2 - C \\le 0$，即 $C(C-1) \\le 0$。由于 $a \\ge 0$，我们有 $C \\ge 0$，因此条件简化为 $C \\le 1$。\n$$\n\\frac{a \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{a}\n$$\n对于一般的 $a$，分析会涉及 $|a|$，从而得出显式平流部分的最终稳定性限制：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\n\n### 4. 在傅里叶空间中的实现\n\n矩阵 $D_{\\text{up}}$ 和 $D_2$ 是循环矩阵，这意味着它们可通过离散傅里叶变换 (DFT) 对角化。对时间步进方程应用 DFT，将线性代数方程组转换为一组独立的标量方程，每个傅里叶模式对应一个。设 $\\widehat{\\mathbf{u}}$ 为 $\\mathbf{u}$ 的 DFT。\n\nIMEX 在傅里叶空间中的更新变为：\n$$\n\\big(1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\big(1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)\\big) \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1 - \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m)}{1 - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\n\n全隐式在傅里叶空间中的更新变为：\n$$\n\\big(1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)\\big) \\widehat{u}_m^{n+1} = \\widehat{u}_m^n\n$$\n$$\n\\widehat{u}_m^{n+1} = \\frac{1}{1 + \\Delta t a \\widehat{D_{\\text{up}}}(\\theta_m) - \\Delta t \\nu \\widehat{D_2}(\\theta_m)} \\widehat{u}_m^n\n$$\n这里，$\\theta_m = 2\\pi m / N$，其中 $m$ 是离散频率指数。仿真的过程是，首先初始化 $\\widehat{\\mathbf{u}}^0 = \\text{DFT}(\\mathbf{u}(t=0))$，然后对所有傅里叶系数重复应用相应的标量更新规则，执行所选的时间步数。最后，通过逆 DFT 恢复物理空间中的解。\n\n误差是与精确解 $u_\\text{exact}(x,t) = \\exp(-\\nu (2\\pi k_0)^2 t) \\sin(2\\pi k_0 (x - a t))$ 对比计算的，使用离散 $L^2$ 范数：\n$$\n\\|e\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} \\big(u_j(T) - u_\\text{exact}(x_j,T)\\big)^2 \\right)^{1/2}\n$$\n实现将遵循这种基于傅里叶的算法，对问题中指定的每个测试案例进行计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D advection-diffusion equation using IMEX and fully implicit schemes\n    in Fourier space, and reports errors and performance metrics.\n    \"\"\"\n    # Shared parameters\n    L = 1.0\n    a = 1.0\n    k0 = 2.0\n    N = 256\n    T = 0.5\n\n    # Test suite viscosities\n    viscosities = [1e-4, 1e-2, 1e-1]\n\n    all_results = []\n\n    # Spatial grid and wavenumbers\n    delta_x = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Discrete wavenumbers (k) and corresponding angles (theta = k*delta_x)\n    # The fftfreq gives frequency in cycles/unit_of_sample_spacing\n    # We need angular frequency for the symbols, k = 2*pi*k_freq\n    k_freq = np.fft.fftfreq(N, d=delta_x)\n    theta = 2 * np.pi * k_freq * delta_x\n\n    # Symbols of the finite difference operators in Fourier space\n    # First-order upwind difference symbol\n    D_up_hat = (1 - np.exp(-1j * theta)) / (delta_x + 1e-16)\n    \n    # Second-order centered difference symbol\n    D2_hat = (np.exp(1j * theta) - 2 + np.exp(-1j * theta)) / (delta_x**2)\n    \n    # Initial condition\n    u0 = np.sin(2 * np.pi * k0 * x)\n    u0_hat = np.fft.fft(u0)\n\n    # Exact solution function\n    def u_exact(t, nu):\n        return np.exp(-nu * (2 * np.pi * k0)**2 * t) * np.sin(2 * np.pi * k0 * (x - a * t))\n\n    for nu in viscosities:\n        # 1. Compute CFL condition\n        dt_cfl = delta_x / np.abs(a)\n\n        # 2. Setup for IMEX and small-step implicit runs\n        dt_nominal_small = 0.9 * dt_cfl\n        M = int(np.ceil(T / dt_nominal_small))\n        dt_small = T / M\n\n        # 3. Setup for large-step implicit run\n        dt_nominal_large = 4.0 * dt_nominal_small\n        M_tilde = int(np.ceil(T / dt_nominal_large))\n        dt_large = T / M_tilde\n        \n        # --- Run IMEX Scheme ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for IMEX\n        g_imex = (1 - dt_small * a * D_up_hat) / (1 - dt_small * nu * D2_hat)\n        u_hat_imex_T = u_hat * (g_imex ** M)\n        u_imex_T = np.fft.ifft(u_hat_imex_T).real\n\n        # --- Run Fully Implicit Scheme (small dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit\n        g_imp_small = 1.0 / (1 + dt_small * a * D_up_hat - dt_small * nu * D2_hat)\n        u_hat_imp_small_T = u_hat * (g_imp_small ** M)\n        u_imp_small_T = np.fft.ifft(u_hat_imp_small_T).real\n        \n        # --- Run Fully Implicit Scheme (large dt) ---\n        u_hat = np.copy(u0_hat)\n        # Pre-compute amplification factor for Fully Implicit (large step)\n        g_imp_large = 1.0 / (1 + dt_large * a * D_up_hat - dt_large * nu * D2_hat)\n        u_hat_imp_large_T = u_hat * (g_imp_large ** M_tilde)\n        u_imp_large_T = np.fft.ifft(u_hat_imp_large_T).real\n        \n        # --- Calculate Errors ---\n        u_exact_T = u_exact(T, nu)\n\n        def l2_error(u_num, u_ex):\n            return np.sqrt(delta_x * np.sum((u_num - u_ex)**2))\n\n        error_imex = l2_error(u_imex_T, u_exact_T)\n        error_imp_small = l2_error(u_imp_small_T, u_exact_T)\n        error_imp_large = l2_error(u_imp_large_T, u_exact_T)\n\n        # --- Collect results for this viscosity ---\n        all_results.extend([\n            dt_cfl,\n            error_imex,\n            error_imp_small,\n            error_imp_large,\n            M,\n            M,\n            M_tilde\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```", "id": "3293758"}, {"introduction": "向后欧拉法以其无条件稳定性而闻名，但这是否意味着我们可以任意选择时间步长而不影响结果的准确性呢？这个练习将通过对一个纯对流问题的傅里叶分析，揭示一个深刻的道理：稳定性不等于准确性。你将推导出一个基于精度要求的时间步长限制，并理解即使对于无条件稳定的格式，过大的时间步长也会引入不可接受的数值耗散，从而损害解的物理真实性。[@problem_id:3293724]", "problem": "考虑在均匀、不可压缩流中的一维被动标量守恒，其形式为线性平流方程 $\\,\\partial_{t} u + U\\,\\partial_{x} u = 0\\,$，其中 $\\,U > 0\\,$ 是一个恒定的平流速度。采用线方法（method-of-lines）的观点：将空间视为连续的（因此空间导数是精确的），并使用向后欧拉法（backward Euler method）对时间进行离散化。设 $\\,\\Delta t\\,$ 为时间步长，$\\,\\Delta x\\,$ 为一个假设的空间离散化的均匀网格间距，该离散化最终将用于采样 $\\,u(x,t)\\,$。定义库朗数（Courant number） $\\,\\alpha := U\\,\\Delta t/\\Delta x\\,$。\n\n您将分析应用于单个空间傅里叶模式的向后欧拉更新，并推导出一个面向精度的库朗数约束，形式为 $\\,\\alpha \\le C_{\\text{acc}}\\,$，其中常数 $\\,C_{\\text{acc}}\\,$ 的选择旨在限制平流傅里叶分量的每步幅值误差。请按以下步骤进行：\n\n- 从控制方程和向后欧拉时间离散化出发，对单个波数 $\\,k\\,$ 进行傅里叶模式分析。从第一性原理出发，求出作用于该模式的向后欧拉映射的单步放大因子及其模。\n- 施加要求：对于所有在网格上能被有意义地表示的傅里叶模式，每步相对幅值误差 $\\,1 - |G(k)|\\,$ 不得大于容差 $\\,\\varepsilon\\,$。为明确起见，假设信号在每个波长上至少用四个网格点充分解析，因此最大的相关无量纲波数满足 $\\,\\theta_{\\max} := k_{\\max}\\,\\Delta x = \\pi/2\\,$。在您的界限推导中使用这个最坏情况下的 $\\,k_{\\max}\\,$。\n- 推导 $\\,C_{\\text{acc}}\\,$ 关于 $\\,\\varepsilon\\,$ 和 $\\,\\theta_{\\max}\\,$ 的封闭形式表达式，然后针对 $\\,\\varepsilon = 0.02\\,$ 和 $\\,\\theta_{\\max} = \\pi/2\\,$ 进行数值计算。\n\n此外，请利用您的推导和适当的数学推理，解释为什么尽管向后欧拉法消除了对流主导问题的经典稳定性限制，但这个面向精度的时步约束依然存在。\n\n将最终答案报告为 $\\,C_{\\text{acc}}\\,$ 的数值（无量纲）。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求分析应用于一维线性平流方程的向后欧拉时间积分格式，重点是推导一个基于精度的库朗数约束。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- 控制方程：$\\partial_{t} u + U\\,\\partial_{x} u = 0$，其中 $U > 0$ 为恒定平流速度。\n- 时间离散化：向后欧拉法。\n- 空间处理：线方法，将空间视为连续（精确的空间导数）。\n- 定义：\n    - 时间步长：$\\Delta t$。\n    - 网格间距：$\\Delta x$。\n    - 库朗数：$\\alpha := U\\,\\Delta t/\\Delta x$。\n- 分析任务：\n    - 对单个波数 $k$ 进行傅里叶模式分析。\n    - 推导单步放大因子 $G(k)$ 及其模 $|G(k)|$。\n- 精度约束：\n    - 每步相对幅值误差：$1 - |G(k)| \\le \\varepsilon$。\n    - 误差容差：$\\varepsilon = 0.02$。\n    - 网格分辨率假设：对于最高相关频率，每个波长至少有四个网格点。\n    - 最大有意义无量纲波数：$\\theta_{\\max} := k_{\\max}\\,\\Delta x = \\pi/2$。这对应于波长 $\\lambda_{\\min} = 2\\pi/k_{\\max} = 2\\pi\\Delta x / \\theta_{\\max} = 2\\pi\\Delta x / (\\pi/2) = 4\\Delta x$。\n- 要求输出：\n    - 面向精度的库朗数限制 $C_{\\text{acc}}$ 关于 $\\varepsilon$ 和 $\\theta_{\\max}$ 的封闭形式表达式。\n    - 给定参数下 $C_{\\text{acc}}$ 的数值。\n    - 解释为什么尽管向后欧拉法是无条件稳定的，但这种约束仍然存在。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据，是适定（well-posed）且客观的。\n- **科学依据**：线性平流方程是流体动力学和物理学中的一个基本模型。向后欧拉法和傅里叶分析是偏微分方程数值分析中标准且成熟的技术。库朗数、稳定性和精度的概念是该领域的核心。问题陈述没有科学上的缺陷。\n- **适定性**：问题结构清晰，通过一系列逻辑步骤导出一个唯一的解析和数值答案。所有必要的定义和参数（$\\varepsilon$, $\\theta_{\\max}$）都已提供。\n- **客观性**：语言正式而精确，没有主观或模糊的术语。\n- **完整性与一致性**：问题是自洽的，所有给定的条件相互一致。\n- **现实性**：该场景是用于教授数值格式性质的典型教科书示例。$\\varepsilon$ 和 $\\theta_{\\max}$ 的值对于此类分析是合理的。\n\n**1.3. 结论与行动**\n问题有效。现在将推导解答。\n\n### 步骤2：解答推导\n\n我们从控制偏微分方程（PDE），即线性平流方程开始：\n$$\n\\partial_{t} u + U\\,\\partial_{x} u = 0\n$$\n我们使用向后欧拉法对该方程进行时间离散化。设 $u^n(x)$ 表示在时间 $t_n = n\\Delta t$ 时的解。从时间 $t_n$ 到 $t_{n+1}$ 的向后欧拉更新为：\n$$\n\\frac{u^{n+1}(x) - u^n(x)}{\\Delta t} + U\\,\\partial_{x} u^{n+1}(x) = 0\n$$\n遵循线方法，空间导数 $\\partial_x$ 仍然是一个精确的微分算子。重新整理方程以求解 $u^{n+1}$ 可得：\n$$\nu^{n+1}(x) + U \\Delta t \\,\\partial_{x} u^{n+1}(x) = u^n(x)\n$$\n这是一个关于 $u^{n+1}(x)$ 的空间一阶常微分方程。\n\n为了分析该格式的性质，我们考虑它对形如 $u(x,t) = \\hat{u}(t)e^{ikx}$ 的单个空间傅里叶模式的影响，其中 $k$ 是波数，$i = \\sqrt{-1}$。对于这样的模式，空间微分算子的作用相当于乘以 $ik$：\n$$\n\\partial_x u(x,t) = ik\\,\\hat{u}(t)e^{ikx} = ik\\,u(x,t)\n$$\n将此代入半离散方程，我们得到时间步 $n$ 和 $n+1$ 的傅里叶模式幅值之间的关系：\n$$\n\\hat{u}^{n+1} + U \\Delta t (ik \\hat{u}^{n+1}) = \\hat{u}^{n}\n$$\n提出因子 $\\hat{u}^{n+1}$：\n$$\n\\hat{u}^{n+1}(1 + ikU\\Delta t) = \\hat{u}^{n}\n$$\n单步放大因子 $G(k)$ 由关系式 $\\hat{u}^{n+1} = G(k)\\hat{u}^{n}$ 定义。从上式中，我们得到：\n$$\nG(k) = \\frac{1}{1 + ikU\\Delta t}\n$$\n为了使该表达式无量纲化，我们引入库朗数 $\\alpha = U\\Delta t/\\Delta x$ 和无量纲波数 $\\theta = k\\Delta x$。乘积 $kU\\Delta t$ 可以改写为：\n$$\nkU\\Delta t = (k\\Delta x)\\left(\\frac{U\\Delta t}{\\Delta x}\\right) = \\theta \\alpha\n$$\n因此，作为 $\\theta$ 函数的放大因子是：\n$$\nG(\\theta) = \\frac{1}{1 + i\\alpha\\theta}\n$$\n平流方程的精确解对应于纯粹的平移，这意味着任何傅里叶模式的幅值都应该守恒。精确放大因子的模为 $|G_{\\text{exact}}| = 1$。数值格式与此行为的偏差由其放大因子的模 $|G(\\theta)|$ 来体现。我们计算这个模：\n$$\n|G(\\theta)| = \\left| \\frac{1}{1 + i\\alpha\\theta} \\right| = \\frac{|1|}{|1 + i\\alpha\\theta|} = \\frac{1}{\\sqrt{1^2 + (\\alpha\\theta)^2}} = \\frac{1}{\\sqrt{1 + (\\alpha\\theta)^2}}\n$$\n我们注意到，对于任何实数 $\\alpha > 0$ 和 $\\theta$，都有 $|G(\\theta)| \\le 1$。这证实了对于此问题，向后欧拉法是无条件稳定的；无论时间步长 $\\Delta t$ 如何，任何模式的幅值都不会无界增长。然而，对于 $\\alpha\\theta \\neq 0$，我们有 $|G(\\theta)|  1$，这表明该格式引入了数值阻尼或耗散。\n\n问题通过限制这种数值阻尼来对格式的精度施加约束。每步相对幅值误差定义为 $1 - |G(\\theta)|$。这个误差必须不大于容差 $\\varepsilon$：\n$$\n1 - |G(\\theta)| \\le \\varepsilon\n$$\n这等价于要求 $|G(\\theta)| \\ge 1 - \\varepsilon$。代入我们关于 $|G(\\theta)|$ 的表达式：\n$$\n\\frac{1}{\\sqrt{1 + (\\alpha\\theta)^2}} \\ge 1 - \\varepsilon\n$$\n由于两边都是正数，我们可以取倒数并反转不等号：\n$$\n\\sqrt{1 + (\\alpha\\theta)^2} \\le \\frac{1}{1 - \\varepsilon}\n$$\n两边平方得到：\n$$\n1 + (\\alpha\\theta)^2 \\le \\frac{1}{(1 - \\varepsilon)^2}\n$$\n现在，我们求解 $(\\alpha\\theta)^2$：\n$$\n(\\alpha\\theta)^2 \\le \\frac{1}{(1 - \\varepsilon)^2} - 1 = \\frac{1 - (1 - \\varepsilon)^2}{(1 - \\varepsilon)^2} = \\frac{1 - (1 - 2\\varepsilon + \\varepsilon^2)}{(1 - \\varepsilon)^2} = \\frac{2\\varepsilon - \\varepsilon^2}{(1 - \\varepsilon)^2}\n$$\n这个不等式必须对所有相关波数成立。项 $(\\alpha\\theta)^2$ 的大小随 $|\\theta|$ 的增加而增加。因此，最严格的约束（即对 $\\alpha$ 限制最强的约束）出现在最大的相关波数处，该波数被指定为 $\\theta_{\\max} = k_{\\max}\\Delta x$。我们必须在这个最坏情况的波数下满足该不等式：\n$$\n(\\alpha\\theta_{\\max})^2 \\le \\frac{2\\varepsilon - \\varepsilon^2}{(1 - \\varepsilon)^2}\n$$\n求解库朗数 $\\alpha$：\n$$\n\\alpha \\le \\frac{1}{\\theta_{\\max}} \\frac{\\sqrt{2\\varepsilon - \\varepsilon^2}}{1 - \\varepsilon}\n$$\n这就给出了所期望的面向精度的库朗数限制 $C_{\\text{acc}}$ 的表达式：\n$$\nC_{\\text{acc}} = \\frac{1}{\\theta_{\\max}} \\frac{\\sqrt{2\\varepsilon - \\varepsilon^2}}{1 - \\varepsilon}\n$$\n现在，我们使用给定的值 $\\varepsilon = 0.02$ 和 $\\theta_{\\max} = \\pi/2$ 来计算这个表达式：\n$$\nC_{\\text{acc}} = \\frac{1}{\\pi/2} \\frac{\\sqrt{2(0.02) - (0.02)^2}}{1 - 0.02} = \\frac{2}{\\pi} \\frac{\\sqrt{0.04 - 0.0004}}{0.98}\n$$\n$$\nC_{\\text{acc}} = \\frac{2}{\\pi} \\frac{\\sqrt{0.0396}}{0.98}\n$$\n对该表达式进行数值计算：\n$$\nC_{\\text{acc}} \\approx \\frac{2}{3.14159...} \\frac{0.198997...}{0.98} \\approx 0.63662 \\times 0.203058... \\approx 0.12926343...\n$$\n四舍五入到四位有效数字，我们得到 $C_{\\text{acc}} = 0.1293$。\n\n### 解释：稳定性与精度\n\n向后欧拉法是一种隐式格式。对于线性平流方程，其放大因子的模为 $|G(\\theta)| = 1/\\sqrt{1 + (\\alpha\\theta)^2}$。由于对于任何库朗数 $\\alpha \\ge 0$ 的选择，该值都小于或等于 $1$，因此该方法被称为无条件稳定。基于稳定性的分析对时间步长 $\\Delta t$ 没有设置上限；即使对于非常大的 $\\alpha$，解也不会虚假地放大并“爆炸”。\n\n然而，稳定性仅仅是一个有用的数值格式的先决条件；精度才是主要目标。精确解保持波幅守恒（$|G_{\\text{exact}}| = 1$），而向后欧拉格式引入了人为的阻尼（$|G(\\theta)|  1$）。这种阻尼代表了一种精度误差。我们的推导表明，这个误差的大小由乘积 $\\alpha\\theta$ 控制。对于一个固定的波数 $\\theta$，增加时间步长（从而增加 $\\alpha$）会导致 $|G(\\theta)|$ 的值变小，意味着更严重的阻尼。代表解中最精细细节的最高波数（最大的 $\\theta$）受到的阻尼最为严重。\n\n约束 $\\alpha \\le C_{\\text{acc}}$ 并非源于稳定性要求，而是源于精度要求。它确保了数值阻尼——该方法的一种人为产物——保持在规定的容差 $\\varepsilon$ 之内。如果使用一个非常大的时间步长（大的 $\\alpha \\gg C_{\\text{acc}}$），模拟将保持稳定，但解会变得过度平滑，并几乎立即失去其高频分量，使其成为对真实物理过程的高度不准确的表示。因此，即使对于无条件稳定的格式，精度考量几乎总是会对时间步长施加一个实际的限制。", "answer": "$$\n\\boxed{0.1293}\n$$", "id": "3293724"}]}