## 引言
在[计算流体力学](@entry_id:747620)（CFD）领域，高效准确地获得流场的定常解是许多工程分析与设计的核心任务，从飞行器气动设计到[热交换器](@entry_id:154905)性能评估都离不开它。然而，在求解复杂的[非线性](@entry_id:637147)代数方程组时，传统的[显式时间推进](@entry_id:749180)方法（如[全局时间步进](@entry_id:749933)）常常面临收敛速度的瓶颈。整个计算过程的效率被局部最严苛的稳定性条件所限制，例如[边界层](@entry_id:139416)附近的密集网格或激波区域的高速流动，导致计算资源的大量浪费。

为了突破这一瓶颈，[局部时间步进](@entry_id:751409)（Local Time Stepping, LTS）作为一种强大的加速收敛技术应运而生。它通过放弃对非物理的迭代路径的[精确模拟](@entry_id:749142)，换取了整体误差的快速衰减，极大地提升了求解定常问题的[计算效率](@entry_id:270255)。本文将系统性地剖析LTS技术，旨在为读者构建一个从理论基础到实践应用的完整知识框架。

在接下来的内容中，我们将首先在“**原理与机制**”一章中，从伪时间概念和CFL稳定性约束出发，深入探讨LTS的核心思想，并从数学上揭示其作为对角预处理的加速机理。随后，在“**应用与跨学科连接**”一章中，我们将展示LTS如何在多样化的物理场景（如[高超声速流](@entry_id:263090)、多物理场耦合）中发挥作用，并探讨其与多重网格、[自适应网格](@entry_id:164379)等先进算法的协同。最后，通过“**动手实践**”部分提供的一系列精心设计的问题，您将有机会亲手实现并优化LTS算法，将理论知识转化为解决实际问题的能力。

## 原理与机制

本章旨在深入探讨[局部时间步进](@entry_id:751409)（Local Time Stepping, LTS）加速收敛技术背后的核心原理与作用机制。在前一章介绍其基本概念与应用背景之后，我们将从第一性原理出发，系统地剖析其理论基础、稳定性约束、加速机理以及在高级离散格式中的应用考量。

### [伪时间](@entry_id:262363)的概念与定常问题求解

在计算流体力学（CFD）中，许多工程问题最终关注的是流场的**定常状态**（steady-state）。从数学上看，这意味着我们寻求一个不随时间变化的解。对于一个由[空间离散化](@entry_id:172158)（如[有限体积法](@entry_id:749372)、有限元法等）得到的半离散[守恒律方程组](@entry_id:755768)，其形式通常为：

$$
\frac{\partial \mathbf{U}}{\partial t} + \mathbf{R}(\mathbf{U}) = \mathbf{0}
$$

其中，$\mathbf{U}$ 是所有网格单元上[守恒变量](@entry_id:747720)的全局向量，$t$ 代表物理时间，而 $\mathbf{R}(\mathbf{U})$ 是空间离散算子，包含了数值通量和源项等，也称为**残差**（residual）。定常解 $\mathbf{U}^*$ 的定义是其残差为零，即满足代数方程组：

$$
\mathbf{R}(\mathbf{U}^*) = \mathbf{0}
$$

直接求解这个庞大且通常为[非线性](@entry_id:637147)的[代数方程](@entry_id:272665)组是十分困难的。一个高效的策略是将其重新构造为一个辅助的[初值问题](@entry_id:144620)，引入一个**[伪时间](@entry_id:262363)**（pseudo-time）变量 $\tau$。我们求解如下的伪时间[演化方程](@entry_id:268137) [@problem_id:3341550]：

$$
\frac{\partial \mathbf{U}}{\partial \tau} + \mathbf{R}(\mathbf{U}) = \mathbf{0}
$$

从任意一个初始猜测 $\mathbf{U}(\tau=0) = \mathbf{U}_0$ 开始，我们沿着伪时间 $\tau$ 对该方程进行积分。当系统达到稳定状态时，$\frac{\partial \mathbf{U}}{\partial \tau} \to \mathbf{0}$，此时的解 $\mathbf{U}(\tau \to \infty)$ 正是原定常问题的解，因为它满足 $\mathbf{R}(\mathbf{U}) = \mathbf{0}$。

必须强调，伪时间推进的“瞬态”路径 $\mathbf{U}(\tau)$ 纯粹是一个为了达到最终定常解而构建的数学迭代路径，它不具备任何物理意义，也不反映真实流场的物理演化过程。这与求解[非定常流](@entry_id:269993)动的物理时间推进形成了鲜明对比，后者的首要目标是保证解在物理时间上的精确性。在伪时间框架下，我们的唯一目标是尽快地将残差 $\mathbf{R}(\mathbf{U})$ 驱动至零，而无需关心迭代路径的物理真实性。这种观念的转变为[局部时间步进](@entry_id:751409)等加速收敛技术提供了理论基础。[@problem_id:3341550]

### [显式时间步进](@entry_id:168157)及其稳定性约束

最简单的伪[时间积分方法](@entry_id:136323)是显式[前向欧拉法](@entry_id:141238)。对于网格中的第 $i$ 个控制体，其更新格式为：

$$
\mathbf{U}_i^{n+1} = \mathbf{U}_i^{n} - \Delta \tau_i \mathbf{R}_i(\mathbf{U}^n)
$$

其中，上标 $n$ 表示[伪时间](@entry_id:262363)迭代步，$\mathbf{R}_i$ 是单元 $i$ 的残差，而 $\Delta \tau_i$ 是赋给该单元的[伪时间](@entry_id:262363)步长。

所有[显式时间积分](@entry_id:165797)方法都受到稳定性的制约。这一约束源于著名的**Courant–Friedrichs–Lewy (CFL) 条件**，其核心思想是：在一个时间步内，数值计算的[依赖域](@entry_id:160270)必须包含物理真实[依赖域](@entry_id:160270)。对于[双曲守恒律](@entry_id:147752)，这意味着信息（以特征波的形式传播）在一个时间步内传播的距离不能超过一个网格单元的尺寸。[@problem_id:3341492]

对于一个一般的有限体积单元 $i$，其体积为 $V_i$，边界由若干个面 $f$ 组成，每个面的面积为 $A_{if}$。其稳定的伪时间步长 $\Delta \tau_i$ 必须满足如下条件：

$$
\Delta \tau_i \le C \frac{V_i}{\sum_{f \in \partial \Omega_i} \alpha_{if} A_{if}}
$$

其中，$C$ 是一个小于等于1的**CFL数**（或称[Courant数](@entry_id:143767)），作为安全因子。分母中的 $\alpha_{if}$ 是与单元 $i$ 的面 $f$ 相关的系数，它给出了垂直于该面[法线](@entry_id:167651)方向传播的特征[波速](@entry_id:186208)的上界。具体而言，$\alpha_{if}$ 必须大于或等于通量[雅可比矩阵](@entry_id:264467) $\frac{\partial (\boldsymbol{f}(\boldsymbol{u}) \cdot \boldsymbol{n}_{if})}{\partial \boldsymbol{u}}$ 的[谱半径](@entry_id:138984) $\rho$。因此，$\alpha_{if} A_{if}$ 可以被理解为信息跨过面 $f$ 的“[体积流率](@entry_id:265771)”，而分母中的求和项则代表了流出该单元的总信息流率。这个公式的物理意义是，允许的时间步长正比于单元的体积（信息需要填充的空间），反比于所有面上的信息总通量。[@problem_id:3341492]

以可压缩[无粘流](@entry_id:273124)动的欧拉方程为例，通过一个面的特征波速为 $u_n, u_n+c, u_n-c$，其中 $u_n$ 是法向流速，$c$ 是当地声速。因此，谱半径的上界为 $|u_n|+c$。由此，一个单元的局部时间步长可由下式确定 [@problem_id:3341532]：

$$
\Delta \tau_i \le \frac{\mathrm{CFL} \cdot V_i}{\sum_{f \in \partial V_i} (|u_{n,f}| + c_f) A_f}
$$

例如，考虑一个[四面体单元](@entry_id:168311)，其体积 $V_i = 8.0 \times 10^{-4}\ \text{m}^3$，CFL数取0.8。该单元有四个面，其面积、法向速度和声速分别为：
- 面 1: $A_1=0.012\ \text{m}^2, u_{n,1}=-50\ \text{m/s}, c_1=340\ \text{m/s}$
- 面 2: $A_2=0.015\ \text{m}^2, u_{n,2}=20\ \text{m/s}, c_2=345\ \text{m/s}$
- 面 3: $A_3=0.009\ \text{m}^2, u_{n,3}=-35\ \text{m/s}, c_3=338\ \text{m/s}$
- 面 4: $A_4=0.010\ \text{m}^2, u_{n,4}=10\ \text{m/s}, c_4=342\ \text{m/s}$

分母中的求和项为 $\sum (|u_{n,f}|+c_f)A_f = (|{-50}|+340)(0.012) + (|20|+345)(0.015) + (|{-35}|+338)(0.009) + (|10|+342)(0.010) = 4.68 + 5.475 + 3.357 + 3.52 = 17.032\ \text{m}^3/\text{s}$。
因此，该单元允许的最大[局部时](@entry_id:194383)间步长为：
$$
\Delta \tau_i = \frac{0.80 \times 8.0 \times 10^{-4}}{17.032} \approx 3.758 \times 10^{-5}\ \text{s}
$$
这个计算清晰地展示了局部时间步长是如何由局部流动条件和网格几何共同决定的。[@problem_id:3341532]

### [全局时间步进](@entry_id:749933)与[局部时间步进](@entry_id:751409)

基于上述稳定性约束，我们可以定义两种不同的显式伪时间推进策略。

#### [全局时间步进](@entry_id:749933) (Global Time Stepping, GTS)

在**[全局时间步进](@entry_id:749933)**中，整个计算域的所有网格单元都采用同一个、统一的时间步长 $\Delta \tau$。为了保证整个系统的数值稳定性，这个全局步长必须满足所有单元中最苛刻的稳定性要求。换言之，它必须取所有单元局部稳定步长的最小值 [@problem_id:3341492]：

$$
\Delta \tau_{\text{global}} = \min_{i} \left( C \frac{V_i}{\sum_{f \in \partial \Omega_i} \alpha_{if} A_{if}} \right)
$$

[全局时间步进](@entry_id:749933)的优点是实现简单，并且如果需要，它可以模拟真实的物理时间演化过程（此时 $\Delta \tau$ 就是物理时间步 $\Delta t$）。然而，对于定常问题的加速收敛而言，它的效率极低。在实际的[CFD应用](@entry_id:144462)中，网格尺寸往往存在巨大差异（例如，[边界层](@entry_id:139416)附近密集，远场稀疏），或者流场中存在局部高速区（如激波）。这些小尺寸网格或高速区域将导致一个非常小的全局时间步长，使得整个计算域的演化都受制于这少数“瓶颈”单元，而大部分区域本可以安全地以大得多的步长推进。这极大地拖慢了收敛到定常解的速度。

#### [局部时间步进](@entry_id:751409) (Local Time Stepping, LTS)

**[局部时间步进](@entry_id:751409)**策略正是为了克服这一瓶颈而设计的。其核心思想是：放弃全局统一的时间步长，允许每个单元 $i$ 都使用其自身的最大允许稳定步长 $\Delta \tau_i$ 进行演化 [@problem_id:3341492]：

$$
\Delta \tau_i = C \frac{V_i}{\sum_{f \in \partial \Omega_i} \alpha_{if} A_{if}}
$$

这样，位于大网格或低速区的单元可以采用较大的伪时间步长，而位于小网格或高速区的单元则采用较小的步长。尽管每个单元在伪时间轴上的“前进速度”不同，但每个单元都充分利用了其稳定性极限，使得整个系统的误差能够以更快的速率衰减。由于我们只关心最终的定常状态（$\mathbf{R}(\mathbf{U}) = \mathbf{0}$），而不在乎迭代路径，这种放弃时间精确性的做法是完全合理的，并能显著地加速收敛。[@problem_id:3341550]

### [收敛加速](@entry_id:165787)的数学机理

[局部时间步进](@entry_id:751409)之所以能加速收敛，其背后有深刻的数学原理，可以从数值线性代数的角度进行阐释。

#### [刚性问题](@entry_id:142143)与收敛瓶颈

空间离散后得到的[半离散系统](@entry_id:754680) $\frac{\partial \mathbf{U}}{\partial \tau} = -\mathbf{R}(\mathbf{U})$，在定常解附近线性化后可写作 $\frac{\partial \mathbf{e}}{\partial \tau} = -\mathbf{J} \mathbf{e}$，其中 $\mathbf{e}$ 是误差向量，$\mathbf{J}$ 是残差的[雅可比矩阵](@entry_id:264467) $\frac{\partial \mathbf{R}}{\partial \mathbf{U}}$。[雅可比矩阵](@entry_id:264467) $\mathbf{J}$ 的[特征值](@entry_id:154894)[谱分布](@entry_id:158779)决定了系统的收敛特性。

在包含多种尺度（网格尺寸、[波速](@entry_id:186208)）的典型CFD问题中，$\mathbf{J}$ 的[特征值](@entry_id:154894)会[分布](@entry_id:182848)在一个非常宽的范围内。其中，[绝对值](@entry_id:147688)大的[特征值](@entry_id:154894)对应于高频误差模式（通常与小网格或高速区相关），而[绝对值](@entry_id:147688)小的[特征值](@entry_id:154894)对应于低频误差模式（与大网格或全局流动结构相关）。这种[特征值分布](@entry_id:194746)范围极宽的系统被称为**刚性**（stiff）系统。

对于使用[全局时间步进](@entry_id:749933)的显式方法，$\Delta \tau$ 受限于$\mathbf{J}$ 的最大[特征值](@entry_id:154894)，以保证稳定性。然而，决定[全局收敛](@entry_id:635436)速度的，却是最慢衰减的误差模式，即那些与$\mathbf{J}$ 的最小（非零）[特征值](@entry_id:154894)相关的模式。其[误差放大](@entry_id:749086)因子 $|1 - \Delta \tau \lambda_{\min}|$ 非常接近1，导致收敛极为缓慢。

#### LTS 作为一种对角预处理

[局部时间步进](@entry_id:751409)的更新格式 $\mathbf{U}^{n+1} = \mathbf{U}^{n} - \mathbf{D} \mathbf{R}(\mathbf{U}^n)$，其中 $\mathbf{D} = \text{diag}(\Delta \tau_1, \Delta \tau_2, \ldots)$ 是由[局部时](@entry_id:194383)间步长构成的[对角矩阵](@entry_id:637782)，可以被看作是一种**对角预处理**（diagonal preconditioning）的[定点迭代](@entry_id:137769)方法 [@problem_id:3341474] [@problem_id:3341477]。

其误差[迭代矩阵](@entry_id:637346)为 $\mathbf{G} = \mathbf{I} - \mathbf{D} \mathbf{J}$。通过为每个单元 $i$ 选择其局部的最大[稳定时间](@entry_id:273984)步，即 $\Delta \tau_i \propto 1/\alpha_i$，其中 $\alpha_i$ 可以看作是雅可比矩阵第 $i$ 行（或块行）“尺度”的估计（例如，对角元素的大小），我们实际上是在对雅可比矩阵 $\mathbf{J}$ 进行行平衡。

这种预处理策略极大地改善了[迭代矩阵](@entry_id:637346) $\mathbf{D}\mathbf{J}$ 的谱特性。它将原先[分布](@entry_id:182848)宽泛的[特征值](@entry_id:154894)“聚集”到一个更紧凑的区域。特别是，它有效地放大了那些原本很小的[特征值](@entry_id:154894)，使得所有误差模式的衰减率都趋于均衡，不再有少数“慢模式”拖累整体收敛。这种对刚性的缓解是LTS能够显著加速收敛的核心机制。[@problem_id:3341474]

从[加权雅可比](@entry_id:756685)迭代的角度看，LTS相当于为[求解线性系统](@entry_id:146035) $A u = 0$（其中 $A$ 是离散算子的[雅可比](@entry_id:264467)）的[雅可比迭代](@entry_id:139235)选择了一个最优的对角松弛矩阵。通过[Gershgorin圆盘定理](@entry_id:749889)等工具分析，可以选择局部时间步长 $\Delta t_i$ 来最小化[迭代矩阵](@entry_id:637346)的[谱半径界](@entry_id:152089)，从而得到最优的收敛因子 [@problem_id:3341527]。对于[扩散](@entry_id:141445)问题，这一过程可以被优雅地描述为在一个图上的扩散过程，其[收敛率](@entry_id:146534)由图[拉普拉斯算子的[](@entry_id:637193)谱隙](@entry_id:144877)（spectral gap）决定 [@problem_id:3341504]。

相比之下，[牛顿法](@entry_id:140116)通过求解 $\mathbf{J} \Delta \mathbf{U} = -\mathbf{R}(\mathbf{U})$ 来更新解，其收敛速度是二次的，远快于[线性收敛](@entry_id:163614)的LTS。然而，[牛顿法](@entry_id:140116)需要构造和求解大规模线性系统，每步的计算成本极高。LTS作为一种简单而有效的显式方法，在成本和收敛速度之间提供了一个有吸[引力](@entry_id:175476)的平衡。[@problem_id:3341477]

### 高级应用与实践考量

#### 隐式伪时间步进（双时间步进）

为了突破显式方法固有的CFL稳定性限制，可以采用[隐式方法](@entry_id:137073)来求解伪时间[演化方程](@entry_id:268137)。一个通用的格式是$\theta$-方法 [@problem_id:3341506]：
$$
\frac{\mathbf{U}^{n+1} - \mathbf{U}^{n}}{\Delta \tau} + \theta \mathbf{R}(\mathbf{U}^{n+1}) + (1-\theta)\mathbf{R}(\mathbf{U}^{n}) = 0
$$
- $\theta=0$：前向欧拉法（显式）
- $\theta=0.5$：Crank-Nicolson法（二阶隐式）
- $\theta=1$：[后向欧拉法](@entry_id:139674)（一阶隐式）

这类方法被称为**双时间步进**（Dual Time Stepping），因为在求解每个伪时间步内的非线性方程（当$\theta > 0$时）时，通常还需要进行一系列“内迭代”或“子迭代”。

对于定常问题加速，我们希望伪[时间积分](@entry_id:267413)器不仅稳定，而且能强力地耗散高频误差。这引出了**[L-稳定性](@entry_id:143644)**的概念，它要求当时间步长趋于无穷大时，数值解能迅速衰减到零。分析表明，只有当 $\theta=1$ 时，即采用**后向欧拉法**，该格式才是L-稳定的。这使得它在处理刚性问题时极为鲁棒，因为它能以极大的[伪时间](@entry_id:262363)步长稳定地推进，并迅速消除由启动过程或[非线性](@entry_id:637147)引起的瞬态高频误差。[@problem_id:3341506]

#### LTS在[高阶格式](@entry_id:150564)中的应用

将LTS应用于[高阶格式](@entry_id:150564)，如WENO（Weighted Essentially Non-Oscillatory）和DG（Discontinuous Galerkin），会引入新的挑战。

对于**[WENO格式](@entry_id:145935)**，其[高阶精度](@entry_id:750325)依赖于宽广的重构模板。然而，保证总变差不增（TVD）的性质通常要求紧凑的模板和正的系数，这与[高阶重构](@entry_id:750332)的本质相矛盾。WENO通过[非线性权重](@entry_id:752658)机制，在光滑区保持高阶，在间断附近退化为一阶来绕过此限制。当LTS与WENO结合时，为了保证数值稳定性和守恒性，必须采用更精巧的策略。一个直接的LTS实现（每个单元用自己的$\Delta \tau_i$更新）会破坏守恒性，使得稳定性分析失效。一种常见的补救措施是在单元交界面上定义一个有效的“面时间步长”，例如取相邻单元时间步长的最小值 $\Delta t_{i+1/2} = \min(\Delta t_i, \Delta t_{i+1})$，并基于此构造守恒的通量交换。此时，稳定性条件必须基于这个面时间步长来施加，并且其约束会随着WEN[O模](@entry_id:186318)板的展宽而变得更严格。[@problem_id:3341551]

对于**[DG格式](@entry_id:178043)**，局部时间步长的稳定性极限 $\Delta \tau_i \propto 1/\rho(M_i^{-1}K_i)$ 与[单元质量矩阵](@entry_id:748930) $M_i$ 和[刚度矩阵](@entry_id:178659) $K_i$ 密切相关。[基函数](@entry_id:170178)的选择（如模态勒让德基或[节点拉格朗日基](@entry_id:752524)）和积分的求积规则会影响 $M_i$ 的结构。采用特定求积点（如Gauss-Lobatto点）可以使质量矩阵 $M_i$ 变为对角阵，这极大地简化了计算，因为避免了[求解线性系统](@entry_id:146035)。然而，这并非没有代价。例如，基于[Gauss-Lobatto节点](@entry_id:749738)的[DG方法](@entry_id:748369)，其[对角质量矩阵](@entry_id:173002)在单元端点处的对角元（即[求积权重](@entry_id:753910)）非常小。由于界面通量的影响主要作用于端点自由度，较小的质量矩阵项会放大这些影响（体现在 $M_i^{-1}$ 的对应项很大），从而增大了[谱半径](@entry_id:138984) $\rho(M_i^{-1}K_i)$，导致稳定性约束略微收紧，允许的 $\Delta \tau_i$ 相比于使用[模态基](@entry_id:752055)和精确积分的方法要小一些。[@problem_id:3341511]

综上所述，[局部时间步进](@entry_id:751409)是一种强大而深刻的[收敛加速](@entry_id:165787)技术。它通过牺牲非物理的[伪时间](@entry_id:262363)路径精度，换取在[刚性系统](@entry_id:146021)中误差的快速衰减。其核心机理可以理解为一种有效的对角[预处理](@entry_id:141204)，而其在高级格式中的成功应用则依赖于对守恒性和稳定性更细致入微的考量。