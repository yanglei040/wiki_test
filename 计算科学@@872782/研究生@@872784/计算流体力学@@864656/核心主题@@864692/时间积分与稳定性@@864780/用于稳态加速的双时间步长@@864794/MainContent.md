## 引言
在计算科学与工程领域，高效求解描述物理系统[稳态](@entry_id:182458)行为的控制方程是一项基础而关键的任务。从飞行器设计到能源[系统分析](@entry_id:263805)，工程师和科学家们需要可靠地获得大型、[非线性](@entry_id:637147)代数方程组的解，这些[方程组](@entry_id:193238)是对复杂的[流体动力学](@entry_id:136788)、热传递和[化学反应](@entry_id:146973)现象进行离散化后的数学表达。然而，直接求解这些[方程组](@entry_id:193238)往往计算成本高昂，收敛性也难以保证，这构成了[计算模拟](@entry_id:146373)中的一个主要瓶颈。

本文旨在深入介绍一种强大且广泛应用的数值技术——[双时间步法](@entry_id:748690)，它正是为了应对这一挑战而生。通过学习本文，读者将全面了解[双时间步法](@entry_id:748690)的精髓。我们将从“原理与机制”一章开始，揭示该方法如何巧妙地将一个静态的[求根问题](@entry_id:174994)转化为一个[伪时间](@entry_id:262363)上的[演化过程](@entry_id:175749)，并探讨其稳定性、预处理和与经典牛顿法的深刻联系。随后，在“应用与交叉学科联系”一章中，我们将展示该框架的强大适应性，看它如何被应用于求解包含[湍流](@entry_id:151300)、[化学反应](@entry_id:146973)和磁流体动力学等复杂物理模型的问题，并与[高阶方法](@entry_id:165413)、[多重网格](@entry_id:172017)以及[设计优化](@entry_id:748326)等前沿领域相结合。最后，在“动手实践”一章中，读者将通过具体的编程练习，将理论知识转化为实践技能。

让我们首先深入探索[双时间步法](@entry_id:748690)的基本原理和核心机制。

## 原理与机制

在[计算流体动力学](@entry_id:147500)（CFD）中，求解[稳态](@entry_id:182458)问题是核心任务之一。无论是飞行器在巡航状态下的绕流，还是[热交换器](@entry_id:154905)内的稳定传热，其控制方程最终都可归结为一个大型、[非线性](@entry_id:637147)的[代数方程](@entry_id:272665)组。本章将深入探讨一种高效求解此类问题的先进数值技术——[双时间步法](@entry_id:748690)，阐明其基本原理、核心机制以及在复杂工程问题中的应用。

### 基本原理：从[求根问题](@entry_id:174994)到伪[时间演化](@entry_id:153943)

空间离散后的[稳态](@entry_id:182458)守恒律方程，无论是采用[有限体积法](@entry_id:749372)、有限元法还是有限差分法，最终都可以抽象地表示为一个[非线性](@entry_id:637147)残差方程：
$$
\mathbf{R}(\mathbf{U}) = \mathbf{0}
$$
其中，$\mathbf{U}$ 是包含所有网格单元上[守恒变量](@entry_id:747720)（如密度、动量、能量）的全局状态向量，而 $\mathbf{R}(\mathbf{U})$ 则是代表离散后的空间通量、[源项](@entry_id:269111)等构成的代数残差向量。求解[稳态解](@entry_id:200351)的本质，就是寻找一个状态向量 $\mathbf{U}$，使得残差向量 $\mathbf{R}(\mathbf{U})$ 的所有分量均为零。

对于大规模的CFD问题，$\mathbf{U}$ 的维度可达成百上千万甚至更高，直接求解上述非线性方程组（例如，使用牛顿法）在计算上可能非常昂贵或难以收敛。[双时间步法](@entry_id:748690)提供了一种巧妙的替代方案：它将这个静态的代数[求根问题](@entry_id:174994)嵌入到一个动态的[演化过程](@entry_id:175749)中。具体而言，我们引入一个与物理时间无关的人工时间变量，称为**[伪时间](@entry_id:262363)**（pseudo-time），记为 $\tau$。然后，我们将原[稳态](@entry_id:182458)方程 $\mathbf{R}(\mathbf{U}) = \mathbf{0}$ 增广为一个关于伪时间 $\tau$ 的伪瞬态[演化方程](@entry_id:268137)：
$$
\frac{d\mathbf{U}}{d\tau} + \mathbf{R}(\mathbf{U}) = \mathbf{0}
$$
这个方程描述了[状态向量](@entry_id:154607) $\mathbf{U}$ 如何在[伪时间](@entry_id:262363) $\tau$ 中“演化”。它的[不动点](@entry_id:156394)（fixed point），即当 $\frac{d\mathbf{U}}{d\tau} \to \mathbf{0}$ 时，恰好满足 $\mathbf{R}(\mathbf{U}) = \mathbf{0}$，这正是我们所追求的原始[稳态解](@entry_id:200351)。因此，求解[稳态](@entry_id:182458)问题的任务就转化为：给定一个初始猜测解 $\mathbf{U}_0$，沿着[伪时间](@entry_id:262363) $\tau$ 对上述常微分方程（ODE）系统进行积分，直至系统达到[稳态](@entry_id:182458)。[@problem_id:3313185]

这种方法的核心优势在于**伪时间演化路径的非物理性**。由于 $\tau$ 是一个纯粹的数学构造，其[演化过程](@entry_id:175749)不必遵循真实的物理瞬态路径。这为我们自由地采用各种数值加速技巧打开了大门，例如使用局部最优的伪时间步长或引入物理[预处理](@entry_id:141204)，这些技巧在需要保证物理时间精度的瞬态仿真中是不可接受的。这种从离散迭代格式出发，最终解释为一个连续伪[时间演化](@entry_id:153943)方程的观点，也被称为**[伪瞬态延拓](@entry_id:753844)法**（Pseudo-Transient Continuation, PTC）。例如，一个一阶隐式（后向欧拉）伪时间离散格式可以写为：
$$
\frac{\mathbf{U}^{k+1} - \mathbf{U}^{k}}{\Delta\tau} + \mathbf{R}(\mathbf{U}^{k+1}) = \mathbf{0}
$$
其中 $k$ 是伪时间迭代步数。在伪时间步长 $\Delta\tau \to 0$ 的极限下，该离散方程收敛于上述连续的伪瞬态ODE，从而建立了离散迭代与连续演化之间的理论桥梁。[@problem_id:3313222]

### [伪时间](@entry_id:262363)离散与[稳定性分析](@entry_id:144077)

选择合适的[伪时间](@entry_id:262363)离散格式对收敛速度和鲁棒性至关重要。我们可以考察两种基本的离散格式：显式格式和[隐式格式](@entry_id:166484)。

#### 显式格式与收敛优化

最简单的显式格式是[前向欧拉法](@entry_id:141238)。对于一个包含伪质量（pseudo-mass）系数 $m$ 的模型方程，其更新格式为：
$$
m \frac{u^{k+1} - u^k}{\Delta\tau} + R(u^k) = 0
$$
为了具体分析其收敛性，我们考虑一个标量线性残差模型 $R(u) = \lambda u - f$，其中 $\lambda \gt 0$。该模型的[稳态解](@entry_id:200351)为 $u_{ss} = f/\lambda$。将残差模型代入显式更新格式并整理，可得误差 $e^k = u^k - u_{ss}$ 的递推关系：
$$
e^{k+1} = \left(1 - \frac{\lambda \Delta\tau}{m}\right) e^k
$$
迭代要收敛，[误差放大](@entry_id:749086)因子 $G = 1 - \frac{\lambda \Delta\tau}{m}$ 的[绝对值](@entry_id:147688)必须小于1，即 $|G| \lt 1$。这给出了[伪时间](@entry_id:262363)步长 $\Delta\tau$ 的稳定性约束：
$$
0 \lt \Delta\tau \lt \frac{2m}{\lambda}
$$
这表明，显式格式是条件稳定的，其伪时间步长受到系统特征（由 $\lambda$ 代表）的限制。为了最快地收敛，我们需要最小化[误差放大](@entry_id:749086)因子的[绝对值](@entry_id:147688) $|G|$。当 $G=0$ 时，收敛最快，这对应于最优伪时间步长：
$$
\Delta\tau_{\mathrm{opt}} = \frac{m}{\lambda}
$$
在这个[最优步长](@entry_id:143372)下，理论上一次迭代即可达到解。虽然这是一个理想化的[线性模型](@entry_id:178302)，但它揭示了显式格式的一个普遍特性：存在一个与问题刚度相关的[最优步长](@entry_id:143372)，但其稳定性受到严格限制，这在处理[刚性CFD问题](@entry_id:755451)时会严重影响[收敛率](@entry_id:146534)。[@problem_id:3313205]

#### [隐式格式](@entry_id:166484)与[无条件稳定性](@entry_id:145631)

为了突破显式格式的稳定性瓶颈，我们转向[隐式格式](@entry_id:166484)，如后向欧拉法。其更新格式为：
$$
m \frac{u^{k+1} - u^k}{\Delta\tau} + R(u^{k+1}) = 0
$$
同样，对于线性模型 $R(u) = \lambda u$，我们可以求解得到[误差放大](@entry_id:749086)因子 $G$：
$$
G = \frac{m}{m + \Delta\tau \lambda}
$$
这里的 $\lambda$ 是空间算子[雅可比矩阵的特征值](@entry_id:264008)，对于一个趋向稳定定常解的系统，其[特征值](@entry_id:154894)通常具有非负实部，即 $\text{Re}(\lambda) \ge 0$。我们来分析该格式的稳定性。定义一个复数稳定性参数 $z = \frac{\Delta\tau}{m}\lambda$，由于 $\text{Re}(\lambda) \ge 0$，我们有 $\text{Re}(z) \ge 0$。[放大因子](@entry_id:144315)可以写为 $G(z) = \frac{1}{1+z}$。

稳定性的要求是 $|G(z)| \le 1$。对于任意 $\text{Re}(z) \ge 0$ 的复数 $z=x+iy$（其中 $x \ge 0$），我们有：
$$
|1+z|^2 = (1+x)^2 + y^2 = 1 + 2x + x^2 + y^2 \ge 1
$$
因此 $|1+z| \ge 1$，从而 $|G(z)| = \frac{1}{|1+z|} \le 1$ 恒成立。这意味着后向欧拉格式对于所有具有非负实部[特征值](@entry_id:154894)的系统都是**无条件稳定**的，这一性质称为**[A-稳定性](@entry_id:144367)**。

更进一步，我们考察当[特征值](@entry_id:154894)模长极大时（对应于系统中的高频刚性模态）的行为。在 $|z| \to \infty$ 的极限下：
$$
\lim_{|z| \to \infty} |G(z)| = \lim_{|z| \to \infty} \left|\frac{1}{1+z}\right| = 0
$$
这表明，对于非常刚性的模态，后向欧拉格式能以极快的速度（理论上一步）将其衰减掉。这个优良的特性称为**[L-稳定性](@entry_id:143644)**。[A-稳定性](@entry_id:144367)和[L-稳定性](@entry_id:143644)使得[隐式格式](@entry_id:166484)成为[双时间步法](@entry_id:748690)的首选，因为它允许我们采用远大于显式格式稳定性极限的伪时间步长（即非常大的[伪时间](@entry_id:262363)CFL数），从而极大地加速了向[稳态解](@entry_id:200351)的收敛过程。[@problem_id:3313254]

### [预处理](@entry_id:141204)：加速收敛的核心机制

虽然[隐式格式](@entry_id:166484)提供了[无条件稳定性](@entry_id:145631)，但仅仅使用大步长并不足以保证高效收敛。当一个物理系统包含多种传播速度差异巨大的波（例如，低速流中的声波和[对流](@entry_id:141806)波），其对应的离散系统在数学上是“刚性”的，这会导致收敛非常缓慢。预处理技术是解决这一问题的关键。

一个更通用的伪瞬态方程形式为：
$$
\mathbf{M}(\mathbf{U}) \frac{d\mathbf{U}}{d\tau} + \mathbf{R}(\mathbf{U}) = \mathbf{0}
$$
这里的 $\mathbf{M}(\mathbf{U})$ 称为**[预处理](@entry_id:141204)矩阵**（preconditioning matrix）。它的作用是改变伪时间演化系统的特征结构，使得所有模态的伪传播速度趋于一致，从而消除刚性，提高收敛效率。一个理想的预处理矩阵 $\mathbf{M}(\mathbf{U})$ 应满足以下几个关键要求：

1.  **正定性 (Positivity)**：$\mathbf{M}(\mathbf{U})$ 必须是（对称）正定矩阵。这保证了当使用[隐式格式](@entry_id:166484)求解伪时间步时，所产生的[线性系统](@entry_id:147850)的矩阵具有良好的对角占优性，确保了数值求解的鲁棒性和稳定性。

2.  **[尺度一致性](@entry_id:199161) (Scaling)**：物理残差项 $\mathbf{R}(\mathbf{U})$ 是一个广延量，其大小与网格单元的体积 $V_i$ 相关。为了使[伪时间](@entry_id:262363)步的更新量 $\Delta \mathbf{U}$ 在不同尺寸的网格上保持一致，[预处理](@entry_id:141204)矩阵 $\mathbf{M}(\mathbf{U})$ 的每个单元块也必须与单元体积 $V_i$ 成正比。

3.  **模态均衡 (Mode balancing)**：这是[预处理](@entry_id:141204)的核心目的。$\mathbf{M}(\mathbf{U})$ 的选取应使其[逆矩阵](@entry_id:140380) $\mathbf{M}(\mathbf{U})^{-1}$ 近似于残差[雅可比矩阵](@entry_id:264467) $\frac{\partial\mathbf{R}}{\partial\mathbf{U}}$ 的“坏”部分，从而使得预处理后的系统算子 $\mathbf{M}(\mathbf{U})^{-1} \frac{\partial\mathbf{R}}{\partial\mathbf{U}}$ 的[特征值](@entry_id:154894)尽可能地聚集在一起。

例如，简单的选择如 $\mathbf{M}(\mathbf{U}) = \mathbf{I}$ （单位矩阵）或 $\mathbf{M}(\mathbf{U}) = \text{diag}(V_i) \otimes \mathbf{I}_m$（仅考虑[体积缩放](@entry_id:197908)的对角矩阵）都无法实现模态均衡。一个先进且有效的选择是采用块[对角形式](@entry_id:264850) $\mathbf{M}(\mathbf{U}) = \text{diag}(V_i \mathbf{P}(\mathbf{U}_i))$，其中 $\mathbf{P}(\mathbf{U}_i)$ 是一个基于局部流场物理性质构造的、[对称正定](@entry_id:145886)的点块[预处理](@entry_id:141204)矩阵，它专门设计用来均衡不同物理模态（如[声学](@entry_id:265335)、[对流](@entry_id:141806)、粘性模态）的传播速度。[@problem_id:3313241]

### 应用与高级专题

[双时间步法](@entry_id:748690)框架具有高度的灵活性，使其能够应对多种复杂的计算挑战。

#### 应用一：[低马赫数流](@entry_id:751506)动的[刚性问题](@entry_id:142143)

在[低马赫数](@entry_id:751528) ($M \ll 1$) 流动中，声[波的传播](@entry_id:144063)速度 $c$ 远大于流体的[对流](@entry_id:141806)速度 $|\mathbf{u}|$。未经[预处理](@entry_id:141204)的[双时间步法](@entry_id:748690)，其[伪时间](@entry_id:262363)步长受限于快速的声波，即 $\Delta\tau \propto 1/c$，而信息（如熵）的传播却依赖于慢速的[对流](@entry_id:141806)，时间尺度为 $1/|\mathbf{u}|$。收敛所需的迭代步数与这两个尺度的比值成正比，即 $N_{steps} \propto c/|\mathbf{u}| = 1/M$，当 $M \to 0$ 时，收敛变得极其缓慢。

**Turkel型预处理**等方法正是为此设计的。这类[预处理](@entry_id:141204)通过构造一个[马赫数](@entry_id:274014)相关的矩阵 $\mathbf{P}(M)$，来修正伪时间系统中的声速。其核心思想是，在伪时间演化中，将真实的声速 $c$ 替换为一个修正后的[伪声](@entry_id:190813)速 $c'$，使得 $c'$ 与[对流](@entry_id:141806)速度 $|\mathbf{u}|$ 量级相当。一种常见的选择是令 $c' = \beta c$，其中缩放因子 $\beta(M)$ 在[低马赫数](@entry_id:751528)时约等于 $M$，而在 $M \to 1$ 时趋近于1（以恢复原始方程）。例如，可以取 $\beta(M) = \max(M, M_{\text{cut}})$，其中 $M_{\text{cut}}$ 是一个小的截断[马赫数](@entry_id:274014)。

通过这种方式，[预处理](@entry_id:141204)后系统的所有伪特征速度都变得与[对流](@entry_id:141806)速度 $|\mathbf{u}|$ 同量级。伪时间步长现在可以基于修正后的、更小的谱半径来选取，$\Delta\tau \propto 1/(|\mathbf{u}|+c')$。结果是，收敛到[稳态](@entry_id:182458)所需的迭代步数不再依赖于马赫数 $M$，从而在整个[马赫数](@entry_id:274014)范围内都保持了高效的收敛性。[@problem_id:3313212]

#### 应用二：求解非[稳态](@entry_id:182458)问题

[双时间步法](@entry_id:748690)的概念不仅限于加速[稳态](@entry_id:182458)计算。在求解**非[稳态](@entry_id:182458)（瞬态）**问题时，若采用隐式时间格式（如后向欧拉或BDF格式），每个物理时间步都需要求解一个[非线性](@entry_id:637147)代数方程组。[双时间步法](@entry_id:748690)同样是求解这个内嵌[非线性](@entry_id:637147)问题的强大工具。

考虑一个采用二阶[后向差分](@entry_id:637618)格式（BDF2）离散的物理瞬态问题。在每个物理时间步 $t^{n+1}$，需要求解的非线性方程为：
$$
\mathbf{M} \left( \frac{3\mathbf{U}^{n+1} - 4\mathbf{U}^{n} + \mathbf{U}^{n-1}}{2\Delta t} \right) + \mathbf{R}(\mathbf{U}^{n+1}) = \mathbf{0}
$$
其中 $\mathbf{U}^n$ 和 $\mathbf{U}^{n-1}$ 是已知的历史解。我们将整个左侧表达式定义为一个新的**物理时间残差** $\mathbf{R}^*(\mathbf{U}^{n+1})$。为了求解 $\mathbf{R}^*(\mathbf{U}^{n+1}) = \mathbf{0}$，我们在每个物理时间步内部启动一个[伪时间](@entry_id:262363)迭代（内循环）：
$$
\mathbf{M} \frac{d\mathbf{U}^{n+1}}{d\tau} + \mathbf{R}^*(\mathbf{U}^{n+1}) = \mathbf{0}
$$
这个内循环在[伪时间](@entry_id:262363) $\tau$ 中演化，直至其达到[稳态](@entry_id:182458)（即 $\frac{d\mathbf{U}^{n+1}}{d\tau} \to 0$），此时便得到了满足BDF2方程的解 $\mathbf{U}^{n+1}$。然后，物理时间向[前推](@entry_id:158718)进到下一步 $t^{n+2}$，并开始新的内循环。在这个框架中，物理时间 $t$ 控制着真实的流动演化和精度，而伪时间 $\tau$ 则纯粹是一个用于在固定物理时间层上[求解非线性系统](@entry_id:163616)的迭代工具。[@problem_id:3313170]

#### 与牛顿法的深刻联系

[双时间步法](@entry_id:748690)与经典的[牛顿法](@entry_id:140116)之间存在着深刻的联系。回顾隐式后向欧拉格式的线性化形式：
$$
\left( \frac{\mathbf{M}_k}{\Delta\tau_k} + \mathbf{J}_k \right) \delta\mathbf{U} = -\mathbf{R}_k
$$
其中 $\mathbf{J}_k = \frac{\partial\mathbf{R}}{\partial\mathbf{U}}(\mathbf{U}_k)$ 是残差的[雅可比矩阵](@entry_id:264467)。观察当[伪时间](@entry_id:262363)步长 $\Delta\tau_k \to \infty$ 时会发生什么：$\frac{\mathbf{M}_k}{\Delta\tau_k}$ 项消失，方程退化为：
$$
\mathbf{J}_k \delta\mathbf{U} = -\mathbf{R}_k
$$
这正是求解 $\mathbf{R}(\mathbf{U})=\mathbf{0}$ 的标准**[牛顿法](@entry_id:140116)**迭代步。因此，无阻尼的牛顿法可以被看作是[双时间步法](@entry_id:748690)在[伪时间](@entry_id:262363)步长为无穷大时的特例。

更进一步，我们甚至可以将带有[线搜索](@entry_id:141607)的[阻尼牛顿法](@entry_id:636521)（damped Newton method）也纳入到双时间步的框架中。在一个非精确[牛顿-克雷洛夫](@entry_id:752475)（[Newton-Krylov](@entry_id:752475)）方法中，更新步为 $\mathbf{U}_{k+1} = \mathbf{U}_k + \alpha_k \mathbf{s}_k$，其中 $\mathbf{s}_k$ 是通过近似求解 $\mathbf{J}_k \mathbf{s}_k \approx -\mathbf{R}_k$ 得到的牛顿方向，$\alpha_k \in (0, 1]$ 是[线搜索](@entry_id:141607)参数。可以证明，这一步在某种意义上等价于一个具有特定有效[伪时间](@entry_id:262363)步长 $\Delta\tau_k$ 的双时间步迭代。该有效步长与[线搜索](@entry_id:141607)参数 $\alpha_k$ 的关系为：
$$
\Delta\tau_k \approx \left( \frac{\mathbf{s}_k^\top \mathbf{M}_k \mathbf{s}_k}{\mathbf{s}_k^\top \mathbf{J}_k \mathbf{s}_k} \right) \frac{\alpha_k}{1 - \alpha_k}
$$
这个关系式清晰地表明，当线搜索参数 $\alpha_k \to 1$（接近纯[牛顿步](@entry_id:177069)）时，有效伪时间步长 $\Delta\tau_k \to \infty$。这揭示了从[梯度下降](@entry_id:145942)类方法（对应小的 $\Delta\tau_k$ 和 $\alpha_k$）到[牛顿法](@entry_id:140116)（对应大的 $\Delta\tau_k$ 和 $\alpha_k$）的光滑过渡，统一了这些看似不同的[非线性](@entry_id:637147)求解策略。[@problem_id:3313194]

### 实践指南：迭代[停止准则](@entry_id:136282)

在实际应用中，如何确定迭代已经“足够”收敛是一个至关重要的问题。不恰当的[停止准则](@entry_id:136282)可能导致计算资源的浪费（迭代过多）或结果的不准确（迭代过少）。对于包含内外两层循环的[双时间步法](@entry_id:748690)，我们需要分别为内外循环设定合理的[停止准则](@entry_id:136282)。

#### 外循环[停止准则](@entry_id:136282)（[稳态收敛](@entry_id:155959)）

对于[稳态](@entry_id:182458)问题，外循环的目标是驱动物理残差 $\mathbf{R}(\mathbf{U})$ 趋于零。因此，其[停止准则](@entry_id:136282)应直接基于 $\mathbf{R}(\mathbf{U})$ 的范数。一个鲁棒的准则是要求[残差范数](@entry_id:754273)下降到某个物理上有意义的尺度以下：
$$
\|\mathbf{R}(\mathbf{U}^{k+1})\| \le \varepsilon_{\text{out}} S_R
$$
其中，$\varepsilon_{\text{out}}$ 是一个用户指定的无量纲小[公差](@entry_id:275018)（例如 $10^{-6}$），而 $S_R$ 是一个与问题物理特性相关、且**不依赖于**伪时间步长 $\Delta\tau$ 的参考尺度。$S_R$ 可以取为初始时刻的[残差范数](@entry_id:754273) $\|\mathbf{R}(\mathbf{U}^0)\|$ 或流入边界的总通量等。这种相对或标准化的判据确保了收敛目标与所选的[伪时间](@entry_id:262363)步长策略解耦。作为补充，我们也可以同时监测解在伪时间步之间的变化量，例如，当更新量 $\Delta \mathbf{U}^k = \mathbf{U}^{k+1} - \mathbf{U}^k$ 的范数也变得足够小时，表明解在[伪时间](@entry_id:262363)上已不再显著变化，进一步确认了[稳态](@entry_id:182458)的达成。[@problem_id:3313214]

#### 内循环[停止准则](@entry_id:136282)（非线性系统求解）

当[双时间步法](@entry_id:748690)用于求解每个物理时间步的[非线性方程](@entry_id:145852) $\mathbf{R}(\mathbf{U}) + \mathbf{D}(\mathbf{U}) = \mathbf{0}$ 时，内循环的目标是足够精确地求解这个代数系统。这里的“足够精确”意味着由内循环不完全收敛所引入的代数误差，不应超过该物理时间步本身的离散化[截断误差](@entry_id:140949)。

一个设计精良的内循环[停止准则](@entry_id:136282)是，要求内循环的残差（即 $\mathbf{R}+\mathbf{D}$）相对于[驱动项](@entry_id:165986)的范数减小一个指定的量级。在这个方程中，$\mathbf{D}(\mathbf{U})$ 项包含了来自上一时间步的信息，是驱动当前时间步[非线性](@entry_id:637147)求解的“源”。因此，一个合理的相对[停止准则](@entry_id:136282)是：
$$
\|\mathbf{R}(\mathbf{U}^{(k)}) + \mathbf{D}(\mathbf{U}^{(k)})\| \le \varepsilon_{\text{in}} \|\mathbf{D}(\mathbf{U}^{(k)})\|
$$
其中 $\mathbf{U}^{(k)}$ 是内循环的第 $k$ 次迭代解，$\varepsilon_{\text{in}}$ 是一个比 $\varepsilon_{\text{out}}$ 更小的内循环[公差](@entry_id:275018)（例如 $0.01$）。这个准则具有很好的自适应性：当物理时间步长 $\Delta t$ 很小时，$\|\mathbf{D}\|$ 很大，该准则允许内循环的绝对残差较大，从而节省计算量；当 $\Delta t$很大时，$\|\mathbf{D}\|$ 很小，该准则会迫使内循环求解得非常精确，以确保最终的[稳态解](@entry_id:200351)精度。[@problem_id:3313214]

从理论上看，这种做法的合理性可以通过误差与残差的关系来解释。对于[非线性方程](@entry_id:145852) $\mathbf{F}(\mathbf{U}) = \mathbf{0}$，其近似解的误差 $\mathbf{E}_{nl}$ 与残差 $\mathbf{R}_{\tau} = \mathbf{F}(\mathbf{U}_{\text{approx}})$ 的关系近似为 $\mathbf{E}_{nl} \approx \mathbf{J}^{-1} \mathbf{R}_{\tau}$，其中 $\mathbf{J}$ 是 $\mathbf{F}$ 的[雅可比矩阵](@entry_id:264467)。因此，要控制解的误差，残差的容忍度必须考虑到雅可比的逆的范数 $\| \mathbf{J}^{-1} \|$。一个严格的[停止准则](@entry_id:136282)应保证 $\| \mathbf{R}_{\tau} \| \le c \cdot \epsilon_t$，其中 $c \le \| (\mathbf{I}+\Delta t \frac{\partial \mathcal{R}}{\partial \mathbf{U}})^{-1} \|^{-1}$，而 $\epsilon_t$ 是目标解误差。上述启发式准则正是这一严[格理论](@entry_id:147950)在实践中的一种有效近似。[@problem_id:3313258]