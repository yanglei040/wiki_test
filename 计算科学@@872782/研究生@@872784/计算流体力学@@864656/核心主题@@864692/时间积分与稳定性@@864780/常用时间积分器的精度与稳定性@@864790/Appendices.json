{"hands_on_practices": [{"introduction": "理解时间积分方法稳定性的第一步是掌握其稳定性函数的概念。通过将数值方法应用于标准线性测试方程 $y' = \\lambda y$，我们可以推导出其放大因子 $R(z)$，并确定其绝对稳定域，即 $|R(z)| \\le 1$ 的复数 $z$ 的集合。[@problem_id:3287737] 这项练习将通过推导三种基本方法——前向欧拉、后向欧拉和梯形法则——的稳定性函数和稳定域，来巩固这些核心概念。", "problem": "考虑一个源于计算流体力学(CFD)中线性化偏微分方程的线法离散的线性测试问题：常微分方程(ODE) $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$ 代表半离散空间算子的一个特征值，且 $y(t) \\in \\mathbb{C}$。设时间步长为 $n$ 的单步数值更新写为 $y_{n+1} = R(z)\\,y_n$，其中 $z = \\lambda \\,\\Delta t \\in \\mathbb{C}$ 且 $\\Delta t > 0$ 为时间步长。函数 $R(z)$ 被称为稳定性函数。绝对稳定区域是所有满足 $|R(z)| \\leq 1$ 的 $z \\in \\mathbb{C}$ 的集合。\n\n从以下应用于常微分方程 $y'(t) = \\lambda y(t)$ 的时间积分方法的基本定义出发：\n- 前向欧拉法 (显式一阶方法)，\n- 后向欧拉法 (隐式一阶方法)，\n- 梯形法则 (隐式二阶方法，在常微分方程的背景下也称为 Crank–Nicolson 方法)，\n\n对每种方法，推导其对应的稳定性函数 $R(z)$，并完整地刻画其在复平面上的绝对稳定区域。你的刻画必须包括一个描述该区域的精确不等式和一个几何描述。指出每种方法是否是 $A$-稳定的（绝对稳定区域包含半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$），以及是否是 $L$-稳定的（意即沿着负实轴 $\\lim_{z \\to -\\infty} R(z) = 0$）。\n\n作为最终答案，报告这三种方法的三个稳定性函数 $R(z)$，按前向欧拉法、后向欧拉法、梯形法则的顺序排列成一个单行矩阵。无需数值取整。无需单位。", "solution": "该问题是有效的，因为它是适定的，在常微分方程数值方法理论中有科学依据，并且包含了获得唯一解所需的所有信息。我们将着手推导并分析三种指定方法的稳定性函数和稳定性。\n\n模型问题是线性常微分方程(ODE) $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$。应用于此ODE的单步数值方法产生一个形如 $y_{n+1} = R(z) y_n$ 的递推关系，其中 $y_n$ 是 $y(t_n)$ 的数值近似，$z = \\lambda \\Delta t$，$R(z)$ 是稳定性函数。\n\n需要分析的三种方法是前向欧拉法、后向欧拉法和梯形法则。\n\n**1. 前向欧拉法**\n\n前向欧拉法是一种显式一阶方法，由以下更新规则定义：\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_n)$$\n将此应用于测试方程 $y'(t) = \\lambda y(t)$，我们代入 $y'(t_n) = \\lambda y(t_n) \\approx \\lambda y_n$：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_n) = (1 + \\lambda \\Delta t) y_n$$\n通过设 $z = \\lambda \\Delta t$，我们可以确定稳定性函数 $R(z)$：\n$$R_{\\text{FE}}(z) = 1 + z$$\n绝对稳定区域由 $|R(z)| \\leq 1$ 定义。对于前向欧拉法，即：\n$$|1 + z| \\leq 1$$\n设 $z = x + iy$，其中 $x, y \\in \\mathbb{R}$。不等式变为：\n$$|1 + x + iy| \\leq 1$$\n对模取平方，我们得到：\n$$(1+x)^2 + y^2 \\leq 1^2$$\n这个不等式描述了复平面上以点 $(-1, 0)$ 为中心、半径为 $1$ 的闭圆盘。\n\n这个稳定区域不包含整个左半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$。例如，点 $z = -3$ 满足 $\\operatorname{Re}(z) \\leq 0$，但位于该圆盘之外。因此，前向欧拉法**不是 $A$-稳定的**。\n\n对于 $L$-稳定性，我们考察当 $z$ 沿着负实轴趋于 $-\\infty$ 时 $R(z)$ 的极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{FE}}(z) = \\lim_{z \\to -\\infty} (1+z) = -\\infty$$\n由于极限不为 $0$，该方法**不是 $L$-稳定的**。\n\n**2. 后向欧拉法**\n\n后向欧拉法是一种隐式一阶方法，定义为：\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_{n+1})$$\n将此应用于测试方程，我们代入 $y'(t_{n+1}) = \\lambda y(t_{n+1}) \\approx \\lambda y_{n+1}$：\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1})$$\n我们必须解出 $y_{n+1}$：\n$$y_{n+1}(1 - \\lambda \\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 - \\lambda \\Delta t} y_n$$\n当 $z = \\lambda \\Delta t$ 时，稳定性函数为：\n$$R_{\\text{BE}}(z) = \\frac{1}{1 - z}$$\n绝对稳定区域由 $|R(z)| \\leq 1$ 给出：\n$$\\left|\\frac{1}{1-z}\\right| \\leq 1 \\implies 1 \\leq |1-z|$$\n设 $z = x + iy$。不等式变为：\n$$1 \\leq |1 - (x + iy)| = |(1-x) - iy|$$\n两边平方可得：\n$$1^2 \\leq (1-x)^2 + (-y)^2 \\implies 1 \\leq (x-1)^2 + y^2$$\n这个不等式描述了复平面上以点 $(1, 0)$ 为中心、半径为 $1$ 的开圆盘的外部区域。圆盘的边界包含在稳定区域内。\n\n为检验 $A$-稳定性，我们必须验证该区域是否包含左半平面 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$。对于任何 $x \\leq 0$ 的 $z=x+iy$，我们有 $x-1 \\leq -1$，这意味着 $(x-1)^2 \\geq 1$。由于 $y^2 \\geq 0$，对于左半平面中的任何 $z$，条件 $(x-1)^2 + y^2 \\geq 1$ 总是满足的。因此，后向欧拉法**是 $A$-稳定的**。\n\n对于 $L$-稳定性，我们计算极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{BE}}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0$$\n由于极限为 $0$，该方法**是 $L$-稳定的**。\n\n**3. 梯形法则 (Crank–Nicolson 方法)**\n\n梯形法则是一种隐式二阶方法，定义为：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [y'(t_n) + y'(t_{n+1})]$$\n将此应用于测试方程，得出：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [\\lambda y_n + \\lambda y_{n+1}]$$\n解出 $y_{n+1}$：\n$$y_{n+1}\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = y_n\\left(1 + \\frac{\\lambda \\Delta t}{2}\\right)$$\n$$y_{n+1} = \\frac{1 + \\lambda \\Delta t / 2}{1 - \\lambda \\Delta t / 2} y_n$$\n当 $z = \\lambda \\Delta t$ 时，稳定性函数为：\n$$R_{\\text{TR}}(z) = \\frac{1 + z/2}{1 - z/2} = \\frac{2+z}{2-z}$$\n绝对稳定区域由 $|R(z)| \\leq 1$ 给出：\n$$\\left|\\frac{1 + z/2}{1 - z/2}\\right| \\leq 1 \\implies |1 + z/2| \\leq |1 - z/2|$$\n设 $z = x + iy$。不等式为：\n$$\\left|1 + \\frac{x+iy}{2}\\right| \\leq \\left|1 - \\frac{x+iy}{2}\\right|$$\n$$\\left|\\left(1+\\frac{x}{2}\\right) + i\\frac{y}{2}\\right| \\leq \\left|\\left(1-\\frac{x}{2}\\right) - i\\frac{y}{2}\\right|$$\n两边平方：\n$$\\left(1+\\frac{x}{2}\\right)^2 + \\left(\\frac{y}{2}\\right)^2 \\leq \\left(1-\\frac{x}{2}\\right)^2 + \\left(-\\frac{y}{2}\\right)^2$$\n$$1 + x + \\frac{x^2}{4} + \\frac{y^2}{4} \\leq 1 - x + \\frac{x^2}{4} + \\frac{y^2}{4}$$\n$$2x \\leq 0 \\implies x \\leq 0$$\n稳定区域正是复平面的闭合左半部分，即 $\\operatorname{Re}(z) \\leq 0$。\n\n根据定义，如果一个方法的稳定区域包含左半平面，则该方法是 $A$-稳定的。由于梯形法则的稳定区域正是左半平面，因此它**是 $A$-稳定的**。\n\n对于 $L$-稳定性，我们计算极限：\n$$\\lim_{z \\to -\\infty} R_{\\text{TR}}(z) = \\lim_{z \\to -\\infty} \\frac{2+z}{2-z} = \\lim_{z \\to -\\infty} \\frac{2/z+1}{2/z-1} = \\frac{1}{-1} = -1$$\n由于极限是 $-1$ 而不是 $0$，该方法**不是 $L$-稳定的**。解的高频分量（对应于具有大负实部的 $z$）不会被衰减，反而会以交替的符号持续存在。", "answer": "$$\\boxed{\\begin{pmatrix} 1+z  \\frac{1}{1-z}  \\frac{2+z}{2-z} \\end{pmatrix}}$$", "id": "3287737"}, {"introduction": "虽然A-稳定性（绝对稳定域包含整个左半复平面）是处理刚性问题的理想特性，但它并不能完全描述数值方法的表现。一个A-稳定的方法对高频（刚性）模式的阻尼效果如何，是实际应用中更需要关注的问题。[@problem_id:3287820] 这项练习将深入探讨Crank-Nicolson方法的一个重要特性：它虽然是A-稳定的，但对刚性模式的阻尼很弱，这可能导致在模拟中产生非物理性的“振铃”现象。", "problem": "考虑常微分方程 (ODE) 的线性测试方程 $y'(t) = \\lambda y(t)$，其中 $\\lambda$ 为复数，时间步长 $\\Delta t$ 为定值。对于任意线性单步时间积分方法，其应用于该测试方程的步进关系可写为 $y^{n+1} = R(z)\\,y^{n}$，其中 $z = \\lambda\\,\\Delta t$，$R(z)$ 是该方法的稳定性函数（放大因子）。现在考虑 Crank–Nicolson 方法（也称为梯形法则），并分析 $R(z)$ 在负实轴上的性质，即 $z \\in \\mathbb{R}$ 且 $z  0$。请从第一性原理出发，通过将该方法应用于测试方程来推导 Crank–Nicolson 方法的稳定性函数 $R(z)$，并确定当 $z \\to -\\infty$ 时 $R(z)$ 的极限行为。基于此分析，解释该方法对高度刚性模态（即 $|z| \\gg 1$ 的模态）的阻尼特性，并讨论其对于扩散问题的瞬态计算流体力学 (CFD) 模拟的影响。在这些模拟中，扩散的半离散空间算子产生特征值 $\\lambda_k \\le 0$，且最刚性的模态对应于振荡最剧烈的空间分量。\n\n哪个选项最准确地概括了此分析的正确结论？\n\nA. 对于应用于 $y'(t) = \\lambda y(t)$ 的 Crank-Nicolson 方法，当 $z = \\lambda\\,\\Delta t \\in \\mathbb{R}$ 且 $z \\ll -1$ 时，稳定性函数满足 $R(z) \\to -1$，因此 $|R(z)| \\approx 1$，高度刚性的模态仅受到非常弱的阻尼，同时其符号在步间交替。在半离散的扩散问题中，高波数模态（大的负特征值）会以很弱的衰减持续存在，导致非物理的振铃现象和缓慢的瞬态松弛，除非减小 $\\Delta t$ 或使用 $L$-稳定的积分方法。\n\nB. Crank-Nicolson 方法在负实轴上是 $L$-稳定的，因为当 $z \\to -\\infty$ 时 $R(z) \\to 0$，所以它能快速消除刚性扩散模态，因此在瞬态扩散问题中一致地优于后向欧拉法。\n\nC. Crank-Nicolson 方法在负实轴上是不稳定的，因为对于 $z \\ll -1$ 的情况，有 $|R(z)| > 1$，所以刚性扩散模态会随时间发散，使得该方法无法用于以扩散为主的 CFD 问题。\n\nD. Crank-Nicolson 方法对于扩散问题是条件稳定的；其稳定性要求 $\\Delta t \\le 2/|\\lambda|$，当此条件满足时，刚性模态被强阻尼。如果违反该条件，方法将变得不稳定。\n\nE. 缓慢的阻尼是因为当 $z \\to -\\infty$ 时 $R(z) \\to 1$，所以刚性扩散模态被完美保留。这在瞬态 CFD 中是有利的，可以在不引入数值耗散的情况下保持高频精度。", "solution": "该问题要求分析 Crank-Nicolson 方法对于刚性常微分方程的稳定性，特别是关注其在 $z = \\lambda \\Delta t$ 为大的负实数值时的行为。\n\n### 步骤 1：问题陈述的有效性验证\n在进行求解之前，对问题陈述的有效性进行了严格审查。\n\n**1.1. 提取的已知条件：**\n*   **测试方程：** $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$。\n*   **时间步长：** 一个定值 $\\Delta t$。\n*   **单步积分方法形式：** $y^{n+1} = R(z) y^{n}$。\n*   **稳定性变量：** $z = \\lambda \\Delta t$。\n*   **稳定性函数：** $R(z)$，放大因子。\n*   **分析方法：** Crank-Nicolson 方法（梯形法则）。\n*   **分析域：** 负实轴，$z \\in \\mathbb{R}$ 且 $z  0$。\n*   **任务：**\n    1.  从第一性原理出发，推导 Crank-Nicolson 方法的稳定性函数 $R(z)$。\n    2.  确定当 $z \\to -\\infty$ 时 $R(z)$ 的极限。\n    3.  分析对刚性模态（$|z| \\gg 1$）的阻尼特性，并讨论其对于特征值为实数且非正的扩散问题的瞬态 CFD 模拟的影响。\n\n**1.2. 验证结论：**\n该问题是**有效的**。\n*   **科学上成立：**该分析基于标准的 von Neumann 稳定性分析，使用 Dahlquist 测试方程，这是研究常微分方程（ODE）和偏微分方程（PDE）数值方法中一个基本且普遍接受的技术。刚性、A-稳定性、L-稳定性等概念及其在扩散问题中的应用是计算科学的核心课题。\n*   **适定性：**问题定义清晰，要求在特定条件下推导一个特定函数并分析其性质。它有一个唯一的、可验证的解。\n*   **客观性：**语言精确，使用了数值分析的标准术语，没有主观或模糊的陈述。所有前提在事实上都是正确的，并且结构符合逻辑。\n\n### 步骤 2：推导与分析\n问题已经过验证，现在将从第一性原理开始求解。\n\n**2.1. 稳定性函数 $R(z)$ 的推导**\n将 Crank-Nicolson 方法（也称为梯形法则）应用于一般常微分方程 $y'(t) = f(t, y(t))$，其形式为：\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2} \\left[ f(t^n, y^n) + f(t^{n+1}, y^{n+1}) \\right]$$\n我们将此格式应用于线性测试方程 $y'(t) = \\lambda y(t)$，其中 $f(t,y) = \\lambda y$。将其代入格式得到：\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2} \\left[ \\lambda y^n + \\lambda y^{n+1} \\right]$$\n为了找到步进关系 $y^{n+1} = R(z) y^n$，我们必须求解 $y^{n+1}$ 关于 $y^n$ 的表达式。我们重排方程，将包含 $y^{n+1}$ 的项移到左边，包含 $y^n$ 的项移到右边：\n$$y^{n+1} - \\frac{\\lambda \\Delta t}{2} y^{n+1} = y^n + \\frac{\\lambda \\Delta t}{2} y^n$$\n提出公因子 $y^{n+1}$ 和 $y^n$：\n$$y^{n+1} \\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = y^n \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right)$$\n代入定义 $z = \\lambda \\Delta t$：\n$$y^{n+1} \\left(1 - \\frac{z}{2}\\right) = y^n \\left(1 + \\frac{z}{2}\\right)$$\n解出 $y^{n+1}$ 得到所需形式：\n$$y^{n+1} = \\left( \\frac{1 + z/2}{1 - z/2} \\right) y^n$$\n将其与一般形式 $y^{n+1} = R(z) y^n$ 进行比较，我们确定 Crank-Nicolson 方法的稳定性函数为：\n$$R(z) = \\frac{1 + z/2}{1 - z/2}$$\n\n**2.2. 当 $z \\to -\\infty$ 时的极限行为**\n问题要求我们分析在负实轴上对于刚性模态的行为，这对应于取 $z \\to -\\infty$ 的极限。\n$$\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2}$$\n为了计算这个极限，我们可以将分子和分母同时除以 $z$：\n$$\\lim_{z \\to -\\infty} \\frac{1/z + 1/2}{1/z - 1/2}$$\n当 $z \\to -\\infty$ 时，$1/z$ 项趋近于 $0$。因此，极限为：\n$$\\lim_{z \\to -\\infty} R(z) = \\frac{0 + 1/2}{0 - 1/2} = \\frac{1/2}{-1/2} = -1$$\n\n**2.3. 对刚性扩散问题的影响**\n1.  **稳定性：**稳定性函数的大小 $|R(z)|$ 决定了模态的放大或阻尼。对于 Crank-Nicolson 方法，当 $z$ 在负实轴上 ($z  0$) 时，稳定性函数为 $R(z) = (1+z/2) / (1-z/2)$。由于 $z/2  0$，分子 $1+z/2$ 总是小于 $1$，分母 $1-z/2$ 总是大于 $1$。因此，$|1+z/2|  |1-z/2|$，这意味着对于所有有限的 $z  0$，都有 $|R(z)|  1$。当 $z \\to -\\infty$ 时，$|R(z)| \\to |-1| = 1$。该方法对于所有 $z \\le 0$ 都是无条件稳定的，这个性质被称为 A-稳定性。\n\n2.  **阻尼：**极限 $\\lim_{z \\to -\\infty} R(z) = -1$ 是关键。对于高度刚性的模态（其中 $|z| = |\\lambda \\Delta t| \\gg 1$），放大因子 $R(z)$ 非常接近 $-1$。\n    *   由于 $|R(z)| \\approx 1$，这些刚性模态的阻尼非常弱。它们会在数值解中持续很多时间步，而不是像其物理对应部分那样被快速消除。\n    *   由于 $R(z) \\approx -1$，这些持续存在的模态的振幅在每个时间步都会交替变号 ($y^{n+1} \\approx -y^n$)。这种行为表现为解中的非物理高频振荡，通常称为“振铃”。\n\n3.  **L-稳定性：**如果一个方法是 A-稳定的，并且额外满足 $\\lim_{\\text{Re}(z) \\to -\\infty} |R(z)| = 0$，则称该方法是 L-稳定的。L-稳定性对于刚性问题是一个理想的性质，因为它能确保无限刚性的分量（即 $\\text{Re}(z) \\to -\\infty$ 的极限）在一个时间步内被完全阻尼掉。由于对于 Crank-Nicolson 方法，$\\lim_{z \\to -\\infty} |R(z)| = 1 \\ne 0$，因此该方法**不是** L-稳定的。\n\n4.  **CFD 应用（扩散）：**在扩散主导过程的瞬态 CFD 模拟中，半离散化方程构成一个刚性常微分方程组。空间离散化算子的特征值 $\\lambda_k$ 是实数且非正的 ($\\lambda_k \\le 0$)。最刚性的分量对应于模最大的特征值，而这些特征值与最高波数（振荡最剧烈）的空间模态相关联。这些模态通常代表初始条件误差或应快速衰减的小尺度物理特征。由于缺乏 L-稳定性，Crank-Nicolson 方法无法有效阻尼这些模态，导致持续的、虚假的振荡，这会污染整个解，并使其无法在合理的时间内达到正确的瞬态。为了克服这个问题，必须使用非常小的时间步长 $\\Delta t$（但这违背了使用隐式方法的初衷），或者改用像后向欧拉法这样的 L-稳定积分方法。\n\n### 步骤 3：选项评估\n\n*   **A: 对于应用于 $y'(t) = \\lambda y(t)$ 的 Crank-Nicolson 方法，当 $z = \\lambda\\,\\Delta t \\in \\mathbb{R}$ 且 $z \\ll -1$ 时，稳定性函数满足 $R(z) \\to -1$，因此 $|R(z)| \\approx 1$，高度刚性的模态仅受到非常弱的阻尼，同时其符号在步间交替。在半离散的扩散问题中，高波数模态（大的负特征值）会以很弱的衰减持续存在，导致非物理的振铃现象和缓慢的瞬态松弛，除非减小 $\\Delta t$ 或使用 $L$-稳定的积分方法。**\n    该陈述是我们推导的完美总结。它正确地指出了极限为 $-1$，正确地将其解释为弱阻尼和符号交替，并正确地描述了其对刚性扩散问题的影响以及可能的补救措施。**结论：正确。**\n\n*   **B: Crank–Nicolson 方法在负实轴上是 $L$-稳定的，因为当 $z \\to -\\infty$ 时 $R(z) \\to 0$，所以它能快速消除刚性扩散模态，因此在瞬态扩散问题中一致地优于后向欧拉法。**\n    该陈述在多方面都是错误的。极限是 $R(z) \\to -1$，而不是 $0$。因此，Crank-Nicolson 不是 L-稳定的。它不能快速消除刚性模态。**结论：错误。**\n\n*   **C: Crank–Nicolson 方法在负实轴上是不稳定的，因为对于 $z \\ll -1$ 的情况，有 $|R(z)|  1$，所以刚性扩散模态会随时间发散，使得该方法无法用于以扩散为主的 CFD 问题。**\n    该陈述是错误的。如上所示，对于 $z  0$，我们有 $|R(z)|  1$。该方法在负实轴上是 A-稳定的（无条件稳定），而不是不稳定的。**结论：错误。**\n\n*   **D: Crank–Nicolson 方法对于扩散问题是条件稳定的；其稳定性要求 $\\Delta t \\le 2/|\\lambda|$，当此条件满足时，刚性模态被强阻尼。如果违反该条件，方法将变得不稳定。**\n    该陈述是错误的。Crank-Nicolson 是无条件稳定的，不是条件稳定的。条件 $|\\lambda \\Delta t| \\le 2$（或 $|z| \\le 2$）是显式前向欧拉法的稳定性极限。**结论：错误。**\n\n*   **E: 缓慢的阻尼是因为当 $z \\to -\\infty$ 时 $R(z) \\to 1$，所以刚性扩散模态被完美保留。这在瞬态 CFD 中是有利的，可以在不引入数值耗散的情况下保持高频精度。**\n    该陈述是错误的。极限是 $R(z) \\to -1$，而不是 $1$。由此产生的行为并非有利；持续存在的高频分量通常是数值污染，而不是物理上精确的特征。**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "3287820"}, {"introduction": "理论分析揭示了A-稳定性和更强的L-稳定性之间的关键区别，但通过数值实验可以更直观地理解其对求解过程的实际影响。本练习旨在通过编程实践来对比这两种稳定性。[@problem_id:3287801] 您将对一个典型的刚性弛豫问题分别应用二阶向后差分格式（BDF2，A-稳定）和一个SDIRK方法（L-稳定），并直接观察和量化它们在抑制过冲和阻尼刚性模态方面的不同表现。", "problem": "考虑标量刚性弛豫常微分方程 (ODE) $u_t = -\\lambda \\left(u - u^\\ast\\right)$，其中 $\\lambda \\gg 1$。定义偏差变量 $v(t) = u(t) - u^\\ast$，它满足 $v_t = -\\lambda v$，其精确解为 $v(t) = v(0)\\,\\exp\\left(-\\lambda t\\right)$。对于固定的时间步长 $\\Delta t$，定义无量纲刚性参数 $r = \\lambda \\Delta t$。您将比较二阶两步后向差分公式 (二阶后向差分公式(BDF)方法，简记为 BDF2) 和一种 $L$-稳定的二阶单对角隐式龙格-库塔 (Singly Diagonally Implicit Runge–Kutta, SDIRK) 方法的精度和稳定性表现。\n\n您的程序必须实现以下内容，且仅使用以下基本事实：(i) BDF2 使用二阶后向差分，并在新时刻计算右端项；(ii) SDIRK 方法使用具有相同对角系数的两个隐式阶段：\n\n- 变换为 $v(t) = u(t) - u^\\ast$，从而数值任务简化为求解 $v_t = -\\lambda v$。\n- 对于 BDF2，在第一个时间层使用一个后向欧拉 (Backward Euler) 启动步，然后在第二个时间层使用一个 BDF2 步，两者均使用相同步长 $\\Delta t$。此过程通过单个后向欧拉步从 $v^0$ 生成 $v^1$，然后通过单个 BDF2 步从 $\\left(v^1,v^0\\right)$ 生成 $v^2$。\n- 对于 SDIRK，使用对角参数为 $\\gamma = 1 - 1/\\sqrt{2}$ 的标准两阶段二阶 SDIRK 方法，从 $v^0$ 开始，以相同的 $\\Delta t$ 应用两步来获得 $v^2$。\n\n对于每种方法，您必须：\n- 通过检查任意步骤中 $v$ 的符号是否与 $v^0$ 的符号相比发生了变化，来检测相对于稳态的过冲或下冲。形式上，定义一个布尔值，如果存在任何步索引 $n$ 使得 $v^n \\cdot v^0  0$ 且 $|v^n| > 0$，则为 $\\mathrm{True}$；否则为 $\\mathrm{False}$。\n- 通过计算比率 $\\rho = |v^2|/|v^0|$ 来量化两步后的渐近阻尼。\n\n对于线性问题 $v_t = -\\lambda v$，通过推导方法定义所隐含的代数更新式，从第一性原理出发实现这两种方法。对于 BDF2 步，推导并利用针对方程 $v_t = -\\lambda v$ 将 $v^{n+1}$ 与 $\\left(v^n,v^{n-1}\\right)$ 联系起来的线性递推关系。对于 SDIRK 步，当应用于 $v_t = -\\lambda v$ 时，推导并利用参数为 $\\gamma$ 的两阶段方法的阶段方程，然后使用阶段值构成时间更新。避免任何自适应时间步进或非线性迭代；对于此标量线性问题，阶段和步骤方程可以以闭合形式求解。\n\n测试套件：\n使用以下参数集运行您的程序，每个参数集由 $\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right)$ 组成，并采用恰好两个大小为 $\\Delta t$ 的均匀步：\n- 情况 1：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(50,\\,0.02,\\,2,\\,1\\right)$，因此 $r = 1$。\n- 情况 2：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(1000,\\,0.1,\\,2,\\,1\\right)$，因此 $r = 100$。\n- 情况 3：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(50,\\,0.001,\\,2,\\,1\\right)$，因此 $r = 0.05$。\n- 情况 4：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(200,\\,0.05,\\,0,\\,1\\right)$，因此 $r = 10$ 且初始偏差为负。\n- 情况 5：$\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right) = \\left(10^6,\\,10^{-3},\\,3,\\,1\\right)$，因此 $r = 1000$。\n\n对于每种情况，按顺序计算并返回以下 4 个量：\n- BDF2 过冲布尔值。\n- SDIRK 过冲布尔值。\n- BDF2 两步阻尼比 $\\rho_{\\mathrm{BDF2}} = |v^2|/|v^0|$。\n- SDIRK 两步阻尼比 $\\rho_{\\mathrm{SDIRK}} = |v^2|/|v^0|$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例贡献一个形如 $\\left[\\text{BDF2\\_overshoot},\\text{SDIRK\\_overshoot},\\rho_{\\mathrm{BDF2}},\\rho_{\\mathrm{SDIRK}}\\right]$ 的子列表。\n- 布尔值必须显示为 $\\mathrm{True}$ 或 $\\mathrm{False}$。\n- 浮点数必须使用标准的四舍五入精确到 $6$ 位小数。\n- 方括号内的任何位置都不能有多余的空白字符。\n\n所需形状示例（仅为说明）：$\\left[[\\mathrm{False},\\mathrm{False},0.123456,0.012345],[\\dots]\\right]$。", "solution": "用户提交了来自数值分析领域的有效问题陈述，具体涉及刚性常微分方程时间积分方案的稳定性和准确性。该问题具有科学依据、提法恰当、客观，并包含唯一解所需的所有必要信息。我现在将进行正式的推导和求解。\n\n该问题要求对应用于标量线性刚性弛豫方程的两种二阶时间积分方案进行比较分析：\n$$\n\\frac{du}{dt} = u_t = -\\lambda (u - u^\\ast)\n$$\n其中 $\\lambda \\gg 1$。通过将与平衡点的偏差定义为 $v(t) = u(t) - u^\\ast$，我们得到更简单的齐次线性常微分方程：\n$$\n\\frac{dv}{dt} = v_t = -\\lambda v\n$$\n数值分析将在此方程上进行。无量纲刚性参数定义为 $r = \\lambda \\Delta t$，其中 $\\Delta t$ 是固定时间步长。我们将为 BDF2 和 SDIRK 方法推导过冲和两步阻尼比 $\\rho = |v^2|/|v^0|$ 的表达式。\n\n### 二阶后向差分公式 (BDF2)\n\n为 BDF2 方法指定的过程包括使用一阶后向欧拉 (Backward Euler, BE) 方法的一个启动步，然后是二阶 BDF2 方法的一个步。\n\n**1. 后向欧拉启动步：**\n将 BE 方法应用于 $v_t = -\\lambda v$ 以求出在时间 $t_1 = \\Delta t$ 处的近似值 $v^1$ (从 $t_0=0$ 处的 $v^0$ 开始)，由下式给出：\n$$\n\\frac{v^1 - v^0}{\\Delta t} = -\\lambda v^1\n$$\n解出 $v^1$ 可得：\n$$\nv^1 - v^0 = -(\\lambda \\Delta t) v^1 = -r v^1\n$$\n$$\nv^1 (1 + r) = v^0 \\implies v^1 = \\frac{1}{1+r} v^0\n$$\n\n**2. BDF2 步：**\nBDF2 方法使用 $v^0$ 和 $v^1$ 来求出时间 $t_2 = 2\\Delta t$ 处的 $v^2$。该公式由在 $t_{n+1}$ 处导数的二阶后向差分近似推导而来：\n$$\n\\frac{3v^{n+1} - 4v^n + v^{n-1}}{2\\Delta t} = f(t_{n+1}, v^{n+1}) = -\\lambda v^{n+1}\n$$\n对于我们的第二步 ($n=1$)，该式变为：\n$$\n\\frac{3v^2 - 4v^1 + v^0}{2\\Delta t} = -\\lambda v^2\n$$\n$$\n3v^2 - 4v^1 + v^0 = -2(\\lambda \\Delta t) v^2 = -2r v^2\n$$\n解出 $v^2$：\n$$\nv^2(3 + 2r) = 4v^1 - v^0\n$$\n代入来自 BE 步的 $v^1$ 表达式：\n$$\nv^2(3 + 2r) = 4\\left(\\frac{1}{1+r} v^0\\right) - v^0 = \\left(\\frac{4}{1+r} - 1\\right) v^0 = \\frac{4 - (1+r)}{1+r} v^0 = \\frac{3-r}{1+r} v^0\n$$\n因此，两步过程的放大因子是：\n$$\nG_{\\mathrm{BDF2}}(r) = \\frac{v^2}{v^0} = \\frac{3-r}{(1+r)(3+2r)}\n$$\n\n**3. BDF2 的过冲和阻尼：**\n- **过冲：**如果任何 $v^n$ 的符号与 $v^0$ 相反，则发生过冲（如果 $v^0 > 0$，则为下冲）。\n  - 对于第一步，$v^1/v^0 = 1/(1+r)$，当 $r > 0$ 时恒为正。在第 1 步不会发生过冲。\n  - 对于第二步，$v^2/v^0$ 的符号由 $G_{\\mathrm{BDF2}}(r)$ 的符号决定。由于分母 $(1+r)(3+2r)$ 对于 $r>0$ 为正，符号由分子 $3-r$ 决定。如果 $3-r  0$，即 $r > 3$，则发生过冲。\n- **阻尼比：**两步阻尼比为 $\\rho_{\\mathrm{BDF2}} = |v^2/v^0| = |G_{\\mathrm{BDF2}}(r)|$。\n$$\n\\rho_{\\mathrm{BDF2}} = \\left| \\frac{3-r}{(1+r)(3+2r)} \\right|\n$$\n\n### 单对角隐式龙格-库塔 (SDIRK) 方法\n\n问题指定了一种两阶段、二阶、$L$-稳定的 SDIRK 方法，其对角 Butcher 系数为 $\\gamma = 1 - 1/\\sqrt{2}$。对于线性常微分方程 $v_t = -\\lambda v$，龙格-库塔方法的单步等效于乘以其稳定性函数，$v^{n+1} = R(-\\lambda \\Delta t) v^n = R(-r) v^n$。对于此 SDIRK 方法，稳定性函数为 $R(-r) = \\frac{1 - r(1-2\\gamma)}{(1+r\\gamma)^2}$。我们把这个单步放大因子记为 $S(r) = R(-r)$。\n\n两步过程包括以相同的步长 $\\Delta t$ 将此方法应用两次。\n$v^1 = S(r) v^0$\n$v^2 = S(r) v^1 = (S(r))^2 v^0$\n\n**1. SDIRK 放大因子：**\n当 $\\gamma = 1 - 1/\\sqrt{2}$ 时，我们可以简化一些项：\n$1 - 2\\gamma = 1 - 2(1 - 1/\\sqrt{2}) = 1 - 2 + \\sqrt{2} = \\sqrt{2} - 1$。\n单步放大因子为：\n$$\nS(r) = \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2}\n$$\n两步放大因子为 $G_{\\mathrm{SDIRK}}(r) = v^2/v^0 = (S(r))^2$。\n\n**2. SDIRK 的过冲和阻尼：**\n- **过冲：**如果 $v^1$ 或 $v^2$ 的符号与 $v^0$ 相反，则发生过冲。\n  - 对于第二步，$v^2/v^0 = (S(r))^2 \\ge 0$。相对于初始状态 $v^0$，在第 2 步不会发生过冲。\n  - 对于第一步，如果 $v^1/v^0 = S(r)  0$ 则发生过冲。$S(r)$ 的分母是一个平方，因此是非负的。符号由分子 $1 - r(\\sqrt{2}-1)$ 决定。过冲的条件是 $1 - r(\\sqrt{2}-1)  0$，这意味着 $r > \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1 \\approx 2.414$。\n- **阻尼比：**两步阻尼比为 $\\rho_{\\mathrm{SDIRK}} = |v^2/v^0| = |(S(r))^2| = (S(r))^2$。\n$$\n\\rho_{\\mathrm{SDIRK}} = \\left( \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2} \\right)^2\n$$\n\n基于这些推导，可以实现一个程序来计算给定测试套件所需的量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing BDF2 and SDIRK methods for a stiff ODE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (lambda, dt, u0, u_star)\n        (50.0, 0.02, 2.0, 1.0),    # r = 1\n        (1000.0, 0.1, 2.0, 1.0),   # r = 100\n        (50.0, 0.001, 2.0, 1.0),   # r = 0.05\n        (200.0, 0.05, 0.0, 1.0),   # r = 10\n        (10**6, 10**-3, 3.0, 1.0)  # r = 1000\n    ]\n\n    all_results = []\n    \n    # Constants for SDIRK method\n    sqrt2 = np.sqrt(2)\n    gamma = 1 - 1 / sqrt2\n    sdirk_overshoot_threshold = sqrt2 + 1\n    sqrt2_minus_1 = sqrt2 - 1\n    \n    # BDF2 overshoot threshold\n    bdf2_overshoot_threshold = 3.0\n\n    for case in test_cases:\n        lam, dt, u0, u_star = case\n        \n        # Calculate non-dimensional stiffness parameter\n        r = lam * dt\n        \n        # -------- BDF2 Method --------\n        # Check for overshoot\n        bdf2_overshoot = r > bdf2_overshoot_threshold\n        \n        # Calculate two-step damping ratio\n        rho_bdf2_val = abs((3 - r) / ((1 + r) * (3 + 2 * r)))\n\n        # -------- SDIRK Method --------\n        # Check for overshoot\n        sdirk_overshoot = r > sdirk_overshoot_threshold\n        \n        # Calculate single-step amplification factor\n        s_of_r = (1 - r * sqrt2_minus_1) / (1 + r * gamma)**2\n        \n        # Calculate two-step damping ratio\n        rho_sdirk_val = s_of_r**2\n        \n        # Assemble results for one case, formatted as strings\n        case_results = [\n            \"True\" if bdf2_overshoot else \"False\",\n            \"True\" if sdirk_overshoot else \"False\",\n            f\"{rho_bdf2_val:.6f}\",\n            f\"{rho_sdirk_val:.6f}\"\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    inner_strings = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # The final print statement must produce only the specified single-line format.\n    print(final_output)\n\nsolve()\n```", "id": "3287801"}]}