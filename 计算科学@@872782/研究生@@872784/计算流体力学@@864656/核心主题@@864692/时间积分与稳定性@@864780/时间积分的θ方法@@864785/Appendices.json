{"hands_on_practices": [{"introduction": "在计算流体动力学中，选择时间积分方法时，首要考虑的是其稳定性。一个数值格式如果不够稳定，即使它在理论上精度很高，微小的扰动也可能在计算过程中被放大，导致结果完全失效。本练习将通过分析最经典的标量测试方程来深入探讨 $\\theta$ 方法的稳定性，展示如何通过调节参数 $\\theta$ 来控制稳定性边界，并揭示其在处理刚性问题时的重要意义 [@problem_id:3383070]。", "problem": "考虑计算流体动力学中方法线分析所使用的线性标量测试方程，其形式为 $u^{\\prime}(t)=\\lambda\\,u(t)$，其中 $\\lambda\\in\\mathbb{C}$ 是一个常数。$\\theta$-方法时间积分器通过对右端项（参数为 $\\theta\\in[0,1]$）进行时间上的加权平均，将 $u^{n}\\approx u(t^{n})$ 推进到 $u^{n+1}\\approx u(t^{n+1})$，时间步长为 $\\Delta t=t^{n+1}-t^{n}$。从 $\\theta$-方法的定义出发，即它是一种通过在 $(t^{n},u^{n})$ 和 $(t^{n+1},u^{n+1})$ 的凸组合处计算右端项而获得的单步线性隐式格式，推导出单步递推因子 $G(z)$，其中 $z=\\lambda\\,\\Delta t$，使得 $u^{n+1}=G(z)\\,u^{n}$。根据线性绝对稳定性的标准概念，该格式对于满足 $|G(z)|\\le 1$ 的 $z$ 是稳定的。\n\n对于特定情况 $\\lambda=-100\\,\\mathrm{s}^{-1}$ 和 $\\theta\\in\\{0,\\tfrac{1}{2},1\\}$ 这几个值，确定满足 $|G(\\lambda\\,\\Delta t)|\\le 1$ 的最大时间步长 $\\Delta t$（单位为 $\\mathrm{s}$）。如果 $\\Delta t$ 没有有限上界，则报告为 $+\\infty$。如果得到有限数值，则将其四舍五入到四位有效数字。最后，根据三种 $\\theta$ 选择的刚性问题求解能力和耗散特性来解释得到的时间步长界限，简要说明结果与负实轴上的稳定性以及快速衰减模态的阻尼有何关系。\n\n遵循上述四舍五入指令，将最终答案表示为行矩阵 $\\bigl[\\Delta t_{\\theta=0},\\ \\Delta t_{\\theta=1/2},\\ \\Delta t_{\\theta=1}\\bigr]$，单位为 $\\mathrm{s}$。", "solution": "问题要求我们分析 $\\theta$-方法对于线性标量测试方程 $u^{\\prime}(t) = \\lambda u(t)$ 的稳定性。$\\theta$-方法使用有限差分格式来近似该微分方程。\n\n首先，我们推导 $\\theta$-方法的单步递推关系。该方法的一般形式由下式给出：\n$$ \\frac{u^{n+1} - u^{n}}{\\Delta t} = (1-\\theta) f(t^n, u^n) + \\theta f(t^{n+1}, u^{n+1}) $$\n对于给定的测试方程，右端项为 $f(t,u) = \\lambda u(t)$。将此代入格式中，我们得到：\n$$ \\frac{u^{n+1} - u^{n}}{\\Delta t} = (1-\\theta) (\\lambda u^{n}) + \\theta (\\lambda u^{n+1}) $$\n我们的目标是找到放大因子 $G(z)$，使得 $u^{n+1} = G(z) u^{n}$，其中 $z = \\lambda \\Delta t$。为此，我们重新整理方程以求解 $u^{n+1}$：\n$$ u^{n+1} - u^{n} = \\Delta t (1-\\theta) \\lambda u^{n} + \\Delta t \\theta \\lambda u^{n+1} $$\n$$ u^{n+1} - \\theta \\lambda \\Delta t u^{n+1} = u^{n} + (1-\\theta) \\lambda \\Delta t u^{n} $$\n$$ u^{n+1} (1 - \\theta \\lambda \\Delta t) = u^{n} (1 + (1-\\theta) \\lambda \\Delta t) $$\n代入 $z = \\lambda \\Delta t$：\n$$ u^{n+1} (1 - \\theta z) = u^{n} (1 + (1-\\theta) z) $$\n这就给出了单步递推关系：\n$$ u^{n+1} = \\left( \\frac{1 + (1-\\theta)z}{1 - \\theta z} \\right) u^{n} $$\n因此，放大因子为：\n$$ G(z) = \\frac{1 + (1-\\theta)z}{1 - \\theta z} $$\n当放大因子的模不大于1，即 $|G(z)| \\le 1$ 时，该格式被定义为绝对稳定的。\n\n给定 $\\lambda = -100\\,\\mathrm{s}^{-1}$，这是一个负实常数。由于时间步长 $\\Delta t$ 必须为正，参数 $z = \\lambda \\Delta t = -100 \\Delta t$ 是一个负实数。我们用 $x$ 表示 $z$，其中 $x  0$。稳定性条件变为：\n$$ \\left| \\frac{1 + (1-\\theta)x}{1 - \\theta x} \\right| \\le 1 $$\n由于 $x$ 是实数，这等价于：\n$$ (1 + (1-\\theta)x)^2 \\le (1 - \\theta x)^2 $$\n$$ 1 + 2(1-\\theta)x + (1-\\theta)^2 x^2 \\le 1 - 2\\theta x + \\theta^2 x^2 $$\n$$ 2(1-\\theta)x + (1-2\\theta+\\theta^2)x^2 \\le -2\\theta x + \\theta^2 x^2 $$\n$$ 2x - 2\\theta x + x^2 - 2\\theta x^2 + \\theta^2 x^2 \\le -2\\theta x + \\theta^2 x^2 $$\n$$ 2x + x^2 - 2\\theta x^2 \\le 0 $$\n$$ x(2 + x(1-2\\theta)) \\le 0 $$\n由于 $x  0$，我们需要 $2 + x(1-2\\theta) \\ge 0$。\n$$ x(1-2\\theta) \\ge -2 $$\n我们现在对 $\\theta \\in \\{0, \\frac{1}{2}, 1\\}$ 这三个指定值分析此条件。\n\n情况1：$\\theta = 0$（显式前向欧拉法）\n稳定性条件变为：\n$$ x(1-0) \\ge -2 \\implies x \\ge -2 $$\n由于 $x = \\lambda \\Delta t = -100 \\Delta t$，我们有：\n$$ -100 \\Delta t \\ge -2 $$\n$$ \\Delta t \\le \\frac{2}{100} = 0.02\\,\\mathrm{s} $$\n保持稳定性的最大时间步长是 $\\Delta t = 0.02\\,\\mathrm{s}$。四舍五入到四位有效数字，即为 $0.02000\\,\\mathrm{s}$。\n\n情况2：$\\theta = \\frac{1}{2}$（隐式克兰克-尼科尔森法）\n稳定性条件变为：\n$$ x(1-1) \\ge -2 \\implies 0 \\ge -2 $$\n这个不等式恒为真，与 $x$ 的值无关。因此，该方法对所有 $x  0$ 都是稳定的。这意味着该方法对于任何时间步长 $\\Delta t > 0$ 都是无条件稳定的。因此，最大时间步长为 $+\\infty$。\n\n情况3：$\\theta = 1$（隐式后向欧拉法）\n稳定性条件变为：\n$$ x(1-2) \\ge -2 \\implies -x \\ge -2 \\implies x \\le 2 $$\n由于我们考虑的是 $x = \\lambda \\Delta t  0$，条件 $x \\le 2$ 恒成立。此方法对于任何时间步长 $\\Delta t > 0$ 也是无条件稳定的。因此，最大时间步长为 $+\\infty$。\n\n结果解释：\n$\\lambda = -100\\,\\mathrm{s}^{-1}$ 的问题代表了一个刚性常微分方程，其中衰减解的特征时间尺度 $\\tau = 1/|\\lambda| = 0.01\\,\\mathrm{s}$ 非常短。\n\n对于 $\\theta=0$（前向欧拉法，一种显式方法），稳定性要求 $\\Delta t \\le 2/|\\lambda| = 0.02\\,\\mathrm{s}$。这个时间步长限制是由稳定性而非精度决定的，并且与系统的特征时间尺度在同一量级。对于刚性系统，这是非常严格的限制，因为即使在快速暂态衰减后且解变化缓慢时，也必须使用非常小的时间步长。该方法在负实轴上的稳定域是区间 $[-2, 0]$。\n\n对于 $\\theta=\\frac{1}{2}$（克兰克-尼科尔森法，一种隐式方法），该格式是A-稳定的，意味着其稳定域包含整个复平面左半部分。因此，对于任何 $\\text{Re}(\\lambda)  0$，它都是无条件稳定的，$\\Delta t$ 的选择仅受精度考虑的限制。然而，对于负向大的 $z$，放大因子趋近于 $-1$，即 $\\lim_{z\\to-\\infty} G(z) = -1$。这意味着快速衰减的模态在数值上不会被阻尼掉，而是以虚假的、无阻尼的振荡形式持续存在。这种对刚性分量缺乏耗散性是一个显著的缺点。\n\n对于 $\\theta=1$（后向欧拉法，一种隐式方法），该格式也是A-稳定的，因此是无条件稳定的。关键在于，它还是L-稳定的，即 $\\lim_{z\\to-\\infty} G(z) = 0$。对于此方法，$G(z) = 1/(1-z)$，当 $z$ 沿实轴趋于 $-\\infty$ 时，其值趋于 $0$。这种强耗散特性确保了刚性分量（快速衰减的模态）在数值解中被快速有效地阻尼掉，从而防止了虚假振荡，并能正确模拟刚性系统的物理特性。因此，对于非常刚性的问题，后向欧拉法通常比克兰克-尼科尔森法更受青睐。\n\n总而言之，显式前向欧拉法由于其严格的稳定性约束，对于刚性问题是不切实际的。两种隐式方法，克兰克-尼科尔森法和后向欧拉法，都克服了这一稳定性限制，但L-稳定的后向欧拉法在阻尼高频数值误差方面更为优越，这是对刚性现象进行稳健CFD模拟的一个关键特性。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.02000  +\\infty  +\\infty \\end{pmatrix}} $$", "id": "3383070"}, {"introduction": "在确保了数值格式的稳定性之后，下一步是考察其在实际系统中的表现。本练习将 $\\theta$ 方法应用于一个模拟扩散过程的线性方程组，并通过计算一个时间步长后系统离散能量的变化，来具体展示数值格式的耗散或守恒特性。这里特别选用 $\\theta = 1/2$ 的Crank-Nicolson方法，让我们可以直观地看到这个在稳定性分析中表现优异的格式，是如何影响类物理量的 [@problem_id:3383107]。", "problem": "考虑一个源于计算流体力学（CFD）的线性半离散抛物型系统，写作 $M \\frac{d u}{d t} + K u = 0$。其中 $M \\in \\mathbb{R}^{m \\times m}$ 和 $K \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵，分别代表与扩散型偏微分方程的空间离散化相关的质量算子和刚度算子。设离散能量定义为 $E(u) = \\frac{1}{2} u^{\\top} K u$。使用时间步长恒为 $\\Delta t  0$ 的 $\\theta$-方法进行时间积分，从 $t^{n}$ 时的 $u^{n}$ 求解 $u(t^{n+1})$ 的近似值 $u^{n+1}$。\n\n在本问题中，取 $m=2$, $M = I$, $K = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}$, $\\Delta t = 0.1$, $\\theta = \\frac{1}{2}$ 以及 $u^{n} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$。仅使用控制方程 $M \\frac{d u}{d t} + K u = 0$ 和 $\\theta$-方法的定义，应用一个 $\\theta$-方法步长从 $u^{n}$ 得到 $u^{n+1}$。然后计算离散能量的变化 $\\Delta E = E(u^{n+1}) - E(u^{n})$。\n\n请给出 $\\Delta E$ 的单一数值，形式为一个完全化简的精确分数。不要四舍五入。", "solution": "### 步骤1：问题分析与公式推导\n该问题要求应用 $\\theta$-方法求解一个由扩散型偏微分方程半离散化得到的线性常微分方程组 $M \\frac{d u}{d t} + K u = 0$。我们需要计算一个时间步长后的离散能量变化。\n\n**已知条件**:\n- **控制方程:** $M \\frac{d u}{d t} + K u = 0$, 等价于 $\\frac{d u}{d t} = -M^{-1} K u$。\n- **矩阵与向量:**\n    - $m=2$\n    - $M = I = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$ (单位矩阵)\n    - $K = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}$\n    - $\\Delta t = 0.1$\n    - $\\theta = \\frac{1}{2}$ (Crank-Nicolson 方法)\n    - 初始条件: $u^{n} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$\n- **能量定义:** $E(u) = \\frac{1}{2} u^{\\top} K u$。\n- **目标:** 计算 $\\Delta E = E(u^{n+1}) - E(u^{n})$。\n\n首先，将 $\\theta$-方法应用于控制方程。方程 $M \\frac{du}{dt} = -Ku$ 的离散格式为：\n$$\nM \\frac{u^{n+1} - u^n}{\\Delta t} = - (1-\\theta) K u^n - \\theta K u^{n+1}\n$$\n由于 $M=I$，格式简化为：\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = - (1-\\theta) K u^n - \\theta K u^{n+1}\n$$\n整理方程，将包含 $u^{n+1}$ 的项移到左边，包含 $u^n$ 的项移到右边：\n$$\nu^{n+1} + \\theta \\Delta t K u^{n+1} = u^n - (1-\\theta) \\Delta t K u^n\n$$\n$$\n(I + \\theta \\Delta t K) u^{n+1} = (I - (1-\\theta) \\Delta t K) u^n\n$$\n\n### 步骤2：代入数值进行计算\n将给定参数 $\\theta = \\frac{1}{2}$ 和 $\\Delta t = 0.1 = \\frac{1}{10}$ 代入，得到 Crank-Nicolson 方法的特定形式：\n$$\n\\left(I + \\frac{1}{2} \\Delta t K\\right) u^{n+1} = \\left(I - \\frac{1}{2} \\Delta t K\\right) u^n\n$$\n计算方程中的矩阵：\n$$\n\\frac{1}{2} \\Delta t K = \\frac{1}{2} \\left(\\frac{1}{10}\\right) \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} = \\frac{1}{20} \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{10}  -\\frac{1}{20} \\\\ -\\frac{1}{20}  \\frac{1}{10}\\end{pmatrix}\n$$\n左侧矩阵 $A_{LHS} = I + \\frac{1}{2} \\Delta t K$:\n$$\nA_{LHS} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} + \\begin{pmatrix}\\frac{1}{10}  -\\frac{1}{20} \\\\ -\\frac{1}{20}  \\frac{1}{10}\\end{pmatrix} = \\begin{pmatrix}\\frac{11}{10}  -\\frac{1}{20} \\\\ -\\frac{1}{20}  \\frac{11}{10}\\end{pmatrix}\n$$\n右侧矩阵 $A_{RHS} = I - \\frac{1}{2} \\Delta t K$:\n$$\nA_{RHS} = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} - \\begin{pmatrix}\\frac{1}{10}  -\\frac{1}{20} \\\\ -\\frac{1}{20}  \\frac{1}{10}\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{10}  \\frac{1}{20} \\\\ \\frac{1}{20}  \\frac{9}{10}\\end{pmatrix}\n$$\n计算右侧向量 $b = A_{RHS} u^n$：\n$$\nb = \\begin{pmatrix}\\frac{9}{10}  \\frac{1}{20} \\\\ \\frac{1}{20}  \\frac{9}{10}\\end{pmatrix} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{10} \\\\ \\frac{1}{20}\\end{pmatrix}\n$$\n现在，我们求解线性系统 $A_{LHS} u^{n+1} = b$ 来得到 $u^{n+1} = \\begin{pmatrix}x \\\\ y\\end{pmatrix}$：\n$$\n\\begin{pmatrix}\\frac{11}{10}  -\\frac{1}{20} \\\\ -\\frac{1}{20}  \\frac{11}{10}\\end{pmatrix} \\begin{pmatrix}x \\\\ y\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{10} \\\\ \\frac{1}{20}\\end{pmatrix}\n$$\n为了方便计算，将两个方程都乘以 $20$：\n1.  $22x - y = 18$\n2.  $-x + 22y = 1$\n\n从方程 (2) 解出 $x = 22y - 1$，并代入方程 (1)：\n$$\n22(22y - 1) - y = 18\n$$\n$$\n484y - 22 - y = 18\n$$\n$$\n483y = 40 \\implies y = \\frac{40}{483}\n$$\n将 $y$ 的值代回求 $x$：\n$$\nx = 22\\left(\\frac{40}{483}\\right) - 1 = \\frac{880}{483} - \\frac{483}{483} = \\frac{397}{483}\n$$\n因此，时间步 $n+1$ 的解为：\n$$\nu^{n+1} = \\begin{pmatrix}\\frac{397}{483} \\\\ \\frac{40}{483}\\end{pmatrix}\n$$\n\n### 步骤3：计算能量变化\n离散能量定义为 $E(u) = \\frac{1}{2} u^{\\top} K u$。\n计算初始能量 $E(u^n)$：\n$$\nE(u^n) = \\frac{1}{2} (u^n)^{\\top} K u^n = \\frac{1}{2} \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}2  -1\\end{pmatrix} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = \\frac{1}{2}(2) = 1\n$$\n计算新时刻的能量 $E(u^{n+1})$：\n$$\nE(u^{n+1}) = \\frac{1}{2} (u^{n+1})^{\\top} K u^{n+1} = \\frac{1}{2} \\left(\\frac{1}{483}\\begin{pmatrix}397  40\\end{pmatrix}\\right) \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\left(\\frac{1}{483}\\begin{pmatrix}397 \\\\ 40\\end{pmatrix}\\right)\n$$\n$$\nE(u^{n+1}) = \\frac{1}{2 \\cdot 483^2} \\begin{pmatrix}397  40\\end{pmatrix} \\begin{pmatrix}2(397) - 1(40) \\\\ -1(397) + 2(40)\\end{pmatrix} = \\frac{1}{2 \\cdot 483^2} \\begin{pmatrix}397  40\\end{pmatrix} \\begin{pmatrix}754 \\\\ -317\\end{pmatrix}\n$$\n$$\nE(u^{n+1}) = \\frac{1}{2 \\cdot 483^2} (397 \\cdot 754 - 40 \\cdot 317) = \\frac{1}{2 \\cdot 233289} (299338 - 12680) = \\frac{286658}{466578} = \\frac{143329}{233289}\n$$\n最后，计算离散能量的变化 $\\Delta E = E(u^{n+1}) - E(u^{n})$：\n$$\n\\Delta E = \\frac{143329}{233289} - 1 = \\frac{143329 - 233289}{233289} = -\\frac{89960}{233289}\n$$\n分子 $89960 = 2^3 \\cdot 5 \\cdot 13 \\cdot 173$ 和分母 $233289 = 483^2 = (3 \\cdot 7 \\cdot 23)^2$ 没有公因子，因此该分数为最简形式。", "answer": "$$\\boxed{-\\frac{89960}{233289}}$$", "id": "3383107"}, {"introduction": "无条件稳定性和高阶精度并非时间积分格式的全部。在许多CFD问题中，解必须满足特定的物理约束，例如浓度或密度必须为非负。本练习揭示了Crank-Nicolson方法（$\\theta=1/2$）一个重要的潜在缺陷：即使精确解始终为正，该方法在某些情况下也无法保证数值解的保正性。通过这个具体的计算，我们可以理解为何在某些应用中，选择具有更强保正性的格式（如向后欧拉法）是至关重要的 [@problem_id:3383089]。", "problem": "考虑一个由2个耦合控制体积上的扩散-反应平衡产生的半离散线性系统，\n$$\n\\frac{d\\boldsymbol{u}}{dt} + A\\,\\boldsymbol{u} = \\boldsymbol{0},\n$$\n其中 $A \\in \\mathbb{R}^{2\\times 2}$ 的非对角线元素为非正值，且特征值严格为正，因此 $A$ 是一个非奇异的M-矩阵。特别地，取\n$$\nA \\;=\\; \\begin{pmatrix} 2  -1 \\\\ -2  3 \\end{pmatrix}.\n$$\n令 $\\boldsymbol{u}(t)$ 表示单元平均未知量向量，并假设初始数据为非负，\n$$\n\\boldsymbol{u}(0) \\;=\\; \\boldsymbol{u}^0 \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用参数为 $\\theta = \\tfrac{1}{2}$ 的 $\\theta$-方法（Crank–Nicolson方法）进行时间离散化，即，通过将时间导数替换为与梯形法则一致的单步隐式-显式线性组合，以时间步长 $\\Delta t$ 从 $\\boldsymbol{u}^n$推进到 $\\boldsymbol{u}^{n+1}$。完全从控制方程和 $\\theta$-方法的定义出发进行推导；不要假设任何关于放大矩阵的先验公式。\n\n1. 当 $\\theta = \\tfrac{1}{2}$ 时，推导求解 $\\boldsymbol{u}^{n+1}$ 的线性系统，用 $A$、$\\Delta t$ 和 $\\boldsymbol{u}^n$ 表示。\n\n2. 对于 $\\Delta t = 2$ 的特定选择，构建此线性系统中的矩阵，并从上面给出的 $\\boldsymbol{u}^0$ 开始，精确求解单步更新后的 $\\boldsymbol{u}^1$。\n\n3. 通过直接计算验证，尽管 $A$ 是一个M-矩阵且 $\\boldsymbol{u}^0$ 是非负的，但 $\\boldsymbol{u}^1$ 的一个分量是负的。报告该负分量的值。\n\n以精确的有理数形式表示最终值。不需要单位。", "solution": "该问题要求分析将参数为 $\\theta = \\frac{1}{2}$ 的 $\\theta$-方法（Crank-Nicolson方法）应用于一个线性常微分方程组。此过程包括三个部分：推导通用更新格式，求解一个特定的单步更新，以及辨识结果向量中的一个特定分量。\n\n控制方程以半离散线性系统的形式给出：\n$$\n\\frac{d\\boldsymbol{u}}{dt} + \\boldsymbol{A}\\,\\boldsymbol{u} = \\boldsymbol{0} \\quad \\implies \\quad \\frac{d\\boldsymbol{u}}{dt} = -\\boldsymbol{A}\\,\\boldsymbol{u}\n$$\n其中 $\\boldsymbol{u}(t) \\in \\mathbb{R}^2$ 且 $\\boldsymbol{A} \\in \\mathbb{R}^{2\\times 2}$。时间导数使用 $\\theta$-方法进行离散化。对于一个时间步长 $\\Delta t$，令 $\\boldsymbol{u}^n$ 为 $\\boldsymbol{u}(t_n)$ 的近似值，其中 $t_n = n \\Delta t$。时间导数的有限差分近似为 $\\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t}$。右侧项 $-\\boldsymbol{A}\\boldsymbol{u}$ 在时间 $t_n$ 和 $t_{n+1}$ 处以加权平均的形式计算：\n$$\n\\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t} = - (1-\\theta)\\boldsymbol{A}\\boldsymbol{u}^n - \\theta\\boldsymbol{A}\\boldsymbol{u}^{n+1}\n$$\n这是将 $\\theta$-方法应用于给定系统的一般公式。\n\n### 第1部分：推导求解 $\\boldsymbol{u}^{n+1}$ 的线性系统\n\n题目指定使用Crank-Nicolson方法，这对应于设置参数 $\\theta = \\frac{1}{2}$。将该值代入通用的 $\\theta$-方法公式中，得到：\n$$\n\\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t} = - \\left(1-\\frac{1}{2}\\right)\\boldsymbol{A}\\boldsymbol{u}^n - \\frac{1}{2}\\boldsymbol{A}\\boldsymbol{u}^{n+1}\n$$\n$$\n\\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n}{\\Delta t} = - \\frac{1}{2}\\boldsymbol{A}\\boldsymbol{u}^n - \\frac{1}{2}\\boldsymbol{A}\\boldsymbol{u}^{n+1}\n$$\n为了推导求解 $\\boldsymbol{u}^{n+1}$ 的线性系统，我们需要将所有含 $\\boldsymbol{u}^{n+1}$ 的项收集到左侧，将所有含 $\\boldsymbol{u}^n$ 的项收集到右侧。方程两边同乘以 $\\Delta t$：\n$$\n\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^n = - \\frac{\\Delta t}{2}\\boldsymbol{A}\\boldsymbol{u}^n - \\frac{\\Delta t}{2}\\boldsymbol{A}\\boldsymbol{u}^{n+1}\n$$\n整理各项：\n$$\n\\boldsymbol{u}^{n+1} + \\frac{\\Delta t}{2}\\boldsymbol{A}\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n - \\frac{\\Delta t}{2}\\boldsymbol{A}\\boldsymbol{u}^n\n$$\n在左侧提出公因子 $\\boldsymbol{u}^{n+1}$，在右侧提出公因子 $\\boldsymbol{u}^n$，并使用单位矩阵 $\\boldsymbol{I}$：\n$$\n\\left(\\boldsymbol{I} + \\frac{\\Delta t}{2}\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\left(\\boldsymbol{I} - \\frac{\\Delta t}{2}\\boldsymbol{A}\\right)\\boldsymbol{u}^n\n$$\n这就是在每个时间步中为了从 $\\boldsymbol{u}^n$ 求得 $\\boldsymbol{u}^{n+1}$ 所必须求解的线性系统。\n\n### 第2部分：求解单步更新 $\\boldsymbol{u}^1$\n\n我们已知具体的矩阵 $\\boldsymbol{A}$、初始数据 $\\boldsymbol{u}^0$ 和时间步长 $\\Delta t$：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 2  -1 \\\\ -2  3 \\end{pmatrix}, \\quad \\boldsymbol{u}^0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\Delta t = 2\n$$\n首先，我们将 $\\Delta t = 2$ 代入推导出的线性系统。系数 $\\frac{\\Delta t}{2}$ 变为 $\\frac{2}{2} = 1$。从 $n=0$ 推进到 $n=1$ 的系统是：\n$$\n(\\boldsymbol{I} + \\boldsymbol{A})\\boldsymbol{u}^1 = (\\boldsymbol{I} - \\boldsymbol{A})\\boldsymbol{u}^0\n$$\n我们来计算左侧（LHS）和右侧（RHS）的矩阵。\n左侧矩阵是 $\\boldsymbol{I} + \\boldsymbol{A}$：\n$$\n\\boldsymbol{I} + \\boldsymbol{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 2  -1 \\\\ -2  3 \\end{pmatrix} = \\begin{pmatrix} 3  -1 \\\\ -2  4 \\end{pmatrix}\n$$\n右侧矩阵是 $\\boldsymbol{I} - \\boldsymbol{A}$：\n$$\n\\boldsymbol{I} - \\boldsymbol{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 2  -1 \\\\ -2  3 \\end{pmatrix} = \\begin{pmatrix} 1-2  0-(-1) \\\\ 0-(-2)  1-3 \\end{pmatrix} = \\begin{pmatrix} -1  1 \\\\ 2  -2 \\end{pmatrix}\n$$\n现在，我们计算右侧的向量 $(\\boldsymbol{I} - \\boldsymbol{A})\\boldsymbol{u}^0$：\n$$\n(\\boldsymbol{I} - \\boldsymbol{A})\\boldsymbol{u}^0 = \\begin{pmatrix} -1  1 \\\\ 2  -2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-1)(1) + (1)(0) \\\\ (2)(1) + (-2)(0) \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n因此，求解 $\\boldsymbol{u}^1$ 的线性系统是：\n$$\n\\begin{pmatrix} 3  -1 \\\\ -2  4 \\end{pmatrix} \\boldsymbol{u}^1 = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n设 $\\boldsymbol{u}^1 = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$。这对应于以下线性方程组：\n1. $3u_1 - u_2 = -1$\n2. $-2u_1 + 4u_2 = 2$\n\n由方程（1），我们可以用 $u_1$ 表示 $u_2$：\n$$\nu_2 = 3u_1 + 1\n$$\n将此代入方程（2）：\n$$\n-2u_1 + 4(3u_1 + 1) = 2\n$$\n$$\n-2u_1 + 12u_1 + 4 = 2\n$$\n$$\n10u_1 = -2\n$$\n$$\nu_1 = -\\frac{2}{10} = -\\frac{1}{5}\n$$\n现在将 $u_1$ 的值代回以求得 $u_2$：\n$$\nu_2 = 3\\left(-\\frac{1}{5}\\right) + 1 = -\\frac{3}{5} + \\frac{5}{5} = \\frac{2}{5}\n$$\n因此，单步更新的解为：\n$$\n\\boldsymbol{u}^1 = \\begin{pmatrix} -1/5 \\\\ 2/5 \\end{pmatrix}\n$$\n\n### 第3部分：验证负分量\n\n题目要求验证 $\\boldsymbol{u}^1$ 的一个分量是负的，并报告其值。检查解向量 $\\boldsymbol{u}^1$：\n$$\n\\boldsymbol{u}^1 = \\begin{pmatrix} -1/5 \\\\ 2/5 \\end{pmatrix}\n$$\n第一个分量是 $u_1 = -\\frac{1}{5}$，为负值。第二个分量是 $u_2 = \\frac{2}{5}$，为正值。初始向量 $\\boldsymbol{u}^0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 是非负的。此计算表明，Crank-Nicolson格式即使应用于M-矩阵系统（其精确解保持非负性），在时间步长足够大的情况下，也不一定能保持非负性。\n\n负分量的值是 $-\\frac{1}{5}$。", "answer": "$$\n\\boxed{-\\frac{1}{5}}\n$$", "id": "3383089"}]}