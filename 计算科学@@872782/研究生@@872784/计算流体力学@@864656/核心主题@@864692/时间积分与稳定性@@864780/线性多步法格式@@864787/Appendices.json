{"hands_on_practices": [{"introduction": "本练习是线性多步法设计的基石。我们将推导一个方法的系数，以使其达到尽可能高的精度阶数。该过程基于匹配泰勒级数展开，以使方法对某一阶数以下的多项式精确成立，旨在磨练推导定制化数值格式的基本技能 [@problem_id:3340816]。", "problem": "考虑一个源于计算流体力学的守恒律的半离散格式，其空间离散化产生一个形式为 $y^{\\prime}(t) = f(t,y(t))$ 的自治常微分方程组，其中 $y(t) \\in \\mathbb{R}^{m}$。你希望使用一个 $k=3$ 步的线性多步法对解进行时间推进，该方法以后向索引形式写为\n$$\n\\sum_{j=0}^{3} \\alpha_{j}\\, y_{n-j} \\;=\\; h \\sum_{j=0}^{3} \\beta_{j}\\, f_{n-j},\n$$\n其中 $t_{n} = t_{0} + n h$，$y_{n} \\approx y(t_{n})$，$f_{n-j} = f(t_{n-j}, y_{n-j})$，且 $h0$ 为时间步长。给定一个候选的显式3步法，其系数为\n$$\n\\alpha = ( \\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\alpha_{3} ) = (1,\\,-1,\\,0,\\,0), \\qquad \\beta = ( \\beta_{0}, \\beta_{1}, \\beta_{2}, \\beta_{3} ) = (0,\\,\\beta_{1},\\,\\beta_{2},\\,\\beta_{3}).\n$$\n这里的“显式”指的是 $\\beta_{0} = 0$，因此右端项不依赖于新时间层的 $f_{n} = f(t_{n},y_{n})$。从局部截断误差的定义和关于 $t_{n}$ 的泰勒展开出发，确定 $\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 以使代数阶最大化，然后通过推导局部截断误差的主项来验证所达到的阶。请以精确有理数形式表示 $\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 的最终值。不需要四舍五入。最终答案必须是三元组 $(\\beta_{1}, \\beta_{2}, \\beta_{3})$。", "solution": "我们从自治常微分方程 $y^{\\prime}(t) = f(t,y(t))$ 和后向索引的线性多步法开始\n$$\n\\sum_{j=0}^{3} \\alpha_{j} y_{n-j} \\;=\\; h \\sum_{j=0}^{3} \\beta_{j} f_{n-j}.\n$$\n根据给定的系数 $\\alpha = (1,-1,0,0)$ 和 $\\beta = (0,\\beta_{1},\\beta_{2},\\beta_{3})$，该格式为\n$$\ny_{n} - y_{n-1} \\;=\\; h\\left(\\beta_{1} f_{n-1} + \\beta_{2} f_{n-2} + \\beta_{3} f_{n-3}\\right).\n$$\n为了最大化代数阶，我们将精确解代入，并在 $t_{n}$ 处进行泰勒级数展开，然后强制等式精确成立。设 $y(t)$ 足够光滑。使用关于 $t_{n}$ 的泰勒展开，\n$$\ny(t_{n-1}) = y(t_{n} - h) = y(t_{n}) - h y^{\\prime}(t_{n}) + \\frac{h^{2}}{2} y^{\\prime\\prime}(t_{n}) - \\frac{h^{3}}{6} y^{\\prime\\prime\\prime}(t_{n}) + \\frac{h^{4}}{24} y^{(4)}(t_{n}) - \\frac{h^{5}}{120} y^{(5)}(t_{n}) + \\cdots,\n$$\n因此\n$$\ny(t_n) - y(t_{n-1}) = h y^{\\prime}(t_{n}) - \\frac{h^{2}}{2} y^{\\prime\\prime}(t_{n}) + \\frac{h^{3}}{6} y^{\\prime\\prime\\prime}(t_{n}) - \\frac{h^{4}}{24} y^{(4)}(t_{n}) + \\frac{h^{5}}{120} y^{(5)}(t_{n}) + \\cdots.\n$$\n在右端，我们使用 $f_{n-j} = y^{\\prime}(t_{n-j})$ 并展开\n$$\ny^{\\prime}(t_{n-j}) = y^{\\prime}(t_{n}) - j h\\, y^{\\prime\\prime}(t_{n}) + \\frac{(j h)^{2}}{2} y^{\\prime\\prime\\prime}(t_{n}) - \\frac{(j h)^{3}}{6} y^{(4)}(t_{n}) + \\frac{(j h)^{4}}{24} y^{(5)}(t_{n}) + \\cdots.\n$$\n因此，\n$$\n\\begin{aligned}\nh \\sum_{j=1}^{3} \\beta_{j} y^{\\prime}(t_{n-j})\n= h\\Bigg[\\left(\\sum_{j=1}^{3} \\beta_{j}\\right) y^{\\prime}(t_{n})\n- h\\left(\\sum_{j=1}^{3} j \\beta_{j}\\right) y^{\\prime\\prime}(t_{n})\n+ \\frac{h^{2}}{2}\\left(\\sum_{j=1}^{3} j^{2} \\beta_{j}\\right) y^{\\prime\\prime\\prime}(t_{n}) \\\\\n\\qquad\\quad - \\frac{h^{3}}{6}\\left(\\sum_{j=1}^{3} j^{3} \\beta_{j}\\right) y^{(4)}(t_{n})\n+ \\frac{h^{4}}{24}\\left(\\sum_{j=1}^{3} j^{4} \\beta_{j}\\right) y^{(5)}(t_{n})\n+ \\cdots \\Bigg].\n\\end{aligned}\n$$\n为了达到代数阶 $p$，通过将左端项减去右端项得到的残差 $R_{n}$ 的第一个非零项必须是 $h^{p+1}$ 阶的。将 $h$ 的同次幂系数相等，直到可能达到的最高阶，得到阶条件：\n$$\n\\begin{aligned}\nh\\,y^{\\prime}:\\quad 1 = \\sum_{j=1}^{3} \\beta_{j}, \\\\\nh^{2}\\,y^{\\prime\\prime}:\\quad -\\frac{1}{2} = - \\sum_{j=1}^{3} j \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j \\beta_{j} = \\frac{1}{2}, \\\\\nh^{3}\\,y^{\\prime\\prime\\prime}:\\quad \\frac{1}{6} = \\frac{1}{2} \\sum_{j=1}^{3} j^{2} \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j^{2} \\beta_{j} = \\frac{1}{3}, \\\\\nh^{4}\\,y^{(4)}:\\quad -\\frac{1}{24} = -\\frac{1}{6} \\sum_{j=1}^{3} j^{3} \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j^{3} \\beta_{j} = \\frac{1}{4},\n\\end{aligned}\n$$\n依此类推。对于三个未知数 $\\beta_{1}, \\beta_{2}, \\beta_{3}$，我们至多可以满足前三个方程。将其明确写出，\n$$\n\\begin{cases}\n\\beta_{1} + \\beta_{2} + \\beta_{3} = 1, \\\\\n\\beta_{1} + 2 \\beta_{2} + 3 \\beta_{3} = \\frac{1}{2}, \\\\\n\\beta_{1} + 4 \\beta_{2} + 9 \\beta_{3} = \\frac{1}{3}.\n\\end{cases}\n$$\n第二个方程减去第一个方程，第三个方程减去第二个方程，得到\n$$\n\\begin{cases}\n\\beta_{2} + 2 \\beta_{3} = -\\frac{1}{2}, \\\\\n2 \\beta_{2} + 6 \\beta_{3} = -\\frac{1}{6}.\n\\end{cases}\n$$\n求解该方程组，从第一个方程我们得到 $\\beta_{2} = -\\frac{1}{2} - 2 \\beta_{3}$。代入第二个方程，\n$$\n2\\left(-\\frac{1}{2} - 2 \\beta_{3}\\right) + 6 \\beta_{3} = -\\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\n-1 - 4 \\beta_{3} + 6 \\beta_{3} = -\\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\n2 \\beta_{3} = \\frac{5}{6}\n\\;\\;\\Longrightarrow\\;\\;\n\\beta_{3} = \\frac{5}{12}.\n$$\n然后\n$$\n\\beta_{2} = -\\frac{1}{2} - 2\\cdot \\frac{5}{12} = -\\frac{1}{2} - \\frac{5}{6} = -\\frac{4}{3}\n$$\n最后\n$$\n\\beta_{1} = 1 - \\beta_{2} - \\beta_{3} = 1 - \\left(-\\frac{4}{3}\\right) - \\frac{5}{12} = \\frac{23}{12}.\n$$\n因此，使阶最大化的唯一选择是\n$$\n\\beta_{1} = \\frac{23}{12}, \\quad \\beta_{2} = -\\frac{4}{3}, \\quad \\beta_{3} = \\frac{5}{12}.\n$$\n为了验证所达到的阶，我们检查 $h^{4}$ 阶的下一个条件：\n$$\n\\sum_{j=1}^{3} j^{3} \\beta_{j} = 1^{3}\\cdot \\frac{23}{12} + 2^{3}\\cdot \\left(-\\frac{4}{3}\\right) + 3^{3}\\cdot \\frac{5}{12}\n= \\frac{23}{12} - \\frac{128}{12} + \\frac{135}{12} = \\frac{30}{12} = \\frac{5}{2} \\neq \\frac{1}{4}.\n$$\n因此 $h^{4}$ 阶的条件不被满足。$h^{4}$ 阶的局部截断误差残差是乘以 $y^{(4)}(t_{n})$ 的系数之差：\n$$\n\\left(-\\frac{1}{24}\\right) - \\left(-\\frac{1}{6}\\cdot \\frac{5}{2}\\right) = -\\frac{1}{24} + \\frac{5}{12} = \\frac{9}{24} = \\frac{3}{8}.\n$$\n因此，局部截断误差为\n$$\n\\tau_{n} = \\frac{3}{8}\\, h^{4}\\, y^{(4)}(t_{n}) + \\mathcal{O}(h^{5}),\n$$\n这证实了代数阶为 $p=3$。最后，零点稳定性成立，因为齐次差分方程 $y_{n} - y_{n-1} = 0$ 有一个单根 $1$ 和在 $0$ 处的附加根（在单位圆内），满足根条件，所以该方法使用计算出的系数确实达到了3阶。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{23}{12}  -\\frac{4}{3}  \\frac{5}{12}\\end{pmatrix}}$$", "id": "3340816"}, {"introduction": "本练习超越了简单的精度阶数，旨在研究双曲型问题的一个关键稳定性属性，这类问题在流体动力学中无处不在。我们将测试流行的 Adams-Bashforth 方法是否能保持解的单调性，这一性质对于防止非物理振荡至关重要 [@problem_id:3340818]。该练习表明，并非所有高精度方法都适用于激波捕捉或对流主导问题，从而揭示了经典线性多步法的一个关键局限性。", "problem": "考虑守恒形式的一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，定义在间距为 $\\Delta x$ 的均匀网格上，并采用周期性边界条件。使用带有一次迎风数值通量的守恒有限体积法对空间进行离散。这将得到半离散系统\n$$\n\\frac{d u_{i}}{d t} = -\\frac{a}{\\Delta x}\\left(u_{i} - u_{i-1}\\right), \n$$\n对所有单元指标 $i$ 成立。将半离散算子记为 $f(u) = \\mathcal{L} u$，其中 $(\\mathcal{L} u)_{i} = -\\frac{a}{\\Delta x}\\left(u_{i} - u_{i-1}\\right)$。\n\n使用两步 Adams–Bashforth (AB2) 方法对半离散系统进行时间推进，\n$$\nu^{n+1} = u^{n} + \\Delta t\\left(\\frac{3}{2} f\\!\\left(u^{n}\\right) - \\frac{1}{2} f\\!\\left(u^{n-1}\\right)\\right),\n$$\n并定义 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$。令离散全变分为 $TV(u^{n}) = \\sum_{i} \\left|u_{i}^{n} - u_{i-1}^{n}\\right|$。如果对于所有整数 $n$ 和所有网格函数 $u^{n}$，都有 $TV(u^{n+1}) \\le TV(u^{n})$ 成立，那么一个全离散方法被称为全变分递减 (TVD) 的。\n\n从守恒律、守恒迎风通量和 AB2 更新公式出发，推导以 $u_{i}^{n}$、$u_{i-1}^{n}$、$u_{i}^{n-1}$ 和 $u_{i-1}^{n-1}$ 表示的单元层级的全离散 AB2 更新。利用 TVD 的定义以及对于线性标量守恒律的 TVD 格式可以写成适当相邻值的非负系数的凸组合这一要求，评估对于此半离散化，AB2 方法是否对任何正数 $\\nu$ 都是 TVD 的。找出最大的无量纲 CFL 数 $\\nu_{\\max}$，使得在给定的半离散化下，AB2 方法对于所有初始数据都保证能避免过冲（即是 TVD 的）。以单个实数的形式给出 $\\nu_{\\max}$。", "solution": "该问题要求分析一个用于一维线性平流方程的全离散格式的全变分递减 (TVD) 特性。该格式结合了一阶迎风有限体积空间离散和两步 Adams-Bashforth (AB2) 时间积分方法。\n\n首先，我们推导单元层级的全离散更新公式。问题给出了半离散系统：\n$$\n\\frac{d u_{i}}{d t} = f(u)_i = -\\frac{a}{\\Delta x}\\left(u_{i} - u_{i-1}\\right)\n$$\n其中 $a  0$ 是恒定的平流速度。时间积分使用两步 Adams-Bashforth (AB2) 方法进行：\n$$\nu^{n+1} = u^{n} + \\Delta t\\left(\\frac{3}{2} f(u^{n}) - \\frac{1}{2} f(u^{n-1})\\right)\n$$\n将半离散算子 $f(u)$ 在时间层 $n$ 和 $n-1$ 时对于一个通用单元 $i$ 的表达式代入，我们得到：\n$$\nu_{i}^{n+1} = u_{i}^{n} + \\Delta t\\left(\\frac{3}{2} \\left[-\\frac{a}{\\Delta x}\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\\right] - \\frac{1}{2} \\left[-\\frac{a}{\\Delta x}\\left(u_{i}^{n-1} - u_{i-1}^{n-1}\\right)\\right]\\right)\n$$\n通过引入 Courant-Friedrichs-Lewy (CFL) 数 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$，我们可以将表达式简化为：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu \\left(\\frac{3}{2}\\left(u_{i}^{n} - u_{i-1}^{n}\\right) - \\frac{1}{2}\\left(u_{i}^{n-1} - u_{i-1}^{n-1}\\right)\\right)\n$$\n这是全离散更新方程。为了分析其性质，我们可以根据其所依赖的网格值展开并合并各项：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{3}{2}\\nu u_{i}^{n} + \\frac{3}{2}\\nu u_{i-1}^{n} + \\frac{1}{2}\\nu u_{i}^{n-1} - \\frac{1}{2}\\nu u_{i-1}^{n-1}\n$$\n重新整理此式，可以得到其对相邻点和先前时间步的值的显式依赖关系：\n$$\nu_{i}^{n+1} = \\left(1 - \\frac{3}{2}\\nu\\right)u_{i}^{n} + \\left(\\frac{3}{2}\\nu\\right)u_{i-1}^{n} + \\left(\\frac{1}{2}\\nu\\right)u_{i}^{n-1} - \\left(\\frac{1}{2}\\nu\\right)u_{i-1}^{n-1}\n$$\n问题要求评估此格式是否可以是 TVD 的。对于线性格式，TVD 特性等价于该格式是保单调的。一个保单调的格式不会产生新的局部极值（过冲或下冲）。如果初始数据是单调的（非增或非减），则下一个时间步的解也将是单调的。\n\n一个一般的线性数值格式表示为来自先前时间步的值的线性组合，例如 $u_{i}^{n+1} = \\sum_{k,j} c_{k,j} u_{i-j}^{n-k}$。要使这样的格式是保单调的，所有系数 $c_{k,j}$ 都必须是非负的。这与问题中关于格式可以写成“具有非负系数的凸组合”的提示直接相关。虽然凸组合部分（$\\sum \\text{系数}=1$）是特定形式的要求，但系数的非负性是保单调性的一个普遍要求。\n\n让我们检查我们推导的 $u_{i}^{n+1}$ 格式中的系数：\n\\begin{itemize}\n    \\item $u_{i}^{n}$ 的系数： $\\left(1 - \\frac{3}{2}\\nu\\right)$\n    \\item $u_{i-1}^{n}$ 的系数： $\\left(\\frac{3}{2}\\nu\\right)$\n    \\item $u_{i}^{n-1}$ 的系数： $\\left(\\frac{1}{2}\\nu\\right)$\n    \\item $u_{i-1}^{n-1}$ 的系数： $\\left(-\\frac{1}{2}\\nu\\right)$\n\\end{itemize}\n该格式要成为保单调的，条件是所有这些系数都必须是非负的。让我们分析 $u_{i-1}^{n-1}$ 的系数，即 $-\\frac{1}{2}\\nu$。问题陈述了 $a  0$，并且对于任何有意义的时间演化，我们都有 $\\Delta t  0$ 和 $\\Delta x  0$。因此，CFL 数 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ 必须为正。\n对于任何 $\\nu  0$，系数 $-\\frac{1}{2}\\nu$ 都是严格为负的。\n\n因为对于任何正数 $\\nu$，至少有一个系数是负的，所以该格式不是保单调的。一个不保单调的格式不可能是 TVD 的。这是线性多步法的一个众所周知的结果：对于双曲守恒律，它们不能成为 TVD 的。负系数表明该格式可能会引入振荡或过冲。例如，在保持其他值不变的情况下增加 $u_{i-1}^{n-1}$ 的值，将会减少 $u_{i}^{n+1}$ 的值，这与单调性是相悖的。\n\n这可以用一个反例来证明。假设时间 $n$ 的解是常数，$u_{i}^{n} = C$ 对所有 $i$ 成立，所以其全变分为 $TV(u^n) = 0$。假设时间 $n-1$ 的解是一个阶跃函数，例如，当 $i  k$ 时 $u_{i}^{n-1} = 0$，当 $i \\geq k$ 时 $u_{i}^{n-1} = 1$。使用这些数据，更新方程变为 $u_{i}^{n+1} = C + \\frac{\\nu}{2}(u_i^{n-1} - u_{i-1}^{n-1})$。$u^{n+1}$ 的廓形将处处为 $C$，除了在 $i=k$ 处，$u_{k}^{n+1} = C + \\frac{\\nu}{2}$。全变分为 $TV(u^{n+1}) = |(C+\\frac{\\nu}{2}) - C| + |C - (C+\\frac{\\nu}{2})| = \\nu$。TVD 条件 $TV(u^{n+1}) \\le TV(u^{n})$ 变为 $\\nu \\le 0$，这与 $\\nu  0$ 相矛盾。\n\n因此，对于任何正的 CFL 数 $\\nu$，该格式都不是 TVD 的。问题要求的是使得该方法对所有初始数据都*保证*是 TVD 的最大无量纲 CFL 数 $\\nu_{\\max}$。由于该格式对任何 $\\nu  0$ 都不是 TVD 的，所以这样的正 $\\nu$ 值集合为空。TVD 特性仅在 $\\nu=0$ 的平凡情况下成立，此时更新方程变为 $u_i^{n+1}=u_i^n$，对此有 $TV(u^{n+1})=TV(u^n)$。因此，满足该条件的最大值为 $\\nu_{\\max}=0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3340818"}, {"introduction": "在真实世界的模拟中，解的动态特性是变化的，使用固定步长效率低下。本练习将演示如何构建一个自适应积分器，通过调整其步长来维持目标精度，这是现代计算求解器的基石之一 [@problem_id:3340831]。我们将探讨如何利用“嵌入式”方法对来估计局部误差，并将其应用于一个控制律，以智能地平衡计算成本与精度。", "problem": "考虑计算流体力学中一个对流-扩散偏微分方程的线方法半离散化，得到一个形式为 $\\mathbf{y}'(t)=\\mathbf{f}(t,\\mathbf{y})$ 的常微分方程组，其中 $\\mathbf{y}(t)\\in\\mathbb{R}^{m}$ 且 $\\mathbf{f}:\\mathbb{R}\\times\\mathbb{R}^{m}\\rightarrow\\mathbb{R}^{m}$ 是充分光滑的。您需要寻找一种带有嵌入对的 Adams–Bashforth (AB) 类型的显式线性多步法 (LMM)，用于自适应步长控制。\n\n从精确积分关系式 $\\,\\mathbf{y}(t_{n+1})=\\mathbf{y}(t_n)+\\displaystyle\\int_{t_n}^{t_{n+1}}\\mathbf{f}(t,\\mathbf{y}(t))\\,\\mathrm{d}t\\,$ 出发，并通过 $k$ 个等距节点 $t_n,t_{n-1},\\dots,t_{n-k+1}$ 的 $k-1$ 次 Lagrange 插值多项式来近似 $\\mathbf{f}(t,\\mathbf{y}(t))$，构造 $k$ 步 Adams–Bashforth 公式，并将其特化到 $k=4$ 的情况，以获得 $\\text{AB}4$ 方法的系数。类似地，构造使用相同函数求值并在 $t_{n+1}$ 处产生一个低阶更新的嵌入式 $\\text{AB}3$ 公式。\n\n将嵌入对的输出定义为 $\\mathbf{y}_{n+1}^{[4]}$ 和 $\\mathbf{y}_{n+1}^{[3]}$，并使用它们的差来构造高阶方法局部截断误差的渐近一致估计量。为此，假设实现中将 $\\|\\mathbf{y}_{n+1}^{[4]}-\\mathbf{y}_{n+1}^{[3]}\\|$ 乘以一个已知的校准因子，使得对于 $\\text{AB}4$ 方法，得到的标量 $\\text{err}$ 表现为 $C\\,h^{p+1}$（其中 $p=4$）。\n\n从第一性原理出发，推导一个步长控制器，该控制器选择的 $h_{\\text{new}}$ 能使下一步的预测局部截断误差与用户指定的容差 $\\text{tol}$ 相匹配，并通过裁剪（clipping）将乘法安全因子 $s$ 和增长下限/上限限制器 $\\alpha_{\\min}$、$\\alpha_{\\max}$ 整合到您的控制器中。\n\n最后，根据以下数值数据评估您的控制器：\n- $\\text{AB}4/\\text{AB}3$ 嵌入对，其中 $p=4$，\n- 当前步长 $h=1.0\\times 10^{-3}$，\n- 容差 $\\text{tol}=1.0\\times 10^{-6}$，\n- 校准后的误差估计 $\\text{err}=3.0\\times 10^{-7}$，\n- 安全因子 $s=0.9$，\n- 增长下限和上限限制器 $\\alpha_{\\min}=0.5$ 和 $\\alpha_{\\max}=1.5$。\n\n以标准科学记数法报告 $h_{\\text{new}}$ 的数值。将您的答案四舍五入到四位有效数字。", "solution": "用户要求推导 Adams-Bashforth 线性多步法 (LMM)，构建相关的自适应步长控制器，并针对一组特定的数值数据评估该控制器。\n\n问题始于常微分方程 (ODE) 组 $\\mathbf{y}'(t) = \\mathbf{f}(t, \\mathbf{y})$ 在单个时间步长 $t_n$ 到 $t_{n+1}$ 上的解的精确积分表示：\n$$\n\\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{f}(t, \\mathbf{y}(t)) \\, \\mathrm{d}t\n$$\n通过用一个多项式 $P(t)$ 来近似被积函数 $\\mathbf{f}(t, \\mathbf{y}(t))$，可以推导出 Adams-Bashforth (AB) 类型的显式 LMM。该多项式对先前计算的 $k$ 个函数值 $\\{ (t_n, \\mathbf{f}_n), (t_{n-1}, \\mathbf{f}_{n-1}), \\dots, (t_{n-k+1}, \\mathbf{f}_{n-k+1}) \\}$ 进行插值，其中 $\\mathbf{f}_j \\equiv \\mathbf{f}(t_j, \\mathbf{y}_j)$。得到的数值公式为：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\int_{t_n}^{t_{n+1}} P(t) \\, \\mathrm{d}t\n$$\n为了方便积分，我们引入一个无量纲时间变量 $s = (t - t_n) / h$，其中 $h$ 是恒定的步长。由此可得 $\\mathrm{d}t = h \\, \\mathrm{d}s$。积分区间 $[t_n, t_{n+1}]$ 在变量 $s$ 中变换为 $[0, 1]$。插值节点 $t_{n-j}$ 对应于 $s = -j$，其中 $j = 0, 1, \\dots, k-1$。\n\n次数为 $(k-1)$ 的 Lagrange 插值多项式由下式给出 $P(t_n+sh) = \\sum_{j=0}^{k-1} L_j(s) \\mathbf{f}_{n-j}$，其中 $L_j(s)$ 是 Lagrange 基多项式：\n$$\nL_j(s) = \\prod_{i=0, i \\neq j}^{k-1} \\frac{s - (-i)}{(-j) - (-i)}\n$$\n将其代入积分并执行积分，得到通用的 $k$ 步 AB 公式：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\sum_{j=0}^{k-1} b_j \\mathbf{f}_{n-j}, \\quad \\text{其中} \\quad b_j = \\int_0^1 L_j(s) \\, \\mathrm{d}s\n$$\n对于 $4$ 步 Adams-Bashforth 方法（AB4, $k=4$），插值多项式的次数为 $3$，使用对应于 $s=0, -1, -2, -3$ 的点。系数 $b_j$ 的计算如下：\n$b_0 = \\int_0^1 \\frac{(s+1)(s+2)(s+3)}{(1)(2)(3)} \\, \\mathrm{d}s = \\frac{55}{24}$\n$b_1 = \\int_0^1 \\frac{s(s+2)(s+3)}{(-1)(1)(2)} \\, \\mathrm{d}s = -\\frac{59}{24}$\n$b_2 = \\int_0^1 \\frac{s(s+1)(s+3)}{(-2)(-1)(1)} \\, \\mathrm{d}s = \\frac{37}{24}$\n$b_3 = \\int_0^1 \\frac{s(s+1)(s+2)}{(-3)(-2)(-1)} \\, \\mathrm{d}s = -\\frac{9}{24}$\n这就得到了 AB4 公式，记为 $\\mathbf{y}_{n+1}^{[4]}$，其阶为 $p=4$：\n$$\n\\mathbf{y}_{n+1}^{[4]} = \\mathbf{y}_n + \\frac{h}{24} \\left( 55\\mathbf{f}_n - 59\\mathbf{f}_{n-1} + 37\\mathbf{f}_{n-2} - 9\\mathbf{f}_{n-3} \\right)\n$$\n对于嵌入的 $3$ 步方法（AB3, $k=3$），我们使用一个次数为 $2$ 的多项式，对对应于 $s=0, -1, -2$ 的点进行插值。该方法的阶为 $p=3$。该公式记为 $\\mathbf{y}_{n+1}^{[3]}$，为：\n$$\n\\mathbf{y}_{n+1}^{[3]} = \\mathbf{y}_n + \\frac{h}{12} \\left( 23\\mathbf{f}_n - 16\\mathbf{f}_{n-1} + 5\\mathbf{f}_{n-2} \\right)\n$$\n问题要求推导一个步长控制器。一个 $p$ 阶方法的局部截断误差 (LTE) 与 $h^{p+1}$ 成正比。问题指出，对于高阶方法（AB4，其中 $p=4$），存在一个校准后的误差估计值 $\\text{err}$。该估计值按以下关系进行缩放：\n$$\n\\text{err} \\approx C h^{p+1} = C h^5\n$$\n其中 $C$ 是一个与解的高阶导数相关的常数。我们的目标是确定一个新的步长 $h_{\\text{new}}$，使得下一步的估计误差 $\\text{err}_{\\text{new}}$ 与用户定义的容差 $\\text{tol}$ 相匹配。\n假设对于新的步长，同样的渐近关系成立，我们可以写出：\n$$\n\\text{tol} \\approx \\text{err}_{\\text{new}} \\approx C h_{\\text{new}}^{p+1} = C h_{\\text{new}}^5\n$$\n通过将容差方程与当前误差方程相除，未知的常数 $C$ 被消去：\n$$\n\\frac{\\text{tol}}{\\text{err}} \\approx \\frac{C h_{\\text{new}}^5}{C h^5} = \\left( \\frac{h_{\\text{new}}}{h} \\right)^5\n$$\n求解 $h_{\\text{new}}$ 得到理想步长：\n$$\nh_{\\text{new}} = h \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/5} = h \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)}\n$$\n在实践中，会对此估计值应用一个安全因子 $s  1$ 来产生一个更保守（更小）的步长，以减少步骤失败的可能性。步长的建议变化因子 $\\alpha_{\\text{prop}}$ 为：\n$$\n\\alpha_{\\text{prop}} = s \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)}\n$$\n为了防止步长的剧烈变化，该因子被裁剪在一个范围 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 内。最终的因子 $\\alpha$ 由下式确定：\n$$\n\\alpha = \\max(\\alpha_{\\min}, \\min(\\alpha_{\\max}, \\alpha_{\\text{prop}}))\n$$\n然后，新的步长计算为 $h_{\\text{new}} = \\alpha \\cdot h$。\n\n现在，我们使用提供的数值数据来评估这个控制器：\n- 方法类型：AB4/AB3，其中高阶为 $p=4$。\n- 当前步长：$h = 1.0 \\times 10^{-3}$。\n- 期望容差：$\\text{tol} = 1.0 \\times 10^{-6}$。\n- 校准后的误差估计：$\\text{err} = 3.0 \\times 10^{-7}$。\n- 安全因子：$s = 0.9$。\n- 增长下限限制器：$\\alpha_{\\min} = 0.5$。\n- 增长上限限制器：$\\alpha_{\\max} = 1.5$。\n\n首先，我们计算建议的步长变化因子 $\\alpha_{\\text{prop}}$：\n$$\n\\alpha_{\\text{prop}} = s \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)} = 0.9 \\left( \\frac{1.0 \\times 10^{-6}}{3.0 \\times 10^{-7}} \\right)^{1/(4+1)} = 0.9 \\left( \\frac{10}{3} \\right)^{1/5}\n$$\n对该表达式进行数值计算：\n$$\n\\alpha_{\\text{prop}} \\approx 0.9 \\times (3.333\\dots)^{0.2} \\approx 0.9 \\times 1.2723651 \\approx 1.1451286\n$$\n接下来，我们应用裁剪限制：\n$$\n\\alpha = \\max(0.5, \\min(1.5, 1.1451286))\n$$\n由于 $0.5  1.1451286  1.5$，$\\alpha_{\\text{prop}}$ 的值在允许范围内，所以 $\\alpha \\approx 1.1451286$。\n\n最后，我们计算新的步长 $h_{\\text{new}}$：\n$$\nh_{\\text{new}} = \\alpha \\cdot h \\approx 1.1451286 \\times (1.0 \\times 10^{-3}) \\approx 1.1451286 \\times 10^{-3}\n$$\n根据要求将结果四舍五入到四位有效数字，得到：\n$$\nh_{\\text{new}} \\approx 1.145 \\times 10^{-3}\n$$", "answer": "$$\n\\boxed{1.145 \\times 10^{-3}}\n$$", "id": "3340831"}]}