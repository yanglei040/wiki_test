{"hands_on_practices": [{"introduction": "本练习将作为起点。我们将采用一个特定的坐标变换，并逐步完成度量张量和尺度因子的基本计算，以理解简单的计算网格如何映射到复杂的物理形状。通过这个过程，你将学会如何量化局部网格属性，例如正交性和单元长宽比，这是评估和生成高质量网格的基础。[@problem_id:3327571]", "problem": "在计算流体动力学（CFD）中，复杂几何形状的曲线网格生成通常采用从计算域到物理域的映射。考虑一个从计算坐标 $(\\xi,\\eta)$ 到笛卡尔物理坐标 $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$ 的二维映射，由下式给出\n$$\n\\mathbf{x}(\\xi,\\eta) = \\big(r(\\xi)\\cos\\eta,\\; r(\\xi)\\sin\\eta\\big), \\quad r(\\xi) = 1 + \\beta\\,\\xi,\n$$\n其中 $\\beta0$，$\\xi\\in[0,1]$，$\\eta\\in[0,2\\pi)$ 以弧度为单位。仅使用CFD中曲线坐标微分几何的基本定义（协变基向量、度量张量、正交性判据和尺度因子），执行以下操作：\n\n- 从协变基向量的定义 $\\mathbf{x}_{\\xi}=\\partial\\mathbf{x}/\\partial\\xi$ 和 $\\mathbf{x}_{\\eta}=\\partial\\mathbf{x}/\\partial\\eta$ 出发，推导协变度量张量分量 $g_{ij}=\\mathbf{x}_{i}\\cdot\\mathbf{x}_{j}$（其中 $i,j\\in\\{\\xi,\\eta\\}$），用 $\\beta$、$\\xi$ 和 $\\eta$ 表示。\n- 使用曲线坐标中的正交性定义，判断坐标线是否正交，并解释参数 $\\beta$ 如何影响正交性。\n- 将局部单元纵横比 $A(\\xi,\\eta)$ 定义为尺度因子之比 $h_{\\eta}/h_{\\xi}$，其中 $h_{i}=\\sqrt{g_{ii}}$（$i\\in\\{\\xi,\\eta\\}$）。推导 $A(\\xi,\\eta)$（用 $\\beta$ 和 $\\xi$ 表示），并解释 $\\beta$ 的变化如何改变整个网格上的纵横比分布。\n\n最终答案仅报告纵横比 $A(\\xi)$ 关于 $\\beta$ 和 $\\xi$ 的闭式解析表达式。不需要进行数值计算，也不适用四舍五入。最终答案中不要包含单位。", "solution": "该问题被验证为具有科学依据、提法恰当、客观且完整。所有必要信息均已提供，任务在应用于计算流体动力学的微分几何标准框架内定义明确。解题过程如下。\n\n问题提供了一个从计算坐标 $(\\xi, \\eta)$ 到物理笛卡尔坐标 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta))$ 的二维映射。该映射由下式给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\big(r(\\xi)\\cos\\eta, r(\\xi)\\sin\\eta\\big)\n$$\n其中 $r(\\xi) = 1 + \\beta\\xi$，约束条件为 $\\beta  0$，$\\xi \\in [0, 1]$，以及 $\\eta \\in [0, 2\\pi)$。\n\n首先，我们推导协变度量张量分量 $g_{ij}$。这需要计算协变基向量 $\\mathbf{x}_{\\xi}$ 和 $\\mathbf{x}_{\\eta}$，它们是位置向量 $\\mathbf{x}$ 关于计算坐标的偏导数。\n\n位置向量为 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta)) = \\big((1+\\beta\\xi)\\cos\\eta, (1+\\beta\\xi)\\sin\\eta\\big)$。\n\n关于 $\\xi$ 的偏导数为：\n$$\n\\mathbf{x}_{\\xi} = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\left( \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\xi} = (\\beta\\cos\\eta, \\beta\\sin\\eta)\n$$\n\n关于 $\\eta$ 的偏导数为：\n$$\n\\mathbf{x}_{\\eta} = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\left( \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta, (1+\\beta\\xi)\\cos\\eta\\big)\n$$\n\n接下来，我们计算协变度量张量的分量 $g_{ij} = \\mathbf{x}_{i} \\cdot \\mathbf{x}_{j}$，其中 $i, j \\in \\{\\xi, \\eta\\}$。\n\n分量 $g_{\\xi\\xi}$ 为：\n$$\ng_{\\xi\\xi} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\xi} = (\\beta\\cos\\eta)^2 + (\\beta\\sin\\eta)^2 = \\beta^2\\cos^2\\eta + \\beta^2\\sin^2\\eta = \\beta^2(\\cos^2\\eta + \\sin^2\\eta) = \\beta^2\n$$\n\n分量 $g_{\\eta\\eta}$ 为：\n$$\ng_{\\eta\\eta} = \\mathbf{x}_{\\eta} \\cdot \\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta\\big)^2 + \\big((1+\\beta\\xi)\\cos\\eta\\big)^2 = (1+\\beta\\xi)^2\\sin^2\\eta + (1+\\beta\\xi)^2\\cos^2\\eta\n$$\n$$\ng_{\\eta\\eta} = (1+\\beta\\xi)^2(\\sin^2\\eta + \\cos^2\\eta) = (1+\\beta\\xi)^2\n$$\n\n非对角分量 $g_{\\xi\\eta}$ 为：\n$$\ng_{\\xi\\eta} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\eta} = (\\beta\\cos\\eta)\\big(-(1+\\beta\\xi)\\sin\\eta\\big) + (\\beta\\sin\\eta)\\big((1+\\beta\\xi)\\cos\\eta\\big)\n$$\n$$\ng_{\\xi\\eta} = -\\beta(1+\\beta\\xi)\\cos\\eta\\sin\\eta + \\beta(1+\\beta\\xi)\\sin\\eta\\cos\\eta = 0\n$$\n由于度量张量是对称的，因此 $g_{\\eta\\xi} = g_{\\xi\\eta} = 0$。\n\n因此，协变度量张量的分量为：\n$$\ng_{\\xi\\xi} = \\beta^2, \\quad g_{\\eta\\eta} = (1+\\beta\\xi)^2, \\quad g_{\\xi\\eta} = g_{\\eta\\xi} = 0\n$$\n\n第二个任务是判断坐标线是否正交。当且仅当度量张量的非对角分量为零时，曲线坐标系是正交的。在本例中，我们发现对于各自定义域中的所有 $\\xi$ 和 $\\eta$ 值，$g_{\\xi\\eta} = g_{\\eta\\xi} = 0$。这意味着基向量 $\\mathbf{x}_{\\xi}$ 和 $\\mathbf{x}_{\\eta}$ 在每一点都是正交的。因此，坐标线（等 $\\xi$ 线和等 $\\eta$ 线）在整个网格中都是正交的。参数 $\\beta$ 是一个正常数，它影响 $\\mathbf{x}_{\\xi}$ 的大小，但不改变 $g_{\\xi\\eta}=0$ 这一事实。因此，对于任何 $\\beta  0$，坐标系都是正交的，$\\beta$ 对正交性本身没有影响。从几何上看，等 $\\xi$ 线是圆，等 $\\eta$ 线是径向线，它们总是相互正交的。\n\n第三个任务是推导局部单元纵横比，定义为 $A(\\xi, \\eta) = h_{\\eta}/h_{\\xi}$。尺度因子（或Lamé系数）$h_i$ 定义为 $h_i = \\sqrt{g_{ii}}$。\n\n尺度因子 $h_{\\xi}$ 为：\n$$\nh_{\\xi} = \\sqrt{g_{\\xi\\xi}} = \\sqrt{\\beta^2} = |\\beta|\n$$\n已知 $\\beta  0$，我们有 $h_{\\xi} = \\beta$。\n\n尺度因子 $h_{\\eta}$ 为：\n$$\nh_{\\eta} = \\sqrt{g_{\\eta\\eta}} = \\sqrt{(1+\\beta\\xi)^2} = |1+\\beta\\xi|\n$$\n已知 $\\beta  0$ 且 $\\xi \\in [0, 1]$，项 $1+\\beta\\xi$ 恒为正，所以 $|1+\\beta\\xi| = 1+\\beta\\xi$。因此，$h_{\\eta} = 1+\\beta\\xi$。\n\n现在，我们可以计算纵横比 $A(\\xi, \\eta)$：\n$$\nA(\\xi, \\eta) = \\frac{h_{\\eta}}{h_{\\xi}} = \\frac{1+\\beta\\xi}{\\beta}\n$$\n纵横比的表达式仅依赖于 $\\xi$ 和 $\\beta$，而与 $\\eta$ 无关。因此，我们可以将其写作 $A(\\xi)$。\n$$\nA(\\xi) = \\frac{1+\\beta\\xi}{\\beta} = \\frac{1}{\\beta} + \\xi\n$$\n为了解释 $\\beta$ 的影响，我们研究这个表达式。纵横比 $A(\\xi)$ 表示 $\\eta$ 方向（方位角方向）的局部弧长与 $\\xi$ 方向（径向）的局部长度之比。\n- 对于固定的 $\\beta$，$A(\\xi)$ 随 $\\xi$ 线性增加。在内边界（$\\xi=0$），$A(0) = 1/\\beta$。在外边界（$\\xi=1$），$A(1) = (1+\\beta)/\\beta = 1/\\beta + 1$。这表明，随着径向向外移动，网格单元在方位角方向上逐渐被拉伸。\n- 对于一个小的 $\\beta  0$，$1/\\beta$ 的值很大。这导致在整个域上都有很大的纵横比，意味着单元在 $\\eta$ 方向上被高度拉长。这对应于一个狭窄的环形区域，其中径向网格间距（与 $\\beta$ 成正比）远小于方位角间距（与 $r(\\xi)=1+\\beta\\xi \\approx 1$ 成正比）。\n- 对于一个大的 $\\beta$，$1/\\beta$ 的值很小。纵横比在 $\\xi=0$ 时接近于零（$A(0) = 1/\\beta \\to 0$），并随着 $\\xi$ 的增加而接近 1。这意味着靠近内边界的单元在径向方向上被拉伸，而越靠近外边界则变得越各向同性（更接近正方形）。大的 $\\beta$ 对应于一个具有显著径向拉伸的宽环形区域。\n\n最后要求的是纵横比 $A(\\xi)$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1 + \\beta \\xi}{\\beta}}$$", "id": "3327571"}, {"introduction": "在掌握了网格几何分析的基础上，我们来探讨一个关键问题：网格缺陷如何影响数值模拟的精度？本练习将通过分析扩散方程，向你展示网格倾斜是如何在变换后的方程中引入非物理的交叉导数项的。通过分析数值放大因子，你将定量地测量非正交性对解的直接影响，从而深刻理解网格质量的重要性。[@problem_id:3327534]", "problem": "考虑一个标量场 $u(x,y,t)$ 在二维（$2$-D）空间中的扩散，该过程由从第一性原理出发的标准扩散方程控制，即 $u$ 的变化率与其梯度的散度成正比：$\\partial u / \\partial t = \\nu \\nabla^{2} u$，其中 $\\nu$ 是扩散系数。在计算流体力学 (CFD) 中，要在复杂几何上求解此方程，通常需要从物理坐标 $(x,y)$ 变换到计算坐标 $(\\xi,\\eta)$，这会引入度量项，并且对于非正交网格，还会引入交叉导数贡献。从多变量函数的链式法则以及梯度和拉普拉斯算子的定义出发，推导在 $(\\xi,\\eta)$ 坐标系中变换后的扩散算子的一般形式，该形式应包含协变和逆变度量张量以及雅可比行列式。然后，将其特化为一个模拟非正交性的倾斜仿射映射：$x(\\xi,\\eta) = \\xi + \\alpha \\eta$ 和 $y(\\xi,\\eta) = \\eta$，其中 $\\alpha$ 是一个无量纲倾斜参数。通过此特化，识别出由非正交性引入的交叉导数贡献及其系数。\n\n接下来，设计一个简单的数值扩散测试，使用间距为 $h$（单位为米）的均匀计算网格、中心差分近似，以及时间步长为 $\\Delta t$（单位为秒）的显式前向欧拉法的单个时间步。假设计算网格上存在一个傅里叶模态，其波数为 $k_{\\xi}$ 和 $k_{\\eta}$（角度必须以弧度为单位）。使用经过充分检验的中心差分-离散傅里叶分析，沿 $\\xi$、$\\eta$ 的离散二阶导数算子以及混合导数 $\\xi\\eta$ 算子各自具有已知的傅里叶模态特征值，这些特征值依赖于 $k_{\\xi}$、$k_{\\eta}$ 和 $h$。利用这些特征值，计算在正交网格（基准情况，$\\alpha = 0$）和倾斜网格（非正交情况，$\\alpha \\neq 0$）上，一个前向欧拉步的离散放大因子。定义相对放大误差比 $R$ 为由非正交性引起的数值阻尼变化量，并用基准阻尼进行归一化：\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1},\n$$\n其中 $G_{0}$ 是正交网格的放大因子，$G_{\\alpha}$ 是非正交网格的放大因子。\n\n你的程序必须实现此分析，并为以下测试套件生成 $R$ 的数值。每个参数集是一个元组 $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t)$，其中 $h$ 的单位是米，$\\nu$ 的单位是 $\\mathrm{m}^{2}/\\mathrm{s}$，角度 $k_{\\xi}$ 和 $k_{\\eta}$ 的单位是弧度：\n- 测试 $1$ (基准正交情况): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.0,\\pi/3,\\pi/3,1.0,0.1,0.05)$。\n- 测试 $2$ (轻度倾斜，相同模态): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.2,\\pi/3,\\pi/3,1.0,0.1,0.05)$。\n- 测试 $3$ (中度倾斜，不同模态): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.5,\\pi/6,\\pi/3,1.0,0.1,0.05)$。\n- 测试 $4$ (强倾斜，高波数): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.9,\\pi/2,\\pi/2,1.0,0.05,0.02)$。\n- 测试 $5$ (一个方向恒定的倾斜，边界情况): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.7,\\pi/3,0.0,1.0,0.1,0.05)$。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中每个 $r_{i}$ 是对应测试用例计算出的 $R$ 的浮点数值。角度必须按弧度处理，所有中间量必须根据指定的物理单位进行一致计算。根据构造，输出的浮点数是无量纲的。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于连续介质力学、张量微积分和数值分析的原理。其设定是自洽、一致且适定的，为推导唯一解提供了所有必要信息。\n\n求解过程分三个阶段进行：\n$1$. 推导变换后的一般扩散算子。\n$2$. 将算子特化为给定的倾斜仿射坐标变换。\n$3$. 对离散化方程进行数值分析，以推导相对放大误差比 $R$。\n\n**$1$. 扩散算子的变换**\n\n起点是物理笛卡尔坐标 $(x,y)$ 中的二维扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u = \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n我们考虑向一般计算坐标系 $(\\xi^1, \\xi^2) \\equiv (\\xi, \\eta)$ 的变换。该关系由 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$ 给出。偏导数的链式法则给出：\n$$\n\\frac{\\partial}{\\partial \\xi^i} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial}{\\partial x^k}\n$$\n其中隐含了对重复索引 $k \\in \\{1,2\\}$ 的求和，并且 $(x^1, x^2) \\equiv (x,y)$。这关联了两个坐标系中的梯度算子。\n\n张量微积分的一个标准结果表明，拉普拉斯算子 $\\nabla^2$ 的变换形式为：\n$$\n\\nabla^2 u = \\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} \\left( J g^{ij} \\frac{\\partial u}{\\partial \\xi^j} \\right)\n$$\n其中隐含了对 $i,j \\in \\{1,2\\}$ 的求和。此处，$J$ 是变换的雅可比行列式，$g^{ij}$ 是逆变度量张量的分量。\n\n雅可比矩阵 $\\mathbf{J}$ 及其行列式 $J$ 为：\n$$\n\\mathbf{J} = \\begin{pmatrix} x_\\xi  x_\\eta \\\\ y_\\xi  y_\\eta \\end{pmatrix}, \\quad J = \\det(\\mathbf{J}) = x_\\xi y_\\eta - x_\\eta y_\\xi\n$$\n其中下标表示偏导数（例如，$x_\\xi = \\partial x/\\partial \\xi$）。\n\n协变度量张量 $\\mathbf{G} = [g_{ij}]$ 由 $\\mathbf{G} = \\mathbf{J}^T \\mathbf{J}$ 定义：\n$$\ng_{ij} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial x^k}{\\partial \\xi^j} \\implies \\mathbf{G} = \\begin{pmatrix} x_\\xi^2+y_\\xi^2  x_\\xi x_\\eta + y_\\xi y_\\eta \\\\ x_\\xi x_\\eta + y_\\xi y_\\eta  x_\\eta^2+y_\\eta^2 \\end{pmatrix}\n$$\n逆变度量张量 $\\mathbf{G}^{-1} = [g^{ij}]$ 是 $\\mathbf{G}$ 的逆矩阵。可以证明 $\\det(\\mathbf{G}) = J^2$，从而得到：\n$$\n[g^{ij}] = \\frac{1}{J^2} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} x_\\eta^2+y_\\eta^2  -(x_\\xi x_\\eta + y_\\xi y_\\eta) \\\\ -(x_\\xi x_\\eta + y_\\xi y_\\eta)  x_\\xi^2+y_\\xi^2 \\end{pmatrix}\n$$\n\n**$2$. 对倾斜仿射映射的特化**\n\n问题指定了倾斜仿射映射：\n$$\nx(\\xi, \\eta) = \\xi + \\alpha \\eta, \\quad y(\\xi, \\eta) = \\eta\n$$\n我们计算偏导数：\n$x_\\xi = 1, \\quad x_\\eta = \\alpha, \\quad y_\\xi = 0, \\quad y_\\eta = 1$\n雅可比行列式为：\n$$\nJ = x_\\xi y_\\eta - x_\\eta y_\\xi = (1)(1) - (\\alpha)(0) = 1\n$$\n由于雅可比行列式及其导出的所有度量系数都将是常数，变换后的拉普拉斯算子得以简化。一般形式 $\\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} (J g^{ij} \\frac{\\partial u}{\\partial \\xi^j})$ 变为 $g^{ij} \\frac{\\partial^2 u}{\\partial \\xi^i \\partial \\xi^j}$，因为 $J$ 和 $g^{ij}$ 都是常数。\n\n逆变度量张量 $[g^{ij}]$ 的分量为：\n$$\ng^{11} = \\frac{1}{J^2}(x_\\eta^2 + y_\\eta^2) = \\frac{1}{1^2}(\\alpha^2 + 1^2) = 1 + \\alpha^2\n$$\n$$\ng^{22} = \\frac{1}{J^2}(x_\\xi^2 + y_\\xi^2) = \\frac{1}{1^2}(1^2 + 0^2) = 1\n$$\n$$\ng^{12} = g^{21} = -\\frac{1}{J^2}(x_\\xi x_\\eta + y_\\xi y_\\eta) = -\\frac{1}{1^2}((1)(\\alpha) + (0)(1)) = -\\alpha\n$$\n将这些代入简化的拉普拉斯表达式中：\n$$\n\\nabla^2 u = g^{11} \\frac{\\partial^2 u}{\\partial \\xi^2} + g^{22} \\frac{\\partial^2 u}{\\partial \\eta^2} + 2g^{12} \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n$$\n\\nabla^2 u = (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} + \\frac{\\partial^2 u}{\\partial \\eta^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n非正交性（由 $\\alpha \\neq 0$ 表示）引入了交叉导数项 $-2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}$，其系数为 $-2\\alpha$。\n\n**$3$. 数值放大因子分析**\n\n变换后的扩散方程为：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\left( (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta} + \\frac{\\partial^2 u}{\\partial \\eta^2} \\right)\n$$\n我们在间距为 $\\Delta\\xi = \\Delta\\eta = h$ 的均匀网格上，使用时间上的前向欧拉法和空间上的二阶中心差分来离散此方程。将傅里叶模态 $u^n_{i,j} = \\hat{u}^n e^{I(k_\\xi i h + k_\\eta j h)}$ 代入离散化方程中，以求得放大因子 $G = \\hat{u}^{n+1}/\\hat{u}^n$。\n\n离散空间算子的傅里叶符号（特征值）如下：\n- $\\delta^2_\\xi$ 的符号为 $\\lambda_{\\xi\\xi} = \\frac{-4}{h^2}\\sin^2(k_\\xi h/2)$\n- $\\delta^2_\\eta$ 的符号为 $\\lambda_{\\eta\\eta} = \\frac{-4}{h^2}\\sin^2(k_\\eta h/2)$\n- $\\delta_{\\xi\\eta}$ 的符号为 $\\lambda_{\\xi\\eta} = -\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)$\n\n应用前向欧拉格式 $u^{n+1} = u^n + \\Delta t (\\text{RHS})^n$ 并代入傅里叶模态和特征值，我们得到：\n$$\n\\hat{u}^{n+1} = \\hat{u}^n + \\nu \\Delta t \\left[ (1+\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right] \\hat{u}^n\n$$\n对于给定的倾斜度 $\\alpha$，其放大因子记为 $G_\\alpha$：\n$$\nG_\\alpha = 1 + \\nu \\Delta t \\left[ (1+\\alpha^2)\\lambda_{\\xi\\xi} - 2\\alpha\\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right]\n$$\n对于正交情况 ($\\alpha=0$)，放大因子 $G_0$ 为：\n$$\nG_0 = 1 + \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\n相对放大误差比 $R$ 定义为：\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1}\n$$\n分子为：\n$$\nG_\\alpha - G_0 = \\nu \\Delta t \\left[ (\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} \\right]\n$$\n分母为：\n$$\nG_0 - 1 = \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\n$\\nu \\Delta t$ 项被消去，表明 $R$ 衡量的是空间离散化的一个结构属性：\n$$\nR = \\frac{\\alpha^2 \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta}}{\\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta}}\n$$\n代入特征值的表达式：\n$$\nR = \\frac{\\alpha^2 \\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) - 2\\alpha \\left(-\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)\\right)}{\\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) + \\frac{-4}{h^2}\\sin^2(\\frac{k_\\eta h}{2})}\n$$\n通过消去公因子 $-1/h^2$ 并将分子分母同除以 $4$ 来简化：\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 2\\alpha \\sin(k_\\xi h)\\sin(k_\\eta h)}{4\\sin^2(k_\\xi h/2) + 4\\sin^2(k_\\eta h/2)}\n$$\n使用恒等式 $\\sin(x) = 2\\sin(x/2)\\cos(x/2)$，我们可以写成：\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 8\\alpha \\sin(k_\\xi h/2)\\cos(k_\\xi h/2)\\sin(k_\\eta h/2)\\cos(k_\\eta h/2)}{4\\left(\\sin^2(k_\\xi h/2) + \\sin^2(k_\\eta h/2)\\right)}\n$$\n令 $\\theta_\\xi = k_\\xi h/2$ 和 $\\theta_\\eta = k_\\eta h/2$，用于实现的最终表达式为：\n$$\nR = \\frac{\\alpha^2 \\sin^2(\\theta_\\xi) - 2\\alpha \\sin(\\theta_\\xi)\\cos(\\theta_\\xi)\\sin(\\theta_\\eta)\\cos(\\theta_\\eta)}{\\sin^2(\\theta_\\xi) + \\sin^2(\\theta_\\eta)}\n$$\n此公式将用于所提供的测试用例的实现。对于分母为零的情况（即 $k_\\xi h$ 和 $k_\\eta h$ 均为 $2\\pi$ 的整数倍），分子也为零，产生 $0/0$ 的不定形式。在这种数值阻尼为零的情况下，比率 $R$ 取为 $0$，因为没有阻尼误差可以测量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_r(alpha, k_xi, k_eta, h):\n    \"\"\"\n    Computes the relative amplification error ratio R.\n\n    The formula for R is derived from the Fourier analysis of the\n    central-differenced diffusion equation on a skewed affine grid.\n    The ratio R is independent of the diffusion coefficient nu and\n    the time step dt.\n\n    Args:\n        alpha (float): Dimensionless skew parameter.\n        k_xi (float): Wavenumber in the xi-direction (in radians for angle-like quantity).\n        k_eta (float): Wavenumber in the eta-direction (in radians for angle-like quantity).\n        h (float): Uniform grid spacing.\n\n    Returns:\n        float: The calculated value of the relative amplification error ratio R.\n    \"\"\"\n    theta_xi = k_xi * h / 2.0\n    theta_eta = k_eta * h / 2.0\n\n    sin_theta_xi = np.sin(theta_xi)\n    sin_theta_eta = np.sin(theta_eta)\n\n    denominator = sin_theta_xi**2 + sin_theta_eta**2\n\n    # If the denominator is close to zero, it means the numerical damping for the\n    # orthogonal grid is zero (G_0 = 1). This occurs for wavenumbers that are\n    # not resolved by the grid (e.g., k_xi*h=0, k_eta*h=0). In this 0/0 case,\n    # the relative error is conceptually zero.\n    if np.isclose(denominator, 0.0):\n        return 0.0\n\n    cos_theta_xi = np.cos(theta_xi)\n    cos_theta_eta = np.cos(theta_eta)\n    \n    # Numerator corresponds to the change in damping due to skewness.\n    # It contains terms proportional to alpha and alpha^2.\n    numerator = (alpha**2 * sin_theta_xi**2 -\n                 2 * alpha * sin_theta_xi * cos_theta_xi * sin_theta_eta * cos_theta_eta)\n    \n    # Using the identity sin(2x) = 2sin(x)cos(x), an alternative form for the\n    # second term in the numerator is -alpha * sin(k_xi*h) * sin(k_eta*h) / 2,\n    # which is used in some derivations. The current form is direct.\n    \n    r = numerator / denominator\n    return r\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (alpha, k_xi, k_eta, h, nu, dt).\n    # nu and dt are not used in the final formula for R but are part of the problem spec.\n    test_cases = [\n        # Test 1 (baseline orthogonal case)\n        (0.0, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 2 (mild skew, equal modes)\n        (0.2, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 3 (moderate skew, unequal modes)\n        (0.5, np.pi/6, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 4 (strong skew, high wavenumbers)\n        (0.9, np.pi/2, np.pi/2, 1.0, 0.05, 0.02),\n        # Test 5 (skew with one direction constant, edge case)\n        (0.7, np.pi/3, 0.0, 1.0, 0.1, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, k_xi, k_eta, h, nu, dt = case\n        result = compute_r(alpha, k_xi, k_eta, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3327534"}, {"introduction": "在了解网格属性如何引入误差后，我们将应对一个更高级的挑战：如何设计一个在任何光滑曲线网格上都具有根本鲁棒性的数值格式？本练习聚焦于几何守恒律（Geometric Conservation Law, GCL），这是一个确保求解器能正确处理均匀流而无伪影的关键原则。通过此练习，你将理解为何对几何项和通量进行严谨、一致的离散化对于构建一个稳健的求解器至关重要。[@problem_id:3327604]", "problem": "考虑一个从坐标为 $\\boldsymbol{\\xi} = (\\xi,\\eta,\\zeta)$ 的逻辑矩形计算域到坐标为 $\\boldsymbol{x} = (x,y,z)$ 的物理域的光滑、一对一映射，该映射由向量函数 $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$ 给出。令 $J = \\det\\left( \\partial \\boldsymbol{x} / \\partial \\boldsymbol{\\xi} \\right)$ 表示雅可比行列式，并定义逆变向量为 $\\boldsymbol{a}^{\\xi} = \\nabla \\xi$、$\\boldsymbol{a}^{\\eta} = \\nabla \\eta$ 和 $\\boldsymbol{a}^{\\zeta} = \\nabla \\zeta$。在守恒律形式下，物理空间散度 $\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F}(\\boldsymbol{U})$ 可以映射到计算空间，形式为 $\\partial_{\\xi} \\tilde{F}^{\\xi} + \\partial_{\\eta} \\tilde{F}^{\\eta} + \\partial_{\\zeta} \\tilde{F}^{\\zeta}$，其中逆变通量为 $\\tilde{F}^{\\xi} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\xi})$、$\\tilde{F}^{\\eta} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\eta})$ 和 $\\tilde{F}^{\\zeta} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\zeta})$。一个经过充分检验的事实是，连续度量恒等式 $\\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) = \\boldsymbol{0}$ 成立，这与常数 $\\boldsymbol{F}$ 一起，意味着均匀自由流的保持。\n\n在具有节点 $(\\xi_i,\\eta_j,\\zeta_k)$ 的结构化网格和有限差分格式上，令 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 分别表示逼近 $\\partial_{\\xi}$、$\\partial_{\\eta}$ 和 $\\partial_{\\zeta}$ 的线性、相容的离散导数算子。假设网格映射和边界处理是光滑的，使得在连续情况下混合偏导数可交换。目标是为度量项 $J \\boldsymbol{a}^{\\xi}$、$J \\boldsymbol{a}^{\\eta}$ 和 $J \\boldsymbol{a}^{\\zeta}$ 设计一个相容的离散逼近，该逼近满足度量恒等式的离散模拟，并在 $\\boldsymbol{U}$ 为常数时保持均匀自由流。您还必须论证在度量构造和通量散度中都使用相同的离散差分算子的必要性。\n\n在光滑的曲线结构化网格上，以下哪种离散构造能实现这些目标？\n\nA. 通过 $\\,\\widehat{J \\boldsymbol{a}^{\\xi}} = D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$、$\\,\\widehat{J \\boldsymbol{a}^{\\eta}} = D_{\\zeta}\\boldsymbol{x} \\times D_{\\xi}\\boldsymbol{x}$ 和 $\\,\\widehat{J \\boldsymbol{a}^{\\zeta}} = D_{\\xi}\\boldsymbol{x} \\times D_{\\eta}\\boldsymbol{x}$ 以保守的余因子形式定义离散度量，并使用相同的算子 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 分别应用于 $\\tilde{F}^{\\xi}$、$\\tilde{F}^{\\eta}$ 和 $\\tilde{F}^{\\zeta}$ 来计算离散通量散度。选择 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 为线性的、相容的，并且在光滑网格上可交换（例如，具有相同内部模板的相容分部求和算子）。\n\nB. 通过局部最小二乘拟合逼近雅可比矩阵的逆 $(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}$，以非保守形式计算 $\\boldsymbol{a}^{\\xi}$、$\\boldsymbol{a}^{\\eta}$ 和 $\\boldsymbol{a}^{\\zeta}$，然后通过一个单独的离散三重积公式设定 $J$。对通量散度使用与度量构造中所用算子不同的迎风偏置差分算子。\n\nC. 计算 $J \\boldsymbol{a}^{\\xi}$ 时，首先使用 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 通过离散的 $\\boldsymbol{x}_{\\xi}$、$\\boldsymbol{x}_{\\eta}$ 和 $\\boldsymbol{x}_{\\zeta}$ 的离散三重积形成 $J$，然后将 $J$ 乘以通过求解每个节点上的 $3 \\times 3$ 线性系统 $(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}$ 获得的 $\\boldsymbol{a}^{\\xi}$ 的离散逼近。对通量散度使用相同的算子 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$。\n\nD. 使用保守的余因子形式定义离散度量，但对 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 使用紧致中心差分，同时使用具有相同形式阶但不同模板的显式中心差分计算通量散度。依赖于形式阶的匹配来论证自由流保持和度量恒等式是近似成立而非精确成立。\n\n选择正确的选项，并使用第一性原理，论证该构造以及为保证恒定状态下的离散度量恒等式和自由流保持而对度量和通量使用相同算子的必要性。", "solution": "问题陈述是计算流体动力学领域中一个有效且适定的问题，具体涉及在曲线坐标系上求解守恒律的数值方法。所提出的概念——广义坐标变换、雅可比行列式、逆变向量、度量恒等式和自由流保持——是有限差分法和有限体积法理论与实践的基础。该问题要求找到一种满足几何守恒律 (GCL) 以确保自由流保持的离散方法。\n\n### 基于原理的推导\n\n通量向量 $\\boldsymbol{F}$ 的散度从物理空间 $\\boldsymbol{x}=(x,y,z)$ 到计算空间 $\\boldsymbol{\\xi}=(\\xi,\\eta,\\zeta)$ 的变换由下式给出：\n$$\n\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F} = \\frac{1}{J} \\left( \\frac{\\partial (J F^\\xi)}{\\partial \\xi} + \\frac{\\partial (J F^\\eta)}{\\partial \\eta} + \\frac{\\partial (J F^\\zeta)}{\\partial \\zeta} \\right)\n$$\n其中 $F^\\xi = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\xi$、$F^\\eta = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\eta$ 和 $F^\\zeta = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\zeta$ 是 $\\boldsymbol{F}$ 的逆变分量。问题陈述使用了一种略有不同但等价的表述，即使用逆变通量 $\\tilde{F}^{\\xi} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\xi})$，从而得到计算空间中的守恒律形式：\n$$\n\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F} \\rightarrow \\partial_{\\xi} \\tilde{F}^{\\xi} + \\partial_{\\eta} \\tilde{F}^{\\eta} + \\partial_{\\zeta} \\tilde{F}^{\\zeta} = 0\n$$\n保持均匀自由流要求，如果物理状态向量 $\\boldsymbol{U}$ 为常数，则数值格式必须产生零残差。对于常数 $\\boldsymbol{U}$，物理通量向量 $\\boldsymbol{F}(\\boldsymbol{U})$ 也是一个常向量，我们将其表示为 $\\boldsymbol{F}_c$。逆变通量变为 $\\tilde{F}^{\\gamma} = \\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\gamma})$，其中 $\\gamma \\in \\{\\xi, \\eta, \\zeta\\}$。\n\n恒定状态下的连续控制方程为：\n$$\n\\partial_{\\xi} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\xi})) + \\partial_{\\eta} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\eta})) + \\partial_{\\zeta} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\zeta})) = 0\n$$\n由于 $\\boldsymbol{F}_c$ 是一个常向量，可以将其从导数中提出：\n$$\n\\boldsymbol{F}_c \\cdot \\left( \\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) \\right) = 0\n$$\n为使此方程对任意常数状态（即任意 $\\boldsymbol{F}_c$）成立，括号中的项必须恒等于零。这就是**连续度量恒等式**，也称为几何守恒律 (GCL)：\n$$\n\\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) = \\boldsymbol{0}\n$$\n可以解析地证明该恒等式成立。$J \\boldsymbol{a}^{\\gamma}$ 项被称为度量项或缩放的逆变基向量。它们可以用位置向量 $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$ 的导数更直接地表示，即余因子恒等式：\n$$\nJ \\boldsymbol{a}^{\\xi} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta}, \\quad\nJ \\boldsymbol{a}^{\\eta} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi}, \\quad\nJ \\boldsymbol{a}^{\\zeta} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta}\n$$\n将这些代入 GCL，对于足够光滑的映射 $\\boldsymbol{x}(\\boldsymbol{\\xi})$，由于混合偏导数的可交换性，该恒等式成立。\n\n现在，我们必须在离散层面上复制这一性质。设 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 为逼近偏导数的线性离散算子。通量散度的离散逼近为 $D_{\\xi} \\tilde{F}^{\\xi} + D_{\\eta} \\tilde{F}^{\\eta} + D_{\\zeta} \\tilde{F}^{\\zeta}$。对于恒定状态 $\\boldsymbol{F}_c$，自由流保持的条件是：\n$$\nD_{\\xi} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\zeta}}) = 0\n$$\n其中 $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ 表示度量项的离散逼近。由于算子 $D_\\gamma$ 是线性的，我们有：\n$$\n\\boldsymbol{F}_c \\cdot \\left( D_{\\xi}(\\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta}(\\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta}(\\widehat{J \\boldsymbol{a}^{\\zeta}}) \\right) = 0\n$$\n为使此式对任意 $\\boldsymbol{F}_c$ 成立，**离散GCL**必须*精确*满足（即达到机器精度）：\n$$\nD_{\\xi}(\\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta}(\\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta}(\\widehat{J \\boldsymbol{a}^{\\zeta}}) = \\boldsymbol{0}\n$$\n关键在于定义离散度量 $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ 使得这个代数恒等式成立。实现这一点的最稳健方法是模仿导致连续情况下抵消的结构。这涉及两个关键选择：\n1. 离散度量必须使用余因子形式定义，但用离散算子代替偏导数。\n2. 用于计算度量的离散算子必须与用于计算通量散度的算子交织在一起，以产生伸缩求和或类似的代数抵消。\n\n让我们提出一个构造并进行检验。设用于度量构造的算子为 $D'_{\\gamma}$，用于通量散度的算子为 $D_{\\gamma}$。使用余因子形式定义度量：\n$$\n\\widehat{J \\boldsymbol{a}^{\\xi}} = D'_{\\eta}\\boldsymbol{x} \\times D'_{\\zeta}\\boldsymbol{x}, \\quad\n\\widehat{J \\boldsymbol{a}^{\\eta}} = D'_{\\zeta}\\boldsymbol{x} \\times D'_{\\xi}\\boldsymbol{x}, \\quad\n\\widehat{J \\boldsymbol{a}^{\\zeta}} = D'_{\\xi}\\boldsymbol{x} \\times D'_{\\eta}\\boldsymbol{x}\n$$\n离散 GCL 变为：\n$$\nD_{\\xi}(D'_{\\eta}\\boldsymbol{x} \\times D'_{\\zeta}\\boldsymbol{x}) + D_{\\eta}(D'_{\\zeta}\\boldsymbol{x} \\times D'_{\\xi}\\boldsymbol{x}) + D_{\\zeta}(D'_{\\xi}\\boldsymbol{x} \\times D'_{\\eta}\\boldsymbol{x}) = \\boldsymbol{0}\n$$\n如果 $D_{\\gamma}$ 和 $D'_{\\gamma}$ 是相同的算子（$D_{\\gamma} = D'_{\\gamma}$），并且这些算子具有离散可交换性，即 $D_{\\xi}D_{\\eta} \\approx D_{\\eta}D_{\\xi}$，则该恒等式成立。对于许多常见的算子，如在均匀或光滑变化的网格上的标准中心差分，这种可交换性是成立的，从而导致精确抵消。更一般地，分部求和（SBP）算子被设计用来满足分部积分的离散模拟，这为该恒等式的成立提供了必要的代数结构。对度量 ($D'$) 和散度 ($D$) 使用不同的算子会破坏这种对称性，导致抵消失败。\n\n### 逐项分析\n\n**A. 通过 $\\,\\widehat{J \\boldsymbol{a}^{\\xi}} = D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$ 等以保守的余因子形式定义离散度量，并使用相同的算子 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 计算离散通量散度。**\n\n该选项完全遵循了推导出的原理。它使用离散余因子形式来定义度量。关键是，它规定了在度量构造和通量散度中都使用*相同*的算子。这些算子是线性的、相容的，并且可交换（或具有相容的 SBP 性质）的条件确保了代数结构模仿了连续情况，从而在离散 GCL 表达式中实现精确抵消。这保证了自由流保持达到机器精度。这是在有限差分格式中满足 GCL 的标准、成熟的方法。\n**结论：正确。**\n\n**B. 通过逼近雅可比矩阵的逆...以非保守形式计算 $\\boldsymbol{a}^{\\xi}$、$\\boldsymbol{a}^{\\eta}$ 和 $\\boldsymbol{a}^{\\zeta}$，然后通过一个单独的离散三重积公式设定 $J$。对通量散度使用与度量构造中所用算子不同的迎风偏置差分算子。**\n\n这种方法有两个根本性缺陷。首先，它通过分别逼近 $J$ 和 $\\boldsymbol{a}^{\\gamma}$ 然后将它们相乘来计算度量项。这是一种“非保守”构造，因为离散乘积 $\\hat{J} \\widehat{\\boldsymbol{a}^{\\gamma}}$ 通常不等于离散余因子形式，例如 $D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$。使用不同的离散化路径破坏了精确的代数联系，这意味着得到的度量 $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ 将不满足离散 GCL。其次，它明确地对通量散度和度量构造使用不同的算子，正如我们所推导的，这破坏了 GCL 所需的代数抵消。\n**结论：不正确。**\n\n**C. 计算 $J \\boldsymbol{a}^{\\xi}$ 时，首先通过离散三重积形成 $J$...然后将 $J$ 乘以通过求解 $3 \\times 3$ 线性系统...获得的 $\\boldsymbol{a}^{\\xi}$ 的离散逼近。对通量散度使用相同的算子 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$。**\n\n该选项与 B 类似，对度量项使用了非保守构造。离散雅可比行列式 $\\hat{J} = (D_{\\xi}\\boldsymbol{x}) \\cdot (D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x})$ 和离散逆矩阵 $\\widehat{(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}}$ 是通过不同的路径计算的。虽然它们是相容的逼近，但它们的乘积在代数上不能像余因子形式那样保证离散 GCL 的满足。尽管它正确地提议对通量散度使用相同的算子，但度量的初始构造是有缺陷的，不会导致精确的自由流保持。\n**结论：不正确。**\n\n**D. 使用保守的余因子形式定义离散度量，但对 $D_{\\xi}$、$D_{\\eta}$ 和 $D_{\\zeta}$ 使用紧致中心差分，同时使用具有相同形式阶但不同模板的显式中心差分计算通量散度。依赖于形式阶的匹配来论证自由流保持和度量恒等式是近似成立而非精确成立。**\n\n该选项正确地使用了余因子形式来定义度量。然而，它明确违反了对度量和通量散度使用相同算子的关键要求。使用不同模板的算子（即使它们具有相同的形式精度阶）将破坏精确的代数抵消。关于自由流保持将“近似”成立的论点是承认失败。在稳健的数值格式中，自由流保持必须*精确*满足（达到机器精度）。“近似”满足意味着格式在均匀流中会产生伪源，这是不可接受的，并可能导致显著的解误差。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3327604"}]}