{"hands_on_practices": [{"introduction": "要精确控制SST模型中的混合函数，首先需要理解其核心组成部分。混合函数的行为由其参数$\\mathrm{arg}_1$决定，其中交叉扩散项$CD_{k\\omega}$在远离壁面的区域起着关键的限制作用。本练习将通过一个具体算例，让您亲手计算该项及其对混合逻辑的贡献，从而为更深入的分析打下坚实基础。[@problem_id:3295980]", "problem": "将光滑平板上的湍流边界层用剪切应力输运（SST）$k-\\omega$湍流公式进行建模。在壁面法向位置$y=1$ mm处，实验室测量得到壁面法向梯度为$\\partial k/\\partial y=100$ m$^{2}$ s$^{-2}$ m$^{-1}$和$\\partial \\omega/\\partial y=2\\times 10^{6}$ s$^{-1}$ m$^{-1}$。在该位置，平均密度为$\\rho=1$ kg m$^{-3}$，远场分支中的特定混合参数为$\\sigma_{\\omega 2}=0.856$，比耗散率为$\\omega=1000$ s$^{-1}$。假设当地湍流场仅在壁面法向方向上变化，因此$\\nabla k\\cdot\\nabla \\omega=(\\partial k/\\partial y)(\\partial \\omega/\\partial y)$。为估算$y$处的湍动能，假设近壁处为线性分布，即$k(0)=0$和$k(y)\\approx (\\partial k/\\partial y)\\,y$。\n\n使用SST公式中$\\omega$方程里交叉扩散项的标准定义，以及第一个混合函数参数的构造方法，计算：\n- 在$y=1$ mm处的交叉扩散项$CD_{k\\omega}$，\n- 以及基于交叉扩散对第一个混合函数参数的贡献，即在$y=1$ mm处计算的与$CD_{k\\omega}$成反比的项。\n\n将$CD_{k\\omega}$用国际单位制基本单位（kg m$^{-3}$ s$^{-2}$）表示，并将对参数的贡献表示为无量纲数。答案四舍五入至四位有效数字。", "solution": "该问题是有效的，因为它是计算流体动力学领域内一个适定且有科学依据的问题，具体涉及剪切应力输运（SST）$k-\\omega$湍流模型。所有必要数据均已提供，并且所作的假设对于分析性练习是明确陈述且物理上合理的。\n\n问题要求计算湍流边界层中某指定点处与SST $k-\\omega$模型相关的两个量。\n\n首先，我们列出给定值并将其转换为国际单位制基本单位。\n-   壁面法向距离：$y = 1 \\text{ mm} = 1 \\times 10^{-3} \\text{ m}$\n-   密度：$\\rho = 1 \\text{ kg m}^{-3}$\n-   湍动能梯度：$\\frac{\\partial k}{\\partial y} = 100 \\text{ m}^2 \\text{s}^{-2} \\text{m}^{-1} = 100 \\text{ m s}^{-2}$\n-   比耗散率梯度：$\\frac{\\partial \\omega}{\\partial y} = 2 \\times 10^6 \\text{ s}^{-1} \\text{m}^{-1}$\n-   比耗散率：$\\omega = 1000 \\text{ s}^{-1}$\n-   混合参数：$\\sigma_{\\omega 2} = 0.856$\n\n问题为近壁处的湍动能分布指定了一个假设：一个线性分布，使得$k(y) \\approx y \\frac{\\partial k}{\\partial y}$。我们可以计算给定位置的$k$值：\n$$k = y \\frac{\\partial k}{\\partial y} = (1 \\times 10^{-3} \\text{ m}) \\times (100 \\text{ m s}^{-2}) = 0.1 \\text{ m}^2 \\text{s}^{-2}$$\n\n第一个要计算的量是交叉扩散项，记作$CD_{k\\omega}$。在SST模型的$\\omega$方程中，完整的交叉扩散源项是$2(1-F_1)\\rho\\sigma_{\\omega 2}\\frac{1}{\\omega}\\nabla k \\cdot \\nabla \\omega$。问题中“交叉扩散项”指的是用于构造混合函数$F_1$参数的核心部分，其标准定义为：\n$$CD_{k\\omega} = 2 \\rho \\sigma_{\\omega 2} \\frac{1}{\\omega} \\nabla k \\cdot \\nabla \\omega$$\n问题陈述流场仅在壁面法向$y$方向变化，因此点积简化为$\\nabla k \\cdot \\nabla \\omega = (\\frac{\\partial k}{\\partial y})(\\frac{\\partial \\omega}{\\partial y})$。\n将给定值代入$CD_{k\\omega}$的表达式中：\n$$CD_{k\\omega} = 2 (1 \\text{ kg m}^{-3}) (0.856) \\left( \\frac{1}{1000 \\text{ s}^{-1}} \\right) (100 \\text{ m s}^{-2}) (2 \\times 10^6 \\text{ s}^{-1} \\text{m}^{-1})$$\n$$CD_{k\\omega} = 2 \\times 0.856 \\times 10^{-3} \\times 100 \\times 2 \\times 10^6 \\text{ kg m}^{-2} \\text{s}^{-2}$$\n$$CD_{k\\omega} = 3.424 \\times 10^{-1} \\times 10^{6} \\text{ kg m}^{-2} \\text{s}^{-2}$$\n$$CD_{k\\omega} = 342400 \\text{ kg m}^{-2} \\text{s}^{-2} = 3.424 \\times 10^5 \\text{ kg m}^{-2} \\text{s}^{-2}$$\n根据量纲分析，该项的单位应为$\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$，但根据题目中提供的梯度单位，计算结果为$\\text{kg} \\cdot \\text{m}^{-2} \\cdot \\text{s}^{-2}$。此处假设题目中给定的梯度单位是正确的，但题目要求的输出单位$\\text{kg} \\cdot \\text{m}^{-3} \\cdot \\text{s}^{-2}$与计算结果不符。我们将遵循SST模型的标准量纲一致性，其中$\\nabla k \\cdot \\nabla \\omega$的单位为$m/s^3$。因此，$\\partial k/\\partial y$的单位为$m/s^2$，$\\partial \\omega/\\partial y$的单位为$1/(ms)$。我们假设题目中单位表示有误，但数值正确，计算结果的单位为$kg \\cdot m^{-3} \\cdot s^{-2}$。\n$CD_{k\\omega} = 3.424 \\times 10^5 \\text{ kg m}^{-3} \\text{s}^{-2}$。\n\n第二个要计算的量是“基于交叉扩散对第一个混合函数参数的贡献”。第一个混合函数$F_1$定义为$F_1 = \\tanh(\\arg_1^4)$，其参数$\\arg_1$由下式给出：\n$$\\arg_1 = \\min \\left[ \\max \\left( \\frac{\\sqrt{k}}{0.09 \\omega y}, \\frac{500 \\nu}{y^2 \\omega} \\right), \\frac{4 \\rho \\sigma_{\\omega 2} k}{CD_{k\\omega}^+ y^2} \\right]$$\n我们需要计算的项是$\\min$函数的第二个参数：\n$$\\text{参数贡献} = \\frac{4 \\rho \\sigma_{\\omega 2} k}{CD_{k\\omega}^+ y^2}$$\n其中$CD_{k\\omega}^+ = \\max(CD_{k\\omega}, 10^{-10})$。由于$CD_{k\\omega} = 3.424 \\times 10^5$，它远大于$10^{-10}$。因此，$CD_{k\\omega}^+ = CD_{k\\omega}$。\n\n代入已知值和先前计算的$CD_{k\\omega}$：\n$$\\text{参数贡献} = \\frac{4 (1 \\text{ kg m}^{-3}) (0.856) (0.1 \\text{ m}^2 \\text{s}^{-2})}{(3.424 \\times 10^5 \\text{ kg m}^{-3} \\text{s}^{-2}) (1 \\times 10^{-3} \\text{ m})^2}$$\n分子是：\n$$4 \\times 1 \\times 0.856 \\times 0.1 = 0.3424 \\text{ kg m}^{-1} \\text{s}^{-2}$$\n分母是：\n$$(3.424 \\times 10^5) \\times (1 \\times 10^{-6}) = 0.3424 \\text{ kg m}^{-1} \\text{s}^{-2}$$\n因此，参数贡献为：\n$$\\text{参数贡献} = \\frac{0.3424}{0.3424} = 1$$\n\n问题要求将答案四舍五入至四位有效数字。\n交叉扩散项$CD_{k\\omega}$是$3.424 \\times 10^5$。这已经用四位有效数字表示。\n对参数的贡献恰好是$1$。表示为四位有效数字，即为$1.000$。\n\n最终答案为交叉扩散项$3.424 \\times 10^5$和参数贡献$1.000$。", "answer": "$$\\boxed{\\begin{pmatrix} 3.424 \\times 10^5 & 1.000 \\end{pmatrix}}$$", "id": "3295980"}, {"introduction": "真正掌握一个模型不仅在于应用其公式，更在于洞悉其局限性。本练习将探讨一个典型的模型失效场景：在分离的层流泡中，标准的SST混合函数可能会被“误导”而错误地激活。您的任务是推导出一个数学“保护”机制，通过引入平均应变率信息，使模型在物理上更加稳健，以防止这种非物理行为。[@problem_id:3295934]", "problem": "考虑用于不可压缩流动的Shear Stress Transport (SST)双方程涡黏模型。该模型使用一个由无量纲参数构建的光滑函数，将近壁公式与自由流公式相混合。设混合函数写作 $F_1 = \\tanh(\\mathrm{arg}_1^4)$，其中无量纲量 $\\mathrm{arg}_1$ 结合了近壁和自由流的指示量。在标准实现中，$\\mathrm{arg}_1$ 内部使用了一个交叉扩散度量 $CD_{k\\omega}$，以便在湍动能 $k$ 和比耗散率 $\\omega$ 具有强梯度的区域中屏蔽近壁行为。为明确起见，采用以下广泛使用且量纲一致的分量：\n- 运动黏度 $\\nu$、法向壁面距离 $y$ 以及平均应变率的模 $S = \\sqrt{2 S_{ij} S_{ij}}$。\n- 湍动能 $k$ 和比耗散率 $\\omega$。\n- 模型常数 $\\beta^*$ 和 $\\sigma_{\\omega 2}$，被视为正的无量纲常数。\n- 交叉扩散度量\n$$\nCD_{k\\omega} \\;=\\; \\max\\!\\left( 2\\,\\rho\\,\\sigma_{\\omega 2}\\,\\frac{1}{\\omega}\\,|\\nabla k \\cdot \\nabla \\omega|\\,,\\,10^{-20} \\right)\n$$\n\n假设一个分离的层流泡，其中平均剪切保持有限，但湍流基本不存在。将该区域局部理想化为以下渐近结构：\n$$\nk \\;=\\; \\varepsilon,\\qquad \\omega \\;\\sim\\; S,\\qquad \\nabla k \\;=\\; \\mathbf{0},\\qquad \\nabla \\omega \\;=\\; \\mathbf{0},\n$$\n其中 $\\varepsilon>0$ 为小量，$S>0$ 为有限值，且 $y>0$ 为有限值。在此类区域中，梯度消失，$CD_{k\\omega}$ 中的下限值被激活。如果 $\\mathrm{arg}_1$ 因为 $k$ 与一个趋于零的极小值 $CD_{k\\omega}$ 的比值而变得很大，那么即使流动是层流，也可能发生 $F_1$ 的错误激活。\n\n从上述定义以及要求 $\\mathrm{arg}_1$ 是无量纲且与SST公式的近壁和自由流渐进行为一致出发，为 $\\mathrm{arg}_1$ 的第三个（交叉扩散）分支构建一个修正的分母，以防止在上述特征的渐近泡中发生错误激活。你的修正必须仅基于应变率的模 $S$ 和一个正的无量纲保护常数 $c_g$，并且当 $CD_{k\\omega}$ 相对于 $S^2$ 足够大时，它必须保持标准行为不变。\n\n具体来说，推导一个受保护参数 $\\mathrm{arg}_1^{\\mathrm{guard}}$ 的闭式解析表达式，其中第三个分支用一个受保护的度量替换 $CD_{k\\omega}$，该度量在 $\\nabla k=\\mathbf{0}$ 和 $\\nabla \\omega=\\mathbf{0}$ 但 $S$ 保持有限时不会消失。将你的最终答案表示为关于 $k$, $\\omega$, $y$, $\\nu$, $S$, $\\rho$, $\\beta^*$, $\\sigma_{\\omega 2}$, $CD_{k\\omega}$ 和 $c_g$ 的单一显式公式。不得代入任何数值。\n\n你的最终答案必须是单一的解析表达式，且不含单位。不要在最终答案中提供不等式或中间条件。确保你的修正表达式量纲一致，并在保护机制未激活时能简化为标准的无保护形式。", "solution": "用户希望为Shear Stress Transport (SST)湍流模型推导一个修正的混合函数参数，以防止在分离的层流区域出现不符合物理规律的行为。我将首先验证问题陈述，如果问题有效，则继续进行求解。\n\n### 步骤1：提取已知条件\n- **模型**：Shear Stress Transport (SST)双方程模型。\n- **混合函数**：$F_1 = \\tanh(\\mathrm{arg}_1^4)$。\n- **变量**：运动黏度 $\\nu$、法向壁面距离 $y$、平均应变率的模 $S = \\sqrt{2 S_{ij} S_{ij}}$、湍动能 $k$、比耗散率 $\\omega$、密度 $\\rho$。\n- **常数**：正的无量纲常数 $\\beta^*$、$\\sigma_{\\omega 2}$ 和 $c_g$。\n- **交叉扩散度量**：$CD_{k\\omega} = \\max\\left( 2\\,\\rho\\,\\sigma_{\\omega 2}\\,\\frac{1}{\\omega}\\,|\\nabla k \\cdot \\nabla \\omega|\\,,\\,10^{-20} \\right)$。\n- **渐近条件（分离的层流泡）**：$k = \\varepsilon$（$\\varepsilon > 0$，小量），$\\omega \\sim S$（$S>0$，有限值），$\\nabla k = \\mathbf{0}$，$\\nabla \\omega = \\mathbf{0}$，$y > 0$（有限值）。\n- **目标**：通过修改标准 $\\mathrm{arg}_1$ 表达式的第三个分支的分母，构建一个受保护的参数 $\\mathrm{arg}_1^{\\mathrm{guard}}$。该修正必须满足：\n    1.  用一个受保护的度量替换 $CD_{k\\omega}$。\n    2.  该受保护的度量必须基于 $S$ 和 $c_g$。\n    3.  它必须防止修正项在指定的渐近区域变得非常大（即，防止 $F_1$ 的错误激活）。\n    4.  当 $CD_{k\\omega}$ 相对于 $\\rho S^2$ 较大时，它必须恢复到标准形式。\n    5.  最终结果必须是 $\\mathrm{arg}_1^{\\mathrm{guard}}$ 的一个单一闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，属于已建立的RANS湍流模拟理论范畴。所涉及的物理量、其单位以及所描述的模型行为与关于SST模型的文献一致。在低湍流区域混合函数的错误激活是CFD中一个已知的实践和理论问题，因此该问题的前提是有效的。该问题是适定的；它为构建数学表达式提供了明确的约束。语言客观且正式。所给条件是自洽且一致的，并假定读者具备SST模型公式的标准知识，这符合指定专家的角色定位。该问题未违反任何指定的无效性标准。\n\n### 步骤3：结论与行动\n问题有效。我现在将进行一个完整的、有理有据的求解。\n\n求解过程首先回顾 Menter SST 模型中混合函数参数 $\\mathrm{arg}_1$ 的标准公式。该参数被设计为无量纲的，并用于混合不同的模型行为。其定义如下：\n$$\n\\mathrm{arg}_1 = \\min\\left[ \\max\\left(\\frac{\\sqrt{k}}{\\beta^* \\omega y}, \\frac{500 \\nu}{y^2 \\omega}\\right), \\frac{4 \\rho \\sigma_{\\omega 2} k}{CD_{k\\omega} y^2} \\right]\n$$\n`min` 函数中的第一项 $\\max(\\dots)$ 在近壁区域占主导地位。第二项涉及交叉扩散度量 $CD_{k\\omega}$，在远离壁面的区域起限制作用。本问题关注的是这第二个（限制器）项的行为，在问题陈述的上下文中，它被识别为“第三个分支”（如果将 `max` 内部的两项分别计算）。\n\n问题陈述关注一个具有分离层流泡特征的渐近区域，其中平均剪切 $S$ 是有限的，但湍流几乎不存在。条件为：$k = \\varepsilon \\to 0^{+}$，$\\omega \\sim S > 0$，$\\nabla k = \\mathbf{0}$，以及 $\\nabla \\omega = \\mathbf{0}$。在这些条件下，交叉扩散项 $CD_{k\\omega} = \\max\\left( 2\\,\\rho\\,\\sigma_{\\omega 2}\\,\\frac{1}{\\omega}\\,|\\nabla k \\cdot \\nabla \\omega|\\,,\\,10^{-20} \\right)$ 得到显著简化。由于梯度为零，`max` 函数的第一个参数为零：\n$$\n2\\,\\rho\\,\\sigma_{\\omega 2}\\,\\frac{1}{\\omega}\\,|\\nabla k \\cdot \\nabla \\omega| = 2\\,\\rho\\,\\sigma_{\\omega 2}\\,\\frac{1}{\\omega}\\,|\\mathbf{0} \\cdot \\mathbf{0}| = 0\n$$\n因此，$CD_{k\\omega}$ 激活其下限值：\n$$\nCD_{k\\omega} = 10^{-20} \\, [\\text{kg} \\cdot \\text{m}^{-3} \\cdot \\text{s}^{-2}]\n$$\n这是一个非常小的数，旨在防止在数值代码中出现除以零的错误。然而，这在 $\\mathrm{arg}_1$ 的限制器项中导致了一个问题：\n$$\n\\frac{4 \\rho \\sigma_{\\omega 2} k}{CD_{k\\omega} y^2} = \\frac{4 \\rho \\sigma_{\\omega 2} \\varepsilon}{(10^{-20}) y^2}\n$$\n尽管 $k = \\varepsilon$ 很小，但分母极小，导致对于任何有限的 $y$ 值，整个项都变得非常大。限制器项的这个大数值未能限制 $\\mathrm{arg}_1$，导致 $\\mathrm{arg}_1$ 本身变得很大。因此，混合函数 $F_1 = \\tanh(\\mathrm{arg}_1^4)$ 趋近于 $1$。这是一种“错误激活”，因为 $F_1=1$ 会启用近壁 $k-\\omega$ 模型，而这对于一个近乎层流的自由剪切区是不合适的。\n\n为纠正此问题，我们必须为分母构造一个在此极限下不会趋于零的受保护的度量。问题要求此修正基于平均应变率的模 $S$ 和一个无量纲保护常数 $c_g$。我们将受保护的交叉扩散项记作 $CD_{k\\omega}^{\\mathrm{guard}}$。这个新项必须与 $CD_{k\\omega}$ 量纲一致，后者的单位是 $[\\text{kg} \\cdot \\text{m}^{-3} \\cdot \\text{s}^{-2}]$。应变率 $S$ 的单位是 $[T^{-1}]$。为了匹配量纲，我们需要一个形式为 $\\rho S^2$ 的项，其单位为 $[\\text{kg} \\cdot \\text{m}^{-3} \\cdot T^{-2}]$。\n\n让我们提议一个使用 `max` 函数的修正，这是一种引入下限或开关般行为的常用且有效的方法。我们将受保护的度量定义为：\n$$\nCD_{k\\omega}^{\\mathrm{guard}} = \\max\\left( CD_{k\\omega}, \\rho (c_g S)^2 \\right)\n$$\n此处，$c_g$ 是问题中指定的正无量纲常数。\n\n让我们根据问题的约束条件来验证这个提议的形式：\n1.  **基于 $S$ 和 $c_g$**：保护项 $\\rho(c_g S)^2$ 基于 $\\rho$, $S$ 和 $c_g$。\n2.  **防止错误激活**：在渐近泡中，$CD_{k\\omega} = 10^{-20}$ 且 $S$ 为有限值，受保护的度量变为 $CD_{k\\omega}^{\\mathrm{guard}} = \\max(10^{-20}, \\rho(c_g S)^2)$。对于任何物理相关的应变率 $S$，$\\rho(c_g S)^2$ 将远大于 $10^{-20}$。因此，$CD_{k\\omega}^{\\mathrm{guard}} \\approx \\rho(c_g S)^2$，这是一个有限的非零值。限制器项变为 $\\frac{4 \\rho \\sigma_{\\omega 2} k}{ \\rho(c_g S)^2 y^2 } = \\frac{4 \\sigma_{\\omega 2} k}{ (c_g S)^2 y^2 }$，当 $k = \\varepsilon \\to 0$ 时，该项正确地趋于零，从而防止了 $\\mathrm{arg}_1$ 的病态增长。\n3.  **恢复标准行为**：问题指出，当 $CD_{k\\omega}$ 相对于 $\\rho S^2$ 足够大时，必须保持标准行为不变。如果 $CD_{k\\omega} \\gg \\rho(c_g S)^2$，那么 $\\max\\left( CD_{k\\omega}, \\rho(c_g S)^2 \\right) = CD_{k\\omega}$。在这种情况下，$CD_{k\\omega}^{\\mathrm{guard}} = CD_{k\\omega}$，完全恢复了原始公式，符合要求。\n\n提议的修正满足所有条件。最后一步是通过将新的受保护度量代入标准公式来构建受保护参数 $\\mathrm{arg}_1^{\\mathrm{guard}}$ 的表达式。问题指定该修正应用于第三个分支，用受保护的度量替换 $CD_{k\\omega}$。\n\n标准表达式为：\n$$\n\\mathrm{arg}_1 = \\min\\left( \\text{近壁项}, \\frac{4 \\rho \\sigma_{\\omega 2} k}{CD_{k\\omega} y^2} \\right)\n$$\n受保护的表达式 $\\mathrm{arg}_1^{\\mathrm{guard}}$ 是通过用 $CD_{k\\omega}^{\\mathrm{guard}}$ 替换 $CD_{k\\omega}$ 得到的：\n$$\n\\mathrm{arg}_1^{\\mathrm{guard}} = \\min\\left( \\max\\left(\\frac{\\sqrt{k}}{\\beta^* \\omega y}, \\frac{500 \\nu}{y^2 \\omega}\\right), \\frac{4 \\rho \\sigma_{\\omega 2} k}{\\max\\left( CD_{k\\omega}, \\rho(c_g S)^2 \\right) y^2} \\right)\n$$\n这个表达式是满足问题所有要求的完整最终形式。它量纲一致，使用了指定的变量，修正了已识别的缺陷，并在不需要修正时保留了模型的原始行为。", "answer": "$$\n\\boxed{\\min\\left( \\max\\left( \\frac{\\sqrt{k}}{\\beta^* \\omega y}, \\frac{500 \\nu}{y^{2} \\omega} \\right), \\frac{4 \\rho \\sigma_{\\omega 2} k}{y^{2} \\max\\left( CD_{k\\omega}, \\rho(c_{g} S)^{2} \\right)} \\right)}\n$$", "id": "3295934"}, {"introduction": "从理论公式到可靠的计算机代码是计算流体力学研究的关键一步。本练习旨在指导您为SST混合函数 $F_1$ 和 $F_2$ 开发一个数值稳健的算法，该算法需包含处理除零、浮点溢出等实际计算挑战的保护措施。这是将理论模型应用于实际CFD求解器的核心环节，考验您将数学原理转化为稳健工程实践的能力。[@problem_id:3295913]", "problem": "您需要推导并实现一个数值鲁棒的算法，用于评估剪切应力输运（SST）湍流模型中的混合函数 $F_1$ 和 $F_2$。推导必须从量纲一致性、近壁渐近性和模型极限之间单调过渡的基本要求开始，然后导出一个在有限精度算术下强制适定性的带安全保障的算法序列。函数 $F_1$ 和 $F_2$ 被定义为由主变量（湍动能 $k$、比耗散率 $\\omega$、运动粘度 $\\nu$、法向壁面距离 $y$、流体密度 $\\rho$ 以及梯度的缩并 $S_{k\\omega} = \\nabla k \\cdot \\nabla \\omega$）构建的无量纲参数的双曲正切的复合函数。采用的模型常数为 $\\beta$ 和 $\\sigma_{\\omega 2}$。目标是设计一个计算序列，以防止除零错误、防止中间项的上溢和下溢，并最小化灾难性抵消。\n\n使用以下标准的SST混合定义：\n$$\nF_1 = \\tanh\\left(\\operatorname{arg}_1^4\\right), \\quad F_2 = \\tanh\\left(\\operatorname{arg}_2^2\\right),\n$$\n其中\n$$\n\\operatorname{arg}_2 = \\max\\!\\left(\\frac{\\sqrt{k}}{\\beta \\,\\omega\\, y}, \\frac{500 \\,\\nu}{y^2 \\,\\omega}\\right),\n$$\n$$\n\\operatorname{arg}_1 = \\min\\!\\left(\\operatorname{arg}_2, \\frac{4 \\,\\rho \\,\\sigma_{\\omega 2} \\,k}{C_{D_{k\\omega}}\\, y^2}\\right),\n$$\n以及交叉扩散项\n$$\nC_{D_{k\\omega}} = \\max\\!\\left( \\frac{2 \\,\\rho \\,\\sigma_{\\omega 2}\\, S_{k\\omega}}{\\omega}, \\, C_{D,\\min} \\right).\n$$\n\n您的算法必须：\n-   通过适当的下限强制物理上要求的非负性（例如，$k \\geq 0$, $\\nu > 0$, $y > 0$, $\\rho > 0$）。\n-   将任何可能奇异的除法替换为安全逆运算，以保证对所有允许的输入都有有限的输出。\n-   将中间量限制在双曲正切函数数值稳定的范围内，并证明由于 $\\tanh$ 的饱和特性，此类限制不会改变物理意图。\n-   通过选择数值上有利的求值顺序，并在涉及梯度缩并时避免相减抵消，来避免灾难性抵消。\n\n您必须在解决方案中明确实现这些安全保障措施，并对每一项进行数学上的论证。该算法必须表示为一个确定性的操作序列，给定输入 $(k,\\omega,\\nu,y,\\rho,S_{k\\omega})$ 和常数 $(\\beta,\\sigma_{\\omega 2})$，返回 $(F_1,F_2)$。\n\n使用以下常数值：$\\beta = 0.075$，$\\sigma_{\\omega 2} = 0.856$，以及 $C_{D,\\min} = 10^{-10}$。\n\n单位：\n-   $k$ 的单位是 $\\mathrm{m^2/s^2}$，\n-   $\\omega$ 的单位是 $\\mathrm{s^{-1}}$，\n-   $\\nu$ 的单位是 $\\mathrm{m^2/s}$，\n-   $y$ 的单位是 $\\mathrm{m}$，\n-   $\\rho$ 的单位是 $\\mathrm{kg/m^3}$，\n-   $S_{k\\omega}$ 的单位是 $\\mathrm{s^{-3}}$。\n输出 $F_1$ 和 $F_2$ 是无量纲的，并且必须作为浮点数返回。\n\n设计一个包含以下参数集的测试套件。对于每个测试用例，计算并返回一对 $[F_1,F_2]$：\n-   案例 $1$（正常路径，中等数值）：\n  -   $k = 0.5$, $\\omega = 1000$, $\\nu = 10^{-5}$, $y = 10^{-3}$, $\\rho = 1.225$, $S_{k\\omega} = 10$。\n-   案例 $2$（边界：壁面距离趋近于零）：\n  -   $k = 0.3$, $\\omega = 800$, $\\nu = 1.5 \\times 10^{-5}$, $y = 0$, $\\rho = 1.0$, $S_{k\\omega} = 5$。\n-   案例 $3$（边界：比耗散率趋近于零）：\n  -   $k = 0.1$, $\\omega = 0$, $\\nu = 10^{-5}$, $y = 5 \\times 10^{-4}$, $\\rho = 1.0$, $S_{k\\omega} = 1$。\n-   案例 $4$（边缘：由数值过冲导致的负输入）：\n  -   $k = -10^{-6}$, $\\omega = -100$, $\\nu = 10^{-5}$, $y = 2 \\times 10^{-4}$, $\\rho = 1.2$, $S_{k\\omega} = -0.1$。\n-   案例 $5$（饱和：大 $k$ 和极小 $y$）：\n  -   $k = 100$, $\\omega = 1$, $\\nu = 10^{-5}$, $y = 10^{-6}$, $\\rho = 1.0$, $S_{k\\omega} = 10^{-6}$。\n-   案例 $6$（交叉扩散项下限激活）：\n  -   $k = 0.05$, $\\omega = 50$, $\\nu = 10^{-6}$, $y = 2 \\times 10^{-3}$, $\\rho = 1.0$, $S_{k\\omega} = 0$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个逗号分隔的列表的列表形式的结果，每个内部列表包含一个测试用例的两个浮点值 $F_1$ 和 $F_2$，外部列表包含所有案例。例如，它应该看起来像：\n$$\n\\left[ [F_{1,1}, F_{2,1}], [F_{1,2}, F_{2,2}], \\dots, [F_{1,6}, F_{2,6}] \\right].\n$$", "solution": "问题是为剪切应力输运（SST）模型的混合函数 $F_1$ 和 $F_2$ 推导并实现一个数值鲁棒的算法，该算法从它们的标准定义出发。目标是创建一个计算序列，该序列能够抵抗数值病态，如除零、上溢和下溢。这些问题在计算流体动力学（CFD）模拟中很常见，尤其是在边界区域或数值条件具有挑战性的情况下。\n\n混合函数 $F_1$ 和 $F_2$ 是SST模型能够在近壁区域的$k$-$\\omega$模型和自由流中的$k$-$\\epsilon$模型之间切换能力的核心。这种过渡必须平滑且表现良好。这些函数定义如下：\n$$\nF_1 = \\tanh\\left(\\operatorname{arg}_1^4\\right)\n$$\n$$\nF_2 = \\tanh\\left(\\operatorname{arg}_2^2\\right)\n$$\n参数 $\\operatorname{arg}_1$ 和 $\\operatorname{arg}_2$ 由局部流动变量构成。鲁棒算法的推导涉及对每个组件计算的逐步分析，识别潜在的数值不稳点并引入适当的安全措施。使用的常数为 $\\beta = 0.075$，$\\sigma_{\\omega 2} = 0.856$，以及 $C_{D,\\min} = 10^{-10}$。\n\n**1. 保障主变量的安全性**\n\n物理量必须遵守某些约束：湍动能 $k \\ge 0$，比耗散率 $\\omega > 0$，运动粘度 $\\nu > 0$，壁面距离 $y > 0$，以及密度 $\\rho > 0$。由于离散化误差或过冲，数值求解器有时会为本应为正的量产生小的负值。此外，$\\omega$ 或 $y$ 的零值将导致除零错误。\n\n为处理此问题，我们引入了主变量的经过安全保障（裁剪）的版本。我们定义一个小的正常数 $\\epsilon$，作为出现在分母中的量的下限。$\\epsilon$ 的一个实用选择是像 $10^{-12}$ 这样的值，它小到不会影响物理，但大到足以防止浮点异常。\n\n-   $k_s = \\max(k, 0.0)$: 湍动能不能为负。这确保了 $\\sqrt{k}$ 是有定义的。\n-   $\\omega_s = \\max(\\omega, \\epsilon)$: 防止除零或一个可能导致上溢的非常小的 $\\omega$。\n-   $y_s = \\max(y, \\epsilon)$: 防止在壁面边界上 $y=0$ 的单元格出现除零错误。\n-   $\\nu_s = \\max(\\nu, 0.0)$: 粘度必须为非负。\n-   $\\rho_s = \\max(\\rho, 0.0)$: 密度必须为非负。\n-   $S_{k\\omega}$: 项 $S_{k\\omega} = \\nabla k \\cdot \\nabla \\omega$ 是梯度的点积，可以是正、负或零。在此阶段不需要保障。\n\n**2. 交叉扩散项 $C_{D_{k\\omega}}$ 的鲁棒计算**\n\n交叉扩散项定义为：\n$$\nC_{D_{k\\omega}} = \\max\\left( \\frac{2 \\,\\rho \\,\\sigma_{\\omega 2}\\, S_{k\\omega}}{\\omega}, \\, C_{D,\\min} \\right)\n$$\n这里主要的数值风险是除以 $\\omega$。使用我们经过保障的 $\\omega_s$，计算变为：\n$$\nC_{D_{k\\omega}} = \\max\\left( \\frac{2 \\,\\rho_s \\,\\sigma_{\\omega 2}\\, S_{k\\omega}}{\\omega_s}, \\, C_{D,\\min} \\right)\n$$\n由于 $\\omega_s \\ge \\epsilon > 0$，除法总是安全的。如果 $S_{k\\omega}$ 为负，$\\max$ 的第一个参数将变为负数。与正常数 $C_{D,\\min} = 10^{-10}$ 的 $\\max$ 操作确保 $C_{D_{k\\omega}}$ 始终为正，这在物理上是必要的，并且对于其在后续步骤的分母中使用至关重要。这正确地处理了交叉扩散项否则可能为负的情况。\n\n**3. $\\operatorname{arg}_2$ 的鲁棒计算**\n\n参数 $\\operatorname{arg}_2$ 定义为：\n$$\n\\operatorname{arg}_2 = \\max\\!\\left(\\frac{\\sqrt{k}}{\\beta \\,\\omega\\, y}, \\frac{500 \\,\\nu}{y^2 \\,\\omega}\\right)\n$$\n我们代入经过保障的变量以获得鲁棒形式：\n$$\n\\operatorname{arg}_2 = \\max\\!\\left(\\frac{\\sqrt{k_s}}{\\beta \\,\\omega_s\\, y_s}, \\frac{500 \\,\\nu_s}{y_s^2 \\,\\omega_s}\\right)\n$$\n-   第一项的分母是 $\\beta \\,\\omega_s\\, y_s$。由于 $\\beta > 0$，$\\omega_s \\ge \\epsilon$，并且 $y_s \\ge \\epsilon$，分母的下界为 $\\beta \\epsilon^2$，从而防止除零。使用 $k_s$ 确保 $\\sqrt{k_s}$ 是实数。\n-   第二项的分母是 $y_s^2 \\,\\omega_s$。它的下界为 $\\epsilon^3$，也防止了除零。\n-   $\\max$ 操作确保 $\\operatorname{arg}_2 \\ge 0$。\n-   在 $y \\rightarrow 0$ 或 $\\omega \\rightarrow 0$ 的极限下，经过保障的 $y_s$ 或 $\\omega_s$ 变为 $\\epsilon$。分母变得非常小，导致 $\\operatorname{arg}_2$ 变得非常大。这是期望的物理行为，因为它将混合函数推向其壁面极限值。\n\n**4. $\\operatorname{arg}_1$ 的鲁棒计算**\n\n参数 $\\operatorname{arg}_1$ 的标准定义为：\n$$\n\\operatorname{arg}_1 = \\min\\!\\left(\\operatorname{arg}_2, \\frac{4 \\,\\rho \\,\\sigma_{\\omega 2} \\,k}{C_{D_{k\\omega}}\\, y^2}\\right)\n$$\n鲁棒版本是：\n$$\n\\operatorname{arg}_1 = \\min\\!\\left(\\operatorname{arg}_2, \\frac{4 \\,\\rho_s \\,\\sigma_{\\omega 2} \\,k_s}{C_{D_{k\\omega}}\\, y_s^2}\\right)\n$$\n-   分母 $C_{D_{k\\omega}}\\, y_s^2$ 保证为正，因为我们确保了 $C_{D_{k\\omega}} \\ge C_{D,\\min} > 0$ 和 $y_s \\ge \\epsilon > 0$。除法是安全的。\n-   使用 $k_s$ 和 $\\rho_s$ 确保分子为非负。\n-   与非负的 $\\operatorname{arg}_2$ 进行 $\\min$ 操作确保 $\\operatorname{arg}_1 \\ge 0$。\n\n**5. 带有饱和机制的 $F_1$ 和 $F_2$ 的鲁棒计算**\n\n最后一步是计算双曲正切函数：\n$$\nF_1 = \\tanh\\left(\\operatorname{arg}_1^4\\right), \\quad F_2 = \\tanh\\left(\\operatorname{arg}_2^2\\right)\n$$\n如果参数很大，计算 $\\operatorname{arg}_1^4$ 或 $\\operatorname{arg}_2^2$ 时可能会出现上溢问题。然而，$\\tanh(x)$ 函数对于大的正 $x$ 会饱和到 $1.0$。对于标准的双精度浮点数，当 $x \\gtrsim 20$ 时，$\\tanh(x) \\approx 1.0$。我们可以利用这个饱和特性来防止上溢，同时不改变最终结果。\n\n我们为 $\\tanh$ 的参数定义一个上限值 $X_{\\text{max}} = 20.0$。\n-   对于 $F_1$：我们可以计算 $\\tanh(\\min(\\operatorname{arg}_1^4, X_{\\text{max}}))$。一个更有效避免大指数运算的方法是直接对 $\\operatorname{arg}_1$ 设置上限。如果 $\\operatorname{arg}_1^4 > X_{\\text{max}}$，则 $\\operatorname{arg}_1 > X_{\\text{max}}^{1/4}$。令 $A_{1,\\text{lim}} = X_{\\text{max}}^{1/4} \\approx 2.115$。如果 $\\operatorname{arg}_1 > A_{1,\\text{lim}}$，我们可以直接设置 $F_1 = 1.0$。否则，我们计算 $F_1 = \\tanh(\\operatorname{arg}_1^4)$。\n-   对于 $F_2$：类似地，如果 $\\operatorname{arg}_2^2 > X_{\\text{max}}$，则 $\\operatorname{arg}_2 > X_{\\text{max}}^{1/2}$。令 $A_{2,\\text{lim}} = X_{\\text{max}}^{1/2} \\approx 4.472$。如果 $\\operatorname{arg}_2 > A_{2,\\text{lim}}$，我们可以直接设置 $F_2 = 1.0$。否则，我们计算 $F_2 = \\tanh(\\operatorname{arg}_2^2)$。\n\n这一系列操作提供了一个数值稳定且鲁棒的算法来计算SST混合函数，它尊重了它们的物理意图，同时避免了浮点运算的常见陷阱。\n\n**整合的算法序列：**\n给定输入 $(k, \\omega, \\nu, y, \\rho, S_{k\\omega})$ 和常数 $(\\beta, \\sigma_{\\omega 2}, C_{D,\\min})$：\n1.  定义 $\\epsilon = 10^{-12}$，$X_{\\text{max}} = 20.0$。\n2.  保障输入安全：$k_s = \\max(k, 0.0)$，$\\omega_s = \\max(\\omega, \\epsilon)$，$y_s = \\max(y, \\epsilon)$，$\\nu_s = \\max(\\nu, 0.0)$，$\\rho_s = \\max(\\rho, 0.0)$。\n3.  计算 $C_{D_{k\\omega}} = \\max(2.0 \\cdot \\rho_s \\cdot \\sigma_{\\omega 2} \\cdot S_{k\\omega} / \\omega_s, C_{D,\\min})$。\n4.  计算项 $T_{2a} = \\sqrt{k_s} / (\\beta \\cdot \\omega_s \\cdot y_s)$ 和 $T_{2b} = 500.0 \\cdot \\nu_s / (y_s^2 \\cdot \\omega_s)$。\n5.  设置 $\\operatorname{arg}_2 = \\max(T_{2a}, T_{2b})$。\n6.  计算项 $T_{1b} = (4.0 \\cdot \\rho_s \\cdot \\sigma_{\\omega 2} \\cdot k_s) / (C_{D_{k\\omega}} \\cdot y_s^2)$。\n7.  设置 $\\operatorname{arg}_1 = \\min(\\operatorname{arg}_2, T_{1b})$。\n8.  计算 $F_1$：如果 $\\operatorname{arg}_1 > X_{\\text{max}}^{1/4}$，则 $F_1 = 1.0$。否则，$F_1 = \\tanh(\\operatorname{arg}_1^4)$。\n9.  计算 $F_2$：如果 $\\operatorname{arg}_2 > X_{\\text{max}}^{1/2}$，则 $F_2 = 1.0$。否则，$F_2 = \\tanh(\\operatorname{arg}_2^2)$。\n10. 返回 $(F_1, F_2)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to compute SST blending functions for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path, moderate values\n        {\"k\": 0.5, \"omega\": 1000, \"nu\": 1e-5, \"y\": 1e-3, \"rho\": 1.225, \"S_komega\": 10},\n        # Case 2: boundary, wall distance approaching zero\n        {\"k\": 0.3, \"omega\": 800, \"nu\": 1.5e-5, \"y\": 0.0, \"rho\": 1.0, \"S_komega\": 5},\n        # Case 3: boundary, specific dissipation rate approaching zero\n        {\"k\": 0.1, \"omega\": 0.0, \"nu\": 1e-5, \"y\": 5e-4, \"rho\": 1.0, \"S_komega\": 1},\n        # Case 4: edge, negative inputs from numerical overshoot\n        {\"k\": -1e-6, \"omega\": -100, \"nu\": 1e-5, \"y\": 2e-4, \"rho\": 1.2, \"S_komega\": -0.1},\n        # Case 5: saturation, large k and very small y\n        {\"k\": 100, \"omega\": 1, \"nu\": 1e-5, \"y\": 1e-6, \"rho\": 1.0, \"S_komega\": 1e-6},\n        # Case 6: cross-diffusion floor activation\n        {\"k\": 0.05, \"omega\": 50, \"nu\": 1e-6, \"y\": 2e-3, \"rho\": 1.0, \"S_komega\": 0.0},\n    ]\n\n    # SST model constants\n    BETA = 0.075\n    SIGMA_OMEGA_2 = 0.856\n    CD_KOMEGA_MIN = 1e-10\n\n    results = []\n    for case in test_cases:\n        f1, f2 = compute_blending_functions(\n            k=case[\"k\"],\n            omega=case[\"omega\"],\n            nu=case[\"nu\"],\n            y=case[\"y\"],\n            rho=case[\"rho\"],\n            S_komega=case[\"S_komega\"],\n            beta=BETA,\n            sigma_omega_2=SIGMA_OMEGA_2,\n            cd_min=CD_KOMEGA_MIN\n        )\n        results.append([f1, f2])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    # Example: [[F1_1, F2_1], [F1_2, F2_2], ...]\n    print(f\"[{','.join(f'[{v1:.8f}, {v2:.8f}]' for v1, v2 in results)}]\")\n\ndef compute_blending_functions(k, omega, nu, y, rho, S_komega, beta, sigma_omega_2, cd_min):\n    \"\"\"\n    Computes the SST blending functions F1 and F2 with numerical safeguards.\n\n    Args:\n        k (float): Turbulent kinetic energy.\n        omega (float): Specific dissipation rate.\n        nu (float): Kinematic viscosity.\n        y (float): Wall-normal distance.\n        rho (float): Fluid density.\n        S_komega (float): Contraction of gradients (nabla k . nabla omega).\n        beta (float): SST model constant.\n        sigma_omega_2 (float): SST model constant.\n        cd_min (float): Floor for the cross-diffusion term.\n\n    Returns:\n        tuple[float, float]: The computed values of (F1, F2).\n    \"\"\"\n    \n    # Numerical safeguard constants\n    EPSILON = 1e-12  # Floor for quantities in denominators\n    TANH_ARG_MAX = 20.0 # Cap for tanh argument to prevent overflow\n\n    # 1. Safeguard primary variables\n    k_safe = max(k, 0.0)\n    omega_safe = max(omega, EPSILON)\n    y_safe = max(y, EPSILON)\n    nu_safe = max(nu, 0.0)\n    rho_safe = max(rho, 0.0)\n    \n    # 2. Calculate the cross-diffusion term CD_kw\n    cd_kw_term = (2.0 * rho_safe * sigma_omega_2 * S_komega) / omega_safe\n    cd_kw = max(cd_kw_term, cd_min)\n\n    # 3. Calculate arg2\n    # The denominators are guaranteed to be non-zero due to omega_safe and y_safe.\n    arg2_term_a = np.sqrt(k_safe) / (beta * omega_safe * y_safe)\n    \n    # Denominator for term b: y_safe^2 * omega_safe >= EPSILON^3\n    arg2_term_b = (500.0 * nu_safe) / (y_safe**2 * omega_safe)\n    \n    arg2 = max(arg2_term_a, arg2_term_b)\n\n    # 4. Calculate arg1\n    # Denominator for term b: cd_kw * y_safe^2 >= cd_min * EPSILON^2\n    arg1_term_b_num = 4.0 * rho_safe * sigma_omega_2 * k_safe\n    arg1_term_b_den = cd_kw * y_safe**2\n    arg1_term_b = arg1_term_b_num / arg1_term_b_den\n    \n    arg1 = min(arg2, arg1_term_b)\n\n    # 5. Calculate F1 and F2 with saturation to prevent overflow\n    # Cap arg1 to avoid overflow in arg1**4\n    arg1_cap_limit = TANH_ARG_MAX ** 0.25 # approx 2.115\n    if arg1 > arg1_cap_limit:\n        f1 = 1.0\n    else:\n        f1 = np.tanh(arg1**4)\n    \n    # Cap arg2 to avoid overflow in arg2**2\n    arg2_cap_limit = TANH_ARG_MAX ** 0.5 # approx 4.472\n    if arg2 > arg2_cap_limit:\n        f2 = 1.0\n    else:\n        f2 = np.tanh(arg2**2)\n        \n    return f1, f2\n\nsolve()\n```", "id": "3295913"}]}