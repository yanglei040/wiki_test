{"hands_on_practices": [{"introduction": "理论模型的构建往往始于对物理现象的观察和量化。本练习旨在模拟这一过程，通过分析源自直接数值模拟（DNS）的假设数据，来探索可压缩湍流中的一个核心物理机制。您将通过数据分析方法，检验并量化膨胀耗散与湍流马赫数之间的关系，这是发展可压缩性修正模型的经验基础。这项实践将锻炼您从复杂数据中提取关键物理标度率的能力，这是连接理论与实际应用的重要一步 [@problem_id:3302802]。", "problem": "考虑一种由可压缩纳维-斯托克斯方程和能量方程控制的可压缩牛顿流体。单位质量的黏性耗散率可以分解为螺线部分和膨胀部分。令 $\\epsilon$ 表示总耗散率，$\\epsilon_s$ 表示螺线耗散率，$\\epsilon_d$ 表示膨胀耗散率，其中膨胀贡献与速度散度的平方相关。在均匀剪切湍流中，在低湍流马赫数条件下，假设归一化膨胀耗散比与湍流马赫数呈二次方关系。将湍流马赫数 $M_t$ 定义为 $M_t = \\sqrt{2k}/a$，其中 $k$ 是单位质量的湍动能，$a$ 是声速。我们感兴趣的比率是 $R \\equiv \\epsilon_d/\\epsilon$，它是无量纲的。给定三个从均匀剪切湍流的合理直接数值模拟 (DNS) 中派生出的合成数据集，每个数据集都由 $M_t$ 和 $R$ 的配对值组成。所有量都是无量纲的，因此不需要进行物理单位转换。\n\n您的任务是完全在软件逻辑中实现以下过程：\n- 对于每个数据集，计算所有数据点 $i$ 的 $X_i = M_{t,i}^2$ 和 $Y_i = R_i$。\n- 通过约束于原点的最小二乘拟合来估计假设的 $M_t$ 二次方标度的比例系数。即，用零截距拟合 $Y_i$ 与 $X_i$ 的关系，并将斜率作为估计系数报告。\n- 同时，通过用斜率和截距拟合 $Y_i$ 与 $X_i$ 的关系，执行带有自由截距的无约束线性最小二乘拟合，以捕捉可能的非零偏移效应。\n- 使用根据 $Y_i$ 样本均值计算的决定系数 $R^2$ 来量化原点约束模型的拟合优度。\n- 使用以下接受准则，判断对于每个数据集，零截距的 $M_t$ 二次方标度是否可接受：当且仅当无约束拟合的截距绝对值小于 $5\\times 10^{-3}$ 且原点约束拟合的决定系数不小于 $0.98$ 时，接受该模型。\n\n使用以下数据集测试套件，每个数据集以有序列表对 $(\\{M_t\\},\\{R\\})$ 的形式给出：\n- 数据集 $\\mathsf{A}$（一般情况）：$M_t = [\\,0.05,0.10,0.20,0.30,0.40\\,]$, $R = [\\,0.00355,0.01400,0.05800,0.13200,0.23500\\,]$。\n- 数据集 $\\mathsf{B}$（$M_t$ 接近零的边界情况）：$M_t = [\\,0.01,0.02,0.03,0.05\\,]$, $R = [\\,0.00015,0.00045,0.00095,0.00255\\,]$。\n- 数据集 $\\mathsf{C}$（趋势不由 $M_t^2$ 主导的边缘情况）：$M_t = [\\,0.20,0.40,0.60,0.80\\,]$, $R = [\\,0.15,0.25,0.35,0.45\\,]$。\n\n您的程序必须为每个数据集计算一个形式为 $[\\,C_{\\mathrm{origin}},C_{\\mathrm{free}},b_0,R^2_{\\mathrm{origin}},\\mathrm{accept}\\,]$ 的结果列表，其中 $C_{\\mathrm{origin}}$ 是原点约束斜率，$C_{\\mathrm{free}}$ 是无约束斜率，$b_0$ 是无约束截距，$R^2_{\\mathrm{origin}}$ 是原点约束拟合的决定系数，$\\mathrm{accept}$ 是一个布尔值，指示是否满足接受准则。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个数据集的结果，以逗号分隔的列表形式封装在方括号内，且不含空格。每个数据集的结果本身必须是一个方括号封装的列表 $[\\,C_{\\mathrm{origin}},C_{\\mathrm{free}},b_0,R^2_{\\mathrm{origin}},\\mathrm{accept}\\,]$，并严格遵守此顺序。例如，输出格式必须为 $[[\\dots],[\\dots],[\\dots]]$，且任何地方都不能有空格。\n\n所有报告的量均为无量纲。不涉及角度。所有数值输出必须是小数。布尔值输出必须是 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "solution": "该问题是有效的。它在可压缩湍流建模领域有科学依据，作为一个数据分析任务，其提法是适定的，并且给出了客观、明确的标准。所提供的数据和参数是自洽且一致的。\n\n核心任务是检验膨胀耗散比 $R \\equiv \\epsilon_d/\\epsilon$ 与湍流马赫数 $M_t$ 的平方成正比这一假设。假设的关系是 $R = C M_t^2$，其中 $C$ 是某个比例常数。这将针对三个不同的数据集进行评估。该过程涉及变量转换、执行两种类型的线性回归、量化拟合优度以及应用一个既定的接受准则。\n\n首先，我们通过对给定数据集中的每个数据点 $i$ 设置 $Y_i = R_i$ 和 $X_i = M_{t,i}^2$ 来线性化假设的关系。模型变成一个简单的线性关系 $Y = C X$。\n\n我们需要对数据对 $(X_i, Y_i)$ 执行两次独立的线性最小二乘拟合。\n\n第一次拟合被约束通过原点，这与物理假设一致，即当 $M_t=0$ 时，膨胀耗散应为零 ($R=0$)。模型为 $Y_i = C_{\\mathrm{origin}} X_i$。斜率 $C_{\\mathrm{origin}}$ 是通过最小化残差平方和 $S = \\sum_{i=1}^{n} (Y_i - C_{\\mathrm{origin}} X_i)^2$ 来找到的，其中 $n$ 是数据点的数量。最小化 $S$ 的 $C_{\\mathrm{origin}}$ 值由以下公式给出：\n$$ C_{\\mathrm{origin}} = \\frac{\\sum_{i=1}^{n} X_i Y_i}{\\sum_{i=1}^{n} X_i^2} $$\n\n第二次拟合是无约束线性回归，它包含一个截距项 $b_0$。模型为 $Y_i = C_{\\mathrm{free}} X_i + b_0$。这种拟合有助于检测数据中任何与理想化模型相矛盾的系统性偏移。系数 $C_{\\mathrm{free}}$ 和 $b_0$ 是通过最小化残差平方和 $S = \\sum_{i=1}^{n} (Y_i - (C_{\\mathrm{free}} X_i + b_0))^2$ 来确定的。这个最小化问题的标准解是：\n$$ C_{\\mathrm{free}} = \\frac{n \\sum_{i=1}^{n} X_i Y_i - \\left(\\sum_{i=1}^{n} X_i\\right)\\left(\\sum_{i=1}^{n} Y_i\\right)}{n \\sum_{i=1}^{n} X_i^2 - \\left(\\sum_{i=1}^{n} X_i\\right)^2} $$\n$$ b_0 = \\bar{Y} - C_{\\mathrm{free}} \\bar{X} $$\n其中 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 和 $\\bar{Y} = \\frac{1}{n} \\sum_{i=1}^{n} Y_i$ 是样本均值。\n\n为了评估原点约束模型，我们计算其决定系数 $R^2_{\\mathrm{origin}}$。按照规定，这是相对于围绕 $Y_i$ 样本均值的总平方和来计算的。这是一个关键细节，因为对于没有截距的模型，存在多种 $R^2$ 的定义。指定的定义是：\n$$ R^2_{\\mathrm{origin}} = 1 - \\frac{\\mathrm{SS}_{\\mathrm{res}}}{\\mathrm{SS}_{\\mathrm{tot}}} = 1 - \\frac{\\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2}{\\sum_{i=1}^{n} (Y_i - \\bar{Y})^2} $$\n其中 $\\hat{Y}_i = C_{\\mathrm{origin}} X_i$ 是来自原点约束模型的预测值。一个接近 1 的 $R^2$ 值表明该模型解释了数据中很大一部分的方差。\n\n最后，应用一个决策规则来确定原点约束的二次标度对于每个数据集是否是一个可接受的模型。当且仅当同时满足两个条件时，该模型被接受：\n1. 无约束拟合的截距的绝对值可忽略不计，具体为 $|b_0|  5 \\times 10^{-3}$。\n2. 原点约束模型提供了良好的拟合，具体为 $R^2_{\\mathrm{origin}} \\ge 0.98$。\n\n整个过程将在一个程序中实现，该程序处理所提供的三个数据集（$\\mathsf{A}$、$\\mathsf{B}$ 和 $\\mathsf{C}$）中的每一个，并为每种情况输出计算出的参数 $[\\,C_{\\mathrm{origin}}, C_{\\mathrm{free}}, b_0, R^2_{\\mathrm{origin}}, \\mathrm{accept}\\,]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import stats # Scipy is allowed but not strictly necessary for this problem.\n\ndef solve():\n    \"\"\"\n    Main function to process datasets and print the final result.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        (\n            [0.05, 0.10, 0.20, 0.30, 0.40],\n            [0.00355, 0.01400, 0.05800, 0.13200, 0.23500]\n        ),\n        # Dataset B\n        (\n            [0.01, 0.02, 0.03, 0.05],\n            [0.00015, 0.00045, 0.00095, 0.00255]\n        ),\n        # Dataset C\n        (\n            [0.20, 0.40, 0.60, 0.80],\n            [0.15, 0.25, 0.35, 0.45]\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        mt_data, r_data = case\n        result = analyze_dataset(mt_data, r_data)\n        results.append(result)\n\n    # Format the final output string as per requirements.\n    # Each sub-list is formatted as a string, then joined by commas.\n    result_strings = []\n    for res_list in results:\n        # str() correctly handles floats and booleans (e.g., True - \"True\")\n        list_str = f\"[{','.join(map(str, res_list))}]\"\n        result_strings.append(list_str)\n    \n    # Final print statement in the exact required format: [[...],[...],[...]]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef analyze_dataset(mt_data, r_data):\n    \"\"\"\n    Performs the required analysis for a single dataset.\n    \n    Args:\n        mt_data (list): A list of turbulent Mach numbers (M_t).\n        r_data (list): A list of dilatational dissipation ratios (R).\n\n    Returns:\n        list: A list containing [C_origin, C_free, b0, R2_origin, accept].\n    \"\"\"\n    # Convert lists to NumPy arrays for vectorized operations.\n    mt = np.array(mt_data, dtype=float)\n    r = np.array(r_data, dtype=float)\n    \n    # Step 1: Compute X_i = M_{t,i}^2 and Y_i = R_i.\n    x = mt**2\n    y = r\n    \n    # Step 2: Estimate the origin-constrained slope C_origin.\n    # C_origin = sum(X*Y) / sum(X^2)\n    sum_xy = np.sum(x * y)\n    sum_x_sq = np.sum(x**2)\n    c_origin = sum_xy / sum_x_sq\n    \n    # Step 3: Perform unconstrained linear fit to get C_free and b0.\n    # Y = C_free * X + b0\n    # A robust way is to use np.polyfit.\n    c_free, b0 = np.polyfit(x, y, 1)\n\n    # Step 4: Quantify goodness of fit of the origin-constrained model.\n    # R2_origin = 1 - SS_res / SS_tot\n    y_mean = np.mean(y)\n    ss_tot = np.sum((y - y_mean)**2)\n    # Handle the case where all Y values are the same (SS_tot = 0) to avoid division by zero.\n    if ss_tot == 0:\n        y_pred_origin = c_origin * x\n        # If model is perfect, SS_res is 0. If not, R^2 is undefined or -inf.\n        # Given the problem context, this case is unlikely, but good practice to handle.\n        # If y is constant and the model is not also constant at that value, the fit is poor.\n        ss_res = np.sum((y - y_pred_origin)**2)\n        r2_origin = 1.0 if ss_res == 0 else -np.inf \n    else:\n        y_pred_origin = c_origin * x\n        ss_res = np.sum((y - y_pred_origin)**2)\n        r2_origin = 1.0 - (ss_res / ss_tot)\n        \n    # Step 5: Apply the acceptance rule.\n    # accept if |b0|  5e-3 AND R2_origin >= 0.98\n    is_intercept_small = np.abs(b0)  5e-3\n    is_fit_good = r2_origin >= 0.98\n    accept = is_intercept_small and is_fit_good\n    \n    return [c_origin, c_free, b0, r2_origin, accept]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3302802"}, {"introduction": "在前一个练习中，我们从数据中验证了湍流马赫数 $M_t$ 的重要性，现在我们将从数据分析转向理论模型的构建。本练习要求您基于一系列物理和数学约束（如低马赫数下的渐近行为和有界性），从第一性原理推导出一个阻尼函数。这项技能是湍流模型开发者的核心能力，它展示了如何将物理直觉转化为可在计算流体力学（CFD）代码中稳健使用的数学形式 [@problem_id:3302839]。", "problem": "考虑用于可压缩理想气体的雷诺平均纳维-斯托克斯 (RANS) $k\\text{-}\\omega$ 湍流模型，其中涡粘度通过 Boussinesq 假设建模为 $\\mu_{t} = \\rho \\, k \\, \\alpha^{*} / \\omega$，其中 $\\alpha^{*}$ 是一个可能包含可压缩性效应的有效系数。令湍流马赫数定义为 $M_{t} = \\sqrt{2 k} / a$，其中 $k$ 是湍动能，$a = \\sqrt{\\gamma R T}$ 是理想气体的声速，$\\gamma$ 是比热比，$R$ 是比气体常数，$T$ 是绝对温度。\n\n在高速流动中，可压缩性引入了额外的膨胀效应，从而改变了湍流动力学。具体而言，湍动能的耗散可以分解为螺线部分和膨胀部分，对于弱可压缩湍流，膨胀耗散与某个合适的马赫数的平方成比例。因此，未考虑此效应的涡粘性封闭可能会在较高的 $M_{t}$ 值下过高预测湍流输运。\n\n从以下基本依据出发：\n- 理想气体声速关系 $a = \\sqrt{\\gamma R T}$，\n- 定义 $M_{t} = \\sqrt{2 k} / a$，\n- $k\\text{-}\\omega$ 建模中耗散和时间尺度的量纲一致性，其中比耗散率 $\\omega$ 代表湍流时间尺度的倒数，\n- 在弱可压缩极限下，主阶可压缩性修正以 $\\mathcal{O}(M_{t}^{2})$ 形式出现的观察，\n\n推导一个无量纲的、依赖于马赫数的阻尼函数 $f(M_{t})$，该函数以乘法形式应用于 $k\\text{-}\\omega$ 模型中的涡粘性系数 $C_{\\mu}$ 或耗散系数 $\\beta^{*}$，并满足以下所有约束条件：\n- 低马赫数渐近性：$f(0) = 1$ 和 $f'(0) = 0$，与不可压缩行为以及不存在关于 $M_{t}$ 的线性修正项一致。\n- 单调性与有界性：对于所有 $M_{t} \\geq 0$，有 $0  f(M_{t}) \\leq 1$，并且 $f(M_{t})$ 在 $M_{t}$ 上严格单调递减。\n- 高马赫数极限行为：当 $M_{t} \\to \\infty$ 时，$f(M_{t}) \\to 0$，从而在高湍流马赫数下涡粘度受到限制。\n- 单参数控制：该函数包含一个单一的正参数 $M_{c}$，其解释为当 $M_{t} = M_{c}$ 时，$f(M_{t})$ 的值减小到 $1/2$。\n\n请提供满足上述标准并与弱可压缩极限下膨胀效应的 $\\mathcal{O}(M_{t}^{2})$ 标度关系一致的最简单的闭式解析表达式 $f(M_{t})$。您的最终答案必须是用 $M_{t}$ 和 $M_{c}$ 表示的这个显式函数 $f(M_{t})$。无需进行数值计算，最终表达式中不应包含单位。", "solution": "该问题要求推导一个用于可压缩湍流建模的无量纲阻尼函数 $f(M_{t})$。该函数必须满足一系列特定的数学和物理约束，这些约束源于湍流在高速下的行为。湍流马赫数 $M_{t}$ 定义为 $M_{t} = \\sqrt{2k}/a$，其中 $k$ 是湍动能，$a$ 是声速。\n\n函数 $f(M_{t})$ 的约束条件如下：\n1.  低马赫数渐近性：$f(0) = 1$ 和 $f'(0) = 0$。\n2.  单调性与有界性：对于所有 $M_{t} \\geq 0$，有 $0  f(M_{t}) \\leq 1$，并且对于 $M_{t} > 0$，$f(M_{t})$ 必须严格单调递减。\n3.  高马赫数极限行为：$\\lim_{M_{t} \\to \\infty} f(M_{t}) = 0$。\n4.  参数化：函数必须包含一个单一的正参数 $M_{c}$，使得 $f(M_{c}) = 1/2$。\n5.  物理标度：函数必须与主阶可压缩性修正的量级为 $\\mathcal{O}(M_{t}^{2})$ 这一特性一致。\n\n让我们通过系统地结合这些约束来构造该函数。\n\n第五个约束，即关于 $\\mathcal{O}(M_{t}^{2})$ 标度的约束，是至关重要的。它意味着对于较小的 $M_{t}$ 值，函数 $f(M_{t})$ 应能通过其在 $M_{t}=0$ 附近的泰勒级数展开得到很好的近似。将其与第一个约束 $f(0)=1$ 和 $f'(0)=0$ 相结合，泰勒级数必须具有以下形式：\n$$\nf(M_{t}) = f(0) + f'(0) M_{t} + \\frac{f''(0)}{2!} M_{t}^{2} + \\mathcal{O}(M_{t}^{3}) = 1 + 0 \\cdot M_{t} + C M_{t}^{2} + \\dots\n$$\n其中 $C = f''(0)/2$ 是一个常数。不存在 $M_{t}$ 的线性项与 $f'(0)=0$ 一致。为使函数在 $M_{t}>0$ 时严格单调递减，$f'(0)$ 之后的第一个非零导数必须表明在最大值点处向下凹，即 $f''(0)  0$，这意味着 $C  0$。这确保了对于小的正 $M_t$，$f(M_t)$ 小于 $1$。\n\n鉴于在低马赫数下该函数的行为由 $M_{t}^{2}$ 决定，因此寻求一个仅通过 $M_{t}^{2}$ 依赖于 $M_{t}$ 的函数是合乎逻辑的。我们来提出一种函数形式，它满足界于 $0$ 和 $1$ 之间、从 $f(0)=1$ 开始、并在 $M_{t} \\to \\infty$ 时衰减到零的约束。对于这样的函数，一个简单而有效的选择是有理函数。我们寻求最简单的此类函数。\n\n考虑以下形式的函数：\n$$\nf(M_{t}) = \\frac{1}{1 + g(M_{t}^{2})}\n$$\n为了使该函数满足 $f(0)=1$，我们必须有 $g(0)=0$。为了满足 $\\lim_{M_{t} \\to \\infty} f(M_{t}) = 0$，我们必须有 $\\lim_{M_{t} \\to \\infty} g(M_{t}^{2}) = \\infty$。满足 $g(0)=0$ 的最简单的可能函数 $g(x)$ 是一个线性函数，$g(x) = A x$，其中 $A$ 为某个常数。代入 $x = M_{t}^{2}$，我们提出以下候选函数：\n$$\nf(M_{t}) = \\frac{1}{1 + A M_{t}^{2}}\n$$\n其中 $A$ 是一个待定常数。我们来根据约束条件验证此候选函数。\n-   $f(0) = \\frac{1}{1+0} = 1$。（约束1，第1部分，满足）。\n-   导数为 $f'(M_{t}) = -\\frac{2 A M_{t}}{(1 + A M_{t}^{2})^{2}}$。在 $M_{t}=0$ 时，我们得到 $f'(0)=0$。（约束1，第2部分，满足）。\n-   为使函数在 $M_{t}>0$ 时严格单调递减，我们需要 $f'(M_{t})  0$。由于 $M_{t}>0$ 且分母恒为正，这要求 $A > 0$。\n-   如果 $A>0$，那么对于 $M_{t} > 0$，分母 $1+AM_{t}^{2} > 1$，这确保了 $0  f(M_{t})  1$。在 $M_{t}=0$ 时，$f(0)=1$。因此，对于所有 $M_{t} \\geq 0$，有 $0  f(M_{t}) \\leq 1$。（约束2满足，前提是 $A>0$）。\n-   $\\lim_{M_{t} \\to \\infty} \\frac{1}{1 + A M_{t}^{2}} = 0$。（约束3满足，前提是 $A>0$）。\n-   对于小的 $M_{t}$，其泰勒展开为 $(1+AM_{t}^{2})^{-1} = 1 - A M_{t}^{2} + A^{2} M_{t}^{4} - \\dots$，这显示了 $\\mathcal{O}(M_{t}^{2})$ 的主阶修正项。（约束5满足）。\n\n所提出的形式 $f(M_{t}) = \\frac{1}{1+AM_{t}^{2}}$ (其中 $A>0$) 与除涉及 $M_{c}$ 的参数化之外的所有约束都一致。我们现在使用第四个约束 $f(M_{c}) = 1/2$ 来确定常数 $A$。\n$$\nf(M_{c}) = \\frac{1}{1 + A M_{c}^{2}} = \\frac{1}{2}\n$$\n求解 $A$：\n$$\n1 + A M_{c}^{2} = 2\n$$\n$$\nA M_{c}^{2} = 1\n$$\n$$\nA = \\frac{1}{M_{c}^{2}}\n$$\n由于 $M_{c}$ 是一个正参数，因此 $A > 0$，这与我们先前的发现一致。\n\n将这个 $A$ 的表达式代回我们的候选函数，得到最终形式：\n$$\nf(M_{t}) = \\frac{1}{1 + \\frac{1}{M_{c}^{2}} M_{t}^{2}}\n$$\n这可以更优雅地写成：\n$$\nf(M_{t}) = \\frac{1}{1 + \\left(\\frac{M_{t}}{M_{c}}\\right)^{2}}\n$$\n该函数是一个简单的闭式解析表达式，满足所有陈述的标准。它是 $M_{t}^{2}$ 的有理函数，正确地捕捉了低马赫数和高马赫数下的渐近行为，并按规定包含了单个参数 $M_{c}$。这种形式在开发湍流模型的可压缩性修正中很常见。", "answer": "$$\\boxed{\\frac{1}{1 + \\left(\\frac{M_{t}}{M_{c}}\\right)^{2}}}$$", "id": "3302839"}, {"introduction": "在构建了可压缩性修正模型后，最后一步是考虑其在代码中的实际实现。本练习关注一个关键但常被忽视的方面：数值稳定性。它揭示了引入新的物理项（如依赖于马赫数的阻尼函数）会如何给控制方程带来数值刚性。通过本练习，您将学习如何分析这种刚性，并为显式时间积分方案推导出相应的时间步长限制，从而确保计算的稳定性和可靠性 [@problem_id:3302823]。", "problem": "考虑可压缩湍流中的单个、充分混合的控制体，该控制体由用于湍动能 ($k$) 和湍流耗散率 ($\\epsilon$) 的雷诺平均纳维-斯托克斯 (RANS) 两方程湍流模型进行建模。忽略对流和分子扩散，齐次纯源项常微分方程组为\n$$\n\\frac{dk}{dt} \\;=\\; P_k \\;-\\; \\epsilon,\n\\qquad\n\\frac{d\\epsilon}{dt} \\;=\\; C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} \\;-\\; C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon^2}{k},\n$$\n其中 $P_k$ 是湍动能生成项，$C_{\\epsilon 1}$ 和 $C_{\\epsilon 2}$ 是正常数模型常数，$f(M_t)$ 是与马赫数相关的可压缩性修正。假设采用一种常用的代数阻尼形式\n$$\nf(M_t) \\;=\\; 1 \\;+\\; \\beta\\,M_t^2,\n\\qquad \nM_t \\;=\\; \\frac{\\sqrt{2k}}{a},\n$$\n其中 $M_t$ 是湍流马赫数，$\\beta$ 是一个正常系数，$a$ 是当地声速。\n\n您将检验由 $f(M_t)$ 引入的刚性，并为应用于上述系统的显式前向欧拉时间积分方法推导时间步长限制。具体而言，请基于以下经过充分检验的基础进行：\n- 纯源项半离散系统 $\\dot{\\mathbf{U}}=\\mathbf{R}(\\mathbf{U})$（其中 $\\mathbf{U}=[k,\\epsilon]^T$）和前向欧拉更新 $\\mathbf{U}^{n+1}=\\mathbf{U}^n+\\Delta t\\,\\mathbf{R}(\\mathbf{U}^n)$ 是线性稳定的，条件是在局部线性化 $\\mathbf{R}(\\mathbf{U})\\approx \\mathbf{J}(\\mathbf{U}^n)(\\mathbf{U}-\\mathbf{U}^n)$ 后，雅可比矩阵 $\\mathbf{J}(\\mathbf{U}^n)$ 的所有特征值 $\\lambda$ 都满足 $|1+\\Delta t\\,\\lambda| \\le 1$。\n- 湍流马赫数定义 $M_t=\\sqrt{2k}/a$ 和函数依赖关系 $f(M_t)=1+\\beta M_t^2$。\n\n假设在时间层 $n$ 有以下参数值和瞬时状态：\n- $C_{\\epsilon 1}=1.44$, $C_{\\epsilon 2}=1.92$, $\\beta=1.5$,\n- $a = 340\\,\\mathrm{m/s}$,\n- $k^n = 5.2\\times 10^3\\,\\mathrm{m}^2/\\mathrm{s}^2$, $\\epsilon^n = 5.2\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$,\n- $P_k^n = 4.16\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$.\n\n任务：\n1) 推导 $2\\times 2$ 雅可比矩阵 $\\mathbf{J}=\\partial \\mathbf{R}/\\partial \\mathbf{U}$，明确利用 $f$ 通过 $M_t$ 对 $k$ 的依赖关系，并在给定状态下计算 $\\mathbf{J}$ 的值。\n2) 计算 $\\mathbf{J}$ 的特征值，并确定使前向欧拉方法线性稳定的最大时间步长 $\\Delta t_{\\max}$。\n3) 简要说明一种侵入性最小的隐式处理方法，该方法可以消除源于马赫数相关阻尼的刚性，而无需对整个系统进行全隐式耦合（您的提议本身无需进行数值计算）。\n\n以毫秒为单位表示最终的 $\\Delta t_{\\max}$，并将答案四舍五入至三位有效数字。最终答案必须是单个实数。在最终的方框答案中不要包含单位，但在您的推理和中间步骤展示中请使用毫秒。", "solution": "用户要求分析一个简化的两方程湍流模型的数值刚性，并推导相应的显式时间步长限制。该问题在计算流体动力学和数值分析方面具有科学依据，是适定的，并包含了所有必要数据。所提供的物理参数是一致且符合实际的。因此，该问题被认为是有效的。\n\n该常微分方程组由 $\\dot{\\mathbf{U}}=\\mathbf{R}(\\mathbf{U})$ 给出，其中状态向量为 $\\mathbf{U}=[k, \\epsilon]^T$，源向量 $\\mathbf{R}=[R_k, R_\\epsilon]^T$ 为：\n$$\nR_k(k, \\epsilon) = P_k - \\epsilon\n$$\n$$\nR_\\epsilon(k, \\epsilon) = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon^2}{k}\n$$\n可压缩性修正函数为 $f(M_t) = 1 + \\beta\\,M_t^2$，其中湍流马赫数的平方为 $M_t^2 = 2k/a^2$。我们可以将其代入 $R_\\epsilon$ 的表达式中：\n$$\nR_\\epsilon(k, \\epsilon) = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\left(1 + \\frac{2\\beta k}{a^2}\\right)\\,\\frac{\\epsilon^2}{k} = C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\n$$\n\n**1) 雅可比矩阵的推导与求值**\n\n雅可比矩阵 $\\mathbf{J}$ 定义为 $\\mathbf{J} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{U}} = \\begin{pmatrix} \\partial R_k / \\partial k  \\partial R_k / \\partial \\epsilon \\\\ \\partial R_\\epsilon / \\partial k  \\partial R_\\epsilon / \\partial \\epsilon \\end{pmatrix}$。在时间层 $n$，$P_k^n$ 被视为一个常数参数。\n\n第一行的元素为：\n$$\nJ_{11} = \\frac{\\partial R_k}{\\partial k} = \\frac{\\partial}{\\partial k}(P_k - \\epsilon) = 0\n$$\n$$\nJ_{12} = \\frac{\\partial R_k}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon}(P_k - \\epsilon) = -1\n$$\n\n第二行的元素由 $R_\\epsilon$ 的展开式导出：\n$$\nJ_{21} = \\frac{\\partial R_\\epsilon}{\\partial k} = \\frac{\\partial}{\\partial k}\\left(C_{\\epsilon 1}\\,P_k\\,\\epsilon\\,k^{-1} - C_{\\epsilon 2}\\,\\epsilon^2\\,k^{-1} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\\right) = -C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k^2} + C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k^2} = \\frac{\\epsilon}{k^2}(C_{\\epsilon 2}\\,\\epsilon - C_{\\epsilon 1}\\,P_k)\n$$\n$$\nJ_{22} = \\frac{\\partial R_\\epsilon}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon}\\left(C_{\\epsilon 1}\\,\\frac{P_k\\,\\epsilon}{k} - C_{\\epsilon 2}\\,\\frac{\\epsilon^2}{k} - C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon^2\\right) = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{\\epsilon}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{2\\beta}{a^2}\\,\\epsilon\n$$\n对 $J_{22}$ 进行因式分解并识别出 $f(M_t) = 1 + 2\\beta k/a^2$，我们得到更紧凑的形式：\n$$\nJ_{22} = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,\\frac{\\epsilon}{k}\\left(1 + \\frac{2\\beta k}{a^2}\\right) = C_{\\epsilon 1}\\,\\frac{P_k}{k} - 2\\,C_{\\epsilon 2}\\,f(M_t)\\,\\frac{\\epsilon}{k}\n$$\n因此，雅可比矩阵为：\n$$\n\\mathbf{J} = \\begin{pmatrix} 0  -1 \\\\ \\frac{\\epsilon}{k^2}(C_{\\epsilon 2}\\,\\epsilon - C_{\\epsilon 1}\\,P_k)  \\frac{1}{k}(C_{\\epsilon 1}\\,P_k - 2\\,C_{\\epsilon 2}\\,f(M_t)\\,\\epsilon) \\end{pmatrix}\n$$\n我们现在在给定的状态 $n$ 处计算 $\\mathbf{J}$ 的值：$k^n = 5.2\\times 10^3\\,\\mathrm{m}^2/\\mathrm{s}^2$, $\\epsilon^n = 5.2\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$, $P_k^n = 4.16\\times 10^6\\,\\mathrm{m}^2/\\mathrm{s}^3$, $C_{\\epsilon 1}=1.44$, $C_{\\epsilon 2}=1.92$, $\\beta=1.5$, and $a=340\\,\\mathrm{m/s}$。\n首先，我们计算所需的比率和中间值：\n$$\n\\frac{k^n}{\\epsilon^n} = \\frac{5.2\\times 10^3}{5.2\\times 10^6} = 10^{-3}\\,\\mathrm{s}\n$$\n$$\n\\frac{P_k^n}{\\epsilon^n} = \\frac{4.16\\times 10^6}{5.2\\times 10^6} = 0.8\n$$\n$$\nM_t^{2,n} = \\frac{2k^n}{a^2} = \\frac{2 \\times 5.2 \\times 10^3}{340^2} = \\frac{10400}{115600} = \\frac{26}{289}\n$$\n$$\nf(M_t^n) = 1 + \\beta M_t^{2,n} = 1 + 1.5 \\times \\frac{26}{289} = 1 + \\frac{39}{289} = \\frac{328}{289} \\approx 1.1349\n$$\n现在我们计算雅可比矩阵的元素：\n$$\nJ_{11} = 0\\,\\mathrm{s}^{-1}\n$$\n$$\nJ_{12} = -1\n$$\n$$\nJ_{21} = \\left(\\frac{\\epsilon^n}{k^n}\\right)^2 (C_{\\epsilon 2}\\,\\epsilon^n - C_{\\epsilon 1}\\,P_k^n) = \\left(\\frac{\\epsilon^n}{k^n}\\right)^2 \\epsilon^n \\left(C_{\\epsilon 2} - C_{\\epsilon 1}\\,\\frac{P_k^n}{\\epsilon^n}\\right) = (10^3)^2 \\times 5.2\\times 10^6 \\times (1.92 - 1.44 \\times 0.8) = 10^6 \\times 5.2\\times 10^6 \\times (1.92 - 1.152) = 5.2 \\times 10^{12} \\times 0.768 = 3.9936 \\times 10^{12} \\,\\mathrm{s}^{-2}\n$$\n$J_{21}$ 的计算在上一步有误。正确的计算是：\n$J_{21} = \\frac{C_{\\epsilon 2}(\\epsilon^n)^2 - C_{\\epsilon 1}P_k^n\\epsilon^n}{(k^n)^2} = \\frac{1.92(5.2\\times 10^6)^2 - 1.44(4.16\\times 10^6)(5.2\\times 10^6)}{(5.2\\times 10^3)^2} = \\frac{(5.2)^2 \\times 10^{12}(1.92) - (1.44 \\times 4.16 \\times 5.2) \\times 10^{12}}{(5.2)^2 \\times 10^6} = \\frac{10^6}{(5.2)^2}((5.2)^2 \\times 1.92 - 31.18464) = 10^6(1.92 - 1.152) = 7.68\\times 10^5\\,\\mathrm{s}^{-2}$\n$$\nJ_{22} = \\frac{1}{k^n}(C_{\\epsilon 1}P_k^n - 2\\,C_{\\epsilon 2}f(M_t^n)\\epsilon^n) = \\frac{\\epsilon^n}{k^n}\\left(C_{\\epsilon 1}\\frac{P_k^n}{\\epsilon^n} - 2\\,C_{\\epsilon 2}f(M_t^n)\\right) = 10^3 (1.44 \\times 0.8 - 2 \\times 1.92 \\times \\frac{328}{289}) = 10^3 (1.152 - 4.35819...) \\approx -3206.2\\,\\mathrm{s}^{-1}\n$$\n计算出的雅可比矩阵为：\n$$\n\\mathbf{J} \\approx \\begin{pmatrix} 0  -1 \\\\ 7.68 \\times 10^5  -3206.2 \\end{pmatrix}\n$$\n\n**2) 特征值和最大时间步长**\n\n特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{J}-\\lambda\\mathbf{I}) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} -\\lambda  -1 \\\\ 7.68 \\times 10^5  -3206.2 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-3206.2 - \\lambda) - (-1)(7.68 \\times 10^5) = 0\n$$\n$$\n\\lambda^2 + 3206.2 \\lambda + 7.68 \\times 10^5 = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{-3206.2 \\pm \\sqrt{3206.2^2 - 4(1)(7.68 \\times 10^5)}}{2}\n$$\n$$\n\\lambda = \\frac{-3206.2 \\pm \\sqrt{10279718.44 - 3072000}}{2} = \\frac{-3206.2 \\pm \\sqrt{7207718.44}}{2}\n$$\n$$\n\\lambda = \\frac{-3206.2 \\pm 2684.719}{2}\n$$\n两个特征值为：\n$$\n\\lambda_1 = \\frac{-3206.2 + 2684.719}{2} = \\frac{-521.481}{2} = -260.74\\,\\mathrm{s}^{-1}\n$$\n$$\n\\lambda_2 = \\frac{-3206.2 - 2684.719}{2} = \\frac{-5890.919}{2} = -2945.46\\,\\mathrm{s}^{-1}\n$$\n两个特征值都是实数且为负。为使前向欧拉格式稳定，时间步长 $\\Delta t$ 必须对所有特征值 $\\lambda$ 满足 $|1+\\Delta t \\lambda| \\le 1$。对于实负特征值，此条件简化为 $\\Delta t \\le \\frac{2}{|\\lambda|}$。为确保整个系统的稳定性，$\\Delta t$ 必须小于由模最大的特征值所施加的限制。\n$$\n|\\lambda|_{\\max} = \\max(|\\lambda_1|, |\\lambda_2|) = |-2945.46| = 2945.46\\,\\mathrm{s}^{-1}\n$$\n最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{|\\lambda|_{\\max}} = \\frac{2}{2945.46} \\approx 6.7909 \\times 10^{-4}\\,\\mathrm{s}\n$$\n问题要求结果以毫秒为单位，并四舍五入到三位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.67909\\,\\mathrm{ms} \\approx 0.679\\,\\mathrm{ms}\n$$\n\n**3) 侵入性最小的隐式处理**\n\n系统的刚性主要源于 $\\epsilon$ 方程中的耗散项 $-C_{\\epsilon 2}f(M_t)\\epsilon^2/k$。该项对 $\\epsilon$ 的偏导数是 $J_{22}$ 项的主要部分，它导致了一个大的负特征值，从而对显式方法产生了严格的时间步长限制。\n\n一种减轻这种刚性的侵入性最小的方法是单个项的逐点半隐式处理。具体来说，我们对刚性耗散项进行隐式处理，同时保持所有其他项为显式。在 $\\epsilon$ 方程中，我们对隐式项进行线性化，以维持一个简单的、非耦合的更新过程。实现这一点的一个常见且简单的方法是在新的时间层 $n+1$ 上计算耗散项中 $\\epsilon$ 的一个因子：\n$$\n\\frac{\\epsilon^{n+1}-\\epsilon^n}{\\Delta t} = C_{\\epsilon 1}\\,\\frac{P_k^n\\,\\epsilon^n}{k^n} - C_{\\epsilon 2}\\,f(M_t^n)\\,\\frac{\\epsilon^n\\epsilon^{n+1}}{k^n}\n$$\n这是一个关于 $\\epsilon^{n+1}$ 的线性方程，可以通过代数方法求解，无需矩阵求逆：\n$$\n\\epsilon^{n+1}\\left(1 + \\Delta t \\, C_{\\epsilon 2}\\,f(M_t^n)\\frac{\\epsilon^n}{k^n}\\right) = \\epsilon^n + \\Delta t \\, C_{\\epsilon 1}\\,\\frac{P_k^n\\,\\epsilon^n}{k^n}\n$$\n$$\n\\epsilon^{n+1} = \\frac{\\epsilon^n \\left(1 + \\Delta t \\, C_{\\epsilon 1}\\,\\frac{P_k^n}{k^n}\\right)}{1 + \\Delta t \\, C_{\\epsilon 2}\\,f(M_t^n)\\,\\frac{\\epsilon^n}{k^n}}\n$$\n这种处理消除了与 $\\epsilon$-耗散项相关的刚性，极大地放宽了时间步长约束。$k$ 方程可以随后使用显式步骤进行更新，例如 $\\frac{k^{n+1}-k^n}{\\Delta t} = P_k^n - \\epsilon^{n+1}$。这种点隐式方法避免了构造或求逆完整的雅可比矩阵，使其成为一种侵入性最小但非常有效的方法。", "answer": "$$\\boxed{0.679}$$", "id": "3302823"}]}