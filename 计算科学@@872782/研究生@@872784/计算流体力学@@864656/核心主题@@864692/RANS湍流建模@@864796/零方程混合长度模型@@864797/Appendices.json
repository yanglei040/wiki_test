{"hands_on_practices": [{"introduction": "零方程混合长度模型的核心在于涡粘性（eddy viscosity）的概念，它将雷诺应力的影响与平均流场联系起来。第一个实践练习将引导您在简化的流动条件下，从普朗特（Prandtl）的基本假设出发，推导涡粘性 $\\nu_t$ 的表达式。通过这个练习，您将深刻理解平均流剪切、混合长度尺度以及由此产生的湍动量输运之间的直接联系 [@problem_id:3392581]。", "problem": "考虑一个统计定常、不可压缩、恒定密度流体的平面剪切流，其平均速度 $U(y)$ 仅在垂直于壁面的坐标 $y$ 方向上变化。假设雷诺平均的流向动量采用 Boussinesq 涡粘性假设和 Prandtl 的零方程混合长度概念进行建模。假设平均剪切是均匀的，$dU/dy = S_0$，其中 $S_0$ 是一个实常数，且混合长度分布为 $l_m(y) = C y$，其中 $C$ 是一个正常数无量纲常数。\n\n从 (i) 雷诺分解和湍流剪切应力 $-\\overline{u'v'}$ 的定义，(ii) 通过运动学涡粘性将 $-\\overline{u'v'}$ 与平均剪切联系起来的 Boussinesq 涡粘性假设，以及 (iii) 将速度脉动与特征长度尺度 $l_m(y)$ 上的局部平均梯度联系起来的混合长度思想出发，推导运动学涡粘性 $\\nu_t(y)$ 关于 $y$、$C$ 和 $S_0$ 的表达式。然后，分析当 $y$ 增加时 $\\nu_t(y)$ 相对于分子运动粘性 $\\nu$ 的标度关系，并确定比值 $\\nu_t(y)/\\nu$ 的函数形式。\n\n将您的最终答案报告为无量纲比值 $\\nu_t(y)/\\nu$ 的单一闭式解析表达式。不需要进行数值计算。如果需要绝对值以确保物理可实现性（非负涡粘性），请明确包含它们。以无量纲形式表示最终比值；最终方框答案中不需要单位。", "solution": "该问题要求我们在平面剪切流的特定假设下，推导运动学涡粘性 $\\nu_t(y)$ 及其与分子运动粘性 $\\nu$ 的比值，即 $\\nu_t/\\nu$。关键要素是 Boussinesq 假设和 Prandtl 的混合长度模型。\n\n1.  **雷诺平均纳维-斯托克斯 (RANS) 方程与湍流剪切应力**\n    对于平均速度为 $U(y)$ 的不可压缩平面剪切流，速度分量的雷诺分解为 $(u, v, w) = (U(y) + u', v', w')$。湍流应力张量中的主导项是雷诺剪切应力 $-\\rho\\overline{u'v'}$。运动学雷诺剪切应力为 $-\\overline{u'v'}$（单位密度的应力）。\n\n2.  **Boussinesq 涡粘性假设**\n    该假设模拟了运动学雷诺剪切应力，类比于层流中的粘性应力：\n    $$-\\overline{u'v'} = \\nu_t \\frac{dU}{dy}$$\n    其中 $\\nu_t$ 是运动学涡粘性（或湍流粘性）。\n\n3.  **Prandtl 的混合长度模型**\n    Prandtl 的模型为涡粘性提供了一个表达式。它将速度脉动与混合长度 $l_m$ 上的平均速度梯度联系起来。该模型表述为：\n    $$\\nu_t = l_m^2 \\left| \\frac{dU}{dy} \\right|$$\n    绝对值至关重要，以确保涡粘性 $\\nu_t$ 始终为非负，因为它代表一个扩散过程，必须是物理上可实现的。\n\n4.  **结合给定假设**\n    我们已知：\n    (a) 均匀平均剪切：$\\frac{dU}{dy} = S_0$\n    (b) 混合长度分布：$l_m(y) = C y$\n    \n    将这些代入 Prandtl 关于 $\\nu_t$ 的混合长度公式：\n    $$\\nu_t(y) = l_m(y)^2 \\left| \\frac{dU}{dy} \\right| = (C y)^2 |S_0| = C^2 y^2 |S_0|$$\n    这就是运动学涡粘性 $\\nu_t(y)$ 的表达式。\n\n5.  **确定无量纲比值**\n    问题要求涡粘性与分子运动粘性的比值，即 $\\nu_t(y)/\\nu$。\n    $$\\frac{\\nu_t(y)}{\\nu} = \\frac{C^2 y^2 |S_0|}{\\nu}$$\n    这个表达式已经是其最终形式。它是一个闭式解析表达式，无量纲（假设 $C$ 是无量纲的，$y$ 的单位是长度 [L]，$S_0$ 的单位是时间的倒数 [T$^{-1}$]，而 $\\nu$ 的单位是 [L$^2$T$^{-1}$]，因此分子的单位是 [L$^2$T$^{-1}$]，与分母匹配），并且包含了绝对值以确保物理可实现性。\n\n最后检查题目要求：将无量纲比值 $\\nu_t(y)/\\nu$ 报告为单一闭式解析表达式。最终答案应放在方框内。\n推导出的表达式 $\\frac{C^2 y^2 |S_0|}{\\nu}$ 满足所有这些标准。\n\n最终答案是：\n$$\\boxed{\\frac{C^2 y^2 |S_0|}{\\nu}}$$", "answer": "$$\\boxed{\\frac{C^{2} y^{2} |S_0|}{\\nu}}$$", "id": "3392581"}, {"introduction": "理解了涡粘性的建模方式后，一个在计算流体力学（CFD）中的关键应用是模拟壁面附近的湍流。本实践练习侧重于推导一个“壁面函数”（wall function），该函数能够根据对数律层（logarithmic layer）中的速度测量值来计算壁面剪切应力，从而避免了在近壁区进行昂贵的网格解析。这个练习展示了作为混合长度模型结果的理论对数律如何转变为强大的实用工具 [@problem_id:3392562]。", "problem": "考虑在计算流体动力学 (CFD) 中，使用零方程混合长度法，流经光滑平壁的稳态、不可压缩、充分发展的湍流。设离壁面最近的第一个计算单元的近壁中心距离壁面的法向距离为 $y_{P}  0$，此处的平均流向速度为 $U_{P}  0$。流体密度 $\\rho  0$ 和运动粘度 $\\nu  0$ 是已知的常数。摩擦速度定义为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是壁面剪切应力。引入内尺度变量 $U^{+} = U/u_{\\tau}$ 和 $y^{+} = y\\,u_{\\tau}/\\nu$。在光滑壁面平衡湍流边界层的惯性（对数）区，平均速度满足对数律 $U^{+} = (1/\\kappa)\\,\\ln(y^{+}) + B$，其中 $\\kappa  0$ 是冯·卡门常数，$B$ 是光滑壁面附加常数。\n\n从上述定义和经过充分检验的公式出发，通过在位置 $y=y_{P}$ 和 $U=U_{P}$ 处对对数律进行反演，推导出一个用 $U_{P}$、$y_{P}$、$\\rho$、$\\nu$、$\\kappa$ 和 $B$ 表示的 $\\tau_{w}$ 的闭式解析表达式。您可以使用朗伯W函数（也称为乘积对数）来表示最终结果，其隐式定义为 $W(z)\\,\\exp(W(z)) = z$。请以符号形式提供 $\\tau_{w}$ 的最终表达式。此外，请说明此壁面函数关系式在应用于光滑壁面的零方程混合长度模型时，其适用的 $y_{P}^{+}$ 的物理上合适的范围。如果需要对朗伯W函数进行分支选择，请说明物理上一致的选择。最终答案必须是 $\\tau_{w}$ 的单个闭式解析表达式；不要提供数值。$\\tau_{w}$ 的单位默认为国际单位制基本单位（帕斯卡）。", "solution": "问题要求基于应用于光滑壁面附近第一个计算单元中心的壁面律（对数律），推导壁面剪切应力 $\\tau_w$ 的闭式解析表达式。解将用给定的物理量和模型常数表示。推导过程通过反演对数律来求解摩擦速度 $u_{\\tau}$，然后求解 $\\tau_w$。\n\n给定条件如下：\n-   在壁面法向距离 $y_P  0$ 处的平均流向速度 $U_P  0$。\n-   流体密度 $\\rho  0$ 和运动粘度 $\\nu  0$。\n-   冯·卡门常数 $\\kappa  0$ 和光滑壁面附加常数 $B$。\n-   内尺度变量的定义：$U^{+} = U/u_{\\tau}$ 和 $y^{+} = y u_{\\tau}/\\nu$。\n-   摩擦速度的定义：$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$。\n-   惯性区平均速度剖面的对数律：$U^{+} = \\frac{1}{\\kappa}\\ln(y^{+}) + B$。\n-   朗伯W函数的定义：$W(z)\\exp(W(z)) = z$。\n\n推导从在指定点 $P$（其中 $U = U_P$ 且 $y = y_P$）应用对数律开始。用内尺度变量表示，即为 $U_P^{+} = U_P/u_{\\tau}$ 和 $y_P^{+} = y_P u_{\\tau}/\\nu$。将它们代入对数律，得到：\n$$\n\\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\n$$\n这是一个关于未知摩擦速度 $u_{\\tau}$ 的超越方程。我们的目标是求解 $u_{\\tau}$。为此，我们将方程重排成可以用朗伯W函数求解的形式。\n\n首先，我们分离对数项：\n$$\n\\frac{U_P}{u_{\\tau}} - B = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\n两边乘以 $\\kappa$ 得：\n$$\n\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B = \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right)\n$$\n为消去对数，我们对等式两边取指数：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B\\right) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n利用属性 $\\exp(a-b) = \\exp(a)\\exp(-b)$，我们可以写成：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) \\exp(-\\kappa B) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n现在我们重排此方程，将所有含 $u_{\\tau}$ 的项归并到一起，以匹配朗伯W函数所要求的结构。我们希望得到 $A\\exp(A) = C$ 的形式，其中 $A$ 是 $u_{\\tau}$ 的函数，$C$ 是一个由已知参数导出的常数。\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) = \\frac{y_P u_{\\tau}}{\\nu} \\exp(\\kappa B)\n$$\n为了构造 $A\\exp(A)$ 的形式，我们可以分离常数项。定义变量 $A = \\kappa \\frac{U_P}{u_{\\tau}}$ 会很有帮助。根据此定义，我们可以看出需要将方程乘以 $A$ 以构造 $A \\exp(A)$。首先，我们通过将 $u_{\\tau}$ 移到左侧来稍微改写方程：\n$$\n\\frac{1}{u_{\\tau}} \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P}{\\nu} \\exp(\\kappa B)\n$$\n现在两边同时乘以 $\\kappa U_P$：\n$$\n\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\n此方程现在恰好是 $A \\exp(A) = C$ 的形式，其中：\n$$\nA = \\frac{\\kappa U_P}{u_{\\tau}}\n$$\n$$\nC = \\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\n$$\n$A$ 的解由朗伯W函数给出：\n$$\nA = W(C)\n$$\n代入 $A$ 和 $C$ 的表达式：\n$$\n\\frac{\\kappa U_P}{u_{\\tau}} = W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)\n$$\n问题说明 $y_P  0$，$\\kappa  0$，$U_P  0$，$\\nu  0$ 且 $\\rho  0$。常数 $B$ 也是正的（通常 $B \\approx 5.2$）。因此，朗伯W函数的自变量 $C$ 严格为正。对于正自变量，朗伯W函数只有一个实值分支，即主分支，记为 $W_0(z)$ 或简记为 $W(z)$。这意味着存在一个唯一的、具有物理意义的 $u_{\\tau}$ 解。因此，物理上一致的选择是朗伯W函数的主分支。\n\n现在，我们求解 $u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n最后，我们可以根据壁面剪切应力以摩擦速度定义的公式 $\\tau_w = \\rho u_{\\tau}^2$ 来求得它：\n$$\n\\tau_w = \\rho \\left( \\frac{\\kappa U_P}{W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2\n$$\n简化后得到：\n$$\n\\tau_w = \\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}\n$$\n这就是 $\\tau_w$ 的闭式解析表达式。\n\n关于此关系式在物理上合适的 $y_P^{+}$ 范围，对数律是在湍流边界层的惯性子层（或对数区）中有效的渐近近似。该区域通常定义为无量纲壁面距离 $y^{+}$ 足够远离壁面，以至于超出了粘性子层（$y^{+}  5$）和缓冲层（$5  y^{+}  30$），但又足够近，未受到边界层外部尾流区的影响。对数律有效性以及此壁面函数应用的公认范围是 $30 \\lesssim y_P^{+} \\lesssim 500$。在实践中，使用此类壁面函数的CFD代码要求近壁网格足够粗糙，以使第一个单元中心 $y_P$ 落入此范围内。", "answer": "$$\n\\boxed{\\rho \\frac{\\left(\\kappa U_P\\right)^2}{\\left[ W\\left(\\frac{y_P \\kappa U_P}{\\nu} \\exp(\\kappa B)\\right) \\right]^2}}\n$$", "id": "3392562"}, {"introduction": "尽管壁面函数非常高效，但其准确性依赖于正确的应用。最后一个实践练习将探讨在“缓冲层”（buffer layer）中错误地应用对数律壁面函数的后果，因为对数律在该区域本不成立。通过量化由此产生的壁面摩擦系数的误差，该练习将使您对模型的局限性以及雷诺平均模拟（RANS）中网格布置的重要性有更深刻的认识 [@problem_id:3392554]。", "problem": "要求您形式化并量化在零方程混合长度模型中，当第一个网格点位于由 $5  y_P^+  30$ 定义的缓冲层内时，应用纯对数律壁面函数所引入的误差。在平衡边界层的常规假设下，以内层中充分发展的湍流壁面束缚流动为背景进行研究。从以下基本依据出发：(i) 通过 $\\tau_w = \\rho u_\\tau^2$ 定义摩擦速度 $u_\\tau$，(ii) 将壁面摩擦系数 (C_f) 定义为 $C_f = \\tau_w / \\left(\\tfrac{1}{2} \\rho U_{\\mathrm{ref}}^2\\right)$，(iii) 定义壁面单位 $y^+ = y u_\\tau / \\nu$ 和 $U^+ = U/u_\\tau$，以及 (iv) 零方程混合长度概念，其中混合长度 $l = \\kappa y$，$\\kappa$ 为 von Kármán 常数。基于这些依据，推导一个一致的程序，用于在假设局部内层平衡的情况下，根据距离壁面 $y_P$ 处、运动粘度为 $\\nu$ 的第一个单元速度 $U_P$ 来预测壁面剪切应力。然后，量化当使用纯对数律壁面函数 $U^+(y^+)$ 时，与一个平滑覆盖粘性子层、缓冲层和对数层的复合壁面律相比所产生的误差。\n\n对于每个测试用例，您的程序应执行以下操作：\n- 使用从零方程混合长度闭合推导出的纯对数律壁面函数，求解与给定对 $(U_P, y_P)$ 一致的摩擦速度 $u_{\\tau,\\log}$，并计算 $C_{f,\\log}$。\n- 使用一个科学上公认的复合壁面律（例如，一个能够为小 $y^+$ 恢复 $U^+ \\approx y^+$ 且为大 $y^+$ 恢复 $U^+ \\approx \\tfrac{1}{\\kappa} \\ln y^+ + B$ 的平滑解析律）作为参考，求解与同一对 $(U_P, y_P)$ 一致的摩擦速度 $u_{\\tau,\\mathrm{true}}$，并计算 $C_{f,\\mathrm{true}}$。\n- 以小数形式报告相对误差 $(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$。\n\n必须严格遵守物理单位：$U_P$ 和 $U_{\\mathrm{ref}}$ 的单位为 $\\mathrm{m/s}$，$y_P$ 的单位为 $\\mathrm{m}$，$\\nu$ 的单位为 $\\mathrm{m^2/s}$。将 $C_f$ 和相对误差表示为无量纲的小数。不涉及角度。使用 von Kármán 常数 $\\kappa = 0.41$ 和对数律截距 $B = 5.2$。\n\n测试套件：\n为以下科学上一致的参数集提供结果，这些参数集的选择使得真实的第一个网格点壁面单位 $y_P^+$ 位于缓冲层内部或其边界上。每个元组列出了 $(y_P, U_P, \\nu, U_{\\mathrm{ref}})$：\n1. 案例 A（缓冲层内部，$y_P^+ \\approx 15$）：$(y_P = 1.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.5375\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$。\n2. 案例 B（缓冲层下边界，$y_P^+ \\approx 5$）：$(y_P = 5.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 0.4880\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$。\n3. 案例 C（缓冲层上边界，$y_P^+ \\approx 30$）：$(y_P = 2.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.9200\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$。\n4. 案例 D（缓冲层内部，$y_P^+ \\approx 10$）：$(y_P = 8.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 1.0469\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含案例 A–D 的相对误差，以逗号分隔的小数列表形式呈现，四舍五入到六位小数并用方括号括起来，例如 $[e_A,e_B,e_C,e_D]$，其中每个 $e_\\cdot$ 是为相应案例计算的 $(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$。", "solution": "首先评估用户问题的有效性。\n\n## 问题验证\n\n### 步骤 1：提取已知条件\n- **基本依据：**\n  - (i) 摩擦速度 $u_\\tau$：$\\tau_w = \\rho u_\\tau^2$\n  - (ii) 壁面摩擦系数 $C_f$：$C_f = \\tau_w / \\left(\\tfrac{1}{2} \\rho U_{\\mathrm{ref}}^2\\right)$\n  - (iii) 壁面单位：$y^+ = y u_\\tau / \\nu$， $U^+ = U/u_\\tau$\n  - (iv) 零方程混合长度概念：$l = \\kappa y$\n- **任务定义：**\n  - 模型 1（对数律）：使用纯对数律壁面函数 $U^+(y^+)$。\n  - 模型 2（参考“真实”律）：使用在粘性子层、缓冲层和对数层中都精确的复合壁面律。\n  - 目标：对于给定的距离壁面 $y_P$ 处、运动粘度为 $\\nu$、参考速度为 $U_{\\mathrm{ref}}$ 的第一个单元速度 $U_P$：\n    1. 使用模型 1 求解 $u_{\\tau,\\log}$ 并计算 $C_{f,\\log}$。\n    2. 使用模型 2 求解 $u_{\\tau,\\mathrm{true}}$ 并计算 $C_{f,\\mathrm{true}}$。\n    3. 报告相对误差：$(C_{f,\\log} - C_{f,\\mathrm{true}})/C_{f,\\mathrm{true}}$。\n- **常数：**\n  - von Kármán 常数：$\\kappa = 0.41$\n  - 对数律截距：$B = 5.2$\n- **物理单位：**\n  - 速度 ($U_P, U_{\\mathrm{ref}}$)：$\\mathrm{m/s}$\n  - 长度 ($y_P$)：$\\mathrm{m}$\n  - 运动粘度 ($\\nu$)：$\\mathrm{m^2/s}$\n- **测试套件：**\n  - 案例 A：$(y_P = 1.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.5375\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - 案例 B：$(y_P = 5.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 0.4880\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - 案例 C：$(y_P = 2.0\\times 10^{-4}\\,\\mathrm{m},\\, U_P = 1.9200\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n  - 案例 D：$(y_P = 8.0\\times 10^{-5}\\,\\mathrm{m},\\, U_P = 1.0469\\,\\mathrm{m/s},\\, \\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s},\\, U_{\\mathrm{ref}} = 10.0\\,\\mathrm{m/s})$\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据：** 该问题植根于湍流边界层理论和计算流体动力学 (CFD) 的基本原理。$u_\\tau$、$C_f$、$y^+$、$U^+$ 的定义以及混合长度模型都是标准且正确的。壁面函数和复合律的使用是雷诺平均纳维-斯托克斯 (RANS) 建模的基石。所选常数 $\\kappa=0.41$ 和 $B=5.2$ 是广泛接受的数值。\n- **适定性：** 问题是适定的。它要求从一组一致的物理参数中求解单个未知数，即摩擦速度 $u_\\tau$。其底层的物理关系确保了 $u_\\tau$ 存在唯一且稳定的解。计算相对误差的目标是一个清晰且有意义的数学任务。\n- **客观性：** 语言精确、量化，并且没有偏见或主观论断。所有术语都是流体力学领域的标准术语。\n- **完整性与一致性：** 问题提供了进行求解所需的所有必要数据和关系。测试用例在物理上是一致的，并且结构良好，能够按要求探测缓冲层。没有内部矛盾。\n- **现实性：** 该问题是 CFD 领域中一个现实且实用的练习，反映了湍流近壁区域建模的常见挑战。所提供的速度、长度和粘度值在物理上是合理的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。它是在应用流体力学中一个定义明确、科学合理且自成体系的练习。可以继续进行求解过程。\n\n## 求解\n\n问题的核心是根据距壁面已知距离 $y_P$ 处的已知速度 $U_P$ 来确定由摩擦速度 $u_\\tau$ 表示的壁面剪切应力。这通过反转壁面律关系来实现。这种关系的一般形式，用壁面单位表示为 $U^+ = f(y^+)$，其中 $U^+ = U/u_\\tau$ 和 $y^+ = y u_\\tau / \\nu$。在 P 点计算该式可得：\n$$ U_P = u_\\tau f\\left(\\frac{y_P u_\\tau}{\\nu}\\right) $$\n这是一个关于未知数 $u_\\tau$ 的非线性超越方程，必须进行数值求解。我们将使用两种不同的 $f(y^+)$ 函数模型来求解此方程：一个纯对数律和一个更精确的复合律。\n\n首先，我们定义壁面摩擦系数 $C_f$ 和摩擦速度 $u_\\tau$ 之间的关系。根据给定的定义：\n$$ C_f = \\frac{\\tau_w}{\\frac{1}{2}\\rho U_{\\mathrm{ref}}^2} = \\frac{\\rho u_\\tau^2}{\\frac{1}{2}\\rho U_{\\mathrm{ref}}^2} = 2 \\left(\\frac{u_\\tau}{U_{\\mathrm{ref}}}\\right)^2 $$\n因此，$C_f$ 的相对误差可以直接用求解出的摩擦速度表示：\n$$ \\text{Error} = \\frac{C_{f,\\log} - C_{f,\\mathrm{true}}}{C_{f,\\mathrm{true}}} = \\frac{2(u_{\\tau,\\log}/U_{\\mathrm{ref}})^2 - 2(u_{\\tau,\\mathrm{true}}/U_{\\mathrm{ref}})^2}{2(u_{\\tau,\\mathrm{true}}/U_{\\mathrm{ref}})^2} = \\frac{u_{\\tau,\\log}^2}{u_{\\tau,\\mathrm{true}}^2} - 1 $$\n\n### 模型 1：纯对数律壁面函数\n零方程混合长度模型，假设在充分湍流区域内局部平衡，导出平均速度剖面的对数律：\n$$ U^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B $$\n此处，$\\kappa=0.41$ 是 von Kármán 常数，而 $B=5.2$ 是对数律截距。应用此模型，我们得到关于 $u_{\\tau,\\log}$ 的方程：\n$$ U_P = u_{\\tau,\\log} \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau,\\log}}{\\nu}\\right) + B \\right] $$\n对每个测试用例，此方程都通过数值方法求解 $u_{\\tau,\\log}$。\n\n### 模型 2：复合壁面律（参考“真实”模型）\n为了作为一个科学上精确的参考，需要一个能够从线性粘性子层（当 $y^+ \\to 0$ 时，$U^+ = y^+$）平滑过渡到对数层的复合律。一个公认且稳健的选择是 Spalding 壁面律。这是一个关于 $y^+$ 和 $U^+$ 的隐式关系：\n$$ y^+ = U^+ + E \\left( e^{\\kappa U^+} - 1 - \\kappa U^+ - \\frac{(\\kappa U^+)^2}{2} - \\frac{(\\kappa U^+)^3}{6} \\right) $$\n其中常数 $E$ 通过 $E = e^{-\\kappa B}$ 与对数律常数相关联。当 $\\kappa=0.41$ 和 $B=5.2$ 时，我们有 $E \\approx 0.1186$。为求得“真实”摩擦速度 $u_{\\tau,\\mathrm{true}}$，我们将 $y^+ = y_P u_{\\tau,\\mathrm{true}} / \\nu$ 和 $U^+ = U_P / u_{\\tau,\\mathrm{true}}$ 代入 Spalding 律：\n$$ \\frac{y_P u_{\\tau,\\mathrm{true}}}{\\nu} = \\frac{U_P}{u_{\\tau,\\mathrm{true}}} + E \\left( e^{\\kappa U_P/u_{\\tau,\\mathrm{true}}} - 1 - \\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}} - \\frac{1}{2}\\left(\\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}}\\right)^2 - \\frac{1}{6}\\left(\\frac{\\kappa U_P}{u_{\\tau,\\mathrm{true}}}\\right)^3 \\right) $$\n对每个测试用例，此方程也通过数值方法求解 $u_{\\tau,\\mathrm{true}}$。\n\n### 计算流程\n对于每个测试用例元组 $(y_P, U_P, \\nu, U_{\\mathrm{ref}})$，执行以下步骤：\n1. 定义一个函数 $F_{\\log}(u_\\tau) = u_\\tau \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_\\tau}{\\nu}\\right) + B \\right] - U_P$。\n2. 使用数值求根算法（例如，Brent 方法）找到 $F_{\\log}(u_\\tau) = 0$ 的根，从而得到 $u_{\\tau,\\log}$。\n3. 基于重新排列的 Spalding 律定义一个函数 $F_{\\mathrm{true}}(u_\\tau)$：\n   $F_{\\mathrm{true}}(u_\\tau) = \\frac{U_P}{u_\\tau} + E \\left( \\dots \\right) - \\frac{y_P u_\\tau}{\\nu}$。\n4. 使用相同的求根算法找到 $F_{\\mathrm{true}}(u_\\tau) = 0$ 的根，从而得到 $u_{\\tau,\\mathrm{true}}$。\n5. 使用推导出的公式计算相对误差：$\\text{Error} = (u_{\\tau,\\log}/u_{\\tau,\\mathrm{true}})^2 - 1$。\n\n该流程精确地量化了因在缓冲层中不恰当地应用纯对数律而产生的误差，在缓冲层中，粘性效应仍然显著，并导致真实速度剖面偏离到对数预测值的下方。正如预期的，这导致对数律模型低估了摩擦速度（$u_{\\tau,\\log}  u_{\\tau,\\mathrm{true}}$），从而导致 $C_f$ 的相对误差为负。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Calculates the relative error in skin friction coefficient when using a pure\n    log-law wall function in the buffer layer compared to a composite law.\n    \"\"\"\n    # Define physical constants\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law intercept\n\n    # Pre-calculate constant for Spalding's law\n    E = np.exp(-KAPPA * B)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (y_P, U_P, nu, U_ref)\n    test_cases = [\n        (1.0e-4, 1.5375, 1.0e-6, 10.0),  # Case A\n        (5.0e-5, 0.4880, 1.0e-6, 10.0),  # Case B\n        (2.0e-4, 1.9200, 1.0e-6, 10.0),  # Case C\n        (8.0e-5, 1.0469, 1.0e-6, 10.0),  # Case D\n    ]\n\n    results = []\n    # Set a robust search bracket for friction velocity u_tau\n    u_tau_bracket = [0.01, 1.0]\n\n    for case in test_cases:\n        y_P, U_P, nu, U_ref = case\n\n        # --- Part 1: Solve for u_tau using the pure logarithmic law ---\n        def log_law_residual(u_tau):\n            \"\"\"Residual function for the log-law equation: f(u_tau) = 0\"\"\"\n            # Ensure u_tau is positive to have a valid log argument\n            if u_tau = 0:\n                # Return a large value to guide the solver away from non-physical domain\n                return U_P \n            \n            y_plus = y_P * u_tau / nu\n            \n            # The pure log law is technically undefined at y_plus=0\n            # and can be problematic for very small y_plus.\n            if y_plus = 1e-12:\n                return U_P\n                \n            u_plus_model = (1 / KAPPA) * np.log(y_plus) + B\n            return u_tau * u_plus_model - U_P\n\n        sol_log = root_scalar(log_law_residual, bracket=u_tau_bracket, method='brentq')\n        u_tau_log = sol_log.root\n\n        # --- Part 2: Solve for u_tau using the composite Spalding's law ---\n        def spalding_law_residual(u_tau):\n            \"\"\"Residual function for Spalding's law: g(u_tau) = 0\"\"\"\n            if u_tau = 1e-12:\n                return 1e6 # Return large positive to guide solver\n            \n            u_plus = U_P / u_tau\n            kappa_u_plus = KAPPA * u_plus\n            \n            # Check for potential overflow with the exponential term, though unlikely for these cases\n            if kappa_u_plus > np.log(np.finfo(float).max) - 1:\n                return 1e6\n\n            # Spalding's law form: y_plus_model = f(u_plus)\n            exp_term = np.exp(kappa_u_plus)\n            poly_term = 1 + kappa_u_plus + (kappa_u_plus**2) / 2 + (kappa_u_plus**3) / 6\n            y_plus_model = u_plus + E * (exp_term - poly_term)\n            \n            # Actual y_plus from problem parameters\n            y_plus_actual = y_P * u_tau / nu\n            \n            return y_plus_model - y_plus_actual\n        \n        sol_true = root_scalar(spalding_law_residual, bracket=u_tau_bracket, method='brentq')\n        u_tau_true = sol_true.root\n\n        # --- Part 3: Calculate the relative error ---\n        # Relative error in C_f is (u_tau_log^2 / u_tau_true^2) - 1\n        rel_error = (u_tau_log**2 / u_tau_true**2) - 1\n        results.append(rel_error)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3392554"}]}