{"hands_on_practices": [{"introduction": "剪切应力输运（SST）模型是现代雷诺平均纳维-斯托克斯（RANS）建模的基石，因其在各种流动中表现出的鲁棒性而备受推崇。其关键特征之一是涡粘性系数的限制器，这使其在近壁区表现得像一个 $k$-$\\omega$ 模型，而在远场则像一个 $k$-$\\epsilon$ 模型。本练习要求你推导这个关键转换发生的确切位置（以壁面单位表示），从而深入理解该模型的混合特性。[@problem_id:3347976]", "problem": "考虑不可压缩湍流流经光滑壁面的情况，使用剪切应力输运 (SST) $k$-$\\omega$ 湍流模型进行建模。该模型的涡粘性限制器由两个尺度限制量的竞争关系定义，使得模拟的湍流运动粘度 $\\,\\nu_{t}\\,$ 具有以下形式：$$\\nu_{t} \\;=\\; \\frac{a_{1}\\,k}{\\max\\!\\left(a_{1}\\,\\omega,\\;S\\,F_{2}\\right)}.$$此处，$\\,k\\,$ 是湍流动能，$\\,\\omega\\,$ 是比耗散率，$\\,S\\,$ 是平均应变率大小，$\\,F_{2}\\,$ 是依赖于局部流动变量的第二个混合函数，而 $\\,a_{1}\\,$ 是一个正的模型常数。假设采用以下科学上标准的近壁标度和定义：(i) 比耗散率的近壁标度为 $\\,\\omega \\sim C_{\\omega}\\,\\nu/y^{2}\\,$，其中 $\\,C_{\\omega}0\\,$，(ii) 内层平均应变率的标度为 $\\,S \\sim u_{\\tau}/(\\kappa\\,y)\\,$，其中冯·卡门常数 $\\,\\kappa0\\,$，摩擦速度 $\\,u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}\\,$，以及 (iii) 当 $\\,y\\to 0\\,$ 时，$\\,F_{2}\\to 1\\,$，这与 $k$-$\\omega$ 模型的近壁极限一致。仅使用这些基础，确定 SST 限制器切换其激活分支的法向壁面位置 $\\,y\\,$，换言之，即 $\\,\\nu_{t}\\,$ 从 $\\,\\nu_{t}\\approx k/\\omega\\,$ 行为过渡到 $\\,\\nu_{t}\\approx a_{1}\\,k/(S\\,F_{2})\\,$ 行为的点。请用壁面单位 $\\,y^{+}=y\\,u_{\\tau}/\\nu\\,$ 表示您的答案，形式为仅包含 $\\,a_{1}\\,$, $\\,C_{\\omega}\\,$ 和 $\\,\\kappa\\,$ 的单个闭式解析表达式。无需进行数值计算，也无需四舍五入。请提供 $\\,y^{+}\\,$ 的最终表达式。", "solution": "本问题要求确定剪切应力输运 (SST) $k–\\omega$ 模型中湍流运动粘度 $\\nu_{t}$ 的限制器切换其激活分支的法向壁面位置，并用壁面单位 $y^{+}$ 表示。\n\n首先，我们必须验证问题陈述的有效性。问题提供了一个明确的物理背景——不可压缩湍流流经光滑壁面——以及一个特定的湍流模型，即 SST $k–\\omega$ 模型。所提供的湍流运动粘度定义，\n$$\n\\nu_{t} = \\frac{a_{1}\\,k}{\\max\\!\\left(a_{1}\\,\\omega,\\;S\\,F_{2}\\right)}\n$$\n是 SST 模型的正确公式，其中 $a_{1}$ 是模型常数，$k$ 是湍流动能，$\\omega$ 是比耗散率，$S$ 是平均应变率张量的大小，$F_{2}$ 是一个混合函数。问题还为相关量提供了标准的、科学正确的近壁渐近行为：\n(i) 比耗散率的近壁标度为 $\\omega \\sim C_{\\omega}\\,\\nu/y^{2}$，其中 $C_{\\omega}0$ 是一个常数，$\\nu$ 是流体的运动粘度，$y$ 是与壁面的距离。这是基于 $\\omega$ 的模型的一个公认的边界条件，用以确保在粘性底层中的正确行为。\n(ii) 内层的平均应变率标度为 $S \\sim u_{\\tau}/(\\kappa\\,y)$，其中 $u_{\\tau}$ 是摩擦速度，$\\kappa$ 是冯·卡门常数。该标度是湍流边界层对数律区的特征。应用它来寻找过渡点是一种标准的解析方法。\n(iii) 第二个混合函数的行为是当 $y\\to 0$ 时，$F_{2}\\to 1$。根据 SST 模型的设计，这是正确的，因为该模型在近壁区域会回归到标准的 $k–\\omega$ 模型。\n\n该问题是自洽的，其科学基础植根于湍流建模的原理，并且在数学上是适定的。目标很明确：找到 $\\max$ 函数的两个参数相等的位置。该问题被认定为有效。\n\n我们现在进行求解。限制器激活分支的过渡或“切换”发生在位置 $y$ 处，在该处 $\\max(\\cdot)$ 函数内部的两项相等。这个条件定义了 $\\nu_{t}$ 两种极限行为之间的边界：标准的 $k–\\omega$ 行为 ($\\nu_{t} \\approx k/\\omega$) 和基于 Bradshaw 关系的行为 ($\\nu_{t} \\approx a_{1}\\,k/(S\\,F_{2})$)。\n\n因此，切换条件为：\n$$\na_{1}\\,\\omega = S\\,F_{2}\n$$\n\n我们已知用于此分析的近壁标度。我们将 $\\omega$、$S$ 和 $F_{2}$ 的渐近形式代入此方程。\n- 对于比耗散率 $\\omega$：\n$$\n\\omega \\approx C_{\\omega}\\,\\frac{\\nu}{y^{2}}\n$$\n- 对于平均应变率大小 $S$：\n$$\nS \\approx \\frac{u_{\\tau}}{\\kappa\\,y}\n$$\n- 对于第二个混合函数 $F_{2}$，我们使用其近壁极限：\n$$\nF_{2} \\approx 1\n$$\n将这些近似值代入切换条件，得到：\n$$\na_{1}\\left(C_{\\omega}\\,\\frac{\\nu}{y^{2}}\\right) = \\left(\\frac{u_{\\tau}}{\\kappa\\,y}\\right)(1)\n$$\n该方程建立了发生过渡的法向壁面距离 $y$ 的关系。我们现在可以求解 $y$。\n$$\n\\frac{a_{1}\\,C_{\\omega}\\,\\nu}{y^{2}} = \\frac{u_{\\tau}}{\\kappa\\,y}\n$$\n由于 $y$ 代表与壁面的物理距离，我们知道 $y0$。我们可以将方程两边同乘以 $y^{2}$ 来简化：\n$$\na_{1}\\,C_{\\omega}\\,\\nu = \\frac{u_{\\tau}}{\\kappa}\\,y\n$$\n求解 $y$，我们得到：\n$$\ny = \\frac{a_{1}\\,C_{\\omega}\\,\\kappa\\,\\nu}{u_{\\tau}}\n$$\n问题要求答案以无量纲的壁面单位 $y^{+}$ 表示，其定义为：\n$$\ny^{+} = \\frac{y\\,u_{\\tau}}{\\nu}\n$$\n将我们推导出的 $y$ 的表达式代入 $y^{+}$ 的定义中：\n$$\ny^{+} = \\left(\\frac{a_{1}\\,C_{\\omega}\\,\\kappa\\,\\nu}{u_{\\tau}}\\right) \\frac{u_{\\tau}}{\\nu}\n$$\n$u_{\\tau}$ 和 $\\nu$ 项相互抵消，从而得到以壁面单位表示的过渡点的最终表达式：\n$$\ny^{+} = a_{1}\\,C_{\\omega}\\,\\kappa\n$$\n这就是限制器切换的法向壁面位置的闭式解析表达式，以壁面单位表示，并用指定的常数 $a_{1}$、$C_{\\omega}$ 和 $\\kappa$ 表示。", "answer": "$$\\boxed{a_{1}\\,C_{\\omega}\\,\\kappa}$$", "id": "3347976"}, {"introduction": "标准的 $k$-$\\omega$ 模型虽然功能强大，但也存在一些已知的缺陷，其中最著名的是在粘性子层中对湍流生成项的过度预测。这可能导致对壁面剪切应力和热传递的预测不准确。这个计算练习提供了一个动手实践的机会，通过将模型的预测与一个仿照直接数值模拟（DNS）的真实剖面对比，来量化这种“生成项过剩”现象，并观察网格分辨率和模型系数如何影响误差。[@problem_id:3348018]", "problem": "考虑一个以壁面单位表示的统计定常、不可压缩的平面槽道流。令 $k$ 表示湍动能，$\\omega$ 表示比耗散率，$\\nu_t$ 表示涡粘性，$S_{ij}$ 表示平均应变率张量，且 $S^2 = 2 S_{ij} S_{ij}$。在 $y^+  5$ 的粘性底层中，湍流输运与生成和耗散相比很小，因此湍动能方程简化为近壁面平衡式 $\\partial_t k \\approx P - \\varepsilon$，其中 $\\varepsilon \\approx \\beta^* \\omega k$ 且 $P \\approx \\nu_t S^2$。此处 $\\beta^*$ 是一个模型系数。在 $k$-$\\omega$ 模型的标准涡粘性公式中，$\\nu_t = \\alpha \\, k / \\omega$，其中 $\\alpha$ 是一个模型系数。\n\n定义无量纲的壁面单位形式：$k^+ = k / u_\\tau^2$、$\\omega^+ = \\omega \\nu / u_\\tau^2$、$P^+ = P \\, \\nu / u_\\tau^4$ 和 $\\varepsilon^+ = \\varepsilon \\, \\nu / u_\\tau^4$，其中 $u_\\tau$ 是摩擦速度。在这些单位下，$P^+ = \\nu_t^+ S^{2+}$，其中 $\\nu_t^+ = \\nu_t / \\nu = \\alpha \\, k^+ / \\omega^+$，且 $\\varepsilon^+ = \\beta^* \\, \\omega^+ k^+$。\n\n给定以下为粘性底层设定的、在数学上明确且貌似合理的直接数值模拟 (DNS) 类收支函数：\n- $k^+(y^+) = c_k \\, (y^+)^2$，\n- $\\omega^+(y^+) = \\dfrac{a_\\omega}{(y^+)^2 + y_0^2}$，\n- $S^{2+}(y^+) = \\dfrac{1}{2} \\left(1 - 0.05 \\, e^{-y^+/2}\\right)$，\n- $P_{\\mathrm{DNS}}^+(y^+) = p_0 \\, (y^+)^2 \\left(1 - e^{-y^+/3}\\right)$，\n- $\\partial_t k^+(y^+) = 0$ (近壁面区域的稳态收支)。\n\n这些函数定义了一个一致、光滑的测试场，捕捉了预期的近壁面定性行为，包括 $k^+ \\sim (y^+)^2$、当 $y^+ \\to 0$ 时 $P_{\\mathrm{DNS}}^+ \\to 0$、以及当 $y^+ \\to 0$ 时 $\\omega^+$ 为有限值。\n\n从基本的近壁面平衡和给定的定义出发，实现一个程序，该程序针对一组指定网格和模型系数的测试参数体系，在区间 $0  y^+  5$ 上执行以下操作：\n1. 使用宽度为 $\\Delta y^+$ 的均匀单元对 $y^+$ 进行离散；在单元中点 $y_j^+ = \\left(j - \\dfrac{1}{2}\\right) \\Delta y^+$ (对于 $j = 1, \\ldots, N$) 进行采样，其中 $N = \\left\\lfloor \\dfrac{5}{\\Delta y^+} \\right\\rfloor$ 且 $N \\ge 1$。\n2. 计算模型生成项 $P_{\\mathrm{model}}^+(y_j^+) = \\nu_t^+(y_j^+) \\, S^{2+}(y_j^+)$，其中 $\\nu_t^+(y_j^+) = \\alpha \\, \\dfrac{k^+(y_j^+)}{\\omega^+(y_j^+)}$。\n3. 计算模型耗散项 $\\varepsilon_{\\mathrm{model}}^+(y_j^+) = \\beta^* \\, \\omega^+(y_j^+) \\, k^+(y_j^+)$。\n4. 评估近壁面平衡残差 $R(y_j^+) = \\partial_t k^+(y_j^+) - \\left(P_{\\mathrm{model}}^+(y_j^+) - \\varepsilon_{\\mathrm{model}}^+(y_j^+)\\right)$。\n5. 通过比较 $P_{\\mathrm{model}}^+(y_j^+)$ 和 $P_{\\mathrm{DNS}}^+(y_j^+)$ 来识别生成过量，并计算在所有采样点 $y_j^+$ 上的最大过量比 $r_{\\max} = \\max_j \\dfrac{P_{\\mathrm{model}}^+(y_j^+)}{P_{\\mathrm{DNS}}^+(y_j^+)}$。请注意，只要该比率超过 1，就表示出现了过量。\n6. 计算近壁面平衡误差的均方根值 $\\mathrm{RMS} = \\sqrt{\\dfrac{1}{N} \\sum_{j=1}^N R(y_j^+)^2}$，该值在壁面单位下是无量纲的。\n\n在所有测试用例中使用以下固定常数：\n- $c_k = 0.1$，\n- $a_\\omega = 20$，\n- $y_0 = 0.5$，\n- $p_0 = 0.05$。\n\n测试套件：\n为以下参数体系提供结果，每个体系由 $(\\Delta y^+, \\alpha, \\beta^*)$ 指定：\n- 用例 1 (细网格，阻尼 $\\alpha$)：$(0.1, 0.52, 0.09)$，\n- 用例 2 (中等网格，基准 $\\alpha$)：$(0.5, 1.0, 0.09)$，\n- 用例 3 (粗网格，减小的耗散系数)：$(2.5, 1.0, 0.05)$，\n- 用例 4 (单单元子层，增大的 $\\alpha$)：$(5.0, 1.2, 0.09)$。\n\n所有输出必须是无量纲的壁面单位浮点数。您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，并按给定顺序格式化为每个用例的配对列表 $[r_{\\max}, \\mathrm{RMS}]$。例如：”[[r1,e1],[r2,e2],[r3,e3],[r4,e4]]“。", "solution": "根据指定标准对该问题进行了严格验证。\n\n**步骤 1：提取给定信息**\n- **流动**：统计定常、不可压缩的平面槽道流。\n- **区域**：粘性底层 ($y^+  5$)。\n- **变量**：湍动能 ($k$)、比耗散率 ($\\omega$)、涡粘性 ($\\nu_t$)、平均应变率张量 ($S_{ij}$)、摩擦速度 ($u_\\tau$)、运动粘度 ($\\nu$)。\n- **定义**：$S^2 = 2 S_{ij} S_{ij}$。\n- **近壁面平衡**：$\\partial_t k \\approx P - \\varepsilon$，其中生成项为 $P \\approx \\nu_t S^2$，耗散项为 $\\varepsilon \\approx \\beta^* \\omega k$。\n- **涡粘性模型**：$\\nu_t = \\alpha \\, k / \\omega$。\n- **壁面单位**：$k^+ = k / u_\\tau^2$、$\\omega^+ = \\omega \\nu / u_\\tau^2$、$P^+ = P \\, \\nu / u_\\tau^4$、$\\varepsilon^+ = \\varepsilon \\, \\nu / u_\\tau^4$。\n- **壁面单位下的模型方程**：$\\nu_t^+ = \\nu_t / \\nu = \\alpha \\, k^+ / \\omega^+$、$P^+ = \\nu_t^+ S^{2+}$、$\\varepsilon^+ = \\beta^* \\, \\omega^+ k^+$。\n- **给定的解析场**：\n    - $k^+(y^+) = c_k \\, (y^+)^2$\n    - $\\omega^+(y^+) = \\dfrac{a_\\omega}{(y^+)^2 + y_0^2}$\n    - $S^{2+}(y^+) = \\dfrac{1}{2} \\left(1 - 0.05 \\, e^{-y^+/2}\\right)$\n    - $P_{\\mathrm{DNS}}^+(y^+) = p_0 \\, (y^+)^2 \\left(1 - e^{-y^+/3}\\right)$\n    - $\\partial_t k^+(y^+) = 0$\n- **固定常数**：$c_k = 0.1$、 $a_\\omega = 20$、 $y_0 = 0.5$、 $p_0 = 0.05$。\n- **计算任务**：\n    1. 将 $0  y^+  5$ 离散为 $N = \\left\\lfloor 5/\\Delta y^+ \\right\\rfloor$ 个单元，在单元中点 $y_j^+ = \\left(j - 1/2\\right) \\Delta y^+$ 处采样。\n    2. 计算模型生成项 $P_{\\mathrm{model}}^+(y_j^+)$。\n    3. 计算模型耗散项 $\\varepsilon_{\\mathrm{model}}^+(y_j^+)$。\n    4. 计算平衡残差 $R(y_j^+)$。\n    5. 计算最大生成过量比 $r_{\\max} = \\max_j (P_{\\mathrm{model}}^+ / P_{\\mathrm{DNS}}^+)$。\n    6. 计算均方根平衡误差 $\\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_j R(y_j^+)^2}$。\n- **测试用例**：\n    - 用例 1：$(\\Delta y^+, \\alpha, \\beta^*) = (0.1, 0.52, 0.09)$\n    - 用例 2：$(\\Delta y^+, \\alpha, \\beta^*) = (0.5, 1.0, 0.09)$\n    - 用例 3：$(\\Delta y^+, \\alpha, \\beta^*) = (2.5, 1.0, 0.05)$\n    - 用例 4：$(\\Delta y^+, \\alpha, \\beta^*) = (5.0, 1.2, 0.09)$\n\n**步骤 2：使用提取的给定信息进行验证**\n该问题具有科学依据，提法明确且客观。它代表了 CFD 中分析湍流模型保真度的标准流程。所有变量、常数和函数都有明确定义。近壁面湍流建模的物理背景是恰当的。一个潜在的关注点是模型生成项与类 DNS 生成项在壁面附近 ($y^+ \\to 0$) 的渐近行为。模型生成项 $P_{\\mathrm{model}}^+ = \\alpha (k^+/\\omega^+) S^{2+} \\propto (y^+)^2$，而给定的“DNS”生成项 $P_{\\mathrm{DNS}}^+ = p_0 (y^+)^2 (1-e^{-y^+/3}) \\propto (y^+)^3$。这导致生成项比率 $P_{\\mathrm{model}}^+ / P_{\\mathrm{DNS}}^+ \\propto 1/y^+$，该比率在 $y^+ \\to 0$ 时发散。这不是问题陈述中的缺陷；相反，这是标准 $k$-$\\omega$ 模型一个众所周知的不足，称为“生成过量”，而本问题正是为了量化这一点而设计的。在单元中点 $y_j^+  0$ 处采样的离散化方案正确地避免了 $y^+=0$ 处的奇点。因此，该问题是一致的，并具有明确的教学和分析目的。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将提供一个计算解决方案。\n\n**基于原理的设计**\n\n目标是通过编程方式评估标准 $k$-$\\omega$ 湍流模型在粘性底层 ($0  y^+  5$) 的性能。该评估通过将模型的行为与一组模拟直接数值模拟 (DNS) 中观察到的行为的给定解析函数进行比较来执行。分析侧重于两个关键指标：生成过量和湍动能收支中的残差。\n\n对于由参数集 $(\\Delta y^+, \\alpha, \\beta^*)$ 定义的每个测试用例，求解过程系统地进行。\n\n**1. 离散化**\n连续域 $0  y^+  5$ 被离散为有限数量的点。对于给定的单元宽度 $\\Delta y^+$，单元数为 $N = \\left\\lfloor 5 / \\Delta y^+ \\right\\rfloor$。分析在每个单元的中点进行，产生一组离散的壁面法向坐标 $y_j^+$：\n$$y_j^+ = \\left(j - \\frac{1}{2}\\right) \\Delta y^+ \\quad \\text{对于 } j = 1, \\dots, N$$\n这确保了所有采样点都严格为正，$y_j^+ > 0$。\n\n**2. 解析场的评估**\n在每个离散点 $y_j^+$，使用给定的函数形式和常数（$c_k = 0.1$、$a_\\omega = 20$、$y_0 = 0.5$、$p_0 = 0.05$）来评估给定的湍动能 $k^+(y_j^+)$、比耗散率 $\\omega^+(y_j^+)$、应变率项 $S^{2+}(y_j^+)$ 和目标 DNS 生成项 $P_{\\mathrm{DNS}}^+(y_j^+)$ 的解析场：\n- $k^+(y_j^+) = c_k \\, (y_j^+)^2$\n- $\\omega^+(y_j^+) = \\dfrac{a_\\omega}{(y_j^+)^2 + y_0^2}$\n- $S^{2+}(y_j^+) = \\dfrac{1}{2} \\left(1 - 0.05 \\, e^{-y_j^+/2}\\right)$\n- $P_{\\mathrm{DNS}}^+(y_j^+) = p_0 \\, (y_j^+)^2 \\left(1 - e^{-y_j^+/3}\\right)$\n\n**3. 模型项的计算**\n使用评估的解析场，为给定的模型系数 $\\alpha$ 和 $\\beta^*$ 计算标准 $k$-$\\omega$ 模型中的相应项：\n- **涡粘性**：$\\nu_t^+(y_j^+) = \\alpha \\dfrac{k^+(y_j^+)}{\\omega^+(y_j^+)}$\n- **模型生成项**：$P_{\\mathrm{model}}^+(y_j^+) = \\nu_t^+(y_j^+) S^{2+}(y_j^+)$\n- **模型耗散项**：$\\varepsilon_{\\mathrm{model}}^+(y_j^+) = \\beta^* \\omega^+(y_j^+) k^+(y_j^+)$\n\n**4. 误差度量的计算**\n计算两个度量以量化模型的误差。\n\n**a. 生成过量比 ($r_{\\max}$)**\n该度量量化了模型在壁面附近过高预测湍流生成项的趋势。它被计算为在所有离散点上模型生成项与 DNS 生成项之比的最大值：\n$$r_{\\max} = \\max_{j=1, \\dots, N} \\left( \\dfrac{P_{\\mathrm{model}}^+(y_j^+)}{P_{\\mathrm{DNS}}^+(y_j^+)} \\right)$$\n$r_{\\max} > 1$ 的值表示模型在粘性底层中的某一点上相对于参考数据过高地预测了生成项。如前所述，造成这种过量的根本原因是 $P_{\\mathrm{model}}^+$ 和 $P_{\\mathrm{DNS}}^+$ 在 $y^+=0$ 附近的渐近行为不同。\n\n**b. 均方根 (RMS) 平衡误差 ($\\mathrm{RMS}$)**\n该度量衡量模型满足基本近壁面动能平衡的程度，对于定常流 ($\\partial_t k^+ = 0$)，该平衡简化为 $P^+ - \\varepsilon^+ \\approx 0$。该模型平衡的残差为：\n$$R(y_j^+) = \\partial_t k^+(y_j^+) - \\left(P_{\\mathrm{model}}^+(y_j^+) - \\varepsilon_{\\mathrm{model}}^+(y_j^+)\\right) = -\\left(P_{\\mathrm{model}}^+(y_j^+) - \\varepsilon_{\\mathrm{model}}^+(y_j^+)\\right)$$\n然后在所有离散点上计算 RMS 误差为：\n$$\\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left(R(y_j^+)\\right)^2}$$\n这为模型在粘性底层中无法正确平衡生成项和耗散项的情况提供了一个单一的、聚合的度量。\n\n该算法遍历每个指定的测试用例，执行这些计算并收集结果对 $[r_{\\max}, \\mathrm{RMS}]$。最终输出是包含所有用例的这些配对的格式化字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the near-wall performance analysis problem for the k-omega model.\n    \"\"\"\n\n    # Define the fixed physical and model constants from the problem statement.\n    c_k = 0.1\n    a_omega = 20.0\n    y0 = 0.5\n    p0 = 0.05\n    y0_sq = y0**2\n\n    # Define the test cases, each specified by (delta_y_plus, alpha, beta_star).\n    test_cases = [\n        (0.1, 0.52, 0.09),  # Case 1: fine grid, damped alpha\n        (0.5, 1.0, 0.09),   # Case 2: moderate grid, baseline alpha\n        (2.5, 1.0, 0.05),   # Case 3: coarse grid, reduced dissipation\n        (5.0, 1.2, 0.09),   # Case 4: single-cell sublayer, increased alpha\n    ]\n\n    # List to store the results [r_max, RMS] for each case.\n    results = []\n\n    # --- Define the analytical field functions ---\n    def k_plus_func(y_p):\n        return c_k * y_p**2\n\n    def omega_plus_func(y_p):\n        return a_omega / (y_p**2 + y0_sq)\n\n    def s2_plus_func(y_p):\n        return 0.5 * (1 - 0.05 * np.exp(-y_p / 2.0))\n\n    def p_dns_plus_func(y_p):\n        # Using np.expm1 for better precision for small arguments, though not strictly\n        # necessary here as y_p is not extremely small.\n        # Original form: p0 * y_p**2 * (1 - np.exp(-y_p / 3.0))\n        return p0 * y_p**2 * -np.expm1(-y_p / 3.0)\n\n    # Process each test case\n    for case in test_cases:\n        delta_y_plus, alpha, beta_star = case\n\n        # 1. Discretize y+ domain\n        # The domain is 0  y+  5.\n        y_max = 5.0\n        # N = floor(5 / delta_y_plus)\n        N = int(np.floor(y_max / delta_y_plus))\n        \n        # Ensure N is at least 1, as per problem statement\n        if N  1:\n            # This case would be degenerate and is not expected with the given inputs.\n            # For robustness, we could skip it or handle it, but for this problem\n            # we can assume N >= 1.\n            continue\n            \n        # Sample at cell midpoints y_j+ = (j - 1/2) * delta_y_plus for j = 1,...,N\n        j_indices = np.arange(1, N + 1)\n        y_p_grid = (j_indices - 0.5) * delta_y_plus\n\n        # 2. Evaluate analytical fields on the grid\n        k_p = k_plus_func(y_p_grid)\n        omega_p = omega_plus_func(y_p_grid)\n        s2_p = s2_plus_func(y_p_grid)\n        p_dns_p = p_dns_plus_func(y_p_grid)\n        \n        # 3. Compute the k-omega model terms\n        # Eddy viscosity\n        nu_t_p = alpha * k_p / omega_p\n        \n        # Model production\n        p_model_p = nu_t_p * s2_p\n        \n        # Model dissipation\n        epsilon_model_p = beta_star * omega_p * k_p\n        \n        # 4. Evaluate the near-wall balance residual\n        # R = d/dt(k+) - (P_model - epsilon_model)\n        # d/dt(k+) = 0 for steady budgets\n        R = -(p_model_p - epsilon_model_p)\n\n        # 5. Compute production overshoot ratio\n        # Avoid division by zero, though y_p_grid > 0 ensures p_dns_p > 0.\n        # A small epsilon can be added for robustness if p_dns_p could be zero.\n        # But here, it's mathematically guaranteed not to be zero.\n        overshoot_ratios = p_model_p / p_dns_p\n        r_max = np.max(overshoot_ratios)\n\n        # 6. Compute the root-mean-square balance error\n        rms_error = np.sqrt(np.mean(R**2))\n\n        # Store the results for this case\n        results.append([r_max, rms_error])\n\n    # Format the final output string as specified: \"[[r1,e1],[r2,e2],...]\"\n    result_strings = [f\"[{r},{e}]\" for r, e in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3348018"}, {"introduction": "CFD模拟的准确性不仅取决于物理模型，还取决于求解方程所用的数值方法。例如，对流项离散格式的选择会引入数值误差，从而污染物理预测结果。本问题要求你梳理其中的因果链，从迎风格式的数值耗散，到其对最终预测速度剖面的影响，从而磨练你批判性解读模拟结果的能力。[@problem_id:3348019]", "problem": "在摩擦雷诺数 $Re_\\tau \\sim 1000$ 的条件下，使用由双方程 $k$-$\\omega$ 湍流模型封闭的雷诺平均纳维-斯托克斯 (RANS) 方程，计算光滑平板上的零压力梯度湍流边界层。其中，$k$ 是湍动能，$\\omega$ 是比耗散率。涡粘度由形式为 $\\nu_t \\propto k/\\omega$ 的关系式建模。近壁面网格使得第一个单元中心位于 $y^+ \\approx 0.5$，并且缓冲层直至 $y^+ \\approx 30$ 都得到充分解析。关注缓冲层位置 $y^+ \\approx 10$。考虑 $\\omega$ 输运方程中对流项 $\\mathbf{U}\\cdot\\nabla \\omega$ 的两种离散化方法：二阶中心差分格式和二阶迎风格式。所有方程中的所有其他项都以相同方式离散化，并使用相同的线性求解器和收敛准则。假设计算达到统计定常状态，并且中心格式经过稳定化处理，不会出现 $\\omega$ 的伪负值。\n\n仅使用以下基本要素：\n- 带有 Boussinesq 假设的 RANS 平均动量平衡，其中总剪切应力可以写为 $\\tau_{\\text{tot}}(y) \\approx \\rho\\left(\\nu + \\nu_t\\right)\\,\\partial U/\\partial y$，且在内层中 $\\tau_{\\text{tot}} \\approx \\rho u_\\tau^2$ 近似为常数；\n- 在小 $y$ 处，$\\omega$ 向壁面急剧增加的通用内层标度律；\n- 以及一个事实，即标量线性平流的二阶迎风离散化会引入正的数值耗散，从而抑制该标量在流动方向上的梯度，而二阶中心离散化在主导阶上是非耗散的，\n\n定性分析 $\\mathbf{U}\\cdot\\nabla \\omega$ 的离散化选择如何改变缓冲层内 $\\omega$ 的数值耗散，并预测在 $y^+ \\approx 10$ 处解析出的平均速度梯度 $\\partial U/\\partial y$ 的变化方向。选择最能描述在 $\\omega$ 方程中，使用二阶迎风格式而非二阶中心差分格式来处理 $\\mathbf{U}\\cdot\\nabla \\omega$ 所产生后果的选项，其他所有建模和数值细节均保持不变。\n\nA. 二阶迎风格式增加了缓冲层中 $\\omega$ 的数值耗散，倾向于局部减小 $\\omega$；由于 $\\nu_t \\propto k/\\omega$，这会增加 $\\nu_t$，从而通过 $\\tau_{\\text{tot}} \\approx \\rho\\left(\\nu + \\nu_t\\right)\\,\\partial U/\\partial y$，相对于二阶中心格式，减小了在 $y^+ \\approx 10$ 处解析出的 $\\partial U/\\partial y$。\n\nB. 二阶中心格式减少了数值耗散，可能会使近壁处的 $\\omega$ 变得更陡峭，这将减小 $\\nu_t$ 并增加 $\\partial U/\\partial y$；然而，由于 $\\tau_{\\text{tot}}$ 是固定的，在 $y^+ \\approx 10$ 处的局部 $\\partial U/\\partial y$ 不会改变，因此两种格式得到的 $\\partial U/\\partial y$ 相同。\n\nC. $\\mathbf{U}\\cdot\\nabla \\omega$ 的离散化不会影响 $y^+ \\approx 10$ 处的 $\\partial U/\\partial y$，因为对流是切向的，而内层输运在 $y$ 方向上纯粹是扩散性的，这使得二阶中心格式和二阶迎风格式对于缓冲层中的 $\\omega$ 是等效的。\n\nD. 二阶迎风格式减少了 $\\omega$ 的数值耗散，从而增加了 $\\omega$，这会减小 $\\nu_t$ 并增加在 $y^+ \\approx 10$ 处相对于二阶中心格式的 $\\partial U/\\partial y$。", "solution": "用户要求分析 $\\omega$ 输运方程中对流项的数值离散格式对湍流边界层模拟中平均速度剖面的影响。\n\n首先对问题进行验证，确保其在科学上是合理的、适定的和客观的。\n\n**问题验证**\n\n**第一步：提取已知条件**\n-   流动：光滑平板上的零压力梯度湍流边界层。\n-   流动条件：摩擦雷诺数 $Re_\\tau \\sim 1000$。\n-   模拟方法：采用双方程 $k$–$\\omega$ 湍流模型封闭的雷诺平均纳维-斯托克斯 (RANS) 方程。\n-   湍流变量：$k$ (湍动能) 和 $\\omega$ (比耗散率)。\n-   涡粘度关系：$\\nu_t \\propto k/\\omega$。\n-   网格分辨率：第一个单元中心位于 $y^+ \\approx 0.5$，缓冲层 ($y^+ \\lesssim 30$) 得到充分解析。\n-   关注位置：缓冲层，$y^+ \\approx 10$。\n-   数值比较：针对 $\\omega$ 对流项 $\\mathbf{U}\\cdot\\nabla \\omega$ 的二阶中心差分格式与二阶迎风格式。\n-   受控条件：所有其他数值方面（其他项的离散化、求解器、收敛准则）均相同。中心格式被假定为已稳定化，以防止非物理振荡。\n-   分析的基本原则：\n    1.  平均动量平衡：$\\tau_{\\text{tot}}(y) \\approx \\rho\\left(\\nu + \\nu_t\\right)\\,\\partial U/\\partial y$。\n    2.  内层应力假设：$\\tau_{\\text{tot}} \\approx \\rho u_\\tau^2$ (常数)。\n    3.  $\\omega$ 的已知行为：$\\omega$ 向壁面急剧增加。\n    4.  数值格式的性质：二阶迎风格式具有数值耗散性；二阶中心格式则不然（在主导阶上）。\n\n**第二步：使用提取的已知条件进行验证**\n该问题陈述在计算流体动力学 (CFD)、湍流建模和数值分析的原理上具有科学依据。其设置描述了一个标准的 RANS 模拟场景。问题是适定的，要求基于数值方法的明确变化进行定性预测。语言客观而精确。所提供的基本原则是该领域内的标准和正确假设/事实。问题是自洽的、一致的，并且没有违反任何物理或数学定律。它提出了一个关于数值计算与湍流建模之间相互作用的非平凡问题。\n\n**第三步：结论与行动**\n问题陈述是**有效的**。现在将推导解决方案。\n\n**解决方案的推导**\n\n目标是确定将 $\\omega$ 方程中对流项 $\\mathbf{U}\\cdot\\nabla \\omega$ 的离散化从二阶中心格式切换到二阶迎风格式，如何影响在 $y^+ \\approx 10$ 处解析出的平均速度梯度 $\\partial U/\\partial y$。分析将通过建立一个因果链来进行，从数值格式的性质开始。\n\n1.  **离散格式对 $\\omega$ 场的影响**：\n    问题中给出，二阶迎风格式会引入正的数值耗散，而二阶中心格式在主导阶上是非耗散的。数值耗散在数学上的作用类似于一个额外的扩散项，它倾向于抑制或“抹平”解中的梯度，并减小尖峰的幅度。\n\n    问题还指出，在内层中，$\\omega$ 向壁面急剧增加。这意味着在近壁区，包括 $y^+ \\approx 10$ 的缓冲层，$\\omega$ 场具有大的数值和强的梯度。\n\n    -   二阶中心格式由于其非耗散性，将更好地保留所建模的 $\\omega$ 方程“真实”解的高幅值、强梯度的特征。\n    -   二阶迎风格式由于其固有的数值耗散，将起到抑制 $\\omega$ 场的作用。这种抑制效应在 $\\omega$ 值大且其梯度强的近壁区最为显著。\n\n    因此，在缓冲层中的给定位置 ($y^+ \\approx 10$)，使用迎风格式的计算将预测出比使用中心格式的计算更低的 $\\omega$ 值。设 $\\omega_{upwind}$ 和 $\\omega_{central}$ 分别为用相应格式计算出的 $\\omega$ 值。我们得出结论：\n    $$ \\omega_{upwind}  \\omega_{central} \\quad \\text{在 } y^+ \\approx 10 \\text{ 处} $$\n\n2.  **对涡粘度 $\\nu_t$ 的影响**：\n    涡粘度 $\\nu_t$ 由关系式 $\\nu_t \\propto k/\\omega$ 给出。对于此定性分析，我们可以写成 $\\nu_t = C k/\\omega$，其中 $C$ 为某个常数。改变 $\\omega$ 方程的离散化方法，其主要、直接的影响是在 $\\omega$ 场本身。虽然 $k$ 场也会通过 $k$ 和 $\\omega$ 方程的耦合（例如，通过 $k$ 方程中与 $k\\omega$ 成正比的耗散项）而受到影响，但对 $\\nu_t$ 计算最直接的冲击来自于分母中 $\\omega$ 的变化。\n\n    既然我们确定了 $\\omega_{upwind}  \\omega_{central}$，并且 $\\nu_t$ 与 $\\omega$ 成反比，使用迎风格式将导致计算出的涡粘度更高：\n    $$ (\\nu_t)_{upwind}  (\\nu_t)_{central} \\quad \\text{在 } y^+ \\approx 10 \\text{ 处} $$\n\n3.  **对平均速度梯度 $\\partial U/\\partial y$ 的影响**：\n    在湍流边界层的内层，使用 Boussinesq 假设的动量平衡方程为：\n    $$ \\tau_{\\text{tot}}(y) \\approx \\rho\\left(\\nu + \\nu_t\\right)\\,\\frac{\\partial U}{\\partial y} $$\n    这里，$\\nu$ 是分子粘度。我们还被告知内层的总应力恒定假设：\n    $$ \\tau_{\\text{tot}}(y) \\approx \\tau_w = \\rho u_\\tau^2 $$\n    其中 $\\tau_w$ 是壁面剪切应力，$u_\\tau$ 是摩擦速度。\n\n    将这两个表达式结合起来并解出平均速度梯度 $\\partial U/\\partial y$，我们得到：\n    $$ \\frac{\\partial U}{\\partial y} = \\frac{\\tau_{\\text{tot}}/\\rho}{\\nu + \\nu_t} = \\frac{u_\\tau^2}{\\nu + \\nu_t} $$\n    该方程表明，平均速度梯度与总粘度 $(\\nu + \\nu_t)$ 成反比关系。\n\n    我们发现迎风格式导致了更大的涡粘度，$(\\nu_t)_{upwind}  (\\nu_t)_{central}$。将此代入 $\\partial U/\\partial y$ 表达式的分母中：\n    $$ \\nu + (\\nu_t)_{upwind}  \\nu + (\\nu_t)_{central} $$\n    由于迎风格式情况下的分母更大，分数的值将更小。因此，我们预测解析出的平均速度梯度将*减小*：\n    $$ \\left(\\frac{\\partial U}{\\partial y}\\right)_{upwind}  \\left(\\frac{\\partial U}{\\partial y}\\right)_{central} \\quad \\text{在 } y^+ \\approx 10 \\text{ 处} $$\n\n**因果链总结：**\n迎风格式 $\\implies$ 增加的数值耗散 $\\implies$ 减小的 $\\omega$ $\\implies$ 增加的 $\\nu_t$ $\\implies$ 减小的 $\\partial U/\\partial y$。\n\n**逐项分析**\n\n*   **A. 二阶迎风格式增加了缓冲层中 $\\omega$ 的数值耗散，倾向于局部减小 $\\omega$；由于 $\\nu_t \\propto k/\\omega$，这会增加 $\\nu_t$，从而通过 $\\tau_{\\text{tot}} \\approx \\rho\\left(\\nu + \\nu_t\\right)\\,\\partial U/\\partial y$，相对于二阶中心格式，减小了在 $y^+ \\approx 10$ 处解析出的 $\\partial U/\\partial y$。**\n    该陈述与上面推导的逻辑链完全吻合。每一步都具有因果联系，并且基于所提供的原则是正确的。\n    结论：**正确**。\n\n*   **B. 二阶中心格式减少了数值耗散，可能会使近壁处的 $\\omega$ 变得更陡峭，这将减小 $\\nu_t$ 并增加 $\\partial U/\\partial y$；然而，由于 $\\tau_{\\text{tot}}$ 是固定的，在 $y^+ \\approx 10$ 处的局部 $\\partial U/\\partial y$ 不会改变，因此两种格式得到的 $\\partial U/\\partial y$ 相同。**\n    推理的开头部分是合理的，但结论存在根本性缺陷。总应力 $\\tau_{\\text{tot}}$ 恒定并不意味着速度梯度 $\\partial U/\\partial y$ 恒定。关系式是 $\\tau_{\\text{tot}}/\\rho = (\\nu + \\nu_t)(\\partial U/\\partial y)$。如果数值格式改变了 $\\nu_t$，那么为了保持 $\\tau_{\\text{tot}}$ 恒定，$\\partial U/\\partial y$ *必须*改变。断言 $\\partial U/\\partial y$ 不能改变是错误的。\n    结论：**不正确**。\n\n*   **C. $\\mathbf{U}\\cdot\\nabla \\omega$ 的离散化不会影响 $y^+ \\approx 10$ 处的 $\\partial U/\\partial y$，因为对流是切向的，而内层输运在 $y$ 方向上纯粹是扩散性的，这使得二阶中心格式和二阶迎风格式对于缓冲层中的 $\\omega$ 是等效的。**\n    该陈述错误地声称对流格式的选择是无关紧要的。边界层不是一个输运纯粹在 $y$ 方向上是扩散性的一维问题。存在流向对流 ($U\\,\\partial\\omega/\\partial x$)，它将信息从上游平流过来。该项的离散化会影响整个下游的解。因此，在迎风和中心格式之间的选择是重要的，并将导致不同的 $\\omega$ 解。格式“等效”的前提是错误的。\n    结论：**不正确**。\n\n*   **D. 二阶迎风格式减少了 $\\omega$ 的数值耗散，从而增加了 $\\omega$，这会减小 $\\nu_t$ 并增加在 $y^+ \\approx 10$ 处相对于二阶中心格式的 $\\partial U/\\partial y$。**\n    此选项的初始前提是错误的。相对于二阶中心格式，二阶迎风格式*增加*了数值耗散，而不是减少它。其后整个推理链都建立在这个错误的前提之上。此选项描述的是从迎风切换到中心格式的效果，而不是从中心切换到迎风格式。\n    结论：**不正确**。\n\n唯一提出正确且完整的物理和数值论证的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "3348019"}]}