{"hands_on_practices": [{"introduction": "掌握近壁区尺度分析是理解和应用壁面律的第一步。这个练习将引导你计算湍流边界层中的两个核心无量纲参数：摩擦速度 $u_{\\tau}$ 和壁面单位坐标 $y^+$。通过这个基本计算，你将能够确定一个点是否位于对数律适用的区域，这是在CFD中正确选择壁面处理方法的关键前提。[@problem_id:3375922]", "problem": "在一个计算流体力学环境中，考虑空气在一个光滑平坦壁面上充分发展的湍流边界层。设壁面剪切应力通过高保真近壁面评估已知为 $\\tau_{w}=0.5$ Pa，质量密度为 $\\rho=1.2$ kg/m$^{3}$，运动粘度为 $\\nu=1.5\\times 10^{-5}$ m$^{2}$/s，所有参数均在同一热力学状态下。在距壁面法向距离 $y=1$ mm处，使用基本定义引入近壁面速度尺度和相应的内坐标（壁面单位）。从将壁面剪切应力解释为单位面积的动量通量以及通过平衡粘性扩散与近壁面剪切得到的粘性长度尺度的概念开始。给出速度尺度和壁面单位坐标的表达式，然后使用给定参数对其进行求值。最后，讨论计算出的壁面单位坐标是否位于对数律壁面法则在光滑壁面上的高雷诺数湍流边界层中通常有效的范围内。\n\n将速度尺度以m/s表示，壁面单位坐标表示为无量纲数。将两个数值都四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它科学地基于流体力学原理，特别是湍流边界层理论，其提法适定，数据充分且一致，并且表述客观。我们可以着手求解。\n\n该问题要求分析湍流边界层的近壁面区域。此分析的关键是使用内尺度变换，该方法基于从壁面特性导出的特征尺度来对变量进行归一化。\n\n首先，我们考虑壁面剪切应力 $\\tau_w$。这个量表示流体施加在壁面上的单位面积切向力。从量纲的角度来看，其单位是力每面积，在国际单位制基本单位中为 $\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$。在动量的背景下，$\\tau_w$ 可以解释为从流体到壁面的单位面积动量传递速率（通量）。给定流体密度 $\\rho$，其单位为质量每体积 ($\\text{kg} \\cdot \\text{m}^{-3}$)，比率 $\\frac{\\tau_w}{\\rho}$ 的单位为 $(\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}) / (\\text{kg} \\cdot \\text{m}^{-3}) = \\text{m}^2 \\cdot \\text{s}^{-2}$，这对应于速度的平方。这引出了近壁面区域特征速度尺度的定义，即摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\n\n接下来，我们建立一个特征长度尺度。在紧邻壁面的区域（粘性底层），动量传递由粘性扩散主导。控制此扩散的参数是运动粘度 $\\nu$，单位为 $\\text{m}^2 \\cdot \\text{s}^{-1}$。通过平衡特征速度 $u_{\\tau}$ 和運動粘度 $\\nu$，我们可以构成一个长度尺度。粘性长度尺度 $\\delta_{\\nu}$ 定义为：\n$$\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$$\n该长度尺度提供了粘性效应占主导地位区域厚度的一种度量。\n\n使用这两个尺度，我们可以定义无量纲变量，也称为内坐标或壁面单位。无量纲壁面法向距离，记为 $y^+$，是物理距离 $y$ 被粘性长度尺度 $\\delta_{\\nu}$ 归一化后的结果。\n$$y^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}$$\n问题要求计算速度尺度 $u_{\\tau}$ 和壁面单位坐标 $y^+$。\n\n给定参数如下：\n- 壁面剪切应力, $\\tau_{w} = 0.5 \\text{ Pa} = 0.5 \\text{ kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$\n- 质量密度, $\\rho = 1.2 \\text{ kg} \\cdot \\text{m}^{-3}$\n- 运动粘度, $\\nu = 1.5 \\times 10^{-5} \\text{ m}^2 \\cdot \\text{s}^{-1}$\n- 壁面法向距离, $y = 1 \\text{ mm} = 1 \\times 10^{-3} \\text{ m}$\n\n首先，我们计算摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = \\sqrt{\\frac{0.5}{1.2}} = \\sqrt{0.41666...} \\approx 0.64549722 \\text{ m/s}$$\n四舍五入到四位有效数字，速度尺度为：\n$$u_{\\tau} \\approx 0.6455 \\text{ m/s}$$\n\n接下来，我们计算无量纲壁面单位坐标 $y^+$：\n$$y^{+} = \\frac{y u_{\\tau}}{\\nu} = \\frac{(1 \\times 10^{-3}) \\times (0.64549722)}{1.5 \\times 10^{-5}}$$\n$$y^{+} = \\frac{0.64549722 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{0.64549722}{1.5} \\times 10^2 \\approx 43.033148$$\n四舍五入到四位有效数字，壁面单位坐标为：\n$$y^{+} \\approx 43.03$$\n\n最后，我们讨论计算出的 $y^+$ 值是否位于对数律壁面法则有效的区域内。光滑壁面上的高雷诺数湍流边界层的近壁面区域通常根据 $y^+$ 的值进行分层：\n1.  **粘性底层 (Viscous Sublayer):** 对于 $y^{+} \\lesssim 5$，粘性应力主导湍流雷诺应力。平均速度剖面是线性的，由 $u^{+} = y^{+}$ 给出，其中 $u^{+}$ 是无量纲速度 $u/u_{\\tau}$。\n2.  **缓冲层 (Buffer Layer):** 对于 $5 \\lesssim y^{+} \\lesssim 30$，粘性应力和湍流应力的大小相当。这是粘性底层和对数区域之间的过渡区域。\n3.  **对数律区域 (Log-Law Region):** 对于 $y^{+} \\gtrsim 30$（并延伸至总边界层厚度的某个分数，例如 $y/\\delta  0.2$），湍流应力占主导地位。平均速度剖面由对数律描述：\n    $$u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$$\n    其中 $\\kappa \\approx 0.41$ 是 von Kármán 常数，$B \\approx 5.0$ 是光滑壁面的积分常数。\n\n我们计算出的值为 $y^{+} \\approx 43.03$。这个值大于 $30$，恰好位于对数律区域内。因此，在给定的流动条件下，于指定的壁面法向距离 $y = 1$ mm处应用对数律壁面法则来估计平均速度，在物理上是一致且合适的。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6455  43.03 \\end{pmatrix}}$$", "id": "3375922"}, {"introduction": "壁面函数在CFD中通过将壁面剪切应力与近壁单元的平均速度关联起来，从而绕过对黏性子层的直接解析。这个练习要求你从对数律的隐式关系出发，推导出壁面剪切应力 $\\tau_w$ 的一个显式表达式。这个推导过程不仅揭示了壁面函数在求解器中的数学实现，还引入了朗伯W函数（Lambert W function）这一强大的数学工具。[@problem_id:3375982]", "problem": "在光滑、不可渗透壁面上的高雷诺数湍流中，考虑一种计算流体力学(CFD)的有限体积离散格式，其中紧邻壁面的控制体中心位于距壁面法向距离为$y_P$处，其平均流向速度大小为$U_P$。壁面剪切应力大小表示为$\\tau_w$，流体密度为$\\rho$，运动粘度为$\\nu$。定义摩擦速度$u_{\\tau}$为$u_{\\tau} = \\sqrt{\\tau_w/\\rho}$，以及标准的内尺度变量$U^{+} = U/u_{\\tau}$和$y^{+} = y\\,u_{\\tau}/\\nu$。\n\n假设紧邻壁面点的平均速度位于对数区，并使用经过充分检验的光滑壁面对数律对其进行建模，\n$$\nU^{+} = \\frac{1}{\\kappa} \\ln\\!\\left(y^{+}\\right) + B,\n$$\n其中$\\kappa$是 von Kármán 常数，$B$是光滑壁面截距。仅使用上述定义和该经验定律，推导壁面剪切应力大小$\\tau_w$作为已知量$U_P$、$y_P$、$\\rho$、$\\nu$、$\\kappa$和$B$的函数的显式闭合形式表达式。如果需要，您可以使用特殊函数。请将最终答案表示为$\\tau_w$的单个解析表达式。无需进行数值计算，也无需在最终表达式中包含单位。", "solution": "该问题要求基于壁面对数律推导壁面剪切应力大小$\\tau_w$的显式闭合形式表达式。推导将从给定的经验定律开始，通过代数变换来分离出$\\tau_w$。\n\n出发点是在紧邻壁面的控制体中心$P$处评估的壁面对数律：\n$$\nU_P^{+} = \\frac{1}{\\kappa} \\ln(y_P^{+}) + B\n$$\n无量纲速度$U_P^{+}$和无量纲壁面距离$y_P^{+}$是根据摩擦速度$u_{\\tau}$定义的。其定义如下：\n$$\nU_P^{+} = \\frac{U_P}{u_{\\tau}}\n$$\n$$\ny_P^{+} = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n摩擦速度$u_{\\tau}$本身由壁面剪切应力$\\tau_w$和流体密度$\\rho$定义：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n将$U_P^{+}$和$y_P^{+}$的定义代入对数律方程，得到一个关于$u_{\\tau}$的隐式表达式：\n$$\n\\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\n$$\n我们的目标是解出该方程中的$u_{\\tau}$，然后利用其定义求出$\\tau_w$。为了解这个超越方程，我们将把它重新整理成可以使用 Lambert W 函数求解的形式。Lambert W 函数，记作$W(z)$，是方程 $z = W(z) \\exp(W(z))$ 的解，或者等价地说，对于给定的常数 $c$，方程 $x \\exp(x) = c$ 的解是 $x = W(c)$。\n\n我们从指数化后的对数律方程开始：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}} - \\kappa B\\right) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n利用指数性质 $\\exp(a-b) = \\exp(a)\\exp(-b)$，我们分离出包含$u_\\tau$的项：\n$$\n\\exp\\left(\\kappa \\frac{U_P}{u_{\\tau}}\\right) \\exp(-\\kappa B) = \\frac{y_P u_{\\tau}}{\\nu}\n$$\n现在，我们将所有与$u_\\tau$相关的项移到一边，常数项移到另一边：\n$$\n\\frac{1}{u_{\\tau}} \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P}{\\nu} \\exp(\\kappa B)\n$$\n这个方程的形式已经非常接近 Lambert W 函数的定义。为了得到 $z \\exp(z) = c$ 的标准形式，我们注意到指数的参数是 $\\frac{\\kappa U_P}{u_{\\tau}}$。因此，我们将方程两边同时乘以 $\\kappa U_P$：\n$$\n\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) \\exp\\left(\\frac{\\kappa U_P}{u_{\\tau}}\\right) = \\frac{y_P U_P \\kappa}{\\nu} \\exp(\\kappa B)\n$$\n这个方程现在是标准形式 $z \\exp(z) = c$，其中：\n$$ z = \\frac{\\kappa U_P}{u_{\\tau}} $$\n$$ c = \\frac{y_P U_P \\kappa}{\\nu} \\exp(\\kappa B) $$\n$z$的解由 Lambert W 函数的主支给出，即 $z = W(c)$。\n$$\n\\frac{\\kappa U_P}{u_{\\tau}} = W\\left(\\frac{y_P U_P \\kappa}{\\nu} \\exp(\\kappa B)\\right)\n$$\n现在，我们可以显式地解出$u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{\\kappa U_P}{W\\left(\\frac{y_P U_P \\kappa}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n最后，我们将$u_{\\tau}$的这个表达式代入壁面剪切应力的定义$\\tau_w = \\rho u_{\\tau}^2$中：\n$$\n\\tau_w = \\rho \\left( \\frac{\\kappa U_P}{W\\left(\\frac{y_P U_P \\kappa}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2\n$$\n这可以写成：\n$$\n\\tau_w = \\rho \\frac{\\kappa^2 U_P^2}{\\left[W\\left(\\frac{y_P U_P \\kappa}{\\nu}\\exp(\\kappa B)\\right)\\right]^2}\n$$\n这就是$\\tau_w$作为给定数量$U_P$、$y_P$、$\\rho$、$\\nu$、$\\kappa$和$B$的函数的显式闭合形式表达式。Lambert W 函数的参数中的所有量都是正的，因此存在唯一的实数解。", "answer": "$$\n\\boxed{\\rho \\frac{\\kappa^2 U_P^2}{\\left[W\\left(\\frac{y_P U_P \\kappa}{\\nu}\\exp(\\kappa B)\\right)\\right]^2}}\n$$", "id": "3375982"}, {"introduction": "标准壁面函数的一个核心假设是，第一个离壁网格点位于对数律区域。当网格过密，导致该点落入黏性子层或缓冲层时，会发生什么？这个练习通过一个编程任务，让你亲手量化这种“模型-网格不匹配”所导致的误差，深刻理解在RANS模拟中选择合适的第一层网格高度的重要性。[@problem_id:3391066]", "problem": "考虑一个靠近固体壁面的统计稳态、充分发展的湍流，采用雷诺平均纳维-斯托克斯 (RANS) 封闭模型进行建模，并对其进行一维壁面法向离散化。第一个单元中心距离壁面为 $y_1$，单元厚度均匀为 $\\Delta y$，因此 $y_1 = \\Delta y/2$。假设流体为牛顿流体，其密度 $\\rho$ 和运动粘度 $\\nu$ 均为常数。设摩擦速度为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，其中 $\\tau_w$ 是壁面剪切应力。定义内尺度变量 $y^+ = y u_\\tau/\\nu$ 和 $U^+ = U/u_\\tau$，其中 $U$ 是平均流向速度。\n\n作为一个经过充分检验的物理事实，在粘性子层中，平均速度满足 $U^+ \\approx y^+$；在对数律层中，平均速度满足 $U^+ \\approx \\frac{1}{\\kappa} \\ln(y^+) + B$，其中 $\\kappa$ 是 von Kármán 常数，B 是一个经验截距。在许多 RANS 封闭模型中，标准壁面函数在第一个离壁点上施加对数关系，以推断壁面剪切应力。\n\n您的任务是，基于上述定义和事实，通过纯粹的数学和算法构建，证明当使用标准壁面函数（壁面律的对数律）时，将第一个节点放置在 $y^+ \\approx 5$ 处所引入的不一致性，并估计由此导致的 $\\tau_w$ 误差。对每个测试案例，请按以下步骤进行：\n\n1. 将 $(\\rho,\\nu,u_\\tau)$ 作为给定常数。对于一个预设的目标 $y_1^+$，构建一个网格，其 $\\Delta y$ 满足 $y_1 = \\Delta y/2$ 且 $y_1^+ = y_1 u_\\tau/\\nu$ 等于该目标值。这意味着 $\\Delta y = 2 y_1$ 且 $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$。\n2. 在 $y_1$ 处生成一个与以下参考近壁行为一致的合成“真实”平均速度 $U$：\n   - 若 $y_1^+ \\leq 5$，使用粘性子层关系 $U^+ = y^+$ 来设置 $U = u_\\tau \\, y_1^+$。\n   - 若 $y_1^+ \\geq 30$，使用对数关系 $U^+ = \\dfrac{1}{\\kappa} \\ln(y^+) + B$ 来设置 $U = u_\\tau \\left(\\dfrac{1}{\\kappa} \\ln(y_1^+) + B\\right)$。\n   - 测试套件中不使用 $5  y^+  30$ 之间的过渡区，因此不需要额外的建模。\n3. 通过在 $y_1$ 处反解对数关系，从 $U$ 估算出“推断出的”摩擦速度 $\\hat{u}_\\tau$，从而模拟标准壁面函数对壁面剪切应力的推断。具体来说，即在以下非线性方程中求解 $\\hat{u}_\\tau$：\n   $$ \\frac{U}{\\hat{u}_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B. $$\n   然后计算推断出的壁面剪切应力 $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$。\n4. 计算真实壁面剪切应力 $\\tau_w = \\rho \\, u_\\tau^2$ 和相对误差\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   将 $e$ 以十进制数形式报告。\n\n使用常数 $\\rho = 1000$ ($\\mathrm{kg/m^3}$), $\\nu = 10^{-6}$ ($\\mathrm{m^2/s}$), $u_\\tau = 0.2$ ($\\mathrm{m/s}$), $\\kappa = 0.41$, 以及 $B = 5.2$。通过设定以下 $y_1^+$ 目标值来构建四个测试案例：\n- 案例 A（深处粘性子层）：$y_1^+ = 0.5$。\n- 案例 B（靠近粘性-对数过渡区）：$y_1^+ = 5$。\n- 案例 C（对数律层入口）：$y_1^+ = 30$。\n- 案例 D（深入对数律层）：$y_1^+ = 100$。\n\n对于每个案例，执行上述步骤并计算相对误差 $e$（无量纲）。您的程序应生成单行输出，其中包含四个相对误差，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到六位小数，例如“$[e_A,e_B,e_C,e_D]$”。不应打印任何其他文本或格式。所有使用物理单位的中间量都应与指定的单位保持内部一致，壁面剪切应力 $\\tau_w$ 的单位是 $\\mathrm{Pa}$；报告的相对误差 $e$ 是无量纲的，必须表示为十进制数。", "solution": "目标是量化当第一个近壁节点位于 $y^+ \\approx 5$ 处，却施加基于对数律的标准壁面函数来推断壁面剪切应力时所引入的不一致性。我们从近壁湍流的基本定义和经过充分检验的事实出发。\n\n首先，根据壁面剪切应力 $\\tau_w$ 定义摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$。通过内尺度 $y^+ = y \\, u_\\tau/\\nu$ 和 $U^+ = U/u_\\tau$ 引入壁面单位。在靠近壁面的统计稳态、充分发展的湍流中，由于雷诺剪切应力与粘性应力相比可以忽略不计，平均动量方程在紧邻壁面的区域得以简化。因此，总应力近似等于粘性应力，即 $\\tau \\approx \\mu \\, \\dfrac{dU}{dy}$，其中 $\\mu = \\rho \\nu$ 是动力粘度。对这种近壁行为进行积分，可以得到对于 $y^+ \\lesssim 5$ 区域经过充分检验的粘性子层关系 $U^+ \\approx y^+$。\n\n远离壁面时，使用混合长度封闭模型（雷诺平均纳维-斯托克斯建模中一个被广泛接受的基础）的经验和理论论证导出了边界层平衡区域的壁面律对数律，$U^+ \\approx \\dfrac{1}{\\kappa}\\ln(y^+) + B$ (适用于 $y^+ \\gtrsim 30$)，其中 $\\kappa$ 是 von Kármán 常数，B 是一个经验截距。这两个经过充分检验的事实构成了许多计算流体动力学壁面处理方法的基础。\n\n一个典型的“标准壁面函数”在第一个离壁点施加对数关系，以便从距离壁面 $y_1$ 处计算出的平均速度 $U$ 来推断 $u_\\tau$（并由此推断 $\\tau_w$）。摩擦速度 $u_\\tau$ 本身控制着内尺度 $y^+$，这意味着在给定 $U$ 和 $y_1$ 的情况下求解 $u_\\tau$ 时会涉及非线性问题。如果第一个节点位于粘性子层中，用对数关系替代线性关系会产生不一致性。我们通过比较由一致的近壁关系计算出的“真实”壁面剪切应力与通过反解对数律得到的“推断出的”壁面剪切应力，来量化这种不一致性。\n\n基于这些原理的算法步骤：\n\n1. 固定物理常数 $\\rho$、$\\nu$、$\\kappa$、B 以及一个表征目标流场的“真实”摩擦速度 $u_\\tau$。真实的壁面剪切应力为 $\\tau_w = \\rho \\, u_\\tau^2$。\n2. 对于每个目标 $y_1^+$，计算网格间距，使得第一个单元中心位于 $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$ 处，并且根据均匀单元的一维壁面法向离散化要求，$\\Delta y = 2 y_1$。\n3. 通过选择与已知 $u_\\tau$ 一致的适当近壁关系，在 $y_1$ 处生成一个合成的“真实”平均速度 $U$：\n   - 若 $y_1^+ \\leq 5$，使用粘性子层关系：$U^+ = y_1^+ \\Rightarrow U = u_\\tau \\, y_1^+$。\n   - 若 $y_1^+ \\geq 30$，使用对数律：$U^+ = \\dfrac{1}{\\kappa}\\ln(y_1^+) + B \\Rightarrow U = u_\\tau\\left(\\dfrac{1}{\\kappa}\\ln(y_1^+) + B\\right)$。\n4. 通过求解在 $y_1$ 处施加的对数关系，得到推断出的摩擦速度 $\\hat{u}_\\tau$，从而模拟标准壁面函数。需要求解的方程是\n   $$ g(\\hat{u}_\\tau) = \\frac{U}{\\hat{u}_\\tau} - \\left[\\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B\\right] = 0, $$\n   对于 $\\hat{u}_\\tau  0$，此方程是适定的，因为第一项随 $\\hat{u}_\\tau$ 增大而减小，第二项则对数增长，这确保了根的唯一性。可以使用如 Brent 括号法等稳健的数值方法在一个宽区间（例如，在一个很小的正数下界和一个很大的上界之间）内找到根，因为对于物理上合理的输入，$g$ 在这样的范围内会出符号变化。\n5. 计算推断出的壁面剪切应力 $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$ 和相对误差\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   这个误差是无量纲的，直接量化了在第一个节点处使用对数律所引入的不一致性。\n6. 将此程序应用于为探测不同区域而设计的四个测试案例：\n   - $y_1^+ = 0.5$（深处粘性子层，预期有大的不一致性），\n   - $y_1^+ = 5$（靠近过渡区，即我们关注的案例），\n   - $y_1^+ = 30$（对数律区域入口，预期具有一致性），\n   - $y_1^+ = 100$（深入对数律区域，预期具有一致性）。\n7. 以指定的单行格式，将误差 $e$ 报告为包含四个四舍五入到六位小数的十进制数的列表。\n\n科学解释：对于 $y_1^+ \\leq 5$ 的情况，真实的 $U^+$ 随 $y^+$ 线性增长，而对数律仅呈对数增长。当使用一个在相同位置实际上符合线性律的速度来反解对数关系时，为了使观测到的较大 $U/u_\\tau$ 值与对数表达式相符，推断出的 $\\hat{u}_\\tau$ 相对于真实的 $u_\\tau$ 会减小，这导致对 $\\hat{\\tau}_w$ 的严重低估。相反，对于 $y_1^+ \\geq 30$ 的情况，如果 $U$ 符合对数律，反解同一个定律会再现正确的 $u_\\tau$，因此 $\\tau_w$ 的误差可以忽略不计。这证明了在使用标准壁面函数时，将第一个节点放置得太靠近壁面所带来的不一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    # Physical and model constants (units: rho [kg/m^3], nu [m^2/s], u_tau [m/s])\n    rho = 1000.0\n    nu = 1e-6\n    u_tau_true = 0.2\n    kappa = 0.41\n    B = 5.2\n\n    # Test cases specified by target y1^+ values\n    yplus_targets = [0.5, 5.0, 30.0, 100.0]\n\n    def U_true_at_y1(yplus):\n        \"\"\"\n        Compute synthetic 'true' mean velocity U at y1 for a given yplus = y1^+,\n        using viscous sublayer for yplus = 5, and log-law for yplus = 30.\n        \"\"\"\n        if yplus = 5.0:\n            # Viscous sublayer: U+ = y+\n            return u_tau_true * yplus\n        else: # Covers yplus >= 30, as per problem description\n            # Log-law: U+ = (1/kappa) ln(y+) + B\n            return u_tau_true * ((1.0 / kappa) * np.log(yplus) + B)\n\n    def infer_u_tau_from_log(U, y1):\n        \"\"\"\n        Infer friction velocity u_tau by inverting the log-law at y1:\n            U/u = (1/kappa) ln(y1 * u / nu) + B\n        Solve g(u) = 0 with a robust bracket.\n        \"\"\"\n        def g(u):\n            if u = 0:  # Avoid domain errors in log\n                return float('inf')\n            return U / u - ((1.0 / kappa) * np.log(y1 * u / nu) + B)\n\n        # Use a wide bracket to ensure a sign change for physically plausible U, y1\n        lower = 1e-8\n        upper = 1e4\n        # Ensure the function is defined in the bracket\n        return brentq(g, lower, upper, maxiter=200, xtol=1e-12)\n\n    results = []\n    for yplus_target in yplus_targets:\n        # Construct grid: y1 = yplus_target * nu / u_tau_true\n        y1 = yplus_target * nu / u_tau_true\n        # Synthetic \"true\" velocity at y1\n        U = U_true_at_y1(yplus_target)\n        # Inferred friction velocity from standard wall function (log-law)\n        u_tau_inferred = infer_u_tau_from_log(U, y1)\n        # Compute wall shear stresses\n        tau_w_true = rho * (u_tau_true ** 2)\n        tau_w_inferred = rho * (u_tau_inferred ** 2)\n        # Relative error as a decimal number\n        error = (tau_w_inferred - tau_w_true) / tau_w_true\n        results.append(error)\n\n    # Final print statement in the exact required format, rounded to six decimals.\n    print(f\"[{','.join(f'{e:.6f}' for e in results)}]\")\n\nsolve()\n```", "id": "3391066"}]}