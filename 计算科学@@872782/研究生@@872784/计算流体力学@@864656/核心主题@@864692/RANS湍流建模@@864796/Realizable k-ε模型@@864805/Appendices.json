{"hands_on_practices": [{"introduction": "在计算流体动力学中，对壁湍流的精确建模至关重要。本练习将理论与实践相结合，探讨可实现 $k$-$\\epsilon$ 模型在近壁区的行为，该区域由经典的壁面律主导。通过推导耗散率 $\\epsilon$ 的壁函数，您将深入理解该模型如何与经过充分验证的物理标度律保持一致，这是理解和应用壁函数的关键一步。[@problem_id:3378984]", "problem": "考虑高雷诺数下不可压缩湍流槽道流的近壁对数区，在该区域，湍动能的产生与耗散达到平衡。令 $y$ 表示从壁面测量的壁面法向坐标，$U(y)$ 表示平均流向速度，$\\nu$ 表示运动粘度，$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$ 表示由壁面剪切应力 $\\tau_{w}$ 和密度 $\\rho$ 定义的摩擦速度，$\\kappa$ 表示 von Kármán 常数。Reynolds平均Navier–Stokes方程通过Boussinesq涡粘假设进行封闭，可实现的 $k$-$\\epsilon$ 模型使用的湍流粘度形式为 $\\nu_{t} = C_{\\mu} k^{2}/\\epsilon$，其中 $k$ 是湍动能，$\\epsilon$ 是耗散率，$C_{\\mu}0$ 是一个有界的、依赖于应变的系数，它确保了可实现性约束，但在对数层中保持为有限正值。\n\n从以下条件出发：\n- 产生项 $P_{k}$ 与耗散项之间的平衡条件 $P_{k} = \\epsilon$，\n- 平均应变率张量 $S_{ij} = \\frac{1}{2}(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i})$ 的定义以及产生项 $P_{k} = 2 \\nu_{t} S_{ij} S_{ij}$，\n- 经验性的壁面律对数定律 $U^{+} = \\frac{1}{\\kappa} \\ln y^{+} + B$，及其在对数层中隐含的平均剪切标度 $\\mathrm{d}U/\\mathrm{d}y \\sim u_{\\tau}/(\\kappa y)$，\n\n分析在这些条件下可实现的 $k$-$\\epsilon$ 闭合模型的近壁渐近行为，并推导当主导阶湍流粘度遵循 $\\nu_{t} \\sim \\kappa u_{\\tau} y$ 时所隐含的 $\\epsilon(y)$ 壁面函数。将最终结果表示为仅包含 $u_{\\tau}$、$\\kappa$ 和 $y$ 的单个闭式解析表达式。用国际单位制（SI）单位表示 $\\epsilon$。不需要进行数值评估，也不需要四舍五入。", "solution": "在尝试解答之前，对问题进行验证。\n\n**第一步：提取已知条件**\n- 流动类型：高雷诺数下的不可压缩湍流槽道流。\n- 关注区域：近壁对数区。\n- 控制条件：湍动能的产生与耗散之间的平衡，$P_{k} = \\epsilon$。\n- 变量与常数：$y$ (壁面法向坐标)，$U(y)$ (平均流向速度)，$\\nu$ (运动粘度)，$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$ (摩擦速度)，$\\tau_{w}$ (壁面剪切应力)，$\\rho$ (密度)，$\\kappa$ (von Kármán 常数)。\n- 湍流模型：采用Boussinesq涡粘假设的可实现 $k$-$\\epsilon$ 模型。\n- 湍流粘度形式：$\\nu_{t} = C_{\\mu} k^{2}/\\epsilon$，其中 $k$ 是湍动能，$\\epsilon$ 是其耗散率，$C_{\\mu}$ 是一个系数。\n- 平均应变率张量：$S_{ij} = \\frac{1}{2}(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i})$。\n- 湍动能的产生项：$P_{k} = 2 \\nu_{t} S_{ij} S_{ij}$。\n- 经验定律：壁面律对数定律，$U^{+} = \\frac{1}{\\kappa} \\ln y^{+} + B$。\n- 隐含的剪切标度：$\\mathrm{d}U/\\mathrm{d}y \\sim u_{\\tau}/(\\kappa y)$。\n- 隐含的湍流粘度标度：$\\nu_{t} \\sim \\kappa u_{\\tau} y$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，其坚实基础是Reynolds平均湍流建模的既定原则，特别是 $k$-$\\epsilon$ 框架和壁面束缚湍流边界层的经典理论。问题的前提，包括对数定律、对数层中的平衡假设（$P_k = \\epsilon$）以及产生项和涡粘度的定义，在计算流体动力学领域都是标准且一致的。该问题是适定的，为推导 $\\epsilon$ 的壁面函数提供了所有必要信息。术语精确客观。该问题未违反任何指定的无效标准。\n\n**第三步：结论与行动**\n该问题被判定为**有效**。将提供解答。\n\n目标是推导近壁对数区中湍流耗散率 $\\epsilon(y)$ 的渐近形式。出发点是局部平衡假设，该假设指出，在此区域，湍动能的产生率 $P_k$ 与其耗散率 $\\epsilon$ 相平衡。\n$$P_k = \\epsilon$$\n问题使用Boussinesq假设将产生项指定为 $P_{k} = 2 \\nu_{t} S_{ij} S_{ij}$，其中 $\\nu_t$ 是湍流涡粘度，$S_{ij}$ 是平均应变率张量。因此，我们有：\n$$\\epsilon = 2 \\nu_{t} S_{ij} S_{ij}$$\n该流动是平行剪切流，平均速度向量为 $\\mathbf{U} = (U(y), 0, 0)$。速度分量为 $U_1 = U(y)$、$U_2 = 0$ 和 $U_3 = 0$。平均应变率张量定义为 $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i}\\right)$。唯一非零的速度梯度是 $\\frac{\\partial U_1}{\\partial x_2} = \\frac{\\mathrm{d}U}{\\mathrm{d}y}$。因此，应变率张量唯一非零的分量是：\n$$S_{12} = S_{21} = \\frac{1}{2} \\left( \\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1} \\right) = \\frac{1}{2} \\frac{\\mathrm{d}U}{\\mathrm{d}y}$$\n双重缩并 $S_{ij}S_{ij}$ 涉及对所有张量分量的平方求和：\n$$S_{ij} S_{ij} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} S_{ij} S_{ij} = S_{12}^2 + S_{21}^2 = \\left(\\frac{1}{2}\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2 + \\left(\\frac{1}{2}\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2 = 2 \\left(\\frac{1}{4}\\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2\\right) = \\frac{1}{2}\\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2$$\n将此结果代回 $\\epsilon$ 的表达式中：\n$$\\epsilon = 2 \\nu_{t} \\left(\\frac{1}{2}\\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2\\right) = \\nu_{t} \\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2$$\n现在，我们必须使用为对数层提供的渐近形式。问题指出，平均速度梯度的标度为：\n$$\\frac{\\mathrm{d}U}{\\mathrm{d}y} \\sim \\frac{u_{\\tau}}{\\kappa y}$$\n该标度是对壁面律对数定律求导的直接结果。问题还提供了与对数定律一致的湍流粘度所需标度：\n$$\\nu_{t} \\sim \\kappa u_{\\tau} y$$\n此标度确保了在对数层中，湍流剪切应力 $\\tau_t = \\rho \\nu_t (\\mathrm{d}U/\\mathrm{d}y)$ 保持恒定且等于壁面剪切应力 $\\tau_w = \\rho u_{\\tau}^2$。\n\n将这两个渐近表达式代入 $\\epsilon$ 的方程中：\n$$\\epsilon \\sim (\\kappa u_{\\tau} y) \\left(\\frac{u_{\\tau}}{\\kappa y}\\right)^2$$\n$$\\epsilon \\sim (\\kappa u_{\\tau} y) \\frac{u_{\\tau}^2}{\\kappa^2 y^2}$$\n通过消去项来简化表达式：\n$$\\epsilon \\sim \\frac{\\kappa u_{\\tau}^3 y}{\\kappa^2 y^2} = \\frac{u_{\\tau}^3}{\\kappa y}$$\n这就是在指定条件下，与可实现 $k$-$\\epsilon$ 模型一致的、在对数区中耗散率 $\\epsilon$ 所求的壁面函数。\n\n$\\epsilon$ 的单位是单位质量单位时间的能量。摩擦速度 $u_{\\tau}$ 的单位是速度，$[L T^{-1}]$。壁面法向坐标 $y$ 的单位是长度，$[L]$。von Kármán 常数 $\\kappa$ 是无量纲的。因此，推导出的表达式的单位是：\n$$[\\epsilon] = \\frac{[u_{\\tau}]^3}{[\\kappa][y]} = \\frac{(L T^{-1})^3}{(1)(L)} = \\frac{L^3 T^{-3}}{L} = L^2 T^{-3}$$\n在国际单位制（SI）中，$\\epsilon$ 的单位是米平方每秒立方（$\\text{m}^2/\\text{s}^3$）。", "answer": "$$\\boxed{\\frac{u_{\\tau}^{3}}{\\kappa y}}$$", "id": "3378984"}, {"introduction": "一个鲁棒的湍流模型不仅要能模拟完全发展的湍流，还必须能在湍流消失时平滑地过渡到层流状态。本练习旨在分析可实现 $k$-$\\epsilon$ 模型在趋近层流极限（即湍动能 $k \\to 0$）时的渐近行为。您将探索模型参数需满足何种条件，才能确保湍流粘度 $\\nu_{t}$ 以物理上合理且数值上稳定的方式衰减至零。[@problem_id:3379011]", "problem": "考虑通过 Boussinesq 假设封闭的不可压缩雷诺平均Navier-Stokes (RANS) 模拟，其中使用可实现的湍流动能-耗散率模型 (可实现的 $k$-$\\epsilon$ 模型)。设雷诺切应力建模为 $\\tau_{ij} = 2 \\rho \\nu_{t} S_{ij} - \\frac{2}{3} \\rho k \\delta_{ij}$，其中 $\\nu_{t}$ 是湍流运动粘度，$S_{ij} = \\frac{1}{2} \\left( \\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i} \\right)$ 是平均应变率张量，$k$ 是湍流动能。在可实现的 $k$-$\\epsilon$ 模型中，涡粘度由 $\\nu_{t} = C_{\\mu}(k,\\mathbf{S},\\mathbf{\\Omega}) k^{2}/\\epsilon$ 给出，其中 $C_{\\mu}$ 是一个正的模型系数，它取决于湍流和平均流不变量，并且在固定有限剪切下，当摩擦雷诺数 $Re_{\\tau} \\to 0$ 时，具有一个有限的非零极限 $C_{\\mu,0}$。\n\n假设一个均匀定常剪切流，其应变率大小恒定为 $S = \\sqrt{2 S_{ij} S_{ij}} \\equiv S_{0}  0$，湍流输运可忽略 (即 $k$ 和 $\\epsilon$ 没有扩散或对流)，且密度恒定。在可实现的 $k$-$\\epsilon$ 模型中，耗散率方程的主阶源项可以写成一个与 $S \\epsilon$ 成正比的生成项和一个与 $\\epsilon^{2}/k$ 成正比的耗散项，即分别为 $\\rho C_{1}(\\eta) S \\epsilon$ 和 $-\\rho C_{2} \\epsilon^{2}/k$。其中 $C_{2}  0$ 为常数，$\\eta \\equiv S k/\\epsilon$，并且 $C_{1}(\\eta)$ 是一个有界的正函数，在假设的剪切下，当 $Re_{\\tau} \\to 0$ 时，它趋于一个有限极限 $C_{1,0}$。在层流极限 $Re_{\\tau} \\to 0$下，假设其特殊渐近极限使得 $\\epsilon$ 方程中的生成项和耗散项在 $k \\to 0^{+}$ 时在主阶上达到平衡。\n\n从上述假设和模拟输运方程的基本平衡结构出发，对 $Re_{\\tau} \\to 0$ 的情况进行渐近分析，并：\n\n- 推导由平衡的耗散率方程所蕴含的 $\\epsilon$ 和 $k$ 之间的主阶渐近标度关系。\n- 利用此关系和涡粘封闭，推导当 $k \\to 0^{+}$ 时，用 $k$, $S_{0}$, $C_{\\mu,0}$, $C_{1,0}$ 和 $C_{2}$ 表示的 $\\nu_{t}$ 的主阶渐近表达式。\n- 陈述为确保当 $k \\to 0^{+}$ 时 $\\nu_{t} \\to 0$ 能平滑过渡且无数值刚性，对 $C_{\\mu,0}$, $C_{1,0}$, $C_{2}$ 和 $S_{0}$ 施加的最小限制条件，其中“无刚性”指模拟的耗散项 $\\epsilon^{2}/k$ 在 $k \\to 0^{+}$ 时保持为 $O(k)$ 或更小。\n\n给出用 $k$, $S_{0}$, $C_{\\mu,0}$, $C_{1,0}$ 和 $C_{2}$ 表示的 $\\nu_{t}$ 的主阶渐近表达式作为最终结果。在概念上对 $\\nu_{t}$ 使用国际单位制单位 (即 $\\mathrm{m^{2}/s}$)，但不要在最终的方框表达式中包含单位。无需进行数值取整；请提供一个精确的符号表达式。", "solution": "该问题要求在湍流动能趋于零 ($k \\to 0^{+}$) 的极限下，对可实现的 $k$-$\\epsilon$ 湍流模型进行渐近分析，这对应于摩擦雷诺数 $Re_{\\tau} \\to 0$ 的层流极限。该分析基于耗散率 $\\epsilon$ 的模拟输运方程中生成项和耗散项源项之间的预设平衡。\n\n第一步是推导 $\\epsilon$ 和 $k$ 之间的主阶渐近标度关系。问题陈述，对于湍流输运可忽略的均匀定常剪切流，$\\epsilon$ 方程中的生成项和耗散项在 $k \\to 0^{+}$ 时在主阶上达到平衡。生成项为 $\\rho C_{1}(\\eta) S \\epsilon$，耗散项为 $-\\rho C_{2} \\epsilon^{2}/k$。平衡意味着：\n$$\n\\rho C_{1}(\\eta) S \\epsilon = \\rho C_{2} \\frac{\\epsilon^{2}}{k}\n$$\n恒定密度 $\\rho$ 从两侧消去。对于一个有物理意义的湍流状态，无论多小，$k$ 和 $\\epsilon$ 都为正，因此我们可以除以 $\\epsilon$：\n$$\nC_{1}(\\eta) S = C_{2} \\frac{\\epsilon}{k}\n$$\n该方程给出了比率 $\\epsilon/k$ 的关系。我们关心的是 $k \\to 0^{+}$ 时的渐近极限。问题指明，在此极限下，平均应变率大小 $S$ 是一个常数 $S_{0}  0$，系数 $C_{1}(\\eta)$ 趋于一个有限极限 $C_{1,0}$。系数 $C_2$ 是一个正常数。将这些极限值代入平衡方程得到：\n$$\nC_{1,0} S_{0} \\approx C_{2} \\frac{\\epsilon}{k} \\quad \\text{for } k \\to 0^{+}\n$$\n解出 $\\epsilon$ 得到主阶渐近标度关系：\n$$\n\\epsilon \\sim \\frac{C_{1,0} S_{0}}{C_{2}} k\n$$\n这个结果表明，在这个渐近区域中，耗散率 $\\epsilon$ 随着湍流动能 $k$ 线性趋于零。这完成了问题的第一部分。\n\n第二步是利用此标度关系来找到湍流涡粘度 $\\nu_{t}$ 的渐近表达式。在可实现的 $k$-$\\epsilon$ 模型中，$\\nu_{t}$ 的定义为：\n$$\n\\nu_{t} = C_{\\mu}(k,\\mathbf{S},\\mathbf{\\Omega}) \\frac{k^{2}}{\\epsilon}\n$$\n问题陈述，在极限 $Re_{\\tau} \\to 0$ 下，系数 $C_{\\mu}$ 趋于一个有限的非零极限 $C_{\\mu,0}$。因此，当 $k \\to 0^{+}$ 时：\n$$\n\\nu_{t} \\sim C_{\\mu,0} \\frac{k^{2}}{\\epsilon}\n$$\n现在我们代入第一步中推导出的 $\\epsilon$ 的渐近关系：\n$$\n\\nu_{t} \\sim C_{\\mu,0} \\frac{k^{2}}{\\left( \\frac{C_{1,0} S_{0}}{C_{2}} k \\right)}\n$$\n通过消去一个 $k$ 的幂次并重新排列常数来简化表达式，得到 $\\nu_{t}$ 的主阶渐近表达式：\n$$\n\\nu_{t} \\sim \\left( \\frac{C_{\\mu,0} C_{2}}{C_{1,0} S_{0}} \\right) k\n$$\n这就是在 $k \\to 0^{+}$ 时 $\\nu_{t}$ 所需的表达式。\n\n问题的第三部分要求给出确保当 $k \\to 0^{+}$ 时 $\\nu_{t} \\to 0$ 能平滑过渡且无数值刚性的最小限制条件。\n从推导出的表达式来看，$\\nu_{t}$ 与 $k$ 成正比。这意味着当 $k \\to 0^{+}$ 时，$\\nu_{t}$ 也线性趋于 0。这种线性依赖关系构成了一种到零的“平滑”过渡，因为在此极限下，导数 $d\\nu_{t}/dk$ 是良定义且为常数。为使比例系数是一个良定义的、有限的正的常数，以下条件必须成立：\n1. $C_{\\mu,0}  0$ (给定为一个正函数的有限非零极限)。\n2. $C_{2}  0$ (给定)。\n3. $S_{0}  0$ (给定)。\n4. $C_{1,0}  0$。问题陈述 $C_1(\\eta)$ 是一个具有有限极限 $C_{1,0}$ 的正函数，因此 $C_{1,0} \\ge 0$。如果 $C_{1,0}$ 为 $0$，则 $\\nu_t$ 的表达式将是奇异的，这不符合物理。因此，最小条件是 $C_{1,0}  0$。\n\n“无刚性”的条件在问题中定义为 $\\epsilon$ 方程中的耗散项（可写为与 $\\epsilon^{2}/k$ 成正比）在 $k \\to 0^{+}$ 时保持为 $O(k)$ 或更小的量级。让我们用我们推导出的 $\\epsilon$ 的标度关系来检查这个条件：\n$$\n\\frac{\\epsilon^{2}}{k} \\sim \\frac{\\left( \\frac{C_{1,0} S_{0}}{C_{2}} k \\right)^{2}}{k} = \\frac{\\left( \\frac{C_{1,0} S_{0}}{C_{2}} \\right)^{2} k^{2}}{k} = \\left( \\frac{C_{1,0} S_{0}}{C_{2}} \\right)^{2} k\n$$\n耗散项是 $O(k)$ 量级的。这满足了“无刚性”准则，防止了那些在此极限下可能表现为 $k^{-1}$ 的项所带来的数值问题。因此，推导出的渐近行为与层流极限附近良态湍流模型的要求是一致的。\n\n最终答案是涡粘度 $\\nu_{t}$ 的主阶渐近表达式。", "answer": "$$\n\\boxed{\\frac{C_{\\mu,0} C_{2}}{C_{1,0} S_{0}} k}\n$$", "id": "3379011"}, {"introduction": "现代湍流建模正在越来越多地与数据科学相结合，以提升雷诺平均模拟（RANS）的预测精度。本练习将引导您进入这一前沿领域，通过一个计算任务来校准可实现 $k$-$\\epsilon$ 模型中的关键系数 $C_{\\mu}$。您将利用直接数值模拟（DNS）的代理数据，通过正则化最小二乘法来拟合 $C_{\\mu}$ 的函数形式，从而体验如何利用高保真数据来改进和验证湍流模型。[@problem_id:3378981]", "problem": "您的任务是在计算流体动力学（CFD）领域中，为可实现的 $k$-$\\varepsilon$ 模型构建和验证一个数据驱动的函数封闭。从雷诺平均Navier-Stokes（RANS）方程和 Boussinesq 涡粘性假设出发。目标是利用针对均匀剪切湍流的合成直接数值模拟（DNS）代理数据，标定系数 $C_\\mu$ 的一个函数形式，然后在存在二次运动的弯曲管道流上验证该模型。本问题中的所有量均为无量纲量，输出中无需物理单位。\n\n使用以下基本基础：\n- 使用 Boussinesq 近似处理雷诺应力张量的雷诺平均动量方程。涡粘性模拟为 $\\nu_t = C_\\mu k^2 / \\varepsilon$, 其中 $k$ 是湍动能，$\\varepsilon$ 是耗散率。\n- 可实现的 $k$-$\\varepsilon$ 模型的理念要求 $C_\\mu$ 是一个由局部、标架无关量构成的函数，这些量源自平均应变率张量 $S_{ij}$ 和平均旋转率张量 $\\Omega_{ij}$，以及一个各向异性度量。定义 \n$$\nS \\equiv \\sqrt{2 S_{ij} S_{ij}},\\qquad \\Omega \\equiv \\sqrt{2 \\Omega_{ij}\\Omega_{ij}},\n$$\n以及无量纲化的不变量\n$$\n\\hat S \\equiv \\frac{k}{\\varepsilon} S,\\qquad \\hat \\Omega \\equiv \\frac{k}{\\varepsilon}\\Omega,\n$$\n以及一个无量纲的各向异性度量 $A_s$，它作为归一化各向异性张量不变量的代理。您无需从张量计算 $S$、$\\Omega$ 或 $A_s$；而是在采样点直接给出它们的值。\n\n您必须通过最小化一个正则化的最小二乘目标函数，将 $C_\\mu(\\hat S,\\hat\\Omega,A_s)$ 的参数化函数形式与 DNS 代理目标值进行拟合。待标定的函数形式为\n$$\nC_\\mu^{\\text{model}}(\\hat S,\\hat\\Omega,A_s;\\boldsymbol{\\theta}) \\equiv \\operatorname{clip}\\!\\left(\\theta_0 \\;+\\; \\theta_1\\,\\frac{\\hat S}{\\hat\\Omega+\\varepsilon_s} \\;+\\; \\theta_2\\,A_s \\;+\\; \\theta_3\\,\\frac{\\hat S^2}{\\hat\\Omega^2+\\varepsilon_s} \\;,\\; C_{\\min},\\; C_{\\max}\\right),\n$$\n其中 $\\boldsymbol{\\theta} = [\\theta_0,\\theta_1,\\theta_2,\\theta_3]^T$ 是待标定的未知系数，$\\varepsilon_s = 10^{-6}$ 是一个固定的平滑常数，以避免除以零，并且裁剪算子 $\\operatorname{clip}(x,C_{\\min},C_{\\max})$ 强制施加了与可实现性一致的界限 $C_{\\min} \\le x \\le C_{\\max}$. 使用 $C_{\\min} = 0.05$ 和 $C_{\\max} = 0.20$. 通过最小化\n$$\nJ(\\boldsymbol{\\theta}) \\;=\\; \\sum_{n=1}^{N_{\\text{train}}} \\left[C_{\\mu,n}^{\\text{model}}(\\hat S_n,\\hat\\Omega_n,A_{s,n};\\boldsymbol{\\theta}) - C_{\\mu,n}^{\\text{DNS}}\\right]^2 \\;+\\; \\lambda \\,\\lVert \\boldsymbol{\\theta}\\rVert_2^2,\n$$\n来拟合 $\\boldsymbol{\\theta}$，其中使用了一个给定的 Tikhonov 正则化参数 $\\lambda  0$.\n\n为您提供了三个独立的标定-验证场景（测试用例）。在每个场景中，您将获得一个由元组 $(\\hat S, \\hat\\Omega, A_s, C_\\mu^{\\text{DNS}})$ 组成的训练数据集，代表均匀剪切湍流工况；以及一个独立的验证数据集，代表带有二次运动的弯曲管道流，同样以元组 $(\\hat S, \\hat\\Omega, A_s, C_\\mu^{\\text{DNS}})$ 的形式给出。对于每个场景，您必须：\n- 仅使用训练数据集和给定的 $\\lambda$ 来拟合 $\\boldsymbol{\\theta}$。\n- 计算训练数据集上的均方误差（MSE）：\n$$\n\\text{MSE}_{\\text{train}} \\equiv \\frac{1}{N_{\\text{train}}}\\sum_{n=1}^{N_{\\text{train}}}\\left[C_{\\mu,n}^{\\text{model}} - C_{\\mu,n}^{\\text{DNS}}\\right]^2.\n$$\n- 计算验证数据集上的均方误差（MSE）：\n$$\n\\text{MSE}_{\\text{valid}} \\equiv \\frac{1}{N_{\\text{valid}}}\\sum_{m=1}^{N_{\\text{valid}}}\\left[C_{\\mu,m}^{\\text{model}} - C_{\\mu,m}^{\\text{DNS}}\\right]^2.\n$$\n\n使用以下数据集和参数。每个元组的顺序为 $(\\hat S, \\hat\\Omega, A_s, C_\\mu^{\\text{DNS}})$。\n\n测试用例 1：\n- 正则化参数: $\\lambda = 10^{-6}$.\n- 训练（均匀剪切湍流）数据, $N_{\\text{train}}=8$:\n  - $(0.5,\\,0.2,\\,0.05,\\,0.085)$,\n  - $(1.0,\\,0.3,\\,0.08,\\,0.090)$,\n  - $(2.0,\\,0.5,\\,0.10,\\,0.095)$,\n  - $(3.0,\\,0.5,\\,0.12,\\,0.100)$,\n  - $(4.0,\\,1.0,\\,0.15,\\,0.092)$,\n  - $(5.0,\\,1.5,\\,0.18,\\,0.088)$,\n  - $(6.0,\\,2.0,\\,0.20,\\,0.085)$,\n  - $(8.0,\\,3.0,\\,0.25,\\,0.080)$.\n- 验证（弯曲管道）数据, $N_{\\text{valid}}=10$:\n  - $(1.5,\\,0.8,\\,0.20,\\,0.089)$,\n  - $(2.5,\\,1.2,\\,0.22,\\,0.086)$,\n  - $(3.5,\\,1.8,\\,0.24,\\,0.083)$,\n  - $(4.5,\\,2.2,\\,0.26,\\,0.081)$,\n  - $(5.5,\\,2.6,\\,0.28,\\,0.079)$,\n  - $(2.0,\\,0.7,\\,0.18,\\,0.090)$,\n  - $(3.0,\\,1.0,\\,0.20,\\,0.087)$,\n  - $(4.0,\\,1.5,\\,0.22,\\,0.084)$,\n  - $(6.0,\\,3.0,\\,0.30,\\,0.078)$,\n  - $(7.0,\\,3.5,\\,0.32,\\,0.076)$.\n\n测试用例 2：\n- 正则化参数: $\\lambda = 10^{-4}$.\n- 训练（均匀剪切湍流）数据, $N_{\\text{train}}=8$:\n  - $(0.2,\\,0.05,\\,0.02,\\,0.082)$,\n  - $(0.8,\\,0.10,\\,0.05,\\,0.088)$,\n  - $(1.5,\\,0.20,\\,0.08,\\,0.093)$,\n  - $(3.0,\\,0.40,\\,0.10,\\,0.098)$,\n  - $(6.0,\\,1.20,\\,0.15,\\,0.091)$,\n  - $(9.0,\\,2.00,\\,0.20,\\,0.086)$,\n  - $(12.0,\\,3.00,\\,0.25,\\,0.082)$,\n  - $(15.0,\\,4.00,\\,0.30,\\,0.079)$.\n- 验证（弯曲管道）数据, $N_{\\text{valid}}=8$:\n  - $(2.0,\\,1.5,\\,0.25,\\,0.085)$,\n  - $(3.0,\\,2.0,\\,0.28,\\,0.082)$,\n  - $(4.0,\\,2.5,\\,0.30,\\,0.080)$,\n  - $(5.0,\\,3.0,\\,0.32,\\,0.078)$,\n  - $(6.0,\\,3.5,\\,0.34,\\,0.076)$,\n  - $(7.0,\\,4.0,\\,0.36,\\,0.074)$,\n  - $(8.0,\\,4.5,\\,0.38,\\,0.073)$,\n  - $(9.0,\\,5.0,\\,0.40,\\,0.072)$.\n\n测试用例 3：\n- 正则化参数: $\\lambda = 10^{-2}$.\n- 训练（旋转主导的均匀剪切）数据, $N_{\\text{train}}=8$:\n  - $(0.1,\\,0.5,\\,0.01,\\,0.070)$,\n  - $(0.2,\\,0.8,\\,0.02,\\,0.068)$,\n  - $(0.5,\\,1.2,\\,0.03,\\,0.067)$,\n  - $(1.0,\\,2.0,\\,0.05,\\,0.066)$,\n  - $(1.5,\\,3.0,\\,0.06,\\,0.065)$,\n  - $(2.0,\\,4.0,\\,0.08,\\,0.064)$,\n  - $(3.0,\\,6.0,\\,0.10,\\,0.063)$,\n  - $(4.0,\\,8.0,\\,0.12,\\,0.062)$.\n- 验证（弯曲管道，弱二次流）数据, $N_{\\text{valid}}=6$:\n  - $(0.5,\\,1.0,\\,0.05,\\,0.069)$,\n  - $(1.0,\\,1.5,\\,0.06,\\,0.068)$,\n  - $(1.5,\\,2.2,\\,0.07,\\,0.067)$,\n  - $(2.0,\\,3.0,\\,0.08,\\,0.066)$,\n  - $(2.5,\\,3.8,\\,0.09,\\,0.065)$,\n  - $(3.0,\\,4.5,\\,0.10,\\,0.064)$.\n\n您的程序必须实现以下内容：\n- 构造特征向量 $\\boldsymbol{\\phi}(\\hat S,\\hat\\Omega,A_s) = \\left[1,\\; \\frac{\\hat S}{\\hat\\Omega+\\varepsilon_s},\\; A_s,\\; \\frac{\\hat S^2}{\\hat\\Omega^2+\\varepsilon_s}\\right]^T$，使用 $\\varepsilon_s=10^{-6}$.\n- 使用闭式解表达式\n$$\n\\boldsymbol{\\theta}^* \\;=\\; \\left(\\Phi^T\\Phi + \\lambda I\\right)^{-1}\\Phi^T \\mathbf{y}\n$$\n求解 $\\boldsymbol{\\theta}$ 的岭回归正则化最小二乘问题，其中 $\\Phi$ 是设计矩阵，其行是 $\\boldsymbol{\\phi}(\\hat S_n,\\hat\\Omega_n,A_{s,n})^T$，$\\mathbf{y}$ 是目标值 $C_{\\mu,n}^{\\text{DNS}}$ 的向量。\n- 在训练集和验证集上评估 $C_\\mu^{\\text{model}}$ 时，使用 $C_{\\min}=0.05$ 和 $C_{\\max}=0.20$.\n- 为每个测试用例计算 $\\text{MSE}_{\\text{train}}$ 和 $\\text{MSE}_{\\text{valid}}$.\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。列表必须按 $[\\text{MSE}_{\\text{train}}^{(1)},\\text{MSE}_{\\text{valid}}^{(1)},\\text{MSE}_{\\text{train}}^{(2)},\\text{MSE}_{\\text{valid}}^{(2)},\\text{MSE}_{\\text{train}}^{(3)},\\text{MSE}_{\\text{valid}}^{(3)}]$ 的顺序排列，每个值四舍五入到 $6$ 位小数。不应打印任何其他文本。", "solution": "该问题要求在可实现的 $k$-$\\varepsilon$ 湍流模型的框架内，对系数 $C_\\mu$ 的函数封闭进行标定和验证。该过程涉及将模型与来自均匀剪切湍流的合成数据进行拟合，然后用来自弯曲管道流的数据对其进行验证。这是湍流模型开发中的一种常见做法，其中，数据驱动技术被用来增强雷诺平均Navier-Stokes（RANS）模型的预测能力。\n\n本问题的基础是 Boussinesq 假设，该假设将雷诺应力张量 $-\\rho \\overline{u'_i u'_j}$ 建模为与平均应变率张量 $S_{ij}$ 成线性比例。在其不可压缩形式中，这被写作：\n$$\n-\\overline{u'_i u'_j} = 2 \\nu_t S_{ij} - \\frac{2}{3} k \\delta_{ij}\n$$\n其中 $\\nu_t$ 是涡粘性，而 $k$ 是湍动能。在 $k$-$\\varepsilon$ 系列模型中，涡粘性通过表达式：\n$$\n\\nu_t = C_\\mu \\frac{k^2}{\\varepsilon}\n$$\n与湍动能 $k$ 及其耗散率 $\\varepsilon$ 相关联。\n\n系数 $C_\\mu$ 在确定模型预测的湍流混合水平方面起着关键作用。虽然标准 $k$-$\\varepsilon$ 模型使用常数 $C_\\mu = 0.09$，但众所周知，这种方法在涉及强烈的流线曲率、旋转或分离的复杂流动中存在缺陷。可实现的 $k$-$\\varepsilon$ 模型通过使 $C_\\mu$ 成为平均流场的函数来解决这个问题。这确保了模型满足对雷诺应力的某些数学约束（例如，关于湍流剪切应力的 Schwarz 不等式和正应力的正定性），因此得名“可实现的”。\n\n$C_\\mu$ 的函数依赖关系是使用源自平均速度梯度的局部、标架无关的量来构建的。这些量是无量纲化的平均应变率大小 $\\hat S = \\frac{k}{\\varepsilon} S$ 和平均旋转率大小 $\\hat \\Omega = \\frac{k}{\\varepsilon} \\Omega$。该问题还包括一个无量纲的各向异性度量 $A_s$。\n\n提出的具体函数形式是源自这些不变量的特征的线性组合，然后对其进行裁剪以确保其值保持在物理上合理的范围内。参数模型为：\n$$\nC_\\mu^{\\text{model}}(\\hat S,\\hat\\Omega,A_s;\\boldsymbol{\\theta}) = \\operatorname{clip}\\!\\left(\\boldsymbol{\\phi}^T \\boldsymbol{\\theta}, C_{\\min}, C_{\\max}\\right)\n$$\n其中 $\\boldsymbol{\\theta} = [\\theta_0, \\theta_1, \\theta_2, \\theta_3]^T$ 是待标定的系数向量，而 $\\boldsymbol{\\phi}$ 是特征向量：\n$$\n\\boldsymbol{\\phi}(\\hat S,\\hat\\Omega,A_s) = \\left[1,\\; \\frac{\\hat S}{\\hat\\Omega+\\varepsilon_s},\\; A_s,\\; \\frac{\\hat S^2}{\\hat\\Omega^2+\\varepsilon_s}\\right]^T\n$$\n常数 $\\varepsilon_s = 10^{-6}$ 是一个小的正则化项，用以防止在 $\\hat \\Omega$ 可能为零的纯应变区域中出现除以零的情况。裁剪函数 $\\operatorname{clip}(x, x_{\\min}, x_{\\max})$ 强制执行界限 $C_{\\min} = 0.05$ 和 $C_{\\max} = 0.20$。\n\n任务是通过将模型与合成的直接数值模拟（DNS）目标值 $C_{\\mu,n}^{\\text{DNS}}$ 进行拟合，来确定最优参数 $\\boldsymbol{\\theta}^*$。拟合是通过最小化一个 Tikhonov 正则化的最小二乘目标函数来执行的。尽管问题陈述中给出的目标函数 $J(\\boldsymbol{\\theta})$ 包含了非线性的 `clip` 函数，但所提供的 $\\boldsymbol{\\theta}^*$ 的闭式解对应于一个纯二次目标函数的最小化，这在拟合过程中忽略了裁剪操作。这是一个标准且实用的简化方法。我们求解线性岭回归问题：\n$$\n\\min_{\\boldsymbol{\\theta}} \\left\\| \\Phi \\boldsymbol{\\theta} - \\mathbf{y} \\right\\|_2^2 + \\lambda \\left\\| \\boldsymbol{\\theta} \\right\\|_2^2\n$$\n这里，$\\Phi$ 是 $N_{\\text{train}} \\times 4$ 的设计矩阵，其中每一行是第 $n$ 个训练数据点的特征向量 $\\boldsymbol{\\phi}_n^T$。$\\mathbf{y}$ 是目标值 $C_{\\mu,n}^{\\text{DNS}}$ 的 $N_{\\text{train}}$ 维向量，而 $\\lambda$ 是正则化参数。\n\n这个标准问题的解由岭回归的法方程给出：\n$$\n\\boldsymbol{\\theta}^* = (\\Phi^T\\Phi + \\lambda I)^{-1}\\Phi^T \\mathbf{y}\n$$\n其中 $I$ 是 $4 \\times 4$ 的单位矩阵。\n\n每个测试用例的总体算法如下：\n1.  对于给定的训练数据集 $(\\hat S_n, \\hat\\Omega_n, A_{s,n}, C_{\\mu,n}^{\\text{DNS}})$，为 $N_{\\text{train}}$ 个点中的每一个构造特征向量 $\\boldsymbol{\\phi}_n$。\n2.  通过堆叠行向量 $\\boldsymbol{\\phi}_n^T$ 来组装设计矩阵 $\\Phi$。\n3.  从 $C_{\\mu,n}^{\\text{DNS}}$ 值组装目标向量 $\\mathbf{y}$。\n4.  使用测试用例指定的正则化参数 $\\lambda$，利用闭式解计算最优系数向量 $\\boldsymbol{\\theta}^*$。\n5.  对于训练和验证数据集中的每个点 $(\\hat S_i, \\hat\\Omega_i, A_{s,i})$，计算模型的预测值。这包括两个步骤：\n    a. 计算线性估计值：$z_i = \\boldsymbol{\\phi}_i^T \\boldsymbol{\\theta}^*$。\n    b. 应用裁剪操作：$C_{\\mu,i}^{\\text{model}} = \\operatorname{clip}(z_i, C_{\\min}, C_{\\max})$。\n6.  使用预测值 $C_{\\mu,n}^{\\text{model}}$ 和目标值 $C_{\\mu,n}^{\\text{DNS}}$ 计算训练集上的均方误差（MSE）：\n    $$\n    \\text{MSE}_{\\text{train}} = \\frac{1}{N_{\\text{train}}}\\sum_{n=1}^{N_{\\text{train}}}\\left[C_{\\mu,n}^{\\text{model}} - C_{\\mu,n}^{\\text{DNS}}\\right]^2\n    $$\n7.  同样地，计算验证集上的 MSE：\n    $$\n    \\text{MSE}_{\\text{valid}} = \\frac{1}{N_{\\text{valid}}}\\sum_{m=1}^{N_{\\text{valid}}}\\left[C_{\\mu,m}^{\\text{model}} - C_{\\mu,m}^{\\text{DNS}}\\right]^2\n    $$\n对所有三个测试用例重复此过程，并报告所得的六个 MSE 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the data-driven functional closure problem for three test cases.\n    \"\"\"\n    \n    # Define constants\n    epsilon_s = 1e-6\n    C_min = 0.05\n    C_max = 0.20\n\n    # Define the three test cases\n    test_cases = [\n        {\n            \"lambda\": 1e-6,\n            \"train_data\": [\n                (0.5, 0.2, 0.05, 0.085), (1.0, 0.3, 0.08, 0.090),\n                (2.0, 0.5, 0.10, 0.095), (3.0, 0.5, 0.12, 0.100),\n                (4.0, 1.0, 0.15, 0.092), (5.0, 1.5, 0.18, 0.088),\n                (6.0, 2.0, 0.20, 0.085), (8.0, 3.0, 0.25, 0.080),\n            ],\n            \"valid_data\": [\n                (1.5, 0.8, 0.20, 0.089), (2.5, 1.2, 0.22, 0.086),\n                (3.5, 1.8, 0.24, 0.083), (4.5, 2.2, 0.26, 0.081),\n                (5.5, 2.6, 0.28, 0.079), (2.0, 0.7, 0.18, 0.090),\n                (3.0, 1.0, 0.20, 0.087), (4.0, 1.5, 0.22, 0.084),\n                (6.0, 3.0, 0.30, 0.078), (7.0, 3.5, 0.32, 0.076),\n            ]\n        },\n        {\n            \"lambda\": 1e-4,\n            \"train_data\": [\n                (0.2, 0.05, 0.02, 0.082), (0.8, 0.10, 0.05, 0.088),\n                (1.5, 0.20, 0.08, 0.093), (3.0, 0.40, 0.10, 0.098),\n                (6.0, 1.20, 0.15, 0.091), (9.0, 2.00, 0.20, 0.086),\n                (12.0, 3.00, 0.25, 0.082), (15.0, 4.00, 0.30, 0.079),\n            ],\n            \"valid_data\": [\n                (2.0, 1.5, 0.25, 0.085), (3.0, 2.0, 0.28, 0.082),\n                (4.0, 2.5, 0.30, 0.080), (5.0, 3.0, 0.32, 0.078),\n                (6.0, 3.5, 0.34, 0.076), (7.0, 4.0, 0.36, 0.074),\n                (8.0, 4.5, 0.38, 0.073), (9.0, 5.0, 0.40, 0.072),\n            ]\n        },\n        {\n            \"lambda\": 1e-2,\n            \"train_data\": [\n                (0.1, 0.5, 0.01, 0.070), (0.2, 0.8, 0.02, 0.068),\n                (0.5, 1.2, 0.03, 0.067), (1.0, 2.0, 0.05, 0.066),\n                (1.5, 3.0, 0.06, 0.065), (2.0, 4.0, 0.08, 0.064),\n                (3.0, 6.0, 0.10, 0.063), (4.0, 8.0, 0.12, 0.062),\n            ],\n            \"valid_data\": [\n                (0.5, 1.0, 0.05, 0.069), (1.0, 1.5, 0.06, 0.068),\n                (1.5, 2.2, 0.07, 0.067), (2.0, 3.0, 0.08, 0.066),\n                (2.5, 3.8, 0.09, 0.065), (3.0, 4.5, 0.10, 0.064),\n            ]\n        }\n    ]\n    \n    results = []\n\n    def build_features(data, eps_s):\n        \"\"\"Constructs feature vectors for a given dataset.\"\"\"\n        phi_list = []\n        y_list = []\n        for S_hat, Omega_hat, A_s, Cmu_dns in data:\n            feature_vector = [\n                1.0,\n                S_hat / (Omega_hat + eps_s),\n                A_s,\n                S_hat**2 / (Omega_hat**2 + eps_s)\n            ]\n            phi_list.append(feature_vector)\n            y_list.append(Cmu_dns)\n        return np.array(phi_list), np.array(y_list)\n\n    def predict(Phi, theta, c_min, c_max):\n        \"\"\"Calculates model predictions including the clipping step.\"\"\"\n        z = Phi @ theta\n        return np.clip(z, c_min, c_max)\n\n    for case in test_cases:\n        # Step 1: Extract data and parameters for the current case\n        lambda_reg = case[\"lambda\"]\n        train_data = case[\"train_data\"]\n        valid_data = case[\"valid_data\"]\n        \n        # Step 2: Construct design matrix and target vector from training data\n        Phi_train, y_train = build_features(train_data, epsilon_s)\n        \n        # Step 3: Solve for the optimal parameters theta using ridge regression\n        # theta = (Phi.T @ Phi + lambda*I)^-1 @ Phi.T @ y\n        num_features = Phi_train.shape[1]\n        I = np.identity(num_features)\n        \n        A = Phi_train.T @ Phi_train + lambda_reg * I\n        b = Phi_train.T @ y_train\n        \n        theta_star = np.linalg.inv(A) @ b\n        \n        # Step 4: Calculate predictions and MSE for the training set\n        Cmu_model_train = predict(Phi_train, theta_star, C_min, C_max)\n        mse_train = np.mean((Cmu_model_train - y_train)**2)\n        results.append(mse_train)\n        \n        # Step 5: Calculate predictions and MSE for the validation set\n        Phi_valid, y_valid = build_features(valid_data, epsilon_s)\n        Cmu_model_valid = predict(Phi_valid, theta_star, C_min, C_max)\n        mse_valid = np.mean((Cmu_model_valid - y_valid)**2)\n        results.append(mse_valid)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3378981"}]}