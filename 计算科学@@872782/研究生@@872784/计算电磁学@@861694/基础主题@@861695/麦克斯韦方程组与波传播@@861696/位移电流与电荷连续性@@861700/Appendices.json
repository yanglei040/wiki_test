{"hands_on_practices": [{"introduction": "在频域计算电磁学中，电荷守恒定律并非一个独立的假设，而是通过位移电流项内蕴于麦克斯韦方程组之中的。本练习将通过严格的数学推导，揭示在时谐场下，安培环路定律和高斯定律如何自然地导出电荷连续性方程的相量形式 [@problem_id:3301409]。完成此推导是理解和构建自洽的频域数值模型的关键一步。", "problem": "一个单连通、均匀、各向同性的区域占据有限体积，其电导率为 $\\sigma$，介电常数为 $\\epsilon$，二者均为常数。区域内没有磁源。在时域中，一个外加电流密度被指定为 $\\mathbf{J}_{s}(\\mathbf{r},t)=\\Re\\{\\mathbf{J}_{s0}(\\mathbf{r})\\exp(j\\omega t)\\}$，其中角频率 $\\omega>0$，$j=\\sqrt{-1}$。所有场都具有相同的 $\\exp(j\\omega t)$ 时谐依赖关系，相量场由其复振幅表示（例如 $\\mathbf{E}(\\mathbf{r})$ 和 $\\mathbf{J}_{s0}(\\mathbf{r})$）。\n\n在频域计算电磁学的公式中，电荷守恒定律必须与位移电流协调一致。仅从包含位移电流的宏观麦克斯韦-安培定律和高斯定律出发，结合本构关系和标准矢量微积分恒等式，推导复相量自由电荷密度 $\\rho(\\mathbf{r})$ 的显式表达式，该表达式应以 $\\nabla\\cdot\\mathbf{E}(\\mathbf{r})$ 和 $\\nabla\\cdot\\mathbf{J}_{s0}(\\mathbf{r})$ 来表示。假设 $\\sigma$ 在空间上是均匀的，并使用传导电流关系式 $\\mathbf{J}_{c}=\\sigma \\mathbf{E}$。不要假设 $\\nabla\\cdot\\mathbf{E}(\\mathbf{r})=0$。\n\n请提供 $\\rho(\\mathbf{r})$ 的最终结果，形式为一个以 $\\nabla\\cdot\\mathbf{E}(\\mathbf{r})$、$\\nabla\\cdot\\mathbf{J}_{s0}(\\mathbf{r})$、$\\sigma$、$j$ 和 $\\omega$ 表示的单一闭合形式解析表达式。", "solution": "该问题要求从频域中的基本电磁定律出发，推导复相量自由电荷密度 $\\rho(\\mathbf{r})$ 的表达式。推导过程必须利用麦克斯韦-安培定律、高斯定律以及给定的本构关系。所有场都是时谐的，由其复相量振幅表示，并假设时间依赖关系为 $\\exp(j\\omega t)$。\n\n要求的出发点（以相量形式表示）如下：\n1.  麦克斯韦-安培定律：\n    $$\n    \\nabla \\times \\mathbf{H}(\\mathbf{r}) = \\mathbf{J}_{total}(\\mathbf{r}) + j\\omega \\mathbf{D}(\\mathbf{r})\n    $$\n2.  电场的高斯定律：\n    $$\n    \\nabla \\cdot \\mathbf{D}(\\mathbf{r}) = \\rho(\\mathbf{r})\n    $$\n总电流密度 $\\mathbf{J}_{total}(\\mathbf{r})$ 是传导电流密度 $\\mathbf{J}_{c}(\\mathbf{r})$ 与外加（源）电流密度 $\\mathbf{J}_{s0}(\\mathbf{r})$之和。\n$$\n\\mathbf{J}_{total}(\\mathbf{r}) = \\mathbf{J}_{c}(\\mathbf{r}) + \\mathbf{J}_{s0}(\\mathbf{r})\n$$\n问题指定了本构关系：\n-   $\\mathbf{D}(\\mathbf{r}) = \\epsilon \\mathbf{E}(\\mathbf{r})$，其中介电常数 $\\epsilon$ 是一个均匀常数。\n-   $\\mathbf{J}_{c}(\\mathbf{r}) = \\sigma \\mathbf{E}(\\mathbf{r})$，其中电导率 $\\sigma$ 是一个均匀常数。\n\n推导过程首先证明电荷守恒定律内在地包含在麦克斯韦方程组中。我们首先对麦克斯韦-安培定律的两边取散度：\n$$\n\\nabla \\cdot (\\nabla \\times \\mathbf{H}(\\mathbf{r})) = \\nabla \\cdot (\\mathbf{J}_{total}(\\mathbf{r}) + j\\omega \\mathbf{D}(\\mathbf{r}))\n$$\n根据一个标准的矢量微积分恒等式，任意矢量场旋度的散度恒等于零。因此，$\\nabla \\cdot (\\nabla \\times \\mathbf{H}(\\mathbf{r})) = 0$。这得到：\n$$\n0 = \\nabla \\cdot \\mathbf{J}_{total}(\\mathbf{r}) + \\nabla \\cdot (j\\omega \\mathbf{D}(\\mathbf{r}))\n$$\n由于 $j$ 和 $\\omega$ 是常数，我们可以写成：\n$$\n0 = \\nabla \\cdot \\mathbf{J}_{total}(\\mathbf{r}) + j\\omega (\\nabla \\cdot \\mathbf{D}(\\mathbf{r}))\n$$\n现在，我们将高斯定律 $\\nabla \\cdot \\mathbf{D}(\\mathbf{r}) = \\rho(\\mathbf{r})$ 代入此方程：\n$$\n0 = \\nabla \\cdot \\mathbf{J}_{total}(\\mathbf{r}) + j\\omega \\rho(\\mathbf{r})\n$$\n这个得到的方程就是电荷连续性方程的相量形式。这一步明确地展示了，通过在麦克斯韦-安培定律中包含位移电流项 $j\\omega \\mathbf{D}(\\mathbf{r})$，电荷守恒是如何得到协调一致地实施的。\n\n我们的目标是找到 $\\rho(\\mathbf{r})$ 的表达式。我们可以重新整理连续性方程来求解 $\\rho(\\mathbf{r})$：\n$$\nj\\omega \\rho(\\mathbf{r}) = - \\nabla \\cdot \\mathbf{J}_{total}(\\mathbf{r})\n$$\n$$\n\\rho(\\mathbf{r}) = -\\frac{1}{j\\omega} \\nabla \\cdot \\mathbf{J}_{total}(\\mathbf{r})\n$$\n接下来，我们代入总电流密度的表达式 $\\mathbf{J}_{total}(\\mathbf{r}) = \\mathbf{J}_{c}(\\mathbf{r}) + \\mathbf{J}_{s0}(\\mathbf{r})$ 和传导电流的本构关系 $\\mathbf{J}_{c}(\\mathbf{r}) = \\sigma \\mathbf{E}(\\mathbf{r})$：\n$$\n\\rho(\\mathbf{r}) = -\\frac{1}{j\\omega} \\nabla \\cdot (\\sigma \\mathbf{E}(\\mathbf{r}) + \\mathbf{J}_{s0}(\\mathbf{r}))\n$$\n利用散度算符的线性性质，我们得到：\n$$\n\\rho(\\mathbf{r}) = -\\frac{1}{j\\omega} (\\nabla \\cdot (\\sigma \\mathbf{E}(\\mathbf{r})) + \\nabla \\cdot \\mathbf{J}_{s0}(\\mathbf{r}))\n$$\n问题陈述了电导率 $\\sigma$ 是均匀的（空间常数）。标量与矢量场乘积的散度由乘法法则 $\\nabla \\cdot (f\\mathbf{A}) = f(\\nabla \\cdot \\mathbf{A}) + \\mathbf{A} \\cdot (\\nabla f)$ 给出。由于 $\\sigma$ 是常数，其梯度为零（$\\nabla \\sigma = 0$），这使得该项简化为 $\\nabla \\cdot (\\sigma \\mathbf{E}(\\mathbf{r})) = \\sigma (\\nabla \\cdot \\mathbf{E}(\\mathbf{r}))$。\n将此结果代入我们关于 $\\rho(\\mathbf{r})$ 的表达式中：\n$$\n\\rho(\\mathbf{r}) = -\\frac{1}{j\\omega} (\\sigma (\\nabla \\cdot \\mathbf{E}(\\mathbf{r})) + \\nabla \\cdot \\mathbf{J}_{s0}(\\mathbf{r}))\n$$\n这个表达式给出了以 $\\nabla\\cdot\\mathbf{E}(\\mathbf{r})$、$\\nabla\\cdot\\mathbf{J}_{s0}(\\mathbf{r})$、$\\sigma$、$j$ 和 $\\omega$ 表示的复相量自由电荷密度 $\\rho(\\mathbf{r})$，符合问题的要求。为了最终的表示形式，我们可以注意到 $-\\frac{1}{j} = j$，从而简化前置因子。\n$$\n\\rho(\\mathbf{r}) = \\frac{j}{\\omega} (\\sigma (\\nabla \\cdot \\mathbf{E}(\\mathbf{r})) + \\nabla \\cdot \\mathbf{J}_{s0}(\\mathbf{r}))\n$$\n这就是最终推导出的表达式。", "answer": "$$\n\\boxed{\\rho(\\mathbf{r}) = \\frac{j}{\\omega} \\left( \\sigma (\\nabla \\cdot \\mathbf{E}(\\mathbf{r})) + \\nabla \\cdot \\mathbf{J}_{s0}(\\mathbf{r}) \\right)}\n$$", "id": "3301409"}, {"introduction": "理论上的电荷连续性方程对数值模拟中的源设置施加了严格的限制。本练习将理论与实践相结合，要求您评估在频域求解器中不同激励源（电流和电荷）的可容许性 [@problem_id:3301360]。通过分析这些情景，您将学会如何避免因设置不兼容的源而导致的非物理结果，这是进行可靠电磁仿真的重要实践技能。", "problem": "一个频域计算电磁学模型假设场是线性的、时谐的，并使用 $e^{j \\omega t}$ 约定下的复相量，其中 $j=\\sqrt{-1}$，$ \\omega $ 是角频率。介质是线性的、各向同性的，其本构关系为 $\\mathbf{D}=\\epsilon \\mathbf{E}$ 和 $\\mathbf{B}=\\mu \\mathbf{H}$。外加源为电流密度 $\\mathbf{J}_s(\\mathbf{r})$ 和电荷密度 $\\rho_s(\\mathbf{r})$。从麦克斯韦方程组和基本守恒定律出发，判断对于此类频域求解器，以下哪些关于容许源规范和求解器一致性的陈述是正确的。\n\n选择所有适用项：\n\nA. 在时谐相量设定中，将静磁学的旋度方程与材料位移电流和高斯定律相结合，意味着局部相量连续性关系 $\\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0$ 必须处处成立；否则，源对 $\\left(\\mathbf{J}_s,\\rho_s\\right)$ 与麦克斯韦方程组不相容。\n\nB. 对于电场旋度-旋度公式，如果一个求解器只接受外加电流 $\\mathbf{J}_s$ 而不接受相应的 $\\rho_s$，那么容许性要求 $\\nabla \\cdot \\mathbf{J}_s = 0$；指定 $\\nabla \\cdot \\mathbf{J}_s \\neq 0$ 是不一致的，除非通过混合公式或与 $\\rho_s$ 耦合的附加约束来强制执行高斯定律。\n\nC. 当 $\\omega \\neq 0$ 时，任何外加电流分布 $\\mathbf{J}_s$ 都是容许的，无需附带 $\\rho_s$，因为位移电流项 $j \\omega \\epsilon \\mathbf{E}$ 总是通过场响应抵消 $\\nabla \\cdot \\mathbf{J}_s$，使得明确指定电荷变得不必要。\n\nD. 在静态极限 $\\omega \\to 0$ 下，容许的外加源满足 $\\nabla \\cdot \\mathbf{J}_s = 0$；试图同时指定一个非零散度的电流和一个不随时间变化的 $\\rho_s$ 是不相容的，因为在稳态下电荷不能累积。\n\nE. 在离散频域方案中，如有限元法 (FEM) 或矩量法 (MoM)，违反源的连续性通常会产生非物理的解、伪零空间或奇异代数系统，除非通过混合公式、拉格朗日乘子或相容的源投影来强制执行高斯定律。", "solution": "分析从电磁学的基本方程和电荷守恒原理开始，并按要求将它们转换到频域。\n\n控制方程是麦克斯韦方程组。在时域中，它们是：\n1.  高斯电场定律：$\\nabla \\cdot \\mathbf{D}(\\mathbf{r}, t) = \\rho(\\mathbf{r}, t)$\n2.  高斯磁场定律：$\\nabla \\cdot \\mathbf{B}(\\mathbf{r}, t) = 0$\n3.  法拉第电磁感应定律：$\\nabla \\times \\mathbf{E}(\\mathbf{r}, t) = -\\frac{\\partial \\mathbf{B}(\\mathbf{r}, t)}{\\partial t}$\n4.  安培-麦克斯韦定律：$\\nabla \\times \\mathbf{H}(\\mathbf{r}, t) = \\mathbf{J}(\\mathbf{r}, t) + \\frac{\\partial \\mathbf{D}(\\mathbf{r}, t)}{\\partial t}$\n\n总电荷密度 $\\rho$ 和总电流密度 $\\mathbf{J}$ 由外加（源）部分和感应部分组成。题目指定了外加源 $\\rho_s(\\mathbf{r})$ 和 $\\mathbf{J}_s(\\mathbf{r})$。材料响应由本构关系描述。因此，我们使用外加电流密度 $\\mathbf{J}_s$ 来写出安培-麦克斯韦定律：\n$$ \\nabla \\times \\mathbf{H}(\\mathbf{r}, t) = \\mathbf{J}_s(\\mathbf{r}, t) + \\frac{\\partial \\mathbf{D}(\\mathbf{r}, t)}{\\partial t} $$\n这里，任何感应传导电流都假定为材料模型的一部分（例如，被吸收到复介电常数 $\\epsilon$ 中）。高斯定律将场与外加源电荷联系起来：\n$$ \\nabla \\cdot \\mathbf{D}(\\mathbf{r}, t) = \\rho_s(\\mathbf{r}, t) $$\n电荷守恒定律是通过对安培-麦克斯韦定律取散度推导出来的。由于任何矢量场旋度的散度恒为零（$\\nabla \\cdot (\\nabla \\times \\mathbf{H}) = 0$），我们有：\n$$ \\nabla \\cdot (\\nabla \\times \\mathbf{H}) = \\nabla \\cdot \\mathbf{J}_s + \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{D}}{\\partial t}\\right) = 0 $$\n交换空间和时间导数的顺序（假设场是良态的）得到：\n$$ \\nabla \\cdot \\mathbf{J}_s + \\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{D}) = 0 $$\n代入高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_s$，得到外加源的时域电荷连续性方程：\n$$ \\nabla \\cdot \\mathbf{J}_s(\\mathbf{r}, t) + \\frac{\\partial \\rho_s(\\mathbf{r}, t)}{\\partial t} = 0 $$\n这个方程不是一个独立的假设，而是麦克斯韦方程组一致性的直接推论。\n\n对于使用相量约定 $e^{j \\omega t}$ 的时谐场，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $j \\omega$。时域方程转换为其相量域对应形式（其中场量现在是依赖于位置 $\\mathbf{r}$ 的复相量）：\n1.  $\\nabla \\cdot \\mathbf{D} = \\rho_s$\n2.  $\\nabla \\cdot \\mathbf{B} = 0$\n3.  $\\nabla \\times \\mathbf{E} = -j \\omega \\mathbf{B}$\n4.  $\\nabla \\times \\mathbf{H} = \\mathbf{J}_s + j \\omega \\mathbf{D}$\n电荷连续性方程变为：\n$$ \\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0 $$\n在频域分析中，这个关系代表了对任何物理上和数学上容许的外加源对 $(\\mathbf{J}_s, \\rho_s)$ 的一个基本约束。\n\n基于此基础，我们评估每个选项。\n\n**A. 在时谐相量设定中，将静磁学的旋度方程与材料位移电流和高斯定律相结合，意味着局部相量连续性关系 $\\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0$ 必须处处成立；否则，源对 $\\left(\\mathbf{J}_s,\\rho_s\\right)$ 与麦克斯韦方程组不相容。**\n\n推导过程是对相量形式的安培-麦克斯韦定律取散度：\n$$ \\nabla \\cdot (\\nabla \\times \\mathbf{H}) = \\nabla \\cdot (\\mathbf{J}_s + j \\omega \\mathbf{D}) $$\n左边是 $0$。右边是 $\\nabla \\cdot \\mathbf{J}_s + j \\omega (\\nabla \\cdot \\mathbf{D})$。\n$$ 0 = \\nabla \\cdot \\mathbf{J}_s + j \\omega (\\nabla \\cdot \\mathbf{D}) $$\n使用相量形式的高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_s$，我们代入得到：\n$$ \\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0 $$\n这证实了推导过程。由于这个关系是麦克斯韦方程组的直接数学推论，任何违反它的源对 $(\\mathbf{J}_s, \\rho_s)$ 根据定义都与待解的方程组不一致。因此，这样的源对是不可容许且不相容的。选项中对推导的描述略显非正式，但得出了正确的结论。\n**结论：正确。**\n\n**B. 对于电场旋度-旋度公式，如果一个求解器只接受外加电流 $\\mathbf{J}_s$ 而不接受相应的 $\\rho_s$，那么容许性要求 $\\nabla \\cdot \\mathbf{J}_s = 0$；指定 $\\nabla \\cdot \\mathbf{J}_s \\neq 0$ 是不一致的，除非通过混合公式或与 $\\rho_s$ 耦合的附加约束来强制执行高斯定律。**\n\n电场旋度-旋度方程是通过对法拉第定律取旋度并代入安培-麦克斯韦定律推导出来的：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla \\times (-j \\omega \\mathbf{B}) = -j \\omega \\mu (\\nabla \\times \\mathbf{H}) $$\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -j \\omega \\mu (\\mathbf{J}_s + j \\omega \\mathbf{D}) = -j \\omega \\mu \\mathbf{J}_s + \\omega^2 \\mu \\epsilon \\mathbf{E} $$\n重新整理得到关于 $\\mathbf{E}$ 的矢量亥姆霍兹方程：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) - \\omega^2 \\mu \\epsilon \\mathbf{E} = -j \\omega \\mu \\mathbf{J}_s $$\n如果一个求解器仅基于此方程，并且只接受 $\\mathbf{J}_s$ 作为输入，我们就必须检查其一致性。对该方程两边取散度，并利用矢量恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) \\equiv 0$，我们得到：\n$$ -\\omega^2 \\mu \\epsilon (\\nabla \\cdot \\mathbf{E}) = -j \\omega \\mu (\\nabla \\cdot \\mathbf{J}_s) $$\n对于 $\\omega \\neq 0$，这可以简化为：\n$$ \\nabla \\cdot \\mathbf{E} = \\frac{j}{\\omega \\epsilon} \\nabla \\cdot \\mathbf{J}_s $$\n这个结果表明，由旋度-旋度方程得到的解场 $\\mathbf{E}$ 的散度是由源电流 $\\mathbf{J}_s$ 的散度唯一决定的。然而，一个物理上正确的解还必须满足高斯定律 $\\nabla \\cdot \\mathbf{E} = \\rho_s / \\epsilon$。\n如果一个求解器没有明确地将 $\\rho_s$ 作为输入，它实际上是假设物理问题中不存在独立的外加电荷源，即 $\\rho_s = 0$。为了使解自洽，这两个关于 $\\nabla \\cdot \\mathbf{E}$ 的条件必须同时满足。`ρ_s = 0` 的要求意味着 `∇ ⋅ E = 0`，而这反过来又要求 `(j/ωε)∇ ⋅ J_s = 0`，即 `∇ ⋅ J_s = 0`。\n因此，如果向这样的求解器提供一个具有 `∇ ⋅ J_s ≠ 0` 的源，它所产生的解虽然满足旋度-旋度方程，但会违反高斯定律（因为它会对应一个非物理的、非预期的电荷密度 `ρ_s = ε(∇ ⋅ E) = (j/ω)∇ ⋅ J_s`）。这是计算电磁学中一个众所周知的问题，会导致伪解。通过混合公式（例如，场和势）或其他约束来强制执行高斯定律是标准的补救方法。\n**结论：正确。**\n\n**C. 当 $\\omega \\neq 0$ 时，任何外加电流分布 $\\mathbf{J}_s$ 都是容许的，无需附带 $\\rho_s$，因为位移电流项 $j \\omega \\epsilon \\mathbf{E}$ 总是通过场响应抵消 $\\nabla \\cdot \\mathbf{J}_s$，使得明确指定电荷变得不必要。**\n\n这个陈述声称，因为总电流密度 $\\mathbf{J}_{total} = \\mathbf{J}_s + j \\omega \\mathbf{D}$ 总是无散的（$\\nabla \\cdot \\mathbf{J}_{total} = 0$），所以任何 $\\mathbf{J}_s$ 都是容许的。恒等式 $\\nabla \\cdot (\\mathbf{J}_s + j \\omega \\mathbf{D}) = 0$ 是正确的。然而，它等价于 $\\nabla \\cdot \\mathbf{J}_s + j \\omega (\\nabla \\cdot \\mathbf{D}) = 0$。代入高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_s$ 得到连续性方程 $\\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0$。这表明，对于任何具有 $\\nabla \\cdot \\mathbf{J}_s \\neq 0$ 的 $\\mathbf{J}_s$，*必须*有一个相应的非零电荷密度 $\\rho_s = (j/\\omega) \\nabla \\cdot \\mathbf{J}_s$。“明确指定电荷是不必要的”这一说法具有危险的误导性。虽然可以只指定 $\\mathbf{J}_s$，但这隐含地定义了所需的 $\\rho_s$。如果物理问题意图使用不同的 $\\rho_s$（例如 $\\rho_s=0$），则输入是不一致的。此外，如 B 中所讨论的，标准的数值求解器可能无法正确产生与此隐含电荷对应的场，从而导致错误。因此，“任何” $\\mathbf{J}_s$ 都可以无后果地容许，这种说法是错误的。\n**结论：错误。**\n\n**D. 在静态极限 $\\omega \\to 0$ 下，容许的外加源满足 $\\nabla \\cdot \\mathbf{J}_s = 0$；试图同时指定一个非零散度的电流和一个不随时间变化的 $\\rho_s$ 是不相容的，因为在稳态下电荷不能累积。**\n\n我们从两个角度分析这一点。首先，对相量连续性方程 $\\nabla \\cdot \\mathbf{J}_s + j \\omega \\rho_s = 0$ 取 $\\omega \\to 0$ 的极限。假设 $\\rho_s$ 保持有限，则第二项消失，剩下 $\\nabla \\cdot \\mathbf{J}_s = 0$。其次，我们使用时域连续性方程：$\\nabla \\cdot \\mathbf{J}_s + \\frac{\\partial \\rho_s}{\\partial t} = 0$。静态极限 ($\\omega \\to 0$) 对应于稳态或直流条件，此时物理量不随时间变化。因此，$\\frac{\\partial \\rho_s}{\\partial t} = 0$。这直接意味着电流必须是无散的：$\\nabla \\cdot \\mathbf{J}_s = 0$。所提供的物理解释是合理的：非零的电流散度（$\\nabla \\cdot \\mathbf{J}_s \\neq 0$）意味着电荷正在从某一点流出或向某一点汇集，这将导致电荷密度 $\\rho_s$ 随时间变化（$\\frac{\\partial \\rho_s}{\\partial t} \\neq 0$）。这与 $\\rho_s$ 不随时间变化的静态或稳态情况的前提相矛盾。因此，该陈述是正确的。\n**结论：正确。**\n\n**E. 在离散频域方案中，如有限元法 (FEM) 或矩量法 (MoM)，违反源的连续性通常会产生非物理的解、伪零空间或奇异代数系统，除非通过混合公式、拉格朗日乘子或相容的源投影来强制执行高斯定律。**\n\n这个陈述准确地描述了上述理论问题在实践中和数值上的后果。当麦克斯韦方程组被离散化时，算子 $\\nabla \\cdot$ 和 $\\nabla \\times$ 变成矩阵。在构造良好的数值方案中（例如，使用德拉姆复形），旋度的散度为零的性质被一个矩阵恒等式所捕捉。如果离散化方程中的源项（源自 $\\mathbf{J}_s$）与连续性方程的离散版本不兼容，它可能部分地位于求解器无法正确处理的空间中。这可能激发伪的、非物理的解（通常与旋度-旋度算子的零空间相关），或者可能使最终的线性方程组 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 奇异或高度病态。所列出的补救措施——混合公式（例如，有限元法中的边元和节点元）、用拉格朗日乘子明确强制施加散度约束、或将源投影到散度协调子空间——都是计算电磁学中为解决这一问题而设计的标准高级技术。该陈述是对稳健数值求解器最新技术水平的正确总结。\n**结论：正确。**", "answer": "$$\\boxed{ABDE}$$", "id": "3301360"}, {"introduction": "将麦克斯韦方程从连续介质离散到数值网格上时，保持电荷守恒定律面临着新的挑战。这个思想实验将引导您深入分析一种广泛应用的算法——时域有限差分法（FDTD）——当离散的电荷连续性被违反时的行为 [@problem_id:3301350]。您将预测非物理电荷误差如何累积并固化为静态场，从而深刻理解保证离散守恒的重要性。", "problem": "在一个介电常数为 $\\varepsilon$、磁导率为 $\\mu$ 的三维线性各向同性电介质中，考虑以微分形式的 Maxwell 方程组为基本依据：$\\nabla \\times \\mathbf{H} = \\partial \\mathbf{D}/\\partial t + \\mathbf{J}$，$\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$，$\\nabla \\cdot \\mathbf{D} = \\rho$，以及 $\\partial \\rho/\\partial t + \\nabla \\cdot \\mathbf{J} = 0$。一个标准的时域有限差分 (FDTD) 方法将 $\\mathbf{E}$ 和 $\\mathbf{D}$ 置于整数时间层 $t^n = n \\Delta t$ 上，将 $\\mathbf{H}$ 置于半整数时间层 $t^{n+1/2} = (n+1/2)\\Delta t$ 上，其中 $\\Delta t$ 是时间步长。令 $\\nabla_h \\cdot$ 表示与交错的 Yee 网格布局一致的离散散度算子。将时间层 $n$ 的离散高斯定律残差定义为 $r^n := \\nabla_h \\cdot \\mathbf{D}^n - \\rho^n$。\n\n在此数值框架内设计以下思想实验。初始化条件为 $\\mathbf{E}^0 = \\mathbf{0}$、$\\mathbf{H}^{1/2} = \\mathbf{0}$ 和 $\\rho^0 = 0$。在一个由 $n = 0, 1, \\dots, N_s-1$ 索引的、预设的 $N_s$ 个时间步的区间内，注入一个空间局域化的节点电流源 $\\mathbf{J}^{n+1/2}$。该电流源直接应用于 $\\mathbf{D}$ 的离散安培定律更新中，但未以符合 Yee 网格交错方式的方式沉积在面上。代码不通过连续性方程更新 $\\rho$；它在所有 $n$ 上都保持 $\\rho^n \\equiv 0$。假设所选的局域化电流源使其离散散度 $\\nabla_h \\cdot \\mathbf{J}^{n+1/2}$ 在 $0 \\le n \\le N_s-1$ 期间于局域化位置非零，而在 $n \\ge N_s$ 时恒为零。没有额外的散度控制、双曲清理或椭圆投影步骤。\n\n从第一性原理出发，哪个选项最能预测离散高斯定律残差 $r^n$ 的演化及其对数值电磁场的影响？\n\nA. 离散高斯定律残差 $r^n$ 在所有 $n$ 上保持恒等于零，因为 Yee 格式会自动保持 $\\nabla_h \\cdot \\mathbf{D}^n = \\rho^n$；源中的任何不一致性都会被属性 $\\nabla_h \\cdot \\nabla_h \\times \\mathbf{H}^{n+1/2} = 0$ 消除，因此场在全局范围内不受影响。\n\nB. 当 $\\rho^n$ 保持固定时，离散高斯定律残差 $r^n$ 根据 $r^{n+1} = r^n - \\Delta t \\, \\nabla_h \\cdot \\mathbf{J}^{n+1/2}$ 累积由源引入的不一致性，因此 $r^n$ 在 $0 \\le n \\le N_s-1$ 期间逐步增长，然后在 $n \\ge N_s$ 时冻结。该残差充当一个有效的离散电荷，产生一个在源关闭后仍然存在的、不传播的、无旋（纵向）的 $\\mathbf{E}$ 分量；如果具有非零时间平均值 $\\nabla_h \\cdot \\mathbf{J}^{n+1/2}$ 的源被无限期地维持，纵向场将近似地随 $n$ 线性无界增长，而由旋度驱动的横向动力学则正常进行。\n\nC. 离散高斯定律残差 $r^n$ 被位移电流项 $\\partial \\mathbf{D}/\\partial t$ 以大约速度 $c = 1/\\sqrt{\\mu \\varepsilon}$ 辐射掉；场保持纯螺线管特性，任何无旋电场分量都被 Yee 网格交错所严格禁止，因此在几个时间步后没有持续的误差残留。\n\nD. 离散高斯定律残差 $r^n$ 仅通过法拉第定律激发磁场模式；因此，在线性各向同性介质中，无论源的不一致性如何，$\\nabla_h \\cdot \\mathbf{E}^n$ 在所有 $n$ 上都精确保持为零，电场不受影响。\n\nE. 离散高斯定律残差 $r^n$ 由于数值色散而指数衰减，衰减率与库朗数 $\\Delta t/\\Delta x$ 成正比；任何纵向 $\\mathbf{E}$ 分量都会被迅速阻尼，并在 $n \\to \\infty$ 时消失，即使不一致的源持续存在。", "solution": "该问题陈述是计算电磁学中一个有效的、适定的思想实验，旨在探究在标准时域有限差分 (FDTD) 方法中违反离散电荷连续性条件的后果。我们可以基于 Maxwell 方程组的离散形式进行严谨的分析。\n\nFDTD 方法以时间交错的方式更新电场和磁场。电位移场 $\\mathbf{D}$ 的更新是通过对安培定律 $\\nabla \\times \\mathbf{H} = \\partial \\mathbf{D}/\\partial t + \\mathbf{J}$ 的中心差分近似推导出来的。在 Yee 网格上，这变为：\n$$\n\\frac{\\mathbf{D}^{n+1} - \\mathbf{D}^n}{\\Delta t} = \\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2}\n$$\n这里，$\\mathbf{D}^n$ 是时间 $t^n = n \\Delta t$ 时的离散电位移场，$\\mathbf{H}^{n+1/2}$ 是时间 $t^{n+1/2} = (n+1/2)\\Delta t$ 时的离散磁场，$\\mathbf{J}^{n+1/2}$ 是源电流密度，而 $\\nabla_h \\times$ 是离散旋度算子。\n\n核心任务是确定离散高斯定律残差的演化，其定义为 $r^n := \\nabla_h \\cdot \\mathbf{D}^n - \\rho^n$，其中 $\\nabla_h \\cdot$ 是离散散度算子。为此，我们首先重新整理离散安培定律以求解 $\\mathbf{D}^{n+1}$：\n$$\n\\mathbf{D}^{n+1} = \\mathbf{D}^n + \\Delta t (\\nabla_h \\times \\mathbf{H}^{n+1/2} - \\mathbf{J}^{n+1/2})\n$$\n接下来，我们将离散散度算子 $\\nabla_h \\cdot$ 应用于整个方程：\n$$\n\\nabla_h \\cdot \\mathbf{D}^{n+1} = \\nabla_h \\cdot \\mathbf{D}^n + \\Delta t (\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{H}^{n+1/2}) - \\nabla_h \\cdot \\mathbf{J}^{n+1/2})\n$$\nYee FDTD 格式的一个基本性质是离散旋度的离散散度恒等于零：对于任何离散矢量场 $\\mathbf{A}$，都有 $\\nabla_h \\cdot (\\nabla_h \\times \\mathbf{A}) = 0$。将此性质应用于磁场项，我们得到：\n$$\n\\nabla_h \\cdot \\mathbf{D}^{n+1} = \\nabla_h \\cdot \\mathbf{D}^n - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})\n$$\n这个方程是电荷连续性方程的离散模拟。它显示了位移场散度如何随时间演化，由电流密度的散度驱动。\n\n现在，我们使用残差的定义 $r^n = \\nabla_h \\cdot \\mathbf{D}^n - \\rho^n$，可以写成 $\\nabla_h \\cdot \\mathbf{D}^n = r^n + \\rho^n$。将此代入 $\\nabla_h \\cdot \\mathbf{D}$ 的演化方程：\n$$\nr^{n+1} + \\rho^{n+1} = (r^n + \\rho^n) - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})\n$$\n问题陈述中指出，电荷密度 $\\rho^n$ 在所有时间步都保持为零，所以 $\\rho^n = \\rho^{n+1} = 0$。残差 $r^n$ 的演化方程简化为：\n$$\nr^{n+1} = r^n - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})\n$$\n让我们根据给定条件分析 $r^n$ 的演化。\n初始条件是 $\\mathbf{E}^0 = \\mathbf{0}$ 和 $\\rho^0 = 0$。由于介质是线性的，$\\mathbf{D}^0 = \\varepsilon \\mathbf{E}^0 = \\mathbf{0}$。因此，初始残差为 $r^0 = \\nabla_h \\cdot \\mathbf{D}^0 - \\rho^0 = 0 - 0 = 0$。\n\n在源注入期间，$0 \\le n \\le N_s-1$，源是活动的并且具有非零的离散散度，$\\nabla_h \\cdot \\mathbf{J}^{n+1/2} \\neq 0$。残差在每个时间步累积：\n$r^1 = r^0 - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{1/2}) = - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{1/2})$\n$r^2 = r^1 - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{3/2}) = - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{1/2} + \\nabla_h \\cdot \\mathbf{J}^{3/2})$\n通常，对于 $n \\le N_s$：\n$$\nr^n = - \\Delta t \\sum_{k=0}^{n-1} \\nabla_h \\cdot \\mathbf{J}^{k+1/2}\n$$\n在此区间内，残差会增长。\n\n源关闭后，对于 $n \\ge N_s$，源的散度恒为零，$\\nabla_h \\cdot \\mathbf{J}^{n+1/2} = 0$。残差的演化方程变为：\n$$\nr^{n+1} = r^n\n$$\n这意味着对于所有 $n \\ge N_s$，残差停止变化并“冻结”在它于 $n=N_s$ 时达到的值：$r^n = r^{N_s}$。\n\n必须考察这个持续存在的非零残差的影响。由于 $\\rho^n$ 保持为 0，残差等于位移场的散度：$r^n = \\nabla_h \\cdot \\mathbf{D}^n$。$\\mathbf{D}$（以及 $\\mathbf{E}$）的非零散度等效于存在一个静态净电荷。这个残差 $r^{N_s}$ 充当一个有效的、非物理的离散电荷密度，它被数值地注入到仿真域中。\n\n根据亥姆霍兹分解定理，电场 $\\mathbf{E}^n$ 可以分解为一个无旋（纵向）部分 $\\mathbf{E}_L^n$ 和一个无散（横向）部分 $\\mathbf{E}_T^n$。无旋部分旋度为零（$\\nabla_h \\times \\mathbf{E}_L^n = \\mathbf{0}$）并携带所有散度（$\\nabla_h \\cdot \\mathbf{E}_L^n = \\nabla_h \\cdot \\mathbf{E}^n$）。无散部分散度为零（$\\nabla_h \\cdot \\mathbf{E}_T^n = \\mathbf{0}$）并携带所有旋度。\n对于 $n \\ge N_s$，持续存在的残差 $r^n$ 会产生一个持续的、静态的、无旋的电场分量 $\\mathbf{E}_L$，满足 $\\nabla_h \\cdot (\\varepsilon \\mathbf{E}_L) = r^{N_s}$。这是一个离散的泊松方程。这个纵向场分量是静态的；它不会传播或辐射出去，因为它的演化不受基于旋度的波动方程的支配。横向分量 $\\mathbf{E}_T$ 和 $\\mathbf{H}$ 根据通常的 FDTD 波动动力学演化，基本上不受静态纵向场的影响。如果具有非零时间平均值的不一致源被无限期地维持，残差 $r^n$ 将随时间线性增长，导致非物理的纵向电场无界增长，从而引发数值不稳定性。\n\n基于此推导，我们评估各个选项：\n\nA. 离散高斯定律残差 $r^n$ 在所有 $n$ 上保持恒等于零，因为 Yee 格式会自动保持 $\\nabla_h \\cdot \\mathbf{D}^n = \\rho^n$；源中的任何不一致性都会被属性 $\\nabla_h \\cdot \\nabla_h \\times \\mathbf{H}^{n+1/2} = 0$ 消除，因此场在全局范围内不受影响。\n**不正确**。推导 $r^{n+1} = r^n - \\Delta t (\\nabla_h \\cdot \\mathbf{J}^{n+1/2})$ 表明 $r^n$ 不会保持为零。属性 $\\nabla_h \\cdot \\nabla_h \\times \\mathbf{H}^{n+1/2} = 0$ 导致了残差的累积，而不是其消除。Yee 格式不会自动强制 $\\nabla_h \\cdot \\mathbf{D}^n = \\rho^n$；它强制的是一个离散的连续性方程，该方程将 $\\nabla_h \\cdot \\mathbf{D}$ 的时间导数与 $\\nabla_h \\cdot \\mathbf{J}$ 联系起来。\n\nB. 当 $\\rho^n$ 保持固定时，离散高斯定律残差 $r^n$ 根据 $r^{n+1} = r^n - \\Delta t \\, \\nabla_h \\cdot \\mathbf{J}^{n+1/2}$ 累积由源引入的不一致性，因此 $r^n$ 在 $0 \\le n \\le N_s-1$ 期间逐步增长，然后在 $n \\ge N_s$ 时冻结。该残差充当一个有效的离散电荷，产生一个在源关闭后仍然存在的、不传播的、无旋（纵向）的 $\\mathbf{E}$ 分量；如果具有非零时间平均值 $\\nabla_h \\cdot \\mathbf{J}^{n+1/2}$ 的源被无限期地维持，纵向场将近似地随 $n$ 线性无界增长，而由旋度驱动的横向动力学则正常进行。\n**正确**。该陈述完美地总结了推导的结论。更新规则、残差的累积和冻结、其作为有效电荷的解释，以及由此产生的非传播纵向场分量都得到了正确的描述。在持续源作用下的行为也被正确陈述。\n\nC. 离散高斯定律残差 $r^n$ 被位移电流项 $\\partial \\mathbf{D}/\\partial t$ 以大约速度 $c = 1/\\sqrt{\\mu \\varepsilon}$ 辐射掉；场保持纯螺线管特性，任何无旋电场分量都被 Yee 网格交错所严格禁止，因此在几个时间步后没有持续的误差残留。\n**不正确**。残差对应于一个静态电荷误差，它产生一个静态（零频率）场分量。静态场不会辐射。标准的 FDTD 算法没有提供将此误差传播出去的机制。Yee 晶格并不禁止无旋场；它们只是与横向波传播动力学解耦。\n\nD. 离散高斯定律残差 $r^n$ 仅通过法拉第定律激发磁场模式；因此，在线性各向同性介质中，无论源的不一致性如何，$\\nabla_h \\cdot \\mathbf{E}^n$ 在所有 $n$ 上都精确保持为零，电场不受影响。\n**不正确**。残差是根据 $\\nabla_h \\cdot \\mathbf{D}^n$ 定义的，因此它直接衡量电场散度。推导表明 $\\nabla_h \\cdot \\mathbf{D}^n$ 变为非零，这与它精确保持为零的说法相矛盾。源的不一致性主要影响电场的无旋部分，而不是通过法拉第定律影响磁场模式。\n\nE. 离散高斯定律残差 $r^n$ 由于数值色散而指数衰减，衰减率与库朗数 $\\Delta t/\\Delta x$ 成正比；任何纵向 $\\mathbf{E}$ 分量都会被迅速阻尼，并在 $n \\to \\infty$ 时消失，即使不一致的源持续存在。\n**不正确**。标准的无损 FDTD 格式不包含任何会导致静态、零频率误差模式衰减的内在阻尼机制。数值色散描述的是传播波的相速度的频率依赖性，它不会引起静态场的阻尼。残差会持续存在或增长，而不会衰减。", "answer": "$$\\boxed{B}$$", "id": "3301350"}]}