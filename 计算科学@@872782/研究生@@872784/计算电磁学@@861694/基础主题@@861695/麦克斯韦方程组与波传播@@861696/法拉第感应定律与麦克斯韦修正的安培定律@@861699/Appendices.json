{"hands_on_practices": [{"introduction": "这个实践练习旨在加深对安培-麦克斯韦定律核心——位移电流的理解。通过在一个具体的分区域定义的场景中分别计算传导电流和位移电流，你将亲身体会到时变电场如何像真实电流一样成为磁场的源，这是经典电动力学的基石之一。这项练习将检验你应用安培-麦克斯韦定律积分形式以及区分并量化两种电流贡献的能力[@problem_id:3306604]。", "problem": "考虑一个在自由空间中，被介电夹杂物改变的、由源驱动的均匀、各向同性、时变电磁场。设矩形表面 $\\mathcal{S}$ 位于 $z=0$ 平面，其向外的单位法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$，其边界 $\\partial\\mathcal{S}$ 从 $+\\hat{\\mathbf{z}}$ 方向看去为逆时针方向。该矩形的范围为 $x \\in [0,L_{x}]$ 和 $y \\in [0,L_{y}]$，其中 $L_{x} = 0.3 \\ \\mathrm{m}$ 且 $L_{y} = 0.2 \\ \\mathrm{m}$。传导电流密度是分段恒定的，并且纯粹垂直于 $\\mathcal{S}$：\n- 在子区域 $R_{1}: x \\in [0,0.1], y \\in [0,0.2]$ 中，$\\mathbf{J}(x,y)=J_{1}\\hat{\\mathbf{z}}$，其中 $J_{1}=5 \\ \\mathrm{A/m^{2}}$。\n- 在子区域 $R_{2}: x \\in [0.1,0.2], y \\in [0.1,0.2]$ 中，$\\mathbf{J}(x,y)=J_{2}\\hat{\\mathbf{z}}$，其中 $J_{2}=-3 \\ \\mathrm{A/m^{2}}$。\n- 在子区域 $R_{3}: x \\in [0.2,0.3], y \\in [0,0.05]$ 中，$\\mathbf{J}(x,y)=J_{3}\\hat{\\mathbf{z}}$，其中 $J_{3}=20 \\ \\mathrm{A/m^{2}}$。\n在 $\\mathcal{S}$ 的其他任何地方，$\\mathbf{J}(x,y)=\\mathbf{0}$。\n\n此外，在子区域 $D_{1}: x \\in [0,0.3], y \\in [0.05,0.1]$ 中，存在一个时谐电场 $\\mathbf{E}(x,y,t)=E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}$，其中 $E_{0}=100 \\ \\mathrm{V/m}$ 且 $\\omega = 10^{6} \\ \\mathrm{rad/s}$。在 $D_{1}$ 中的介电常数为 $\\varepsilon=\\varepsilon_{r}\\varepsilon_{0}$，其中相对介电常数 $\\varepsilon_{r}=4$，真空介电常数 $\\varepsilon_{0}=8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$。在其他任何地方，由于电场为零，介电常数对此计算不重要。假设磁场 $\\mathbf{H}$ 足够光滑以适用斯托克斯定理。\n\n从基本电磁定律出发，计算在时刻 $t_{0}=\\pi/(2\\omega)$ 的环路积分 $\\displaystyle \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell}$，并根据安培-麦克斯韦定律，验证它与 $\\mathbf{J}+\\partial \\mathbf{D}/\\partial t$ 在 $\\mathcal{S}$ 上的面积分相等。将最终的环路积分以 $\\mathrm{A}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "问题要求计算磁场 $\\mathbf{H}$ 围绕矩形表面 $\\mathcal{S}$ 的边界 $\\partial\\mathcal{S}$ 的环路积分。问题陈述要求根据安培-麦克斯韦定律，验证该环路积分与通过 $\\mathcal{S}$ 的总电流相等。问题的措辞意味着环路积分将通过计算总电流来求得。\n\n控制这一现象的基本原理是积分形式的安培-麦克斯韦定律，它将磁场 $\\mathbf{H}$ 围绕闭合回路 $\\partial\\mathcal{S}$ 的环路积分与通过该回路所界定的表面 $\\mathcal{S}$ 的总电流联系起来。应用斯托克斯定理，该定律可写作：\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = \\iint_{\\mathcal{S}} \\left( \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} \\right) \\cdot d\\mathbf{S} $$\n其中 $\\mathbf{J}$ 是传导电流密度，$\\frac{\\partial \\mathbf{D}}{\\partial t}$ 是位移电流密度，而 $\\mathbf{D}$ 是电位移场。总电流 $I_{\\text{total}}$ 是传导电流 $I_c = \\iint_{\\mathcal{S}} \\mathbf{J} \\cdot d\\mathbf{S}$ 和位移电流 $I_d = \\iint_{\\mathcal{S}} \\frac{\\partial \\mathbf{D}}{\\partial t} \\cdot d\\mathbf{S}$ 的和。\n\n我们的任务是计算在特定时刻 $t_{0}=\\pi/(2\\omega)$ 的这个总电流。表面 $\\mathcal{S}$ 位于 $z=0$ 平面，因此微分面元为 $d\\mathbf{S} = dx\\,dy\\,\\hat{\\mathbf{z}}$。给定的向外法向量为 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{z}}$，这与逆时针的路径方向是一致的。\n\n首先，我们计算通过表面 $\\mathcal{S}$ 的总传导电流 $I_c$。传导电流密度 $\\mathbf{J}$ 是分段恒定的，并沿 $\\hat{\\mathbf{z}}$ 方向。因此，$\\mathbf{J} \\cdot d\\mathbf{S} = J(x,y)\\,dx\\,dy$。总传导电流是在 $\\mathbf{J}$ 不为零的子区域中电流的总和。\n传导电流的积分为：\n$$ I_c = \\iint_{\\mathcal{S}} \\mathbf{J} \\cdot d\\mathbf{S} = \\iint_{R_1} J_1\\,dx\\,dy + \\iint_{R_2} J_2\\,dx\\,dy + \\iint_{R_3} J_3\\,dx\\,dy $$\n由于电流密度在各自的矩形区域内是恒定的，因此积分是密度与各区域面积的乘积。\n子区域 $R_{1}$ ($x \\in [0,0.1]$, $y \\in [0,0.2]$) 的面积是 $A_{1} = (0.1 - 0)\\,\\mathrm{m} \\times (0.2 - 0)\\,\\mathrm{m} = 0.02\\,\\mathrm{m}^2$。\n子区域 $R_{2}$ ($x \\in [0.1,0.2]$, $y \\in [0.1,0.2]$) 的面积是 $A_{2} = (0.2 - 0.1)\\,\\mathrm{m} \\times (0.2 - 0.1)\\,\\mathrm{m} = 0.01\\,\\mathrm{m}^2$。\n子区域 $R_{3}$ ($x \\in [0.2,0.3]$, $y \\in [0,0.05]$) 的面积是 $A_{3} = (0.3 - 0.2)\\,\\mathrm{m} \\times (0.05 - 0)\\,\\mathrm{m} = 0.005\\,\\mathrm{m}^2$。\n\n使用给定的电流密度值，$J_{1}=5 \\ \\mathrm{A/m^{2}}$，$J_{2}=-3 \\ \\mathrm{A/m^{2}}$，和 $J_{3}=20 \\ \\mathrm{A/m^{2}}$，总传导电流为：\n$$ I_c = J_{1}A_{1} + J_{2}A_{2} + J_{3}A_{3} = (5\\,\\mathrm{A/m^2})(0.02\\,\\mathrm{m^2}) + (-3\\,\\mathrm{A/m^2})(0.01\\,\\mathrm{m^2}) + (20\\,\\mathrm{A/m^2})(0.005\\,\\mathrm{m^2}) $$\n$$ I_c = 0.1\\,\\mathrm{A} - 0.03\\,\\mathrm{A} + 0.1\\,\\mathrm{A} = 0.17\\,\\mathrm{A} $$\n\n接下来，我们计算在时刻 $t_{0}=\\pi/(2\\omega)$ 的位移电流 $I_d$。电场 $\\mathbf{E}$ 仅在子区域 $D_1: x \\in [0,0.3], y \\in [0.05,0.1]$ 中非零。在该区域，$\\mathbf{E}(t) = E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}$。介质是线性电介质，其介电常数为 $\\varepsilon = \\varepsilon_r\\varepsilon_0$，因此电位移场为 $\\mathbf{D} = \\varepsilon\\mathbf{E}$。\n$$ \\mathbf{D}(t) = \\varepsilon_r\\varepsilon_0 E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}} $$\n位移电流密度是 $\\mathbf{D}$ 的时间导数：\n$$ \\frac{\\partial \\mathbf{D}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\varepsilon_r\\varepsilon_0 E_{0}\\cos(\\omega t)\\,\\hat{\\mathbf{z}}\\right) = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin(\\omega t)\\,\\hat{\\mathbf{z}} $$\n我们在特定时间 $t_{0} = \\pi/(2\\omega)$ 计算该值：\n$$ \\left.\\frac{\\partial \\mathbf{D}}{\\partial t}\\right|_{t=t_0} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin\\left(\\omega \\frac{\\pi}{2\\omega}\\right)\\,\\hat{\\mathbf{z}} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\sin\\left(\\frac{\\pi}{2}\\right)\\,\\hat{\\mathbf{z}} = -\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\,\\hat{\\mathbf{z}} $$\n该位移电流密度在区域 $D_1$ 上是空间均匀的，在 $\\mathcal{S}$ 的其他地方为零。总位移电流是该密度在表面 $\\mathcal{S}$ 上的积分。该积分仅在 $D_1$ 上非零。\n$$ I_d(t_0) = \\iint_{\\mathcal{S}} \\left.\\frac{\\partial \\mathbf{D}}{\\partial t}\\right|_{t=t_0} \\cdot d\\mathbf{S} = \\iint_{D_1} (-\\varepsilon_r\\varepsilon_0 E_{0}\\omega\\,\\hat{\\mathbf{z}}) \\cdot (dx\\,dy\\,\\hat{\\mathbf{z}}) $$\n由于被积函数是常数，积分是被积函数与区域 $D_1$ 面积的乘积。\n子区域 $D_1$ 的面积是 $A_{D1} = (0.3 - 0)\\,\\mathrm{m} \\times (0.1 - 0.05)\\,\\mathrm{m} = 0.3\\,\\mathrm{m} \\times 0.05\\,\\mathrm{m} = 0.015\\,\\mathrm{m}^2$。\n现在，我们代入给定的数值：$\\varepsilon_r=4$，$\\varepsilon_{0}=8.8541878128 \\times 10^{-12} \\ \\mathrm{F/m}$，$E_{0}=100 \\ \\mathrm{V/m}$，以及 $\\omega = 10^{6} \\ \\mathrm{rad/s}$。\n$$ I_d(t_0) = -(\\varepsilon_r\\varepsilon_0 E_{0}\\omega) A_{D1} $$\n$$ I_d(t_0) = -(4)(8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m})(100\\,\\mathrm{V/m})(10^6\\,\\mathrm{rad/s})(0.015\\,\\mathrm{m^2}) $$\n$$ I_d(t_0) = -(4 \\times 100 \\times 10^6 \\times 0.015) \\times (8.8541878128 \\times 10^{-12}) \\ \\mathrm{A} $$\n$$ I_d(t_0) = -(6 \\times 10^6) \\times (8.8541878128 \\times 10^{-12}) \\ \\mathrm{A} $$\n$$ I_d(t_0) = -53.1251268768 \\times 10^{-6} \\ \\mathrm{A} \\approx -0.000053125 \\ \\mathrm{A} $$\n总电流是传导电流和位移电流的和：\n$$ I_{\\text{total}}(t_0) = I_c + I_d(t_0) = 0.17\\,\\mathrm{A} - 0.0000531251268768\\,\\mathrm{A} = 0.16994687487312\\,\\mathrm{A} $$\n环路积分等于这个总电流：\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = 0.16994687487312\\,\\mathrm{A} $$\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $1$、$6$、$9$、$9$。第五位数字是 $4$，所以我们向下舍入。\n$$ \\oint_{\\partial\\mathcal{S}} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} \\approx 0.1699\\,\\mathrm{A} $$\n这个结果通过显式计算方程的右侧，验证了安培-麦克斯韦定律所要求的等式关系。", "answer": "$$ \\boxed{0.1699} $$", "id": "3306604"}, {"introduction": "这项练习揭示了法拉第感应定律和安培-麦克斯韦定律相结合所带来的深刻结论：电磁波的预言。你将从这两个定律出发推导出波动方程，并利用所得到的波特性来判断电准静态（EQS）近似的有效性[@problem_id:3306587]。对于工程师和物理学家而言，判断何时可以采用简化的模型是一项至关重要的技能。", "problem": "一个均匀、各向同性、无损的电介质体占据着自由空间。该区域内没有自由电荷或电流。材料参数由 $ \\epsilon = \\epsilon_{r}\\,\\epsilon_{0} $（其中 $ \\epsilon_{r} = 9.000 $）和 $ \\mu = \\mu_{r}\\,\\mu_{0} $（其中 $ \\mu_{r} = 1.000 $）给出。该几何结构的最大线性尺寸为 $ L = 2.000 \\times 10^{-2}\\,\\text{m} $。该物体被频率为 $ f = 1.000 \\times 10^{7}\\,\\text{Hz} $ 的时谐场所激励（任何相位量均使用弧度）。真空常数为 $ \\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1} $ 和 $ \\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1} $。\n\n仅使用在无源均匀介质中的法拉第电磁感应定律 $ \\nabla \\times \\mathbf{E} = -\\dfrac{\\partial \\mathbf{B}}{\\partial t} $ 和带有麦克斯韦修正的安培定律 $ \\nabla \\times \\mathbf{H} = \\dfrac{\\partial \\mathbf{D}}{\\partial t} $，以及本构关系 $ \\mathbf{D} = \\epsilon \\mathbf{E} $ 和 $ \\mathbf{B} = \\mu \\mathbf{H} $，推导色散关系，推断相速度 $ v_{p} $ 和波长 $ \\lambda $，并使用无量纲参数 $ kL $（其中 $ k $ 是波数）来量化电准静态（EQS）近似的有效性。报告给定数据下 $ kL $ 的数值。将您的答案四舍五入到四位有效数字。将最终结果表示为一个没有单位的无量纲数。", "solution": "该问题被验证为具有科学依据、适定且客观的。它基于麦克斯韦方程组所描述的经典电磁学的基本原理。所有提供的数据都符合物理实际，并足以得到唯一解。\n\n推导从麦克斯韦理论中针对无源（$ \\rho = 0 $, $ \\mathbf{J} = 0 $）、均匀、各向同性、无损介质的两个旋度方程开始。\n\n法拉第电磁感应定律为：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n带有麦克斯韦修正的安培定律为：\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n线性、各向同性介质的本构关系为：\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\n$$ \\mathbf{B} = \\mu \\mathbf{H} $$\n其中 $ \\epsilon = \\epsilon_{r}\\,\\epsilon_{0} $ 和 $ \\mu = \\mu_{r}\\,\\mu_{0} $ 分别是介质的介电常数和磁导率。\n\n将本构关系代入麦克斯韦方程组，我们得到：\n$$ \\nabla \\times \\mathbf{E} = -\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} \\quad (1) $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} \\quad (2) $$\n为了推导电场 $ \\mathbf{E} $ 的波动方程，我们对方程 $(1)$ 取旋度：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla \\times \\left(-\\mu \\frac{\\partial \\mathbf{H}}{\\partial t}\\right) $$\n由于介质是均匀的，$ \\mu $ 在空间上是常数。此外，空间和时间导数是独立的，因此我们可以交换算子的顺序：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\mu \\frac{\\partial}{\\partial t}(\\nabla \\times \\mathbf{H}) $$\n将方程 $(2)$ 代入右侧，得到：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\mu \\frac{\\partial}{\\partial t}\\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) = -\\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} $$\n现在我们将矢量恒等式 $ \\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V} $ 应用于左侧：\n$$ \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = -\\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} $$\n在无源区域（$ \\rho=0 $）中，电场高斯定律 $ \\nabla \\cdot \\mathbf{D} = \\rho $ 简化为 $ \\nabla \\cdot \\mathbf{D} = 0 $。给定 $ \\mathbf{D} = \\epsilon \\mathbf{E} $ 和均匀介电常数 $ \\epsilon $，这意味着 $ \\nabla \\cdot \\mathbf{E} = 0 $。因此，方程简化为齐次矢量波动方程：\n$$ \\nabla^2 \\mathbf{E} - \\mu\\epsilon \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = 0 $$\n对于角频率为 $ \\omega $ 的时谐场，场的形式具有 $ e^{i\\omega t} $ 的时间依赖性。因此，时间导数算子可以被 $ \\frac{\\partial}{\\partial t} \\to i\\omega $ 替代，二阶时间导数可以被 $ \\frac{\\partial^2}{\\partial t^2} \\to (i\\omega)^2 = -\\omega^2 $ 替代。波动方程变为矢量亥姆霍兹方程：\n$$ \\nabla^2 \\mathbf{E} - \\mu\\epsilon (-\\omega^2\\mathbf{E}) = 0 $$\n$$ \\nabla^2 \\mathbf{E} + \\omega^2\\mu\\epsilon\\mathbf{E} = 0 $$\n为了求出色散关系，我们考虑一个形式为 $ \\mathbf{E}(\\mathbf{r}) = \\mathbf{E}_{0} e^{-i\\mathbf{k} \\cdot \\mathbf{r}} $ 的平面波解，其中 $ \\mathbf{k} $ 是波矢。对于此解，拉普拉斯算子的作用为 $ \\nabla^2 \\to -|\\mathbf{k}|^2 = -k^2 $。将此代入亥姆霍兹方程：\n$$ -k^2\\mathbf{E} + \\omega^2\\mu\\epsilon\\mathbf{E} = 0 $$\n对于非平凡解（$ \\mathbf{E} \\neq 0 $），标量系数必须为零。这给出了介质的色散关系：\n$$ k^2 = \\omega^2\\mu\\epsilon $$\n相速度 $ v_p $ 定义为 $ v_p = \\frac{\\omega}{k} $。从色散关系，我们推断出：\n$$ v_p = \\frac{\\omega}{\\omega\\sqrt{\\mu\\epsilon}} = \\frac{1}{\\sqrt{\\mu\\epsilon}} $$\n波长为 $ \\lambda = \\frac{2\\pi}{k} $，也可以表示为 $ \\lambda = \\frac{v_p}{f} $。\n\n现在我们计算无量纲参数 $ kL $ 的数值。波数 $ k $ 由下式给出：\n$$ k = \\omega \\sqrt{\\mu\\epsilon} = (2\\pi f) \\sqrt{(\\mu_r\\mu_0)(\\epsilon_r\\epsilon_0)} = 2\\pi f \\sqrt{\\mu_r\\epsilon_r} \\sqrt{\\mu_0\\epsilon_0} $$\n真空中光速为 $ c = 1/\\sqrt{\\mu_0\\epsilon_0} $。因此，我们可以将 $ k $ 写为：\n$$ k = \\frac{2\\pi f \\sqrt{\\mu_r\\epsilon_r}}{c} $$\n因此，无量纲参数 $ kL $ 为：\n$$ kL = \\frac{2\\pi f L \\sqrt{\\mu_r\\epsilon_r}}{c} $$\n问题提供了以下数值：\n$ f = 1.000 \\times 10^{7}\\,\\text{Hz} $\n$ L = 2.000 \\times 10^{-2}\\,\\text{m} $\n$ \\epsilon_{r} = 9.000 $\n$ \\mu_{r} = 1.000 $\n$ \\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1} $\n$ \\mu_{0} = 4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1} $\n\n首先，我们根据给定的真空常数计算光速 $ c $：\n$$ c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}} = \\frac{1}{\\sqrt{(4\\pi \\times 10^{-7}\\,\\text{H}\\,\\text{m}^{-1})(8.854\\,187\\,8128 \\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1})}} = 299\\,792\\,458\\,\\text{m}\\,\\text{s}^{-1} $$\n现在，我们将这些数值代入 $ kL $ 的表达式中：\n$$ kL = \\frac{2\\pi (1.000 \\times 10^{7}) (2.000 \\times 10^{-2}) \\sqrt{9.000 \\times 1.000}}{299\\,792\\,458} $$\n$$ kL = \\frac{2\\pi (2.000 \\times 10^{5}) \\sqrt{9.000}}{299\\,792\\,458} = \\frac{2\\pi (2.000 \\times 10^{5}) (3.000)}{299\\,792\\,458} $$\n$$ kL = \\frac{12.00\\pi \\times 10^{5}}{299\\,792\\,458} \\approx \\frac{3\\,769\\,911.18}{299\\,792\\,458} $$\n$$ kL \\approx 0.012575028 $$\n电准静态（EQS）近似在系统尺寸远小于波长时有效，即 $ L \\ll \\lambda $。这等效于条件 $ kL \\ll 2\\pi $，更严格地说是 $ kL \\ll 1 $。所得到的 $ kL $ 的小数值证实了对于这种情况，EQS 近似将是非常准确的。\n\n将结果四舍五入到四位有效数字：\n前四位有效数字是 $ 1 $、$ 2 $、$ 5 $ 和 $ 7 $。第五位数字是 $ 5 $，需要将第四位数字向上进位。\n$$ kL \\approx 0.01258 $$", "answer": "$$\\boxed{0.01258}$$", "id": "3306587"}, {"introduction": "这个顶石级别的实践项目将理论带入了计算电磁学（CEM）的领域。你将解决一个逆问题：从测量的电动势（EMF）数据中恢复磁场分布。这要求你将法拉第定律、无散度条件和波动方程转化为一个离散的线性方程组并进行计算求解，从而体验现代工程和科学研究中使用的强大方法[@problem_id:3306628]。", "problem": "您的任务是在计算电磁学中设计并实现一个反演求解器，以恢复一个与法拉第感应定律和带有麦克斯韦修正的安培定律相符的时变磁通量分布。恢复过程必须强制施加无散度约束。程序必须是完整且可运行的。\n\n一个在真空中尺寸为 $L_x$、$L_y$ 和 $L_z$ 的矩形域，使用有限体积法布局被离散化为一个 $N_x \\times N_y \\times N_z$ 单元的均匀网格。设单元尺寸为 $h_x = L_x/N_x$、$h_y = L_y/N_y$ 和 $h_z = L_z/N_z$。面根据其外法线方向分为：$x$-面、$y$-面和 $z$-面。对于每个面 $f$，定义磁通量 $\\Phi_f(t) = \\int_{S_f} \\mathbf{B}(\\mathbf{r},t)\\cdot \\mathbf{n}_f \\, dS$，单位为韦伯。对于每个矩形面 $f$，沿其边界矩形回路测得的时变电动势 (EMF) 由线积分 $\\mathcal{E}_f(t) = \\oint_{\\partial S_f} \\mathbf{E}(\\mathbf{r},t) \\cdot d\\mathbf{l}$ 给出，单位为伏特，而法拉第感应定律意味着 $\\mathcal{E}_f(t) = - \\frac{d}{dt}\\Phi_f(t)$。您将获得在一组离散时间点上，每个面边界回路上的合成EMF数据，您必须在这些时间点恢复面通量 $\\Phi_f(t)$。\n\n为确保物理上的一致性，您必须施加麦克斯韦方程组中的无散度约束 $\\nabla \\cdot \\mathbf{B} = 0$，其有限体积形式为：对于每个单元 $c$ 在时间 $t$，穿过其六个面的向外磁通量之和必须为 $0$。此外，在真空中且无自由电流的情况下，带有麦克斯韦修正的安培定律的微分形式 $\\nabla \\times \\mathbf{B} = \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$，与法拉第定律 $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$ 结合，得出磁通量密度的齐次波动方程 $\\nabla^2 \\mathbf{B} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{B}}{\\partial t^2} = \\mathbf{0}$，其中 $c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}}$ 是真空中的光速。您的恢复过程必须通过正则化使解与此波动方程一致，该方程已在面心网格上和离散时间点上进行了适当的离散化。\n\n您必须实现一个线性最小二乘反演求解器，它对所有面 $f$ 和离散时间 $t_k$，通过离散时间导数强制执行法拉第定律所蕴含的测量关系，对每个单元和时间强制执行有限体积无散度约束，并强制执行一个与带有麦克斯韦修正的安培定律和法拉第定律一致的波动方程正则化。使用真空参数 $\\mu_0 = 4\\pi \\times 10^{-7}$ 亨利/米和 $\\epsilon_0 = 8.854187817 \\times 10^{-12}$ 法拉/米；以特斯拉报告任何磁场量，以韦伯报告磁通量；EMF必须以伏特为单位；时间必须以秒为单位；长度必须以米为单位；不使用角度。对内部时间点使用中心差分，对拉普拉斯算子在面心未知量上应用适当的空间有限差分，并按分量应用。\n\n定义以下测试套件，包含三个案例，每个案例都在相同的网格和时间集上运行：\n\n- 所有测试案例共用的网格和时间参数：\n  - 域尺寸：$L_x = 1.0\\,\\mathrm{m}$，$L_y = 1.0\\,\\mathrm{m}$，$L_z = 1.0\\,\\mathrm{m}$。\n  - 网格：$N_x = 2$，$N_y = 2$，$N_z = 2$。\n  - 时间样本：$t_k = k \\Delta t$，对于 $k \\in \\{0,1,2,3,4\\}$，其中 $\\Delta t = 1.0\\times 10^{-9}\\,\\mathrm{s}$。\n- 案例1（无噪声平面波）：一个无源真空平面波磁通量密度由 $\\mathbf{B}(\\mathbf{r},t) = B_0 \\cos(k x - \\omega t)\\, \\hat{\\mathbf{y}}$ 给出，其中 $B_0 = 1.0 \\times 10^{-6}\\,\\mathrm{T}$，$k = 2\\pi\\,\\mathrm{m}^{-1}$，且 $\\omega = c\\,k$。EMF数据通过对每个面的边界矩形回路应用法拉第定律生成：对于位于 $x$-$z$ 平面内、面积为 $A_y = h_x h_z$ 的 $y$ 方向面 $f$，$\\Phi_f(t) = A_y B_y(\\mathbf{r}_f,t)$ 且 $\\mathcal{E}_f(t) = - \\frac{d}{dt}\\Phi_f(t)$；对于其他面，$\\Phi_f(t) = 0$ 且 $\\mathcal{E}_f(t) = 0$。\n- 案例2（静态）：在所有时间和所有面回路上，EMF均为零：对所有 $f$ 和 $t$，$\\mathcal{E}_f(t) = 0$，对应的真实磁通量为 $\\Phi_f(t) = 0$。\n- 案例3（含噪声平面波）：与案例1相同，但EMF数据被附加的零均值高斯噪声污染，其标准差 $\\sigma_{\\mathcal{E}}$ 为案例1中所有面和时间上最大绝对EMF值的 $5.0 \\times 10^{-3}$ 倍。\n\n您的程序必须：\n- 为每个测试案例构建合成EMF数据 $\\mathcal{E}_f(t_k)$。\n- 构建并求解线性最小二乘系统，以恢复所有面和时间上的面通量 $\\Phi_f(t_k)$，使用：\n  - 离散法拉第约束：对于每个面 $f$ 在内部时间索引 $k \\in \\{1,2,3\\}$，强制执行 $\\frac{\\Phi_f(t_{k+1}) - \\Phi_f(t_{k-1})}{2\\Delta t} + \\mathcal{E}_f(t_k) = 0$。\n  - 离散无散度约束：对于每个单元 $c$ 和时间 $k \\in \\{0,1,2,3,4\\}$，穿过单元 $c$ 的六个面的向外通量之和必须为 $0$。\n  - 离散波动方程正则化：对于每个 $y$-面 $f$ 在内部时间索引 $k \\in \\{1,2,3\\}$，惩罚偏离 $\\frac{\\Phi_f(t_{k+1}) - 2\\Phi_f(t_k) + \\Phi_f(t_{k-1})}{\\Delta t^2} - c^2 \\nabla^2 \\Phi_f(t_k) = 0$ 的情况，其中 $y$-面上的离散拉普拉斯算子 $\\nabla^2$ 是通过使用沿 $x$、$y$ 和 $z$ 方向的相邻 $y$-面上的二阶中心差分来定义的，使用适当的网格间距 $h_x$、$h_y$ 和 $h_z$。\n  - 使用物理上合理的正则化权重来稳定反演过程。所有约束都应是关于未知通量的线性关系。\n- 通过 $B_y(\\mathbf{r}_f,t_k) = \\Phi_f(t_k) / A_y$ 恢复 $y$-面上的 $y$-分量磁通量密度。对于 $x$-面和 $z$-面，真实的 $B$-分量为 $0$。\n- 为每个测试案例，计算在所有 $y$-面和时间上，恢复的 $B_y$ 与真实的 $B_y$ 之间的均方根误差（以特斯拉为单位）。\n\n您的程序应生成单行输出，其中包含三个测试案例的三个均方根误差，格式为 $[r_1,r_2,r_3]$ 的逗号分隔列表，其中每个 $r_i$ 是一个以特斯拉为单位的浮点数。不得打印任何其他文本。所有计算必须按上述指定的SI单位进行。不使用角度，且不得出现在输出中。最终程序必须是自包含的，不得从任何外部来源读取输入，也不需要任何用户交互。", "solution": "所提出的问题是一个计算电磁学中的反演问题，它要求从合成的电动势（EMF）数据中恢复时变的磁通量分布。解必须与法拉第感应定律、磁场的无散度条件（$\\nabla \\cdot \\mathbf{B} = 0$）相符，并通过齐次电磁波方程进行正则化。该问题具有科学依据，通过引入正则化而成为一个适定问题，并提供了一个清晰、客观的任务。所有物理定律、常数和离散化方案都是标准的，并且适用于计算电磁学领域。关于离散拉普拉斯算子边界条件的一个小歧义，通过假设周期性边界条件得以解决，这与为生成测试数据而提供的平面波解是一致的。\n\n该解决方案被构建为一个线性最小二乘问题，表示为最小化 $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}\\|_2^2$。未知量向量 $\\mathbf{x}$ 由离散矩形网格的所有面 $f$ 在一组离散时间点 $t_k$ 上的磁通量 $\\Phi_f(t_k)$ 组成。矩阵 $\\mathbf{A}$ 和向量 $\\mathbf{b}$ 是通过组合代表物理约束的方程来构建的。\n\n1.  **离散化与变量**：计算域是一个 $1.0\\,\\mathrm{m} \\times 1.0\\,\\mathrm{m} \\times 1.0\\,\\mathrm{m}$ 的立方体，被离散化为一个 $N_x=2, N_y=2, N_z=2$ 的单元网格。磁通量未知量定义在这些单元的面上。这导致有 $(N_x+1)N_y N_z = 12$ 个x-面， $N_x(N_y+1)N_z = 12$ 个y-面，以及 $N_x N_y (N_z+1) = 12$ 个z-面，总共 $36$ 个面。通量需要在 $5$ 个离散时间点上恢复。因此，标量未知数的总数为 $36 \\times 5 = 180$。这些未知数被排列成一个单独的列向量 $\\mathbf{x}$。\n\n2.  **约束方程**：\n    *   **法拉第定律**：对于 $36$ 个面中的每一个面以及内部时间索引 $k \\in \\{1,2,3\\}$，基于法拉第定律的中心差分近似施加一个约束：$\\frac{\\Phi_f(t_{k+1}) - \\Phi_f(t_{k-1})}{2\\Delta t} = - \\mathcal{E}_f(t_k)$。这产生了 $36 \\times 3 = 108$ 个线性方程。这些方程构成了最小二乘系统的数据拟合主要部分。\n    *   **无散度约束**：对于 $N_x N_y N_z = 8$ 个单元中的每一个以及所有 $5$ 个时间步，强制执行有限体积形式的 $\\nabla \\cdot \\mathbf{B}=0$。这表示流出单元六个面的磁通量之和为零。这提供了 $8 \\times 5 = 40$ 个齐次线性方程。\n    *   **波动方程正则化**：为确保解在物理上平滑且稳定，将齐次波动方程 $\\nabla^2 \\mathbf{B} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{B}}{\\partial t^2} = \\mathbf{0}$ 作为正则化约束。该方程针对 $12$ 个 y-面在内部时间 $k \\in \\{1,2,3\\}$ 的通量进行离散化，提供了 $12 \\times 3 = 36$ 个额外的齐次方程。时间二阶导数使用中心差分进行近似。空间拉普拉斯算子 $\\nabla^2$ 也使用二阶中心差分进行离散化。为处理靠近域边界的面，假设采用周期性边界条件，这与平面波测试案例的性质一致。\n\n3.  **系统构建与缩放**：总的约束集包含 $108 + 40 + 36 = 184$ 个线性方程，对应 $180$ 个未知数，构成一个超定系统。为了平衡不同物理原理的影响，对方程进行加权。散度方程乘以一个因子 $w_{div} = 1/(2\\Delta t)$，以匹配法拉第定律方程的系数数量级。作为正则化的波动方程约束乘以 $w_{wave} = \\Delta t/2$，以确保其系数也具有可比的数量级。这种“物理上合理”的权重选择导致了一个良态的最小二乘问题。\n\n4.  **求解器与评估**：构建完整的系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{A}$ 包含来自所有加权约束的通量未知数的系数，$\\mathbf{b}$ 包含（取反的）EMF数据和齐次约束的零。使用标准的线性最小二乘求解器（`numpy.linalg.lstsq`）求解 $\\mathbf{x}$。对于每个测试案例，将恢复的y-面通量转换为磁场强度 $B_y = \\Phi_y / A_y$，并与已知的真实值进行比较。通过计算所有y-面和所有时间步上的均方根误差（RMSE）来量化重建的准确性。对三个指定的测试案例重复此过程：无噪声平面波、静态零场案例和有噪声平面波。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the root-mean-square error for an inverse electromagnetic problem.\n    \"\"\"\n    \n    # Grid and time parameters\n    Lx, Ly, Lz = 1.0, 1.0, 1.0\n    Nx, Ny, Nz = 2, 2, 2\n    hx, hy, hz = Lx / Nx, Ly / Ny, Lz / Nz\n    dt = 1.0e-9\n    times = np.arange(5, dtype=float) * dt\n    Nt = len(times)\n\n    # Physical constants\n    mu0 = 4 * np.pi * 1e-7\n    eps0 = 8.854187817e-12\n    c = 1 / np.sqrt(mu0 * eps0)\n\n    # Enumerate all faces and create mappings for easy lookup.\n    # A face is identified by its type ('x', 'y', 'z') and grid indices (i, j, k).\n    faces = []\n    face_map = {}\n    face_id_counter = 0\n\n    # X-faces: (Nx+1) x Ny x Nz\n    for i in range(Nx + 1):\n        for j in range(Ny):\n            for k in range(Nz):\n                center = np.array([i * hx, (j + 0.5) * hy, (k + 0.5) * hz])\n                f_props = {'id': face_id_counter, 'type': 'x', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hy * hz}\n                faces.append(f_props)\n                face_map[('x', i, j, k)] = f_props\n                face_id_counter += 1\n    \n    # Y-faces: Nx x (Ny+1) x Nz\n    y_face_ids = []\n    for i in range(Nx):\n        for j in range(Ny + 1):\n            for k in range(Nz):\n                center = np.array([(i + 0.5) * hx, j * hy, (k + 0.5) * hz])\n                f_props = {'id': face_id_counter, 'type': 'y', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hx * hz}\n                faces.append(f_props)\n                face_map[('y', i, j, k)] = f_props\n                y_face_ids.append(face_id_counter)\n                face_id_counter += 1\n    num_y_faces = len(y_face_ids)\n\n    # Z-faces: Nx x Ny x (Nz+1)\n    for i in range(Nx):\n        for j in range(Ny):\n            for k in range(Nz + 1):\n                center = np.array([(i + 0.5) * hx, (j + 0.5) * hy, k * hz])\n                f_props = {'id': face_id_counter, 'type': 'z', 'i': i, 'j': j, 'k': k, 'center': center, 'area': hx * hy}\n                faces.append(f_props)\n                face_map[('z', i, j, k)] = f_props\n                face_id_counter += 1\n    \n    num_faces = len(faces)\n    num_unknowns = num_faces * Nt\n\n    # Construct the least-squares matrix A\n    num_faraday_eqs = num_faces * (Nt - 2)\n    num_div_eqs = Nx * Ny * Nz * Nt\n    num_wave_eqs = num_y_faces * (Nt - 2)\n    num_eqs = num_faraday_eqs + num_div_eqs + num_wave_eqs\n    \n    A = np.zeros((num_eqs, num_unknowns))\n    \n    # Regularization weights chosen to balance coefficient magnitudes\n    w_div = 1.0 / (2 * dt)\n    w_wave = dt / 2.0\n\n    def get_flux_idx(face_id, time_idx):\n        return face_id * Nt + time_idx\n\n    row_idx = 0\n\n    # 1. Faraday's Law constraints\n    for f in faces:\n        for k_t in range(1, Nt - 1):\n            A[row_idx, get_flux_idx(f['id'], k_t + 1)] = 1.0 / (2 * dt)\n            A[row_idx, get_flux_idx(f['id'], k_t - 1)] = -1.0 / (2 * dt)\n            row_idx += 1\n\n    # 2. Divergence-free constraints\n    for ic in range(Nx):\n        for jc in range(Ny):\n            for kc in range(Nz):\n                face_ids = [\n                    face_map[('x', ic + 1, jc, kc)]['id'], face_map[('x', ic, jc, kc)]['id'],\n                    face_map[('y', ic, jc + 1, kc)]['id'], face_map[('y', ic, jc, kc)]['id'],\n                    face_map[('z', ic, jc, kc + 1)]['id'], face_map[('z', ic, jc, kc)]['id']\n                ]\n                signs = [1, -1, 1, -1, 1, -1]\n                for k_t in range(Nt):\n                    for i_f, f_id in enumerate(face_ids):\n                        A[row_idx, get_flux_idx(f_id, k_t)] = signs[i_f] * w_div\n                    row_idx += 1\n\n    # 3. Wave equation regularization for y-faces\n    for f_id in y_face_ids:\n        f = faces[f_id]\n        i, j, k = f['i'], f['j'], f['k']\n        for k_t in range(1, Nt - 1):\n            # Time derivative part\n            A[row_idx, get_flux_idx(f_id, k_t + 1)] = w_wave / (dt**2)\n            A[row_idx, get_flux_idx(f_id, k_t)]     -= 2 * w_wave / (dt**2)\n            A[row_idx, get_flux_idx(f_id, k_t - 1)] = w_wave / (dt**2)\n\n            # Spatial derivative (Laplacian) part, assuming periodic BCs\n            laplacian_term = 0.0\n            # x-neighbors\n            f_xp = face_map[('y', (i + 1) % Nx, j, k)]['id']\n            f_xn = face_map[('y', (i - 1 + Nx) % Nx, j, k)]['id']\n            A[row_idx, get_flux_idx(f_xp, k_t)] -= w_wave * c**2 / hx**2\n            laplacian_term += 2.0 / hx**2\n            A[row_idx, get_flux_idx(f_xn, k_t)] -= w_wave * c**2 / hx**2\n            # y-neighbors\n            f_yp = face_map[('y', i, (j + 1) % (Ny + 1), k)]['id']\n            f_yn = face_map[('y', i, (j - 1 + Ny + 1) % (Ny + 1), k)]['id']\n            A[row_idx, get_flux_idx(f_yp, k_t)] -= w_wave * c**2 / hy**2\n            laplacian_term += 2.0 / hy**2\n            A[row_idx, get_flux_idx(f_yn, k_t)] -= w_wave * c**2 / hy**2\n            # z-neighbors\n            f_zp = face_map[('y', i, j, (k + 1) % Nz)]['id']\n            f_zn = face_map[('y', i, j, (k - 1 + Nz) % Nz)]['id']\n            A[row_idx, get_flux_idx(f_zp, k_t)] -= w_wave * c**2 / hz**2\n            laplacian_term += 2.0 / hz**2\n            A[row_idx, get_flux_idx(f_zn, k_t)] -= w_wave * c**2 / hz**2\n            \n            A[row_idx, get_flux_idx(f_id, k_t)] += w_wave * c**2 * laplacian_term\n            row_idx += 1\n\n    # --- Test Cases ---\n    results = []\n    \n    # Test Case Parameters\n    B0 = 1.0e-6\n    k_wave = 2 * np.pi / Lx\n    omega = c * k_wave\n    \n    def true_B_y(x, t): return B0 * np.cos(k_wave * x - omega * t)\n    def true_EMF_y(x, t, area): return area * B0 * omega * np.sin(k_wave * x - omega * t)\n\n    # --- Generate data for all cases ---\n    # Case 1: Noise-free plane wave\n    emf_case1 = np.zeros(num_faraday_eqs)\n    true_fluxes_case1 = np.zeros(num_unknowns)\n    true_B_y_vals = np.zeros(num_y_faces * Nt)\n    b_y_idx = 0\n    faraday_row_counter = 0\n    for f in faces:\n        for k_t in range(Nt):\n            if f['type'] == 'y':\n                val = true_B_y(f['center'][0], times[k_t])\n                true_fluxes_case1[get_flux_idx(f['id'], k_t)] = f['area'] * val\n                true_B_y_vals[b_y_idx] = val\n                b_y_idx += 1\n        for k_t in range(1, Nt - 1):\n             if f['type'] == 'y':\n                 emf_case1[faraday_row_counter] = -true_EMF_y(f['center'][0], times[k_t], f['area'])\n             faraday_row_counter += 1\n\n    # Case 2: Static (zero field)\n    emf_case2 = np.zeros(num_faraday_eqs)\n    true_fluxes_case2 = np.zeros(num_unknowns)\n    true_B_y_vals_case2 = np.zeros_like(true_B_y_vals)\n\n    # Case 3: Noisy plane wave\n    max_emf_abs = np.max(np.abs(emf_case1)) if emf_case1.size > 0 else 0\n    sigma_emf = 5.0e-3 * max_emf_abs\n    rng = np.random.default_rng(seed=42) # for reproducibility\n    noise = rng.normal(0, sigma_emf, num_faraday_eqs)\n    emf_case3 = emf_case1 + noise\n\n    test_cases_data = [\n        (\"Case 1\", emf_case1, true_B_y_vals),\n        (\"Case 2\", emf_case2, true_B_y_vals_case2),\n        (\"Case 3\", emf_case3, true_B_y_vals)\n    ]\n\n    for name, emf_data, true_B_vals in test_cases_data:\n        # Construct the b vector for the least-squares system\n        b = np.zeros(num_eqs)\n        b[:num_faraday_eqs] = emf_data\n        \n        # Solve the system\n        recovered_fluxes, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n        \n        # Extract recovered B_y and calculate RMSE\n        recovered_B_y_vals = np.zeros(num_y_faces * Nt)\n        b_y_idx = 0\n        for f_id in y_face_ids:\n            area = faces[f_id]['area']\n            for k_t in range(Nt):\n                recovered_B_y_vals[b_y_idx] = recovered_fluxes[get_flux_idx(f_id, k_t)] / area\n                b_y_idx += 1\n        \n        rmse = np.sqrt(np.mean((recovered_B_y_vals - true_B_vals)**2))\n        results.append(rmse)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3306628"}]}