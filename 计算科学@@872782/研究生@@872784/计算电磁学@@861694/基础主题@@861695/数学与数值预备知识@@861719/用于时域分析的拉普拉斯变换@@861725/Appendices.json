{"hands_on_practices": [{"introduction": "要精通拉普拉斯变换，理解其收敛域（Region of Convergence, ROC）的概念至关重要，因为它直接关联到信号的物理特性。本练习将通过一个基本但极其重要的因果信号——指数函数，引导你从第一性原理出发，推导其拉普拉斯变换及相应的收敛域。通过这个过程，你将深刻体会到收敛域如何从数学上编码信号的因果性和增长行为，这对于在任何电磁问题中正确应用并反演拉普拉斯变换是必不可少的。[@problem_id:3322516]", "problem": "在一个均匀、源驱动的计算电磁学仿真中，一个外加电流密度在 $t \\geq 0$ 时由因果波形 $f(t) = \\exp(\\alpha t) u(t)$ 建模，其中 $u(t)$ 是亥维赛单位阶跃函数，且 $\\alpha \\in \\mathbb{R}$。为了使用复频（拉普拉斯）域分析瞬态电磁响应并随后恢复时域场，引入了 $f(t)$ 的双边拉普拉斯变换 $F(s)$，其定义为对所有时间乘以权重 $\\exp(- s t)$ 的积分，其中复数 $s = \\sigma + j \\omega$。请仅从此定义和拉普拉斯积分绝对收敛的要求出发，推导 $F(s)$ 的一个闭式表达式，并通过确定收敛横坐标 $\\sigma_{0}$ 来严格确定复 $s$ 平面中相关的收敛域，使得收敛域为 $\\{\\; s \\in \\mathbb{C} : \\Re\\{s\\} > \\sigma_{0} \\;\\}$。然后，从有界增长和因果性的角度，对时域电磁源和场的这个收敛域进行物理解释，明确说明指数权重 $\\exp(-\\sigma t)$ 如何保证右边信号的可积性，以及Bromwich线的位置如何与反演中的因果性相关联。\n\n将您的最终结果表示为一个包含变换 $F(s)$ 和收敛横坐标 $\\sigma_{0}$ 的行向量。不需要数值近似；请给出精确的解析表达式。不需要单位。物理解释应只出现在您的解题过程中，而不应出现在最终答案中。", "solution": "我们从函数 $f(t)$ 的双边拉普拉斯变换的定义开始：\n$$\nF(s) \\equiv \\int_{-\\infty}^{\\infty} f(t)\\,\\exp(- s t)\\,\\mathrm{d}t,\n$$\n其中 $s = \\sigma + j \\omega \\in \\mathbb{C}$，且 $\\sigma = \\Re\\{s\\}$，$\\omega = \\Im\\{s\\}$。该积分是在绝对收敛的意义上定义的。给定的时域函数是 $f(t) = \\exp(\\alpha t) u(t)$，其中当 $t  0$ 时 $u(t) = 0$，当 $t \\geq 0$ 时 $u(t) = 1$。由于当 $t  0$ 时 $f(t) = 0$，双边积分简化为单边积分：\n$$\nF(s) = \\int_{0}^{\\infty} \\exp(\\alpha t)\\,\\exp(- s t)\\,\\mathrm{d}t = \\int_{0}^{\\infty} \\exp\\bigl(- (s - \\alpha) t\\bigr)\\,\\mathrm{d}t.\n$$\n令 $s - \\alpha = (\\sigma - \\alpha) + j \\omega$。该积分绝对收敛的充分必要条件是指数的实部为严格负值，即 $\\Re\\{-(s - \\alpha)\\} = -(\\sigma - \\alpha)  0$，这等价于 $\\sigma > \\alpha$。在此条件下，我们可以将该积分作为衰减指数的积分进行求值：\n$$\nF(s) = \\int_{0}^{\\infty} \\exp\\bigl(- (s - \\alpha) t\\bigr)\\,\\mathrm{d}t = \\left[ \\frac{-1}{s - \\alpha}\\,\\exp\\bigl(- (s - \\alpha) t\\bigr) \\right]_{t=0}^{t=\\infty}.\n$$\n对于 $\\sigma > \\alpha$，我们有 $\\lim_{t \\to \\infty} \\exp\\bigl(- (s - \\alpha) t\\bigr) = 0$，且 $\\exp\\bigl(- (s - \\alpha)\\cdot 0\\bigr) = 1$。因此，\n$$\nF(s) = \\frac{1}{s - \\alpha},\n$$\n该表达式在区域 $\\Re\\{s\\} > \\alpha$ 上有效。用收敛域的语言来说，这是一个位于垂线 $\\sigma = \\alpha$ 右侧的右半平面。因此，收敛横坐标是 $\\sigma_{0} = \\alpha$，收敛域是 $\\{ s \\in \\mathbb{C} : \\Re\\{s\\} > \\sigma_{0} \\}$。\n\n现在我们给出在计算电磁学背景下的物理解释。时间依赖函数 $f(t) = \\exp(\\alpha t) u(t)$ 是右支信号且是因果的，因为 $u(t)$ 强制当 $t  0$ 时 $f(t) = 0$。拉普拉斯变换为 $\\sigma = \\Re\\{s\\}$ 引入了一个指数权重 $\\exp(- \\sigma t)$。为了使变换积分收敛，加权信号 $\\exp(\\alpha t) \\exp(- \\sigma t) = \\exp\\bigl(-(\\sigma - \\alpha) t\\bigr)$ 必须在 $[0,\\infty)$ 上绝对可积。这恰好在 $\\sigma > \\alpha$ 时得到保证，这为源的允许增长率设定了一个界限：拉普拉斯域的衰减项 $\\exp(- \\sigma t)$ 必须强于时域中的任何增长项 $\\exp(\\alpha t)$。如果 $\\alpha  0$，源是内在地衰减的，收敛域包含虚轴 $\\sigma = 0$，这反映了有界能量和稳定性；如果 $\\alpha > 0$，即一个正的增长率，收敛域向右移动，需要更大的 $\\sigma$ 来补偿增长。\n\n$F(s)$ 在 $\\Re\\{s\\} > \\alpha$ 上的解析性以及在 $s = \\alpha$ 处的一阶极点对反演和因果性有直接影响。在布龙维奇（Bromwich）反演积分中，人们选择一条竖直积分路径 $\\Re\\{s\\} = \\sigma_{b}$，其中 $\\sigma_{b} > \\alpha$，即位于所有奇点的右侧。对于右支（因果）信号，收敛域是一个右半平面，这与选择位于极点右侧的布龙维奇积分路径是一致的。这个选择通过确保当 $t  0$ 时积分衰减且当 $t \\geq 0$ 时收敛，从而保证了反变换的因果性。因此，收敛域既编码了拉普拉斯加权下的有界增长要求，也编码了在计算电磁学中进行稳定时域重构所需的因果性结构。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{s-\\alpha}  \\alpha\\end{pmatrix}}$$", "id": "3322516"}, {"introduction": "拉普拉斯变换的理论属性在现代计算电磁学中具有直接的实践指导意义，尤其是在数值方法的稳定性分析中。这项编程练习将带你深入探索这一点，通过对比求解瞬态散射问题的两种主流数值方法：先进的卷积求积（Convolution Quadrature, CQ）方法和传统的显式时间步进法。你将亲手编写代码来计算这两种方法的稳定性边界，并发现 CQ 方法的稳定性如何巧妙地由拉普拉斯域算子的奇点位置决定，从而将抽象的复分析理论与尖端数值算法的稳定性紧密联系起来。[@problem_id:3322538]", "problem": "考虑一个由时域边界积分方程表述的、从理想电导体 (perfectly electrically conducting) 障碍物产生的瞬态电磁散射问题。令 $K(s)$ 表示通过对时间 $t \\mapsto s$ 进行单边拉普拉斯变换作用于边界迹 (boundary traces) 而得到的拉普拉斯域边界积分算子。假设这是一个因果、无源的外部问题，因此 $K(s)$ 在右半平面 $\\{s \\in \\mathbb{C} : \\mathrm{Re}(s) > 0\\}$ 内是解析的，并且其奇点（极点或支点）严格位于开放左半平面内。我们关注一个标量代理模型，其中 $K(s)$ 由有限奇点集 $\\mathcal{S} = \\{s_k\\}_{k=1}^m \\subset \\{s \\in \\mathbb{C} : \\mathrm{Re}(s)  0\\}$ 刻画，其中 $s_k$ 的单位为 $\\mathrm{s}^{-1}$。你需要比较两种用于在时间上推进解的离散化方法的稳定性：\n\n1. 基于线性多步法的卷积求积（Lubich 卷积求积）。对于时间步长 $\\Delta t  0$、稳定性参数 $\\rho \\ge 1$ 以及一个生成函数为 $\\delta(z)$ 的线性多步法，该方法在拉普拉斯点 $s = \\delta(z)/\\Delta t$（其中 $|z| = \\rho$）处对 $K$ 进行采样。一个与 $K(s)$ 奇点位置相关的必要稳定性条件是，像集 $\\Sigma_{\\Delta t,\\rho} = \\{\\delta(z)/\\Delta t : |z| = \\rho\\}$ 必须位于 $K$ 的一个解析域内。这可以通过数值方法检验，确保 $\\Sigma_{\\Delta t,\\rho}$ 到 $\\mathcal{S}$ 的最小距离严格为正：\n$$\nM_{\\mathrm{CQ}}(\\Delta t,\\rho,\\delta,\\mathcal{S}) \\equiv \\min_{|z|=\\rho} \\min_{s^\\star \\in \\mathcal{S}} \\left| \\frac{\\delta(z)}{\\Delta t} - s^\\star \\right| \\quad \\text{in } \\mathrm{s}^{-1}.\n$$\n如果 $M_{\\mathrm{CQ}}  0$，则该方法是稳定的，在 $s$-平面上的稳定裕度至少为 $M_{\\mathrm{CQ}}$。使用后向欧拉法和二阶后向差分格式这两种著名方法的生成函数，并回顾两者都是 A-稳定的。\n\n2. 一种用于时域边界积分方程的直接显式时间推进格式（此处视为波速为 $c$、特征网格尺寸为 $h$ 的双曲更新）。Courant–Friedrichs–Lewy (CFL) 界限给出了一个必要的稳定性条件：\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{CFL}} \\equiv C_{\\mathrm{CFL}} \\frac{h}{c},\n$$\n其中 $C_{\\mathrm{CFL}} \\in (0,1)$ 为已知。将此格式的稳定裕度定义为\n$$\nM_{\\mathrm{DIR}}(\\Delta t,h,c,C_{\\mathrm{CFL}}) \\equiv \\Delta t_{\\mathrm{CFL}} - \\Delta t \\quad \\text{in } \\mathrm{s}.\n$$\n如果 $M_{\\mathrm{DIR}} \\ge 0$，则显式格式满足 CFL 约束条件；如果 $M_{\\mathrm{DIR}}  0$，则具有严格的稳定裕度。\n\n任务：\n- 仅从这些基本原则出发，实现一个程序，为下述每个测试用例计算：\n  - 卷积求积稳定裕度 $M_{\\mathrm{CQ}}$（单位为 $\\mathrm{s}^{-1}$），通过使用足够分辨率的角度 $\\theta \\in [0,2\\pi)$ 均匀采样来数值近似 $|z|=\\rho$ 上的最小值，并且当 $\\rho  1$ 时，还需检查点 $z=1$ 以考虑圆盘内部。\n  - 如上定义的直接时间推进稳定裕度 $M_{\\mathrm{DIR}}$（单位为 $\\mathrm{s}$）。\n- 使用以下线性多步法：\n  - 具有生成函数 $\\delta_{\\mathrm{BE}}(z)$ 的后向欧拉法。\n  - 具有生成函数 $\\delta_{\\mathrm{BDF2}}(z)$ 的二阶后向差分格式。\n- 所有复数运算必须将 $s^\\star \\in \\mathcal{S}$ 视为单位为 $\\mathrm{s}^{-1}$ 的复数。\n\n物理单位和输出要求：\n- 时间单位使用秒（$\\mathrm{s}$），拉普拉斯域频率单位使用反秒（$\\mathrm{s}^{-1}$）。\n- 角度必须以弧度处理。\n- 你的程序必须输出单行，包含一个实数平铺列表：按顺序为每个测试用例首先输出 $M_{\\mathrm{CQ}}$（单位 $\\mathrm{s}^{-1}$），然后输出 $M_{\\mathrm{DIR}}$（单位 $\\mathrm{s}$）。最终输出应严格为 \"[r1,r2,r3,r4,...]\" 形式的一行，不含任何额外字符。\n\n测试套件：\n- 用例 A (理想情况，两者均稳定):\n  - 方法：后向欧拉法。\n  - $\\Delta t = 1.0 \\times 10^{-11}\\ \\mathrm{s}$。\n  - $\\rho = 1.0$。\n  - 奇点 $\\mathcal{S} = \\{-1.0 \\times 10^{7},\\ -2.0 \\times 10^{7} + i\\,5.0 \\times 10^{7},\\ -2.0 \\times 10^{7} - i\\,5.0 \\times 10^{7}\\}\\ \\mathrm{s}^{-1}$。\n  - 直接法参数: $h = 1.0 \\times 10^{-2}\\ \\mathrm{m}$, $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$, $C_{\\mathrm{CFL}} = 0.5$。\n- 用例 B (CQ 稳定，直接法因违反 CFL 而不稳定):\n  - 方法：BDF2。\n  - $\\Delta t = 5.0 \\times 10^{-11}\\ \\mathrm{s}$。\n  - $\\rho = 1.0$。\n  - 奇点 $\\mathcal{S}$ 与用例 A 相同。\n  - 直接法参数: $h = 1.0 \\times 10^{-2}\\ \\mathrm{m}$, $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$, $C_{\\mathrm{CFL}} = 0.5$。\n- 用例 C (CQ 对小的左半平面极点稳定，直接法不稳定):\n  - 方法：后向欧拉法。\n  - $\\Delta t = 2.0 \\times 10^{-11}\\ \\mathrm{s}$。\n  - $\\rho = 1.2$。\n  - 奇点 $\\mathcal{S} = \\{-1.0 \\times 10^{5}\\}\\ \\mathrm{s}^{-1}$。\n  - 直接法参数: $h = 2.0 \\times 10^{-3}\\ \\mathrm{m}$, $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$, $C_{\\mathrm{CFL}} = 0.4$。\n- 用例 D (CQ 稳定，直接法处于 CFL 边界):\n  - 方法：BDF2。\n  - $\\Delta t = 2.0 \\times 10^{-11}\\ \\mathrm{s}$。\n  - $\\rho = 1.0$。\n  - 奇点 $\\mathcal{S} = \\{-3.0 \\times 10^{6} + i\\,4.0 \\times 10^{6},\\ -3.0 \\times 10^{6} - i\\,4.0 \\times 10^{6}\\}\\ \\mathrm{s}^{-1}$。\n  - 直接法参数: $h = 1.5 \\times 10^{-2}\\ \\mathrm{m}$, $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$, $C_{\\mathrm{CFL}} = 0.4$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3,...]\"）。对于每个用例，按此顺序输出两个浮点数：$[M_{\\mathrm{CQ}}, M_{\\mathrm{DIR}}]$。完整的输出必须是按照用例 A、B、C、D 顺序排列的平铺列表。使用足够高的角度采样分辨率，以可靠地近似 $|z|=\\rho$ 上的最小值。", "solution": "该问题要求为用于求解计算电磁学中时域边界积分方程的两种不同数值格式计算稳定裕度。第一种格式是卷积求积 (CQ) 方法，第二种是直接显式时间推进格式。我们必须验证该问题，如果有效，则提供一个计算解。\n\n### 问题验证\n**1. 提取已知条件：**\n- **模型：** 一个电磁问题的标量模型，其中拉普拉斯域算子 $K(s)$ 具有一组已知的奇点 $\\mathcal{S} = \\{s_k\\}_{k=1}^m \\subset \\{s \\in \\mathbb{C} : \\mathrm{Re}(s)  0\\}$。\n- **方法 1：卷积求积 (CQ)**\n    - 稳定性通过裕度 $M_{\\mathrm{CQ}}(\\Delta t,\\rho,\\delta,\\mathcal{S}) \\equiv \\min_{|z|=\\rho} \\min_{s^\\star \\in \\mathcal{S}} \\left| \\frac{\\delta(z)}{\\Delta t} - s^\\star \\right|$ 来评估，其中 $\\delta(z)$ 是线性多步法的生成函数，$\\Delta t$ 是时间步长，$\\rho \\ge 1$ 是稳定性参数。\n    - 对于 $\\rho > 1$ 的情况，需要在 $z=1$ 处进行额外检查。\n    - 将使用后向欧拉法 ($\\delta_{\\mathrm{BE}}(z)$) 和二阶后向差分格式 ($\\delta_{\\mathrm{BDF2}}(z)$) 的生成函数。\n- **方法 2：直接时间推进**\n    - 稳定性由 Courant–Friedrichs–Lewy (CFL) 条件 $\\Delta t \\le \\Delta t_{\\mathrm{CFL}} \\equiv C_{\\mathrm{CFL}} \\frac{h}{c}$ 决定。\n    - 稳定裕度定义为 $M_{\\mathrm{DIR}}(\\Delta t,h,c,C_{\\mathrm{CFL}}) \\equiv \\Delta t_{\\mathrm{CFL}} - \\Delta t$。\n- **测试用例：** 提供了四个具体的测试用例（A、B、C、D），包含了所有必要的参数（$\\Delta t, \\rho, \\mathcal{S}, h, c, C_{\\mathrm{CFL}}$）。\n- **输出：** 一个平铺的数值列表 $[M_{\\mathrm{CQ}, A}, M_{\\mathrm{DIR}, A}, M_{\\mathrm{CQ}, B}, M_{\\mathrm{DIR}, B}, \\dots]$。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地植根于偏微分方程数值分析的既定理论，特别是时域积分方程。诸如卷积求积、线性多步法（BE、BDF2）、A-稳定性以及 CFL 条件等概念都是该领域的标准内容。电磁散射的物理背景是恰当的，奇点位于左半平面的假设对应于一个稳定、无源的物理系统。所有方面在科学上都是合理的。\n- **良定性：** 两种稳定裕度 $M_{\\mathrm{CQ}}$ 和 $M_{\\mathrm{DIR}}$ 的问题定义在数学上是精确的。任务要求为给定的输入计算这些已定义的量。要求使用角度采样数值近似 $M_{\\mathrm{CQ}}$ 的最小值是处理此类问题的标准程序，从而形成一个明确的计算任务。\n- **完整性和一致性：** 虽然没有给出 $\\delta_{\\mathrm{BE}}(z)$ 和 $\\delta_{\\mathrm{BDF2}}(z)$ 的显式公式，但它们是“众所周知的”，其标准定义在此上下文中是明确的。每个测试用例的所有其他参数都已提供。该问题是自洽且内部一致的。\n- **可行性：** 参数值在物理上和数值上都是现实的，旨在说明不同的稳定性状况（稳定、不稳定、临界稳定）。计算是直接的，不会带来任何不可行的挑战。\n\n**3. 结论：**\n问题被判定为**有效**。它良定、有科学依据，并包含进行求解所需的所有必要信息。\n\n### 求解推导\n求解需要实现 $M_{\\mathrm{CQ}}$ 和 $M_{\\mathrm{DIR}}$ 的公式。\n\n**线性多步法的生成函数：**\n对于应用于常微分方程 $y'(t) = f(t,y)$ 的线性多步法，其卷积求积的生成函数 $\\delta(z)$ 由其特征多项式导出。所要求方法的标准形式为：\n1.  **后向欧拉法 (BE):** $y_{n+1} - y_n = \\Delta t f_{n+1}$。生成函数为 $\\delta_{\\mathrm{BE}}(z) = 1 - z^{-1}$。\n2.  **二阶后向差分格式 (BDF2):** $\\frac{3}{2}y_{n+1} - 2y_n + \\frac{1}{2}y_{n-1} = \\Delta t f_{n+1}$。生成函数为 $\\delta_{\\mathrm{BDF2}}(z) = \\frac{3}{2} - 2z^{-1} + \\frac{1}{2}z^{-2}$。\n这两种方法都是 A-稳定的，意味着单位圆盘外部 $|z|>1$ 在 $\\delta(z)$ 映射下的像包含在右半平面 $\\mathrm{Re}(s)>0$ 内。对于任何相容的方法，$\\delta(1)=0$。\n\n**$M_{\\mathrm{DIR}}$ 的计算：**\n这可根据定义直接计算：\n$$\nM_{\\mathrm{DIR}} = \\Delta t_{\\mathrm{CFL}} - \\Delta t = C_{\\mathrm{CFL}}\\frac{h}{c} - \\Delta t\n$$\n其中 $c$ 是光速，$h$ 是特征网格尺寸，$C_{\\mathrm{CFL}}$ 是 CFL 数。\n\n**$M_{\\mathrm{CQ}}$ 的计算：**\n稳定裕度 $M_{\\mathrm{CQ}}$ 是算子采样点集 $\\Sigma_{\\Delta t,\\rho} = \\{\\delta(z)/\\Delta t : |z|=\\rho\\}$ 与奇点集 $\\mathcal{S} = \\{s_k\\}$ 之间的最小距离。\n$$\nM_{\\mathrm{CQ}} = \\min_{|z|=\\rho} \\min_{s^\\star \\in \\mathcal{S}} \\left| \\frac{\\delta(z)}{\\Delta t} - s^\\star \\right|\n$$\n为了进行数值计算，我们通过对均匀间隔的角度 $\\theta_j = 2\\pi j/N$, $j=0, \\dots, N-1$ 采样 $N$ 个点 $z_j = \\rho e^{i\\theta_j}$ 来离散化圆 $|z|=\\rho$。\n然后，裕度可近似为：\n$$\nM_{\\mathrm{CQ}} \\approx \\min_{j \\in \\{0, \\dots, N-1\\}} \\min_{s^\\star \\in \\mathcal{S}} \\left| \\frac{\\delta(z_j)}{\\Delta t} - s^\\star \\right|\n$$\n对于 $\\rho > 1$ 的情况，问题说明我们还必须检查点 $z=1$，以考虑圆盘 $|z|\\rho$ 内部的映射。对应于 $z=1$ 的拉普拉斯域样本是 $s = \\delta(1)/\\Delta t = 0$。此点到奇点的距离是 $\\min_{s^\\star \\in \\mathcal{S}} |0 - s^\\star| = \\min_{s^\\star \\in \\mathcal{S}} |s^\\star|$。当 $\\rho > 1$ 时，最终的裕度是在圆上计算的值与在 $z=1$ 处的值之间的最小值。\n\n整体算法包括：\n1. 定义生成函数 $\\delta_{\\mathrm{BE}}(z)$ 和 $\\delta_{\\mathrm{BDF2}}(z)$。\n2. 对于每个测试用例：\n    a. 选择适当的生成函数 $\\delta(z)$。\n    b. 使用其定义公式计算 $M_{\\mathrm{DIR}}$。\n    c. 通过在圆 $|z|=\\rho$ 上进行精细采样来数值计算最小距离，以计算 $M_{\\mathrm{CQ}}$，必要时应用 $\\rho > 1$ 的特殊规则。\n3. 将所有结果收集到一个平铺列表中，并按要求格式化输出。\n将使用足够多的采样点，例如 $N=10000$，进行角度离散化，以确保最小值的准确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef delta_be(z: complex) - complex:\n    \"\"\"\n    Generating function for the Backward Euler method.\n    delta(z) = 1 - 1/z\n    \"\"\"\n    return 1.0 - 1.0 / z\n\ndef delta_bdf2(z: complex) - complex:\n    \"\"\"\n    Generating function for the 2nd-order Backward Differentiation Formula.\n    delta(z) = 3/2 - 2/z + 1/(2*z^2)\n    \"\"\"\n    return 1.5 - 2.0 / z + 0.5 / (z**2)\n\ndef calculate_mcq(delta_func, dt: float, rho: float, s_poles_list: list, num_samples: int = 10000) - float:\n    \"\"\"\n    Computes the convolution quadrature stability margin M_CQ.\n    M_CQ = min_{|z|=rho} min_{s* in S} |delta(z)/dt - s*|\n    \"\"\"\n    s_poles = np.array(s_poles_list, dtype=np.complex128)\n\n    # Sample points on the circle |z| = rho\n    theta = np.linspace(0, 2 * np.pi, num_samples, endpoint=False)\n    z_points = rho * np.exp(1j * theta)\n\n    min_dist_on_circle = np.inf\n\n    for z in z_points:\n        s_val = delta_func(z) / dt\n        # Find the minimum distance from this s_val to any pole in S\n        dist_to_poles = np.min(np.abs(s_val - s_poles))\n        if dist_to_poles  min_dist_on_circle:\n            min_dist_on_circle = dist_to_poles\n\n    # According to the problem statement, for rho  1, we must also check z=1\n    if rho  1.0:\n        # At z=1, delta(1)=0, so the Laplace sample is s=0.\n        # The distance is min |0 - s*| = min |s*|.\n        min_dist_at_z1 = np.min(np.abs(s_poles))\n        return min(min_dist_on_circle, min_dist_at_z1)\n    else:\n        return min_dist_on_circle\n\ndef calculate_mdir(dt: float, h: float, c: float, c_cfl: float) - float:\n    \"\"\"\n    Computes the direct time-marching stability margin M_DIR.\n    M_DIR = dt_CFL - dt\n    \"\"\"\n    dt_cfl = c_cfl * h / c\n    return dt_cfl - dt\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'method': 'BE', 'dt': 1.0e-11, 'rho': 1.0, \n         'S': [-1.0e7, -2.0e7 + 5.0e7j, -2.0e7 - 5.0e7j],\n         'h': 1.0e-2, 'c': 3.0e8, 'c_cfl': 0.5},\n        # Case B\n        {'method': 'BDF2', 'dt': 5.0e-11, 'rho': 1.0, \n         'S': [-1.0e7, -2.0e7 + 5.0e7j, -2.0e7 - 5.0e7j],\n         'h': 1.0e-2, 'c': 3.0e8, 'c_cfl': 0.5},\n        # Case C\n        {'method': 'BE', 'dt': 2.0e-11, 'rho': 1.2, \n         'S': [-1.0e5],\n         'h': 2.0e-3, 'c': 3.0e8, 'c_cfl': 0.4},\n        # Case D\n        {'method': 'BDF2', 'dt': 2.0e-11, 'rho': 1.0, \n         'S': [-3.0e6 + 4.0e6j, -3.0e6 - 4.0e6j],\n         'h': 1.5e-2, 'c': 3.0e8, 'c_cfl': 0.4},\n    ]\n\n    results = []\n    delta_map = {\n        'BE': delta_be,\n        'BDF2': delta_bdf2\n    }\n\n    for case in test_cases:\n        delta_function = delta_map[case['method']]\n        \n        # Calculate M_CQ\n        mcq = calculate_mcq(delta_function, case['dt'], case['rho'], case['S'])\n        \n        # Calculate M_DIR\n        mdir = calculate_mdir(case['dt'], case['h'], case['c'], case['c_cfl'])\n        \n        results.append(mcq)\n        results.append(mdir)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "3322538"}]}