{"hands_on_practices": [{"introduction": "在深入探讨计算电磁学中的具体应用之前，亲手感受一下病态条件对数值解的实际影响至关重要。本练习使用臭名昭著的希尔伯特矩阵，通过一个编程实践来揭示，即使在使用后向稳定算法和高精度浮点运算的情况下，巨大的条件数也足以完全摧毁计算结果的准确性。我们将观察到，尽管残差（后向误差的一种度量）保持在很小的水平，但解的真实误差（前向误差）却会急剧增长。", "problem": "编写一个完整的程序，以经验性地展示在标准浮点运算中，问题条件对求解线性系统精度的影响。考虑线性系统 $A x = b$，其中 $A$ 是一个 $n \\times n$ 的希尔伯特矩阵，其元素为 $A_{i j} = \\dfrac{1}{i + j - 1}$，$1 \\le i,j \\le n$。对于每个测试用例，定义精确解向量 $x_{\\text{true}} \\in \\mathbb{R}^n$ 为 $x_{\\text{true}} = \\mathbf{1}$ (全为1)，并构造右端项 $b = A x_{\\text{true}}$。然后，使用符合电气和电子工程师协会 (IEEE) 754 双精度 (binary64) 语义的标准浮点运算来计算数值解 $\\hat{x}$。使用 $\\hat{x}$ 计算以下量：\n- 2-范数条件数 $\\kappa_2(A) = \\|A\\|_2 \\,\\|A^{-1}\\|_2$。\n- 2-范数下的相对前向误差 $\\dfrac{\\|\\hat{x} - x_{\\text{true}}\\|_2}{\\|x_{\\text{true}}\\|_2}$。\n- 缩放残差（一种归一化的后向误差代理）$\\dfrac{\\|b - A \\hat{x}\\|_2}{\\|A\\|_2 \\,\\|\\hat{x}\\|_2 + \\|b\\|_2}$。\n- 解的估计正确十进制位数，定义为 $\\max\\!\\bigl(0,\\,-\\log_{10}(\\max(\\text{relative forward error}, \\varepsilon)))$，其中 $\\varepsilon$ 表示最小的正规格化 IEEE 754 双精度数。\n\n测试套件：\n对以下问题规模 $n$ 进行评估：\n- $n = 3$，\n- $n = 6$，\n- $n = 10$，\n- $n = 12$。\n\n所有向量和矩阵范数均为谱范数（即矩阵 2-范数和向量 2-范数）。不涉及角度。不涉及物理单位。\n\n您的程序必须生成单行输出，其中包含所有测试结果，形式为一个用方括号括起来的逗号分隔列表。每个测试结果本身也是一个列表，形式为 $[n,\\;\\kappa_2(A),\\;\\text{相对前向误差},\\;\\text{缩放残差},\\;\\text{估计位数}]$。因此，最终输出必须是表示列表的列表的单行文本，不含任何额外文字。例如，其结构必须类似于 $[[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$，但用实际计算出的数字代替占位符。", "solution": "所提出的问题陈述是有效的。这是一个适定的、有科学依据的数值线性代数练习，旨在展示问题条件、前向误差和后向误差等基本概念。该问题是自洽的，提供了所有必要的定义和数据。它没有违反任何科学原理、逻辑，也不包含任何歧义。我们将着手进行求解。\n\n该问题要求对病态条件对线性方程组 $A x = b$ 解的影响进行经验性研究。矩阵 $A$ 被选为 $n \\times n$ 的希尔伯特矩阵，这是一个严重病态矩阵的典型例子。其元素由 $A_{i j} = \\frac{1}{i + j - 1}$ 给出，其中 $i, j$ 从 $1$ 到 $n$。\n\n数值分析的核心不仅在于计算一个解，还在于理解其精度。我们记计算解为 $\\hat{x}$，其精度受两个主要因素影响：所用算法的稳定性和问题本身的内在敏感性。这种敏感性由条件数来量化。\n\n对于线性系统 $A x = b$，矩阵 $A$ 的 2-范数条件数定义为：\n$$ \\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 $$\n其中 $\\| \\cdot \\|_2$ 是谱范数（最大奇异值）。大的条件数 $\\kappa_2(A) \\gg 1$ 意味着问题是病态的，其中输入数据（$A$ 或 $b$）的微小相对扰动可能导致解 $x$ 的巨大相对变化。\n\n当我们使用浮点运算求解 $A x = b$ 时，舍入误差不可避免地会被引入。一个后向稳定的算法，例如标准求解器采用的 LU 分解，会产生一个计算解 $\\hat{x}$，该解是一个略微扰动问题的精确解：\n$$ (A + \\delta A) \\hat{x} = b + \\delta b $$\n这些扰动 $\\delta A$ 和 $\\delta b$ 的“小”是算法后向稳定性的度量。数值分析中的一个关键结果建立了关于相对前向误差的以下界限：\n$$ \\frac{\\|\\hat{x} - x_{\\text{true}}\\|_2}{\\|x_{\\text{true}}\\|_2} \\le \\kappa_2(A) \\left( \\frac{\\|\\delta A\\|_2}{\\|A\\|_2} + \\frac{\\|\\delta b\\|_2}{\\|b\\|_2} \\right) $$\n右侧括号内的项是相对后向误差。对于一个以机器精度 $\\varepsilon_{\\text{mach}}$ 运行的后向稳定算法，后向误差通常是 $\\mathcal{O}(\\varepsilon_{\\text{mach}})$ 量级。IEEE 754 双精度的机器精度约为 $2.22 \\times 10^{-16}$。因此，我们预期相对前向误差的界限约为 $\\kappa_2(A) \\cdot \\varepsilon_{\\text{mach}}$。这表明，大的条件数会放大不可避免的舍入误差，可能完全破坏解的精度。\n\n残差向量定义为 $r = b - A \\hat{x}$。残差的范数 $\\|r\\|_2$ 与后向误差有关。问题要求计算一个特定的缩放残差：\n$$ \\frac{\\|b - A \\hat{x}\\|_2}{\\|A\\|_2 \\,\\|\\hat{x}\\|_2 + \\|b\\|_2} $$\n这个量可作为后向误差的一个归一化代理。由于求解器的后向稳定性，我们预期即使条件数增长且前向误差爆炸式增长，这个值也应保持在 $\\varepsilon_{\\text{mach}}$ 的量级。这是一个关键的区别：小的残差不保证小的前向误差。\n\n最后，我们估计解的正确十进制位数。这与相对前向误差直接相关。如果相对误差是 $10^{-k}$，那么解大约精确到 $k$ 位十进制数。给定的公式 $\\max\\!\\bigl(0,\\,-\\log_{10}(\\max(\\text{relative forward error}, \\varepsilon)))$ 将此形式化。项 $\\varepsilon$ 是最小的正规格化双精度数，约 $2.225 \\times 10^{-308}$，它防止了对零取对数，并处理了误差小于可表示精度所允许的情况。\n\n我们现在将对指定的矩阵规模测试套件 $n \\in \\{3, 6, 10, 12\\}$ 执行这些计算。对于每个 $n$：\n1.  构造 $n \\times n$ 的希尔伯特矩阵 $A$。\n2.  定义真解 $x_{\\text{true}}$ 为一个包含 $n$ 个 1 的向量。\n3.  计算右端项 $b = A x_{\\text{true}}$。\n4.  使用标准线性求解器求解数值解 $\\hat{x}$。\n5.  计算四个指定的量：$\\kappa_2(A)$、相对前向误差、缩放残差和估计位数。\n\n结果将经验性地验证该理论。希尔伯特矩阵的条件数随 $n$ 极快增长。对于小的 $n$ (例如 $n=3$)，$\\kappa_2(A)$ 是中等的，我们预期会得到一个相当精确的解。当 $n$ 增加到 $10$ 和 $12$ 时，$\\kappa_2(A)$ 将变得巨大 ($> 10^{13}$)，导致相对前向误差达到 $1$ 或更大的量级，意味着精度的完全丧失。在整个过程中，缩放残差应保持很小，这表明了算法的后向稳定性，与病态问题糟糕的前向精度形成对比。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import hilbert\n\ndef solve():\n    \"\"\"\n    Empirically demonstrates the effect of problem conditioning on the accuracy\n    of solving linear systems Ax = b using the Hilbert matrix.\n    \"\"\"\n    test_cases = [3, 6, 10, 12]\n    results = []\n    \n    # Epsilon as defined in the problem: the smallest positive normalized\n    # IEEE 754 double-precision number.\n    smallest_norm_val = np.finfo(np.float64).smallest_normal\n\n    for n in test_cases:\n        # Step 1: Construct the n x n Hilbert matrix A.\n        # The problem statement indices are 1-based (i,j from 1 to n), giving A_ij = 1/(i+j-1).\n        # `scipy.linalg.hilbert(n)` uses 0-based indexing (i,j from 0 to n-1)\n        # to produce H_ij = 1/((i+1)+(j+1)-1) = 1/(i+j+1). This is the correct matrix.\n        A = hilbert(n)\n\n        # Step 2: Define the true solution and RHS vector.\n        x_true = np.ones(n)\n        b = A @ x_true\n\n        # Step 3: Solve the system numerically using double precision.\n        x_hat = np.linalg.solve(A, b)\n\n        # Step 4: Calculate the required quantities.\n        # 2-norm condition number\n        cond_A = np.linalg.cond(A, 2)\n        \n        # Relative forward error in the 2-norm\n        rel_fwd_err = np.linalg.norm(x_hat - x_true, 2) / np.linalg.norm(x_true, 2)\n        \n        # Scaled residual\n        norm_A = np.linalg.norm(A, 2)\n        norm_x_hat = np.linalg.norm(x_hat, 2)\n        norm_b = np.linalg.norm(b, 2)\n        scaled_res = np.linalg.norm(b - A @ x_hat, 2) / (norm_A * norm_x_hat + norm_b)\n        \n        # Estimated correct digits\n        est_digits = max(0, -np.log10(max(rel_fwd_err, smallest_norm_val)))\n\n        results.append([n, cond_A, rel_fwd_err, scaled_res, est_digits])\n\n    # Format the output as a single line string representation of a list of lists.\n    # The problem asks for the program to generate the output.\n    print(str(results))\n\nsolve()\n```", "id": "2428600"}, {"introduction": "现在，我们将抽象的条件数概念与计算电磁学中的一个具体场景联系起来。在有限元仿真中，材料属性的巨大差异是导致矩阵病态的常见原因。本练习模拟了这样一个包含强对比度材料的系统，我们将计算由这些物理参数导致的条件数，并揭示它如何直接决定共轭梯度法（一种广泛使用的迭代求解器）的理论收敛速度。", "problem": "在采用有限元法 (FEM) 对麦克斯韦方程组进行频域离散化时，一个非均匀、各向异性的介质会产生一个分块对角的材料矩阵，该矩阵映射了不同子域中的场自由度。考虑一个对称正定的分块对角矩阵 $M \\in \\mathbb{R}^{6 \\times 6}$，它有三个 $2 \\times 2$ 的对角块：\n$$\nM = \\mathrm{diag}(B_{1}, B_{2}, B_{3}),\n$$\n其中\n$$\nB_{1} = \\begin{pmatrix} 10^{-6} & 0 \\\\ 0 & 4 \\times 10^{-6} \\end{pmatrix}, \\quad\nB_{2} = \\begin{pmatrix} 3 \\times 10^{-3} & 0 \\\\ 0 & 10^{-2} \\end{pmatrix}, \\quad\nB_{3} = \\begin{pmatrix} 2 \\times 10^{3} & 0 \\\\ 0 & 7 \\times 10^{3} \\end{pmatrix}.\n$$\n这种结构代表了耦合子域之间差异巨大的材料参数（例如，等效介电常数和磁导率分量）。\n\n从矩阵 2-范数条件数的定义以及对称正定矩阵的性质出发，计算 2-范数条件数 $\\kappa_{2}(M)$。然后，利用应用于对称正定系统的共轭梯度 (CG) 法的标准收敛性刻画，将 $\\kappa_{2}(M)$ 与每次迭代的残差收缩因子联系起来，并以 $\\kappa_{2}(M)$ 的显式表达式给出该因子，对给定的 $M$ 进行求值。\n\n将你的最终答案表示为一个包含两个元素的行矩阵：第一个是 $\\kappa_{2}(M)$，第二个是残差收缩因子。无需四舍五入。这些量是无量纲的。", "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。矩阵 $M$ 被指定为对称正定 (SPD)。各个块 $B_1$、$B_2$ 和 $B_3$ 是对角线元素为正的对角矩阵，这证实了它们是 SPD 的。由 SPD 块构成的分块对角矩阵本身也是 SPD 的。因此，前提条件是一致且有效的。\n\n第一个任务是计算矩阵 $M$ 的 2-范数条件数 $\\kappa_{2}(M)$。根据定义，对于一个可逆矩阵 $A$，其条件数由 $\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2}$ 给出。对于对称矩阵，其 2-范数等于其谱半径，即其特征值的最大绝对值。由于 $M$ 是对称正定的，其所有特征值都是实数且为正。因此，$\\|M\\|_{2} = \\lambda_{\\max}(M)$，其中 $\\lambda_{\\max}(M)$ 是 $M$ 的最大特征值。\n\n一个 SPD 矩阵的逆矩阵 $M^{-1}$ 也是 SPD 的。它的特征值是 $M$ 特征值的倒数。因此，$M^{-1}$ 的最大特征值是 $M$ 最小特征值的倒数：$\\lambda_{\\max}(M^{-1}) = 1/\\lambda_{\\min}(M)$。所以，逆矩阵的范数为 $\\|M^{-1}\\|_{2} = 1/\\lambda_{\\min}(M)$。\n\n综合这些结果，一个 SPD 矩阵 $M$ 的 2-范数条件数可以简化为其最大特征值与最小特征值的比值：\n$$\n\\kappa_{2}(M) = \\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)}\n$$\n矩阵 $M$ 是一个分块对角矩阵：\n$$\nM = \\mathrm{diag}(B_{1}, B_{2}, B_{3})\n$$\n分块对角矩阵的特征值集合是其对角块特征值集合的并集。块 $B_1$、$B_2$ 和 $B_3$ 本身是对角矩阵。对角矩阵的特征值就是其对角线上的元素。\n$B_1$ 的特征值是 $\\{10^{-6}, 4 \\times 10^{-6}\\}$。\n$B_2$ 的特征值是 $\\{3 \\times 10^{-3}, 10^{-2}\\}$。\n$B_3$ 的特征值是 $\\{2 \\times 10^{3}, 7 \\times 10^{3}\\}$。\n\n$M$ 的所有特征值的集合，记为 $\\Lambda(M)$，是这些集合的并集：\n$$\n\\Lambda(M) = \\{10^{-6}, 4 \\times 10^{-6}, 3 \\times 10^{-3}, 10^{-2}, 2 \\times 10^{3}, 7 \\times 10^{3}\\}\n$$\n从这个集合中，我们确定最小和最大特征值：\n$$\n\\lambda_{\\min}(M) = 10^{-6}\n$$\n$$\n\\lambda_{\\max}(M) = 7 \\times 10^{3}\n$$\n现在，我们可以计算条件数：\n$$\n\\kappa_{2}(M) = \\frac{7 \\times 10^{3}}{10^{-6}} = 7 \\times 10^{9}\n$$\n问题的第二部分涉及共轭梯度 (CG) 法的收敛性。对于求解 $M$ 为 SPD 的线性系统 $Mx=b$，CG 方法的收敛速率可以用条件数 $\\kappa_{2}(M)$ 来界定。在第 $k$ 次迭代时的误差 $e_k = x - x_k$ 在 $M$-范数（也称为能量范数）下满足以下不等式：\n$$\n\\|e_k\\|_{M} \\le 2 \\left( \\frac{\\sqrt{\\kappa_{2}(M)} - 1}{\\sqrt{\\kappa_{2}(M)} + 1} \\right)^{k} \\|e_0\\|_{M}\n$$\n这个界描述了最坏情况下的收敛性。每次迭代的残差收缩因子，我们记为 $\\rho$，可以从此表达式中确定。它代表了在每一步中，误差的 $M$-范数平均保证会减小的因子。该因子由下式给出：\n$$\n\\rho = \\frac{\\sqrt{\\kappa_{2}(M)} - 1}{\\sqrt{\\kappa_{2}(M)} + 1}\n$$\n将计算出的 $\\kappa_{2}(M) = 7 \\times 10^{9}$ 的值代入此表达式，得到给定矩阵 $M$ 的具体收缩因子：\n$$\n\\rho = \\frac{\\sqrt{7 \\times 10^{9}} - 1}{\\sqrt{7 \\times 10^{9}} + 1}\n$$\n题目要求最终答案为这两个量，$\\kappa_2(M)$ 和 $\\rho$，无需四舍五入。\n第一个值是 $\\kappa_2(M) = 7 \\times 10^9$。\n第二个值是收缩因子 $\\rho = \\frac{\\sqrt{7 \\times 10^{9}} - 1}{\\sqrt{7 \\times 10^{9}} + 1}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 7 \\times 10^{9} & \\frac{\\sqrt{7 \\times 10^{9}} - 1}{\\sqrt{7 \\times 10^{9}} + 1} \\end{pmatrix}}\n$$", "id": "3328812"}, {"introduction": "理解了病态问题的来源及其影响后，我们自然会探索解决方案。本练习介绍了一种基础的预处理技术——对角缩放，它被用来改善矩阵的条件数。我们将通过对一个代表性的矩阵块实施一个平衡其行范数与列范数的优化条件，来推导最优的缩放因子，这是矩阵平衡中的一个关键思想。", "problem": "在频域计算电磁学中，对于一阶 Nédélec (边) 单元，由离散化的旋度-旋度算子与各向异性损耗（例如，在完美匹配层 (PML) 中）组合而成的代数系统可以是非正规且非对称的。对于此类系统，Krylov 子空间迭代求解器的收敛性在很大程度上受谱范数下的矩阵条件数影响，对于一个非奇异矩阵 $A$，该条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\,\\|A^{-1}\\|_2$，其中 $\\|\\,\\cdot\\,\\|_2$ 表示由向量欧几里得范数诱导的矩阵范数。一种常见且有效的预处理方法是对角相似缩放，即用 $B = D A D^{-1}$ 替换 $A$（其中 $D$ 为对角元为正的对角矩阵），以减小非正规性并改善条件数。选择 $D$ 的一种有原则的方法是最小化一个基于 Frobenius 范数的 $\\kappa_2(B)$ 上界：利用 $\\|M\\|_2 \\le \\|M\\|_F$ 和 $\\kappa_2(M) \\le \\|M\\|_F \\,\\|M^{-1}\\|_F$ 这两个事实，然后在对 $D$ 的归一化约束下，选择 $D$ 以最小化 $\\|D A D^{-1}\\|_F$。此问题的一阶最优性条件是，对于每个索引 $i$，$B$ 的第 $i$ 行的欧几里得范数等于 $B$ 的第 $i$ 列的欧几里得范数。\n\n考虑以下由具有各向异性有损耦合的局部三边循环产生的稀疏 $3 \\times 3$ 边耦合块：\n$$\nA \\;=\\; \\begin{pmatrix}\na_1 & -1 & 0 \\\\\n0 & a_2 & -2 \\\\\n3 & 0 & a_3\n\\end{pmatrix},\n$$\n其中 $a_1, a_2, a_3 > 0$。令 $D = \\operatorname{diag}(d_1, d_2, d_3)$，其中 $d_i > 0$，并施加归一化条件 $\\det(D) = 1$ 以消除平凡的尺度不变性。\n\n从谱范数、Frobenius 范数和条件数的定义出发，且仅使用行和列的欧几里得范数，通过强制使 $B = D A D^{-1}$ 的第 $i$ 行的欧几里得范数等于其第 $i$ 列的欧几里得范数，来推导使 $\\kappa_2(D A D^{-1})$ 的 Frobenius 范数代理最小化的对角缩放 $D$。然后，在 $\\det(D) = 1$ 的约束下，显式求解 $d_1, d_2, d_3$。\n\n将您的最终答案表示为一个包含 $d_1, d_2, d_3$ 精确形式的单行矩阵。无需四舍五入，也不涉及单位。", "solution": "用户希望我解决一个与计算电磁学中的矩阵条件有关的问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    -   提取所有给定信息。\n    -   检查科学合理性、适定性、客观性及其他有效性标准。\n2.  **如果有效，则继续求解。**\n    -   定义矩阵 `A` 和对角缩放矩阵 `D`。\n    -   计算缩放后的矩阵 `B = D * A * D^-1`。\n    -   陈述最优性条件：对于所有 `i`，`B` 的第 i 行的欧几里得范数必须等于 `B` 的第 i 列的欧几里得范数。\n    -   计算 `B` 的行和列的欧几里得范数。\n    -   根据最优性条件建立方程组。\n    -   纳入归一化约束 `det(D) = 1`。\n    -   求解关于 `d1`、`d2` 和 `d3` 的方程组。\n    -   以要求的格式表示最终答案。\n\n**步骤 1：问题验证**\n\n*   **提取已知条件：**\n    *   来自带有各向异性损耗的离散化旋度-旋度算子的系统矩阵。\n    *   该系统是非正规和非对称的。\n    *   使用 Krylov 子空间求解器。\n    *   收敛性受矩阵条件数 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$ 的影响。\n    *   $\\|\\cdot\\|_2$ 是由向量欧几里得范数诱导的矩阵范数（谱范数）。\n    *   预处理是对角相似缩放：$B = D A D^{-1}$，其中 $D$ 是对角且为正的。\n    *   $\\kappa_2(B)$ 的一个上界是 $\\|B\\|_F \\|B^{-1}\\|_F$，其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数。\n    *   选择 $D$ 的一种方法是在归一化约束下最小化 $\\|D A D^{-1}\\|_F$。\n    *   此最小化的一阶最优性条件是，对于每个索引 $i$，$B$ 的第 $i$ 行的欧几里得范数等于 $B$ 的第 $i$ 列的欧几里得范数。\n    *   具体矩阵是 $A = \\begin{pmatrix} a_1 & -1 & 0 \\\\ 0 & a_2 & -2 \\\\ 3 & 0 & a_3 \\end{pmatrix}$，其中 $a_1, a_2, a_3 > 0$。\n    *   缩放矩阵是 $D = \\operatorname{diag}(d_1, d_2, d_3)$，其中 $d_i > 0$。\n    *   归一化约束是 $\\det(D) = 1$。\n    *   任务是通过强制执行行列范数相等条件和归一化约束来找到 $d_1, d_2, d_3$。\n\n*   **使用提取的已知条件进行验证：**\n    1.  **科学或事实不合理性：** 该问题基于数值线性代数及其在计算电磁学中应用的公认原理。使用对角缩放（或平衡）来改善迭代求解器的矩阵性质是一种标准技术。最小化 Frobenius 范数目标与平衡行列范数之间的联系是一个已知结果（参见 Osborne 定理）。该设置在数学上和科学上都是合理的。\n    2.  **非形式化或不相关：** 该问题是高度形式化的。它从电磁学的概念背景过渡到一个具体的矩阵代数问题。该主题直接关系到矩阵条件数及其在计算电磁学中的重要性。\n    3.  **不完整或矛盾的设置：** 该问题提供了所有必要的信息：矩阵 $A$、缩放矩阵 $D$ 的形式、要强制执行的最优性条件以及归一化约束。没有矛盾之处。约束条件（$a_i > 0, d_i > 0$）是一致的。\n    4.  **不切实际或不可行：** 该问题是实际应用中出现的子问题的简化但具有代表性的示例。矩阵结构对于小型局部方程组是合理的。这些条件在物理上和数学上都是可行的。\n    5.  **不适定或结构不良：** 该问题是适定的。从这些条件推导出的方程组应该会得到关于 $d_i$ 值的唯一的正解。术语定义清晰。\n    6.  **伪深刻、琐碎或同义反复：** 该问题并非琐碎。它需要几个代数操作步骤才能得出解。它测试了对矩阵范数、相似变换和求解非线性方程组的理解。\n    7.  **超出科学可验证性范围：** 结果可通过直接计算进行数学验证。\n\n*   **结论：** 问题是 **有效的**。我将继续进行求解。\n\n**步骤 2：求解推导**\n\n1.  **定义矩阵 A 和 D：**\n    $A = \\begin{pmatrix} a_1 & -1 & 0 \\\\ 0 & a_2 & -2 \\\\ 3 & 0 & a_3 \\end{pmatrix}$\n    $D = \\begin{pmatrix} d_1 & 0 & 0 \\\\ 0 & d_2 & 0 \\\\ 0 & 0 & d_3 \\end{pmatrix}$\n    由于 $D$ 是对角矩阵，其逆矩阵很简单：\n    $D^{-1} = \\begin{pmatrix} 1/d_1 & 0 & 0 \\\\ 0 & 1/d_2 & 0 \\\\ 0 & 0 & 1/d_3 \\end{pmatrix}$\n\n2.  **计算 B = D A D⁻¹：**\n    $B = D A D^{-1} = \\begin{pmatrix} d_1 & 0 & 0 \\\\ 0 & d_2 & 0 \\\\ 0 & 0 & d_3 \\end{pmatrix} \\begin{pmatrix} a_1 & -1 & 0 \\\\ 0 & a_2 & -2 \\\\ 3 & 0 & a_3 \\end{pmatrix} \\begin{pmatrix} 1/d_1 & 0 & 0 \\\\ 0 & 1/d_2 & 0 \\\\ 0 & 0 & 1/d_3 \\end{pmatrix}$\n    首先，计算 $A D^{-1}$：\n    $A D^{-1} = \\begin{pmatrix} a_1/d_1 & -1/d_2 & 0 \\\\ 0 & a_2/d_2 & -2/d_3 \\\\ 3/d_1 & 0 & a_3/d_3 \\end{pmatrix}$\n    现在，计算 $D (A D^{-1})$：\n    $B = \\begin{pmatrix} d_1 (a_1/d_1) & d_1 (-1/d_2) & d_1 (0) \\\\ d_2 (0) & d_2 (a_2/d_2) & d_2 (-2/d_3) \\\\ d_3 (3/d_1) & d_3 (0) & d_3 (a_3/d_3) \\end{pmatrix} = \\begin{pmatrix} a_1 & -d_1/d_2 & 0 \\\\ 0 & a_2 & -2d_2/d_3 \\\\ 3d_3/d_1 & 0 & a_3 \\end{pmatrix}$\n    元素 $B_{ij}$ 为 $A_{ij} d_i / d_j$。这是对角相似缩放的通用公式。\n\n3.  **陈述最优性条件：**\n    设 $r_i(B)$ 为 $B$ 的第 $i$ 行，$c_i(B)$ 为 $B$ 的第 $i$ 列。条件为 $\\|r_i(B)\\|_2 = \\|c_i(B)\\|_2$，对于 $i=1,2,3$。\n    这等价于 $\\|r_i(B)\\|_2^2 = \\|c_i(B)\\|_2^2$。\n\n4.  **计算行和列的范数：**\n    *   **对于 i=1：**\n        *   第 1 行：$r_1(B) = (a_1, -d_1/d_2, 0)$\n        *   第 1 列：$c_1(B) = (a_1, 0, 3d_3/d_1)^T$\n        *   $\\|r_1(B)\\|_2^2 = a_1^2 + (-d_1/d_2)^2 + 0^2 = a_1^2 + (d_1/d_2)^2$\n        *   $\\|c_1(B)\\|_2^2 = a_1^2 + 0^2 + (3d_3/d_1)^2 = a_1^2 + 9(d_3/d_1)^2$\n        *   方程 (1)：$a_1^2 + (d_1/d_2)^2 = a_1^2 + 9(d_3/d_1)^2 \\implies (d_1/d_2)^2 = 9(d_3/d_1)^2$\n\n    *   **对于 i=2：**\n        *   第 2 行：$r_2(B) = (0, a_2, -2d_2/d_3)$\n        *   第 2 列：$c_2(B) = (-d_1/d_2, a_2, 0)^T$\n        *   $\\|r_2(B)\\|_2^2 = 0^2 + a_2^2 + (-2d_2/d_3)^2 = a_2^2 + 4(d_2/d_3)^2$\n        *   $\\|c_2(B)\\|_2^2 = (-d_1/d_2)^2 + a_2^2 + 0^2 = (d_1/d_2)^2 + a_2^2$\n        *   方程 (2)：$a_2^2 + 4(d_2/d_3)^2 = (d_1/d_2)^2 + a_2^2 \\implies 4(d_2/d_3)^2 = (d_1/d_2)^2$\n\n    *   **对于 i=3：**\n        *   第 3 行：$r_3(B) = (3d_3/d_1, 0, a_3)$\n        *   第 3 列：$c_3(B) = (0, -2d_2/d_3, a_3)^T$\n        *   $\\|r_3(B)\\|_2^2 = (3d_3/d_1)^2 + 0^2 + a_3^2 = 9(d_3/d_1)^2 + a_3^2$\n        *   $\\|c_3(B)\\|_2^2 = 0^2 + (-2d_2/d_3)^2 + a_3^2 = 4(d_2/d_3)^2 + a_3^2$\n        *   方程 (3)：$9(d_3/d_1)^2 + a_3^2 = 4(d_2/d_3)^2 + a_3^2 \\implies 9(d_3/d_1)^2 = 4(d_2/d_3)^2$\n\n    请注意，这三个方程不是独立的。\n    方程 (1) 给出 $(d_1/d_2)^2 = 9(d_3/d_1)^2$。\n    方程 (2) 给出 $(d_1/d_2)^2 = 4(d_2/d_3)^2$。\n    方程 (3) 给出 $9(d_3/d_1)^2 = 4(d_2/d_3)^2$。\n    如果 (1) 和 (2) 成立，则 (3) 自动成立。因此我们有两个关于 $d_i$ 比率的独立方程。\n\n5.  **求解方程组：**\n    我们有以下方程组：\n    (I) $(d_1/d_2)^2 = 4(d_2/d_3)^2$\n    (II) $(d_1/d_2)^2 = 9(d_3/d_1)^2$\n    (III) $\\det(D) = d_1 d_2 d_3 = 1$ (归一化)\n\n    由于 $d_i > 0$，我们可以对这些方程开平方。\n    由 (I) 得：$d_1/d_2 = 2(d_2/d_3) \\implies d_1 d_3 = 2 d_2^2$。\n    由 (II) 得：$d_1/d_2 = 3(d_3/d_1) \\implies d_1^2 = 3 d_2 d_3$。\n\n    现在我们有了一个包含三个未知数 $d_1, d_2, d_3$ 的三元方程组：\n    1. $d_1 d_3 = 2 d_2^2$\n    2. $d_1^2 = 3 d_2 d_3$\n    3. $d_1 d_2 d_3 = 1$\n\n    我们使用代入法。从 (3) 可得 $d_3 = 1/(d_1 d_2)$。\n    将此代入 (1) 和 (2)。\n\n    代入 (1)：\n    $d_1 (1/(d_1 d_2)) = 2 d_2^2 \\implies 1/d_2 = 2 d_2^2 \\implies 1 = 2 d_2^3 \\implies d_2^3 = 1/2$。\n    所以，$d_2 = (1/2)^{1/3} = 2^{-1/3}$。\n\n    代入 (2)：\n    $d_1^2 = 3 d_2 (1/(d_1 d_2)) \\implies d_1^2 = 3/d_1 \\implies d_1^3 = 3$。\n    所以，$d_1 = 3^{1/3}$。\n\n    现在使用归一化约束 $d_1 d_2 d_3 = 1$ 来求 $d_3$：\n    $d_3 = 1 / (d_1 d_2) = 1 / (3^{1/3} \\cdot 2^{-1/3}) = 1 / ((3/2)^{1/3}) = (2/3)^{1/3}$。\n    这可以写作 $d_3 = 2^{1/3} / 3^{1/3}$。\n\n    让我们用原始方程 (1) 和 (2) 来复核这个解。\n    1. $d_1 d_3 = 2 d_2^2$\n       左边：$d_1 d_3 = 3^{1/3} \\cdot (2/3)^{1/3} = 3^{1/3} \\cdot 2^{1/3} / 3^{1/3} = 2^{1/3}$。\n       右边：$2 d_2^2 = 2 \\cdot (2^{-1/3})^2 = 2 \\cdot 2^{-2/3} = 2^{1-2/3} = 2^{1/3}$。\n       左边 = 右边。正确。\n\n    2. $d_1^2 = 3 d_2 d_3$\n       左边：$d_1^2 = (3^{1/3})^2 = 3^{2/3}$。\n       右边：$3 d_2 d_3 = 3 \\cdot (2^{-1/3}) \\cdot ((2/3)^{1/3}) = 3 \\cdot 2^{-1/3} \\cdot 2^{1/3} \\cdot 3^{-1/3} = 3 \\cdot 3^{-1/3} = 3^{1-1/3} = 3^{2/3}$。\n       左边 = 右边。正确。\n\n    3. $d_1 d_2 d_3 = 1$\n       左边：$3^{1/3} \\cdot 2^{-1/3} \\cdot (2/3)^{1/3} = 3^{1/3} \\cdot 2^{-1/3} \\cdot 2^{1/3} \\cdot 3^{-1/3} = 3^{1/3-1/3} \\cdot 2^{-1/3+1/3} = 3^0 \\cdot 2^0 = 1$。\n       左边 = 右边。正确。\n\n    解是一致的。\n\n    逻辑上似乎很合理。问题陈述给出了清晰的步骤，我已完全遵循。\n    - 计算缩放后的矩阵 $B$。\n    - 建立“行范数等于列范数”的方程。\n    - 结合归一化约束求解该方程组。\n\n    让我们重写解题过程以求表述清晰。\n    - 首先陈述 $A$、$D$ 和 $B = DAD^{-1}$ 的定义。\n    - 显式写出矩阵 $B$。\n    - 写出行向量 $r_i(B)$ 和列向量 $c_i(B)$。\n    - 写出欧几里得范数的平方 $\\|r_i(B)\\|_2^2$ 和 $\\|c_i(B)\\|_2^2$。\n    - 对 $i=1, 2, 3$ 令它们相等，得到方程组。\n    - 简化该方程组并使用归一化条件 $d_1 d_2 d_3 = 1$。\n    - 求解 $d_1, d_2, d_3$。\n    - 最终答案应该是一个行矩阵 `\\begin{pmatrix} d_1 & d_2 & d_3 \\end{pmatrix}`。\n\n    最终答案是 $d_1 = 3^{1/3}$，$d_2 = 2^{-1/3}$，$d_3 = (2/3)^{1/3}$。\n    我应该把这些值写在最终答案框中。题目要求的是精确形式，这些就是。\n\n    $d_1 = \\sqrt[3]{3}$\n    $d_2 = 1/\\sqrt[3]{2}$\n    $d_3 = \\sqrt[3]{2/3}$\n\n    我们再检查一下约束条件。$d_1 d_2 d_3 = (3 \\cdot 1/2 \\cdot 2/3)^{1/3} = 1^{1/3} = 1$。正确。\n    这些值是 $d_1 \\approx 1.44$，$d_2 \\approx 0.79$，$d_3 \\approx 0.87$。它们都是正数。\n\n    该解法是所述原理的直接应用。问题定义明确，并导出了唯一解。必须严格遵守格式要求。所有数字和变量必须使用 LaTeX。最终答案是一个 pmatrix。\n\n    对答案框的 LaTeX 格式进行最终检查：\n    `\\begin{pmatrix} 3^{1/3} & 2^{-1/3} & (2/3)^{1/3} \\end{pmatrix}`\n    这正确吗？题目要求一个行矩阵。是的，单行的 pmatrix 是正确的。\n    我也可以写 $(2/3)^{1/3}$ 为 $2^{1/3}3^{-1/3}$。或者也许是 $(\\frac{2}{3})^{1/3}$。使用 `\\frac` 更好。\n    所以是 `(\\frac{2}{3})^{1/3}`。这可能是最易读的。\n\n    对问题陈述细节的最终检查：\n    “将您的最终答案表示为一个包含 $d_1, d_2, d_3$ 精确形式的单行矩阵。”\n    所以最终答案的格式是 `\\begin{pmatrix} ... & ... & ... \\end{pmatrix}`。\n\n    我对整个过程充满信心。问题验证是正面的，推导过程在代数上是合理的。最终答案的格式是清晰的。我现在就写下解答。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3^{1/3} & 2^{-1/3} & \\left(\\frac{2}{3}\\right)^{1/3} \\end{pmatrix}}\n$$", "id": "3328823"}]}