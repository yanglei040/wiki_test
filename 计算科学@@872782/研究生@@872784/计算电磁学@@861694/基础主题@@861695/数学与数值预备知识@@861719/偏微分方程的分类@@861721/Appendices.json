{"hands_on_practices": [{"introduction": "本练习将偏微分方程分类的抽象概念与静电学的具体物理情境联系起来。通过分析各向异性介质中的算子，您将推导出其主象征，并用它来确定椭圆性条件，这是保证稳态问题适定性的基本性质 [@problem_id:3293203]。这项实践将巩固您对材料本构张量与控制方程数学本质之间联系的理解。", "problem": "在计算电磁学 (CEM) 中，各向异性、非均匀介电介质中的静电学问题通过标量势 $u$ 来建模，该标量势满足散度形式的二阶偏微分方程 (PDE)\n$$\n-\\nabla\\cdot\\big(A(x)\\nabla u(x)\\big)=f(x)\\quad\\text{in }\\mathbb{R}^{3},\n$$\n其中 $A(x) \\in \\mathbb{R}^{3 \\times 3}$ 是表示介电常数张量的对称矩阵场，$f$ 是给定的源密度。该方程源于麦克斯韦方程组的静电极限，即 $\\nabla\\times E=0$，$E=-\\nabla u$，$D=A(x)E$ 以及 $\\nabla\\cdot D=\\rho$，这些方程共同导出 $-\\nabla\\cdot(A(x)\\nabla u)=\\rho$。\n\n从这些物理定律以及通过冻结系数和高频平面波拟设定义的二阶线性算子主符号出发，推导算子 $L=-\\nabla\\cdot(A(x)\\nabla\\cdot)$ 的主符号 $p(x,\\xi)$，并确定 $A(x)$ 在 $\\mathbb{R}^{3}$ 上对于静电学意义下的均匀椭圆性的精确充要条件。然后将您的推导应用于具体给出的各向异性介质\n$$\nA(x)=\\begin{pmatrix}\n2+\\tanh(|x|)  0  0\\\\\n0  4  0\\\\\n0  0  5-\\exp(-|x|^{2})\n\\end{pmatrix},\n\\quad x \\in \\mathbb{R}^{3},\n$$\n其中 $|x|$ 表示欧几里得范数。计算主符号 $p(x,\\xi)$ 关于 $\\xi=(\\xi_{1},\\xi_{2},\\xi_{3})$ 各分量的显式形式，并计算最优（即可能的最大值）均匀椭圆性下常数 $\\alpha$ 和最优（即可能的最小值）均匀椭圆性上常数 $\\beta$，使得对于所有 $x \\in \\mathbb{R}^{3}$ 和所有 $\\xi \\in \\mathbb{R}^{3}$，\n$$\n\\alpha\\,|\\xi|^{2}\\leq \\xi\\cdot A(x)\\,\\xi\\leq \\beta\\,|\\xi|^{2}.\n$$\n\n将您的最终答案表示为一个单行向量，依次包含显式主符号 $p(x,\\xi)$、最优 $\\alpha$ 和最优 $\\beta$。无需四舍五入，最终答案中不包含单位。使用给定的函数 $\\tanh(\\cdot)$ 和 $\\exp(\\cdot)$ 以闭合形式表示主符号，并将 $\\alpha$ 和 $\\beta$ 表示为精确实数。", "solution": "该问题是有效的，因为它在科学上基于偏微分方程（PDE）理论及其在静电学中的应用，是适定的，并且陈述客观。我们将进行完整的推导。\n\n给定的偏微分方程是\n$$\n-\\nabla\\cdot\\big(A(x)\\nabla u(x)\\big)=f(x)\n$$\n其中 $A(x)$ 是一个对称的 $3 \\times 3$ 矩阵场。算子为 $L = -\\nabla\\cdot(A(x)\\nabla\\cdot)$。\n\n**1. 主符号的推导**\n\n一个一般的二阶线性偏微分算子可以写成\n$$\nLu = \\sum_{i,j=1}^{3} a_{ij}(x) \\frac{\\partial^2 u}{\\partial x_i \\partial x_j} + \\sum_{i=1}^{3} b_i(x) \\frac{\\partial u}{\\partial x_i} + c(x)u\n$$\n该算子的主符号是定义在余切丛上的函数 $p(x, \\xi)$，通过只考虑最高阶导数项并将偏导数算子 $\\frac{\\partial}{\\partial x_k}$ 替换为形式变量 $i\\xi_k$ 来获得。在此替换下，$\\frac{\\partial^2 u}{\\partial x_i \\partial x_j}$ 被替换为 $(i\\xi_i)(i\\xi_j) = -\\xi_i\\xi_j$。因此，主符号由下式给出\n$$\np(x, \\xi) = \\sum_{i,j=1}^{3} a_{ij}(x) (-\\xi_i\\xi_j) = -\\sum_{i,j=1}^{3} a_{ij}(x) \\xi_i\\xi_j\n$$\n注意：一些约定通过将 $\\frac{\\partial}{\\partial x_k}$ 替换为 $\\xi_k$ 来定义符号，这会导致符号不同。偏微分方程的分类（例如，椭圆性）取决于此 $\\xi$ 的二次型的性质，核心分析对符号约定不敏感。我们将使用与算子的能量形式最直接相关的约定。\n\n让我们展开给定的算子 $L u = -\\nabla\\cdot(A(x)\\nabla u)$：\n$$\nLu = -\\sum_{i=1}^{3} \\frac{\\partial}{\\partial x_i} \\left( \\sum_{j=1}^{3} A_{ij}(x) \\frac{\\partial u}{\\partial x_j} \\right)\n$$\n使用微分的乘积法则：\n$$\nLu = -\\sum_{i,j=1}^{3} \\left( \\frac{\\partial A_{ij}(x)}{\\partial x_i} \\frac{\\partial u}{\\partial x_j} + A_{ij}(x) \\frac{\\partial^2 u}{\\partial x_i \\partial x_j} \\right)\n$$\n算子 $L$ 的主部仅包含二阶导数：\n$$\nL_p u = -\\sum_{i,j=1}^{3} A_{ij}(x) \\frac{\\partial^2 u}{\\partial x_i \\partial x_j}\n$$\n遵循高频平面波拟设（或“冻结系数”法），我们将 $\\frac{\\partial}{\\partial x_k}$ 替换为 $i\\xi_k$。这给出了主部的符号，我们称之为主符号 $p(x, \\xi)$：\n$$\np(x, \\xi) = -\\sum_{i,j=1}^{3} A_{ij}(x) (i\\xi_i)(i\\xi_j) = -\\sum_{i,j=1}^{3} A_{ij}(x) (-\\xi_i\\xi_j) = \\sum_{i,j=1}^{3} A_{ij}(x) \\xi_i \\xi_j\n$$\n用矩阵表示法，这是二次型：\n$$\np(x, \\xi) = \\xi^T A(x) \\xi = \\xi \\cdot (A(x) \\xi)\n$$\n\n**2. 均匀椭圆性的条件**\n\n如果算子 $L$ 的主符号 $p(x, \\xi)$ 对于所有非零向量 $\\xi \\in \\mathbb{R}^3$ 均不为零，则称算子 $L$ 在点 $x$ 是椭圆的。由于 $A(x)$ 是对称矩阵，$p(x, \\xi)$ 是一个实值二次型。在静电学背景下，能量密度必须为正，这意味着介电常数张量 $A(x)$ 必须是正定的。这意味着对于所有 $\\xi \\neq 0$，$p(x, \\xi)  0$。\n\n如果存在常数 $\\alpha  0$ 和 $\\beta  0$，使得对于所有 $x \\in \\mathbb{R}^3$ 和所有 $\\xi \\in \\mathbb{R}^3$：\n$$\n\\alpha |\\xi|^2 \\leq p(x, \\xi) \\leq \\beta |\\xi|^2\n$$\n则算子 $L$ 在一个域（这里是 $\\mathbb{R}^3$）中是均匀椭圆的。代入我们对 $p(x, \\xi)$ 的表达式，我们得到：\n$$\n\\alpha |\\xi|^2 \\leq \\xi^T A(x) \\xi \\leq \\beta |\\xi|^2\n$$\n对于对称矩阵 $A(x)$，Rayleigh-Ritz 定理指出二次型 $\\xi^T A(x) \\xi$ 的值由其最小和最大特征值 $\\lambda_{\\min}(x)$ 和 $\\lambda_{\\max}(x)$ 界定：\n$$\n\\lambda_{\\min}(x) |\\xi|^2 \\leq \\xi^T A(x) \\xi \\leq \\lambda_{\\max}(x) |\\xi|^2\n$$\n为了使均匀椭圆性条件对所有 $x \\in \\mathbb{R}^3$ 成立，常数 $\\alpha$ 和 $\\beta$ 必须与 $x$ 无关。这导出了一个充要条件，即 $A(x)$ 的特征值必须在整个 $x \\in \\mathbb{R}^3$ 上一致有下界和上界。具体来说，最优常数 $\\alpha$ 和 $\\beta$ 由以下公式给出：\n$$\n\\alpha = \\inf_{x \\in \\mathbb{R}^3} \\lambda_{\\min}(x) > 0\n$$\n$$\n\\beta = \\sup_{x \\in \\mathbb{R}^3} \\lambda_{\\max}(x)  \\infty\n$$\n\n**3. 对特定介质的应用**\n\n给定的介电常数张量为：\n$$\nA(x)=\\begin{pmatrix}\n2+\\tanh(|x|)  0  0\\\\\n0  4  0\\\\\n0  0  5-\\exp(-|x|^{2})\n\\end{pmatrix}\n$$\n该矩阵是对角的，所以其特征值就是其对角线元素。令 $r = |x| \\geq 0$。特征值是 $r$ 的函数：\n$$\n\\lambda_1(r) = 2+\\tanh(r)\n$$\n$$\n\\lambda_2(r) = 4\n$$\n$$\n\\lambda_3(r) = 5-\\exp(-r^2)\n$$\n\n主符号 $p(x, \\xi)$ 对于 $\\xi = (\\xi_1, \\xi_2, \\xi_3)$ 的显式形式为：\n$$\np(x, \\xi) = \\xi^T A(x) \\xi = \\lambda_1(|x|) \\xi_1^2 + \\lambda_2(|x|) \\xi_2^2 + \\lambda_3(|x|) \\xi_3^2\n$$\n$$\np(x, \\xi) = (2+\\tanh(|x|))\\xi_1^2 + 4\\xi_2^2 + (5-\\exp(-|x|^2))\\xi_3^2\n$$\n\n为了找到最优椭圆性常数 $\\alpha$ 和 $\\beta$，我们分析特征值在 $r = |x| \\in [0, \\infty)$ 上的取值范围：\n- 函数 $\\tanh(r)$ 在 $[0, \\infty)$ 上单调递增，且 $\\tanh(0) = 0$ 和 $\\lim_{r\\to\\infty} \\tanh(r) = 1$。因此，$\\lambda_1(r)$ 的取值范围是 $[2+\\tanh(0), 2+\\lim_{r\\to\\infty} \\tanh(r)) = [2, 3)$。\n- 特征值 $\\lambda_2(r) = 4$ 是常数。\n- 函数 $\\exp(-r^2)$ 在 $[0, \\infty)$ 上单调递减，且 $\\exp(0) = 1$ 和 $\\lim_{r\\to\\infty} \\exp(-r^2) = 0$。因此，$\\lambda_3(r)$ 的取值范围是 $[5-\\exp(0), 5-\\lim_{r\\to\\infty} \\exp(-r^2)) = [4, 5)$。\n\n现在我们计算 $\\alpha$ 和 $\\beta$。\n对于任意给定的 $x$，最小特征值为 $\\lambda_{\\min}(x) = \\min\\{\\lambda_1(|x|), \\lambda_2(|x|), \\lambda_3(|x|)\\}$。由于 $\\lambda_1(|x|) \\in [2, 3)$，$\\lambda_2(|x|) = 4$，以及 $\\lambda_3(|x|) \\in [4, 5)$，很明显对于任何 $|x| \\ge 0$，最小特征值是 $\\lambda_1(|x|)$。\n$$\n\\lambda_{\\min}(x) = 2+\\tanh(|x|)\n$$\n最优下常数 $\\alpha$ 是 $\\lambda_{\\min}(x)$ 在所有 $x \\in \\mathbb{R}^3$ 上的下确界：\n$$\n\\alpha = \\inf_{x \\in \\mathbb{R}^3} \\lambda_{\\min}(x) = \\inf_{r \\geq 0} (2+\\tanh(r))\n$$\n由于 $\\tanh(r)$ 对于 $r \\geq 0$ 是递增的，其下确界出现在 $r=0$ 处。\n$$\n\\alpha = 2+\\tanh(0) = 2+0 = 2\n$$\n\n对于任意给定的 $x$，最大特征值为 $\\lambda_{\\max}(x) = \\max\\{\\lambda_1(|x|), \\lambda_2(|x|), \\lambda_3(|x|)\\}$。由于 $\\lambda_1(|x|)  3$，它永远不可能是最大特征值，因为另外两个总是 $\\geq 4$。\n我们必须找到 $\\max\\{4, 5-\\exp(-|x|^2)\\}$。对于任何 $r=|x| \\ge 0$，我们有 $r^2 \\ge 0$，所以 $0  \\exp(-r^2) \\le 1$。这意味着 $5-\\exp(-r^2) \\ge 5-1=4$。因此，对于所有 $x$，$\\lambda_3(|x|) \\ge \\lambda_2(|x|)$。\n$$\n\\lambda_{\\max}(x) = 5-\\exp(-|x|^2)\n$$\n最优上常数 $\\beta$ 是 $\\lambda_{\\max}(x)$ 在所有 $x \\in \\mathbb{R}^3$ 上的上确界：\n$$\n\\beta = \\sup_{x \\in \\mathbb{R}^3} \\lambda_{\\max}(x) = \\sup_{r \\geq 0} (5-\\exp(-r^2))\n$$\n由于 $\\exp(-r^2)$ 对于 $r \\geq 0$ 是递减的，函数 $5-\\exp(-r^2)$ 是递增的。其上确界是当 $r \\to \\infty$ 时的极限。\n$$\n\\beta = \\lim_{r \\to \\infty} (5-\\exp(-r^2)) = 5-0 = 5\n$$\n\n**结果总结**\n- 主符号 $p(x, \\xi)$: $(2+\\tanh(|x|))\\xi_1^2 + 4\\xi_2^2 + (5-\\exp(-|x|^2))\\xi_3^2$\n- 最优椭圆性下常数 $\\alpha$: $2$\n- 最优椭圆性上常数 $\\beta$: $5$", "answer": "$$\n\\boxed{\\begin{pmatrix} (2+\\tanh(|x|))\\xi_1^2 + 4\\xi_2^2 + (5-\\exp(-|x|^2))\\xi_3^2  2  5 \\end{pmatrix}}\n$$", "id": "3293203"}, {"introduction": "双曲型偏微分方程描述了波动现象，其数值模拟受一个至关重要的稳定性判据所制约。本问题将引导您从第一性原理出发，为应用于麦克斯韦方程组的“时域有限差分法”(FDTD)推导著名的Courant–Friedrichs–Lewy (CFL)条件 [@problem_id:3293251]。掌握此分析过程将揭示双曲型系统固有的有限传播速度是如何决定显式求解器所允许的最大时间步长的。", "problem": "考虑在介电常数为 $\\varepsilon$、磁导率为 $\\mu$、波速为 $c = 1/\\sqrt{\\varepsilon \\mu}$ 的均匀、各向同性介质中的无源麦克斯韦方程组：\n$$\n\\varepsilon\\,\\partial_{t}\\mathbf{E} = \\nabla \\times \\mathbf{H}, \n\\qquad\n\\mu\\,\\partial_{t}\\mathbf{H} = -\\,\\nabla \\times \\mathbf{E}.\n$$\n在一个三重周期性矩形域上，这些方程构成一个对称双曲系统，并满足电磁能量恒等式\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int \\frac{1}{2}\\big(\\varepsilon|\\mathbf{E}|^{2}+\\mu|\\mathbf{H}|^{2}\\big)\\,\\mathrm{d}V \\;=\\; -\\int \\nabla \\cdot (\\mathbf{E}\\times \\mathbf{H})\\,\\mathrm{d}V,\n$$\n在周期性边界条件下，该恒等式简化为能量守恒。由 Kane Yee 提出的标准显式时域有限差分（FDTD）离散方法（即 Yee 格式），将 $\\mathbf{E}$ 和 $\\mathbf{H}$ 在空间上（在间距为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 的正交网格上）和时间上（时间步长为 $\\Delta t$）进行交错排列，从而产生一个二阶蛙跳式更新。\n\n仅使用上述基本定律和周期性网格上中心有限差分的性质，从第一性原理出发，论证半离散（空间离散，时间连续）的麦克斯韦算子对于离散电磁能量内积是斜伴随的，并且其傅里叶符号是纯虚数，频率与离散波数的模成正比。通过中心差分符号对该离散麦克斯韦算子的谱半径进行定界，并强制要求全离散蛙跳更新对所有傅里叶模式都具有模为单位的放大因子，推导出形式如下的 Courant–Friedrichs–Lewy (CFL) 条件\n$$\n\\Delta t \\;\\le\\; \\frac{1}{c}\\,\\frac{1}{\\sqrt{\\frac{1}{\\Delta x^{2}}+\\frac{1}{\\Delta y^{2}}+\\frac{1}{\\Delta z^{2}}}},\n$$\n然后将其改写为与各向同性无关的形式\n$$\n\\Delta t \\;\\le\\; \\alpha \\,\\frac{\\min(\\Delta x,\\Delta y,\\Delta z)}{c}.\n$$\n确定最大的允许常数 $\\alpha$，使得后一个界限对于三维空间中的所有矩形网格都一致成立。您的最终答案必须是 $\\alpha$ 的这个单一值。无需四舍五入；请提供精确表达式。该答案是无量纲的，因此不需要物理单位。", "solution": "该问题要求为麦克斯韦方程组的时域有限差分（FDTD）方法推导一个稳定性条件，并确定一个相关的常数 $\\alpha$。推导过程按照问题陈述的引导分步进行。\n\n首先，我们考虑麦克斯韦方程组在空间上的半离散化。连续的无源麦克斯韦方程组为：\n$$\n\\varepsilon\\,\\partial_{t}\\mathbf{E} = \\nabla \\times \\mathbf{H}\n$$\n$$\n\\mu\\,\\partial_{t}\\mathbf{H} = -\\,\\nabla \\times \\mathbf{E}\n$$\nYee 格式在交错网格上离散化这些方程。连续旋度算子 $\\nabla \\times$ 被一个离散旋度算子 $\\mathbf{D} \\times$ 所取代，后者由中心有限差分算子构造而成。对于网格上的函数 $f$，在 $x$ 方向上的中心差分算子是 $D_x f = (f_{i+1/2} - f_{i-1/2})/\\Delta x$。在周期性域上，分部求和表明，此类中心差分算子相对于离散 $l_2$ 内积是斜伴随的。也就是说，对于网格函数 $f$ 和 $g$，$\\sum_i (D_x f_i) g_i^* = -\\sum_i f_i (D_x g_i)^*$，其中星号表示复共轭。离散旋度算子 $\\mathbf{D}\\times$ 从其构成的差分算子继承了性质，使其相对于网格上矢量场的 $l_2$ 内积是自伴的。\n\n令状态矢量为 $\\mathbf{U} = (\\mathbf{E}, \\mathbf{H})^T$。半离散系统（时间连续，空间离散）为 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\mathbf{U} = \\mathbf{L}\\mathbf{U}$，其中 $\\mathbf{L}$ 是半离散麦克斯韦算子：\n$$\n\\mathbf{L} = \\begin{pmatrix} 0  \\frac{1}{\\varepsilon} \\mathbf{D} \\times \\\\ -\\frac{1}{\\mu} \\mathbf{D} \\times  0 \\end{pmatrix}\n$$\n离散电磁能量定义了一个内积 $\\langle \\mathbf{U}_1, \\mathbf{U}_2 \\rangle_U = \\frac{1}{2} \\sum (\\varepsilon |\\mathbf{E}_1 \\cdot \\mathbf{E}_2^*| + \\mu |\\mathbf{H}_1 \\cdot \\mathbf{H}_2^*|) \\Delta V$。相对于此内积，算子 $\\mathbf{L}$ 是斜伴随的，即 $\\mathbf{L}^\\dagger = -\\mathbf{L}$，其中 $\\dagger$ 表示相对于 $\\langle \\cdot, \\cdot \\rangle_U$ 的伴随。此性质是 $\\mathbf{D}\\times$ 算子自伴性的直接推论，并确保了 $\\mathbf{L}$ 的特征值是纯虚数。\n\n为了找到这些特征值，我们进行傅里叶分析（冯·诺依曼分析）。我们考虑网格上的单个平面波模式 $\\mathbf{F}_{j,k,l} = \\mathbf{F}_0 \\exp(i(k_x j \\Delta x + k_y k \\Delta y + k_z l \\Delta z))$，其中 $\\mathbf{k}=(k_x, k_y, k_z)$ 是波矢量。中心差分算子 $D_x$ 作用于此模式上，相当于乘以 $i\\kappa_x$，其中 $\\kappa_x = \\frac{2}{\\Delta x}\\sin(\\frac{k_x \\Delta x}{2})$。离散旋度算子 $\\mathbf{D}\\times$ 的作用相当于乘以 $i\\boldsymbol{\\kappa}\\times$，其中 $\\boldsymbol{\\kappa} = (\\kappa_x, \\kappa_y, \\kappa_z)$。傅里叶空间中的半离散系统变为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\begin{pmatrix} \\hat{\\mathbf{E}} \\\\ \\hat{\\mathbf{H}} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{\\varepsilon} i\\boldsymbol{\\kappa} \\times \\\\ -\\frac{1}{\\mu} i\\boldsymbol{\\kappa} \\times  0 \\end{pmatrix} \\begin{pmatrix} \\hat{\\mathbf{E}} \\\\ \\hat{\\mathbf{H}} \\end{pmatrix}\n$$\n右侧矩阵（即 $\\mathbf{L}$ 的傅里叶符号）的特征值 $\\lambda$ 可通过求解相关的特征方程得到。这会得出 $\\lambda^2 = -c^2 |\\boldsymbol{\\kappa}|^2$，其中 $c=1/\\sqrt{\\varepsilon\\mu}$ 且 $|\\boldsymbol{\\kappa}|^2 = \\kappa_x^2 + \\kappa_y^2 + \\kappa_z^2$。因此，特征值为 $\\lambda = \\pm i c |\\boldsymbol{\\kappa}|$，正如预期，它们是纯虚数。量 $\\omega_d = c|\\boldsymbol{\\kappa}|$ 可被解释为数值色散关系，它给出了离散模式的频率。\n\n接下来，我们分析全离散蛙跳格式的稳定性。Yee 格式等价于对电场的二阶波动方程进行中心差分蛙跳离散化：\n$$\n\\frac{\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}}{(\\Delta t)^2} = c^2 (\\mathbf{D}\\times)(\\mathbf{D}\\times) \\mathbf{E}^n\n$$\n在傅里叶空间中，对于横波，算子 $(\\mathbf{D}\\times)(\\mathbf{D}\\times)$ 的作用相当于乘以 $(i\\boldsymbol{\\kappa}\\times)(i\\boldsymbol{\\kappa}\\times) = -|\\boldsymbol{\\kappa}|^2$。寻求形式为 $\\mathbf{E}^n \\sim g^n$ 的解，其中 $g$ 是放大因子，我们得到特征方程：\n$$\n\\frac{g - 2 + g^{-1}}{(\\Delta t)^2} = -c^2 |\\boldsymbol{\\kappa}|^2 \\implies g + g^{-1} = 2 - (c \\Delta t |\\boldsymbol{\\kappa}|)^2\n$$\n为使格式稳定，放大因子必须满足 $|g| \\le 1$。如果我们令 $g = \\exp(i\\theta)$，则 $2\\cos\\theta = 2 - (c \\Delta t |\\boldsymbol{\\kappa}|)^2$，这意味着 $\\cos\\theta = 1 - \\frac{1}{2}(c \\Delta t |\\boldsymbol{\\kappa}|)^2$。为了使 $\\theta$ 为实数，我们需要 $|\\cos\\theta| \\le 1$。这导出了条件：\n$$\n-1 \\le 1 - \\frac{1}{2}(c \\Delta t |\\boldsymbol{\\kappa}|)^2 \\le 1\n$$\n右边的不等式总是满足的。左边的不等式给出 $(c \\Delta t |\\boldsymbol{\\kappa}|)^2 \\le 4$，或 $|c \\Delta t |\\boldsymbol{\\kappa}|| \\le 2$。为了数值稳定性，这个条件必须对所有可能的傅里叶模式成立，因此必须对 $|\\boldsymbol{\\kappa}|$ 的最大可能值成立。\n$$\nc \\Delta t \\max_{\\mathbf{k}}|\\boldsymbol{\\kappa}| \\le 2\n$$\n当每个正弦项都取最大值时，项 $|\\boldsymbol{\\kappa}|^2 = \\left(\\frac{2}{\\Delta x}\\sin\\frac{k_x \\Delta x}{2}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\sin\\frac{k_y \\Delta y}{2}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\sin\\frac{k_z \\Delta z}{2}\\right)^2$ 达到最大值。$k_x \\Delta x/2$ 的范围是 $[-\\pi/2, \\pi/2]$，所以 $\\sin^2(k_x \\Delta x/2)$ 的最大值是 1。$|\\boldsymbol{\\kappa}|$ 的最大值是：\n$$\n\\max|\\boldsymbol{\\kappa}| = \\sqrt{\\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2} = 2\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\n$$\n将此代入稳定性条件：\n$$\nc \\Delta t \\left( 2\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}} \\right) \\le 2\n$$\n这简化为三维 Yee 格式的 Courant–Friedrichs–Lewy (CFL) 条件：\n$$\n\\Delta t \\le \\frac{1}{c\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n这就成功地推导出了问题中要求的第一个表达式。现在，我们必须找到最大的常数 $\\alpha$，使得对于任意一组正的网格间距 $\\Delta x, \\Delta y, \\Delta z$，以下不等式都成立：\n$$\n\\Delta t \\le \\alpha \\frac{\\min(\\Delta x, \\Delta y, \\Delta z)}{c}\n$$\n结合这两个不等式，我们必须有：\n$$\n\\alpha \\frac{\\min(\\Delta x, \\Delta y, \\Delta z)}{c} \\le \\frac{1}{c\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n这意味着 $\\alpha$ 必须满足：\n$$\n\\alpha \\le \\frac{1}{\\min(\\Delta x, \\Delta y, \\Delta z) \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n为使该界限在所有矩形网格上一致成立，$\\alpha$ 必须小于或等于右侧表达式在所有可能的 $\\Delta x, \\Delta y, \\Delta z  0$ 上取到的最小值。我们需要找到：\n$$\n\\alpha_{\\max} = \\min_{\\Delta x, \\Delta y, \\Delta z  0} \\frac{1}{\\min(\\Delta x, \\Delta y, \\Delta z) \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n我们来分析分母中的项。令 $\\delta_{\\min} = \\min(\\Delta x, \\Delta y, \\Delta z)$。该项可以写成 $\\sqrt{\\delta_{\\min}^2 \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}$。为了找到整个表达式的最小值，我们必须找到这个分母项的最大值。不失一般性，令 $\\delta_{\\min} = \\Delta z$。那么 $\\Delta x \\ge \\Delta z$ 且 $\\Delta y \\ge \\Delta z$。平方根内的表达式变为：\n$$\n\\frac{\\Delta z^2}{\\Delta x^2} + \\frac{\\Delta z^2}{\\Delta y^2} + 1\n$$\n由于 $\\Delta z/\\Delta x \\le 1$ 且 $\\Delta z/\\Delta y \\le 1$，这两个比值在等于 1 时达到最大，这发生在 $\\Delta x = \\Delta z$ 且 $\\Delta y = \\Delta z$ 时。这对应于一个各向同性的网格，其中 $\\Delta x = \\Delta y = \\Delta z$。在这种情况下，平方根内的表达式达到其最大值：$1^2 + 1^2 + 1 = 3$。\n因此，分母项的最大值是 $\\sqrt{3}$。所以，整个关于 $\\alpha$ 的表达式的最小值是 $1/\\sqrt{3}$。因此，最大允许常数 $\\alpha$ 是 $1/\\sqrt{3}$。对于任何各向异性的网格，右侧的值都会更大，因此使用 $\\alpha=1/\\sqrt{3}$ 的条件仍然成立。\n\n最终答案是这个常数 $\\alpha$ 的值。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{3}}}$$", "id": "3293251"}, {"introduction": "与波的传播不同，抛物型偏微分方程模拟的是扩散过程，其物理行为和数值约束都截然不同。通过磁准静态涡流这个例子，您将看到抛物型分类如何导出一个稳定性条件，其中时间步长与网格间距的平方 $h^2$ 成正比 [@problem_id:3293219]。这项练习突显了偏微分方程分类在选择和分析恰当高效的数值算法时的关键重要性。", "problem": "考虑一个无源、均匀、各向同性的导电区域，其磁导率 $\\mu$ 和电导率 $\\sigma$ 为常数，该区域由磁准静态（涡流）近似下的麦克斯韦方程组所描述。引入磁矢量势 $\\mathbf{A}$，其定义为 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，采用库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，并假设在 $d$ 维环面（$d \\in \\{1,2,3\\}$）上采用周期性边界条件。从基本定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$（其中 $\\mathbf{J} = \\sigma \\mathbf{E}$ 和 $\\mathbf{B} = \\mu \\mathbf{H}$）以及法拉第定律 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$ 出发，证明在此设定下，$\\mathbf{A}$ 的每个笛卡尔分量都满足一个扩散型偏微分方程（PDE），并由此通过其主部确定其为抛物线型。\n\n使用网格尺寸为 $h$ 的均匀笛卡尔网格，并采用拉普拉斯算子的标准二阶中心差分近似（在 $d=1$ 时为 $3$ 点模板，在 $d=2$ 时为 $5$ 点模板，在 $d=3$ 时为 $7$ 点模板）对每个分量进行离散化。使用显式前向欧拉法进行时间推进。利用傅里叶模态进行 von Neumann 分析，以确定当 $h \\to 0$ 时，在时间更新公式中与解相乘的半离散算子的最大模特征值的渐近标度，并由此推导出最大线性稳定时间步长 $\\Delta t_{\\max}$ 作为 $h$、$\\mu$、$\\sigma$ 和 $d$ 的函数。\n\n你的最终答案必须是 $\\Delta t_{\\max}$ 的单个闭式表达式，以秒为单位，用 $h$、$\\mu$、$\\sigma$ 和 $d$ 表示。不要引入任何额外的参数。不要提供不等式；只报告从线性稳定性极限获得的临界值 $\\Delta t_{\\max}$。不需要数值。", "solution": "我们从均匀、各向同性导体中麦克斯韦方程组的磁准静态形式开始。忽略位移电流的安培定律为 $\\nabla \\times \\mathbf{H} = \\mathbf{J}$，其中欧姆定律为 $\\mathbf{J} = \\sigma \\mathbf{E}$。法拉第定律为 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$。本构关系为 $\\mathbf{B} = \\mu \\mathbf{H}$。通过 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 引入磁矢量势 $\\mathbf{A}$。选择库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$ 和周期性边界条件，这样标量电势可以取为常数，从而对于环面上的无源情况，有 $\\mathbf{E} = -\\partial \\mathbf{A}/\\partial t$。\n\n将 $\\mathbf{E} = -\\partial \\mathbf{A}/\\partial t$ 代入欧姆定律，得到 $\\mathbf{J} = -\\sigma \\,\\partial \\mathbf{A}/\\partial t$。在安培定律中使用 $\\mathbf{H} = \\mathbf{B}/\\mu = (\\nabla \\times \\mathbf{A})/\\mu$，我们得到\n$$\n\\nabla \\times \\left(\\frac{1}{\\mu}\\nabla \\times \\mathbf{A}\\right) \\;=\\; -\\sigma \\,\\frac{\\partial \\mathbf{A}}{\\partial t}.\n$$\n当 $\\mu$ 为常数时，使用矢量恒等式 $\\nabla \\times \\nabla \\times \\mathbf{A} = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^{2}\\mathbf{A}$，并利用 $\\nabla \\cdot \\mathbf{A} = 0$，上式简化为\n$$\n\\frac{\\partial \\mathbf{A}}{\\partial t} \\;=\\; \\frac{1}{\\mu \\sigma}\\,\\nabla^{2}\\mathbf{A}.\n$$\n因此，$\\mathbf{A}$ 的每个笛卡尔分量都满足扩散方程 $\\partial A_{i}/\\partial t = \\kappa \\nabla^{2} A_{i}$，其中扩散系数为 $\\kappa = 1/(\\mu \\sigma)$。这个主部（时间上一阶，空间上二阶，带有一个一致椭圆空间算子）确定了该偏微分方程为抛物线型。\n\n为了研究其数值含义，我们考虑一个在 $d$ 个空间维度上间距为 $h$ 的均匀笛卡尔网格，并用标准的二阶中心差分拉普拉斯算子来近似 $\\nabla^{2}$。令 $U(t)$ 表示单个分量的网格函数。半离散系统为\n$$\n\\frac{\\mathrm{d}U}{\\mathrm{d}t} \\;=\\; \\kappa\\,L_{h}\\,U,\n$$\n其中 $L_{h}$ 是离散拉普拉斯算子。在周期性边界条件下，通过代入一个傅里叶模态 $U(\\mathbf{x},t) = \\hat{U}(t)\\,\\exp\\!\\big(i\\,\\mathbf{k}\\cdot \\mathbf{x}\\big)$（波矢为 $\\mathbf{k} = (k_{1},\\dots,k_{d})$）来进行 von Neumann 分析。离散拉普拉斯算子的符号为\n$$\n\\lambda_{h}(\\mathbf{k}) \\;=\\; \\frac{2}{h^{2}}\\,\\sum_{j=1}^{d}\\big(\\cos(k_{j}h)-1\\big) \\;=\\; -\\frac{4}{h^{2}}\\,\\sum_{j=1}^{d}\\sin^{2}\\!\\Big(\\frac{k_{j}h}{2}\\Big),\n$$\n所以半离散特征值为 $\\kappa\\,\\lambda_{h}(\\mathbf{k}) \\le 0$。当每个 $\\sin^{2}\\!\\big(\\frac{k_{j}h}{2}\\big)$ 都达到其最大值 $1$ 时，特征值的模达到最大，得到\n$$\n\\max_{\\mathbf{k}}\\big|\\lambda_{h}(\\mathbf{k})\\big| \\;=\\; \\frac{4d}{h^{2}}, \\qquad\n\\max_{\\mathbf{k}}\\big|\\kappa\\,\\lambda_{h}(\\mathbf{k})\\big| \\;=\\; \\kappa\\,\\frac{4d}{h^{2}} \\;=\\; \\frac{4d}{\\mu \\sigma\\,h^{2}}.\n$$\n\n应用显式前向欧拉法对线性常系数系统 $\\mathrm{d}U/\\mathrm{d}t = \\kappa L_{h} U$ 进行时间推进：\n$$\nU^{n+1} \\;=\\; U^{n} \\;+\\; \\Delta t\\,\\kappa\\,L_{h}\\,U^{n}.\n$$\n对于一个特征值为 $\\kappa\\,\\lambda_{h}(\\mathbf{k})$ 的标量模态，其放大因子为\n$$\nG(\\mathbf{k}) \\;=\\; 1 \\;+\\; \\Delta t\\,\\kappa\\,\\lambda_{h}(\\mathbf{k}).\n$$\n前向欧拉法的线性稳定性要求对所有 $\\mathbf{k}$ 都有 $|G(\\mathbf{k})| \\le 1$。由于 $\\kappa\\,\\lambda_{h}(\\mathbf{k}) \\le 0$，最严格的条件出现在最负的特征值处，给出\n$$\n-2 \\;\\le\\; \\Delta t\\,\\kappa\\,\\lambda_{h,\\min} \\;\\le\\; 0\n\\;\\;\\Longrightarrow\\;\\;\n\\Delta t \\;\\le\\; \\frac{2}{\\big|\\kappa\\,\\lambda_{h,\\min}\\big|}.\n$$\n使用 $\\big|\\kappa\\,\\lambda_{h,\\min}\\big| = \\kappa\\,(4d/h^{2})$，我们得出结论\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{\\kappa\\,(4d/h^{2})}\n\\;=\\; \\frac{h^{2}}{2d\\,\\kappa}\n\\;=\\; \\frac{\\mu\\,\\sigma\\,h^{2}}{2d}.\n$$\n\n这个结果也反映了从有限元视角看，由抛物线型分类所蕴含的刚度谱标度关系。在尺寸为 $h$ 的准均匀网格上进行最低阶协调离散化时，旋度-旋度刚度矩阵 $K$ 的标度为 $(1/\\mu)\\,h^{d-2}$，质量矩阵 $M$ 的标度为 $\\sigma\\,h^{d}$，因此 $M^{-1}K$ 的谱的标度类似于 $(1/(\\mu \\sigma))\\,h^{-2}$，并且在带有二阶拉普拉斯算子的笛卡尔网格上，其精确常数为 $4d$。因此，显式时间步长限制为 $\\Delta t_{\\max} = 2/\\rho(M^{-1}K) = \\mu \\sigma h^{2}/(2d)$，这与 von Neumann 分析的结果一致。\n\n因此，最大线性稳定显式时间步长与 $h$ 呈二次方关系，其闭式表达式为 $\\Delta t_{\\max} = \\mu \\sigma h^{2}/(2d)$，单位为秒。", "answer": "$$\\boxed{\\frac{\\mu\\,\\sigma\\,h^{2}}{2\\,d}}$$", "id": "3293219"}]}