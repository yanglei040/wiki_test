{"hands_on_practices": [{"introduction": "为了真正理解完美匹配层（PML）为何有效，我们首先通过一个思想实验来探究一个常见的概念误区。本练习将揭示为何 PML 并不仅仅是一个简单的有耗介质，而是需要一种特殊的各向异性结构才能实现无反射特性。通过计算一个错误设计的吸收层所产生的反射，我们将深刻体会到阻抗匹配在PML设计中的核心作用。[@problem_id:3339585]", "problem": "考虑一个用于计算电磁学（CEM）中有限元法（FEM）的二维横电（TE）构型，其中一个完美匹配层（PML）用于截断一个无界域。物理空间被位于 $x=0$ 的平面分界面分割成两个均匀半空间。区域 $x0$ 是自由空间，其介电常数为 $\\epsilon_{0}$，磁导率为 $\\mu_{0}$。区域 $x>0$ 是通过在 $x$ 方向上进行一维坐标拉伸（拉伸因子为恒定复数 $s$）构建的，以形成一种理想情况下应为完美匹配的材料。根据麦克斯韦方程在坐标变换下的不变性，正确的构建方法应该同时变换介电常数和磁导率。然而，在本题中，我们将考虑一个具体的反例，其中只变换介电常数，而不变换磁导率。\n\n具体来说，取恒定拉伸因子 $s=2$，并定义 $x>0$ 区域的材料本构参数为 $\\epsilon_{2}=\\epsilon_{0}/s$ 和 $\\mu_{2}=\\mu_{0}$（即，只变换 $\\epsilon$，而 $\\mu$ 保持不变）。一束角频率为 $\\omega$ 的时谐平面波从 $x0$ 区域正入射到 $x=0$ 处的分界面上，电场沿 $\\hat{\\mathbf{y}}$ 方向极化，磁场沿 $\\hat{\\mathbf{z}}$ 方向极化。\n\n使用麦克斯韦方程、平面分界面处的边界条件以及均匀各向同性介质中平面波阻抗的定义，推导 $x=0$ 处切向电场振幅的反射系数。然后，针对指定的反例（$s=2$，$\\epsilon_{2}=\\epsilon_{0}/s$，$\\mu_{2}=\\mu_{0}$）计算该反射系数的值。\n\n最终答案以无量纲数表示。将您的答案四舍五入到四位有效数字。", "solution": "题目陈述经评估为有效。它基于Maxwell电磁理论，具有科学依据，并且问题是适定的，提供了足够的信息来确定唯一解，陈述客观。该问题提出了一个波传播中的标准边值问题，而分析具有错误变换的本构关系的材料这一前提是计算电磁学中一个有效且有启发性的练习。\n\n问题考虑的是时谐平面波，其场量具有时间依赖关系 $\\exp(j\\omega t)$，此处已省略。波正入射到 $x=0$ 的分界面上。电场在 $\\hat{\\mathbf{y}}$ 方向极化，磁场在 $\\hat{\\mathbf{z}}$ 方向极化。因此，场可以写为 $\\mathbf{E} = E_y(x) \\hat{\\mathbf{y}}$ 和 $\\mathbf{H} = H_z(x) \\hat{\\mathbf{z}}$。\n\n在无源、均匀、各向同性的介质中，Maxwell旋度方程的相量形式为：\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon \\mathbf{E} $$\n对于给定的场构型，这些方程得以简化。$\\mathbf{E}$ 的旋度为 $\\nabla \\times \\mathbf{E} = \\frac{\\partial E_y}{\\partial x} \\hat{\\mathbf{z}}$，$\\mathbf{H}$ 的旋度为 $\\nabla \\times \\mathbf{H} = -\\frac{\\partial H_z}{\\partial x} \\hat{\\mathbf{y}}$。Maxwell方程简化为一个耦合常微分方程组：\n$$ \\frac{dE_y}{dx} = -j\\omega\\mu H_z $$\n$$ \\frac{dH_z}{dx} = -j\\omega\\epsilon E_y $$\n将第一个方程对 $x$ 求导，并代入第二个方程，得到关于 $E_y$ 的一维亥姆霍兹方程：\n$$ \\frac{d^2E_y}{dx^2} = -j\\omega\\mu \\frac{dH_z}{dx} = -j\\omega\\mu(-j\\omega\\epsilon E_y) = -\\omega^2\\mu\\epsilon E_y $$\n$$ \\frac{d^2E_y}{dx^2} + k^2 E_y = 0 $$\n其中 $k = \\omega\\sqrt{\\mu\\epsilon}$ 是波数。\n\n在区域1（$x0$），介质是自由空间，参数为 $\\epsilon_1 = \\epsilon_0$ 和 $\\mu_1 = \\mu_0$。波数为 $k_1 = \\omega\\sqrt{\\mu_0\\epsilon_0}$。电场是沿 $+x$ 方向传播的入射波和沿 $-x$ 方向传播的反射波的叠加：\n$$ E_{y1}(x) = E_I \\exp(-jk_1 x) + E_R \\exp(jk_1 x) $$\n其中 $E_I$ 是入射波振幅，$E_R$ 是反射波振幅。相应的磁场为：\n$$ H_{z1}(x) = \\frac{j}{\\omega\\mu_1} \\frac{dE_{y1}}{dx} = \\frac{j}{\\omega\\mu_1} [-jk_1 E_I \\exp(-jk_1 x) + jk_1 E_R \\exp(jk_1 x)] = \\frac{k_1}{\\omega\\mu_1} [E_I \\exp(-jk_1 x) - E_R \\exp(jk_1 x)] $$\n区域1的本征阻抗为 $\\eta_1 = \\frac{\\omega\\mu_1}{k_1} = \\frac{\\omega\\mu_0}{\\omega\\sqrt{\\mu_0\\epsilon_0}} = \\sqrt{\\frac{\\mu_0}{\\epsilon_0}}$，即自由空间阻抗 $\\eta_0$。因此，\n$$ H_{z1}(x) = \\frac{1}{\\eta_1} [E_I \\exp(-jk_1 x) - E_R \\exp(jk_1 x)] $$\n\n在区域2（$x>0$），材料由 $\\epsilon_2 = \\epsilon_0/s$ 和 $\\mu_2 = \\mu_0$ 定义。波数为 $k_2 = \\omega\\sqrt{\\mu_2\\epsilon_2} = \\omega\\sqrt{\\mu_0(\\epsilon_0/s)} = \\frac{\\omega\\sqrt{\\mu_0\\epsilon_0}}{\\sqrt{s}} = \\frac{k_1}{\\sqrt{s}}$。此区域中的场是沿 $+x$ 方向传播的透射波：\n$$ E_{y2}(x) = E_T \\exp(-jk_2 x) $$\n其中 $E_T$ 是透射波振幅。相应的磁场为：\n$$ H_{z2}(x) = \\frac{k_2}{\\omega\\mu_2} E_T \\exp(-jk_2 x) = \\frac{1}{\\eta_2} E_T \\exp(-jk_2 x) $$\n区域2的本征阻抗为 $\\eta_2 = \\sqrt{\\frac{\\mu_2}{\\epsilon_2}} = \\sqrt{\\frac{\\mu_0}{\\epsilon_0/s}} = \\sqrt{s\\frac{\\mu_0}{\\epsilon_0}} = \\eta_1\\sqrt{s}$。\n\n在分界面 $x=0$ 处，电场和磁场的切向分量必须连续。\n$E_y$ 的连续性：$E_{y1}(0) = E_{y2}(0)$\n$$ E_I + E_R = E_T $$\n$H_z$ 的连续性：$H_{z1}(0) = H_{z2}(0)$\n$$ \\frac{1}{\\eta_1} [E_I - E_R] = \\frac{1}{\\eta_2} E_T $$\n我们现在有一个包含三个未知振幅的两个方程的方程组。反射系数 $\\Gamma$ 定义为反射电场振幅与入射电场振幅之比，即 $\\Gamma = E_R/E_I$。为了求得 $\\Gamma$，我们消去 $E_T$。由第一个方程得 $E_T = E_I + E_R$。将其代入第二个方程：\n$$ \\frac{1}{\\eta_1} [E_I - E_R] = \\frac{1}{\\eta_2} [E_I + E_R] $$\n整理各项以求解比值 $E_R/E_I$：\n$$ \\eta_2 [E_I - E_R] = \\eta_1 [E_I + E_R] $$\n$$ E_I(\\eta_2 - \\eta_1) = E_R(\\eta_1 + \\eta_2) $$\n$$ \\Gamma = \\frac{E_R}{E_I} = \\frac{\\eta_2 - \\eta_1}{\\eta_2 + \\eta_1} $$\n这就是正入射时反射系数的通用表达式。\n\n现在，我们将本问题的具体阻抗值代入：$\\eta_1 = \\eta_0$ 和 $\\eta_2 = \\eta_0\\sqrt{s}$。\n$$ \\Gamma = \\frac{\\eta_0\\sqrt{s} - \\eta_0}{\\eta_0\\sqrt{s} + \\eta_0} = \\frac{\\eta_0(\\sqrt{s} - 1)}{\\eta_0(\\sqrt{s} + 1)} = \\frac{\\sqrt{s} - 1}{\\sqrt{s} + 1} $$\n题目指定了拉伸因子 $s=2$。将此值代入 $\\Gamma$ 的表达式中：\n$$ \\Gamma = \\frac{\\sqrt{2} - 1}{\\sqrt{2} + 1} $$\n为了获得数值，我们可以先将表达式有理化：\n$$ \\Gamma = \\left(\\frac{\\sqrt{2} - 1}{\\sqrt{2} + 1}\\right) \\left(\\frac{\\sqrt{2} - 1}{\\sqrt{2} - 1}\\right) = \\frac{(\\sqrt{2} - 1)^2}{(\\sqrt{2})^2 - 1^2} = \\frac{2 - 2\\sqrt{2} + 1}{2 - 1} = 3 - 2\\sqrt{2} $$\n使用近似值 $\\sqrt{2} \\approx 1.41421356$：\n$$ \\Gamma \\approx 3 - 2(1.41421356) = 3 - 2.82842712 = 0.17157288 $$\n将结果四舍五入到四位有效数字，我们得到 $0.1716$。非零的反射系数证实了这种未变换磁导率的材料构造与自由空间并非完美匹配，这与预期相符。", "answer": "$$\\boxed{0.1716}$$", "id": "3339585"}, {"introduction": "在理解了阻抗匹配的必要性之后，我们接下来转向如何设计PML的衰减特性。本练习将引导你完成一项基本推导，即如何根据给定的PML厚度、多项式阶数和目标反射水平，计算出所需的最大电导率 $\\sigma_{\\max}$。这个计算是所有实用PML设计的基础，掌握它将为你提供一个关键的分析工具。[@problem_id:3339737]", "problem": "考虑在有限元法（FEM）中，使用完美匹配层（PML）对一个均匀、各向同性的电磁域进行一维截断。物理域占据 $x  0$ 的空间，其材料参数为介电常数 $\\epsilon$ 和磁导率 $\\mu$。在 $x \\geq 0$ 处，该域被厚度为 $L$ 的单轴PML截断。假设时谐场的时间变化约定为 $\\exp(j \\omega t)$，且平面波从 $x  0$ 法向入射到PML中。设物理域的特性阻抗为 $\\eta_{0} = \\sqrt{\\mu / \\epsilon}$，其波数为 $k_{0} = \\omega \\sqrt{\\mu \\epsilon}$。\n\nPML通过在 $x$ 方向上进行复坐标伸展实现，其伸展函数为 $s_{x}(x) = 1 + \\frac{\\sigma(x)}{j \\omega \\epsilon}$，其中标量电导率在其厚度上按 $m \\in \\mathbb{N}$ 阶多项式分级：\n$$\n\\sigma(x) = \\sigma_{\\max} \\left( \\frac{x}{L} \\right)^{m}, \\quad x \\in [0, L].\n$$\n假设 $s_{x}$ 是唯一的非平凡伸展（即 $\\kappa_{x} = 1$ 且无辅助损耗项），并且PML在 $x = L$ 处由理想电导体终端。在这些假设下，位于 $x = 0$ 处的入射界面是完美匹配的，任何在物理域中测量到的反射都仅源于衰减PML的有限厚度以及在 $x = L$ 处的终端。\n\n从物理域中的频域麦克斯韦旋度方程\n$$\n\\nabla \\times \\mathbf{H} = j \\omega \\epsilon \\mathbf{E}, \\qquad \\nabla \\times \\mathbf{E} = - j \\omega \\mu \\mathbf{H},\n$$\n以及复坐标伸展对一维平面波解的影响出发，推导出一个闭式解析表达式，用于计算 $\\sigma_{\\max}$，使得在 $x = 0$ 处达到一个指定的目标振幅反射因子 $R$（其中 $0  R  1$）。你的结果必须仅用 $m$、$R$、$\\eta_{0}$ 和 $L$ 表示。不要引入任何其他参数。请提供 $\\sigma_{\\max}$ 的最终表达式作为答案。无需进行数值计算，最终表达式中也不应包含单位。", "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确且客观，是计算电磁学中一个标准的理论问题。我们开始推导 $\\sigma_{\\max}$ 的表达式。\n\n该问题考虑一个时间依赖关系为 $\\exp(j \\omega t)$ 的时谐平面波，从物理域 ($x0$) 法向入射到占据 $0 \\le x \\le L$ 区域的完美匹配层 (PML) 上。\n\n在物理域 ($x0$) 中，介质是均匀且各向同性的，其介电常数为 $\\epsilon$，磁导率为 $\\mu$。假设电场在 $y$ 方向极化，是入射波和反射波的叠加：\n$$\nE_y(x) = E_{inc} \\exp(-j k_0 x) + E_{ref} \\exp(j k_0 x)\n$$\n其中 $k_0 = \\omega \\sqrt{\\mu \\epsilon}$ 是波数。相应的磁场为：\n$$\nH_z(x) = \\frac{1}{\\eta_0} \\left( E_{inc} \\exp(-j k_0 x) - E_{ref} \\exp(j k_0 x) \\right)\n$$\n其中 $\\eta_0 = \\sqrt{\\mu / \\epsilon}$ 是介质的特性阻抗。在界面 $x=0$ 处的反射系数定义为 $\\Gamma = E_{ref} / E_{inc}$。\n\n在PML内部 ($0 \\le x \\le L$)，我们采用基于复坐标伸展的单轴PML公式。伸展函数为 $s_x(x) = 1 + \\frac{\\sigma(x)}{j \\omega \\epsilon}$。这会修改沿 $x$ 方向传播的平面波的麦克斯韦方程组。相关的旋度方程变为：\n$$\n\\frac{\\partial E_y}{\\partial x} = -j \\omega \\mu s_x(x) H_z\n$$\n$$\n\\frac{\\partial H_z}{\\partial x} = -j \\omega \\epsilon s_x(x) E_y\n$$\n将这两个一阶方程联立，得到关于 $E_y(x)$ 的二阶波动方程：\n$$\n\\frac{\\partial^2 E_y}{\\partial x^2} - \\frac{1}{s_x(x)} \\frac{\\partial s_x(x)}{\\partial x} \\frac{\\partial E_y}{\\partial x} + k_0^2 [s_x(x)]^2 E_y = 0\n$$\n该方程的精确通解由一个前向传播波和一个后向传播波的叠加给出：\n$$\nE_y(x) = A \\exp(-j k_0 \\phi(x)) + B \\exp(j k_0 \\phi(x))\n$$\n其中 $\\phi(x)$ 是复相位积分：\n$$\n\\phi(x) = \\int_0^x s_x(u) \\, du\n$$\nPML内部相应的磁场可以通过 $H_z = \\frac{j}{\\omega \\mu s_x} \\frac{\\partial E_y}{\\partial x}$ 求得：\n$$\nH_z(x) = \\frac{1}{\\eta_0} \\left( A \\exp(-j k_0 \\phi(x)) - B \\exp(j k_0 \\phi(x)) \\right)\n$$\n这个结果表明，局部波阻抗在整个PML中保持为 $\\eta_0$，这就是“完美匹配”的特性。\n\n我们首先使用给定的电导率分布 $\\sigma(x) = \\sigma_{\\max} (x/L)^m$ 来计算相位积分 $\\phi(x)$：\n$$\ns_x(u) = 1 + \\frac{\\sigma_{\\max} (u/L)^m}{j \\omega \\epsilon} = 1 - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} u^m\n$$\n从 $0$ 积分到 $x$：\n$$\n\\phi(x) = \\int_0^x \\left( 1 - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} u^m \\right) du = x - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} \\frac{x^{m+1}}{m+1}\n$$\n接下来，我们应用边界条件。\n在PML的后端 $x=L$ 处，有一个理想电导体 (PEC)，因此总的切向电场必须为零：\n$$\nE_y(L) = A \\exp(-j k_0 \\phi(L)) + B \\exp(j k_0 \\phi(L)) = 0\n$$\n这给出了系数 $A$ 和 $B$ 之间的一个关系：\n$$\nB = -A \\exp(-2 j k_0 \\phi(L))\n$$\n在界面 $x=0$ 处，切向电场和磁场必须连续。通过将入射波振幅归一化为 $E_{inc}=1$，我们得到 $E_{ref} = \\Gamma$。\n$x=0$ 处 $E_y$ 的连续性：\n$$\nE_y(0^-) = 1 + \\Gamma \\quad \\text{和} \\quad E_y(0^+) = A \\exp(0) + B \\exp(0) = A+B\n$$\n$$\n1 + \\Gamma = A + B\n$$\n$x=0$ 处 $H_z$ 的连续性：\n$$\nH_z(0^-) = \\frac{1}{\\eta_0}(1 - \\Gamma) \\quad \\text{和} \\quad H_z(0^+) = \\frac{1}{\\eta_0}(A - B)\n$$\n$$\n1 - \\Gamma = A - B\n$$\n求解这两个界面方程得到 $A=1$ 和 $B=\\Gamma$。将这些代入由PEC边界条件得到的关系式中，得出反射系数 $\\Gamma$：\n$$\n\\Gamma = -(1) \\exp(-2 j k_0 \\phi(L)) = -\\exp(-2 j k_0 \\phi(L))\n$$\n问题指定了一个目标振幅反射因子 $R = |\\Gamma|$。因此，我们取其模值：\n$$\nR = |-\\exp(-2 j k_0 \\phi(L))| = |\\exp(\\text{Re}\\{-2 j k_0 \\phi(L)\\}) \\exp(j \\cdot \\text{Im}\\{-2 j k_0 \\phi(L)\\})|\n$$\n$R = \\exp(\\text{Re}\\{-2 j k_0 \\phi(L)\\})$。\n我们来计算指数的参数。首先，我们求 $\\phi(L)$：\n$$\n\\phi(L) = L - j \\frac{\\sigma_{\\max}}{\\omega \\epsilon L^m} \\frac{L^{m+1}}{m+1} = L - j \\frac{\\sigma_{\\max} L}{\\omega \\epsilon (m+1)}\n$$\n现在，我们计算指数项 $-2 j k_0 \\phi(L)$：\n$$\n-2 j k_0 \\phi(L) = -2 j k_0 \\left( L - j \\frac{\\sigma_{\\max} L}{\\omega \\epsilon (m+1)} \\right) = -2 j k_0 L - \\frac{2 k_0 \\sigma_{\\max} L}{\\omega \\epsilon (m+1)}\n$$\n我们使用关系式 $k_0 = \\omega\\sqrt{\\mu\\epsilon}$ 和 $\\eta_0 = \\sqrt{\\mu/\\epsilon}$ 来简化第二项：\n$$\n\\frac{k_0}{\\omega \\epsilon} = \\frac{\\omega\\sqrt{\\mu\\epsilon}}{\\omega\\epsilon} = \\sqrt{\\frac{\\mu}{\\epsilon}} = \\eta_0\n$$\n指数项变为：\n$$\n-2 j k_0 \\phi(L) = -2 j k_0 L - \\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\n该指数的实部决定了振幅的衰减：\n$$\n\\text{Re}\\{-2 j k_0 \\phi(L)\\} = -\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\n因此，振幅反射因子 $R$ 为：\n$$\nR = \\exp\\left(-\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\\right)\n$$\n最后，我们求解这个方程以得到 $\\sigma_{\\max}$。对两边取自然对数：\n$$\n\\ln(R) = -\\frac{2 \\eta_0 \\sigma_{\\max} L}{m+1}\n$$\n由于问题陈述 $0  R  1$，$\\ln(R)$ 为负，这确保了 $\\sigma_{\\max}$ 为正。整理方程求解 $\\sigma_{\\max}$：\n$$\n\\sigma_{\\max} = -\\frac{(m+1) \\ln(R)}{2 \\eta_0 L}\n$$\n该表达式根据多项式阶数 $m$、目标反射 $R$、特性阻抗 $\\eta_0$ 和PML厚度 $L$ 给出了所要求的最大电导率 $\\sigma_{\\max}$，符合题目要求。", "answer": "$$\n\\boxed{-\\frac{(m+1) \\ln(R)}{2 \\eta_{0} L}}\n$$", "id": "3339737"}, {"introduction": "理想的解析公式在应用于实际的数值模拟时，必须考虑离散化带来的限制。这个高级实践将带你应对一个极具挑战性的场景：掠射角入射，在该情况下标准PML的性能会严重下降。通过构建一个包含有限元（FEM）离散化约束的基准测试，你将学会如何在理论衰减需求与数值分辨率限制之间进行权衡。[@problem_id:3339573]", "problem": "考虑一个在均匀、各向同性、无损介质中的时谐电磁平面波，其角频率为 $\\omega$，自由空间波数为 $k = 2\\pi/\\lambda$，其中 $\\lambda$ 是以米为单位表示的波长。该波向一个截断边界传播，该边界将由一个完美匹配层（PML）来终止，该PML通过有限元法（FEM）实现。波以相对于边界面法线测量的掠射入射角 $\\theta = 89.9^\\circ$ 入射到PML上（角度单位使用度）。PML沿着边界面法线坐标 $x$ 应用，并通过形式为 $s_x(x) = 1 + i a(x)$ 的复坐标伸展进行建模，其中 $a(x)$ 是一个非负衰减剖面。假设采用一个标准的多项式渐变衰减剖面 $a(x) = a_{\\max}(x/L)^m$，其中PML厚度 $L$ 以米为单位，最大衰减参数 $a_{\\max} > 0$，多项式阶数 $m \\in \\mathbb{N}$。PML厚度 $L$ 的选择应使得入口平面的往返反射振幅小于目标水平 $R_{\\text{target}} = 10^{-6}$。\n\n请将您的推导建立在以下基本原则之上：\n- 无损均匀介质中的麦克斯韦方程组，其导出色散关系为 $|\\mathbf{k}| = k$ 的平面波解，以及边界面法向波数分量 $k_n = k\\cos\\theta$ 的定义。\n- 完美匹配层（PML）作为边界面法线方向上的复坐标伸展的概念性定义，以及由此产生的、由边界面法向波分量所经历的伸展后波数的虚部决定的指数衰减。\n- 有限元法（FEM）离散化，其中PML区域的多项式阶次为 $p$，单元尺寸为 $h$（米），这意味着对每个自由度的相位变化和振幅衰减都存在分辨率约束。\n\n除了连续衰减要求外，为了数值上的真实性，额外施加以下有限元分辨率约束：\n- 相位分辨率约束：每个有效自由度的边界面法向相位推进必须满足 $k_n \\Delta x \\le \\varphi_{\\max}$，其中 $\\Delta x = h/p$ 且 $\\varphi_{\\max} = 0.5$ 弧度。\n- 衰减分辨率约束：每个有效自由度的边界面法向振幅衰减必须满足 $\\operatorname{Im}(k_n s_x)\\Delta x \\le \\delta_{\\max}$，其中 $\\delta_{\\max} = 0.3$（无量纲），且 $\\operatorname{Im}(k_n s_x) = k_n a(x)$。\n\n假设标称设计选择为 $a_{\\max} = 1.0$，除非衰减分辨率约束强制一个更严格的上限。您必须确定：\n1. 在忽略离散化限制但使用指定的 $a(x)$ 剖面的情况下，实现 $R_{\\text{target}}$ 的最小连续厚度估计值 $L_{\\text{cont}}(\\theta)$。\n2. 在遵守相位和衰减分辨率约束的情况下，实现 $R_{\\text{target}}$ 的最小有限元约束厚度 $L_{\\text{fem}}(\\theta)$，并将后者视为 $a_{\\max}$ 的一个上限。如果最终得到的 $L_{\\text{fem}}$ 小于单个PML单元的厚度 $h$，则设 $L_{\\text{fem}} = h$ 以至少保留一个PML单元。\n\n您的程序必须为以下测试套件中的各种情况计算 $L_{\\text{fem}}$ 和 $L_{\\text{cont}}$（所有长度单位为米，角度单位为度，输出厚度单位为米）：\n- 情况1（理想路径）：$\\lambda = 0.01$，$p = 4$，$h = 0.001$，$m = 3$，$\\theta = 89.9^\\circ$。\n- 情况2（衰减限制边缘情况）：$\\lambda = 0.001$，$p = 3$，$h = 0.002$，$m = 3$，$\\theta = 89.9^\\circ$。\n- 情况3（中间状态）：$\\lambda = 0.002$，$p = 10$，$h = 0.005$，$m = 3$，$\\theta = 89.9^\\circ$。\n- 情况4（细网格边界）：$\\lambda = 0.01$，$p = 8$，$h = 0.0002$，$m = 3$，$\\theta = 89.9^\\circ$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[L_{\\text{fem},1},L_{\\text{cont},1},L_{\\text{fem},2},L_{\\text{cont},2},L_{\\text{fem},3},L_{\\text{cont},3},L_{\\text{fem},4},L_{\\text{cont},4}]$，每个厚度均以米表示。在计算 $\\cos\\theta$ 时，角度必须按度来解释。使用 $R_{\\text{target}} = 10^{-6}$ 和 $a_{\\max} = 1.0$，除非衰减分辨率约束使其减小。", "solution": "我们从无源、均匀、各向同性的介质中的麦克斯韦方程组开始，对于角频率为 $\\omega$ 的时谐场，可以得到平面波解。令 $\\mathbf{k}$ 表示波矢量，其大小为 $k = 2\\pi/\\lambda$，其中 $\\lambda$ 是波长。考虑一个外法线沿 $x$ 轴的平面截断边界。一个以相对于边界面法线角度 $\\theta$ 入射的平面波，其边界面法向波数分量为 $k_n = k\\cos\\theta$。在掠射入射角 $\\theta = 89.9^\\circ$ 时，$\\cos\\theta$ 很小，因此 $k_n$ 也很小。\n\n完美匹配层 (PML) 可被视为边界面法线方向上的复坐标伸展，即 $x \\mapsto \\bar{x}$，伸展因子为 $s_x(x) = 1 + i a(x)$，其中 $a(x) \\ge 0$。在此变换下，波数的边界面法向分量变为 $k_n s_x(x) = k_n \\left(1 + i a(x)\\right)$，其虚部 $\\operatorname{Im}\\left(k_n s_x(x)\\right) = k_n a(x)$ 会产生沿 $x$ 方向的指数级振幅衰减。对于一条从 $x=0$ 到 $x=L$ 穿过PML并在终端反射的射线，其在入口平面处的往返振幅反射的一个领头阶估计由累积衰减 $A$ 决定，其中\n$$\nA \\equiv \\int_0^L \\operatorname{Im}\\left(k_n s_x(x)\\right)\\,\\mathrm{d}x \\;=\\; \\int_0^L k_n\\,a(x)\\,\\mathrm{d}x \\;=\\; k_n \\int_0^L a(x)\\,\\mathrm{d}x.\n$$\n假设由于完美匹配，入口处的失配可以忽略不计，则往返反射振幅的标度关系如下\n$$\nR \\approx \\exp\\!\\left(-2A\\right).\n$$\n为强制要求 $R \\le R_{\\text{target}}$，我们需要\n$$\n2A \\;\\ge\\; \\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right).\n$$\n\n我们选择一个标准的多项式衰减剖面 $a(x) = a_{\\max} (x/L)^m$，适用于 $x \\in [0,L]$，其中 $m \\in \\mathbb{N}$ 且 $a_{\\max} > 0$。$a(x)$ 在厚度上的积分为\n$$\n\\int_0^L a(x)\\,\\mathrm{d}x \\;=\\; a_{\\max} \\int_0^L \\left(\\frac{x}{L}\\right)^m \\mathrm{d}x \\;=\\; a_{\\max} \\,L \\int_0^1 t^m \\,\\mathrm{d}t \\;=\\; a_{\\max} \\,L \\,\\frac{1}{m+1}.\n$$\n因此，累积衰减变为\n$$\nA \\;=\\; k_n\\, a_{\\max}\\, \\frac{L}{m+1}.\n$$\n施加 $\\exp(-2A) \\le R_{\\text{target}}$ 的约束条件可得\n$$\n2\\,k_n\\, a_{\\max}\\, \\frac{L}{m+1} \\;\\ge\\; \\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right),\n$$\n因此，最小连续厚度估计值（忽略离散化限制）为\n$$\nL_{\\text{cont}}(\\theta) \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k_n} \\cdot \\frac{m+1}{a_{\\max}} \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k\\cos\\theta} \\cdot \\frac{m+1}{a_{\\max}}.\n$$\n\n在PML区域采用多项式阶次为 $p$、单元尺寸为 $h$ 的有限元法 (FEM) 离散化中，设有效自由度间距为 $\\Delta x = h/p$。数值精度对每个有效自由度的相位推进和衰减都施加了分辨率约束。我们强制要求：\n- 相位分辨率约束：\n$$\nk_n \\Delta x \\;\\le\\; \\varphi_{\\max},\n$$\n其中 $\\varphi_{\\max} = 0.5$ 弧度。该约束要求网格足够精细以解析边界面法向的振荡。在本基准问题中，所选的测试用例满足此界限，因此不单独基于相位对 $L$ 进行调整。\n- 衰减分辨率约束：\n$$\n\\operatorname{Im}\\!\\left(k_n s_x\\right)\\,\\Delta x \\;=\\; k_n\\,a(x)\\,\\Delta x \\;\\le\\; \\delta_{\\max},\n$$\n其中 $\\delta_{\\max} = 0.3$。因为 $a(x)$ 是单调递增的，最大值为 $a_{\\max}$，所以在 $x=L$ 处满足该约束可保证其在所有位置均被满足。这得出了一个关于 $a_{\\max}$ 的上界：\n$$\nk_n\\,a_{\\max}\\,\\Delta x \\;\\le\\; \\delta_{\\max}\n\\;\\;\\Rightarrow\\;\\;\na_{\\max} \\;\\le\\; \\frac{\\delta_{\\max}}{k_n\\,\\Delta x}\n\\;=\\; \\frac{\\delta_{\\max}\\,p}{k_n\\,h}.\n$$\n我们采用标称设计 $a_{\\max}^{\\text{nom}} = 1.0$，并通过定义以下方式来强制执行衰减分辨率约束：\n$$\na_{\\max}^{\\text{eff}} \\;=\\; \\min\\!\\left(a_{\\max}^{\\text{nom}}, \\frac{\\delta_{\\max}\\,p}{k_n\\,h}\\right).\n$$\n将 $a_{\\max}^{\\text{eff}}$ 代入连续厚度公式，得到有限元约束下的最小厚度\n$$\nL_{\\text{fem}}(\\theta) \\;=\\; \\frac{\\ln\\!\\left(\\frac{1}{R_{\\text{target}}}\\right)}{2\\,k\\cos\\theta} \\cdot \\frac{m+1}{a_{\\max}^{\\text{eff}}}.\n$$\n最后，为确保至少存在一个PML单元，我们强制要求\n$$\nL_{\\text{fem}} \\;\\leftarrow\\; \\max\\!\\left(L_{\\text{fem}},\\,h\\right).\n$$\n\n每个测试用例的算法步骤：\n1. 计算 $k = 2\\pi/\\lambda$ 和 $k_n = k \\cos\\theta$，其中 $\\theta$ 以度为单位。\n2. 设置 $a_{\\max}^{\\text{nom}} = 1.0$，$\\varphi_{\\max} = 0.5$ 弧度，以及 $\\delta_{\\max} = 0.3$。\n3. 计算 $\\Delta x = h/p$。验证 $k_n \\Delta x \\le \\varphi_{\\max}$（所提供的测试套件满足此条件）。\n4. 计算 $a_{\\max}^{\\text{eff}} = \\min\\!\\left(1.0, \\delta_{\\max} p/(k_n h)\\right)$。\n5. 计算 $L_{\\text{cont}} = \\ln(1/R_{\\text{target}})\\big/\\left(2 k_n\\right) \\cdot (m+1)/a_{\\max}^{\\text{nom}}$。\n6. 计算 $L_{\\text{fem}} = \\ln(1/R_{\\text{target}})\\big/\\left(2 k_n\\right) \\cdot (m+1)/a_{\\max}^{\\text{eff}}$，然后设置 $L_{\\text{fem}} \\leftarrow \\max(L_{\\text{fem}}, h)$。\n\n通过为每个测试用例报告 $L_{\\text{fem}}$ 和 $L_{\\text{cont}}$ 的值，来实现与解析估计的验证。当 $a_{\\max}^{\\text{eff}} = a_{\\max}^{\\text{nom}}$ 时，两者相等；否则，由于 $a_{\\max}$ 受到的衰减分辨率上限的限制，$L_{\\text{fem}} \\ge L_{\\text{cont}}$。在掠射入射角 $\\theta = 89.9^\\circ$ 时，因子 $\\cos\\theta$ 很小，因此连续估计和约束估计的厚度都可能很大，这突显了在没有额外技术（如复频率偏移）的情况下，标准PML在掠射入射条件下众所周知的困难。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_Ls(lambda_m, p, h, m, theta_deg, R_target=1e-6,\n               a_max_nom=1.0, delta_max=0.3, phi_max=0.5):\n    # Compute wavenumber and boundary-normal component\n    k = 2.0 * np.pi / lambda_m\n    theta_rad = np.deg2rad(theta_deg)\n    cos_theta = np.cos(theta_rad)\n    k_n = k * cos_theta\n\n    # Effective DOF spacing\n    dx = h / p\n\n    # Phase resolution check (not altering L, just for completeness)\n    # Ensure k_n * dx = phi_max; test cases are chosen to satisfy this.\n    # If violated, the FEM setup is under-resolved in phase.\n    # We proceed regardless but could flag or adjust in a more elaborate tool.\n\n    # Attenuation resolution constraint: k_n * a_max_eff * dx = delta_max\n    # => a_max_eff = delta_max / (k_n * dx) = delta_max * p / (k_n * h)\n    # Use nominal a_max unless limited by attenuation resolution.\n    # Handle extremely small k_n to avoid division by zero.\n    if k_n == 0.0:\n        # In pathological case (exact grazing or beyond), set huge L_fem and L_cont.\n        return float('inf'), float('inf')\n\n    a_lim = delta_max * p / (k_n * h)\n    a_max_eff = min(a_max_nom, a_lim)\n\n    # Continuous estimate with nominal a_max\n    L_cont = (np.log(1.0 / R_target) / (2.0 * k_n)) * ((m + 1) / a_max_nom)\n\n    # FEM-constrained estimate\n    L_fem = (np.log(1.0 / R_target) / (2.0 * k_n)) * ((m + 1) / a_max_eff)\n\n    # Ensure at least one PML element is present\n    L_fem = max(L_fem, h)\n\n    return L_fem, L_cont\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (lambda_m, p, h, m, theta_deg)\n    test_cases = [\n        (0.01, 4, 0.001, 3, 89.9),   # Case 1: happy path\n        (0.001, 3, 0.002, 3, 89.9),  # Case 2: attenuation-limited edge\n        (0.002, 10, 0.005, 3, 89.9), # Case 3: intermediate regime\n        (0.01, 8, 0.0002, 3, 89.9),  # Case 4: fine mesh boundary\n    ]\n\n    results = []\n    for lam, p, h, m, theta in test_cases:\n        L_fem, L_cont = compute_Ls(lam, p, h, m, theta)\n        results.append(L_fem)\n        results.append(L_cont)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3339573"}]}