{"hands_on_practices": [{"introduction": "理论知识通过实践得以巩固。本章提供了一系列动手实践，旨在加深您对电磁本征值问题核心概念的理解。第一个练习将探讨本征模的一个基本物理性质。虽然本征值问题确定了模式的形状和频率，但其振幅通常是任意的。通过将模式归一化到一个明确的物理量（例如总能量），我们为其赋予了具体的物理尺度，这对于模式展开等后续分析至关重要。这项实践将通过一个平面波的例子，带您亲手完成归一化计算，从而将抽象的数学解与具体的物理能量联系起来。", "problem": "考虑在均匀、各向同性、无损耗介质中的无源时谐麦克斯韦特征值问题。该介质具有恒定的介电常数 $\\epsilon0$ 和磁导率 $\\mu0$，并隐去时间依赖项 $\\exp(j \\omega t)$。区域 $\\Omega$ 是一个体积为 $V$ 的三维周期性盒子，因此在周期性边界条件下，平面波是容许的本征模。设 $\\mathbf{k} \\in \\mathbb{R}^{3}$ 且 $\\hat{\\mathbf{k}}=\\mathbf{k}/\\|\\mathbf{k}\\|$，并设 $\\mathbf{e}$ 为一个满足 $\\mathbf{k}\\cdot \\mathbf{e}=0$ 的恒定单位极化矢量。考虑本征模\n$$\n\\mathbf{E}(\\mathbf{r})=\\alpha\\,\\mathbf{e}\\,\\exp\\!\\big(j\\,\\mathbf{k}\\cdot \\mathbf{r}\\big),\\qquad \\mathbf{H}(\\mathbf{r})\\ \\text{由麦克斯韦方程组确定},\n$$\n其中 $\\|\\mathbf{k}\\|=\\omega\\sqrt{\\mu\\epsilon}$，从而满足色散关系。确定实非负标量 $\\alpha$，使得总时均电磁能量\n$$\n\\frac{1}{4}\\int_{\\Omega}\\big(\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2}\\big)\\,dV=1.\n$$\n请用仅包含 $\\epsilon$ 和 $V$ 的闭合形式表达 $\\alpha$ 的最终答案。不需要进行数值计算。\n\n然后，简要解释（无需进行任何计算）在 $\\epsilon$ 和/或 $\\mu$ 是复数且与频率相关的有损耗色散介质中，归一化是如何改变的，并至少说出一种在计算电磁学中用于此类非厄米特征值问题的数学上一致的归一化约定。你的解释应简洁且概念化；计分的最终答案仅为 $\\alpha$ 的值。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它描述了在周期性区域内无损耗均匀介质中电磁本征模的标准归一化过程。我们可以开始求解。\n\n问题要求确定一个实非负标量归一化常数 $\\alpha$，对于给定的平面波电场本征模，\n$$\n\\mathbf{E}(\\mathbf{r})=\\alpha\\,\\mathbf{e}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n使得在体积 $\\Omega$ 内的总时均电磁能量等于 $1$。归一化条件是\n$$\n\\frac{1}{4}\\int_{\\Omega}\\big(\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2}\\big)\\,dV=1\n$$\n介质是无损耗、均匀且各向同性的，具有介电常数 $\\epsilon0$ 和磁导率 $\\mu0$。矢量 $\\mathbf{e}$ 是一个单位极化矢量，$\\|\\mathbf{e}\\|=1$，并且它与波矢 $\\mathbf{k}$ 横向正交，即 $\\mathbf{k}\\cdot \\mathbf{e}=0$。\n\n首先，我们必须使用麦克斯韦方程组来确定与给定电场 $\\mathbf{E}(\\mathbf{r})$ 相对应的磁场 $\\mathbf{H}(\\mathbf{r})$。对于隐去时间依赖项 $\\exp(j \\omega t)$ 的时谐场，法拉第电磁感应定律为\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H}\n$$\n我们可以求解 $\\mathbf{H}$ 如下\n$$\n\\mathbf{H} = \\frac{1}{-j\\omega\\mu} (\\nabla \\times \\mathbf{E}) = \\frac{j}{\\omega\\mu} (\\nabla \\times \\mathbf{E})\n$$\n为了计算 $\\mathbf{E}$ 的旋度，我们应用矢量恒等式 $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + (\\nabla f) \\times \\mathbf{A}$。在本例中，$f(\\mathbf{r}) = \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})$ 且矢量 $\\mathbf{A} = \\alpha\\mathbf{e}$ 是常数。因此，$\\nabla \\times \\mathbf{A} = \\mathbf{0}$。$f$ 的梯度为 $\\nabla f = \\nabla \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r}) = j\\mathbf{k}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})$。\n因此，$\\mathbf{E}$ 的旋度为\n$$\n\\nabla \\times \\mathbf{E} = (\\nabla \\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})) \\times (\\alpha\\mathbf{e}) = (j\\mathbf{k}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})) \\times (\\alpha\\mathbf{e}) = j\\alpha(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n将此代入 $\\mathbf{H}$ 的表达式中：\n$$\n\\mathbf{H}(\\mathbf{r}) = \\frac{j}{\\omega\\mu} \\left[ j\\alpha(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r}) \\right] = -\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\n$$\n接下来，我们计算场的模的平方，$\\|\\mathbf{E}\\|^2 = \\mathbf{E} \\cdot \\mathbf{E}^*$ 和 $\\|\\mathbf{H}\\|^2 = \\mathbf{H} \\cdot \\mathbf{H}^*$，其中 $*$ 表示复共轭。\n对于电场：\n$$\n\\|\\mathbf{E}(\\mathbf{r})\\|^2 = \\left(\\alpha\\,\\mathbf{e}\\,\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right) \\cdot \\left(\\alpha\\,\\mathbf{e}^*\\,\\exp(-j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right)\n$$\n由于 $\\mathbf{e}$ 是一个实矢量，所以 $\\mathbf{e}^*=\\mathbf{e}$。\n$$\n\\|\\mathbf{E}(\\mathbf{r})\\|^2 = \\alpha^2 (\\mathbf{e}\\cdot\\mathbf{e}) \\exp(0) = \\alpha^2 \\|\\mathbf{e}\\|^2 = \\alpha^2(1)^2 = \\alpha^2\n$$\n对于磁场：\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\left(-\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})\\exp(j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right) \\cdot \\left(-\\frac{\\alpha}{\\omega\\mu}(\\mathbf{k} \\times \\mathbf{e})^*\\exp(-j\\,\\mathbf{k}\\cdot \\mathbf{r})\\right)\n$$\n由于 $\\mathbf{k}$ 和 $\\mathbf{e}$ 是实矢量，所以 $(\\mathbf{k} \\times \\mathbf{e})^* = \\mathbf{k} \\times \\mathbf{e}$。\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\frac{\\alpha^2}{(\\omega\\mu)^2} \\|\\mathbf{k} \\times \\mathbf{e}\\|^2\n$$\n给定横向条件 $\\mathbf{k}\\cdot\\mathbf{e}=0$，$\\mathbf{k}$ 和 $\\mathbf{e}$ 之间的夹角为 $\\pi/2$。它们叉积的大小为 $\\|\\mathbf{k} \\times \\mathbf{e}\\| = \\|\\mathbf{k}\\| \\|\\mathbf{e}\\| \\sin(\\pi/2) = \\|\\mathbf{k}\\|$。令 $k = \\|\\mathbf{k}\\|$。\n那么，$\\|\\mathbf{H}\\|^2 = \\frac{\\alpha^2 k^2}{\\omega^2\\mu^2}$。\n问题给出了平面波的色散关系：$k = \\omega\\sqrt{\\mu\\epsilon}$，这意味着 $k^2 = \\omega^2\\mu\\epsilon$。将此代入 $\\|\\mathbf{H}\\|^2$ 的表达式中：\n$$\n\\|\\mathbf{H}(\\mathbf{r})\\|^2 = \\frac{\\alpha^2(\\omega^2\\mu\\epsilon)}{\\omega^2\\mu^2} = \\alpha^2 \\frac{\\epsilon}{\\mu}\n$$\n我们观察到 $\\|\\mathbf{E}\\|^2$ 和 $\\|\\mathbf{H}\\|^2$ 在整个区域 $\\Omega$ 中都是常数。\n\n现在我们可以计算归一化积分。被积函数为\n$$\n\\epsilon\\,\\|\\mathbf{E}(\\mathbf{r})\\|^{2}+\\mu\\,\\|\\mathbf{H}(\\mathbf{r})\\|^{2} = \\epsilon\\alpha^2 + \\mu\\left(\\alpha^2 \\frac{\\epsilon}{\\mu}\\right) = \\epsilon\\alpha^2 + \\epsilon\\alpha^2 = 2\\epsilon\\alpha^2\n$$\n这证明了在无损耗介质中平面波的时均能量均分：电场和磁场能量密度相等，$\\frac{1}{4}\\epsilon\\|\\mathbf{E}\\|^2 = \\frac{1}{4}\\epsilon\\alpha^2$ 且 $\\frac{1}{4}\\mu\\|\\mathbf{H}\\|^2 = \\frac{1}{4}\\mu(\\alpha^2\\epsilon/\\mu) = \\frac{1}{4}\\epsilon\\alpha^2$。\n\n总能量为\n$$\n\\frac{1}{4}\\int_{\\Omega} (2\\epsilon\\alpha^2) \\,dV = \\frac{\\epsilon\\alpha^2}{2} \\int_{\\Omega} dV\n$$\n在区域 $\\Omega$ 上对 $dV$ 的积分是其体积 $V$。所以总能量是\n$$\nW = \\frac{\\epsilon\\alpha^2 V}{2}\n$$\n根据归一化条件，令其等于1：\n$$\n\\frac{\\epsilon\\alpha^2 V}{2} = 1\n$$\n我们现在可以解出 $\\alpha$。因为 $\\alpha$ 被给定为非负标量：\n$$\n\\alpha^2 = \\frac{2}{\\epsilon V} \\implies \\alpha = \\sqrt{\\frac{2}{\\epsilon V}}\n$$\n这就是所要求的用 $\\epsilon$ 和 $V$ 表示的归一化常数。\n\n关于在有损耗色散介质中归一化的概念性问题：\n在这类介质中，介电常数 $\\epsilon(\\omega)$ 和/或磁导率 $\\mu(\\omega)$ 变为复数且与频率相关。这会带来几个后果。控制波动算符不再是厄米的，导致出现复特征值（复频率 $\\omega$），这代表了时间上的衰减。时均储能的标准表达式不再有效。在线性、色散、弱损耗介质中，时均能量密度的正确表达式由 Brillouin 公式给出：\n$$\nw(\\mathbf{r}) = \\frac{1}{4}\\left(\\frac{d(\\omega\\,\\text{Re}\\{\\epsilon(\\omega)\\})}{d\\omega}\\|\\mathbf{E}(\\mathbf{r})\\|^2 + \\frac{d(\\omega\\,\\text{Re}\\{\\mu(\\omega)\\})}{d\\omega}\\|\\mathbf{H}(\\mathbf{r})\\|^2\\right)\n$$\n这个表达式考虑了储存在介质极化和磁化动态响应中的能量。\n对于在有损耗或开放系统中出现的非厄米特征值问题，右特征矢量（即模本身）和左特征矢量不再互为伴随。它们形成一个双正交集。对于这些问题，一个数学上一致且广泛使用的归一化约定是**双正交归一化** (biorthogonal normalization)。在这个约定中，对应于不同特征值的右特征矢量 $\\mathbf{u}_i$ 和左特征矢量 $\\mathbf{v}_j$ 在一个适当定义的内积下是正交的，并且选择归一化使得 $\\langle \\mathbf{v}_j, \\mathbf{u}_i \\rangle = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。这确保了任何任意场的唯一模式展开。", "answer": "$$\n\\boxed{\\sqrt{\\frac{2}{\\epsilon V}}}\n$$", "id": "3304078"}, {"introduction": "在处理复杂几何结构时，我们通常采用有限元法（FEM）等数值方法，将连续的物理问题转化为大规模的矩阵本征值问题，形如 $\\mathbf{K}\\mathbf{e} = \\lambda \\mathbf{M}\\mathbf{e}$。通常，我们感兴趣的是位于特定频率范围内的“内部”本征值，而这些本征值对于标准迭代求解器来说难以直接计算。这项实践介绍了“位移-反转”谱变换技术[@problem_id:3304065]，这是一种极其强大的数值策略。它巧妙地将寻找“靠近”某一位移值 $\\sigma$ 的本征值的问题，转化为寻找一个变换后算子的“最大”本征值的问题，从而极大地加速了收敛速度并使得内部本征值的计算变得高效可行。", "problem": "一个无源的理想电导体腔体在频域中通过从麦克斯韦方程组导出的旋度-旋度特征问题进行建模：寻找非平凡电场 $\\mathbf{E}$ 和角频率 $\\omega$ 使得\n$$\n\\nabla \\times \\mu^{-1} \\nabla \\times \\mathbf{E} \\;=\\; \\omega^{2} \\,\\epsilon\\, \\mathbf{E}, \n$$\n在导电边界上满足边界条件 $\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$。在合适的无散度子空间上进行协调有限元法（FEM）离散化，得到广义矩阵特征值问题\n$$\n\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}, \n$$\n其中 $\\mathbf{K}$ 和 $\\mathbf{M}$ 分别是由旋度-旋度项和质量项的双线性形式产生的厄米矩阵，$\\lambda = \\omega^{2}$，质量矩阵 $\\mathbf{M}$ 在离散子空间上是厄米正定的，而刚度矩阵 $\\mathbf{K}$ 是厄米半正定的。假设目标是计算位于预设实数位移 $\\sigma \\in \\mathbb{R}$ 附近的特征值 $\\lambda$，且 $\\sigma$ 不等于任何精确特征值。\n\n考虑将Krylov子空间方法应用于一个线性算子映射，该映射是隐式定义的：对于给定的向量 $\\mathbf{v}$，计算线性系统\n$$\n\\left(\\mathbf{K} - \\sigma \\mathbf{M}\\right)\\,\\mathbf{w} \\;=\\; \\mathbf{M}\\,\\mathbf{v},\n$$\n的唯一解 $\\mathbf{w}$，然后返回 $\\mathbf{w}$ 作为算子在 $\\mathbf{v}$ 上的作用。这种构造通常用于加速收敛到 $\\sigma$ 附近的特征值。\n\n关于这种构造，下列哪些陈述是正确的？选择所有适用项。\n\nA. 如果 $(\\lambda, \\mathbf{e})$ 是 $\\mathbf{K}\\,\\mathbf{e}=\\lambda \\mathbf{M}\\,\\mathbf{e}$ 的一个特征对，且 $\\lambda \\neq \\sigma$，那么 $\\mathbf{e}$ 是该隐式定义算子的特征向量，其特征值为 $\\mu = (\\lambda - \\sigma)^{-1}$。因此，接近 $\\sigma$ 的特征值 $\\lambda$ 会被映射为大模的特征值 $\\mu$。\n\nB. 该构造将接近 $\\sigma$ 的特征值 $\\lambda$ 映射为小模的特征值 $\\mu$，因此，那些以主导（最大模）特征值为目标的方法将倾向于收敛到远离 $\\sigma$ 的特征值。\n\nC. 为了保持特征向量，该方法需要显式地构造 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)^{-1}$；仅仅求解系数为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$ 的线性系统并不能产生相同的特征对。\n\nD. 假设 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是厄米矩阵，$\\mathbf{M}$ 是正定的，且 $\\sigma \\in \\mathbb{R}$ 位于谱之外。那么，该隐式定义的算子关于 $\\mathbf{M}$-内积是自伴的，具有实特征值 $\\mu$，并拥有一个与原问题的广义特征向量一致的 $\\mathbf{M}$-正交特征基。\n\nE. 在Krylov子空间方法中，每次应用该隐式定义的算子都需要求解一个线性系统，其系数矩阵为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$，右端项为 $\\mathbf{M}$ 乘以当前向量。", "solution": "用户提供了一个问题陈述，内容涉及广义特征值问题的移位-求逆谱变换的性质。该问题源于谐振腔中麦克斯韦方程组的有限元法（FEM）离散化。\n\n### 第一步：提取已知条件\n\n-   **连续特征问题**：寻找非平凡电场 $\\mathbf{E}$ 和角频率 $\\omega$ 使得 $\\nabla \\times \\mu^{-1} \\nabla \\times \\mathbf{E} \\;=\\; \\omega^{2} \\,\\epsilon\\, \\mathbf{E}$。\n-   **边界条件**：在理想导电边界上 $\\mathbf{n}\\times \\mathbf{E} = \\mathbf{0}$。\n-   **离散化特征问题**：$\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}$。\n-   **矩阵性质**：\n    -   $\\mathbf{K}$ 是一个厄米半正定刚度矩阵。\n    -   $\\mathbf{M}$ 是一个厄米正定质量矩阵。\n    -   特征值为 $\\lambda = \\omega^{2}$。\n-   **计算目标**：计算位于预设实数位移 $\\sigma \\in \\mathbb{R}$ 附近的特征值 $\\lambda$。\n-   **对位移的约束**：$\\sigma$ 不等于任何精确特征值 $\\lambda$。\n-   **算子定义**：一个算子被隐式定义。对于给定的向量 $\\mathbf{v}$，算子作用于 $\\mathbf{v}$ 得到向量 $\\mathbf{w}$，其中 $\\mathbf{w}$ 是线性系统 $\\left(\\mathbf{K} - \\sigma \\mathbf{M}\\right)\\,\\mathbf{w} \\;=\\; \\mathbf{M}\\,\\mathbf{v}$ 的唯一解。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学基础**：该问题在计算电磁学和数值线性代数领域有扎实的基础。旋度-旋度方程是无源电磁腔体频域分析的标准出发点。其有限元离散化导致的广义特征值问题 $\\mathbf{K}\\,\\mathbf{e} \\;=\\; \\lambda\\, \\mathbf{M}\\,\\mathbf{e}$ 是该领域的基石之一。$\\mathbf{K}$ 和 $\\mathbf{M}$ 具有厄米和正（半）定性的性质对于标准的Galerkin有限元法是正确的。\n-   **适定性**：该问题描述了移位-求逆谱变换。位移 $\\sigma$ 不是特征值的条件确保了矩阵 $\\mathbf{K} - \\sigma \\mathbf{M}$ 是非奇异的（可逆的），从而使算子定义良好。关于该算子性质的问题是标准的，并且有确定的答案。\n-   **客观性**：该问题使用精确、标准的数学和工程术语（例如，厄米、正定、Krylov子空间方法、特征对）来陈述。它不含主观或模棱两可的语言。\n-   **完整性和一致性**：该问题提供了分析所提算子所需的所有必要信息和定义。设置中没有矛盾。\n-   **可行性和现实性**：所描述的方法，称为移位-求逆策略（通常与Arnoldi或Lanczos算法一起使用），是一种广泛使用且高效的实用技术，用于寻找大型稀疏矩阵系统的内部特征值。\n\n### 第三步：结论与行动\n\n该问题陈述是有效的。这是工程数值方法中的一个标准、适定的问题。我将继续进行推导和选项分析。\n\n### 算子性质的推导\n\n问题定义了一个算子，我们称之为 $\\mathbf{T}$，其对向量 $\\mathbf{v}$ 的作用是求解系统产生向量 $\\mathbf{w}$：\n$$ (\\mathbf{K} - \\sigma \\mathbf{M})\\,\\mathbf{w} = \\mathbf{M}\\,\\mathbf{v} $$\n由于 $\\sigma$ 不是一个特征值，矩阵 $(\\mathbf{K} - \\sigma \\mathbf{M})$ 是可逆的。因此，我们可以将算子 $\\mathbf{T}$ 显式地写为：\n$$ \\mathbf{T} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} $$\n\n设 $(\\lambda, \\mathbf{e})$ 是原问题的一个特征对，满足 $\\mathbf{K}\\,\\mathbf{e} = \\lambda \\mathbf{M}\\,\\mathbf{e}$。我们将分析 $\\mathbf{T}$ 对特征向量 $\\mathbf{e}$ 的作用。\n\n我们重排原始特征值方程：\n$$ \\mathbf{K}\\,\\mathbf{e} - \\sigma \\mathbf{M}\\,\\mathbf{e} = \\lambda \\mathbf{M}\\,\\mathbf{e} - \\sigma \\mathbf{M}\\,\\mathbf{e} $$\n$$ (\\mathbf{K} - \\sigma \\mathbf{M})\\,\\mathbf{e} = (\\lambda - \\sigma) \\mathbf{M}\\,\\mathbf{e} $$\n因为 $\\lambda$ 是一个特征值而 $\\sigma$ 不是，所以 $\\lambda \\neq \\sigma$，因此标量 $(\\lambda - \\sigma)$ 非零。我们可以用 $(\\mathbf{K} - \\sigma \\mathbf{M})^{-1}$ 左乘：\n$$ \\mathbf{e} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1}(\\lambda - \\sigma) \\mathbf{M}\\,\\mathbf{e} $$\n提出标量 $(\\lambda - \\sigma)$：\n$$ \\mathbf{e} = (\\lambda - \\sigma) \\left[ (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} \\right] \\mathbf{e} $$\n识别出算子 $\\mathbf{T}$：\n$$ \\mathbf{e} = (\\lambda - \\sigma) \\mathbf{T}\\,\\mathbf{e} $$\n除以非零标量 $(\\lambda - \\sigma)$，我们得到算子 $\\mathbf{T}$ 的特征值方程：\n$$ \\mathbf{T}\\,\\mathbf{e} = \\frac{1}{\\lambda - \\sigma} \\mathbf{e} $$\n这表明 $\\mathbf{e}$ 是算子 $\\mathbf{T}$ 的一个特征向量。对应的特征值，我们称之为 $\\mu$，是：\n$$ \\mu = \\frac{1}{\\lambda - \\sigma} $$\n\n### 逐项分析\n\n**A. 如果 $(\\lambda, \\mathbf{e})$ 是 $\\mathbf{K}\\,\\mathbf{e}=\\lambda \\mathbf{M}\\,\\mathbf{e}$ 的一个特征对，且 $\\lambda \\neq \\sigma$，那么 $\\mathbf{e}$ 是该隐式定义算子的特征向量，其特征值为 $\\mu = (\\lambda - \\sigma)^{-1}$。因此，接近 $\\sigma$ 的特征值 $\\lambda$ 会被映射为大模的特征值 $\\mu$。**\n\n这个陈述是我们上述推导的直接结果。算子 $\\mathbf{T}$ 的特征值确实是 $\\mu = (\\lambda - \\sigma)^{-1}$。如果原始特征值 $\\lambda$ 接近位移 $\\sigma$，分母 $(\\lambda - \\sigma)$ 将成为一个小数。小数的倒数是一个大数。因此，接近 $\\sigma$ 的特征值 $\\lambda$ 会被映射为大模的特征值 $\\mu$。这个性质正是使用该方法的原因：像Arnoldi或Lanczos这样的Krylov方法最快收敛到最大模的特征值（主导特征值）。\n**结论：正确。**\n\n**B. 该构造将接近 $\\sigma$ 的特征值 $\\lambda$ 映射为小模的特征值 $\\mu$，因此，那些以主导（最大模）特征值为目标的方法将倾向于收敛到远离 $\\sigma$ 的特征值。**\n\n这个陈述在逻辑上与选项A的结论相反。如推导所示，接近 $\\sigma$ 的特征值 $\\lambda$ 会被映射为大模的特征值 $\\mu$，而不是小模。因此，寻找主导特征值的Krylov方法将收敛到期望的特征值（即$\\sigma$附近的那些）。\n**结论：不正确。**\n\n**C. 为了保持特征向量，该方法需要显式地构造 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)^{-1}$；仅仅求解系数为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$ 的线性系统并不能产生相同的特征对。**\n\n这个陈述反映了对Krylov子空间方法如何实现的误解。算子 $\\mathbf{T}$ 对向量 $\\mathbf{v}$ 的作用是 $\\mathbf{T}\\mathbf{v} = (\\mathbf{K} - \\sigma \\mathbf{M})^{-1} \\mathbf{M} \\mathbf{v}$。在计算上，这是通过先计算向量 $\\mathbf{b} = \\mathbf{M}\\mathbf{v}$，然后求解线性系统 $(\\mathbf{K} - \\sigma \\mathbf{M})\\mathbf{w} = \\mathbf{b}$ 得到 $\\mathbf{w}$ 来执行的。解 $\\mathbf{w}$ 等于 $\\mathbf{T}\\mathbf{v}$。这个过程*就是*算子的应用。显式构造逆矩阵在计算上远比求解相应的线性系统昂贵（例如，对于密集矩阵为 $O(N^3)$），且数值稳定性通常更差（例如，对于密集LU分解为 $O(N^2)$，对于稀疏系统则快得多）。求解系统是实现逆算子作用的标准、高效且正确的方式。通过这个过程，特征向量被完美地保留下来。\n**结论：不正确。**\n\n**D. 假设 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是厄米矩阵，$\\mathbf{M}$ 是正定的，且 $\\sigma \\in \\mathbb{R}$ 位于谱之外。那么，该隐式定义的算子关于 $\\mathbf{M}$-内积是自伴的，具有实特征值 $\\mu$，并拥有一个与原问题的广义特征向量一致的 $\\mathbf{M}$-正交特征基。**\n\n让我们验证关于 $\\mathbf{M}$-内积的自伴性，其定义为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\mathbf{y}^H \\mathbf{M} \\mathbf{x}$。如果 $\\langle \\mathbf{T}\\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\langle \\mathbf{x}, \\mathbf{T}\\mathbf{y} \\rangle_{\\mathbf{M}}$，则算子 $\\mathbf{T}$ 是自伴的。\n\n左边：$\\langle \\mathbf{T}\\mathbf{x}, \\mathbf{y} \\rangle_{\\mathbf{M}} = \\mathbf{y}^H \\mathbf{M} (\\mathbf{T}\\mathbf{x}) = \\mathbf{y}^H \\mathbf{M} (\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{x}$。\n\n右边：$\\langle \\mathbf{x}, \\mathbf{T}\\mathbf{y} \\rangle_{\\mathbf{M}} = (\\mathbf{T}\\mathbf{y})^H \\mathbf{M} \\mathbf{x} = ((\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{y})^H \\mathbf{M} \\mathbf{x} = \\mathbf{y}^H \\mathbf{M}^H ((\\mathbf{K} - \\sigma\\mathbf{M})^{-1})^H \\mathbf{M} \\mathbf{x}$。\n\n鉴于 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是厄米矩阵且 $\\sigma$ 是实数，矩阵 $(\\mathbf{K} - \\sigma\\mathbf{M})$ 也是厄米的：$(\\mathbf{K} - \\sigma\\mathbf{M})^H = \\mathbf{K}^H - \\sigma^* \\mathbf{M}^H = \\mathbf{K} - \\sigma \\mathbf{M}$。厄米矩阵的逆也是厄米矩阵，所以 $((\\mathbf{K} - \\sigma\\mathbf{M})^{-1})^H = (\\mathbf{K} - \\sigma\\mathbf{M})^{-1}$。此外，$\\mathbf{M}^H = \\mathbf{M}$。将这些代入右侧表达式得到：\n右边 = $\\mathbf{y}^H \\mathbf{M} (\\mathbf{K} - \\sigma\\mathbf{M})^{-1} \\mathbf{M} \\mathbf{x}$，这与左侧相同。\n因此，算子 $\\mathbf{T}$ 关于 $\\mathbf{M}$-内积是自伴的。线性代数的一个基本结果表明，一个关于某个内积自伴的算子具有实特征值，并拥有一个关于该内积正交的完备特征向量集。由于 $\\lambda$ 和 $\\sigma$ 都是实数，特征值 $\\mu = (\\lambda - \\sigma)^{-1}$ 确实是实数。特征向量与原问题的广义特征向量 $\\mathbf{e}$ 相同，已知后者构成一个 $\\mathbf{M}$-正交集。\n**结论：正确。**\n\n**E. 在Krylov子空间方法中，每次应用该隐式定义的算子都需要求解一个线性系统，其系数矩阵为 $\\left(\\mathbf{K}-\\sigma \\mathbf{M}\\right)$，右端项为 $\\mathbf{M}$ 乘以当前向量。**\n\n这个陈述是对应用算子 $\\mathbf{T}$ 的精确过程描述。Krylov子空间方法为子空间 $\\text{span}(\\mathbf{v}, \\mathbf{T}\\mathbf{v}, \\mathbf{T}^2\\mathbf{v}, \\dots)$ 构建一个基。为了计算序列中的下一个向量，例如 $\\mathbf{w} = \\mathbf{T}\\mathbf{v}$，必须如问题中算子的定义所规定，求解线性系统 $(\\mathbf{K} - \\sigma \\mathbf{M})\\mathbf{w} = \\mathbf{M}\\mathbf{v}$。系数矩阵是 $(\\mathbf{K} - \\sigma \\mathbf{M})$，右端项是 $\\mathbf{M}$ 乘以输入向量 $\\mathbf{v}$。这正是移位-求逆方法的实现方式。\n**结论：正确。**", "answer": "$$\\boxed{ADE}$$", "id": "3304065"}, {"introduction": "最后，我们将目光投向更前沿的非厄米系统。与描述无损耗系统的厄米算子不同，非厄米算子能够模拟增益和损耗，这在激光、有源天线和超材料等领域至关重要。这些系统展现出许多在无损系统中前所未见的奇异现象，例如复数本征值和奇异点（Exceptional Points, EPs），在奇异点处，系统的本征值和对应的本征矢量会发生合并。这项实践 [@problem_id:3304079] 使用一个简洁而深刻的 $2 \\times 2$ 矩阵模型，来模拟一个具有平衡增益和损耗的波导。您将通过分析这个模型，亲身体验从实数谱到复数谱的转变过程，即所谓的宇称-时间（Parity-Time, PT）对称性破缺，并学习如何识别和表征奇异点。", "problem": "考虑一个沿 $z$ 轴的一维、均匀、平移不变的电磁波导，其标量横向电场分布为 $E(x,z) = \\psi(x)\\,e^{i \\beta z}$，其中 $\\beta$ 是复传播常数，$\\psi(x)$ 是横向模式分布。假设场是角频率为 $\\omega$ 的时谐场，并忽略磁对比度（相对磁导率等于 $1$）。设相对介电常数为平衡增益/损耗形式 $\\epsilon_r(x) = \\epsilon_{r0} + i \\gamma f(x)$，其中 $f(x)$ 是一个实值函数，满足 $f(-x) = - f(x)$ 以强制实现宇称-时间（PT）对称性，$\\gamma \\ge 0$ 是一个实数控制参数。\n\n从麦克斯韦方程组和关于 $\\psi(x)$ 的亥姆霍兹方程出发，通过双模耦合模式简化，将控制最低两个超模的非厄米本征值问题近似为一个 $2 \\times 2$ 矩阵算符，形式如下\n$$\n\\mathbf{A}(\\gamma) = \n\\begin{bmatrix}\n\\beta_0 + i \\gamma  \\kappa \\\\\n\\kappa  \\beta_0 - i \\gamma\n\\end{bmatrix},\n$$\n其中 $\\beta_0$ 和 $\\kappa$ 是由其下的对称保守结构（当 $\\gamma = 0$ 时）决定的实常数。这个简化算符是PT对称的，在 $\\gamma \\ne 0$ 时是非厄米的，其谱 $\\{\\lambda_j(\\gamma)\\}$ 近似于两个超模的谱 $\\{\\beta_j(\\gamma)\\}$。\n\n您的任务是实现一个程序，对于指定的参数集 $(\\beta_0, \\kappa)$ 和 $\\gamma$ 的扫描范围，该程序将：\n\n1. 构建本征值问题 $\\mathbf{A}(\\gamma)\\,\\mathbf{v} = \\lambda\\,\\mathbf{v}$，并为每个采样的 $\\gamma$ 计算两个本征值。\n2. 在扫描范围内，确定两个本征值最接近合并（在最小化绝对间距 $|\\lambda_1(\\gamma) - \\lambda_2(\\gamma)|$ 的意义上）的 $\\gamma$ 值。将此值表示为 $\\gamma^\\star$，并将相应的（几乎）合并的本征值表示为 $\\lambda^\\star$。\n3. 判断在 $\\gamma^\\star$ 处的合并是否是严格意义上的奇异点，即亏损本征值（代数重度超过几何重度）。通过计算 $\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}$ 的零度来对其进行分类：如果在数值容差范围内两个本征值相等且零度等于 $1$，则声明为亏损点；如果在相等时零度等于 $2$，则为非亏损简并；如果本征值在容差范围内不相等，则在扫描范围内未找到奇异点。\n4. 对于亏损情况，通过求解广义链式方程来计算与 $\\lambda^\\star$ 相关的若尔当链向量 $\\mathbf{w}$\n$$\n\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{w} = \\mathbf{v},\n$$\n其中 $\\mathbf{v}$ 是一个满足 $\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{v} = \\mathbf{0}$ 的（右）本征向量。在非亏损或非合并的情况下，仍尝试通过对同一方程的最小二乘解来计算近似的广义本征向量 $\\mathbf{w}$，并报告残差范数。通过以下公式量化链式方程的残差\n$$\nr = \\left\\|\\left(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I}\\right)\\,\\mathbf{w} - \\mathbf{v}\\right\\|_2.\n$$\n\n在整个过程中使用无量纲归一化单位（不需要进行物理单位转换；所有量均被视为无量纲）。在通过奇异值确定本征值相等性和计算数值零度时，使用 $10^{-8}$ 的固定绝对数值容差。\n\n为以下测试套件实现上述操作，在均匀间隔的网格上扫描 $\\gamma$：\n\n- 测试用例 1（理想情况，扫描范围内发生PT对称性破缺）：$\\beta_0 = 10.0$，$\\kappa = 0.3$，$\\gamma$ 从 $0.0$ 扫描到 $0.6$，步长为 $0.002$。\n- 测试用例 2（边界条件，无亏损的简并）：$\\beta_0 = 10.0$，$\\kappa = 0.0$，$\\gamma$ 从 $0.0$ 扫描到 $0.4$，步长为 $0.002$。\n- 测试用例 3（边缘情况，扫描范围内无奇异点）：$\\beta_0 = 10.0$，$\\kappa = 0.25$，$\\gamma$ 从 $0.0$ 扫描到 $0.2$，步长为 $0.002$。\n\n对于每个测试用例，生成一个包含三个条目的列表作为结果：\n- 识别出的 $\\gamma^\\star$，为浮点数。\n- 残差范数 $r$，为浮点数。\n- 一个布尔值，指示是否在 $\\gamma^\\star$ 处检测到亏损奇异点。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号内的逗号分隔列表，每个测试用例的结果本身是 $[\\gamma^\\star, r, \\text{defective}]$ 形式的列表。例如，输出应类似于 $[[\\ldots],[\\ldots],[\\ldots]]$。不出现角度；不需要物理单位，因为所有量都是无量纲的。", "solution": "该问题要求分析一个 $2 \\times 2$ 的非厄米、宇称-时间（PT）对称矩阵算符，它可作为具有平衡增益和损耗的双模电磁波导的简化模型。目标是在指定的参数范围内识别并表征奇异点（EPs）。\n\n控制矩阵算符由下式给出：\n$$\n\\mathbf{A}(\\gamma) = \n\\begin{bmatrix}\n\\beta_0 + i \\gamma  \\kappa \\\\\n\\kappa  \\beta_0 - i \\gamma\n\\end{bmatrix}\n$$\n其中 $\\beta_0$ 和 $\\kappa$ 是代表其下的保守系统的实常数，$\\gamma \\ge 0$ 是控制非厄米、增益-损耗项大小的实参数。\n\n首先，我们通过求解本征值问题 $\\mathbf{A}(\\gamma)\\mathbf{v} = \\lambda\\mathbf{v}$ 来建立该系统的解析性质。本征值 $\\lambda$ 可从特征方程 $\\det(\\mathbf{A}(\\gamma) - \\lambda \\mathbf{I}) = 0$ 中求得：\n$$\n\\det \\begin{bmatrix}\n(\\beta_0 - \\lambda) + i \\gamma  \\kappa \\\\\n\\kappa  (\\beta_0 - \\lambda) - i \\gamma\n\\end{bmatrix} = 0\n$$\n$$\n((\\beta_0 - \\lambda) + i \\gamma)((\\beta_0 - \\lambda) - i \\gamma) - \\kappa^2 = 0\n$$\n$$\n(\\beta_0 - \\lambda)^2 - (i\\gamma)^2 - \\kappa^2 = 0\n$$\n$$\n(\\beta_0 - \\lambda)^2 = \\kappa^2 - \\gamma^2\n$$\n这得到两个本征值：\n$$\n\\lambda_{1,2}(\\gamma) = \\beta_0 \\mp \\sqrt{\\kappa^2 - \\gamma^2}\n$$\n\n本征值的行为取决于 $\\gamma$ 和 $|\\kappa|$ 之间的关系。不失一般性地假设 $\\kappa \\ge 0$：\n1.  **PT对称相（$\\gamma  \\kappa$）：** 项 $\\kappa^2 - \\gamma^2$ 为正，因此本征值 $\\lambda_{1,2}$ 是实数且不相等。系统拥有纯实谱，这是未破缺的PT对称相的标志。\n2.  **奇异点（$\\gamma = \\kappa$）：** 平方根项消失，导致本征值合并为一个值：$\\lambda_1 = \\lambda_2 = \\beta_0$。这个合并点是奇异点的候选。\n3.  **PT破缺相（$\\gamma  \\kappa$）：** 项 $\\kappa^2 - \\gamma^2$ 为负。本征值变成一个复共轭对：$\\lambda_{1,2} = \\beta_0 \\mp i\\sqrt{\\gamma^2 - \\kappa^2}$。复数谱的出现标志着PT对称性的自发破缺。\n\n为了确定在 $\\gamma^\\star = \\kappa$ 处的合并是否为亏损奇异点，我们必须检查该本征值的几何重度是否小于其代数重度。由于合并，代数重度为 $2$。几何重度是矩阵 $\\mathbf{M} = \\mathbf{A}(\\gamma^\\star) - \\lambda^\\star\\mathbf{I}$ 的零空间维度（零度）。这里，$\\gamma^\\star = \\kappa$ 且 $\\lambda^\\star = \\beta_0$。\n$$\n\\mathbf{M} = \\mathbf{A}(\\kappa) - \\beta_0\\mathbf{I} = \n\\begin{bmatrix}\n\\beta_0 + i \\kappa  \\kappa \\\\\n\\kappa  \\beta_0 - i \\kappa\n\\end{bmatrix} - \n\\begin{bmatrix}\n\\beta_0  0 \\\\\n0  \\beta_0\n\\end{bmatrix} = \n\\begin{bmatrix}\ni \\kappa  \\kappa \\\\\n\\kappa  -i \\kappa\n\\end{bmatrix}\n$$\n对于 $\\kappa \\ne 0$，该矩阵的两行是线性相关的（第二行是第一行的 $-i$ 倍）。因此，$\\mathbf{M}$ 的秩为 $1$。根据秩-零度定理，零度为 $2 - \\text{rank}(\\mathbf{M}) = 2 - 1 = 1$。由于几何重度（$1$）小于代数重度（$2$），该矩阵是亏损的，在 $\\gamma = \\kappa$ 处的合并是一个真正的奇异点。一个重要的特殊情况是当 $\\kappa=0$ 时，在 $\\gamma=0$ 处矩阵 $\\mathbf{M}$ 是零矩阵，其零度为 $2$。这对应于一个非亏损（魔鬼）简并。\n\n在亏损奇异点处，本征向量也发生合并。单个本征向量 $\\mathbf{v}$ 是若尔当链的一部分，该链包含一个满足链式方程的广义本征向量 $\\mathbf{w}$：\n$$\n\\mathbf{M}\\,\\mathbf{w} = (\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I})\\,\\mathbf{w} = \\mathbf{v}\n$$\n其中本征向量 $\\mathbf{v}$ 满足 $(\\mathbf{A}(\\gamma^\\star) - \\lambda^\\star \\mathbf{I})\\mathbf{v} = \\mathbf{0}$。对于一个亏损矩阵，这个系统是相容的并且对于 $\\mathbf{w}$ 是可解的。\n\n数值实现过程如下：\n1.  对于每个测试用例，我们定义一个 $\\gamma$ 值的网格。\n2.  在每个 $\\gamma$ 处，我们构建矩阵 $\\mathbf{A}(\\gamma)$ 并计算其本征值 $\\lambda_1, \\lambda_2$。\n3.  我们找到使绝对间距 $|\\lambda_1 - \\lambda_2|$ 最小化的值 $\\gamma^\\star$。相应的几乎合并的本征值 $\\lambda^\\star$ 取为在 $\\gamma^\\star$ 处两个本征值的平均值。\n4.  为了对 $\\gamma^\\star$ 处的点进行分类，我们构建 $\\mathbf{M} = \\mathbf{A}(\\gamma^\\star) - \\lambda^\\star\\mathbf{I}$。$\\mathbf{M}$ 的数值零度通过计算其小于给定容差 $10^{-8}$ 的奇异值的数量来确定。如果零度为 $1$ 并且本征值间距也低于容差，则检测到奇异点。\n5.  计算与 $\\lambda^\\star$ 对应的本征向量 $\\mathbf{v}$ 并进行归一化。通过使用最小二乘求解器（`numpy.linalg.lstsq`）求解线性系统 $\\mathbf{M}\\mathbf{w} = \\mathbf{v}$ 来找到广义本征向量 $\\mathbf{w}$，该求解器对于奇异（亏损/简并）和非奇异情况都具有鲁棒性。\n6.  最后，计算残差范数 $r = \\|\\mathbf{M}\\mathbf{w} - \\mathbf{v}\\|_2$。该范数用于量化若尔当链式方程的满足程度。对于真正的奇异点或非合并点（其中 $\\mathbf{M}$ 是可逆的），该范数将接近于零，但对于非亏损简并（其中 $\\mathbf{M}=\\mathbf{0}$ 且 $\\mathbf{v}\\ne\\mathbf{0}$），该范数将显著非零。", "answer": "```python\nimport numpy as np\n\ndef analyze_pt_system(beta0, kappa, gamma_range, tol):\n    \"\"\"\n    Analyzes a 2x2 PT-symmetric system to find and classify exceptional points.\n\n    Args:\n        beta0 (float): Real part of the diagonal elements.\n        kappa (float): Real coupling coefficient.\n        gamma_range (tuple): A tuple (start, stop, step) defining the scan range for gamma.\n        tol (float): Numerical tolerance for equality and nullity checks.\n\n    Returns:\n        list: A list containing [gamma_star, residual_norm, is_defective].\n    \"\"\"\n    gamma_start, gamma_stop, gamma_step = gamma_range\n    num_points = int(round((gamma_stop - gamma_start) / gamma_step)) + 1\n    gammas = np.linspace(gamma_start, gamma_stop, num_points)\n\n    min_separation = float('inf')\n    gamma_star = -1.0\n    eigenvalues_at_min_sep = None\n\n    for gamma in gammas:\n        A = np.array([\n            [beta0 + 1j * gamma, kappa],\n            [kappa,             beta0 - 1j * gamma]\n        ], dtype=np.complex128)\n        \n        eigenvalues = np.linalg.eigvals(A)\n        separation = np.abs(eigenvalues[0] - eigenvalues[1])\n        \n        if separation  min_separation:\n            min_separation = separation\n            gamma_star = gamma\n            eigenvalues_at_min_sep = eigenvalues\n\n    # Perform analysis at the identified point gamma_star\n    A_star = np.array([\n        [beta0 + 1j * gamma_star, kappa],\n        [kappa,             beta0 - 1j * gamma_star]\n    ], dtype=np.complex128)\n    \n    # The coalesced eigenvalue is approximated by the mean of the two nearly-equal eigenvalues\n    lambda_star = np.mean(eigenvalues_at_min_sep)\n\n    # Construct the matrix M for defectiveness and Jordan chain analysis\n    M = A_star - lambda_star * np.identity(2, dtype=np.complex128)\n\n    # 1. Defectiveness check using SVD for numerical nullity\n    _ , s, _ = np.linalg.svd(M)\n    nullity = np.sum(s  tol)\n    \n    # An EP is defective if nullity is 1 and eigenvalues are coalesced\n    is_defective = (nullity == 1) and (min_separation  tol)\n\n    # 2. Jordan chain vector and residual norm calculation\n    # Find the eigenvector v. Using np.linalg.eig on A_star is robust.\n    _ , eigvecs_star = np.linalg.eig(A_star)\n    \n    # Choose the eigenvector whose eigenvalue is closest to lambda_star\n    v_index = np.argmin(np.abs(np.linalg.eigvals(A_star) - lambda_star))\n    v = eigvecs_star[:, v_index]\n    v = v / np.linalg.norm(v)  # Normalize for a consistent residual measure\n\n    # Solve M w = v for w using least squares, which handles all cases\n    w, _, _, _ = np.linalg.lstsq(M, v, rcond=None)\n    \n    # Calculate the residual norm as per the problem definition\n    residual_norm = np.linalg.norm(M @ w - v)\n    \n    return [gamma_star, residual_norm, is_defective]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (beta0, kappa, (gamma_start, gamma_stop, gamma_step))\n        (10.0, 0.3,  (0.0, 0.6, 0.002)),  # PT-breaking inside scan\n        (10.0, 0.0,  (0.0, 0.4, 0.002)),  # Non-defective degeneracy\n        (10.0, 0.25, (0.0, 0.2, 0.002)),  # No EP in scan range\n    ]\n    \n    tolerance = 1e-8\n    results = []\n    \n    for case in test_cases:\n        beta0, kappa, gamma_range = case\n        result = analyze_pt_system(beta0, kappa, gamma_range, tolerance)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of list and boolean matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3304079"}]}