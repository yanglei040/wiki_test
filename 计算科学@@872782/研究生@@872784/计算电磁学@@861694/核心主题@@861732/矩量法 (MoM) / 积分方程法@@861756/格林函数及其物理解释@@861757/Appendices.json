{"hands_on_practices": [{"introduction": "自由空间标量格林函数是解决波传播问题的基石，它代表了对点源的基本响应。这项基础练习将指导你使用分波展开法推导该函数，即将场分解为球谐基函数。掌握此方法可以让你深入理解在不同坐标系下分析辐射和散射问题的方式。[@problem_id:3312732]", "problem": "考虑在均匀、各向同性、无源的三维空间中的时谐标量亥姆霍兹格林函数，它被定义为以下边值问题的广义函数解\n$$(\\nabla^{2}+k^{2})\\,G(\\mathbf{r},\\mathbf{r}')=-\\delta(\\mathbf{r}-\\mathbf{r}'),\\quad \\text{在无穷远处满足索末菲辐射条件},$$\n其中 $k0$ 是实波数，$\\delta(\\mathbf{r}-\\mathbf{r}')$ 是三维狄拉克 $\\delta$ 分布。仅从该定义、单位球面上的球谐函数 $Y_{\\ell m}(\\hat{\\mathbf{r}})$ 的标准正交完备性，以及原点正则性和无穷远辐射性作为物理条件出发，执行以下步骤：\n\n- 在球坐标中分离变量，并将 $G(\\mathbf{r},\\mathbf{r}')$ 按 $Y_{\\ell m}(\\hat{\\mathbf{r}})$ 展开，使得每个角动量通道 $\\ell$ 都产生一个满足狄拉克 $\\delta$ 源所隐含的正确广义跳跃条件的径向格林函数。\n- 使用两个线性无关的齐次径向解（它们分别在原点处正则和在无穷远处纯出射）来构造唯一的分段径向格林函数。通过施加跨越 $r=r'$ 的广义跳跃条件，精确地确定展开系数。\n- 重组完整解，并使用球谐函数的加法定理，将结果用勒让德多项式 $P_{\\ell}(\\cos\\gamma)$ 表示，其中 $\\gamma$ 是 $\\hat{\\mathbf{r}}$ 和 $\\hat{\\mathbf{r}}'$ 之间的夹角。\n\n你的最终答案必须是 $G(\\mathbf{r},\\mathbf{r}')$ 的一个单一闭合形式级数表达式，用 $j_{\\ell}$、$h_{\\ell}^{(1)}$ 和 $P_{\\ell}$ 写出，并带有对 $r_{}=\\min(r,r')$、$r_{>}=\\max(r,r')$ 和 $\\gamma=\\arccos(\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}')$ 的显式依赖关系。无需进行数值计算。将最终结果表示为单一的解析表达式。在最终表达式中不要包含任何单位。", "solution": "所述问题是有效的。这是一个数学物理中（特别是在波传播理论中）适定的、有科学依据的问题。它要求推导自由空间亥姆霍兹格林函数的标准球面波展开，这是该领域的一个基本结果。所有提供的信息都是完整、一致和客观的。因此，我们可以开始求解。\n\n我们从均匀、各向同性的三维空间中时谐标量格林函数 $G(\\mathbf{r},\\mathbf{r}')$ 的定义性广义偏微分方程开始：\n$$(\\nabla^{2}+k^{2})\\,G(\\mathbf{r},\\mathbf{r}')=-\\delta(\\mathbf{r}-\\mathbf{r}')$$\n该方程受限于无穷远处的 Sommerfeld 辐射条件。这里，$k0$ 是实波数，$\\mathbf{r}$ 是观测点，$\\mathbf{r}'$ 是源点，$\\delta(\\mathbf{r}-\\mathbf{r}')$ 是三维狄拉克 $\\delta$ 分布。\n\n为在球坐标 $(r, \\theta, \\phi)$ 中求解此方程，我们采用分离变量法。算子 $(\\nabla^{2}+k^{2})$ 的旋转不变性和源点的位置意味着格林函数仅依赖于径向距离 $r=|\\mathbf{r}|$、$r'=|\\mathbf{r}'|$ 以及向量 $\\mathbf{r}$ 和 $\\mathbf{r}'$ 之间的夹角 $\\gamma$。因此，我们可以将 $G(\\mathbf{r},\\mathbf{r}')$ 在一个分离了径向和角向依赖关系的基上展开。球谐函数 $Y_{\\ell m}(\\hat{\\mathbf{r}})$ 在单位球面上构成一个完备的标准正交基，满足 $L^2 Y_{\\ell m} = \\ell(\\ell+1) Y_{\\ell m}$，其中 $L^2$ 是拉普拉斯算子的角向部分。我们将格林函数和狄拉克 $\\delta$ 函数都在此基上展开。\n\n首先，狄拉克 $\\delta$ 函数用球坐标表示为：\n$$\\delta(\\mathbf{r}-\\mathbf{r}') = \\frac{\\delta(r-r')}{r^{2}} \\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}')$$\n角向 $\\delta$ 函数 $\\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}')$ 具有用球谐函数表示的闭合关系：\n$$\\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n结合这些，得到源项的展开式：\n$$-\\delta(\\mathbf{r}-\\mathbf{r}') = -\\frac{\\delta(r-r')}{r^{2}} \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n接下来，我们假设格林函数有相应的展开式。由于旋转对称性，展开系数将不依赖于磁量子数 $m$。我们写作：\n$$G(\\mathbf{r},\\mathbf{r}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} g_{\\ell}(r,r') Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n球坐标中的拉普拉斯算子是 $\\nabla^{2} = \\frac{1}{r^{2}}\\frac{\\partial}{\\partial r}\\left(r^{2} \\frac{\\partial}{\\partial r}\\right) - \\frac{L^{2}}{r^{2}}$。将展开式代入亥姆霍兹方程，得到：\n$$\\sum_{\\ell,m} \\left[ \\left(\\frac{1}{r^{2}}\\frac{d}{dr}r^{2}\\frac{d}{dr} - \\frac{\\ell(\\ell+1)}{r^{2}} + k^{2}\\right)g_{\\ell}(r,r') \\right] Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') = -\\frac{\\delta(r-r')}{r^{2}} \\sum_{\\ell,m} Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n通过令基函数 $Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$ 的系数相等，我们得到了每个角动量通道 $\\ell$ 的径向格林函数 $g_{\\ell}(r,r')$ 所满足的一维常微分方程：\n$$\\left[ \\frac{1}{r^{2}}\\frac{d}{dr}\\left(r^{2}\\frac{d}{dr}\\right) + k^{2} - \\frac{\\ell(\\ell+1)}{r^{2}} \\right] g_{\\ell}(r,r') = -\\frac{\\delta(r-r')}{r^{2}}$$\n将方程两边乘以 $r^2$，可将其改写为标准的 Sturm-Liouville 形式 $L[y] = -(1/p(x))\\delta(x-x')$：\n$$\\left[ \\frac{d}{dr}\\left(r^{2}\\frac{d}{dr}\\right) + (k^{2}r^{2} - \\ell(\\ell+1)) \\right] g_{\\ell}(r,r') = -\\delta(r-r')$$\n该方程的齐次部分（对于 $r \\neq r'$）是球贝塞尔方程。它的两个线性无关解是第一类球贝塞尔函数 $j_{\\ell}(kr)$ 和球诺依曼函数 $y_{\\ell}(kr)$。\n物理边界条件决定了解的选择。\n$1$. 对于 $r  r'$，解在原点（$r=0$）处必须是正则的。函数 $j_{\\ell}(kr)$ 是正则的，而 $y_{\\ell}(kr)$ 是奇异的。因此，该区域的解必须正比于 $j_{\\ell}(kr)$。\n$2$. 对于 $r > r'$，解必须满足 Sommerfeld 辐射条件，表示一个在无穷远处的纯出射波。第一类球汉克尔函数 $h_{\\ell}^{(1)}(kr) = j_{\\ell}(kr) + i y_{\\ell}(kr)$ 具有渐近行为 $\\sim \\frac{1}{kr} \\exp(i(kr - (\\ell+1)\\pi/2))$，代表一个出射波。因此，该区域的解必须正比于 $h_{\\ell}^{(1)}(kr)$。\n\n基于这些条件并要求在 $r=r'$ 处连续，我们构造分段径向格林函数。我们引入 $r_{} = \\min(r,r')$ 和 $r_{>} = \\max(r,r')$。确保连续性和对称性（$g_{\\ell}(r,r')=g_{\\ell}(r',r)$）的形式是：\n$$g_{\\ell}(r,r') = C_{\\ell} \\, j_{\\ell}(kr_{}) \\, h_{\\ell}^{(1)}(kr_{>})$$\n其中 $C_{\\ell}$ 是一个待定常数。为了求出 $C_{\\ell}$，我们对 $g_{\\ell}$ 在 $r=r'$ 处的导数施加跳跃条件，该条件通过对 Sturm-Liouville 方程在奇点 $r=r'$ 两侧进行积分得到：\n$$\\int_{r'-\\epsilon}^{r'+\\epsilon} \\left[ \\frac{d}{dr}\\left(r^{2}\\frac{dg_{\\ell}}{dr}\\right) + (k^{2}r^{2} - \\ell(\\ell+1)) g_{\\ell} \\right] dr = \\int_{r'-\\epsilon}^{r'+\\epsilon} (-\\delta(r-r')) dr = -1$$\n当 $\\epsilon \\to 0$ 时，由于 $g_{\\ell}$ 的连续性，包含 $g_{\\ell}$ 的项的积分消失。第一项得到：\n$$\\left[ r^{2}\\frac{dg_{\\ell}}{dr} \\right]_{r=r'_{-}}^{r=r'_{+}} = -1$$\n具体来说，$\\left(r'^{2} \\frac{d}{dr} [C_{\\ell} j_{\\ell}(kr') h_{\\ell}^{(1)}(kr)]_{r=r'}\\right) - \\left(r'^{2} \\frac{d}{dr} [C_{\\ell} j_{\\ell}(kr) h_{\\ell}^{(1)}(kr')]_{r=r'}\\right) = -1$。\n$$C_{\\ell} r'^{2} \\left[ j_{\\ell}(kr') k(h_{\\ell}^{(1)})'(kr') - h_{\\ell}^{(1)}(kr') k j'_{\\ell}(kr') \\right] = -1$$\n方括号中的表达式是在 $z=kr'$ 处取值的朗斯基行列式 $W[j_{\\ell}(z), h_{\\ell}^{(1)}(z)]$ 的 $k$ 倍。\n球贝塞尔函数 $j_{\\ell}(z)$ 和 $y_{\\ell}(z)$ 的朗斯基行列式为 $W[j_{\\ell}(z), y_{\\ell}(z)] = z^{-2}$。因此，我们需要的朗斯基行列式是：\n$$W[j_{\\ell}(z), h_{\\ell}^{(1)}(z)] = W[j_{\\ell}(z), j_{\\ell}(z) + i y_{\\ell}(z)] = i W[j_{\\ell}(z), y_{\\ell}(z)] = \\frac{i}{z^{2}}$$\n代入 $z=kr'$，跳跃条件变为：\n$$C_{\\ell} r'^{2} k \\left( \\frac{i}{(kr')^{2}} \\right) = -1 \\implies C_{\\ell} \\frac{i}{k} = -1 \\implies C_{\\ell} = ik$$\n该常数与 $\\ell$ 无关。因此，径向格林函数为：\n$$g_{\\ell}(r,r') = ik \\, j_{\\ell}(kr_{}) \\, h_{\\ell}^{(1)}(kr_{>})$$\n现在我们通过将此结果代回其级数展开式来重组完整的格林函数：\n$$G(\\mathbf{r},\\mathbf{r}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} ik \\, j_{\\ell}(kr_{}) \\, h_{\\ell}^{(1)}(kr_{>}) Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n$$G(\\mathbf{r},\\mathbf{r}') = ik \\sum_{\\ell=0}^{\\infty} j_{\\ell}(kr_{}) \\, h_{\\ell}^{(1)}(kr_{>}) \\left( \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') \\right)$$\n最后，我们使用球谐函数的加法定理来简化对 $m$ 的求和：\n$$\\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') = \\frac{2\\ell+1}{4\\pi} P_{\\ell}(\\cos\\gamma)$$\n其中 $P_{\\ell}$ 是 $\\ell$ 阶勒让德多项式，$\\gamma = \\arccos(\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}')$ 是观测方向和源方向之间的夹角。\n将此代入 $G(\\mathbf{r},\\mathbf{r}')$ 的表达式，得到最终结果：\n$$G(\\mathbf{r},\\mathbf{r}') = ik \\sum_{\\ell=0}^{\\infty} j_{\\ell}(kr_{})h_{\\ell}^{(1)}(kr_{>}) \\frac{2\\ell+1}{4\\pi} P_{\\ell}(\\cos\\gamma)$$\n这就是自由空间亥姆霍兹格林函数的球面波展开。", "answer": "$$\\boxed{\\frac{ik}{4\\pi} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) j_{\\ell}(kr_{}) h_{\\ell}^{(1)}(kr_{>}) P_{\\ell}(\\cos\\gamma)}$$", "id": "3312732"}, {"introduction": "标量格林函数描述的是标量波，而电磁场是矢量场，这需要一种更复杂的工具：并矢格林函数。本练习要求你推导电场并矢格林函数，并将其分解为基本的横向和纵向分量。这个过程不仅仅是数学推演，它揭示了格林函数结构与高斯定律和电荷守恒等物理定律的执行之间的深刻联系。[@problem_id:3312799]", "problem": "考虑一个由介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 表征的均匀、各向同性、无源的背景，并采用时谐约定 $\\exp(-i \\omega t)$。设 $\\mathbf{E}(\\mathbf{r})$ 是由一个紧支撑的时谐外加电流密度 $\\mathbf{J}(\\mathbf{r})$ 产生的电场，该电流密度满足电荷连续性方程 $\\nabla \\cdot \\mathbf{J} = i\\omega\\rho$，其中 $\\rho$ 是时谐电荷密度。将电场并矢格林函数 $\\mathbf{G}_E(\\mathbf{r})$ 定义为满足矢量亥姆霍兹方程和出射波（Sommerfeld）辐射条件的分布值并矢：\n$$\n\\nabla \\times \\nabla \\times \\mathbf{G}_E(\\mathbf{r}) - k^{2} \\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\, \\delta(\\mathbf{r}),\n$$\n其中 $k^{2} = \\omega^{2} \\mu \\varepsilon$，$\\mathbf{I}$ 是单位并矢。物理场由以下体势表示：\n$$\n\\mathbf{E}(\\mathbf{r}) = i\\omega\\mu \\int_{\\mathbb{R}^{3}} \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}') \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'.\n$$\n\n从麦克斯韦方程组和上述定义出发：\n- 推导 $\\mathbf{G}_E(\\mathbf{r})$ 在自由空间中（对于 $|\\mathbf{r}| \\neq 0$）的闭合形式显式表达式。\n- 将 $\\mathbf{G}_E(\\mathbf{r})$ 分解为一个横向部分 $\\mathbf{G}_E^{T}(\\mathbf{r})$ 和一个纵向部分 $\\mathbf{G}_E^{L}(\\mathbf{r})$，使得在分布意义下 $\\nabla \\cdot \\mathbf{G}_E^{T} = \\mathbf{0}$ 和 $\\nabla \\times \\mathbf{G}_E^{L} = \\mathbf{0}$，并提供 $|\\mathbf{r}| \\neq 0$ 时 $\\mathbf{G}_E^{T}(\\mathbf{r})$ 和 $\\mathbf{G}_E^{L}(\\mathbf{r})$ 的闭合形式表达式。\n- 仅使用基本定律，通过 $\\mathbf{G}_E$ 散度的恒等式解释纵向部分如何保证电荷守恒，并证明高斯定律 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon$ 可由体势表示导出。\n\n令 $r = |\\mathbf{r}|$ 且 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$。将你的最终答案表示为一个包含 $\\mathbf{G}_E(\\mathbf{r})$、$\\mathbf{G}_E^{T}(\\mathbf{r})$ 和 $\\mathbf{G}_E^{L}(\\mathbf{r})$ 的单行矩阵，使用紧凑的并矢形式，且对 $r \\neq 0$ 有效。最终答案必须是单一的闭合形式解析表达式（不含不等式或方程，且最终方框内不包含单位）。", "solution": "该问题是一个标准的、基于麦克斯韦理论的计算电磁学中的适定问题，因此是有效的。它完整、一致，没有任何科学或逻辑上的缺陷。我们开始进行解答。\n\n该问题要求推导自由空间中的电场并矢格林函数 $\\mathbf{G}_E(\\mathbf{r})$，将其分解为横向和纵向部分，并给出与电荷守恒相关的物理解释。\n\n### 第一部分：电场并矢格林函数 $\\mathbf{G}_E(\\mathbf{r})$ 的推导\n\n我们从并矢格林函数 $\\mathbf{G}_E(\\mathbf{r})$ 的控制矢量亥姆霍兹方程出发：\n$$\n\\nabla \\times \\nabla \\times \\mathbf{G}_E(\\mathbf{r}) - k^{2} \\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\, \\delta(\\mathbf{r})\n$$\n其中 $k^2 = \\omega^2 \\mu \\varepsilon$。我们将在分布的意义下求解此方程。对此方程取散度，并利用恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = \\mathbf{0}$，我们得到：\n$$\n-k^2 \\nabla \\cdot \\mathbf{G}_E(\\mathbf{r}) = \\nabla \\cdot (\\mathbf{I} \\delta(\\mathbf{r})) = \\nabla \\delta(\\mathbf{r})\n$$\n这给出了 $\\mathbf{G}_E(\\mathbf{r})$ 的散度：\n$$\n\\nabla \\cdot \\mathbf{G}_E(\\mathbf{r}) = -\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})\n$$\n接下来，我们使用对分布也成立的矢量恒等式 $\\nabla \\times \\nabla \\times \\mathbf{A} = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$。将其应用于 $\\mathbf{G}_E$ 的控制方程：\n$$\n\\nabla(\\nabla \\cdot \\mathbf{G}_E) - \\nabla^2 \\mathbf{G}_E - k^2 \\mathbf{G}_E = \\mathbf{I} \\delta(\\mathbf{r})\n$$\n代入已推导出的 $\\nabla \\cdot \\mathbf{G}_E$ 的表达式：\n$$\n\\nabla \\left(-\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})\\right) - (\\nabla^2 + k^2)\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\delta(\\mathbf{r})\n$$\n重新整理各项，我们得到一个关于 $\\mathbf{G}_E(\\mathbf{r})$ 的标准矢量亥姆霍兹方程：\n$$\n(\\nabla^2 + k^2)\\mathbf{G}_E(\\mathbf{r}) = -\\mathbf{I} \\delta(\\mathbf{r}) - \\frac{1}{k^2} \\nabla \\nabla \\delta(\\mathbf{r})\n$$\n该方程的解可以通过与亥姆霍兹算子的标量格林函数 $g_k(\\mathbf{r}) = \\frac{\\exp(ikr)}{4\\pi r}$进行卷积来求得。该格林函数满足 $(\\nabla^2 + k^2)g_k(\\mathbf{r}) = -\\delta(\\mathbf{r})$ 和 Sommerfeld 辐射条件。\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\int_{\\mathbb{R}^3} g_k(\\mathbf{r}-\\mathbf{r}') \\left( \\mathbf{I} \\delta(\\mathbf{r}') + \\frac{1}{k^2} \\nabla' \\nabla' \\delta(\\mathbf{r}') \\right) d^3\\mathbf{r}'\n$$\n利用狄拉克δ函数的性质和分部积分，可得：\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} g_k(\\mathbf{r}) + \\frac{1}{k^2} \\nabla \\nabla g_k(\\mathbf{r})\n$$\n这是 $\\mathbf{G}_E(\\mathbf{r})$ 的形式表达式。为了求出 $r = |\\mathbf{r}| \\neq 0$ 时的显式形式，我们计算海森矩阵 $\\nabla \\nabla g_k(r)$：\n$\\nabla g_k(r) = \\frac{dg_k}{dr}\\hat{\\mathbf{r}}$\n$\\nabla \\nabla g_k(r) = \\frac{d^2 g_k}{dr^2} (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) + \\frac{1}{r} \\frac{dg_k}{dr} (\\mathbf{I} - \\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}})$\n$g_k(r) = \\frac{\\exp(ikr)}{4\\pi r}$ 的导数为：\n$\\frac{dg_k}{dr} = \\frac{\\exp(ikr)}{4\\pi} \\left(\\frac{ik}{r} - \\frac{1}{r^2}\\right)$\n$\\frac{d^2g_k}{dr^2} = \\frac{\\exp(ikr)}{4\\pi} \\left(\\frac{-k^2}{r} - \\frac{2ik}{r^2} + \\frac{2}{r^3}\\right)$\n将这些导数代入 $\\mathbf{G}_E(\\mathbf{r})$ 的表达式并化简可得：\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right]\n$$\n\n### 第二部分：分解为横向和纵向部分\n\n我们寻求一个分解 $\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{G}_E^T(\\mathbf{r}) + \\mathbf{G}_E^L(\\mathbf{r})$，使得在分布意义下 $\\nabla \\cdot \\mathbf{G}_E^T = \\mathbf{0}$（横向）和 $\\nabla \\times \\mathbf{G}_E^L = \\mathbf{0}$（纵向）。\n\n纵向部分 $\\mathbf{G}_E^L$ 是无旋的。它的散度必须与 $\\mathbf{G}_E$ 的散度相同：\n$\\nabla \\cdot \\mathbf{G}_E^L = \\nabla \\cdot \\mathbf{G}_E = -\\frac{1}{k^2}\\nabla \\delta(\\mathbf{r})$。\n由于 $\\mathbf{G}_E^L$ 是无旋的，它的每一列都可以写成一个标量势的梯度。令 $\\mathbf{G}_E^L = \\nabla \\otimes \\boldsymbol{\\psi}$，其中 $\\boldsymbol{\\psi}$ 是某个矢量势。其散度为 $(\\nabla \\cdot \\mathbf{G}_E^L)_j = \\nabla^2 \\psi_j$。因此，我们必须求解：\n$\\nabla^2 \\psi_j(\\mathbf{r}) = -\\frac{1}{k^2} \\partial_j \\delta(\\mathbf{r})$。\n解可以通过与拉普拉斯算子的格林函数 $g_0(r) = \\frac{1}{4\\pi r}$ 进行卷积得到，该格林函数满足 $\\nabla^2 g_0(r) = -\\delta(\\mathbf{r})$。\n$\\psi_j(\\mathbf{r}) = \\int g_0(\\mathbf{r}-\\mathbf{r}') \\left(\\frac{1}{k^2}\\partial'_j \\delta(\\mathbf{r}')\\right) d^3\\mathbf{r}' = \\frac{1}{k^2} \\partial_j g_0(\\mathbf{r})$。\n所以，矢量势为 $\\boldsymbol{\\psi}(\\mathbf{r}) = \\frac{1}{k^2}\\nabla g_0(\\mathbf{r})$。纵向部分则为：\n$\\mathbf{G}_E^L(\\mathbf{r}) = \\nabla \\otimes (\\frac{1}{k^2}\\nabla g_0(\\mathbf{r})) = \\frac{1}{k^2}\\nabla\\nabla g_0(\\mathbf{r})$。\n对于 $r \\neq 0$:\n$\\nabla\\nabla g_0(r) = \\nabla\\nabla \\frac{1}{4\\pi r} = \\frac{1}{4\\pi} \\frac{3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I}}{r^3}$。\n所以，对于 $r \\neq 0$ 的纵向部分是：\n$$\n\\mathbf{G}_E^L(\\mathbf{r}) = \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n$$\n横向部分 $\\mathbf{G}_E^T(\\mathbf{r})$ 通过相减得到：$\\mathbf{G}_E^T = \\mathbf{G}_E - \\mathbf{G}_E^L$。\n$$\n\\mathbf{G}_E^T(\\mathbf{r}) = \\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] - \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n$$\n将包含 $\\mathbf{I}$ 和 $\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}$ 的项组合起来，可得：\n$$\n\\mathbf{G}_E^T(\\mathbf{r}) = \\frac{1}{4\\pi} \\left[ \\left( \\frac{\\exp(ikr)}{r} + \\frac{i\\exp(ikr)}{kr^2} + \\frac{1-\\exp(ikr)}{k^2 r^3} \\right) \\mathbf{I} - \\left(\\frac{\\exp(ikr)}{r} + \\frac{3i\\exp(ikr)}{kr^2} + \\frac{3(1-\\exp(ikr))}{k^2 r^3} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right]\n$$\n\n### 第三部分：物理解释与高斯定律\n\n格林函数的纵向部分 $\\mathbf{G}_E^L$ 直接负责保证电荷守恒，这体现在高斯定律中。横向部分 $\\mathbf{G}_E^T$ 是无散的（$\\nabla\\cdot\\mathbf{G}_E^T = \\mathbf{0}$），因此对电场的散度没有贡献。\n为了推导高斯定律，我们对 $\\mathbf{E}(\\mathbf{r})$ 的体势表示取散度：\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = \\nabla \\cdot \\left( i\\omega\\mu \\int_{\\mathbb{R}^{3}} \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}') \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' \\right) = i\\omega\\mu \\int_{\\mathbb{R}^{3}} (\\nabla \\cdot \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'\n$$\n由于 $\\nabla \\cdot \\mathbf{G}_E = \\nabla \\cdot \\mathbf{G}_E^L = -\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})$，我们有：\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = i\\omega\\mu \\int_{\\mathbb{R}^{3}} \\left(-\\frac{1}{k^2} \\nabla_{\\mathbf{r}} \\delta(\\mathbf{r} - \\mathbf{r}')\\right) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'\n$$\n使用 $\\nabla_{\\mathbf{r}} = -\\nabla_{\\mathbf{r}'}$ 并进行分部积分（对于紧支撑的电流密度 $\\mathbf{J}$，边界项为零）：\n$$\n\\int_{\\mathbb{R}^{3}} (\\nabla_{\\mathbf{r}'} \\delta(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - \\int_{\\mathbb{R}^{3}} \\delta(\\mathbf{r} - \\mathbf{r}') \\nabla'_{\\mathbf{r}'} \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - (\\nabla \\cdot \\mathbf{J})(\\mathbf{r})\n$$\n所以电场的散度变为：\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = i\\omega\\mu \\left(-\\frac{1}{k^2}\\right) \\int_{\\mathbb{R}^{3}} (-\\nabla_{\\mathbf{r}'} \\delta(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - \\frac{i\\omega\\mu}{k^2} (\\nabla \\cdot \\mathbf{J})(\\mathbf{r})\n$$\n使用电荷连续性方程 $\\nabla \\cdot \\mathbf{J} = i\\omega\\rho$ 和定义 $k^2 = \\omega^2 \\mu \\varepsilon$：\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = - \\frac{i\\omega\\mu}{\\omega^2 \\mu \\varepsilon} (i\\omega\\rho) = - \\frac{i^2 \\omega^2 \\mu}{\\omega^2 \\mu \\varepsilon} \\rho = \\frac{\\rho}{\\varepsilon}\n$$\n这正是时谐场的高斯定律。该推导表明，格林函数的奇异、无旋（纵向）部分是将电流源的散度与电场的散度联系起来的数学机制，从而确保了与电荷守恒的一致性。\n\n$r \\neq 0$ 时 $\\mathbf{G}_E(\\mathbf{r})$、$\\mathbf{G}_E^T(\\mathbf{r})$ 和 $\\mathbf{G}_E^L(\\mathbf{r})$ 的最终表达式在最终答案框中给出。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] \\\\ \\frac{1}{4\\pi} \\left[ \\left( \\frac{\\exp(ikr)}{r} + \\frac{i\\exp(ikr)}{kr^2} + \\frac{1-\\exp(ikr)}{k^2 r^3} \\right) \\mathbf{I} - \\left(\\frac{\\exp(ikr)}{r} + \\frac{3i\\exp(ikr)}{kr^2} + \\frac{3(1-\\exp(ikr))}{k^2 r^3} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] \\\\ \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n\\end{pmatrix}\n}\n$$", "id": "3312799"}, {"introduction": "在计算电磁学中，理论知识通过数值实现来发挥其作用。这个动手编程练习专注于一个关键步骤：根据不可违背的物理原理来验证数值格林函数。通过检验能量守恒和互易性，你将学会如何确保你的计算工具不仅在数学上是正确的，而且在物理上也是可靠的，从而建立对仿真结果的信心。[@problem_id:3312781]", "problem": "考虑频域中的自由空间电磁辐射。从频域中的麦克斯韦方程组以及作为均匀各向同性介质相应矢量亥姆霍兹方程的出射解的格林函数定义出发。利用这些基础，通过检查规范源-观测器配置下的能量守恒和互易性，来验证自由空间格林函数的数值实现。验证应按以下方式进行。\n\n- 能量守恒验证：\n  - 模拟一个赫兹电偶极子源，其电流幅值均匀为 $I_0$，物理长度为 $L$，位于原点并沿 $\\hat{\\mathbf{z}}$ 轴方向。该源在自由空间中辐射，角频率为 $\\omega = 2\\pi f$，波数为 $k = \\omega/c$，其中 $c$ 是真空中的光速，$\\epsilon_0$ 是真空介电常数，$\\mu_0$ 是真空磁导率，$\\eta_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间波阻抗。\n  - 使用自由空间格林函数和适用于赫兹偶极子的远场近似，推导辐射电场和磁场，以及在以源为中心、半径为 $r_s$ 的球面上的时间平均坡印廷通量。\n  - 通过对球形观测面上的坡印廷矢量的时间平均径向分量进行积分，数值计算总辐射功率。该曲面积分必须用球坐标 $(\\theta,\\phi)$ 表示，立体角元为 $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$，所有角度必须以弧度为单位。在 $\\theta \\in [0,\\pi]$ 和 $\\phi \\in [0,2\\pi)$ 上使用矩形中点法则，并确保数值积分在科学上是合理的。\n  - 将数值积分得到的辐射功率与从第一性原理推导出的赫兹偶极子解析自由空间辐射功率进行比较。对每个测试案例，报告相对误差，以浮点数形式表示，计算公式为 $|P_{\\mathrm{num}} - P_{\\mathrm{ana}}|/|P_{\\mathrm{ana}}|$，此值为无量纲。在内部，功率必须以瓦特为单位计算，但只需输出相对误差。\n\n- 互易性验证：\n  - 实现均匀空间中标量亥姆霍兹方程的自由空间标量格林函数 $G(\\mathbf{r},\\mathbf{r}')$，并与辐射条件保持一致。\n  - 对于给定的源位置 $\\mathbf{r}_s$ 和观测点位置 $\\mathbf{r}_o$，使用相同的频率相关波数 $k$，数值计算 $G(\\mathbf{r}_o,\\mathbf{r}_s)$ 和 $G(\\mathbf{r}_s,\\mathbf{r}_o)$。通过验证这两个复数值在其幅值尺度归一化后是否在指定容差内一致，来检查互易对称性。对每个测试案例报告一个布尔值：若对称性在容差内成立则为真，否则为假。\n\n所有量必须使用国际单位制（SI）：频率 $f$ 以赫兹为单位，长度以米为单位，电流以安培为单位，功率以瓦特为单位。角度必须以弧度为单位。使用以下测试套件。\n\n- 能量守恒测试案例（提供 $f$、$I_0$、$L$、$r_s$ 和中点积分法的极向采样点数 $N_\\theta$；方位角积分是解析的，必须作为一个 $2\\pi$ 的因子精确执行）：\n  1. $f = 300 \\times 10^6$，$I_0 = 1.0$，$L = 0.05$，$r_s = 10.0$，$N_\\theta = 2000$。\n  2. $f = 2.4 \\times 10^9$，$I_0 = 0.5$，$L = 0.01$，$r_s = 10.0$，$N_\\theta = 2000$。\n  3. $f = 50 \\times 10^6$，$I_0 = 2.0$，$L = 0.10$，$r_s = 10.0$，$N_\\theta = 2000$。\n\n- 互易性测试案例（提供 $f$ 和 $(\\mathbf{r}_s,\\mathbf{r}_o)$）：\n  1. $f = 1.0 \\times 10^9$，$\\mathbf{r}_s = (0.0, 0.0, 0.0)$，$\\mathbf{r}_o = (0.3, 0.4, 0.5)$，容差 $= 10^{-12}$。\n  2. $f = 1.0 \\times 10^9$，$\\mathbf{r}_s = (1.0 \\times 10^{-9}, 0.0, 0.0)$，$\\mathbf{r}_o = (0.0, 0.0, 0.0)$，容差 $= 10^{-12}$。\n  3. $f = 1.0 \\times 10^9$，$\\mathbf{r}_s = (10.0, 10.0, 10.0)$，$\\mathbf{r}_o = (-5.0, 7.0, -3.0)$，容差 $= 10^{-12}$。\n\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果按以下顺序排列：三个能量守恒相对误差（浮点数）后跟三个互易性检查（布尔值）。例如，输出格式必须完全像\n\"[E1,E2,E3,R1,R2,R3]\"\n其中 $E_i$ 是浮点数，$R_i$ 是布尔值。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于经典电磁学原理，在数学上是适定的，并为获得唯一解提供了充分信息。这些任务涉及计算电磁学中的标准验证程序：验证能量守恒和互易性。\n\n解决方案分为两部分，对应于两个验证任务。所有数学符号、变量和数字均按要求使用 LaTeX 渲染。\n\n### I. 能量守恒验证\n\n#### A. 理论基础\n能量守恒的验证始于均匀、各向同性、无源介质中时谐场（时间依赖性为 $e^{-i\\omega t}$）的麦克斯韦方程组：\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega\\epsilon_0 \\mathbf{E} + \\mathbf{J} $$\n对于源区外的场，这些方程导出矢量亥姆霍兹方程：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) - k^2 \\mathbf{E} = \\mathbf{0} $$\n其中 $k = \\omega/c = 2\\pi f \\sqrt{\\mu_0\\epsilon_0}$ 是自由空间波数。对于一个电流源 $\\mathbf{J}$，非齐次方程为 $\\nabla \\times (\\nabla \\times \\mathbf{E}) - k^2 \\mathbf{E} = i\\omega\\mu_0 \\mathbf{J}$。\n\n问题模拟了一个长度为 $L$、均匀电流为 $I_0$ 的赫兹电偶极子，位于原点并沿 $\\hat{\\mathbf{z}}$ 轴方向。其电流密度可近似为 $\\mathbf{J}(\\mathbf{r}') = I_0 L \\delta(\\mathbf{r}') \\hat{\\mathbf{z}}$，其中 $\\delta(\\mathbf{r}')$ 是狄拉克δ函数。项 $I_0 L$ 代表电流偶极矩。\n\n在远场区（距离 $r \\gg \\lambda = 2\\pi/k$），辐射电场和磁场由下式给出：\n$$ \\mathbf{E}(\\mathbf{r}) \\approx -i \\frac{k \\eta_0 I_0 L}{4\\pi r} e^{ikr} (\\sin\\theta) \\hat{\\boldsymbol{\\theta}} $$\n$$ \\mathbf{H}(\\mathbf{r}) \\approx -i \\frac{k I_0 L}{4\\pi r} e^{ikr} (\\sin\\theta) \\hat{\\boldsymbol{\\phi}} $$\n此处，$\\eta_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间的本征阻抗，$(\\hat{\\mathbf{r}}, \\hat{\\boldsymbol{\\theta}}, \\hat{\\boldsymbol{\\phi}})$ 是球坐标系中的单位矢量。\n\n时间平均坡印廷矢量代表功率通量密度，为 $\\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\{\\mathbf{E} \\times \\mathbf{H}^*\\}$。代入远场表达式：\n$$ \\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\left\\{ \\left(-i \\frac{k \\eta_0 I_0 L \\sin\\theta}{4\\pi r} e^{ikr} \\hat{\\boldsymbol{\\theta}}\\right) \\times \\left(i \\frac{k I_0 L \\sin\\theta}{4\\pi r} e^{-ikr} \\hat{\\boldsymbol{\\phi}}\\right) \\right\\} $$\n$$ \\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\left\\{ \\eta_0 \\left(\\frac{k I_0 L}{4\\pi r}\\right)^2 \\sin^2\\theta (\\hat{\\boldsymbol{\\theta}} \\times \\hat{\\boldsymbol{\\phi}}) \\right\\} = \\frac{\\eta_0}{2} \\left(\\frac{k I_0 L}{4\\pi r}\\right)^2 \\sin^2\\theta \\, \\hat{\\mathbf{r}} $$\n径向分量为 $S_r = |\\mathbf{S}_{\\mathrm{avg}}|$。\n\n总辐射功率 $P_{\\mathrm{ana}}$ 通过对任意半径 $r_s$ 球面上的 $S_r$ 进行面积分得到：\n$$ P_{\\mathrm{ana}} = \\oint_S \\mathbf{S}_{\\mathrm{avg}} \\cdot d\\mathbf{a} = \\int_0^{2\\pi} \\int_0^{\\pi} S_r(r_s, \\theta) r_s^2 \\sin\\theta d\\theta d\\phi $$\n由于被积函数与 $\\phi$ 无关，方位角积分产生一个 $2\\pi$ 因子：\n$$ P_{\\mathrm{ana}} = 2\\pi r_s^2 \\int_0^{\\pi} \\frac{\\eta_0}{2} \\left(\\frac{k I_0 L}{4\\pi r_s}\\right)^2 \\sin^2\\theta \\sin\\theta d\\theta $$\n$$ P_{\\mathrm{ana}} = \\pi r_s^2 \\frac{\\eta_0 k^2 (I_0 L)^2}{16 \\pi^2 r_s^2} \\int_0^{\\pi} \\sin^3\\theta d\\theta = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} \\int_0^{\\pi} \\sin^3\\theta d\\theta $$\n该定积分的值为 $\\int_0^\\pi \\sin^3\\theta d\\theta = 4/3$。代入此值得到解析功率：\n$$ P_{\\mathrm{ana}} = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} \\left(\\frac{4}{3}\\right) = \\frac{\\eta_0 k^2 (I_0 L)^2}{12\\pi} $$\n\n#### B. 数值实现\n数值计算的功率 $P_{\\mathrm{num}}$ 通过使用具有 $N_\\theta$ 个区间的矩形中点法则计算积分 $\\int_0^{\\pi} \\sin^3\\theta d\\theta$ 得到。\n区间 $[0, \\pi]$被划分为 $N_\\theta$ 个宽度为 $\\Delta\\theta = \\pi/N_\\theta$ 的子区间。中点为 $\\theta_i = (i - 0.5)\\Delta\\theta$，其中 $i = 1, 2, \\ldots, N_\\theta$。\n数值积分为：\n$$ I_{\\mathrm{num}} = \\int_0^{\\pi} \\sin^3\\theta d\\theta \\approx \\sum_{i=1}^{N_\\theta} \\sin^3(\\theta_i) \\Delta\\theta $$\n因此，数值计算的功率为：\n$$ P_{\\mathrm{num}} = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} I_{\\mathrm{num}} $$\n相对误差为 $E = |P_{\\mathrm{num}} - P_{\\mathrm{ana}}|/|P_{\\mathrm{ana}}|$。我们可以简化这个表达式：\n$$ E = \\left| \\frac{P_{\\mathrm{num}}}{P_{\\mathrm{ana}}} - 1 \\right| = \\left| \\frac{\\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} I_{\\mathrm{num}}}{\\frac{\\eta_0 k^2 (I_0 L)^2}{12\\pi}} - 1 \\right| = \\left| \\frac{12}{16} I_{\\mathrm{num}} - 1 \\right| = \\left| \\frac{3}{4} I_{\\mathrm{num}} - 1 \\right| $$\n这个简化公式避免了显式计算功率值，仅依赖于 $\\sin^3\\theta$ 项数值积分的精度。\n\n### II. 互易性验证\n\n#### A. 理论基础\n标量亥姆霍兹方程由 $(\\nabla^2 + k^2) \\psi(\\mathbf{r}) = -f(\\mathbf{r})$ 给出，其中 $\\psi$ 是一个标量场，$f$ 是一个源。标量格林函数 $G(\\mathbf{r}, \\mathbf{r}')$ 是该方程对点源，即 $f(\\mathbf{r}) = \\delta(\\mathbf{r}-\\mathbf{r}')$ 的解：\n$$ (\\nabla^2 + k^2) G(\\mathbf{r}, \\mathbf{r}') = -\\delta(\\mathbf{r} - \\mathbf{r}') $$\n对于三维均匀自由空间中的出射波（对应 $e^{-i\\omega t}$ 时间约定），解为：\n$$ G(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik|\\mathbf{r} - \\mathbf{r}'|}}{4\\pi|\\mathbf{r} - \\mathbf{r}'|} $$\n在此背景下，洛伦兹互易定理意味着格林函数对其源点和观测点参数的交换是对称的：\n$$ G(\\mathbf{r}_o, \\mathbf{r}_s) = G(\\mathbf{r}_s, \\mathbf{r}_o) $$\n这从公式中显而易见，因为欧几里得距离是对称的：$|\\mathbf{r}_o - \\mathbf{r}_s| = |\\mathbf{r}_s - \\mathbf{r}_o|$。\n\n#### B. 数值实现\n验证需要实现标量格林函数 $G$ 并对每对源和观测点位置 $(\\mathbf{r}_s, \\mathbf{r}_o)$ 进行求值。波数 $k=2\\pi f/c$ 由给定频率 $f$ 计算得出。\n我们计算两个值：\n1. $G_1 = G(\\mathbf{r}_o, \\mathbf{r}_s)$\n2. $G_2 = G(\\mathbf{r}_s, \\mathbf{r}_o)$\n解析上，$G_1 = G_2$。在数值上，一个直接的实现也将产生位级相同的结果，因为运算（矢量减法和范数）在计算上是对称的。互易性的检查变成了数值相等性的检查。\n问题要求验证这些值是否在容差范围内一致。短语“在其幅值尺度归一化后”表明需要进行相对比较，这对于跨越不同数量级的值是稳健的。我们使用一个等效于相对容差比较的检查：具体来说，是`numpy.isclose`，它基于 `|a-b| = atol + rtol * |b|` 来比较两个值。通过将绝对容差 `atol` 设置为 $0$，并将相对容差 `rtol` 设置为问题中指定的容差，我们执行了一个稳健的相对比较。由于实现的函数将为 $G_1$ 和 $G_2$ 产生相同的结果，它们的差为 $0$，因此对于任何正容差，测试都将通过。", "answer": "```python\nimport numpy as np\nimport scipy.constants as const\n\ndef solve():\n    \"\"\"\n    Solves the validation problem for energy conservation and reciprocity.\n    \"\"\"\n    \n    # Physical Constants from SciPy\n    c = const.c  # Speed of light in vacuum (m/s)\n    mu_0 = const.mu_0  # Vacuum permeability (H/m)\n    epsilon_0 = const.epsilon_0  # Vacuum permittivity (F/m)\n    eta_0 = np.sqrt(mu_0 / epsilon_0)  # Intrinsic impedance of free space (Ohms)\n\n    # --- Energy Conservation Validation ---\n    \n    # Test cases: (f in Hz, I0 in A, L in m, rs in m, N_theta)\n    energy_test_cases = [\n        (300e6, 1.0, 0.05, 10.0, 2000),\n        (2.4e9, 0.5, 0.01, 10.0, 2000),\n        (50e6, 2.0, 0.10, 10.0, 2000),\n    ]\n\n    energy_results = []\n    for f, I0, L, rs, N_theta in energy_test_cases:\n        # The analytical value of the integral of sin^3(theta) from 0 to pi is 4/3.\n        # The relative error E = | (3/4) * I_num - 1 |, where I_num is the\n        # numerical integral. This avoids calculating the full power values.\n\n        # Numerical integration using the rectangular midpoint rule\n        delta_theta = np.pi / N_theta\n        # Midpoint theta values\n        theta_i = (np.arange(N_theta) + 0.5) * delta_theta\n        \n        # Integrand is sin^3(theta)\n        integrand_values = np.sin(theta_i)**3\n        \n        # Calculate the numerical integral\n        integral_numeric = np.sum(integrand_values) * delta_theta\n        \n        # Calculate the relative error\n        relative_error = np.abs((3.0 / 4.0) * integral_numeric - 1.0)\n        energy_results.append(relative_error)\n\n    # --- Reciprocity Validation ---\n    \n    def scalar_green_function(r_obs, r_src, k):\n        \"\"\"\n        Calculates the scalar free-space Green's function G(r_obs, r_src)\n        for the exp(-i*omega*t) time convention.\n        \"\"\"\n        r_obs_vec = np.array(r_obs)\n        r_src_vec = np.array(r_src)\n        R = np.linalg.norm(r_obs_vec - r_src_vec)\n        \n        # Avoid division by zero, though test cases do not have r_obs = r_src.\n        if R == 0:\n            return np.inf + 0j\n        \n        return np.exp(1j * k * R) / (4 * np.pi * R)\n\n    # Test cases: (f in Hz, r_s as tuple, r_o as tuple, tolerance)\n    reciprocity_test_cases = [\n        (1.0e9, (0.0, 0.0, 0.0), (0.3, 0.4, 0.5), 1e-12),\n        (1.0e9, (1.0e-9, 0.0, 0.0), (0.0, 0.0, 0.0), 1e-12),\n        (1.0e9, (10.0, 10.0, 10.0), (-5.0, 7.0, -3.0), 1e-12),\n    ]\n\n    reciprocity_results = []\n    for f, r_s, r_o, tolerance in reciprocity_test_cases:\n        k = 2 * np.pi * f / c\n        \n        # Evaluate Green's function for G(ro, rs) and G(rs, ro)\n        G_os = scalar_green_function(r_o, r_s, k)\n        G_so = scalar_green_function(r_s, r_o, k)\n        \n        # A standard symmetric implementation ensures G_os and G_so are\n        # numerically identical, so their difference is zero. The check will pass.\n        # We use np.isclose with a relative tolerance as it is the most\n        # robust interpretation of the problem's language.\n        # atol is set to 0.0 to enforce a purely relative comparison.\n        holds = np.isclose(G_os, G_so, rtol=tolerance, atol=0.0)\n        reciprocity_results.append(holds)\n\n    # Combine results and format output\n    all_results = energy_results + reciprocity_results\n    \n    def format_result(item):\n        if isinstance(item, (bool, np.bool_)):\n            return str(item).lower()\n        return str(item)\n\n    print(f\"[{','.join(map(format_result, all_results))}]\")\n\nsolve()\n```", "id": "3312781"}]}