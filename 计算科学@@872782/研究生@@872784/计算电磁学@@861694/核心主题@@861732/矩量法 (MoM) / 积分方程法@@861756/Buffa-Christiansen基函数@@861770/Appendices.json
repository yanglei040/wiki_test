{"hands_on_practices": [{"introduction": "要真正掌握 Buffa-Christiansen (BC) 基函数，理论知识必须与实践应用相结合。本章提供了一系列动手练习，旨在从头开始建立您的理解。我们从单个 BC 函数的基本性质入手，然后探讨它们在更广泛函数空间中的作用，最后展示它们解决计算电磁学中关键数值挑战的强大能力。这个首个练习聚焦于定义在一个简单的双三角形贴片上的单个 Buffa-Christiansen 基函数的局部性质。通过应用曲面散度定理，您将直接验证这些函数的一个定义性特征：其曲面散度的积分值为零，这是它们在表示无散度场方面发挥作用的基石 [@problem_id:3290791]。", "problem": "考虑一个位于平面 $z=0$ 内的平面片，它由两个构成单位正方形的三角形组成。设顶点为 $v_{1}=(0,0,0)$、$v_{2}=(1,0,0)$、$v_{3}=(0,1,0)$ 和 $v_{4}=(1,1,0)$。定义两个有向三角形 $T^{+}=[v_{1},v_{2},v_{3}]$ 和 $T^{-}=[v_{2},v_{4},v_{3}]$，它们共享内部边 $e=[v_{2},v_{3}]$。令 $\\Gamma=T^{+}\\cup T^{-}$ 表示该片，并令 $\\partial\\Gamma$ 为其外边界，由四条外边 $[v_{1},v_{2}]$、$v_{1},v_{3}]$、$v_{2},v_{4}]$ 和 $[v_{4},v_{3}]$ 组成。\n\n在每个三角形 $T\\in\\{T^{+},T^{-}\\}$ 上，考虑最低阶Raviart–Thomas空间 (RT0)，当限制在平面 $z=0$ 时，该空间由形式为 $u(\\boldsymbol{x})=\\boldsymbol{a}+b\\,\\boldsymbol{x}$ 的向量场组成，其中 $\\boldsymbol{a}\\in\\mathbb{R}^{2}$ 且 $b\\in\\mathbb{R}$。与内部边 $e$ 相关联的Buffa–Christiansen基函数 $b_{e}\\in H(\\mathrm{div}_{\\Gamma},\\Gamma)$ 是通过取 $b_{e}|_{T^{+}}\\in \\mathrm{RT0}(T^{+})$ 和 $b_{e}|_{T^{-}}\\in \\mathrm{RT0}(T^{-})$ 组装而成，使得：\n- 在 $\\partial\\Gamma$ 的每条外边界边上，$b_{e}\\cdot \\boldsymbol{\\nu}=0$，其中 $\\boldsymbol{\\nu}$ 表示平面内指向 $\\partial T^{\\pm}$ 外部的单位余法向量，\n- 跨共享边 $e$ 的法向分量是连续的，且\n- 选择归一化，使得 $T^{+}$ 上跨边 $e$ 的边通量等于 $\\int_{e} b_{e}\\cdot \\boldsymbol{\\nu}_{e}^{+}\\,\\mathrm{d}\\ell=1$，其中 $\\boldsymbol{\\nu}_{e}^{+}$ 是 $T^{+}$ 沿边 $e$ 的单位外向余法向量。\n\n仅从上述定义和曲面散度定理出发，显式计算积分\n$$\nI \\;=\\; \\int_{\\Gamma} \\mathrm{div}_{\\Gamma}\\, b_{e}\\,\\mathrm{d}S.\n$$\n的值。您的计算必须是自洽的，并且只能使用指定的片的几何数据和为 $b_{e}$ 列出的性质。将您的最终答案表示为单个实数。不需要单位。", "solution": "该问题经评估有效。它是在计算电磁学的数值分析领域内一个适定的、有科学依据的问题。所有提供的信息都是一致的，足以推导出唯一的解。\n\n目标是计算积分 $I = \\int_{\\Gamma} \\mathrm{div}_{\\Gamma}\\, b_{e}\\,\\mathrm{d}S$。积分域 $\\Gamma$ 是一个由两个三角形组成的曲面片，$\\Gamma = T^{+} \\cup T^{-}$。向量场 $b_e$ 是分片定义的，其在每个三角形上的限制 $b_e|_{T^+}$ 和 $b_e|_{T^-}$ 是一个光滑函数（具体来说，是来自RT0空间的多项式向量场）。因此，我们可以将 $\\Gamma$ 上的积分分解为两个三角形上的积分之和：\n$$\nI = \\int_{T^{+}} \\mathrm{div}_{\\Gamma}\\, (b_e|_{T^{+}})\\,\\mathrm{d}S + \\int_{T^{-}} \\mathrm{div}_{\\Gamma}\\, (b_e|_{T^{-}})\\,\\mathrm{d}S\n$$\n由于片 $\\Gamma$ 是平的且位于平面 $z=0$ 中，曲面散度算子 $\\mathrm{div}_{\\Gamma}$ 与标准的二维散度相同，我们将其记为 $\\mathrm{div}$。我们将 $b_e$ 在三角形上的限制记为 $b_e^{+} = b_e|_{T^{+}}$ 和 $b_e^{-} = b_e|_{T^{-}}$。$I$ 的表达式变为：\n$$\nI = \\int_{T^{+}} \\mathrm{div}\\, b_{e}^{+}\\,\\mathrm{d}S + \\int_{T^{-}} \\mathrm{div}\\, b_{e}^{-}\\,\\mathrm{d}S\n$$\n问题指出，计算应基于曲面散度定理。我们将此定理分别应用于每个积分项。\n\n对于在 $T^{+}$ 上的积分：\n散度定理应用于三角形 $T^{+}$，指出向量场散度在该三角形面积上的积分等于向量场通过其边界 $\\partial T^{+}$ 的通量：\n$$\n\\int_{T^{+}} \\mathrm{div}\\, b_{e}^{+}\\,\\mathrm{d}S = \\oint_{\\partial T^{+}} b_{e}^{+} \\cdot \\boldsymbol{\\nu}^{+} \\,\\mathrm{d}\\ell\n$$\n其中 $\\boldsymbol{\\nu}^{+}$ 是边界 $\\partial T^{+}$ 上指向外部的单位余法向量。$T^{+} = [v_1, v_2, v_3]$ 的边界由三条边组成：$[v_1, v_2]$、$[v_3, v_1]$ 以及共享的内部边 $e = [v_2, v_3]$。边 $[v_1, v_2]$ 和 $[v_1, v_3]$（$[v_3, v_1]$ 所在的位置）是外边界 $\\partial\\Gamma$ 的一部分。\n\n根据 $b_e$ 的性质2，向量场的法向分量在片 $\\Gamma$ 的外边界上为零：在 $\\partial\\Gamma$ 上有 $b_{e}\\cdot \\boldsymbol{\\nu}=0$。这意味着在 $\\partial T^{+}$ 位于 $\\partial\\Gamma$ 上的部分的通量积分为零。因此，边界积分简化为仅在内部边 $e$ 上的积分：\n$$\n\\oint_{\\partial T^{+}} b_{e}^{+} \\cdot \\boldsymbol{\\nu}^{+} \\,\\mathrm{d}\\ell = \\int_{e} b_{e}^{+} \\cdot \\boldsymbol{\\nu}_{e}^{+} \\,\\mathrm{d}\\ell\n$$\n其中 $\\boldsymbol{\\nu}_{e}^{+}$ 是 $T^{+}$ 沿边 $e$ 的单位外向余法向量，与问题的记法一致。\n\n性质4提供了 $b_e$ 的归一化条件，这正是该积分的值：\n$$\n\\int_{e} b_{e}\\cdot \\boldsymbol{\\nu}_{e}^{+}\\,\\mathrm{d}\\ell = 1\n$$\n因此，我们 $I$ 表达式中的第一项是：\n$$\n\\int_{T^{+}} \\mathrm{div}\\, b_{e}^{+}\\,\\mathrm{d}S = 1\n$$\n\n对于在 $T^{-}$ 上的积分：\n类似地，我们将散度定理应用于三角形 $T^{-}$：\n$$\n\\int_{T^{-}} \\mathrm{div}\\, b_{e}^{-}\\,\\mathrm{d}S = \\oint_{\\partial T^{-}} b_{e}^{-} \\cdot \\boldsymbol{\\nu}^{-} \\,\\mathrm{d}\\ell\n$$\n其中 $\\boldsymbol{\\nu}^{-}$ 是边界 $\\partial T^{-}$ 上指向外部的单位余法向量。$T^{-} = [v_2, v_4, v_3]$ 的边界由外边 $[v_2, v_4]$ 和 $[v_4, v_3]$，以及内部边 $[v_3, v_2]$（对应于 $-e$）组成。同样，性质2确保了通过外边的通量为零。边界积分简化为在共享边 $e$ 上的积分：\n$$\n\\oint_{\\partial T^{-}} b_{e}^{-} \\cdot \\boldsymbol{\\nu}^{-} \\,\\mathrm{d}\\ell = \\int_{e} b_{e}^{-} \\cdot \\boldsymbol{\\nu}_{e}^{-} \\,\\mathrm{d}\\ell\n$$\n其中 $\\boldsymbol{\\nu}_{e}^{-}$ 是 $T^{-}$ 沿边 $e$ 的单位外向余法向量。\n\n现在，我们必须使用性质3，该性质指出 $b_e$ 跨共享边 $e$ 的法向分量是连续的。对于空间 $H(\\mathrm{div}_{\\Gamma},\\Gamma)$ 中的向量场，跨两个单元 $T^{+}$ 和 $T^{-}$ 之间的内部界面 $e$ 的法向分量的连续性表示为：\n$$\n(b_e|_{T^{+}}) \\cdot \\boldsymbol{\\nu}_{e}^{+} + (b_e|_{T^{-}}) \\cdot \\boldsymbol{\\nu}_{e}^{-} = 0 \\quad \\text{for all points on } e\n$$\n该条件确保了离开 $T^{+}$ 跨越 $e$ 的通量等于进入 $T^{-}$ 跨越 $e$ 的通量。由此关系，我们得到：\n$$\nb_{e}^{-} \\cdot \\boldsymbol{\\nu}_{e}^{-} = -b_{e}^{+} \\cdot \\boldsymbol{\\nu}_{e}^{+} \\quad \\text{on } e\n$$\n将此代入第二项的积分中，我们发现：\n$$\n\\int_{e} b_{e}^{-} \\cdot \\boldsymbol{\\nu}_{e}^{-} \\,\\mathrm{d}\\ell = \\int_{e} (-b_{e}^{+} \\cdot \\boldsymbol{\\nu}_{e}^{+}) \\,\\mathrm{d}\\ell = - \\int_{e} b_{e}^{+} \\cdot \\boldsymbol{\\nu}_{e}^{+} \\,\\mathrm{d}\\ell\n$$\n再次使用性质4，$\\int_{e} b_{e}^{+} \\cdot \\boldsymbol{\\nu}_{e}^{+} \\,\\mathrm{d}\\ell = 1$，我们得到：\n$$\n\\int_{T^{-}} \\mathrm{div}\\, b_{e}^{-}\\,\\mathrm{d}S = -1\n$$\n\n最后，我们将两个三角形的结果相加，求得总积分 $I$：\n$$\nI = \\left(\\int_{T^{+}} \\mathrm{div}\\, b_{e}^{+}\\,\\mathrm{d}S\\right) + \\left(\\int_{T^{-}} \\mathrm{div}\\, b_{e}^{-}\\,\\mathrm{d}S\\right) = 1 + (-1) = 0\n$$\n积分为 $0$。这个结果反映了像Buffa-Christiansen函数这类散度协调基函数的一个基本性质：在内部基函数的支集上，总散度为零。", "answer": "$$\\boxed{0}$$", "id": "3290791"}, {"introduction": "BC 基函数并非孤立地工作；当与 Rao-Wilton-Glisson (RWG) 基函数配对使用时，它们真正的威力才会显现。本练习使用矢量球谐函数的优雅框架来模拟这两个函数集如何协同工作，以分解球面上的矢量场。通过计算投影误差，您将对亥姆霍兹-霍奇分解（Helmholtz-Hodge decomposition）建立直观认识，并看到 RWG 函数如何捕捉场的无旋（极向）部分，而 BC 函数如何捕捉场的无散（环向）部分 [@problem_id:3290741]。", "problem": "考虑单位球面 $S^{2} \\subset \\mathbb{R}^{3}$，其单位外法向量为 $\\hat{\\boldsymbol{r}}$，曲面测度为 $\\mathrm{d}S$。对于一个切向矢量场 $\\boldsymbol{f}: S^{2} \\to \\mathbb{R}^{3}$，将 $L^{2}$ 内积定义为\n$$\n\\langle \\boldsymbol{u}, \\boldsymbol{v} \\rangle_{L^{2}(S^{2})} = \\int_{S^{2}} \\boldsymbol{u}(\\boldsymbol{x}) \\cdot \\boldsymbol{v}(\\boldsymbol{x}) \\,\\mathrm{d}S(\\boldsymbol{x}).\n$$\n设 $Y_{l m}$ 为 $S^{2}$ 上的标量球谐函数，在 $L^{2}(S^{2})$ 中是标准正交的，并用 $\\nabla_{\\Gamma}$ 表示曲面梯度。将极向和环向矢量球谐函数定义为\n$$\n\\boldsymbol{P}_{l m} := \\frac{\\nabla_{\\Gamma} Y_{l m}}{\\sqrt{l(l+1)}}, \\qquad \\boldsymbol{T}_{l m} := \\frac{\\hat{\\boldsymbol{r}} \\times \\nabla_{\\Gamma} Y_{l m}}{\\sqrt{l(l+1)}}.\n$$\n在此归一化下，$\\{\\boldsymbol{P}_{l m}\\}_{l \\ge 1, |m| \\le l}$ 和 $\\{\\boldsymbol{T}_{l m}\\}_{l \\ge 1, |m| \\le l}$ 共同构成了光滑切向场的一个 $L^{2}(S^{2})$-标准正交基，并且 $S^{2}$ 上的 Hodge 分解表明，任何光滑切向场都可以唯一地展开为\n$$\n\\boldsymbol{f} = \\sum_{l=1}^{\\infty} \\sum_{m=-l}^{l} \\left( b_{l m} \\boldsymbol{P}_{l m} + a_{l m} \\boldsymbol{T}_{l m} \\right),\n$$\n其系数为 $b_{l m} = \\langle \\boldsymbol{f}, \\boldsymbol{P}_{l m} \\rangle_{L^{2}(S^{2})}$ 和 $a_{l m} = \\langle \\boldsymbol{f}, \\boldsymbol{T}_{l m} \\rangle_{L^{2}(S^{2})}$。\n\n在计算电磁学的边界积分公式中，Rao–Wilton–Glisson (RWG) 基函数是曲面 $\\mathrm{H}(\\mathrm{div}_{\\Gamma})$-协调的，而 Buffa–Christiansen (BC) 基函数（构建于重心加密网格上）是曲面 $\\mathrm{H}(\\mathrm{curl}_{\\Gamma})$-协调的。在球面上，在准均匀三角剖分的理想化连续极限下 (网格参数 $h \\to 0$)，RWG 基函数近似极向模，而 BC 基函数近似环向模，稳定的 RWG–BC 配对产生的投影算子，在矢量球谐函数基下，分别解耦为针对极向和环向分量的关于 $l$ 的低通滤波器。\n\n假设一个光滑切向场只包含 $m=0$ 的模态，\n$$\n\\boldsymbol{f} = \\sum_{l=1}^{4} a_{l} \\boldsymbol{T}_{l 0} + \\sum_{l=1}^{3} b_{l} \\boldsymbol{P}_{l 0},\n$$\n具体系数为\n$$\na_{1} = 1, \\quad a_{2} = \\frac{1}{2}, \\quad a_{3} = \\frac{1}{3}, \\quad a_{4} = \\frac{1}{4}, \\qquad\nb_{1} = \\frac{1}{2}, \\quad b_{2} = -\\frac{1}{3}, \\quad b_{3} = \\frac{1}{6}.\n$$\n对于 $L \\in \\{1,2,3\\}$，将 RWG 投影算子建模为到 $\\mathrm{span}\\{\\boldsymbol{P}_{l 0} : 1 \\le l \\le L\\}$ 上的 $L^{2}(S^{2})$ 正交投影算子，并将 BC 投影算子建模为到 $\\mathrm{span}\\{\\boldsymbol{T}_{l 0} : 1 \\le l \\le L\\}$ 上的 $L^{2}(S^{2})$ 正交投影算子。仅使用矢量球谐函数的正交性和归一性以及上述的 Hodge 分解原理，计算 $L^{2}(S^{2})$ 投影误差范数\n$$\nE_{\\mathrm{RWG}}(L) := \\|\\boldsymbol{f} - \\Pi_{\\mathrm{RWG}}^{L} \\boldsymbol{f}\\|_{L^{2}(S^{2})}, \\qquad\nE_{\\mathrm{BC}}(L) := \\|\\boldsymbol{f} - \\Pi_{\\mathrm{BC}}^{L} \\boldsymbol{f}\\|_{L^{2}(S^{2})},\n$$\n对于 $L = 1, 2, 3$。以精确解析形式（无舍入）的单行矩阵 $\\big(E_{\\mathrm{RWG}}(1), E_{\\mathrm{BC}}(1), E_{\\mathrm{RWG}}(2), E_{\\mathrm{BC}}(2), E_{\\mathrm{RWG}}(3), E_{\\mathrm{BC}}(3)\\big)$ 给出你的最终答案。误差是无量纲的；最终答案中不要包含单位。", "solution": "出发点是矢量球谐函数 $\\boldsymbol{P}_{l m}$ 和 $\\boldsymbol{T}_{l m}$ 的标准正交性，这可由标量球谐函数 $Y_{l m}$ 的标准正交性以及曲面梯度 $\\nabla_{\\Gamma}$ 的性质导出。在归一化\n$$\n\\boldsymbol{P}_{l m} := \\frac{\\nabla_{\\Gamma} Y_{l m}}{\\sqrt{l(l+1)}}, \\qquad \\boldsymbol{T}_{l m} := \\frac{\\hat{\\boldsymbol{r}} \\times \\nabla_{\\Gamma} Y_{l m}}{\\sqrt{l(l+1)}},\n$$\n下，我们有\n$$\n\\langle \\boldsymbol{P}_{l m}, \\boldsymbol{P}_{l' m'} \\rangle_{L^{2}(S^{2})} = \\delta_{l l'} \\delta_{m m'}, \\qquad\n\\langle \\boldsymbol{T}_{l m}, \\boldsymbol{T}_{l' m'} \\rangle_{L^{2}(S^{2})} = \\delta_{l l'} \\delta_{m m'}, \\qquad\n\\langle \\boldsymbol{P}_{l m}, \\boldsymbol{T}_{l' m'} \\rangle_{L^{2}(S^{2})} = 0,\n$$\n其中 $\\delta_{i j}$ 表示克罗内克(Kronecker)符号。因此，对于给定的展开式\n$$\n\\boldsymbol{f} = \\sum_{l=1}^{4} a_{l} \\boldsymbol{T}_{l 0} + \\sum_{l=1}^{3} b_{l} \\boldsymbol{P}_{l 0},\n$$\n其 $L^{2}(S^{2})$ 范数为\n$$\n\\|\\boldsymbol{f}\\|_{L^{2}(S^{2})}^{2} = \\sum_{l=1}^{4} |a_{l}|^{2} + \\sum_{l=1}^{3} |b_{l}|^{2}.\n$$\n\n根据假设，理想化的 RWG 投影算子 $\\Pi_{\\mathrm{RWG}}^{L}$ 作用为到极向张成空间 $\\mathrm{span}\\{\\boldsymbol{P}_{l 0} : 1 \\le l \\le L\\}$ 上的 $L^{2}$ 正交投影算子，而理想化的 BC 投影算子 $\\Pi_{\\mathrm{BC}}^{L}$ 作用为到环向张成空间 $\\mathrm{span}\\{\\boldsymbol{T}_{l 0} : 1 \\le l \\le L\\}$ 上的 $L^{2}$ 正交投影算子。由于基是标准正交的，并且极向/环向分量是正交的，投影误差范数可通过将被省略的系数的平方相加然后取平方根得到（帕塞瓦尔(Parseval)恒等式）。具体来说，\n$$\nE_{\\mathrm{RWG}}(L)^{2} = \\sum_{l=1}^{4} |a_{l}|^{2} + \\sum_{l=L+1}^{3} |b_{l}|^{2}, \\qquad\nE_{\\mathrm{BC}}(L)^{2} = \\sum_{l=L+1}^{4} |a_{l}|^{2} + \\sum_{l=1}^{3} |b_{l}|^{2}.\n$$\n我们现在使用给定的系数，为 $L=1,2,3$ 计算这些和\n$$\na_{1} = 1, \\quad a_{2} = \\frac{1}{2}, \\quad a_{3} = \\frac{1}{3}, \\quad a_{4} = \\frac{1}{4}, \\qquad\nb_{1} = \\frac{1}{2}, \\quad b_{2} = -\\frac{1}{3}, \\quad b_{3} = \\frac{1}{6}.\n$$\n\n首先，以精确有理数形式收集一些常见的和。为方便起见，使用公分母 $144$，\n$$\n\\sum_{l=1}^{4} |a_{l}|^{2} = 1^{2} + \\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{3}\\right)^{2} + \\left(\\frac{1}{4}\\right)^{2} = 1 + \\frac{1}{4} + \\frac{1}{9} + \\frac{1}{16} = \\frac{144 + 36 + 16 + 9}{144} = \\frac{205}{144}.\n$$\n类似地，\n$$\n\\sum_{l=1}^{3} |b_{l}|^{2} = \\left(\\frac{1}{2}\\right)^{2} + \\left(-\\frac{1}{3}\\right)^{2} + \\left(\\frac{1}{6}\\right)^{2} = \\frac{1}{4} + \\frac{1}{9} + \\frac{1}{36} = \\frac{36 + 16 + 4}{144} = \\frac{56}{144}.\n$$\n我们还需要这些和的子集：\n$$\n\\sum_{l=2}^{3} |b_{l}|^{2} = \\frac{1}{9} + \\frac{1}{36} = \\frac{16 + 4}{144} = \\frac{20}{144} = \\frac{5}{36}, \\qquad\n\\sum_{l=3}^{4} |a_{l}|^{2} = \\frac{1}{9} + \\frac{1}{16} = \\frac{16 + 9}{144} = \\frac{25}{144}, \\qquad\n|a_{4}|^{2} = \\frac{1}{16} = \\frac{9}{144}.\n$$\n\n计算 $E_{\\mathrm{RWG}}(L)$：\n\n1. 对于 $L=1$，RWG 投影算子只保留 $\\boldsymbol{P}_{1 0}$，因此\n$$\nE_{\\mathrm{RWG}}(1)^{2} = \\sum_{l=1}^{4} |a_{l}|^{2} + \\sum_{l=2}^{3} |b_{l}|^{2} = \\frac{205}{144} + \\frac{5}{36} = \\frac{205}{144} + \\frac{20}{144} = \\frac{225}{144} = \\frac{25}{16},\n$$\n所以\n$$\nE_{\\mathrm{RWG}}(1) = \\frac{5}{4}.\n$$\n\n2. 对于 $L=2$，RWG 投影算子保留 $\\boldsymbol{P}_{1 0}$ 和 $\\boldsymbol{P}_{2 0}$，因此\n$$\nE_{\\mathrm{RWG}}(2)^{2} = \\sum_{l=1}^{4} |a_{l}|^{2} + |b_{3}|^{2} = \\frac{205}{144} + \\frac{1}{36} = \\frac{205}{144} + \\frac{4}{144} = \\frac{209}{144},\n$$\n所以\n$$\nE_{\\mathrm{RWG}}(2) = \\frac{\\sqrt{209}}{12}.\n$$\n\n3. 对于 $L=3$，RWG 投影算子保留所有存在的极向项（$\\boldsymbol{P}_{1 0}$，$\\boldsymbol{P}_{2 0}$，$\\boldsymbol{P}_{3 0}$），因此\n$$\nE_{\\mathrm{RWG}}(3)^{2} = \\sum_{l=1}^{4} |a_{l}|^{2} = \\frac{205}{144},\n$$\n所以\n$$\nE_{\\mathrm{RWG}}(3) = \\frac{\\sqrt{205}}{12}.\n$$\n\n计算 $E_{\\mathrm{BC}}(L)$：\n\n1. 对于 $L=1$，BC 投影算子只保留 $\\boldsymbol{T}_{1 0}$，因此\n$$\nE_{\\mathrm{BC}}(1)^{2} = \\sum_{l=2}^{4} |a_{l}|^{2} + \\sum_{l=1}^{3} |b_{l}|^{2} = \\left(\\frac{1}{4} + \\frac{1}{9} + \\frac{1}{16}\\right) + \\frac{56}{144} = \\frac{36+16+9}{144} + \\frac{56}{144} = \\frac{61}{144} + \\frac{56}{144} = \\frac{117}{144} = \\frac{13}{16},\n$$\n所以\n$$\nE_{\\mathrm{BC}}(1) = \\frac{\\sqrt{13}}{4}.\n$$\n\n2. 对于 $L=2$，BC 投影算子保留 $\\boldsymbol{T}_{1 0}$ 和 $\\boldsymbol{T}_{2 0}$，因此\n$$\nE_{\\mathrm{BC}}(2)^{2} = \\sum_{l=3}^{4} |a_{l}|^{2} + \\sum_{l=1}^{3} |b_{l}|^{2} = \\frac{25}{144} + \\frac{56}{144} = \\frac{81}{144} = \\frac{9}{16},\n$$\n所以\n$$\nE_{\\mathrm{BC}}(2) = \\frac{3}{4}.\n$$\n\n3. 对于 $L=3$，BC 投影算子保留 $\\boldsymbol{T}_{1 0}$、$\\boldsymbol{T}_{2 0}$ 和 $\\boldsymbol{T}_{3 0}$，因此\n$$\nE_{\\mathrm{BC}}(3)^{2} = |a_{4}|^{2} + \\sum_{l=1}^{3} |b_{l}|^{2} = \\frac{9}{144} + \\frac{56}{144} = \\frac{65}{144},\n$$\n所以\n$$\nE_{\\mathrm{BC}}(3) = \\frac{\\sqrt{65}}{12}.\n$$\n\n按指定顺序 $\\big(E_{\\mathrm{RWG}}(1), E_{\\mathrm{BC}}(1), E_{\\mathrm{RWG}}(2), E_{\\mathrm{BC}}(2), E_{\\mathrm{RWG}}(3), E_{\\mathrm{BC}}(3)\\big)$ 收集所要求的六个误差，得到精确的解析表达式。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{4} & \\frac{\\sqrt{13}}{4} & \\frac{\\sqrt{209}}{12} & \\frac{3}{4} & \\frac{\\sqrt{205}}{12} & \\frac{\\sqrt{65}}{12}\\end{pmatrix}}$$", "id": "3290741"}, {"introduction": "现在我们来探讨开发 BC 基函数的主要动机：解决电场积分方程 (EFIE) 的低频崩溃问题。最后的这个练习使用一个简化的代数模型来模拟 EFIE 算子矩阵，让您能够量化当频率趋近于零时其稳定性。通过比较传统 RWG-RWG 伽辽金 (Galerkin) 格式与稳定的 RWG-BC 格式的条件数尺度变化，您将从数值上证明为什么 BC 基函数对于稳健的、频率无关的仿真是不可或缺的 [@problem_id:3290751]。", "problem": "考虑一个在频域中的理想电导体散射体的电场积分方程 (EFIE)。设时谐波数量为 $k$ (单位为 $\\mathrm{m}^{-1}$)。EFIE 通过由矢量势和标量势构建的边界积分算子，将 Lipschitz 曲面 $\\Gamma$ 上的表面电流密度 $\\mathbf{J}$ 映射到总电场 $\\mathbf{E}_t$ 的切向迹。众所周知，Helmholtz 分解将 $\\mathbf{J}$ 分解为一个表面无散部分（在 $\\Gamma$ 上散度为零）和一个表面无旋部分（表面散度非零）。当 $k \\to 0$ 时，在相容范数下衡量，作用于无散部分的矢量势贡献与 $k$ 成比例，而作用于无旋部分的标量势贡献与 $1/k$ 成比例。当使用 Rao–Wilton–Glisson (RWG) 试探函数和 Buffa–Christiansen (BC) 测试函数进行离散化时，离散算子可以在一个适应于 Helmholtz 分裂的基中表示为一个块结构。在此结构中，当 $k \\to 0$ 时，非对角耦合项消失，而对角块在范数上是均衡的。相比之下，与 RWG 测试函数进行的 Galerkin 配对会导致范数失配，从而产生持续存在的非对角耦合项，这些耦合项在 $k \\to 0$ 时不会消失。\n\n从上述基本事实和 Helmholtz 分解出发，为离散 EFIE 的低频行为构建一个自洽的块算子模型，该模型应能捕捉无散和无旋子空间的 $k$-缩放特性以及测试空间选择所带来的影响。您的模型应是纯代数的，并按如下方式定义：\n\n- 令 $n_s \\in \\mathbb{N}$ 和 $n_n \\in \\mathbb{N}$ 分别表示离散无散和无旋子空间的维度。令 $A \\in \\mathbb{R}^{n_s \\times n_s}$ 和 $D \\in \\mathbb{R}^{n_n \\times n_n}$ 为对称正定矩阵，它们分别在与 $k$ 无关的参考尺度上模拟 EFIE 在无散和无旋子空间上的离散限制。令 $B_0 \\in \\mathbb{R}^{n_s \\times n_n}$ 和 $B_1 \\in \\mathbb{R}^{n_s \\times n_n}$ 为实耦合矩阵。\n- 定义两个与 $k$ 相关的离散算子，以模拟两种测试方法：\n  - RWG–RWG Galerkin 模型：\n    $$Z_{\\mathrm{RR}}(k) \\;=\\; \\begin{bmatrix} k A & B_0 \\\\ B_0^{\\mathsf{T}} & \\dfrac{1}{k} D \\end{bmatrix}.$$\n  - RWG–BC Petrov–Galerkin 模型：\n    $$Z_{\\mathrm{RB}}(k) \\;=\\; \\begin{bmatrix} A & k B_1 \\\\ k B_1^{\\mathsf{T}} & D \\end{bmatrix}.$$\n- 对每个算子，定义谱条件数\n  $$\\kappa\\!\\left(Z(k)\\right) \\;=\\; \\dfrac{\\sigma_{\\max}\\!\\left(Z(k)\\right)}{\\sigma_{\\min}\\!\\left(Z(k)\\right)},$$\n  其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别表示最大和最小奇异值。\n\n您的任务是通过计算对数-对数关系式\n$$\\log \\kappa\\!\\left(Z(k)\\right) \\;\\approx\\; \\alpha \\, \\log k \\;+\\; \\beta,$$\n中的斜率 $\\alpha$ 来量化当 $k \\to 0$ 时 $\\kappa\\!\\left(Z_{\\mathrm{RR}}(k)\\right)$ 和 $\\kappa\\!\\left(Z_{\\mathrm{RB}}(k)\\right)$ 的渐近缩放特性。该斜率通过对一组指定的波数进行最小二乘回归来估计。斜率 $\\alpha$ 是无量纲的，必须以实数形式报告。\n\n实现要求：\n\n- 通过对实高斯矩阵 $M$ 构造 $M^{\\mathsf{T}} M$ 并加上一个正对角移位来构建对称正定矩阵 $A$ 和 $D$。确保 $B_0$ 的谱范数严格小于 $\\sqrt{\\lambda_{\\min}(A)\\,\\lambda_{\\min}(D)}$，从而使得 $Z_{\\mathrm{RR}}(k)$ 对于测试套件中的 $k$ 值保持正定。使用独立播种的伪随机数生成器，使所有构建过程都是确定性的。\n- 对于每个测试用例，针对波数集合 $k \\in \\{10^{-1},5 \\cdot 10^{-2},2 \\cdot 10^{-2},10^{-2},5 \\cdot 10^{-3},2 \\cdot 10^{-3},10^{-3}\\}$ (单位为 $\\mathrm{m}^{-1}$)，评估 $\\kappa\\!\\left(Z_{\\mathrm{RR}}(k)\\right)$ 和 $\\kappa\\!\\left(Z_{\\mathrm{RB}}(k)\\right)$。然后，使用 $(x_i,y_i)=(\\log k_i,\\log \\kappa(Z(k_i)))$ 为每个算子计算最小二乘斜率 $\\alpha$。\n- 每个测试用例的最终输出是两个斜率 $\\alpha_{\\mathrm{RB}}$ 和 $\\alpha_{\\mathrm{RR}}$，它们是实数。这些输出不需要物理单位。\n\n测试套件规范：\n\n- 测试用例 1 (维度均衡，一般情况)：\n  - 维度：$n_s = 3$, $n_n = 3$。\n  - 随机种子和移位：用种子 $12345$ 和移位 $2$ 构建 $A$，用种子 $23456$ 和移位 $2$ 构建 $D$。\n  - 耦合：\n    - $B_0$ 来自种子 $34567$，将其缩放至谱范数为 $0.3 \\cdot \\sqrt{\\lambda_{\\min}(A)\\,\\lambda_{\\min}(D)}$。\n    - $B_1$ 来自种子 $45678$，将其缩放至谱范数为 $1$。\n- 测试用例 2 (边界标量情况，近临界耦合)：\n  - 维度：$n_s = 1$, $n_n = 1$。\n  - 标量：$A = [2]$, $D = [3]$, $B_0 = [0.6 \\sqrt{2 \\cdot 3}]$。\n  - $B_1$ 来自种子 $98765$，将其缩放至谱范数为 $1$。\n- 测试用例 3 (维度不平衡)：\n  - 维度：$n_s = 4$, $n_n = 2$。\n  - 随机种子和移位：用种子 $111$ 和移位 $1$ 构建 $A$，用种子 $222$ 和移位 $1.5$ 构建 $D$。\n  - 耦合：\n    - $B_0$ 来自种子 $333$，将其缩放至谱范数为 $0.25 \\cdot \\sqrt{\\lambda_{\\min}(A)\\,\\lambda_{\\min}(D)}$。\n    - $B_1$ 来自种子 $444$，将其缩放至谱范数为 $1$。\n\n不涉及角度单位。所有输出均为无单位的实数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$[\\alpha_{\\mathrm{RB}}^{(1)}, \\alpha_{\\mathrm{RR}}^{(1)}, \\alpha_{\\mathrm{RB}}^{(2)}, \\alpha_{\\mathrm{RR}}^{(2)}, \\alpha_{\\mathrm{RB}}^{(3)}, \\alpha_{\\mathrm{RR}}^{(3)}].$$", "solution": "该问题要求分析电场积分方程 (EFIE) 两种不同数值离散化方法的低频行为。此分析通过简化的代数块算子模型进行，这些模型捕捉了潜在物理原理和数值方法的基本频率相关缩放特性。\n\nEFIE 控制着理想电导体上的表面电流密度 $\\mathbf{J}$。Helmholtz 分解提供了一个关键的理论工具，将电流 $\\mathbf{J}$ 分解为一个表面无散（散度为零）分量和一个表面无旋（旋度为零）分量。在低频极限下，即波数 $k \\to 0$ 时，EFIE 的积分算子在作用于这些分量时表现出显著不同的缩放行为。作用于无散子空间的矢量势算子与 $k$ 成比例缩放。作用于无旋子空间的标量势算子与 $1/k$ 成比例缩放。这种缩放特性上的差异是低频时数值不稳定性的根源，这种现象被称为“低频崩溃”。\n\n在矩量法离散化中，测试函数的选择显著影响所得线性系统的稳定性。本问题提出了对应于两种常见选择的两个模型：\n\n1.  **RWG–RWG (Galerkin) 模型**：试探函数和测试函数均为 Rao–Wilton–Glisson (RWG) 基函数。所得的离散算子模型为：\n    $$Z_{\\mathrm{RR}}(k) = \\begin{bmatrix} k A & B_0 \\\\ B_0^{\\mathsf{T}} & \\dfrac{1}{k} D \\end{bmatrix}$$\n    此处，$A \\in \\mathbb{R}^{n_s \\times n_s}$ 和 $D \\in \\mathbb{R}^{n_n \\times n_n}$ 是对称正定 (SPD) 矩阵，分别表示在一个参考尺度下，无散和无旋子空间上的离散化算子。$B_0 \\in \\mathbb{R}^{n_s \\times n_n}$ 代表了子空间之间频率无关的耦合。缩放失配是显式的：当 $k \\to 0$ 时，(1,1) 块消失，而 (2,2) 块发散。\n\n2.  **RWG–BC (Petrov–Galerkin) 模型**：试探函数是 RWG，但测试函数是 Buffa–Christiansen (BC) 基函数。BC 基是为修正低频崩溃而专门设计的，其方法是在无旋基函数的定义中包含一个频率缩放。这种预缩放有效地消除了标量势算子的 $1/k$ 奇异性。所得的离散算子模型为：\n    $$Z_{\\mathrm{RB}}(k) = \\begin{bmatrix} A & k B_1 \\\\ k B_1^{\\mathsf{T}} & D \\end{bmatrix}$$\n    在此模型中，对角块 $A$ 和 $D$ 具有良好的缩放特性且与 $k$ 无关。由 $k B_1$ 表示的非对角耦合在 $k \\to 0$ 时消失，在极限情况下系统趋向于一个块对角系统。\n\n目标是通过分析当 $k \\to 0$ 时其谱条件数 $\\kappa(Z(k)) = \\sigma_{\\max}(Z(k)) / \\sigma_{\\min}(Z(k))$ 的渐近缩放特性来量化这两个模型的稳定性。这通过计算数据点 $(\\log k, \\log \\kappa(Z(k)))$ 的线性拟合斜率 $\\alpha$ 来实现。\n\n**条件数的渐近分析**\n\n让我们分析在 $k \\to 0$ 的极限下，每个模型的 $\\kappa(Z(k))$ 的行为。\n\n对于 **RWG–BC 模型**，矩阵为 $Z_{\\mathrm{RB}}(k) = \\begin{bmatrix} A & k B_1 \\\\ k B_1^{\\mathsf{T}} & D \\end{bmatrix}$。当 $k \\to 0$ 时，该矩阵收敛于一个块对角矩阵：\n$$ \\lim_{k\\to 0} Z_{\\mathrm{RB}}(k) = Z_{\\mathrm{RB}}(0) = \\begin{bmatrix} A & 0 \\\\ 0 & D \\end{bmatrix} $$\n由于 $A$ 和 $D$ 是对称正定矩阵， $Z_{\\mathrm{RB}}(0)$ 的奇异值是 $A$ 和 $D$ 特征值的并集。因此条件数为：\n$$ \\kappa(Z_{\\mathrm{RB}}(0)) = \\frac{\\max(\\lambda_{\\max}(A), \\lambda_{\\max}(D))}{\\min(\\lambda_{\\min}(A), \\lambda_{\\min}(D))} $$\n这是一个与 $k$ 无关的有限正常量。对于小的 $k$ 值，$\\kappa(Z_{\\mathrm{RB}}(k))$ 将接近这个常量。因此，$\\log \\kappa(Z_{\\mathrm{RB}}(k))$ 相对于 $\\log k$ 的图像预计将近乎水平。斜率 $\\alpha_{\\mathrm{RB}}$ 应接近 $0$。这表明 RWG–BC 格式在低频下是良态的。\n\n对于 **RWG–RWG 模型**，矩阵为 $Z_{\\mathrm{RR}}(k) = \\begin{bmatrix} k A & B_0 \\\\ B_0^{\\mathsf{T}} & \\frac{1}{k} D \\end{bmatrix}$。问题规定 $A$ 和 $D$ 是对称正定矩阵，且 $\\|B_0\\|_2 < \\sqrt{\\lambda_{\\min}(A)\\lambda_{\\min}(D)}$，这确保了当 $k > 0$ 时 $Z_{\\mathrm{RR}}(k)$ 是正定的。特征值（对于对称正定矩阵即为其奇异值）的缩放可以被估计。对角块的特征值分别以 $O(k)$ 和 $O(1/k)$ 的阶数缩放。\n最大奇异值将由发散的块主导：\n$$ \\sigma_{\\max}(Z_{\\mathrm{RR}}(k)) \\approx \\sigma_{\\max}\\left(\\frac{1}{k} D\\right) = \\frac{1}{k} \\lambda_{\\max}(D) \\propto k^{-1} $$\n最小奇异值可以使用 Schur 补的性质来估计。对于一个对称正定块矩阵，最小特征值受其对角块的最小特征值所界定。从启发式角度看，它与 $kA$ 块的最小特征值相关，其缩放阶数为：\n$$ \\sigma_{\\min}(Z_{\\mathrm{RR}}(k)) \\approx k \\lambda_{\\min}(A, B_0, D) \\propto k^{1} $$\n其中项 $\\lambda_{\\min}(A, B_0, D)$ 是一个依赖于这些矩阵的常数。\n结合这些缩放特性，条件数的行为表现为：\n$$ \\kappa(Z_{\\mathrm{RR}}(k)) = \\frac{\\sigma_{\\max}(Z_{\\mathrm{RR}}(k))}{\\sigma_{\\min}(Z_{\\mathrm{RR}}(k))} \\propto \\frac{k^{-1}}{k^1} = k^{-2} $$\n取对数可得 $\\log \\kappa(Z_{\\mathrm{RR}}(k)) \\approx C - 2 \\log k$，其中 $C$ 为某个常数。因此，对数-对数图的斜率 $\\alpha_{\\mathrm{RR}}$ 预计为 $-2$。这证实了 Galerkin 格式在低频下的严重病态问题。\n\n**数值步骤**\n\n对于每个测试用例，实现将遵循以下步骤：\n1.  使用提供的随机种子和参数值，构建指定维度的矩阵 $A$、$D$、$B_0$ 和 $B_1$。对于 $A$ 和 $D$，使用一个播种的伪随机数生成器从高斯分布中生成一个矩阵 $M$，最终的对称正定矩阵构造成 $M^{\\mathsf{T}}M + \\delta I$，其中 $\\delta$ 是给定的对角移位。耦合矩阵 $B_0$ 和 $B_1$ 也由一个播种的生成器生成，然后进行缩放以达到特定的谱范数。\n2.  定义波数集合 $k_i = \\{10^{-1}, 5 \\cdot 10^{-2}, \\dots, 10^{-3}\\}$。\n3.  对于集合中的每个 $k_i$：\n    a. 组装矩阵 $Z_{\\mathrm{RB}}(k_i)$ 和 $Z_{\\mathrm{RR}}(k_i)$。\n    b. 使用标准数值库例程计算它们的奇异值。提取最大和最小奇异值 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$。\n    c. 计算条件数 $\\kappa(Z(k_i)) = \\sigma_{\\max}/\\sigma_{\\min}$。\n4.  在计算完所有 $k_i$ 的条件数后，创建两组数据点：$(\\log k_i, \\log \\kappa(Z_{\\mathrm{RB}}(k_i)))$ 和 $(\\log k_i, \\log \\kappa(Z_{\\mathrm{RR}}(k_i)))$。\n5.  对每组数据进行线性最小二乘回归，以找到斜率 $\\alpha$。对于一组点 $(x_i, y_i)$，斜率计算公式为：\n    $$ \\alpha = \\frac{\\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2} $$\n    其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x_i$ 和 $y_i$ 值的均值。\n6.  为每个测试用例报告所得的斜率 $\\alpha_{\\mathrm{RB}}$ 和 $\\alpha_{\\mathrm{RR}}$。\n\n此过程将数值上验证 $\\alpha_{\\mathrm{RB}} \\approx 0$ 和 $\\alpha_{\\mathrm{RR}} \\approx -2$ 的理论预测。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_spd_matrix(dim, seed, shift):\n    \"\"\"\n    Constructs a symmetric positive definite matrix.\n    Generated as M.T @ M + shift * I, where M is from a Gaussian distribution.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    M = rng.standard_normal((dim, dim))\n    A = M.T @ M + shift * np.identity(dim)\n    return A\n\ndef get_spectral_norm(matrix):\n    \"\"\"Computes the spectral norm (largest singular value) of a matrix.\"\"\"\n    # For scalar matrices, svd returns a scalar, need to handle this\n    if matrix.size == 1:\n        return np.abs(matrix.item())\n    return np.linalg.svd(matrix, compute_uv=False)[0]\n\ndef scale_matrix_norm(matrix, target_norm):\n    \"\"\"Scales a matrix to have a specific spectral norm.\"\"\"\n    current_norm = get_spectral_norm(matrix)\n    if np.isclose(current_norm, 0):\n        return matrix # Cannot scale a zero matrix\n    return matrix * (target_norm / current_norm)\n\ndef compute_slope(k_values, kappa_values):\n    \"\"\"\n    Computes the slope of the log-log plot using least-squares regression.\n    \"\"\"\n    x = np.log(k_values)\n    y = np.log(kappa_values)\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    \n    numerator = np.sum((x - x_mean) * (y - y_mean))\n    denominator = np.sum((x - x_mean)**2)\n    \n    if np.isclose(denominator, 0):\n        return 0.0\n        \n    return numerator / denominator\n\ndef analyze_case(params):\n    \"\"\"\n    Analyzes a single test case for both Z_RR and Z_RB models.\n    \"\"\"\n    # Unpack parameters\n    ns, nn = params[\"dims\"]\n    A_params, D_params = params[\"spd_params\"]\n    B0_params, B1_params = params[\"coupling_params\"]\n\n    # --- Matrix Construction ---\n    if A_params[\"type\"] == \"scalar\":\n        A = np.array([[A_params[\"value\"]]])\n    else:\n        A = build_spd_matrix(ns, A_params[\"seed\"], A_params[\"shift\"])\n\n    if D_params[\"type\"] == \"scalar\":\n        D = np.array([[D_params[\"value\"]]])\n    else:\n        D = build_spd_matrix(nn, D_params[\"seed\"], D_params[\"shift\"])\n\n    # --- Coupling Matrix B0 ---\n    rng_b0 = np.random.default_rng(B0_params[\"seed\"])\n    if B0_params[\"type\"] == \"scalar\":\n        B0 = np.array([[B0_params[\"value\"]]])\n    else:\n        B0_raw = rng_b0.standard_normal((ns, nn))\n        lambda_min_A = np.min(np.linalg.eigvalsh(A))\n        lambda_min_D = np.min(np.linalg.eigvalsh(D))\n        target_norm_B0 = B0_params[\"scale_factor\"] * np.sqrt(lambda_min_A * lambda_min_D)\n        B0 = scale_matrix_norm(B0_raw, target_norm_B0)\n\n    # --- Coupling Matrix B1 ---\n    rng_b1 = np.random.default_rng(B1_params[\"seed\"])\n    B1_raw = rng_b1.standard_normal((ns, nn))\n    B1 = scale_matrix_norm(B1_raw, B1_params[\"norm\"])\n    \n    # --- Wavenumbers ---\n    k_values = np.array([1e-1, 5e-2, 2e-2, 1e-2, 5e-3, 2e-3, 1e-3])\n\n    kappa_rr_values = []\n    kappa_rb_values = []\n\n    for k in k_values:\n        # Assemble Z_RR(k)\n        Z_rr = np.block([\n            [k * A, B0],\n            [B0.T, (1/k) * D]\n        ])\n        \n        # Assemble Z_RB(k)\n        Z_rb = np.block([\n            [A, k * B1],\n            [k * B1.T, D]\n        ])\n        \n        # Compute condition numbers\n        s_rr = np.linalg.svd(Z_rr, compute_uv=False)\n        kappa_rr = s_rr[0] / s_rr[-1]\n        kappa_rr_values.append(kappa_rr)\n        \n        s_rb = np.linalg.svd(Z_rb, compute_uv=False)\n        kappa_rb = s_rb[0] / s_rb[-1]\n        kappa_rb_values.append(kappa_rb)\n\n    # Compute slopes\n    alpha_rr = compute_slope(k_values, np.array(kappa_rr_values))\n    alpha_rb = compute_slope(k_values, np.array(kappa_rb_values))\n    \n    return alpha_rb, alpha_rr\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run analysis, and print results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"dims\": (3, 3),\n            \"spd_params\": (\n                {\"type\": \"generated\", \"seed\": 12345, \"shift\": 2},\n                {\"type\": \"generated\", \"seed\": 23456, \"shift\": 2}\n            ),\n            \"coupling_params\": (\n                {\"type\": \"generated\", \"seed\": 34567, \"scale_factor\": 0.3},\n                {\"seed\": 45678, \"norm\": 1.0}\n            )\n        },\n        # Test case 2\n        {\n            \"dims\": (1, 1),\n            \"spd_params\": (\n                {\"type\": \"scalar\", \"value\": 2.0},\n                {\"type\": \"scalar\", \"value\": 3.0}\n            ),\n            \"coupling_params\": (\n                {\"type\": \"scalar\", \"seed\": 0, \"value\": 0.6 * np.sqrt(2.0 * 3.0)}, # seed unused for scalar\n                {\"seed\": 98765, \"norm\": 1.0}\n            )\n        },\n        # Test case 3\n        {\n            \"dims\": (4, 2),\n            \"spd_params\": (\n                {\"type\": \"generated\", \"seed\": 111, \"shift\": 1.0},\n                {\"type\": \"generated\", \"seed\": 222, \"shift\": 1.5}\n            ),\n            \"coupling_params\": (\n                {\"type\": \"generated\", \"seed\": 333, \"scale_factor\": 0.25},\n                {\"seed\": 444, \"norm\": 1.0}\n            )\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha_rb, alpha_rr = analyze_case(case)\n        results.extend([alpha_rb, alpha_rr])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3290751"}]}