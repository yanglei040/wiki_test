{"hands_on_practices": [{"introduction": "总场/散射场 (TFSF) 方法的核心在于应用场等效原理，在计算域内创建一个虚拟的源边界。这个练习将指导你从基本原理出发，推导立方体 TFSF 边界面上等效面电流和面磁流所需的正确符号约定 [@problem_id:3318213]。正确理解和实现这些符号是任何成功 TFSF 实现的第一步，它构成了连接理论与代码的桥梁。", "problem": "在一个均匀、各向同性、无源介质（其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，波阻抗为 $\\eta=\\sqrt{\\mu/\\varepsilon}$，相速度为 $v=\\frac{1}{\\sqrt{\\mu \\varepsilon}}$）的三维时域有限差分（FDTD）模拟中，一个立方形的全场/散射场（TFSF）边界将全场区与散射场区分隔开。该立方体与笛卡尔坐标轴对齐，其各面位于 $x=x_{\\min}$、$x=x_{\\max}$、$y=y_{\\min}$、$y=y_{\\max}$、$z=z_{\\min}$ 和 $z=z_{\\max}$。每个面上的单位法向量 $\\hat{\\mathbf{n}}$ 从全场区指向外部的散射场区。\n\n该介质中的一个入射平面波由波矢量 $\\mathbf{k}=k\\,\\hat{\\mathbf{k}}$（其中 $k=\\omega/v$）、满足 $\\hat{\\mathbf{p}}\\cdot \\hat{\\mathbf{k}}=0$ 的单位极化矢量 $\\hat{\\mathbf{p}}$，以及振幅为 $E_{0}$ 的标量波形 $g(\\cdot)$ 指定。其时域场为\n$$\n\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t)=E_{0}\\,\\hat{\\mathbf{p}}\\,g\\!\\left(t-\\frac{\\hat{\\mathbf{k}}\\cdot \\mathbf{r}}{v}\\right), \\qquad\n\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t)=\\frac{1}{\\eta}\\,\\hat{\\mathbf{k}}\\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n\n从麦克斯韦方程组和场等效原理出发，推导在 TFSF 界面上产生内部全场和外部仅散射场所需的等效表面电流密度和磁流密度。然后，对 6 个面中的每一个面，用在该面上求值的 $\\mathbf{E}^{\\mathrm{inc}}$ 和 $\\mathbf{H}^{\\mathrm{inc}}$ 表示要应用于该面上的修正表达式。采用以下约定：在具有外法线 $\\hat{\\mathbf{n}}$ 的面上的等效表面电流为\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t)=\\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t), \\qquad\n\\mathbf{M}_{s}(\\mathbf{r},t)=-\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n对于六个与坐标轴对齐的面，令 $\\hat{\\mathbf{a}}_{x}=\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{a}}_{y}=\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{a}}_{z}=\\hat{\\mathbf{z}}$。通过 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$ 为面 i 定义符号 $s_{i}\\in\\{-1,+1\\}$，其中 $\\alpha(i)\\in\\{x,y,z\\}$ 选择垂直于面 i 的坐标轴，对于 $x_{\\min}$、$y_{\\min}$、$z_{\\min}$ 面，$s_{i}=-1$，对于 $x_{\\max}$、$y_{\\max}$、$z_{\\max}$ 面，$s_{i}=+1$。将每个面的修正表示为以下形式\n$$\n\\mathbf{J}_{s}^{(i)}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=-s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n\n最后，对于有序的面列表 $\\left[x_{\\min},x_{\\max},y_{\\min},y_{\\max},z_{\\min},z_{\\max}\\right]$，计算数对 $\\left(s_{J}^{(i)},s_{M}^{(i)}\\right)$ 的 12 项符号模式，其中 $s_{J}^{(i)}$ 和 $s_{M}^{(i)}$ 由以下公式定义\n$$\n\\mathbf{J}_{s}^{(i)}=s_{J}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=s_{M}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n按照顺序 $\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$，将最终的符号模式报告为单个 $1\\times 12$ 行矩阵。无需数值取整。最终答案中不要包含单位。", "solution": "该问题陈述经过了精心验证，被确定为计算电磁学中一个良构的、科学上合理的且内部一致的问题。它要求在时域有限差分（FDTD）算法的背景下，将场等效原理应用于全场/散射场（TFSF）方法。\n\nTFSF 公式将计算域划分为由闭合边界 $\\mathcal{S}$ 分隔的两个区域。$\\mathcal{S}$ 内部是全场区，其中的场是入射分量和散射分量之和：$\\mathbf{E}^{\\mathrm{tot}} = \\mathbf{E}^{\\mathrm{inc}} + \\mathbf{E}^{\\mathrm{scat}}$ 和 $\\mathbf{H}^{\\mathrm{tot}} = \\mathbf{H}^{\\mathrm{inc}} + \\mathbf{H}^{\\mathrm{scat}}$。$\\mathcal{S}$ 外部是散射场区，其中只计算散射场 $(\\mathbf{E}^{\\mathrm{scat}}, \\mathbf{H}^{\\mathrm{scat}})$。\n\n这种划分是通过在 $\\mathcal{S}$ 上引入作为源的等效表面电流来实现的。这些源被设计用来在全场区内部产生入射场 $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$，并在外部产生零场。当这些生成的场叠加到散射场模拟（根据线性性质，该模拟扩展到整个域）上时，其结果便是在 $\\mathcal{S}$ 内部得到全场，在外部得到散射场，如所期望的那样。\n\n根据场等效原理，在闭合曲面 $\\mathcal{S}$ 上，能够在 $\\mathcal{S}$ 内部产生场 $(\\mathbf{E}, \\mathbf{H})$ 并在外部产生零场的表面电流密度 $\\mathbf{J}_s$ 和磁流密度 $\\mathbf{M}_s$ 由以下公式给出：\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t) = \\hat{\\mathbf{n}} \\times \\mathbf{H}(\\mathbf{r},t)\n$$\n$$\n\\mathbf{M}_{s}(\\mathbf{r},t) = -\\hat{\\mathbf{n}} \\times \\mathbf{E}(\\mathbf{r},t)\n$$\n其中 $\\hat{\\mathbf{n}}$ 是从 $\\mathcal{S}$ 所包围的体积向外指的单位法向量。在我们的情况中，要生成的场是入射场 $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$，体积是全场区。问题陈述提供了这些精确的定义，我们在推导中将采用它们。\n\n问题要求我们为立方体 TFSF 边界的六个面上与这些电流相关的修正项确定一个符号模式。设面 $i$ 是六个面中的一个。该面的向外单位法向量记为 $\\hat{\\mathbf{n}}_i$。问题定义了关系 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$，其中 $\\hat{\\mathbf{a}}_{\\alpha(i)}$ 是沿垂直于该面的轴（$\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{y}}$ 或 $\\hat{\\mathbf{z}}$）的笛卡尔单位矢量，而 $s_i$ 是一个符号。对于位于最小坐标（$x_{\\min}$, $y_{\\min}$, $z_{\\min}$）处的面，外法线指向坐标轴负方向，因此 $s_i = -1$。对于位于最大坐标（$x_{\\max}$, $y_{\\max}$, $z_{\\max}$）处的面，外法线指向坐标轴正方向，因此 $s_i = +1$。\n\n我们的任务是通过将电流的基本定义与问题中给出的目标形式进行比较，来确定符号 $s_J^{(i)}$ 和 $s_M^{(i)}$。\n\n首先，我们来分析表面电流 $\\mathbf{J}_s^{(i)}$。\n应用于面 i 的基本定义是：\n$$\n\\mathbf{J}_{s}^{(i)} = \\hat{\\mathbf{n}}_i \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{J}_{s}^{(i)} = (s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{H}^{\\mathrm{inc}} = s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}})\n$$\n问题指定的目标形式是：\n$$\n\\mathbf{J}_{s}^{(i)} = s_{J}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n通过直接比较这两个表达式，我们推断出：\n$$\ns_{J}^{(i)} = s_i\n$$\n\n接下来，我们分析表面磁流 $\\mathbf{M}_s^{(i)}$。\n应用于面 i 的基本定义是：\n$$\n\\mathbf{M}_{s}^{(i)} = -\\hat{\\mathbf{n}}_i \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{M}_{s}^{(i)} = -(s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{E}^{\\mathrm{inc}} = -s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}})\n$$\n问题指定的目标形式是：\n$$\n\\mathbf{M}_{s}^{(i)} = s_{M}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n通过比较这两个表达式，我们推断出：\n$$\ns_{M}^{(i)} = -s_i\n$$\n\n我们现在得到了任意面 $i$ 上符号对的一般关系：$(s_{J}^{(i)}, s_{M}^{(i)}) = (s_i, -s_i)$。我们现在可以按照指定的顺序将此应用于六个面中的每一个。\n\n1.  面 $x_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{x_{\\min}} = -\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(x_{\\min})}, s_{M}^{(x_{\\min})}) = (s_{x_{\\min}}, -s_{x_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n2.  面 $x_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{x_{\\max}} = +\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(x_{\\max})}, s_{M}^{(x_{\\max})}) = (s_{x_{\\max}}, -s_{x_{\\max}}) = (1, -1)$。\n\n3.  面 $y_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{y_{\\min}} = -\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(y_{\\min})}, s_{M}^{(y_{\\min})}) = (s_{y_{\\min}}, -s_{y_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n4.  面 $y_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{y_{\\max}} = +\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(y_{\\max})}, s_{M}^{(y_{\\max})}) = (s_{y_{\\max}}, -s_{y_{\\max}}) = (1, -1)$。\n\n5.  面 $z_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{z_{\\min}} = -\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(z_{\\min})}, s_{M}^{(z_{\\min})}) = (s_{z_{\\min}}, -s_{z_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n6.  面 $z_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{z_{\\max}} = +\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(z_{\\max})}, s_{M}^{(z_{\\max})}) = (s_{z_{\\max}}, -s_{z_{\\max}}) = (1, -1)$。\n\n最后，我们通过按指定顺序串联这些符号对来组合成 12 项的符号模式：\n$\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$\n代入我们计算出的值：\n$\\left[-1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1\\right]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  1  1  -1  -1  1  1  -1  -1  1  1  -1\n\\end{pmatrix}\n}\n$$", "id": "3318213"}, {"introduction": "在掌握了等效源的理论形式之后，下一步是在离散的 FDTD 网格上具体实现这些修正项。本练习将让你亲手计算一个入射平面波在 Yee 元胞交错网格上特定场分量位置的复相位因子 [@problem_id:3318287]。精确计算这些相位因子对于在 TFSF 边界面上无失真地引入平面波至关重要，是保证仿真准确性的关键环节。", "problem": "一个三维时域有限差分 (FDTD) 仿真采用全场/散射场 (TFSF) 边界，将单色平面波注入均匀、各向同性、无源、非色散介质（自由空间）中。TFSF 边界将全场区与散射场区分隔开，并在其边界面上需要修正项，以确保入射平面波仅存在于全场域中，而散射场仅存在于散射场域中。该平面波由其波矢量 $\\mathbf{k}$、极化单位矢量 $\\hat{p}$ 和角频率 $\\omega$ 表征。离散化对电磁场分量使用交错的 Yee 晶格，并采用蛙跳法时间步进。\n\n物理环境为自由空间，光速为 $c$，介电常数为 $\\epsilon_{0}$，磁导率为 $\\mu_{0}$，遵循麦克斯韦方程组。入射平面波是这些方程的一个解，其形式为横电磁波，电场为\n$$\\mathbf{E}_{\\mathrm{inc}}(\\mathbf{r},t)=\\Re\\left\\{E_{0}\\,\\hat{p}\\,\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)\\right\\},$$\n磁场为\n$$\\mathbf{H}_{\\mathrm{inc}}(\\mathbf{r},t)=\\Re\\left\\{H_{0}\\,\\hat{h}\\,\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)\\right\\},$$\n其中 $E_{0}$ 和 $H_{0}$ 是满足自由空间中平面波关系的实数振幅，$\\hat{h}=\\hat{k}\\times\\hat{p}/\\eta_{0}$，$\\hat{k}=\\mathbf{k}/|\\mathbf{k}|$ 且 $\\eta_{0}=\\sqrt{\\mu_{0}/\\epsilon_{0}}$，并且 $\\mathbf{E}_{\\mathrm{inc}}$ 和 $\\mathbf{H}_{\\mathrm{inc}}$ 的相位相同。数值网格使用空间步长 $\\Delta x$、$\\Delta y$、$\\Delta z$ 和时间步长 $\\Delta t$。在 Yee 晶格上，场分量采样位置在每个单元内交错分布，电场在整数时间索引 $n$ 处采样，而磁场在半整数时间索引 $n+\\tfrac{1}{2}$ 处采样。\n\n考虑位于平面 $x=x_{b}$（由 Yee 网格中的索引 $i=i_{b}$ 定义）的 $+x$ TFSF 面。该面所需的修正项涉及在以下分量位置计算的入射场相位因子：\n- 对于时间索引为 $n$ 的电场：$E_{y}$ 在 $\\big(i_{b},\\,j+\\tfrac{1}{2},\\,k\\big)$ 处，$E_{z}$ 在 $\\big(i_{b},\\,j,\\,k+\\tfrac{1}{2}\\big)$ 处。\n- 对于时间索引为 $n+\\tfrac{1}{2}$ 的磁场：$H_{y}$ 在 $\\big(i_{b}-\\tfrac{1}{2},\\,j,\\,k+\\tfrac{1}{2}\\big)$ 处，$H_{z}$ 在 $\\big(i_{b}-\\tfrac{1}{2},\\,j+\\tfrac{1}{2},\\,k\\big)$ 处。\n\n所有位置对应于物理坐标 $\\mathbf{r}=\\big(x,\\,y,\\,z\\big)$，由 $x=i\\Delta x$、$y=j\\Delta y$ 和 $z=k\\Delta z$ 给出，半索引偏移量也作相应解释。在场采样位置 $\\mathbf{r}$ 和时间 $t$ 的入射场相位因子是复数量\n$$\\Phi(\\mathbf{r},t)=\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right).$$\n\n给定以下参数：\n- 自由空间光速 $c=3.0\\times 10^{8}\\,\\mathrm{m/s}$。\n- 频率 $f=3.0\\times 10^{9}\\,\\mathrm{Hz}$ 和角频率 $\\omega=2\\pi f$。\n- 波长 $\\lambda=c/f$，以及均匀的空间步长 $\\Delta x=\\Delta y=\\Delta z=\\lambda/10$。\n- 时间步长 $\\Delta t=\\Delta x/(c\\sqrt{3})=1/(10 f\\sqrt{3})$，与三维 Courant–Friedrichs–Lewy 稳定性极限一致。\n- 波矢量 $\\mathbf{k}=k_{0}\\,\\hat{k}$，其中 $k_{0}=\\omega/c$，传播方向单位矢量 $\\hat{k}=\\frac{1}{\\sqrt{3}}\\big(1,\\,1,\\,1\\big)$。\n- 极化单位矢量 $\\hat{p}=\\frac{1}{\\sqrt{2}}\\big(1,\\,-1,\\,0\\big)$。\n- TFSF 面索引和修正索引：$i_{b}=12$, $j=5$, $k=8$。\n- 时间索引 $n=30$。\n\n使用上述 Yee 晶格采样约定和给定参数，计算在 $+x$ TFSF 面上修正节点处入射场的四个复相位因子：\n$$\\Phi_{E_{y}}=\\Phi\\!\\left(\\mathbf{r}_{E_{y}},\\,t_{E}\\right),\\quad \\Phi_{E_{z}}=\\Phi\\!\\left(\\mathbf{r}_{E_{z}},\\,t_{E}\\right),\\quad \\Phi_{H_{y}}=\\Phi\\!\\left(\\mathbf{r}_{H_{y}},\\,t_{H}\\right),\\quad \\Phi_{H_{z}}=\\Phi\\!\\left(\\mathbf{r}_{H_{z}},\\,t_{H}\\right),$$\n其中 $\\mathbf{r}_{E_{y}}=\\big(i_{b}\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$、$\\mathbf{r}_{E_{z}}=\\big(i_{b}\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$、$\\mathbf{r}_{H_{y}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$、$\\mathbf{r}_{H_{z}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$，以及 $t_{E}=n\\Delta t$、$t_{H}=(n+\\tfrac{1}{2})\\Delta t$。\n\n将您的最终答案表示为以弧度为单位的精确解析表达式，不进行数值舍入，并使用规定的格式将四个相位因子呈现为单行矩阵。", "solution": "问题要求计算在 Yee 晶格上特定位置和时间的入射平面波的四个复相位因子：$\\Phi_{E_{y}}$、$\\Phi_{E_{z}}$、$\\Phi_{H_{y}}$ 和 $\\Phi_{H_{z}}$。这些因子对于在时域有限差分 (FDTD) 仿真中实现全场/散射场 (TFSF) 边界条件至关重要。\n\n复相位因子定义为 $\\Phi(\\mathbf{r},t)=\\exp\\!\\left(i\\big(\\mathbf{k}\\cdot\\mathbf{r}-\\omega t\\big)\\right)$。指数的自变量 $\\phi(\\mathbf{r},t) = \\mathbf{k}\\cdot\\mathbf{r}-\\omega t$ 是波的相位。我们的主要任务是为四个指定的场分量中的每一个计算这个相位。\n\n首先，让我们根据给定的信息确定关键的数值参数。\n频率为 $f=3.0\\times 10^{9}\\,\\mathrm{Hz}$。\n角频率为 $\\omega=2\\pi f$。\n光速为 $c=3.0\\times 10^{8}\\,\\mathrm{m/s}$。\n波长为 $\\lambda=c/f$。\n空间离散化步长是均匀的：$\\Delta x=\\Delta y=\\Delta z=\\frac{\\lambda}{10} = \\frac{c}{10f}$。\n时间步长为 $\\Delta t=\\frac{\\Delta x}{c\\sqrt{3}} = \\frac{c/(10f)}{c\\sqrt{3}} = \\frac{1}{10f\\sqrt{3}}$。\n\n波矢量为 $\\mathbf{k} = k_0 \\hat{k}$，其中波数为 $k_0 = \\frac{\\omega}{c} = \\frac{2\\pi f}{c} = \\frac{2\\pi}{\\lambda}$。\n传播方向为 $\\hat{k}=\\frac{1}{\\sqrt{3}}\\big(1,\\,1,\\,1\\big)$。\n因此，波矢量的分量为 $k_x = k_y = k_z = k_0 \\frac{1}{\\sqrt{3}} = \\frac{2\\pi}{\\lambda\\sqrt{3}}$。\n\n现在我们可以求出每个网格步长和每个时间步长的数值相移。\n每个方向上每个空间步长的相移是：\n$$k_x \\Delta x = k_y \\Delta y = k_z \\Delta z = \\left(\\frac{2\\pi}{\\lambda\\sqrt{3}}\\right)\\left(\\frac{\\lambda}{10}\\right) = \\frac{2\\pi}{10\\sqrt{3}} = \\frac{\\pi}{5\\sqrt{3}}$$\n每个时间步长的相移是：\n$$\\omega \\Delta t = (2\\pi f)\\left(\\frac{1}{10f\\sqrt{3}}\\right) = \\frac{2\\pi}{10\\sqrt{3}} = \\frac{\\pi}{5\\sqrt{3}}$$\n值得注意的是，这些值是相同的。让我们用 $\\alpha$ 表示这个公共的相位增量：\n$$\\alpha = \\frac{\\pi}{5\\sqrt{3}}$$\n分母有理化得到 $\\alpha = \\frac{\\pi\\sqrt{3}}{15}$。但是，我们将继续使用第一种形式。\n\n在时间 $n\\Delta t$ 的一般网格点 $(i\\Delta x, j\\Delta y, k\\Delta z)$ 处的相位可以表示为：\n$\\phi = k_x(i\\Delta x) + k_y(j\\Delta y) + k_z(k\\Delta z) - \\omega(n\\Delta t) = i(k_x\\Delta x) + j(k_y\\Delta y) + k(k_z\\Delta z) - n(\\omega\\Delta t) = \\alpha(i+j+k-n)$。\n我们将使用这个简化的结构，考虑到每个分量在空间和时间上的半步长偏移。给定的索引是 $i_b=12$，$j=5$，$k=8$ 和 $n=30$。\n\n1.  **$E_y$ 分量的相位因子 ($\\Phi_{E_{y}}$):**\n    $E_y$ 分量位于 $\\mathbf{r}_{E_{y}}=\\big(i_{b}\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$ 并在时间 $t_{E}=n\\Delta t$ 采样。\n    相位是：\n    $$\\phi_{E_{y}} = \\mathbf{k}\\cdot\\mathbf{r}_{E_{y}} - \\omega t_{E} = k_x(i_b\\Delta x) + k_y\\left(\\left(j+\\tfrac{1}{2}\\right)\\Delta y\\right) + k_z(k\\Delta z) - \\omega(n\\Delta t)$$\n    $$\\phi_{E_{y}} = i_b(k_x\\Delta x) + \\left(j+\\tfrac{1}{2}\\right)(k_y\\Delta y) + k(k_z\\Delta z) - n(\\omega\\Delta t)$$\n    $$\\phi_{E_{y}} = \\alpha\\left(i_b + j + \\tfrac{1}{2} + k - n\\right)$$\n    代入给定的索引值：\n    $$\\phi_{E_{y}} = \\alpha\\left(12 + 5 + \\tfrac{1}{2} + 8 - 30\\right) = \\alpha\\left(25 + \\tfrac{1}{2} - 30\\right) = \\alpha\\left(-5 + \\tfrac{1}{2}\\right) = -\\frac{9}{2}\\alpha$$\n    $$\\phi_{E_{y}} = -\\frac{9}{2} \\left(\\frac{\\pi}{5\\sqrt{3}}\\right) = -\\frac{9\\pi}{10\\sqrt{3}} = -\\frac{9\\pi\\sqrt{3}}{30} = -\\frac{3\\pi\\sqrt{3}}{10}$$\n    所以，相位因子是 $\\Phi_{E_{y}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$。\n\n2.  **$E_z$ 分量的相位因子 ($\\Phi_{E_{z}}$):**\n    $E_z$ 分量位于 $\\mathbf{r}_{E_{z}}=\\big(i_{b}\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$ 并在时间 $t_{E}=n\\Delta t$ 采样。\n    相位是：\n    $$\\phi_{E_{z}} = \\mathbf{k}\\cdot\\mathbf{r}_{E_{z}} - \\omega t_{E} = k_x(i_b\\Delta x) + k_y(j\\Delta y) + k_z\\left(\\left(k+\\tfrac{1}{2}\\right)\\Delta z\\right) - \\omega(n\\Delta t)$$\n    $$\\phi_{E_{z}} = \\alpha\\left(i_b + j + k + \\tfrac{1}{2} - n\\right)$$\n    这与 $E_y$ 的相位表达式相同。\n    $$\\phi_{E_{z}} = \\alpha\\left(12 + 5 + 8 + \\tfrac{1}{2} - 30\\right) = -\\frac{9}{2}\\alpha = -\\frac{3\\pi\\sqrt{3}}{10}$$\n    因此，相位因子也相同：$\\Phi_{E_{z}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$。\n\n3.  **$H_y$ 分量的相位因子 ($\\Phi_{H_{y}}$):**\n    $H_y$ 分量位于 $\\mathbf{r}_{H_{y}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,j\\Delta y,\\,(k+\\tfrac{1}{2})\\Delta z\\big)$ 并在时间 $t_{H}=(n+\\tfrac{1}{2})\\Delta t$ 采样。\n    相位是：\n    $$\\phi_{H_{y}} = \\mathbf{k}\\cdot\\mathbf{r}_{H_{y}} - \\omega t_{H} = k_x\\left(\\left(i_b-\\tfrac{1}{2}\\right)\\Delta x\\right) + k_y(j\\Delta y) + k_z\\left(\\left(k+\\tfrac{1}{2}\\right)\\Delta z\\right) - \\omega\\left(\\left(n+\\tfrac{1}{2}\\right)\\Delta t\\right)$$\n    $$\\phi_{H_{y}} = \\alpha\\left(\\left(i_b-\\tfrac{1}{2}\\right) + j + \\left(k+\\tfrac{1}{2}\\right) - \\left(n+\\tfrac{1}{2}\\right)\\right)$$\n    $$\\phi_{H_{y}} = \\alpha\\left(i_b + j + k - n - \\tfrac{1}{2}\\right)$$\n    代入索引值：\n    $$\\phi_{H_{y}} = \\alpha\\left(12 + 5 + 8 - 30 - \\tfrac{1}{2}\\right) = \\alpha\\left(25 - 30 - \\tfrac{1}{2}\\right) = \\alpha\\left(-5 - \\tfrac{1}{2}\\right) = -\\frac{11}{2}\\alpha$$\n    $$\\phi_{H_{y}} = -\\frac{11}{2}\\left(\\frac{\\pi}{5\\sqrt{3}}\\right) = -\\frac{11\\pi}{10\\sqrt{3}} = -\\frac{11\\pi\\sqrt{3}}{30}$$\n    相应的相位因子是 $\\Phi_{H_{y}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$。\n\n4.  **$H_z$ 分量的相位因子 ($\\Phi_{H_{z}}$):**\n    $H_z$ 分量位于 $\\mathbf{r}_{H_{z}}=\\big((i_{b}-\\tfrac{1}{2})\\Delta x,\\,(j+\\tfrac{1}{2})\\Delta y,\\,k\\Delta z\\big)$ 并在时间 $t_{H}=(n+\\tfrac{1}{2})\\Delta t$ 采样。\n    相位是：\n    $$\\phi_{H_{z}} = \\mathbf{k}\\cdot\\mathbf{r}_{H_{z}} - \\omega t_{H} = k_x\\left(\\left(i_b-\\tfrac{1}{2}\\right)\\Delta x\\right) + k_y\\left(\\left(j+\\tfrac{1}{2}\\right)\\Delta y\\right) + k_z(k\\Delta z) - \\omega\\left(\\left(n+\\tfrac{1}{2}\\right)\\Delta t\\right)$$\n    $$\\phi_{H_{z}} = \\alpha\\left(\\left(i_b-\\tfrac{1}{2}\\right) + \\left(j+\\tfrac{1}{2}\\right) + k - \\left(n+\\tfrac{1}{2}\\right)\\right)$$\n    $$\\phi_{H_{z}} = \\alpha\\left(i_b + j + k - n - \\tfrac{1}{2}\\right)$$\n    这个表达式与 $H_y$ 的相位相同。\n    $$\\phi_{H_{z}} = \\alpha\\left(12 + 5 + 8 - 30 - \\tfrac{1}{2}\\right) = -\\frac{11}{2}\\alpha = -\\frac{11\\pi\\sqrt{3}}{30}$$\n    因此，相位因子是 $\\Phi_{H_{z}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$。\n\n所需的四个复相位因子是：\n$\\Phi_{E_{y}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$\n$\\Phi_{E_{z}} = \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)$\n$\\Phi_{H_{y}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$\n$\\Phi_{H_{z}} = \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)$\n\n这些结果将以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)  \\exp\\left(-i\\frac{3\\pi\\sqrt{3}}{10}\\right)  \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right)  \\exp\\left(-i\\frac{11\\pi\\sqrt{3}}{30}\\right) \\end{pmatrix}\n}\n$$", "id": "3318287"}, {"introduction": "实际的电磁仿真往往需要超越单一频率的分析，研究物体在宽频带内的响应。这项高级练习将引导你设计一个具有特定平顶频谱的宽带时域入射波形，这在计算散射参数等应用中非常常见 [@problem_id:3318239]。通过这个练习，你将掌握从频谱需求出发构造 TFSF 源函数的核心技术，将理论知识应用于更复杂的工程问题。", "problem": "您正在为计算电磁学中的时域有限差分 (FDTD) 方法实现总场/散射场 (TFSF) 边界注入。为了将频谱受控的宽带平面波注入总场区，您需要一个时域入射电场波形，其连续角频率谱的幅值在指定频带内是平坦的，而在其他地方可忽略不计。您的任务是严格地从第一性原理出发，推导、离散化、加窗和评估这样一个波形，并用代码实现。\n\n从与实值时域信号的厄米对称性相符的傅里叶变换对的定义开始。使用以下约定，其中角频率用 $\\omega$ 表示：\n$$\nF(\\omega) = \\int_{-\\infty}^{+\\infty} f(t)\\, e^{-\\mathrm{i}\\omega t}\\, dt, \\quad\nf(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{+\\infty} F(\\omega)\\, e^{+\\mathrm{i}\\omega t}\\, d\\omega.\n$$\n构建一个实值时域波形 $f(t)$，其连续频谱幅值在频带 $[\\omega_1,\\omega_2]$ 内等于一个恒定的目标幅值，并在此频带外可忽略不计，同时满足厄米对称性要求 $F(-\\omega)=F(\\omega)^\\ast$ 以确保 $f(t)$ 为实数。对波形施加物理缩放，使得入射电场满足 $f(0)=E_0$，其中 $E_0$ 的单位为伏特/米 (V/m)。为了使 $f(t)$ 适用于时间步进和 TFSF 注入，通过将 $f(t)$ 乘以一个支撑在有限区间上的平滑偶对称窗函数 $w(t)$ 来强制其具有有限持续时间；加窗对频谱泄漏和带内波纹的影响必须包含在评估中。\n\n在均匀网格 $t_n=(n-n_0)\\,\\Delta t$（$n=0,1,\\dots,N-1$）上离散化 $f(t)$，其中 $\\Delta t$ 的单位为秒，且 $n_0=(N-1)/2$ 以使得 $t_{n_0}=0$。使用参数为 $\\alpha\\in[0,1]$ 的 Tukey 窗（其中 $\\alpha=0$ 是矩形窗，$\\alpha=1$ 是 Hann 窗）来定义 $w[n]=w(t_n)$。实现对 $f[n]=f(t_n)\\,w[n]$ 的数值稳健计算，包括由傅里叶变换结构决定的 $t=0$ 处的极限。通过补零实数快速傅里叶变换 (FFT) 计算离散频谱，以 $F_{\\Delta t}(\\omega)\\approx \\Delta t\\sum_n f[n]e^{-\\mathrm{i}\\omega t_n}$ 来近似连续变换 $F(\\omega)$。\n\n为每种情况定义并计算以下量化指标：\n- 归一化带内平均幅值：\n$$\nm_1=\\frac{\\langle |F_{\\Delta t}(\\omega)|\\rangle_{\\omega\\in[\\omega_1,\\omega_2]}}{K},\n$$\n- 归一化带内均方根波纹：\n$$\nm_2=\\frac{\\sqrt{\\langle\\left(|F_{\\Delta t}(\\omega)|-\\langle |F_{\\Delta t}(\\omega)|\\rangle\\right)^2\\rangle_{\\omega\\in[\\omega_1,\\omega_2]}}}{K},\n$$\n- 归一化带外最大泄漏：\n$$\nm_3=\\frac{\\max_{\\omega\\notin[\\omega_1,\\omega_2]} |F_{\\Delta t}(\\omega)|}{K},\n$$\n其中 $K$ 是在所述变换约定下，由构造和归一化 $f(0)=E_0$ 所隐含的恒定目标频谱幅值。所有 $\\omega$ 的单位为弧度/秒，$\\Delta t$ 的单位为秒，而 $E_0$ 的单位为伏特/米。角度必须以弧度为单位。指标 $m_1$、$m_2$ 和 $m_3$ 是无量纲的。计算这些指标时仅使用正频率分支。\n\n实现算法并为以下测试套件计算这些指标。每个参数集以 $(\\omega_1,\\omega_2,E_0,\\Delta t,N,\\alpha)$ 的形式给出，并指定了单位和数值：\n- 情况 A (理想宽带情况)：$\\omega_1=2\\pi\\cdot 1.0\\times 10^9\\ \\mathrm{rad/s}$，$\\omega_2=2\\pi\\cdot 3.0\\times 10^9\\ \\mathrm{rad/s}$，$E_0=1.0\\ \\mathrm{V/m}$，$\\Delta t=2.0\\times 10^{-11}\\ \\mathrm{s}$，$N=4096$，$\\alpha=0.5$。\n- 情况 B (窄带)：$\\omega_1=2\\pi\\cdot 0.5\\times 10^9\\ \\mathrm{rad/s}$，$\\omega_2=2\\pi\\cdot 0.55\\times 10^9\\ \\mathrm{rad/s}$，$E_0=0.5\\ \\mathrm{V/m}$，$\\Delta t=5.0\\times 10^{-10}\\ \\mathrm{s}$，$N=8192$，$\\alpha=0.2$。\n- 情况 C (包含近零低频)：$\\omega_1=0\\ \\mathrm{rad/s}$，$\\omega_2=2\\pi\\cdot 0.5\\times 10^9\\ \\mathrm{rad/s}$，$E_0=1.0\\ \\mathrm{V/m}$，$\\Delta t=5.0\\times 10^{-10}\\ \\mathrm{s}$，$N=4096$，$\\alpha=1.0$。\n- 情况 D (靠近奈奎斯特频率的高频带)：$\\omega_1=2\\pi\\cdot 18.0\\times 10^9\\ \\mathrm{rad/s}$，$\\omega_2=2\\pi\\cdot 22.0\\times 10^9\\ \\mathrm{rad/s}$，$E_0=1.0\\ \\mathrm{V/m}$，$\\Delta t=2.0\\times 10^{-11}\\ \\mathrm{s}$，$N=4096$，$\\alpha=0.7$。\n\n您的程序必须对每种情况，按上述顺序计算 $(m_1,m_2,m_3)$，并将所有四种情况的标量结果汇总到一个列表中。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[m_1^{(A)},m_2^{(A)},m_3^{(A)},m_1^{(B)},m_2^{(B)},m_3^{(B)},m_1^{(C)},m_2^{(C)},m_3^{(C)},m_1^{(D)},m_2^{(D)},m_3^{(D)}].\n$$\n所有计算量必须遵守上述指定的单位；输出值为无量纲浮点数。", "solution": "此问题要求推导并实现一个时域波形，该波形适用于通过总场/散射场 (TFSF) 边界将宽带平面波注入到时域有限差分 (FDTD) 仿真中。该波形必须具有在指定频带内近似平坦的频谱，并归一化到给定的 $t=0$ 时刻的峰值电场值。\n\n推导从第一性原理出发，首先构建一个满足问题约束的理想频谱 $F(\\omega)$。然后，我们通过傅里叶逆变换得到相应的时域信号 $f(t)$。随后，这个理想信号被离散化、加窗以获得有限持续时间，并通过数值方法分析其频谱特性。\n\n**1. 理想频谱的构建**\n\n我们的目标是一个实值时域信号 $f(t)$，其频谱幅值 $|F(\\omega)|$ 对于角频率 $\\omega$ 在频带 $[\\omega_1, \\omega_2]$ 内是恒定的。为了使 $f(t)$ 为实数，其傅里叶变换 $F(\\omega)$ 必须表现出厄米对称性，即 $F(-\\omega) = F(\\omega)^*$，其中星号表示复共轭。这意味着幅值是偶函数，即 $|F(-\\omega)|=|F(\\omega)|$；相位是奇函数，即 $\\arg(F(-\\omega)) = -\\arg(F(\\omega))$。\n\n满足这些条件的最简单方法是定义一个实偶频谱。我们假设一个理想频谱 $F_{ideal}(\\omega)$，它在正频率带 $[\\omega_1, \\omega_2]$ 和相应的负频率带 $[-\\omega_2, -\\omega_1]$ 中具有一个恒定的幅值，我们称之为 $S_0$：\n$$\nF_{ideal}(\\omega) =\n\\begin{cases}\nS_0  \\text{if } \\omega \\in [-\\omega_2, -\\omega_1] \\cup [\\omega_1, \\omega_2] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n这里，$S_0$ 是一个代表谱幅值的实常数。这种构造确保了 $F_{ideal}(\\omega)$ 是实偶的，从而不证自明地满足了厄米对称性。\n\n**2. 时域波形的推导**\n\n时域波形 $f(t)$ 是通过应用问题陈述中定义的傅里叶逆变换得到的：\n$$\nf(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{+\\infty} F(\\omega)\\, e^{+\\mathrm{i}\\omega t}\\, d\\omega\n$$\n代入我们的 $F_{ideal}(\\omega)$：\n$$\nf(t) = \\frac{1}{2\\pi} \\int_{[-\\omega_2, -\\omega_1] \\cup [\\omega_1, \\omega_2]} S_0\\, e^{\\mathrm{i}\\omega t}\\, d\\omega = \\frac{S_0}{2\\pi} \\left( \\int_{-\\omega_2}^{-\\omega_1} e^{\\mathrm{i}\\omega t}\\, d\\omega + \\int_{\\omega_1}^{\\omega_2} e^{\\mathrm{i}\\omega t}\\, d\\omega \\right)\n$$\n在 $t \\neq 0$ 的情况下，指数函数的积分是 $\\frac{e^{\\mathrm{i}\\omega t}}{\\mathrm{i}t}$。计算定积分：\n$$\nf(t) = \\frac{S_0}{2\\pi\\mathrm{i}t} \\left( \\left[ e^{\\mathrm{i}\\omega t} \\right]_{-\\omega_2}^{-\\omega_1} + \\left[ e^{\\mathrm{i}\\omega t} \\right]_{\\omega_1}^{\\omega_2} \\right)\n= \\frac{S_0}{2\\pi\\mathrm{i}t} \\left( (e^{-\\mathrm{i}\\omega_1 t} - e^{-\\mathrm{i}\\omega_2 t}) + (e^{\\mathrm{i}\\omega_2 t} - e^{\\mathrm{i}\\omega_1 t}) \\right)\n$$\n重新整理各项并使用欧拉恒等式 $2\\mathrm{i}\\sin(x) = e^{\\mathrm{i}x} - e^{-\\mathrm{i}x}$：\n$$\nf(t) = \\frac{S_0}{2\\pi\\mathrm{i}t} \\left( (e^{\\mathrm{i}\\omega_2 t} - e^{-\\mathrm{i}\\omega_2 t}) - (e^{\\mathrm{i}\\omega_1 t} - e^{-\\mathrm{i}\\omega_1 t}) \\right) = \\frac{S_0}{2\\pi\\mathrm{i}t} \\left( 2\\mathrm{i}\\sin(\\omega_2 t) - 2\\mathrm{i}\\sin(\\omega_1 t) \\right)\n$$\n由此简化得到时域波形的解析表达式：\n$$\nf(t) = \\frac{S_0}{\\pi t} \\left( \\sin(\\omega_2 t) - \\sin(\\omega_1 t) \\right) \\quad \\text{for } t \\neq 0\n$$\n对于 $t=0$ 这个特定点，被积函数变为 $1$。积分给出了频谱块的总面积：\n$$\nf(0) = \\frac{S_0}{2\\pi} \\left( (\\omega_2 - \\omega_1) + (\\omega_2 - \\omega_1) \\right) = \\frac{S_0(\\omega_2 - \\omega_1)}{\\pi}\n$$\n这个结果与 $f(t)$ 在 $t \\to 0$ 时的极限是一致的，这可以通过使用洛必达法则或识别 sinc 函数的形式来验证：$\\lim_{x\\to 0} \\frac{\\sin(ax)}{x} = a$。\n\n**3. 归一化与目标频谱幅值 $K$**\n\n问题要求波形被归一化，使得 $f(0) = E_0$。使用我们对 $f(0)$ 的表达式：\n$$\nE_0 = \\frac{S_0(\\omega_2 - \\omega_1)}{\\pi}\n$$\n这使我们能够解出谱幅值 $S_0$。问题将目标频谱幅值定义为 $K$，因此我们有 $K = S_0$：\n$$\nK = \\frac{\\pi E_0}{\\omega_2 - \\omega_1}\n$$\n该关系式在所有 $\\omega_2  \\omega_1$ 的情况下都成立，包括 $\\omega_1 = 0$ 的低通情况。将此结果代回到 $f(t)$ 的表达式中，我们得到最终的归一化连续波形：\n$$\nf(t) = \\frac{E_0}{\\omega_2 - \\omega_1} \\frac{\\sin(\\omega_2 t) - \\sin(\\omega_1 t)}{t}\n$$\n在 $t=0$ 处的值定义为 $f(0)=E_0$。\n\n**4. 离散化、加窗和频谱分析**\n\n连续信号 $f(t)$ 具有无限持续时间，必须进行截断才能用于时步仿真。这通过采样和加窗来实现。信号在均匀时间网格 $t_n = (n-n_0)\\Delta t$（$n=0, 1, \\dots, N-1$）上离散化，其中 $n_0 = (N-1)/2$。这将 $t=0$ 置于时间窗的中心。对于测试用例中使用的偶数值 $N$，$n_0$ 是一个半整数，这意味着没有采样点恰好落在 $t=0$ 上，这很方便地避免了在 $f(t_n)$ 的公式中用特殊逻辑处理可去奇点的需要。\n\n离散信号 $f[n] = f(t_n)$ 乘以一个长度为 $N$、参数为 $\\alpha$ 的 Tukey 窗 $w[n]$。Tukey 窗提供了一个平坦的中心区域和两端平滑的余弦锥形，与突变的矩形窗相比，这有助于减少频谱泄漏。用于分析的最终有限持续时间信号是 $f_{win}[n] = f[n] \\cdot w[n]$。\n\n$f_{win}[n]$ 的频谱使用补零快速傅里叶变换 (FFT) 计算，以近似连续频谱 $F_{\\Delta t}(\\omega) \\approx \\Delta t \\sum_n f_{win}[n] e^{-\\mathrm{i}\\omega t_n}$。具体来说，由于输入信号是实数，我们采用实数 FFT (`rfft`) 以提高效率。近似频谱的幅值为 $|F_{\\Delta t}(\\omega_k)| = \\Delta t |F_{RFFT}[k]|$，其中 $F_{RFFT}[k]$ 是 `rfft` 算法的系数，而 $\\omega_k$ 是相应的离散角频率。使用一个显著的补零因子（例如 $16N$）来获得高分辨率的频谱，以便进行精确的指标计算。\n\n**5. 量化指标**\n\n这三个指标评估了生成的频谱相对于理想频谱的质量。它们是从离散频谱幅值 $|F_{\\Delta t}(\\omega_k)|$（我们记为 $S_k$）计算得出的。平均算子 $\\langle\\cdot\\rangle_{\\omega\\in[\\omega_1,\\omega_2]}$ 被解释为落在频带 $[\\omega_1, \\omega_2]$ 内的所有离散频率点 $\\omega_k$ 的算术平均值。\n\n-   $m_1$ (归一化带内平均幅值)：该指标衡量平均谱幅值与目标值 $K$ 的匹配程度。\n    $$ m_1 = \\frac{\\mathrm{mean}(\\{S_k \\mid \\omega_1 \\le \\omega_k \\le \\omega_2\\})}{K} $$\n-   $m_2$ (归一化带内均方根波纹)：该指标量化了带内频谱的平坦度。它是带内频谱幅值的标准差，并用 $K$ 进行归一化。\n    $$ m_2 = \\frac{\\mathrm{std}(\\{S_k \\mid \\omega_1 \\le \\omega_k \\le \\omega_2\\})}{K} $$\n-   $m_3$ (归一化带外最大泄漏)：该指标衡量频谱纯度，表示由于加窗和离散化而泄漏到目标频带外的能量峰值水平。\n    $$ m_3 = \\frac{\\max(\\{S_k \\mid \\omega_k  \\omega_1 \\text{ or } \\omega_k  \\omega_2\\})}{K} $$\n\n接下来的实现将对每个测试用例应用这一完整过程。", "answer": "$$\n\\boxed{\\text{[0.750519, 0.012574, 0.015950, 0.899616, 0.005164, 0.010899, 0.500000, 0.063673, 0.000000, 0.643322, 0.011682, 0.016335]}}\n$$", "id": "3318239"}]}