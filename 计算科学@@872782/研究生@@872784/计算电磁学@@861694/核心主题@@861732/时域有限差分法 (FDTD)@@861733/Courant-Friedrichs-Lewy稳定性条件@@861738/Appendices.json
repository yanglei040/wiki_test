{"hands_on_practices": [{"introduction": "要真正理解一个稳定性条件，第一步就是亲手推导它。本练习将引导你使用冯·诺依曼分析法这一基石性技术，来求解一阶迎风格式这一求解双曲型方程的基本构件的精确稳定性极限。通过这个过程，你不仅能得出著名的CFL数限制，还能深化对数值耗散与稳定性的内在联系的理解。", "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，方程定义在间距为 $\\Delta x > 0$ 的均匀空间网格上，并采用步长为 $\\Delta t > 0$ 的显式时间步进法。使用与 $a$ 的符号相一致的一阶迎风有限差分近似来离散化 $u_{x}$（如果 $a>0$ 则为后向差分，如果 $a0$ 则为前向差分），并使用时间上的前向欧拉法来离散化 $u_{t}$。假设空间是周期性的，因此离散傅里叶模式是可接受的。定义 Courant-Friedrichs-Lewy (CFL) 数 $C := a\\,\\Delta t/\\Delta x$。通过考虑离散傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$（其中 $\\theta \\in \\mathbb{R}$ 是无量纲波数），对该格式进行 von Neumann (傅里叶) 稳定性分析，并推导关于 $C$ 的精确充要稳定性约束，以确保对所有波数，放大因子的模长至多为一。最后，将您的结果表示为最大允许时间步长 $\\Delta t_{\\max}$，用 $a$ 和 $\\Delta x$ 表示。请以单一的闭式解析表达式提供您的最终答案。无需数值取整。", "solution": "线性平流方程由下式给出\n$$\nu_t + a u_x = 0\n$$\n其中 $u(x,t)$ 是被输运的量，$a$ 是恒定的平流速度，$t$ 是时间，$x$ 是空间坐标。我们在均匀网格上离散化该方程，其中 $x_j = j\\Delta x$ 和 $t_n = n\\Delta t$。令 $u_j^n$ 表示 $u(x_j, t_n)$ 的数值近似。\n\n时间导数 $u_t$ 使用前向欧拉法近似：\n$$\nu_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n空间导数 $u_x$ 使用一阶迎风格式近似，这取决于平流速度 $a$ 的符号。\n\n**情况 1：$a > 0$**\n对于正的平流速度，信息沿 $x$ 轴正方向传播。迎风格式对空间导数使用后向差分：\n$$\nu_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n$$\n将这些近似代入 PDE，得到有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n对 $u_j^{n+1}$ 进行整理，并引入 Courant-Friedrichs-Lewy (CFL) 数 $C = \\frac{a \\Delta t}{\\Delta x}$，我们得到：\n$$\nu_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n)\n$$\n由于 $a > 0$，$\\Delta t > 0$ 且 $\\Delta x > 0$，我们有 $C > 0$。\n\n为了进行 von Neumann 稳定性分析，我们将离散傅里叶模式 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ 代入格式中，其中 $\\theta$ 是无量纲波数。振幅 $\\hat{u}^n$ 根据 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ 演化，其中 $G(\\theta)$ 是放大因子。\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta j) - \\hat{u}^n \\exp(i\\theta (j-1)))\n$$\n两边同除以 $\\hat{u}^n \\exp(i\\theta j)$（假设 $\\hat{u}^n \\neq 0$）：\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (1 - \\exp(-i\\theta))\n$$\n为使格式稳定，放大因子的模长必须对所有波数 $\\theta \\in \\mathbb{R}$ 满足 $|G(\\theta)| \\le 1$。我们分析其模长的平方：\n$$\n|G(\\theta)|^2 = |(1 - C) + C \\exp(-i\\theta)|^2 = |(1 - C + C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2(\\cos^2\\theta + \\sin^2\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 意味着：\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1\n$$\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\n由于对所有 $\\theta$，$(1-\\cos\\theta) \\ge 0$，该不等式简化为：\n$$\nC(1-C) \\ge 0\n$$\n鉴于我们处于 $a > 0$ 的情况，我们有 $C > 0$。因此，为了使乘积非负，必须有 $1-C \\ge 0$，即 $C \\le 1$。此情况下的综合稳定性条件是 $0  C \\le 1$。\n\n**情况 2：$a  0$**\n对于负的平流速度，信息沿 $x$ 轴负方向传播。迎风格式对空间导数使用前向差分：\n$$\nu_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n$$\n有限差分方程为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\n$$\nu_j^{n+1} = u_j^n - C (u_{j+1}^n - u_j^n)\n$$\n由于 $a  0$，我们有 $C  0$。代入傅里叶模式 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ 得到：\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta (j+1)) - \\hat{u}^n \\exp(i\\theta j))\n$$\n两边同除以 $\\hat{u}^n \\exp(i\\theta j)$：\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (\\exp(i\\theta) - 1)\n$$\n模长的平方是：\n$$\n|G(\\theta)|^2 = |(1+C) - C \\exp(i\\theta)|^2 = |(1+C-C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 意味着：\n$$\n1 + 2C(1+C)(1-\\cos\\theta) \\le 1\n$$\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\n和之前一样，由于 $(1-\\cos\\theta) \\ge 0$，该不等式简化为：\n$$\nC(1+C) \\le 0\n$$\n鉴于我们处于 $a  0$ 的情况，我们有 $C  0$。因此，为了使乘积非正，必须有 $1+C \\ge 0$，即 $C \\ge -1$。此情况下的综合稳定性条件是 $-1 \\le C  0$。\n\n**综合稳定性约束**\n当 $a>0$ 时，稳定性条件是 $0  C \\le 1$；当 $a0$ 时，稳定性条件是 $-1 \\le C  0$。这两个条件可以统一起来。\n对于 $a > 0$，$C = \\frac{a\\Delta t}{\\Delta x} > 0$。条件 $C \\le 1$ 变为 $\\frac{a\\Delta t}{\\Delta x} \\le 1$。\n对于 $a  0$，$C = \\frac{a\\Delta t}{\\Delta x}  0$。条件 $C \\ge -1$ 变为 $\\frac{a\\Delta t}{\\Delta x} \\ge -1$，这等价于 $-\\frac{a\\Delta t}{\\Delta x} \\le 1$。\n注意到当 $a>0$ 时， $|a| = a$；当 $a0$ 时， $|a| = -a$。这两个条件可以用一个单一、紧凑的形式表示：\n$$\n\\frac{|a|\\Delta t}{\\Delta x} \\le 1\n$$\n这就是一阶迎风格式的精确充要稳定性约束。\n\n**最大允许时间步长**\n为了求得最大允许时间步长 $\\Delta t_{\\max}$，我们对 $\\Delta t$ 求解稳定性不等式。假设 $a \\neq 0$：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\n因此，保证对所有波数都稳定的 $\\Delta t$ 的最大值为：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\n这个结果就是该特定数值格式著名的 Courant-Friedrichs-Lewy (CFL) 条件。它表明，时间步长必须足够小，以使数值格式的依赖域包含偏微分方程的依赖域。在一个时间步长内，流体质点行进的距离为 $|a|\\Delta t$，这个距离必须小于或等于一个网格间距 $\\Delta x$。", "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$", "id": "3375615"}, {"introduction": "这个练习将我们的视角从单纯的双曲型方程扩展开来。它探讨了为什么抛物线型热传导方程的稳定性极限，尽管与空间步长 $\\Delta x$ 的标度关系不同，但仍被视为一种“类CFL”条件。此练习旨在通过强大的线方法 (method of lines) 框架和离散算子的谱特性，统一理解这些看似不同的稳定性约束。", "problem": "考虑线性常系数标量平流方程 $u_t + a\\,u_x = 0$ 和热方程 $u_t = \\nu\\,u_{xx}$，它们定义在一个空间步长为 $\\Delta x$ 的一维均匀空间网格上，并采用步长为 $\\Delta t$ 的显式时间步进。对于平流问题，使用与 $a$ 的符号一致的迎风空间离散格式和前向欧拉时间积分；对于扩散问题，使用向前时间中心空间（Forward-Time Centered-Space, FTCS）格式，即时间上采用前向欧拉法，空间上采用标准的二阶差分近似。通过考虑单个傅里叶模态 $u_j^n = \\hat{u}^n\\,e^{\\mathrm{i} j \\theta}$，对每种格式进行傅里叶（von Neumann）稳定性分析，并推导出保证线性稳定性的关于 $\\Delta t$ 的条件（用 $\\Delta x$、 $|a|$ 和 $\\nu$ 表示）。然后，解释并比较所得的时间步长限制。特别是，阐明为什么平流的限制（通常用 Courant-Friedrichs-Lewy (CFL) 数 $|a|\\,\\Delta t/\\Delta x$ 表示）和扩散的限制（通常用 $\\nu\\,\\Delta t/(\\Delta x)^2$ 表示）都被称为类 CFL 条件，尽管它们随 $\\Delta x$ 的缩放方式不同。\n\n选择所有正确的陈述：\n\nA. 对于显式迎风格式，平流稳定性限制可以写成 $|a|\\,\\Delta t/\\Delta x \\leq 1$，对于 FTCS 格式，扩散稳定性限制可以写成 $\\nu\\,\\Delta t/(\\Delta x)^2 \\leq 1/2$；后者是类 CFL 的，因为它通过离散算子的依赖于网格的谱半径的倒数来限制 $\\Delta t$，该谱半径的量级为 $O(1/(\\Delta x)^2)$。\n\nB. 扩散限制不是类 CFL 的，因为扩散具有无限的物理传播速度；因此，显式时间步进对 $\\Delta t$ 没有施加上限。\n\nC. 平流和扩散的限制都仅仅是相容性要求，而不是稳定性要求；只要网格足够精细，违反这些限制也不会导致不稳定。\n\nD. 这两种限制都可以看作是将前向欧拉法应用于半离散系统 $u'(t) = L\\,u(t)$ 的结果：离散平流算子的谱的量级为 $O(|a|/\\Delta x)$，而离散拉普拉斯算子的谱的量级为 $O(\\nu/(\\Delta x)^2)$；通过这些量级的倒数来限制 $\\Delta t$，便得到了具有不同 $\\Delta x$ 依赖性的类 CFL 条件。\n\nE. 对于平流问题，将空间上的迎风差分切换为中心差分会使放大因子对所有 $\\Delta t$ 都变为酉（模为1），因此显式中心格式变为无条件稳定。\n\n选择所有适用的选项。", "solution": "**稳定性条件的推导**\n\n**1. 平流方程：$u_t + a\\,u_x = 0$ 与显式迎风格式**\n\n离散格式必须与平流速度 $a$ 的符号一致。\n\n情况 1：$a > 0$。迎风方向来自左侧，因此我们对空间导数 $u_x$ 使用后向差分：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n整理以求解下一个时间步 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)\n$$\n令 Courant 数为 $C = \\frac{a \\Delta t}{\\Delta x}$。由于 $a>0$，我们有 $C>0$。\n$$\nu_j^{n+1} = (1-C) u_j^n + C u_{j-1}^n\n$$\n我们代入傅里叶模态 $u_j^n = G^n \\hat{u}_0 e^{\\mathrm{i} j \\theta}$，其中 $G$ 是放大因子。\n$$\nG^{n+1} e^{\\mathrm{i} j \\theta} = (1-C) G^n e^{\\mathrm{i} j \\theta} + C G^n e^{\\mathrm{i} (j-1) \\theta}\n$$\n两边同除以 $G^n e^{\\mathrm{i} j \\theta}$：\n$$\nG = (1-C) + C e^{-\\mathrm{i} \\theta} = 1 - C + C(\\cos\\theta - \\mathrm{i}\\sin\\theta)\n$$\n为保证稳定性，我们要求对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G| \\leq 1$。\n$$\n|G|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta\n$$\n$$\n|G|^2 = 1 + 2C(C-1) - 2C(C-1)(-\\cos\\theta) = 1 + 2C(C-1)(1-\\cos\\theta)\n$$\n由于 $C > 0$ 且 $(1-\\cos\\theta) \\ge 0$，为使 $|G|^2 \\le 1$，必须有 $C-1 \\le 0$，即 $C \\le 1$。因此，稳定性条件是 $0 \\le \\frac{a \\Delta t}{\\Delta x} \\le 1$。\n\n情况 2：$a  0$。迎风方向来自右侧，因此我们对 $u_x$ 使用前向差分：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\n此时 Courant 数 $C = \\frac{a \\Delta t}{\\Delta x}$ 为负。\n$$\nu_j^{n+1} = (1+C)u_j^n - C u_{j+1}^n\n$$\n代入傅里叶模态得到放大因子：\n$$\nG = (1+C) - C e^{\\mathrm{i} \\theta}\n$$\n类似的计算得出 $|G|^2 = 1 + 2C(C+1)(1-\\cos\\theta)$。\n由于 $C  0$ 且 $(1-\\cos\\theta) \\ge 0$，为使 $|G|^2 \\le 1$，必须有 $C+1 \\ge 0$，即 $C \\ge -1$。稳定性条件是 $-1 \\le \\frac{a \\Delta t}{\\Delta x} \\le 0$。\n\n综合两种情况，显式迎风格式的稳定性条件是：\n$$\n\\left| \\frac{a \\Delta t}{\\Delta x} \\right| \\le 1 \\quad \\text{或} \\quad \\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\n\n**2. 热方程：$u_t = \\nu u_{xx}$ 与 FTCS 格式**\n\nFTCS 格式在时间上使用前向欧拉法，在空间上使用中心二阶差分：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n令扩散数为 $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2}$。对于物理扩散过程，$\\nu > 0$，因此 $d > 0$。\n$$\nu_j^{n+1} = u_j^n + d(u_{j+1}^n - 2u_j^n + u_{j-1}^n) = (1-2d)u_j^n + d(u_{j+1}^n + u_{j-1}^n)\n$$\n代入傅里叶模态 $u_j^n = G^n \\hat{u}_0 e^{\\mathrm{i} j \\theta}$：\n$$\nG e^{\\mathrm{i} j \\theta} = (1-2d)e^{\\mathrm{i} j \\theta} + d(e^{\\mathrm{i} (j+1) \\theta} + e^{\\mathrm{i} (j-1) \\theta})\n$$\n两边同除以 $e^{\\mathrm{i} j \\theta}$：\n$$\nG = (1-2d) + d(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}) = 1 - 2d + d(2\\cos\\theta) = 1 + 2d(\\cos\\theta - 1)\n$$\n使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$\nG = 1 - 4d\\sin^2(\\theta/2)\n$$\n由于 $G$ 是实数，稳定性条件 $|G| \\le 1$ 等价于 $-1 \\le G \\le 1$。\n上界 $G \\le 1$ 总是满足的，因为 $d>0$ 且 $\\sin^2(\\theta/2) \\ge 0$。\n下界要求 $G \\ge -1$：\n$$\n1 - 4d\\sin^2(\\theta/2) \\ge -1 \\implies 2 \\ge 4d\\sin^2(\\theta/2) \\implies d \\le \\frac{1}{2\\sin^2(\\theta/2)}\n$$\n这个条件必须对所有 $\\theta$ 成立。最严格的情况出现在 $\\sin^2(\\theta/2)$ 取最大值时，即 $\\sin^2(\\theta/2) = 1$（对应最高频率模态 $\\theta=\\pi$）。这导出了稳定性条件：\n$$\nd \\le \\frac{1}{2} \\quad \\text{或} \\quad \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n\n**“类 CFL”条件的解释**\n\n“CFL 条件”这一术语最初源于针对双曲型方程的依赖域论证，该论证给出了 $|a|\\Delta t/\\Delta x \\le 1$ 的判据。然而，在现代数值分析中，该术语通常被更广泛地用于描述任何对于显式时间积分格式，依赖于空间步长 $\\Delta x$ 的时间步长 $\\Delta t$ 的稳定性限制。\n\n这种更广泛的观点最好通过线方法（method of lines）来理解。首先在空间上进行离散化，得到一个常微分方程（ODE）组 $\\frac{d\\vec{u}}{dt} = L_h \\vec{u}$，其中 $L_h$ 是表示离散空间算子的矩阵。应用前向欧拉法得到 $\\vec{u}^{n+1} = (I + \\Delta t L_h)\\vec{u}^n$。稳定性要求放大矩阵的特征值 $1 + \\Delta t \\lambda_k$（其中 $\\lambda_k$ 是 $L_h$ 的特征值）的模不大于 1。这意味着 $\\Delta t \\lambda_k$ 必须位于前向欧拉法稳定域内，该稳定域是在复平面上以 $(-1, 0)$ 为中心、半径为 1 的圆盘。这施加了一个形式为 $\\Delta t \\le C / \\rho(L_h)$ 的限制，其中 $\\rho(L_h) = \\max_k |\\lambda_k|$ 是 $L_h$ 的谱半径。\n\n- 对于迎风平流算子，特征值 $\\lambda(\\theta)$ 的最大模（谱半径）的量级为 $\\rho(L_h) \\sim O(|a|/\\Delta x)$。这导致了稳定性限制 $\\Delta t \\le \\text{const} \\cdot \\Delta x / |a|$，即经典的 CFL 条件。\n- 对于 FTCS 扩散算子，特征值 $\\lambda(\\theta)$ 是实数且为负，其谱半径的量级为 $\\rho(L_h) \\sim O(\\nu/(\\Delta x)^2)$。这导致了稳定性限制 $\\Delta t \\le \\text{const} \\cdot (\\Delta x)^2 / \\nu$。\n\n因此，这两种条件都是“类 CFL”的，因为它们都基于半离散算子的谱半径（最高“频率”）来约束 $\\Delta t$。它们随 $\\Delta x$ 缩放方式的差异，是所近似的空间导数阶数不同的直接结果。\n\n**选项评估**\n\nA. **对于显式迎风格式，平流稳定性限制可以写成 $|a|\\,\\Delta t/\\Delta x \\leq 1$，对于 FTCS 格式，扩散稳定性限制可以写成 $\\nu\\,\\Delta t/(\\Delta x)^2 \\leq 1/2$；后者是类 CFL 的，因为它通过离散算子的依赖于网格的谱半径的倒数来限制 $\\Delta t$，该谱半径的量级为 $O(1/(\\Delta x)^2)$。**\n我们的推导证实了这两个稳定性限制：$|a|\\Delta t/\\Delta x \\le 1$ 和 $\\nu\\Delta t/(\\Delta x)^2 \\le 1/2$。将扩散条件解释为“类 CFL”的理由是它依赖于离散拉普拉斯算子谱半径（量级为 $O(\\nu/(\\Delta x)^2)$）的倒数，这个解释是准确的，并且与现代对显式格式稳定性的理解一致。\n**结论：正确。**\n\nB. **扩散限制不是类 CFL 的，因为扩散具有无限的物理传播速度；因此，显式时间步进对 $\\Delta t$ 没有施加上限。**\n源于依赖域的原始 CFL 论证严格来说不适用于抛物型方程，这个前提是正确的。然而，“显式时间步进对 $\\Delta t$ 没有施加上限”这个结论是错误的。我们的推导清楚地表明 FTCS 格式是条件稳定的，其限制为 $\\Delta t \\le (\\Delta x)^2 / (2\\nu)$。\n**结论：错误。**\n\nC. **平流和扩散的限制都仅仅是相容性要求，而不是稳定性要求；只要网格足够精细，违反这些限制也不会导致不稳定。**\n这个陈述错误地将相容性与稳定性混为一谈。推导出的条件明确是针对稳定性的。违反这些条件会导致数值不稳定，误差会指数级增长。声称只要网格足够精细就可以违反这些限制，这与事实恰恰相反；更精细的网格（更小的 $\\Delta x$）需要更小的 $\\Delta t$ 来维持稳定性。\n**结论：错误。**\n\nD. **这两种限制都可以看作是将前向欧拉法应用于半离散系统 $u'(t) = L\\,u(t)$ 的结果：离散平流算子的谱的量级为 $O(|a|/\\Delta x)$，而离散拉普拉斯算子的谱的量级为 $O(\\nu/(\\Delta x)^2)$；通过这些量级的倒数来限制 $\\Delta t$，便得到了具有不同 $\\Delta x$ 依赖性的类 CFL 条件。**\n这个陈述通过线方法为这两个稳定性条件提供了一个优雅而准确的统一解释。它正确地指出了半离散算子（迎风平流算子谱量级为 $O(|a|/\\Delta x)$，中心扩散算子谱量级为 $O(\\nu/(\\Delta x)^2)$）的谱半径缩放规律。它正确地得出结论，时间积分器（前向欧拉法）的稳定性要求将 $\\Delta t$ 与这些谱半径的倒数耦合起来，从而解释了对 $\\Delta x$ 的不同依赖性。\n**结论：正确。**\n\nE. **对于平流问题，将空间上的迎风差分切换为中心差分会使放大因子对所有 $\\Delta t$ 都变为酉（模为1），因此显式中心格式变为无条件稳定。**\n我们来分析用于平流的 FTCS 格式：$\\frac{u_j^{n+1}-u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$。其放大因子为 $G = 1 - \\mathrm{i} \\frac{a \\Delta t}{\\Delta x} \\sin\\theta$。其模的平方为 $|G|^2 = 1 + (\\frac{a \\Delta t}{\\Delta x} \\sin\\theta)^2$。对于任何 $\\Delta t > 0$ 和任何满足 $\\sin\\theta \\ne 0$ 的模态，我们都有 $|G| > 1$。因此，该格式是无条件不稳定的，而不是无条件稳定的。放大因子不是酉的（$|G| \\ne 1$）。\n**结论：错误。**", "answer": "$$\\boxed{AD}$$", "id": "3375540"}, {"introduction": "最后的这项实践练习旨在搭建从数学推导到实际仿真的桥梁。真实世界的问题往往涉及复杂、非均匀的网格，本练习要求你编写一个程序，为这种情况正确地计算一个安全的全局时间步长。这将巩固一个核心概念：全局稳定性由最严格的局部条件所决定。", "problem": "要求您设计一个程序，该程序基于 Courant-Friedrichs-Lewy (CFL) 稳定性条件，为非均匀网格上麦克斯韦方程组的显式时域有限差分 (FDTD) 离散化计算一个保守的全局时间步长。请从麦克斯韦方程组的微分形式和 Yee 格式的离散蛙跳更新结构开始。以此为基础，推导稳定性要求，该要求根据局部波速和离散空间导数来约束时间步长。然后，实现一个程序，该程序为每个提供的测试用例，逐个扫描网格元素，从最严格的条件形成时间步长的局部界限，并返回一个对整个网格有效的单一保守全局时间步长。\n\n请从基本电磁定律和定义开始，然后推导出数值稳定性要求。基础部分必须包括：\n- 麦克斯韦方程组的微分形式以及将电场与介电常数、磁场与磁导率联系起来的本构关系，以及局部波速关系 $v = 1/\\sqrt{\\mu \\epsilon}$。\n- Yee FDTD 格式在 $d$ 维空间中具有交错电场和磁场的显式时间步进结构。\n\n您的推导必须解释为什么显式更新会对时间步长产生约束，以及空间中的非均匀性（通过变化的局部波速和变化的网格间距）如何导致一个决定单一全局时间步长的最严格界限。不要提出简化推导路径的捷径公式或提示；相反，请从所述的基本概念开始，并逻辑地推导稳定性约束。\n\n完成推导后，请实现一个程序，为下面指定的每个测试用est，通过扫描所有网格元素并使用最严格的局部 CFL 界限来设置全局时间步长，从而计算保守的全局时间步长。该程序应能处理 $d=1$、$d=2$ 和 $d=3$ 维的情况。对于每个网格元素，请考虑局部波速 $v$ 和每个活动维度中的局部空间增量。每个测试用例的输出必须是单个浮点数，表示以秒为单位的时间步长，四舍五入到 $12$ 位小数，最终打印的输出必须是单行，其中包含所有测试用例结果的逗号分隔列表，并用方括号括起来。\n\n物理单位是强制性的：空间增量必须以米为单位，波速必须以米/秒为单位，时间步长必须以秒为单位报告。不涉及角度。结果应为浮点数。\n\n测试套件：\n- 测试用例 $1$ (三维，非均匀网格，中等变异性):\n  - 维度: $d=3$。\n  - 网格形状: $2\\times 2\\times 2$。\n  - 局部波速数组 $v$ (单位：米/秒): 一个 $2\\times 2\\times 2$ 数组\n    $$\n    v = \\begin{bmatrix}\n    \\begin{bmatrix} 2.0\\times 10^{8}  2.5\\times 10^{8} \\\\ 3.0\\times 10^{8}  1.8\\times 10^{8} \\end{bmatrix} \n    \\begin{bmatrix} 1.5\\times 10^{8}  3.0\\times 10^{8} \\\\ 2.2\\times 10^{8}  2.8\\times 10^{8} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 局部空间增量 (单位：米): $2\\times 2\\times 2$ 数组\n    $$\n    \\Delta x = \\begin{bmatrix}\n    \\begin{bmatrix} 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix} \n    \\begin{bmatrix} 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix},\n    $$\n    $$\n    \\Delta y = \\begin{bmatrix}\n    \\begin{bmatrix} 1.2\\times 10^{-3}  1.2\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  0.9\\times 10^{-3} \\end{bmatrix} \n    \\begin{bmatrix} 1.1\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix},\n    $$\n    $$\n    \\Delta z = \\begin{bmatrix}\n    \\begin{bmatrix} 0.9\\times 10^{-3}  1.1\\times 10^{-3} \\\\ 1.3\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix} \n    \\begin{bmatrix} 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  0.8\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 安全因子 (无量纲): $\\sigma = 0.95$。\n\n- 测试用例 $2$ (三维，一个方向上存在显著各向异性):\n  - 维度: $d=3$。\n  - 网格形状: $2\\times 2\\times 1$。\n  - 局部波速数组 $v$ (单位：米/秒):\n    $$\n    v = \\begin{bmatrix}\n    \\begin{bmatrix} 3.0\\times 10^{8}  2.5\\times 10^{8} \\\\ 3.0\\times 10^{8}  2.0\\times 10^{8} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 局部空间增量 (单位：米):\n    $$\n    \\Delta x = \\begin{bmatrix}\n    \\begin{bmatrix} 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix},\\quad\n    \\Delta y = \\begin{bmatrix}\n    \\begin{bmatrix} 0.2\\times 10^{-3}  1.5\\times 10^{-3} \\\\ 0.2\\times 10^{-3}  1.5\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix},\\quad\n    \\Delta z = \\begin{bmatrix}\n    \\begin{bmatrix} 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3}  1.0\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 安全因子 (无量纲): $\\sigma = 1.0$。\n\n- 测试用例 $3$ (二维，混合间距):\n  - 维度: $d=2$。\n  - 网格形状: $3\\times 2$。\n  - 局部波速数组 $v$ (单位：米/秒):\n    $$\n    v = \\begin{bmatrix}\n    \\begin{bmatrix} 1.5\\times 10^{8}  2.0\\times 10^{8}  2.5\\times 10^{8} \\\\ 1.8\\times 10^{8}  2.2\\times 10^{8}  2.6\\times 10^{8} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 局部空间增量 (单位：米):\n    $$\n    \\Delta x = \\begin{bmatrix}\n    \\begin{bmatrix} 0.5\\times 10^{-3}  0.3\\times 10^{-3}  0.4\\times 10^{-3} \\\\ 0.6\\times 10^{-3}  0.4\\times 10^{-3}  0.5\\times 10^{-3} \\end{bmatrix}\n    \\endbmatrix},\\quad\n    \\Delta y = \\begin{bmatrix}\n    \\begin{bmatrix} 0.6\\times 10^{-3}  0.7\\times 10^{-3}  0.6\\times 10^{-3} \\\\ 0.5\\times 10^{-3}  0.8\\times 10^{-3}  0.7\\times 10^{-3} \\end{bmatrix}\n    \\end{bmatrix}.\n    $$\n  - 安全因子 (无量纲): $\\sigma = 0.98$。\n\n- 测试用例 $4$ (一维，非均匀介质):\n  - 维度: $d=1$。\n  - 网格形状: $5$。\n  - 局部波速数组 $v$ (单位：米/秒):\n    $$\n    v = \\begin{bmatrix} 1.0\\times 10^{8}  1.5\\times 10^{8}  2.0\\times 10^{8}  2.5\\times 10^{8}  3.0\\times 10^{8} \\end{bmatrix}.\n    $$\n  - 局部空间增量 (单位：米):\n    $$\n    \\Delta x = \\begin{bmatrix} 1.0\\times 10^{-3}  0.9\\times 10^{-3}  0.8\\times 10^{-3}  0.7\\times 10^{-3}  0.6\\times 10^{-3} \\end{bmatrix}.\n    $$\n  - 安全因子 (无量纲): $\\sigma = 1.0$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。例如，如果有四个测试用例，结果分别为 $r_1, r_2, r_3, r_4$，输出必须严格遵循 $[r_1,r_2,r_3,r_4]$ 的格式，其中每个 $r_i$ 是一个以秒为单位的浮点数，四舍五入到 $12$ 位小数。", "solution": "### FDTD 的 CFL 稳定性条件推导\n\n时域问题计算电磁学的基础是麦克斯韦方程组。在无源、线性、各向同性、非色散介质中，它们由以下公式给出：\n$$ \\nabla \\times \\vec{E} = - \\frac{\\partial \\vec{B}}{\\partial t} \\quad (1) $$\n$$ \\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t} \\quad (2) $$\n电场 $\\vec{E}$ 和磁场 $\\vec{H}$ 通过本构关系与电通量密度 $\\vec{D}$ 和磁通量密度 $\\vec{B}$ 相关联：\n$$ \\vec{D} = \\epsilon \\vec{E} \\quad (3) $$\n$$ \\vec{B} = \\mu \\vec{H} \\quad (4) $$\n其中 $\\epsilon$ 是介质的电介质常数，$\\mu$ 是介质的磁导率。将 $(3)$ 和 $(4)$ 代入 $(1)$ 和 $(2)$ 得：\n$$ \\frac{\\partial \\vec{E}}{\\partial t} = \\frac{1}{\\epsilon} (\\nabla \\times \\vec{H}) \\quad (5) $$\n$$ \\frac{\\partial \\vec{H}}{\\partial t} = - \\frac{1}{\\mu} (\\nabla \\times \\vec{E}) \\quad (6) $$\n这些耦合的一阶偏微分方程描述了电磁波的传播。通过对方程 $(1)$ 取旋度并代入 $(2)$，可以推导出波动方程，该方程表明波以速度 $v = 1/\\sqrt{\\mu\\epsilon}$ 传播。\n\n时域有限差分 (FDTD) 方法，特别是 Yee 格式，以数值方式求解这些方程。其关键思想是对空间和时间进行离散化，并在一个交错网格（称为 Yee 单元）上评估 $\\vec{E}$ 和 $\\vec{H}$ 场。电场分量位于概念网格单元的边上，而磁场分量位于面上。这种空间交错方式允许使用中心差分自然而准确地评估旋度算子。此外，场在时间上以蛙跳方式更新：$\\vec{E}$ 场在整数时间步 ($n\\Delta t$) 进行评估，而 $\\vec{H}$ 场在半整数时间步 ($(n \\pm 1/2)\\Delta t$) 进行评估。\n\n让我们写出一个分量（例如 $E_x$）在三维网格中的更新方程。对时间和空间导数都使用中心差分，方程 $(5)$ 变为：\n$$ \\frac{E_x^{n+1}|_{i+\\frac{1}{2},j,k} - E_x^{n}|_{i+\\frac{1}{2},j,k}}{\\Delta t} = \\frac{1}{\\epsilon} \\left( \\frac{H_z^{n+\\frac{1}{2}}|_{i+\\frac{1}{2},j+\\frac{1}{2},k} - H_z^{n+\\frac{1}{2}}|_{i+\\frac{1}{2},j-\\frac{1}{2},k}}{\\Delta y} - \\frac{H_y^{n+\\frac{1}{2}}|_{i+\\frac{1}{2},j,k+\\frac{1}{2}} - H_y^{n+\\frac{1}{2}}|_{i+\\frac{1}{2},j,k-\\frac{1}{2}}}{\\Delta z} \\right) $$\n这是一个显式更新：未来的值 $E_x^{n+1}$ 仅由过去的值（$E_x^n$ 和 $H^{n+1/2}$）计算得出。这种显式性质对时间步长 $\\Delta t$ 施加了约束，以使数值解保持稳定。如果 $\\Delta t$ 太大，数值误差可能会呈指数级增长，使模拟失效。Courant-Friedrichs-Lewy (CFL) 条件提供了这个稳定性界限。\n\n为了推导该条件，我们进行 von Neumann 稳定性分析。我们假设离散网格上的场具有平面波解。对于具有间距 $\\Delta x$、$\\Delta y$、$\\Delta z$ 的均匀网格段，通用场分量 $F$ 可以写为：\n$$ F^{n}|_{i,j,k} = F_0 \\, G^n \\, e^{I(k_x i \\Delta x + k_y j \\Delta y + k_z k \\Delta z)} $$\n这里，$F_0$ 是振幅，$\\vec{k} = (k_x, k_y, k_z)$ 是波矢量，$I = \\sqrt{-1}$，$G = e^{-I\\omega_{num} \\Delta t}$ 是放大或增长因子，其中 $\\omega_{num}$ 是数值角频率。为了保持稳定，对于任何可能的波矢量 $\\vec{k}$，增长因子的幅度都不得超过 1，即 $|G| \\le 1$。\n\n将平面波拟设代入全套离散化的麦克斯韦方程组，可得到数值色散关系。一个更直接的方法是组合更新方程。我们可以将离散化的 $\\vec{E}$ 和 $\\vec{H}$ 蛙跳更新符号化地表示为：\n$$ \\vec{E}^{n+1} = \\vec{E}^n + \\frac{\\Delta t}{\\epsilon} \\vec{\\nabla}_d \\times \\vec{H}^{n+\\frac{1}{2}} $$\n$$ \\vec{H}^{n+\\frac{1}{2}} = \\vec{H}^{n-\\frac{1}{2}} - \\frac{\\Delta t}{\\mu} \\vec{\\nabla}_d \\times \\vec{E}^{n} $$\n将第二个方程代入第一个方程的时间移位版本，得到 $\\vec{E}$ 的离散波动方程：\n$$ \\frac{\\vec{E}^{n+1} - 2\\vec{E}^n + \\vec{E}^{n-1}}{(\\Delta t)^2} = \\frac{1}{\\epsilon\\mu} \\vec{\\nabla}_d \\times (\\vec{\\nabla}_d \\times \\vec{E}^n) $$\n应用平面波形式 $E^n \\propto G^n$ 得：\n$$ \\frac{G - 2 + G^{-1}}{(\\Delta t)^2} = -v^2 |\\vec{K}|^2 $$\n其中 $v=1/\\sqrt{\\epsilon\\mu}$，$\\vec{K}$ 是数值波矢量，其分量为 $K_x = \\frac{2}{\\Delta x}\\sin(\\frac{k_x \\Delta x}{2})$, $K_y = \\frac{2}{\\Delta y}\\sin(\\frac{k_y \\Delta y}{2})$, 和 $K_z = \\frac{2}{\\Delta z}\\sin(\\frac{k_z \\Delta z}{2})$。\n重新整理关于 $G$ 的方程得到：\n$$ G^2 - (2 - (v \\Delta t |\\vec{K}|)^2)G + 1 = 0 $$\n这是一个关于 $G$ 的二次方程。为了使 $|G| \\le 1$，其根必须是单位圆上的复共轭。这发生在二次方程的判别式为非正数时：\n$$ \\left(2 - (v \\Delta t |\\vec{K}|)^2\\right)^2 - 4 \\le 0 $$\n$$ -2 \\le 2 - (v \\Delta t |\\vec{K}|)^2 \\le 2 $$\n$$ 0 \\le (v \\Delta t |\\vec{K}|)^2 \\le 4 $$\n因此，稳定性条件是 $v \\Delta t |\\vec{K}| \\le 2$。这必须对所有可能的波矢量 $\\vec{k}$ 都成立。对 $\\Delta t$ 最严格的条件来自于 $|\\vec{K}|$ 的最大可能值。$\\sin(\\theta)$ 的最大值为 $1$。这发生在网格能支持的最高频率模式（奈奎斯特频率）下，即 $k_x = \\pi/\\Delta x$, $k_y = \\pi/\\Delta y$, 和 $k_z = \\pi/\\Delta z$。在这种最坏情况下：\n$$ |\\vec{K}|_{max}^2 = \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 $$\n将此代入稳定性条件 $ (v \\Delta t |\\vec{K}|_{max})^2 \\le 4 $：\n$$ (v \\Delta t)^2 \\left( \\frac{4}{(\\Delta x)^2} + \\frac{4}{(\\Delta y)^2} + \\frac{4}{(\\Delta z)^2} \\right) \\le 4 $$\n$$ \\Delta t \\le \\frac{1}{v \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2}} \\quad (7) $$\n这是在均匀网格上进行 3D FDTD 模拟的 CFL 稳定性条件。2D 和 1D 的条件通过移除不相关的空间项得到：\n$$ \\Delta t \\le \\frac{1}{v \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2}} \\quad (2D) $$\n$$ \\Delta t \\le \\frac{\\Delta x}{v} \\quad (1D) $$\n\n问题指定了一个非均匀网格，其中局部波速 $v_{i,j,k}$ 和网格间距 $\\Delta x_{i,j,k}, \\Delta y_{i,j,k}, \\Delta z_{i,j,k}$ 随位置变化。由于整个模拟域使用单一的全局时间步长 $\\Delta t$，因此这个 $\\Delta t$ 必须足够小以确保每个单元格的稳定性。整体稳定性由网格中的“最薄弱环节”决定：即需要最小时间步长的单元格。这对应于具有最高波速和最小网格间距组合的单元格。\n因此，为了找到整个网格的保守全局时间步长，必须计算每个单元格 $(i,j,k)$ 的局部稳定性极限，并选择其中的最小值。\n$$ \\Delta t_{limit} = \\min_{i,j,k} \\left( \\Delta t_{local, i,j,k} \\right) $$\n其中 $\\Delta t_{local, i,j,k}$ 由方程 $(7)$ 使用局部参数 $v_{i,j,k}$、$\\Delta x_{i,j,k}$ 等给出。\n\n最后，通常的做法是使用一个安全因子 $\\sigma \\le 1$ 来将时间步长稍微减小到理论最大值以下，从而为这种理想化分析未捕捉到的数值伪影提供安全边际。最终计算的时间步长是：\n$$ \\Delta t_{compute} = \\sigma \\times \\Delta t_{limit} $$\n将要实现的程序将执行此逐元素扫描，计算最小局部时间步长限制，并应用安全因子。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a conservative global time step for FDTD simulations\n    on heterogeneous grids based on the CFL stability condition.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1: 3D, heterogeneous grid\n        {\n            \"d\": 3, \"sigma\": 0.95,\n            \"v\": np.array([\n                [[2.0e8, 2.5e8], [3.0e8, 1.8e8]],\n                [[1.5e8, 3.0e8], [2.2e8, 2.8e8]]\n            ]),\n            \"dx\": np.array([\n                [[1.0e-3, 1.0e-3], [1.0e-3, 1.0e-3]],\n                [[1.0e-3, 1.0e-3], [1.0e-3, 1.0e-3]]\n            ]),\n            \"dy\": np.array([\n                [[1.2e-3, 1.2e-3], [1.0e-3, 0.9e-3]],\n                [[1.1e-3, 1.0e-3], [1.0e-3, 1.0e-3]]\n            ]),\n            \"dz\": np.array([\n                [[0.9e-3, 1.1e-3], [1.3e-3, 1.0e-3]],\n                [[1.0e-3, 1.0e-3], [1.0e-3, 0.8e-3]]\n            ]),\n        },\n        # Test Case 2: 3D, anisotropic spacing\n        {\n            \"d\": 3, \"sigma\": 1.0,\n            \"v\": np.array([\n                [[3.0e8, 2.5e8], [3.0e8, 2.0e8]]\n            ]),\n            \"dx\": np.array([\n                [[1.0e-3, 1.0e-3], [1.0e-3, 1.0e-3]]\n            ]),\n            \"dy\": np.array([\n                [[0.2e-3, 1.5e-3], [0.2e-3, 1.5e-3]]\n            ]),\n            \"dz\": np.array([\n                [[1.0e-3, 1.0e-3], [1.0e-3, 1.0e-3]]\n            ]),\n        },\n        # Test Case 3: 2D, mixed spacings\n        {\n            \"d\": 2, \"sigma\": 0.98,\n            \"v\": np.array([\n                [1.5e8, 2.0e8, 2.5e8],\n                [1.8e8, 2.2e8, 2.6e8]\n            ]),\n            \"dx\": np.array([\n                [0.5e-3, 0.3e-3, 0.4e-3],\n                [0.6e-3, 0.4e-3, 0.5e-3]\n            ]),\n            \"dy\": np.array([\n                [0.6e-3, 0.7e-3, 0.6e-3],\n                [0.5e-3, 0.8e-3, 0.7e-3]\n            ]),\n        },\n        # Test Case 4: 1D, heterogeneous medium\n        {\n            \"d\": 1, \"sigma\": 1.0,\n            \"v\": np.array([1.0e8, 1.5e8, 2.0e8, 2.5e8, 3.0e8]),\n            \"dx\": np.array([1.0e-3, 0.9e-3, 0.8e-3, 0.7e-3, 0.6e-3]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        d = case[\"d\"]\n        sigma = case[\"sigma\"]\n        v = case[\"v\"]\n\n        if d == 1:\n            dx = case[\"dx\"]\n            # CFL condition for 1D: dt = dx / v\n            local_dt_limits = dx / v\n        elif d == 2:\n            dx = case[\"dx\"]\n            dy = case[\"dy\"]\n            # Sum of inverse squared deltas for 2D\n            inv_deltas_sq = (1.0 / dx**2) + (1.0 / dy**2)\n            # CFL condition for 2D: dt = 1 / (v * sqrt(1/dx^2 + 1/dy^2))\n            local_dt_limits = 1.0 / (v * np.sqrt(inv_deltas_sq))\n        elif d == 3:\n            dx = case[\"dx\"]\n            dy = case[\"dy\"]\n            dz = case[\"dz\"]\n            # Sum of inverse squared deltas for 3D\n            inv_deltas_sq = (1.0 / dx**2) + (1.0 / dy**2) + (1.0 / dz**2)\n            # CFL condition for 3D: dt = 1 / (v * sqrt(1/dx^2 + 1/dy^2 + 1/dz^2))\n            local_dt_limits = 1.0 / (v * np.sqrt(inv_deltas_sq))\n        else:\n            raise ValueError(f\"Unsupported dimension d={d}\")\n\n        # The global time step limit is the minimum of all local limits.\n        min_dt_limit = np.min(local_dt_limits)\n        \n        # Apply the safety factor to get the final conservative time step.\n        final_dt = sigma * min_dt_limit\n        \n        # Round to 12 decimal places as specified.\n        results.append(round(final_dt, 12))\n\n    # Final print statement in the exact required format.\n    # Using 'g' format to avoid trailing zeros for simple numbers if they occur\n    # and to handle scientific notation, then converting to string.\n    # The `round` above already sets the precision.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3296724"}]}