{"hands_on_practices": [{"introduction": "在 FDTD 仿真中实现总场/散射场 (TF/SF) 边界，需要在边界上对特定场分量的更新方程进行修正。第一个练习 [@problem_id:3318268] 是一个基础的概念性检验，旨在识别哪些场分量与二维 TF/SF 边界的不同面相切。理解 Yee 元胞上的这种空间关系是编写正确 TF/SF 源条件的第一步。", "problem": "使用均匀笛卡尔Yee网格在二维空间中实现一个矩形总场/散射场 (TFSF) 边界。考虑两种典型的二维偏振：具有非零分量 $(E_z,H_x,H_y)$ 的二维 $\\mathrm{TM}_z$ 波，以及具有非零分量 $(H_z,E_x,E_y)$ 的二维 $\\mathrm{TE}_z$ 波。TFSF边界是一个与 $x$ 和 $y$ 轴对齐的矩形，它将空间划分为一个总场区和一个散射场区。在时域有限差分法中，场的更新是麦克斯韦旋度方程的离散化形式，而Yee格式的环路/面积对应关系意味着，只有与矩形给定面相切的场分量才会出现在穿过该面的离散旋度中，因此在TFSF实现中需要校正项。\n\n从$\\mathrm{TM}_z$的二维旋度方程\n$$\n\\frac{\\partial E_z}{\\partial t}=\\frac{1}{\\epsilon}\\left(\\frac{\\partial H_y}{\\partial x}-\\frac{\\partial H_x}{\\partial y}\\right),\\quad\n\\frac{\\partial H_x}{\\partial t}=-\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial y},\\quad\n\\frac{\\partial H_y}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial x},\n$$\n以及$\\mathrm{TE}_z$的二维旋度方程\n$$\n\\frac{\\partial H_z}{\\partial t}=-\\frac{1}{\\mu}\\left(\\frac{\\partial E_y}{\\partial x}-\\frac{\\partial E_x}{\\partial y}\\right),\\quad\n\\frac{\\partial E_x}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial y},\\quad\n\\frac{\\partial E_y}{\\partial t}=-\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial x},\n$$\n出发，请论证哪些场分量与矩形TFSF边界的每个面（西、东、南、北）相切，并且其离散旋度差分穿过该面，因此在TFSF实现中需要校正项。选择一个选项，该选项为每种偏振正确列出了位于每个面上、因此必须在该面上进行校正的场分量对：\n\nA. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。\n\nB. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_x)$；南/北面使用 $(E_z,H_y)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。\n\nC. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_x)$；南/北面使用 $(H_z,E_y)$。\n\nD. 对于 $\\mathrm{TM}_z$ 波：所有面仅使用 $(H_x,H_y)$；$E_z$ 不与任何面相交。对于 $\\mathrm{TE}_z$ 波：所有面仅使用 $(E_x,E_y)$；$H_z$ 不与任何面相交。", "solution": "用户希望我扮演一位严谨的STEM教授，在时域有限差分法 (FDTD) 的背景下，解决关于总场/散射场 (TFSF) 边界实现的问题。\n\n### 步骤1：提取已知条件\n\n-   **计算网格**：在二维空间（$x, y$）中使用均匀笛卡尔Yee网格。\n-   **边界条件**：一个与 $x$ 和 $y$ 轴对齐的矩形总场/散射场 (TFSF) 边界。\n-   **偏振**：\n    -   二维 $\\mathrm{TM}_z$ 波，非零场分量为 $(E_z, H_x, H_y)$。\n    -   二维 $\\mathrm{TE}_z$ 波，非零场分量为 $(H_z, E_x, E_y)$。\n-   **$\\mathrm{TM}_z$ 的控制方程**：\n    -   $\\frac{\\partial E_z}{\\partial t}=\\frac{1}{\\epsilon}\\left(\\frac{\\partial H_y}{\\partial x}-\\frac{\\partial H_x}{\\partial y}\\right)$\n    -   $\\frac{\\partial H_x}{\\partial t}=-\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial y}$\n    -   $\\frac{\\partial H_y}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial x}$\n-   **$\\mathrm{TE}_z$ 的控制方程**：\n    -   $\\frac{\\partial H_z}{\\partial t}=-\\frac{1}{\\mu}\\left(\\frac{\\partial E_y}{\\partial x}-\\frac{\\partial E_x}{\\partial y}\\right)$\n    -   $\\frac{\\partial E_x}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial y}$\n    -   $\\frac{\\partial E_y}{\\partial t}=-\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial x}$\n-   **关键原理**：问题陈述指出“只有与给定面相切的场分量……才会出现在穿过该面的离散旋度中，因此需要校正项”。这表示我们需要确定与矩形边界每个面相切的场分量。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于标准的FDTD方法和TFSF边界条件，这些是计算电磁学中的基本概念。所提供的二维 $\\mathrm{TM}_z$ 和 $\\mathrm{TE}_z$ 偏振的麦克斯韦方程组是正确的。关于Yee网格以及离散旋度和切向场之间对应关系的描述是准确的。\n-   **适定性**：问题陈述清晰，并提供了所有必要的信息（控制方程、场分量、边界几何形状）来确定答案。问题是具体的，要求确定在每个边界面上需要校正的场分量对。可以从这些原理中推导出唯一、确定的解。\n-   **客观性**：语言技术性强且精确，没有任何主观性或歧义。所使用的术语是电磁学领域的标准术语。\n\n在问题陈述中未发现任何缺陷。它是科学合理的、适定的和客观的。\n\n### 步骤3：结论与行动\n\n问题陈述有效。我现在将开始推导解决方案。\n\n### 基于原理的推导\n\n总场/散射场 (TFSF) 方法涉及将计算域划分为一个总场区（包含入射场和散射场）和一个散射场区（仅包含散射场）。这些区域之间的边界需要特殊的更新方程来引入入射波。\n\nFDTD方法在交错的Yee网格上离散化麦克斯韦旋度方程。如果一个场分量的更新方程涉及跨越TFSF边界的空间有限差分，则该分量需要校正。正如问题正确指出的那样，这涉及与边界面相切的分量。\n\n矩形边界由四个面组成：西面和东面（$x$为常数的表面）以及南面和北面（$y$为常数的表面）。\n\n**二维 $\\mathrm{TM}_z$ 偏振分析**\n\n非零分量为 $(E_z, H_x, H_y)$。电场 $\\vec{E} = E_z \\hat{z}$ 垂直于 $xy$ 平面。磁场 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$ 位于 $xy$ 平面内。\n\n1.  **西/东面（$x$为常数）**：\n    -   这些面的法向量在 $\\hat{x}$ 方向上。\n    -   如果一个场在 $\\hat{x}$ 方向上的分量为零，则该场与此面相切。\n    -   对于 $\\vec{E} = E_z \\hat{z}$，沿 $\\hat{x}$ 的分量为零。因此，$E_z$ 是切向的。\n    -   对于 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$，与面相切的分量是 $H_y \\hat{y}$。因此，$H_y$ 是切向磁场分量。\n    -   FDTD更新方程耦合了这些切向分量。$H_y$ 的更新涉及 $\\frac{\\partial E_z}{\\partial x}$，$E_z$ 的更新涉及 $\\frac{\\partial H_y}{\\partial x}$。当通过有限差分计算这些导数并跨越TFSF边界的$x$恒定面时，必须应用入射场 ($E_z^{inc}, H_y^{inc}$) 的校正项。\n    -   因此，对于西面和东面，需要校正的场分量是 $(E_z, H_y)$。\n\n2.  **南/北面（$y$为常数）**：\n    -   这些面的法向量在 $\\hat{y}$ 方向上。\n    -   如果一个场在 $\\hat{y}$ 方向上的分量为零，则该场与此面相切。\n    -   对于 $\\vec{E} = E_z \\hat{z}$，沿 $\\hat{y}$ 的分量为零。因此，$E_z$ 是切向的。\n    -   对于 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$，与面相切的分量是 $H_x \\hat{x}$。因此，$H_x$ 是切向磁场分量。\n    -   $H_x$ 的FDTD更新取决于 $\\frac{\\partial E_z}{\\partial y}$，$E_z$ 的更新取决于 $\\frac{\\partial H_x}{\\partial y}$。跨越TFSF边界的$y$恒定面进行有限差分需要涉及 $(E_z^{inc}, H_x^{inc})$ 的校正项。\n    -   因此，对于南面和北面，需要校正的场分量是 $(E_z, H_x)$。\n\n**二维 $\\mathrm{TE}_z$ 偏振分析**\n\n非零分量为 $(H_z, E_x, E_y)$。磁场 $\\vec{H} = H_z \\hat{z}$ 垂直于 $xy$ 平面。电场 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$ 位于 $xy$ 平面内。\n\n1.  **西/东面（$x$为常数）**：\n    -   法向量为 $\\hat{x}$。\n    -   对于 $\\vec{H} = H_z \\hat{z}$，沿 $\\hat{x}$ 的分量为零。因此，$H_z$ 是切向的。\n    -   对于 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$，与面相切的分量是 $E_y \\hat{y}$。因此，$E_y$ 是切向电场分量。\n    -   $E_y$ 的FDTD更新取决于 $\\frac{\\partial H_z}{\\partial x}$，$H_z$ 的更新取决于 $\\frac{\\partial E_y}{\\partial x}$。跨越$x$恒定面进行有限差分需要涉及 $(H_z^{inc}, E_y^{inc})$ 的校正项。\n    -   因此，对于西面和东面，需要校正的场分量是 $(H_z, E_y)$。\n\n2.  **南/北面（$y$为常数）**：\n    -   法向量为 $\\hat{y}$。\n    -   对于 $\\vec{H} = H_z \\hat{z}$，沿 $\\hat{y}$ 的分量为零。因此，$H_z$ 是切向的。\n    -   对于 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$，与面相切的分量是 $E_x \\hat{x}$。因此，$E_x$ 是切向电场分量。\n    -   $E_x$ 的FDTD更新取决于 $\\frac{\\partial H_z}{\\partial y}$，$H_z$ 的更新取决于 $\\frac{\\partial E_x}{\\partial y}$。跨越$y$恒定面进行有限差分需要涉及 $(H_z^{inc}, E_x^{inc})$ 的校正项。\n    -   因此，对于南面和北面，需要校正的场分量是 $(H_z, E_x)$。\n\n**结果总结**\n-   对于 $\\mathrm{TM}_z$ 偏振：\n    -   西/东面（$x$为常数）：$(E_z, H_y)$\n    -   南/北面（$y$为常数）：$(E_z, H_x)$\n-   对于 $\\mathrm{TE}_z$ 偏振：\n    -   西/东面（$x$为常数）：$(H_z, E_y)$\n    -   南/北面（$y$为常数）：$(H_z, E_x)$\n\n### 逐项分析\n\n现在我将根据推导出的结果评估每个选项。\n\n-   **A. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。**\n    -   此选项与推导出的 $\\mathrm{TM}_z$ 和 $\\mathrm{TE}_z$ 偏振的结果完全匹配。\n    -   结论：**正确**。\n\n-   **B. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_x)$；南/北面使用 $(E_z,H_y)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。**\n    -   对于$\\mathrm{TM}_z$的分配是不正确的。$H_x$ 与$y$恒定面相切，而不是与$x$恒定面。$H_y$ 与$x$恒定面相切，而不是与$y$恒定面。$H_x$ 和 $H_y$ 的作用互换了。\n    -   结论：**不正确**。\n\n-   **C. 对于 $\\mathrm{TM}_z$ 波：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$ 波：西/东面使用 $(H_z,E_x)$；南/北面使用 $(H_z,E_y)$。**\n    -   对于$\\mathrm{TE}_z$的分配是不正确的。$E_x$ 与$y$恒定面相切，而不是与$x$恒定面。$E_y$ 与$x$恒定面相切，而不是与$y$恒定面。$E_x$ 和 $E_y$ 的作用互换了。\n    -   结论：**不正确**。\n\n-   **D. 对于 $\\mathrm{TM}_z$ 波：所有面仅使用 $(H_x,H_y)$；$E_z$ 不与任何面相交。对于 $\\mathrm{TE}_z$ 波：所有面仅使用 $(E_x,E_y)$；$H_z$ 不与任何面相交。**\n    -   这个选项存在根本性缺陷。分量 $E_z$（对于 $\\mathrm{TM}_z$）和 $H_z$（对于 $\\mathrm{TE}_z$）总是与 $xy$ 平面中的任何面相切，并且在更新方程中起着关键作用。它还不正确地将 $(H_x,H_y)$ 和 $(E_x,E_y)$ 配对用于所有面。\n    -   结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3318268"}, {"introduction": "在识别了相关场分量的概念基础上，本练习 [@problem_id:3318213] 深入探讨了 TF/SF 修正项的数学基础。通过应用场等效原理，您将推导出一个三维 TF/SF 立方体每个面上的等效电磁表面流的符号。这项练习巩固了高层理论与 FDTD 代码中所需的底层符号之间的联系。", "problem": "在一个介电常数为 $\\varepsilon$、磁导率为 $\\mu$、波阻抗为 $\\eta=\\sqrt{\\mu/\\varepsilon}$、相速度为 $v=\\frac{1}{\\sqrt{\\mu \\varepsilon}}$ 的均匀、各向同性、无源介质的三维时域有限差分 (FDTD) 模拟中，一个立方的全场/散射场 (TFSF) 边界将全场区与散射场区分隔开。该立方体与笛卡尔坐标轴对齐，其各个面位于 $x=x_{\\min}$、$x=x_{\\max}$、$y=y_{\\min}$、$y=y_{\\max}$、$z=z_{\\min}$ 和 $z=z_{\\max}$。每个面上的单位法向量 $\\hat{\\mathbf{n}}$ 从全场区向外指向散射场区。\n\n该介质中的入射平面波由波矢量 $\\mathbf{k}=k\\,\\hat{\\mathbf{k}}$（其中 $k=\\omega/v$）、满足 $\\hat{\\mathbf{p}}\\cdot \\hat{\\mathbf{k}}=0$ 的单位极化矢量 $\\hat{\\mathbf{p}}$ 以及振幅为 $E_{0}$ 的标量波形 $g(\\cdot)$ 指定。时域场为\n$$\n\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t)=E_{0}\\,\\hat{\\mathbf{p}}\\,g\\!\\left(t-\\frac{\\hat{\\mathbf{k}}\\cdot \\mathbf{r}}{v}\\right), \\qquad\n\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t)=\\frac{1}{\\eta}\\,\\hat{\\mathbf{k}}\\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n\n从麦克斯韦方程组和场等效原理出发，推导在 TFSF 界面上产生内部全场和外部仅散射场所需的等效面电流密度和面磁流密度。根据场等效原理，并在总场区外抵消入射场，所需的等效面电流密度和面磁流密度由以下公式给出：\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t) = - \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t), \\qquad\n\\mathbf{M}_{s}(\\mathbf{r},t) = \\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n对于六个与坐标轴对齐的面，令 $\\hat{\\mathbf{a}}_{x}=\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{a}}_{y}=\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{a}}_{z}=\\hat{\\mathbf{z}}$。通过 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$ 为面 $i$ 定义符号 $s_{i}\\in\\{-1,+1\\}$，其中 $\\alpha(i)\\in\\{x,y,z\\}$ 选择垂直于面 $i$ 的轴，对于 $x_{\\min}$、$y_{\\min}$、$z_{\\min}$ 面，$s_{i}=-1$；对于 $x_{\\max}$、$y_{\\max}$、$z_{\\max}$ 面，$s_{i}=+1$。\n\n最后，计算有序面列表 $\\left[x_{\\min},x_{\\max},y_{\\min},y_{\\max},z_{\\min},z_{\\max}\\right]$ 上符号对 $\\left(s_{J}^{(i)},s_{M}^{(i)}\\right)$ 的 12 项符号模式，其中 $s_{J}^{(i)}$ 和 $s_{M}^{(i)}$ 定义如下\n$$\n\\mathbf{J}_{s}^{(i)}=s_{J}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=s_{M}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n按照 $\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$ 的顺序，将最终的符号模式报告为单个 $1\\times 12$ 的行矩阵。无需进行数值舍入。最终答案中不要包含单位。", "solution": "该问题要求在给定一个与文章主体部分一致的特定场等效原理约定的情况下，推导三维 TFSF 边界上修正项的符号模式。\n\nTFSF 方法旨在通过在总场区和散射场区之间的边界 $\\mathcal{S}$ 上施加等效面电流来将入射波引入计算域。这些电流的作用是在总场区内重建入射场 $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$，同时在散射场区内将其抵消。\n\n根据文章主体部分推导出的约定，并在此问题中明确指出，实现这一目标所需的等效面电流密度 $\\mathbf{J}_s$ 和面磁流密度 $\\mathbf{M}_s$ 由下式给出：\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t) = - \\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t)\n$$\n$$\n\\mathbf{M}_{s}(\\mathbf{r},t) = \\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t)\n$$\n其中 $\\hat{\\mathbf{n}}$ 是从总场区向外指向散射场区的单位法向量。\n\n问题要求我们确定与立方体 TFSF 边界的六个面相关的修正项的符号 $s_{J}^{(i)}$ 和 $s_{M}^{(i)}$。对于面 $i$，其向外单位法向量写为 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$，其中 $\\hat{\\mathbf{a}}_{\\alpha(i)}$ 是沿该面法线方向的笛卡尔单位向量（$\\hat{\\mathbf{x}}$, $\\hat{\\mathbf{y}}$, 或 $\\hat{\\mathbf{z}}$），而 $s_i$ 是一个符号。根据定义，对于位于最小坐标（$x_{\\min}$、$y_{\\min}$、$z_{\\min}$）的面，$s_i = -1$；对于位于最大坐标（$x_{\\max}$、$y_{\\max}$、$z_{\\max}$）的面，$s_i = +1$。\n\n我们的任务是将电流的基本定义与问题中给出的目标形式进行比较，来确定符号 $s_J^{(i)}$ 和 $s_M^{(i)}$。\n\n首先，分析面电流 $\\mathbf{J}_s^{(i)}$。\n应用于面 $i$ 的基本定义是：\n$$\n\\mathbf{J}_{s}^{(i)} = - \\hat{\\mathbf{n}}_i \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{J}_{s}^{(i)} = - (s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{H}^{\\mathrm{inc}} = -s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}})\n$$\n问题指定的目标形式为：\n$$\n\\mathbf{J}_{s}^{(i)} = s_{J}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n通过直接比较这两个表达式，我们推断出：\n$$\ns_{J}^{(i)} = -s_i\n$$\n\n接下来，分析面磁流 $\\mathbf{M}_s^{(i)}$。\n应用于面 $i$ 的基本定义是：\n$$\n\\mathbf{M}_{s}^{(i)} = \\hat{\\mathbf{n}}_i \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{M}_{s}^{(i)} = (s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{E}^{\\mathrm{inc}} = s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}})\n$$\n问题指定的目标形式为：\n$$\n\\mathbf{M}_{s}^{(i)} = s_{M}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n通过比较这两个表达式，我们推断出：\n$$\ns_{M}^{(i)} = s_i\n$$\n\n我们现在得到了任意面 $i$ 上符号对的通用关系：$(s_{J}^{(i)}, s_{M}^{(i)}) = (-s_i, s_i)$。现在我们可以按指定顺序将此关系应用于六个面中的每一个。\n\n1.  面 $x_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{x_{\\min}} = -\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(x_{\\min})}, s_{M}^{(x_{\\min})}) = (-s_{x_{\\min}}, s_{x_{\\min}}) = (-(-1), -1) = (1, -1)$。\n\n2.  面 $x_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{x_{\\max}} = +\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(x_{\\max})}, s_{M}^{(x_{\\max})}) = (-s_{x_{\\max}}, s_{x_{\\max}}) = (-1, 1)$。\n\n3.  面 $y_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{y_{\\min}} = -\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(y_{\\min})}, s_{M}^{(y_{\\min})}) = (-s_{y_{\\min}}, s_{y_{\\min}}) = (-(-1), -1) = (1, -1)$。\n\n4.  面 $y_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{y_{\\max}} = +\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(y_{\\max})}, s_{M}^{(y_{\\max})}) = (-s_{y_{\\max}}, s_{y_{\\max}}) = (-1, 1)$。\n\n5.  面 $z_{\\min}$：法向量为 $\\hat{\\mathbf{n}}_{z_{\\min}} = -\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(z_{\\min})}, s_{M}^{(z_{\\min})}) = (-s_{z_{\\min}}, s_{z_{\\min}}) = (-(-1), -1) = (1, -1)$。\n\n6.  面 $z_{\\max}$：法向量为 $\\hat{\\mathbf{n}}_{z_{\\max}} = +\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(z_{\\max})}, s_{M}^{(z_{\\max})}) = (-s_{z_{\\max}}, s_{z_{\\max}}) = (-1, 1)$。\n\n最后，我们按照指定顺序连接这些符号对，组合出 12 项的符号模式：\n$\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$\n代入我们计算出的值：\n$\\left[1, -1, -1, 1, 1, -1, -1, 1, 1, -1, -1, 1\\right]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  -1  -1  1  1  -1  -1  1  1  -1  -1  1\n\\end{pmatrix}\n}\n$$", "id": "3318213"}, {"introduction": "一个正确的 TF/SF 实现不仅关乎边界条件本身，还与注入源的性质密切相关。这项高级计算实践 [@problem_id:3356726] 探讨了一个常见的实际问题：具有宽频谱的超短脉冲可能与完全匹配层 (PML) 边界发生不良相互作用，从而导致数值伪影。您将量化此效应，并实施一种窗函数技术来减轻它，从而凸显信号处理在稳健 FDTD 仿真中的重要性。", "problem": "考虑一个一维计算实验，旨在分析在注入超短脉冲时，含完美匹配层 (PML) 边界的时域有限差分 (FDTD) 方法中的总场/散射场 (TF/SF) 表述。总场/散射场 (TF/SF) 表述在总场区域中施加入射场，并允许在该区域之外仅测量散射场。完美匹配层 (PML) 边界旨在以最小的反射吸收出射波。实际上，极短的脉冲可能表现出的带宽会超出 PML 的稳定吸收范围，在 TF/SF 界面和 PML 处产生虚假的高频伪影，从而破坏理想表述的假设。\n\n本研究的基础始于自由空间中的麦克斯韦方程组，\n$$\n\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t},\n$$\n以及它们在时域有限差分 (FDTD) 方法中的标准 Yee 网格离散化。以时间步长 $\\Delta t$ 进行的离散时间采样意味着最大可分辨角频率（奈奎斯特极限）为\n$$\n\\omega_{\\mathrm{N}} = \\frac{\\pi}{\\Delta t}.\n$$\n根据经验观察和理论上的合理解释，离散的 PML 实现的稳定吸收裕度低于奈奎斯特极限；设此裕度为给定的参数 $\\omega_{\\mathrm{PML}}$，其中 $0  \\omega_{\\mathrm{PML}}  \\omega_{\\mathrm{N}}$。对于频谱能量显著占据 $|\\omega| > \\omega_{\\mathrm{PML}}$ 的入射脉冲，PML 可能表现出不可忽略的反射，并且 TF/SF 边界可能注入不能在网格上忠实传播的份量，从而产生伪影。\n\n定义高斯调制的余弦作为入射场的时间包络，\n$$\ns(t) = \\exp\\!\\left( -\\frac{(t - t_0)^2}{2\\tau^2} \\right)\\cos\\!\\big(\\omega_0 (t - t_0)\\big),\n$$\n其中 $\\tau$ 是脉冲宽度参数，$\\omega_0$ 是载波角频率，而 $t_0$ 是时间偏移。考虑一个离散时间采样 $t_n = n \\Delta t$，$n=0,1,\\dots,N-1$，并选择 $t_0 = \\frac{N\\Delta t}{4}$ 以确保脉冲完全位于模拟时间窗 $[0,(N-1)\\Delta t]$ 内。\n\n为量化由于超出 PML 稳定裕度的高频内容而导致 TF/SF 失效的倾向，定义 $s(t_n)$ 的离散时间傅里叶变换，\n$$\nS_k = \\sum_{n=0}^{N-1} s(t_n)\\,\\exp\\!\\left(-j \\omega_k t_n\\right), \\quad \\omega_k = 2\\pi f_k, \\quad f_k \\in \\text{采样间隔为 } \\Delta t \\text{ 的 FFT 频率点},\n$$\n以及伪影比率\n$$\nR = \\frac{\\sum_{k:|\\omega_k|>\\omega_{\\mathrm{PML}}} \\left|S_k\\right|^2}{\\sum_{k} \\left|S_k\\right|^2}.\n$$\n这个 $R$ 是一个在 $[0,1]$ 区间内的无单位分数，用于衡量超出 PML 稳定裕度的频谱能量部分。一个大的 $R$ 值预示着由于高频伪影而可能导致 TF/SF 失效。\n\n提出一种时间上的加窗注入方案来减轻此类伪影。平滑的锥削可以减少频谱泄漏并抑制高频分量。使用 Tukey 窗 $w(n)$，其锥削参数 $\\rho \\in [0,1]$，在 $n=0,1,\\dots,N-1$ 上定义为\n$$\nw(n) = \n\\begin{cases}\n\\frac{1}{2}\\left[1 + \\cos\\!\\left(\\pi\\left(\\frac{2n}{\\rho (N-1)} - 1\\right)\\right)\\right],  $0 \\le n  \\frac{\\rho (N-1)}{2}$, \\\\\n1,  $\\frac{\\rho (N-1)}{2} \\le n \\le (N-1)\\left(1 - \\frac{\\rho}{2}\\right)$, \\\\\n\\frac{1}{2}\\left[1 + \\cos\\!\\left(\\pi\\left(\\frac{2n}{\\rho (N-1)} - \\frac{2}{\\rho} + 1\\right)\\right)\\right],  $(N-1)\\left(1 - \\frac{\\rho}{2}\\right)  n \\le N-1$,\n\\end{cases}\n$$\n其中 $\\rho=1$ 产生 Hann 窗，$\\rho=0$ 产生矩形窗。定义加窗注入\n$$\ns_w(t_n) = w(n)\\, s(t_n),\n$$\n以及相应的离散时间傅里叶变换 $S^{(w)}_k$ 和伪影比率\n$$\nR_w = \\frac{\\sum_{k:|\\omega_k|>\\omega_{\\mathrm{PML}}} \\left|S^{(w)}_k\\right|^2}{\\sum_{k} \\left|S^{(w)}_k\\right|^2}.\n$$\n\n你的任务是：\n- 使用指定的参数实现 $s(t_n)$ 的离散时间构造，以及使用固定的锥削参数 $\\rho = 0.5$ 的相应 Tukey 窗 $w(n)$。\n- 使用定义的离散傅里叶变换计算 $R$ 和 $R_w$。\n- 对于每个提供的测试用例，报告一对值 $\\left[R, R_w\\right]$，两者均为浮点数。\n\n所有角频率单位必须是弧度/秒。所有时间单位必须是秒。三角函数中的角度以弧度为单位。计算出的伪影比率 $R$ 和 $R_w$ 是无单位的分数。最终输出必须将每对值四舍五入到六位小数。\n\n测试套件：\n- 情况 1 (理想情况): $\\Delta t = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $N = 4096$, $\\tau = 5.0\\times 10^{-12}\\,\\mathrm{s}$, $\\omega_0 = 2.0\\times 10^{10}\\,\\mathrm{rad/s}$, $\\omega_{\\mathrm{PML}} = 0.6\\,\\omega_{\\mathrm{N}}$。\n- 情况 2 (短脉冲压力测试): $\\Delta t = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $N = 4096$, $\\tau = 5.0\\times 10^{-13}\\,\\mathrm{s}$, $\\omega_0 = 0.0\\,\\mathrm{rad/s}$, $\\omega_{\\mathrm{PML}} = 0.2\\,\\omega_{\\mathrm{N}}$。\n- 情况 3 (更高采样率): $\\Delta t = 5.0\\times 10^{-13}\\,\\mathrm{s}$, $N = 8192$, $\\tau = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $\\omega_0 = 1.0\\times 10^{12}\\,\\mathrm{rad/s}$, $\\omega_{\\mathrm{PML}} = 0.5\\,\\omega_{\\mathrm{N}}$。\n- 情况 4 (长脉冲，窄带): $\\Delta t = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $N = 4096$, $\\tau = 2.0\\times 10^{-11}\\,\\mathrm{s}$, $\\omega_0 = 5.0\\times 10^{10}\\,\\mathrm{rad/s}$, $\\omega_{\\mathrm{PML}} = 0.6\\,\\omega_{\\mathrm{N}}$。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个元素是表示一个测试用例的由两个元素组成的列表 $\\left[R, R_w\\right]$。例如，一个有效的输出格式是\n`[[R1,R1w],[R2,R2w],[R3,R3w],[R4,R4w]]`,\n其中每个 $R$ 和 $R_w$ 都四舍五入到六位小数。", "solution": "所提出的问题是有效的，在计算电磁学领域有科学依据，并且在数学上是适定的。所有必要的参数和定义都已提供，以计算所需的伪影比率 $R$ 和 $R_w$。解决方案通过实施指定的信号生成、加窗和频谱分析程序来推进。\n\n核心任务是量化一个离散时间信号中位于指定频带之外的频谱能量，这既针对原始信号，也针对经锥削窗修改后的版本。这个度量，即伪影比率 $R$，可作为一个指标，代表入射脉冲在带有完美匹配层 (PML) 边界的总场/散射场 (TF/SF) FDTD 模拟中引起数值伪影的可能性。\n\n对每个测试用例，解决方案按以下顺序步骤进行开发：\n\n1.  **参数初始化**：对于每个案例，设置给定的参数：时间步长 $\\Delta t$、时间样本数 $N$、脉冲宽度参数 $\\tau$、载波角频率 $\\omega_0$ 以及定义为奈奎斯特频率一部分的 PML 稳定裕度。从这些参数中，我们导出次级常量：时间向量 $t_n = n \\Delta t$（其中 $n \\in \\{0, 1, \\dots, N-1\\}$）、脉冲时间偏移 $t_0 = N\\Delta t/4$、奈奎斯特角频率 $\\omega_{\\mathrm{N}} = \\pi/\\Delta t$ 以及绝对 PML 稳定角频率 $\\omega_{\\mathrm{PML}}$。\n\n2.  **信号生成**：入射电场脉冲 $s(t)$ 被建模为高斯调制的余弦波。它的离散时间表示 $s(t_n)$ 是通过以下公式为时间向量 $t_n$ 中的每个点计算的：\n    $$\n    s(t_n) = \\exp\\!\\left( -\\frac{(t_n - t_0)^2}{2\\tau^2} \\right)\\cos\\!\\big(\\omega_0 (t_n - t_0)\\big)\n    $$\n    该信号代表了 TF/SF 表述中的源注入。一个小的 $\\tau$ 对应于时间上的短脉冲，根据时频不确定性原理，这对应于一个宽的频谱。\n\n3.  **Tukey 窗构造**：为减轻高频伪影，对源脉冲应用了时间窗函数。问题指定了一个锥削参数为 $\\rho=0.5$ 的 Tukey 窗 $w(n)$。该窗是根据其在离散索引 $n=0, 1, \\dots, N-1$ 上的分段定义构造的：\n    $$\n    w(n) = \n    \\begin{cases}\n    \\frac{1}{2}\\left[1 + \\cos\\!\\left(\\pi\\left(\\frac{2n}{\\rho (N-1)} - 1\\right)\\right)\\right],  $0 \\le n  \\frac{\\rho (N-1)}{2}$, \\\\\n    1,  $\\frac{\\rho (N-1)}{2} \\le n \\le (N-1)\\left(1 - \\frac{\\rho}{2}\\right)$, \\\\\n    \\frac{1}{2}\\left[1 + \\cos\\!\\left(\\pi\\left(\\frac{2n}{\\rho (N-1)} - \\frac{2}{\\rho} + 1\\right)\\right)\\right],  $(N-1)\\left(1 - \\frac{\\rho}{2}\\right)  n \\le N-1$,\n    \\end{cases}\n    $$\n    这个函数在时间间隔的开始和结束处将信号平滑地锥削到零，这具有减少频谱泄漏和抑制信号傅里叶变换中高频内容的效果。然后，加窗信号被计算为 $s_w(t_n) = w(n) s(t_n)$。\n\n4.  **通过离散傅里叶变换 (DFT) 进行频谱分析**：使用快速傅里叶变换 (FFT) 分析原始信号 $s(t_n)$ 和加窗信号 $s_w(t_n)$ 的频率内容，FFT 是计算 DFT 的一种高效算法。我们计算频谱 $S_k = \\mathrm{FFT}\\{s(t_n)\\}$ 和 $S^{(w)}_k = \\mathrm{FFT}\\{s_w(t_n)\\}$。相应的角频率 $\\omega_k$ 也被确定。对于长度为 $N$、时间步长为 $\\Delta t$ 的信号，FFT 频率由 $f_k = k/(N \\Delta t)$（对于正频率）及其负频率对应值给出。角频率为 $\\omega_k = 2 \\pi f_k$。我们使用一个标准库函数，它为实数到复数的 FFT 提供正确排序的频率点，包括高达奈奎斯特极限的正频率和负频率。\n\n5.  **伪影比率计算**：根据计算出的频谱计算伪影比率 $R$ 和 $R_w$。根据 Parseval's theorem，信号的能量在时域和频域之间是守恒的。总频谱能量与频谱系数的平方幅值之和成正比，即 $\\sum_k |S_k|^2$。“伪影能量”是这部分能量中位于频率幅值超过 PML 稳定裕度的部分，即 $\\sum_{k:|\\omega_k|\\omega_{\\mathrm{PML}}} |S_k|^2$。\n    因此，未加窗信号的伪影比率为：\n    $$\n    R = \\frac{\\sum_{k:|\\omega_k|\\omega_{\\mathrm{PML}}} |S_k|^2}{\\sum_{k} |S_k|^2}\n    $$\n    类似地，对于加窗信号，比率为：\n    $$\n    R_w = \\frac{\\sum_{k:|\\omega_k|\\omega_{\\mathrm{PML}}} |S^{(w)}_k|^2}{\\sum_{k} |S^{(w)}_k|^2}\n    $$\n    这些比率是通过对相关 FFT 系数的平方幅值求和来计算的。使用由条件 $|\\omega_k| > \\omega_{\\mathrm{PML}}$ 生成的布尔掩码来有效地选择带外分量。然后，为每个测试用例存储计算出的一对值 $[R, R_w]$，并按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the result in the specified format.\n    \"\"\"\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1 (happy path)\n        {'dt': 1.0e-12, 'N': 4096, 'tau': 5.0e-12, 'omega0': 2.0e10, 'omega_pml_factor': 0.6},\n        # Case 2 (short-pulse stress)\n        {'dt': 1.0e-12, 'N': 4096, 'tau': 5.0e-13, 'omega0': 0.0, 'omega_pml_factor': 0.2},\n        # Case 3 (higher sampling rate)\n        {'dt': 5.0e-13, 'N': 8192, 'tau': 1.0e-12, 'omega0': 1.0e12, 'omega_pml_factor': 0.5},\n        # Case 4 (long pulse, narrowband)\n        {'dt': 1.0e-12, 'N': 4096, 'tau': 2.0e-11, 'omega0': 5.0e10, 'omega_pml_factor': 0.6},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        R, R_w = calculate_ratios(params)\n        all_results.append(f\"[{R:.6f},{R_w:.6f}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\ndef calculate_ratios(params):\n    \"\"\"\n    Calculates the artifact ratios R and R_w for a single set of parameters.\n    \"\"\"\n    # 1. Parameter Initialization\n    dt = params['dt']\n    N = params['N']\n    tau = params['tau']\n    omega0 = params['omega0']\n    omega_pml_factor = params['omega_pml_factor']\n    rho = 0.5  # Fixed taper parameter for the Tukey window\n\n    # Derived constants\n    t = np.arange(N) * dt\n    t0 = N * dt / 4.0\n    omega_N = np.pi / dt\n    omega_pml = omega_pml_factor * omega_N\n\n    # 2. Signal Generation (Unwindowed)\n    s_t = np.exp(-((t - t0)**2) / (2 * tau**2)) * np.cos(omega0 * (t - t0))\n\n    # 3. Tukey Window Construction and Application\n    n = np.arange(N)\n    w = np.ones(N)\n    N_minus_1 = float(N - 1)\n    \n    first_part_end = rho * N_minus_1 / 2.0\n    second_part_start = N_minus_1 * (1.0 - rho / 2.0)\n    \n    # First taper\n    idx1 = n  first_part_end\n    n1 = n[idx1]\n    w[idx1] = 0.5 * (1 + np.cos(np.pi * (2 * n1 / (rho * N_minus_1) - 1.0)))\n    \n    # Second taper\n    idx3 = n > second_part_start\n    n3 = n[idx3]\n    w[idx3] = 0.5 * (1 + np.cos(np.pi * (2 * n3 / (rho * N_minus_1) - 2.0 / rho + 1.0)))\n    \n    s_w_t = w * s_t\n\n    # 4. Spectral Analysis via DFT\n    # Frequency bins for the FFT\n    freqs = np.fft.fftfreq(N, d=dt)\n    omega_k = 2 * np.pi * freqs\n    \n    # Compute FFTs\n    S_k = np.fft.fft(s_t)\n    S_w_k = np.fft.fft(s_w_t)\n\n    # 5. Artifact Ratio Calculation\n    # Unwindowed signal\n    total_energy = np.sum(np.abs(S_k)**2)\n    artifact_mask = np.abs(omega_k) > omega_pml\n    artifact_energy = np.sum(np.abs(S_k[artifact_mask])**2)\n    R = artifact_energy / total_energy if total_energy > 0 else 0\n\n    # Windowed signal\n    total_energy_w = np.sum(np.abs(S_w_k)**2)\n    artifact_energy_w = np.sum(np.abs(S_w_k[artifact_mask])**2)\n    R_w = artifact_energy_w / total_energy_w if total_energy_w > 0 else 0\n\n    return R, R_w\n\nsolve()\n```", "id": "3356726"}]}