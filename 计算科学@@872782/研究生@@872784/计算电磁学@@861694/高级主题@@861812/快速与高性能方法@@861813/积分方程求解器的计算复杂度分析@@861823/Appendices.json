{"hands_on_practices": [{"introduction": "在分析复杂的积分方程求解器时，理解其核心组成部分的计算成本是至关重要的第一步。本练习将引导你分析矩量法 (Method of Moments) 矩阵中“近场”部分的汇编成本。通过证明其成本与未知数数量 $N$ 呈线性关系 $\\Theta(N)$，你将掌握为什么现代快速算法能够通过矩阵划分来打破传统 $\\mathcal{O}(N^2)$ 的瓶颈。[@problem_id:3293963]", "problem": "考虑一个由矩量法(MoM)离散化的、描述完美导电表面上时谐电磁散射的边界积分方程公式。稠密系统矩阵源于离散化面元（单元）之间通过格林函数核的两两相互作用。为加速计算，该矩阵被划分为近场块和远场块。近场块由网格图邻域定义：对于每个面元 $i$，其近场相互作用仅限于一环邻接集 $\\mathcal{N}(i)$，该集合包含与面元 $i$ 共享至少一个网格边或顶点的面元。假设网格是形状规则且准均匀的，因此存在一个与 $N$ 无关的常数 $C$，使得对于所有面元 $i$，都有 $|\\mathcal{N}(i)| \\leq C$，其中 $N$ 是面元的总数。\n\n对应于面元对 $(i,j)$（其中 $j \\in \\mathcal{N}(i)$）的每个近场块元素，是通过评估一个具有有界数量点数和每个面元有界数量基函数/检验函数运算的固定求积法则来构建的；因此，每个构建的面元对 $(i,j)$ 的算术代价是一个不依赖于 $N$ 的常数 $a$。假设对所有有序的面元-邻居对 $(i,j)$（其中 $j \\in \\mathcal{N}(i)$）都执行了构建过程，并且在构建过程中没有利用对称性。\n\n仅使用上述假设和运算计数的第一性原理，计算构建所有近场块的渐进代价，该代价是 $N$ 的函数。将你的最终答案表示为关于 $N$ 的单个渐进表达式（使用标准的大Theta记号）。不需要数值舍入，也不涉及物理单位。", "solution": "问题要求计算构建矩量法(MoM)矩阵近场块的渐进计算代价。总代价是构建每个单独近场矩阵元素代价的总和。\n\n设 $N$ 为表面上离散化面元的总数。\n设 $T$ 表示近场块的总构建代价。\n问题指出，面元 $i$ 的近场相互作用由其一环邻接集 $\\mathcal{N}(i)$ 定义。构建过程对所有有序的面元-邻居对 $(i, j)$ 执行，其中 $i$ 的范围从 $1$ 到 $N$，$j \\in \\mathcal{N}(i)$。\n构建单个面元对 $(i, j)$ 相互作用的代价给定为一个常数 $a$，它与 $N$ 无关。\n\n总代价 $T$ 可以表示为所有面元 $i$ 的代价之和，其中每个面元的代价是其与所有邻居 $j \\in \\mathcal{N}(i)$ 相互作用的代价之和。\n在数学上，这表示为：\n$$ T = \\sum_{i=1}^{N} \\left( \\sum_{j \\in \\mathcal{N}(i)} (\\text{Cost for pair } (i, j)) \\right) $$\n将每个面元对的给定常数代价 $a$ 代入：\n$$ T = \\sum_{i=1}^{N} \\left( \\sum_{j \\in \\mathcal{N}(i)} a \\right) $$\n由于 $a$ 是一个常数，可以从内层求和中提出来。内层求和随后变成集合 $\\mathcal{N}(i)$ 中元素的数量，即其基数，记作 $|\\mathcal{N}(i)|$。\n$$ \\sum_{j \\in \\mathcal{N}(i)} a = a \\sum_{j \\in \\mathcal{N}(i)} 1 = a \\cdot |\\mathcal{N}(i)| $$\n将此代回总代价 $T$ 的表达式中：\n$$ T = \\sum_{i=1}^{N} a \\cdot |\\mathcal{N}(i)| $$\n由于 $a$ 相对于求和索引 $i$ 是一个常数，我们也可以将其从总和中提出来：\n$$ T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)| $$\n为了确定渐进代价，我们需要找到和 $\\sum_{i=1}^{N} |\\mathcal{N}(i)|$ 作为 $N$ 的函数的渐进行为。这个和表示需要计算的近场相互作用的总数。\n\n我们已知网格是形状规则和准均匀的。这一性质的一个关键推论是，存在一个与 $N$ 无关的常数 $C$，使得任何面元 $i$ 的邻域大小都有一个上界：\n$$ |\\mathcal{N}(i)| \\leq C \\quad \\text{for all } i = 1, \\dots, N $$\n使用这个不等式，我们可以建立总代价 $T$ 的一个上界：\n$$ T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\leq a \\sum_{i=1}^{N} C = a \\cdot C \\cdot N $$\n由于 $a$ 和 $C$ 是常数，总代价 $T$ 的上界是 $N$ 的一个线性函数。用渐进记号表示，这意味着：\n$$ T = O(N) $$\n\n为了用大Theta记号确定渐进行为，我们还必须找到一个下界。`形状规则`和`准均匀`网格的性质也意味着局部连通性在整个网格上是相当均匀的。对于任何不在开放表面网格物理边界上的面元，其邻居数量的下界是一个正常数，例如 $C_{\\min} > 0$。让我们考虑所有面元的集合。一小部分面元可能位于开放表面的边界上，邻居较少。对于一个用 $N$ 个面元离散化的二维表面，这类边界上的面元数量 $N_{\\text{bnd}}$ 通常比 $N$ 的阶数低，例如 $N_{\\text{bnd}} = O(\\sqrt{N})$。内部面元的数量是 $N_{\\text{int}} = N - N_{\\text{bnd}}$。\n\n对于 $N_{\\text{int}}$ 个内部面元中的每一个，我们可以假设 $|\\mathcal{N}(i)| \\geq C_{\\min}$，其中 $C_{\\min}$ 是某个正常数。对于边界上的面元，邻居的数量至少是 $1$（除非网格不连通，这将是病态的）。\n因此我们可以建立这个和的一个下界：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| = \\sum_{i \\in \\text{interior}} |\\mathcal{N}(i)| + \\sum_{i \\in \\text{boundary}} |\\mathcal{N}(i)| \\geq \\sum_{i \\in \\text{interior}} C_{\\min} + \\sum_{i \\in \\text{boundary}} 1 $$\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\geq N_{\\text{int}} \\cdot C_{\\min} + N_{\\text{bnd}} \\cdot 1 = (N - N_{\\text{bnd}}) C_{\\min} + N_{\\text{bnd}} $$\n对于大的 $N$，$N_{\\text{bnd}}$ 是 $N$ 的次线性函数（例如 $O(\\sqrt{N})$），因此 $N_{\\text{int}}$ 渐进于 $N$。下界中的主导项是 $N \\cdot C_{\\min}$。因此，存在一个常数 $C' > 0$，使得对于足够大的 $N$：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| \\geq C' N $$\n这表明该和的下界是 $N$ 的一个线性函数。用渐进记号表示：\n$$ \\sum_{i=1}^{N} |\\mathcal{N}(i)| = \\Omega(N) $$\n由于总代价 $T = a \\sum_{i=1}^{N} |\\mathcal{N}(i)|$ 且 $a$ 是一个正常数，我们有：\n$$ T = \\Omega(N) $$\n\n结合上界和下界，我们有 $T = O(N)$ 和 $T = \\Omega(N)$。根据大Theta记号的定义，这意味着：\n$$ T = \\Theta(N) $$\n构建所有近场块的总代价随面元数量 $N$ 线性增长。", "answer": "$$\\boxed{\\Theta(N)}$$", "id": "3293963"}, {"introduction": "直接求解电场积分方程 (EFIE) 的病态系统极具挑战性，高效的预条件器是迭代求解成功的关键。本练习介绍一种先进的 Calderón 预条件器，并要求你分析其在快速多极子方法 (FMM) 加速下的计算成本。通过这个实践，你将把深刻的理论（Calderón 恒等式）与近线性时间复杂度 $\\mathcal{O}(N \\ln N)$ 的实际成本模型联系起来，并学会将复杂算法分解为“构建”和“应用”两个阶段进行分析。[@problem_id:3294009]", "problem": "考虑一个边界为 $\\Gamma$ 的完美电导体散射体，其电场积分方程 (EFIE) 由频域 Maxwell 方程组和边界 $\\Gamma$ 上的切向边界条件 $\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{tot}} = \\mathbf{0}$ 导出。设 EFIE 算子记为 $\\mathcal{T}_{k}$，它由波数为 $k$ 的电磁格林函数构建。设采用 Rao–Wilton–Glisson (RWG) 基函数的 Galerkin 离散化方法，为求解未知的表面电流展开系数，生成一个稠密系统矩阵 $Z \\in \\mathbb{C}^{N \\times N}$。关于边界 $\\Gamma$ 上边界积分算子的经典 Calderón 恒等式指出，边界积分算子的适当组合可以产生第二类投影算子，这启发我们使用一种乘法形式的 Calderón 预条件子来平衡 EFIE 的谱特性。在一种常用的离散构造中，可以构建乘法预条件子\n$$\nM \\;=\\; G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}},\n$$\n其中 $T_{\\tilde{k}}$ 是在辅助波数 $\\tilde{k}$（选择该波数是为了避免内部谐振）下的离散 EFIE 算子，$G$ 是一个稀疏 Gram 矩阵，用于在相容的试探空间和检验空间（例如 RWG 和 Buffa–Christiansen 基函数空间）之间进行映射，$T_{\\tilde{k}}^{\\dagger}$ 表示关于由 $G$ 导出的离散 $L^{2}$ 配对的伴随算子。假设由于在 $\\Gamma$ 的形状正则三角剖分上具有局部支集和有界顶点度，$G$ 拥有 $\\mathcal{O}(N)$ 个非零元。\n\n为明确复杂度模型，对用于所有稠密算子应用和近场汇集的三维快速多极子方法 (FMM) 作出以下假设：\n- 使用 FMM 与一个离散化的稠密边界积分算子（例如 $T_{\\tilde{k}}$ 或 $T_{\\tilde{k}}^{\\dagger}$）进行一次矩阵向量乘法，需要 $c_{m}\\, N\\, \\ln(N)$ 次浮点运算，其中 $c_{m}  0$ 是一个包含核函数转换成本和展开阶数的常数，并且树结构具有 $\\mathcal{O}(\\ln(N))$ 个层级，总共有 $\\mathcal{O}(N)$ 次盒-盒交互。\n- 为一个算子构建 FMM 数据结构（树、交互列表、多极/局域展开）需要 $c_{b}\\, N\\, \\ln(N)$ 次浮点运算，汇集一个算子的近场块需要 $c_{n}\\, N$ 次浮点运算，其中 $c_{b}, c_{n}  0$ 为常数。\n- 将稀疏 Gram 矩阵 $G$ 应用于一个向量需要 $c_{g}\\, N$ 次浮点运算，而应用 $G$ 的预计算稀疏近似逆（例如，通过不完全 Cholesky 分解后进行三角求解）每次应用需要 $c_{L}\\, N$ 次浮点运算，其中 $c_{g}, c_{L}  0$ 为常数。\n- 构建 $G$ 的稀疏近似逆（包括汇集 $G$ 本身）需要 $c_{g}\\, N + c_{s}\\, N$ 次浮点运算，其中 $c_{s}  0$ 包含了分解/预条件子的构建成本，并与因有界填充而产生的非零元数量成正比。\n\n从 Calderón 恒等式及其推论——EFIE 与相容的边界算子复合会产生一个第二类算子——出发，解释为何乘法形式 $M = G^{-1} T_{\\tilde{k}}^{\\dagger} G T_{\\tilde{k}}$ 在谱特性上适合作为 $Z$ 的预条件子。然后，仅使用给定的复杂度假设和 $M$ 的结构，推导以下两项的闭式表达式：\n1. 构建 $M$ 的总成本（包括构建 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 的 FMM 结构及其近场块，以及汇集 $G$ 和构建其稀疏近似逆）。\n2. 将 $M$ 应用于一个向量一次的总成本（即在迭代求解器内部应用一次预条件子）。\n\n将两个结果表示为关于 $N$, $\\ln(N)$ 以及常数 $c_{m}$, $c_{b}$, $c_{n}$, $c_{g}$, $c_{L}$, 和 $c_{s}$ 的符号表达式。将 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 视为需要不同的 FMM 数据结构，但具有相同的构建和应用成本。你的最终答案必须是闭式解析表达式。将最终成本以浮点运算次数表示。不要包含任何物理单位。如果引入任何新符号，请明确定义它们。最终答案必须以 $\\mathrm{pmatrix}$ 环境的单行矩阵形式提供，其中第一个条目是构建成本，第二个条目是应用成本。", "solution": "该问题要求提供两个主要部分：首先，解释所给出的乘法形式 Calderón 预条件子的谱优势；其次，基于一组明确的复杂度模型，推导构建和应用此预条件子的计算成本。\n\n**第一部分：Calderón 预条件子的谱特性**\n\n电场积分方程 (EFIE) 源于第一类 Fredholm 积分方程。对此类方程进行离散化，例如使用基于 Rao–Wilton–Glisson (RWG) 基函数的矩量法 (MoM)，通常会得到一个线性系统 $Z \\mathbf{x} = \\mathbf{b}$，其中矩阵 $Z \\in \\mathbb{C}^{N \\times N}$ 是稠密的、非厄米的且严重病态的。连续 EFIE 算子的奇异值在零和无穷大处累积，这种不良的谱行为被离散矩阵 $Z$ 继承。因此，当应用于原始系统矩阵 $Z$ 时，像 GMRES 这样的标准迭代求解器收敛非常缓慢，甚至不收敛。\n\n预条件处理旨在将系统转换为一个具有更有利谱特性的等价系统。对于系统 $Z \\mathbf{x} = \\mathbf{b}$，一个好的预条件子 $M$ 会产生一个预处理后的矩阵，例如 $M^{-1}Z$（左预处理）或 $ZM^{-1}$（右预处理），其谱是聚集的，理想情况下聚集在 1 附近。这确保了迭代求解器的快速收敛。\n\nCalderón 恒等式是与偏微分方程（如 Helmholtz 方程，它控制着时谐电磁学）相关的边界积分算子的基本性质。这些恒等式指出，基本边界积分算子（单层、双层、伴随双层和超奇异算子）的特定组合会产生作为单位算子的紧扰动的算子。这类算子是第二类 Fredholm 算子，其谱非常适合迭代方法。\n\nEFIE 算子，记作 $\\mathcal{T}_k$，是一个病态的第一类算子的例子。乘法预条件子 $M = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}$ 是一种旨在模仿连续 Calderón 恒等式的离散代数构造。其各组成部分的作用如下：\n1.  $T_{\\tilde{k}}$：这是 EFIE 算子 $\\mathcal{T}_{\\tilde{k}}$ 在一个非谐振的辅助波数 $\\tilde{k}$ 上的离散化。使用 $\\tilde{k} \\neq k$ 确保了预条件子本身不会因为散射物体的内部谐振而出现病态问题。\n2.  $T_{\\tilde{k}}^{\\dagger}$：这代表一个“对偶”算子的离散版本。在 Calderón 预处理的背景下，这通常与磁场积分方程 (MFIE) 算子有关，而 MFIE 算子天然是第二类的。EFIE 和 MFIE 算子的复合会产生一个良态算子。\n3.  $G$ 和 $G^{-1}$：矩阵 $G$ 是一个稀疏 Gram 矩阵，表示两组不同基函数（如 RWG 试探函数和 Buffa–Christiansen (BC) 检验函数）之间的内积。这些矩阵充当离散的“基变换”算子，将系数从一个函数空间表示映射到另一个，这对于正确地构成与连续 Calderón 恒等式相对应的离散算子复合是必要的。\n\n本质上，算子 $M$ 被构造成一个表现良好的第二类算子的离散近似。因此，预处理后的系统矩阵（例如 $M^{-1}Z$）预期是单位算子加上一个紧算子项的离散近似，从而导致谱聚集在单个点附近，进而确保迭代求解器的快速收敛。\n\n**第二部分：计算成本的推导**\n\n总成本是通过将问题假设中指定的各个步骤的成本相加得出的。\n\n**1. 构建预条件子 $M$ 的总成本**\n\n构建阶段涉及为应用算子 $M = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}$ 而构建所有必需的数据结构。我们不需要汇集完整的矩阵 $M$。所需的组件是用于 $T_{\\tilde{k}}$ 和 $T_{\\tilde{k}}^{\\dagger}$ 的 FMM 结构，以及 $G$ 的稀疏近似逆。\n\n-   **$T_{\\tilde{k}}$ 的构建成本**：这包括构建 FMM 数据结构和汇集近场交互块。\n    $$\n    C_{\\text{build}}(T_{\\tilde{k}}) = (\\text{FMM 构建成本}) + (\\text{近场汇集成本}) = c_{b}\\, N\\, \\ln(N) + c_{n}\\, N\n    $$\n-   **$T_{\\tilde{k}}^{\\dagger}$ 的构建成本**：问题陈述指出 $T_{\\tilde{k}}^{\\dagger}$ 需要一个不同的 FMM 结构，其成本与 $T_{\\tilde{k}}$ 相同。\n    $$\n    C_{\\text{build}}(T_{\\tilde{k}}^{\\dagger}) = c_{b}\\, N\\, \\ln(N) + c_{n}\\, N\n    $$\n-   **$G$ 的逆的构建成本**：问题为汇集稀疏矩阵 $G$ 并构造其稀疏近似逆（例如通过不完全分解）提供了直接的成本。\n    $$\n    C_{\\text{build}}(G^{-1}) = c_{g}\\, N + c_{s}\\, N\n    $$\n总构建成本 $C_{\\text{build}}(M)$ 是这些单独成本的总和。\n$$\nC_{\\text{build}}(M) = C_{\\text{build}}(T_{\\tilde{k}}) + C_{\\text{build}}(T_{\\tilde{k}}^{\\dagger}) + C_{\\text{build}}(G^{-1})\n$$\n$$\nC_{\\text{build}}(M) = \\left( c_{b}\\, N\\, \\ln(N) + c_{n}\\, N \\right) + \\left( c_{b}\\, N\\, \\ln(N) + c_{n}\\, N \\right) + \\left( c_{g}\\, N + c_{s}\\, N \\right)\n$$\n合并各项，我们得到总构建成本的最终表达式：\n$$\nC_{\\text{build}}(M) = 2\\, c_{b}\\, N\\, \\ln(N) + (2\\, c_{n} + c_{g} + c_{s})\\, N\n$$\n\n**2. 将预条件子 $M$ 应用于一个向量的总成本**\n\n应用预条件子涉及为给定向量 $\\mathbf{x}$ 计算矩阵向量积 $\\mathbf{y} = M\\mathbf{x} = G^{-1}\\, T_{\\tilde{k}}^{\\dagger}\\, G\\, T_{\\tilde{k}}\\, \\mathbf{x}$。这是通过从右到左的一系列运算来执行的。\n\n-   **步骤 1：计算 $\\mathbf{v}_1 = T_{\\tilde{k}}\\, \\mathbf{x}$**：这是使用 FMM 的一次矩阵向量乘法。\n    $$\n    C_{\\text{apply}}(T_{\\tilde{k}}) = c_{m}\\, N\\, \\ln(N)\n    $$\n-   **步骤 2：计算 $\\mathbf{v}_2 = G\\, \\mathbf{v}_1$**：这是一次稀疏矩阵向量乘法。\n    $$\n    C_{\\text{apply}}(G) = c_{g}\\, N\n    $$\n-   **步骤 3：计算 $\\mathbf{v}_3 = T_{\\tilde{k}}^{\\dagger}\\, \\mathbf{v}_2$**：这是另一次 FMM 矩阵向量乘法。其成本与应用 $T_{\\tilde{k}}$ 相同。\n    $$\n    C_{\\text{apply}}(T_{\\tilde{k}}^{\\dagger}) = c_{m}\\, N\\, \\ln(N)\n    $$\n-   **步骤 4：计算 $\\mathbf{y} = G^{-1}\\, \\mathbf{v}_3$**：这涉及应用预先计算的 $G$ 的稀疏近似逆（例如，使用不完全因子进行前向和后向替换）。\n    $$\n    C_{\\text{apply}}(G^{-1}) = c_{L}\\, N\n    $$\n应用 $M$ 一次的总成本 $C_{\\text{apply}}(M)$ 是这四个连续步骤的成本总和。\n$$\nC_{\\text{apply}}(M) = C_{\\text{apply}}(T_{\\tilde{k}}) + C_{\\text{apply}}(G) + C_{\\text{apply}}(T_{\\tilde{k}}^{\\dagger}) + C_{\\text{apply}}(G^{-1})\n$$\n$$\nC_{\\text{apply}}(M) = c_{m}\\, N\\, \\ln(N) + c_{g}\\, N + c_{m}\\, N\\, \\ln(N) + c_{L}\\, N\n$$\n合并各项，我们得到总应用成本的最终表达式：\n$$\nC_{\\text{apply}}(M) = 2\\, c_{m}\\, N\\, \\ln(N) + (c_{g} + c_{L})\\, N\n$$\n这两个结果提供了构建成本和应用成本关于给定参数的闭式表达式。两者的主阶复杂度均为 $\\mathcal{O}(N \\ln N)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 c_{b} N \\ln(N) + (2 c_{n} + c_{g} + c_{s}) N  2 c_{m} N \\ln(N) + (c_{g} + c_{L}) N \\end{pmatrix}}\n$$", "id": "3294009"}, {"introduction": "一个最优的求解器不仅使用快速算法，更要智能地分配计算资源，以最小的代价达到给定的精度目标。本练习提供了一个全局优化问题，你需要在近场积分、远场压缩和迭代收敛这三个误差源之间进行权衡。通过求解此问题，你将把所有关于成本模型的知识融会贯通，并推导出求解器在精度约束 $\\epsilon$ 下的最低计算成本，从而深刻理解不同算法参数对总体性能的最终影响。[@problem_id:3294058]", "problem": "考虑一个用于求解三维电磁散射问题的快速积分方程求解器，该问题由光滑闭合曲面上的第二类边界积分方程所支配。假设未知量的数量 $N$ 由物理分辨率要求固定，并且与下文考虑的算法容差无关。该求解器采用三种精度控制机制：\n\n1.  近场求积：对奇异和近奇异相互作用使用 $q$ 个节点，其求积误差有界，满足 $E_{q}(q) \\leq A_{q} \\exp(-\\beta \\, q)$，其中常数 $A_{q}  0$ 且 $\\beta  0$。每个矩阵向量乘积的近场计算量建模为 $W_{q}(q) = c_{q} \\, N \\, q$，其中 $c_{q}  0$。\n\n2.  远场压缩：通过 $p$ 阶解析多极展开，其压缩误差有界，满足 $E_{c}(p) \\leq A_{c} \\, \\rho^{p}$，其中常数 $A_{c}  0$ 且 $0  \\rho  1$。每个矩阵向量乘积的远场计算量为 $W_{c}(p) = c_{f} \\, N \\, p^{2}$，一次性远场构建成本为 $B_{c}(p) = b_{f} \\, N \\, p^{2}$，其中 $c_{f}, b_{f}  0$。\n\n3.  带预处理的 Krylov 迭代求解器：达到残差容差 $\\tau_{r}$ 所需的迭代次数为 $k(\\tau_{r}) = \\gamma \\, \\ln(1/\\tau_{r})$，其中 $\\gamma  0$ 且与 $N$ 无关。\n\n假设总算法误差（不包括离散化/建模误差）由一个误差预算控制，该预算为近场求积、远场压缩和迭代残差分别分配了三个容差 $\\tau_{q}$、$\\tau_{c}$ 和 $\\tau_{r}$，且允许的预算满足 $\\tau_{q} + \\tau_{c} + \\tau_{r} \\leq \\epsilon$，其中 $\\epsilon \\in (0,1)$ 是目标精度。求解器设置参数 $q$、$p$ 和 $k$ 为保证 $E_{q}(q) \\leq \\tau_{q}$、$E_{c}(p) \\leq \\tau_{c}$ 和残差至多为 $\\tau_{r}$ 的最小值。\n\n仅使用这些模型和计算复杂度的基本定义，构建一个误差预算驱动的分配算法。该算法在给定 $\\epsilon$ 的情况下，选择 $\\tau_{q}$、$\\tau_{c}$、$\\tau_{r}$ 以及相应的 $q$、$p$、$k$，以保证总误差最多为 $\\epsilon$ 的同时，最小化总计算成本\n$$\nC \\;=\\; B_{c}(p) \\;+\\; k(\\tau_{r})\\bigl(W_{c}(p) + W_{q}(q)\\bigr).\n$$\n然后，在 $\\epsilon \\to 0$ 的渐近状态下，推导出您的分配算法所能达到的领头阶最小复杂度 $C(\\epsilon)$，并将其表示为 $\\epsilon$ 和问题相关常数 $N$、$A_{q}$、$\\beta$、$c_{q}$、$A_{c}$、$\\rho$、$c_{f}$、$b_{f}$ 和 $\\gamma$ 的闭式解析函数。您的最终答案必须是关于 $\\epsilon$ 的领头阶渐近最小复杂度的单个解析表达式（不得使用大O表示法或不等式）。除已声明的属性外，不要假定任何其他属性，也不要引入任何未声明的简化。\n\n将最终答案表示为不带单位的、关于 $\\epsilon$ 和给定常数的函数。无需四舍五入。", "solution": "我们从给定的精度和成本模型出发，推导最小成本作为目标精度 $\\epsilon$ 的函数。总算法误差通过三个容差 $\\tau_{q}$、$\\tau_{c}$ 和 $\\tau_{r}$ 进行控制，且 $\\tau_{q}+\\tau_{c}+\\tau_{r}\\leq \\epsilon$。根据三角不等式（或针对线性算子和右端项的标准扰动复合界），施加此求和约束足以保证总算法误差不超过 $\\epsilon$。\n\n满足各分量容差所需的参数选择通过反转误差界来确定：\n\n- 近场求积：$E_{q}(q) \\leq A_{q}\\exp(-\\beta q) \\leq \\tau_{q}$ 意味着\n$$\nq(\\tau_{q}) \\;=\\; \\frac{1}{\\beta}\\,\\ln\\!\\left(\\frac{A_{q}}{\\tau_{q}}\\right).\n$$\n\n- 远场压缩：$E_{c}(p) \\leq A_{c}\\rho^{p} \\leq \\tau_{c}$ 意味着\n$$\np(\\tau_{c}) \\;=\\; \\frac{1}{\\ln(1/\\rho)}\\,\\ln\\!\\left(\\frac{A_{c}}{\\tau_{c}}\\right).\n$$\n\n- 迭代次数：$k(\\tau_{r}) = \\gamma \\,\\ln(1/\\tau_{r})$。\n\n根据这些选择，总成本为\n$$\nC(\\tau_{q},\\tau_{c},\\tau_{r}) \\;=\\; b_{f} N\\, p(\\tau_{c})^{2} \\;+\\; k(\\tau_{r})\\Bigl(c_{f} N\\, p(\\tau_{c})^{2} + c_{q} N\\, q(\\tau_{q})\\Bigr).\n$$\n定义对数变量\n$$\nx_{c} \\;=\\; \\ln\\!\\left(\\frac{1}{\\tau_{c}}\\right),\\quad x_{q} \\;=\\; \\ln\\!\\left(\\frac{1}{\\tau_{q}}\\right),\\quad x_{r} \\;=\\; \\ln\\!\\left(\\frac{1}{\\tau_{r}}\\right),\n$$\n并合并常数\n$$\na \\;=\\; \\frac{c_{f}}{\\ln(1/\\rho)^{2}},\\quad b \\;=\\; \\frac{b_{f}}{\\ln(1/\\rho)^{2}},\\quad d \\;=\\; \\frac{c_{q}}{\\beta}.\n$$\n忽略 $p(\\cdot)$ 和 $q(\\cdot)$ 中由 $\\ln(A_{c})$ 和 $\\ln(A_{q})$ 产生的加法常数（这些在渐近分析中只贡献低阶项），我们有\n$$\np(\\tau_{c}) \\approx \\frac{x_{c}}{\\ln(1/\\rho)},\\qquad q(\\tau_{q}) \\approx \\frac{x_{q}}{\\beta}.\n$$\n因此，每个未知量的成本简化为\n$$\n\\frac{C}{N} \\;\\approx\\; \\bigl(b + a\\,\\gamma\\, x_{r}\\bigr)\\, x_{c}^{2} \\;+\\; d\\,\\gamma\\, x_{r}\\, x_{q}.\n$$\n\n误差预算约束 $\\tau_{q} + \\tau_{c} + \\tau_{r} \\leq \\epsilon$ 转换为\n$$\n\\exp(-x_{q}) + \\exp(-x_{c}) + \\exp(-x_{r}) \\;\\leq\\; \\epsilon.\n$$\n在最小值处，此约束是活动的，因此我们取\n$$\n\\exp(-x_{q}) + \\exp(-x_{c}) + \\exp(-x_{r}) \\;=\\; \\epsilon.\n$$\n\n我们现在最小化函数\n$$\nF(x_{q},x_{c},x_{r}) \\;=\\; \\bigl(b + a\\,\\gamma\\, x_{r}\\bigr)\\, x_{c}^{2} \\;+\\; d\\,\\gamma\\, x_{r}\\, x_{q}\n$$\n在约束条件\n$$\ng(x_{q},x_{c},x_{r}) \\;=\\; \\exp(-x_{q}) + \\exp(-x_{c}) + \\exp(-x_{r}) - \\epsilon \\;=\\; 0.\n$$\n下。引入拉格朗日乘子 $\\lambda$ 并考虑\n$$\n\\mathcal{L} \\;=\\; F + \\lambda\\, g.\n$$\n一阶必要条件是\n\\begin{align*}\n\\frac{\\partial \\mathcal{L}}{\\partial x_{c}} \\;=\\; 2\\bigl(b + a\\,\\gamma\\, x_{r}\\bigr)\\, x_{c} \\;-\\; \\lambda\\, \\exp(-x_{c}) \\;=\\; 0,\\\\\n\\frac{\\partial \\mathcal{L}}{\\partial x_{q}} \\;=\\; d\\,\\gamma\\, x_{r} \\;-\\; \\lambda\\, \\exp(-x_{q}) \\;=\\; 0,\\\\\n\\frac{\\partial \\mathcal{L}}{\\partial x_{r}} \\;=\\; a\\,\\gamma\\, x_{c}^{2} \\;+\\; d\\,\\gamma\\, x_{q} \\;-\\; \\lambda\\, \\exp(-x_{r}) \\;=\\; 0,\\\\\n\\exp(-x_{q}) \\;+\\; \\exp(-x_{c}) \\;+\\; \\exp(-x_{r}) \\;=\\; \\epsilon.\n\\end{align*}\n记 $L \\equiv \\ln(1/\\epsilon)$。在 $\\epsilon \\to 0$ 的渐近状态下，从约束条件可以得出，最优的 $x_{c}$、$x_{q}$ 和 $x_{r}$ 都与 $L$ 具有相同的尺度，仅相差 $O(1)$ 的可加常数；确实，每个 $\\tau_{i}$ 都不能超过 $\\epsilon$ 且必须为正，所以 $x_{i} \\geq L + O(1)$，而指数和要求没有任何一个 $x_{i}$ 可以超过 $L$ 一个 $O(1)$ 以上的量，否则会迫使其他某个容差为 $O(\\epsilon)$ 并增加成本。因此，\n$$\nx_{c} \\;=\\; L + O(1),\\qquad x_{q} \\;=\\; L + O(1),\\qquad x_{r} \\;=\\; L + O(1).\n$$\n\n我们现在提取最小成本的领头阶行为。在 $F$ 中使用上述尺度关系，\n$$\nF(x_{q},x_{c},x_{r}) \\;=\\; a\\,\\gamma\\, x_{r}\\, x_{c}^{2} \\;+\\; b\\, x_{c}^{2} \\;+\\; d\\,\\gamma\\, x_{r}\\, x_{q}.\n$$\n由于 $x_{r} \\sim x_{c} \\sim x_{q} \\sim L$，这三项的尺度分别如 $L^{3}$、$L^{2}$ 和 $L^{2}$。因此，唯一的领头阶贡献是\n$$\nF_{\\text{lead}} \\;=\\; a\\,\\gamma\\, x_{r}\\, x_{c}^{2}.\n$$\n在约束最小值处，$x_{r} = L + O(1)$ 且 $x_{c} = L + O(1)$，所以\n$$\nF_{\\text{lead}} \\;=\\; a\\,\\gamma\\, L^{3} \\;+\\; O(L^{2}).\n$$\n乘以 $N$ 得到领头阶最小总成本\n$$\nC(\\epsilon) \\;=\\; N\\, a\\, \\gamma\\, \\bigl[\\ln(1/\\epsilon)\\bigr]^{3} \\;+\\; O\\!\\bigl(N\\, [\\ln(1/\\epsilon)]^{2}\\bigr).\n$$\n\n总结分配算法及其含义：\n\n- 误差预算驱动的分配：选择任意固定的正常数分数 $\\theta_{q}, \\theta_{c}, \\theta_{r}$ 且 $\\theta_{q} + \\theta_{c} + \\theta_{r} = 1$（例如，$\\theta_{q}=\\theta_{c}=\\theta_{r}=1/3$），并设置\n$$\n\\tau_{q} = \\theta_{q}\\, \\epsilon,\\qquad \\tau_{c} = \\theta_{c}\\, \\epsilon,\\qquad \\tau_{r} = \\theta_{r}\\, \\epsilon.\n$$\n- 参数选择：\n$$\nq \\;=\\; \\frac{1}{\\beta}\\,\\ln\\!\\left(\\frac{A_{q}}{\\theta_{q}\\,\\epsilon}\\right),\\qquad\np \\;=\\; \\frac{1}{\\ln(1/\\rho)}\\,\\ln\\!\\left(\\frac{A_{c}}{\\theta_{c}\\,\\epsilon}\\right),\\qquad\nk \\;=\\; \\gamma \\,\\ln\\!\\left(\\frac{1}{\\theta_{r}\\,\\epsilon}\\right).\n$$\n- 通过此分配，实现的成本满足\n$$\nC(\\epsilon) \\;=\\; N\\, \\frac{c_{f}}{\\ln(1/\\rho)^{2}}\\, \\gamma\\, \\bigl[\\ln(1/\\epsilon)\\bigr]^{3} \\;+\\; O\\!\\bigl(N\\, [\\ln(1/\\epsilon)]^{2}\\bigr),\n$$\n这与 $x_{c}\\ge \\ln(1/\\epsilon)$ 和 $x_{r}\\ge \\ln(1/\\epsilon)$ 所蕴含的下界相匹配：\n$$\nC(\\epsilon) \\;\\ge\\; N\\, \\frac{c_{f}}{\\ln(1/\\rho)^{2}}\\, \\gamma\\, \\bigl[\\ln(1/\\epsilon)\\bigr]^{3}.\n$$\n因此，领头阶最小复杂度唯一地由远场每次迭代的成本系数 $c_{f}$、多极展开收敛因子 $\\rho$ 和迭代对数系数 $\\gamma$ 决定，并且在领头阶上与近场常数无关。\n\n回想 $a = c_{f}/\\ln(1/\\rho)^{2}$，我们得出结论，当 $\\epsilon \\to 0$ 时，领头阶最小复杂度为\n$$\nC(\\epsilon) \\;=\\; N \\,\\frac{c_{f}\\,\\gamma}{\\ln(1/\\rho)^{2}} \\,\\bigl[\\ln(1/\\epsilon)\\bigr]^{3}.\n$$\n这是一个关于 $\\epsilon$ 和给定常数的闭式解析表达式，并且可以通过任何固定比例的误差分配 $\\{\\theta_{q},\\theta_{c},\\theta_{r}\\}$ 来达到，其差异仅在于不影响领头阶行为的低阶项。", "answer": "$$\\boxed{N\\,\\frac{c_{f}\\,\\gamma}{\\ln(1/\\rho)^{2}}\\,\\bigl[\\ln(1/\\epsilon)\\bigr]^{3}}$$", "id": "3294058"}]}