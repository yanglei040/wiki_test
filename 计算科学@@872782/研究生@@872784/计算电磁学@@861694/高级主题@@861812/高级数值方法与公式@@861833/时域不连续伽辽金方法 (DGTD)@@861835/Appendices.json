{"hands_on_practices": [{"introduction": "在间断伽辽金时域（DGTD）方法中，基函数的选择是空间离散化的核心。本练习旨在通过在标准四面体单元上构建一组正交模态基函数，来阐明其关键优势。通过这项实践 [@problem_id:3300621]，您将掌握这些基函数的构造方法，并理解它们如何在线性仿射变换下自然地产生对角质量矩阵，从而为高效的显式时间步进方案奠定基础。", "problem": "考虑在间断伽辽金 (DG) 方法中麦克斯韦方程组的半离散格式，特别是在单个四面体单元上的时域间断伽辽金 (DGTD) 格式。电场的半离散系统涉及一个局部质量矩阵，该矩阵由基函数的体积内积定义。设参考四面体为 $\\widehat{T} = \\{(r,s,t) \\in \\mathbb{R}^{3} : r \\ge 0,\\ s \\ge 0,\\ t \\ge 0,\\ r+s+t \\le 1\\}$，并设 $K$ 是一个通过仿射映射从 $\\widehat{T}$ 得到的物理四面体单元。\n\n您的任务如下：\n\n1) 在 $\\widehat{T}$ 上定义一个总次数最高为 $p$ 的模式多项式基 $\\{\\widehat{\\psi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$，使其关于 $\\widehat{T}$ 上的 $L^{2}$ 内积是标准正交的。使用折叠坐标和雅可比多项式来表示一个通用的基元 $\\widehat{\\psi}_{\\ell m n}(r,s,t)$，并通过一个常数 $N_{\\ell m n}$ 进行归一化，使得\n$$\n\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}(r,s,t)\\,\\widehat{\\psi}_{\\ell' m' n'}(r,s,t)\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}.\n$$\n给出 $\\widehat{\\psi}_{\\ell m n}$ 关于雅可比多项式的符号形式，并明确说明如何选择归一化常数 $N_{\\ell m n}$ 来实现标准正交性。\n\n2) 设物理四面体 $K$ 的顶点为 $(0,0,0)$、$(2,0,0)$、$(0,3,0)$、$(0,0,4)$。考虑仿射映射 $\\Phi : \\widehat{T} \\to K$，由 $(x,y,z) = (2r,\\,3s,\\,4t)$ 给出，并通过 $\\psi_{\\ell m n}(x,y,z) = \\widehat{\\psi}_{\\ell m n}(r,s,t)$（其中 $(r,s,t) = \\Phi^{-1}(x,y,z)$）定义 $K$ 上的拉回模式基。对于体积质量矩阵\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(x,y,z)\\,\\psi_{\\beta}(x,y,z)\\,\\mathrm{d}V,\n$$\n在精确积分下，计算代表性矩阵元 $M_{(0,0,0),(0,0,0)}$ 和 $M_{(1,0,0),(0,0,0)}$。\n\n3) 叙述在何种精确条件下，当使用次数最高为 $p$ 的标准正交模式基并假设为仿射映射时，通过四面体体积分求积法则计算出的离散质量矩阵保持为对角阵。用求积法则相对于 $p$ 所需的多项式精确度来表达您的条件，并证明为什么这些条件能保证对角化。\n\n4) 给出物理单元 $K$ 的 $M_{(0,0,0),(0,0,0)}$ 的值，形式为单个实数。无需四舍五入，也无需单位。", "solution": "用户提供了一个关于四面体单元上时域间断伽辽金 (DGTD) 方法的多部分问题。该问题具有科学依据，是适定且客观的。这是计算电磁学和偏微分方程数值方法领域的标准练习。该问题是有效的。\n\n**1) 参考四面体上的标准正交模式基**\n\n第一个任务是在参考四面体 $\\widehat{T} = \\{(r,s,t) \\in \\mathbb{R}^{3} : r \\ge 0,\\ s \\ge 0,\\ t \\ge 0,\\ r+s+t \\le 1\\}$ 上定义一个标准正交多项式基。一种标准方法是使用折叠坐标和雅可比多项式构造一个正交基，然后将其归一化。\n\n我们从笛卡尔坐标 $(r,s,t) \\in \\widehat{T}$ 定义一组折叠坐标 $(\\xi_1, \\xi_2, \\xi_3) \\in [-1,1]^3$：\n$$\n\\xi_1 = 2\\frac{r}{1-s-t}-1, \\quad \\xi_2 = 2\\frac{s}{1-t}-1, \\quad \\xi_3 = 2t-1.\n$$\n在 $\\widehat{T}$ 上，一个总多项式次数最高为 $p$ 的正交（但尚未标准正交）的模式基 $\\{\\widehat{\\phi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$ 可通过雅可比多项式 $P_k^{(\\alpha,\\beta)}$ 与这些坐标的乘积构造：\n$$\n\\widehat{\\phi}_{\\ell m n}(r,s,t) = P_{\\ell}^{(0,0)}(\\xi_1) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}(\\xi_2) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(\\xi_3).\n$$\n引入包含 $(1-s-t)$ 和 $(1-t)$ 的因子是为了使乘积的三个分量关于 $\\widehat{T}$ 上的标准体积测度正交。\n\n为了找到归一化常数，我们计算这些基函数的 $L^2$ 范数的平方，$h_{\\ell m n}^2 = \\int_{\\widehat{T}} |\\widehat{\\phi}_{\\ell m n}(r,s,t)|^2\\,\\mathrm{d}V$。该积分可以通过使用到 $(\\xi_1, \\xi_2, \\xi_3)$ 的变量替换，进行一系列一维积分来计算。体积元变换为 $\\mathrm{d}r\\,\\mathrm{d}s\\,\\mathrm{d}t = \\frac{(1-t)^2(1-s-t)}{8}\\,\\mathrm{d}\\xi_1\\,\\mathrm{d}\\xi_2\\,\\mathrm{d}\\xi_3$。由于基函数的结构和雅可比多项式的性质，该积分可以分离。范数的平方被求得为：\n$$\nh_{\\ell m n}^2 = \\int_{\\widehat{T}} |\\widehat{\\phi}_{\\ell m n}|^2\\,\\mathrm{d}V = \\frac{1}{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\n然后通过归一化 $\\{\\widehat{\\phi}_{\\ell m n}\\}$ 得到标准正交基 $\\{\\widehat{\\psi}_{\\ell m n}\\}$：\n$$\n\\widehat{\\psi}_{\\ell m n} = \\frac{1}{h_{\\ell m n}} \\widehat{\\phi}_{\\ell m n} = N_{\\ell m n} \\widehat{\\phi}_{\\ell m n}.\n$$\n因此，归一化常数 $N_{\\ell m n}$ 是 $h_{\\ell m n}$ 的倒数：\n$$\nN_{\\ell m n} = \\sqrt{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\n标准正交基函数的最终表达式为：\n$$\n\\widehat{\\psi}_{\\ell m n}(r,s,t) = N_{\\ell m n} \\cdot P_{\\ell}^{(0,0)}\\left(2\\frac{r}{1-s-t}-1\\right) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}\\left(2\\frac{s}{1-t}-1\\right) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(2t-1).\n$$\n该基满足所要求的条件 $\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}\\,\\widehat{\\psi}_{\\ell' m' n'}\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}$。\n\n**2) 物理单元的质量矩阵元**\n\n物理单元 $K$ 上的质量矩阵由 $M_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}\\psi_{\\beta}\\,\\mathrm{d}V$ 给出，其中 $\\alpha=(\\ell,m,n)$ 且 $\\beta=(\\ell',m',n')$。$K$ 上的基函数通过拉回参考基来定义，$\\psi_{\\alpha}(x,y,z) = \\widehat{\\psi}_{\\alpha}(\\Phi^{-1}(x,y,z))$。\n\n仿射映射为 $\\Phi: (r,s,t) \\mapsto (x,y,z) = (2r, 3s, 4t)$。该变换的雅可比矩阵是常数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial r}  \\frac{\\partial x}{\\partial s}  \\frac{\\partial x}{\\partial t} \\\\ \\frac{\\partial y}{\\partial r}  \\frac{\\partial y}{\\partial s}  \\frac{\\partial y}{\\partial t} \\\\ \\frac{\\partial z}{\\partial r}  \\frac{\\partial z}{\\partial s}  \\frac{\\partial z}{\\partial t} \\end{pmatrix} = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  4 \\end{pmatrix}.\n$$\n雅可比行列式为 $|J| = 2 \\cdot 3 \\cdot 4 = 24$。\n使用积分的变量替换公式，质量矩阵元为：\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(\\mathbf{x})\\psi_{\\beta}(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,|J|\\,\\mathrm{d}\\mathbf{r} = |J| \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}.\n$$\n由于基 $\\{\\widehat{\\psi}_{\\alpha}\\}$ 在 $\\widehat{T}$ 上的标准正交性，该积分就是克罗内克 $\\delta$ 函数 $\\delta_{\\alpha\\beta}$：\n$$\nM_{\\alpha\\beta} = |J|\\,\\delta_{\\alpha\\beta} = 24\\,\\delta_{\\ell\\ell'}\\,\\delta_{mm'}\\,\\delta_{nn'}.\n$$\n这表明对于仿射映射，质量矩阵是对角阵，每个对角元等于常数雅可比行列式 $|J|$。\n\n我们现在可以计算所要求的矩阵元：\n- 对于 $\\alpha = \\beta = (0,0,0)$：\n$$M_{(0,0,0),(0,0,0)} = 24\\,\\delta_{00}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 1 \\cdot 1 \\cdot 1 = 24。$$\n- 对于 $\\alpha = (1,0,0)$ 和 $\\beta = (0,0,0)$：\n$$M_{(1,0,0),(0,0,0)} = 24\\,\\delta_{10}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 0 \\cdot 1 \\cdot 1 = 0。$$\n\n**3) 基于求积的质量矩阵为对角阵的条件**\n\n离散质量矩阵 $M^h$ 是使用物理单元 $K$ 上的数值求积法则组装的。其矩阵元为 $M^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} w_q \\psi_{\\alpha}(x_q)\\psi_{\\beta}(x_q)$，其中 $(x_q, w_q)$ 是 $K$ 上的求积点和权重。\n\n为了分析这个问题，我们将求积变换到参考单元 $\\widehat{T}$。设 $(\\widehat{x}_q, \\widehat{w}_q)$ 为 $\\widehat{T}$ 上的求积法则。对于仿射映射 $\\Phi$，$K$ 上对应的法则是 $x_q = \\Phi(\\widehat{x}_q)$ 和 $w_q = |J|\\widehat{w}_q$。离散质量矩阵元变为：\n$$\nM^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} (|J|\\widehat{w}_q) \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = |J| \\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q).\n$$\n要使该矩阵为对角阵，我们需要 $M^h_{\\alpha\\beta} = C \\delta_{\\alpha\\beta}$，其中 $C$ 为某个常数。与精确质量矩阵 $M_{\\alpha\\beta} = |J|\\delta_{\\alpha\\beta}$ 比较，我们发现必须有：\n$$\n\\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = \\delta_{\\alpha\\beta}.\n$$\n这意味着参考单元上的求积法则必须能精确积分任意两个次数最高为 $p$ 的基函数 $\\widehat{\\psi}_{\\alpha}$ 和 $\\widehat{\\psi}_{\\beta}$ 的乘积。\n\n基函数 $\\widehat{\\psi}_{\\alpha} = \\widehat{\\psi}_{\\ell m n}$ 是一个总次数为 $\\ell+m+n$ 的多项式。由于 $\\ell+m+n \\le p$，$\\widehat{\\psi}_{\\alpha}$ 的次数最多为 $p$。因此，乘积 $\\widehat{\\psi}_{\\alpha}\\widehat{\\psi}_{\\beta}$ 是一个次数最多为 $p+p=2p$ 的多项式。\n\n因此，要使求积保持质量矩阵的对角性，其条件是参考四面体上的求积法则必须对所有总次数最高为 $2p$ 的多项式都是精确的。对于仿射映射，常数雅可比行列式不会增加所需的多项式次数。\n\n**4) $M_{(0,0,0),(0,0,0)}$ 的值**\n\n如第 2 部分所计算，该质量矩阵元的值为 24。\n\n这也可以直接验证。基函数 $\\widehat{\\psi}_{000}$ 是一个常数。根据第 1 部分，$N_{000} = \\sqrt{(1) \\cdot 2(1) \\cdot (3)} = \\sqrt{6}$。由于 $P_0=1$，$\\widehat{\\phi}_{000}=1$，所以 $\\widehat{\\psi}_{000} = \\sqrt{6}$。因此，在 $K$ 上 $\\psi_{000}(x,y,z) = \\sqrt{6}$。该矩阵元是：\n$$M_{(0,0,0),(0,0,0)} = \\int_K (\\sqrt{6})^2\\,\\mathrm{d}V = 6 \\int_K \\mathrm{d}V = 6 \\cdot \\text{Volume}(K)。$$\n顶点为 $(0,0,0)$、$(2,0,0)$、$(0,3,0)$、$(0,0,4)$ 的四面体 $K$ 的体积是\n$$\\text{Volume}(K) = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  4 \\end{pmatrix} \\right| = \\frac{24}{6} = 4。$$\n因此，$M_{(0,0,0),(0,0,0)} = 6 \\cdot 4 = 24$。", "answer": "$$\\boxed{24}$$", "id": "3300621"}, {"introduction": "实际的电磁问题往往涉及复杂的几何形状，需要使用弯曲单元进行精确建模。本练习 [@problem_id:3300567] 将引导您处理由等参映射引起的几何复杂性，这在将积分从物理空间转换到参考单元时是必不可少的。您将推导并应用包括雅可比矩阵和度量张量在内的几何因子，特别是通过协变 Piola 变换来正确处理矢量场，这是高级 DGTD 建模的一项关键技能。", "problem": "考虑以旋度形式写成的三维无源麦克斯韦方程组作为基本定律，以及标准的时域 (TD) 不连续伽辽金 (DG) 半离散格式，该格式产生单元体积质量和旋度-旋度刚度双线性形式。设计算单元为单个曲边六面体，它通过从参考立方体 $[\\xi,\\eta,\\zeta] \\in [-1,1]^3$ 到物理坐标 $[x,y,z] \\in \\mathbb{R}^3$ 的等参映射得到，定义为\n$$\nx(\\xi,\\eta,\\zeta) = a\\,\\xi + \\alpha\\,\\xi\\,\\eta,\\quad\ny(\\xi,\\eta,\\zeta) = b\\,\\eta,\\quad\nz(\\xi,\\eta,\\zeta) = c\\,\\zeta,\n$$\n其中 $a0$、$b0$、$c0$ 和 $0  \\alpha  a$。假设介电常数 $\\varepsilon$ 和磁导率 $\\mu$ 均为单位 1。计算当试探/检验函数为 $\\mathbf{v} = (0, 1, 0)$ 时，旋度-旋度刚度矩阵的对角元。", "solution": "该问题要求计算当试探/检验函数为常数向量场 $\\mathbf{v} = (0, 1, 0)$ 时，单个曲边六面体单元上旋度-旋度刚度矩阵的对角元。该矩阵元由积分 $S = \\int_K (\\nabla \\times \\mathbf{v}) \\cdot (\\nabla \\times \\mathbf{v}) \\, dV$ 给出。\n\n为了计算该积分，我们必须将其转换到参考单元 $\\hat{K} = [-1,1]^3$ 上。对于 $\\mathbf{H}(\\mathrm{curl})$ 空间中的矢量场，正确的变换法则是使用协变 Piola 变换。物理场 $\\mathbf{v}$ 与其在参考坐标系下的对应场（或称“拉回”，pullback）$\\hat{\\mathbf{v}}$ 之间的关系为 $\\hat{\\mathbf{v}} = J^T \\mathbf{v}$，其中 $J$ 是坐标变换的雅可比矩阵。\n\n旋度-旋度积分的变换公式为：\n$$\n\\int_K (\\nabla \\times \\mathbf{v}) \\cdot (\\nabla \\times \\mathbf{v}) \\, dV = \\int_{\\hat{K}} (\\hat{\\nabla} \\times \\hat{\\mathbf{v}})^T G^{-1} (\\hat{\\nabla} \\times \\hat{\\mathbf{v}}) \\, \\det(J) \\, d\\hat{V}\n$$\n其中 $G = J^T J$ 是度量张量，$\\hat{\\nabla} \\times$ 是参考坐标系下的旋度算子。\n\n1.  **计算雅可比矩阵 $J$ 及其转置 $J^T$**\n    给定的映射为 $x = a\\xi + \\alpha\\xi\\eta$, $y = b\\eta$, $z=c\\zeta$。雅可比矩阵为：\n    $$\n    J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} = \\begin{pmatrix} a+\\alpha\\eta  \\alpha\\xi  0 \\\\ 0  b  0 \\\\ 0  0  c \\end{pmatrix}\n    $$\n    其转置为：\n    $$\n    J^T = \\begin{pmatrix} a+\\alpha\\eta  0  0 \\\\ \\alpha\\xi  b  0 \\\\ 0  0  c \\end{pmatrix}\n    $$\n\n2.  **计算拉回向量 $\\hat{\\mathbf{v}}$ 及其旋度**\n    我们将物理场 $\\mathbf{v} = (0,1,0)^T$ 拉回到参考单元：\n    $$\n    \\hat{\\mathbf{v}} = J^T \\mathbf{v} = \\begin{pmatrix} a+\\alpha\\eta  0  0 \\\\ \\alpha\\xi  b  0 \\\\ 0  0  c \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha\\xi \\\\ b \\\\ 0 \\end{pmatrix}\n    $$\n    现在，我们计算 $\\hat{\\mathbf{v}}$ 在参考坐标 $(\\xi, \\eta, \\zeta)$ 下的旋度：\n    $$\n    \\hat{\\nabla} \\times \\hat{\\mathbf{v}} = \\begin{pmatrix} \\partial_\\eta(0) - \\partial_\\zeta(b) \\\\ \\partial_\\zeta(\\alpha\\xi) - \\partial_\\xi(0) \\\\ \\partial_\\xi(b) - \\partial_\\eta(\\alpha\\xi) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -\\alpha \\end{pmatrix}\n    $$\n\n3.  **计算所需的分量 $G^{-1}$ 和 $\\det(J)$**\n    我们需要 $(G^{-1})_{33}$。由于 $G = J^T J$ 是块对角的，其逆 $G^{-1}$ 也是块对角的。我们只需要考虑右下角的 $1 \\times 1$ 块。\n    $$\n    G = \\begin{pmatrix} (a+\\alpha\\eta)^2 + (\\alpha\\xi)^2  \\alpha b \\xi  0 \\\\ \\alpha b \\xi  b^2  0 \\\\ 0  0  c^2 \\end{pmatrix}\n    $$\n    因此，$G_{33} = c^2$，从而 $(G^{-1})_{33} = 1/c^2$。\n    雅可比行列式为：\n    $$\n    \\det(J) = (a+\\alpha\\eta)bc\n    $$\n\n4.  **计算积分**\n    我们将所有部分组合起来。令 $\\mathbf{w} = \\hat{\\nabla} \\times \\hat{\\mathbf{v}} = (0,0,-\\alpha)^T$。被积函数为：\n    $$\n    \\mathbf{w}^T G^{-1} \\mathbf{w} \\det(J) = \\alpha^2 (G^{-1})_{33} \\det(J) = \\alpha^2 \\cdot \\frac{1}{c^2} \\cdot (a+\\alpha\\eta)bc = \\frac{\\alpha^2 b}{c} (a+\\alpha\\eta)\n    $$\n    现在，我们在参考立方体 $[-1,1]^3$ 上对该函数进行积分：\n    $$\n    S = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{\\alpha^2 b}{c} (a+\\alpha\\eta) \\, d\\xi \\, d\\eta \\, d\\zeta\n    $$\n    $$\n    S = \\frac{\\alpha^2 b}{c} \\left( \\int_{-1}^{1} d\\zeta \\right) \\left( \\int_{-1}^{1} d\\xi \\right) \\left( \\int_{-1}^{1} (a+\\alpha\\eta) \\, d\\eta \\right)\n    $$\n    $$\n    S = \\frac{\\alpha^2 b}{c} \\cdot (2) \\cdot (2) \\cdot \\left[ a\\eta + \\frac{\\alpha\\eta^2}{2} \\right]_{-1}^{1}\n    $$\n    $$\n    S = \\frac{4\\alpha^2 b}{c} \\left( \\left(a + \\frac{\\alpha}{2}\\right) - \\left(-a + \\frac{\\alpha}{2}\\right) \\right) = \\frac{4\\alpha^2 b}{c} (2a) = \\frac{8ab\\alpha^2}{c}\n    $$\n    因此，刚度矩阵元的值为 $\\frac{8ab\\alpha^2}{c}$。", "answer": "$$\\boxed{\\frac{8ab\\alpha^2}{c}}$$", "id": "3300567"}]}