{"hands_on_practices": [{"introduction": "理论学习的最佳方式是付诸实践。本章节提供了一系列精心设计的动手实践，旨在将电磁-热耦合的抽象概念转化为具体的计算技能。我们将从一个基础的解析问题入手，逐步过渡到复杂的数值模拟的实现与验证，从而全面提升您解决多物理场问题的能力。\n\n我们的第一个实践任务是建立一个连接电磁加热与经典传热理论的解析模型。在许多高频应用中，电磁能量被高度耗损的材料迅速吸收，其效应可以精确地近似为施加在材料表面的一个热通量。这项练习将指导您推导在此简化模型下一个半无限固体的表面温度随时间变化的解析解，从而帮助您深入理解热扩散过程及其特征时间尺度。[@problem_id:3304774]", "problem": "一个半无限有损介质占据 $x>0$ 的空间，其初始温度均匀为 $T(x,0)=T_{0}$。在 $t=0$ 时刻，一个固定振幅的高频电磁波被开启，并在 $t>0$ 的时间内保持。由于在 $x=0$ 附近一个很浅的电磁衰减深度 $\\ell_{\\mathrm{em}}$ 内存在强吸收，在早期到中期的时间内，电磁能量的沉积可以被建模为一个有效的阶跃表面热通量（单位面积）\n$$q''(t)=Q_{0} H(t),$$\n其中 $Q_{0}>0$ 是一个常数，$H(t)$ 是 Heaviside 单位阶跃函数。忽略边界上的对流和辐射损失，并假设以下热物理性质为常数：密度 $\\rho$、比热容 $c$ 和热导率 $k$。令热扩散率为 $\\alpha=k/(\\rho c)$。\n\n从一维热方程和适当的边界及初始条件出发，推导 $t>0$ 时表面温度演化 $T_{s}(t)=T(0,t)$ 的闭式表达式。然后，通过检验你的解，确定一个特征热扩散时间尺度 $t_{\\mathrm{th}}$（用 $\\alpha$ 和给定的电磁衰减深度 $\\ell_{\\mathrm{em}}$ 表示），该时间尺度量化了热量扩散到电磁吸收区域之外的时间。\n\n说明：\n- 使用 $x>0$ 区域内的一维热方程，并构建由 $q''(t)=Q_{0}H(t)$ 所蕴含的在 $x=0$ 处的边界条件。\n- 用 $T_{0}$、$Q_{0}$、$k$、$\\alpha$ 和 $t$ 表示 $T_{s}(t)$。\n- 通过要求解中出现的热扩散深度与电磁衰减深度 $\\ell_{\\mathrm{em}}$ 相当来定义 $t_{\\mathrm{th}}$。\n- 以开尔文为单位表示最终表面温度 $T_{s}(t)$。\n- 无需数值计算；仅提供精确的解析表达式。\n\n仅报告 $T_{s}(t)$ 的表达式作为你的最终答案。", "solution": "所述问题构成了传热学领域中一个适定的初边值问题。该问题具有科学依据、内容完备且客观。因此，我们可以着手推导其解。\n\n该物理系统是一个半无限固体（$x>0$），由一维热方程控制：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}, \\quad \\text{for } x>0, t>0\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha = k/(\\rho c)$ 是热扩散率。\n\n初始条件为均匀温度 $T_0$：\n$$\nT(x,0) = T_0, \\quad \\text{for } x>0\n$$\n\n边界条件为：\n1. 在 $t>0$ 时，一个恒定的热通量 $Q_0$ 施加在表面 $x=0$ 处。这是一个 Neumann 边界条件，由 Fourier 热传导定律 $q'' = -k \\frac{\\partial T}{\\partial x}$ 导出。\n$$\n-k \\frac{\\partial T}{\\partial x}(0, t) = Q_0, \\quad \\text{for } t>0\n$$\n2. 远离表面处，温度保持为其初始值，不受扰动。\n$$\n\\lim_{x \\to \\infty} T(x,t) = T_0, \\quad \\text{for } t>0\n$$\n\n为简化问题，我们引入一个超温变量 $\\theta(x,t) = T(x,t) - T_0$。该问题可以用 $\\theta(x,t)$ 重写为：\n偏微分方程（PDE）：$\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2}$\n初始条件（IC）：$\\theta(x,0) = 0$\n边界条件1（BC1）：$-k \\frac{\\partial \\theta}{\\partial x}(0, t) = Q_0$\n边界条件2（BC2）：$\\lim_{x \\to \\infty} \\theta(x,t) = 0$\n\n这个偏微分方程可以使用拉普拉斯变换法求解。令 $\\bar{\\theta}(x,s) = \\mathcal{L}\\{\\theta(x,t)\\} = \\int_0^\\infty \\theta(x,t) \\exp(-st) dt$。对偏微分方程进行拉普拉斯变换，得到一个关于 $x$ 的常微分方程（ODE）：\n$$\ns\\bar{\\theta}(x,s) - \\theta(x,0) = \\alpha \\frac{d^2\\bar{\\theta}}{dx^2}\n$$\n使用初始条件 $\\theta(x,0)=0$，我们得到：\n$$\n\\frac{d^2\\bar{\\theta}}{dx^2} - \\frac{s}{\\alpha}\\bar{\\theta} = 0\n$$\n这个常微分方程的通解是：\n$$\n\\bar{\\theta}(x,s) = C_1 \\exp\\left(\\sqrt{\\frac{s}{\\alpha}}x\\right) + C_2 \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)\n$$\n变换后的边界条件是：\nBC1: $-k \\frac{d\\bar{\\theta}}{dx}(0,s) = \\mathcal{L}\\{Q_0\\} = \\frac{Q_0}{s}$\nBC2: $\\lim_{x \\to \\infty} \\bar{\\theta}(x,s) = 0$\n\n为满足边界条件2，系数 $C_1$ 必须为零，因为当 $x \\to \\infty$ 时，对于 $\\text{Re}(s)>0$，$\\exp(\\sqrt{s/\\alpha}x)$ 是无界的。因此，解的形式为：\n$$\n\\bar{\\theta}(x,s) = C_2 \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)\n$$\n为了求得 $C_2$，我们应用边界条件1。首先，我们计算关于 $x$ 的导数：\n$$\n\\frac{d\\bar{\\theta}}{dx}(x,s) = -C_2 \\sqrt{\\frac{s}{\\alpha}} \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)\n$$\n在 $x=0$ 处：\n$$\n\\frac{d\\bar{\\theta}}{dx}(0,s) = -C_2 \\sqrt{\\frac{s}{\\alpha}}\n$$\n将此代入变换后的边界条件1：\n$$\n-k \\left(-C_2 \\sqrt{\\frac{s}{\\alpha}}\\right) = \\frac{Q_0}{s}\n$$\n$$\nk C_2 \\sqrt{\\frac{s}{\\alpha}} = \\frac{Q_0}{s}\n$$\n求解 $C_2$：\n$$\nC_2 = \\frac{Q_0}{k s \\sqrt{s/\\alpha}} = \\frac{Q_0 \\sqrt{\\alpha}}{k s^{3/2}}\n$$\n因此，在拉普拉斯域中温度的解为：\n$$\n\\bar{\\theta}(x,s) = \\frac{Q_0 \\sqrt{\\alpha}}{k s^{3/2}} \\exp\\left(-\\sqrt{\\frac{s}{\\alpha}}x\\right)\n$$\n问题要求解表面温度 $T_s(t) = T(0,t)$，这对应于 $\\theta_s(t) = \\theta(0,t)$。我们通过令 $x=0$ 来找到其拉普拉斯变换：\n$$\n\\bar{\\theta}_s(s) = \\bar{\\theta}(0,s) = \\frac{Q_0 \\sqrt{\\alpha}}{k s^{3/2}}\n$$\n为了求得 $\\theta_s(t)$，我们必须计算 $\\bar{\\theta}_s(s)$ 的拉普拉斯逆变换。我们使用标准的拉普拉斯变换对：\n$$\n\\mathcal{L}\\{t^n\\} = \\frac{\\Gamma(n+1)}{s^{n+1}} \\implies \\mathcal{L}^{-1}\\left\\{\\frac{1}{s^{n+1}}\\right\\} = \\frac{t^n}{\\Gamma(n+1)}\n$$\n在我们的情况中，$n+1 = 3/2$，即 $n=1/2$。伽马函数的值为 $\\Gamma(3/2) = (1/2)\\Gamma(1/2) = \\sqrt{\\pi}/2$。\n因此：\n$$\n\\mathcal{L}^{-1}\\left\\{\\frac{1}{s^{3/2}}\\right\\} = \\frac{t^{1/2}}{\\Gamma(3/2)} = \\frac{\\sqrt{t}}{\\sqrt{\\pi}/2} = \\frac{2\\sqrt{t}}{\\sqrt{\\pi}}\n$$\n将此应用于我们关于 $\\bar{\\theta}_s(s)$ 的表达式：\n$$\n\\theta_s(t) = \\mathcal{L}^{-1}\\left\\{\\frac{Q_0 \\sqrt{\\alpha}}{k s^{3/2}}\\right\\} = \\frac{Q_0 \\sqrt{\\alpha}}{k} \\mathcal{L}^{-1}\\left\\{\\frac{1}{s^{3/2}}\\right\\} = \\frac{Q_0 \\sqrt{\\alpha}}{k} \\frac{2\\sqrt{t}}{\\sqrt{\\pi}}\n$$\n$$\n\\theta_s(t) = \\frac{2Q_0}{k} \\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n最后，我们使用 $T_s(t) = T_0 + \\theta_s(t)$ 将其转换回物理温度 $T_s(t)$：\n$$\nT_s(t) = T_0 + \\frac{2Q_0}{k} \\sqrt{\\frac{\\alpha t}{\\pi}}\n$$\n这就是表面温度演化的闭式表达式。\n\n关于问题的第二部分，可以通过考察解的物理意义来确定特征热扩散时间尺度 $t_{\\mathrm{th}}$。完整的解 $T(x,t)$（不仅仅是表面温度）表明，热量向介质中扩散的特征长度尺度为 $\\delta_{\\mathrm{th}} \\sim \\sqrt{\\alpha t}$。这可以从完整解 $\\theta(x,t)$ 中出现的指数函数和误差函数的自变量中看出。问题要求的是当该热扩散深度与电磁衰减深度 $\\ell_{\\mathrm{em}}$ 相当的时间 $t_{\\mathrm{th}}$。通过设定 $\\delta_{\\mathrm{th}}(t_{\\mathrm{th}}) \\approx \\ell_{\\mathrm{em}}$，我们得到：\n$$\n\\sqrt{\\alpha t_{\\mathrm{th}}} \\sim \\ell_{\\mathrm{em}} \\implies t_{\\mathrm{th}} \\sim \\frac{\\ell_{\\mathrm{em}}^2}{\\alpha}\n$$\n该时间尺度代表了从热量被限制在电磁吸收层内的状态到热量已显著扩散到其外的状态的过渡。然而，题目要求的最终答案仅为 $T_s(t)$ 的表达式。", "answer": "$$\\boxed{T_0 + \\frac{2Q_0}{k}\\sqrt{\\frac{\\alpha t}{\\pi}}}$$", "id": "3304774"}, {"introduction": "在实际工程问题中，材料的电磁特性（如电导率 $\\sigma$ 和介电常数 $\\varepsilon$）往往随温度显著变化，这导致了电磁场与温度场之间的双向非线性耦合。解决这类问题通常需要采用迭代数值方法。本实践将引导您为一个集总参数模型构建一个不动点迭代求解器，以寻找一个自洽的稳态温度解，这代表了微波加热等应用中一个核心的计算任务。[@problem_id:3304789]", "problem": "给定一个简化的、但有物理基础的电磁-热耦合模型，用于描述一个在驱动的平行板谐振器内被微波加热的聚合物样本。目标是构建一个计算程序，该程序迭代更新电磁场和温度，直至达到稳态收敛，并使用基于能量残差范数的停止准则。该问题必须使用以下基本原理来解决。\n\n从麦克斯韦方程组的频域公式、材料本构关系和能量守恒定律出发，考虑正弦稳态驱动：\n- 在角频率为 $\\omega$ 的时谐电场 $\\mathbf{E}$ 作用下，线性、各向同性、有损介电材料中的时间平均体积电磁耗散密度由下式给出：\n$$\np_{\\mathrm{loss}}(T) = \\tfrac{1}{2}\\left(\\sigma(T) + \\omega \\varepsilon_0 \\epsilon''(T)\\right)\\left\\lVert \\mathbf{E}\\right\\rVert^2,\n$$\n其中 $\\sigma(T)$ 是电导率，$\\epsilon''(T)$ 是相对介电常数的虚部，$\\varepsilon_0$ 是真空介电常数。\n- 样本填充了一个极板面积为 $A$、极板间距为 $d$ 的平行板电容器的间隙，因此电容为 $C = \\varepsilon_0 \\varepsilon' A / d$，其中 $\\varepsilon'$ 是相对介电常数的实部，假定其不随温度变化。介电损耗可以表示为一个等效电导：\n$$\nG_{\\mathrm{d}}(T) = \\omega \\varepsilon_0 \\frac{A}{d}\\,\\epsilon''(T) + \\frac{A}{d}\\,\\sigma(T),\n$$\n因此，介电体积中吸收的平均电磁功率为 $P_{\\mathrm{abs}}(T) = \\tfrac{1}{2} V^2 G_{\\mathrm{d}}(T)$，其中 $V$ 是电容器两端的均方根电压。\n- 谐振器由指定的平均输入功率 $P_{\\mathrm{in}}$ 驱动，并具有由寄生电导 $G_{\\mathrm{c}}$ 表示的额外的不随温度变化的损耗。在稳态正弦运行下，谐振器中的功率平衡为：\n$$\nP_{\\mathrm{in}} = \\tfrac{1}{2} V^2 \\left(G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)\\right),\n$$\n因此，场幅值和吸收功率通过 $G_{\\mathrm{d}}(T)$ 依赖于 $T$。消去 $V$ 以获得作为温度函数的吸收功率：\n$$\nP_{\\mathrm{abs}}(T) = P_{\\mathrm{in}}\\,\\frac{G_{\\mathrm{d}}(T)}{G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)}.\n$$\n- 集总样本的热稳态能量平衡将吸收的功率等同于对流热损失：\n$$\nP_{\\mathrm{abs}}(T) - h S \\left(T - T_{\\mathrm{amb}}\\right) = 0,\n$$\n其中 $h$ 是对流传热系数， $S$ 是对流表面积， $T_{\\mathrm{amb}}$ 是环境温度。\n\n将温度迭代 $T$ 处的能量残差定义为：\n$$\nr(T) = P_{\\mathrm{abs}}(T) - h S \\left(T - T_{\\mathrm{amb}}\\right).\n$$\n构建一个在电磁更新和热更新之间交替进行的不动点迭代过程，使用以下映射关系：\n$$\nT_{\\mathrm{new}} \\leftarrow T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T_{\\mathrm{old}})}{h S},\n$$\n可选择使用欠松弛。使用基于能量残差范数的停止准则：\n$$\n\\frac{\\left|r(T)\\right|}{P_{\\mathrm{in}}} \\le \\tau,\n$$\n其中 $\\tau$ 是一个预设的容差。最终温度必须以开尔文为单位报告。\n\n所有计算必须在国际单位制（SI）中进行。角度（如有）必须以弧度为单位。唯一需要的输出是收敛的稳态温度，以开尔文为单位，四舍五入到三位小数。\n\n测试套件和参数：\n- 所有案例的通用常数：\n  - 真空介电常数：$\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n  - 频率：$f = 2.45\\times 10^{9}\\,\\mathrm{Hz}$；角频率 $\\omega = 2\\pi f$。\n  - 相对介电常数的实部：$\\varepsilon' = 2.5$。\n  - 极板面积：$A = 1.0\\times 10^{-2}\\,\\mathrm{m}^2$。\n  - 极板间距：$d = 1.0\\times 10^{-2}\\,\\mathrm{m}$。\n  - 对流表面积：$S = 2A$。\n  - 环境温度：$T_{\\mathrm{amb}} = 293.15\\,\\mathrm{K}$。\n  - 温度迭代的初始猜测值：$T_0 = T_{\\mathrm{amb}}$。\n  - 收敛容差：$\\tau = 1.0\\times 10^{-8}$。\n  - 最大迭代次数：$N_{\\max} = 100000$。\n- 每个案例的测量属性模型以关于 $(T - T_{\\mathrm{ref}})$ 的多项式形式给出，作为温度相关函数 $\\sigma(T)$ 和 $\\epsilon''(T)$，其中 $T_{\\mathrm{ref}} = 293.15\\,\\mathrm{K}$。具体使用：\n  - $\\sigma(T) = a_0 + a_1\\,(T - T_{\\mathrm{ref}}) + a_2\\,(T - T_{\\mathrm{ref}})^2$，单位为 $\\mathrm{S/m}$。\n  - $\\epsilon''(T) = b_0 + b_1\\,(T - T_{\\mathrm{ref}}) + b_2\\,(T - T_{\\mathrm{ref}})^2$（无量纲）。\n- 测试案例：\n  1. 案例 A（中等、随温度增加的损耗）：\n     - 输入功率：$P_{\\mathrm{in}} = 200\\,\\mathrm{W}$。\n     - 寄生电导：$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$。\n     - 对流系数：$h = 20\\,\\mathrm{W/(m^2\\,K)}$。\n     - $\\sigma(T)$ 系数：$a_0 = 5.0\\times 10^{-5}$，$a_1 = 5.0\\times 10^{-7}$，$a_2 = 0$。\n     - $\\epsilon''(T)$ 系数：$b_0 = 2.0\\times 10^{-2}$，$b_1 = 1.5\\times 10^{-4}$，$b_2 = 0$。\n  2. 案例 B（极低损耗和低输入功率）：\n     - 输入功率：$P_{\\mathrm{in}} = 10\\,\\mathrm{W}$。\n     - 寄生电导：$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$。\n     - 对流系数：$h = 10\\,\\mathrm{W/(m^2\\,K)}$。\n     - $\\sigma(T)$ 系数：$a_0 = 1.0\\times 10^{-6}$，$a_1 = 1.0\\times 10^{-8}$，$a_2 = 0$。\n     - $\\epsilon''(T)$ 系数：$b_0 = 5.0\\times 10^{-3}$，$b_1 = 2.0\\times 10^{-5}$，$b_2 = 0$。\n  3. 案例 C（较高输入功率且寄生损耗占主导）：\n     - 输入功率：$P_{\\mathrm{in}} = 500\\,\\mathrm{W}$。\n     - 寄生电导：$G_{\\mathrm{c}} = 2.0\\times 10^{-2}\\,\\mathrm{S}$。\n     - 对流系数：$h = 20\\,\\mathrm{W/(m^2\\,K)}$。\n     - $\\sigma(T)$ 系数：$a_0 = 2.0\\times 10^{-4}$，$a_1 = 2.0\\times 10^{-7}$，$a_2 = 0$。\n     - $\\epsilon''(T)$ 系数：$b_0 = 3.0\\times 10^{-2}$，$b_1 = 1.0\\times 10^{-4}$，$b_2 = 0$。\n  4. 案例 D（恒定损耗与强对流）：\n     - 输入功率：$P_{\\mathrm{in}} = 200\\,\\mathrm{W}$。\n     - 寄生电导：$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$。\n     - 对流系数：$h = 100\\,\\mathrm{W/(m^2\\,K)}$。\n     - $\\sigma(T)$ 系数：$a_0 = 5.0\\times 10^{-5}$，$a_1 = 0$，$a_2 = 0$。\n     - $\\epsilon''(T)$ 系数：$b_0 = 2.0\\times 10^{-2}$，$b_1 = 0$，$b_2 = 0$。\n\n要实现的任务：\n- 对于每个测试案例，按照指定的多项式实现 $\\sigma(T)$ 和 $\\epsilon''(T)$。\n- 使用 $G_{\\mathrm{d}}(T) = \\omega \\varepsilon_0 \\frac{A}{d}\\,\\epsilon''(T) + \\frac{A}{d}\\,\\sigma(T)$ 实现 $G_{\\mathrm{d}}(T)$。\n- 实现 $P_{\\mathrm{abs}}(T) = P_{\\mathrm{in}}\\,\\frac{G_{\\mathrm{d}}(T)}{G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)}$。\n- 使用不动点映射 $T_{\\mathrm{new}} \\leftarrow T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T_{\\mathrm{old}})}{h S}$ 迭代更新 $T$，直到归一化残差 $\\left|r(T)\\right|/P_{\\mathrm{in}} \\le \\tau$，其中 $r(T) = P_{\\mathrm{abs}}(T) - h S \\left(T - T_{\\mathrm{amb}}\\right)$。如果需要，使用欠松弛以确保收敛，但停止准则必须仅为残差范数。\n- 报告四个案例的最终收敛稳态温度，单位为开尔文。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[T_A,T_B,T_C,T_D]$，其中每个 $T_\\cdot$ 是收敛的稳态温度，单位为 $\\mathrm{K}$，四舍五入到三位小数。", "solution": "用户希望解决一个电磁-热耦合问题，以找到由微波加热的聚合物样本的稳态温度。\n\n### 步骤 1：提取已知条件\n\n-   **控制方程：**\n    -   时间平均体积电磁耗散密度：$p_{\\mathrm{loss}}(T) = \\tfrac{1}{2}\\left(\\sigma(T) + \\omega \\varepsilon_0 \\epsilon''(T)\\right)\\left\\lVert \\mathbf{E}\\right\\rVert^2$。\n    -   等效介电电导：$G_{\\mathrm{d}}(T) = \\omega \\varepsilon_0 \\frac{A}{d}\\,\\epsilon''(T) + \\frac{A}{d}\\,\\sigma(T)$。\n    -   谐振器功率平衡：$P_{\\mathrm{in}} = \\tfrac{1}{2} V^2 \\left(G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)\\right)$。\n    -   介电材料中吸收的功率：$P_{\\mathrm{abs}}(T) = P_{\\mathrm{in}}\\,\\frac{G_{\\mathrm{d}}(T)}{G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)}$。\n    -   热稳态能量平衡：$P_{\\mathrm{abs}}(T) - h S \\left(T - T_{\\mathrm{amb}}\\right) = 0$。\n\n-   **迭代过程和停止准则：**\n    -   能量残差：$r(T) = P_{\\mathrm{abs}}(T) - h S \\left(T - T_{\\mathrm{amb}}\\right)$。\n    -   不动点迭代映射：$T_{\\mathrm{new}} \\leftarrow T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T_{\\mathrm{old}})}{h S}$。\n    -   停止准则：$\\frac{\\left|r(T)\\right|}{P_{\\mathrm{in}}} \\le \\tau$。\n\n-   **材料属性模型：**\n    -   电导率：$\\sigma(T) = a_0 + a_1\\,(T - T_{\\mathrm{ref}}) + a_2\\,(T - T_{\\mathrm{ref}})^2$。\n    -   相对介电常数的虚部：$\\epsilon''(T) = b_0 + b_1\\,(T - T_{\\mathrm{ref}}) + b_2\\,(T - T_{\\mathrm{ref}})^2$。\n    -   多项式的参考温度：$T_{\\mathrm{ref}} = 293.15\\,\\mathrm{K}$。\n\n-   **通用常数和参数：**\n    -   真空介电常数：$\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n    -   频率：$f = 2.45\\times 10^{9}\\,\\mathrm{Hz}$。\n    -   角频率：$\\omega = 2\\pi f$。\n    -   相对介电常数的实部：$\\varepsilon' = 2.5$。\n    -   极板面积：$A = 1.0\\times 10^{-2}\\,\\mathrm{m}^2$。\n    -   极板间距：$d = 1.0\\times 10^{-2}\\,\\mathrm{m}$。\n    -   对流表面积：$S = 2A$。\n    -   环境温度：$T_{\\mathrm{amb}} = 293.15\\,\\mathrm{K}$。\n    -   温度的初始猜测值：$T_0 = T_{\\mathrm{amb}}$。\n    -   收敛容差：$\\tau = 1.0\\times 10^{-8}$。\n    -   最大迭代次数：$N_{\\max} = 100000$。\n\n-   **测试案例 A：**\n    -   $P_{\\mathrm{in}} = 200\\,\\mathrm{W}$，$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$，$h = 20\\,\\mathrm{W/(m^2\\,K)}$。\n    -   $\\sigma(T)$ 系数：$a_0 = 5.0\\times 10^{-5}$，$a_1 = 5.0\\times 10^{-7}$，$a_2 = 0$。\n    -   $\\epsilon''(T)$ 系数：$b_0 = 2.0\\times 10^{-2}$，$b_1 = 1.5\\times 10^{-4}$，$b_2 = 0$。\n\n-   **测试案例 B：**\n    -   $P_{\\mathrm{in}} = 10\\,\\mathrm{W}$，$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$，$h = 10\\,\\mathrm{W/(m^2\\,K)}$。\n    -   $\\sigma(T)$ 系数：$a_0 = 1.0\\times 10^{-6}$，$a_1 = 1.0\\times 10^{-8}$，$a_2 = 0$。\n    -   $\\epsilon''(T)$ 系数：$b_0 = 5.0\\times 10^{-3}$，$b_1 = 2.0\\times 10^{-5}$，$b_2 = 0$。\n\n-   **测试案例 C：**\n    -   $P_{\\mathrm{in}} = 500\\,\\mathrm{W}$，$G_{\\mathrm{c}} = 2.0\\times 10^{-2}\\,\\mathrm{S}$，$h = 20\\,\\mathrm{W/(m^2\\,K)}$。\n    -   $\\sigma(T)$ 系数：$a_0 = 2.0\\times 10^{-4}$，$a_1 = 2.0\\times 10^{-7}$，$a_2 = 0$。\n    -   $\\epsilon''(T)$ 系数：$b_0 = 3.0\\times 10^{-2}$，$b_1 = 1.0\\times 10^{-4}$，$b_2 = 0$。\n\n-   **测试案例 D：**\n    -   $P_{\\mathrm{in}} = 200\\,\\mathrm{W}$，$G_{\\mathrm{c}} = 5.0\\times 10^{-3}\\,\\mathrm{S}$，$h = 100\\,\\mathrm{W/(m^2\\,K)}$。\n    -   $\\sigma(T)$ 系数：$a_0 = 5.0\\times 10^{-5}$，$a_1 = 0$，$a_2 = 0$。\n    -   $\\epsilon''(T)$ 系数：$b_0 = 2.0\\times 10^{-2}$，$b_1 = 0$，$b_2 = 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，源于麦克斯韦方程组和能量守恒原理。使用了一个简化的集总元件模型，这是此类分析的标准且有效的方法。功率吸收和热平衡的方程是一致且物理上合理的。\n\n该问题是适定 (well-posed) 的。它指定了一个清晰的计算任务：使用不动点迭代法找到能量残差函数 $r(T) = 0$ 的根。所有必需的常数、材料属性模型、初始条件和明确的停止准则都已提供。给出的参数在物理上是合理的。问题是客观的，以形式化的数学语言陈述，并且是自洽的。没有矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个合理的解决方案。\n\n问题是找到满足热能平衡方程的稳态温度 $T$：\n$$\nP_{\\mathrm{abs}}(T) = h S (T - T_{\\mathrm{amb}})\n$$\n这是一个关于函数 $r(T) = P_{\\mathrm{abs}}(T) - h S (T - T_{\\mathrm{amb}})$ 的非线性求根问题。问题指定使用不动点迭代法。热平衡方程可以重新排列成 $T = g(T)$ 的形式，适用于不动点迭代：\n$$\nT = T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T)}{h S}\n$$\n这给出了迭代映射：\n$$\nT_{k+1} = T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T_k)}{h S}\n$$\n其中 $T_k$ 是第 $k$ 次迭代时的温度。这个迭代的不动点，即 $T_{k+1} = T_k$ 的点，就是原始能量平衡方程的解。\n\n计算过程如下：\n首先，我们建立函数来计算随温度变化的材料属性和派生的物理量。电导率 $\\sigma(T)$ 和相对介电常数的虚部 $\\epsilon''(T)$ 以关于 $(T - T_{\\mathrm{ref}})$ 的二次多项式形式给出：\n$$ \\sigma(T) = a_0 + a_1(T - T_{\\mathrm{ref}}) + a_2(T - T_{\\mathrm{ref}})^2 $$\n$$ \\epsilon''(T) = b_0 + b_1(T - T_{\\mathrm{ref}}) + b_2(T - T_{\\mathrm{ref}})^2 $$\n利用这些，可以计算等效介电电导 $G_{\\mathrm{d}}(T)$：\n$$ G_{\\mathrm{d}}(T) = \\omega \\varepsilon_0 \\frac{A}{d}\\epsilon''(T) + \\frac{A}{d}\\sigma(T) $$\n其中 $\\omega = 2\\pi f$。然后，样本吸收的功率 $P_{\\mathrm{abs}}(T)$ 使用功率分配关系找到：\n$$ P_{\\mathrm{abs}}(T) = P_{\\mathrm{in}}\\frac{G_{\\mathrm{d}}(T)}{G_{\\mathrm{c}} + G_{\\mathrm{d}}(T)} $$\n解决方案的核心是一个实现不动点方法的迭代循环。每个测试案例的过程如下：\n1. 将温度初始化为环境温度，$T_0 = T_{\\mathrm{amb}}$。\n2. 开始迭代循环，从 $k=0$ 到最大迭代次数 $N_{\\max}$。\n3. 在每次迭代 $k$ 中，使用当前温度 $T_k$：\n    a. 计算能量残差 $r(T_k) = P_{\\mathrm{abs}}(T_k) - h S (T_k - T_{\\mathrm{amb}})$。\n    b. 检查停止准则。如果归一化残差小于或等于容差 $\\tau$，则迭代被视为收敛并终止：\n    $$ \\frac{|r(T_k)|}{P_{\\mathrm{in}}} \\le \\tau $$\n    c. 如果不满足条件，则使用更新规则计算下一个温度估计值 $T_{k+1}$：\n    $$ T_{k+1} = T_{\\mathrm{amb}} + \\frac{P_{\\mathrm{abs}}(T_k)}{h S} $$\n    d. 问题提到了使用欠松弛的选项。带有松弛因子 $\\alpha \\in (0, 1]$ 的通用更新规则为 $T_{k+1}^{\\text{relaxed}} = (1-\\alpha)T_k + \\alpha T_{k+1}$。对于此问题，当 $\\alpha=1$ (无松弛) 时迭代是稳定的，所以我们只需将下一次迭代的温度设置为 $T_{k+1}$。\n4. 如果循环完成而未收敛，则引发错误。否则，最终收敛的温度就是该案例的结果。\n\n此过程将应用于所提供的四个测试案例中的每一个，使用它们各自的参数集。最终结果四舍五入到三位小数，并以要求的格式呈现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coupled electromagnetic-thermal problem for four test cases.\n    \"\"\"\n\n    # Define common constants and parameters from the problem statement.\n    EPS_0 = 8.854187817e-12  # Vacuum permittivity in F/m\n    F = 2.45e9                # Frequency in Hz\n    OMEGA = 2 * np.pi * F     # Angular frequency in rad/s\n    A = 1.0e-2                # Plate area in m^2\n    D = 1.0e-2                # Plate spacing in m\n    S = 2 * A                 # Convective surface area in m^2\n    T_AMB = 293.15            # Ambient temperature in K\n    T_REF = 293.15            # Reference temperature for polynomials in K\n    T0 = T_AMB                # Initial guess for temperature in K\n    TOL = 1.0e-8              # Convergence tolerance\n    N_MAX = 100000            # Maximum number of iterations\n    ALPHA = 1.0               # Under-relaxation factor (1.0 = no relaxation)\n\n    # Test cases as defined in the problem.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"P_in\": 200.0, \"G_c\": 5.0e-3, \"h\": 20.0,\n            \"sigma_coeffs\": (5.0e-5, 5.0e-7, 0.0),\n            \"eps_im_coeffs\": (2.0e-2, 1.5e-4, 0.0)\n        },\n        {\n            \"name\": \"Case B\",\n            \"P_in\": 10.0, \"G_c\": 5.0e-3, \"h\": 10.0,\n            \"sigma_coeffs\": (1.0e-6, 1.0e-8, 0.0),\n            \"eps_im_coeffs\": (5.0e-3, 2.0e-5, 0.0)\n        },\n        {\n            \"name\": \"Case C\",\n            \"P_in\": 500.0, \"G_c\": 2.0e-2, \"h\": 20.0,\n            \"sigma_coeffs\": (2.0e-4, 2.0e-7, 0.0),\n            \"eps_im_coeffs\": (3.0e-2, 1.0e-4, 0.0)\n        },\n        {\n            \"name\": \"Case D\",\n            \"P_in\": 200.0, \"G_c\": 5.0e-3, \"h\": 100.0,\n            \"sigma_coeffs\": (5.0e-5, 0.0, 0.0),\n            \"eps_im_coeffs\": (2.0e-2, 0.0, 0.0)\n        }\n    ]\n\n    def run_simulation(case_params):\n        \"\"\"\n        Runs the fixed-point iteration for a single test case.\n        \"\"\"\n        P_in = case_params[\"P_in\"]\n        G_c = case_params[\"G_c\"]\n        h = case_params[\"h\"]\n        sigma_coeffs = case_params[\"sigma_coeffs\"]\n        eps_im_coeffs = case_params[\"eps_im_coeffs\"]\n\n        def sigma_T(T):\n            \"\"\"Calculates electrical conductivity sigma(T).\"\"\"\n            delta_T = T - T_REF\n            a0, a1, a2 = sigma_coeffs\n            return a0 + a1 * delta_T + a2 * delta_T**2\n\n        def eps_im_T(T):\n            \"\"\"Calculates imaginary relative permittivity epsilon''(T).\"\"\"\n            delta_T = T - T_REF\n            b0, b1, b2 = eps_im_coeffs\n            return b0 + b1 * delta_T + b2 * delta_T**2\n\n        def Gd_T(T):\n            \"\"\"Calculates equivalent dielectric conductance G_d(T).\"\"\"\n            sigma = sigma_T(T)\n            eps_im = eps_im_T(T)\n            return OMEGA * EPS_0 * (A / D) * eps_im + (A / D) * sigma\n\n        def Pabs_T(T):\n            \"\"\"Calculates absorbed electromagnetic power P_abs(T).\"\"\"\n            Gd = Gd_T(T)\n            # Handle case where both Gc and Gd are zero to avoid division by zero.\n            if G_c + Gd == 0:\n                return 0.0\n            return P_in * Gd / (G_c + Gd)\n\n        T = T0\n        for _ in range(N_MAX):\n            P_abs_current = Pabs_T(T)\n            \n            # Calculate the energy residual at the current temperature T\n            r = P_abs_current - h * S * (T - T_AMB)\n            \n            # Check for convergence using the normalized residual\n            # Handle P_in = 0 case to avoid division by zero.\n            if P_in == 0:\n                norm_res = np.abs(r)\n            else:\n                norm_res = np.abs(r) / P_in\n            \n            if norm_res = TOL:\n                return T\n\n            # Compute the next temperature iterate using the fixed-point map\n            T_next = T_AMB + P_abs_current / (h * S)\n            \n            # Apply under-relaxation and update the temperature for the next iteration\n            T = (1 - ALPHA) * T + ALPHA * T_next\n        \n        # If the loop finishes without converging, raise an error.\n        raise RuntimeError(f\"{case_params['name']} did not converge within {N_MAX} iterations.\")\n\n    results = []\n    for case in test_cases:\n        converged_T = run_simulation(case)\n        results.append(np.round(converged_T, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3304789"}, {"introduction": "在计算科学中，验证是确保模拟结果可信度的关键步骤。一个数值方案，无论多么复杂，都必须严格遵守其所模拟的物理系统的基本守恒定律，例如能量守恒。本实践将指导您为瞬态电磁-热耦合问题实施一个一维有限体积法 (FVM) 模拟，并执行严格的离散能量守恒检验。您将通过编程验证，在一个时间步长内，由电磁场耗散的总能量是否精确等于系统内部热能的增加与通过边界流失的热量之和，从而确保您的数值模型在物理上是一致的。[@problem_id:3304816]", "problem": "需要通过在均匀杆上使用有限体积法 (FVM) 执行离散守恒检查，来进行一维电磁 (EM)-热传导耦合验证。计算目标是在完全离散的设置下，检验当体积电磁耗散、热能增加率和边界传导交换在同一离散时间水平上进行一致性评估时，前者是否等于后两者之和。推导必须从第一性原理出发：即由麦克斯韦方程组导出的电磁能量平衡和欧姆定律，以及热传导偏微分方程。在不使用简写的情况下，其控制性表述为：供给物质的电磁功率密度为 $\\,\\mathbf{J}\\cdot\\mathbf{E}\\,$，热演化由扩散算子和体积加热控制。在一维空间 ($\\,x\\,$) 中，对于横截面积为 $\\,A\\,$、材料密度为 $\\,\\rho\\,$、比热容为 $\\,c\\,$、导热系数为 $\\,k\\,$、电导率为 $\\,\\sigma\\,$、温度场为 $\\,T(x,t)\\,$、电场为 $\\,E(x,t)\\,$ 的情况，您必须：\n\n- 将长度为 $\\,L\\,$ 的杆离散为 $\\,N\\,$ 个宽度为 $\\,\\Delta x = L/N\\,$ 的均匀控制体积，单元中心位于 $\\,x_i = (i - \\tfrac{1}{2})\\Delta x\\,$，其中 $\\,i=1,\\dots,N\\,$。\n- 使用单个显式时间步长 $\\,\\Delta t\\,$，通过在时间水平 $\\,t^n\\,$ 上计算的 $\\,k\\nabla T\\,$ 的散度和局部焦耳热 $\\,\\sigma E^2\\,$ 来更新温度。\n- 通过在时间 $\\,t^n\\,$ 对所有单元求和 $\\,\\sigma E_i^2\\,V_i\\,$ 来评估离散的体积电磁耗散 $\\,\\int_{\\Omega} \\mathbf{J}\\cdot\\mathbf{E}\\,dV\\,$，其中 $\\,V_i = A\\,\\Delta x\\,$。\n- 通过对所有单元求和 $\\,\\rho c\\,\\frac{T_i^{n+1}-T_i^n}{\\Delta t}\\,V_i\\,$ 来评估离散的热能增加率 $\\,\\int_{\\Omega} \\rho c\\,\\partial_t T\\,dV\\,$。\n- 使用与时间 $\\,t^n\\,$ 的 FVM 内部模板一致的单侧面梯度来评估离散的边界交换 $\\,\\int_{\\partial\\Omega} k\\nabla T\\cdot \\mathbf{n}\\,dS\\,$。对于狄利克雷 (Dirichlet) 温度边界 $\\,T(0,t)=T_{\\text{left}}\\,$ 和 $\\,T(L,t)=T_{\\text{right}}\\,$，计算 $\\,G_{1/2} = \\frac{T_1^n - T_{\\text{left}}}{\\Delta x}\\,$ 和 $\\,G_{N+1/2} = \\frac{T_{\\text{right}} - T_N^n}{\\Delta x}\\,$，则边界积分为 $\\,A\\,k\\,(G_{N+1/2}-G_{1/2})\\,$。对于绝热边界（均匀诺伊曼 (Neumann) 条件），设置 $\\,G_{1/2}=0\\,$ 和 $\\,G_{N+1/2}=0\\,$。\n\n您必须为每个测试案例计算标量残差\n$$\nr \\;=\\; \\left(\\sum_{i=1}^{N} \\sigma E_i^2 V_i\\right) \\;-\\; \\left(\\sum_{i=1}^{N} \\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} V_i \\;-\\; A k (G_{N+1/2} - G_{1/2})\\right),\n$$\n在一致的离散化下，该值在数值上应接近 $\\,0\\,$。以瓦特 (W) 为单位报告每个测试案例的 $\\,r\\,$ 值。\n\n使用在时间 $\\,t^n\\,$ 上具有均匀 $\\,k\\,$ 值的 $\\,k\\nabla T\\,$ 的离散散度来实现 $\\,T\\,$ 的 FVM 更新：\n$$\n\\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n \\;=\\; \\frac{k}{\\Delta x}\\left(G_{i+1/2}^n - G_{i-1/2}^n\\right), \\quad G_{i+1/2}^n \\;=\\; \\frac{T_{i+1}^n - T_i^n}{\\Delta x}, \\quad i=1,\\dots,N,\n$$\n其中，边界处的 $\\,G_{1/2}^n\\,$ 和 $\\,G_{N+1/2}^n\\,$ 由上述边界条件定义。使用 $\\,T_i^{n+1} = T_i^n + \\Delta t\\left(\\frac{1}{\\rho c}\\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n + \\frac{1}{\\rho c}\\sigma E_i^2\\right)\\,$。\n\n使用以下测试套件（所有常量均以国际单位制表示）：\n\n- 测试案例 $\\,1\\,$ (具有非零边界交换的一般狄利克雷“理想路径”)：\n  - $\\,L = 1.0\\,$, $\\,N = 100\\,$, $\\,A = 1.0\\,$, $\\,\\rho = 7800.0\\,$, $\\,c = 500.0\\,$, $\\,k = 50.0\\,$, $\\,\\sigma = 1.0\\times 10^{6}\\,$, $\\,\\Delta t = 0.01\\,$.\n  - 边界：狄利克雷条件，$\\,T_{\\text{left}} = 300.0\\,$, $\\,T_{\\text{right}} = 300.0\\,$.\n  - 初始温度：$\\,T(x,0) = 300.0 + 50.0\\sin\\left(\\pi x / L\\right)\\,$.\n  - 电场：$\\,E(x) = 10.0 + 5.0\\sin\\left(2\\pi x / L\\right)\\,$.\n\n- 测试案例 $\\,2\\,$ (绝热边界，诺伊曼 $\\,0\\,$ 条件)：\n  - $\\,L = 1.0\\,$, $\\,N = 80\\,$, $\\,A = 1.0\\,$, $\\,rho = 7800.0\\,$, $\\,c = 500.0\\,$, $\\,k = 100.0\\,$, $\\,\\sigma = 2.0\\times 10^{6}\\,$, $\\,\\Delta t = 0.01\\,$.\n  - 边界：诺伊曼条件，$\\,G_{1/2} = 0\\,$ 且 $\\,G_{N+1/2} = 0\\,$.\n  - 初始温度：$\\,T(x,0) = 350.0 + 25.0\\cos\\left(2\\pi x / L\\right)\\,$.\n  - 电场：$\\,E(x) = 7.0\\,$ (均匀)。\n\n- 测试案例 $\\,3\\,$ (无电磁加热，狄利克雷条件下的纯传导)：\n  - $\\,L = 1.0\\,$, $\\,N = 120\\,$, $\\,A = 1.0\\,$, $\\,\\rho = 7800.0\\,$, $\\,c = 500.0\\,$, $\\,k = 200.0\\,$, $\\,\\sigma = 0.0\\,$, $\\,\\Delta t = 0.01\\,$.\n  - 边界：狄利克雷条件，$\\,T_{\\text{left}} = 350.0\\,$, $\\,T_{\\text{right}} = 300.0\\,$.\n  - 初始温度：$\\,T(x,0) = 350.0 - 50.0 x / L\\,$ (线性)。\n  - 电场：$\\,E(x) = 0.0\\,$.\n\n- 测试案例 $\\,4\\,$ (狄利克雷条件下的单单元边缘情况)：\n  - $\\,L = 1.0\\,$, $\\,N = 1\\,$, $\\,A = 1.0\\,$, $\\,\\rho = 7800.0\\,$, $\\,c = 500.0\\,$, $\\,k = 10.0\\,$, $\\,\\sigma = 5.0\\times 10^{5}\\,$, $\\,\\Delta t = 0.01\\,$.\n  - 边界：狄利克雷条件，$\\,T_{\\text{left}} = 310.0\\,$, $\\,T_{\\text{right}} = 290.0\\,$.\n  - 初始温度：$\\,T(x,0) = 310.0 - 20.0 x / L\\,$ (线性)。\n  - 电场：$\\,E(x) = 3.0\\,$ (均匀)。\n\n您的程序必须实现上述离散化，并为每个测试案例计算残差 $\\,r\\,$。残差以瓦特 (W) 为单位，表示为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\,[r_1,r_2,r_3,r_4]\\,$）。不允许有其他输出。如果出现角度，必须以弧度为单位。不得使用百分比；任何小数部分都应使用小数表示。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于热传递和电磁学原理，在数学上是适定的，并且所有提供的数据、方程和条件都是自洽和一致的。任务是使用有限体积法 (FVM) 对一维电磁-热耦合问题的离散能量守恒进行数值验证。\n\n该问题所依据的物理原理是能量守恒。对于一个涉及热传导和体积热生成的系统，该原理由热方程描述。在一维空间 ($x$) 中，对于密度为 $\\rho$、比热容为 $c$、导热系数为 $k$ 的材料，温度场 $T(x,t)$ 的演化遵循以下公式：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + S\n$$\n其中 $S$ 是体积热源密度。在此问题中，热源是在电导率为 $\\sigma$ 的材料中由电场 $E$ 产生的焦耳热。根据欧姆定律，电流密度为 $J = \\sigma E$，以热量形式耗散的功率密度为 $S = J \\cdot E = \\sigma E^2$。因此，控制性偏微分方程 (PDE) 为：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right) + \\sigma E^2\n$$\n为了验证能量守恒，我们在整个域（长度为 $L$、横截面积为 $A$ 的杆）上对该 PDE 进行积分。域的体积为 $\\Omega$。\n$$\n\\int_{\\Omega} \\rho c \\frac{\\partial T}{\\partial t} dV = \\int_{\\Omega} \\nabla \\cdot (k \\nabla T) dV + \\int_{\\Omega} \\sigma E^2 dV\n$$\n对右侧第一项应用散度定理，将热通量散度的体积分转换为边界 $\\partial\\Omega$ 上的通量面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot (k \\nabla T) dV = \\int_{\\partial\\Omega} (k \\nabla T) \\cdot \\mathbf{n} \\, dS\n$$\n其中 $\\mathbf{n}$ 是边界处指向外的法向量。全局能量平衡方程可以重新排列为：总供给功率必须等于储存能量的变化率加上通过边界流出的功率：\n$$\n\\underbrace{\\int_{\\Omega} \\sigma E^2 dV}_{\\text{电磁耗散}} = \\underbrace{\\int_{\\Omega} \\rho c \\frac{\\partial T}{\\partial t} dV}_{\\text{热能增加率}} - \\underbrace{\\int_{\\partial\\Omega} k (\\nabla T) \\cdot \\mathbf{n} \\, dS}_{\\text{净热流出}}\n$$\n该问题要求检查特定的 FVM 离散化是否在其代数的、离散的形式下保持此守恒定律。杆被离散为 $N$ 个控制体积，每个控制体积的宽度为 $\\Delta x = L/N$，体积为 $V_i = A \\Delta x$。单元 $i$ 中的温度为 $T_i$。\n\n提供的从时间 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的单元 $i$ 温度的 FVM 时间更新方案为：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\rho c} \\left( \\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n + \\sigma E_i^2 \\right)\n$$\n重新排列此方程可得到单元 $i$ 处局部 PDE 的离散等效形式：\n$$\n\\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} = \\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n + \\sigma E_i^2\n$$\n为了获得全局离散能量平衡，我们乘以单元体积 $V_i = A\\Delta x$ 并对所有 $N$ 个单元求和：\n$$\n\\sum_{i=1}^N \\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} V_i = \\sum_{i=1}^N \\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n V_i + \\sum_{i=1}^N \\sigma E_i^2 V_i\n$$\n左侧项代表离散的热能增加率。右侧第二项是离散的体积电磁耗散。关键步骤是评估离散散度项的总和。使用提供的定义：\n$$\n\\sum_{i=1}^N \\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n V_i = \\sum_{i=1}^N \\frac{k}{\\Delta x}\\left(G_{i+1/2}^n - G_{i-1/2}^n\\right) (A \\Delta x) = Ak \\sum_{i=1}^N \\left(G_{i+1/2}^n - G_{i-1/2}^n\\right)\n$$\n其中 $G_{i+1/2}^n = (T_{i+1}^n - T_i^n)/\\Delta x$ 是内部面上的梯度。这个求和是一个伸缩级数：\n$$\n\\sum_{i=1}^N \\left(G_{i+1/2}^n - G_{i-1/2}^n\\right) = (G_{3/2}^n - G_{1/2}^n) + (G_{5/2}^n - G_{3/2}^n) + \\dots + (G_{N+1/2}^n - G_{N-1/2}^n)\n$$\n所有内部面梯度项相互抵消，只剩下边界项：\n$$\nAk \\sum_{i=1}^N \\left(G_{i+1/2}^n - G_{i-1/2}^n\\right) = Ak(G_{N+1/2}^n - G_{1/2}^n)\n$$\n该项精确对应于来自边界的净热流入的离散表示，注意到边界交换积分 $\\int_{\\partial\\Omega} k\\nabla T\\cdot \\mathbf{n}\\,dS$ 的计算结果为 $Ak(G_{N+1/2}^n - G_{1/2}^n)$。将此结果代回求和方程，得到离散的全局能量平衡：\n$$\n\\sum_{i=1}^N \\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} V_i = Ak(G_{N+1/2}^n - G_{1/2}^n) + \\sum_{i=1}^N \\sigma E_i^2 V_i\n$$\n待计算的残差 $r$ 定义为：\n$$\nr = \\left(\\sum_{i=1}^{N} \\sigma E_i^2 V_i\\right) - \\left(\\sum_{i=1}^{N} \\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} V_i - A k (G_{N+1/2}^n - G_{1/2}^n)\\right)\n$$\n通过重新排列离散的全局能量平衡方程，我们看到 $r$ 必须恒等于零：\n$$\n\\left(\\sum_{i=1}^{N} \\sigma E_i^2 V_i\\right) + A k (G_{N+1/2}^n - G_{1/2}^n) - \\left(\\sum_{i=1}^{N} \\rho c \\frac{T_i^{n+1}-T_i^n}{\\Delta t} V_i\\right) = 0\n$$\n因此，任务简化为精确地按照定义实现 FVM 更新和残差表达式中每一项的评估。$r$ 的预期结果是一个在数值上接近于零的值，任何非零值都可归因于浮点表示和算术误差。\n\n每个测试案例的实现将按以下步骤进行：\n1.  定义所有物理和数值参数 ($L, N, A, \\rho, c, k, \\sigma, \\Delta t$)。\n2.  构建由 $N$ 个单元中心 $x_i = (i-1/2)\\Delta x$ 组成的空间网格。\n3.  在每个单元中心 $x_i$ 处评估初始温度场 $T_i^n$ 和电场 $E_i$。\n4.  根据指定的边界条件（狄利克雷或诺伊曼）计算边界梯度 $G_{1/2}^n$ 和 $G_{N+1/2}^n$。\n5.  计算内部面梯度 $G_{i+1/2}^n = (T_{i+1}^n - T_i^n)/\\Delta x$，其中 $i=1, \\dots, N-1$。\n6.  计算每个单元的热通量离散散度 $\\left[\\nabla\\cdot(k\\nabla T)\\right]_i^n$。\n7.  执行单个显式时间步长以找到新的温度场 $T_i^{n+1}$。\n8.  计算残差方程的三个分量：总电磁耗散、总热能增加率和边界交换项。\n9.  组合这三个分量以求得最终残差 $r$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    \n    test_cases = [\n        {\n            # Test case 1\n            'L': 1.0, 'N': 100, 'A': 1.0, 'rho': 7800.0, 'c': 500.0, 'k': 50.0, \n            'sigma': 1.0e6, 'dt': 0.01,\n            'bc_type': 'dirichlet', \n            'T_left': 300.0, 'T_right': 300.0,\n            'T_initial_func': lambda x, L: 300.0 + 50.0 * np.sin(np.pi * x / L),\n            'E_field_func': lambda x, L: 10.0 + 5.0 * np.sin(2 * np.pi * x / L)\n        },\n        {\n            # Test case 2\n            'L': 1.0, 'N': 80, 'A': 1.0, 'rho': 7800.0, 'c': 500.0, 'k': 100.0, \n            'sigma': 2.0e6, 'dt': 0.01,\n            'bc_type': 'neumann',\n            'T_initial_func': lambda x, L: 350.0 + 25.0 * np.cos(2 * np.pi * x / L),\n            'E_field_func': lambda x, L: 7.0\n        },\n        {\n            # Test case 3\n            'L': 1.0, 'N': 120, 'A': 1.0, 'rho': 7800.0, 'c': 500.0, 'k': 200.0, \n            'sigma': 0.0, 'dt': 0.01,\n            'bc_type': 'dirichlet',\n            'T_left': 350.0, 'T_right': 300.0,\n            'T_initial_func': lambda x, L: 350.0 - 50.0 * x / L,\n            'E_field_func': lambda x, L: 0.0\n        },\n        {\n            # Test case 4\n            'L': 1.0, 'N': 1, 'A': 1.0, 'rho': 7800.0, 'c': 500.0, 'k': 10.0, \n            'sigma': 5.0e5, 'dt': 0.01,\n            'bc_type': 'dirichlet',\n            'T_left': 310.0, 'T_right': 290.0,\n            'T_initial_func': lambda x, L: 310.0 - 20.0 * x / L,\n            'E_field_func': lambda x, L: 3.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        residual = calculate_residual(params)\n        results.append(residual)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_residual(params):\n    \"\"\"\n    Calculates the energy conservation residual for a single test case.\n    \"\"\"\n    # Unpack parameters\n    L, N, A, rho, c, k, sigma, dt = \\\n        params['L'], params['N'], params['A'], params['rho'], \\\n        params['c'], params['k'], params['sigma'], params['dt']\n    \n    # Grid setup\n    dx = L / N\n    # Cell centers x_i for i = 1, ..., N\n    x = (np.arange(N) + 0.5) * dx\n    V_i = A * dx\n\n    # Initialize fields at time t^n\n    T_n = params['T_initial_func'](x, L)\n    E_field_val = params['E_field_func'](x, L)\n    # Ensure E is an array for scalar E_field_func\n    if np.isscalar(E_field_val):\n        E = np.full(N, E_field_val)\n    else:\n        E = E_field_val\n\n    # Calculate face gradients G_{i+1/2}^n\n    # Interior gradients first\n    if N > 1:\n        G_interior = (T_n[1:] - T_n[:-1]) / dx\n    else:\n        G_interior = np.array([])\n        \n    # Boundary gradients\n    if params['bc_type'] == 'dirichlet':\n        T_left, T_right = params['T_left'], params['T_right']\n        G_half = (T_n[0] - T_left) / dx          # G_{1/2}\n        G_N_plus_half = (T_right - T_n[-1]) / dx # G_{N+1/2}\n    elif params['bc_type'] == 'neumann':\n        G_half = 0.0\n        G_N_plus_half = 0.0\n    \n    # Assemble all face gradients into a single array of size N+1\n    # G[0] = G_{1/2}, G[1...N-1] = G_{3/2...N-1/2}, G[N] = G_{N+1/2}\n    G = np.zeros(N + 1)\n    G[0] = G_half\n    G[-1] = G_N_plus_half\n    if N > 1:\n        G[1:-1] = G_interior\n\n    # Calculate discrete divergence of thermal flux for each cell\n    # [nabla . (k nabla T)]_i^n = (k/dx) * (G_{i+1/2} - G_{i-1/2})\n    div_term = (k / dx) * (G[1:] - G[:-1])\n\n    # Joule heating term\n    joule_heat = sigma * E**2\n    \n    # Update temperature to T^{n+1} using explicit Euler step\n    T_np1 = T_n + (dt / (rho * c)) * (div_term + joule_heat)\n\n    # --- Calculate terms for the residual ---\n\n    # 1. Total volumetric EM dissipation\n    em_dissipation = np.sum(sigma * E**2 * V_i)\n\n    # 2. Total rate of thermal energy increase\n    thermal_increase_rate = np.sum(rho * c * (T_np1 - T_n) / dt * V_i)\n\n    # 3. Boundary exchange term (net heat flux INTO the domain)\n    # The problem defines the boundary exchange integral as a positive outflow:\n    # integral(k*nabla(T).n) dS = A*k*(G_N+1/2 - G_1/2)\n    # The residual formula is Source - (Storage - Boundary_Exchange)\n    boundary_exchange = A * k * (G_N_plus_half - G_half)\n\n    # Calculate the final residual r\n    r = em_dissipation - (thermal_increase_rate - boundary_exchange)\n    \n    return r\n\nsolve()\n```", "id": "3304816"}]}