{"hands_on_practices": [{"introduction": "在深入研究具体的势函数公式之前，首要任务是确立我们分析的物理基础：磁准静态（MQS）近似。这项练习将引导你从麦克斯韦方程组出发，推导并计算一系列无量纲参数，以判断在给定条件下MQS近似的有效性。通过这项实践，你将掌握从基本原理出发，对物理模型进行量化验证的关键技能，并深刻理解何时以及为何可以忽略位移电流。[@problem_id:3328349]", "problem": "一个特征长度为 $L$ 的均匀、各向同性、线性导电块，在频率为 $f$ 的正弦激励下工作。其材料参数为 $\\mu = 100 \\mu_{0}$，$\\sigma = 5 \\times 10^{6}$ S/m，$\\epsilon = 5 \\epsilon_{0}$，其中 $L = 0.1$ m， $f = 1$ kHz。在磁准静态 (MQS) 区域，当电磁波传播效应可忽略不计且传导电流远大于位移电流时，涡流公式，如磁矢量势-电标量势 ($\\mathbf{A}$–$\\phi$) 公式和电流矢量势-磁标量势 ($\\mathbf{T}$–$\\Omega$) 公式，是适用的。\n\n从麦克斯韦方程组和线性介质的本构关系出发，推导在该给定频率和长度尺度下，证明此介质适用 MQS 近似的无量纲参数。您的推导必须从基本定律和定义开始，并得出用于比较以下各项的无量纲量：\n- 特征尺寸 $L$ 与介质中电磁波长之比，\n- 位移电流与传导电流的大小之比，\n- 以及特征尺寸 $L$ 与趋肤深度之比。\n\n利用给定数据计算它们的数值。然后，估算在这些条件下，在此介质中忽略安培定律中的位移电流项所引入的相对误差，以无量纲小数形式表示。将您的最终答案四舍五入到四位有效数字。", "solution": "问题陈述经评估有效。它具有科学依据，提问恰当且客观，是计算电磁学中的一个标准问题。所有必要数据均已提供。我们可以开始求解。\n\n分析从麦克斯韦方程组开始。对于角频率为 $\\omega = 2\\pi f$ 的正弦激励，我们使用时谐（相量）形式。在无源 ($\\rho_v = 0$) 的线性、均匀、各向同性介质中，方程组为：\n$$ \\nabla \\cdot \\mathbf{E} = 0 $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n$$ \\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + j\\omega \\mathbf{D} $$\n\n介质的本构关系为：\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\n$$ \\mathbf{B} = \\mu \\mathbf{H} $$\n$$ \\mathbf{J} = \\sigma \\mathbf{E} $$\n此处，$\\mathbf{J}$ 是传导电流密度。将本构关系代入安培定律得到：\n$$ \\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} + j\\omega \\epsilon \\mathbf{E} $$\n项 $\\mathbf{J}_c = \\sigma\\mathbf{E}$ 代表传导电流密度，项 $\\mathbf{J}_d = j\\omega\\epsilon\\mathbf{E}$ 代表位移电流密度。\n\n当传导电流远大于位移电流时，磁准静态 (MQS) 近似是合理的。第一个无量纲参数是这两种电流密度大小的比值。\n$$ \\frac{|\\mathbf{J}_d|}{|\\mathbf{J}_c|} = \\frac{|j\\omega\\epsilon\\mathbf{E}|}{|\\sigma\\mathbf{E}|} = \\frac{\\omega\\epsilon}{\\sigma} $$\n当 $\\frac{\\omega\\epsilon}{\\sigma} \\ll 1$ 时，MQS 区域有效。\n\n任何准静态近似的第二个理由是，系统的特征长度 $L$ 远小于周围自由空间中的电磁波长 $\\lambda_0$。这确保了延迟效应可以忽略不计。虽然问题要求的是*介质中*的波长，但我们首先建立亥姆霍兹波动方程来求解它。对法拉第定律取旋度，我们得到 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega (\\nabla \\times \\mathbf{B})$。使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2\\mathbf{E}$，并代入 $\\nabla \\cdot \\mathbf{E} = 0$、$\\mathbf{B} = \\mu\\mathbf{H}$ 和安培定律，我们得到：\n$$ -\\nabla^2 \\mathbf{E} = -j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E} $$\n$$ \\nabla^2 \\mathbf{E} + [j\\omega\\mu\\sigma + \\omega^2\\mu\\epsilon]\\mathbf{E} = 0 $$\n这就是亥姆霍兹方程 $\\nabla^2 \\mathbf{E} + k^2\\mathbf{E} = 0$，其中复传播常数 $k$ 由 $k^2 = \\omega^2\\mu\\epsilon - j\\omega\\mu\\sigma$ 给出。\n既然我们已经确定 MQS 要求 $\\frac{\\omega\\epsilon}{\\sigma} \\ll 1$，那么该介质是良导体。在这种情况下，$k^2$ 中的位移电流项与传导电流项相比可以忽略不计：$\\omega^2\\mu\\epsilon \\ll \\omega\\mu\\sigma$。\n因此，传播常数简化为：\n$$ k^2 \\approx -j\\omega\\mu\\sigma $$\n$$ k = \\sqrt{-j\\omega\\mu\\sigma} = \\sqrt{\\omega\\mu\\sigma}\\sqrt{-j} = \\sqrt{\\omega\\mu\\sigma} \\left(\\frac{1-j}{\\sqrt{2}}\\right) = (1-j)\\sqrt{\\frac{\\omega\\mu\\sigma}{2}} $$\n复传播常数的一般形式是 $k = \\beta - j\\alpha$，其中 $\\beta$ 是相移常数（波数），$\\alpha$ 是衰减常数。对于此介质，我们有：\n$$ \\alpha = \\beta = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}} $$\n趋肤深度 $\\delta$ 是场振幅衰减到 $1/e$ 的距离，定义为 $\\delta = 1/\\alpha$。\n$$ \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} $$\n介质中的波长 $\\lambda$ 与相移常数的关系为 $\\lambda = 2\\pi/\\beta$。\n$$ \\lambda = 2\\pi\\delta $$\n问题要求我们推导比较 $L$ 与 $\\lambda$ 以及 $L$ 与 $\\delta$ 的无量纲量。它们是 $L/\\lambda$ 和 $L/\\delta$。条件 $L \\ll \\lambda$ 经常被用来作为忽略波效应的依据。然而，在良导体中，这个条件等价于 $L \\ll 2\\pi\\delta$。这些比率并不决定 MQS 的有效性，而是表征 MQS 区域内的物理行为（例如，强或弱趋肤效应）。忽略波传播（延迟）的主要条件是 $L \\ll \\lambda_0$，其中 $\\lambda_0 = c_0/f$ 是自由空间波长。\n\n现在我们计算数值。\n给定参数：\n$L = 0.1\\ \\mathrm{m}$\n$f = 1\\ \\mathrm{kHz} = 10^3\\ \\mathrm{Hz}$\n$\\mu = 100 \\mu_0 = 100 \\times (4\\pi \\times 10^{-7}\\ \\mathrm{H/m}) = 4\\pi \\times 10^{-5}\\ \\mathrm{H/m}$\n$\\sigma = 5 \\times 10^6\\ \\mathrm{S/m}$\n$\\epsilon = 5 \\epsilon_0 = 5 \\times (8.854 \\times 10^{-12}\\ \\mathrm{F/m}) \\approx 4.427 \\times 10^{-11}\\ \\mathrm{F/m}$\n角频率为 $\\omega = 2\\pi f = 2\\pi \\times 10^3\\ \\mathrm{rad/s}$。\n\n无量纲参数 1：位移电流与传导电流之比。\n$$ \\frac{\\omega\\epsilon}{\\sigma} = \\frac{(2\\pi \\times 10^3\\ \\mathrm{rad/s})(4.427 \\times 10^{-11}\\ \\mathrm{F/m})}{5 \\times 10^6\\ \\mathrm{S/m}} \\approx 5.562 \\times 10^{-14} $$\n由于 $5.562 \\times 10^{-14} \\ll 1$，传导电流占主导地位的 MQS 准则被很好地满足。\n\n趋肤深度 $\\delta$：\n$$ \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} = \\sqrt{\\frac{2}{(2\\pi \\times 10^3)(4\\pi \\times 10^{-5})(5 \\times 10^6)}} = \\sqrt{\\frac{2}{4\\pi^2 \\times 10^5}}\\ \\mathrm{m} \\approx 7.118 \\times 10^{-4}\\ \\mathrm{m} $$\n所以趋肤深度约为 $0.7118\\ \\mathrm{mm}$。\n\n介质中的波长 $\\lambda$：\n$$ \\lambda = 2\\pi\\delta \\approx 2\\pi(7.118 \\times 10^{-4}\\ \\mathrm{m}) \\approx 4.472 \\times 10^{-3}\\ \\mathrm{m} $$\n介质中的波长约为 $4.472\\ \\mathrm{mm}$。\n\n无量纲参数 2：特征尺寸与趋肤深度之比。\n$$ \\frac{L}{\\delta} = \\frac{0.1\\ \\mathrm{m}}{7.118 \\times 10^{-4}\\ \\mathrm{m}} \\approx 140.5 $$\n由于 $L \\gg \\delta$，我们处于强趋肤效应区域，其中涡流显著地屏蔽了导电块内部的磁场。\n\n无量纲参数 3：特征尺寸与介质中波长之比。\n$$ \\frac{L}{\\lambda} = \\frac{0.1\\ \\mathrm{m}}{4.472 \\times 10^{-3}\\ \\mathrm{m}} \\approx 22.36 $$\n$L > \\lambda$ 这一事实并不会使 MQS 模型失效。它表明电磁场的相位在距离 $L$ 上有显著变化。然而，由于场振幅在更短的距离 $\\delta = \\lambda/(2\\pi)$ 上呈指数衰减，这种相位变化仅在薄薄的趋肤层内是相关的。整体行为是扩散性的，而不是传播性的，这正是 MQS 在导体中的本质。\n\n在安培定律中，因忽略位移电流项 $\\mathbf{J}_d = j\\omega\\epsilon\\mathbf{E}$ 而引入的相对误差，是被忽略项的大小与保留项 $\\mathbf{J}_c = \\sigma\\mathbf{E}$ 大小的比值。\n$$ \\text{相对误差} = \\frac{|\\mathbf{J}_d|}{|\\mathbf{J}_c|} = \\frac{\\omega\\epsilon}{\\sigma} $$\n我们已经计算过这个值。\n$$ \\text{相对误差} \\approx 5.562 \\times 10^{-14} $$\n将其四舍五入到四位有效数字，得到 $5.562 \\times 10^{-14}$。", "answer": "$$\\boxed{5.562 \\times 10^{-14}}$$", "id": "3328349"}, {"introduction": "在实际的有限元分析中，我们必须在一个有限的计算域中模拟无界问题，这引入了人工边界条件这一核心挑战。本练习聚焦于$A$-$\\phi$公式，探讨了在截断边界上施加不同类型边界条件（如Dirichlet、Neumann和无限元耦合）的物理含义与数值效果。通过分析这些方法的优缺点，你将学会如何在模型精度和计算成本之间做出明智的权衡，这是解决实际工程电磁问题的必备能力。[@problem_id:3328325]", "problem": "一个紧凑的载流源区域 $\\,\\Omega_{s}\\,$ 嵌入在一个均匀、线性和非导电的自由空间中，该空间的磁导率为 $\\,\\mu_{0}\\,$。计算域 $\\,\\Omega\\,$ 是一个无界外部区域的单连通截断，由一个包围 $\\,\\Omega_{s}\\,$ 的人工外边界 $\\,\\partial\\Omega_{R}\\,$ 界定。在磁准静态 (MQS) 体系下，外部区域的位移电流可以忽略不计，场由磁矢量势 $\\,\\mathbf{A}\\,$ 和电标量势 $\\,\\phi\\,$ (即 $\\,\\mathbf{A}\\text{–}\\phi\\,$ 表述) 表示，其中 $\\,\\mathbf{B}=\\nabla\\times\\mathbf{A}\\,$ 且 $\\,\\mathbf{E}=-\\partial_{t}\\mathbf{A}-\\nabla\\phi\\,$。假设在 $\\,\\Omega\\,$ 中强制施加库仑规范 $\\,\\nabla\\cdot\\mathbf{A}=0\\,$。外边界 $\\,\\partial\\Omega_{R}\\,$ 旨在近似无界自由空间的影响。考虑以下几种候选的外部边界处理方法，用于 $\\,\\mathbf{A}\\text{–}\\phi\\,$ 表述的有限元离散化。\n\n关于这些外部边界处理方法，以下哪些陈述是正确的？\n\nA) 一个狄利克雷边界，在 $\\,\\partial\\Omega_{R}\\,$ 上规定磁矢量势的切向分量 $\\,\\mathbf{A}\\times\\mathbf{n}=\\mathbf{0}\\,$，这将在 $\\,\\partial\\Omega_{R}\\,$ 上强制 $\\,\\mathbf{B}\\cdot\\mathbf{n}=0\\,$，从而形成一个磁壁，场线沿 $\\,\\partial\\Omega_{R}\\,$ 切向延伸。对于均匀外部区域中的紧凑源，当 $\\,\\partial\\Omega_{R}\\,$ 放置得足够远，以至于远场由偶极子项主导时，$\\,\\partial\\Omega_{R}\\,$ 上磁场的截断误差按 $\\,O(R^{-3})\\,$ 的比例变化。\n\nB) 一个诺伊曼边界，在 $\\,\\partial\\Omega_{R}\\,$ 上规定磁场的切向分量 $\\,\\mathbf{n}\\times\\big(\\mu^{-1}\\nabla\\times\\mathbf{A}\\big)=\\mathbf{0}\\,$，这将强制 $\\,\\mathbf{H}\\times\\mathbf{n}=0\\,$，因此 $\\,\\mathbf{B}\\,$ 垂直于 $\\,\\partial\\Omega_{R}\\,$。这种处理方法普遍比选项 A 中的狄利克雷边界更准确，对于紧凑源，无论主导远场的方向如何，其产生的截断误差为 $\\,O(R^{-4})\\,$。\n\nC) 一种无限边界元法 (BEM) 耦合，它通过 $\\,\\partial\\Omega_{R}\\,$ 上的一个边界积分方程来表示外部自由空间，并提供了在无穷远处的精确衰减，从而提供了一个对 $\\,\\partial\\Omega_{R}\\,$ 的位置基本不敏感的外部边界条件（对于均匀的外部区域和足够的离散化），其代价是在 $\\,\\partial\\Omega_{R}\\,$ 上引入了稠密耦合。\n\nD) 在 $\\,\\mathbf{A}\\text{–}\\phi\\,$ 表述中，为了保证唯一性，必须在 $\\,\\partial\\Omega_{R}\\,$ 上同时施加 $\\,\\mathbf{A}\\times\\mathbf{n}=\\mathbf{0}\\,$ 和 $\\,\\phi=0\\,$；如果不规定这两个条件，即使在内部施加了诸如 $\\,\\nabla\\cdot\\mathbf{A}=0\\,$ 的规范，问题仍然是不适定的。\n\nE) 对于角频率为 $\\,\\omega\\,$ 且具有非导电外部区域的涡流问题，正确的无限域条件是 Sommerfeld 辐射条件，它在大的 $\\,r\\,$ 处强制出射球面波 $\\,e^{\\mathrm{j}kr}/r\\,$；因此，在 MQS 体系下，无限 BEM 耦合必须在 $\\,\\partial\\Omega_{R}\\,$ 上强制施加此波动条件。\n\n选择所有适用的选项。", "solution": "问题陈述经证实具有科学依据、适定且客观。它描述了计算电磁学中的一个典型问题，即关于磁准静态 (MQS) 分析中无界域的截断。所有术语都定义明确，且前提与电磁理论一致。\n\n非导电外部区域 ($\\Omega_{ext}$) 的控制物理源于麦克斯韦方程组的 MQS 近似。在该区域忽略位移电流 ($\\partial_t \\mathbf{D} \\approx \\mathbf{0}$)，且该区域也为无源区 ($\\mathbf{J}_s = \\mathbf{0}$)，安培定律变为 $\\nabla \\times \\mathbf{H} = \\mathbf{0}$。对于线性均匀介质，$\\mathbf{B} = \\mu_0 \\mathbf{H}$，这得出 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$。通过 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 引入磁矢量势 $\\mathbf{A}$，方程变为 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\mathbf{0}$。使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ 并强制库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，外部区域中磁矢量势的控制方程简化为矢量拉普拉斯方程：\n$$ \\nabla^2 \\mathbf{A} = \\mathbf{0} $$\n场的源是 $\\Omega_s$ 中的紧凑电流分布。在远场中，来自此类源的势 $\\mathbf{A}$ 由其磁偶极子项主导，该项按 $O(R^{-2})$ 衰减。因此，磁场 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 按 $O(R^{-3})$ 衰减。\n\n我们现在评估每个陈述。\n\n### 选项 A 分析\n边界条件是矢量势切向分量的齐次狄利克雷条件：在 $\\partial\\Omega_R$ 上 $\\mathbf{A} \\times \\mathbf{n} = \\mathbf{0}$。这等效于设置切向分量 $\\mathbf{A}_t = \\mathbf{0}$。\n\n边界上磁场的法向分量是 $\\mathbf{B} \\cdot \\mathbf{n}$。使用定义 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，我们有 $\\mathbf{B} \\cdot \\mathbf{n} = (\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{n}$。根据 Stokes 定理，通过 $\\partial\\Omega_R$ 上任意曲面片 $S$ 的 $\\mathbf{B}$ 的通量为 $\\int_S (\\nabla \\times \\mathbf{A}) \\cdot d\\mathbf{S} = \\oint_{\\partial S} \\mathbf{A} \\cdot d\\mathbf{l}$。由于在 $\\partial\\Omega_R$ 上处处有 $\\mathbf{A}_t = \\mathbf{0}$，因此对于边界上的任何曲线 $\\partial S$，线积分 $\\oint_{\\partial S} \\mathbf{A} \\cdot d\\mathbf{l}$ 都为零。这意味着被积函数 $(\\nabla \\times \\mathbf{A}) \\cdot \\mathbf{n}$ 必须处处为零。因此，条件 $\\mathbf{A} \\times \\mathbf{n} = \\mathbf{0}$ 在 $\\partial\\Omega_R$ 上强制 $\\mathbf{B} \\cdot \\mathbf{n} = 0$。该条件描述了一个“磁壁”，磁场线不能穿透该表面，必须沿其切向运行。陈述的第一部分是正确的。\n\n对于截断误差，在无界域中，偶极源的精确解 $\\mathbf{A}_{true}$ 按 $O(R^{-2})$ 衰减。条件 $\\mathbf{A} \\times \\mathbf{n} = \\mathbf{0}$ 强制数值解 $\\mathbf{A}_{num}$ 在 $R$ 处的切向分量为零。因此，误差与精确解的切向分量同量级，即 $O(R^{-2})$。势的这个误差会传播到整个计算域。磁场中的误差 $\\mathbf{B}_{error} = \\nabla \\times \\mathbf{A}_{error}$ 将因此按势误差的导数比例变化。$O(R^{-2})$ 的势误差导致 $O(R^{-3})$ 的场误差。这与简单截断边界条件的已有结果一致。陈述的第二部分也是正确的。\n\n结论：**正确**。\n\n### 选项 B 分析\n边界条件是磁场切向分量的齐次诺伊曼条件：$\\mathbf{n} \\times (\\mu^{-1}\\nabla \\times \\mathbf{A}) = \\mathbf{0}$。由于 $\\mathbf{H} = \\mu^{-1}\\mathbf{B} = \\mu^{-1}(\\nabla \\times \\mathbf{A})$，该条件正是 $\\mathbf{n} \\times \\mathbf{H} = \\mathbf{0}$。这意味着 $\\mathbf{H}$ 的切向分量为零，因此 $\\mathbf{H}$（以及 $\\mathbf{B}$）必须垂直于边界 $\\partial\\Omega_R$。陈述的第一部分是正确的。\n\n在准确性方面，来自偶极源的真实磁场 $\\mathbf{H}_{true}$ 按 $O(R^{-3})$ 衰减。通常情况下，其在球面上的切向分量非零，且也按 $O(R^{-3})$ 比例变化。边界条件人为地将此切向分量强制为零。因此，在边界上引入的误差与真实切向场的量级相同，即 $O(R^{-3})$。在整个域中计算出的磁场的最终误差预计为 $O(R^{-3})$。陈述中关于误差按 $O(R^{-4})$ 比例变化的说法是不正确的。对于静磁问题，这类标准的局部边界条件所导致的场误差，其比例为 $O(R^{-(p+2)})$，其中 $p$ 是第一个非零多极矩的阶数（单极子 $p=1$，偶极子 $p=2$）。对于偶极源（$p=2$），场误差为 $O(R^{-3})$ 的说法不正确，它应为 $O(R^{-(d+1)})$，其中 $d$ 是偶极矩阶数。对于偶极子，势 $A \\propto R^{-2}$，场 $B \\propto R^{-3}$。误差与被忽略的项一致，即 $O(R^{-3})$。文献指出对于偶极源误差为 $O(R^{-3})$。所以 $O(R^{-4})$ 的说法是不正确的。\n\n此外，声称这种处理方法“普遍比”狄利克雷边界更准确的说法是错误的。这两种条件的相对准确性取决于源的方向。对于特定的方向，真实场可能碰巧具有很小的切向 $\\mathbf{A}$ 或很小的切向 $\\mathbf{H}$，从而使得相应的边界条件在该特定情况下更准确。两者都不是普遍更优越的。\n\n结论：**不正确**。\n\n### 选项 C 分析\n该陈述描述了用于无界域问题的有限元-边界元 (FEM-BEM) 耦合方法。在这种方法中，包含源的内部域 $\\Omega$ 用有限元法 (FEM) 进行离散化，而外部无限域 $\\Omega_{ext}$ 则由公共边界 $\\partial\\Omega_R$ 上的一个边界积分方程表示。该积分方程源于 Green 恒等式，并使用控制微分算子的基本解（Green 函数）。对于此 MQS 问题中的拉普拉斯算子 ($\\nabla^2$)，Green 函数为 $G(\\mathbf{r}, \\mathbf{r'}) = 1/(4\\pi |\\mathbf{r}-\\mathbf{r'}|)$。这个 Green 函数自动满足势在无穷远处消失的条件。\n\n由于 BEM 表述在均匀外部区域中提供了场的精确表示（在边界本身的离散化误差范围内），组合的 FEM-BEM 解不像使用局部边界条件（如选项 A 和 B）那样是一种近似。只要人工边界 $\\partial\\Omega_R$ 包围了所有源和材料非均匀性，其位置的设置不会改变所模拟的物理过程。因此，结果对 $\\partial\\Omega_R$ 的位置“基本不敏感”。BEM 的主要缺点是它会导致一个稠密、全填充的矩阵块，该矩阵块耦合了边界 $\\partial\\Omega_R$ 上的所有自由度。与仅由 FEM 生成的稀疏矩阵相比，这在计算上是昂贵的。该陈述准确地描述了 FEM-BEM 方法的主要优点和主要缺点。\n\n结论：**正确**。\n\n### 选项 D 分析\n该陈述声称，为确保唯一性，必须在外部边界上同时施加 $\\mathbf{A} \\times \\mathbf{n} = \\mathbf{0}$ 和 $\\phi = 0$。这是不正确的。矢量场边值问题和标量场问题的解的唯一性取决于为每个问题指定适当的边界条件，而不必是特定的同时配对。\n\n在非导电的外部区域，磁势和电势问题在很大程度上是解耦的。磁势 $\\mathbf{A}$ 满足 $\\nabla^2 \\mathbf{A} = \\mathbf{0}$（在规范 $\\nabla \\cdot \\mathbf{A} = 0$下），电标量势 $\\phi$ 满足 $\\nabla^2 \\phi = 0$（假设 $\\Omega_s$ 中没有净电荷）。\n\n对于磁问题，在边界上指定 $\\mathbf{A}$ 的切向分量（即 $\\mathbf{A} \\times \\mathbf{n}$）或 $\\mathbf{H}$ 的切向分量（即 $\\mathbf{n} \\times (\\nabla \\times \\mathbf{A})$）足以确保 $\\mathbf{A}$ 的唯一解（除了一个与规范相关的调和函数的梯度，该梯度由体规范和对 $\\mathbf{A} \\cdot \\mathbf{n}$ 的条件固定，或通过特定的单元选择被隐式处理）。在边界上对 $\\mathbf{A}$ 或其导数的单个条件就足以使磁子问题成为适定问题。\n\n类似地，对 $\\phi$ 的单个边界条件，如狄利克雷条件（$\\phi = g$）或诺伊曼条件（$\\mathbf{n} \\cdot \\nabla\\phi = h$），就足以保证标量势 $\\phi$ 的唯一性。\n\n$\\mathbf{A}$ 的问题和 $\\phi$ 的问题并不需要所述形式的耦合边界条件才能成为适定问题，尤其是在非导电的外部区域。该陈述过于强烈，与事实不符。\n\n结论：**不正确**。\n\n### 选项 E 分析\n该陈述将 MQS 体系与全波电磁体系混淆了。Sommerfeld 辐射条件描述了作为亥姆霍兹方程 $(\\nabla^2 + k^2)\\psi = 0$ 的解的出射波的行为，其中 $k = \\omega\\sqrt{\\mu\\epsilon}$ 是波数。在波的传播速度有限的全波背景下，该条件对于确保散射和辐射问题的唯一解至关重要。\n\n根据定义，MQS 体系是位移电流可忽略不计的低频极限。这等效于让光速变为无穷大，或者波数 $k \\to 0$。在此极限下，亥姆霍兹方程简化为拉普拉斯方程 $\\nabla^2\\psi = 0$。拉普拉斯方程的解不是传播波；它们是随距离的负幂次（例如 $r^{-1}$, $r^{-2}$）衰减的场。拉普拉斯方程在无穷远处的适当“边界条件”就是场消失。\n\n因此，用于 MQS 问题的无限 BEM 耦合必须使用拉普拉斯算子的 Green 函数 ($1/r$)，而不是亥姆霍兹方程的 Green 函数 ($e^{-jkr}/r$，其中指数中的符号取决于时谐约定）。将波动条件应用于非波动（准静态）问题是一个根本性错误。\n\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "3328325"}, {"introduction": "与$A$-$\\phi$公式不同，$T$-$\\Omega$公式在处理电流密度时引入了矢量流位$\\mathbf{T}$，其规范不变性为数值求解带来了独特的挑战和机遇。本练习将带你深入离散系统的核心，通过编程实践来识别和处理由规范自由度及导体复杂拓扑（如孔洞）引起的代数零空间。掌握这一技能对于确保$T$-$\\Omega$方法在多连通域问题中的数值稳定性和解的唯一性至关重要，它揭示了计算电磁学与代数拓扑之间的深刻联系。[@problem_id:3328303]", "problem": "在计算电磁学的磁准静态体系中，从麦克斯韦方程组的微分形式出发，并考虑磁准静态（MQS）近似，即在导体内部，传导电流远大于位移电流。在此背景下，$T$-$\\Omega$ 公式在导电区域使用矢量电流势 $\\,\\mathbf{T}\\,$，在非导电区域使用磁标势 $\\,\\Omega\\,$。导电区域满足 $\\,\\nabla \\times \\mathbf{H} = \\mathbf{J}\\,$，并定义电流密度 $\\,\\mathbf{J} = \\nabla \\times \\mathbf{T}\\,$。非导电区域满足 $\\,\\nabla \\times \\mathbf{H} = \\mathbf{0}\\,$，因此有 $\\,\\mathbf{H} = -\\nabla \\Omega\\,$。\n\n因为对于任何足够光滑的标量场 $\\,\\psi\\,$，都有 $\\,\\nabla \\times (\\nabla \\psi) = \\mathbf{0}\\,$，所以变换 $\\,\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi\\,$ 不会改变 $\\,\\mathbf{J} = \\nabla \\times \\mathbf{T}\\,$。这产生了一种规范不变性，并相应地在与梯度场相关的离散系统中产生了一个零空间。任务是在离散设置中，识别与 $\\,\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi\\,$ 相关的零空间，并构建一个最小的约束集来消除这个零空间，而不对系统进行过度约束，从而只保留具有物理意义的自由度（包括与多连通拓扑相关的可能谐波分量）。\n\n使用以下基于代表导体的二维胞腔复形上的有向关联算子的离散框架：\n\n- 令 $\\,V\\,$ 为节点数（标量势自由度），$\\,E\\,$ 为有向边数（矢量电流势自由度），$\\,F\\,$ 为有向面（单元）数。\n- 定义离散梯度算子 $G \\in \\mathbb{R}^{E \\times V}$，它通过边差分将节点标量势 $\\psi \\in \\mathbb{R}^{V}$ 映射到边值 $\\mathbf{T} \\in \\mathbb{R}^{E}$，即 $\\mathbf{T} = G \\psi$。\n- 定义离散旋度算子 $C \\in \\mathbb{R}^{F \\times E}$，它通过围绕每个面求有向边的贡献之和，将边值 $\\mathbf{T}$ 映射到面环流，即离散意义下的 $\\nabla \\times \\mathbf{T}$。\n- 与规范相关的零空间由集合 $\\{\\nabla \\psi : \\psi \\in \\mathbb{R}^{V}\\}$ 给出，该集合对应于 $\\,G\\,$ 的值域。其维度等于 $\\,G\\,$ 的秩，即 $\\,V - N_c\\,$，其中 $\\,N_c\\,$ 是节点图的连通分量数。\n- 消除此零空间的最小约束集可通过对所有标量测试函数 $\\,q\\,$ 强制施加弱无散条件 $\\int_{\\Omega} (\\nabla \\cdot \\mathbf{T})\\, q \\, d\\Omega = 0$ 来获得，这在具有标准欧几里得内积的离散设置中简化为 $G^{\\top} \\mathbf{T} = \\mathbf{0}$。令 $D := G^{\\top}$ 为约束矩阵；则 $\\operatorname{rank}(D) = \\operatorname{rank}(G) = V - N_c$，恰好消除了与规范相关的自由度，而没有过度约束系统。\n- 施加约束后，$C$ 的剩余零空间对应于与拓扑相关的谐波边场（例如，孔洞），其维度等于第一贝蒂数 $\\,b_1\\,$。\n\n实现一个程序：\n1. 为指定的测试网格构造 $\\,G\\,$、$\\,C\\,$ 和 $\\,D = G^{\\top}\\,$。\n2. 计算 $\\dim(\\mathcal{N}_{\\text{gauge}}) = \\operatorname{rank}(G)$，$\\,D\\,$ 的秩，以及剩余零空间维度 $\\dim\\big(\\{\\mathbf{T} : C \\mathbf{T} = \\mathbf{0},\\, D \\mathbf{T} = \\mathbf{0}\\}\\big) = E - \\operatorname{rank}([C; D])$，其中 $\\, [C; D] \\,$ 表示 $\\,C\\,$ 和 $\\,D\\,$ 的垂直堆叠。\n\n使用以下导体网格测试套件（每个网格通过矩形网格和移除面来定义 $\\,V\\,$、$\\,E\\,$、$\\,F\\,$，以创建孔洞，并可能包含多个不连通的分量）：\n\n- 测试用例 1（正常路径）：一个单连通的 $\\,2 \\times 2\\,$ 矩形导体。它有 $\\,3 \\times 3\\,$ 个节点，没有孔洞。\n- 测试用例 2（多连通）：一个 $\\,3 \\times 3\\,$ 的矩形导体，移除了中心面以创建一个孔洞。\n- 测试用例 3（边缘情况，不连通）：两个不连通的 $\\,1 \\times 1\\,$ 矩形导体（无孔洞），共同作为一个具有两个分量的单一网格处理。\n\n对于每个测试用例，计算并返回：\n- $d_{\\text{gauge}} = \\operatorname{rank}(G)$，\n- $r_D = \\operatorname{rank}(D)$，\n- $d_{\\text{remain}} = E - \\operatorname{rank}([C; D])$。\n\n所有输出均为整数。您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，形式为逗号分隔的列表的列表，并用方括号括起来。例如，您的程序必须打印一行形式为 $\\,[[d_{\\text{gauge}},r_D,d_{\\text{remain}}],[\\dots],[\\dots]]\\,$ 的内容。\n\n不涉及物理单位或角度单位；这些量是从离散算子上的线性代数推导出的纯整数。[@problem_id:529]", "solution": "该问题要求分析在磁准静态的T-$\\Omega$公式中出现的离散算子的零空间结构。我们首先根据指定的协议对问题陈述进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **物理模型：** 磁准静态（MQS）近似，其中传导电流远大于位移电流。\n- **公式：** T-$\\Omega$ 公式，在导体中使用矢量电流势 $\\mathbf{T}$（$\\mathbf{J} = \\nabla \\times \\mathbf{T}$），在非导体中使用磁标势 $\\Omega$（$\\mathbf{H} = -\\nabla \\Omega$）。\n- **规范不变性：** 变换 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 保持电流密度 $\\mathbf{J}$ 不变。\n- **离散框架：** 一个具有 $V$ 个节点、 $E$ 条边和 $F$ 个面的二维胞腔复形。\n    - 离散梯度：$G \\in \\mathbb{R}^{E \\times V}$，将节点值映射到边值。\n    - 离散旋度：$C \\in \\mathbb{R}^{F \\times E}$，将边值映射到面值。\n- **零空间定义：**\n    - 规范零空间：$G$ 的值域，$\\operatorname{ran}(G)$，其维度为 $\\dim(\\operatorname{ran}(G)) = \\operatorname{rank}(G) = V - N_c$，其中 $N_c$ 是连通分量的数量。\n    - 约束：通过约束矩阵 $D := G^{\\top}$ 施加弱无散条件，得到约束方程 $D \\mathbf{T} = \\mathbf{0}$。\n    - 剩余零空间：谐波场的空间，$\\{\\mathbf{T} : C \\mathbf{T} = \\mathbf{0}, D \\mathbf{T} = \\mathbf{0}\\}$，其维度为 $E - \\operatorname{rank}([C; D])$。\n- **任务：** 对于三个指定的网格，构造 $G$、$C$ 和 $D$，并计算维度 $d_{\\text{gauge}} = \\operatorname{rank}(G)$、$r_D = \\operatorname{rank}(D)$ 和 $d_{\\text{remain}} = E - \\operatorname{rank}([C; D])$。\n- **测试用例：**\n    1.  一个单连通的 $2 \\times 2$ 矩形导体。\n    2.  一个 $3 \\times 3$ 的矩形导体，中心面被移除（一个孔洞）。\n    3.  两个不连通的 $1 \\times 1$ 矩形导体。\n- **输出格式：** 一个逗号分隔的列表的列表：$[[d_{\\text{gauge}}, r_D, d_{\\text{remain}}], \\dots]$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于计算电磁学和离散流形上的矢量微积分（一个常被称为离散外微分的领域）的原理。T-$\\Omega$ 公式、MQS 近似、规范自由度以及关联算子（$G$ 和 $C$）的使用都是标准概念。算子秩与拓扑不变量（$N_c$，连通分量数，和 $b_1$，第一贝蒂数）之间的关系是代数拓扑在数学上合理的结果。\n- **适定性：** 问题清晰地定义了要构造的数学对象和要计算的量。测试用例的规范足够详细，可以无歧义地构造底层离散网格。对于每次计算，都存在一个唯一的、有意义的整数解。\n- **客观性：** 语言正式、精确，没有任何主观性。\n\n**第 3 步：结论与行动**\n该问题在科学上是有效的、适定的和客观的。它不包含任何矛盾、歧义或不成立的前提。因此，我们可以着手解决。\n\n### 基于原理的解决方案\n\n该解决方案涉及为每个指定的网格拓扑构造离散算子，然后使用数值线性代数来确定所需的秩和零空间维度。该方法基于应用于离散胞腔复形的代数拓扑原理。\n\n**1. 导体域的离散化**\n导体由一个二维胞腔复形表示。该复形的元素是节点（顶点，0-胞腔）、边（1-胞腔）和面（2-胞腔）。我们分别用 $V$、$E$ 和 $F$ 表示它们的数量。对于每个测试用例，我们通过定义构成网格的节点、边和面的集合来构造此复形。\n-   **节点：** 对于一个 $N_x \\times N_y$ 的网格，节点由整数对 $(i, j)$ 索引，其中 $i \\in [0, N_x]$ 且 $j \\in [0, N_y]$。可以为每个节点分配一个唯一的整数索引，例如，$k = i \\cdot (N_y+1) + j$。\n-   **边：** 边连接相邻的节点。我们定义两组：连接 $(i, j)$ 到 $(i+1, j)$ 的水平边和连接 $(i, j)$ 到 $(i, j+1)$ 的垂直边。每条边都被赋予一个固定的方向，例如，从较小的坐标索引到较大的坐标索引。\n-   **面：** 面是由四条边界定的基本矩形单元。通过从完整网格中移除面来创建孔洞。\n\n**2. 离散算子的构造**\n线性算子 $G$ 和 $C$ 分别是表示离散梯度和离散旋度的关联矩阵。\n\n-   **离散梯度 $G \\in \\mathbb{R}^{E \\times V}$：** 此算子将定义在节点上的标量势（所谓的 0-形式）映射到定义在边上的矢量势分量（1-形式）。对于从节点 $v_i$ 指向节点 $v_j$ 的边 $e_k$，$G$ 的第 $k$ 行在第 $i$ 列包含一个 $-1$，在第 $j$ 列包含一个 $+1$，所有其他条目均为 $0$。这代表了跨越边的势差。\n    $$ (G\\psi)_k = \\psi_j - \\psi_i $$\n-   **离散旋度 $C \\in \\mathbb{R}^{F \\times E}$：** 此算子将边值（1-形式）映射到面上的标量值（2-形式）。对于由一组有向边 $\\partial f_k$ 界定的面 $f_k$，$C$ 的第 $k$ 行计算环流。如果边 $e_l$ 是 $\\partial f_k$ 的一部分且其方向与面的方向（例如，逆时针）匹配，则条目 $C_{kl}$ 为 $+1$；如果方向相反，则为 $-1$；否则为 $0$。\n    $$ (C\\mathbf{T})_k = \\sum_{e_l \\in \\partial f_k} \\sigma_{kl} T_l \\quad (\\sigma_{kl} \\in \\{-1, 1\\}) $$\n\n**3. 规范零空间与约束**\n规范自由度 $\\mathbf{T} \\mapsto \\mathbf{T} + \\nabla \\psi$ 在离散设置中被捕获为 $\\mathbf{T} \\mapsto \\mathbf{T} + G\\psi$。所有此类规范变换的集合构成一个子空间 $\\operatorname{ran}(G)$，这是物理问题的零空间，因为 $C(G\\psi) = \\mathbf{0}$（梯度的旋度为零）。\n-   **规范零空间维度, $d_{\\text{gauge}}$：** 这个与规范相关的零空间的维度是 $G$ 的值域的维度，即 $\\operatorname{rank}(G)$。从代数拓扑学可知，$\\dim(\\operatorname{ran}(G)) = \\operatorname{rank}(G) = V - N_c$，其中 $N_c$ 是网格的断开连通分量的数量。我们将其计算为 $d_{\\text{gauge}} = \\operatorname{rank}(G)$。\n-   **约束矩阵 $D = G^{\\top}$：** 为了消除规范自由度，我们对 $\\mathbf{T}$ 施加一个约束。条件 $\\nabla \\cdot \\mathbf{T} = 0$ 是通过要求 $G^{\\top} \\mathbf{T} = \\mathbf{0}$ 以弱形式施加的。矩阵 $D = G^{\\top} \\in \\mathbb{R}^{V \\times E}$ 是离散散度算子。约束的秩，$r_D = \\operatorname{rank}(D) = \\operatorname{rank}(G^{\\top})$，必须等于 $d_{\\text{gauge}}$，才能完全移除规范自由度而不对系统过度约束。由于 $\\operatorname{rank}(A) = \\operatorname{rank}(A^{\\top})$，我们期望 $r_D = d_{\\text{gauge}}$。\n\n**4. 剩余（谐波）零空间**\n施加约束后，我们感兴趣的是组合系统的零空间：$\\{\\mathbf{T} \\in \\mathbb{R}^E \\mid C\\mathbf{T} = \\mathbf{0} \\text{ and } D\\mathbf{T} = \\mathbf{0}\\}$。这对应于既无旋又无散的矢量场，称为谐波场。这个空间的维度 $d_{\\text{remain}}$ 等于域的第一贝蒂数 $b_1$，它代表拓扑“孔洞”或“隧道”的数量。\n为了计算这个维度，我们形成一个堆叠矩阵 $S = [C; D]$。$S$ 的零度给出了 $d_{\\text{remain}}$。根据秩-零度定理，$\\operatorname{rank}(S) + \\operatorname{nullity}(S) = E$。因此，\n$$ d_{\\text{remain}} = E - \\operatorname{rank}([C; D]) $$\n\n**5. 实现与测试用例执行**\n算法首先为每个测试用例定义生成网格结构。对于具有多个不连通分量的用例，为每个分量构造局部 $G$ 和 $C$ 矩阵，然后将它们组装成全局块对角矩阵。总边数 $E$ 是所有分量中边的总和。最后，使用标准的数值线性代数例程计算 $G$、$D$ 和堆叠矩阵 $[C; D]$ 的秩。\n\n-   **测试用例 1（$2 \\times 2$ 网格）：** $V=9, E=12, F=4, N_c=1, b_1=0$。\n    -   $d_{\\text{gauge}} = V-N_c = 9-1=8$。\n    -   $r_D = 8$。\n    -   $d_{\\text{remain}} = b_1 = 0$。\n-   **测试用例 2（带一个孔的 $3 \\times 3$ 网格）：** $V=16, E=24, F=8, N_c=1, b_1=1$。\n    -   $d_{\\text{gauge}} = V-N_c = 16-1=15$。\n    -   $r_D = 15$。\n    -   $d_{\\text{remain}} = b_1 = 1$。\n-   **测试用例 3（两个 $1 \\times 1$ 网格）：** 两个分量。分量1：$V_1=4, E_1=4$。分量2：$V_2=4, E_2=4$。总计：$V=8, E=8, F=2, N_c=2, b_1=0$。\n    -   $d_{\\text{gauge}} = V-N_c = 8-2=6$。\n    -   $r_D = 6$。\n    -   $d_{\\text{remain}} = b_1 = 0$。\n\n以下实现计算了这些值，并且程序的运行结果证实了这些理论预测。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import block_diag\n\ndef build_single_component(nx, ny, holes):\n    \"\"\"\n    Constructs the discrete gradient (G) and curl (C) matrices for a\n    single rectangular component of a mesh.\n\n    Args:\n        nx (int): Number of cells in the x-direction.\n        ny (int): Number of cells in the y-direction.\n        holes (list of tuples): A list of (i,j) coordinates for removed faces.\n\n    Returns:\n        tuple: (V, E, G, C)\n            V (int): Number of nodes.\n            E (int): Number of edges.\n            G (np.ndarray): The E x V discrete gradient matrix.\n            C (np.ndarray): The F x E discrete curl matrix.\n    \"\"\"\n    # 1. Node mapping: map grid coordinates (i,j) to a linear index.\n    nodes_map = {}\n    v_idx = 0\n    for i in range(nx + 1):\n        for j in range(ny + 1):\n            nodes_map[(i, j)] = v_idx\n            v_idx += 1\n    V = v_idx\n\n    # 2. Edge mapping: map oriented edge (u,v) to a linear index.\n    # We establish a canonical ordering for edges.\n    edges_map = {}\n    edge_list = []  # A list of (u, v) node index tuples\n    \n    # Horizontal edges (oriented left-to-right)\n    for j in range(ny + 1):\n        for i in range(nx):\n            u, v = nodes_map[(i, j)], nodes_map[(i + 1, j)]\n            if (u, v) not in edges_map:\n                edges_map[(u, v)] = len(edge_list)\n                edge_list.append((u, v))\n    \n    # Vertical edges (oriented bottom-to-top)\n    for i in range(nx + 1):\n        for j in range(ny):\n            u, v = nodes_map[(i, j)], nodes_map[(i, j + 1)]\n            if (u, v) not in edges_map:\n                edges_map[(u, v)] = len(edge_list)\n                edge_list.append((u, v))\n                \n    E = len(edge_list)\n\n    # 3. Face mapping: map face coordinate (i,j) to a linear index.\n    faces_map = {}\n    face_list = []\n    for i in range(nx):\n        for j in range(ny):\n            if (i, j) not in holes:\n                faces_map[(i, j)] = len(face_list)\n                face_list.append((i, j))\n    F = len(face_list)\n    \n    # 4. Build G matrix (E x V)\n    G = np.zeros((E, V), dtype=int)\n    for e_idx, (u, v) in enumerate(edge_list):\n        G[e_idx, u] = -1\n        G[e_idx, v] = 1\n        \n    # 5. Build C matrix (F x E)\n    C = np.zeros((F, E), dtype=int)\n    for f_idx, (i, j) in enumerate(face_list):\n        # Node indices for the corners of the face\n        n_bl = nodes_map[(i, j)]\n        n_br = nodes_map[(i + 1, j)]\n        n_tl = nodes_map[(i, j + 1)]\n        n_tr = nodes_map[(i + 1, j + 1)]\n        \n        # CCW path: (i,j) -> (i+1,j) -> (i+1,j+1) -> (i,j+1) -> (i,j)\n        # Edge orientations: H: left-to-right, V: bottom-to-top.\n        \n        # Bottom edge: (n_bl, n_br). Matches CCW.\n        e_bottom_idx = edges_map[(n_bl, n_br)]\n        C[f_idx, e_bottom_idx] = 1\n\n        # Right edge: (n_br, n_tr). Matches CCW.\n        e_right_idx = edges_map[(n_br, n_tr)]\n        C[f_idx, e_right_idx] = 1\n        \n        # Top edge: (n_tl, n_tr). Path wants tr -> tl, opposite of canonical.\n        e_top_idx = edges_map[(n_tl, n_tr)]\n        C[f_idx, e_top_idx] = -1\n        \n        # Left edge: (n_bl, n_tl). Path wants tl -> bl, opposite of canonical.\n        e_left_idx = edges_map[(n_bl, n_tl)]\n        C[f_idx, e_left_idx] = -1\n        \n    return V, E, G, C\n\ndef analyze_mesh(component_definitions):\n    \"\"\"\n    Analyzes a mesh, possibly with multiple components, to find the \n    dimensions of gauge and harmonic nullspaces.\n\n    Args:\n        component_definitions (list): A list where each element is a tuple \n                                      (nx, ny, holes) defining a component.\n\n    Returns:\n        list: A list of integers [d_gauge, r_D, d_remain].\n    \"\"\"\n    list_G = []\n    list_C = []\n    total_E = 0\n    \n    for nx, ny, holes in component_definitions:\n        _, E_comp, G_comp, C_comp = build_single_component(nx, ny, holes)\n        list_G.append(G_comp)\n        list_C.append(C_comp)\n        total_E += E_comp\n        \n    # Assemble global matrices from component blocks\n    G = block_diag(*list_G)\n    C = block_diag(*list_C)\n    \n    # Dimension of the gauge nullspace\n    d_gauge = np.linalg.matrix_rank(G)\n    \n    # Constraint matrix D and its rank\n    D = G.T\n    r_D = np.linalg.matrix_rank(D)\n    \n    # Stack C and D to find the dimension of the remaining nullspace\n    if C.shape[0] == 0: # Handle case with no faces\n        stacked_matrix = D\n    else:\n        stacked_matrix = np.vstack([C, D])\n        \n    rank_stacked = np.linalg.matrix_rank(stacked_matrix)\n    \n    # Dimension of the remaining (harmonic) nullspace\n    d_remain = total_E - rank_stacked\n    \n    return [d_gauge, r_D, d_remain]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases specified in the problem.\n    \"\"\"\n    test_cases = [\n        # Test Case 1: Simply connected 2x2 rectangular conductor\n        [(2, 2, [])],\n        # Test Case 2: Multiply connected 3x3 conductor with a central hole\n        [(3, 3, [(1, 1)])],\n        # Test Case 3: Two disconnected 1x1 rectangular conductors\n        [(1, 1, []), (1, 1, [])],\n    ]\n\n    results = []\n    for case_def in test_cases:\n        result = analyze_mesh(case_def)\n        results.append(result)\n\n    # Format the final output string as specified: [[r1,r2,r3],[...],...]\n    output_str = f\"[{','.join([str(r).replace(' ', '') for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3328303"}]}