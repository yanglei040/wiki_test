{"hands_on_practices": [{"introduction": "在周期性系统中模拟孤立的局部特征（如缺陷）时，超胞法是一种标准技术。然而，这种便利性是有代价的：人为引入的周期性会导致伪影。本练习将深入探讨这种被称为“超胞混叠”的数值误差，通过一个简化的模型来量化由缺陷的周期性镜像引起的虚假布拉格散射，并观察其如何人为地打开一个能带带隙。[@problem_id:3308775]", "problem": "考虑在一均匀背景中，由标量亥姆霍兹方程所描述的、带有一个弱的局域化缺陷的一维时谐电磁波。在无量纲单位下，电场 $E(x)$ 的控制方程为\n$$\n\\frac{d^2 E}{dx^2} + \\omega^2 \\,\\epsilon(x)\\, E = 0,\n$$\n其中背景介电常数为 $\\epsilon_b = 1$，波速被归一化为 $c = 1$，对于平面波 $\\exp(i k x)$，其未受扰动的色散关系为 $\\omega = |k|$。该缺陷被建模为介电常数的一个弱微扰，\n$$\n\\epsilon(x) = 1 + \\eta\\, u(x),\n$$\n其中 $0  \\eta \\ll 1$，$u(x)$ 是一个有界的局域化形状函数。在采用 Floquet 定理和周期性边界条件 (PBC) 的数值超胞方法中，缺陷以超胞长度 $L = N a$ 进行周期性复制，其中 $a$ 是一个基胞的长度，$N$ 是超胞中基胞的数量。由此产生的周期性微扰具有一个基本倒格矢 $G = \\frac{2\\pi}{L}$ 和傅里叶系数\n$$\nU_m = \\frac{1}{L}\\int_{0}^{L} u(x)\\, e^{-i m G x}\\, dx,\\quad m \\in \\mathbb{Z}.\n$$\n在近自由波近似中，赝布拉格耦合出现在第一布里渊区边界 $k \\approx G/2$ 附近，导致由缺陷周期性复制的 $m=1$ 次谐波所介导的 $\\exp(i k x)$ 和 $\\exp(i (k - G) x)$ 之间的耦合驱动的频带分裂。对于缺陷模式而言，这种效应构成了超胞混叠误差，因为一个真正孤立的缺陷不应引起这种周期性的布拉格散射。\n\n假设缺陷形状为高斯函数，\n$$\nu(x) = \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right),\n$$\n其中 $\\sigma$ 是缺陷的宽度，所有空间量都以 $a$ 为单位表示，因此不失一般性地，可以取 $a=1$。在适用于 $0  \\eta \\ll 1$ 的弱微扰极限下进行分析。您的任务是从第一性原理推导出在第一布里渊区边界处的归一化赝布拉格诱导频率分裂的领头阶表达式，该分裂定义为带隙大小与 $k = G/2$ 处未受扰动频率之比。然后，实现一个程序，通过利用高斯函数的解析傅里叶变换和在 $k = G/2$ 处的近自由波双模耦合，为给定的参数集计算此混叠误差度量。\n\n所有量都是无量纲的，最终答案应为无量纲实数。您的程序应为以下测试套件计算混叠误差：\n- 情况 1：$a = 1$, $N = 8$, $\\sigma = 0.15$, $\\eta = 0.02$。\n- 情况 2：$a = 1$, $N = 32$, $\\sigma = 0.15$, $\\eta = 0.02$。\n- 情况 3：$a = 1$, $N = 1$, $\\sigma = 0.15$, $\\eta = 0.02$。\n- 情况 4：$a = 1$, $N = 8$, $\\sigma = 0.50$, $\\eta = 0.02$。\n- 情况 5：$a = 1$, $N = 8$, $\\sigma = 0.15$, $\\eta = 0.00$。\n\n您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个结果必须四舍五入到8位小数。例如，输出格式应为\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5].\n$$", "solution": "问题陈述在科学上是合理的、内容自洽且适定的。它描述了计算物理学中的一个典范问题，具体来说，是分析在使用超胞方法对局域化缺陷进行建模时所产生的人为周期性效应。所引用的物理原理，如亥姆霍兹方程、Floquet 定理、布拉格散射和近自由波近似，都是波动物理学和固态理论的基石。所提供的参数是一致且充分的，足以得到唯一解。因此，该问题被认为是有效的，我将着手进行严格的推导，然后进行数值实现。\n\n任务是为一个带周期性微扰的一维亥姆霍兹方程，推导其在第一布里渊区边界处的归一化频率分裂的领头阶表达式。控制方程为：\n$$ \\frac{d^2 E}{dx^2} + \\omega^2 \\epsilon(x) E = 0 $$\n在超胞模型中，介电常数 $\\epsilon(x) = 1 + \\eta\\, u_L(x)$ 是周期性的，周期为 $L=Na$，其中 $u_L(x)$ 是单个高斯缺陷 $u(x) = \\exp(-x^2/(2\\sigma^2))$ 的周期性复制。参数 $\\eta$ 是一个小值常数，$0  \\eta \\ll 1$。我们可以将控制方程重写为：\n$$ \\frac{d^2 E}{dx^2} + \\omega^2 E = -\\omega^2 \\eta\\, u_L(x) E $$\n方程右侧的项充当微扰。在没有此微扰（$\\eta=0$）的情况下，解为平面波 $E(x) = \\exp(ikx)$，其色散关系为 $\\omega = |k|$，因为背景波速为 $c=1$。\n\n我们感兴趣的是在第一布里渊区边界附近的行为，此处波数 $k$ 接近 $G/2$，而 $G = 2\\pi/L$ 是基本倒格矢。在 $k=G/2$ 处，未受扰动的正向传播波 $\\exp(i(G/2)x)$ 和一阶布拉格散射波 $\\exp(i(k-G)x) = \\exp(i(G/2-G)x) = \\exp(-i(G/2)x)$ 是简并的。它们未受扰动的频率为 $\\omega_0 = |k| = G/2$。\n\n周期性微扰 $u_L(x)$可以展开为傅里叶级数：\n$$ u_L(x) = \\sum_{m=-\\infty}^{\\infty} U_m e^{imGx} $$\n其中傅里叶系数 $U_m$ 由 $U_m = \\frac{1}{L}\\int_0^L u_L(x) e^{-imGx} dx$ 给出。\n微扰耦合了这些简并模式。根据近自由波近似，我们以这两个主导模式的叠加形式寻找解：\n$$ E(x) = c_0 e^{i(G/2)x} + c_1 e^{-i(G/2)x} $$\n将此双模拟设代入控制方程：\n$$ -(G/2)^2 (c_0 e^{i(G/2)x} + c_1 e^{-i(G/2)x}) + \\omega^2 (c_0 e^{i(G/2)x} + c_1 e^{-i(G/2)x}) = -\\omega^2 \\eta \\left(\\sum_m U_m e^{imGx}\\right) (c_0 e^{i(G/2)x} + c_1 e^{-i(G/2)x}) $$\n令 $\\omega_0 = G/2$。方程变为：\n$$ (\\omega^2 - \\omega_0^2) (c_0 e^{i\\omega_0 x} + c_1 e^{-i\\omega_0 x}) = -\\omega^2 \\eta \\sum_m U_m (c_0 e^{i(m+1)\\omega_0 x} + c_1 e^{i(m-1)\\omega_0 x}) $$\n为了获得关于系数 $c_0$ 和 $c_1$ 的方程组，我们将该方程投影到基函数 $e^{i\\omega_0 x}$ 和 $e^{-i\\omega_0 x}$ 上。这通过将方程乘以 $e^{-i\\omega_0 x}$（对于第一个方程）或 $e^{i\\omega_0 x}$（对于第二个方程）并在一个周期 $L$ 上积分来完成。复指数的正交性，$\\frac{1}{L}\\int_0^L e^{ij\\omega_0 x} e^{-il\\omega_0 x} dx = \\delta_{jl}$，简化了求和。\n\n对于第一个方程（投影到 $e^{i\\omega_0 x}$ 上）：\n$$ (\\omega^2 - \\omega_0^2) c_0 = -\\omega^2 \\eta (U_0 c_0 + U_1 c_1) $$\n对于第二个方程（投影到 $e^{-i\\omega_0 x}$ 上）：\n$$ (\\omega^2 - \\omega_0^2) c_1 = -\\omega^2 \\eta (U_{-1} c_0 + U_0 c_1) $$\n这可以写成一个关于 $(c_0, c_1)$ 的 $2 \\times 2$ 齐次线性系统：\n$$ \\begin{pmatrix} \\omega^2(1+\\eta U_0) - \\omega_0^2  \\omega^2 \\eta U_1 \\\\ \\omega^2 \\eta U_{-1}  \\omega^2(1+\\eta U_0) - \\omega_0^2 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n为获得非平凡解，该矩阵的行列式必须为零。缺陷形状 $u(x)$ 是实偶函数，因此其傅里叶系数为实数且满足偶性，即 $U_m = U_{-m} \\in \\mathbb{R}$。\n$$ (\\omega^2(1+\\eta U_0) - \\omega_0^2)^2 - (\\omega^2 \\eta U_1)^2 = 0 $$\n$$ \\omega^2(1+\\eta U_0) - \\omega_0^2 = \\pm \\omega^2 \\eta U_1 $$\n这就得出了关于 $\\omega^2$ 的两个解：\n$$ \\omega^2(1 + \\eta U_0 \\mp \\eta U_1) = \\omega_0^2 \\implies \\omega^2_\\pm = \\frac{\\omega_0^2}{1 + \\eta(U_0 \\mp U_1)} $$\n因此，上($u$)能带边和下($l$)能带边的频率分别为 $\\omega_u = \\omega_+$ 和 $\\omega_l = \\omega_-$。\n$$ \\omega_u = \\frac{\\omega_0}{\\sqrt{1 + \\eta(U_0 - U_1)}} \\quad , \\quad \\omega_l = \\frac{\\omega_0}{\\sqrt{1 + \\eta(U_0 + U_1)}} $$\n频率分裂为 $\\Delta\\omega = \\omega_u - \\omega_l$。归一化分裂为 $\\Delta\\omega / \\omega_0$：\n$$ \\frac{\\Delta\\omega}{\\omega_0} = \\frac{1}{\\sqrt{1 + \\eta(U_0 - U_1)}} - \\frac{1}{\\sqrt{1 + \\eta(U_0 + U_1)}} $$\n由于我们感兴趣的是 $\\eta \\ll 1$ 时的领头阶表达式，我们使用泰勒展开 $(1+x)^{-1/2} \\approx 1-x/2$。\n$$ \\frac{\\Delta\\omega}{\\omega_0} \\approx \\left(1 - \\frac{\\eta}{2}(U_0 - U_1)\\right) - \\left(1 - \\frac{\\eta}{2}(U_0 + U_1)\\right) = -\\frac{\\eta}{2}U_0 + \\frac{\\eta}{2}U_1 + \\frac{\\eta}{2}U_0 + \\frac{\\eta}{2}U_1 = \\eta U_1 $$\n由于对于一般形状 $U_1$ 可能为负，分裂的大小由 $\\eta|U_1|$ 给出。对于指定的高斯函数，$U_1  0$。\n\n最后一步是计算傅里叶系数 $U_1$。对于缺陷的周期性阵列 $u_L(x) = \\sum_j u(x-jL)$，其系数为：\n$$ U_m = \\frac{1}{L} \\int_{-L/2}^{L/2} \\left( \\sum_{j=-\\infty}^{\\infty} u(x-jL) \\right) e^{-imGx} dx $$\n可以证明，这等价于单个缺陷形状 $u(x)$ 的傅里叶变换在倒格点 $k_m=mG$ 处的值乘以 $1/L$。当缺陷在超胞内良好局域化时（$\\sigma \\ll L$），这个近似非常好。\n$$ U_m = \\frac{1}{L} \\int_{-\\infty}^{\\infty} u(x) e^{-imGx} dx = \\frac{1}{L} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right) e^{-imGx} dx $$\n该积分是高斯函数的标准傅里叶变换。$\\exp(-ax^2)$ 的变换是 $\\sqrt{\\pi/a} \\exp(-k^2/(4a))$。此处，$a = 1/(2\\sigma^2)$ 且 $k=mG$。\n$$ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right) e^{-imGx} dx = \\sqrt{2\\pi\\sigma^2} \\exp\\left(-\\frac{(mG)^2 \\sigma^2}{2}\\right) $$\n因此，傅里叶系数为：\n$$ U_m = \\frac{\\sqrt{2\\pi}\\sigma}{L} \\exp\\left(-\\frac{m^2 G^2 \\sigma^2}{2}\\right) $$\n代入 $m=1$ 和 $G=2\\pi/L$：\n$$ U_1 = \\frac{\\sqrt{2\\pi}\\sigma}{L} \\exp\\left(-\\frac{(2\\pi/L)^2 \\sigma^2}{2}\\right) = \\frac{\\sqrt{2\\pi}\\sigma}{L} \\exp\\left(-\\frac{2\\pi^2\\sigma^2}{L^2}\\right) $$\n归一化混叠误差的最终表达式为：\n$$ \\text{Error} = \\eta U_1 = \\eta \\frac{\\sqrt{2\\pi}\\sigma}{L} \\exp\\left(-\\frac{2\\pi^2\\sigma^2}{L^2}\\right) $$\n这就是需要实现的公式。我们设定基胞长度 $a=1$，因此超胞长度为 $L=N$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the normalized spurious Bragg-induced frequency splitting for a\n    1D Helmholtz equation with a periodic Gaussian permittivity defect.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, N, sigma, eta)\n        (1, 8, 0.15, 0.02),\n        (1, 32, 0.15, 0.02),\n        (1, 1, 0.15, 0.02),\n        (1, 8, 0.50, 0.02),\n        (1, 8, 0.15, 0.00),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, N, sigma, eta = case\n\n        # The normalized splitting is given by eta * U_1, where U_1 is the\n        # first Fourier coefficient of the periodic defect potential.\n        # If eta is 0, the perturbation is zero, so the splitting is zero.\n        if eta == 0:\n            results.append(f\"{0.0:.8f}\")\n            continue\n\n        # Supercell length L = N * a\n        L = N * a\n\n        # The Fourier coefficient U_1 is derived from the analytical\n        # Fourier transform of a single Gaussian function.\n        # U_1 = (sqrt(2*pi)*sigma / L) * exp(-2*pi^2*sigma^2 / L^2)\n        \n        prefactor = (np.sqrt(2 * np.pi) * sigma) / L\n        exponent_arg = -2 * np.pi**2 * sigma**2 / L**2\n        exp_term = np.exp(exponent_arg)\n        \n        U1 = prefactor * exp_term\n\n        # The aliasing error metric is the normalized frequency splitting\n        aliasing_error = eta * U1\n        \n        results.append(f\"{aliasing_error:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3308775"}, {"introduction": "模拟周期性系统的一个主要目标是计算其能带结构，即色散关系 $\\omega(\\mathbf{k})$。虽然直接求解本征值问题是一种方法，但本练习展示了一种功能强大的替代方案，该方案基于分析系统的频率响应。你将使用谐波反演（一种先进的信号处理技术）从模拟的驱动响应数据中提取本征频率，这模拟了在实际研究中分析大规模模拟或实验数据的方式。[@problem_id:3308797]", "problem": "考虑一个一维周期性电磁结构中的单元平均电场的频域响应，其晶胞长度为 $a$，并受到布洛赫周期性边界条件的约束。对于给定的布洛赫波矢 $\\mathbf{k}$（在一维中，$\\mathbf{k}=k\\hat{x}$），在具有布洛赫相位的空间周期性源作用下的强迫频域解满足弗洛凯定理：任何场都可以表示为 $E_{k}(x)=u_{k}(x)\\mathrm{e}^{\\mathrm{i}kx}$，其中 $u_{k}(x)$ 是以晶胞为周期的函数。在频域中，单元平均场 $\\overline{E}(\\omega;k)$ 在布洛赫模式的本征频率 $\\omega_{n}(k)$ 处表现出谐振，每个谐振都因材料损耗或辐射（表示为小的阻尼率）而展宽。\n\n从频域中的麦克斯韦方程组出发，该结构由场 $E$ 在源 $J$ 作用下的线性算子方程 $\\nabla\\times\\mu^{-1}\\nabla\\times E-\\omega^{2}\\varepsilon E=J$ 和弗洛凯条件 $E(x+a)=E(x)\\mathrm{e}^{\\mathrm{i}ka}$ 建模。根据弗洛凯定理，对于每个 $k$，算子的谱在该算子的预解式中产生一组离散的复极点 $\\Omega_{n}(k)=\\omega_{n}(k)-\\mathrm{i}\\gamma_{n}$，这意味着标量单元平均频率响应可以表示为 $\\omega$ 的有理函数，其具有单极点，\n$$\n\\overline{E}(\\omega;k)=\\sum_{n}\\frac{C_{n}(k)}{\\omega-\\Omega_{n}(k)}.\n$$\n此处 $C_{n}(k)$ 编码了源与第 $n$ 个布洛赫模式的交叠，而 $\\gamma_{n}0$ 是阻尼。通过对 $\\overline{E}(\\omega;k)$ 进行傅里叶逆变换得到的时域冲激响应 $h(t;k)$，在 $t0$ 时是一系列衰减的复指数的有限和，\n$$\nh(t;k)=\\sum_{n}A_{n}(k)\\,\\mathrm{e}^{\\mathrm{i}\\Omega_{n}(k)t},\n$$\n其中 $A_{n}(k)$ 是一个通过复留数微积分与 $C_{n}(k)$ 相关的常数。谐波反演方法（如Prony方法）可以从均匀采样的时域数据 $h(t_{m};k)$ 中恢复复频率 $\\Omega_{n}(k)$，从而得到能带结构 $\\omega_{n}(k)=\\mathrm{Re}\\,\\Omega_{n}(k)$。\n\n在本问题中，您将从服从布洛赫周期性驱动的合成频域驱动仿真中恢复近似的能带结构。为便于数值处理和清晰起见，假设一个双能带模型 ($n\\in\\{1,2\\}$)，其色散关系模拟了一维周期性光子介质中的类紧束缚耦合：\n$$\n\\omega_{1}(k)=\\sqrt{\\omega_{01}^{2}+4J_{1}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)},\\qquad\n\\omega_{2}(k)=\\sqrt{\\omega_{02}^{2}+4J_{2}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)}.\n$$\n假设存在小的恒定阻尼率 $\\gamma_{1}0$ 和 $\\gamma_{2}0$，复极点位置为 $\\Omega_{1}(k)=\\omega_{1}(k)-\\mathrm{i}\\gamma_{1}$ 和 $\\Omega_{2}(k)=\\omega_{2}(k)-\\mathrm{i}\\gamma_{2}$。令单元平均场的频域驱动响应为\n$$\n\\overline{E}(\\omega;k)=\\frac{C_{1}(k)}{\\omega-\\Omega_{1}(k)}+\\frac{C_{2}(k)}{\\omega-\\Omega_{2}(k)},\n$$\n其中 $C_{1}(k)=1+0.4\\cos(ka)$ 且 $C_{2}(k)=0.7+0.3\\sin(ka)$。\n\n您的任务是：\n- 通过在均匀角频率网格 $\\omega\\in[-W,W]$ 上评估 $\\overline{E}(\\omega;k)$ 来构建合成的频域数据，并利用离散傅里叶逆积分数值近似时域冲激响应 $h(t;k)$\n$$\nh(t;k)\\approx\\frac{\\Delta\\omega}{2\\pi}\\sum_{m=0}^{M-1}\\overline{E}(\\omega_{m};k)\\,\\mathrm{e}^{\\mathrm{i}\\omega_{m}t}.\n$$\n此处 $\\omega_{m}$ 是均匀间隔的采样点，$\\Delta\\omega$ 是网格间距， $M$ 是采样点数。使用 $t_{n}=n\\Delta t$（其中 $n=0,1,\\ldots,N-1$）形成均匀的时间样本。\n- 对时间样本 $h(t_{n};k)$ 应用阶数为 $P=2$ 的线性预测（Prony）谐波反演方法，以估计两个复频率 $\\Omega_{1}(k)$ 和 $\\Omega_{2}(k)$，然后报告 $\\omega_{1}(k)=\\mathrm{Re}\\,\\Omega_{1}(k)$ 和 $\\omega_{2}(k)=\\mathrm{Re}\\,\\Omega_{2}(k)$。\n- 对每个 $k$ 恢复的两个值按升序排序，并四舍五入到六位小数。\n\n使用以下参数值，如适用，均以角频率单位表示：\n- 晶胞长度 $a=1$。\n- 能带参数 $\\omega_{01}=10$, $\\omega_{02}=14$, $J_{1}=3$, $J_{2}=1.5$。\n- 阻尼率 $\\gamma_{1}=0.1$, $\\gamma_{2}=0.08$。\n- 频率网格半宽 $W=40$，在 $-W$ 到 $W$ 之间有 $M=4096$ 个均匀间隔的采样点。\n- 时间采样步长 $\\Delta t=0.05$，$N=128$ 个样本（即 $t_{n}=n\\Delta t$）。\n- 线性预测阶数 $P=2$。\n\n测试套件：\n- 情况 1: $k=0$。\n- 情况 2: $k=\\pi/a$。\n- 情况 3: $k=(\\pi/2)/a$。\n\n答案规格：\n- 对于每个测试用例，您的程序必须返回一个包含两个恢复的角频率 $\\left[\\omega_{1}(k),\\omega_{2}(k)\\right]$ 的列表，单位为 $\\mathrm{rad/s}$，按升序排序并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表，每个测试用例由其自己的方括号列表表示，且无空格，例如 $\\left[\\left[\\omega_{1}(k_{1}),\\omega_{2}(k_{1})\\right],\\left[\\omega_{1}(k_{2}),\\omega_{2}(k_{2})\\right],\\left[\\omega_{1}(k_{3}),\\omega_{2}(k_{3})\\right]\\right]$。\n\n所有角频率必须以 $\\mathrm{rad/s}$ 为单位报告，并四舍五入到六位小数。角度（如 $ka$）必须以弧度计算。通过使用提供的参数并执行指定的数值近似和谐波反演，确保科学真实性。不允许使用外部数据；程序必须是自包含的，并且在执行反演之前必须计算合成的频域响应。", "solution": "### 问题验证\n\n在尝试解决方案之前，该问题经过了严格的验证过程。\n\n#### 步骤1：提取给定信息\n\n以下数据和定义逐字从问题陈述中提取：\n- **物理模型**：一维周期性电磁结构。\n- **晶胞长度**：$a$。\n- **场表示**：弗洛凯定理适用，$E_{k}(x)=u_{k}(x)\\mathrm{e}^{\\mathrm{i}kx}$，其中 $u_{k}(x)$ 以周期 $a$ 为周期。\n- **频率响应模型**：单元平均频率响应 $\\overline{E}(\\omega;k)$ 是一个有理函数，其单极点为 $\\Omega_{n}(k)=\\omega_{n}(k)-\\mathrm{i}\\gamma_{n}$：\n$$\n\\overline{E}(\\omega;k)=\\sum_{n}\\frac{C_{n}(k)}{\\omega-\\Omega_{n}(k)}\n$$\n- **时间响应模型**：当时域冲激响应 $h(t;k)$ 为 $t0$ 时：\n$$\nh(t;k)=\\sum_{n}A_{n}(k)\\,\\mathrm{e}^{\\mathrm{i}\\Omega_{n}(k)t}\n$$\n- **特定双能带模型 ($n\\in\\{1,2\\}$)**:\n    - 色散关系：\n        $$\n        \\omega_{1}(k)=\\sqrt{\\omega_{01}^{2}+4J_{1}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)},\\qquad\n        \\omega_{2}(k)=\\sqrt{\\omega_{02}^{2}+4J_{2}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)}\n        $$\n    - 复极点：$\\Omega_{1}(k)=\\omega_{1}(k)-\\mathrm{i}\\gamma_{1}$ 和 $\\Omega_{2}(k)=\\omega_{2}(k)-\\mathrm{i}\\gamma_{2}$。\n    - 频域响应：\n        $$\n        \\overline{E}(\\omega;k)=\\frac{C_{1}(k)}{\\omega-\\Omega_{1}(k)}+\\frac{C_{2}(k)}{\\omega-\\Omega_{2}(k)}\n        $$\n    - 模式-源交叠系数：$C_{1}(k)=1+0.4\\cos(ka)$ 和 $C_{2}(k)=0.7+0.3\\sin(ka)$。\n- **数值冲激响应计算**：\n    $$\n    h(t;k)\\approx\\frac{\\Delta\\omega}{2\\pi}\\sum_{m=0}^{M-1}\\overline{E}(\\omega_{m};k)\\,\\mathrm{e}^{\\mathrm{i}\\omega_{m}t}\n    $$\n- **数值参数**：\n    - 晶胞长度：$a=1$。\n    - 能带参数：$\\omega_{01}=10$, $\\omega_{02}=14$, $J_{1}=3$, $J_{2}=1.5$。\n    - 阻尼率：$\\gamma_{1}=0.1$, $\\gamma_{2}=0.08$。\n    - 频率网格：半宽 $W=40$，从 $-W$ 到 $W$ 有 $M=4096$ 个采样点。\n    - 时间采样：步长 $\\Delta t=0.05$，$N=128$ 个采样点。\n    - 线性预测阶数：$P=2$。\n- **测试用例**：\n    - 情况 1: $k=0$。\n    - 情况 2: $k=\\pi/a$。\n    - 情况 3: $k=(\\pi/2)/a$。\n- **输出规格**：对于每种情况，一个包含两个角频率 $[\\omega_{1}(k),\\omega_{2}(k)]$ 的排序列表，四舍五入到六位小数。最终输出是这些列表的列表。\n\n#### 步骤2：使用提取的给定信息进行验证\n\n- **科学基础**：该问题在计算电磁学和信号处理的原理方面有很好的基础。弗洛凯-布洛赫理论、线性系统的频域分析和谐波反演（Prony方法）都是标准且有效的概念。物理模型是一个简化但具有代表性的案例研究。\n- **适定性**：问题是适定的。它提供了一套完整的参数和一条清晰的算法路径以获得唯一解。数值参数（$M$、$N$、$\\Delta t$、$W$）的选择是适当的，以确保数值结果的稳定性和准确性。对于给定的测试用例，谐振频率 $\\omega_1(k)$ 和 $\\omega_2(k)$ 的分离足以让谐波反演方法区分它们。\n- **客观性**：问题以精确、客观和数学的语言陈述。没有主观或模糊的术语。\n\n#### 步骤3：结论与行动\n\n问题陈述是**有效的**。它在科学上是合理的，自包含的，并且在算法上是明确的。可以进行求解过程。\n\n### 基于原理的解决方案\n\n目标是从人工生成的频域数据中恢复能带结构，即谐振角频率 $\\omega_1(k)$ 和 $\\omega_2(k)$。对于每个指定的波矢 $k$，求解方法遵循一个四步过程。\n\n#### 步骤1：合成频域数据\n\n首先，我们根据提供的双能带模型构建合成的频域响应 $\\overline{E}(\\omega;k)$。对于给定的波矢 $k$，我们计算两个谐振的参数。\n\n谐振频率 $\\omega_{n}(k)$ 由下式给出：\n$$\n\\omega_{1}(k)=\\sqrt{\\omega_{01}^{2}+4J_{1}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)} \\quad \\text{和} \\quad \\omega_{2}(k)=\\sqrt{\\omega_{02}^{2}+4J_{2}\\sin^{2}\\!\\left(\\frac{ka}{2}\\right)}\n$$\n频域中的复极点（包含阻尼）为 $\\Omega_{n}(k)=\\omega_{n}(k)-\\mathrm{i}\\gamma_{n}$：\n$$\n\\Omega_{1}(k) = \\omega_{1}(k)-\\mathrm{i}\\gamma_{1} \\quad \\text{和} \\quad \\Omega_{2}(k) = \\omega_{2}(k)-\\mathrm{i}\\gamma_{2}\n$$\n源耦合系数 $C_{n}(k)$ 为：\n$$\nC_{1}(k)=1+0.4\\cos(ka) \\quad \\text{和} \\quad C_{2}(k)=0.7+0.3\\sin(ka)\n$$\n使用指定的参数（$a=1, \\omega_{01}=10, \\omega_{02}=14, J_{1}=3, J_{2}=1.5, \\gamma_{1}=0.1, \\gamma_{2}=0.08$），我们在一个均匀的角频率网格 $\\omega_m$ 上评估 $\\overline{E}(\\omega;k)$，该网格跨越 $[ -W, W ] = [ -40, 40 ]$，有 $M=4096$ 个点。频率步长为 $\\Delta\\omega = 2W / (M-1)$。\n\n#### 步骤2：计算时域冲激响应\n\n时域冲激响应 $h(t;k)$ 是 $\\overline{E}(\\omega;k)$ 的傅里叶逆变换。我们使用离散和对 $N=128$ 个时间点 $t_n = n\\Delta t$（其中 $\\Delta t=0.05$ 且 $n \\in \\{0, 1, \\dots, N-1\\}$）进行数值近似此积分：\n$$\nh(t_n;k) \\approx \\frac{\\Delta\\omega}{2\\pi}\\sum_{m=0}^{M-1}\\overline{E}(\\omega_{m};k)\\,\\mathrm{e}^{\\mathrm{i}\\omega_{m}t_n}\n$$\n此计算产生一组 $N$ 个复数值的时间样本 $h_n \\equiv h(t_n; k)$。该操作实际上是一个指数矩阵与频率数据向量之间的矩阵-向量乘积。\n\n#### 步骤3：应用谐波反演（线性预测）\n\n时域信号被建模为 $P=2$ 个阻尼复指数的和：\n$$\nh_n = \\sum_{j=1}^{P} A_j z_j^n\n$$\n其中 $z_j = \\mathrm{e}^{\\mathrm{i}\\Omega_j\\Delta t}$ 是z域中的“极点”。这样的信号满足一个 $P$ 阶的线性预测递推关系：\n$$\nh_n = -\\sum_{l=1}^{P} c_l h_{n-l} \\quad \\text{对于 } n \\ge P\n$$\n系数 $c_l$ 通过在最小二乘意义上求解一个超定线性方程组来找到。我们从时间样本 $h_n$ 构建一个矩阵 $\\mathbf{H}$ 和一个向量 $\\mathbf{h}'$：\n$$\n\\mathbf{H} = \\begin{pmatrix}\nh_{P-1}  h_{P-2}  \\dots  h_0 \\\\\nh_{P}  h_{P-1}  \\dots  h_1 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\nh_{N-2}  h_{N-3}  \\dots  h_{N-1-P}\n\\end{pmatrix}, \\quad\n\\mathbf{h}' = \\begin{pmatrix}\nh_P \\\\\nh_{P+1} \\\\\n\\vdots \\\\\nh_{N-1}\n\\end{pmatrix}\n$$\n当 $P=2$ 时，这变为：\n$$\n\\begin{pmatrix}\nh_{1}  h_{0} \\\\\nh_{2}  h_{1} \\\\\n\\vdots  \\vdots \\\\\nh_{N-2}  h_{N-3}\n\\end{pmatrix}\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n= -\n\\begin{pmatrix} h_2 \\\\ h_3 \\\\ \\vdots \\\\ h_{N-1} \\end{pmatrix}\n$$\n我们使用标准的最小二乘求解器求解系统 $\\mathbf{H}\\mathbf{c}=-\\mathbf{h}'$ 以获得系数向量 $\\mathbf{c}=[c_1, c_2, \\dots, c_P]^T$。\n\n#### 步骤4：恢复频率\n\n系数 $c_l$ 定义了一个特征多项式，其根为z域极点 $z_j$：\n$$\nz^P + c_1 z^{P-1} + \\dots + c_P = 0\n$$\n我们找到这个多项式的 $P=2$ 个根 $z_1$ 和 $z_2$。这些根通过定义 $z_j = \\mathrm{e}^{\\mathrm{i}\\Omega_j\\Delta t}$ 与复频率 $\\Omega_j$ 相关联。我们可以反转这种关系来找到 $\\Omega_j$：\n$$\n\\mathrm{i}\\Omega_j\\Delta t = \\ln(z_j) \\implies \\Omega_j = \\frac{-\\mathrm{i}\\ln(z_j)}{\\Delta t}\n$$\n其中 $\\ln$ 是复自然对数。$\\Omega_j$ 的实部是所求的角频率 $\\omega_j = \\mathrm{Re}(\\Omega_j)$。\n\n最后，对于每个测试用例 $k$，我们得到两个频率，然后按升序排序并四舍五入到六位小数，如规范所述。对测试套件中的所有 $k$ 值重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used, as numpy is sufficient.\n\ndef solve():\n    \"\"\"\n    Solves the harmonic inversion problem for a 1D photonic crystal.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # k (wavevector)\n        0.0,\n        np.pi,\n        np.pi / 2.0,\n    ]\n\n    # Define parameters from the problem statement\n    a = 1.0\n    omega_01 = 10.0\n    omega_02 = 14.0\n    J1 = 3.0\n    J2 = 1.5\n    gamma1 = 0.1\n    gamma2 = 0.08\n    \n    W = 40.0\n    M = 4096\n    \n    dt = 0.05\n    N = 128\n    P = 2\n    \n    # Create the frequency and time grids\n    omega_grid = np.linspace(-W, W, M, dtype=np.float64)\n    d_omega = (2 * W) / (M - 1)\n    t_grid = np.arange(N, dtype=np.float64) * dt\n\n    results = []\n    for k in test_cases:\n        # Step 1: Calculate model parameters for the given k\n        omega1_k = np.sqrt(omega_01**2 + 4 * J1 * np.sin(k * a / 2)**2)\n        omega2_k = np.sqrt(omega_02**2 + 4 * J2 * np.sin(k * a / 2)**2)\n        \n        Omega1_k = omega1_k - 1j * gamma1\n        Omega2_k = omega2_k - 1j * gamma2\n        \n        C1_k = 1.0 + 0.4 * np.cos(k * a)\n        C2_k = 0.7 + 0.3 * np.sin(k * a)\n        \n        # Step 2: Generate synthetic frequency-domain data\n        E_bar = C1_k / (omega_grid - Omega1_k) + C2_k / (omega_grid - Omega2_k)\n        \n        # Step 3: Compute time-domain impulse response via numerical inverse Fourier Transform\n        # Vectorized calculation for efficiency\n        exp_matrix = np.exp(1j * np.outer(t_grid, omega_grid))\n        h = (d_omega / (2 * np.pi)) * np.dot(exp_matrix, E_bar)\n\n        # Step 4: Apply harmonic inversion (Prony's Method / Linear Prediction)\n        # Set up the linear system Hc = -h' to find prediction coefficients c\n        \n        # Construct the matrix H of shape (N-P, P)\n        # The j-th column is h[P-1-j : N-1-j]\n        H = np.array([h[P - 1 - j : N - 1 - j] for j in range(P)], dtype=np.complex128).T\n\n        # Construct the vector h' to be predicted\n        h_prime = h[P:N]\n        \n        # Solve the least-squares problem Hc = -h'\n        c, _, _, _ = np.linalg.lstsq(H, -h_prime, rcond=None)\n        \n        # Step 5: Find the roots of the characteristic polynomial z^P + c_1*z^{P-1} + ... = 0\n        poly_coeffs = np.concatenate(([1.0], c))\n        z_roots = np.roots(poly_coeffs)\n        \n        # Step 6: Recover the complex frequencies Ω from the roots z\n        # Ω_j = -i * log(z_j) / Δt\n        Omega_recovered = -1j * np.log(z_roots) / dt\n        \n        # Step 7: Extract real parts (angular frequencies), sort, and round\n        omega_recovered = np.real(Omega_recovered)\n        omega_sorted = np.sort(omega_recovered)\n        omega_rounded = [np.round(val, 6) for val in omega_sorted]\n        \n        results.append(omega_rounded)\n\n    # Final print statement in the exact required format.\n    # e.g., [[val1,val2],[val3,val4]]\n    list_of_strings = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(list_of_strings)}]\")\n\nsolve()\n```", "id": "3308797"}]}