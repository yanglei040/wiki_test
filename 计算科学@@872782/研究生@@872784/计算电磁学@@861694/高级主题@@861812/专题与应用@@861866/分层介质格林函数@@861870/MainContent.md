## 引言
在计算物理学的广阔领域，尤其是在电磁学、声学和弹性力学中，分析波在复杂环境中的传播是一个核心挑战。当环境并非均匀无限，而是由多个平行的介质层构成时——例如[集成电路](@entry_id:265543)中的基板、地球的近地表地层或光学涂层——传统的自由空间解便不再适用。为了解决这一难题，物理学家和工程师们发展出一种强大而优美的数学工具：分层介质[格林函数](@entry_id:147802)（Layered Media Green's function, LGF）。它提供了一个系统性的框架，能够精确描述点源在这些结构化环境中的响应，从而将复杂的[边值问题](@entry_id:193901)转化为更易于处理的形式。本文旨在全面解析分层介质[格林函数](@entry_id:147802)的理论与实践，我们将带领读者踏上一段从基本原理到前沿应用的探索之旅。在接下来的内容中，我们将首先在“原理与机制”一章中，从最基本的[波动方程](@entry_id:139839)出发，逐步构建LGF的数学形式，并揭示其背后深刻的物理图像。随后，在“应用与跨学科联系”一章中，我们将展示LGF如何在天线工程、地球物理乃至[纳米物理学](@entry_id:142247)等多个看似无关的领域中发挥关键作用。最后，通过“动手实践”部分提供的一系列精心设计的问题，您将有机会亲手应用这些理论，将抽象的知识转化为具体的计算能力。

## 原理与机制

在理解了分层介质格林函数在计算电磁学中的核心作用之后，本章将深入探讨其构建、应用和物理解释背后的基本原理与关键机制。我们将从最基础的自由空间标量[格林函数](@entry_id:147802)的[平面波分解](@entry_id:169203)出发，逐步引入介质界面，推导反射和透射的数学描述，并将其推广至任意多层结构。此外，我们还将探讨不同类型的源如何激发特定的波型，并深入剖析谱积分中蕴含的丰富物理现象，如[导波](@entry_id:269489)、表面波和侧向波。最后，我们将分析准[静态极限](@entry_id:262480)，揭示动态波动理论与经典镜像法之间的深刻联系。

### 自由空间格林函数的[谱表示](@entry_id:153219)：Sommerfeld/Weyl 积分

分析分层介质中[电磁场](@entry_id:265881)的第一步是理解源在均匀无限空间（即自由空间）中的辐射行为。在[频域](@entry_id:160070)中，一个位于 $\mathbf{r}'$ 的[点源](@entry_id:196698)所产生的[标量场](@entry_id:151443)由非齐次[亥姆霍兹方程](@entry_id:149977)描述：

$$ (\nabla^2 + k_0^2) G(\mathbf{r}, \mathbf{r}') = -\delta(\mathbf{r}-\mathbf{r}') $$

其中 $G(\mathbf{r}, \mathbf{r}')$ 是标量格林函数，$k_0 = \omega \sqrt{\mu \varepsilon}$ 是介质中的波数，$\delta(\cdot)$ 是狄拉克δ函数。此方程的解必须满足无穷远处的 Sommerfeld 辐射条件，确保波是向外传播的。对于 $e^{-i\omega t}$ 的时间约定，出射波的空间依赖性为 $e^{ik_0 R}$，其中 $R = |\mathbf{r}-\mathbf{r}'|$。在这种情况下，众所周知的解是：

$$ G(\mathbf{r}, \mathbf{r}') = \frac{e^{ik_0 R}}{4\pi R} $$

虽然这个[闭合形式](@entry_id:271343)的解在物理上很直观，但在处理平面分层介质时却不方便，因为它不符合问题的平面[几何对称性](@entry_id:189059)。为了解决这个问题，我们采用一种强大的数学工具——将球面波分解为平面[波的叠加](@entry_id:166456)。这个表示被称为 **Weyl 展开**或 **Sommerfeld 积分**。

该表示可以通过对亥姆霍兹方程进行三维[傅里叶变换](@entry_id:142120)来推导。然而，一个更具启发性的方法是将场表示为在横向 $(x,y)$ 平面上传播的[平面波](@entry_id:189798)的连续谱。这等效于对横向坐标 $(x,y)$ 进行二维[傅里叶逆变换](@entry_id:178300)。通过这种方法，[格林函数](@entry_id:147802)可以表示为一个在横向谱波数 $(k_x, k_y)$ 上积分的形式 [@problem_id:3323149]：

$$ G(\mathbf{r}, \mathbf{r}') = \iint_{\mathbb{R}^2} \frac{1}{(2\pi)^2} \frac{i}{2k_z} e^{i \mathbf{k}_\rho \cdot (\boldsymbol{\rho}-\boldsymbol{\rho}')} e^{i k_z |z-z'|} dk_x dk_y $$

这里，$\mathbf{k}_\rho = k_x \hat{\mathbf{x}} + k_y \hat{\mathbf{y}}$ 是横向波矢量，$\boldsymbol{\rho} = x\hat{\mathbf{x}} + y\hat{\mathbf{y}}$ 是横向位置矢量。$k_z$ 是纵向波数，它不是一个独立的变量，而是通过[色散关系](@entry_id:140395)与 $k_\rho$ 和介质波数 $k_0$ 相关联：

$$ k_z = \sqrt{k_0^2 - k_\rho^2} \quad \text{其中 } k_\rho^2 = k_x^2 + k_y^2 $$

这个积分形式的[格林函数](@entry_id:147802)是后续所有分层介质分析的基石。它将点源的球面波前分解为无限个平面波，每个[平面波](@entry_id:189798)以不同的倾斜角（由 $k_\rho$ 决定）传播。

在上述积分中，$k_z$ 的平方根定义引入了多值性，因此必须谨慎选择其 **支割（branch cut）**。
- 当 $k_\rho  k_0$ 时，$k_z$ 是实数，对应的谱分量是**传播波（propagating waves）**。
- 当 $k_\rho > k_0$ 时，$k_z$ 变为纯虚数，对应的谱分量是**[倏逝波](@entry_id:156713)（evanescent waves）**，它们沿着界面方向传播，但在垂直于界面的方向上呈指数衰减。

为了确保[倏逝波](@entry_id:156713)在远离源平面（$z=z'$）时衰减（物理上的有界性要求），我们必须选择 $k_z$ 的虚部符号。对于 $e^{-i\omega t}$ 的时间约定，正确的选择是 $\operatorname{Im}\{k_z\} \ge 0$。这个选择保证了当 $k_z = i\alpha_z$（其中 $\alpha_z$ 为正实数）时，因子 $e^{ik_z|z-z'|} = e^{-\alpha_z|z-z'|}$ 能够正确地衰减。

### 单一界面的相互作用：TE/TM 分解与菲涅尔反射系数

当源位于两种不同介质的分界面附近时，自由空间格林函数不再适用。每个从源发出的[平面波](@entry_id:189798)分量在界面上都会发生反射和透射。由于平面分层结构的对称性，一个入射的平面波只会反射和透射为具有相同横向波矢量 $\mathbf{k}_\rho$ 的平面波。这极大地简化了分析，因为我们可以独立地处理每个谱分量。

对于一个给定的谱分量 $\mathbf{k}_\rho$，我们可以定义一个**入射平面**，它由 $\mathbf{k}_\rho$ 和界面的法线向量 $\hat{\mathbf{z}}$ 张成。相对于这个平面，[电磁场](@entry_id:265881)可以唯一地分解为两种基本极化：

1.  **[横电波](@entry_id:272638)（Transverse Electric, TE）**：[电场](@entry_id:194326)矢量垂直于入射平面。对于平面分层结构，这意味着 $E_z=0$。
2.  **[横磁波](@entry_id:272148)（Transverse Magnetic, TM）**：[磁场](@entry_id:153296)矢量垂直于入射平面。对于平面分层结构，这意味着 $H_z=0$。

这种分解是正交的，并且在各向同性介质的平面界面上，TE 和 TM 波之间不存在耦合。一个入射的 TE 波只会反射和透射为 TE 波，TM 波同理。

我们可以通过在界面（$z=0$）处施加[电磁场](@entry_id:265881)切向分量连续的边界条件，来推导每个谱分量的反射系数。考虑一个从介质1（$z>0$，特性为 $\varepsilon_1, \mu_1$）入射到介质2（$z0$，特性为 $\varepsilon_2, \mu_2$）的平面波分量。

对于 TM 极化，我们通常使用[磁场](@entry_id:153296)来描述。假设一个向下传播的入射波（空间依赖性为 $e^{i(k_x x - k_{z1} z)}$），其切向[磁场](@entry_id:153296)为 $H_y^{(i)}$。它会在界面产生一个向上反射的波（$e^{i(k_x x + k_{z1} z)}$），其切向[磁场](@entry_id:153296)为 $H_y^{(r)}$，以及一个向下透射的波（$e^{i(k_x x - k_{z2} z)}$），其切向[磁场](@entry_id:153296)为 $H_y^{(t)}$。通过匹配 $z=0$ 处的[切向电场](@entry_id:267195) $E_x$ 和切向[磁场](@entry_id:153296) $H_y$，可以推导出 TM [反射系数](@entry_id:194350) $R_{TM}$ 定义为反射波与入射波的切向[磁场](@entry_id:153296)振幅之比 [@problem_id:3323134]。经过推导，我们得到：

$$ R_{TM}(k_\rho) = \frac{\varepsilon_2 k_{z1} - \varepsilon_1 k_{z2}}{\varepsilon_2 k_{z1} + \varepsilon_1 k_{z2}} $$

类似地，对于 TE 极化，我们可以推导出 TE 反射系数 $R_{TE}$：

$$ R_{TE}(k_\rho) = \frac{\mu_2 k_{z1} - \mu_1 k_{z2}}{\mu_2 k_{z1} + \mu_1 k_{z2}} $$

这里的 $k_{zi} = \sqrt{\omega^2 \mu_i \varepsilon_i - k_\rho^2}$ 是介质 $i$ 中的纵向[波数](@entry_id:172452)。这些在[谱域](@entry_id:755169)中定义的系数是菲涅尔（Fresnel）公式的推广，它们对任意复数[介电常数](@entry_id:146714)和磁导率以及任意（传播或倏逝）的 $k_\rho$ 都成立。

引入 **[波阻抗](@entry_id:276571)（wave impedance）** 或 **波导纳（wave admittance）** 的概念可以使推导更为简洁和富有洞察力 [@problem_id:3323166]。对于沿 $z$ 方向传播的波，TE 和 TM 模式的[波阻抗](@entry_id:276571)（$Z=E_{tan}/H_{tan}$）分别为：

$$ Z_{TE, i} = \frac{\omega \mu_i}{k_{zi}}, \quad Z_{TM, i} = \frac{k_{zi}}{\omega \varepsilon_i} $$

[反射系数](@entry_id:194350)可以优雅地表示为[阻抗失配](@entry_id:261346)的形式：

$$ R(k_\rho) = \frac{Z_2 - Z_1}{Z_2 + Z_1} $$

将 TE 和 TM 的阻抗表达式代入上式，即可得到与前面相同的反射系数公式。

有了反射系数，我们就可以构建半空间中的总格林函数。它由两部分组成：源在均匀介质1中产生的**主场（primary field）**（即自由空间[格林函数](@entry_id:147802)），以及由界面反射产生的**散射场（scattered field）**。散射场可以通过对[主场](@entry_id:153633)的每个平面波分量乘以相应的[反射系数](@entry_id:194350)来构建。因此，对于位于 $z=z'$ 的源，在 $z>0$ 区域的总[格林函数](@entry_id:147802)可以写为 [@problem_id:3312731]：

$$ G(\rho, z; z') = \int_0^\infty \frac{k_\rho}{4\pi i k_{z1}} J_0(k_\rho \rho) \left[ e^{i k_{z1}|z-z'|} + R(k_\rho) e^{i k_{z1}(z+z')} \right] dk_\rho $$

其中 $R(k_\rho)$ 是适用于特定极化（TE 或 TM）或标量问题的[反射系数](@entry_id:194350)。第一项代表来自源的直达波，第二项代表来自界面的反射波，其形式如同一个位于 $z=-z'$ 的“镜像”源。

### 推广至多层介质：[递归算法](@entry_id:636816)

当存在多个平行界面时，例如三层或更多层的结构，直接应用所有边界条件将导致一个庞大而笨拙的[联立方程](@entry_id:193238)组。一个更高效、更具扩展性的方法是采用**[递归算法](@entry_id:636816)**，它借鉴了[传输线理论](@entry_id:271266)的思想 [@problem_id:3323152]。

这个方法的核心思想是，对于每个谱分量 $k_\rho$，我们可以将每层介质视为一段具有特定特征导纳（或阻抗）和[传播常数](@entry_id:272712)的传输线。横向[电场](@entry_id:194326) $E_t$ 类似于电压 $V$，横向[磁场](@entry_id:153296) $H_t$ 类似于电流 $I$。

考虑一个总共 N 层的结构，顶层为半无限空间（层0），底层也为半无限空间（层N）。我们的目标是计算从顶层（层0）看入整个结构的总[反射系数](@entry_id:194350)。

1.  **初始化**：我们从最底部的界面开始，即层 N-1 和半无限底层 N 之间的界面。从层 N-1 看向层 N 的“负载”导纳就是层 N 的特征波导纳 $Y_{load} = Y_N$。

2.  **递归**：然后，我们向上逐层递推。对于第 $i$ 层（厚度为 $d_i$，特征导纳为 $Y_i$），如果已知其下方结构呈现的输入导纳为 $Y_{in}^{(i+1)}$，那么在第 $i$ 层顶部看到的输入导纳 $Y_{in}^{(i)}$ 可以通过传输线导纳变换公式计算：

    $$ Y_{\text{in}}^{(i)} = Y_i \frac{Y_{\text{in}}^{(i+1)} + Y_i \tanh(\gamma_i d_i)}{Y_i + Y_{\text{in}}^{(i+1)} \tanh(\gamma_i d_i)} $$

    其中 $\gamma_i = -i k_{zi}$ 是第 $i$ 层的[传播常数](@entry_id:272712)（对于 $e^{-i\omega t}$ 约定）。我们从 $i = N-1$ 开始，一直递推到 $i=1$。

3.  **终止**：完成递推后，我们得到在最上方界面（层0和层1之间）从层0看到的总输入导纳 $Y_{in}^{(1)}$。

最后，从顶层（层0）看入整个多层结构的总[反射系数](@entry_id:194350)（或称为广义反射系数）就可以简单地通过顶层介质的特征导纳 $Y_0$ 和计算出的总输入导纳 $Y_{in}^{(1)}$ 来计算：

$$ \Gamma(k_\rho) = \frac{Y_0 - Y_{\text{in}}^{(1)}}{Y_0 + Y_{\text{in}}^{(1)}} $$

这个递归方法非常强大，因为无论有多少层，计算的复杂度都只是线性增加。它可以轻松地编程实现，是现代计算电磁学软件中计算分层介质格林函数的核心算法。

### 源的激励：对称性与极化

[格林函数](@entry_id:147802)的最终形式不仅取决于介质结构，还取决于源的特性，特别是其方向和位置。对于矢量场，格林函数是一个[二阶张量](@entry_id:199780)，即**[并矢格林函数](@entry_id:152029)（dyadic Green's function）**。源的朝向决定了它会激发哪种极化（TE、TM 或两者皆有）。

对称性在此起着决定性作用 [@problem_id:3323128]。考虑两种基本的[电偶极子](@entry_id:186870)源：

-   **垂直[电偶极子](@entry_id:186870)（Vertical Electric Dipole, VED）**：偶极矩垂直于分界面，例如 $\mathbf{p} = p_z \hat{\mathbf{z}}$。由于该源关于 $z$ 轴具有[旋转对称](@entry_id:137077)性，它产生的[磁场](@entry_id:153296)线必须是围绕 $z$ 轴的同心圆，即[磁场](@entry_id:153296)只有[方位角](@entry_id:164011)分量 $\mathbf{H} = H_\phi \hat{\boldsymbol{\phi}}$。对于任何一个入射平面（由 $\mathbf{k}_\rho$ 和 $\hat{\mathbf{z}}$ 定义），方位角方向 $\hat{\boldsymbol{\phi}}$ 总是垂直于该平面。根据定义，[磁场](@entry_id:153296)垂直于入射平面的波是 TM 波。因此，**垂直[电偶极子](@entry_id:186870)只激发 TM 模式**。

-   **水平电偶极子（Horizontal Electric Dipole, HED）**：偶极矩平行于分界面，例如 $\mathbf{p} = p_x \hat{\mathbf{x}}$。该源不具备旋转对称性。对于一个任意方向的谱分量 $\mathbf{k}_\rho$，我们可以将源的偶极矩 $\mathbf{p}$ 分解为两个分量：一个平行于 $\mathbf{k}_\rho$（位于入射平面内），另一个垂直于 $\mathbf{k}_\rho$（也即垂直于入射平面）。位于入射平面内的偶极子分量会激发 TM 波，而垂直于入射平面的偶极子分量则会激发 TE 波。因此，**水平电偶极子通常会同时激发 TE 和 TM 模式**。

理解源与模式之间的关系对于正确构建[并矢格林函数](@entry_id:152029)至关重要，因为它决定了在谱积分中需要包含哪些反射系数（$R_{TE}$、$R_{TM}$ 或它们的组合）。

### 谱积分的物理解释：波的种类

Sommerfeld 积分不仅是一个数学构造，它还包含了关于波如何在分层结构中传播的丰富物理信息。为了揭示这些信息，通常需要对复 $k_\rho$ 平面上的积分路径进行变形，并使用留数定理等[复分析](@entry_id:167282)工具。这种分析揭示了总场是不同“波种”的叠加 [@problem_id:3312731]。

-   **空间波（Space Waves）**：这是通过[鞍点法](@entry_id:199098)（saddle point method）评估积分得到的部分，对应于几何光学中的直达波和反射波。在远离源的区域，这部分场以[球面波](@entry_id:200471)的形式衰减。

-   **侧向波（Lateral Waves）**：这些波与谱波数 $k_j$ 处的**支点（branch points）**有关。当源和观察点都靠近一个界面，且该界面的[折射率](@entry_id:168910)低于上层介质时，可能会出现侧向波。物理上，它对应于能量以临界角入射到下层介质，沿着界面传播，然后泄漏回上层介质的路径。侧向波沿界面的衰减比空间波慢（例如，按 $\rho^{-2}$ 而不是 $\rho^{-1}$ 衰减），因此在某些距离上可能成为主导场。

-   **[导波](@entry_id:269489)/表面波（Guided/Surface Waves）**：这些是最重要的[离散谱](@entry_id:150970)贡献，与反射系数 $\Gamma(k_\rho)$ 的**极点（poles）**有关。极点发生的条件是 $\Gamma(k_\rho)$ 的分母为零，例如，对于单界面 TM 波，即 $\varepsilon_2 k_{z1} + \varepsilon_1 k_{z2} = 0$。这个方程被称为**[色散关系](@entry_id:140395)**，它的解 $k_\rho = k_{sw}$ 对应于一个无需外部源激励就能在结构中自持存在的模式，即[导波](@entry_id:269489)。当[留数定理](@entry_id:164878)被应用于 Sommerfeld 积[分时](@entry_id:274419)，这些极点的留数就给出了[导波](@entry_id:269489)场。这些波被束缚在界面或介质层附近，沿着平行于界面的方向传播而几乎没有辐射损失，其场强随远离[波导](@entry_id:198471)结构的距离呈指数衰减。

一个典型的例子是在[介电常数](@entry_id:146714)为正的介质 ($\varepsilon_1 > 0$) 和[介电常数](@entry_id:146714)为负的介质 ($\varepsilon_2  0$, 如等离激元材料) 的界面上支持的 **TM 表面波**，也称为**[表面等离激元](@entry_id:145851)[极化子](@entry_id:191083)（Surface Plasmon Polariton, SPP）**。其[色散关系](@entry_id:140395)可以通过求解[反射系数](@entry_id:194350)的极点条件来精确推导 [@problem_id:3323180]。求解 $\varepsilon_2 \alpha_1 + \varepsilon_1 \alpha_2 = 0$（其中 $\alpha_j = \sqrt{k_\rho^2 - k_j^2}$ 是衰减常数），可得到表面波的[传播常数](@entry_id:272712)：

$$ k_\rho = \omega \sqrt{\mu_0 \frac{\varepsilon_1 \varepsilon_2}{\varepsilon_1 + \varepsilon_2}} $$

这个结果精确地展示了如何从分层介质格林函数的数学结构中提取出关于物理模式的关键信息。

### 准[静态极限](@entry_id:262480)与镜像法

在低频或观察距离远小于波长的极限下（$\omega \to 0$），动态的波动方程退化为静态的拉普拉斯/泊松方程。分层介质格林函数的理论也应与经典的静电**镜像法**相吻合。

考虑一个点电荷 $q$ 位于介质1中距离界面 $h$ 的位置。在准[静态极限](@entry_id:262480)下，其产生的[电势](@entry_id:267554)可以通过在介质2中放置一个[镜像电荷](@entry_id:266998) $q'$ 来计算。通过匹配界面上的[电势](@entry_id:267554)和法向[电位移矢量](@entry_id:197092)连续的边界条件，可以求得[镜像电荷](@entry_id:266998)的强度为 [@problem_id:3323120]：

$$ q' = q \frac{\varepsilon_1 - \varepsilon_2}{\varepsilon_1 + \varepsilon_2} $$

这个经典结果可以从我们更普适的动态理论中推导出来。在准[静态极限](@entry_id:262480)下，相关的谱分量是那些倏逝性极强的波，即 $k_\rho \gg k_i$。在此极限下，纵向[波数](@entry_id:172452)近似为 $k_{zi} \approx i k_\rho$。将此近似代入 TM 反射系数的表达式：

$$ R_{TM}(k_\rho) \approx \frac{\varepsilon_2 (i k_\rho) - \varepsilon_1 (i k_\rho)}{\varepsilon_2 (i k_\rho) + \varepsilon_1 (i k_\rho)} = \frac{\varepsilon_2 - \varepsilon_1}{\varepsilon_2 + \varepsilon_1} $$

这恰好是静电[镜像法](@entry_id:163138)中[电势](@entry_id:267554)的反射系数（注意与[电荷](@entry_id:275494)反射系数的符号关系）。这表明，经典的[镜像法](@entry_id:163138)可以被看作是动态[波动理论](@entry_id:180588)在[近场](@entry_id:269780)、低频极限下的一个特例。同样，对于垂直[电偶极子](@entry_id:186870)，其散射场也可以用一个位于镜像位置的等效偶极子来描述 [@problem_id:3323132]。

更进一步，我们可以量化[准静态近似](@entry_id:264812)的有效性。通过将 $k_{zi}$ 在 $k_i^2/k_\rho^2$ 的小量上进行[泰勒展开](@entry_id:145057)，可以得到对反射系数的**动态修正项**。分析表明，第一个动态修正项与 $\omega^2$ 成正比。通过设定一个可接受的[误差阈值](@entry_id:143069) $\eta$，我们可以确定一个临界频率 $\omega_c$，当工作频率低于此频率时，[准静态近似](@entry_id:264812)是有效的。例如，通过要求在特征尺度为 $h$（例如源的高度）所对应的特征[波数](@entry_id:172452) $k_\rho=1/h$ 处，动态修正项的相对大小小于 $\eta$，可以推导出临界频率 [@problem_id:3323120]：

$$ \omega_c = \frac{1}{h}\sqrt{\frac{\eta}{\mu_0}\left(\frac{1}{\varepsilon_1}+\frac{1}{\varepsilon_2}\right)} $$

这个关系式清晰地揭示了[准静态近似](@entry_id:264812)的有效性是如何依赖于几何尺度（$h$）、材料参数（$\varepsilon_1, \varepsilon_2$）和所需的精度（$\eta$）的。它为在工程应用中何时可以安全地使用更简单的静态模型提供了重要的理论指导。