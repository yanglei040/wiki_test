## 引言
在科学与工程的众多领域，从地球物理勘探到医学成像，我们面临着一类共同的挑战：逆问题。我们通常无法直接测量我们感兴趣的系统参数或状态，而只能通过间接、稀疏且带有噪声的观测数据来反推它们。这类问题本质上常常是“不适定的”，意味着解可能不存在、不唯一，或对数据的微小扰动极其敏感。为了克服这些困难并得到有意义的解，我们需要一个强大而严谨的数学框架。[变分法](@entry_id:163656)，通过将问题转化为一个[优化问题](@entry_id:266749)来求解，为我们提供了核心工具，而这一切的基础，便是构建在无限维函数空间之上的分析理论。

本文旨在系统性地介绍在逆问题和[数据同化](@entry_id:153547)中扮演基石角色的两个核心函数空间：$L^2(\Omega)$ 和 Sobolev 空间 $H^1(\Omega)$。我们的目标是填补从抽象数学定义到实际应用的知识鸿沟，揭示这些空间如何为[不适定问题](@entry_id:182873)的正则化和求解提供理论保障。

为实现这一目标，本文将分为三个章节展开：
- **第一章：原理与机制**，我们将从最基本的定义出发，深入构建[平方可积函数](@entry_id:200316)空间 $L^2(\Omega)$ 和引入导数概念的 Sobolev 空间 $H^1(\Omega)$。我们将探讨它们的希尔伯特空间结构、[弱导数](@entry_id:189356)的概念、边界条件的处理，以及它们之间的嵌入与对偶关系，为后续的应用奠定坚实的理论基础。
- **第二章：应用与跨学科联系**，我们将展示这些抽象的函数空间如何在实践中发挥作用。重点讨论 $L^2$ 和 $H^1$ 正则化在解决逆问题时的不同效果，并通过贝叶斯视角给予解释。此外，我们还将探索它们在图像处理、[偏微分方程控制](@entry_id:165441)以及[流形](@entry_id:153038)与图数据分析等前沿领域的具体应用。
- **第三章：动手实践**，我们将通过一系列精心设计的练习，引导读者将理论知识转化为计算能力。从推导[变分形式](@entry_id:166033)和伴随方程，到理解不同函数空间对优化过程的影响，再到设计高效的数值预条件子，这些实践将帮助您掌握解决实际问题的核心技能。

通过本篇文章的学习，读者将能够理解为何这些[函数空间](@entry_id:143478)是现代计算科学与数据科学的通用语言，并掌握使用它们来分析和解决复杂逆问题的基本方法。让我们首先从第一章开始，深入了解这些[函数空间](@entry_id:143478)的原理与机制。

## 原理与机制

在逆问题和数据同化的研究中，我们寻求从间接和有噪声的观测中推断模型的状态或参数。这些模型的状态（如温度场、流速场或地下介质属性）通常是定义在某个物理域 $\Omega$ 上的函数。为了严谨地构建和求解这些问题，我们需要一个强大的数学框架来处理这些函数。变分法，作为这些领域的核心工具，要求我们能够在函数构成的无限维空间中定义范数（用于[量化误差](@entry_id:196306)或解的大小）、[内积](@entry_id:158127)（用于定义几何结构，如投影和梯度）和导数。本章将系统地介绍两个在逆问题中至关重要的函数空间：$L^2(\Omega)$ 空间和 Sobolev 空间 $H^1(\Omega)$。我们将从基本定义出发，深入探讨它们的结构、性质以及它们之间的关系，揭示它们如何为逆问题的提法、正则化和求解提供坚实的理论基础。

### [平方可积函数](@entry_id:200316)空间：$L^2(\Omega)$

在数据同化中，一个核心任务是使模型的预测尽可能地与观测数据相匹配。最自然和最广泛使用的失配度量是**最小二乘法**，它量化了模型输出与观测数据之间的“能量”或均方误差。这直接引出了对**[平方可积函数](@entry_id:200316) (square-integrable functions)** 的研究，它们构成了 $L^2(\Omega)$ 空间。

#### $L^2(\Omega)$ 空间的构建与 Hilbert 结构

我们首先考虑定义在有界 Lipschitz 域 $\Omega \subset \mathbb{R}^d$ 上的所有[勒贝格可测](@entry_id:192844)函数 $u: \Omega \to \mathbb{R}$。一个函数 $u$ 被称为平方可积的，如果它的平方在 $\Omega$ 上的[勒贝格积分](@entry_id:140189)是有限的，即 $\int_{\Omega} |u(x)|^2 \, dx  \infty$。这个集合，记为 $\mathcal{L}^2(\Omega)$，构成了一个[向量空间](@entry_id:151108)。

然而，我们很快会遇到一个微妙的问题。考虑函数 $u(x)$ 和一个仅在单个点或一个测度为零的集合上与 $u(x)$ 不同的函数 $v(x)$。尽管这两个函数在点态意义上是不同的，但它们的差值 $|u(x) - v(x)|^2$ 在积分意义下是不可见的。具体而言，一个[非负可测函数](@entry_id:192146)的积分为零，当且仅当该函数几乎处处 (almost everywhere, a.e.) 为零。这直接导致了一个关键等价关系 [@problem_id:3383661]：
$$ \int_{\Omega} |u(x) - v(x)|^2 \, dx = 0 \quad \iff \quad u(x) = v(x) \quad \text{a.e. on } \Omega $$
这意味着，如果我们试图用 $\left( \int_{\Omega} |u|^2 \, dx \right)^{1/2}$ 来定义一个范数，那么任何[几乎处处](@entry_id:146631)为零的非零函数（例如，仅在单个点上非零的函数）的“范数”都将为零，这违反了范数的[正定性](@entry_id:149643)公理。

为了解决这个问题，我们引入**[等价类](@entry_id:156032) (equivalence classes)** 的概念。我们将所有[几乎处处相等](@entry_id:267606)的函数视为同一个元素。形式上，$L^2(\Omega)$ 空间是通过对 $\mathcal{L}^2(\Omega)$ 进行商运算得到的，其等价关系是 $u \sim v$ 当且仅当 $u=v$ 几乎处处。$L^2(\Omega)$ 的每个元素不再是单个函数，而是一个函数集合，其中任意两个函数都[几乎处处相等](@entry_id:267606)。[@problem_id:3383661]

在这个商空间上，我们可以定义一个[内积](@entry_id:158127)，它对于[等价类](@entry_id:156032)中的代表元选择是明确的。对于任意两个等价类 $[u], [v] \in L^2(\Omega)$，其[内积](@entry_id:158127)定义为：
$$ \langle [u], [v] \rangle_{L^2(\Omega)} = \int_{\Omega} u(x)v(x) \, dx $$
其中 $u$ 和 $v$ 分别是 $[u]$ 和 $[v]$ 中的任意代表函数。由于改变代表元只会改变被积函数在一个测度为零的集合上的值，而这不影响[勒贝格积分](@entry_id:140189)的结果，所以这个[内积](@entry_id:158127)是**良定义的 (well-defined)**。例如，在[变分数据同化](@entry_id:756439)中，一个形如 $J(u) = \frac{1}{2}\int_{\Omega} |H u(x) - y(x)|^{2}\,dx$ 的最小二乘目标泛函，其值仅依赖于函数 $u$ 和 $y$ 的[等价类](@entry_id:156032)，而不会因为在[零测集](@entry_id:157694)上改变它们的值而改变，前提是算子 $H$ 是 $L^2$ 空间上的有界（连续）线性算子。[@problem_id:3383661]

由该[内积诱导的范数](@entry_id:201671)为 **$L^2$ 范数**：
$$ \|u\|_{L^2(\Omega)} = \sqrt{\langle u, u \rangle_{L^2(\Omega)}} = \left( \int_{\Omega} |u(x)|^2 \, dx \right)^{1/2} $$
一个关键性质是**柯西-施瓦茨不等式 (Cauchy-Schwarz inequality)**，它对所有 $u,v \in L^2(\Omega)$ 成立：
$$ |\langle u, v \rangle_{L^2(\Omega)}| \le \|u\|_{L^2(\Omega)} \|v\|_{L^2(\Omega)} $$
这个不等式保证了[内积](@entry_id:158127)的连续性，并且是许多估计和[收敛性分析](@entry_id:151547)的基石。一个简洁的证明是考虑关于实数 $t$ 的二次多项式 $q(t) = \|u+tv\|_{L^2(\Omega)}^2$。由于范数的非负性，$q(t) \ge 0$ 对所有 $t$ 成立。展开 $q(t)$ 得到：
$$ q(t) = \|u\|_{L^2}^2 + 2t\langle u, v \rangle_{L^2} + t^2\|v\|_{L^2}^2 $$
一个恒为非负的二次多项式，其判别式必定非正，即 $(2\langle u, v \rangle_{L^2})^2 - 4\|v\|_{L^2}^2 \|u\|_{L^2}^2 \le 0$，整理后即得柯西-施瓦茨不等式。这个证明不依赖于域 $\Omega$ 的有界性或[函数的连续性](@entry_id:193744)，仅依赖于[内积](@entry_id:158127)的公理。[@problem_id:3383696]

根据 Riesz-Fischer 定理，$L^2(\Omega)$ 空间在其范数下是完备的。一个完备的[内积空间](@entry_id:271570)被称为**希尔伯特空间 (Hilbert space)**。$L^2(\Omega)$ 的[希尔伯特空间](@entry_id:261193)结构是其在[逆问题](@entry_id:143129)中如此核心的原因之一，因为它提供了丰富的几何工具，如正交性、投影和梯度的高效计算。

#### $L^2$ 在 $L^p$ 空间中的特殊地位

$L^2$ 空间是一类更广泛的 $L^p(\Omega)$ 空间（$1 \le p \le \infty$）的一个特例，其范数为 $\|u\|_{L^p} = (\int_\Omega |u|^p dx)^{1/p}$。然而，在所有这些 $L^p$ 空间中，只有 $L^2$ 是希尔伯特空间（在无限维情况下）。这个结论可以通过**[平行四边形法则](@entry_id:154297) (parallelogram law)** 来阐明 [@problem_id:3383658]：
$$ \|x+y\|^2 + \|x-y\|^2 = 2(\|x\|^2 + \|y\|^2) $$
Jordan-[von Neumann 定理](@entry_id:273126)指出，一个[赋范空间](@entry_id:137032)是[内积空间](@entry_id:271570)（即其范数由一个[内积](@entry_id:158127)诱导），当且仅当其范数满足[平行四边形法则](@entry_id:154297)。我们可以证明，对于 $p \neq 2$，$L^p$ 范数不满足此法则。例如，考虑 $\Omega$ 中两个不交的、测度为正的[子集](@entry_id:261956) $E_1$ 和 $E_2$，并令 $f = \chi_{E_1}$ 和 $g = \chi_{E_2}$ 为它们的特征函数。经过归一化使 $\|f\|_{L^p} = \|g\|_{L^p} = 1$。由于它们支撑集不交，我们有 $\|f+g\|_{L^p} = 2^{1/p}$ 和 $\|f-g\|_{L^p} = 2^{1/p}$。代入[平行四边形法则](@entry_id:154297)，左边是 $2 \cdot (2^{1/p})^2 = 2^{1+2/p}$，右边是 $2(1^2+1^2) = 4 = 2^2$。等式成立的条件是 $1+2/p = 2$，即 $p=2$。

这一独特性质至关重要。在希尔伯特空间（如 $L^2$）中，**Riesz [表示定理](@entry_id:637872) (Riesz representation theorem)** 保证了空间的对偶空间 $H'$ 中的每一个[连续线性泛函](@entry_id:262913) $\ell$ 都唯一对应于空间 $H$ 中的一个元素 $w$，使得 $\ell(v) = \langle w, v \rangle_H$。这使得我们可以将泛函的导数（梯度）识别为原空间中的一个元素。例如，在 $L^2$ 中，目标泛函的梯度可以方便地通过 $L^2$ [内积](@entry_id:158127)表示。而在非希尔伯特空间的巴拿赫空间 $L^p(\Omega)$ ($p \neq 2$) 中，其[对偶空间](@entry_id:146945)是 $L^{p'}(\Omega)$（其中 $1/p + 1/p' = 1$），与原空间不同。梯度自然地存在于对偶空间中，并且它与原空间中元素的对应关系是通过一个[非线性](@entry_id:637147)的对偶映射，这使得优化过程的几何结构变得更为复杂。[@problem_id:3383658]

### 包含导数的空间：Sobolev 空间 $H^1(\Omega)$

$L^2$ 空间对于度量函数的大小非常有效，但它无法区分函数的光滑程度。一个处处光滑的函数和一个高度[振荡](@entry_id:267781)的函数可以有相同的 $L^2$ 范数。然而，许多物理模型（如[热传导](@entry_id:147831)、弹性力学）由[偏微分方程](@entry_id:141332)描述，这些方程涉及函数的导数。为了在[弱解](@entry_id:161732)的框架下处理这些模型，并为了在正则化中惩罚解的“粗糙度”，我们需要引入能够处理导数的函数空间。

#### [弱导数](@entry_id:189356)与 $H^1(\Omega)$ 的定义

经典导数只对足够光滑的函数有定义。为了将其推广到 $L^2$ 中的函数，我们使用**[弱导数](@entry_id:189356) (weak derivative)** 的概念。这个概念源于[分部积分公式](@entry_id:145262)。对于一个[光滑函数](@entry_id:267124) $u$ 和一个在 $\Omega$ 内部[紧支撑](@entry_id:276214)的光滑“测试函数” $\varphi$ (即 $\varphi \in C_c^\infty(\Omega)$)，[分部积分公式](@entry_id:145262)给出：
$$ \int_{\Omega} \frac{\partial u}{\partial x_i}(x) \varphi(x) \, dx = - \int_{\Omega} u(x) \frac{\partial \varphi}{\partial x_i}(x) \, dx $$
我们可以把这个公式反过来，将其作为导数的定义。对于一个局部可积的函数 $u \in L^1_{\text{loc}}(\Omega)$，如果存在一个函数 $g_i \in L^1_{\text{loc}}(\Omega)$ 使得对所有测试函数 $\varphi \in C_c^\infty(\Omega)$ 都成立：
$$ \int_{\Omega} g_i(x) \varphi(x) \, dx = - \int_{\Omega} u(x) \frac{\partial \varphi}{\partial x_i}(x) \, dx $$
那么我们就称 $g_i$ 是 $u$ 关于 $x_i$ 的**[弱导数](@entry_id:189356)**，并记作 $\partial_{x_i} u$ 或 $\frac{\partial u}{\partial x_i}$。这个定义通过将导数的作用转移到光滑的测试函数上，从而避免了对 $u$ 本身进行[微分](@entry_id:158718)。[@problem_id:3383704]

基于[弱导数](@entry_id:189356)的概念，我们现在可以定义一阶 **Sobolev 空间 $H^1(\Omega)$**。它由所有自身属于 $L^2(\Omega)$ 且其所有一阶[弱导数](@entry_id:189356)也属于 $L^2(\Omega)$ 的函数构成 [@problem_id:3383704]：
$$ H^1(\Omega) = \{ u \in L^2(\Omega) : \nabla u \in (L^2(\Omega))^d \} $$
其中 $\nabla u = (\partial_{x_1} u, \dots, \partial_{x_d} u)$ 是[弱梯度](@entry_id:756667)。$H^1(\Omega)$ 同样是一个[希尔伯特空间](@entry_id:261193)，其标准[内积](@entry_id:158127)和范数定义为：
$$ \langle u, v \rangle_{H^1(\Omega)} = \int_{\Omega} (u(x)v(x) + \nabla u(x) \cdot \nabla v(x)) \, dx $$
$$ \|u\|_{H^1(\Omega)}^2 = \|u\|_{L^2(\Omega)}^2 + \|\nabla u\|_{L^2(\Omega)}^2 = \int_{\Omega} (|u(x)|^2 + |\nabla u(x)|^2) \, dx $$
在许多应用中，例如 Tikhonov 正则化，这个范数的平方 $\frac{\alpha}{2}\|u\|_{H^1(\Omega)}^2$ 被用作正则化项，因为它同时惩罚了函数的大小（$L^2$ 范数）和它的[振荡](@entry_id:267781)程度（梯度的 $L^2$ 范数），从而偏好更光滑、更稳定的解。这个正则化项使得目标泛函在 $H^1(\Omega)$ 空间中是严格凸和强制的，从而保证了唯一稳定解的存在性。[@problem_id:3383658] [@problem_id:3383704] [@problem_id:3383714]

### 边界条件的处理：$H_0^1(\Omega)$ 与[迹算子](@entry_id:183665)

[偏微分方程](@entry_id:141332)的解通常需要满足特定的边界条件。在 Sobolev 空间的弱提法框架下，处理边界条件是一个核心问题，因为函数在边界（一个零测集）上的点态值是没有明确定义的。

#### 齐次 Dirichlet 条件与 $H_0^1(\Omega)$

处理形如 $u=0$ on $\partial\Omega$ 的**齐次 Dirichlet 边界条件**的最直接方法是将被积空间限制在一个特殊的[子空间](@entry_id:150286)中。我们定义 $H_0^1(\Omega)$ 为[紧支撑](@entry_id:276214)光滑函数空间 $C_c^\infty(\Omega)$ 在 $H^1(\Omega)$ 范数下的闭包。[@problem_id:3383703]

直观上，$H_0^1(\Omega)$ 中的函数在边界上“衰减为零”。因为 $C_c^\infty(\Omega)$ 中的每个函数都在远离边界的某个紧集之外为零，所以它们的极限也继承了这种在边界处为零的性质，尽管是在一种广义的、非点态的意义上。在有界域上，$H_0^1(\Omega)$ 是 $H^1(\Omega)$ 的一个真[闭子空间](@entry_id:267213)，这意味着并非所有 $H^1$ 函数都在边界上为零。例如，常数函数 $u(x)=1$ 属于 $H^1(\Omega)$ 但不属于 $H_0^1(\Omega)$。[@problem_id:3383703]

当求解一个带有齐次 Dirichlet 边界条件的 PDE 时，我们寻找一个解 $u \in H_0^1(\Omega)$ 并使用来自同一空间的测试函数 $v \in H_0^1(\Omega)$。通过将解空间限制在 $H_0^1(\Omega)$，我们以一种“本质”的方式强加了边界条件。这种方法在最优控制和[逆问题](@entry_id:143129)中同样适用，[状态变量](@entry_id:138790)和伴随变量都自然地属于 $H_0^1(\Omega)$，从而确保了它们都满足齐次 Dirichlet 条件。[@problem_id:3383703]

#### [迹算子](@entry_id:183665)与一般边界条件

对于非齐次的边界条件，或者当我们想在边界上进行观测时，我们需要一个更通用的工具来描述 $H^1$ 函数在边界 $\partial\Omega$ 上的行为。这个工具就是**[迹算子](@entry_id:183665) (trace operator)**。

**[迹定理](@entry_id:203967) (Trace Theorem)** 是 Sobolev 空间理论的一个基石。它指出，对于一个足够正则的域（例如，有界 Lipschitz 域），存在一个唯一的[有界线性算子](@entry_id:180446) $\mathrm{Tr}: H^1(\Omega) \to L^2(\partial\Omega)$，它将光滑函数在边界上的限制操作连续地推广到整个 $H^1(\Omega)$ 空间。更精确地，该算子的值域实际上是一个比 $L^2(\partial\Omega)$ 更小的分数阶 Sobolev 空间 $H^{1/2}(\partial\Omega)$。[@problem_id:3383680]

[迹算子](@entry_id:183665)的关键性质包括 [@problem_id:3383680]：
1.  **有界性**：存在一个常数 $C$ 使得 $\|\mathrm{Tr}(u)\|_{H^{1/2}(\partial\Omega)} \le C \|u\|_{H^1(\Omega)}$。这意味着从内部的 $H^1$ 控制可以推出边界值的 $H^{1/2}$ 控制。
2.  **满射性**：对于 Lipschitz 域，[迹算子](@entry_id:183665)是满射的。这意味着任何一个足够好的边界函数 $g \in H^{1/2}(\partial\Omega)$ 都可以是某个内部函数 $u \in H^1(\Omega)$ 的迹，即 $\mathrm{Tr}(u) = g$。
3.  **与 $H_0^1(\Omega)$ 的关系**：[迹算子](@entry_id:183665)为我们提供了 $H_0^1(\Omega)$ 的另一个等价定义：$H_0^1(\Omega)$ 正是迹[算子的核](@entry_id:272757) (kernel)，即 $H_0^1(\Omega) = \{u \in H^1(\Omega) : \mathrm{Tr}(u) = 0\}$。[@problem_id:3383703]

在[变分法](@entry_id:163656)中，边界条件分为两类。**本质边界条件 (Essential boundary conditions)**，如 Dirichlet 条件，是通过限制解所属的[函数空间](@entry_id:143478)（例如 $H_0^1(\Omega)$）来强加的。而**自然边界条件 (Natural boundary conditions)**，如 Neumann 条件 ($\frac{\partial u}{\partial n}=0$)，则是从没有边界限制的变分原理（例如在整个 $H^1(\Omega)$ 空间上最小化泛函）中自然产生的。如果在[变分方程](@entry_id:635018)的推导中（通过[分部积分](@entry_id:136350)）出现了边界项，而我们又没有对测试函数的边界值做任何限制，那么为了让方程对所有测试函数成立，该边界项必须为零，这就产生了自然边界条件。[@problem_id:3383704]

### 空间之间的关系：嵌入与对偶

[函数空间](@entry_id:143478)理论的强大之处不仅在于单个空间的性质，更在于它们之间的相互关系。这些关系，主要通过嵌入和对偶来描述，对于理解解的正则性以及严谨地处理不同类型的项（如数据、[源项](@entry_id:269111)）至关重要。

#### Sobolev [嵌入定理](@entry_id:150872)：从[可积性](@entry_id:142415)到连续性

**Sobolev [嵌入定理](@entry_id:150872) (Sobolev Embedding Theorems)** 描述了 $H^1(\Omega)$ 中的函数在可积性或连续性方面的性质。它们表明，拥有 $L^2$ 可积的[弱导数](@entry_id:189356)这一性质，可以蕴含比仅仅 $L^2$ 可积更强的正则性，而这种正则性的提升程度依赖于空间的维数 $d$。[@problem_id:3383692]

-   **当 $d=1$ 时 ($H^1(a,b)$)**：嵌入效果最强。$H^1(a,b)$ 中的每个函数（的[等价类](@entry_id:156032)）都有一个连续代表元，并且这个代表元是 $\frac{1}{2}$-Hölder 连续的。即 $H^1(\Omega) \hookrightarrow C^{0,1/2}(\overline{\Omega})$。一个直接的推论是，在一点上的求值运算 $u \mapsto u(x_0)$ 是一个 $H^1$ 上的[连续线性泛函](@entry_id:262913)。这使得点态观测在以为一维空间变量的模型中是数学上良定义的。

-   **当 $d=2$ 时**：嵌入效果居中。$H^1(\Omega)$ 可以连续地嵌入到任何 $L^q(\Omega)$ 空间，其中 $q$ 为任意有限的正常数 ($1 \le q  \infty$)。然而，它不能嵌入到 $L^\infty(\Omega)$ 或 $C^0(\overline{\Omega})$（连续函数空间）。这意味着二维 $H^1$ 函数不一定是连续的，甚至不一定是有界的（例如，对数[奇点](@entry_id:137764)函数）。因此，点态观测在二维问题中通常是病态的。

-   **当 $d > 2$ 时**：嵌入效果最弱。$H^1(\Omega)$ 连续地嵌入到 $L^{2^*}(\Omega)$，其中 $2^* = \frac{2d}{d-2}$ 是临界 Sobolev 指数。这意味着函数的 $L^p$ [可积性](@entry_id:142415)得到了改善，但改善是有限的。

除了连续性，**[Rellich-Kondrachov](@entry_id:140267) 紧性定理** 还告诉我们何时嵌入是**紧的 (compact)**。[紧嵌入](@entry_id:263276)意味着，从源空间（如 $H^1$）中的[有界序列](@entry_id:161392)中，我们可以在目标空间（如 $L^q$）中提取出一个强收敛的子序列。这个性质在证明[非线性](@entry_id:637147)或非凸问题的解的存在性时至关重要。对于有界 Lipschitz 域，嵌入 $H^1(\Omega) \hookrightarrow L^q(\Omega)$ 是紧的，当 $q$ 小于临界指数时，即 $1 \le q  2^*$。[@problem_id:3383692]

#### 对偶性与 Gelfand 三元组

对偶性是现代[泛函分析](@entry_id:146220)的核心概念，它允许我们以一种优雅的方式处理[微分](@entry_id:158718)和线性方程。

**Riesz [表示定理](@entry_id:637872)**告诉我们，任何希尔伯特空间 $H$ 都可以通过其[内积](@entry_id:158127)与其[对偶空间](@entry_id:146945) $H'$ 等同起来。这意味着 $H$ 中的每个元素 $u$ 都对应于 $H'$ 中的一个泛函 $\ell_u$，其作用方式为 $\ell_u(v) = \langle u, v \rangle_H$。[@problem_id:3383701]

-   对于 $L^2(\Omega)$，这个等同关系是 $L^2(\Omega)' \cong L^2(\Omega)$，通过 $L^2$ [内积](@entry_id:158127)实现。
-   对于 $H_0^1(\Omega)$，我们可以使用不同的[内积](@entry_id:158127)来建立等同关系。如果我们使用标准的 $H^1$ [内积](@entry_id:158127)，那么 $H_0^1(\Omega)' \cong H_0^1(\Omega)$。一个特别有用的选择是仅使用梯度[内积](@entry_id:158127) $\langle u, v \rangle_{H_0^1} = \int_\Omega \nabla u \cdot \nabla v \, dx$（由于 Poincaré 不等式，这在 $H_0^1(\Omega)$ 上是一个等价[内积](@entry_id:158127)）。在这种情况下，Riesz [表示定理](@entry_id:637872)的逆映射，即从[对偶空间](@entry_id:146945) $H^{-1}(\Omega) := H_0^1(\Omega)'$ 到 $H_0^1(\Omega)$ 的映射，恰好是 Dirichlet-Poisson 问题 $(-\Delta u = f)$ 的解算子。[@problem_id:3383701]

这种对偶结构在所谓的 **Gelfand 三元组 (Gelfand triple)** 中得到了最清晰的体现：
$$ H_0^1(\Omega) \hookrightarrow L^2(\Omega) \hookrightarrow H^{-1}(\Omega) $$
这个结构中，$L^2(\Omega)$ 被选为“枢轴空间”并与其自身对偶等同。左边的嵌入 $H_0^1(\Omega) \hookrightarrow L^2(\Omega)$ 是连续且稠密的。右边的嵌入 $L^2(\Omega) \hookrightarrow H^{-1}(\Omega)$ 则通过将 $L^2$ 函数 $f$ 等同于 $H_0^1(\Omega)$ 上的一个[连续线性泛函](@entry_id:262913)来定义，该泛函的作用是 $v \mapsto \int_\Omega fv \, dx$。这个嵌入也是连续且稠密的。[@problem_id:3383656]

Gelfand 三元组的意义在于，它为[变分方程](@entry_id:635018)中的不同项提供了统一的框架。例如，在一个形如 $-\Delta u = f$ 的方程中，我们寻求解 $u \in H_0^1(\Omega)$。算子 $-\Delta$ 自然地将 $H_0^1(\Omega)$ 映射到其[对偶空间](@entry_id:146945) $H^{-1}(\Omega)$。Gelfand 三元组告诉我们，即使源项 $f$ 仅仅是一个 $L^2$ 函数，我们也可以严谨地将其视为 $H^{-1}(\Omega)$ 中的一个元素。这使得[弱形式](@entry_id:142897)方程 $\langle -\Delta u, v \rangle = \langle f, v \rangle$ 在数学上是协调的。在数据同化中，这意味着 $L^2$ 形式的观测失配项（例如，与 $L^2$ 数据作比较）在欧拉-拉格朗日方程中自然地表现为对偶空间 $H^{-1}(\Omega)$ 中的元素，即所谓的梯度或残差。[@problem_id:3383656]

综上所述，$L^2$ 和 $H^1$ 空间为逆问题和[数据同化](@entry_id:153547)中的[变分方法](@entry_id:163656)提供了基础语言和分析工具。$L^2$ 的 Hilbert 结构提供了简单明了的几何性质，而 $H^1$ 则允许我们严谨地处理导数和施加正则性。它们之间的嵌入关系揭示了解的[光滑性](@entry_id:634843)，而[对偶理论](@entry_id:143133)和 Gelfand 三元组则为构建和解释[变分方程](@entry_id:635018)提供了坚实的框架。