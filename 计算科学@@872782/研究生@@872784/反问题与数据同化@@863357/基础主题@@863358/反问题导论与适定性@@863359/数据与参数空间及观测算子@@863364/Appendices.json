{"hands_on_practices": [{"introduction": "反问题的稳定性是其核心性质，它决定了解对观测数据中不可避免的噪声的敏感度。对于线性反问题，这种稳定性可以通过将解映射的利普希茨常数与观测算子 $\\mathcal{O}$ 的谱特性联系起来进行量化。本练习 [@problem_id:3374182] 将指导您从第一性原理出发，推导出问题的稳定性如何由 $\\mathcal{O}$ 的最小非零奇异值决定，从而将抽象的算子范数概念与一个可计算的量联系起来。通过为一个具体的数值例子计算这个稳定性界限，您将获得把理论和实际计算联系起来的实践经验。", "problem": "考虑一个线性逆问题，其参数空间为 $\\mathbb{R}^{n}$，数据空间为 $\\mathbb{R}^{m}$，并有线性观测算子 $\\mathcal{O} \\in \\mathbb{R}^{m \\times n}$。观测被建模为 $y = \\mathcal{O} x$，其中 $x \\in \\mathbb{R}^{n}$ 且 $y \\in \\mathbb{R}^{m}$。假设 $\\mathcal{O}$ 具有满列秩，因此由最小二乘解定义的数据到参数的映射是唯一的，并由 Moore–Penrose 伪逆 $\\mathcal{O}^{+}$ 给出。在两个空间上均使用欧几里得 2-范数，将逆问题的稳定性定义为映射 $y \\mapsto x^{\\star}(y)$ 的 Lipschitz 连续性，其中 $x^{\\star}(y) = \\mathcal{O}^{+} y$，即存在一个常数 $C  0$ 使得对于所有 $y_{1}, y_{2} \\in \\mathbb{R}^{m}$，都有 $\\|x^{\\star}(y_{1}) - x^{\\star}(y_{2})\\|_{2} \\leq C \\|y_{1} - y_{2}\\|_{2}$。\n\n仅从算子范数、奇异值分解 (SVD) 和 Moore–Penrose 伪逆的基本定义出发，推导最紧的上界常数 $C$，并用 $\\mathcal{O}$ 的内蕴谱性质来表示。然后，对于特定的观测算子\n$$\n\\mathcal{O} \\;=\\; \\begin{pmatrix}\n3  1 \\\\\n0  2 \\\\\n1  1\n\\end{pmatrix},\n$$\n计算映射 $y \\mapsto \\mathcal{O}^{+} y$ 的最优稳定性常数 $C$ 的精确值。你的最终答案必须是单一的闭式表达式。如果使用数值近似，将答案四舍五入到四位有效数字；否则提供精确的解析形式。无需单位。", "solution": "所述问题需进行验证。\n\n**问题验证**\n\n**步骤1：提取的已知条件**\n- 参数空间: $\\mathbb{R}^{n}$。\n- 数据空间: $\\mathbb{R}^{m}$。\n- 观测模型: $y = \\mathcal{O} x$，其中 $\\mathcal{O} \\in \\mathbb{R}^{m \\times n}$ 是一个线性算子，$x \\in \\mathbb{R}^{n}$，$y \\in \\mathbb{R}^{m}$。\n- 假设：算子 $\\mathcal{O}$ 具有满列秩。\n- 解映射：最小二乘解由 $x^{\\star}(y) = \\mathcal{O}^{+} y$ 给出，其中 $\\mathcal{O}^{+}$ 是 Moore–Penrose 伪逆。\n- 范数：对于 $\\mathbb{R}^{n}$ 和 $\\mathbb{R}^{m}$ 均使用欧几里得 2-范数 $\\|\\cdot\\|_{2}$。\n- 稳定性定义：映射 $y \\mapsto x^{\\star}(y)$ 是 Lipschitz 连续的，满足 $\\|x^{\\star}(y_{1}) - x^{\\star}(y_{2})\\|_{2} \\leq C \\|y_{1} - y_{2}\\|_{2}$，其中常数 $C  0$。\n- 目标1：从算子范数、SVD 和 Moore–Penrose 伪逆的定义出发，推导最紧常数 $C$，并用 $\\mathcal{O}$ 的谱性质表示。\n- 目标2：对于特定算子 $\\mathcal{O} = \\begin{pmatrix} 3  1 \\\\ 0  2 \\\\ 1  1 \\end{pmatrix}$，计算此最优稳定性常数 $C$ 的精确值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了线性代数和逆问题理论（SVD、Moore-Penrose 伪逆、算子范数）中的标准且定义明确的概念。这是一个适定问题，要求推导一个特定的数学常数，该常数是一个唯一且有意义的值。语言客观而精确。设置是完整且一致的；给定的矩阵 $\\mathcal{O}$ 是一个 $3 \\times 2$ 矩阵，其列向量 $\\begin{pmatrix} 3 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 和 $\\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}$ 是线性无关的，证实了它具有满列秩 ($n=2$)，与假设相符。该问题是应用线性代数中的一个标准的、非平凡的练习，并且可以进行直接的数学验证。\n\n**步骤3：结论与行动**\n问题有效。将提供一个完整的解。\n\n**最优稳定性常数的推导**\n\n逆问题的稳定性由映射 $y \\mapsto x^{\\star}(y)$ 的 Lipschitz 连续性来刻画。该条件由下式给出\n$$\n\\|x^{\\star}(y_{1}) - x^{\\star}(y_{2})\\|_{2} \\leq C \\|y_{1} - y_{2}\\|_{2}\n$$\n对于所有 $y_{1}, y_{2} \\in \\mathbb{R}^{m}$。代入定义 $x^{\\star}(y) = \\mathcal{O}^{+} y$ 并利用伪逆算子 $\\mathcal{O}^{+}$ 的线性性质，我们得到\n$$\n\\|\\mathcal{O}^{+} y_{1} - \\mathcal{O}^{+} y_{2}\\|_{2} = \\|\\mathcal{O}^{+}(y_{1} - y_{2})\\|_{2} \\leq C \\|y_{1} - y_{2}\\|_{2}.\n$$\n令 $z = y_{1} - y_{2}$。由于 $y_{1}$ 和 $y_{2}$ 可以是 $\\mathbb{R}^{m}$ 中的任意向量，因此 $z$ 也可以是 $\\mathbb{R}^{m}$ 中的任意向量。不等式变为\n$$\n\\|\\mathcal{O}^{+} z\\|_{2} \\leq C \\|z\\|_{2}\n$$\n对于所有 $z \\in \\mathbb{R}^{m}$。根据定义，对于所有非零 $z$ 都满足此不等式的最紧常数 $C$ 是由欧几里得 2-范数诱导的 $\\mathcal{O}^{+}$ 的算子范数：\n$$\nC = \\sup_{z \\neq 0} \\frac{\\|\\mathcal{O}^{+} z\\|_{2}}{\\|z\\|_{2}} = \\|\\mathcal{O}^{+}\\|_{2}.\n$$\n矩阵的算子 2-范数等于其最大奇异值。为了找到 $\\mathcal{O}^{+}$ 的奇异值，我们首先考虑算子 $\\mathcal{O}$ 的奇异值分解 (SVD)。对于 $\\mathcal{O} \\in \\mathbb{R}^{m \\times n}$，其 SVD 由下式给出\n$$\n\\mathcal{O} = U \\Sigma V^T,\n$$\n其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个包含 $\\mathcal{O}$ 的奇异值的矩形对角矩阵。设 $\\mathcal{O}$ 的秩为 $r$。奇异值 $\\sigma_{i}$ 按 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\dots \\ge \\sigma_{r}  0$ 的顺序排列，其余的 $n-r$ 个奇异值为零（如果 $m \\ge n$）。\n\nMoore-Penrose 伪逆 $\\mathcal{O}^{+}$ 由 SVD 定义为\n$$\n\\mathcal{O}^{+} = V \\Sigma^{+} U^T,\n$$\n其中 $\\Sigma^{+} \\in \\mathbb{R}^{n \\times m}$ 是 $\\Sigma$ 的伪逆。如果 $\\Sigma$ 的形式为 $\\begin{pmatrix} D  0 \\\\ 0  0 \\end{pmatrix}$，其中 $D = \\text{diag}(\\sigma_{1}, \\dots, \\sigma_{r})$，那么 $\\Sigma^{+}$ 的形式为 $\\begin{pmatrix} D^{-1}  0 \\\\ 0  0 \\end{pmatrix}$，其中 $D^{-1} = \\text{diag}(1/\\sigma_{1}, \\dots, 1/\\sigma_{r})$。\n\n$\\mathcal{O}^{+}$ 的奇异值是 $\\Sigma^{+}$ 的非零对角元，即 $\\mathcal{O}$ 的非零奇异值的倒数。具体来说，$\\mathcal{O}^{+}$ 的奇异值为 $\\{1/\\sigma_{r}, \\dots, 1/\\sigma_{1}\\}$。\n\n因此，$\\mathcal{O}^{+}$ 的最大奇异值是 $1/\\sigma_{r}$，即 $\\mathcal{O}$ 的最小非零奇异值的倒数。我们将这个最小非零奇异值记为 $\\sigma_{\\min}(\\mathcal{O})$。\n因此，最紧稳定性常数 $C$ 是\n$$\nC = \\|\\mathcal{O}^{+}\\|_{2} = \\frac{1}{\\sigma_{\\min}(\\mathcal{O})}.\n$$\n问题陈述 $\\mathcal{O}$ 具有满列秩，对于一个 $m \\times n$ 矩阵，这意味着秩 $r$ 等于 $n$。因此，$\\mathcal{O}$ 的所有 $n$ 个奇异值都是正的：$\\sigma_{1} \\ge \\sigma_{2} \\ge \\dots \\ge \\sigma_{n}  0$。在这种情况下，最小非零奇异值就是最小奇异值 $\\sigma_{n}$。因此，最优稳定性常数为\n$$\nC = \\frac{1}{\\sigma_{n}}.\n$$\n\n**针对特定算子的计算**\n\n给定算子\n$$\n\\mathcal{O} = \\begin{pmatrix}\n3  1 \\\\\n0  2 \\\\\n1  1\n\\end{pmatrix}.\n$$\n这是一个 $3 \\times 2$ 矩阵，因此 $m=3$ 且 $n=2$。$\\mathcal{O}$ 的奇异值是矩阵 $\\mathcal{O}^T \\mathcal{O}$ 的特征值的平方根。我们计算这个矩阵乘积：\n$$\n\\mathcal{O}^T \\mathcal{O} = \\begin{pmatrix}\n3  0  1 \\\\\n1  2  1\n\\end{pmatrix}\n\\begin{pmatrix}\n3  1 \\\\\n0  2 \\\\\n1  1\n\\end{pmatrix} =\n\\begin{pmatrix}\n(3)(3)+(0)(0)+(1)(1)  (3)(1)+(0)(2)+(1)(1) \\\\\n(1)(3)+(2)(0)+(1)(1)  (1)(1)+(2)(2)+(1)(1)\n\\end{pmatrix} =\n\\begin{pmatrix}\n10  4 \\\\\n4  6\n\\end{pmatrix}.\n$$\n接下来，我们通过求解特征方程 $\\det(\\mathcal{O}^T \\mathcal{O} - \\lambda I) = 0$ 来求 $\\mathcal{O}^T \\mathcal{O}$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix}\n10-\\lambda  4 \\\\\n4  6-\\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(10-\\lambda)(6-\\lambda) - (4)(4) = 0\n$$\n$$\n60 - 16\\lambda + \\lambda^2 - 16 = 0\n$$\n$$\n\\lambda^2 - 16\\lambda + 44 = 0.\n$$\n使用二次公式，特征值为：\n$$\n\\lambda = \\frac{-(-16) \\pm \\sqrt{(-16)^2 - 4(1)(44)}}{2(1)} = \\frac{16 \\pm \\sqrt{256 - 176}}{2} = \\frac{16 \\pm \\sqrt{80}}{2}.\n$$\n化简平方根，$\\sqrt{80} = \\sqrt{16 \\times 5} = 4\\sqrt{5}$。\n$$\n\\lambda = \\frac{16 \\pm 4\\sqrt{5}}{2} = 8 \\pm 2\\sqrt{5}.\n$$\n$\\mathcal{O}^T \\mathcal{O}$ 的两个特征值是 $\\lambda_{1} = 8 + 2\\sqrt{5}$ 和 $\\lambda_{2} = 8 - 2\\sqrt{5}$。如预期，两者均为正值。$\\mathcal{O}$ 对应的奇异值为 $\\sigma_{1} = \\sqrt{\\lambda_{1}}$ 和 $\\sigma_{2} = \\sqrt{\\lambda_{2}}$。\n我们需要最小的奇异值，即 $\\sigma_{n} = \\sigma_{2}$：\n$$\n\\sigma_{2} = \\sqrt{8 - 2\\sqrt{5}}.\n$$\n最优稳定性常数 $C$ 是该值的倒数：\n$$\nC = \\frac{1}{\\sigma_{2}} = \\frac{1}{\\sqrt{8 - 2\\sqrt{5}}}.\n$$\n为了提供一个简化的闭式表达式，我们通过考虑 $C^2$ 来对分母进行有理化：\n$$\nC^2 = \\frac{1}{8 - 2\\sqrt{5}} = \\frac{1}{8 - 2\\sqrt{5}} \\cdot \\frac{8 + 2\\sqrt{5}}{8 + 2\\sqrt{5}} = \\frac{8 + 2\\sqrt{5}}{8^2 - (2\\sqrt{5})^2} = \\frac{8 + 2\\sqrt{5}}{64 - 20} = \\frac{8 + 2\\sqrt{5}}{44} = \\frac{2(4 + \\sqrt{5})}{44} = \\frac{4 + \\sqrt{5}}{22}.\n$$\n取平方根得到 $C$ 的最终表达式：\n$$\nC = \\sqrt{\\frac{4 + \\sqrt{5}}{22}}.\n$$\n这就是最优稳定性常数的精确解析形式。", "answer": "$$\n\\boxed{\\sqrt{\\frac{4+\\sqrt{5}}{22}}}\n$$", "id": "3374182"}, {"introduction": "当观测算子是非线性时，稳定性的概念变得局部化，并与数据失配泛函的曲率密切相关。高斯-牛顿方法提供了一种计算上易于处理的方式来近似该曲率，即通过近似黑塞矩阵。这个练习 [@problem_id:3374134] 旨在通过为一个非线性模型推导并计算高斯-牛顿黑塞矩阵，来加深您对这一关键工具的理解。更重要的是，它揭示了优化理论中的几何概念（曲率）与统计推断中的核心概念（费雪信息矩阵）之间的深刻联系，为理解参数不确定性提供了统一的视角。", "problem": "考虑一个数据同化设定，其参数空间为 $\\mathcal{X}=\\mathbb{R}$，数据空间为 $\\mathcal{Y}=\\mathbb{R}^{3}$。设观测算子 $\\mathcal{O}:\\mathcal{X}\\to\\mathcal{Y}$ 的分量形式为 $\\mathcal{O}_{1}(x)=\\exp(x)$，$\\mathcal{O}_{2}(x)=\\sin(2x)$，以及 $\\mathcal{O}_{3}(x)=\\dfrac{x}{1+x^{2}}$。假设观测模型为 $y=\\mathcal{O}(x_{\\text{true}})+\\eta$，其中 $\\eta$ 是一个零均值高斯随机向量，其协方差矩阵为 $\\Gamma=\\mathrm{diag}(0.09,\\,0.04,\\,0.25)$，数据失配泛函为\n$$\nJ(x)=\\frac{1}{2}\\left\\|\\Gamma^{-1/2}\\big(\\mathcal{O}(x)-y\\big)\\right\\|_{2}^{2}.\n$$\n从高斯似然和 $J(x)$ 的定义出发，应用第一性原理（Fréchet微分和链式法则），推导在任意点 $x$ 处 $J(x)$ 的Hessian矩阵的高斯-牛顿近似，并解释其在量化数据失配局部曲率中的作用。然后，对于给定的 $\\mathcal{O}$ 和 $\\Gamma$，在点 $x^{\\star}=0.5$ 处计算这个高斯-牛顿Hessian近似，并将最终值表示为单个封闭形式的解析表达式。最后，解释所推导的量与高斯观测模型的费雪信息矩阵（FIM）之间的关系。将您的最终答案表示为单个封闭形式的解析表达式。", "solution": "该问题被评估为有效，因为它在科学上基于反演问题的理论，是适定的、客观的，并且对于所需的计算是自洽的。所有必要的函数、常数和定义都已提供，没有矛盾或歧义之处。\n\n数据失配泛函由下式给出\n$$\nJ(x)=\\frac{1}{2}\\left\\|\\Gamma^{-1/2}\\big(\\mathcal{O}(x)-y\\big)\\right\\|_{2}^{2}\n$$\n其中 $x \\in \\mathcal{X}=\\mathbb{R}$，$y \\in \\mathcal{Y}=\\mathbb{R}^3$，$\\mathcal{O}:\\mathbb{R} \\to \\mathbb{R}^3$ 是观测算子，$\\Gamma$ 是观测噪声的 $3 \\times 3$ 正定协方差矩阵。该表达式是一个加权的欧几里得范数的平方，可以写成二次型的形式：\n$$\nJ(x) = \\frac{1}{2} \\left( \\mathcal{O}(x) - y \\right)^T \\left(\\Gamma^{-1/2}\\right)^T \\Gamma^{-1/2} \\left( \\mathcal{O}(x) - y \\right) = \\frac{1}{2} \\left( \\mathcal{O}(x) - y \\right)^T \\Gamma^{-1} \\left( \\mathcal{O}(x) - y \\right)\n$$\n因为 $\\Gamma$（因此 $\\Gamma^{-1/2}$）是对称的。\n\n**第一部分：高斯-牛顿Hessian矩阵的推导**\n\n为了求 $J(x)$ 的Hessian矩阵，我们首先计算其梯度（其Fréchet导数）。由于 $x$ 是一个标量，$\\mathcal{O}(x)$ 的Fréchet导数是其关于 $x$ 的雅可比矩阵，我们记为 $O'(x)$。这是一个 $3 \\times 1$ 的列向量：\n$$\nO'(x) = \\frac{d\\mathcal{O}}{dx}(x) = \\begin{pmatrix} \\frac{d\\mathcal{O}_1}{dx}(x) \\\\ \\frac{d\\mathcal{O}_2}{dx}(x) \\\\ \\frac{d\\mathcal{O}_3}{dx}(x) \\end{pmatrix}\n$$\n使用链式法则，标量泛函 $J(x)$ 的梯度为：\n$$\n\\nabla J(x) = \\frac{dJ}{dx}(x) = \\left( O'(x) \\right)^T \\Gamma^{-1} \\left( \\mathcal{O}(x) - y \\right)\n$$\n这是一个 $1 \\times 1$ 的标量，符合预期。\n\n接下来，我们将 $\\nabla J(x)$ 对 $x$ 求导以求得Hessian矩阵，$H(x) = \\nabla^2 J(x)$。我们应用乘积法则：\n$$\nH(x) = \\frac{d}{dx} \\left[ \\left( O'(x) \\right)^T \\Gamma^{-1} \\left( \\mathcal{O}(x) - y \\right) \\right]\n$$\n$$\nH(x) = \\left( \\frac{d}{dx} \\left( O'(x) \\right)^T \\right) \\Gamma^{-1} \\left( \\mathcal{O}(x) - y \\right) + \\left( O'(x) \\right)^T \\Gamma^{-1} \\left( \\frac{d}{dx} \\left( \\mathcal{O}(x) - y \\right) \\right)\n$$\n令 $O''(x)$ 表示 $\\mathcal{O}(x)$ 各分量的二阶导数组成的 $3 \\times 1$ 向量。转置雅可比矩阵的导数是 $(O''(x))^T$。残差项的导数就是 $O'(x)$。将这些代入 $H(x)$ 的表达式，得到精确的Hessian矩阵：\n$$\nH(x) = (O'(x))^T \\Gamma^{-1} O'(x) + (O''(x))^T \\Gamma^{-1} (\\mathcal{O}(x) - y)\n$$\n高斯-牛顿法通过忽略第二项来提供Hessian矩阵的近似。当模型接近线性（即 $O''(x)$ 很小）或模型能很好地拟合数据（即残差 $\\mathcal{O}(x) - y$ 很小）时，这个近似是合理的。得到的高斯-牛顿Hessian矩阵 $H_{GN}(x)$ 为：\n$$\nH_{GN}(x) = (O'(x))^T \\Gamma^{-1} O'(x)\n$$\n这个近似有一个实际的优点，即它总是半正定的，这对于依赖此性质来确保下降方向的优化算法是有利的。\n\n一个函数的Hessian矩阵描述了其局部曲率。因此，对于失配泛函 $J(x)$，$H_{GN}(x)$ 近似了失配函数在点 $x$ 周围的曲率。$H_{GN}(x)$ 的值很大意味着一个尖锐、明确的最小值，表明数据对参数 $x$ 高度敏感，能够很好地约束它。值很小则意味着一个平坦、宽阔的最小值，表明灵敏度低且约束性差。\n\n**第二部分：在 $x^{\\star}=0.5$ 处的计算**\n\n我们必须在 $x^{\\star}=0.5$ 处计算 $H_{GN}(x^{\\star}) = (O'(x^{\\star}))^T \\Gamma^{-1} O'(x^{\\star})$。\n首先，我们求雅可比矩阵 $O'(x)$ 的分量：\n$$\n\\mathcal{O}_{1}(x)=\\exp(x) \\implies \\frac{d\\mathcal{O}_{1}}{dx}(x) = \\exp(x)\n$$\n$$\n\\mathcal{O}_{2}(x)=\\sin(2x) \\implies \\frac{d\\mathcal{O}_{2}}{dx}(x) = 2\\cos(2x)\n$$\n$$\n\\mathcal{O}_{3}(x)=\\frac{x}{1+x^{2}} \\implies \\frac{d\\mathcal{O}_{3}}{dx}(x) = \\frac{(1)(1+x^2) - x(2x)}{(1+x^2)^2} = \\frac{1-x^2}{(1+x^2)^2}\n$$\n在 $x^{\\star}=0.5 = 1/2$ 处：\n$$\n\\frac{d\\mathcal{O}_{1}}{dx}(0.5) = \\exp(0.5)\n$$\n$$\n\\frac{d\\mathcal{O}_{2}}{dx}(0.5) = 2\\cos(2 \\cdot 0.5) = 2\\cos(1)\n$$\n$$\n\\frac{d\\mathcal{O}_{3}}{dx}(0.5) = \\frac{1-(0.5)^2}{(1+(0.5)^2)^2} = \\frac{1-1/4}{(1+1/4)^2} = \\frac{3/4}{(5/4)^2} = \\frac{3}{4} \\cdot \\frac{16}{25} = \\frac{12}{25}\n$$\n给定的协方差矩阵为 $\\Gamma=\\mathrm{diag}(0.09, 0.04, 0.25)$。其逆矩阵为：\n$$\n\\Gamma^{-1} = \\mathrm{diag}\\left(\\frac{1}{0.09}, \\frac{1}{0.04}, \\frac{1}{0.25}\\right) = \\mathrm{diag}\\left(\\frac{100}{9}, \\frac{100}{4}, \\frac{100}{25}\\right) = \\mathrm{diag}\\left(\\frac{100}{9}, 25, 4\\right)\n$$\n高斯-牛顿Hessian矩阵是一个标量和：\n$$\nH_{GN}(x) = \\sum_{i=1}^3 \\frac{1}{\\Gamma_{ii}} \\left( \\frac{d\\mathcal{O}_i}{dx}(x) \\right)^2\n$$\n在 $x^{\\star}=0.5$ 处求值：\n$$\nH_{GN}(0.5) = \\frac{100}{9} (\\exp(0.5))^2 + 25 (2\\cos(1))^2 + 4 \\left(\\frac{12}{25}\\right)^2\n$$\n$$\nH_{GN}(0.5) = \\frac{100}{9} \\exp(1) + 25 (4\\cos^2(1)) + 4 \\left(\\frac{144}{625}\\right)\n$$\n$$\nH_{GN}(0.5) = \\frac{100}{9} \\exp(1) + 100\\cos^2(1) + \\frac{576}{625}\n$$\n这就是在 $x^{\\star}=0.5$ 处高斯-牛顿Hessian矩阵的最终封闭形式解析表达式。\n\n**第三部分：与费雪信息矩阵（FIM）的关系**\n\n对于带有高斯噪声 $\\eta \\sim \\mathcal{N}(0, \\Gamma)$ 的观测模型 $y = \\mathcal{O}(x) + \\eta$，其似然函数 $p(y|x)$ 为：\n$$\np(y|x) = \\frac{1}{\\sqrt{(2\\pi)^3 \\det(\\Gamma)}} \\exp\\left( -\\frac{1}{2} (\\mathcal{O}(x)-y)^T \\Gamma^{-1} (\\mathcal{O}(x)-y) \\right)\n$$\n对数似然函数 $\\ell(x; y) = \\ln(p(y|x))$ 为：\n$$\n\\ell(x; y) = -\\frac{1}{2} \\ln((2\\pi)^3 \\det(\\Gamma)) - \\frac{1}{2} (\\mathcal{O}(x)-y)^T \\Gamma^{-1} (\\mathcal{O}(x)-y) = -\\text{const} - J(x)\n$$\n费雪信息矩阵（在此情况下由于 $x \\in \\mathbb{R}$ 是一个标量）定义为对数似然函数关于参数 $x$ 的二阶导数的负期望值：\n$$\nI(x) = -\\mathbb{E}_{y|x} \\left[ \\frac{\\partial^2 \\ell(x;y)}{\\partial x^2} \\right]\n$$\n对数似然函数的二阶导数为：\n$$\n\\frac{\\partial^2 \\ell(x;y)}{\\partial x^2} = -\\frac{\\partial^2 J(x)}{\\partial x^2} = -H(x) = -\\left( (O'(x))^T \\Gamma^{-1} O'(x) + (O''(x))^T \\Gamma^{-1} (\\mathcal{O}(x) - y) \\right)\n$$\n现在我们对给定 $x$ 的所有可能观测值 $y$ 求期望。这意味着 $y$ 被视为一个随机变量 $Y = \\mathcal{O}(x) + \\eta$。\n$$\nI(x) = - \\mathbb{E}_{Y|x} \\left[ -H(x) \\right] = \\mathbb{E}_{Y|x} \\left[ (O'(x))^T \\Gamma^{-1} O'(x) + (O''(x))^T \\Gamma^{-1} (\\mathcal{O}(x) - Y) \\right]\n$$\n利用期望的线性性质：\n$$\nI(x) = (O'(x))^T \\Gamma^{-1} O'(x) + \\mathbb{E}_{Y|x} \\left[ (O''(x))^T \\Gamma^{-1} (\\mathcal{O}(x) - Y) \\right]\n$$\n项 $(\\mathcal{O}(x) - Y)$ 等于 $(\\mathcal{O}(x) - (\\mathcal{O}(x) + \\eta)) = -\\eta$。这一项的期望为：\n$$\n\\mathbb{E}_{Y|x} [-\\eta] = - \\mathbb{E}[\\eta] = 0\n$$\n因为噪声向量 $\\eta$ 的均值为零。因此，$I(x)$ 表达式中的第二项消失。剩下：\n$$\nI(x) = (O'(x))^T \\Gamma^{-1} O'(x)\n$$\n这表明，对于一个带有加性高斯噪声的模型，费雪信息矩阵与数据失配泛函的Hessian矩阵的高斯-牛顿近似完全相等。FIM量化了数据提供的关于参数 $x$ 的信息，其倒数给出了 $x$ 的任何无偏估计量的方差的克拉默-拉奥下界。", "answer": "$$\n\\boxed{\\frac{100}{9}\\exp(1) + 100\\cos^2(1) + \\frac{576}{625}}\n$$", "id": "3374134"}, {"introduction": "将我们的注意力转向动态系统，一个基本问题是“可观测性”：我们能否仅通过随时间演变的部分观测来唯一确定系统的初始状态？这个问题在四维变分（4D-Var）数据同化等领域至关重要。本练习 [@problem_id:3374175] 提供了一个深入研究混沌系统中可观测性的计算实践。通过为一个经典的混沌模型（Hénon 映射）编写程序，您将实现切线性模型的传播，构建灵敏度矩阵，并利用奇异值分解来数值评估可观测性，从而探索观测算子的稀疏性和同化窗口的长度如何影响我们重构系统状态的能力。", "problem": "考虑一个状态维数 $n \\in \\mathbb{N}$、参数矢量 $p \\in \\mathbb{R}^q$ 的离散时间非线性动力系统，其演化律由 $x_{t+1} = f(x_t, p)$ 给出，其中 $t \\in \\{0,1,2,\\ldots\\}$。设 $H: \\mathbb{R}^n \\to \\mathbb{R}^m$ 为一个观测算子。在四维变分（4D-Var）数据同化中，一个核心量是观测值对沿轨迹的初始状态 $x_0$ 扰动的敏感性，这由时变线性化来捕捉。设 $\\Phi_t \\in \\mathbb{R}^{n \\times n}$ 表示从时间 $0$ 到时间 $t$ 的状态转移（切线性）矩阵，其递归定义为 $\\Phi_0 = I_n$ 和 $\\Phi_{t+1} = f_x(x_t, p)\\,\\Phi_t$，其中 $f_x(x_t,p) \\in \\mathbb{R}^{n \\times n}$ 是 $f$ 关于状态的雅可比矩阵，沿轨迹求值。在时间 $t$ 的观测算子的雅可比矩阵是 $H_x(x_t) \\in \\mathbb{R}^{m \\times n}$。在长度为 $T \\in \\mathbb{N}$ 的同化窗口上，通过垂直堆叠 $t \\in \\{1,2,\\ldots,T\\}$ 的块 $H_x(x_t)\\Phi_t$ 来定义堆叠敏感性矩阵 $O_T \\in \\mathbb{R}^{(mT) \\times n}$，并通过 $J_{\\mathrm{avg}} = \\frac{1}{T}\\sum_{t=1}^T H_x(x_t)\\Phi_t$ 定义时间平均雅可比矩阵 $J_{\\mathrm{avg}} \\in \\mathbb{R}^{m \\times n}$。在已知 $p$ 的情况下，初始条件 $x_0$ 的一个标准局部可观测性概念是 $O_T$ 具有满列秩 $n$。您的任务是实现一个程序，对于一个具体的混沌模型和特定的稀疏观测算子，计算数值秩并评估可观测性。\n\n使用 Hénon 映射，其状态维数 $n=2$，参数矢量 $p = (a,b) \\in \\mathbb{R}^2$，定义为\n$$\n\\begin{pmatrix}\nx_{t+1}^{(1)}\\\\\nx_{t+1}^{(2)}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 - a\\big(x_t^{(1)}\\big)^2 + x_t^{(2)}\\\\\nb\\, x_t^{(1)}\n\\end{pmatrix}.\n$$\n$f$ 关于状态的雅可比矩阵是\n$$\nf_x(x_t,p) =\n\\begin{pmatrix}\n-2 a\\, x_t^{(1)}  1\\\\\nb  0\n\\end{pmatrix}.\n$$\n考虑三种形式为 $H(x) = C x$ 的观测算子 $H$，其中 $C \\in \\mathbb{R}^{m \\times 2}$ 是常数（因此对所有 $t$ 都有 $H_x(x_t) = C$），选择它们来代表稀疏和密集传感：\n- 情况 A（稀疏）：只观测第一个分量，$m=1$ 且 $C = \\begin{pmatrix}1  0\\end{pmatrix}$。\n- 情况 B（密集）：观测两个分量，$m=2$ 且 $C = I_2$。\n- 情况 C（空）：不进行观测，$m=2$ 且 $C = \\begin{pmatrix}0  0\\\\ 0  0\\end{pmatrix}$。\n\n从初始条件 $x_0 = (0.1,\\,0.3)$ 和参数 $p=(a,b)=(1.4,\\,0.3)$ 开始，传播 Hénon 映射以计算轨迹 $\\{x_t\\}_{t=0}^T$ 和每个测试用例的切线性矩阵 $\\{\\Phi_t\\}_{t=0}^T$。对于每个测试用例，构建 $O_T$ 和 $J_{\\mathrm{avg}}$，并使用以下原则计算它们的数值秩：如果 $\\sigma_1 \\ge \\sigma_2 \\ge \\cdots$ 是奇异值分解得到的奇异值，那么数值秩是满足 $\\sigma_i  \\tau$ 的奇异值 $\\sigma_i$ 的数量，其中容差为\n$$\n\\tau = \\epsilon \\cdot \\max\\{M,N\\} \\cdot \\sigma_1,\n$$\n其中 $M \\times N$ 是矩阵维度，$\\epsilon$ 是双精度浮点运算的机器ε。如果 $\\sigma_1 = 0$，则数值秩定义为 $0$。\n\n为每个测试用例计算由以下三项组成的三元组：\n- $O_T$ 的数值秩，\n- $J_{\\mathrm{avg}}$ 的数值秩，\n- 一个布尔值，指示初始条件是否局部可观测，定义为 $O_T$ 的秩是否等于 $n=2$。\n\n您的程序必须为以下测试套件实现此过程：\n- 测试 1（正常路径，稀疏传感）：$T=50$ 和情况 A。\n- 测试 2（正常路径，密集传感）：$T=50$ 和情况 B。\n- 测试 3（边缘情况，空传感）：$T=50$ 和情况 C。\n- 测试 4（边界窗口，稀疏传感）：$T=1$ 和情况 A。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n[\\mathrm{rank}(O_T)_{\\mathrm{Test\\,1}},\\ \\mathrm{rank}(J_{\\mathrm{avg}})_{\\mathrm{Test\\,1}},\\ \\mathrm{observable}_{\\mathrm{Test\\,1}},\\ \\mathrm{rank}(O_T)_{\\mathrm{Test\\,2}},\\ \\mathrm{rank}(J_{\\mathrm{avg}})_{\\mathrm{Test\\,2}},\\ \\mathrm{observable}_{\\mathrm{Test\\,2}},\\ \\mathrm{rank}(O_T)_{\\mathrm{Test\\,3}},\\ \\mathrm{rank}(J_{\\mathrm{avg}})_{\\mathrm{Test\\,3}},\\ \\mathrm{observable}_{\\mathrm{Test\\,3}},\\ \\mathrm{rank}(O_T)_{\\mathrm{Test\\,4}},\\ \\mathrm{rank}(J_{\\mathrm{avg}})_{\\mathrm{Test\\,4}},\\ \\mathrm{observable}_{\\mathrm{Test\\,4}}].\n$$\n不涉及物理单位或角度单位。输出条目的类型必须是如上指定的布尔值或整数，并且不应打印任何额外的文本。", "solution": "该问题要求对 Hénon 映射（一个经典的离散时间混沌动力系统）的初始状态的局部可观测性进行分析。此分析在四维变分（4D-Var）数据同化的框架内执行。任务的核心是为不同的观测情景和时间窗口计算两个关键敏感性矩阵的数值秩，即堆叠敏感性矩阵 $O_T$ 和时间平均雅可比矩阵 $J_{\\mathrm{avg}}$。\n\n该系统由 Hénon 映射定义：\n$$\nx_{t+1} = f(x_t, p) = \\begin{pmatrix} 1 - a(x_t^{(1)})^2 + x_t^{(2)} \\\\ b x_t^{(1)} \\end{pmatrix}\n$$\n其中状态为 $x_t = (x_t^{(1)}, x_t^{(2)})^T \\in \\mathbb{R}^2$（因此状态维数 $n=2$），参数为 $p=(a,b) = (1.4, 0.3)$，从初始状态 $x_0 = (0.1, 0.3)^T$ 开始。\n\n系统在时间 $t$ 的状态对初始状态 $x_0$ 的小扰动的敏感性由状态转移矩阵（或切线性模型）$\\Phi_t \\in \\mathbb{R}^{2 \\times 2}$ 描述。它根据递归关系演化：\n$$\n\\Phi_{t+1} = f_x(x_t, p) \\Phi_t, \\quad \\text{其中} \\quad \\Phi_0 = I_2\n$$\n其中 $I_2$ 是 $2 \\times 2$ 单位矩阵，$f_x(x_t, p)$ 是映射 $f$ 关于状态 $x$ 的雅可比矩阵，沿从 $x_0$ 生成的轨迹求值：\n$$\nf_x(x_t, p) = \\frac{\\partial f}{\\partial x}\\bigg|_{x_t, p} = \\begin{pmatrix} -2 a x_t^{(1)}  1 \\\\ b  0 \\end{pmatrix}\n$$\n\n观测由线性算子 $y_t = H(x_t) = C x_t$ 给出。因此，观测算子的雅可比矩阵 $H_x(x_t)$ 是常数矩阵 $C$。在时间 $t$ 的观测对初始状态 $x_0$ 的敏感性由链式法则给出：$\\frac{\\partial y_t}{\\partial x_0} = H_x(x_t) \\frac{\\partial x_t}{\\partial x_0} = C \\Phi_t$。\n\n问题定义了在长度为 $T$ 的同化窗口上要分析的两个矩阵：\n1.  **堆叠敏感性矩阵** $O_T \\in \\mathbb{R}^{(mT) \\times n}$。该矩阵聚合了窗口中所有观测的敏感性信息。它通过垂直堆叠 $t=1, 2, \\ldots, T$ 的各个敏感性块来构建：\n    $$\n    O_T = \\begin{pmatrix} C \\Phi_1 \\\\ C \\Phi_2 \\\\ \\vdots \\\\ C \\Phi_T \\end{pmatrix}\n    $$\n2.  **时间平均雅可比矩阵** $J_{\\mathrm{avg}} \\in \\mathbb{R}^{m \\times n}$。该矩阵表示窗口内的平均敏感性：\n    $$\n    J_{\\mathrm{avg}} = \\frac{1}{T} \\sum_{t=1}^{T} C \\Phi_t\n    $$\n\n如果 $O_T$ 具有满列秩（在本例中为 $n=2$），则初始条件 $x_0$ 的局部可观测性得以确立。满列秩意味着从初始状态扰动到观测扰动序列的映射是单射的，这意味着不同的初始状态扰动会导致不同的观测序列，从而允许（局部地）唯一确定 $x_0$。\n\n大小为 $M \\times N$ 的矩阵 $A$ 的数值秩使用其奇异值分解（SVD）来确定。设奇异值为 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge 0$。秩是超过指定容差 $\\tau$ 的奇异值 $\\sigma_i$ 的数量：\n$$\n\\tau = \\epsilon \\cdot \\max\\{M, N\\} \\cdot \\sigma_1\n$$\n其中 $\\epsilon$ 是双精度浮点数的机器ε，$\\sigma_1$ 是最大的奇异值。如果 $\\sigma_1=0$，则矩阵为空矩阵，其秩为 $0$。\n\n每个测试用例 $(T, C)$ 的总算法如下：\n1.  初始化状态 $x_0 = (0.1, 0.3)^T$ 和状态转移矩阵 $\\Phi_0 = I_2$。\n2.  从 $t=0$ 到 $T-1$ 进行迭代：\n    a. 传播状态：$x_{t+1} = f(x_t, p)$。\n    b. 传播状态转移矩阵：$\\Phi_{t+1} = f_x(x_t, p) \\Phi_t$。\n    c. 存储矩阵 $C \\Phi_{t+1}$。这将生成 $t=1, \\ldots, T$ 的敏感性块序列。\n3.  通过垂直堆叠存储的块来构建 $O_T$。\n4.  通过计算存储块的均值来构建 $J_{\\mathrm{avg}}$。\n5.  使用基于 SVD 的方法计算 $O_T$ 和 $J_{\\mathrm{avg}}$ 的数值秩。\n6.  通过检查 $O_T$ 的数值秩是否等于 $n=2$ 来确定局部可观测性。\n7.  收集三元组 $(\\mathrm{rank}(O_T), \\mathrm{rank}(J_{\\mathrm{avg}}), \\mathrm{observable})$。\n\n此过程应用于四个指定的测试用例，组合了不同的窗口长度（$T=1, 50$）和观测算子（稀疏、密集和空传感）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_numerical_rank(matrix: np.ndarray) -> int:\n    \"\"\"\n    Computes the numerical rank of a matrix based on its singular values.\n    The rank is the number of singular values greater than a tolerance tau.\n    tau = epsilon * max(M, N) * sigma_1\n    \"\"\"\n    # An all-zero matrix has rank 0. np.any is a fast check for this.\n    if not np.any(matrix):\n        return 0\n\n    M, N = matrix.shape\n    try:\n        # We only need the singular values, so compute_uv=False for efficiency.\n        s = np.linalg.svd(matrix, compute_uv=False)\n    except np.linalg.LinAlgError:\n        # Graceful handling for non-convergence, though highly unlikely here.\n        return 0\n\n    # The singular values are sorted in descending order. sigma_1 is the largest.\n    sigma_1 = s[0]\n\n    # If the largest singular value is effectively zero, the matrix is null.\n    if np.isclose(sigma_1, 0.0):\n        return 0\n\n    # Epsilon for double-precision floating-point arithmetic.\n    epsilon = np.finfo(float).eps\n    \n    # Calculate the tolerance as specified in the problem statement.\n    tolerance = epsilon * max(M, N) * sigma_1\n\n    # The rank is the number of singular values greater than the tolerance.\n    rank = np.sum(s > tolerance)\n    return int(rank)\n\ndef solve():\n    \"\"\"\n    Main function to run the 4D-Var observability analysis for the Hénon map.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # --- Problem Constants and Initial Conditions ---\n    x0 = np.array([0.1, 0.3])\n    a, b = 1.4, 0.3\n    n_dim = 2  # State dimension n=2\n\n    # --- Test Case Definitions ---\n    # Observation matrices C for each case\n    C_A = np.array([[1.0, 0.0]])  # Case A: Observe x^(1)\n    C_B = np.identity(2)         # Case B: Observe both x^(1) and x^(2)\n    C_C = np.zeros((2, 2))       # Case C: Observe nothing\n\n    # Test suite: (T, C_matrix)\n    test_cases = [\n        (50, C_A), # Test 1: T=50, Case A\n        (50, C_B), # Test 2: T=50, Case B\n        (50, C_C), # Test 3: T=50, Case C\n        (1, C_A),  # Test 4: T=1, Case A\n    ]\n\n    all_results = []\n    \n    for T, C in test_cases:\n        # --- Trajectory and Tangent Linear Model Propagation ---\n        # Initialize state and state transition matrix for the current case.\n        x_t = x0.copy()\n        Phi_t = np.identity(n_dim)\n        \n        # List to store the blocks H_x(x_t) * Phi_t = C @ Phi_t for t = 1, ..., T\n        sensitivity_blocks = []\n\n        # We need the state transition matrix for t=1..T, so we iterate T times.\n        # The state trajectory runs from x_0 to x_T.\n        # The tangent linear model runs from Phi_0 to Phi_T.\n        # The problem asks for blocks C*Phi_t for t=1..T.\n        \n        # We need to save the state at each step to compute the Jacobians.\n        # The state trajectory is x_0, x_1, ..., x_{T-1} which are used to compute\n        # Phi_1, Phi_2, ..., Phi_T.\n        x_traj = [x0.copy()]\n        phi_traj = [np.identity(n_dim)]\n        \n        current_x = x0.copy()\n        current_phi = np.identity(n_dim)\n\n        for _ in range(T):\n            # Evaluate the Jacobian f_x at the current state current_x\n            f_x = np.array([\n                [-2 * a * current_x[0], 1.0],\n                [b,                     0.0]\n            ])\n            \n            # Propagate the state transition matrix: Phi_{t+1} = f_x(x_t) @ Phi_t\n            current_phi = f_x @ current_phi\n            phi_traj.append(current_phi) # Store Phi_1, Phi_2, ...\n\n            # Propagate the state: x_{t+1} = f(x_t)\n            x_next_0 = 1.0 - a * current_x[0]**2 + current_x[1]\n            x_next_1 = b * current_x[0]\n            current_x = np.array([x_next_0, x_next_1])\n            x_traj.append(current_x) # Store x_1, x_2, ...\n        \n        # phi_traj now contains [Phi_0, Phi_1, ..., Phi_T]\n        # We need C @ Phi_t for t=1..T\n        sensitivity_blocks = [C @ phi_traj[t] for t in range(1, T + 1)]\n\n        # --- Matrix Construction ---\n        # O_T is formed by vertically stacking the blocks C @ Phi_t for t=1..T\n        O_T = np.vstack(sensitivity_blocks)\n        \n        # J_avg is the time-average of these blocks\n        J_avg = np.mean(np.array(sensitivity_blocks), axis=0)\n        \n        # --- Rank Computation and Observability Analysis ---\n        rank_O_T = get_numerical_rank(O_T)\n        rank_J_avg = get_numerical_rank(J_avg)\n        \n        # Local observability is true if the rank of O_T equals the state dimension n\n        is_observable = (rank_O_T == n_dim)\n        \n        all_results.extend([rank_O_T, rank_J_avg, is_observable])\n\n    # Final print statement in the exact required format.\n    # Convert results to strings, with booleans as lowercase 'true'/'false'.\n    output_str = ', '.join(str(res).lower() if isinstance(res, bool) else str(res) for res in all_results)\n    \n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3374175"}]}