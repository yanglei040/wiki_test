{"hands_on_practices": [{"introduction": "在粒子滤波中，重采样是应对粒子退化问题的关键步骤，但其本身会引入额外的蒙特卡洛变异。本练习将深入探讨三种常见的重采样方案——系统重采样、分层重采样和残差重采样——在辅助粒子滤波器（APF）框架下的统计特性。通过从第一性原理推导重采样后估计量的条件方差，你将对不同方案的性能优劣及其对估计精度的影响有更深刻的定量理解。[@problem_id:3366188]", "problem": "考虑一个由辅助粒子滤波器（APF）估计的离散时间状态空间模型。在时间 $t$，设粒子集为 $\\{x_{t}^{(i)},w_{t}^{(i)}\\}_{i=1}^{N}$，其中 $w_{t}^{(i)} \\ge 0$ 是满足 $\\sum_{i=1}^{N} w_{t}^{(i)} = 1$ 的归一化重要性权重。设 $m_{t}^{(i)}  0$ 表示第一阶段 APF 乘子（也称为辅助权重），用于定义 APF 的祖先选择概率\n$$\nr_{t}^{(i)} \\;=\\; \\frac{w_{t}^{(i)} m_{t}^{(i)}}{\\sum_{k=1}^{N} w_{t}^{(k)} m_{t}^{(k)}}, \\quad i=1,\\dots,N.\n$$\n设 $\\phi:\\mathcal{X}\\to\\mathbb{R}$ 是一个有界可测的检验函数，并定义 $\\phi_{t}^{(i)} = \\phi\\!\\left(x_{t}^{(i)}\\right)$。目标量是加权蒙特卡洛估计量\n$$\n\\hat{\\phi}_{t} \\;=\\; \\sum_{i=1}^{N} w_{t}^{(i)} \\,\\phi_{t}^{(i)}.\n$$\n假设使用以下方案之一根据 $r_{t}^{(i)}$ 进行重采样：系统重采样、分层重采样或残差重采样。为了从重采样的祖先中估计 $\\hat{\\phi}_{t}$，并保持对原始 $w_{t}^{(i)}$ 的无偏性，考虑 Horvitz–Thompson 风格的重采样估计量\n$$\n\\hat{\\phi}_{t}^{(R)} \\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} \\frac{w_{t}^{\\big(I_{j}\\big)}}{r_{t}^{\\big(I_{j}\\big)}} \\,\\phi_{t}^{\\big(I_{j}\\big)},\n$$\n其中 $I_{j} \\in \\{1,\\dots,N\\}$ 是第 $j$ 次抽样的重采样祖先索引，根据该方案的机制以边际选择概率 $r_{t}^{(i)}$ 进行选择。\n\n从基于重采样的蒙特卡洛估计和条件方差的第一性原理出发，推导在给定 $\\{x_{t}^{(i)}, w_{t}^{(i)}, m_{t}^{(i)}\\}_{i=1}^{N}$ 的情况下，$\\hat{\\phi}_{t}^{(R)}$ 在每种方案下的闭式条件方差：\n- 系统重采样：使用表示 $U \\sim \\mathrm{Uniform}\\!\\left(0,\\frac{1}{N}\\right)$ 和 $U_{j} = \\frac{U + j - 1}{N}$（对于 $j=1,\\dots,N$）；索引映射由 $r_{t}^{(i)}$ 的累积分布确定。\n- 分层重采样：使用独立的均匀分布 $U_{j} \\sim \\mathrm{Uniform}\\!\\left(\\frac{j-1}{N},\\frac{j}{N}\\right)$（对于 $j=1,\\dots,N$）。\n- 残差重采样：将 $N r_{t}^{(i)} = a_{t}^{(i)} + \\rho_{t}^{(i)}$ 分解，其中 $a_{t}^{(i)} = \\lfloor N r_{t}^{(i)} \\rfloor \\in \\mathbb{N}_{0}$ 且 $\\rho_{t}^{(i)} \\in [0,1)$，确定性地分配索引 $i$ 的 $a_{t}^{(i)}$ 个副本，并从概率为 $\\bar{r}_{t}^{(i)} = \\rho_{t}^{(i)}/R_{\\mathrm{res}}$ 的分类分布中抽取 $R_{\\mathrm{res}} = \\sum_{i=1}^{N} \\rho_{t}^{(i)}$ 个残差副本。\n\n用已知的权重 $\\{w_{t}^{(i)}\\}$、选择概率 $\\{r_{t}^{(i)}\\}$ 和值 $\\{\\phi_{t}^{(i)}\\}$ 来表示每种方差。对于分层重采样，你的最终表达式必须使用累积和 $R_{t}^{(i)} = \\sum_{k=1}^{i} r_{t}^{(k)}$（其中 $R_{t}^{(0)} = 0$）和交集长度\n$$\nL_{t}(i,j) \\;=\\; \\left| \\left[R_{t}^{(i-1)}, R_{t}^{(i)}\\right) \\,\\cap\\, \\left[ \\tfrac{j-1}{N}, \\tfrac{j}{N} \\right) \\right|, \\quad i,j \\in \\{1,\\dots,N\\}.\n$$\n对于系统重采样，你的最终表达式必须写成在 $U \\in \\left(0,\\frac{1}{N}\\right)$ 上的积分形式，该积分是对由相同累积和构建的估计量表示的平方进行积分。对于残差重采样，你的最终表达式必须使用 $\\{a_{t}^{(i)}\\}$、$\\{\\rho_{t}^{(i)}\\}$ 和 $R_{\\mathrm{res}}$。\n\n你的最终答案必须是包含这三个方差作为单行矩阵条目的单个解析表达式，不进行数值近似。不需要四舍五入，也不涉及物理单位。", "solution": "推导从 Horvitz–Thompson 风格估计量的无偏性和条件方差性质以及三种重采样方案的结构开始。在整个过程中，条件是固定的粒子集 $\\{x_{t}^{(i)}, w_{t}^{(i)}, m_{t}^{(i)}\\}_{i=1}^{N}$。定义简写\n$$\n\\phi_{t}^{(i)} \\;=\\; \\phi\\!\\left(x_{t}^{(i)}\\right), \\qquad r_{t}^{(i)} \\;=\\; \\frac{w_{t}^{(i)} m_{t}^{(i)}}{\\sum_{k=1}^{N} w_{t}^{(k)} m_{t}^{(k)}}, \\qquad s_{t}^{(i)} \\;=\\; \\frac{w_{t}^{(i)}}{r_{t}^{(i)}} \\,\\phi_{t}^{(i)}.\n$$\n重采样估计量为\n$$\n\\hat{\\phi}_{t}^{(R)} \\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} s_{t}^{\\big(I_{j}\\big)},\n$$\n在所有方案下，边际选择概率为 $r_{t}^{(i)}$。首先，验证无偏性：\n$$\n\\mathbb{E}\\!\\left[ \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right]\n\\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} \\sum_{i=1}^{N} r_{t}^{(i)} s_{t}^{(i)}\n\\;=\\; \\sum_{i=1}^{N} r_{t}^{(i)} \\,\\frac{w_{t}^{(i)}}{r_{t}^{(i)}} \\,\\phi_{t}^{(i)}\n\\;=\\; \\sum_{i=1}^{N} w_{t}^{(i)} \\,\\phi_{t}^{(i)}\n\\;=\\; \\hat{\\phi}_{t}.\n$$\n因此，当使用 $s_{t}^{(i)}$ 时，每种方案都产生 $\\hat{\\phi}_{t}$ 的条件无偏估计量。\n\n条件方差取决于 $\\{I_{j}\\}$ 的依赖结构。我们现在依次处理每种方案。\n\n分层重采样。令 $U_{j} \\sim \\mathrm{Uniform}\\!\\left(\\frac{j-1}{N},\\frac{j}{N}\\right)$ 对于 $j=1,\\dots,N$ 独立同分布，并定义累积和\n$$\nR_{t}^{(i)} \\;=\\; \\sum_{k=1}^{i} r_{t}^{(k)}, \\quad R_{t}^{(0)} = 0,\n$$\n以及索引映射 $I_{j} = i$（当 $U_{j} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right)$ 时）。那么 $\\hat{\\phi}_{t}^{(R)}$ 可以写成\n$$\n\\hat{\\phi}_{t}^{(R)} \\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} g_{t}(U_{j}), \\quad \\text{其中} \\quad g_{t}(u) = s_{t}^{(i)} \\ \\text{若} \\ u \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right).\n$$\n由于 $U_{j}$ 在 $j$ 上是独立的，我们有\n$$\n\\mathrm{Var}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; \\frac{1}{N^{2}} \\sum_{j=1}^{N} \\mathrm{Var}\\!\\left( g_{t}(U_{j}) \\right).\n$$\n对于每个分层 $j$，$g_{t}(U_{j})$ 在 $U_{j} \\in \\left(\\frac{j-1}{N},\\frac{j}{N}\\right)$ 上的期望和二阶矩等于\n$$\n\\mathbb{E}\\!\\left[ g_{t}(U_{j}) \\right] \\;=\\; N \\sum_{i=1}^{N} s_{t}^{(i)} \\, L_{t}(i,j), \n\\qquad \\mathbb{E}\\!\\left[ g_{t}(U_{j})^{2} \\right] \\;=\\; N \\sum_{i=1}^{N} \\left( s_{t}^{(i)} \\right)^{2} \\, L_{t}(i,j),\n$$\n其中 $L_{t}(i,j) = \\left| \\left[R_{t}^{(i-1)}, R_{t}^{(i)}\\right) \\cap \\left[ \\tfrac{j-1}{N}, \\tfrac{j}{N} \\right) \\right|$ 是交集长度。因此\n$$\n\\mathrm{Var}\\!\\left( g_{t}(U_{j}) \\right)\n\\;=\\; N \\sum_{i=1}^{N} \\left( s_{t}^{(i)} \\right)^{2} \\, L_{t}(i,j) \\;-\\; \\left( N \\sum_{i=1}^{N} s_{t}^{(i)} \\, L_{t}(i,j) \\right)^{2}.\n$$\n对 $j$ 求和并使用 $\\sum_{j=1}^{N} L_{t}(i,j) = r_{t}^{(i)}$，得到闭式形式\n$$\n\\mathrm{Var}_{\\mathrm{strat}}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; \\frac{1}{N} \\sum_{i=1}^{N} r_{t}^{(i)} \\left( s_{t}^{(i)} \\right)^{2} \\;-\\; \\sum_{j=1}^{N} \\left( \\sum_{i=1}^{N} s_{t}^{(i)} \\, L_{t}(i,j) \\right)^{2}.\n$$\n代入 $s_{t}^{(i)} = \\frac{w_{t}^{(i)}}{r_{t}^{(i)}} \\phi_{t}^{(i)}$ 将第一项简化为 $\\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left(w_{t}^{(i)}\\right)^{2}}{r_{t}^{(i)}} \\left( \\phi_{t}^{(i)} \\right)^{2}$。\n\n残差重采样。将 $N r_{t}^{(i)} = a_{t}^{(i)} + \\rho_{t}^{(i)}$ 分解，其中 $a_{t}^{(i)} = \\lfloor N r_{t}^{(i)} \\rfloor$ 且 $\\rho_{t}^{(i)} \\in [0,1)$。该方案确定性地分配索引 $i$ 的 $a_{t}^{(i)}$ 个副本，然后从概率为 $\\bar{r}_{t}^{(i)} = \\rho_{t}^{(i)} / R_{\\mathrm{res}}$ 的分类分布中抽取 $R_{\\mathrm{res}} = \\sum_{i=1}^{N} \\rho_{t}^{(i)}$ 个额外的副本。写作\n$$\n\\hat{\\phi}_{t}^{(R)} \\;=\\; \\frac{1}{N} \\left( \\sum_{i=1}^{N} a_{t}^{(i)} s_{t}^{(i)} \\;+\\; \\sum_{j=1}^{R_{\\mathrm{res}}} s_{t}^{\\big(I'_{j}\\big)} \\right),\n$$\n其中 $I'_{j}$ 是从 $\\bar{r}_{t}$ 中独立抽取的样本，唯一的随机部分是残差和。因此\n$$\n\\mathrm{Var}_{\\mathrm{resid}}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; \\frac{1}{N^{2}} \\,\\mathrm{Var}\\!\\left( \\sum_{j=1}^{R_{\\mathrm{res}}} s_{t}^{\\big(I'_{j}\\big)} \\right)\n\\;=\\; \\frac{R_{\\mathrm{res}}}{N^{2}} \\left( \\sum_{i=1}^{N} \\bar{r}_{t}^{(i)} \\left( s_{t}^{(i)} \\right)^{2} \\;-\\; \\left( \\sum_{i=1}^{N} \\bar{r}_{t}^{(i)} s_{t}^{(i)} \\right)^{2} \\right).\n$$\n代入 $\\bar{r}_{t}^{(i)} = \\rho_{t}^{(i)} / R_{\\mathrm{res}}$ 并化简得到\n$$\n\\mathrm{Var}_{\\mathrm{resid}}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; \\frac{1}{N^{2}} \\left( \\sum_{i=1}^{N} \\rho_{t}^{(i)} \\left( s_{t}^{(i)} \\right)^{2} \\;-\\; \\frac{1}{R_{\\mathrm{res}}} \\left( \\sum_{i=1}^{N} \\rho_{t}^{(i)} s_{t}^{(i)} \\right)^{2} \\right).\n$$\n\n系统重采样。令 $U \\sim \\mathrm{Uniform}\\!\\left(0,\\frac{1}{N}\\right)$，定义 $U_{j} = \\frac{U + j - 1}{N}$，并当 $U_{j} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right)$ 时设 $I_{j} = i$。定义\n$$\nh_{t}(u) \\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} g_{t}\\!\\left( \\tfrac{u + j - 1}{N} \\right)\n\\;=\\; \\frac{1}{N} \\sum_{j=1}^{N} \\sum_{i=1}^{N} s_{t}^{(i)} \\,\\mathbf{1}\\!\\left\\{ \\tfrac{u + j - 1}{N} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right) \\right\\}.\n$$\n那么 $\\hat{\\phi}_{t}^{(R)} = h_{t}(U)$ 并且\n$$\n\\mathrm{Var}_{\\mathrm{sys}}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; \\mathbb{E}\\!\\left[ h_{t}(U)^{2} \\right] \\;-\\; \\left( \\mathbb{E}\\!\\left[ h_{t}(U) \\right] \\right)^{2}.\n$$\n注意到 $U$ 在 $\\left(0,\\tfrac{1}{N}\\right)$ 上的密度为 $N$，并且根据无偏性有 $\\mathbb{E}\\!\\left[ h_{t}(U) \\right] = \\sum_{i=1}^{N} w_{t}^{(i)} \\phi_{t}^{(i)}$，我们得到积分表示\n$$\n\\mathrm{Var}_{\\mathrm{sys}}\\!\\left( \\hat{\\phi}_{t}^{(R)} \\,\\big|\\, \\{x_{t}^{(i)},w_{t}^{(i)},m_{t}^{(i)}\\} \\right)\n\\;=\\; N \\int_{0}^{\\frac{1}{N}} \\left( \\frac{1}{N} \\sum_{j=1}^{N} \\sum_{i=1}^{N} s_{t}^{(i)} \\,\\mathbf{1}\\!\\left\\{ \\tfrac{u + j - 1}{N} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right) \\right\\} \\right)^{2} \\,\\mathrm{d}u \\;-\\; \\left( \\sum_{i=1}^{N} w_{t}^{(i)} \\phi_{t}^{(i)} \\right)^{2}.\n$$\n\n收集这三个表达式，并重新引入简写 $s_{t}^{(i)} = \\frac{w_{t}^{(i)}}{r_{t}^{(i)}} \\phi_{t}^{(i)}$，$R_{t}^{(i)} = \\sum_{k=1}^{i} r_{t}^{(k)}$，$L_{t}(i,j) = \\left| \\left[R_{t}^{(i-1)}, R_{t}^{(i)}\\right) \\cap \\left[ \\tfrac{j-1}{N}, \\tfrac{j}{N} \\right) \\right|$，以及 $R_{\\mathrm{res}} = \\sum_{i=1}^{N} \\rho_{t}^{(i)}$（其中 $\\rho_{t}^{(i)} = N r_{t}^{(i)} - \\lfloor N r_{t}^{(i)} \\rfloor$），我们有：\n\n- 系统重采样方差：\n$$\nV_{\\mathrm{sys}} \\;=\\; N \\int_{0}^{\\frac{1}{N}} \\left( \\frac{1}{N} \\sum_{j=1}^{N} \\sum_{i=1}^{N} s_{t}^{(i)} \\,\\mathbf{1}\\!\\left\\{ \\tfrac{u + j - 1}{N} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right) \\right\\} \\right)^{2} \\,\\mathrm{d}u \\;-\\; \\left( \\sum_{i=1}^{N} w_{t}^{(i)} \\phi_{t}^{(i)} \\right)^{2}.\n$$\n\n- 分层重采样方差：\n$$\nV_{\\mathrm{strat}} \\;=\\; \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\left(w_{t}^{(i)}\\right)^{2}}{r_{t}^{(i)}} \\left( \\phi_{t}^{(i)} \\right)^{2} \\;-\\; \\sum_{j=1}^{N} \\left( \\sum_{i=1}^{N} s_{t}^{(i)} \\, L_{t}(i,j) \\right)^{2}.\n$$\n\n- 残差重采样方差：\n$$\nV_{\\mathrm{resid}} \\;=\\; \\frac{1}{N^{2}} \\left( \\sum_{i=1}^{N} \\rho_{t}^{(i)} \\left( s_{t}^{(i)} \\right)^{2} \\;-\\; \\frac{1}{R_{\\mathrm{res}}} \\left( \\sum_{i=1}^{N} \\rho_{t}^{(i)} s_{t}^{(i)} \\right)^{2} \\right).\n$$\n\n这些是在辅助粒子滤波器中，系统、分层和残差重采样下 $\\hat{\\phi}_{t}$ 的 Horvitz–Thompson 重采样估计量的闭式条件方差。", "answer": "$$\\boxed{\\begin{pmatrix}\nN \\displaystyle\\int_{0}^{\\frac{1}{N}} \\left( \\frac{1}{N} \\sum_{j=1}^{N} \\sum_{i=1}^{N} s_{t}^{(i)} \\,\\mathbf{1}\\!\\left\\{ \\tfrac{u + j - 1}{N} \\in \\left[ R_{t}^{(i-1)}, R_{t}^{(i)} \\right) \\right\\} \\right)^{2} \\mathrm{d}u \\;-\\; \\left( \\sum_{i=1}^{N} w_{t}^{(i)} \\phi_{t}^{(i)} \\right)^{2}\n\n\\frac{1}{N} \\displaystyle\\sum_{i=1}^{N} \\frac{\\left(w_{t}^{(i)}\\right)^{2}}{r_{t}^{(i)}} \\left( \\phi_{t}^{(i)} \\right)^{2} \\;-\\; \\displaystyle\\sum_{j=1}^{N} \\left( \\sum_{i=1}^{N} s_{t}^{(i)} \\, L_{t}(i,j) \\right)^{2}\n\n\\frac{1}{N^{2}} \\left( \\displaystyle\\sum_{i=1}^{N} \\rho_{t}^{(i)} \\left( s_{t}^{(i)} \\right)^{2} \\;-\\; \\frac{1}{R_{\\mathrm{res}}} \\left( \\displaystyle\\sum_{i=1}^{N} \\rho_{t}^{(i)} s_{t}^{(i)} \\right)^{2} \\right)\n\\end{pmatrix}}$$", "id": "3366188"}, {"introduction": "正则化是缓解粒子贫化、提高粒子多样性的有效策略，但代价是可能增加后验估计的方差。本练习在一个简化的线性高斯模型中，量化分析了这种权衡关系，并将正则化核的带宽与费雪信息（Fisher Information）这一关键统计量联系起来。通过推导“收缩保持因子”，你将学会如何通过数据驱动的方式设置正则化强度，并精确理解正则化对贝叶斯后验收缩速度的影响。[@problem_id:3366177]", "problem": "考虑一个标量静态参数 $\\theta \\in \\mathbb{R}$，在一个数据同化设置中进行序贯估计。在时间 $t$，先验分布是高斯分布，$\\theta \\sim \\mathcal{N}(m_{t-1}, \\tau_{t-1}^{2})$，观测模型为 $y_{t} = \\theta + \\varepsilon_{t}$，其中 $\\varepsilon_{t} \\sim \\mathcal{N}(0, \\sigma^{2})$，且与 $\\theta$ 独立。使用带有正则化粒子滤波器 (RPF) 步骤的辅助粒子滤波器 (APF)：在由局部预测似然引导的重要性加权和重采样之后，通过向每个重采样后的粒子添加一个独立的高斯抖动 $\\zeta \\sim \\mathcal{N}(0, h_{t}^{2})$ 来对粒子进行正则化。带宽 $h_{t}$ 通过局部 Fisher 信息 $I_{t}(\\theta)$ 来选择，即 $h_{t} = c\\, I_{t}(\\theta)^{-1/2}$，其中 $c \\in (0, \\infty)$ 是一个固定常数，$I_{t}(\\theta)$ 定义为 $I_{t}(\\theta) = -\\mathbb{E}\\left[\\partial^{2}_{\\theta} \\ln p(y_{t} \\mid \\theta)\\right]$，期望是在真实参数值下的观测模型下计算的。\n\n从贝叶斯更新、Fisher 信息和高斯卷积性质的定义出发，推导收缩保留因子\n$$\\kappa(c) = \\frac{\\text{时间 } t \\text{ 的精确后验方差}}{\\text{时间 } t \\text{ 的正则化后验方差}},$$\n的精确表达式，用 $\\tau_{t-1}$、$\\sigma$ 和 $c$ 表示。您的答案必须是单一的闭式解析表达式。无需四舍五入，也无需单位。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 待估计的参数是一个标量 $\\theta \\in \\mathbb{R}$。\n- 设置是在时间 $t$ 的序贯数据同化。\n- $\\theta$ 的先验分布是高斯分布：$\\theta \\sim \\mathcal{N}(m_{t-1}, \\tau_{t-1}^{2})$。\n- 观测模型是线性和高斯的：$y_{t} = \\theta + \\varepsilon_{t}$。\n- 观测噪声为 $\\varepsilon_{t} \\sim \\mathcal{N}(0, \\sigma^{2})$，且与 $\\theta$ 独立。\n- 估计方法是带有正则化粒子滤波器 (RPF) 步骤的辅助粒子滤波器 (APF)。\n- 正则化涉及向每个重采样后的粒子添加一个高斯抖动 $\\zeta \\sim \\mathcal{N}(0, h_{t}^{2})$。\n- 正则化带宽 $h_{t}$ 定义为 $h_{t} = c\\, I_{t}(\\theta)^{-1/2}$，其中 $c$ 是一个固定的正常数，$c \\in (0, \\infty)$。\n- Fisher 信息 $I_{t}(\\theta)$ 定义为 $I_{t}(\\theta) = -\\mathbb{E}\\left[\\partial^{2}_{\\theta} \\ln p(y_{t} \\mid \\theta)\\right]$，其中期望是在观测模型 $p(y_t | \\theta)$ 下计算的。\n- 目标是推导收缩保留因子 $\\kappa(c) = \\frac{\\text{时间 } t \\text{ 的精确后验方差}}{\\text{时间 } t \\text{ 的正则化后验方差}}$。\n- $\\kappa(c)$ 的最终表达式必须用 $\\tau_{t-1}$、$\\sigma$ 和 $c$ 来表示。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于贝叶斯统计、滤波理论（特别是粒子滤波器）和信息论（Fisher 信息）的既定原则。所有模型和概念（高斯分布、线性模型、RPF、APF）在反问题和数据同化领域都是标准的。\n- **良态问题：** 该问题是完全指定的。它提供了推导所求量所需的所有模型、参数和定义。术语“精确后验方差”指的是在这个简单共轭模型中的解析贝叶斯后验方差。“正则化后验方差”的定义也很明確，即精确后验与正则化核的卷积所产生的方差，这是核密度估计和正则化粒子滤波器中的一个标准操作。可以推导出一个唯一的、有意义的解。\n- **客观性：** 该问题以精确的数学语言陈述，没有任何主观性或模糊性。\n\n**第三步：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、是良态问题且客观。下面将进行求解。\n\n### 收缩保留因子的推导\n\n收缩保留因子 $\\kappa(c)$ 是两个方差的比值：精确后验方差和正则化后验方差。我们将依次推導這两个量。\n\n首先，我们计算时间 $t$ 的精确后验方差，记为 $\\tau_{\\text{post}}^{2}$。该问题描述了一个具有高斯先验和高斯似然的标准贝叶斯更新。\n先验分布为 $p(\\theta) = \\mathcal{N}(\\theta \\mid m_{t-1}, \\tau_{t-1}^{2})$。\n似然函数，从观测模型 $y_{t} = \\theta + \\varepsilon_{t}$（其中 $\\varepsilon_t \\sim \\mathcal{N}(0, \\sigma^2)$）导出，为 $p(y_{t} \\mid \\theta) = \\mathcal{N}(y_t \\mid \\theta, \\sigma^2)$。\n\n对于高斯分布，后验分布也是高斯分布。其精度（方差的倒数）是先验精度与似然精度（相对于 $\\theta$）之和。\n先验的精度是 $\\frac{1}{\\tau_{t-1}^{2}}$。\n似然的精度是 $\\frac{1}{\\sigma^{2}}$。\n因此，后验的精度是：\n$$\n(\\tau_{\\text{post}}^{2})^{-1} = \\frac{1}{\\tau_{t-1}^{2}} + \\frac{1}{\\sigma^{2}} = \\frac{\\sigma^{2} + \\tau_{t-1}^{2}}{\\tau_{t-1}^{2}\\sigma^{2}}\n$$\n由此，精确后验方差为：\n$$\n\\tau_{\\text{post}}^{2} = \\frac{\\tau_{t-1}^{2}\\sigma^{2}}{\\tau_{t-1}^{2} + \\sigma^{2}}\n$$\n\n接下来，我们确定正则化后验方差。正则化步骤向粒子添加了一个独立的高斯抖动 $\\zeta \\sim \\mathcal{N}(0, h_{t}^{2})$，在粒子数量趋于无穷的极限情况下，这些粒子服从精确后验分布 $\\mathcal{N}(m_t, \\tau_{\\text{post}}^{2})$。设 $\\theta_{\\text{post}}$ 是表示从精确后验分布中抽取的一个随机变量。正则化后的变量为 $\\theta_{\\text{reg}} = \\theta_{\\text{post}} + \\zeta$。由于 $\\theta_{\\text{post}}$ 和 $\\zeta$ 是独立的，它们之和的方差等于它们各自方差之和：\n$$\n\\text{Var}(\\theta_{\\text{reg}}) = \\text{Var}(\\theta_{\\text{post}}) + \\text{Var}(\\zeta) = \\tau_{\\text{post}}^{2} + h_{t}^{2}\n$$\n这就是正则化后验方差。为了继续推导，我们必须计算 $h_{t}^{2}$。\n\n带宽 $h_{t}$ 通过 $h_{t}^{2} = c^{2} I_{t}(\\theta)^{-1}$ 依赖于 Fisher 信息 $I_{t}(\\theta)$。我们现在计算 $I_{t}(\\theta)$。\n对数似然是：\n$$\n\\ln p(y_{t} \\mid \\theta) = \\ln \\left( \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}} \\exp\\left(-\\frac{(y_{t} - \\theta)^{2}}{2\\sigma^{2}}\\right) \\right) = -\\frac{1}{2}\\ln(2\\pi\\sigma^{2}) - \\frac{(y_{t} - \\theta)^{2}}{2\\sigma^{2}}\n$$\n关于 $\\theta$ 的一阶导数是：\n$$\n\\frac{\\partial}{\\partial\\theta} \\ln p(y_{t} \\mid \\theta) = - \\frac{2(y_{t} - \\theta)(-1)}{2\\sigma^{2}} = \\frac{y_{t} - \\theta}{\\sigma^{2}}\n$$\n关于 $\\theta$ 的二阶导数是：\n$$\n\\frac{\\partial^{2}}{\\partial\\theta^{2}} \\ln p(y_{t} \\mid \\theta) = -\\frac{1}{\\sigma^{2}}\n$$\nFisher 信息是该量的负期望。由于二阶导数是一个常数，不依赖于随机变量 $y_{t}$，因此期望的计算是平凡的：\n$$\nI_{t}(\\theta) = -\\mathbb{E}\\left[ -\\frac{1}{\\sigma^{2}} \\right] = \\frac{1}{\\sigma^{2}}\n$$\n现在我们可以确定抖动方差 $h_{t}^{2}$：\n$$\nh_{t}^{2} = c^{2} I_{t}(\\theta)^{-1} = c^{2} \\left(\\frac{1}{\\sigma^{2}}\\right)^{-1} = c^{2}\\sigma^{2}\n$$\n因此，正则化后验方差为：\n$$\n\\text{Var}(\\theta_{\\text{reg}}) = \\tau_{\\text{post}}^{2} + c^{2}\\sigma^{2} = \\frac{\\tau_{t-1}^{2}\\sigma^{2}}{\\tau_{t-1}^{2} + \\sigma^{2}} + c^{2}\\sigma^{2}\n$$\n\n最后，我们可以计算收缩保留因子 $\\kappa(c)$：\n$$\n\\kappa(c) = \\frac{\\text{精确后验方差}}{\\text{正则化后验方差}} = \\frac{\\tau_{\\text{post}}^{2}}{\\tau_{\\text{post}}^{2} + h_{t}^{2}}\n$$\n代入推导出的表达式：\n$$\n\\kappa(c) = \\frac{\\frac{\\tau_{t-1}^{2}\\sigma^{2}}{\\tau_{t-1}^{2} + \\sigma^{2}}}{\\frac{\\tau_{t-1}^{2}\\sigma^{2}}{\\tau_{t-1}^{2} + \\sigma^{2}} + c^{2}\\sigma^{2}}\n$$\n为了简化这个繁分数，我们可以将分子和分母同乘以 $\\tau_{t-1}^{2} + \\sigma^{2}$：\n$$\n\\kappa(c) = \\frac{\\tau_{t-1}^{2}\\sigma^{2}}{\\tau_{t-1}^{2}\\sigma^{2} + c^{2}\\sigma^{2}(\\tau_{t-1}^{2} + \\sigma^{2})}\n$$\n由于 $\\sigma  0$ 是一个物理参数（噪声的标准差），所以 $\\sigma^{2} \\neq 0$，我们可以从分母中提出因子 $\\sigma^{2}$，并与分子中的 $\\sigma^{2}$ 相消：\n$$\n\\kappa(c) = \\frac{\\tau_{t-1}^{2}}{\\tau_{t-1}^{2} + c^{2}(\\tau_{t-1}^{2} + \\sigma^{2})}\n$$\n这就是收缩保留因子的最终闭式解析表达式。它也可以写成 $\\kappa(c) = \\frac{\\tau_{t-1}^{2}}{(1+c^{2})\\tau_{t-1}^{2} + c^{2}\\sigma^{2}}$。在最终答案中，我们将使用前一种表示形式。", "answer": "$$\\boxed{\\frac{\\tau_{t-1}^{2}}{\\tau_{t-1}^{2} + c^{2}(\\tau_{t-1}^{2} + \\sigma^{2})}}$$", "id": "3366177"}, {"introduction": "Liu-West滤波器是一种精巧的正则化方法，它通过收缩（shrinkage）和抖动（jitter）来保持粒子集的均值和方差。本练习将带你深入该算法的核心机制，并探讨一个更高级的话题：如何自适应地调整算法参数以达到最优性能。通过分析一个用于调节收缩因子的自适应规则的稳定性，你将把统计滤波的知识与控制理论中的概念结合起来，从而掌握设计和验证稳健自适应滤波算法的技能。[@problem_id:3366149]", "problem": "考虑一个静态参数数据同化问题，其中参数 $\\theta$ 在时间 $t-1$ 时由两个权重相等、位置分别为 $\\theta_{t-1}^{(1)} = m + d$ 和 $\\theta_{t-1}^{(2)} = m - d$ 的粒子近似，其中 $m \\in \\mathbb{R}$ 且 $d > 0$。一个新的观测值 $y_t$ 到达，它由一个高斯似然 $y_t \\mid \\theta \\sim \\mathcal{N}(\\theta, R)$ 生成，其中方差 $R > 0$ 已知。假设 $y_t = m + \\Delta$，其中 $\\Delta \\in \\mathbb{R}$。一个与 Liu–West 正则化相结合的辅助粒子滤波器 (APF) 使用收缩规则为参数提出中间均值\n$$\n\\mu_i(a) = a \\,\\theta_{t-1}^{(i)} + (1-a)\\, \\bar{\\theta}_{t-1}, \\quad \\bar{\\theta}_{t-1} = m, \\quad i \\in \\{1,2\\},\n$$\n并向每个 $\\mu_i(a)$ 注入高斯抖动 $\\epsilon^{(i)} \\sim \\mathcal{N}(0, h^2 d^2)$，同时满足 Liu–West 方差保持约束 $a^2 + h^2 = 1$ 和 $a \\in (0,1)$。APF 的第一阶段选择概率与在 $\\mu_i(a)$ 处评估的预测似然成正比，\n$$\np_i(a) \\propto \\exp\\!\\left( -\\frac{(y_t - \\mu_i(a))^2}{2R} \\right), \\quad i \\in \\{1,2\\},\n$$\n并且被选择的提议分布为 $\\theta_t^{(i)} = \\mu_i(a) + \\epsilon^{(i)}$。\n\n从以上定义出发，推导经过选择和抖动后提议的 $\\theta_t$ 的经验方差，并将其表示为 $a$、$d$、$R$ 和 $\\Delta$ 的函数。然后，使用经过充分检验的线性高斯模型的高斯共轭更新，写出目标后验方差\n$$\nV^{\\ast} = \\left( d^{-2} + R^{-1} \\right)^{-1}.\n$$\n考虑 Liu–West 收缩的自适应规则，\n$$\na_{t+1} = a_t + \\eta \\left( V_{\\mathrm{emp}}(a_t) - V^{\\ast} \\right),\n$$\n其中 $V_{\\mathrm{emp}}(a)$ 是上面推导出的经验方差，$\\eta > 0$ 是一个标量增益。通过在满足 $V_{\\mathrm{emp}}(a^{\\ast}) = V^{\\ast}$ 的不动点 $a^{\\ast}$ 附近进行线性化，分析此一维离散时间自适应的稳定性，并根据导数 $V_{\\mathrm{emp}}'(a^{\\ast})$ 推导局部渐近稳定性的最大允许增益 $\\eta_{\\max}$。\n\n最后，对于具体的、科学上一致的参数选择 $d = 1$，$R = 0.5$ 和 $\\Delta = 1$，计算 $\\eta_{\\max}$ 的数值。将您的答案四舍五入到四位有效数字。最终答案必须是一个不带单位的实数。", "solution": "该问题要求推导 Liu–West 收缩参数 $a$ 的自适应规则的最大稳定增益 $\\eta_{\\max}$。这包括几个步骤：推导粒子集的经验方差，分析离散时间自适应映射的稳定性，以及最后计算一个数值。\n\n首先，我们建立辅助粒子滤波器 (APF) 步骤中关键量的表达式。先验粒子为 $\\theta_{t-1}^{(1)} = m + d$ 和 $\\theta_{t-1}^{(2)} = m - d$。先验均值为 $\\bar{\\theta}_{t-1} = \\frac{1}{2}(\\theta_{t-1}^{(1)} + \\theta_{t-1}^{(2)}) = m$。收缩规则将中间均值 $\\mu_i(a)$ 定义为：\n$$\n\\mu_1(a) = a\\,\\theta_{t-1}^{(1)} + (1-a)\\,\\bar{\\theta}_{t-1} = a(m+d) + (1-a)m = m + ad\n$$\n$$\n\\mu_2(a) = a\\,\\theta_{t-1}^{(2)} + (1-a)\\,\\bar{\\theta}_{t-1} = a(m-d) + (1-a)m = m - ad\n$$\nAPF 的第一阶段选择概率 $p_i(a)$ 与在这些均值处评估的预测似然成正比。观测值为 $y_t = m+\\Delta$，似然为方差为 $R$ 的高斯分布。\n权重 $w_i(a)$ 由 $w_i(a) = \\exp\\left( -\\frac{(y_t - \\mu_i(a))^2}{2R} \\right)$ 给出。\n对于 $i=1$：$y_t - \\mu_1(a) = (m+\\Delta) - (m+ad) = \\Delta - ad$。\n对于 $i=2$：$y_t - \\mu_2(a) = (m+\\Delta) - (m-ad) = \\Delta + ad$。\n未归一化的权重为：\n$$\nw_1(a) = \\exp\\left( -\\frac{(\\Delta - ad)^2}{2R} \\right), \\quad w_2(a) = \\exp\\left( -\\frac{(\\Delta + ad)^2}{2R} \\right)\n$$\n归一化后的概率为 $p_1(a) = \\frac{w_1(a)}{w_1(a)+w_2(a)}$ 和 $p_2(a) = \\frac{w_2(a)}{w_1(a)+w_2(a)}$。\n\n接下来，我们推导提议粒子的经验方差 $V_{\\mathrm{emp}}(a)$。提议的粒子为 $\\theta_t^{(j)} \\sim \\sum_{i=1}^2 p_i(a) \\mathcal{N}(\\mu_i(a), h^2 d^2)$，其中 $j \\in \\{1,2\\}$ 是新粒子的索引。这描述了一个高斯混合分布。混合分布的方差由全方差公式给出：\n$$\nV_{\\mathrm{emp}}(a) = \\mathrm{Var}(\\theta_t) = E_k[\\mathrm{Var}(\\theta_t|k)] + \\mathrm{Var}_k(E[\\theta_t|k])\n$$\n其中期望和方差是关于以概率 $\\{p_1(a), p_2(a)\\}$ 选择索引 $k \\in \\{1,2\\}$ 的。\n内部条件方差为 $\\mathrm{Var}(\\theta_t|k=i) = \\mathrm{Var}(\\mu_i(a) + \\epsilon^{(i)}) = \\mathrm{Var}(\\epsilon^{(i)}) = h^2 d^2$。由于这对任何 $i$ 都是常数，其期望为 $E_k[\\mathrm{Var}(\\theta_t|k)] = h^2 d^2$。\n内部条件均值为 $E[\\theta_t|k=i] = \\mu_i(a)$。该量关于 $k$ 的方差为：\n$$\n\\mathrm{Var}_k(E[\\theta_t|k]) = \\mathrm{Var}_k(\\mu_k(a)) = E[\\mu_k(a)^2] - (E[\\mu_k(a)])^2\n$$\n$$\n= (p_1(a)\\mu_1(a)^2 + p_2(a)\\mu_2(a)^2) - (p_1(a)\\mu_1(a) + p_2(a)\\mu_2(a))^2 = p_1(a)p_2(a)(\\mu_1(a)-\\mu_2(a))^2\n$$\n我们有 $\\mu_1(a) - \\mu_2(a) = (m+ad) - (m-ad) = 2ad$。\n概率的乘积 $p_1(a)p_2(a)$ 可以简化为：\n$$\np_1(a)p_2(a) = \\frac{w_1(a)w_2(a)}{(w_1(a)+w_2(a))^2} = \\frac{\\exp\\left(-\\frac{(\\Delta-ad)^2+(\\Delta+ad)^2}{2R}\\right)}{\\left(\\exp\\left(-\\frac{(\\Delta-ad)^2}{2R}\\right) + \\exp\\left(-\\frac{(\\Delta+ad)^2}{2R}\\right)\\right)^2}\n$$\n令分母中指数的参数为 $-L_1$ 和 $-L_2$。乘积为 $\\frac{\\exp(-L_1-L_2)}{(\\exp(-L_1)+\\exp(-L_2))^2} = \\frac{1}{(\\exp(L_1)+\\exp(L_2))(\\exp(-L_1)+\\exp(-L_2))} = \\frac{1}{2 + \\exp(L_1-L_2) + \\exp(-(L_1-L_2))}$。\n$L_1 - L_2 = \\frac{1}{2R}[(\\Delta+ad)^2 - (\\Delta-ad)^2] = \\frac{1}{2R}[4\\Delta ad] = \\frac{2\\Delta ad}{R}$。\n所以，$p_1(a)p_2(a) = \\frac{1}{2+2\\cosh(\\frac{2\\Delta ad}{R})} = \\frac{1}{4\\cosh^2(\\frac{\\Delta ad}{R})}$。\n将这些代入方差表达式：\n$$\nV_{\\mathrm{emp}}(a) = h^2 d^2 + p_1(a)p_2(a)(\\mu_1(a)-\\mu_2(a))^2 = h^2 d^2 + \\frac{1}{4\\cosh^2(\\frac{\\Delta ad}{R})} (2ad)^2\n$$\n使用 Liu-West 约束 $h^2 = 1 - a^2$，我们得到：\n$$\nV_{\\mathrm{emp}}(a) = (1-a^2) d^2 + \\frac{4a^2d^2}{4\\cosh^2(\\frac{\\Delta ad}{R})} = d^2 \\left( 1 - a^2 + \\frac{a^2}{\\cosh^2(\\frac{\\Delta ad}{R})} \\right)\n$$\n使用恒等式 $1 - \\mathrm{sech}^2(x) = \\tanh^2(x)$，或 $1 - \\frac{1}{\\cosh^2(x)} = \\tanh^2(x)$：\n$$\nV_{\\mathrm{emp}}(a) = d^2 \\left( 1 - a^2 \\left( 1 - \\frac{1}{\\cosh^2(\\frac{\\Delta ad}{R})} \\right) \\right) = d^2 \\left( 1 - a^2 \\tanh^2\\left(\\frac{\\Delta ad}{R}\\right) \\right)\n$$\n这就是所求的经验方差表达式。\n\n问题给出了高斯先验（方差为 $d^2$）和高斯似然（方差为 $R$）的目标后验方差，即 $V^{\\ast} = \\left( (d^2)^{-1} + R^{-1} \\right)^{-1} = \\frac{d^2 R}{d^2 + R}$。\n自适应规则为 $a_{t+1} = a_t + \\eta (V_{\\mathrm{emp}}(a_t) - V^{\\ast})$。这是一个一维离散映射 $a_{t+1} = g(a_t)$，其中 $g(a) = a + \\eta (V_{\\mathrm{emp}}(a) - V^{\\ast})$。该映射的一个不动点 $a^{\\ast}$ 满足 $g(a^{\\ast}) = a^{\\ast}$，这意味着 $V_{\\mathrm{emp}}(a^{\\ast}) = V^{\\ast}$。\n在 $a^{\\ast}$ 附近的局部渐近稳定性要求 $|g'(a^{\\ast})|  1$。\n导数为 $g'(a) = 1 + \\eta V_{\\mathrm{emp}}'(a)$。因此，我们需要 $|1 + \\eta V_{\\mathrm{emp}}'(a^{\\ast})|  1$，这等价于 $-2  \\eta V_{\\mathrm{emp}}'(a^{\\ast})  0$。\n为了求 $V_{\\mathrm{emp}}'(a)$，令 $C = \\frac{\\Delta d}{R}$。则 $V_{\\mathrm{emp}}(a) = d^2(1 - a^2\\tanh^2(Ca))$。\n$$\nV_{\\mathrm{emp}}'(a) = -d^2 \\frac{d}{da} \\left( [a \\tanh(Ca)]^2 \\right) = -d^2 \\cdot 2 a \\tanh(Ca) \\left( \\tanh(Ca) + a C \\mathrm{sech}^2(Ca) \\right)\n$$\n$$\nV_{\\mathrm{emp}}'(a) = -2d^2 \\left( a\\tanh^2(Ca) + Ca^2\\tanh(Ca)\\mathrm{sech}^2(Ca) \\right)\n$$\n由于 $a, C, d, R$ 均为正数，$\\tanh$ 和 $\\mathrm{sech}^2$ 也是正的，因此对于 $a \\in (0,1)$ 有 $V_{\\mathrm{emp}}'(a)  0$。稳定性条件变为 $0  \\eta  \\frac{-2}{V_{\\mathrm{emp}}'(a^{\\ast})}$。\n最大稳定增益为 $\\eta_{\\max} = \\frac{-2}{V_{\\mathrm{emp}}'(a^{\\ast})}$。\n\n我们现在代入具体参数 $d=1$，$R=0.5$ 和 $\\Delta=1$。\n常数 $C$ 为 $C = \\frac{1 \\cdot 1}{0.5} = 2$。\n目标方差为 $V^{\\ast} = \\frac{1^2 \\cdot 0.5}{1^2+0.5} = \\frac{0.5}{1.5} = \\frac{1}{3}$。\n不动点方程 $V_{\\mathrm{emp}}(a^{\\ast}) = V^{\\ast}$ 变为：\n$$\n1^2 \\left( 1 - (a^{\\ast})^2 \\tanh^2(2a^{\\ast}) \\right) = \\frac{1}{3} \\implies (a^{\\ast})^2 \\tanh^2(2a^{\\ast}) = \\frac{2}{3}\n$$\n取正平方根（因为 $a^{\\ast} > 0$）：$a^{\\ast} \\tanh(2a^{\\ast}) = \\sqrt{\\frac{2}{3}}$。\n数值求解这个超越方程得到 $a^{\\ast} \\approx 0.868808$。\n现在，我们计算 $V_{\\mathrm{emp}}'(a^{\\ast})$。我们来计算各项：\n$Ca^{\\ast} = 2a^{\\ast} \\approx 1.737616$。\n$\\tanh(Ca^{\\ast}) \\approx 0.939824$。\n$\\tanh^2(Ca^{\\ast}) \\approx 0.883270$。\n$\\mathrm{sech}^2(Ca^{\\ast}) = 1 - \\tanh^2(Ca^{\\ast}) \\approx 1 - 0.883270 = 0.116730$。\n使用 $d=1, C=2$ 的导数表达式：\n$$\nV_{\\mathrm{emp}}'(a^{\\ast}) = -2(1)^2 \\left( a^{\\ast}\\tanh^2(2a^{\\ast}) + 2(a^{\\ast})^2\\tanh(2a^{\\ast})\\mathrm{sech}^2(2a^{\\ast}) \\right)\n$$\n使用不动点关系 $a^\\ast \\tanh(2a^\\ast) = \\sqrt{2/3}$ 对各项进行分组：\n$$\nV_{\\mathrm{emp}}'(a^{\\ast}) = -2 \\left( \\tanh(2a^{\\ast}) [a^{\\ast}\\tanh(2a^{\\ast})] + 2a^{\\ast}[a^{\\ast}\\tanh(2a^{\\ast})]\\mathrm{sech}^2(2a^{\\ast}) \\right)\n$$\n$$\nV_{\\mathrm{emp}}'(a^{\\ast}) = -2\\sqrt{\\frac{2}{3}} \\left( \\tanh(2a^{\\ast}) + 2a^{\\ast}\\mathrm{sech}^2(2a^{\\ast}) \\right)\n$$\n代入数值：\n$$\nV_{\\mathrm{emp}}'(a^{\\ast}) \\approx -2\\sqrt{\\frac{2}{3}} \\left( 0.939824 + 2(0.868808)(0.116730) \\right)\n$$\n$$\nV_{\\mathrm{emp}}'(a^{\\ast}) \\approx -2(0.816497) \\left( 0.939824 + 0.202816 \\right) \\approx -1.63299 \\left( 1.14264 \\right) \\approx -1.86548\n$$\n最后，我们计算最大增益 $\\eta_{\\max}$：\n$$\n\\eta_{\\max} = \\frac{-2}{V_{\\mathrm{emp}}'(a^{\\ast})} \\approx \\frac{-2}{-1.86548} \\approx 1.07209\n$$\n四舍五入到四位有效数字，结果是 $1.072$。", "answer": "$$\\boxed{1.072}$$", "id": "3366149"}]}