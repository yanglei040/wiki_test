## 引言
电学阻抗[层析成像](@entry_id:756051)（EIT）与[扩散光学层析成像](@entry_id:748405)（DOT）是两种功能强大的非侵入式成像技术，它们能够通过在物体边界进行的测量，无创地“看透”其内部的物理属性[分布](@entry_id:182848)。EIT通过注入微弱电流来探测内部的电导率变化，而DOT则利用近红外光来揭示组织的光学吸收与散射特性。这两种技术因其无[电离辐射](@entry_id:149143)、成本相对低廉且能够提供实时功能信息的独特优势，在临床监测、生物医学研究和工业[过程控制](@entry_id:271184)等领域展现出巨大的应用潜力。

然而，从有限的、带有噪声的边界测量数据中精确重建出高分辨率的内部参数图像，是一个极具挑战性的数学难题，即所谓的“反问题”。这些[反问题](@entry_id:143129)通常是高度[非线性](@entry_id:637147)且严重不适定的，意味着微小的测量误差可能导致重建结果出现巨大的偏差。因此，理解其背后的物理原理，掌握稳健高效的数学反演算法，是将这些技术从理论转化为实用工具的关键。

本文旨在为读者提供一个关于EIT和DOT的全面而深入的介绍。我们将分为三个核心部分：
- 在 **“原理与机制”** 一章中，我们将深入推导EIT和DOT的控制[偏微分方程](@entry_id:141332)，探讨其数学模型的异同，并揭示[反问题理论](@entry_id:750807)的核心，如唯一性、线性化和灵敏度分析。
- 接着，在 **“应用与跨学科交叉”** 一章中，我们将展示这些基本原理如何应用于解决实际问题，从用于动态监测的时间差分EIT，到用于功能成像的多[光谱](@entry_id:185632)DOT，再到与其他成像模态融合的前沿方法。
- 最后，在 **“动手实践”** 部分，我们将通过一系列精心设计的计算练习，引导您亲手实现[正问题](@entry_id:749532)求解器、验证灵敏度计算并应用[正则化方法](@entry_id:150559)，从而将理论知识转化为实践能力。

通过本文的学习，您将不仅掌握EIT和DOT的理论基础，更能理解如何将这些理论应用于开发和评估先进的成像算法，为解决科学与工程中的复杂逆问题打下坚实的基础。

## 原理与机制

本章深入探讨电学和[光学层析](@entry_id:193648)成像技术背后的核心物理原理与数学模型。我们将分别阐述电学阻抗层析成像（EIT）和[扩散光学层析成像](@entry_id:748405)（DOT）的[正问题](@entry_id:749532)（即给定物理参数计算测量值）和反问题（即根据测量值重建物体内部参数[分布](@entry_id:182848)）的理论基础。我们将从基本[守恒定律](@entry_id:269268)和[本构关系](@entry_id:186508)出发，推导出各自的控制[偏微分方程](@entry_id:141332)，并分析其边界条件和解的特性。随后，我们将讨论反问题的理论基石，包括[解的唯一性](@entry_id:143619)、反演算法中常用的线性化方法、[灵敏度分析](@entry_id:147555)技术以及[统计建模](@entry_id:272466)框架。

### [正问题](@entry_id:749532)：控制方程与模型

[正问题](@entry_id:749532)是在已知介质内部物理参数[分布](@entry_id:182848)的情况下，预测在边界上施加激励后所产生的测量响应。EIT和DOT的[正问题](@entry_id:749532)均可由一个椭圆型[偏微分方程](@entry_id:141332)来描述，但其物理来源、方程形式和边界条件存在显著差异。

#### 电学阻抗[层析成像](@entry_id:756051)（EIT）

EIT的物理基础是在准静态条件下的电磁学。在此条件下，可以忽略[位移电流](@entry_id:190231)，[电场](@entry_id:194326)可视为[无旋场](@entry_id:183486)。

**控制方程的推导**

EIT的控制方程源于两个基本物理定律：[电荷守恒](@entry_id:264158)定律和欧姆定律 [@problem_id:3378186]。

1.  **[电荷守恒](@entry_id:264158)**：在[稳态](@entry_id:182458)条件下（即电荷密度不随时间变化，$\partial_t \rho = 0$），电荷守恒定律简化为[电流密度的散度](@entry_id:266331)为零：
    $$
    \nabla \cdot \mathbf{J} = 0
    $$
    其中 $\mathbf{J}$ 是[电流密度](@entry_id:190690)矢量。

2.  **欧姆定律**：这是一个[本构关系](@entry_id:186508)，描述了局部电流密度与[电场](@entry_id:194326) $\mathbf{E}$ 之间的线性关系：
    $$
    \mathbf{J} = \sigma \mathbf{E}
    $$
    其中 $\sigma(\mathbf{x})$ 是介质的**电导率**，是EIT中需要重建的空间变量。

3.  **准静态[电场](@entry_id:194326)**：在低频下，[电场](@entry_id:194326)可近似为[无旋场](@entry_id:183486)（$\nabla \times \mathbf{E} = 0$），因此可以表示为一个标量**[电势](@entry_id:267554)** $u$ 的负梯度：
    $$
    \mathbf{E} = -\nabla u
    $$

将欧姆定律和[电势](@entry_id:267554)表达式代入[电荷守恒](@entry_id:264158)方程，我们得到EIT的控制方程，即**电导率方程**：
$$
\nabla \cdot (\sigma(\mathbf{x}) \nabla u(\mathbf{x})) = 0
$$
这是一个二阶椭圆型[偏微分方程](@entry_id:141332)。值得注意的是，该方程不包含零阶项（即与 $u$ 本身成正比的项）。对于标量[电导率](@entry_id:137481) $\sigma$，该算子是自伴的。

**边界条件与模型**

为了获得唯一解（在确定一个参考[电位](@entry_id:267554)后），必须在区域 $\Omega$ 的边界 $\partial\Omega$ 上施加适当的边界条件。在EIT中，最常用的模型有两种 [@problem_id:3378157]。

1.  **连续体模型（Continuum Model）**：此模型假设可以在边界上施加连续变化的[电流密度](@entry_id:190690)。最常见的是诺伊曼（Neumann）边界条件，即指定法向电流密度 $j = \mathbf{J} \cdot \mathbf{n} = -\sigma \frac{\partial u}{\partial \nu}$，其中 $\mathbf{n}$ 是指向边界外的[单位法向量](@entry_id:178851)。由于总注入电流必须等于总流出电流，[电流密度](@entry_id:190690) $j$ 必须满足[电荷守恒](@entry_id:264158)的**相容性条件**：
    $$
    \int_{\partial\Omega} j \, ds = 0
    $$
    从数学上讲，为了保证解的[适定性](@entry_id:148590)，[电导率](@entry_id:137481) $\sigma$ 通常被假定为有界[可测函数](@entry_id:159040)（$\sigma \in L^\infty(\Omega)$）且存在正常数下界。[电势](@entry_id:267554) $u$ 的解空间为[索博列夫空间](@entry_id:141995) $H^1(\Omega)$，并在一个常数差的意义下是唯一的。因此，解通常在商空间 $H^1(\Omega)/\mathbb{R}$ 中讨论，或通过接地条件（如 $\int_{\partial\Omega} u \, ds = 0$）来固定。

2.  **完整电极模型（Complete Electrode Model, CEM）**：CEM是更符合物理实际的模型，它考虑了有限数量的电极和电极与组织之间的**接触阻抗**。假设有 $m$ 个电极 $E_\ell$ 附着在边界上，每个电极具有接触阻抗 $z_\ell$。CEM的边界条件更为复杂，它将内部[电势](@entry_id:267554)、电极上的恒定[电势](@entry_id:267554) $U_\ell$ 以及流入/流出每个电极的总电流 $I_\ell$ 联系起来：
    -   在电极之间的[绝缘边界](@entry_id:162724)上，电流通量为零：$\sigma \frac{\partial u}{\partial \nu} = 0$。
    -   在每个电极 $E_\ell$ 上，[电势](@entry_id:267554) $u$ 和电极电势 $U_\ell$ 通过接触阻抗 $z_\ell$ 关联，形成一个类似罗宾（Robin）类型的边界条件：
        $$
        u + z_\ell \sigma \frac{\partial u}{\partial \nu} = U_\ell \quad \text{on } E_\ell
        $$
    -   通过每个电极的电流[通量积分](@entry_id:138365)等于施加的电极电流 $I_\ell$：
        $$
        \int_{E_\ell} \sigma \frac{\partial u}{\partial \nu} \, ds = I_\ell
        $$
    接触阻抗的存在意味着在电极表面会产生额外的电压降。例如，在一个一维模型中，如果通过一个长度为 $L$ 的条状物注入电流 $I$，其内部电阻为 $R_{\text{bar}}$，两端接触阻抗为 $z_1$ 和 $z_2$，那么测量的总电压 $V_{\text{true}}$ 与仅由内部电阻产生的电压 $V_{\text{mis}} = I \cdot R_{\text{bar}}$ 之间的关系为 [@problem_id:3378194]：
    $$
    V_{\text{true}} = V_{\text{mis}} + I(z_1 + z_2)
    $$
    这个简单的关系清晰地揭示了接触阻抗对测量值的直接贡献，忽略它会导致系统性的[模型误差](@entry_id:175815)。

#### [扩散光学层析成像](@entry_id:748405)（DOT）

DOT的物理基础是光在生物组织等高散射（或称“浑浊”）介质中的传播。其控制方程通常是在特定假设下从更基本的**[辐射传输](@entry_id:158448)方程（Radiative Transport Equation, RTE）** 推导出的**[扩散近似](@entry_id:147930)（Diffusion Approximation）** [@problem_id:3378162]。

**控制方程的推导**

1.  **物理假设**：[扩散近似](@entry_id:147930)的成立依赖于一个关键假设：介质是**散射主导**的，即散射系数远大于[吸收系数](@entry_id:156541)（$\mu_s \gg \mu_a$）。在这种情况下，[光子](@entry_id:145192)经历多次散射后，其方向[分布](@entry_id:182848)趋于各向同性，[光子通量](@entry_id:164816)（fluence）的梯度变化缓慢。

2.  **光学参数**：描述光传播的关键参数包括：
    -   **[吸收系数](@entry_id:156541)** $\mu_a(\mathbf{x})$：[光子](@entry_id:145192)被吸收的概率。
    -   **散射系数** $\mu_s(\mathbf{x})$：[光子](@entry_id:145192)被散射的概率。
    -   **各向异性因子** $g(\mathbf{x})$：散射方向的平均余弦。
    这些参数组合成**折合散射系数** $\mu_s' = \mu_s(1-g)$，它描述了等效的各向同性[散射强度](@entry_id:202196)。

3.  **本构关系与[守恒定律](@entry_id:269268)**：[扩散近似](@entry_id:147930)下，[光子](@entry_id:145192)流密度 $\mathbf{J}$ 与[光子通量](@entry_id:164816)率（fluence rate）$\phi$ 的梯度之间遵循**菲克定律（Fick's Law）**：
    $$
    \mathbf{J} = -\kappa \nabla \phi
    $$
    其中 $\kappa = \frac{1}{3(\mu_a + \mu_s')}$ 是**[扩散](@entry_id:141445)系数**。结合[稳态](@entry_id:182458)下的[光子](@entry_id:145192)数守恒（即[光子](@entry_id:145192)流的散度加上被吸收的[光子](@entry_id:145192)数等于[源项](@entry_id:269111) $q$），$\nabla \cdot \mathbf{J} + \mu_a \phi = q$，我们得到DOT的控制方程，即**扩散方程**：
    $$
    -\nabla \cdot (\kappa(\mathbf{x}) \nabla \phi(\mathbf{x})) + \mu_a(\mathbf{x}) \phi(\mathbf{x}) = q(\mathbf{x})
    $$
    与EIT的方程相比，DOT的扩散方程包含一个零阶项 $\mu_a \phi$，该项代表[光子](@entry_id:145192)在介质内部的吸收（一个“汇”项）。这个术语的存在从根本上改变了方程的数学性质 [@problem_id:3378186]。

**边界条件**

在DOT中，边界条件描述了光如何进出组织。由于组织与外部介质（如空气）的[折射率](@entry_id:168910)不匹配，部分射向边界的[光子](@entry_id:145192)会被内部反射回组织内。这种现象不能简单地用诺伊曼或狄利克雷边界条件来描述，而通常采用**罗宾（Robin）型边界条件** [@problem_id:3378162]：
$$
\phi(\mathbf{x}) + \ell(\mathbf{x}) \nu(\mathbf{x}) \cdot (\kappa(\mathbf{x}) \nabla \phi(\mathbf{x})) = \phi_b(\mathbf{x})
$$
其中 $\ell$ 是一个与[折射率](@entry_id:168910)失配相关的参数，$\phi_b$ 是由外部光源决定的有效边界源。这个边界条件有一个直观的物理解释，即**外推边界条件（Extrapolated Boundary Condition）** [@problem_id:3378236]。它在数学上等效于假设[光子通量](@entry_id:164816) $\phi$ 在物理边界 $\partial\Omega$ 外侧一个特定距离 $\ell_{\text{eff}} = \ell \kappa$ 处的一个虚拟边界上衰减为零。

#### 模型对比总结

| 特性 | 电学阻抗层析成像 (EIT) | [扩散光学层析成像](@entry_id:748405) (DOT) |
| :--- | :--- | :--- |
| **物理基础** | [稳态](@entry_id:182458)[电荷守恒](@entry_id:264158)，欧姆定律 | [光子](@entry_id:145192)数守恒，[扩散近似](@entry_id:147930) |
| **控制方程** | $\nabla \cdot (\sigma \nabla u) = 0$ | $-\nabla \cdot (\kappa \nabla \phi) + \mu_a \phi = q$ |
| **零阶项** | 无 | 有 (吸收项 $\mu_a \phi$) |
| **待重建参数** | [电导率](@entry_id:137481) $\sigma$ | [吸收系数](@entry_id:156541) $\mu_a$ 和[扩散](@entry_id:141445)系数 $\kappa$ |
| **边界模型** | 连续体模型 (Neumann) 或 完整电极模型 (CEM) | 罗宾型边界条件 (考虑[折射率](@entry_id:168910)失配) |

### [反问题](@entry_id:143129)：从测量到图像

[反问题](@entry_id:143129)的目标是根据在边界上获得的测量数据，重建介质内部的物理参数[分布](@entry_id:182848)（如EIT中的 $\sigma$ 或DOT中的 $\mu_a$ 和 $\kappa$）。这是一个典型的[非线性](@entry_id:637147)、不适定的[逆问题](@entry_id:143129)。

#### 测量算子与唯一性

**测量算子**是将内部参数[分布](@entry_id:182848)映射到边界测量数据的数学算子。

-   在**EIT**中，测量算子通常是**狄利克雷-诺伊曼（DN）映射** $\Lambda_\sigma$，它将边界上施加的[电势](@entry_id:267554)[分布](@entry_id:182848) $f$ 映射到产生的法向电流密度[分布](@entry_id:182848) $\sigma \frac{\partial u}{\partial \nu}|_{\partial \Omega}$ [@problem_id:3378163]。反之，诺伊曼-狄利克雷（ND）映射也是等价的。
-   在**DOT**中，测量是在边界上的探测器位置记录出射的[光子通量](@entry_id:164816)。因此，测量算子将内部光学参数 $(\mu_a, \kappa)$ 映射到一系列积分值，其形式为 $y_i = \int_{D_i} \beta_i(s) \left( -\nu(s) \cdot \kappa(s) \nabla \phi(s) \right) \mathrm{d}S(s)$，其中 $D_i$ 是第 $i$ 个探测器的区域，$\beta_i$ 是其[仪器响应函数](@entry_id:143083) [@problem_id:3378236]。

**唯一性**是[反问题理论](@entry_id:750807)的核心问题：边界测量数据是否能唯一地确定内部参数[分布](@entry_id:182848)？

对于**EIT**，这个问题被称为**[Calderón问题](@entry_id:747084)**。一个里程碑式的成果是Sylvester和Uhlmann在1987年证明的定理：在三维或更高维度空间中（$n \ge 3$），对于足够光滑的电导率（例如 $\sigma \in C^2(\overline{\Omega})$），DN映射 $\Lambda_\sigma$ 能够唯一地确定[电导率](@entry_id:137481) $\sigma$ [@problem_id:3378163]。该证明的核心思想包括：
1.  **变换到薛定谔方程**：通过[变量替换](@entry_id:141386) $v = \sigma^{1/2} u$，将电导率方程 $\nabla \cdot (\sigma \nabla u) = 0$ 变换为定态薛定谔方程 $(-\Delta + q)v=0$，其中[势函数](@entry_id:176105) $q = \frac{\Delta \sigma^{1/2}}{\sigma^{1/2}}$。
2.  **构造复几何光学（CGO）解**：为薛定谔方程构造一类特殊的、[指数增长](@entry_id:141869)的解，形式为 $v = e^{\mathbf{x} \cdot \zeta}(1 + \psi)$，其中[复向量](@entry_id:192851) $\zeta \in \mathbb{C}^n$ 满足 $\zeta \cdot \zeta = 0$。
3.  **积分恒等式**：利用[格林公式](@entry_id:173118)导出的一个积分恒等式，将两个不同[电导率](@entry_id:137481) $\sigma_1, \sigma_2$ 对应的信息联系起来。
4.  **[傅里叶变换](@entry_id:142120)论证**：将CGO解代入积分恒等式，并取极限，证明了若 $\Lambda_{\sigma_1} = \Lambda_{\sigma_2}$，则它们对应的[势函数](@entry_id:176105)差的[傅里叶变换](@entry_id:142120)为零，即 $\widehat{q_1 - q_2} = 0$，从而 $q_1 = q_2$。
5.  **边界确定**：结合从DN映射可以确定边界上的电导率及其[法向导数](@entry_id:169511)这一事实，证明了 $\sigma_1 = \sigma_2$。

此外，EIT的测量数据具有一个重要的**[不变性](@entry_id:140168)**：它在保持边界不变的内部坐标变换（微分同胚）下是不变的。这意味着，如果我们仅仅对介质内部进行平滑的“拉伸”或“压缩”而不改变其边界，那么通过相应的变换规则计算出的新[电导率张量](@entry_id:155827)将产生与原始[电导率](@entry_id:137481)完全相同的边界测量数据。因此，从数学上讲，仅从边界数据本身无法区分这些内部几何形变 [@problem_id:3378187]。这一特性对联合重建电导率和几何边界的算法设计提出了挑战。

#### 线性化与灵敏度分析

由于反问题的[非线性](@entry_id:637147)特性，直接求解通常非常困难。一个常用的策略是在某个已知的背景参数（例如均匀介质）附近进行**线性化**。

在**DOT**中，常用的线性化方法有**[Born近似](@entry_id:138141)**和**[Rytov近似](@entry_id:199911)** [@problem_id:3378209]。
-   **[Born近似](@entry_id:138141)**假设由参数扰动引起的散射场 $\delta\Phi$ 远小于背景场 $\Phi_0$，即 $\delta\Phi = \Phi - \Phi_0$ 是一个小量。
-   **[Rytov近似](@entry_id:199911)**则假设场的对数（或相位）的扰动 $\phi_{sc} = \ln(\Phi/\Phi_0)$ 是一个小量。
由于光在组织中的衰减是乘性的，[Rytov近似](@entry_id:199911)将[乘性](@entry_id:187940)过程转换为加性过程，因此在源和探测器距离较远、衰减显著的情况下，通常比[Born近似](@entry_id:138141)更准确。

**灵敏度分析**，即计算测量值对内部参数微小变化的响应，是所有基于梯度的重建算法的核心。计算整个参数空间（通常被离散化为成千上万个像素或体素）的灵敏度矩阵（**雅可比矩阵**）的计算成本极高。

**伴随方法（Adjoint Method）**是一种计算雅可比矩阵的高效技术 [@problem_id:3378167]。其核心思想是，对于给定的一个源-探测器对，测量值对整个空间中参数扰动 $\delta p(\mathbf{x})$ 的灵敏度可以通过求解一个**正向问题**和一个**伴随问题**来获得。伴随问题的[源项](@entry_id:269111)位于探测器位置。最终，测量的变化量 $\delta M$ 可以表示为一个积分：
$$
\delta M = \int_\Omega K(\mathbf{x}) \delta p(\mathbf{x}) \, d\mathbf{x}
$$
其中灵敏度[核函数](@entry_id:145324) $K(\mathbf{x})$ 是正向场与伴随场的乘积（或更复杂的形式）。例如，在DOT中，对于[吸收系数](@entry_id:156541)的扰动 $\delta\mu_a$，测量值的变化量为：
$$
\delta M_{sd} = - \int_{\Omega} u_s(\mathbf{x}) v_d(\mathbf{x}) \delta\mu_a(\mathbf{x}) \, d\mathbf{x}
$$
其中 $u_s$ 是由源 $s$ 产生的正向[光子通量](@entry_id:164816)场，而 $v_d$ 是以探测器 $d$ 为源的伴随场。这种方法只需为每个探测器求解一次伴随方程，就可以得到该探测器对全[空间参数](@entry_id:149015)的灵敏度，大大降低了计算复杂度。

对于**EIT**，我们也可以用类似的方式定义其关于[电导率](@entry_id:137481)变化的**弗雷歇导数（Fréchet Derivative）**。给定两个电流模式 $j$ 和 $g$，DN映射 $\Lambda_\sigma$ 在背景[电导率](@entry_id:137481) $\sigma_0$ 处对扰动 $\delta\sigma$ 的导数可以通过以下双线性形式表示 [@problem_id:3378187]：
$$
\langle D\Lambda_{\sigma_0}^{\Omega}[\delta \sigma]\, j, \, g \rangle = - \int_\Omega \delta\sigma(\mathbf{x}) \nabla u_j(\mathbf{x}) \cdot \nabla u_g(\mathbf{x}) \, d\mathbf{x}
$$
其中 $u_j$ 和 $u_g$ 分别是在背景电导率 $\sigma_0$ 下，由电流 $j$ 和 $g$ 产生的[电势](@entry_id:267554)场。这个公式是EIT中许多重建算法的基础，它将测量的变化与内部[电导率](@entry_id:137481)的变化以及内部[电场能量](@entry_id:193072)的[分布](@entry_id:182848)联系起来。例如，对于[单位圆盘](@entry_id:172324)区域，当施加的电流模式为 $j(\theta) = g(\theta) = \cos(k\theta)$ 且电导率扰动为常数 $\delta\sigma = \beta$ 时，该灵敏度值为 $-\frac{\pi \beta}{k}$。这表明，对于空间频率越高（$k$ 越大）的电流模式，系统对均匀[电导率](@entry_id:137481)变化的灵敏度越低。

#### 重建的统计框架

实际测量总是伴随着噪声。为了获得稳健的重建结果，必须在算法中考虑噪声的统计特性。**贝叶斯方法**为此提供了一个强大的框架，它将[反问题](@entry_id:143129)表述为寻找**[最大后验概率](@entry_id:268939)（Maximum A Posteriori, MAP）**估计的问题。[MAP估计](@entry_id:751667)的目标是最小化一个[目标函数](@entry_id:267263)，该函数由两部分组成：

$$
\text{目标函数} = \text{数据保真项} + \text{正则化项}
$$

-   **数据保真项**：源于测量的**负[对数似然函数](@entry_id:168593)**，它惩罚模型预测值与实际测量值之间的差异。该项的形式完全取决于[噪声模型](@entry_id:752540)。
-   **正则化项**：源于参数的**负对数先验概率**，它将关于解的先验知识（如平滑性）引入问题中，以克服[不适定性](@entry_id:635673)。

[噪声模型](@entry_id:752540)的选择至关重要 [@problem_id:3378161]。例如，在DOT中，探测器测量的是[光子计数](@entry_id:186176)。
-   一种简单的模型是**加性[高斯噪声](@entry_id:260752)**，它假设测量值 $y$ 等于真实均值 $m(x)$ 加上一个零均值的高斯[随机变量](@entry_id:195330)。其负[对数似然函数](@entry_id:168593)是二次形式（最小二乘）：
    $$
    \mathcal{L}_{\mathrm{G}}(x) = \frac{1}{2\sigma^{2}} \|y - m(x)\|^{2}
    $$
-   一个更符合物理实际的模型是**泊松计数噪声**，它假设[光子](@entry_id:145192)到达是一个泊松过程。其负对-数似然函数为：
    $$
    \mathcal{L}_{\mathrm{P}}(x) = \sum_{i=1}^{m} \left( m_{i}(x) - y_{i} \ln(m_{i}(x)) \right)
    $$
选择不同的[噪声模型](@entry_id:752540)会改变数据保真项及其梯度，从而影响最终的重建结果。泊松模型内在地考虑了信号强度与噪声水平之间的依赖关系（[信噪比](@entry_id:185071)随信号强度的平方根变化），因此在高动态范围的测量中通常能提供更准确和稳健的重建。