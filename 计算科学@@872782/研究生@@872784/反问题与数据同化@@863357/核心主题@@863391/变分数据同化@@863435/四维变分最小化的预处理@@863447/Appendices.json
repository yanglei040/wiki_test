{"hands_on_practices": [{"introduction": "预处理的核心目标之一是改善Hessian矩阵的谱特性，从而加速迭代求解器的收敛。本练习提供了一个具体计算的机会，让你亲手构建一个经过对角预处理的Gauss-Newton Hessian矩阵。通过应用Gershgorin圆盘定理，你将能够量化这种预处理对Hessian矩阵谱半径（最大特征值）的影响，从而直观地理解预处理如何改变优化问题的曲率。[@problem_id:3412592]", "problem": "考虑在线性化动力学和观测算子下的增量四维变分(4D-Var)资料同化框架。在通过背景预处理得到的控制变量空间中，Hessian矩阵的高斯-牛顿近似由一个对称正定矩阵表示。为研究对角预处理的效果，假设使用以下对角尺度化近似：一个背景尺度化矩阵 $\\tilde{L}$ 和在每个时间 $k$ 的观测误差尺度化 $\\tilde{R}_{k}^{-1/2}$。那么，在时间 $k$ 的尺度化线性观测映射为\n$$\n\\tilde{J}_{k} \\;=\\; \\tilde{R}_{k}^{-1/2}\\, H_{k}\\, M_{0,k}\\, \\tilde{L},\n$$\n使得近似的控制空间Hessian矩阵为\n$$\nH_{v} \\;=\\; I \\;+\\; \\sum_{k} \\tilde{J}_{k}^{\\top}\\tilde{J}_{k}.\n$$\n\n令状态维数为 $n=3$ 并考虑两个观测时间 $k=1,2$。假设以下从时间$0$到时间$k$的切线性模型算子、观测算子和对角尺度化矩阵为：\n$$\nM_{0,1} \\;=\\; \\begin{pmatrix} 1  0.4  0 \\\\ 0  1  0.2 \\\\ 0  0  1 \\end{pmatrix}, \\quad\nM_{0,2} \\;=\\; \\begin{pmatrix} 1  -0.2  0.1 \\\\ 0  1  0.3 \\\\ 0  0  1 \\end{pmatrix},\n$$\n$$\nH_{1} \\;=\\; \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix}, \\quad\nH_{2} \\;=\\; \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix},\n$$\n$$\n\\tilde{L} \\;=\\; \\operatorname{diag}(2,\\,1,\\,3), \\quad\n\\tilde{R}_{1}^{-1/2} \\;=\\; \\operatorname{diag}(2,\\,2), \\quad\n\\tilde{R}_{2}^{-1/2} \\;=\\; \\operatorname{diag}\\!\\left(\\tfrac{5}{2},\\,\\tfrac{5}{3}\\right).\n$$\n\n从标准的增量4D-Var代价函数及其在控制空间中的高斯-牛顿Hessian矩阵出发，推导由上述选择所隐含的矩阵 $H_{v}$。然后，使用盖尔什戈林圆盘定理，确定 $H_{v}$ 谱半径的最紧可能上界，即对角线元素与非对角线元素绝对值行和之和在各行中的最大值。将你的最终答案表示为一个精确的有理数。无需四舍五入，最终结果不应包含任何单位。", "solution": "在线性化设定下，控制变量空间中的增量四维变分(4D-Var)代价函数可以写为\n$$\nJ(v) \\;=\\; \\tfrac{1}{2}\\,\\|v\\|^{2} \\;+\\; \\tfrac{1}{2}\\sum_{k}\\big\\| \\tilde{R}_{k}^{-1/2}\\, H_{k}\\, M_{0,k}\\, \\tilde{L}\\, v \\big\\|^{2},\n$$\n其中 $v$ 是控制变量，$\\tilde{L}$ 和 $\\tilde{R}_{k}^{-1/2}$ 是对角尺度化近似。那么，Hessian矩阵 $H_{v}$ 的高斯-牛顿近似为\n$$\nH_{v} \\;=\\; I \\;+\\; \\sum_{k} \\tilde{J}_{k}^{\\top}\\tilde{J}_{k}, \\quad \\text{其中} \\quad \\tilde{J}_{k} \\;=\\; \\tilde{R}_{k}^{-1/2}\\, H_{k}\\, M_{0,k}\\, \\tilde{L}.\n$$\n\n我们首先计算 $\\tilde{J}_{1}$ 和 $\\tilde{J}_{2}$。\n\n通过对 $M_{0,1}$ 的列进行尺度变换来计算 $M_{0,1}\\tilde{L}$：\n$$\nM_{0,1}\\tilde{L} \\;=\\; \\begin{pmatrix} 2  0.4  0 \\\\ 0  1  0.6 \\\\ 0  0  3 \\end{pmatrix}.\n$$\n应用 $H_{1}$（选取前两行）：\n$$\nH_{1}M_{0,1}\\tilde{L} \\;=\\; \\begin{pmatrix} 2  0.4  0 \\\\ 0  1  0.6 \\end{pmatrix}.\n$$\n左乘 $\\tilde{R}_{1}^{-1/2} = \\operatorname{diag}(2,2)$：\n$$\n\\tilde{J}_{1} \\;=\\; \\begin{pmatrix} 4  0.8  0 \\\\ 0  2  1.2 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 4  \\tfrac{4}{5}  0 \\\\ 0  2  \\tfrac{6}{5} \\end{pmatrix}.\n$$\n\n类似地，计算 $M_{0,2}\\tilde{L}$：\n$$\nM_{0,2}\\tilde{L} \\;=\\; \\begin{pmatrix} 2  -0.2  0.3 \\\\ 0  1  0.9 \\\\ 0  0  3 \\end{pmatrix}.\n$$\n应用 $H_{2}$：\n$$\nH_{2}M_{0,2}\\tilde{L} \\;=\\; \\begin{pmatrix} 2  -0.2  0.3 \\\\ 0  1  0.9 \\end{pmatrix}.\n$$\n左乘 $\\tilde{R}_{2}^{-1/2} = \\operatorname{diag}\\!\\left(\\tfrac{5}{2},\\,\\tfrac{5}{3}\\right)$：\n$$\n\\tilde{J}_{2} \\;=\\; \\begin{pmatrix} 5  -\\tfrac{1}{2}  \\tfrac{3}{4} \\\\ 0  \\tfrac{5}{3}  \\tfrac{3}{2} \\end{pmatrix}.\n$$\n\n接下来，计算贡献项 $\\tilde{J}_{k}^{\\top}\\tilde{J}_{k}$。\n\n对于 $\\tilde{J}_{1}$：\n$$\n\\tilde{J}_{1}^{\\top}\\tilde{J}_{1} \\;=\\; \\begin{pmatrix}\n16  \\tfrac{16}{5}  0 \\\\\n\\tfrac{16}{5}  \\tfrac{116}{25}  \\tfrac{12}{5} \\\\\n0  \\tfrac{12}{5}  \\tfrac{36}{25}\n\\end{pmatrix}.\n$$\n\n对于 $\\tilde{J}_{2}$：\n$$\n\\tilde{J}_{2}^{\\top}\\tilde{J}_{2} \\;=\\; \\begin{pmatrix}\n25  -\\tfrac{5}{2}  \\tfrac{15}{4} \\\\\n-\\tfrac{5}{2}  \\tfrac{109}{36}  \\tfrac{17}{8} \\\\\n\\tfrac{15}{4}  \\tfrac{17}{8}  \\tfrac{45}{16}\n\\end{pmatrix}.\n$$\n\n将两者相加并加上单位矩阵以获得 $H_{v}$：\n$$\n\\sum_{k}\\tilde{J}_{k}^{\\top}\\tilde{J}_{k} \\;=\\; \\begin{pmatrix}\n41  \\tfrac{7}{10}  \\tfrac{15}{4} \\\\\n\\tfrac{7}{10}  \\tfrac{6901}{900}  \\tfrac{181}{40} \\\\\n\\tfrac{15}{4}  \\tfrac{181}{40}  \\tfrac{1701}{400}\n\\end{pmatrix},\n$$\n$$\nH_{v} \\;=\\; I \\;+\\; \\sum_{k}\\tilde{J}_{k}^{\\top}\\tilde{J}_{k} \\;=\\; \\begin{pmatrix}\n42  \\tfrac{7}{10}  \\tfrac{15}{4} \\\\\n\\tfrac{7}{10}  \\tfrac{7801}{900}  \\tfrac{181}{40} \\\\\n\\tfrac{15}{4}  \\tfrac{181}{40}  \\tfrac{2101}{400}\n\\end{pmatrix}.\n$$\n\n根据盖尔什戈林圆盘定理，$H_{v}$ 的每个特征值都位于至少一个以 $a_{ii}$ 为圆心、半径为 $r_{i} = \\sum_{j\\neq i} |a_{ij}|$ 的圆盘内。谱半径（最大特征值）的上界是 $a_{ii} + r_{i}$ 在所有 $i$ 中的最大值。我们计算非对角线元素的绝对值行和：\n$$\nr_{1} \\;=\\; \\left|\\tfrac{7}{10}\\right| + \\left|\\tfrac{15}{4}\\right| \\;=\\; \\tfrac{7}{10} + \\tfrac{15}{4} \\;=\\; \\tfrac{89}{20},\n$$\n$$\nr_{2} \\;=\\; \\left|\\tfrac{7}{10}\\right| + \\left|\\tfrac{181}{40}\\right| \\;=\\; \\tfrac{7}{10} + \\tfrac{181}{40} \\;=\\; \\tfrac{209}{40},\n$$\n$$\nr_{3} \\;=\\; \\left|\\tfrac{15}{4}\\right| + \\left|\\tfrac{181}{40}\\right| \\;=\\; \\tfrac{15}{4} + \\tfrac{181}{40} \\;=\\; \\tfrac{331}{40}.\n$$\n\n现在，对每一行计算 $a_{ii} + r_{i}$：\n$$\na_{11} + r_{1} \\;=\\; 42 + \\tfrac{89}{20} \\;=\\; \\tfrac{840}{20} + \\tfrac{89}{20} \\;=\\; \\tfrac{929}{20},\n$$\n$$\na_{22} + r_{2} \\;=\\; \\tfrac{7801}{900} + \\tfrac{209}{40} \\;=\\; \\tfrac{15602}{1800} + \\tfrac{9405}{1800} \\;=\\; \\tfrac{25007}{1800},\n$$\n$$\na_{33} + r_{3} \\;=\\; \\tfrac{2101}{400} + \\tfrac{331}{40} \\;=\\; \\tfrac{2101}{400} + \\tfrac{3310}{400} \\;=\\; \\tfrac{5411}{400}.\n$$\n\n基于盖尔什戈林圆盘定理的谱半径最紧上界是这三个量中的最大值。比较可知，\n$$\n\\max\\!\\left\\{ \\tfrac{929}{20}, \\tfrac{25007}{1800}, \\tfrac{5411}{400} \\right\\} \\;=\\; \\tfrac{929}{20}.\n$$\n\n因此，在给定的对角尺度化下，$H_{v}$ 最大特征值的盖尔什戈林上界是 $\\tfrac{929}{20}$。", "answer": "$$\\boxed{\\tfrac{929}{20}}$$", "id": "3412592"}, {"introduction": "实际的数据同化系统往往是高度非线性的，这给预处理带来了巨大挑战。本练习是一个思想实验，探讨了在存在饱和效应的非线性观测算子时，如何应用观测空间预处理中的“白化”技术。通过分析这一情景，你将深入理解非线性如何导致信息（或敏感度）的根本性丢失——而这是仅靠预处理无法弥补的——并认识到将为线性系统设计的方法应用于非线性问题时的复杂性和局限性。[@problem_id:3412602]", "problem": "考虑一个四维变分 (4D-Var) 数据同化问题，其具有离散时间动力学模型 $x_k = \\mathcal{M}_{k,0}(x_0)$、背景状态 $x_b$ 和背景误差协方差 $B$。在时间 $k = 1, \\dots, K$，观测值 $y_k \\in \\mathbb{R}^{m_k}$ 通过一个非线性饱和观测算子 $h_k:\\mathbb{R}^{n}\\to\\mathbb{R}^{m_k}$ 与模型状态相关联，该算子以分量形式作用为\n$$\nh(z) = s \\tanh\\!\\left(\\frac{z}{s}\\right),\n$$\n其中饱和水平 $s > 0$ 已知。观测误差 $e_k$ 被建模为均值为零且具有可能状态依赖的协方差 $R_k(x_k)$ 的高斯分布，标准的 4D-Var 代价函数为\n$$\nJ(x_0) = (x_0 - x_b)^\\top B^{-1} (x_0 - x_b) + \\sum_{k=1}^{K} \\left(y_k - h_k(x_k)\\right)^\\top R_k(x_k)^{-1} \\left(y_k - h_k(x_k)\\right),\n$$\n其中 $x_k = \\mathcal{M}_{k,0}(x_0)$。\n\n在迭代点 $x_0^{(i)}$，考虑高斯-牛顿线性化，它使用切线模型 $M_{k,0}^{(i)} = \\nabla \\mathcal{M}_{k,0}(x_0^{(i)})$ 和观测雅可比矩阵 $H_k^{(i)} = \\nabla h_k(x_k^{(i)})$，其中 $x_k^{(i)} = \\mathcal{M}_{k,0}(x_0^{(i)})$。4D-Var 中一个常见的预处理步骤是观测残差的白化，通过 Cholesky 因子 $L_k^{(i)}$ 实现，使得\n$$\nL_k^{(i)} \\left(L_k^{(i)}\\right)^\\top = R_k\\!\\left(x_k^{(i)}\\right).\n$$\n定义白化残差 $\\tilde{r}_k^{(i)} = \\left(L_k^{(i)}\\right)^{-1} \\left(y_k - h_k(x_k^{(i)})\\right)$ 和白化雅可比矩阵 $\\tilde{H}_k^{(i)} = \\left(L_k^{(i)}\\right)^{-1} H_k^{(i)}$。\n\n在这种情况下，选择正确描述白化如何应用于线性化的 $R_k$ 以及在 $h_k$ 接近饱和时出现的局限性的陈述：\n\nA. 使用从 $R_k\\!\\left(x_k^{(i)}\\right)$ 构建的局部 Cholesky 因子 $L_k^{(i)}$ 进行白化，可为高斯-牛顿步骤产生单位协方差残差，并且即使在 $h_k$ 饱和的情况下也是合法的。然而，在接近饱和时，$H_k^{(i)}$ 的元素会变小，因为当 $\\lvert z \\rvert \\gg s$ 时，$h'(z) = \\mathrm{sech}^2\\!\\left(z/s\\right) \\to 0$。因此，观测贡献项 $\\sum_k \\left(M_{k,0}^{(i)}\\right)^\\top \\left(\\tilde{H}_k^{(i)}\\right)^\\top \\tilde{H}_k^{(i)} M_{k,0}^{(i)}$ 变得接近秩亏，白化无法恢复丢失的敏感度；通常需要阻尼或信赖域策略。\n\nB. 当 $h_k$ 饱和时，无法应用白化，因为在接近饱和时 $R_k$ 不再是对称正定的，导致 $L_k^{(i)}$ 未定义。\n\nC. 白化完全解决了接近饱和时的病态问题，因为它同时消除了 $R_k$ 和 $h_k$ 的小导数的影响，从而在高斯-牛顿 Hessian 近似中恢复了完全的敏感度。\n\nD. 白化仅在 $h_k$ 是线性的情况下有效；在存在任何非线性（如饱和）的情况下，白化在根本上是无效的，必须避免使用。\n\nE. 如果 $R_k$ 依赖于状态，使用依赖于迭代点的 $L_k^{(i)}$ 进行白化仍然有效，但一个一致的高斯-牛顿或牛顿步骤应包括由 $R_k(x_k)^{-1}$ 对 $x_k$ 的导数产生的项。在更新 $L_k^{(i)}$ 时忽略这些项会将该方法转变为一种迭代重加权方案，该方案在接近饱和时可能会出现收敛性下降，因为此时 $R_k$ 变化剧烈且 $H_k^{(i)}$ 接近奇异。", "solution": "这个问题的核心在于理解非线性（饱和）和状态依赖误差协方差如何影响高斯-牛顿优化步骤以及预处理（白化）的局限性。虽然问题要求选择一个陈述，但有两个陈述（A和E）都对情况进行了准确但不同方面的描述。\n\n**选项 A 是正确的。** 白化是一个代数变换，它在每个线性化的步骤中重新缩放问题，但它无法创造信息。当观测算子 $h_k$ 饱和时（即输入状态的绝对值远大于饱和水平 $s$），其导数 $h'(z) = \\mathrm{sech}^2(z/s)$ 趋近于零。这意味着观测值对状态的变化不再敏感。因此，观测雅可比矩阵 $H_k^{(i)}$ 的元素会变得非常小。白化雅可比矩阵 $\\tilde{H}_k^{(i)} = (L_k^{(i)})^{-1} H_k^{(i)}$ 同样会充满小元素。这导致高斯-牛顿Hessian矩阵中的观测贡献项 $\\left(\\tilde{H}_k^{(i)}\\right)^\\top \\tilde{H}_k^{(i)}$ 接近于零矩阵，即秩亏。系统在这些方向上变得病态，因为观测数据几乎没有提供用于更新状态的信息。白化不能凭空恢复这种丢失的敏感度。因此，需要如阻尼（Levenberg-Marquardt）或信赖域等正则化策略来稳定优化步骤。\n\n**选项 E 是正确的。** 当观测误差协方差 $R_k$ 依赖于状态 $x_k$ 时，代价函数 $J(x_0)$ 的完整Hessian矩阵应包含 $R_k(x_k)^{-1}$ 对 $x_k$ 的导数所产生的项。在实践中，这些项通常被忽略以简化计算，这正是高斯-牛顿法所做的。当我们在每次迭代中更新协方差 $R_k(x_k^{(i)})$（并因此更新其Cholesky因子 $L_k^{(i)}$）时，该方法实际上变成了一种迭代重加权最小二乘（IRLS）方案。这个方案的收敛性可能会比完整的牛顿法差，特别是在两个因素同时出现时：(1) $R_k$ 对 $x_k$ 的依赖性很强，导致被忽略的导数项很大；(2) 问题本身由于饱和效应（如选项A所述）而病态。这两个问题的结合会严重影响收敛。\n\n**其他选项为什么不正确：**\n*   **选项 B：** 观测算子 $h_k$ 的饱和与误差协方差矩阵 $R_k$ 的正定性无关。$R_k$ 是一个描述误差统计的模型，并且根据定义，它必须始终是对称正定的。\n*   **选项 C：** 与选项A的分析相反，白化不能解决由饱和引起的根本性信息损失。\n*   **选项 D：** 白化在非线性问题的迭代求解中是一个标准且有效的代数步骤，它应用于每一步的线性化子问题。因此，该陈述过于绝对，是不正确的。", "answer": "$$\\boxed{AE}$$", "id": "3412602"}]}