{"hands_on_practices": [{"introduction": "这项实践从代数的角度探讨了可观测性的基本问题。我们将通过一个具体的例子来探索线性系统的某些结构特性——例如一个对测量过程“不可见”的特征向量——是如何导致系统不可观测的。通过这个练习，你将掌握应用可观测性矩阵秩检验的核心技能，这是经典控制理论的基石之一。[@problem_id:3421947]", "problem": "考虑一个连续时间线性时不变 (LTI) 状态空间模型，其状态 $x \\in \\mathbb{R}^{3}$ 和输出 $y \\in \\mathbb{R}$ 由以下公式给出：\n$$\n\\dot{x} = A x, \\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix}\n1  1  0 \\\\\n0  1  0 \\\\\n0  0  -2\n\\end{pmatrix}, \n\\quad\nC = \\begin{pmatrix}\n0  1  1\n\\end{pmatrix}.\n$$\n  \n(a) 验证向量 $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 是 $A$ 的一个特征向量，并且 $C v = 0$。\n\n(b) 仅使用状态空间模型中可观测性的第一性原理——即根据“不可观测状态是恰好在初始时刻产生恒为零的输出及其所有时间导数的初始状态”这一定义进行推理——确定状态对 $(C, A)$ 的不可观测子空间的维数。\n\n将最终答案以单个整数形式给出。无需四舍五入。无需单位。", "solution": "对问题陈述的有效性进行分析。\n\n### 步骤1：提取已知条件\n- 一个连续时间线性时不变 (LTI) 状态空间模型由 $\\dot{x} = A x$ 和 $y = C x$ 给出。\n- 状态为 $x \\in \\mathbb{R}^{3}$，输出为 $y \\in \\mathbb{R}$。\n- 状态矩阵 $A$ 为 $A = \\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  -2 \\end{pmatrix}$。\n- 输出矩阵 $C$ 为 $C = \\begin{pmatrix} 0  1  1 \\end{pmatrix}$。\n- 给定一个向量 $v$ 为 $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n- (a) 部分要求验证 $v$ 是 $A$ 的一个特征向量，并且 $C v = 0$。\n- (b) 部分要求使用第一性原理的定义：“不可观测状态是恰好在初始时刻产生恒为零的输出及其所有时间导数的初始状态”，来确定状态对 $(C, A)$ 的不可观测子空间的维数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学性**：该问题是线性系统和控制理论中的一个标准练习，这些是工程学和应用数学中已确立的子领域。所有概念（状态空间模型、可观测性、特征向量）都有严格的定义。\n- **适定性**：该问题是适定的。矩阵已明确给出，问题清晰明确。它要求进行验证和维数计算，这两者都是具体且可解的任务。使用“第一性原理”的限制阐明了所期望的方法。\n- **客观性**：该问题使用精确、客观的数学语言陈述。\n- **完整性与一致性**：该问题是自洽的，并提供了所有必要信息。矩阵和向量的维数是一致的。没有矛盾之处。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学性、适定性、客观性和完整性。将提供完整的解答。\n\n***\n\n### 解答\n解答过程按题目要求分为两部分。\n\n**(a) 验证向量 $v$ 的性质**\n\n首先，我们验证 $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 是 $A$ 的一个特征向量。我们计算乘积 $Av$：\n$$\nA v = \\begin{pmatrix}\n1  1  0 \\\\\n0  1  0 \\\\\n0  0  -2\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 0 \\\\\n0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 0 \\\\\n0 \\cdot 1 + 0 \\cdot 0 - 2 \\cdot 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= 1 \\cdot v\n$$\n由于 $Av = \\lambda v$，其中标量 $\\lambda = 1$，因此向量 $v$ 确实是 $A$ 的一个特征向量，对应于特征值 $\\lambda = 1$。\n\n接下来，我们验证 $C v = 0$：\n$$\nC v = \\begin{pmatrix}\n0  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= 0 \\cdot 1 + 1 \\cdot 0 + 1 \\cdot 0 = 0\n$$\n这个条件也满足。\n\n**(b) 不可观测子空间的维数**\n\n问题要求使用可观测性的第一性原理定义。如果对于所有时间 $t \\ge 0$，对应的输出 $y(t)$ 恒等于零，则初始状态 $x(0) = x_0$ 是不可观测的。状态方程的解为 $x(t) = \\exp(At)x_0$。输出则由 $y(t) = C x(t) = C \\exp(At) x_0$ 给出。\n\n对于所有 $t$，$y(t)=0$ 的条件等价于 $y(t)$ 及其所有时间导数在 $t=0$ 时为零的条件。我们计算 $y(t)$ 的导数：\n- $y(t) = C \\exp(At) x_0$\n- $\\frac{dy}{dt} = \\dot{y}(t) = C \\frac{d}{dt}(\\exp(At)) x_0 = C A \\exp(At) x_0$\n- $\\frac{d^2y}{dt^2} = \\ddot{y}(t) = C A^2 \\exp(At) x_0$\n- 一般地，k阶导数为 $y^{(k)}(t) = C A^k \\exp(At) x_0$。\n\n在 $t=0$ 处计算这些导数的值（并注意到 $\\exp(A \\cdot 0) = I$，即单位矩阵），我们得到 $x_0$ 是一个不可观测状态的条件：\n- $y(0) = C x_0 = 0$\n- $\\dot{y}(0) = C A x_0 = 0$\n- $\\ddot{y}(0) = C A^2 x_0 = 0$\n- 对于所有整数 $k \\ge 0$，$y^{(k)}(0) = C A^k x_0 = 0$。\n\n所有这类向量 $x_0$ 的集合构成了不可观测子空间。根据凯莱-哈密顿定理，对于 $k \\ge n$（其中 $n=3$ 是状态空间的维数），任何矩阵的幂 $A^k$ 都可以写成 $I, A, \\dots, A^{n-1}$ 的线性组合。因此，当且仅当这些条件对 $k=0, 1, \\dots, n-1$ 成立时，它们对所有 $k \\ge 0$ 都成立。在我们的例子中，$n=3$，所以我们必须有：\n$$\nC x_0 = 0, \\quad C A x_0 = 0, \\quad C A^2 x_0 = 0\n$$\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\nC \\\\\nCA \\\\\nCA^2\n\\end{pmatrix}\nx_0 = \\mathbf{0}\n$$\n左边的矩阵是三维系统的可观测性矩阵 $\\mathcal{O}$。不可观测子空间恰好是 $\\mathcal{O}$ 的零空间。因此，不可观测子空间的维数是 $\\dim(\\operatorname{Null}(\\mathcal{O}))$。根据秩-零度定理，对于一个有3列的矩阵 $\\mathcal{O}$，我们有 $\\dim(\\operatorname{Null}(\\mathcal{O})) = 3 - \\operatorname{rank}(\\mathcal{O})$。\n\n我们现在计算 $\\mathcal{O}$ 的各行：\n- $C = \\begin{pmatrix} 0  1  1 \\end{pmatrix}$\n- $CA = \\begin{pmatrix} 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  -2 \\end{pmatrix} = \\begin{pmatrix} 0  1  -2 \\end{pmatrix}$\n- 为了求 $CA^2$，我们首先计算 $A^2$：\n$$\nA^2 = A A = \\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  -2 \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  -2 \\end{pmatrix} = \\begin{pmatrix} 1  2  0 \\\\ 0  1  0 \\\\ 0  0  4 \\end{pmatrix}\n$$\n- 现在我们计算 $CA^2$：\n$$\nCA^2 = \\begin{pmatrix} 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  2  0 \\\\ 0  1  0 \\\\ 0  0  4 \\end{pmatrix} = \\begin{pmatrix} 0  1  4 \\end{pmatrix}\n$$\n\n可观测性矩阵 $\\mathcal{O}$ 是：\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nCA \\\\\nCA^2\n\\end{pmatrix} = \\begin{pmatrix}\n0  1  1 \\\\\n0  1  -2 \\\\\n0  1  4\n\\end{pmatrix}\n$$\n为了求 $\\mathcal{O}$ 的秩，我们进行高斯消元。\n$$\n\\begin{pmatrix}\n0  1  1 \\\\\n0  1  -2 \\\\\n0  1  4\n\\end{pmatrix}\n\\xrightarrow[R_3 \\rightarrow R_3 - R_1]{R_2 \\rightarrow R_2 - R_1}\n\\begin{pmatrix}\n0  1  1 \\\\\n0  0  -3 \\\\\n0  0  3\n\\end{pmatrix}\n\\xrightarrow{R_3 \\rightarrow R_3 + R_2}\n\\begin{pmatrix}\n0  1  1 \\\\\n0  0  -3 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n$\\mathcal{O}$ 的行阶梯形有两个非零行，所以 $\\operatorname{rank}(\\mathcal{O}) = 2$。\n\n不可观测子空间的维数是：\n$$\n\\dim(\\operatorname{Null}(\\mathcal{O})) = 3 - \\operatorname{rank}(\\mathcal{O}) = 3 - 2 = 1\n$$\n因此，不可观测子空间的维数是 $1$。这与我们在 (a) 部分的发现一致，其中我们证明了非零向量 $v$ 是一个不可观测状态，这保证了不可观测子空间的维数至少为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3421947"}, {"introduction": "这项计算练习将我们从可观测性的“是/否”二元答案，带入到对可观测程度的量化分析中。通过数值计算可观测性矩阵在不同时间跨度下的最小奇异值 $s_{\\min}(N)$，你将对信息如何累积以及“弱可观测”模式在实践中如何体现获得直观的理解。这项技能对于设计和诊断诸如卡尔曼滤波器之类的状态估计系统至关重要。[@problem_id:3421917]", "problem": "考虑一个离散时间线性时不变状态空间模型，其状态维度为 $n$，输出维度为 $p$，由方程 $x_{k+1} = A x_k$ 和 $y_k = C x_k$ 定义，其中 $A \\in \\mathbb{R}^{n \\times n}$ 且 $C \\in \\mathbb{R}^{p \\times n}$。时域长度为 $N$ 的有限时域可观测性矩阵定义为垂直堆叠：\n$$\nO_N \\triangleq \\begin{bmatrix}\nC \\\\\nC A \\\\\n\\vdots \\\\\nC A^{N-1}\n\\end{bmatrix} \\in \\mathbb{R}^{(pN) \\times n}.\n$$\n有限时域可观测性格拉姆矩阵 (Gramian) 是对称半正定矩阵：\n$$\nW_N \\triangleq O_N^\\top O_N = \\sum_{k=0}^{N-1} (A^k)^\\top C^\\top C A^k \\in \\mathbb{R}^{n \\times n}.\n$$\n对于每个时域长度 $N \\in \\{1,2,\\dots,10\\}$，定义量 $s_{\\min}(N)$ 为可观测性矩阵 $O_N$ 的最小奇异值，它等价于 $s_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}$，其中 $\\lambda_{\\min}(W_N)$ 表示 $W_N$ 的最小特征值。\n\n你的任务是编写一个程序，对于下面的每个测试用例，计算列表 $\\{s_{\\min}(N)\\}_{N=1}^{10}$ 并对其趋势提供一个简单的解释。该解释必须包含：\n- 一个布尔值，用于指示序列 $\\{s_{\\min}(N)\\}$ 在数值容差 $\\tau = 10^{-12}$ 内是否单调不减，即 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$ 是否对所有 $N \\in \\{1,2,\\dots,9\\}$ 成立。\n- 一个布尔值，用于指示根据准则 $s_{\\min}(10) > \\epsilon$ (其中 $\\epsilon = 10^{-12}$)，系统在时域长度 $N=10$ 上是否展现出有效可观测子空间。\n\n该程序不得假设除标准矩阵代数之外的任何特定结构，并且必须依赖于上述基本定义。此问题不涉及物理单位。不使用角度。不使用百分比。\n\n测试套件：\n- 情况 1（正常路径，二维，一个观测性差但可观测的模态）：\n  $$\n  A_1 = \\begin{bmatrix} 0.95  0.0 \\\\ 0.0  0.70 \\end{bmatrix}, \\quad\n  C_1 = \\begin{bmatrix} 10^{-3}  1.0 \\end{bmatrix}.\n  $$\n- 情况 2（边界条件，二维，耦合极弱的慢模态）：\n  $$\n  A_2 = \\begin{bmatrix} 0.99  0.0 \\\\ 0.0  0.30 \\end{bmatrix}, \\quad\n  C_2 = \\begin{bmatrix} 10^{-8}  1.0 \\end{bmatrix}.\n  $$\n- 情况 3（边缘情况，二维，一个严格不可观测的模态）：\n  $$\n  A_3 = \\begin{bmatrix} 0.90  0.0 \\\\ 0.0  0.60 \\end{bmatrix}, \\quad\n  C_3 = \\begin{bmatrix} 0.0  1.0 \\end{bmatrix}.\n  $$\n\n对于每种情况，你的程序必须：\n1. 对于每个 $N \\in \\{1,\\dots,10\\}$，使用上述定义构建 $W_N$，并计算 $s_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}$。\n2. 使用指定的容差 $\\tau$ 和 $\\epsilon$ 确定上述两个布尔值。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，其本身是一个 $[\\text{values}, \\text{is\\_monotone}, \\text{is\\_observable}]$ 形式的列表，其中 $\\text{values}$ 是包含 $10$ 个浮点数的列表 $\\{s_{\\min}(N)\\}_{N=1}^{10}$，$\\text{is\\_monotone}$ 是一个布尔值，$\\text{is\\_observable}$ 也是一个布尔值。例如，最终输出必须是以下形式：\n```\n[[[v_1,...,v_10],True,False],[[w_1,...,w_10],True,True],[[u_1,...,u_10],True,False]]\n```\n其中 $v_i$、$w_i$ 和 $u_i$ 是由你的程序计算出的实际数值。", "solution": "该问题是有效的，因为它在数学上是良定义的，在线性系统理论中有科学依据，并且为得到唯一解提供了所有必要的数据和条件。\n\n这个问题的核心在于评估一个离散时间线性时不变系统的可观测性。可观测性指的是通过在一定时间范围内观测其输出 $y_k$ 来确定系统初始状态 $x_0$ 的能力。\n\n该系统由以下方程定义：\n$$\nx_{k+1} = A x_k \\\\\ny_k = C x_k\n$$\n其中 $x_k \\in \\mathbb{R}^n$ 是状态， $y_k \\in \\mathbb{R}^p$ 是在时间步 $k$ 的输出。\n\n在长度为 $N$ 的时域内，输出序列与初始状态 $x_0$ 的关系如下：\n$$\nY_N = \\begin{bmatrix} y_0 \\\\ y_1 \\\\ \\vdots \\\\ y_{N-1} \\end{bmatrix} = \\begin{bmatrix} C \\\\ C A \\\\ \\vdots \\\\ C A^{N-1} \\end{bmatrix} x_0 = O_N x_0\n$$\n其中 $O_N \\in \\mathbb{R}^{(pN) \\times n}$ 是时域长度为 $N$ 的可观测性矩阵。\n\n我们被要求计算的量 $s_{\\min}(N)$ 是该矩阵 $O_N$ 的最小奇异值。这个值是一个关键的可观测性度量。如果 $s_{\\min}(N) > 0$，这意味着矩阵 $O_N$ 具有满列秩，即从 $x_0$ 到 $Y_N$ 的映射是单射的。换言之，每个不同的初始状态 $x_0$ 都会产生唯一的输出序列，因此 $x_0$ 可以被唯一确定。如果 $s_{\\min}(N) = 0$，则存在非零的初始状态，在时域 $N$ 内产生零输出，使得它们与零状态无法区分。$s_{\\min}(N)$ 的大小量化了可观测性的“程度”；值越大表明系统的可观测性越鲁棒。\n\n问题指导我们使用有限时域可观测性格拉姆矩阵 $W_N$ 来计算 $s_{\\min}(N)$：\n$$\nW_N \\triangleq O_N^\\top O_N = \\sum_{k=0}^{N-1} (A^k)^\\top C^\\top C A^k\n$$\n$O_N$ 的奇异值是 $O_N^\\top O_N = W_N$ 的特征值的平方根。因此，$O_N$ 的最小奇异值由下式给出：\n$$\ns_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}\n$$\n其中 $\\lambda_{\\min}(W_N)$ 是格拉姆矩阵 $W_N$ 的最小特征值。\n\n高效算法的一个关键见解是格拉姆矩阵的迭代性质。我们可以用 $W_{N-1}$ 来表示 $W_N$：\n$$\nW_N = \\left( \\sum_{k=0}^{N-2} (A^k)^\\top C^\\top C A^k \\right) + (A^{N-1})^\\top C^\\top C A^{N-1} = W_{N-1} + (A^{N-1})^\\top C^\\top C A^{N-1}\n$$\n项 $(A^{N-1})^\\top C^\\top C A^{N-1}$ 是一个对称半正定矩阵。根据韦尔 (Weyl) 特征值不等式，将一个半正定矩阵加到另一个对称矩阵上，不会使其任何特征值减小。因此，$\\lambda_{\\min}(W_N) \\ge \\lambda_{\\min}(W_{N-1})$。由于平方根函数对于非负参数是单调不减的，因此可得：\n$$\ns_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)} \\ge \\sqrt{\\lambda_{\\min}(W_{N-1})} = s_{\\min}(N-1)\n$$\n这证明了序列 $\\{s_{\\min}(N)\\}$ 理论上是单调不减的。使用小容差 $\\tau > 0$ 进行的检查 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$ 正确地考虑了由于浮点运算误差可能导致的微小减小。\n\n每个测试用例的算法流程如下：\n1.  将格拉姆矩阵 $W$ 初始化为大小为 $n \\times n$ 的零矩阵，并将矩阵幂 $A^k$ 初始化为单位矩阵（对于 $k=0$）。\n2.  预先计算常数矩阵乘积 $C^\\top C$。\n3.  对每个时域长度 $N$ 从 $1$ 到 $10$ 进行循环（这对应于对从 $k=0$ 到 $9$ 的项求和）。在求和的每次迭代 $k$ 中（对应于时域长度 $N=k+1$）：\n    a.  将下一项 $(A^k)^\\top C^\\top C A^k$ 加到累积的格拉姆矩阵 $W$ 中。\n    b.  计算更新后的对称格拉姆矩阵 $W$ 的特征值。找到最小特征值 $\\lambda_{\\min}$。\n    c.  计算 $s_{\\min}(N) = \\sqrt{\\max(0, \\lambda_{\\min})}$。`max` 函数提供了数值稳定性，以防止因浮点不精确性而可能出现的 $\\lambda_{\\min}$ 的微小负值。\n    d.  存储计算出的 $s_{\\min}(N)$。\n    e.  为下一次迭代将矩阵幂从 $A^k$ 更新为 $A^{k+1}$。\n4.  在计算出完整序列 $\\{s_{\\min}(N)\\}_{N=1}^{10}$ 之后，执行两个要求的布尔检查：\n    a.  **单调性**：遍历序列以验证是否 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$ 对 $N=1, \\dots, 9$ 成立。\n    b.  **可观测性**：检查最终值 $s_{\\min}(10)$ 是否大于阈值 $\\epsilon = 10^{-12}$。\n\n对所提供的三个测试用例中的每一个都实施此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_observability_metrics(A_in, C_in):\n    \"\"\"\n    Computes observability metrics for a given LTI system (A, C).\n\n    Args:\n        A_in (list of lists): The state transition matrix A.\n        C_in (list of lists): The observation matrix C.\n\n    Returns:\n        list: A list containing [s_min_values, is_monotone, is_observable].\n              - s_min_values: A list of the smallest singular values s_min(N) for N=1 to 10.\n              - is_monotone: A boolean indicating if the sequence is nondecreasing.\n              - is_observable: A boolean indicating if the system is effectively observable at N=10.\n    \"\"\"\n    N_max = 10\n    tau = 1e-12\n    epsilon = 1e-12\n\n    A = np.array(A_in, dtype=float)\n    C = np.array(C_in, dtype=float)\n    \n    n = A.shape[0]\n    W = np.zeros((n, n), dtype=float)\n    A_k = np.eye(n, dtype=float)\n    CTC = C.T @ C\n    \n    s_min_values = []\n\n    # Iteratively compute W_N and s_min(N) for N=1 to 10\n    for _ in range(N_max):\n        # The term for the current power of A is (A^k)^T C^T C (A^k)\n        term = A_k.T @ CTC @ A_k\n        W += term  # This gives W_{k+1}\n        \n        # W is symmetric, so eigh is efficient and returns sorted eigenvalues\n        eigenvalues = np.linalg.eigh(W)[0]\n        lambda_min = eigenvalues[0]\n        \n        # Guard against small negative eigenvalues from floating point error\n        s_min = np.sqrt(max(0.0, lambda_min))\n        s_min_values.append(s_min)\n        \n        # Update A^k to A^{k+1} for the next iteration\n        A_k = A @ A_k\n\n    # Check for monotonicity with tolerance tau\n    is_monotone = True\n    for i in range(N_max - 1):\n        if s_min_values[i+1]  s_min_values[i] - tau:\n            is_monotone = False\n            break\n\n    # Check for effective observability at N=10 with threshold epsilon\n    # s_min_values[9] corresponds to N=10\n    is_observable = s_min_values[9] > epsilon\n\n    return [s_min_values, is_monotone, is_observable]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            [[0.95, 0.0], [0.0, 0.70]],\n            [[1e-3, 1.0]]\n        ),\n        (\n            [[0.99, 0.0], [0.0, 0.30]],\n            [[1e-8, 1.0]]\n        ),\n        (\n            [[0.90, 0.0], [0.0, 0.60]],\n            [[0.0, 1.0]]\n        )\n    ]\n\n    results = []\n    for A, C in test_cases:\n        res = compute_observability_metrics(A, C)\n        results.append(res)\n\n    # Format the output string to match the specified no-space format\n    formatted_results = []\n    for res in results:\n        # res has the form [[values], bool, bool]\n        # Format the list of float values\n        values_str = f\"[{','.join(f'{v:.17g}' for v in res[0])}]\"\n        \n        # Format the entire case result string\n        case_str = f\"[{values_str},{'True' if res[1] else 'False'},{'True' if res[2] else 'False'}]\"\n        formatted_results.append(case_str)\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3421917"}, {"introduction": "最后的这项实践将我们的视野从线性系统扩展到更广泛的非线性动力学世界。我们将研究系统动力学和测量函数中的连续对称性如何产生由无法区分的状态组成的整个流形。这个练习为可观测性提供了一种更深刻的几何直觉，这对于机器人学、导航和物理学等领域的高级应用至关重要。[@problem_id:3421904]", "problem": "考虑一个连续时间自主状态空间模型，其状态 $x \\in \\mathbb{R}^{4}$ 划分为 $x = (p, v)$，其中 $p \\in \\mathbb{R}^{2}$ 且 $v \\in \\mathbb{R}^{2}$。其动力学由下式给出\n$$\n\\dot{p} = v, \\qquad \\dot{v} = -\\frac{k}{1 + \\|p\\|^{2}}\\,p,\n$$\n其中 $k  0$ 是一个固定常数，$\\|\\cdot\\|$ 表示 $\\mathbb{R}^{2}$ 上的欧几里得范数。测量函数为\n$$\ny = h(x) = \\begin{pmatrix} \\|p\\| \\\\ \\|v\\| \\\\ p^{\\top} v \\end{pmatrix} \\in \\mathbb{R}^{3}.\n$$\n对任意角度 $\\theta \\in \\mathbb{R}$，定义线性映射 $S_{\\theta} : \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$ 为\n$$\nS_{\\theta}(p, v) = \\big(R_{\\theta} p,\\, R_{\\theta} v\\big),\n$$\n其中 $R_{\\theta} \\in \\mathbb{R}^{2 \\times 2}$ 是旋转角度为 $\\theta$ 的旋转矩阵。这个族 $\\{S_{\\theta}\\}_{\\theta \\in \\mathbb{R}}$ 是作用于状态的二维特殊正交群 (SO(2)) 的一个单参数子群。\n\n如果两个初始状态 $x_{0}$ 和 $x_{0}'$ 在 $t \\geq 0$ 时，对于相同的动力学，模型生成的相应输出 $y(t)$ 是相同的，则称这两个初始状态是不可区分的。通过 $x_{0}$ 的不可观测流形是与 $x_{0}$ 不可区分的所有初始状态 $x_{0}'$ 的集合。\n\n仅使用上述基本定义和欧几里得旋转的性质，对任意非零状态 $x_{0} = (p_{0}, v_{0}) \\in \\mathbb{R}^{4}$ 且 $(p_{0}, v_{0}) \\neq (0, 0)$，回答以下问题：\n- 确定由对称性 $S_{\\theta}$ 导出的通过 $x_{0}$ 的不可观测流形。\n- 计算其维数（一个实数）。\n\n给出你的最终答案，即这个不可观测流形的维数。不需要四舍五入，最终答案不涉及单位。", "solution": "首先验证问题，以确保其是适定的、有科学依据且内容自洽的。\n\n**步骤 1：提取已知条件**\n- 状态空间模型：连续时间，自主。\n- 状态向量：$x \\in \\mathbb{R}^{4}$，划分为 $x = (p, v)$，其中 $p \\in \\mathbb{R}^{2}$ 且 $v \\in \\mathbb{R}^{2}$。\n- 状态动力学：$\\dot{p} = v$ 和 $\\dot{v} = -\\frac{k}{1 + \\|p\\|^{2}}p$。\n- 常数：$k  0$。\n- 范数：$\\|\\cdot\\|$ 是 $\\mathbb{R}^{2}$ 上的欧几里得范数。\n- 测量函数：$y = h(x) = \\begin{pmatrix} \\|p\\| \\\\ \\|v\\| \\\\ p^{\\top} v \\end{pmatrix} \\in \\mathbb{R}^{3}$。\n- 对称映射：$S_{\\theta} : \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$ 定义为 $S_{\\theta}(p, v) = (R_{\\theta} p, R_{\\theta} v)$，其中 $R_{\\theta}$ 是旋转角度为 $\\theta$ 的 $2 \\times 2$ 旋转矩阵。\n- 不可区分性：如果两个初始状态 $x_{0}$ 和 $x_{0}'$ 对应的输出 $y(t)$ 对所有 $t \\geq 0$ 都相同，则它们是不可区分的。\n- 不可观测流形：与 $x_{0}$ 不可区分的所有初始状态 $x_{0}'$ 的集合。\n- 条件：初始状态 $x_{0} = (p_{0}, v_{0})$ 是非零的，即 $(p_{0}, v_{0}) \\neq (0, 0)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学和数学上是合理的。它描述了一个动力系统，这是物理学和工程学中的一个标准概念，其含有一个类中心力项。测量函数是良定义的。可观测性、对称性和不可观测流形的概念是控制理论和反问题的核心。该问题是自洽的，提供了所有必要的定义和方程。语言精确客观。不存在矛盾或歧义。问题是适定的，并要求根据所提供的定义计算一个具体的可计算量。因此，该问题被认为是有效的。\n\n**步骤 3：进行求解**\n问题要求找出由对称性 $S_{\\theta}$ 导出的不可观测流形。这需要我们确定在对称群 $\\{S_{\\theta}\\}_{\\theta \\in \\mathbb{R}}$ 的作用下，与给定状态 $x_0$ 不可区分的状态集合。如果两个状态 $x_0$ 和 $x_0'$ 在所有时间内产生相同的输出信号，则它们是不可区分的。我们将证明，任何两个通过变换 $S_\\theta$ 关联的状态都是不可区分的。这在以下情况下发生：(a) 动力学在 $S_\\theta$ 下是等变的，且 (b) 测量函数 $h$ 在 $S_\\theta$ 下是不变的。\n\n**部分 A：动力学的等变性**\n设动力学的向量场为 $f(x) = f(p,v) = \\left(v, -\\frac{k}{1 + \\|p\\|^{2}}p \\right)$。我们必须验证动力学在 $S_{\\theta}$ 的作用下是否是等变的，即证明对任意 $x \\in \\mathbb{R}^4$ 和 $\\theta \\in \\mathbb{R}$，都有 $S_{\\theta}(f(x)) = f(S_{\\theta}(x))$。\n\n设 $x = (p, v)$。\n首先，我们计算左侧，$S_{\\theta}(f(x))$：\n$$\nS_{\\theta}(f(x)) = S_{\\theta}\\left(v, -\\frac{k}{1 + \\|p\\|^{2}}p\\right) = \\left(R_{\\theta}v, R_{\\theta}\\left(-\\frac{k}{1 + \\|p\\|^{2}}p\\right)\\right) = \\left(R_{\\theta}v, -\\frac{k}{1 + \\|p\\|^{2}}R_{\\theta}p\\right).\n$$\n\n接下来，我们计算右侧，$f(S_{\\theta}(x))$。设 $x' = S_{\\theta}(x) = (R_{\\theta}p, R_{\\theta}v)$。令 $p' = R_{\\theta}p$ 且 $v' = R_{\\theta}v$。\n$$\nf(S_{\\theta}(x)) = f(x') = f(p', v') = \\left(v', -\\frac{k}{1 + \\|p'\\|^{2}}p'\\right).\n$$\n旋转矩阵 $R_{\\theta}$ 是一个正交变换，因此它保持欧几里得范数。于是，$\\|p'\\| = \\|R_{\\theta}p\\| = \\|p\\|$。将 $p'$、$v'$ 和 $\\|p'\\|$ 代入 $f(S_{\\theta}(x))$ 的表达式中，得到：\n$$\nf(S_{\\theta}(x)) = \\left(R_{\\theta}v, -\\frac{k}{1 + \\|p\\|^{2}}R_{\\theta}p\\right).\n$$\n比较这两个结果，我们看到 $S_{\\theta}(f(x)) = f(S_{\\theta}(x))$。这个性质称为等变性。如果 $x(t)$ 是系统的一条轨迹，即 $\\dot{x}(t) = f(x(t))$，那么 $x'(t) = S_{\\theta}(x(t))$ 也是一条轨迹，因为\n$$\n\\dot{x}'(t) = \\frac{d}{dt}(S_{\\theta}(x(t))) = S_{\\theta}(\\dot{x}(t)) = S_{\\theta}(f(x(t))) = f(S_{\\theta}(x(t))) = f(x'(t)).\n$$\n\n**部分 B：测量函数的不变性**\n我们必须验证测量函数 $h(x)$ 在 $S_{\\theta}$ 的作用下是否是不变的，即证明对任意 $x \\in \\mathbb{R}^4$ 和 $\\theta \\in \\mathbb{R}$，都有 $h(S_{\\theta}(x)) = h(x)$。\n\n设 $x = (p, v)$ 且 $x' = S_{\\theta}(x) = (p', v') = (R_{\\theta}p, R_{\\theta}v)$。\n$$\nh(x') = h(p', v') = \\begin{pmatrix} \\|p'\\| \\\\ \\|v'\\| \\\\ (p')^{\\top} v' \\end{pmatrix}.\n$$\n我们逐个分量检查：\n$1$. $\\|p'\\| = \\|R_{\\theta}p\\|$。因为旋转保持范数，所以 $\\|R_{\\theta}p\\| = \\|p\\|$。\n$2$. $\\|v'\\| = \\|R_{\\theta}v\\|$。类似地，$\\|R_{\\theta}v\\| = \\|v\\|$。\n$3$. $(p')^{\\top} v' = (R_{\\theta}p)^{\\top}(R_{\\theta}v) = p^{\\top}R_{\\theta}^{\\top}R_{\\theta}v$。由于 $R_{\\theta}$ 是一个正交矩阵，所以 $R_{\\theta}^{\\top}R_{\\theta} = I$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。因此，$p^{\\top}R_{\\theta}^{\\top}R_{\\theta}v = p^{\\top}Iv = p^{\\top}v$。\n\n测量函数的所有三个分量在变换 $S_{\\theta}$ 下都保持不变。因此，$h(S_{\\theta}(x)) = h(x)$，测量函数是不变的。\n\n**部分 C：不可观测流形及其维数**\n设 $x_0$ 是一个初始状态，并设 $x_0' = S_\\theta(x_0)$ 对某个 $\\theta \\in \\mathbb{R}$ 成立。设 $x(t)$ 是从 $x_0$ 开始的解，而 $x'(t)$ 是从 $x_0'$ 开始的解。从部分 A，我们知道 $\\tilde{x}(t) = S_\\theta(x(t))$ 是一条有效的轨迹，其初始条件为 $\\tilde{x}(0) = S_\\theta(x(0)) = S_\\theta(x_0) = x_0'$。根据解的唯一性，$x'(t) = \\tilde{x}(t) = S_\\theta(x(t))$。\n\n对应于 $x_0$ 的输出是 $y(t) = h(x(t))$。\n对应于 $x_0'$ 的输出是 $y'(t) = h(x'(t)) = h(S_\\theta(x(t)))$。\n从部分 B，我们有 $h(S_\\theta(x(t))) = h(x(t))$。\n因此，$y'(t) = y(t)$ 对所有 $t \\geq 0$ 成立。这证实了 $x_0$ 和 $x_0'$ 是不可区分的。\n\n由对称性 $S_\\theta$ 导出的通过 $x_0$ 的不可观测流形是从 $x_0$ 出发通过此变换可以达到的所有状态的集合。这是 $x_0$ 在群 $\\{S_\\theta \\mid \\theta \\in \\mathbb{R}\\}$ 作用下的轨道：\n$$\n\\mathcal{U}_{x_0} = \\{ S_\\theta(x_0) \\mid \\theta \\in \\mathbb{R} \\}.\n$$\n变换为 $S_\\theta(p_0, v_0) = (R_\\theta p_0, R_\\theta v_0)$。此作用将向量 $p_0$ 和 $v_0$ 同时以相同的角度 $\\theta$ 旋转。平面旋转群 $\\{R_\\theta\\}$ 同构于圆群 $SO(2)$，这是一个 $1$ 维李群。映射 $\\theta \\mapsto S_\\theta(x_0)$ 是该轨道的一个参数化。\n\n我们需要求出这个轨道的维数。当且仅当 $x_0$ 是群作用的一个不动点时，轨道是一个点（维数为 $0$），即对所有 $\\theta$ 都有 $S_\\theta(x_0) = x_0$。这将要求对所有 $\\theta$ 都有 $R_\\theta p_0 = p_0$ 和 $R_\\theta v_0 = v_0$。这只在 $p_0 = 0$ 和 $v_0 = 0$ 时成立。然而，问题指定了一个非零状态，$x_0 \\neq (0,0)$。\n\n由于 $x_0 \\neq (0,0)$，所以 $p_0$ 或 $v_0$ 中至少有一个非零。假设 $p_0 \\neq 0$。那么 $R_\\theta p_0 = p_0$ 仅当 $\\theta$ 是 $2\\pi$ 的整数倍时成立。如果 $v_0 \\neq 0$，情况也相同。在任何一种情况下，$x_0$ 的稳定子都是 $SO(2)$ 的一个离散子群，这意味着从 $SO(2)$ 到轨道 $\\mathcal{U}_{x_0}$ 的映射是一个局部微分同胚。轨道是 $1$ 维流形 $SO(2)$（其与圆 $S^1$ 微分同胚）在一个光滑映射下的像。由于 $x_0$ 不是不动点，所以像不是一个点。因此，该轨道是一个光滑、路径连通的 $1$ 维流形。\n\n为了正式确认这一点，我们可以通过在 $\\theta=0$ 处对路径 $c(\\theta) = S_\\theta(x_0)$ 关于 $\\theta$ 求导，来计算在 $x_0 = (p_0, v_0)$ 处的切向量：\n$$\n\\frac{d c}{d\\theta}\\bigg|_{\\theta=0} = \\frac{d}{d\\theta}(R_\\theta p_0, R_\\theta v_0)\\bigg|_{\\theta=0} = \\left(\\frac{dR_\\theta}{d\\theta}\\bigg|_{\\theta=0} p_0, \\frac{dR_\\theta}{d\\theta}\\bigg|_{\\theta=0} v_0\\right).\n$$\n旋转矩阵的导数是 $\\frac{dR_\\theta}{d\\theta} = \\begin{pmatrix} -\\sin\\theta  -\\cos\\theta \\\\ \\cos\\theta  -\\sin\\theta \\end{pmatrix}$。在 $\\theta=0$ 处，这变成矩阵 $J = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。\n切向量是 $(Jp_0, Jv_0)$。该向量为零当且仅当 $Jp_0=0$ 和 $Jv_0=0$。由于 $J$ 是可逆的，这意味着 $p_0=0$ 和 $v_0=0$，这与给定条件 $x_0 \\neq (0,0)$ 相矛盾。\n在 $x_0$ 处的轨道的切空间由一个非零向量张成，所以其维数为 $1$。同样的论证适用于轨道上的任何其他点。因此，由该对称性导出的不可观测流形是一个 $1$ 维流形。", "answer": "$$\n\\boxed{1}\n$$", "id": "3421904"}]}