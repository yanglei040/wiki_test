{"hands_on_practices": [{"introduction": "在求解任何优化问题之前，我们必须首先明确如何识别其解。对于有约束问题，卡鲁什-库恩-塔克（Karush-Kuhn-Tucker, KKT）条件为我们提供了判断最优性的黄金标准。本练习旨在挑战你将抽象的KKT理论转化为一个适用于有界最小二乘问题的具体、可操作的检验清单，这是理解和实现相关算法的关键一步。[@problem_id:3369395]", "problem": "考虑反问题和数据同化中的带边界约束的线性最小二乘问题：最小化可微凸目标函数 $\\phi(x) = \\tfrac{1}{2}\\|A x - b\\|_2^2$，满足箱式约束 $\\ell \\le x \\le u,$ 其中 $A \\in \\mathbb{R}^{m \\times n}, b \\in \\mathbb{R}^m, \\ell,u \\in \\mathbb{R}^n$, 且对所有 $i$ 都有 $\\ell_i \\le u_i$。令 $g = \\nabla \\phi(x) = A^\\top (A x - b)$ 为在满足 $\\ell \\le x \\le u$ 的可行候选解 $x \\in \\mathbb{R}^n$ 处的梯度。定义指标集 $\\mathcal{F} = \\{ i \\in \\{1,\\dots,n\\} : \\ell_i  x_i  u_i \\}, \\mathcal{L} = \\{ i : x_i = \\ell_i  u_i \\}, \\mathcal{U} = \\{ i : x_i = u_i > \\ell_i \\}, \\mathcal{E} = \\{ i : \\ell_i = u_i \\}$。使用针对带线性不等式约束的凸问题的 Karush-Kuhn-Tucker (KKT) 最优性条件，可以通过检查在活动边界上 $g_i$ 的符号以及在自由分量上 $g_i$ 是否为零来验证最优性。下列哪一项是正确的、仅用 $x$、$g$ 和边界 $\\ell,u$ 表示的、用于验证上述问题中 $x$ 的最优性的充要检验条件？\n\nA. $x$ 是最优的当且仅当 $\\ell \\le x \\le u$ 且对所有 $i \\in \\mathcal{F}$ 有 $g_i = 0$，对所有 $i \\in \\mathcal{L}$ 有 $g_i \\ge 0$，对所有 $i \\in \\mathcal{U}$ 有 $g_i \\le 0$，且对指标 $i \\in \\mathcal{E}$ 没有附加条件。\n\nB. $x$ 是最优的当且仅当 $\\ell \\le x \\le u$ 且对所有 $i \\in \\mathcal{F}$ 有 $g_i = 0$，对所有 $i \\in \\mathcal{L}$ 有 $g_i > 0$，对所有 $i \\in \\mathcal{U}$ 有 $g_i  0$，且对所有 $i \\in \\mathcal{E}$ 有 $g_i = 0$。\n\nC. $x$ 是最优的当且仅当 $\\ell \\le x \\le u$ 且残差分量满足：对所有 $i \\in \\mathcal{F}$ 有 $(A x - b)_i = 0$，对所有 $i \\in \\mathcal{L}$ 有 $(A x - b)_i \\ge 0$，对所有 $i \\in \\mathcal{U}$ 有 $(A x - b)_i \\le 0$，且对 $\\mathcal{E}$ 没有条件。\n\nD. $x$ 是最优的当且仅当 $\\ell \\le x \\le u$ 且对所有 $i \\in \\mathcal{L}$ 有 $g_i \\le 0$，对所有 $i \\in \\mathcal{U}$ 有 $g_i \\ge 0$，且对所有 $i \\in \\mathcal{F}$ 有 $g_i = 0$。\n\nE. $x$ 是最优的当且仅当 $\\ell \\le x \\le u$ 且对所有 $i \\in \\{1,\\dots,n\\}$ 有 $g_i = 0$（即，无约束驻定条件分量式成立）。", "solution": "我们从第一性原理推导正确的基于 KKT 的检验方法。其基本基础是针对带线性不等式约束的凸优化的 Karush-Kuhn-Tucker (KKT) 条件，并结合最小二乘目标梯度的定义。问题是最小化 $\\phi(x) = \\tfrac{1}{2}\\|A x - b\\|_2^2$，约束条件为 $\\ell \\le x \\le u$。函数 $\\phi$ 是凸且可微的，其梯度为 $\\nabla \\phi(x) = A^\\top(Ax - b) = g$。可行集是一个超矩形（一个箱体），由线性不等式 $x_i \\ge \\ell_i$ 和 $x_i \\le u_i$ 定义。由于该问题是凸问题且约束是线性的，KKT 条件是最优性的充要条件。\n\n为不等式约束引入拉格朗日乘子：$\\lambda^L \\in \\mathbb{R}^n, \\quad \\lambda^U \\in \\mathbb{R}^n$，分别对应于 $x_i \\ge \\ell_i$ 和 $u_i - x_i \\ge 0$（注意上界约束的正确形式）。拉格朗日函数为\n$$\n\\mathcal{L}(x,\\lambda^L,\\lambda^U) = \\tfrac{1}{2}\\|A x - b\\|_2^2 - (\\lambda^L)^\\top (x - \\ell) - (\\lambda^U)^\\top (u - x).\n$$\nKKT 条件包括：\n\n1. 原始可行性：$\\ell \\le x \\le u$。\n\n2. 对偶可行性：$\\lambda^L \\ge 0, \\quad \\lambda^U \\ge 0$，分量式成立。\n\n3. 驻定性：$\\nabla_x \\mathcal{L} = 0$，即\n$$\n\\nabla \\phi(x) - \\lambda^L + \\lambda^U = 0 \\quad \\Longleftrightarrow \\quad \\text{对每个 } i \\text{ 有 } g_i - \\lambda^L_i + \\lambda^U_i = 0。\n$$\n\n4. 互补松弛性：$\\lambda^L_i (x_i - \\ell_i) = 0, \\quad \\lambda^U_i (u_i - x_i) = 0 \\text{ 对每个 } i \\text{ 成立。}$\n\n我们现在根据 $x$ 处边界的活动性来提取关于 $g_i$ 的条件。考虑每个指标 $i$：\n\n- 自由分量 $i \\in \\mathcal{F}:$ 这意味着 $\\ell_i  x_i  u_i$。互补松弛性意味着 $\\lambda^L_i = 0$ 和 $\\lambda^U_i = 0$。驻定性条件简化为 $g_i = 0$。因此，对于自由分量，梯度必须分量式为零。\n\n- 下边界活动分量 $i \\in \\mathcal{L}:$ 此处 $x_i = \\ell_i  u_i$。互补松弛性意味着 $\\lambda^L_i \\ge 0$ 可以不为零，但因为 $u_i - x_i > 0$，所以 $\\lambda^U_i = 0$。驻定性条件给出 $g_i - \\lambda^L_i + 0 = 0$，因此 $g_i = \\lambda^L_i \\ge 0$。因此，在下活动边界上，梯度分量是非负的。\n\n- 上边界活动分量 $i \\in \\mathcal{U}:$ 此处 $x_i = u_i > \\ell_i$。互补松弛性意味着 $\\lambda^U_i \\ge 0$ 可以不为零，但因为 $x_i - \\ell_i > 0$，所以 $\\lambda^L_i = 0$。驻定性条件给出 $g_i - 0 + \\lambda^U_i = 0$，因此 $g_i = -\\lambda^U_i \\le 0$。因此，在上活动边界上，梯度分量是非正的。\n\n- 等式边界分量 $i \\in \\mathcal{E}:$ 此处 $\\ell_i = u_i$ 因而 $x_i = \\ell_i = u_i$。互补松弛性施加了 $\\lambda^L_i (x_i - \\ell_i) = 0$ 和 $\\lambda^U_i (u_i - x_i) = 0$，对于任何非负的 $\\lambda^L_i, \\lambda^U_i$，这两个等式都恒成立。驻定性施加了 $g_i - \\lambda^L_i + \\lambda^U_i = 0$，对于任何实数 $g_i$，这都可以通过选择某些非负的 $\\lambda^L_i, \\lambda^U_i$ 来满足（例如，设 $\\lambda^L_i = \\max\\{g_i,0\\}$ 和 $\\lambda^U_i = \\max\\{-g_i,0\\}$）。因此，当 $\\ell_i = u_i$ 时，除了存在可行的乘子之外，对 $g_i$ 没有符号限制，证明仅要求在此类指标处的可行性。\n\n综合这些情况，KKT 条件可转化为以下检验：\n\n- 原始可行性 $\\ell \\le x \\le u$。\n- 对所有 $i \\in \\mathcal{F},$ $g_i = 0$。\n- 对所有 $i \\in \\mathcal{L},$ $g_i \\ge 0$。\n- 对所有 $i \\in \\mathcal{U},$ $g_i \\le 0$。\n- 对 $i \\in \\mathcal{E}$ 的 $g_i$ 没有额外要求。\n\n因为 $\\phi$ 是凸的且约束是线性的，所以这些 KKT 条件是充要的，因此它们构成了最优性的完整证明。\n\n我们现在评估每个选项：\n\n选项 A：陈述了原始可行性以及上面为 $\\mathcal{F}, \\mathcal{L}, \\mathcal{U}$ 推导出的确切的符号/零条件，并明确指出对 $\\mathcal{E}$ 没有额外条件。这与基于 KKT 的推导相符。结论：正确。\n\n选项 B：要求在 $\\mathcal{L}$ 处有严格不等式 $g_i > 0$，在 $\\mathcal{U}$ 处有 $g_i  0$，并强制在 $\\mathcal{E}$ 处有 $g_i = 0$。严格不等式是不必要且不正确的：KKT 允许在活动边界上 $g_i = 0$（当乘子为零或退化情况下），并且如前所述，对于 $\\mathcal{E}$，对 $g_i$ 没有限制，因为可以选择 $\\lambda^L_i, \\lambda^U_i$ 来满足驻定性。结论：不正确。\n\n选项 C：使用了残差分量 $(A x - b)_i$ 而不是梯度 $g_i = (A^\\top(Ax - b))_i$。KKT 驻定性条件涉及 $g$，而不是原始残差，并且在自由指标上将残差分量设为零通常是错误的，除非 $A$ 是单位矩阵。因此，对于一般的 $A$，此检验既不必要也不充分。结论：不正确。\n\n选项 D：颠倒了活动边界上的符号条件：它要求在下边界处 $g_i \\le 0$，在上边界处 $g_i \\ge 0$，这与我们推导出的带有非负乘子的驻定性相矛盾。结论：不正确。\n\n选项 E：要求所有分量的 $g_i = 0$，即无约束驻定性。这个条件比需要的更强，并且无法验证在活动边界上的最优性，在活动边界上，非零的梯度分量是允许的，并且需要有适当的符号来平衡乘子。它可能仅在解严格位于内部或出现特殊退化情况时成立；在一般情况下，它不是必要的。结论：不正确。\n\n因此，正确的检验由选项 A 给出。", "answer": "$$\\boxed{A}$$", "id": "3369395"}, {"introduction": "许多约束优化算法的核心思想是，在迭代的每一步之后，通过一个“投影”算子将候选解强制拉回到可行集内。本练习将让你亲手计算一个点到简单凸集（一个“盒子”）上的欧几里得投影，这是诸如投影梯度法等算法的一个基本构件。通过这个具体的计算，你将对约束的几何意义有更深刻的理解。[@problem_id:3369454]", "problem": "设 $y \\in \\mathbb{R}^{6}$ 由 $y = (3.7,\\,-5.2,\\,-3.0,\\,9.1,\\,-2.3,\\,14.8)^{\\top}$ 给出。考虑将 $y$ 投影到盒子 $[l,u] := \\{x \\in \\mathbb{R}^{6} : l \\le x \\le u\\}$ 上的有界约束最小二乘投影，其中边界按分量指定为\n$l = (0,\\,-\\infty,\\,-1,\\,4,\\,-\\infty,\\,10)^{\\top}$ 和 $u = (2,\\,0,\\,\\infty,\\,\\infty,\\,1,\\,12)^{\\top}$。此处 $-\\infty$ 和 $\\infty$ 分别表示不存在下界或上界。\n\n欧几里得投影 $P_{[l,u]}(y)$ 被定义为严格凸问题\n$\\min\\{ \\tfrac{1}{2}\\|x - y\\|_{2}^{2} : l \\le x \\le u \\}$ 的唯一极小化子。\n\n任务：\n1. 计算 $P_{[l,u]}(y)$。\n2. 从投影是上述问题的唯一极小化子的定义出发，并仅使用凸性和一阶最优性的基本性质，验证以下变分不等式刻画成立：对所有 $z \\in [l,u]$，\n$\\langle y - P_{[l,u]}(y),\\, z - P_{[l,u]}(y) \\rangle \\le 0$。\n3. 报告欧几里得距离平方 $\\|y - P_{[l,u]}(y)\\|_{2}^{2}$ 的精确值。\n\n请以精确值（无舍入）的形式提供任务3的最终数值答案。", "solution": "### 任务1：计算投影 $P_{[l,u]}(y)$\n\n欧几里得投影 $x = P_{[l,u]}(y)$ 是通过将 $y$ 的每个分量独立地投影到对应的区间 $[l_i, u_i]$ 上来计算的。投影算子可以表示为 $x_i = \\min(\\max(y_i, l_i), u_i)$。\n\n给定：\n$y = (3.7,\\,-5.2,\\,-3.0,\\,9.1,\\,-2.3,\\,14.8)^{\\top}$\n$l = (0,\\,-\\infty,\\,-1,\\,4,\\,-\\infty,\\,10)^{\\top}$\n$u = (2,\\,0,\\,\\infty,\\,\\infty,\\,1,\\,12)^{\\top}$\n\n我们逐个分量计算：\n- $x_1 = \\min(\\max(3.7, 0), 2) = \\min(3.7, 2) = 2$\n- $x_2 = \\min(\\max(-5.2, -\\infty), 0) = \\min(-5.2, 0) = -5.2$\n- $x_3 = \\min(\\max(-3.0, -1), \\infty) = \\min(-1, \\infty) = -1$\n- $x_4 = \\min(\\max(9.1, 4), \\infty) = \\min(9.1, \\infty) = 9.1$\n- $x_5 = \\min(\\max(-2.3, -\\infty), 1) = \\min(-2.3, 1) = -2.3$\n- $x_6 = \\min(\\max(14.8, 10), 12) = \\min(14.8, 12) = 12$\n\n因此，投影点为 $P_{[l,u]}(y) = (2, -5.2, -1, 9.1, -2.3, 12)^{\\top}$。\n\n### 任务2：验证变分不等式\n\n我们要验证的变分不等式是：对于所有 $z \\in [l,u]$，都有 $\\langle y - x, z - x \\rangle \\le 0$，其中 $x = P_{[l,u]}(y)$。\n\n这个不等式是凸集上投影的一个基本性质。它源于优化问题 $\\min_{x \\in [l,u]} f(x) = \\frac{1}{2}\\|x - y\\|_{2}^{2}$ 的一阶最优性条件。由于目标函数 $f(x)$ 是凸的，可行集 $[l,u]$ 是凸集，一个点 $x \\in [l,u]$ 是最优解的充要条件是，对于所有 $z \\in [l,u]$，都有 $\\langle \\nabla f(x), z - x \\rangle \\ge 0$。\n\n目标函数的梯度是 $\\nabla f(x) = x - y$。\n将梯度代入最优性条件，我们得到：\n$$\n\\langle x - y, z - x \\rangle \\ge 0\n$$\n将不等式两边乘以 $-1$，我们得到所要验证的变分不等式：\n$$\n\\langle y - x, z - x \\rangle \\le 0\n$$\n这证明了该变分不等式刻画是正确的，它直接来自于投影定义为优化问题的解的一阶充要条件。\n\n### 任务3：计算欧几里得距离平方\n\n我们需要计算 $\\|y - P_{[l,u]}(y)\\|_{2}^{2}$。\n首先计算向量差 $d = y - P_{[l,u]}(y)$：\n$$\nd = \\begin{pmatrix} 3.7 \\\\ -5.2 \\\\ -3.0 \\\\ 9.1 \\\\ -2.3 \\\\ 14.8 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ -5.2 \\\\ -1 \\\\ 9.1 \\\\ -2.3 \\\\ 12 \\end{pmatrix} = \\begin{pmatrix} 1.7 \\\\ 0 \\\\ -2.0 \\\\ 0 \\\\ 0 \\\\ 2.8 \\end{pmatrix}\n$$\n然后计算该向量的欧几里得范数平方：\n$$\n\\|d\\|_{2}^{2} = (1.7)^2 + (0)^2 + (-2.0)^2 + (0)^2 + (0)^2 + (2.8)^2\n$$\n$$\n\\|d\\|_{2}^{2} = 2.89 + 0 + 4.00 + 0 + 0 + 7.84\n$$\n$$\n\\|d\\|_{2}^{2} = 14.73\n$$\n所以，欧几里得距离的平方是 $14.73$。", "answer": "$$\n\\boxed{14.73}\n$$", "id": "3369454"}, {"introduction": "现在，我们将理论与工具结合起来付诸实践。投影梯度法通过迭代地沿负梯度方向前进一步（如同在无约束优化中），然后将结果投影回可行集来满足约束。这个动手实践将引导你完整地执行该基本算法的一次迭代，包括为保证收敛性所必需的线搜索过程，从而全面体验解决带约束问题的完整流程。[@problem_id:3369390]", "problem": "考虑一个线性数据同化设定，其状态向量为 $\\boldsymbol{x} \\in \\mathbb{R}^{3}$，线性观测算子为 $\\boldsymbol{A} \\in \\mathbb{R}^{3 \\times 3}$，其中观测值被建模为 $\\boldsymbol{y} \\approx \\boldsymbol{A}\\boldsymbol{x}$，观测数据为 $\\boldsymbol{b} \\in \\mathbb{R}^{3}$。我们寻求在边界约束下最小化最小二乘失配。目标函数为\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}\\|^{2},\n$$\n可行集是箱形区域 $\\mathcal{B} = \\{\\boldsymbol{x} \\in \\mathbb{R}^{3} : \\boldsymbol{l} \\le \\boldsymbol{x} \\le \\boldsymbol{u}\\}$，其中边界是分量式的。\n\n严格从 $f(\\boldsymbol{x})$ 的定义以及线性映射和二次型复合的微分法则出发，推导梯度 $\\nabla f(\\boldsymbol{x})$。然后，使用带有 Armijo 回溯线搜索的投影梯度（PG）方法，从当前状态 $\\boldsymbol{x}^{(0)}$ 开始执行一次迭代，数据如下：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix}, \\quad\n\\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad\n\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix},\n$$\n及边界\n$$\n\\boldsymbol{l} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}, \\quad\n\\boldsymbol{u} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}.\n$$\n将到箱形区域 $\\mathcal{B}$ 上的投影按分量定义为 $P_{[\\boldsymbol{l},\\boldsymbol{u}]}(\\boldsymbol{z}) = \\min(\\max(\\boldsymbol{z}, \\boldsymbol{l}), \\boldsymbol{u})$，其中最小值和最大值是按分量计算的。使用初始步长 $\\alpha_{0} = 1$，回溯因子 $\\gamma = \\frac{1}{2}$，以及 Armijo 常数 $\\sigma = \\frac{1}{10}$。在当前迭代点 $\\boldsymbol{x}$，其梯度为 $\\boldsymbol{g} = \\nabla f(\\boldsymbol{x})$，为步长 $\\alpha$ 定义试验点\n$$\n\\boldsymbol{y}(\\alpha) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}(\\boldsymbol{x} - \\alpha \\boldsymbol{g}).\n$$\n如果 Armijo 条件\n$$\nf(\\boldsymbol{y}(\\alpha)) \\le f(\\boldsymbol{x}) + \\sigma\\, \\nabla f(\\boldsymbol{x})^{\\top}(\\boldsymbol{y}(\\alpha) - \\boldsymbol{x})\n$$\n被满足，则接受步长 $\\alpha$；否则，将 $\\alpha \\leftarrow \\gamma \\alpha$ 并重复直至接受。从 $\\boldsymbol{x}^{(0)}$ 开始，使用上述数值执行此过程一次迭代，并将得到的下一个迭代点 $\\boldsymbol{x}^{(1)} = \\boldsymbol{y}(\\alpha)$ 作为您的最终答案报告。无需四舍五入。将最终答案表示为行向量。", "solution": "该问题要求对一个有边界约束的最小二乘问题执行一次投影梯度（PG）方法的迭代。该过程首先包括推导目标函数的梯度，然后应用带有 Armijo 回溯线搜索的 PG 算法。\n\n首先，我们推导目标函数 $f(\\boldsymbol{x}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}\\|^{2}$ 的梯度。\n欧几里得范数的平方可以写成内积形式：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} (\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})^{\\top}(\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})\n$$\n展开此表达式得到：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} \\left( (\\boldsymbol{A}\\boldsymbol{x})^{\\top} - \\boldsymbol{b}^{\\top} \\right) (\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}) = \\frac{1}{2} \\left( \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{b} - \\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x} + \\boldsymbol{b}^{\\top}\\boldsymbol{b} \\right)\n$$\n由于 $\\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x}$ 是一个标量，它等于其自身的转置，即 $(\\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x})^{\\top} = \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{b}$。因此，表达式简化为：\n$$\nf(\\boldsymbol{x}) = \\frac{1}{2} \\boldsymbol{x}^{\\top}\\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b}^{\\top}\\boldsymbol{A}\\boldsymbol{x} + \\frac{1}{2} \\boldsymbol{b}^{\\top}\\boldsymbol{b}\n$$\n为了求梯度 $\\nabla f(\\boldsymbol{x})$，我们对 $\\boldsymbol{x}$ 求导。使用向量微积分的法则，特别是 $\\nabla_{\\boldsymbol{x}}(\\boldsymbol{x}^{\\top}\\boldsymbol{Q}\\boldsymbol{x}) = (\\boldsymbol{Q} + \\boldsymbol{Q}^{\\top})\\boldsymbol{x}$ 和 $\\nabla_{\\boldsymbol{x}}(\\boldsymbol{c}^{\\top}\\boldsymbol{x}) = \\boldsymbol{c}$，我们得到：\n$$\n\\nabla f(\\boldsymbol{x}) = \\frac{1}{2} (\\boldsymbol{A}^{\\top}\\boldsymbol{A} + (\\boldsymbol{A}^{\\top}\\boldsymbol{A})^{\\top})\\boldsymbol{x} - (\\boldsymbol{b}^{\\top}\\boldsymbol{A})^{\\top}\n$$\n矩阵 $\\boldsymbol{A}^{\\top}\\boldsymbol{A}$ 是对称的，所以 $(\\boldsymbol{A}^{\\top}\\boldsymbol{A})^{\\top} = \\boldsymbol{A}^{\\top}\\boldsymbol{A}$。并且，$(\\boldsymbol{b}^{\\top}\\boldsymbol{A})^{\\top} = \\boldsymbol{A}^{\\top}\\boldsymbol{b}$。因此梯度为：\n$$\n\\nabla f(\\boldsymbol{x}) = \\frac{1}{2} (2\\boldsymbol{A}^{\\top}\\boldsymbol{A})\\boldsymbol{x} - \\boldsymbol{A}^{\\top}\\boldsymbol{b} = \\boldsymbol{A}^{\\top}\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{A}^{\\top}\\boldsymbol{b} = \\boldsymbol{A}^{\\top}(\\boldsymbol{A}\\boldsymbol{x} - \\boldsymbol{b})\n$$\n这就是所要求的梯度表达式。\n\n现在，我们从 $\\boldsymbol{x}^{(0)}$ 开始执行一次 PG 方法的迭代。\n当前迭代点是 $\\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix}$。矩阵和向量如下：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix}, \\quad \\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad \\boldsymbol{l} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}, \\quad \\boldsymbol{u} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n首先，我们计算梯度 $\\boldsymbol{g}^{(0)} = \\nabla f(\\boldsymbol{x}^{(0)})$。\n残差为 $\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}$：\n$$\n\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1.6 \\\\ -0.5 \\\\ 5.4 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix}\n$$\n矩阵 $\\boldsymbol{A}$ 是对角矩阵，因此是对称的，所以 $\\boldsymbol{A}^{\\top} = \\boldsymbol{A}$。\n$$\n\\boldsymbol{g}^{(0)} = \\boldsymbol{A}^{\\top}(\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}) = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 0.5 \\\\ 7.2 \\end{pmatrix}\n$$\n接下来，我们执行 Armijo 回溯线搜索，从 $\\alpha_0 = 1$ 开始。试验点是 $\\boldsymbol{y}(\\alpha) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}(\\boldsymbol{x}^{(0)} - \\alpha \\boldsymbol{g}^{(0)})$。我们必须检查当 $\\alpha = 1$ 时 Armijo 条件是否满足：\n$$\nf(\\boldsymbol{y}(1)) \\le f(\\boldsymbol{x}^{(0)}) + \\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)})\n$$\n让我们为 $\\alpha = 1$ 计算每一项。首先，试验点 $\\boldsymbol{y}(1)$：\n未投影的点是 $\\boldsymbol{x}^{(0)} - 1 \\cdot \\boldsymbol{g}^{(0)}$：\n$$\n\\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} - \\begin{pmatrix} 1.2 \\\\ 0.5 \\\\ 7.2 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ -1.0 \\\\ -5.4 \\end{pmatrix}\n$$\n将该点投影到由 $\\boldsymbol{l}$ 和 $\\boldsymbol{u}$ 定义的箱形区域 $\\mathcal{B}$ 上：\n$$\n\\boldsymbol{y}(1) = P_{[\\boldsymbol{l},\\boldsymbol{u}]}\\left(\\begin{pmatrix} -0.4 \\\\ -1.0 \\\\ -5.4 \\end{pmatrix}\\right) = \\begin{pmatrix} \\min(\\max(-0.4, 0), 1) \\\\ \\min(\\max(-1.0, -1), 2) \\\\ \\min(\\max(-5.4, 0.5), 2) \\end{pmatrix} = \\begin{pmatrix} \\min(0, 1) \\\\ \\min(-1, 2) \\\\ \\min(0.5, 2) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}\n$$\n现在，我们计算 Armijo 不等式的两边。\n对于左侧（LHS），我们计算 $f(\\boldsymbol{y}(1))$：\n$$\n\\boldsymbol{A}\\boldsymbol{y}(1) - \\boldsymbol{b} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ -1.5 \\end{pmatrix}\n$$\n$$\nf(\\boldsymbol{y}(1)) = \\frac{1}{2}\\left\\| \\begin{pmatrix} -1 \\\\ 0 \\\\ -1.5 \\end{pmatrix} \\right\\|^2 = \\frac{1}{2}((-1)^2 + 0^2 + (-1.5)^2) = \\frac{1}{2}(1 + 2.25) = \\frac{1}{2}(3.25) = 1.625\n$$\n对于右侧（RHS），我们首先需要 $f(\\boldsymbol{x}^{(0)})$ 和方向导数项。\n$$\nf(\\boldsymbol{x}^{(0)}) = \\frac{1}{2}\\|\\boldsymbol{A}\\boldsymbol{x}^{(0)} - \\boldsymbol{b}\\|^2 = \\frac{1}{2}\\left\\| \\begin{pmatrix} 0.6 \\\\ 0.5 \\\\ 2.4 \\end{pmatrix} \\right\\|^2 = \\frac{1}{2}(0.6^2 + 0.5^2 + 2.4^2) = \\frac{1}{2}(0.36 + 0.25 + 5.76) = \\frac{1}{2}(6.37) = 3.185\n$$\n方向项是 $\\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)})$。向量差为：\n$$\n\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix} - \\begin{pmatrix} 0.8 \\\\ -0.5 \\\\ 1.8 \\end{pmatrix} = \\begin{pmatrix} -0.8 \\\\ -0.5 \\\\ -1.3 \\end{pmatrix}\n$$\n与梯度的点积是：\n$$\n(\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)}) = \\begin{pmatrix} 1.2  0.5  7.2 \\end{pmatrix} \\begin{pmatrix} -0.8 \\\\ -0.5 \\\\ -1.3 \\end{pmatrix} = (1.2)(-0.8) + (0.5)(-0.5) + (7.2)(-1.3) = -0.96 - 0.25 - 9.36 = -10.57\n$$\nArmijo 不等式的右侧（RHS）为，其中 $\\sigma = \\frac{1}{10} = 0.1$：\n$$\nf(\\boldsymbol{x}^{(0)}) + \\sigma\\, (\\boldsymbol{g}^{(0)})^{\\top}(\\boldsymbol{y}(1) - \\boldsymbol{x}^{(0)}) = 3.185 + 0.1(-10.57) = 3.185 - 1.057 = 2.128\n$$\n现在我们检查条件：$f(\\boldsymbol{y}(1)) \\le 2.128$ 是否成立？\n$$\n1.625 \\le 2.128\n$$\n不等式成立。因此，步长 $\\alpha=1$ 被接受。下一个迭代点是 $\\boldsymbol{x}^{(1)} = \\boldsymbol{y}(1)$。\n$$\n\\boldsymbol{x}^{(1)} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0.5 \\end{pmatrix}\n$$\n题目要求将结果表示为行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -1  0.5 \\end{pmatrix}}\n$$", "id": "3369390"}]}