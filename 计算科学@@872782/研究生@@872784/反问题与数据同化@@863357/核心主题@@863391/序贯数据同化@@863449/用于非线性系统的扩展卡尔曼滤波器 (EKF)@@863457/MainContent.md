## 引言
在科学与工程的众多领域中，从动态系统中准确估计其内部状态是一个基础且核心的挑战。对于[线性高斯系统](@entry_id:200183)，卡尔曼滤波器提供了理论上最优的递归解，并取得了巨大成功。然而，现实世界充满了[非线性](@entry_id:637147)，从航天器姿态动力学到生态种群演化，[非线性模型](@entry_id:276864)无处不在。直接将标准[卡尔曼滤波](@entry_id:145240)应用于这些系统是不可行的，因为高斯分布在[非线性变换](@entry_id:636115)下不再保持其高斯特性，导致最优[贝叶斯滤波](@entry_id:137269)的积分方程没有解析解，从而形成了一个关键的知识鸿沟。

本文旨在深入探讨应对这一挑战的经典方法——[扩展卡尔曼滤波器](@entry_id:199333)（Extended Kalman Filter, EKF）。通过本文的学习，读者将全面掌握EKF的原理、应用与实践。第一章“原理与机制”将剖析EKF如何通过[局部线性化](@entry_id:169489)来近似[非线性系统](@entry_id:168347)，并讨论其内在局限。第二章“应用与交叉学科联系”将展示EKF在[参数估计](@entry_id:139349)、[传感器融合](@entry_id:263414)等复杂场景中的强大灵活性及其与4D-Var等其他领域方法的深刻联系。最后，第三章“动手实践”将通过具体的编程练习，巩固理论知识并提升解决实际问题的能力。

## 原理与机制

在理解了[非线性滤波](@entry_id:201008)的基本问题之后，本章将深入探讨[扩展卡尔曼滤波器](@entry_id:199333)（Extended Kalman Filter, EKF）的核心原理与工作机制。我们将从[贝叶斯滤波](@entry_id:137269)的理想框架出发，揭示[非线性](@entry_id:637147)带来的根本挑战，并详细阐述 EKF 如何通过[局部线性化](@entry_id:169489)的思想来克服这些挑战。此外，本章还将剖析 EKF 的内在局限性，并介绍评估其适用性的方法，以及一些相关的系统理论概念。

### [非线性](@entry_id:637147)的挑战：从线性[卡尔曼滤波](@entry_id:145240)出发

标准的卡尔曼滤波之所以能够在工程与科学领域取得巨大成功，其根基在于它为一类特定的问题——线性高斯[状态空间模型](@entry_id:137993)——提供了最优的递归解。然而，现实世界中的许多系统本质上是[非线性](@entry_id:637147)的。对于一个由[非线性](@entry_id:637147)函数 $f$ 和 $h$ 描述的通用[状态空间模型](@entry_id:137993)：

$x_{k+1} = f(x_k) + w_k$
$y_k = h(x_k) + v_k$

其中过程噪声 $w_k$ 和观测噪声 $v_k$ 为[高斯白噪声](@entry_id:749762)。最优[贝叶斯滤波](@entry_id:137269)的目标是递归地计算状态的后验概率密度函数（PDF）$p(x_k | y_{1:k})$。这一过程严格遵循两个步骤：预测和更新。

1.  **预测 (Prediction)**：根据上一时刻的后验分布 $p(x_{k-1} | y_{1:k-1})$，通过查普曼-科尔莫戈洛夫方程（Chapman–Kolmogorov equation）计算当前时刻的[先验分布](@entry_id:141376) $p(x_k | y_{1:k-1})$。
    $$p(x_k | y_{1:k-1}) = \int p(x_k | x_{k-1}) p(x_{k-1} | y_{1:k-1}) dx_{k-1}$$
    其中，$p(x_k | x_{k-1})$ 由过程模型定义，即 $\mathcal{N}(x_k; f(x_{k-1}), Q_{k-1})$。

2.  **更新 (Update)**：利用当前时刻的观测值 $y_k$，通过贝叶斯定理将[先验分布](@entry_id:141376)更新为后验分布。
    $$p(x_k | y_{1:k}) = \frac{p(y_k | x_k) p(x_k | y_{1:k-1})}{\int p(y_k | x_k) p(x_k | y_{1:k-1}) dx_k}$$
    其中，[似然函数](@entry_id:141927) $p(y_k | x_k)$ 由观测模型定义，即 $\mathcal{N}(y_k; h(x_k), R_k)$。

这些积分形式的方程构成了最优[贝叶斯滤波](@entry_id:137269)的理论核心 [@problem_id:3380738]。然而，当函数 $f$ 或 $h$ 为[非线性](@entry_id:637147)时，这些积分通常没有解析解。关键的障碍在于**高斯分布在[非线性变换](@entry_id:636115)下的不封闭性**。即使我们从一个完美的高斯后验分布 $p(x_{k-1} | y_{1:k-1})$ 出发，在预测步骤中，将其通过[非线性](@entry_id:637147)函数 $f$ 进行传播，得到的[先验分布](@entry_id:141376) $p(x_k | y_{1:k-1})$ 通常不再是[高斯分布](@entry_id:154414)。

例如，考虑一个简单的标量系统，其过程模型为 $x_{k+1} = \exp(\alpha x_k) + w_k$ [@problem_id:3380734]。如果 $x_k$ 是高斯[随机变量](@entry_id:195330)，那么 $\exp(\alpha x_k)$ 将服从[对数正态分布](@entry_id:261888)（Log-Normal distribution），这是一种具有明显偏斜的非[高斯分布](@entry_id:154414)。它与高斯噪声 $w_k$ 相加后，得到的 $x_{k+1}$ 的[分布](@entry_id:182848)将更加复杂，不再是[高斯分布](@entry_id:154414)。同样，在更新步骤中，如果观测模型包含[非线性](@entry_id:637147)函数，例如 $h(x_k) = \arctan(x_k)$，那么似然函数 $p(y_k | x_k)$ 作为 $x_k$ 的函数将不再是高斯形式的指数二次函数。将其与[高斯先验](@entry_id:749752)相乘，得到的后验分布 $p(x_k | y_{k})$ 也将是非高斯的。

由于[概率密度函数](@entry_id:140610)在每一步之后都变得越来越复杂，无法用有限的参数（如均值和协[方差](@entry_id:200758)）来描述，这使得精确的递归滤波在计算上变得不可行。这正是[扩展卡尔曼滤波器](@entry_id:199333)试图解决的核心问题。

### EKF的核心原理：一阶线性化

[扩展卡尔曼滤波器](@entry_id:199333)的核心思想是一种务实且巧妙的近似：它放弃了对完整概率密度函数的精确追踪，转而假设在每一步中，状态的[分布](@entry_id:182848)都可以被一个高斯分布所充分近似。为了维持这一[高斯假设](@entry_id:170316)，EKF 在每个时间步都将[非线性系统](@entry_id:168347)**[局部线性化](@entry_id:169489)**。

具体来说，EKF 使用一阶泰勒级数展开来近似[非线性](@entry_id:637147)的[过程函数](@entry_id:144689) $f(x)$ 和观测函数 $h(x)$。对于一个通用的向量函数 $g(x)$，其在点 $\bar{x}$ 附近的一阶泰勒展开为：
$$g(x) \approx g(\bar{x}) + J_g(\bar{x})(x - \bar{x})$$
其中 $J_g(\bar{x}) = \left.\frac{\partial g}{\partial x}\right|_{x=\bar{x}}$ 是函数 $g$ 在点 $\bar{x}$ 处计算的**雅可比矩阵**（Jacobian matrix）。雅可比矩阵由函数的所有一阶[偏导数](@entry_id:146280)构成，它描述了函数在 $\bar{x}$ 点的[局部线性](@entry_id:266981)行为。

在EKF的语境下，我们将[过程函数](@entry_id:144689)和观测函数的雅可比矩阵分别记作 $F_k$ 和 $H_k$：
-   对于过程模型 $x_{k+1} = f(x_k) + w_k$，其雅可比矩阵为 $F_k = \left.\frac{\partial f}{\partial x}\right|_{x=\mu_{k-1|k-1}}$。
-   对于观测模型 $y_k = h(x_k) + v_k$，其雅可比矩阵为 $H_k = \left.\frac{\partial h}{\partial x}\right|_{x=\mu_{k|k-1}}$。

这里的 $\mu_{k-1|k-1}$ 和 $\mu_{k|k-1}$ 分别是上一时刻的[后验均值](@entry_id:173826)和当前时刻的先验均值，我们将在下一节详细讨论选择这些线性化点的原因。

让我们通过具体的例子来理解[雅可比矩阵](@entry_id:264467)的计算。

**示例 1：极坐标到[笛卡尔坐标](@entry_id:167698)的变换 [@problem_id:3380733]**
假设过程模型描述了一个点在极坐标下的运动，状态为 $x = \begin{pmatrix} r & \theta \end{pmatrix}^T$，函数为 $f(x) = \begin{pmatrix} r \cos \theta \\ r \sin \theta \end{pmatrix}$。其[雅可比矩阵](@entry_id:264467)为：
$$F(x) = \frac{\partial f}{\partial x} = \begin{pmatrix} \frac{\partial(r \cos \theta)}{\partial r} & \frac{\partial(r \cos \theta)}{\partial \theta} \\ \frac{\partial(r \sin \theta)}{\partial r} & \frac{\partial(r \sin \theta)}{\partial \theta} \end{pmatrix} = \begin{pmatrix} \cos \theta & -r \sin \theta \\ \sin \theta & r \cos \theta \end{pmatrix}$$

**示例 2：[非线性](@entry_id:637147)观测函数 [@problem_id:3380798]**
假设观测模型为 $h(x) = \begin{pmatrix} \exp(x_1) \\ x_1 x_2 \end{pmatrix}$。其[雅可比矩阵](@entry_id:264467)为：
$$H(x) = \frac{\partial h}{\partial x} = \begin{pmatrix} \frac{\partial(\exp(x_1))}{\partial x_1} & \frac{\partial(\exp(x_1))}{\partial x_2} \\ \frac{\partial(x_1 x_2)}{\partial x_1} & \frac{\partial(x_1 x_2)}{\partial x_2} \end{pmatrix} = \begin{pmatrix} \exp(x_1) & 0 \\ x_2 & x_1 \end{pmatrix}$$

通过在每个时间步计算这些[雅可比矩阵](@entry_id:264467)，EKF 将复杂的[非线性](@entry_id:637147)问题转化为一系列的线性问题，从而能够应用标准[卡尔曼滤波](@entry_id:145240)的[更新方程](@entry_id:264802)来传播均值和协[方差](@entry_id:200758)。

### EKF算法：预测与更新

EKF 算法的流程与线性[卡尔曼滤波](@entry_id:145240)非常相似，但关键区别在于均值和协[方差](@entry_id:200758)的传播方式中融入了[非线性](@entry_id:637147)函数本身及其雅可比矩阵。

#### 预测步骤

预测步骤的目标是根据 $k-1$ 时刻的后验估计 $(\mu_{k-1|k-1}, P_{k-1|k-1})$，计算出 $k$ 时刻的[先验估计](@entry_id:186098) $(\mu_{k|k-1}, P_{k|k-1})$。

-   **状态均值预测**：EKF 直接将上一时刻的[后验均值](@entry_id:173826)代入[非线性](@entry_id:637147)[过程函数](@entry_id:144689)来预测当前均值。
    $$\mu_{k|k-1} = f(\mu_{k-1|k-1})$$
    这可以看作是对真实均值 $E[f(x_{k-1})]$ 的一阶近似。

-   **协[方差](@entry_id:200758)预测**：协[方差](@entry_id:200758)的预测则使用线性化的传播规则。[过程函数](@entry_id:144689) $f$ 在 $\mu_{k-1|k-1}$ 处被线性化，其[雅可比矩阵](@entry_id:264467)为 $F_k = \left.\frac{\partial f}{\partial x}\right|_{\mu_{k-1|k-1}}$。不确定性（协[方差](@entry_id:200758)）通过这个[局部线性](@entry_id:266981)模型进行传播，并加上[过程噪声](@entry_id:270644)的协[方差](@entry_id:200758)。
    $$P_{k|k-1} = F_k P_{k-1|k-1} F_k^T + Q_k$$

#### 更新步骤

更新步骤利用 $k$ 时刻的观测值 $y_k$ 来修正[先验估计](@entry_id:186098)，得到后验估计 $(\mu_{k|k}, P_{k|k})$。

-   **线性化点的选择**：在更新步骤中，观测函数 $h$ 在**先验均值** $\mu_{k|k-1}$ 处进行线性化，得到雅可比矩阵 $H_k = \left.\frac{\partial h}{\partial x}\right|_{\mu_{k|k-1}}$。选择先验均值作为线性化点，而非其他可能点（如[后验均值](@entry_id:173826)），是EKF设计中的一个关键且深思熟虑的决策 [@problem_id:3380769]。其主要原因有三：
    1.  **信息可用性**：在处理观测值 $y_k$ 之前，先验均值 $\mu_{k|k-1}$ 是我们对状态 $x_k$ 的最佳估计。任何依赖于 $y_k$ 的线性化点（如[后验均值](@entry_id:173826)）在此时是未知的，使用它们会导致循环计算，从而产生更复杂的迭代式滤波器（如迭代EKF）。
    2.  **最小化期望[线性化误差](@entry_id:751298)**：[泰勒展开](@entry_id:145057)的误差主要由二阶项决定，其大小与 $(x_k - \bar{x})$ 的范数平方成正比。在先验分布 $p(x_k | y_{1:k-1})$ 的视角下，选择展开点 $\bar{x}$ 来最小化期望误差 $E[\|x_k - \bar{x}\|^2]$，其最优解正是该[分布](@entry_id:182848)的均值，即 $\mu_{k|k-1}$。
    3.  **[统计一致性](@entry_id:162814)**：[卡尔曼滤波](@entry_id:145240)的推导依赖于[卡尔曼增益](@entry_id:145800)与新息（innovation）之间的不相关性。如果[雅可比矩阵](@entry_id:264467) $H_k$ 的计算依赖于当前的观测值 $y_k$，这种不相关性就会被破坏，导致所谓的“双重使用”[观测信息](@entry_id:165764)，从而引入偏差并破坏滤波器的[统计一致性](@entry_id:162814)。

-   **[更新方程](@entry_id:264802)**：一旦 $h$ 被线性化，更新步骤就完全遵循标准[卡尔曼滤波](@entry_id:145240)的方程：
    1.  **新息 (Innovation)**：$\nu_k = y_k - h(\mu_{k|k-1})$
    2.  **新息协[方差](@entry_id:200758) (Innovation Covariance)**：$S_k = H_k P_{k|k-1} H_k^T + R_k$
    3.  **[卡尔曼增益](@entry_id:145800) (Kalman Gain)**：$K_k = P_{k|k-1} H_k^T S_k^{-1}$
    4.  **[后验均值](@entry_id:173826)更新 (Posterior Mean Update)**：$\mu_{k|k} = \mu_{k|k-1} + K_k \nu_k$
    5.  **后验协[方差](@entry_id:200758)更新 (Posterior Covariance Update)**：$P_{k|k} = (I - K_k H_k) P_{k|k-1}$

总结来说，EKF通过在每个时间步围绕当前最佳估计进行[局部线性化](@entry_id:169489)，从而将[非线性滤波](@entry_id:201008)问题强行纳入线性卡尔曼滤波的框架中，以递归地传播状态的[高斯近似](@entry_id:636047)（即均值和协[方差](@entry_id:200758)）[@problem_id:3380738]。

### 线性化的局限性：EKF的失效场景

尽管EKF应用广泛，但它本质上是一个近似滤波器。其性能完全取决于[局部线性化](@entry_id:169489)假设的有效性。当这一假设不成立时，EKF的性能会迅速下降，甚至导致[滤波器发散](@entry_id:749356)。理解这些局限性对于在实践中成功应用EKF至关重要。

#### 误差来源：高阶项

EKF的误差根源在于其忽略了[泰勒展开](@entry_id:145057)中的二阶及更高阶项 [@problem_id:3380733]。这些被忽略的项会导致两个主要问题：均值估计的偏差和[协方差估计](@entry_id:145514)的不一致性。

-   **均值偏差 (Bias in the Mean)**
    当[非线性](@entry_id:637147)函数具有显著的曲率（即[二阶导数](@entry_id:144508)较大）时，函数的[期望值](@entry_id:153208)不等于期望处的函数值，即 $E[g(x)] \neq g(E[x])$。EKF的均值传播（如 $\mu_{k|k-1} = f(\mu_{k-1|k-1})$）恰恰是用了 $g(E[x])$ 来近似 $E[g(x)]$，从而引入了系统性偏差。
    
    我们可以通过二阶泰勒展开来量化这个偏差。对于过程模型，真实预测均值的领先误差项（即偏差）可以表示为 [@problem_id:3380790]：
    $$E[\text{bias}] \approx \frac{1}{2} \sum_{i=1}^{n} e_i \mathrm{Tr}(H_{f,i} P_{k-1|k-1})$$
    其中 $H_{f,i}$ 是函数 $f$ 第 $i$ 个分量的海森矩阵（Hessian matrix），$P_{k-1|k-1}$ 是上一时刻的后验协[方差](@entry_id:200758)。这个公式清晰地表明，偏差的大小与[函数的曲率](@entry_id:173664)（由[海森矩阵](@entry_id:139140)捕捉）和状态的不确定性（由[协方差矩阵](@entry_id:139155)捕捉）的乘积直接相关。
    
    一个具体的例子是车辆定位问题 [@problem_id:3380742]。假设车辆状态包含航向角 $\psi$，观测函数为 $h(x) = (x_L - x)\cos(\psi) + (y_L - y)\sin(\psi)$。如果航向角存在较大的不确定性（即[方差](@entry_id:200758) $\sigma_\psi^2$ 较大），由于三角[函数的曲率](@entry_id:173664)，会导致新息产生一个系统性偏差，其大小近似为：
    $$\mathbb{E}[\nu] \approx -\frac{1}{2}h(\mu)\sigma_{\psi}^{2}$$
    这意味着如果预测的观测量 $h(\mu)$ 为正，航向不确定性会系统性地使期望观测量减小。EKF忽略了这种效应，导致其[状态估计](@entry_id:169668)产生偏差。

-   **协[方差](@entry_id:200758)不一致 (Inconsistent Covariance)**
    除了引入均值偏差，[非线性](@entry_id:637147)还会扭曲[概率分布](@entry_id:146404)的形状。一个对称的高斯分布经过强[非线性](@entry_id:637147)[函数变换](@entry_id:141095)后，可能会变得高度偏斜或呈现多峰形态。EKF的协[方差](@entry_id:200758)更新公式（如 $P_{k|k-1} = F_k P_{k-1|k-1} F_k^T + Q_k$）完全基于[线性变换](@entry_id:149133)，无法捕捉这种形状上的变化。通常，这会导致EKF**低估**真实的状态不确定性。
    
    当滤波器对其状态估计的协[方差](@entry_id:200758)变得过于乐观（即 $P_k$ 矩阵变得过小）时，我们称之为**滤波器不一致**（inconsistent）。一个不一致的滤波器会过度信任自己的（可能有偏差的）估计，而对新的观测数据反应不足（因为[卡尔曼增益](@entry_id:145800)会变小）。这可能导致滤波器无法从错误中恢复，最终发散 [@problem_id:3380734]。

#### 诊断线性化有效性

鉴于线性化的局限性，一个关键的实践问题是：如何判断EKF在特定应用中是否“足够好”？线性化近似的有效性取决于两个因素：**函数的[非线性](@entry_id:637147)程度**和**状态的不确定性大小**。如果函数在状态[不确定性集](@entry_id:637684)中的区域内接近线性，或者状态不确定性本身非常小，那么EKF的表现就会很好。

我们可以通过量化被忽略的二阶项的影响来诊断线性化假设的有效性。例如，对于一个观测函数 $h(x) = \tanh(x)$ [@problem_id:3380740]，我们可以计算其二阶泰勒[余项](@entry_id:159839) $r(x)$ 的期望平方值，并将其与观测噪声[方差](@entry_id:200758) $R$ 进行比较，形成一个无量纲比率 $B = \mathbb{E}[r(x)^2]/R$。这个比率衡量了由[非线性](@entry_id:637147)引起的[模型误差](@entry_id:175815)相对于[测量噪声](@entry_id:275238)的大小。如果 $B$ 很小（例如，小于一个阈值如0.05），则说明线性化是合理的。如果 $B$ 很大，则表明[非线性](@entry_id:637147)效应显著，标准EKF可能会表现不佳，此时应考虑使用更先进的滤波器，如迭代[扩展卡尔曼滤波器](@entry_id:199333)（IEKF）或[无迹卡尔曼滤波器](@entry_id:166733)（UKF）。

### 系统理论属性：[可观测性](@entry_id:152062)与[噪声模型](@entry_id:752540)

除了对[局部线性化](@entry_id:169489)误差的分析，我们还可以从更宏观的系统理论角度来审视EKF的性能。

#### 局部[可观测性](@entry_id:152062)

[可观测性](@entry_id:152062)是状态估问题中的一个核心概念，它回答了“是否可以仅通过系统的输出来唯一确定系统的内部状态？”这一问题。对于EKF，我们关心的是**局部可观测性**，即在其线性化的工作点附近，系统是否是可观测的。

对于一个在 $(\mu_k, P_k)$ 附近被 Jacobians $F_k$ 和 $H_k$ 线性化的系统，我们可以构建一个**局部[可观测性矩阵](@entry_id:165052)** [@problem_id:3380747]：
$$O_k = \begin{bmatrix} H_k \\ H_k F_k \\ \vdots \\ H_k F_k^{n-1} \end{bmatrix}$$
其中 $n$ 是[状态向量](@entry_id:154607)的维度。该线性化系统是局部可观测的，当且仅当该[矩阵的秩](@entry_id:155507)为 $n$，即 $\mathrm{rank}(O_k) < n$。

这个条件的意义在于：如果 $\mathrm{rank}(O_k) < n$，则存在某些状态方向（即 $O_k$ 的[零空间](@entry_id:171336)），无论系统如何演化，这些方向上的状态变化都不会影响输出观测。这意味着观测数据中不包含关于这些方向的任何信息。因此，EKF将无法纠正这些“不可观测”方向上的估计误差，导致这些误差持续存在甚至增长，最终可能引发[滤波器发散](@entry_id:749356)。因此，检验局部[可观测性矩阵](@entry_id:165052)的秩是分析EKF收敛性的重要一步。

与此相关的另一个概念是观测[雅可比矩阵](@entry_id:264467) $H_k$ 的**条件数** [@problem_id:3380798]。$H_k$ 的[条件数](@entry_id:145150)（最大[奇异值](@entry_id:152907)与最小[奇异值](@entry_id:152907)之比）反映了观测对不同状态方向的敏感度差异。一个很大的条件数意味着系统在某些方向上是**弱可观测的**。这不仅会使[状态估计](@entry_id:169668)在这些方向上非常不确定，还可能导致新息[协方差矩阵](@entry_id:139155) $S_k$ 变得病态（ill-conditioned），从而在计算[卡尔曼增益](@entry_id:145800)时引发[数值不稳定性](@entry_id:137058)。

#### 处理连续时间模型与[乘性噪声](@entry_id:261463)

许多物理系统由连续时间[随机微分方程](@entry_id:146618)（SDE）描述。一个常见的形式为：
$$\dot{x}(t) = f(x(t), t) + G(x(t), t)w(t)$$
其中 $w(t)$ 是连续时间[高斯白噪声](@entry_id:749762)。这里的噪声项 $G(x,t)w(t)$ 需要特别关注 [@problem_id:3380745]。
-   如果[噪声增益](@entry_id:264992)矩阵 $G$ 不依赖于状态 $x$，则噪声是**加性**的。
-   如果 $G$ 依赖于状态 $x$，则噪声是**[乘性](@entry_id:187940)**的，意味着噪声的强度和方向会随系统状态的变化而变化。

在将EKF应用于这类连续时间模型时，需要将[过程噪声](@entry_id:270644)离散化，以计算离散时间的[过程噪声协方差](@entry_id:186358)矩阵 $Q_k$。EKF通过在时间区间 $[t_k, t_{k+1}]$ 的起点对系统进行线性化来完成这一任务。它假设在该区间内，系统的动态矩阵 $A_k = \left.\frac{\partial f}{\partial x}\right|_{\hat{x}_k}$ 和[噪声增益](@entry_id:264992)矩阵 $G_k = G(\hat{x}_k, t_k)$ 保持不变。

在这种近似下，离散的[过程噪声协方差](@entry_id:186358) $Q_k$ 由以下积分给出：
$$Q_k \approx \int_{t_k}^{t_{k+1}} \Phi(t_{k+1}, \tau) G_k Q_c G_k^T \Phi(t_{k+1}, \tau)^T d\tau$$
其中 $Q_c$ 是连续时间噪声 $w(t)$ 的谱[密度矩阵](@entry_id:139892)，$\Phi(t, \tau)$ 是由线性化动态矩阵 $A_k$ 导出的[状态转移矩阵](@entry_id:269075)。这个积分公式正确地考虑了噪声在整个时间步长内如何通过线性化的系统动态进行传播和累积。这是EKF处理[乘性噪声](@entry_id:261463)的标准方法——通过在每个时间步的开始“冻结”[噪声增益](@entry_id:264992)，将其在局部视为[加性噪声](@entry_id:194447)进行处理。