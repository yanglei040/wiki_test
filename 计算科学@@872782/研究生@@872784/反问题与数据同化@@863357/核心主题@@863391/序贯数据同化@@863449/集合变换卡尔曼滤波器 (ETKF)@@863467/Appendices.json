{"hands_on_practices": [{"introduction": "集合变换卡尔曼滤波器（ETKF）的核心在于其高效更新集合异常的能力。本练习将引导您从第一性原理出发，在一个具体的空间网格上构建核心的变换矩阵 $T$。通过这个过程，您将实践如何将对于高维系统至关重要的局地化方案，与ETKF的数学框架相结合。[@problem_id:3379789]", "problem": "考虑集合变换卡尔曼滤波器（ETKF），它是集合子空间中卡尔曼滤波器更新的一种平方根实现。给定一个一维网格，由位于 $x = -\\Delta$、$x = 0$ 和 $x = \\Delta$ 的三个等间距点组成。在 $x = 0$ 处有一个单一标量观测，仪器具有高斯足迹，局地化半径为 $r$，因此只有最近邻点有贡献。有效局地观测算子 $H_{\\text{loc}}$ 通过对这三个网格点进行归一化的高斯加权，将状态 $x \\in \\mathbb{R}^{3}$ 映射到观测：\n$$\nw_{-} = \\exp\\!\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right), \\quad w_{0} = \\exp(0) = 1, \\quad w_{+} = \\exp\\!\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right),\n$$\n以及\n$$\nH_{\\text{loc}} = \\frac{1}{w_{0} + w_{-} + w_{+}}\\begin{pmatrix} w_{-}  w_{0}  w_{+} \\end{pmatrix}.\n$$\n你有一个包含 $N = 3$ 个预报成员的集合。设 $X^{f} \\in \\mathbb{R}^{3 \\times 3}$ 表示预报异常（其列向量之和为零向量），ETKF 使用的缩放异常矩阵为 $A^{f} = X^{f}/\\sqrt{N-1}$。观测误差协方差是标量 $R = \\sigma^{2}$。假设预报异常为\n$$\nX^{f} = \\begin{pmatrix}\n1  -1  0 \\\\\n0  1  -1 \\\\\n-1  0  1\n\\end{pmatrix}.\n$$\n从卡尔曼滤波器的第一性原理和集合变换的定义出发，完成以下任务：\n\n1. 推导 $H_{\\text{loc}}$ 对局地化半径 $r$ 和网格间距 $\\Delta$ 的显式依赖关系。\n2. 计算观测空间中的局地投影集合异常，\n$$\nY^{f} = H_{\\text{loc}}\\,A^{f} \\in \\mathbb{R}^{1 \\times 3}.\n$$\n3. 在集合空间中推导对称 ETKF 变换 $T \\in \\mathbb{R}^{3 \\times 3}$，该变换将预报异常映射到分析异常，其方法是强制集合子空间中的分析协方差与给定单一观测和误差协方差 $R$ 下的卡尔曼后验协方差相匹配。\n\n你的最终答案必须是变换矩阵 $T$ 的行列式关于 $r$、$\\Delta$ 和 $\\sigma$ 的单一闭式解析表达式。无需四舍五入。最终答案以无单位形式表示。[@problem_id:53]", "solution": "首先验证问题，以确保其具有科学依据、是良定的且客观的。\n\n**步骤1：提取给定条件**\n- 网格点：$x = -\\Delta$，$x = 0$，$x = \\Delta$。\n- 状态向量：$x \\in \\mathbb{R}^{3}$。\n- 在 x=0 处的单一标量观测。\n- 局地化半径为 r 的高斯足迹。\n- 局地观测算子的权重：$w_{-} = \\exp(-\\frac{\\Delta^{2}}{2 r^{2}})$，$w_{0} = 1$，$w_{+} = \\exp(-\\frac{\\Delta^{2}}{2 r^{2}})$。\n- 局地观测算子：$H_{\\text{loc}} = \\frac{1}{w_{0} + w_{-} + w_{+}}\\begin{pmatrix} w_{-}  w_{0}  w_{+} \\end{pmatrix}$。\n- 集合大小：$N = 3$。\n- 预报异常矩阵：$X^{f} \\in \\mathbb{R}^{3 \\times 3}$，$X^{f} = \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\\\ -1  0  1 \\end{pmatrix}$。\n- 缩放预报异常矩阵：$A^{f} = X^{f}/\\sqrt{N-1}$。\n- 观测误差协方差：$R = \\sigma^{2}$。\n- 任务：推导对称集合变换卡尔曼滤波器（ETKF）变换矩阵 $T$ 并求其行列式 $\\det(T)$。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学依据：**该问题使用了数据同化领域的标准定义和概念，特别是带局地化的 ETKF。其数学设置与既有文献一致。\n- **良定性：**所有必要信息均已提供。集合成员数（$N=3$）等于状态维度，异常矩阵 $X^f$ 的指定是正确的，其列向量之和为零向量，这是对异常矩阵的要求。问题要求一个特定的、可推导的量。\n- **客观性：**问题使用精确的数学语言陈述，没有歧义或主观成分。\n\n**步骤3：结论与行动**\n该问题是有效的。将提供完整的解答。\n\n**解答推导**\n\n解答过程按问题陈述的要求分为三个部分。\n\n**1. $H_{\\text{loc}}$ 的显式形式**\n\n局地观测算子 $H_{\\text{loc}}$ 由一组归一化权重定义。我们将非中心点的共同权重定义为\n$$w = w_{-} = w_{+} = \\exp\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right).$$\n中心点的权重为 $w_{0} = 1$。作为归一化因子的权重之和为\n$$S = w_{0} + w_{-} + w_{+} = 1 + 2w = 1 + 2\\exp\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right).$$\n因此，局地观测算子 $H_{\\text{loc}} \\in \\mathbb{R}^{1 \\times 3}$ 的显式形式为：\n$$H_{\\text{loc}} = \\frac{1}{S} \\begin{pmatrix} w  1  w \\end{pmatrix} = \\frac{1}{1 + 2\\exp\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right)} \\begin{pmatrix} \\exp\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right)  1  \\exp\\left(-\\frac{\\Delta^{2}}{2 r^{2}}\\right) \\end{pmatrix}.$$\n\n**2. 投影集合异常 $Y^{f}$ 的计算**\n\n首先，我们计算缩放预报异常矩阵 $A^{f}$。给定集合大小 $N=3$，缩放因子为 $1/\\sqrt{N-1} = 1/\\sqrt{2}$。\n$$A^{f} = \\frac{X^{f}}{\\sqrt{N-1}} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\\\ -1  0  1 \\end{pmatrix}.$$\n接下来，我们使用 $H_{\\text{loc}}$ 将这些缩放异常投影到观测空间，得到 $Y^{f} = H_{\\text{loc}} A^{f} \\in \\mathbb{R}^{1 \\times 3}$。\n$$Y^{f} = \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} w  1  w \\end{pmatrix} \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\\\ -1  0  1 \\end{pmatrix}.$$\n执行矩阵乘法：\n$$Y^{f} = \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} (w)(1) + (1)(0) + (w)(-1)  (w)(-1) + (1)(1) + (w)(0)  (w)(0) + (1)(-1) + (w)(1) \\end{pmatrix}$$\n$$Y^{f} = \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} 0  1-w  w-1 \\end{pmatrix}.$$\n\n**3. 变换矩阵 $T$ 及其行列式的推导**\n\nETKF 通过集合空间中的线性变换将缩放预报异常 $A^{f}$ 更新为缩放分析异常 $A^{a}$：$A^{a} = A^{f} T$。选择对称变换矩阵 $T \\in \\mathbb{R}^{3 \\times 3}$，使得分析协方差 $P^{a} = A^{a}(A^{a})^{T}$ 与理论上的卡尔曼后验协方差相匹配。\n\n集合空间中的分析误差协方差，记为 $P^{a}_{\\text{ens}}$，由以下公式给出：\n$$P^{a}_{\\text{ens}} = \\left( I + (Y^{f})^{T} R^{-1} Y^{f} \\right)^{-1},$$\n其中 $I$ 是 $N \\times N$（此处为 $3 \\times 3$）的单位矩阵。对称变换矩阵 $T$ 是 $P^{a}_{\\text{ens}}$ 的主平方根：\n$$T = (P^{a}_{\\text{ens}})^{1/2} = \\left( I + (Y^{f})^{T} R^{-1} Y^{f} \\right)^{-1/2}.$$\n我们的目标是求 $\\det(T)$。利用性质 $\\det(M^{a}) = (\\det(M))^{a}$：\n$$\\det(T) = \\det\\left( \\left( I + (Y^{f})^{T} R^{-1} Y^{f} \\right)^{-1/2} \\right) = \\left( \\det\\left(I + (Y^{f})^{T} R^{-1} Y^{f} \\right) \\right)^{-1/2}.$$\n我们来计算矩阵 $M = (Y^{f})^{T} R^{-1} Y^{f}$。观测误差协方差为 $R=\\sigma^2$，所以其逆为 $R^{-1} = 1/\\sigma^2$。\n$$(Y^{f})^{T} = \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1-w \\\\ w-1 \\end{pmatrix}.$$\n$$M = \\left( \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1-w \\\\ w-1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sigma^2} \\right) \\left( \\frac{1}{S\\sqrt{2}} \\begin{pmatrix} 0  1-w  w-1 \\end{pmatrix} \\right)$$\n$$M = \\frac{1}{2S^2\\sigma^2} \\begin{pmatrix} 0 \\\\ 1-w \\\\ w-1 \\end{pmatrix} \\begin{pmatrix} 0  1-w  w-1 \\end{pmatrix} = \\frac{1}{2S^2\\sigma^2} \\begin{pmatrix} 0  0  0 \\\\ 0  (1-w)^2  -(1-w)^2 \\\\ 0  -(1-w)^2  (1-w)^2 \\end{pmatrix}.$$\n我们定义一个标量常数 $\\alpha$ 来简化表示：\n$$\\alpha = \\frac{(1-w)^2}{2S^2\\sigma^2}.$$\n矩阵 $M$ 可以写成：\n$$M = \\alpha \\begin{pmatrix} 0  0  0 \\\\ 0  1  -1 \\\\ 0  -1  1 \\end{pmatrix}.$$\n现在我们计算 $I+M$ 的行列式：\n$$I+M = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ 0  \\alpha  -\\alpha \\\\ 0  -\\alpha  \\alpha \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1+\\alpha  -\\alpha \\\\ 0  -\\alpha  1+\\alpha \\end{pmatrix}.$$\n$$\\det(I+M) = 1 \\cdot \\det\\begin{pmatrix} 1+\\alpha  -\\alpha \\\\ -\\alpha  1+\\alpha \\end{pmatrix} - 0 + 0 = (1+\\alpha)^2 - (-\\alpha)^2 = 1+2\\alpha+\\alpha^2-\\alpha^2 = 1+2\\alpha.$$\n现在我们求 $\\det(T)$：\n$$\\det(T) = (1+2\\alpha)^{-1/2}.$$\n代入 $\\alpha$ 的表达式：\n$$1+2\\alpha = 1 + 2\\left(\\frac{(1-w)^2}{2S^2\\sigma^2}\\right) = 1 + \\frac{(1-w)^2}{S^2\\sigma^2}.$$\n最后，我们用问题参数 $r$、$\\Delta$ 和 $\\sigma$ 代入 $w$ 和 $S$ 的表达式：\n$$w = \\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)$$\n$$S = 1+2w = 1+2\\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)$$\n变换矩阵 $T$ 的行列式为：\n$$\\det(T) = \\left( 1 + \\frac{\\left(1-\\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)\\right)^2}{\\left(1+2\\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)\\right)^2 \\sigma^2} \\right)^{-1/2}.$$\n这就是所要求的 $T$ 的行列式的闭式解析表达式。", "answer": "$$\n\\boxed{\\left( 1 + \\frac{\\left(1-\\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)\\right)^{2}}{\\left(1+2\\exp\\left(-\\frac{\\Delta^{2}}{2r^{2}}\\right)\\right)^{2} \\sigma^{2}} \\right)^{-1/2}}\n$$", "id": "3379789"}, {"introduction": "在集合滤波中，一个常见的挑战是维持足够的集合离散度以避免滤波器发散。本练习介绍了一种强大的统计方法，通过最大化观测的似然函数来自动调整方差膨胀因子。完成这个练习将帮助您掌握如何应用统计原理来提高滤波器性能。[@problem_id:3379826]", "problem": "考虑一个用于状态空间模型的单次线性高斯数据同化循环，其观测算子为 $H \\in \\mathbb{R}^{m \\times n}$，集合预报均值为 $\\bar{x}^f \\in \\mathbb{R}^n$，观测值为 $y \\in \\mathbb{R}^m$。观测误差协方差为 $R \\in \\mathbb{R}^{m \\times m}$，是一个对称正定矩阵。将新息记为 $v = y - H \\bar{x}^f$，白化新息记为 $z = R^{-1/2} v$。令 $P^f \\in \\mathbb{R}^{n \\times n}$ 表示由该集合所代表的预报误差协方差。在集合变换卡尔曼滤波 (ETKF) 中，一个乘性膨胀因子 $\\alpha > 0$ 在分析步骤之前对预报协方差进行缩放，$P^f \\mapsto \\alpha P^f$，这等价于缩放其在观测空间中的投影。\n\n假设在此次循环中，观测空间中的白化预报-观测协方差是各向同性的，即\n$$\nA \\equiv R^{-1/2} H P^f H^{\\top} R^{-1/2} = c I_m,\n$$\n其中 $c > 0$ 为已知标量，$I_m$ 为单位矩阵。在乘性膨胀 $\\alpha$ 下，预测的白化新息协方差为\n$$\nS(\\alpha) = I_m + \\alpha A = \\left(1 + \\alpha c\\right) I_m.\n$$\n将白化新息 $z$ 视为均值为 0、协方差为 $S(\\alpha)$ 的高斯变量，并考虑其高斯对数似然\n$$\n\\ell(\\alpha \\, ; \\, z) = -\\tfrac{1}{2}\\Big( m \\ln(2\\pi) + \\ln \\det S(\\alpha) + z^{\\top} S(\\alpha)^{-1} z \\Big).\n$$\n请通过最大化上述高斯模型下新息 $z$ 的期望对数似然，设计一个自适应的乘性膨胀因子 $\\alpha$，并推导出与 ETKF 变换兼容的 $\\alpha$ 的闭式更新（即，确保在 ETKF 分析步骤中需要开平方根的对称矩阵保持正定）。然后，针对以下具体实例，对此更新进行数值计算：\n- 观测维度 $m = 3$。\n- 观测误差协方差 $R = \\mathrm{diag}(1, 4, 9)$。\n- 新息 $v = \\begin{pmatrix} 1.0 \\\\ 2.0 \\\\ 5.020 \\end{pmatrix}$。\n- 各向同性水平 $c = \\tfrac{1}{2}$，因此 $A = \\tfrac{1}{2} I_3$。\n\n此外，通过验证在你求得的解处对数似然的二阶导数为负，并且 ETKF 变换保持为实值，来测试你的最大化器的稳定性。仅报告此实例中膨胀因子 $\\alpha$ 的数值。将你的答案四舍五入至三位有效数字。膨胀因子是无量纲的；不要在最终答案中包含单位。", "solution": "该问题被评估为有效。它在数据同化和集合变换卡尔曼滤波（ETKF）的理论中有科学依据，是数学上适定、客观且自洽的。通过最大化似然函数来推导自适应膨胀因子的目标是统计估计中的一个标准流程。所有必要的数据和定义均已提供。\n\n目标是找到能使给定白化新息 $z$ 的高斯对数似然 $\\ell(\\alpha \\, ; \\, z)$ 最大化的乘性膨胀因子 $\\alpha > 0$。对数似然函数由下式给出：\n$$\n\\ell(\\alpha \\, ; \\, z) = -\\frac{1}{2}\\Big( m \\ln(2\\pi) + \\ln \\det S(\\alpha) + z^{\\top} S(\\alpha)^{-1} z \\Big)\n$$\n问题在各向同性的白化预报-观测协方差 $A = c I_m$ 的假设下，指定了预测的白化新息协方差 $S(\\alpha)$ 的结构：\n$$\nS(\\alpha) = I_m + \\alpha A = I_m + \\alpha (c I_m) = (1 + \\alpha c) I_m\n$$\n其中 $I_m$ 是 $m \\times m$ 的单位矩阵。\n\n我们现在可以将对数似然中的各项表示为 $\\alpha$ 的函数。\n行列式项是：\n$$\n\\ln \\det S(\\alpha) = \\ln \\det((1 + \\alpha c) I_m) = \\ln((1 + \\alpha c)^m) = m \\ln(1 + \\alpha c)\n$$\n$S(\\alpha)$ 的逆是：\n$$\nS(\\alpha)^{-1} = ((1 + \\alpha c) I_m)^{-1} = \\frac{1}{1 + \\alpha c} I_m\n$$\n对数似然中的二次型变为：\n$$\nz^{\\top} S(\\alpha)^{-1} z = z^{\\top} \\left(\\frac{1}{1 + \\alpha c} I_m\\right) z = \\frac{1}{1 + \\alpha c} z^{\\top}z\n$$\n将这些代入对数似然表达式，我们得到 $\\ell$ 作为 $\\alpha$ 的函数：\n$$\n\\ell(\\alpha) = -\\frac{1}{2}\\left( m \\ln(2\\pi) + m \\ln(1 + \\alpha c) + \\frac{z^{\\top}z}{1 + \\alpha c} \\right)\n$$\n为了最大化 $\\ell(\\alpha)$，我们对其关于 $\\alpha$ 求导，并令导数为零。为使最大化过程有意义，必须有 $1+\\alpha c > 0$。鉴于 $\\alpha>0$ 且 $c>0$，此条件得到满足。\n$$\n\\frac{d\\ell}{d\\alpha} = -\\frac{1}{2} \\left( m \\frac{c}{1 + \\alpha c} - \\frac{c(z^{\\top}z)}{(1 + \\alpha c)^2} \\right)\n$$\n将导数设为零：\n$$\n-\\frac{1}{2} \\left( \\frac{mc}{1 + \\alpha c} - \\frac{c(z^{\\top}z)}{(1 + \\alpha c)^2} \\right) = 0\n$$\n由于 $c > 0$，我们可以简化为：\n$$\n\\frac{m}{1 + \\alpha c} = \\frac{z^{\\top}z}{(1 + \\alpha c)^2}\n$$\n两边同乘以 $(1 + \\alpha c)^2$（非零），得到：\n$$\nm(1 + \\alpha c) = z^{\\top}z\n$$\n求解 $\\alpha$：\n$$\n1 + \\alpha c = \\frac{z^{\\top}z}{m}\n$$\n$$\n\\alpha c = \\frac{z^{\\top}z}{m} - 1\n$$\n$$\n\\alpha = \\frac{1}{c} \\left( \\frac{z^{\\top}z}{m} - 1 \\right)\n$$\n这就是通过最大化对数似然推导出的 $\\alpha$ 的闭式更新。\n\n我们必须通过检查二阶导数来验证该解的稳定性。\n$$\n\\frac{d^2\\ell}{d\\alpha^2} = -\\frac{1}{2} \\frac{d}{d\\alpha} \\left( \\frac{mc}{1 + \\alpha c} - \\frac{c(z^{\\top}z)}{(1 + \\alpha c)^2} \\right) = -\\frac{1}{2} \\left( -\\frac{mc^2}{(1 + \\alpha c)^2} + \\frac{2c^2(z^{\\top}z)}{(1 + \\alpha c)^3} \\right)\n$$\n$$\n\\frac{d^2\\ell}{d\\alpha^2} = \\frac{c^2}{2(1 + \\alpha c)^3} \\left( m(1 + \\alpha c) - 2z^{\\top}z \\right)\n$$\n在解点处，我们有 $m(1 + \\alpha c) = z^{\\top}z$。将此代入二阶导数：\n$$\n\\frac{d^2\\ell}{d\\alpha^2}\\Big|_{\\alpha=\\alpha^*} = \\frac{c^2}{2(1 + \\alpha^* c)^3} \\left( z^{\\top}z - 2z^{\\top}z \\right) = -\\frac{c^2 z^{\\top}z}{2(1 + \\alpha^* c)^3}\n$$\n在解处，我们也有 $1 + \\alpha^* c = z^{\\top}z/m$。对于任何非零新息向量 $z$，$z^{\\top}z > 0$，这意味着 $1 + \\alpha^* c > 0$。由于 $c > 0$，我们有 $c^2 > 0$。因此，二阶导数为负，证实该解确实是一个局部最大值。\n\n如果需要开平方根的矩阵 $(I_m + \\alpha A)^{-1/2}$ 是实数矩阵，则推导出的更新与 ETKF 变换是兼容的。这要求 $I_m + \\alpha A$ 是正定的。在本例中，$I_m + \\alpha A = (1+\\alpha c)I_m$，如果 $1+\\alpha c > 0$，该矩阵就是正定的。在我们的解中，$1+\\alpha c = z^{\\top}z/m$。由于 $z$ 是一个实向量，$z^{\\top}z \\ge 0$。只要 $z$ 不是零向量，$z^{\\top}z > 0$，该条件就得到满足。\n问题还指定了 $\\alpha>0$。根据我们的公式，这要求 $\\frac{z^{\\top}z}{m} - 1 > 0$，即 $z^{\\top}z > m$。这意味着只有当观测到的白化新息方差（由 $z^{\\top}z$ 表示）超过其在未膨胀模型下的期望值（$\\mathbb{E}[z^{\\top}z] = \\text{tr}(I_m) = m$）时，才会应用膨胀。\n\n现在，我们为给定的数值实例计算此更新：\n- $m = 3$\n- $R = \\mathrm{diag}(1, 4, 9)$\n- $v = \\begin{pmatrix} 1.0 \\\\ 2.0 \\\\ 5.020 \\end{pmatrix}$\n- $c = \\frac{1}{2}$\n\n首先，我们计算白化新息 $z = R^{-1/2} v$。矩阵 $R^{-1/2}$ 是一个对角矩阵，其对角线上的元素是 $R$ 对应元素的平方根的倒数：\n$$\nR^{1/2} = \\mathrm{diag}(\\sqrt{1}, \\sqrt{4}, \\sqrt{9}) = \\mathrm{diag}(1, 2, 3)\n$$\n$$\nR^{-1/2} = \\mathrm{diag}(1^{-1}, 2^{-1}, 3^{-1}) = \\mathrm{diag}(1, \\tfrac{1}{2}, \\tfrac{1}{3}) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix}\n$$\n现在我们计算 $z$：\n$$\nz = R^{-1/2} v = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{2}  0 \\\\ 0  0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 2.0 \\\\ 5.020 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\times 1 \\\\ 2.0 \\times \\frac{1}{2} \\\\ 5.020 \\times \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 1.0 \\\\ \\frac{5.020}{3} \\end{pmatrix}\n$$\n接下来，我们计算平方范数 $z^{\\top}z$：\n$$\nz^{\\top}z = (1.0)^2 + (1.0)^2 + \\left(\\frac{5.020}{3}\\right)^2 = 1.0 + 1.0 + \\frac{25.2004}{9} = 2.0 + \\frac{25.2004}{9}\n$$\n$$\nz^{\\top}z = \\frac{18.0}{9} + \\frac{25.2004}{9} = \\frac{43.2004}{9}\n$$\n其值约为 $z^{\\top}z \\approx 4.800044...$\n\n现在我们将 $m$、$c$ 和 $z^{\\top}z$ 的值代入 $\\alpha$ 的公式中：\n$$\n\\alpha = \\frac{1}{c} \\left( \\frac{z^{\\top}z}{m} - 1 \\right) = \\frac{1}{1/2} \\left( \\frac{43.2004/9}{3} - 1 \\right)\n$$\n$$\n\\alpha = 2 \\left( \\frac{43.2004}{27} - 1 \\right) = 2 \\left( \\frac{43.2004 - 27}{27} \\right) = 2 \\left( \\frac{16.2004}{27} \\right)\n$$\n$$\n\\alpha = \\frac{32.4008}{27} \\approx 1.2000296...\n$$\n条件 $\\alpha > 0$ 得到满足，因为 $z^{\\top}z \\approx 4.8 > m=3$。\n将答案四舍五入到三位有效数字，我们得到 $1.20$。", "answer": "$$\\boxed{1.20}$$", "id": "3379826"}, {"introduction": "除了基于统计推导的方法，由于其简单性和有效性，启发式的方差膨胀方案也得到广泛应用。本练习将探讨“先验离散度松弛”（RTPS）方法，它提供了一种直接控制分析集合方差的实用工具。通过这个练习，您将从另一个角度了解如何解决集合离散度不足的问题。[@problem_id:3379787]", "problem": "考虑集合变换卡尔曼滤波器（ETKF），其中集合异常被定义为具有零集合平均值。假设有一个单一标量状态变量和一个大小为 $m \\geq 3$ 的集合。用行向量 $X^{f} \\in \\mathbb{R}^{1 \\times m}$ 表示集合成员的预报异常，用 $X^{a} \\in \\mathbb{R}^{1 \\times m}$ 表示分析异常。定义集合的样本方差和协方差如下\n- $v_{f} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{f}_{1j}\\right)^{2}$，\n- $v_{a} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{a}_{1j}\\right)^{2}$，\n- $c = \\frac{1}{m-1} \\sum_{j=1}^{m} X^{a}_{1j} X^{f}_{1j}$，\n其中下标 $1j$ 指的是标量状态（第 $1$ 行）和集合成员 $j$，且异常满足 $\\sum_{j=1}^{m} X^{f}_{1j} = 0$ 和 $\\sum_{j=1}^{m} X^{a}_{1j} = 0$。\n\n在先验离散度松弛（RTPS）方案中，松弛后的分析异常 $X^{r}$ 通过以下凸组合获得\n$$\nX^{r} \\leftarrow \\gamma X^{a} + \\left(1 - \\gamma\\right) X^{f},\n$$\n其中松弛参数为 $\\gamma \\in \\mathbb{R}$。假设目标是实现相对于预报方差的目标分析方差分数 $\\alpha \\in (0,1)$，这意味着 $X^{r}$ 的样本方差等于 $\\alpha v_{f}$。\n\n仅使用上面给出的样本方差和协方差的基本定义，推导出 $\\gamma$ 必须满足的标量方程，求解该方程以获得用 $v_{f}$、$v_{a}$、$c$ 和 $\\alpha$ 表示的 $\\gamma$ 的闭式表达式，然后对特定值 $v_{f} = 9$、$v_{a} = 4$、$c = 5$ 和 $\\alpha = \\frac{1}{2}$ 计算 $\\gamma$。报告位于区间 $[0,1]$ 内的 $\\gamma$ 值。将您的最终数值答案四舍五入到 $4$ 位有效数字。", "solution": "该问题是有效的，因为它在科学上基于数据同化理论，在数学上是适定的，并提供了一套完整且一致的定义和数值。\n\n第一步是推导松弛后的分析异常 $X^{r}$ 的样本方差表达式。松弛后的异常被定义为分析异常 $X^{a}$ 和预报异常 $X^{f}$ 的凸组合：\n$$\nX^{r} = \\gamma X^{a} + (1 - \\gamma) X^{f}\n$$\n其中 $\\gamma$ 是松弛参数。对于单个标量状态变量，此向量方程的第 $j$ 个分量为：\n$$\nX^{r}_{1j} = \\gamma X^{a}_{1j} + (1 - \\gamma) X^{f}_{1j}\n$$\n问题指出，预报异常和分析异常的集合平均值为零，即 $\\sum_{j=1}^{m} X^{f}_{1j} = 0$ 和 $\\sum_{j=1}^{m} X^{a}_{1j} = 0$。我们首先验证松弛后的异常 $X^{r}$ 也具有零集合平均值：\n$$\n\\sum_{j=1}^{m} X^{r}_{1j} = \\sum_{j=1}^{m} \\left( \\gamma X^{a}_{1j} + (1 - \\gamma) X^{f}_{1j} \\right) = \\gamma \\left(\\sum_{j=1}^{m} X^{a}_{1j}\\right) + (1 - \\gamma) \\left(\\sum_{j=1}^{m} X^{f}_{1j}\\right) = \\gamma(0) + (1 - \\gamma)(0) = 0\n$$\n由于平均值为零，$X^{r}$ 的样本方差（我们记为 $v_{r}$）由下式给出：\n$$\nv_{r} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{r}_{1j}\\right)^{2}\n$$\n代入 $X^{r}_{1j}$ 的表达式：\n$$\nv_{r} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left( \\gamma X^{a}_{1j} + (1 - \\gamma) X^{f}_{1j} \\right)^{2}\n$$\n我们展开平方项：\n$$\nv_{r} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left[ \\gamma^{2} \\left(X^{a}_{1j}\\right)^{2} + (1 - \\gamma)^{2} \\left(X^{f}_{1j}\\right)^{2} + 2\\gamma(1 - \\gamma) X^{a}_{1j} X^{f}_{1j} \\right]\n$$\n通过分配求和项和因子 $\\frac{1}{m-1}$，我们可以识别出给定的样本方差和协方差的定义：\n$$\nv_{r} = \\gamma^{2} \\left(\\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{a}_{1j}\\right)^{2}\\right) + (1 - \\gamma)^{2} \\left(\\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{f}_{1j}\\right)^{2}\\right) + 2\\gamma(1 - \\gamma) \\left(\\frac{1}{m-1} \\sum_{j=1}^{m} X^{a}_{1j} X^{f}_{1j}\\right)\n$$\n使用所提供的定义 $v_{a} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{a}_{1j}\\right)^{2}$、$v_{f} = \\frac{1}{m-1} \\sum_{j=1}^{m} \\left(X^{f}_{1j}\\right)^{2}$ 和 $c = \\frac{1}{m-1} \\sum_{j=1}^{m} X^{a}_{1j} X^{f}_{1j}$， $v_{r}$ 的表达式变为：\n$$\nv_{r} = \\gamma^{2} v_{a} + (1 - \\gamma)^{2} v_{f} + 2\\gamma(1 - \\gamma) c\n$$\n问题要求松弛后异常的方差是预报方差的一部分，比例为 $\\alpha$，即 $v_{r} = \\alpha v_{f}$。这就得出了 $\\gamma$ 必须满足的标量方程：\n$$\n\\alpha v_{f} = \\gamma^{2} v_{a} + (1 - \\gamma)^{2} v_{f} + 2\\gamma(1 - \\gamma) c\n$$\n为了求解 $\\gamma$，我们将此方程重排为标准二次型 $A\\gamma^{2} + B\\gamma + C = 0$。\n$$\n\\alpha v_{f} = \\gamma^{2} v_{a} + (1 - 2\\gamma + \\gamma^{2}) v_{f} + (2\\gamma - 2\\gamma^{2}) c\n$$\n$$\n\\alpha v_{f} = \\gamma^{2} v_{a} + v_{f} - 2\\gamma v_{f} + \\gamma^{2} v_{f} + 2\\gamma c - 2\\gamma^{2} c\n$$\n根据 $\\gamma$ 的幂次收集各项：\n$$\n\\gamma^{2}(v_{a} + v_{f} - 2c) + \\gamma(-2v_{f} + 2c) + (v_{f} - \\alpha v_{f}) = 0\n$$\n$$\n(v_{f} + v_{a} - 2c)\\gamma^{2} + 2(c - v_{f})\\gamma + (1 - \\alpha)v_{f} = 0\n$$\n此二次方程的解由二次公式给出，该公式提供了 $\\gamma$ 的闭式表达式：\n$$\n\\gamma = \\frac{-2(c - v_{f}) \\pm \\sqrt{(2(c - v_{f}))^{2} - 4(v_{f} + v_{a} - 2c)(1 - \\alpha)v_{f}}}{2(v_{f} + v_{a} - 2c)}\n$$\n$$\n\\gamma = \\frac{v_{f} - c \\pm \\sqrt{(v_{f} - c)^{2} - (v_{f} + v_{a} - 2c)(1 - \\alpha)v_{f}}}{v_{f} + v_{a} - 2c}\n$$\n现在我们代入给定的数值：$v_{f} = 9$，$v_{a} = 4$，$c = 5$，和 $\\alpha = \\frac{1}{2}$。首先，我们计算二次方程的系数：\n$A = v_{f} + v_{a} - 2c = 9 + 4 - 2(5) = 13 - 10 = 3$。\n$B = 2(c - v_{f}) = 2(5 - 9) = 2(-4) = -8$。\n$C = (1 - \\alpha)v_{f} = (1 - \\frac{1}{2})(9) = \\frac{9}{2} = 4.5$。\n关于 $\\gamma$ 的二次方程为：\n$$\n3\\gamma^{2} - 8\\gamma + 4.5 = 0\n$$\n使用二次公式求根：\n$$\n\\gamma = \\frac{-(-8) \\pm \\sqrt{(-8)^{2} - 4(3)(4.5)}}{2(3)}\n$$\n$$\n\\gamma = \\frac{8 \\pm \\sqrt{64 - 54}}{6}\n$$\n$$\n\\gamma = \\frac{8 \\pm \\sqrt{10}}{6}\n$$\n这会产生 $\\gamma$ 的两个可能值：\n$$\n\\gamma_{1} = \\frac{8 + \\sqrt{10}}{6} \\quad \\text{和} \\quad \\gamma_{2} = \\frac{8 - \\sqrt{10}}{6}\n$$\n我们计算这些值，以确定哪一个位于区间 $[0,1]$ 内。使用近似值 $\\sqrt{10} \\approx 3.16227766$：\n$$\n\\gamma_{1} \\approx \\frac{8 + 3.16227766}{6} = \\frac{11.16227766}{6} \\approx 1.860379\n$$\n$$\n\\gamma_{2} \\approx \\frac{8 - 3.16227766}{6} = \\frac{4.83772234}{6} \\approx 0.806287\n$$\n第一个根 $\\gamma_{1}$ 大于 $1$，因此在所需区间之外。第二个根 $\\gamma_{2}$ 在区间 $[0,1]$ 内。因此，松弛参数的正确值为 $\\gamma = \\frac{8 - \\sqrt{10}}{6}$。\n问题要求将此值四舍五入到 $4$ 位有效数字。\n$\\gamma \\approx 0.806287...$\n前四位有效数字是 $8$、$0$、$6$、$2$。第五位有效数字是 $8$，大于或等于 $5$，所以我们将第四位有效数字向上取整。\n$\\gamma \\approx 0.8063$。", "answer": "$$\n\\boxed{0.8063}\n$$", "id": "3379787"}]}