## 引言
在[贝叶斯推断](@entry_id:146958)的宏伟框架中，先验概率[分布](@entry_id:182848)是连接理论与实践的基石，尤其在处理反演问题和[数据同化](@entry_id:153547)时，其作用更是不可或缺。它不仅仅是一个数学符号，更是我们将领域知识、物理约束和对解的合理预期注入模型的严谨语言。然而，如何构建一个既能有效反映我们先验知识，又能在数学上易于处理的[先验分布](@entry_id:141376)，是许多科学与工程领域面临的核心挑战。当观测数据不足或含噪时，反演问题往往是病态的，导致解的不唯一或不稳定。此时，一个精心设计的先验便成为解决问题的关键，它通过正则化效应，引导推断过程走向一个物理上有意义且结构合理的解。

本文旨在系统性地阐述先验概率建模的核心思想与实践。我们将深入探讨：
- **原理与机制**：本章将从贝叶斯定理的基础出发，剖析先验作为正则化项的本质，详细介绍从离散[高斯马尔可夫随机场](@entry_id:749746)到无限维[函数空间](@entry_id:143478)[高斯测度](@entry_id:749747)的构建方法，并探讨如何通过[偏微分方程](@entry_id:141332)、非高斯模型及分层结构来编码更复杂的知识。
- **应用与跨学科联系**：通过来自地球物理、医学成像、信号处理和[计算生物学](@entry_id:146988)等领域的具体案例，我们将展示先验模型如何在实践中施加物理约束（如守恒律和正定性）、促进[稀疏性](@entry_id:136793)、进行模型选择以及在动态系统中扮演关键角色。
- **动手实践**：通过一系列精心设计的编程与理论练习，您将亲手实现和分析不同的先验模型，从而将理论知识转化为解决实际问题的能力。

通过这三个层层递进的章节，您将掌握构建、理解和应用[先验概率](@entry_id:275634)模型的全面技能。让我们首先深入其核心，探索[先验概率](@entry_id:275634)建模的**原理与机制**。

## 原理与机制

在[贝叶斯反演](@entry_id:746720)问题的框架中，先验概率[分布](@entry_id:182848) $p(u)$ 扮演着至关重要的角色。它不仅是[贝叶斯定理](@entry_id:151040)的一个组成部分，更编码了关于未知参数 $u$ 的先验知识、信念和期望。在一个典型的反演问题中，我们试图根据间接的、带有噪声的观测 $y$ 来推断 $u$。观测模型通常可以写为 $y = \mathcal{G}(u) + \eta$，其中 $\mathcal{G}$ 是正演算子，$\eta$ 是噪声。由于这类问题往往是病态的（ill-posed），即解不唯一或对观测数据极其敏感，因此来自观测数据的信息本身可能不足以确定一个稳定且物理上有意义的解。此时，先验分布就发挥了其作为**正则化项**的关键作用，它将[解空间](@entry_id:200470)约束在一个更“合理”的[子集](@entry_id:261956)内，从而使问题良态化（well-posed）。本章将深入探讨构建[先验分布](@entry_id:141376)的原理与机制，从经典的平滑[高斯先验](@entry_id:749752)到能够保持[不连续性](@entry_id:144108)的非[高斯先验](@entry_id:749752)，再到处理不确定性的[分层模型](@entry_id:274952)和保证[网格无关性](@entry_id:634417)的[函数空间](@entry_id:143478)方法。

### 贝叶斯推断的基本构成

在深入研究具体的先验模型之前，我们首先需要清晰地理解贝叶斯框架中的三个核心要素：**先验 (prior)**、**似然 (likelihood)** 和 **后验 (posterior)**。这三者在概念和数学形式上都有着本质的区别。

**[先验分布](@entry_id:141376)** $p(u)$，在无限维设置下更严谨地表示为一个概率测度 $\mu_0$，它完全独立于观测数据 $y$。它定量地描述了我们在获得任何观测之前关于未知参数 $u$ 的所有知识和假设。例如，如果我们预期 $u$ 是一个平滑函数，我们可以选择一个将主要概率[质量集中](@entry_id:175432)在平滑函数上的先验。在病态反演问题中，这种通过先验来偏好某些解（如平滑解）而不是其他解（如[振荡](@entry_id:267781)解）的做法，正是正则化的核心思想 [@problem_id:3414146]。

**似然函数** $p(y \mid u)$ 则完全由观测模型和噪声统计特性决定。给定一个确定的参数 $u$，它描述了观测到数据 $y$ 的[概率密度](@entry_id:175496)。例如，在常见的加性高斯噪声假设下，即 $\eta \sim \mathcal{N}(0, \Gamma)$，[似然函数](@entry_id:141927)可以表示为 $p(y \mid u) \propto \exp(-\Phi(u;y))$，其中 $\Phi(u;y) = \frac{1}{2}\|y - \mathcal{G}(u)\|_{\Gamma}^2 = \frac{1}{2}(y - \mathcal{G}(u))^\top \Gamma^{-1} (y - \mathcal{G}(u))$ 是[数据失配](@entry_id:748209)项（data misfit）。需要强调的是，当 $y$ 固定而被看作是 $u$ 的函数时，$p(y \mid u)$ 并不是一个关于 $u$ 的[概率密度](@entry_id:175496)，其对 $u$ 的积分不一定为 $1$ [@problem_id:3414146]。

**[后验分布](@entry_id:145605)** $p(u \mid y)$，或对应的后验测度 $\mu^y$，是贝叶斯推断的最终产物。它通过贝叶斯定理将先验知识与从数据中获得的信息相结合，代表了在观测到 $y$ 之后我们对 $u$ 的更新认知。其数学表达为 $p(u \mid y) \propto p(y \mid u) p(u)$。在更严谨的测度论框架下，这表现为后验测度 $\mu^y$ 关于先验测度 $\mu_0$ 的[绝对连续性](@entry_id:144513)，其拉东-尼科迪姆（Radon-Nikodym）导数为：
$$
\frac{d\mu^y}{d\mu_0}(u) = \frac{1}{Z(y)} \exp(-\Phi(u;y))
$$
其中 $Z(y) = \int_X \exp(-\Phi(u;y)) \,d\mu_0(u)$ 是归一化常数，也称为边缘[似然](@entry_id:167119)或证据（evidence）。这个公式清晰地表明，后验分布是先验信念被[似然函数](@entry_id:141927)“加权”或“修正”后的结果 [@problem_id:3414146]。

[后验分布](@entry_id:145605)的众数，即[后验概率](@entry_id:153467)密度达到最大值的点，被称为**最大后验（MAP）估计**。在有限维空间中，这等价于最小化负对数后验，即求解 $\arg\min_u (\Phi(u;y) - \log p(u))$。例如，在线性高斯情况下，$u \sim \mathcal{N}(m, C)$ 且 $\eta \sim \mathcal{N}(0, \Gamma)$，[MAP估计](@entry_id:751667)等价于求解一个[Tikhonov正则化](@entry_id:140094)[最小二乘问题](@entry_id:164198)，其解满足一个[线性系统](@entry_id:147850) [@problem_id:3414146]。然而，在无限维函数空间中，“众数”的概念变得微妙，因为任何单点的概率都为零。此时，[MAP估计](@entry_id:751667)被更严谨地定义为后验测度在小球极限意义下的集中点。这最终等价于求解一个[变分问题](@entry_id:756445)，其目标函数由[数据失配](@entry_id:748209)项和先验诱导的正则化项构成 [@problem_id:3414082]。我们将在后续章节中进一步阐明这一点。

### 构建[高斯先验](@entry_id:749752)：从离散到连续

[高斯分布](@entry_id:154414)因其分析上的便利性和良好的解释性而成为构建先验分布最常用的选择。它假设未知参数的[先验信息](@entry_id:753750)可以通过其均值（期望的解）和协[方差](@entry_id:200758)（解的变异性和相关性结构）来充分描述。

#### 离散场的[高斯马尔可夫随机场](@entry_id:749746)（GMRF）先验

当未知参数 $u$ 被离散化为网格上的一个向量 $x \in \mathbb{R}^n$ 时，[高斯马尔可夫随机场](@entry_id:749746)（GMRF）提供了一种强大而高效的方式来构建编码局部相互作用的先验。GMRF是一个[高斯随机向量](@entry_id:635820)，其特殊之处在于它的**[精度矩阵](@entry_id:264481)**（precision matrix）$Q$（即协方差矩阵的逆 $Q = \Sigma^{-1}$）是稀疏的。

GMRF的关键性质在于，[精度矩阵](@entry_id:264481)中的零元素直接对应于[条件独立性](@entry_id:262650)。具体而言，对于任意 $i \neq j$，当且仅当给定所有其他变量 $x_{-(i,j)}$ 时，$x_i$ 和 $x_j$ 条件独立，我们有 $Q_{ij} = 0$。这意味着一个变量的条件分布仅依赖于其“邻居”，即在[精度矩阵](@entry_id:264481)的图结构中与之相连的节点。这个性质使得GMRF成为对空间或时间序列数据中局部依赖关系建模的理想工具 [@problem_id:3414203]。

为了鼓励场的局部平滑性，一个常见的GMRF构造是基于[图拉普拉斯算子](@entry_id:275190)。考虑一个代表离散网格的图 $G=(V, E)$，我们可以构建如下形式的[精度矩阵](@entry_id:264481)：
$$
Q = \kappa^2 I + \sum_{(i,j) \in E} w_{ij} (e_i - e_j)(e_i - e_j)^\top
$$
其中 $\kappa^2 \ge 0$ 是一个控制对零点偏移惩罚的参数，$w_{ij} \ge 0$ 是连接节点 $i$ 和 $j$ 的边的权重。对应的负对数先验概率，即能量函数，具有一个非常直观的形式：
$$
x^\top Q x = \kappa^2 \sum_{i=1}^n x_i^2 + \sum_{(i,j) \in E} w_{ij} (x_i - x_j)^2
$$
这个二次型清晰地展示了先验的作用：它惩罚场值本身的大小（第一项），以及相邻节点之间值的差异（第二项）。较大的差值 $(x_i - x_j)^2$ 会导致较低的先验概率，因此该先验倾向于使相邻节点的值相似，从而促进了场的平滑性。当 $\kappa^2=0$ 且图是连通的，[精度矩阵](@entry_id:264481) $Q$ 是奇异的，其零空间由常数[向量张成](@entry_id:152883)。这对应于一个**内在GMRF（IGMRF）**，它是一个不当（improper）先验，只对场值的差异有定义，而对场的绝对水平没有约束 [@problem_id:3414203]。

#### 连续场的无限维[高斯先验](@entry_id:749752)

将离散模型推广到连续的[函数空间](@entry_id:143478)，例如 $L^2(\Omega)$，需要我们使用无限维[高斯测度](@entry_id:749747)的语言。一个定义在希尔伯特空间 $\mathcal{H}$ 上的[高斯测度](@entry_id:749747) $\mu_0 = \mathcal{N}(m_0, \mathcal{C}_0)$ 由其均值元素 $m_0 \in \mathcal{H}$ 和协[方差](@entry_id:200758)算子 $\mathcal{C}_0$ 完全确定。为了使测度有意义，$\mathcal{C}_0$ 必须是一个有界的、自伴的、非负的**迹类（trace-class）**算子。

在无限维空间中，[高斯测度](@entry_id:749747)展现出一些与有限维情况截然不同的、违反直觉的特性。其中最核心的区别在于**[卡梅伦-马丁空间](@entry_id:203032)（Cameron-Martin space）** $\mathcal{H}_{\mathcal{C}_0}$ 和测度的**支撑集（support）** $\operatorname{supp}(\mu_0)$ 之间的关系。

[卡梅伦-马丁空间](@entry_id:203032) $\mathcal{H}_{\mathcal{C}_0}$ 是由协[方差](@entry_id:200758)算子“平方根”的值域 $\operatorname{Range}(\mathcal{C}_0^{1/2})$ 构成的[希尔伯特空间](@entry_id:261193)。它代表了测度的“平滑方向”。而[测度的支撑集](@entry_id:191178) $\operatorname{supp}(\mu_0)$ 是包含几乎所有样本的最小[闭集](@entry_id:136446)，对于一个非退化的无限维[高斯测度](@entry_id:749747)，它通常是整个空间 $\mathcal{H}$（或其一个[稠密子空间](@entry_id:261392)）。

关键的事实是：一个从[高斯测度](@entry_id:749747) $\mu_0$ 中随机抽取的样本，其几乎肯定（with probability one）**不属于**对应的[卡梅伦-马丁空间](@entry_id:203032) $\mathcal{H}_{\mathcal{C}_0}$。换句话说，$\mathcal{H}_{\mathcal{C}_0}$ 虽然在 $\operatorname{supp}(\mu_0)$ 中是稠密的，但它本身的测度为零，即 $\mu_0(\mathcal{H}_{\mathcal{C}_0}) = 0$。直观上，[卡梅伦-马丁空间](@entry_id:203032)包含了足够“规则”或“平滑”的函数，而[高斯测度](@entry_id:749747)的典型样本则要“粗糙”得多，不具备这种规则性 [@problem_id:3414096]。

这个看似矛盾的现象恰恰是理解无限维[贝叶斯推断](@entry_id:146958)的关键。[MAP估计](@entry_id:751667)，作为后验分布的“众数”，被证明恰好位于[卡梅伦-马丁空间](@entry_id:203032)中。这可以通过小球概率的[渐近分析](@entry_id:160416)来严格定义。[MAP估计](@entry_id:751667) $u_{\mathrm{MAP}}$ 等价于最小化一个泛函 $I(u)$：
$$
I(u) = \frac{1}{2}\left\|\Gamma^{-1/2}\bigl(\mathcal{G}(u)-y\bigr)\right\|_{\mathbb{R}^{m}}^{2} + \frac{1}{2}\|u\|_{\mathcal{H}_{\mathcal{C}_0}}^{2} \quad \text{for } u \in \mathcal{H}_{\mathcal{C}_0}
$$
其中第二项 $\|u\|_{\mathcal{H}_{\mathcal{C}_0}}^{2}$ 正是 $u$ 在[卡梅伦-马丁空间](@entry_id:203032)中的范数平方。这个泛函也称为翁萨格-马赫卢普（Onsager-Machlup）泛函。这个结果优雅地揭示了贝叶斯[MAP估计](@entry_id:751667)与[变分正则化](@entry_id:756446)方法之间的深刻联系：先验分布的卡梅伦-马丁范数充当了正则化惩罚项。因此，尽管[先验分布](@entry_id:141376)的典型样本是“粗糙”的，但后验分布的模式（[MAP估计](@entry_id:751667)）却是一个“平滑”的、位于[卡梅伦-马丁空间](@entry_id:203032)内的函数 [@problem_id:3414082]。

### 先验模型的扩展与深化

虽然[高斯先验](@entry_id:749752)应用广泛，但其固有的平滑特性在某些应用中可能成为一种限制。现代先验建模技术提供了更丰富的工具箱，以编码更复杂的结构信息。

#### 基于[偏微分方程](@entry_id:141332)（PDE）的先验

将GMRF中基于[图拉普拉斯算子](@entry_id:275190)的思想推广到连续领域，我们可以使用偏[微分算子](@entry_id:140145)（PDE operator）来构建先验。这种方法被称为**物理信息先验（physics-informed prior）**，因为它允许我们将关于系统行为的物理定律（以PDE形式表达）直接编码到先验中。

具体来说，我们可以定义一个[高斯测度](@entry_id:749747)，其精度算子（协[方差](@entry_id:200758)算子的逆）由一个微分算子 $\mathcal{L}$ 及其[伴随算子](@entry_id:140236) $\mathcal{L}^*$ 构成，形式为 $\mathcal{Q} = \mathcal{L}^*\mathcal{L}$。在这种情况下，负对数先验泛函变为：
$$
\Phi_{\text{prior}}(u) = \frac{1}{2}\langle u, \mathcal{Q} u \rangle_{L^2} = \frac{1}{2}\|\mathcal{L}u\|_{L^2}^2
$$
这个表达式的含义是，[先验分布](@entry_id:141376)会惩罚那些使得 $\|\mathcal{L}u\|_{L^2}^2$ 较大的函数 $u$。如果 $\mathcal{L}$ 代表一个物理守恒律，那么这个先验就倾向于选择那些近似满足该物理律的解。此外，算子 $\mathcal{L}$ 的定义域 $\mathcal{D}(\mathcal{L})$ 通常包含了边界条件。由于[MAP估计](@entry_id:751667)的求解被限制在 $\mathcal{D}(\mathcal{L})$ 内，这自然地就将边界条件施加在了解上。

更重要的是，如果 $\mathcal{L}$ 是一个[椭圆算子](@entry_id:181616)（如拉普拉斯算子 $\Delta$），那么 $\mathcal{Q}$ 的[特征值](@entry_id:154894)会随着频率的增加而增长。这意味着高频分量在 $\Phi_{\text{prior}}(u)$ 中会受到更强的惩罚，从而有效地促进了解的[光滑性](@entry_id:634843)。因此，基于PDE的先验提供了一种在[函数空间](@entry_id:143478)中施加平滑性和物理约束的系统性方法 [@problem_id:3414137]。

#### 保持边缘的非[高斯先验](@entry_id:749752)：全变分（TV）

高斯平滑先验的一个主要缺点是它会对图像或信号中的锐利边缘（不连续点）进行模糊处理，因为这些地方的梯度很大，从而导致二次惩罚项 $\|Du\|_2^2$ 的值非常大。为了克服这个问题，我们需要使用对大梯度不那么敏感的先验。

**全变分（Total Variation, TV）**先验就是为此目的设计的。它用梯度的 $\ell_1$ 范数替代了 $\ell_2$ 范数的平方。对于一个离散场 $u$，各向同性TV先验的密度形式为：
$$
p(u) \propto \exp\left(-\lambda \sum_{i} \|(D u)_i \|_{2}\right)
$$
其中 $(Du)_i$ 是在位置 $i$ 的[离散梯度](@entry_id:171970)向量，$\| \cdot \|_2$ 是其欧几里得范数。这里的惩罚项与梯度幅值呈线性增长，而不是二次增长。与二次惩罚相比，线性惩罚对大梯度的容忍度更高，从而允许解中存在锐利的边缘。同时，由于 $\ell_1$ 范数在原点处的不[可微性](@entry_id:140863)，它会强烈地推动小的梯度值变为精确的零。这种**促进梯度[稀疏性](@entry_id:136793)**的特性，意味着在大部分区域梯度为零（即场是常数），而在少数地方梯度非零（即存在边缘）。这使得TV先验成为重建分片常数或分片光滑信号和图像的理想选择 [@problem_id:3414162]。

#### 通过变换施加约束

在许多实际问题中，未知参数需要满足某些硬性约束，例如非负性（如浓度场）或有界性（如比例系数）。直接在受约束的空间上定义先验可能很复杂。一个更灵活的策略是引入一个潜在（latent）的无约束变量，然后通过一个[非线性变换](@entry_id:636115)将其映射到受约束的空间。

一个典型的例子是为正定场 $u(x) > 0$ 构建先验。我们可以假设 $u(x)$ 的对数 $v(x) = \ln(u(x))$ 是一个[高斯过程](@entry_id:182192)（GP），即 $v \sim \mathcal{GP}(m, k)$。由于[高斯过程](@entry_id:182192)的样本路径可以在整个[实数轴](@entry_id:147286)上取值，通过指数变换 $u(x) = \exp(v(x))$，我们保证了 $u(x)$ 永远是正的。

这样得到的 $u(x)$ 遵循一个**对数高斯过程**。其任意[有限维分布](@entry_id:197042)都是[对数正态分布](@entry_id:261888)。例如，在任何单点 $x$，由于 $v(x) \sim \mathcal{N}(m(x), k(x,x))$，$u(x)$ 将服从对数正态分布，其期望为 $\mathbb{E}[u(x)] = \exp(m(x) + \frac{1}{2}k(x,x))$。这种变换方法非常强大，因为它允许我们利用[高斯过程](@entry_id:182192)成熟的理论和计算工具，同时又能严格满足像[正定性](@entry_id:149643)这样的重要物理约束 [@problem_id:3414126]。

### 实践中的高级框架与原则

在将先验模型应用于实际问题时，我们还会遇到一些更高级的挑战，例如如何选择先验的参数，以及如何确保我们的模型不受离散化选择的影响。

#### [分层贝叶斯模型](@entry_id:169496)与超参数

在前面的讨论中，我们通常假设[先验分布](@entry_id:141376)的参数（如[高斯先验](@entry_id:749752)的[方差](@entry_id:200758)或TV先验的正则化权重 $\lambda$）是已知的。然而在实践中，这些参数往往也充满不确定性。**[分层贝叶斯模型](@entry_id:169496)（Hierarchical Bayesian Models）**通过为这些参数（称为**超参数**, hyperparameters）赋予它们自己的[先验分布](@entry_id:141376)（称为**[超先验](@entry_id:750480)**, hyperpriors）来解决这个问题。

例如，对于一个条件[高斯先验](@entry_id:749752) $u \mid \lambda \sim \mathcal{N}(0, (\lambda L^\top L)^{-1})$，我们可以为精度缩放因子 $\lambda$ 指定一个Gamma[分布](@entry_id:182848)的[超先验](@entry_id:750480) $\lambda \sim \mathrm{Gamma}(a, b)$。这构成了一个两层的[分层模型](@entry_id:274952)。处理这种模型有几种不同的方法 [@problem_id:3414093]：

1.  **全贝叶斯（Full Bayesian）**：这种方法通[过积分](@entry_id:753033)将超参数从联合后验分布中[边缘化](@entry_id:264637)掉，从而得到 $u$ 的边际[后验分布](@entry_id:145605) $p(u \mid y) = \int p(u, \lambda \mid y) \,d\lambda$。这样可以完全量化超参数的不确定性。例如，在高斯-伽马分层模型中，得到的 $u$ 的边际先验是一个多变量学生t分布，其尾部比高斯分布更重，更能适应异常值。

2.  **[经验贝叶斯](@entry_id:171034)（Empirical Bayes）** 或 **II型最大似然（Type-II Maximum Likelihood）**：这是一种近似方法，它首先通过最大化[边际似然](@entry_id:636856) $p(y \mid \lambda) = \int p(y \mid u) p(u \mid \lambda) \,du$ 来获得超参数的[点估计](@entry_id:174544) $\hat{\lambda}_{\mathrm{EB}}$。然后，将这个估计值“插入”到后验中，基于 $p(u \mid y, \hat{\lambda}_{\mathrm{EB}})$ 进行推断。

3.  **II型最大后验（Type-II MAP）**：与[经验贝叶斯](@entry_id:171034)类似，但它通过最大化超参数的后验分布 $p(\lambda \mid y) \propto p(y \mid \lambda)p(\lambda)$ 来获得[点估计](@entry_id:174544) $\hat{\lambda}_{\mathrm{MAP}}$。当[超先验](@entry_id:750480) $p(\lambda)$ 是[均匀分布](@entry_id:194597)时，[经验贝叶斯](@entry_id:171034)和II型MAP会得到相同的结果。

#### 先验选择原则：[最大熵](@entry_id:156648)

那么，当先验知识非常有限时，我们应该如何选择一个先验分布呢？例如，我们可能只知道未知量的一些矩（如均值和[方差](@entry_id:200758)），而不清楚其完整的[分布](@entry_id:182848)形式。**[最大熵原理](@entry_id:142702)（Maximum Entropy Principle）**为这种情况提供了一个客观的标准。该原理指出，我们应该选择在满足所有已知约束的条件下，使得香农熵（Shannon entropy）最大化的那个[概率分布](@entry_id:146404)。

这样做可以确保我们引入的模型假设最少，即除了已知的约束外，不对未知量做任何额外的假设。一个关键的结果是，在给定某些矩约束的条件下，[最大熵](@entry_id:156648)[分布](@entry_id:182848)通常属于[指数族](@entry_id:263444)[分布](@entry_id:182848)。例如：
- 在 $\mathbb{R}$ 上给定均值和[方差](@entry_id:200758)，[最大熵先验](@entry_id:751775)是**[高斯分布](@entry_id:154414)**。
- 在 $\mathbb{R}_+$ 上给定均值，[最大熵先验](@entry_id:751775)是**[指数分布](@entry_id:273894)**。

这为在许多应用中（例如卡尔曼滤波器）采用[高斯假设](@entry_id:170316)提供了信息论上的有力辩护。最大熵方法与基于专家知识的[主观先验](@entry_id:174420)构建（通常通过[分层模型](@entry_id:274952)实现）形成了对比，前者力求“无信息性”，而后者则致力于将丰富的结构化信念编码到模型中 [@problem_id:3414214]。

#### [网格无关性](@entry_id:634417)与[函数空间](@entry_id:143478)方法

最后，一个在[计算建模](@entry_id:144775)中至关重要但常被忽略的问题是**[网格无关性](@entry_id:634417)（mesh-invariance）**或**重格化鲁棒性（regridding robustness）**。当我们在计算机上求解一个连续问题时，我们必须先将其离散化到一个网格上。一个好的先验模型应该保证，当我们改变[离散化网格](@entry_id:748523)（例如，加密或粗化网格）时，其内在的统计属性保持稳定。换句话说，离散模型应该被看作是某个唯一的、与网格无关的[连续模](@entry_id:158807)型的自洽近似。

基于函数空间算子定义的先验（如我们之前讨论的基于PDE的先验）天然地具有这种鲁棒性。这是因为它们从一个定义在无限维函数空间上的单一测度出发，不同的离散化只是这个统一测度的不同投影。从测度论的角度看，这意味着当网格细化时，[离散测度](@entry_id:183686)序列会弱收敛到一个明确的极限测度。

相比之下，那些直接在离散坐标上定义的先验（例如，假设网格节点的系数值独立同分布）通常不具备这种性质。它们的统计特性会随着网格的改变而根本性地改变，除非进行非常仔细的、与网格尺寸相关的缩放。否则，这样的离散先验序列在极限情况下可能不会收敛到一个有意义的[函数空间](@entry_id:143478)测度，或者会退化为像白噪声这样的广义[随机场](@entry_id:177952)。因此，坚持从函数空间的角度来构建先验，是确保模型具有物理一致性和预测鲁棒性的关键所在 [@problem_id:3414113]。