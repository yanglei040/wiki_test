{"hands_on_practices": [{"introduction": "这个练习是贝叶斯反问题中的一个基本热身。它在一个最简单却极具说明性的线性高斯模型中，演示了贝叶斯推断的核心机制。通过亲自推导后验分布，您将具体理解先验知识和观测数据如何通过数学方式结合，从而提炼出我们对未知参数的估计 [@problem_id:3414496]。", "problem": "考虑一个一维线性逆问题，其未知参数 $U \\in \\mathbb{R}$ 被建模为一个具有高斯先验分布 $U \\sim \\mathcal{N}(m_{0}, s_{0}^{2})$ 的随机变量。一个观测数据 $y \\in \\mathbb{R}$ 由正向模型 $y = a u + \\eta$ 生成，其中 $u$ 表示 $U$ 的一个实现，$a \\in \\mathbb{R}$ 是一个已知标量，$\\eta$ 是独立的加性噪声，其分布为 $\\eta \\sim \\mathcal{N}(0, \\sigma^{2})$。相关的负对数似然定义为\n$$\n\\Phi(u; y) = \\frac{1}{2 \\sigma^{2}} \\left( y - a u \\right)^{2},\n$$\n未归一化的似然由 $L(y \\mid u) = \\exp\\left( - \\Phi(u; y) \\right)$ 给出。令 $\\mu_{0}$ 表示 $U$ 在 $\\mathbb{R}$ 上的先验测度，$\\mu^{y}$ 表示给定观测 $y$ 的贝叶斯后验测度。\n\n从基本的测度论贝叶斯原理和高斯积分的核心性质出发，推导 Radon–Nikodym 导数 (RND) $\\frac{d \\mu^{y}}{d \\mu_{0}}(u)$ 及其归一化常数 $Z(y)$，该常数由 $\\mu^{y}$ 是一个概率测度的要求隐式定义。然后，使用先验加权平均恒等式，\n$$\n\\mathbb{E}_{\\mu^{y}}[f(U)] = \\frac{ \\int_{\\mathbb{R}} f(u) \\, L(y \\mid u) \\, d\\mu_{0}(u) }{ \\int_{\\mathbb{R}} L(y \\mid u) \\, d\\mu_{0}(u) },\n$$\n对选择 $f(u) = u$ 评估后验期望，使用具体的参数值\n$$\nm_{0} = 0.8, \\quad s_{0}^{2} = 0.49, \\quad a = 1.5, \\quad \\sigma^{2} = 0.36, \\quad y = 1.9.\n$$\n给出 $\\mathbb{E}_{\\mu^{y}}[U]$ 的最终数值，并将答案四舍五入到四位有效数字。该量没有物理单位。", "solution": "用户提供的问题是有效的，因为它在科学上基于贝叶斯统计和逆问题理论，是适定的，具有唯一解，客观，并且自洽，包含了所有必要的参数和定义。\n\n该问题要求推导后验测度相对于先验测度的 Radon–Nikodym 导数 (RND)、其归一化常数，以及随后计算后验期望 $\\mathbb{E}_{\\mu^{y}}[U]$。\n\n后验测度 $\\mu^{y}$ 和先验测度 $\\mu_{0}$ 之间的关系由贝叶斯定理给出。所提供的期望恒等式，\n$$\n\\mathbb{E}_{\\mu^{y}}[f(U)] = \\frac{ \\int_{\\mathbb{R}} f(u) \\, L(y \\mid u) \\, d\\mu_{0}(u) }{ \\int_{\\mathbb{R}} L(y \\mid u) \\, d\\mu_{0}(u) }\n$$\n可以与关于后验测度的期望定义 $\\mathbb{E}_{\\mu^{y}}[f(U)] = \\int_{\\mathbb{R}} f(u) \\, d\\mu^{y}(u)$ 进行比较。\n根据测度的性质，这意味着 $\\mu^{y}$ 相对于 $\\mu_{0}$ 的 Radon–Nikodym 导数由下式给出\n$$\n\\frac{d \\mu^{y}}{d \\mu_{0}}(u) = \\frac{L(y \\mid u)}{Z(y)}\n$$\n其中 $Z(y)$ 是归一化常数，也称为证据或边际似然，定义为\n$$\nZ(y) = \\int_{\\mathbb{R}} L(y \\mid u) \\, d\\mu_{0}(u)\n$$\n使得 $\\int_{\\mathbb{R}} d\\mu^{y}(u) = 1$。\n\n$U$ 的先验是高斯的，$U \\sim \\mathcal{N}(m_{0}, s_{0}^{2})$，因此其概率密度函数 (PDF) 为 $p_{0}(u) = \\frac{1}{\\sqrt{2\\pi s_{0}^{2}}} \\exp\\left(-\\frac{(u-m_{0})^{2}}{2s_{0}^{2}}\\right)$。先验测度为 $d\\mu_{0}(u) = p_{0}(u)du$。\n似然由 $L(y \\mid u) = \\exp(-\\Phi(u;y)) = \\exp\\left(-\\frac{(y-au)^{2}}{2\\sigma^{2}}\\right)$ 给出。\n\n后验概率密度函数 (PDF)，$p(u \\mid y)$，与似然和先验 PDF 的乘积成正比：\n$$\np(u \\mid y) \\propto L(y \\mid u) p_0(u)\n$$\n代入似然和先验密度的表达式，我们得到：\n$$\np(u \\mid y) \\propto \\exp\\left(-\\frac{(y-au)^{2}}{2\\sigma^{2}}\\right) \\frac{1}{\\sqrt{2\\pi s_{0}^{2}}} \\exp\\left(-\\frac{(u-m_{0})^{2}}{2s_{0}^{2}}\\right)\n$$\n后验分布与一个关于 $u$ 的二次项之和的指数成正比。我们现在可以忽略常数因子，专注于指数部分，记为 $J(u)$：\n$$\nJ(u) = -\\frac{1}{2} \\left[ \\frac{(y-au)^{2}}{\\sigma^{2}} + \\frac{(u-m_{0})^{2}}{s_{0}^{2}} \\right]\n$$\n展开括号内的二次项：\n$$\nJ(u) = -\\frac{1}{2} \\left[ \\frac{y^2-2ayu+a^2u^2}{\\sigma^{2}} + \\frac{u^2-2um_{0}+m_{0}^2}{s_{0}^{2}} \\right]\n$$\n按 $u$ 的幂次对项进行分组：\n$$\nJ(u) = -\\frac{1}{2} \\left[ u^2 \\left(\\frac{a^2}{\\sigma^2} + \\frac{1}{s_0^2}\\right) - 2u \\left(\\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) + \\left(\\frac{y^2}{\\sigma^2} + \\frac{m_0^2}{s_0^2}\\right) \\right]\n$$\n由于 $J(u)$ 是 $u$ 的二次函数，给定 $y$ 的 $U$ 的后验分布也是高斯分布，记为 $U|y \\sim \\mathcal{N}(m_{\\text{post}}, s_{\\text{post}}^2)$。该后验分布的 PDF 形式为 $p(u \\mid y) \\propto \\exp\\left(-\\frac{(u-m_{\\text{post}})^2}{2s_{\\text{post}}^2}\\right)$。\n将 $J(u)$ 的形式与高斯 PDF 的指数部分进行比较，我们可以确定后验方差 $s_{\\text{post}}^2$ 和均值 $m_{\\text{post}}$。乘以 $u^2$ 的项给出了后验方差的倒数（精度）：\n$$\n\\frac{1}{s_{\\text{post}}^2} = \\frac{a^2}{\\sigma^2} + \\frac{1}{s_0^2}\n$$\n因此，后验方差为 $s_{\\text{post}}^2 = \\left(\\frac{a^2}{\\sigma^2} + \\frac{1}{s_0^2}\\right)^{-1}$。\n乘以 $-2u$ 的项给出了后验均值与后验方差的比值：\n$$\n\\frac{m_{\\text{post}}}{s_{\\text{post}}^2} = \\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2}\n$$\n求解后验均值 $m_{\\text{post}}$：\n$$\nm_{\\text{post}} = s_{\\text{post}}^2 \\left(\\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) = \\left(\\frac{a^2}{\\sigma^2} + \\frac{1}{s_0^2}\\right)^{-1} \\left(\\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right)\n$$\n后验期望为 $\\mathbb{E}_{\\mu^{y}}[U] = m_{\\text{post}}$。\n\n归一化常数 $Z(y)$ 可以通过计算积分 $Z(y) = \\int_{\\mathbb{R}} L(y|u) p_0(u) du$ 来找到。认识到正向模型 $y = aU + \\eta$ 意味着 $y$ 是高斯随机变量的和，因此 $y$ 本身是高斯分布的，其均值为 $\\mathbb{E}[y] = a m_0$，方差为 $\\text{Var}(y) = a^2 s_0^2 + \\sigma^2$。$y$ 的边际 PDF 为 $p(y) = \\frac{1}{\\sqrt{2\\pi(a^2s_0^2+\\sigma^2)}} \\exp\\left(-\\frac{(y-am_0)^2}{2(a^2s_0^2+\\sigma^2)}\\right)$。\n根据密度的贝叶斯法则，$p(y) = \\int p(y|u)p(u)du = \\int \\frac{1}{\\sqrt{2\\pi\\sigma^2}} L(y|u) p_0(u) du = \\frac{1}{\\sqrt{2\\pi\\sigma^2}}Z(y)$。\n因此，$Z(y) = \\sqrt{2\\pi\\sigma^2}p(y) = \\sqrt{\\frac{\\sigma^2}{a^2s_0^2+\\sigma^2}} \\exp\\left(-\\frac{(y-am_0)^2}{2(a^2s_0^2+\\sigma^2)}\\right)$。\n于是 RND 为 $\\frac{d\\mu^y}{d\\mu_0}(u) = \\frac{L(y|u)}{Z(y)}$。\n\n我们现在使用给定的值进行后验期望 $\\mathbb{E}_{\\mu^{y}}[U] = m_{\\text{post}}$ 的数值计算：\n$m_{0} = 0.8$，$s_{0}^{2} = 0.49$，$a = 1.5$，$\\sigma^{2} = 0.36$，$y = 1.9$。\n\n首先，我们计算后验精度 $\\frac{1}{s_{\\text{post}}^2}$ 的分量：\n$$\n\\frac{1}{s_{0}^{2}} = \\frac{1}{0.49} = \\frac{100}{49}\n$$\n$$\n\\frac{a^2}{\\sigma^2} = \\frac{(1.5)^2}{0.36} = \\frac{2.25}{0.36} = \\frac{225}{36} = \\frac{25}{4}\n$$\n后验精度为：\n$$\n\\frac{1}{s_{\\text{post}}^2} = \\frac{25}{4} + \\frac{100}{49} = \\frac{25 \\times 49 + 100 \\times 4}{4 \\times 49} = \\frac{1225 + 400}{196} = \\frac{1625}{196}\n$$\n因此，后验方差为 $s_{\\text{post}}^2 = \\frac{196}{1625}$。\n\n接下来，我们计算 $m_{\\text{post}}$ 分子的各项：\n$$\n\\frac{m_0}{s_0^2} = \\frac{0.8}{0.49} = \\frac{80}{49}\n$$\n$$\n\\frac{ay}{\\sigma^2} = \\frac{1.5 \\times 1.9}{0.36} = \\frac{2.85}{0.36} = \\frac{285}{36} = \\frac{95}{12}\n$$\n总和为：\n$$\n\\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2} = \\frac{95}{12} + \\frac{80}{49} = \\frac{95 \\times 49 + 80 \\times 12}{12 \\times 49} = \\frac{4655 + 960}{588} = \\frac{5615}{588}\n$$\n最后，我们计算后验均值 $m_{\\text{post}}$：\n$$\nm_{\\text{post}} = s_{\\text{post}}^2 \\left(\\frac{ay}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) = \\frac{196}{1625} \\times \\frac{5615}{588}\n$$\n注意到 $588 = 3 \\times 196$：\n$$\nm_{\\text{post}} = \\frac{196}{1625} \\times \\frac{5615}{3 \\times 196} = \\frac{5615}{3 \\times 1625}\n$$\n简化分数：\n$$\n\\frac{5615}{1625} = \\frac{5 \\times 1123}{5 \\times 325} = \\frac{1123}{325}\n$$\n所以，\n$$\nm_{\\text{post}} = \\frac{1}{3} \\times \\frac{1123}{325} = \\frac{1123}{975}\n$$\n执行除法以获得数值：\n$$\nm_{\\text{post}} = \\frac{1123}{975} \\approx 1.15179487...\n$$\n四舍五入到四位有效数字，我们得到 $1.152$。\n\n因此，$U$ 的后验期望为 $\\mathbb{E}_{\\mu^{y}}[U] \\approx 1.152$。", "answer": "$$\\boxed{1.152}$$", "id": "3414496"}, {"introduction": "在得到后验估计后，我们必须评估其可靠性。本练习引入了费雪信息矩阵（Fisher Information Matrix），这是一个源于信息几何的强大工具，用于量化数据为未知参数提供了多少信息。通过分析此矩阵，我们可以识别出“信息贫乏的方向”，这些方向对应于数据无法有效约束的参数组合，这是诊断模型不可识别性的关键一步 [@problem_id:3414516]。", "problem": "考虑一个线性高斯数据模型，其中观测值 $Y \\in \\mathbb{R}^{3}$ 与未知参数 $u \\in \\mathbb{R}^{4}$ 通过 $Y \\sim \\mathcal{N}(A u, \\Gamma)$ 相关联，其中 $A \\in \\mathbb{R}^{3 \\times 4}$ 和 $\\Gamma \\in \\mathbb{R}^{3 \\times 3}$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n1  1  1  1\n\\end{pmatrix},\n\\qquad\n\\Gamma \\;=\\; \\begin{pmatrix}\n2  0  0 \\\\\n0  3  1 \\\\\n0  1  2\n\\end{pmatrix}.\n$$\n从 Fisher 信息矩阵（FIM）的基本定义出发，对于参数概率密度族 $p(y \\mid u)$ 中的参数 $u$，FIM 是对数似然函数的负 Hessian 矩阵的期望值，\n$$\nI(u) \\;=\\; \\mathbb{E}_{Y \\mid u}\\!\\left[ \\;-\\nabla_{u}^{2} \\ln p(Y \\mid u) \\;\\right],\n$$\n推导此模型的 Fisher 信息矩阵 $I(u)$。然后，使用上面提供的矩阵 $A$ 和 $\\Gamma$ 显式计算 $I(u)$，并用它来刻画 $u$ 的信息贫乏方向，即 $I(u)$ 的零空间中的方向。最后，确定这个零空间的维度。\n\n最终答案应为一个精确整数（不要四舍五入）。最终答案中不要包含任何单位。", "solution": "用户需要对给定问题的详细解答。\n\n### 第 1 步：问题验证\n\n首先，我将验证问题陈述。\n\n#### **提取已知条件**\n\n问题提供了以下信息：\n1.  一个线性高斯数据模型：$Y \\sim \\mathcal{N}(A u, \\Gamma)$，其中 $Y \\in \\mathbb{R}^{3}$ 是观测向量，$u \\in \\mathbb{R}^{4}$ 是未知参数向量。\n2.  前向算子矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$：\n    $$\n    A \\;=\\; \\begin{pmatrix}\n    1  0  1  0 \\\\\n    0  1  0  1 \\\\\n    1  1  1  1\n    \\end{pmatrix}\n    $$\n3.  噪声协方差矩阵 $\\Gamma \\in \\mathbb{R}^{3 \\times 3}$：\n    $$\n    \\Gamma \\;=\\; \\begin{pmatrix}\n    2  0  0 \\\\\n    0  3  1 \\\\\n    0  1  2\n    \\end{pmatrix}\n    $$\n4.  参数 $u$ 在概率密度族 $p(y \\mid u)$ 中的 Fisher 信息矩阵（FIM）的定义：\n    $$\n    I(u) \\;=\\; \\mathbb{E}_{Y \\mid u}\\!\\left[ \\;-\\nabla_{u}^{2} \\ln p(Y \\mid u) \\;\\right]\n    $$\n\n#### **使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题设置在贝叶斯逆问题和统计推断的标准框架内。线性高斯模型是一个基础且广泛使用的模型。Fisher 信息矩阵的定义是正确的。该问题在科学上和数学上都是合理的。\n2.  **适定性与一致性**：为使模型有效，协方差矩阵 $\\Gamma$ 必须是对称且半正定的。\n    *   对称性：给定的矩阵 $\\Gamma$ 是对称的，因为 $\\Gamma_{ij} = \\Gamma_{ji}$。\n    *   正定性：我们可以检查 $\\Gamma$ 的特征值。\n        $$\n        \\det(\\Gamma - \\lambda I) \\;=\\; \\det \\begin{pmatrix} 2-\\lambda  0  0 \\\\ 0  3-\\lambda  1 \\\\ 0  1  2-\\lambda \\end{pmatrix} \\;=\\; (2-\\lambda) \\left[ (3-\\lambda)(2-\\lambda) - 1 \\right] \\;=\\; (2-\\lambda)(\\lambda^2 - 5\\lambda + 5) \\;=\\; 0\n        $$\n        一个特征值是 $\\lambda_1 = 2$。另外两个是 $\\lambda^2 - 5\\lambda + 5 = 0$ 的根，即 $\\lambda_{2,3} = \\frac{5 \\pm \\sqrt{25 - 20}}{2} = \\frac{5 \\pm \\sqrt{5}}{2}$。所有三个特征值 $2$、$\\frac{5 - \\sqrt{5}}{2}$ 和 $\\frac{5 + \\sqrt{5}}{2}$ 都是正的。因此，$\\Gamma$ 是正定的，这是一个更强的条件，证实了它是一个有效的协方差矩阵。问题是自洽且内部一致的。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n问题是有效的。\n\n### 第 2 步：求解\n\n#### **Fisher 信息矩阵的推导**\n\n我们从多元正态分布的概率密度函数（PDF）开始。给定 $Y \\sim \\mathcal{N}(Au, \\Gamma)$，其 PDF 为：\n$$\np(y \\mid u) = \\frac{1}{\\sqrt{(2\\pi)^k \\det(\\Gamma)}} \\exp\\left(-\\frac{1}{2} (y - Au)^T \\Gamma^{-1} (y - Au)\\right)\n$$\n其中 $k=3$ 是 $Y$ 的维度。\n\n对数似然函数 $\\mathcal{L}(u) = \\ln p(y \\mid u)$ 是：\n$$\n\\mathcal{L}(u) = -\\frac{k}{2} \\ln(2\\pi) - \\frac{1}{2} \\ln(\\det(\\Gamma)) - \\frac{1}{2} (y - Au)^T \\Gamma^{-1} (y - Au)\n$$\n为了求 FIM，我们需要 $\\mathcal{L}(u)$ 关于 $u$ 的 Hessian 矩阵。首先，我们计算梯度 $\\nabla_u \\mathcal{L}(u)$。不依赖于 $u$ 的项在求导后消失。\n$$\n\\nabla_u \\mathcal{L}(u) = \\nabla_u \\left( -\\frac{1}{2} (y - Au)^T \\Gamma^{-1} (y - Au) \\right)\n$$\n让我们展开二次型：\n$$\n(y - Au)^T \\Gamma^{-1} (y - Au) = y^T \\Gamma^{-1} y - y^T \\Gamma^{-1} Au - u^T A^T \\Gamma^{-1} y + u^T A^T \\Gamma^{-1} Au\n$$\n由于 $\\Gamma$ 是对称的，$\\Gamma^{-1}$ 也是对称的。因此，$y^T \\Gamma^{-1} Au = (u^T A^T \\Gamma^{-1} y)^T = u^T A^T \\Gamma^{-1} y$。二次型变为：\n$$\ny^T \\Gamma^{-1} y - 2 u^T A^T \\Gamma^{-1} y + u^T (A^T \\Gamma^{-1} A) u\n$$\n关于 $u$ 的梯度是：\n$$\n\\nabla_u \\left( y^T \\Gamma^{-1} y - 2 u^T A^T \\Gamma^{-1} y + u^T (A^T \\Gamma^{-1} A) u \\right) = -2 A^T \\Gamma^{-1} y + 2 (A^T \\Gamma^{-1} A) u = 2 A^T \\Gamma^{-1} (Au - y)\n$$\n所以，对数似然函数的梯度是：\n$$\n\\nabla_u \\mathcal{L}(u) = -\\frac{1}{2} \\left[ 2 A^T \\Gamma^{-1} (Au - y) \\right] = A^T \\Gamma^{-1} (y - Au)\n$$\n接下来，我们通过对梯度关于 $u^T$ 求导来计算 Hessian 矩阵 $\\nabla_u^2 \\mathcal{L}(u)$：\n$$\n\\nabla_u^2 \\mathcal{L}(u) = \\frac{\\partial}{\\partial u^T} \\left( A^T \\Gamma^{-1} y - A^T \\Gamma^{-1} A u \\right)\n$$\n项 $A^T \\Gamma^{-1} y$ 相对于 $u$ 是常数。线性项 $- (A^T \\Gamma^{-1} A) u$ 的导数是 $-A^T \\Gamma^{-1} A$。\n$$\n\\nabla_u^2 \\mathcal L(u) = -A^T\\Gamma^{-1}A\n$$\nHessian 矩阵既不依赖于参数 $u$ 也不依赖于数据 $y$。现在我们应用 FIM 的定义：\n$$\nI(u) = \\mathbb{E}_{Y \\mid u} \\left[ -\\nabla_{u}^{2} \\ln p(Y \\mid u) \\right] = \\mathbb{E}_{Y \\mid u} \\left[ -(-A^T\\Gamma^{-1}A) \\right] = \\mathbb{E}_{Y \\mid u} \\left[ A^T\\Gamma^{-1}A \\right]\n$$\n由于表达式 $A^T\\Gamma^{-1}A$ 是确定性的，不依赖于随机变量 $Y$，所以期望就是表达式本身。\n$$\nI(u) = A^T\\Gamma^{-1}A\n$$\nFIM 是常数，不依赖于 $u$，所以我们将其表示为 $I$。\n\n#### **FIM 的显式计算**\n\n我们需要计算 $I = A^T\\Gamma^{-1}A$。首先，我们求 $\\Gamma$ 的逆矩阵。\n$$\n\\Gamma = \\begin{pmatrix} 2  0  0 \\\\ 0  3  1 \\\\ 0  1  2 \\end{pmatrix}\n$$\n行列式为 $\\det(\\Gamma) = 2(3 \\cdot 2 - 1 \\cdot 1) = 2(5) = 10$。\n逆矩阵为 $\\Gamma^{-1} = \\frac{1}{\\det(\\Gamma)} \\text{adj}(\\Gamma)$。伴随矩阵是代数余子式矩阵的转置。\n代数余子式矩阵 $C$ 是：\n$$\nC = \\begin{pmatrix}\n\\det\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}  -\\det\\begin{pmatrix} 0  1 \\\\ 0  2 \\end{pmatrix}  \\det\\begin{pmatrix} 0  3 \\\\ 0  1 \\end{pmatrix} \\\\\n-\\det\\begin{pmatrix} 0  0 \\\\ 1  2 \\end{pmatrix}  \\det\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}  -\\det\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\\\\n\\det\\begin{pmatrix} 0  0 \\\\ 3  1 \\end{pmatrix}  -\\det\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}  \\det\\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}\n\\end{pmatrix} = \\begin{pmatrix} 5  0  0 \\\\ 0  4  -2 \\\\ 0  -2  6 \\end{pmatrix}\n$$\n由于 $C$ 是对称的，$\\text{adj}(\\Gamma) = C^T = C$。\n$$\n\\Gamma^{-1} = \\frac{1}{10} \\begin{pmatrix} 5  0  0 \\\\ 0  4  -2 \\\\ 0  -2  6 \\end{pmatrix} = \\begin{pmatrix} 1/2  0  0 \\\\ 0  2/5  -1/5 \\\\ 0  -1/5  3/5 \\end{pmatrix}\n$$\n现在我们计算乘积 $I = A^T \\Gamma^{-1} A$：\n$$\nA^T = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  0  1 \\\\ 0  1  1 \\end{pmatrix}\n$$\n首先，我们计算 $\\Gamma^{-1} A$：\n$$\n\\Gamma^{-1} A = \\begin{pmatrix} 1/2  0  0 \\\\ 0  2/5  -1/5 \\\\ 0  -1/5  3/5 \\end{pmatrix} \\begin{pmatrix} 1  0  1  0 \\\\ 0  1  0  1 \\\\ 1  1  1  1 \\end{pmatrix} = \\begin{pmatrix} 1/2  0  1/2  0 \\\\ -1/5  1/5  -1/5  1/5 \\\\ 3/5  2/5  3/5  2/5 \\end{pmatrix}\n$$\n然后，乘以 $A^T$：\n$$\nI = A^T(\\Gamma^{-1}A) = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1/2  0  1/2  0 \\\\ -1/5  1/5  -1/5  1/5 \\\\ 3/5  2/5  3/5  2/5 \\end{pmatrix}\n$$\n$$\nI = \\begin{pmatrix}\n\\frac{1}{2}+\\frac{3}{5}  \\frac{2}{5}  \\frac{1}{2}+\\frac{3}{5}  \\frac{2}{5} \\\\\n-\\frac{1}{5}+\\frac{3}{5}  \\frac{1}{5}+\\frac{2}{5}  -\\frac{1}{5}+\\frac{3}{5}  \\frac{1}{5}+\\frac{2}{5} \\\\\n\\frac{1}{2}+\\frac{3}{5}  \\frac{2}{5}  \\frac{1}{2}+\\frac{3}{5}  \\frac{2}{5} \\\\\n-\\frac{1}{5}+\\frac{3}{5}  \\frac{1}{5}+\\frac{2}{5}  -\\frac{1}{5}+\\frac{3}{5}  \\frac{1}{5}+\\frac{2}{5}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{11}{10}  \\frac{2}{5}  \\frac{11}{10}  \\frac{2}{5} \\\\\n\\frac{2}{5}  \\frac{3}{5}  \\frac{2}{5}  \\frac{3}{5} \\\\\n\\frac{11}{10}  \\frac{2}{5}  \\frac{11}{10}  \\frac{2}{5} \\\\\n\\frac{2}{5}  \\frac{3}{5}  \\frac{2}{5}  \\frac{3}{5}\n\\end{pmatrix}\n$$\n\n#### **零空间分析**\n\n$u$ 的信息贫乏方向对应于 Fisher 信息矩阵的零空间 $\\text{Null}(I)$。这个空间的维度是它的零化度。根据秩-零化度定理，$\\text{dim}(\\text{Null}(I)) = n - \\text{rank}(I)$，其中 $n=4$ 是 $u$ 的维度。我们来求 $I$ 的秩。\n$$\nI = \\frac{1}{10} \\begin{pmatrix} 11  4  11  4 \\\\ 4  6  4  6 \\\\ 11  4  11  4 \\\\ 4  6  4  6 \\end{pmatrix}\n$$\n通过观察可以看出，第 1 行与第 3 行相同，第 2 行与第 4 行相同。这意味着秩最多为 2。前两行 $[11, 4, 11, 4]$ 和 $[4, 6, 4, 6]$ 互相不是标量倍数。因此，它们是线性无关的。$I$ 的秩为 2。\n零空间的维度是：\n$$\n\\text{dim}(\\text{Null}(I)) = 4 - \\text{rank}(I) = 4 - 2 = 2\n$$\n作为验证，由于 $\\Gamma^{-1}$ 是正定的，$I = A^T \\Gamma^{-1} A$ 的零空间与 $A$ 的零空间相同。我们可以通过行化简求出 $A$ 的秩。\n$$\nA = \\begin{pmatrix} 1  0  1  0 \\\\ 0  1  0  1 \\\\ 1  1  1  1 \\end{pmatrix}\n$$\n第三行是前两行的和 ($R_3 = R_1 + R_2$)。因此，这些行是线性相关的。前两行是线性无关的。$A$ 的秩为 2。\n根据秩-零化度定理对于 $A: \\mathbb{R}^4 \\to \\mathbb{R}^3$：\n$$\n\\text{dim}(\\text{Null}(A)) = (\\text{列数}) - \\text{rank}(A) = 4 - 2 = 2\n$$\n这证实了我们的结果。零空间中的向量满足 $v_1+v_3=0$ 和 $v_2+v_4=0$。这个空间由基向量 $(1, 0, -1, 0)^T$ 和 $(0, 1, 0, -1)^T$ 张成。这些是参数空间 $u$ 中数据 $Y$ 无法提供任何信息的方向。这个信息贫乏方向空间的维度是 2。", "answer": "$$\n\\boxed{2}\n$$", "id": "3414516"}, {"introduction": "我们的实践之旅最终将从参数推断转向预测的实际任务。这项练习突出了一个关键区别：估计系统的真实状态与预测未来带有噪声的观测值之间的差异，这常常是混淆的根源。通过编程与分析，您将把总预测不确定性分解为其来源——参数不确定性、模型差异和观测噪声——从而全面了解我们预测能力的极限 [@problem_id:3414519]。", "problem": "本题要求您形式化、分析并实现一个带有显式模型误差的标量线性高斯数据同化问题，重点关注可信区间和预测区间之间的区别，以及将方差分解为参数、差异和观测三个分量。\n\n给定一个代表未知系统状态的标量参数 $ \\theta $。您已知：\n- 一个先验分布 $ \\theta \\sim \\mathcal{N}(\\mu_0,\\tau_0^2) $。\n- 一个正向模型 $ m = a\\,\\theta + b $，其中系数 $ a $ 和 $ b $ 已知。\n- 一个加性模型差异随机变量 $ \\delta \\sim \\mathcal{N}(0,\\sigma_\\delta^2) $。\n- 一个加性观测噪声随机变量 $ \\epsilon \\sim \\mathcal{N}(0,\\sigma_\\epsilon^2) $。\n- 一个通过观测方程与 $ \\theta $ 相关的单一观测数据点 $ z $\n  $$ z = a\\,\\theta + b + \\delta + \\epsilon。$$\n假设 $ \\theta $、$ \\delta $ 和 $ \\epsilon $ 相互独立。\n\n您的任务是：\n1) 仅从正态分布的核心定义、贝叶斯法则、全期望定律和全方差定律出发，推导给定 $ z $ 时 $ \\theta $ 的后验分布。然后推导 $ m \\mid z $ 的条件分布以及未来重复观测值 $ \\tilde z \\mid z $ 的条件分布，其中 $ \\tilde z = m + \\delta' + \\epsilon' $，且 $ \\delta' \\sim \\mathcal{N}(0,\\sigma_\\delta^2) $ 和 $ \\epsilon' \\sim \\mathcal{N}(0,\\sigma_\\epsilon^2) $ 与其他所有变量独立。\n2) 定义 $ m \\mid z $ 在水平 $ 0.95 $ 上的中心可信区间，以及 $ \\tilde z \\mid z $ 在水平 $ 0.95 $ 上的中心预测区间，两者均基于阶数为 $ 1 - \\alpha/2 $（其中 $ \\alpha = 0.05 $）的正态分位数。\n3) 使用全方差定律，将总预测方差分解为可归因于后验参数不确定性、模型差异和观测噪声的三个非负分量。即，表示为\n   $$ \\operatorname{Var}(\\tilde z \\mid z) = v_{\\mathrm{par}} + v_{\\mathrm{disc}} + v_{\\mathrm{obs}}, $$\n   并用 $ a $、$ b $、$ \\mu_0 $、$ \\tau_0 $、$ \\sigma_\\delta $、$ \\sigma_\\epsilon $ 和 $ z $ 明确地表示 $ v_{\\mathrm{par}} $、$ v_{\\mathrm{disc}} $ 和 $ v_{\\mathrm{obs}} $。\n\n实现要求：\n- 实现一个程序，对于下面测试套件中的每一组参数，计算：\n  - $ m \\mid z $ 的 $ 0.95 $ 可信区间的下端点和上端点，\n  - $ \\tilde z \\mid z $ 的 $ 0.95 $ 预测区间的下端点和上端点，\n  - 来自第 $ 3 $ 项方差分解的三元组 $ (v_{\\mathrm{par}}, v_{\\mathrm{disc}}, v_{\\mathrm{obs}}) $。\n- 为了数值稳定性和跨语言可复现性，请使用数值稳定的程序计算标准正态分位数。将最终输出中的每个浮点数四舍五入到 $ 6 $ 位小数。\n\n测试套件（每个元组为 $ (a,b,\\mu_0,\\tau_0,\\sigma_\\delta,\\sigma_\\epsilon,z) $）：\n- 情况 A（一般情况）：$ (2.0,\\,1.0,\\,0.0,\\,1.5,\\,0.7,\\,0.5,\\,3.2) $。\n- 情况 B（无模型差异）：$ (1.2,\\,-0.5,\\,0.8,\\,0.7,\\,0.0,\\,0.3,\\,0.4) $。\n- 情况 C（零灵敏度）：$ (0.0,\\,2.0,\\,-1.0,\\,1.0,\\,0.4,\\,0.4,\\,2.5) $。\n- 情况 D（弱信息先验）：$ (1.5,\\,0.2,\\,0.0,\\,10000.0,\\,0.6,\\,0.4,\\,1.7) $。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个结果列表，每个测试用例一个结果，并保持 A、B、C、D 的顺序。\n- 每个用例的结果必须是一个包含 $ 7 $ 个浮点数的列表，顺序固定为\n  $ [\\text{CI}_{\\mathrm{low}}, \\text{CI}_{\\mathrm{high}}, \\text{PI}_{\\mathrm{low}}, \\text{PI}_{\\mathrm{high}}, v_{\\mathrm{par}}, v_{\\mathrm{disc}}, v_{\\mathrm{obs}}] $，\n  所有数值都四舍五入到 $ 6 $ 位小数。\n- 整体输出必须是没有任何空格的单行，例如：\n  $$ [ [\\dots], [\\dots], [\\dots], [\\dots] ] $$\n  但没有任何空格，即使用确切的格式\n  $$ [[x_{1,1},x_{1,2},\\dots,x_{1,7}],[x_{2,1},\\dots,x_{2,7}],[x_{3,1},\\dots,x_{3,7}],[x_{4,1},\\dots,x_{4,7}]]。$$\n\n您的程序不得读取任何输入，并且必须仅使用上面提供的参数值。它必须用 Python 实现，并且只使用指定的库。最终的打印必须以指定格式精确地生成一行。", "solution": "该问题表述清晰，科学依据充分，内容自成体系，提出了一个线性高斯模型中标准的贝叶斯数据同化问题。我们着手进行推导和求解。\n\n### 1. 分布的推导\n\n**1.1. $ \\theta \\mid z $ 的后验分布**\n\n问题定义了参数 $ \\theta $ 的先验分布和观测模型。\n先验分布为 $ \\theta \\sim \\mathcal{N}(\\mu_0, \\tau_0^2) $。其概率密度函数 (PDF) 为：\n$$ p(\\theta) \\propto \\exp\\left(-\\frac{1}{2\\tau_0^2}(\\theta - \\mu_0)^2\\right) $$\n\n观测方程为 $ z = a\\theta + b + \\delta + \\epsilon $。其中 $ \\delta \\sim \\mathcal{N}(0, \\sigma_\\delta^2) $ 和 $ \\epsilon \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2) $ 是独立的噪声源。它们的和，我们称之为 $ \\eta = \\delta + \\epsilon $，也是一个正态随机变量。根据独立正态变量的性质：\n$ E[\\eta] = E[\\delta] + E[\\epsilon] = 0 + 0 = 0 $\n$ \\operatorname{Var}(\\eta) = \\operatorname{Var}(\\delta) + \\operatorname{Var}(\\epsilon) = \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $\n令 $ \\sigma_{\\text{tot}}^2 = \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $。因此，$ \\eta \\sim \\mathcal{N}(0, \\sigma_{\\text{tot}}^2) $。\n\n观测方程可以改写为 $ z - (a\\theta + b) = \\eta $。这定义了给定参数 $ \\theta $ 时观测值 $ z $ 的似然，即 $ z \\mid \\theta \\sim \\mathcal{N}(a\\theta + b, \\sigma_{\\text{tot}}^2) $。似然函数为：\n$$ p(z \\mid \\theta) \\propto \\exp\\left(-\\frac{1}{2\\sigma_{\\text{tot}}^2}(z - (a\\theta + b))^2\\right) $$\n\n根据贝叶斯法则，给定 $ z $ 时 $ \\theta $ 的后验分布与似然和先验的乘积成正比：\n$$ p(\\theta \\mid z) \\propto p(z \\mid \\theta) p(\\theta) $$\n$$ p(\\theta \\mid z) \\propto \\exp\\left(-\\frac{1}{2\\sigma_{\\text{tot}}^2}(z - a\\theta - b)^2\\right) \\exp\\left(-\\frac{1}{2\\tau_0^2}(\\theta - \\mu_0)^2\\right) $$\n后验分布与一个关于 $ \\theta $ 的二次项和的指数成正比。这意味着后验分布也是一个正态分布，假设为 $ \\theta \\mid z \\sim \\mathcal{N}(\\mu_1, \\tau_1^2) $。我们通过分析指数来确定其参数，重点关注涉及 $ \\theta $ 的项：\n$$ -\\frac{1}{2} \\left[ \\frac{(a\\theta - (z-b))^2}{\\sigma_{\\text{tot}}^2} + \\frac{(\\theta - \\mu_0)^2}{\\tau_0^2} \\right] $$\n$$ = -\\frac{1}{2} \\left[ \\frac{a^2\\theta^2 - 2a\\theta(z-b)}{\\sigma_{\\text{tot}}^2} + \\frac{\\theta^2 - 2\\theta\\mu_0}{\\tau_0^2} + \\text{const} \\right] $$\n$$ = -\\frac{1}{2} \\left[ \\left(\\frac{a^2}{\\sigma_{\\text{tot}}^2} + \\frac{1}{\\tau_0^2}\\right)\\theta^2 - 2\\left(\\frac{a(z-b)}{\\sigma_{\\text{tot}}^2} + \\frac{\\mu_0}{\\tau_0^2}\\right)\\theta + \\text{const} \\right] $$\n对于一个正态分布 $ \\mathcal{N}(\\mu_1, \\tau_1^2) $，其指数为 $ -\\frac{(\\theta - \\mu_1)^2}{2\\tau_1^2} = -\\frac{1}{2} \\left( \\frac{\\theta^2}{\\tau_1^2} - \\frac{2\\mu_1\\theta}{\\tau_1^2} + \\text{const} \\right) $。\n通过比较 $ \\theta^2 $ 和 $ \\theta $ 的系数，我们得到后验精度 ($ 1/\\tau_1^2 $) 和均值 ($ \\mu_1 $)：\n$$ \\frac{1}{\\tau_1^2} = \\frac{1}{\\tau_0^2} + \\frac{a^2}{\\sigma_{\\text{tot}}^2} \\implies \\tau_1^2 = \\left(\\frac{1}{\\tau_0^2} + \\frac{a^2}{\\sigma_{\\text{tot}}^2}\\right)^{-1} $$\n$$ \\frac{\\mu_1}{\\tau_1^2} = \\frac{\\mu_0}{\\tau_0^2} + \\frac{a(z-b)}{\\sigma_{\\text{tot}}^2} \\implies \\mu_1 = \\tau_1^2 \\left(\\frac{\\mu_0}{\\tau_0^2} + \\frac{a(z-b)}{\\sigma_{\\text{tot}}^2}\\right) $$\n这些是后验分布 $ \\theta \\mid z \\sim \\mathcal{N}(\\mu_1, \\tau_1^2) $ 的参数。\n\n**1.2. $ m \\mid z $ 的条件分布**\n\n正向模型是 $ m = a\\theta + b $。由于 $ m $ 是 $ \\theta $ 的线性函数，其条件分布 $ m \\mid z $ 也是正态分布。我们使用期望和方差的性质来找到其均值和方差：\n$ E[m \\mid z] = E[a\\theta + b \\mid z] = a E[\\theta \\mid z] + b = a\\mu_1 + b $。\n$ \\operatorname{Var}(m \\mid z) = \\operatorname{Var}(a\\theta + b \\mid z) = a^2 \\operatorname{Var}(\\theta \\mid z) = a^2 \\tau_1^2 $。\n因此，$ m \\mid z \\sim \\mathcal{N}(a\\mu_1 + b, a^2\\tau_1^2) $。\n\n**1.3. $ \\tilde z \\mid z $ 的条件分布**\n\n一个未来的重复观测值由 $ \\tilde z = m + \\delta' + \\epsilon' = a\\theta + b + \\delta' + \\epsilon' $ 给出，其中 $ \\delta' \\sim \\mathcal{N}(0, \\sigma_\\delta^2) $ 和 $ \\epsilon' \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2) $ 与所有其他变量独立。给定 $ z $ 时 $ \\tilde z $ 的分布是一个预测分布。给定 $ z $，变量 $ \\theta $（其分布为 $ p(\\theta|z) $）、$ \\delta' $ 和 $ \\epsilon' $ 都是独立的。$ \\tilde z \\mid z $ 是正态随机变量的线性组合，因此它也是正态的。我们使用全期望定律和全方差定律来找到它的参数。\n\n均值为：\n$ E[\\tilde z \\mid z] = E[a\\theta + b + \\delta' + \\epsilon' \\mid z] = a E[\\theta \\mid z] + b + E[\\delta' \\mid z] + E[\\epsilon' \\mid z] $。\n由于 $ \\delta' $ 和 $ \\epsilon' $ 与 $ z $ 独立，所以 $ E[\\delta' \\mid z] = E[\\delta'] = 0 $ 且 $ E[\\epsilon' \\mid z] = E[\\epsilon'] = 0 $。\n$ E[\\tilde z \\mid z] = a\\mu_1 + b $。\n\n方差为，根据 $ (\\theta \\mid z) $、$ \\delta' $ 和 $ \\epsilon' $ 的独立性：\n$ \\operatorname{Var}(\\tilde z \\mid z) = \\operatorname{Var}(a\\theta + b + \\delta' + \\epsilon' \\mid z) = \\operatorname{Var}(a\\theta \\mid z) + \\operatorname{Var}(\\delta' \\mid z) + \\operatorname{Var}(\\epsilon' \\mid z) $。\n$ \\operatorname{Var}(\\tilde z \\mid z) = a^2 \\operatorname{Var}(\\theta \\mid z) + \\operatorname{Var}(\\delta') + \\operatorname{Var}(\\epsilon') = a^2\\tau_1^2 + \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $。\n因此，$ \\tilde z \\mid z \\sim \\mathcal{N}(a\\mu_1 + b, a^2\\tau_1^2 + \\sigma_\\delta^2 + \\sigma_\\epsilon^2) $。\n\n### 2. 可信区间和预测区间\n\n对于一个正态分布 $ \\mathcal{N}(\\mu, \\sigma^2) $，水平为 $ 1-\\alpha $ 的中心区间由 $ [\\mu - q \\sigma, \\mu + q \\sigma] $ 给出，其中 $ q = \\Phi^{-1}(1 - \\alpha/2) $ 是标准正态分布 $ \\mathcal{N}(0, 1) $ 的 $ (1 - \\alpha/2) $-分位数。对于本问题，$ \\alpha = 0.05 $，所以我们使用分位数 $ q_{0.975} = \\Phi^{-1}(0.975) \\approx 1.959964 $。\n\n**可信区间**是后验概率分布域中的一个区间。模型输出 $ m \\mid z $ 的 $ 95\\% $ 中心可信区间基于其后验分布 $ \\mathcal{N}(a\\mu_1 + b, a^2\\tau_1^2) $。\n其端点为：\n$ \\text{CI}_{\\text{low/high}} = (a\\mu_1 + b) \\mp q_{0.975} \\sqrt{a^2\\tau_1^2} = (a\\mu_1 + b) \\mp q_{0.975} |a|\\tau_1 $。\n\n**预测区间**是未来观测值将以特定概率落入的一个区间。未来观测值 $ \\tilde z \\mid z $ 的 $ 95\\% $ 中心预测区间基于其预测分布 $ \\mathcal{N}(a\\mu_1 + b, a^2\\tau_1^2 + \\sigma_\\delta^2 + \\sigma_\\epsilon^2) $。\n其端点为：\n$ \\text{PI}_{\\text{low/high}} = (a\\mu_1 + b) \\mp q_{0.975} \\sqrt{a^2\\tau_1^2 + \\sigma_\\delta^2 + \\sigma_\\epsilon^2} $。\n预测区间总是比可信区间更宽（当 $ \\sigma_\\delta^2 + \\sigma_\\epsilon^2  0 $ 时），因为它考虑了未来测量将受到的来自模型差异和观测噪声的额外不确定性来源。\n\n### 3. 方差分解\n\n问题要求使用全方差定律对总预测方差 $ \\operatorname{Var}(\\tilde z \\mid z) $ 进行分解：$ \\operatorname{Var}(X) = E[\\operatorname{Var}(X \\mid Y)] + \\operatorname{Var}(E[X \\mid Y]) $。在这里，$ X = \\tilde z \\mid z $，我们条件化的变量是参数 $ \\theta $（其不确定性由 $ p(\\theta \\mid z) $ 描述）。\n$ \\operatorname{Var}(\\tilde z \\mid z) = E[\\operatorname{Var}(\\tilde z \\mid \\theta, z) \\mid z] + \\operatorname{Var}(E[\\tilde z \\mid \\theta, z] \\mid z) $。\n\n首先，我们计算以特定 $ \\theta $ 值为条件的内部项。\n$ E[\\tilde z \\mid \\theta, z] = E[a\\theta + b + \\delta' + \\epsilon' \\mid \\theta, z] = a\\theta + b $，因为 $ \\theta $ 是固定的，且 $ \\delta', \\epsilon' $ 是零均值且与 $ z $ 独立。\n$ \\operatorname{Var}(\\tilde z \\mid \\theta, z) = \\operatorname{Var}(a\\theta + b + \\delta' + \\epsilon' \\mid \\theta, z) = \\operatorname{Var}(\\delta' + \\epsilon') = \\operatorname{Var}(\\delta') + \\operatorname{Var}(\\epsilon') = \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $，因为 $ \\theta $ 是固定的，且 $ \\delta', \\epsilon' $ 是独立的。\n\n现在，我们将这些代回全方差定律的公式中：\n第一项：$ E[\\operatorname{Var}(\\tilde z \\mid \\theta, z) \\mid z] = E[\\sigma_\\delta^2 + \\sigma_\\epsilon^2 \\mid z] = \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $，因为方差是常数。\n第二项：$ \\operatorname{Var}(E[\\tilde z \\mid \\theta, z] \\mid z) = \\operatorname{Var}(a\\theta + b \\mid z) = a^2 \\operatorname{Var}(\\theta \\mid z) = a^2\\tau_1^2 $。\n\n将它们结合起来，我们得到总预测方差：\n$ \\operatorname{Var}(\\tilde z \\mid z) = a^2\\tau_1^2 + \\sigma_\\delta^2 + \\sigma_\\epsilon^2 $。\n这个表达式自然地分解为三个非负分量：\n1.  **参数方差 ($ v_{\\mathrm{par}} $):** $ v_{\\mathrm{par}} = a^2\\tau_1^2 $。该分量代表了由于参数 $ \\theta $ 的后验不确定性而导致模型预测的不确定性。\n2.  **差异方差 ($ v_{\\mathrm{disc}} $):** $ v_{\\mathrm{disc}} = \\sigma_\\delta^2 $。该分量是由于模型与真实系统之间固有的不匹配（模型误差）所贡献的不确定性。\n3.  **观测方差 ($ v_{\\mathrm{obs}} $):** $ v_{\\mathrm{obs}} = \\sigma_\\epsilon^2 $。该分量代表了未来观测中由测量噪声引起的不确定性。\n\n分解结果为 $ \\operatorname{Var}(\\tilde z \\mid z) = v_{\\mathrm{par}} + v_{\\mathrm{disc}} + v_{\\mathrm{obs}} $。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the scalar linear-Gaussian data assimilation problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, b, mu0, tau0, sigma_delta, sigma_epsilon, z).\n    test_cases = [\n        (2.0, 1.0, 0.0, 1.5, 0.7, 0.5, 3.2),      # Case A (general)\n        (1.2, -0.5, 0.8, 0.7, 0.0, 0.3, 0.4),      # Case B (no model discrepancy)\n        (0.0, 2.0, -1.0, 1.0, 0.4, 0.4, 2.5),      # Case C (zero sensitivity)\n        (1.5, 0.2, 0.0, 10000.0, 0.6, 0.4, 1.7),  # Case D (weakly informative prior)\n    ]\n\n    results = []\n    # Quantile for 95% central interval\n    q_975 = norm.ppf(0.975)\n\n    for case in test_cases:\n        a, b, mu0, tau0, sigma_delta, sigma_epsilon, z = case\n\n        # 1. Calculate total noise variance from model discrepancy and observation error\n        sigma_tot_sq = sigma_delta**2 + sigma_epsilon**2\n\n        # 2. Compute posterior distribution of theta: theta|z ~ N(mu1, tau1_sq).\n        # We work with precisions for numerical stability, especially for large tau0.\n        tau0_sq = tau0**2\n        \n        # In a case with zero total noise, the posterior would be a point mass.\n        # This is not in the test suite, but a robust implementation would check for it.\n        # The logic here is stable for all test cases provided.\n        prec0 = 1.0 / tau0_sq\n        \n        # If sigma_tot_sq is zero, the likelihood precision is infinite. We handle a=0 separately.\n        if a == 0.0:\n            # If a=0, data z gives no info on theta, so posterior = prior\n            mu1 = mu0\n            tau1_sq = tau0_sq\n        else:\n             # This branch is safe if sigma_tot_sq is not zero\n            prec_like = (a**2) / sigma_tot_sq\n            prec1 = prec0 + prec_like\n            tau1_sq = 1.0 / prec1\n            # Posterior mean is the precision-weighted average of prior and data\n            mu1 = tau1_sq * (prec0 * mu0 + a * (z - b) / sigma_tot_sq)\n\n        # 3. Compute posterior distribution of model output m = a*theta + b\n        # m|z ~ N(mu_m, var_m)\n        mu_m = a * mu1 + b\n        var_m = a**2 * tau1_sq\n        std_m = np.sqrt(var_m)\n\n        # 4. Compute 95% Credible Interval (CI) for m|z\n        ci_half_width = q_975 * std_m\n        ci_low = mu_m - ci_half_width\n        ci_high = mu_m + ci_half_width\n\n        # 5. Compute predictive distribution of a future observation z_tilde\n        # z_tilde|z ~ N(mu_m, var_z_tilde)\n        var_z_tilde = var_m + sigma_delta**2 + sigma_epsilon**2\n        std_z_tilde = np.sqrt(var_z_tilde)\n        \n        # 6. Compute 95% Prediction Interval (PI) for z_tilde|z\n        pi_half_width = q_975 * std_z_tilde\n        pi_low = mu_m - pi_half_width\n        pi_high = mu_m + pi_half_width\n\n        # 7. Compute the variance decomposition\n        v_par = var_m\n        v_disc = sigma_delta**2\n        v_obs = sigma_epsilon**2\n        \n        # 8. Store the 7 required floating point numbers for this case\n        case_results = [ci_low, ci_high, pi_low, pi_high, v_par, v_disc, v_obs]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is [[...],[...],...] with no spaces and 6 decimal places.\n    output_str = \"[\" + \",\".join([\n        \"[\" + \",\".join([f'{val:.6f}' for val in res]) + \"]\" \n        for res in results\n    ]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3414519"}]}