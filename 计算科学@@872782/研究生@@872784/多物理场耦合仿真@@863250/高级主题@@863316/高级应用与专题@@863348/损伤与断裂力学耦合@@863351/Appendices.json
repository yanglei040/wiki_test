{"hands_on_practices": [{"introduction": "相场法将断裂视为一个弥散的“损伤”场，而不是一条尖锐的线，从而优雅地避免了传统断裂力学中的奇异性问题。这个练习将带你从第一性原理出发，建立相场模型的基础。通过推导一个简单一维杆的能量平衡方程，你将亲自实践如何利用能量泛函来描述弹性储能和断裂耗散之间的竞争，并最终确定损伤开始萌生的临界条件[@problem_id:3501236]。", "problem": "考虑一根长度为 $L$、均匀横截面积为 $A$ 的一维 ($1$D) 细杆，由杨氏模量为 $E$ 的线性弹性固体制成。该杆在单轴拉伸下进行准静态加载，通过指定末端位移 $u(L)=\\bar{u}$ 并固定 $u(0)=0$ 实现，应变为小应变 $\\varepsilon(x)=u'(x)$。设 $d(x)\\in[0,1]$ 为一个标量损伤（相场）变量，其中 $d=0$ 表示完好状态，$d=1$ 表示完全损伤状态。假设弹性刚度通过标量退化函数 $g(d)=(1-d)^{2}+\\kappa$ 进行标准的相场（PF）退化，其中有一个小的正常数 $\\kappa\\to 0^{+}$ 以在完全损伤极限下保持椭圆性。未损伤的弹性储能密度为 $\\psi_{0}(\\varepsilon)=\\tfrac{1}{2}E\\,\\varepsilon^{2}$。为正则化裂纹表面，使用 Ambrosio–Tortorelli AT$1$ 裂纹表面密度泛函\n$$\n\\gamma(d,d')=\\frac{d}{\\ell}+\\frac{\\ell}{2}\\,(d')^{2},\n$$\n其中 $\\ell0$ 是一个内禀长度参数，且 $d'=\\tfrac{dd}{dx}$。材料韧性（临界能量释放率）为 $G_{c}0$。假设为拉伸主导加载（无需进行拉压分离）以及等温、无惯性条件。\n\n任务 $1$ (能量平衡)：从第一性原理（自由能不平衡/Clausius–Duhem不等式和虚功率原理）出发，写出一个时间间隔内的准静态能量平衡，该平衡应清晰地分离开三个贡献：(i) 储存的弹性势能，(ii) 由 $G_{c}$ 加权的裂纹表面能，以及 (iii) 不可逆损伤耗散。清楚地识别出这三项贡献各自关于 $u$, $d$, $E$, $G_{c}$, $A$, $L$, 和 $\\ell$ 的表达式。\n\n任务 $2$ (均匀拉伸下的损伤萌生)：特化到损伤萌生时的均匀单轴拉伸情况，此时应变在空间上是均匀的，而 $d(x)$ 是无穷小且空间均匀的（因此 $d'\\approx 0$）。利用与能量平衡相关的平稳性（最优性）条件和率无关演化的 Kuhn–Tucker 不可逆约束，推导损伤萌生的临界末端位移 $\\bar{u}_{c}$，结果应为关于 $L$, $E$, $G_{c}$, 和 $\\ell$ 的闭式表达式。将你得到的 $\\bar{u}_{c}$ 的最终结果以仅包含这些参数的符号表达式形式报告；在最终的方框答案中不要包含单位。", "solution": "首先对问题进行验证，以确保其在科学上是成立的、适定的和客观的。\n\n### 步骤1：提取已知条件\n- **几何与材料：** 一根一维 ($1$D) 细杆，长度为 $L$，均匀横截面积为 $A$，杨氏模量为 $E$。\n- **运动学与加载：** 准静态单轴拉伸，小应变 $\\varepsilon(x) = u'(x)$。边界条件为 $u(0)=0$ 和 $u(L)=\\bar{u}$。\n- **损伤模型：**\n  - 损伤变量：$d(x) \\in [0,1]$，$d=0$ 表示完好，$d=1$ 表示完全损伤。\n  - 刚度退化函数：$g(d) = (1-d)^2 + \\kappa$，其中 $\\kappa \\to 0^+$。\n  - 未损伤弹性储能密度：$\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^2$。\n  - 退化弹性储能密度：$\\psi(\\varepsilon, d) = g(d) \\psi_0(\\varepsilon)$。\n- **断裂模型：**\n  - Ambrosio-Tortorelli (AT$1$) 裂纹表面密度泛函：$\\gamma(d, d') = \\frac{d}{\\ell} + \\frac{\\ell}{2} (d')^2$，其中 $d' = \\frac{dd}{dx}$，$\\ell0$ 是内禀长度参数。\n  - 材料韧性（临界能量释放率）：$G_c  0$。\n- **假设：** 拉伸主导加载，等温、无惯性条件。\n- **任务 1：** 推导一个时间间隔内的准静态能量平衡，将其分离为三个贡献：(i) 储存的弹性势能，(ii) 裂纹表面能，(iii) 不可逆损伤耗散。\n- **任务 2：** 对于损伤萌生时的均匀拉伸情况（$d(x) \\approx 0$，$d'(x) \\approx 0$，均匀应变），推导临界末端位移 $\\bar{u}_c$ 关于 $L$, $E$, $G_c$, 和 $\\ell$ 的表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上是成立的，描述了一个用于准静态断裂的标准变分相场模型（一个梯度损伤模型）。其公式基于连续介质力学的既定原理，包括自由能泛函和虚功率原理。所有术语和概念，如杨氏模量、能量释放率和刚度退化，都是标准的。问题是适定的、客观的和自洽的，为获得唯一解提供了所有必要信息。假设陈述清晰，在模型背景下物理上是合理的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题是有效的。有必要给出完整解答。\n\n### 任务1：能量平衡\n\n系统的准静态演化由总势能泛函 $\\Pi$ 控制，该泛函包括储存的弹性势能和与裂纹表面形成相关的能量。对于整个杆，该泛函为：\n$$\n\\Pi[u, d] = \\int_0^L A \\left( \\psi(\\varepsilon, d) + G_c \\gamma(d, d') \\right) dx\n$$\n其中 $A$ 是横截面积。代入给定的 $\\psi$ 和 $\\gamma$ 的形式：\n$$\n\\Pi[u, d] = \\int_0^L A \\left[ \\left( (1-d)^2 + \\kappa \\right) \\frac{1}{2} E \\varepsilon^2 + G_c \\left( \\frac{d}{\\ell} + \\frac{\\ell}{2} (d')^2 \\right) \\right] dx\n$$\n问题是等温且无惯性的。热力学第一定律，即能量平衡，指出外力所做的功 $W_{ext}$ 等于系统储存能量的变化量加上耗散的能量 $W_{diss}$。在一个时间间隔 $[t_1, t_2]$ 内，这可以写为：\n$$\nW_{ext} = \\Delta E_{stored} + W_{diss}\n$$\n在此相场模型的背景下，总势能泛函的变化 $\\Delta\\Pi = \\Pi(t_2)-\\Pi(t_1)$ 包含了可恢复的弹性势能和不可恢复的断裂能的变化。率无关断裂的变分框架被构建为，外力所做的功恰好由该总势能的变化来平衡，其中包含了所有的能量成本。\n$$\nW_{ext} = \\Delta \\Pi = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack}\n$$\n其中 $\\Psi_{el}$ 是储存在物体中的总弹性势能，$\\Psi_{crack}$ 是总的正则化裂纹表面能。\n\n问题要求将能量平衡分为三个贡献。我们可以通过识别第三项，“不可逆损伤耗散” $W_{dissipation}$，然后在这一特定理论框架内展示其值来表达总平衡。在时间间隔 $[t_1, t_2]$ 内的全局能量平衡是：\n$$\n\\int_{t_1}^{t_2} P_{ext}(t) dt = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack} + W_{dissipation}\n$$\n其中 $P_{ext}$ 是外力的功率，$P_{ext} = A \\sigma(L,t) \\dot{\\bar{u}}(t)$。\n\n让我们识别这三个贡献中的每一项：\n\n(i) **储存的弹性势能：** 这是由于弹性变形而储存在材料中的可恢复能量。在时间间隔 $[t_1, t_2]$ 内储存的弹性势能的变化是 $\\Delta \\Psi_{el} = \\Psi_{el}(t_2) - \\Psi_{el}(t_1)$，其中在给定时间 $t$ 的总储存弹性势能为：\n$$\n\\Psi_{el}(t) = \\int_0^L A g(d(x,t)) \\psi_0(\\varepsilon(x,t)) dx = \\int_0^L A \\left( (1-d(x,t))^2 + \\kappa \\right) \\frac{1}{2} E (\\varepsilon(x,t))^2 dx\n$$\n\n(ii) **裂纹表面能：** 这是根据相场模型定义，创建新的（正则化的）裂纹表面所需的能量。在此时间间隔内该能量的变化是 $\\Delta \\Psi_{crack} = \\Psi_{crack}(t_2) - \\Psi_{crack}(t_1)$，其中在时间 $t$ 的总裂纹表面能为：\n$$\n\\Psi_{crack}(t) = \\int_0^L A G_c \\gamma(d(x,t), d'(x,t)) dx = \\int_0^L A G_c \\left( \\frac{d(x,t)}{\\ell} + \\frac{\\ell}{2} (d'(x,t))^2 \\right) dx\n$$\n从物理性质上讲，这一项是耗散能量的一种形式，因为它是不可恢复的。\n\n(iii) **不可逆损伤耗散：** 该项表示裂纹表面能泛函尚未计入的任何耗散。在一般的热力学框架中，这是损伤驱动的热力学力与损伤演化速率的乘积。该耗散的速率为 $\\mathcal{D} = \\int_0^L A \\mathcal{F}_d \\dot{d} dx$。损伤的热力学驱动力 $\\mathcal{F}_d$ 从总势能 $\\Pi$ 导出。损伤的演化由率无关、不可逆过程的 Karush-Kuhn-Tucker (KKT) 条件控制：\n$$\n\\mathcal{F}_d \\le 0, \\quad \\dot{d} \\ge 0, \\quad \\mathcal{F}_d \\dot{d} = 0\n$$\n驱动力是 $\\Pi$ 关于 $d$ 的变分导数的负值：$\\mathcal{F}_d = -\\frac{1}{A} \\frac{\\delta \\Pi}{\\delta d}$。\n$$\n\\frac{\\delta \\Pi}{\\delta d} = A \\left[ \\frac{\\partial \\psi}{\\partial d} + G_c \\frac{\\partial \\gamma}{\\partial d} - G_c \\frac{d}{dx}\\left(\\frac{\\partial \\gamma}{\\partial d'}\\right) \\right] = A \\left[ g'(d)\\psi_0 + G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right) \\right]\n$$\n使用 $g'(d) = -2(1-d)$ 并定义弹性储能释放率 $Y = -g'(d)\\psi_0 = 2(1-d)\\psi_0$：\n$$\n\\frac{\\delta \\Pi}{\\delta d} = A \\left[ -Y + G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right) \\right]\n$$\n所以，驱动力是 $\\mathcal{F}_d = Y - G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right)$。KKT 条件 $\\mathcal{F}_d \\dot{d} = 0$ 意味着这种特定形式的耗散率在所有时间和杆中的所有点上都为零：$\\mathcal{D}(t) = 0$。因此，在任何时间间隔内，来自该源的总耗散也为零。\n$$\nW_{dissipation} = \\int_{t_1}^{t_2} \\mathcal{D}(t) dt = 0\n$$\n这是断裂变分模型的一个基本特征，其中所有耗散都包含在断裂能项中。因此，能量平衡简化为 $W_{ext} = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack}$。\n\n### 任务2：均匀拉伸下的损伤萌生\n\n对于此任务，我们特化到均匀单轴拉伸状态。\n- 应变是均匀的：$\\varepsilon(x) = \\varepsilon_0$。位移场为 $u(x) = \\varepsilon_0 x$。给定 $u(L) = \\bar{u}$，我们有 $\\varepsilon_0 = \\bar{u}/L$。\n- 在损伤萌生时，材料仍处于完好状态，因此 $d(x) = 0$。\n- 我们考虑均匀损伤的萌生，意味着出现的任何无穷小损伤 $d$ 也是空间均匀的，因此 $d(x) = d_0 \\approx 0$ 且 $d'(x) = 0, d''(x) = 0$。\n\n当完好状态 $d=0$ 变得不稳定时，损伤将开始萌生。这发生在总势能 $\\Pi$ 可以通过损伤的无穷小增加而减小时。在数学上，这对应于势能对均匀损伤变量 $d_0$ 的导数变为负值的点。损伤萌生的阈值是该导数首次达到零的时刻。\n\n对于均匀状态 $(u(x)=\\varepsilon_0 x, d(x)=d_0)$，总势能泛函简化为 $\\varepsilon_0$ 和 $d_0$ 的代数函数：\n$$\n\\Pi(\\varepsilon_0, d_0) = \\int_0^L A \\left[ ((1-d_0)^2+\\kappa) \\frac{1}{2} E \\varepsilon_0^2 + G_c \\frac{d_0}{\\ell} \\right] dx\n$$\n$$\n\\Pi(\\varepsilon_0, d_0) = A L \\left[ ((1-d_0)^2+\\kappa) \\frac{1}{2} E \\varepsilon_0^2 + G_c \\frac{d_0}{\\ell} \\right]\n$$\n为了找到损伤萌生的条件，我们计算 $\\Pi$ 关于 $d_0$ 的偏导数，并在完好状态 $d_0=0$ 处对其求值。\n$$\n\\frac{\\partial \\Pi}{\\partial d_0} = A L \\left[ 2(1-d_0)(-1) \\frac{1}{2} E \\varepsilon_0^2 + \\frac{G_c}{\\ell} \\right] = A L \\left[ -(1-d_0) E \\varepsilon_0^2 + \\frac{G_c}{\\ell} \\right]\n$$\n从全局势能导出的损伤演化 KKT 条件是 $\\frac{\\partial \\Pi}{\\partial d_0} \\ge 0$（因为 $\\dot{d}_0 \\ge 0$，而损伤演化方程为 $\\dot{d} = (\\frac{\\partial \\Pi}{\\partial d_0})/\\eta_d$，所以需要能量减少，$\\frac{\\partial \\Pi}{\\partial d_0} \\le 0$）。损伤萌生发生在首次满足此不等式的阈值应变 $\\varepsilon_c$ 处，即等式成立时：\n$$\n\\frac{\\partial \\Pi}{\\partial d_0} \\bigg|_{d_0=0, \\varepsilon_0=\\varepsilon_c} = 0\n$$\n将 $d_0=0$ 和 $\\varepsilon_0=\\varepsilon_c$ 代入导数：\n$$\nA L \\left[ -(1-0) E \\varepsilon_c^2 + \\frac{G_c}{\\ell} \\right] = 0\n$$\n$$\n-E \\varepsilon_c^2 + \\frac{G_c}{\\ell} = 0\n$$\n这给出了均匀损伤萌生的临界应变：\n$$\nE \\varepsilon_c^2 = \\frac{G_c}{\\ell} \\implies \\varepsilon_c = \\sqrt{\\frac{G_c}{E \\ell}}\n$$\n（由于杆处于拉伸状态，我们取正根）。\n与此临界应变相对应的临界末端位移 $\\bar{u}_c$ 可通过运动学关系 $\\varepsilon_c = \\bar{u}_c/L$ 求得。\n$$\n\\bar{u}_c = L \\varepsilon_c = L \\sqrt{\\frac{G_c}{E \\ell}}\n$$\n这是关于给定参数的损伤萌生临界位移的闭式表达式。残余刚度 $\\kappa$ 不影响损伤的萌生，只影响损伤后的行为。", "answer": "$$\n\\boxed{L \\sqrt{\\frac{G_c}{E \\ell}}}\n$$", "id": "3501236"}, {"introduction": "与将损伤弥散在体内的相场法不同，内聚区模型（CZM）将断裂过程限制在一个预定义的路径或界面上，通过“牵引-分离”关系来描述其力学行为。本练习将指导你模拟一个经典的双悬臂梁（DCB）实验，这要求你将梁的弹性响应与界面的内聚力定律耦合起来。通过这个实践，你将获得使用一种重要且广泛应用的离散裂纹方法来模拟裂纹扩展的宝贵经验[@problem_id:3501282]。", "problem": "一个由两个相同的线性弹性臂组成的对称双悬臂梁 (DCB) 试件，在准静态、位移控制的加载下被拉开。臂间的界面遵循一个双线性内聚区模型 (CZM)。目标是通过第一性原理计算载荷-位移响应，并根据牵引力-分离度曲线下的面积估算单位面积断裂能 $G_c$。然后，使用能量释放率准则将内聚断裂与结构柔度耦合，并模拟裂纹扩展。分析必须遵循以下物理和数学假设：小应变、小挠度、梁臂的线性弹性、Euler–Bernoulli 运动学以及准静态加载。缩略语在首次使用时必须定义：双悬臂梁 (Double Cantilever Beam, DCB) 和内聚区模型 (Cohesive Zone Model, CZM)。\n\n从以下基本依据出发：\n- Euler–Bernoulli 梁的曲率定义和线性梁理论（平截面保持平面），包括弯矩与曲率之间的关系 $M = E I \\kappa$ 以及悬臂梁在末端力作用下的末端挠度。\n- 断裂能量释放率 $G$ 的定义，即每新增裂纹表面积所释放的能量，以及使用柔度法将 $G$ 表示为施加载荷 $P$ 和柔度 $C(a)$ 相对于裂纹长度 $a$ 的导数的函数。\n\n问题任务：\n1. 对于由杨氏模量为 $E$ 的材料制成的两个厚度为 $h$、宽度为 $b$ 的相同臂，推导其 DCB 柔度 $C(a)$，其中每个臂都表现为长度等于当前裂纹长度 $a$ 的 Euler–Bernoulli 悬臂梁。将张开位移 $\\delta$ 表示为施加载荷 $P$ 的函数，并通过关系式 $\\delta = C(a) P$ 定义 $C(a)$。\n2. 对于一个双线性牵引力-分离度定律，其初始为刚度为 $K$ 的线性弹性分支，在分离度 $\\Delta_0$ 时达到峰值牵引力 $\\sigma_{\\max}$，随后是一个线性软化分支，在分离度 $\\Delta_f$ 时牵引力降至零。计算单位面积断裂能 $G_c$，即牵引力-分离度曲线下的面积，即 $G_c = \\int_0^{\\Delta_f} t(\\Delta)\\, d\\Delta$。不要使用任何简便公式；明确地根据分段线性曲线的几何形状进行推理。\n3. 使用能量释放率的柔度法，并令 $B$ 表示试件宽度 $b$，将能量释放率 $G$ 表示为 $P$、$B$ 和 $\\frac{dC}{da}$ 的函数，并解释在位移控制下，裂纹扩展如何由条件 $G \\ge G_c$ 决定。模拟必须在 $G \\ge G_c$ 时以小增量 $\\Delta a$ 更新裂纹长度 $a$，并满足约束条件 $a \\le L$，其中 $L$ 是臂长。\n4. 实现一个从 $\\delta = 0$ 以增量 $\\Delta \\delta$ 加载到指定最大值 $\\delta_{\\max}$ 的准静态位移斜坡加载，在每个增量步中，根据当前的柔度和裂纹长度计算平衡载荷 $P$，检查能量释放率 $G$，并以 $\\Delta a$ 递增 $a$ 直到 $G  G_c$ 或 $a = L$。假设单调加载并使用稳定的更新规则。\n\n物理单位必须严格采用国际单位制 (SI)。载荷以牛顿 (N) 报告，位移以米 (m) 报告，长度以米 (m) 报告，模量以帕斯卡 (Pa) 报告，断裂能以焦耳/平方米 (J/m$^2$) 报告。不涉及角度。不使用百分比。\n\n测试套件：\n为以下三组参数集提供结果，每组参数指定为 $(E,b,h,a_0,L,\\sigma_{\\max},\\Delta_0,\\Delta_f,\\delta_{\\max},\\Delta \\delta,\\Delta a)$，所有量均采用国际单位制。\n\n- 案例 1（一般情况，中等韧性）：\n  - $E = 70 \\times 10^9\\,\\text{Pa}$，$b = 0.02\\,\\text{m}$，$h = 0.003\\,\\text{m}$，$a_0 = 0.05\\,\\text{m}$，$L = 0.2\\,\\text{m}$，\n  - $\\sigma_{\\max} = 12 \\times 10^6\\,\\text{Pa}$，$\\Delta_0 = 2 \\times 10^{-5}\\,\\text{m}$，$\\Delta_f = 5 \\times 10^{-4}\\,\\text{m}$，\n  - $\\delta_{\\max} = 0.006\\,\\text{m}$，$\\Delta \\delta = 2 \\times 10^{-5}\\,\\text{m}$，$\\Delta a = 5 \\times 10^{-4}\\,\\text{m}$。\n- 案例 2（较低韧性和较薄的臂；测试稳定扩展行为）：\n  - $E = 30 \\times 10^9\\,\\text{Pa}$，$b = 0.015\\,\\text{m}$，$h = 0.0025\\,\\text{m}$，$a_0 = 0.03\\,\\text{m}$，$L = 0.18\\,\\text{m}$，\n  - $\\sigma_{\\max} = 8 \\times 10^6\\,\\text{Pa}$，$\\Delta_0 = 1.5 \\times 10^{-5}\\,\\text{m}$，$\\Delta_f = 1.5 \\times 10^{-4}\\,\\text{m}$，\n  - $\\delta_{\\max} = 0.004\\,\\text{m}$，$\\Delta \\delta = 1 \\times 10^{-5}\\,\\text{m}$，$\\Delta a = 2.5 \\times 10^{-4}\\,\\text{m}$。\n- 案例 3（较硬的臂，较高的峰值牵引力；测试在位移范围内无扩展）：\n  - $E = 200 \\times 10^9\\,\\text{Pa}$，$b = 0.02\\,\\text{m}$，$h = 0.004\\,\\text{m}$，$a_0 = 0.06\\,\\text{m}$，$L = 0.25\\,\\text{m}$，\n  - $\\sigma_{\\max} = 15 \\times 10^6\\,\\text{Pa}$，$\\Delta_0 = 1 \\times 10^{-5}\\,\\text{m}$，$\\Delta_f = 3 \\times 10^{-4}\\,\\text{m}$，\n  - $\\delta_{\\max} = 0.002\\,\\text{m}$，$\\Delta \\delta = 1 \\times 10^{-5}\\,\\text{m}$，$\\Delta a = 2 \\times 10^{-4}\\,\\text{m}$。\n\n每个案例的必需输出：\n- 断裂能 $G_c$，单位为 $\\text{J}/\\text{m}^2$。\n- 在位移斜坡加载过程中达到的峰值载荷 $P_{\\text{peak}}$，单位为 $\\text{N}$。\n- 在 $\\delta = \\delta_{\\max}$ 时的最终裂纹长度 $a_{\\text{final}}$，单位为 $\\text{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个测试案例对应一个内部列表，每个内部列表按 $[G_c,P_{\\text{peak}},a_{\\text{final}}]$ 的顺序排列，并用方括号括起来。例如，$[[g_1,p_1,a_1],[g_2,p_2,a_2],[g_3,p_3,a_3]]$，所有条目均为国际单位制下的浮点数。", "solution": "该问题要求分析对称双悬臂梁 (DCB) 试件中的裂纹扩展。解决方案将通过首先从线性弹性梁理论和断裂力学中建立基本关系，然后将它们整合到指定的数值模拟算法中来制定。所有物理量均以国际单位制表示。\n\n按要求，分析分四个主要步骤进行：\n1. 推导梁柔度作为裂纹长度的函数。\n2. 根据给定的内聚定律计算临界断裂能。\n3. 建立能量释放率和裂纹扩展准则的公式。\n4. 实现准静态位移控制模拟，以计算载荷-位移响应并跟踪裂纹扩展。\n\n**1. DCB 柔度 $C(a)$ 的推导**\n\nDCB 试件被建模为两个相同的悬臂梁，每个梁的长度 $a$ 对应于当前的裂纹长度。梁臂具有宽度为 $b$、厚度为 $h$ 的矩形横截面，并由杨氏模量为 $E$ 的线性弹性材料制成。该分析遵循 Euler-Bernoulli 梁理论，该理论适用于小挠度下的细长梁。\n\n对于施加的总张开载荷 $P$ 和总张开位移 $\\delta$，DCB 试件的总应变能 $U$（仅考虑弯曲）为两个臂的应变能之和。每个臂可视为一个长度为 $a$、承受端部载荷 $P$ 的悬臂梁。每个臂的应变能为：\n$$\nU_{\\text{arm}} = \\int_0^a \\frac{(Mx)^2}{2EI} dx\n$$\n等等，这不正确。每个臂的弯矩为 $M(x) = Px$。因此，一个臂的应变能为：\n$$\nU_{\\text{arm}} = \\int_0^a \\frac{M(x)^2}{2EI} dx = \\int_0^a \\frac{(Px)^2}{2EI} dx = \\frac{P^2 a^3}{6EI}\n$$\nDCB的总应变能为两个臂的总和：$U=2U_{\\text{arm}} = \\frac{P^2 a^3}{3EI}$。根据卡氏第二定理，加载点处的位移为 $\\delta = \\frac{\\partial U}{\\partial P} = \\frac{2Pa^3}{3EI}$。\nDCB 试件的柔度 $C(a)$ 由关系式 $\\delta = C(a)P$ 定义。因此，\n$$\nC(a) = \\frac{2a^3}{3EI}\n$$\n对于宽度为 $b$、厚度为 $h$ 的矩形横截面，其二次矩 $I$ 为：\n$$\nI = \\frac{bh^3}{12}\n$$\n将 $I$ 代入柔度公式，得到：\n$$\nC(a) = \\frac{2a^3}{3E \\left(\\frac{bh^3}{12}\\right)} = \\frac{8a^3}{Ebh^3}\n$$\n\n**2. 断裂能 $G_c$ 的计算**\n\n两臂之间的界面由双线性内聚区模型 (CZM) 描述。该模型将界面上的牵引力 $t$ 定义为分离度 $\\Delta$ 的函数。牵引力-分离度定律是分段线性的：\n- 对于 $0 \\le \\Delta \\le \\Delta_0$ 的初始线性弹性分支：\n  $$\n  t(\\Delta) = \\frac{\\sigma_{\\max}}{\\Delta_0}\\Delta\n  $$\n- 对于 $\\Delta_0  \\Delta \\le \\Delta_f$ 的线性软化分支：\n  $$\n  t(\\Delta) = \\sigma_{\\max}\\left(\\frac{\\Delta_f - \\Delta}{\\Delta_f - \\Delta_0}\\right)\n  $$\n其中 $\\sigma_{\\max}$ 是在临界分离度 $\\Delta_0$ 处达到的峰值牵引力，$\\Delta_f$ 是牵引力消失且表面完全脱粘时的最终分离度。\n\n单位面积断裂能 $G_c$ 定义为创建单位面积新断裂面所做的总功。这等效于牵引力-分离度曲线下的面积：\n$$\nG_c = \\int_0^{\\Delta_f} t(\\Delta) \\, d\\Delta\n$$\n我们通过对两个线性段（一个三角形和一个梯形，或者两个三角形）的面积求和来计算此积分：\n$$\nG_c = \\text{Area}_1 + \\text{Area}_2 = \\frac{1}{2} \\Delta_0 \\sigma_{\\max} + \\frac{1}{2} (\\Delta_f - \\Delta_0) \\sigma_{\\max}\n$$\n将两部分相加：\n$$\nG_c = \\frac{1}{2}\\sigma_{\\max}(\\Delta_0 + \\Delta_f - \\Delta_0) = \\frac{1}{2}\\sigma_{\\max}\\Delta_f\n$$\n此结果对应于底为 $\\Delta_f$、高为 $\\sigma_{\\max}$ 的三角形面积，代表了材料界面的临界能量释放率。\n\n**3. 能量释放率与裂纹扩展准则**\n\n能量释放率 $G$ 是每单位断裂面积增加所耗散的能量。对于宽度为 $B=b$ 的物体，使用柔度法，$G$ 由下式给出：\n$$\nG = \\frac{P^2}{2b} \\frac{dC}{da}\n$$\n我们必须首先计算柔度 $C(a)$ 的导数：\n$$\n\\frac{dC}{da} = \\frac{d}{da}\\left(\\frac{8a^3}{Ebh^3}\\right) = \\frac{24a^2}{Ebh^3}\n$$\n将此代入 $G$ 的表达式中：\n$$\nG = \\frac{P^2}{2b} \\left(\\frac{24a^2}{Ebh^3}\\right) = \\frac{12P^2a^2}{Eb^2h^3}\n$$\n当能量释放率 $G$ 达到临界断裂能 $G_c$ 时，发生裂纹扩展。因此，裂纹扩展的准则是：\n$$\nG \\ge G_c\n$$\n对于位移控制的试验，将 $G$ 表示为施加位移 $\\delta$ 的函数是很有用的。使用 $P = \\delta/C(a)$：\n$$\nG = \\frac{12a^2}{Eb^2h^3} \\left(\\frac{\\delta}{C(a)}\\right)^2 = \\frac{12a^2\\delta^2}{Eb^2h^3 C(a)^2} = \\frac{12a^2\\delta^2}{Eb^2h^3} \\left(\\frac{Ebh^3}{8a^3}\\right)^2 = \\frac{12a^2\\delta^2}{Eb^2h^3} \\frac{E^2b^2h^6}{64a^6} = \\frac{12E h^3 \\delta^2}{64a^4}\n$$\n$$\nG = \\frac{3E h^3 \\delta^2}{16a^4}\n$$\n该表达式表明，对于固定的位移 $\\delta$，随着裂纹长度 $a$ 的增加，$G$ 会迅速减小（与 $a^{-4}$ 成正比）。这表明在位移控制的 DCB 试验中，裂纹扩展是稳定的。\n\n**4. 准静态模拟的算法实现**\n\n通过一个数值模拟来追踪载荷-位移响应和裂纹扩展。加载过程以小的位移增量 $\\Delta\\delta$ 序列施加。\n\n算法流程如下：\n1. 初始化特定测试案例的参数：$E, b, h, a_0, L, G_c, \\delta_{\\max}, \\Delta\\delta, \\Delta a$。\n2. 初始化状态变量：当前裂纹长度 $a \\leftarrow a_0$，峰值载荷 $P_{\\text{peak}} \\leftarrow 0$。\n3. 开始主循环，将施加的位移 $\\delta$ 从 $\\Delta\\delta$ 递增到 $\\delta_{\\max}$。\n4. 在每个位移步（对于固定的 $\\delta$）内，进入一个内循环以检查裂纹扩展并找到稳定的平衡状态。\n   a. 计算当前柔度 $C(a)$ 和相应的试验载荷 $P = \\delta/C(a)$。\n   b. 使用当前的 $P$ 和 $a$ 值计算能量释放率 $G$。\n   c. 检查扩展条件：如果 $G \\ge G_c$ 并且裂纹尚未到达试件末端（$a  L$），则将裂纹推进一个增量：$a \\leftarrow \\min(a + \\Delta a, L)$。\n   d. 重复内循环（重新计算 $C, P, G$）直到满足条件 $G  G_c$ 或 $a=L$。这表示对于当前的位移 $\\delta$，裂纹已经在一个新的稳定长度上停止扩展。\n5. 一旦内循环终止，当前位移步 $\\delta$ 的最终平衡载荷 $P$ 就已知了。更新迄今为止遇到的峰值载荷：$P_{\\text{peak}} \\leftarrow \\max(P_{\\text{peak}}, P)$。\n6. 继续外循环至下一个位移增量。\n7. 模拟完成后（即 $\\delta$ 达到 $\\delta_{\\max}$），报告 $G_c$、$P_{\\text{peak}}$ 和 $a_{\\text{final}}$ 的最终值。\n此过程正确地模拟了系统的准静态演化，其中在每个无限缓慢的加载步骤中，裂纹会扩展，直到找到一个新的构型，在该构型中能量释放率与材料的断裂韧性相平衡。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DCB fracture mechanics problem for three test cases.\n    \"\"\"\n    \n    # Test cases defined as (E, b, h, a0, L, sigma_max, Delta_0, Delta_f, delta_max, delta_delta, delta_a)\n    # All units are SI units.\n    test_cases = [\n        # Case 1 (general case, moderate toughness)\n        (70e9, 0.02, 0.003, 0.05, 0.2, 12e6, 2e-5, 5e-4, 0.006, 2e-5, 5e-4),\n        # Case 2 (lower toughness and thinner arms; tests stable propagation behavior)\n        (30e9, 0.015, 0.0025, 0.03, 0.18, 8e6, 1.5e-5, 1.5e-4, 0.004, 1e-5, 2.5e-4),\n        # Case 3 (stiff arms, higher peak traction; tests no propagation within the displacement range)\n        (200e9, 0.02, 0.004, 0.06, 0.25, 15e6, 1e-5, 3e-4, 0.002, 1e-5, 2e-4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, b, h, a0, L, sigma_max, _, Delta_f, delta_max, delta_delta, delta_a = case\n        \n        # --- Task 2: Compute fracture energy Gc ---\n        # Gc is the area under the bilinear traction-separation curve, which is a triangle.\n        # Gc = 0.5 * sigma_max * Delta_f\n        Gc = 0.5 * sigma_max * Delta_f\n\n        # --- Task 4: Implement the quasi-static simulation ---\n        a = a0\n        p_peak = 0.0\n        \n        # Discretize the displacement ramp\n        num_steps = int(round(delta_max / delta_delta))\n        displacements = np.linspace(delta_delta, delta_max, num=num_steps)\n\n        for delta in displacements:\n            # Inner loop for crack propagation at a fixed displacement 'delta'\n            # The crack extends until G  Gc, reaching a stable length for this 'delta'\n            while True:\n                if a >= L:\n                    # No more crack growth possible if length limit is reached\n                    break\n\n                # --- Task 1  3: Compliance and Energy Release Rate ---\n                # C(a) = 8 * a^3 / (E * b * h^3)\n                compliance = (8.0 * a**3) / (E * b * h**3)\n                \n                # Calculate equilibrium load P for the current displacement and crack length\n                P = delta / compliance\n\n                # G = (12 * P^2 * a^2) / (E * b^2 * h^3)\n                G = (12.0 * P**2 * a**2) / (E * b**2 * h**3)\n\n                # Check for crack propagation\n                if G >= Gc:\n                    a += delta_a\n                    # Clamp crack length to the specimen length\n                    a = min(a, L)\n                else:\n                    # Equilibrium is reached for this displacement step\n                    break\n\n            # After reaching equilibrium, calculate the final load for this step\n            # This is necessary because 'a' might have been updated in the while loop\n            final_compliance = (8.0 * a**3) / (E * b * h**3)\n            final_P = delta / final_compliance\n            \n            # Update the peak load\n            p_peak = max(p_peak, final_P)\n\n        a_final = a\n        \n        results.append([Gc, p_peak, a_final])\n\n    # Format the final output as a string representation of a list of lists.\n    # e.g., [[g1,p1,a1],[g2,p2,a2],[g3,p3,a3]]\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3501282"}, {"introduction": "理解现代计算模型与经典理论之间的联系是至关重要的。这个练习巧妙地揭示了相场模型与线性弹性断裂力学（LEFM）之间的深刻关联。虽然问题设定在一个相场模型的框架内，但你将发现，对于一个已存在的宏观尖锐裂纹，其起裂的判据最终可以简化为经典的格里菲斯（Griffith）能量准则。这个过程不仅展示了相场模型是对LEFM的一种正则化，也让你体会到在适当的极限下，复杂的现代模型是如何回归到简洁的经典理论的[@problem_id:3501365]。", "problem": "一个带有预制尖锐裂纹的单边缺口拉伸（SEN(T)）试样在单轴拉伸下加载。使用 Ambrosio–Tortorelli 2 (AT2) 相场断裂模型，并对完好材料的弹性应变能密度进行拉伸-压缩谱分解，来确定裂纹萌生的临界载荷。假设以下物理上一致的设置：一个各向同性、线弹性材料，其特征为杨氏模量 $E$ 和泊松比 $\\nu$，裂纹表面能（临界能量释放率）为 $G_c$，以及有限的相场正则化长度 $l$。试样的厚度为 $B$，宽度为 $W$，边裂纹长度为 $a$。对于给定的 SEN(T) 几何形状，一个几何因子 $Y$ 将 I 型应力强度因子与名义载荷联系起来。拉伸-压缩分解的实现应使得只有弹性应变能密度的拉伸部分驱动损伤演化。加载条件可以是平面应力或平面应变。\n\n仅从适用于耦合多物理场模拟中断裂的基本定义和守恒原理出发，推导此 SEN(T) 构型下裂纹萌生的数学上有效的准则，并计算相应的临界载荷。推导必须从坚实的基础开始，并且不得依赖于预设答案的简化公式。您必须确保所有步骤都尊重固体中脆性或准脆性断裂的物理真实性。\n\n您的程序必须计算以下测试套件的临界载荷。对于每种情况，以牛顿为单位，返回一个浮点数形式的临界载荷。输出值中不应包含单位；单位规范是本说明的一部分。请完全按照给定的输入使用。在此上下文中，角度单位不适用。不涉及百分比。\n\n测试套件（所有量均采用国际单位制，其中 $E$ 的单位是帕斯卡，$G_c$ 的单位是牛顿/米，长度单位是米）：\n- 情况 $1$：$E = 210 \\times 10^9$，$\\nu = 0.30$，$G_c = 1000$，$l = 0.002$，$a = 0.02$，$W = 0.1$，$B = 0.01$，$Y = 1.12$，加载条件：平面应变。\n- 情况 $2$：$E = 70 \\times 10^9$，$\\nu = 0.33$，$G_c = 300$，$l = 0.0015$，$a = 0.005$，$W = 0.05$，$B = 0.005$，$Y = 1.12$，加载条件：平面应力。\n- 情况 $3$：$E = 3 \\times 10^9$，$\\nu = 0.49$，$G_c = 800$，$l = 0.001$，$a = 0.01$，$W = 0.1$，$B = 0.004$，$Y = 1.12$，加载条件：平面应变。\n- 情况 $4$：$E = 210 \\times 10^9$，$\\nu = 0.30$，$G_c = 1000$，$l = 0.002$，$a = 0.0001$，$W = 0.02$，$B = 0.002$，$Y = 1.12$，加载条件：平面应力。\n- 情况 $5$：$E = 120 \\times 10^9$，$\\nu = 0.25$，$G_c = 500$，$l = 0.0025$，$a = 0.05$，$W = 0.12$，$B = 0.01$，$Y = 1.05$，加载条件：平面应变。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4,result5]”）。列表中的每个条目都必须是计算出的临界载荷（单位为牛顿），表示为浮点数。不要进行显式舍入；使用计算产生的原生浮点表示。", "solution": "该问题要求在 Ambrosio-Tortorelli (AT2) 相场断裂模型的框架内，推导单边缺口拉伸（SEN(T)）试样中裂纹萌生的准则。然后必须为一系列测试用例计算与此萌生事件对应的临界载荷。\n\n相场断裂模型的出发点是物体的总势能泛函，它包含了储存的弹性能和为产生断裂面而耗散的能量。对于 AT2 模型，这个依赖于位移场 $u$ 和标量相场 $d$ 的泛函 $\\mathcal{E}$ 由下式给出：\n$$\n\\mathcal{E}(u, d) = \\int_{\\Omega} \\psi(u, d) \\, dV = \\int_{\\Omega} \\left[ g(d) \\psi_e(\\boldsymbol{\\varepsilon}(u)) + \\psi_c(d, \\nabla d) \\right] \\, dV\n$$\n这里，$\\Omega$ 是物体的域。$\\psi_e(\\boldsymbol{\\varepsilon}(u))$ 是完好材料的弹性应变能密度，其中 $\\boldsymbol{\\varepsilon}(u) = \\frac{1}{2}(\\nabla u + (\\nabla u)^T)$ 是无穷小应变张量。函数 $g(d)$ 是一个退化函数，它随着损伤的累积而降低材料的刚度；对于 AT2 模型，通常选择 $g(d) = (1-d)^2 + \\eta$，其中 $\\eta$ 是一个小的正常数，以保持问题的适定性。问题陈述中提到使用了拉伸-压缩分解，这意味着只有弹性能的拉伸部分 $\\psi_e^+$ 对损伤有贡献。因此，我们将 $g(d) \\psi_e$ 替换为 $(1-d)^2 \\psi_e^+ + \\psi_e^-$，其中 $\\psi_e^-$ 是压缩部分。\n\n项 $\\psi_c(d, \\nabla d)$ 是断裂能密度，它对尖锐裂纹的拓扑结构进行正则化。对于 AT2 模型，它表示为：\n$$\n\\psi_c(d, \\nabla d) = G_c \\left( \\frac{d^2}{2l} + \\frac{l}{2}|\\nabla d|^2 \\right)\n$$\n根据构造，形成尖锐裂纹表面 $\\Gamma$ 所耗散的总能量为 $\\int_{\\Gamma} G_c \\, dS$。参数 $G_c$ 是临界能量释放率，一个基本的材料属性。参数 $l$ 是正则化长度，它决定了弥散裂纹带的宽度。\n\n问题要求的是预制尖锐裂纹萌生的临界载荷。在相场模型的背景下，这对应于裂纹扩展在能量上变得有利时的载荷。相场模型本质上是 Griffith 基于能量的断裂理论在有限长度尺度 $l$ 上的正则化实现。对于结构中预存的尖锐裂纹，在宏观极限下（即过程区远小于几何尺寸，这一点通过提供 LEFM 几何因子 $Y$ 而被隐式假设），相场模型对裂纹扩展起始的预测会收敛到线弹性断裂力学（LEFM）的预测。参数 $l$ 控制了内聚区内的局部应力状态和损伤分布，但决定扩展起始的全局能量平衡由 $G_c$ 决定。\n\n因此，推导可以从 LEFM 的基本原理，即 Griffith 准则出发。该准则指出，当单位裂纹扩展所释放的弹性能率（即能量释放率 $G$）达到临界值 $G_c$（即创建新断裂面所需的能量）时，裂纹将扩展。\n$$\nG = G_c\n$$\n对于线弹性材料，I 型（张开型）加载的能量释放率通过以下表达式直接与 I 型应力强度因子 $K_I$ 相关：\n$$\nG = \\frac{K_I^2}{E'}\n$$\n其中 $E'$ 是有效杨氏模量。$E'$ 的值取决于裂纹尖端的应力状态：\n\\begin{itemize}\n    \\item 对于**平面应力**条件（薄板，$\\sigma_{zz}=0$），有效模量为 $E' = E$。\n    \\item 对于**平面应变**条件（厚板，$\\varepsilon_{zz}=0$），有效模量为 $E' = \\frac{E}{1 - \\nu^2}$。\n\\end{itemize}\n问题提供了 SEN(T) 试样的几何形状。在名义施加应力 $\\sigma_{\\text{nom}}$ 下，此构型的应力强度因子由以下公式给出：\n$$\nK_I = Y \\sigma_{\\text{nom}} \\sqrt{\\pi a}\n$$\n这里，$a$ 是初始裂纹长度，$Y$ 是无量纲几何因子。名义应力 $\\sigma_{\\text{nom}}$ 是总施加拉伸载荷 $P$ 除以试样的总横截面积，即其宽度 $W$ 乘以其厚度 $B$。\n$$\n\\sigma_{\\text{nom}} = \\frac{P}{B W}\n$$\n将 $\\sigma_{\\text{nom}}$ 的表达式代入 $K_I$ 的方程，我们得到：\n$$\nK_I = Y \\left( \\frac{P}{B W} \\right) \\sqrt{\\pi a}\n$$\n现在，我们可以用施加载荷 $P$ 来表示能量释放率 $G$：\n$$\nG = \\frac{1}{E'} \\left( Y \\frac{P}{B W} \\sqrt{\\pi a} \\right)^2 = \\frac{Y^2 P^2 \\pi a}{E' (B W)^2}\n$$\n为了找到裂纹萌生的临界载荷 $P_c$，我们应用 Griffith 准则 $G = G_c$：\n$$\nG_c = \\frac{Y^2 P_c^2 \\pi a}{E' (B W)^2}\n$$\n最后，我们求解该方程得到 $P_c$：\n$$\nP_c^2 = \\frac{G_c E' (B W)^2}{Y^2 \\pi a}\n$$\n$$\nP_c = \\sqrt{\\frac{G_c E' (B W)^2}{Y^2 \\pi a}} = \\frac{B W}{Y} \\sqrt{\\frac{G_c E'}{\\pi a}}\n$$\n这个最终方程根据所提供的材料属性和几何参数，给出了裂纹萌生的临界载荷。相场正则化长度 $l$ 没有出现在这个宏观能量平衡方程中，因为对于尖锐裂纹问题，其效应已包含在断裂韧度 $G_c$ 的定义中。每个测试用例的计算首先根据加载条件确定正确的 $E'$，然后应用推导出的 $P_c$ 公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the critical load for crack initiation in a Single Edge Notched\n    Tension (SEN(T)) specimen based on Linear Elastic Fracture Mechanics (LEFM),\n    which is the macroscopic limit of the specified phase-field model for a\n    pre-existing sharp crack.\n    \"\"\"\n\n    # Test suite (all quantities in SI units)\n    # E in Pascals, Gc in N/m, lengths in meters.\n    # (E, nu, Gc, l, a, W, B, Y, loading_condition)\n    test_cases = [\n        (210e9, 0.30, 1000, 0.002, 0.02, 0.1, 0.01, 1.12, 'plane strain'),\n        (70e9, 0.33, 300, 0.0015, 0.005, 0.05, 0.005, 1.12, 'plane stress'),\n        (3e9, 0.49, 800, 0.001, 0.01, 0.1, 0.004, 1.12, 'plane strain'),\n        (210e9, 0.30, 1000, 0.002, 0.0001, 0.02, 0.002, 1.12, 'plane stress'),\n        (120e9, 0.25, 500, 0.0025, 0.05, 0.12, 0.01, 1.05, 'plane strain'),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        E, nu, G_c, l, a, W, B, Y, loading_condition = case\n\n        # Determine the effective Young's modulus E' based on loading condition.\n        if loading_condition == 'plane strain':\n            E_prime = E / (1 - nu**2)\n        elif loading_condition == 'plane stress':\n            E_prime = E\n        else:\n            # Handle potential invalid input, though not expected from problem statement.\n            raise ValueError(\"Invalid loading condition specified.\")\n\n        # Calculate the critical load Pc using the derived formula:\n        # Pc = (B * W / Y) * sqrt((Gc * E') / (pi * a))\n        # The phase-field length scale 'l' is not used in the macroscopic\n        # LEFM criterion for a sharp pre-crack.\n\n        term_under_sqrt = (G_c * E_prime) / (np.pi * a)\n        P_c = (B * W / Y) * np.sqrt(term_under_sqrt)\n\n        results.append(P_c)\n\n    # Format the final output as a comma-separated list in brackets.\n    # The map(str, ...) converts each float to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3501365"}]}