{"hands_on_practices": [{"introduction": "心肌的协同收缩源于电兴奋波的传播。本练习旨在探索心脏电生理学的一个基本方面：心肌的各向异性结构，特别是肌纤维的排列，如何决定了电波传播的速度和模式。通过对反应扩散模型进行量纲分析，您将推导并计算传导速度，从而对组织特性与生理功能之间的联系有一个定量的理解 [@problem_id:3496978]。", "problem": "在一个耦合心血管模拟中，电兴奋在变形的心肌壁上建模，并通过兴奋-收缩和压力-负载反馈与流体和结构相互作用。考虑跨膜电位的单域反应扩散描述，其中去极化的扩散传播由一个与心肌纤维对齐的扩散张量来表征。设局部纤维坐标系使得扩散张量为对角阵，其对角元为 $D_{\\ell}$（沿纤维方向）和 $D_{t}$（横向于纤维方向），并设离子上升时间尺度为 $\\tau_{\\text{up}}$。假设在上升期间存在陡峭的兴奋前沿，并在估算基线速度时忽略主导阶的曲率。\n\n从反应-扩散平衡（上升期间的扩散通量散度与时间变化率）出发，使用量纲分析推导平面波前速度关于特征扩散系数和上升时间的主导阶标度关系，然后用它来估算以下场景中的速度。定性解释各向异性电导率如何改变控制传播速度的有效扩散，以及它如何影响二维空间中的波前曲率。\n\n给定数据（在局部纤维坐标系中）：\n- 纵向扩散系数 $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$，\n- 横向扩散系数 $D_{t} = 3.0 \\times 10^{-4}\\ \\mathrm{cm}^2/\\mathrm{ms}$，\n- 上升时间 $\\tau_{\\text{up}} = 0.8\\ \\mathrm{ms}$。\n\n任务：\n1) 在一维纤维方向的索状结构中，估算沿纤维的传导速度 $c_{\\ell}$。\n\n2) 在二维平板中，考虑平面传播，其法线与纤维方向成 $\\theta$ 角。使用扩散张量在传播法线上的投影，写出有效扩散 $D_{\\text{eff}}(\\theta)$ 的表达式，并估算 $\\theta = 30^{\\circ}$（度）时产生的速度 $c(\\theta)$。将两种速度都以 $\\mathrm{m}/\\mathrm{s}$ 表示。\n\n基于各向异性扩散算子，简要解释各向异性如何影响波前曲率和速度（无需引用公式；从扩散-反应平衡和几何投影进行推理）。\n\n将您最终报告的 $c(\\theta)$ 值四舍五入到三位有效数字。在最终答案中只报告 $c(\\theta)$ 的值。", "solution": "心脏组织中跨膜电位 $V$ 的传播可以用一个反应扩散方程来描述。其简化的单域形式为：\n$$ \\frac{\\partial V}{\\partial t} = \\nabla \\cdot (\\mathbf{D} \\nabla V) - I_{\\text{ion}}(V) $$\n其中 $\\mathbf{D}$ 是扩散张量，$I_{\\text{ion}}(V)$ 代表离子电流（反应项），并已通过膜电容进行缩放（为简化标度分析，此处省略了膜电容）。\n\n**波前速度的主导阶标度关系**\n\n题目要求基于动作电位陡峭上升期间时间变化与扩散之间的平衡进行量纲分析。我们考虑一个以速度 $c$ 传播的平面波。设波前前沿的特征长度尺度为 $L$。在上升期间（发生时间为 $\\tau_{\\text{up}}$），时间变化率的标度为：\n$$ \\frac{\\partial V}{\\partial t} \\sim \\frac{\\Delta V}{\\tau_{\\text{up}}} $$\n其中 $\\Delta V$ 是动作电位的振幅。扩散项的标度为：\n$$ \\nabla \\cdot (D \\nabla V) \\sim D \\frac{\\Delta V}{L^2} $$\n其中 $D$ 是一个特征扩散系数。波前上的一点在与上升相相关的时间（我们可以近似为 $\\tau_{\\text{up}}$）内行进距离 $L$。因此，速度 $c$ 与这些尺度的关系为 $c \\sim L/\\tau_{\\text{up}}$，这意味着 $L \\sim c \\tau_{\\text{up}}$。\n\n按照指示，通过平衡时间项和扩散项，我们得到：\n$$ \\frac{\\Delta V}{\\tau_{\\text{up}}} \\sim D \\frac{\\Delta V}{L^2} $$\n$$ \\frac{1}{\\tau_{\\text{up}}} \\sim \\frac{D}{L^2} $$\n代入 $L \\sim c \\tau_{\\text{up}}$：\n$$ \\frac{1}{\\tau_{\\text{up}}} \\sim \\frac{D}{(c \\tau_{\\text{up}})^2} $$\n$$ c^2 \\tau_{\\text{up}}^2 \\sim D \\tau_{\\text{up}} $$\n$$ c^2 \\sim \\frac{D}{\\tau_{\\text{up}}} $$\n这就给出了传导速度的主导阶标度关系：\n$$ c \\sim \\sqrt{\\frac{D}{\\tau_{\\text{up}}}} $$\n\n**1) 沿纤维的传导速度 ($c_{\\ell}$)**\n\n对于与心肌纤维对齐的一维索状结构，相关的扩散系数是纵向扩散系数，$D = D_{\\ell}$。\n$$ c_{\\ell} = \\sqrt{\\frac{D_{\\ell}}{\\tau_{\\text{up}}}} $$\n给定 $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$ 和 $\\tau_{\\text{up}} = 0.8\\ \\mathrm{ms}$：\n$$ c_{\\ell} = \\sqrt{\\frac{1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}}{0.8\\ \\mathrm{ms}}} = \\sqrt{1.5 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}^2} \\approx 0.03873\\ \\mathrm{cm/ms} $$\n转换为 $\\mathrm{m/s}$：\n$$ 1\\ \\frac{\\mathrm{cm}}{\\mathrm{ms}} = \\frac{10^{-2}\\ \\mathrm{m}}{10^{-3}\\ \\mathrm{s}} = 10\\ \\frac{\\mathrm{m}}{\\mathrm{s}} $$\n$$ c_{\\ell} \\approx 0.03873 \\times 10\\ \\mathrm{m/s} = 0.3873\\ \\mathrm{m/s} $$\n\n**2) 与纤维成角 $\\theta = 30^{\\circ}$ 时的传导速度**\n\n在二维平板中，局部纤维坐标系（其中 $x_1$ 轴沿纤维方向）中的扩散张量 $\\mathbf{D}$ 为：\n$$ \\mathbf{D} = \\begin{pmatrix} D_{\\ell} & 0 \\\\ 0 & D_{t} \\end{pmatrix} $$\n对于一个在由单位法向量 $\\mathbf{n}$ 定义的方向上传播的平面波，该方向与纤维方向成 $\\theta$ 角，我们有：\n$$ \\mathbf{n} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} $$\n传播方向上的有效扩散系数 $D_{\\text{eff}}(\\theta)$ 由投影 $\\mathbf{n}^T \\mathbf{D} \\mathbf{n}$ 给出：\n$$ D_{\\text{eff}}(\\theta) = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} D_{\\ell} & 0 \\\\ 0 & D_{t} \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} D_{\\ell}\\cos\\theta \\\\ D_{t}\\sin\\theta \\end{pmatrix} $$\n$$ D_{\\text{eff}}(\\theta) = D_{\\ell}\\cos^2\\theta + D_{t}\\sin^2\\theta $$\n这就是有效扩散系数的表达式。\n\n对于 $\\theta = 30^{\\circ}$，我们有 $\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$ 和 $\\sin(30^{\\circ}) = \\frac{1}{2}$。因此，$\\cos^2(30^{\\circ}) = \\frac{3}{4}$ 和 $\\sin^2(30^{\\circ}) = \\frac{1}{4}$。\n使用给定数据，$D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$ 和 $D_{t} = 3.0 \\times 10^{-4}\\ \\mathrm{cm}^2/\\mathrm{ms}$：\n$$ D_{\\text{eff}}(30^{\\circ}) = (1.2 \\times 10^{-3})\\left(\\frac{3}{4}\\right) + (3.0 \\times 10^{-4})\\left(\\frac{1}{4}\\right) $$\n$$ D_{\\text{eff}}(30^{\\circ}) = 0.9 \\times 10^{-3} + 0.75 \\times 10^{-4} = 0.9 \\times 10^{-3} + 0.075 \\times 10^{-3} $$\n$$ D_{\\text{eff}}(30^{\\circ}) = 0.975 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms} $$\n产生的速度 $c(30^{\\circ})$ 是：\n$$ c(30^{\\circ}) = \\sqrt{\\frac{D_{\\text{eff}}(30^{\\circ})}{\\tau_{\\text{up}}}} = \\sqrt{\\frac{0.975 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}}{0.8\\ \\mathrm{ms}}} = \\sqrt{1.21875 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}^2} $$\n$$ c(30^{\\circ}) \\approx 0.0349106\\ \\mathrm{cm/ms} $$\n转换为 $\\mathrm{m/s}$：\n$$ c(30^{\\circ}) \\approx 0.0349106 \\times 10\\ \\mathrm{m/s} = 0.349106\\ \\mathrm{m/s} $$\n四舍五入到三位有效数字，我们得到 $c(30^{\\circ}) \\approx 0.349\\ \\mathrm{m/s}$。\n\n**各向异性效应的定性解释**\n\n各向异性电导率，其中 $D_{\\ell} > D_{t}$，对波前传播有深远的影响。\n- **有效扩散和速度**：有效扩散系数 $D_{\\text{eff}}(\\theta) = D_{\\ell}\\cos^2\\theta + D_{t}\\sin^2\\theta$ 不是恒定的，而是随传播方向相对于纤维方向的角度 $\\theta$ 而变化。由于 $D_{\\ell}$ 是最大的系数，当 $\\cos^2\\theta = 1$（即 $\\theta = 0^{\\circ}$ 或 $180^{\\circ}$）时，$D_{\\text{eff}}$ 最大，这对应于纯粹沿纤维方向的传播。当 $\\sin^2\\theta = 1$（即 $\\theta = 90^{\\circ}$ 或 $270^{\\circ}$）时，$D_{\\text{eff}}$ 最小，这对应于横向于纤维的传播。由于速度与 $\\sqrt{D_{\\text{eff}}}$ 成正比，传播速度沿纤维方向最快，横向于纤维方向最慢。\n- **波前曲率**：在各向同性介质中（$D_{\\ell} = D_{t}$），扩散算子是拉普拉斯算子，$D\\nabla^2 V$。扩散电流垂直于波前流动（即沿梯度 $\\nabla V$）。这导致曲率和速度之间存在对称关系（例如，点刺激产生圆形波）。在各向异性介质中，扩散算子是 $\\nabla \\cdot (\\mathbf{D} \\nabla V)$。扩散电流通量是 $\\mathbf{j} = -\\mathbf{D}\\nabla V$。因为 $\\mathbf{D}$ 是一个张量，通量矢量 $\\mathbf{j}$ 通常不与电位梯度 $\\nabla V$ 平行。相反，它会朝向更高扩散率的方向（纤维轴）旋转。这意味着即使波前具有一定的曲率，使其平滑的扩散电流也是偏斜的。一个后果是，从点刺激引发的波前将不是圆形的；它将在纤维方向上被拉长，形成一个椭圆形，因为沿该轴的传播速度更快。局部波前曲率和局部速度之间的相互作用变得依赖于波前段相对于纤维的方向，打破了简单的各向同性关系。", "answer": "$$\\boxed{0.349}$$", "id": "3496978"}, {"introduction": "随着电信号的激活，心肌收缩，使心室成为一个将血液泵入循环系统的机械泵。本练习采用经典的时变弹性模型来研究左心室内的压力与容积关系，也就是著名的压力-容积（PV）环。通过计算不同血液动力学负荷（前负荷和后负荷）下的心室搏功，您将定量地探究心脏生理学的核心原理，例如Frank-Starling机制 [@problem_id:3496958]。", "problem": "本文考虑一个简化但机理一致的左心室模型，以捕捉一个心动周期内心血管的流体-结构-电生理耦合。左心室压力遵循时变弹性关系 $P(t) = E(t)\\,\\big(V(t)-V_{0}\\big)$，其中 $P(t)$ 为压力，$V(t)$ 为心室容积，$V_{0}$ 为容积轴截距，$E(t)$ 为瞬时弹性。结构（心肌）状态由电生理通过主动心肌细胞张力 $T_{\\mathrm{act}}(t)$ 驱动，其线性本构耦合关系为 $E(t) = E_{\\min} + \\gamma\\,T_{\\mathrm{act}}(t)$。假设在收缩期激活期间，$T_{\\mathrm{act}}(t)$ 从 $0$ 上升至其峰值 $T_{\\mathrm{act}}^{\\max}$，然后在舒张期间回落至 $0$，因此 $E(t)$ 从 $E_{\\min}$ 上升至 $E_{\\max} = E_{\\min} + \\gamma\\,T_{\\mathrm{act}}^{\\max}$，然后再回落至 $E_{\\min}$。\n\n血流动力学模型中，二尖瓣和主动脉瓣被视为理想二极管，瓣膜阻力可忽略不计，心房和主动脉具有较大的顺应性，从而维持恒定的上游和下游压力：左心房是一个压力为 $P_{v}$（前负荷）的压力池，近端主动脉是一个压力为 $P_{a}$（后负荷）的压力池。在阻力可忽略的情况下，当瓣膜打开时，心室压力等于相连压力池的压力。当 $P(t) \\le P_{v}$ 时二尖瓣打开，当 $P(t) \\ge P_{a}$ 时主动脉瓣打开。否则，两个瓣膜都关闭。忽略血柱中的惯性效应和粘性效应。\n\n仅从这些假设以及连续介质力学中压力、容积和功的定义出发，并将 $T_{\\mathrm{act}}(t)$ 视为 $E(t)$ 的驱动因素，推导一次心跳中压力-容积环的分段路径，并计算以下三种情况下的每搏功（所围面积）：\n- 基准情况：$E_{\\min} = 0.08$ mmHg/mL, $\\gamma = 1.74$ mmHg/(mL·单位张力), $T_{\\mathrm{act}}^{\\max} = 1$ (无量纲), $P_{v} = 10$ mmHg, $P_{a} = 100$ mmHg。\n- 前负荷增加：参数与基准情况相同，但 $P_{v} = 12$ mmHg。\n- 后负荷增加：参数与基准情况相同，但 $P_{a} = 120$ mmHg。\n\n假设激活过程足够缓慢，以至于随着 $E(t)$ 的上升和下降，瓣膜状态之间的转换是准静态发生的；并假设心动周期是周期性的，因此舒张末期和收缩末期状态在每次心跳中都会重复。你可以认为 $V_{0}$ 是一个常数，无需指定其数值。\n\n以单行向量的形式报告你的三个每搏功值，顺序为（基准情况，前负荷增加，后负荷增加）。最终结果以 mmHg·mL 为单位表示，并将每个条目四舍五入至四位有效数字。", "solution": "压力-容积（PV）环描述了心室在一个心动周期内所做的功。问题的假设将心动周期的四个阶段简化为PV平面上的四个不同阶段：\n1.  **等容收缩期**：两个瓣膜都关闭。容积恒定为舒张末期容积 $V_{\\mathrm{ED}}$。压力从前负荷 $P_{v}$ 上升至后负荷 $P_{a}$。在PV平面上，这是一个垂直线段。\n2.  **射血期**：主动脉瓣打开。压力恒定在后负荷 $P_{a}$。容积从 $V_{\\mathrm{ED}}$ 减少到收缩末期容积 $V_{\\mathrm{ES}}$。这是一个水平线段。\n3.  **等容舒张期**：两个瓣膜都关闭。容积恒定在 $V_{\\mathrm{ES}}$。压力从 $P_{a}$ 下降到 $P_{v}$。这是一个垂直线段。\n4.  **充盈期**：二尖瓣打开。压力恒定在前负荷 $P_{v}$。容积从 $V_{\\mathrm{ES}}$ 增加回 $V_{\\mathrm{ED}}$。这是一个水平线段。\n\n这四个阶段在PV平面上形成一个矩形，其顶点为 $(V_{\\mathrm{ED}}, P_{v})$、$(V_{\\mathrm{ED}}, P_{a})$、$(V_{\\mathrm{ES}}, P_{a})$ 和 $(V_{\\mathrm{ES}}, P_{v})$。每搏功 $W_{\\mathrm{stroke}}$ 即为该环路所围成的面积。\n\n容积 $V_{\\mathrm{ED}}$ 和 $V_{\\mathrm{ES}}$ 由充盈期和射血期结束时心室的状态决定。\n充盈期末（舒张末期）发生在心室最舒张时，此时其弹性处于最小值 $E_{\\min}$。在这一点，压力为前负荷 $P_v$。使用压力-容积关系：\n$$P_{v} = E_{\\min}(V_{\\mathrm{ED}} - V_{0})$$\n求解舒张末期容积 $V_{\\mathrm{ED}}$：\n$$V_{\\mathrm{ED}} = V_{0} + \\frac{P_{v}}{E_{\\min}}$$\n\n射血期末（收缩末期）发生在心室最大收缩时，此时其弹性达到峰值 $E_{\\max}$。在这一点，压力为后负荷 $P_a$。使用压力-容积关系：\n$$P_{a} = E_{\\max}(V_{\\mathrm{ES}} - V_{0})$$\n求解收缩末期容积 $V_{\\mathrm{ES}}$：\n$$V_{\\mathrm{ES}} = V_{0} + \\frac{P_{a}}{E_{\\max}}$$\n注意，要发生射血，必须有 $V_{\\mathrm{ED}} > V_{\\mathrm{ES}}$，这意味着 $\\frac{P_{v}}{E_{\\min}} > \\frac{P_{a}}{E_{\\max}}$。\n\n每搏功是PV矩形的面积，等于压力变化量与容积变化量（每搏输出量, $SV$）的乘积。\n$$W_{\\mathrm{stroke}} = (P_{a} - P_{v}) \\times (V_{\\mathrm{ED}} - V_{\\mathrm{ES}})$$\n每搏输出量 $SV = V_{\\mathrm{ED}} - V_{\\mathrm{ES}}$，可以通过代入容积的表达式来计算：\n$$SV = \\left(V_{0} + \\frac{P_{v}}{E_{\\min}}\\right) - \\left(V_{0} + \\frac{P_{a}}{E_{\\max}}\\right) = \\frac{P_{v}}{E_{\\min}} - \\frac{P_{a}}{E_{\\max}}$$\n未知常数 $V_{0}$ 被消去，正如预期的那样。\n每搏功的最终表达式为：\n$$W_{\\mathrm{stroke}} = (P_{a} - P_{v})\\left(\\frac{P_{v}}{E_{\\min}} - \\frac{P_{a}}{E_{\\max}}\\right)$$\n\n现在，我们计算所要求的三种情况的数值。首先，计算所有情况共有的最大弹性 $E_{\\max}$：\n$E_{\\min} = 0.08$ mmHg/mL, $\\gamma = 1.74$ mmHg/(mL·单位张力), $T_{\\mathrm{act}}^{\\max} = 1$。\n$$E_{\\max} = E_{\\min} + \\gamma T_{\\mathrm{act}}^{\\max} = 0.08 + 1.74 \\times 1 = 1.82 \\, \\text{mmHg/mL}$$\n\n**情况1：基准情况**\n参数：$P_{v} = 10$ mmHg, $P_{a} = 100$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL。\n$$W_{\\text{base}} = (100 - 10) \\left( \\frac{10}{0.08} - \\frac{100}{1.82} \\right)$$\n$$W_{\\text{base}} = 90 \\left( 125 - 54.94505... \\right) = 90 \\left( 70.054945... \\right) \\approx 6304.945 \\, \\text{mmHg}\\cdot\\text{mL}$$\n四舍五入到四位有效数字，$W_{\\text{base}} = 6305$ mmHg·mL。\n\n**情况2：前负荷增加**\n参数：$P_{v} = 12$ mmHg, $P_{a} = 100$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL。\n$$W_{\\text{preload}} = (100 - 12) \\left( \\frac{12}{0.08} - \\frac{100}{1.82} \\right)$$\n$$W_{\\text{preload}} = 88 \\left( 150 - 54.94505... \\right) = 88 \\left( 95.054945... \\right) \\approx 8364.835 \\, \\text{mmHg}\\cdot\\text{mL}$$\n四舍五入到四位有效数字，$W_{\\text{preload}} = 8365$ mmHg·mL。\n\n**情况3：后负荷增加**\n参数：$P_{v} = 10$ mmHg, $P_{a} = 120$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL。\n$$W_{\\text{afterload}} = (120 - 10) \\left( \\frac{10}{0.08} - \\frac{120}{1.82} \\right)$$\n$$W_{\\text{afterload}} = 110 \\left( 125 - 65.93406... \\right) = 110 \\left( 59.065934... \\right) \\approx 6497.252 \\, \\text{mmHg}\\cdot\\text{mL}$$\n四舍五入到四位有效数字，$W_{\\text{afterload}} = 6497$ mmHg·mL。\n\n三个每搏功值为 $(6305, 8365, 6497)$ mmHg·mL。", "answer": "$$\\boxed{\\begin{pmatrix} 6305 & 8365 & 6497 \\end{pmatrix}}$$", "id": "3496958"}, {"introduction": "为了精确地模拟心脏功能，我们必须在计算上耦合血流（流体）和心壁（结构）的模型，这项任务带来了重大的数值挑战。本练习将探讨一个关键的数值问题，即“附加质量不稳定性”，它通常困扰着分区流固耦合方案，尤其是在像血液这样的稠密流体与心肌这样相对较轻的结构相互作用时。通过分析简化的单体（稳定）和分区（不稳定）耦合算法，您将深入了解为何开发稳健的数值方法对于可靠的心血管仿真是至关重要的 [@problem_id:3496947]。", "problem": "要求您设计并分析一个降阶的、单体式与分区式耦合的对比研究，该研究需捕捉一个经历流固-电生理耦合的搏动心室中，附加质量效应对稳定性的影响。重点在于使用界面牵引力和运动学条件以及任意拉格朗日-欧拉（ALE）网格运动，对稳定性进行逻辑推导和数值量化。目标是推导线性更新算子并计算其谱半径，以评估离散时间格式的稳定性。\n\n出发点与假设：\n- 基本定律和界面条件：\n  - 牛顿第二定律应用于流体控制体积和结构壁。\n  - 流固界面处的牵引力连续性：$[\\boldsymbol{\\sigma}_f \\mathbf{n}] = [\\boldsymbol{\\sigma}_s \\mathbf{n}]$。\n  - 界面处的运动学连续性：$\\mathbf{u}_f = \\dot{\\mathbf{x}}_s$。\n  - 任意拉格朗日-欧拉（ALE）网格运动：界面处的流体网格速度等于结构速度，从而一致地满足运动学条件。\n- 降阶模型：\n  - 考虑一个与心室内流体耦合的心室壁段的一维线性化表示。结构被建模为具有结构质量 $M_s$、阻尼 $C$ 和刚度 $K$ 的单自由度质量-弹簧-阻尼器。流体通过一个有效附加质量 $M_a$ 来表示，该附加质量体现了通过 ALE 条件与壁面耦合的流体惯性。此表示是通过将牛顿第二定律应用于流体控制体积，并援引 $\\mathbf{u}_f = \\dot{\\mathbf{x}}_s$ 推导出来的，它表明壁面加速度会引发一个与 $M_a \\ddot{x}$ 成正比的流体反作用力。\n  - 电生理（EP）以主动应力的形式引入，在结构方程中产生一个主动力 $F_{\\text{active}}(t)$。为了对齐次方程进行离散时间稳定性分析，设 $F_{\\text{active}}(t) = 0$。这样可以分离出耦合本身的稳定性特性。您可以假定变量是无量纲的，因此输出中不需要物理单位。\n\n连续方程：\n- 包含流体反作用的结构（使用动力学和运动学连续性）：\n  $$\n  (M_s + M_a)\\,\\ddot{x}(t) + C\\,\\dot{x}(t) + K\\,x(t) = F_{\\text{active}}(t).\n  $$\n  为进行稳定性分析，使用 $F_{\\text{active}}(t) = 0$。\n\n待推导和分析的离散化方法：\n- 单体式格式（隐式，单场求解）：\n  - 写出状态为 $x(t)$ 和 $v(t) = \\dot{x}(t)$ 的一阶状态形式：\n    $$\n    \\dot{x} = v,\\quad \\dot{v} = -\\frac{C}{M_s + M_a} v - \\frac{K}{M_s + M_a} x.\n    $$\n  - 对上述状态空间系统应用时间步长为 $\\Delta t$ 的后向欧拉法，以获得针对 $y^n = [x^n, v^n]^\\top$ 的线性更新 $y^{n+1} = \\mathbf{G}_{\\text{mono}}\\,y^n$。从后向欧拉法的基本定义推导出 $\\mathbf{G}_{\\text{mono}}$。\n\n- 分区式、松耦合格式（具有单步延迟的显式流体反作用）：\n  - 使用 ALE 运动学条件和线性化流体动量将流体反作用表示为附加质量力 $-M_a \\ddot{x}$，但在结构更新中以分区方式处理，并带有一个时间步的延迟。使用前向欧拉法进行结构状态更新，并将流体加速度显式地延迟一个时间步：\n    $$\n    a^n = \\ddot{x}^n = \\frac{-C\\,v^n - K\\,x^n + M_a\\,a^{n-1}}{M_s},\\quad v^{n+1} = v^n + \\Delta t\\,a^n,\\quad x^{n+1} = x^n + \\Delta t\\,v^n.\n    $$\n  - 定义增广状态 $z^n = [x^n, v^n, a^{n-1}]^\\top$ 并推导 $3\\times 3$ 的放大矩阵 $\\mathbf{G}_{\\text{part}}$，使得 $z^{n+1} = \\mathbf{G}_{\\text{part}}\\,z^n$。\n\n稳定性量化：\n- 对于每种格式，计算谱半径，其定义为放大矩阵特征值模的最大值。将它们表示为 $\\rho_{\\text{mono}}$ 和 $\\rho_{\\text{part}}$。\n- 稳定性判据：如果谱半径严格小于1（在实现中使用一个小的数值容差），则认为该格式对于齐次系统是线性稳定的。将稳定性记录为整数，稳定为1，不稳定为0。\n\n测试套件：\n- 使用以下五个参数集，每个集指定为 $(M_s, M_a, C, K, \\Delta t)$，均为无量纲值：\n  1. $(1.0, 0.5, 0.1, 100.0, 0.005)$ 捕捉中等附加质量比和小时间步的情况。\n  2. $(1.0, 5.0, 0.1, 100.0, 0.005)$ 突出大附加质量比的情况。\n  3. $(1.0, 5.0, 2.0, 100.0, 0.005)$ 探究大附加质量下较大阻尼的影响。\n  4. $(1.0, 0.9, 0.0, 100.0, 0.02)$ 作为低阻尼、较大时间步的场景。\n  5. $(1.0, 0.0, 0.0, 100.0, 0.02)$ 作为无流体的边缘情况。\n\n程序要求：\n- 实现上述推导，为每个测试用例构建 $\\mathbf{G}_{\\text{mono}}$ 和 $\\mathbf{G}_{\\text{part}}$，计算 $\\rho_{\\text{mono}}$ 和 $\\rho_{\\text{part}}$，并确定稳定性标志 $s_{\\text{mono}}$ 和 $s_{\\text{part}}$，其中如果 $\\rho_{\\text{mono}}  1$ 则 $s_{\\text{mono}} = 1$，否则为0（使用数值容差），$s_{\\text{part}}$ 类似。\n- 对于每个测试用例，输出一个列表 $[\\rho_{\\text{mono}}, \\rho_{\\text{part}}, s_{\\text{mono}}, s_{\\text{part}}]$，其中谱半径为浮点数，保留六位小数，稳定性为整数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表，每个测试用例的结果都显示为其自己的子列表。例如：“[[r1_mono,r1_part,s1_mono,s1_part],[r2_mono,r2_part,s2_mono,s2_part],...]”（这是一个示例格式；您的实际数值会有所不同）。\n- 所有输出均为无量纲数；不需要物理单位。不使用角度。\n\n交付成果：\n- 提供一个完整的、可运行的程序，该程序根据上述推导构建放大矩阵，计算谱半径，评估稳定性，并以指定的单行格式准确打印汇总结果。", "solution": "该问题要求针对一个表示搏动心室段的简化一维流固耦合（FSI）模型，推导并分析两种数值耦合格式（单体式和分区式）的稳定性。通过计算每种格式的放大矩阵的谱半径来评估稳定性。\n\n包含流体附加质量效应的结构位移 $x(t)$ 的控制常微分方程为：\n$$\n(M_s + M_a)\\,\\ddot{x}(t) + C\\,\\dot{x}(t) + K\\,x(t) = 0\n$$\n其中 $M_s$ 是结构质量，$M_a$ 是流体附加质量，$C$ 是阻尼系数，$K$ 是刚度。为进行齐次稳定性分析，主动力 $F_{\\text{active}}(t)$ 被设为零。\n\n让我们定义总质量为 $M_{tot} = M_s + M_a$。该方程可以改写为状态空间形式。设状态向量为 $y(t) = [x(t), v(t)]^\\top$，其中 $v(t) = \\dot{x}(t)$ 是速度。一阶系统为：\n$$\n\\dot{y}(t) = \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{v}(t) \\end{pmatrix} = \\begin{pmatrix} v(t) \\\\ -\\frac{K}{M_{tot}}x(t) - \\frac{C}{M_{tot}}v(t) \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -\\frac{K}{M_{tot}}  -\\frac{C}{M_{tot}} \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ v(t) \\end{pmatrix}\n$$\n其形式为 $\\dot{y} = \\mathbf{A}y$，其中系统矩阵 $\\mathbf{A}$ 定义为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -\\frac{K}{M_{tot}}  -\\frac{C}{M_{tot}} \\end{pmatrix}\n$$\n\n### 单体式格式推导\n\n单体式格式使用隐式时间步进方法同时求解所有场。这里，我们对状态空间系统应用时间步长为 $\\Delta t$ 的后向欧拉法。后向欧拉法的离散更新规则是：\n$$\ny^{n+1} = y^n + \\Delta t \\, \\dot{y}^{n+1}\n$$\n代入 $\\dot{y}^{n+1} = \\mathbf{A}y^{n+1}$：\n$$\ny^{n+1} = y^n + \\Delta t \\, \\mathbf{A}y^{n+1}\n$$\n重新整理以求解新时间步的状态 $y^{n+1}$：\n$$\n(\\mathbf{I} - \\Delta t \\, \\mathbf{A})y^{n+1} = y^n\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。这导出了线性更新形式 $y^{n+1} = \\mathbf{G}_{\\text{mono}} y^n$，其中放大矩阵 $\\mathbf{G}_{\\text{mono}}$ 为：\n$$\n\\mathbf{G}_{\\text{mono}} = (\\mathbf{I} - \\Delta t \\, \\mathbf{A})^{-1}\n$$\n让我们构建待求逆的矩阵：\n$$\n\\mathbf{I} - \\Delta t \\, \\mathbf{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\Delta t \\begin{pmatrix} 0  1 \\\\ -\\frac{K}{M_{tot}}  -\\frac{C}{M_{tot}} \\end{pmatrix} = \\begin{pmatrix} 1  -\\Delta t \\\\ \\frac{K \\Delta t}{M_{tot}}  1 + \\frac{C \\Delta t}{M_{tot}} \\end{pmatrix}\n$$\n该矩阵的行列式为：\n$$\n\\det(\\mathbf{I} - \\Delta t \\, \\mathbf{A}) = 1 \\cdot \\left(1 + \\frac{C \\Delta t}{M_{tot}}\\right) - (-\\Delta t)\\left(\\frac{K \\Delta t}{M_{tot}}\\right) = 1 + \\frac{C \\Delta t}{M_{tot}} + \\frac{K (\\Delta t)^2}{M_{tot}}\n$$\n其逆矩阵则为：\n$$\n\\mathbf{G}_{\\text{mono}} = \\frac{1}{1 + \\frac{C \\Delta t}{M_{tot}} + \\frac{K (\\Delta t)^2}{M_{tot}}} \\begin{pmatrix} 1 + \\frac{C \\Delta t}{M_{tot}}  \\Delta t \\\\ -\\frac{K \\Delta t}{M_{tot}}  1 \\end{pmatrix}\n$$\n该格式的稳定性由谱半径 $\\rho_{\\text{mono}} = \\max_i |\\lambda_i(\\mathbf{G}_{\\text{mono}})|$ 决定。由于后向欧拉法是A-稳定方法，我们预期对于任何参数选择和 $\\Delta t  0$，都有 $\\rho_{\\text{mono}} \\le 1$。\n\n### 分区式格式推导\n\n分区式格式将流体反作用力显式处理，并带有一个时间步的延迟。结构方程使用前向欧拉法推进。离散更新方程给出如下：\n\\begin{align*}\nx^{n+1} = x^n + \\Delta t\\,v^n \\\\\nv^{n+1} = v^n + \\Delta t\\,a^n \\\\\na^n = \\frac{-C\\,v^n - K\\,x^n + M_a\\,a^{n-1}}{M_s}\n\\end{align*}\n为了分析稳定性，我们定义一个增广状态向量 $z^n = [x^n, v^n, a^{n-1}]^\\top$。下一个时间步的状态是 $z^{n+1} = [x^{n+1}, v^{n+1}, a^n]^\\top$。我们需要找到一个 $3 \\times 3$ 的放大矩阵 $\\mathbf{G}_{\\text{part}}$，使得 $z^{n+1} = \\mathbf{G}_{\\text{part}} z^n$。\n\n让我们用 $z^n$ 的分量来表示 $z^{n+1}$ 的每个分量：\n1.  对于 $x^{n+1}$：\n    $$\n    x^{n+1} = 1 \\cdot x^n + \\Delta t \\cdot v^n + 0 \\cdot a^{n-1}\n    $$\n2.  对于 $v^{n+1}$：代入 $a^n$ 的表达式。\n    $$\n    v^{n+1} = v^n + \\Delta t \\left( \\frac{-K}{M_s}x^n - \\frac{C}{M_s}v^n + \\frac{M_a}{M_s}a^{n-1} \\right) = -\\frac{K \\Delta t}{M_s}x^n + \\left(1 - \\frac{C \\Delta t}{M_s}\\right)v^n + \\frac{M_a \\Delta t}{M_s}a^{n-1}\n    $$\n3.  对于 $a^n$：表达式已是所需形式。\n    $$\n    a^n = -\\frac{K}{M_s}x^n - \\frac{C}{M_s}v^n + \\frac{M_a}{M_s}a^{n-1}\n    $$\n将这些组合成一个矩阵方程：\n$$\n\\begin{pmatrix} x^{n+1} \\\\ v^{n+1} \\\\ a^n \\end{pmatrix} = \\begin{pmatrix}\n1  \\Delta t  0 \\\\\n-\\frac{K \\Delta t}{M_s}  1 - \\frac{C \\Delta t}{M_s}  \\frac{M_a \\Delta t}{M_s} \\\\\n-\\frac{K}{M_s}  -\\frac{C}{M_s}  \\frac{M_a}{M_s}\n\\end{pmatrix}\n\\begin{pmatrix} x^n \\\\ v^n \\\\ a^{n-1} \\end{pmatrix}\n$$\n因此，分区式格式的放大矩阵为：\n$$\n\\mathbf{G}_{\\text{part}} = \\begin{pmatrix}\n1  \\Delta t  0 \\\\\n-\\frac{K \\Delta t}{M_s}  1 - \\frac{C \\Delta t}{M_s}  \\frac{M_a \\Delta t}{M_s} \\\\\n-\\frac{K}{M_s}  -\\frac{C}{M_s}  \\frac{M_a}{M_s}\n\\end{pmatrix}\n$$\n该格式的稳定性取决于其谱半径 $\\rho_{\\text{part}} = \\max_i |\\lambda_i(\\mathbf{G}_{\\text{part}})|$。众所周知，这种显式耦合容易出现不稳定性，特别是对于大的附加质量比（$M_a/M_s$），这种现象被称为附加质量不稳定性。如果 $\\rho_{\\text{part}}  1$，则该格式是稳定的。\n\n### 稳定性量化\n\n对于每种格式，我们将计算其放大矩阵（$\\mathbf{G}_{\\text{mono}}$ 或 $\\mathbf{G}_{\\text{part}}$）的特征值，并找到其绝对值的最大值以获得谱半径。如果一个格式的谱半径严格小于1，则称其为稳定，我们通过数值方法进行检查。稳定性用标志 $s=1$ 表示稳定，$s=0$ 表示不稳定。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of monolithic and partitioned coupling schemes for a\n    reduced-order fluid-structure interaction model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ms, Ma, C, K, dt)\n    test_cases = [\n        (1.0, 0.5, 0.1, 100.0, 0.005),  # Moderate added mass, small dt\n        (1.0, 5.0, 0.1, 100.0, 0.005),  # Large added mass\n        (1.0, 5.0, 2.0, 100.0, 0.005),  # Large added mass, large damping\n        (1.0, 0.9, 0.0, 100.0, 0.02),   # Low damping, larger dt\n        (1.0, 0.0, 0.0, 100.0, 0.02),   # No fluid/damping edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        Ms, Ma, C, K, dt = case\n\n        # --- Monolithic Scheme Analysis ---\n        # The monolithic scheme uses backward Euler on the coupled system.\n        \n        M_tot = Ms + Ma\n        \n        # Stability is guaranteed if M_tot is not zero, which is ensured by Ms=1.0.\n        if M_tot > 0:\n            # System matrix A for dy/dt = Ay\n            A = np.array([\n                [0, 1],\n                [-K / M_tot, -C / M_tot]\n            ])\n            \n            # Amplification matrix G_mono = (I - dt*A)^-1\n            I = np.identity(2)\n            G_mono = np.linalg.inv(I - dt * A)\n            \n            # Compute spectral radius\n            eigvals_mono = np.linalg.eigvals(G_mono)\n            rho_mono = np.max(np.abs(eigvals_mono))\n        else: # Should not happen with given data\n            rho_mono = np.inf\n            \n        s_mono = 1 if rho_mono  1.0 else 0\n\n        # --- Partitioned Scheme Analysis ---\n        # The partitioned scheme uses an explicit formulation with a lagged added-mass term.\n        # Amplification matrix G_part for z_{n+1} = G_part * z_n\n        \n        # We build the G_part matrix according to the derived formula.\n        G_part = np.array([\n            [1, dt, 0],\n            [-K * dt / Ms, 1 - C * dt / Ms, Ma * dt / Ms],\n            [-K / Ms, -C / Ms, Ma / Ms]\n        ])\n        \n        # Compute spectral radius\n        eigvals_part = np.linalg.eigvals(G_part)\n        rho_part = np.max(np.abs(eigvals_part))\n        s_part = 1 if rho_part  1.0 else 0\n\n        # Store the results for this test case\n        results.append([\n            round(rho_mono, 6),\n            round(rho_part, 6),\n            s_mono,\n            s_part\n        ])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists matches the required format.\n    # Using replace to remove spaces for a compact output.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3496947"}]}