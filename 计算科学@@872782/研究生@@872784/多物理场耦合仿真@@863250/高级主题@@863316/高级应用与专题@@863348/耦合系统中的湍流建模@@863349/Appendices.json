{"hands_on_practices": [{"introduction": "在许多耦合系统中，离散颗粒与湍流的相互作用是一个核心挑战。本练习将引导你通过一个基本但至关重要的无量纲参数——斯托克斯数（Stokes number, $St$）——来量化颗粒的惯性响应。通过计算斯托克斯数 ([@problem_id:3531087])，你将学会如何预测颗粒在湍流中的聚集行为（即“优先浓缩”现象），并理解这对多相流大涡模拟（Large-Eddy Simulation, LES）中的亚格子尺度建模有何重要意义。", "problem": "在用于热-流体耦合模拟的密闭设备中，稀疏分散的重球形颗粒在不可压缩、等温的湍流空气流中被输运。该设备在环境条件下运行，因此空气的动力粘度为 $\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$。颗粒由二氧化硅制成，其材料密度为 $\\rho_{p} = 2000\\ \\mathrm{kg/m^{3}}$，单分散直径为 $d_{p} = 10\\ \\mu\\mathrm{m}$。湍流表现出一个特征涡翻转时间尺度 $\\tau_{t} = 2.0 \\times 10^{-2}\\ \\mathrm{s}$，该值由对含能区的高保真度测量得到。假设颗粒体积分数足够小，以至于颗粒间的相互作用可以忽略不计，并且双向动量耦合在主导阶上不会改变给定的流场时间尺度。同时假设基于滑移速度的颗粒雷诺数远小于1，从而验证了低雷诺数斯托克斯曳力区和点颗粒极限的适用性，并且对于当前配置，附加质量力和Basset历史力可以忽略不计。\n\n从颗粒力平衡的第一性原理和经过充分检验的斯托克斯曳力形式出发，推导颗粒动量弛豫时间，然后计算相对于给定流场时间尺度定义的斯托克斯数。根据您推导出的斯托克斯数，简要讨论优先聚集的预期强度，及其在耦合颗粒-湍流系统的大涡模拟 (LES; Large-Eddy Simulation) 中对亚格子尺度表示的影响。将最终的斯托克斯数表示为一个四舍五入到四位有效数字的纯数；最终的数值答案不应包含单位。", "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n**步骤1：提取已知条件**\n- 空气的动力粘度：$\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$\n- 颗粒材料密度：$\\rho_{p} = 2000\\ \\mathrm{kg/m^{3}}$\n- 颗粒直径 (单分散)：$d_{p} = 10\\ \\mu\\mathrm{m}$\n- 特征涡翻转时间尺度：$\\tau_{t} = 2.0 \\times 10^{-2}\\ \\mathrm{s}$\n- 颗粒体积分数足够小，意味着处于稀疏状态。\n- 颗粒间相互作用可忽略。\n- 双向动量耦合可忽略 (单向耦合)。\n- 基于滑移速度的颗粒雷诺数远小于1 ($Re_p \\ll 1$)。\n- 斯托克斯曳力区适用。\n- 点颗粒极限适用。\n- 附加质量力和Basset历史力可忽略。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了多相流体动力学中的一个经典场景。这些物理假设（稀疏流、单向耦合、低 $Re_p$、重颗粒即 $\\rho_p \\gg \\rho_f$）是为将含颗粒流问题简化为可处理形式的标准做法。所有给定值对于环境条件下空气中的二氧化硅颗粒都是物理上现实的。该问题是适定的，因为它提供了推导颗粒弛豫时间和计算斯托克斯数所需的所有必要信息。所用术语精确且客观。因此，该问题被认定为有效。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n第一个目标是从第一性原理推导颗粒动量弛豫时间 $\\tau_p$。我们考虑流体中单个、微小、重的球形颗粒的运动方程。根据问题陈述，我们只需考虑颗粒的惯性和流体施加的曳力。设 $\\mathbf{u}_p$ 为颗粒的速度，$\\mathbf{u}_f$ 为颗粒所在位置的流体速度。\n\n力平衡由Newton第二定律给出：\n$$m_p \\frac{d\\mathbf{u}_p}{dt} = \\sum \\mathbf{F}_i$$\n其中 $m_p$ 是颗粒的质量，$\\sum \\mathbf{F}_i$ 表示作用在其上的所有力的总和。主要的力是流体动力曳力 $\\mathbf{F}_D$，以及可能存在的体力，如重力。弛豫时间描述了颗粒对周围流体速度变化的响应，因此我们关注耦合颗粒和流体运动的曳力项。\n\n球形颗粒的质量为：\n$$m_p = \\rho_p V_p = \\rho_p \\left( \\frac{\\pi}{6} d_p^3 \\right)$$\n其中 $V_p$ 是颗粒的体积。\n\n问题陈述颗粒雷诺数很低，因此曳力可以由Stokes定律精确描述：\n$$\\mathbf{F}_D = 3 \\pi \\mu d_p (\\mathbf{u}_f - \\mathbf{u}_p)$$\n\n将这些表达式代入运动方程，仅考虑速度弛豫过程中的曳力：\n$$\\rho_p \\left( \\frac{\\pi}{6} d_p^3 \\right) \\frac{d\\mathbf{u}_p}{dt} = 3 \\pi \\mu d_p (\\mathbf{u}_f - \\mathbf{u}_p)$$\n\n为了找到弛豫时间的表达式，我们将此方程重排为一阶线性常微分方程的标准形式：\n$$\\frac{d\\mathbf{u}_p}{dt} = \\frac{3 \\pi \\mu d_p}{\\rho_p (\\frac{\\pi}{6} d_p^3)} (\\mathbf{u}_f - \\mathbf{u}_p)$$\n$$\\frac{d\\mathbf{u}_p}{dt} = \\frac{18 \\mu}{\\rho_p d_p^2} (\\mathbf{u}_f - \\mathbf{u}_p)$$\n\n这个方程可以写成：\n$$\\frac{d\\mathbf{u}_p}{dt} + \\frac{1}{\\tau_p} \\mathbf{u}_p = \\frac{1}{\\tau_p} \\mathbf{u}_f$$\n通过比较这两个方程，我们确定颗粒动量弛豫时间 $\\tau_p$ 是速度项系数的倒数。\n$$\\tau_p = \\frac{\\rho_p d_p^2}{18 \\mu}$$\n这是颗粒与流体之间速度差衰减到其初始值的 $1/e$ 所需的特征时间。此推导完成了问题的第一部分。\n\n接下来，我们使用给定的数据计算 $\\tau_p$ 的数值，确保所有单位都采用国际单位制。\n- $\\rho_p = 2000\\ \\mathrm{kg/m^3}$\n- $d_p = 10\\ \\mu\\mathrm{m} = 10 \\times 10^{-6}\\ \\mathrm{m} = 10^{-5}\\ \\mathrm{m}$\n- $\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$\n\n将这些值代入 $\\tau_p$ 的表达式：\n$$\\tau_p = \\frac{(2000\\ \\mathrm{kg/m^3}) (10^{-5}\\ \\mathrm{m})^2}{18 (1.8 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s})} = \\frac{2 \\times 10^3 \\times 10^{-10}}{32.4 \\times 10^{-5}}\\ \\mathrm{s}$$\n$$\\tau_p = \\frac{2 \\times 10^{-7}}{3.24 \\times 10^{-4}}\\ \\mathrm{s} \\approx 6.1728395 \\times 10^{-4}\\ \\mathrm{s}$$\n\n斯托克斯数 $St$ 是一个无量纲参数，定义为颗粒动量弛豫时间与流场特征时间尺度的比值。在本例中，流场时间尺度是涡翻转时间 $\\tau_t$。\n$$St = \\frac{\\tau_p}{\\tau_t}$$\n\n使用计算出的 $\\tau_p$ 值和给定的 $\\tau_t = 2.0 \\times 10^{-2}\\ \\mathrm{s}$ 值：\n$$St = \\frac{6.1728395 \\times 10^{-4}\\ \\mathrm{s}}{2.0 \\times 10^{-2}\\ \\mathrm{s}} \\approx 0.0308641975$$\n\n按要求将结果四舍五入到四位有效数字，得到：\n$$St \\approx 0.03086$$\n\n最后，我们讨论这一结果的意义。计算出的斯托克斯数 $St \\approx 0.03086$，远小于1 ($St \\ll 1$)。这个值表明，颗粒的动量响应时间远短于湍流中大的含能涡的特征寿命。\n\n1.  **优先聚集的预期强度**：$St \\ll 1$ 的颗粒惯性低，倾向于非常忠实地跟随流体流动，充当准示踪物。优先聚集现象，即惯性颗粒从高涡量区域（涡核）被离心出来，并聚集在高应变率区域（涡间）的现象，对于 $St \\approx 1$ 的颗粒最为显著。对于计算出的 $St \\ll 1$，在与 $\\tau_t$ 相关联的尺度上，优先聚集的趋势预计会很弱。颗粒的空间分布将接近均匀，尽管并非完全均匀。\n\n2.  **对LES中亚格子尺度 (SGS) 表示的影响**：在大涡模拟中，湍流流场被分解为解析尺度（大于网格滤波宽度 $\\Delta$）和亚格子尺度（小于 $\\Delta$）。时间尺度 $\\tau_t$ 对应于解析的含能区。相对于 $\\tau_t$ 而言 $St \\ll 1$ 这一事实意味着颗粒的运动与解析速度场良好耦合，这简化了建模。然而，颗粒与未解析的亚格子尺度涡的相互作用是一个关键问题。SGS涡的时间尺度小于 $\\tau_t$。虽然与大涡相比，颗粒的惯性很小，但与流场中的最小时间尺度——Kolmogorov时间尺度 $\\tau_{\\eta}$ 相比，它可能并不小。如果 $\\tau_p$ 与SGS时间尺度同阶，颗粒将经历亚格子尺度的优先聚集，并且颗粒“看到”的流体速度将不同于LES提供的滤波后速度。因此，对该系统进行精确的LES将需要一个亚格子尺度模型，该模型要能解释未解析的流体速度脉动对颗粒轨迹的影响，例如，通过随机模型或SGS场的动态重构。忽略SGS对颗粒曳力的贡献可能会导致在预测颗粒弥散和分布时出现错误。", "answer": "$$\\boxed{0.03086}$$", "id": "3531087"}, {"introduction": "在耦合仿真中，如何处理不同物理域之间的界面是一个关键的建模决策。本练习聚焦于流固耦合传热问题，要求你评估固体壁面的热阻相对于近壁流体热阻的重要性 ([@problem_id:3531091])。通过计算一个简单的决策度量，你将能够判断何时可以使用计算成本较低的壁面函数方法，以及何时必须采用更精确的共轭传热（Conjugate Heat Transfer, CHT）模型来求解，这对于高效而准确地建立热仿真模型至关重要。", "problem": "在一个流固耦合系统中，考虑一个湍流传热情景。该系统在雷诺平均纳维-斯托克斯 (RANS) 框架下，使用近壁单元和近壁函数进行求解。在一个光滑平坦的壁面上施加均匀热通量 $q''$，该壁面是厚度为 $t$、导热系数为 $k_s$ 的固体与湍流空气流的交界面。第一个流体单元中心距离壁面的物理距离为 $y$，其无量纲壁面距离为 $y^+$，定义为 $y^+ = y u_{\\tau} / \\nu$，其中 $u_{\\tau}$ 是摩擦速度，$\\nu$ 是运动粘度。近壁湍流热输运通过有效导热系数 $k_{\\text{eff}} = k_f + k_t$ 进行建模，其中 $k_f$ 是流体导热系数，$k_t = \\mu_t c_p / \\mathrm{Pr}_t$ 是湍流导热系数，湍流粘度由混合长度模型 $\\mu_t = \\rho \\kappa u_{\\tau} y$ 给出。参数如下：\n- $q'' = 1.5 \\times 10^{3}$，\n- $t = 3.0 \\times 10^{-3}$，\n- $k_s = 16$，\n- $y = 5.0 \\times 10^{-4}$，\n- $y^+ = 35$，\n- $\\rho = 1.2$，\n- $\\mu = 1.8 \\times 10^{-5}$，\n- $k_f = 2.6 \\times 10^{-2}$，\n- $c_p = 1.005 \\times 10^{3}$，\n- $\\mathrm{Pr}_t = 0.90$，\n- $\\kappa = 0.41$，\n其中所有量均采用国际单位制。运动粘度为 $\\nu = \\mu / \\rho$。假设固体中为一维稳态导热，并且从壁面到湍流单元中心的温降可通过 $\\Delta T_f = q'' y / k_{\\text{eff}}$ 估算。定义用于判断壁面模型适用性的决策度量为 $M = \\Delta T_s / \\Delta T_f$，其中 $\\Delta T_s = q'' t / k_s$。较小的 $M$ 值意味着固体的热阻相对于流体侧近壁热阻可以忽略不计；使用以下准则：如果 $M  0.1$，则壁面函数处理是足够的；如果 $M \\ge 0.1$，则推荐进行完全共轭传热解析。使用给定数据计算 $M$。将最终答案四舍五入到三位有效数字。最终答案是无量纲的，因此答案框中不需要填写单位。", "solution": "该问题要求计算一个无量纲决策度量 $M$，用于评估在湍流共轭传热情景中壁面函数处理的适用性。该度量定义为固体温降 $\\Delta T_s$ 与近壁流体单元温降 $\\Delta T_f$ 的比值。\n\n该度量的定义如下：\n$$\nM = \\frac{\\Delta T_s}{\\Delta T_f}\n$$\n\n固体温降 $\\Delta T_s$ 是由一维稳态热传导引起的，定义为：\n$$\n\\Delta T_s = \\frac{q'' t}{k_s}\n$$\n其中 $q''$ 是均匀热通量，$t$ 是固体厚度，$k_s$ 是固体导热系数。\n\n近壁流体单元的温降 $\\Delta T_f$ 估算如下：\n$$\n\\Delta T_f = \\frac{q'' y}{k_{\\text{eff}}}\n$$\n其中 $y$ 是单元中心到壁面的距离，$k_{\\text{eff}}$ 是单元内的有效导热系数。\n\n将这些定义代入 $M$ 的表达式，得到：\n$$\nM = \\frac{q'' t / k_s}{q'' y / k_{\\text{eff}}} = \\frac{t}{y} \\frac{k_{\\text{eff}}}{k_s}\n$$\n\n有效导热系数 $k_{\\text{eff}}$ 是流体的分子导热系数 $k_f$ 和湍流导热系数 $k_t$ 的和：\n$$\nk_{\\text{eff}} = k_f + k_t\n$$\n\n湍流导热系数 $k_t$ 使用湍流普朗特数 $\\mathrm{Pr}_t$ 建模如下：\n$$\nk_t = \\frac{\\mu_t c_p}{\\mathrm{Pr}_t}\n$$\n其中 $\\mu_t$ 是湍流粘度，$c_p$ 是流体的定压比热容。\n\n湍流粘度 $\\mu_t$ 由混合长度模型给出：\n$$\n\\mu_t = \\rho \\kappa u_{\\tau} y\n$$\n其中 $\\rho$ 是流体密度，$\\kappa$ 是 von Kármán 常数，$u_{\\tau}$ 是摩擦速度。\n\n为了求得 $\\mu_t$，我们必须首先确定摩擦速度 $u_{\\tau}$。无量纲壁面距离 $y^+$ 定义为：\n$$\ny^+ = \\frac{y u_{\\tau}}{\\nu}\n$$\n其中 $\\nu$ 是流体的运动粘度。运动粘度与动力粘度 $\\mu$ 和密度 $\\rho$ 的关系为 $\\nu = \\mu/\\rho$。将其代入 $y^+$ 的定义中，得到：\n$$\ny^+ = \\frac{y u_{\\tau} \\rho}{\\mu}\n$$\n我们可以重新整理这个方程来求解 $u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{y^+ \\mu}{y \\rho}\n$$\n现在，我们将 $u_{\\tau}$ 的表达式代入 $\\mu_t$ 的公式中：\n$$\n\\mu_t = \\rho \\kappa y \\left( \\frac{y^+ \\mu}{y \\rho} \\right) = \\kappa y^+ \\mu\n$$\n接下来，我们将这个简化的 $\\mu_t$ 表达式代入 $k_t$ 的公式中：\n$$\nk_t = \\frac{(\\kappa y^+ \\mu) c_p}{\\mathrm{Pr}_t} = \\frac{\\kappa y^+ \\mu c_p}{\\mathrm{Pr}_t}\n$$\n利用这个结果，我们可以完全用给定参数来表示 $k_{\\text{eff}}$：\n$$\nk_{\\text{eff}} = k_f + \\frac{\\kappa y^+ \\mu c_p}{\\mathrm{Pr}_t}\n$$\n最后，我们将这个完整的 $k_{\\text{eff}}$ 表达式代入 $M$ 的方程中：\n$$\nM = \\frac{t}{y k_s} \\left( k_f + \\frac{\\kappa y^+ \\mu c_p}{\\mathrm{Pr}_t} \\right)\n$$\n现在我们代入所提供的数值，所有数值均采用国际单位制：\n- $t = 3.0 \\times 10^{-3}$\n- $y = 5.0 \\times 10^{-4}$\n- $k_s = 16$\n- $k_f = 2.6 \\times 10^{-2}$\n- $\\kappa = 0.41$\n- $y^+ = 35$\n- $\\mu = 1.8 \\times 10^{-5}$\n- $c_p = 1.005 \\times 10^{3}$\n- $\\mathrm{Pr}_t = 0.90$\n\n首先，我们计算湍流导热系数 $k_t$：\n$$\nk_t = \\frac{0.41 \\times 35 \\times (1.8 \\times 10^{-5}) \\times (1.005 \\times 10^{3})}{0.90}\n$$\n$$\nk_t = \\frac{(2.583 \\times 10^{-4}) \\times (1.005 \\times 10^{3})}{0.90} = \\frac{0.2595915}{0.90} \\approx 0.288435 \\, \\text{W/(m K)}\n$$\n接下来，我们计算有效导热系数 $k_{\\text{eff}}$：\n$$\nk_{\\text{eff}} = k_f + k_t = 2.6 \\times 10^{-2} + 0.288435 = 0.026 + 0.288435 = 0.314435 \\, \\text{W/(m K)}\n$$\n现在，我们可以使用简化后的表达式计算 $M$ 的值：\n$$\nM = \\frac{t}{y} \\frac{k_{\\text{eff}}}{k_s} = \\left( \\frac{3.0 \\times 10^{-3}}{5.0 \\times 10^{-4}} \\right) \\left( \\frac{0.314435}{16} \\right)\n$$\n$$\nM = 6 \\times \\left( \\frac{0.314435}{16} \\right) = \\frac{1.88661}{16} \\approx 0.117913125\n$$\n题目要求将最终答案四舍五入到三位有效数字。\n$$\nM \\approx 0.118\n$$\n根据题目的准则 ($M \\ge 0.1$)，这个结果表明，与近壁流体热阻相比，固体的热阻是显著的，推荐进行完全共轭传热解析。本任务是计算 $M$。", "answer": "$$\\boxed{0.118}$$", "id": "3531091"}, {"introduction": "成功的耦合仿真不仅在于建立模型，更在于验证其结果的物理一致性和数值准确性。本练习将带你扮演“仿真诊断师”的角色，通过检查湍动能（Turbulent Kinetic Energy, TKE）输运方程的闭合性以及热浮力耦合关系的自洽性，来评估一组模拟数据的可靠性 ([@problem_id:3531071])。掌握这种诊断能力，将使你能够识别出模型假设或数值方法中可能存在的根本性问题，这是成为一名高级计算科学家所必备的核心技能。", "problem": "考虑一个在 Boussinesq 近似下的垂直一维、水平均匀、不可压缩流，该流动使用雷诺平均 Navier-Stokes (RANS) 框架进行建模。设高度坐标 $z$ 处的湍流动能 (TKE) 收支由以下平衡关系给出\n$$\n\\frac{\\partial k}{\\partial t} \\;=\\; P \\;+\\; B \\;-\\; \\varepsilon \\;-\\; \\frac{\\partial F_k}{\\partial z},\n$$\n其中 $k$ 是湍流动能，$P$ 是剪切产生率，$B$ 是浮力产生率，$\\varepsilon$ 是耗散率，$F_k$ 是 $k$ 的垂直湍流输送。在 Boussinesq 近似下，浮力产生项满足\n$$\nB \\;=\\; \\frac{g}{\\theta_0}\\,\\langle w'\\theta'\\rangle \\;=\\; \\gamma\\,q,\n$$\n其中 $g$ 是重力加速度，$\\theta_0$ 是一个恒定的参考位温，$\\gamma \\equiv g/\\theta_0$，$\\langle w'\\theta'\\rangle$ 是垂直湍流热通量，$q$ 为简洁起见表示相同的湍流热通量。\n\n给定多个高度 $z$ 上的 $P$、$\\varepsilon$、$B$、垂直散度 $\\partial F_k/\\partial z$ 和局地时间倾向 $S \\equiv \\partial k/\\partial t$ 的廓线，以及湍流热通量 $q$。你的任务是实现两个定量诊断：\n\n$1.$ 一个 TKE 收支闭合诊断，计算为相对残差\n$$\n\\mathcal{M}_k \\;=\\; \\frac{\\left\\|\\, R_k \\,\\right\\|_2}{\\max\\!\\left(\\,\\left\\|P\\right\\|_2 \\;+\\; \\left\\|B\\right\\|_2 \\;+\\; \\left\\|\\varepsilon\\right\\|_2 \\;+\\; \\left\\|\\partial_z F_k\\right\\|_2,\\; \\delta\\right)},\n$$\n其中\n$$\nR_k \\;=\\; S \\;-\\; \\Big(P \\;+\\; B \\;-\\; \\varepsilon \\;-\\; \\partial_z F_k\\Big),\n$$\n$\\left\\|\\cdot\\right\\|_2$ 表示欧几里得范数，$\\delta$ 是一个微小正常数，用于避免除以零。如果 $\\mathcal{M}_k \\le \\tau_k$，则认为 TKE 收支是闭合的，容差 $\\tau_k$ 在下面指定。\n\n$2.$ 一个浮力-热通量耦合诊断，通过最大相对差异来逐点检查与 Boussinesq 一致的关系 $B=\\gamma q$\n$$\n\\mathcal{M}_b \\;=\\; \\max_i \\frac{\\left|\\, B_i \\;-\\; \\gamma\\,q_i \\,\\right|}{\\max\\!\\left(\\left|\\,\\gamma\\,q_i\\,\\right|,\\; \\eta\\right)},\n$$\n其中指数 $i$ 遍历所有垂直层次，$\\eta$ 是一个微小正常数，用于避免除以零。如果 $\\mathcal{M}_b \\le \\tau_b$，则认为耦合是一致的，容差 $\\tau_b$ 在下面指定。\n\n此外，对所有垂直层次 $i$ 强制执行物理可实现性条件 $\\varepsilon_i \\ge 0$。\n\n一个测试用例通过当且仅当以下三个条件同时满足：\n- TKE 收支闭合：$\\mathcal{M}_k \\le \\tau_k$，\n- 浮力-热通量耦合：$\\mathcal{M}_b \\le \\tau_b$，\n- 耗散率非负性：对所有 $i$ 都有 $\\varepsilon_i \\ge 0$。\n\n使用以下常数、单位、容差和测试套件。所有数组都按 $z$ 从低到高的顺序排列，并使用所述单位：\n- 常数: $g = 9.81\\,\\mathrm{m\\,s^{-2}}$, $\\theta_0 = 300\\,\\mathrm{K}$, $\\gamma = g/\\theta_0$, $\\delta = 10^{-12}$, $\\eta = 10^{-12}$, $\\tau_k = 10^{-3}$, $\\tau_b = 10^{-3}$。\n- 单位: $P$、$B$、$\\varepsilon$、$\\partial_z F_k$ 和 $S$ 的单位是 $\\mathrm{m^2\\,s^{-3}}$。湍流热通量 $q$ 的单位是 $\\mathrm{K\\,m\\,s^{-1}}$。\n- 角度单位不适用。\n\n包含三个用例的测试套件（每个用例提供 $P$、$\\varepsilon$、$q$、$B$、$\\partial_z F_k$、$S$）：\n\n用例 A (代表性的适定稳态情况):\n- $P = [\\,0.20,\\;0.25,\\;0.30,\\;0.20,\\;0.10\\,]$\n- $\\varepsilon = [\\,0.18,\\;0.24,\\;0.29,\\;0.19,\\;0.11\\,]$\n- $q = [\\,0.05,\\;0.06,\\;0.07,\\;0.05,\\;0.03\\,]$\n- $B = [\\,0.001635,\\;0.001962,\\;0.002289,\\;0.001635,\\;0.000981\\,]$\n- $\\partial_z F_k = [\\,0.021635,\\;0.011962,\\;0.012289,\\;0.011635,\\;-0.009019\\,]$\n- $S = [\\,0.0,\\;0.0,\\;0.0,\\;0.0,\\;0.0\\,]$\n\n用例 B (非零局地倾向和浮力-热通量关系中的微小舍入扰动):\n- $P = [\\,0.15,\\;0.18,\\;0.22,\\;0.20,\\;0.12\\,]$\n- $\\varepsilon = [\\,0.14,\\;0.19,\\;0.21,\\;0.19,\\;0.13\\,]$\n- $q = [\\,0.04,\\;0.05,\\;0.06,\\;0.05,\\;0.04\\,]$\n- $B = [\\,0.0013081,\\;0.0016349,\\;0.0019621,\\;0.0016349,\\;0.0013081\\,]$\n- $\\partial_z F_k = [\\,0.0112081,\\;-0.0082651,\\;0.0117621,\\;0.0118349,\\;-0.0086919\\,]$\n- $S = [\\,0.0001,\\;-0.0001,\\;0.0002,\\;-0.0002,\\;0.0\\,]$\n\n用例 C (不一致的耦合和违反耗散可实现性):\n- $P = [\\,0.10,\\;0.12,\\;0.11,\\;0.09,\\;0.08\\,]$\n- $\\varepsilon = [\\,0.09,\\;0.13,\\;-0.05,\\;0.08,\\;0.07\\,]$\n- $q = [\\,0.03,\\;0.02,\\;0.01,\\;0.0,\\;-0.01\\,]$\n- $B = [\\,0.0011772,\\;0.0007848,\\;0.0003924,\\;0.0,\\;-0.0003924\\,]$\n- $\\partial_z F_k = [\\,0.0141772,\\;-0.0062152,\\;0.1633924,\\;0.013,\\;0.0126076\\,]$\n- $S = [\\,0.0,\\;0.0,\\;0.0,\\;0.0,\\;0.0\\,]$\n\n你的程序必须为每个用例实现上述定义的诊断，并为每个用例返回一个通过/失败指示符：如果用例通过所有检查，则返回 $1$，否则返回 $0$。\n\n最终输出格式：你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$ [r_1,r_2,r_3] $，其中每个 $r_i$ 是一个整数）。不应打印其他任何文本。输出没有要求的物理单位，因为它仅由整数组成。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它以流体动力学和湍流建模的原理为科学基础，特别是雷诺平均 Navier-Stokes (RANS) 框架。这个问题是适定的，为所需的诊断提供了所有必要的数据、常数和无歧义的数学定义。其语言是客观的，任务是计算流体动力学中的一个标准验证程序。解决方案将通过实现指定的诊断检查来进行。\n\n任务的核心是针对三个不同的测试用例，验证代表一维大气流动的数据的物理和数值一致性。此验证基于三个条件：湍流耗散率的物理可实现性，Boussinesq 近似下热力学耦合的一致性，以及湍流动能 (TKE) 收支的闭合。一个用例当且仅当所有三个条件都满足时才能通过。\n\nTKE（用 $k$ 表示）的控制方程给出如下：\n$$\n\\frac{\\partial k}{\\partial t} = S = P + B - \\varepsilon - \\frac{\\partial F_k}{\\partial z}\n$$\n此处，$S$ 是 $k$ 的局地时间倾向，$P$ 是剪切产生率，$B$ 是浮力产生率，$\\varepsilon$ 是耗散率，而 $\\frac{\\partial F_k}{\\partial z}$ 是 $k$ 的垂直湍流输送的散度。\n\n该分析通过一系列源自物理原理和所提供诊断定义的算法检查来实现。\n\n1.  **耗散率非负性检查 ($\\varepsilon \\ge 0$)**：湍流耗散率 $\\varepsilon$ 表示湍流动能转化为内能的速率。根据热力学第二定律，这个过程是不可逆的，$\\varepsilon$ 在流场中的所有点都必须是非负的。第一个检查是这个物理约束的直接实现，该约束被称为可实现性条件。对于给定廓线中的每个垂直层次 $i$，我们验证 $\\varepsilon_i \\ge 0$。如果发现任何 $\\varepsilon_i$ 为负，则整个用例将被标记为物理上不可实现，并测试失败。\n\n2.  **浮力-热通量耦合诊断 ($\\mathcal{M}_b$)**：Boussinesq 近似导致浮力产生项 $B$ 与垂直湍流热通量 $q \\equiv \\langle w'\\theta'\\rangle$ 之间存在直接关系。此关系为 $B = \\gamma q$，其中 $\\gamma = g/\\theta_0$ 是一个基于重力加速度 $g$ 和参考位温 $\\theta_0$ 的常数。第二个诊断 $\\mathcal{M}_b$ 量化了所提供数据对该耦合原理的遵守程度。它被计算为所有垂直层次 $i$ 上的最大相对差异：\n    $$\n    \\mathcal{M}_b = \\max_i \\frac{\\left|\\, B_i - \\gamma q_i \\,\\right|}{\\max\\!\\left(\\left|\\,\\gamma q_i\\,\\right|,\\; \\eta\\right)}\n    $$\n    微小常数 $\\eta$（给定为 $10^{-12}$）通过防止在热通量消失的区域中出现除以零的情况来确保数值稳定性。如果这个最大相对误差 $\\mathcal{M}_b$ 小于或等于指定的容差 $\\tau_b = 10^{-3}$，则认为该耦合是一致的。\n\n3.  **TKE 收支闭合诊断 ($\\mathcal{M}_k$)**：一个有效的模拟必须满足 TKE 收支方程。第三个诊断 $\\mathcal{M}_k$ 评估所提供数据平衡此方程的程度。我们首先计算残差向量 $R_k$，它表示 TKE 收支中的逐点不平衡：\n    $$\n    R_k = S - \\Big(P + B - \\varepsilon - \\frac{\\partial F_k}{\\partial z}\\Big)\n    $$\n    一个完美的平衡将得出 $R_k = 0$。诊断 $\\mathcal{M}_k$ 是此残差向量的欧几里得范数（或 $L_2$-范数），经过归一化以创建收支不平衡的相对度量。归一化因子是收支方程中所有源项、汇项和输送项的范数之和。\n    $$\n    \\mathcal{M}_k = \\frac{\\left\\| R_k \\right\\|_2}{\\max\\!\\left(\\left\\|P\\right\\|_2 + \\left\\|B\\right\\|_2 + \\left\\|\\varepsilon\\right\\|_2 + \\left\\|\\partial_z F_k\\right\\|_2, \\; \\delta\\right)}\n    $$\n    微小常数 $\\delta$（给定为 $10^{-12}$）防止在收支中的所有项碰巧为零时出现除以零的情况。如果 $\\mathcal{M}_k$ 小于或等于容差 $\\tau_k = 10^{-3}$，则认为 TKE 收支是闭合的。\n\n如果一个测试用例满足所有三个条件：对所有 $i$ 都有 $\\varepsilon_i \\ge 0$、$\\mathcal{M}_b \\le \\tau_b$ 和 $\\mathcal{M}_k \\le \\tau_k$，则该用例获得最终分数 $1$（通过）。否则，它获得分数 $0$（失败）。该过程将应用于所提供的三个测试用例中的每一个。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates turbulence simulation data against physical and numerical consistency checks.\n    \"\"\"\n    \n    # Define constants and tolerances from the problem statement.\n    g = 9.81  # m/s^2\n    theta_0 = 300.0  # K\n    gamma = g / theta_0  # m/(s^2 * K)\n    delta = 1e-12\n    eta = 1e-12\n    tau_k = 1e-3\n    tau_b = 1e-3\n\n    # Define the test cases as tuples of numpy arrays.\n    # The order of arrays in each tuple is: (P, epsilon, q, B, dFk_dz, S)\n    test_cases = [\n        # Case A\n        (\n            np.array([0.20, 0.25, 0.30, 0.20, 0.10]),\n            np.array([0.18, 0.24, 0.29, 0.19, 0.11]),\n            np.array([0.05, 0.06, 0.07, 0.05, 0.03]),\n            np.array([0.001635, 0.001962, 0.002289, 0.001635, 0.000981]),\n            np.array([0.021635, 0.011962, 0.012289, 0.011635, -0.009019]),\n            np.array([0.0, 0.0, 0.0, 0.0, 0.0])\n        ),\n        # Case B\n        (\n            np.array([0.15, 0.18, 0.22, 0.20, 0.12]),\n            np.array([0.14, 0.19, 0.21, 0.19, 0.13]),\n            np.array([0.04, 0.05, 0.06, 0.05, 0.04]),\n            np.array([0.0013081, 0.0016349, 0.0019621, 0.0016349, 0.0013081]),\n            np.array([0.0112081, -0.0082651, 0.0117621, 0.0118349, -0.0086919]),\n            np.array([0.0001, -0.0001, 0.0002, -0.0002, 0.0])\n        ),\n        # Case C\n        (\n            np.array([0.10, 0.12, 0.11, 0.09, 0.08]),\n            np.array([0.09, 0.13, -0.05, 0.08, 0.07]),\n            np.array([0.03, 0.02, 0.01, 0.0, -0.01]),\n            np.array([0.0011772, 0.0007848, 0.0003924, 0.0, -0.0003924]),\n            np.array([0.0141772, -0.0062152, 0.1633924, 0.013, 0.0126076]),\n            np.array([0.0, 0.0, 0.0, 0.0, 0.0])\n        )\n    ]\n\n    def evaluate_case(P, eps, q, B, dFk_dz, S):\n        \"\"\"\n        Evaluates a single test case against the three required conditions.\n\n        Args:\n            P, eps, q, B, dFk_dz, S (np.ndarray): Arrays of profile data.\n\n        Returns:\n            int: 1 if the case passes all checks, 0 otherwise.\n        \"\"\"\n        # 1. Dissipation nonnegativity check (physical realizability)\n        dissipation_ok = np.all(eps >= 0)\n\n        # 2. Buoyancy-heat-flux coupling check\n        gamma_q = gamma * q\n        numerator_b = np.abs(B - gamma_q)\n        denominator_b = np.maximum(np.abs(gamma_q), eta)\n        discrepancies_b = numerator_b / denominator_b\n        M_b = np.max(discrepancies_b)\n        coupling_ok = M_b = tau_b\n\n        # 3. TKE budget-closure check\n        R_k = S - (P + B - eps - dFk_dz)\n        norm_R_k = np.linalg.norm(R_k)\n        \n        denominator_k_terms = (\n            np.linalg.norm(P) + \n            np.linalg.norm(B) + \n            np.linalg.norm(eps) + \n            np.linalg.norm(dFk_dz)\n        )\n        denominator_k = np.maximum(denominator_k_terms, delta)\n        M_k = norm_R_k / denominator_k\n        closure_ok = M_k = tau_k\n\n        # Final pass/fail decision\n        if dissipation_ok and coupling_ok and closure_ok:\n            return 1\n        else:\n            return 0\n\n    results = []\n    for case_data in test_cases:\n        result = evaluate_case(*case_data)\n        results.append(result)\n\n    # Print the final results in the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3531071"}]}