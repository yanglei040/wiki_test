{"hands_on_practices": [{"introduction": "任何离散元方法（DEM）模拟的核心在于接触模型，它决定了颗粒间的相互作用力。本练习将重点关注一个基本方面：计算一个颗粒与连续介质边界接触时，在库仑摩擦定律约束下的切向力。通过实践一个典型的预测-校正算法来处理弹塑性摩擦行为，您将掌握在模拟中实现真实颗粒间滑移的关键技能。[@problem_id:3504405]", "problem": "一个通过离散元法（DEM, Discrete Element Method）建模的单一球形颗粒与一个光滑的弹性连续体边界接触。该接触的特征在于：法向力 $\\|F_n\\|$ 从连续体传递到颗粒；以及切向微滑移响应，该响应由一个刚度为 $k_t$ 的线性弹性切向弹簧捕捉，直到一个由库仑摩擦定律控制的滑移条件将切向力的大小限制在 $\\mu \\|F_n\\|$ 以内。该颗粒在接触点还受到滚动阻力，其模型为一个与法向力、有效接触半径 $R^\\ast$ 以及滚动旋转增量的大小 $\\|\\Delta \\theta_r\\|$ 成正比的扭矩，比例系数为 $k_r$。假设接触点位于边界的局部平坦部分，并且连续体边界足够刚性，以至于球-面接触的有效接触半径简化为颗粒半径。\n\n颗粒半径为 $R = 0.015$ $\\mathrm{m}$，当前法向力大小为 $\\|F_n\\| = 50$ $\\mathrm{N}$。摩擦系数为 $\\mu = 0.4$，切向刚度为 $k_t = 5.0 \\times 10^{5}$ $\\mathrm{N/m}$，滚动阻力系数为 $k_r = 0.05$。在接触点的局部切向平面内，前一个时间步的切向力为 $F_t^{\\mathrm{old}} = (15,\\,0)$ $\\mathrm{N}$。在当前时间增量内，切向相对位移增量为 $\\Delta u_t = (2.0 \\times 10^{-5},\\,-1.0 \\times 10^{-5})$ $\\mathrm{m}$。滚动旋转增量的大小为 $\\|\\Delta \\theta_r\\| = 0.02$ $\\mathrm{rad}$。\n\n从接触力学和摩擦滑移的第一性原理（切向弹簧的胡克定律、牛顿定律和库仑摩擦上限）出发，并取球-面接触的 $R^\\ast = R$，确定：\n- 在施加弹性增量并强制执行库仑上限后，更新的切向力矢量 $F_t$，以及\n- 滚动阻力扭矩 $M_r$。\n\n将 $F_t$ 的每个分量和扭矩 $M_r$ 四舍五入到四位有效数字。力以 $\\mathrm{N}$ 表示，扭矩以 $\\mathrm{N \\cdot m}$ 表示。以一个行矩阵的形式提供最终答案，其中包含 $F_t$ 的两个分量，后跟 $M_r$。角度必须以弧度处理。", "solution": "该问题要求在离散元法（DEM）框架内，计算颗粒与边界相互作用的更新后的切向接触力和滚动阻力扭矩。该问题提法恰当且科学合理，提供了所有必要的参数和对物理模型的清晰描述。求解过程分为两部分：首先计算切向力，然后计算滚动阻力扭矩。\n\n**第1部分：计算更新后的切向力 $F_t$**\n\n切向力的接触模型是一个带有滑移条件的线性弹性弹簧，该滑移条件由库仑摩擦定律控制。这是一个使用预测-校正方案求解的标准弹塑性模型。\n\n**步骤1.1：弹性预测**\n\n首先，通过假设纯弹性增量来计算试探切向力 $F_t^{\\mathrm{trial}}$。根据胡克定律，切向力增量 $\\Delta F_t$ 由切向刚度 $k_t$ 和切向相对位移增量 $\\Delta u_t$ 决定：\n$$\n\\Delta F_t = k_t \\Delta u_t\n$$\n给定值为 $k_t = 5.0 \\times 10^{5}$ $\\mathrm{N/m}$ 和 $\\Delta u_t = (2.0 \\times 10^{-5},\\,-1.0 \\times 10^{-5})$ $\\mathrm{m}$。\n$$\n\\Delta F_t = (5.0 \\times 10^{5}) \\begin{pmatrix} 2.0 \\times 10^{-5} \\\\ -1.0 \\times 10^{-5} \\end{pmatrix} = \\begin{pmatrix} (5.0 \\times 10^{5}) \\cdot (2.0 \\times 10^{-5}) \\\\ (5.0 \\times 10^{5}) \\cdot (-1.0 \\times 10^{-5}) \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ -5 \\end{pmatrix} \\, \\mathrm{N}\n$$\n试探切向力是前一个时间步的力 $F_t^{\\mathrm{old}}$ 与此弹性增量之和：\n$$\nF_t^{\\mathrm{trial}} = F_t^{\\mathrm{old}} + \\Delta F_t\n$$\n已知 $F_t^{\\mathrm{old}} = (15,\\,0)$ $\\mathrm{N}$，试探力为：\n$$\nF_t^{\\mathrm{trial}} = \\begin{pmatrix} 15 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 10 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ -5 \\end{pmatrix} \\, \\mathrm{N}\n$$\n\n**步骤1.2：检查滑移条件**\n\n接下来，必须将试探力的大小 $\\|F_t^{\\mathrm{trial}}\\|$ 与由库仑摩擦极限 $F_t^{\\mathrm{max}}$ 定义的最大允许切向力进行比较。摩擦极限与法向力的大小 $\\|F_n\\|$ 成正比，比例常数为摩擦系数 $\\mu$。\n$$\nF_t^{\\mathrm{max}} = \\mu \\|F_n\\|\n$$\n使用给定值 $\\mu = 0.4$ 和 $\\|F_n\\| = 50$ $\\mathrm{N}$：\n$$\nF_t^{\\mathrm{max}} = 0.4 \\times 50 = 20 \\, \\mathrm{N}\n$$\n试探力的大小为：\n$$\n\\|F_t^{\\mathrm{trial}}\\| = \\sqrt{(25)^2 + (-5)^2} = \\sqrt{625 + 25} = \\sqrt{650} \\, \\mathrm{N}\n$$\n数值上，$\\|F_t^{\\mathrm{trial}}\\| \\approx 25.495$ $\\mathrm{N}$。\n\n**步骤1.3：校正（强制滑移）**\n\n我们将试探力的大小与摩擦极限进行比较：\n$$\n\\|F_t^{\\mathrm{trial}}\\| \\approx 25.495 \\, \\mathrm{N}  F_t^{\\mathrm{max}} = 20 \\, \\mathrm{N}\n$$\n由于试探力超过了摩擦极限，因此发生滑移。最终的切向力 $F_t$ 必须被投影回摩擦锥上。这意味着其大小必须等于 $F_t^{\\mathrm{max}}$，并且其方向必须与试探力的方向相同。\n$$\nF_t = F_t^{\\mathrm{max}} \\frac{F_t^{\\mathrm{trial}}}{\\|F_t^{\\mathrm{trial}}\\|}\n$$\n代入计算出的值：\n$$\nF_t = 20 \\cdot \\frac{\\begin{pmatrix} 25 \\\\ -5 \\end{pmatrix}}{\\sqrt{650}} = \\begin{pmatrix} \\frac{20 \\cdot 25}{\\sqrt{650}} \\\\ \\frac{20 \\cdot (-5)}{\\sqrt{650}} \\end{pmatrix} = \\begin{pmatrix} \\frac{500}{\\sqrt{650}} \\\\ \\frac{-100}{\\sqrt{650}} \\end{pmatrix} \\, \\mathrm{N}\n$$\n现在我们计算数值并按照问题要求将其四舍五入到四位有效数字。\n$$\nF_{t,x} = \\frac{500}{\\sqrt{650}} \\approx 19.61161 \\, \\mathrm{N} \\implies 19.61 \\, \\mathrm{N}\n$$\n$$\nF_{t,y} = \\frac{-100}{\\sqrt{650}} \\approx -3.92232 \\, \\mathrm{N} \\implies -3.922 \\, \\mathrm{N}\n$$\n因此，更新后的切向力矢量为 $F_t = (19.61, -3.922)$ $\\mathrm{N}$。\n\n**第2部分：计算滚动阻力扭矩 $M_r$**\n\n问题将滚动阻力扭矩定义为与法向力 $\\|F_n\\|$、有效接触半径 $R^\\ast$、滚动旋转增量的大小 $\\|\\Delta \\theta_r\\|$ 以及滚动阻力系数 $k_r$ 成正比。问题明确指出取 $R^\\ast = R$。滚动阻力扭矩 $M_r$ 的大小的公式为：\n$$\nM_r = k_r \\|F_n\\| R^\\ast \\|\\Delta \\theta_r\\| = k_r \\|F_n\\| R \\|\\Delta \\theta_r\\|\n$$\n问题提供了以下数值：\n$k_r = 0.05$\n$\\|F_n\\| = 50$ $\\mathrm{N}$\n$R = 0.015$ $\\mathrm{m}$\n$\\|\\Delta \\theta_r\\| = 0.02$ $\\mathrm{rad}$\n\n将这些值代入公式：\n$$\nM_r = (0.05) \\cdot (50) \\cdot (0.015) \\cdot (0.02) \\, \\mathrm{N \\cdot m}\n$$\n$$\nM_r = (2.5) \\cdot (0.015) \\cdot (0.02) = (0.0375) \\cdot (0.02) = 0.00075 \\, \\mathrm{N \\cdot m}\n$$\n四舍五入到四位有效数字：\n$$\nM_r = 0.0007500 \\, \\mathrm{N \\cdot m}\n$$\n最终结果，四舍五入到四位有效数字，是切向力矢量 $F_t = (19.61, -3.922)$ $\\mathrm{N}$ 的分量和滚动阻力扭矩的大小 $M_r = 0.0007500$ $\\mathrm{N \\cdot m}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 19.61  -3.922  0.0007500 \\end{pmatrix}}\n$$", "id": "3504405"}, {"introduction": "将离散颗粒与连续介质耦合需要强制施加运动学约束，例如界面处的无滑移条件。本练习旨在探索和比较两种主流的数值策略：罚函数法和拉格朗日乘子法。通过在一个简化的耦合系统中亲手实现这两种方法，您将能够量化它们的误差，并深入理解它们在精度、计算成本和实现复杂性之间的根本权衡。[@problem_id:3504386]", "problem": "考虑一个离散元法（DEM）粒子在界面处与单个连续流体控制体进行切向运动耦合。该粒子质量为 $m_p$，切向速度为 $u_\\text{DEM}(t)$，而流体单元的集总质量为 $m_f$，切向速度为 $u_f(t)$。作用在流体单元上的外部剪切力为 $f_s(t)$。界面牵引力以相反方向作用于这两个子系统。我们考虑两种用于强制实施运动学无滑移约束 $u_\\text{DEM}(t) = u_f(t)$ 的策略：罚函数法和拉格朗日乘子法。目标是量化连续性误差 $\\|u_\\text{DEM} - u_f\\|$ 作为罚参数 $\\gamma$ 和接触刚度 $k_n$ 的函数。\n\n从每个子系统的牛顿第二定律 $m\\,du/dt = \\sum F$ 出发。将物理切向界面牵引力建模为与滑移 $u_\\text{DEM} - u_f$ 成正比的线性粘性阻力，其系数 $c_t$ 通过 $c_t = \\zeta \\sqrt{k_n m_p}$ 依赖于法向接触刚度 $k_n$，其中 $\\zeta$ 是一个无量纲比例常数。流体单元受到额外的体积粘性阻力，该阻力被建模为一个与 $u_f$ 方向相反、系数为 $b$ 的线性阻尼器。使用以下给定的参数和单位：\n- 粒子质量 $m_p = 0.01$ kg。\n- 流体集总质量 $m_f = 0.02$ kg。\n- 流体体积阻尼 $b = 0.1$ kg/s。\n- 比例常数 $\\zeta = 0.2$。\n- 时间步长 $\\Delta t = 1\\times 10^{-4}$ s。\n- 总模拟时间 $T = 0.5$ s。\n- 外部剪切力 $f_s(t) = F_0 \\sin(2\\pi f t)$，其中 $F_0 = 0.01$ N 且 $f = 2$ Hz。\n\n对于罚函数法强制，通过一个与滑移成正比、罚参数为 $\\gamma$（单位 kg/s）的数值罚牵引力来增强物理界面牵引力。对于时间步进，在区间 $[0,T]$ 上使用步长为 $\\Delta t$ 的后向（隐式）欧拉法：\n- 定义 $K = c_t + \\gamma$。\n- 通过求解将隐式欧拉法应用于牛顿第二定律所得到的线性系统，将 $\\{u_\\text{DEM}^{n}, u_f^{n}\\}$ 演化为 $\\{u_\\text{DEM}^{n+1}, u_f^{n+1}\\}$。该系统中，界面牵引力为 $K(u_\\text{DEM}^{n+1} - u_f^{n+1})$，体积阻尼 $b$ 作用于 $u_f^{n+1}$，外部作用力为 $f_s(t^{n+1})$：\n  $$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n  $$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right).$$\n- 在 $t=0$ s 时，初始化 $u_\\text{DEM}^{0} = 0$ m/s 和 $u_f^{0} = 0$ m/s。\n\n对于拉格朗日乘子法强制，在每个时间步精确施加约束 $u_\\text{DEM}^{n+1} = u_f^{n+1}$。这通过一个代表界面牵引力的拉格朗日乘子实现。通过强制运动学相等来消除该乘子，可得到共同速度 $u^{n+1}$ 的组合更新方程：\n$$\\frac{m_p + m_f}{\\Delta t}\\left(u^{n+1} - u^{n}\\right) = f_s(t^{n+1}) - b\\,u^{n+1},$$\n其中 $u^{0} = 0$ m/s，此后 $u_\\text{DEM}^{n+1} = u_f^{n+1} = u^{n+1}$。\n\n将误差范数定义为在 $[0,T]$ 上的时间平均离散 $L^2$ 范数：\n$$\\|u_\\text{DEM} - u_f\\| = \\sqrt{\\frac{1}{T}\\sum_{n=0}^{N-1} \\Delta t \\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right)^2},$$\n并以米每秒（m/s）报告其值。\n\n实现一个完整的程序，该程序：\n- 对每个测试用例，使用指定的隐式欧拉方案（罚函数法或拉格朗日乘子法）模拟耦合系统。\n- 计算并返回每个测试用例的误差范数 $\\|u_\\text{DEM} - u_f\\|$，单位为 m/s。\n\n使用以下涵盖典型、边界和边缘情况的测试套件。每个用例是一个元组 $(\\text{method}, \\gamma, k_n)$，其中 $\\text{method}$ 是字符串 \"penalty\" 或 \"LM\"：\n1. $(\"penalty\", 0.0, 10^3)$\n2. $(\"penalty\", 10.0, 10^3)$\n3. $(\"penalty\", 10^3, 10^3)$\n4. $(\"penalty\", 10^2, 10^5)$\n5. $(\"penalty\", 10^2, 10^2)$\n6. $(\"LM\", 0.0, 10^3)$\n7. $(\"LM\", 10^2, 10^5)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots,r_7]$）作为结果，其中每个 $r_i$ 是对应测试用例的误差范数 $\\|u_\\text{DEM} - u_f\\|$（单位 m/s），以全双精度浮点数计算。", "solution": "控制方程源于 DEM 粒子和连续流体单元各自的牛顿第二定律 $m\\,du/dt = \\sum F$，其中界面牵引力大小相等、方向相反。界面无滑移条件 $u_\\text{DEM} = u_f$ 通过罚函数法或通过拉格朗日乘子法精确强制。负责切向动量交换的物理界面机制被建模为线性粘性牵引力，其系数为 $c_t$。为将该系数与机械接触属性联系起来，设定 $c_t = \\zeta \\sqrt{k_n m_p}$，其中 $k_n$ 是法向接触刚度，$\\zeta$ 是无量纲比例常数，此形式与瑞利型阻尼标度一致，可得出 $[c_t] = \\text{kg/s}$ 的单位，因为 $[k_n] = \\text{N/m} = \\text{kg}/\\text{s}^2$，因此 $\\sqrt{k_n m_p}$ 的单位是 $\\text{kg}/\\text{s}$。\n\n对于罚函数法，界面牵引力是物理贡献（粘性滑移阻尼，系数为 $c_t$）和与滑移成比例的数值罚函数贡献（参数为 $\\gamma$）之和。令 $K = c_t + \\gamma$。在从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的单个时间步上应用后向（隐式）欧拉法，并用 $u_\\text{DEM}^{n}$ 和 $u_f^{n}$ 表示离散速度，可得：\n$$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right).$$\n重新整理可得到一个关于 $\\left(u_\\text{DEM}^{n+1}, u_f^{n+1}\\right)$ 的 $2\\times 2$ 线性系统：\n$$\\left(\\frac{m_p}{\\Delta t} + K\\right)u_\\text{DEM}^{n+1} - K\\,u_f^{n+1} = \\frac{m_p}{\\Delta t}u_\\text{DEM}^{n},$$\n$$-K\\,u_\\text{DEM}^{n+1} + \\left(\\frac{m_f}{\\Delta t} + b + K\\right)u_f^{n+1} = f_s(t^{n+1}) + \\frac{m_f}{\\Delta t}u_f^{n}.$$\n对于正的 $m_p$、$m_f$、$b$ 和 $K$，该系统是唯一可解的，因为对于所选参数，系数矩阵是严格对角占优的，因此是非奇异的。从 $u_\\text{DEM}^0 = 0$ 和 $u_f^0 = 0$ 开始，我们进行时间步进直到 $t=T$。\n\n对于拉格朗日乘子法，约束 $u_\\text{DEM}^{n+1} = u_f^{n+1}$ 被精确施加。引入一个拉格朗日乘子 $\\lambda^{n+1}$ 来表示界面牵引力，离散隐式欧拉方程为：\n$$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -\\lambda^{n+1} - c_t\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + \\lambda^{n+1} + c_t\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$u_\\text{DEM}^{n+1} - u_f^{n+1} = 0.$$\n在约束条件下，$c_t$ 项消失，并且可以通过将两个动量方程相加来消除拉格朗日乘子，从而得到共同速度 $u^{n+1} = u_\\text{DEM}^{n+1} = u_f^{n+1}$ 的单个隐式欧拉更新方程：\n$$\\frac{m_p + m_f}{\\Delta t}\\left(u^{n+1} - u^{n}\\right) = f_s(t^{n+1}) - b\\,u^{n+1},$$\n其中 $u^{0} = 0$。这个线性标量方程的解为\n$$u^{n+1} = \\frac{f_s(t^{n+1}) + \\frac{m_p + m_f}{\\Delta t}u^{n}}{\\frac{m_p + m_f}{\\Delta t} + b}.$$\n根据构造，对于拉格朗日乘子法强制，运动学差异 $u_\\text{DEM}^{n+1} - u_f^{n+1}$ 在每个步骤中都精确为零，因此误差范数 $\\|u_\\text{DEM} - u_f\\|$ 在浮点运算精度内恒为零。\n\n误差范数定义为时间平均离散 $L^2$ 范数，\n$$\\|u_\\text{DEM} - u_f\\| = \\sqrt{\\frac{1}{T}\\sum_{n=0}^{N-1} \\Delta t \\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right)^2},$$\n其单位为米每秒（m/s），因为因子 $\\Delta t/T$ 是无量纲的。\n\n算法设计：\n1. 对于罚函数法，初始化 $u_\\text{DEM}^{0} = 0$ 和 $u_f^{0} = 0$；对于拉格朗日乘子法，初始化 $u^{0} = 0$。\n2. 对每个时间步 $n = 0,\\dots,N-1$（其中 $N = T/\\Delta t$），计算 $t^{n+1} = (n+1)\\Delta t$ 和 $f_s(t^{n+1}) = F_0 \\sin(2\\pi f t^{n+1})$。\n3. 罚函数法：\n   - 计算 $c_t = \\zeta \\sqrt{k_n m_p}$ 和 $K = c_t + \\gamma$。\n   - 组装 $2\\times 2$ 系统，并使用直接求解器求解 $\\left(u_\\text{DEM}^{n+1}, u_f^{n+1}\\right)$。\n4. 拉格朗日乘子法：\n   - 使用标量隐式欧拉公式更新共同速度 $u^{n+1}$，并设置 $u_\\text{DEM}^{n+1} = u_f^{n+1} = u^{n+1}$。\n5. 在每个步骤累积滑移的平方乘以 $\\Delta t$，以构成误差度量的分子；除以 $T$ 并取平方根，得到 $\\|u_\\text{DEM} - u_f\\|$。\n6. 对于给定的测试套件，为每个元组 $(\\text{method}, \\gamma, k_n)$ 运行模拟，并将所得的误差范数收集到一个列表中。\n\n科学真实性与耦合原理：\n- 使用牛顿第二定律确保了每个子系统中的动量守恒。\n- 线性粘性切向牵引力 $c_t(u_\\text{DEM} - u_f)$ 捕捉了可归因于近接触阻尼的界面动量交换，并通过 $c_t = \\zeta \\sqrt{k_n m_p}$ 与 $k_n$ 成比例，以反映在更硬的法向接触下更强的相互作用。\n- 罚函数法通过在速度空间中增加数值刚度 $\\gamma$ 来近似无滑移约束，这会减少滑移，但除非 $\\gamma \\to \\infty$，否则无法使其恒等于零。\n- 拉格朗日乘子法通过引入一个辅助变量来精确地强制约束，该变量调整界面牵引力以在每个时间层级满足 $u_\\text{DEM} = u_f$，从而在构造上产生零连续性误差。\n\n最终程序实现了这些步骤，使用了指定的单位，并以单行输出所有测试用例的误差范数，单位为 m/s。", "answer": "```python\nimport numpy as np\n\ndef simulate_penalty(gamma, k_n, params):\n    # Unpack parameters\n    m_p = params[\"m_p\"]\n    m_f = params[\"m_f\"]\n    b = params[\"b\"]\n    zeta = params[\"zeta\"]\n    dt = params[\"dt\"]\n    T = params[\"T\"]\n    F0 = params[\"F0\"]\n    freq = params[\"freq\"]\n    N = int(np.round(T / dt))\n\n    # Interface viscous coefficient scaled by normal stiffness\n    c_t = zeta * np.sqrt(k_n * m_p)\n    K = c_t + gamma\n\n    # Initialize velocities\n    u_dem = 0.0\n    u_f = 0.0\n\n    # Accumulate squared slip for error norm\n    slip_accum = 0.0\n\n    # Precompute coefficients\n    a11 = m_p / dt + K\n    a12 = -K\n    # Fluid equation coefficients depend on b; recompute at each step only RHS\n    b11 = -K\n    b22 = m_f / dt + b + K\n\n    for n in range(N):\n        tnp1 = (n + 1) * dt\n        f_s = F0 * np.sin(2.0 * np.pi * freq * tnp1)\n\n        rhs1 = (m_p / dt) * u_dem\n        rhs2 = f_s + (m_f / dt) * u_f\n\n        # Solve 2x2 linear system:\n        # [a11 a12][u_dem^{n+1}] = [rhs1]\n        # [b11 b22][u_f^{n+1}]   = [rhs2]\n        # But note the coupling: second equation also has u_dem^{n+1} term (b11).\n        # Form matrix and right-hand side.\n        A = np.array([[a11, a12],\n                      [b11, b22]], dtype=float)\n        rhs = np.array([rhs1, rhs2], dtype=float)\n\n        sol = np.linalg.solve(A, rhs)\n        u_dem_new, u_f_new = sol[0], sol[1]\n\n        slip = u_dem_new - u_f_new\n        slip_accum += dt * (slip * slip)\n\n        u_dem = u_dem_new\n        u_f = u_f_new\n\n    error = np.sqrt(slip_accum / T)\n    return error\n\ndef simulate_lagrange_multiplier(k_n, params):\n    # Unpack parameters\n    m_p = params[\"m_p\"]\n    m_f = params[\"m_f\"]\n    b = params[\"b\"]\n    dt = params[\"dt\"]\n    T = params[\"T\"]\n    F0 = params[\"F0\"]\n    freq = params[\"freq\"]\n    N = int(np.round(T / dt))\n\n    # Initialize common velocity\n    u = 0.0\n\n    slip_accum = 0.0  # will remain zero by construction\n\n    # Coefficient for implicit Euler update\n    M_over_dt = (m_p + m_f) / dt\n    denom = M_over_dt + b\n\n    for n in range(N):\n        tnp1 = (n + 1) * dt\n        f_s = F0 * np.sin(2.0 * np.pi * freq * tnp1)\n        rhs = f_s + M_over_dt * u\n        u_new = rhs / denom\n        # Enforced equality\n        u_dem_new = u_new\n        u_f_new = u_new\n\n        slip = u_dem_new - u_f_new\n        slip_accum += dt * (slip * slip)\n\n        u = u_new\n\n    error = np.sqrt(slip_accum / T)\n    return error\n\ndef solve():\n    # Define global parameters\n    params = {\n        \"m_p\": 0.01,     # kg\n        \"m_f\": 0.02,     # kg\n        \"b\": 0.1,        # kg/s\n        \"zeta\": 0.2,     # dimensionless\n        \"dt\": 1e-4,      # s\n        \"T\": 0.5,        # s\n        \"F0\": 0.01,      # N\n        \"freq\": 2.0      # Hz\n    }\n\n    # Test suite: (method, gamma, k_n)\n    test_cases = [\n        (\"penalty\", 0.0, 1e3),    # boundary: no penalty\n        (\"penalty\", 10.0, 1e3),   # moderate penalty\n        (\"penalty\", 1e3, 1e3),    # very large penalty\n        (\"penalty\", 1e2, 1e5),    # strong contact stiffness\n        (\"penalty\", 1e2, 1e2),    # weak contact stiffness\n        (\"LM\", 0.0, 1e3),         # LM enforcement, k_n nominal\n        (\"LM\", 1e2, 1e5)          # LM enforcement, k_n varied\n    ]\n\n    results = []\n    for method, gamma, k_n in test_cases:\n        if method == \"penalty\":\n            err = simulate_penalty(gamma, k_n, params)\n        elif method == \"LM\":\n            # gamma not used in LM method\n            err = simulate_lagrange_multiplier(k_n, params)\n        else:\n            err = float('nan')\n        results.append(err)\n\n    # Print in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3504386"}, {"introduction": "耦合模拟的强大之处在于其处理多物理场现象的能力，例如力学与热学的相互作用。本练习将纯力学模型扩展到包含热效应，特别是滑动接触界面上的摩擦生热问题。您需要应用热力学第一定律和傅里叶热传导定律，为一个简化的集总热容模型推导并求解温度演化方程，从而体验如何将热场分析集成到DEM-连续介质耦合框架中。[@problem_id:3504416]", "problem": "一个离散元法 (DEM) 球形颗粒正在一个刚性连续体壁上滑动。在单个接触点处，DEM 求解器报告了切向力 $F_t$ 和滑移速度 $v_t$。连续体壁和 DEM 颗粒是热学性质不同的材料。接触处的摩擦功转化为热量，并根据两者的热积率分配到两个物体中。采用集总热容法近似将 DEM 颗粒的近接触微体积建模为一个热节点，该节点通过传导方式，跨越一个代表性厚度与颗粒的其余部分进行热交换。\n\n从热力学第一定律（能量守恒）、傅里叶热传导定律和热积率的定义出发，推导颗粒近接触微体积中瞬态温升的控制方程，求解初始温升为零的情况，并评估在指定时间的温升。假设：\n- 接触点的摩擦功率输入为 $P = F_t \\, v_t$。\n- 热量根据它们的热积率 $e_i = \\sqrt{k_i \\, \\rho_i \\, c_i}$ 按比例分配到两个物体中，其中 $k_i$ 是热导率，$\\rho_i$ 是密度，而 $c_i$ 是比热容。进入颗粒的热量占总功率 $P$ 的比例为 $f_p = \\frac{e_p}{e_p + e_w}$，因此颗粒接收到的功率为 $P_p = f_p \\, P$。\n- 颗粒的近接触微体积的体积为 $V_c = A_c \\, \\delta_c$，热容为 $C_p = \\rho_p \\, c_p \\, V_c$，其中 $A_c$ 是接触面积的估计值，$\\delta_c$ 是进入颗粒的代表性传导厚度。\n- 从近接触微体积到颗粒其余部分的热传导是跨越 $\\delta_c$ 的一维传导，与板状体的傅里叶定律一致。\n\n使用以下数据：\n- 切向力 $F_t = 0.2 \\,\\mathrm{N}$ 和滑移速度 $v_t = 0.05 \\,\\mathrm{m/s}$。\n- 接触面积估计值 $A_c = 1.0 \\times 10^{-8} \\,\\mathrm{m^2}$ 和代表性传导厚度 $\\delta_c = 1.0 \\times 10^{-4} \\,\\mathrm{m}$。\n- 颗粒（DEM 颗粒）的热学性质：热导率 $k_p = 45 \\,\\mathrm{W/(m \\cdot K)}$，密度 $\\rho_p = 7800 \\,\\mathrm{kg/m^3}$，比热 $c_p = 460 \\,\\mathrm{J/(kg \\cdot K)}$。\n- 壁（连续体）的热学性质：热导率 $k_w = 3 \\,\\mathrm{W/(m \\cdot K)}$，密度 $\\rho_w = 2600 \\,\\mathrm{kg/m^3}$，比热 $c_w = 790 \\,\\mathrm{J/(kg \\cdot K)}$。\n- 远离接触点的两个物体最初处于相同的均匀温度，因此接触微体积的初始温升为零。\n\n计算在时间 $t = 0.010 \\,\\mathrm{s}$ 时颗粒近接触处的瞬态温升 $\\Delta T_p(t)$。用开尔文表示最终温升，并将答案四舍五入到四位有效数字。", "solution": "本问题要求推导并求解一个离散元法 (DEM) 颗粒在连续体壁上滑动时，其近接触微体积瞬态温升的控制方程。推导始于热力学第一定律，该定律指出，控制体积内内能的变化率等于进入其中的净热传递速率。\n\n设 $\\Delta T_p(t)$ 为颗粒近接触微体积相对于初始环境温度的温升。此微体积相对于初始状态的内能为 $U_p = C_p \\Delta T_p(t)$，其中 $C_p$ 是该体积的热容。因此，内能的变化率为 $\\frac{dU_p}{dt} = C_p \\frac{d(\\Delta T_p)}{dt}$。\n\n热容 $C_p$ 由密度 $\\rho_p$、比热容 $c_p$ 和微体积的体积 $V_c$ 的乘积给出。体积被建模为 $V_c = A_c \\delta_c$，其中 $A_c$ 是接触面积，$\\delta_c$ 是代表性传导厚度。因此，$C_p = \\rho_p c_p A_c \\delta_c$。\n\n进入微体积的净热传递速率是流入颗粒的产热速率 $\\dot{Q}_{in}$ 与从微体积传导到颗粒主体中的散热速率 $\\dot{Q}_{out}$ 之差。\n\n热输入 $\\dot{Q}_{in}$ 是接触处产生的总摩擦功率 $P$ 的一部分。总功率为 $P = F_t v_t$。该功率在颗粒和壁之间分配。进入颗粒的比例由 $f_p = \\frac{e_p}{e_p + e_w}$ 给出，其中 $e_p$ 和 $e_w$ 分别是颗粒和壁的热积率。热积率定义为 $e_i = \\sqrt{k_i \\rho_i c_i}$。因此，进入颗粒微体积的功率为 $P_p = \\dot{Q}_{in} = f_p P = f_p F_t v_t$。\n\n热输出 $\\dot{Q}_{out}$ 被建模为远离微体积的一维热传导。根据傅里叶定律，对于横截面积为 $A_c$、厚度为 $\\delta_c$ 的板状体，热传递速率与其两端的温差成正比。微体积的温度升高了 $\\Delta T_p$，而颗粒主体假定保持在初始温度。因此，传导走的热量为 $\\dot{Q}_{out} = k_p A_c \\frac{\\Delta T_p}{\\delta_c}$。\n\n将这些项合并到能量平衡方程中：\n$$\n\\frac{dU_p}{dt} = \\dot{Q}_{in} - \\dot{Q}_{out}\n$$\n$$\nC_p \\frac{d(\\Delta T_p)}{dt} = P_p - \\frac{k_p A_c}{\\delta_c} \\Delta T_p\n$$\n\n代入 $C_p$ 的表达式：\n$$\n(\\rho_p c_p A_c \\delta_c) \\frac{d(\\Delta T_p)}{dt} = P_p - \\frac{k_p A_c}{\\delta_c} \\Delta T_p\n$$\n\n这是一个一阶线性常微分方程。为了求解它，我们将其重新排列成标准形式 $\\frac{dy}{dt} + a y = b$：\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\left(\\frac{k_p A_c}{\\delta_c (\\rho_p c_p A_c \\delta_c)}\\right) \\Delta T_p = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\left(\\frac{k_p}{\\rho_p c_p \\delta_c^2}\\right) \\Delta T_p = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n\n让我们定义热时间常数 $\\tau$ 和稳态温升 $\\Delta T_{p,ss}$。$\\Delta T_p$ 项的系数是时间常数的倒数：\n$$\n\\frac{1}{\\tau} = \\frac{k_p}{\\rho_p c_p \\delta_c^2} \\implies \\tau = \\frac{\\rho_p c_p \\delta_c^2}{k_p}\n$$\n在稳态下，$\\frac{d(\\Delta T_p)}{dt} = 0$，因此方程简化为：\n$$\n\\frac{1}{\\tau} \\Delta T_{p,ss} = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n$$\n\\Delta T_{p,ss} = \\tau \\frac{P_p}{\\rho_p c_p A_c \\delta_c} = \\left(\\frac{\\rho_p c_p \\delta_c^2}{k_p}\\right) \\frac{P_p}{\\rho_p c_p A_c \\delta_c} = \\frac{P_p \\delta_c}{k_p A_c}\n$$\n现在微分方程可以写成：\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\frac{1}{\\tau} \\Delta T_p = \\frac{\\Delta T_{p,ss}}{\\tau}\n$$\n该方程的通解为 $\\Delta T_p(t) = \\Delta T_{p,ss} + K \\exp(-t/\\tau)$，其中 $K$ 是积分常数。我们使用初始条件，即在时间 $t=0$ 时温升为零，即 $\\Delta T_p(0) = 0$。\n$$\n0 = \\Delta T_{p,ss} + K \\exp(0) \\implies K = -\\Delta T_{p,ss}\n$$\n瞬态温升的特解为：\n$$\n\\Delta T_p(t) = \\Delta T_{p,ss} - \\Delta T_{p,ss} \\exp(-t/\\tau) = \\Delta T_{p,ss} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)\n$$\n\n现在我们使用提供的数据计算参数的数值。\n给定数据：\n切向力 $F_t = 0.2 \\,\\mathrm{N}$，滑移速度 $v_t = 0.05 \\,\\mathrm{m/s}$。\n接触面积 $A_c = 1.0 \\times 10^{-8} \\,\\mathrm{m^2}$，传导厚度 $\\delta_c = 1.0 \\times 10^{-4} \\,\\mathrm{m}$。\n颗粒性质：$k_p = 45 \\,\\mathrm{W/(m \\cdot K)}$, $\\rho_p = 7800 \\,\\mathrm{kg/m^3}$, $c_p = 460 \\,\\mathrm{J/(kg \\cdot K)}$。\n壁性质：$k_w = 3 \\,\\mathrm{W/(m \\cdot K)}$, $\\rho_w = 2600 \\,\\mathrm{kg/m^3}$, $c_w = 790 \\,\\mathrm{J/(kg \\cdot K)}$。\n时间 $t = 0.010 \\,\\mathrm{s}$。\n\n首先，计算热积率，$e_i = \\sqrt{k_i \\rho_i c_i}$：\n对于颗粒：\n$e_p = \\sqrt{45 \\times 7800 \\times 460} = \\sqrt{161,460,000} \\approx 12706.7 \\,\\mathrm{J/(m^2 \\cdot K \\cdot \\sqrt{s})}$.\n对于壁：\n$e_w = \\sqrt{3 \\times 2600 \\times 790} = \\sqrt{6,162,000} \\approx 2482.3 \\,\\mathrm{J/(m^2 \\cdot K \\cdot \\sqrt{s})}$.\n\n接下来，计算总摩擦功率 $P$ 和进入颗粒的部分 $P_p$：\n$P = F_t v_t = 0.2 \\times 0.05 = 0.01 \\,\\mathrm{W}$。\n分配分数为 $f_p = \\frac{e_p}{e_p + e_w} = \\frac{12706.7}{12706.7 + 2482.3} = \\frac{12706.7}{15189.0} \\approx 0.83657$。\n$P_p = f_p P = 0.83657 \\times 0.01 = 0.0083657 \\,\\mathrm{W}$。\n\n现在，计算稳态温升 $\\Delta T_{p,ss}$：\n$$\n\\Delta T_{p,ss} = \\frac{P_p \\delta_c}{k_p A_c} = \\frac{(0.0083657) \\times (1.0 \\times 10^{-4})}{(45) \\times (1.0 \\times 10^{-8})} = \\frac{8.3657 \\times 10^{-7}}{4.5 \\times 10^{-7}} \\approx 1.85905 \\,\\mathrm{K}\n$$\n\n接下来，计算热时间常数 $\\tau$：\n$$\n\\tau = \\frac{\\rho_p c_p \\delta_c^2}{k_p} = \\frac{(7800) \\times (460) \\times (1.0 \\times 10^{-4})^2}{45} = \\frac{3,588,000 \\times 1.0 \\times 10^{-8}}{45} = \\frac{0.03588}{45} \\approx 0.00079733 \\,\\mathrm{s}\n$$\n\n最后，计算在 $t = 0.010 \\,\\mathrm{s}$ 时的温升：\n$$\n\\Delta T_p(0.010) = \\Delta T_{p,ss} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)\n$$\n比率 $t/\\tau$ 为：\n$$\n\\frac{t}{\\tau} = \\frac{0.010}{0.00079733} \\approx 12.5417\n$$\n现在将此代入解中：\n$$\n\\Delta T_p(0.010) \\approx 1.85905 \\left(1 - \\exp(-12.5417)\\right)\n$$\n$$\n\\Delta T_p(0.010) \\approx 1.85905 \\left(1 - 3.582 \\times 10^{-6}\\right) = 1.85905 \\times 0.999996418 \\approx 1.85904 \\,\\mathrm{K}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$\\Delta T_p(0.010) \\approx 1.859 \\,\\mathrm{K}$。", "answer": "$$\n\\boxed{1.859}\n$$", "id": "3504416"}]}