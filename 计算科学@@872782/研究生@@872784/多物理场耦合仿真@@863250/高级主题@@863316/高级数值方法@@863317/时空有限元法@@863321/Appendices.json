{"hands_on_practices": [{"introduction": "我们从一个最基本的任务开始：在单个时空单元上离散一个简单的抛物型偏微分方程（热方程）。这个练习将演示统一的时空弱形式如何自然地分解为更简单的一维积分的张量积。理解这种结构不仅是高效实现的关键，也是确定保证精确积分所需的数值求积法则的基础。[@problem_id:3525793]", "problem": "考虑热方程作为一维空间域中温度扩散与时间耦合的模型，该模型由偏微分方程(PDE) $u_{t} - \\kappa u_{xx} = f$ 在 $\\Omega \\times (0,T)$ 上控制，其中 $\\Omega \\subset \\mathbb{R}$ 是一个区间，$\\kappa > 0$ 是热扩散系数，$f$ 是源项。使用有限元法(FEM)，在单个棱柱形单元 $K = [x_{e},x_{e+1}] \\times [t_{n},t_{n+1}]$ 上构建时空离散化，方法是在张量积多项式试验空间中寻找解 $u_{h}(x,t)$，并使用相同阶数的张量积多项式检验空间进行检验。设参考区间 $\\hat{x} \\in [-1,1]$ 上的空间基为 $\\{\\phi_{i}(\\hat{x})\\}_{i=0}^{p_{x}}$，参考区间 $\\hat{t} \\in [-1,1]$ 上的时间基为 $\\{\\psi_{j}(\\hat{t})\\}_{j=0}^{p_{t}}$。假设仿射映射为 $x = x_{c} + (h_{x}/2)\\hat{x}$ 和 $t = t_{c} + (h_{t}/2)\\hat{t}$，其中 $h_{x} = x_{e+1}-x_{e}$ 且 $h_{t} = t_{n+1}-t_{n}$。\n\n从对应于偏微分方程 $u_{t} - \\kappa u_{xx} = f$ 的弱形式出发，且不对时间进行分部积分，推导 $K$ 上的局部单元双线性形式，并展示其如何分离为来自空间和时间的张量积贡献。计算进入此双线性形式的四个一维矩阵的表达式：空间质量矩阵、空间刚度矩阵、时间质量矩阵和时间导数耦合矩阵。然后，确定在空间和时间上充分的张量积 Gauss–Legendre 求积法则，以便在仿射映射和常系数的情况下，精确积分这些矩阵中出现的所有多项式项。\n\n将为保证精确性所需的空间和时间上的最小 Gauss–Legendre 点数表示为多项式阶数 $p_{x}$ 和 $p_{t}$ 的解析函数。作为最终答案，请使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境将这两个数作为一个单行矩阵提供，其条目按 $(n_{x}, n_{t})$ 排序，其中 $n_{x}$ 是空间中的最小点数，$n_{t}$ 是时间中的最小点数。不需要四舍五入，也不应报告单位。", "solution": "问题正在进行验证。\n\n### 步骤 1：提取已知条件\n- **偏微分方程(PDE)：** $u_{t} - \\kappa u_{xx} = f$ 在 $\\Omega \\times (0,T)$ 上，其中 $\\Omega \\subset \\mathbb{R}$。\n- **常数：** 热扩散系数 $\\kappa > 0$。\n- **域：** 单个棱柱形时空单元 $K = [x_{e},x_{e+1}] \\times [t_{n},t_{n+1}]$。\n- **离散化：** 使用相同阶数的张量积多项式试验和检验空间的有限元法。\n- **基函数：**\n    - 参考区间 $\\hat{x} \\in [-1,1]$ 上的空间基：$\\{\\phi_{i}(\\hat{x})\\}_{i=0}^{p_{x}}$，其中 $p_x$ 是多项式阶数。\n    - 参考区间 $\\hat{t} \\in [-1,1]$ 上的时间基：$\\{\\psi_{j}(\\hat{t})\\}_{j=0}^{p_{t}}$，其中 $p_t$ 是多项式阶数。\n- **映射：** 从参考坐标到物理坐标的仿射映射。\n    - $x = x_{c} + (h_{x}/2)\\hat{x}$，其中 $h_{x} = x_{e+1}-x_{e}$。\n    - $t = t_{c} + (h_{t}/2)\\hat{t}$，其中 $h_{t} = t_{n+1}-t_{n}$。\n- **约束：** 弱形式由 $u_{t} - \\kappa u_{xx} = f$ 导出，且不对时间进行分部积分。\n- **任务：**\n    1. 推导 $K$ 上的局部单元双线性形式。\n    2. 展示其如何分离为张量积贡献。\n    3. 计算四个一维矩阵的表达式：空间质量矩阵、空间刚度矩阵、时间质量矩阵和时间导数耦合矩阵。\n    4. 确定为实现精确积分所需的空间最小 Gauss–Legendre 点数 $n_x$ 和时间最小 Gauss–Legendre 点数 $n_t$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是偏微分方程数值分析中的一个标准练习，具体涉及扩散方程的时空有限元法。所有概念在计算科学与工程中都是公认的。\n- **适定性：** 任务是进行推导并计算所需数值求积法则的阶数。这是一个定义明确的数学问题，基于所提供的输入有唯一解。\n- **客观性：** 问题使用精确的数学语言陈述，不包含主观或模糊的术语。\n- **完整性：** 问题提供了所有必要信息：偏微分方程、单元类型、基函数、映射以及具体任务。\n- **一致性：** 所提供的信息内部一致，不包含矛盾。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n***\n\n我们从热扩散的偏微分方程(PDE)开始：\n$$\nu_{t} - \\kappa u_{xx} = f\n$$\n为了在单个时空单元 $K = [x_e, x_{e+1}] \\times [t_n, t_{n+1}]$ 上推导弱形式，我们将偏微分方程乘以一个检验函数 $v(x,t)$ 并在 $K$ 上积分：\n$$\n\\int_{t_n}^{t_{n+1}} \\int_{x_e}^{x_{e+1}} (u_t - \\kappa u_{xx})v \\, dx \\, dt = \\int_{t_n}^{t_{n+1}} \\int_{x_e}^{x_{e+1}} f v \\, dx \\, dt\n$$\n对二阶空间导数项进行分部积分得到：\n$$\n\\int_{K} (u_t v + \\kappa u_x v_x) \\, d(x,t) - \\int_{t_n}^{t_{n+1}} [\\kappa u_x v]_{x_e}^{x_{e+1}} \\, dt = \\int_{K} f v \\, d(x,t)\n$$\n边界项 $\\int_{t_n}^{t_{n+1}} [\\kappa u_x v]_{x_e}^{x_{e+1}} \\, dt$ 在单元矩阵的全局组装过程中处理。局部单元双线性形式 $B_K(u,v)$ 是弱形式在单元内部积分的部分：\n$$\nB_K(u,v) = \\int_{K} (u_t v + \\kappa u_x v_x) \\, d(x,t)\n$$\n现在我们使用给定的仿射映射将该积分映射到参考单元 $\\hat{K} = [-1,1] \\times [-1,1]$ 上：$x(\\hat{x}) = x_c + \\frac{h_x}{2}\\hat{x}$ 和 $t(\\hat{t}) = t_c + \\frac{h_t}{2}\\hat{t}$。\n导数根据链式法则进行变换：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial \\hat{u}}{\\partial \\hat{t}} \\frac{d\\hat{t}}{dt} = \\frac{2}{h_t} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}}\n\\quad \\text{和} \\quad\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial \\hat{u}}{\\partial \\hat{x}} \\frac{d\\hat{x}}{dx} = \\frac{2}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}}\n$$\n微分元变换为 $d(x,t) = dx \\, dt = \\frac{h_x}{2} \\frac{h_t}{2} \\, d\\hat{x} \\, d\\hat{t}$。\n将这些代入双线性形式，我们得到：\n$$\nB_K(u,v) = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\left(\\frac{2}{h_t} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}}\\right) \\hat{v} + \\kappa \\left(\\frac{2}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}}\\right) \\left(\\frac{2}{h_x} \\frac{\\partial \\hat{v}}{\\partial \\hat{x}}\\right) \\right) \\frac{h_x h_t}{4} \\, d\\hat{x} \\, d\\hat{t}\n$$\n$$\nB_K(u,v) = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{h_x}{2} \\frac{\\partial \\hat{u}}{\\partial \\hat{t}} \\hat{v} + \\kappa \\frac{h_t}{h_x} \\frac{\\partial \\hat{u}}{\\partial \\hat{x}} \\frac{\\partial \\hat{v}}{\\partial \\hat{x}} \\right) \\, d\\hat{x} \\, d\\hat{t}\n$$\n参考单元上的离散解 $\\hat{u}_h(\\hat{x},\\hat{t})$ 被近似为在张量积基上的有限和：\n$$\n\\hat{u}_h(\\hat{x},\\hat{t}) = \\sum_{k=0}^{p_x} \\sum_{l=0}^{p_t} u_{kl} \\phi_k(\\hat{x}) \\psi_l(\\hat{t})\n$$\n检验函数 $v$ 从相同的基中选取，$\\hat{v}_h(\\hat{x},\\hat{t}) = \\phi_i(\\hat{x})\\psi_j(\\hat{t})$，其中 $i \\in \\{0, \\dots, p_x\\}$ 且 $j \\in \\{0, \\dots, p_t\\}$。将这些代入双线性形式，得到局部单元矩阵 $A$ 的条目：\n$$\nA_{(ij)(kl)} = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{h_x}{2} \\left[ \\phi_k \\frac{d\\psi_l}{d\\hat{t}} \\right] \\left[ \\phi_i \\psi_j \\right] + \\kappa \\frac{h_t}{h_x} \\left[ \\frac{d\\phi_k}{d\\hat{x}} \\psi_l \\right] \\left[ \\frac{d\\phi_i}{d\\hat{x}} \\psi_j \\right] \\right) \\, d\\hat{x} \\, d\\hat{t}\n$$\n由于基函数的张量积结构，积分可以分离：\n$$\nA_{(ij)(kl)} = \\frac{h_x}{2} \\left(\\int_{-1}^{1} \\phi_k(\\hat{x})\\phi_i(\\hat{x}) \\, d\\hat{x}\\right) \\left(\\int_{-1}^{1} \\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}} \\, d\\hat{t}\\right) + \\kappa \\frac{h_t}{h_x} \\left(\\int_{-1}^{1} \\frac{d\\phi_k}{d\\hat{x}}\\frac{d\\phi_i}{d\\hat{x}} \\, d\\hat{x}\\right) \\left(\\int_{-1}^{1} \\psi_l(\\hat{t})\\psi_j(\\hat{t}) \\, d\\hat{t}\\right)\n$$\n此表达式显示了双线性形式分离为一维矩阵的张量积。我们现在可以确定这四个一维矩阵：\n\n1.  **空间质量矩阵 ($M^x$):**\n    $$ M^x_{ik} = \\int_{-1}^{1} \\phi_i(\\hat{x})\\phi_k(\\hat{x}) \\, d\\hat{x} $$\n2.  **空间刚度矩阵 ($K^x$):**\n    $$ K^x_{ik} = \\int_{-1}^{1} \\frac{d\\phi_i}{d\\hat{x}}\\frac{d\\phi_k}{d\\hat{x}} \\, d\\hat{x} $$\n3.  **时间质量矩阵 ($M^t$):**\n    $$ M^t_{jl} = \\int_{-1}^{1} \\psi_j(\\hat{t})\\psi_l(\\hat{t}) \\, d\\hat{t} $$\n4.  **时间导数耦合矩阵 ($C^t$):**\n    $$ C^t_{jl} = \\int_{-1}^{1} \\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}} \\, d\\hat{t} $$\n使用这些定义，矩阵条目为 $A_{(ij)(kl)} = \\frac{h_x}{2} M^x_{ik} C^t_{jl} + \\kappa \\frac{h_t}{h_x} K^x_{ik} M^t_{jl}$。\n\n接下来，我们确定精确积分这些矩阵所需的最小 Gauss-Legendre 求积点数。一个具有 $n$ 个点的 Gauss-Legendre 法则对于最高为 $2n-1$ 阶的多项式是精确的。\n\n对于空间矩阵：\n- $M^x_{ik}$ 的被积函数 $\\phi_i(\\hat{x})\\phi_k(\\hat{x})$ 是一个阶数最高为 $p_x + p_x = 2p_x$ 的多项式。为实现精确积分，我们需要 $2n_x - 1 \\ge 2p_x$，这意味着 $n_x \\ge p_x + 1/2$。最小整数值为 $n_x = p_x + 1$。\n- 基函数 $\\phi_k(\\hat{x})$ 的阶数最高为 $p_x$，所以其导数 $\\frac{d\\phi_k}{d\\hat{x}}$ 的阶数最高为 $p_x - 1$。$K^x_{ik}$ 的被积函数 $\\frac{d\\phi_i}{d\\hat{x}}\\frac{d\\phi_k}{d\\hat{x}}$ 是一个阶数最高为 $(p_x - 1) + (p_x - 1) = 2p_x - 2$ 的多项式。为实现精确积分，我们需要 $2n_x - 1 \\ge 2p_x - 2$，这意味着 $n_x \\ge p_x - 1/2$。最小整数值为 $n_x = p_x$。\n\n为了精确积分所有空间项，我们必须满足更严格的条件，该条件来自质量矩阵。因此，空间上的最小 Gauss 点数为 $n_x = p_x + 1$。\n\n对于时间矩阵：\n- $M^t_{jl}$ 的被积函数 $\\psi_j(\\hat{t})\\psi_l(\\hat{t})$ 是一个阶数最高为 $p_t + p_t = 2p_t$ 的多项式。为实现精确积分，我们需要 $2n_t - 1 \\ge 2p_t$，这意味着 $n_t \\ge p_t + 1/2$。最小整数值为 $n_t = p_t + 1$。\n- 基函数 $\\psi_j$ 和 $\\psi_l$ 的阶数最高为 $p_t$。导数 $\\frac{d\\psi_l}{d\\hat{t}}$ 的阶数最高为 $p_t - 1$。$C^t_{jl}$ 的被积函数 $\\psi_j(\\hat{t})\\frac{d\\psi_l}{d\\hat{t}}$ 是一个阶数最高为 $p_t + (p_t - 1) = 2p_t - 1$ 的多项式。为实现精确积分，我们需要 $2n_t - 1 \\ge 2p_t - 1$，这意味着 $n_t \\ge p_t$。最小整数值为 $n_t = p_t$。\n\n为了精确积分所有时间项，我们必须满足更严格的条件，该条件来自时间质量矩阵。因此，时间上的最小 Gauss 点数为 $n_t = p_t + 1$。\n\n为实现精确积分，所需的最小 Gauss-Legendre 点数在空间上为 $n_x = p_x + 1$，在时间上为 $n_t = p_t + 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_{x} + 1 & p_{t} + 1\n\\end{pmatrix}\n}\n$$", "id": "3525793"}, {"introduction": "接下来，我们面对一个更具挑战性的场景：对流主导问题。在此类问题中，标准的伽辽金（Galerkin）方法常常会失效，产生虚假的数值振荡。这个动手计算练习将引导您实现并测试一种基于流线迎风/彼得罗夫-伽辽金（SUPG）的稳定化时空方法，其目标是通过分析系统矩阵的特征值，将基于残差的稳定化理论概念与一个实际的稳定性度量（离散熵稳定性）联系起来。[@problem_id:3525752]", "problem": "考虑在时空板 $Q = \\Omega \\times (0,T)$ 上提出的标量对流-扩散-反应方程，其中 $\\Omega = (0,L)$ 且 $T > 0$，方程为\n$$\n\\partial_t u + a \\, \\partial_x u - \\varepsilon \\, \\partial_{xx} u + c \\, u = 0 \\quad \\text{in } Q,\n$$\n其中 $a \\in \\mathbb{R}$ 是一个常数对流速度，$\\varepsilon \\ge 0$ 是一个扩散系数，$c \\ge 0$ 是一个反应系数。假设源项为齐次且无外力。时空弱形式寻求 $u \\in H^1(Q)$，使得对于所有 $v \\in H^1(Q)$，\n$$\n\\int_Q \\left( \\partial_t u \\, v + a \\, \\partial_x u \\, v + \\varepsilon \\, \\partial_x u \\, \\partial_x v + c \\, u \\, v \\right) \\, dx \\, dt = 0.\n$$\n\n你的任务是在均匀张量积网格上，使用双线性 ($Q_1$) 基函数，构建一个时空有限元方法。该方法通过在单元上施加基于 Streamline-Upwind/Petrov–Galerkin (SUPG) 或 Galerkin/Least-Squares (GLS) 残差的项来进行稳定化。在每个矩形时空单元 $K \\subset Q$上，设残差算子为\n$$\nR(u) = \\partial_t u + a \\, \\partial_x u + c \\, u,\n$$\n并添加一个形式如下的稳定化贡献\n$$\n\\sum_{K} \\int_K \\tau_K \\, R(u_h) \\, R(v_h) \\, dx \\, dt,\n$$\n其中 $\\tau_K > 0$ 是一个可调参数，它可能依赖于局部网格尺寸和系数，但其选择必须确保下文所述意义上的离散熵稳定性。\n\n将有限维空间上的离散双线性形式 $B(\\cdot,\\cdot)$ 定义为\n$$\nB(u_h,v_h) = \\sum_K \\int_K \\left( \\partial_t u_h \\, v_h + a \\, \\partial_x u_h \\, v_h + \\varepsilon \\, \\partial_x u_h \\, \\partial_x v_h + c \\, u_h \\, v_h \\right) \\, dx \\, dt + \\sum_K \\int_K \\tau_K \\, R(u_h) \\, R(v_h) \\, dx \\, dt.\n$$\n\n考虑离散熵泛函\n$$\n\\mathcal{E}(u_h) = \\frac{1}{2} \\int_Q u_h^2 \\, dx \\, dt,\n$$\n以及双线性算子的对称部分\n$$\nB_{\\mathrm{sym}}(u_h,u_h) = \\frac{1}{2} \\left( B(u_h,u_h) + B(u_h,u_h) \\right) = B(u_h,u_h).\n$$\n使用与双线性形式 $B(\\cdot,\\cdot)$ 对应的有限元矩阵和与 $\\mathcal{E}(\\cdot)$ 对应的时空质量矩阵，你必须通过计算稳定化算子对称部分相对于质量矩阵的最小广义特征值来量化离散熵稳定性。具体来说，设 $\\mathsf{B}$ 是为 $B(\\cdot,\\cdot)$ 组装的矩阵，$\\mathsf{M}$ 是组装的质量矩阵；定义\n$$\n\\lambda_{\\min} = \\min_{\\mathbf{u} \\neq \\mathbf{0}} \\frac{\\mathbf{u}^\\top \\left( \\frac{\\mathsf{B} + \\mathsf{B}^\\top}{2} \\right) \\mathbf{u}}{\\mathbf{u}^\\top \\mathsf{M} \\, \\mathbf{u}}.\n$$\n如果 $\\lambda_{\\min} \\ge 0$（在 $10^{-10}$ 的数值容差内），则认为达到了熵稳定性。\n\n你的任务是：\n- 在空间上有 $N_x$ 个单元、时间上有 $N_t$ 个单元的均匀网格上，使用双线性 ($Q_1$) 基函数和通过高斯求积的精确积分，组装时空有限元矩阵。\n- 实现基于残差的稳定化项，其单元参数 $\\tau_K$ 采用科学上合理的选择，该选择随局部网格尺寸和系数进行缩放。该参数化必须包含一个用户可调的标量 $\\alpha > 0$，用于控制稳定化的总体幅度。\n- 对于下面的每个测试用例，计算 $\\lambda_{\\min}$ 并报告是否达到离散熵稳定性（如果在容差范围内 $\\lambda_{\\min} \\ge 0$，则为布尔值 true，否则为 false）。\n\n所有量均为无量纲。不出现角度。不适用百分比。\n\n测试套件：\n- 情况 1 (理想情况，强对流和弱扩散): $L = 1$, $T = 1$, $a = 10$, $\\varepsilon = 10^{-6}$, $c = 0$, $N_x = 6$, $N_t = 6$, $\\alpha = 0.2$。\n- 情况 2 (增加稳定化): $L = 1$, $T = 1$, $a = 10$, $\\varepsilon = 10^{-6}$, $c = 0$, $N_x = 6$, $N_t = 6$, $\\alpha = 1.0$。\n- 情况 3 (较粗网格，更强对流): $L = 1$, $T = 1$, $a = 20$, $\\varepsilon = 10^{-6}$, $c = 0$, $N_x = 3$, $N_t = 2$, $\\alpha = 2.0$。\n- 情况 4 (反应主导的稳定化辅助): $L = 1$, $T = 1$, $a = 5$, $\\varepsilon = 10^{-3}$, $c = 1.0$, $N_x = 8$, $N_t = 8$, $\\alpha = 0.3$。\n- 情况 5 (零扩散和零反应的边界情况，无稳定化): $L = 1$, $T = 1$, $a = 7$, $\\varepsilon = 0$, $c = 0$, $N_x = 8$, $N_t = 8$, $\\alpha = 0.0$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4,result5]\"），其中每个结果是一个布尔值，指示相应测试用例是否达到熵稳定性。", "solution": "经评估，用户提供的问题是有效的。它在计算流体动力学和数值分析理论中有科学依据，特别是关于稳定化的时空有限元方法。该问题是适定的、客观的，并包含所有必要信息以推导出唯一、可验证的解，前提是为稳定化参数 $\\tau_K$ 做出一个标准的、科学上合理的选择。\n\n任务是确定一个标量对流-扩散-反应方程的时空有限元方法的离散熵稳定性。这种稳定性通过计算离散算子矩阵 $\\mathsf{B}$ 的对称部分相对于质量矩阵 $\\mathsf{M}$ 的最小广义特征值 $\\lambda_{\\min}$ 来量化。如果 $\\lambda_{\\min} \\ge 0$，则认为达到了稳定性。\n\n以下步骤概述了求解方法：\n\n1.  **有限元离散化**：将时空域 $Q = (0,L) \\times (0,T)$ 离散化为 $N_x \\times N_t$ 个矩形单元的均匀网格，每个单元尺寸为 $h_x \\times h_t$，其中 $h_x = L/N_x$ 和 $h_t = T/N_t$。在每个单元上，解 $u_h$ 在时空公式中使用双线性 ($Q_1$) 基函数 $\\phi_i$ 进行近似。一个单元 $K$ 上的局部解为 $u_h|_K = \\sum_{j=1}^{4} u_j \\phi_j(\\xi, \\eta)$，其中 $(\\xi, \\eta)$ 是参考单元 $[-1, 1] \\times [-1, 1]$ 上的坐标。\n\n2.  **双线性形式和单元矩阵**：离散双线性形式 $B(u_h, v_h)$ 由标准的伽辽金项和一个稳定化项组成。对于每个单元 $K$，我们计算一个 $4 \\times 4$ 的单元矩阵 $\\mathsf{B}^e$ 和一个单元质量矩阵 $\\mathsf{M}^e$。它们的项由以下公式给出：\n    $$\n    \\mathsf{M}^e_{ij} = \\int_K \\phi_i \\phi_j \\, dx \\, dt\n    $$\n    $$\n    \\mathsf{B}^e_{ij} = \\int_K \\left( \\partial_t \\phi_j \\, \\phi_i + a \\, \\partial_x \\phi_j \\, \\phi_i + \\varepsilon \\, \\partial_x \\phi_j \\, \\partial_x \\phi_i + c \\, \\phi_j \\, \\phi_i \\right) \\, dx \\, dt + \\int_K \\tau_K \\, R(\\phi_j) \\, R(\\phi_i) \\, dx \\, dt\n    $$\n    其中 $i$ 和 $j$ 是从 $1$ 到 $4$ 的局部节点索引。积分通过变量替换和数值求积在参考单元上计算。从参考单元 $[-1, 1]^2$到尺寸为 $h_x \\times h_t$ 的物理单元的映射的雅可比行列式是 $J = h_x h_t / 4$。导数变换为 $\\partial_x = (2/h_x)\\partial_\\xi$ 和 $\\partial_t = (2/h_t)\\partial_\\eta$。所有被积函数在 $(\\xi, \\eta)$ 中至多是 $(2,2)$ 次的多项式，因此 $2 \\times 2$ 的高斯求积法则足以进行精确积分。\n\n3.  **稳定化参数 $\\tau_K$**：问题要求为 $\\tau_K$ 提供一个科学上合理的选择。对于一个对流-扩散-反应问题，Galerkin/Least-Squares (GLS) 稳定化参数的一个标准选择是基于微分算子各分量范数的倒数。我们采用以下广泛使用的形式，并包含可调参数 $\\alpha$：\n    $$\n    \\tau_K = \\alpha \\left( \\left(\\frac{2}{h_t}\\right)^2 + \\left(\\frac{2a}{h_x}\\right)^2 + c^2 \\right)^{-1/2}\n    $$\n    这种形式能正确地随网格尺寸 ($h_x, h_t$) 和物理系数 ($a, c$) 缩放，并且在维度上是一致的（假设如问题所述为无量纲系统）。因子 $2$ 源于线性基函数在长度为 $2$ 的区间上的导数。如果分母接近于零（例如，$a=c=0$ 且 $h_t$ 非常大），应谨慎处理 $\\tau_K$；在实际实现中，该公式对于所提供的测试用例是鲁棒的。\n\n4.  **矩阵组装**：计算网格中每个单元的单元矩阵 $\\mathsf{B}^e$ 和 $\\mathsf{M}^e$，并将它们组装成大小为 $(N_x+1)(N_t+1) \\times (N_x+1)(N_t+1)$ 的全局矩阵 $\\mathsf{B}$ 和 $\\mathsf{M}$。建立一个从局部单元节点编号到全局自由度索引的映射，以将单元贡献正确地放置到全局系统中。\n\n5.  **特征值分析**：稳定性分析的核心是求解广义特征值问题：\n    $$\n    \\mathsf{B}_{\\mathrm{sym}} \\mathbf{u} = \\lambda \\mathsf{M} \\mathbf{u}\n    $$\n    其中 $\\mathsf{B}_{\\mathrm{sym}} = (\\mathsf{B} + \\mathsf{B}^\\top)/2$ 是算子矩阵 $\\mathsf{B}$ 的对称部分。质量矩阵 $\\mathsf{M}$ 是对称正定的。求解此问题以获得所有特征值 $\\lambda$，并确定最小特征值 $\\lambda_{\\min}$。\n\n6.  **稳定性判定**：如果在指定的数值容差 $10^{-10}$ 内 $\\lambda_{\\min} \\ge 0$，则认为离散系统是熵稳定的。对每个测试用例检查此条件，并报告一个布尔结果（`true` 或 `false`）。此方法将针对提供的测试套件进行实现。", "answer": "[true,true,true,true,false]", "id": "3525752"}, {"introduction": "现在，我们将视野拓宽到多物理场应用，时空方法在处理这类问题，尤其是在界面处存在非协调网格的情况下，表现得尤为出色。本练习将分析一种常用于在界面上弱施加连续性的技术——砂浆投影（mortar projection）。通过这一推导，您将深入了解此类耦合方法的代数结构（通过克罗内克积）和数值稳定性（通过推导条件数），这对于开发稳健的模拟至关重要。[@problem_id:3525785]", "problem": "考虑一个一维空间加时间的模型多物理场界面耦合，其中两个子域共享一个直线空间界面段 $\\gamma = [0, h_m]$，并在一个单一时空板 $\\Gamma = \\gamma \\times [0, \\Delta t_m]$ 上耦合。该耦合通过在 $\\Gamma$ 上的一个 $L^2$ 型砂浆投影来施加运动学量（例如，固-声相互作用中的位移迹）的弱连续性。$\\Gamma$ 上的主 (砂浆) 迹空间被选为由空间和时间上的规范线性 (帽子) 基函数张成的双线性张量積空間：\n- 空间上：在 $y \\in [0, h_m]$ 上，$N_1(y) = 1 - \\frac{y}{h_m}$ 和 $N_2(y) = \\frac{y}{h_m}$。\n- 时间上：在 $t \\in [0, \\Delta t_m]$ 上，$T_1(t) = 1 - \\frac{t}{\\Delta t_m}$ 和 $T_2(t) = \\frac{t}{\\Delta t_m}$。\n\n因此，$\\Gamma$ 上的主基为 $\\{N_p(y) T_q(t)\\}_{p,q=1}^{2}$，具有四个自由度。从迹空间取为在 $\\Gamma$ 的一个均匀剖分上的分片常数，该剖分在空间上分为 $r_h \\geq 2$ 个相等的子段，在时间上分为 $r_t \\geq 2$ 个相等的子区间，其中 $r_h$ 和 $r_t$ 均为整数。将从基记为 $\\{\\chi_{i}(y) \\eta_{j}(t)\\}$，其中 $\\chi_{i}$ 是长度为 $h_s = h_m / r_h$ 的第 $i$ 个空间子段的特征函数，$\\eta_{j}$ 是长度为 $\\Delta t_s = \\Delta t_m / r_t$ 的第 $j$ 个时间子区间的特征函数，这给出了 $r_h r_t$ 个从自由度。\n\n使用 $L^2(\\Gamma)$ 内积，定义主质量矩阵块 $M_{mm}$，其元素为\n$$\n(M_{mm})_{(p,q),(p',q')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, N_{p'}(y) T_{q'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t,\n$$\n从质量矩阵块 $M_{ss}$（对角阵），其元素为\n$$\n(M_{ss})_{(i,j),(i',j')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} \\chi_i(y) \\eta_j(t)\\, \\chi_{i'}(y) \\eta_{j'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t,\n$$\n以及交叉耦合块 $M_{ms}$，其元素为\n$$\n(M_{ms})_{(p,q),(i,j)} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, \\chi_i(y) \\eta_j(t)\\, \\mathrm{d}y\\, \\mathrm{d}t.\n$$\n\n从这些定义和砂浆投影原理（在 $L^2(\\Gamma)$ 中的最小二乘）出发，计算 $M_{mm}$、$M_{ss}$ 和 $M_{ms}$ 的显式形式，并构建 $4 \\times 4$ 的对称正定法向算子\n$$\nA = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm},\n$$\n其中 $M_{sm} = M_{ms}^{\\top}$。然后，使用第一性原理和精确积分，推导谱 2-范数条件数 $\\kappa_2(A)$ 关于整数比 $r_h = h_m / h_s$ 和 $r_t = \\Delta t_m / \\Delta t_s$ 的闭式表达式。\n\n将最终的条件数表示为关于 $r_h$ 和 $r_t$ 的单个闭式解析表达式。答案中无需四舍五入，也不应包含物理单位。", "solution": "该问题被验证为具有科学依据、适定、客观，并包含足够的信息以获得唯一解。所涉及的概念在有限元方法的数值分析领域中是标准的。\n\n目标是求 $4 \\times 4$ 矩阵 $A = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm}$ 的谱条件数 $\\kappa_2(A)$。解决此问题的关键是识别并利用基函数和定义域的张量积结构。\n\n在 $\\Gamma = [0, h_m] \\times [0, \\Delta t_m]$ 上的主基函数形式为 $N_p(y)T_q(t)$。定义矩阵元素的积分在空间变量 $y$ 和时间变量 $t$ 上是可分离的。\n\n首先，我们分析主质量矩阵 $M_{mm}$。其元素为：\n$$(M_{mm})_{(p,q),(p',q')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, N_{p'}(y) T_{q'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t$$\n$$= \\left( \\int_{0}^{h_m} N_p(y) N_{p'}(y) \\mathrm{d}y \\right) \\left( \\int_{0}^{\\Delta t_m} T_q(t) T_{q'}(t) \\mathrm{d}t \\right)$$\n让我们为空间域和时间域定义 $2 \\times 2$ 的一维质量矩阵：\n$$(M_y)_{pp'} = \\int_{0}^{h_m} N_p(y) N_{p'}(y) \\mathrm{d}y, \\quad p, p' \\in \\{1, 2\\}$$\n$$(M_t)_{qq'} = \\int_{0}^{\\Delta t_m} T_q(t) T_{q'}(t) \\mathrmd t, \\quad q, q' \\in \\{1, 2\\}$$\n$4 \\times 4$ 的主质量矩阵就是这两个矩阵的克罗内克积：$M_{mm} = M_y \\otimes M_t$。\n\n接下来，我们分析从质量矩阵 $M_{ss}$。从基函数 $\\{\\chi_i(y) \\eta_j(t)\\}$ 具有不相交的支集。\n$$(M_{ss})_{(i,j),(i',j')} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} \\chi_i(y) \\eta_j(t)\\, \\chi_{i'}(y) \\eta_{j'}(t)\\, \\mathrm{d}y\\, \\mathrm{d}t = \\delta_{ii'} \\delta_{jj'} \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} \\int_{(i-1)h_s}^{ih_s} \\mathrm{d}y\\, \\mathrm{d}t$$\n该积分是从单元的面积，即 $h_s \\Delta t_s$。因此，$M_{ss}$ 是一个大小为 $(r_h r_t) \\times (r_h r_t)$ 的对角矩阵，所有对角元素都等于 $h_s \\Delta t_s$。\n$$M_{ss} = (h_s \\Delta t_s) I_{r_h r_t}$$\n其中 $I_k$ 是 $k \\times k$ 的单位矩阵。其逆矩阵为 $M_{ss}^{-1} = \\frac{1}{h_s \\Delta t_s} I_{r_h r_t}$。\n\n现在，我们考虑交叉耦合矩阵 $M_{ms}$。其元素为：\n$$(M_{ms})_{(p,q),(i,j)} = \\int_{0}^{\\Delta t_m} \\int_{0}^{h_m} N_p(y) T_q(t)\\, \\chi_i(y) \\eta_j(t)\\, \\mathrm{d}y\\, \\mathrm{d}t$$\n$$= \\left( \\int_{0}^{h_m} N_p(y) \\chi_i(y) \\mathrm{d}y \\right) \\left( \\int_{0}^{\\Delta t_m} T_q(t) \\eta_j(t) \\mathrmd t \\right) = \\left( \\int_{(i-1)h_s}^{ih_s} N_p(y) \\mathrm{d}y \\right) \\left( \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} T_q(t) \\mathrmd t \\right)$$\n让我们定义 $2 \\times r_h$ 和 $2 \\times r_t$ 的一维耦合矩阵：\n$$(C_y)_{pi} = \\int_{(i-1)h_s}^{ih_s} N_p(y) \\mathrm{d}y, \\quad p \\in \\{1,2\\}, i \\in \\{1, \\dots, r_h\\}$$\n$$(C_t)_{qj} = \\int_{(j-1)\\Delta t_s}^{j\\Delta t_s} T_q(t) \\mathrmd t, \\quad q \\in \\{1,2\\}, j \\in \\{1, \\dots, r_t\\}$$\n交叉耦合矩阵 $M_{ms}$ 是一个 $4 \\times (r_h r_t)$ 矩阵，可以表示为克罗内克积 $M_{ms} = C_y \\otimes C_t$。\n\n现在我们构造算子 $A$。\n$$A = M_{mm}^{-1} \\, M_{ms} \\, M_{ss}^{-1} \\, M_{sm}$$\n利用克罗内克积的表示及其性质 $(B \\otimes C)^{-1} = B^{-1} \\otimes C^{-1}$ 和 $(B \\otimes C)^\\top = B^\\top \\otimes C^\\top$：\n$$A = (M_y \\otimes M_t)^{-1} (C_y \\otimes C_t) \\left( \\frac{1}{h_s \\Delta t_s} I_{r_h r_t} \\right) (C_y \\otimes C_t)^\\top$$\n$$A = (M_y^{-1} \\otimes M_t^{-1}) (C_y \\otimes C_t) \\frac{1}{h_s \\Delta t_s} (C_y^\\top \\otimes C_t^\\top)$$\n利用混合积性质 $(B_1 \\otimes C_1)(B_2 \\otimes C_2) = (B_1 B_2) \\otimes (C_1 C_2)$：\n$$A = \\frac{1}{h_s \\Delta t_s} (M_y^{-1} \\otimes M_t^{-1}) (C_y C_y^\\top \\otimes C_t C_t^\\top)$$\n$$A = \\frac{1}{h_s \\Delta t_s} (M_y^{-1} C_y C_y^\\top) \\otimes (M_t^{-1} C_t C_t^\\top)$$\n$$A = \\left( \\frac{1}{h_s} M_y^{-1} C_y C_y^\\top \\right) \\otimes \\left( \\frac{1}{\\Delta t_s} M_t^{-1} C_t C_t^\\top \\right)$$\n令 $A_y = \\frac{1}{h_s} M_y^{-1} C_y C_y^\\top$ 和 $A_t = \\frac{1}{\\Delta t_s} M_t^{-1} C_t C_t^\\top$。那么 $A = A_y \\otimes A_t$。\n克罗内克积的特征值是其因子矩阵特征值的乘积。由于 $A$ 是一个对称正定矩阵，其谱条件数是其最大特征值与最小特征值的比值。\n$$\\kappa_2(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} = \\frac{\\lambda_{\\max}(A_y) \\lambda_{\\max}(A_t)}{\\lambda_{\\min}(A_y) \\lambda_{\\min}(A_t)} = \\kappa_2(A_y) \\kappa_2(A_t)$$\n问题简化为求解一个通用的一维情况。让我们求解 $A_y$。\n\n空间基函数为 $N_1(y) = 1 - y/h_m$ 和 $N_2(y) = y/h_m$。\n一维质量矩阵 $M_y$ 为：\n$$(M_y)_{11} = \\int_0^{h_m} (1 - y/h_m)^2 \\mathrm{d}y = \\frac{h_m}{3}$$\n$$(M_y)_{22} = \\int_0^{h_m} (y/h_m)^2 \\mathrm{d}y = \\frac{h_m}{3}$$\n$$(M_y)_{12} = (M_y)_{21} = \\int_0^{h_m} (1 - y/h_m)(y/h_m) \\mathrm{d}y = \\frac{h_m}{6}$$\n所以，$M_y = \\frac{h_m}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$。其逆矩阵为 $M_y^{-1} = \\frac{2}{h_m} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$。\n\n一维耦合矩阵 $C_y$ 的元素为：\n$$(C_y)_{1i} = \\int_{(i-1)h_s}^{ih_s} (1 - y/h_m) \\mathrm{d}y = h_s\\left(1 - \\frac{2i-1}{2r_h}\\right)$$\n$$(C_y)_{2i} = \\int_{(i-1)h_s}^{ih_s} (y/h_m) \\mathrm{d}y = h_s\\frac{2i-1}{2r_h}$$\n我们需要计算 $G_y = C_y C_y^\\top$。这是一个 $2 \\times 2$ 矩阵，其元素为 $(G_y)_{pp'} = \\sum_{i=1}^{r_h} (C_y)_{pi} (C_y)_{p'i}$。使用求和法则 $\\sum_{i=1}^{n} (2i-1) = n^2$ 和 $\\sum_{i=1}^{n} (2i-1)^2 = \\frac{n(4n^2-1)}{3}$：\n$$(G_y)_{22} = \\sum_{i=1}^{r_h} \\left(h_s\\frac{2i-1}{2r_h}\\right)^2 = \\frac{h_s^2}{4r_h^2} \\sum_{i=1}^{r_h} (2i-1)^2 = \\frac{h_s^2}{4r_h^2} \\frac{r_h(4r_h^2-1)}{3} = \\frac{h_s^2(4r_h^2-1)}{12r_h}$$\n$$(G_y)_{11} = \\sum_{i=1}^{r_h} h_s^2 \\left(1 - \\frac{2i-1}{2r_h}\\right)^2 = h_s^2 \\sum_{i=1}^{r_h} \\left(1 - \\frac{2i-1}{r_h} + \\frac{(2i-1)^2}{4r_h^2}\\right) = h_s^2 \\left(r_h - \\frac{r_h^2}{r_h} + \\frac{r_h(4r_h^2-1)}{12r_h^2}\\right) = \\frac{h_s^2(4r_h^2-1)}{12r_h}$$\n$$(G_y)_{12} = \\sum_{i=1}^{r_h} h_s\\left(1 - \\frac{2i-1}{2r_h}\\right) h_s\\frac{2i-1}{2r_h} = \\frac{h_s^2}{2r_h}\\sum(2i-1) - \\frac{h_s^2}{4r_h^2}\\sum(2i-1)^2 = \\frac{h_s^2 r_h^2}{2r_h} - (G_y)_{22} = \\frac{h_s^2 r_h}{2} - \\frac{h_s^2(4r_h^2-1)}{12r_h} = \\frac{h_s^2(2r_h^2+1)}{12r_h}$$\n所以 $G_y = \\frac{h_s^2}{12r_h} \\begin{pmatrix} 4r_h^2-1 & 2r_h^2+1 \\\\ 2r_h^2+1 & 4r_h^2-1 \\end{pmatrix}$。\n\n现在，我们组装 $A_y = \\frac{1}{h_s} M_y^{-1} G_y$。使用 $h_m = r_h h_s$：\n$$A_y = \\frac{1}{h_s} \\left(\\frac{2}{r_h h_s} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\\right) \\left(\\frac{h_s^2}{12r_h} \\begin{pmatrix} 4r_h^2-1 & 2r_h^2+1 \\\\ 2r_h^2+1 & 4r_h^2-1 \\end{pmatrix}\\right)$$\n$$A_y = \\frac{1}{6r_h^2} \\begin{pmatrix} 2(4r_h^2-1)-(2r_h^2+1) & 2(2r_h^2+1)-(4r_h^2-1) \\\\ -(4r_h^2-1)+2(2r_h^2+1) & -(2r_h^2+1)+2(4r_h^2-1) \\end{pmatrix}$$\n$$A_y = \\frac{1}{6r_h^2} \\begin{pmatrix} 6r_h^2-3 & 3 \\\\ 3 & 6r_h^2-3 \\end{pmatrix} = \\begin{pmatrix} 1-\\frac{1}{2r_h^2} & \\frac{1}{2r_h^2} \\\\ \\frac{1}{2r_h^2} & 1-\\frac{1}{2r_h^2} \\end{pmatrix}$$\n形如 $\\begin{pmatrix} a & b \\\\ b & a \\end{pmatrix}$ 的 $2 \\times 2$ 矩阵的特征值 $\\lambda$ 为 $\\lambda_1 = a+b$ 和 $\\lambda_2 = a-b$。\n对于 $A_y$，有 $a = 1-\\frac{1}{2r_h^2}$ 和 $b = \\frac{1}{2r_h^2}$。\n特征值为 $\\lambda_{y,\\max} = a+b = 1$ 和 $\\lambda_{y,\\min} = a-b = 1-\\frac{1}{r_h^2}$。\n$A_y$ 的条件数为：\n$$\\kappa_2(A_y) = \\frac{\\lambda_{y,\\max}}{\\lambda_{y,\\min}} = \\frac{1}{1 - 1/r_h^2} = \\frac{r_h^2}{r_h^2-1}$$\n以此类推，对时间维度的分析是相同的，只需将 $h_m, h_s, r_h$ 替换为 $\\Delta t_m, \\Delta t_s, r_t$。\n$$\\kappa_2(A_t) = \\frac{r_t^2}{r_t^2-1}$$\n最后，完整算子 $A$ 的条件数是一维条件数的乘积：\n$$\\kappa_2(A) = \\kappa_2(A_y) \\kappa_2(A_t) = \\left(\\frac{r_h^2}{r_h^2-1}\\right) \\left(\\frac{r_t^2}{r_t^2-1}\\right) = \\frac{r_h^2 r_t^2}{(r_h^2-1)(r_t^2-1)}$$\n这就是谱条件数关于 $r_h$ 和 $r_t$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{r_h^2 r_t^2}{(r_h^2-1)(r_t^2-1)}}$$", "id": "3525785"}]}