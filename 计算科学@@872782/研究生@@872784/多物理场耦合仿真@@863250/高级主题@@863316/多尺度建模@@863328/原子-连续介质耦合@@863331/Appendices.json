{"hands_on_practices": [{"introduction": "原子-连续介质耦合的核心挑战之一是如何在两种不同尺度的描述之间传递信息。一种常见的方法是运动学耦合，其中连续介质的位移场通过拟合离散的原子运动来确定。这个练习 [@problem_id:3496630] 将通过一个最小二乘法拟合问题，让你亲手计算如何从一组原子位移数据中提取出最能代表其整体变形的连续介质单元节点位移。", "problem": "考虑一个用于在桥接域中耦合分子动力学 (MD) 和有限元方法 (FEM) 的单一四节点双线性四边形有限元。该单元的四个物理节点位于 $(0,0)$、$(1,0)$、$(1,1)$ 和 $(0,1)$，分别对应于自然坐标 $(\\xi,\\eta)=(-1,-1)$、$(1,-1)$、$(1,1)$ 和 $(-1,1)$。单元内的连续位移场 $\\boldsymbol{u}(\\xi,\\eta)$ 是使用标准双线性形函数从节点位移向量插值得到的：\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n设未知节点位移向量为\n$$\n\\boldsymbol{U}=\\begin{pmatrix}u_{1x}\\\\u_{1y}\\\\u_{2x}\\\\u_{2y}\\\\u_{3x}\\\\u_{3y}\\\\u_{4x}\\\\u_{4y}\\end{pmatrix},\n$$\n其中 $(u_{ix},u_{iy})$ 是节点 $i$ 处位移的分量。\n\n在此单元内，MD 模拟中在以下自然坐标位置观测到五个原子，其测得的位移向量（单位为纳米）如下：\n- 原子 $1$ 位于 $(\\xi,\\eta)=(-1,-1)$，位移为 $\\boldsymbol{d}^{(1)}=(0,0)$。\n- 原子 $2$ 位于 $(\\xi,\\eta)=(1,-1)$，位移为 $\\boldsymbol{d}^{(2)}=(2,0)$。\n- 原子 $3$ 位于 $(\\xi,\\eta)=(1,1)$，位移为 $\\boldsymbol{d}^{(3)}=(2,1)$。\n- 原子 $4$ 位于 $(\\xi,\\eta)=(-1,1)$，位移为 $\\boldsymbol{d}^{(4)}=(0,1)$。\n- 原子 $5$ 位于 $(\\xi,\\eta)=(0,0)$，位移为 $\\boldsymbol{d}^{(5)}=(1,\\tfrac{1}{2})$。\n\n假设所有原子的权重相等，并将原子 $k$ 处的映射误差定义为\n$$\n\\boldsymbol{e}^{(k)}=\\boldsymbol{u}(\\xi^{(k)},\\eta^{(k)})-\\boldsymbol{d}^{(k)},\n$$\n其中原子 $k$ 处的连续位移由下式给出：\n$$\n\\boldsymbol{u}(\\xi^{(k)},\\eta^{(k)})=\\sum_{i=1}^{4}N_{i}(\\xi^{(k)},\\eta^{(k)})\\begin{pmatrix}u_{ix}\\\\u_{iy}\\end{pmatrix}.\n$$\n\n建立最小二乘问题，以最小化映射误差的平方和\n$$\nJ(\\boldsymbol{U})=\\sum_{k=1}^{5}\\left\\|\\boldsymbol{e}^{(k)}\\right\\|_{2}^{2},\n$$\n求解使该和最小化的节点位移向量 $\\boldsymbol{U}$，并计算残差向量的欧几里得 2-范数\n$$\n\\left\\|\\boldsymbol{r}\\right\\|_{2}=\\left(\\sum_{k=1}^{5}\\left\\|\\boldsymbol{e}^{(k)}\\right\\|_{2}^{2}\\right)^{\\tfrac{1}{2}}.\n$$\n\n以纳米为单位表示节点位移分量和残差范数。将最终答案以单行矩阵的形式给出，按顺序包含 $u_{1x}$、$u_{1y}$、$u_{2x}$、$u_{2y}$、$u_{3x}$、$u_{3y}$、$u_{4x}$、$u_{4y}$ 和 $\\|\\boldsymbol{r}\\|_{2}$。使用精确值，无需四舍五入。", "solution": "用户希望求解有限元的节点位移，以在最小二乘意义上最佳拟合一组原子位移数据。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **单元类型**：四节点双线性四边形有限元。\n- **节点物理坐标**：节点 1 位于 $(0,0)$，节点 2 位于 $(1,0)$，节点 3 位于 $(1,1)$，节点 4 位于 $(0,1)$。\n- **节点自然坐标**：节点 1 位于 $(\\xi,\\eta)=(-1,-1)$，节点 2 位于 $(\\xi,\\eta)=(1,-1)$，节点 3 位于 $(\\xi,\\eta)=(1,1)$，节点 4 位于 $(\\xi,\\eta)=(-1,1)$。\n- **形函数**：\n  $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$\n  $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$\n  $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$\n  $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$\n- **未知节点位移向量**：$\\boldsymbol{U}=\\begin{pmatrix}u_{1x}  u_{1y}  u_{2x}  u_{2y}  u_{3x}  u_{3y}  u_{4x}  u_{4y}\\end{pmatrix}^T$。\n- **原子数据（自然坐标和位移，单位 nm）**：\n  - 原子 1：$(\\xi^{(1)},\\eta^{(1)})=(-1,-1)$，$\\boldsymbol{d}^{(1)}=(0,0)$。\n  - 原子 2：$(\\xi^{(2)},\\eta^{(2)})=(1,-1)$，$\\boldsymbol{d}^{(2)}=(2,0)$。\n  - 原子 3：$(\\xi^{(3)},\\eta^{(3)})=(1,1)$，$\\boldsymbol{d}^{(3)}=(2,1)$。\n  - 原子 4：$(\\xi^{(4)},\\eta^{(4)})=(-1,1)$，$\\boldsymbol{d}^{(4)}=(0,1)$。\n  - 原子 5：$(\\xi^{(5)},\\eta^{(5)})=(0,0)$，$\\boldsymbol{d}^{(5)}=(1,\\tfrac{1}{2})$。\n- **目标函数**：最小化 $J(\\boldsymbol{U})=\\sum_{k=1}^{5}\\left\\|\\boldsymbol{e}^{(k)}\\right\\|_{2}^{2}$。\n- **映射误差**：$\\boldsymbol{e}^{(k)}=\\boldsymbol{u}(\\xi^{(k)},\\eta^{(k)})-\\boldsymbol{d}^{(k)}$。\n- **连续位移插值**：$\\boldsymbol{u}(\\xi^{(k)},\\eta^{(k)})=\\sum_{i=1}^{4}N_{i}(\\xi^{(k)},\\eta^{(k)})\\begin{pmatrix}u_{ix}\\\\u_{iy}\\end{pmatrix}$。\n- **要求输出**：最小化向量 $\\boldsymbol{U}$ 和残差范数 $\\|\\boldsymbol{r}\\|_{2}=\\left(\\sum_{k=1}^{5}\\left\\|\\boldsymbol{e}^{(k)}\\right\\|_{2}^{2}\\right)^{\\tfrac{1}{2}}$。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了在原子-连续介质耦合方法（如准连续介质 (QC) 方法或桥接域方法）中使用的标准最小二乘拟合过程。双线性形函数的使用和最小二乘问题的构建是有限元分析和多尺度建模中公认的原则。该问题在科学上是合理的。\n- **良定性**：这是一个线性最小二乘问题，如果系统矩阵是满秩的，那么该问题是良定的，并且有唯一解。鉴于原子数据点的分布，此条件得到满足。问题要求一组特定的数值，这些数值是唯一确定的。\n- **客观性**：所有术语都有数学和物理上的定义。语言精确，没有歧义或主观性。\n- **完整性**：提供了所有必要信息（形函数、原子数据、目标函数）。没有矛盾之处。\n- **真实性**：这个设置是计算材料科学中一个真实问题的标准（尽管简化了）表示。位移值在物理上是合理的。\n- **结构**：问题结构良好，从设置引导到目标函数，再到最终需要计算的量。\n- **平凡性/同义反复**：该问题需要对线性代数和有限元方法概念的非平凡应用。它不是一个简单的练习。\n\n**1.3. 结论与行动**\n问题是有效的。将提供完整解答。\n\n### 步骤 2：求解\n\n问题是求解使误差平方和 $J(\\boldsymbol{U})$ 最小化的节点位移向量 $\\boldsymbol{U}$。这是一个线性最小二乘问题。连续位移场 $\\boldsymbol{u}(\\xi, \\eta) = (u_x, u_y)^T$ 从节点位移 $\\boldsymbol{U}$ 内插得到：\n$$\n\\begin{pmatrix} u_x(\\xi, \\eta) \\\\ u_y(\\xi, \\eta) \\end{pmatrix} = \\begin{pmatrix} N_1  0  N_2  0  N_3  0  N_4  0 \\\\ 0  N_1  0  N_2  0  N_3  0  N_4 \\end{pmatrix} \\boldsymbol{U} = \\boldsymbol{N}(\\xi, \\eta) \\boldsymbol{U}\n$$\n问题是最小化 $J(\\boldsymbol{U}) = \\|\\boldsymbol{M}\\boldsymbol{U} - \\boldsymbol{D}_{obs}\\|_2^2$，其中 $\\boldsymbol{M}$ 是在各原子位置处求值的形函数矩阵，$\\boldsymbol{D}_{obs}$ 是观测到的原子位移向量。\n\n矩阵 $\\boldsymbol{M}$ 是一个 $10 \\times 8$ 矩阵，由 $k=1, ..., 5$ 的 $\\boldsymbol{N}(\\xi^{(k)}, \\eta^{(k)})$ 矩阵堆叠而成。向量 $\\boldsymbol{D}_{obs}$ 是一个 $10 \\times 1$ 的向量，由位移 $\\boldsymbol{d}^{(k)}$ 堆叠而成。\n\n首先，我们在每个原子的位置 $(\\xi^{(k)}, \\eta^{(k)})$ 处计算形函数 $N_i$ 的值。\n- 对于原子 1，位于 $(\\xi^{(1)}, \\eta^{(1)}) = (-1, -1)$：$N_1 = 1$，$N_2=N_3=N_4=0$。\n- 对于原子 2，位于 $(\\xi^{(2)}, \\eta^{(2)}) = (1, -1)$：$N_2 = 1$，$N_1=N_3=N_4=0$。\n- 对于原子 3，位于 $(\\xi^{(3)}, \\eta^{(3)}) = (1, 1)$：$N_3 = 1$，$N_1=N_2=N_4=0$。\n- 对于原子 4，位于 $(\\xi^{(4)}, \\eta^{(4)}) = (-1, 1)$：$N_4 = 1$，$N_1=N_2=N_3=0$。\n- 对于原子 5，位于 $(\\xi^{(5)}, \\eta^{(5)}) = (0, 0)$：$N_1 = N_2 = N_3 = N_4 = \\frac{1}{4}$。\n\n矩阵 $\\boldsymbol{M}$ 为：\n$$\n\\boldsymbol{M} =\n\\begin{pmatrix}\n1  0  0  0  0  0  0  0 \\\\\n0  1  0  0  0  0  0  0 \\\\\n0  0  1  0  0  0  0  0 \\\\\n0  0  0  1  0  0  0  0 \\\\\n0  0  0  0  1  0  0  0 \\\\\n0  0  0  0  0  1  0  0 \\\\\n0  0  0  0  0  0  1  0 \\\\\n0  0  0  0  0  0  0  1 \\\\\n\\frac{1}{4}  0  \\frac{1}{4}  0  \\frac{1}{4}  0  \\frac{1}{4}  0 \\\\\n0  \\frac{1}{4}  0  \\frac{1}{4}  0  \\frac{1}{4}  0  \\frac{1}{4}\n\\end{pmatrix}\n$$\n观测到的位移向量 $\\boldsymbol{D}_{obs}$ 为：\n$$\n\\boldsymbol{D}_{obs} = \\begin{pmatrix} 0  0  2  0  2  1  0  1  1  \\frac{1}{2} \\end{pmatrix}^T\n$$\n最小二乘解 $\\boldsymbol{U}$ 通过求解正规方程组得到：$(\\boldsymbol{M}^T \\boldsymbol{M}) \\boldsymbol{U} = \\boldsymbol{M}^T \\boldsymbol{D}_{obs}$。\n\n该问题有一个特殊结构：前四个原子位于单元的节点上。这简化了正规方程组。我们可以将误差平方和表示为：\n$$\nJ(\\boldsymbol{U}) = \\sum_{k=1}^{4} \\left\\| \\begin{pmatrix} u_{kx} \\\\ u_{ky} \\end{pmatrix} - \\boldsymbol{d}^{(k)} \\right\\|_2^2 + \\left\\| \\sum_{i=1}^{4} N_i(0,0) \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix} - \\boldsymbol{d}^{(5)} \\right\\|_2^2\n$$\n由于对所有 $i$ 都有 $N_i(0,0) = \\frac{1}{4}$：\n$$\nJ(\\boldsymbol{U}) = \\sum_{i=1}^{4} \\left( (u_{ix} - d_{ix})^2 + (u_{iy} - d_{iy})^2 \\right) + \\left\\| \\frac{1}{4}\\sum_{i=1}^{4} \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix} - \\boldsymbol{d}^{(5)} \\right\\|_2^2\n$$\n为最小化 $J$，我们将其关于 $\\boldsymbol{U}$ 的每个分量的偏导数设为零。该系统可解耦为 $x$ 和 $y$ 分量。对于任意节点位移分量 $u_{jx}$：\n$$\n\\frac{\\partial J}{\\partial u_{jx}} = 2(u_{jx} - d_{jx}) + 2 \\left( \\frac{1}{4}\\sum_{i=1}^{4} u_{ix} - d_{5x} \\right) \\frac{1}{4} = 0\n$$\n$$\n(u_{jx} - d_{jx}) + \\frac{1}{16}\\sum_{i=1}^{4} u_{ix} - \\frac{1}{4} d_{5x} = 0\n$$\n$$\n16(u_{jx} - d_{jx}) + \\sum_{i=1}^{4} u_{ix} - 4d_{5x} = 0\n$$\n$$\n17u_{jx} + \\sum_{i \\neq j} u_{ix} = 16d_{jx} + 4d_{5x}\n$$\n这为 $x$ 分量 $\\boldsymbol{U}_x = (u_{1x}, u_{2x}, u_{3x}, u_{4x})^T$ 提供了一个 $4 \\times 4$ 的系统，对 $y$ 分量 $\\boldsymbol{U}_y = (u_{1y}, u_{2y}, u_{3y}, u_{4y})^T$ 也有一个类似的系统。\n\n**求解 x 分量：**\n测得的位移为 $d_{1x}=0$、$d_{2x}=2$、$d_{3x}=2$、$d_{4x}=0$ 和 $d_{5x}=1$。\n线性系统为：\n$$\n\\begin{pmatrix}\n17  1  1  1 \\\\\n1  17  1  1 \\\\\n1  1  17  1 \\\\\n1  1  1  17\n\\end{pmatrix}\n\\begin{pmatrix} u_{1x} \\\\ u_{2x} \\\\ u_{3x} \\\\ u_{4x} \\end{pmatrix}\n=\n\\begin{pmatrix}\n16(0) + 4(1) \\\\\n16(2) + 4(1) \\\\\n16(2) + 4(1) \\\\\n16(0) + 4(1)\n\\end{pmatrix}\n=\n\\begin{pmatrix} 4 \\\\ 36 \\\\ 36 \\\\ 4 \\end{pmatrix}\n$$\n通过观察，或通过求解该系统，我们得到解 $\\boldsymbol{U}_x = \\begin{pmatrix} 0  2  2  0 \\end{pmatrix}^T$。我们来验证一下：\n- 方程 1：$17(0) + 2 + 2 + 0 = 4$。正确。\n- 方程 2：$0 + 17(2) + 2 + 0 = 34 + 2 = 36$。正确。\n- 方程 3：$0 + 2 + 17(2) + 0 = 34 + 2 = 36$。正确。\n- 方程 4：$0 + 2 + 2 + 17(0) = 4$。正确。\n\n**求解 y 分量：**\n测得的位移为 $d_{1y}=0$、$d_{2y}=0$、$d_{3y}=1$、$d_{4y}=1$ 和 $d_{5y}=\\frac{1}{2}$。\n线性系统为：\n$$\n\\begin{pmatrix}\n17  1  1  1 \\\\\n1  17  1  1 \\\\\n1  1  17  1 \\\\\n1  1  1  17\n\\end{pmatrix}\n\\begin{pmatrix} u_{1y} \\\\ u_{2y} \\\\ u_{3y} \\\\ u_{4y} \\end{pmatrix}\n=\n\\begin{pmatrix}\n16(0) + 4(\\frac{1}{2}) \\\\\n16(0) + 4(\\frac{1}{2}) \\\\\n16(1) + 4(\\frac{1}{2}) \\\\\n16(1) + 4(\\frac{1}{2})\n\\end{pmatrix}\n=\n\\begin{pmatrix} 2 \\\\ 2 \\\\ 18 \\\\ 18 \\end{pmatrix}\n$$\n通过观察，或通过求解该系统，我们得到解 $\\boldsymbol{U}_y = \\begin{pmatrix} 0  0  1  1 \\end{pmatrix}^T$。我们来验证一下：\n- 方程 1：$17(0) + 0 + 1 + 1 = 2$。正确。\n- 方程 2：$0 + 17(0) + 1 + 1 = 2$。正确。\n- 方程 3：$0 + 0 + 17(1) + 1 = 18$。正确。\n- 方程 4：$0 + 0 + 1 + 17(1) = 18$。正确。\n\n得到的节点位移向量为 $\\boldsymbol{U} = \\begin{pmatrix} 0  0  2  0  2  1  0  1 \\end{pmatrix}^T$。\n\n**计算残差范数：**\n残差范数是 $\\|\\boldsymbol{r}\\|_{2} = \\sqrt{J(\\boldsymbol{U})}$。我们必须计算每个原子的误差 $\\boldsymbol{e}^{(k)}$。\n- 原子 1 ($k=1$)：$\\boldsymbol{u}(\\xi^{(1)},\\eta^{(1)}) = (u_{1x}, u_{1y}) = (0,0)$。$\\boldsymbol{d}^{(1)} = (0,0)$。$\\boldsymbol{e}^{(1)}=(0,0)$。\n- 原子 2 ($k=2$)：$\\boldsymbol{u}(\\xi^{(2)},\\eta^{(2)}) = (u_{2x}, u_{2y}) = (2,0)$。$\\boldsymbol{d}^{(2)} = (2,0)$。$\\boldsymbol{e}^{(2)}=(0,0)$。\n- 原子 3 ($k=3$)：$\\boldsymbol{u}(\\xi^{(3)},\\eta^{(3)}) = (u_{3x}, u_{3y}) = (2,1)$。$\\boldsymbol{d}^{(3)} = (2,1)$。$\\boldsymbol{e}^{(3)}=(0,0)$。\n- 原子 4 ($k=4$)：$\\boldsymbol{u}(\\xi^{(4)},\\eta^{(4)}) = (u_{4x}, u_{4y}) = (0,1)$。$\\boldsymbol{d}^{(4)} = (0,1)$。$\\boldsymbol{e}^{(4)}=(0,0)$。\n- 原子 5 ($k=5$)：$\\boldsymbol{u}(\\xi^{(5)},\\eta^{(5)}) = \\frac{1}{4} \\sum_{i=1}^4 \\boldsymbol{u}_i$。\n$$\n\\boldsymbol{u}(0,0) = \\frac{1}{4} \\left( \\begin{pmatrix} u_{1x} \\\\ u_{1y} \\end{pmatrix} + \\begin{pmatrix} u_{2x} \\\\ u_{2y} \\end{pmatrix} + \\begin{pmatrix} u_{3x} \\\\ u_{3y} \\end{pmatrix} + \\begin{pmatrix} u_{4x} \\\\ u_{4y} \\end{pmatrix} \\right) = \\frac{1}{4} \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{4} \\begin{pmatrix} 4 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\n观测到的位移是 $\\boldsymbol{d}^{(5)}=(1, \\frac{1}{2})$。因此，$\\boldsymbol{e}^{(5)}=(0,0)$。\n由于每个原子的误差都为零，误差平方和 $J(\\boldsymbol{U})$ 为 $0$。\n因此，残差范数是 $\\|\\boldsymbol{r}\\|_2 = \\sqrt{0} = 0$。\n\n这个结果表明，所提供的原子位移数据与双线性位移场完全一致。\n\n最终答案要求以纳米为单位给出 $\\boldsymbol{U}$ 的分量和 $\\|\\boldsymbol{r}\\|_2$。\n$u_{1x} = 0$ nm, $u_{1y} = 0$ nm。\n$u_{2x} = 2$ nm, $u_{2y} = 0$ nm。\n$u_{3x} = 2$ nm, $u_{3y} = 1$ nm。\n$u_{4x} = 0$ nm, $u_{4y} = 1$ nm。\n$\\|\\boldsymbol{r}\\|_{2} = 0$ nm。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  2  0  2  1  0  1  0\n\\end{pmatrix}\n}\n$$", "id": "3496630"}, {"introduction": "一旦建立了运动学联系，下一步就是确保能量在两个尺度上的一致性。Cauchy-Born 假定是实现这一目标的核心思想，它假设宏观均匀变形直接应用于微观原子晶格。通过这个练习 [@problem_id:3496677]，你将从一个简单的原子间相互作用势出发，利用 Cauchy-Born 假定推导出连续介质的应变能密度和第一 Piola-Kirchhoff 应力张量，从而深刻理解宏观材料行为如何从微观相互作用中涌现。", "problem": "考虑一个二维晶体固体，其原胞中含单个原子，排列成三角布拉维晶格（具有六重旋转对称性）。设参考构型中的六个最近邻键矢量表示为 $\\{\\mathbf{R}_b\\}_{b=1}^{6}$，每个矢量的长度为 $a_0$，且有 $\\mathbf{R}_b = a_0 \\mathbf{d}_b$，其中 $\\mathbf{d}_b$ 是单位矢量，均匀分布在 $0$, $\\pi/3$, $2\\pi/3$, $\\pi$, $4\\pi/3$ 和 $5\\pi/3$ 的角度上。每个晶格点的面积为 $A_0 = \\sqrt{3} a_0^2/2$。假设原子间的相互作用是中心力，由最近邻对势 $\\phi(r)$ 给出，其谐波形式为 $\\phi(r) = \\tfrac{1}{2} k (r - a_0)^2$，其中 $k$ 是一个正的刚度参数，$r$ 是键长。物体经历一个由变形梯度 $\\mathbf{F}$ 表征的均匀变形，并且 Cauchy-Born 假设成立，因此每个键 $\\mathbf{R}_b$ 映射为 $\\mathbf{F}\\mathbf{R}_b$，连续介质应变能密度 $W(\\mathbf{F})$ 从原子势推导得出。\n\n你的任务是：\n1. 从对势和 Cauchy-Born 假设出发，推导每单位面积的连续介质应变能密度 $W(\\mathbf{F})$，推导过程中需仔细考虑对的重复计数，并仅使用最近邻键。\n2. 通过对应变能密度关于 $\\mathbf{F}$ 求导，推导第一 Piola-Kirchhoff 应力 $\\mathbf{P} = \\partial W(\\mathbf{F})/\\partial \\mathbf{F}$。\n3. 利用三角晶格的晶格对称性，解释对于中心力和高度对称的邻居集合，$W(\\mathbf{F})$ 的依赖关系如何简化为右 Cauchy-Green 张量 $\\mathbf{C} = \\mathbf{F}^{\\top}\\mathbf{F}$ 的不变量的函数。\n4. 将你的表达式特化为各向同性拉伸 $\\mathbf{F} = \\lambda \\mathbf{I}$ 的情况，其中标量拉伸 $\\lambda > 0$。证明第一 Piola-Kirchhoff 应力与单位矩阵成正比，即 $\\mathbf{P} = \\alpha(\\lambda)\\mathbf{I}$，并确定标量系数 $\\alpha(\\lambda)$，将其表示为包含 $k$ 和 $\\lambda$ 的闭式解析表达式。\n\n你的最终答案应为 $\\alpha(\\lambda)$ 的单个符号表达式。不需要进行数值代入，最终表达式中不应包含单位。", "solution": "问题陈述经评估具有科学依据、是适定的、客观且自洽的。所提供的数据和条件一致且足以得出唯一解。该问题是应用 Cauchy-Born 法则于晶格的一个标准练习，并可进行完整求解。\n\n按照问题陈述的要求，解答分为四个部分呈现。\n\n**1. 连续介质应变能密度 $W(\\mathbf{F})$ 的推导**\n\n应变能密度 $W$ 是参考构型下单位面积的总势能。势能储存在原子间的键中。对于晶格点上的单个原子，其与最近邻的相互作用能是连接到它的所有键的势能之和。由于每个键由两个原子共享，我们对从一个参考原子发出的所有键的能量求和，然后除以 $2$，以求得每个原子的能量。\n\n单个键的势能由谐波势 $\\phi(r) = \\frac{1}{2} k (r - a_0)^2$ 给出，其中 $r$ 是变形构型中键的长度。根据 Cauchy-Born 假设，一个参考键矢量 $\\mathbf{R}_b$ 变形为 $\\mathbf{r}_b = \\mathbf{F}\\mathbf{R}_b$。变形后键的长度为 $r_b = \\|\\mathbf{r}_b\\| = \\|\\mathbf{F}\\mathbf{R}_b\\|$。\n\n因此，每个原子的总能量 $E_{\\text{atom}}$ 为：\n$$\nE_{\\text{atom}} = \\frac{1}{2} \\sum_{b=1}^{6} \\phi(\\|\\mathbf{F}\\mathbf{R}_b\\|) = \\frac{1}{2} \\sum_{b=1}^{6} \\left[ \\frac{1}{2} k \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2 \\right] = \\frac{1}{4} k \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n应变能密度 $W(\\mathbf{F})$ 是此能量除以参考构型中原胞的面积 $A_0 = \\frac{\\sqrt{3}}{2} a_0^2$。\n$$\nW(\\mathbf{F}) = \\frac{E_{\\text{atom}}}{A_0} = \\frac{\\frac{1}{4} k \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2}{\\frac{\\sqrt{3}}{2} a_0^2} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n我们可以用右 Cauchy-Green 张量 $\\mathbf{C} = \\mathbf{F}^{\\top}\\mathbf{F}$ 来表示变形后键的长度。\n$$\n\\|\\mathbf{F}\\mathbf{R}_b\\|^2 = (\\mathbf{F}\\mathbf{R}_b) \\cdot (\\mathbf{F}\\mathbf{R}_b) = \\mathbf{R}_b^{\\top} \\mathbf{F}^{\\top} \\mathbf{F} \\mathbf{R}_b = \\mathbf{R}_b^{\\top} \\mathbf{C} \\mathbf{R}_b\n$$\n代入 $\\mathbf{R}_b = a_0 \\mathbf{d}_b$，其中 $\\mathbf{d}_b$ 是单位矢量：\n$$\n\\|\\mathbf{F}\\mathbf{R}_b\\| = \\sqrt{(a_0 \\mathbf{d}_b)^{\\top} \\mathbf{C} (a_0 \\mathbf{d}_b)} = a_0 \\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b}\n$$\n现在，应变能密度可以写为：\n$$\nW(\\mathbf{F}) = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(a_0 \\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b} - a_0\\right)^2 = \\frac{k a_0^2}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{C} \\mathbf{d}_b} - 1\\right)^2\n$$\n$$\nW(\\mathbf{F}) = \\frac{k}{2\\sqrt{3}} \\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} \\mathbf{F}^{\\top}\\mathbf{F} \\mathbf{d}_b} - 1\\right)^2\n$$\n这就是连续介质应变能密度的最终表达式。\n\n**2. 第一 Piola-Kirchhoff 应力 $\\mathbf{P}$ 的推导**\n\n第一 Piola-Kirchhoff 应力张量 $\\mathbf{P}$ 是应变能密度 $W$ 对变形梯度 $\\mathbf{F}$ 的导数，即 $P_{ij} = \\frac{\\partial W}{\\partial F_{ij}}$。我们可以使用链式法则来推导。连续介质力学中的一个标准结果将 $\\mathbf{P}$ 与 $W$ 对 $\\mathbf{C}$ 的导数联系起来：$\\mathbf{P} = \\mathbf{F} \\frac{\\partial W}{\\partial \\mathbf{C}_{sym}}$，其中对于对称张量 $\\mathbf{C}$，有 $\\frac{\\partial W}{\\partial \\mathbf{C}_{sym}} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}$。或者，我们也可以直接对 $W(\\mathbf{F})$ 进行微分。\n$$\n\\frac{\\partial W}{\\partial \\mathbf{F}} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\frac{\\partial}{\\partial \\mathbf{F}} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2\n$$\n平方项的导数为：\n$$\n\\frac{\\partial}{\\partial \\mathbf{F}} \\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right)^2 = 2\\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right) \\frac{\\partial \\|\\mathbf{F}\\mathbf{R}_b\\|}{\\partial \\mathbf{F}}\n$$\n使用恒等式 $\\frac{\\partial \\|\\mathbf{x}\\|}{\\partial \\mathbf{x}} = \\frac{\\mathbf{x}^{\\top}}{\\|\\mathbf{x}\\|}$ 和链式法则，我们得到 $\\frac{\\partial \\|\\mathbf{F}\\mathbf{R}_b\\|}{\\partial \\mathbf{F}} = \\frac{(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b}{\\|\\mathbf{F}\\mathbf{R}_b\\|}$。用指数表示法，即为 $\\frac{F_{ik}R_{bk} R_{bj}}{\\|\\mathbf{F}\\mathbf{R}_b\\|}$。\n所以，\n$$\n\\mathbf{P} = \\frac{k}{2\\sqrt{3} a_0^2} \\sum_{b=1}^{6} 2\\left(\\|\\mathbf{F}\\mathbf{R}_b\\| - a_0\\right) \\frac{(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b}{\\|\\mathbf{F}\\mathbf{R}_b\\|}\n$$\n$$\n\\mathbf{P} = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{a_0}{\\|\\mathbf{F}\\mathbf{R}_b\\|}\\right) ((\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b)\n$$\n其中 $(\\mathbf{u} \\otimes \\mathbf{v})$ 表示张量积，这是一个分量为 $(u_i v_j)$ 的矩阵。\n\n**3. 由晶格对称性引起的 $W(\\mathbf{F})$ 的简化**\n\n应变能密度 $W$ 的依赖关系由于两个主要原理而简化：材料客观性和材料对称性。\n\n首先，材料客观性（或标架无关性）要求能量函数在变形构型的刚体旋转下必须保持不变。如果我们对变形状态施加一个旋转 $\\mathbf{Q}$（满足 $\\mathbf{Q}^{\\top}\\mathbf{Q}=\\mathbf{I}$），新的变形梯度为 $\\mathbf{F}' = \\mathbf{Q}\\mathbf{F}$。能量必须满足 $W(\\mathbf{Q}\\mathbf{F}) = W(\\mathbf{F})$。从我们得到的 $W$ 的表达式中，我们观察到它仅通过 $\\mathbf{F}^{\\top}\\mathbf{F} = \\mathbf{C}$ 这一项依赖于 $\\mathbf{F}$。由于 $(\\mathbf{Q}\\mathbf{F})^{\\top}(\\mathbf{Q}\\mathbf{F}) = \\mathbf{F}^{\\top}\\mathbf{Q}^{\\top}\\mathbf{Q}\\mathbf{F} = \\mathbf{F}^{\\top}\\mathbf{F} = \\mathbf{C}$，我们推导出的 $W$ 是客观的，并且可以只写成 $\\mathbf{C}$ 的函数，即 $W(\\mathbf{F}) = \\hat{W}(\\mathbf{C})$。\n\n其次，材料对称性要求能量函数在参考晶格的对称操作下保持不变。三角晶格具有六重旋转对称性（一个 $D_6$ 点群）。设 $\\mathbf{S}$ 是该群的一个对称操作。将 $\\mathbf{S}$ 应用于参考构型，会将最近邻矢量集合 $\\{\\mathbf{R}_b\\}$ 变换为其自身。材料对称性的要求是 $\\hat{W}(\\mathbf{C}) = \\hat{W}(\\mathbf{S}^{\\top}\\mathbf{C}\\mathbf{S})$。$W$ 表达式中的求和是针对矢量集合 $\\{\\mathbf{d}_b\\}$ 的。一个对称操作 $\\mathbf{S}$ 会排列这个集合，即对于某个 $b'$ 有 $\\mathbf{S}\\mathbf{d}_b = \\mathbf{d}_{b'}$。因此，求和保持不变：\n$$\n\\sum_{b=1}^{6} \\left(\\sqrt{\\mathbf{d}_b^{\\top} (\\mathbf{S}^{\\top}\\mathbf{C}\\mathbf{S}) \\mathbf{d}_b} - 1\\right)^2 = \\sum_{b=1}^{6} \\left(\\sqrt{(\\mathbf{S}\\mathbf{d}_b)^{\\top} \\mathbf{C} (\\mathbf{S}\\mathbf{d}_b)} - 1\\right)^2 = \\sum_{b'=1}^{6} \\left(\\sqrt{\\mathbf{d}_{b'}^{\\top} \\mathbf{C} \\mathbf{d}_{b'}} - 1\\right)^2\n$$\n对于三角晶格的对称群，满足此条件的函数 $\\hat{W}(\\mathbf{C})$ 是一个各向同性张量函数。对于一个二维对称张量 $\\mathbf{C}$，任何关于 $\\mathbf{C}$ 的各向同性标量函数都可以表示为其两个主不变量 $I_1 = \\mathrm{tr}(\\mathbf{C})$ 和 $I_2 = \\det(\\mathbf{C})$ 的函数。因此，晶格的高度对称性，结合力的中心性，将应变能简化为 $W(\\mathbf{F}) = f(I_1, I_2)$。\n\n**4. 特化为各向同性拉伸 $\\mathbf{F} = \\lambda \\mathbf{I}$**\n\n对于各向同性拉伸，变形梯度为 $\\mathbf{F} = \\lambda\\mathbf{I}$，其中 $\\lambda > 0$ 是一个标量，$\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。我们将此代入 PK1 应力 $\\mathbf{P}$ 的表达式中。\n\n首先，注意到 $\\mathbf{F}\\mathbf{R}_b = (\\lambda\\mathbf{I})\\mathbf{R}_b = \\lambda\\mathbf{R}_b$。\n范数为 $\\|\\mathbf{F}\\mathbf{R}_b\\| = \\|\\lambda\\mathbf{R}_b\\| = \\lambda\\|\\mathbf{R}_b\\| = \\lambda a_0$。\n$(\\mathbf{F}\\mathbf{R}_b) \\otimes \\mathbf{R}_b$ 项变为 $(\\lambda\\mathbf{R}_b) \\otimes \\mathbf{R}_b = \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b)$。\n\n将这些代入 $\\mathbf{P}$ 的表达式：\n$$\n\\mathbf{P} = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{a_0}{\\lambda a_0}\\right) \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b) = \\frac{k}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} \\left(1 - \\frac{1}{\\lambda}\\right) \\lambda(\\mathbf{R}_b \\otimes \\mathbf{R}_b)\n$$\n标量项 $\\lambda(1 - 1/\\lambda) = \\lambda - 1$ 可以从求和中提取出来：\n$$\n\\mathbf{P} = \\frac{k(\\lambda - 1)}{\\sqrt{3} a_0^2} \\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b)\n$$\n这个求和是关于最近邻矢量的张量积。我们来计算这个和：$\\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b) = a_0^2 \\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b)$。\n单位矢量为 $\\mathbf{d}_b = (\\cos((b-1)\\pi/3), \\sin((b-1)\\pi/3))$。由于六重对称性，这个和必须是一个各向同性张量，即与单位矩阵 $\\mathbf{I}$ 成正比。设 $\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b) = c\\mathbf{I}$。我们通过取迹来找到常数 $c$：\n$$\n\\mathrm{tr}(c\\mathbf{I}) = \\mathrm{tr}\\left(\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b)\\right) = \\sum_{b=1}^{6} \\mathrm{tr}(\\mathbf{d}_b \\otimes \\mathbf{d}_b) = \\sum_{b=1}^{6} (\\mathbf{d}_b \\cdot \\mathbf{d}_b) = \\sum_{b=1}^{6} \\|\\mathbf{d}_b\\|^2 = \\sum_{b=1}^{6} 1 = 6\n$$\n由于在二维中 $\\mathrm{tr}(\\mathbf{I}) = 2$，我们有 $2c = 6$，即 $c=3$。\n因此，$\\sum_{b=1}^{6} (\\mathbf{d}_b \\otimes \\mathbf{d}_b) = 3\\mathbf{I}$，并且 $\\sum_{b=1}^{6} (\\mathbf{R}_b \\otimes \\mathbf{R}_b) = 3 a_0^2 \\mathbf{I}$。\n\n将此结果代回 $\\mathbf{P}$ 的表达式：\n$$\n\\mathbf{P} = \\frac{k(\\lambda - 1)}{\\sqrt{3} a_0^2} (3 a_0^2 \\mathbf{I}) = \\frac{3k}{\\sqrt{3}}(\\lambda - 1) \\mathbf{I} = \\sqrt{3} k (\\lambda - 1) \\mathbf{I}\n$$\n这表明 $\\mathbf{P}$ 确实具有 $\\mathbf{P} = \\alpha(\\lambda)\\mathbf{I}$ 的形式，其标量系数由下式给出：\n$$\n\\alpha(\\lambda) = \\sqrt{3} k (\\lambda - 1)\n$$\n这就是所要求的闭式解析表达式。", "answer": "$$\\boxed{\\sqrt{3}k(\\lambda - 1)}$$", "id": "3496677"}, {"introduction": "将耦合方法应用于动态问题，会引入时间尺度不匹配的新挑战——原子振动需要飞秒级的时间步长 $\\Delta t_{\\mathrm{MD}}$，而连续介质模型通常允许大得多的时间步长 $\\Delta t_{\\mathrm{FEM}}$。为了解决这个问题，我们采用多速率时间积分方案，同时必须遵守 Courant-Friedrichs-Lewy (CFL) 稳定性条件。这个练习 [@problem_id:3496668] 将指导你如何为一个瞬态冲击问题设计一个稳定的时间步进策略，你需要计算 MD 模拟所需的子循环次数以及确保整个模拟过程准确性所需的同步点总数。", "problem": "一个一维原子-连续介质并发模拟将一个分子动力学 (MD) 区域与一个有限元法 (FEM) 区域耦合，以解析一个瞬态冲击事件。MD 区域使用显式积分，时间步长为 $\\Delta t_{\\mathrm{MD}}=1\\,\\mathrm{fs}$，FEM 区域也使用显式积分，时间步长为 $\\Delta t_{\\mathrm{FEM}}=0.1\\,\\mathrm{ps}$。FEM 区域是一个线性弹性杆，长度 $L_{\\mathrm{FEM}}=100\\,\\mathrm{nm}$，杨氏模量 $E=128\\,\\mathrm{GPa}$，质量密度 $\\rho=2000\\,\\mathrm{kg/m^3}$。耦合界面位于 FEM 区域的一端。MD 侧的局部冲击产生一个小的纵向应力波，并传播到 FEM 区域；假设应变为小应变，因此线性弹性适用，并且波在 FEM 杆远端的反射是完全弹性的。模拟必须至少运行到从 FEM 区域远端产生的第一次往返反射波返回到 MD-FEM 界面为止。FEM 空间离散化的特征单元尺寸为 $h=5\\,\\mathrm{nm}$，并且 MD 和 FEM 都使用显式中心差分类的时间积分方法。\n\n设计一个多速率交错时间步进方案，其中 MD 区域在每个 FEM 时间步内推进多次（子循环），并且 MD-FEM 耦合仅在与 FEM 时间网格重合的同步点上交换界面牵引力和位移。为保证科学准确性，要求：\n- FEM 时间步长满足与 FEM 区域中纵向波速相关的显式稳定性（Courant 型）约束。\n- 同步间隔不超过较粗的时间步长，以确保界面数据相对于 FEM 动力学不会产生时间混叠。\n\n计算：\n1. 每个 FEM 步长所包含的 MD 子循环的精确次数。\n2. 覆盖所述关注时长（从波的产生到第一次往返返回）所需的同步点的精确数量，每个 FEM 步长计为一个同步点。\n\n将同步点的数量表示为整数。如果出现非整数，则使用大于或等于精确值的最小整数。请将最终答案以两个从左到右排列的数字形式提供。最终答案框中不需要单位。", "solution": "该问题要求计算一维原子-连续介质并发模拟中的两个量：每个有限元法 (FEM) 步长中的分子动力学 (MD) 子循环次数，以及在指定模拟时长内所需的总同步点数。\n\n首先，对问题陈述进行验证。已知条件如下：\n- MD 时间步长：$\\Delta t_{\\mathrm{MD}} = 1\\,\\mathrm{fs}$\n- FEM 时间步长：$\\Delta t_{\\mathrm{FEM}} = 0.1\\,\\mathrm{ps}$\n- FEM 杆长：$L_{\\mathrm{FEM}} = 100\\,\\mathrm{nm}$\n- 杨氏模量：$E = 128\\,\\mathrm{GPa}$\n- 质量密度：$\\rho = 2000\\,\\mathrm{kg/m^3}$\n- FEM 单元尺寸：$h = 5\\,\\mathrm{nm}$\n- 模拟时长：纵向波在 FEM 杆中完成一次往返所需的时间。\n- 耦合：在每个 FEM 时间步长处进行同步。\n\n该问题在科学上基于计算力学和多尺度建模的原理。一个关键约束是 FEM 时间步长 $\\Delta t_{\\mathrm{FEM}}$ 必须满足显式时间积分方案的 Courant-Friedrichs-Lewy (CFL) 稳定性条件。弹性介质中的纵向波速由 $c = \\sqrt{E/\\rho}$ 给出。我们来计算这个速度并检查稳定性。使用国际单位制 (SI units)：\n$$c = \\sqrt{\\frac{E}{\\rho}} = \\sqrt{\\frac{128 \\times 10^{9}\\,\\mathrm{N/m^2}}{2000\\,\\mathrm{kg/m^3}}} = \\sqrt{\\frac{128 \\times 10^{9}\\,\\mathrm{kg \\cdot m \\cdot s^{-2} \\cdot m^{-2}}}{2000\\,\\mathrm{kg \\cdot m^{-3}}}} = \\sqrt{64 \\times 10^{6}\\,\\mathrm{m^2/s^2}} = 8 \\times 10^{3}\\,\\mathrm{m/s}$$\n一维显式格式的 CFL 条件是 $\\Delta t \\le h/c$。FEM 离散化所允许的最大时间步长为：\n$$\\Delta t_{\\mathrm{max}} = \\frac{h}{c} = \\frac{5 \\times 10^{-9}\\,\\mathrm{m}}{8 \\times 10^{3}\\,\\mathrm{m/s}} = 0.625 \\times 10^{-12}\\,\\mathrm{s} = 0.625\\,\\mathrm{ps}$$\n给定的 FEM 时间步长是 $\\Delta t_{\\mathrm{FEM}} = 0.1\\,\\mathrm{ps}$。由于 $0.1\\,\\mathrm{ps} \\le 0.625\\,\\mathrm{ps}$，稳定性条件得到满足。问题的假设是一致且适定的。该问题被视为有效。\n\n我们继续求解。\n\n**1. 每个 FEM 步长中的 MD 子循环次数**\n\n该模拟采用多速率时间步进方案，其中 MD 区域在 FEM 区域的每个时间步内积分多次（子循环）。MD 子循环的次数，记为 $N_{\\mathrm{sub}}$，是 FEM 时间步长与 MD 时间步长的比值。\n$$N_{\\mathrm{sub}} = \\frac{\\Delta t_{\\mathrm{FEM}}}{\\Delta t_{\\mathrm{MD}}}$$\n给定的时间步长为 $\\Delta t_{\\mathrm{FEM}} = 0.1\\,\\mathrm{ps}$ 和 $\\Delta t_{\\mathrm{MD}} = 1\\,\\mathrm{fs}$。为了计算该比值，我们将它们转换为相同的单位。已知 $1\\,\\mathrm{ps} = 1000\\,\\mathrm{fs}$：\n$$\\Delta t_{\\mathrm{FEM}} = 0.1\\,\\mathrm{ps} = 0.1 \\times 1000\\,\\mathrm{fs} = 100\\,\\mathrm{fs}$$\n现在，我们可以计算子循环的次数：\n$$N_{\\mathrm{sub}} = \\frac{100\\,\\mathrm{fs}}{1\\,\\mathrm{fs}} = 100$$\n因此，每个 FEM 时间步长恰好有 $100$ 个 MD 子循环。\n\n**2. 同步点数量**\n\n所需的模拟时长 $T_{\\mathrm{sim}}$ 是纵向应力波从 MD-FEM 界面传播到 FEM 杆的远端再返回所需的时间。这是一个往返距离 $D = 2 L_{\\mathrm{FEM}}$。\n$$D = 2 \\times L_{\\mathrm{FEM}} = 2 \\times 100\\,\\mathrm{nm} = 200\\,\\mathrm{nm}$$\n波以声速 $c = 8 \\times 10^{3}\\,\\mathrm{m/s}$ 传播，我们之前已经计算过。用单位 $\\mathrm{nm/ps}$ 来表示这个速度很方便：\n$$c = 8 \\times 10^{3}\\,\\frac{\\mathrm{m}}{\\mathrm{s}} \\times \\frac{10^{9}\\,\\mathrm{nm}}{1\\,\\mathrm{m}} \\times \\frac{1\\,\\mathrm{s}}{10^{12}\\,\\mathrm{ps}} = 8\\,\\mathrm{nm/ps}$$\n所需的总模拟时间为：\n$$T_{\\mathrm{sim}} = \\frac{D}{c} = \\frac{200\\,\\mathrm{nm}}{8\\,\\mathrm{nm/ps}} = 25\\,\\mathrm{ps}$$\nMD 和 FEM 区域之间的同步发生在与 FEM 时间网格重合的点上。问题陈述要求每个 FEM 步长计为一个同步点。因此，同步间隔为 $\\Delta t_{\\mathrm{sync}} = \\Delta t_{\\mathrm{FEM}} = 0.1\\,\\mathrm{ps}$。同步点的总数 $N_{\\mathrm{sync}}$ 是总模拟时间除以同步间隔。\n$$N_{\\mathrm{sync}} = \\frac{T_{\\mathrm{sim}}}{\\Delta t_{\\mathrm{sync}}} = \\frac{T_{\\mathrm{sim}}}{\\Delta t_{\\mathrm{FEM}}}$$\n代入数值：\n$$N_{\\mathrm{sync}} = \\frac{25\\,\\mathrm{ps}}{0.1\\,\\mathrm{ps}} = 250$$\n结果是一个整数，因此“取大于或等于精确值的最小整数”（向上取整函数）的指令被自然满足。模拟需要 $250$ 个 FEM 步长，即 $250$ 个同步点，来捕捉第一次往返反射。\n\n计算出的两个值为：\n- 每个 FEM 步长的 MD 子循环次数：$100$\n- 同步点数量：$250$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n100  250\n\\end{pmatrix}\n}\n$$", "id": "3496668"}]}