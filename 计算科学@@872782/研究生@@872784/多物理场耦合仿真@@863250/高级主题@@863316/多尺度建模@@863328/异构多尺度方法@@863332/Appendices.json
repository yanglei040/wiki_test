{"hands_on_practices": [{"introduction": "异构多尺度方法 (HMM) 的核心在于通过求解微观单元问题来计算宏观有效性质。在建立这些微观问题时，边界条件的选择是一个至关重要的理论和实践步骤，因为它直接决定了所计算的有效性质的准确性。本练习探讨了在周期性介质中，周期性、Dirichlet 和 Neumann 这三种常用边界条件的定义及其对有效通量估计的影响，从而帮助我们理解它们各自的理论基础和潜在的建模误差来源。([@problem_id:3508983])", "problem": "考虑一个非均质周期性介质在微观尺度上的标量扩散模型，其系数场为 $A(y) \\in \\mathbb{R}^{d \\times d}$，在单元胞 $Y \\subset \\mathbb{R}^{d}$ 上是 $Y$-周期性的、对称的且一致正定的。在非均质多尺度方法（HMM）中，提出了一个局部微观单元胞问题，以将给定的宏观梯度 $p \\in \\mathbb{R}^{d}$ 与有效通量联系起来。寻求微观修正子 $w_{p}(y)$ 以满足微观平衡方程\n$$\n\\nabla_{y} \\cdot \\big( A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big) \\big) = 0 \\quad \\text{in } Y,\n$$\n有效通量估计通过下式获得\n$$\n\\mathbf{J}_{\\mathrm{eff}}(p) = \\frac{1}{|Y|} \\int_{Y} A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big) \\, dy.\n$$\n微观问题上的不同边界条件会导出不同的 $w_{p}(y)$，从而导致不同的 $\\mathbf{J}_{\\mathrm{eff}}(p)$。请选择正确定义了 HMM 微观问题中使用的周期性、狄利克雷（Dirichlet）和诺伊曼（Neumann）边界条件，并正确对比了它们在系数为 $A(y)$ 的周期性介质中对有效通量估计的影响的选项。\n\nA. 周期性边界条件：$w_{p}$ 是 $Y$-周期性的，并满足 $\\int_{Y} w_{p}(y) \\, dy = 0$。狄利克雷边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$，这等价于微观位移在 $\\partial Y$ 上受约束 $u(y) = p \\cdot y$。诺伊曼边界条件：在 $\\partial Y$ 上 $(A(y) \\nabla_{y} w_{p}(y)) \\cdot n(y) = 0$，并为保证唯一性施加零均值约束 $\\int_{Y} w_{p}(y) \\, dy = 0$。在周期性介质中，当 $Y$ 与一个周期单元胞匹配时，周期性边界条件产生一个无偏的有效通量 $\\mathbf{J}_{\\mathrm{eff}}(p)$，其值等于均质化通量 $A^{\\ast} p$，而狄利克雷边界条件产生的表观有效响应会高估相对于周期性情况的能量共轭投影 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$，诺伊曼边界条件产生的表观有效响应则会低估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。\n\nB. 周期性边界条件：$w_{p}$ 在 $\\partial Y$ 上逐点满足 $A(y) \\big( p + \\nabla_{y} w_{p} \\big) \\cdot n(y) = 0$。狄利克雷边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。诺伊曼边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$。在周期性介质中，狄利克雷边界条件是无偏的，诺伊曼边界条件会高估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$，而周期性边界条件会低估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。\n\nC. 周期性边界条件：在 $\\partial Y$ 上 $\\nabla_{y} w_{p} \\cdot n(y) = 0$ 且 $\\int_{Y} \\nabla_{y} w_{p}(y) \\, dy = 0$。狄利克雷边界条件：在 $Y$ 中 $\\nabla_{y} w_{p}(y) = 0$。诺伊曼边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。在周期性介质中，所有三种边界条件都产生相同的 $\\mathbf{J}_{\\mathrm{eff}}(p)$。\n\nD. 周期性边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。狄利克雷边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$。诺伊曼边界条件：$(A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big)) \\cdot n(y)$ 在 $\\partial Y$ 上为常数。在周期性介质中，周期性边界条件会引入边界层，除非 $|Y|$ 很大，因此它们通常是有偏的；相比之下，对于任何 $|Y|$，狄利克雷和诺伊曼边界条件都是无偏的，并且产生与均质化通量 $A^{\\ast} p$ 相同的 $\\mathbf{J}_{\\mathrm{eff}}(p)$。", "solution": "用户希望我验证并解决一个问题，该问题涉及标量扩散模型在非均质多尺度方法（HMM）框架下，不同边界条件在微观尺度问题中的定义及其影响。\n\n### 问题验证\n\n我将首先对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **微观模型**：非均质周期性介质中的标量扩散。\n- **系数张量**：$A(y) \\in \\mathbb{R}^{d \\times d}$，在单元胞 $Y \\subset \\mathbb{R}^{d}$ 上是 $Y$-周期的、对称的且一致正定的。\n- **微观平衡方程**：$\\nabla_{y} \\cdot \\big( A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big) \\big) = 0 \\quad \\text{in } Y$，其中 $p \\in \\mathbb{R}^{d}$ 是给定的宏观梯度，$w_{p}(y)$ 是微观修正子。\n- **有效通量估计**：$\\mathbf{J}_{\\mathrm{eff}}(p) = \\frac{1}{|Y|} \\int_{Y} A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big) \\, dy$。\n- **问题**：选择正确定义了微观问题的周期性、狄利克雷和诺伊曼边界条件，并正确对比了它们对有效通量估计的影响的选项。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于成熟的偏微分方程均质化数学理论及其在 HMM 等数值多尺度方法中的应用。方程、定义和系数张量的性质都是该领域的标准内容。\n- **适定性**：该问题要求识别正确的理论陈述。在指定条件下（例如，对周期性和诺伊曼问题施加零均值约束），其底层的边值问题是适定的。问题本身也是适定的，因为它基于成熟的理论，有唯一的正确答案。\n- **客观性**：该问题使用了来自连续介质力学和数值分析的精确、客观和标准的术语。\n- **缺陷清单**：问题陈述没有违反任何无效标准。它在科学上是合理的，可形式化的，完整的，可行的，适定的，并且不是无意义的。它涉及多尺度建模中的一个核心概念。\n\n**第三步：结论与行动**\n问题陈述是**有效的**。我将继续推导解答。\n\n### 解答推导\n\n该问题涉及 HMM 微观尺度问题，这等价于经典均质化理论中的单元胞问题。目标是计算有效张量 $A^*$，它将宏观梯度 $p$ 与平均通量 $\\mathbf{J}_{\\mathrm{eff}}$ 联系起来，即 $\\mathbf{J}_{\\mathrm{eff}}(p) = A^*p$。在微观尺度域 $Y$ 上选择的边界条件会影响计算出的修正子 $w_p$，从而影响有效通量 $\\mathbf{J}_{\\mathrm{eff}}(p)$。\n\n我们来分析与微观尺度问题相关的能量。存储在代表性体积元（RVE）$Y$ 中的弹性/扩散能量密度由下式给出\n$$ W(p) = \\min_{w_p \\in \\mathcal{V}} \\frac{1}{2|Y|} \\int_Y \\big(p+\\nabla_y w_p\\big) \\cdot A(y) \\big(p+\\nabla_y w_p\\big) \\, dy $$\n其中 $\\mathcal{V}$ 是容许修正函数的空间，它由边界条件定义。\n从微观平衡方程的弱形式，我们有，对于所有测试函数 $v$，$\\int_Y \\nabla_y v \\cdot A(y)(p+\\nabla_y w_p) \\, dy = 0$。选择 $v=w_p$，我们得到 $\\int_Y \\nabla_y w_p \\cdot A(y)(p+\\nabla_y w_p) \\, dy = 0$。\n有效通量为 $\\mathbf{J}_{\\mathrm{eff}}(p) = \\langle A(p+\\nabla_y w_p) \\rangle_Y$。\n选项中讨论的能量共轭量是 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。我们来计算它：\n$$ p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p) = \\frac{1}{|Y|} \\int_Y p \\cdot A(y)(p+\\nabla_y w_p) \\, dy = \\frac{1}{|Y|} \\int_Y p \\cdot A(y) p \\, dy + \\frac{1}{|Y|} \\int_Y p \\cdot A(y) \\nabla_y w_p \\, dy $$\n从弱形式可知，$\\int_Y p \\cdot A \\nabla_y w_p \\, dy = -\\int_Y \\nabla_y w_p \\cdot A \\nabla_y w_p \\, dy$。\n将此代入 $2W(p)$ 的表达式，我们得到：\n$$ 2W(p) = \\frac{1}{|Y|} \\left( \\int_Y p \\cdot A p \\, dy + 2\\int_Y p \\cdot A \\nabla_y w_p \\, dy + \\int_Y \\nabla_y w_p \\cdot A \\nabla_y w_p \\, dy \\right) $$\n$$ 2W(p) = \\frac{1}{|Y|} \\left( \\int_Y p \\cdot A p \\, dy - \\int_Y \\nabla_y w_p \\cdot A \\nabla_y w_p \\, dy \\right) $$\n我们可以看到 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$ 也等于这个量：\n$$ p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p) = \\frac{1}{|Y|} \\left( \\int_Y p \\cdot A p \\, dy + \\int_Y p \\cdot A \\nabla_y w_p \\, dy \\right) = \\frac{1}{|Y|} \\left( \\int_Y p \\cdot A p \\, dy - \\int_Y \\nabla_y w_p \\cdot A \\nabla_y w_p \\, dy \\right) $$\n因此，我们建立了重要的关系式 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p) = 2W(p)$。这意味着分析能量 $W(p)$ 等价于分析投影 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。\n\n现在我们基于变分原理来分析边界条件。\n\n1.  **周期性边界条件**：\n    -   **定义**：修正子 $w_p$ 被要求是 $Y$-周期的。为保证唯一性，解必须具有指定的平均值，通常为零：$\\int_Y w_p(y) \\, dy=0$。容许函数的空间是 $\\mathcal{V}_P = \\{ w \\in H^1_{\\text{per}}(Y) \\mid \\int_Y w \\, dy = 0 \\}$。\n    -   **影响**：对于一个真正的周期性介质，其中 $Y$ 是周期性单元胞，这些边界条件会导出精确的均质化张量 $A^*$。因此，该方法被认为是精确的或**无偏的**。得到的能量 $W_P(p) = \\frac{1}{2} p \\cdot A^* p$ 是真实的有效能量。\n\n2.  **狄利克雷边界条件**：\n    -   **定义**：修正子在边界上被设置为零：在 $\\partial Y$ 上 $w_p(y) = 0$。这等价于在边界 $\\partial Y$ 上指定一个线性总场 $u(y) = p \\cdot y + w_p(y) = p \\cdot y$。容许函数的空间是 $\\mathcal{V}_D = H^1_0(Y)$。\n    -   **影响**：这个条件对微观场施加了比周期性更强的约束。根据最小势能原理（Rayleigh-Ritz 原理），在一个更小、更受约束的容许函数集合上最小化能量，会得到一个更高的最小能量值。因此，$W_D(p) \\ge W_P(p)$。这是有效属性的 Voigt 上界的基础。因此，$p \\cdot \\mathbf{J}_{\\mathrm{eff}}^D(p) \\ge p \\cdot \\mathbf{J}_{\\mathrm{eff}}^P(p)$。狄利克雷边界条件会**高估**有效能量响应。\n\n3.  **诺伊曼边界条件**：\n    -   **定义**：在此背景下应用的一种常见的诺伊曼型条件是针对解的波动部分的零通量条件：在 $\\partial Y$ 上 $(A(y) \\nabla_y w_p(y)) \\cdot n(y) = 0$。这是问题中椭圆算子的自然边界条件。与周期性情况一样，$w_p$ 的唯一性需要通过固定任意加法常数来保证，通常是通过强制施加零均值约束 $\\int_Y w_p(y) \\, dy=0$。容许函数的空间是 $\\mathcal{V}_N = \\{ w \\in H^1(Y) \\mid \\int_Y w \\, dy = 0 \\}$。\n    -   **影响**：已知此条件对应于 Reuss 下界。它比周期性或狄利克雷条件限制性更小。变分原理（特别是最小余能对偶原理）表明，此条件导致的有效响应比真实的均质化响应更柔顺（刚度更小）。因此，$W_N(p) \\le W_P(p)$。因此，$p \\cdot \\mathbf{J}_{\\mathrm{eff}}^N(p) \\le p \\cdot \\mathbf{J}_{\\mathrm{eff}}^P(p)$。诺伊曼边界条件会**低估**有效能量响应。\n\n**层级总结**：对于能量共轭对 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$，我们有著名的排序：\n$$ p \\cdot \\mathbf{J}_{\\mathrm{eff}}^N(p) \\le p \\cdot \\mathbf{J}_{\\mathrm{eff}}^P(p) \\le p \\cdot \\mathbf{J}_{\\mathrm{eff}}^D(p) $$\n周期性边界条件给出精确的均质化结果，而诺伊曼和狄利克雷边界条件分别提供下界和上界。\n\n### 逐项分析\n\n**A. 周期性边界条件：$w_{p}$ 是 $Y$-周期性的，并满足 $\\int_{Y} w_{p}(y) \\, dy = 0$。狄利克雷边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$，这等价于微观位移在 $\\partial Y$ 上受约束 $u(y) = p \\cdot y$。诺伊曼边界条件：在 $\\partial Y$ 上 $(A(y) \\nabla_{y} w_{p}(y)) \\cdot n(y) = 0$，并为保证唯一性施加零均值约束 $\\int_{Y} w_{p}(y) \\, dy = 0$ for uniqueness。在周期性介质中，当 $Y$ 与一个周期单元胞匹配时，周期性边界条件产生一个无偏的有效通量 $\\mathbf{J}_{\\mathrm{eff}}(p)$，其值等于均质化通量 $A^{\\ast} p$，而狄利克雷边界条件产生的表观有效响应会高估相对于周期性情况的能量共轭投影 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$，诺伊曼边界条件产生的表观有效响应则会低估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。**\n- 所有三种边界条件的定义在该领域都是正确和标准的。\n- 关于其影响的陈述也是正确的：周期性是无偏的（精确的），狄利克雷高估（上界），诺伊曼低估（下界）能量响应 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。\n- **结论：正确**\n\n**B. 周期性边界条件：$w_{p}$ 在 $\\partial Y$ 上逐点满足 $A(y) \\big( p + \\nabla_{y} w_{p} \\big) \\cdot n(y) = 0$。狄利克雷边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。诺伊曼边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$。在周期性介质中，狄利克雷边界条件是无偏的，诺伊曼边界条件会高估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$，而周期性边界条件会低估 $p \\cdot \\mathbf{J}_{\\mathrm{eff}}(p)$。**\n- 边界条件的定义被错误地交换了：对周期性的描述是诺伊曼型条件，对狄利克雷的描述是周期性条件，对诺伊曼的描述是狄利克雷条件。\n- 关于影响的陈述也是错误的。狄利克雷会高估，而不是无偏。诺伊曼会低估，而不是高估。周期性是无偏的，而不是低估。\n- **结论：错误**\n\n**C. 周期性边界条件：在 $\\partial Y$ 上 $\\nabla_{y} w_{p} \\cdot n(y) = 0$ 且 $\\int_{Y} \\nabla_{y} w_{p}(y) \\, dy = 0$。狄利克雷边界条件：在 $Y$ 中 $\\nabla_{y} w_{p}(y) = 0$。诺伊曼边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。在周期性介质中，所有三种边界条件都产生相同的 $\\mathbf{J}_{\\mathrm{eff}}(p)$。**\n- 定义是非标准的且不正确。周期性边界条件的定义是条件的混合。狄利克雷边界条件的定义不是一个边界条件，并且会以一种通常不一致的方式使问题变得无意义。诺伊曼边界条件被定义为周期性条件。\n- 对于有限的单元胞 $Y$，所有三种条件产生相同通量的说法是错误的。它们之间的差异正是变分界领域产生的原因。\n- **结论：错误**\n\n**D. 周期性边界条件：$w_{p}$ 是 $Y$-周期性的且均值为零。狄利克雷边界条件：在 $\\partial Y$ 上 $w_{p}(y) = 0$。诺伊曼边界条件：$(A(y) \\big( p + \\nabla_{y} w_{p}(y) \\big)) \\cdot n(y)$ 在 $\\partial Y$ 上为常数。在周期性介质中，周期性边界条件会引入边界层，除非 $|Y|$ 很大，因此它们通常是有偏的；相比之下，对于任何 $|Y|$，狄利克雷和诺伊曼边界条件都是无偏的，并且产生与均质化通量 $A^{\\ast} p$ 相同的 $\\mathbf{J}_{\\mathrm{eff}}(p)$。**\n- 周期性和狄利克雷条件的定义是正确的。对诺伊曼的建议是一种可能的定义，但我们关注其影响的陈述。\n- 关于周期性边界条件影响的陈述是根本错误的。周期性边界条件是周期性介质的精确条件，*不会*引入边界层；它们根据定义是无偏的。正是非周期性边界条件（狄利克雷、诺伊曼）在单元胞边界 $\\partial Y$ 处引入了边界层效应。\n- 后续声称狄利克雷和诺伊曼条件是无偏的也是错误的。它们提供的是界限，因此对于有限的单元胞 $Y$ 是有偏的。只有当域的大小 $|Y|$ 趋于无穷大时，它们才收敛到无偏结果。\n- **结论：错误**\n\n基于详细分析，选项 A 是唯一一个根据既定理论正确呈现所有定义及其后果的选项。", "answer": "$$\\boxed{A}$$", "id": "3508983"}, {"introduction": "在通过微观计算获得有效本构关系后，HMM 的下一步是将这些信息整合到宏观模型中，通常是通过有限元方法 (FEM) 进行求解。这个练习提供了一个具体的一维扩散问题的动手实践，演示了如何将在微观尺度上计算出的有效热导率 $\\hat{A}(x)$ 用于宏观有限元方法的计算框架。通过为特定节点基函数（“帽子函数”）计算有限元残差，您可以亲身体验多尺度信息流以及宏观守恒定律是如何在离散格式中体现的。([@problem_id:3508973])", "problem": "考虑一个源自多物理场耦合微观结构的一维标量扩散过程，其中热传导受到电磁场的调制。在微观尺度上，电导率取决于一个快速振荡的场，并表示为 $A(x/\\varepsilon)$，其中 $\\varepsilon$ 是一个小的无量纲尺度参数，代表特征微观结构长度。宏观场 $u^{H}(x)$ 是温度的有限元近似，并且被视为在域 $\\Omega = [0, 2]$ 的均匀剖分上的分段线性函数，该剖分包含单元 $K_{1} = [0, 1]$ 和 $K_{2} = [1, 2]$。假设所有量均为无量纲。\n\n异构多尺度方法 (HMM) 使用局部微观尺度问题来计算宏观尺度上的有效数值通量。在单元内的每个求积点处，求解一个局部微单元问题以获得均质化电导率 $\\hat{A}(x)$，相应的数值通量为 $q(x) = \\hat{A}(x)\\,\\nabla u^{H}(x)$。在一维情况下，梯度为 $\\nabla u^{H}(x) = \\frac{d u^{H}}{dx}$。\n\n假设在每个单元上，有以下通过微观计算得到的有效电导率（来自微观单元问题）和宏观梯度：\n- 在 $K_{1} = [0, 1]$上，$\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = g_{1} = 2$。\n- 在 $K_{2} = [1, 2]$上，$\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = g_{2} = 1$。\n\n令测试函数 $\\varphi$ 为与内部节点 $x = 1$ 相关联的标准连续帽函数，定义为\n当 $x \\in [0, 1]$ 时 $\\varphi(x) = x$，当 $x \\in [1, 2]$ 时 $\\varphi(x) = 2 - x$，在 $[0, 2]$ 之外 $\\varphi(x) = 0$。\n\n从守恒定律及其对于具有异构系数的扩散算子的弱形式出发，使用异构多尺度方法 (HMM) 的宏观组装原理，通过在每个单元上对微观计算的通量 $q(x) = \\hat{A}(x)\\,\\frac{d u^{H}}{dx}$ 与 $\\nabla \\varphi$ 进行积分，来计算测试函数 $\\varphi$ 的宏观有限元残差。在一维情况下，当没有源项且边界条件为齐次狄利克雷边界条件时，该残差由双线性形式 $\\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$ 给出。\n\n此外，通过显式计算数值通量的跳跃 $[q] = q_{L}(1) - q_{R}(1)$ 来验证在界面 $x = 1$ 处的守恒性，其中 $q_{L}(1)$ 是 $q(x)$ 从 $K_{1}$ 逼近 $x = 1$ 时的极限，而 $q_{R}(1)$ 是从 $K_{2}$ 逼近 $x = 1$ 时的极限。\n\n计算 $\\varphi$ 的宏观有限元残差，并将其报告为一个实数。无需四舍五入。同时，在您的推导过程中说明计算出的通量跳跃 $[q]$，但您报告的最终数值答案必须仅为残差值。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 第1步：提取已知条件\n- **域**：$\\Omega = [0, 2]$\n- **单元**：$K_{1} = [0, 1]$ 和 $K_{2} = [1, 2]$\n- **宏观场近似**：$u^{H}(x)$ 是分段线性的。\n- **在 $K_{1} = [0, 1]$ 上的微观计算有效电导率和宏观梯度**：$\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = g_{1} = 2$。\n- **在 $K_{2} = [1, 2]$ 上的微观计算有效电导率和宏观梯度**：$\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = g_{2} = 1$。\n- **测试函数**：当 $x \\in [0, 1]$ 时 $\\varphi(x) = x$，当 $x \\in [1, 2]$ 时 $\\varphi(x) = 2 - x$。在 $[0, 2]$ 之外 $\\varphi(x) = 0$。\n- **残差公式**：$\\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$。\n- **数值通量定义**：$q(x) = \\hat{A}(x)\\,\\nabla u^{H}(x)$。\n- **通量跳跃定义**：$[q] = q_{L}(1) - q_{R}(1)$，其中 $q_{L}(1)$ 是从 $K_1$ 内部逼近的极限，$q_{R}(1)$ 是从 $K_2$ 内部逼近的极限。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实上的不合理性**：该问题描述了异构多尺度方法 (HMM) 在扩散问题上的一个简化一维应用。均质化、宏观尺度有限元近似、微观尺度信息启发的有效属性以及残差计算等概念在计算多尺度建模领域是标准且科学合理的。没有违反任何科学定律。\n2.  **非形式化或不相关**：该问题与 HMM 主题直接相关，并以形式化的数学方式表达，允许进行严谨的求解。\n3.  **不完整或矛盾的设置**：所有必要的函数（$\\hat{A}(x)$, $\\frac{du^H}{dx}$, $\\varphi(x)$）和积分域都已明确定义。该问题是自洽的，没有矛盾。\n4.  **不切实际或不可行**：函数和数值是为了数学上的便利而选择的，但在物理上并非不可能。使用无量纲量是标准做法。\n5.  **病态或结构不良**：该问题是适定的。它要求计算特定的定积分和极限，存在唯一且稳定的结果。\n6.  **伪深刻、琐碎或同义反复**：该问题需要直接应用所提供的微积分和定义，测试对 HMM 组装过程的理解。它既不琐碎也不人为复杂。\n7.  **超出科学可验证性**：计算过程在数学上是可验证的。\n\n### 第3步：结论与行动\n问题是有效的。将提供详细的解答。\n\n主要目标是计算给定测试函数 $\\varphi$ 的宏观有限元残差 $R$。残差由与扩散算子相关的双线性形式定义，对网格的所有单元 $K$ 求和：\n$$R = \\sum_{K} \\int_{K} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$$\n求和是在测试函数支撑集非零的单元上进行的，本例中即为 $K_1 = [0, 1]$ 和 $K_2 = [1, 2]$。\n$$R = \\int_{0}^{1} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx + \\int_{1}^{2} \\hat{A}(x)\\,\\frac{d u^{H}}{dx}\\,\\frac{d \\varphi}{dx}\\,dx$$\n\n首先，我们需要确定测试函数在每个单元上的导数 $\\frac{d \\varphi}{dx}$。\n- 对于 $x \\in K_1 = [0, 1]$，测试函数为 $\\varphi(x) = x$。其导数为 $\\frac{d \\varphi}{dx} = 1$。\n- 对于 $x \\in K_2 = [1, 2]$，测试函数为 $\\varphi(x) = 2 - x$。其导数为 $\\frac{d \\varphi}{dx} = -1$。\n\n现在，我们可以分别计算每个单元上的积分。\n\n对于第一个单元 $K_1 = [0, 1]$：\n我们已知 $\\hat{A}(x) = 1 + x$ 且 $\\frac{d u^{H}}{dx} = 2$。\n该单元的积分为：\n$$I_1 = \\int_{0}^{1} (1 + x)\\,(2)\\,(1)\\,dx = 2 \\int_{0}^{1} (1 + x)\\,dx$$\n计算该积分：\n$$I_1 = 2 \\left[ x + \\frac{x^2}{2} \\right]_{0}^{1} = 2 \\left( \\left(1 + \\frac{1^2}{2}\\right) - \\left(0 + \\frac{0^2}{2}\\right) \\right) = 2 \\left( \\frac{3}{2} \\right) = 3$$\n\n对于第二个单元 $K_2 = [1, 2]$：\n我们已知 $\\hat{A}(x) = 3 + x$ 且 $\\frac{d u^{H}}{dx} = 1$。\n该单元的积分为：\n$$I_2 = \\int_{1}^{2} (3 + x)\\,(1)\\,(-1)\\,dx = - \\int_{1}^{2} (3 + x)\\,dx$$\n计算该积分：\n$$I_2 = - \\left[ 3x + \\frac{x^2}{2} \\right]_{1}^{2} = - \\left( \\left(3(2) + \\frac{2^2}{2}\\right) - \\left(3(1) + \\frac{1^2}{2}\\right) \\right)$$\n$$I_2 = - \\left( (6 + 2) - \\left(3 + \\frac{1}{2}\\right) \\right) = - \\left( 8 - \\frac{7}{2} \\right) = - \\left( \\frac{16 - 7}{2} \\right) = -\\frac{9}{2}$$\n\n总残差 $R$ 是每个单元贡献的总和：\n$$R = I_1 + I_2 = 3 + \\left(-\\frac{9}{2}\\right) = \\frac{6}{2} - \\frac{9}{2} = -\\frac{3}{2}$$\n\n接下来，我们验证在界面 $x=1$ 处的通量守恒性。数值通量由 $q(x) = \\hat{A}(x)\\,\\frac{d u^{H}}{dx}$ 给出。我们需要计算跳跃 $[q] = q_L(1) - q_R(1)$。\n\n在界面左侧（$K_1$ 内），通量为：\n$$q_L(x) = (1+x)(2)$$\n从左侧逼近 $x=1$ 的极限是：\n$$q_L(1) = \\lim_{x \\to 1^-} 2(1+x) = 2(1+1) = 4$$\n\n在界面右侧（$K_2$ 内），通量为：\n$$q_R(x) = (3+x)(1)$$\n从右侧逼近 $x=1$ 的极限是：\n$$q_R(1) = \\lim_{x \\to 1^+} (3+x) = 3+1 = 4$$\n\n因此，在 $x=1$ 处的数值通量跳跃为：\n$$[q] = q_L(1) - q_R(1) = 4 - 4 = 0$$\n通量跳跃为零表示数值通量在单元界面上是连续的，这是此 HMM 设置中守恒的一个条件。\n\n最终需要回答的是宏观有限元残差的值。", "answer": "$$\\boxed{-\\frac{3}{2}}$$", "id": "3508973"}, {"introduction": "直接在每个宏观积分点求解微观问题会导致巨大的计算成本，这在实际应用中往往是不可行的。因此，构建和使用预计算数据库（或称为“缓存”）是一种关键的加速策略。本练习将指导您设计一个数据驱动的插值方案，该方案不仅可以根据离散的微观计算结果估计任意点的宏观应力，而且还能保证插值结果符合热力学一致性（如自由能的凸性），这对于保证宏观模拟的物理真实性和数值稳定性至关重要。([@problem_id:3508914])", "problem": "考虑一个一维热弹性异构多尺度方法 (HMM) 耦合问题，其中一个宏观杆遵循小应变运动学，其宏观应变表示为 $e \\in \\mathbb{R}$ (无量纲)，温度表示为 $T \\in \\mathbb{R}$ (开尔文)，宏观 Cauchy 应力表示为 $\\sigma(e,T)$ (兆帕, MPa)。在 HMM 中，微单元计算通过在宏观运动学约束下最小化微观场上的 Helmholtz 自由能密度 $\\psi(e,T)$ 来提供等效本构响应，而宏观应力是等效自由能相对于应变在固定温度下的导数，即 $\\sigma(e,T) = \\partial \\psi(e,T)/\\partial e$。\n\n现提供从平衡的微单元边值问题中获得的、在两个温度和三个应变水平下的微观解析应力值的缓存数据如下：\n- 在 $T_0 = 300$ 开尔文时：\n  - $\\sigma(0,300) = -30$ MPa,\n  - $\\sigma(0.01,300) = 120$ MPa,\n  - $\\sigma(0.02,300) = 280$ MPa.\n- 在 $T_1 = 400$ 开尔文时：\n  - $\\sigma(0,400) = -50$ MPa,\n  - $\\sigma(0.01,400) = 100$ MPa,\n  - $\\sigma(0.02,400) = 250$ MPa.\n\n从等效 Helmholtz 自由能 $\\psi(e,T)$ 对于每个固定的 $T$ 都是关于 $e$ 的凸函数，以及 $\\sigma(e,T) = \\partial \\psi(e,T)/\\partial e$ 这一热力学结构出发，在给定的缓存数据上设计一个严格由数据驱动的插值方案，该方案满足：\n1. 对于每个固定的 $T \\in \\{T_0,T_1\\}$，产生一个关于 $e$ 的插值函数，该插值函数与 $\\sigma(e,T)$ 是一个关于 $e$ 的凸函数的导数这一性质相容（从而使得最终的 $\\sigma(e,T)$ 是关于 $e$ 的单调不减函数）。\n2. 对于中间温度 $T \\in (T_0,T_1)$，产生一个插值函数，该函数保持关于 $e$ 的凸性，并尊重在缓存应变点上观察到的 $\\sigma(e,T)$ 相对于温度的单调性。\n\n然后，使用您的方案，计算在查询点 $e^\\star = 0.015$ 和 $T^\\star = 350$ 开尔文处的插值宏观应力 $\\sigma(e^\\star,T^\\star)$。以 MPa 为单位表示最终应力，并将您的答案四舍五入到四位有效数字。不要假设任何参数化的本构定律；仅使用上述缓存数据和热力学结构。", "solution": "我们从支撑热弹性异构多尺度方法 (HMM) 的热力学和变分结构开始。微单元计算提供了作为宏观应变 $e$ 和温度 $T$ 的函数的等效 Helmholtz 自由能 $\\psi(e,T)$，而宏观 Cauchy 应力由热力学共轭关系给出\n$$\n\\sigma(e,T) = \\frac{\\partial \\psi(e,T)}{\\partial e}\\Big|_{T}.\n$$\n对于固定的 $T$，假设 $\\psi(\\cdot,T)$ 是关于 $e$ 的凸函数，则其导数 $\\sigma(\\cdot,T)$ 必须是关于 $e$ 的单调不减函数。我们的插值方案必须明确地遵循这一结构。\n\n步骤 1：固定温度下应变的插值。对于每个固定的 $T \\in \\{T_0,T_1\\}$，我们构造一个分段线性插值函数 $\\sigma_T(e)$，它连接数据点 $(e_i,\\sigma(e_i,T))$，其中 $e_0=0$, $e_1=0.01$, $e_2=0.02$。各线段的斜率为\n$$\nm_{i}(T) = \\frac{\\sigma(e_{i+1},T) - \\sigma(e_i,T)}{e_{i+1}-e_i}, \\quad i=0,1.\n$$\n根据缓存数据：\n- 在 $T_0=300$ 时：\n  $$\n  m_0(T_0) = \\frac{120 - (-30)}{0.01 - 0} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}, \\quad\n  m_1(T_0) = \\frac{280 - 120}{0.02 - 0.01} = \\frac{160}{0.01} = 16000 \\ \\text{MPa}.\n  $$\n- 在 $T_1=400$ 时：\n  $$\n  m_0(T_1) = \\frac{100 - (-50)}{0.01 - 0} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}, \\quad\n  m_1(T_1) = \\frac{250 - 100}{0.02 - 0.01} = \\frac{150}{0.01} = 15000 \\ \\text{MPa}.\n  $$\n在每个固定温度 $T$下，这些斜率都随 $i$ 单调不减（在 $T_0$ 时 $15000 \\le 16000$；在 $T_1$ 时 $15000 = 15000$）。因此，分段线性应力 $\\sigma_T(e)$ 是关于 $e$ 单调不减的。由于一维的单调不减函数是某个凸函数的导数，我们可以通过积分定义一个凸势 $\\psi_T(e)$：\n$$\n\\psi_T(e) = \\int_{0}^{e} \\sigma_T(s)\\, ds + \\psi_T(0),\n$$\n其中 $\\psi_T(0)$ 可任意选择（它不影响 $\\sigma_T$）。因为 $\\sigma_T$ 是分段线性和单调的，所以 $\\psi_T$ 是分段二次和凸的。\n\n步骤 2：温度的插值。对于 $T \\in (T_0,T_1)$，我们对自由能进行温度的线性插值：\n$$\n\\psi(e,T) = \\lambda(T)\\, \\psi_{T_0}(e) + \\big(1-\\lambda(T)\\big)\\, \\psi_{T_1}(e),\n$$\n其中\n$$\n\\lambda(T) = \\frac{T_1 - T}{T_1 - T_0}.\n$$\n凸函数的线性插值保持凸性，因此 $\\psi(\\cdot,T)$ 是关于 $e$ 的凸函数。在固定 $T$ 下对 $e$ 求导，得到应力插值函数\n$$\n\\sigma(e,T) = \\frac{\\partial \\psi(e,T)}{\\partial e} = \\lambda(T)\\, \\sigma_{T_0}(e) + \\big(1-\\lambda(T)\\big)\\, \\sigma_{T_1}(e).\n$$\n这是关于 $e$ 的单调不减函数的凸组合，因此它仍然是关于 $e$ 的单调不减函数。此外，由于在固定 $e$ 时的缓存应力在 $T$ 上是单调的（对于每个 $e \\in \\{0,0.01,0.02\\}$，应力随 $T$ 的增加而减小），因此在 $T$ 上的线性插值在区间 $[T_0,T_1]$ 内保持了这种单调性。\n\n步骤 3：计算查询点 $(e^\\star,T^\\star) = (0.015,350)$ 处的插值应力。首先计算温度权重\n$$\n\\lambda(T^\\star) = \\frac{T_1 - T^\\star}{T_1 - T_0} = \\frac{400 - 350}{400 - 300} = \\frac{50}{100} = 0.5.\n$$\n接下来，在 $e^\\star$ 处计算分段线性应变插值函数。由于 $e^\\star \\in [e_1,e_2] = [0.01,0.02]$，我们使用线段公式：\n- 在 $T_0=300$ 时：\n  $$\n  \\sigma_{T_0}(e^\\star) = \\sigma(0.01,300) + m_1(T_0)\\, (e^\\star - 0.01) = 120 + 16000 \\times (0.015 - 0.01).\n  $$\n  计算增量：\n  $$\n  16000 \\times 0.005 = 80,\n  $$\n  因此\n  $$\n  \\sigma_{T_0}(e^\\star) = 120 + 80 = 200.\n  $$\n- 在 $T_1=400$ 时：\n  $$\n  \\sigma_{T_1}(e^\\star) = \\sigma(0.01,400) + m_1(T_1)\\, (e^\\star - 0.01) = 100 + 15000 \\times (0.015 - 0.01).\n  $$\n  计算增量：\n  $$\n  15000 \\times 0.005 = 75,\n  $$\n  因此\n  $$\n  \\sigma_{T_1}(e^\\star) = 100 + 75 = 175.\n  $$\n最后，进行温度间的组合：\n$$\n\\sigma(e^\\star,T^\\star) = \\lambda(T^\\star)\\, \\sigma_{T_0}(e^\\star) + \\big(1-\\lambda(T^\\star)\\big)\\, \\sigma_{T_1}(e^\\star) = 0.5 \\times 200 + 0.5 \\times 175 = \\frac{200 + 175}{2} = 187.5.\n$$\n因此，在 $e^\\star=0.015$ 和 $T^\\star=350$ 开尔文处的插值宏观应力为 $187.5$ MPa。以 MPa 为单位表示，并四舍五入到四位有效数字，其值为 $187.5$ MPa（已经是四位有效数字）。", "answer": "$$\\boxed{187.5}$$", "id": "3508914"}]}