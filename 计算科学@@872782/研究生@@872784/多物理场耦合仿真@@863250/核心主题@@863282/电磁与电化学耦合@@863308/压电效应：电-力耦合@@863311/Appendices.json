{"hands_on_practices": [{"introduction": "要掌握压电耦合，我们必须首先理解材料在不同电学约束下如何响应激励。这个基础练习 [@problem_id:3522455] 要求你从本构方程出发，直接推导一个简单的一维压电杆在短路和开路这两种极限情况下的应变和电荷。这项练习旨在阐明机械变形与电学响应之间的基本相互作用。", "problem": "一根一维 (1D) 极化压电杆沿其极化轴排列，具有均匀的横截面积 $A$、长度 $L$、杨氏模量 $E_Y$、介电常数 $\\epsilon$ 以及轴向压电耦合系数 $d_{33}$。该杆在轴向方向上机械无应力。考虑施加在同一根杆上的两种不同电学边界条件：\n\n1. 短路电学边界：两端电极连接到一个理想电压源，该电压源在杆内建立一个沿杆方向的均匀内部电场 $E$。\n2. 开路电学边界：两端电极被电绝缘，因此没有自由电荷可以流入或流出该杆。\n\n从控制线性压电学、连续介质力学和静电学（包括线性弹性的广义胡克定律和电位移的高斯定律）的基本定义和定律出发，推导在每种电学边界条件下，轴向应变 $\\varepsilon$ 和积累在一端电极上的总自由电荷 $Q$。在两种情况下，该杆都无应力。将应变表示为无量纲量，电荷以库仑 (C) 为单位表示。按顺序 $(\\varepsilon_{\\text{sc}}, Q_{\\text{sc}}, \\varepsilon_{\\text{oc}}, Q_{\\text{oc}})$ 提供这四个量的最终表达式，其中下标 $\\text{sc}$ 和 $\\text{oc}$ 分别表示短路和开路。无需进行数值计算，也无需四舍五入。你的最终答案必须是单个闭式解析表达式。", "solution": "该问题被认为是有效的，因为它科学地基于线性压电学原理，是适定的，具有唯一且有意义的解，并以客观、无歧义的语言表述。它没有违反任何无效标准。因此，我们可以着手求解。\n\n一维线性压电材料（沿轴向，即惯例上的“3”方向极化）的行为可以通过一组耦合的本构方程来描述。我们将使用应变-电荷形式，它将应变 ($\\varepsilon$) 和应力 ($\\sigma$) 等机械变量与电场 ($E$) 和电位移 ($D$) 等电学变量联系起来。对于此一维情况，省略张量下标，方程为：\n$$ \\varepsilon = s^E \\sigma + d E \\quad (1) $$\n$$ D = d \\sigma + \\epsilon^\\sigma E \\quad (2) $$\n这里，参数定义如下：\n- $\\varepsilon$: 轴向应变 (无量纲)。\n- $\\sigma$: 轴向应力 (单位为帕斯卡, $Pa$)。\n- $E$: 轴向电场 (单位为伏特/米, $V/m$)。\n- $D$: 轴向电位移 (单位为库仑/平方米, $C/m^2$)。\n- $s^E$: 恒定电场下的弹性柔顺系数。这是杨氏模量的倒数，$s^E = 1/E_Y$。\n- $d$: 压电耦合系数，给定为 $d_{33}$。它量化了在恒定应力下单位电场产生的应变，或等效地，在恒定电场下单位应力产生的电位移。\n- $\\epsilon^\\sigma$: 恒定应力下的介电常数，给定为 $\\epsilon$。\n\n根据电介质的高斯定律，积累在面积为 $A$ 的电极上的总自由电荷 $Q$ 与电位移 $D$ 相关。对于垂直于电极表面的均匀电场，该关系为：\n$$ Q = D A \\quad (3) $$\n\n问题陈述中提供的一个关键条件是，在两种情况下，杆在轴向方向上都是机械无应力的。这意味着：\n$$ \\sigma = 0 $$\n将此条件应用于本构方程 $(1)$ 和 $(2)$，可将其简化为：\n$$ \\varepsilon = d E \\quad (4) $$\n$$ D = \\epsilon E \\quad (5) $$\n注意，问题中给出的介电常数 $\\epsilon$ 对应于 $\\epsilon^\\sigma$。类似地，压电系数 $d_{33}$ 对应于 $d$。我们现在使用这些简化方程来分析两种指定的电学边界条件。\n\n**1. 短路 (sc) 电学边界条件：**\n在这种情况下，一个理想电压源连接到两端电极，在杆内建立一个指定的均匀内部电场 $E$。机械条件是 $\\sigma = 0$。\n\n为了求轴向应变 $\\varepsilon_{\\text{sc}}$，我们使用方程 $(4)$：\n$$ \\varepsilon_{\\text{sc}} = d_{33} E $$\n\n为了求一个电极上的总自由电荷 $Q_{\\text{sc}}$，我们首先使用方程 $(5)$ 求出电位移 $D_{\\text{sc}}$：\n$$ D_{\\text{sc}} = \\epsilon E $$\n然后，使用方程 $(3)$，我们求出电荷：\n$$ Q_{\\text{sc}} = D_{\\text{sc}} A = \\epsilon A E $$\n\n**2. 开路 (oc) 电学边界条件：**\n在这种情况下，两端电极是电绝缘的。这意味着没有自由电荷可以流入或流出电极，这在物理上意味着电极上的总净自由电荷必须为零。\n$$ Q_{\\text{oc}} = 0 $$\n从关系式 $Q = DA$ 可知，总电荷为零意味着整个杆内的电位移也必须为零：\n$$ D_{\\text{oc}} = 0 $$\n机械条件仍然是杆无应力，所以 $\\sigma = 0$。\n\n我们使用完整的本构方程 $(2)$ 来关联这些变量：\n$$ D_{\\text{oc}} = d_{33} \\sigma + \\epsilon E_{\\text{oc}} $$\n代入已知条件 $D_{\\text{oc}}=0$ 和 $\\sigma=0$：\n$$ 0 = d_{33}(0) + \\epsilon E_{\\text{oc}} $$\n$$ 0 = \\epsilon E_{\\text{oc}} $$\n由于介电常数 $\\epsilon$ 是一个非零的材料属性 ($\\epsilon > 0$)，内部电场必须为零：\n$$ E_{\\text{oc}} = 0 $$\n\n现在，为了求轴向应变 $\\varepsilon_{\\text{oc}}$，我们使用本构方程 $(1)$：\n$$ \\varepsilon_{\\text{oc}} = \\frac{1}{E_Y} \\sigma + d_{33} E_{\\text{oc}} $$\n代入条件 $\\sigma=0$ 和 $E_{\\text{oc}}=0$：\n$$ \\varepsilon_{\\text{oc}} = \\frac{1}{E_Y}(0) + d_{33}(0) $$\n$$ \\varepsilon_{\\text{oc}} = 0 $$\n\n总而言之，对于开路、无应力的情况，所有主要场量（应变、电场、电位移）和自由电荷都为零。这代表了在没有任何机电激励的情况下材料的静态平衡状态。\n\n所要求的四个量是：\n- 短路下的应变： $\\varepsilon_{\\text{sc}} = d_{33} E$\n- 短路下的电荷： $Q_{\\text{sc}} = \\epsilon A E$\n- 开路下的应变： $\\varepsilon_{\\text{oc}} = 0$\n- 开路下的电荷： $Q_{\\text{oc}} = 0$", "answer": "$$\\boxed{\\begin{pmatrix} d_{33} E & \\epsilon A E & 0 & 0 \\end{pmatrix}}$$", "id": "3522455"}, {"introduction": "压电材料常因其谐振特性而被用于滤波器和振荡器等器件中。这项练习 [@problem_id:3522470] 将我们从静态分析带入动态分析，要求你推导板状谐振器在短路和开路条件下的谐振频率。通过这个过程，你将揭示机电耦合系数 $k_t^2$ 的物理意义——一个量化能量转换效率的关键品质因数。", "problem": "考虑一个厚度为 $h$、电极面积为 $A$ 的极化横向各向同性压电板，其极化轴与平面外坐标 $z$ 对齐。假设存在一维厚度模式运动，位移场为 $u_{3}(z,t)$，应变为小应变，且横向场可忽略不计。控制基础是牛顿第二定律和高斯定律，以及线性压电本构关系。具体来说，使用 $z$ 方向的线性动量平衡方程 $\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$（其中 $\\rho$ 为质量密度），以及在体内没有自由电荷情况下的高斯定律 $\\partial D_{3}/\\partial z = 0$。一维本构方程为 $T_{3} = c_{33}^{E}\\,S_{3} - e_{33}\\,E_{3}$ 和 $D_{3} = e_{33}\\,S_{3} + \\epsilon_{33}^{S}\\,E_{3}$，其中 $S_{3} = \\partial u_{3}/\\partial z$ 是厚度应变，$E_{3}$ 是厚度电场，$T_{3}$ 是厚度应力，$D_{3}$ 是厚度电位移，$c_{33}^{E}$ 是恒定电场下的弹性刚度，$e_{33}$ 是压电应力系数，$\\epsilon_{33}^{S}$ 是恒定应变下的介电常数。\n\n假设在 $z=0$ 和 $z=h$ 的表面有理想导电电极，力学边界条件为无牵引力，即 $T_{3}(0,t)=T_{3}(h,t)=0$，以及两种电学边界条件：\n- 短路：电极电势差为零，意味着 $E_{3}(z,t)=0$。\n- 开路：电极上的净自由电荷为零，意味着在整个厚度上 $D_{3}(z,t)=0$。\n\n1. 从给定的基础出发，推导在力学边界条件下，厚度模式振动 $u_{3}(z,t)=\\Re\\{U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$ 的一维特征值问题。说明在短路和开路电学边界条件下，进入波动方程的有效刚度有何不同，并求出相应的特征频率。\n\n2. 通过材料关系 $k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$ 定义厚度机电耦合因子 $k_{t}^{2}$，其中 $c_{33}^{D} = c_{33}^{E} + \\dfrac{e_{33}^{2}}{\\epsilon_{33}^{S}}$ 是恒定电位移下的弹性刚度。利用你得到的特征频率结果，计算开路和短路条件之间的归一化共振频率偏移，\n$$\n\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}},\n$$\n并将其表示为仅含 $k_{t}^{2}$ 的闭式解析表达式。不需要进行数值计算。请将你的最终答案以 $\\Delta$ 的单一闭式表达式形式给出。由于 $\\Delta$ 是无量纲的，因此不需要指定单位，也不需要四舍五入。", "solution": "首先对问题进行严格验证，以确保其科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- **几何与坐标**：一个厚度为 $h$、电极面积为 $A$ 的压电板。极化轴与 $z$ 坐标对齐，运动是一维的，$u_{3}(z,t)$。\n- **控制方程**：\n  - 动量平衡：$\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$\n  - 高斯定律（在电介质中）：$\\partial D_{3}/\\partial z = 0$\n- **本构关系（一维线性压电理论）**：\n  - $T_{3} = c_{33}^{E}\\,S_{3} - e_{33}\\,E_{3}$\n  - $D_{3} = e_{33}\\,S_{3} + \\epsilon_{33}^{S}\\,E_{3}$\n- **变量定义**：\n  - $u_3$：$z$ 方向的位移\n  - $S_{3} = \\partial u_{3}/\\partial z$：厚度应变\n  - $T_{3}$：厚度应力\n  - $E_{3}$：厚度电场\n  - $D_{3}$：厚度电位移\n  - $\\rho$：质量密度\n  - $c_{33}^{E}$：恒定电场下的弹性刚度\n  - $e_{33}$：压电应力系数\n  - $\\epsilon_{33}^{S}$：恒定应变下的介电常数\n- **谐波解形式**：$u_{3}(z,t)=\\Re\\{U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)\\}$\n- **力学边界条件**：无牵引力表面，$T_{3}(0,t)=0$ 和 $T_{3}(h,t)=0$。\n- **电学边界条件（两种情况）**：\n  1.  **短路 (SC)**：电势差为零，题目明确指出这意味着 $E_{3}(z,t)=0$。\n  2.  **开路 (OC)**：电极上的净自由电荷为零，题目明确指出这意味着 $D_{3}(z,t)=0$。\n- **第 2 部分的定义**：\n  - 恒定电位移下的刚度：$c_{33}^{D} = c_{33}^{E} + \\dfrac{e_{33}^{2}}{\\epsilon_{33}^{S}}$\n  - 厚度机电耦合因子：$k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$\n- **要求输出**：归一化频率偏移 $\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}}$，表示为仅含 $k_{t}^{2}$ 的闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于标准的线性压电理论，这是连续介质力学中一个成熟的领域。控制方程、本构关系和边界条件都是模拟压电板厚度模式振动的标准方法。该问题是适定的，为推导短路和开路两种情况下的特征频率提供了充分的条件以获得唯一解。语言客观、正式。\n\n对于短路情况的假设，即零电势差意味着处处 $E_3(z,t) = 0$，是一种简化。在完全动态分析中，$\\int_0^h E_3 dz = 0$ 并不必然要求 $E_3=0$ 逐点成立。然而，问题明确地将其作为一个强制条件（“...意味着 $E_{3}(z,t)=0$”）。因此，它被视为这个特定问题的一个给定前提，这是一种常见的教学方法，用以分离机电耦合对有效刚度的影响。开路条件 $D_3(z,t)=0$ 是电极上净电荷为零与电介质高斯定律相结合的正确推论。\n\n该问题是完整的、一致的，并且可以使用标准的数学物理技术求解。这是多物理场中一个不平凡但标准的练习。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将推导解答。\n\n### 解答推导\n\n推导过程如下：首先为每种电学边界条件建立一维波动方程，求解相应的特征值问题，然后使用得到的特征频率计算所需的归一化偏移。\n\n根据高斯定律 $\\partial D_{3}/\\partial z = 0$，可以得出电位移 $D_3$ 在空间上是均匀的，即 $D_3(z,t) = D_3(t)$。\n\n**第 1 部分：特征值问题和特征频率**\n\n**情况 A：短路 (SC) 条件**\n在指定的短路条件下，$E_{3}(z,t) = 0$。将此代入应力 $T_3$ 的本构方程可得：\n$$\nT_{3} = c_{33}^{E}\\,S_{3} - e_{33}(0) = c_{33}^{E}\\,S_{3}\n$$\n动量平衡方程为 $\\partial T_{3}/\\partial z = \\rho\\,\\partial^{2} u_{3}/\\partial t^{2}$。代入 $T_3$ 的表达式和应变定义 $S_{3} = \\partial u_{3}/\\partial z$，我们得到波动方程：\n$$\n\\frac{\\partial}{\\partial z} \\left(c_{33}^{E} \\frac{\\partial u_{3}}{\\partial z}\\right) = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}} \\implies c_{33}^{E} \\frac{\\partial^{2} u_{3}}{\\partial z^{2}} = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}}\n$$\n对于形式为 $u_{3}(z,t) = U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)$ 的谐波振动，时间导数变为 $\\partial^{2} u_{3}/\\partial t^{2} = -\\omega^{2} U(z)\\,\\exp(\\mathrm{i}\\,\\omega t)$。波动方程简化为关于振型 $U(z)$ 的常微分方程：\n$$\nc_{33}^{E} \\frac{d^{2}U}{dz^{2}} = -\\rho\\,\\omega^{2} U \\implies \\frac{d^{2}U}{dz^{2}} + \\left(\\frac{\\rho\\,\\omega^{2}}{c_{33}^{E}}\\right) U = 0\n$$\n这就是特征值问题。有效弹性刚度为 $c_{33}^{E}$。设波数为 $k_{\\mathrm{sc}}^{2} = \\rho\\,\\omega^{2}/c_{33}^{E}$。方程为 $\\frac{d^{2}U}{dz^{2}} + k_{\\mathrm{sc}}^{2} U = 0$。\n\n力学边界条件为 $T_{3}(0,t)=T_{3}(h,t)=0$。由于 $T_3 = c_{33}^E S_3 = c_{33}^E \\frac{\\partial u_3}{\\partial z}$，这些条件转化为 $\\frac{\\partial u_3}{\\partial z}(0,t) = 0$ 和 $\\frac{\\partial u_3}{\\partial z}(h,t)=0$。用振型 $U(z)$ 表示，我们有 $\\frac{dU}{dz}(0) = 0$ 和 $\\frac{dU}{dz}(h)=0$。\n\n$U(z)$ 的通解为 $U(z) = C_1 \\cos(k_{\\mathrm{sc}} z) + C_2 \\sin(k_{\\mathrm{sc}} z)$。其导数为 $\\frac{dU}{dz} = -C_1 k_{\\mathrm{sc}} \\sin(k_{\\mathrm{sc}} z) + C_2 k_{\\mathrm{sc}} \\cos(k_{\\mathrm{sc}} z)$。\n在 $z=0$ 处应用第一个边界条件：$\\frac{dU}{dz}(0) = C_2 k_{\\mathrm{sc}} = 0$。对于非平凡振动，$k_{\\mathrm{sc}} \\neq 0$，所以必须有 $C_2=0$。\n解简化为 $U(z) = C_1 \\cos(k_{\\mathrm{sc}} z)$。\n在 $z=h$ 处应用第二个边界条件：$\\frac{dU}{dz}(h) = -C_1 k_{\\mathrm{sc}} \\sin(k_{\\mathrm{sc}} h) = 0$。\n为了得到非平凡解（$C_1 \\neq 0$），我们要求 $\\sin(k_{\\mathrm{sc}} h) = 0$。这意味着 $k_{\\mathrm{sc}} h = n\\pi$，其中 $n=1, 2, 3, \\dots$ 为整数（$n=0$ 对应于刚体运动）。\n代入 $k_{\\mathrm{sc}}$ 的定义：\n$$\n\\left(\\sqrt{\\frac{\\rho\\,\\omega_{\\mathrm{sc},n}^{2}}{c_{33}^{E}}}\\right)h = n\\pi \\implies \\omega_{\\mathrm{sc},n}^{2} = \\frac{n^{2}\\pi^{2}c_{33}^{E}}{\\rho h^{2}}\n$$\n基频（$n=1$）为 $f_{\\mathrm{sc}} = \\frac{\\omega_{\\mathrm{sc},1}}{2\\pi} = \\frac{1}{2h}\\sqrt{\\frac{c_{33}^{E}}{\\rho}}$。\n\n**情况 B：开路 (OC) 条件**\n在开路条件下，$D_{3}(z,t) = 0$。根据第二个本构关系 $0 = e_{33}S_{3} + \\epsilon_{33}^{S}E_{3}$，我们可以用应变来表示电场：\n$$\nE_{3} = -\\frac{e_{33}}{\\epsilon_{33}^{S}} S_{3}\n$$\n将此代入应力 $T_3$ 的第一个本构关系：\n$$\nT_{3} = c_{33}^{E}S_{3} - e_{33}\\left(-\\frac{e_{33}}{\\epsilon_{33}^{S}}S_{3}\\right) = \\left(c_{33}^{E} + \\frac{e_{33}^{2}}{\\epsilon_{33}^{S}}\\right)S_{3}\n$$\n括号中的项是“强化”弹性模量，在问题中被定义为 $c_{33}^{D}$。因此，$T_3 = c_{33}^{D} S_3$。开路情况下的有效刚度是 $c_{33}^{D}$。\n动量平衡方程现在变为：\n$$\n\\frac{\\partial}{\\partial z} \\left(c_{33}^{D} \\frac{\\partial u_{3}}{\\partial z}\\right) = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}} \\implies c_{33}^{D} \\frac{\\partial^{2} u_{3}}{\\partial z^{2}} = \\rho\\,\\frac{\\partial^{2} u_{3}}{\\partial t^{2}}\n$$\n这是一个在形式上与短路情况相同的波动方程，只是将 $c_{33}^{E}$ 替换为 $c_{33}^{D}$。\n特征值问题为 $\\frac{d^{2}U}{dz^{2}} + k_{\\mathrm{oc}}^{2} U = 0$，其中波数现在是 $k_{\\mathrm{oc}}^{2} = \\rho\\,\\omega^{2}/c_{33}^{D}$。\n力学边界条件 $T_3=0$ 保持不变。由于 $T_3$ 仍然与 $S_3 = \\partial u_3 / \\partial z$ 成正比，因此对 $U(z)$ 的边界条件仍然是 $\\frac{dU}{dz}(0)=0$ 和 $\\frac{dU}{dz}(h)=0$。\n整个求解过程是相同的，导致条件 $k_{\\mathrm{oc}} h = n\\pi$。\n代入 $k_{\\mathrm{oc}}$ 的定义：\n$$\n\\left(\\sqrt{\\frac{\\rho\\,\\omega_{\\mathrm{oc},n}^{2}}{c_{33}^{D}}}\\right)h = n\\pi \\implies \\omega_{\\mathrm{oc},n}^{2} = \\frac{n^{2}\\pi^{2}c_{33}^{D}}{\\rho h^{2}}\n$$\n开路情况下的基频（$n=1$）为 $f_{\\mathrm{oc}} = \\frac{\\omega_{\\mathrm{oc},1}}{2\\pi} = \\frac{1}{2h}\\sqrt{\\frac{c_{33}^{D}}{\\rho}}$。\n\n**第 2 部分：归一化频率偏移**\n我们需要计算 $\\Delta = \\frac{f_{\\mathrm{oc}} - f_{\\mathrm{sc}}}{f_{\\mathrm{sc}}}$。这可以改写为 $\\Delta = \\frac{f_{\\mathrm{oc}}}{f_{\\mathrm{sc}}} - 1$。\n使用上面推导出的基频：\n$$\n\\frac{f_{\\mathrm{oc}}}{f_{\\mathrm{sc}}} = \\frac{\\frac{1}{2h}\\sqrt{\\frac{c_{33}^{D}}{\\rho}}}{\\frac{1}{2h}\\sqrt{\\frac{c_{33}^{E}}{\\rho}}} = \\sqrt{\\frac{c_{33}^{D}}{c_{33}^{E}}}\n$$\n因此，归一化频率偏移为：\n$$\n\\Delta = \\sqrt{\\frac{c_{33}^{D}}{c_{33}^{E}}} - 1\n$$\n我们现在必须用厚度机电耦合因子 $k_{t}^{2}$ 来表示这个结果，其定义为 $k_{t}^{2} = \\dfrac{c_{33}^{D} - c_{33}^{E}}{c_{33}^{D}}$。\n我们可以重新整理这个定义来求比率 $c_{33}^{D}/c_{33}^{E}$：\n$$\nk_{t}^{2} = 1 - \\frac{c_{33}^{E}}{c_{33}^{D}} \\implies \\frac{c_{33}^{E}}{c_{33}^{D}} = 1 - k_{t}^{2}\n$$\n将其倒数可得到所需的比率：\n$$\n\\frac{c_{33}^{D}}{c_{33}^{E}} = \\frac{1}{1 - k_{t}^{2}}\n$$\n将此结果代入 $\\Delta$ 的表达式中：\n$$\n\\Delta = \\sqrt{\\frac{1}{1 - k_{t}^{2}}} - 1 = \\frac{1}{\\sqrt{1 - k_{t}^{2}}} - 1\n$$\n这就是仅用 $k_{t}^{2}$ 表示的归一化频率偏移的最终闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{1 - k_{t}^{2}}} - 1}$$", "id": "3522470"}, {"introduction": "现代工程高度依赖计算仿真，而填补解析理论与数值实现之间的鸿沟是一项至关重要的技能。这项练习 [@problem_id:3522419] 指导你构建一个压电元件的最小计算模型，应用与我们第一个练习中相同的核心物理原理。通过编程处理不同的边界条件，你将深入了解多物理场软件是如何求解这些耦合场问题的。", "problem": "考虑一个均匀的压电单位立方体，其边长为 $h$ 米，在垂直于 $z$ 轴的面上有平行电极。该材料具有均匀的压电常数 $d_{33}$（单位：库仑/牛顿）和恒定应力下的均匀介电常数 $\\epsilon^T_{33}$（单位：法拉/米）。假设机械应力是均匀的，沿 $z$ 轴施加，大小为 $\\sigma_{3}$（单位：帕斯卡），并且体内部没有自由电荷。电极完全覆盖顶部和底部的表面，每个表面的面积为 $A$（单位：平方米）。该系统是准静态的，并且场被假设为一维且沿 $z$ 方向均匀。\n\n从基本原理出发，使用电介质中静电学的高斯定律（$\\nabla \\cdot \\mathbf{D} = \\rho_f$）和体内部无自由电荷的条件（$\\rho_f = 0$），结合电场定义为电势梯度（$\\mathbf{E} = -\\nabla \\phi$），以及法向电位移分量的线性压电本构方程：\n$$\nD_{3} = d_{33} \\, \\sigma_{3} + \\epsilon^T_{33} \\, E_{3},\n$$\n来构建一个最小计算模型。该模型针对电极上指定的边界条件，计算均匀电位移 $D_{3}$（单位：库仑/平方米）、均匀电场 $E_{3}$（单位：伏特/米）、电极电势差 $V$（单位：伏特）以及电极总自由电荷 $Q$（单位：库仑）。对于具有均匀场的平行板几何结构，电势差和电场满足 $E_{3} = V/h$，电极总电荷满足 $Q = D_{3} A$。\n\n您的程序必须接受一个参数集测试套件，用于指定以下类型之一的边界条件：\n\n- 给定电压：类型 $=$ \"V\"，给定 $V$（单位：伏特）。根据 $V$ 计算 $E_{3}$，然后使用本构关系和几何结构确定 $D_{3}$ 和 $Q$。\n- 给定电荷：类型 $=$ \"Q\"，给定 $Q$（单位：库仑）。根据 $Q/A$ 计算 $D_{3}$，然后使用本构关系和几何结构确定 $E_{3}$ 和 $V$。\n- 混合边界条件：类型 $=$ \"mixed\"，给定顶部电极电势 $V$（单位：伏特）和指定的底部边界条件，即法向电位移 $D_{n}$（单位：库仑/平方米）。由于在此模型中场是均匀的，通过本构关系和几何结构计算 $D_{3}$ 并与指定的 $D_{n}$ 进行比较来检查一致性。\n\n对于每个测试用例，返回一个列表形式的结果 $[D_{3}, E_{3}, V, Q, \\text{is\\_consistent}]$，其中 $D_{3}$ 的单位是 $\\mathrm{C/m^2}$，$E_{3}$ 的单位是 $\\mathrm{V/m}$，$V$ 的单位是 $\\mathrm{V}$，$Q$ 的单位是 $\\mathrm{C}$，而 $\\text{is\\_consistent}$ 是一个布尔值，指示本构关系 $D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$ 是否在很小的数值容差内成立（对于给定电压和给定电荷的情况），以及在混合情况下，计算出的 $D_{3}$ 是否在很小的数值容差内与指定的 $D_{n}$ 匹配。\n\n使用以下国际单位制（SI）测试套件，其中所有标量都必须以国际单位制单位进行解释：\n\n- 通用几何与材料参数：$h = 1.0$ 米，$A = 1.0$ 平方米，$d_{33} = 4.0 \\times 10^{-12}$ 库仑/牛顿，$\\epsilon^T_{33} = 1.33 \\times 10^{-8}$ 法拉/米，$\\sigma_{3} = 1.0 \\times 10^{6}$ 帕斯卡。\n- 测试用例 $1$（正常情况，给定电压）：类型 $=$ \"V\"，$V = 100.0$ 伏特。\n- 测试用例 $2$（正常情况，给定电荷）：类型 $=$ \"Q\"，$Q = 3.0 \\times 10^{-6}$ 库仑。\n- 测试用例 $3$（混合，一致）：类型 $=$ \"mixed\"，$V = 50.0$ 伏特，$D_{n} = d_{33} \\sigma_{3} + \\epsilon^T_{33} \\left(\\frac{V}{h}\\right)$。\n- 测试用例 $4$（混合，不一致）：类型 $=$ \"mixed\"，$V = 10.0$ 伏特，$D_{n} = 5.0 \\times 10^{-6}$ 库仑/平方米。\n- 测试用例 $5$（边缘情况，零电压）：类型 $=$ \"V\"，$V = 0.0$ 伏特。\n- 测试用例 $6$（边缘情况，零电荷）：类型 $=$ \"Q\"，$Q = 0.0$ 库仑。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是每个测试用例的列表 $[D_{3}, E_{3}, V, Q, \\text{is\\_consistent}]$。例如，输出格式应类似于 $[ [d_1,e_1,v_1,q_1,b_1],[d_2,e_2,v_2,q_2,b_2], \\dots ]$，其中数值为国际单位制下的浮点数，布尔值为 $\\text{True}$ 或 $\\text{False}$。", "solution": "该问题经评估为有效。它在科学上基于线性压电学和静电学原理，问题提法清晰，每种情况都有明确的唯一解路径，并且其表述是客观的。构建计算模型所需的所有必要参数和条件均已提供。\n\n所考虑的物理系统是一个压电材料，同时受到沿 $z$ 方向的均匀机械应力 $\\sigma_{3}$ 和电场 $E_{3}$ 的作用。分析始于电介质中静电学的基本原理。\n\n电位移场 $\\mathbf{D}$ 的高斯定律由 $\\nabla \\cdot \\mathbf{D} = \\rho_f$ 给出，其中 $\\rho_f$ 是自由电荷密度。问题陈述材料体内部没有自由电荷，因此 $\\rho_f = 0$。在一维情况下，其中 $\\mathbf{D} = D_{3}(z)\\hat{\\mathbf{z}}$，高斯定律简化为 $\\frac{dD_{3}}{dz} = 0$。这意味着电位移 $D_{3}$ 在整个材料中是均匀的（恒定的），这与问题的假设一致。\n\n电场 $\\mathbf{E}$ 定义为电势 $\\phi$ 的负梯度，即 $\\mathbf{E} = -\\nabla \\phi$。对于一维情况，这变为 $E_{3} = -\\frac{d\\phi}{dz}$。由于问题假设电场 $E_{3}$ 是均匀的，这意味着 $E_{3}$ 是一个常数。通过对电场从底部电极（位于 $z=0$）到顶部电极（位于 $z=h$）进行积分，可以得到厚度为 $h$ 的材料两端的电势差 $V$：\n$$V = \\phi(0) - \\phi(h) = \\int_0^h E_{3} \\, dz = E_{3}h$$\n这给出了指定的关系 $E_{3} = V/h$。\n\n机电耦合的核心由线性压电本构方程描述。对于沿 $z$ 方向的分量，其表达式为：\n$$D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$$\n在这里，$D_{3}$ 是电位移，$\\sigma_{3}$ 是施加的法向应力，$E_{3}$ 是电场，$d_{33}$ 是耦合应力与位移的压电常数，$\\epsilon^T_{33}$ 是材料在恒定应力下的介电常数。第一项 $d_{33} \\sigma_{3}$ 代表由机械应力产生的电位移（正压电效应），而第二项 $\\epsilon^T_{33} E_{3}$ 是对电场的标准介电响应。\n\n最后，对于具有均匀位移 $D_3$ 的平行板电容器几何结构，面积为 $A$ 的电极上累积的总自由电荷 $Q$ 由 $Q = D_3 A$ 给出。\n\n基于这些原理，我们可以为每种指定的边界条件构建计算模型。\n\n**情况1：给定电压（类型 \"V\"）**\n当电极间的电势差 $V$ 被给定时，计算步骤如下：\n1.  使用关系式 $E_{3} = V/h$ 计算均匀电场 $E_{3}$。\n2.  将此 $E_{3}$ 代入本构方程以求得电位移 $D_{3}$：$D_{3} = d_{33} \\sigma_{3} + \\epsilon^T_{33} (V/h)$。\n3.  使用关系式 $Q = D_{3}A$ 计算电极总电荷 $Q$。\n4.  如果计算出的值满足本构关系，则系统被认为是一致的。根据这种构造方法，除非出现数值浮点错误，否则该关系应成立。数值检查确认 $|D_3 - (d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3})| \\le \\text{tolerance}$。\n\n**情况2：给定电荷（类型 \"Q\"）**\n当电极上的总自由电荷 $Q$ 被给定时，步骤如下：\n1.  根据关系式 $D_{3} = Q/A$ 计算均匀电位移 $D_{3}$。\n2.  重排本构方程以求解电场 $E_{3}$：\n    $$E_{3} = \\frac{D_{3} - d_{33} \\sigma_{3}}{\\epsilon^T_{33}}$$\n3.  使用 $V = E_{3}h$ 计算电极间的电势差 $V$。\n4.  与前一种情况一样，通过用计算值检查本构关系来确认一致性。\n\n**情况3：混合边界条件（类型 \"mixed\"）**\n在这种情况下，给定了顶部电极的电势 $V$，以及边界上指定的法向电位移 $D_{n}$。任务是检查一致性。\n1.  使用给定的电势 $V$，计算电场 $E_{3} = V/h$。\n2.  使用此 $E_3$，根据本构定律计算材料*应有*的电位移 $D_{3,\\text{computed}}$：$D_{3,\\text{computed}} = d_{33} \\sigma_{3} + \\epsilon^T_{33} E_{3}$。\n3.  一致性检查包括将计算出的位移 $D_{3,\\text{computed}}$ 与给定的边界位移 $D_{n}$ 进行比较。如果 $|D_{3,\\text{computed}} - D_{n}| \\le \\text{tolerance}$，则条件是一致的。\n4.  输出值 $[D_3, E_3, V, Q]$ 基于从给定电势 $V$ 导出的模型内部状态。因此，$D_3 = D_{3,\\text{computed}}$，$E_3 = V/h$，$V$ 是输入值，$Q = D_{3,\\text{computed}}A$。最后的布尔值表示一致性检查的结果。\n\n提供的测试用例将根据这些模型进行评估。将使用由 `numpy.isclose` 管理的数值容差进行所有浮点比较，以确保稳健性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electro-mechanical state of a piezoelectric cube under\n    various boundary conditions.\n    \"\"\"\n\n    # Common geometric and material parameters in SI units\n    h = 1.0  # meters\n    A = 1.0  # square meters\n    d33 = 4.0e-12  # Coulombs per Newton\n    epsT33 = 1.33e-8  # Farads per meter\n    sigma3 = 1.0e6  # Pascals\n\n    # Define the test suite\n    test_cases = [\n        # type, value\n        # Test case 1: prescribed voltage\n        (\"V\", 100.0),\n        # Test case 2: prescribed charge\n        (\"Q\", 3.0e-6),\n        # Test case 3: mixed, consistent\n        # Dn = d33 * sigma3 + epsT33 * (V/h)\n        # Dn = (4e-12 * 1e6) + (1.33e-8 * (50.0/1.0)) = 4e-6 + 0.665e-6 = 4.665e-6\n        (\"mixed\", (50.0, 4.665e-6)),\n        # Test case 4: mixed, inconsistent\n        (\"mixed\", (10.0, 5.0e-6)),\n        # Test case 5: edge case, zero voltage (short-circuit)\n        (\"V\", 0.0),\n        # Test case 6: edge case, zero charge (open-circuit)\n        (\"Q\", 0.0)\n    ]\n\n    results = []\n\n    for case_type, bc_value in test_cases:\n        D3, E3, V, Q, is_consistent = 0.0, 0.0, 0.0, 0.0, False\n\n        if case_type == \"V\":\n            V = bc_value\n            E3 = V / h\n            D3 = d33 * sigma3 + epsT33 * E3\n            Q = D3 * A\n            # Consistency is by construction, check numerically\n            is_consistent = np.isclose(D3, d33 * sigma3 + epsT33 * E3)\n\n        elif case_type == \"Q\":\n            Q = bc_value\n            D3 = Q / A\n            # Check if epsT33 is non-zero to avoid division by zero\n            if epsT33 != 0:\n                E3 = (D3 - d33 * sigma3) / epsT33\n            else:\n                # If epsT33 is zero, E3 is undefined unless D3 = d33 * sigma3\n                # This is an unlikely physical scenario but handled for robustness\n                E3 = np.inf if not np.isclose(D3, d33 * sigma3) else 0.0\n\n            V = E3 * h\n            # Consistency is by construction, check numerically\n            is_consistent = np.isclose(D3, d33 * sigma3 + epsT33 * E3)\n\n        elif case_type == \"mixed\":\n            V_given, Dn_given = bc_value\n            V = V_given\n            \n            # Compute model-derived values based on V_given\n            E3 = V / h\n            D3_computed = d33 * sigma3 + epsT33 * E3\n            Q = D3_computed * A\n            D3 = D3_computed\n\n            # Check consistency against the provided Dn_given\n            is_consistent = np.isclose(D3_computed, Dn_given)\n\n        results.append([D3, E3, V, Q, is_consistent])\n\n    # Helper function to format a list into the \"[item1,item2,...]\" string format\n    def format_list_as_string(lst):\n        # Python's bool `True` / `False` string representation is correct.\n        # Floats are also represented correctly.\n        return f\"[{','.join(map(str, lst))}]\"\n\n    # Format the final output string as a list of lists\n    output_str = f\"[{','.join([format_list_as_string(r) for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3522419"}]}