{"hands_on_practices": [{"introduction": "现代电子和能源系统通常由多个材料层构成，每一层都具有独特的电学和热学特性。理解热量如何在这些层之间产生和分布，对于热管理和设备可靠性至关重要。本练习 [@problem_id:3505292] 要求您对一个直流电流下的双层各向异性叠层进行建模，计算总焦耳热如何在不同导电率的层之间分配。这项实践能让您深入理解材料选择和几何结构如何决定异质结构中“热点”的位置。", "problem": "一个两层平面堆叠占据了 $0 \\le z \\le t_{1}+t_{2}$ 的区域，其在 $x$-$y$ 平面内的横截面积为 $A$。第 1 层占据 $0 \\le z \\le t_{1}$，第 2 层占据 $t_{1} \\le z \\le t_{1}+t_{2}$。每一层都是电学和热学各向异性的均匀材料，其主轴与坐标轴对齐。第 $i$ 层（$i \\in \\{1,2\\}$）的电导率张量为 $\\boldsymbol{\\sigma}_{i}=\\mathrm{diag}(\\sigma_{\\parallel,i},\\sigma_{\\parallel,i},\\sigma_{\\perp,i})$，热导率张量为 $\\mathbf{K}_{i}=\\mathrm{diag}(k_{\\parallel,i},k_{\\parallel,i},k_{\\perp,i})$。该堆叠在 $z=0$ 和 $z=t_{1}+t_{2}$ 处与理想导电电极接触。一个总大小为 $I$ 的稳恒直流电（DC）从 $z=0$ 处的顶部电极均匀注入，并在 $z=t_{1}+t_{2}$ 处的底部电极收集。横向的热量和电荷传输可以忽略不计，因此沿 $z$ 轴的一维描述是适用的。侧面是绝热和电绝缘的。\n\n仅从电荷守恒定律 $\\nabla \\cdot \\mathbf{J}=0$、欧姆定律 $\\mathbf{J}=\\boldsymbol{\\sigma}\\,\\mathbf{E}$、静电关系 $\\mathbf{E}=-\\nabla \\phi$ 以及除焦耳热外无其他体源的稳态热能平衡方程 $\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$（其中 $q$ 为体焦耳热密度）出发，完成以下任务：\n\n1. 为该堆叠推导一个一维电-热耦合模型。您的模型必须包含每层中电势 $\\phi(z)$ 和温度 $T(z)$ 的常微分方程，以及物理上一致的界面和边界条件，这些条件需用层的属性 $\\sigma_{\\perp,i}$ 和 $k_{\\perp,i}$、施加的电流 $I$ 以及横截面积 $A$ 来表示。\n\n2. 在施加电流 $I$ 的条件下，求出每层中电场分量 $E_{z}$ 和体焦耳热密度 $q$ 的表达式，用 $I$、$A$ 和跨平面电导率 $\\sigma_{\\perp,i}$ 表示。\n\n3. 对于以下具体参数值\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$，$t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$，\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$，$\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$，\n- $k_{\\perp,1}=5.0\\,\\mathrm{W/(m\\cdot K)}$，$k_{\\perp,2}=1.0\\,\\mathrm{W/(m\\cdot K)}$，\n- $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$I=5.00\\,\\mathrm{A}$，\n计算在第 1 层内产生的焦耳热占总焦耳热生成量的无量纲分数，该分数定义为第 1 层中产生的焦耳功率与两层中产生的总焦耳功率之比。将您的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **几何结构**：一个位于 $0 \\le z \\le t_{1}+t_{2}$ 区域的两层平面堆叠。\n- 第 1 层：占据 $0 \\le z \\le t_{1}$。\n- 第 2 层：占据 $t_{1} \\le z \\le t_{1}+t_{2}$。\n- 横截面积：$A$。\n- **材料属性**：每层 $i \\in \\{1,2\\}$ 都是均匀且各向异性的。\n- 电导率张量：$\\boldsymbol{\\sigma}_{i}=\\mathrm{diag}(\\sigma_{\\parallel,i},\\sigma_{\\parallel,i},\\sigma_{\\perp,i})$。\n- 热导率张量：$\\mathbf{K}_{i}=\\mathrm{diag}(k_{\\parallel,i},k_{\\parallel,i},k_{\\perp,i})$。\n- **边界/驱动条件**：\n- 在 $z=0$ 和 $z=t_{1}+t_{2}$ 处有理想导电电极。\n- 一个总大小为 $I$ 的稳恒直流电（DC）在 $z=0$ 处均匀注入，并在 $z=t_{1}+t_{2}$ 处收集。\n- 侧面是绝热和电绝缘的。\n- **简化假设**：横向的热量和电荷传输可忽略不计，这使得沿 $z$ 轴的一维（$1$D）描述是合理的。\n- **控制方程**：\n- 电荷守恒：$\\nabla \\cdot \\mathbf{J}=0$。\n- 欧姆定律：$\\mathbf{J}=\\boldsymbol{\\sigma}\\,\\mathbf{E}$。\n- 静电关系：$\\mathbf{E}=-\\nabla \\phi$。\n- 稳态热能平衡：$\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$，其中 $q$ 是体焦耳热密度。\n- **第 3 部分的数值**：\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$，$t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$，$\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$\n- $k_{\\perp,1}=5.0\\,\\mathrm{W/(m\\cdot K)}$，$k_{\\perp,2}=1.0\\,\\mathrm{W/(m\\cdot K)}$\n- $A=1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$I=5.00\\,\\mathrm{A}$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学性**：该问题基于静电学（欧姆定律、电荷守恒）和传热学（傅里叶定律、含焦耳热的能量平衡）的基本且公认的原理。这是一个耦合多物理场中的标准问题。该设置在物理上是现实的。\n- **适定性**：该问题是适定的。几何结构、材料属性和边界/驱动条件都已明确，可以推导出电场、电流密度和热生成的唯一解。尽管在 $z=0$ 和 $z=t_1+t_2$ 处的热边界条件没有数值上指定，但第 1 部分仅要求建立具有一般边界条件的模型，而第 3 部分要求计算热生成比率，该比率与这些边界条件无关。\n- **客观性**：问题以清晰、客观和定量的语言陈述。没有主观或模糊的术语。\n- 该问题是自洽的、一致的，并且不违反任何无效性标准。所提供的数据在量纲上和物理上都是一致的。一维传输的假设已明确说明并证明其合理性。\n\n**步骤 3：结论与行动**\n\n该问题是**有效**的。将提供解答。\n\n***\n\n### 解答\n\n**1. 一维电-热耦合模型的推导**\n\n问题陈述指出，沿 $z$ 轴的一维描述是适用的。这意味着所有场和势仅随 $z$ 变化。电势为 $\\phi(z)$，温度为 $T(z)$，电场为 $\\mathbf{E} = E_z(z)\\hat{\\mathbf{z}}$，电流密度为 $\\mathbf{J} = J_z(z)\\hat{\\mathbf{z}}$。梯度算子简化为 $\\nabla = \\hat{\\mathbf{z}}\\frac{d}{dz}$。\n\n**电学模型：**\n电荷守恒定律为 $\\nabla \\cdot \\mathbf{J} = 0$。在一维情况下，这变为 $\\frac{dJ_z}{dz}=0$。这意味着电流密度 $J_z$ 在整个堆叠中是恒定的。\n总电流 $I$ 被指定为在面积 $A$ 上均匀注入。假设电流沿 $z$ 轴正方向流动（从 $z=0$ 到 $z=t_1+t_2$），则电流密度为 $J_z = I/A$。\n\n将欧姆定律 $\\mathbf{J}=\\boldsymbol{\\sigma}\\mathbf{E}$ 和静电关系 $\\mathbf{E} = -\\nabla\\phi$ 结合起来。对于一维模型中的各向异性材料，只有跨平面分量是相关的。在第 $i$ 层（$i \\in \\{1, 2\\}$）中：\n$$J_z = \\sigma_{\\perp,i} E_{z,i} = -\\sigma_{\\perp,i} \\frac{d\\phi_i}{dz}$$\n由于 $J_z$ 是恒定的，并且 $\\sigma_{\\perp,i}$ 在每层内部是恒定的，我们有：\n$$\\frac{d\\phi_i}{dz} = -\\frac{J_z}{\\sigma_{\\perp,i}} = -\\frac{I}{A\\sigma_{\\perp,i}}$$\n这是关于 $\\phi_i(z)$ 的一阶常微分方程。对 $z$ 求导，得到每层中电势的二阶常微分方程：\n$$\\frac{d^2\\phi_i}{dz^2} = 0$$\n\n**热学模型：**\n稳态热能平衡方程为 $\\nabla \\cdot (\\mathbf{K}\\,\\nabla T)+q=0$。在一维情况下，沿 $z$ 轴的热通量为 $q_{h,z} = -k_{\\perp}(z) \\frac{dT}{dz}$。能量平衡方程变为：\n$$\\frac{d}{dz}\\left(-k_{\\perp}(z)\\frac{dT}{dz}\\right) + q(z) = 0$$\n在每层 $i$ 内部，$k_{\\perp,i}$ 是恒定的，因此方程为：\n$$-k_{\\perp,i}\\frac{d^2T_i}{dz^2} + q_i = 0$$\n体焦耳热密度 $q$ 由 $q=\\mathbf{J}\\cdot\\mathbf{E} = J_z E_z$ 给出。使用 $E_z=J_z/\\sigma_{\\perp}$，我们发现 $q$ 在每层内部也是恒定的：\n$$q_i = \\frac{J_z^2}{\\sigma_{\\perp,i}} = \\frac{I^2}{A^2\\sigma_{\\perp,i}}$$\n因此，第 $i$ 层中温度的常微分方程为：\n$$\\frac{d^2T_i}{dz^2} = -\\frac{q_i}{k_{\\perp,i}} = -\\frac{I^2}{A^2\\sigma_{\\perp,i}k_{\\perp,i}}$$\n\n**界面和边界条件：**\n- **$z=t_1$ 处的界面**：\n  - 电势连续性：$\\phi_1(t_1) = \\phi_2(t_1)$。\n  - 法向电流密度连续性：$J_{z,1}(t_1) = J_{z,2}(t_1)$，这已由 $J_z=\\text{constant}$ 满足。这等效于 $-\\sigma_{\\perp,1}\\frac{d\\phi_1}{dz}\\big|_{z=t_1} = -\\sigma_{\\perp,2}\\frac{d\\phi_2}{dz}\\big|_{z=t_1}$。\n  - 温度连续性：$T_1(t_1) = T_2(t_1)$。\n  - 法向热通量连续性：$-k_{\\perp,1}\\frac{dT_1}{dz}\\big|_{z=t_1} = -k_{\\perp,2}\\frac{dT_2}{dz}\\big|_{z=t_1}$。\n\n- **边界条件**：\n  - 电学：问题是电流驱动的。恒定电流密度为 $J_z = I/A$。为了找到唯一的电势分布，我们可以设置一个参考电势，例如 $\\phi_2(t_1+t_2) = 0$。\n  - 热学：问题没有指明在外部边界 $z=0$ 和 $z=t_1+t_2$ 处的热学条件。一般的狄利克雷边界条件将是 $T_1(0) = T_A$ 和 $T_2(t_1+t_2) = T_B$，其中 $T_A$ 和 $T_B$ 是给定的温度。\n\n**2. 每层中 $E_z$ 和 $q$ 的表达式**\n\n根据第 1 部分的分析，电流密度 $J_z$ 在整个堆叠中是恒定的，等于 $I/A$。\n第 $i$ 层中的电场分量 $E_{z,i}$ 可从欧姆定律 $J_z = \\sigma_{\\perp,i} E_{z,i}$ 获得。\n$$E_{z,i} = \\frac{J_z}{\\sigma_{\\perp,i}} = \\frac{I}{A\\sigma_{\\perp,i}}$$\n第 $i$ 层中的体焦耳热密度 $q_i$ 为 $q_i = J_z E_{z,i}$。\n$$q_i = J_z \\left(\\frac{I}{A\\sigma_{\\perp,i}}\\right) = \\frac{I}{A} \\left(\\frac{I}{A\\sigma_{\\perp,i}}\\right) = \\frac{I^2}{A^2\\sigma_{\\perp,i}}$$\n这些表达式对 $i=1,2$ 均有效。\n\n**3. 无量纲热生成分数的计算**\n\n第 $i$ 层中产生的总焦耳功率 $P_i$ 是体热密度 $q_i$ 在该层体积 $V_i = A t_i$ 上的积分。由于 $q_i$ 在该层内是均匀的：\n$$P_i = q_i V_i = q_i A t_i$$\n代入第 2 部分中 $q_i$ 的表达式：\n$$P_i = \\left(\\frac{I^2}{A^2\\sigma_{\\perp,i}}\\right) A t_i = \\frac{I^2 t_i}{A\\sigma_{\\perp,i}}$$\n这等效于 $P_i = I^2 R_i$，其中 $R_i = t_i/(A\\sigma_{\\perp,i})$ 是第 $i$ 层的电阻。\n\n堆叠中产生的总焦耳功率为 $P_{total} = P_1 + P_2$。\n$$P_{total} = \\frac{I^2 t_1}{A\\sigma_{\\perp,1}} + \\frac{I^2 t_2}{A\\sigma_{\\perp,2}} = \\frac{I^2}{A} \\left( \\frac{t_1}{\\sigma_{\\perp,1}} + \\frac{t_2}{\\sigma_{\\perp,2}} \\right)$$\n\n在第 1 层内产生的焦耳热占总焦耳热生成量的无量纲分数，记为 $f_1$，是比率 $P_1/P_{total}$。\n$$f_1 = \\frac{P_1}{P_1 + P_2} = \\frac{\\frac{I^2 t_1}{A\\sigma_{\\perp,1}}}{\\frac{I^2 t_1}{A\\sigma_{\\perp,1}} + \\frac{I^2 t_2}{A\\sigma_{\\perp,2}}}$$\n公共因子 $I^2/A$ 可以消去：\n$$f_1 = \\frac{\\frac{t_1}{\\sigma_{\\perp,1}}}{\\frac{t_1}{\\sigma_{\\perp,1}} + \\frac{t_2}{\\sigma_{\\perp,2}}}$$\n现在，我们代入给定的数值：\n- $t_{1}=1.0\\times 10^{-5}\\,\\mathrm{m}$\n- $t_{2}=4.0\\times 10^{-5}\\,\\mathrm{m}$\n- $\\sigma_{\\perp,1}=1.0\\times 10^{5}\\,\\mathrm{S/m}$\n- $\\sigma_{\\perp,2}=2.5\\times 10^{4}\\,\\mathrm{S/m}$\n\n首先，计算 $f_1$ 表达式中的各项：\n第 1 层的项是：\n$$\\frac{t_1}{\\sigma_{\\perp,1}} = \\frac{1.0\\times 10^{-5}\\,\\mathrm{m}}{1.0\\times 10^{5}\\,\\mathrm{S/m}} = 1.0 \\times 10^{-10}\\,\\mathrm{\\Omega\\cdot m^2}$$\n第 2 层的项是：\n$$\\frac{t_2}{\\sigma_{\\perp,2}} = \\frac{4.0\\times 10^{-5}\\,\\mathrm{m}}{2.5\\times 10^{4}\\,\\mathrm{S/m}} = 1.6 \\times 10^{-9}\\,\\mathrm{\\Omega\\cdot m^2}$$\n现在，计算分数 $f_1$：\n$$f_1 = \\frac{1.0 \\times 10^{-10}}{1.0 \\times 10^{-10} + 1.6 \\times 10^{-9}} = \\frac{1.0 \\times 10^{-10}}{1.0 \\times 10^{-10} + 16.0 \\times 10^{-10}} = \\frac{1.0 \\times 10^{-10}}{17.0 \\times 10^{-10}} = \\frac{1}{17}$$\n换算成小数，结果是：\n$$f_1 = \\frac{1}{17} \\approx 0.058823529...$$\n四舍五入到四位有效数字，结果是 $0.05882$。", "answer": "$$\n\\boxed{0.05882}\n$$", "id": "3505292"}, {"introduction": "解析模型通常假设材料是完美且均匀的，但真实元器件会因制造过程而表现出空间差异。这个动手计算练习 [@problem_id:3505229] 直面这一现实，要求您确定电导率 $\\sigma(x)$ 连续变化的导体中的温度分布。您将从基本定律推导出控制微分方程，然后实施数值解法，从而架起理论物理与实际工程仿真之间的桥梁，以预测真实设备中的热行为。", "problem": "考虑一个一维模型，该模型描述了一块长度为 $L$ 的锂离子（Li-ion）电池集流体箔，其沿厚度方向与多孔电极粘合。我们只关注箔片内部由电焦耳热产生的热量，并忽略电极中的化学和对流效应。该箔片具有恒定的横截面积 $A$、恒定的热导率 $k$，以及由于制造差异而沿长度方向空间变化的电导率 $\\sigma(x)$。一个恒定的总电流 $I$ 沿 $x$ 方向从 $x=0$ 流向 $x=L$。两端保持在指定的温度，模拟两端的等温极耳。\n\n从以下基本原理出发：\n- 稳态下的电荷守恒（无累积），意味着一维电流密度的守恒，即 $dJ_x/dx = 0$。\n- 电流密度与电场之间的本构关系，$J_x = \\sigma(x)\\,E_x$，结合静电关系 $E_x = -d\\phi/dx$。\n- 焦耳热的定义，$\\dot{q}(x) = \\mathbf{J}\\cdot\\mathbf{E}$。\n- 恒定热导率下的一维稳态热传导方程，$-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right)=\\dot{q}(x)$。\n- Dirichlet 边界条件 $T(0)=T_{\\mathrm{left}}$ 和 $T(L)=T_{\\mathrm{right}}$。\n\n请仅使用上述基本定律和定义，从第一性原理出发，推导如何根据 $I$、$A$、$k$、$\\sigma(x)$ 和边界温度计算箔片内的温度场 $T(x)$ 和温度梯度 $dT/dx$，推导过程不得引用任何预先推导好的简化公式。\n\n您的程序必须实现一个数值方法，该方法适用于任意光滑的 $\\sigma(x)>0$，以计算每个指定测试用例的以下数值：\n- 箔片内的最高温度 $T_{\\max}$，单位为 $\\mathrm{K}$。\n- 最高温度的位置 $x_{\\max}$，单位为 $\\mathrm{m}$。\n- 左边界的温度梯度 $\\left.\\dfrac{dT}{dx}\\right|_{x=0}$，单位为 $\\mathrm{K/m}$。\n- 右边界的温度梯度 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$，单位为 $\\mathrm{K/m}$。\n\n所有输出必须以国际单位制（SI）表示。所有浮点数结果需四舍五入至六位小数。\n\n测试套件（四个案例），每个案例都给定了域长度 $L$、横截面积 $A$、电流 $I$、热导率 $k$、左右边界温度 $T_{\\mathrm{left}}$、$T_{\\mathrm{right}}$ 以及一个空间变化的电导率 $\\sigma(x)$。对于每个案例，请使用给定的参数和 $\\sigma(x)$ 的定义：\n\n- 案例 $1$（基准，近乎均匀的铜箔）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 10.0\\,\\mathrm{A}$，$k = 200.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0$，其中 $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$。\n\n- 案例 $2$（电导率的线性制造梯度）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 10.0\\,\\mathrm{A}$，$k = 200.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\alpha\\left(\\dfrac{2x}{L}-1\\right)\\right)$，其中 $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$ 且 $\\alpha=0.2$。\n\n- 案例 $3$（正弦变化的电导率和较低的热导率）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 15.0\\,\\mathrm{A}$，$k = 90.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\varepsilon \\sin\\left(\\dfrac{4\\pi x}{L}\\right)\\right)$，其中 $\\sigma_0 = 3.5\\times 10^{7}\\,\\mathrm{S/m}$ 且 $\\varepsilon=0.5$。\n\n- 案例 $4$（由高斯函数描述的局部电导率缺陷）：\n  - $L = 0.05\\,\\mathrm{m}$，$A = 8.0\\times 10^{-6}\\,\\mathrm{m^2}$，$I = 8.0\\,\\mathrm{A}$，$k = 235.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=298.15\\,\\mathrm{K}$，$T_{\\mathrm{right}}=298.15\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\dfrac{\\sigma_0}{1 + \\beta \\exp\\left(-\\dfrac{(x-x_0)^2}{2 w^2}\\right)}$，其中 $\\sigma_0 = 3.7\\times 10^{7}\\,\\mathrm{S/m}$，$\\beta=4.0$，$x_0 = \\dfrac{L}{2}$，且 $w = 0.05L$。\n\n您的算法应具有通用性，不依赖于 $\\sigma(x)$ 的任何闭式原函数。您可以假设 $\\sigma(x)$ 在 $[0,L]$ 上是严格为正且足够光滑的。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例生成自己的子列表，顺序为 $[T_{\\max}, x_{\\max}, (dT/dx)|_{x=0}, (dT/dx)|_{x=L}]$。例如，最终输出格式必须类似于 $[[v_{1,1},v_{1,2},v_{1,3},v_{1,4}],[v_{2,1},v_{2,2},v_{2,3},v_{2,4}],\\dots]$，所有值都四舍五入到六位小数。", "solution": "该问题要求推导一种计算一维箔片在焦耳热作用下温度分布 $T(x)$ 的方法，并对其进行数值实现。推导过程将从所提供的基本原理出发。\n\n### 第 1 部分：从第一性原理推导\n\n**1. 热源公式化**\n\n分析首先从建立由焦耳热引起的体积生热率 $\\dot{q}(x)$ 开始。\n- **电荷守恒：** 在稳态下，电流是守恒的。问题中表述为 $\\dfrac{dJ_x}{dx} = 0$，其中 $J_x$ 是 $x$ 方向的电流密度。这意味着 $J_x$ 沿箔片的长度方向是恒定的。\n- **电流密度和总电流：** 总电流 $I$ 通过关系式 $I = J_x A$ 与电流密度 $J_x$ 和恒定的横截面积 $A$ 相关联。因此，恒定的电流密度为 $J_x = \\dfrac{I}{A}$。\n- **电场：** 本构关系（欧姆定律）通过空间变化的电导率 $\\sigma(x)$ 将电流密度 $J_x$ 与电场 $E_x$ 联系起来：$J_x = \\sigma(x) E_x(x)$。代入恒定的 $J_x$，我们可以将电场表示为位置的函数：\n$$E_x(x) = \\dfrac{J_x}{\\sigma(x)} = \\dfrac{I}{A \\sigma(x)}$$\n- **焦耳热：** 体积生热率 $\\dot{q}(x)$ 定义为电流密度矢量与电场矢量的点积，即 $\\dot{q} = \\mathbf{J} \\cdot \\mathbf{E}$。在我们的以为情况下，这简化为 $\\dot{q}(x) = J_x E_x(x)$。代入 $J_x$ 和 $E_x(x)$ 的表达式：\n$$\\dot{q}(x) = \\left(\\dfrac{I}{A}\\right) \\left(\\dfrac{I}{A \\sigma(x)}\\right) = \\dfrac{I^2}{A^2 \\sigma(x)}$$\n这就是热传导方程的热源项。\n\n**2. 温度控制方程**\n\n具有恒定热导率 $k$ 和热源 $\\dot{q}(x)$ 的一维稳态热传导方程如下：\n$$-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right) = \\dot{q}(x)$$\n由于 $k$ 是常数，方程变为：\n$$-k \\dfrac{d^2T}{dx^2} = \\dot{q}(x)$$\n代入推导出的 $\\dot{q}(x)$ 表达式，我们得到关于温度场 $T(x)$ 的二阶常微分方程（ODE）：\n$$\\dfrac{d^2T}{dx^2} = -\\dfrac{I^2}{k A^2 \\sigma(x)}$$\n该方程受 Dirichlet 边界条件 $T(0) = T_{\\mathrm{left}}$ 和 $T(L) = T_{\\mathrm{right}}$ 的约束。为方便起见，我们定义一个源函数 $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$，因此 ODE 为 $\\dfrac{d^2T}{dx^2} = -S(x)$。\n\n**3. 通过积分求解通解**\n\n我们通过对 $x$ 进行两次积分来求解该 ODE。\n- **第一次积分：** 对 $\\dfrac{d^2T}{dx^2}$ 积分一次得到温度梯度 $\\dfrac{dT}{dx}$：\n$$\\dfrac{dT}{dx}(x) = \\int_{0}^{x} (-S(\\xi)) d\\xi + C_1 = C_1 - \\int_{0}^{x} S(\\xi) d\\xi$$\n此处，$C_1$ 是积分常数，它等于 $x=0$ 处的温度梯度，即 $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$。\n\n- **第二次积分：** 对 $\\dfrac{dT}{dx}(x)$ 积分得到温度场 $T(x)$：\n$$T(x) = \\int_{0}^{x} \\left( C_1 - \\int_{0}^{\\eta} S(\\xi) d\\xi \\right) d\\eta + C_2 = C_2 + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n常数 $C_2$ 由 $x=0$ 处的边界条件确定：$T(0) = C_2 = T_{\\mathrm{left}}$。因此：\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n\n- **确定积分常数 $C_1$：** 应用 $x=L$ 处的第二个边界条件来求解常数 $C_1$：\n$$T(L) = T_{\\mathrm{right}} = T_{\\mathrm{left}} + C_1 L - \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n求解 $C_1$：\n$$C_1 = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n这个二重积分可以通过分部积分法简化，得到 $\\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta = \\int_{0}^{L} (L-x) S(x) dx$。代入此式可得 $C_1$ 的单积分表达式：\n$$C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} (L-x) S(x) dx$$\n将 $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$ 代回：\n$$\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$$\n\n**4. 用于计算的最终表达式**\n\n确定了 $C_1$ 之后，我们就得到了所有必要的组成部分。\n- **边界处的温度梯度：**\n  - 在 $x=0$ 处：即为上面推导出的 $C_1$。\n  - 在 $x=L$ 处：我们计算在 $x=L$ 处的梯度表达式：\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = C_1 - \\int_{0}^{L} S(\\xi) d\\xi$$\n  代入 $C_1$ 的完整表达式并化简可得：\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{1}{L} \\int_{0}^{L} x S(x) dx = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{x}{\\sigma(x)} dx$$\n\n- **最高温度及其位置：**\n由于 $T''(x) = -S(x)  0$（因为 $\\sigma(x)>0$ 且所有其他参数均为正），温度分布 $T(x)$ 是一个严格的凹函数。其在区间 $[0,L]$ 上的最大值要么出现在 $\\dfrac{dT}{dx}=0$ 的内部点，要么出现在边界上。\n潜在的内部最大值点 $x_{\\max}$ 的位置可以通过将梯度设为零来找到：\n$$\\dfrac{dT}{dx}(x_{\\max}) = C_1 - \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = 0 \\implies \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = C_1$$\n这是一个关于 $x_{\\max}$ 的隐式方程。\n寻找位置 $x_{\\max}$ 和值 $T_{\\max}$ 的算法如下：\n1. 计算 $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$ 和 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$。\n2. 如果 $C_1 \\le 0$，函数是单调不增的。最大值在左边界：$x_{\\max}=0$，$T_{\\max}=T_{\\mathrm{left}}$。\n3. 如果 $\\left.\\dfrac{dT}{dx}\\right|_{x=L} \\ge 0$，函数是单调不减的。最大值在右边界：$x_{\\max}=L$，$T_{\\max}=T_{\\mathrm{right}}$。\n4. 如果 $C_1 > 0$ 且 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}  0$，则存在一个唯一的内部最大值。其位置 $x_{\\max}$ 是方程 $\\int_{0}^{x} S(\\xi) d\\xi - C_1 = 0$ 在区间 $(0,L)$ 内的根。\n5. 最高温度 $T_{\\max}$ 即为 $T(x_{\\max})$。$T(x)$ 的表达式可以写为：\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} (x-\\xi) S(\\xi) d\\xi$$\n$$T(x) = T_{\\mathrm{left}} + \\left(\\left.\\dfrac{dT}{dx}\\right|_{x=0}\\right) x - \\dfrac{I^2}{k A^2} \\int_{0}^{x} \\dfrac{x-\\xi}{\\sigma(\\xi)} d\\xi$$\n\n### 第 2 部分：数值算法设计\n\n推导出的解析表达式包含积分，对于任意的 $\\sigma(x)$，这些积分必须通过数值方法计算。算法流程如下：\n\n1.  **定义常数和函数：** 对每个测试用例，定义物理常数（$L, A, I, k, T_{\\mathrm{left}}, T_{\\mathrm{right}}$）和函数 $\\sigma(x)$。预先计算常数因子 $C_S = \\dfrac{I^2}{k A^2}$。\n\n2.  **计算边界梯度：**\n    - 使用数值积分方法（例如 `scipy.integrate.quad`）计算积分 $I_1 = \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$。\n    - 计算左边界的梯度：$\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{C_S}{L} I_1$。\n    - 使用数值积分方法计算积分 $I_2 = \\int_{0}^{L} \\dfrac{1}{\\sigma(x)} dx$。\n    - 计算右边界的梯度：$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\left.\\dfrac{dT}{dx}\\right|_{x=0} - C_S I_2$。\n\n3.  **寻找最高温度和位置：**\n    - 检查边界梯度的符号，以确定最大值是否如前所述位于端点。\n    - 如果存在内部最大值，则通过求解函数 $f(x) = \\left(\\int_{0}^{x} \\dfrac{1}{\\sigma(\\xi)} d\\xi \\right) - \\dfrac{1}{C_S} \\left.\\dfrac{dT}{dx}\\right|_{x=0} = 0$ 的根来求解 $x_{\\max}$。这可以使用数值求根算法（例如 `scipy.optimize.brentq`）在区间 $(0,L)$ 上完成。$f(x)$ 内的积分在每一步都通过数值积分计算。\n    - 找到 $x_{\\max}$ 后，使用 $T(x)$ 的公式计算 $T_{\\max} = T(x_{\\max})$。这需要通过数值积分计算最后一个积分 $I_3 = \\int_{0}^{x_{\\max}} \\dfrac{x_{\\max}-\\xi}{\\sigma(\\xi)} d\\xi$。\n\n4.  **输出格式化：** 整理计算出的四个值（$T_{\\max}, x_{\\max}, \\left.\\dfrac{dT}{dx}\\right|_{x=0}, \\left.\\dfrac{dT}{dx}\\right|_{x=L}$），将它们四舍五入到六位小数，并按规定格式化。对每个测试用例重复此过程。\n\n该方法具有通用性，依赖于稳健的数值库函数进行积分和求根，因此适用于任何光滑且严格为正的电导率函数 $\\sigma(x)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the electro-thermal problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: Baseline\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"],\n            \"sigma_params\": {\"sigma0\": 5.8e7}\n        },\n        # Case 2: Linear Gradient\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"alpha\"] * (2 * x / p[\"L\"] - 1)),\n            \"sigma_params\": {\"sigma0\": 5.8e7, \"alpha\": 0.2, \"L\": 0.1}\n        },\n        # Case 3: Sinusoidal Variability\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 15.0, \"k\": 90.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"epsilon\"] * np.sin(4 * np.pi * x / p[\"L\"])),\n            \"sigma_params\": {\"sigma0\": 3.5e7, \"epsilon\": 0.5, \"L\": 0.1}\n        },\n        # Case 4: Localized Defect\n        {\n            \"L\": 0.05, \"A\": 8.0e-6, \"I\": 8.0, \"k\": 235.0,\n            \"T_left\": 298.15, \"T_right\": 298.15,\n            \"sigma\": lambda x, p: p[\"sigma0\"] / (1 + p[\"beta\"] * np.exp(-(x - p[\"x0\"])**2 / (2 * p[\"w\"]**2))),\n            \"sigma_params\": {\n                \"sigma0\": 3.7e7, \"beta\": 4.0, \n                \"x0\": 0.05 / 2, \"w\": 0.05 * 0.05\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    str_cases = []\n    for case_res in all_results:\n        # Format each value to 6 decimal places\n        str_vals = [f\"{v:.6f}\" for v in case_res]\n        str_cases.append(f\"[{','.join(str_vals)}]\")\n    \n    print(f\"[{','.join(str_cases)}]\")\n\ndef process_case(params):\n    \"\"\"\n    Computes the required quantities for a single test case.\n    \"\"\"\n    L = params[\"L\"]\n    A = params[\"A\"]\n    I = params[\"I\"]\n    k = params[\"k\"]\n    T_left = params[\"T_left\"]\n    T_right = params[\"T_right\"]\n    \n    # Create a simple callable for sigma(x) for this case\n    sigma = lambda x: params[\"sigma\"](x, params[\"sigma_params\"])\n\n    # Constant factor for the source term S(x) = C_S / sigma(x)\n    C_S = I**2 / (k * A**2)\n\n    # Calculate grad_T_left (C1) = (T_right - T_left)/L + (C_S / L) * integral((L-x)/sigma(x), 0, L)\n    integrand_C1 = lambda x: (L - x) / sigma(x)\n    integral_val_C1, _ = quad(integrand_C1, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_left = (T_right - T_left) / L + (C_S / L) * integral_val_C1\n\n    # Calculate grad_T_right = grad_T_left - C_S * integral(1/sigma(x), 0, L)\n    integrand_grad_R = lambda x: 1 / sigma(x)\n    integral_val_grad_R, _ = quad(integrand_grad_R, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_right = grad_T_left - C_S * integral_val_grad_R\n    \n    # Determine the location and value of the maximum temperature\n    if grad_T_left = 0:\n        # Temperature is non-increasing, max is at the left boundary.\n        x_max = 0.0\n        T_max = T_left\n    elif grad_T_right = 0:\n        # Temperature is non-decreasing, max is at the right boundary.\n        x_max = L\n        T_max = T_right\n    else:\n        # An interior maximum exists. Find its location x_max by solving a root problem.\n        # We need to find x where integral(S(xi), 0, x) = grad_T_left.\n        # This is equivalent to finding the root of:\n        # integral(1/sigma(xi), 0, x) - grad_T_left / C_S = 0\n        target_integral_val = grad_T_left / C_S\n        \n        def root_func(x):\n            val, _ = quad(lambda xi: 1 / sigma(xi), 0, x, epsabs=1e-12, epsrel=1e-12)\n            return val - target_integral_val\n\n        # Find the root x_max in the interval (0, L).\n        # brentq is a robust choice as we have a bracketed root.\n        x_max = brentq(root_func, 0, L)\n\n        # Calculate T_max = T(x_max) using the derived formula:\n        # T(x) = T_left + grad_T_left * x - C_S * integral((x-xi)/sigma(xi), 0, x)\n        integrand_T_max = lambda xi: (x_max - xi) / sigma(xi)\n        integral_val_T, _ = quad(integrand_T_max, 0, x_max, epsabs=1e-12, epsrel=1e-12)\n        T_max = T_left + grad_T_left * x_max - C_S * integral_val_T\n\n    return [T_max, x_max, grad_T_left, grad_T_right]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3505229"}]}