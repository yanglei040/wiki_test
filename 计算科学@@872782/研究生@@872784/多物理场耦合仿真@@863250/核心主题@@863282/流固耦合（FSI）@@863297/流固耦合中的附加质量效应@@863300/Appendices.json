{"hands_on_practices": [{"introduction": "要真正掌握附加质量效应，第一步是理解它如何改变结构的基本动态特性。本练习将从最简单的单自由度系统入手，推导附加质量如何降低系统的固有频率。然后，我们将探讨在更复杂的多自由度系统中，附加质量（尤其是非对角的附加质量矩阵）如何改变振型和模态参与因子，并通过一个具体的计算案例来巩固这些概念 [@problem_id:3527967]。", "problem": "一个执行一维运动的刚性结构浸没在不可压缩、无粘性的流体中，流体施加的惯性反作用力可以用附加质量来表示。考虑两种情况。\n\n(a) 单自由度情况：一个结构质量为 $m_{s}$ 的质点与刚度为 $k$ 的线性弹簧相连，在静止流体中以位移 $x(t)$ 运动。流体动力反作用被建模为乘以结构加速度的附加质量 $m_{a}$。从牛顿第二定律和线性弹性力的定义出发，推导无阻尼自由振动运动方程，并求出自振频率作为 $m_{s}$、$m_{a}$ 和 $k$ 的函数。\n\n(b) 多自由度情况：两个结构质量分别为 $m_{1}$ 和 $m_{2}$ 的共线质点通过线性弹簧连接，其中第一个质点通过刚度为 $k_{1}$ 的弹簧连接到地面，两个质点之间通过刚度为 $k_{2}$ 的弹簧连接。该系统在不可压缩、无粘性的流体中进行小振幅运动。流体诱导的惯性由一个对称的附加质量矩阵表示。利用每个自由度的牛顿第二定律并组合成无阻尼自由振动方程，定性解释非比例附加质量矩阵的存在如何相对于真空中的系统改变其振型和振型参与因子。\n\n然后，对于以下具体参数值：\n- $m_{1} = 10\\,\\mathrm{kg}$，$m_{2} = 10\\,\\mathrm{kg}$，\n- $k_{1} = 4000\\,\\mathrm{N/m}$，$k_{2} = 2000\\,\\mathrm{N/m}$，\n- 附加质量矩阵 $M_{a}$ 的元素为 $m_{a,11} = 5\\,\\mathrm{kg}$、$m_{a,22} = 5\\,\\mathrm{kg}$ 和 $m_{a,12} = m_{a,21} = 2\\,\\mathrm{kg}$，\n\n通过寻求非平凡谐波解，计算该流固耦合系统的最低自振频率，单位为弧度/秒。将您的答案四舍五入到四位有效数字，并以弧度/秒表示该频率。", "solution": "该问题经核实具有科学依据、适定、客观且完整。它对单自由度（SDOF）和多自由度（MDOF）系统中附加质量效应进行了标准分析。所有提供的参数在物理上都是现实的，并且量纲一致。\n\n**部分(a)：单自由度系统**\n\n我们考虑一个质量为 $m_s$ 的质点附着在一个刚度为 $k$ 的弹簧上。该质点的位移为 $x(t)$。该系统浸没在静止、不可压缩且无粘性的流体中。\n\n根据牛顿第二定律，作用在质点上的外力之和等于其质量乘以其加速度。\n$$ \\sum F_{\\text{ext}} = m_s \\ddot{x}(t) $$\n外力包括弹簧恢复力 $F_k$ 和来自流体的流体动力 $F_f$。\n\n弹簧力由胡克定律给出：\n$$ F_k = -k x(t) $$\n\n问题陈述，流体动力反作用被建模为一个附加质量 $m_a$，该质量乘以结构加速度 $\\ddot{x}(t)$。此力与物体相对于静止流体的加速度方向相反。因此，流体施加在结构上的力为：\n$$ F_f = -m_a \\ddot{x}(t) $$\n\n将外力代入牛顿第二定律：\n$$ F_k + F_f = m_s \\ddot{x}(t) $$\n$$ -k x(t) - m_a \\ddot{x}(t) = m_s \\ddot{x}(t) $$\n\n整理各项，形成标准的自由振动运动方程：\n$$ m_s \\ddot{x}(t) + m_a \\ddot{x}(t) + k x(t) = 0 $$\n$$ (m_s + m_a) \\ddot{x}(t) + k x(t) = 0 $$\n\n这是无阻尼单自由度系统的运动方程。其形式为 $M_{\\text{eff}} \\ddot{x} + K_{\\text{eff}} x = 0$，其中有效质量为 $M_{\\text{eff}} = m_s + m_a$，有效刚度为 $K_{\\text{eff}} = k$。这样一个系统的自振频率 $\\omega_n$ 由下式给出：\n$$ \\omega_n = \\sqrt{\\frac{K_{\\text{eff}}}{M_{\\text{eff}}}} $$\n代入有效质量和有效刚度的表达式，我们得到流固耦合系统的自振频率：\n$$ \\omega_n = \\sqrt{\\frac{k}{m_s + m_a}} $$\n\n**部分(b)：多自由度系统 - 定性解释**\n\n对于多自由度系统，其无阻尼自由振动的矩阵形式运动方程为：\n$$ M \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\n其中 $\\mathbf{x} = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ 是位移向量，$M$ 是质量矩阵，$K$ 是刚度矩阵。\n\n对于真空中的系统，质量矩阵 $M_s$ 是对角的，仅包含结构质量：\n$$ M_s = \\begin{pmatrix} m_1  0 \\\\ 0  m_2 \\end{pmatrix} $$\n刚度矩阵 $K$ 由弹簧中的力导出。作用在质量1上的力是 $-k_1 x_1 + k_2(x_2-x_1)$，作用在质量2上的力是 $-k_2(x_2-x_1)$。这得到：\n$$ K = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} $$\n真空中的运动方程是 $M_s \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$。振型是广义特征值问题 $(K - \\omega^2 M_s) \\mathbf{\\phi} = \\mathbf{0}$ 的特征向量。\n\n当系统浸没在流体中时，总质量矩阵变成结构质量矩阵 $M_s$ 和附加质量矩阵 $M_a$ 的和：\n$$ M_{\\text{total}} = M_s + M_a $$\n附加质量矩阵 $M_a$ 被设定为对称且非对角的：\n$$ M_a = \\begin{pmatrix} m_{a,11}  m_{a,12} \\\\ m_{a,21}  m_{a,22} \\end{pmatrix}, \\quad m_{a,12} = m_{a,21} \\neq 0 $$\n耦合系统的运动方程为：\n$$ (M_s + M_a) \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} \\quad \\implies \\quad M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\n由于非对角项 $m_{a,12}$ 和 $m_{a,21}$ 的存在，总质量矩阵 $M_{\\text{total}}$ 是非对角的。这些项代表流体动力（惯性）耦合：质量1的加速度会在质量2上引起一个惯性流体力，反之亦然。\n\n非比例附加质量矩阵的存在对系统模态特性的影响如下：\n1.  **振型**：耦合系统的振型是修正后的特征值问题 $(K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0}$ 的特征向量。由于总质量矩阵 $M_{\\text{total}}$ 与结构质量矩阵 $M_s$ 不成比例（即对于任何标量 $c$，$M_{\\text{total}} \\neq c M_s$），耦合系统的特征向量将不同于真空系统的特征向量（振型）。惯性耦合从根本上改变了自由度之间的动力学关系，导致了不同的振动特征模式。新的振型关于 $M_{\\text{total}}$ 和 $K$ 都是正交的，但通常不关于原始结构质量矩阵 $M_s$ 正交。\n\n2.  **振型参与因子**：振型参与因子 $\\Gamma_i$ 量化了在给定的外部载荷模式下，每个振型对系统响应的贡献程度。对于载荷向量 $\\mathbf{f}(t) = \\mathbf{p} f(t)$，第 $i$ 个振型的参与因子为 $\\Gamma_i = \\mathbf{\\phi}_i^T M \\mathbf{p} / (\\mathbf{\\phi}_i^T M \\mathbf{\\phi}_i)$。振型 $\\mathbf{\\phi}_i$ 和质量矩阵 $M$（从 $M_s$ 变为 $M_{\\text{total}}$）都因流体而改变。因此，振型参与因子将会改变。流体动力耦合重新分配了系统的有效惯性，这进而改变了每个振型参与外部载荷响应的方式。\n\n**部分(c)：多自由度系统 - 数值计算**\n\n我们得到以下参数值：\n$m_1 = 10\\,\\mathrm{kg}$，$m_2 = 10\\,\\mathrm{kg}$\n$k_1 = 4000\\,\\mathrm{N/m}$，$k_2 = 2000\\,\\mathrm{N/m}$\n$M_a = \\begin{pmatrix} 5  2 \\\\ 2  5 \\end{pmatrix}\\,\\mathrm{kg}$\n\n首先，我们建立结构质量矩阵、总质量矩阵和刚度矩阵。\n结构质量矩阵为：\n$$ M_s = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix}\\,\\mathrm{kg} $$\n总质量矩阵为：\n$$ M_{\\text{total}} = M_s + M_a = \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix} + \\begin{pmatrix} 5  2 \\\\ 2  5 \\end{pmatrix} = \\begin{pmatrix} 15  2 \\\\ 2  15 \\end{pmatrix}\\,\\mathrm{kg} $$\n刚度矩阵为：\n$$ K = \\begin{pmatrix} k_1+k_2  -k_2 \\\\ -k_2  k_2 \\end{pmatrix} = \\begin{pmatrix} 4000+2000  -2000 \\\\ -2000  2000 \\end{pmatrix} = \\begin{pmatrix} 6000  -2000 \\\\ -2000  2000 \\end{pmatrix}\\,\\mathrm{N/m} $$\n\n为了求出自振频率，我们寻求形如 $\\mathbf{x}(t) = \\mathbf{\\phi} e^{i\\omega t}$ 的非平凡谐波解。将其代入运动方程 $M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$，得到广义特征值问题：\n$$ (K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0} $$\n这要求系数矩阵的行列式为零。令 $\\lambda = \\omega^2$。\n$$ \\det(K - \\lambda M_{\\text{total}}) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 6000  -2000 \\\\ -2000  2000 \\end{pmatrix} - \\lambda \\begin{pmatrix} 15  2 \\\\ 2  15 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 6000 - 15\\lambda  -2000 - 2\\lambda \\\\ -2000 - 2\\lambda  2000 - 15\\lambda \\end{pmatrix} = 0 $$\n展开行列式，得到特征方程：\n$$ (6000 - 15\\lambda)(2000 - 15\\lambda) - (-2000 - 2\\lambda)^2 = 0 $$\n$$ (12 \\times 10^6 - 90000\\lambda - 30000\\lambda + 225\\lambda^2) - (4 \\times 10^6 + 8000\\lambda + 4\\lambda^2) = 0 $$\n$$ 225\\lambda^2 - 120000\\lambda + 12 \\times 10^6 - 4\\lambda^2 - 8000\\lambda - 4 \\times 10^6 = 0 $$\n合并各项，我们得到一个关于 $\\lambda$ 的二次方程：\n$$ 221\\lambda^2 - 128000\\lambda + 8 \\times 10^6 = 0 $$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\lambda$：\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{(-128000)^2 - 4(221)(8 \\times 10^6)}}{2(221)} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{16.384 \\times 10^9 - 7.072 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{9.312 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm 96498.7046...}{442} $$\n两个特征值 $\\lambda = \\omega^2$ 分别是：\n$$ \\lambda_1 = \\frac{128000 - 96498.7046...}{442} \\approx 71.2699... \\ (\\text{rad/s})^2 $$\n$$ \\lambda_2 = \\frac{128000 + 96498.7046...}{442} \\approx 507.9156... \\ (\\text{rad/s})^2 $$\n最低自振频率对应于较小的特征值 $\\lambda_1$。\n$$ \\omega_{lowest} = \\sqrt{\\lambda_1} \\approx \\sqrt{71.2699...} \\approx 8.442150... \\ \\text{rad/s} $$\n将结果四舍五入到四位有效数字，得到：\n$$ \\omega_{lowest} \\approx 8.442 \\ \\text{rad/s} $$", "answer": "$$ \\boxed{8.442} $$", "id": "3527967"}, {"introduction": "在理解了附加质量效应的物理后果之后，下一步的关键技能是量化其重要性，并了解其对数值模拟的实际影响。这个编程练习将指导你通过参数化研究，根据流固密度比来划分不同的流固耦合（FSI）区域 [@problem_id:3527931]。你将学习如何将这些物理区域与数值模拟中的关键决策（如耦合策略和时间步长选择）直接联系起来。", "problem": "考虑一个浸没在无粘、不可压缩流场中的单自由度线性结构振子，其代表了用于评估附加质量效应的典型流固耦合 (FSI) (Fluid-Structure Interaction) 场景。该结构被建模为一个连接到线性弹簧的刚性质量块，垂直于流体方向运动，而流体的特性仅由其附加质量来表征。设结构质量为 $m_s = \\rho_s V$，流体附加质量为 $m_a = C_a \\rho_f V$，其中 $\\rho_s$ 是结构密度，$\\rho_f$ 是流体密度，$V$ 是特征排开体积，$C_a$ 是由几何形状决定的无量纲附加质量系数。有效质量为 $m_{\\text{eff}} = m_s + m_a$。线性弹簧的刚度为 $k$。假设结构阻尼为零。\n\n从牛顿第二定律和有效惯性的定义出发，您的任务是推导、实现并评估一个关于密度比 $\\beta = \\rho_s/\\rho_f$ 的参数化研究，以识别附加质量可忽略、与结构惯性相当或远大于结构惯性的不同区间，并为多物理场求解器中的数值耦合策略提取其意义。\n\n使用以下基本建模假设和要求：\n- 基本依据：牛顿第二定律、线性振子动力学和附加质量的定义。流体的贡献纯粹是惯性的：$m_a = C_a \\rho_f V$。\n- 干固有频率：$\\omega_{\\text{dry}} = \\sqrt{k/m_s}$。\n- 湿（耦合）固有频率：$\\omega = \\sqrt{k/(m_s + m_a)}$。\n- 质量比：$r = m_a/m_s = C_a/\\beta$。\n- 频率比：$\\omega/\\omega_{\\text{dry}} = \\sqrt{m_s/(m_s + m_a)} = 1/\\sqrt{1 + r}$。\n\n使用有原则的、定量的标准定义区间分类：\n- 附加质量可忽略（代码 $0$）：相对频率降低很小，即 $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$，其中 $\\varepsilon_{\\text{negl}} = 0.05$。证明这对应于 $r \\le r_{\\text{negl}}$，其中 $r_{\\text{negl}} = \\dfrac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$。\n- 附加质量占主导（代码 $2$）：附加质量至少比结构质量大一个数量级，即 $r \\ge \\tau_{\\text{dom}}$，其中 $\\tau_{\\text{dom}} = 10$。\n- 附加质量相当（代码 $1$）：中间区间 $r_{\\text{negl}}  r  \\tau_{\\text{dom}}$。\n\n数值耦合的意义（需计算并以布尔值报告）：定义流体惯性分数 $\\gamma = \\dfrac{m_a}{m_s + m_a} = \\dfrac{r}{1 + r}$。如果 $\\gamma \\ge \\gamma_{\\text{crit}}$（其中 $\\gamma_{\\text{crit}} = 0.3$），则推荐使用强（隐式）耦合。否则，弱（显式）耦合可能是可接受的。对于每个测试用例，必须计算此标准并以布尔值报告。\n\n此外，计算线性振子的显式中心差分稳定性时间步长限制，\n$$\\Delta t_{\\text{crit}} = \\dfrac{2}{\\omega},$$\n并以秒为单位报告。\n\n对所有用例使用以下固定参数：\n- 刚度 $k = 1.0 \\times 10^5\\,\\mathrm{N/m}$，\n- 体积 $V = 1.0\\,\\mathrm{m^3}$。\n\n测试套件：\n对于每个测试用例，输入为 $(\\rho_s,\\ \\rho_f,\\ C_a)$，单位分别为 $\\mathrm{kg/m^3}$ 和无量纲。\n\n- 用例 $1$：$(10.0,\\ 1000.0,\\ 1.0)$。\n- 用例 $2$：$(1000.0,\\ 1000.0,\\ 1.0)$。\n- 用例 $3$：$(10000.0,\\ 1000.0,\\ 1.0)$，对应于 $r = 0.1$。\n- 用例 $4$：$(8333.333333333333,\\ 1000.0,\\ 1.0)$，对应于 $r = 0.12$。\n- 用例 $5$：$(111.11111111111111,\\ 1000.0,\\ 1.0)$，对应于 $r = 9.0$。\n- 用例 $6$：$(50.0,\\ 1000.0,\\ 0.5)$，对应于 $r = 10.0$。\n- 用例 $7$：$(8000.0,\\ 1000.0,\\ 2.0)$，对应于 $r = 0.25$。\n\n对于每个测试用例，您的程序必须输出一个包含四个条目的列表：\n- 区间代码（整数）：$0$（可忽略）、$1$（相当）或 $2$（主导）。\n- 频率比 $\\omega/\\omega_{\\text{dry}}$（浮点数）。\n- 基于 $\\gamma \\ge \\gamma_{\\text{crit}}$ 的强耦合建议（布尔值）。\n- 临界显式时间步长 $\\Delta t_{\\text{crit}}$（以秒为单位的浮点数）。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含所有七个用例的结果，格式为一个由方括号括起来的逗号分隔列表。每个元素本身必须是对应测试用例的四个值的列表，顺序如上所述。例如：\n$[\\,[\\text{code}_1,\\ \\text{fr}_1,\\ \\text{bool}_1,\\ \\Delta t_1],\\ [\\text{code}_2,\\ \\text{fr}_2,\\ \\text{bool}_2,\\ \\Delta t_2],\\ \\ldots\\,]$。", "solution": "问题陈述经评估是有效的。它在科学上基于经典力学和流体动力学的原理，特别是线性振子建模和流固耦合 (FSI) 中的附加质量效应。该问题是适定的，所有必要的参数、定义和标准都已明确说明，确保可以确定一个唯一且有意义的解。其设定是自洽且逻辑一致的。\n\n求解过程首先建立理论框架，然后将其应用于指定的测试用例。\n\n所考虑的系统是一个浸在流体中的单自由度 (SDOF) 结构振子。结构的运动由牛顿第二定律控制。在真空（或“干”）条件下，质量为 $m_s$、弹簧刚度为 $k$ 的无阻尼振子的运动方程为：\n$$m_s \\ddot{x} + kx = 0$$\n其中 $x$ 是位移，$\\ddot{x}$ 是加速度。这个“干”系统的固有频率由下式给出：\n$$\\omega_{\\text{dry}} = \\sqrt{\\frac{k}{m_s}}$$\n\n当振子浸入流体中时，其运动会加速周围的流体，而流体反过来又对结构施加一个惯性力。对于无粘、不可压缩的流体，这种效应可以建模为“附加质量”$m_a$，概念上它是一部分与结构一起运动的流体质量。系统的总有效质量变成结构质量和附加质量之和：\n$$m_{\\text{eff}} = m_s + m_a$$\n“湿”系统的运动方程则为：\n$$(m_s + m_a) \\ddot{x} + kx = 0$$\n这个耦合 FSI 系统的固有频率，即“湿”频率，是：\n$$\\omega = \\sqrt{\\frac{k}{m_s + m_a}}$$\n\n问题提供了以下定义：\n- 结构质量：$m_s = \\rho_s V$，其中 $\\rho_s$ 是结构密度，$V$ 是特征体积。\n- 附加质量：$m_a = C_a \\rho_f V$，其中 $\\rho_f$ 是流体密度，$C_a$ 是附加质量系数。\n\n控制系统行为的一个关键无量纲参数是质量比 $r$，定义为附加质量与结构质量之比：\n$$r = \\frac{m_a}{m_s} = \\frac{C_a \\rho_f V}{\\rho_s V} = \\frac{C_a \\rho_f}{\\rho_s}$$\n使用密度比的定义 $\\beta = \\rho_s/\\rho_f$，质量比可以表示为 $r = C_a/\\beta$。\n\n附加质量降低了系统的固有频率。这种降低的程度由频率比来量化：\n$$\\frac{\\omega}{\\omega_{\\text{dry}}} = \\frac{\\sqrt{k/(m_s + m_a)}}{\\sqrt{k/m_s}} = \\sqrt{\\frac{m_s}{m_s + m_a}} = \\sqrt{\\frac{1}{1 + m_a/m_s}} = \\frac{1}{\\sqrt{1 + r}}$$\n这种关系表明，频率比以及整个系统的动态行为，都由质量比 $r$ 唯一确定。\n\n问题要求根据附加质量效应的重要性进行区间分类。该标准基于相对频率降低量 $1 - \\omega/\\omega_{\\text{dry}}$。\n- **附加质量可忽略（代码 $0$）**：该区间由一个小的频率降低定义：$1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$，其中 $\\varepsilon_{\\text{negl}} = 0.05$。我们可以将其转化为关于 $r$ 的一个条件：\n$$1 - \\frac{1}{\\sqrt{1+r}} \\le \\varepsilon_{\\text{negl}} \\implies 1 - \\varepsilon_{\\text{negl}} \\le \\frac{1}{\\sqrt{1+r}} \\implies \\sqrt{1+r} \\le \\frac{1}{1 - \\varepsilon_{\\text{negl}}}$$\n$$1+r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} \\implies r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$$\n这定义了阈值 $r_{\\text{negl}}$。代入 $\\varepsilon_{\\text{negl}} = 0.05$：\n$$r_{\\text{negl}} = \\frac{1}{(1 - 0.05)^2} - 1 = \\frac{1}{0.95^2} - 1 = \\frac{1}{0.9025} - 1 \\approx 1.108033 - 1 = 0.108033$$\n因此，可忽略区间对应于 $r \\le 0.108033$。\n\n- **附加质量占主导（代码 $2$）**：该区间定义为附加质量显著大于结构质量，具体来说至少大 $10$ 倍。标准是 $r \\ge \\tau_{\\text{dom}}$，其中 $\\tau_{\\text{dom}} = 10$。\n\n- **附加质量相当（代码 $1$）**：此区间覆盖了所有 $r_{\\text{negl}}  r  \\tau_{\\text{dom}}$ 的中间情况。\n\n对于多物理场仿真，流体域和固体域之间耦合的强度至关重要。一个关键指标是流体惯性分数 $\\gamma$，它衡量流体对总有效质量的贡献比例：\n$$\\gamma = \\frac{m_a}{m_s + m_a} = \\frac{m_a/m_s}{1 + m_a/m_s} = \\frac{r}{1+r}$$\n问题指出，如果流体惯性分数显著，具体而言如果 $\\gamma \\ge \\gamma_{\\text{crit}}$（其中 $\\gamma_{\\text{crit}} = 0.3$），则建议使用强（隐式）耦合。此条件等效于：\n$$\\frac{r}{1+r} \\ge 0.3 \\implies r \\ge 0.3(1+r) \\implies 0.7r \\ge 0.3 \\implies r \\ge \\frac{3}{7} \\approx 0.42857$$\n一个布尔值 (True/False) 将代表此建议。\n\n最后，对于使用像中心差分格式这样的显式方法的时域仿真，数值稳定性受到系统最高频率的限制。线性振子的临界时间步长限制为：\n$$\\Delta t_{\\text{crit}} = \\frac{2}{\\omega}$$\n其中 $\\omega = \\sqrt{k/m_{\\text{eff}}}$。将为每个用例计算此值。\n\n对于每个测试用例 $(\\rho_s, \\rho_f, C_a)$，在固定参数 $k=1.0 \\times 10^5\\,\\mathrm{N/m}$ 和 $V=1.0\\,\\mathrm{m^3}$ 下的算法流程如下：\n1.  计算质量比：$r = (C_a \\rho_f) / \\rho_s$。\n2.  确定区间代码：\n    - 如果 $r \\le r_{\\text{negl}} \\approx 0.108033$，代码为 $0$。\n    - 如果 $r \\ge \\tau_{\\text{dom}} = 10$，代码为 $2$。\n    - 否则，代码为 $1$。\n3.  计算频率比：$\\omega/\\omega_{\\text{dry}} = 1/\\sqrt{1+r}$。\n4.  确定强耦合建议：如果 $r \\ge 3/7$ 则为 True，否则为 False。\n5.  计算湿固有频率：$\\omega = \\sqrt{k / ((\\rho_s + C_a \\rho_f)V)}$。\n6.  计算临界时间步长：$\\Delta t_{\\text{crit}} = 2/\\omega$。\n7.  组合四个结果：[区间代码, 频率比, 耦合建议, 临界时间步长]。\n现在为所有指定的测试用例实施此流程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FSI added-mass problem for a set of test cases.\n    \"\"\"\n    \n    # Define fixed parameters and criteria from the problem statement.\n    k = 1.0e5  # Stiffness in N/m\n    V = 1.0    # Characteristic volume in m^3\n\n    epsilon_negl = 0.05\n    tau_dom = 10.0\n    gamma_crit = 0.3\n\n    # Calculate the threshold for the negligible regime.\n    r_negl = 1 / (1 - epsilon_negl)**2 - 1\n\n    # Calculate the mass ratio threshold for strong coupling.\n    # gamma = r / (1 + r) >= gamma_crit  => r >= gamma_crit / (1 - gamma_crit)\n    r_strong_coupling_threshold = gamma_crit / (1 - gamma_crit)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (rho_s, rho_f, C_a).\n    test_cases = [\n        (10.0, 1000.0, 1.0),                  # Case 1\n        (1000.0, 1000.0, 1.0),                # Case 2\n        (10000.0, 1000.0, 1.0),               # Case 3 (r=0.1)\n        (25000.0/3.0, 1000.0, 1.0),           # Case 4 (r=0.12)\n        (1000.0/9.0, 1000.0, 1.0),            # Case 5 (r=9.0)\n        (50.0, 1000.0, 0.5),                  # Case 6 (r=10.0)\n        (8000.0, 1000.0, 2.0),                # Case 7 (r=0.25)\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_s, rho_f, C_a = case\n\n        # 1. Calculate the mass ratio r.\n        # Ensure rho_s is not zero to avoid division errors, though not expected here.\n        if rho_s == 0:\n            # Handle theoretically infinite mass ratio\n            r = float('inf')\n        else:\n            r = (C_a * rho_f) / rho_s\n        \n        # 2. Determine the regime code.\n        if r = r_negl:\n            regime_code = 0  # Negligible\n        elif r >= tau_dom:\n            regime_code = 2  # Dominant\n        else:\n            regime_code = 1  # Comparable\n\n        # 3. Calculate the frequency ratio omega / omega_dry.\n        freq_ratio = 1 / np.sqrt(1 + r)\n\n        # 4. Determine the strong coupling recommendation.\n        # gamma = r / (1 + r)\n        # strong_coupling = gamma >= gamma_crit\n        # Using the pre-calculated threshold on r is more direct.\n        strong_coupling = r >= r_strong_coupling_threshold\n\n        # 5. Calculate the effective mass and wet natural frequency.\n        m_s = rho_s * V\n        m_a = C_a * rho_f * V\n        m_eff = m_s + m_a\n        \n        # Check for m_eff = 0 to avoid domain errors in sqrt, though physically not expected.\n        if m_eff > 0:\n            omega = np.sqrt(k / m_eff)\n            # 6. Calculate the critical explicit time step.\n            dt_crit = 2 / omega\n        else:\n            omega = float('inf')\n            dt_crit = 0.0\n\n        # Assemble the results for the current case.\n        case_result = [regime_code, freq_ratio, strong_coupling, dt_crit]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the required format.\n    # Using \", \".join() to have spaces after commas between inner lists.\n    # Example format: [[c1, f1, b1, t1], [c2, f2, b2, t2], ...]\n    output_str = \"[\" + \", \".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3527931"}, {"introduction": "前面的练习都假设附加质量值是已知的，但这些值从何而来？本练习将通过一个强大的数值工具——边界元法（BEM），揭示如何从第一性原理（势流理论）出发，为任意几何形状计算附加质量矩阵。通过亲手实现一个边界元求解器，你将对流体惯性如何被量化获得根本性的理解 [@problem_id:3528013]。", "problem": "考虑一个围绕着经历微小刚体加速度的刚体的二维、不可压缩、无旋流。流固耦合 (FSI) 中的附加质量矩阵源于物体加速度引起的非定常压力场，并且可以在线性化势流框架内计算。假设流动由满足拉普拉斯方程的速度势控制，并且非定常伯努利方程中速度的二次项可以忽略不计。\n\n您的任务是推导、离散化并实现一种边界元法，以计算平面内平移运动的附加质量矩阵元素。\n\n基本原理：\n- 不可压缩、无旋流意味着存在一个标量势 $\\Phi(\\mathbf{x},t)$，其速度为 $\\mathbf{v} = \\nabla \\Phi$，控制方程为拉普拉斯方程：\n$$\n\\nabla^2 \\Phi(\\mathbf{x},t) = 0 \\quad \\text{在流体域中。}\n$$\n- 考虑微小刚体加速度，因此对于给定方向上的单位加速度情况，势可以分解为 $\\Phi(\\mathbf{x},t) = t\\,\\phi(\\mathbf{x})$。线性化的非定常伯努利方程给出的压力为\n$$\np(\\mathbf{x},t) = -\\rho \\,\\frac{\\partial \\Phi}{\\partial t} = -\\rho\\,\\phi(\\mathbf{x}),\n$$\n其中 $\\rho$ 是流体密度。\n- 对于边界 $\\Gamma$ 上具有外法向单位向量 $\\mathbf{n}$ 的刚体，与第 $j$ 个笛卡尔方向（$j \\in \\{x,y\\}$）的单位加速度相关联的加速度势的法向加速度边界条件为\n$$\n\\frac{\\partial \\phi^{(j)}}{\\partial n} = \\mathbf{n}\\cdot \\mathbf{e}_j \\quad \\text{on } \\Gamma,\n$$\n其中 $\\mathbf{e}_j$ 是沿 $j$ 方向的单位向量，$\\phi^{(j)}$ 表示该单位加速度的加速度势。\n- 作用在物体上的流体动力是通过在边界上对压力进行积分得到的，其力的分量 $F_i$ 由下式给出\n$$\nF_i = -\\int_{\\Gamma} p\\, n_i \\, \\mathrm{d}S = \\rho \\int_{\\Gamma} \\phi \\, n_i \\, \\mathrm{d}S,\n$$\n其中 $i \\in \\{x,y\\}$。对于加速度分量 $a_j$，附加质量矩阵 $\\mathbf{M}_a$ 满足 $F_i = - \\sum_{j} M_{a,ij} \\, a_j$。对于 $j$ 方向的单位加速度，该分量为\n$$\nM_{a,ij} = - \\rho \\int_{\\Gamma} \\phi^{(j)} \\, n_i \\, \\mathrm{d}S.\n$$\n\n使用二维自由空间 Green 函数，为 Neumann 问题推导一个边界积分方程\n$$\nG(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\|\\mathbf{x}-\\mathbf{y}\\|,\n$$\n并得到一个关于在 $\\Gamma$ 上求值的未知边界势 $\\phi$ 的第二类积分方程：\n$$\n\\frac{1}{2}\\,\\phi(\\mathbf{x}) + \\int_{\\Gamma} \\phi(\\mathbf{y}) \\, \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y})\n= \\int_{\\Gamma} \\left(\\frac{\\partial \\phi}{\\partial n}\\right) (\\mathbf{y}) \\, G(\\mathbf{x},\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y}), \\quad \\mathbf{x} \\in \\Gamma,\n$$\n其中 $\\partial G/\\partial n(\\mathbf{y}) = \\nabla_{\\mathbf{y}} G(\\mathbf{x},\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})$。\n\n将边界 $\\Gamma$ 离散化为 $N$ 个直的常数元，并采用中点配置法。设中点为 $\\{\\mathbf{x}_k\\}_{k=1}^N$，板单元长度为 $\\{L_\\ell\\}_{\\ell=1}^N$，板单元上的外法向单位向量为 $\\{\\mathbf{n}_\\ell\\}_{\\ell=1}^N$。通过以下方式近似积分算子：\n- 对于右侧的单层算子，使用\n$$\n\\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y})\\, \\mathrm{d}S(\\mathbf{y}) \\approx\n\\begin{cases}\n-\\frac{L_\\ell}{2\\pi}\\left(\\ln\\left(\\frac{L_\\ell}{2}\\right) - 1\\right),   \\text{当 } k=\\ell \\\\\n-\\frac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{y}_\\ell\\|,   \\text{当 } k\\neq \\ell\n\\end{cases}\n$$\n其中 $\\mathbf{y}_\\ell$ 是板单元 $\\ell$ 的中点。\n- 对于左侧的双层算子，使用\n$$\n\\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\mathrm{d}S(\\mathbf{y}) \\approx\n\\begin{cases}\n0,   \\text{当 } k=\\ell \\\\\n-\\frac{L_\\ell}{2\\pi}\\,\\frac{(\\mathbf{y}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{y}_\\ell - \\mathbf{x}_k\\|^2},  \\text{当 } k\\neq \\ell\n\\end{cases}\n$$\n\n为 $\\phi$ 的未知节点值组合线性系统：\n$$\n\\left(\\frac{1}{2}\\mathbf{I} + \\mathbf{J}\\right) \\boldsymbol{\\phi} = \\mathbf{I}_G \\mathbf{q},\n$$\n其中 $\\mathbf{J}$ 包含双层近似，$\\mathbf{I}_G$ 包含单层近似，$\\mathbf{q}$ 是给定 Neumann 数据的向量 $q_\\ell = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_j$，$\\boldsymbol{\\phi}$ 是未知边界势的向量。求解该系统得到 $j=x$ 和 $j=y$ 时的 $\\boldsymbol{\\phi}^{(j)}$，然后计算\n$$\nM_{a,ij} \\approx -\\rho \\sum_{\\ell=1}^{N} \\phi^{(j)}_\\ell \\, n_{i,\\ell}\\, L_\\ell.\n$$\n\n实现此算法，为以下测试套件计算对角线元素 $M_{a,xx}$ 和 $M_{a,yy}$（沿平面外方向的单位厚度，单位为 $\\mathrm{kg/m}$）。使用密度 $\\rho = 1000\\,\\mathrm{kg/m^3}$ 和如上所述的常数元中点配置法。将每个边界在参数角 $\\theta \\in [0,2\\pi)$ 上用 $N$ 个板单元进行均匀离散化。\n\n测试套件：\n- 情况 1 (理想路径): 半径 $R=1\\,\\mathrm{m}$ 的圆， $N=300$。\n- 情况 2 (中等各向异性): 半轴 $a=2\\,\\mathrm{m}$，$b=0.5\\,\\mathrm{m}$ 的椭圆， $N=300$。\n- 情况 3 (细长椭圆，边缘情况): 半轴 $a=3\\,\\mathrm{m}$，$b=0.3\\,\\mathrm{m}$ 的椭圆， $N=360$。\n\n几何参数化：\n- 圆: $\\mathbf{r}(\\theta) = \\big(R\\cos\\theta, R\\sin\\theta\\big)$。\n- 椭圆: $\\mathbf{r}(\\theta) = \\big(a\\cos\\theta, b\\sin\\theta\\big)$。\n\n为每个情况按顺序计算并输出两个对角线元素 $M_{a,xx}$ 和 $M_{a,yy}$，单位为 $\\mathrm{kg/m}$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,...]”）。结果必须以 $\\mathrm{kg/m}$ 为单位的浮点数形式打印，不含任何附加文本。数值可以不进行四舍五入，但必须是有效的浮点数字面量。", "solution": "该问题要求计算二维刚体在理想流体中的附加质量矩阵的对角线元素。指定的方法是应用于线性化势流方程的边界元法 (BEM)。\n\n控制物理过程由速度势的拉普拉斯方程 $\\nabla^2 \\Phi = 0$ 描述。对于经历刚体加速度的物体，总势可以分解。对于第 $j$ 方向的单位加速度 $\\mathbf{a} = \\mathbf{e}_j$，势为 $\\Phi(\\mathbf{x},t) = t\\,\\phi^{(j)}(\\mathbf{x})$，其中 $\\phi^{(j)}$ 是加速度势。该势必须在流体域中满足拉普拉斯方程 $\\nabla^2 \\phi^{(j)} = 0$，并在物体表面 $\\Gamma$ 上满足 Neumann 边界条件：\n$$\n\\frac{\\partial \\phi^{(j)}}{\\partial n} = \\mathbf{n} \\cdot \\mathbf{e}_j\n$$\n其中 $\\mathbf{n}$ 是 $\\Gamma$ 上的外法向单位向量。表面上的压力 $p$ 由线性化的伯努利方程给出，为 $p = -\\rho\\,\\phi^{(j)}$，其中 $\\rho$ 是流体密度。流体动力 $F_i$ 的第 $i$ 个分量是压力在第 $i$ 个方向上投影的积分：\n$$\nF_i^{(j)} = -\\int_{\\Gamma} p \\, n_i \\, \\mathrm{d}S = \\rho \\int_{\\Gamma} \\phi^{(j)} n_i \\, \\mathrm{d}S\n$$\n附加质量系数 $M_{a,ij}$ 的定义使得该力为 $F_i^{(j)} = -M_{a,ij}$。因此，附加质量系数的表达式为：\n$$\nM_{a,ij} = - \\rho \\int_{\\Gamma} \\phi^{(j)}(\\mathbf{x}) \\, n_i(\\mathbf{x}) \\, \\mathrm{d}S(\\mathbf{x})\n$$\n为了找到边界上的未知势 $\\phi^{(j)}$，我们使用边界积分方程 (BIE) 公式求解拉普拉斯方程。对一个外问题应用 Green 第三恒等式，并让场点 $\\mathbf{x}$ 趋近于边界 $\\Gamma$，可得到以下第二类 BIE：\n$$\n\\frac{1}{2}\\,\\phi(\\mathbf{x}) + \\int_{\\Gamma} \\phi(\\mathbf{y}) \\, \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y}) = \\int_{\\Gamma} \\frac{\\partial \\phi}{\\partial n}(\\mathbf{y}) \\, G(\\mathbf{x},\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y}), \\quad \\text{for } \\mathbf{x} \\in \\Gamma\n$$\n这里，$\\phi$ 是通用加速度势，$G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\|\\mathbf{x}-\\mathbf{y}\\|$ 是拉普拉斯算子的二维自由空间 Green 函数，而 $\\frac{\\partial \\phi}{\\partial n}$ 是给定的 Neumann 数据。\n\nBEM 将此积分方程离散化。边界 $\\Gamma$ 被划分为 $N$ 个直线段（板单元），索引为 $\\ell = 1, \\dots, N$。势 $\\phi$ 及其法向导数 $\\frac{\\partial\\phi}{\\partial n}$ 被假定在每个板单元上为常数，其值在板单元的中点处计算。设 $\\mathbf{x}_k$ 是第 $k$ 个板单元 $\\Gamma_k$ 的中点（配置点）。应用于每个配置点 $\\mathbf{x}_k$ 的离散化 BIE 变为：\n$$\n\\frac{1}{2}\\,\\phi_k + \\sum_{\\ell=1}^{N} \\phi_\\ell \\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mathrm{d}S(\\mathbf{y}) = \\sum_{\\ell=1}^{N} q_\\ell \\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y}) \\, \\mathrm{d}S(\\mathbf{y})\n$$\n其中 $\\phi_k = \\phi(\\mathbf{x}_k)$ 是未知的势值，$q_\\ell = \\frac{\\partial \\phi}{\\partial n}(\\mathbf{y}_\\ell)$ 是板单元 $\\ell$ 中点处的已知 Neumann 数据。这就构成了一个线性方程组：\n$$\n\\left(\\frac{1}{2}\\mathbf{I} + \\mathbf{J}\\right) \\boldsymbol{\\phi} = \\mathbf{I}_G \\,\\mathbf{q}\n$$\n矩阵 $\\mathbf{J}$ 和 $\\mathbf{I}_G$ 的元素是离散化的积分算子，其近似值在问题陈述中已给出。\n对于一个中点为 $\\mathbf{y}_\\ell$、长度为 $L_\\ell$ 的板单元 $\\ell$，以及一个位于板单元 $k$ 上中点为 $\\mathbf{x}_k$ 的配置点：\n双层矩阵 $\\mathbf{J}$ 的元素为 $J_{k\\ell}$：\n$$\nJ_{k\\ell} \\approx \\int_{\\Gamma_\\ell} \\frac{\\partial G(\\mathbf{x}_k,\\mathbf{y})}{\\partial n(\\mathbf{y})}\\, \\mathrm{d}S(\\mathbf{y}) =\n\\begin{cases}\n0,  \\text{当 } k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\dfrac{(\\mathbf{y}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{y}_\\ell - \\mathbf{x}_k\\|^2},  \\text{当 } k\\neq \\ell\n\\end{cases}\n$$\n单层矩阵 $\\mathbf{I}_G$ 的元素为 $I_{G,k\\ell}$：\n$$\nI_{G,k\\ell} \\approx \\int_{\\Gamma_\\ell} G(\\mathbf{x}_k,\\mathbf{y})\\, \\mathrm{d}S(\\mathbf{y}) =\n\\begin{cases}\n-\\dfrac{L_\\ell}{2\\pi}\\left(\\ln\\left(\\dfrac{L_\\ell}{2}\\right) - 1\\right),  \\text{当 } k=\\ell \\\\\n-\\dfrac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{y}_\\ell\\|,  \\text{当 } k\\neq \\ell\n\\end{cases}\n$$\n请注意，问题陈述中使用 $\\mathbf{y}_\\ell$ 表示积分板单元的中点，因此为了索引的一致性，我们将其替换为 $\\mathbf{x}_\\ell$：\n$$\nJ_{k\\ell} \\approx -\\dfrac{L_\\ell}{2\\pi}\\,\\dfrac{(\\mathbf{x}_\\ell - \\mathbf{x}_k)\\cdot \\mathbf{n}_\\ell}{\\|\\mathbf{x}_\\ell - \\mathbf{x}_k\\|^2} \\quad (k \\neq \\ell) \\quad \\text{and} \\quad I_{G,k\\ell} \\approx -\\dfrac{L_\\ell}{2\\pi}\\,\\ln\\|\\mathbf{x}_k - \\mathbf{x}_\\ell\\| \\quad (k \\neq \\ell)\n$$\n\n计算附加质量项的算法步骤如下：\n1.  **几何离散化**：对于给定的形状（圆形或椭圆形）和板单元数量 $N$，生成 $N+1$ 个顶点来定义 $N$ 个板单元。对于每个板单元 $\\ell = 1, \\dots, N$：\n    -   计算其中点 $\\mathbf{x}_\\ell$。\n    -   计算其长度 $L_\\ell$。\n    -   计算其外法向单位向量 $\\mathbf{n}_\\ell = (n_{x,\\ell}, n_{y,\\ell})$。\n2.  **组装矩阵**：使用为其元素 $J_{k\\ell}$ 和 $I_{G,k\\ell}$ 提供的近似值，构建 $N \\times N$ 矩阵 $\\mathbf{J}$ 和 $\\mathbf{I}_G$。\n3.  **定义 Neumann 数据**：为了计算势 $\\boldsymbol{\\phi}^{(x)}$ 和 $\\boldsymbol{\\phi}^{(y)}$，我们需要两组 Neumann 数据向量：\n    -   对于 x 方向的加速度 ($j=x$)：$\\mathbf{q}^{(x)}$，其元素为 $q_\\ell^{(x)} = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_x = n_{x,\\ell}$。\n    -   对于 y 方向的加速度 ($j=y$)：$\\mathbf{q}^{(y)}$，其元素为 $q_\\ell^{(y)} = \\mathbf{n}_\\ell \\cdot \\mathbf{e}_y = n_{y,\\ell}$。\n4.  **求解线性系统**：\n    -   构建左侧矩阵 $\\mathbf{A} = \\frac{1}{2}\\mathbf{I} + \\mathbf{J}$，其中 $\\mathbf{I}$ 是单位矩阵。\n    -   构建右侧向量 $\\mathbf{b}^{(x)} = \\mathbf{I}_G \\, \\mathbf{q}^{(x)}$ 和 $\\mathbf{b}^{(y)} = \\mathbf{I}_G \\, \\mathbf{q}^{(y)}$。\n    -   求解两个线性系统 $\\mathbf{A} \\boldsymbol{\\phi}^{(x)} = \\mathbf{b}^{(x)}$ 和 $\\mathbf{A} \\boldsymbol{\\phi}^{(y)} = \\mathbf{b}^{(y)}$ 以获得板单元势向量 $\\boldsymbol{\\phi}^{(x)}$ 和 $\\boldsymbol{\\phi}^{(y)}$。\n5.  **计算附加质量系数**：$M_{a,ij}$ 的积分被离散化为对板单元的求和：\n    $$\n    M_{a,ij} \\approx - \\rho \\sum_{\\ell=1}^{N} \\phi^{(j)}_\\ell \\, n_{i,\\ell} \\, L_\\ell\n    $$\n    我们计算所需的对角线元素：\n    -   $M_{a,xx} = - \\rho \\sum_{\\ell=1}^{N} \\phi^{(x)}_\\ell \\, n_{x,\\ell} \\, L_\\ell$\n    -   $M_{a,yy} = - \\rho \\sum_{\\ell=1}^{N} \\phi^{(y)}_\\ell \\, n_{y,\\ell} \\, L_\\ell$\n\n将此程序应用于指定的三个测试案例中的每一个，使用给定的流体密度 $\\rho = 1000\\,\\mathrm{kg/m^3}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_added_mass(a, b, N, rho):\n    \"\"\"\n    Computes added-mass coefficients for an ellipse using BEM.\n    a: semi-axis in x-direction\n    b: semi-axis in y-direction\n    N: number of panels\n    rho: fluid density\n    \"\"\"\n    # 1. Discretize Geometry\n    theta_nodes = np.linspace(0, 2 * np.pi, N + 1)\n    nodes_x = a * np.cos(theta_nodes)\n    nodes_y = b * np.sin(theta_nodes)\n    nodes = np.stack((nodes_x, nodes_y), axis=1)\n\n    panel_midpoints = 0.5 * (nodes[:-1] + nodes[1:])\n    panel_vectors = nodes[1:] - nodes[:-1]\n    panel_lengths = np.sqrt(np.sum(panel_vectors**2, axis=1))\n    \n    # Outward normals: rotate tangent by -90 degrees and normalize\n    # Tangent (dx, dy) -> Normal (dy, -dx)\n    panel_normals = np.stack((panel_vectors[:, 1], -panel_vectors[:, 0]), axis=1)\n    panel_normals /= panel_lengths[:, np.newaxis]\n\n    # 2. Assemble Matrices J and I_G\n    I_G = np.zeros((N, N))\n    J = np.zeros((N, N))\n\n    # Use broadcasting for off-diagonal elements\n    xk = panel_midpoints[:, np.newaxis, :]  # Collocation points (k)\n    # The problem text uses y_l for the midpoint of the source panel l.\n    # To match the code's indexing, we'll use xl.\n    xl = panel_midpoints[np.newaxis, :, :]  # Source points (l)\n    diff_kl = xl - xk \n    dist_sq = np.sum(diff_kl**2, axis=2)\n    # Avoid division by zero if a collocation point is identical to a source point,\n    # which happens on the diagonal and is handled separately.\n    dist = np.sqrt(dist_sq, where=dist_sq>0, out=np.full_like(dist_sq, 1.0))\n\n    nl = panel_normals[np.newaxis, :, :] # Normals of source panels (l)\n    L_l = panel_lengths[np.newaxis, :]   # Lengths of source panels (l)\n    \n    # Off-diagonal elements of I_G\n    I_G_off_diag = (-L_l / (2 * np.pi)) * np.log(dist, where=dist>0, out=np.zeros_like(dist))\n    \n    # Off-diagonal elements of J\n    # Formula: -L_l/(2*pi) * dot(xl - xk, nl) / ||xl - xk||^2\n    dot_prod = np.sum(diff_kl * nl, axis=2)\n    J_off_diag = (-L_l / (2 * np.pi)) * dot_prod / np.where(dist_sq>0, dist_sq, 1.0)\n    \n    np.fill_diagonal(I_G_off_diag, 0)\n    np.fill_diagonal(J_off_diag, 0)\n    I_G += I_G_off_diag\n    J += J_off_diag\n\n    # Diagonal elements\n    diag_indices = np.arange(N)\n    # I_G diagonal part\n    # A ZeroDivisionError or log(0) can occur if a panel length is zero, but this is unlikely for these geometries.\n    # Use 'where' to handle log(0) for very small panels.\n    safe_lengths = np.where(panel_lengths > 0, panel_lengths, 1e-30)\n    I_G[diag_indices, diag_indices] = (-safe_lengths / (2 * np.pi)) * (np.log(safe_lengths / 2) - 1)\n    # J diagonal part is 0\n\n    # 3. Define Neumann Data\n    q_x = panel_normals[:, 0]\n    q_y = panel_normals[:, 1]\n\n    # 4. Solve Linear Systems\n    A = 0.5 * np.identity(N) + J\n    \n    # RHS for x-acceleration\n    b_x = I_G @ q_x\n    phi_x = np.linalg.solve(A, b_x)\n\n    # RHS for y-acceleration\n    b_y = I_G @ q_y\n    phi_y = np.linalg.solve(A, b_y)\n\n    # 5. Compute Added-Mass Coefficients\n    # M_aij = -rho * sum(phi_j * n_i * L)\n    M_axx = -rho * np.sum(phi_x * panel_normals[:, 0] * panel_lengths)\n    M_ayy = -rho * np.sum(phi_y * panel_normals[:, 1] * panel_lengths)\n    \n    return M_axx, M_ayy\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    rho_water = 1000.0  # kg/m^3\n\n    test_cases = [\n        # Case 1: Circle (R=1m, N=300)\n        {'a': 1.0, 'b': 1.0, 'N': 300},\n        # Case 2: Ellipse (a=2m, b=0.5m, N=300)\n        {'a': 2.0, 'b': 0.5, 'N': 300},\n        # Case 3: Ellipse (a=3m, b=0.3m, N=360)\n        {'a': 3.0, 'b': 0.3, 'N': 360},\n    ]\n\n    results = []\n    for case in test_cases:\n        M_axx, M_ayy = compute_added_mass(case['a'], case['b'], case['N'], rho_water)\n        results.extend([M_axx, M_ayy])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3528013"}]}