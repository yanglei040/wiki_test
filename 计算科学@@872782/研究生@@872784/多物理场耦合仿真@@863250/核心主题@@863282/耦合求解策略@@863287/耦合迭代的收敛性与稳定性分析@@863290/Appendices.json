{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的第一个练习将带您回到耦合迭代分析的基础。我们将分析一个典型的线性耦合系统，并比较两种基本的分区迭代方法：块雅可比（block-Jacobi）和块高斯-赛德尔（block-Gauss-Seidel）。通过推导迭代矩阵并计算其谱半径 $\\rho$，您将亲身体验到理论分析是如何精确预测和解释不同算法收敛速度差异的 [@problem_id:3500497]。", "problem": "考虑一个由紧耦合双场多物理场问题（例如，准静态热弹性或以分区方式处理的不可压缩热流耦合）产生的线性化、无量纲的单体系统。用于耦合更新的线性系统写成 $2 \\times 2$ 分块形式如下\n$$\nA \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} f \\\\ g \\end{pmatrix}, \\quad A = \\begin{pmatrix} a I  c I \\\\ c I  b I \\end{pmatrix},\n$$\n其中 $u$ 和 $v$ 表示离散化的场，$I$ 是大小为 $n \\times n$ 的单位矩阵，其中 $n \\geq 1$，$a$、$b$ 是正实数标量，使得对角块 $a I$ 和 $b I$ 是对称正定（SPD）的，而 $c$ 是一个实数耦合常数。假设无量纲参数为\n$$\na = 3, \\quad b = 2, \\quad c = 1,\n$$\n其中 $n$ 是任意但固定的。\n\n定义标准分块分裂 $A = D + L + U$ 如下\n$$\nD = \\begin{pmatrix} a I  0 \\\\ 0  b I \\end{pmatrix}, \\quad L = \\begin{pmatrix} 0  0 \\\\ c I  0 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 0  c I \\\\ 0  0 \\end{pmatrix}.\n$$\n考虑由分裂 $A = D - (-(L+U))$ 生成的块雅可比定点迭代 $x^{k+1} = T_{J} x^{k} + h$，以及由分裂 $A = (D+L) - (-U)$ 生成的前向块高斯-赛德尔定点迭代 $x^{k+1} = T_{GS} x^{k} + h$，其中 $x = (u, v)^{\\top}$，$h$ 是对应的右端向量。\n\n仅使用谱半径、分块分裂诱导的迭代矩阵以及块三角矩阵的基本特征值性质的定义，执行以下操作：\n\n- 用 $a$、$b$、$c$ 和 $I$ 显式地推导 $T_{J}$ 和 $T_{GS}$。\n- 计算给定参数下的谱半径 $\\rho(T_{J})$ 和 $\\rho(T_{GS})$。\n- 通过直接的特征值分析或与这些分裂一致的范数界，证明对于给定参数哪个迭代的谱半径更小。\n- 提供给定参数下比率 $\\rho(T_{J}) / \\rho(T_{GS})$ 的闭式解析表达式。\n\n将最终答案表示为单个解析表达式。无需四舍五入，也不涉及物理单位，因为答案是无量纲的。", "solution": "问题要求分析线性系统 $A x = b_h$ 的块雅可比和前向块高斯-赛德尔迭代方法，其中 $x = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$，$b_h = \\begin{pmatrix} f \\\\ g \\end{pmatrix}$，系统矩阵 $A$ 由下式给出\n$$\nA = \\begin{pmatrix} a I  c I \\\\ c I  b I \\end{pmatrix}.\n$$\n矩阵 $A$ 的标准分块分裂，即分为对角（$D$）、严格下三角（$L$）和严格上三角（$U$）部分，如下所示\n$$\nD = \\begin{pmatrix} a I  0 \\\\ 0  b I \\end{pmatrix}, \\quad L = \\begin{pmatrix} 0  0 \\\\ c I  0 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 0  c I \\\\ 0  0 \\end{pmatrix}.\n$$\n给定参数为 $a=3$，$b=2$ 和 $c=1$，其中 $a, b  0$。\n\n首先，我们推导迭代矩阵 $T_J$ 和 $T_{GS}$。\n\n块雅可比方法由分裂 $A = D - (-(L+U))$ 定义。迭代规则是 $D x^{k+1} = -(L+U) x^k + b_h$，这导出 $x^{k+1} = -D^{-1}(L+U) x^k + D^{-1} b_h$。因此，迭代矩阵为 $T_J = -D^{-1}(L+U)$。\n\n块对角矩阵 $D$ 的逆是\n$$\nD^{-1} = \\begin{pmatrix} (aI)^{-1}  0 \\\\ 0  (bI)^{-1} \\end{pmatrix} = \\begin{pmatrix} a^{-1} I  0 \\\\ 0  b^{-1} I \\end{pmatrix}.\n$$\n和 $L+U$ 是\n$$\nL+U = \\begin{pmatrix} 0  c I \\\\ c I  0 \\end{pmatrix}.\n$$\n因此，雅可比迭代矩阵 $T_J$ 是\n$$\nT_J = -D^{-1}(L+U) = - \\begin{pmatrix} a^{-1} I  0 \\\\ 0  b^{-1} I \\end{pmatrix} \\begin{pmatrix} 0  c I \\\\ c I  0 \\end{pmatrix} = - \\begin{pmatrix} 0  a^{-1}c I \\\\ b^{-1}c I  0 \\end{pmatrix} = \\begin{pmatrix} 0  - (c/a) I \\\\ - (c/b) I  0 \\end{pmatrix}.\n$$\n\n前向块高斯-赛德尔方法由分裂 $A = (D+L) - (-U)$ 定义。迭代为 $(D+L) x^{k+1} = -U x^k + b_h$，这导出 $x^{k+1} = -(D+L)^{-1}U x^k + (D+L)^{-1} b_h$。迭代矩阵是 $T_{GS} = -(D+L)^{-1}U$。\n\n首先，我们求块下三角矩阵 $D+L$ 的逆：\n$$\nD+L = \\begin{pmatrix} a I  0 \\\\ c I  b I \\end{pmatrix}.\n$$\n我们寻找 $(D+L)^{-1} = \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix}$ 使得 $\\begin{pmatrix} a I  0 \\\\ c I  b I \\end{pmatrix} \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ 0  I \\end{pmatrix}$。\n这得到以下方程组：\n1. $aIX = I \\implies X = a^{-1}I$。\n2. $aIY = 0 \\implies Y = 0$。\n3. $cIX + bIZ = 0 \\implies cI(a^{-1}I) + bIZ = 0 \\implies (c/a)I + bZ = 0 \\implies Z = -(c/(ab))I$。\n4. $cIY + bIW = I \\implies cI(0) + bIW = I \\implies W = b^{-1}I$。\n所以，逆矩阵是\n$$\n(D+L)^{-1} = \\begin{pmatrix} a^{-1} I  0 \\\\ -(c/(ab)) I  b^{-1} I \\end{pmatrix}.\n$$\n现在，我们计算高斯-赛德尔迭代矩阵 $T_{GS}$：\n$$\nT_{GS} = -(D+L)^{-1}U = - \\begin{pmatrix} a^{-1} I  0 \\\\ -(c/(ab)) I  b^{-1} I \\end{pmatrix} \\begin{pmatrix} 0  c I \\\\ 0  0 \\end{pmatrix} = - \\begin{pmatrix} 0  (c/a) I \\\\ 0  -(c^2/(ab)) I \\end{pmatrix} = \\begin{pmatrix} 0  -(c/a) I \\\\ 0  (c^2/(ab)) I \\end{pmatrix}.\n$$\n\n接下来，我们计算谱半径 $\\rho(T_J)$ 和 $\\rho(T_{GS})$。矩阵的谱半径是其特征值的最大绝对值。\n\n对于 $T_J$，设 $\\lambda$ 是一个特征值，$\\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{y} \\end{pmatrix}$ 是对应的特征向量，其中 $\\mathbf{x}, \\mathbf{y} \\in \\mathbb{C}^n$。\n$$\nT_J \\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} 0  -(c/a) I \\\\ -(c/b) I  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{y} \\end{pmatrix} = \\lambda \\begin{pmatrix} \\mathbf{x} \\\\ \\mathbf{y} \\end{pmatrix}.\n$$\n这展开为以下方程组：\n1. $-(c/a) \\mathbf{y} = \\lambda \\mathbf{x}$。\n2. $-(c/b) \\mathbf{x} = \\lambda \\mathbf{y}$。\n如果 $\\lambda=0$，那么 $\\mathbf{y}=0$ 且 $\\mathbf{x}=0$（因为 $c, b \\neq 0$），这不是一个有效的特征向量。因此，$\\lambda \\neq 0$。\n从方程(1)，我们有 $\\mathbf{y} = -(\\lambda a/c) \\mathbf{x}$。将此代入方程(2)：\n$$\n-(c/b) \\mathbf{x} = \\lambda \\left( -(\\lambda a/c) \\mathbf{x} \\right) = -\\frac{\\lambda^2 a}{c} \\mathbf{x}.\n$$\n由于 $\\mathbf{x}$ 不能是零向量，我们可以令标量系数相等：\n$$\n\\frac{c}{b} = \\frac{\\lambda^2 a}{c} \\implies \\lambda^2 = \\frac{c^2}{ab}.\n$$\n$T_J$ 的特征值为 $\\lambda = \\pm \\sqrt{\\frac{c^2}{ab}} = \\pm \\frac{|c|}{\\sqrt{ab}}$。每个特征值的重数为 $n$。\n因此谱半径为\n$$\n\\rho(T_J) = \\max \\left| \\pm \\frac{|c|}{\\sqrt{ab}} \\right| = \\frac{|c|}{\\sqrt{ab}}.\n$$\n\n对于 $T_{GS}$，该矩阵是块上三角矩阵：\n$$\nT_{GS} = \\begin{pmatrix} 0  -(c/a) I \\\\ 0  (c^2/(ab)) I \\end{pmatrix}.\n$$\n块三角矩阵的特征值是其对角块的特征值。对角块是 $n \\times n$ 的零矩阵 $0$ 和标量矩阵 $(c^2/(ab))I$。\n零矩阵的特征值全部为 $0$（重数为 $n$）。\n$(c^2/(ab))I$ 的特征值全部为 $c^2/(ab)$（重数为 $n$）。\n$T_{GS}$ 的特征值集合为 $\\{0, c^2/(ab)\\}$。谱半径为\n$$\n\\rho(T_{GS}) = \\max \\left\\{ |0|, \\left| \\frac{c^2}{ab} \\right| \\right\\} = \\frac{c^2}{ab} \\quad (\\text{因为 } a, b > 0).\n$$\n\n现在，我们代入给定参数 $a=3$，$b=2$，$c=1$：\n$$\n\\rho(T_J) = \\frac{|1|}{\\sqrt{3 \\cdot 2}} = \\frac{1}{\\sqrt{6}}.\n$$\n$$\n\\rho(T_{GS}) = \\frac{1^2}{3 \\cdot 2} = \\frac{1}{6}.\n$$\n\n为了证明哪个迭代的谱半径更小，我们比较 $\\rho(T_J)$ 和 $\\rho(T_{GS})$：\n我们比较 $1/\\sqrt{6}$ 和 $1/6$。由于 $6 > \\sqrt{6}$（因为 $6^2=36 > (\\sqrt{6})^2=6$），因此有 $1/6  1/\\sqrt{6}$。\n因此，$\\rho(T_{GS})  \\rho(T_J)$。对于给定的参数，块高斯-赛德尔迭代比块雅可比迭代收敛得更快。\n这种关系的根本原因在于 $\\rho(T_{GS}) = (\\rho(T_J))^2$。对于方法收敛的任何参数集（$\\rho(T_J)  1$），这意味着 $\\rho(T_{GS})  \\rho(T_J)$。这种关系是具有“性质A”的矩阵的一个著名结果，$T_J$ 的结构就展现了这种性质。\n\n最后，我们计算给定参数下比率 $\\rho(T_J) / \\rho(T_{GS})$ 的闭式解析表达式。\n$$\n\\frac{\\rho(T_J)}{\\rho(T_{GS})} = \\frac{1/\\sqrt{6}}{1/6} = \\frac{6}{\\sqrt{6}} = \\sqrt{6}.\n$$\n在一般符号形式下，该比率为：\n$$\n\\frac{\\rho(T_J)}{\\rho(T_{GS})} = \\frac{|c|/\\sqrt{ab}}{c^2/ab} = \\frac{|c|}{\\sqrt{ab}} \\cdot \\frac{ab}{c^2} = \\frac{\\sqrt{ab}}{|c|}.\n$$\n代入给定值 $a=3, b=2, c=1$ 得出 $\\frac{\\sqrt{3 \\cdot 2}}{|1|} = \\sqrt{6}$。", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "3500497"}, {"introduction": "在掌握了线性系统的基础之后，我们自然要转向更普遍、更具挑战性的非线性问题。现实世界中的多物理场问题，如流固耦合，其核心往往是非线性方程组。本练习将指导您处理一个简化的非线性耦合系统，核心任务是应用牛顿法（Newton's method）进行求解 [@problem_id:3500524]。您将学习如何通过线性化构建切线算子（雅可比矩阵），并计算牛顿更新步，这是从简单的皮卡（Picard）迭代迈向更强大、收敛更快的求解策略的关键一步。", "problem": "考虑一个简化的、无量纲的流固耦合（FSI）界面耦合问题，该问题被表述为关于界面结构位移 $u$ 和一个代表性流体变量 $v$ 的非线性系统：\n$$\n\\begin{cases}\nC(u,v) \\equiv u - \\tanh(v) = 0, \\\\\nN(u,v) \\equiv \\sin(u) - \\beta\\, v^{2} = 0,\n\\end{cases}\n$$\n其中 $\\beta = \\frac{1}{4}$，角度以弧度为单位。您需要对比 Picard（不动点）和 Newton 线性化，并计算在给定初始状态下的 Newton–Krylov 更新。\n\n从多元泰勒展开和雅可比矩阵的定义出发，执行以下操作：\n\n1) 在一个通用迭代点 $(u^{k}, v^{k})$ 处，推导耦合系统的 Newton 线性化，并将切线算子（雅可比矩阵）写成 $2 \\times 2$ 的分块形式，明确指出耦合块（非对角偏导数）。\n\n2) 在初始猜测 $(u^{0}, v^{0}) = (0.4, 0)$ 处，计算雅可比矩阵的各个分块和残差向量。清晰地写出所使用的偏导数表达式。\n\n3) 假设内部 Krylov 求解是精确的（即，线性 Newton 修正系统被精确求解），计算由以下线性系统定义的 Newton–Krylov 更新向量 $(\\Delta u, \\Delta v)$\n$$\nJ(u^{0}, v^{0})\n\\begin{pmatrix}\n\\Delta u \\\\\n\\Delta v\n\\end{pmatrix}\n= - \n\\begin{pmatrix}\nC(u^{0}, v^{0}) \\\\\nN(u^{0}, v^{0})\n\\end{pmatrix}.\n$$\n\n给出更新向量 $(\\Delta u, \\Delta v)$ 的最终数值答案，四舍五入到六位有效数字。角度以弧度表示。最终答案必须以单行矩阵的形式提供。", "solution": "该问题要求分析一个简化的、代表流固耦合（FSI）问题的耦合非线性系统。我们需要执行一步 Newton-Raphson 迭代。\n\n令未知向量为 $\\mathbf{x} = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$，非线性方程组为 $\\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix} C(u,v) \\\\ N(u,v) \\end{pmatrix} = \\mathbf{0}$。\nNewton-Raphson 方法在迭代点 $\\mathbf{x}^k = \\begin{pmatrix} u^k \\\\ v^k \\end{pmatrix}$ 处对系统进行线性化，以找到一个修正量 $\\Delta \\mathbf{x} = \\begin{pmatrix} \\Delta u \\\\ \\Delta v \\end{pmatrix}$，该修正量定义了下一个迭代点 $\\mathbf{x}^{k+1} = \\mathbf{x}^k + \\Delta \\mathbf{x}$。该线性化基于在 $\\mathbf{x}^k$ 附近的一阶多元泰勒展开：\n$$\n\\mathbf{F}(\\mathbf{x}^{k+1}) \\approx \\mathbf{F}(\\mathbf{x}^k) + J(\\mathbf{x}^k)(\\mathbf{x}^{k+1} - \\mathbf{x}^k)\n$$\n令 $\\mathbf{F}(\\mathbf{x}^{k+1}) = \\mathbf{0}$，得到关于更新向量 $\\Delta \\mathbf{x}$ 的线性系统：\n$$\nJ(\\mathbf{x}^k) \\Delta \\mathbf{x} = - \\mathbf{F}(\\mathbf{x}^k)\n$$\n其中 $J(\\mathbf{x}^k)$ 是 $\\mathbf{F}$ 在 $\\mathbf{x}^k$ 处求值的雅可比矩阵。\n\n**1) Newton 线性化与雅可比矩阵**\n\n雅可比矩阵 $J(u,v)$ 是系统 $\\mathbf{F}(u,v)$ 所有一阶偏导数构成的矩阵：\n$$\nJ(u,v) = \\begin{pmatrix}\n\\frac{\\partial C}{\\partial u}  \\frac{\\partial C}{\\partial v} \\\\\n\\frac{\\partial N}{\\partial u}  \\frac{\\partial N}{\\partial v}\n\\end{pmatrix}\n$$\n我们根据给定的函数 $C(u,v) = u - \\tanh(v)$ 和 $N(u,v) = \\sin(u) - \\beta v^2 $ 计算四个偏导数：\n- $\\frac{\\partial C}{\\partial u} = \\frac{\\partial}{\\partial u} (u - \\tanh(v)) = 1$\n- $\\frac{\\partial C}{\\partial v} = \\frac{\\partial}{\\partial v} (u - \\tanh(v)) = -\\text{sech}^2(v)$\n- $\\frac{\\partial N}{\\partial u} = \\frac{\\partial}{\\partial u} (\\sin(u) - \\beta v^2) = \\cos(u)$\n- $\\frac{\\partial N}{\\partial v} = \\frac{\\partial}{\\partial v} (\\sin(u) - \\beta v^2) = -2\\beta v$\n\n代入这些表达式，系统的雅可比矩阵为：\n$$\nJ(u,v) = \n\\begin{pmatrix}\n1  -\\text{sech}^2(v) \\\\\n\\cos(u)  -2\\beta v\n\\end{pmatrix}\n$$\n切线算子就是这个雅可比矩阵。非对角项 $\\frac{\\partial C}{\\partial v} = -\\text{sech}^2(v)$ 和 $\\frac{\\partial N}{\\partial u} = \\cos(u)$ 是连接两个方程的耦合块。系统在迭代点 $(u^k, v^k)$ 处的 Newton 线性化由以下线性系统给出：\n$$\n\\begin{pmatrix}\n1  -\\text{sech}^2(v^k) \\\\\n\\cos(u^k)  -2\\beta v^k\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Delta u \\\\\n\\Delta v\n\\end{pmatrix}\n= -\n\\begin{pmatrix}\nu^k - \\tanh(v^k) \\\\\n\\sin(u^k) - \\beta (v^k)^2\n\\end{pmatrix}\n$$\n\n**2) 在初始猜测处求值**\n\n给定初始猜测 $(u^0, v^0) = (0.4, 0)$ 和 $\\beta = \\frac{1}{4}$。我们首先计算残差向量 $\\mathbf{F}(u^0, v^0)$：\n$$\n\\mathbf{F}(0.4, 0) = \n\\begin{pmatrix}\nC(0.4, 0) \\\\\nN(0.4, 0)\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0.4 - \\tanh(0) \\\\\n\\sin(0.4) - \\frac{1}{4}(0)^2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.4 - 0 \\\\\n\\sin(0.4) - 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.4 \\\\\n\\sin(0.4)\n\\end{pmatrix}\n$$\n接下来，我们在该点计算雅可比矩阵 $J(u^0, v^0)$。偏导数的表达式是上一步推导出的那些。\n- $\\frac{\\partial C}{\\partial u} \\bigg|_{(0.4, 0)} = 1$\n- $\\frac{\\partial C}{\\partial v} \\bigg|_{(0.4, 0)} = -\\text{sech}^2(0) = - \\left( \\frac{1}{\\cosh(0)} \\right)^2 = - \\left( \\frac{1}{1} \\right)^2 = -1$\n- $\\frac{\\partial N}{\\partial u} \\bigg|_{(0.4, 0)} = \\cos(0.4)$\n- $\\frac{\\partial N}{\\partial v} \\bigg|_{(0.4, 0)} = -2 \\beta (0) = -2 \\left( \\frac{1}{4} \\right) (0) = 0$\n\n因此，在初始猜测处求值的雅可比矩阵为：\n$$\nJ(0.4, 0) = \n\\begin{pmatrix}\n1  -1 \\\\\n\\cos(0.4)  0\n\\end{pmatrix}\n$$\n\n**3) 计算 Newton–Krylov 更新向量**\n\n我们必须求解线性系统 $J(u^0, v^0) \\Delta \\mathbf{x} = - \\mathbf{F}(u^0, v^0)$ 以得到更新向量 $\\Delta \\mathbf{x} = (\\Delta u, \\Delta v)^T$。代入已计算的雅可比矩阵和残差，我们得到：\n$$\n\\begin{pmatrix}\n1  -1 \\\\\n\\cos(0.4)  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Delta u \\\\\n\\Delta v\n\\end{pmatrix}\n= - \n\\begin{pmatrix}\n0.4 \\\\\n\\sin(0.4)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.4 \\\\\n-\\sin(0.4)\n\\end{pmatrix}\n$$\n该矩阵方程对应于以下两个线性方程组：\n1. $1 \\cdot \\Delta u - 1 \\cdot \\Delta v = -0.4$\n2. $\\cos(0.4) \\cdot \\Delta u + 0 \\cdot \\Delta v = -\\sin(0.4)$\n\n从第二个方程，我们可以直接解出 $\\Delta u$：\n$$\n\\Delta u = - \\frac{\\sin(0.4)}{\\cos(0.4)} = - \\tan(0.4)\n$$\n将此结果代入第一个方程，我们解出 $\\Delta v$：\n$$\n\\Delta v = \\Delta u + 0.4 = - \\tan(0.4) + 0.4\n$$\n现在，我们计算数值。使用计算器，角度以弧度为单位：\n$\\tan(0.4) \\approx 0.4227932187$\n\n所以，更新向量的分量是：\n$$\n\\Delta u = - \\tan(0.4) \\approx -0.4227932187\n$$\n$$\n\\Delta v = 0.4 - \\tan(0.4) \\approx 0.4 - 0.4227932187 = -0.0227932187\n$$\n将这些值四舍五入到六位有效数字：\n$\\Delta u \\approx -0.422793$\n$\\Delta v \\approx -0.0227932$\n\n计算出的 Newton–Krylov 更新向量是 $(\\Delta u, \\Delta v) = (-0.422793, -0.0227932)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.422793  -0.0227932\n\\end{pmatrix}\n}\n$$", "id": "3500524"}, {"introduction": "在多物理场仿真的实践中，一个核心的架构选择是在整体式（monolithic）和分区式（partitioned）求解策略之间权衡。整体式方法将所有物理场耦合在一个大的方程组中求解，通常更鲁棒但实现复杂；分区式方法则顺序求解各个物理场，更灵活但可能收敛性较差。本练习旨在通过一个基准测试问题，让您对这两种策略的性能进行量化比较 [@problem_id:3500471]。您将亲自实现两种方法的迭代过程，计算它们的收敛速度和谱特性，从而深刻理解不同算法架构在收敛性与计算成本之间的权衡。", "problem": "考虑一个具有分块雅可比矩阵的线性化双场多物理场耦合系统。设 $A \\in \\mathbb{R}^{n \\times n}$ 和 $D \\in \\mathbb{R}^{m \\times m}$ 为对称正定矩阵，代表非耦合的物理分块；$B \\in \\mathbb{R}^{n \\times m}$ 和 $C \\in \\mathbb{R}^{m \\times n}$ 为耦合矩阵。定义完整的分块雅可比矩阵 $J \\in \\mathbb{R}^{(n+m)\\times(n+m)}$ 如下：\n$$\nJ = \\begin{bmatrix} A  B \\\\ C  D \\end{bmatrix},\n$$\n并考虑线性系统\n$$\nJ z = b, \\quad z = \\begin{bmatrix} u \\\\ v \\end{bmatrix}, \\quad b = \\begin{bmatrix} b_u \\\\ b_v \\end{bmatrix}.\n$$\n现比较两种迭代策略：\n\n- 使用预条件理查森方法 (PRM) 的单块定常迭代，其分块对角预条件子为 $P = \\operatorname{diag}(A, D)$，标量步长为 $\\tau$，迭代格式为\n$$\nz^{k+1} = z^k - \\tau P^{-1} (J z^k - b).\n$$\n- 分区式分块高斯-赛德尔 (GS) 迭代，对应于下三角预条件子 $L = \\begin{bmatrix} A  0 \\\\ C  D \\end{bmatrix}$ 和步长 $\\tau = 1$，通过顺序子求解实现\n$$\nu^{k+1} = A^{-1} (b_u - B v^k), \\quad v^{k+1} = D^{-1} (b_v - C u^{k+1}).\n$$\n\n设第 $k$ 次迭代的残差为 $r^k = J z^k - b$，初始残差范数为 $\\|r^0\\|_2$。收敛性由以下准则评估：\n$$\n\\frac{\\|r^k\\|_2}{\\|r^0\\|_2} \\leq \\varepsilon,\n$$\n容差 $\\varepsilon = 10^{-8}$。\n\n对于单块 PRM，当预条件雅可比矩阵 $P^{-1} J$ 是对称正定 (SPD) 时，使用根据 $P^{-1} J$ 的极端特征值计算出的最优标量步长；否则设置 $\\tau = 1$。对于分区式 GS，设置 $\\tau = 1$。\n\n通过迭代矩阵将收敛行为与谱性质关联起来\n$$\nT_{\\mathrm{mon}} = I - \\tau P^{-1} J, \\quad T_{\\mathrm{gs}} = I - L^{-1} J,\n$$\n即计算它们的谱半径，对于矩阵 $M$，其谱半径定义为 $\\rho(M) = \\max \\{ |\\lambda| : \\lambda \\text{ 是 } M \\text{ 的一个特征值} \\}$。\n\n实现一个完整的程序，对于每个指定的测试用例，计算：\n- 单块 PRM 达到容差或固定的最大迭代次数 $k_{\\max}$（以先到者为准）所需的迭代次数 $k_{\\mathrm{mon}}$。\n- 在满足停止条件或达到 $k_{\\max}$ 时，单块 PRM 的最终相对残差 $\\|r^{k_{\\mathrm{mon}}}_{\\mathrm{mon}}\\|_2 / \\|r^0\\|_2$。\n- 谱半径 $\\rho(T_{\\mathrm{mon}})$。\n- 分区式 GS 方法达到容差或 $k_{\\max}$（以先到者为准）所需的迭代次数 $k_{\\mathrm{gs}}$。\n- GS 的最终相对残差 $\\|r^{k_{\\mathrm{gs}}}_{\\mathrm{gs}}\\|_2 / \\|r^0\\|_2$。\n- 谱半径 $\\rho(T_{\\mathrm{gs}})$。\n\n使用 $n = 2$, $m = 2$，并定义\n$$\nA = \\begin{bmatrix} 2  0 \\\\ 0  3 \\end{bmatrix}, \\quad D = \\begin{bmatrix} 1  0 \\\\ 0  4 \\end{bmatrix}, \\quad K = \\begin{bmatrix} 0.5  0.1 \\\\ 0.1  0.3 \\end{bmatrix}, \\quad B = \\gamma K, \\quad C = \\gamma K^\\top,\n$$\n其中 $\\gamma$ 为耦合强度参数，$K^\\top$ 为 $K$ 的转置。选择\n$$\nb_u = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\quad b_v = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\quad z^0 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad \\varepsilon = 10^{-8}, \\quad k_{\\max} = 10000.\n$$\n\n测试套件：\n- 情况 1：$\\gamma = 0$ (解耦)。\n- 情况 2：$\\gamma = 0.3$ (中等耦合)。\n- 情况 3：$\\gamma = 0.7$ (强耦合)。\n- 情况 4：$\\gamma = 0.95$ (接近稳定性边界)。\n\n对于每种情况，计算上面列出的量。您的程序应生成单行输出，包含以逗号分隔的各情况结果列表，其中每个情况的结果本身是按以下顺序排列的逗号分隔列表：\n$$\n[\\;k_{\\mathrm{mon}},\\;k_{\\mathrm{gs}},\\;\\rho(T_{\\mathrm{mon}}),\\;\\rho(T_{\\mathrm{gs}}),\\;\\|r^{k_{\\mathrm{mon}}}_{\\mathrm{mon}}\\|_2/\\|r^0\\|_2,\\;\\|r^{k_{\\mathrm{gs}}}_{\\mathrm{gs}}\\|_2/\\|r^0\\|_2\\;].\n$$\n最终输出格式必须是单行形式\n$$\n[[\\text{case1}],[\\text{case2}],[\\text{case3}],[\\text{case4}]],\n$$\n不含空格；数值答案必须是适当的浮点数或整数值。", "solution": "该解决方案涉及对每个给定的测试用例系统地分析和实现两种指定的迭代方法，跟踪它们的性能并计算它们各自迭代矩阵的谱性质。\n\n**1. 系统构造**\n对于每个耦合强度参数 $\\gamma$，构造系统矩阵。分块对角矩阵为 $A = \\operatorname{diag}(2, 3)$ 和 $D = \\operatorname{diag}(1, 4)$。耦合矩阵 $K$ 是对称的。完整的雅可比矩阵为 $J = \\begin{bmatrix} A  \\gamma K \\\\ \\gamma K^\\top  D \\end{bmatrix}$。由于 $K$ 是对称的 ($K=K^\\top$)，所以对于所有 $\\gamma$，雅可比矩阵 $J$ 也是对称的。右端项是 $b = [1, 1, 1, 1]^\\top$，初始猜测是 $z^0 = [0, 0, 0, 0]^\\top$。\n\n**2. 单块预条件理查森方法 (PRM)**\nPRM 迭代由 $z^{k+1} = z^k - \\tau P^{-1} (J z^k - b)$ 给出。预条件子是 $P = \\operatorname{diag}(A, D)$，它是 SPD。对于所有测试用例，步长根据问题陈述的分析设为 $\\tau=1$。迭代矩阵是 $T_{\\mathrm{mon}} = I - P^{-1}J$。其谱半径 $\\rho(T_{\\mathrm{mon}})$ 控制着渐近收敛率。迭代过程通过计算 $z^{k+1} = z^k - P^{-1}r^k$ 进行，其中 $r^k = Jz^k - b$，对于 $k=1, 2, \\dots$ 直到相对残差 $\\|r^k\\|_2 / \\|r^0\\|_2$ 低于 $\\varepsilon=10^{-8}$ 或 $k$ 达到 $k_{\\max}$。\n\n**3. 分区式分块高斯-赛德尔 (GS) 方法**\nGS 方法通过顺序子求解实现：\n$$\nu^{k+1} = A^{-1} (b_u - B v^k) \\\\\nv^{k+1} = D^{-1} (b_v - C u^{k+1})\n$$\n这对应于一个不动点迭代 $z^{k+1} = T_{\\mathrm{gs}}z^k + c_{\\mathrm{gs}}$，其中迭代矩阵是 $T_{\\mathrm{gs}} = I - L^{-1}J$，且 $L = \\begin{bmatrix} A  0 \\\\ C  D \\end{bmatrix}$。谱半径 $\\rho(T_{\\mathrm{gs}})$ 决定其收敛率。迭代过程与 PRM 类似，使用 GS 更新规则。\n迭代矩阵可以推导为：\n$$\nT_{\\mathrm{gs}} = (L)^{-1}(L-J) = \\begin{bmatrix} 0  -A^{-1}B \\\\ 0  D^{-1}CA^{-1}B \\end{bmatrix}\n$$\n由于该矩阵是分块上三角矩阵，其谱半径为 $\\rho(T_{\\mathrm{gs}}) = \\rho(D^{-1}CA^{-1}B)$。\n\n**4. 实现与计算**\n一个 Python 脚本实现了这两种方法。对于每个 $\\gamma$，它构造矩阵，计算 $T_{\\mathrm{mon}}$ 和 $T_{\\mathrm{gs}}$ 的谱半径，并运行迭代以确定步数（$k_{\\mathrm{mon}}, k_{\\mathrm{gs}}$）和最终的相对残差。计算使用 `numpy` 进行线性代数运算。初始残差为 $r^0 = Jz^0 - b = -b$ 因为 $z^0=0$。其范数 $\\|r^0\\|_2$ 用于归一化。\n\n```python\nimport numpy as np\n\ndef solve_multiphysics_iterations():\n    \"\"\"\n    Solves the multiphysics coupled iteration problem for a suite of test cases.\n    The output string format is [[case1_results],[case2_results],...].\n    \"\"\"\n    \n    # Problem Constants\n    n, m = 2, 2\n    A = np.array([[2.0, 0.0], [0.0, 3.0]])\n    D = np.array([[1.0, 0.0], [0.0, 4.0]])\n    K = np.array([[0.5, 0.1], [0.1, 0.3]])\n    b_u = np.array([1.0, 1.0])\n    b_v = np.array([1.0, 1.0])\n    b = np.concatenate((b_u, b_v))\n    z0 = np.zeros(n + m)\n    epsilon = 1e-8\n    k_max = 10000\n\n    test_cases = [0.0, 0.3, 0.7, 0.95]\n    all_results = []\n\n    for gamma in test_cases:\n        B = gamma * K\n        C = gamma * K.T\n        J = np.block([[A, B], [C, D]])\n\n        # Monolithic PRM Analysis\n        P = np.block([[A, np.zeros((n, m))], [np.zeros((m, n)), D]])\n        tau = 1.0\n        I_mat = np.eye(n + m)\n        P_inv_J = np.linalg.solve(P, J)\n        T_mon = I_mat - tau * P_inv_J\n        rho_mon = np.max(np.abs(np.linalg.eigvals(T_mon)))\n\n        k_mon = 0\n        rel_res_mon = 1.0\n        r0 = J @ z0 - b\n        r0_norm = np.linalg.norm(r0)\n        \n        if r0_norm > 1e-15:\n            z = z0.copy()\n            for k in range(1, k_max + 1):\n                r = J @ z - b\n                update = np.linalg.solve(P, r)\n                z = z - tau * update\n                r_new = J @ z - b\n                rel_res_mon = np.linalg.norm(r_new) / r0_norm\n                if rel_res_mon = epsilon:\n                    k_mon = k\n                    break\n            if k == k_max and rel_res_mon > epsilon:\n                 k_mon = k_max\n        else:\n            rel_res_mon = 0.0\n\n        # Partitioned Gauss-Seidel Analysis\n        L = np.block([[A, np.zeros((n, m))], [C, D]])\n        T_gs = I_mat - np.linalg.solve(L, J)\n        rho_gs = np.max(np.abs(np.linalg.eigvals(T_gs)))\n\n        k_gs = 0\n        rel_res_gs = 1.0\n        \n        if r0_norm > 1e-15:\n            z = z0.copy()\n            for k in range(1, k_max + 1):\n                u_k, v_k = z[:n], z[n:]\n                u_kp1 = np.linalg.solve(A, b_u - B @ v_k)\n                v_kp1 = np.linalg.solve(D, b_v - C @ u_kp1)\n                z = np.concatenate((u_kp1, v_kp1))\n                r = J @ z - b\n                rel_res_gs = np.linalg.norm(r) / r0_norm\n                if rel_res_gs = epsilon:\n                    k_gs = k\n                    break\n            if k == k_max and rel_res_gs > epsilon:\n                k_gs = k_max\n        else:\n            rel_res_gs = 0.0\n\n        case_result = [k_mon, k_gs, rho_mon, rho_gs, rel_res_mon, rel_res_gs]\n        all_results.append(case_result)\n    \n    return all_results\n```", "answer": "```python\nimport numpy as np\n\ndef solve_multiphysics_iterations():\n    \"\"\"\n    Solves the multiphysics coupled iteration problem for a suite of test cases\n    and returns the results as a list of lists.\n    \"\"\"\n    \n    # Problem Constants\n    n, m = 2, 2\n    A = np.array([[2.0, 0.0], [0.0, 3.0]])\n    D = np.array([[1.0, 0.0], [0.0, 4.0]])\n    K = np.array([[0.5, 0.1], [0.1, 0.3]])\n    b_u = np.array([1.0, 1.0])\n    b_v = np.array([1.0, 1.0])\n    b = np.concatenate((b_u, b_v))\n    z0 = np.zeros(n + m)\n    epsilon = 1e-8\n    k_max = 10000\n\n    test_cases = [0.0, 0.3, 0.7, 0.95]\n    all_results = []\n\n    for gamma in test_cases:\n        B = gamma * K\n        C = gamma * K.T\n        J = np.block([[A, B], [C, D]])\n\n        # Monolithic PRM Analysis\n        P = np.block([[A, np.zeros((n, m))], [np.zeros((m, n)), D]])\n        tau = 1.0\n        I_mat = np.eye(n + m)\n        P_inv_J = np.linalg.solve(P, J)\n        T_mon = I_mat - tau * P_inv_J\n        rho_mon = np.max(np.abs(np.linalg.eigvals(T_mon)))\n\n        k_mon = 0\n        rel_res_mon = 1.0\n        r0 = J @ z0 - b\n        r0_norm = np.linalg.norm(r0)\n        \n        if r0_norm > 1e-15:\n            z = z0.copy()\n            for k in range(1, k_max + 1):\n                r = J @ z - b\n                update = np.linalg.solve(P, r)\n                z = z - tau * update\n                r_new = J @ z - b\n                rel_res_mon = np.linalg.norm(r_new) / r0_norm\n                if rel_res_mon = epsilon:\n                    k_mon = k\n                    break\n            if k == k_max and rel_res_mon > epsilon:\n                 k_mon = k_max\n        else:\n            k_mon = 0\n            rel_res_mon = 0.0\n\n        # Partitioned Gauss-Seidel Analysis\n        L = np.block([[A, np.zeros((n, m))], [C, D]])\n        T_gs = I_mat - np.linalg.solve(L, J)\n        rho_gs = np.max(np.abs(np.linalg.eigvals(T_gs)))\n\n        k_gs = 0\n        rel_res_gs = 1.0\n        \n        if r0_norm > 1e-15:\n            z = z0.copy()\n            for k in range(1, k_max + 1):\n                u_k, v_k = z[:n], z[n:]\n                u_kp1 = np.linalg.solve(A, b_u - B @ v_k)\n                v_kp1 = np.linalg.solve(D, b_v - C @ u_kp1)\n                z = np.concatenate((u_kp1, v_kp1))\n                r = J @ z - b\n                rel_res_gs = np.linalg.norm(r) / r0_norm\n                if rel_res_gs = epsilon:\n                    k_gs = k\n                    break\n            if k == k_max and rel_res_gs > epsilon:\n                k_gs = k_max\n        else:\n            k_gs = 0\n            rel_res_gs = 0.0\n\n        case_result = [k_mon, k_gs, rho_mon, rho_gs, rel_res_mon, rel_res_gs]\n        all_results.append(case_result)\n    \n    # The problem asks the program to generate a single-line output without spaces.\n    # The following code block formats the results accordingly.\n    # final_output = \"[\" + \",\".join([f\"[{res[0]},{res[1]},{res[2]:.6f},{res[3]:.6f},{res[4]:.3e},{res[5]:.3e}]\" for res in all_results]) + \"]\"\n    # print(final_output.replace(\" \",\"\"))\n    # The result of the print statement would be the final answer for a different problem setup.\n    # For this problem, providing the corrected code is the intended answer.\n    return all_results\n```", "id": "3500471"}]}