{"hands_on_practices": [{"introduction": "牛顿-拉夫逊方法是求解非线性系统的核心算法。本练习让你亲手实践一次完整的牛顿迭代，从计算代表系统局部线性的雅可比矩阵 ($J$) 开始，到求解校正量的线性系统，最终更新解向量。这个过程是理解更复杂求解器行为的基础[@problem_id:3512855]。", "problem": "考虑一个用于耦合热力学玩具模型的无量纲双场残差向量，定义为\n$$\nR(U) \\equiv \\begin{bmatrix} R_{1}(T,u) \\\\ R_{2}(T,u) \\end{bmatrix}\n= \\begin{bmatrix} \\sin(T) + \\alpha\\, u \\\\ u^{3} - T \\end{bmatrix},\n$$\n其中 $U \\equiv \\begin{bmatrix} T \\\\ u \\end{bmatrix}$，标量参数 $\\alpha \\in \\mathbb{R}$ 代表耦合强度，所有量均为无量纲。假设 $\\alpha \\neq -3$ 以避免在所关注的状态下出现奇异雅可比矩阵。设当前迭代值为 $U^{(k)} = \\begin{bmatrix} T^{(k)} \\\\ u^{(k)} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，牛顿更新的阻尼因子为 $\\lambda \\in (0,1]$。\n\n从残差在 $U^{(k)}$ 处的一阶泰勒线性化和耦合系统的牛顿步定义出发，在 $U^{(k)}$ 处执行单次阻尼牛顿迭代以计算：\n- 雅可比矩阵 $J(U^{(k)}) \\equiv \\dfrac{\\partial R}{\\partial U}\\big|_{U^{(k)}}$，\n- 求解 $J(U^{(k)})\\,\\Delta U = -R(U^{(k)})$ 的牛顿增量 $\\Delta U$，\n- 阻尼更新 $U^{+} = U^{(k)} + \\lambda\\, \\Delta U$。\n\n将你的最终答案表示为行向量\n$$\n\\big(J_{11},\\, J_{12},\\, J_{21},\\, J_{22},\\, \\Delta T,\\, \\Delta u,\\, T^{+},\\, u^{+}\\big),\n$$\n其中 $J_{ij}$ 是 $J(U^{(k)})$ 的元素，$\\Delta T$、$\\Delta u$、$T^{+}$、$u^{+}$ 分别是 $\\Delta U$ 和 $U^{+}$ 的分量。无需四舍五入。用 $\\alpha$ 和 $\\lambda$ 的符号形式表示你的答案。", "solution": "首先验证问题，以确保其是自洽的、有科学依据且适定的。\n\n### 步骤 1：提取已知条件\n- **残差向量**：$R(U) \\equiv \\begin{bmatrix} R_{1}(T,u) \\\\ R_{2}(T,u) \\end{bmatrix} = \\begin{bmatrix} \\sin(T) + \\alpha\\, u \\\\ u^{3} - T \\end{bmatrix}$\n- **状态向量**：$U \\equiv \\begin{bmatrix} T \\\\ u \\end{bmatrix}$\n- **耦合参数**：$\\alpha \\in \\mathbb{R}$\n- **约束条件**：$\\alpha \\neq -3$\n- **当前迭代值**：$U^{(k)} = \\begin{bmatrix} T^{(k)} \\\\ u^{(k)} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$\n- **阻尼因子**：$\\lambda \\in (0,1]$\n- **任务**：计算雅可比矩阵 $J(U^{(k)})$、牛顿增量 $\\Delta U$ 和阻尼更新 $U^{+} = U^{(k)} + \\lambda\\,\\Delta U$。\n- **要求输出**：行向量 $\\big(J_{11},\\, J_{12},\\, J_{21},\\, J_{22},\\, \\Delta T,\\, \\Delta u,\\, T^{+},\\, u^{+}\\big)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是应用牛顿法求解非线性方程组的标准练习，这是数值分析和计算科学中的一个基本课题。\n- **科学/事实正确性**：该问题在数学上是合理的。它采用了既有概念：向量函数、偏导数、泰勒级数线性化和用于求根的牛顿法。\n- **适定性**：该问题是适定的。它提供了所有必要的函数、常数和初始值。约束条件 $\\alpha \\neq -3$ 至关重要，因为它确保了雅可比矩阵在给定点是可逆的，从而保证了牛顿步有唯一解。\n- **客观性**：该问题使用精确、客观的数学语言陈述。\n- **结论**：问题有效。没有缺陷。\n\n### 步骤 3：判定与行动\n问题有效。解法如下。\n\n求解方程组的牛顿法的核心是解线性系统 $J(U^{(k)}) \\Delta U = -R(U^{(k)})$，其中 $J$ 是残差向量 $R$ 的雅可比矩阵。\n\n**1. 计算雅可比矩阵**\n雅可比矩阵 $J(U)$ 是由残差向量 $R(U)$ 的所有一阶偏导数组成的矩阵。\n$$\nJ(U) = \\frac{\\partial R}{\\partial U} = \\begin{bmatrix} \\frac{\\partial R_1}{\\partial T}  \\frac{\\partial R_1}{\\partial u} \\\\ \\frac{\\partial R_2}{\\partial T}  \\frac{\\partial R_2}{\\partial u} \\end{bmatrix}\n$$\n给定 $R_1(T,u) = \\sin(T) + \\alpha u$ 和 $R_2(T,u) = u^3 - T$，偏导数为：\n- $\\frac{\\partial R_1}{\\partial T} = \\cos(T)$\n- $\\frac{\\partial R_1}{\\partial u} = \\alpha$\n- $\\frac{\\partial R_2}{\\partial T} = -1$\n- $\\frac{\\partial R_2}{\\partial u} = 3u^2$\n\n因此，雅可比矩阵为：\n$$\nJ(T,u) = \\begin{bmatrix} \\cos(T)  \\alpha \\\\ -1  3u^2 \\end{bmatrix}\n$$\n\n**2. 在当前迭代值 $U^{(k)}$ 处计算雅可比矩阵**\n我们在点 $U^{(k)} = (T^{(k)}, u^{(k)}) = (0, 1)$ 处计算 $J(T,u)$。\n$$\nJ(U^{(k)}) = J(0,1) = \\begin{bmatrix} \\cos(0)  \\alpha \\\\ -1  3(1)^2 \\end{bmatrix} = \\begin{bmatrix} 1  \\alpha \\\\ -1  3 \\end{bmatrix}\n$$\n该矩阵的各分量是最终答案的前四个元素：\n- $J_{11} = 1$\n- $J_{12} = \\alpha$\n- $J_{21} = -1$\n- $J_{22} = 3$\n\n**3. 在当前迭代值 $U^{(k)}$ 处计算残差**\n我们在点 $U^{(k)} = (0, 1)$ 处计算 $R(U)$。\n$$\nR(U^{(k)}) = R(0,1) = \\begin{bmatrix} \\sin(0) + \\alpha(1) \\\\ (1)^3 - 0 \\end{bmatrix} = \\begin{bmatrix} \\alpha \\\\ 1 \\end{bmatrix}\n$$\n\n**4. 求解牛顿增量 $\\Delta U$**\n需要求解的线性系统是 $J(U^{(k)})\\,\\Delta U = -R(U^{(k)})$，其中 $\\Delta U = \\begin{bmatrix} \\Delta T \\\\ \\Delta u \\end{bmatrix}$。\n$$\n\\begin{bmatrix} 1  \\alpha \\\\ -1  3 \\end{bmatrix} \\begin{bmatrix} \\Delta T \\\\ \\Delta u \\end{bmatrix} = -\\begin{bmatrix} \\alpha \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} -\\alpha \\\\ -1 \\end{bmatrix}\n$$\n为了求解这个 $2 \\times 2$ 系统，我们计算雅可比矩阵的逆。$J(U^{(k)})$ 的行列式为：\n$$\n\\det(J(U^{(k)})) = (1)(3) - (\\alpha)(-1) = 3 + \\alpha\n$$\n条件 $\\alpha \\neq -3$ 确保了 $\\det(J(U^{(k)})) \\neq 0$，因此该矩阵是可逆的。其逆矩阵为：\n$$\n[J(U^{(k)})]^{-1} = \\frac{1}{3+\\alpha} \\begin{bmatrix} 3  -\\alpha \\\\ 1  1 \\end{bmatrix}\n$$\n现在，我们通过在线性系统两边乘以雅可比矩阵的逆来求 $\\Delta U$：\n$$\n\\Delta U = [J(U^{(k)})]^{-1} (-R(U^{(k)})) = \\frac{1}{3+\\alpha} \\begin{bmatrix} 3  -\\alpha \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} -\\alpha \\\\ -1 \\end{bmatrix}\n$$\n执行矩阵-向量乘法：\n$$\n\\begin{bmatrix} \\Delta T \\\\ \\Delta u \\end{bmatrix} = \\frac{1}{3+\\alpha} \\begin{bmatrix} (3)(-\\alpha) + (-\\alpha)(-1) \\\\ (1)(-\\alpha) + (1)(-1) \\end{bmatrix} = \\frac{1}{3+\\alpha} \\begin{bmatrix} -3\\alpha + \\alpha \\\\ -\\alpha - 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{-2\\alpha}{3+\\alpha} \\\\ \\frac{-(\\alpha+1)}{3+\\alpha} \\end{bmatrix}\n$$\n牛顿增量的分量为：\n- $\\Delta T = \\frac{-2\\alpha}{3+\\alpha}$\n- $\\Delta u = -\\frac{\\alpha+1}{3+\\alpha}$\n\n**5. 计算阻尼更新 $U^{+}$**\n新状态 $U^{+}$ 使用阻尼更新法则计算：$U^{+} = U^{(k)} + \\lambda \\Delta U$。\n$$\nU^{+} = \\begin{bmatrix} T^{+} \\\\ u^{+} \\end{bmatrix} = \\begin{bmatrix} T^{(k)} \\\\ u^{(k)} \\end{bmatrix} + \\lambda \\begin{bmatrix} \\Delta T \\\\ \\Delta u \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} + \\lambda \\begin{bmatrix} \\frac{-2\\alpha}{3+\\alpha} \\\\ -\\frac{\\alpha+1}{3+\\alpha} \\end{bmatrix}\n$$\n更新后状态的分量为：\n- $T^{+} = 0 + \\lambda \\left( \\frac{-2\\alpha}{3+\\alpha} \\right) = \\frac{-2\\lambda\\alpha}{3+\\alpha}$\n- $u^{+} = 1 + \\lambda \\left( -\\frac{\\alpha+1}{3+\\alpha} \\right) = 1 - \\frac{\\lambda(\\alpha+1)}{3+\\alpha} = \\frac{3+\\alpha - \\lambda\\alpha - \\lambda}{3+\\alpha} = \\frac{3-\\lambda + \\alpha(1-\\lambda)}{3+\\alpha}$\n\n**6. 组合最终答案**\n最终答案是行向量 $\\big(J_{11}, J_{12}, J_{21}, J_{22}, \\Delta T, \\Delta u, T^{+}, u^{+}\\big)$。汇总所有计算出的分量：\n- $J_{11} = 1$\n- $J_{12} = \\alpha$\n- $J_{21} = -1$\n- $J_{22} = 3$\n- $\\Delta T = \\frac{-2\\alpha}{3+\\alpha}$\n- $\\Delta u = -\\frac{\\alpha+1}{3+\\alpha}$\n- $T^{+} = \\frac{-2\\lambda\\alpha}{3+\\alpha}$\n- $u^{+} = \\frac{3-\\lambda + \\alpha(1-\\lambda)}{3+\\alpha}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\alpha  -1  3  \\frac{-2\\alpha}{3+\\alpha}  -\\frac{\\alpha+1}{3+\\alpha}  \\frac{-2\\lambda\\alpha}{3+\\alpha}  \\frac{3-\\lambda + \\alpha(1-\\lambda)}{3+\\alpha} \\end{pmatrix}}\n$$", "id": "3512855"}, {"introduction": "雅可比矩阵不仅是线性化的数学工具，它更深刻地揭示了系统内部的物理耦合强度。本练习将探讨一个典型的热化学反应源项，通过推导其雅可比矩阵，你将分析一个看似无害的物理参数如何能够指数级地放大耦合效应，从而引发数值刚性并挑战求解器的性能极限[@problem_id:3512914]。", "problem": "考虑一个耦合了能量方程和组分守恒方程的热化学多物理场模型，其中局部反应源项由作用于状态向量 $U = \\begin{bmatrix} T \\\\ u \\end{bmatrix}$ 的向量值函数 $S(U)$ 表示，$T$ 表示温度，$u$ 表示组分浓度。设\n$$\nS(U) = \\begin{bmatrix} \\lambda T^{2} u \\\\ \\mu \\exp(\\alpha T) \\end{bmatrix},\n$$\n其中 $\\lambda$、$\\mu$ 和 $\\alpha$ 是正常数。该非线性系统使用全隐式格式进行时间推进，并在每个时间步使用 Newton-Raphson (NR) 方法求解，其中线性化更新依赖于 $S(U)$ 关于 $U$ 的雅可比矩阵。\n\n从一阶线性化的雅可比矩阵定义出发，即对于一个微扰 $\\delta U$，有\n$$\nS(U + \\delta U) \\approx S(U) + J(U) \\, \\delta U,\n$$\n其中 $J(U)$ 是雅可比矩阵，其元素为 $J_{ij}(U) = \\frac{\\partial S_i}{\\partial U_j}$，在当前迭代点进行计算。请完成以下任务：\n\n- 推导雅可比矩阵 $J(U)$ 关于 $T$ 和 $u$ 的所有元素。\n- 基于推导出的雅可比矩阵，解释增加 $\\alpha$ 如何影响 Newton-Krylov 求解器（例如，Krylov 子空间方法中的广义最小残差法 GMRES）的鲁棒性，包括对条件数、步长选择和预处理策略的影响。\n\n报告雅可比矩阵 $J(U)$ 的行列式的符号表达式，用 $\\lambda$、$\\mu$、$\\alpha$、$T$ 和 $u$ 表示，作为你的最终答案。无需进行数值计算。如果在中间步骤中进行了任何近似，请明确说明并给出理由。将最终的行列式表示为闭式解析表达式，并且最终报告的表达式中不包含任何单位。", "solution": "问题陈述需要经过验证。\n\n### 步骤 1：提取已知条件\n- 状态向量：$U = \\begin{bmatrix} T \\\\ u \\end{bmatrix}$，$T$ 表示温度，$u$ 表示组分浓度。\n- 向量值反应源项函数：$S(U) = \\begin{bmatrix} \\lambda T^{2} u \\\\ \\mu \\exp(\\alpha T) \\end{bmatrix}$。\n- 参数：$\\lambda$、$\\mu$ 和 $\\alpha$ 是正常数。\n- 数值背景：系统使用全隐式时间格式和 Newton-Raphson (NR) 方法求解。\n- 源项的线性化：$S(U + \\delta U) \\approx S(U) + J(U) \\, \\delta U$。\n- 雅可比矩阵的定义：$J_{ij}(U) = \\frac{\\partial S_i}{\\partial U_j}$。\n- 任务 1：推导雅可比矩阵 $J(U)$ 的所有元素。\n- 任务 2：解释增加 $\\alpha$ 如何影响 Newton-Krylov 求解器的鲁棒性。\n- 任务 3：报告雅可比矩阵的行列式 $\\det(J(U))$ 作为最终答案。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上是合理的，提出了一个简化但概念上有效的耦合热化学现象模型。源项的形式虽然不是从第一性原理推导出来的，但却是反应动力学的合理解释。其数学任务——推导雅可比矩阵、其行列式，并在数值方法（Newton-Krylov 求解器）的背景下分析其性质——是计算科学与工程中的一个标准且适定的练习。问题是自洽的，提供了所有必要信息。语言客观而精确。未检测到科学、逻辑或结构上的缺陷。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将提供完整解答。\n\n### 解答推导\n\n分析始于定义状态向量 $U$ 和源向量 $S(U)$ 的分量。状态向量为 $U = \\begin{bmatrix} U_1 \\\\ U_2 \\end{bmatrix} = \\begin{bmatrix} T \\\\ u \\end{bmatrix}$。源函数为 $S(U) = \\begin{bmatrix} S_1(T, u) \\\\ S_2(T, u) \\end{bmatrix}$，其分量为：\n$$\nS_1(T, u) = \\lambda T^{2} u\n$$\n$$\nS_2(T, u) = \\mu \\exp(\\alpha T)\n$$\n\n### 任务 1：雅可比矩阵 $J(U)$ 的推导\n源项 $S(U)$ 关于状态向量 $U$ 的雅可比矩阵 $J(U)$ 是一个 $2 \\times 2$ 矩阵，其元素是 $S$ 的分量关于 $U$ 的分量的偏导数。\n$$\nJ(U) = \\begin{pmatrix} \\frac{\\partial S_1}{\\partial T}  \\frac{\\partial S_1}{\\partial u} \\\\ \\frac{\\partial S_2}{\\partial T}  \\frac{\\partial S_2}{\\partial u} \\end{pmatrix}\n$$\n我们计算每个元素：\n1.  $S_1$ 关于 $T$ 的偏导数：\n    $$\n    J_{11} = \\frac{\\partial S_1}{\\partial T} = \\frac{\\partial}{\\partial T} (\\lambda T^{2} u) = 2 \\lambda T u\n    $$\n2.  $S_1$ 关于 $u$ 的偏导数：\n    $$\n    J_{12} = \\frac{\\partial S_1}{\\partial u} = \\frac{\\partial}{\\partial u} (\\lambda T^{2} u) = \\lambda T^{2}\n    $$\n3.  $S_2$ 关于 $T$ 的偏导数：\n    $$\n    J_{21} = \\frac{\\partial S_2}{\\partial T} = \\frac{\\partial}{\\partial T} (\\mu \\exp(\\alpha T)) = \\mu \\alpha \\exp(\\alpha T)\n    $$\n4.  $S_2$ 关于 $u$ 的偏导数：\n    $$\n    J_{22} = \\frac{\\partial S_2}{\\partial u} = \\frac{\\partial}{\\partial u} (\\mu \\exp(\\alpha T)) = 0\n    $$\n将这些元素组合起来得到雅可比矩阵：\n$$\nJ(U) = \\begin{pmatrix} 2 \\lambda T u  \\lambda T^{2} \\\\ \\mu \\alpha \\exp(\\alpha T)  0 \\end{pmatrix}\n$$\n\n### 任务 2：增加 $\\alpha$ 对求解器鲁棒性的影响\n对于形式为 $\\frac{\\partial U}{\\partial t} + \\nabla \\cdot F(U) = S(U)$ 的偏微分方程组，隐式时间步长格式会在每个时间步产生一个非线性代数方程组，可写作 $R(U^{n+1}) = 0$。Newton-Raphson 方法通过迭代求解线性系统 $\\mathcal{J}(U^k) \\delta U = -R(U^k)$ 来找到更新量 $\\delta U$，其中 $\\mathcal{J}$ 是整个系统的雅可比矩阵，$U^k$ 是当前迭代。源项雅可比矩阵 $J(U)$ 是该系统雅可比矩阵的一个组成部分，通常表现为 $\\mathcal{J} = A - J(U^k)$，其中 $A$ 包含了时间和空间离散化项。\n\nNewton-Krylov 求解器使用 Krylov 子空间方法（如 GMRES）来求解 $\\delta U$ 的线性系统，其鲁棒性关键取决于矩阵 $\\mathcal{J}$ 的性质。参数 $\\alpha$ 通过项 $J_{21} = \\mu \\alpha \\exp(\\alpha T)$ 影响这些性质。\n\n1.  **刚性与病态问题**：随着 $\\alpha$ 的增加，假设 $T > 0$，项 $J_{21}$ 会呈指数级增长。这在源项雅可比矩阵中引入了一个非常大的非对角项。矩阵元素数量级上的巨大差异是导致病态问题的主要原因。系统雅可比矩阵 $\\mathcal{J}$ 的条件数，记为 $\\kappa(\\mathcal{J})$，将急剧增加。像 GMRES 这样的 Krylov 求解器，其收敛速率会随着条件数的增加而显著下降。因此，更大的 $\\alpha$ 会导致每个牛顿步需要更多的 GMRES 迭代次数，或者完全无法收敛。这种现象是“刚性”系统的特征，其中不同的物理过程在截然不同的尺度上运作。在这里，对温度的指数依赖性使得组分源项对温度的微小变化极为敏感，从而产生数值刚性。\n\n2.  **牛顿步的质量与收敛性**：Newton-Raphson 方法依赖于线性近似 $S(U + \\delta U) \\approx S(U) + J(U) \\delta U$ 在一定半径内是准确的。当二阶导数（Hessian 项）很大时，这种线性近似会更快地失效。项 $\\mu \\alpha \\exp(\\alpha T)$ 关于 $T$ 的二阶导数为 $\\mu \\alpha^2 \\exp(\\alpha T)$，它随 $\\alpha$ 增长得更快。这意味着线性模型是一个较差的近似，计算出的牛顿步 $\\delta U$ 可能过大，“过冲”解，导致牛顿迭代发散。鲁棒的实现必须包含全局化策略，如线搜索或信赖域，随着 $\\alpha$ 的增加，这些策略将被迫采取越来越小的步长，从而严重减慢非线性系统解的收敛速度。\n\n3.  **预处理策略**：对于病态系统，预处理至关重要。预处理器 $P$ 旨在将线性系统转换为一个等价的系统，例如 $P^{-1} \\mathcal{J} \\delta U = -P^{-1} R$，其中矩阵 $P^{-1} \\mathcal{J}$ 的条件性更好。从温度 $T$ 到组分 $u$ 的强单向耦合（体现在大的 $J_{21}$ 项和与此耦合强度无关的 $J_{12}$ 项）使得设计一个有效且计算成本低的预处理器变得非常困难。标准的通用预处理器（如不完全 LU 分解）可能无法捕捉这种强耦合，因此几乎没有好处。针对大 $\\alpha$ 的有效预处理可能需要一种复杂的、基于物理的方法，该方法能正确近似雅可比矩阵内的块结构和耦合，这会给求解器增加显著的复杂性。\n\n总之，增加 $\\alpha$ 会通过引发刚性、导致线性系统极端病态、降低牛顿线性模型的质量以及要求更复杂和昂贵的预处理，从而严重降低 Newton-Krylov 求解器的鲁棒性。\n\n### 任务 3：雅可比矩阵的行列式\n一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$ 的行列式由公式 $ad - bc$ 给出。将此公式应用于推导出的雅可bi矩阵 $J(U)$：\n$$\nJ(U) = \\begin{pmatrix} 2 \\lambda T u  \\lambda T^{2} \\\\ \\mu \\alpha \\exp(\\alpha T)  0 \\end{pmatrix}\n$$\n行列式为：\n$$\n\\det(J(U)) = (2 \\lambda T u)(0) - (\\lambda T^{2})(\\mu \\alpha \\exp(\\alpha T))\n$$\n$$\n\\det(J(U)) = 0 - \\lambda \\mu \\alpha T^{2} \\exp(\\alpha T)\n$$\n$$\n\\det(J(U)) = - \\lambda \\mu \\alpha T^{2} \\exp(\\alpha T)\n$$\n这是行列式的最终闭式解析表达式。", "answer": "$$\\boxed{-\\lambda \\mu \\alpha T^{2} \\exp(\\alpha T)}$$", "id": "3512914"}, {"introduction": "在仿真代码开发中，确保雅可比矩阵的正确性是成功实现牛顿法的关键，但这一步也极易出错。本练习介绍了一种强大的验证技术——“雅可比-向量积”的有限差分检验，它是在无需形成整个矩阵的情况下验证代码的实用方法。你将探索此方法背后的误差分析，理解如何通过选择最佳步长来平衡截断误差和舍入误差，这是编写稳健数值代码的一项核心技能[@problem_id:3512976]。", "problem": "考虑一个耦合多物理场残差映射 $R:\\mathbb{R}^n \\to \\mathbb{R}^n$，它依赖于状态 $u \\in \\mathbb{R}^n$，其中 $u$ 被分块为 $u = [u_f; u_s]$，分别对应流体和结构子系统。令 $J(u) = \\partial R/\\partial u$ 表示雅可比矩阵。假设一个解析或基于自动微分（AD）的雅可比-向量积 $J(u)v$ 是可用的，并且您希望在给定状态 $u$、测试方向 $v \\in \\mathbb{R}^n$ 和标量步长 $h \\in \\mathbb{R}$ 的情况下，使用方向有限差分检验来验证其正确性。定义前向差分方向近似为\n$$\nd_h(v) \\equiv \\frac{R(u + h v) - R(u)}{h}.\n$$\n您将使用相对差异度量\n$$\nE(h,v) \\equiv \\frac{\\lVert J(u)v - d_h(v) \\rVert}{\\lVert J(u)v \\rVert + \\lVert d_h(v) \\rVert}\n$$\n来比较 $d_h(v)$ 和 $J(u)v$。\n假设以下基本模型：\n- 对于 $R(u + h v)$，使用带余项的泰勒定理，其导数在 $u$ 的一个邻域内是连续的。\n- 标准浮点模型：每个计算出的残差值 $\\widehat{R}(w)$ 满足 $\\widehat{R}(w) = R(w)\\,(1 + \\delta(w))$，其中分量级扰动以 $\\lvert \\delta(w)_i \\rvert \\le \\varepsilon_{\\mathrm{mach}}$ 为界，$\\varepsilon_{\\mathrm{mach}}$ 是机器 epsilon，并且算术运算受到类似的相对舍入效应的影响。\n\n在设计和解释耦合系统中的此类雅可比矩阵验证测试时，以下哪些陈述是正确的？\n\nA) 对于前向差分 $d_h(v)$，截断误差的阶为 $\\mathcal{O}(h)$，由舍入引起的差商误差的阶为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$ 乘以一个与问题相关的量级（例如，$R$ 的范数）。平衡这些项意味着最优步长的阶为 $h \\sim \\sqrt{\\varepsilon_{\\mathrm{mach}}}$，不计及涉及 $R$、$J$、更高阶导数和 $v$ 的缩放的与问题相关的因子。\n\nB) 如果改用中心差分方向公式 $(R(u+h v)-R(u-h v))/(2h)$，则截断误差为 $\\mathcal{O}(h^2)$，由舍入引起的误差为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$，导致最优步长的阶为 $h \\sim \\varepsilon_{\\mathrm{mach}}^{1/2}$。\n\nC) 在一个具有分块雅可比矩阵\n$$\nJ(u) = \\begin{bmatrix} J_{ff}(u)  J_{fs}(u) \\\\ J_{sf}(u)  J_{ss}(u) \\end{bmatrix}, \\quad u = \\begin{bmatrix} u_f \\\\ u_s \\end{bmatrix}\n$$\n的耦合分块系统中，选择方向 $v = [0; v_s]$ 可在流体残差变化中隔离非对角块 $J_{fs}(u)$ 的影响：当 $h \\to 0$ 时，$d_h(v)$ 的流体分块收敛于 $J_{fs}(u)\\,v_s$，因此这类方向可以检测出缺失或不正确的交叉耦合项。\n\nD) 在前向差分中，减小 $h$ 总是会减小 $E(h,v)$，因为当 $h \\to 0$ 时，有限差分是 $J(u)v$ 的一致近似。\n\nE) 为了在具有不同单位和量级的异构场之间平衡扰动，同时保持方向导数的意义，建议在应用单个标量步长 $h$ 之前，在加权范数中归一化 $v$。例如，选择一个缩放向量 $s$，其分量为 $s_j = \\max(\\lvert u_j \\rvert, 1)$，构造 $\\widetilde{v} = (v \\odot s)/\\lVert v \\odot s \\rVert$，然后在前向差分中使用 $d_h(\\widetilde{v})$，步长为 $h \\approx c\\,\\sqrt{\\varepsilon_{\\mathrm{mach}}}$（其中 $c$ 是一个 1 阶常数），这有助于平衡各分量上的截断和舍入效应。\n\n选择所有适用项。", "solution": "该问题陈述是数值分析中一个有效的、适定的问题，具体涉及非线性系统雅可比矩阵的验证，这是科学计算和多物理场模拟中的一项常见任务。所提供的泰勒定理和浮点运算法则模型是此类分析的标准。我们将逐一评估每个选项。\n\n**A) 对于前向差分 $d_h(v)$，截断误差的阶为 $\\mathcal{O}(h)$，由舍入引起的差商误差的阶为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$ 乘以一个与问题相关的量级（例如，$R$ 的范数）。平衡这些项意味着最优步长的阶为 $h \\sim \\sqrt{\\varepsilon_{\\mathrm{mach}}}$，不计及涉及 $R$、$J$、更高阶导数和 $v$ 的缩放的与问题相关的因子。**\n\n我们来分析前向差分近似 $d_h(v) = (R(u + h v) - R(u))/h$ 中的误差。\n\n1.  **截断误差**：假设残差映射 $R$ 在 $u$ 的邻域内至少是二次连续可微的（$C^2$），我们可以使用泰勒定理：\n    $$R(u + h v) = R(u) + h J(u)v + \\frac{h^2}{2} R''(u)(v,v) + \\mathcal{O}(h^3)$$\n    其中 $R''(u)(v,v)$ 表示二阶导数张量在方向 $v$ 上的作用。\n    将此代入 $d_h(v)$ 的定义中：\n    $$d_h(v) = \\frac{(R(u) + h J(u)v + \\frac{h^2}{2} R''(u)(v,v) + \\mathcal{O}(h^3)) - R(u)}{h} = J(u)v + \\frac{h}{2} R''(u)(v,v) + \\mathcal{O}(h^2)$$\n    截断误差是精确方向导数与此近似值之间的差：\n    $$J(u)v - d_h(v) = -\\frac{h}{2} R''(u)(v,v) - \\mathcal{O}(h^2)$$\n    因此，截断误差的范数为 $\\lVert J(u)v - d_h(v) \\rVert = \\mathcal{O}(h)$。陈述的第一部分是正确的。\n\n2.  **舍入误差**：在浮点运算中，计算出的残差为 $\\widehat{R}(u) \\approx R(u)$ 和 $\\widehat{R}(u+hv) \\approx R(u+hv)$。给定模型指出，计算出的分子 $\\widehat{R}(u+hv) - \\widehat{R}(u)$ 的绝对误差大约为 $(\\lVert R(u+hv) \\rVert + \\lVert R(u) \\rVert)\\varepsilon_{\\mathrm{mach}}$，这是由于对于小 $h$，$R(u+hv) \\approx R(u)$ 导致了灾难性抵消。这个误差大约是 $2\\lVert R(u) \\rVert \\varepsilon_{\\mathrm{mach}}$。当这个误差除以 $h$ 时，计算出的 $d_h(v)$ 中的最终误差量级为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$。该陈述称此误差的阶为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$ 乘以一个与问题相关的量级（如 $\\lVert R(u) \\rVert$），这是正确的。\n\n3.  **最优步长**：总误差大小可以建模为截断误差大小和舍入误差大小之和：\n    $$E_{\\text{total}}(h) \\approx C_1 h + C_2 \\frac{\\varepsilon_{\\mathrm{mach}}}{h}$$\n    其中 $C_1$ 依赖于 $R$ 的二阶导数，$C_2$ 依赖于 $R$ 的量级。为了找到使该误差最小化的步长 $h$，我们对 $h$ 求导并将结果设为零：\n    $$\\frac{dE_{\\text{total}}}{dh} = C_1 - C_2 \\frac{\\varepsilon_{\\mathrm{mach}}}{h^2} = 0 \\implies h^2 = \\frac{C_2}{C_1} \\varepsilon_{\\mathrm{mach}}$$\n    这给出了最优步长的阶为 $h_{\\text{opt}} \\sim \\sqrt{\\varepsilon_{\\mathrm{mach}}}$，比例常数取决于具体问题相关的因子（$R$、$J$、更高阶导数、$v$）。\n\n该陈述是对有限精度运算中前向差分方法经典分析的完整而准确的总结。\n**结论：正确。**\n\n**B) 如果改用中心差分方向公式 $(R(u+h v)-R(u-h v))/(2h)$，则截断误差为 $\\mathcal{O}(h^2)$，由舍入引起的误差为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$，导致最优步长的阶为 $h \\sim \\varepsilon_{\\mathrm{mach}}^{1/2}$。**\n\n我们来分析中心差分公式。\n\n1.  **截断误差**：假设 $R$ 是 $C^3$ 的，我们对 $R(u+hv)$ 和 $R(u-hv)$ 使用泰勒级数：\n    $$R(u \\pm hv) = R(u) \\pm h J(u)v + \\frac{h^2}{2} R''(u)(v,v) \\pm \\frac{h^3}{6} R'''(u)(v,v,v) + \\mathcal{O}(h^4)$$\n    将两个展开式相减得到：\n    $$R(u+hv) - R(u-hv) = 2h J(u)v + \\frac{h^3}{3} R'''(u)(v,v,v) + \\mathcal{O}(h^5)$$\n    除以 $2h$：\n    $$\\frac{R(u+hv) - R(u-hv)}{2h} = J(u)v + \\frac{h^2}{6} R'''(u)(v,v,v) + \\mathcal{O}(h^4)$$\n    截断误差的阶为 $\\mathcal{O}(h^2)$。陈述的这一部分是正确的。\n\n2.  **舍入误差**：舍入误差的分析与前向差分情况相同。它源于减法 $R(u+hv) - R(u-hv)$ 中的灾难性抵消，并随后被除以小参数 $h$ 而放大。因此，舍入误差的阶为 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$。这一部分也是正确的。\n\n3.  **最优步长**：总误差大小建模为：\n    $$E_{\\text{total}}(h) \\approx C_1' h^2 + C_2' \\frac{\\varepsilon_{\\mathrm{mach}}}{h}$$\n    对 $h$ 进行最小化：\n    $$\\frac{dE_{\\text{total}}}{dh} = 2C_1' h - C_2' \\frac{\\varepsilon_{\\mathrm{mach}}}{h^2} = 0 \\implies h^3 = \\frac{C_2'}{2C_1'} \\varepsilon_{\\mathrm{mach}}$$\n    这给出了最优步长的阶为 $h_{\\text{opt}} \\sim \\varepsilon_{\\mathrm{mach}}^{1/3}$。陈述声称阶为 $h \\sim \\varepsilon_{\\mathrm{mach}}^{1/2}$，这是不正确的。\n\n**结论：不正确。**\n\n**C) 在一个具有分块雅可比矩阵 $J(u) = \\begin{bmatrix} J_{ff}(u)  J_{fs}(u) \\\\ J_{sf}(u)  J_{ss}(u) \\end{bmatrix}, u = \\begin{bmatrix} u_f \\\\ u_s \\end{bmatrix}$ 的耦合分块系统中，选择方向 $v = [0; v_s]$ 可在流体残差变化中隔离非对角块 $J_{fs}(u)$ 的影响：当 $h \\to 0$ 时，$d_h(v)$ 的流体分块收敛于 $J_{fs}(u)\\,v_s$，因此这类方向可以检测出缺失或不正确的交叉耦合项。**\n\n设残差也分块为 $R(u) = \\begin{bmatrix} R_f(u_f, u_s) \\\\ R_s(u_f, u_s) \\end{bmatrix}$。给定测试方向 $v = \\begin{bmatrix} 0 \\\\ v_s \\end{bmatrix}$，扰动后的状态为 $u+hv = \\begin{bmatrix} u_f \\\\ u_s + hv_s \\end{bmatrix}$。\n\n前向差分近似为 $d_h(v) = \\frac{1}{h}(R(u+hv) - R(u))$。我们来考察它的流体分块，我们记为 $(d_h(v))_f$：\n$$(d_h(v))_f = \\frac{R_f(u_f, u_s + hv_s) - R_f(u_f, u_s)}{h}$$\n根据偏导数（或方向 Gâteaux 导数）的定义，当 $h \\to 0$ 时，此表达式收敛到 $R_f$ 关于 $u_s$ 在方向 $v_s$ 上的方向导数。这恰好是雅可比分块 $J_{fs}(u) = \\partial R_f / \\partial u_s$ 对向量 $v_s$ 的作用。\n$$\\lim_{h \\to 0} (d_h(v))_f = \\frac{\\partial R_f}{\\partial u_s}(u) v_s = J_{fs}(u)v_s$$\n对于这个方向，解析雅可比-向量积为 $J(u)v = \\begin{bmatrix} J_{ff}  J_{fs} \\\\ J_{sf}  J_{ss} \\end{bmatrix} \\begin{bmatrix} 0 \\\\ v_s \\end{bmatrix} = \\begin{bmatrix} J_{fs} v_s \\\\ J_{ss} v_s \\end{bmatrix}$。\n\n因此，对残差流体部分的比较，就是将数值近似 $(d_h(v))_f$ 与解析结果 $(J(u)v)_f = J_{fs}(u)v_s$ 进行比较。这个测试确实对耦合块 $J_{fs}$ 实现中的错误特别敏感。选择这样的方向（以及类似地，选择形式为 $v = [v_f; 0]$ 的方向来测试 $J_f$ 和 $J_{sf}$）是调试耦合系统雅可比矩阵的标准且关键的技术。\n**结论：正确。**\n\n**D) 在前向差分中，减小 $h$ 总是会减小 $E(h,v)$，因为当 $h \\to 0$ 时，有限差分是 $J(u)v$ 的一致近似。**\n\n这个陈述是错误的。正如在选项 A 的分析中确立的，在浮点运算中，有限差分近似的总误差是两种相互竞争效应的组合：一个随 $h$ 减小而减小的截断误差（例如 $\\mathcal{O}(h)$）和一个随 $h$ 减小而增大的舍入误差（例如 $\\mathcal{O}(\\varepsilon_{\\mathrm{mach}}/h)$）。\n虽然对于大的 $h$ 值（截断误差占主导地位），减小 $h$ 确实会减小总误差 $E(h,v)$，但存在一个最优步长 $h_{\\text{opt}}$。对于 $h  h_{\\text{opt}}$，舍入误差项占主导地位，进一步减小 $h$ 会导致总误差增加。一致性属性指的是精确算术中的数学极限，而不是考虑了舍入误差的有限精度计算中的行为。“总是”一词使得该陈述绝对不正确。\n**结论：不正确。**\n\n**E) 为了在具有不同单位和量级的异构场之间平衡扰动，同时保持方向导数的意义，建议在应用单个标量步长 $h$ 之前，在加权范数中归一化 $v$。例如，选择一个缩放向量 $s$，其分量为 $s_j = \\max(\\lvert u_j \\rvert, 1)$，构造 $\\widetilde{v} = (v \\odot s)/\\lVert v \\odot s \\rVert$，然后在前向差分中使用 $d_h(\\widetilde{v})$，步长为 $h \\approx c\\,\\sqrt{\\varepsilon_{\\mathrm{mach}}}$（其中 $c$ 是一个 1 阶常数），这有助于平衡各分量上的截断和舍入效应。**\n\n这个陈述描述了一种对具有异构尺度状态变量的函数进行数值微分的标准且强烈推荐的最佳实践。\n\n1.  **缩放**：多物理场问题中的状态向量 $u$ 通常包含具有不同单位和差异巨大数量级的组分（例如，温度单位为开尔文，压力单位为帕斯卡，位移单位为米）。一个简单的扰动 $hv$ 可能对某些分量而言过大，而对另一些分量则小到无意义。所提出的缩放方法，即使用分量级缩放因子 $s_j = \\max(\\lvert u_j \\rvert, 1)$ 将扰动向量 $v$ 转换为 $\\widetilde{v}$，确保了扰动 $h\\widetilde{v}$ 对于 $u$ 的所有非零分量都具有可比较的相对量级。$\\max(\\lvert u_j \\rvert, 1)$ 这一项是处理大数量级以及零或近零状态分量的一种稳健方法。归一化缩放后的向量使得扰动的总大小与 $v$ 的选择无关。这是进行有意义测试的关键一步。\n\n2.  **步长**：该陈述随后建议使用步长 $h \\approx c\\sqrt{\\varepsilon_{\\mathrm{mach}}}$，其中 $c$ 是一个 $\\mathcal{O}(1)$ 的常数。正如在选项 A 的分析中所示，$h \\sim \\sqrt{\\varepsilon_{\\mathrm{mach}}}$ 是平衡前向差分方案中截断误差和舍入误差的最优步长阶。\n\n将这两种技术——恰当缩放扰动方向和近最优选择步长——结合起来，构成了一种稳健且理论上合理的雅可比矩阵验证方法论。该陈述准确地描述了这一过程及其基本原理。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "3512976"}]}