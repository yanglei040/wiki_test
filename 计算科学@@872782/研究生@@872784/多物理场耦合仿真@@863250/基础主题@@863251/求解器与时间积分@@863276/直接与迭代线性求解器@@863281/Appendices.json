{"hands_on_practices": [{"introduction": "在求解由多物理场耦合问题产生的线性系统时，我们遇到的最理想情况之一是系统矩阵为对称正定（SPD）矩阵。对于这类系统，Cholesky 分解是一种极其高效且数值稳定的直接求解方法。本练习 [@problem_id:3503388] 将通过一个具体的 $2 \\times 2$ 算例，引导您手动执行 Cholesky 分解 ($A = L L^{\\top}$)，并通过前向和后向替换求解线性系统，从而加深对该方法的理解。", "problem": "一个双场多物理场模型的整体隐式时间积分将线性各向同性热传导与线性弹性小应变力学耦合。在牛顿迭代步上对弱形式进行线性化，会产生一个用于增量更新的对称正定（SPD）线性系统，其中系统矩阵源于凸能量泛函的Hessian矩阵。在一个对应于舒尔补凝聚界面的简化双自由度设置中，线性系统为 $A x = b$，其中\n$$\nA = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}, \\quad b = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}.\n$$\n从对称正定性的定义以及对称正定矩阵存在Cholesky分解出发，将 $A$ 分解为 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素为严格正数的下三角矩阵，并使用前向和后向代入法求解 $x$。在适当的情况下，用根式精确表示所有中间量，并明确报告最终解向量 $x$。无需四舍五入。将最终的 $x$ 以行向量的形式给出。", "solution": "在尝试任何解法之前，需对问题进行验证。\n\n**第1步：提取已知条件**\n- 背景是双场多物理场（热-力）模型的整体隐式时间积分。\n- 得到的线性系统是对称正定（SPD）的。\n- 线性系统由 $A x = b$ 给出。\n- 系统矩阵为 $A = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}$。\n- 右端向量为 $b = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}$。\n- 任务是将 $A$ 分解为 $A = L L^{\\top}$，其中 $L$ 是一个对角线元素为严格正数的下三角矩阵。\n- 指定的求解方法是使用Cholesky因子进行前向和后向代入。\n- 所有中间量和最终量都必须精确表示。\n- 最终解向量 $x$ 应以行向量的形式报告。\n\n**第2步：使用提取的已知条件进行验证**\n该问题是适定的且具有科学依据。\n1.  **科学合理性**：该问题描述了计算力学中的一个标准过程，其中基于凸能量泛函的变分问题的线性化导致一个对称正定（SPD）的线性系统。我们验证给定矩阵 $A$ 的SPD性质。\n    -   对称性：矩阵 $A$ 是对称的，因为 $A_{12} = A_{21} = 2$。\n    -   正定性：我们检查顺序主子式。第一个主子式是 $\\det([4]) = 4  0$。第二个主子式是 $\\det(A) = (4)(3) - (2)(2) = 12 - 4 = 8  0$。由于所有顺序主子式都为正，矩阵 $A$ 确实是正定的。\n2.  **适定性**：由于 $A$ 是SPD矩阵，它是非奇异的（$\\det(A) \\neq 0$），这保证了系统 $A x = b$ 存在唯一解 $x$。实SPD矩阵的Cholesky分解是唯一的，确保了明确的求解路径。\n3.  **完整性**：所有必要的分量（$A$ 和 $b$）都已提供。指令清晰明确。\n\n**第3步：结论与行动**\n问题有效。将制定完整的解决方案。\n\n该问题要求使用Cholesky分解来求解线性系统 $A x = b$。给定矩阵 $A$ 是对称且正定的，这保证了存在一个唯一的、对角线元素为严格正数的下三角矩阵 $L$，使得 $A = L L^{\\top}$。\n\n待求解的系统是：\n$$\n\\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}\n$$\n\n首先，我们计算Cholesky分解 $A = L L^{\\top}$。设下三角矩阵 $L$ 为\n$$\nL = \\begin{bmatrix} L_{11}  0 \\\\ L_{21}  L_{22} \\end{bmatrix}\n$$\n其中 $L_{11}  0$ 且 $L_{22}  0$。\n\n那么 $L L^{\\top}$ 是：\n$$\nL L^{\\top} = \\begin{bmatrix} L_{11}  0 \\\\ L_{21}  L_{22} \\end{bmatrix} \\begin{bmatrix} L_{11}  L_{21} \\\\ 0  L_{22} \\end{bmatrix} = \\begin{bmatrix} L_{11}^2  L_{11}L_{21} \\\\ L_{21}L_{11}  L_{21}^2 + L_{22}^2 \\end{bmatrix}\n$$\n将 $L L^{\\top}$ 的分量与 $A$ 的分量相等：\n$$\n\\begin{bmatrix} L_{11}^2  L_{11}L_{21} \\\\ L_{21}L_{11}  L_{21}^2 + L_{22}^2 \\end{bmatrix} = \\begin{bmatrix} 4  2 \\\\ 2  3 \\end{bmatrix}\n$$\n我们依次求解 $L$ 的元素：\n1.  从 (1,1) 元素：$L_{11}^2 = 4$。由于 $L_{11}$ 必须为正，所以 $L_{11} = 2$。\n2.  从 (2,1) 元素：$L_{21}L_{11} = 2$。代入 $L_{11}=2$，我们得到 $2 L_{21} = 2$，解得 $L_{21} = 1$。\n3.  从 (2,2) 元素：$L_{21}^2 + L_{22}^2 = 3$。代入 $L_{21}=1$，我们得到 $1^2 + L_{22}^2 = 3$，所以 $L_{22}^2 = 2$。由于 $L_{22}$ 必须为正，所以 $L_{22} = \\sqrt{2}$。\n\n因此，Cholesky因子 $L$ 是：\n$$\nL = \\begin{bmatrix} 2  0 \\\\ 1  \\sqrt{2} \\end{bmatrix}\n$$\n原始系统 $A x = b$ 现在被重写为 $L L^{\\top} x = b$。这可以通过两个步骤求解：\n1.  求解 $L y = b$ 以得到中间向量 $y$（前向代入）。\n2.  求解 $L^{\\top} x = y$ 以得到最终解向量 $x$（后向代入）。\n\n**第1步：前向代入**\n我们求解系统 $L y = b$：\n$$\n\\begin{bmatrix} 2  0 \\\\ 1  \\sqrt{2} \\end{bmatrix} \\begin{bmatrix} y_1 \\\\ y_2 \\end{bmatrix} = \\begin{bmatrix} 6 \\\\ 5 \\end{bmatrix}\n$$\n从第一行：\n$$\n2 y_1 = 6 \\implies y_1 = 3\n$$\n从第二行：\n$$\ny_1 + \\sqrt{2} y_2 = 5\n$$\n代入 $y_1=3$：\n$$\n3 + \\sqrt{2} y_2 = 5 \\implies \\sqrt{2} y_2 = 2 \\implies y_2 = \\frac{2}{\\sqrt{2}} = \\sqrt{2}\n$$\n中间向量是 $y = \\begin{bmatrix} 3 \\\\ \\sqrt{2} \\end{bmatrix}$。\n\n**第2步：后向代入**\n我们求解系统 $L^{\\top} x = y$：\n$$\n\\begin{bmatrix} 2  1 \\\\ 0  \\sqrt{2} \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ \\sqrt{2} \\end{bmatrix}\n$$\n从第二行（从最后一个变量开始反向求解）：\n$$\n\\sqrt{2} x_2 = \\sqrt{2} \\implies x_2 = 1\n$$\n从第一行：\n$$\n2 x_1 + x_2 = 3\n$$\n代入 $x_2=1$：\n$$\n2 x_1 + 1 = 3 \\implies 2 x_1 = 2 \\implies x_1 = 1\n$$\n解向量是 $x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n按照要求，最终解以行向量的形式报告。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1 \\end{pmatrix}}\n$$", "id": "3503388"}, {"introduction": "然而，在更复杂的耦合模拟中，系统矩阵虽然对称，但可能不是正定的，甚至是“不定”的，这使得标准 Cholesky 分解不再适用。本练习 [@problem_id:3503367] 旨在揭示这种情况下的挑战，并介绍一种更为通用的直接求解方法——带对称置换的 $LDL^T$ 分解。通过处理一个含有零对角元的矩阵，您将亲身体验为何需要“置换”（pivoting）以及该稳健分解过程 ($P^{T} A P = L D L^{T}$) 如何进行。", "problem": "在单体多物理场耦合模拟中，线性化过程通常会产生用于耦合增量的对称但不定雅可比块。考虑简化的 $2 \\times 2$ 对称系统\n$$\nA \\, \\mathbf{u} = \\mathbf{b}, \\quad A = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix},\n$$\n该系统是双场耦合的简化模型，其中非对角线项编码了物理场间的耦合。你需要运用直接求解器的第一性原理来分析该系统的求解器选择。\n\n任务：\n1. 从对称正定性 (SPD) 的定义出发，即对称矩阵 $A$ 是 SPD 的充要条件是对于所有非零向量 $\\mathbf{x}$ 都有 $\\mathbf{x}^{T} A \\mathbf{x}  0$，或者等价地，所有主子式都为正。请说明为什么标准的 Cholesky 分解（要求 SPD）对矩阵 $A$ 不适用。\n2. 使用对称不定分解的定义，构造一个带有对称主元选择的显式下三角-对角-下三角转置 (LDL$^{T}$) 分解。即，找到一个置换矩阵 $P$、一个单位下三角矩阵 $L$（对角线元素为1）以及一个具有 $1 \\times 1$ 块的块对角矩阵 $D$，使得\n$$\nP^{T} A P = L D L^{T}.\n$$\n通过手动方式显式地进行分解，并展示基于带对称置换的高斯消元法的所有中间步骤。\n\n将从你的分解中得到的 $D$ 的 $(1,1)$ 对角线元素的值作为最终答案。无需四舍五入。请以纯数字形式提供最终答案，不带单位。", "solution": "问题要求分析给定 $2 \\times 2$ 对称不定矩阵 $A$ 的求解器选择，具体方法是证明 Cholesky 分解的失败，然后构造一个对称不定分解 $P^T A P = L D L^T$。\n\n给定的矩阵是：\n$$\nA = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix}\n$$\n\n**任务1：Cholesky 分解失败的理由**\n\n标准的 Cholesky 分解 $A = R^T R$（或 $A=LL^T$），其中 $R$ 是上三角矩阵，$L$ 是下三角矩阵，仅当矩阵 $A$ 是对称正定 (SPD) 时才适用。如果一个对称矩阵满足某些等价条件，则它被定义为 SPD。我们将使用题目中提到的两个条件来证明 $A$ 不是 SPD 矩阵。\n\n首先，一个对称矩阵 $A$ 是 SPD 的条件是，对于每个非零向量 $\\mathbf{x} \\in \\mathbb{R}^n$，二次型 $\\mathbf{x}^T A \\mathbf{x}  0$。我们来测试给定矩阵 $A$ 是否满足此条件。我们可以选择一个非零向量 $\\mathbf{x}$，例如 $\\mathbf{x} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。其二次型为：\n$$\n\\mathbf{x}^{T} A \\mathbf{x} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(1)  (1)(1) + (0)(1) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (0)(1) + (1)(0) = 0\n$$\n由于我们找到了一个非零向量 $\\mathbf{x}$，使得 $\\mathbf{x}^T A \\mathbf{x}$ 不严格为正，因此矩阵 $A$ 不是正定的。事实上，它是不定的，因为我们也可以找到一个向量使得二次型为负，例如，对于 $\\mathbf{x} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$：\n$$\n\\mathbf{x}^{T} A \\mathbf{x} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = -1  0\n$$\n\n其次，一个对称矩阵是 SPD 的另一个等价条件是其所有主子式都必须为正。一个 $n \\times n$ 矩阵的主子式是指其左上角 $k \\times k$ 子矩阵的行列式，其中 $k = 1, \\dots, n$。\n对于我们的矩阵 $A$，第一个主子式 $M_1$ 是左上角 $1 \\times 1$ 子矩阵的行列式，即元素 $A_{11}$。\n$$\nM_1 = \\det([0]) = 0\n$$\n“所有主子式必须为正”这一条件在第一步就被违反了，因为 $M_1 = 0$。为完整起见，第二个主子式是 $A$ 本身的行列式：\n$$\nM_2 = \\det(A) = (0)(1) - (1)(1) = -1\n$$\n这个值也不是正数。由于并非所有主子式都为正，所以 $A$ 不是 SPD 矩阵。\n\n因为矩阵 $A$ 不是对称正定的，所以无法应用标准的 Cholesky 分解。\n\n**任务2：构造带对称主元选择的 $LDL^T$ 分解**\n\n我们需要找到一个置换矩阵 $P$、一个单位下三角矩阵 $L$ 和一个对角矩阵 $D$，使得 $P^T A P = L D L^T$。这种分解是针对对称矩阵的高斯消元法的一种变体。\n\n该过程从矩阵 $A$ 开始：\n$$\nA = \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix}\n$$\n不带主元选择的标准算法会选择 $(1,1)$ 元素 $A_{11}=0$ 作为第一个主元。零主元是不允许的，因为它会导致除以零。因此，主元选择是必要的。对于对称矩阵，我们使用对称主元选择来保持对称性。这包括交换第 $i$ 行和第 $j$ 行，以及第 $i$ 列和第 $j$ 列。我们需要将一个非零元素移到 $(1,1)$ 主元位置。元素 $A_{22}=1$ 是一个合适的候选者。我们可以交换第1行和第2行，以及第1列和第2列。\n\n这个置换由置换矩阵 $P$ 表示：\n$$\nP = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}\n$$\n注意 $P$ 是对称的，所以 $P^T = P$。我们现在构造置换后的矩阵 $A' = P^T A P$：\n$$\nA' = P A P = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}\n$$\n现在我们来求 $A' = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}$ 的 $LDL^T$ 分解。我们期望找到 $L = \\begin{bmatrix} 1  0 \\\\ l_{21}  1 \\end{bmatrix}$ 和 $D = \\begin{bmatrix} d_1  0 \\\\ 0  d_2 \\end{bmatrix}$。\n\n分解过程逐步进行，类似于高斯消元法。\n**步骤1：**\n第一个主元是 $A'$ 的 $(1,1)$ 元素，它成为 $D$ 的第一个对角线元素。\n$$\nd_1 = A'_{11} = 1\n$$\n计算用于消去 $A'$ 的 $(2,1)$ 元素的乘子。这个乘子成为 $L$ 的 $(2,1)$ 元素。\n$$\nl_{21} = \\frac{A'_{21}}{d_1} = \\frac{1}{1} = 1\n$$\n我们更新尾随子矩阵。在这个 $2 \\times 2$ 的情况下，这只是 $(2,2)$ 元素。更新规则是 $A'_{22, \\text{new}} = A'_{22, \\text{old}} - l_{21} d_1 l_{21}^T$。对于通用算法，舒尔补的更新公式为 $S = A'_{22} - \\frac{A'_{12}A'_{21}}{A'_{11}}$。由于 $A'$ 是对称的，这可以写成 $S = A'_{22} - \\frac{(A'_{21})^2}{d_1}$。这个更新后的值就成为 $d_2$。\n$$\nd_2 = A'_{22} - \\frac{(A'_{21})^2}{d_1} = 0 - \\frac{1^2}{1} = -1\n$$\n\n因此，分解完成。这些矩阵是：\n$$\nP = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}, \\quad L = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}, \\quad D = \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix}\n$$\n我们可以验证结果：\n$$\nL D L^T = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 1  -1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\\\ 1  0 \\end{bmatrix}= P^T A P\n$$\n分解是正确的。\n\n问题要求 $D$ 的 $(1,1)$ 对角线元素的值。从我们构造的矩阵 $D$ 中，这个值是 $d_1$。\n$$\nd_1 = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3503367"}, {"introduction": "对于大型稀疏线性系统，直接求解法的计算成本（如内存和运算量）可能过高，迭代求解法便成为一种更具吸引力的选择。预条件共轭梯度（PCG）法是求解对称正定系统的最强大和最流行的迭代方法之一。本练习 [@problem_id:3503384] 将引导您从第一性原理出发，在一个典型的 $2 \\times 2$ 系统上执行两步 PCG 迭代，并重点体会“预条件”——即使是最简单的对角预条件——在加速收敛中的关键作用。", "problem": "一个在多物理场仿真中产生的双场耦合扩散-反应模型，在对界面未知量进行静态凝聚后，导出一个形式为 $A x = b$ 的对称正定舒尔补线性系统。在一个保留了耦合算子的核心代数特征以及块雅可比预条件子的分离物理场缩放特性的简化测试问题中，考虑\n$$\nA=\\begin{bmatrix}4  1\\\\ 1  3\\end{bmatrix},\\quad b=\\begin{bmatrix}1\\\\ 1\\end{bmatrix},\n$$\n并令预条件子为对角缩放 $M=\\mathrm{diag}(A)=\\mathrm{diag}(4,3)$，这在每个物理场都由其自身的刚度进行缩放时是常见的做法。从 $x_{0}=\\begin{bmatrix}0\\\\ 0\\end{bmatrix}$ 开始，应用预条件共轭梯度（PCG）方法进行两次迭代。其中，PCG（预条件共轭梯度）方法需要从第一性原理构建，即将解视为二次能量泛函 $\\phi(x)=\\tfrac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 在逐次仿射克雷洛夫子空间中的极小值点，搜索方向的选择需强制满足A-共轭性，步长的选择则通过在$M^{-1}$加权框架下进行线搜索最小化来确定。您的任务是：\n- 根据这些原理推导出所需的更新关系（不引用现成的算法公式），以及\n- 从 $x_{0}$ 开始，精确执行两次迭代。\n\n报告 $k=0,1,2$ 时残差 $r_{k}=b-Ax_{k}$ 的欧几里得范数，结果需为精确值。最终答案必须是三个残差范数 $\\|r_{0}\\|_{2}$、$\\|r_{1}\\|_{2}$ 和 $\\|r_{2}\\|_{2}$，以精确表达式的形式给出。请勿舍入。", "solution": "该问题被验证为适定的、有科学依据的，且没有任何不一致或模糊之处。矩阵 $A = \\begin{bmatrix} 4  1 \\\\ 1  3 \\end{bmatrix}$ 是对称正定的，因为其顺序主子式为 $4  0$ 且 $\\det(A) = 4 \\times 3 - 1 \\times 1 = 11  0$。预条件子 $M = \\mathrm{diag}(A) = \\begin{bmatrix} 4  0 \\\\ 0  3 \\end{bmatrix}$ 也是对称正定的。这些条件确保了预条件共轭梯度（PCG）方法是适用的，并保证收敛。\n\n首先，我们从指定的第一性原理推导PCG算法。线性系统 $Ax=b$ 的解等价于二次能量泛函 $\\phi(x) = \\frac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 的唯一极小值点。该泛函的梯度为 $\\nabla \\phi(x) = Ax - b$，我们将其定义为负残差 $-r(x)$。\n\nPCG方法是一个迭代过程，它生成一系列近似解 $x_k$，这些近似解在不断扩大的仿射子空间上使 $\\phi(x)$ 最小化。每一步的更新由 $x_{k+1} = x_k + \\alpha_k p_k$ 给出，其中 $p_k$ 是搜索方向，$\\alpha_k$ 是步长。\n\n步长 $\\alpha_k$ 的选择是为了沿方向 $p_k$ 最小化 $\\phi(x_k + \\alpha_k p_k)$。这是一个一维最小化问题（线搜索）。我们将关于 $\\alpha$ 的导数设为零：\n$$\n\\frac{d}{d\\alpha} \\phi(x_k + \\alpha p_k) \\Big|_{\\alpha=\\alpha_k} = p_k^{\\mathsf{T}} (A(x_k + \\alpha_k p_k) - b) = 0\n$$\n$$\np_k^{\\mathsf{T}} (Ax_k - b + \\alpha_k A p_k) = 0\n$$\n$$\np_k^{\\mathsf{T}} (-r_k + \\alpha_k A p_k) = 0\n$$\n求解 $\\alpha_k$ 可得最优步长：\n$$\n\\alpha_k = \\frac{p_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}\n$$\n搜索方向 $\\{p_k\\}$ 被选择为A-共轭的，即对于 $i \\neq j$，$p_i^{\\mathsf{T}} A p_j = 0$。该性质保证了在第 $k$ 步扩大搜索空间上的最小化不会破坏前面步骤的最小化结果。\n\n在该算法的预条件版本中，搜索方向是使用预条件残差 $z_k = M^{-1}r_k$ 构建的。初始搜索方向为 $p_0 = z_0$。后续方向的构建是通过使新的预条件残差 $z_{k+1}$ 与前一个搜索方向 $p_k$ A-共轭来实现的。这通过一个类格拉姆-施密特过程完成：\n$$\np_{k+1} = z_{k+1} + \\beta_{k+1} p_k\n$$\n我们强制执行A-共轭条件 $p_{k+1}^{\\mathsf{T}} A p_k = 0$：\n$$\n(z_{k+1} + \\beta_{k+1} p_k)^{\\mathsf{T}} A p_k = 0 \\implies z_{k+1}^{\\mathsf{T}} A p_k + \\beta_{k+1} p_k^{\\mathsf{T}} A p_k = 0\n$$\n这给出了系数 $\\beta_{k+1} = -\\frac{z_{k+1}^{\\mathsf{T}} A p_k}{p_k^{\\mathsf{T}} A p_k}$。\n\n为了计算效率，$\\alpha_k$ 和 $\\beta_k$ 的这些表达式被简化了。残差具有性质 $r_k^{\\mathsf{T}} z_j = 0$ (对于 $j  k$）。由 $p_j = z_j + \\beta_j p_{j-1}$ 可知，$p_j$ 位于 $\\{z_0, \\dots, z_j\\}$ 的张成空间中，因此对于 $j  k$，$r_k^{\\mathsf{T}} p_j = 0$。\n利用这一点，$\\alpha_k$ 的分子变为：\n$p_k^{\\mathsf{T}} r_k = (z_k + \\beta_k p_{k-1})^{\\mathsf{T}} r_k = z_k^{\\mathsf{T}} r_k + \\beta_k p_{k-1}^{\\mathsf{T}} r_k = z_k^{\\mathsf{T}} r_k + 0 = r_k^{\\mathsf{T}} z_k$。\n所以，$\\alpha_k = \\frac{r_k^{\\mathsf{T}} z_k}{p_k^{\\mathsf{T}} A p_k}$。\n\n对于 $\\beta_{k+1}$，我们使用残差更新公式 $r_{k+1} = r_k - \\alpha_k A p_k$，这意味着 $A p_k = \\frac{1}{\\alpha_k}(r_k - r_{k+1})$。\n$\\beta_{k+1}$ 表达式的分子变为：\n$z_{k+1}^{\\mathsf{T}} A p_k = z_{k+1}^{\\mathsf{T}} \\frac{1}{\\alpha_k}(r_k - r_{k+1}) = \\frac{1}{\\alpha_k} (r_{k+1}^{\\mathsf{T}} M^{-1} r_k - r_{k+1}^{\\mathsf{T}} M^{-1} r_{k+1})$。\n$z_j$ 是 M-自伴的，并且残差是 $M^{-1}$-正交的，$r_{k+1}^{\\mathsf{T}} M^{-1} r_k =0$。因此分子简化为 $-\\frac{1}{\\alpha_k} r_{k+1}^{\\mathsf{T}} z_{k+1}$。\n分母为 $p_k^{\\mathsf{T}} A p_k = \\frac{r_k^{\\mathsf{T}} z_k}{\\alpha_k}$。\n因此，$\\beta_{k+1} = \\frac{-r_{k+1}^{\\mathsf{T}} z_{k+1} / \\alpha_k}{r_k^{\\mathsf{T}} z_k / \\alpha_k} = \\frac{r_{k+1}^{\\mathsf{T}} z_{k+1}}{r_k^{\\mathsf{T}} z_k}$。\n\n需要实现的PCG算法如下：\n1. $r_0 = b - Ax_0$\n2. $z_0 = M^{-1}r_0$\n3. $p_0 = z_0$\n4. 对于 $k=0, 1, \\dots$：\n   a. $\\alpha_k = \\frac{r_k^{\\mathsf{T}} z_k}{p_k^{\\mathsf{T}} A p_k}$\n   b. $x_{k+1} = x_k + \\alpha_k p_k$\n   c. $r_{k+1} = r_k - \\alpha_k A p_k$\n   d. $z_{k+1} = M^{-1} r_{k+1}$\n   e. $\\beta_{k+1} = \\frac{r_{k+1}^{\\mathsf{T}} z_{k+1}}{r_k^{\\mathsf{T}} z_k}$\n   f. $p_{k+1} = z_{k+1} + \\beta_{k+1} p_k$\n\n现在我们用给定的数据执行两次迭代：\n$A=\\begin{bmatrix}4  1\\\\1  3\\end{bmatrix}$, $b=\\begin{bmatrix}1\\\\1\\end{bmatrix}$, $M=\\begin{bmatrix}4  0\\\\0  3\\end{bmatrix}$, $M^{-1}=\\begin{bmatrix}1/4  0\\\\0  1/3\\end{bmatrix}$, $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。\n\n**迭代 $k=0$**\n$r_0 = b - A x_0 = \\begin{bmatrix}1\\\\1\\end{bmatrix} - \\begin{bmatrix}0\\\\0\\end{bmatrix} = \\begin{bmatrix}1\\\\1\\end{bmatrix}$。\n其欧几里得范数为 $\\|r_0\\|_2 = \\sqrt{1^2+1^2} = \\sqrt{2}$。\n\n$z_0 = M^{-1} r_0 = \\begin{bmatrix}1/4  0\\\\0  1/3\\end{bmatrix} \\begin{bmatrix}1\\\\1\\end{bmatrix} = \\begin{bmatrix}1/4\\\\1/3\\end{bmatrix}$。\n$p_0 = z_0 = \\begin{bmatrix}1/4\\\\1/3\\end{bmatrix}$。\n\n$\\alpha_0$的分子：$r_0^{\\mathsf{T}} z_0 = \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}1/4\\\\1/3\\end{bmatrix} = \\frac{1}{4} + \\frac{1}{3} = \\frac{7}{12}$。\n$\\alpha_0$的分母：\n$A p_0 = \\begin{bmatrix}4  1\\\\1  3\\end{bmatrix} \\begin{bmatrix}1/4\\\\1/3\\end{bmatrix} = \\begin{bmatrix}1+1/3\\\\1/4+1\\end{bmatrix} = \\begin{bmatrix}4/3\\\\5/4\\end{bmatrix}$。\n$p_0^{\\mathsf{T}} A p_0 = \\begin{bmatrix}1/4  1/3\\end{bmatrix} \\begin{bmatrix}4/3\\\\5/4\\end{bmatrix} = \\frac{1}{4}\\frac{4}{3} + \\frac{1}{3}\\frac{5}{4} = \\frac{1}{3} + \\frac{5}{12} = \\frac{4+5}{12} = \\frac{9}{12} = \\frac{3}{4}$。\n$\\alpha_0 = \\frac{7/12}{3/4} = \\frac{7}{12} \\cdot \\frac{4}{3} = \\frac{7}{9}$。\n\n$x_1 = x_0 + \\alpha_0 p_0 = \\begin{bmatrix}0\\\\0\\end{bmatrix} + \\frac{7}{9}\\begin{bmatrix}1/4\\\\1/3\\end{bmatrix} = \\begin{bmatrix}7/36\\\\7/27\\end{bmatrix}$。\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{bmatrix}1\\\\1\\end{bmatrix} - \\frac{7}{9}\\begin{bmatrix}4/3\\\\5/4\\end{bmatrix} = \\begin{bmatrix}1 - 28/27 \\\\ 1 - 35/36\\end{bmatrix} = \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix}$。\n其欧几里得范数为 $\\|r_1\\|_2 = \\sqrt{(-\\frac{1}{27})^2 + (\\frac{1}{36})^2} = \\sqrt{\\frac{1}{729} + \\frac{1}{1296}} = \\sqrt{\\frac{16+9}{11664}} = \\sqrt{\\frac{25}{11664}} = \\frac{5}{108}$。\n\n**迭代 $k=1$**\n$z_1 = M^{-1} r_1 = \\begin{bmatrix}1/4  0\\\\0  1/3\\end{bmatrix} \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix} = \\begin{bmatrix}-1/108\\\\1/108\\end{bmatrix}$。\n\n$\\beta_1$的分子：$r_1^{\\mathsf{T}} z_1 = \\begin{bmatrix}-1/27  1/36\\end{bmatrix} \\begin{bmatrix}-1/108\\\\1/108\\end{bmatrix} = \\frac{1}{27 \\cdot 108} + \\frac{1}{36 \\cdot 108} = \\frac{4+3}{108 \\cdot 108} = \\frac{7}{11664}$。\n$\\beta_1$的分母是 $r_0^{\\mathsf{T}} z_0 = 7/12$。\n$\\beta_1 = \\frac{r_1^{\\mathsf{T}} z_1}{r_0^{\\mathsf{T}} z_0} = \\frac{7/11664}{7/12} = \\frac{12}{11664} = \\frac{1}{972}$。\n\n$p_1 = z_1 + \\beta_1 p_0 = \\begin{bmatrix}-1/108\\\\1/108\\end{bmatrix} + \\frac{1}{972}\\begin{bmatrix}1/4\\\\1/3\\end{bmatrix} = \\begin{bmatrix}-1/108+1/3888\\\\1/108+1/2916\\end{bmatrix} = \\begin{bmatrix}(-36+1)/3888\\\\(27+1)/2916\\end{bmatrix} = \\begin{bmatrix}-35/3888\\\\28/2916\\end{bmatrix} = \\begin{bmatrix}-35/3888\\\\7/729\\end{bmatrix}$。\n\n$\\alpha_1$的分子：$r_1^{\\mathsf{T}} z_1 = 7/11664$。\n$\\alpha_1$的分母：\n$A p_1 = \\frac{77}{108} \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix}$ (从之前的计算中简化)。\n$p_1^{\\mathsf{T}} A p_1$ 的计算很复杂。我们使用简化的 $r_2$ 计算。\n$\\alpha_1 = \\frac{r_1^{\\mathsf{T}} z_1}{p_1^{\\mathsf{T}} A p_1} = \\frac{108}{77}$ (从之前验证的计算)。\n\n$r_2 = r_1 - \\alpha_1 A p_1 = \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix} - \\frac{108}{77} \\left( \\frac{77}{108} \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix} \\right) = \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix} - \\begin{bmatrix}-1/27\\\\1/36\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix}$。\n其欧几里得范数为 $\\|r_2\\|_2 = \\sqrt{0^2+0^2}=0$。这是预期的结果，因为对于一个 $n \\times n$ 的系统，PCG至多在 $n=2$ 次迭代内收敛。\n\n$k=0,1,2$时残差的欧几里得范数分别为：\n$\\|r_0\\|_2 = \\sqrt{2}$\n$\\|r_1\\|_2 = \\frac{5}{108}$\n$\\|r_2\\|_2 = 0$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{2}  \\frac{5}{108}  0 \\end{pmatrix}}\n$$", "id": "3503384"}]}