## 引言
在现代计算科学与工程中，尤其是多物理场耦合仿真领域，求解大规模[线性方程组](@entry_id:148943) $Ax=b$ 是最核心和计算最密集的任务之一。然而，在众多求解算法中做出正确选择——是在鲁棒但耗费资源的直接法与快速但可能不稳定的[迭代法](@entry_id:194857)之间抉择——是一项严峻的挑战，直接决定了模拟分析的成败与效率。本文旨在系统性地填补理论与实践之间的鸿沟，为研究者和工程师提供一个清晰的决策框架。

通过本文的学习，您将深入理解[线性求解器](@entry_id:751329)的两大分支。在“原理与机制”一章中，我们将剖析直接法（如 LU 和 Cholesky 分解）与迭代法（如[共轭梯度法](@entry_id:143436)和 GMRES）的数学基础，并揭示矩阵性质和预条件技术如何决定算法的性能。接着，在“应用与跨学科连接”一章中，我们将理论联系实际，展示这些方法如何应用于[计算力学](@entry_id:174464)、[流体力学](@entry_id:136788)和热耦合等复杂工程问题，并探讨在实践中遇到的填充、病态条件等挑战。最后，通过“动手实践”环节，您将有机会亲手演练核心算法，从而将理论知识转化为解决实际问题的能力。

让我们开始这段从理论基础到应用前沿的探索之旅，掌握有效驾驭[线性求解器](@entry_id:751329)的关键知识。

## 原理与机制

在[多物理场耦合](@entry_id:171389)仿真的数值求解中，核心计算任务之一是求解大规模[线性方程组](@entry_id:148943) $Ax=b$。这些系统的特性——如矩阵的对称性、定性、稀疏模式和[条件数](@entry_id:145150)——深刻地影响着求解策略的选择和效率。本章将系统地阐述求解这些线性系统的两大类方法：直接法和迭代法的基本原理与关键机制。我们将从矩阵的基本性质出发，逐步深入探讨稠密和[稀疏矩阵](@entry_id:138197)的直接分解技术，然后转向经典的[定常迭代法](@entry_id:144014)和现代的克雷洛夫子空间法，最后介绍作为性能加速关键的预条件技术。

### 基础概念：矩阵性质与系统特征

在深入研究求解算法之前，我们必须首先理解待解[线性系统](@entry_id:147850) $Ax=b$ 中矩阵 $A$ 的内在属性。这些属性不仅决定了算法的适用性，也揭示了其[数值稳定性](@entry_id:146550)和收敛行为。在[多物理场耦合](@entry_id:171389)问题中，矩阵的结构通常直接反映了其所描述的物理过程。

#### 矩阵分类

根据与双线性型 $x^\top A x$ 和谱（[特征值](@entry_id:154894)）相关的性质，我们可以将求解器设计中遇到的实方阵分为几个关键类别 [@problem_id:3503349]。

- **[对称正定](@entry_id:145886) (Symmetric Positive Definite, SPD) 矩阵**: 一个实矩阵 $A$ 如果满足 $A = A^\top$ （对称性），并且对于所有非[零向量](@entry_id:156189) $x \in \mathbb{R}^n$，二次型 $x^\top A x$ 恒为正（$x^\top A x > 0$），则称其为[对称正定矩阵](@entry_id:136714)。这等价于矩阵的所有[特征值](@entry_id:154894)均为实数且严格为正。在物理上，SPD 矩阵通常与[扩散](@entry_id:141445)主导的过程（如[热传导](@entry_id:147831)和线弹性）的离散化相关，因为这些过程耗散能量，对应于一个正定的[能量泛函](@entry_id:170311)。

- **对称不定 (Symmetric Indefinite) 矩阵**: 一个实矩阵 $A$ 如果满足 $A = A^\top$，但其二次型 $x^\top A x$ 的值可正可负，则称其为[对称不定矩阵](@entry_id:755717)。谱的观点是，该矩阵至少存在一个正[特征值](@entry_id:154894)和一个负[特征值](@entry_id:154894)。这类矩阵常见于混合公式，例如在[不可压缩流体](@entry_id:181066)模拟或[接触力学](@entry_id:177379)中出现的[鞍点系统](@entry_id:754480)。

- **非对称与非正规 (Nonsymmetric and Non-normal) 矩阵**: 当 $A \neq A^\top$ 时，矩阵为非对称。一个更广泛且在[迭代法](@entry_id:194857)中更重要的概念是**正规性**。如果一个矩阵与其[共轭转置](@entry_id:147909)（对于实矩阵即其转置）满足[交换律](@entry_id:141214) $A^\top A = A A^\top$，则称其为**[正规矩阵](@entry_id:185943)**。否则，该矩阵为**[非正规矩阵](@entry_id:752668)**。对称矩阵是[正规矩阵](@entry_id:185943)的一个特例。非对称性，尤其是强[非正规性](@entry_id:752585)，通常源于[平流](@entry_id:270026)主导的输运过程、[反应耦合](@entry_id:144737)或非物理的数值离散技术（如强上风格式）。

为了具体说明这些定义，我们考虑矩阵 $A = \begin{pmatrix} 2 & -1 \\ -1 & 2 \end{pmatrix}$ [@problem_id:3503349]。首先，由于 $A = A^\top$，该矩阵是对称的。接下来，我们检验其定性。对于任意非零向量 $x = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$，其二次型为：
$x^\top A x = 2x_1^2 - 2x_1x_2 + 2x_2^2 = x_1^2 + x_2^2 + (x_1 - x_2)^2$
因为 $x$ 非零，所以 $x_1^2 + x_2^2 > 0$，而 $(x_1 - x_2)^2 \ge 0$。因此，$x^\top A x$ 始终为正。这证明了 $A$ 是[对称正定矩阵](@entry_id:136714)。我们也可以通过计算[特征值](@entry_id:154894)来验证。特征方程为 $(2-\lambda)^2 - 1 = 0$，解得[特征值](@entry_id:154894)为 $\lambda_1 = 1$ 和 $\lambda_2 = 3$。两个[特征值](@entry_id:154894)均为正实数，再次确认了 $A$ 的 SPD 性质。

#### 条件数

[线性系统](@entry_id:147850)的**[条件数](@entry_id:145150) (condition number)** 是衡量其对输入数据扰动的敏感性的一个关键指标。对于[迭代法](@entry_id:194857)，它还深刻地影响着[收敛速度](@entry_id:636873)。谱二范数[条件数](@entry_id:145150)定义为 $\kappa_2(A) = \|A\|_2 \|A^{-1}\|_2$。对于可对角化的矩阵，这等于其最大[特征值](@entry_id:154894)的[绝对值](@entry_id:147688)与最小特征值的[绝对值](@entry_id:147688)之比，即 $\kappa_2(A) = \frac{|\lambda_{\max}|}{|\lambda_{\min}|}$。一个接近 1 的[条件数](@entry_id:145150)意味着系统是“良态的”，而一个非常大的条件数则表示系统是“病态的”，数值求解将非常困难。

对于我们上面分析的矩阵 $A$，其[特征值](@entry_id:154894)为 $1$ 和 $3$。因此，其条件数为 $\kappa_2(A) = \frac{3}{1} = 3$ [@problem_id:3503349]。这个值相对较小，表明该系统是良态的。

### 直接求解法

直接求解法（或称直接法）旨在通过一系列有限的、确定性的代数运算，在不考虑舍入误差的情况下，求得[线性系统](@entry_id:147850)的精确解。其核心思想是将矩阵 $A$ 分解为一个或多个结构更简单的矩阵（通常是[三角矩阵](@entry_id:636278)）的乘积。

#### 矩阵分解

最常见的三种分解是 LU 分解、Cholesky 分解和 LDLT 分解 [@problem_id:3503362]。

- **LU 分解**: 对于一个一般的方阵 $A$，LU 分解旨在找到一个下三角矩阵 $L$ 和一个上三角矩阵 $U$，使得 $A = LU$。为了保证分[解的唯一性](@entry_id:143619)，通常会要求 $L$ 是单位下三角矩阵（对角[线元](@entry_id:196833)素全为 1）。然而，无主元选择的 LU 分解（即高斯消去法）仅在矩阵的所有主子式都非零时才存在。为了处理更一般的情况，我们需要引入行交换，即**[部分主元法](@entry_id:138396) (partial pivoting)**。这导致了更通用的分解形式 $PA = LU$，其中 $P$ 是一个[置换矩阵](@entry_id:136841)。在精确算术下，这种带[部分主元法](@entry_id:138396)的 LU 分解对于**任何**方阵（无论是否奇异）都存在。

- **Cholesky 分解**: 对于[对称正定](@entry_id:145886) (SPD) 矩阵 $A$，存在一种更高效且数值稳定的分解，称为 Cholesky 分解。它将 $A$ 分解为 $A = LL^\top$，其中 $L$ 是一个具有正对角[线元](@entry_id:196833)素的下[三角矩阵](@entry_id:636278)。一个矩阵能够进行这种形式的 Cholesky 分解的**充分必要条件**是该矩阵为对称正定矩阵。[正定性](@entry_id:149643)保证了在分解过程中开平方根的参数始终为正，从而避免了[复数运算](@entry_id:195031)和除以零的风险。

- **LDLT 分解**: 这是 Cholesky 分解的一种变体，旨在避免计算平方根。它将对称矩阵 $A$ 分解为 $A = LDL^\top$，其中 $L$ 是单位下三角矩阵，$D$ 是[对角矩阵](@entry_id:637782)。对于一般的[对称矩阵](@entry_id:143130)（可能是不定的），无主元的 $LDL^\top$ 分解可能会因零主元而失败。为了处理这种情况，需要采用对称主元选择策略，如 Bunch-Kaufman 算法。该算法产生分解 $P^\top AP = LDL^\top$，其中 $L$ 是单位下[三角矩阵](@entry_id:636278)，而 $D$ 是**[块对角矩阵](@entry_id:145530)**，其对角块为 $1 \times 1$ 或 $2 \times 2$。这种分解对于**任何**[实对称矩阵](@entry_id:192806)都存在，是处理[对称不定系统](@entry_id:755718)的标准稳定直接方法。

#### 主元选择与[数值稳定性](@entry_id:146550)

当矩阵不是[对称正定](@entry_id:145886)时，高斯消去法的数值稳定性就成为一个关键问题。在消去过程中，中间矩阵的元素可能会急剧增长，导致[舍入误差](@entry_id:162651)被严重放大。**主元选择 (pivoting)** 策略就是为了抑制这种元素增长 [@problem_id:3503353]。

在第 $k$ 步高斯消去中，更新公式为 $a_{ij}^{(k+1)} = a_{ij}^{(k)} - \ell_{ik}^{(k)} u_{kj}^{(k)}$，其中乘子 $\ell_{ik}^{(k)} = a_{ik}^{(k)} / a_{kk}^{(k)}$，$a_{kk}^{(k)}$ 是主元。如果主元 $a_{kk}^{(k)}$ 很小，乘子 $\ell_{ik}^{(k)}$ 就会很大，可能导致 $a_{ij}^{(k+1)}$ 的[数量级](@entry_id:264888)远大于 $a_{ij}^{(k)}$。这种现象由**增长因子 (growth factor)** $\rho(A) = \frac{\max_{i,j,k} |a_{ij}^{(k)}|}{\max_{i,j} |a_{ij}|}$ 来量化。

- **[部分主元法](@entry_id:138396) (Partial Pivoting)**: 在第 $k$ 步，从第 $k$ 列的第 $k$ 个元素到最后一个元素中选取[绝对值](@entry_id:147688)最大的元素作为主元，并通过行交换将其移动到[主元位置](@entry_id:155686)。这种策略保证了所有乘子的大小都不超过 1 ($|\ell_{ik}^{(k)}| \le 1$)，从而在一定程度上控制了元素的增长。理论上，[部分主元法](@entry_id:138396)的最坏增长因子是指数级的（$\rho(A) \le 2^{n-1}$），但在实践中，对于绝大多数矩阵，其增长因子都非常温和。

- **[完全主元法](@entry_id:176607) (Complete Pivoting)**: 在第 $k$ 步，从整个右下角的子矩阵中选取[绝对值](@entry_id:147688)最大的元素作为主元，并通过行和列的交换将其置于[主元位置](@entry_id:155686)。这种策略提供了更强的稳定性保证，理论上可以将最坏情况下的元素增长限制在次指数级。

然而，对于 SPD 矩阵，其 Cholesky 分解是无条件向后稳定的，增长因子 $\rho(A) \le 1$，因此**不需要**任何主元选择来保证数值稳定性 [@problem_id:3503353]。

#### 稀疏直接求解法

[多物理场仿真](@entry_id:145294)的离散化通常产生**[稀疏矩阵](@entry_id:138197)**，即矩阵中绝大多数元素为零。直接求解这类系统时，一个核心挑战是**填充 (fill-in)** 现象：在分解过程中，原本为零的位置可能会变为非零元素。大量的填充会极大地增加内存消耗和计算时间。

我们可以用[图论](@entry_id:140799)的语言来理解填充 [@problem_id:3503407]。对于一个[对称矩阵](@entry_id:143130) $A$，我们可以构造一个图 $G(A)$，其顶点对应矩阵的行/列索引，当 $A_{ij} \neq 0$ ($i \neq j$) 时，顶点 $i$ 和 $j$ 之间存在一条边。在高斯消去中，消去一个顶点 $k$ 的操作，在图论上等价于将其所有邻居连接成一个**团 (clique)**。在这个过程中新产生的边就对应于填充。

为了减少填充，我们需要在分解前对矩阵的行和列进行重排，这称为**排序 (ordering)**。两种广泛使用的排序策略是：

- **近似[最小度排序](@entry_id:751998) (Approximate Minimum Degree, AMD)**: 这是一种[贪心算法](@entry_id:260925)，在每一步选择当前图中度数（邻居数量）最小的顶点进行消去。AMD 是一种局部[启发式](@entry_id:261307)策略，它旨在每一步都最小化新产生的填充。它计算成本低廉，在许多问题中效果显著。

- **[嵌套剖分](@entry_id:265897) (Nested Dissection, ND)**: 这是一种基于分治思想的全局策略。它通过寻找一个小的**顶点分隔符 (vertex separator)** 将[图划分](@entry_id:152532)为两个或多个大致平衡的子图。然后，它递归地对子图进行排序，最后对分隔符中的顶点进行排序。ND 往往能产生更宽、更浅的**消去树 (elimination tree)**，从而暴露了大量的并行性，因为[子图](@entry_id:273342)的分解可以独立进行。对于二维平面网格等特定类型的图，ND 具有理论上的最优[渐近复杂度](@entry_id:149092)保证：对于 $n$ 个顶点的 SPD 矩阵，Cholesky 因子 $L$ 的非零元数量为 $\mathcal{O}(n \log n)$，计算量为 $\mathcal{O}(n^{3/2})$ [@problem_id:3503407]。

值得注意的是，[排序算法](@entry_id:261019)如 AMD 和 ND 仅依赖于矩阵的稀疏模式（即图结构），而与矩阵的具体数值无关。因此，它们同样适用于[对称不定系统](@entry_id:755718)的预排序，尽管后续的数值分解需要结[合数](@entry_id:263553)值主元选择策略 [@problem_id:3503407]。

**消去树** [@problem_id:3503416] 是一个紧凑地表示稀疏 Cholesky 分解中列之间依赖关系的[数据结构](@entry_id:262134)。树中的父节点关系定义为 $\mathrm{parent}(i) = \min\{ j>i \mid L_{ji} \neq 0\}$。这个结构揭示了计算的“[关键路径](@entry_id:265231)”：一个列的计算依赖于其所有子节点的计算完成。因此，消去[树的高度](@entry_id:264337)决定了并行分解的最短时间，而其宽度则代表了可利用的并行度。此外，由于 SPD 矩阵的分解不需要数值主元，其填充模式完全由初始稀疏模式决定。这使得我们可以在进行任何数值计算之前，通过**[符号分解](@entry_id:755708) (symbolic factorization)** 阶段构造消去树并精确预估因子 $L$ 的非零元数量，从而实现内存的精确预分配。

#### 块系统与[舒尔补](@entry_id:142780)

在耦合[多物理场](@entry_id:164478)问题中，将不同物理场的自由度分组，自然地形成了[块矩阵](@entry_id:148435)结构 [@problem_id:3503393]。例如，一个两场耦合系统可以写成：
$$
M \begin{pmatrix} u \\ p \end{pmatrix} = \begin{pmatrix} A & B^\top \\ B & C \end{pmatrix} \begin{pmatrix} u \\ p \end{pmatrix} = \begin{pmatrix} f \\ g \end{pmatrix}
$$
通过块高斯消去法，我们可以先从第一个方程中消去变量 $u$。假设 $A$ 可逆，我们得到 $u = A^{-1}(f - B^\top p)$。将其代入第二个方程，得到一个只关于变量 $p$ 的新方程：
$$
(C - B A^{-1} B^\top) p = g - B A^{-1} f
$$
这个新的、规模更小的系统中的矩阵 $S = C - B A^{-1} B^\top$ 被称为 $A$ 在 $M$ 中的**[舒尔补](@entry_id:142780) (Schur complement)**。[舒尔补](@entry_id:142780)在[多物理场建模](@entry_id:752308)中至关重要，它代表了一个物理场（如 $p$）在考虑了与另一物理场（$u$）的完全耦合效应后的有效算子。

[舒尔补](@entry_id:142780)的性质与原[块矩阵](@entry_id:148435) $M$ 的性质密切相关。对于对称矩阵 $M$，有一个基本结论：当且仅当 $A$ 和其[舒尔补](@entry_id:142780) $S$ 均为对称正定时，原矩阵 $M$ 才是对称正定的。这意味着，如果整个耦合系统是 SPD 的（例如，在某些强耦合的热固耦合问题中），那么通过消去得到的舒尔补系统也必然是 SPD 的，这对于后续求解非常有利。然而，在许多其他情况下，例如[不可压缩流](@entry_id:140301)中的混合公式，原始[块矩阵](@entry_id:148435) $M$ 是对称不定的。即使 $A$ 是 SPD 的，其舒尔补 $S$ 也可能不是 SPD，甚至是负定的（例如，当 $C=0$ 时，$S = -BA^{-1}B^\top$）[@problem_id:3503393]。

### 迭代求解法

与在有限步内给出精确解的直接法不同，[迭代法](@entry_id:194857)从一个初始猜测 $x_0$ 开始，通过一个迭代过程生成一系列近似解 $x_1, x_2, \dots$，并希望这个序列能够收敛到真实解 $x$。对于由[偏微分方程离散化](@entry_id:175821)产生的大规模[稀疏系统](@entry_id:168473)，[迭代法](@entry_id:194857)在内存消耗和[计算效率](@entry_id:270255)方面通常具有显著优势。

#### 经典[定常迭代法](@entry_id:144014)

这类方法基于矩阵 $A$ 的一个分裂 $A = H - K$，其中 $H$ 是一个容易求逆的矩阵。原始方程 $Ax=b$ 被改写为 $Hx = Kx + b$，从而定义了一个固定的迭代格式：
$$
H x^{k+1} = K x^k + b \quad \implies \quad x^{k+1} = H^{-1}K x^k + H^{-1}b
$$
这个迭代过程收敛的充要条件是**[迭代矩阵](@entry_id:637346)** $M = H^{-1}K$ 的**[谱半径](@entry_id:138984)**（即模最大的[特征值](@entry_id:154894)）小于 1，即 $\rho(M)  1$ [@problem_id:3503389]。

基于矩阵 $A$ 的对角 ($D$)、严格下三角 ($L$) 和严格上三角 ($U$) 部分的经典分裂 $A = D + L + U$，我们可以定义三种基本的[定常迭代法](@entry_id:144014)：

- **[雅可比法](@entry_id:147508) (Jacobi Method)**: 选择 $H = D$ 和 $K = -(L+U)$。迭代格式为 $x^{k+1} = D^{-1}(b - (L+U)x^k)$。该方法在计算每个分量的新值时，完全依赖于上一步的旧值，因此具有很好的并行性。

- **[高斯-赛德尔法](@entry_id:145727) (Gauss-Seidel Method)**: 选择 $H = D+L$ 和 $K = -U$。迭代格式为 $(D+L)x^{k+1} = b - Ux^k$。该方法在计算第 $i$ 个分量的新值时，会立即使用已经计算出的前 $i-1$ 个分量的新值。这通常会加速收敛，但破坏了[雅可比法](@entry_id:147508)的并行性。

- **[逐次超松弛法](@entry_id:142488) (Successive Over-Relaxation, SOR)**: 这是[高斯-赛德尔法](@entry_id:145727)的一种推广，引入一个松弛因子 $\omega$。其[迭代矩阵](@entry_id:637346)为 $M_{SOR} = (D+\omega L)^{-1}((1-\omega)D - \omega U)$。通过明智地选择 $\omega$（通常在 $(0, 2)$ 范围内），可以显著提高[收敛速度](@entry_id:636873)。

#### 克雷洛夫子空间法

现代[迭代法](@entry_id:194857)的核心思想是构造**[克雷洛夫子空间](@entry_id:751067) (Krylov subspace)**，并在此空间中寻找最优近似解。对于一个矩阵 $A$ 和一个初始向量 $r_0$（通常是初始残差 $r_0 = b - Ax_0$），第 $k$ 维[克雷洛夫子空间](@entry_id:751067)定义为：
$$
\mathcal{K}_k(A, r_0) = \text{span}\{r_0, Ar_0, A^2r_0, \dots, A^{k-1}r_0\}
$$
[克雷洛夫子空间](@entry_id:751067)法在第 $k$ 步寻找一个近似解 $x_k$，使其位于[仿射空间](@entry_id:152906) $x_0 + \mathcal{K}_k(A, r_0)$ 中。确定 $x_k$ 的准则通常是一个**[Petrov-Galerkin](@entry_id:174072) 条件**，即要求新的残差 $r_k = b - Ax_k$ 与一个 $k$ 维的**测试[子空间](@entry_id:150286)** $T_k$ 正交，记为 $r_k \perp T_k$ [@problem_id:3503403]。不同的测试[子空间](@entry_id:150286)选择导致了不同的克雷洛夫方法。

##### 针对对称矩阵的方法

- **共轭梯度法 (Conjugate Gradient, CG)**: 这是求解 SPD 系统的最著名和最高效的迭代方法之一。CG 是一种 Galerkin 方法，其测试[子空间](@entry_id:150286)与搜索[子空间](@entry_id:150286)相同，即 $T_k = S_k = \mathcal{K}_k(A, r_0)$。其[正交性条件](@entry_id:168905) $r_k \perp \mathcal{K}_k(A, r_0)$ 等价于在 $x_0 + \mathcal{K}_k(A, r_0)$ 中最小化误差的 $A$-范数 $\|e_k\|_A = \sqrt{e_k^\top A e_k}$ [@problem_id:3503403]。CG 方法具有短递归关系（每一步只需用到前一步的信息），计算和存储开销小，且收敛速度与 $\sqrt{\kappa_2(A)}$ 相关。

- **[最小残差法](@entry_id:752003) (Minimal Residual, [MINRES](@entry_id:752003))**: 对于对称但可能不定的系统，CG 方法可能会因 $A$-范数失去正定性而失败。[MINRES](@entry_id:752003) 是为这类问题设计的。它同样基于 Lanczos 过程生成克雷洛夫子空间的正交基，但其目标是在每一步最小化残差的欧几里得范数 $\|r_k\|_2$。这个最小化问题总是适定的，因此 [MINRES](@entry_id:752003) 对于[对称不定系统](@entry_id:755718)是鲁棒的 [@problem_id:3503356]。

##### 针对[非对称矩阵](@entry_id:153254)的方法

- **[广义最小残差法](@entry_id:139566) (Generalized Minimal Residual, GMRES)**: 这是求解非对称系统最流行的方法之一。GMRES 的目标与 [MINRES](@entry_id:752003) 类似：在 $x_0 + \mathcal{K}_k(A, r_0)$ 中寻找使 $\|r_k\|_2$ 最小化的解。它通过 Arnoldi 过程为[克雷洛夫子空间](@entry_id:751067)构建一个正交基 $V_{k+1}$，并将原问题转化为一个小的 $(k+1) \times k$ 的最小二乘问题，其系数矩阵是一个上 Hessenberg 矩阵 $\bar{H}_k$ [@problem_id:3503356]。一个重要特性是，GMRES 的[残差范数](@entry_id:754273)在迭代过程中是单调不增的 [@problem_id:3503356]。然而，GMRES 的计算和存储成本会随着迭代次数 $k$ 的增加而增长，因此通常需要使用**重启动 (restarted)** 版本。

- **[双共轭梯度法](@entry_id:746788) (Biconjugate Gradient, BiCG)**: BiCG 将 CG 的思想推广到非对称系统。它通过构造两个相互**双正交 (biorthogonal)** 的残差序列 $r_k$ 和**影子残差 (shadow residual)** $\tilde{r}_k$ 来实现，这两个序列分别属于[克雷洛夫子空间](@entry_id:751067) $\mathcal{K}_k(A, r_0)$ 和 $\mathcal{K}_k(A^\top, \tilde{r}_0)$。BiCG 同样具有短递归关系，但其收敛行为可能不稳定，且需要进行与 $A^\top$ 的乘法运算。如果其递推系数中的某些[内积](@entry_id:158127)为零，算法会发生**崩溃 (breakdown)** [@problem_id:3503413]。有趣的是，当 $A$ 是 SPD 且 $\tilde{r}_0 = r_0$ 时，BiCG 在数学上等价于 CG [@problem_id:3503413]。

- **[稳定双共轭梯度法](@entry_id:634145) (Biconjugate Gradient Stabilized, BiCGStab)**: 这是 BiCG 的一种更平滑、更鲁棒的变体。它避免了与 $A^\top$ 的乘法，并通过将每个 BiCG 步骤与一个局部最小残差步骤相结合来[稳定收敛](@entry_id:199422)过程。这使得 BiCGStab 在处理由[平流](@entry_id:270026)主导的强非对称系统时，往往比 BiCG 更具吸[引力](@entry_id:175476) [@problem_id:3503413]。

#### 预条件技术

对于[病态系统](@entry_id:137611)（即 $\kappa_2(A)$ 很大），[迭代法的收敛](@entry_id:139832)速度可能非常缓慢。**预条件 (preconditioning)** 技术通过将原系统 $Ax=b$ 转化为一个等价且[条件数](@entry_id:145150)更小的系统来加速收敛。一个好的预条件子 $M$ 应该满足两个条件：(1) $M$ 在某种意义上“近似”于 $A$；(2) 求解形如 $Mz=d$ 的系统应该比求解原系统容易得多。

对于左预条件，我们求解 $M^{-1}Ax = M^{-1}b$。[迭代法的收敛性](@entry_id:273433)将取决于预条件矩阵 $M^{-1}A$ 的谱特性。对于 SPD 系统和 CG 方法，为了保持对称性，通常使用对称预条件，求解 $(M^{-1/2}AM^{-1/2})y = M^{-1/2}b$，其中 $x = M^{-1/2}y$。收敛速度则取决于 $\kappa_2(M^{-1/2}AM^{-1/2}) = \kappa_2(M^{-1}A)$。

一个最简单的[预条件子](@entry_id:753679)是**对角预条件 (diagonal preconditioning)**，或称**[雅可比](@entry_id:264467)预条件**，即取 $M = \text{diag}(A)$。考虑一个 SPD 矩阵 $A=\begin{pmatrix} 4  1  0 \\ 1  3  1 \\ 0  1  2 \end{pmatrix}$ [@problem_id:3503359]。其[条件数](@entry_id:145150)为 $\kappa_2(A) = 2+\sqrt{3} \approx 3.732$。如果我们使用对角预条件子 $M = \text{diag}(4, 3, 2)$，可以计算出预条件矩阵 $M^{-1}A$ 的[条件数](@entry_id:145150)为 $\kappa_2(M^{-1}A) = 3$。由于[条件数](@entry_id:145150)减小了，我们预期预条件共轭梯度法 (PCG) 的收敛速度会比标准 CG 更快，迭代次数大约减少到原来的 $\sqrt{3 / (2+\sqrt{3})} \approx 0.9$ 倍。虽然这个例子中的提升不大，但对于更复杂的大规模问题，一个设计良好的[预条件子](@entry_id:753679)可以将[条件数](@entry_id:145150)降低几个[数量级](@entry_id:264888)，从而将迭代次数从数百万次减少到几十或几百次，实现根本性的性能提升。