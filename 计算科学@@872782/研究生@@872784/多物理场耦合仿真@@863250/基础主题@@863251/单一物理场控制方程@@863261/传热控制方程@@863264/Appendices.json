{"hands_on_practices": [{"introduction": "我们对热传导的理解始于正确描述材料的本构关系。虽然许多入门级分析假设材料是各向同性的，但现实世界中的许多材料（如晶体和复合材料）在不同方向上表现出不同的导热性能。本练习将引导您运用张量分析，从基本热力学定律出发，为具有正交对称性的晶体推导傅里叶定律的张量形式，从而加深对各向异性热传导物理本质的理解。[@problem_id:3508533]", "problem": "考虑一个在热传导方面表现出正交各向异性对称性的晶体固体，这意味着存在三个相互正交的晶体方向，沿着这些方向的热传导是解耦的。设晶体坐标系由标准正交基 $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$ 定义，在此坐标系中，热导率张量是对角阵，其主热导率分别为 $k_{1}$、$k_{2}$ 和 $k_{3}$。设实验室坐标系由标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 定义，该坐标系通过一个正常正交旋转矩阵 $\\mathbf{R}$ 与晶体坐标系相关联，其分量为 $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$，满足 $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ 和 $\\det(\\mathbf{R}) = 1$。假设在没有平流和辐射的情况下存在稳态热传导，并有一个体热源 $\\dot{q}(\\mathbf{x})$。\n\n从局部微分形式的热力学第一定律（能量守恒）和热力学第二定律（克劳修斯-杜亥姆不等式）关于线性传导映射是耗散的要求出发，推导实验室坐标系下傅里葉定律的分量形式，并确定主热导率在旋转 $\\mathbf{R}$ 下如何变换。您的推导应明确利用热导率的张量性质以及矢量和二阶张量在旋转下的变换性质。\n\n请将您的最终答案表示为包含以下内容的单行矩阵：\n- 实验室坐标系下傅里葉定律的分量形式，以及\n- 用 $R_{ij}$ 和主热导率 $k_{1}$、$k_{2}$、$k_{3}$ 表示的变换后热导率张量分量的表达式。\n\n无需进行数值计算。请以符号形式提供您的最终表达式。如果您引入任何辅助定义或算子（例如梯度），请明确定义它们。由于不要求数值计算，舍入说明不适用。", "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n### 步骤 1：提取已知条件\n- 一个在热传導方面具有正交各向异性对称性的晶体固体。\n- 晶体坐标系基：$\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$，标准正交。\n- 晶体坐标系中的热导率张量是对角阵，主热导率为 $k_{1}$、$k_{2}$ 和 $k_{3}$。\n- 实验室坐标系基：$\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$，标准正交。\n- 旋转矩阵 $\\mathbf{R}$ 关联两个坐标系，其分量为 $R_{ij} = \\mathbf{e}_{i} \\cdot \\mathbf{E}_{j}$。\n- $\\mathbf{R}$ 的性质：正常正交，即 $\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ 且 $\\det(\\mathbf{R}) = 1$。\n- 物理条件：稳态热传导，无平流，无辐射。\n- 存在体热源 $\\dot{q}(\\mathbf{x})$。\n- 出发原理：热力学第一定律（能量守恒）和热力学第二定律（克劳修斯-杜亥姆不等式，表示为耗散）。\n- 任务：推导实验室坐标系中傅里葉定律的分量形式。\n- 任务：推导用 $R_{ij}$ 和主热导率 $k_{1}, k_{2}, k_{3}$ 表示的变换后热导率张量分量的表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **有科学依据**：该问题基于应用于各向异性材料传热的连续介质力学、热力学和张量分析的基本原理。这些概念在物理学和工程学中是标准的。\n- **适定性**：问题明确。它要求推导该领域的标准结果，并提供了所有必要信息。存在唯一的解析解。\n- **客观性**：语言精确、技术性强，没有任何主观性或歧义。\n- **缺陷检查表**：该问题没有违反任何指定的缺陷标准。它科学上合理、可形式化、完整、现实、适定且非平凡。\n\n### 步驟 3：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 推导\n推导从热力学的基本定律开始。在整个推导过程中，除非明确写出求和符号，否则对重复指标采用爱因斯坦求和约定。我们用粗体字表示矢量和张量。\n\n热力学第一定律，即能量守恒定律，对于一个处于稳态、没有机械功或平流的控制体积，表明进入该体积的净热量率必须与内部产生的热量率相平衡。其局部微分形式表示为：\n$$ \\nabla \\cdot \\mathbf{q} = \\dot{q}(\\mathbf{x}) $$\n其中 $\\mathbf{q}$ 是热通量矢量，$\\dot{q}$ 是体热源，$\\nabla \\cdot$ 是散度算子。\n\n热力学第二定律，以克劳修斯-杜亥姆不等式的形式，要求局部熵产生率必须为非负。对于纯热传导过程，该不等式简化为：\n$$ -\\frac{1}{T^2} (\\mathbf{q} \\cdot \\nabla T) \\ge 0 $$\n其中 $T$ 是绝对温度。由于温度必须为正，$T>0$，这简化为耗散不等式：\n$$ -\\mathbf{q} \\cdot \\nabla T \\ge 0 $$\n这一基本约束规定了热量不能从较冷的区域流向较热的区域。为了对任何可能的温度梯度都满足此条件，关联热通量 $\\mathbf{q}$ 和温度梯度 $\\nabla T$ 的线性本构模型必须具有以下形式：\n$$ \\mathbf{q} = -\\mathbf{K} \\nabla T $$\n其中 $\\mathbf{K}$ 是二阶热导率张量。耗散不等式要求张量 $\\mathbf{K}$ 是正定的。\n\n我们现在在实验室坐标系中表达这一关系，该坐标系具有标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$。矢量 $\\mathbf{v}$ 的分量为 $v_i = \\mathbf{v} \\cdot \\mathbf{e}_i$，二阶张量 $\\mathbf{T}$ 的分量为 $T_{ij} = \\mathbf{e}_i \\cdot (\\mathbf{T} \\mathbf{e}_j)$。\n热通量矢量 $\\mathbf{q}$ 的分量是 $q_i$。\n温度梯度矢量 $\\nabla T$ 的分量是 $(\\nabla T)_j = \\frac{\\partial T}{\\partial x_j}$，其中 $x_j$ 是实验室坐标系中的坐标。\n热导率张量 $\\mathbf{K}$ 在此坐标系中的分量是 $K_{ij}$。\n\n将矢量方程 $\\mathbf{q} = -\\mathbf{K} \\nabla T$ 写成分量形式，我们得到：\n$$ q_i = -K_{ij} \\frac{\\partial T}{\\partial x_j} $$\n这就是实验室坐标系中傅里葉定律的分量形式，是第一个要求的表达式。这里隐含了对指标 $j$ 从 $1$到 $3$ 的求和。\n\n接下来，我们必须找出分量 $K_{ij}$ 关于主热导率 $k_1, k_2, k_3$ 和旋转矩阵 $\\mathbf{R}$ 的表达式。\n问题陈述，在具有标准正交基 $\\{\\mathbf{E}_{1},\\mathbf{E}_{2},\\mathbf{E}_{3}\\}$ 的晶体坐标系中，热导率张量是对角阵。这意味着晶体坐标系的基矢量是张量 $\\mathbf{K}$ 的特征向量。我们可以将张量 $\\mathbf{K}$ 写成其谱分解形式：\n$$ \\mathbf{K} = k_1 \\mathbf{E}_1 \\otimes \\mathbf{E}_1 + k_2 \\mathbf{E}_2 \\otimes \\mathbf{E}_2 + k_3 \\mathbf{E}_3 \\otimes \\mathbf{E}_3 $$\n因此，$\\mathbf{K}$ 在晶体坐标系中的分量，记为 $K'_{mn} = \\mathbf{E}_m \\cdot (\\mathbf{K} \\mathbf{E}_n)$，由一个对角矩阵给出：\n$$ K'_{mn} = \\begin{pmatrix} k_1  0  0 \\\\ 0  k_2  0 \\\\ 0  0  k_3 \\end{pmatrix} $$\n这可以用克罗内克δ函数紧凑地写为 $K'_{mn} = k_m \\delta_{mn}$，这里不对 $m$ 进行求和。\n\n二阶张量的分量从一个标准正交基变换到另一个标准正交基时，遵循以下变换定律：\n$$ K_{ij} = R_{im} R_{jn} K'_{mn} $$\n这里，$R_{im} = \\mathbf{e}_i \\cdot \\mathbf{E}_m$ 是将分量从晶体坐标系映射到实验室坐标系的旋转矩阵 $\\mathbf{R}$ 的分量。指标 $m$ 和 $n$ 从 $1$到 $3$ 求和。\n\n我们将晶体坐标系中张量的分量形式 $K'_{mn} = k_m \\delta_{mn}$ 代入变换定律：\n$$ K_{ij} = \\sum_{m=1}^{3} \\sum_{n=1}^{3} R_{im} R_{jn} (k_m \\delta_{mn}) $$\n克罗内克δ函数 $\\delta_{mn}$ 仅在 $m=n$ 时非零，这使得其中一个求和（对 $n$ 的求和）消失：\n$$ K_{ij} = \\sum_{m=1}^{3} R_{im} R_{jm} k_m $$\n这个方程可以展开以显示每个主热导率的贡献：\n$$ K_{ij} = k_1 R_{i1} R_{j1} + k_2 R_{i2} R_{j2} + k_3 R_{i3} R_{j3} $$\n这就是实验室坐标系中变换后热导率张量的分量表达式，是第二个要求的表达式。所得的具有分量 $K_{ij}$ 的张量 $\\mathbf{K}$ 是对称的（$K_{ij} = K_{ji}$），因为乘积 $R_{im}R_{jm}$ 关于 $i$ 和 $j$ 是对称的。由于主热导率 $k_m$ 为正，且 $\\mathbf{R}$ 是一个旋转，张量 $\\mathbf{K}$ 保持正定，正如第二定律所要求的那样。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nq_i = -K_{ij} \\frac{\\partial T}{\\partial x_j}  K_{ij} = \\sum_{m=1}^{3} k_{m} R_{im} R_{jm}\n\\end{pmatrix}\n}\n$$", "id": "3508533"}, {"introduction": "在多物理场仿真中，显式地解析系统中的每个微小几何特征（如涂层或粘合层）在计算上是极其昂贵的。本练习介绍了一种强大的建模技术——渐近分析，它能将薄界面层的复杂物理效应简化为一个等效的边界条件。通过推导有效热阻，您将学会如何处理多尺度问题，这是现代计算工程中的一项核心技能。[@problem_id:3508541]", "problem": "考虑两个均匀、各向同性的固体，分别占据区域 $x0$ 和 $x\\delta$，其热导率分别为常数 $k_{1}$ 和 $k_{2}$。它们之间由一个占据 $0x\\delta$ 的薄界面层隔开，该层具有均匀、各向同性的热导率 $k_{\\ell}$。假设系统处于稳态，没有内部热源，并且温度仅随 $x$ 坐标变化。\n基于在薄层极限（即 $\\delta/L \\ll 1$，其中 $L$ 是系统的宏观长度尺度）下的渐近分析，推导一个有效的传输边界条件，该条件将界面两侧的温度 $T_{1}(x=0)$ 和 $T_{2}(x=\\delta)$ 与穿过界面的热通量 $q$ 关联起来。然后，确定该界面层的有效热阻 $R_\\text{eff}$。", "solution": "该问题要求基于薄层极限下的渐近分析，为分隔两个固体的薄界面层推导一个有效的传输边界条件。我们还必须确定该层的有效热阻。\n\n**问题验证**\n\n问题陈述在科学上基于稳态热传导原理（傅里叶定律和能量守恒）。所提出的任务，即通过渐近简化推导有效边界条件，是输运现象和应用数学中的一种标准且适定的技术。问题的语言是客观的，所有参数都得到了明确定义。诸如材料属性恒定和 $\\delta/L \\ll 1$ 等假设对于该公式是合适的。该问题是有效的。\n\n**推导**\n\n设 $T_1(x)$、$T_\\ell(x)$ 和 $T_2(x)$ 分别为 $x0$ 处固体、$0x\\delta$ 处界面层和 $x\\delta$ 处固体的温度分布。\n在没有内部热源的稳态一维系统中，热传导方程简化为：\n$$\n\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = 0\n$$\n这意味着热通量 $q = -k \\frac{dT}{dx}$ 在整个域中是恒定的。\n\n我们特别关注薄层内部 ($0x\\delta$) 的行为。在该区域内，热导率为 $k_\\ell$。\n$$\n\\frac{dT_\\ell}{dx} = -\\frac{q}{k_\\ell}\n$$\n我们通过对 $x$ 从 $0$ 到 $\\delta$ 积分来找到薄层两端的温度差：\n$$\n\\int_{0}^{\\delta} \\frac{dT_\\ell}{dx} dx = \\int_{0}^{\\delta} -\\frac{q}{k_\\ell} dx\n$$\n$$\nT_\\ell(\\delta) - T_\\ell(0) = -\\frac{q \\delta}{k_\\ell}\n$$\n这可以重新排列为：\n$$\nT_\\ell(0) - T_\\ell(\\delta) = q \\frac{\\delta}{k_\\ell}\n$$\n在理想热接触的界面处，温度是连续的。因此：\n- 在 $x=0$ 处: $T_1(0) = T_\\ell(0)$\n- 在 $x=\\delta$ 处: $T_\\ell(\\delta) = T_2(\\delta)$\n\n将这些连续性条件代入上面的方程，得到：\n$$\nT_1(0) - T_2(\\delta) = q \\frac{\\delta}{k_\\ell}\n$$\n现在我们考虑薄层极限，$\\delta \\to 0$。我们将界面层视为一个数学表面，并定义两侧的温度为 $T_1 = \\lim_{x \\to 0^-} T_1(x)$ 和 $T_2 = \\lim_{x \\to \\delta^+} T_2(x)$。由于我们假设温度在固体1和2中是连续的，我们有 $T_1(0) \\to T_1$ 和 $T_2(\\delta) \\to T_2$。\n在极限 $\\delta \\to 0$ 下，方程变为：\n$$\nT_1 - T_2 = q \\left(\\frac{\\delta}{k_\\ell}\\right)\n$$\n这个方程就是所求的有效边界条件。它表明，在宏观尺度上，薄界面层的作用是在界面上产生一个与穿过它的热通量成正比的温度跳跃。\n\n有效热阻 $R_\\text{eff}$ 定义为单位热通量引起的温度跳跃，即 $R_\\text{eff} = \\frac{\\Delta T}{q}$。从我们的有效边界条件中，我们可以直接确定：\n$$\nR_\\text{eff} = \\frac{T_1 - T_2}{q} = \\frac{\\delta}{k_\\ell}\n$$\n因此，薄界面层的有效热阻为 $\\frac{\\delta}{k_\\ell}$。这与电阻的电学类比是一致的，即电阻等于电阻率乘以长度除以面积（在一维情况下，电阻率对应于 $1/k_\\ell$，长度对应于 $\\delta$）。", "answer": "$$\\boxed{\\frac{\\delta}{k_{\\ell}}}$$", "id": "3508541"}, {"introduction": "涉及移动边界和材料属性突变的物理问题，如熔化和凝固，对数值求解提出了独特的挑战。本练习将指导您实现一种专门处理这类问题的数值方法——幽灵流体法 (GFM)，用于求解一个一维相变问题。您不仅将从物理原理推导出界面运动的方程，还将通过一个简化的模型评估数值伪影（如虚假流）对能量守恒的影响。[@problem_id:3508535]", "problem": "考虑一个一维两相传热问题，该问题定义在一个长度为 $L_x$ 的固定域上，在 $x_s(t)$ 位置存在一个清晰的移动相变界面。两相被不连续的热导率 $k(x)$ 分隔，当 $x  x_s(t)$ 时，$k(x) = k_\\ell$；当 $x > x_s(t)$ 时，$k(x) = k_r$。材料密度 $ \\rho $ 和比热 $ c_p $ 在两相中均为常数且相等，单位质量的相变潜热为 $ L $。每相中的控制能量方程是能量守恒方程，针对温度 $ T(x,t) $ 和相指示函数 $ C(x,t) $（在左相中等于1，在右相中等于0）写为\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k(x)\\frac{\\partial T}{\\partial x}\\right),\n$$\n在相变界面处，辅以温度的连续性和热通量的 Stefan 跳跃条件：\n$$\n[T] = 0, \\quad [ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n,\n$$\n其中 $ [\\cdot] $ 表示跨界面的跳跃，$ \\mathbf{n} $ 是从左相指向右相的单位法向量，$ V_n = \\frac{dx_s}{dt} $ 是法向界面速度。要求您基于虚拟流体法 (Ghost-Fluid Method, GFM) 和流体体积法 (Volume-of-Fluid, VOF) 推导一个数值上易于处理的算法，以在各相中准稳态导热的假设下求解此问题。准稳态假设意味着，在每个时间步长内，各相中的温度场被近似为边界温度和界面温度之间的线性分布。\n\n您的推导应完全基于以下基本原理和定义：\n- 连续介质中的能量守恒，表示为 $ \\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}(k \\frac{\\partial T}{\\partial x}) $。\n- 界面处温度的连续性，$ [T] = 0 $。\n- 移动界面上潜热消耗的 Stefan 条件，$ [ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n $。\n- 分段恒定的材料属性和在域两端的狄利克雷 (Dirichlet) 边界条件。\n\n使用虚拟流体法 (GFM)，将界面视为一个具有指定界面温度 $ T_m $（例如，熔化温度）的内部狄利克雷边界。在每相中，将温度分布近似为相应域边界和 $ T_m $ 之间的线性关系。使用单侧温度梯度计算单侧界面热通量：\n$$\nq_\\ell = k_\\ell \\frac{T_\\ell - T_m}{x_s}, \\quad q_r = k_r \\frac{T_m - T_r}{L_x - x_s},\n$$\n并使用 Stefan 条件推进界面位置：\n$$\nV_n = \\frac{q_\\ell - q_r}{\\rho L}, \\quad x_s^{n+1} = x_s^n + V_n \\Delta t.\n$$\n\n为了评估界面捕捉的流体体积法 (VOF) 离散化中常见的伪速度对能量守恒的影响，模拟一个大小为 $ U_s $ 的人工伪速度场，该速度场独立于 Stefan 更新来平流 VOF 界面。在一维情况下，通过对 VOF 跟踪的界面进行均匀平流位移来近似此过程：\n$$\nx_{s,\\mathrm{VOF}}^{n+1} = x_{s,\\mathrm{VOF}}^n + U_s \\Delta t.\n$$\n\n在准稳态线性分布假设下，将域中的总能量定义为显热和潜热贡献之和：\n$$\nE(x_s) = \\rho c_p\\left[x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s)\\frac{T_m + T_r}{2}\\right] + \\rho L x_s,\n$$\n其中 $ T_\\ell $ 和 $ T_r $ 分别是左端和右端的边界温度。使用此 $ E(x_s) $ 计算最终时刻的两种能量：“GFM 一致”能量 $ E(x_s(t_{\\mathrm{end}})) $ 和“VOF 平流”能量 $ E(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})) $。由伪速度引起的能量守恒误差将度量为\n$$\n\\varepsilon = \\left| E\\big(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})\\big) - E\\big(x_s(t_{\\mathrm{end}})\\big) \\right|\\quad\\text{(单位：焦耳)}.\n$$\n\n任务：\n- 从能量守恒和界面跳跃条件出发，推导上述算法。\n- 实现该算法，使用 Stefan 条件模拟界面位置，并同时对受预设伪速度 $ U_s $ 影响的 VOF 跟踪界面进行平流。使用上述公式计算最终时刻的能量守恒误差 $ \\varepsilon $。\n\n物理和数值单位：\n- 所有长度单位必须是米 ($\\mathrm{m}$)，时间单位是秒 ($\\mathrm{s}$)，温度单位是开尔文 ($\\mathrm{K}$)，密度单位是千克/立方米 ($\\mathrm{kg/m^3}$)，比热单位是焦耳/千克·开尔文 ($\\mathrm{J/(kg\\cdot K)}$)，热导率单位是瓦特/米·开尔文 ($\\mathrm{W/(m\\cdot K)}$)，潜热单位是焦耳/千克 ($\\mathrm{J/kg}$)。\n- 对每个测试用例，以焦耳 ($\\mathrm{J}$) 为单位表示最终的能量守恒误差 $ \\varepsilon $。\n\n测试套件：\n使用以下参数值集（每个测试用例提供 $(L_x, x_s^0, T_\\ell, T_r, T_m, \\rho, c_p, k_\\ell, k_r, L, \\Delta t, N_{\\mathrm{steps}}, U_s)$）：\n\n1. 一般“理想路径”情况，无伪速度：\n   - $ L_x = 1.0 $, $ x_s^0 = 0.6 $, $ T_\\ell = 283.15 $, $ T_r = 263.15 $, $ T_m = 273.15 $, $ \\rho = 1000.0 $, $ c_p = 1000.0 $, $ k_\\ell = 1.0 $, $ k_r = 0.1 $, $ L = 2.5\\times10^5 $, $ \\Delta t = 0.1 $, $ N_{\\mathrm{steps}} = 100 $, $ U_s = 0.0 $。\n\n2. 小伪速度：\n   - 与用例1相同，但 $ U_s = 1.0\\times10^{-5} $。\n\n3. 较大伪速度：\n   - 与用例1相同，但 $ U_s = 5.0\\times10^{-4} $。\n\n4. 边界条件边缘情况（对称，无 Stefan 运动），有伪速度：\n   - $ L_x = 1.0 $, $ x_s^0 = 0.5 $, $ T_\\ell = 273.15 $, $ T_r = 273.15 $, $ T_m = 273.15 $, $ \\rho = 1000.0 $, $ c_p = 1000.0 $, $ k_\\ell = 1.0 $, $ k_r = 1.0 $, $ L = 2.5\\times10^5 $, $ \\Delta t = 0.1 $, $ N_{\\mathrm{steps}} = 100 $, $ U_s = 1.0\\times10^{-4} $。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的能量守恒误差值 $ \\varepsilon $，形式为方括号内以逗号分隔的列表，例如，$ [\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4] $。每个 $ \\varepsilon_i $ 必须是浮点数，单位为焦耳。", "solution": "用户提供了一个关于带移动界面的一维两相传热问题，并要求推导和实现一种数值算法来量化能量守恒误差。该问题需要在准稳态导热假设下，使用虚拟流体法 (GFM) 处理界面动力学进行求解，并将所得系统能量与一个界面被人为伪速度场平流的系统能量进行比较，该伪速度场代表了流体体积法 (VOF) 中的一种伪影。\n\n该问题被验证为具有科学依据、适定且客观。它基于经典的 Stefan 问题，采用了标准假设和数值技术。所有必要的参数都已提供，目标明确。其公式是自洽且物理上合理的。\n\n在此，我们提供了该算法的详细推导，随后是其实现。所有数学实体均按要求使用 LaTeX 渲染。\n\n### 数值算法的推导\n\n推导从问题陈述中列出的基本原理开始。该系统是一维的，定义在域 $x \\in [0, L_x]$ 上，在 $x_s(t)$ 处有一个清晰的相变界面。\n\n**1. 准稳态温度分布**\n\n控制能量守恒方程给出如下：\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k(x)\\frac{\\partial T}{\\partial x}\\right)\n$$\n问题指定了准稳态导热假设。这意味着在单个时间步长 $\\Delta t$ 的短暂时间内，每个体相（$x  x_s$ 和 $x > x_s$）内的温度场瞬间达到稳态。在稳态下，$\\frac{\\partial T}{\\partial t}$ 项消失。$\\frac{\\partial C}{\\partial t}$ 项仅在界面 $x=x_s(t)$ 处非零，因此在每个体相内部为零。因此，每个相中的控制方程简化为：\n$$\n\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = 0\n$$\n由于热导率 $k$ 在每个相内部是常数（左相为 $k_\\ell$，右相为 $k_r$），该方程可以积分两次，得到每个子域中的线性温度分布 $T(x) = Ax + B$。\n\n积分常数由边界条件确定：\n-   在左边界：$T(0) = T_\\ell$\n-   在右边界：$T(L_x) = T_r$\n-   在界面处（在 GFM 框架中被视为狄利克雷边界）：$T(x_s) = T_m$\n\n对于左相 ($x \\in [0, x_s]$):\n分布为 $T(x) = A_\\ell x + B_\\ell$。\n-   $T(0) = T_\\ell \\implies B_\\ell = T_\\ell$。\n-   $T(x_s) = T_m \\implies A_\\ell x_s + T_\\ell = T_m \\implies A_\\ell = \\frac{T_m - T_\\ell}{x_s}$。\n所以，温度分布为 $T(x) = T_\\ell + (T_m - T_\\ell)\\frac{x}{x_s}$。\n\n对于右相 ($x \\in [x_s, L_x]$):\n分布为 $T(x) = A_r (x-x_s) + B_r$。（使用 $x_s$ 作为参考点可以简化代数运算）。\n-   $T(x_s) = T_m \\implies B_r = T_m$。\n-   $T(L_x) = T_r \\implies A_r (L_x - x_s) + T_m = T_r \\implies A_r = \\frac{T_r - T_m}{L_x - x_s}$。\n所以，温度分布为 $T(x) = T_m + (T_r - T_m)\\frac{x - x_s}{L_x - x_s}$。\n\n**2. 从 Stefan 条件推导界面速度**\n\nStefan 跳跃条件规定了界面处热通量不连续性与界面速度 $V_n = \\frac{dx_s}{dt}$ 之间的关系。该条件给出如下：\n$$\n[ -\\mathbf{n} \\cdot k \\nabla T ] = \\rho L V_n\n$$\n在一维情况下，法向量 $\\mathbf{n}$ 从左相指向右相（即沿 $+x$ 方向），该条件变为：\n$$\n\\left(-k \\frac{dT}{dx}\\right)\\Big|_{x=x_s^+} - \\left(-k \\frac{dT}{dx}\\right)\\Big|_{x=x_s^-} = \\rho L V_n\n$$\n温度梯度即为上面推导出的斜率 $A_\\ell$ 和 $A_r$：\n-   $\\frac{dT}{dx}\\Big|_{x=x_s^-} = A_\\ell = \\frac{T_m - T_\\ell}{x_s}$\n-   $\\frac{dT}{dx}\\Big|_{x=x_s^+} = A_r = \\frac{T_r - T_m}{L_x - x_s}$\n\n将这些代入 Stefan 条件：\n$$\n\\left(-k_r \\frac{T_r - T_m}{L_x - x_s}\\right) - \\left(-k_\\ell \\frac{T_m - T_\\ell}{x_s}\\right) = \\rho L V_n\n$$\n整理各项：\n$$\nk_\\ell \\frac{T_\\ell - T_m}{x_s} + k_r \\frac{T_m - T_r}{L_x - x_s} = \\rho L V_n\n$$\n问题陈述将单侧界面热通量定义为 $q_\\ell = k_\\ell \\frac{T_\\ell - T_m}{x_s}$ 和 $q_r = k_r \\frac{T_m - T_r}{L_x - x_s}$。这些代表了在每个相中从边界流向界面的热通量。根据这些定义，方程变为：\n$$\nq_\\ell - q_r = \\rho L V_n\n$$\n这就得出了界面速度的表达式：\n$$\nV_n = \\frac{q_\\ell - q_r}{\\rho L}\n$$\n这就完成了基于准稳态假设的界面速度的推导。\n\n**3. 时间推进算法**\n\n使用前向欧拉法在大小为 $\\Delta t$ 的离散时间步长上更新界面位置。设 $x_s^n$ 为时间 $t_n = n \\Delta t$ 时的界面位置。\n-   **GFM 界面更新：** 位置 $x_s$ 根据物理推导的 Stefan 速度 $V_n$ 进行推进：\n    $$\n    x_s^{n+1} = x_s^n + \\left(\\frac{q_\\ell^n - q_r^n}{\\rho L}\\right) \\Delta t\n    $$\n    其中 $q_\\ell^n = k_\\ell \\frac{T_\\ell - T_m}{x_s^n}$ 和 $q_r^n = k_r \\frac{T_m - T_r}{L_x - x_s^n}$。\n\n-   **VOF 界面平流：** 同时，跟踪第二个界面位置 $x_{s,\\mathrm{VOF}}$。其运动完全由规定的人工伪速度 $U_s$ 控制：\n    $$\n    x_{s,\\mathrm{VOF}}^{n+1} = x_{s,\\mathrm{VOF}}^n + U_s \\Delta t\n    $$\n\n从初始位置 $x_s^0$ 开始，将此过程重复 $N_{\\mathrm{steps}}$ 次，直至最终时间 $t_{\\mathrm{end}} = N_{\\mathrm{steps}} \\Delta t$。\n\n**4. 能量计算与误差度量**\n\n域中的总能量 $E$（每单位横截面积，假设 $A=1 \\text{ m}^2$ 以使单位为焦耳）是显热和潜热贡献之和。\n-   **显热：** 显热是 $\\rho c_p T(x)$ 在整个域上的积分。对于线性温度分布，每个相中的积分就是域长度乘以平均温度。\n    $$\n    E_{\\text{sensible}} = \\int_0^{L_x} \\rho c_p T(x) dx = \\rho c_p \\left( \\int_0^{x_s} T(x) dx + \\int_{x_s}^{L_x} T(x) dx \\right)\n    $$\n    $$\n    E_{\\text{sensible}} = \\rho c_p \\left( x_s \\frac{T(0) + T(x_s)}{2} + (L_x - x_s) \\frac{T(x_s) + T(L_x)}{2} \\right)\n    $$\n    $$\n    E_{\\text{sensible}} = \\rho c_p \\left( x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s) \\frac{T_m + T_r}{2} \\right)\n    $$\n-   **潜热：** 相指示函数 $C(x,t)$ 在左相 ($x  x_s$) 中为 1，在右相中为 0。系统中存储的总潜热（相对于整个域都处于右相的状态）为：\n    $$\n    E_{\\text{latent}} = \\int_0^{L_x} \\rho L C(x,t) dx = \\int_0^{x_s} \\rho L \\cdot 1 \\, dx = \\rho L x_s\n    $$\n-   **总能量：** 两者之和给出了问题中提供的总能量表达式：\n    $$\n    E(x_s) = \\rho c_p\\left[x_s \\frac{T_\\ell + T_m}{2} + (L_x - x_s)\\frac{T_m + T_r}{2}\\right] + \\rho L x_s\n    $$\n由伪速度引起的能量守恒误差 $\\varepsilon$ 定义为使用 VOF 平流后的界面位置 $x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})$ 计算的能量与使用 GFM 一致的界面位置 $x_s(t_{\\mathrm{end}})$ 计算的能量之间的绝对差。\n$$\n\\varepsilon = \\left| E\\big(x_{s,\\mathrm{VOF}}(t_{\\mathrm{end}})\\big) - E\\big(x_s(t_{\\mathrm{end}})\\big) \\right|\n$$\n实现部分将计算这两个最终位置，对每个位置应用能量函数，并计算其差值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the one-dimensional two-phase heat transfer problem to assess the\n    impact of spurious VOF currents on energy conservation.\n    \"\"\"\n    # Test suite: (Lx, xs^0, T_ell, T_r, T_m, rho, c_p, k_ell, k_r, L, dt, N_steps, U_s)\n    test_cases = [\n        # Case 1: General \"happy path\" case with no spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 0.0),\n        # Case 2: Small spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 1.0e-5),\n        # Case 3: Larger spurious currents\n        (1.0, 0.6, 283.15, 263.15, 273.15, 1000.0, 1000.0, 1.0, 0.1, 2.5e5, 0.1, 100, 5.0e-4),\n        # Case 4: Boundary-condition edge case (symmetric, no Stefan motion) with spurious currents\n        (1.0, 0.5, 273.15, 273.15, 273.15, 1000.0, 1000.0, 1.0, 1.0, 2.5e5, 0.1, 100, 1.0e-4)\n    ]\n\n    results = []\n\n    def calculate_energy(xs, Lx, Tl, Tr, Tm, rho, cp, L):\n        \"\"\"\n        Computes the total energy in the domain based on the interface position xs.\n        The energy is per unit cross-sectional area, resulting in units of J.\n        (Implicit assumption: cross-sectional area is 1 m^2).\n        \"\"\"\n        # Sensible heat contribution from the left phase\n        sensible_l = rho * cp * xs * (Tl + Tm) / 2.0\n        # Sensible heat contribution from the right phase\n        sensible_r = rho * cp * (Lx - xs) * (Tm + Tr) / 2.0\n        # Latent heat contribution (left phase has latent heat)\n        latent = rho * L * xs\n        return sensible_l + sensible_r + latent\n\n    for case in test_cases:\n        Lx, xs_0, Tl, Tr, Tm, rho, cp, kl, kr, L, dt, N_steps, Us = case\n        \n        # Initialize interface positions\n        xs_gfm = xs_0  # GFM-consistent interface\n        xs_vof = xs_0  # VOF-advected interface\n\n        # Time-stepping loop\n        for _ in range(N_steps):\n            # Guard against division by zero if interface reaches a boundary\n            if xs_gfm = 0 or xs_gfm >= Lx:\n                break\n            \n            # --- GFM interface update ---\n            # Calculate one-sided heat fluxes\n            q_l = kl * (Tl - Tm) / xs_gfm\n            q_r = kr * (Tm - Tr) / (Lx - xs_gfm)\n            \n            # Calculate interface velocity from Stefan condition\n            Vn = (q_l - q_r) / (rho * L)\n            \n            # Update GFM interface position using forward Euler\n            xs_gfm += Vn * dt\n\n            # --- VOF interface update ---\n            # Advect VOF interface with prescribed spurious velocity\n            xs_vof += Us * dt\n            \n        # Calculate energies at the final time t_end\n        E_gfm = calculate_energy(xs_gfm, Lx, Tl, Tr, Tm, rho, cp, L)\n        E_vof = calculate_energy(xs_vof, Lx, Tl, Tr, Tm, rho, cp, L)\n\n        # Calculate the energy conservation error\n        error = abs(E_vof - E_gfm)\n        results.append(error)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n\n```", "id": "3508535"}]}