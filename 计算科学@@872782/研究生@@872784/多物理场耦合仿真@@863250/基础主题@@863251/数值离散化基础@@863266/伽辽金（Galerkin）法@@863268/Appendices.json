{"hands_on_practices": [{"introduction": "将连续的偏微分方程（PDE）转化为离散的代数方程组是伽辽金有限元方法的核心。这个练习将指导你完成这一基本过程，从一个典型的一维扩散-反应方程出发，推导单元刚度矩阵和质量矩阵。通过亲手构建和组装全局系统矩阵，你将对伽辽金法如何将物理定律的微分形式转化为可计算的线性系统有更深刻的理解 [@problem_id:3528432]。", "problem": "考虑区间 $(0,1)$ 上的标量扩散-反应偏微分方程 (PDE)，\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f,$$\n其中 $k>0$ 和 $c\\ge 0$ 是空间常系数。使用伽辽金法和有限元法 (FEM)，在 $(0,1)$ 的网格上采用连续分段线性形函数（$P_1$ 单元）。\n\n从通过加权余量法原理和分部积分得到的弱形式出发，推导任意长度为 $h_e$ 的单元上的单元级双线性形式，并计算常数 $k$ 和 $c$ 下算子 $-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u$ 的单元刚度矩阵和单元反应-质量矩阵。然后，考虑将 $(0,1)$ 均匀划分为三个等长单元，节点为 $x_0=0$，$x_1=\\frac{1}{3}$，$x_2=\\frac{2}{3}$，$x_3=1$，并施加齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n为对应于节点 $x_1$ 和 $x_2$ 的两个内部自由度组装全局伽辽金系统矩阵，最终组装的矩阵应完全用 $k$ 和 $c$ 表示。请提供最终组装的全局矩阵作为答案。无需四舍五入。最终表达式中不包含任何物理单位。", "solution": "此问题有效。这是一个来自数学物理的适定边值问题，适合使用指定的有限元法求解。唯一推导所需的所有条件和数据均已提供。\n\n控制偏微分方程 (PDE) 是在域 $\\Omega = (0,1)$ 上的稳态扩散-反应方程：\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u = f(x)$$\n其中系数 $k$ 和 $c$ 是正常数。\n\n伽辽金法的第一步是推导弱形式。我们将 PDE 乘以一个来自合适函数空间的检验函数 $v(x)$，并在域 $\\Omega$ 上积分：\n$$\\int_{0}^{1} \\left(-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right) + c\\,u\\right)v \\,dx = \\int_{0}^{1} f v \\,dx$$\n对二阶项应用分部积分得到：\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx}\\right) dx - \\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1} + \\int_{0}^{1} (c\\,u\\,v) \\,dx = \\int_{0}^{1} f v \\,dx$$\n检验函数 $v$ 选自试探解空间，该空间必须满足齐次形式的狄利克雷边界条件。问题指定 $u(0)=0$ 和 $u(1)=0$。因此，我们要求 $v(0)=0$ 和 $v(1)=0$。这使得边界项 $\\left[k\\,\\frac{du}{dx}v\\right]_{0}^{1}$ 为零。\n\n得到的弱形式是：寻找 $u$，使得对于所有有效的检验函数 $v$，\n$$\\int_{0}^{1} \\left(k\\,\\frac{du}{dx}\\frac{dv}{dx} + c\\,u\\,v\\right) dx = \\int_{0}^{1} f v \\,dx$$\n这可以写成抽象形式 $a(u,v) = L(v)$，其中双线性形式 $a(u,v)$ 代表左侧，线性泛函 $L(v)$ 代表右侧。\n\n接下来，我们对域和解进行离散化。解 $u(x)$ 由函数 $u_h(x)$ 近似，它是分段线性基函数（形函数）$N_j(x)$ 的线性组合：\n$$u(x) \\approx u_h(x) = \\sum_{j} U_j N_j(x)$$\n这里，$U_j$ 是近似解的节点值。在伽辽金法中，检验函数 $v$ 选自同一组基函数，即对于每个节点 $i$，$v(x) = N_i(x)$。将这些代入弱形式，得到伽辽金线性方程组 $A \\mathbf{U} = \\mathbf{F}$，其中系统矩阵 $A$ 的各项由下式给出：\n$$A_{ij} = a(N_j, N_i) = \\int_{0}^{1} \\left(k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\right) dx + \\int_{0}^{1} \\left(c\\,N_j N_i\\right) dx$$\n矩阵 $A$ 可以表示为刚度矩阵 $K$ 和反应-质量矩阵 $C$ 的和：\n$$A_{ij} = K_{ij} + C_{ij}$$\n其中 $K_{ij} = \\int_{0}^{1} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx} dx$ 且 $C_{ij} = \\int_{0}^{1} c\\,N_j N_i dx$。\n\n我们现在在一个长度为 $h_e = x_b - x_a$ 的通用单元 $\\Omega_e = [x_a, x_b]$ 上推导单元级矩阵。我们使用局部坐标系 $\\xi \\in [0, 1]$，其中 $x(\\xi) = x_a + \\xi h_e$。求导的链式法则给出 $\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{h_e}\\frac{d}{d\\xi}$。局部坐标系中的分段线性形函数为 $N_1(\\xi) = 1-\\xi$ 和 $N_2(\\xi) = \\xi$。它们的导数为 $\\frac{dN_1}{d\\xi} = -1$ 和 $\\frac{dN_2}{d\\xi} = 1$。\n\n单元刚度矩阵 $K^e$ 的分量为：\n$$K^e_{ij} = \\int_{\\Omega_e} k\\,\\frac{dN_j}{dx}\\frac{dN_i}{dx}\\,dx = k \\int_{0}^{1} \\left(\\frac{1}{h_e}\\frac{dN_j}{d\\xi}\\right)\\left(\\frac{1}{h_e}\\frac{dN_i}{d\\xi}\\right) h_e\\,d\\xi = \\frac{k}{h_e} \\int_{0}^{1} \\frac{dN_j}{d\\xi}\\frac{dN_i}{d\\xi}\\,d\\xi$$\n计算四个分量：\n$K^e_{11} = \\frac{k}{h_e}\\int_0^1 (-1)(-1) d\\xi = \\frac{k}{h_e}$\n$K^e_{12} = \\frac{k}{h_e}\\int_0^1 (1)(-1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{21} = \\frac{k}{h_e}\\int_0^1 (-1)(1) d\\xi = -\\frac{k}{h_e}$\n$K^e_{22} = \\frac{k}{h_e}\\int_0^1 (1)(1) d\\xi = \\frac{k}{h_e}$\n因此，单元刚度矩阵为：\n$$K^e = \\frac{k}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n\n单元反应-质量矩阵 $C^e$ 的分量为：\n$$C^e_{ij} = \\int_{\\Omega_e} c\\,N_j N_i\\,dx = c\\int_{0}^{1} N_j(\\xi)N_i(\\xi) h_e\\,d\\xi = c h_e \\int_{0}^{1} N_j(\\xi)N_i(\\xi) \\,d\\xi$$\n计算四个分量：\n$C^e_{11} = c h_e \\int_0^1 (1-\\xi)^2 d\\xi = c h_e \\left[-\\frac{(1-\\xi)^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\n$C^e_{12} = c h_e \\int_0^1 (1-\\xi)\\xi d\\xi = c h_e \\left[\\frac{\\xi^2}{2}-\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{6}$\n$C^e_{21} = C^e_{12} = \\frac{c h_e}{6}$\n$C^e_{22} = c h_e \\int_0^1 \\xi^2 d\\xi = c h_e \\left[\\frac{\\xi^3}{3}\\right]_{0}^{1} = \\frac{c h_e}{3}$\n因此，单元反应-质量矩阵为：\n$$C^e = \\frac{c h_e}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n\n总的单元系统矩阵为 $A^e = K^e + C^e$。\n\n对于具体问题，域 $(0,1)$ 被划分为三个等长单元。节点位于 $x_0=0$，$x_1=1/3$，$x_2=2/3$ 和 $x_3=1$。每个单元的长度为 $h_e = 1/3$。\n将 $h_e=1/3$ 代入单元矩阵表达式：\n$K^e = \\frac{k}{1/3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 3k \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n$C^e = \\frac{c(1/3)}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{c}{18} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$\n单元系统矩阵 $A^e$ 为：\n$$A^e = \\begin{pmatrix} 3k + \\frac{2c}{18}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  3k + \\frac{2c}{18} \\end{pmatrix} = \\begin{pmatrix} 3k + \\frac{c}{9}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  3k + \\frac{c}{9} \\end{pmatrix}$$\n\n通过对三个单元的贡献求和来组装全局系统矩阵。自由度为 $U_0, U_1, U_2, U_3$。\n单元 $1$（节点 $0, 1$）将 $A^e$ 贡献给行/列 $0, 1$ 的子矩阵。\n单元 $2$（节点 $1, 2$）将 $A^e$ 贡献给行/列 $1, 2$ 的子矩阵。\n单元 $3$（节点 $2, 3$）将 $A^e$ 贡献给行/列 $2, 3$ 的子矩阵。\n\n施加边界条件前的全局矩阵 $A_{global}$ 是一个 $4 \\times 4$ 矩阵：\n$$A_{global} = \\begin{pmatrix} A^e_{11}  A^e_{12}  0  0 \\\\ A^e_{21}  A^e_{22}+A^e_{11}  A^e_{12}  0 \\\\ 0  A^e_{21}  A^e_{22}+A^e_{11}  A^e_{12} \\\\ 0  0  A^e_{21}  A^e_{22} \\end{pmatrix}$$\n代入数值：\n$A^e_{11} = A^e_{22} = 3k + \\frac{c}{9}$\n$A^e_{12} = A^e_{21} = -3k + \\frac{c}{18}$\n$A^e_{22} + A^e_{11} = 2(3k + \\frac{c}{9}) = 6k + \\frac{2c}{9}$\n\n问题施加了齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。这固定了节点值 $U_0=0$ 和 $U_3=0$。我们关心的是未知内部自由度 $U_1$ 和 $U_2$ 的系统。该系统通过取 $A_{global}$ 中对应于行 $1$、$2$ 和列 $1$、$2$ 的 $2 \\times 2$ 子矩阵得到：\n$$A_{interior} = \\begin{pmatrix} A^e_{22}+A^e_{11}  A^e_{12} \\\\ A^e_{21}  A^e_{22}+A^e_{11} \\end{pmatrix}$$\n代入矩阵各项的表达式：\n$$A_{interior} = \\begin{pmatrix} 6k + \\frac{2c}{9}  -3k + \\frac{c}{18} \\\\ -3k + \\frac{c}{18}  6k + \\frac{2c}{9} \\end{pmatrix}$$\n这就是两个内部自由度的最终组装的全局伽辽金系统矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6k + \\frac{2c}{9}  -3k + \\frac{c}{18} \\\\\n-3k + \\frac{c}{18}  6k + \\frac{2c}{9}\n\\end{pmatrix}\n}\n$$", "id": "3528432"}, {"introduction": "伽辽金法的强大之处在于其广泛的适用性，它不仅能求解源问题，还能有效处理特征值问题，这在多物理场仿真的模态分析和动力学研究中至关重要。本练习将伽辽金法应用于求解一维亥姆霍兹方程的特征值，你需要组装刚度矩阵 $K$ 和质量矩阵 $M$，并求解广义特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$。通过将计算出的离散特征值与精确解进行比较，你还能初步体会到离散化误差的概念 [@problem_id:3528326]。", "problem": "在多物理场耦合仿真中，模态分析和算子分裂通常需要求解由耦合算子产生的标量椭圆特征问题。考虑从单位区间上的拉普拉斯算子得到的典型一维亥姆霍兹型特征问题：寻找非平凡的 $u$ 和 $\\lambda$，使得在 $(0,1)$ 上有 $-u'' = \\lambda u$，并满足齐次狄利克雷边界条件 $u(0)=u(1)=0$。从通过分部积分推导并在索博列夫空间 $H_0^1(0,1)$ 中施加边界条件得到的弱形式出发，使用有限元法（FEM）在 $(0,1)$ 上的一个包含3个单元的均匀网格上，采用分段线性多项式空间（$P_1$）进行 Bubnov–Galerkin 离散化。组装相容刚度矩阵 $K$ 和质量矩阵 $M$，构建广义矩阵特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$，并计算其最小特征值 $\\lambda_h$。连续问题的精确第一特征值为 $\\lambda_1=\\pi^2$。报告无量纲比较比率 $r=\\lambda_h/\\lambda_1$，结果四舍五入到4位有效数字。以纯数字形式表示您的答案（无单位）。", "solution": "用户提供了一个在尝试求解前需要验证的问题。\n\n### 第一步：提取已知条件\n- **微分方程**：$-u'' = \\lambda u$\n- **定义域**：$(0,1)$\n- **边界条件**：$u(0)=0$, $u(1)=0$（齐次狄利克雷）\n- **函数空间**：索博列夫空间 $H_0^1(0,1)$\n- **离散化方法**：Bubnov-Galerkin 有限元法（FEM）\n- **单元类型**：分段线性多项式（$P_1$）\n- **网格**：$(0,1)$ 上的3个单元的均匀网格\n- **要求输出**：\n    1. 相容刚度矩阵 $K$ 和质量矩阵 $M$。\n    2. 广义矩阵特征值问题 $K\\mathbf{u}=\\lambda M\\mathbf{u}$ 的构建。\n    3. 矩阵问题的最小特征值 $\\lambda_h$。\n- **比较**：无量纲比率 $r=\\lambda_h/\\lambda_1$，其中 $\\lambda_1=\\pi^2$ 是连续问题的精确第一特征值。结果必须四舍五入到4位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是将有限元法应用于 Sturm-Liouville 特征值问题（一维亥姆霍兹方程）的一个典型例子。这是数值分析和计算物理学中的一个基本课题。该问题在科学上和数学上都是合理的。\n- **适定性**：该问题是适定的。连续问题具有已知、唯一且稳定的特征值和特征函数解集。离散化后的问题也是适定的，会得到一个对称正定的广义矩阵特征值问题，其特征值为正实数。\n- **客观性**：语言精确、技术性强，没有任何主观性或歧义。\n- **完整性**：提供了所有必要信息。偏微分方程（PDE）、定义域、边界条件、离散化方法、单元类型和网格规格都已明确说明。\n- **其他标准**：该问题并非无足轻重、自相矛盾或无法验证。它是应用数学中一个标准的、可解的问题。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 解答推导\n问题是在区间 $(0,1)$ 上找到特征问题 $-u'' = \\lambda u$ 的非平凡解 $(u, \\lambda)$，其边界条件为 $u(0)=u(1)=0$。\n\n首先，我们推导弱形式。我们将微分方程乘以一个来自解空间 $H_0^1(0,1)$ 的测试函数 $v$（该空间包含了边界条件 $v(0)=v(1)=0$），并在定义域 $\\Omega=(0,1)$上积分：\n$$-\\int_0^1 u''(x) v(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\n我们对左侧进行分部积分：\n$$-\\left[ u'(x)v(x) \\right]_0^1 + \\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx$$\n由于测试函数 $v \\in H_0^1(0,1)$，我们有 $v(0)=0$ 和 $v(1)=0$。因此，边界项 $[u'v]_0^1$ 为零。问题的弱形式是：寻找 $u \\in H_0^1(0,1)$ 和 $\\lambda \\in \\mathbb{R}$，使得\n$$\\int_0^1 u'(x) v'(x) \\, dx = \\lambda \\int_0^1 u(x) v(x) \\, dx \\quad \\forall v \\in H_0^1(0,1)$$\n这可以用双线性形式 $a(u,v) = \\int_0^1 u'(x) v'(x) \\, dx$ 和 $b(u,v) = \\int_0^1 u(x) v(x) \\, dx$ 来表示，即 $a(u,v)=\\lambda b(u,v)$。\n\n接下来，我们进行 Bubnov-Galerkin 离散化。将定义域 $(0,1)$ 划分为3个均匀单元，因此单元尺寸为 $h=1/3$。节点位于 $x_0=0$、$x_1=1/3$、$x_2=2/3$ 和 $x_3=1$。解空间由分段线性（$P_1$）多项式的有限维空间 $V_h \\subset H_0^1(0,1)$ 来近似。由于齐次狄利克雷边界条件，边界节点 $x_0$ 和 $x_3$ 处的自由度为零。我们只有两个活动的内部节点，$x_1$ 和 $x_2$。\n\n$V_h$ 的基由两个线性的“帽子”函数 $\\phi_1(x)$ 和 $\\phi_2(x)$ 组成，它们分别与内部节点 $x_1$ 和 $x_2$ 相关联。近似解 $u_h(x)$ 是这些基函数的线性组合：\n$$u_h(x) = U_1 \\phi_1(x) + U_2 \\phi_2(x) = \\sum_{j=1}^{2} U_j \\phi_j(x)$$\n其中 $U_1$ 和 $U_2$ 是解在 $x_1$ 和 $x_2$ 处的未知节点值。\n\n在 Bubnov-Galerkin 方法中，测试函数与试探函数选自同一空间，即 $v_h(x) = \\phi_i(x)$，其中 $i=1,2$。将 $u_h$ 和 $v_h$ 代入弱形式，得到一个代数方程组：\n$$\\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx \\right) = \\lambda_h \\sum_{j=1}^{2} U_j \\left( \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx \\right) \\quad \\text{for } i=1,2$$\n这就是广义矩阵特征值问题 $K\\mathbf{u} = \\lambda_h M\\mathbf{u}$，其中 $\\mathbf{u} = [U_1, U_2]^T$，刚度矩阵 $K$ 和质量矩阵 $M$ 的元素为：\n$$K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\, dx$$\n$$M_{ij} = b(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i(x) \\phi_j(x) \\, dx$$\n\n我们组装这些矩阵。对于长度为 $h$ 的标准线性单元，单元刚度矩阵 $k^e$ 和单元质量矩阵 $m^e$ 为：\n$$k^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad m^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n在我们的问题中，$h=1/3$，所以：\n$$k^e = \\frac{1}{1/3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 3 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$$\n$$m^e = \\frac{1/3}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}$$\n我们为两个内部自由度（对应于节点 $x_1$ 和 $x_2$）组装全局矩阵。\n刚度矩阵 $K$ 是由所有三个单元的贡献组装而成的：\n$$K = 3 \\begin{pmatrix} 1+1  -1 \\\\ -1  1+1 \\end{pmatrix} = 3 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$$\n质量矩阵 $M$ 也以类似方式组装：\n$$M = \\frac{1}{18} \\begin{pmatrix} 2+2  1 \\\\ 1  2+2 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix}$$\n得到的广义矩阵特征值问题是：\n$$\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix} = \\lambda_h \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\end{pmatrix}$$\n为了求特征值 $\\lambda_h$，我们求解特征方程 $\\det(K - \\lambda_h M) = 0$。\n$$\\det\\left( \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} - \\frac{\\lambda_h}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\right) = 0$$\n$$\\det\\begin{pmatrix} 6 - \\frac{4\\lambda_h}{18}  -3 - \\frac{\\lambda_h}{18} \\\\ -3 - \\frac{\\lambda_h}{18}  6 - \\frac{4\\lambda_h}{18} \\end{pmatrix} = 0$$\n这给出了方程：\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right)^2 - \\left(-3 - \\frac{\\lambda_h}{18}\\right)^2 = 0$$\n这是一个平方差公式 $A^2 - B^2 = (A-B)(A+B) = 0$。\n情况1：$A-B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) - \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$9 - \\frac{3\\lambda_h}{18} = 0 \\implies 9 - \\frac{\\lambda_h}{6} = 0 \\implies \\lambda_h = 54$$\n情况2：$A+B=0$\n$$\\left(6 - \\frac{4\\lambda_h}{18}\\right) + \\left(-3 - \\frac{\\lambda_h}{18}\\right) = 0$$\n$$3 - \\frac{5\\lambda_h}{18} = 0 \\implies 3 = \\frac{5\\lambda_h}{18} \\implies \\lambda_h = \\frac{3 \\times 18}{5} = \\frac{54}{5} = 10.8$$\n两个特征值是 $\\lambda_{h,1}=10.8$ 和 $\\lambda_{h,2}=54$。最小的特征值是 $\\lambda_h = 10.8$。\n\n最后，我们计算所需的无量纲比较比率 $r = \\lambda_h / \\lambda_1$。连续问题的精确第一特征值是 $\\lambda_1 = \\pi^2$。\n$$r = \\frac{10.8}{\\pi^2}$$\n使用值 $\\pi^2 \\approx 9.8696044...$，我们得到：\n$$r \\approx \\frac{10.8}{9.8696044} \\approx 1.0942699$$\n四舍五入到4位有效数字，我们得到 $r=1.094$。", "answer": "$$\\boxed{1.094}$$", "id": "3528326"}, {"introduction": "在实际的有限元分析中，我们通常使用数值积分（求积）来计算单元矩阵，而积分的精度直接影响着求解的准确性。这个练习揭示了一个被称为“变分犯罪”的常见陷阱：当数值积分的精度不足以精确计算基函数构成的被积函数时，伽辽金法的理论优势就会受到损害。通过分析一个使用不精确积分计算的二次单元的特征值问题，你将量化这种“犯罪”对结果的影响，从而理解为何在实践中必须保证积分的充分精确性 [@problem_id:3528433]。", "problem": "考虑在一维声-弹性耦合中作为声学子问题出现的一维亥姆霍兹特征值问题：求 $u$ 和 $\\lambda$ 使得 $-u''(x) = \\lambda u(x)$ 对于 $x \\in (0,\\pi)$ 成立，并满足齐次狄利克雷（Dirichlet）边界条件 $u(0) = 0$ 和 $u(\\pi) = 0$。其弱形式为：求 $u \\in H_{0}^{1}(0,\\pi)$ 和 $\\lambda \\in \\mathbb{R}$，使得对于所有 $v \\in H_{0}^{1}(0,\\pi)$，都有 $\\int_{0}^{\\pi} u'(x) v'(x) \\, dx = \\lambda \\int_{0}^{\\pi} u(x) v(x) \\, dx$。使用伽辽金（Galerkin）法，在 $(0,\\pi)$ 上的单单元二次拉格朗日（Lagrange）子空间中近似 $u$，该子空间的节点位于 $x=0$、$x=\\pi/2$ 和 $x=\\pi$，其中端点自由度因边界条件而被约束为零。设唯一的基函数是由参考单元 $\\xi \\in [-1,1]$ 上的中点二次形函数 $\\hat{\\varphi}(\\xi) = 1 - \\xi^{2}$ 通过仿射映射 $x = \\frac{\\pi}{2}(\\xi+1)$ 得到的。\n\n1. 从第一性原理推导精确单元刚度 $K = \\int_{0}^{\\pi} \\left(\\frac{d\\varphi}{dx}\\right)^{2} \\, dx$ 和精确单元质量 $M = \\int_{0}^{\\pi} \\varphi^{2} \\, dx$，其中 $\\varphi(x) = \\hat{\\varphi}(\\xi(x))$。\n\n2. 解释在精确计算 $K$ 的同时，通过在参考单元上使用单点高斯-勒让德（Gauss–Legendre）求积法则（节点为 $\\xi=0$，权重为 $2$）来计算 $M$，为何在伽辽金法中构成了一个“变分罪”（variational crime），并推导降阶积分质量 $M_{\\text{under}}$。\n\n3. 在此单自由度子空间中，广义有限元（Finite Element Method (FEM)）特征值问题简化为标量方程 $K = \\lambda M$（若 $M$ 精确）或 $K = \\lambda M_{\\text{under}}$（若质量为降阶积分）。计算相应的离散特征值 $\\lambda_{\\text{FE}}^{\\text{exact}}$ 和 $\\lambda_{\\text{FE}}^{\\text{under}}$。\n\n4. $(0,\\pi)$ 上亥姆霍兹问题的精确第一个连续特征值为 $\\lambda_{1} = 1$。通过计算相对误差 $\\delta = \\frac{|\\lambda_{\\text{FE}}^{\\text{under}} - \\lambda_{1}|}{\\lambda_{1}}$ 来量化降阶积分的影响。将最终结果表示为单一的闭式解析表达式。最终结果是无量纲的；不要附加单位，也不要进行四舍五入。", "solution": "该问题要求对亥姆霍兹特征值问题的一维有限元近似进行多步分析。对问题陈述的验证已确认其是适定的、科学上合理的，并包含了所有必要信息。我们开始进行解答。\n\n问题的核心涉及将积分从物理域 $x \\in [0, \\pi]$ 变换到参考单元 $\\xi \\in [-1, 1]$。给定的仿射映射为 $x(\\xi) = \\frac{\\pi}{2}(\\xi+1)$。此变换的雅可比（Jacobian）为 $J = \\frac{dx}{d\\xi} = \\frac{\\pi}{2}$。导数的逆映射由链式法则给出：$\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{J}\\frac{d}{d\\xi} = \\frac{2}{\\pi}\\frac{d}{d\\xi}$。物理域中唯一的基函数 $\\varphi(x)$ 对应于参考二次形函数 $\\hat{\\varphi}(\\xi) = 1 - \\xi^2$。\n\n**1. 单元刚度 $K$ 和质量 $M$ 的推导**\n\n首先，我们计算单元刚度贡献 $K$。刚度定义为 $K = \\int_{0}^{\\pi} \\left(\\frac{d\\varphi}{dx}\\right)^{2} \\, dx$。我们必须首先用参考坐标 $\\xi$ 来表示导数 $\\frac{d\\varphi}{dx}$。\n$$\n\\frac{d\\varphi}{dx} = \\frac{1}{J} \\frac{d\\hat{\\varphi}}{d\\xi} = \\frac{2}{\\pi} \\frac{d}{d\\xi}(1 - \\xi^2) = \\frac{2}{\\pi} (-2\\xi) = -\\frac{4\\xi}{\\pi}\n$$\n现在，我们将 $K$ 的积分变换到参考域，注意到微分元变换为 $dx = J d\\xi = \\frac{\\pi}{2} d\\xi$。\n$$\nK = \\int_{-1}^{1} \\left(-\\frac{4\\xi}{\\pi}\\right)^2 J \\, d\\xi = \\int_{-1}^{1} \\frac{16\\xi^2}{\\pi^2} \\left(\\frac{\\pi}{2}\\right) \\, d\\xi = \\frac{8}{\\pi} \\int_{-1}^{1} \\xi^2 \\, d\\xi\n$$\n该积分很容易计算：\n$$\n\\int_{-1}^{1} \\xi^2 \\, d\\xi = \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{1^3}{3} - \\frac{(-1)^3}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\n将此结果代回，得到精确刚度：\n$$\nK = \\frac{8}{\\pi} \\left(\\frac{2}{3}\\right) = \\frac{16}{3\\pi}\n$$\n接下来，我们计算单元质量贡献 $M$。质量定义为 $M = \\int_{0}^{\\pi} \\varphi(x)^2 \\, dx$。我们同样将此积分变换到参考域。\n$$\nM = \\int_{-1}^{1} \\hat{\\varphi}(\\xi)^2 J \\, d\\xi = \\int_{-1}^{1} (1 - \\xi^2)^2 \\left(\\frac{\\pi}{2}\\right) \\, d\\xi = \\frac{\\pi}{2} \\int_{-1}^{1} (1 - 2\\xi^2 + \\xi^4) \\, d\\xi\n$$\n计算此积分：\n$$\n\\int_{-1}^{1} (1 - 2\\xi^2 + \\xi^4) \\, d\\xi = \\left[\\xi - \\frac{2\\xi^3}{3} + \\frac{\\xi^5}{5}\\right]_{-1}^{1} = \\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right) - \\left(-1 + \\frac{2}{3} - \\frac{1}{5}\\right) = 2\\left(1 - \\frac{2}{3} + \\frac{1}{5}\\right)\n$$\n$$\n= 2\\left(\\frac{15 - 10 + 3}{15}\\right) = 2\\left(\\frac{8}{15}\\right) = \\frac{16}{15}\n$$\n将此结果代入，得到精确质量：\n$$\nM = \\frac{\\pi}{2} \\left(\\frac{16}{15}\\right) = \\frac{8\\pi}{15}\n$$\n\n**2. 变分罪与降阶积分质量 $M_{\\text{under}}$**\n\n在伽辽金有限元法的背景下，“变分罪”（variational crime）指的是使用数值近似（通常是数值求积），而这种近似与在所选有限元空间中函数精确满足弱形式的要求不一致。伽辽金法的理论威力，包括其最佳逼近性质，源于将连续问题精确地投影到一个有限维子空间上。这要求对弱形式中的各项进行精确积分。\n\n在这个问题中，刚度项 $K$ 涉及对 $\\left(\\frac{d\\varphi}{dx}\\right)^{2}$ 进行积分，这是关于 $\\xi$ 的一个 2 次多项式。质量项 $M$ 涉及对 $\\varphi(x)^2$ 进行积分，这是关于 $\\xi$ 的一个 4 次多项式。一个 $n$ 点的高斯-勒让德（Gauss-Legendre）求积法则可以精确地积分最高 $2n-1$ 次的多项式。要精确计算 $K$，需要一个满足 $2n-1 \\ge 2$ 的法则，即 $n \\ge 2$ 个点。要精确计算 $M$，需要一个满足 $2n-1 \\ge 4$ 的法则，即 $n \\ge 3$ 个点。\n\n题目描述了精确计算 $K$ 但在参考单元上使用单点高斯-勒让德法则计算 $M$。该法则仅对 $2(1)-1=1$ 次多项式是精确的。用它来对质量积分中的四次多项式进行积分是降阶积分的一个例子。这种不一致——对刚度双线性形式使用精确计算，而对质量双线性形式使用非精确计算——破坏了伽辽金投影的一致性，并构成了“变分罪”。\n\n我们现在使用指定的单点求积法则计算降阶积分质量 $M_{\\text{under}}$。对于 $[-1, 1]$ 上的积分，法则是 $\\int_{-1}^{1} f(\\xi) \\, d\\xi \\approx w_1 f(\\xi_1)$，其中节点为 $\\xi_1 = 0$，权重为 $w_1 = 2$。质量积分的被积函数是 $f(\\xi) = \\hat{\\varphi}(\\xi)^2 J = (1-\\xi^2)^2 \\frac{\\pi}{2}$。\n$$\nM_{\\text{under}} \\approx w_1 f(\\xi_1) = 2 \\cdot \\left[ (1 - 0^2)^2 \\frac{\\pi}{2} \\right] = 2 \\cdot \\left(\\frac{\\pi}{2}\\right) = \\pi\n$$\n\n**3. 离散特征值 $\\lambda_{\\text{FE}}^{\\text{exact}}$ 和 $\\lambda_{\\text{FE}}^{\\text{under}}$**\n\n对于单自由度系统，广义有限元特征值问题简化为标量方程 $K = \\lambda M$。因此，离散特征值为 $\\lambda = K/M$。\n\n使用精确计算的 $K$ 和 $M$：\n$$\n\\lambda_{\\text{FE}}^{\\text{exact}} = \\frac{K}{M} = \\frac{16/(3\\pi)}{8\\pi/15} = \\frac{16}{3\\pi} \\cdot \\frac{15}{8\\pi} = \\frac{2 \\cdot 5}{\\pi^2} = \\frac{10}{\\pi^2}\n$$\n使用精确计算的 $K$ 和降阶积分质量 $M_{\\text{under}}$：\n$$\n\\lambda_{\\text{FE}}^{\\text{under}} = \\frac{K}{M_{\\text{under}}} = \\frac{16/(3\\pi)}{\\pi} = \\frac{16}{3\\pi^2}\n$$\n\n**4. 降阶积分的影响**\n\n题目指出，连续问题的精确第一特征值为 $\\lambda_1 = 1$。我们被要求通过计算相对误差 $\\delta = \\frac{|\\lambda_{\\text{FE}}^{\\text{under}} - \\lambda_{1}|}{\\lambda_{1}}$ 来量化“变分罪”的影响。\n$$\n\\delta = \\frac{\\left|\\frac{16}{3\\pi^2} - 1\\right|}{1} = \\left|\\frac{16}{3\\pi^2} - 1\\right|\n$$\n为了去掉绝对值，我们注意到 $\\pi \\approx 3.14$，所以 $\\pi^2 \\approx 9.87$。那么 $3\\pi^2 \\approx 29.61$。分数 $\\frac{16}{3\\pi^2}$ 约等于 $\\frac{16}{29.61}$，它小于 $1$。因此，绝对值内的表达式是负的。\n$$\n\\delta = -\\left(\\frac{16}{3\\pi^2} - 1\\right) = 1 - \\frac{16}{3\\pi^2}\n$$\n将此表示为单个分数，得到最终的解析表达式：\n$$\n\\delta = \\frac{3\\pi^2 - 16}{3\\pi^2}\n$$", "answer": "$$\n\\boxed{1 - \\frac{16}{3\\pi^2}}\n$$", "id": "3528433"}]}