{"hands_on_practices": [{"introduction": "要真正掌握空间离散化，理论必须与实践相结合。本节提供了一系列动手练习，旨在巩固您对核心概念的理解，从评估单个网格单元的质量到验证整个模拟的准确性。第一个练习着重于网格的基本构件：单个单元。数值模拟的稳定性和准确性很大程度上取决于网格单元的几何质量。像最小内角和宽高比这样的度量标准可以量化一个单元在几何上的“良好程度”，这直接影响到有限元近似中系统矩阵的条件数和解的准确性。这项练习 [@problem_id:3526260] 将引导您完成评估一个三角形单元质量所需的基本几何计算，让您对这些关键的稳定性度量有一个具体的认识。", "problem": "一种热弹性流固耦合的离散化方法，使用有限元法（FEM）和混合稳定化技术，在共享的非结构化三角网格上耦合了不可压缩流体和热方程。为了保证矫顽性和算子条件，施加了局部单元质量要求：最小内角必须超过一个指定的阈值，且纵横比必须有界。考虑一个平面上的三角形，其顶点为 $A = (0, 0)$、$B = (1.8, 0.6)$ 和 $C = (0.2, 2.0)$。你需要计算最小内角和一个由外接圆半径与内切圆半径之比定义的纵横比，然后构成一个标量稳定性度量。\n\n从核心的Euclidean几何定义和经过验证的公式出发，执行以下操作：\n- 使用欧几里得范数计算边长。\n- 使用叉积的模计算面积。\n- 使用两向量之间夹角的点积定义计算每个内角。\n- 通过基本关系式，由面积和边长计算内切圆半径和外接圆半径。\n- 定义纵横比为 $\\rho = \\dfrac{R}{r}$，其中 $R$ 是外接圆半径，$r$ 是内切圆半径。\n- 设稳定性度量为 $q = \\dfrac{\\theta_{\\min}}{\\rho}$，其中 $\\theta_{\\min}$ 是以弧度为单位的最小内角。\n- 规定的稳定性阈值为 $\\theta_{\\min} \\geq \\theta_{0}$（其中 $\\theta_{0} = 0.6$）和 $\\rho \\leq \\rho_{0}$（其中 $\\rho_{0} = 3.0$）。评估该三角形是否同时满足这两个阈值，但仅报告标量 $q$。\n\n将你最终的稳定性度量 $q$ 四舍五入到四位有效数字。所有角度均以弧度表示。最终答案必须是一个实数值。", "solution": "该问题要求为一个由其在二维平面中的顶点定义的给定三角形单元计算稳定性度量 $q$。该过程涉及计算三角形的几个几何属性：边长、面积、内角、内切圆半径和外接圆半径。\n\n三角形的顶点给定为 $A = (0, 0)$、$B = (1.8, 0.6)$ 和 $C = (0.2, 2.0)$。\n\n首先，我们定义与三角形各边对应的向量。\n从 $A$ 到 $B$ 的向量是 $\\vec{AB} = B - A = (1.8 - 0, 0.6 - 0) = (1.8, 0.6)$。\n从 $A$ 到 $C$ 的向量是 $\\vec{AC} = C - A = (0.2 - 0, 2.0 - 0) = (0.2, 2.0)$。\n从 $B$ 到 $C$ 的向量是 $\\vec{BC} = C - B = (0.2 - 1.8, 2.0 - 0.6) = (-1.6, 1.4)$。\n\n接下来，我们计算边的长度，即这些向量的欧几里得范数。设 $a$、$b$ 和 $c$ 分别是顶点 $A$、$B$ 和 $C$ 对边的长度。\n$c = |\\vec{AB}| = \\sqrt{(1.8)^{2} + (0.6)^{2}} = \\sqrt{3.24 + 0.36} = \\sqrt{3.6} \\approx 1.897367$。\n$b = |\\vec{AC}| = \\sqrt{(0.2)^{2} + (2.0)^{2}} = \\sqrt{0.04 + 4.0} = \\sqrt{4.04} \\approx 2.009975$。\n$a = |\\vec{BC}| = \\sqrt{(-1.6)^{2} + (1.4)^{2}} = \\sqrt{2.56 + 1.96} = \\sqrt{4.52} \\approx 2.126029$。\n\n三角形的面积 $\\mathcal{A}$ 可以通过构成其两条边的向量（例如 $\\vec{AB}$ 和 $\\vec{AC}$）的二维叉积的模的一半来计算。\n$$ \\mathcal{A} = \\frac{1}{2} |\\det(\\vec{AB}, \\vec{AC})| = \\frac{1}{2} |(1.8)(2.0) - (0.6)(0.2)| $$\n$$ \\mathcal{A} = \\frac{1}{2} |3.6 - 0.12| = \\frac{1}{2} (3.48) = 1.74 $$\n面积恰好是 $1.74$。\n\n内角使用点积公式计算：$\\vec{u} \\cdot \\vec{v} = |\\vec{u}| |\\vec{v}| \\cos(\\theta)$，由此得出 $\\theta = \\arccos\\left(\\frac{\\vec{u} \\cdot \\vec{v}}{|\\vec{u}| |\\vec{v}|}\\right)$。所有角度都以弧度表示。\n\n顶点 $A$ 处的角 $\\theta_A$ 是 $\\vec{AB}$ 和 $\\vec{AC}$ 之间的夹角：\n$$ \\vec{AB} \\cdot \\vec{AC} = (1.8)(0.2) + (0.6)(2.0) = 0.36 + 1.2 = 1.56 $$\n$$ \\cos(\\theta_A) = \\frac{1.56}{c \\cdot b} = \\frac{1.56}{\\sqrt{3.6} \\sqrt{4.04}} = \\frac{1.56}{\\sqrt{14.544}} \\approx 0.409048 $$\n$$ \\theta_A = \\arccos(0.409048) \\approx 1.14918 \\text{ rad} $$\n\n顶点 $B$ 处的角 $\\theta_B$ 是 $\\vec{BA} = -\\vec{AB}$ 和 $\\vec{BC}$ 之间的夹角：\n$$ \\vec{BA} \\cdot \\vec{BC} = (-1.8)(-1.6) + (-0.6)(1.4) = 2.88 - 0.84 = 2.04 $$\n$$ \\cos(\\theta_B) = \\frac{2.04}{c \\cdot a} = \\frac{2.04}{\\sqrt{3.6} \\sqrt{4.52}} = \\frac{2.04}{\\sqrt{16.272}} \\approx 0.505716 $$\n$$ \\theta_B = \\arccos(0.505716) \\approx 1.04073 \\text{ rad} $$\n\n顶点 $C$ 处的角 $\\theta_C$ 是 $\\vec{CA} = -\\vec{AC}$ 和 $\\vec{CB} = -\\vec{BC}$ 之间的夹角：\n$$ \\vec{CA} \\cdot \\vec{CB} = (-0.2)(1.6) + (-2.0)(-1.4) = -0.32 + 2.8 = 2.48 $$\n$$ \\cos(\\theta_C) = \\frac{2.48}{b \\cdot a} = \\frac{2.48}{\\sqrt{4.04} \\sqrt{4.52}} = \\frac{2.48}{\\sqrt{18.2608}} \\approx 0.580350 $$\n$$ \\theta_C = \\arccos(0.580350) \\approx 0.95168 \\text{ rad} $$\n\n最小内角是 $\\theta_{\\min} = \\theta_C \\approx 0.95168$ 弧度。问题要求对照阈值 $\\theta_0 = 0.6$ 进行评估，由于 $0.95168 \\ge 0.6$，此条件得到满足。\n\n接下来，我们计算内切圆半径 $r$ 和外接圆半径 $R$。半周长 $s$ 为：\n$s = \\frac{a+b+c}{2} = \\frac{\\sqrt{4.52} + \\sqrt{4.04} + \\sqrt{3.6}}{2} \\approx \\frac{2.126029 + 2.009975 + 1.897367}{2} \\approx 3.016686$。\n\n内切圆半径 $r$ 由 $r = \\frac{\\mathcal{A}}{s}$ 给出：\n$$ r \\approx \\frac{1.74}{3.016686} \\approx 0.576850 $$\n\n外接圆半径 $R$ 由 $R = \\frac{abc}{4\\mathcal{A}}$ 给出：\n$$ R = \\frac{\\sqrt{4.52} \\sqrt{4.04} \\sqrt{3.6}}{4(1.74)} = \\frac{\\sqrt{65.73888}}{6.96} \\approx \\frac{8.107952}{6.96} \\approx 1.164936 $$\n\n纵横比定义为 $\\rho = \\frac{R}{r}$：\n$$ \\rho \\approx \\frac{1.164936}{0.576850} \\approx 2.019528 $$\n问题要求对照阈值 $\\rho_0 = 3.0$ 进行评估，由于 $2.019528 \\le 3.0$，此条件也得到满足。\n\n最后，稳定性度量 $q$ 定义为 $q = \\frac{\\theta_{\\min}}{\\rho}$：\n$$ q \\approx \\frac{0.95168}{2.019528} \\approx 0.471241 $$\n将结果四舍五入到 $4$ 位有效数字，得到 $q = 0.4712$。", "answer": "$$\\boxed{0.4712}$$", "id": "3526260"}, {"introduction": "虽然非退化的三角形单元总是有效的，但四边形单元的引入带来了新的挑战，即需要确保从参考单元到物理单元的映射是有效的。等参映射必须是可逆且保持方向的，这一条件由雅可比行列式在整个单元内为正来保证。当雅可比行列式变为非正时，单元可能会发生“扭曲”或“翻转”，导致数值积分失败。这项编码练习 [@problem_id:3561775] 将挑战您诊断并纠正无效的单元，例如自相交的“领结”形单元，这是开发稳健的网格生成和预处理工具所需的一项关键技能。", "problem": "您的任务是形式化、分析并稳健地修正计算岩土力学中使用的二维双线性四边形有限元中等参映射的失效问题。该问题聚焦于空间离散化、网格划分和形函数，从等参映射的基本定义入手，最终探讨当雅可比行列式失去正性时的算法补救措施。您的程序必须为一小组网格实现并测试这些概念。\n\n起点是双线性四边形单元的等参映射。从参数坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 中的参考正方形到物理坐标 $(x,y)$ 的映射定义如下\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i,\\quad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中 $(x_i,y_i)$ 是物理节点的坐标，$N_i(\\xi,\\eta)$ 是与参考正方形角点相关的双线性形函数。对于参考节点顺序为 $i=1,2,3,4$ 且角点位于 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$ 的四边形，其双线性形函数为\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n该映射的雅可比矩阵为\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\[6pt]\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial \\xi}\\,x_i  \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial \\eta}\\,x_i \\\\[6pt]\n\\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial \\xi}\\,y_i  \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial \\eta}\\,y_i\n\\end{bmatrix},\n$$\n雅可比行列式，记为 $J(\\xi,\\eta)=\\det\\mathbf{J}(\\xi,\\eta)$，表示映射的局部可逆性和方向。一个有效的保持方向的等参映射的必要条件是在单元内部处处有 $J(\\xi,\\eta)0$。失去正性会导致单元翻转或折叠等失效模式，这可能引起数值积分崩溃和非物理的解。\n\n您的任务是：\n- 实现双线性形函数 $N_i(\\xi,\\eta)$ 及其参数导数 $\\partial N_i/\\partial \\xi$ 和 $\\partial N_i/\\partial \\eta$。\n- 对于由其物理节点坐标 $(x_i,y_i)$ 定义的任意给定四边形单元，其隐含的参考节点顺序 $i=1,2,3,4$ 对应于 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$，请在一系列内部参数采样点网格上计算雅可比行列式 $J(\\xi,\\eta)$\n$$\n\\Xi=\\{-0.75,\\,-0.25,\\,0,\\,0.25,\\,0.75\\},\\quad \\text{在所有 $25$ 个点对 $(\\xi,\\eta)\\in\\Xi\\times\\Xi$ 上求值}。\n$$\n使用数值容差 $10^{-9}$ 来判断严格正性。\n- 有意地构造在某些区域违反 $J(\\xi,\\eta)0$ 的单元，分析其失效模式，并提出两种稳健的补救措施：\n  1. 局部重参数化：将物理节点列表 $(x_i,y_i)$ 视为一个可根据正方形的八个对称性（八阶二面体群）进行排列的标签。在这些排列中，找出使最小采样 $J(\\xi,\\eta)$ 值最大的排列，如果该排列能获得大于容差的严格正的最小值，则应用它。\n  2. 剖分为线性三角形：如果在采样网格上没有任何重参数化能产生严格正的最小 $J(\\xi,\\eta)$ 值，则沿其中一条对角线将四边形剖分为两个三角形，选择能使两个三角形的最小正有向面积最大化的对角线（如有必要，通过节点重排序确保逆时针方向），并报告此最小面积作为修复后度量。\n\n每个测试用例的输出规格：\n- 计算任何修复前的最小采样雅可比行列式，记为 $J_{\\min}^{\\text{before}}$。\n- 确定修复策略代码 $c$（整数）：如果无需修复（已为严格正），则 $c=0$；如果使用局部重参数化，则 $c=1$；如果使用剖分为三角形，则 $c=2$。\n- 计算修复后度量 $m$：如果 $c=0$ 或 $c=1$，将 $m$ 设置为所选重参数化后的最小采样雅可比行列式（如果无需修复，则为原始值）；如果 $c=2$，将 $m$ 设置为剖分并进行适当定向后的最小正三角形面积。\n- 对于数值输出，必须使用浮点数；不涉及物理单位。\n\n您的程序必须实现上述功能，并在以下包含三个四边形单元的测试套件上运行，每个单元由隐含参考顺序 $i=1,2,3,4$ 的四个物理节点坐标 $(x_i,y_i)$ 列表指定：\n- 测试用例 A（凸单元，预期有效）：$[(0,0),(2,0),(2,1),(0,1)]$。\n- 测试用例 B（因节点顺序导致方向反转，预期可通过重参数化修复）：$[(0,0),(0,1),(2,1),(2,0)]$。\n- 测试用例 C（自相交的蝶形单元，预期无法通过重参数化修复，需要剖分）：$[(0,0),(2,0),(0,1),(2,1)]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的三元组列表，每个测试用例对应一个三元组。每个三元组的形式必须为 $[J_{\\min}^{\\text{before}},c,m]$，其中数字以浮点数形式打印，整数代码 $c$ 以整数形式打印。例如：$[[0.5,0,0.5],[-0.5,1,0.5],[\\ldots,2,\\ldots]]$。", "solution": "该解决方案解决了二维双线性四边形单元等参映射的验证和校正问题，这是计算岩土力学和有限元分析中的一项基本任务。该过程首先分析所提供的单元几何形状，如果几何形状无效，则执行校正程序。\n\n### 1. 等参映射与雅可比行列式\n\n问题的核心在于等参映射，它将一个简单的参考单元（参数坐标 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$ 中的一个正方形）与物理空间中坐标为 $(x,y)$ 的一般四边形单元关联起来。该映射使用形函数 $N_i(\\xi, \\eta)$ 定义：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i \\quad \\text{和} \\quad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i\n$$\n其中 $(x_i, y_i)$ 是第 $i$ 个物理节点的坐标，对应于参考正方形的第 $i$ 个节点。对于节点 $1, 2, 3, 4$ 分别位于 $(-1,-1), (1,-1), (1,1), (-1,1)$ 的参考正方形，其双线性形函数为：\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta)\n$$\n为了使映射在物理和数学上有效，它必须是可逆且保持方向的。此属性由雅可比矩阵的行列式 $J(\\xi,\\eta) = \\det(\\mathbf{J})$ 来表征。雅可比矩阵包含物理坐标相对于参数坐标的偏导数：\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\[6pt]\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n$$\n$\\mathbf{J}$ 的分量是节点坐标的线性组合，其系数是形函数的导数。例如，$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_i}{\\partial \\xi}\\,x_i$。有效映射的条件是雅可比行列式必须在整个单元域内严格为正，即 $J(\\xi,\\eta)  0$。正的行列式确保了从 $(\\xi, \\eta)$ 空间到 $(x, y)$ 空间存在一个唯一的、一对一的映射，该映射保持局部方向（即，它将逆时针路径映射为逆时针路径）。如果在任何点 $J(\\xi,\\eta) \\le 0$，单元可能会发生折叠、翻转或退化，导致高斯求积等数值程序出现灾难性故障。\n\n为评估给定单元的有效性，我们在参考域内的一个离散采样点网格上计算 $J(\\xi, \\eta)$。问题指定了一个 $5 \\times 5$ 的网格，其中 $\\xi$ 和 $\\eta$ 的值均取自 $\\Xi=\\{-0.75,\\,-0.25,\\,0,\\,0.25,\\,0.75\\}$。在此网格上找到的行列式最小值 $J_{\\min}$ 与 $10^{-9}$ 的严格正性容差进行比较。如果 $J_{\\min}  10^{-9}$，则无需校正，修复代码为 $c=0$。否则，需要采取校正措施。\n\n### 2. 校正策略1：局部重参数化\n\n如果初始配置无效（$J_{\\min} \\le 10^{-9}$），首选的补救方法是尝试重新排序物理节点。雅可比行列式为负的一个常见原因是，对于一个假定为逆时针（CCW）约定的参考单元，其节点采用了顺时针（CW）排序。更复杂的无效几何形状有时可以通过找到同一组物理顶点的不同遍历方式来纠正。问题指定测试与参考正方形对称性（二面体群 $D_4$）相对应的所有8种节点列表排列。这些排列代表了参考单元节点标签所有可能的旋转和反射。\n\n对于初始节点列表 $[p_1, p_2, p_3, p_4]$，这8种排列是：\n1. 恒等变换: $[p_1, p_2, p_3, p_4]$\n2. 逆时针旋转 $90^\\circ$: $[p_4, p_1, p_2, p_3]$\n3. 旋转 $180^\\circ$: $[p_3, p_4, p_1, p_2]$\n4. 逆时针旋转 $270^\\circ$: $[p_2, p_3, p_4, p_1]$\n5. 沿垂直轴翻转: $[p_2, p_1, p_4, p_3]$\n6. 沿水平轴翻转: $[p_4, p_3, p_2, p_1]$\n7. 沿反对角线翻转: $[p_1, p_4, p_3, p_2]$\n8. 沿主对角线翻转: $[p_3, p_2, p_1, p_4]$\n\n对于这8种节点配置中的每一种，我们在采样网格上计算最小雅可比行列式 $J_{\\min}^{\\text{perm}}$。然后我们找出这些值的最大值，$J_{\\min}^{\\text{best}} = \\max(\\{J_{\\min}^{\\text{perm}}\\})$。如果 $J_{\\min}^{\\text{best}}  10^{-9}$，则重参数化成功。修复代码设置为 $c=1$，修复后度量 $m$ 设置为 $J_{\\min}^{\\text{best}}$。\n\n### 3. 校正策略2：剖分为三角形\n\n如果没有一种重参数化能产生严格为正的最小雅可比行列式，那么该单元的几何形状可能过于扭曲（例如，在所有有效排序中都是非凸或自相交的），无法通过双线性映射从一个凸正方形映射得到。在这种情况下，备用策略是将四边形剖分为两个线性三角形。线性三角形具有恒定的雅可比行列式，一个有效的三角形（具有不共线的顶点）将总有一个非零面积，通过确保逆时针的顶点排序可以使其面积为正。\n\n一个四边形可以沿其两条对角线中的任意一条进行剖分：\n1. 连接节点1和3的对角线：这会产生三角形 $(p_1, p_2, p_3)$ 和 $(p_1, p_3, p_4)$。\n2. 连接节点2和4的对角线：这会产生三角形 $(p_2, p_3, p_4)$ 和 $(p_2, p_4, p_1)$。\n\n剖分的质量通过生成的三角形的面积来评判。具有顶点 $(x_a,y_a), (x_b,y_b), (x_c,y_c)$ 的三角形的面积由 $A = \\frac{1}{2} [x_a(y_b - y_c) + x_b(y_c - y_a) + x_c(y_a - y_b)]$ 给出。正面积对应于逆时针排序。我们为每条可能的对角线计算两个三角形的绝对面积。对于每条对角线，我们找出两个三角形面积中的较小者。选择的对角线是能使这个最小面积最大化的那一条。该策略旨在避免产生非常细长或面积过小的三角形。\n\n设 $m_1$ 为第一条对角线的最小面积，$m_2$ 为第二条的最小面积。修复后度量为 $m = \\max(m_1, m_2)$。修复代码设置为 $c=2$。\n\n### 算法实现\n\n该实现封装了这些步骤。对于每个由四个节点坐标列表定义的测试用例：\n1.  计算初始节点排序的 $J_{\\min}^{\\text{before}}$。\n2.  如果 $J_{\\min}^{\\text{before}}  10^{-9}$，则结果为 $[J_{\\min}^{\\text{before}}, 0, J_{\\min}^{\\text{before}}]$。\n3.  否则，尝试重参数化。计算8个对称排列下最小雅可比行列式的最大值。如果此最大值为正，则结果为 $[J_{\\min}^{\\text{before}}, 1, J_{\\min}^{\\text{best}}]$。\n4.  如果重参数化失败，则执行剖分。通过比较两种对角线选择来计算剖分度量 $m$。结果为 $[J_{\\min}^{\\text{before}}, 2, m]$。\n\n这种结构化的方法确保能找到一个有效的单元表示，无论是通过对轻度扭曲单元重新标记，还是通过对严重扭曲单元进行网格细化，从而为计算模拟中的单元处理提供了一个稳健的解决方案。", "answer": "[[0.5,0,0.5],[-0.5,1,0.5],[-0.375,2,1.0]]", "id": "3561775"}, {"introduction": "在构建了一个有效的网格之后，我们如何确定模拟结果在多大程度上摆脱了离散化误差的影响？网格收敛性研究，特别是使用理查森外推法 (Richardson extrapolation) 和网格收敛指数 (Grid Convergence Index, GCI) 等方法，为我们提供了一种系统性的途径来估计这种误差，并验证代码是否以理论预期的速率收敛。通过分析在一系列加密网格上得到的解 [@problem_id:3526279]，您将学习到一套标准化的验证与确认 (Verification and Validation, VV) 流程，这是计算科学严谨性的基石。", "problem": "使用有限元法 (FEM) 对锂离子软包电池中由电化学驱动的传热过程进行多物理场耦合仿真。该电池被建模为一个层状固体，具有各向异性热导率，其体积焦耳热由一个电化学子模型提供。空间离散化使用了三个系统性加密的非结构化四面体网格，其特征单元尺寸 $h_1$、$h_2$ 和 $h_3$ 满足 $h_1/h_2 = h_2/h_3 = r$ 且 $r$ 为常数。目标量是在每个网格层级上从稳态耦合解中获得的区域积分焦耳热 $Q(h)$。记录了以下数据：\n- $h_1 = 0.008\\,\\text{m}$，$Q_1 = 5.432\\,\\text{W}$；\n- $h_2 = 0.004\\,\\text{m}$，$Q_2 = 5.308\\,\\text{W}$；\n- $h_3 = 0.002\\,\\text{m}$，$Q_3 = 5.276\\,\\text{W}$。\n\n假设解的误差是渐近的，并且可以用主阶理查森展开式 $Q(h) = Q^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$ 来表示，其中 $Q^{\\ast}$ 是网格无关值，$C$ 是一个常数，$p$ 是观测到的精度阶。仅使用此基本表示和给定数据：\n1. 根据三个解和加密比 $r$ 确定观测到的阶数 $p$。\n2. 基于观测到的阶数，计算最细网格解的网格收敛指数 (GCI)，该指数定义在网格对 $(h_2,h_3)$ 上，安全因子 $F_s = 1.25$，用以估计由空间离散化引起的 $Q_3$ 的分数不确定度。\n\n以无量纲分数形式提供 GCI (无百分号)。如果您选择以小数形式表示最终数字，请将答案四舍五入到四位有效数字。此外，简要解释这三组解是否与单调渐近收敛一致，以及计算出的 GCI 对由于离散化引起的 $Q_3$ 的不确定性意味着什么。", "solution": "该问题是有效的，因为它为使用理查森外推法进行标准的网格收敛性研究提供了一套适定的条件和数据，这是计算科学与工程领域中验证与确认的基石。其物理背景具有科学依据，并且所有必要的参数都已提供且没有矛盾。\n\n分析分三部分进行：首先，简要检查单调收敛性；其次，确定观测到的精度阶 $p$；最后，计算网格收敛指数 (GCI)。\n\n给定的三个网格加密层级上的区域积分焦耳热 $Q$ 的数据如下：\n- 网格1 (粗): $h_1 = 0.008$, $Q_1 = 5.432$\n- 网格2 (中): $h_2 = 0.004$, $Q_2 = 5.308$\n- 网格3 (细): $h_3 = 0.002$, $Q_3 = 5.276$\n\n首先，我们评估收敛行为。网格加密是系统性的，具有恒定的加密比 $r = h_1/h_2 = 0.008/0.004 = 2$ 和 $h_2/h_3 = 0.004/0.002 = 2$。解为 $Q_1  Q_2  Q_3$。由于解的值随着特征单元尺寸 $h$ 的减小而单调递减，因此该解表现出单调收敛。这是一个理想的特性，表明数值格式是稳定的，没有表现出振荡性误差行为。\n\n分析的核心依赖于对目标量 $Q(h)$ 假设的理查森误差展开式，该展开式表明，在特征尺寸为 $h$ 的网格上的解与精确解或网格无关解 $Q^{\\ast}$ 之间的关系为：\n$$Q(h) = Q^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$$\n其中 $p$ 是精度阶，$C$ 是一个常数。忽略三个网格层级的高阶项，我们有：\n$$Q_1 \\approx Q^{\\ast} + C h_1^{p}$$\n$$Q_2 \\approx Q^{\\ast} + C h_2^{p}$$\n$$Q_3 \\approx Q^{\\ast} + C h_3^{p}$$\n为了求出观测到的精度阶 $p$，我们对连续的解求差以消去未知数 $Q^{\\ast}$：\n$$Q_1 - Q_2 \\approx C(h_1^{p} - h_2^{p})$$\n$$Q_2 - Q_3 \\approx C(h_2^{p} - h_3^{p})$$\n将这两个差值相除可以消去常数 $C$：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{h_1^{p} - h_2^{p}}{h_2^{p} - h_3^{p}}$$\n使用恒定的加密比 $r = h_1/h_2 = h_2/h_3$，我们可以用更粗的网格尺寸来表示 $h_1$ 和 $h_2$：$h_1 = r h_2$ 和 $h_2 = r h_3$。将这些代入比值中得到：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{(r h_2)^{p} - h_2^{p}}{(r h_3)^{p} - h_3^{p}} = \\frac{h_2^{p}(r^p - 1)}{h_3^{p}(r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\n现在我们可以求解 $p$：\n$$p = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}$$\n代入给定的数值：\n$$Q_1 - Q_2 = 5.432 - 5.308 = 0.124$$\n$$Q_2 - Q_3 = 5.308 - 5.276 = 0.032$$\n并且加密比为 $r=2$。因此，\n$$p = \\frac{\\ln\\left(\\frac{0.124}{0.032}\\right)}{\\ln(2)} = \\frac{\\ln(3.875)}{\\ln(2)} \\approx \\frac{1.35455}{0.69315} \\approx 1.95418$$\n观测到的精度阶为 $p \\approx 1.954$。这个值接近于 $2$，这是许多常用有限元格式的理论阶，表明解处于渐近收敛范围内。\n\n接下来，我们基于解对 $(Q_2, Q_3)$ 计算最细网格解的网格收敛指数 (GCI)。GCI 提供了细网格解中分数误差的估计。公式为：\n$$\\text{GCI}_{\\text{fine}} = \\text{GCI}_{23} = \\frac{F_s}{|r^p - 1|} \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\n给定的安全因子为 $F_s = 1.25$。我们使用这对网格的加密比 $r = h_2/h_3 = 2$ 和我们刚刚计算出的 $p$ 值。\n$r^p$ 项就是我们之前求得的解的差值之比：\n$$r^p = 2^{p} = \\frac{Q_1 - Q_2}{Q_2 - Q_3} = 3.875$$\n相对差值项为：\n$$\\left| \\frac{Q_3 - Q_2}{Q_3} \\right| = \\left| \\frac{5.276 - 5.308}{5.276} \\right| = \\left| \\frac{-0.032}{5.276} \\right| \\approx 0.006065201$$\n现在，我们可以将所有值代入 GCI 公式中：\n$$\\text{GCI}_{23} = \\frac{1.25}{|3.875 - 1|} \\times 0.006065201 = \\frac{1.25}{2.875} \\times 0.006065201 \\approx 0.00263695$$\n按要求将结果四舍五入到四位有效数字：\n$$\\text{GCI}_{23} \\approx 0.002637$$\n\n这三组解与单调渐近收敛是一致的，这可以从有序的解值 ($Q_1  Q_2  Q_3$) 以及观测到的精度阶 $p \\approx 1.954$ (该值是稳定的且接近理论整数值 $2$) 中得到证明。计算出的值 $\\text{GCI}_{23} \\approx 0.002637$ (或 $0.2637\\%$) 意味着细网格解 $Q_3$ 中的离散化不确定度估计约为 $0.26\\%$。这个低值表明，最细网格上的解是相当准确的，并且进一步的网格加密只会对区域积分焦耳热产生微小的变化。该数值结果是稳健的。", "answer": "$$\\boxed{0.002637}$$", "id": "3526279"}]}