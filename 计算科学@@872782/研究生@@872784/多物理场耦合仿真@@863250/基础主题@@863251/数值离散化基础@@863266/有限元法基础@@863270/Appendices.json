{"hands_on_practices": [{"introduction": "有限元方法的核心在于将控制方程的弱形式离散化，这通常涉及到在单元上计算积分。对于高阶单元或几何扭曲的单元，精确计算刚度矩阵等项的积分往往非常困难甚至不可能。本练习将引导您确定精确积分一个二次（$Q_2$）单元刚度矩阵所需的最小高斯求积阶数，这对于确保数值解的准确性至关重要 [@problem_id:3507547]。", "problem": "考虑在单个四边形单元 $\\Omega_e$ 上的标量泊松方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，其中 $\\Omega_e$ 上的扩散系数 $\\kappa$ 为常数。设该单元是通过一个仿射映射 $\\mathbf{x}(\\xi,\\eta)$ 从参考方域 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 获得的，该映射具有常数雅可比矩阵 $\\mathbf{J}$ 和非零行列式 $\\det(\\mathbf{J}) \\neq 0$。该单元使用等参双二次拉格朗日形函数，即在 $\\hat{\\Omega}$ 上的 $Q_2$ 形函数，其中 $Q_2$ 表示在每个变量上阶数最高为 $2$ 的多项式空间。\n\n单元刚度矩阵的各项为\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega \\,,\n$$\n其中 $N_i$ 和 $N_j$ 是通过仿射映射从 $\\hat{\\Omega}$ 拉回到 $\\Omega_e$ 的 $Q_2$ 形函数。您可以假设仿射映射的标准关系式：$\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$ 和 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$，其中 $\\hat{\\nabla}$ 表示关于 $(\\xi,\\eta)$ 的导数。\n\n确定最小整数 $n$，使得在 $\\hat{\\Omega}$ 上每个方向有 $n$ 个点的张量积高斯-勒让德求积法则能够精确积分每个刚度矩阵项 $K_{ij}$。您的论证必须仅基于识别 $\\hat{\\Omega}$ 上被积函数的二元多项式阶数，以及一维高斯-勒让德求积的精确性性质。您的最终答案应为整数 $n$ (无单位)。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **控制方程**：标量泊松方程为 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，作用于单个四边形单元 $\\Omega_e$。\n- **材料属性**：扩散系数 $\\kappa$ 在 $\\Omega_e$ 上为常数。\n- **单元映射**：单元 $\\Omega_e$ 通过仿射映射 $\\mathbf{x}(\\xi,\\eta)$ 与参考方域 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 相关联。\n- **雅可比矩阵属性**：映射的雅可比矩阵 $\\mathbf{J}$ 是常数，其行列式 $\\det(\\mathbf{J})$ 非零。\n- **有限元空间**：该单元使用等参双二次拉格朗日形函数，记为 $\\hat{\\Omega}$ 上的 $Q_2$ 形函数。空间 $Q_2$ 由二元多项式组成，这些多项式在每个变量 $\\xi$ 和 $\\eta$ 上的阶数分别最高为2。\n- **刚度矩阵定义**：单元刚度矩阵的各项由积分 $K_{ij} = \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega$ 给出。\n- **积分变换法则**：物理坐标和参考坐标中梯度之间的关系是 $\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$。面积微元变换为 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$。此处，$\\hat{\\nabla}$ 代表关于参考坐标 $(\\xi,\\eta)$ 的梯度算子。\n- **数值积分**：使用每个方向有 $n$ 个点的张量积高斯-勒让德求积法则来计算 $\\hat{\\Omega}$ 上的积分。\n- **目标**：确定保证精确积分每个刚度矩阵项 $K_{ij}$ 的最小整数 $n$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题定义明确且科学上合理。它代表了有限元方法 (FEM) 领域中的一个标准分析。所有概念，包括泊松方程、仿射映射、$Q_2$ 单元和高斯-勒让德求积，都是计算工程和应用数学的基础。该问题是自洽的，提供了推导出答案所需的所有必要信息。“仿射映射”和“常数雅可比矩阵”的说明是精确的，避免了更一般的等参映射中雅可比矩阵不为常数的复杂性。将“等参”与“仿射映射”并用所带来的轻微歧义，通过明确说明雅可比矩阵是常数而得以解决。因此，该问题是有效的。\n\n**第3步：结论与行动**\n该问题有效。将提供完整的解答。\n\n### 解答\n\n目标是找到在参考方域 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ 上，张量积高斯-勒让德求积法则所需的最小求积点数 $n$，以便精确积分刚度矩阵的各项 $K_{ij}$。\n\n刚度矩阵项的表达式为\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega\n$$\n为了计算该积分，我们使用给定的法则将其变换到参考单元 $\\hat{\\Omega}$ 上。令 $\\hat{N}_i(\\xi, \\eta)$ 表示参考单元上的形函数。物理单元上的形函数为 $N_i(\\mathbf{x}) = \\hat{N}_i(\\xi(\\mathbf{x}), \\eta(\\mathbf{x}))$。梯度变换为 $\\nabla N_i = \\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i$，面积微元变换为 $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$。\n\n将这些代入 $K_{ij}$ 的积分中：\n$$\nK_{ij} \\;=\\; \\int_{\\hat{\\Omega}} \\kappa \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) \\, |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}\n$$\n参考单元上的被积函数为 $I(\\xi, \\eta) = \\kappa |\\det(\\mathbf{J})| \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$。\n\n根据问题陈述，$\\kappa$ 是一个常数。映射是仿射的，这意味着雅可比矩阵 $\\mathbf{J}$ 是常数。因此，其逆转置矩阵 $\\mathbf{J}^{-T}$ 和其行列式 $\\det(\\mathbf{J})$ 也都是常数。因此，项 $\\kappa |\\det(\\mathbf{J})|$ 是一个常标量。\n\n因此，分析简化为确定点积项 $(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$ 的多项式阶数。这可以表示为一个二次型：\n$$\n(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) = (\\hat{\\nabla} \\hat{N}_i)^T (\\mathbf{J}^{-1} \\mathbf{J}^{-T}) (\\hat{\\nabla} \\hat{N}_j)\n$$\n令常数矩阵 $\\mathbf{C} = \\mathbf{J}^{-1} \\mathbf{J}^{-T}$ 由其分量 $\\begin{pmatrix} C_{11}  C_{12} \\\\ C_{21}  C_{22} \\end{pmatrix}$ 表示。该表达式变为：\n$$\nC_{11} \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} + C_{12} \\left( \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta} + \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} \\right) + C_{22} \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}\n$$\n$Q_2$ 单元的形函数 $\\hat{N}_k(\\xi, \\eta)$ 是在 $\\xi$ 上阶数最高为2、在 $\\eta$ 上阶数最高为2的多项式。令 $P_d(t)$ 表示变量 $t$ 中阶数最高为 $d$ 的多项式空间。则 $\\hat{N}_k \\in P_2(\\xi) \\otimes P_2(\\eta)$。\n\n形函数的导数为：\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\xi}$：在 $\\xi$ 上的阶数减少1，而在 $\\eta$ 上的阶数不变。因此，$\\frac{\\partial \\hat{N}_k}{\\partial \\xi} \\in P_1(\\xi) \\otimes P_2(\\eta)$。\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\eta}$：在 $\\eta$ 上的阶数减少1，而在 $\\xi$ 上的阶数不变。因此，$\\frac{\\partial \\hat{N}_k}{\\partial \\eta} \\in P_2(\\xi) \\otimes P_1(\\eta)$。\n\n现在，我们确定被积函数中每个乘积项的多项式阶数：\n1.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$：\n    在 $\\xi$ 上的最高阶数为 $1 + 1 = 2$。\n    在 $\\eta$ 上的最高阶数为 $2 + 2 = 4$。\n    此项属于空间 $P_2(\\xi) \\otimes P_4(\\eta)$。\n\n2.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$：\n    在 $\\xi$ 上的最高阶数为 $2 + 2 = 4$。\n    在 $\\eta$ 上的最高阶数为 $1 + 1 = 2$。\n    此项属于空间 $P_4(\\xi) \\otimes P_2(\\eta)$。\n\n3.  对于项 $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$ 和 $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$：\n    在 $\\xi$ 上的最高阶数为 $1 + 2 = 3$。\n    在 $\\eta$ 上的最高阶数为 $2 + 1 = 3$。\n    这些项属于空间 $P_3(\\xi) \\otimes P_3(\\eta)$。\n\n总被积函数 $I(\\xi, \\eta)$ 是这些多项式项的线性组合。$I(\\xi, \\eta)$ 在每个变量中的最高阶数是各单项阶数的最大值。\n- 在 $\\xi$ 上的最高阶数：$\\max(2, 4, 3) = 4$。\n- 在 $\\eta$ 上的最高阶数：$\\max(4, 2, 3) = 4$。\n\n因此，被积函数 $I(\\xi, \\eta)$ 是一个二元多项式，其在 $\\xi$上的最高阶数为4，在 $\\eta$ 上的最高阶数为4。\n\n为了使用张量积高斯-勒让德求积法则精确积分此多项式，我们考虑一维积分。一个 $n$ 点的一维高斯-勒让德求积法则可以精确积分最高阶为 $2n-1$ 的任何多项式。\n\n对于关于 $\\xi$ 的积分，我们必须能够精确积分最高阶为 $p=4$ 的多项式。这要求求积点数 $n$ 满足：\n$$\n2n - 1 \\ge 4\n$$\n$$\n2n \\ge 5\n$$\n$$\nn \\ge 2.5\n$$\n由于 $n$ 必须是整数，最小的可接受值为 $n=3$。\n\n同样地，对于关于 $\\eta$ 的积分，被积函数是最高阶为4的多项式。适用相同的条件：\n$$\n2n - 1 \\ge 4 \\implies n \\ge 2.5\n$$\n$n$ 的最小整数值同样是 $3$。\n\n由于问题描述的是一个每个方向有 $n$ 个点的张量积法则，因此相同的值 $n$ 适用于 $\\xi$ 和 $\\eta$ 两个方向。因此，保证精确积分所有刚度矩阵项的最小整数 $n$ 是 $3$。这对应于参考单元上的一个 $3 \\times 3$ 求积网格。", "answer": "$$\\boxed{3}$$", "id": "3507547"}, {"introduction": "在多物理场仿真中，边界条件是连接模型与外部环境的关键，例如模拟热对流或辐射边界。本练习将指导您从弱形式出发，推导如何将第三类边界条件（即 Robin 条件）整合到有限元框架中。您将亲手计算出 Robin 条件对单元刚度矩阵和载荷向量的具体贡献，从而深刻理解有限元法如何灵活处理各类物理边界现象 [@problem_id:3507555]。", "problem": "考虑一个标量场 $u$，它在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 中由二阶偏微分方程 (PDE) $-\\nabla \\cdot \\left(a \\nabla u\\right) = s$ 控制，其中 $a > 0$ 且 $s$ 足够光滑，$\\nabla$ 表示梯度，$\\nabla \\cdot$ 表示散度。边界 $\\partial \\Omega$ 被划分为一个 Dirichlet 部分 $\\Gamma_{D}$ 和一个 Robin 部分 $\\Gamma_{R}$。在 $\\Gamma_{R}$ 上，Robin 边界条件 $a \\, \\partial_{n} u + \\alpha \\, u = g$ 成立，其中 $\\partial_{n} u$ 是外法向导数，$\\alpha \\ge 0$ 和 $g$ 是给定值。使用有限元法 (FEM) 的 Galerkin 形式，从基本原理出发，将控制 PDE 乘以一个检验函数 $v$ 并在 $\\Omega$ 上积分，然后应用散度定理并在 $\\Gamma_{R}$ 上施加 Robin 边界条件，以获得包含 Robin 数据贡献的弱形式。\n\n现在，将注意力限制在属于 $\\Gamma_{R}$ 的单个边界边 $e$ 上，该边为一个边界三角形所共有，其边长为 $L_{e}$，并有两个端点，关联的 $C^{0}$ 线性形函数为 $N_{i}$ 和 $N_{j}$。假设 $a$、$\\alpha$ 和 $g$ 沿着边 $e$ 是常数。用弧长坐标 $s \\in [0, L_{e}]$ 对该边进行参数化，并使用线性形函数 $N_{i}(s) = 1 - s/L_{e}$ 和 $N_{j}(s) = s/L_{e}$。推导仅由边 $e$ 上的 Robin 边界条件产生的显式 $2 \\times 2$ 局部边界刚度矩阵贡献 $K_{e}^{(R)}$ 和显式 $2 \\times 1$ 局部边界载荷向量贡献 $f_{e}^{(R)}$，并用 $\\alpha$、$g$ 和 $L_{e}$ 表示你的最终结果。\n\n你的最终答案必须以闭式解析表达式给出。无需四舍五入。将刚度矩阵贡献和载荷向量贡献对以单个组合答案的形式表示。", "solution": "该问题是有效的，因为它具有科学依据、是适定的、客观的，并为有限元法中的标准推导提供了一个完整且一致的设置。\n\n我们从域 $\\Omega$ 中的控制二阶偏微分方程 (PDE) 开始：\n$$\n-\\nabla \\cdot \\left(a \\nabla u\\right) = s\n$$\nGalerkin 方法需要推导此方程的弱形式。我们将该 PDE 乘以一个合适的检验函数 $v$，并在域 $\\Omega$ 上积分：\n$$\n-\\int_{\\Omega} v \\left( \\nabla \\cdot (a \\nabla u) \\right) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\n为了降低未知场 $u$ 的导数阶数，我们应用散度定理（或 Green 第一恒等式）。一般的矢量恒等式为 $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$。令 $\\phi = v$ 且 $\\mathbf{F} = a \\nabla u$。则 $\\nabla \\cdot (v (a \\nabla u)) = (\\nabla v) \\cdot (a \\nabla u) + v (\\nabla \\cdot (a \\nabla u))$。整理可得 $v(\\nabla \\cdot(a \\nabla u)) = \\nabla \\cdot (v(a \\nabla u)) - (\\nabla v) \\cdot (a \\nabla u)$。将此式代入积分并应用散度定理 $\\int_{\\Omega} \\nabla \\cdot \\mathbf{G} \\, d\\Omega = \\int_{\\partial \\Omega} \\mathbf{G} \\cdot \\mathbf{n} \\, dS$，我们得到：\n$$\n-\\int_{\\partial\\Omega} v (a \\nabla u) \\cdot \\mathbf{n} \\, dS + \\int_{\\Omega} (\\nabla v) \\cdot (a \\nabla u) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\n注意到 $\\nabla u \\cdot \\mathbf{n}$ 是外法向导数 $\\partial_n u$，方程变为：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\partial\\Omega} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n边界 $\\partial\\Omega$ 被划分为一个 Dirichlet 部分 $\\Gamma_D$ 和一个 Robin 部分 $\\Gamma_R$。在 $\\Gamma_D$ 上，$u$ 的值是给定的，我们通常选择在 $\\Gamma_D$ 上为零的检验函数 $v$。因此，在 $\\Gamma_D$ 上的边界积分为零。边界积分简化为在 $\\Gamma_R$ 上的积分：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n现在，我们施加 Robin 边界条件 $a \\, \\partial_n u + \\alpha u = g$，它可以重写为 $a \\, \\partial_n u = g - \\alpha u$。将此式代入边界积分项，得到：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (g - \\alpha u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\n将各项重新排列，把包含未知数 $u$ 的项归到左侧，把已知的源项归到右侧，我们得到弱形式：\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega + \\int_{\\Gamma_R} \\alpha v u \\, dS = \\int_{\\Omega} v s \\, d\\Omega + \\int_{\\Gamma_R} v g \\, dS\n$$\n在有限元离散化中，场 $u$ 被近似为 $u_h = \\sum_{k} u_k N_k(x)$，其中 $u_k$ 是节点自由度，$N_k(x)$ 是基函数（形函数）。Galerkin 方法选择检验函数 $v$ 为基函数之一，即 $v = N_i$。对于具有节点 $i$ 和 $j$ 的单个边界边 $e \\subset \\Gamma_R$，近似的限制为 $u_h|_e = u_i N_i + u_j N_j$。问题要求的是*仅*由 Robin 边界条件产生的对单元刚度矩阵和载荷向量的贡献。这些是在 $\\Gamma_R$ 上积分的项。\n\n对刚度矩阵的贡献来自于项 $\\int_{\\Gamma_R} \\alpha v u \\, dS$。对于单个边 $e$，这变为：\n$$\nK_{e}^{(R)} = \\int_{e} \\alpha \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\begin{pmatrix} N_i  N_j \\end{pmatrix} \\, dS\n$$\n对载荷向量的贡献来自于项 $\\int_{\\Gamma_R} v g \\, dS$。对于单个边 $e$，这变为：\n$$\nf_{e}^{(R)} = \\int_{e} g \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\, dS\n$$\n我们已知 $\\alpha$ 和 $g$ 沿着长度为 $L_e$ 的边 $e$ 是常数。该边由弧长 $s \\in [0, L_e]$ 参数化，因此 $dS = ds$。线性形函数给定为 $N_i(s) = 1 - s/L_e$ 和 $N_j(s) = s/L_e$。\n\n我们现在计算 $2 \\times 2$ 局部边界刚度矩阵 $K_{e}^{(R)}$ 的分量：\n(1,1) 分量是：\n$$\n(K_{e}^{(R)})_{ii} = \\int_{0}^{L_e} \\alpha N_i(s) N_i(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ -L_e \\frac{(1 - s/L_e)^3}{3} \\right]_0^{L_e} = \\alpha \\left( 0 - \\left(-\\frac{L_e}{3}\\right) \\right) = \\frac{\\alpha L_e}{3}\n$$\n(2,2) 分量是：\n$$\n(K_{e}^{(R)})_{jj} = \\int_{0}^{L_e} \\alpha N_j(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(\\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ \\frac{s^3}{3L_e^2} \\right]_0^{L_e} = \\alpha \\left( \\frac{L_e^3}{3L_e^2} - 0 \\right) = \\frac{\\alpha L_e}{3}\n$$\n由于对称性，非对角分量 (1,2) 和 (2,1) 相等：\n$$\n(K_{e}^{(R)})_{ij} = (K_{e}^{(R)})_{ji} = \\int_{0}^{L_e} \\alpha N_i(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)\\left(\\frac{s}{L_e}\\right) \\, ds = \\frac{\\alpha}{L_e} \\int_{0}^{L_e} \\left(s - \\frac{s^2}{L_e}\\right) \\, ds\n$$\n$$\n= \\frac{\\alpha}{L_e} \\left[ \\frac{s^2}{2} - \\frac{s^3}{3L_e} \\right]_0^{L_e} = \\frac{\\alpha}{L_e} \\left( \\left(\\frac{L_e^2}{2} - \\frac{L_e^3}{3L_e}\\right) - 0 \\right) = \\frac{\\alpha}{L_e} \\left(\\frac{L_e^2}{2} - \\frac{L_e^2}{3}\\right) = \\frac{\\alpha L_e}{6}\n$$\n组合这些分量，局部边界刚度矩阵的贡献为：\n$$\nK_{e}^{(R)} = \\begin{pmatrix} \\frac{\\alpha L_e}{3}  \\frac{\\alpha L_e}{6} \\\\ \\frac{\\alpha L_e}{6}  \\frac{\\alpha L_e}{3} \\end{pmatrix} = \\frac{\\alpha L_e}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n接下来，我们计算 $2 \\times 1$ 局部边界载荷向量 $f_{e}^{(R)}$ 的分量：\n第一个分量是：\n$$\n(f_{e}^{(R)})_{i} = \\int_{0}^{L_e} g N_i(s) \\, ds = g \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right) \\, ds = g \\left[ s - \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( (L_e - \\frac{L_e^2}{2L_e}) - 0 \\right) = \\frac{g L_e}{2}\n$$\n第二个分量是：\n$$\n(f_{e}^{(R)})_{j} = \\int_{0}^{L_e} g N_j(s) \\, ds = g \\int_{0}^{L_e} \\frac{s}{L_e} \\, ds = g \\left[ \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( \\frac{L_e^2}{2L_e} - 0 \\right) = \\frac{g L_e}{2}\n$$\n组合这些分量，局部边界载荷向量的贡献为：\n$$\nf_{e}^{(R)} = \\begin{pmatrix} \\frac{g L_e}{2} \\\\ \\frac{g L_e}{2} \\end{pmatrix} = \\frac{g L_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n刚度矩阵贡献和载荷向量贡献对代表了 Robin 边界条件对边 $e$ 局部系统的完整影响。", "answer": "$$\n\\boxed{\nK_{e}^{(R)} = \\frac{\\alpha L_e}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}, \\quad f_{e}^{(R)} = \\frac{g L_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n}\n$$", "id": "3507555"}, {"introduction": "为了提高计算精度，我们常使用高阶单元，但这会引入额外的内部节点，增加系统的自由度。静态凝聚是一种在单元层面消除这些内部自由度的有效技术，能显著提高计算效率。本练习将带您实践静态凝聚的全过程：首先计算与内部节点相关的刚度矩阵项，然后通过代数方法将其消除，最终得到一个只包含边界节点的等效（凝聚）算子 [@problem_id:3507536]。", "problem": "考虑一个代表热弹性或电热多物理场耦合的二维稳态扩散子问题，该问题定义在一个参考域为方形 $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$ 的九节点双二次等参四边形单元 ($Q_2$) 上。控制偏微分方程 (PDE) 为 $-\\nabla\\cdot(k\\nabla u)=0$，其中 $k>0$ 为恒定的各向同性传导系数，且从参考单元到物理单元的映射为单位映射。使用标准的伽辽金有限元法 (FEM)，单元刚度矩阵项定义为\n$$\nK_{ab} \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta,\n$$\n其中 $N_a$ 和 $N_b$ 是九节点双二次拉格朗日形函数。将单元中心的唯一内部节点表示为 $i$，其形函数为 $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$，并将八个边界自由度（角节点和中边节点）归入一个块 $b$。单元系统可以分块为如下形式\n$$\n\\begin{pmatrix}\nK_{bb}  K_{bi} \\\\\nK_{ib}  K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\[4pt] u_i\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\nf_b \\\\[4pt] f_i\n\\end{pmatrix},\n$$\n其中 $K_{ii}\\in\\mathbb{R}$，$K_{bi}\\in\\mathbb{R}^{8\\times 1}$，$K_{ib}\\in\\mathbb{R}^{1\\times 8}$，$K_{bb}\\in\\mathbb{R}^{8\\times 8}$。从弱形式和双二次形函数的定义出发，在不引用任何关于静力凝聚的预先陈述结果的情况下，推导如何通过精确消去内部自由度 $u_i$ 得到作用于边界块 $u_b$ 的凝聚算子。具体而言：\n\n- 使用 $N_i(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$ 和单位映射，从第一性原理精确计算 $K_{ii}$。\n- 对 $u_i$ 进行代数消元，以获得仅用块 $K_{bb}$、$K_{bi}$、$K_{ib}$ 和传导系数 $k$ 表示的凝聚边界算子。\n\n将您的最终答案表示为凝聚边界算子的单个闭式解析表达式，不带单位，也无需四舍五入。", "solution": "该问题陈述是有效的。其科学基础是应用于标准稳态扩散问题的有限元法（FEM）原理；其表述是适定的，为进行唯一的推导提供了充分信息；其语言客观、无歧义。\n\n任务是通过消去内部自由度，为九节点双二次四边形单元推导凝聚边界算子。该过程包括两个主要步骤：首先，计算与内部节点对应的刚度矩阵项 $K_{ii}$；其次，进行代数消元。\n\n单元刚度矩阵项由以下公式给出：\n$$\nK_{ab} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n问题指定从参考域 $(\\xi, \\eta)$ 到物理域 $(x, y)$ 的映射是单位映射。这意味着变换的雅可比矩阵是单位矩阵，因此物理坐标系中的梯度算子与参考坐标系中的梯度算子相同，即 $\\nabla = \\left( \\frac{\\partial}{\\partial\\xi}, \\frac{\\partial}{\\partial\\eta} \\right)$。\n\n首先，我们计算与内部节点对应的对角项 $K_{ii}$，其形函数为 $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$。\n$K_{ii}$ 的公式为：\n$$\nK_{ii} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_i(\\xi,\\eta)\\cdot \\nabla N_i(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\n我们首先计算 $N_i$ 的梯度：\n$$\n\\nabla N_i(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial\\xi} \\\\ \\frac{\\partial N_i}{\\partial\\eta} \\end{pmatrix} = \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\n接下来，我们计算点积 $\\nabla N_i \\cdot \\nabla N_i$：\n$$\n\\nabla N_i \\cdot \\nabla N_i = (-2\\xi(1-\\eta^2))^2 + (-2\\eta(1-\\xi^2))^2 = 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2\n$$\n现在，我们将此表达式代入 $K_{ii}$ 的积分中：\n$$\nK_{ii} = k \\int_{-1}^{1}\\int_{-1}^{1} \\left( 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2 \\right) \\,d\\xi\\,d\\eta\n$$\n我们可以将积分分成两部分：\n$$\nK_{ii} = 4k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta + 4k \\int_{-1}^{1}\\int_{-1}^{1} \\eta^2(1-\\xi^2)^2 \\,d\\xi\\,d\\eta\n$$\n由于被积函数和积分域的对称性，这两个积分是相等的。我们可以写成：\n$$\nK_{ii} = 8k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta\n$$\n该积分对于 $\\xi$ 和 $\\eta$ 是可分离的：\n$$\nK_{ii} = 8k \\left( \\int_{-1}^{1} \\xi^2 \\,d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta \\right)\n$$\n我们分别计算每个一维积分：\n第一个积分是：\n$$\n\\int_{-1}^{1} \\xi^2 \\,d\\xi = \\left[ \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\frac{1^3}{3} - \\frac{(-1)^3}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\n第二个积分是：\n$$\n\\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta = \\int_{-1}^{1} (1 - 2\\eta^2 + \\eta^4) \\,d\\eta = \\left[ \\eta - \\frac{2\\eta^3}{3} + \\frac{\\eta^5}{5} \\right]_{-1}^{1}\n$$\n$$\n= \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 - \\frac{2(-1)^3}{3} + \\frac{(-1)^5}{5} \\right) = \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 + \\frac{2}{3} - \\frac{1}{5} \\right)\n$$\n$$\n= 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15 - 10 + 3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\n将这些结果代回 $K_{ii}$ 的表达式中：\n$$\nK_{ii} = 8k \\left( \\frac{2}{3} \\right) \\left( \\frac{16}{15} \\right) = \\frac{256k}{45}\n$$\n这就完成了任务的第一部分。\n\n其次，我们对内部自由度 $u_i$ 进行代数消元。分块的线性方程组如下所示：\n$$\n\\begin{pmatrix}\nK_{bb}  K_{bi} \\\\\nK_{ib}  K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\ u_i\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_b \\\\ f_i\n\\end{pmatrix}\n$$\n这个分块矩阵方程对应于两个方程：\n1. $K_{bb} u_b + K_{bi} u_i = f_b$\n2. $K_{ib} u_b + K_{ii} u_i = f_i$\n\n从第二个方程中，我们求解内部自由度 $u_i$：\n$$\nK_{ii} u_i = f_i - K_{ib} u_b\n$$\n由于 $K_{ii}$ 是一个非零标量（$K_{ii} = \\frac{256k}{45}$ 且 $k>0$），其逆 $K_{ii}^{-1} = \\frac{1}{K_{ii}}$ 存在。\n$$\nu_i = K_{ii}^{-1} (f_i - K_{ib} u_b)\n$$\n现在，我们将 $u_i$ 的这个表达式代入第一个方程：\n$$\nK_{bb} u_b + K_{bi} \\left( K_{ii}^{-1} (f_i - K_{ib} u_b) \\right) = f_b\n$$\n展开各项：\n$$\nK_{bb} u_b + K_{bi} K_{ii}^{-1} f_i - K_{bi} K_{ii}^{-1} K_{ib} u_b = f_b\n$$\n为了获得边界自由度 $u_b$ 的凝聚系统，我们将所有包含 $u_b$ 的项组合到左侧：\n$$\n(K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}) u_b = f_b - K_{bi} K_{ii}^{-1} f_i\n$$\n前乘边界自由度向量 $u_b$ 的矩阵是凝聚边界算子，通常表示为块 $K_{ii}$ 的舒尔补。该算子为：\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}\n$$\n最后，我们代入先前计算出的 $K_{ii}$ 的值：\n$$\nK_{ii}^{-1} = \\left(\\frac{256k}{45}\\right)^{-1} = \\frac{45}{256k}\n$$\n得到的凝聚边界算子是：\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} \\left( \\frac{45}{256k} \\right) K_{ib} = K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}\n$$\n这就是凝聚算子的最终表达式，用刚度矩阵块和传导系数 $k$ 表示。", "answer": "$$\n\\boxed{K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}}\n$$", "id": "3507536"}]}