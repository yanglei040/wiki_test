{"hands_on_practices": [{"introduction": "本练习旨在探讨增广拉格朗日方法 (augmented Lagrangian method) 的理论基础。通过将其与更直观的二次惩罚方法 (quadratic penalty method) 进行对比，你将从第一性原理出发，揭示为何增广拉格朗日方法能够在有限的惩罚参数下保证解的可行性——这是二次惩罚方法通常不具备的关键优势。这项分析将为你学习和应用这种更复杂的约束优化技术提供坚实的理论依据 [@problem_id:3432451]。", "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 且 $b \\in \\mathbb{R}^{m}$。考虑被称为基追踪的凸压缩感知模型，该模型旨在最小化 $f(x) = \\|x\\|_{1}$，同时满足等式约束 $A x = b$。处理该等式约束的两种标准无约束代理方法是：\n$$P_{\\rho}(x) = \\|x\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},$$\n以及增广拉格朗日函数\n$$L_{\\rho}(x,\\lambda) = \\|x\\|_{1} + \\lambda^{\\top}(A x - b) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},$$\n其中 $\\rho  0$ 和 $\\lambda \\in \\mathbb{R}^{m}$ 分别是惩罚参数和拉格朗日乘子。根据凸优化、拉格朗日对偶和增广拉格朗日方法的基本定义，分析对于函数 $f(x) = \\|x\\|_{1}$，$P_{\\rho}$ 和 $L_{\\rho}$ 的极小值点之间的关系。特别地，从基本原理出发，论证如何通过选择一个合适的 $\\lambda$ 和有界的 $\\rho$ 来获得可行性 $A x = b$。\n\n选择在上述凸设定中最准确且普遍有效的选项：\n\nA. 对于任意 $\\rho  0$，假设存在一个原始-对偶最优对且强对偶性成立（对于 $f(x) = \\|x\\|_{1}$、等式约束和可行的 $A x = b$ 这是成立的），则存在一个 $\\lambda^{\\star}$，使得 $L_{\\rho}(x,\\lambda^{\\star})$ 的每个极小值点都是原始可行的和原始最优的。相比之下，对于 $P_{\\rho}(x)$，其极小值点在有限 $\\rho$ 下的精确可行性通常无法保证，除非 $f$ 的一个无约束极小值点恰好满足 $A x = b$。\n\nB. 因为 $f(x) = \\|x\\|_{1}$ 是 $\\ell_{1}$ 范数，所以存在一个有限阈值 $\\bar{\\rho}$，使得对于所有 $\\rho \\ge \\bar{\\rho}$，$P_{\\rho}(x)$ 的每个极小值点都是精确可行和原始最优的，无论 $A$ 和 $b$ 如何。\n\nC. 即使选择了最优的 $\\lambda$，有界的 $\\rho$ 也无法使 $L_{\\rho}(x,\\lambda)$ 的极小值点满足可行性 $A x = b$；必须取 $\\rho \\to \\infty$ 来强制实现可行性。\n\nD. 对于有界的 $\\rho$，$L_{\\rho}(x,\\lambda)$ 的极小值点的可行性要求 $A$ 具有满列秩；否则极小值点必然保持不可行。\n\nE. 对于任意 $\\rho  0$ 和任意 $\\lambda \\in \\mathbb{R}^{m}$，$L_{\\rho}(x,\\lambda)$ 的极小值点总是可行的，因为线性项 $\\lambda^{\\top}(A x - b)$ 能精确地强制执行该约束。", "solution": "该问题要求分析用于解决基追踪问题（一个带约束的凸优化问题）的两种常见优化公式。核心任务是比较二次惩罚法和增广拉格朗日方法在强制执行原始可行性约束 $A x = b$ 方面的能力。\n\n设原始问题记为 $(P)$:\n$$ (P) \\quad \\min_{x \\in \\mathbb{R}^n} f(x) \\quad \\text{subject to} \\quad A x = b $$\n其中 $f(x) = \\|x\\|_{1}$，$A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$。这是一个凸优化问题。问题陈述假设存在一个原始-对偶最优对 $(x^{\\star}, \\lambda^{\\star})$ 并且强对偶性成立。这是一个合理的假设；例如，如果可行集 $\\{x \\in \\mathbb{R}^n \\mid A x = b\\}$ 非空，则 Slater 条件成立，这保证了强对偶性。\n\n一对 $(x^{\\star}, \\lambda^{\\star})$ 的最优性 Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **原始可行性：** $A x^{\\star} = b$。\n2.  **对偶可行性**（与对偶问题 $\\max_{\\lambda} \\inf_x (\\|x\\|_1 + \\lambda^\\top(Ax-b)) $ 相关，即 $\\max_{\\lambda} -b^\\top\\lambda$ s.t. $\\|A^\\top\\lambda\\|_\\infty \\le 1$）：$\\|A^\\top \\lambda^\\star\\|_\\infty \\le 1$。虽然此条件是完整 KKT 系统的一部分，但用于分析目标函数的关键部分是平稳性条件。\n3.  **平稳性条件：** $0 \\in \\partial_x L(x^{\\star}, \\lambda^{\\star})$，其中 $L(x,\\lambda) = \\|x\\|_1 + \\lambda^\\top(Ax-b)$ 是标准拉格朗日函数。该条件为 $0 \\in \\partial f(x^{\\star}) + A^{\\top}\\lambda^{\\star}$，或等价地，$-A^{\\top}\\lambda^{\\star} \\in \\partial \\|x^{\\star}\\|_{1}$。\n\n在建立了这些基本原理之后，我们分析给定的两个代理函数。\n\n**1. 二次惩罚法的分析**\n二次惩罚公式旨在最小化：\n$$ P_{\\rho}(x) = \\|x\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n设 $x_{\\rho}$ 是 $P_{\\rho}(x)$ 对于某个惩罚参数 $\\rho > 0$ 的极小值点。根据最优性的一阶必要条件（来自凸函数的费马法则），有 $0 \\in \\partial P_{\\rho}(x_{\\rho})$。这给出：\n$$ 0 \\in \\partial \\|x_{\\rho}\\|_{1} + \\rho A^{\\top}(A x_{\\rho} - b) $$\n这可以重写为 $- \\rho A^{\\top}(A x_{\\rho} - b) \\in \\partial \\|x_{\\rho}\\|_{1}$。\n\n现在，我们检验 $x_{\\rho}$ 对于有限的 $\\rho > 0$ 是否能是原始可行的，即 $A x_{\\rho} = b$。如果 $A x_{\\rho} = b$，则最优性条件简化为 $0 \\in \\partial \\|x_{\\rho}\\|_{1}$。$\\ell_1$ 范数的次微分是向量 $v$ 的集合，其中如果 $(x_{\\rho})_i \\neq 0$，则 $v_i = \\text{sgn}((x_{\\rho})_i)$；如果 $(x_{\\rho})_i=0$，则 $v_i \\in [-1, 1]$。条件 $0 \\in \\partial \\|x_{\\rho}\\|_{1}$ 仅在 $x_{\\rho} = 0$ 时满足。\n因此，如果一个极小值点 $x_{\\rho}$ 是可行的，它必须是 $x_{\\rho}=0$。这又要求 $A(0) = b$，即 $b=0$。在这种特殊情况下，$\\|x\\|_1$ 的无约束极小值点（即 $x=0$）是可行的，因此解决了原始问题。对于任何 $b \\neq 0$，对于有限的 $\\rho$，$P_\\rho(x)$ 的极小值点 $x_\\rho$ 将不满足 $Ax_\\rho=b$。极小值点 $x_{\\rho}$ 代表了在最小化 $\\|x\\|_{1}$ 和最小化可行性违反 $\\|A x - b\\|_{2}^{2}$ 之间的一种折衷。为了强制实现可行性，必须增加惩罚项的权重，即取极限 $\\rho \\to \\infty$。因此，二次惩罚法通常不是一个精确惩罚方法；它对于有限的惩罚参数无法实现精确可行性。\n\n**2. 增广拉格朗日方法的分析**\n增广拉格朗日函数是：\n$$ L_{\\rho}(x,\\lambda) = \\|x\\|_{1} + \\lambda^{\\top}(A x - b) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n乘子法的核心思想是，通过选择正确的拉格朗日乘子 $\\lambda = \\lambda^{\\star}$，我们即使对于有限且有界的 $\\rho$ 也可以强制实现可行性。让我们来证明这一点。\n\n设 $(x^{\\star}, \\lambda^{\\star})$ 是一个原始-对偶最优对。根据强对偶性，原始最优值 $p^{\\star} = \\|x^{\\star}\\|_{1}$ 等于对偶最优值 $d^{\\star} = \\inf_{x} L(x, \\lambda^{\\star})$。这意味着对于所有 $x \\in \\mathbb{R}^n$，有 $\\|x\\|_{1} + (\\lambda^{\\star})^{\\top}(A x - b) \\ge \\|x^{\\star}\\|_{1}$。\n\n现在，考虑对于任何 $\\rho0$ 的增广拉格朗日函数 $L_{\\rho}(x, \\lambda^{\\star})$：\n$$ L_{\\rho}(x, \\lambda^{\\star}) = \\left( \\|x\\|_{1} + (\\lambda^{\\star})^{\\top}(A x - b) \\right) + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n利用对偶不等式，我们有：\n$$ L_{\\rho}(x, \\lambda^{\\star}) \\ge \\|x^{\\star}\\|_{1} + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2} $$\n设 $\\tilde{x}$ 是 $L_{\\rho}(x, \\lambda^{\\star})$ 的任意一个极小值点。根据极小值点的定义，对于所有 $x$，$L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le L_{\\rho}(x, \\lambda^{\\star})$。让我们在原始解 $x^{\\star}$ 处计算 $L_{\\rho}$：\n$$ L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = \\|x^{\\star}\\|_{1} + (\\lambda^{\\star})^{\\top}(A x^{\\star} - b) + \\frac{\\rho}{2}\\|A x^{\\star} - b\\|_{2}^{2} $$\n由于 $x^{\\star}$ 是可行的，因此 $A x^{\\star} - b = 0$。于是，\n$$ L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = \\|x^{\\star}\\|_{1} = p^{\\star} $$\n因为 $\\tilde{x}$ 是一个极小值点，必然有 $L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le L_{\\rho}(x^{\\star}, \\lambda^{\\star}) = p^{\\star}$。\n将此与我们之前的不等式结合：\n$$ p^{\\star} + \\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} \\le L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) \\le p^{\\star} $$\n这个不等式链只有在 $\\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} \\le 0$ 时才能成立。由于 $\\rho > 0$ 且平方范数是非负的，我们必须有 $\\|A \\tilde{x} - b\\|_{2}^{2} = 0$，这意味着 $A \\tilde{x} = b$。这证明了 $L_{\\rho}(x, \\lambda^{\\star})$ 的任何极小值点 $\\tilde{x}$ 都是原始可行的。\n\n此外，这些不等式必须作为等式成立，所以 $L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) = p^{\\star}$。由于 $\\tilde{x}$ 是可行的，\n$$ L_{\\rho}(\\tilde{x}, \\lambda^{\\star}) = \\|\\tilde{x}\\|_{1} + (\\lambda^{\\star})^{\\top}(A \\tilde{x} - b) + \\frac{\\rho}{2}\\|A \\tilde{x} - b\\|_{2}^{2} = \\|\\tilde{x}\\|_{1} + 0 + 0 = \\|\\tilde{x}\\|_{1} $$\n因此，$\\|\\tilde{x}\\|_{1} = p^{\\star}$。由于 $\\tilde{x}$ 是可行的并且其目标值等于最优值，$\\tilde{x}$ 是一个原始最优解。这对任何 $\\rho > 0$ 都成立。\n\n现在我们评估给定的选项。\n\n**A. 对于任意 $\\rho  0$，假设存在一个原始-对偶最优对且强对偶性成立（对于 $f(x) = \\|x\\|_{1}$、等式约束和可行的 $A x = b$ 这是成立的），则存在一个 $\\lambda^{\\star}$，使得 $L_{\\rho}(x,\\lambda^{\\star})$ 的每个极小值点都是原始可行的和原始最优的。相比之下，对于 $P_{\\rho}(x)$，其极小值点在有限 $\\rho$ 下的精确可行性通常无法保证，除非 $f$ 的一个无约束极小值点恰好满足 $A x = b$。**\n我们对增广拉格朗日量的推导表明，如果选择最优的拉格朗日乘子 $\\lambda^{\\star}$，那么 $L_{\\rho}(x, \\lambda^{\\star})$ 的任何极小值点确实对于任何 $\\rho  0$ 都是原始可行和最优的。我们对二次惩罚法的分析表明，其极小值点对于有限的 $\\rho$ 通常是不可行的，除非 $\\|x\\|_1$ 的无约束极小值点（即 $x=0$）是可行的（即 $b=0$）。这个选项提供了对该理论的完美准确总结。\n结论：**正确**。\n\n**B. 因为 $f(x) = \\|x\\|_{1}$ 是 $\\ell_{1}$ 范数，所以存在一个有限阈值 $\\bar{\\rho}$，使得对于所有 $\\rho \\ge \\bar{\\rho}$，$P_{\\rho}(x)$ 的每个极小值点都是精确可行和原始最优的，无论 $A$ 和 $b$ 如何。**\n这个陈述声称二次惩罚函数对于此问题是一个精确惩罚函数。正如我们在对 $P_{\\rho}(x)$ 的分析中所证明的，这是错误的。对于 $b \\neq 0$，对于任何有限的 $\\rho > 0$，$P_{\\rho}(x)$ 的极小值点都不可能是可行的。声称此性质“无论 $A$ 和 $b$ 如何”都成立是特别强的并且是错误的。精确惩罚结果通常需要不可微的惩罚函数（如对残差的 $\\ell_1$ 惩罚，$\\|Ax-b\\|_1$），而不是平方 $\\ell_2$ 惩罚。\n结论：**错误**。\n\n**C. 即使选择了最优的 $\\lambda$，有界的 $\\rho$ 也无法使 $L_{\\rho}(x,\\lambda)$ 的极小值点满足可行性 $A x = b$；必须取 $\\rho \\to \\infty$ 来强制实现可行性。**\n这与增广拉格朗日方法的主要理论优势相反。如上所证，最优选择 $\\lambda = \\lambda^{\\star}$ 保证了极小值点对于任何 $\\rho > 0$ 都是可行的。该陈述描述的是二次惩罚法的行为，而不是增广拉格朗日方法的行为。\n结论：**错误**。\n\n**D. 对于有界的 $\\rho$，$L_{\\rho}(x,\\lambda)$ 的极小值点的可行性要求 $A$ 具有满列秩；否则极小值点必然保持不可行。**\n我们对 $L_{\\rho}(x, \\lambda^{\\star})$ 性质的推导不依赖于关于矩阵 $A$ 的任何假设，例如其秩。该结果是通用的，只要强对偶性成立，就对任何 $A \\in \\mathbb{R}^{m \\times n}$ 都成立。在压缩感知的背景下，通常有一个 $n  m$ 的欠定系统，所以 $A$ 不可能有满列秩。该理论仍然适用。\n结论：**错误**。\n\n**E. 对于任意 $\\rho > 0$ 和任意 $\\lambda \\in \\mathbb{R}^{m}$，$L_{\\rho}(x,\\lambda)$ 的极小值点总是可行的，因为线性项 $\\lambda^{\\top}(A x - b)$ 能精确地强制执行该约束。**\n这是一个严重的夸大陈述。可行性属性被证明仅在特定、最优的选择 $\\lambda = \\lambda^{\\star}$ 时成立。对于任意的 $\\lambda \\neq \\lambda^{\\star}$，$L_{\\rho}(x, \\lambda)$ 的极小值点通常是不可行的。迭代增广拉格朗日方法通过生成一个收敛到 $\\lambda^{\\star}$ 的乘子序列 $\\lambda_k$ 来工作；相应的极小值点序列 $x_k$ 仅在极限情况下才收敛到一个可行点。线性项本身并不能强制执行约束。\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "3432451"}, {"introduction": "从理论走向实践，本练习将展示如何为迭代算法创建一个严谨的停止准则。你将为基追踪降噪 (Basis Pursuit Denoising, BPDN) 问题推导其对偶问题，并利用增广拉格朗日格式中的乘子迭代构造一个可验证的对偶可行证书 (dual-feasible certificate)。这使你能够计算出原始-对偶间隙 (primal-dual gap)，从而为当前解的次优性提供一个实用且理论上可靠的上限 [@problem_id:3432463]。", "problem": "考虑压缩感知中的约束基追踪降噪 (Basis Pursuit Denoising, BPDN) 问题：在欧几里得残差约束下最小化 $\\ell_{1}$ 范数，即求解 $x \\in \\mathbb{R}^{n}$ 以解决\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - b\\|_{2} \\leq \\tau,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$ 是感知矩阵，$b \\in \\mathbb{R}^{m}$ 是测量向量，$\\tau \\geq 0$ 是残差容差。在增广拉格朗日方法 (Augmented Lagrangian Method, ALM) 中，需要迭代更新主变量和乘子，这些乘子逼近了范数约束问题的对偶变量。从拉格朗日对偶、Fenchel 共轭和对偶范数的基本定义出发，推导一个可计算的主对偶间隙表达式，该表达式使用 ALM 乘子为 BPDN 问题构建一个对偶可行凭证。然后，利用此间隙构造一个停止准则，以保证约束问题最优值的绝对误差界。\n\n使用以下具体实例进行计算：\n- 感知矩阵为\n$$\nA = \\begin{pmatrix}\n1  0 \\\\\n0  2\n\\end{pmatrix}.\n$$\n- 测量向量为\n$$\nb = \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n- 残差容差为 $\\tau = 0.5$。\n- 一个 ALM 主迭代值为\n$$\nx^{k} = \\begin{pmatrix}\n0.8 \\\\\n0\n\\end{pmatrix}.\n$$\n- 相应的 ALM 乘子为\n$$\ny^{k} = \\begin{pmatrix}\n-0.2 \\\\\n0\n\\end{pmatrix}.\n$$\n\n你的任务是：\n1. 从第一性原理出发，推导与上述约束 BPDN 公式相关的对偶问题，并确定其对偶变量的可行性约束。\n2. 展示如何仅使用可计算的操作从 ALM 乘子 $y^{k}$ 获得一个对偶可行凭证 $\\tilde{y}$，并证明由此产生的主对偶间隙 $g(x^{k}, \\tilde{y})$ 是绝对误差 $|\\|x^{k}\\|_{1} - v^{\\star}|$ 的一个上界，其中 $v^{\\star}$ 是约束问题的最优值。\n3. 使用你的推导，为所提供的实例计算主对偶间隙 $g(x^{k}, \\tilde{y})$。\n\n将最终答案表示为单个实数。无需四舍五入，请提供精确值。", "solution": "该问题要求推导基追踪降噪 (BPDN) 的对偶问题，从增广拉格朗日方法 (ALM) 的乘子构建对偶可行凭证，证明主对偶间隙可作为误差界，并为一个具体实例计算此间隙。\n\n我们将主问题表示为 (P)，其形式如下：\n$$\nv^{\\star} = \\min_{x \\in \\mathbb{R}^{n}} \\|x\\|_{1} \\quad \\text{subject to} \\quad \\|A x - b\\|_{2} \\leq \\tau\n$$\n其中 $v^{\\star}$ 是最优值。令 $p(x) = \\|x\\|_{1}$ 为主目标函数。\n\n### 第一部分：对偶问题的推导\n\n我们使用拉格朗日对偶来推导对偶问题。通过引入一个松弛变量 $r \\in \\mathbb{R}^m$，该问题可以被重新表述为：\n$$\n\\min_{x, r} \\|x\\|_{1} \\quad \\text{subject to} \\quad Ax - b = r, \\quad \\|r\\|_{2} \\leq \\tau\n$$\n为了处理范数约束，我们使用指示函数来表示它。令 $K = \\{z \\in \\mathbb{R}^{m} \\mid \\|z\\|_{2} \\leq \\tau\\}$ 为半径为 $\\tau$ 的闭球。该集合的指示函数是 $I_K(r)$，如果 $r \\in K$，则其值为 $0$，否则为 $+\\infty$。问题变为：\n$$\n\\min_{x, r} \\|x\\|_{1} + I_K(r) \\quad \\text{subject to} \\quad Ax - b - r = 0\n$$\n我们为等式约束 $Ax - b - r = 0$ 引入一个拉格朗日乘子向量 $y \\in \\mathbb{R}^{m}$。拉格朗日函数是：\n$$\n\\mathcal{L}(x, r, y) = \\|x\\|_{1} + I_K(r) + y^T (Ax - b - r)\n$$\n重新整理各项，我们得到：\n$$\n\\mathcal{L}(x, r, y) = (\\|x\\|_{1} + y^T A x) + (I_K(r) - y^T r) - y^T b\n$$\n拉格朗日对偶函数 $d(y)$ 是拉格朗日函数关于主变量 $x$ 和 $r$ 的下确界：\n$$\nd(y) = \\inf_{x, r} \\mathcal{L}(x, r, y) = -y^T b + \\inf_{x} (\\|x\\|_{1} + (A^T y)^T x) + \\inf_{r} (I_K(r) - y^T r)\n$$\n这两个下确界可以使用 Fenchel 共轭的定义分开计算。一个函数 $f(z)$ 的 Fenchel 共轭是 $f^{*}(w) = \\sup_z (w^T z - f(z))$。因此，$\\inf_z (f(z) - w^T z) = -f^{*}(w)$。\n\n对于第一个下确界，当 $f(x) = \\|x\\|_{1}$ 时：\n$$\n\\inf_{x} (\\|x\\|_{1} + (A^T y)^T x) = \\inf_{x} (\\|x\\|_{1} - (-A^T y)^T x) = -(\\|\\cdot\\|_{1})^{*}(-A^T y)\n$$\n$\\ell_1$ 范数的共轭是在对偶范数（即 $\\ell_{\\infty}$ 范数）下的单位球的指示函数。具体来说，如果 $\\|z\\|_{\\infty} \\leq 1$，则 $(\\|\\cdot\\|_{1})^{*}(z) = 0$，否则为 $+\\infty$。为了使下确界为有限值，我们要求 $\\|-A^T y\\|_{\\infty} \\leq 1$（等价于 $\\|A^T y\\|_{\\infty} \\leq 1$），在这种情况下，下确界为 $0$。\n\n对于第二个下确界，当 $f(r) = I_K(r)$ 时：\n$$\n\\inf_{r} (I_K(r) - y^T r) = -I_K^{*}(y)\n$$\n集合 $K$ 的指示函数的共轭是该集合的支撑函数，$\\sigma_K(z) = \\sup_{r \\in K} z^T r$。所以，$I_K^{*}(z) = \\sigma_K(z)$。\n对于集合 $K = \\{r \\mid \\|r\\|_{2} \\leq \\tau\\}$，支撑函数是 $\\sigma_K(z) = \\tau \\|z\\|_{2}$。\n因此，第二个下确界是 $-I_K^*(y) = -\\sigma_K(y) = -\\tau \\|y\\|_{2}$。这个值总是有限的。\n\n结合这些结果，对偶函数 $d(y)$ 是：\n$$\nd(y) = \\begin{cases} -y^T b - \\tau \\|y\\|_{2}  \\text{if } \\|A^T y\\|_{\\infty} \\leq 1 \\\\ -\\infty  \\text{otherwise} \\end{cases}\n$$\n对偶问题 (D) 是最大化对偶函数：\n$$\n\\max_{y \\in \\mathbb{R}^{m}} d(y) \\quad \\equiv \\quad \\max_{y \\in \\mathbb{R}^{m}} -y^T b - \\tau \\|y\\|_{2} \\quad \\text{subject to} \\quad \\|A^T y\\|_{\\infty} \\leq 1\n$$\n令 $v(y) = -y^T b - \\tau \\|y\\|_{2}$ 为对偶目标。对偶变量 $y$ 的可行性约束是 $\\|A^T y\\|_{\\infty} \\leq 1$。\n\n### 第二部分：对偶凭证和主对偶间隙\n\n给定一个主迭代 $x^{k}$ 和一个 ALM 乘子 $y^{k}$，我们需要构建一个对偶可行点 $\\tilde{y}$，并用它来形成一个误差界。\n\nALM 乘子 $y^{k}$ 是真实对偶最优变量的一个估计，但它不保证是对偶可行的，即它可能不满足 $\\|A^T y^{k}\\|_{\\infty} \\leq 1$。我们可以通过将 $y^{k}$ 投影到可行集上来构建一个对偶可行点 $\\tilde{y}$。一个简单的方法是通过缩放：\n令 $c = \\max(1, \\|A^T y^{k}\\|_{\\infty})$。我们定义对偶可行凭证 $\\tilde{y}$ 为：\n$$\n\\tilde{y} = \\frac{y^{k}}{c} = \\frac{y^{k}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\n$$\n这个操作总是可计算的。为了验证 $\\tilde{y}$ 是对偶可行的，我们检查它是否满足约束：\n$$\n\\|A^T \\tilde{y}\\|_{\\infty} = \\left\\|A^T \\frac{y^{k}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\\right\\|_{\\infty} = \\frac{\\|A^T y^{k}\\|_{\\infty}}{\\max(1, \\|A^T y^{k}\\|_{\\infty})}\n$$\n如果 $\\|A^T y^{k}\\|_{\\infty} \\leq 1$，那么 $\\max(1, \\|A^T y^{k}\\|_{\\infty}) = 1$，且 $\\|A^T \\tilde{y}\\|_{\\infty} = \\|A^T y^{k}\\|_{\\infty} \\leq 1$。\n如果 $\\|A^T y^{k}\\|_{\\infty}  1$，那么 $\\max(1, \\|A^T y^{k}\\|_{\\infty}) = \\|A^T y^{k}\\|_{\\infty}$，且 $\\|A^T \\tilde{y}\\|_{\\infty} = \\frac{\\|A^T y^{k}\\|_{\\infty}}{\\|A^T y^{k}\\|_{\\infty}} = 1$。\n在这两种情况下，都有 $\\|A^T \\tilde{y}\\|_{\\infty} \\leq 1$，所以 $\\tilde{y}$ 是对偶可行的。\n\n对于 BPDN 问题，如果存在一个严格可行点，即存在一个 $x$ 使得 $\\|Ax - b\\|_{2}  \\tau$，则 Slater 条件成立。如果该条件成立，则强对偶性得到保证，意味着主问题的最优值 $v^{\\star}$ 等于对偶问题的最优值。对于任何主可行的迭代 $x^k$（满足 $\\|A x^{k} - b\\|_{2} \\leq \\tau$）和任何对偶可行的点 $\\tilde{y}$（满足 $\\|A^T \\tilde{y}\\|_{\\infty} \\leq 1$），弱对偶性表明：\n$$\nv(\\tilde{y}) \\leq v^{\\star} \\leq p(x^{k})\n$$\n当前迭代目标值的绝对误差是 $|p(x^{k}) - v^{\\star}| = p(x^{k}) - v^{\\star}$（因为 $x^{k}$ 是可行的，所以 $p(x^k) \\geq v^\\star$）。从弱对偶性不等式，我们有：\n$$\np(x^{k}) - v^{\\star} \\leq p(x^{k}) - v(\\tilde{y})\n$$\n这个差值 $g(x^{k}, \\tilde{y}) = p(x^{k}) - v(\\tilde{y})$，被称为主对偶间隙。它是当前迭代 $x^k$ 次优性的一个可计算的上界：\n$$\ng(x^{k}, \\tilde{y}) = \\|x^{k}\\|_{1} - ( - \\tilde{y}^T b - \\tau \\|\\tilde{y}\\|_{2} ) = \\|x^{k}\\|_{1} + \\tilde{y}^T b + \\tau \\|\\tilde{y}\\|_{2}\n$$\n可以基于这个间隙设计一个停止准则：当 $g(x^{k}, \\tilde{y}) \\leq \\epsilon$（对于用户定义的容差 $\\epsilon > 0$）时，迭代算法终止，这保证了 $\\|x^k\\|_1$ 与真实最优值 $v^\\star$ 的差距最多为 $\\epsilon$。\n\n### 第三部分：针对给定实例的计算\n\n我们得到以下实例：\n- $A = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$，$b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$\\tau = 0.5$。\n- 主迭代：$x^{k} = \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix}$。\n- ALM 乘子：$y^{k} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}$。\n\n首先，我们检查 $x^k$ 是否是主可行的：\n$$\nA x^k - b = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\|A x^k - b\\|_{2} = \\sqrt{(-0.2)^2 + 0^2} = \\sqrt{0.04} = 0.2\n$$\n由于 $0.2 \\leq \\tau = 0.5$，迭代点 $x^k$ 是主可行的。\n\n接下来，我们从 $y^k$ 构建对偶可行凭证 $\\tilde{y}$：\n$$\nA^T = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}\n$$\n$$\nA^T y^k = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}\n$$\n$\\ell_{\\infty}$ 范数是 $\\|A^T y^k\\|_{\\infty} = \\max(|-0.2|, |0|) = 0.2$。\n缩放因子是 $c = \\max(1, \\|A^T y^k\\|_{\\infty}) = \\max(1, 0.2) = 1$。\n因此，$\\tilde{y} = \\frac{y^k}{1} = y^k = \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix}$。该乘子已经是对偶可行的。\n\n最后，我们计算主对偶间隙 $g(x^k, \\tilde{y}) = \\|x^k\\|_1 + \\tilde{y}^T b + \\tau \\|\\tilde{y}\\|_2$。我们计算每一项：\n- 主目标函数值：\n$$\np(x^k) = \\|x^k\\|_1 = |0.8| + |0| = 0.8\n$$\n- 来自对偶目标的项：\n$$\n\\tilde{y}^T b = \\begin{pmatrix} -0.2  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (-0.2)(1) + (0)(0) = -0.2\n$$\n- 对偶凭证的范数：\n$$\n\\|\\tilde{y}\\|_2 = \\left\\| \\begin{pmatrix} -0.2 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{(-0.2)^2 + 0^2} = 0.2\n$$\n将这些值代入间隙公式，其中 $\\tau = 0.5$：\n$$\ng(x^k, \\tilde{y}) = 0.8 + (-0.2) + (0.5)(0.2) = 0.8 - 0.2 + 0.1 = 0.7\n$$\n主对偶间隙是 $0.7$。这个值提供了 $x^k$ 目标值次优性的一个上界。", "answer": "$$\\boxed{0.7}$$", "id": "3432463"}, {"introduction": "现实世界的问题常常包含噪声数据，这可能导致约束条件不自洽 (inconsistent constraints)，并使经典的优化算法失效。本练习通过对标准的增广拉格朗日乘子更新规则引入一项有原则的修正，来应对这一挑战。通过分析测量值 $b$ 位于传感算子 $A$ 的值域之外的情景，你将推导出一种基于投影的更新规则如何稳定算法，并防止拉格朗日乘子的发散 [@problem_id:3432484]。", "problem": "考虑压缩感知中的测量模型 $A x = b$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 和 $b \\in \\mathbb{R}^{m}$ 是给定数据。在存在噪声的情况下，$b$ 可能不位于 $A$ 的值域中，即 $b \\notin \\mathrm{range}(A)$，这使得等式约束不一致，并可能导致经典增广拉格朗日更新中的拉格朗日乘子序列发散。为了研究一种有原则的补救方法的效果，我们考虑在许多稀疏优化方案中出现的近端子问题，该问题代表了增广拉格朗日方法的核心机制：在满足线性测量约束的条件下，最小化严格凸的二次目标函数，\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2}\\|x\\|_{2}^{2} \\quad \\text{subject to} \\quad A x = b,\n$$\n其中 $A \\in \\mathbb{R}^{2 \\times 1}$ 和 $b \\in \\mathbb{R}^{2}$ 由下式指定\n$$\nA = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n惩罚参数为 $\\rho  0$。经典的增广拉格朗日函数为\n$$\n\\mathcal{L}_{\\rho}(x,\\lambda) = \\frac{1}{2}\\|x\\|_{2}^{2} + \\langle \\lambda, A x - b \\rangle + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2},\n$$\n乘子更新规则为 $\\lambda^{k+1} = \\lambda^{k} + \\rho(A x^{k+1} - b)$。由于 $b \\notin \\mathrm{range}(A)$，这种未经修改的更新可能导致 $\\lambda^{k}$ 发散。\n\n一种防止因不一致分量导致发散的稳健方法是，通过将乘子仅沿着测量子空间进行更新来放宽约束，这是通过到 $\\mathrm{range}(A)$ 上的正交投影算子 $P$ 实现的，定义为 $P = A A^{\\dagger}$，其中 $A^{\\dagger}$ 表示 $A$ 的 Moore–Penrose 伪逆。在这个修正的方案中，原始更新 $x^{k+1}$ 最小化 $\\mathcal{L}_{\\rho}(x,\\lambda^{k})$，而乘子更新为\n$$\n\\lambda^{k+1} = \\lambda^{k} + \\rho \\, P\\,(A x^{k+1} - b),\n$$\n初始值为 $\\lambda^{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n从上述基本定义出发，不使用任何快捷公式，推导控制该投影更新方案中乘子第一个分量 $\\lambda_{1}^{k}$ 的精确标量递推关系式，并计算当 $k \\to \\infty$ 时 $\\lambda_{1}^{k}$ 的极限值。将你的最终答案表示为一个实数。不需要四舍五入。解释你的推导过程，简要说明为什么这种修改在当前不一致的设定下可以防止发散。", "solution": "该问题陈述是数值优化领域的一个有效练习，具体涉及增广拉格朗日方法在处理具有不一致线性约束的约束优化问题时的行为。问题的所有组成部分在数学上都是良定义的，前提条件是自洽且一致的。\n\n问题要求推导拉格朗日乘子第一个分量 $\\lambda_1^k$ 的标量递推关系，并求其在 $k \\to \\infty$ 时的极限值。该优化问题是：\n$$\n\\min_{x \\in \\mathbb{R}} \\ \\frac{1}{2}\\|x\\|_{2}^{2} \\quad \\text{subject to} \\quad A x = b\n$$\n这里，$x$ 是一个标量，因为 $A \\in \\mathbb{R}^{2 \\times 1}$。给定的数据是：\n$$\nA = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n系统 $Ax=b$ 是不一致的，因为 $\\mathrm{range}(A)$ 由任意标量 $\\alpha$ 的 $\\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}$ 形式的向量组成，而 $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 不具有这种形式。\n\n修正的增广拉格朗日方案由以下迭代更新定义：\n1. 原始更新：$x^{k+1} = \\arg\\min_{x} \\mathcal{L}_{\\rho}(x, \\lambda^{k})$\n2. 对偶更新：$\\lambda^{k+1} = \\lambda^{k} + \\rho P (A x^{k+1} - b)$\n\n其中 $\\mathcal{L}_{\\rho}(x,\\lambda) = \\frac{1}{2}\\|x\\|_{2}^{2} + \\langle \\lambda, A x - b \\rangle + \\frac{\\rho}{2}\\|A x - b\\|_{2}^{2}$，$P$ 是到 $\\mathrm{range}(A)$ 上的正交投影算子，初始值为 $\\lambda^0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n首先，我们确定投影矩阵 $P = AA^{\\dagger}$。对于一个满列秩的矩阵 $A$，其 Moore-Penrose 伪逆 $A^{\\dagger}$ 由 $A^{\\dagger} = (A^T A)^{-1} A^T$ 给出。\n我们有 $A^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$。\n$$\nA^T A = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1\n$$\n所以，$(A^T A)^{-1} = 1$。\n伪逆为：\n$$\nA^{\\dagger} = 1 \\cdot \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n现在，我们可以计算投影算子 $P$：\n$$\nP = A A^{\\dagger} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n该矩阵将 $\\mathbb{R}^2$ 中的任何向量投影到由 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 张成的子空间上，也就是 $A$ 的值域。\n\n接下来，我们通过最小化关于 $x$ 的增广拉格朗日函数 $\\mathcal{L}_{\\rho}(x, \\lambda^k)$ 来找到原始更新 $x^{k+1}$。由于 $x$ 是一个标量，$\\|x\\|_2^2 = x^2$。\n$$\n\\mathcal{L}_{\\rho}(x,\\lambda^k) = \\frac{1}{2}x^2 + (\\lambda^k)^T(Ax-b) + \\frac{\\rho}{2}\\|Ax-b\\|_2^2\n$$\n这是一个关于 $x$ 的严格凸函数。通过将其关于 $x$ 的导数设为零来找到最小值。\n$$\n\\frac{d}{dx} \\mathcal{L}_{\\rho}(x,\\lambda^k) = x + A^T \\lambda^k + \\rho A^T (Ax - b) = 0\n$$\n在第 $(k+1)$ 步求解 $x$，我们得到：\n$$\nx^{k+1} + \\rho A^T A x^{k+1} = -A^T \\lambda^k + \\rho A^T b\n$$\n$$\n(1 + \\rho A^T A) x^{k+1} = A^T(\\rho b - \\lambda^k)\n$$\n我们代入已知值：$A^T A = 1$，$A^T = \\begin{pmatrix} 1  0 \\end{pmatrix}$，$b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。设 $\\lambda^k = \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix}$。\n$$\nA^T b = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1\n$$\n$$\nA^T \\lambda^k = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix} = \\lambda_1^k\n$$\n将这些代入 $x^{k+1}$ 的方程中：\n$$\n(1 + \\rho) x^{k+1} = \\rho(1) - \\lambda_1^k\n$$\n$$\nx^{k+1} = \\frac{\\rho - \\lambda_1^k}{1+\\rho}\n$$\n\n现在，我们分析对偶更新：$\\lambda^{k+1} = \\lambda^k + \\rho P (A x^{k+1} - b)$。\n首先，计算残差项 $A x^{k+1} - b$：\n$$\nA x^{k+1} - b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} x^{k+1} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} x^{k+1} - 1 \\\\ -1 \\end{pmatrix}\n$$\n接下来，应用投影算子 $P$：\n$$\nP(A x^{k+1} - b) = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} x^{k+1} - 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} x^{k+1} - 1 \\\\ 0 \\end{pmatrix}\n$$\n对偶更新方程则为：\n$$\n\\begin{pmatrix} \\lambda_1^{k+1} \\\\ \\lambda_2^{k+1} \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^k \\\\ \\lambda_2^k \\end{pmatrix} + \\rho \\begin{pmatrix} x^{k+1} - 1 \\\\ 0 \\end{pmatrix}\n$$\n这个向量方程产生两个标量递推关系：\n1. $\\lambda_1^{k+1} = \\lambda_1^k + \\rho (x^{k+1} - 1)$\n2. $\\lambda_2^{k+1} = \\lambda_2^k + 0 = \\lambda_2^k$\n\n从第二个递推关系可以看出，$\\lambda_2^k$ 是常数。根据初始条件 $\\lambda^0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，我们有 $\\lambda_2^0 = 0$，所以对于所有 $k \\ge 0$，$\\lambda_2^k = 0$。\n\n现在我们推导所要求的 $\\lambda_1^k$ 的标量递推关系。我们将 $x^{k+1}$ 的表达式代入第一个递推关系中：\n$$\n\\lambda_1^{k+1} = \\lambda_1^k + \\rho \\left( \\frac{\\rho - \\lambda_1^k}{1+\\rho} - 1 \\right)\n$$\n简化括号中的项：\n$$\n\\frac{\\rho - \\lambda_1^k}{1+\\rho} - \\frac{1+\\rho}{1+\\rho} = \\frac{\\rho - \\lambda_1^k - 1 - \\rho}{1+\\rho} = \\frac{-1 - \\lambda_1^k}{1+\\rho}\n$$\n所以递推关系变为：\n$$\n\\lambda_1^{k+1} = \\lambda_1^k + \\rho \\left( \\frac{-1 - \\lambda_1^k}{1+\\rho} \\right) = \\lambda_1^k - \\frac{\\rho}{1+\\rho} \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^{k+1} = \\left( 1 - \\frac{\\rho}{1+\\rho} \\right) \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^{k+1} = \\left( \\frac{1+\\rho-\\rho}{1+\\rho} \\right) \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n精确的标量递推关系是：\n$$\n\\lambda_1^{k+1} = \\frac{1}{1+\\rho} \\lambda_1^k - \\frac{\\rho}{1+\\rho}\n$$\n这是一个线性一阶递推关系。由于 $\\rho  0$，系数 $\\frac{1}{1+\\rho}$ 位于区间 $(0, 1)$ 内。因此，序列 $\\{\\lambda_1^k\\}$ 收敛到一个唯一的不动点 $\\lambda_1^*$。该不动点满足：\n$$\n\\lambda_1^* = \\frac{1}{1+\\rho} \\lambda_1^* - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( 1 - \\frac{1}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( \\frac{1+\\rho-1}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* \\left( \\frac{\\rho}{1+\\rho} \\right) = - \\frac{\\rho}{1+\\rho}\n$$\n$$\n\\lambda_1^* = -1\n$$\n当 $k \\to \\infty$ 时，$\\lambda_1^k$ 的极限值为 $-1$。\n\n这种修改可以防止发散，因为投影算子 $P$ 滤除了残差 $Ax-b$ 中位于 $A^T$ 零空间的分量，该分量对应于线性系统的不一致部分。标准的乘子更新 $\\lambda^{k+1} = \\lambda^k + \\rho(Ax^{k+1}-b)$ 会导致 $\\lambda_2^k$ 序列发散。具体来说，第二个分量的更新将是 $\\lambda_2^{k+1} = \\lambda_2^k + \\rho(-1)$。从 $\\lambda_2^0 = 0$ 开始，这导致 $\\lambda_2^k = -k\\rho$，它会发散到 $-\\infty$。通过使用投影残差 $P(Ax^{k+1}-b)$，更新向量被强制位于 $\\mathrm{range}(A)$ 内。在这种情况下，更新向量的第二个分量始终为零，从而将相应的乘子分量 $\\lambda_2^k$ 稳定在其初始值 $0$。该方法实际上解决了投影后的（且一致的）问题 $\\min \\frac{1}{2}\\|x\\|_2^2$，约束条件为 $Ax=Pb$。这个一致问题的 KKT 条件给出 $x=1$ 和乘子 $-1$，这与我们的极限值相匹配。", "answer": "$$\\boxed{-1}$$", "id": "3432484"}]}