## 引言
在现代科学与工程领域，从海量数据中提取关键信息的需求日益增长。许多此类问题，尤其是在[压缩感知](@entry_id:197903)、统计学和机器学习中，最终都可归结为求解欠定[线性方程组](@entry_id:148943)的稀疏解。ℓ₁范数因其强大的稀疏促进能力而成为解决这类问题的首选工具。然而，ℓ₁范数的非光滑性给标准优化算法的直接应用带来了挑战，形成了一个关键的知识缺口。本文旨在系统性地填补这一缺口，全面介绍一类强大而高效的算法——[内点法](@entry_id:169727)——如何用于求解ℓ₁最小化问题。

本文将通过三个章节引导读者深入理解这一主题。在“原理与机制”一章中，我们将从第一性原理出发，学习如何将ℓ₁问题转化为线性规划，并探索[中心路径](@entry_id:147754)、对偶性和[牛顿法](@entry_id:140116)等核心概念。接下来，在“应用与跨学科连接”一章中，我们将展示[内点法](@entry_id:169727)在解决LASSO、稀疏逻辑回归、总变差[图像重建](@entry_id:166790)等实际问题中的强大能力和灵活性。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识转化为实践技能。通过本文的学习，你将掌握使用[内点法](@entry_id:169727)解决[稀疏优化](@entry_id:166698)问题的完整知识体系。

## 原理与机制

如前所述，在信号处理、统计学和机器学习等领域中，寻求欠定[线性方程组](@entry_id:148943)的[稀疏解](@entry_id:187463)的基本问题。核心问题通常可以表述为 $\ell_1$ 范数最小化，因为它具有促进稀疏性的优良特性。本章将深入探讨解决此类问题的核心原理和机制，重点关注一类强大而高效的算法——[内点法](@entry_id:169727)（Interior-Point Methods）。我们将从第一性原理出发，系统地构建起将 $\ell_1$ 最小化问题转化为可通过[内点法](@entry_id:169727)求解的数学框架，并阐明其背后的深刻思想和计算策略。

### 从 $\ell_1$ 范数到线性规划

$\ell_1$ 范数最小化的[标准形式](@entry_id:153058)，也称为**[基追踪](@entry_id:200728)（Basis Pursuit）**，可以写作：
$$
\min_{x \in \mathbb{R}^n} \|x\|_1 \quad \text{subject to} \quad A x = b
$$
其中 $A \in \mathbb{R}^{m \times n}$ 是测量矩阵，$b \in \mathbb{R}^m$ 是观测向量，通常 $m \ll n$。目标函数 $\|x\|_1 = \sum_{i=1}^n |x_i|$ 是非光滑的（在坐标轴上不可微），这给直接应用[基于梯度的优化](@entry_id:169228)方法带来了挑战。为了克服这一困难，我们采用一种标准的策略：将问题**重构**为一个等价的光滑[优化问题](@entry_id:266749)，特别是**[线性规划](@entry_id:138188)（Linear Programming, LP）**。

#### 变量[分裂法](@entry_id:755245)

最常用的重构方法是**变量分裂（variable splitting）**。任何实数 $x_i$ 都可以表示为其正部和负部之差：$x_i = u_i - v_i$，其中 $u_i = \max(x_i, 0)$ 且 $v_i = \max(-x_i, 0)$。根据这个定义，$u_i$ 和 $v_i$ 都是非负的，即 $u_i \ge 0, v_i \ge 0$。此外，一个关键的性质是 $|x_i| = u_i + v_i$，并且在最优分解下，对于任意 $i$，我们有 $u_i v_i = 0$（即 $u_i$ 和 $v_i$ 中至少有一个为零）。

利用这个分解，我们可以将原始变量 $x \in \mathbb{R}^n$ 替换为两个非负向量 $u, v \in \mathbb{R}^n$。原始的 $\ell_1$ 范数目标函数 $\|x\|_1$ 就被替换为线性的[目标函数](@entry_id:267263) $\mathbf{1}^\top u + \mathbf{1}^\top v$，其中 $\mathbf{1} \in \mathbb{R}^n$ 是全一向量。[线性约束](@entry_id:636966) $Ax=b$ 也相应地变为 $A(u-v)=b$。因此，[基追踪](@entry_id:200728)问题被精确地转化为以下[线性规划](@entry_id:138188)问题 [@problem_id:3453565] [@problem_id:3453551]：
$$
\min_{u, v \in \mathbb{R}^n} \quad \mathbf{1}^\top u + \mathbf{1}^\top v \quad \text{subject to} \quad A(u - v) = b, \quad u \ge 0, \quad v \ge 0.
$$
这种LP形式具有线性目标函数和[线性约束](@entry_id:636966)（[等式约束](@entry_id:175290)和非负[不等式约束](@entry_id:176084)），为应用包括[内点法](@entry_id:169727)在内的标准[优化算法](@entry_id:147840)铺平了道路。

#### 上镜[图表示](@entry_id:273102)法

另一种等价的LP重构方法是**上镜图（epigraph）**表示法。注意到 $\|x\|_1$ 是 $\max_{i} |x_i|$ 的一种泛化。我们可以通过引入一个辅助向量 $u \in \mathbb{R}^n$ 来约束 $x$ 的每个分量的[绝对值](@entry_id:147688)。约束 $-u \le x \le u$（逐分量）等价于 $|x_i| \le u_i$ 对所有 $i=1, \dots, n$ 成立。为了最小化 $\|x\|_1$，我们实际上是想让这些上界 $u_i$ 尽可能小。因此，我们可以将目标设定为最小化 $\sum_i u_i = \mathbf{1}^\top u$。这引出了以下LP形式 [@problem_id:3453604]：
$$
\min_{x, u \in \mathbb{R}^n} \quad \mathbf{1}^\top u \quad \text{subject to} \quad A x = b, \quad -u \le x \le u.
$$
这里的约束 $-u \le x \le u$ 可以进一步分解为两组[线性不等式](@entry_id:174297)：$x - u \le 0$ 和 $-x - u \le 0$。尽管这两种LP形式在变量和约束的表述上有所不同，但它们是等价的，并且都可以作为[内点法](@entry_id:169727)的出发点。在后续的讨论中，我们将主要聚焦于更常见的变量分裂形式。

### 对偶性的作用与最优性认证

对偶性是[凸优化](@entry_id:137441)中的一个核心概念，它为我们提供了理解问题结构、推导算法和认证最优性的有力工具。

对于一个给定的（原始）最小化问题，我们可以构造一个相应的（对偶）最大化问题。[对偶问题](@entry_id:177454)的最优值构成了原始问题最优值的一个下界，这一性质被称为**[弱对偶](@entry_id:163073)性**。对于凸问题（如我们的LP），在温和的条件下，[原始问题和对偶问题](@entry_id:151869)的最优值是相等的，这被称为**强对偶性**。

我们可以为[基追踪](@entry_id:200728)问题推导其**[拉格朗日对偶问题](@entry_id:637210)**。原始问题为 $\min_{x} \|x\|_1$ s.t. $Ax=b$。我们引入[对偶变量](@entry_id:143282)（或[拉格朗日乘子](@entry_id:142696)）$y \in \mathbb{R}^m$ 与[等式约束](@entry_id:175290)相关联，构造[拉格朗日函数](@entry_id:174593)：
$$
L(x, y) = \|x\|_1 + y^\top(b - Ax) = \|x\|_1 - (A^\top y)^\top x + b^\top y
$$
对[偶函数](@entry_id:163605) $g(y)$ 是 $L(x, y)$ 关于[原始变量](@entry_id:753733) $x$ 的最小值：
$$
g(y) = \inf_{x \in \mathbb{R}^n} L(x, y) = b^\top y + \inf_{x \in \mathbb{R}^n} \left( \|x\|_1 - (A^\top y)^\top x \right)
$$
其中的 $\inf$ 项是 $\ell_1$ 范数的共轭函数的负值在 $A^\top y$ 处的取值。$\ell_1$ 范数的[对偶范数](@entry_id:200340)是 $\ell_\infty$ 范数，其共轭函数是一个指示函数。具体来说，当且仅当 $\|A^\top y\|_\infty \le 1$ 时，该 $\inf$ 项为 $0$，否则为 $-\infty$。因此，[对偶问题](@entry_id:177454)是最大化 $g(y)$，即 [@problem_id:3453565] [@problem_id:3453575] [@problem_id:3453591]：
$$
\max_{y \in \mathbb{R}^m} \quad b^\top y \quad \text{subject to} \quad \|A^\top y\|_\infty \le 1
$$
其中 $\|A^\top y\|_\infty = \max_{i=1,\dots,n} |(A^\top y)_i|$。

**[对偶间隙](@entry_id:173383)（duality gap）**定义为原始目标值与对偶目标值之差。对于任何原始[可行解](@entry_id:634783) $x$ 和对偶[可行解](@entry_id:634783) $y$，[对偶间隙](@entry_id:173383)为 $\|x\|_1 - b^\top y \ge 0$。当且仅当一个解是最优时，[对偶间隙](@entry_id:173383)为零。这个性质至关重要，因为它提供了一个**[最优性证书](@entry_id:178805)**：如果我们能找到一对原始可行解 $x$ 和对偶可行解 $y$，使得它们的[对偶间隙](@entry_id:173383)足够小（例如，小于某个预设的容差 $\varepsilon$），我们就可以确认 $x$ 是一个近似最优解。这构成了[内点法](@entry_id:169727)等算法的一个自然**[停止准则](@entry_id:136282)** [@problem_id:3453568] [@problem_id:3453591]。

### [内点法](@entry_id:169727)：[中心路径](@entry_id:147754)

[内点法](@entry_id:169727)的核心思想是避开[可行域](@entry_id:136622)的边界（[多面体的顶点](@entry_id:635258)和边），通过其严格内部（interior）来逼近最优解。这是通过在目标函数中加入一个**障碍项（barrier term）**来实现的，该障碍项会在变量接近[可行域](@entry_id:136622)边界时趋于无穷大。

对于前述的变量分裂LP形式，我们需要处理的约束是 $u \ge 0$ 和 $v \ge 0$。一个标准的障碍是**[对数障碍函数](@entry_id:139771)**：
$$
\phi(u, v) = -\sum_{i=1}^n \log(u_i) - \sum_{i=1}^n \log(v_i)
$$
我们将这个障碍项加到原始LP的目标函数中，并由一个障碍参数 $\mu > 0$（或 $1/t$）来加权。这构成了**障碍子问题**：
$$
\min_{u, v} \quad \mathbf{1}^\top(u+v) - \mu \sum_{i=1}^n (\log u_i + \log v_i) \quad \text{subject to} \quad A(u-v)=b
$$
对于每一个 $\mu > 0$，这个子问题都有一个唯一的最优解 $(u(\mu), v(\mu))$。所有这些解的集合，即 $\{(u(\mu), v(\mu)) \mid \mu > 0\}$，构成了一条平滑的曲线，称为**[中心路径](@entry_id:147754)（central path）** [@problem_id:3453551]。这条路径始于可行域的“中心”，并随着 $\mu \to 0$ 而收敛到原始LP的最优解。[内点法](@entry_id:169727)本质上就是一个**路径跟随（path-following）**算法，它通过迭代地求解一系列 $\mu$ 值递减的障碍子问题来追踪[中心路径](@entry_id:147754)。

#### [中心路径](@entry_id:147754)的刻画

[中心路径](@entry_id:147754)上的点可以通过求解障碍子问题的**[Karush-Kuhn-Tucker (KKT) 条件](@entry_id:176491)**来精确刻画。对于上述子问题，其[KKT条件](@entry_id:185881)包括[等式约束](@entry_id:175290) $A(u-v)=b$ 以及梯度为零的条件。引入[拉格朗日乘子](@entry_id:142696) $y$ 对应于[等式约束](@entry_id:175290)，我们可以得到关于 $u$ 和 $v$ 的梯度方程：
$$
\nabla_u L = \mathbf{1} - \mu u^{-1} - A^\top y = 0 \quad \implies \quad \mu u^{-1} = \mathbf{1} - A^\top y
$$
$$
\nabla_v L = \mathbf{1} - \mu v^{-1} + A^\top y = 0 \quad \implies \quad \mu v^{-1} = \mathbf{1} + A^\top y
$$
其中 $u^{-1}$ 和 $v^{-1}$ 表示逐元素求倒数。

从**原始-对偶（primal-dual）**的视角看，[中心路径](@entry_id:147754)具有更深刻的含义。对于L[P问题](@entry_id:267898)，KKT[最优性条件](@entry_id:634091)包括原始可行性、对偶可行性以及**[互补松弛性](@entry_id:141017)（complementary slackness）**。对于变量分裂LP，这些条件包括：
1.  **原始可行性**: $A(u-v)=b$, $u \ge 0, v \ge 0$.
2.  **对偶可行性**: 存在对偶[松弛变量](@entry_id:268374) $s_u, s_v \ge 0$ 使得 $A^\top y + s_u = \mathbf{1}$ 和 $-A^\top y + s_v = \mathbf{1}$。
3.  **[互补松弛性](@entry_id:141017)**: $u_i s_{u,i} = 0$ 和 $v_i s_{v,i} = 0$ 对所有 $i$ 成立。

[中心路径](@entry_id:147754)上的点恰好满足了原始和对偶可行性条件，但将[互补松弛性](@entry_id:141017)条件**松弛**为 [@problem_id:3453551]：
$$
u_i s_{u,i} = \mu \quad \text{and} \quad v_i s_{v,i} = \mu, \quad \text{for all } i=1,\dots,n.
$$
这揭示了[中心路径](@entry_id:147754)的本质：它是一系列在原始-[对偶空间](@entry_id:146945)中满足扰动互补性条件的点的轨迹。随着 $\mu \to 0$，我们恢复了严格的互补性，从而达到最优解。

值得注意的是，不同的文献可能使用不同的障碍参数化。例如，障碍子问题可能被写成 $\min_x t c^\top x - \sum \log(x_i)$。在这种情况下，障碍参数 $t$ 与我们使用的互补性参数 $\mu$ 之间的关系是 $\mu = 1/t$ [@problem_id:3453604]。理解这种对应关系对于正确解读算法和理论至关重要。

### 导航[中心路径](@entry_id:147754)：[牛顿法](@entry_id:140116)与步长选择

[内点法](@entry_id:169727)的每一次迭代都旨在从当前点移动到[中心路径](@entry_id:147754)上的下一个目标点（对应于一个更小的 $\mu$）。这个移动是通过求解定义[中心路径](@entry_id:147754)的[非线性](@entry_id:637147)KKT[方程组](@entry_id:193238)的一步**[牛顿法](@entry_id:140116)**来实现的。

#### 牛顿系统与舒尔补

对[中心路径](@entry_id:147754)的KKT[方程组](@entry_id:193238)进行线性化，我们可以得到一个关于搜索方向 $(\Delta u, \Delta v, \Delta y)$ 的[线性方程组](@entry_id:148943)，即**牛顿系统**。对于变量分裂LP，这个系统具有如下的块结构 [@problem_id:3453565]：
$$
\begin{pmatrix}
H_u & 0 & A^\top \\
0 & H_v & -A^\top \\
A & -A & 0
\end{pmatrix}
\begin{pmatrix} \Delta u \\ \Delta v \\ \Delta y \end{pmatrix}
=
- \begin{pmatrix} r_u \\ r_v \\ r_A \end{pmatrix}
$$
其中 $H_u$ 和 $H_v$ 是[对角矩阵](@entry_id:637782)，来自于[对数障碍函数](@entry_id:139771)关于 $u$ 和 $v$ 的[二阶导数](@entry_id:144508)（Hessian矩阵），$r_u, r_v, r_A$ 是[KKT条件](@entry_id:185881)的当前残差。

由于 $H_u$ 和 $H_v$ 是对角的（因此容易求逆），我们可以通过**块消元**来简化这个系统。从前两行方程中解出 $\Delta u$ 和 $\Delta v$ 并代入第三行，可以得到一个只关于对偶步长 $\Delta y$ 的较小[线性系统](@entry_id:147850)：
$$
\left( A (H_u^{-1} + H_v^{-1}) A^\top \right) \Delta y = r'
$$
这个 $m \times m$ 的矩阵 $S = A D A^\top$（其中 $D$ 是一个对角矩阵，此处为 $H_u^{-1} + H_v^{-1}$）被称为**[舒尔补](@entry_id:142780)（Schur complement）**或**法方程（normal equations）**矩阵。求解这个[舒尔补](@entry_id:142780)系统是[内点法](@entry_id:169727)每一步迭代中计算量最大的部分 [@problem_id:3453598]。一旦求得 $\Delta y$，就可以通过[回代](@entry_id:146909)轻易地得到 $\Delta u$ 和 $\Delta v$。

#### 步长选择

牛顿法给出了搜索方向，但我们还需要确定沿着这个方向走多远，即选择一个**步长（step length）** $\alpha$。一个关键的要求是，新的迭代点 $(u + \alpha \Delta u, v + \alpha \Delta v)$ 必须保持在[可行域](@entry_id:136622)的严格内部，即 $u^+ > 0$ 和 $v^+ > 0$。这意味着 $\alpha$ 必须小于任何使得某个分量变为零的步长。

然而，仅仅保持[严格可行性](@entry_id:636200)是不够的。为了保证算法的[稳定收敛](@entry_id:199422)，我们不希望迭代点过于贴近边界。因此，实际的[内点法](@entry_id:169727)通常采用**边界分数规则（fraction-to-the-boundary rule）**。该规则要求选择一个最大的步长 $\alpha \in (0, 1]$，使得对于所有正在减小的分量（例如 $\Delta u_i  0$），新的值 $u_i^+$ 至少是原值 $u_i$ 的一个比例 $\gamma$（通常 $\gamma$ 取接近1的值，如0.995）。这可以表示为 [@problem_id:3453572]：
$$
\alpha \le \gamma \min \left\{ \min_{i : \Delta u_i  0} \frac{-u_i}{\Delta u_i}, \min_{i : \Delta v_i  0} \frac{-v_i}{\Delta v_i} \right\}
$$
选择满足此条件的最大 $\alpha$（并截断在1），可以确保算法在向最优解迈出大步的同时，又能与边界保持安全距离，从而保证[数值稳定性](@entry_id:146550)和收敛性。

### [中心路径](@entry_id:147754)的性质与示例

为了更具体地理解[中心路径](@entry_id:147754)，我们可以考察一些简单的例子，并分析其极限性质。

考虑一个简单的[基追踪](@entry_id:200728)问题，其中 $A = \begin{pmatrix} 1  1 \end{pmatrix}$ 和 $b=1$。求解相应的[中心路径](@entry_id:147754)方程，我们可以得到沿路径的解 $(u(t), v(t))$ 和[原始变量](@entry_id:753733) $x(t) = u(t) - v(t)$ 作为障碍参数的显式函数。例如，可以推导出沿路径的目标值 $\mathbf{1}^\top(u(t)+v(t))$ 为 $\frac{\sqrt{t^2+4}+2}{t}$ [@problem_id:3453607]。当 $t \to \infty$（即 $\mu \to 0$）时，此值趋向于1，这正是该问题的最优值。

更深入地，通过分析[KKT条件](@entry_id:185881)，我们可以揭示最优解的[稀疏结构](@entry_id:755138)是如何从对偶信息中浮现的。考虑另一个例子，$A = \begin{pmatrix} 1  2  -1 \end{pmatrix}, b=1$ [@problem_id:3453591]。首先，求解[对偶问题](@entry_id:177454) $\max y$ s.t. $|y| \le 1, |2y| \le 1, |-y| \le 1$ 得到最优对偶解 $y^\star = 1/2$。然后，考察对偶[松弛变量](@entry_id:268374) $s_u = \mathbf{1} - A^\top y^\star$ 和 $s_v = \mathbf{1} + A^\top y^\star$。我们会发现，在 $y^\star = 1/2$ 时，只有一个对偶松弛分量 $s_{u,2} = 1 - 2y^\star$ 恰好为零。根据[互补松弛性](@entry_id:141017) $(u_i s_{u,i} = 0, v_i s_{v,i} = 0)$，这意味着只有对应的原始变量 $u_2$ 可以为非零值，所有其他变量（$u_1, u_3, v_1, v_2, v_3$）都必须为零。将此代入原始约束 $A(u-v)=b$ 即可解得 $2u_2 = 1 \implies u_2 = 1/2$。最终的最优目标值为 $1/2$。这个例子完美地展示了对偶解如何决定原始解的**支撑集（support）**。

[中心路径](@entry_id:147754)的极限行为也揭示了深刻的几何性质 [@problem_id:3453551]：
*   **当 $\mu \to 0$ 时**：[中心路径](@entry_id:147754)收敛到原始L[P问题](@entry_id:267898)的一个最优解。如果最优解不唯一（形成一个最优面），路径会收敛到该最优面上的一个特定点，即该最优面的**解析中心（analytic center）**。这为[内点法](@entry_id:169727)选择特定类型的稀疏解提供了理论依据。
*   **当 $\mu \to \infty$ 时**：[中心路径](@entry_id:147754)会趋向于整个可行域的解析中心。对于变量分裂LP，其[可行域](@entry_id:136622)通常是无界的，因此解析中心可能没有良好定义。然而，一个更精妙的结果是，[原始变量](@entry_id:753733)的轨迹 $x(\mu) = u(\mu)-v(\mu)$ 在 $\mu \to \infty$ 时的极限，恰好是满足约束 $Ax=b$ 的**最小$\ell_2$范数解**。这在直觉上是合理的：当障碍项（它试图让所有变量远离零）的影响被无限放大时，算法会找到一个尽可能“平滑”或“分散”的解，这正是[最小二乘解](@entry_id:152054)的特性。

### 计算考量与理论保证

[内点法](@entry_id:169727)的实际性能和理论分析是其成功的关键。

#### 求解牛顿系统

如前所述，求解舒尔补系统 $S \Delta y = r$ 是每一步的计算瓶颈。主要有两种策略 [@problem_id:3453598]：

1.  **直接法**：显式地计算 $m \times m$ 矩阵 $S = A D A^\top$，然后使用**[Cholesky分解](@entry_id:147066)**来求解。
    *   **优点**：对于给定的 $S$，计算时间是确定的，并且数值上非常稳定。
    *   **缺点**：当 $m$ 很大时，计算和存储 $S$ 的开销可能非常高。形成 $S$ 的计算成本为 $\mathcal{O}(m^2 n)$（对于稠密的 $A$），[Cholesky分解](@entry_id:147066)的成本为 $\mathcal{O}(m^3)$。

2.  **迭代法**：不显式形成 $S$，而是使用**共轭梯度法（Conjugate Gradients, CG）**等矩阵无关的迭代方法来求解。CG仅需要计算矩阵-向量乘积 $v \mapsto Sv = A(D(A^\top v))$ 的能力。
    *   **优点**：内存开销小，不需存储 $S$。如果 $A$ 是稀疏的或具有快速变换结构（如FFT），每次CG迭代的成本可能远低于直接法。
    *   **缺点**：CG的[收敛速度](@entry_id:636873)依赖于 $S$ 的**条件数**。随着 $\mu \to 0$，$S$ 往往会变得病态（ill-conditioned），导致CG迭代次数激增。

在实践中，当 $m$ 较小或中等时，直接法通常更鲁棒和高效。当 $m$ 非常大时，迭代法（通常与预条件技术相结合）成为唯一可行的选择。此外，[迭代法](@entry_id:194857)允许**非精确求解**，即在早期迭代中以较低的精度求解牛顿系统，并随着 $\mu \to 0$ 逐渐提高精度，这可以显著节省总计算时间 [@problem_id:3453598]。

#### 理论收敛性

[内点法](@entry_id:169727)的一个标志性成就是其强大的理论保证。对于使用[对数障碍](@entry_id:144309)的**短步长（short-step）**路径跟随算法，可以证明其具有[多项式时间](@entry_id:263297)的收敛性。具体来说，要将[对偶间隙](@entry_id:173383)从初始值减小到 $\varepsilon$，所需的牛顿迭代次数具有一个最坏情况下的[上界](@entry_id:274738) [@problem_id:3453558]：
$$
\text{迭代次数} = \mathcal{O}\left(\sqrt{N} \log\left(\frac{N}{\varepsilon}\right)\right)
$$
其中 $N$ 是[不等式约束](@entry_id:176084)的总数。对于变量分裂LP，我们有 $2n$ 个非负约束，因此 $N=2n$。这个结果表明，[内点法](@entry_id:169727)达到高精度解所需的迭代次数仅随问题规模的平方根温和增长，并且随目标精度的对数增长。这种优异的收敛性质使其成为求解中到大规模L[P问题](@entry_id:267898)的首选方法之一。