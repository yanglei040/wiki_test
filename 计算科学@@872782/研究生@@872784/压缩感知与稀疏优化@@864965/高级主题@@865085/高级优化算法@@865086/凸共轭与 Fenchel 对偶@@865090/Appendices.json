{"hands_on_practices": [{"introduction": "第一个实践是根据第一性原理计算凸共轭函数的一项基础练习。我们将处理负泊松对数似然函数，这是许多统计建模和成像问题的核心。这项练习将提升你应用共轭定义的技能，并揭示对偶的优美对称性，即原始域中的约束如何转化为对偶域中的特定结构。[@problem_id:3439398]", "problem": "考虑一个泊松压缩感知模型，其感知矩阵为 $A \\in \\mathbb{R}^{m \\times n}$，非负数据为 $b \\in \\mathbb{R}_{+}^{m}$。将负泊松对数似然定义为一个可分的扩展实值凸函数 $f : \\mathbb{R}^{m} \\to \\mathbb{R} \\cup \\{+\\infty\\}$，其表达式为\n$$\nf(u) \\;=\\; \\sum_{i=1}^{m} \\Big( u_i \\;-\\; b_i \\ln u_i \\Big),\n$$\n约定当任意坐标 $u_i \\le 0$ 时，$f(u) = +\\infty$。令 $\\iota_{C}(\\cdot)$ 表示集合 $C$ 的指示函数，定义为：如果 $z \\in C$，则 $\\iota_{C}(z) = 0$；如果 $z \\notin C$，则 $\\iota_{C}(z) = +\\infty$。\n\n你需要使用凸共轭的基本定义和 Fenchel–Rockafellar 对偶性来分析由 $f$ 导出的对偶结构。具体来说：\n\n- 从凸共轭的定义出发，\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\mathbb{R}^{m}} \\big\\{ \\langle y, u \\rangle \\;-\\; f(u) \\big\\},\n$$\n推导出 $f^{*}(y)$ 的闭式表达式，包括其有效域。你的推导必须从第一性原理出发（凸共轭的定义、可分和的性质以及逐点上确界的性质），不能调用任何预先记忆的变换表。\n\n- 解释有效域如何编码一个分量形式为 $y \\prec \\mathbf{1}$（即对于每个索引 $i$ 都有 $y_i  1$）的约束，并讨论该域如何作为对偶问题中的自然屏障而产生。\n\n- 通过在 $f$ 的 Fenchel 双共轭公式中进行变量替换 $s_i = \\ln(1 - y_i)$，将你得到的 $f^{*}$ 表达式与一个等价表示联系起来，从而揭示形如 $u_i \\exp(s_i)$ 和 $b_i s_i$ 的项是如何在中间优化过程中出现的，以及这与泊松模型中经常出现的指数结构有何关系。\n\n答案规格：\n- 仅报告 $f^{*}(y)$ 的最终闭式表达式，使用初等函数，并在需要时使用指示函数 $\\iota_{C}(\\cdot)$ 来编码定义域。\n- 你的最终答案必须是单一的精确解析表达式。不要以不等式或方程作为最终答案。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够信息以进行严格求解。这是凸分析中的一个标准练习，与统计信号处理中优化问题的对偶方法研究直接相关。因此，该问题被认为是有效的，下面给出完整解法。\n\n主要任务是推导函数 $f(u)$ 的凸共轭 $f^{*}(y)$，其中 $f(u)$ 定义为：\n$$\nf(u) \\;=\\; \\sum_{i=1}^{m} \\Big( u_i \\;-\\; b_i \\ln u_i \\Big)\n$$\n$f$ 的有效域是 $\\text{dom}(f) = \\{ u \\in \\mathbb{R}^{m} \\mid u_i  0, \\forall i \\}$，因为如果任何分量 $u_i \\le 0$，则 $f(u) = +\\infty$。数据向量 $b$ 的分量满足 $b_i \\ge 0$。\n\n凸共轭 $f^{*}(y)$ 由上确界定义：\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\mathbb{R}^{m}} \\big\\{ \\langle y, u \\rangle \\;-\\; f(u) \\big\\}\n$$\n代入 $f(u)$ 的表达式和内积 $\\langle y, u \\rangle = \\sum_{i=1}^{m} y_i u_i$：\n$$\nf^{*}(y) \\;=\\; \\sup_{u \\in \\text{dom}(f)} \\left\\{ \\sum_{i=1}^{m} y_i u_i \\;-\\; \\sum_{i=1}^{m} (u_i - b_i \\ln u_i) \\right\\}\n$$\n上确界内的目标函数关于分量 $u_i$ 是可分的。这允许我们交换上确界和求和的顺序：\n$$\nf^{*}(y) \\;=\\; \\sum_{i=1}^{m} \\sup_{u_i  0} \\left\\{ y_i u_i - (u_i - b_i \\ln u_i) \\right\\} \\;=\\; \\sum_{i=1}^{m} \\sup_{u_i  0} \\left\\{ (y_i - 1) u_i + b_i \\ln u_i \\right\\}\n$$\n令 $f_i^*(y_i)$ 表示此和中的第 $i$ 项。我们通过求 $g_i(u_i) = (y_i - 1) u_i + b_i \\ln u_i$ 在定义域 $u_i  0$ 上的上确界来分析每个 $f_i^*(y_i)$。我们根据 $b_i$ 的值分两种情况讨论。\n\n情况1：$b_i  0$。\n为了找到上确界，我们使用一阶最优性条件。$g_i(u_i)$ 关于 $u_i$ 的导数是：\n$$\n\\frac{d g_i}{d u_i} \\;=\\; y_i - 1 + \\frac{b_i}{u_i}\n$$\n令导数为零以寻找临界点：\n$$\ny_i - 1 + \\frac{b_i}{u_i} \\;=\\; 0 \\quad \\implies \\quad \\frac{b_i}{u_i} \\;=\\; 1 - y_i\n$$\n如果 $1 - y_i \\le 0$（即 $y_i \\ge 1$），则对于所有 $u_i  0$，导数 $\\frac{d g_i}{d u_i}$ 是非负的（如果 $y_i  1$ 或 $y_i=1, b_i0$，则严格为正）。这意味着 $g_i(u_i)$ 是单调递增的，因此它在 $u_i  0$ 上的上确界是无界的：$\\sup_{u_i0} g_i(u_i) = +\\infty$。\n\n如果 $1 - y_i  0$（即 $y_i  1$），则在以下位置存在一个唯一的临界点：\n$$\nu_i^* \\;=\\; \\frac{b_i}{1 - y_i}\n$$\n由于 $b_i  0$ 和 $1 - y_i  0$，我们有 $u_i^*  0$，所以这个临界点在定义域内。二阶导数为 $\\frac{d^2 g_i}{d u_i^2} = -\\frac{b_i}{u_i^2}$，由于 $b_i  0$，该值严格为负。因此，$g_i(u_i)$ 是一个严格凹函数，而 $u_i^*$ 是其唯一的全局最大值点。上确界的值为 $g_i(u_i^*)$：\n\\begin{align*}\nf_i^*(y_i) = (y_i - 1) u_i^* + b_i \\ln(u_i^*) \\\\\n= (y_i - 1) \\left(\\frac{b_i}{1 - y_i}\\right) + b_i \\ln\\left(\\frac{b_i}{1 - y_i}\\right) \\\\\n= -b_i + b_i (\\ln(b_i) - \\ln(1 - y_i)) \\\\\n= b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i)\n\\end{align*}\n这里，我们假设标准约定 $0 \\ln 0 = 0$，以防任何 $b_i$ 恰好是无穷小量。\n\n情况2：$b_i = 0$。\n在这种情况下，需要最大化的函数简化为 $g_i(u_i) = (y_i - 1) u_i$。上确界是在 $u_i  0$ 的范围内求得。\n如果 $y_i - 1  0$（即 $y_i  1$），$g_i(u_i)$ 是一个严格递增的线性函数，所以 $\\sup_{u_i0} g_i(u_i) = +\\infty$。如果 $y_i - 1 \\le 0$（即 $y_i \\le 1$），$g_i(u_i)$ 是非正且递减的（如果 $y_i=1$ 则为常数）。当 $u_i \\to 0^+$ 时达到上确界，得到 $\\sup_{u_i0} g_i(u_i) = 0$。\n这可以使用集合 $(-\\infty, 1]$ 的指示函数紧凑地写成：$f_i^*(y_i) = \\iota_{(-\\infty, 1]}(y_i)$。\n\n综合这些结果，总的共轭函数 $f^*(y) = \\sum_{i=1}^m f_i^*(y_i)$ 仅在每一项 $f_i^*(y_i)$ 都为有限值时才为有限值。这定义了 $f^*$ 的有效域：\n$\\text{dom}(f^*) = \\{ y \\in \\mathbb{R}^m \\mid (b_i  0 \\implies y_i  1) \\text{ and } (b_i = 0 \\implies y_i \\le 1) \\}$。\n\n在这个定义域上，$f^*(y)$ 的表达式是这些有限值的和：\n$$\nf^{*}(y) = \\sum_{i: b_i  0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right)\n$$\n为了得到一个对所有 $y \\in \\mathbb{R}^m$ 都有效的单一表达式，我们引入定义域约束。对数项自然地对 $b_i  0$ 的索引约束了 $y_i  1$（因为 $\\ln(z)$ 是为 $z0$ 定义的）。对于 $b_i=0$ 的索引，我们必须加上相应的指示函数。因此，完整的表达式是：\n$$\nf^{*}(y) = \\sum_{i: b_i  0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right) + \\sum_{i: b_i = 0} \\iota_{(-\\infty, 1]}(y_i)\n$$\n\n有效域 $\\text{dom}(f^*)$ 编码了对 $y$ 的分量级约束。在所有观测值 $b_i  0$ 的常见实际情况中，该域简化为 $\\{ y \\in \\mathbb{R}^m \\mid y_i  1, \\forall i \\}$，这正是 $y \\prec \\mathbf{1}$。它之所以成为一个“自然屏障”，是因为如果任何 $y_i$ 达到或超过 1，共轭定义中的上确界就变为无穷大。这是对偶性的一种体现：原始函数 $f(u)$ 中在 $u_i=0$ 处的屏障（来自 $\\ln u_i$）在对偶函数 $f^*(y)$ 中感生出一个在 $y_i=1$ 处的镜像屏障（表现为 $-\\ln(1-y_i)$）。\n\n为了将其与双共轭联系起来，我们使用以下事实：对于一个闭的、正常的凸函数 $f$，有 $f^{**}=f$。$f(u) = f^{**}(u) = \\sup_{y} \\{ \\langle u, y \\rangle - f^*(y) \\}$。使用变量替换 $s_i = \\ln(1-y_i)$，这意味着 $y_i = 1 - e^{s_i}$，优化问题可以重新参数化为对 $s \\in \\mathbb{R}^m$ 的优化。为简单起见，假设所有 $i$ 都有 $b_i  0$，将 $y_i$ 和我们得到的 $f^*(y)$ 表达式代入双共轭公式：\n\\begin{align*}\nf(u) = \\sup_{s \\in \\mathbb{R}^m} \\left\\{ \\sum_i u_i (1-e^{s_i}) - \\sum_i (b_i \\ln b_i - b_i - b_i s_i) \\right\\} \\\\\n= \\sum_i (u_i - b_i \\ln b_i + b_i) + \\sup_{s \\in \\mathbb{R}^m} \\left\\{ \\sum_i (b_i s_i - u_i e^{s_i}) \\right\\}\n\\end{align*}\n正如题目所要求，我们看到在对变换后的对偶变量 $s$ 的中间优化过程中，出现了 $b_i s_i$ 和 $u_i \\exp(s_i)$ 这两项。这种指数结构是指数族分布的特征，而泊松分布正属于指数族。这种对偶性揭示了对数似然与其对偶表示之间的深刻联系。逐项最大化内部的可分和，可以恢复出原始函数 $f(u) = \\sum_i (u_i - b_i \\ln u_i)$，这证实了我们推导出的共轭函数 $f^*(y)$ 的正确性。", "answer": "$$\\boxed{\\sum_{i: b_i  0} \\left( b_i \\ln(b_i) - b_i - b_i \\ln(1-y_i) \\right) + \\sum_{i: b_i = 0} \\iota_{(-\\infty, 1]}(y_i)}$$", "id": "3439398"}, {"introduction": "在共轭计算的基础上，本实践将处理现代信号处理中的一个基石问题：矩阵压缩感知。你将为一个旨在从少量线性测量中恢复低秩矩阵的问题推导其 Fenchel 对偶问题，这项任务在推荐系统、量子态层析成像等领域均有应用。本实践将对偶性概念扩展到矩阵空间，引入了核范数和算子范数之间的关键关系。[@problem_id:3439408]", "problem": "设 $\\mathbb{R}^{m \\times n}$ 装备有 Frobenius 内积 $\\langle X, Y \\rangle = \\operatorname{trace}(X^{\\top} Y)$ 和核范数 $\\|X\\|_{*}$（定义为 $X$ 的奇异值之和）。考虑线性测量算子 $\\mathcal{A} : \\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{p}$ 及其伴随算子 $\\mathcal{A}^{*} : \\mathbb{R}^{p} \\to \\mathbb{R}^{m \\times n}$，该伴随算子是关于 Frobenius 内积和标准欧几里得内积定义的。仅使用第一性原理和已验证的事实，从凸共轭和 Fenchel 对偶的定义出发，计算 $f(X) = \\|X\\|_{*}$ 的凸共轭 $f^{*}(Y)$，然后推导矩阵压缩感知问题\n$$\n\\min_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*} \\quad \\text{约束条件} \\quad \\mathcal{A}(X) = b .\n$$\n的 Fenchel 对偶。你的推导过程必须依赖于核心定义（凸共轭、伴随算子、次微分）和已验证的事实（例如奇异值分解 (SVD) 的性质和迹不等式），并且必须在科学上保持真实和自洽。请使用 $\\mathrm{pmatrix}$ 环境，将最终答案表示为包含两个闭式解析表达式的行矩阵，其中第一个元素是 $f^{*}(Y)$ 的表达式，第二个元素是对偶规划的表达式（作为一个关于 $y \\in \\mathbb{R}^{p}$ 带有显式约束的最大化问题）。不需要数值近似。不涉及物理单位。", "solution": "用户要求计算核范数的凸共轭，并为矩阵压缩感知问题推导 Fenchel 对偶。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 向量空间为 $\\mathbb{R}^{m \\times n}$。\n- 内积为 Frobenius 内积：$\\langle X, Y \\rangle = \\operatorname{trace}(X^{\\top} Y)$。\n- 待分析的函数为 $f(X) = \\|X\\|_{*}$，其中 $\\|X\\|_{*}$ 是核范数，定义为 $X$ 的奇异值之和。\n- 给定一个线性算子 $\\mathcal{A} : \\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{p}$。\n- 其伴随算子为 $\\mathcal{A}^{*} : \\mathbb{R}^{p} \\to \\mathbb{R}^{m \\times n}$，关于 Frobenius 内积和标准欧几里得内积定义，使得对于所有 $X \\in \\mathbb{R}^{m \\times n}$ 和 $y \\in \\mathbb{R}^p$，都有 $\\langle \\mathcal{A}(X), y \\rangle_{\\mathbb{R}^p} = \\langle X, \\mathcal{A}^{*}(y) \\rangle_{\\mathbb{R}^{m \\times n}}$。\n- 原始优化问题为：$\\min_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*}$，约束条件为 $\\mathcal{A}(X) = b$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题坚实地植根于凸分析和优化这一数学领域，特别是其在压缩感知中的应用。核范数、凸共轭、Fenchel 对偶和伴随算子等概念都是标准且定义明确的。\n- **良置性：** 问题要求根据给定的条件推导两个特定的数学表达式。已知这些表达式存在且唯一。\n- **客观性：** 问题陈述是精确、定量的，并且没有任何主观或基于观点的语言。\n- **自洽性与一致性：** 提供了所有必要的定义和上下文。没有内部矛盾。\n\n该问题没有表现出验证标准中列出的任何缺陷。它是优化理论中一个标准的、非平凡的问题。\n\n**第三步：结论与行动**\n问题有效。将继续求解过程。\n\n### 第一部分：核范数的凸共轭\n\n函数为 $f(X) = \\|X\\|_{*}$。其凸共轭（记为 $f^{*}(Y)$）根据给定的 Frobenius 内积定义为：\n$$\nf^{*}(Y) = \\sup_{X \\in \\mathbb{R}^{m \\times n}} \\{ \\langle Y, X \\rangle - f(X) \\} = \\sup_{X \\in \\mathbb{R}^{m \\times n}} \\{ \\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\}\n$$\n为了计算这个上确界，我们使用 von Neumann 迹不等式。该不等式指出，对于任意两个矩阵 $A, B \\in \\mathbb{R}^{m \\times n}$，有 $\\operatorname{trace}(A^{\\top} B) \\leq \\sum_{i=1}^{\\min(m,n)} \\sigma_i(A) \\sigma_i(B)$，其中 $\\sigma_i(\\cdot)$ 表示按非递增顺序排列的第 $i$ 个奇异值。等号成立的充要条件是 $A$ 和 $B$ 具有同步奇异值分解，即对于某对正交矩阵 $U$ 和 $V$，有 $A = U \\Sigma_A V^{\\top}$ 和 $B = U \\Sigma_B V^{\\top}$。\n\n将此不等式应用于我们的表达式，得到：\n$$\n\\operatorname{trace}(Y^{\\top} X) \\leq \\sum_{i} \\sigma_i(Y) \\sigma_i(X)\n$$\n核范数为 $\\|X\\|_{*} = \\sum_i \\sigma_i(X)$。将这些代入共轭函数的定义中，得到：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\leq \\sum_{i} \\sigma_i(Y) \\sigma_i(X) - \\sum_{i} \\sigma_i(X) = \\sum_{i} (\\sigma_i(Y) - 1) \\sigma_i(X)\n$$\n我们根据 $Y$ 的奇异值来分析这个上确界的值。令 $\\|Y\\|_{op} = \\sigma_1(Y)$ 为 $Y$ 的算子范数（或谱范数），即其最大的奇异值。\n\n情况 1：$\\|Y\\|_{op}  1$。\n这意味着 $\\sigma_1(Y)  1$。设 $Y$ 的奇异值分解为 $Y = U \\Sigma_Y V^{\\top}$，其中 $u_1$ 和 $v_1$ 是对应于 $\\sigma_1(Y)$ 的第一个左、右奇异向量。我们可以构造一个矩阵 $X = \\alpha u_1 v_1^{\\top}$，其中标量 $\\alpha  0$。矩阵 $X$ 只有一个非零奇异值，即 $\\alpha$。因此，$\\|X\\|_{*} = \\alpha$。内积为：\n$$\n\\operatorname{trace}(Y^{\\top} X) = \\operatorname{trace}((U \\Sigma_Y V^{\\top})^{\\top} (\\alpha u_1 v_1^{\\top})) = \\alpha \\operatorname{trace}(V \\Sigma_Y^{\\top} U^{\\top} u_1 v_1^{\\top})\n$$\n由于 $U^{\\top} u_1 = e_1$（第一个标准基向量）且 $v_1^{\\top}V = e_1^{\\top}$，我们有：\n$$\n\\operatorname{trace}(Y^{\\top} X) = \\alpha \\operatorname{trace}(V \\Sigma_Y^{\\top} e_1 e_1^{\\top} V^{\\top}) = \\alpha \\operatorname{trace}(\\Sigma_Y^{\\top} e_1 e_1^{\\top}) = \\alpha \\sigma_1(Y)\n$$\n上确界的表达式变为：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} = \\alpha \\sigma_1(Y) - \\alpha = \\alpha (\\sigma_1(Y) - 1)\n$$\n由于 $\\sigma_1(Y) - 1  0$，我们可以通过让 $\\alpha \\to \\infty$ 使这个量任意大。因此，如果 $\\|Y\\|_{op}  1$，则上确界为 $+\\infty$。\n$$\nf^{*}(Y) = +\\infty \\quad \\text{如果 } \\|Y\\|_{op}  1\n$$\n\n情况 2：$\\|Y\\|_{op} \\leq 1$。\n这意味着对所有的 $i$ 都有 $\\sigma_i(Y) \\leq 1$。因此，对所有的 $i$ 都有 $\\sigma_i(Y) - 1 \\leq 0$。由于任何矩阵的奇异值都是非负的，即 $\\sigma_i(X) \\geq 0$，所以乘积是非正的：\n$$\n(\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0\n$$\n对所有的 $i$ 求和，我们得到 $\\sum_i (\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0$。这为我们的表达式提供了一个上界：\n$$\n\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} \\leq \\sum_{i} (\\sigma_i(Y) - 1) \\sigma_i(X) \\leq 0\n$$\n因此，上确界至多为 0。为了证明它恰好为 0，我们可以选择 $X=0$。对于 $X=0$，我们有 $\\|X\\|_{*} = 0$ 且 $\\operatorname{trace}(Y^{\\top} 0) = 0$，所以 $\\operatorname{trace}(Y^{\\top} X) - \\|X\\|_{*} = 0$。\n因此，上确界可以达到并且等于 0。\n$$\nf^{*}(Y) = 0 \\quad \\text{如果 } \\|Y\\|_{op} \\leq 1\n$$\n\n综合这两种情况，核范数的凸共轭是由算子范数定义的单位球的指示函数：\n$$\nf^{*}(Y) = \\iota_{\\{\\ Z \\in \\mathbb{R}^{m \\times n} \\,:\\, \\|Z\\|_{op} \\leq 1 \\ \\}}(Y) = \\begin{cases} 0  \\text{如果 } \\|Y\\|_{op} \\leq 1 \\\\ +\\infty  \\text{其他情况} \\end{cases}\n$$\n\n### 第二部分：矩阵压缩感知问题的 Fenchel 对偶\n\n原始问题由下式给出：\n$$\np^{*} = \\inf_{X \\in \\mathbb{R}^{m \\times n}} \\|X\\|_{*} \\quad \\text{约束条件} \\quad \\mathcal{A}(X) = b\n$$\n我们可以通过定义以下函数，将此问题重写为 Fenchel 对偶的标准形式 $\\inf_X \\{ F(X) + G(\\mathcal{A}(X)) \\}$：\n1. $F(X) = \\|X\\|_{*}$\n2. $G(z) = \\iota_{\\{b\\}}(z)$，这是单点集 $\\{b\\} \\subset \\mathbb{R}^p$ 的指示函数。如果 $z=b$，则 $G(z) = 0$；如果 $z \\neq b$，则 $G(z) = +\\infty$。\n\n原始问题则等价于 $\\inf_{X \\in \\mathbb{R}^{m \\times n}} \\{ F(X) + G(\\mathcal{A}(X)) \\}$。\nFenchel 对偶问题由下式给出：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ -F^{*}(\\mathcal{A}^{*}(y)) - G^{*}(-y) \\}\n$$\n我们需要计算凸共轭 $F^*$ 和 $G^*$。\n从第一部分，我们已知 $F(X) = \\|X\\|_{*}$ 的共轭函数为：\n$$\nF^{*}(Y) = \\iota_{\\{\\ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\ \\}}(Y)\n$$\n将其应用于变量 $\\mathcal{A}^{*}(y)$，我们得到：\n$$\nF^{*}(\\mathcal{A}^{*}(y)) = \\iota_{\\{\\ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\ \\}}(\\mathcal{A}^{*}(y))\n$$\n如果 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$，此项为 0；否则为 $+\\infty$。\n\n接下来，我们计算 $G(z) = \\iota_{\\{b\\}}(z)$ 的共轭。$\\mathbb{R}^p$ 中的内积是标准点积 $\\langle v, z \\rangle = v^{\\top}z$。\n$$\nG^{*}(v) = \\sup_{z \\in \\mathbb{R}^{p}} \\{ v^{\\top}z - G(z) \\} = \\sup_{z \\in \\mathbb{R}^{p}} \\{ v^{\\top}z - \\iota_{\\{b\\}}(z) \\}\n$$\n$G(z)$ 的定义域是单点 $z=b$，因此上确界在该点取到：\n$$\nG^{*}(v) = v^{\\top}b\n$$\n对于对偶公式，我们需要 $G^{*}(-y)$：\n$$\nG^{*}(-y) = (-y)^{\\top}b = -y^{\\top}b = -b^{\\top}y\n$$\n将 $F^{*}$ 和 $G^{*}$ 代入对偶问题的表达式中：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ -F^{*}(\\mathcal{A}^{*}(y)) - (-b^{\\top}y) \\} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y - \\iota_{\\{\\ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\ \\}}(\\mathcal{A}^{*}(y)) \\}\n$$\n项 $\\iota_{\\{\\ Z \\,:\\, \\|Z\\|_{op} \\leq 1 \\ \\}}(\\mathcal{A}^{*}(y))$ 在 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$ 时为 0，否则为 $+\\infty$。为了最大化该表达式，我们必须避免指示函数为 $+\\infty$ 的情况，因为这会使目标函数变为 $-\\infty$。因此，最大化问题被隐式地限制在指示函数为有限值（即等于 0）的定义域上。这给了我们约束条件 $\\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1$。\n在这个可行集内，问题简化为：\n$$\nd^{*} = \\sup_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y - 0 \\} \\quad \\text{约束条件} \\quad \\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1\n$$\n因此，Fenchel 对偶问题是：\n$$\n\\max_{y \\in \\mathbb{R}^{p}} b^{\\top}y \\quad \\text{约束条件} \\quad \\|\\mathcal{A}^{*}(y)\\|_{op} \\leq 1\n$$\n\n最终答案需要 $f^*(Y)$ 的表达式和对偶规划。将它们以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\iota_{\\{ Y \\in \\mathbb{R}^{m \\times n} : \\|Y\\|_{op} \\leq 1 \\}}(Y)  \\max_{y \\in \\mathbb{R}^{p}} \\{ b^{\\top}y \\mid \\| \\mathcal{A}^{*}(y) \\|_{op} \\leq 1 \\}\n\\end{pmatrix}\n}\n$$", "id": "3439408"}, {"introduction": "我们的最后一个实践展示了 Fenchel 对偶在理论分析之外的深刻实用价值，揭示了它如何为高效算法的设计提供信息。我们将分析全变分 Lasso 问题，并利用对偶性为对偶变量推导出一个“安全筛选”区域。这项强大的技术使我们能够在求解完整问题之前识别并剔除不活跃的变量，从而在处理大规模应用时显著提升计算速度。[@problem_id:3439416]", "problem": "考虑稀疏优化中的总变分套索 (Total Variation Lasso, TV-Lasso) 分析正则化最小二乘问题，该问题为一个感知矩阵 $A \\in \\mathbb{R}^{m \\times n}$、一个差分（分析）算子 $D \\in \\mathbb{R}^{p \\times n}$、一个数据向量 $b \\in \\mathbb{R}^{m}$ 和一个正则化参数 $\\lambda  0$ 定义：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|D x\\|_{1}.\n$$\n令 $f(y) := \\frac{1}{2} \\|y - b\\|_{2}^{2}$（对于 $y \\in \\mathbb{R}^{m}$）和 $h(w) := \\lambda \\|w\\|_{1}$（对于 $w \\in \\mathbb{R}^{p}$）。仅使用凸共轭和 Fenchel 对偶的基本定义，执行以下步骤：\n\n1. 从第一性原理（即根据凸共轭的定义）计算凸共轭 $f^{*}$ 和 $h^{*}$，并用它们推导出 TV-Lasso 的 Fenchel 对偶，其形式为关于对偶变量 $u \\in \\mathbb{R}^{m}$ 和 $z \\in \\mathbb{R}^{p}$ 的最大化问题，带有一个显式的线性耦合约束。以关于 $z$ 的不等式约束和 $u$ 与 $z$ 之间的线性关系明确陈述对偶可行集。将 $z$ 解释为与分析算子相关的对偶流。\n\n2. 令 $x_{t} \\in \\mathbb{R}^{n}$ 为任意原始候选解，并令 $(u_{t}, z_{t})$ 为任意对偶可行对。定义原始-对偶间隙\n$$\nG_{t} := f(A x_{t}) + h(D x_{t}) + f^{*}(u_{t}) + h^{*}(z_{t}),\n$$\n并回想 $h^{*}$ 是对偶范数球的指示函数。仅使用 $f^{*}$ 的强凸性和基本不等式，推导出一个在对偶变量 $u$ 中的欧几里得球，该球保证包含对偶最优解 $u^{\\star}$。你的推导必须从强凸性的定义和 Fenchel-Young 不等式开始，并且不假设任何现成的安全法则公式。\n\n3. 以完全简化的闭式形式，表示你仅能从 $G_{t}$ 和 $f^{*}$ 的性质证明的、以 $u_{t}$ 为中心的最小全局有效欧几里得球的半径 $\\rho_{t}$。你的最终答案必须是 $\\rho_{t}$ 的单个解析表达式。\n\n你的最终答案必须是单个闭式表达式。不需要数值计算，也不涉及单位。不要提供不等式或集合作为最终答案；仅提供闭式形式的半径。", "solution": "该问题要求对总变分套索 (TV-Lasso) 问题的 Fenchel 对偶进行三部分推导，最终得出一个包含对偶最优解的球的半径表达式。\n\n原始问题由下式给出：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|D x\\|_{1}\n$$\n我们定义 $f(y) := \\frac{1}{2} \\|y - b\\|_{2}^{2}$ 和 $h(w) := \\lambda \\|w\\|_{1}$。原始问题可以写成 $\\min_{x \\in \\mathbb{R}^{n}} f(Ax) + h(Dx)$。\n\n第 1 部分：Fenchel 对偶的推导\n\n首先，我们计算 $f(y)$ 的凸共轭 $f^*(u)$。根据定义，\n$$\nf^*(u) = \\sup_{y \\in \\mathbb{R}^{m}} \\{ \\langle u, y \\rangle - f(y) \\} = \\sup_{y \\in \\mathbb{R}^{m}} \\left\\{ \\langle u, y \\rangle - \\frac{1}{2} \\|y - b\\|_{2}^{2} \\right\\}\n$$\n上确界内的表达式是关于 $y$ 的严格凹二次函数。通过将其关于 $y$ 的梯度设为零，可以找到其唯一最大值：\n$$\n\\nabla_y \\left( \\langle u, y \\rangle - \\frac{1}{2} (y - b)^T(y - b) \\right) = u - (y - b) = 0\n$$\n这给出了最大化值 $y_{\\text{opt}} = u + b$。将其代回 $f^*(u)$ 的表达式中：\n$$\nf^*(u) = \\langle u, u + b \\rangle - \\frac{1}{2} \\|(u + b) - b\\|_{2}^{2} = \\|u\\|_{2}^{2} + \\langle u, b \\rangle - \\frac{1}{2} \\|u\\|_{2}^{2} = \\frac{1}{2} \\|u\\|_{2}^{2} + \\langle u, b \\rangle\n$$\n接下来，我们计算 $h(w)$ 的凸共轭 $h^*(z)$。根据定义，\n$$\nh^*(z) = \\sup_{w \\in \\mathbb{R}^{p}} \\{ \\langle z, w \\rangle - h(w) \\} = \\sup_{w \\in \\mathbb{R}^{p}} \\{ \\langle z, w \\rangle - \\lambda \\|w\\|_{1} \\}\n$$\n我们根据 $\\ell_1$-范数的对偶范数，即 $\\ell_\\infty$-范数 $\\|z\\|_{\\infty} = \\max_i |z_i|$，分两种情况进行分析。\n情况 1：$\\|z\\|_{\\infty}  \\lambda$。存在一个索引 $k$，使得 $|z_k|  \\lambda$。我们选择 $w = c \\cdot \\text{sgn}(z_k) e_k$，其中 $e_k$ 是第 $k$ 个标准基向量，且 $c  0$。那么 $\\langle z, w \\rangle = c |z_k|$ 且 $\\|w\\|_1 = c$。该表达式变为 $c |z_k| - \\lambda c = c(|z_k| - \\lambda)$。当 $c \\to \\infty$ 时，该表达式趋于 $\\infty$。因此，$h^*(z) = \\infty$。\n情况 2：$\\|z\\|_{\\infty} \\le \\lambda$。根据 Hölder 不等式，我们有 $\\langle z, w \\rangle \\le \\|z\\|_{\\infty} \\|w\\|_{1}$。因此，$\\langle z, w \\rangle - \\lambda \\|w\\|_{1} \\le \\|z\\|_{\\infty} \\|w\\|_{1} - \\lambda \\|w\\|_{1} = (\\|z\\|_{\\infty} - \\lambda) \\|w\\|_{1}$。由于 $\\|z\\|_{\\infty} \\le \\lambda$，该量为非正数。上确界值为 $0$，在 $w=0$ 时取得。\n综合这两种情况，$h^*(z)$ 是集合 $\\{z \\in \\mathbb{R}^p \\mid \\|z\\|_{\\infty} \\le \\lambda\\}$ 的指示函数：\n$$\nh^*(z) = \\iota_{\\{\\|z\\|_{\\infty} \\le \\lambda\\}}(z) = \\begin{cases} 0  \\text{if } \\|z\\|_{\\infty} \\le \\lambda \\\\ \\infty  \\text{otherwise} \\end{cases}\n$$\n为找到 Fenchel 对偶，我们引入辅助变量并构造拉格朗日函数。该问题等价于 $\\min_{x, y, w} \\{ f(y) + h(w) \\}$，约束条件为 $y=Ax$ 和 $w=Dx$。拉格朗日函数为：\n$$\n\\mathcal{L}(x, y, w, u, z) = f(y) + h(w) + \\langle u, Ax - y \\rangle + \\langle z, Dx - w \\rangle\n$$\n$$\n\\mathcal{L}(x, y, w, u, z) = \\langle x, A^T u + D^T z \\rangle + (f(y) - \\langle u, y \\rangle) + (h(w) - \\langle z, w \\rangle)\n$$\n对偶函数是 $g(u,z) = \\inf_{x,y,w} \\mathcal{L}$。关于 $y$ 的下确界是 $-f^*(u)$，关于 $w$ 的下确界是 $-h^*(z)$。关于 $x$ 的下确界在 $A^T u + D^T z = 0$ 时为 $0$，否则为 $-\\infty$。因此，为使对偶目标有限，我们必须有约束 $A^T u + D^T z = 0$。\n对偶问题是最大化对偶函数：\n$$\n\\max_{u, z} \\left\\{ -f^*(u) - h^*(z) \\right\\} \\quad \\text{subject to} \\quad A^T u + D^T z = 0\n$$\n代入推导出的共轭函数：\n$$\n\\max_{u \\in \\mathbb{R}^{m}, z \\in \\mathbb{R}^{p}} \\left\\{ -\\left(\\frac{1}{2}\\|u\\|_{2}^{2} + \\langle u, b \\rangle\\right) - \\iota_{\\{\\|z\\|_{\\infty} \\le \\lambda\\}}(z) \\right\\} \\quad \\text{subject to} \\quad A^T u + D^T z = 0\n$$\n指示函数可以写成一个显式约束。因此，对偶问题是：\n$$\n\\max_{u \\in \\mathbb{R}^{m}, z \\in \\mathbb{R}^{p}} \\quad -\\frac{1}{2}\\|u\\|_{2}^{2} - \\langle u, b \\rangle \\quad \\text{subject to} \\quad A^T u + D^T z = 0, \\quad \\|z\\|_{\\infty} \\le \\lambda\n$$\n对偶可行集是所有满足线性耦合约束 $A^T u + D^T z = 0$ 和不等式约束 $\\|z\\|_{\\infty} \\le \\lambda$ 的对 $(u,z) \\in \\mathbb{R}^m \\times \\mathbb{R}^p$ 的集合。变量 $z$ 是与分析项 $Dx$ 相关联的对偶变量，可以解释为对偶流。\n\n第 2 部分：对偶最优解的包围球的推导\n\n令 $P(x) = f(Ax) + h(Dx)$ 为原始目标函数。令 $\\mathcal{D}(u,z) = -f^*(u) - h^*(z)$ 为对偶目标函数。\n令 $(x^\\star, u^\\star, z^\\star)$ 为原始-对偶最优对。根据强对偶性，有 $P(x^\\star) = \\mathcal{D}(u^\\star,z^\\star)$。\n在原始候选解 $x_t$ 和对偶可行对 $(u_t, z_t)$ 处的原始-对偶间隙为：\n$$\nG_t = P(x_t) - \\mathcal{D}(u_t,z_t) = f(Ax_t) + h(Dx_t) - (-f^*(u_t) - h^*(z_t)) = f(Ax_t) + h(Dx_t) + f^*(u_t) + h^*(z_t)\n$$\n这与所提供的定义相符。由于 $(u_t, z_t)$ 是对偶可行的，所以 $h^*(z_t) = 0$，因此 $G_t = f(Ax_t) + h(Dx_t) + f^*(u_t)$。\n根据最优性的定义，$P(x_t) \\ge P(x^\\star)$。因此，间隙 $G_t$ 满足：\n$$\nG_t = P(x_t) - \\mathcal{D}(u_t,z_t) \\ge P(x^\\star) - \\mathcal{D}(u_t,z_t)\n$$\n使用强对偶性 $P(x^\\star) = \\mathcal{D}(u^\\star,z^\\star)$:\n$$\nG_t \\ge \\mathcal{D}(u^\\star,z^\\star) - \\mathcal{D}(u_t,z_t) = [-f^*(u^\\star) - h^*(z^\\star)] - [-f^*(u_t) - h^*(z_t)]\n$$\n由于 $(u_t, z_t)$ 和 $(u^\\star, z^\\star)$ 都是对偶可行的，所以 $h^*(z_t)=0$ 且 $h^*(z^\\star)=0$。不等式简化为：\n$$\nG_t \\ge f^*(u_t) - f^*(u^\\star)\n$$\n现在，我们使用 $f^*(u) = \\frac{1}{2}\\|u\\|_2^2 + \\langle u, b \\rangle$ 的性质。其 Hessian 矩阵为 $\\nabla^2 f^*(u) = I$，是正定的。因此，$f^*$ 是 1-强凸的。对于一个可微的 1-强凸函数，对任意 $u_t, u^\\star$ 我们有：\n$$\nf^*(u_t) \\ge f^*(u^\\star) + \\langle \\nabla f^*(u^\\star), u_t - u^\\star \\rangle + \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n对偶问题可以看作是在凸集 $\\mathcal{U} = \\{ u \\mid \\exists z \\text{ with } \\|z\\|_\\infty \\le \\lambda \\text{ and } A^T u + D^T z = 0 \\}$ 上最小化 $f^*(u)$。最小化子 $u^\\star$ 在凸集 $\\mathcal{U}$ 上的一阶最优性条件是，对于任何其他点 $u_t \\in \\mathcal{U}$：\n$$\n\\langle \\nabla f^*(u^\\star), u_t - u^\\star \\rangle \\ge 0\n$$\n由于强凸性不等式中的梯度项是非负的，我们可以去掉它以得到一个较弱的不等式：\n$$\nf^*(u_t) \\ge f^*(u^\\star) + \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n整理可得：\n$$\nf^*(u_t) - f^*(u^\\star) \\ge \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n结合我们的两个主要不等式，我们得到：\n$$\nG_t \\ge f^*(u_t) - f^*(u^\\star) \\ge \\frac{1}{2}\\|u_t - u^\\star\\|_2^2\n$$\n这就得到了最终的不等式：\n$$\n\\|u_t - u^\\star\\|_2^2 \\le 2 G_t \\quad \\implies \\quad \\|u_t - u^\\star\\|_2 \\le \\sqrt{2 G_t}\n$$\n这个结果表明，任何对偶最优解 $u^\\star$ 都必须位于以当前对偶迭代点 $u_t$ 为中心、半径为 $\\sqrt{2 G_t}$ 的欧几里得球内。\n\n第 3 部分：已证球体的半径\n\n根据第 2 部分的推导，仅基于间隙 $G_t$ 和 $f^*$ 的性质，可以保证包含对偶最优解 $u^\\star$、以 $u_t$ 为中心的最小欧几里得球的半径 $\\rho_t$ 由下式给出：\n$$\n\\rho_t = \\sqrt{2 G_t}\n$$\n该表达式为对偶解的位置提供了一个可计算的、全局有效的界。", "answer": "$$\n\\boxed{\\sqrt{2G_t}}\n$$", "id": "3439416"}]}