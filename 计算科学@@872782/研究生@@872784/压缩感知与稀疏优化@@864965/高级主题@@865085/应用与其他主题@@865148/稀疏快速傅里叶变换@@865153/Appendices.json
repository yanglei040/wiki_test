{"hands_on_practices": [{"introduction": "理解稀疏快速傅里叶变换的第一步，是牢固掌握频域稀疏性的确切含义。本练习将通过计算一个被明确构造为稀疏的信号的离散傅里叶变换（DFT），为您提供一个基础实践。通过完成此计算 [@problem_id:3477177]，您将直接验证稀疏频率系数集与最终DFT频谱之间的关系，从而巩固$k$-稀疏性的核心概念。", "problem": "考虑一个长度为 $n$ 的离散时间复信号 $x[t]$，其中 $t \\in \\{0,1,\\dots,n-1\\}$，其离散傅里叶变换 (DFT) 定义如下：\n$$\nX[\\ell] \\;=\\; \\sum_{t=0}^{n-1} x[t] \\,\\exp\\!\\left(-\\frac{2\\pi \\mathrm{i}}{n}\\,\\ell t\\right), \\quad \\ell \\in \\{0,1,\\dots,n-1\\}.\n$$\n设 $n=17$，并假设 $x[t]$ 是由支撑在已知索引集 $S=\\{3,5,11,14\\}\\subset\\{0,1,\\dots,16\\}$ 上的 $k=4$ 个复音叠加而成：\n$$\nx[t] \\;=\\; \\frac{1}{n}\\sum_{m\\in S} \\alpha_m \\,\\exp\\!\\left(\\frac{2\\pi \\mathrm{i}}{n}\\, m t\\right),\n$$\n其振幅为\n$$\n\\alpha_{3}=2,\\quad \\alpha_{5}=-1+\\mathrm{i},\\quad \\alpha_{11}=\\frac{3}{2}\\,\\exp\\!\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right),\\quad \\alpha_{14}=-\\mathrm{i}\\sqrt{2}.\n$$\n从 DFT 的核心定义和性质出发，对所有 $\\ell\\in\\{0,1,\\dots,16\\}$ 精确计算 $X[\\ell]$，并将结果表示为单行矩阵 $\\big(X[0]\\;X[1]\\;\\dots\\;X[16]\\big)$。作为与稀疏快速傅里叶变换 (SFFT) 相关的 $k$-稀疏性的验证，通过你计算出的 $X[\\ell]$ 值隐式地确定非零支撑集及其振幅。\n\n无需取整。请使用 $\\mathrm{pmatrix}$ 环境将最终答案表示为精确解析值的单行矩阵。", "solution": "该问题要求计算长度为 $n=17$ 的离散时间信号 $x[t]$ 的离散傅里叶变换 (DFT)。\n\n信号 $x[t]$ 的 DFT 定义为：\n$$\nX[\\ell] = \\sum_{t=0}^{n-1} x[t] \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right)\n$$\n其中频率索引 $\\ell \\in \\{0, 1, \\dots, n-1\\}$。\n\n信号 $x[t]$ 被给定为 $k=4$ 个复音的叠加，其频率对应于索引集 $S=\\{3, 5, 11, 14\\}$：\n$$\nx[t] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right)\n$$\n对于每个 $m \\in S$，复振幅 $\\alpha_m$ 都已给出。\n\n为了求出 $X[\\ell]$，我们将 $x[t]$ 的表达式代入 DFT 的定义中：\n$$\nX[\\ell] = \\sum_{t=0}^{n-1} \\left[ \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right) \\right] \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right)\n$$\n由于求和是有限的，我们可以交换它们的顺序。我们也可以将常数 $\\frac{1}{n}$ 和不依赖于求和索引 $t$ 的项 $\\alpha_m$ 提出：\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\left[ \\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right) \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right) \\right]\n$$\n合并内层求和中的指数项可得：\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\left[ \\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} (m - \\ell) t\\right) \\right]\n$$\n内层求和是与 DFT 的复指数基函数正交性相关的一个关键性质。设 $j = m - \\ell$。该和是一个等比级数 $\\sum_{t=0}^{n-1} \\left(\\exp\\left(\\frac{2\\pi \\mathrm{i} j}{n}\\right)\\right)^t$。我们分两种情况来分析这个和：\n\n情况 1：$m = \\ell$。\n在这种情况下，$j = m - \\ell = 0$。求和内的项变为 $\\exp(0) = 1$。和为：\n$$\n\\sum_{t=0}^{n-1} 1 = n\n$$\n\n情况 2：$m \\neq \\ell$。\n在这种情况下，$j = m - \\ell \\neq 0$。由于 $m, \\ell \\in \\{0, 1, \\dots, n-1\\}$，$m-\\ell$ 不是 $n$ 的非零倍数。设 $r = \\exp\\left(\\frac{2\\pi \\mathrm{i} (m - \\ell)}{n}\\right)$。我们有 $r \\neq 1$。等比级数的和为：\n$$\n\\sum_{t=0}^{n-1} r^t = \\frac{r^n - 1}{r - 1}\n$$\n项 $r^n$ 为：\n$$\nr^n = \\left(\\exp\\left(\\frac{2\\pi \\mathrm{i} (m - \\ell)}{n}\\right)\\right)^n = \\exp(2\\pi \\mathrm{i} (m - \\ell))\n$$\n由于 $m - \\ell$ 是一个整数，$\\exp(2\\pi \\mathrm{i} (m - \\ell)) = \\cos(2\\pi (m-\\ell)) + \\mathrm{i}\\sin(2\\pi (m-\\ell)) = 1$。\n因此，和为：\n$$\n\\frac{1 - 1}{r - 1} = 0\n$$\n\n结合这两种情况，我们可以使用克罗内克δ函数 $\\delta_{m,\\ell}$ 来表示内层和：\n$$\n\\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} (m - \\ell) t\\right) = n \\cdot \\delta_{m,\\ell}\n$$\n将此结果代回 $X[\\ell]$ 的表达式中：\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m (n \\cdot \\delta_{m,\\ell}) = \\sum_{m \\in S} \\alpha_m \\delta_{m,\\ell}\n$$\n这个和式根据频率索引 $\\ell$ 是否在支撑集 $S$ 中而简化。\n如果 $\\ell \\in S$，则和式中恰好有一个非零项，出现在 $m = \\ell$ 时。在这种情况下，$\\delta_{m,\\ell} = 1$，和式的值为 $\\alpha_\\ell$。\n如果 $\\ell \\notin S$，那么对于所有 $m \\in S$，我们有 $m \\neq \\ell$，这意味着对所有项都有 $\\delta_{m,\\ell} = 0$。因此，和为 $0$。\n\n因此，我们有如下直接关系：\n$$\nX[\\ell] = \\begin{cases} \\alpha_\\ell  \\text{if } \\ell \\in S \\\\ 0  \\text{if } \\ell \\notin S \\end{cases}\n$$\n这个结果表明，一个由一组稀疏系数通过逆DFT构建的信号，其DFT只是恢复了那些相同的系数。DFT谱 $X[\\ell]$ 的非零支撑集是集合 $S=\\{3, 5, 11, 14\\}$，并且在这些索引处的值是给定的振幅 $\\alpha_m$。\n\n对于 $n=17$，我们计算 $\\ell \\in \\{0, 1, \\dots, 16\\}$ 时的 $X[\\ell]$：\n- $X[0] = 0$\n- $X[1] = 0$\n- $X[2] = 0$\n- $X[3] = \\alpha_3 = 2$\n- $X[4] = 0$\n- $X[5] = \\alpha_5 = -1 + \\mathrm{i}$\n- $X[6] = 0$\n- $X[7] = 0$\n- $X[8] = 0$\n- $X[9] = 0$\n- $X[10] = 0$\n- $X[11] = \\alpha_{11} = \\frac{3}{2} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right)$\n- $X[12] = 0$\n- $X[13] = 0$\n- $X[14] = \\alpha_{14} = -\\mathrm{i}\\sqrt{2}$\n- $X[15] = 0$\n- $X[16] = 0$\n\n我们按要求将这些值表示为一个单行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 2 & 0 & -1+\\mathrm{i} & 0 & 0 & 0 & 0 & 0 & \\frac{3}{2}\\exp\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right) & 0 & 0 & -\\mathrm{i}\\sqrt{2} & 0 & 0 \\end{pmatrix}}\n$$", "id": "3477177"}, {"introduction": "高效的算法常常利用输入数据的已知属性。在信号处理中，许多真实世界的信号都是实值的，这给它们的傅里叶变换带来了特定的结构。这个问题 [@problem_id:3477223] 挑战您思考如何调整sFFT算法，利用这种共轭对称性来减少计算量并避免冗余处理，这是实用算法设计中的一项关键技能。", "problem": "考虑一个长度为 $N$ 的实值信号 $x[n] \\in \\mathbb{R}$（其中 $n \\in \\{0,1,\\dots,N-1\\}$ 且 $N$ 为偶数）及其离散傅里叶变换 (DFT) $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$（其中 $k \\in \\{0,1,\\dots,N-1\\}$）。假设 $X[k]$ 是 $K$-稀疏的，即其支撑集 $S = \\{ k : X[k] \\neq 0 \\}$ 的势为 $|S| = K \\ll N$。一种稀疏快速傅里叶变换 (sFFT) 算法使用哈希分桶和基于移位的解码：它选择一个与 $N$ 互质的整数 $a$ 来置换频率，将置换后的频率索引划分到 $B$ 个桶中，并形成测量值\n$$\nb_s[r] = \\sum_{k \\in S : h(k) = r} X[k] \\, e^{\\mathrm{i} 2 \\pi s k / N}, \\quad r \\in \\{0,1,\\dots,B-1\\},\n$$\n对于多个时间移位 $s \\in \\mathcal{S}$，其中 $h(k)$ 是一个依赖于 $a$ 和 $B$ 的分桶映射。在单元素桶假设下（即，对于一个桶 $r$，支撑集 $S$ 中恰好只有一个 $k^\\star$ 满足 $h(k^\\star) = r$），两个不同移位 $s_1, s_2 \\in \\mathcal{S}$ 之间的相位差通过以下关系式得出一个 $k^\\star$ 的估计值\n$$\n\\arg\\!\\left( \\frac{b_{s_2}[r]}{b_{s_1}[r]} \\right) \\approx \\frac{2 \\pi (s_2 - s_1) k^\\star}{N}.\n$$\n\n从 DFT 的定义、$x[n]$ 的实值特性以及 DFT 的时移特性出发，分析实信号 DFT 中的共轭对称性如何影响 sFFT 的搜索空间和解码阶段。具体来说，确定正确的策略，以将频率搜索空间减小一半，并调整解码过程以避免对对称频率的重复计数。\n\n哪个选项正确地描述了针对实值信号的搜索空间缩减和必要的解码调整？\n\nA. 将搜索限制在索引 $k \\in \\{0,1,\\dots,N/2\\}$；当一个非边缘索引 $k$（$1 \\le k \\le N/2 - 1$）被解码时，设置 $X[N - k] = \\overline{X[k]}$ 而不重新解码 $N - k$，并将 $X[0]$ 和 $X[N/2]$ 作为实值特例处理。基于相位的索引解码使用单边系数 $X[k]$；镜像系数通过共轭填充，从而防止重复计数。\n\nB. 将搜索限制在索引 $k \\in \\{1,2,\\dots,N-1\\}$，丢弃 $k=0$ 和 $k=N/2$ 因为它们不携带相位信息，并在所有桶中独立解码 $k$ 和 $N-k$，然后通过事后对其幅度进行平均来强制实现共轭对称性。\n\nC. 将搜索限制在索引 $k \\in \\{0,1,\\dots,N/2\\}$；当一个非边缘索引 $k$（$1 \\le k \\le N/2 - 1$）被解码时，将恢复的幅度均等分配，将 $X[k]$ 和 $X[N - k]$ 各自设为测量值的一半，因为它们的组合贡献解释了桶的测量值；设置 $X[0] = X[N/2] = 0$ 以避免歧义。\n\nD. 不缩减搜索空间；而是在解码过程中施加约束 $X[k] = X[N - k]$（例如，通过一个惩罚 $|X[k] - X[N - k]|$ 的最小绝对值收缩和选择算子 (LASSO) 惩罚项），并解码 $\\{0,1,\\dots,N-1\\}$ 中的所有索引，因为对称系数的相等性保证了信号是实值的，无需对 $k = 0$ 或 $k = N/2$ 进行特殊处理。", "solution": "用户希望我遵循一套严格的规则，解决一个关于稀疏快速傅里叶变换 (sFFT) 的问题。我必须首先验证问题陈述，如果有效，则提供详细的推导和选项评估。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **信号：** 一个长度为 $N$ 的实值信号 $x[n] \\in \\mathbb{R}$，其中 $n \\in \\{0, 1, \\dots, N-1\\}$。\n*   **信号长度：** $N$ 是一个偶数。\n*   **DFT 定义：** $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$，其中 $k \\in \\{0, 1, \\dots, N-1\\}$。\n*   **稀疏性：** DFT $X[k]$ 是 $K$-稀疏的，意味着其支撑集 $S = \\{ k : X[k] \\neq 0 \\}$ 的势为 $|S| = K \\ll N$。\n*   **sFFT 算法：** 该算法使用哈希分桶和基于移位的解码。\n    *   一个与 $N$ 互质的整数 $a$ 用于置换频率。\n    *   置换后的频率索引被划分到 $B$ 个桶中，使用分桶映射 $h(k)$。\n    *   测量值形成为 $b_s[r] = \\sum_{k \\in S : h(k) = r} X[k] \\, e^{\\mathrm{i} 2 \\pi s k / N}$，其中移位 $s \\in \\mathcal{S}$，桶 $r \\in \\{0, 1, \\dots, B-1\\}$。\n*   **解码假设：** 单元素桶假设成立，即对于给定的桶 $r$，支撑集 $S$ 中恰好只有一个频率索引 $k^\\star$ 满足 $h(k^\\star) = r$。\n*   **解码关系：** 频率索引 $k^\\star$ 是通过两个移位 $s_1$ 和 $s_2$ 的测量值之间的相位差来估计的：$\\arg\\!\\left( \\frac{b_{s_2}[r]}{b_{s_1}[r]} \\right) \\approx \\frac{2 \\pi (s_2 - s_1) k^\\star}{N}$。\n*   **问题：** 确定正确的策略，以便（1）将频率搜索空间减小一半，以及（2）调整解码以避免对对称频率进行重复计数，前提是输入信号 $x[n]$ 是实值的。\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学基础：** 该问题牢固地植根于数字信号处理（DSP）和压缩感知的原理中。离散傅里叶变换（DFT）、其对实信号的属性，以及稀疏快速傅里叶变换（sFFT）算法的高层描述都是标准且成熟的概念。单元素桶假设是解释此类算法核心机制时常用的简化。\n2.  **适定性：** 该问题是适定的。它要求在已知属性（实值输入信号）存在的情况下，对特定算法（sFFT）进行适当修改。这可以根据基本的DFT属性进行逻辑推导得出答案。\n3.  **客观性：** 问题陈述是客观的，使用了精确的数学和技术语言。没有主观或基于意见的元素。\n4.  **完整性与一致性：** 问题提供了所有必要的信息，以便推断信号的实值特性对sFFT过程的影响。所描述的元素内部是一致的。\n5.  **缺陷核对表：** 该问题没有违反任何指定的无效标准。它不是科学上不合理、不可形式化、不完整、不切实际、不适定、微不足道或无法验证的。\n\n**第3步：结论与行动**\n\n问题陈述是 **有效的**。现在开始解题过程。\n\n### 推导\n\n分析始于实值信号 DFT 的基本性质。\n\n令 $x[n]$ 为一个实值信号，即对于所有 $n$，$x[n] \\in \\mathbb{R}$。这意味着 $x[n] = \\overline{x[n]}$，其中上划线表示复共轭。DFT 定义为：\n$$X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$$\n让我们计算 $X[k]$ 的复共轭：\n$$\\overline{X[k]} = \\overline{\\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}} = \\sum_{n=0}^{N-1} \\overline{x[n]} \\overline{e^{-\\mathrm{i} 2 \\pi n k / N}}$$\n由于 $x[n]$ 是实数，$\\overline{x[n]} = x[n]$。指数项的共轭是 $\\overline{e^{-\\mathrm{i}\\theta}} = e^{\\mathrm{i}\\theta}$。因此：\n$$\\overline{X[k]} = \\sum_{n=0}^{N-1} x[n] e^{\\mathrm{i} 2 \\pi n k / N}$$\n现在，考虑索引为 $N-k$ 的 DFT 系数：\n$$X[N-k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n (N-k) / N} = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n} e^{\\mathrm{i} 2 \\pi n k / N}$$\n由于 $n$ 是整数，$e^{-\\mathrm{i} 2 \\pi n} = \\cos(2\\pi n) - \\mathrm{i}\\sin(2\\pi n) = 1$。因此：\n$$X[N-k] = \\sum_{n=0}^{N-1} x[n] e^{\\mathrm{i} 2 \\pi n k / N}$$\n比较 $\\overline{X[k]}$ 和 $X[N-k]$ 的表达式，我们建立了 **共轭对称性** 的性质：\n$$X[N-k] = \\overline{X[k]}$$\n这个关系对 $k \\in \\{0, 1, \\dots, N-1\\}$ 成立，并理解为索引是在模 $N$ 的意义下的。\n\n这种对称性对支撑集 $S$ 和 DFT 系数值有至关重要的影响：\n1.  如果对于一个“非边缘”索引 $k \\in \\{1, 2, \\dots, N/2 - 1\\}$ 有 $X[k] \\neq 0$，那么必然有 $X[N-k] = \\overline{X[k]} \\neq 0$。这意味着在这个范围内的非零频率分量总是以对称对 $(k, N-k)$ 的形式出现。\n2.  对于 $k > N/2$ 的系数值完全由 $k  N/2$ 的值确定。具体来说，对于 $j \\in \\{1, \\dots, N/2-1\\}$，$X[N/2+j] = \\overline{X[N/2-j]}$。\n3.  对于“边缘”索引：\n    *   对于 $k=0$（直流分量），对称性意味着 $X[0] = \\overline{X[0]}$，这表示 $X[0]$ 必须是一个实数。\n    *   对于 $k=N/2$（奈奎斯特分量，因为 $N$ 是偶数），对称性意味着 $X[N/2] = \\overline{X[N/2]}$，这表示 $X[N/2]$ 也必须是一个实数。\n\n这种结构允许在任何搜索非零 DFT 系数的算法中进行显著优化。\n\n### 在 sFFT 中的应用：\n\n1.  **搜索空间缩减：** 与其在整个频率范围 $\\{0, 1, \\dots, N-1\\}$ 中搜索 $K$ 个非零系数，我们可以将搜索限制在频谱的唯一一半，即索引 $k \\in \\{0, 1, \\dots, N/2\\}$。关于频谱的所有信息都包含在这些系数中。这将候选频率集合的大小减少了大约一半。\n\n2.  **解码调整：** 所述的 sFFT 算法从一个单元素桶 $r$ 中解码出一个索引 $k^\\star$。桶的测量值是 $b_s[r] = X[k^\\star] e^{\\mathrm{i} 2 \\pi s k^\\star / N}$。解码依赖于相位项 $e^{\\mathrm{i} 2 \\pi s k^\\star / N}$ 来找到 $k^\\star$。一旦找到 $k^\\star$，就可以估计出 $X[k^\\star]$ 的值（例如，从 $b_{s_1}[r] e^{-\\mathrm{i} 2 \\pi s_1 k^\\star / N}$）。\n    *   如果解码出的索引 $k^\\star$ 在范围 $\\{1, \\dots, N/2 - 1\\}$ 内，算法必须明确为其对称伙伴设置值：$X[N-k^\\star] = \\overline{X[k^\\star]}$。\n    *   算法必须被设计为不尝试单独解码 $N-k^\\star$。由于搜索空间被限制在 $\\{0, \\dots, N/2\\}$，这很自然地被避免了。如果一个 sFFT 实现要对整个范围的频率进行哈希，它就需要一种机制来识别：如果桶 $r_1$ 包含 $k^\\star$ 而桶 $r_2$ 包含 $N-k^\\star$，那么它们是一个依赖对，而不是两个独立的系数。最直接的策略是只对频谱的前半部分进行哈希和解码。\n    *   这可以防止“重复计数”，即算法错误地在前半部分识别出 $K$ 个系数，在后半部分又识别出另外 $K$ 个，导致一个错误的 $2K$-稀疏结果。\n    *   边缘情况 $k=0$ 和 $k=N/2$ 的解码方式与在受限范围 $\\{0, \\dots, N/2\\}$ 中的任何其他频率一样，只是附加了它们的系数值必须是实数的约束。\n\n因此，正确的策略是将搜索和解码限制在 $k \\in \\{0, 1, \\dots, N/2\\}$，并对找到的每个非边缘频率 $k$，通过共轭来填充其对称对应项 $N-k$。\n\n### 逐项分析\n\n**A. 将搜索限制在索引 $k \\in \\{0,1,\\dots,N/2\\}$；当一个非边缘索引 $k$（$1 \\le k \\le N/2 - 1$）被解码时，设置 $X[N - k] = \\overline{X[k]}$ 而不重新解码 $N - k$，并将 $X[0]$ 和 $X[N/2]$ 作为实值特例处理。基于相位的索引解码使用单边系数 $X[k]$；镜像系数通过共轭填充，从而防止重复计数。**\n该选项准确地描述了从第一性原理推导出的整个过程。它正确地指出了缩减的搜索空间、通过共轭处理非边缘对称对、避免重新解码（从而避免重复计数），以及在 $k=0$ 和 $k=N/2$ 处的实值系数的特殊性质。关于解码使用单边系数 $X[k]$ 的陈述与问题中提供的单元素桶假设是一致的。\n**结论：正确。**\n\n**B. 将搜索限制在索引 $k \\in \\{1,2,\\dots,N-1\\}$，丢弃 $k=0$ 和 $k=N/2$ 因为它们不携带相位信息，并在所有桶中独立解码 $k$ 和 $N-k$，然后通过事后对其幅度进行平均来强制实现共轭对称性。**\n该选项由于几个原因是不正确的。首先，丢弃 $X[0]$ 和 $X[N/2]$ 是不合理的；这些可能是信号中非零且重要的分量。其次，独立解码 $k$ 和 $N-k$ 在计算上是低效的，并且未能利用问题的已知结构。第三，“事后对其幅度进行平均”来强制实现共轭对称性在数学上是无意义的，共轭对称性是一个涉及幅度和相位的精确关系（$|X[k]|=|X[N-k]|$ 和 $\\arg(X[k]) = -\\arg(X[N-k])$），而不是一个平均过程。\n**结论：不正确。**\n\n**C. 将搜索限制在索引 $k \\in \\{0,1,\\dots,N/2\\}$；当一个非边缘索引 $k$（$1 \\le k \\le N/2 - 1$）被解码时，将恢复的幅度均等分配，将 $X[k]$ 和 $X[N - k]$ 各自设为测量值的一半，因为它们的组合贡献解释了桶的测量值；设置 $X[0] = X[N/2] = 0$ 以避免歧义。**\n该选项建立在错误的前提之上。单元素桶假设指出只有一个频率 $k^\\star$ 落入桶中，因此测量值不是 $X[k]$ 和 $X[N-k]$ 的“组合贡献”。平分幅度的想法是错误的。此外，将 $X[0]$ 和 $X[N/2]$ 设置为 $0$ 是一个无效的假设，会丢弃重要的信号信息。\n**结论：不正确。**\n\n**D. 不缩减搜索空间；而是在解码过程中施加约束 $X[k] = X[N - k]$（例如，通过一个惩罚 $|X[k] - X[N - k]|$ 的最小绝对值收缩和选择算子 (LASSO) 惩罚项），并解码 $\\{0,1,\\dots,N-1\\}$ 中的所有索引，因为对称系数的相等性保证了信号是实值的，无需对 $k = 0$ 或 $k = N/2$ 进行特殊处理。**\n该选项存在根本性缺陷。实信号的性质是共轭对称性 $X[N-k] = \\overline{X[k]}$，而不是相等性 $X[k] = X[N-k]$。强制相等是错误的。此外，不缩减搜索空间是低效的，并且违背了基于已知信号属性优化算法的原则。引入 LASSO 惩罚项描述的是另一类算法（基于凸优化的稀疏恢复），与所描述的基于分桶和相位解码的 sFFT 方法无关。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3477223"}, {"introduction": "任何现实世界算法的性能最终都会受到噪声的限制。为了信任sFFT的输出，我们必须理解噪声如何影响其估计的频率系数的准确性。这个高级练习 [@problem_id:3477176] 将指导您进行统计分析，推导出振幅估计量的方差，从而为算法在噪声环境下的可靠性提供一个定量的度量。", "problem": "考虑一个具有稀疏频谱的离散时间复信号，其中在一个给定的哈希桶中恰好存在一个非零傅里叶系数（一个单元素）。设信号长度为 $N$，时域样本为\n$$\nx[n] = c_j \\exp\\!\\big(\\mathrm{i} 2 \\pi j n / N\\big) + \\eta[n], \\quad n = 0, 1, \\dots, N-1,\n$$\n其中 $c_j \\in \\mathbb{C}$ 是频率索引 $j$ 处的未知振幅，$\\eta[n]$ 是独立同分布的复圆对称加性高斯白噪声（AWGN）样本，满足 $\\eta[n] \\sim \\mathcal{CN}(0,\\sigma^2)$。\n\n在对该单元素进行稀疏快速傅里叶变换（sFFT）测量时，会应用一个确定性窗 $w[n]$，并在解调索引 $j$ 处形成桶值，如下所示：\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\, x[n] \\, \\exp\\!\\big(-\\mathrm{i} 2 \\pi j n / N\\big).\n$$\n假设该窗在目标频率处产生的平坦通带增益等于\n$$\nG = \\sum_{n=0}^{N-1} w[n],\n$$\n因此，在没有噪声的情况下，该单元素对桶的贡献等于 $G \\, c_j$。通过将桶值除以通带增益来定义 $c_j$ 的估计量，\n$$\n\\widehat{c}_j = \\frac{Y}{G}.\n$$\n\n从离散傅里叶变换（DFT）的基本性质、线性和复圆对称高斯噪声的二阶统计特性出发，推导在上述 AWGN 模型下 $\\widehat{c}_j$ 的方差。将你的最终答案表示为关于 $\\sigma^2$、$G$ 和 $w[n]$ 的闭式解析表达式。不需要四舍五入，也不涉及单位。最终答案必须是单一的闭式表达式。", "solution": "目标是推导估计量 $\\widehat{c}_j$ 的方差，其定义为 $\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ |\\widehat{c}_j - \\mathbb{E}[\\widehat{c}_j]|^2 \\right]$，其中 $\\mathbb{E}[\\cdot]$ 表示期望算子。推导过程分几步进行，从估计量的定义开始，并利用噪声的统计特性。\n\n首先，我们用信号分量和噪声来表示估计量 $\\widehat{c}_j$。该估计量由下式给出：\n$$\n\\widehat{c}_j = \\frac{Y}{G}\n$$\n其中 Y 是桶值：\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\, x[n] \\, \\exp\\!\\big(-\\mathrm{i} 2 \\pi j n / N\\big)\n$$\n我们将信号模型 $x[n] = c_j \\exp(\\mathrm{i} 2 \\pi j n / N) + \\eta[n]$ 代入 $Y$ 的表达式中：\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\left( c_j \\exp(\\mathrm{i} 2 \\pi j n / N) + \\eta[n] \\right) \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n利用求和的线性性质，我们可以分离信号和噪声的贡献：\n$$\nY = \\sum_{n=0}^{N-1} w[n] c_j \\exp(\\mathrm{i} 2 \\pi j n / N) \\exp(-\\mathrm{i} 2 \\pi j n / N) + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n第一项中的复指数项相互抵消，因为 $\\exp(z)\\exp(-z) = \\exp(0) = 1$。常数 $c_j$ 可以从求和中提取出来：\n$$\nY = c_j \\sum_{n=0}^{N-1} w[n] + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n使用给定的通带增益定义 $G = \\sum_{n=0}^{N-1} w[n]$，我们得到：\n$$\nY = c_j G + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n现在，我们将这个 $Y$ 的表达式代回到估计量 $\\widehat{c}_j$ 的定义中：\n$$\n\\widehat{c}_j = \\frac{c_j G + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)}{G} = c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n该表达式表明，估计量 $\\widehat{c}_j$ 是真实值 $c_j$ 与一个依赖于噪声 $\\eta[n]$ 的随机误差项之和。\n\n接下来，我们计算 $\\widehat{c}_j$ 的期望值，以确定该估计量是否是无偏的。\n$$\n\\mathbb{E}[\\widehat{c}_j] = \\mathbb{E}\\left[c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\\right]\n$$\n根据期望的线性性质，并且由于 $c_j$、$G$ 和 $w[n]$ 是确定性的：\n$$\n\\mathbb{E}[\\widehat{c}_j] = c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\mathbb{E}[\\eta[n]] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\n噪声被给定为 $\\eta[n] \\sim \\mathcal{CN}(0, \\sigma^2)$，这意味着它具有零均值，即对所有 $n$ 都有 $\\mathbb{E}[\\eta[n]] = 0$。因此，该求和为零：\n$$\n\\mathbb{E}[\\widehat{c}_j] = c_j + 0 = c_j\n$$\n该估计量是无偏的。\n\n现在我们可以计算 $\\widehat{c}_j$ 的方差：\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ |\\widehat{c}_j - \\mathbb{E}[\\widehat{c}_j]|^2 \\right] = \\mathbb{E}\\left[ |\\widehat{c}_j - c_j|^2 \\right]\n$$\n估计误差为 $\\widehat{c}_j - c_j = \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)$。将其代入方差公式中：\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ \\left| \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N) \\right|^2 \\right]\n$$\n对复数 $z$ 使用性质 $|z|^2 = z z^*$，并令 $z$ 为误差项：\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ \\left(\\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] e^{-\\mathrm{i} 2 \\pi j n / N}\\right) \\left(\\frac{1}{G^*} \\sum_{m=0}^{N-1} w[m]^* \\eta[m]^* e^{\\mathrm{i} 2 \\pi j m / N}\\right) \\right]\n$$\n其中 $G^*$ 和 $w[m]^*$ 表示复共轭。我们可以提出确定性项 $1/|G|^2$ 并合并求和：\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\mathbb{E}\\left[ \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* \\eta[n] \\eta[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} \\right]\n$$\n将期望算子移到求和内部：\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} \\mathbb{E}[\\eta[n] \\eta[m]^*]\n$$\n噪声样本 $\\eta[n]$ 是独立同分布的复圆对称噪声，方差为 $\\sigma^2$。这意味着它们的自相关函数由下式给出：\n$$\n\\mathbb{E}[\\eta[n] \\eta[m]^*] = \\sigma^2 \\delta_{nm}\n$$\n其中 $\\delta_{nm}$ 是克罗内克 δ 函数，当 $n=m$ 时等于 $1$，否则等于 $0$。将此代入方差表达式中：\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} (\\sigma^2 \\delta_{nm})\n$$\n克罗内克 δ 函数使得关于 $m$ 的内层求和得以简化，因为只有当 $m=n$ 时项才非零：\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{\\sigma^2}{|G|^2} \\sum_{n=0}^{N-1} w[n] w[n]^* e^{-\\mathrm{i} 2 \\pi j (n-n) / N}\n$$\n简化该表达式，注意到 $w[n]w[n]^* = |w[n]|^2$ 且 $e^0 = 1$：\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{\\sigma^2}{|G|^2} \\sum_{n=0}^{N-1} |w[n]|^2\n$$\n这就是估计量 $\\widehat{c}_j$ 的方差关于 $\\sigma^2$、$G$ 和 $w[n]$ 的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{\\sigma^2 \\sum_{n=0}^{N-1} |w[n]|^2}{|G|^2}}\n$$", "id": "3477176"}]}