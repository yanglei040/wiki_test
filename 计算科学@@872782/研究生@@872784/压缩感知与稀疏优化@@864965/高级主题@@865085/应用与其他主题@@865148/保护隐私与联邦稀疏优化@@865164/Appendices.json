{"hands_on_practices": [{"introduction": "在采用本地差分隐私的联邦学习中，服务器永远无法看到真实的客户端数据，只能看到其加噪版本。分析任何此类系统的第一步是理解聚合信号的统计特性。我们将探讨简单的平均如何能够无偏地恢复真实平均梯度的估计值，以及该估计的方差如何受到隐私噪声和参与客户端数量的影响。这项基础计算 [@problem_id:3468479] 是分析所有隐私保护联邦优化算法准确性和收敛性的基石。", "problem": "考虑一个在压缩感知和稀疏优化中的联邦稀疏优化设定，其中有 $m$ 个客户端。每个客户端 $i \\in \\{1,\\dots,m\\}$ 持有一个 $d$ 维梯度向量 $g_{i} \\in \\mathbb{R}^{d}$，该向量是 $k$-稀疏的，意味着它最多有 $k$ 个非零坐标，其中 $1 \\leq k \\leq d$。为确保本地隐私，每个客户端向服务器报告一个本地扰动梯度 $\\tilde{g}_{i} = g_{i} + \\eta_{i}$，其中 $\\eta_{i} \\in \\mathbb{R}^{d}$ 是一个加性噪声向量，在各客户端和各坐标上独立抽取，服从分布 $\\mathcal{N}(0, s^{2} I_{d})$（零均值高斯分布，协方差为 $s^{2} I_{d}$）。假设噪声尺度 $s  0$ 对服务器已知，并且是根据差分隐私（DP）规范选择的，但服务器无法访问真实的 $g_{i}$。\n\n服务器旨在根据接收到的扰动报告 $\\{\\tilde{g}_{i}\\}_{i=1}^{m}$ 估计真实的聚合平均梯度 $\\bar{g} = \\frac{1}{m} \\sum_{i=1}^{m} g_{i}$。从期望和方差的基本定义出发，并利用两个经过充分检验的性质：（i）期望是线性的，以及（ii）独立随机变量之和的方差等于它们方差之和，推导出一个仅用 $\\{\\tilde{g}_{i}\\}_{i=1}^{m}$ 表示的 $\\bar{g}$ 的无偏估计量，并计算该估计量的每坐标方差，将其表示为本地噪声尺度 $s$ 和客户端数量 $m$ 的闭式函数。\n\n将最终答案表示为闭式解析表达式。无需四舍五入。不涉及物理单位。如果提供多个最终表达式，请将它们一起呈现为单行矩阵。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   客户端数量：$m$\n-   客户端索引：$i \\in \\{1, \\dots, m\\}$\n-   客户端 $i$ 的真实梯度：$g_i \\in \\mathbb{R}^d$\n-   $g_i$ 的稀疏性：$k$-稀疏，最多 $k$ 个非零坐标，其中 $1 \\leq k \\leq d$\n-   客户端 $i$ 报告的扰动梯度：$\\tilde{g}_i = g_i + \\eta_i$\n-   客户端 $i$ 的噪声向量：$\\eta_i \\in \\mathbb{R}^d$\n-   噪声分布：$\\eta_i$ 在各客户端和各坐标上独立抽取，服从 $\\eta_i \\sim \\mathcal{N}(0, s^2 I_d)$，其中 $I_d$ 是 $d \\times d$ 单位矩阵。这意味着 $\\mathbb{E}[\\eta_i] = 0$，协方差矩阵为 $\\text{Cov}(\\eta_i) = s^2 I_d$。分量 $(\\eta_i)_j$ 对于 $j \\in \\{1, \\dots, d\\}$ 是独立同分布的 $\\mathcal{N}(0, s^2)$。\n-   噪声尺度：$s  0$\n-   服务器目标：估计真实的聚合平均梯度 $\\bar{g} = \\frac{1}{m} \\sum_{i=1}^{m} g_i$。\n-   任务1：仅使用 $\\{\\tilde{g}_i\\}_{i=1}^{m}$ 推导 $\\bar{g}$ 的一个无偏估计量。\n-   任务2：计算此估计量的每坐标方差，作为 $s$ 和 $m$ 的函数。\n-   推导约束：必须使用期望和方差的基本定义、期望的线性性质，以及独立随机变量之和的方差性质。\n\n### 步骤2：使用提取的已知条件进行验证\n问题具有科学依据，提法恰当，且客观。它描述了联邦学习中的一个典型场景，其中通过高斯机制实现本地差分隐私。变量、分布和目标都以数学精度进行了规定。问题不违反任何科学原理，不基于错误前提，并且不包含任何模糊或矛盾之处。提及 $k$-稀疏性为稀疏优化设定了特定背景，但所问的问题涉及噪声平均值的基本统计特性，这些特性可以独立于稀疏性属性进行推导。问题是自洽的，可以从所提供的信息和原理中推导出唯一的解。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 解的推导\n\n服务器接收到一组扰动梯度 $\\{\\tilde{g}_i\\}_{i=1}^{m}$。对于真实平均梯度 $\\bar{g} = \\frac{1}{m} \\sum_{i=1}^{m} g_i$，一个自然的估计量是这些接收到的扰动梯度的平均值。我们将此估计量定义为 $\\hat{g}$。\n\n**第1部分：无偏估计量的推导**\n\n设所提出的估计量为 $\\hat{g} = \\frac{1}{m} \\sum_{i=1}^{m} \\tilde{g}_i$。为验证此估计量是无偏的，我们必须证明其期望值 $\\mathbb{E}[\\hat{g}]$ 等于被估计的真实量 $\\bar{g}$。期望是针对噪声向量 $\\{\\eta_i\\}$ 的分布计算的。真实梯度 $\\{g_i\\}$被视为固定的、确定性的量。\n\n我们首先对 $\\hat{g}$ 的表达式应用期望的线性性质：\n$$\n\\mathbb{E}[\\hat{g}] = \\mathbb{E}\\left[ \\frac{1}{m} \\sum_{i=1}^{m} \\tilde{g}_i \\right] = \\frac{1}{m} \\sum_{i=1}^{m} \\mathbb{E}[\\tilde{g}_i]\n$$\n接着，我们计算单个扰动梯度 $\\tilde{g}_i = g_i + \\eta_i$ 的期望。再次使用期望的线性性质：\n$$\n\\mathbb{E}[\\tilde{g}_i] = \\mathbb{E}[g_i + \\eta_i] = \\mathbb{E}[g_i] + \\mathbb{E}[\\eta_i]\n$$\n项 $g_i$ 是一个确定性向量，所以其期望就是向量本身：$\\mathbb{E}[g_i] = g_i$。噪声向量 $\\eta_i$ 从零均值高斯分布 $\\mathcal{N}(0, s^2 I_d)$ 中抽取，所以其期望是零向量：$\\mathbb{E}[\\eta_i] = 0$。\n将这些代入 $\\mathbb{E}[\\tilde{g}_i]$ 的表达式中得到：\n$$\n\\mathbb{E}[\\tilde{g}_i] = g_i + 0 = g_i\n$$\n这表明每个单独的扰动梯度 $\\tilde{g}_i$ 是相应真实梯度 $g_i$ 的无偏估计量。\n\n现在，我们将此结果代回到 $\\mathbb{E}[\\hat{g}]$ 的表达式中：\n$$\n\\mathbb{E}[\\hat{g}] = \\frac{1}{m} \\sum_{i=1}^{m} g_i\n$$\n根据问题陈述中给出的定义，真实的聚合平均梯度为 $\\bar{g} = \\frac{1}{m} \\sum_{i=1}^{m} g_i$。因此，我们已经证明：\n$$\n\\mathbb{E}[\\hat{g}] = \\bar{g}\n$$\n这证实了估计量 $\\hat{g} = \\frac{1}{m} \\sum_{i=1}^{m} \\tilde{g}_i$ 是 $\\bar{g}$ 的一个无偏估计量。这是我们所要求答案的第一部分。\n\n**第2部分：每坐标方差的计算**\n\n我们被要求求出估计量 $\\hat{g}$ 的每坐标方差。这对应于计算 $\\text{Var}(\\hat{g}_j)$，对于任何坐标 $j \\in \\{1, \\dots, d\\}$，其中 $\\hat{g}_j$ 是向量 $\\hat{g}$ 的第 $j$ 个分量。\n\n估计量的第 $j$ 个分量是：\n$$\n\\hat{g}_j = \\left( \\frac{1}{m} \\sum_{i=1}^{m} \\tilde{g}_i \\right)_j = \\frac{1}{m} \\sum_{i=1}^{m} (\\tilde{g}_i)_j\n$$\n$\\hat{g}_j$ 的方差由下式给出：\n$$\n\\text{Var}(\\hat{g}_j) = \\text{Var}\\left( \\frac{1}{m} \\sum_{i=1}^{m} (\\tilde{g}_i)_j \\right)\n$$\n使用方差性质 $\\text{Var}(c X) = c^2 \\text{Var}(X)$（对于常数 $c$）：\n$$\n\\text{Var}(\\hat{g}_j) = \\left(\\frac{1}{m}\\right)^2 \\text{Var}\\left( \\sum_{i=1}^{m} (\\tilde{g}_i)_j \\right) = \\frac{1}{m^2} \\text{Var}\\left( \\sum_{i=1}^{m} (\\tilde{g}_i)_j \\right)\n$$\n求和中的随机变量是 $(\\tilde{g}_1)_j, (\\tilde{g}_2)_j, \\dots, (\\tilde{g}_m)_j$。噪声向量 $\\eta_i$ 在不同客户端 $i$ 之间是独立的。由于 $\\tilde{g}_i = g_i + \\eta_i$，$\\tilde{g}_i$ 的随机性完全来自 $\\eta_i$。因此，对于不同的客户端 $i$，随机变量 $\\tilde{g}_i$ 是独立的。这意味着它们的分量 $(\\tilde{g}_i)_j$ 在 $i$ 上也是独立的。\n\n根据独立随机变量之和的方差等于它们方差之和的性质：\n$$\n\\text{Var}\\left( \\sum_{i=1}^{m} (\\tilde{g}_i)_j \\right) = \\sum_{i=1}^{m} \\text{Var}\\left( (\\tilde{g}_i)_j \\right)\n$$\n现在我们必须计算单个分量的方差 $\\text{Var}((\\tilde{g}_i)_j)$。我们有 $(\\tilde{g}_i)_j = (g_i)_j + (\\eta_i)_j$。由于 $(g_i)_j$ 是一个常数，它对方差没有贡献（即 $\\text{Var}(X+c) = \\text{Var}(X)$）。\n$$\n\\text{Var}\\left( (\\tilde{g}_i)_j \\right) = \\text{Var}\\left( (g_i)_j + (\\eta_i)_j \\right) = \\text{Var}\\left( (\\eta_i)_j \\right)\n$$\n噪声向量 $\\eta_i$ 从 $\\mathcal{N}(0, s^2 I_d)$ 中抽取，意味着它的每个分量 $(\\eta_i)_j$ 是从一维高斯分布 $\\mathcal{N}(0, s^2)$ 中抽取的独立随机变量。根据定义，该分布的方差是 $s^2$。\n$$\n\\text{Var}\\left( (\\eta_i)_j \\right) = s^2\n$$\n这对任何客户端 $i$ 和任何坐标 $j$ 都成立。将此代回到方差之和中：\n$$\n\\sum_{i=1}^{m} \\text{Var}\\left( (\\tilde{g}_i)_j \\right) = \\sum_{i=1}^{m} s^2 = m s^2\n$$\n最后，将此结果代入我们关于 $\\text{Var}(\\hat{g}_j)$ 的表达式中：\n$$\n\\text{Var}(\\hat{g}_j) = \\frac{1}{m^2} (m s^2) = \\frac{s^2}{m}\n$$\n这是估计量 $\\hat{g}$ 的每坐标方差。如要求所述，它是噪声尺度 $s$ 和客户端数量 $m$ 的函数。\n\n最终答案包括无偏估计量的表达式及其每坐标方差。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{m} \\sum_{i=1}^{m} \\tilde{g}_{i}  \\frac{s^2}{m} \\end{pmatrix}}\n$$", "id": "3468479"}, {"introduction": "除了影响最终准确性，隐私噪声还会影响算法的动态行为，例如其停止准则。我们将研究一个场景，其中客户端向协调者报告带噪的对偶间隙，协调者据此决定何时终止优化过程。本练习要求您量化“过早终止”的概率——即由于噪声而停止算法，尽管真实的收敛准则尚未满足。通过分析这种风险 [@problem_id:3468480]，您将深入了解部署隐私算法时面临的实际操作挑战，以及设计鲁棒终止协议的必要性。", "problem": "考虑一个由 $m$ 个客户端协作求解的联邦凸稀疏优化问题（例如，一个 $\\ell_{1}$ 正则化的最小二乘目标）。在给定的迭代中，客户端 $i \\in \\{1,\\dots,m\\}$ 持有一个原始-对偶对，该对产生一个局部对偶间隙 $g_{i} \\geq 0$，其中对偶间隙是在当前原始-对偶对上评估的原始目标值与对偶目标值之差。一个中心协调器通过基于客户端报告的对偶间隙的停止法则来监控收敛。\n\n为了保护客户端数据，每个客户端使用拉普拉斯机制应用差分隐私（DP）。具体来说，每个客户端 $i$ 发布一个私有化间隙 $\\tilde{g}_{i} = g_{i} + Z_{i}$，其中 $Z_{i}$ 是独立同分布的拉普拉斯随机变量，均值为 $0$，尺度为 $b = \\Delta_{g} / \\epsilon$。在这里，$\\Delta_{g}  0$ 是一个已知的全局上界，表示对偶间隙相对于客户端单个数据记录变化的 $\\ell_{1}$-敏感度，而 $\\epsilon  0$ 是隐私预算。尺度为 $b = \\Delta_{g} / \\epsilon$ 的拉普拉斯机制保证了发布每个 $g_{i}$ 时的 $\\epsilon$-DP。\n\n协调器使用的停止法则是，当且仅当 $\\min_{1 \\leq i \\leq m} \\tilde{g}_{i} \\leq \\tau$ 时，在此次迭代中终止算法，其中 $\\tau  0$ 是一个固定的容差。假设真实状态是严格非收敛的，即对于所有 $i \\in \\{1,\\dots,m\\}$，都有 $g_{i}  \\tau$。\n\n从差分隐私的基本定义和拉普拉斯机制的分布出发，推导出一个闭式表达式，表示协调器在此次迭代中仅因 DP 噪声而过早终止的概率。您的最终表达式必须是仅含 $\\{g_{i}\\}_{i=1}^{m}$、$\\tau$、$\\epsilon$ 和 $\\Delta_{g}$ 的单个解析表达式。\n\n将您的最终答案表述为单个闭式解析表达式。不需要数值近似，也不涉及单位。", "solution": "首先验证问题陈述的科学性、自洽性和清晰度。\n\n### 步骤 1：提取已知条件\n-   客户端数量：$m \\in \\mathbb{Z}^{+}$。\n-   客户端 $i$ 的局部对偶间隙：$g_{i} \\geq 0$，对于 $i \\in \\{1, \\dots, m\\}$。\n-   私有化机制：来自拉普拉斯分布的加性噪声。\n-   客户端 $i$ 的私有化对偶间隙：$\\tilde{g}_{i} = g_{i} + Z_{i}$。\n-   噪声分布：$Z_{i}$ 是独立同分布 (i.i.d.) 的随机变量，服从 $Z_{i} \\sim \\text{Laplace}(0, b)$。\n-   拉普拉斯尺度参数：$b = \\Delta_{g} / \\epsilon$。\n-   敏感度：$\\Delta_{g}  0$。\n-   隐私预算：$\\epsilon  0$。\n-   终止条件（停止法则）：$\\min_{1 \\leq i \\leq m} \\tilde{g}_{i} \\leq \\tau$。\n-   终止容差：$\\tau  0$。\n-   关于真实状态的假设：对于所有 $i \\in \\{1, \\dots, m\\}$，有 $g_{i}  \\tau$。\n-   目标：推导过早终止概率 $P(\\min_{1 \\leq i \\leq m} \\tilde{g}_{i} \\leq \\tau)$ 的闭式表达式，用 $\\{g_{i}\\}_{i=1}^{m}$、$\\tau$、$\\epsilon$ 和 $\\Delta_{g}$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在隐私保护机器学习和凸优化的背景下是良定义的。\n-   **科学基础**：该问题使用了标准概念：优化中的对偶间隙、联邦学习结构以及用于实现 $\\epsilon$-差分隐私的拉普拉斯机制。这些都是已确立的主流课题。\n-   **良态问题**：所有变量、分布和条件都已明确定义，从而构成一个在概率论中唯一可解的问题。目标陈述清晰。\n-   **客观性**：语言正式且无歧义。问题不含主观论断。\n-   **完整性**：该问题提供了所有必要信息。条件 $g_{i}  \\tau$ 是关键性的，并已明确说明，确保了终止确实是“过早的”（即，若没有隐私噪声，则不会发生）。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 解题推导\n目标是计算过早终止的概率，即尽管真实对偶间隙均高于容差 $\\tau$，算法仍然停止的事件。设此事件为 $A$。终止的条件是 $\\min_{1 \\leq i \\leq m} \\tilde{g}_{i} \\leq \\tau$。因此，我们要计算 $P(A) = P(\\min_{1 \\leq i \\leq m} \\tilde{g}_{i} \\leq \\tau)$。\n\n计算其补事件 $A^c$ 的概率通常更简单，然后使用关系式 $P(A) = 1 - P(A^c)$。补事件 $A^c$ 是算法不终止，即 $\\min_{1 \\leq i \\leq m} \\tilde{g}_{i}  \\tau$。这等价于所有客户端 $i=1, \\dots, m$ 都有 $\\tilde{g}_{i}  \\tau$ 的条件。\n$$\nP(A^c) = P(\\tilde{g}_{1}  \\tau \\text{ and } \\tilde{g}_{2}  \\tau \\text{ and } \\dots \\text{ and } \\tilde{g}_{m}  \\tau)\n$$\n私有化间隙定义为 $\\tilde{g}_{i} = g_{i} + Z_{i}$。由于在给定迭代中，真实间隙 $g_{i}$ 是确定性值，而噪声项 $Z_{i}$ 是独立的随机变量，因此私有化间隙 $\\tilde{g}_{i}$ 也是独立的随机变量。\n由于这种独立性，联合概率是各个概率的乘积：\n$$\nP(A^c) = \\prod_{i=1}^{m} P(\\tilde{g}_{i}  \\tau)\n$$\n现在，我们必须求出单个客户端 $i$ 的概率 $P(\\tilde{g}_{i}  \\tau)$。\n$$\nP(\\tilde{g}_{i}  \\tau) = P(g_{i} + Z_{i}  \\tau) = P(Z_{i}  \\tau - g_{i})\n$$\n随机变量 $Z_{i}$ 服从均值为 $0$、尺度为 $b$ 的拉普拉斯分布，记为 $Z_{i} \\sim \\text{Laplace}(0, b)$。$Z_{i}$ 的概率密度函数 (PDF) 由下式给出：\n$$\nf_{Z_i}(z) = \\frac{1}{2b} \\exp\\left(-\\frac{|z|}{b}\\right)\n$$\n为了求得 $P(Z_{i}  \\tau - g_{i})$，我们可以使用累积分布函数 (CDF) $F_{Z_i}(x) = P(Z_{i} \\leq x)$。拉普拉斯分布的 CDF 为：\n$$\nF_{Z_i}(x) = \\int_{-\\infty}^{x} f_{Z_i}(z) dz = \\begin{cases} \\frac{1}{2} \\exp\\left(\\frac{x}{b}\\right)  \\text{若 } x  0 \\\\ 1 - \\frac{1}{2} \\exp\\left(-\\frac{x}{b}\\right)  \\text{若 } x \\geq 0 \\end{cases}\n$$\n我们需要的概率是 $P(Z_{i}  \\tau - g_{i}) = 1 - P(Z_{i} \\leq \\tau - g_{i}) = 1 - F_{Z_i}(\\tau - g_{i})$。\n\n根据问题陈述，我们假设对于所有 $i$ 都有 $g_{i}  \\tau$。这意味着 CDF 的参数 $\\tau - g_{i}$ 是负的。因此，我们必须使用 CDF 公式的第一种情况：\n$$\nP(Z_{i} \\leq \\tau - g_{i}) = F_{Z_i}(\\tau - g_{i}) = \\frac{1}{2} \\exp\\left(\\frac{\\tau - g_{i}}{b}\\right) \\quad (\\text{因为 } \\tau - g_{i}  0)\n$$\n将其代回，我们得到单个客户端的概率：\n$$\nP(\\tilde{g}_{i}  \\tau) = 1 - \\frac{1}{2} \\exp\\left(\\frac{\\tau - g_{i}}{b}\\right)\n$$\n现在，我们可以通过对所有 $m$ 个客户端求积来计算补事件 $A^c$ 的概率：\n$$\nP(A^c) = \\prod_{i=1}^{m} \\left(1 - \\frac{1}{2} \\exp\\left(\\frac{\\tau - g_{i}}{b}\\right)\\right)\n$$\n最后，过早终止的概率 $P(A)$ 是 $1 - P(A^c)$：\n$$\nP(A) = 1 - \\prod_{i=1}^{m} \\left(1 - \\frac{1}{2} \\exp\\left(\\frac{\\tau - g_{i}}{b}\\right)\\right)\n$$\n最后一步是代入尺度参数 $b = \\Delta_{g} / \\epsilon$ 的给定表达式。\n$$\n\\frac{\\tau - g_{i}}{b} = \\frac{\\tau - g_{i}}{\\Delta_{g} / \\epsilon} = \\frac{\\epsilon (\\tau - g_{i})}{\\Delta_{g}}\n$$\n这就得到了用指定参数表示的过早终止概率的最终闭式表达式：\n$$\nP(A) = 1 - \\prod_{i=1}^{m} \\left(1 - \\frac{1}{2} \\exp\\left(\\frac{\\epsilon(\\tau - g_{i})}{\\Delta_{g}}\\right)\\right)\n$$\n这个表达式捕捉了在所有真实间隙 $g_i$ 严格大于 $\\tau$ 的情况下，至少有一个客户端报告的私有化间隙 $\\tilde{g}_i$ 小于或等于容差 $\\tau$，从而触发终止的概率。", "answer": "$$\\boxed{1 - \\prod_{i=1}^{m} \\left(1 - \\frac{1}{2} \\exp\\left(\\frac{\\epsilon(\\tau - g_{i})}{\\Delta_{g}}\\right)\\right)}$$", "id": "3468480"}, {"introduction": "最终，为隐私而添加的噪声必须得到补偿，通常是通过收集更多数据或执行更多测量来实现。本练习将无导数优化、差分隐私和高维统计学的概念结合起来，以回答一个关键问题：隐私的总成本是多少？您将推导在给定的隐私预算下，为将稀疏信号恢复到期望精度所需的函数评估总数。这项综合分析 [@problem_id:3468453] 揭示了准确性、隐私、数据维度和样本复杂度之间的基本权衡，为“隐私的代价”提供了量化理解。", "problem": "考虑一个联邦、无导数的稀疏优化设定，其中有 $m$ 个客户端，环境维度为 $d$，以及一个未知的 $s$-稀疏最小化子 $x^{\\star} \\in \\mathbb{R}^{d}$。每个客户端 $i \\in \\{1,\\dots,m\\}$ 持有一个凸损失函数 $f_{i}(x)$，全局目标函数为 $f(x) = \\frac{1}{m} \\sum_{i=1}^{m} f_{i}(x)$。假设对于所有 $i$ 都存在一个二次全局结构 $f_{i}(x) = \\frac{1}{2} \\| x - x^{\\star} \\|_{2}^{2}$，因此 $x^{\\star}$ 是 $f$ 的唯一最小化子。您仅限于进行函数值查询，并在服务器端使用带有对称中心差分的随机坐标扰动：在测量轮次 $k \\in \\{1,\\dots,q\\}$ 中，服务器采样一个随机扰动向量 $v_{k} \\in \\{-1,1\\}^{d}$，其条目为独立同分布的 Rademacher 随机变量，并使用一个固定的半径 $u  0$。每个客户端计算两个私有函数值 $f_{i}(u v_{k})$ 和 $f_{i}(-u v_{k})$，通过高斯机制在 $(\\varepsilon,\\delta)$-差分隐私 (DP) 下发布它们，然后服务器安全地聚合它们的平均差值以形成一个标量测量。\n\n具体来说，假设每次查询的敏感度以 $\\Delta  0$ 为界，并且高斯机制为每个客户端的函数值添加独立噪声 $w \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{DP}}^{2})$，其中 $\\sigma_{\\mathrm{DP}} = \\frac{\\Delta \\sqrt{2 \\ln(1.25/\\delta)}}{\\varepsilon}$。在第 $k$ 轮，服务器构建平均中心差分\n$$\ny_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{\\big(f_{i}(u v_{k}) + w_{i,+}\\big) - \\big(f_{i}(-u v_{k}) + w_{i,-}\\big)}{2u},\n$$\n其中 $w_{i,+}, w_{i,-} \\overset{\\mathrm{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma_{\\mathrm{DP}}^{2})$。对于上述二次结构，这将导出一个线性噪声测量模型 $y_{k} = - \\langle v_{k}, x^{\\star} \\rangle + \\eta_{k}$，其中 $\\eta_{k} \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{eff}}^{2})$，且 $\\sigma_{\\mathrm{eff}}^{2}$ 取决于 $\\sigma_{\\mathrm{DP}}$、$u$ 和 $m$。\n\n经过 $q$ 轮这样的测量后，服务器构成一个矩阵 $A \\in \\mathbb{R}^{q \\times d}$（其行是 $v_{k}^{\\top}$）和一个测量向量 $y \\in \\mathbb{R}^{q}$。服务器使用 $(A,y)$ 通过标准的稀疏恢复方法（例如，基追踪降噪）来估计 $x^{\\star}$。您可以假定以下来自高维估计领域经过充分检验的事实：对于具有 Rademacher 行和加性高斯噪声的独立同分布亚高斯设计，存在一个通用常数 $C  0$，使得对于失败容忍度 $\\beta \\in (0,1)$，估计量以至少 $1 - \\beta$ 的概率满足以下形式的误差界\n$$\n\\| \\widehat{x} - x^{\\star} \\|_{2} \\le C \\, \\sigma_{\\mathrm{eff}} \\, \\sqrt{ \\frac{s \\ln\\!\\big(\\frac{d}{s}\\big) + \\ln\\!\\big(\\frac{1}{\\beta}\\big)}{q} }.\n$$\n\n请从第一性原理和给定机制出发，推导为保证估计精度 $\\| \\widehat{x} - x^{\\star} \\|_{2} \\le \\tau$（概率至少为 $1 - \\beta$）在所有客户端上所需的最小私有函数求值总数 $N_{\\mathrm{tot}}$，其中 $\\tau  0$ 是一个预设的容忍度。请将您的最终答案表示为关于 $s$、$d$、$\\varepsilon$、$\\delta$、$\\Delta$、$u$、$\\tau$、$\\beta$ 和通用常数 $C$ 的单个闭式解析表达式。注意，每个测量轮次精确使用 $2m$ 次私有函数求值（每个客户端两次）。最终答案必须是一个解析表达式；不允许使用不等式。无需单位。", "solution": "用户提供了一个问题，在尝试解决之前需要进行严格验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **联邦设置：** $m$ 个客户端，维度 $d$，稀疏度 $s$。\n- **目标函数：** 全局目标为 $f(x) = \\frac{1}{m} \\sum_{i=1}^{m} f_{i}(x)$，其中每个客户端的损失为 $f_{i}(x) = \\frac{1}{2} \\| x - x^{\\star} \\|_{2}^{2}$，对应一个未知的 $s$-稀疏最小化子 $x^{\\star} \\in \\mathbb{R}^{d}$。\n- **测量协议：** 对于每一轮 $k \\in \\{1,\\dots,q\\}$，采样一个随机向量 $v_{k} \\in \\{-1,1\\}^{d}$，其条目为独立同分布的 Rademacher 变量。使用固定半径 $u  0$，客户端计算 $f_{i}(u v_{k})$ 和 $f_{i}(-u v_{k})$。\n- **隐私机制：** 每次函数求值都通过高斯机制实现 $(\\varepsilon,\\delta)$-差分隐私。每次查询的敏感度为 $\\Delta  0$，添加的噪声为 $w \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{DP}}^{2})$，其中 $\\sigma_{\\mathrm{DP}} = \\frac{\\Delta \\sqrt{2 \\ln(1.25/\\delta)}}{\\varepsilon}$。\n- **服务器聚合：** 服务器构建测量值 $y_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{(f_{i}(u v_{k}) + w_{i,+}) - (f_{i}(-u v_{k}) + w_{i,-})}{2u}$，其中 $w_{i,+}, w_{i,-} \\overset{\\mathrm{i.i.d.}}{\\sim} \\mathcal{N}(0,\\sigma_{\\mathrm{DP}}^{2})$。\n- **线性模型：** 该过程导出一个带噪线性模型 $y_{k} = - \\langle v_{k}, x^{\\star} \\rangle + \\eta_{k}$，其中有效噪声为 $\\eta_{k} \\sim \\mathcal{N}(0,\\sigma_{\\mathrm{eff}}^{2})$。\n- **估计误差界：** 经过 $q$ 轮后，从测量矩阵 $A$（行为 $v_k^\\top$）和测量向量 $y$（条目为 $y_k$）获得的估计量 $\\widehat{x}$ 以至少 $1 - \\beta$ 的概率满足以下界限：\n$$ \\| \\widehat{x} - x^{\\star} \\|_{2} \\le C \\, \\sigma_{\\mathrm{eff}} \\, \\sqrt{ \\frac{s \\ln(d/s) + \\ln(1/\\beta)}{q} } $$\n对于某个通用常数 $C  0$。\n- **目标：** 推导为确保 $\\| \\widehat{x} - x^{\\star} \\|_{2} \\le \\tau$（概率至少为 $1 - \\beta$）所需的最小私有函数求值总数 $N_{\\mathrm{tot}}$。\n- **求值计数：** 每个测量轮次需要 $2m$ 次私有函数求值。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，属于联邦学习、差分隐私和高维统计等既定领域。其组成部分——二次损失、高斯机制、Rademacher 传感矩阵以及 LASSO/BPDN 类型的恢复保证——都是标准的理论工具。该问题是适定的（well-posed），要求从给定的参数和模型中推导出一个特定量 ($N_{\\mathrm{tot}}$)。语言客观且正式。核心任务是通过组合特定损失函数、中心差分方案、隐私机制和客户端平均化的影响来推导有效噪声方差 $\\sigma_{\\mathrm{eff}}^2$，然后将此方差用于所提供的误差界。该问题是自洽的且逻辑一致。\n\n**步骤 3：结论与行动**\n\n问题是**有效的**。可以根据所提供的信息进行严格的推导。\n\n### 解法\n\n目标是找到为达到估计误差 $\\| \\widehat{x} - x^{\\star} \\|_{2} \\le \\tau$（概率至少为 $1 - \\beta$）所需的最小私有函数求值总数 $N_{\\mathrm{tot}}$。\n\n总求值次数由测量轮数 $q$、客户端数量 $m$ 以及每轮每个客户端的求值次数（即 2）的乘积给出。\n$$N_{\\mathrm{tot}} = 2mq$$\n我们的首要任务是确定所需的轮数 $q$。这需要我们首先刻画有效噪声方差 $\\sigma_{\\mathrm{eff}}^{2}$。\n\n我们首先分析单次测量 $y_k$ 的结构。\n$$y_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{\\big(f_{i}(u v_{k}) + w_{i,+}\\big) - \\big(f_{i}(-u v_{k}) + w_{i,-}\\big)}{2u}$$\n我们可以将 $y_k$ 分解为信号分量和噪声分量。信号部分是无噪声的平均中心差分：\n$$\\bar{y}_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{f_{i}(u v_{k}) - f_{i}(-u v_{k})}{2u}$$\n代入给定的损失函数 $f_{i}(x) = \\frac{1}{2} \\| x - x^{\\star} \\|_{2}^{2}$：\n$$f_{i}(u v_{k}) - f_{i}(-u v_{k}) = \\frac{1}{2} \\| u v_{k} - x^{\\star} \\|_{2}^{2} - \\frac{1}{2} \\| -u v_{k} - x^{\\star} \\|_{2}^{2}$$\n展开平方范数：\n$$= \\frac{1}{2} \\left[ (u v_{k} - x^{\\star})^{\\top}(u v_{k} - x^{\\star}) - (u v_{k} + x^{\\star})^{\\top}(u v_{k} + x^{\\star}) \\right]$$\n$$= \\frac{1}{2} \\left[ (u^2 \\|v_{k}\\|_{2}^{2} - 2u \\langle v_{k}, x^{\\star} \\rangle + \\|x^{\\star}\\|_{2}^{2}) - (u^2 \\|v_{k}\\|_{2}^{2} + 2u \\langle v_{k}, x^{\\star} \\rangle + \\|x^{\\star}\\|_{2}^{2}) \\right]$$\n$$= \\frac{1}{2} \\left[ -4u \\langle v_{k}, x^{\\star} \\rangle \\right] = -2u \\langle v_{k}, x^{\\star} \\rangle$$\n由于这对每个客户端 $i$ 都成立，信号项 $\\bar{y}_k$ 变为：\n$$\\bar{y}_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{-2u \\langle v_{k}, x^{\\star} \\rangle}{2u} = \\frac{1}{m} \\sum_{i=1}^{m} (-\\langle v_{k}, x^{\\star} \\rangle) = -\\langle v_{k}, x^{\\star} \\rangle$$\n这证实了线性模型 $y_{k} = -\\langle v_{k}, x^{\\star} \\rangle + \\eta_{k}$ 的信号部分。\n\n噪声项 $\\eta_k$ 是 $y_k$ 中由注入的 DP 噪声产生的部分：\n$$\\eta_{k} = \\frac{1}{m} \\sum_{i=1}^{m} \\frac{w_{i,+} - w_{i,-}}{2u} = \\frac{1}{2um} \\sum_{i=1}^{m} (w_{i,+} - w_{i,-})$$\n鉴于 $w_{i,+}$ 和 $w_{i,-}$ 是从 $\\mathcal{N}(0, \\sigma_{\\mathrm{DP}}^{2})$ 中抽取的独立同分布样本，它们的差 $Z_i = w_{i,+} - w_{i,-}$ 是一个高斯随机变量，其均值为 $E[Z_i] = E[w_{i,+}] - E[w_{i,-}] = 0$，方差为 $\\mathrm{Var}(Z_i) = \\mathrm{Var}(w_{i,+}) + \\mathrm{Var}(w_{i,-}) = \\sigma_{\\mathrm{DP}}^{2} + \\sigma_{\\mathrm{DP}}^{2} = 2\\sigma_{\\mathrm{DP}}^{2}$。\n有效噪声 $\\eta_k$ 是 $m$ 个独立同分布随机变量 $Z_i$ 的缩放和。因此，$\\eta_k$ 也是高斯分布的，其均值为 $E[\\eta_k] = 0$，方差为 $\\sigma_{\\mathrm{eff}}^{2}$：\n$$\\sigma_{\\mathrm{eff}}^{2} = \\mathrm{Var}(\\eta_k) = \\mathrm{Var}\\left(\\frac{1}{2um} \\sum_{i=1}^{m} Z_i\\right) = \\frac{1}{(2um)^2} \\sum_{i=1}^{m} \\mathrm{Var}(Z_i)$$\n$$\\sigma_{\\mathrm{eff}}^{2} = \\frac{1}{4u^2m^2} \\sum_{i=1}^{m} (2\\sigma_{\\mathrm{DP}}^{2}) = \\frac{m \\cdot 2\\sigma_{\\mathrm{DP}}^{2}}{4u^2m^2} = \\frac{\\sigma_{\\mathrm{DP}}^{2}}{2u^2m}$$\n现在，我们根据 DP 参数代入 $\\sigma_{\\mathrm{DP}}^{2}$ 的表达式：\n$$\\sigma_{\\mathrm{DP}}^{2} = \\left(\\frac{\\Delta \\sqrt{2 \\ln(1.25/\\delta)}}{\\varepsilon}\\right)^2 = \\frac{2\\Delta^2 \\ln(1.25/\\delta)}{\\varepsilon^2}$$\n将此代入我们关于 $\\sigma_{\\mathrm{eff}}^{2}$ 的表达式中：\n$$\\sigma_{\\mathrm{eff}}^{2} = \\frac{1}{2u^2m} \\left( \\frac{2\\Delta^2 \\ln(1.25/\\delta)}{\\varepsilon^2} \\right) = \\frac{\\Delta^2 \\ln(1.25/\\delta)}{m u^2 \\varepsilon^2}$$\n在确定了有效噪声方差后，我们使用提供的误差界来找到最小轮数 $q$。我们将误差界设为等于期望的容忍度 $\\tau$：\n$$\\tau = C \\, \\sigma_{\\mathrm{eff}} \\, \\sqrt{ \\frac{s \\ln(d/s) + \\ln(1/\\beta)}{q} }$$\n两边平方并求解 $q$：\n$$\\tau^2 = C^2 \\, \\sigma_{\\mathrm{eff}}^2 \\, \\frac{s \\ln(d/s) + \\ln(1/\\beta)}{q}$$\n$$q = \\frac{C^2 \\sigma_{\\mathrm{eff}}^2}{\\tau^2} \\left[ s \\ln\\left(\\frac{d}{s}\\right) + \\ln\\left(\\frac{1}{\\beta}\\right) \\right]$$\n代入 $\\sigma_{\\mathrm{eff}}^{2}$ 的表达式：\n$$q = \\frac{C^2}{\\tau^2} \\left( \\frac{\\Delta^2 \\ln(1.25/\\delta)}{m u^2 \\varepsilon^2} \\right) \\left[ s \\ln\\left(\\frac{d}{s}\\right) + \\ln\\left(\\frac{1}{\\beta}\\right) \\right]$$\n此表达式给出了测量轮数。总求值次数为 $N_{\\mathrm{tot}} = 2mq$：\n$$N_{\\mathrm{tot}} = 2m \\left( \\frac{C^2 \\Delta^2 \\ln(1.25/\\delta) \\left[ s \\ln(d/s) + \\ln(1/\\beta) \\right]}{m u^2 \\varepsilon^2 \\tau^2} \\right)$$\n$m$ 因子被消掉，得到总求值成本的最终表达式：\n$$N_{\\mathrm{tot}} = \\frac{2 C^2 \\Delta^2 \\ln(1.25/\\delta) \\left[ s \\ln(d/s) + \\ln(1/\\beta) \\right]}{u^2 \\varepsilon^2 \\tau^2}$$\n为符合前述格式规则，写作：\n$$N_{\\mathrm{tot}} = \\frac{2 C^2 \\Delta^2 \\ln\\left(\\frac{1.25}{\\delta}\\right) \\left[ s \\ln\\left(\\frac{d}{s}\\right) + \\ln\\left(\\frac{1}{\\beta}\\right) \\right]}{u^2 \\varepsilon^2 \\tau^2}$$", "answer": "$$\\boxed{\\frac{2 C^2 \\Delta^2 \\ln\\left(\\frac{1.25}{\\delta}\\right) \\left( s \\ln\\left(\\frac{d}{s}\\right) + \\ln\\left(\\frac{1}{\\beta}\\right) \\right)}{u^2 \\varepsilon^2 \\tau^2}}$$", "id": "3468453"}]}