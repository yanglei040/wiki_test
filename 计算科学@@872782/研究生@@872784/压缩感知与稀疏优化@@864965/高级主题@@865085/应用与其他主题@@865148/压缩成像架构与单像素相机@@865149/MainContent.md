## 引言
压缩成像架构，特别是[单像素相机](@entry_id:754911)，代表了现代[计算成像](@entry_id:170703)领域的一场革命，它挑战了传统成像中“一个像素对应一个探测器”的固有模式。通过将复杂的硬件需求转移到计算层面，该技术为在资源受限或非可见光波段下实现高分辨率、高效率的成像开辟了新的可能性。然而，这种颠覆性方法的背后，是一套深刻的物理原理和数学理论。它如何打破[奈奎斯特采样定理](@entry_id:268107)的限制？我们如何能从看似不完整的信息中精确地重建出图像？这些是理解和应用该技术的关键问题。

本文将系统地解答这些问题。在“原理与机制”一章中，我们将深入探讨支撑[单像素相机](@entry_id:754911)的物理优势和[压缩感知](@entry_id:197903)的数学框架。接着，在“应用与跨学科连接”一章中，我们将展示这一框架如何灵活地扩展到视频、[高光谱成像](@entry_id:750488)、相位恢复乃至非视域成像等多样化的前沿挑战中，并揭示其与[磁共振成像](@entry_id:153995)等其他领域的深刻联系。最后，“动手实践”部分将提供具体的计算练习，帮助您将理论知识转化为解决实际问题的能力。通过这一系列的学习，您将全面掌握压缩成像的核心思想与实践方法。

## 原理与机制

本章深入探讨了驱动[压缩感知](@entry_id:197903)成像架构，特别是[单像素相机](@entry_id:754911)（Single-Pixel Camera, SPC）的核心科学原理和关键工作机制。我们将从支撑这类系统设计的物理动机出发，逐步建立其数学框架，详细阐述用于[图像重建](@entry_id:166790)的优化算法，并分析保证其性能的理论基石。最后，我们将讨论如何在更真实的物理模型中扩展这些基本原理，例如在处理泊松散粒噪声或系统模糊时。

### 物理动机：通量与[多路复用](@entry_id:266234)优势

理解[单像素相机](@entry_id:754911)强大潜力的第一步，是认识到其在光学设计上相较于传统焦平面阵列（Focal-Plane Array, FPA）探测器所具备的内在优势。这些优势主要体现在光学通量（或称 étendue）和[多路复用](@entry_id:266234)信噪比增益上。

#### 光学通量（Étendue）

在无损、无源的一阶（近轴）光学系统中，一个基本守恒量是**光学通量（Etendue）**，也称为[光学扩展量](@entry_id:178668)或几何 étendue。它量化了光束在系统中所占据的几何范围。对于一个面积为 $A$、以[立体角](@entry_id:154756) $\Omega$ 接收光线的探测器，在[折射率](@entry_id:168910)为 $n$ 的介质中，其[近轴近似](@entry_id:177930)下的光学通量 $G$ 定义为：

$G \approx n^{2} A \Omega$

光学通量的[守恒定律](@entry_id:269268)意味着，任何无源光学系统都不能增加通过它的光束的 étendue。通过一个光学系统从光源传输的功率 $P$ 与光学通量成正比。

现在，我们来比较[单像素相机](@entry_id:754911)和焦平面阵列。假设两者观察相同的场景，并使用相同的[物镜](@entry_id:167334)，因此总的系统光学通量 $G_{\text{sys}} \approx n^2 A \Omega$ 是固定的，其中 $A$ 是光学系统入瞳的面积。

对于一个有 $N$ 个像素的焦平面阵列，每个像素的面积为 $A/N$。因此，单个像素所能收集的光学通量仅为 $G_{\text{pix}} = G_{\text{sys}} / N$。相比之下，[单像素相机](@entry_id:754911)使用一个大面积的[单体](@entry_id:136559)探测器，它可以收集到整个系统的全部光学通量 $G_{\text{sys}}$。在每次测量中，尽管[空间光调制器](@entry_id:265900)（如数字微镜器件，DMD）会阻挡部分光线，但探测器本身仍然能够接收来自场景大面积区域的光。例如，在使用[亮态](@entry_id:189717)比例约为 $f$ 的模式进行调制时，单次测量收集到的功率 $P_{\text{SPC}}$ 正比于 $f \cdot G_{\text{sys}}$，而FPA单个像素收集到的功率 $P_{\text{pix}}$ 正比于 $G_{\text{sys}}/N$。由于 $f$ 通常是一个常数（例如，对于哈达玛模式，$f \approx 1/2$），当 $N$ 很大时，$P_{\text{SPC}}$ 远大于 $P_{\text{pix}}$。这种显著的[聚光能力](@entry_id:169831)是[单像素相机](@entry_id:754911)，尤其是在红外或太赫兹等探测器昂贵且灵敏度较低的波段，极具吸[引力](@entry_id:175476)的关键原因 [@problem_id:3436250]。

然而，这种通量优势也揭示了一个根本的权衡关系：**分辨率与通量之间的权衡**。对于一个给定的光学系统（即固定的 $G_{\text{sys}}$），如果想要提高空间分辨率（即增加 $N$），每个可分辨模式（像素）所能分配到的光学通量 $G_{\text{sys}}/N$ 就会减少。这意味着每个模式的信号会变弱，最终限制了信噪比。[压缩感知](@entry_id:197903)虽然可以减少获取图像所需的测量次数，但它无法规避这个由光学通量守恒所决定的物理限制 [@problem_id:3436250]。

#### [多路复用](@entry_id:266234)优势

除了通量优势，[单像素相机](@entry_id:754911)还得益于**[多路复用](@entry_id:266234)优势**（Multiplexing Advantage），也称为[费尔盖特优势](@entry_id:749278)（Fellgett's Advantage）。这个概念最初在[光谱学](@entry_id:141940)中提出，其核心思想是：在探测器噪声（如读出噪声）主导的系统中，同时测量多个信号源（[多路复用](@entry_id:266234)）比逐个测量能获得更高的信噪比。

我们可以通过一个具体的例子来量化这一优势。考虑在加性高斯读出噪声 $\eta_k \sim \mathcal{N}(0, \sigma_r^2)$ 主导的条件下，比较两种对 $n$ 像素场景 $x \in \mathbb{R}^n$ 的成像策略 [@problem_id:3436306]：

1.  **光栅扫描（Raster Scanning）**：这是最直接的单点扫描方式。为了测量第 $i$ 个像素 $x_i$，我们只让该像素发光，其测量图案为 $a_i = a_R e_i$，其中 $e_i$ 是[标准基向量](@entry_id:152417)。测量值为 $y_i = a_R x_i + \eta_i$。对 $x_i$ 的估计为 $\widehat{x}_i = y_i / a_R = x_i + \eta_i/a_R$。[估计误差](@entry_id:263890)的标准差为 $\sigma_r / a_R$。因此，单个像素的信噪比（Signal-to-Noise Ratio, SNR）为 $\text{SNR}_i^{\text{Ras}} = |x_i| / (\sigma_r / a_R) = a_R |x_i| / \sigma_r$。

2.  **哈达玛传感（Hadamard Sensing）**：这是一种[多路复用](@entry_id:266234)策略。我们使用一个 $n \times n$ 的哈达玛矩阵 $H$（其元素为 $\pm 1$，并满足 $H H^\top = nI$）的行作为测量图案。每个图案 $a_k = a_H h_k^\top$ 同时照亮场景的所有像素。测量模型为 $y = a_H H x + \eta$。通过逆变换 $\widehat{x} = (1/a_H) H^{-1} y = x + (1/a_H) H^{-1} \eta$，我们可以重建整个图像。由于 $H^{-1} = (1/n)H^\top$，估计误差为 $(\widehat{x} - x) = (1/(n a_H)) H^\top \eta$。由于噪声分量 $\eta_k$ 相互独立，重建图像中第 $i$ 个像素的[误差方差](@entry_id:636041)为 $\text{Var}(\widehat{x}_i - x_i) = \text{Var}(\frac{1}{n a_H} \sum_k H_{ki} \eta_k) = \frac{1}{n^2 a_H^2} \sum_k H_{ki}^2 \sigma_r^2 = \frac{n \sigma_r^2}{n^2 a_H^2} = \frac{\sigma_r^2}{n a_H^2}$。因此，误差[标准差](@entry_id:153618)为 $\sigma_r / (\sqrt{n} a_H)$。单个像素的信噪比为 $\text{SNR}_i^{\text{Had}} = |x_i| / (\sigma_r / (\sqrt{n} a_H)) = \sqrt{n} a_H |x_i| / \sigma_r$。

定义[多路复用](@entry_id:266234)优势 $G$ 为两种策略在相同单次测量能量（$S_R = a_R^2$ 和 $S_H = n a_H^2$）下的平均SNR之比，我们得到：

$G = \frac{\overline{\text{SNR}}_{\text{Had}}}{\overline{\text{SNR}}_{\text{Ras}}} = \frac{\sqrt{n} a_H}{a_R} = \frac{\sqrt{n} \sqrt{S_H/n}}{\sqrt{S_R}} = \sqrt{\frac{S_H}{S_R}}$

如果每次测量的总能量相同（$S_H = S_R$），那么[多路复用](@entry_id:266234)优势 $G=1$。然而，物理上更有意义的比较是在相同的峰值功率或总曝[光通量](@entry_id:167624)下，这通常导致 $S_H$ 与 $nS_R$相当，从而带来 $\sqrt{n}$ 级别的[信噪比](@entry_id:185071)增益。

值得注意的是，这种优势在**探测器噪声**主导时才显著。如果系统由与信号强度相关的**[散粒噪声](@entry_id:140025)（Shot Noise）**主导，那么[多路复用](@entry_id:266234)测量会收集更多[光子](@entry_id:145192)，从而产生更大的噪声。在这种情况下，[多路复用](@entry_id:266234)优势会减弱甚至消失 [@problem_id:3436250]。

### [压缩感知](@entry_id:197903)的数学框架

物理上的优势解释了“为什么”要采用单像素架构，而[压缩感知](@entry_id:197903)的数学理论则回答了“如何”实现高效成像。其核心思想是利用大多数自然图像并非完全随机，而是在某个变换域中具有稀疏或可压缩的结构。

#### 稀疏性与[可压缩性](@entry_id:144559)

一个信号 $x \in \mathbb{R}^N$ 如果在某个正交基 $\Psi \in \mathbb{R}^{N \times N}$（例如[小波基](@entry_id:265197)或[离散余弦变换](@entry_id:748496)基）下的变换系数 $\theta = \Psi^\top x$ 中只有少数几个非零项，则称该信号是**稀疏的（sparse）**。若非零系数的个数最多为 $k$，则称其为 **k-稀疏（k-sparse）** [@problem_id:3436279]。

然而，真实世界的信号通常不是严格稀疏的，而是**可压缩的（compressible）**。这意味着它们的变换系数幅值会迅速衰减。一个典型的模型是系数的排序幅值遵循[幂律衰减](@entry_id:262227) [@problem_id:3436279]：

$|\theta|_{(i)} = C i^{-\alpha}, \quad i=1, 2, \dots, N$

其中 $|\theta|_{(i)}$是第 $i$ 个最大的系数幅值，$C>0$ 和 $\alpha > 1/2$ 是常数。$\alpha$ 值越大，信号的可压缩性越好。

[可压缩性](@entry_id:144559)意味着信号可以用一个 $k$-稀疏的信号 $x_k$ 来精确近似。这个**[最佳k项近似](@entry_id:746766)** $x_k$ 是通过保留 $\theta$ 中最大的 $k$ 个系数并将其余系数置零，然后反变换回信号域得到的。近似误差 $E_k = \|x - x_k\|_2$ 的大小直接取决于系数的衰减速度。对于上述[幂律衰减](@entry_id:262227)模型，我们可以通[过积分](@entry_id:753033)近似计算出，当 $k \to \infty$ 时，近似误差的[渐近行为](@entry_id:160836)为：

$E_k \approx \frac{C}{\sqrt{2\alpha - 1}} k^{\frac{1}{2} - \alpha}$

这个结果清晰地表明，衰减指数 $\alpha$ 越大（即可压缩性越好），近似误差随 $k$ 的增加而下降得越快。这正是[压缩感知](@entry_id:197903)能够有效工作的基础：我们只需要恢复那些主要的系数，就可以得到对原始信号的高保真近似。

#### 测量模型

[单像素相机](@entry_id:754911)的测量过程可以建模为一个[线性系统](@entry_id:147850)。每次测量 $y_i$ 是场景 $x$ 与一个调制图案 $\phi_i^\top$ 的[内积](@entry_id:158127)。总共进行 $m$ 次测量，可以写成矩阵形式：

$y = \Phi x$

其中 $y \in \mathbb{R}^m$ 是测量向量，$\Phi \in \mathbb{R}^{m \times N}$ 是测量矩阵，其每一行是一个调制图案。在[压缩感知](@entry_id:197903)框架下，测量次数 $m$ 远小于信号的维度 $N$（$m \ll N$）。

结合[稀疏性](@entry_id:136793)模型 $x = \Psi z$（其中 $z$ 是稀疏系数向量），测量过程可以写成关于稀疏系数 $z$ 的形式：

$y = \Phi (\Psi z) = (\Phi \Psi) z = A z$

这里的 $A = \Phi \Psi$ 被称为**有效传感矩阵**。压缩感知的核心任务就是从欠定的测量值 $y$ 中恢复稀疏的系数向量 $z$，进而通过 $x = \Psi z$ 重建图像。

### 信号重建：从理论到实践

从欠定方程 $y = Az$ 中求解唯一的稀疏解 $z$ 是一个[逆问题](@entry_id:143129)。

#### [基追踪](@entry_id:200728)（Basis Pursuit）

理想情况下，我们希望找到与测量值一致的最[稀疏解](@entry_id:187463)，即求解以下 $\ell_0$ 范数最小化问题：

$\min_{z \in \mathbb{R}^N} \|z\|_0 \quad \text{subject to} \quad Az=y$

其中 $\|z\|_0$ 计算 $z$ 中非零元素的个数。然而，这是一个[NP难](@entry_id:264825)的[组合优化](@entry_id:264983)问题，在计算上是不可行的。压缩感知理论的突破在于证明，在特定条件下，我们可以用其最紧的[凸松弛](@entry_id:636024)——$\ell_1$ 范数最小化——来代替。这个问题被称为**[基追踪](@entry_id:200728)（Basis Pursuit, BP）** [@problem_id:3436304]：

$\min_{z \in \mathbb{R}^N} \|z\|_1 \quad \text{subject to} \quad Az=y$

其中 $\|z\|_1 = \sum_i |z_i|$。这是一个凸[优化问题](@entry_id:266749)，可以高效求解。

为了更深入地理解BP的解的结构，我们可以考察它的**[拉格朗日对偶问题](@entry_id:637210)**。通过引入[拉格朗日乘子](@entry_id:142696) $\nu \in \mathbb{R}^m$ 并构造拉格朗日量 $L(z, \nu) = \|z\|_1 + \nu^\top(y - Az)$，可以推导出对偶问题为 [@problem_id:3436304]：

$\max_{\nu \in \mathbb{R}^m} y^\top \nu \quad \text{subject to} \quad \|A^\top \nu\|_\infty \le 1$

其中 $\|v\|_\infty = \max_i |v_i|$。强对偶性通常成立，意味着原问题和对偶问题的最优值相等。最优解 $(z^*, \nu^*)$ 必须满足[Karush-Kuhn-Tucker (KKT) 条件](@entry_id:176491)，其中最关键的**[平稳性条件](@entry_id:191085)**揭示了原对偶解之间的深刻联系：$A^\top \nu^* \in \partial \|z^*\|_1$。这具体表现为：

-   如果 $z_i^* \ne 0$，则 $(A^\top \nu^*)_i = \text{sign}(z_i^*)$
-   如果 $z_i^* = 0$，则 $|(A^\top \nu^*)_i| \le 1$

这个条件表明，在解的非零支撑集上，向量 $A^\top \nu^*$ 的分量幅值达到最大值1，并与解的符号对齐。

#### 含噪情况：[LASSO](@entry_id:751223)

在实际应用中，测量总是伴随着噪声：$y = \Phi x_0 + w$。在这种情况下，强制数据完全一致的[等式约束](@entry_id:175290) $Az=y$ 不再合理。取而代之的是，我们寻求一个能在数据保真度和解的[稀疏性](@entry_id:136793)之间取得平衡的解。一个标准的方法是**[LASSO](@entry_id:751223) (Least Absolute Shrinkage and Selection Operator)**。在[分析稀疏模型](@entry_id:746433)下，其形式为 [@problem_id:3436248]：

$\min_{x \in \mathbb{R}^N} \frac{1}{2} \|y - \Phi x\|_2^2 + \lambda \|\Psi^\top x\|_1$

其中第一项是二次数据保真项，适用于加性高斯噪声模型；第二项是正则化项，用于促进分析系数 $\Psi^\top x$ 的[稀疏性](@entry_id:136793)。$\lambda > 0$ 是一个[正则化参数](@entry_id:162917)，它控制着两项之间的权衡。

一个最优解 $x^\star$ 必须满足[一阶最优性条件](@entry_id:634945)，即[零向量](@entry_id:156189)必须包含在[目标函数](@entry_id:267263)在 $x^\star$ 点的[次微分](@entry_id:175641)中。这导出了如下的**[次梯度最优性条件](@entry_id:634317)** [@problem_id:3436248]：

$-\Psi^\top \Phi^\top (\Phi x^\star - y) \in \lambda \partial \|\Psi^\top x^\star\|_1$

这个条件暗示了如何选择正则化参数 $\lambda$。如果真信号 $x_0$ 的某个分析系数 $(\Psi^\top x_0)_j$ 为零，我们希望噪声不会错误地导致估计的系数 $(\Psi^\top x^\star)_j$ 变为非零。为避免这种情况，$\lambda$ 必须足够大，以至于能够“吸收”纯噪声信号的相关性。一个充分的条件是 $\lambda \ge \|\Psi^\top \Phi^\top w\|_\infty$。

假设噪声 $w$ 的分量是独立同分布的高斯[随机变量](@entry_id:195330) $w_i \sim \mathcal{N}(0, \sigma^2)$，并且有效传感矩阵 $A=\Phi\Psi$ 的列是归一化的。我们可以利用[高斯变量](@entry_id:276673)的尾部[概率界](@entry_id:262752)来给出一个具有高概率保证的 $\lambda$ 选择。具体来说，为了保证 $\mathbb{P}(\|A^\top w\|_\infty \le \lambda) \ge 1-\delta$，其中 $p$ 是系数的数量，$\delta$ 是一个小的失败概率，一个标准的选择是 [@problem_id:3436248]：

$\lambda = \sigma \sqrt{2 \ln(2p/\delta)}$

例如，对于一个 $p=256 \times 256 = 65536$ 像素的图像，噪声水平 $\sigma = 1.5 \times 10^{-3}$，[置信度](@entry_id:267904)为 $99\%$（即 $\delta=0.01$），计算出的 $\lambda$ 值约为 $0.008588$。这个具体的选择方法将抽象的[优化问题](@entry_id:266749)与实际的噪声统计特性联系起来。

### 重建的理论保证

一个自然的问题是：在什么条件下，$\ell_1$ 范数最小化能够成功恢复[稀疏信号](@entry_id:755125)？答案在于传感矩阵 $A = \Phi \Psi$ 的性质。

#### 随机性与各向同性

实验和理论都表明，[随机矩阵](@entry_id:269622)是很好的传感矩阵。例如，考虑一个测量矩阵 $\Phi$，其元素是独立的、等概率取值为 $\pm 1$ 的 Rademacher [随机变量](@entry_id:195330)。我们可以计算其格拉姆矩阵（Gram matrix）的期望 [@problem_id:3436235]：

$\mathbb{E}[\Phi^\top \Phi] = m I_N$

其中 $m$ 是测量次数，$I_N$ 是 $N \times N$ 的单位矩阵。这个结果表明，该随机算子在**期望意义上是各向同性的**。这意味着，平均而言，它能保持信号空间中向量的欧几里得范数（长度）和向量间的角度。具体来说，对于任意向量 $v$，其测量后范数平方的期望为 $\mathbb{E}[\|\Phi v\|_2^2] = v^\top \mathbb{E}[\Phi^\top \Phi] v = m\|v\|_2^2$。这种“保持几何结构”的特性是随机测量为何有效的直观解释。为了使算子在期望意义上成为一个[等距算子](@entry_id:261889)（isometry），即 $\mathbb{E}[\|\Psi v\|_2^2] = \|v\|_2^2$，我们通常会对测量矩阵进行归一化，使用 $\frac{1}{\sqrt{m}}\Phi$ 代替 $\Phi$ [@problem_id:3436235]。

#### 受限等距性质 (RIP)

虽然期望意义上的各向同性提供了直觉，但更严格的保证来自于**受限等距性质（Restricted Isometry Property, RIP）**。一个矩阵 $A$ 被称为满足阶为 $k$ 的RIP，如果存在一个常数 $\delta_k \in (0, 1)$，使得对于**所有** $k$-稀疏向量 $z$，以下不等式成立 [@problem_id:3436313]：

$(1-\delta_k)\|z\|_2^2 \le \|Az\|_2^2 \le (1+\delta_k)\|z\|_2^2$

$\delta_k$ 被称为受限等距常数。这个性质要求矩阵 $A$ 近似地保持所有稀疏向量的长度，即它在稀疏向量构成的[子集](@entry_id:261956)上表现得像一个[等距算子](@entry_id:261889)。

在[单像素相机](@entry_id:754911)中，重要的是**有效传感矩阵** $A = \Phi\Psi$ 满足RIP。如果 $A$ 满足阶数为 $2k$ 的RIP且 $\delta_{2k}$ 足够小（例如，$\delta_{2k}  \sqrt{2}-1$），那么诸如BP或LASSO之类的$\ell_1$最小化算法就能够稳定、鲁棒地从含噪测量中恢复任何 $k$-稀疏或可压缩的信号。恢复误差有一个确定的[上界](@entry_id:274738)，它与[测量噪声](@entry_id:275238)的大小和信号本身的[可压缩性](@entry_id:144559)（即与最佳 $k$-项近似的差距）成正比 [@problem_id:3436313]。

#### 相互非[相干性](@entry_id:268953)

RIP是一个强大的理论工具，但直接验证一个给定矩阵是否满足RIP是困难的。一个更易于计算但保证较弱的性质是**相互非[相干性](@entry_id:268953)（Mutual Coherence）**。对于两个正交基 $\Phi$ 和 $\Psi$（这里我们视其为矩阵），其相互非相干性定义为：

$\mu(\Phi, \Psi) = \max_{i,j} |\langle \phi_i, \psi_j \rangle|$

其中 $\phi_i$ 和 $\psi_j$ 分别是来自两个基的向量。这个值衡量了两个基中向量之间的最大相似度。一个小的 $\mu$ 值意味着传感基中的任何一个元素都不能稀疏地表示在稀疏基中，反之亦然。这种“不相似性”是保证重建成功的关键。

非[相干性](@entry_id:268953)的重要性可以通过一个反例来鲜明地展示。考虑一个用哈达玛基作为传感基 $\Phi$、用[哈尔小波](@entry_id:273598)基作为稀疏基 $\Psi$ 的系统。这两个基都是完备的[正交基](@entry_id:264024)。然而，经过计算可以发现，它们之间存在一个公共向量（例如，长度为 $N$ 的序列 `[+1, ..., +1, -1, ..., -1]`，经过归一化后同时存在于两个基中）。这意味着它们的相互非相干性达到了理论最大值 $\mu(\Phi, \Psi) = 1$ [@problem_id:3436303]。

这种高度的相干性会带来灾难性的后果。如果一个场景恰好就是这个公共向量，那么它在[哈尔小波](@entry_id:273598)基下是1-稀疏的。然而，由于哈达玛基是正交的，当我们使用哈达玛基的一个[子集](@entry_id:261956)进行测量时（即 $m  N$），如果恰好没有选中这个公共向量作为测量图案，那么所有的测量结果都会是零。在这种情况下，重建算法无法将这个非零的稀疏场景与一个全零的场景区分开来，导致重建彻底失败。这个例子有力地说明了，传感基和稀疏基的选择绝不是任意的，低非[相干性](@entry_id:268953)是保证[压缩感知](@entry_id:197903)成功的先决条件。

### 高级成像模型

上述基本框架可以在更真实的物理场景下进行扩展。

#### [光子受限成像](@entry_id:753414)（泊松噪声）

在高[光通量](@entry_id:167624)下，将探测器噪声建模为加性[高斯噪声](@entry_id:260752)是合理的。但在极低光照条件下，例如[荧光成像](@entry_id:171928)或天文观测，成像过程受到[光子计数](@entry_id:186176)的量子性质支配。此时，更准确的模型是**泊松[噪声模型](@entry_id:752540)**。假设第 $i$ 次测量的[光子计数](@entry_id:186176)值 $y_i$ 服从一个泊松分布，其均值 $\lambda_i(x)$ 正比于入射到探测器上的光强，并包含背景光和暗计数 $b_i$：

$\lambda_i(x) = \tau_i g \phi_i^\top x + b_i$

其中 $\tau_i$ 是积分时间，$g$ 是探测器增益。

在这种情况下，基于最小二乘的数据保真项不再适用。我们需要从**[最大后验概率](@entry_id:268939)（Maximum A Posteriori, MAP）**估计的框架出发。利用[贝叶斯法则](@entry_id:275170)，[MAP估计](@entry_id:751667)等价于最小化负对数[后验概率](@entry_id:153467)。负对数[后验概率](@entry_id:153467)由两部分组成：[负对数似然](@entry_id:637801)和负对数先验。对于泊松统计，[负对数似然](@entry_id:637801)（在丢弃与 $x$ 无关的常数项后）为 [@problem_id:3436271]：

$-\ln(p(y|x)) \propto \sum_{i=1}^m \left( (\tau_i g \phi_i^\top x + b_i) - y_i \ln(\tau_i g \phi_i^\top x + b_i) \right)$

结合一个促进[稀疏性](@entry_id:136793)的 $\ell_1$ 先验 $-\ln(p(x)) \propto \alpha \|\Psi^\top x\|_1$ 以及物理上的非负性约束 $x \ge 0$，最终的MAP优化目标变为：

$\min_{x \ge 0} \sum_{i=1}^m \left( \tau_i g \phi_i^\top x - y_i \ln(\tau_i g \phi_i^\top x + b_i) \right) + \alpha \|\Psi^\top x\|_1$

这是一个与[LASSO](@entry_id:751223)形式不同但同样是凸的[优化问题](@entry_id:266749)，它为[光子](@entry_id:145192)受限的[压缩感知](@entry_id:197903)成像提供了严谨的数学形式 [@problem_id:3436271]。

#### 包含系统模糊

真实的成像系统总会存在像差和衍射，导致图像模糊。这种模糊效应可以用一个**[点扩散函数](@entry_id:183154)（Point Spread Function, PSF）**来描述。在离散模型中，模糊过程可以表示为一个与卷积矩阵 $H$ 的乘积。于是，[单像素相机](@entry_id:754911)的测量模型变为：

$y = \Phi (H x) + e = (\Phi H) x + e$

系统的有效传感矩阵现在变成了 $A = \Phi H$。模糊的存在会如何影响重建？我们可以通过分析 $A$ 的[奇异值](@entry_id:152907)谱来理解。

考虑一个场景，其中测量图案是[傅里叶基](@entry_id:201167)的行（即 $\Phi$ 选择[DFT矩阵](@entry_id:188760)的行），而模糊是一个具有高斯[光学传递函数](@entry_id:172898)（Optical Transfer Function, OTF）的模糊，OTF是PSF的[傅里叶变换](@entry_id:142120)。在这种情况下，卷积矩阵 $H$ 可以被[DFT矩阵](@entry_id:188760)[对角化](@entry_id:147016)，$H = F^* D F$，其中 $D$ 是一个对角矩阵，其对角元是OTF的采样值 $d_k$。高斯OTF通常在低频时接近1，在高频时迅速衰减至零。

分析表明，有效传感矩阵 $A = \Phi H$ 的非零[奇异值](@entry_id:152907)就是被 $\Phi$ 选中的那些频率对应的OT[F值](@entry_id:178445) $\{d_k\}$。由于OTF在高频处衰减，这意味着 $A$ 的高频[奇异值](@entry_id:152907)会非常小。矩阵的**[条件数](@entry_id:145150)**，即最大与最小非零奇异值之比，会因此急剧增大。例如，对于一个由模糊尺度 $\sigma$ 和图像大小 $n$ 决定的高斯模糊，当测量最低的 $m$ 个频率时，[条件数](@entry_id:145150)可表示为 [@problem_id:3436294]：

$\kappa(A) = \exp\left(\frac{2\pi^2 \sigma^2 (m-1)^2}{n^2}\right)$

一个巨大的条件数意味着逆问题是病态的（ill-conditioned）。这在物理上对应着高频信息在模糊过程中被严重衰减，即使测量过程本身是理想的，后续重建也很难恢复这些丢失的细节。因此，将[物理光学](@entry_id:178058)模型整合到[压缩感知](@entry_id:197903)框架中，对于准确预测和理解系统性能至关重要。