## 引言
在数据科学、机器学习和网络科学等领域，数据越来越多地以[复杂网络](@entry_id:261695)或图的形式出现，例如社交网络、[生物分子](@entry_id:176390)互作网络和交通系统。传统的信号处理工具，如[傅里叶变换](@entry_id:142120)和[小波分析](@entry_id:179037)，其设计初衷是处理定义在规则欧几里得域（如时间序列或图像）上的信号，面对这些不规则的图结构数据时则显得力不从心。如何为定义在图顶点上的信号建立一套严谨的分析框架，从而揭示其内在结构与模式，构成了[图信号处理](@entry_id:183351)（Graph Signal Processing, GSP）所要解决的核心知识鸿沟。

本文旨在系统性地介绍GSP的基础理论、核心方法及其在多学科中的应用。通过学习本文，您将掌握在图上进行[频域分析](@entry_id:265642)、滤波、多尺度分解和[信号重构](@entry_id:261122)的强大工具。第一章“原理与机制”将奠定理论基础，从[图拉普拉斯算子](@entry_id:275190)出发，构建[图傅里叶变换](@entry_id:187801)和[图小波](@entry_id:750020)，并探讨滤波和正则化先验。第二章“应用与跨学科连接”将展示这些理论如何在[信号重构](@entry_id:261122)、大规模数据处理和网络过程建模等实际问题中发挥作用。最后，第三章“动手实践”将通过具体的计算练习，巩固您对核心概念的理解。

## 原理与机制

本章旨在深入探讨[图信号处理](@entry_id:183351)的核心原理与机制。我们将从如何在图上定义信号的“平滑度”这一基本概念出发，引出[图傅里叶变换](@entry_id:187801)（Graph Fourier Transform, GFT）的构建，并阐释其如何为定义在不规则图结构上的数据提供一套严谨的[频域分析](@entry_id:265642)框架。随后，我们将讨论GFT的多种变体，包括在有向图上的推广。在此基础上，我们将建立[图滤波](@entry_id:193076)的理论，并进一步探讨在[信号恢复](@entry_id:195705)问题中至关重要的两种正则化先验：二次平滑先验和图总变分。最后，为了克服GFT[基函数](@entry_id:170178)全局性的限制，我们将引入[图小波](@entry_id:750020)的概念，它能够提供在顶点域和[频域](@entry_id:160070)中都具有局部性的分析。我们还将探讨图上的不确定性原理，以量化这种局部性权衡。

### 图信号的平滑度与图拉普拉斯算子

在处理常规信号（如时间序列或图像）时，“频率”的概念与信号的变化速度直观地联系在一起。一个高频信号变化剧烈，而一个低频信号则变化平缓。为了将这一概念推广到图上，我们首先需要一个量化“平滑度”或“变化总量”的度量。

考虑一个定义在图顶点上的信号 $x \in \mathbb{R}^{n}$，其中 $x_i$ 是节点 $i$ 上的信号值。一个直观的平滑度度量是考察所有相连节点对之间信号值的差异。如果一个信号是平滑的，那么通过权重较大的边连接的节点，其信号值应该非常接近。我们可以将所有加权差异的平方和作为信号的总变差，也称为**[狄利克雷能量](@entry_id:276589)**（Dirichlet energy）。

对于一个由权重矩阵 $W$ 定义的[无向图](@entry_id:270905)，其[狄利克雷能量](@entry_id:276589) $E(x)$ 定义为：
$$
E(x) = \frac{1}{2} \sum_{i=1}^{n} \sum_{j=1}^{n} w_{ij} (x_i - x_j)^2
$$
这个表达式清晰地体现了平滑度的概念：$(x_i - x_j)^2$ 惩罚了节点 $i$ 和 $j$ 之间的信号差异，而权重 $w_{ij}$ 则强调了强连接节点对上的差异。

令人惊讶的是，这个看似复杂的双[重求和](@entry_id:275405)可以被一个简洁的矩阵二次型所表示。这需要引入图论中一个至关重要的算子——**[图拉普拉斯算子](@entry_id:275190)**（Graph Laplacian）。对于一个[无向图](@entry_id:270905)，其（组合）拉普拉斯算子 $L$ 定义为 $L = D - W$，其中 $D$ 是对角度矩阵，其对角元素 $D_{ii} = \sum_{j=1}^{n} w_{ij}$ 是节点 $i$ 的度（或加权度）。通过代数推导可以证明，[狄利克雷能量](@entry_id:276589)与这个二次型完[全等](@entry_id:273198)价 [@problem_id:3448874]：
$$
x^{\top} L x = \frac{1}{2} \sum_{i=1}^{n} \sum_{j=1}^{n} w_{ij} (x_i - x_j)^2
$$
这个恒等式是[图信号处理](@entry_id:183351)的基石。它将图的拓扑结构（通过 $L$ 编码）与定义在图上的信号的函数属性（其变化或平滑度）直接联系起来。$L$ 是一个实[对称半正定矩阵](@entry_id:163376)，这些优良的代数性质使其成为[频谱分析](@entry_id:275514)的理想对象。

### [图傅里叶变换](@entry_id:187801)：图上的[频域分析](@entry_id:265642)

[狄利克雷能量](@entry_id:276589) $x^\top L x$ 为我们提供了一个衡量信号总变差的工具。现在，我们希望建立一个类似于经典[傅里叶变换](@entry_id:142120)的框架，它能将图[信号分解](@entry_id:145846)为一系列具有不同“频率”的[基函数](@entry_id:170178)的[线性组合](@entry_id:154743)。这里的“图频率”应该与信号的平滑度直接相关。

我们的目标是寻找一组[标准正交基](@entry_id:147779) $\{u_k\}_{k=0}^{n-1}$，使得在这组基下，[狄利克雷能量](@entry_id:276589)的表达式变得对角化。也就是说，如果信号 $x$ 在这组基下的坐标为 $\hat{x}$（即 $x = \sum_k \hat{x}_k u_k$），我们希望 $x^\top L x$ 能够表示为 $\sum_k \lambda_k \hat{x}_k^2$ 的形式，其中 $\lambda_k$ 是与[基函数](@entry_id:170178) $u_k$ 相关的“频率”。

这个寻找对角化基的过程，正是对[拉普拉斯矩阵](@entry_id:152110) $L$ 进行[特征分解](@entry_id:181333)。根据[实对称矩阵](@entry_id:192806)的[谱定理](@entry_id:136620)，$L$ 可以被分解为 $L = U \Lambda U^{\top}$，其中 $U$ 是一个正交矩阵，其列 $u_k$ 是 $L$ 的[特征向量](@entry_id:151813)；$\Lambda$ 是一个对角矩阵，其对角元 $\lambda_k$ 是对应的[特征值](@entry_id:154894)。

这自然地引出了**[图傅里叶变换](@entry_id:187801)（GFT）**的定义 [@problem_id:3448866]：
- **图[傅里叶基](@entry_id:201167)** 或 **图傅里叶模式**：拉普拉斯算子 $L$ 的[特征向量](@entry_id:151813) $u_0, u_1, \dots, u_{n-1}$。
- **图频率**：对应的[特征值](@entry_id:154894) $\lambda_0, \lambda_1, \dots, \lambda_{n-1}$，通常按非递减顺序[排列](@entry_id:136432) ($0 \le \lambda_0 \le \dots \le \lambda_{n-1}$)。
- **[图傅里叶变换](@entry_id:187801) (GFT)**：信号 $x$ 到其谱系数 $\hat{x}$ 的映射，定义为 $\hat{x} = U^{\top} x$。每个系数 $\hat{x}_k = u_k^\top x$ 是信号在对应傅里叶模式上的投影。
- **逆[图傅里叶变换](@entry_id:187801) (IGFT)**：从谱系数重构信号，定义为 $x = U \hat{x}$。

**GFT的性质与解释**：
- **频率的含义**：[特征值](@entry_id:154894) $\lambda_k$ 是其对应[特征向量](@entry_id:151813) $u_k$ 的瑞利商（Rayleigh quotient）：$\lambda_k = \frac{u_k^{\top} L u_k}{u_k^{\top} u_k}$。这表明 $\lambda_k$ 直接度量了模式 $u_k$ 本身的变差或“[振荡](@entry_id:267781)性”。较小的 $\lambda_k$ 对应更平滑的[基函数](@entry_id:170178)，而较大的 $\lambda_k$ 对应变化更剧烈的[基函数](@entry_id:170178)。
- **能量对角化**：在GFT域中，[狄利克雷能量](@entry_id:276589)的表达式变为 $x^{\top} L x = (U\hat{x})^\top L (U\hat{x}) = \hat{x}^\top (U^\top L U) \hat{x} = \hat{x}^\top \Lambda \hat{x} = \sum_{k=0}^{n-1} \lambda_k \hat{x}_k^2$。这个优美的结果清晰地揭示了，一个信号的总变差是其在各个频率模式上能量 $|\hat{x}_k|^2$ 的加权和，权重就是频率本身 $\lambda_k$。
- **零频分量**：对于任意图，$L\mathbf{1} = (D-W)\mathbf{1} = \mathbf{0}$，因此常数向量 $\mathbf{1}$ 总是对应于[特征值](@entry_id:154894) $\lambda_0=0$ 的[特征向量](@entry_id:151813)。这意味着最平滑的信号（常数信号）具有零频率。对于一个连通图，$\lambda_0=0$ 的特征空间是一维的。若图包含 $c$ 个连通分量，则[特征值](@entry_id:154894)0的[重数](@entry_id:136466)为 $c$，其对应的特征空间由在每个连通分量上为常数的指示向量张成 [@problem_id:3448866]。

### GFT 的变体与推广

上述基于组合[拉普拉斯算子](@entry_id:146319) $L=D-W$ 的GFT定义并非唯一。根据应用场景的不同，研究人员发展了多种变体。

**[归一化拉普拉斯算子](@entry_id:637401)**：在机器学习等领域，为了消除节点度的影响，常常使用[归一化拉普拉斯算子](@entry_id:637401)。一个常见的选择是**对称[归一化拉普拉斯算子](@entry_id:637401)** $L_{\mathrm{n}} = D^{-1/2} L D^{-1/2} = I - D^{-1/2} W D^{-1/2}$。这个算子的[特征值](@entry_id:154894)被证明在 $[0, 2]$ 区间内。其[特征向量](@entry_id:151813)构成了另一套图[傅里叶基](@entry_id:201167)。幸运的是，这两种定义之间有明确的联系 [@problem_id:3448879]。
- 两个问题，$L u_k = \lambda_k D u_k$（一个[广义特征问题](@entry_id:168055)）和 $L_{\mathrm{n}} v_k = \lambda_k v_k$（一个标准特征问题），拥有完全相同的谱（[特征值](@entry_id:154894) $\lambda_k$）。
- 它们各自的[特征基](@entry_id:151409) $U$ 和 $V$ 通过一个简单的对角度矩阵 $D^{1/2}$ 相关联：$V = D^{1/2} U$（假设[基向量](@entry_id:199546)被适当地归一化）。这表明，通过一个与节点度相关的加权变换，可以在两种[傅里叶表示](@entry_id:749544)之间切换。

**有向图上的GFT**：标准GFT的优雅性质源于拉普拉斯算子的对称性，但这在[有向图](@entry_id:272310)中不成立。为有向图定义GFT是一个活跃的研究领域，主要有两种思路 [@problem_id:3448876]：
1.  **基于Jordan分解的方法**：任何方阵（即使非对称、不可[对角化](@entry_id:147016)）都存在Jordan分解 $L = V J V^{-1}$。我们可以用可逆矩阵 $V$ 的列（即[广义特征向量](@entry_id:152349)）作为“[傅里叶基](@entry_id:201167)”。变换定义为 $\hat{x} = V^{-1} x$。这种方法的优点是普适性，但代价是基 $V$ 通常不是正交的。这意味着经典的帕塞瓦尔[能量守恒](@entry_id:140514)定律（$\|x\|_2^2 = \|\hat{x}\|_2^2$）不再成立。然而，我们可以定义一个推广的[能量守恒](@entry_id:140514)，即存在一个[正定矩阵](@entry_id:155546) $M$（例如 $M=(V^{-1})^*V^{-1}$），使得 $\|x\|_M^2 = x^* M x = \|\hat{x}\|_2^2$。这种基于双[正交系统](@entry_id:184795)的方法保证了变换的完备性和[可逆性](@entry_id:143146)。
2.  **厄米化 (Hermitianization) 方法**：另一种思路是构造一个新的、能够反映有向[边信息](@entry_id:271857)的厄米算子，例如**磁拉普拉斯算子**（Magnetic Laplacian）。通过在邻接矩阵的非对角元上引入[复数相位](@entry_id:173474)来编码边的方向，可以构造一个厄米矩阵 $L_{\mathrm{mag}}$。由于 $L_{\mathrm{mag}}$ 是厄米的，[谱定理](@entry_id:136620)保证了它有一套完整的酉[特征基](@entry_id:151409) $U$。基于此的GFT（$\hat{x} = U^* x$）恢复了所有理想的性质：基是标准正交的，且欧几里得[能量守恒](@entry_id:140514)（$\|x\|_2^2 = \|\hat{x}\|_2^2$）。这种方法的代价是，我们分析的不再是原始的[拉普拉斯算子](@entry_id:146319)，而是一个与之相关的代理算子。

### 图[频域](@entry_id:160070)中的信号处理：滤波

GFT为在图上进行滤波操作提供了理论基础。类似于经典信号处理，图上的卷积操作在[频域](@entry_id:160070)中简化为乘法。

一个**谱[图滤波](@entry_id:193076)器**（spectral graph filter）被定义为一个作用于[拉普拉斯谱](@entry_id:275024)的函数 $g(\lambda)$。通过[泛函演算](@entry_id:138358)，我们可以将这个标量函数提升为一个[矩阵算子](@entry_id:269557) $g(L) = U g(\Lambda) U^{\top}$，其中 $g(\Lambda)$ 是对角元为 $g(\lambda_k)$ 的[对角矩阵](@entry_id:637782)。

当这个滤波器作用于一个信号 $x$ 时，输出信号 $y = g(L)x$。在GFT域中，这个操作异常简单 [@problem_id:3448913]：
$$
\hat{y}_k = g(\lambda_k) \hat{x}_k
$$
这意味着滤波就是对信号的每个频率分量进行重新加权。函数 $g(\lambda)$ 被称为**[频率响应](@entry_id:183149)**。
- 如果 $g(\lambda)$ 在 $\lambda$ 较小时值较大，而在 $\lambda$ 较大时值较小，那么它就是一个**低通滤波器**，会使信号变得更平滑。
- 相反，如果它放大高频分量，则为**[高通滤波器](@entry_id:274953)**，可用于边缘检测等任务。

滤波操作同样会重塑信号的能量[分布](@entry_id:182848)。输出信号的总能量为：
$$
\|y\|_2^2 = \|\hat{y}\|_2^2 = \sum_{k=0}^{n-1} |\hat{y}_k|^2 = \sum_{k=0}^{n-1} |g(\lambda_k)|^2 |\hat{x}_k|^2
$$
此外，滤波器算子 $g(L)$ 的可逆性取决于其[频率响应](@entry_id:183149)。只有当 $g(\lambda_k) \neq 0$ 对所有的 $k$ 成立时，$g(L)$ 才是可逆的，其逆滤波器为 $1/g(L)$ [@problem_id:3448913]。

### 用于图[信号恢复](@entry_id:195705)的先验模型

GFT和[图滤波](@entry_id:193076)在图[信号恢复](@entry_id:195705)任务中扮演着核心角色，例如从少量带噪采样点中恢复完整信号（插值或去噪）。这类[逆问题](@entry_id:143129)通常是病态的，需要引入正则化项（或称先验）来约束解空间。信号的平滑度是[图信号处理](@entry_id:183351)中最常用的先验。

存在两种主流的平滑度先验模型，它们适用于不同类型的信号 [@problem_id:3448915]：

1.  **二次平滑先验 ($J_2(x) = x^{\top}Lx$)**: 该先验惩罚了图上信号差异的平方和。从贝叶斯角度看，它对应于一个[高斯马尔可夫随机场](@entry_id:749746)（GMRF）模型，其[精度矩阵](@entry_id:264481)正比于 $L$ [@problem_id:3448915]。它鼓励所有相连节点的值都略微相似，因此特别适合建模**全局平滑**或**带限**的信号（即GFT系数主要集中在低频部分的信号）。然而，当信号存在真实的、剧烈的跳变时，该先验倾向于将跳变[模糊化](@entry_id:260771)，在边缘处产生过渡，而不是保持其锐利性。

2.  **图总变分 (GTV, $J_1(x) = \sum_{(i,j)} w_{ij}|x_i - x_j|$)**: 该先验惩罚的是信号差异的[绝对值](@entry_id:147688)之和，是图上信号梯度的加权$\ell_1$范数 [@problem_id:3448871]。$\ell_1$范数以其诱导稀疏性的能力而著称。在这里，它鼓励大多数边的信号差异 $(x_i - x_j)$ 精确地为零。这使得GTV成为建模**分段常数**信号的理想选择，例如社群检测中的社群标签指示信号。与二次先验不同，GTV能够很好地保持信号中的锐利边缘，因为它对大的差异值的惩罚是线性的，而不是二次的。在[压缩感知](@entry_id:197903)的框架下，GTV先验可以从远少于节点数的样本中精确恢复[分段常数信号](@entry_id:753442)。

这两种先验的选择取决于我们对底层信号结构的基本假设。对于平滑变化的物理场（如温度），$J_2$ 可能更合适；而对于具有明确边界的[分类数据](@entry_id:202244)（如[图像分割](@entry_id:263141)），$J_1$ 通常表现更优。

### [图小波](@entry_id:750020)：顶点域与[频域](@entry_id:160070)的局部化分析

GFT为[图信号处理](@entry_id:183351)提供了强大的[频域](@entry_id:160070)视角，但其[基函数](@entry_id:170178)（拉普拉斯[特征向量](@entry_id:151813)）通常是全局的，即它们支撑在图的所有节点上。这意味着信号在单个节点上的局部扰动会影响到几乎所有的GFT系数。为了同时在顶点域和[频域](@entry_id:160070)中进行局部化分析，我们需要图上的[小波变换](@entry_id:177196)。

**谱[图小波](@entry_id:750020)**（spectral graph wavelets）是一种构建方法，它通过在[频域](@entry_id:160070)中对一个“[母小波](@entry_id:201955)”进行缩放来实现。具体而言，我们设计一个**低通[核函数](@entry_id:145324)** $g(\lambda)$ 和一个**带通[核函数](@entry_id:145324)** $h(\lambda)$（满足 $h(0)=0$）。然后通过[图滤波](@entry_id:193076)操作定义**[尺度函数](@entry_id:200698)原子** $\phi_i$ 和**小波原子** $\psi_{s,i}$ [@problem_id:3448880]：
- **[尺度函数](@entry_id:200698)原子**：$\phi_i = g(L) \delta_i$
- **小波原子**：$\psi_{s,i} = h(sL) \delta_i$

这里，$\delta_i$ 是在节点 $i$ 处取值为1，其余处为0的脉冲信号。$s>0$ 是**尺度**参数。
- **[尺度参数](@entry_id:268705) $s$ 的作用**：参数 $s$ 控制着小波在[频域](@entry_id:160070)中的位置和宽度。根据不确定性原理，这直接影响其在顶点域的局部性。
    - **小尺度 $s$**：$h(s\lambda)$ 的能量集中在高频区域。对应的小波原子 $\psi_{s,i}$ 在顶点域中高度局部化（能量集中在节点 $i$ 附近），用于捕捉信号的精细、高频细节。
    - **大尺度 $s$**：$h(s\lambda)$ 的能量集中在低频区域。对应的[小波](@entry_id:636492)原子 $\psi_{s,i}$ 在顶点域中[分布](@entry_id:182848)更广、更平滑，用于捕捉信号的粗糙、低频轮廓。

为了使这套由所有[尺度函数](@entry_id:200698)和[小波](@entry_id:636492)原子组成的集合 $\{ \phi_i \}_{i} \cup \{ \psi_{s_m, i} \}_{m,i}$ 能够稳定地表示和重构任意信号，它必须构成一个**框架**（Frame）。这要求存在常数 $0  A \le B  \infty$ 使得对任意信号 $x$，其总能量满足：
$$
A \|x\|_2^2 \le \sum_{i} |\langle x, \phi_i \rangle|^2 + \sum_{m,i} |\langle x, \psi_{s_m, i} \rangle|^2 \le B \|x\|_2^2
$$
这个条件在[频域](@entry_id:160070)中有一个等价且更直观的表述 [@problem_id:3448880] [@problem_id:3448911]：
$$
A \le |g(\lambda)|^2 + \sum_{m} |h(s_m \lambda)|^2 \le B, \quad \text{对所有 } \lambda \in \text{spec}(L)
$$
这被称为**谱覆盖条件**，它要求滤波器组的能量在整个[频谱](@entry_id:265125)上既不能有空洞（下界$A0$），也不能过度冗余（[上界](@entry_id:274738)$B\infty$）。框架界 $A$ 和 $B$ 直接决定了变换的数值稳定性。例如，框架算子 $S$ 的条件数 $\kappa(S)$ 被界定为 $\kappa(S) \le B/A$。在从带噪系数重构信号时，噪声的传播也由下界 $A$ 控制，重构误差与噪声能量的关系为 $\|\hat{x} - x\|_2 \le \frac{1}{\sqrt{A}} \|n\|_2$ [@problem_id:3448911]。

### 图上的[不确定性原理](@entry_id:141278)

经典信号处理中的[不确定性原理](@entry_id:141278)指出，一个信号不能同时在时域和[频域](@entry_id:160070)中都具有任意小的支撑。这个原理在图上也有对应的版本，但其具体形式依赖于图的结构。

我们可以通过**[相干性](@entry_id:268953)**（coherence）来量化顶点域基（标准基 $I$）和[频域](@entry_id:160070)基（GFT基 $U$）之间的关系。互 coherence $\mu(I, U)$ 定义为两组[基向量](@entry_id:199546)之间[内积](@entry_id:158127)的最大[绝对值](@entry_id:147688)：
$$
\mu = \max_{i,k} |\langle \delta_i, u_k \rangle| = \max_{i,k} |u_k(i)|
$$
[相干性](@entry_id:268953) $\mu$ 的取值范围是 $[1/\sqrt{n}, 1]$。一个广义的[不确定性原理](@entry_id:141278)表明，信号在顶点域的稀疏度（非零元素个数 $\|x\|_0$）和在[频域](@entry_id:160070)的稀疏度（非零系数个数 $\|\hat{x}\|_0$）满足 $\|x\|_0 + \|\hat{x}\|_0 \ge 2/\mu$。

- 如果 $\mu$ 很小（接近 $1/\sqrt{n}$），则[不确定性原理](@entry_id:141278)很强。一个在顶点域稀疏的信号，其[频谱](@entry_id:265125)必然是延展的，反之亦然。
- 如果 $\mu$ 很大（接近 $1$），则[不确定性原理](@entry_id:141278)很弱。这意味着可能存在同时在顶点域和[频域](@entry_id:160070)都很“尖锐”（稀疏）的信号。

一个绝佳的例子是**[星形图](@entry_id:271558)** [@problem_id:3448919]。对于一个有 $n$ 个节点的[星形图](@entry_id:271558)，其中心节点连接着 $n-1$ 个叶子节点。通过计算其[拉普拉斯谱](@entry_id:275024)，可以证明其互 coherence 为 $\mu = \sqrt{\frac{n-1}{n}}$。当 $n$ 很大时，$\mu$ 趋近于1。
- 这种高[相干性](@entry_id:268953)意味着什么？考虑一个在中心节点高度集中的信号 $\delta_0$。它在顶点域是1-稀疏的。它的GFT谱也惊人地稀疏，只有两个非零分量。
- 反之，对应于最大[特征值](@entry_id:154894) $\lambda_{n-1}=n$ 的[特征向量](@entry_id:151813) $u_{n-1}$，它在[频域](@entry_id:160070)是1-稀疏的，但在顶点域，其能量的 $\frac{n-1}{n}$ 绝大部分也集中在中心节点上。
这个例子生动地说明，图的拓扑结构（如[星形图](@entry_id:271558)中心节点的存在）可以打破顶点域和[频域](@entry_id:160070)局部性之间的典型权衡，这是[图信号处理](@entry_id:183351)区别于经典信号处理的深刻体现。