{"hands_on_practices": [{"introduction": "我们从合成稀疏模型开始，这是一种在稀疏信号恢复中较为经典的方法。本练习将引导您推导一个恢复保证，用于处理在标准基中稀疏并通过部分傅里叶采样测量的信号 [@problem_id:3485055]。通过计算互相关性（mutual coherence），您将亲手建立起测量系统物理特性与稀疏信号恢复理论极限之间的桥梁，这是压缩感知理论的基石之一。", "problem": "考虑一个维度为 $n \\in \\mathbb{N}$ 的离散信号空间。令 $F \\in \\mathbb{C}^{n \\times n}$ 为酉离散傅里叶变换矩阵，其元素为 $F_{k\\ell} = \\frac{1}{\\sqrt{n}} \\exp\\!\\big(-2\\pi i \\frac{k\\ell}{n}\\big)$，其中 $k,\\ell \\in \\{0,1,\\dots,n-1\\}$，因此 $F$ 的每一行和每一列都具有单位 $\\ell_{2}$ 范数。通过从 $F$ 中均匀随机地选择 $m$ 个不同的行来构成一个感知矩阵 $A \\in \\mathbb{C}^{m \\times n}$，其中 $1 \\leq m \\leq n$。考虑一个综合稀疏模型，其中固定字典 $D \\in \\mathbb{C}^{n \\times n}$ 等于单位矩阵，因此任何综合系数向量 $x \\in \\mathbb{C}^{n}$ 生成一个信号 $z = D x = x$，并且 $s$-稀疏综合信号满足 $|\\operatorname{supp}(x)| \\leq s$。\n\n定义感知矩阵 $A$ 和字典 $D$ 之间的缩放互相关性为\n$$\n\\mu(A,D) := \\sqrt{n} \\, \\max_{i \\in \\{1,\\dots,m\\}} \\max_{j \\in \\{1,\\dots,n\\}} \\left| \\langle a_{i}, d_{j} \\rangle \\right|,\n$$\n其中 $a_{i} \\in \\mathbb{C}^{n}$ 表示 $A$ 的第 $i$ 行，视为 $\\mathbb{C}^{n}$ 中的单位范数向量，而 $d_{j} \\in \\mathbb{C}^{n}$ 表示 $D$ 的第 $j$ 列，也具有单位范数。假设无噪声测量 $y = A z = A D x$。\n\n从压缩感知中关于非相干感知与综合稀疏性的成熟理论出发，并且不使用任何未从这些理论逻辑推导出的快捷公式，分析此设置下的 $\\mu(A,D)$，然后推导通过 $\\ell_{1}$ 最小化精确重构任何 $s$-稀疏综合向量 $x$ 的最坏情况充分恢复保证，将其表示为 $m$、$n$ 和一个绝对常数 $C  0$ 的函数。将此保证可以证明的最大稀疏度 $s_{\\max}(m,n,C)$ 表示为单个封闭形式的解析表达式。不需要数值舍入，也不涉及物理单位。您的最终答案必须是单个解析表达式。", "solution": "本题要求推导在部分傅里叶采样下，通过$\\ell_1$最小化精确恢复标准基稀疏信号的最大稀疏度$s_{\\max}$。\n\n**第一步：分析互相关性 $\\mu(A,D)$**\n\n根据定义，感知矩阵$A$的行$a_i$是傅里叶矩阵$F$的行，字典$D=I_n$的列$d_j$是标准基向量$e_j$。所有这些向量都具有单位$\\ell_2$范数。互相关性定义中的内积$|\\langle a_i, d_j \\rangle|$是$F$的某行向量与标准基向量$e_j$的内积的模。\n\n令$a_i$是$F$的第$k$行，其元素为$F_{k\\ell}$。那么内积为：\n$$\n|\\langle a_i, d_j \\rangle| = |\\langle a_i, e_j \\rangle| = |(a_i)_j| = |F_{kj}|\n$$\n其中$(a_i)_j$表示行向量$a_i$的第$j$个分量。根据傅里叶矩阵的定义，$F_{k\\ell} = \\frac{1}{\\sqrt{n}} \\exp(-2\\pi i \\frac{k\\ell}{n})$。其模为：\n$$\n|F_{k\\ell}| = \\left| \\frac{1}{\\sqrt{n}} \\exp\\left(-2\\pi i \\frac{k\\ell}{n}\\right) \\right| = \\frac{1}{\\sqrt{n}}\n$$\n这个值对于$F$的所有元素都是常数。因此，\n$$\n\\max_{i,j} |\\langle a_i, d_j \\rangle| = \\frac{1}{\\sqrt{n}}\n$$\n将此结果代入缩放互相关性的定义中：\n$$\n\\mu(A,D) = \\sqrt{n} \\cdot \\max_{i,j} |\\langle a_i, d_j \\rangle| = \\sqrt{n} \\cdot \\frac{1}{\\sqrt{n}} = 1\n$$\n\n**第二步：应用压缩感知恢复理论**\n\n压缩感知领域的经典理论指出，如果一个信号在某个正交基$\\Psi$中是$s$-稀疏的，并且通过一个与$\\Psi$不相关的酉基$U$的部分行进行测量，那么可以通过$\\ell_1$最小化以高概率精确恢复该信号。成功恢复的一个充分条件是测量次数$m$满足：\n$$\nm \\geq C \\cdot \\mu(U, \\Psi)^2 \\cdot s \\cdot \\ln(n)\n$$\n其中$C$是一个正常数，$\\mu(U, \\Psi) = \\sqrt{n} \\max_{k,\\ell} |\\langle u_k, \\psi_\\ell \\rangle|$是基$U$和$\\Psi$之间的互相关性。\n\n**第三步：确定参数并推导保证**\n\n在当前问题中：\n- 测量基是傅里叶基，$U=F$。\n- 稀疏基是标准基，$\\Psi=D=I_n$。\n- 互相关性 $\\mu(F, I_n)$ 正是我们在第一步中计算的 $\\mu(A,D)$，其值为1。\n\n将这些参数代入恢复条件，我们得到：\n$$\nm \\geq C \\cdot (1)^2 \\cdot s \\cdot \\ln(n) = C s \\ln(n)\n$$\n\n**第四步：求解最大稀疏度 $s_{\\max}$**\n\n该不等式给出了对于任意$s$-稀疏信号都能成功恢复的充分条件。为了找到该保证所能证明的最大稀疏度$s_{\\max}$，我们对不等式中的$s$进行求解：\n$$\ns \\leq \\frac{m}{C \\ln(n)}\n$$\n因此，最大稀疏度为：\n$$\ns_{\\max}(m,n,C) = \\frac{m}{C \\ln(n)}\n$$\n这个表达式即为所求的封闭形式解析解。", "answer": "$$\\boxed{\\frac{m}{C \\ln(n)}}$$", "id": "3485055"}, {"introduction": "接下来，我们转向分析稀疏模型，它为许多结构化信号（例如经过小波变换的信号）提供了更灵活的框架。此问题挑战您为分析稀疏信号建立一个恢复保证，同样使用部分傅里叶测量 [@problem_id:3485048]。您将看到相干性的概念如何推广到此情境中，以及它如何决定成功重建所需的测量数量。", "problem": "考虑一个未知信号 $x^{\\star} \\in \\mathbb{C}^{n}$ 和一个作为小波框架的线性分析算子 $\\Omega \\in \\mathbb{C}^{p \\times n}$。假设 $\\Omega$ 是一个框架界为 $1$ 的紧框架，即 $\\Omega^{\\ast} \\Omega = I_{n}$，并且 $\\Omega$ 的行是归一化的，使得对于每个行索引 $j \\in \\{1,\\dots,p\\}$，行向量 $\\omega_{j}^{\\top}$ 满足 $\\|\\omega_{j}\\|_{2} = 1$。将 $x^{\\star}$ 的分析稀疏度 $s$ 定义为 $s = \\|\\Omega x^{\\star}\\|_{0}$，并令 $T \\subset \\{1,\\dots,p\\}$ 表示 $\\Omega x^{\\star}$ 的支撑集，因此 $|T| = s$。\n\n测量值是通过选取酉离散傅里叶变换 (DFT) 矩阵 $F \\in \\mathbb{C}^{n \\times n}$ 的 $m$ 行来获取的。令 $\\Lambda \\subset \\{1,\\dots,n\\}$ 是一个基数为 $m$ 的随机子集，通过均匀无放回抽样得到，并令 $P_{\\Lambda} \\in \\mathbb{C}^{m \\times n}$ 是相应的行选择器，因此传感矩阵为 $A = P_{\\Lambda} F$。数据为 $y = A x^{\\star}$，重构通过以下分析 $\\ell_{1}$ 规划进行\n$$\n\\min_{x \\in \\mathbb{C}^{n}} \\ \\|\\Omega x\\|_{1} \\quad \\text{约束于} \\quad A x = y.\n$$\n将傅里叶原子和小波行之间的互相关性定义为\n$$\n\\mu \\;=\\; \\max_{k \\in \\{1,\\dots,n\\}} \\max_{j \\in \\{1,\\dots,p\\}} \\left| \\langle f_{k}, \\omega_{j} \\rangle \\right|,\n$$\n其中 $f_{k}$ 是 $F$ 的第 $k$ 列，$\\omega_{j}$ 是 $\\Omega$ 的第 $j$ 行（视为列向量），而 $\\langle \\cdot, \\cdot \\rangle$ 表示复内积。\n\n从第一性原理（分析稀疏度的定义、分析 $\\ell_{1}$ 最小化精确重构的对偶凭证刻画，以及独立随机变量和的标准集中不等式）出发，推导测量次数 $m$ 的一个充分下界。该下界需用相关性 $\\mu$、稀疏度 $s$、行数 $p$ 和失效概率参数 $\\delta \\in (0,1)$ 来表示，使得在 $\\Lambda$ 的随机抽取下，分析规划的唯一最小化子等于 $x^{\\star}$ 的概率至少为 $1 - \\delta$。你的最终答案必须是最小 $m$ 值的一个单一闭式解析表达式，该表达式是 $\\mu$、$s$、$p$ 和 $\\delta$ 的函数。请使用自然对数表示对数，并且最终表达式中不包含任何单位。", "solution": "本题要求推导在部分傅里叶测量下，通过分析$\\ell_1$最小化精确重构分析稀疏信号所需的测量次数$m$的充分下界。\n\n**第一步：问题重构**\n\n关键的假设是分析算子$\\Omega \\in \\mathbb{C}^{p \\times n}$是一个紧框架，满足$\\Omega^{\\ast} \\Omega = I_{n}$。这个性质意味着$\\Omega$是一个从$\\mathbb{C}^n$到其值域$\\text{ran}(\\Omega) \\subset \\mathbb{C}^p$的等距同构。因此，对于任意$x \\in \\mathbb{C}^n$，我们可以唯一地确定其分析系数$z = \\Omega x$；反之，对于任意位于$\\text{ran}(\\Omega)$中的系数向量$z$，我们可以通过$x = \\Omega^{\\ast} z$精确地恢复原始信号$x$。\n\n利用这一关系，我们可以将原始的分析模型重构问题\n$$\n\\min_{x \\in \\mathbb{C}^{n}} \\|\\Omega x\\|_{1} \\quad \\text{约束于} \\quad A x = y\n$$\n转化为一个关于系数向量$z = \\Omega x$的等价问题。将$x = \\Omega^{\\ast} z$代入，得到：\n$$\n\\min_{z \\in \\text{ran}(\\Omega)} \\|\\Omega \\Omega^{\\ast} z\\|_{1} \\quad \\text{约束于} \\quad (A \\Omega^{\\ast}) z = y\n$$\n由于我们是在$\\text{ran}(\\Omega)$空间中寻找解，而$\\Omega\\Omega^{\\ast}$是到该空间的正交投影，因此对于任意$z \\in \\text{ran}(\\Omega)$，有$\\Omega\\Omega^{\\ast}z=z$。问题进一步简化为：\n$$\n\\min_{z \\in \\text{ran}(\\Omega)} \\|z\\|_{1} \\quad \\text{约束于} \\quad (A \\Omega^{\\ast}) z = y\n$$\n真实的分析系数$z^{\\star} = \\Omega x^{\\star}$本身是$s$-稀疏的，并且位于$\\text{ran}(\\Omega)$中。因此，原问题等价于一个标准的**合成稀疏重构问题**：从测量值$y = \\Phi z^{\\star}$中恢复一个在标准基下$s$-稀疏的向量$z^{\\star} \\in \\mathbb{C}^p$，其中等效的传感矩阵为$\\Phi = A \\Omega^{\\ast}$。\n\n**第二步：应用通用稀疏恢复理论**\n\n压缩感知理论为这类通用采样问题提供了恢复保证。一个信号在某个基（这里是标准基）中是$s$-稀疏的，并通过一个传感矩阵$\\Phi$进行测量。当$\\Phi$是通过对某个酉矩阵的行进行随机采样并与另一个矩阵（这里是$\\Omega^\\ast$）复合而成时，成功恢复所需的测量次数$m$与两个基之间的互相关性密切相关。\n\n一个标准的结论是，为了以至少$1-\\delta$的概率精确恢复一个在维度为$p$的空间中$s$-稀疏的信号，所需的随机测量次数$m$满足：\n$$\nm \\ge C \\cdot \\mu^2 \\cdot s \\cdot \\ln(p/\\delta)\n$$\n其中，$C$是一个普适常数，而$\\mu$是测量基（傅里叶基$F$的原子$f_k$）与稀疏表示基（这里是$\\Omega^\\ast$的列，即$\\omega_j$）之间的互相关性。这个相关性正是问题中定义的：\n$$\n\\mu = \\max_{k \\in \\{1,\\dots,n\\}, j \\in \\{1,\\dots,p\\}} |\\langle f_{k}, \\omega_{j} \\rangle|\n$$\n\n**第三步：得出最终下界**\n\n将我们问题中的参数（稀疏度$s$，稀疏向量维度$p$，相关性$\\mu$，以及失败概率$\\delta$）代入上述标准公式，我们直接得到$m$的一个充分下界。因此，为保证以至少$1-\\delta$的概率唯一地恢复$x^{\\star}$，所需的最小测量次数$m$的表达式为：\n$$\nm = C \\mu^{2} s \\ln\\left(\\frac{p}{\\delta}\\right)\n$$\n这里的$C$是一个不依赖于问题其他参数的绝对常数。", "answer": "$$\n\\boxed{C \\mu^{2} s \\ln\\left(\\frac{p}{\\delta}\\right)}\n$$", "id": "3485048"}, {"introduction": "理论保证固然强大，但通过具体的例子可以更清晰地揭示其内涵。最后一个练习将呈现一个场景，在该场景中，分析和合成模型对完全相同的信号和测量值给出了不同的结果 [@problem_id:3485109]。通过完成具体的计算，您将亲身体验为何这两个模型不可互换，以及它们各自的底层假设如何导致信号恢复的成功或失败。", "problem": "考虑一个压缩感知中的有限维线性逆问题，其中测量算子为 $\\Phi \\in \\mathbb{R}^{m \\times n}$，合成字典为 $D \\in \\mathbb{R}^{n \\times q}$，分析算子为 $\\Omega \\in \\mathbb{R}^{p \\times n}$。合成模型假设信号 $x \\in \\mathbb{R}^{n}$ 具有稀疏表示 $x = D \\alpha$（其中 $\\alpha \\in \\mathbb{R}^{q}$ 为某个系数向量），并且可以通过求解 $\\min_{\\alpha} \\|\\alpha\\|_{1}$（约束条件为 $y = \\Phi D \\alpha$）来尝试重构，其中 $y \\in \\mathbb{R}^{m}$ 是测量值。分析模型假设向量 $\\Omega x$ 是稀疏的，并且可以通过求解 $\\min_{x} \\|\\Omega x\\|_{1}$（约束条件为 $y = \\Phi x$）来尝试重构。$\\Omega x$ 的余支撑集定义为 $\\Omega$ 的行索引集合，对于这些索引 $i$，有 $(\\Omega x)_{i} = 0$。\n\n构造一个反例，其中分析模型能够精确恢复信号，而合成模型却因 $\\Omega x$ 的余支撑集与 $D$ 中 $\\alpha$ 的支撑集不匹配而恢复失败，尽管测量值 $y = \\Phi x$ 是相同的。请使用以下具体设置：\n- 设 $n = 3$ 且 $m = 2$。\n- 设 $\\Phi \\in \\mathbb{R}^{2 \\times 3}$ 由下式给出\n$$\n\\Phi = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\n- 设真实信号为 $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$，因此 $y = \\Phi x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 设分析算子 $\\Omega \\in \\mathbb{R}^{2 \\times 3}$ 为\n$$\n\\Omega = \\begin{pmatrix}\n1  -1  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n- 设合成字典 $D \\in \\mathbb{R}^{3 \\times 2}$ 的列向量为 $v_{1} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 和 $v_{2} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$，即\n$$\nD = \\begin{pmatrix}\n1  0 \\\\\n1  0 \\\\\n1  1\n\\end{pmatrix}.\n$$\n\n任务：\n1. 使用分析模型，求解凸规划 $\\min_{x \\in \\mathbb{R}^{3}} \\|\\Omega x\\|_{1}$（约束条件为 $y = \\Phi x$），并确定唯一的最小化解 $x_{A}^{\\star}$。\n2. 使用合成模型，求解凸规划 $\\min_{\\alpha \\in \\mathbb{R}^{2}} \\|\\alpha\\|_{1}$（约束条件为 $y = \\Phi D \\alpha$），并确定唯一的最小化解 $x_{S}^{\\star} = D \\alpha^{\\star}$。\n3. 计算欧几里得距离的平方 $\\|x_{A}^{\\star} - x_{S}^{\\star}\\|_{2}^{2}$，并将结果表示为一个精确的实数。无需四舍五入。如果引入任何角度，请以弧度表示。\n\n你的构造必须明确展示，在相同的测量值 $y$ 下，分析模型实现了对 $x_{0}$ 的精确恢复，而合成模型未能恢复 $x_{0}$。并且从你的推导中应能清楚地看出 $\\Omega x$ 的余支撑集与 $\\alpha$ 的支撑集之间的不匹配。最终答案必须是等于 $\\|x_{A}^{\\star} - x_{S}^{\\star}\\|_{2}^{2}$ 的单个实数。", "solution": "本题旨在通过一个具体的例子，展示分析稀疏模型和合成稀疏模型在相同测量数据下可能产生不同的恢复结果。我们将分别求解两个优化问题，并比较其解。\n\n**1. 分析模型求解**\n\n分析模型的优化问题为：\n$$\n\\min_{x \\in \\mathbb{R}^{3}} \\|\\Omega x\\|_{1} \\quad \\text{约束于} \\quad \\Phi x = y\n$$\n给定的测量算子为$\\Phi = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix}$，测量值为$y = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。设$x = (x_1, x_2, x_3)^\\top$，约束条件$\\Phi x = y$意味着：\n$$\n\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n因此，任何可行解的形式必须为 $x = (1, 1, z)^\\top$，其中$z \\in \\mathbb{R}$是一个待定变量。\n\n接下来，我们最小化目标函数$f(z) = \\|\\Omega x\\|_{1}$。将$x$代入：\n$$\n\\Omega x = \\begin{pmatrix} 1  -1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ z \\end{pmatrix} = \\begin{pmatrix} 1 - 1 + 0 \\\\ 0 + 0 + z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ z \\end{pmatrix}\n$$\n目标函数变为 $\\|\\Omega x\\|_{1} = |0| + |z| = |z|$。为了使$|z|$最小，我们必须选择$z=0$。这个解是唯一的。\n因此，分析模型恢复的信号为：\n$$\nx_{A}^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n这与真实信号$x_0$完全相同，表明分析模型成功地实现了精确恢复。\n\n**2. 合成模型求解**\n\n合成模型的优化问题为：\n$$\n\\min_{\\alpha \\in \\mathbb{R}^{2}} \\|\\alpha\\|_{1} \\quad \\text{约束于} \\quad \\Phi D \\alpha = y\n$$\n首先计算等效测量矩阵 $\\Phi D$：\n$$\n\\Phi D = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\end{pmatrix}\n$$\n设$\\alpha = (\\alpha_1, \\alpha_2)^\\top$，约束条件 $\\Phi D \\alpha = y$ 变为：\n$$\n\\begin{pmatrix} 1  0 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\alpha_1 \\\\ \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} \\alpha_1 \\\\ \\alpha_1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n这要求$\\alpha_1=1$，而$\\alpha_2$可以是任意实数。可行解的形式为$\\alpha = (1, w)^\\top$，其中$w \\in \\mathbb{R}$。\n\n我们在此可行集上最小化目标函数$\\|\\alpha\\|_1 = |1| + |w| = 1 + |w|$。为了使$1+|w|$最小，我们必须选择$w=0$。这个解是唯一的。\n因此，最优的系数向量为：\n$$\n\\alpha^{\\star} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n合成模型恢复的信号由 $x_{S}^{\\star} = D \\alpha^{\\star}$ 给出：\n$$\nx_{S}^{\\star} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n这个结果与真实信号$x_0 = (1, 1, 0)^\\top$不同，表明合成模型恢复失败。\n\n**3. 计算欧几里得距离的平方**\n\n最后，我们计算两个恢复信号$x_{A}^{\\star}$和$x_{S}^{\\star}$之间的欧几里得距离的平方：\n$$\nx_{A}^{\\star} - x_{S}^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\|x_{A}^{\\star} - x_{S}^{\\star}\\|_{2}^{2} = 0^2 + 0^2 + (-1)^2 = 1\n$$\n最终结果为1。", "answer": "$$\\boxed{1}$$", "id": "3485109"}]}