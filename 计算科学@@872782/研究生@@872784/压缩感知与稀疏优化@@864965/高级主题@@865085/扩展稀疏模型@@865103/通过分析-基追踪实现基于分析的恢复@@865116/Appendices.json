{"hands_on_practices": [{"introduction": "分析零空间性质（Analysis Null Space Property, NSP）是保证分析基追踪能够唯一恢复任意分析稀疏信号的一个充分条件。对于给定的传感矩阵 $A$ 和分析算子 $\\Omega$，检验该性质是一项基础练习。[@problem_id:3431451] 这项实践将抽象的理论保证与具体的、可验证的矩阵条件联系起来，从而加深对压缩感知为何有效的理解。", "problem": "考虑压缩感知的分析模型，其中分析算子 $\\Omega \\in \\mathbb{R}^{p \\times n}$ 作用于信号 $x \\in \\mathbb{R}^{n}$，产生分析系数 $\\Omega x \\in \\mathbb{R}^{p}$。分析基追踪（Analysis Basis Pursuit, ABP）程序是一个凸优化问题，旨在寻找一个与测量值一致的解 $\\widehat{x}$，同时最小化分析系数的 $\\ell_{1}$ 范数，即，在满足 $A x = y$ 的条件下最小化 $\\|\\Omega x\\|_{1}$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是传感矩阵，$y \\in \\mathbb{R}^{m}$ 是测量向量。一个核心的理论保证由分析零空间性质（Analysis Null Space Property, Analysis NSP）提供，该性质非正式地指出，如果对于与真实分析系数相关的给定支撑集 $T \\subset \\{1,2,\\dots,p\\}$，$\\ker(A)$ 中的每个非零向量 $h$ 都满足一个严格不等式，该不等式比较了 $\\Omega h$ 在 $T$ 内部和外部的分量的 $\\ell_{1}$ 范数，那么通过ABP进行精确恢复是可能的。\n\n从基本定义开始：\n- 矩阵 $A$ 的零空间（核），记为 $\\ker(A)$，是满足 $A h = 0$ 的向量 $h$ 的集合。\n- 向量 $z \\in \\mathbb{R}^{p}$ 的 $\\ell_{1}$ 范数是 $\\|z\\|_{1} = \\sum_{i=1}^{p} |z_{i}|$。\n- 向量 $z \\in \\mathbb{R}^{p}$ 的支撑集是其非零元素对应的索引集合。\n\n关于支撑集 $T$ 的分析零空间性质（NSP）由以下不等式定义：\n$$\n\\|(\\Omega h)_{T}\\|_{1}  \\|(\\Omega h)_{T^{c}}\\|_{1}\n$$\n对于所有 $h \\in \\ker(A) \\setminus \\{0\\}$，其中 $(\\Omega h)_{T}$ 表示将 $\\Omega h$ 限制在 $T$ 中索引所形成的向量，$T^{c}$ 是 $T$ 在 $\\{1,2,\\dots,p\\}$ 中的补集。\n\n给定一个简单示例，其维度为 $n = 4$, $p = 5$，以及以下分析算子和传感矩阵：\n\n- 分析算子 $\\Omega \\in \\mathbb{R}^{5 \\times 4}$，其行为\n$$\n\\Omega =\n\\begin{bmatrix}\n1  -1  0  0 \\\\\n0  \\phantom{-}1  -1  0 \\\\\n0  0  \\phantom{-}1  -1 \\\\\n1  0  0  0 \\\\\n0  0  0  1\n\\end{bmatrix}.\n$$\n\n- 传感矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$，由其列 $a_{1}, a_{2}, a_{3}, a_{4} \\in \\mathbb{R}^{3}$ 指定，\n$$\na_{1} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\na_{2} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\quad\na_{3} = \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\end{bmatrix}, \\quad\na_{4} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix},\n$$\n因此\n$$\nA = \\begin{bmatrix}\n1  0  1  0 \\\\\n0  1  1  0 \\\\\n0  0  1  1\n\\end{bmatrix}.\n$$\n\n因为矩阵 $A$ 的秩为 $3$，其零空间 $\\ker(A)$ 是一维的，并且等于 $\\operatorname{span}\\{h_{0}\\}$，其中 $h_{0} \\in \\mathbb{R}^{4}$ 是一个非零向量。在这种情况下，$\\ker(A)$ 中的每个单位范数向量 $h$ 要么是 $h = \\frac{h_{0}}{\\|h_{0}\\|_{2}}$，要么是 $h = -\\frac{h_{0}}{\\|h_{0}\\|_{2}}$，因此，在 $\\ker(A)$ 中所有单位范数向量上验证分析NSP简化为检查这两种情况。\n\n你的任务是编写一个程序，对于每个给定的真实信号 $x^{(i)} \\in \\mathbb{R}^{4}$，构造分析系数 $\\Omega x^{(i)}$ 的支撑集 $T^{(i)} \\subset \\{1,2,3,4,5\\}$，然后验证分析NSP不等式\n$$\n\\|(\\Omega h)_{T^{(i)}}\\|_{1}  \\|(\\Omega h)_{(T^{(i)})^{c}}\\|_{1}\n$$\n对于 $\\ker(A)$ 中所有的单位范数向量 $h$ 都成立。程序应返回一个布尔值，指示该性质是否对 $h$ 和 $-h$ 都成立。\n\n使用以下真实信号测试套件：\n- 案例 1（理想情况）：$x^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{bmatrix}$。\n- 案例 2（边界条件，此时不等式变为等式，因此不成立）：$x^{(2)} = \\begin{bmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 案例 3（具有大支撑集的边缘情况）：$x^{(3)} = \\begin{bmatrix} 0 \\\\ 1 \\\\ -2 \\\\ 3 \\end{bmatrix}$。\n\n程序必须：\n- 计算 $\\ker(A)$ 的一个基，并将其归一化以获得单位向量 $h$；同时验证 $h$ 和 $-h$。\n- 对于每个案例 $i \\in \\{1,2,3\\}$，将 $T^{(i)}$ 构建为 $\\Omega x^{(i)}$ 的支撑集（非零条目的索引）。\n- 对 $h$ 和 $-h$ 评估上述严格不等式，并生成一个布尔值 $b_{i}$，当且仅当不等式在两个方向上都成立时，该值为真。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含三个布尔值 $[b_{1},b_{2},b_{3}]$，作为逗号分隔的列表并用方括号括起来，顺序与给定的三个测试案例一致。不允许有其他输出。\n\n本问题不涉及物理单位。不涉及角度。不涉及百分比。所有答案均以指定的单行最终输出格式的布尔值表示。", "solution": "目标是针对一个指定的分析算子 $\\Omega \\in \\mathbb{R}^{5 \\times 4}$ 和传感矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$，以及从三个不同的真实信号 $x^{(i)} \\in \\mathbb{R}^{4}$ 导出的支撑集，来验证分析零空间性质（Analysis NSP）。分析NSP要求对于给定的支撑集 $T$，不等式 $\\|(\\Omega h)_{T}\\|_{1}  \\|(\\Omega h)_{T^{c}}\\|_{1}$ 对 $A$ 的零空间（记为 $\\ker(A)$）中的所有非零向量 $h$ 都成立。\n\n给定的矩阵是：\n$$\n\\Omega =\n\\begin{bmatrix}\n1  -1  0  0 \\\\\n0  \\phantom{-}1  -1  0 \\\\\n0  0  \\phantom{-}1  -1 \\\\\n1  0  0  0 \\\\\n0  0  0  1\n\\end{bmatrix}, \\quad\nA = \\begin{bmatrix}\n1  0  1  0 \\\\\n0  1  1  0 \\\\\n0  0  1  1\n\\end{bmatrix}.\n$$\n问题指出 $\\ker(A)$ 是一维的。因此，验证分析NSP简化为检查张成此空间的两个单位范数向量（我们记为 $h$ 和 $-h$）是否满足该不等式。\n\n首先，我们通过求解线性系统 $A h = 0$ 来确定 $\\ker(A)$ 的一个基，其中 $h = [h_1, h_2, h_3, h_4]^T \\in \\mathbb{R}^4$。\n$$\n\\begin{cases}\nh_1 + h_3 = 0 \\\\\nh_2 + h_3 = 0 \\\\\nh_3 + h_4 = 0\n\\end{cases}\n$$\n设自由变量 $h_3 = c$，对于某个标量 $c \\in \\mathbb{R}$，我们得到 $h_1 = -c$，$h_2 = -c$，以及 $h_4 = -c$。因此，零空间中的任何向量都具有 $c \\cdot [-1, -1, 1, -1]^T$ 的形式。$\\ker(A)$ 的一个基向量是 $h_0 = [-1, -1, 1, -1]^T$。\n\n为了获得单位范数向量 $h$，我们用其欧几里得范数对 $h_0$ 进行归一化：\n$$\n\\|h_0\\|_2 = \\sqrt{(-1)^2 + (-1)^2 + 1^2 + (-1)^2} = \\sqrt{4} = 2.\n$$\n令 $h = \\frac{h_0}{\\|h_0\\|_2} = \\frac{1}{2}[-1, -1, 1, -1]^T = [-0.5, -0.5, 0.5, -0.5]^T$。$\\ker(A)$ 中所有单位范数向量的集合是 $\\{h, -h\\}$。\n\n接下来，我们计算向量 $\\Omega h$，它将用于所有测试案例：\n$$\n\\Omega h =\n\\begin{bmatrix}\n1  -1  0  0 \\\\\n0  \\phantom{-}1  -1  0 \\\\\n0  0  \\phantom{-}1  -1 \\\\\n1  0  0  0 \\\\\n0  0  0  1\n\\end{bmatrix}\n\\begin{bmatrix}\n-0.5 \\\\\n-0.5 \\\\\n0.5 \\\\\n-0.5\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1(-0.5) - 1(-0.5) \\\\\n1(-0.5) - 1(0.5) \\\\\n1(0.5) - 1(-0.5) \\\\\n1(-0.5) \\\\\n1(-0.5)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0 \\\\\n-1 \\\\\n1 \\\\\n-0.5 \\\\\n-0.5\n\\end{bmatrix}.\n$$\n用于检查 $-h$ 的向量就是 $\\Omega(-h) = -(\\Omega h) = [0, 1, -1, 0.5, 0.5]^T$。请注意，对于任何向量 $z$ 和任何索引集 $S$，$\\|(-z)_S\\|_1 = \\|z_S\\|_1$。因此，NSP不等式对 $h$ 成立当且仅当它对 $-h$ 成立。尽管如此，该过程将为每个案例正式确认这一点。\n\n我们现在开始为三个测试案例中的每一个验证分析NSP。\n\n案例 1：$x^{(1)} = [1, 1, 1, 1]^T$。\n首先，我们找到分析系数 $\\Omega x^{(1)}$：\n$$\n\\Omega x^{(1)} = \\begin{bmatrix} 1-1 \\\\ 1-1 \\\\ 1-1 \\\\ 1 \\\\ 1 \\end{bmatrix} = [0, 0, 0, 1, 1]^T.\n$$\n$\\Omega x^{(1)}$ 的支撑集由其非零元素的索引组成。按照问题描述中使用基于1的索引，支撑集为 $T^{(1)} = \\{4, 5\\}$。其补集是 $(T^{(1)})^c = \\{1, 2, 3\\}$。\n我们根据 $T^{(1)}$ 和 $(T^{(1)})^c$ 分割向量 $\\Omega h = [0, -1, 1, -0.5, -0.5]^T$：\n$$\n\\|(\\Omega h)_{T^{(1)}}\\|_1 = \\|[-0.5, -0.5]^T\\|_1 = |-0.5| + |-0.5| = 1.\n$$\n$$\n\\|(\\Omega h)_{(T^{(1)})^c}\\|_1 = \\|[0, -1, 1]^T\\|_1 = |0| + |-1| + |1| = 2.\n$$\nNSP不等式为 $1  2$，这是成立的。如前所述，该不等式对 $-h$ 也成立。因此，对于此案例，布尔结果是 $b_1 = \\text{True}$。\n\n案例 2：$x^{(2)} = [2, 1, 0, 0]^T$。\n分析系数为：\n$$\n\\Omega x^{(2)} = \\begin{bmatrix} 2-1 \\\\ 1-0 \\\\ 0-0 \\\\ 2 \\\\ 0 \\end{bmatrix} = [1, 1, 0, 2, 0]^T.\n$$\n支撑集为 $T^{(2)} = \\{1, 2, 4\\}$。补集是 $(T^{(2)})^c = \\{3, 5\\}$。\n我们用 $\\Omega h = [0, -1, 1, -0.5, -0.5]^T$ 检查不等式：\n$$\n\\|(\\Omega h)_{T^{(2)}}\\|_1 = \\|[0, -1, -0.5]^T\\|_1 = |0| + |-1| + |-0.5| = 1.5.\n$$\n$$\n\\|(\\Omega h)_{(T^{(2)})^c}\\|_1 = \\|[1, -0.5]^T\\|_1 = |1| + |-0.5| = 1.5.\n$$\nNSP不等式为 $1.5  1.5$，这是不成立的。该性质不成立。布尔结果是 $b_2 = \\text{False}$。\n\n案例 3：$x^{(3)} = [0, 1, -2, 3]^T$。\n分析系数为：\n$$\n\\Omega x^{(3)} = \\begin{bmatrix} 0-1 \\\\ 1-(-2) \\\\ -2-3 \\\\ 0 \\\\ 3 \\end{bmatrix} = [-1, 3, -5, 0, 3]^T.\n$$\n支撑集为 $T^{(3)} = \\{1, 2, 3, 5\\}$。补集是 $(T^{(3)})^c = \\{4\\}$。\n我们用 $\\Omega h = [0, -1, 1, -0.5, -0.5]^T$ 检查不等式：\n$$\n\\|(\\Omega h)_{T^{(3)}}\\|_1 = \\|[0, -1, 1, -0.5]^T\\|_1 = |0| + |-1| + |1| + |-0.5| = 2.5.\n$$\n$$\n\\|(\\Omega h)_{(T^{(3)})^c}\\|_1 = \\|[-0.5]^T\\|_1 = |-0.5| = 0.5.\n$$\nNSP不等式为 $2.5  0.5$，这是不成立的。该性质不成立。布尔结果是 $b_3 = \\text{False}$。\n\n总之，分析NSP对于从 $x^{(1)}$ 导出的支撑集成立，但对于从 $x^{(2)}$ 和 $x^{(3)}$ 导出的支撑集不成立。最终的布尔结果是 $[b_1, b_2, b_3] = [\\text{True}, \\text{False}, \\text{False}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Verifies the Analysis Null Space Property (Analysis NSP) for a given\n    setup and three test cases.\n    \"\"\"\n    # Define the analysis operator Omega and the sensing matrix A.\n    Omega = np.array([\n        [1, -1, 0, 0],\n        [0, 1, -1, 0],\n        [0, 0, 1, -1],\n        [1, 0, 0, 0],\n        [0, 0, 0, 1]\n    ], dtype=np.float64)\n\n    A = np.array([\n        [1, 0, 1, 0],\n        [0, 1, 1, 0],\n        [0, 0, 1, 1]\n    ], dtype=np.float64)\n\n    # Define the three ground-truth signals for the test cases.\n    test_cases = [\n        np.array([1, 1, 1, 1], dtype=np.float64),\n        np.array([2, 1, 0, 0], dtype=np.float64),\n        np.array([0, 1, -2, 3], dtype=np.float64)\n    ]\n\n    # Compute a unit-norm basis vector for the 1D null space of A.\n    # scipy.linalg.null_space returns an orthonormal basis as columns of a matrix.\n    # For a 1D null space, this is a single column vector of unit norm.\n    h = null_space(A).flatten()\n\n    results = []\n    for x in test_cases:\n        # Step 1: Compute analysis coefficients and determine the support set T.\n        omega_x = Omega @ x\n        \n        # The support T is the set of indices where omega_x is non-zero.\n        # A small tolerance is used for robust floating-point comparison.\n        tol = 1e-9\n        support_indices_T = np.where(np.abs(omega_x) > tol)[0]\n\n        # Step 2: Verify the Analysis NSP inequality for both h and -h.\n        \n        # Check for h: ||(Omega h)_T||_1  ||(Omega h)_Tc||_1\n        omega_h = Omega @ h\n        \n        # Partition omega_h into components inside and outside the support T.\n        all_indices = np.arange(Omega.shape[0])\n        support_indices_Tc = np.setdiff1d(all_indices, support_indices_T, assume_unique=True)\n\n        omega_h_T = omega_h[support_indices_T]\n        omega_h_Tc = omega_h[support_indices_Tc]\n\n        # Calculate the l1 norms of the partitions.\n        norm_T_h = np.sum(np.abs(omega_h_T))\n        norm_Tc_h = np.sum(np.abs(omega_h_Tc))\n        \n        # Evaluate the strict inequality for h.\n        holds_for_h = norm_T_h  norm_Tc_h\n\n        # Check for -h: ||(Omega (-h))_T||_1  ||(Omega (-h))_Tc||_1\n        # Since ||(-z)_S||_1 = ||z_S||_1, the result is identical to the one for h.\n        # This check is included for formal completeness as per the problem statement.\n        omega_minus_h = -omega_h\n        omega_minus_h_T = omega_minus_h[support_indices_T]\n        omega_minus_h_Tc = omega_minus_h[support_indices_Tc]\n\n        norm_T_minus_h = np.sum(np.abs(omega_minus_h_T))\n        norm_Tc_minus_h = np.sum(np.abs(omega_minus_h_Tc))\n\n        holds_for_minus_h = norm_T_minus_h  norm_Tc_minus_h\n        \n        # The property must hold for all unit-norm vectors in ker(A), i.e., for both h and -h.\n        final_boolean = holds_for_h and holds_for_minus_h\n        results.append(final_boolean)\n\n    # Format the final output string as specified.\n    # Python's str(True) is 'True', str(False) is 'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3431451"}, {"introduction": "Karush-Kuhn-Tucker (KKT) 条件是凸优化问题最优解的一阶充要条件。[@problem_id:3431448] 我们可以通过检查 KKT 条件，来严格验证分析基追踪问题的任一候选解是否为最优解。这项练习超越了简单地运行求解器，它要求我们利用次梯度和拉格朗日乘子等概念，深入探究解的数学结构。", "problem": "考虑压缩感知和稀疏优化中的分析基追踪规划：在线性等式约束下，最小化分析系数的一范数。具体来说，考虑以下问题\n$$\n\\min_{x \\in \\mathbb{R}^{4}} \\|\\Omega x\\|_{1} \\quad \\text{subject to} \\quad A x = y,\n$$\n其中分析算子 $\\Omega \\in \\mathbb{R}^{3 \\times 4}$ 是一阶差分算子\n$$\n\\Omega = \\begin{pmatrix}\n1  -1  0  0 \\\\\n0  1  -1  0 \\\\\n0  0  1  -1\n\\end{pmatrix},\n$$\n测量矩阵 $A \\in \\mathbb{R}^{2 \\times 4}$ 为\n$$\nA = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  0  0  1\n\\end{pmatrix},\n$$\n测量向量 $y \\in \\mathbb{R}^{2}$ 为\n$$\ny = \\begin{pmatrix}\n2 \\\\\n3\n\\end{pmatrix}.\n$$\n考虑由下式给出的候选原始点 $x^{\\star} \\in \\mathbb{R}^{4}$\n$$\nx^{\\star} = \\begin{pmatrix}\n2 \\\\\n2 \\\\\n3 \\\\\n3\n\\end{pmatrix}.\n$$\n从等式约束问题的凸优化基本原理出发——具体来说，即针对具有非光滑目标的凸规划的 Karush-Kuhn-Tucker (KKT) 条件以及一范数的次梯度刻画——执行以下操作：\n\n- 确定一个与 $x^{\\star}$ 处的分析系数一致的次梯度向量 $s \\in \\partial \\|\\Omega x^{\\star}\\|_{1}$，并强制要求 $s$ 的每个分量都位于区间 $[-1,1]$ 内。\n- 使用由一范数目标和等式约束构成的拉格朗日函数的 KKT 平稳性条件，求解一个拉格朗日乘子向量 $\\lambda \\in \\mathbb{R}^{2}$，使得对于 $x^{\\star}$ 处某个有效的 $s$ 选择，平稳性条件成立。\n- 对于配对 $(x^{\\star}, \\lambda)$ 和构造出的 $s$，验证原始可行性、对偶可行性和互补松弛性。\n\n计算满足这些条件的拉格朗日乘子向量 $\\lambda$ 的显式值。使用 $\\mathrm{pmatrix}$ 环境将你的最终答案表示为行向量。无需四舍五入。", "solution": "该问题旨在通过找到一个满足 Karush-Kuhn-Tucker (KKT) 条件的相应拉格朗日乘子向量 $\\lambda$，来验证给定点 $x^{\\star}$ 是否为分析基追踪优化规划的一个解。该优化问题表述如下：\n$$\n\\min_{x \\in \\mathbb{R}^{4}} \\|\\Omega x\\|_{1} \\quad \\text{subject to} \\quad A x = y\n$$\n这是一个凸优化问题，其目标函数 $f(x) = \\|\\Omega x\\|_{1}$ 非光滑，并带有仿射等式约束 $h(x) = Ax - y = 0$。KKT 条件为此类问题提供了充要最优性条件。要使一个点 $x^{\\star}$ 是最优的，必须存在一个拉格朗日乘子向量 $\\lambda$，使得以下条件成立：\n\n$1$. **原始可行性：** $A x^{\\star} = y$\n$2$. **平稳性：** $0 \\in \\partial_{x} L(x^{\\star}, \\lambda)$，其中 $L(x, \\lambda) = \\|\\Omega x\\|_{1} + \\lambda^T(Ax - y)$ 是拉格朗日函数。\n\n拉格朗日函数关于 $x$ 的次微分由 $\\partial_{x} L(x, \\lambda) = \\partial (\\|\\Omega x\\|_{1}) + A^T \\lambda$ 给出。使用次梯度的链式法则，我们有 $\\partial (\\|\\Omega x\\|_{1}) = \\Omega^T \\partial (\\|z\\|_{1})$，其中 $z = \\Omega x$。因此，平稳性条件变为：\n$$\n0 \\in \\Omega^T \\partial (\\|\\Omega x^{\\star}\\|_{1}) + A^T \\lambda\n$$\n这等价于存在一个向量 $s \\in \\partial (\\|\\Omega x^{\\star}\\|_{1})$，使得：\n$$\n\\Omega^T s + A^T \\lambda = 0\n$$\n\n我们现在将对给定的问题数据验证这些条件。\n\n**步骤 1：验证原始可行性**\n我们必须检查是否 $A x^{\\star} = y$。给定的量如下：\n$$\nA = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix}, \\quad x^{\\star} = \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\\\ 3 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}\n$$\n执行矩阵-向量乘法：\n$$\nA x^{\\star} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (1)(2) + (0)(2) + (0)(3) + (0)(3) \\\\ (0)(2) + (0)(2) + (0)(3) + (1)(3) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}\n$$\n由于 $A x^{\\star} = y$，原始可行性条件得到满足。\n\n**步骤 2：为平稳性条件刻画次梯度**\n首先，我们计算分析系数向量 $z^{\\star} = \\Omega x^{\\star}$：\n$$\nz^{\\star} = \\Omega x^{\\star} = \\begin{pmatrix} 1  -1  0  0 \\\\ 0  1  -1  0 \\\\ 0  0  1  -1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 2 - 2 \\\\ 2 - 3 \\\\ 3 - 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n$\\ell_1$范数 $\\|z\\|_{1} = \\sum_{i} |z_i|$ 的次微分是所有向量 $s$ 的集合，其分量 $s_i$ 满足：\n$$\ns_i = \\begin{cases} \\text{sgn}(z_i)  \\text{if } z_i \\neq 0 \\\\ c_i \\in [-1, 1]  \\text{if } z_i = 0 \\end{cases}\n$$\n对于我们的向量 $z^{\\star} = (0, -1, 0)^T$，一个向量 $s = (s_1, s_2, s_3)^T$ 属于 $\\partial \\|z^{\\star}\\|_{1}$ 当且仅当：\n- $s_1 \\in [-1, 1]$ (因为 $z^{\\star}_1 = 0$)\n- $s_2 = \\text{sgn}(-1) = -1$\n- $s_3 \\in [-1, 1]$ (因为 $z^{\\star}_3 = 0$)\n\n$s$ 的每个分量都位于区间 $[-1, 1]$ 内的条件，有时被称为次梯度变量的对偶可行性。对于 $z^{\\star}$ 的非零分量，这个条件自然满足，而对于零分量，它则成为一个选择约束。\n\n**步骤 3：使用平稳性条件求解拉格朗日乘子 $\\lambda$**\n平稳性条件是 $\\Omega^T s + A^T \\lambda = 0$，对于某个 $s \\in \\partial \\|z^{\\star}\\|_{1}$ 和某个 $\\lambda \\in \\mathbb{R}^2$。设 $\\lambda = (\\lambda_1, \\lambda_2)^T$。我们写出矩阵：\n$$\n\\Omega^T = \\begin{pmatrix} 1  0  0 \\\\ -1  1  0 \\\\ 0  -1  1 \\\\ 0  0  -1 \\end{pmatrix}, \\quad A^T = \\begin{pmatrix} 1  0 \\\\ 0  0 \\\\ 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n代入平稳性方程：\n$$\n\\begin{pmatrix} 1  0  0 \\\\ -1  1  0 \\\\ 0  -1  1 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} s_1 \\\\ -1 \\\\ s_3 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  0 \\\\ 0  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了一个关于未知数 $s_1$、$s_3$、$\\lambda_1$ 和 $\\lambda_2$ 的四元线性方程组：\n1. $s_1 + \\lambda_1 = 0$\n2. $-s_1 + (1)(-1) = -s_1 - 1 = 0$\n3. $(-1)(-1) + s_3 = 1 + s_3 = 0$\n4. $-s_3 + \\lambda_2 = 0$\n\n我们可以解这个方程组。\n由方程(2)：$-s_1 - 1 = 0 \\implies s_1 = -1$。这个值与次梯度条件 $s_1 \\in [-1, 1]$ 一致。\n由方程(3)：$1 + s_3 = 0 \\implies s_3 = -1$。这个值也与次梯度条件 $s_3 \\in [-1, 1]$ 一致。\n\n现在我们已经确定了在 $x^{\\star}$ 处要使 KKT 条件成立所需的特定次梯度向量 $s = (-1, -1, -1)^T$。我们现在可以使用剩下的方程来求解 $\\lambda_1$ 和 $\\lambda_2$。\n由方程(1)：$s_1 + \\lambda_1 = 0 \\implies -1 + \\lambda_1 = 0 \\implies \\lambda_1 = 1$。\n由方程(4)：$-s_3 + \\lambda_2 = 0 \\implies -(-1) + \\lambda_2 = 0 \\implies 1 + \\lambda_2 = 0 \\implies \\lambda_2 = -1$。\n\n因此，我们找到了一个拉格朗日乘子向量 $\\lambda = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n**步骤 4：最终验证**\n我们找到了一个配对 $(x^{\\star}, \\lambda)$ 和一个次梯度 $s$，它们同时满足所有 KKT 条件：\n- **原始可行性：** $A x^{\\star} = y$ (已验证)。\n- **平稳性：** $\\Omega^T s + A^T \\lambda = 0$ 对于 $x^{\\star} = (2, 2, 3, 3)^T$、$\\lambda = (1, -1)^T$ 和 $s = (-1, -1, -1)^T$ 成立。\n- **对偶可行性/互补松弛性：** 次梯度 $s$ 是有效的，因为 $s \\in \\partial \\|\\Omega x^{\\star}\\|_{1}$。分量 $s_1 = -1$ 和 $s_3 = -1$ 位于所需的区间 $[-1, 1]$ 内，且 $s_2 = -1$ 与 $\\text{sgn}((\\Omega x^{\\star})_2)$ 相匹配。\n\n由于所有 KKT 条件都得到满足，点 $x^{\\star}$ 是该问题的最小化子，并且相应的拉格朗日乘子向量是 $\\lambda = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。题目要求的就是这个显式值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  -1\n\\end{pmatrix}\n}\n$$", "id": "3431448"}, {"introduction": "稀疏恢复主要可以在两种模型下构建：分析模型（信号在经过算子 $\\Omega$ 作用后变得稀疏，即 $\\Omega x$）和合成模型（信号由字典原子 $D$ 的稀疏组合合成，即 $D \\alpha$）。[@problem_id:3431447] 尽管这两个模型相关，但它们并非等价，尤其当分析算子 $\\Omega$ 是一个过完备框架时。本练习提供了一个具体的例子，其中分析基追踪（ABP）和合成基追踪（sBP）对相同的测量数据产生了不同的恢复结果，从而凸显了这两种基本方法之间的关键区别。", "problem": "考虑以下分析与合成的稀疏恢复设定。设 $\\Omega \\in \\mathbb{R}^{p \\times n}$ 是一个 $p  n$ 的过完备紧框架，并设 $A \\in \\mathbb{R}^{m \\times n}$ 是一个测量矩阵。您将比较在相同测量值 $y \\in \\mathbb{R}^{m}$ 下，通过分析基追踪 (ABP) 和合成基追踪 (synthesis BP) 获得的重建结果。\n\n基本和核心定义：\n- 框架界为 $1$ 的紧框架（帕塞瓦尔紧框架）是一个矩阵 $\\Omega \\in \\mathbb{R}^{p \\times n}$，满足 $\\Omega^{\\top} \\Omega = I_n$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n- 在分析模型中，当 $\\Omega x$ 是稀疏时，称未知信号 $x \\in \\mathbb{R}^{n}$ 是分析稀疏的。分析基追踪 (ABP) 估计器被定义为一个凸规划问题的解，该问题在满足测量一致性的约束下，最小化分析系数的 $\\ell_1$ 范数。\n- 在合成模型中，信号 $x$ 被表示为 $x = D \\alpha$，其中 $D \\in \\mathbb{R}^{n \\times p}$ 是一个字典，$\\alpha \\in \\mathbb{R}^{p}$ 是一个稀疏系数向量。合成基追踪估计器在满足测量一致性的约束下，最小化合成系数的 $\\ell_1$ 范数。\n\n显式构造：\n- 设 $n = 2$，$p = 3$，并通过取角度为 $0$、$120$ 和 $240$ 度的三个单位方向来定义一个帕塞瓦尔紧框架 $\\Omega \\in \\mathbb{R}^{3 \\times 2}$（角度仅用于构造说明；程序中无需进行角度计算），并对其进行缩放以满足 $\\Omega^{\\top} \\Omega = I_2$。一个显式的选择是\n$$\n\\Omega = \\begin{bmatrix}\n\\sqrt{\\tfrac{2}{3}}  0 \\\\\n-\\tfrac{1}{2} \\sqrt{\\tfrac{2}{3}}  \\tfrac{\\sqrt{3}}{2} \\sqrt{\\tfrac{2}{3}} \\\\\n-\\tfrac{1}{2} \\sqrt{\\tfrac{2}{3}}  -\\tfrac{\\sqrt{3}}{2} \\sqrt{\\tfrac{2}{3}}\n\\end{bmatrix}.\n$$\n根据构造，有 $\\Omega^{\\top} \\Omega = I_2$。设 $D = \\Omega^{\\top} \\in \\mathbb{R}^{2 \\times 3}$ 为与该框架关联的合成字典。\n\n测量与估计器：\n- 给定 $A \\in \\mathbb{R}^{m \\times n}$ 和 $y \\in \\mathbb{R}^{m}$，将 ABP 估计器定义为\n$$\n\\widehat{x}_{\\mathrm{ABP}} \\in \\operatorname*{arg\\,min}_{x \\in \\mathbb{R}^{n}} \\|\\Omega x\\|_{1} \\quad \\text{subject to} \\quad A x = y.\n$$\n- 将合成 BP 估计器（其中 $D = \\Omega^{\\top}$）定义为\n$$\n\\widehat{x}_{\\mathrm{SBP}} = D \\widehat{\\alpha}, \\quad \\text{where} \\quad \\widehat{\\alpha} \\in \\operatorname*{arg\\,min}_{\\alpha \\in \\mathbb{R}^{p}} \\|\\alpha\\|_{1} \\quad \\text{subject to} \\quad A D \\alpha = y.\n$$\n\n您的任务：\n1. 通过直接检验 $\\Omega^{\\top} \\Omega = I_2$ 来验证给定的 $\\Omega$ 是一个帕塞瓦尔紧框架。\n2. 从第一性原理出发，仅根据上述核心定义，将两种估计器实现为凸优化问题。您不得使用预封装的稀疏恢复求解器。您的实现必须依赖于一个科学上合理的凸优化过程，该过程需与核心定义中所定义的线性规划和 $\\ell_1$ 范数最小化相一致。\n3. 为指定的测量矩阵和测量向量测试套件，生成显式的数值重建结果 $\\widehat{x}_{\\mathrm{ABP}}$ 和 $\\widehat{x}_{\\mathrm{SBP}}$。您必须通过将定义正确地映射到优化问题并精确求解（在数值容差范围内）来确保科学真实性。\n\n测试套件：\n- 使用上述固定的框架 $\\Omega$ 和字典 $D = \\Omega^{\\top}$。对于每个测试用例，$A$ 是一个 $m \\times 2$ 矩阵，$y$ 是一个 $m$ 维向量。为以下四种情况计算 $\\widehat{x}_{\\mathrm{ABP}}$ 和 $\\widehat{x}_{\\mathrm{SBP}}$：\n    1. $A = \\begin{bmatrix} 0  1 \\end{bmatrix}$，$y = \\begin{bmatrix} 1 \\end{bmatrix}$。\n    2. $A = \\begin{bmatrix} 0  1 \\end{bmatrix}$，$y = \\begin{bmatrix} -1 \\end{bmatrix}$。\n    3. $A = \\begin{bmatrix} 1  1 \\end{bmatrix}$，$y = \\begin{bmatrix} 1 \\end{bmatrix}$。\n    4. $A = \\begin{bmatrix} 1  0 \\end{bmatrix}$，$y = \\begin{bmatrix} 0 \\end{bmatrix}$。\n\n答案规格和输出格式：\n- 对于四个测试用例中的每一个，输出二维重建结果。最终的程序输出必须是单行，包含一个由方括号括起来的、用逗号分隔的列表，并按以下确切顺序汇总所有四个测试用例的结果：\n$$\n\\big[ \\widehat{x}_{\\mathrm{ABP},1}^{(1)}, \\widehat{x}_{\\mathrm{ABP},2}^{(1)}, \\widehat{x}_{\\mathrm{SBP},1}^{(1)}, \\widehat{x}_{\\mathrm{SBP},2}^{(1)}, \\widehat{x}_{\\mathrm{ABP},1}^{(2)}, \\widehat{x}_{\\mathrm{ABP},2}^{(2)}, \\widehat{x}_{\\mathrm{SBP},1}^{(2)}, \\widehat{x}_{\\mathrm{SBP},2}^{(2)}, \\widehat{x}_{\\mathrm{ABP},1}^{(3)}, \\widehat{x}_{\\mathrm{ABP},2}^{(3)}, \\widehat{x}_{\\mathrm{SBP},1}^{(3)}, \\widehat{x}_{\\mathrm{SBP},2}^{(3)}, \\widehat{x}_{\\mathrm{ABP},1}^{(4)}, \\widehat{x}_{\\mathrm{ABP},2}^{(4)}, \\widehat{x}_{\\mathrm{SBP},1}^{(4)}, \\widehat{x}_{\\mathrm{SBP},2}^{(4)} \\big],\n$$\n其中 $\\widehat{x}_{\\mathrm{ABP},j}^{(i)}$ 是测试用例 $i$ 的 ABP 重建结果的第 $j$ 个分量，而 $\\widehat{x}_{\\mathrm{SBP},j}^{(i)}$ 是测试用例 $i$ 的合成 BP 重建结果的第 $j$ 个分量。\n- 所有数值答案必须是实数（浮点数）。不涉及任何物理单位或角度单位。\n- 您的程序必须是完整且可直接运行的，不得读取输入，并且必须以指定格式精确打印一行输出。\n\n覆盖要求：\n- 选择这四个测试用例是为了探究不同的行为：一个 ABP 和合成 BP 产生不同重建结果的情况，一个符号翻转的变体，一个耦合测量的情况，以及一个零测量边界情况。您的实现必须按指定的确切顺序计算并返回所有四种情况的重建结果。", "solution": "用户提供了一个在稀疏优化和压缩感知领域中定义明确的问题。该问题具有科学依据、内容自洽，并且所有术语都得到了正式定义。任务是针对一个具体的问题实例，比较两种标准估计器：分析基追踪 (ABP) 和合成基追踪 (sBP)。\n\n### 步骤 1：提取给定条件\n- **框架与字典**：由下式给出的一个帕塞瓦尔紧框架 $\\Omega \\in \\mathbb{R}^{3 \\times 2}$\n$$ \\Omega = \\begin{bmatrix} \\sqrt{\\tfrac{2}{3}}  0 \\\\ -\\tfrac{1}{2} \\sqrt{\\tfrac{2}{3}}  \\tfrac{\\sqrt{3}}{2} \\sqrt{\\tfrac{2}{3}} \\\\ -\\tfrac{1}{2} \\sqrt{\\tfrac{2}{3}}  -\\tfrac{\\sqrt{3}}{2} \\sqrt{\\tfrac{2}{3}} \\end{bmatrix}. $$\n合成字典为 $D = \\Omega^{\\top} \\in \\mathbb{R}^{2 \\times 3}$。\n- **分析基追踪 (ABP) 估计器**：\n$$ \\widehat{x}_{\\mathrm{ABP}} \\in \\operatorname*{arg\\,min}_{x \\in \\mathbb{R}^{n}} \\|\\Omega x\\|_{1} \\quad \\text{subject to} \\quad A x = y. $$\n- **合成基追踪 (sBP) 估计器**：\n$$ \\widehat{x}_{\\mathrm{SBP}} = D \\widehat{\\alpha}, \\quad \\text{where} \\quad \\widehat{\\alpha} \\in \\operatorname*{arg\\,min}_{\\alpha \\in \\mathbb{R}^{p}} \\|\\alpha\\|_{1} \\quad \\text{subject to} \\quad A D \\alpha = y. $$\n- **维度**：$n=2$, $p=3$。\n- **测试套件**：针对测量矩阵 $A \\in \\mathbb{R}^{m \\times 2}$ 和测量向量 $y \\in \\mathbb{R}^{m}$ 的四种情况。\n    1. $A = \\begin{bmatrix} 0  1 \\end{bmatrix}$, $y = \\begin{bmatrix} 1 \\end{bmatrix}$。\n    2. $A = \\begin{bmatrix} 0  1 \\end{bmatrix}$, $y = \\begin{bmatrix} -1 \\end{bmatrix}$。\n    3. $A = \\begin{bmatrix} 1  1 \\end{bmatrix}$, $y = \\begin{bmatrix} 1 \\end{bmatrix}$。\n    4. $A = \\begin{bmatrix} 1  0 \\end{bmatrix}$, $y = \\begin{bmatrix} 0 \\end{bmatrix}$。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据指定标准对问题进行评估：\n- **科学依据**：该问题植根于压缩感知和凸优化的既定理论。基追踪是该领域的一个基础概念。所有定义都是标准的。\n- **适定性**：该问题是适定的。在一个凸集（由线性约束定义的仿射子空间）上最小化一个凸函数（$\\ell_1$ 范数）是一个凸优化问题，这保证了解的存在性。解可能不唯一，但解集中的任何元素都是有效答案。\n- **客观性**：问题采用精确的数学语言陈述，没有任何主观性或模糊性。\n- **任务验证**：第一个任务是验证 $\\Omega$ 是一个帕塞瓦尔紧框架，即 $\\Omega^{\\top} \\Omega = I_2$。\n$$ \\Omega^{\\top}\\Omega = \\begin{bmatrix} \\sqrt{\\tfrac{2}{3}}  -\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}}  -\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}} \\\\ 0  \\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}}  -\\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}} \\end{bmatrix} \\begin{bmatrix} \\sqrt{\\tfrac{2}{3}}  0 \\\\ -\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}}  \\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}} \\\\ -\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}}  -\\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}} \\end{bmatrix} $$\n(1,1) 元素为 $(\\sqrt{\\tfrac{2}{3}})^2 + (-\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}})^2 + (-\\tfrac{1}{2}\\sqrt{\\tfrac{2}{3}})^2 = \\tfrac{2}{3} + \\tfrac{1}{4}\\tfrac{2}{3} + \\tfrac{1}{4}\\tfrac{2}{3} = \\tfrac{2}{3}(1 + \\tfrac{1}{4} + \\tfrac{1}{4}) = \\tfrac{2}{3}(\\tfrac{3}{2}) = 1$。\n(2,2) 元素为 $0 + (\\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}})^2 + (-\\tfrac{\\sqrt{3}}{2}\\sqrt{\\tfrac{2}{3}})^2 = \\tfrac{3}{4}\\tfrac{2}{3} + \\tfrac{3}{4}\\tfrac{2}{3} = \\tfrac{1}{2} + \\tfrac{1}{2} = 1$。\n通过类似计算可知非对角线元素为零。因此，$\\Omega^{\\top}\\Omega = I_2$ 得到验证。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个完整的解决方案。\n\n### 基于原理的设计与求解\n这个问题的核心是求解两个 $\\ell_1$ 最小化问题。一种尊重“第一性原理”要求的标准技术是，将这些问题重新表述为线性规划 (LP)。LP 问题是指在线性等式和不等式约束下，最小化一个线性目标函数。\n\n**作为线性规划的分析基追踪 (ABP)**\nABP 问题是 $\\min_{x} \\|\\Omega x\\|_{1}$，约束条件为 $A x = y$。$\\ell_1$ 范数目标函数不是线性的。我们引入一个辅助变量 $u \\in \\mathbb{R}^{p}$，其中对于每个 $i \\in \\{1, \\dots, p\\}$，都有 $u_i \\ge |(\\Omega x)_i|$。目标函数变为最小化 $\\sum_{i=1}^p u_i = \\mathbf{1}^{\\top}u$。条件 $u_i \\ge |(\\Omega x)_i|$ 等价于一对线性不等式 $(\\Omega x)_i \\le u_i$ 和 $-(\\Omega x)_i \\le u_i$。\n优化变量成为一个串联向量 $v = [x^{\\top}, u^{\\top}]^{\\top} \\in \\mathbb{R}^{n+p}$。ABP 问题被转换为以下 LP：\n$$\n\\begin{aligned}\n\\operatorname*{minimize}_{v=[x, u]} \\quad  \\mathbf{0}^{\\top}x + \\mathbf{1}^{\\top}u \\\\\n\\text{subject to} \\quad  A x = y \\\\\n \\Omega x - u \\le \\mathbf{0} \\\\\n -\\Omega x - u \\le \\mathbf{0} \\\\\n\\end{aligned}\n$$\n这个 LP 问题可以使用标准求解器来解决。所求的估计值 $\\widehat{x}_{\\mathrm{ABP}}$ 由最优向量 $v$ 的前 $n$ 个分量组成。变量 $u_i$ 必须为非负，这已由约束隐式处理，但为了稳健性可以显式声明。\n\n**作为线性规划的合成基追踪 (sBP)**\nsBP 问题是 $\\min_{\\alpha} \\|\\alpha\\|_{1}$，约束条件为 $(AD)\\alpha = y$。其结构与 ABP 相同，但变量和矩阵不同。设 $B = AD$。我们引入一个辅助变量 $v \\in \\mathbb{R}^p$，使得 $v_i \\ge |\\alpha_i|$。\n优化变量成为 $w = [\\alpha^{\\top}, v^{\\top}]^{\\top} \\in \\mathbb{R}^{2p}$。sBP 问题被转换为以下 LP：\n$$\n\\begin{aligned}\n\\operatorname*{minimize}_{w=[\\alpha, v]} \\quad  \\mathbf{0}^{\\top}\\alpha + \\mathbf{1}^{\\top}v \\\\\n\\text{subject to} \\quad  B \\alpha = y \\\\\n \\alpha - v \\le \\mathbf{0} \\\\\n -\\alpha - v \\le \\mathbf{0} \\\\\n\\end{aligned}\n$$\n在求解此 LP 得到最优的 $w$ 后，我们提取系数向量 $\\widehat{\\alpha}$（前 $p$ 个分量），并计算最终估计值 $\\widehat{x}_{\\mathrm{SBP}} = D \\widehat{\\alpha}$。和之前一样，$v_i$ 是非负的。\n\n该实现将使用 `scipy.optimize.linprog` 为每个测试用例求解这些 LP 问题。对于解不唯一的问题（例如，当稀疏系数的可行集是一条线段时），LP 求解器将返回解集的一个顶点，这是一个有效的解。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_abp(Omega, A, y):\n    \"\"\"\n    Solves the Analysis-Basis Pursuit problem by reformulating it as a Linear Program.\n\n    min_x ||Omega x||_1  s.t. Ax = y\n\n    This is converted to:\n    min_{x, u} sum(u)\n    s.t. Ax = y\n         -u = Omega x = u\n    \n    The optimization variables are [x, u].\n    \"\"\"\n    m, n = A.shape\n    p = Omega.shape[0]\n\n    # Objective function: minimize sum(u), coefficients are 0 for x and 1 for u.\n    c = np.concatenate([np.zeros(n), np.ones(p)])\n\n    # Equality constraints: Ax = y\n    # In matrix form for variables [x, u]: [A, 0] @ [x, u]^T = y\n    A_eq = np.hstack([A, np.zeros((m, p))])\n    b_eq = y\n\n    # Inequality constraints:\n    # Omega x - u = 0\n    # -Omega x - u = 0\n    A_ub = np.vstack([\n        np.hstack([Omega, -np.identity(p)]),\n        np.hstack([-Omega, -np.identity(p)])\n    ])\n    b_ub = np.zeros(2 * p)\n\n    # Bounds: x components are unbounded, u components are non-negative.\n    bounds = [(None, None)] * n + [(0, None)] * p\n    \n    # Solve the LP\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n    \n    # The solution for x are the first n variables\n    x_hat = res.x[:n]\n    return x_hat\n\ndef solve_sbp(D, A, y):\n    \"\"\"\n    Solves the Synthesis-Basis Pursuit problem by reformulating it as a Linear Program.\n\n    min_alpha ||alpha||_1  s.t. A*D*alpha = y\n\n    This is converted to:\n    min_{alpha, v} sum(v)\n    s.t. A*D*alpha = y\n         -v = alpha = v\n    \n    The optimization variables are [alpha, v].\n    \"\"\"\n    n, p = D.shape\n    m = A.shape[0]\n    B = A @ D\n\n    # Objective function: minimize sum(v), coefficients are 0 for alpha and 1 for v.\n    c = np.concatenate([np.zeros(p), np.ones(p)])\n\n    # Equality constraints: B*alpha = y\n    # In matrix form for variables [alpha, v]: [B, 0] @ [alpha, v]^T = y\n    A_eq = np.hstack([B, np.zeros((m, p))])\n    b_eq = y\n\n    # Inequality constraints:\n    # alpha - v = 0\n    # -alpha - v = 0\n    A_ub = np.vstack([\n        np.hstack([np.identity(p), -np.identity(p)]),\n        np.hstack([-np.identity(p), -np.identity(p)])\n    ])\n    b_ub = np.zeros(2 * p)\n\n    # Bounds: alpha components are unbounded, v components are non-negative.\n    bounds = [(None, None)] * p + [(0, None)] * p\n\n    # Solve the LP\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n    \n    # The solution for alpha are the first p variables\n    alpha_hat = res.x[:p]\n    x_hat = D @ alpha_hat\n    return x_hat\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and generate the final output.\n    \"\"\"\n    # Define the Parseval tight frame Omega and the dictionary D\n    s23 = np.sqrt(2/3)\n    Omega = np.array([\n        [s23, 0],\n        [-0.5 * s23, 0.5 * np.sqrt(3) * s23],\n        [-0.5 * s23, -0.5 * np.sqrt(3) * s23]\n    ])\n    D = Omega.T\n\n    # Define the test cases\n    test_cases = [\n        (np.array([[0, 1]]), np.array([1])),\n        (np.array([[0, 1]]), np.array([-1])),\n        (np.array([[1, 1]]), np.array([1])),\n        (np.array([[1, 0]]), np.array([0]))\n    ]\n\n    results = []\n    for A, y in test_cases:\n        # Compute ABP reconstruction\n        x_abp = solve_abp(Omega, A, y)\n        \n        # Compute synthesis BP reconstruction\n        x_sbp = solve_sbp(D, A, y)\n        \n        # Append results in the specified order\n        results.extend(x_abp)\n        results.extend(x_sbp)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3431447"}]}