{"hands_on_practices": [{"introduction": "在深入探讨唯一性或算法之前，我们必须首先理解CP模型的基本复杂度。一个关键问题是：一个秩为$R$的张量究竟由多少个独立参数定义？本练习将指导您通过第一性原理计算模型的自由度，通过解释其固有的尺度模糊性，这是理解可识别性问题至关重要的一步。", "problem": "考虑一个实数三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I \\times J \\times K}$，它允许一个秩为 $R$ 的典范多项分解（CP 分解，也称为典范多项（CP）张量分解），记作\n$$\n\\mathcal{X} \\;=\\; \\sum_{r=1}^{R} \\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r},\n$$\n其中 $\\mathbf{a}_{r} \\in \\mathbb{R}^{I}$，$\\mathbf{b}_{r} \\in \\mathbb{R}^{J}$，$\\mathbf{c}_{r} \\in \\mathbb{R}^{K}$，且 $\\circ$ 表示向量外积。众所周知，该表示仅在分量级重缩放和置换的意义下是可辨识的：对于每个分量 $r$，可以在不改变 $\\mathcal{X}$ 的情况下，对 $(\\mathbf{a}_{r}, \\mathbf{b}_{r}, \\mathbf{c}_{r})$ 进行重缩放并在各个模态间进行补偿；并且可以对 $R$ 个分量进行置换而不改变 $\\mathcal{X}$。将模型参数视为因子矩阵 $\\mathbf{A} = [\\mathbf{a}_{1}\\ \\cdots\\ \\mathbf{a}_{R}] \\in \\mathbb{R}^{I \\times R}$、$\\mathbf{B} = [\\mathbf{b}_{1}\\ \\cdots\\ \\mathbf{b}_{R}] \\in \\mathbb{R}^{J \\times R}$ 和 $\\mathbf{C} = [\\mathbf{c}_{1}\\ \\cdots\\ \\mathbf{c}_{R}] \\in \\mathbb{R}^{K \\times R}$ 的元素。\n\n从光滑流形中参数计数的首要原则以及模型所蕴含的不变性出发，计算在商掉所有连续重缩放不确定性后，一个在 $\\mathbb{R}^{I \\times J \\times K}$ 上的泛型秩-$R$ CP 模型的自由（可辨识）实参数的数量。证明为何 $R$ 个分量之间的任何离散置换对称性不改变此参数计数。以 $I$、$J$、$K$ 和 $R$ 的封闭形式解析表达式给出你的最终答案。", "solution": "问题要求我们确定一个三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I \\times J \\times K}$ 的秩-$R$ 典范多项（CP）分解中的自由、可辨识参数的数量。这个数量对应于泛型秩-$R$ 张量流形的维数。我们的方法是首先定义所有可能参数的空间，识别模型的对称性（不确定性），然后计算通过辨识所有等价参数集所得到的商空间的维数。\n\nCP 模型由下式给出\n$$\n\\mathcal{X} = \\sum_{r=1}^{R} \\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r}\n$$\n该模型的参数是因子矩阵 $\\mathbf{A} = [\\mathbf{a}_{1}\\ \\cdots\\ \\mathbf{a}_{R}] \\in \\mathbb{R}^{I \\times R}$、$\\mathbf{B} = [\\mathbf{b}_{1}\\ \\cdots\\ \\mathbf{b}_{R}] \\in \\mathbb{R}^{J \\times R}$ 和 $\\mathbf{C} = [\\mathbf{c}_{1}\\ \\cdots\\ \\mathbf{c}_{R}] \\in \\mathbb{R}^{K \\times R}$ 的元素。\n\n1.  **参数空间及其维数**\n\n所有可能参数 $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C})$ 的集合构成了参数空间。这个空间可以看作是相应矩阵空间的笛卡尔积：\n$$\n\\mathcal{P} = \\mathbb{R}^{I \\times R} \\times \\mathbb{R}^{J \\times R} \\times \\mathbb{R}^{K \\times R}\n$$\n这个空间是一个光滑流形，具体来说是一个欧几里得空间。其维数是三个矩阵中标量元素总数。\n$$\n\\dim(\\mathcal{P}) = \\operatorname{dim}(\\mathbb{R}^{I \\times R}) + \\operatorname{dim}(\\mathbb{R}^{J \\times R}) + \\operatorname{dim}(\\mathbb{R}^{K \\times R}) = IR + JR + KR\n$$\n这可以因式分解为：\n$$\n\\dim(\\mathcal{P}) = R(I+J+K)\n$$\n\n2.  **连续不确定性（重缩放对称性）**\n\nCP 分解不是唯一的，因为单个的秩一分量 $\\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r}$ 存在缩放模糊性。对于 $R$ 个分量中的任何一个，我们可以在不改变其外积的情况下对因子向量进行重缩放。具体来说，对于任何 $r \\in \\{1, \\dots, R\\}$，变换\n$$\n(\\mathbf{a}_{r}, \\mathbf{b}_{r}, \\mathbf{c}_{r}) \\mapsto (\\alpha_{r}\\mathbf{a}_{r}, \\beta_{r}\\mathbf{b}_{r}, \\gamma_{r}\\mathbf{c}_{r})\n$$\n其中 $\\alpha_{r}, \\beta_{r}, \\gamma_{r}$ 是任意非零实标量，会产生新的外积：\n$$\n(\\alpha_{r}\\mathbf{a}_{r}) \\circ (\\beta_{r}\\mathbf{b}_{r}) \\circ (\\gamma_{r}\\mathbf{c}_{r}) = (\\alpha_{r}\\beta_{r}\\gamma_{r}) (\\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r})\n$$\n为了使分量 $\\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r}$ 保持不变，从而使和 $\\mathcal{X}$ 保持不变，必须满足条件 $\\alpha_{r}\\beta_{r}\\gamma_{r} = 1$。\n\n对于每个分量 $r$，这样的缩放三元组 $(\\alpha_{r}, \\beta_{r}, \\gamma_{r})$ 的集合在分量级乘法下构成一个群。设该群为 $G_r$：\n$$\nG_r = \\{(\\alpha_r, \\beta_r, \\gamma_r) \\in (\\mathbb{R}^*)^3 \\mid \\alpha_r \\beta_r \\gamma_r = 1\\}\n$$\n其中 $\\mathbb{R}^* = \\mathbb{R} \\setminus \\{0\\}$。这是一个连续的李群。它的维数可以通过注意到其中两个标量（例如 $\\alpha_r$ 和 $\\beta_r$）可以从 $\\mathbb{R}^*$ 中自由选择，而第三个则被确定（$\\gamma_r = (\\alpha_r \\beta_r)^{-1}$）来确定。因此，对于每个分量 $r$，缩放模糊性有 $2$ 个自由度。\n$$\n\\dim(G_r) = 2\n$$\n由于这些缩放选择对于 $R$ 个分量中的每一个都是独立的，所以连续对称性的总群 $G_{cont}$ 是各个群的直积：\n$$\nG_{cont} = G_1 \\times G_2 \\times \\cdots \\times G_R\n$$\n这个总李群的维数是其因子维数的和：\n$$\n\\dim(G_{cont}) = \\sum_{r=1}^{R} \\dim(G_r) = \\sum_{r=1}^{R} 2 = 2R\n$$\n\n3.  **商流形的维数**\n\n可辨识模型的集合对应于参数空间 $\\mathcal{P}$ 在群 $G_{cont}$ 作用下的轨道。对于一个泛型参数集（其中没有因子向量为零），这个群作用是自由的。所得的轨道空间，即商空间 $\\mathcal{P}/G_{cont}$，是一个光滑流形，其维数由原流形的维数减去李群的维数给出。\n自由参数的数量 $N_{free}$ 正是这个维数。\n$$\nN_{free} = \\dim(\\mathcal{P}/G_{cont}) = \\dim(\\mathcal{P}) - \\dim(G_{cont})\n$$\n代入计算出的维数，我们得到：\n$$\nN_{free} = R(I+J+K) - 2R = R(I+J+K-2)\n$$\n这是在考虑了所有连续重缩放不确定性之后自由参数的数量。\n\n4.  **离散置换对称性的影响**\n\n除了连续重缩放之外，CP 模型对于 $R$ 个秩一分量的置换也是不变的。如果我们重新排列各项，和 $\\sum_{r=1}^{R} \\mathbf{a}_{r} \\circ \\mathbf{b}_{r} \\circ \\mathbf{c}_{r}$ 是不变的。这种对称性由对称群 $S_R$ 在 $R$ 个分量集合上的作用来描述。\n群 $S_R$ 是一个阶为 $R!$ 的有限离散群。作为一个李群，它的维数是 $0$。\n自由参数的数量是模型空间局部维数的一个度量。当我们用一个有限群 $G_{disc}$ 对一个流形 $M$ 取商时，得到的对象（一个轨形）与原始流形 $M$ 具有相同的维数。这是因为商映射几乎处处是局部同胚（具体来说，在不是任何非单位群元的不动点的点上）。在每个轨道中辨识有限数量的点不会减少局部自由度。\n在我们的情况下，经过缩放校正的模型空间 $\\mathcal{P}/G_{cont}$ 是一个维数为 $R(I+J+K-2)$ 的流形。置换对称群 $S_R$ 作用于这个流形。最终的可辨识模型空间是轨道空间 $(\\mathcal{P}/G_{cont})/S_R$。这个空间的维数由下式给出：\n$$\n\\dim((\\mathcal{P}/G_{cont})/S_R) = \\dim(\\mathcal{P}/G_{cont}) - \\dim(S_R) = R(I+J+K-2) - 0\n$$\n因此，离散置换对称性不改变自由参数的计数。可辨识参数的数量仍然是 $R(I+J+K-2)$。\n\n最终计算：\n$\\mathbf{A}, \\mathbf{B}, \\mathbf{C}$ 中的总参数：$R(I+J+K)$。\n为消除不确定性所需的独立连续缩放约束数量：$R$ 个分量中的每一个都有 $2$ 个，总共 $2R$。\n自由参数数量 = $R(I+J+K) - 2R$。", "answer": "$$\n\\boxed{R(I+J+K-2)}\n$$", "id": "3485661"}, {"introduction": "与矩阵分解相比，CP分解的一个主要优势是其潜在的唯一性，这对模型的可解释性至关重要。Kruskal定理为此唯一性提供了一个强大的充分条件。本实践问题提供了一个亲身实践的机会，通过计算给定因子矩阵的Kruskal秩来应用此定理，并确定是否满足唯一性条件 [@problem_id:3485712]。", "problem": "考虑一个三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I \\times J \\times K}$，其允许秩为 $R$ 的典范多项分解 (CP分解)（也称为CANDECOMP/PARAFAC分解），因子矩阵为 $A \\in \\mathbb{R}^{3 \\times 4}$、$B \\in \\mathbb{R}^{4 \\times 4}$ 和 $C \\in \\mathbb{R}^{5 \\times 4}$。因子矩阵的列明确由下式给出：\n$$\nA=\\begin{bmatrix}\n1  0  0  1\\\\\n0  1  0  1\\\\\n0  0  1  0\n\\end{bmatrix},\\quad\nB=\\begin{bmatrix}\n1  0  0  1\\\\\n0  1  0  1\\\\\n0  0  1  1\\\\\n0  0  0  0\n\\end{bmatrix},\\quad\nC=\\begin{bmatrix}\n1  0  0  0\\\\\n0  1  0  0\\\\\n0  0  1  0\\\\\n0  0  0  1\\\\\n0  0  0  0\n\\end{bmatrix}.\n$$\n设 $A=[a_{1}\\;a_{2}\\;a_{3}\\;a_{4}]$、$B=[b_{1}\\;b_{2}\\;b_{3}\\;b_{4}]$ 和 $C=[c_{1}\\;c_{2}\\;c_{3}\\;c_{4}]$ 表示列分块。仅使用线性无关和Kruskal秩（即任意 $k$ 列的子集都线性无关的最大整数 $k$）的定义，计算 $k_{A}$、$k_{B}$ 和 $k_{C}$。然后，通过分析各列的无关性质以及 $k_{A}$、$k_{B}$ 和 $k_{C}$ 的值，从基本原理出发，判断在 Kruskal 条件下，当 $R=4$ 时，该CP分解是否基本上唯一。\n\n您最终报告的数值答案必须是等于 $k_{A}+k_{B}+k_{C}$ 的单个整数。无需四舍五入。请勿包含任何单位。", "solution": "该问题要求计算三个给定因子矩阵 $A$、$B$ 和 $C$ 的Kruskal秩，然后利用这些秩通过Kruskal条件来评估相应典范多项分解 (CP分解) 的基本上唯一性。最终答案是这些Kruskal秩的和。\n\n首先，我们回顾矩阵的Kruskal秩的定义。矩阵 $M$ 的Kruskal秩，记作 $k_M$，是使得 $M$ 的任意 $k$ 列组成的集合都线性无关的最大整数 $k$。CP分解的秩给定为 $R=4$。\n\n让我们计算每个因子矩阵的Kruskal秩。\n\n1.  **$A$ 的Kruskal秩 ($k_A$)**\n    矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$ 由下式给出：\n    $$\n    A=\\begin{bmatrix}\n    1  0  0  1\\\\\n    0  1  0  1\\\\\n    0  0  1  0\n    \\end{bmatrix}\n    $$\n    其列为 $a_1 = [1, 0, 0]^T$、$a_2 = [0, 1, 0]^T$、$a_3 = [0, 0, 1]^T$ 和 $a_4 = [1, 1, 0]^T$。$A$ 的秩最多为 $\\min(3, 4) = 3$。列 $a_1, a_2, a_3$ 是 $\\mathbb{R}^3$ 的标准基向量，因此是线性无关的，这意味着 $\\text{rank}(A) = 3$。因此，$k_A \\le \\text{rank}(A) = 3$。\n\n    我们检查列子集的线性无关性：\n    -   **对于 $k=1$**：所有列都是非零向量，因此任何只包含单列的集合都是线性无关的。因此，$k_A \\ge 1$。\n    -   **对于 $k=2$**：我们必须检查所有 $\\binom{4}{2}=6$ 对列。\n        -   $\\{a_1, a_2\\}$、$\\{a_1, a_3\\}$、$\\{a_2, a_3\\}$ 是标准基的子集，因此是线性无关的。\n        -   $\\{a_1, a_4\\}$：$\\alpha_1 a_1 + \\alpha_4 a_4 = 0 \\implies [\\alpha_1+\\alpha_4, \\alpha_4, 0]^T = [0,0,0]^T \\implies \\alpha_4=0, \\alpha_1=0$。线性无关。\n        -   $\\{a_2, a_4\\}$：$\\alpha_2 a_2 + \\alpha_4 a_4 = 0 \\implies [\\alpha_4, \\alpha_2+\\alpha_4, 0]^T = [0,0,0]^T \\implies \\alpha_4=0, \\alpha_2=0$。线性无关。\n        -   $\\{a_3, a_4\\}$：$\\alpha_3 a_3 + \\alpha_4 a_4 = 0 \\implies [\\alpha_4, \\alpha_4, \\alpha_3]^T = [0,0,0]^T \\implies \\alpha_4=0, \\alpha_3=0$。线性无关。\n        因为所有列对都是线性无关的，所以 $k_A \\ge 2$。\n    -   **对于 $k=3$**：我们必须检查所有 $\\binom{4}{3}=4$ 组三列。\n        -   考虑集合 $\\{a_1, a_2, a_4\\}$。我们检查线性相关性：$a_4 = [1, 1, 0]^T = 1 \\cdot [1, 0, 0]^T + 1 \\cdot [0, 1, 0]^T = a_1 + a_2$。因为 $a_4 = a_1 + a_2$，所以这三列的集合是线性相关的。\n    因为我们找到了一个由3列组成的线性相关子集，所以 $k=3$ 的条件不满足。使得任意 $k$ 列子集都线性无关的最大整数 $k$ 是 $2$。\n    因此，$A$ 的Kruskal秩为 $k_A = 2$。\n\n2.  **$B$ 的Kruskal秩 ($k_B$)**\n    矩阵 $B \\in \\mathbb{R}^{4 \\times 4}$ 由下式给出：\n    $$\n    B=\\begin{bmatrix}\n    1  0  0  1\\\\\n    0  1  0  1\\\\\n    0  0  1  1\\\\\n    0  0  0  0\n    \\end{bmatrix}\n    $$\n    其列为 $b_1=[1,0,0,0]^T$、$b_2=[0,1,0,0]^T$、$b_3=[0,0,1,0]^T$ 和 $b_4=[1,1,1,0]^T$。$B$ 的秩最多为 $4$。忽略最后一个零行，我们可以看到 $b_1, b_2, b_3$ 是线性无关的。我们也可以看到 $b_4 = b_1 + b_2 + b_3$。因此，$\\text{rank}(B)=3$，所以 $k_B \\le 3$。\n\n    -   **对于 $k=1, 2$**：所有列都是非零的，并且没有一列是另一列的倍数。因此，所有大小为1和2的集合都是线性无关的。$k_B \\ge 2$。\n    -   **对于 $k=3$**：我们检查所有 $\\binom{4}{3}=4$ 组三列。\n        -   $\\{b_1, b_2, b_3\\}$：它们是线性无关的，因为它们是 $\\mathbb{R}^4$ 中的前三个标准基向量。\n        -   $\\{b_1, b_2, b_4\\}$：$\\alpha_1 b_1 + \\alpha_2 b_2 + \\alpha_4 b_4 = 0 \\implies [\\alpha_1+\\alpha_4, \\alpha_2+\\alpha_4, \\alpha_4, 0]^T = [0,0,0,0]^T$。这得到 $\\alpha_4=0$，从而推出 $\\alpha_1 = 0$ 和 $\\alpha_2=0$。该集合是线性无关的。\n        -   $\\{b_1, b_3, b_4\\}$：$\\alpha_1 b_1 + \\alpha_3 b_3 + \\alpha_4 b_4 = 0 \\implies [\\alpha_1+\\alpha_4, \\alpha_4, \\alpha_3+\\alpha_4, 0]^T = [0,0,0,0]^T$。这得到 $\\alpha_4=0$，从而推出 $\\alpha_1=0$ 和 $\\alpha_3=0$。该集合是线性无关的。\n        -   $\\{b_2, b_3, b_4\\}$：$\\alpha_2 b_2 + \\alpha_3 b_3 + \\alpha_4 b_4 = 0 \\implies [\\alpha_4, \\alpha_2+\\alpha_4, \\alpha_3+\\alpha_4, 0]^T = [0,0,0,0]^T$。这得到 $\\alpha_4=0$，从而推出 $\\alpha_2=0$ 和 $\\alpha_3=0$。该集合是线性无关的。\n        因为所有大小为3的子集都是线性无关的，所以 $k_B \\ge 3$。\n    -   **对于 $k=4$**：唯一的大小为4的子集是 $\\{b_1, b_2, b_3, b_4\\}$。如前所述，$b_4 = b_1 + b_2 + b_3$。这个集合是线性相关的。\n    使得任意 $k$ 列子集都线性无关的最大整数 $k$ 是 $3$。\n    因此，$B$ 的Kruskal秩为 $k_B = 3$。\n\n3.  **$C$ 的Kruskal秩 ($k_C$)**\n    矩阵 $C \\in \\mathbb{R}^{5 \\times 4}$ 由下式给出：\n    $$\n    C=\\begin{bmatrix}\n    1  0  0  0\\\\\n    0  1  0  0\\\\\n    0  0  1  0\\\\\n    0  0  0  1\\\\\n    0  0  0  0\n    \\end{bmatrix}\n    $$\n    其列为 $c_1=[1,0,0,0,0]^T$、$c_2=[0,1,0,0,0]^T$、$c_3=[0,0,1,0,0]^T$ 和 $c_4=[0,0,0,1,0]^T$。这些是 $\\mathbb{R}^5$ 中的前四个标准基向量。根据定义，任何由不同标准基向量组成的集合都是线性无关的。列数为 $4$。最大的可能列子集是所有四列的集合，这个集合是线性无关的。\n    因此，$C$ 的Kruskal秩等于其列数。\n    $k_C = 4$。\n\n4.  **通过Kruskal条件的唯一性分析**\n    Kruskal定理为三阶张量的CP分解的基本上唯一性提供了一个充分条件。对于一个秩为 $R$、因子矩阵为 $A$、$B$ 和 $C$ 的分解，如果满足以下条件，则该分解是唯一的：\n    $$k_A + k_B + k_C \\ge 2R + 2$$\n    在这个问题中，我们有 $R=4$，并且我们计算出的Kruskal秩为 $k_A=2$、$k_B=3$ 和 $k_C=4$。\n    我们对Kruskal秩求和：\n    $$k_A + k_B + k_C = 2 + 3 + 4 = 9$$\n    接下来，我们计算不等式右侧的项：\n    $$2R + 2 = 2(4) + 2 = 8 + 2 = 10$$\n    比较这两个值，我们得到 $9 \\ge 10$，这是不成立的。\n    由于Kruskal条件未被满足，我们不能根据该定理断定CP分解是基本上唯一的。Kruskal定理给出了一个充分但非必要的条件。未能满足该条件意味着此标准不能保证唯一性。\n\n5.  **最终计算**\n    问题要求计算Kruskal秩之和的数值。\n    $$k_A + k_B + k_C = 2 + 3 + 4 = 9$$", "answer": "$$\n\\boxed{9}\n$$", "id": "3485712"}, {"introduction": "在许多现实世界的应用中，如化学计量学或神经科学，潜在的因子本质上是非负的。这催生了非负CP（NCP）模型，它不仅能施加物理约束，还有助于解决模型的一些模糊性。本练习深入探讨了NCP的实际应用方面，从其对唯一性的影响到广泛使用的乘法更新算法背后的优化原理 [@problem_id:3485663]。", "problem": "考虑一个三阶数据张量 $\\mathcal{X} \\in \\mathbb{R}_{+}^{I \\times J \\times K}$ 及其标准分解 (CP) 模型 $\\mathcal{X} \\approx \\sum_{r=1}^{R} a_{r} \\circ b_{r} \\circ c_{r}$，其中因子矩阵为 $A \\in \\mathbb{R}_{+}^{I \\times R}$、$B \\in \\mathbb{R}_{+}^{J \\times R}$ 和 $C \\in \\mathbb{R}_{+}^{K \\times R}$，$\\circ$ 表示外积，不等式表示逐分量非负。非负最小二乘目标是最小化 $f(A,B,C) = \\tfrac{1}{2}\\left\\|\\mathcal{X} - \\sum_{r=1}^{R} a_{r} \\circ b_{r} \\circ c_{r}\\right\\|_{F}^{2}$，约束条件为 $A \\ge 0, B \\ge 0, C \\ge 0$。令 $X_{(n)}$ 表示 $\\mathcal{X}$ 的模-$n$展开，令 $\\odot$ 表示 Khatri–Rao 积。令 $\\ast$ 表示 Hadamard (逐元素) 积，$\\oslash$ 表示逐元素除法。假设通常的 CP 矩阵化关系成立：$X_{(1)} \\approx A (C \\odot B)^{\\top}$、$X_{(2)} \\approx B (C \\odot A)^{\\top}$ 和 $X_{(3)} \\approx C (B \\odot A)^{\\top}$。\n\n选择所有关于非负约束如何减轻CP分解中的模糊性以及关于在非负约束下最小化 $f(A,B,C)$ 的有原则的乘法更新的正确陈述：\n\nA. 施加 $A,B,C \\ge 0$ 可消除置换和缩放模糊性，并确保在 $R \\le \\min\\{I,J,K\\}$ 时 CP 分解的唯一性。\n\nB. 施加 $A,B,C \\ge 0$ 可排除符号翻转和破坏性抵消，从而缩小可行等价类并减轻退化；然而，除非施加额外的归一化或正则化，否则秩-1 分量的置换模糊性和正缩放模糊性仍然存在。\n\nC. 设 $M = C \\odot B$，则 $g(A) = \\tfrac{1}{2}\\|X_{(1)} - A M^{\\top}\\|_{F}^{2}$ 关于 $A$ 的梯度为 $\\nabla_{A} g = X_{(1)} M - A (M^{\\top} M)$。\n\nD. 对于 $A$-子问题（保持 $B,C$ 固定），一个保持非负性的有效 Lee–Seung 型乘法更新是 $A \\leftarrow A \\ast \\left( X_{(1)} (C \\odot B) \\right) \\oslash \\left( A \\left( (C \\odot B)^{\\top} (C \\odot B) \\right) \\right)$，对于 $B$ 和 $C$ 也有使用相应展开和 Khatri–Rao 积的类似更新。\n\nE. 在非负约束下，$A$-子问题的一阶最优性要求解处的梯度 $\\nabla_{A} g = 0$ 逐分量成立，这与无约束最小二乘情况相同。\n\nF. 对于 $A$-子问题，设 $M = C \\odot B$，Karush–Kuhn–Tucker (KKT) 条件为 $A \\ge 0$，$\\nabla_{A} g \\ge 0$，以及 $A \\ast \\nabla_{A} g = 0$ 逐分量成立，其中 $\\nabla_{A} g = A (M^{\\top} M) - X_{(1)} M$。\n\nG. 使用恒等式 $(C \\odot B)^{\\top}(C \\odot B) = (C^{\\top} C) \\ast (B^{\\top} B)$，选项 D 中的更新可以等价地写为 $A \\leftarrow A \\ast \\left( X_{(1)} (C \\odot B) \\right) \\oslash \\left( A \\left( (C^{\\top} C) \\ast (B^{\\top} B) \\right) \\right)$，其他模态也类似。\n\n选择所有适用的选项。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提出得当且客观，代表了张量分解领域的标准问题。\n\n该问题要求评估关于三阶张量 $\\mathcal{X} \\in \\mathbb{R}_{+}^{I \\times J \\times K}$ 的非负标准分解 (CP) 的陈述。该分解近似为 $\\mathcal{X} \\approx \\sum_{r=1}^{R} a_{r} \\circ b_{r} \\circ c_{r}$，其中因子矩阵 $A = [a_1, \\dots, a_R] \\in \\mathbb{R}_{+}^{I \\times R}$、$B = [b_1, \\dots, b_R] \\in \\mathbb{R}_{+}^{J \\times R}$ 和 $C = [c_1, \\dots, c_R] \\in \\mathbb{R}_{+}^{K \\times R}$ 被约束为逐分量非负。目标是最小化最小二乘误差 $f(A,B,C) = \\tfrac{1}{2}\\left\\|\\mathcal{X} - \\llbracket A,B,C \\rrbracket \\right\\|_{F}^{2}$，约束条件为 $A \\ge 0, B \\ge 0, C \\ge 0$。近似的矩阵化形式由模-$n$展开给出，例如 $X_{(1)} \\approx A (C \\odot B)^{\\top}$。\n\n我们现在将逐一评估每个陈述。\n\n**选项 A 分析**\n\n该陈述声称施加非负性 ($A,B,C \\ge 0$) 能消除置换和缩放模糊性，并确保在给定秩 $R$ 下 CP 分解的唯一性。\n\nCP 分解存在两个主要的模糊性：\n1.  **置换模糊性**：秩-1 分量的顺序可以任意置换。如果 $\\pi$ 是 $\\{1, 2, \\ldots, R\\}$ 的一个置换，那么使用因子矩阵的置换列 $A_{\\pi}$、$B_{\\pi}$、$C_{\\pi}$ 得到的模型会产生完全相同的张量：\n$$ \\sum_{r=1}^{R} a_{r} \\circ b_{r} \\circ c_{r} = \\sum_{r=1}^{R} a_{\\pi(r)} \\circ b_{\\pi(r)} \\circ c_{\\pi(r)} $$\n非负约束不影响此模糊性，因为置换非负列会得到非负矩阵。\n\n2.  **缩放模糊性**：一个秩-1 分量内的向量可以被重新缩放，只要它们的乘积保持不变。对于任何一组标量 $\\lambda_r, \\mu_r, \\nu_r$ 使得对每个 $r=1, \\dots, R$ 都有 $\\lambda_r \\mu_r \\nu_r = 1$：\n$$ \\sum_{r=1}^{R} a_{r} \\circ b_{r} \\circ c_{r} = \\sum_{r=1}^{R} (\\lambda_r a_{r}) \\circ (\\mu_r b_{r}) \\circ (\\nu_r c_{r}) $$\n非负约束只要求重新缩放后的向量保持非负。这仅将标量 $\\lambda_r, \\mu_r, \\nu_r$ 限制为正数，但并不能消除这种模糊性。\n\n由于置换和正缩放模糊性仍然存在，即使有非负约束，CP 分解也不是唯一的。条件 $R \\le \\min\\{I,J,K\\}$ 不足以保证唯一性；在无约束情况下，需要更强的条件，如 Kruskal 条件，才能实现本质唯一性，而在非负情况下也存在类似（但不完全相同）的条件。因此，该陈述是错误的。\n\n结论：**错误**。\n\n**选项 B 分析**\n\n该陈述断言，非负性排除了符号翻转和破坏性抵消，从而缩小了等价类并减轻了退化，但置换和正缩放模糊性仍然存在。\n\n这是对非负性影响的正确描述。通过强制缩放因子为正，它消除了符号翻转（例如 $(\\lambda_r, \\mu_r, \\nu_r) = (-1, -1, 1)$），这是非唯一性的一个来源。这也有助于防止“沼泽”或“退化”问题，即两个或多个具有大范数的秩-1 分量几乎相互抵消，使得优化过程变得困难。非负性强制采用一种加性的、基于部分的表示，这种表示通常更具可解释性和稳定性。如选项 A 的分析所述，置换模糊性和正缩放模糊性仍然存在。为了解决后者，通常会施加一个额外的约束，例如将一个或多个因子矩阵的列归一化（例如，归一化为单位范数）。\n\n结论：**正确**。\n\n**选项 C 分析**\n\n该陈述给出了 $A$-子问题目标函数 $g(A) = \\tfrac{1}{2}\\|X_{(1)} - A M^{\\top}\\|_{F}^{2}$ 的梯度表达式，其中 $M = C \\odot B$。我们计算梯度 $\\nabla_{A} g$。\nFrobenius 范数的平方是 $\\|Z\\|_F^2 = \\text{tr}(Z^{\\top}Z)$。\n$$ g(A) = \\frac{1}{2} \\text{tr}\\left( \\left(X_{(1)} - A M^{\\top}\\right)^{\\top} \\left(X_{(1)} - A M^{\\top}\\right) \\right) $$\n$$ g(A) = \\frac{1}{2} \\text{tr}\\left( X_{(1)}^{\\top}X_{(1)} - X_{(1)}^{\\top} A M^{\\top} - M A^{\\top}X_{(1)} + M A^{\\top} A M^{\\top} \\right) $$\n使用迹的循环性质，$\\text{tr}(M A^{\\top}X_{(1)}) = \\text{tr}(X_{(1)}^{\\top} A M^{\\top})$。\n$$ g(A) = \\frac{1}{2} \\left[ \\text{tr}(X_{(1)}^{\\top}X_{(1)}) - 2\\text{tr}(X_{(1)}^{\\top} A M^{\\top}) + \\text{tr}(A^{\\top} A M^{\\top}M) \\right] $$\n使用标准的矩阵微积分恒等式 $\\frac{\\partial}{\\partial A}\\text{tr}(X^{\\top}AY) = XY^{\\top}$ 和 $\\frac{\\partial}{\\partial A}\\text{tr}(A^{\\top}BA) = 2BA$，我们求出关于 $A$ 的梯度：\n$$ \\nabla_{A} g = \\frac{1}{2} \\left[ 0 - 2X_{(1)}M + 2A(M^{\\top}M) \\right] = A (M^{\\top}M) - X_{(1)}M $$\n该陈述提供的梯度为 $\\nabla_{A} g = X_{(1)} M - A (M^{\\top} M)$，这是正确梯度的负值。\n\n结论：**错误**。\n\n**选项 D 分析**\n\n该陈述提出了一个用于 $A$-子问题的乘法更新法则。解决此问题的交替最小二乘 (ALS) 方法涉及在保持其他因子矩阵固定的情况下求解一个因子矩阵。对于 $A$，我们求解非负最小二乘问题：$\\min_{A \\ge 0} g(A_k) = \\frac{1}{2} \\|X_{(1)} - A_k M^{\\top}\\|_{F}^2$，其中 $M=C \\odot B$。\n由 Lee 和 Seung 为非负矩阵分解 (NMF) $V \\approx WH$ 推导出的乘法更新法则是：\n$W \\leftarrow W \\ast (VH^\\top) \\oslash (WHH^\\top)$\n$H \\leftarrow H \\ast (W^\\top V) \\oslash (W^\\top W H)$\n将我们的问题映射到 $V \\approx WH$，我们有 $V=X_{(1)}$，$W=A$，以及 $H=M^\\top$。我们正在更新 $A$，它对应于 $W$。使用 $V=X_{(1)}$ 和 $H^\\top=M$ 对 $W$ 的更新是：\n$$ A \\leftarrow A \\ast (X_{(1)} M) \\oslash (A M^{\\top}M) $$\n代入 $M = C \\odot B$：\n$$ A \\leftarrow A \\ast \\left( X_{(1)} (C \\odot B) \\right) \\oslash \\left( A \\left( (C \\odot B)^{\\top} (C \\odot B) \\right) \\right) $$\n这与选项中给出的表达式相匹配。此更新遵守非负约束（如果 $A$ 初始为非负，并且给定 $X_{(1)}$、$B$ 和 $C$ 是非负的，则 $A$ 保持非负）。\n\n结论：**正确**。\n\n**选项 E 分析**\n\n该陈述声称，对于非负约束的 $A$-子问题，其一阶最优性要求 $\\nabla_{A} g = 0$ 逐分量成立。\n这是不正确的。条件 $\\nabla_{A} g = 0$ 是一个*无约束*优化问题的一阶最优性条件。我们的子问题是受约束的：$\\min_{A \\ge 0} g(A)$。正确的 dla 最优性条件是 Karush-Kuhn-Tucker (KKT) 条件。对于一个解 $A^*$，这些条件考虑了可行集的边界（即 $A^*$ 的一个或多个元素为零的情况）。对应于 $A^*$ 零元素的梯度分量不必为零；它们只需要是非负的。\n\n结论：**错误**。\n\n**选项 F 分析**\n\n该陈述提供了 $A$-子问题的 Karush-Kuhn-Tucker (KKT) 条件，其中 $M = C \\odot B$。该问题是 $\\min_{A} g(A)$，约束条件为 $A \\ge 0$（即对所有 $i,r$ 都有 $-A_{ir} \\le 0$）。\n对于解 $A^*$，KKT 条件是：\n1.  原始可行性：$A^* \\ge 0$。\n2.  对偶可行性：目标函数的梯度必须是非负的。$\\nabla_{A} g(A^*) \\ge 0$。这源于平稳性条件 $\\nabla_A g(A^*) - \\Lambda = 0$ 和拉格朗日乘子的非负性 $\\Lambda \\ge 0$。\n3.  互补松弛性：原始变量与相应梯度分量的乘积必须为零。这可以逐元素写为 $A_{ir}^* (\\nabla_{A} g(A^*))_{ir} = 0$ 对所有 $i,r$ 成立，或者以矩阵形式写为 $A^* \\ast \\nabla_{A} g(A^*) = 0$。\n\n该选项正确地陈述了这三个条件：$A \\ge 0$，$\\nabla_{A} g \\ge 0$，和 $A \\ast \\nabla_{A} g = 0$。\n它还提供了正确的梯度表达式 $\\nabla_{A} g = A (M^{\\top} M) - X_{(1)} M$，正如我们在选项 C 的分析中推导出的那样。\n因此，该陈述是对非负子问题一阶最优性条件的正确和完整描述。\n\n结论：**正确**。\n\n**选项 G 分析**\n\n该选项声称 $(C \\odot B)^{\\top}(C \\odot B) = (C^{\\top} C) \\ast (B^{\\top} B)$，并使用这个恒等式来重写选项 D 中的更新。\n我们来验证这个恒等式。Khatri-Rao 积 $M = C \\odot B$ 由其列定义，其中第 $r$ 列是 $C$ 和 $B$ 的第 $r$ 列的 Kronecker 积：$m_r = c_r \\otimes b_r$。\n$M^{\\top}M$ 的第 $(r,s)$ 个元素是 $M$ 的第 $r$ 列和第 $s$ 列的内积：\n$$ (M^{\\top}M)_{rs} = m_r^{\\top} m_s = (c_r \\otimes b_r)^{\\top} (c_s \\otimes b_s) $$\n使用 Kronecker 积的性质 $(u \\otimes v)^{\\top}(w \\otimes z) = (u^{\\top}w)(v^{\\top}z)$，我们得到：\n$$ (M^{\\top}M)_{rs} = (c_r^{\\top}c_s)(b_r^{\\top}b_s) $$\n现在考虑恒等式的右侧，$(C^{\\top} C) \\ast (B^{\\top} B)$。\n$C^{\\top}C$ 的第 $(r,s)$ 个元素是 $c_r^{\\top}c_s$。\n$B^{\\top}B$ 的第 $(r,s)$ 个元素是 $b_r^{\\top}b_s$。\nHadamard 积 `$\\ast$` 是逐元素乘积，所以结果的第 $(r,s)$ 个元素是：\n$$ ((C^{\\top} C) \\ast (B^{\\top} B))_{rs} = (C^{\\top}C)_{rs} (B^{\\top}B)_{rs} = (c_r^{\\top}c_s) (b_r^{\\top}b_s) $$\n该恒等式是正确的。\n选项 D 中的更新是：\n$$ A \\leftarrow A \\ast \\left( X_{(1)} (C \\odot B) \\right) \\oslash \\left( A \\left( (C \\odot B)^{\\top} (C \\odot B) \\right) \\right) $$\n将已证明的恒等式代入分母，得到：\n$$ A \\leftarrow A \\ast \\left( X_{(1)} (C \\odot B) \\right) \\oslash \\left( A \\left( (C^{\\top} C) \\ast (B^{\\top} B) \\right) \\right) $$\n这与选项 G 中的表达式相匹配。这种重新表述在计算上是高效的，因为它避免了形成可能非常大的矩阵 $C \\odot B \\in \\mathbb{R}^{KJ \\times R}$，而是使用较小的 Gram 矩阵 $C^{\\top}C, B^{\\top}B \\in \\mathbb{R}^{R \\times R}$。\n\n结论：**正确**。\n\n综上所述，正确的陈述是 B、D、F 和 G。", "answer": "$$\\boxed{BDFG}$$", "id": "3485663"}]}