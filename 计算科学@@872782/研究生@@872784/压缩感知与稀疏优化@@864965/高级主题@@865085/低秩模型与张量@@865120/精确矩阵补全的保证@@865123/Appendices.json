{"hands_on_practices": [{"introduction": "矩阵补全的理论保证根植于低秩矩阵流形的几何结构。这个练习将引导你从第一性原理出发，为一个具体的 $3 \\times 3$ 秩为1 矩阵计算其切空间及正交投影算子 [@problem_id:3450073]。通过亲手推导和计算，你将对切空间这一核心概念建立起直观而深刻的理解，为后续学习更复杂的对偶证明机制奠定坚实基础。", "problem": "设 $u\\in\\mathbb{R}^{3}$ 和 $v\\in\\mathbb{R}^{3}$ 由 $u=\\begin{pmatrix}1\\\\ 1\\\\ 2\\end{pmatrix}$ 和 $v=\\begin{pmatrix}1\\\\ 2\\\\ 3\\end{pmatrix}$ 给出，并设 $M=u v^{\\top}\\in\\mathbb{R}^{3\\times 3}$，其秩为 $1$。设 $E_{ij}\\in\\mathbb{R}^{3\\times 3}$ 表示在位置 $(i,j)$ 处为 $1$ 且在其他位置为零的标准基矩阵。为 $\\mathbb{R}^{3\\times 3}$ 配备 Frobenius 内积 $\\langle A,B\\rangle=\\operatorname{trace}(A^{\\top}B)$ 及其诱导范数 $\\|A\\|_{F}=\\sqrt{\\langle A,A\\rangle}$。将秩恰好为 $1$ 的实 $3\\times 3$ 矩阵流形在点 $M$ 处的切空间 $T$ 定义为，所有位于该流形内且满足 $M(0)=M$ 的光滑曲线 $t\\mapsto M(t)$ 在 $t=0$ 处的速度矩阵的集合。\n\n从上述定义出发（特别是通过曲线速度定义的切空间和内积空间中正交投影的定义），执行以下步骤：\n\n1. 推导在点 $M$ 处的切空间 $T$ 作为 $\\mathbb{R}^{3\\times 3}$ 的一个线性子空间的显式描述，用 $u$ 和 $v$ 表示。\n2. 仅使用关于 Frobenius 内积的正交投影的定义以及你对 $T$ 的描述，推导出正交投影算子 $\\mathcal{P}_{T}:\\mathbb{R}^{3\\times 3}\\to T$ 的一个闭式表达式，用列空间 $\\operatorname{span}\\{u\\}$ 和行空间 $\\operatorname{span}\\{v\\}$ 上的正交投影算子表示。不要假设任何已有的投影公式；从第一性原理推导它。\n3. 分别计算到 $U=\\operatorname{span}\\{u\\}$ 和 $V=\\operatorname{span}\\{v\\}$ 上的正交投影算子 $\\mathcal{P}_{U}$ 和 $\\mathcal{P}_{V}$，表示为 $3\\times 3$ 矩阵。\n4. 显式计算 $\\mathcal{P}_{T}(E_{23})$ 作为一个 $3\\times 3$ 矩阵，并直接根据 Frobenius 内积验证 $E_{23}-\\mathcal{P}_{T}(E_{23})$ 与 $T$ 中的所有元素正交。\n5. 最后，计算单个标量 $\\|\\mathcal{P}_{T}(E_{23})\\|_{F}^{2}$ 并将此值作为你的最终答案报告。不需要四舍五入；给出最简分数形式的精确值。", "solution": "所述问题是线性代数和微分几何中一个定义明确的练习，涉及矩阵流形的切空间和正交投影。所有提供的数据和定义都是标准的且数学上一致的。该问题是有效的。\n\n解题过程如问题陈述中所述，分为五个步骤。\n\n步骤 1：切空间 $T$ 的刻画。\n$\\mathbb{R}^{3 \\times 3}$ 中秩为 $1$ 的矩阵流形由可写为 $ab^{\\top}$ 形式的矩阵组成，其中 $a, b \\in \\mathbb{R}^{3}$ 为非零向量。在点 $M = uv^{\\top}$ 处的切空间 $T$ 被定义为流形中满足 $M(0)=M$ 的光滑曲线 $t \\mapsto M(t)$ 的所有速度向量 $\\dot{M}(0)$ 的集合。\n设 $M(t) = a(t)b(t)^{\\top}$ 为这样一条光滑曲线，其中 $a(0) = u$ 且 $b(0) = v$。在 $t=0$ 处的速度向量通过乘积法则得到：\n$$\n\\dot{M}(0) = \\left. \\frac{d}{dt} \\left( a(t)b(t)^{\\top} \\right) \\right|_{t=0} = \\dot{a}(0)b(0)^{\\top} + a(0)\\dot{b}(0)^{\\top}\n$$\n设 $x = \\dot{a}(0) \\in \\mathbb{R}^{3}$ 且 $y = \\dot{b}(0) \\in \\mathbb{R}^{3}$。由于 $a(t)$ 和 $b(t)$ 可以是分别从 $u$ 和 $v$ 出发的 $\\mathbb{R}^3$ 中的任意光滑曲线，它们的初始速度 $x$ 和 $y$ 可以是 $\\mathbb{R}^{3}$ 中的任意向量。因此，$T$ 中的任何元素 $Z$ 都可以表示为 $Z = xv^{\\top} + uy^{\\top}$ 的形式，其中 $x, y \\in \\mathbb{R}^3$。\n所有这类矩阵的集合构成了 $\\mathbb{R}^{3 \\times 3}$ 的一个线性子空间：\n$$\nT = \\{ xv^{\\top} + uy^{\\top} \\mid x \\in \\mathbb{R}^3, y \\in \\mathbb{R}^3 \\}\n$$\n这是两个子空间的和：$T_v = \\{xv^{\\top} \\mid x \\in \\mathbb{R}^3\\}$，即行空间包含在 $\\operatorname{span}\\{v\\}$ 中的矩阵空间；以及 $T_u = \\{uy^{\\top} \\mid y \\in \\mathbb{R}^3\\}$，即列空间包含在 $\\operatorname{span}\\{u\\}$ 中的矩阵空间。所以，$T = T_v + T_u$。\n\n步骤 2：正交投影算子 $\\mathcal{P}_T$ 的推导。\n正交投影算子 $\\mathcal{P}_T: \\mathbb{R}^{3\\times 3} \\to T$ 将一个矩阵 $Z$ 映射到其在 $T$ 中的唯一最佳逼近。该投影的特征是，$Z - \\mathcal{P}_T(Z)$ 相对于 Frobenius 内积与 $T$ 中的每个元素都正交。\n$W \\in T$ 的表示 $W = xv^{\\top} + uy^{\\top}$ 不是唯一的，因为子空间 $T_u$ 和 $T_v$ 有一个非平凡的交集 $\\operatorname{span}\\{uv^\\top\\}$。为了获得唯一的表示，我们将 $T$ 分解为正交子空间的直和。我们可以写成 $T = T' \\oplus T_u$，其中 $T' = \\{xv^{\\top} \\mid x \\in (\\operatorname{span}\\{u\\})^\\perp\\}$。\n我们来验证 $T'$ 和 $T_u$ 是正交的。设 $W_1 = xv^{\\top} \\in T'$（所以 $u^{\\top}x = 0$）和 $W_2 = uy^{\\top} \\in T_u$。它们的内积是：\n$$\n\\langle W_1, W_2 \\rangle = \\operatorname{trace}(W_1^{\\top}W_2) = \\operatorname{trace}((xv^{\\top})^{\\top}(uy^{\\top})) = \\operatorname{trace}(vx^{\\top}uy^{\\top})\n$$\n使用迹的循环性质 $\\operatorname{trace}(ABCD) = \\operatorname{trace}(DABC)$，我们得到：\n$$\n\\langle W_1, W_2 \\rangle = \\operatorname{trace}(y^{\\top}vx^{\\top}u) = (y^{\\top}v)(x^{\\top}u)\n$$\n由于根据 $T'$ 的定义 $x^{\\top}u=0$，我们有 $\\langle W_1, W_2 \\rangle = 0$。因此，$T'$ 和 $T_u$ 是正交子空间。\n到直和空间上的投影算子是各个投影算子的和：$\\mathcal{P}_T = \\mathcal{P}_{T'} + \\mathcal{P}_{T_u}$。\n让我们推导 $\\mathcal{P}_{T_u}(Z)$。我们寻求使 $\\|Z - uy^{\\top}\\|_F^2$ 最小化的 $uy^{\\top}$。通过将关于 $y$ 的导数设为零来找到正规方程，这给出 $y = \\frac{Z^{\\top}u}{\\|u\\|^2}$。因此，\n$$\n\\mathcal{P}_{T_u}(Z) = u \\left( \\frac{Z^{\\top}u}{\\|u\\|^2} \\right)^{\\top} = u \\frac{u^{\\top}Z}{\\|u\\|^2} = \\frac{uu^{\\top}}{\\|u\\|^2} Z = \\mathcal{P}_U Z\n$$\n其中 $\\mathcal{P}_U = \\frac{uu^\\top}{\\|u\\|^2}$ 是到 $\\operatorname{span}\\{u\\}$ 上的正交投影矩阵。\n对于子空间 $T_v = \\{xv^\\top \\mid x \\in \\mathbb{R}^3\\}$，通过一个完全对称的论证，投影算子是 $\\mathcal{P}_{T_v}(Z) = Z \\frac{vv^\\top}{\\|v\\|^2} = Z \\mathcal{P}_V$。\n现在，为了找到 $\\mathcal{P}_{T'}(Z)$，我们注意到 $T' = \\{X \\in T_v \\mid X \\text{ 在 } T_v \\text{ 中与 } T_u \\cap T_v \\text{ 正交 } \\}$。一个更直接的方法是注意到任何 $x \\in \\mathbb{R}^3$ 都可以唯一地分解为 $x = \\mathcal{P}_U x + (I-\\mathcal{P}_U)x$。$T_v$ 的一个元素是 $( \\mathcal{P}_U x + (I - \\mathcal{P}_U)x ) v^\\top = (\\mathcal{P}_U x)v^\\top + ((I - \\mathcal{P}_U)x)v^\\top$。第一项属于 $\\operatorname{span}\\{uv^\\top\\}$，即 $T_u \\cap T_v$。第二项代表 $T'$ 的一个元素，因为 $u^\\top(I - \\mathcal{P}_U)x=0$。\n所以，$\\mathcal{P}_{T'}(Z)$ 是 $Z$ 到由与 $u$ 正交的向量构建的 $T_v$ 元素上的投影。这对应于首先将 $Z$ 投影到 $T_v$ 上，得到 $Z\\mathcal{P}_V$，然后移除位于 $T_u$ 中的分量。这是通过在左侧应用 $(I - \\mathcal{P}_U)$ 实现的。所以，$\\mathcal{P}_{T'}(Z) = (I-\\mathcal{P}_U) (Z \\mathcal{P}_V) = Z\\mathcal{P}_V - \\mathcal{P}_U Z \\mathcal{P}_V$。\n组合这些投影算子：\n$$\n\\mathcal{P}_T(Z) = \\mathcal{P}_{T'}(Z) + \\mathcal{P}_{T_u}(Z) = (Z\\mathcal{P}_V - \\mathcal{P}_U Z \\mathcal{P}_V) + \\mathcal{P}_U Z\n$$\n得到的投影算子的闭式表达式为：\n$$\n\\mathcal{P}_T(Z) = \\mathcal{P}_U Z + Z \\mathcal{P}_V - \\mathcal{P}_U Z \\mathcal{P}_V\n$$\n\n步骤 3：计算投影算子 $\\mathcal{P}_U$ 和 $\\mathcal{P}_V$。\n给定的向量是 $u=\\begin{pmatrix}1\\\\ 1\\\\ 2\\end{pmatrix}$ 和 $v=\\begin{pmatrix}1\\\\ 2\\\\ 3\\end{pmatrix}$。\n首先，我们计算范数的平方：\n$$\n\\|u\\|^2 = u^\\top u = 1^2 + 1^2 + 2^2 = 1+1+4 = 6\n$$\n$$\n\\|v\\|^2 = v^\\top v = 1^2 + 2^2 + 3^2 = 1+4+9 = 14\n$$\n投影矩阵是：\n$$\n\\mathcal{P}_U = \\frac{uu^\\top}{\\|u\\|^2} = \\frac{1}{6} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  1  2 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 2  2  4 \\end{pmatrix}\n$$\n$$\n\\mathcal{P}_V = \\frac{vv^\\top}{\\|v\\|^2} = \\frac{1}{14} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 1  2  3 \\end{pmatrix} = \\frac{1}{14} \\begin{pmatrix} 1  2  3 \\\\ 2  4  6 \\\\ 3  6  9 \\end{pmatrix}\n$$\n\n步骤 4：计算 $\\mathcal{P}_T(E_{23})$ 并验证正交性。\n我们使用步骤 2 中的公式计算 $\\mathcal{P}_T(E_{23})$，其中 $Z=E_{23} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix}$。\n第 1 项：$\\mathcal{P}_U E_{23} = \\frac{1}{6} \\begin{pmatrix} 1  1  2 \\\\ 1  1  2 \\\\ 2  2  4 \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 0  0  1 \\\\ 0  0  1 \\\\ 0  0  2 \\end{pmatrix}$。\n第 2 项：$E_{23} \\mathcal{P}_V = \\begin{pmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix} \\frac{1}{14} \\begin{pmatrix} 1  2  3 \\\\ 2  4  6 \\\\ 3  6  9 \\end{pmatrix} = \\frac{1}{14} \\begin{pmatrix} 0  0  0 \\\\ 3  6  9 \\\\ 0  0  0 \\end{pmatrix}$。\n第 3 项：$\\mathcal{P}_U E_{23} \\mathcal{P}_V = \\frac{1}{\\|u\\|^2 \\|v\\|^2} u (u^\\top E_{23} v) v^\\top$。\n标量项是 $u^\\top E_{23} v = \\begin{pmatrix} 1  1  2 \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} = 3$。\n所以，$\\mathcal{P}_U E_{23} \\mathcal{P}_V = \\frac{3}{6 \\cdot 14} uv^\\top = \\frac{1}{28} uv^\\top = \\frac{1}{28} \\begin{pmatrix} 1  2  3 \\\\ 1  2  3 \\\\ 2  4  6 \\end{pmatrix} = \\frac{1}{84} \\begin{pmatrix} 3  6  9 \\\\ 3  6  9 \\\\ 6  12  18 \\end{pmatrix}$。\n将各项通分到分母 84 后合并：\n$$\n\\mathcal{P}_T(E_{23}) = \\frac{14}{84} \\begin{pmatrix} 0  0  1 \\\\ 0  0  1 \\\\ 0  0  2 \\end{pmatrix} + \\frac{6}{84} \\begin{pmatrix} 0  0  0 \\\\ 18  36  54 \\\\ 0  0  0 \\end{pmatrix} - \\frac{1}{84} \\begin{pmatrix} 3  6  9 \\\\ 3  6  9 \\\\ 6  12  18 \\end{pmatrix}\n$$\n$$\n\\mathcal{P}_T(E_{23}) = \\frac{1}{84} \\left( \\begin{pmatrix} 0  0  14 \\\\ 0  0  14 \\\\ 0  0  28 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ 18  36  54 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 3  6  9 \\\\ 3  6  9 \\\\ 6  12  18 \\end{pmatrix} \\right) = \\frac{1}{84} \\begin{pmatrix} -3  -6  5 \\\\ 15  30  59 \\\\ -6  -12  10 \\end{pmatrix}\n$$\n现在我们计算误差 $Q = E_{23} - \\mathcal{P}_T(E_{23})$：\n$$\nQ = \\frac{1}{84}\\begin{pmatrix} 0  0  0 \\\\ 0  0  84 \\\\ 0  0  0 \\end{pmatrix} - \\frac{1}{84} \\begin{pmatrix} -3  -6  5 \\\\ 15  30  59 \\\\ -6  -12  10 \\end{pmatrix} = \\frac{1}{84} \\begin{pmatrix} 3  6  -5 \\\\ -15  -30  25 \\\\ 6  12  -10 \\end{pmatrix}\n$$\n为了验证正交性，我们必须证明对于所有 $W \\in T$ 都有 $\\langle Q, W \\rangle = 0$。只需对生成元证明即可，即证明 $Q$ 与所有形如 $uy^{\\top}$ 和 $xv^{\\top}$ 的矩阵正交。这等价于证明 $Q^\\top u = 0$ 和 $Qv = 0$。\n$$\n84 Q v = \\begin{pmatrix} 3  6  -5 \\\\ -15  -30  25 \\\\ 6  12  -10 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 3+12-15 \\\\ -15-60+75 \\\\ 6+24-30 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies Qv=0.\n$$\n$$\n84 Q^\\top u = \\begin{pmatrix} 3  -15  6 \\\\ 6  -30  12 \\\\ -5  25  -10 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3-15+12 \\\\ 6-30+24 \\\\ -5+25-20 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies Q^\\top u=0.\n$$\n正交性得到验证。\n\n步骤 5：计算 $\\|\\mathcal{P}_{T}(E_{23})\\|_{F}^{2}$。\n对于任何正交投影算子 $\\mathcal{P}$，它是自伴的，所以 $\\|\\mathcal{P}(Z)\\|_F^2 = \\langle \\mathcal{P}(Z), \\mathcal{P}(Z) \\rangle = \\langle Z, \\mathcal{P}(Z) \\rangle$。\n当 $Z = E_{23}$ 时，对于任意矩阵 $A$，内积为 $\\langle E_{23}, A \\rangle = \\operatorname{trace}(E_{23}^\\top A) = A_{23}$。因此，\n$$\n\\|\\mathcal{P}_{T}(E_{23})\\|_{F}^{2} = \\langle E_{23}, \\mathcal{P}_{T}(E_{23}) \\rangle = (\\mathcal{P}_T(E_{23}))_{23}\n$$\n根据我们在步骤 4 中的计算，$\\mathcal{P}_T(E_{23})$ 的 $(2,3)$ 元是：\n$$\n(\\mathcal{P}_T(E_{23}))_{23} = (\\mathcal{P}_U E_{23})_{23} + (E_{23} \\mathcal{P}_V)_{23} - (\\mathcal{P}_U E_{23} \\mathcal{P}_V)_{23}\n$$\n这些量是：\n$(\\mathcal{P}_U E_{23})_{23} = 1/6$（来自 $\\mathcal{P}_U$ 的 $(2,2)$ 元，即 $1/6$）。\n$(E_{23} \\mathcal{P}_V)_{23} = 9/14$（来自 $\\mathcal{P}_V$ 的 $(3,3)$ 元，即 $9/14$）。\n$(\\mathcal{P}_U E_{23} \\mathcal{P}_V)_{23} = 3/28$（来自 $\\frac{1}{28}uv^\\top$ 的 $(2,3)$ 元）。\n将这些相加得到：\n$$\n\\|\\mathcal{P}_{T}(E_{23})\\|_{F}^{2} = \\frac{1}{6} + \\frac{9}{14} - \\frac{3}{28} = \\frac{14}{84} + \\frac{54}{84} - \\frac{9}{84} = \\frac{14+54-9}{84} = \\frac{59}{84}\n$$\n值 $59$ 是素数，不能整除 $84$，所以该分数为最简分数。", "answer": "$$\n\\boxed{\\frac{59}{84}}\n$$", "id": "3450073"}, {"introduction": "理论保证通常依赖于一个关键假设：非相干性 (incoherence)。这个假设为何如此重要？本练习通过一个精心设计的思想实验，让你直面一个“最坏情况”下的高度相干矩阵 [@problem_id:3450153]。你将发现，对于这类矩阵，即使样本数量很大，恢复也可能轻易失败，从而深刻领会非相干性在确保恢复成功中的根本作用。", "problem": "考虑一个在 $n \\times n$ 矩阵上的矩阵补全设置，其中 $n \\in \\mathbb{N}$ 且 $n \\geq 2$。设 $X^{\\star} \\in \\mathbb{R}^{n \\times n}$ 是一个秩为 $1$ 的矩阵，定义为 $X^{\\star} = \\alpha \\, e_{1} e_{1}^{\\top}$，其中 $\\alpha \\in \\mathbb{R}_{0}$，$e_{1} \\in \\mathbb{R}^{n}$ 是第一个标准基向量。$X^{\\star}$ 的奇异值分解 (SVD) 为 $X^{\\star} = U \\Sigma V^{\\top}$，其中 $U = e_{1}$，$V = e_{1}$，且 $\\Sigma = [\\alpha]$。定义一个列空间张成 $X^{\\star}$ 列空间的正交矩阵 $W \\in \\mathbb{R}^{n \\times r}$ 的相干性为 $\\mu(W) := \\frac{n}{r} \\max_{1 \\leq i \\leq n} \\|P_{W} e_{i}\\|_{2}^{2}$，其中 $P_{W}$ 表示到 $W$ 的列空间上的正交投影算子。假设矩阵元素是无放回均匀随机观测的：观测集 $\\Omega \\subseteq \\{1,\\dots,n\\} \\times \\{1,\\dots,n\\}$ 的基数为 $|\\Omega| = m$，其中 $m$ 是一个满足 $m = C r n \\ln^{2}(n)$ 的整数，$C \\in \\mathbb{R}_{0}$ 且 $r = 1$，并且 $m \\leq n^{2} - 1$。\n\n考虑用于矩阵补全的核范数规划：\n$$\n\\min_{X \\in \\mathbb{R}^{n \\times n}} \\|X\\|_{*} \\quad \\text{subject to} \\quad X_{ij} = X^{\\star}_{ij} \\ \\ \\text{for all} \\ \\ (i,j) \\in \\Omega,\n$$\n其中 $\\|X\\|_{*}$ 表示 $X$ 的核范数。\n\n从 SVD 和相干性 $\\mu(\\cdot)$ 的定义出发，并结合上述核范数规划的定义，推导此设置下的确切失败事件，并计算在该均匀采样模型下，该规划未能恢复 $X^{\\star}$ 的确切概率（以闭式表达式表示）。将您的最终答案用 $n$、$C$ 和 $r$ 表示，并将其写成一个单一的解析表达式。无需四舍五入，也不涉及单位。使用 $\\ln(\\cdot)$ 表示自然对数。", "solution": "题目要求针对一个旨在恢复秩为 $1$ 的矩阵 $X^{\\star}$ 的特定核范数最小化规划，找出其确切的失败事件以及对应的确切失败概率。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n1.  目标矩阵为 $X^{\\star} \\in \\mathbb{R}^{n \\times n}$，定义为 $X^{\\star} = \\alpha \\, e_{1} e_{1}^{\\top}$，其中 $n \\in \\mathbb{N}$，$n \\geq 2$，$\\alpha \\in \\mathbb{R}_{0}$，且 $e_{1} \\in \\mathbb{R}^{n}$ 是第一个标准基向量。该矩阵只有一个非零元素：$X^{\\star}_{11} = \\alpha$，对于所有 $(i,j) \\neq (1,1)$，都有 $X^{\\star}_{ij} = 0$。\n2.  $X^{\\star}$ 的秩为 $r=1$。其奇异值分解 (SVD) 由 $U=e_1$，$V=e_1$ 和 $\\Sigma=[\\alpha]$ 给出。\n3.  观测集 $\\Omega \\subseteq \\{1,\\dots,n\\} \\times \\{1,\\dots,n\\}$ 是无放回均匀随机选取的。\n4.  观测元素的数量为 $|\\Omega| = m$，其中 $m = C r n \\ln^{2}(n)$，对于某个常数 $C > 0$。问题明确指出该公式中 $r=1$，因此 $m = C n \\ln^{2}(n)$。我们还已知 $m \\leq n^2 - 1$。\n5.  恢复规划为：$\\min_{X \\in \\mathbb{R}^{n \\times n}} \\|X\\|_{*} \\quad \\text{subject to} \\quad X_{ij} = X^{\\star}_{ij} \\ \\ \\text{for all} \\ \\ (i,j) \\in \\Omega$。\n\n该问题具有科学依据，是自洽且适定的。尽管它包含诸如“相干性”之类的术语，这表明可能需要使用矩阵补全理论中的高等定理，但 $X^\\star$ 的特殊结构允许进行直接的、基于第一性原理的分析。该问题是有效的。\n\n矩阵 $X^{\\star}$ 的核范数是其奇异值之和。唯一的非零奇异值是 $\\alpha$。因此，$\\|X^{\\star}\\|_{*} = \\alpha$。\n\n我们旨在确定最小化规划的解（我们称之为 $\\hat{X}$）不等于 $X^{\\star}$ 的条件。这就构成了恢复失败。分析基于 $X^{\\star}$ 的唯一非零元素是否被观测到，分为两种互斥的情况。\n\n情况1：元素 $(1,1)$ 未被观测到，即 $(1,1) \\notin \\Omega$。\n在这种情况下，对变量矩阵 $X$ 的约束来自于 $X^{\\star}$ 在 $\\Omega$ 上的值。由于对于所有 $(i,j) \\neq (1,1)$ 都有 $X^{\\star}_{ij} = 0$，且 $(1,1) \\notin \\Omega$，所以约束条件为对于所有 $(i,j) \\in \\Omega$，都有 $X_{ij} = X^{\\star}_{ij} = 0$。\n优化问题变为：\n$$\n\\min_{X \\in \\mathbb{R}^{n \\times n}} \\|X\\|_{*} \\quad \\text{subject to} \\quad X_{ij} = 0 \\ \\ \\text{for all} \\ \\ (i,j) \\in \\Omega.\n$$\n考虑零矩阵 $X = 0$。它满足约束条件，因为 $0_{ij} = 0$。零矩阵的核范数为 $\\|0\\|_{*} = 0$。由于核范数总是非负的，对于任何矩阵 $X$ 都有 $\\|X\\|_{*} \\geq 0$，所以零矩阵是该最小化问题的一个解。由于核范数球是凸的，并且 0 位于任何包含它的子空间的相对内部，因此最小化解是唯一的。\n恢复的矩阵是 $\\hat{X} = 0$。\n由于 $\\alpha  0$，我们有 $\\hat{X} = 0 \\neq X^{\\star}$。因此，如果 $(1,1) \\notin \\Omega$，恢复失败。\n\n情况2：元素 $(1,1)$ 被观测到，即 $(1,1) \\in \\Omega$。\n约束条件现在包括 $X_{11} = X^{\\star}_{11} = \\alpha$。其他约束是对于 $(i,j) \\in \\Omega \\setminus \\{(1,1)\\}$，有 $X_{ij} = X^{\\star}_{ij} = 0$。\n矩阵 $X^{\\star}$ 本身是该问题的一个可行点，因为它根据定义满足所有约束条件。该点的目标函数值为 $\\|X^{\\star}\\|_{*} = \\alpha$。\n设 $Z$ 为任意可行矩阵，因此 $Z_{11} = \\alpha$。我们必须确定是否存在这样的 $Z$ 具有更小的核范数。核范数 $\\|Z\\|_{*}$ 是 $Z$ 的奇异值之和。最大奇异值 $\\sigma_1(Z)$ 也是算子范数，其下界是任意单个元素的大小。具体来说，$\\sigma_1(Z) \\geq \\max_{i,j} |Z_{ij}|$。\n因此，对于任何可行矩阵 $Z$：\n$$\n\\|Z\\|_{*} = \\sum_{k=1}^{n} \\sigma_k(Z) \\geq \\sigma_1(Z) \\geq |Z_{11}| = \\alpha.\n$$\n这表明目标函数的最小可能值为 $\\alpha$。由于 $X^{\\star}$ 是一个达到该最小值的可行点，所以它是一个解。\n\n我们现在来确定唯一性。对于一个可行矩阵 $Z$ 来说，要成为一个最小化解，它必须满足 $\\|Z\\|_{*} = \\alpha$。从上面的不等式链可知，这需要两个条件以等式形式成立：\n1.  $\\sum_{k=2}^{n} \\sigma_k(Z) = 0$，这意味着对于所有 $k \\ge 2$，$\\sigma_k(Z) = 0$。这意味着 $Z$ 必须是一个秩为 1 的矩阵。\n2.  $\\sigma_1(Z) = |Z_{11}| = \\alpha$。\n\n设 $Z$ 是一个秩为 1 的矩阵，可以写成 $Z = u v^{\\top}$ 的形式，其中向量 $u, v \\in \\mathbb{R}^n$。\n它的核范数是 $\\|Z\\|_{*} = \\|u\\|_{2} \\|v\\|_{2}$。条件 $\\|Z\\|_{*} = \\alpha$ 意味着 $\\|u\\|_{2} \\|v\\|_{2} = \\alpha$。\n可行性条件 $Z_{11} = \\alpha$ 意味着 $u_1 v_1 = \\alpha$。\n根据 Cauchy-Schwarz 不等式，有 $|u_1| \\leq \\|u\\|_{2}$ 和 $|v_1| \\leq \\|v\\|_{2}$。因此， $|u_1 v_1| \\leq \\|u\\|_{2} \\|v\\|_{2}$。\n我们有 $\\alpha = |u_1 v_1| \\leq \\|u\\|_{2} \\|v\\|_{2} = \\alpha$。这意味着等式 $|u_1 v_1| = \\|u\\|_{2} \\|v\\|_{2}$ 必须成立。\n该等式成立当且仅当 $|u_1| = \\|u\\|_{2}$ 且 $|v_1| = \\|v\\|_{2}$。\n条件 $|u_1| = \\|u\\|_{2} = (\\sum_{k=1}^n u_k^2)^{1/2}$ 意味着对于所有 $k \\geq 2$，$u_k=0$。因此，$u$ 必须是 $e_1$ 的倍数，即 $u=c_1 e_1$。\n类似地， $|v_1| = \\|v\\|_{2}$ 意味着 $v=c_2 e_1$，其中 $c_2$ 是某个标量。\n那么 $Z = (c_1 e_1)(c_2 e_1)^{\\top} = (c_1 c_2) e_1 e_1^{\\top}$。\n条件 $Z_{11} = \\alpha$ 给出 $c_1 c_2 = \\alpha$。\n因此，任何最优解 $Z$ 都必须是 $Z = \\alpha e_1 e_1^{\\top}$ 的形式，这恰好是 $X^{\\star}$。\n解是唯一的。\n恢复的矩阵是 $\\hat{X} = X^{\\star}$。因此，如果 $(1,1) \\in \\Omega$，恢复成功。\n\n综合两种情况，确切的失败事件是元素 $(1,1)$ 不在观测条目集 $\\Omega$ 中的事件。\n\n现在，我们计算该事件的概率。采样模型指出，$\\Omega$ 是从总共 $n^2$ 个元素中均匀随机选取的 $m$ 个不同元素的集合。\n选择集合 $\\Omega$ 的总方式数是从 $n^2$ 个项目中选择 $m$ 个项目的方式数，即 $\\binom{n^2}{m}$。\n选择 $\\Omega$ 使其不包含特定元素 $(1,1)$ 的方式数，是从剩余的 $n^2 - 1$ 个元素中选择 $m$ 个元素的方式数。这是 $\\binom{n^2-1}{m}$。\n失败的概率是这两个量的比值：\n$$\nP(\\text{failure}) = P((1,1) \\notin \\Omega) = \\frac{\\binom{n^2-1}{m}}{\\binom{n^2}{m}}\n$$\n我们简化这个表达式：\n$$\n\\frac{\\binom{n^2-1}{m}}{\\binom{n^2}{m}} = \\frac{\\frac{(n^2-1)!}{m!(n^2-1-m)!}}{\\frac{n^2!}{m!(n^2-m)!}} = \\frac{(n^2-1)!}{n^2!} \\cdot \\frac{(n^2-m)!}{(n^2-1-m)!} = \\frac{1}{n^2} \\cdot (n^2-m) = 1 - \\frac{m}{n^2}\n$$\n题目给出的样本数为 $m = C r n \\ln^{2}(n)$，并明确条件为秩 $r=1$。因此，我们必须使用 $m = C(1)n \\ln^{2}(n) = C n \\ln^{2}(n)$。\n将此代入我们的概率表达式中：\n$$\nP(\\text{failure}) = 1 - \\frac{C n \\ln^{2}(n)}{n^2} = 1 - \\frac{C \\ln^{2}(n)}{n}\n$$\n题目要求答案用 $n$、$C$ 和 $r$ 表示。由于我们对失败事件的推导是基于矩阵秩为 1（这使得信息局限于单个元素），因此参数 $r$ 在根本上固定为 $r=1$ 以使此分析有效。因此我们必须使用 $r=1$。然而，我们可以使用 $m$ 的通用表达式来写出答案，同时认识到 $r=1$ 是问题给定的参数。\n$$\nP(\\text{failure}) = 1 - \\frac{C r \\ln^{2}(n)}{n}\n$$\n鉴于问题陈述指定了 $r=1$，该表达式确实是 $1 - \\frac{C \\ln^{2}(n)}{n}$。在表达式中保留 $r$ 既遵守了最终指令，又承认了其值是固定的。", "answer": "$$\n\\boxed{1 - \\frac{C r \\ln^{2}(n)}{n}}\n$$", "id": "3450153"}, {"introduction": "对偶凭证 (dual certificate) 是证明核范数最小化能够精确恢复低秩矩阵的核心工具。本练习将理论付诸实践，要求你设计一个算法，以编程方式为给定的恢复问题构造并验证对偶凭证 [@problem_id:3450116]。通过将抽象的数学条件（例如 $P_T(Y) = U V^{\\top}$ 和 $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$）转化为具体的数值计算步骤，你不仅能加深对恢复保证机制的理解，还能掌握一种用于验证解的唯一性的实用计算方法。", "problem": "考虑通过核范数最小化实现的矩阵补全凸松弛问题：在满足观测项等式约束的条件下，最小化一个矩阵的核范数。设一个目标低秩矩阵由细奇异值分解 (SVD) 给出：$X_{\\star} = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{n \\times r}$ 和 $V \\in \\mathbb{R}^{m \\times r}$ 具有标准正交列，且 $\\Sigma \\in \\mathbb{R}^{r \\times r}$ 是可逆的。设 $\\Omega \\subset \\{1,\\dots,n\\} \\times \\{1,\\dots,m\\}$ 为观测项的索引集，并令 $P_{\\Omega}$ 表示将 $\\Omega$ 之外的元素置零的正交投影。定义在 $X_{\\star}$ 处的切空间为 $T = \\{ U B^{\\top} + C V^{\\top} : B \\in \\mathbb{R}^{m \\times r}, C \\in \\mathbb{R}^{n \\times r} \\}$ 及其正交补 $T^{\\perp}$。对任意 $M \\in \\mathbb{R}^{n \\times m}$，到 $T$ 上的正交投影由 $P_T(M) = U U^{\\top} M + M V V^{\\top} - U U^{\\top} M V V^{\\top}$ 给出，且 $P_{T^{\\perp}}(M) = M - P_T(M)$。\n\n核范数最小化问题的凸对偶理论中一个经过充分检验的事实断言如下：如果存在一个矩阵 $Y$ 位于 $P_{\\Omega}$ 的值域内，使得 $P_T(Y) = U V^{\\top}$ 且 $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$（其中 $\\|\\cdot\\|_{2}$ 表示算子范数，即最大奇异值），那么在所有满足 $P_{\\Omega}(X) = P_{\\Omega}(X_{\\star})$ 的矩阵 $X$ 中，$X_{\\star}$ 是核范数的唯一最小化子。\n\n从这些核心定义和事实出发，设计一个算法例程。给定 $n$、$m$、$r$、一个索引集 $\\Omega$ 以及标准正交矩阵 $U \\in \\mathbb{R}^{n \\times r}$ 和 $V \\in \\mathbb{R}^{m \\times r}$，该例程尝试构造一个具有以下性质的对偶凭证 $Y$：\n- $Y \\in \\operatorname{range}(P_{\\Omega})$，即对于所有 $(i,j) \\notin \\Omega$，$Y_{ij} = 0$，\n- $P_T(Y) = U V^{\\top}$,\n- $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$。\n\n您的算法应遵循以下基本原理进行：\n- 认识到条件 $Y \\in \\operatorname{range}(P_{\\Omega})$ 允许完全通过由 $\\Omega$ 索引的元素来参数化 $Y$。\n- 将线性方程 $P_T(Y) = U V^{\\top}$ 表示为由 $\\Omega$ 索引的 $Y$ 的未知元素的函数形式，其中 $P_T$ 被视为作用于矩阵的线性算子。\n- 以最小二乘法求解该线性系统。如果残差低于一个很小的容差，则视系统为可行，并继续计算 $\\|P_{T^{\\perp}}(Y)\\|_{2}$。\n- 如果残差足够小且 $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$，则认证成功。\n\n您的程序必须实现此例程，并在以下测试套件上进行评估。在每个案例中，$U$ 和 $V$ 都是由您的代码为保证可复现性而确定性生成的任意标准正交列矩阵，目标矩阵为 $X_{\\star} = U \\Sigma V^{\\top}$（该例程仅需要 $U$ 和 $V$）：\n\n- 测试案例 1（理想情况）：$n = 5$, $m = 4$, $r = 2$，且 $\\Omega = \\{1,\\dots,5\\} \\times \\{1,\\dots,4\\}$（全索引集）。\n- 测试案例 2（因 $\\Omega$ 严重欠采样而不可行）：$n = 6$, $m = 6$, $r = 2$，且 $\\Omega = \\{(i,i) : i \\in \\{1,2,3,4,5,6\\}\\}$（仅主对角线）。\n- 测试案例 3（边界情况）：$n = 4$, $m = 6$, $r = 1$，且 $\\Omega = \\varnothing$（空集）。\n\n对于每个测试案例，您的程序必须输出一个布尔值：如果成功构造了对偶凭证，同时满足 $P_T(Y) = U V^{\\top}$（在数值容差范围内）和 $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$，则输出 $1$；否则输出 $0$。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $[1,0,1]$。\n\n不涉及物理单位或角度。所有数值比较都必须使用明确指定的容差，并且所有奇异值计算都必须使用 $\\mathbb{R}^{n \\times m}$ 上的标准算子范数。", "solution": "该问题要求设计并实现一个算法，为矩阵补全问题构造一个对偶凭证 $Y \\in \\mathbb{R}^{n \\times m}$。这种凭证的存在性保证了特定的低秩矩阵 $X_{\\star} = U \\Sigma V^{\\top}$ 是核范数最小化问题的唯一解。$Y$ 的条件如下：\n1.  $Y \\in \\operatorname{range}(P_{\\Omega})$，这意味着对于不在观测集 $\\Omega$ 中的任何索引对 $(i,j)$，$Y_{ij} = 0$。\n2.  $P_T(Y) = U V^{\\top}$，其中 $P_T$ 是到 $X_{\\star}$ 处切空间 $T$ 的正交投影。\n3.  $\\|P_{T^{\\perp}}(Y)\\|_{2}  1$，其中 $P_{T^{\\perp}}$ 是到 $T$ 的正交补上的投影，$\\|\\cdot\\|_{2}$ 是算子范数（最大奇异值）。\n\n该算法是根据问题陈述中概述的原则，通过将这些条件转化为一个可解的数值问题而开发的。\n\n首先，我们处理约束条件 $Y \\in \\operatorname{range}(P_{\\Omega})$。这意味着矩阵 $Y$ 是稀疏的，其非零项仅出现在索引集 $\\Omega$ 指定的位置。设 $d = |\\Omega|$ 为观测项的数量。我们可以将 $Y$ 表示为基本矩阵 $\\{E^{(k)}\\}_{k=1}^d$ 的线性组合，其中 $E^{(k)}$ 是一个在 $\\Omega$ 中第 $k$ 个索引位置为 1、其余位置为 0 的矩阵。如果我们将对应于这些非零项的坐标表示为向量 $\\mathbf{y} \\in \\mathbb{R}^d$，我们就可以将 $Y$ 写成 $\\mathbf{y}$ 的线性函数：$Y(\\mathbf{y})$。\n\n其次，我们构建线性方程 $P_T(Y) = U V^{\\top}$。代入 $Y$ 的参数化形式，我们得到：\n$$ P_T(Y(\\mathbf{y})) = U V^{\\top} $$\n由于 $Y(\\mathbf{y})$ 和算子 $P_T$ 都是线性的，这构成了一个关于未知数 $\\mathbf{y}$ 的线性方程组。为了将其表示为标准形式 $A\\mathbf{x} = \\mathbf{b}$，我们对矩阵进行向量化。设 $\\operatorname{vec}(M)$ 是将一个 $n \\times m$ 矩阵 $M$ 通过堆叠其列来转换为一个 $nm \\times 1$ 列向量的算子。将此应用于我们的方程，得到：\n$$ \\operatorname{vec}(P_T(Y(\\mathbf{y}))) = \\operatorname{vec}(U V^{\\top}) $$\n这可以写成 $A\\mathbf{y} = \\mathbf{b}$，其中：\n- $\\mathbf{y} \\in \\mathbb{R}^d$ 是 $Y$ 的未知元素组成的向量。这就是 $A\\mathbf{x}=\\mathbf{b}$ 中的 $\\mathbf{x}$。\n- $\\mathbf{b} = \\operatorname{vec}(U V^{\\top}) \\in \\mathbb{R}^{nm}$ 是等式右侧的常数向量。\n- $A \\in \\mathbb{R}^{nm \\times d}$ 是线性算子 $\\mathcal{L}(\\mathbf{y}) = \\operatorname{vec}(P_T(Y(\\mathbf{y})))$ 的矩阵表示。$A$ 的第 $k$ 列是 $\\operatorname{vec}(P_T(E^{(k)}))$，其中 $E^{(k)}$ 是对应于第 $k$ 个观测项的基矩阵。\n\n第三，我们求解这个线性系统。按照规定，我们以最小二乘意义寻找解，即最小化残差的欧几里得范数 $\\|A\\mathbf{y} - \\mathbf{b}\\|_2$。这将得到一个最优的元素向量 $\\mathbf{y}^*$。\n\n第四，我们验证得到的候选矩阵 $Y^* = Y(\\mathbf{y}^*)$ 是否满足两个必要条件：\n1.  **线性系统的可行性**：我们检查最小二乘解的残差是否接近于零。如果对于给定的一个很小的容差 $\\epsilon  0$，有 $\\|A\\mathbf{y}^* - \\mathbf{b}\\|_2  \\epsilon$（这等价于 $\\|P_T(Y^*) - U V^{\\top}\\|_F  \\epsilon$），则问题被认为是可行的。我们使用 $\\epsilon = 10^{-9}$。一个不可忽略的残差表明，任何在 $\\Omega$ 上有支撑的矩阵 $Y$ 都不能满足 $P_T(Y) = U V^{\\top}$，因此凭证构造失败。\n2.  **算子范数约束**：如果第一个条件成立，我们继续使用定义 $P_{T^{\\perp}}(M) = M - P_T(M)$ 计算矩阵 $P_{T^{\\perp}}(Y^*)$。然后，我们通过找到该矩阵的最大奇异值来计算其算子范数 $\\|P_{T^{\\perp}}(Y^*)\\|_2$。如果该范数严格小于 1，则构造成功。\n\n对于给定的测试案例 $(n, m, r, \\Omega)$，最终的算法如下：\n1.  确定性地生成具有标准正交列的矩阵 $U \\in \\mathbb{R}^{n \\times r}$ 和 $V \\in \\mathbb{R}^{m \\times r}$。\n2.  如果 $\\Omega$ 为空，唯一可能的候选矩阵是 $Y=0$。我们检查是否有 $P_T(0) = U V^{\\top}$。由于 $P_T(0)=0$ 且当 $r \\geq 1$ 时 $U V^{\\top}$ 通常非零，此条件不成立，导致失败。\n3.  如果 $\\Omega$ 不为空，则如上所述为线性系统 $A\\mathbf{y}=\\mathbf{b}$ 构造矩阵 $A$ 和向量 $\\mathbf{b}$。\n4.  使用数值最小二乘求解器求解 $\\mathbf{y}^*$。\n5.  检查残差的 Frobenius 范数 $\\|P_T(Y(\\mathbf{y}^*)) - UV^{\\top}\\|_F$ 是否小于 $\\epsilon=10^{-9}$。如果不是，则测试失败。\n6.  如果残差很小，则计算算子范数 $\\|P_{T^{\\perp}}(Y(\\mathbf{y}^*))\\|_2$。如果此范数小于 1，则测试成功。否则，测试失败。\n\n将此程序应用于每个测试案例，以确定是否可以构造出有效的对偶凭证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for dual certificate construction.\n    \"\"\"\n    \n    TOL = 1e-9  # Numerical tolerance for residual check\n\n    def P_T(M, U, V):\n        \"\"\"\n        Orthogonal projection of matrix M onto the tangent space T.\n        T = { U B^T + C V^T : B in R^{m x r}, C in R^{n x r} }\n        P_T(M) = U U^T M + M V V^T - U U^T M V V^T\n        \"\"\"\n        UTM = U.T @ M\n        MV = M @ V\n        UTMV = UTM @ V\n        return U @ UTM + MV @ V.T - U @ UTMV @ V.T\n\n    def P_T_perp(M, U, V):\n        \"\"\"\n        Orthogonal projection onto the orthogonal complement of T.\n        P_{T^perp}(M) = M - P_T(M)\n        \"\"\"\n        return M - P_T(M, U, V)\n\n    def generate_orthonormal_matrix(rows, cols, seed):\n        \"\"\"\n        Deterministically generates a matrix with orthonormal columns.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        A = rng.standard_normal((rows, cols))\n        Q, _ = np.linalg.qr(A)\n        return Q\n\n    def check_certificate(n, m, r, Omega, u_seed, v_seed):\n        \"\"\"\n        Attempts to construct a dual certificate Y for given parameters.\n\n        Returns:\n            1 if a valid certificate is constructed, 0 otherwise.\n        \"\"\"\n        # Step 1: Deterministically generate U and V with orthonormal columns\n        U = generate_orthonormal_matrix(n, r, u_seed)\n        V = generate_orthonormal_matrix(m, r, v_seed)\n\n        # The right-hand side of the linear system P_T(Y) = UV^T\n        target = U @ V.T\n        \n        d = len(Omega)\n\n        # Handle the edge case of no observations\n        if d == 0:\n            # The only possible Y is the zero matrix.\n            # Check if P_T(0) = UV^T. Since P_T(0) = 0, this means checking if UV^T = 0.\n            residual_norm = np.linalg.norm(target)\n            return 1 if residual_norm  TOL else 0\n\n        # Step 2: Formulate the linear system A*y = b\n        # b is the vectorized target matrix\n        b = target.flatten(order='F')\n        \n        # A is the matrix representation of the linear operator.\n        # Its columns are vec(P_T(E_k)) for each basis matrix E_k.\n        A = np.zeros((n * m, d))\n        Omega_list = sorted(list(Omega))  # Use a sorted list for fixed ordering\n\n        for k in range(d):\n            i, j = Omega_list[k]\n            # Create a standard basis matrix E_{i,j} (with 1-based indexing from problem)\n            E_k = np.zeros((n, m))\n            E_k[i - 1, j - 1] = 1.0\n            \n            # Apply the projector P_T to the basis matrix\n            P_T_E_k = P_T(E_k, U, V)\n            \n            # The k-th column of A is the vectorized result\n            A[:, k] = P_T_E_k.flatten(order='F')\n            \n        # Step 3: Solve the system in the least-squares sense\n        y, residuals, _, _ = np.linalg.lstsq(A, b, rcond=None)\n        \n        # Step 4: Certify success or failure\n        # Condition 1: The residual must be within tolerance.\n        # `residuals` is an array containing the sum of squared residuals ||Ay-b||_2^2.\n        # It's empty if the system is underdetermined and an exact solution is found.\n        residual_is_small = (len(residuals) == 0) or (residuals[0]  TOL**2)\n        \n        if not residual_is_small:\n            return 0  # Fails feasibility condition\n\n        # Reconstruct the dual certificate candidate Y from the solution vector y\n        Y = np.zeros((n, m))\n        for k in range(d):\n            i, j = Omega_list[k]\n            Y[i - 1, j - 1] = y[k]\n        \n        # Condition 2: The operator norm of P_{T^perp}(Y) must be less than 1.\n        Y_perp = P_T_perp(Y, U, V)\n        \n        try:\n            singular_values = np.linalg.svd(Y_perp, compute_uv=False)\n            operator_norm = singular_values[0] if len(singular_values) > 0 else 0.0\n        except np.linalg.LinAlgError:\n            # In case of SVD convergence failure, treat as failure\n            return 0\n\n        if operator_norm  1.0:\n            return 1  # Success\n        else:\n            return 0  # Fails operator norm condition\n\n    # --- Test Suite ---\n    \n    # Test case 1: n=5, m=4, r=2, Omega = full set (happy path)\n    omega1 = set((i, j) for i in range(1, 5 + 1) for j in range(1, 4 + 1))\n    \n    # Test case 2: n=6, m=6, r=2, Omega = diagonal (undersampled)\n    omega2 = set((i, i) for i in range(1, 6 + 1))\n    \n    # Test case 3: n=4, m=6, r=1, Omega = empty set (boundary case)\n    omega3 = set()\n    \n    test_cases = [\n        # (n, m, r, Omega, u_seed, v_seed)\n        (5, 4, 2, omega1, 0, 1),\n        (6, 6, 2, omega2, 2, 3),\n        (4, 6, 1, omega3, 4, 5),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = check_certificate(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3450116"}]}