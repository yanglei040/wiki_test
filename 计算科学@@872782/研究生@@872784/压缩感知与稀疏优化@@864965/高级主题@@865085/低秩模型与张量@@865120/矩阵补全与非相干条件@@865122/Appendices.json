{"hands_on_practices": [{"introduction": "理解非相coherent性是矩阵补全理论的基石。本练习通过一个极端高相干性的矩阵，让您亲手计算其非相干性参数，从而直观地理解矩阵奇异向量的“非尖峰”特性及其对恢复成功的重要性 [@problem_id:3459273]。", "problem": "考虑正整数 $m$ 和 $n$ 以及一个 $m \\times n$ 的秩为 1 的矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$，其中 $e^{(m)}_{1} \\in \\mathbb{R}^{m}$ 和 $e^{(n)}_{1} \\in \\mathbb{R}^{n}$ 分别表示 $\\mathbb{R}^{m}$ 和 $\\mathbb{R}^{n}$ 中的第一个标准基向量。设奇异值分解（SVD）表示 $M$ 的分解为 $M = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times r}$ 和 $V \\in \\mathbb{R}^{n \\times r}$ 分别具有张成 $M$ 的列空间和行空间的正交规范列，且 $\\Sigma \\in \\mathbb{R}^{r \\times r}$ 包含奇异值，其中 $r = \\mathrm{rank}(M)$。定义到列空间和行空间上的正交投影算子为 $P_{U} = U U^{\\top}$ 和 $P_{V} = V V^{\\top}$。对于秩 $r$，子空间相对于标准基的相干性定义为\n$$\n\\mu(U) = \\frac{m}{r} \\max_{1 \\leq i \\leq m} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2}, \n\\qquad\n\\mu(V) = \\frac{n}{r} \\max_{1 \\leq j \\leq n} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2}.\n$$\n从这些定义和 $M$ 的奇异值分解出发，计算矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$ 的相干性参数 $\\mu(U)$ 和 $\\mu(V)$，并简要解释为什么在矩阵补全的背景下，这些值说明了一种极端的相干性配置。将你的最终答案以包含两个值 $\\left(\\mu(U), \\mu(V)\\right)$ 的单行矩阵形式报告。无需四舍五入，你的答案必须是精确值。", "solution": "我们从 $m \\times n$ 矩阵 $M = e^{(m)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}$ 开始。这是一个秩为 1 的矩阵，因为它是两个非零向量的外积。对于 $u \\in \\mathbb{R}^{m}$ 和 $v \\in \\mathbb{R}^{n}$，秩为 1 的外积 $u v^{\\top}$ 的奇异值分解 (SVD) 为 $M = U \\Sigma V^{\\top}$，其中 $U$ 和 $V$ 各有一列，分别为 $u$ 和 $v$ 的归一化版本，而 $\\Sigma$ 包含唯一的非零奇异值，等于 $\\|u\\|_{2} \\|v\\|_{2}$。在我们的特定情况下，$u = e^{(m)}_{1}$ 和 $v = e^{(n)}_{1}$ 已经具有单位范数，所以奇异值分解是\n$$\nM = U \\Sigma V^{\\top}, \\quad U = e^{(m)}_{1}, \\quad V = e^{(n)}_{1}, \\quad \\Sigma = [1],\n$$\n秩 $r = 1$。列空间 $U$ 是 $\\mathrm{span}\\left(e^{(m)}_{1}\\right)$，行空间 $V$ 是 $\\mathrm{span}\\left(e^{(n)}_{1}\\right)$。\n\n到这些一维子空间上的正交投影算子是\n$$\nP_{U} = U U^{\\top} = e^{(m)}_{1} \\left(e^{(m)}_{1}\\right)^{\\top}, \n\\qquad \nP_{V} = V V^{\\top} = e^{(n)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}.\n$$\n为计算相干性参数，我们评估投影后的标准基向量的范数平方。对于 $1 \\leq i \\leq m$，\n$$\nP_{U} e^{(m)}_{i} = \\left(e^{(m)}_{1} \\left(e^{(m)}_{1}\\right)^{\\top}\\right) e^{(m)}_{i} \n= e^{(m)}_{1} \\left\\langle e^{(m)}_{1}, e^{(m)}_{i} \\right\\rangle \n= \n\\begin{cases}\ne^{(m)}_{1},   i = 1, \\\\\n0,  i \\neq 1,\n\\end{cases}\n$$\n因此\n$$\n\\left\\|P_{U} e^{(m)}_{i}\\right\\|_{2}^{2} = \n\\begin{cases}\n1,  i = 1, \\\\\n0,  i \\neq 1.\n\\end{cases}\n$$\n所以，\n$$\n\\max_{1 \\leq i \\leq m} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2} = 1,\n$$\n并且当 $r = 1$ 时，\n$$\n\\mu(U) = \\frac{m}{r} \\max_{i} \\left\\| P_{U} e^{(m)}_{i} \\right\\|_{2}^{2} = m.\n$$\n\n对于 $P_{V}$，可以进行类似的计算。对于 $1 \\leq j \\leq n$，\n$$\nP_{V} e^{(n)}_{j} = \\left(e^{(n)}_{1} \\left(e^{(n)}_{1}\\right)^{\\top}\\right) e^{(n)}_{j} \n= e^{(n)}_{1} \\left\\langle e^{(n)}_{1}, e^{(n)}_{j} \\right\\rangle \n= \n\\begin{cases}\ne^{(n)}_{1},  j = 1, \\\\\n0,  j \\neq 1,\n\\end{cases}\n$$\n因此\n$$\n\\left\\|P_{V} e^{(n)}_{j}\\right\\|_{2}^{2} = \n\\begin{cases}\n1,  j = 1, \\\\\n0,  j \\neq 1.\n\\end{cases}\n$$\n因此，\n$$\n\\max_{1 \\leq j \\leq n} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2} = 1,\n$$\n并且当 $r = 1$ 时，\n$$\n\\mu(V) = \\frac{n}{r} \\max_{j} \\left\\| P_{V} e^{(n)}_{j} \\right\\|_{2}^{2} = n.\n$$\n\n这些值说明了极端的相干性，因为对于秩 $r=1$，相干性满足一般界限 $1 \\leq \\mu(U) \\leq m$ 和 $1 \\leq \\mu(V) \\leq n$。这里计算的情况达到了可能的最大值，$\\mu(U) = m$ 和 $\\mu(V) = n$，这意味着子空间与单个标准基向量最大程度地对齐。在矩阵补全中，如此极端的相干性表明 $M$ 中的信息在列空间和行空间中都高度集中于单个坐标上，这恰恰是“非相干性”被最严重违反的病态情况。所要求的最终答案是包含这两个值的行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} m  n \\end{pmatrix}}$$", "id": "3459273"}, {"introduction": "除了理解矩阵本身的性质，验证其能从部分样本中被精确恢复的条件也至关重要。本练习将带您深入恢复理论的核心，通过为一个小型问题构建“对偶凭证”（dual certificate），具体展示核范数最小化方法之所以有效的背后数学原理 [@problem_id:3459243]。", "problem": "考虑一个带等式约束和核范数正则化的矩阵填充问题。设真实的未知矩阵为秩一矩阵 $$X_{\\star} \\in \\mathbb{R}^{2 \\times 2}$$，由奇异值分解 (SVD) 定义为 $$X_{\\star} = \\sigma\\, u v^{\\top},$$ 其中 $$u = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}, \\quad v = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}, \\quad \\sigma = 2.$$ 因此，$$X_{\\star} = \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}.$$ 观测到的索引集合为 $$\\Omega = \\{(1,1),(1,2),(2,1)\\},$$ 采样算子 $$\\mathcal{P}_{\\Omega}:\\mathbb{R}^{2\\times 2}\\to\\mathbb{R}^{2\\times 2}$$ 的作用为 $$(\\mathcal{P}_{\\Omega}(X))_{ij} = \\begin{cases} X_{ij},  (i,j)\\in \\Omega, \\\\ 0,  \\text{其它。}\\end{cases}$$ 考虑凸规划问题 $$\\min_{X\\in \\mathbb{R}^{2\\times 2}} \\|X\\|_{\\ast} \\quad \\text{约束条件为} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(X_{\\star}),$$ 其中 $$\\|X\\|_{\\ast}$$ 是核范数（奇异值之和）。令 $$T$$ 表示秩一流形在 $$X_{\\star}$$ 处的切空间，$$T = \\{u a^{\\top} + b v^{\\top}: a\\in\\mathbb{R}^{2},\\, b\\in\\mathbb{R}^{2}\\},$$ 并令 $$\\mathcal{P}_{T}$$ 和 $$\\mathcal{P}_{T^{\\perp}}$$ 分别表示到 $$T$$ 及其正交补上的正交投影（关于 Frobenius 内积）。仅使用核心定义（通过 Karush–Kuhn–Tucker 条件的凸最优化、秩一矩阵点处核范数的次梯度，以及切空间及其正交补的定义），执行以下步骤：\n\n1. 显式地构造一个对偶证书 $$Y \\in \\mathbb{R}^{2\\times 2}$$，使得 $$Y \\in \\mathrm{range}(\\mathcal{P}_{\\Omega}), \\quad \\mathcal{P}_{T}(Y) = u v^{\\top}, \\quad \\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2} \\leq 1,$$ 其中 $$\\|\\cdot\\|_{2}$$ 是谱范数。你的构造必须从 $$Y$$ 支撑在 $$\\Omega$$ 上（即 $$Y_{22}=0$$）的要求以及次梯度 $$\\partial \\|X_{\\star}\\|_{\\ast} = \\{u v^{\\top} + W: \\mathcal{P}_{T}(W)=0,\\, \\|W\\|_{2} \\leq 1\\}$$ 的特征描述出发。\n\n2. 通过确定一个拉格朗日乘子 $$\\Lambda \\in \\mathbb{R}^{2\\times 2}$$ 使得平稳性条件成立，并检查原始可行性，来验证 Karush–Kuhn–Tucker (KKT) 条件的最优性。特别地，证明你的 $$Y$$ 可以写成 $$Y = \\mathcal{P}_{\\Omega}(\\Lambda)$$ 的形式，并带有适当的符号约定以满足平稳性，并验证 $$\\langle Y, X_{\\star}\\rangle = \\|X_{\\star}\\|_{\\ast}.$$\n\n3. 计算量 $$\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2}.$$\n\n请以单个实数形式提供最终答案，不带单位。无需四舍五入；给出精确值。", "solution": "任务是为给定的矩阵填充问题构造一个对偶证书 `Y`，在 Karush-Kuhn-Tucker (KKT) 条件的背景下验证其性质，并计算其在切空间正交补上的投影的谱范数。\n\n真实矩阵为 `X_{\\star} = \\sigma u v^{\\top}`，其中 `\\sigma=2` 且 `u=v=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}`。这给出\n$$X_{\\star} = 2 \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}\\right) \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  1\\end{pmatrix}\\right) = \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}.$$\n核范数为 `\\|X_{\\star}\\|_{\\ast} = \\sigma = 2`。观测到的元素由 `\\Omega = \\{(1,1),(1,2),(2,1)\\}` 指定。该凸优化问题为\n$$\\min_{X\\in \\mathbb{R}^{2\\times 2}} \\|X\\|_{\\ast} \\quad \\text{约束条件为} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(X_{\\star}).$$\n\n`X_{\\star}` 是此问题唯一解的一个充分条件是存在一个矩阵 `Y \\in \\mathbb{R}^{2\\times 2}`，称为对偶证书，满足以下条件：\n1.  `Y` 在采样算子的值域内，即 `Y \\in \\mathrm{range}(\\mathcal{P}_{\\Omega})`。这意味着对于 `(i,j) \\notin \\Omega`，有 `Y_{ij}=0`。在本例中，`Y_{22}=0`。\n2.  `Y` 是在 `X_{\\star}` 处核范数的次梯度 `\\partial \\|X_{\\star}\\|_{\\ast}` 的一个元素。对于秩为 1 的矩阵 `X_{\\star}=\\sigma u v^{\\top}`，其次梯度由 `\\partial \\|X_{\\star}\\|_{\\ast} = \\{u v^{\\top} + W \\mid \\mathcal{P}_{T}(W)=0, \\|W\\|_{2} \\leq 1\\}` 给出。\n\n在 `X_{\\star}` 处的切空间 `T` 为 `T = \\{u a^{\\top} + b v^{\\top}: a,b\\in\\mathbb{R}^{2}\\}`。其正交补 `T^{\\perp}` 由满足 `u^{\\top}Z=0` 和 `Zv=0` 的矩阵 `Z` 组成。由于 `u=v`，这些条件变为 `u^{\\top}Z=0` 和 `Zu=0`。设 `u_{\\perp} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}` 是与 `u` 正交的向量。`T^{\\perp}` 中的任何矩阵都必须是 `c \\, u_{\\perp}u_{\\perp}^{\\top}` 的形式，其中 `c` 为某个标量。\n$$u_{\\perp}u_{\\perp}^{\\top} = \\frac{1}{2} \\begin{pmatrix}1 \\\\ -1\\end{pmatrix} \\begin{pmatrix}1  -1\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}.$$\n令 `A = u_{\\perp}u_{\\perp}^{\\top}`。一个矩阵 `W` 在 `T^{\\perp}` 中当且仅当它是 `A` 的倍数。根据定义，对于任何 `W \\in T^{\\perp}`，有 `\\mathcal{P}_{T}(W)=0`。\n\n**步骤 1：构造对偶证书 `Y`**\n\n我们需要找到 `Y` 使得：\n(a) `Y_{22}=0`。\n(b) `\\mathcal{P}_{T}(Y) = uv^{\\top}`。\n(c) `\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2} \\leq 1`。\n\n任何矩阵 `Y` 都可以分解为 `Y = \\mathcal{P}_{T}(Y) + \\mathcal{P}_{T^{\\perp}}(Y)`。使用条件 (b)，这变成 `Y = uv^{\\top} + \\mathcal{P}_{T^{\\perp}}(Y)`。\n令 `W = \\mathcal{P}_{T^{\\perp}}(Y)`。由于 `W \\in T^{\\perp}`，我们可以写出 `W = c \\, u_{\\perp}u_{\\perp}^{\\top}`，其中 `c` 为某个标量。\n$$Y = uv^{\\top} + c \\, u_{\\perp}u_{\\perp}^{\\top}.$$\n我们有 `uv^{\\top} = \\frac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}`。\n因此，\n$$Y = \\frac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix} + c \\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}1+c  1-c \\\\ 1-c  1+c\\end{pmatrix}.$$\n现在我们应用条件 (a)，`Y_{22}=0`：\n$$\\frac{1}{2}(1+c) = 0 \\implies c = -1.$$\n将 `c=-1` 代回 `Y` 的表达式中，我们得到对偶证书：\n$$Y = \\frac{1}{2}\\begin{pmatrix}1-1  1-(-1) \\\\ 1-(-1)  1-1\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}0  2 \\\\ 2  0\\end{pmatrix} = \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}.$$\n该矩阵 `Y` 的非零项均在 `\\Omega` 内。\n\n**步骤 2：验证 KKT 条件**\n\n该优化问题的拉格朗日函数可以写为 `\\mathcal{L}(X, \\Lambda) = \\|X\\|_{\\ast} - \\langle \\Lambda, \\mathcal{P}_{\\Omega}(X) - \\mathcal{P}_{\\Omega}(X_{\\star}) \\rangle`。在 `X=X_{\\star}` 处的平稳性条件是 `0 \\in \\partial_X \\mathcal{L}(X_{\\star}, \\Lambda)`，这意味着 `0 \\in \\partial \\|X_{\\star}\\|_{\\ast} - \\mathcal{P}_{\\Omega}(\\Lambda)`。这要求 `\\mathcal{P}_{\\Omega}(\\Lambda)` 是次梯度 `\\partial \\|X_{\\star}\\|_{\\ast}` 的一个元素。\n\n我们来确定 `Y = \\mathcal{P}_{\\Omega}(\\Lambda)`。我们需要证明我们构造的 `Y` 在 `\\partial \\|X_{\\star}\\|_{\\ast}` 中。这意味着我们必须证明 `Y = uv^{\\top} + W`，其中 `\\mathcal{P}_{T}(W)=0` 且 `\\|W\\|_{2} \\leq 1`。\n\n根据我们的构造，`Y = uv^{\\top} + (-1)u_{\\perp}u_{\\perp}^{\\top}`。\n令 `W = -u_{\\perp}u_{\\perp}^{\\top} = -\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}`。\n- `\\mathcal{P}_{T}(W)=0`：根据定义这是成立的，因为 `W` 在 `T^{\\perp}` 中。\n- `\\|W\\|_{2} \\leq 1`：我们计算 `W` 的谱范数。\n$$ \\|W\\|_{2} = \\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2} = |{-1}| \\cdot \\|u_{\\perp}u_{\\perp}^{\\top}\\|_{2}. $$\n由于 `u_{\\perp}` 是一个单位向量，`u_{\\perp}u_{\\perp}^{\\top}` 是一个正交投影矩阵，所以其谱范数为 `1`。\n因此，`\\|W\\|_{2} = 1`。条件 `\\|W\\|_{2} \\leq 1` 得到满足。\n\n这证实了 `Y \\in \\partial \\|X_{\\star}\\|_{\\ast}`。为了完成 KKT 验证，我们可以选择一个拉格朗日乘子 `\\Lambda` 使得 `\\mathcal{P}_{\\Omega}(\\Lambda) = Y`。由于 `Y` 已经在 `\\mathcal{P}_{\\Omega}` 的值域中，我们可以简单地选择 `\\Lambda = Y = \\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}`。\n根据问题的构造，`X=X_{\\star}` 满足原始可行性。\n最后，我们验证性质 `\\langle Y, X_{\\star}\\rangle = \\|X_{\\star}\\|_{\\ast}`，这是次梯度定义的一部分。\n$$\\langle Y, X_{\\star}\\rangle = \\mathrm{Tr}(Y^{\\top}X_{\\star}) = \\mathrm{Tr}\\left(\\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix} \\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}\\right) = \\mathrm{Tr}\\left(\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix}\\right) = 1+1=2.$$\n`X_{\\star}` 的核范数是 `\\|X_{\\star}\\|_{\\ast} = \\sigma = 2`。\n由于 `\\langle Y, X_{\\star}\\rangle = \\|X_{\\star}\\|_{\\ast}`，`X_{\\star}` 是最优解的条件已完全验证。\n\n**步骤 3：计算 `\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2}`**\n\n从分解 `Y = \\mathcal{P}_{T}(Y) + \\mathcal{P}_{T^{\\perp}}(Y)` 和构造 `Y = uv^{\\top} + W` (其中 `W = -u_{\\perp}u_{\\perp}^{\\top}` )，我们确定到切空间正交补上的投影为：\n$$\\mathcal{P}_{T^{\\perp}}(Y) = W = -u_{\\perp}u_{\\perp}^{\\top}.$$\n我们需要计算的量是这个矩阵的谱范数：\n$$\\|\\mathcal{P}_{T^{\\perp}}(Y)\\|_{2} = \\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2}.$$\n如步骤 2 中所计算，谱范数为：\n$$\\|-u_{\\perp}u_{\\perp}^{\\top}\\|_{2} = 1.$$\n其值恰好为 `1`。", "answer": "$$\\boxed{1}$$", "id": "3459243"}, {"introduction": "在许多实际应用中，标准的非相干性假设并非在整个矩阵上都均匀成立。本计算练习探索了一种先进策略——分块加权核范数，以应对这种非均匀、呈分块结构的相干性，展示了如何调整恢复算法以克服局部挑战，并将理论与实际应用联系起来 [@problem_id:3459271]。", "problem": "给定一个具有块结构奇异向量的方阵补全设定。考虑一个大小为 $n \\times n$ 的方阵和一个秩为 $r$ 的基准真相矩阵 $M = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{n \\times r}$ 和 $V \\in \\mathbb{R}^{n \\times r}$ 具有标准正交列。行和列索引被划分为 $B$ 个不相交的块，其大小分别为 $s_1, s_2, \\ldots, s_B$，总和为 $n$。对于每个块 $b \\in \\{1, \\ldots, B\\}$，定义 $U$ 和 $V$ 的局部块相干性值为\n$$\n\\mu_b(U) \\triangleq \\frac{n}{r} \\max_{i \\in \\text{block } b} \\left\\| P_U e_i \\right\\|_2^2, \n\\quad\n\\mu_b(V) \\triangleq \\frac{n}{r} \\max_{i \\in \\text{block } b} \\left\\| P_V e_i \\right\\|_2^2,\n$$\n其中 $P_U$ 和 $P_V$表示到 $U$ 和 $V$ 列空间上的正交投影算子，而 $(e_i)_{i=1}^n$ 是标准基。令最坏情况下的局部相干性为 $\\mu_b \\triangleq \\max\\{\\mu_b(U), \\mu_b(V)\\}$。假设一部分块可以是“尖峰的”（spiky，即 $\\mu_b$ 较大），而其他块是“不相干的”（incoherent，即 $\\mu_b$ 较小）。\n\n为了减轻局部尖峰的影响，考虑一个块加权核范数最小化程序。设 $D \\in \\mathbb{R}^{n \\times n}$ 是一个正定对角矩阵，且在块内是常数：对于块 $b$ 中的索引 $i$，$D_{ii} = w_b  0$。定义块加权核范数为 $\\| D X D \\|_\\ast$。恢复程序为\n$$\n\\min_{X \\in \\mathbb{R}^{n \\times n}} \\; \\| D X D \\|_\\ast \n\\quad \\text{subject to} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M),\n$$\n其中 $\\mathcal{P}_{\\Omega}$ 是采样算子，它揭示了 $M$ 在一个大小为 $m$ 的均匀随机子集 $\\Omega$ 上的元素，而其余元素未指定。\n\n你将仅使用基本定义和经过充分检验的结果来：\n- 从标准相干性定义和已知的非加权矩阵补全的样本复杂度界出发。\n- 推断块加权如何修改局部相干性。\n- 推导出一个关于块权重的充分条件，以消除局部尖峰。\n- 以有效相干性来实例化一个可计算的充分采样条件。\n\n为了本问题的目的，将块加权的效果建模如下。如果具有块权重 $(w_b)_{b=1}^B$ 的加权矩阵 $D$ 在加权核范数 $\\| D X D \\|_\\ast$ 中对称地应用于行和列，则有效块相干性为\n$$\n\\mu_b^{\\mathrm{eff}} \\triangleq \\frac{\\mu_b}{w_b^2},\n$$\n且全局有效相干性为\n$$\n\\mu_{\\mathrm{eff}} \\triangleq \\max_{1 \\le b \\le B} \\mu_b^{\\mathrm{eff}} = \\max_{1 \\le b \\le B} \\frac{\\mu_b}{w_b^2}.\n$$\n假设一个标准形式的充分采样条件为\n$$\nm \\;\\ge\\; C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n,\n$$\n其中 $C  0$ 是某个绝对常数，$\\log(\\cdot)$ 是自然对数。定义：如果 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$，则称块权重 $(w_b)$ 相对于目标基线 $\\mu_\\star$ 消除了局部尖峰。\n\n你的任务是编写一个程序，对每个测试用例计算：\n- 一个布尔型的消除指示器，如果 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$ 则为真，否则为假。\n- 一个布尔型的可恢复性指示器，如果 $m \\ge \\lceil C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n \\rceil$ 则为真，否则为假。\n\n使用以下测试套件，其中所有对数均为自然对数，且在所有情况下 $C = 5$。在每个测试用例中，元组由 $(n, r, B, (s_b)_{b=1}^B, (\\mu_b)_{b=1}^B, (w_b)_{b=1}^B, \\mu_\\star, m)$ 组成：\n\n- 测试 $1$ (happy-path 和边界情况): $n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 4, 4]$, $\\mu_\\star = 1$, $m = \\lceil C \\, r \\, 1 \\cdot n \\log n \\rceil$。数值上，$m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 $2$ (尖峰块权重不足): $n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 2, 2]$, $\\mu_\\star = 1$, $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 $3$ (均匀不相干性): $n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 1, 1]$, $(w_b) = [1, 1, 1, 1]$, $\\mu_\\star = 1$, $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 $4$ (极端尖峰被消除): $n = 200$, $r = 5$, $B = 4$, $(s_b) = [50, 50, 50, 50]$, $(\\mu_b) = [1, 1, 100, 1]$, $(w_b) = [1, 1, 10, 1]$, $\\mu_\\star = 2$, $m = \\lceil 5 \\cdot 5 \\cdot 200 \\cdot \\log(200) \\rceil$。\n- 测试 $5$ (小尺寸边缘案例): $n = 20$, $r = 1$, $B = 2$, $(s_b) = [10, 10]$, $(\\mu_b) = [5, 1]$, $(w_b) = [\\sqrt{5}, 1]$, $\\mu_\\star = 1$, $m = \\lceil 5 \\cdot 1 \\cdot 20 \\cdot \\log(20) \\rceil$。\n\n你的程序应该：\n- 对于每个测试用例，计算 $\\mu_{\\mathrm{eff}} = \\max_b \\mu_b / w_b^2$。\n- 计算阈值 $T = \\lceil C \\, r \\, \\mu_{\\mathrm{eff}} \\, n \\, \\log n \\rceil$。\n- 对于每个测试用例，输出两个布尔值：$[\\text{已消除}, \\text{可恢复}]$。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个结果列表，每个测试用例一个结果，每个结果格式化为不含空格的两个元素的布尔值列表，整个集合用方括号括起来。例如：[[True,False],[False,False],[True,True]]。", "solution": "当前问题旨在解决从一个低秩矩阵的一小部分元素中恢复该矩阵的问题，这一任务被称为矩阵补全。核心挑战是在仅给定秩为 $r$ 的矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 在一个稀疏索引集 $\\Omega$ 上的元素的情况下，重建该矩阵。标准恢复算法（如核范数最小化）的成功取决于一个称为“不相干性”（incoherence）的属性，该属性本质上要求矩阵 $M$ 的奇异向量是“平坦的”或“非尖峰的”。\n\n标准不相干性参数 $\\mu$ 量化了奇异向量矩阵 $U$ 和 $V$ 的任意行的最大集中程度。矩阵补全中的一个基本结果表明，如果矩阵足够不相干（即 $\\mu$ 较小），只要样本量 $m$ 足够大，就可以从 $m$ 个均匀随机采样的元素中以高概率完美恢复该矩阵。一个典型的充分条件形式如下：\n$$\nm \\ge C \\cdot r \\cdot \\mu \\cdot n \\cdot \\log(n)\n$$\n其中 $C$ 是某个正常数。当元素的“重要性”不均匀，且奇异向量的某些行或列是“尖峰的”时，这个条件可能不被满足，或者需要一个不切实际的大样本量。\n\n本问题引入了一个场景，其中不相干性是非均匀的，并呈现出块结构。行和列索引 $\\{1, \\ldots, n\\}$ 被划分为 $B$ 个块。尖峰程度（spikiness）随后在每个块 $b$ 上通过局部相干性参数 $\\mu_b$ 进行局部测量。一些块可能高度相干（$\\mu_b$ 很大），而其他块则不然。\n\n为了解决这些局部尖峰，提出了一种加权核范数最小化策略。目标函数从标准的核范数 $\\|X\\|_\\ast$ 修改为加权版本 $\\|DXD\\|_\\ast$，其中 $D$ 是一个对角权重矩阵。权重在每个块内是恒定的，对于块 $b$ 中的所有索引 $i$，$D_{ii} = w_b  0$。其直觉是，通过为尖峰块分配更大的权重 $w_b$，我们可以有效地减少对它们的惩罚，从而使恢复对它们的局部结构更具鲁棒性。\n\n该问题为这种加权效应提供了一个具体的模型。对称加权 $D$ 根据以下关系将原始块相干性 $\\mu_b$ 转换为有效块相干性 $\\mu_b^{\\mathrm{eff}}$：\n$$\n\\mu_b^{\\mathrm{eff}} \\triangleq \\frac{\\mu_b}{w_b^2}\n$$\n这个模型使直觉形式化：更大的权重 $w_b$ 会降低块 $b$ 的有效相干性。问题的整体难度则由全局有效相干性决定，即所有块中的最大值：\n$$\n\\mu_{\\mathrm{eff}} \\triangleq \\max_{1 \\le b \\le B} \\mu_b^{\\mathrm{eff}}\n$$\n利用这个有效相干性，成功恢复的充分采样条件变为：\n$$\nm \\ge C \\cdot r \\cdot \\mu_{\\mathrm{eff}} \\cdot n \\cdot \\log(n)\n$$\n\n任务是根据两个标准评估五个测试用例的一组给定参数：\n1.  **消除**（Neutralization）：如果权重 $(w_b)$ 将全局有效相干性 $\\mu_{\\mathrm{eff}}$ 降低到或低于指定的目标基线 $\\mu_\\star$，则称它们消除了局部尖峰。条件是 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$。\n2.  **可恢复性**（Recoverability）：如果给定的样本数量 $m$ 满足基于有效相干性的充分采样条件，则认为矩阵是可恢复的。条件是 $m \\ge \\lceil C \\cdot r \\cdot \\mu_{\\mathrm{eff}} \\cdot n \\cdot \\log n \\rceil$，其中常数给定为 $C=5$，$\\log(\\cdot)$ 表示自然对数。\n\n每个测试用例的计算过程如下：\n1.  给定块相干性 $(\\mu_b)_{b=1}^B$ 和块权重 $(w_b)_{b=1}^B$。\n2.  对于每个块 $b \\in \\{1, \\ldots, B\\}$，计算有效块相干性：$\\mu_b^{\\mathrm{eff}} = \\mu_b / w_b^2$。\n3.  确定全局有效相干性：$\\mu_{\\mathrm{eff}} = \\max_b \\{ \\mu_b^{\\mathrm{eff}} \\}$。\n4.  评估消除指示器：检查是否 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$。这将产生一个布尔值。\n5.  计算所需的样本复杂度阈值 $T = \\lceil C \\cdot r \\cdot \\mu_{\\mathrm{eff}} \\cdot n \\cdot \\log n \\rceil$。\n6.  评估可恢复性指示器：检查给定的样本数量 $m$ 是否大于或等于阈值 $T$。这将产生第二个布尔值。\n\n每个测试用例的最终输出是这两个布尔指示器的一对：`[消除, 可恢复性]`。让我们以第一个测试用例为例来说明这个过程。\n\n**测试用例 1：**\n- 参数：$n = 200$, $r = 5$, $B = 4$, $(\\mu_b) = [1, 1, 16, 16]$, $(w_b) = [1, 1, 4, 4]$, $\\mu_\\star = 1$, $C = 5$。\n- 给定的样本数量为 $m = \\lceil C \\cdot r \\cdot 1 \\cdot n \\cdot \\log n \\rceil = \\lceil 5 \\cdot 5 \\cdot 1 \\cdot 200 \\cdot \\log(200) \\rceil = \\lceil 5000 \\log(200) \\rceil$。\n\n1.  计算有效块相干性：\n    - $\\mu_1^{\\mathrm{eff}} = 1 / 1^2 = 1$\n    - $\\mu_2^{\\mathrm{eff}} = 1 / 1^2 = 1$\n    - $\\mu_3^{\\mathrm{eff}} = 16 / 4^2 = 16 / 16 = 1$\n    - $\\mu_4^{\\mathrm{eff}} = 16 / 4^2 = 16 / 16 = 1$\n2.  全局有效相干性：$\\mu_{\\mathrm{eff}} = \\max\\{1, 1, 1, 1\\} = 1$。\n3.  消除检查：是否 $\\mu_{\\mathrm{eff}} \\le \\mu_\\star$？即 $1 \\le 1$？是。消除指示器为 `True`。\n4.  样本复杂度阈值：$T = \\lceil 5 \\cdot 5 \\cdot \\mu_{\\mathrm{eff}} \\cdot 200 \\cdot \\log(200) \\rceil = \\lceil 5 \\cdot 5 \\cdot 1 \\cdot 200 \\cdot \\log(200) \\rceil = \\lceil 5000 \\log(200) \\rceil$。\n5.  可恢复性检查：是否 $m \\ge T$？由于 $m = \\lceil 5000 \\log(200) \\rceil$ 且 $T = \\lceil 5000 \\log(200) \\rceil$，条件 $m \\ge T$ 成立。可恢复性指示器为 `True`。\n\n测试用例 1 的结果是 `[True, True]`。此过程将应用于所有提供的测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes neutralization and recoverability indicators for a series of\n    matrix completion test cases with block-structured coherence.\n    \"\"\"\n    C = 5\n\n    # Test cases: (n, r, B, s_b, mu_b, w_b, mu_star)\n    # The number of samples 'm' is calculated based on formula for each case.\n    test_cases = [\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 16, 16], [1, 1, 4, 4], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 16, 16], [1, 1, 2, 2], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 1, 1], [1, 1, 1, 1], 1),\n        (200, 5, 4, [50, 50, 50, 50], [1, 1, 100, 1], [1, 1, 10, 1], 2),\n        (20, 1, 2, [10, 10], [5, 1], [np.sqrt(5), 1], 1)\n    ]\n\n    results = []\n    \n    # Pre-calculated values for m based on the problem description.\n    # For tests 1-4: m = ceil(C * r * n * log(n)) or ceil(C * r * 1 * n * log(n))\n    m_values = [\n        np.ceil(C * 5 * 200 * np.log(200)),\n        np.ceil(C * 5 * 200 * np.log(200)),\n        np.ceil(C * 5 * 200 * np.log(200)),\n        np.ceil(C * 5 * 200 * np.log(200)),\n        np.ceil(C * 1 * 20 * np.log(20))\n    ]\n\n    for i, case in enumerate(test_cases):\n        n, r, B, s_b, mu_b, w_b, mu_star = case\n        m = m_values[i]\n        \n        # Step 1  2: Compute effective block coherences and global effective coherence\n        effective_mu_b = [mu / (w**2) for mu, w in zip(mu_b, w_b)]\n        mu_eff = max(effective_mu_b)\n\n        # Step 3: Evaluate neutralization indicator\n        is_neutralized = mu_eff = mu_star\n\n        # Step 4: Calculate the sampling complexity threshold\n        threshold = np.ceil(C * r * mu_eff * n * np.log(n))\n\n        # Step 5: Evaluate the recoverability indicator\n        is_recoverable = m >= threshold\n        \n        # Store the results as a list of booleans\n        result = [is_neutralized, is_recoverable]\n        results.append(str(result).replace(\" \", \"\"))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "3459271"}]}