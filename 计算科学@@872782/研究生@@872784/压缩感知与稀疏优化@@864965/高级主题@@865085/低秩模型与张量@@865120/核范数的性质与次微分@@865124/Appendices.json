{"hands_on_practices": [{"introduction": "理解核范数次梯度的第一步是掌握其基本结构。这个练习将指导你根据核范数的基本定义，为一个秩-1矩阵具体构建一个次梯度[@problem_id:3469357]。通过这个过程，你将验证定义次梯度的关键几何条件，即主奇异向量部分和正交补空间部分的结构，从而加深对次梯度集合的理解。", "problem": "设 $X \\in \\mathbb{R}^{3 \\times 2}$ 是一个秩为 1 的矩阵，其奇异值分解 (SVD) 为 $X = \\sigma\\, u v^{\\top}$，其中 $\\sigma  0$，$u \\in \\mathbb{R}^{3}$ 和 $v \\in \\mathbb{R}^{2}$ 是单位范数奇异向量。考虑核范数 $\\|\\cdot\\|_{*}$，并回顾一下它是谱（算子）范数 $\\|\\cdot\\|$ 的对偶范数。仅使用以下事实：(i) $\\|X\\|_{*} = \\sup_{\\|Y\\| \\le 1} \\langle Y, X \\rangle$ 以及 (ii) 对于一个闭凸函数 $f$，在点 $x$ 的次微分是在极集 $\\mathcal{C}$ 上使支撑函数 $f(x) = \\sup_{y \\in \\mathcal{C}} \\langle y, x \\rangle$ 达到最大值的元素集合，推导核范数在一个秩为 1 的点上的次梯度的结构形式。然后，使用下面的具体数据，构造一个特定的次梯度并计算其一个标量摘要。\n\n取\n$$\nu \\;=\\; \\begin{pmatrix} \\tfrac{2}{3} \\\\[4pt] \\tfrac{1}{3} \\\\[4pt] \\tfrac{2}{3} \\end{pmatrix}, \n\\qquad\nv \\;=\\; \\begin{pmatrix} \\tfrac{3}{5} \\\\[4pt] \\tfrac{4}{5} \\end{pmatrix},\n$$\n并固定标准正交补\n$$\nU_{\\perp} \\;=\\; \\begin{pmatrix}\n\\tfrac{1}{\\sqrt{5}}  \\tfrac{4}{3\\sqrt{5}} \\\\\n[6pt]\n-\\tfrac{2}{\\sqrt{5}}  \\tfrac{2}{3\\sqrt{5}} \\\\\n[6pt]\n0  -\\tfrac{5}{3\\sqrt{5}}\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2},\n\\qquad\nV_{\\perp} \\;=\\; \\begin{pmatrix} -\\tfrac{4}{5} \\\\[4pt] \\tfrac{3}{5} \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1},\n$$\n使得 $U_{\\perp}$ 的列构成 $u$ 在 $\\mathbb{R}^{3}$ 中正交补空间的一个标准正交基，而 $V_{\\perp}$ 是一个张成 $v$ 在 $\\mathbb{R}^{2}$ 中正交补空间的单位向量。定义\n$$\nM \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\[4pt] \\tfrac{1}{2} \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1},\n\\qquad\nW \\;=\\; U_{\\perp}\\, M\\, V_{\\perp}^{\\top} \\in \\mathbb{R}^{3 \\times 2},\n\\qquad\nG \\;=\\; u v^{\\top} \\;+\\; W.\n$$\n使用上述从第一性原理出发的推导，通过验证 $W$ 上必要的正交性和范数约束，论证 $G$ 是核范数在 $X$ 点的一个有效次梯度。然后，计算弗罗贝尼乌斯范数的平方 $\\|G\\|_{F}^{2}$ 的精确值，结果应为一个实数。请提供精确值，无需四舍五入。", "solution": "用户希望我严格验证所提供的问题陈述，如果有效，则提供一个有理有据的解决方案。\n\n### 第 1 步：提取已知条件\n- **矩阵定义**：$X \\in \\mathbb{R}^{3 \\times 2}$ 是一个秩为 1 的矩阵。\n- **奇异值分解 (SVD)**：$X = \\sigma\\, u v^{\\top}$，其中 $\\sigma  0$。向量 $u \\in \\mathbb{R}^{3}$ 和 $v \\in \\mathbb{R}^{2}$ 是单位范数向量。\n- **核范数定义**：核范数 $\\|\\cdot\\|_{*}$ 定义为谱（算子）范数 $\\|\\cdot\\|$ 的对偶范数，即 $\\|X\\|_{*} = \\sup_{\\|Y\\| \\le 1} \\langle Y, X \\rangle$。\n- **次微分定义**：对于由支撑函数 $f(x) = \\sup_{y \\in \\mathcal{C}} \\langle y, x \\rangle$ 给出的闭凸函数 $f$，其在 $x$ 点的次微分 $\\partial f(x)$ 是在极集 $\\mathcal{C}$ 上使该上确界达到最大值的元素集合。\n- **具体数据**：\n  - $u = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix}$\n  - $v = \\begin{pmatrix} \\frac{3}{5} \\\\ \\frac{4}{5} \\end{pmatrix}$\n  - $U_{\\perp} = \\begin{pmatrix} \\frac{1}{\\sqrt{5}}  \\frac{4}{3\\sqrt{5}} \\\\ [6pt] -\\frac{2}{\\sqrt{5}}  \\frac{2}{3\\sqrt{5}} \\\\ [6pt] 0  -\\frac{5}{3\\sqrt{5}} \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2}$（$u$ 的生成空间的正交补的标准正交基）。\n  - $V_{\\perp} = \\begin{pmatrix} -\\frac{4}{5} \\\\ \\frac{3}{5} \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1}$（张成 $v$ 的生成空间的正交补的单位向量）。\n  - $M = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 1}$。\n  - $W = U_{\\perp}\\, M\\, V_{\\perp}^{\\top} \\in \\mathbb{R}^{3 \\times 2}$。\n  - $G = u v^{\\top} + W$。\n- **任务**：\n  1. 从第一性原理推导核范数在秩为 1 的点上的次梯度的结构形式。\n  2. 通过验证 $W$ 上的正交性和范数约束，论证给定的 $G$ 是核范数在 $X$ 处的有效次梯度。\n  3. 计算弗罗贝尼乌斯范数平方 $\\|G\\|_{F}^{2}$ 的精确值。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题设置在凸优化和矩阵分析领域，具体涉及核范数及其次微分。这些是数学和工程中标准的、完善的概念。所有定义都是正确和标准的。\n2.  **适定性**：问题陈述清晰。提供的向量和矩阵数据在数值上是一致的（例如，$u$ 和 $v$ 确实是单位向量，$U_\\perp$ 的列是标准正交的且与 $u$ 正交，$V_\\perp$ 是与 $v$ 正交的单位向量）。任务具体，并能得出一个唯一的数值答案。\n3.  **客观性**：语言精确且数学化，没有任何主观或有偏见的陈述。\n\n### 第 3 步：结论与行动\n问题是有效的。这是凸分析和矩阵理论中的一个标准练习。我将继续进行解答。\n\n### 解\n该问题要求推导核范数在秩为 1 矩阵处的次梯度，然后进行具体计算。\n\n首先，我们建立核范数 $\\|\\cdot\\|_{*}$ 的次梯度的一般结构。矩阵 $X \\in \\mathbb{R}^{m \\times n}$ 的核范数是其奇异值之和，即 $\\|X\\|_{*} = \\sum_i \\sigma_i(X)$。问题给出了对偶定义，$\\|X\\|_{*} = \\sup_{\\|Y\\| \\le 1} \\langle Y, X \\rangle$，其中 $\\|\\cdot\\|$ 是谱范数（最大奇异值），$\\langle Y, X \\rangle = \\text{tr}(Y^\\top X)$ 是弗罗贝尼乌斯内积。\n\n次微分 $\\partial \\|X\\|_{*}$ 被定义为使上确界达到最大值的元素集合。也就是说，一个矩阵 $G$ 是核范数在 $X$ 处的次梯度，记作 $G \\in \\partial \\|X\\|_{*}$，当且仅当它满足两个条件：\n1.  $G$ 属于取上确界所在的集合：$\\|G\\| \\le 1$。\n2.  $G$ 达到最大值：$\\langle G, X \\rangle = \\|X\\|_{*}$。\n\n设 $X$ 的奇异值分解 (SVD) 为 $X = \\sum_{i=1}^r \\sigma_i u_i v_i^\\top$，其中 $r = \\text{rank}(X)$，$\\{\\sigma_i > 0\\}$ 是奇异值，$\\{u_i\\}$、$\\{v_i\\}$ 是相应的左、右标准正交奇异向量。核范数为 $\\|X\\|_{*} = \\sum_{i=1}^r \\sigma_i$。\n\n条件 $\\langle G, X \\rangle = \\|X\\|_{*}$ 变为：\n$$ \\text{tr}(G^\\top X) = \\text{tr}\\left(G^\\top \\sum_{i=1}^r \\sigma_i u_i v_i^\\top\\right) = \\sum_{i=1}^r \\sigma_i \\text{tr}(G^\\top u_i v_i^\\top) = \\sum_{i=1}^r \\sigma_i \\text{tr}(v_i^\\top G^\\top u_i) = \\sum_{i=1}^r \\sigma_i (u_i^\\top G v_i) $$\n我们需要这个和等于 $\\sum_{i=1}^r \\sigma_i$。由于 $\\|G\\| \\le 1$，我们有 $|u_i^\\top G v_i| \\le \\|u_i\\|_2 \\|G\\| \\|v_i\\|_2 \\le 1$。为了使等式 $\\sum \\sigma_i (u_i^\\top G v_i) = \\sum \\sigma_i$ 在 $\\sigma_i > 0$ 的情况下成立，我们必须对所有 $i=1, \\dots, r$ 都有 $u_i^\\top G v_i = 1$。\n\n现在考虑 $G$ 的结构。设 $U = [u_1, \\dots, u_r]$ 和 $V = [v_1, \\dots, v_r]$。设 $U_\\perp$ 和 $V_\\perp$ 是矩阵，其列分别构成 $U$ 和 $V$ 的列空间的正交补的标准正交基。次梯度的一般形式是 $G = UV^\\top + W$，其中 $W$ 必须满足某些条件。为了使这种结构成立，我们要求 $W$ 与 $X$ 的奇异子空间正交。具体来说，$W$ 的列空间必须与 $U$ 的列空间正交，而 $W$ 的行空间必须与 $V$ 的行空间正交。这意味着 $U^\\top W = 0$ 和 $W V = 0$。这样的 $W$ 可以写成 $W = U_\\perp Z V_\\perp^\\top$ 的形式，其中 $Z$ 是某个具有适当维度的矩阵。\n\n那么，完整的次梯度形式为 $G = UV^\\top + U_\\perp Z V_\\perp^\\top$。范数条件 $\\|G\\| \\le 1$ 转化为对 $Z$ 的一个条件。在由 $[U, U_\\perp]$ 和 $[V, V_\\perp]$ 构成的标准正交基中，算子 $G$ 是块对角的，将 span$(V)$ 映射到 span$(U)$，并将 span$(V_\\perp)$ 映射到 span$(U_\\perp)$。因此，其谱范数是各块范数的最大值：$\\|G\\| = \\max(\\|UV^\\top\\|, \\|U_\\perp Z V_\\perp^\\top\\|) = \\max(1, \\|Z\\|)$。因此，条件 $\\|G\\| \\le 1$ 要求 $\\|Z\\| \\le 1$。\n\n对于给定的秩为 1 的矩阵 $X = \\sigma u v^\\top$，我们有 $r=1$，$U=u$，$V=v$。次梯度的结构形式为：\n$$ G = u v^\\top + W $$\n其中 $W = U_\\perp Z V_\\perp^\\top$，对于某个范数 $\\|Z\\| \\le 1$ 的矩阵 $Z$。维度为 $u \\in \\mathbb{R}^{3 \\times 1}$，$v \\in \\mathbb{R}^{2 \\times 1}$，$U_\\perp \\in \\mathbb{R}^{3 \\times 2}$，$V_\\perp \\in \\mathbb{R}^{2 \\times 1}$。因此 $Z$ 必须是一个 $2 \\times 1$ 的矩阵（一个列向量）。\n\n问题提供了一个特定的候选次梯度 $G = u v^\\top + W$，其中 $W = U_\\perp M V_\\perp^\\top$ 且 $M = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$。我们必须通过验证 $W$ 上的正交性和范数约束来论证这个 $G$ 是一个有效的次梯度。\n\n1.  **$W$ 上的正交性约束**：我们验证 $u^\\top W = 0$ 和 $Wv = 0$。\n    $U_\\perp$ 的列构成了与 $u$ 正交的子空间的一个标准正交基。因此，根据定义，$u^\\top U_\\perp = 0$。\n    $$ u^\\top W = u^\\top (U_\\perp M V_\\perp^\\top) = (u^\\top U_\\perp) M V_\\perp^\\top = 0 \\cdot M V_\\perp^\\top = 0 $$\n    类似地，$V_\\perp$ 是与 $v$ 正交的子空间的一个基，所以 $v^\\top V_\\perp = 0$，这意味着 $V_\\perp^\\top v = 0$。\n    $$ Wv = (U_\\perp M V_\\perp^\\top) v = U_\\perp M (V_\\perp^\\top v) = U_\\perp M \\cdot 0 = 0 $$\n    这些正交性条件得到满足。\n\n2.  **范数约束**：分量 $W$ 是由 $M$ 构造的，即 $W = U_\\perp M V_\\perp^\\top$。根据我们的推导，我们必须检查核心矩阵 $M$ 的谱范数是否小于或等于 1。由于 $M$ 是一个向量，其谱范数就是它的欧几里得范数。\n    $$ \\|M\\| = \\|M\\|_2 = \\sqrt{\\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} $$\n    因为 $\\|M\\| = \\frac{1}{\\sqrt{2}} \\le 1$，范数约束得到满足。\n    这表明 $G$ 的总谱范数为 $\\|G\\| = \\max(\\|uv^\\top\\|, \\|W\\|) = \\max(1, \\|M\\|) = \\max(1, 1/\\sqrt{2}) = 1$，满足 $\\|G\\| \\le 1$。\n    并且，$\\langle G, X \\rangle = \\langle uv^\\top + W, \\sigma u v^\\top \\rangle = \\sigma \\langle uv^\\top, uv^\\top \\rangle + \\sigma \\langle W, uv^\\top \\rangle$。\n    我们有 $\\langle uv^\\top, uv^\\top \\rangle = \\|uv^\\top\\|_F^2 = \\text{tr}(vu^\\top u v^\\top) = \\text{tr}(v v^\\top) = v^\\top v = 1$。\n    正交性 $u^\\top W=0$ 意味着 $\\langle W, uv^\\top \\rangle = \\text{tr}(W^\\top u v^\\top) = \\text{tr}(v^\\top W^\\top u) = 0$。\n    因此，$\\langle G, X \\rangle = \\sigma(1) + \\sigma(0) = \\sigma = \\|X\\|_{*}$。\n    次梯度的两个条件都已满足，所以 $G$ 是一个有效的次梯度。\n\n最后，我们必须计算弗罗贝尼乌斯范数的平方 $\\|G\\|_F^2$。\n$$ \\|G\\|_F^2 = \\|u v^\\top + W\\|_F^2 = \\langle u v^\\top + W, u v^\\top + W \\rangle = \\|uv^\\top\\|_F^2 + \\|W\\|_F^2 + 2\\langle uv^\\top, W \\rangle $$\n交叉项是 $\\langle uv^\\top, W \\rangle = \\text{tr}((uv^\\top)^\\top W) = \\text{tr}(vu^\\top W) = 0$，如前所示。因此，我们有一个正交和：\n$$ \\|G\\|_F^2 = \\|u v^\\top\\|_F^2 + \\|W\\|_F^2 $$\n我们分别计算每一项：\n- $\\|uv^\\top\\|_F^2 = 1$，如前所示。\n- $\\|W\\|_F^2 = \\|U_\\perp M V_\\perp^\\top\\|_F^2$。使用弗罗贝尼乌斯范数的迹定义：\n  $$ \\|W\\|_F^2 = \\text{tr}(W^\\top W) = \\text{tr}\\left( (U_\\perp M V_\\perp^\\top)^\\top (U_\\perp M V_\\perp^\\top) \\right) = \\text{tr}\\left( V_\\perp M^\\top U_\\perp^\\top U_\\perp M V_\\perp^\\top \\right) $$\n  由于 $U_\\perp$ 的列是标准正交的，所以 $U_\\perp^\\top U_\\perp = I_2$，其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。\n  $$ \\|W\\|_F^2 = \\text{tr}(V_\\perp M^\\top M V_\\perp^\\top) $$\n  使用迹的循环性质，$\\text{tr}(ABC) = \\text{tr}(CAB)$：\n  $$ \\|W\\|_F^2 = \\text{tr}(M^\\top M V_\\perp^\\top V_\\perp) $$\n  由于 $V_\\perp$ 是一个单位向量，所以 $V_\\perp^\\top V_\\perp = \\|V_\\perp\\|_2^2 = 1$。这是一个 $1 \\times 1$ 的矩阵。\n  $$ \\|W\\|_F^2 = \\text{tr}(M^\\top M) = \\|M\\|_F^2 $$\n  对于向量 $M$，弗罗贝尼乌斯范数的平方是其欧几里得范数的平方：\n  $$ \\|M\\|_F^2 = \\|M\\|_2^2 = \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2} $$\n  所以，$\\|W\\|_F^2 = \\frac{1}{2}$。\n\n结合这些项，我们得到最终结果：\n$$ \\|G\\|_F^2 = \\|u v^\\top\\|_F^2 + \\|W\\|_F^2 = 1 + \\frac{1}{2} = \\frac{3}{2} $$\n$u, v, U_\\perp, V_\\perp$ 的具体值与理论框架一致，但最终的数值计算并不需要它们，该计算仅依赖于 $G$ 的结构和 $M$ 的范数。", "answer": "$$\n\\boxed{\\frac{3}{2}}\n$$", "id": "3469357"}, {"introduction": "核范数的次微分理论在优化算法中扮演着核心角色，尤其是在求解近端映射（proximal mapping）时。这个练习要求你计算一个具体矩阵的近端映射，即奇异值软阈值算子（SVT），并利用一阶最优性条件来验证你的结果[@problem_id:3469368]。这能让你亲身体验如何运用次梯度的结构来确认一个点是否为优化问题的解，从而将抽象的理论与实际的算法步骤联系起来。", "problem": "设给定矩阵 $X \\in \\mathbb{R}^{3 \\times 2}$，其瘦奇异值分解 (thin singular value decomposition, SVD) 为 $X = U \\Sigma V^{\\top}$，其中\n$$\nU = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1  -1 \\\\\n1  \\phantom{-}1 \\\\\n0  \\phantom{-}0\n\\end{pmatrix},\n\\quad\nV = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1  -1 \\\\\n1  \\phantom{-}1\n\\end{pmatrix},\n\\quad\n\\Sigma = \\operatorname{diag}(5, 1).\n$$\n考虑由下式定义的核范数近端映射 (proximal mapping)\n$$\n\\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X) \\triangleq \\arg\\min_{Z \\in \\mathbb{R}^{3 \\times 2}} \\left\\{ \\frac{1}{2} \\|Z - X\\|_{F}^{2} + \\lambda \\|Z\\|_* \\right\\},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数 (Frobenius norm)，$\\|\\cdot\\|_*$ 表示核范数 (nuclear norm)。取 $\\lambda = \\frac{3}{2}$。\n\n仅使用凸分析的基本原理和核心定义，计算 $\\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X)$ 的显式 $3 \\times 2$ 矩阵，然后通过直接检验一阶最优性条件来验证您的答案\n$$\n0 \\in Z^{\\star} - X + \\lambda \\, \\partial \\|Z^{\\star}\\|_*,\n$$\n其中 $Z^{\\star} = \\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X)$ 且 $\\partial \\|Z^{\\star}\\|_*$ 是核范数在 $Z^{\\star}$ 处的次微分 (subdifferential)。您的验证必须展示一个满足 $X - Z^{\\star} = \\lambda G$ 的特定次梯度 (subgradient) $G \\in \\partial \\|Z^{\\star}\\|_*$。请以封闭形式提供最终的近端矩阵。", "solution": "用户要求我解决一个问题。我将首先验证问题陈述。\n\n### 第一步：提取已知条件\n-   矩阵 $X \\in \\mathbb{R}^{3 \\times 2}$ 及其瘦奇异值分解 (SVD) $X = U \\Sigma V^{\\top}$。\n-   左奇异向量矩阵：$U = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  \\phantom{-}1 \\\\ 0  \\phantom{-}0 \\end{pmatrix}$。\n-   右奇异向量矩阵：$V = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  \\phantom{-}1 \\end{pmatrix}$。\n-   奇异值矩阵：$\\Sigma = \\operatorname{diag}(5, 1)$，对应于 $\\Sigma = \\begin{pmatrix} 5  0 \\\\ 0  1 \\end{pmatrix}$。\n-   近端映射定义：$\\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X) \\triangleq \\arg\\min_{Z \\in \\mathbb{R}^{3 \\times 2}} \\left\\{ \\frac{1}{2} \\|Z - X\\|_{F}^{2} + \\lambda \\|Z\\|_* \\right\\}$。\n-   正则化参数：$\\lambda = \\frac{3}{2}$。\n-   用于验证的一阶最优性条件：$0 \\in Z^{\\star} - X + \\lambda \\, \\partial \\|Z^{\\star}\\|_*$，其中 $Z^{\\star} = \\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X)$。这等价于证明对于某个次梯度 $G \\in \\partial \\|Z^{\\star}\\|_*$ 存在 $X - Z^{\\star} = \\lambda G$。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学或事实的合理性**：该问题属于凸优化和稀疏恢复这一成熟领域。核范数、其近端算子（奇异值阈值化）及其次微分是该领域的标准概念。所提供的矩阵 $U$ 和 $V$ 具有标准正交列，这符合 SVD 的要求：\n    $U^{\\top}U = \\frac{1}{2}\\begin{pmatrix} 1  1  0 \\\\ -1  1  0 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2$。\n    $V^{\\top}V = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2$。\n    该设定在数学上和科学上都是合理的。\n2.  **适定性 (Well-Posedness)**：近端映射的目标函数是一个严格凸的光滑函数 ($\\frac{1}{2} \\|Z - X\\|_{F}^{2}$) 与一个凸函数 ($\\lambda \\|Z\\|_*$) 的和。这确保了存在唯一的最小化子 $Z^{\\star}$。该问题是适定的。\n3.  **客观性**：该问题使用精确的数学语言陈述，没有主观或模糊的术语。\n4.  **完整性**：所有必要的信息（矩阵、参数、定义）均已提供。\n\n该问题是有效的。\n\n### 第三步：结论与行动\n该问题是有效的。我现在将进行求解。\n\n解决方案包括两部分：首先，计算近端映射 $Z^{\\star}$；其次，使用一阶最优性条件验证结果。\n\n**第一部分：计算近端映射**\n\n核范数的近端算子 $\\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}$ 是奇异值阈值化 (SVT) 算子。给定矩阵 $X = U \\Sigma V^{\\top}$ 的 SVD，其近端映射 $Z^{\\star}$ 计算如下：\n$$\nZ^{\\star} = U S_{\\lambda}(\\Sigma) V^{\\top}\n$$\n其中 $S_{\\lambda}$ 是应用于 $\\Sigma$ 对角线上 $X$ 的奇异值 $\\sigma_i$ 的软阈值化算子。该算子定义为 $S_{\\lambda}(\\sigma_i) = \\max(0, \\sigma_i - \\lambda)$。\n\n$X$ 的奇异值由 $\\Sigma$ 的对角线给出：$\\sigma_1 = 5$ 和 $\\sigma_2 = 1$。参数 $\\lambda$ 给定为 $\\frac{3}{2}$。\n\n我们对每个奇异值应用软阈值化：\n$$\n\\hat{\\sigma}_1 = S_{3/2}(5) = \\max\\left(0, 5 - \\frac{3}{2}\\right) = \\max\\left(0, \\frac{10 - 3}{2}\\right) = \\frac{7}{2}\n$$\n$$\n\\hat{\\sigma}_2 = S_{3/2}(1) = \\max\\left(0, 1 - \\frac{3}{2}\\right) = \\max\\left(0, -\\frac{1}{2}\\right) = 0\n$$\n\n阈值化后的奇异值矩阵，我们记为 $\\Sigma_{\\lambda}$，是：\n$$\n\\Sigma_{\\lambda} = S_{\\lambda}(\\Sigma) = \\begin{pmatrix} \\frac{7}{2}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n\n现在我们使用 SVD 的分量重构矩阵 $Z^{\\star}$：\n$$\nZ^{\\star} = U \\Sigma_{\\lambda} V^{\\top} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  \\phantom{-}1 \\\\ 0  \\phantom{-}0 \\end{pmatrix} \\begin{pmatrix} \\frac{7}{2}  0 \\\\ 0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}\n$$\n首先，我们计算乘积 $U \\Sigma_{\\lambda}$：\n$$\nU \\Sigma_{\\lambda} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  \\phantom{-}1 \\\\ 0  \\phantom{-}0 \\end{pmatrix} \\begin{pmatrix} \\frac{7}{2}  0 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\cdot \\frac{7}{2} + (-1) \\cdot 0  1 \\cdot 0 + (-1) \\cdot 0 \\\\ 1 \\cdot \\frac{7}{2} + 1 \\cdot 0  1 \\cdot 0 + 1 \\cdot 0 \\\\ 0 \\cdot \\frac{7}{2} + 0 \\cdot 0  0 \\cdot 0 + 0 \\cdot 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{7}{2}  0 \\\\ \\frac{7}{2}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n接下来，我们将此结果乘以 $V^{\\top}$：\n$$\nZ^{\\star} = (U \\Sigma_{\\lambda}) V^{\\top} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{7}{2}  0 \\\\ \\frac{7}{2}  0 \\\\ 0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\frac{7}{2} \\cdot 1 + 0 \\cdot (-1)  \\frac{7}{2} \\cdot 1 + 0 \\cdot 1 \\\\ \\frac{7}{2} \\cdot 1 + 0 \\cdot (-1)  \\frac{7}{2} \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + 0 \\cdot (-1)  0 \\cdot 1 + 0 \\cdot 1 \\end{pmatrix}\n$$\n$$\nZ^{\\star} = \\frac{1}{2} \\begin{pmatrix} \\frac{7}{2}  \\frac{7}{2} \\\\ \\frac{7}{2}  \\frac{7}{2} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{4}  \\frac{7}{4} \\\\ \\frac{7}{4}  \\frac{7}{4} \\\\ 0  0 \\end{pmatrix}\n$$\n这就是 $\\operatorname{prox}_{\\lambda \\|\\cdot\\|_*}(X)$ 的显式矩阵。\n\n**第二部分：通过一阶最优性条件进行验证**\n\n最优性的一阶充要条件是 $X - Z^{\\star} \\in \\lambda \\, \\partial \\|Z^{\\star}\\|_*$。我们必须找到一个次梯度 $G \\in \\partial \\|Z^{\\star}\\|_*$ 使得 $X - Z^{\\star} = \\lambda G$。\n\n首先，我们从其 SVD 计算矩阵 $X$：\n$$\nX = U \\Sigma V^{\\top} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 5  0 \\\\ 0  1 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\nX = \\frac{1}{2} \\begin{pmatrix} 5  -1 \\\\ 5  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 5 \\cdot 1 + (-1) \\cdot (-1)  5 \\cdot 1 + (-1) \\cdot 1 \\\\ 5 \\cdot 1 + 1 \\cdot (-1)  5 \\cdot 1 + 1 \\cdot 1 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 6  4 \\\\ 4  6 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 3  2 \\\\ 2  3 \\\\ 0  0 \\end{pmatrix}\n$$\n现在，计算差值 $X - Z^{\\star}$：\n$$\nX - Z^{\\star} = \\begin{pmatrix} 3  2 \\\\ 2  3 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\frac{7}{4}  \\frac{7}{4} \\\\ \\frac{7}{4}  \\frac{7}{4} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{12-7}{4}  \\frac{8-7}{4} \\\\ \\frac{8-7}{4}  \\frac{12-7}{4} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{4}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{5}{4} \\\\ 0  0 \\end{pmatrix}\n$$\n候选次梯度 $G$ 由 $G = \\frac{1}{\\lambda}(X - Z^{\\star})$ 给出：\n$$\nG = \\frac{1}{3/2} \\begin{pmatrix} \\frac{5}{4}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{5}{4} \\\\ 0  0 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} \\frac{5}{4}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{5}{4} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{10}{12}  \\frac{2}{12} \\\\ \\frac{2}{12}  \\frac{10}{12} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{6}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{5}{6} \\\\ 0  0 \\end{pmatrix}\n$$\n现在，我们必须验证该矩阵 $G$ 属于次微分 $\\partial \\|Z^{\\star}\\|_*$。\n设矩阵 $A$ 的 SVD 为 $A = U_A \\Sigma_A V_A^\\top$。设 $r=\\operatorname{rank}(A)$。设 $U_r$ 和 $V_r$ 分别是包含 $U_A$ 和 $V_A$ 前 $r$ 列的矩阵。核范数在 $A$ 处的次微分由下式给出：\n$$\n\\partial \\|A\\|_* = \\{ U_r V_r^{\\top} + W \\mid U_r^{\\top}W = 0, WV_r=0, \\|W\\|_{\\text{op}} \\le 1 \\}\n$$\n矩阵 $Z^{\\star}$ 的秩为 $r=1$。其 SVD 为 $Z^{\\star} = u_1 \\hat{\\sigma}_1 v_1^{\\top}$，其中 $u_1$ 和 $v_1$ 是原始矩阵 $U$ 和 $V$ 的第一列，且 $\\hat{\\sigma}_1 = \\frac{7}{2}$。\n$$\nu_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad v_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n因此，对于 $Z^\\star$，我们有 $U_r = u_1$ 和 $V_r=v_1$。次梯度的第一项是：\n$$\nU_r V_r^{\\top} = u_1 v_1^{\\top} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\\\ 0  0 \\end{pmatrix}\n$$\n我们定义 $W$ 使得 $G = u_1 v_1^{\\top} + W$：\n$$\nW = G - u_1 v_1^{\\top} = \\begin{pmatrix} \\frac{5}{6}  \\frac{1}{6} \\\\ \\frac{1}{6}  \\frac{5}{6} \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{2} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5-3}{6}  \\frac{1-3}{6} \\\\ \\frac{1-3}{6}  \\frac{5-3}{6} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{6}  -\\frac{2}{6} \\\\ -\\frac{2}{6}  \\frac{2}{6} \\\\ 0  0 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\\\ 0  0 \\end{pmatrix}\n$$\n现在我们检查关于 $W$ 的三个条件：\n1.  $U_r^{\\top}W = u_1^{\\top}W = 0$：\n    $$u_1^{\\top}W = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{3\\sqrt{2}} \\begin{pmatrix} 1-1  -1+1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}$$\n    此条件满足。\n2.  $WV_r = Wv_1 = 0$：\n    $$Wv_1 = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\\\ 0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{3\\sqrt{2}} \\begin{pmatrix} 1-1 \\\\ -1+1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n    此条件满足。\n3.  $\\|W\\|_{\\text{op}} \\le 1$：我们计算 $W$ 的算子范数（最大奇异值）。注意 $W$ 可以用原始 SVD 的第二组奇异向量 $u_2$ 和 $v_2$ 来表示：\n    $u_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$，$v_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。我们重新检查 V。$V = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix}$，所以 $v_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}-1 \\\\ 1 \\end{pmatrix}$。这是正确的。\n    我们来计算 $u_2 v_2^{\\top}$：\n    $$\n    u_2 v_2^{\\top} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\\\ 0  0 \\end{pmatrix}\n    $$\n    我们可以看到 $W = \\frac{2}{3} (u_2 v_2^{\\top})$。由于 $u_2$ 和 $v_2$ 是单位向量，矩阵 $u_2 v_2^{\\top}$ 的算子范数为 $1$。因此，$W$ 的算子范数是：\n    $$\n    \\|W\\|_{\\text{op}} = \\left\\| \\frac{2}{3} u_2 v_2^{\\top} \\right\\|_{\\text{op}} = \\frac{2}{3} \\|u_2 v_2^{\\top}\\|_{\\text{op}} = \\frac{2}{3}\n    $$\n    由于 $\\frac{2}{3} \\le 1$，此条件也满足。\n\n所有三个条件都满足，因此 $G = \\begin{pmatrix} 5/6  1/6 \\\\ 1/6  5/6 \\\\ 0  0 \\end{pmatrix}$ 是 $\\partial \\|Z^{\\star}\\|_*$ 中的一个有效次梯度。一阶最优性条件 $X - Z^{\\star} = \\lambda G$ 得以满足，这验证了我们计算出的 $Z^{\\star}$ 是正确的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{7}{4}  \\frac{7}{4} \\\\\n\\frac{7}{4}  \\frac{7}{4} \\\\\n0  0\n\\end{pmatrix}\n}\n$$", "id": "3469368"}, {"introduction": "次微分的几何特性是理解低秩矩阵恢复成功与否的关键。本练习将引导你分析一个凸优化恢复失败的案例，其中核范数最小化无法从线性测量中恢复出原始的低秩矩阵[@problem_id:3469376]。通过构造一个特定的测量算子 $\\mathcal{A}$，并利用次微分来证明其零空间 $\\ker(\\mathcal{A})$ 中存在目标函数的下降方向，你将深刻理解保证成功恢复所需的几何条件。", "problem": "考虑赋以弗罗贝尼乌斯内积 $\\langle X, Y \\rangle = \\operatorname{trace}(X^{\\top} Y)$ 和核范数 $\\|X\\|_{*}$（即 $X$ 的奇异值之和）的实 $2 \\times 2$ 矩阵向量空间。设目标矩阵为 $X^{\\star} = e_{1} e_{1}^{\\top}$，其中 $e_{1}$ 是 $\\mathbb{R}^{2}$ 中的第一个标准基向量。定义方向 $H = -2\\, e_{1} e_{1}^{\\top} + e_{2} e_{2}^{\\top}$，并令 $\\widehat{H} = H / \\|H\\|_{F}$ 为其单位弗罗贝尼乌斯范数归一化。\n\n你的任务是：\n1. 构造一个线性测量算子 $\\mathcal{A} : \\mathbb{R}^{2 \\times 2} \\to \\mathbb{R}^{3}$，该算子由形如 $\\mathcal{A}(X) = \\big(\\langle B_{1}, X \\rangle, \\langle B_{2}, X \\rangle, \\langle B_{3}, X \\rangle\\big)$ 的线性泛函指定，其中矩阵 $B_{1}, B_{2}, B_{3}$ 被明确给出，使得 $\\ker(\\mathcal{A}) = \\operatorname{span}\\{H\\}$ 且 $\\mathcal{A}(X^{\\star})$ 是良定义的。\n2. 仅使用凸分析的基本原理（范数的对偶性、次微分的定义和一阶最优性），严格证明凸规划 $\\min_{X} \\|X\\|_{*}$（约束条件为 $\\mathcal{A}(X) = \\mathcal{A}(X^{\\star})$）由于在 $X^{\\star}$ 处存在一个下降方向 $H \\in \\ker(\\mathcal{A})$ 而未能恢复 $X^{\\star}$。\n3. 使用次微分如下量化 $\\ker(\\mathcal{A})$ 与 $\\|\\cdot\\|_{*}$ 在 $X^{\\star}$ 处的下降锥之间的未对齐程度。定义\n$$\n\\eta(\\mathcal{A}, X^{\\star}) \\triangleq \\sup_{G \\in \\partial \\| \\cdot \\|_{*}(X^{\\star})} \\langle G, \\widehat{H} \\rangle,\n$$\n其中 $\\partial \\| \\cdot \\|_{*}(X^{\\star})$ 表示核范数在 $X^{\\star}$ 处的次微分。计算 $\\eta(\\mathcal{A}, X^{\\star})$ 的精确值。\n\n将你的最终答案表示为一个精确的实数。不需要四舍五入。不涉及单位。", "solution": "我们在赋以弗罗贝尼乌斯内积和核范数的 $\\mathbb{R}^{2 \\times 2}$ 空间中进行计算。目标是 $X^{\\star} = e_{1} e_{1}^{\\top}$，该矩阵在 $(1,1)$ 位置的元素为 $1$，其余位置的元素均为零。方向是 $H = -2\\, e_{1} e_{1}^{\\top} + e_{2} e_{2}^{\\top}$，因此 $H$ 是一个对角矩阵，其对角线上的元素为 $-2$ 和 $1$。\n\n第1步：构造满足 $\\ker(\\mathcal{A}) = \\operatorname{span}\\{H\\}$ 的 $\\mathcal{A}$。\n由 $\\mathcal{A}(X) = \\big(\\langle B_{1}, X \\rangle, \\langle B_{2}, X \\rangle, \\langle B_{3}, X \\rangle\\big)$ 指定的线性算子 $\\mathcal{A}$ 的核等于 $\\{B_{1}, B_{2}, B_{3}\\}$ 的生成空间关于弗罗贝尼乌斯内积的正交补。为使 $\\ker(\\mathcal{A}) = \\operatorname{span}\\{H\\}$ 成立，选择 $B_{1}, B_{2}, B_{3}$ 构成 $H^{\\perp}$ 的一组基。\n\n由于 $H$ 是对角矩阵，任何非对角矩阵都与 $H$ 正交。因此，我们可以取\n$$\nB_{1} = e_{1} e_{2}^{\\top}, \\quad B_{2} = e_{2} e_{1}^{\\top}.\n$$\n对于对角子空间中的第三个方向，选择与 $H$ 正交的 $B_{3}$。一个方便的选择是\n$$\nB_{3} = e_{1} e_{1}^{\\top} + 2\\, e_{2} e_{2}^{\\top}.\n$$\n确实，\n$$\n\\langle B_{3}, H \\rangle = \\langle e_{1} e_{1}^{\\top} + 2 e_{2} e_{2}^{\\top},\\, -2 e_{1} e_{1}^{\\top} + e_{2} e_{2}^{\\top} \\rangle = -2 + 2 = 0.\n$$\n显然，$B_{1}, B_{2}, B_{3}$ 线性无关且与 $H$ 正交，所以它们生成了 $H^{\\perp}$。因此，通过这个选择，\n$$\n\\mathcal{A}(X) = \\big(\\langle e_{1} e_{2}^{\\top}, X \\rangle,\\ \\langle e_{2} e_{1}^{\\top}, X \\rangle,\\ \\langle e_{1} e_{1}^{\\top} + 2 e_{2} e_{2}^{\\top}, X \\rangle\\big)\n$$\n满足 $\\ker(\\mathcal{A}) = \\operatorname{span}\\{H\\}$。我们还有\n$$\n\\mathcal{A}(X^{\\star}) = \\big(0,\\ 0,\\ 1\\big).\n$$\n\n第2步：通过一个可行下降方向证明核范数恢复失败。\n我们回顾一个凸分析的基本事实：对于一个真凸函数 $f$，在 $x$ 处沿方向 $D$ 的方向导数满足\n$$\nf'(x; D) = \\sup_{g \\in \\partial f(x)} \\langle g, D \\rangle,\n$$\n其中 $\\partial f(x)$ 是次微分。如果 $f'(x; D)  0$，那么对于足够小的 $t > 0$，有 $f(x + t D)  f(x)$。\n\n我们将证明核范数 $\\| \\cdot \\|_{*}$ 在 $X^{\\star}$ 处沿 $H$ 方向的方向导数是严格为负的。为了计算这个值，我们使用两个经过充分检验的事实：\n\n- 核范数是谱范数的对偶：$\\|X\\|_{*} = \\sup_{\\|Y\\|_{2} \\leq 1} \\langle Y, X \\rangle$。\n- 对于秩为 $r$、奇异值分解 (SVD) 为 $X^{\\star} = U \\Sigma V^{\\top}$ 的 $X^{\\star}$，其核范数的次微分是\n$$\n\\partial \\| \\cdot \\|_{*}(X^{\\star}) = \\{ U V^{\\top} + W : \\|W\\|_{2} \\leq 1,\\ U^{\\top} W = 0,\\ W V = 0 \\}.\n$$\n\n对于 $X^{\\star} = e_{1} e_{1}^{\\top}$，一组SVD由 $U = V = e_{1}$ 和 $\\Sigma = [1]$ 给出。因此，$U V^{\\top} = e_{1} e_{1}^{\\top}$。在 $X^{\\star}$ 处的切空间是\n$$\nT = \\{ e_{1} a^{\\top} + b e_{1}^{\\top} : a, b \\in \\mathbb{R}^{2} \\},\n$$\n在 $2 \\times 2$ 矩阵中，这包括所有第一行和第一列任意（在 $(1,1)$ 项有重复计算）的矩阵。其正交补为\n$$\nT^{\\perp} = \\operatorname{span}\\{ e_{2} e_{2}^{\\top} \\}.\n$$\n\n将 $H$ 分解为 $H = H_{T} + H_{T^{\\perp}}$。由于 $H$ 是对角矩阵，对角元为 $-2$ 和 $1$，我们有\n$$\nH_{T} = -2\\, e_{1} e_{1}^{\\top}, \\qquad H_{T^{\\perp}} = e_{2} e_{2}^{\\top}.\n$$\n使用上面次微分的形式，结合 $T$ 和 $T^{\\perp}$ 的正交性，我们计算\n$$\n\\sup_{G \\in \\partial \\| \\cdot \\|_{*}(X^{\\star})} \\langle G, H \\rangle\n= \\langle e_{1} e_{1}^{\\top}, H_{T} \\rangle + \\sup_{\\substack{W \\in T^{\\perp} \\\\ \\|W\\|_{2} \\leq 1}} \\langle W, H_{T^{\\perp}} \\rangle.\n$$\n第一项是 $\\langle e_{1} e_{1}^{\\top}, -2 e_{1} e_{1}^{\\top} \\rangle = -2$。第二项是在 $H_{T^{\\perp}}$ 处求值的谱范数球的支撑函数，它等于 $H_{T^{\\perp}}$ 的核范数：\n$$\n\\sup_{\\|W\\|_{2} \\leq 1} \\langle W, H_{T^{\\perp}} \\rangle = \\| H_{T^{\\perp}} \\|_{*}.\n$$\n此处 $H_{T^{\\perp}} = e_{2} e_{2}^{\\top}$ 是秩为 1 且奇异值为 1 的矩阵，所以 $\\| H_{T^{\\perp}} \\|_{*} = 1$。因此\n$$\n\\sup_{G \\in \\partial \\| \\cdot \\|_{*}(X^{\\star})} \\langle G, H \\rangle = -2 + 1 = -1.\n$$\n将 $H$ 标准化为 $\\widehat{H}$ 会使方向导数按 $\\|H\\|_{F}$ 比例缩放，所以我们计算\n$$\n\\|H\\|_{F} = \\sqrt{(-2)^{2} + 1^{2}} = \\sqrt{5}, \\qquad\n\\sup_{G \\in \\partial \\| \\cdot \\|_{*}(X^{\\star})} \\langle G, \\widehat{H} \\rangle = \\frac{-1}{\\sqrt{5}}.\n$$\n由于这个量是严格为负的，核范数在 $X^{\\star}$ 处沿 $\\widehat{H}$ 的方向导数是负的。因此存在足够小的 $t > 0$ 使得\n$$\n\\|X^{\\star} + t \\widehat{H}\\|_{*}  \\|X^{\\star}\\|_{*}.\n$$\n此外，因为 $H \\in \\ker(\\mathcal{A})$，我们有 $\\mathcal{A}(X^{\\star} + t H) = \\mathcal{A}(X^{\\star})$，这表明可行集包含一个核范数严格小于 $X^{\\star}$ 的点。因此，该规划 $\\min_{X} \\|X\\|_{*}$（约束条件为 $\\mathcal{A}(X) = \\mathcal{A}(X^{\\star})$）未能恢复 $X^{\\star}$。\n\n为完整起见，我们也可以直接验证这个下降过程：对于 $0  t  \\tfrac{1}{2}$，\n$$\nX^{\\star} + t H = (1 - 2 t)\\, e_{1} e_{1}^{\\top} + t\\, e_{2} e_{2}^{\\top} = \\operatorname{diag}(1 - 2 t,\\, t),\n$$\n其核范数为 $(1 - 2 t) + t = 1 - t  1 = \\|X^{\\star}\\|_{*}$，同时 $\\mathcal{A}(X^{\\star} + t H) = \\mathcal{A}(X^{\\star})$。\n\n第3步：未对齐程度的量化。\n根据定义，\n$$\n\\eta(\\mathcal{A}, X^{\\star}) \\triangleq \\sup_{G \\in \\partial \\| \\cdot \\|_{*}(X^{\\star})} \\langle G, \\widehat{H} \\rangle = \\frac{-1}{\\sqrt{5}}.\n$$\n这是精确值；不需要四舍五入。\n\n因此，所求的未对齐度量为 $\\eta(\\mathcal{A}, X^{\\star}) = - 1 / \\sqrt{5}$。", "answer": "$$\\boxed{-\\frac{1}{\\sqrt{5}}}$$", "id": "3469376"}]}