{"hands_on_practices": [{"introduction": "同步正交匹配追踪（SOMP）是联合稀疏恢复领域一种重要的贪婪算法。本练习将引导你深入该算法的核心机制，即在每次迭代中如何选择与当前残差最相关的原子（或字典列）。通过从头推导并应用这一选择准则 [@problem_id:3455704]，你不仅能学会一个公式，更能掌握贪婪算法解决多测量向量（MMV）问题的基本思路和操作。", "problem": "考虑一个联合稀疏恢复设定，其中感知维度 $m=3$ 且测量向量个数 $L=3$。设字典 $A \\in \\mathbb{R}^{3 \\times 5}$ 具有单位范数列 $A_{:,j}$，其形式如下\n$$\nA \\;=\\; \\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{3}}  0 \\\\\n0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{3}}  0 \\\\\n0  0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{3}}  1\n\\end{pmatrix},\n$$\n因此 $A_{:,1} = (1,0,0)^\\top$, $A_{:,2} = \\big(\\tfrac{1}{\\sqrt{2}},\\tfrac{1}{\\sqrt{2}},0\\big)^\\top$, $A_{:,3} = \\big(0,\\tfrac{1}{\\sqrt{2}},\\tfrac{1}{\\sqrt{2}}\\big)^\\top$, $A_{:,4} = \\big(\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}\\big)^\\top$, 且 $A_{:,5} = (0,0,1)^\\top$。未知的联合稀疏系数矩阵 $X^\\star \\in \\mathbb{R}^{5 \\times 3}$ 恰好有两个非零行，位于索引 $\\{2,4\\}$ 处，其中第2行等于\n$$\nv_2 \\;=\\; \\begin{pmatrix} 2  0  -1 \\end{pmatrix}\n$$\n第4行等于\n$$\nv_4 \\;=\\; \\begin{pmatrix} 1  -2  2 \\end{pmatrix},\n$$\n所有其他行均为零行。无噪声测量值由 $Y = A X^\\star \\in \\mathbb{R}^{3 \\times 3}$ 给出。\n\n在同步正交匹配追踪（Simultaneous Orthogonal Matching Pursuit, SOMP）算法的初始化阶段，残差为 $R = Y - A X$，其中 $X$ 等于零矩阵，因此 $R=Y$。该算法通过贪婪地最大化由限制在单个列子空间上的最小二乘更新所产生的残差弗罗贝尼乌斯范数 $\\|R\\|_{F}$ 的瞬时减小量来选择第一个列（原子）。\n\n任务：\n- 仅从弗罗贝尼乌斯范数和到一维子空间的正交投影的定义出发，推导用 $A$、$R$ 和内积表示的单步贪婪选择规则；不要假定任何预先给出的SOMP公式。\n- 然后，将您推导出的规则应用于上述特定的 $A$ 和 $X^\\star$，计算第一个被选中的原子索引 $j^\\star \\in \\{1,2,3,4,5\\}$。您可以利用线性性质计算 $A^\\top Y$ 而无需显式地构造 $Y$。\n\n请以单个整数 $j^\\star$ 的形式提供您的最终答案；无需四舍五入，也不涉及单位。", "solution": "该问题是有效的，因为它在科学上基于稀疏恢复理论，问题设定良好，目标明确，并为其解决提供了完整且一致的数据集。\n\n第一个任务是为同步正交匹配追踪（SOMP）算法的第一步推导贪婪选择规则。该算法以一个空支撑集 $S_0 = \\emptyset$、一个零系数矩阵估计 $X_0 = \\mathbf{0}_{5 \\times 3}$ 和一个初始残差 $R_0 = Y - A X_0 = Y$ 开始。目标是选择一个索引 $j \\in \\{1, 2, 3, 4, 5\\}$，当它被添加到支撑集中时，能导致残差的弗罗贝尼乌斯范数出现最大程度的减小。\n\n我们考虑将单个原子（对应索引 $j$）添加到支撑集中。新的支撑集将是 $S_1 = \\{j\\}$。更新后的系数矩阵，我们记为 $X_1^{(j)}$，将只有其第 $j$ 行为非零。设该行为 $x_j^\\top \\in \\mathbb{R}^{1 \\times 3}$。相应的信号估计为 $A X_1^{(j)} = A_{:,j} x_j^\\top$。\n\n为了找到最优系数行 $x_j^\\top$，我们求解一个最小二乘问题，以最小化新残差的范数，$R_1^{(j)} = R_0 - A_{:,j} x_j^\\top = Y - A_{:,j} x_j^\\top$：\n$$\n\\min_{x_j^\\top \\in \\mathbb{R}^{1 \\times 3}} \\|Y - A_{:,j} x_j^\\top\\|_F^2\n$$\n弗罗贝尼乌斯范数的平方是矩阵各列的欧几里得范数平方之和。设 $Y = \\begin{pmatrix} y_1  y_2  y_3 \\end{pmatrix}$ 和 $x_j^\\top = \\begin{pmatrix} x_{j,1}  x_{j,2}  x_{j,3} \\end{pmatrix}$。该优化问题可以对每一列 $l \\in \\{1, 2, 3\\}$ 进行解耦：\n$$\n\\min_{x_{j,1}, x_{j,2}, x_{j,3}} \\sum_{l=1}^{3} \\|y_l - A_{:,j} x_{j,l}\\|_2^2\n$$\n这等价于求解三个独立的一维最小二乘问题：\n$$\n\\min_{x_{j,l} \\in \\mathbb{R}} \\|y_l - A_{:,j} x_{j,l}\\|_2^2 \\quad \\text{for } l \\in \\{1, 2, 3\\}\n$$\n每一个问题的解是向量 $y_l$ 在由向量 $A_{:,j}$ 张成的子空间上的正交投影。最优系数 $x_{j,l}^{\\text{opt}}$ 由下式给出：\n$$\nx_{j,l}^{\\text{opt}} = \\frac{A_{:,j}^\\top y_l}{\\|A_{:,j}\\|_2^2}\n$$\n问题陈述所有 $A$ 的列都是单位范数，所以 $\\|A_{:,j}\\|_2^2 = 1$。这将最优系数简化为 $x_{j,l}^{\\text{opt}} = A_{:,j}^\\top y_l$。\n\n结合所有列 $l$ 的结果，最优系数行向量 $x_j^{\\text{opt}\\top}$ 由下式给出：\n$$\nx_j^{\\text{opt}\\top} = \\begin{pmatrix} A_{:,j}^\\top y_1  A_{:,j}^\\top y_2  A_{:,j}^\\top y_3 \\end{pmatrix} = A_{:,j}^\\top Y\n$$\n新的残差是 $R_1^{(j)} = Y - A_{:,j} (A_{:,j}^\\top Y)$。项 $A_{:,j} (A_{:,j}^\\top Y)$ 表示 $Y$ 的各列在由 $A_{:,j}$ 张成的子空间上的正交投影。设 $P_j = A_{:,j} A_{:,j}^\\top$ 是到该子空间的投影矩阵。那么 $R_1^{(j)} = (I - P_j) Y$。\n\n根据正交投影的勾股定理，$Y$ 的能量可以分解为：\n$$\n\\|Y\\|_F^2 = \\|P_j Y\\|_F^2 + \\|(I - P_j) Y\\|_F^2 = \\|P_j Y\\|_F^2 + \\|R_1^{(j)}\\|_F^2\n$$\n残差的弗罗贝尼乌斯范数平方的减小量是 $\\|R_0\\|_F^2 - \\|R_1^{(j)}\\|_F^2 = \\|Y\\|_F^2 - \\|R_1^{(j)}\\|_F^2 = \\|P_j Y\\|_F^2$。\n\nSOMP选择规则是选择使这个减小量最大化的索引 $j$：\n$$\nj^\\star = \\arg\\max_{j \\in \\{1, ..., 5\\}} \\|P_j Y\\|_F^2 = \\arg\\max_{j \\in \\{1, ..., 5\\}} \\|A_{:,j} (A_{:,j}^\\top Y)\\|_F^2\n$$\n我们来分析被最大化的项。设 $c_j^\\top = A_{:,j}^\\top Y$ 为系数行向量。矩阵 $A_{:,j} c_j^\\top$ 是一个秩一矩阵。其弗罗贝尼乌斯范数的平方是：\n$$\n\\|A_{:,j} c_j^\\top\\|_F^2 = \\mathrm{Tr}((A_{:,j} c_j^\\top)^\\top (A_{:,j} c_j^\\top)) = \\mathrm{Tr}(c_j A_{:,j}^\\top A_{:,j} c_j^\\top) = \\mathrm{Tr}(c_j \\|A_{:,j}\\|_2^2 c_j^\\top)\n$$\n由于 $\\|A_{:,j}\\|_2^2=1$，这变为 $\\mathrm{Tr}(c_j c_j^\\top) = \\mathrm{Tr}(c_j^\\top c_j) = \\|c_j\\|_2^2$。\n所以，选择规则是选择使系数行向量 $c_j^\\top = A_{:,j}^\\top Y$ 的欧几里得范数平方最大化的索引 $j$。该行向量是矩阵乘积 $A^\\top Y$ 的第 $j$ 行。因此，选择规则是：\n$$\nj^\\star = \\arg\\max_{j \\in \\{1, ..., 5\\}} \\| (A^\\top R_0)_{j,:} \\|_2^2 = \\arg\\max_{j \\in \\{1, ..., 5\\}} \\| (A^\\top Y)_{j,:} \\|_2^2\n$$\n推导到此完成。\n\n第二个任务是应用此规则。我们需要计算 $C = A^\\top Y$ 并找出具有最大 $\\ell_2$-范数的行。建议我们使用线性性质。测量矩阵 $Y$ 由 $Y = A X^\\star$ 给出。$X^\\star$ 的结构是只有其第二行和第四行为非零。设这些行为 $v_2 = \\begin{pmatrix} 2  0  -1 \\end{pmatrix}$ 和 $v_4 = \\begin{pmatrix} 1  -2  2 \\end{pmatrix}$。我们可以将 $Y$ 写成外积之和：\n$$\nY = \\sum_{k=1}^{5} A_{:,k} (X^\\star)_{k,:} = A_{:,2} v_2 + A_{:,4} v_4\n$$\n现在，我们计算 $C = A^\\top Y$：\n$$\nC = A^\\top (A_{:,2} v_2 + A_{:,4} v_4) = (A^\\top A_{:,2}) v_2 + (A^\\top A_{:,4}) v_4\n$$\n设 $G = A^\\top A$ 为 $A$ 的格拉姆矩阵（Gram matrix）。项 $A^\\top A_{:,k}$ 是 $G$ 的第 $k$ 列，记为 $G_{:,k}$。因此：\n$$\nC = G_{:,2} v_2 + G_{:,4} v_4\n$$\n$C$ 的第 $j$ 行，记为 $C_{j,:}$，是由下式给出的行向量：\n$$\nC_{j,:} = G_{j2} v_2 + G_{j4} v_4\n$$\n其中 $G_{jk}$ 是 $G$ 中第 $j$ 行第 $k$ 列的元素。我们需要计算 $\\|C_{j,:}\\|_2^2$：\n$$\n\\|C_{j,:}\\|_2^2 = \\|G_{j2} v_2 + G_{j4} v_4\\|_2^2 = G_{j2}^2 \\|v_2\\|_2^2 + G_{j4}^2 \\|v_4\\|_2^2 + 2 G_{j2} G_{j4} \\langle v_2, v_4 \\rangle\n$$\n我们来计算 $v_2$ 和 $v_4$ 的范数和内积：\n$\\|v_2\\|_2^2 = 2^2 + 0^2 + (-1)^2 = 4 + 1 = 5$。\n$\\|v_4\\|_2^2 = 1^2 + (-2)^2 + 2^2 = 1 + 4 + 4 = 9$。\n$\\langle v_2, v_4 \\rangle = (2)(1) + (0)(-2) + (-1)(2) = 2 - 2 = 0$。\n由于 $v_2$ 和 $v_4$ 是正交的，范数平方的表达式简化为：\n$$\n\\|C_{j,:}\\|_2^2 = 5 G_{j2}^2 + 9 G_{j4}^2\n$$\n接下来，我们计算格拉姆矩阵 $G=A^\\top A$ 的必要元素，其中 $A_{:,j}^\\top A_{:,k} = G_{jk}$。\n$A = \\begin{pmatrix} 1  \\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{3}}  1 \\end{pmatrix}$。\n所需的项来自 $G$ 的第二列和第四列。对角线上的项是 $G_{jj}=1$。\n$G_{12} = A_{:,1}^\\top A_{:,2} = \\frac{1}{\\sqrt{2}}$。\n$G_{22} = 1$。\n$G_{32} = A_{:,3}^\\top A_{:,2} = \\frac{1}{2}$。\n$G_{42} = A_{:,4}^\\top A_{:,2} = \\frac{1}{\\sqrt{3}}\\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{3}}\\frac{1}{\\sqrt{2}} = \\frac{2}{\\sqrt{6}} = \\sqrt{\\frac{2}{3}}$。\n$G_{52} = A_{:,5}^\\top A_{:,2} = 0$。\n\n$G_{14} = A_{:,1}^\\top A_{:,4} = \\frac{1}{\\sqrt{3}}$。\n$G_{24} = G_{42} = \\sqrt{\\frac{2}{3}}$。\n$G_{34} = A_{:,3}^\\top A_{:,4} = \\frac{1}{\\sqrt{2}}\\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{2}}\\frac{1}{\\sqrt{3}} = \\frac{2}{\\sqrt{6}} = \\sqrt{\\frac{2}{3}}$。\n$G_{44} = 1$。\n$G_{54} = A_{:,5}^\\top A_{:,4} = \\frac{1}{\\sqrt{3}}$。\n\n现在我们为每个 $j \\in \\{1, 2, 3, 4, 5\\}$ 计算 $f(j) = 5 G_{j2}^2 + 9 G_{j4}^2$。\n对于 $j=1$： $f(1) = 5(G_{12})^2 + 9(G_{14})^2 = 5(\\frac{1}{\\sqrt{2}})^2 + 9(\\frac{1}{\\sqrt{3}})^2 = 5(\\frac{1}{2}) + 9(\\frac{1}{3}) = \\frac{5}{2} + 3 = 5.5$。\n对于 $j=2$： $f(2) = 5(G_{22})^2 + 9(G_{24})^2 = 5(1)^2 + 9(\\sqrt{\\frac{2}{3}})^2 = 5(1) + 9(\\frac{2}{3}) = 5 + 6 = 11$。\n对于 $j=3$： $f(3) = 5(G_{32})^2 + 9(G_{34})^2 = 5(\\frac{1}{2})^2 + 9(\\sqrt{\\frac{2}{3}})^2 = 5(\\frac{1}{4}) + 9(\\frac{2}{3}) = \\frac{5}{4} + 6 = 7.25$。\n对于 $j=4$： $f(4) = 5(G_{42})^2 + 9(G_{44})^2 = 5(\\sqrt{\\frac{2}{3}})^2 + 9(1)^2 = 5(\\frac{2}{3}) + 9 = \\frac{10}{3} + 9 = \\frac{10+27}{3} = \\frac{37}{3} \\approx 12.33$。\n对于 $j=5$： $f(5) = 5(G_{52})^2 + 9(G_{54})^2 = 5(0)^2 + 9(\\frac{1}{\\sqrt{3}})^2 = 0 + 9(\\frac{1}{3}) = 3$。\n\n比较这些值：\n$f(1) = 5.5$\n$f(2) = 11$\n$f(3) = 7.25$\n$f(4) = \\frac{37}{3} \\approx 12.33$\n$f(5) = 3$\n最大值是 $f(4) = \\frac{37}{3}$。这对应于索引 $j=4$。因此，SOMP选择的第一个原子是 $j^\\star = 4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "3455704"}, {"introduction": "块稀疏模型的恢复性能保证，很大程度上取决于传感矩阵的特定属性。块限制等距性质（Block Restricted Isometry Property, BRIP）是其中一个核心概念，它确保了传感矩阵能够近似保持所有块稀疏向量的能量。通过编程实践 [@problem_id:3455725] 来经验性地计算块限制等距常数（BRIC），你将把这个抽象的理论性质转化为一个可触摸、可计算的量，从而加深对恢复保证条件的理解。", "problem": "考虑一个实数或复数传感矩阵 $A \\in \\mathbb{C}^{m \\times n}$，其列被划分为 $G$ 个不相交的组（块）$\\{ \\mathcal{B}_1, \\ldots, \\mathcal{B}_G \\}$，使得 $\\bigcup_{g=1}^G \\mathcal{B}_g = \\{1,2,\\ldots,n\\}$ 且对于所有 $g \\neq g'$ 都有 $\\mathcal{B}_g \\cap \\mathcal{B}_{g'} = \\emptyset$。如果一个向量 $x \\in \\mathbb{C}^n$ 的支撑集包含在至多 $s$ 个块的并集中，则称该向量是 $s$-块稀疏的。块限制等距性质（Block Restricted Isometry Property, RIP）常数，也称为块限制等距常数（Block Restricted Isometry Constant, BRIC），记作 $\\delta_s^B$，被定义为满足以下不等式的最小 $\\delta \\ge 0$，对于任意 $s$-块稀疏的 $x \\in \\mathbb{C}^n$：\n$$\n(1 - \\delta)\\,\\|x\\|_2^2 \\le \\|A x\\|_2^2 \\le (1 + \\delta)\\,\\|x\\|_2^2.\n$$\n等价地，对于至多 $s$ 个块的每个并集 $S \\subseteq \\{1,\\ldots,G\\}$，令 $A_S$ 表示由 $A$ 中索引为 $\\bigcup_{g \\in S} \\mathcal{B}_g$ 的列构成的子矩阵，则格拉姆矩阵（Gram matrix）$A_S^* A_S$ 的极值二次型通过其特征值 $\\{\\lambda_i\\}$（即 $A_S$ 的奇异值 $\\{\\sigma_i\\}$ 的平方）来控制 $\\delta_s^B$：\n$$\n\\delta_s^B = \\sup_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| \\le s}} \\max\\left\\{\\lambda_{\\max}(A_S^*A_S) - 1,\\; 1 - \\lambda_{\\min}(A_S^*A_S)\\right\\} = \\sup_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| \\le s}} \\max\\left\\{\\sigma_{\\max}(A_S)^2 - 1,\\; 1 - \\sigma_{\\min}(A_S)^2\\right\\}.\n$$\n在实践中，对于给定的 $A$ 和块划分，人们通常通过枚举所有由 $s$ 个块组成的支撑集，计算每个对应子矩阵的奇异值，并取与 $1$ 的最坏情况偏差，来经验性地估计 $\\delta_s^B$。为了将结果置于统一的尺度上，标准做法是在计算块限制等距常数之前，首先将 $A$ 的每一列归一化为单位 $\\ell_2$ 范数。\n\n你的任务是编写一个完整的、可运行的程序，通过评估所有由恰好两个块组成的支撑集上的最大和最小奇异值，来计算给定的小矩阵 $A$ 和块划分的 $\\delta_2^B$ 的经验估计值，并报告所得的界 $\\widehat{\\delta}_2^B = \\max\\{\\beta - 1,\\, 1 - \\alpha\\}$，其中\n$$\n\\alpha = \\min_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| = 2}} \\sigma_{\\min}(A_S)^2, \\quad \\beta = \\max_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| = 2}} \\sigma_{\\max}(A_S)^2.\n$$\n程序必须在计算前对 $A$ 进行列归一化（即，缩放每列使其 $\\ell_2$-范数等于 $1$）。\n\n设计程序以处理以下测试套件，其中每个测试用例指定了如何构造 $A$ 和块划分：\n\n- 测试用例 1（一般情况）：令 $m = 20$，$n = 24$，$G = 6$ 个大小相等的块，即 $|\\mathcal{B}_g| = 4$。使用固定的随机种子 $0$，构造 $A$，其元素为从 $\\mathcal{N}(0,1)$ 抽取的独立同分布的实高斯项。将列归一化为单位 $\\ell_2$ 范数，然后通过枚举所有块对来计算 $\\widehat{\\delta}_2^B$。\n\n- 测试用例 2（秩亏缺边界情况）：令 $m = 3$，$n = 5$，$G = 3$ 个块，大小分别为 $|\\mathcal{B}_1| = 2$，$|\\mathcal{B}_2| = 2$，$|\\mathcal{B}_3| = 1$。使用固定的随机种子 $1$，构造 $A$，其元素为从 $\\mathcal{N}(0,1)$ 抽取的独立同分布的实高斯项。将列归一化并计算 $\\widehat{\\delta}_2^B$。请注意，任何选择 $4$ 列构成一个只有 $3$ 行的矩阵的双块并集，都将产生至少一个零奇异值，导致对于此类支撑集有 $1 - \\sigma_{\\min}(A_S)^2 \\ge 1$。\n\n- 测试用例 3（理想情况）：令 $m = 12$，$n = 12$，$G = 3$ 个大小相等的块，即 $|\\mathcal{B}_g| = 4$。设 $A$ 等于 $12 \\times 12$ 的单位矩阵。其列已经归一化。通过枚举所有块对来计算 $\\widehat{\\delta}_2^B$。在这种情况下，$\\widehat{\\delta}_2^B$ 应精确为 $0$，因为由单位矩阵的列构成的任何子矩阵的所有奇异值都等于 $1$。\n\n你的程序应该生成单行输出，其中包含三个测试用例的结果，形式为方括号内以逗号分隔的浮点数列表，四舍五入到六位小数，并按照上面给出的测试用例顺序排列（例如，“[0.123456,1.000000,0.000000]”）。不应产生任何其他输出。", "solution": "该问题要求计算块限制等距常数（BRIC）的经验估计值 $\\widehat{\\delta}_2^B$，该常数是针对给定的传感矩阵 $A \\in \\mathbb{C}^{m \\times n}$ 及其列的特定 $G$ 块划分。该常数是基于所有通过选择恰好两个列块形成的子矩阵来定义的。\n\n所提供的经验常数定义为：\n$$\n\\widehat{\\delta}_2^B = \\max\\{\\beta - 1,\\, 1 - \\alpha\\}\n$$\n其中\n$$\n\\alpha = \\min_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| = 2}} \\sigma_{\\min}(A_S)^2, \\quad \\beta = \\max_{\\substack{S \\subseteq \\{1,\\ldots,G\\} \\\\ |S| = 2}} \\sigma_{\\max}(A_S)^2\n$$\n这里，$S$ 是一个包含两个块索引的集合，$A_S$ 是由 $S$ 中各块的列构成的 $A$ 的子矩阵，$\\sigma_{\\min}(A_S)$ 和 $\\sigma_{\\max}(A_S)$ 分别是 $A_S$ 的最小和最大奇异值。$A_S$ 的奇异值与格拉姆矩阵 $A_S^* A_S$ 的特征值之间的关系由 $\\sigma_i(A_S)^2 = \\lambda_i(A_S^* A_S)$ 给出。\n\n计算过程包括几个不同的步骤，每个测试用例都将遵循这些步骤。\n\n**步骤 1：列归一化**\n作为限制等距性质（Restricted Isometry Property）上下文中的标准预处理步骤，矩阵 $A$ 的每一列都必须被归一化为单位 $\\ell_2$ 范数。对于 $A$ 的每一列 $a_j$（其中 $j \\in \\{1, \\ldots, n\\}$），归一化后的列 $a'_j$ 计算如下：\n$$\na'_j = \\frac{a_j}{\\|a_j\\|_2}\n$$\n这确保了单列子矩阵 $A_{\\{j\\}}$ 的平凡情况有 $\\sigma_{\\max}(A_{\\{j\\}})^2 = \\|a'_j\\|_2^2 = 1$，从而为 RIP 条件校准了基线。所有后续计算都在这个归一化后的矩阵上进行，为简单起见，我们仍将其记为 $A$。\n\n**步骤 2：块划分与子矩阵枚举**\n$m \\times n$ 矩阵 $A$ 的列被划分为 $G$ 个不相交的索引集 $\\{\\mathcal{B}_1, \\ldots, \\mathcal{B}_G\\}$。\n$\\widehat{\\delta}_2^B$ 的计算需要检查所有由恰好两个块的并集构成的可能子矩阵。这样的块对数量由二项式系数 $\\binom{G}{2}$ 给出。对于每一对块索引 $\\{g_1, g_2\\}$（其中 $1 \\le g_1  g_2 \\le G$），我们形成一个列索引集 $I_S = \\mathcal{B}_{g_1} \\cup \\mathcal{B}_{g_2}$。然后通过选择索引在 $I_S$ 中的 $A$ 的列来构造子矩阵 $A_S$。\n\n**步骤 3：奇异值分析与极值跟踪**\n对于上一步中构造的每个子矩阵 $A_S$，我们必须计算其奇异值。奇异值的平方 $\\sigma_i(A_S)^2$ 对应于格拉姆矩阵 $A_S^* A_S$ 的特征值。我们关心的是极值奇异值的平方：$\\sigma_{\\min}(A_S)^2$ 和 $\\sigma_{\\max}(A_S)^2$。\n\n为了找到 $\\alpha$ 和 $\\beta$，我们初始化两个变量：$\\alpha$ 初始化为比任何可能的奇异值平方都大的值（例如 $\\infty$），$\\beta$ 初始化为比任何可能的奇异值平方都小的值（例如 $0$，因为它们是非负的）。然后我们遍历所有 $\\binom{G}{2}$ 个唯一的块对。对于每个对应的子矩阵 $A_S$，我们执行以下更新：\n$$\n\\alpha \\leftarrow \\min(\\alpha, \\sigma_{\\min}(A_S)^2)\n$$\n$$\n\\beta \\leftarrow \\max(\\beta, \\sigma_{\\max}(A_S)^2)\n$$\n遍历所有块对后，$\\alpha$ 将持有最小奇异值平方的全局最小值，$\\beta$ 将持有最大奇异值平方的全局最大值。\n\n**步骤 4：最终计算**\n利用 $\\alpha$ 和 $\\beta$ 的最终值，根据定义计算经验常数 $\\widehat{\\delta}_2^B$：\n$$\n\\widehat{\\delta}_2^B = \\max(\\beta - 1, 1 - \\alpha)\n$$\n\n该算法将应用于三个测试用例中的每一个。\n\n**测试用例 1（一般情况）：**\n$m = 20$，$n = 24$，$G = 6$ 个大小为 $4$ 的块。从高斯分布 $\\mathcal{N}(0,1)$ 生成一个随机矩阵 $A$，种子为 $0$。归一化后，我们遍历 $\\binom{6}{2} = 15$ 对块。每个子矩阵 $A_S$ 的维度为 $20 \\times 8$。由于 $m > n_S$（其中 $n_S=8$），子矩阵是“高”的，很可能是满秩的，从而产生非零的最小奇异值。算法按上述描述进行。\n\n**测试用例 2（秩亏缺边界情况）：**\n$m = 3$，$n = 5$，$G = 3$，块大小分别为 $2$、$2$ 和 $1$。块索引为 $\\mathcal{B}_1 = \\{1, 2\\}$，$\\mathcal{B}_2 = \\{3, 4\\}$，$\\mathcal{B}_3 = \\{5\\}$。有 $\\binom{3}{2} = 3$ 对块需要考虑。\n\\begin{enumerate}\n    \\item $S = \\{1, 2\\}$：$A_S$ 由索引为 $\\mathcal{B}_1 \\cup \\mathcal{B}_2$ 的列构成，其大小为 $4$。矩阵 $A_S$ 是 $3 \\times 4$。由于列数（4）超过行数（3），$A_S$ 的秩最多为 3。因此，$A_S$ 必须至少有 $4-3=1$ 个零奇异值。这意味着 $\\sigma_{\\min}(A_S) = 0$。\n    \\item $S = \\{1, 3\\}$：$A_S$ 由索引为 $\\mathcal{B}_1 \\cup \\mathcal{B}_3$ 的列构成，其大小为 $3$。矩阵 $A_S$ 是 $3 \\times 3$。\n    \\item $S = \\{2, 3\\}$：$A_S$ 由索引为 $\\mathcal{B}_2 \\cup \\mathcal{B}_3$ 的列构成，其大小为 $3$。矩阵 $A_S$ 是 $3 \\times 3$。\n\\end{enumerate}\n对于 $S = \\{1, 2\\}$ 的秩亏缺子矩阵的存在保证了全局最小奇异值平方为 $\\alpha = 0$。因此，$1 - \\alpha = 1$。最终值将是 $\\widehat{\\delta}_2^B = \\max(\\beta - 1, 1)$，它必须至少为 $1$。\n\n**测试用例 3（理想情况）：**\n$m = 12$，$n = 12$，$G = 3$ 个大小为 $4$ 的块。矩阵 $A$ 是 $12 \\times 12$ 的单位矩阵 $I_{12}$。其列已经归一化。任何通过选取两个块形成的子矩阵 $A_S$ 都将由单位矩阵中 $8$ 个不同的列组成。根据定义，这些列是标准正交的。对于任何这样的 $12 \\times 8$ 子矩阵 $A_S$，其格拉姆矩阵为 $A_S^* A_S = I_8$，即 $8 \\times 8$ 的单位矩阵。$I_8$ 的所有特征值都等于 $1$。因此，对于每个可能的 $S$ 选择，我们都有 $\\sigma_{\\max}(A_S)^2 = 1$ 和 $\\sigma_{\\min}(A_S)^2 = 1$。这导致全局值为 $\\alpha = 1$ 和 $\\beta = 1$。最终得到的常数是 $\\widehat{\\delta}_2^B = \\max(1 - 1, 1 - 1) = 0$，这是一个表示没有失真的理想值。", "answer": "```python\nimport numpy as np\nfrom itertools import combinations\n\ndef compute_empirical_bric(A: np.ndarray, block_partition: list[list[int]]) - float:\n    \"\"\"\n    Computes the empirical Block Restricted Isometry Constant (BRIC) for s=2.\n\n    Args:\n        A: The sensing matrix (m x n).\n        block_partition: A list of lists, where each inner list contains the\n                         column indices for a block.\n\n    Returns:\n        The empirical BRIC value, delta_hat_2^B.\n    \"\"\"\n    # Step 1: Normalize columns to unit l2-norm.\n    # We add a small epsilon to avoid division by zero for potential zero columns,\n    # though not expected with the given test cases.\n    col_norms = np.linalg.norm(A, axis=0, keepdims=True)\n    epsilon = 1e-12\n    A_norm = A / (col_norms + epsilon)\n\n    num_blocks = len(block_partition)\n    \n    # Step 3: Initialize alpha and beta for extremal value tracking.\n    # Squared singular values are non-negative.\n    # min of min_squared_svd\n    alpha = np.inf\n    # max of max_squared_svd\n    beta = 0.0\n\n    # Step 2: Enumerate all pairs of blocks.\n    block_indices = range(num_blocks)\n    for g1, g2 in combinations(block_indices, 2):\n        # Form the submatrix index set\n        s_indices = block_partition[g1] + block_partition[g2]\n        \n        # Construct the submatrix A_S\n        A_S = A_norm[:, s_indices]\n\n        # Step 3 (cont.): Compute singular values of A_S.\n        # np.linalg.svd returns singular values in descending order.\n        s_values = np.linalg.svd(A_S, compute_uv=False)\n        \n        # Get squared extremal singular values\n        sigma_min_sq = s_values[-1]**2\n        sigma_max_sq = s_values[0]**2\n        \n        # Update alpha and beta\n        if sigma_min_sq  alpha:\n            alpha = sigma_min_sq\n        if sigma_max_sq  beta:\n            beta = sigma_max_sq\n            \n    # Step 4: Final calculation\n    # For a valid BRIC, alpha must be non-negative.\n    # The value 1-alpha represents the deviation from isometry on the lower bound.\n    # The value beta-1 represents the deviation from isometry on the upper bound.\n    delta_hat = max(beta - 1, 1 - alpha)\n    \n    return delta_hat\n\n\ndef solve():\n    \"\"\"\n    Solves the problem for the three specified test cases.\n    \"\"\"\n    results = []\n\n    # Test Case 1: General case\n    m1, n1, G1 = 20, 24, 6\n    seed1 = 0\n    rng1 = np.random.default_rng(seed1)\n    A1 = rng1.standard_normal((m1, n1))\n    block_size1 = n1 // G1\n    partition1 = [list(range(i * block_size1, (i + 1) * block_size1)) for i in range(G1)]\n    result1 = compute_empirical_bric(A1, partition1)\n    results.append(f\"{result1:.6f}\")\n\n    # Test Case 2: Rank-deficient edge case\n    m2, n2, G2 = 3, 5, 3\n    seed2 = 1\n    rng2 = np.random.default_rng(seed2)\n    A2 = rng2.standard_normal((m2, n2))\n    partition2 = [\n        [0, 1],\n        [2, 3],\n        [4]\n    ]\n    result2 = compute_empirical_bric(A2, partition2)\n    results.append(f\"{result2:.6f}\")\n\n    # Test Case 3: Ideal case\n    m3, n3, G3 = 12, 12, 3\n    A3 = np.identity(n3)\n    block_size3 = n3 // G3\n    partition3 = [list(range(i * block_size3, (i + 1) * block_size3)) for i in range(G3)]\n    result3 = compute_empirical_bric(A3, partition3)\n    results.append(f\"{result3:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "3455725"}, {"introduction": "除了贪婪算法，凸优化方法（如组基追踪）为块稀疏恢复提供了强大的理论保证。本练习将揭示这些方法背后严谨的数学原理，特别是通过KKT条件和对偶理论来验证解的唯一性。你将学习如何构建一个对偶向量，并通过检验对偶可行性条件 [@problem_id:3455751] 来判断真实稀疏信号能否被精确恢复，这是掌握组稀疏凸优化高级理论的关键一步。", "problem": "考虑无噪声块稀疏恢复问题，其组（块）基追踪公式为：最小化 $\\sum_{g \\in \\mathcal{G}} \\|x_g\\|_2$，约束条件为 $A x = y$，其中列索引集被划分为 $G$ 个块 $\\mathcal{G} = \\{g_1,\\dots,g_G\\}$，$x_g$ 表示 $x$ 限制在块 $g$ 上的子向量。对偶可行性条件通过混合范数 $\\|\\cdot\\|_{2,\\infty}$ 表示，定义为 $\\|Z\\|_{2,\\infty} = \\max_{g \\in \\mathcal{G}} \\|Z_g\\|_2$，其中 $Z_g$ 汇集了与块 $g$ 相关的元素。\n\n设 $A \\in \\mathbb{R}^{4 \\times 6}$ 是一个感知矩阵，其列 $\\{a_j\\}_{j=1}^6$ 被分为 3 个大小相等（为 2）的不相交块：$g_1 = \\{1,2\\}$，$g_2 = \\{3,4\\}$，$g_3 = \\{5,6\\}$。各列由下式给出\n- $a_1 = e_1$, $a_2 = e_2$, $a_3 = e_3$, $a_4 = e_4$，其中 $\\{e_i\\}_{i=1}^4$ 是 $\\mathbb{R}^4$ 的标准基；\n- $a_5 = \\frac{1}{\\sqrt{2}}(e_1 + e_3)$ 和 $a_6 = \\frac{1}{\\sqrt{2}}(e_2 - e_4)$。\n\n设真实系数向量 $x^\\star \\in \\mathbb{R}^6$ 是块稀疏的，其支撑集为 $S = \\{g_1, g_2\\}$，各块为\n- $x^\\star_{g_1} = \\begin{pmatrix}3 \\\\ 4\\end{pmatrix}$，\n- $x^\\star_{g_2} = \\begin{pmatrix}1 \\\\ 2\\end{pmatrix}$，\n- $x^\\star_{g_3} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，\n并令 $y = A x^\\star$。\n\n按块定义组符号映射 $\\operatorname{sgn}_G$ 为 $\\operatorname{sgn}_G(x_g) = x_g / \\|x_g\\|_2$（对于 $x_g \\neq 0$），而在 $x_g = 0$ 时未定义。约束凸规划的 Karush–Kuhn–Tucker (KKT) 条件，结合凸对偶性，意味着任何对偶最优向量 $u^\\star \\in \\mathbb{R}^4$ 都必须满足 $A_S^\\top u^\\star = \\operatorname{sgn}_G(x^\\star_S)$ 和 $\\|A_{S^c}^\\top u^\\star\\|_{2,\\infty} \\leq 1$，并且在补集上的严格不等式 $\\|A_{S^c}^\\top u^\\star\\|_{2,\\infty}  1$ 保证了 $x^\\star$ 的精确恢复。\n\n仅使用这些基本原理，完成以下任务：\n\n- 构建一个位于 $\\mathrm{range}(A_S)$ 中的对偶向量 $u \\in \\mathbb{R}^4$，并满足 $A_S^\\top u = \\operatorname{sgn}_G(x^\\star_S)$。\n- 计算 $A_{S^c}^\\top u$ 并精确评估混合范数 $\\|A_{S^c}^\\top u\\|_{2,\\infty}$，化简所有根式。\n\n你的最终答案必须是 $\\|A_{S^c}^\\top u\\|_{2,\\infty}$ 的精确值，以单一闭式表达式的形式给出，不带单位。不要在最终答案中提供中间步骤。", "solution": "该问题被验证为压缩感知领域中块稀疏恢复理论的一个适定、自洽且有科学依据的练习。所有必要信息均已提供，任务是基于基本原理执行一组特定的计算。\n\n目标是为一个特殊构造的对偶向量 $u$ 计算混合范数 $\\|A_{S^c}^\\top u\\|_{2,\\infty}$。我们分步进行。\n\n首先，我们根据给定信息确定矩阵和向量。感知矩阵为 $A \\in \\mathbb{R}^{4 \\times 6}$，其列为 $\\{a_j\\}_{j=1}^6$。这些列被划分为 3 个大小为 2 的块：$g_1 = \\{1,2\\}$，$g_2 = \\{3,4\\}$ 和 $g_3 = \\{5,6\\}$。真实系数向量 $x^\\star$ 是块稀疏的，其支撑集为 $S = \\{g_1, g_2\\}$。支撑集的补集是 $S^c = \\{g_3\\}$。\n\n子矩阵 $A_S$ 包含由支撑集 $S$ 索引的 $A$ 的列，即列 1, 2, 3, 4。\n$$A_S = [a_1, a_2, a_3, a_4] = [e_1, e_2, e_3, e_4] = I_4 \\in \\mathbb{R}^{4 \\times 4}$$\n其中 $I_4$ 是 $4 \\times 4$ 的单位矩阵。\n\n子矩阵 $A_{S^c}$ 包含由 $S^c$ 索引的列，即列 5, 6。\n$$A_{S^c} = [a_5, a_6] = \\left[ \\frac{1}{\\sqrt{2}}(e_1 + e_3), \\frac{1}{\\sqrt{2}}(e_2 - e_4) \\right] = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  0 \\\\ 0  -1 \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 2}$$\n\n接下来，我们计算组符号向量 $v = \\operatorname{sgn}_G(x_S^\\star)$。这是对支撑集 $S$ 中的每个块逐块执行的。\n对于块 $g_1$，我们有 $x^\\star_{g_1} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}$。其欧几里得范数为 $\\|x^\\star_{g_1}\\|_2 = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。\n$$\\operatorname{sgn}_G(x^\\star_{g_1}) = \\frac{x^\\star_{g_1}}{\\|x^\\star_{g_1}\\|_2} = \\frac{1}{5} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 3/5 \\\\ 4/5 \\end{pmatrix}$$\n对于块 $g_2$，我们有 $x^\\star_{g_2} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。其欧几里得范数为 $\\|x^\\star_{g_2}\\|_2 = \\sqrt{1^2 + 2^2} = \\sqrt{1+4} = \\sqrt{5}$。\n$$\\operatorname{sgn}_G(x^\\star_{g_2}) = \\frac{x^\\star_{g_2}}{\\|x^\\star_{g_2}\\|_2} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{5} \\\\ 2/\\sqrt{5} \\end{pmatrix}$$\n向量 $v = \\operatorname{sgn}_G(x_S^\\star)$ 是这些块向量的串联，对应于 $x_S^\\star$ 的结构：\n$$v = \\begin{pmatrix} 3/5 \\\\ 4/5 \\\\ 1/\\sqrt{5} \\\\ 2/\\sqrt{5} \\end{pmatrix} \\in \\mathbb{R}^4$$\n\n问题要求构造一个位于 $\\mathrm{range}(A_S)$ 中的对偶向量 $u$，并满足条件 $A_S^\\top u = v$。\n由于 $A_S = I_4$，其转置为 $A_S^\\top = I_4^\\top = I_4$。条件简化为 $I_4 u = v$，即 $u = v$。\n我们还必须确保 $u$ 位于 $A_S$ 的值域中。$A_S = I_4$ 的值域是整个空间 $\\mathbb{R}^4$。由于 $u=v$ 是 $\\mathbb{R}^4$ 中的一个向量，这个条件自动满足。\n因此，对偶向量为：\n$$u = \\begin{pmatrix} 3/5 \\\\ 4/5 \\\\ 1/\\sqrt{5} \\\\ 2/\\sqrt{5} \\end{pmatrix}$$\n\n现在我们计算向量 $w = A_{S^c}^\\top u$。$A_{S^c}$ 的转置是：\n$$A_{S^c}^\\top = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  0  1  0 \\\\ 0  1  0  -1 \\end{pmatrix}$$\n执行矩阵-向量乘法：\n$$w = A_{S^c}^\\top u = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  0  1  0 \\\\ 0  1  0  -1 \\end{pmatrix} \\begin{pmatrix} 3/5 \\\\ 4/5 \\\\ 1/\\sqrt{5} \\\\ 2/\\sqrt{5} \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} (1)(\\frac{3}{5}) + (1)(\\frac{1}{\\sqrt{5}}) \\\\ (1)(\\frac{4}{5}) + (-1)(\\frac{2}{\\sqrt{5}}) \\end{pmatrix}$$\n$$w = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{3}{5} + \\frac{1}{\\sqrt{5}} \\\\ \\frac{4}{5} - \\frac{2}{\\sqrt{5}} \\end{pmatrix}$$\n这个向量 $w$ 对应于非支撑集 $S^c$ 中的单个块 $g_3$。\n\n最后，我们评估混合范数 $\\|A_{S^c}^\\top u\\|_{2,\\infty}$。由于 $S^c$ 只包含一个块 $g_3$，该范数就是向量 $w$ 的欧几里得范数：\n$$\\|A_{S^c}^\\top u\\|_{2,\\infty} = \\|w_{g_3}\\|_2 = \\|w\\|_2$$\n我们计算欧几里得范数的平方 $\\|w\\|_2^2$：\n$$\\|w\\|_2^2 = \\left( \\frac{1}{\\sqrt{2}} \\left(\\frac{3}{5} + \\frac{1}{\\sqrt{5}}\\right) \\right)^2 + \\left( \\frac{1}{\\sqrt{2}} \\left(\\frac{4}{5} - \\frac{2}{\\sqrt{5}}\\right) \\right)^2$$\n$$\\|w\\|_2^2 = \\frac{1}{2} \\left[ \\left(\\frac{3}{5} + \\frac{1}{\\sqrt{5}}\\right)^2 + \\left(\\frac{4}{5} - \\frac{2}{\\sqrt{5}}\\right)^2 \\right]$$\n展开括号内的项：\n$$ \\left( \\frac{9}{25} + \\frac{6}{5\\sqrt{5}} + \\frac{1}{5} \\right) + \\left( \\frac{16}{25} - \\frac{16}{5\\sqrt{5}} + \\frac{4}{5} \\right) $$\n分别合并有理项和无理项：\n$$ \\left( \\frac{9}{25} + \\frac{16}{25} + \\frac{1}{5} + \\frac{4}{5} \\right) + \\left( \\frac{6}{5\\sqrt{5}} - \\frac{16}{5\\sqrt{5}} \\right) = \\left( \\frac{25}{25} + \\frac{5}{5} \\right) + \\left( \\frac{-10}{5\\sqrt{5}} \\right) $$\n$$ = (1+1) - \\frac{2}{\\sqrt{5}} = 2 - \\frac{2}{\\sqrt{5}} $$\n将此代回 $\\|w\\|_2^2$ 的表达式中：\n$$\\|w\\|_2^2 = \\frac{1}{2}\\left(2 - \\frac{2}{\\sqrt{5}}\\right) = 1 - \\frac{1}{\\sqrt{5}}$$\n为简化，我们将分母有理化：\n$$\\|w\\|_2^2 = 1 - \\frac{\\sqrt{5}}{5}$$\n所求的范数是该值的平方根：\n$$\\|A_{S^c}^\\top u\\|_{2,\\infty} = \\sqrt{1 - \\frac{\\sqrt{5}}{5}}$$\n这个值小于 $1$，这证实了精确恢复的条件。", "answer": "$$\n\\boxed{\\sqrt{1 - \\frac{\\sqrt{5}}{5}}}\n$$", "id": "3455751"}]}