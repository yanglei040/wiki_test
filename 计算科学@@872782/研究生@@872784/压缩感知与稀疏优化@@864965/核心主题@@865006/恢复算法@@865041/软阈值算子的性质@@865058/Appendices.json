{"hands_on_practices": [{"introduction": "软阈值算子是统计信号处理（尤其是在去噪任务中）的基石。为了评估其作为估计器的性能，关键的第一步是分析其偏差。本练习 [@problem_id:3470285] 将引导您在标准高斯序列模型中推导该偏差的表达式，从而揭示算子如何系统地将估计值向零收缩。", "problem": "考虑高斯序列模型，其分量观测值由 $y_{i}=\\theta_{i}+\\epsilon_{i}$ 给出，其中 $\\epsilon_{i}$ 是独立同分布 (i.i.d.) 的，满足 $\\epsilon_{i}\\sim \\mathcal{N}(0,\\sigma^{2})$，且 $\\sigma > 0$ 是已知的。设水平为 $\\lambda > 0$ 的软阈值算子按分量定义为 $S_{\\lambda}(t)=\\operatorname{sign}(t)\\max\\{|t|-\\lambda,0\\}$。仅使用概率论的核心定义和高斯分布的性质，推导分量偏差\n$$\nb_{i}(\\theta_{i},\\lambda,\\sigma)=\\mathbb{E}\\big[S_{\\lambda}(y_{i})-\\theta_{i}\\big]\n$$\n作为 $(\\theta_{i},\\lambda,\\sigma)$ 函数的一个显式、闭式解析表达式。将最终结果用标准正态概率密度函数 $\\phi(\\cdot)$ 和标准正态累积分布函数 $\\Phi(\\cdot)$ 表示。最终答案必须是关于 $b_{i}(\\theta_{i},\\lambda,\\sigma)$ 的单个闭式解析表达式。", "solution": "用户希望在高斯序列模型中推导软阈值估计量的分量偏差。\n\n### 第1步：提取已知条件\n-   模型：高斯序列模型，其分量观测值为 $y_{i}=\\theta_{i}+\\epsilon_{i}$。\n-   噪声分布：$\\epsilon_{i}$ 是独立同分布 (i.i.d.) 的，且 $\\epsilon_{i}\\sim \\mathcal{N}(0,\\sigma^{2})$。\n-   已知参数：$\\sigma > 0$。\n-   估计量：水平为 $\\lambda > 0$ 的软阈值算子，按分量定义为 $S_{\\lambda}(t)=\\operatorname{sign}(t)\\max\\{|t|-\\lambda,0\\}$。\n-   待计算量：分量偏差 $b_{i}(\\theta_{i},\\lambda,\\sigma)=\\mathbb{E}\\big[S_{\\lambda}(y_{i})-\\theta_{i}\\big]$。\n-   结果要求形式：一个以标准正态概率密度函数 $\\phi(\\cdot)$ 和标准正态累积分布函数 $\\Phi(\\cdot)$ 表示的闭式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的、客观的。这是高维统计和信号处理领域中一个标准的、基础的计算。所有必要信息都已提供，各量定义明确，问题在数学上是合理的，并有唯一解。未发现任何瑕疵。\n\n### 第3步：结论与行动\n该问题有效。我将继续提供完整的解法。\n\n### 推导过程\n目标是计算分量偏差，其定义为：\n$$\nb_{i}(\\theta_{i},\\lambda,\\sigma)=\\mathbb{E}\\big[S_{\\lambda}(y_{i})-\\theta_{i}\\big]\n$$\n为简化符号，我们可以在推导过程中省略分量索引 $i$，因为每个分量的计算都是相同的。我们有 $y=\\theta+\\epsilon$，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma^2)$，这意味着观测值 $y$ 服从正态分布 $y \\sim \\mathcal{N}(\\theta, \\sigma^2)$。\n\n偏差可以写为：\n$$\nb(\\theta,\\lambda,\\sigma) = \\mathbb{E}[S_{\\lambda}(y) - \\theta]\n$$\n利用期望的线性性质以及 $\\mathbb{E}[y] = \\mathbb{E}[\\theta + \\epsilon] = \\theta + \\mathbb{E}[\\epsilon] = \\theta$ 这一事实，我们可以将偏差重写为：\n$$\nb(\\theta, \\lambda, \\sigma) = \\mathbb{E}[S_{\\lambda}(y) - y + y - \\theta] = \\mathbb{E}[S_{\\lambda}(y) - y] + \\mathbb{E}[y - \\theta]\n$$\n由于 $\\mathbb{E}[y - \\theta] = \\mathbb{E}[\\epsilon] = 0$，偏差简化为估计量与观测值之差的期望：\n$$\nb(\\theta, \\lambda, \\sigma) = \\mathbb{E}[S_{\\lambda}(y) - y]\n$$\n让我们定义函数 $h(t) = S_{\\lambda}(t) - t$。软阈值算子 $S_{\\lambda}(t)$ 的定义是分段的：\n$$\nS_{\\lambda}(t) = \\begin{cases} t - \\lambda  \\text{if } t > \\lambda \\\\ 0  \\text{if } -\\lambda \\le t \\le \\lambda \\\\ t + \\lambda  \\text{if } t  -\\lambda \\end{cases}\n$$\n由此，我们可以分段定义 $h(t)$：\n$$\nh(t) = S_{\\lambda}(t) - t = \\begin{cases} (t - \\lambda) - t = -\\lambda  \\text{if } t > \\lambda \\\\ 0 - t = -t  \\text{if } -\\lambda \\le t \\le \\lambda \\\\ (t + \\lambda) - t = \\lambda  \\text{if } t  -\\lambda \\end{cases}\n$$\n偏差是 $h(y)$ 的期望，通过将 $h(t)$ 对 $y$ 的概率密度函数 (PDF) $f_y(t)$ 进行积分来计算：\n$$\nb(\\theta, \\lambda, \\sigma) = \\mathbb{E}[h(y)] = \\int_{-\\infty}^{\\infty} h(t) f_y(t) \\, dt\n$$\n其中 $f_y(t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(t-\\theta)^2}{2\\sigma^2}\\right)$。\n我们根据 $h(t)$ 的分段定义来拆分积分：\n$$\nb(\\theta, \\lambda, \\sigma) = \\int_{-\\infty}^{-\\lambda} \\lambda f_y(t) \\, dt + \\int_{-\\lambda}^{\\lambda} (-t) f_y(t) \\, dt + \\int_{\\lambda}^{\\infty} (-\\lambda) f_y(t) \\, dt\n$$\n$$\nb(\\theta, \\lambda, \\sigma) = \\lambda \\int_{-\\infty}^{-\\lambda} f_y(t) \\, dt - \\int_{-\\lambda}^{\\lambda} t f_y(t) \\, dt - \\lambda \\int_{\\lambda}^{\\infty} f_y(t) \\, dt\n$$\n为计算这些积分，我们进行变量替换，换为一个标准正态变量 $u = \\frac{t-\\theta}{\\sigma}$。这意味着 $t = \\sigma u + \\theta$ 且 $dt = \\sigma du$。$y$ 的 PDF 可以用标准正态 PDF $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{u^2}{2})$ 表示为 $f_y(t) = \\frac{1}{\\sigma}\\phi\\left(\\frac{t-\\theta}{\\sigma}\\right)$。因此，$f_y(t)dt = \\phi(u)du$。$u$ 的积分限变换如下：\n-   $t = \\lambda \\implies u = \\frac{\\lambda-\\theta}{\\sigma}$\n-   $t = -\\lambda \\implies u = \\frac{-\\lambda-\\theta}{\\sigma}$\n\n偏差的表达式变为：\n$$\nb(\\theta, \\lambda, \\sigma) = \\lambda \\int_{-\\infty}^{\\frac{-\\lambda-\\theta}{\\sigma}} \\phi(u) \\, du - \\int_{\\frac{-\\lambda-\\theta}{\\sigma}}^{\\frac{\\lambda-\\theta}{\\sigma}} (\\sigma u + \\theta) \\phi(u) \\, du - \\lambda \\int_{\\frac{\\lambda-\\theta}{\\sigma}}^{\\infty} \\phi(u) \\, du\n$$\n第一个和第三个积分用标准正态累积分布函数 (CDF) $\\Phi(x) = \\int_{-\\infty}^x \\phi(u)du$ 表示。\n-   $\\lambda \\int_{-\\infty}^{\\frac{-\\lambda-\\theta}{\\sigma}} \\phi(u) \\, du = \\lambda \\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right)$\n-   $-\\lambda \\int_{\\frac{\\lambda-\\theta}{\\sigma}}^{\\infty} \\phi(u) \\, du = -\\lambda \\left(1 - \\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right)\\right)$\n\n中间的积分被分成两部分：\n$$\n\\int_{\\frac{-\\lambda-\\theta}{\\sigma}}^{\\frac{\\lambda-\\theta}{\\sigma}} (\\sigma u + \\theta) \\phi(u) \\, du = \\sigma \\int_{\\frac{-\\lambda-\\theta}{\\sigma}}^{\\frac{\\lambda-\\theta}{\\sigma}} u \\phi(u) \\, du + \\theta \\int_{\\frac{-\\lambda-\\theta}{\\sigma}}^{\\frac{\\lambda-\\theta}{\\sigma}} \\phi(u) \\, du\n$$\n我们使用标准积分结果：$\\int u\\phi(u)du = -\\phi(u)$ 和 $\\int \\phi(u)du = \\Phi(u)$。\n-   $\\sigma \\int_{a}^{b} u\\phi(u)du = \\sigma[-\\phi(u)]_{a}^{b} = \\sigma(\\phi(a) - \\phi(b))$。当 $a=\\frac{-\\lambda-\\theta}{\\sigma}$ 且 $b=\\frac{\\lambda-\\theta}{\\sigma}$ 时，这部分是 $\\sigma\\left(\\phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right)\\right)$。\n-   $\\theta \\int_{a}^{b} \\phi(u)du = \\theta[\\Phi(u)]_{a}^{b} = \\theta(\\Phi(b) - \\Phi(a))$。这部分是 $\\theta\\left(\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right)\\right)$。\n\n合并偏差的所有项：\n$b = \\lambda \\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\left[ \\sigma\\left(\\phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right)\\right) + \\theta\\left(\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right)\\right) \\right] - \\lambda \\left(1 - \\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right)\\right)$\n\n展开并合并同类项：\n$b = \\lambda \\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\theta\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) + \\theta\\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\lambda + \\lambda\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right)$\n按 $\\Phi(\\cdot)$ 和 $\\phi(\\cdot)$ 对各项进行分组：\n$b = (\\lambda - \\theta)\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) + (\\lambda + \\theta)\\Phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{-\\lambda-\\theta}{\\sigma}\\right) - \\lambda$\n\n这是一个有效的闭式表达式。通过使用性质 $\\Phi(-x) = 1 - \\Phi(x)$ 和 $\\phi(-x) = \\phi(x)$，可以得到一个等价且稍微简化的形式。\n$b = (\\lambda - \\theta)\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) + (\\lambda + \\theta)\\left(1 - \\Phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right)\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right) - \\lambda$\n展开带括号的项：\n$b = (\\lambda - \\theta)\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) + \\lambda + \\theta - (\\lambda + \\theta)\\Phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right) - \\lambda$\n项 $+\\lambda$ 和 $-\\lambda$ 相消，得到：\n$b(\\theta, \\lambda, \\sigma) = \\theta + (\\lambda - \\theta)\\Phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - (\\lambda + \\theta)\\Phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{\\lambda+\\theta}{\\sigma}\\right)$\n\n恢复分量索引 $i$ 即可得到分量偏差的最终表达式。", "answer": "$$\n\\boxed{\\theta_{i} + (\\lambda - \\theta_{i})\\Phi\\left(\\frac{\\lambda-\\theta_{i}}{\\sigma}\\right) - (\\lambda + \\theta_{i})\\Phi\\left(\\frac{\\lambda+\\theta_{i}}{\\sigma}\\right) + \\sigma\\phi\\left(\\frac{\\lambda-\\theta_{i}}{\\sigma}\\right) - \\sigma\\phi\\left(\\frac{\\lambda+\\theta_{i}}{\\sigma}\\right)}\n$$", "id": "3470285"}, {"introduction": "除了在去噪中的作用，软阈值算子最著名的特性是它能够通过将小系数精确地设置为零来产生稀疏解。本练习 [@problem_id:3470304] 深入探讨了这一核心机制，要求您在阈值参数 $ \\lambda $ 与输出中非零项的数量之间建立一个精确的关系。掌握这种联系对于有效使用 LASSO 和 ISTA 等算法至关重要。", "problem": "设 $x \\in \\mathbb{R}^{n}$ 是一个固定向量，其坐标的绝对值两两不同，即，对于所有 $i \\neq j$，都有 $|x_{i}| \\neq |x_{j}|$。考虑软阈值算子 (soft-thresholding operator) $S_{\\lambda} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$，它被定义为 $\\ell_{1}$ 范数（绝对值之和）在参数 $\\lambda \\ge 0$ 处的近端映射 (proximal map)，即\n$$\n\\big(S_{\\lambda}(x)\\big)_{i} \\;=\\; \\operatorname{sign}(x_{i}) \\,\\max\\!\\big(|x_{i}| - \\lambda,\\, 0\\big), \\quad i = 1,\\dots,n.\n$$\n设 $k \\in \\{0,1,\\dots,n\\}$ 是一个目标支撑集大小。通过对集合 $\\{|x_{1}|,\\dots,|x_{n}|\\}$ 进行严格降序排序，定义有序的绝对值 $r_{(1)} > r_{(2)} > \\cdots > r_{(n)}$。从上面 $S_{\\lambda}$ 的基本定义出发，并利用顺序统计学和集合基数的第一性原理，推导出一个闭式表达式，用于表示最小的阈值参数 $\\lambda^{\\star}$，使得软阈值化后的向量 $S_{\\lambda^{\\star}}(x)$ 恰好有 $k$ 个非零项。此外，在给定的关于 $x$ 的绝对值分量互不相同的假设下，严格证明此 $\\lambda^{\\star}$ 的唯一性。\n\n你的最终答案必须是 $\\lambda^{\\star}$ 的一个用 $r_{(j)}$ 和 $k$ 表示的单一闭式解析表达式。不需要数值近似或四舍五入。", "solution": "问题要求推导最小阈值参数 $\\lambda^{\\star}$ 的闭式表达式，使得软阈值化后的向量 $S_{\\lambda^{\\star}}(x)$ 恰好有 $k$ 个非零项。给定一个向量 $x \\in \\mathbb{R}^{n}$，其分量的绝对值两两不同，即对所有 $i \\neq j$ 都有 $|x_{i}| \\neq |x_{j}|$。\n\n首先，我们来分析软阈值算子的结构，它对每个分量 $i \\in \\{1, \\dots, n\\}$ 定义如下：\n$$\n\\big(S_{\\lambda}(x)\\big)_{i} \\;=\\; \\operatorname{sign}(x_{i}) \\,\\max\\!\\big(|x_{i}| - \\lambda,\\, 0\\big)\n$$\n向量 $S_{\\lambda}(x)$ 中非零项的数量是其支撑集的大小，通常用 $\\ell_0$ 伪范数 $\\|S_{\\lambda}(x)\\|_0$ 表示。一个分量 $(S_{\\lambda}(x))_{i}$ 是非零的，当且仅当 $\\max(|x_{i}| - \\lambda, 0) > 0$。这个不等式成立，当且仅当 $|x_{i}| - \\lambda > 0$，可简化为 $|x_{i}| > \\lambda$。\n\n因此，$S_{\\lambda}(x)$ 中非零项的数量是满足绝对值 $|x_i|$ 严格大于阈值 $\\lambda$ 的索引 $i$ 的数量。我们可以将这个数量定义为 $\\lambda$ 的函数：\n$$\nN(\\lambda) = \\|S_{\\lambda}(x)\\|_0 = \\left| \\left\\{ i \\in \\{1, \\dots, n\\} \\;\\middle|\\; |x_i| > \\lambda \\right\\} \\right|\n$$\n我们的目标是找到最小的 $\\lambda^{\\star} \\ge 0$，使得 $N(\\lambda^{\\star}) = k$，其中 $k \\in \\{0, 1, \\dots, n\\}$ 是目标支撑集大小。这可以表述为找到 $\\lambda^{\\star} = \\inf \\{ \\lambda \\ge 0 \\mid N(\\lambda) = k \\}$。\n\n问题陈述了绝对值 $|x_i|$ 是两两不同的。让我们将这些绝对值的集合表示为 $\\mathcal{M} = \\{|x_1|, |x_2|, \\dots, |x_n|\\}$。我们可以按照规定，将这 $n$ 个不同的正值按严格降序排序：$r_{(1)} > r_{(2)} > \\cdots > r_{(n)} > 0$。严格不等式是给定条件 $|x_{i}| \\neq |x_{j}|$ (对于 $i \\neq j$) 的直接结果。为了方便表示，我们用两个约定值来扩充这个序列：$r_{(0)} := \\infty$ 和 $r_{(n+1)} := 0$。\n\n函数 $N(\\lambda)$ 是一个非增的右连续阶梯函数。在不包含任何绝对值 $r_{(j)}$ 的区间上，它的值是恒定的。让我们用这些有序的绝对值来刻画 $N(\\lambda)$。对于给定的 $\\lambda \\ge 0$，$N(\\lambda)$ 计算 $\\mathcal{M}$ 中有多少个值严格大于 $\\lambda$。\n\n考虑形如 $[r_{(j+1)}, r_{(j)})$ 的区间，其中 $j \\in \\{0, 1, \\dots, n\\}$。对于此区间内的任何 $\\lambda$，我们有 $r_{(j+1)} \\le \\lambda  r_{(j)}$。在 $\\mathcal{M}$ 中严格大于 $\\lambda$ 的绝对值恰好是 $\\{r_{(1)}, r_{(2)}, \\dots, r_{(j)}\\}$。这些绝对值的数量恰好是 $j$。因此，对于任何 $\\lambda \\in [r_{(j+1)}, r_{(j)})$，非零项的数量为 $N(\\lambda) = j$。\n\n我们正在寻找满足 $N(\\lambda^{\\star}) = k$ 的最小 $\\lambda^{\\star}$。根据我们的分析，对于区间 $[r_{(k+1)}, r_{(k)})$ 中的所有 $\\lambda$，条件 $N(\\lambda) = k$ 都成立。让我们来验证这一点。\n\\begin{itemize}\n    \\item 对于任何满足 $r_{(k+1)} \\le \\lambda  r_{(k)}$ 的 $\\lambda$，满足 $|x_i| > \\lambda$ 的绝对值 $|x_i|$ 是 $\\{r_{(1)}, \\dots, r_{(k)}\\}$。这些绝对值恰好有 $k$ 个，因此 $N(\\lambda) = k$。\n    \\item 在左端点 $\\lambda = r_{(k+1)}$ 处，条件变为 $|x_i| > r_{(k+1)}$，这被 $k$ 个绝对值 $\\{r_{(1)}, \\dots, r_{(k)}\\}$ 所满足。所以，$N(r_{(k+1)}) = k$。\n    \\item 在右端点 $\\lambda = r_{(k)}$ 处，条件变为 $|x_i| > r_{(k)}$，这被 $k-1$ 个绝对值 $\\{r_{(1)}, \\dots, r_{(k-1)}\\}$ 所满足。所以，$N(r_{(k)}) = k-1$。\n\\end{itemize}\n因此，所有能产生恰好 $k$ 个非零项的 $\\lambda$ 值的集合是 $\\Lambda_k = \\{\\lambda \\ge 0 \\mid N(\\lambda) = k\\} = [r_{(k+1)}, r_{(k)})$。使用我们对 $r_{(0)}$ 和 $r_{(n+1)}$ 的定义，这对 $k \\in \\{0, 1, \\dots, n\\}$ 都成立。例如，当 $k=n$ 时，$\\Lambda_n = [r_{(n+1)}, r_{(n)}) = [0, r_{(n)})$。当 $k=0$ 时，$\\Lambda_0 = [r_{(1)}, r_{(0)}) = [r_{(1)}, \\infty)$。\n\n问题要求的是最小的此类阈值参数 $\\lambda^{\\star}$。这是集合 $\\Lambda_k$ 的下确界 (infimum)。\n$$\n\\lambda^{\\star} = \\inf(\\Lambda_k) = \\inf\\big( [r_{(k+1)}, r_{(k)}) \\big) = r_{(k+1)}\n$$\n\n最后，我们必须证明此 $\\lambda^{\\star}$ 的唯一性。量 $\\lambda^{\\star}$ 被定义为达到目标稀疏度 $k$ 的*最小*阈值。根据定义，实数集的任何非空子集的下确界是唯一的。因此，证明的核心在于解释为什么对于任何 $k \\in \\{0, 1, \\dots, n\\}$ 的选择，集合 $\\Lambda_k$ 都保证是非空的。\n\n这个保证是由一个关键假设提供的，即绝对值 $|x_i|$ 是两两不同的。这意味着有序的绝对值是严格递减的：$r_{(1)} > r_{(2)} > \\cdots > r_{(n)}$。随着 $\\lambda$ 的增加，它一次只穿过一个绝对值阈值。支撑集大小函数 $N(\\lambda)$ 是一个阶梯函数，其值在每个不连续点 $\\lambda = r_{(j)}$ 处恰好减少 1。具体来说，对于任何 $j \\in \\{1,\\dots,n\\}$，当 $\\lambda \\in [r_{(j+1)}, r_{(j)})$ 时，$N(\\lambda) = j$；而 $N(r_{(j)}) = j-1$。这意味着当 $\\lambda$ 从 $0$ 扫到 $\\infty$ 时，$N(\\lambda)$ 会取遍从 $n$ 到 $0$ 的每一个整数值。\n\n因此，对于任何目标支撑集大小 $k \\in \\{0, 1, \\dots, n\\}$，总存在一个 $\\lambda$ 值的范围，使得 $N(\\lambda) = k$。这个集合就是非空区间 $\\Lambda_k = [r_{(k+1)}, r_{(k)})$。由于 $\\Lambda_k$ 是非空的且有下界，它有唯一的下确界。这个唯一的最小值就是 $\\lambda^{\\star} = r_{(k+1)}$。\n\n如果没有做出分量绝对值互不相同的假设（例如，对于某个 $j$，$r_{(j)} = r_{(j+1)}$），函数 $N(\\lambda)$ 在 $\\lambda=r_{(j)}$ 处会有一个大小为 2 或更大的跳跃，可能会跳过某些整数值。这将意味着对于某些目标大小 $k$，集合 $\\Lambda_k$ 将为空，解 $\\lambda^{\\star}$ 也就不存在了。因此，分量绝对值互不相同的假设对于确保问题对所有 $k$ 都是适定 (well-posed) 的至关重要。\n\n因此，唯一的最小阈值参数的闭式表达式是 $\\lambda^{\\star} = r_{(k+1)}$。", "answer": "$$\\boxed{r_{(k+1)}}$$", "id": "3470304"}, {"introduction": "既然我们已经确定了阈值 $ \\lambda $ 如何控制稀疏性，我们现在来研究算子输出对该参数变化的敏感度。这种分析对于理解 $ \\lambda $ 的微调以及动态调整阈值的先进连续方法（continuation methods）的行为至关重要。在本练习 [@problem_id:3470287] 中，您将推导软阈值算子的敏感度，并应用它来界定在一个小扰动下解的变化范围。", "problem": "考虑在压缩感知 (CS) 和稀疏优化中作为 $\\ell_{1}$ 范数的近端映射而产生的软阈值算子 $S_{\\lambda}$，它由标量最小化问题定义：$S_{\\lambda}(x) = \\underset{u \\in \\mathbb{R}}{\\arg\\min}\\;\\frac{1}{2}(u - x)^{2} + \\lambda |u|$，其中阈值参数为 $\\lambda \\ge 0$，标量输入为 $x \\in \\mathbb{R}$。从这个变分定义出发，推导 $S_{\\lambda}(x)$ 关于阈值参数 $\\lambda$ 的敏感度的几乎处处成立的表达式，即，计算 $\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x)$，其中 $x \\in \\mathbb{R}$，不包括可能不可微的点。然后，考虑向量情况，其中 $S_{\\lambda}$ 逐分量作用于 $z \\in \\mathbb{R}^{n}$。给定 $z \\in \\mathbb{R}^{7}$ 为 $z = (1.3, -0.4, 0.9, -2.1, 0.75, 1.6, -0.85)^{\\top}$，并取 $\\lambda_{0} = 0.8$。在一个延拓步骤中，阈值被扰动为 $\\lambda_{1} = \\lambda_{0} + \\delta$，其中有一个小增量 $\\delta = 0.05$。使用您推导出的敏感度，给出一个以 $\\ell_{2}$ 范数衡量的重构漂移 $\\|S_{\\lambda_{1}}(z) - S_{\\lambda_{0}}(z)\\|_{2}$ 的最坏情况下的上界。将该上界表示为一个实数，并四舍五入到四位有效数字。", "solution": "该问题包括两部分。首先，我们必须推导软阈值算子 $S_{\\lambda}(x)$ 关于阈值参数 $\\lambda$ 的敏感度。其次，我们必须利用此结果，对给定的向量和 $\\lambda$ 的一个微小扰动，计算算子输出变化的最坏情况下的上界。\n\n第一部分：推导敏感度 $\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x)$。\n\n软阈值算子 $S_{\\lambda}(x)$ 定义为以下最小化问题的解：\n$$S_{\\lambda}(x) = \\underset{u \\in \\mathbb{R}}{\\arg\\min} \\; f(u) = \\underset{u \\in \\mathbb{R}}{\\arg\\min} \\left( \\frac{1}{2}(u - x)^{2} + \\lambda |u| \\right)$$\n其中 $x \\in \\mathbb{R}$ 是输入，$\\lambda \\ge 0$ 是阈值参数。目标函数 $f(u)$ 是凸函数，因此其最小值可以通过将其关于 $u$ 的次梯度设为零来找到。$f(u)$ 的次梯度由下式给出：\n$$\\partial f(u) = u - x + \\lambda \\partial|u|$$\n绝对值函数 $\\partial|u|$ 的次梯度定义为：\n$$\\partial|u| = \\begin{cases} \\{1\\}  \\text{if } u > 0 \\\\ \\{-1\\}  \\text{if } u  0 \\\\ [-1, 1]  \\text{if } u = 0 \\end{cases}$$\n我们寻求使 $0 \\in \\partial f(u)$ 成立的 $u$ 值。我们分析关于 $u$ 的三种情况：\n\n情况1：$u > 0$。次梯度方程变为 $u - x + \\lambda(1) = 0$，解得 $u = x - \\lambda$。为了使此解自洽，必须有 $u > 0$，这意味着 $x - \\lambda > 0$，即 $x > \\lambda$。\n\n情况2：$u  0$。次梯度方程变为 $u - x + \\lambda(-1) = 0$，解得 $u = x + \\lambda$。为保持一致性，必须有 $u  0$，这意味着 $x + \\lambda  0$，即 $x  -\\lambda$。\n\n情况3：$u = 0$。次梯度条件变为 $0 \\in 0 - x + \\lambda[-1, 1]$，简化为 $0 \\in -x + [-\\lambda, \\lambda]$。这意味着 $x$ 必须在区间 $[-\\lambda, \\lambda]$ 内，即 $|x| \\leq \\lambda$。\n\n结合这三种情况，我们得到软阈值算子的闭式表达式：\n$$S_{\\lambda}(x) = \\begin{cases} x - \\lambda  \\text{if } x > \\lambda \\\\ 0  \\text{if } |x| \\leq \\lambda \\\\ x + \\lambda  \\text{if } x  -\\lambda \\end{cases}$$\n这也可以紧凑地写成 $S_{\\lambda}(x) = \\operatorname{sign}(x) \\max(|x| - \\lambda, 0)$。\n\n现在，我们计算 $S_{\\lambda}(x)$ 关于 $\\lambda$ 的敏感度，即偏导数 $\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x)$。我们在 $S_{\\lambda}(x)$ 关于 $\\lambda$ 可微的区域内对其表达式进行微分。不可微点出现在 $|x| = \\lambda$处。我们考虑一个固定的 $x$ 并对 $\\lambda$ 进行微分。\n\n情况 A：$|x| > \\lambda$。\n如果 $x > 0$ 且 $\\lambda  x$，则 $S_{\\lambda}(x) = x - \\lambda$。对 $\\lambda$ 微分得到：\n$$\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x) = \\frac{\\partial}{\\partial \\lambda} (x - \\lambda) = -1$$\n如果 $x  0$ 且 $\\lambda  -x = |x|$，则 $S_{\\lambda}(x) = x + \\lambda$。对 $\\lambda$ 微分得到：\n$$\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x) = \\frac{\\partial}{\\partial \\lambda} (x + \\lambda) = 1$$\n\n情况 B：$|x|  \\lambda$。\n在这种情况下，$S_{\\lambda}(x) = 0$。对 $\\lambda$ 微分得到：\n$$\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x) = \\frac{\\partial}{\\partial \\lambda} (0) = 0$$\n\n总结导数的结果，我们有：\n$$\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x) = \\begin{cases} -1  \\text{if } x > \\lambda \\\\ 0  \\text{if } |x|  \\lambda \\\\ 1  \\text{if } x  -\\lambda \\end{cases}$$\n这个结果对所有满足 $|x| \\neq \\lambda$ 的 $x, \\lambda$ 成立。通过将此敏感度与算子本身的输出联系起来，可以找到一个非常紧凑的表达式。注意到当 $x > \\lambda$ 时 $S_{\\lambda}(x) > 0$，当 $x  -\\lambda$ 时 $S_{\\lambda}(x)  0$，以及当 $|x| \\leq \\lambda$ 时 $S_{\\lambda}(x) = 0$，我们可以写出（使用约定 $\\operatorname{sign}(0)=0$）：\n$$\\frac{\\partial}{\\partial \\lambda} S_{\\lambda}(x) = -\\operatorname{sign}(S_{\\lambda}(x))$$\n这就是所求的几乎处处成立的敏感度表达式。\n\n第二部分：重构漂移的上界。\n\n我们给定一个向量 $z \\in \\mathbb{R}^{7}$，一个初始阈值 $\\lambda_{0} = 0.8$，以及一个新阈值 $\\lambda_{1} = \\lambda_{0} + \\delta = 0.8 + 0.05 = 0.85$。算子 $S_{\\lambda}$ 逐分量作用于 $z$。我们想要找到 $\\|S_{\\lambda_{1}}(z) - S_{\\lambda_{0}}(z)\\|_{2}$ 的最坏情况下的上界。\n\n令 $\\Delta S = S_{\\lambda_{1}}(z) - S_{\\lambda_{0}}(z)$。第 $i$ 个分量是 $\\Delta S_i = S_{\\lambda_{1}}(z_i) - S_{\\lambda_{0}}(z_i)$。根据微积分基本定理，我们可以将这个差值写成敏感度的积分：\n$$\\Delta S_i = \\int_{\\lambda_{0}}^{\\lambda_{1}} \\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda} d\\lambda$$\n为了找到这个变化幅度的上界，我们使用积分的三角不等式：\n$$|\\Delta S_i| = \\left| \\int_{\\lambda_{0}}^{\\lambda_{1}} \\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda} d\\lambda \\right| \\leq \\int_{\\lambda_{0}}^{\\lambda_{1}} \\left| \\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda} \\right| d\\lambda$$\n敏感度的幅度是 $|\\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda}| \\in \\{0, 1\\}$。我们可以通过区间长度乘以被积函数幅度的上确界来界定积分：\n$$|\\Delta S_i| \\leq (\\lambda_{1} - \\lambda_{0}) \\sup_{\\lambda \\in (\\lambda_0, \\lambda_1)} \\left| \\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda} \\right| = \\delta \\cdot M_i$$\n其中 $M_i = \\sup_{\\lambda \\in (\\lambda_0, \\lambda_1)} |\\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda}|$。\n\n“最坏情况”下的上界是通过对每个分量使用此上界得到的。漂移的 $\\ell_2$ 范数则被界定为：\n$$\\|S_{\\lambda_{1}}(z) - S_{\\lambda_{0}}(z)\\|_{2} = \\sqrt{\\sum_{i=1}^{7} (\\Delta S_i)^2} \\leq \\sqrt{\\sum_{i=1}^{7} (\\delta M_i)^2} = \\delta \\sqrt{\\sum_{i=1}^{7} M_i^2}$$\n我们需要为给定向量 $z = (1.3, -0.4, 0.9, -2.1, 0.75, 1.6, -0.85)^{\\top}$ 的每个分量确定 $M_i$。区间是 $(\\lambda_0, \\lambda_1) = (0.8, 0.85)$。\n敏感度 $\\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda}$ 非零当且仅当 $|z_i| > \\lambda$。\n- 如果 $|z_i| \\le \\lambda_0 = 0.8$，那么对于所有 $\\lambda \\in (\\lambda_0, \\lambda_1)$，我们有 $|z_i|  \\lambda$。因此，在整个区间内 $\\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda} = 0$，并且 $M_i = 0$。\n- 如果 $|z_i| > \\lambda_0 = 0.8$，那么在区间 $(\\lambda_0, \\lambda_1)$ 的至少一部分（具体来说，对于 $\\lambda \\in (\\lambda_0, \\min(|z_i|, \\lambda_1))$），我们有 $|z_i| > \\lambda$。在这个区域， $|\\frac{\\partial S_{\\lambda}(z_i)}{\\partial \\lambda}| = 1$。因此，在该区间上幅度的上确界是 $M_i = 1$。\n\n让我们计算每个分量的 $|z_i|$ 并与 $\\lambda_0 = 0.8$ 比较：\n- $i=1$: $|z_1| = 1.3 > 0.8 \\implies M_1=1$。\n- $i=2$: $|z_2| = 0.4 \\le 0.8 \\implies M_2=0$。\n- $i=3$: $|z_3| = 0.9 > 0.8 \\implies M_3=1$。\n- $i=4$: $|z_4| = 2.1 > 0.8 \\implies M_4=1$。\n- $i=5$: $|z_5| = 0.75 \\le 0.8 \\implies M_5=0$。\n- $i=6$: $|z_6| = 1.6 > 0.8 \\implies M_6=1$。\n- $i=7$: $|z_7| = 0.85 > 0.8 \\implies M_7=1$。\n\n$M_i=1$ 的分量数量为 5。因此，$\\sum_{i=1}^{7} M_i^2 = 1^2 + 0^2 + 1^2 + 1^2 + 0^2 + 1^2 + 1^2 = 5$。\n漂移的 $\\ell_2$ 范数的上界是：\n$$\\|S_{\\lambda_{1}}(z) - S_{\\lambda_{0}}(z)\\|_{2} \\leq \\delta \\sqrt{5} = 0.05 \\sqrt{5}$$\n现在，我们计算数值并四舍五入到四位有效数字：\n$$0.05 \\times \\sqrt{5} \\approx 0.05 \\times 2.236067977 \\dots = 0.11180339885 \\dots$$\n四舍五入到四位有效数字得到 $0.1118$。", "answer": "$$\\boxed{0.1118}$$", "id": "3470287"}]}