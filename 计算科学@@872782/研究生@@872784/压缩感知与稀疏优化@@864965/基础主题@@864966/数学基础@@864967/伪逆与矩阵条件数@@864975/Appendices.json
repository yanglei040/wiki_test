{"hands_on_practices": [{"introduction": "在解决科学和工程中的逆问题时，我们常常面临一个核心挑战：测量数据中存在的噪声会如何影响我们解的准确性？本练习将引导你通过第一性原理，推导出在最小二乘估计中最坏情况下的噪声放大因子。你将发现，这个放大因子与测量矩阵的最小奇异值直接相关，从而将伪逆的算子范数这一抽象概念与可量化的估计误差联系起来，为你理解矩阵条件数在稀疏恢复中的关键作用奠定坚实基础。", "problem": "考虑压缩感知中的一个线性测量模型，$y = A x + e$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是一个感知矩阵，满足 $m \\geq n$，$x \\in \\mathbb{R}^{n}$ 是一个 $k$-稀疏向量，其支撑集为 $S \\subset \\{1,\\dots,n\\}$，大小为 $|S| = k$，$e \\in \\mathbb{R}^{m}$ 是一个加性噪声向量。假设一个预言机提供了正确的支撑集 $S$，并且 $S$ 上的系数通过约束在支撑集上的最小二乘（LS）方法进行估计，即 $\\hat{x}_{S} = \\arg\\min_{z \\in \\mathbb{R}^{n}:\\,\\mathrm{supp}(z)\\subseteq S} \\|y - A z\\|_{2}^{2}$，且 $\\hat{x}_{S^{c}} = 0$。记 $A_{S} \\in \\mathbb{R}^{m \\times k}$ 为由 $S$ 索引的 $A$ 的列组成的子矩阵，并假设 $A_{S}$ 具有满列秩。$A_{S}$ 的 Moore–Penrose 伪逆记为 $A_{S}^{\\dagger}$。\n\n仅从 Moore–Penrose 伪逆、由欧几里得范数诱导的算子范数以及奇异值分解（SVD）的定义出发，执行以下操作：\n\n1. 推导支撑集约束的 LS 估计的精确最坏情况噪声放大因子，即值\n$$\n\\sup_{e \\neq 0} \\frac{\\|\\hat{x} - x\\|_{2}}{\\|e\\|_{2}},\n$$\n纯粹用 $A_{S}$ 的奇异值表示。\n\n2. 找出一个能达到此上确界的噪声方向 $e$（作为 $A_{S}$ 的函数），并解释为什么这个方向在最大化支撑集上的估计误差的意义上是对抗性的。\n\n3. 现在考虑以下具体实例：设 $m = 6$，$k = 3$，并假设 $A_{S}$ 的非零奇异值按非增顺序列出为 $\\sigma_{1} = 5$，$\\sigma_{2} = 3$ 和 $\\sigma_{3} = \\tfrac{1}{5}$。如果噪声的欧几里得范数为 $\\|e\\|_{2} = \\tfrac{1}{50}$，并且噪声如第2项中所述以对抗性方式选择，计算估计误差范数 $\\|\\hat{x} - x\\|_{2}$ 的最大可能值。\n\n将最终答案以单个实数的形式给出。无需四舍五入，不涉及单位。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 线性测量模型为 $y = A x + e$。\n- $A \\in \\mathbb{R}^{m \\times n}$ 是一个感知矩阵，满足 $m \\geq n$。\n- $x \\in \\mathbb{R}^{n}$ 是一个 $k$-稀疏向量，其支撑集为 $S \\subset \\{1,\\dots,n\\}$，基数为 $|S| = k$。\n- $e \\in \\mathbb{R}^{m}$ 是一个加性噪声向量。\n- 支撑集 $S$ 已知（由预言机提供）。\n- 估计值 $\\hat{x}$ 是通过支撑集约束的最小二乘（LS）方法获得的：$\\hat{x}_{S} = \\arg\\min_{z \\in \\mathbb{R}^{n}:\\,\\mathrm{supp}(z)\\subseteq S} \\|y - A z\\|_{2}^{2}$，且 $\\hat{x}$ 在支撑集 $S$ 之外的分量为零，即 $\\hat{x}_{S^{c}} = 0$。\n- $A_{S} \\in \\mathbb{R}^{m \\times k}$ 是由 $S$ 索引的 $A$ 的列组成的子矩阵。\n- $A_{S}$ 具有满列秩。\n- $A_{S}^{\\dagger}$ 表示 $A_{S}$ 的 Moore–Penrose 伪逆。\n- 任务 1：用 $A_{S}$ 的奇异值表示最坏情况下的噪声放大因子 $\\sup_{e \\neq 0} \\frac{\\|\\hat{x} - x\\|_{2}}{\\|e\\|_{2}}$。\n- 任务 2：确定一个能达到此上确界的对抗性噪声方向 $e$。\n- 任务 3：对于 $m=6$, $k=3$ 的具体情况，$A_{S}$ 的非零奇异值为 $\\sigma_{1} = 5$, $\\sigma_{2} = 3$, $\\sigma_{3} = \\frac{1}{5}$，且在对抗性噪声方向下 $\\|e\\|_{2} = \\frac{1}{50}$，计算 $\\|\\hat{x} - x\\|_{2}$ 的最大值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在线性代数、数值分析和压缩感知领域具有科学依据。所有术语，如“Moore–Penrose伪逆”、“奇异值分解”、“最小二乘”和“k稀疏”都是定义明确且标准的。问题设定是自洽且内部一致的。$A_S$ 具有满列秩的条件至关重要，它确保了 LS 问题的适定性。该问题是客观的、陈述精确的，不包含任何事实错误、谬误或歧义。它需要一个严谨的数学推导，然后进行具体的计算，这是一个有效且非平凡的任务。\n\n### 步骤 3：结论与行动\n问题被视为有效。将提供完整解答。\n\n### 解答推导\n\n分析始于支撑集约束的最小二乘估计的公式化。设 $x_S \\in \\mathbb{R}^k$ 是 $x$ 在支撑集 $S$ 上的非零系数向量。测量模型可以写成 $y = A_S x_S + e$。$x_S$ 的 LS 估计器记为 $\\hat{x}_S$，是 $\\min_{z_S \\in \\mathbb{R}^k} \\|y - A_S z_S\\|_2^2$ 的解。\n\n这个 LS 问题的正规方程由 $(A_S^T A_S) \\hat{x}_S = A_S^T y$ 给出。由于 $A_S$ 是一个具有满列秩（给定 $m \\geq k$）的 $m \\times k$ 矩阵，因此 $k \\times k$ 矩阵 $A_S^T A_S$ 是可逆的。因此，唯一解为 $\\hat{x}_S = (A_S^T A_S)^{-1} A_S^T y$。这个表达式正是具有满列秩矩阵的 Moore-Penrose 伪逆的定义，所以我们有 $\\hat{x}_S = A_S^\\dagger y$。\n\n估计误差向量为 $\\hat{x} - x$。由于 $\\hat{x}$ 和 $x$ 的支撑集都包含在 $S$ 中，它们的差的支撑集也在 $S$ 上。误差向量的非零部分是 $\\hat{x}_S - x_S$。我们可以用噪声向量 $e$ 来表示这个误差：\n$$\n\\hat{x}_S - x_S = A_S^\\dagger y - x_S = A_S^\\dagger(A_S x_S + e) - x_S = (A_S^\\dagger A_S) x_S + A_S^\\dagger e - x_S\n$$\n对于一个具有满列秩的矩阵 $A_S$，$A_S^\\dagger A_S = I_k$，其中 $I_k$ 是 $k \\times k$ 的单位矩阵。因此，方程简化为：\n$$\n\\hat{x}_S - x_S = I_k x_S + A_S^\\dagger e - x_S = A_S^\\dagger e\n$$\n总估计误差的欧几里得范数为 $\\|\\hat{x} - x\\|_2 = \\|\\hat{x}_S - x_S\\|_2 = \\|A_S^\\dagger e\\|_2$。\n\n**1. 最坏情况下的噪声放大因子**\n\n我们需要求解 $\\sup_{e \\neq 0} \\frac{\\|\\hat{x} - x\\|_{2}}{\\|e\\|_{2}}$。代入误差范数的表达式，我们得到：\n$$\n\\sup_{e \\neq 0} \\frac{\\|A_S^\\dagger e\\|_{2}}{\\|e\\|_{2}}\n$$\n这就是矩阵 $A_S^\\dagger$ 的算子范数（或谱范数）的定义，记为 $\\|A_S^\\dagger\\|_2$。为了用 $A_S$ 的奇异值表示它，我们使用奇异值分解（SVD）。设 $A_S$ 的 SVD 为 $A_S = U \\Sigma V^T$，其中 $U \\in \\mathbb{R}^{m \\times k}$ 是一个具有标准正交列的矩阵（$U^T U = I_k$），$V \\in \\mathbb{R}^{k \\times k}$ 是一个正交矩阵（$V^T V = V V^T = I_k$），$\\Sigma \\in \\mathbb{R}^{k \\times k}$ 是一个包含奇异值 $\\sigma_1 \\geq \\sigma_2 \\geq \\dots \\geq \\sigma_k > 0$ 的对角矩阵。由于 $A_S$ 具有满列秩，奇异值均为正。\n\n伪逆 $A_S^\\dagger$ 的 SVD 形式为 $A_S^\\dagger = V \\Sigma^{-1} U^T$。$A_S^\\dagger$ 的奇异值是 $\\Sigma^{-1}$ 的对角线元素，即 $\\frac{1}{\\sigma_1}, \\frac{1}{\\sigma_2}, \\dots, \\frac{1}{\\sigma_k}$。\n由于一个矩阵的算子范数是其最大的奇异值，我们有：\n$$\n\\|A_S^\\dagger\\|_2 = \\max\\left(\\frac{1}{\\sigma_1}, \\frac{1}{\\sigma_2}, \\dots, \\frac{1}{\\sigma_k}\\right)\n$$\n给定排序 $\\sigma_1 \\geq \\dots \\geq \\sigma_k > 0$，其倒数的最大值是 $\\frac{1}{\\sigma_k}$。因此，最坏情况下的噪声放大因子是：\n$$\n\\sup_{e \\neq 0} \\frac{\\|\\hat{x} - x\\|_{2}}{\\|e\\|_{2}} = \\|A_S^\\dagger\\|_2 = \\frac{1}{\\sigma_k} = \\frac{1}{\\sigma_{\\min}(A_S)}\n$$\n其中 $\\sigma_{\\min}(A_S)$ 是 $A_S$ 的最小奇异值。\n\n**2. 对抗性噪声方向**\n\n当向量 $e$ 与 $A_S^\\dagger$ 对应其最大奇异值的右奇异向量同向时，比率 $\\frac{\\|A_S^\\dagger e\\|_2}{\\|e\\|_2}$ 达到上确界。从 $A_S^\\dagger = V \\Sigma^{-1} U^T$ 的 SVD 可知，右奇异向量是 $U$ 的列，奇异值为 $\\{1/\\sigma_i\\}_{i=1}^k$。最大的奇异值是 $1/\\sigma_k$，对应于 $U$ 的第 $k$ 列，记为 $u_k$。\n\n因此，对抗性噪声方向是任何与 $u_k$ 成比例的向量 $e$，即对于任何非零标量 $c \\in \\mathbb{R}$，有 $e = c \\cdot u_k$。向量 $u_k$ 是原始矩阵 $A_S$ 对应其最小奇异值 $\\sigma_k$ 的左奇异向量。这个方向是对抗性的，因为它位于算子 $A_S$ 具有最小增益（$\\sigma_k$）的子空间中，这意味着它的逆（伪逆 $A_S^\\dagger$）具有最大增益（$1/\\sigma_k$）。当估计信号系数时，这个方向上的噪声被放大得最多。\n\n**3. 具体实例计算**\n\n给定 $m=6$, $k=3$，以及 $A_S$ 的奇异值为 $\\sigma_1 = 5$, $\\sigma_2 = 3$ 和 $\\sigma_3 = \\frac{1}{5}$。最小的奇异值是 $\\sigma_k = \\sigma_3 = \\frac{1}{5}$。噪声范数为 $\\|e\\|_2 = \\frac{1}{50}$，并且是对抗性选择的。\n\n当噪声是对抗性的时候，会出现最大可能的估计误差范数 $\\|\\hat{x} - x\\|_2$。在这种情况下，误差范数由下式给出：\n$$\n\\|\\hat{x} - x\\|_2 = \\|A_S^\\dagger e\\|_2 = \\|A_S^\\dagger\\|_2 \\|e\\|_2\n$$\n从第 1 部分可知，$\\|A_S^\\dagger\\|_2 = \\frac{1}{\\sigma_k} = \\frac{1}{\\sigma_3}$。\n代入给定值：\n$$\n\\|A_S^\\dagger\\|_2 = \\frac{1}{\\frac{1}{5}} = 5\n$$\n现在，我们可以计算最大估计误差范数：\n$$\n\\|\\hat{x} - x\\|_2 = (5) \\cdot \\left(\\frac{1}{50}\\right) = \\frac{5}{50} = \\frac{1}{10}\n$$", "answer": "$$\\boxed{\\frac{1}{10}}$$", "id": "3471152"}, {"introduction": "既然我们已经理解了矩阵的病态性（ill-conditioning）会导致噪声放大 ([@problem_id:3471152])，一个自然的问题是：所有求解算法都同样容易受到影响吗？本练习旨在探讨解决最小二乘问题的两种常见方法的数值稳定性。你将通过量化分析，揭示为何看似直接的正规方程法在处理病态问题时可能是灾难性的，而基于QR分解或SVD等正交分解的方法则表现出更强的鲁棒性。", "problem": "考虑一个用于压缩感知中稀疏恢复的感知矩阵 $A\\in\\mathbb{R}^{m\\times n}$。对于一个给定的支撑集 $S\\subset\\{1,\\dots,n\\}$（其中 $|S|=k$）以及满列秩子矩阵 $A_S\\in\\mathbb{R}^{m\\times k}$，需要求解超定最小二乘问题 $\\min_{x\\in\\mathbb{R}^k}\\|A_S x - b\\|_2$。两种标准方法是：(i) 构造正规方程 $A_S^{\\top}A_S x = A_S^{\\top} b$ 并通过 Cholesky 分解求解，以及 (ii) 通过正交分解（如 QR 分解或奇异值分解 (SVD)）求解。\n\n假设以下基础：\n- 满列秩矩阵 $A_S$ 的 2-范数条件数为 $\\kappa_2(A_S) = \\sigma_{\\max}(A_S)/\\sigma_{\\min}(A_S)$，其中 $\\sigma_{\\max}(\\cdot)$ 和 $\\sigma_{\\min}(\\cdot)$ 分别表示最大和最小的非零奇异值。\n- 正交变换保持 2-范数不变，并且基于 QR 和 SVD 的最小二乘求解器是后向稳定的，即计算出的解 $\\hat{x}$ 是某个扰动问题 $(A_S+\\Delta A) \\hat{x}$ 的精确最小化解，其中 $\\|\\Delta A\\|_2/\\|A_S\\|_2 = \\mathcal{O}(\\epsilon)$，$\\epsilon$ 是机器精度。\n- 有限等距性质 (RIP) 指出，对于任意 k-稀疏向量 $x\\in\\mathbb{R}^n$，有 $(1-\\delta_k)\\|x\\|_2^2 \\le \\|A x\\|_2^2 \\le (1+\\delta_k)\\|x\\|_2^2$，其中 $\\delta_k\\in[0,1)$ 是有限等距常数。特别地，对于任何满足 $|S|\\le k$ 的 $S$，子矩阵 $A_S$ 的奇异值位于区间 $[\\sqrt{1-\\delta_k}, \\sqrt{1+\\delta_k}]$ 内。\n\n仅使用这些基础，推断从 $A_S$ 传递到正规方程 $A_S^{\\top}A_S$ 时有效条件数如何变化，并比较 QR/SVD 方法与正规方程方法的前向误差放大。然后，论证在何种条件下，显式构造 Moore–Penrose 伪逆 $A^{\\dagger}$ 在数值上是不安全的。\n\n选择所有正确的陈述：\n\nA. 对于任何支撑集 $S$（其中 $|S|\\le k$），有 $\\kappa_2(A_S^{\\top}A_S) = \\kappa_2(A_S)^2$。此外，一个后向稳定的 QR 或 SVD 最小二乘求解器产生的前向相对误差的缩放级别为 $\\mathcal{O}(\\epsilon\\,\\kappa_2(A_S))$，而通过正规方程求解产生的前向误差缩放级别为 $\\mathcal{O}(\\epsilon\\,\\kappa_2(A_S)^2)$。\n\nB. 通过正规方程求解最小二乘问题对于 $A_S$ 是后向稳定的，并且这种方式完全消除了对 $\\kappa_2(A_S)$ 的依赖，因此前向误差为 $\\mathcal{O}(\\epsilon)$，与条件数无关。\n\nC. 只要 $\\kappa_2(A_S) \\le 1/\\sqrt{\\epsilon}$，显式构造伪逆 $A^{\\dagger}$ 并计算 $x = A_S^{\\dagger} b$ 在数值上是安全的，因为 SVD 是后向稳定的。\n\nD. 在双精度（$\\epsilon \\approx 2.2\\times 10^{-16}$）下，如果 $\\kappa_2(A_S) = 10^8$，那么使用正规方程会得到 $\\kappa_2(A_S^{\\top}A_S) \\approx 10^{16}$，这超过了 $1/\\epsilon$，并有灾难性精度损失的风险；相比之下，QR/SVD 方法将误差放大限制在约 $10^8$。\n\nE. 在具有常数 $\\delta_k$ 的有限等距性质下，对于任何满足 $|S|\\le k$ 的 $A_S$，使用后向稳定的 QR/SVD 最小二乘求解的最坏情况前向相对误差的缩放级别为 $\\mathcal{O}\\!\\left(\\epsilon\\,\\sqrt{\\frac{1+\\delta_k}{1-\\delta_k}}\\right)$。\n\nF. 通过 SVD 显式构造 $A^{\\dagger}$，然后用它计算 $x=A^{\\dagger}b$ 在数值上保持安全，即使当 $\\sigma_{\\min}(A)$ 处于 $\\epsilon\\,\\sigma_{\\max}(A)$ 的水平时也是如此，因为来自 SVD 的正交因子 $U$ 和 $V$ 是良态的。", "solution": "用户需要对一个关于压缩感知中最小二乘问题的数值方法的问题陈述进行批判性分析，然后评估所提供的选项。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n\n- 感知矩阵：$A\\in\\mathbb{R}^{m\\times n}$。\n- 支撑集：$S\\subset\\{1,\\dots,n\\}$，其基数为 $|S|=k$。\n- 子矩阵：$A_S\\in\\mathbb{R}^{m\\times k}$ 具有满列秩。\n- 最小二乘问题：$\\min_{x\\in\\mathbb{R}^k}\\|A_S x - b\\|_2$。\n- 方法 (i)：正规方程 $A_S^{\\top}A_S x = A_S^{\\top} b$，通过 Cholesky 分解求解。\n- 方法 (ii)：正交分解，特别是 QR 分解或奇异值分解 (SVD)。\n- 基础 1：$A_S$ 的 2-范数条件数为 $\\kappa_2(A_S) = \\sigma_{\\max}(A_S)/\\sigma_{\\min}(A_S)$，其中 $\\sigma_{\\max}(\\cdot)$ 和 $\\sigma_{\\min}(\\cdot)$ 是最大和最小的非零奇异值。\n- 基础 2：QR/SVD 求解器是后向稳定的。计算出的解 $\\hat{x}$ 精确地最小化 $\\|(A_S+\\Delta A) \\hat{x} - b\\|_2$，其中扰动 $\\Delta A$ 满足 $\\|\\Delta A\\|_2/\\|A_S\\|_2 = \\mathcal{O}(\\epsilon)$，$\\epsilon$ 是机器精度。\n- 基础 3：有限等距性质 (RIP) 意味着对于任何支撑集 $S$（其中 $|S|\\le k$），子矩阵 $A_S$ 的奇异值位于区间 $[\\sqrt{1-\\delta_k}, \\sqrt{1+\\delta_k}]$ 内，其中 $\\delta_k\\in[0,1)$ 是有限等距常数。\n\n**步骤 2：使用提取的给定信息进行验证**\n\n问题陈述在科学上是合理的、适定的和客观的。它基于数值线性代数的既定原则及其在压缩感知中的应用。条件数、正规方程、正交分解、后向稳定性、前向误差、伪逆和有限等距性质等概念都是标准的并且定义精确。所提供的基础是正确的，并且足以批判性地评估这些选项。该问题没有违反任何无效性标准。\n\n**步骤 3：结论和行动**\n\n问题陈述是有效的。我将继续进行解答和逐项分析。\n\n### 解答和选项分析\n\n问题要求我们推断求解最小二乘问题 $\\min_{x\\in\\mathbb{R}^k}\\|A_S x - b\\|_2$ 的不同方法的条件数和数值稳定性。\n\n**核心原则 1：正规方程的条件数**\n\n设满秩矩阵 $A_S \\in \\mathbb{R}^{m \\times k}$ (其中 $m \\ge k$) 的奇异值分解 (SVD) 为 $A_S = U\\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{k \\times k}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times k}$ 是一个矩形对角矩阵，其对角线上有奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_k > 0$。\n\n正规方程的矩阵是 $A_S^{\\top}A_S$。让我们分析其性质：\n$A_S^{\\top}A_S = (U\\Sigma V^{\\top})^{\\top}(U\\Sigma V^{\\top}) = V\\Sigma^{\\top}U^{\\top}U\\Sigma V^{\\top}$。\n由于 $U$ 具有标准正交列，因此 $U^{\\top}U$ 不一定是单位矩阵，但矩形矩阵 $A_S$ 的 SVD 更精确的表示为 $A_S = U_k \\Sigma_k V^{\\top}$，其中 $U_k$ 是 $m \\times k$ 且具有标准正交列，$\\Sigma_k$ 是 $k \\times k$ 对角矩阵。在这种情况下，$U_k^{\\top}U_k = I_k$。\n因此，$A_S^{\\top}A_S = V \\Sigma_k^{\\top} U_k^{\\top} U_k \\Sigma_k V^{\\top} = V (\\Sigma_k^{\\top}\\Sigma_k) V^{\\top} = V \\Sigma_k^2 V^{\\top}$。\n这是对称正定矩阵 $A_S^{\\top}A_S$ 的特征值分解。$A_S^{\\top}A_S$ 的特征值为 $\\lambda_i = \\sigma_i^2$，$i=1,\\dots,k$。\n$A_S^{\\top}A_S$ 的 2-范数条件数是其最大特征值与最小特征值之比：\n$\\kappa_2(A_S^{\\top}A_S) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\sigma_{\\max}(A_S)^2}{\\sigma_{\\min}(A_S)^2} = \\left(\\frac{\\sigma_{\\max}(A_S)}{\\sigma_{\\min}(A_S)}\\right)^2 = (\\kappa_2(A_S))^2$。\n这表明构造正规方程会将原始矩阵 $A_S$ 的条件数平方。\n\n**核心原则 2：前向误差界**\n\n对于线性系统 $Bx=c$，后向稳定求解器的前向相对误差 $\\|\\delta x\\|_2/\\|x\\|_2$ 受一个与 $\\epsilon\\,\\kappa_2(B)$ 成正比的项的界定。\n- 对于基于 QR/SVD 的方法，解对 $A_S$ 的扰动很敏感。最小二乘解 $x$ 的前向误差界大约为 $\\frac{\\|\\hat{x}-x\\|_2}{\\|x\\|_2} \\approx \\mathcal{O}(\\epsilon\\,\\kappa_2(A_S))$ (为简单起见，忽略与残差相关的项)。\n- 对于正规方程方法，求解的是系统 $(A_S^{\\top}A_S)x=A_S^{\\top}b$。有效条件数是矩阵 $A_S^{\\top}A_S$ 的条件数，即 $\\kappa_2(A_S)^2$。因此，前向误差的缩放级别为 $\\frac{\\|\\hat{x}-x\\|_2}{\\|x\\|_2} \\approx \\mathcal{O}(\\epsilon\\,\\kappa_2(A_S^{\\top}A_S)) = \\mathcal{O}(\\epsilon\\,\\kappa_2(A_S)^2)$。\n\n**核心原则 3：数值安全性和伪逆**\n\n当处理的量的条件数达到 $1/\\epsilon$ 的量级时，数值计算通常被认为是“不安全的”或会遭受灾难性的舍入误差。浮点运算具有有限的精度 $\\epsilon$，任何小于系统中最大数乘以 $\\epsilon$ 的数都可能被舍入为零，导致除以零或相对精度的巨大损失。\n显式构造伪逆 $A_S^{\\dagger} = V \\Sigma_k^{-1} U_k^{\\top}$ 涉及对奇异值求逆。如果 $\\kappa_2(A_S) = \\sigma_{\\max}/\\sigma_{\\min}$ 很大，那么 $\\sigma_{\\min}$ 就很小。如果 $\\sigma_{\\min} \\approx \\epsilon\\,\\sigma_{\\max}$，那么 $\\kappa_2(A_S) \\approx 1/\\epsilon$。在这种情况下计算 $1/\\sigma_{\\min}$ 在数值上是灾难性的。正规方程方法存在类似问题：当 $\\kappa_2(A_S)^2 \\approx 1/\\epsilon$ 时，它在数值上变得无用，这种情况发生在 $\\kappa_2(A_S) \\approx 1/\\sqrt{\\epsilon}$ 时。\n\n---\n**逐项分析**\n\n**A. 对于任何支撑集 $S$（其中 $|S|\\le k$），有 $\\kappa_2(A_S^{\\top}A_S) = \\kappa_2(A_S)^2$。此外，一个后向稳定的 QR 或 SVD 最小二乘求解器产生的前向相对误差的缩放级别为 $\\mathcal{O}(\\epsilon\\,\\kappa_2(A_S))$，而通过正规方程求解产生的前向误差缩放级别为 $\\mathcal{O}(\\epsilon\\,\\kappa_2(A_S)^2)$。**\n- 第一部分，$\\kappa_2(A_S^{\\top}A_S) = \\kappa_2(A_S)^2$，已在上面推导，是数值线性代中的一个标准恒等式。\n- 第二部分关于两类方法的前向误差缩放也是一个标准结果，如核心原则 2 中所解释。条件数的平方正是为什么在处理病态问题时通常避免使用正规方程方法的原因。\n- **结论：正确。**\n\n**B. 通过正规方程求解最小二乘问题对于 $A_S$ 是后向稳定的，并且这种方式完全消除了对 $\\kappa_2(A_S)$ 的依赖，因此前向误差为 $\\mathcal{O}(\\epsilon)$，与条件数无关。**\n- 这个陈述从根本上是错误的。正规方程方法因其在处理病态矩阵时数值稳定性差而臭名昭著，正是因为它将条件数平方，加剧了误差放大。对 $\\kappa_2(A_S)$ 的依赖性没有被消除；它从线性依赖加强到了二次依赖。\n- **结论：错误。**\n\n**C. 只要 $\\kappa_2(A_S) \\le 1/\\sqrt{\\epsilon}$，显式构造伪逆 $A^{\\dagger}$ 并计算 $x = A_S^{\\dagger} b$ 在数值上是安全的，因为 SVD 是后向稳定的。**\n- 这个选项稍微混淆了 $A^\\dagger$ 和 $A_S^\\dagger$，但我们分析的是求解子问题的过程，该过程使用 $A_S^\\dagger$。通过先构造 $A_S^\\dagger$ 再求解 $x=A_S^\\dagger b$ 的数值稳定性与正规方程相似。条件 $\\kappa_2(A_S) \\le 1/\\sqrt{\\epsilon}$ 意味着 $\\kappa_2(A_S)^2 \\le 1/\\epsilon$。这个不等式定义了矩阵 $A_S^\\top A_S$ 相对于机器精度 $\\epsilon$ 不是数值奇异的区域。这是正规方程方法可用性的边界，而不是一个“安全”的区域。一个 $\\kappa_2(A_S) \\approx 10^7$ 和 $\\epsilon \\approx 10^{-16}$ 的问题会满足这个条件，但会导致约 $10^{14}$ 的误差放大，这远非“安全”。此外，“因为 SVD 是后向稳定的”这个理由是不合逻辑的推论；SVD 算法的稳定性并不能防止当其结果被用来构造一个像近似奇异矩阵的逆这样内在病态的对象时出现的不稳定性。\n- **结论：错误。**\n\n**D. 在双精度（$\\epsilon \\approx 2.2\\times 10^{-16}$）下，如果 $\\kappa_2(A_S) = 10^8$，那么使用正规方程会得到 $\\kappa_2(A_S^{\\top}A_S) \\approx 10^{16}$，这超过了 $1/\\epsilon$，并有灾难性精度损失的风险；相比之下，QR/SVD 方法将误差放大限制在约 $10^8$。**\n- 让我们验证一下这些数字。对于双精度，$\\epsilon \\approx 2.22 \\times 10^{-16}$，所以 $1/\\epsilon \\approx 4.5 \\times 10^{15}$。\n- 如果 $\\kappa_2(A_S) = 10^8$，那么对于正规方程，条件数变为 $\\kappa_2(A_S^{\\top}A_S) = (\\kappa_2(A_S))^2 = (10^8)^2 = 10^{16}$。\n- 确实，$10^{16} > 4.5 \\times 10^{15}$，所以 $\\kappa_2(A_S^{\\top}A_S) > 1/\\epsilon$。一个条件数大于机器精度倒数的线性系统将遭受灾难性的精度损失；计算出的解基本上是噪声。\n- 相比之下，QR/SVD 方法在有效条件数为 $\\kappa_2(A_S) = 10^8$ 的情况下运行。由于 $10^8 \\ll 1/\\epsilon$，这些方法将损失大约 8 位十进制精度，但仍能产生一个有意义的解。该陈述准确地描述了这一标准场景。\n- **结论：正确。**\n\n**E. 在具有常数 $\\delta_k$ 的有限等距性质下，对于任何满足 $|S|\\le k$ 的 $A_S$，使用后向稳定的 QR/SVD 最小二乘求解的最坏情况前向相对误差的缩放级别为 $\\mathcal{O}\\!\\left(\\epsilon\\,\\sqrt{\\frac{1+\\delta_k}{1-\\delta_k}}\\right)$。**\n- 后向稳定的求解器的前向误差缩放级别为 $\\mathcal{O}(\\epsilon\\,\\kappa_2(A_S))$。\n- 基础 3 指出，对于任何这样的子矩阵 $A_S$，其奇异值 $\\sigma_j$ 位于 $[\\sqrt{1-\\delta_k}, \\sqrt{1+\\delta_k}]$ 内。\n- 因此，在所有这些子矩阵上的最坏情况条件数是最大可能奇异值与最小可能奇异值之比：$\\kappa_2(A_S) \\le \\frac{\\sup\\{\\sigma_j\\}}{\\inf\\{\\sigma_j\\}} = \\frac{\\sqrt{1+\\delta_k}}{\\sqrt{1-\\delta_k}} = \\sqrt{\\frac{1+\\delta_k}{1-\\delta_k}}$。\n- 因此，最坏情况下的前向误差与 $\\epsilon$ 和这个最坏情况条件数的乘积成比例。该陈述是给定基础的直接且正确的应用。\n- **结论：正确。**\n\n**F. 通过 SVD 显式构造 $A^{\\dagger}$，然后用它计算 $x=A^{\\dagger}b$ 在数值上保持安全，即使当 $\\sigma_{\\min}(A)$ 处于 $\\epsilon\\,\\sigma_{\\max}(A)$ 的水平时也是如此，因为来自 SVD 的正交因子 $U$ 和 $V$ 是良态的。**\n- 条件 $\\sigma_{\\min}(A) \\approx \\epsilon\\,\\sigma_{\\max}(A)$ 意味着 $\\kappa_2(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A) \\approx 1/\\epsilon$。这描述了一个严重病态以至于数值上奇异的矩阵。\n- 构造 $A^{\\dagger}$ 需要对这些奇异值求逆。对一个相对于最大值数量级为 $\\epsilon$ 的值求逆是不稳定数值操作的典型例子。该陈述声称这个过程是“安全的”，这与事实恰恰相反。\n- 所提供的理由，即正交因子 $U$ 和 $V$ 是良态的（这是正确的，因为 $\\kappa_2(U)=\\kappa_2(V)=1$），是无关的。病态性完全由矩阵 $\\Sigma$ 中的奇异值所反映，$U$ 和 $V$ 的良态性无法弥补对 $\\Sigma$ 求逆的不稳定性。\n- **结论：错误。**", "answer": "$$\\boxed{ADE}$$", "id": "3471100"}, {"introduction": "掌握了噪声放大和数值稳定性的知识后，我们可以设计更智能的算法来应对这些挑战。这个编程实践项目要求你为LSQR迭代求解器实现一种隐式正则化策略。你将创建一个早停准则，该准则精确地运用了我们之前探讨过的概念——伪逆的范数和噪声水平——在算法开始过度放大噪声之前及时停止迭代，从而在解的准确性和稳定性之间取得精妙的平衡。", "problem": "给定一个在压缩感知和稀疏优化背景下的线性反演问题。设 $A \\in \\mathbb{R}^{m \\times n}$，$x_{\\mathrm{true}} \\in \\mathbb{R}^{n}$，以及由 $y = A x_{\\mathrm{true}} + e$ 生成的带噪声数据 $y \\in \\mathbb{R}^{m}$，其中噪声向量 $e$ 的分量是独立同分布的零均值高斯随机变量，方差为 $\\sigma^{2}$。考虑使用一种迭代克雷洛夫子空间方法——最小二乘QR分解 (LSQR) 来求解最小二乘问题 $\\min_{x \\in \\mathbb{R}^{n}} \\|y - A x\\|_{2}$。\n\n核心挑战是为 LSQR 设计一个有原则的早停规则，该规则需要在由病态条件引起的噪声放大与近似误差之间取得平衡。此规则必须仅使用 LSQR 迭代过程中可获得的量：残差范数和对 $A$ 的 Moore-Penrose 伪逆 (MPP) 的谱范数（记为 $\\|A^{\\dagger}\\|_{2}$）的估计。伪逆的谱范数定义为 $\\|A^{\\dagger}\\|_{2} = 1/\\sigma_{\\min}(A)$，$A$ 的二范数条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{\\dagger}\\|_{2}$。LSQR 在每次迭代中提供 $\\|A\\|_{2}$ 和 $\\kappa_{2}(A)$ 的可靠估计，您可以从中通过 $\\|A^{\\dagger}\\|_{2} \\approx \\kappa_{2}(A) / \\|A\\|_{2}$ 来估计 $\\|A^{\\dagger}\\|_{2}$。\n\n设 $x_{k}$ 表示经过 $k$ 次迭代后的 LSQR 迭代解，$r_{k} = y - A x_{k}$ 为其残差。设 $\\delta = \\sqrt{m}\\,\\sigma$ 表示噪声范数 $\\|e\\|_{2}$ 的典型尺度。您必须实现以下停止规则：\n\n- 选择固定常数 $\\tau \\ge 1$ 和 $\\alpha \\in (0,1]$。对于此问题，使用 $\\tau = 1.1$ 和 $\\alpha = 1.0$。\n- 将第 $k$ 次迭代时的估计伪逆范数定义为 $\\widehat{\\|A^{\\dagger}\\|}_{2,k} = \\widehat{\\kappa_{2}(A)}_{k} / \\widehat{\\|A\\|}_{2,k}$，使用 LSQR 在第 $k$ 次迭代时的内部估计值。\n- 当满足以下两个条件的最小迭代次数 $k \\ge 2$ 出现时停止：\n  $$\n  \\|r_{k}\\|_{2} \\le \\tau\\,\\delta\n  \\quad\\text{and}\\quad\n  \\|x_{k} - x_{k-1}\\|_{2} \\le \\alpha\\,\\widehat{\\|A^{\\dagger}\\|}_{2,k}\\,\\delta.\n  $$\n如果在达到最大迭代预算 $k_{\\max}$ 之前没有找到这样的 $k$，则返回 $k = k_{\\max}$ 及相应的量。\n\n您的程序必须实现带有上述停止规则的 LSQR，并为以下测试套件生成结果。为保证可复现性，请按规定使用固定的伪随机生成器种子。所有矩阵和向量都是纯无量纲的；此问题中不涉及物理单位。\n\n测试套件（四个案例），每个案例由 $(m,n,\\text{profile},\\sigma,s,\\text{seed})$ 指定：\n- 案例1：$(40,60,\\text{mild\\_ill},10^{-2},5,0)$。\n- 案例2：$(60,60,\\text{well},5 \\cdot 10^{-3},10,1)$。\n- 案例3：$(40,60,\\text{severe\\_ill},10^{-2},5,2)$。\n- 案例4：$(50,200,\\text{severe\\_ill},5 \\cdot 10^{-3},10,3)$。\n\n矩阵构造：\n- 对于 $\\text{well}$：设 $A$ 具有独立同分布的分量 $A_{ij} \\sim \\mathcal{N}(0,1/m)$，无列缩放。\n- 对于 $\\text{mild_ill}$：设 $A$ 如上所述，但将最后 $\\lfloor n/2 \\rfloor$ 列乘以 $10^{-2}$ 进行缩放。\n- 对于 $\\text{severe_ill}$：设 $A$ 如上所述，但将第 $j$ 列乘以 $10^{-\\gamma}$ 进行缩放，其中 $\\gamma = 8 \\cdot \\frac{j-1}{n-1}$，这会产生大致分布在 $[1,10^{-8}]$ 区间内的奇异值。\n\n信号构造：\n- 设 $x_{\\mathrm{true}} \\in \\mathbb{R}^{n}$ 是一个 $s$-稀疏向量，其非零项的位置是均匀随机选择的，其值是从 $\\mathcal{N}(0,1)$ 中独立同分布采样的。\n\n噪声：\n- 设 $e \\in \\mathbb{R}^{m}$ 的分量是从 $\\mathcal{N}(0,\\sigma^{2})$ 中独立同分布采样的。\n\n对于每个案例，计算 $y = A x_{\\mathrm{true}} + e$，设置 $\\delta = \\sqrt{m}\\,\\sigma$，使用上述停止规则运行 LSQR，并将最大迭代次数限制为 $k_{\\max} = \\min\\{m,n\\}$。对于 LSQR，使用零绝对和相对容差，并且不设条件数限制停止，即 $\\text{atol} = 0$，$\\text{btol} = 0$ 和 $\\text{conlim} = +\\infty$，并在提取 $x_k$ 时严格执行在第 $k$ 次的迭代限制。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个案例，结果是一个列表 $[k^{\\star}, \\widehat{\\|A^{\\dagger}\\|}_{2,k^{\\star}}, \\|r_{k^{\\star}}\\|_{2}]$，其中 $k^{\\star}$ 是选定的停止迭代次数，$\\widehat{\\|A^{\\dagger}\\|}_{2,k^{\\star}}$ 是停止时的估计伪逆范数，$\\|r_{k^{\\star}}\\|_{2}$ 是停止时的残差范数。因此，最终输出必须采用\n$\n\\big[\n[k_{1}, \\widehat{\\|A^{\\dagger}\\|}_{2,1}, \\|r_{1}\\|_{2}],\n[k_{2}, \\widehat{\\|A^{\\dagger}\\|}_{2,2}, \\|r_{2}\\|_{2}],\n[k_{3}, \\widehat{\\|A^{\\dagger}\\|}_{2,3}, \\|r_{3}\\|_{2}],\n[k_{4}, \\widehat{\\|A^{\\dagger}\\|}_{2,4}, \\|r_{4}\\|_{2}]\n\\big]\n$ 的形式，并且必须打印为单行。", "solution": "该问题要求为最小二乘QR (LSQR) 算法实现一个特定的早停规则。LSQR是一种用于求解线性最小二乘问题 $\\min_{x \\in \\mathbb{R}^{n}} \\|y - A x\\|_{2}$ 的克雷洛夫子空间方法。该系统源于一个线性反演问题 $y = A x_{\\mathrm{true}} + e$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是给定矩阵，$x_{\\mathrm{true}} \\in \\mathbb{R}^{n}$ 是未知的稀疏信号，$e \\in \\mathbb{R}^{m}$ 是一个噪声向量，其分量独立同分布于 $\\mathcal{N}(0, \\sigma^2)$。\n\n在求解此类反演问题时，尤其当矩阵 $A$ 是病态的，根本的挑战在于防止解中噪声的放大。像 LSQR 这样的迭代方法通过早停提供了一种正则化形式：在迭代开始过度拟合噪声之前终止它。该问题指定了一个有原则的停止规则，旨在平衡近似误差（$A x_k$ 对 $y$ 的拟合程度）和解的稳定性（防止噪声放大）之间的权衡。\n\n停止规则定义如下：对于给定的常数 $\\tau \\ge 1$ 和 $\\alpha \\in (0,1]$，迭代在满足以下两个条件的最小整数 $k \\ge 2$ 处停止：\n1.  $\\|r_{k}\\|_{2} \\le \\tau\\,\\delta$\n2.  $\\|x_{k} - x_{k-1}\\|_{2} \\le \\alpha\\,\\widehat{\\|A^{\\dagger}\\|}_{2,k}\\,\\delta$\n\n这里，$x_k$ 是第 $k$ 次迭代的解估计值，$r_k = y - A x_k$ 是相应的残差。参数 $\\delta = \\sqrt{m}\\,\\sigma$ 代表噪声向量 $e$ 的期望欧几里得范数。第一个条件是差异原则的一种形式；它规定当残差的范数与噪声的范数量级相同时，迭代应停止。进一步减小残差很可能对应于拟合噪声 $e$，而不是 $A x_{\\mathrm{true}}$ 中的底层信号结构。对于此问题，$\\tau = 1.1$。\n\n第二个条件引入了一个解稳定性检查。项 $\\widehat{\\|A^{\\dagger}\\|}_{2,k}$ 是 $A$ 的 Moore-Penrose 伪逆谱范数的估计值，在第 $k$ 次迭代时根据 LSQR 的内部估计条件数 $\\widehat{\\kappa_{2}(A)}_{k}$ 和谱范数 $\\widehat{\\|A\\|}_{2,k}$ 计算得出，即 $\\widehat{\\|A^{\\dagger}\\|}_{2,k} = \\widehat{\\kappa_{2}(A)}_{k} / \\widehat{\\|A\\|}_{2,k}$。量 $\\widehat{\\|A^{\\dagger}\\|}_{2,k}\\,\\delta$ 可以解释为传播到解空间中的噪声幅度的估计。因此，当解向量的变化量 $\\|x_k - x_{k-1}\\|_2$ 小于此噪声放大估计值时，该条件会停止迭代，这表明后续的更新不太可能对真实信号产生显著改进。对于此问题，$\\alpha = 1.0$。\n\n如果在最大允许迭代次数 $k_{\\max} = \\min\\{m,n\\}$ 内这些条件未被满足，则过程终止并返回第 $k_{\\max}$ 次迭代的结果。\n\n实现过程首先按规定为每个案例生成测试数据。构造一个大小为 $m \\times n$ 的矩阵 $A$，其分量来自 $\\mathcal{N}(0, 1/m)$，并根据指定的病态条件配置（'well'、'mild_ill' 或 'severe_ill'）对其列进行缩放。生成一个 $s$-稀疏信号向量 $x_{\\mathrm{true}}$，其具有随机支撑集和正态分布的非零值。然后计算测量向量 $y = A x_{\\mathrm{true}} + e$，其中 $e$ 是高斯噪声的一个实现。\n\n为了应用自定义停止规则，我们必须访问 LSQR 每次迭代的量。一种直接的方法是在一个循环内运行标准的 `scipy.sparse.linalg.lsqr` 函数。对于从 $2$ 到 $k_{\\max}$ 的每次迭代 $k$，我们使用 `iter_lim=k` 执行 `lsqr` 以获得 $x_k$ 以及估计值 $\\widehat{\\|A\\|}_{2,k}$ 和 $\\widehat{\\kappa_{2}(A)}_{k}$。我们还需要 $x_{k-1}$，它从循环的上一步中保留下来。利用这些量，可以在每个 $k$ 处评估两个停止条件。第一个同时满足两个条件的 $k$ 被选为停止迭代次数 $k^\\star$。这个迭代过程虽然比单次调用 `lsqr` 计算量更大，但通过提供必要的迭代历史，正确地实现了指定的逻辑。\n\n`lsqr` 求解器的指定参数是绝对容差 `atol` 为 $0$，相对容差 `btol` 为 $0$，以及无限的条件数限制 `conlim` 为 $+\\infty$，确保求解器的终止完全由我们的外部循环和迭代限制 `iter_lim` 控制。对于每个测试案例，最终输出包括停止迭代次数 $k^{\\star}$、估计的伪逆范数 $\\widehat{\\|A^{\\dagger}\\|}_{2,k^{\\star}}$ 和残差范数 $\\|r_{k^{\\star}}\\|_2$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse.linalg import lsqr\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (m, n, profile, sigma, s, seed)\n        (40, 60, 'mild_ill', 1e-2, 5, 0),\n        (60, 60, 'well', 5e-3, 10, 1),\n        (40, 60, 'severe_ill', 1e-2, 5, 2),\n        (50, 200, 'severe_ill', 5e-3, 10, 3)\n    ]\n\n    results = []\n    for case in test_cases:\n        result = process_case(*case)\n        results.append(result)\n\n    # Format the final output string as specified, removing whitespace.\n    formatted_results = [str(res).replace(' ', '') for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef process_case(m, n, profile, sigma, s, seed):\n    \"\"\"\n    Generates data for a single test case and runs the LSQR with the custom stopping rule.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # 1. Generate matrix A\n    A = rng.normal(0, np.sqrt(1/m), size=(m, n))\n    if profile == 'mild_ill':\n        num_cols_to_scale = int(np.floor(n / 2))\n        scaling_factor = 1e-2\n        A[:, -num_cols_to_scale:] *= scaling_factor\n    elif profile == 'severe_ill':\n        for j in range(n):\n            gamma = 8.0 * j / (n - 1)\n            scaling_factor = 10**(-gamma)\n            A[:, j] *= scaling_factor\n\n    # 2. Generate true signal x_true\n    x_true = np.zeros(n)\n    support = rng.choice(n, s, replace=False)\n    x_true[support] = rng.normal(0, 1, size=s)\n\n    # 3. Generate noise e and measurement y\n    e = rng.normal(0, sigma, size=m)\n    y = A @ x_true + e\n\n    # 4. Implement LSQR with the specified stopping rule\n    tau = 1.1\n    alpha = 1.0\n    delta = np.sqrt(m) * sigma\n    k_max = min(m, n)\n\n    k_star = k_max\n    final_report = None\n\n    # Get x_{k-1} for the first iteration of the loop (k=2)\n    # This corresponds to x_1\n    res_prev = lsqr(A, y, damp=0.0, atol=0, btol=0, conlim=float('inf'), iter_lim=1)\n    x_prev = res_prev[0]\n\n    for k in range(2, k_max + 1):\n        res_k = lsqr(A, y, damp=0.0, atol=0, btol=0, conlim=float('inf'), iter_lim=k)\n        x_k = res_k[0]\n        r_norm_k = res_k[3]\n        anorm_k = res_k[5]\n        acond_k = res_k[6]\n        \n        if anorm_k > 0:\n            est_A_dagger_norm_k = acond_k / anorm_k\n        else:\n            est_A_dagger_norm_k = float('inf')\n\n        x_diff_norm_k = np.linalg.norm(x_k - x_prev)\n\n        cond1 = r_norm_k = tau * delta\n        cond2 = x_diff_norm_k = alpha * est_A_dagger_norm_k * delta\n        \n        if cond1 and cond2:\n            k_star = k\n            final_report = [k_star, est_A_dagger_norm_k, r_norm_k]\n            break\n\n        # Update x_prev for the next iteration step\n        x_prev = x_k\n\n    # If the loop completes without stopping, use results from k_max\n    if final_report is None:\n        # The last iteration of the loop was k = k_max. res_k holds its results.\n        res_kmax = lsqr(A, y, damp=0.0, atol=0, btol=0, conlim=float('inf'), iter_lim=k_max)\n        r_norm_kmax = res_kmax[3]\n        anorm_kmax = res_kmax[5]\n        acond_kmax = res_kmax[6]\n        if anorm_kmax > 0:\n            est_A_dagger_norm_kmax = acond_kmax / anorm_kmax\n        else:\n            est_A_dagger_norm_kmax = float('inf')\n        \n        final_report = [k_max, est_A_dagger_norm_kmax, r_norm_kmax]\n\n    return final_report\n\nsolve()\n```", "id": "3471119"}]}