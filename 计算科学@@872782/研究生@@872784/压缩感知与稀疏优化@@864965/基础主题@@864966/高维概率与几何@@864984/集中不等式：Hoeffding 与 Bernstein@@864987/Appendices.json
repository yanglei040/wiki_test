{"hands_on_practices": [{"introduction": "要真正掌握集中不等式，关键在于理解不同不等式的优劣以及它们各自的适用场景。这个练习旨在通过分析方法，直接比较霍夫丁不等式（Hoeffding's inequality）和伯恩斯坦不等式（Bernstein's inequality）在确定所需样本数量时的差异。通过推导两种方法下的最小样本量，你将清楚地看到伯恩斯坦不等式如何利用方差信息来提供一个可能更紧的界，这是在压缩感知和稀疏优化中进行高效实验设计的核心考量。", "problem": "考虑一个独立同分布 (IID) 随机变量序列 $X_1, X_2, \\dots, X_n$，其取值范围在区间 $[0,1]$ 内，每个变量的均值为 $\\mu \\in (0,1)$。令经验均值为 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。假定仅满足独立性、有界性 $X_i \\in [0,1]$、以及恒等式 $\\mathrm{Var}(X_i) = \\mathbb{E}[X_i^2] - \\mu^2$ 和对所有 $x \\in [0,1]$ 成立的不等式 $x^2 \\le x$。\n\n固定参数 $\\epsilon \\in (0,1)$ 和 $\\delta \\in (0,1)$，并以两种方式确定最小整数 $n$ 的闭式表达式，以确保尾部界 $\\mathbb{P}(|\\bar{X} - \\mu| > \\epsilon) \\le \\delta$ 成立：\n(i) 使用针对有界独立加数的 Hoeffding 不等式，以及\n(ii) 使用针对有界独立加数的 Bernstein 不等式，并结合方差界 $\\mathrm{Var}(X_i) \\le \\mu(1-\\mu)$。\n\n将您的最终答案表示为序对 $\\big(n_{\\mathrm{H}}(\\mu,\\epsilon,\\delta), n_{\\mathrm{B}}(\\mu,\\epsilon,\\delta)\\big)$，其中 $n_{\\mathrm{H}}(\\mu,\\epsilon,\\delta)$ 是基于 Hoeffding 不等式的最小样本量，$n_{\\mathrm{B}}(\\mu,\\epsilon,\\delta)$ 是基于 Bernstein 不等式的最小样本量，每个都以 $\\mu$、$\\epsilon$ 和 $\\delta$ 的闭式解析表达式给出。不需要进行数值计算或四舍五入，答案必须精确提供。", "solution": "该问题要求确定最小样本量 $n$，以保证 $n$ 个独立同分布 (IID) 随机变量 $X_i$ 的经验均值 $\\bar{X}$ 与真实均值 $\\mu$ 之间的距离在 $\\epsilon$ 以内，且概率至少为 $1-\\delta$。这些随机变量是有界的，$X_i \\in [0,1]$。我们被要求使用两种不同的集中不等式来推导这个最小样本量：Hoeffding 不等式和 Bernstein 不等式。\n\n(i) 使用 Hoeffding 不等式进行推导：\n\nHoeffding 不等式为有界独立随机变量的平均值偏离其期望值的概率提供了一个界。对于一组独立随机变量 $Y_1, \\dots, Y_n$，使得对每个 $i \\in \\{1, \\dots, n\\}$ 都有 $Y_i \\in [a_i, b_i]$，其经验均值 $\\bar{Y} = \\frac{1}{n} \\sum_{i=1}^{n} Y_i$ 的不等式由下式给出：\n$$ \\mathbb{P}(|\\bar{Y} - \\mathbb{E}[\\bar{Y}]| > t) \\le 2 \\exp\\left(-\\frac{2n^2 t^2}{\\sum_{i=1}^n (b_i - a_i)^2}\\right) $$\n在我们的问题中，随机变量是 $X_1, \\dots, X_n$，它们是独立同分布的，并且取值在区间 $[0,1]$ 内。因此，对于每个 $X_i$，我们有 $a_i = 0$ 和 $b_i = 1$。均值为 $\\mathbb{E}[\\bar{X}] = \\mu$，偏差为 $t = \\epsilon$。\n代入这些值，指数分母中的求和项变为 $\\sum_{i=1}^n (1-0)^2 = n$。对于这个特定情况，Hoeffding 不等式简化为：\n$$ \\mathbb{P}(|\\bar{X} - \\mu| > \\epsilon) \\le 2 \\exp\\left(-\\frac{2n^2 \\epsilon^2}{n}\\right) = 2 \\exp(-2n \\epsilon^2) $$\n我们希望这个概率不大于 $\\delta$。因此我们将上界设置为小于或等于 $\\delta$：\n$$ 2 \\exp(-2n \\epsilon^2) \\le \\delta $$\n为了求得所需的样本量 $n$，我们对 $n$ 求解这个不等式：\n$$ \\exp(-2n \\epsilon^2) \\le \\frac{\\delta}{2} $$\n对两边取自然对数：\n$$ -2n \\epsilon^2 \\le \\ln\\left(\\frac{\\delta}{2}\\right) $$\n两边乘以 $-1$ 会使不等号反向：\n$$ 2n \\epsilon^2 \\ge -\\ln\\left(\\frac{\\delta}{2}\\right) = \\ln\\left(\\left(\\frac{\\delta}{2}\\right)^{-1}\\right) = \\ln\\left(\\frac{2}{\\delta}\\right) $$\n最后，解出 $n$：\n$$ n \\ge \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) $$\n由于 $n$ 必须是一个整数，满足此条件的最小整数 $n$ 是右侧表达式的向上取整。因此，基于 Hoeffding 不等式的最小样本量是：\n$$ n_{\\mathrm{H}}(\\mu, \\epsilon, \\delta) = \\left\\lceil \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) \\right\\rceil $$\n$n_{\\mathrm{H}}$ 的这个表达式与均值 $\\mu$ 无关，因为 Hoeffding 不等式只利用了随机变量的范围。\n\n(ii) 使用 Bernstein 不等式进行推导：\n\nBernstein 不等式是另一种集中不等式，与 Hoeffding 不等式不同，它包含了随机变量方差的信息，通常能得到更紧的界。对于零均值独立随机变量之和 $Y_1, \\dots, Y_n$，其中对所有 $i$ 都有 $|Y_i| \\le K$，Bernstein 不等式的一种常见形式是：\n$$ \\mathbb{P}\\left(\\left|\\sum_{i=1}^n Y_i\\right| > t\\right) \\le 2 \\exp\\left(-\\frac{t^2}{2\\left(\\sum_{i=1}^n \\mathrm{Var}(Y_i) + \\frac{1}{3}Kt\\right)}\\right) $$\n为了将其应用于我们的问题，我们考虑零均值随机变量 $Y_i = X_i - \\mu$。经验均值的偏差为 $|\\bar{X} - \\mu| = \\left|\\frac{1}{n} \\sum_{i=1}^n Y_i\\right|$。我们关心的是事件 $\\left|\\frac{1}{n} \\sum Y_i\\right| > \\epsilon$，这等价于 $\\left|\\sum Y_i\\right| > n\\epsilon$。所以我们设 $t=n\\epsilon$。\n\n每个 $Y_i$ 的方差是 $\\mathrm{Var}(Y_i) = \\mathrm{Var}(X_i - \\mu) = \\mathrm{Var}(X_i)$。问题提供了方差界 $\\mathrm{Var}(X_i) \\le \\mu(1-\\mu)$。因此，方差之和有界，为 $\\sum_{i=1}^n \\mathrm{Var}(Y_i) \\le n\\mu(1-\\mu)$。\n\n变量 $Y_i = X_i - \\mu$ 是有界的。由于 $X_i \\in [0,1]$ 且 $\\mu \\in (0,1)$，我们有 $Y_i \\in [-\\mu, 1-\\mu]$。其绝对值有界，为 $|Y_i| \\le \\max(\\mu, 1-\\mu)$。由于 $\\mu \\in (0,1)$，总有 $\\max(\\mu, 1-\\mu) \\le 1$ 成立。因此我们可以使用上界 $K=1$。\n\n将这些部分（$t=n\\epsilon$，$\\sum \\mathrm{Var}(Y_i) \\le n\\mu(1-\\mu)$ 和 $K=1$）代入 Bernstein 不等式：\n$$ \\mathbb{P}(|\\bar{X} - \\mu| > \\epsilon) \\le 2 \\exp\\left(-\\frac{(n\\epsilon)^2}{2\\left(n\\mu(1-\\mu) + \\frac{1}{3}(1)(n\\epsilon)\\right)}\\right) $$\n简化指数部分：\n$$ -\\frac{n^2\\epsilon^2}{2n\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)} = -\\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)} $$\n所以不等式为：\n$$ \\mathbb{P}(|\\bar{X} - \\mu| > \\epsilon) \\le 2 \\exp\\left(-\\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}\\right) $$\n我们要求这个概率最多为 $\\delta$：\n$$ 2 \\exp\\left(-\\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}\\right) \\le \\delta $$\n求解 $n$ 的步骤与 Hoeffding 的情况相同：\n$$ \\exp\\left(-\\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}\\right) \\le \\frac{\\delta}{2} $$\n$$ -\\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)} \\le \\ln\\left(\\frac{\\delta}{2}\\right) $$\n$$ \\frac{n\\epsilon^2}{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)} \\ge \\ln\\left(\\frac{2}{\\delta}\\right) $$\n$$ n \\ge \\frac{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}{\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) $$\n满足此条件的最小整数 $n$ 是右侧表达式的向上取整。因此，基于 Bernstein 不等式的最小样本量是：\n$$ n_{\\mathrm{B}}(\\mu, \\epsilon, \\delta) = \\left\\lceil \\frac{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}{\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) \\right\\rceil $$\n这个表达式通过方差项 $\\mu(1-\\mu)$ 依赖于均值 $\\mu$，这反映了 Bernstein 不等式利用方差信息的特性。", "answer": "$$\\boxed{\\left( \\left\\lceil \\frac{1}{2\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) \\right\\rceil, \\left\\lceil \\frac{2\\left(\\mu(1-\\mu) + \\frac{\\epsilon}{3}\\right)}{\\epsilon^2} \\ln\\left(\\frac{2}{\\delta}\\right) \\right\\rceil \\right)}$$", "id": "3437646"}, {"introduction": "在理论上理解了霍夫丁和伯恩斯坦不等式的区别之后，下一个重要的步骤是通过数值计算来量化这种差异。这个练习要求你编写代码，来计算并比较在一个伯努利（Bernoulli）模型下，两种不等式的指数以及由此导出的样本复杂度。通过在不同参数（例如低方差与高方差）下进行测试，你将获得一个直观的感受：何时利用方差信息能显著降低样本需求，从而在实践中做出更明智的模型选择。", "problem": "考虑一个独立同分布的伯努利随机变量序列 $X_1, X_2, \\dots, X_n$，其参数为 $p \\in [0,1]$，即 $X_i \\in \\{0,1\\}$ 且 $\\mathbb{P}(X_i=1)=p$。样本均值为 $\\bar{X}_n := \\frac{1}{n}\\sum_{i=1}^n X_i$。在压缩感知 (CS) 和稀疏优化的背景下，概率保证通常取决于控制诸如 $\\bar{X}_n$ 等经验量与其期望 $\\mathbb{E}[\\bar{X}_n]=p$ 之间的偏差。\n\n已知两个经典的针对有界独立变量的集中不等式可以提供以下形式的尾部界\n$$\n\\mathbb{P}\\left(\\bar{X}_n - p \\ge \\epsilon\\right) \\le \\exp\\left(-n\\,g(\\epsilon, p)\\right),\n$$\n其中 $g(\\epsilon,p)$ 是一个取决于所用不等式的指数。在一种方法中，界仅取决于 $X_i \\in [0,1]$ 这一事实（Hoeffding类型）；而在另一种方法中，界则包含了方差信息 $\\mathrm{Var}(X_i)=p(1-p)$（Bernstein类型）。\n\n定义Hoeffding类型指数 $g_{\\mathrm{H}}(\\epsilon)$ 和Bernstein类型指数 $g_{\\mathrm{B}}(\\epsilon,p)$，使得基于各自标准的有界独立变量不等式，上述尾部界成立。使用这些指数，将最小样本量 $n_{\\mathrm{H}}(\\epsilon,\\delta)$ 和 $n_{\\mathrm{B}}(\\epsilon,\\delta,p)$ 定义为满足以下条件的最小整数 $n$\n$$\n\\exp\\left(-n\\,g_{\\mathrm{H}}(\\epsilon)\\right) \\le \\delta\n\\quad\\text{和}\\quad\n\\exp\\left(-n\\,g_{\\mathrm{B}}(\\epsilon,p)\\right) \\le \\delta,\n$$\n其中 $\\epsilon > 0$ 是给定的偏差水平，$\\delta \\in (0,1)$ 是给定的置信水平。\n\n您的程序必须：\n- 根据独立伯努利变量的标准有限样本Hoeffding和Bernstein不等式，从其基本定义出发，实现计算 $g_{\\mathrm{H}}(\\epsilon)$ 和 $g_{\\mathrm{B}}(\\epsilon,p)$ 的函数。\n- 对每个提供的测试用例，计算满足上述不等式的最小整数 $n_{\\mathrm{H}}(\\epsilon,\\delta)$ 和 $n_{\\mathrm{B}}(\\epsilon,\\delta,p)$。\n- 对于每个测试用例，输出包含以下六个值的列表：\n    1. $g_{\\mathrm{H}}(\\epsilon)$,\n    2. $g_{\\mathrm{B}}(\\epsilon,p)$,\n    3. $n_{\\mathrm{H}}(\\epsilon,\\delta)$,\n    4. $n_{\\mathrm{B}}(\\epsilon,\\delta,p)$,\n    5. 指数比 $g_{\\mathrm{B}}(\\epsilon,p) / g_{\\mathrm{H}}(\\epsilon)$，\n    6. 样本复杂度比 $n_{\\mathrm{B}}(\\epsilon,\\delta,p) / n_{\\mathrm{H}}(\\epsilon,\\delta)$。\n\n测试套件包含以下 $(p,\\epsilon,\\delta)$ 三元组：\n- 用例1（一般情况，高方差）：$(p,\\epsilon,\\delta) = (0.5, 0.05, 10^{-3})$。\n- 用例2（中等稀疏度）：$(p,\\epsilon,\\delta) = (0.1, 0.05, 10^{-3})$。\n- 用例3（高稀疏度）：$(p,\\epsilon,\\delta) = (0.01, 0.02, 10^{-6})$。\n- 用例4（互补中等稀疏度）：$(p,\\epsilon,\\delta) = (0.9, 0.05, 10^{-3})$。\n- 用例5（大偏差，高方差）：$(p,\\epsilon,\\delta) = (0.5, 0.2, 10^{-6})$。\n- 用例6（边界确定性）：$(p,\\epsilon,\\delta) = (0.0, 0.05, 10^{-3})$。\n\n科学真实性要求：\n- 所有参数必须满足 $p \\in [0,1]$，$\\epsilon > 0$ 和 $\\delta \\in (0,1)$。\n- 程序必须基于有界独立变量的标准且广为接受的Hoeffding和Bernstein不等式形式来计算指数和最小样本量，其中Bernstein界使用方差信息，Hoeffding界使用有界性信息。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表由各个测试用例的结果组成。每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表，所有结果共同用方括号括起来，不含空格。例如，输出的格式应如下所示：[[v11,v12,...,v16],[v21,v22,...,v26],...]]。\n\n不涉及物理单位或角度单位。所有数值输出必须以上述列表规定的浮点数或整数形式给出。避免使用任何百分号；如果需要比例，请以小数形式表示。", "solution": "用户的请求是概率论领域内一个适定问题，具体涉及集中不等式，并可直接应用于压缩感知和机器学习等领域。该问题具有科学依据，陈述规范，并允许存在唯一的、可验证的解。因此，该问题被视为有效。\n\n解决方案分为三个主要步骤：\n1.  推导Hoeffding类型指数 $g_{\\mathrm{H}}(\\epsilon)$ 和相应的最小样本量 $n_{\\mathrm{H}}(\\epsilon, \\delta)$。\n2.  推导Bernstein类型指数 $g_{\\mathrm{B}}(\\epsilon, p)$ 和相应的最小样本量 $n_{\\mathrm{B}}(\\epsilon, \\delta, p)$。\n3.  应用这些公式为每个测试用例计算所需的六个值。\n\n**1. Hoeffding不等式与Hoeffding类型指数**\n\nHoeffding不等式为一组有界独立随机变量之和与其期望值之间的偏差提供了一个界。设 $Y_1, \\dots, Y_n$ 为独立随机变量，使得 $Y_i \\in [a_i, b_i]$ 的概率为 $1$。样本均值为 $\\bar{Y}_n = \\frac{1}{n} \\sum_{i=1}^n Y_i$，其期望为 $\\mathbb{E}[\\bar{Y}_n] = \\frac{1}{n} \\sum_{i=1}^n \\mathbb{E}[Y_i]$。针对样本均值的Hoeffding不等式表述为：\n$$\n\\mathbb{P}\\left(\\bar{Y}_n - \\mathbb{E}[\\bar{Y}_n] \\ge \\epsilon\\right) \\le \\exp\\left(-\\frac{2n^2\\epsilon^2}{\\sum_{i=1}^n (b_i - a_i)^2}\\right)\n$$\n在我们的问题中，随机变量为 $X_1, \\dots, X_n$，它们是参数为 $p$ 的独立同分布 (i.i.d.) 伯努利随机变量。因此，$X_i \\in \\{0, 1\\}$。我们可以将它们的界限对所有 $i$ 设为 $a_i=0$ 和 $b_i=1$。范围是 $b_i - a_i = 1$。期望为 $\\mathbb{E}[\\bar{X}_n] = p$。\n\n将这些代入一般不等式，分母中的和变为 $\\sum_{i=1}^n(1-0)^2 = n$。不等式简化为：\n$$\n\\mathbb{P}\\left(\\bar{X}_n - p \\ge \\epsilon\\right) \\le \\exp\\left(-\\frac{2n^2\\epsilon^2}{n}\\right) = \\exp\\left(-2n\\epsilon^2\\right)\n$$\n这个界的形式为 $\\exp(-n\\,g_{\\mathrm{H}}(\\epsilon))$。通过比较，我们确定Hoeffding类型指数为：\n$$\ng_{\\mathrm{H}}(\\epsilon) = 2\\epsilon^2\n$$\n该指数仅取决于偏差 $\\epsilon$ 和变量的范围（此处隐式为1），而与方差无关。\n\n最小样本量 $n_{\\mathrm{H}}(\\epsilon, \\delta)$ 是满足以下条件的最小整数 $n$：\n$$\n\\exp(-n\\,g_{\\mathrm{H}}(\\epsilon)) \\le \\delta\n$$\n对两边取自然对数：\n$$\n-n\\,g_{\\mathrm{H}}(\\epsilon) \\le \\ln(\\delta) \\implies n\\,g_{\\mathrm{H}}(\\epsilon) \\ge -\\ln(\\delta) = \\ln(1/\\delta)\n$$\n由于当 $\\epsilon > 0$ 时 $g_{\\mathrm{H}}(\\epsilon) > 0$，我们有：\n$$\nn \\ge \\frac{\\ln(1/\\delta)}{g_{\\mathrm{H}}(\\epsilon)} = \\frac{\\ln(1/\\delta)}{2\\epsilon^2}\n$$\n满足此条件的最小整数 $n$ 是右侧表达式的上取整：\n$$\nn_{\\mathrm{H}}(\\epsilon, \\delta) = \\left\\lceil \\frac{\\ln(1/\\delta)}{2\\epsilon^2} \\right\\rceil\n$$\n\n**2. Bernstein不等式与Bernstein类型指数**\n\nBernstein不等式是另一种集中不等式，它通过引入方差信息改进了Hoeffding不等式。对于一组独立随机变量 $Y_1, \\dots, Y_n$，其中 $\\mathbb{E}[Y_i]=0$，$|Y_i| \\le K$，总方差为 $V = \\sum_{i=1}^n \\mathrm{Var}(Y_i)$，Bernstein不等式的一种常见形式是：\n$$\n\\mathbb{P}\\left(\\sum_{i=1}^n Y_i \\ge t\\right) \\le \\exp\\left(-\\frac{t^2/2}{V + Kt/3}\\right)\n$$\n为了将其应用于我们的问题，我们考虑中心化的随机变量 $Y_i = X_i - p$。则 $\\mathbb{E}[Y_i]=0$。偏差事件为 $\\bar{X}_n - p \\ge \\epsilon$，等价于 $\\sum_{i=1}^n (X_i - p) \\ge n\\epsilon$。因此，我们设 $t=n\\epsilon$。\n\n每个 $X_i$ 的方差是 $\\mathrm{Var}(X_i) = p(1-p)$。我们用 $\\sigma^2$ 来表示它。总方差为 $V = \\sum_{i=1}^n \\mathrm{Var}(X_i) = n\\sigma^2 = np(1-p)$。\n\n随机变量 $X_i$ 有界于 $[0,1]$。因此，中心化变量 $Y_i = X_i - p$ 有界于 $[-p, 1-p]$。$|Y_i|$ 的一个通用界是 $1$，这对任何 $p \\in [0,1]$ 都成立。所以，我们可以设 $K=1$。\n\n将 $t=n\\epsilon$, $V=n\\sigma^2$ 和 $K=1$ 代入不等式的指数部分：\n$$\n-\\frac{(n\\epsilon)^2/2}{n\\sigma^2 + 1 \\cdot (n\\epsilon)/3} = -\\frac{n^2\\epsilon^2/2}{n(\\sigma^2 + \\epsilon/3)} = -n \\frac{\\epsilon^2/2}{\\sigma^2 + \\epsilon/3}\n$$\n得到的界为：\n$$\n\\mathbb{P}\\left(\\bar{X}_n - p \\ge \\epsilon\\right) \\le \\exp\\left(-n \\frac{\\epsilon^2}{2(\\sigma^2 + \\epsilon/3)}\\right)\n$$\n这个界的形式为 $\\exp(-n\\,g_{\\mathrm{B}}(\\epsilon, p))$。通过比较，Bernstein类型指数为：\n$$\ng_{\\mathrm{B}}(\\epsilon, p) = \\frac{\\epsilon^2}{2(\\sigma^2 + \\epsilon/3)} = \\frac{\\epsilon^2}{2(p(1-p) + \\epsilon/3)}\n$$\n该指数取决于 $\\epsilon$ 并包含了方差 $\\sigma^2=p(1-p)$。\n\n最小样本量 $n_{\\mathrm{B}}(\\epsilon, \\delta, p)$ 是满足以下条件的最小整数 $n$：\n$$\n\\exp(-n\\,g_{\\mathrm{B}}(\\epsilon, p)) \\le \\delta\n$$\n遵循与Hoeffding相同的推导过程，我们得到：\n$$\nn_{\\mathrm{B}}(\\epsilon, \\delta, p) = \\left\\lceil \\frac{\\ln(1/\\delta)}{g_{\\mathrm{B}}(\\epsilon, p)} \\right\\rceil = \\left\\lceil \\frac{\\ln(1/\\delta) \\cdot 2(p(1-p) + \\epsilon/3)}{\\epsilon^2} \\right\\rceil\n$$\n\n**3. 测试用例计算**\n\n将实现推导出的 $g_{\\mathrm{H}}, g_{\\mathrm{B}}, n_{\\mathrm{H}}, n_{\\mathrm{B}}$ 公式，以及所需的两个比率，并将其应用于每个测试用例。\n- $g_{\\mathrm{H}}(\\epsilon) = 2\\epsilon^2$\n- $g_{\\mathrm{B}}(\\epsilon,p) = \\frac{\\epsilon^2}{2(p(1-p) + \\epsilon/3)}$\n- $n_{\\mathrm{H}}(\\epsilon,\\delta) = \\lceil \\frac{\\ln(1/\\delta)}{g_{\\mathrm{H}}(\\epsilon)} \\rceil$\n- $n_{\\mathrm{B}}(\\epsilon,\\delta,p) = \\lceil \\frac{\\ln(1/\\delta)}{g_{\\mathrm{B}}(\\epsilon,p)} \\rceil$\n- 指数比：$g_{\\mathrm{B}}(\\epsilon,p) / g_{\\mathrm{H}}(\\epsilon)$\n- 样本复杂度比：$n_{\\mathrm{B}}(\\epsilon,\\delta,p) / n_{\\mathrm{H}}(\\epsilon,\\delta)$\n\n对问题陈述中提供的每个三元组 $(p, \\epsilon, \\delta)$ 计算这些表达式的值。对于边界情况 $p=0$，方差 $\\sigma^2 = 0$，这些公式仍然是良定义的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares Hoeffding and Bernstein bounds for Bernoulli variables.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (p, epsilon, delta) = (0.5, 0.05, 10^-3)\n        (0.5, 0.05, 1e-3),\n        # Case 2: (p, epsilon, delta) = (0.1, 0.05, 10^-3)\n        (0.1, 0.05, 1e-3),\n        # Case 3: (p, epsilon, delta) = (0.01, 0.02, 10^-6)\n        (0.01, 0.02, 1e-6),\n        # Case 4: (p, epsilon, delta) = (0.9, 0.05, 10^-3)\n        (0.9, 0.05, 1e-3),\n        # Case 5: (p, epsilon, delta) = (0.5, 0.2, 10^-6)\n        (0.5, 0.2, 1e-6),\n        # Case 6: (p, epsilon, delta) = (0.0, 0.05, 10^-3)\n        (0.0, 0.05, 1e-3),\n    ]\n\n    results = []\n    for p, epsilon, delta in test_cases:\n        # Calculate intermediate quantity log(1/delta)\n        log_1_over_delta = np.log(1.0 / delta)\n\n        # 1. Hoeffding-type calculations\n        # g_H(epsilon) = 2 * epsilon^2\n        g_H = 2.0 * epsilon**2\n        \n        # n_H = ceil(log(1/delta) / g_H)\n        n_H_float = log_1_over_delta / g_H\n        n_H = int(np.ceil(n_H_float))\n        \n        # 2. Bernstein-type calculations\n        # sigma^2 = p * (1-p) for Bernoulli variables\n        sigma_sq = p * (1.0 - p)\n        \n        # g_B(epsilon, p) = epsilon^2 / (2 * (sigma^2 + epsilon/3))\n        g_B = (epsilon**2) / (2.0 * (sigma_sq + epsilon / 3.0))\n\n        # n_B = ceil(log(1/delta) / g_B)\n        n_B_float = log_1_over_delta / g_B\n        n_B = int(np.ceil(n_B_float))\n        \n        # 3. Ratio calculations\n        # Exponent ratio g_B / g_H\n        exponent_ratio = g_B / g_H\n        \n        # Sample complexity ratio n_B / n_H\n        # This is a ratio of integers, resulting in a float.\n        sample_ratio = n_B / n_H\n        \n        # Assemble the list of 6 required values for the current test case\n        case_results = [\n            g_H,\n            g_B,\n            n_H,\n            n_B,\n            exponent_ratio,\n            sample_ratio,\n        ]\n        results.append(case_results)\n\n    # Helper function to format a list to string without whitespace\n    def list_to_str(lst):\n        return f\"[{','.join(map(str, lst))}]\"\n\n    # Final print statement in the exact required format.\n    # [[v11,v12,...],[v21,v22,...],...] with no whitespace.\n    print(f\"[{','.join(map(list_to_str, results))}]\")\n\nsolve()\n```", "id": "3437635"}, {"introduction": "集中不等式不仅是理论工具，在算法设计中也扮演着至关重要的角色。这个高级应用练习将引导你运用伯恩斯坦不等式来解决一个在稀疏恢复中常见的实际问题：设计一个统计上可靠的算法迭代停止准则。通过为迭代过程中的残差能量下降设定一个阈值，你可以确保算法的进一步“改进”并非源于拟合噪声。这项练习充分展示了如何将集中不等式从一个抽象的概率界限，转化为机器学习和信号处理中用于做出数据驱动决策的实用工具。", "problem": "设计并实现一个程序，对于一个给定的迭代稀疏恢复过程，该程序输出一个最早的迭代索引，在该索引处，经验残差能量的进一步减小可以高置信度地归因于噪声。考虑线性测量模型 $y = A x^\\star + w$，其中噪声分量 $w_i$ 是独立同分布 (i.i.d.) 的，具有零均值、方差 $\\mathbb{E}[w_i^2] = \\sigma^2$，并且几乎必然有界 $|w_i| \\leq b$。在第 $t$ 次迭代时，定义残差 $r_t = y - A x_t$ 和每个样本的经验残差能量 $u_t = \\|r_t\\|_2^2 / n$。目标是基于噪声平方样本均值的Bernstein型集中不等式，设计一个数据依赖的停止准则，确保观察到的低于某个阈值的改进，能以至少 $1-\\alpha$ 的置信度，被认为是噪声波动所驱动。\n\n使用以下基础依据：\n- $\\{w_i\\}_{i=1}^n$ 的独立性和有界性。\n- 针对有界、独立、零均值变量和的经典Bernstein不等式：若 $X_i$ 独立，$\\mathbb{E}[X_i]=0$，几乎必然有 $|X_i| \\leq M$，且 $\\sum_{i=1}^n \\operatorname{Var}(X_i) \\leq S^2$，则对于任意 $t>0$，\n$$\n\\mathbb{P}\\left( \\left| \\sum_{i=1}^n X_i \\right| \\geq t \\right) \\leq 2 \\exp\\left( - \\frac{t^2}{2 S^2 + \\frac{2}{3} M t} \\right).\n$$\n\n按如下方式推导停止阈值。在原假设下，即迭代值 $x_t$ 已捕获信号且残差为纯噪声，我们有 $u_t = \\frac{1}{n}\\sum_{i=1}^n w_i^2$。定义中心化变量 $Z_i = w_i^2 - \\sigma^2$。则 $\\mathbb{E}[Z_i]=0$，$|Z_i| \\leq M := b^2 + \\sigma^2$。记 $v := \\operatorname{Var}(w_i^2)$，因此 $\\sum_{i=1}^n \\operatorname{Var}(Z_i) = n v$。将Bernstein不等式应用于 $\\sum_{i=1}^n Z_i$ 可得，对于任意 $\\varepsilon > 0$，\n$$\n\\mathbb{P}\\left( \\left| \\frac{1}{n}\\sum_{i=1}^n Z_i \\right| \\geq \\varepsilon \\right) \\leq 2 \\exp\\left( - \\frac{n \\varepsilon^2}{2 v + \\frac{2}{3} M \\varepsilon} \\right).\n$$\n为保证在计划的 $T$ 次迭代检查中，错误声明的总概率最多为 $\\alpha$，应用联合界并将每次检查的置信水平设置为 $\\alpha' = \\alpha / T$。将 $\\varepsilon_B$ 定义为以下不等式的最小非负解：\n$$\n2 \\exp\\left( - \\frac{n \\varepsilon^2}{2 v + \\frac{2}{3} M \\varepsilon} \\right) \\leq \\alpha',\n$$\n并定义改进阈值\n$$\n\\delta := 2 \\varepsilon_B,\n$$\n该阈值保守地考虑了两个连续残差能量估计中的波动。停止准则为：在满足 $u_{t-1} - u_t \\leq \\delta$ 的最小迭代次数 $t \\in \\{1,2,\\dots,T\\}$ 处停止。如果不存在这样的 $t$，则返回 $-1$。\n\n您的程序必须：\n- 对于每个测试用例，通过数值求解满足以下条件的最小 $\\varepsilon \\geq 0$ 来计算 $\\delta$ 以得到 $\\varepsilon_B$：\n$$\n\\frac{n \\varepsilon^2}{2 v + \\frac{2}{3} M \\varepsilon} \\geq \\log\\left(\\frac{2}{\\alpha'}\\right),\n$$\n其中 $\\alpha' = \\alpha / T$，$M = b^2 + \\sigma^2$，而 $v = \\operatorname{Var}(w_i^2)$ 作为输入参数提供。\n- 返回满足 $u_{t-1} - u_t \\leq \\delta$ 的最小 $t$，如果不存在这样的 $t$，则返回 $-1$。\n\n所有角度（如有）都必须以弧度为单位。本问题中没有物理单位。\n\n测试套件包含三个案例。对于每个案例，输入如下：\n- $n$：样本大小。\n- $\\alpha$：目标族系误差水平。\n- $b$：$|w_i|$ 的几乎必然上界。\n- $\\sigma^2$：噪声方差。\n- $v$：$w_i^2$ 的方差。\n- $\\{u_t\\}_{t=0}^T$：经验残差能量的有限序列；此处 $T$ 等于序列长度减1。\n\n使用以下测试用例：\n- 案例A（一般行为）：\n  - $n = 1000$, $\\alpha = 0.05$, $b = 3$, $\\sigma^2 = 1$, $v = 2$, $\\{u_t\\}_{t=0}^7 = \\{5.0, 3.0, 1.6, 1.2, 1.05, 1.01, 1.008, 1.0075\\}$。\n- 案例B（小 $n$，较大不确定性）：\n  - $n = 50$, $\\alpha = 0.1$, $b = 2$, $\\sigma^2 = 0.5$, $v = 0.5$, $\\{u_t\\}_{t=0}^6 = \\{1.2, 0.8, 0.6, 0.55, 0.51, 0.505, 0.504\\}$。\n- 案例C（较大 $n$ 和界）：\n  - $n = 2000$, $\\alpha = 0.01$, $b = 10$, $\\sigma^2 = 4$, $v = 32$, $\\{u_t\\}_{t=0}^8 = \\{20.0, 10.0, 6.0, 4.8, 4.3, 4.15, 4.08, 4.06, 4.055\\}$。\n\n您的程序应生成单行输出，其中包含一个方括号内的、以逗号分隔的结果列表（例如，\"[result1,result2,result3]\"）。每个结果应为对应测试用例的停止索引 $t$ 的整数（若未触发停止则为 $-1$）。", "solution": "该问题要求设计并实现一个用于迭代稀疏恢复算法的、基于统计信息的停止准则。核心任务是确定最早的迭代次数 $t$，在该次迭代中，观察到的残差能量减少量 $u_{t-1} - u_t$ 小到足以高置信度地归因于噪声波动，而非信号估计的真实改进。\n\n问题背景设定在线性测量模型 $y = A x^\\star + w$ 中，其中 $y \\in \\mathbb{R}^n$ 是测量向量，$A \\in \\mathbb{R}^{n \\times d}$ 是传感矩阵，$x^\\star \\in \\mathbb{R}^d$ 是未知的稀疏信号，$w \\in \\mathbb{R}^n$ 是噪声分量向量。噪声分量 $w_i$ 被假定为独立同分布（i.i.d.），具有零均值（$\\mathbb{E}[w_i] = 0$）、方差 $\\mathbb{E}[w_i^2] = \\sigma^2$ 和几乎必然的上界 $|w_i| \\leq b$。\n\n一个迭代算法为 $x^\\star$ 生成一系列估计值 $\\{x_t\\}$。在每次迭代 $t$ 时，我们计算残差 $r_t = y - A x_t$ 和每个样本的经验残差能量 $u_t = \\frac{1}{n} \\|r_t\\|_2^2 = \\frac{1}{n} \\sum_{i=1}^n r_{t,i}^2$。\n\n停止准则基于一个原假设 $H_0$：迭代过程已收敛到一个点，在该点残差的信号分量可忽略不计，即 $r_t \\approx w$。在此假设下，残差能量 $u_t$ 是噪声分量平方的样本均值：$u_t \\approx \\frac{1}{n} \\sum_{i=1}^n w_i^2$。因此，$u_t$ 的期望值为 $\\mathbb{E}[u_t] \\approx \\mathbb{E}[\\frac{1}{n} \\sum_{i=1}^n w_i^2] = \\sigma^2$。我们使用Bernstein集中不等式来界定 $u_t$ 显著偏离 $\\sigma^2$ 的概率。\n\n让我们定义中心化随机变量 $Z_i = w_i^2 - \\sigma^2$。根据定义，$\\mathbb{E}[Z_i] = 0$。问题将 $w_i^2$ 的方差定义为 $v = \\operatorname{Var}(w_i^2) = \\operatorname{Var}(Z_i)$。对于这些变量的和，我们有 $\\sum_{i=1}^n \\operatorname{Var}(Z_i) = nv$。变量 $Z_i$ 也是有界的。由于 $0 \\leq w_i^2 \\leq b^2$，我们有 $-\\sigma^2 \\leq Z_i \\leq b^2 - \\sigma^2$。一个有效但可能宽松的几乎必然上界是 $|Z_i| \\leq |w_i^2| + |-\\sigma^2| \\leq b^2 + \\sigma^2$。问题将此界定义为 $M := b^2 + \\sigma^2$。\n\n我们将Bernstein不等式应用于和 $\\sum_{i=1}^n Z_i$。其一般形式为：\n$$\n\\mathbb{P}\\left( \\left| \\sum_{i=1}^n X_i \\right| \\geq \\tau \\right) \\leq 2 \\exp\\left( - \\frac{\\tau^2}{2 \\sum \\operatorname{Var}(X_i) + \\frac{2}{3} M_{max} \\tau} \\right)\n$$\n其中 $|X_i| \\leq M_{max}$。\n对于我们的变量 $Z_i$，我们关心的是样本均值的偏差，即 $|\\frac{1}{n}\\sum Z_i| = |u_t - \\sigma^2|$，我们将其表示为 $\\varepsilon$。设 $\\tau = n \\varepsilon$，$\\sum \\operatorname{Var}(Z_i) = nv$，以及 $M_{max} = M$，我们得到指定的不等式：\n$$\n\\mathbb{P}\\left( |u_t - \\sigma^2| \\geq \\varepsilon \\right) \\leq 2 \\exp\\left( - \\frac{(n\\varepsilon)^2}{2(nv) + \\frac{2}{3} M (n\\varepsilon)} \\right) = 2 \\exp\\left( - \\frac{n \\varepsilon^2}{2v + \\frac{2}{3} M \\varepsilon} \\right)\n$$\n\n迭代算法在 $T$ 个不同的步骤执行检查。为了将族系错误率保持在至多为 $\\alpha$，我们采用联合界。每次独立检查的置信水平被调整为 $\\alpha' = \\alpha / T$，其中 $T$ 是要执行的停止检查次数，这对应于要检查的改进次数，即 $T = \\text{length}(\\{u_t\\}) - 1$。\n\n我们寻求一个阈值 $\\varepsilon_B$，它代表了仅由噪声引起的 $u_t$ 偏离 $\\sigma^2$ 的最大可能偏差。这可以通过求解满足以下条件的最小非负 $\\varepsilon$ 来找到：\n$$\n2 \\exp\\left( - \\frac{n \\varepsilon^2}{2v + \\frac{2}{3} M \\varepsilon} \\right) \\leq \\alpha'\n$$\n对两边取自然对数并整理，得到：\n$$\n- \\frac{n \\varepsilon^2}{2v + \\frac{2}{3} M \\varepsilon} \\leq \\log\\left(\\frac{\\alpha'}{2}\\right) \\implies \\frac{n \\varepsilon^2}{2v + \\frac{2}{3} M \\varepsilon} \\geq \\log\\left(\\frac{2}{\\alpha'}\\right)\n$$\n令 $C = \\log(2/\\alpha')$。该不等式变为 $n \\varepsilon^2 \\geq C(2v + \\frac{2}{3} M \\varepsilon)$。这可以整理成一个标准的二次不等式：\n$$\nn \\varepsilon^2 - \\left(\\frac{2}{3} C M\\right) \\varepsilon - (2 C v) \\geq 0\n$$\n为了找到满足此条件的最小非负 $\\varepsilon_B$，我们求解相应二次方程 $n \\varepsilon^2 - (\\frac{2}{3} C M) \\varepsilon - (2 C v) = 0$ 的正根。使用二次公式 $\\varepsilon = \\frac{-b' \\pm \\sqrt{b'^2 - 4a'c'}}{2a'}$，其中系数为 $a' = n$，$b' = -\\frac{2}{3} C M$ 和 $c' = -2 C v$，我们得到：\n$$\n\\varepsilon_B = \\frac{\\frac{2}{3} C M + \\sqrt{\\left(\\frac{2}{3} C M\\right)^2 - 4(n)(-2Cv)}}{2n} = \\frac{\\frac{2}{3} C M + \\sqrt{\\frac{4}{9} C^2 M^2 + 8nCv}}{2n}\n$$\n此公式给出了 $\\varepsilon_B$ 的值。\n\n问题将最终的改进阈值定义为 $\\delta := 2 \\varepsilon_B$。这是一个保守的选择，反映了改进量 $u_{t-1} - u_t$ 涉及两个连续的残差能量估计。在原假设下，$u_{t-1}$ 和 $u_t$ 都从以 $\\sigma^2$ 为中心的同一分布中抽样。差异 $|(u_{t-1} - \\sigma^2) - (u_t - \\sigma^2)| \\leq |u_{t-1} - \\sigma^2| + |u_t - \\sigma^2|$ 可以高概率地被 $2\\varepsilon_B$ 界定。\n\n寻找停止索引的算法如下：\n1.  给定输入 $n$, $\\alpha$, $b$, $\\sigma^2$, $v$ 和序列 $\\{u_t\\}_{t=0}^T$。\n2.  计算检查次数 $T = \\text{length}(\\{u_t\\}) - 1$。\n3.  计算每次检查的置信水平 $\\alpha' = \\alpha / T$。\n4.  计算Bernstein界的参数：$M = b^2 + \\sigma^2$ 和 $C = \\log(2/\\alpha')$。\n5.  使用推导出的二次公式求解 $\\varepsilon_B$。\n6.  计算改进阈值 $\\delta = 2 \\varepsilon_B$。\n7.  从 $t=1$ 到 $T$ 迭代。对每个 $t$，计算改进量 $u_{t-1} - u_t$。\n8.  停止索引是第一个满足 $u_{t-1} - u_t \\leq \\delta$ 的 $t$ 值。\n9.  如果循环完成而此条件未被满足，则在给定迭代次数内未找到停止点，结果为 $-1$。\n\n此过程将应用于每个测试用例，以确定相应的停止索引。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stopping index in an iterative sparse recovery process\n    based on a Bernstein-type concentration inequality.\n    \"\"\"\n    test_cases = [\n        # Case A (general behavior)\n        {\n            \"n\": 1000, \"alpha\": 0.05, \"b\": 3, \"sigma_sq\": 1, \"v\": 2,\n            \"u_seq\": [5.0, 3.0, 1.6, 1.2, 1.05, 1.01, 1.008, 1.0075]\n        },\n        # Case B (small n, larger uncertainty)\n        {\n            \"n\": 50, \"alpha\": 0.1, \"b\": 2, \"sigma_sq\": 0.5, \"v\": 0.5,\n            \"u_seq\": [1.2, 0.8, 0.6, 0.55, 0.51, 0.505, 0.504]\n        },\n        # Case C (larger n and bound)\n        {\n            \"n\": 2000, \"alpha\": 0.01, \"b\": 10, \"sigma_sq\": 4, \"v\": 32,\n            \"u_seq\": [20.0, 10.0, 6.0, 4.8, 4.3, 4.15, 4.08, 4.06, 4.055]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n = case[\"n\"]\n        alpha = case[\"alpha\"]\n        b = case[\"b\"]\n        sigma_sq = case[\"sigma_sq\"]\n        v = case[\"v\"]\n        u_seq = case[\"u_seq\"]\n\n        # 1. Calculate number of checks T\n        T = len(u_seq) - 1\n        if T == 0:\n            results.append(-1)\n            continue\n            \n        # 2. Compute per-check confidence alpha_prime\n        alpha_prime = alpha / T\n\n        # 3. Compute parameters for Bernstein bound\n        # M is the almost-sure bound on |w_i^2 - sigma^2|\n        M = b**2 + sigma_sq\n        # C is the constant from rearranging the inequality\n        C = np.log(2 / alpha_prime)\n\n        # 4. Solve for epsilon_B\n        # This solves the quadratic equation for the positive root:\n        # n * eps^2 - (2/3 * C * M) * eps - (2 * C * v) = 0\n        a_quad = n\n        b_quad = -(2/3) * C * M\n        c_quad = -2 * C * v\n        \n        # Using the quadratic formula, we are interested in the positive root\n        discriminant = b_quad**2 - 4 * a_quad * c_quad\n        if discriminant  0:\n            # This should not happen with the given problem formulation\n            # as a, C, v are all positive, so c_quad is negative, making -4ac positive.\n            epsilon_B = 0\n        else:\n            epsilon_B = (-b_quad + np.sqrt(discriminant)) / (2 * a_quad)\n\n        # 5. Calculate the improvement threshold delta\n        delta = 2 * epsilon_B\n\n        # 6. Find the earliest stopping time t\n        stop_index = -1\n        for t in range(1, T + 1):\n            improvement = u_seq[t - 1] - u_seq[t]\n            if improvement = delta:\n                stop_index = t\n                break\n        \n        results.append(stop_index)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3437641"}]}