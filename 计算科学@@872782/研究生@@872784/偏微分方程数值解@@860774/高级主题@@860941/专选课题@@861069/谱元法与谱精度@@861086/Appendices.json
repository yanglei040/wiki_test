{"hands_on_practices": [{"introduction": "在求解时间相关或特征值问题时，质量矩阵扮演着核心角色。在谱元法中，将勒让德-高斯-洛巴托（LGL）求积与节点基函数相结合会产生一个显著的优势：质量矩阵的对角化。这项练习 [@problem_id:3446203] 让你通过亲手计算LGL节点和权重，来验证这一关键的“集总质量”特性，它极大地简化了数值计算的复杂性。", "problem": "考虑参考单元 $[-1,1]$ 以及在勒让德-高斯-洛巴托 (Legendre–Gauss–Lobatto, LGL) 节点上进行节点插值的 $N$ 次谱元，其中 $N=4$。设 $\\{x_i\\}_{i=0}^{N}$ 表示 LGL 节点，$\\{w_i\\}_{i=0}^{N}$ 表示相关的 LGL 求积权重。设 $\\{\\ell_i(x)\\}_{i=0}^{N}$ 为 $[-1,1]$ 上的节点拉格朗日基，满足 $\\ell_i(x_j)=\\delta_{ij}$。LGL 求积通过以下公式定义了基于求积的质量矩阵 $M \\in \\mathbb{R}^{(N+1)\\times(N+1)}$：\n$$\nM_{ij} \\equiv \\sum_{k=0}^{N} w_k\\, \\ell_i(x_k)\\,\\ell_j(x_k).\n$$\n任务：\n- 仅使用勒让德多项式的基本定义和 LGL 构造方法，确定 $N=4$ 时的 LGL 节点 $\\{x_i\\}_{i=0}^{4}$ 和 LGL 权重 $\\{w_i\\}_{i=0}^{4}$，并报告其数值（保留至少四位有效数字）。\n- 使用上述求积和节点拉格朗日基组装矩阵 $M$。从第一性原理证明，为什么对于节点基，在 LGL 求积下所有非对角元 $M_{ij}$（其中 $i\\neq j$）均为零。\n- 根据你组装的矩阵 $M$，精确计算其行列式。\n\n请提供 $\\det(M)$ 的精确值作为你的最终答案，形式为一个单一的简化解析表达式（无单位，无小数近似）。", "solution": "本题要求我们确定 $N=4$ 次谱元的勒让德-高斯-洛巴托 (LGL) 节点和权重，分析基于求积的质量矩阵 $M$ 的结构，并计算其精确行列式。我们将系统地解决问题的每个部分。\n\n首先，我们确定 $N=4$ 时的 LGL 节点和权重。区间 $[-1,1]$ 上的 LGL 节点 $\\{x_i\\}_{i=0}^{N}$ 是方程 $(1-x^2)P_N'(x) = 0$ 的根，其中 $P_N(x)$ 是 $N$ 次勒让德多项式。对于 $N=4$，节点是 $(1-x^2)P_4'(x)=0$ 的根。端点 $x_0=-1$ 和 $x_4=1$ 立即可确定为节点。内部节点是 $P_4'(x)=0$ 的根。\n\n我们使用勒让德多项式的递推关系来求 $P_4(x)$：\n$(n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x)$，其中基例为 $P_0(x)=1$ 和 $P_1(x)=x$。\n当 $n=1$ 时：$2P_2(x) = 3xP_1(x) - 1P_0(x) = 3x^2 - 1 \\implies P_2(x) = \\frac{1}{2}(3x^2-1)$。\n当 $n=2$ 时：$3P_3(x) = 5xP_2(x) - 2P_1(x) = \\frac{5}{2}x(3x^2-1) - 2x = \\frac{1}{2}(15x^3-9x) \\implies P_3(x) = \\frac{1}{2}(5x^3-3x)$。\n当 $n=3$ 时：$4P_4(x) = 7xP_3(x) - 3P_2(x) = \\frac{7}{2}x(5x^3-3x) - \\frac{3}{2}(3x^2-1) = \\frac{1}{2}(35x^4 - 21x^2 - 9x^2 + 3) = \\frac{1}{2}(35x^4 - 30x^2 + 3)$。\n因此，$P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$。\n\n其导数为 $P_4'(x) = \\frac{1}{8}(140x^3 - 60x) = \\frac{5}{2}(7x^3 - 3x) = \\frac{5}{2}x(7x^2 - 3)$。\n$P_4'(x)=0$ 的根可通过令 $x(7x^2 - 3)=0$ 求得，即 $x=0$ 和 $x=\\pm\\sqrt{\\frac{3}{7}}$。\n\n$N=4$ 时的 LGL 节点，从小到大排序为：\n$x_0 = -1$\n$x_1 = -\\sqrt{\\frac{3}{7}}$\n$x_2 = 0$\n$x_3 = \\sqrt{\\frac{3}{7}}$\n$x_4 = 1$\n\n这些节点的数值近似为：\n$x_0 = -1.000$\n$x_1 \\approx -0.6547$\n$x_2 = 0.0000$\n$x_3 \\approx 0.6547$\n$x_4 = 1.0000$\n\nLGL 求积权重 $\\{w_i\\}_{i=0}^{N}$ 由公式 $w_i = \\frac{2}{N(N+1)[P_N(x_i)]^2}$ 给出。对于 $N=4$，该公式变为 $w_i = \\frac{2}{4(5)[P_4(x_i)]^2} = \\frac{1}{10[P_4(x_i)]^2}$。\n\n- 对于端点 $x_0=-1$ 和 $x_4=1$，我们使用 $P_4(-1) = (-1)^4 = 1$ 和 $P_4(1) = 1$。\n$w_0 = w_4 = \\frac{1}{10[P_4(1)]^2} = \\frac{1}{10(1)^2} = \\frac{1}{10}$。\n\n- 对于节点 $x_2=0$，我们计算 $P_4(0) = \\frac{1}{8}(3) = \\frac{3}{8}$。\n$w_2 = \\frac{1}{10[P_4(0)]^2} = \\frac{1}{10(\\frac{3}{8})^2} = \\frac{1}{10 \\cdot \\frac{9}{64}} = \\frac{64}{90} = \\frac{32}{45}$。\n\n- 对于内部节点 $x_1=-\\sqrt{\\frac{3}{7}}$ 和 $x_3=\\sqrt{\\frac{3}{7}}$，我们在 $x^2 = \\frac{3}{7}$ 处计算 $P_4(x)$ 的值。\n$P_4(\\pm\\sqrt{\\frac{3}{7}}) = \\frac{1}{8}\\left(35\\left(\\frac{3}{7}\\right)^2 - 30\\left(\\frac{3}{7}\\right) + 3\\right) = \\frac{1}{8}\\left(35\\frac{9}{49} - \\frac{90}{7} + 3\\right) = \\frac{1}{8}\\left(\\frac{45}{7} - \\frac{90}{7} + \\frac{21}{7}\\right) = \\frac{1}{8}\\left(\\frac{-24}{7}\\right) = -\\frac{3}{7}$。\n$w_1 = w_3 = \\frac{1}{10[P_4(\\sqrt{3/7})]^2} = \\frac{1}{10(-\\frac{3}{7})^2} = \\frac{1}{10 \\cdot \\frac{9}{49}} = \\frac{49}{90}$。\n\n$N=4$ 时的 LGL 权重为：\n$w_0 = \\frac{1}{10}$ (约 $0.1000$)\n$w_1 = \\frac{49}{90}$ (约 $0.5444$)\n$w_2 = \\frac{32}{45}$ (约 $0.7111$)\n$w_3 = \\frac{49}{90}$ (约 $0.5444$)\n$w_4 = \\frac{1}{10}$ (约 $0.1000$)\n\n接下来，我们讨论质量矩阵 $M$ 的结构。题目将基于求积的质量矩阵元定义为 $M_{ij} = \\sum_{k=0}^{N} w_k\\, \\ell_i(x_k)\\,\\ell_j(x_k)$。基函数 $\\{\\ell_i(x)\\}_{i=0}^{N}$ 是节点拉格朗日基多项式，由性质 $\\ell_i(x_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n将此性质应用于 $M_{ij}$ 的定义：\n项 $\\ell_i(x_k)$ 在 $k=i$ 时为 $1$，否则为 $0$。因此，我们可以写成 $\\ell_i(x_k) = \\delta_{ik}$。\n类似地，$\\ell_j(x_k) = \\delta_{jk}$。\n将这些代入求和式中：\n$M_{ij} = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{jk}$。\n\n为证明非对角元为零，考虑 $i \\neq j$ 的情况。对于求和式中的任意一项（由 $k$ 索引），乘积 $\\delta_{ik}\\delta_{jk}$ 只有在 $\\delta_{ik}=1$ 和 $\\delta_{jk}=1$ 同时成立时才非零。这要求 $k=i$ 和 $k=j$ 同时成立。由于我们假设 $i \\neq j$，这是不可能的。因此，对于任意 $k \\in \\{0, 1, \\dots, N\\}$，当 $i \\neq j$ 时，乘积 $\\delta_{ik}\\delta_{jk}$ 恒为 $0$。\n这导致：\n$M_{ij} = \\sum_{k=0}^{N} w_k \\cdot 0 = 0$ (当 $i \\neq j$ 时)。\n这从第一性原理证明了 $M$ 的所有非对角元都为零。\n\n对于对角元，考虑 $i = j$ 的情况。表达式变为：\n$M_{ii} = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{ik} = \\sum_{k=0}^{N} w_k (\\delta_{ik})^2$。\n由于 $\\delta_{ik}$ 的值是 $0$ 或 $1$，所以 $(\\delta_{ik})^2 = \\delta_{ik}$。\n$M_{ii} = \\sum_{k=0}^{N} w_k \\delta_{ik}$。\n这个求和式中只有一个非零项，即当 $k=i$ 时。该项的值为 $w_i \\cdot \\delta_{ii} = w_i \\cdot 1 = w_i$。\n所以，$M_{ii} = w_i$。\n\n矩阵 $M$ 是一个对角矩阵，其对角元是 LGL 求积权重：\n$M = \\text{diag}(w_0, w_1, w_2, w_3, w_4)$。\n\n用计算出的 $N=4$ 的权重组装矩阵 $M$：\n$$\nM = \\begin{pmatrix} \\frac{1}{10} & 0 & 0 & 0 & 0 \\\\ 0 & \\frac{49}{90} & 0 & 0 & 0 \\\\ 0 & 0 & \\frac{32}{45} & 0 & 0 \\\\ 0 & 0 & 0 & \\frac{49}{90} & 0 \\\\ 0 & 0 & 0 & 0 & \\frac{1}{10} \\end{pmatrix}\n$$\n\n最后，我们计算 $M$ 的行列式。对角矩阵的行列式是其对角元的乘积。\n$\\det(M) = w_0 \\cdot w_1 \\cdot w_2 \\cdot w_3 \\cdot w_4$。\n代入权重的精确分数值：\n$\\det(M) = \\left(\\frac{1}{10}\\right) \\cdot \\left(\\frac{49}{90}\\right) \\cdot \\left(\\frac{32}{45}\\right) \\cdot \\left(\\frac{49}{90}\\right) \\cdot \\left(\\frac{1}{10}\\right)$。\n我们使用质因数分解来简化此乘积。\n$10 = 2 \\cdot 5$\n$49 = 7^2$\n$90 = 9 \\cdot 10 = 3^2 \\cdot 2 \\cdot 5$\n$32 = 2^5$\n$45 = 9 \\cdot 5 = 3^2 \\cdot 5$\n\n$\\det(M) = \\frac{1}{2 \\cdot 5} \\cdot \\frac{7^2}{3^2 \\cdot 2 \\cdot 5} \\cdot \\frac{2^5}{3^2 \\cdot 5} \\cdot \\frac{7^2}{3^2 \\cdot 2 \\cdot 5} \\cdot \\frac{1}{2 \\cdot 5}$\n\n合并分子和分母中的项：\n分子：$1 \\cdot 7^2 \\cdot 2^5 \\cdot 7^2 \\cdot 1 = 2^5 \\cdot 7^4$。\n分母：$(2\\cdot5) \\cdot (3^2\\cdot2\\cdot5) \\cdot (3^2\\cdot5) \\cdot (3^2\\cdot2\\cdot5) \\cdot (2\\cdot5) = 2^{1+1+1+1} \\cdot 3^{2+2+2} \\cdot 5^{1+1+1+1+1} = 2^4 \\cdot 3^6 \\cdot 5^5$。\n\n$\\det(M) = \\frac{2^5 \\cdot 7^4}{2^4 \\cdot 3^6 \\cdot 5^5} = \\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}$。\n这就是行列式的精确简化解析表达式。为了便于展示，我们计算出整数值：$7^4=2401$，$3^6=729$，$5^5=3125$。\n$\\det(M) = \\frac{2 \\cdot 2401}{729 \\cdot 3125} = \\frac{4802}{2278125}$。使用素数幂的形式更为基本。\n最终答案是 $\\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}$。", "answer": "$$\n\\boxed{\\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}}\n$$", "id": "3446203"}, {"introduction": "从线性算子过渡到非线性问题时，会面临新的挑战。虽然LGL求积对于一定次数内的多项式是精确的，但像 $u^3$ 这样的非线性项的次数常常会超过这个限制，从而导致“混淆误差”（aliasing error）——这是谱方法中的一个基本概念。通过这项练习 [@problem_id:3446167]，你将能够显式地计算这个误差，从而具体地理解高频信息是如何被错误地表示并导致计算不准确的。", "problem": "考虑谱元法中参考区间 $[-1,1]$ 上的单个谱元。设多项式近似为 $N$ 次的 $u(x)=\\sum_{k=0}^{N} c_{k} x^{k}$，其中系数 $c_{k}$ 为实数。为了评估非线性模态能量转移，通常使用 Legendre–Gauss–Lobatto (LGL) 求积法计算积分 $\\int_{-1}^{1} u(x)^{3}\\,dx$。将混叠误差定义为应用于 $u(x)^{3}$ 的 LGL 求积与精确积分之差，\n$$E_{N}(c_{0},\\ldots,c_{N}) \\equiv \\sum_{j=0}^{N} w_{j}\\,u(x_{j})^{3} \\;-\\; \\int_{-1}^{1} u(x)^{3}\\,dx,$$\n其中 $\\{x_{j}\\}_{j=0}^{N}$ 和 $\\{w_{j}\\}_{j=0}^{N}$ 是 $[-1,1]$ 上 $N$ 次插值的 LGL 节点和权重。\n\n任务 1. 从以下事实出发：(i) LGL 求积法能精确积分最高为某个与 $N$ 相关的有限次数的多项式，以及 (ii) 多项式 $u(x)^{3}$ 的次数为 $3N$，在系数 $\\{c_{k}\\}$ 独立于 $N$ 且有界的假设下，给出一个有理有据的论证，说明 $E_{N}(c_{0},\\ldots,c_{N})$ 关于 $N$ 是 $\\mathcal{O}(1)$ 阶的。你的论证应从这些基本事实开始，不使用任何快捷公式，解释为什么对 $u(x)^{3}$ 的欠积分（underintegration）通常会导致一个不随 $N$ 增长的混叠误差。\n\n任务 2. 显式计算 $N=3$ 时的混叠误差 $E_{3}(c_{0},c_{1},c_{2},c_{3})$。为此计算，使用 $[-1,1]$ 上的 $N+1=4$ 点 LGL 规则，其节点为 $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$，权重为 $w_{0}=w_{3}=\\frac{1}{6}$, $w_{1}=w_{2}=\\frac{5}{6}$。你的最终表达式必须仅以 $c_{0},c_{1},c_{2},c_{3}$ 的函数形式给出闭式解。\n\n答案格式：为 $E_{3}(c_{0},c_{1},c_{2},c_{3})$ 提供一个单一的闭式解析表达式。无需四舍五入，此处不涉及物理单位。", "solution": "问题分为两部分。第一部分要求就混叠误差的阶数给出一个有理有据的论证。第二部分要求对一个特定情况直接计算此误差。\n\n**第 1 部分：关于混叠误差尺度的论证**\n\n混叠误差定义为\n$$E_{N}(c_{0},\\ldots,c_{N}) \\equiv \\sum_{j=0}^{N} w_{j}\\,u(x_{j})^{3} \\;-\\; \\int_{-1}^{1} u(x)^{3}\\,dx$$\n其中 $u(x) = \\sum_{k=0}^{N} c_k x^k$ 是一个 $N$ 次多项式，求积法是 $(N+1)$ 点的 Legendre-Gauss-Lobatto (LGL) 规则。\n\n有理有据的论证过程如下：\n1.  我们已知一个 $(N+1)$ 点的 LGL 求积规则能精确积分任何次数不超过 $2N-1$ 的多项式。\n2.  在我们的问题中，被积函数是 $f(x) = u(x)^3$。由于 $u(x)$ 是一个 $N$ 次多项式，$f(x)$ 是一个 $3N$ 次多项式。对于任何 $N \\ge 2$，被积函数的次数 $3N$ 大于求积规则的精确次数 $2N-1$。因此，对 $u(x)^3$ 的 LGL 求积不是精确的，误差 $E_N$ 通常非零。这个误差是混叠的直接结果，即被积函数的高频分量被离散的求积点集误解为低频分量。\n3.  我们可以将被积函数 $u(x)^3$ 分解为一个可以被精确积分的低次部分和一个不能被精确积分的高次部分。令 $u(x)^3 = P_{\\le 2N-1}(x) + R(x)$，其中 $P_{\\le 2N-1}(x)$ 是包含 $u(x)^3$ 中所有次数不超过 $2N-1$ 的项的多项式，而 $R(x)$ 包含所有次数从 $2N$ 到 $3N$ 的项。\n4.  根据积分和求积和的线性性质，误差为：\n    $$E_N = \\left( \\sum_{j=0}^{N} w_j P_{\\le 2N-1}(x_j) + \\sum_{j=0}^{N} w_j R(x_j) \\right) - \\left( \\int_{-1}^{1} P_{\\le 2N-1}(x) dx + \\int_{-1}^{1} R(x) dx \\right)$$\n5.  由于 LGL 规则的精确性，涉及 $P_{\\le 2N-1}(x)$ 的项会相互抵消：$\\sum_{j=0}^{N} w_j P_{\\le 2N-1}(x_j) = \\int_{-1}^{1} P_{\\le 2N-1}(x) dx$。\n6.  因此，混叠误差简化为对高次余项多项式 $R(x)$ 积分所产生的误差：\n    $$E_N = \\sum_{j=0}^{N} w_j R(x_j) - \\int_{-1}^{1} R(x) dx$$\n7.  问题假设 $u(x)$ 的系数 $\\{c_k\\}$ 是有界的且与 $N$ 无关。这意味着随着 $N$ 的增加，我们向 $u(x)$ 添加了更高次的项，而这些项的系数不会增长。高次余项多项式 $R(x)$ 是由这些系数的乘积构成的。例如，$u(x)^3$ 中最高次的项是 $c_N^3 x^{3N}$，如果 $c_N$ 有界，则系数 $c_N^3$ 也有界。更一般地，$R(x)$ 的系数是系数 $\\{c_k\\}$ 的多项式，在给定假设下，它们保持有界，不随 $N$ 增长。\n8.  混叠误差 $E_N$ 是 $R(x)$ 的真实积分与其通过求积和得到的混叠表示之间的差。混叠现象将高频模式（如 $R(x)$ 中的模式）映射回网格可分辨的低频模式上。这种混叠贡献的大小由高频内容本身的大小（即 $R(x)$ 的系数）决定。\n9.  由于 $R(x)$ 的系数是有界的（不是随 N 增长的函数），$R(x)$ 及其积分的大小，以及由求积和给出的其混叠对应物的大小，也都是受控的。它们不包含随 $N$ 系统性增长的因子。因此，它们的差，即混叠误差 $E_N$，在 $N$ 变化时预计保持有界，或者说是 $\\mathcal{O}(1)$ 阶。这是由求积规则的选择所固有的结构性误差，而不是对于所述的固定多项式类别，在加密（refinement）时会减小或爆炸的误差。\n\n**第 2 部分：对 $N=3$ 的显式计算**\n\n对于 $N=3$，多项式为 $u(x) = c_0 + c_1 x + c_2 x^2 + c_3 x^3$。被积函数 $u(x)^3$ 是一个 9 次多项式。$N=3$ 的 LGL 求积规则使用 $N+1=4$ 个点，对于次数最高为 $2N-1 = 2(3)-1 = 5$ 的多项式是精确的。\n\n混叠误差 $E_3$ 由下式给出：\n$$E_3 = \\sum_{j=0}^{3} w_{j}\\,u(x_{j})^{3} - \\int_{-1}^{1} u(x)^{3}\\,dx$$\n正如在第 1 部分中所述，这个误差仅来自于 $u(x)^3$ 中次数大于 5 的项。令 $R(x)$ 为 $u(x)^3$ 中次数从 6 到 9 的部分。\n$$E_3 = \\left(\\sum_{j=0}^{3} w_j R(x_j)\\right) - \\left(\\int_{-1}^{1} R(x) dx\\right)$$\n我们首先通过展开 $u(x)^3 = (c_0 + c_1 x + c_2 x^2 + c_3 x^3)^3$ 并收集次数为 6 及更高的项来确定多项式 $R(x)$。\n$(\\sum_{i=0}^3 c_i x^i)^3$ 展开式中 $x^k$ 的系数是 $\\sum_{i+j+l=k} c_i c_j c_l$。对于次数 $\\ge 6$ 的项：\n-   次数 9：$x^9$ 来自 $(c_3 x^3)^3$。系数为 $c_3^3$。\n-   次数 8：$x^8$ 来自 $3(c_3 x^3)^2(c_2 x^2)$。系数为 $3c_2 c_3^2$。\n-   次数 7：$x^7$ 来自 $3(c_3 x^3)^2(c_1 x)$ 和 $3(c_2 x^2)^2(c_3 x^3)$。系数为 $(3c_1 c_3^2 + 3c_2^2 c_3)$。\n-   次数 6：$x^6$ 来自 $3(c_3 x^3)^2(c_0)$、$6(c_3 x^3)(c_2 x^2)(c_1 x)$ 和 $(c_2 x^2)^3$。系数为 $(3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)$。\n\n所以，$R(x) = (3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)x^6 + (3c_1 c_3^2 + 3c_2^2 c_3)x^7 + (3c_2 c_3^2)x^8 + c_3^3 x^9$。\n\n让我们将系数表示为 $R(x) = A x^6 + B x^7 + C x^8 + D x^9$。根据误差泛函 $E_3(\\cdot)$ 的线性性质，我们有 $E_3 = A \\cdot E_3(x^6) + B \\cdot E_3(x^7) + C \\cdot E_3(x^8) + D \\cdot E_3(x^9)$。\n\nLGL 网格 $\\{x_j, w_j\\}$ 是对称的。任何奇函数在 $[-1,1]$ 上的积分都为零，并且任何奇函数在对称网格上的 LGL 求积也为零。因此，$E_3(x^7)=0$ 且 $E_3(x^9)=0$。我们只需要计算 $x^6$ 和 $x^8$ 的误差。\n\n对于 $x^6$：\n-   精确积分：$\\int_{-1}^1 x^6 dx = \\frac{x^7}{7}\\Big|_{-1}^1 = \\frac{2}{7}$。\n-   求积：$\\sum_{j=0}^3 w_j x_j^6 = 2w_0(1)^6 + 2w_1(1/\\sqrt{5})^6 = 2(\\frac{1}{6}) + 2(\\frac{5}{6})(\\frac{1}{125}) = \\frac{1}{3} + \\frac{5}{375} = \\frac{1}{3} + \\frac{1}{75} = \\frac{25+1}{75} = \\frac{26}{75}$。\n-   误差 $E_3(x^6) = \\frac{26}{75} - \\frac{2}{7} = \\frac{182 - 150}{525} = \\frac{32}{525}$。\n\n对于 $x^8$：\n-   精确积分：$\\int_{-1}^1 x^8 dx = \\frac{x^9}{9}\\Big|_{-1}^1 = \\frac{2}{9}$。\n-   求积：$\\sum_{j=0}^3 w_j x_j^8 = 2w_0(1)^8 + 2w_1(1/\\sqrt{5})^8 = \\frac{1}{3} + \\frac{5}{3}(\\frac{1}{625}) = \\frac{1}{3} + \\frac{1}{375} = \\frac{125+1}{375} = \\frac{126}{375} = \\frac{42}{125}$。\n-   误差 $E_3(x^8) = \\frac{42}{125} - \\frac{2}{9} = \\frac{378 - 250}{1125} = \\frac{128}{1125}$。\n\n现在，我们合并这些结果：\n$E_3 = A \\cdot E_3(x^6) + C \\cdot E_3(x^8) = A \\left(\\frac{32}{525}\\right) + C \\left(\\frac{128}{1125}\\right)$。\n\n代入 $A$ 和 $C$ 的表达式：\n$A = 3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3$\n$C = 3c_2 c_3^2$\n\n$E_3 = (3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)\\left(\\frac{32}{525}\\right) + (3c_2 c_3^2)\\left(\\frac{128}{1125}\\right)$。\n\n分配各项：\n$E_3 = \\frac{32 \\cdot 3}{525}c_0 c_3^2 + \\frac{32 \\cdot 6}{525}c_1 c_2 c_3 + \\frac{32}{525}c_2^3 + \\frac{128 \\cdot 3}{1125}c_2 c_3^2$。\n\n化简数值系数：\n-   $\\frac{32 \\cdot 3}{525} = \\frac{32}{175}$。\n-   $\\frac{32 \\cdot 6}{525} = \\frac{64 \\cdot 3}{525} = \\frac{64}{175}$。\n-   $\\frac{128 \\cdot 3}{1125} = \\frac{128}{375}$。\n\n混叠误差的最终表达式是：\n$$E_3(c_0, c_1, c_2, c_3) = \\frac{32}{175}c_0 c_3^2 + \\frac{64}{175}c_1 c_2 c_3 + \\frac{32}{525}c_2^3 + \\frac{128}{375}c_2 c_3^2$$", "answer": "$$\\boxed{\\frac{32}{175} c_{0} c_{3}^{2} + \\frac{64}{175} c_{1} c_{2} c_{3} + \\frac{32}{525} c_{2}^{3} + \\frac{128}{375} c_{2} c_{3}^{2}}$$", "id": "3446167"}, {"introduction": "在上一个练习的基础上，本部分将探讨如何主动防止混淆误差，尤其是在涉及复杂几何的实际场景中。单元的曲率（通过映射的雅可比行列式体现）会进一步提高被积项的多项式次数。这项练习 [@problem_id:3446211] 旨在挑战你从仅仅计算误差，转向设计解决方案：推导出一个通用公式，确定在给定的非线性和单元几何下，为保持谱精度所需的最小求积点数（即“超积分”）。", "problem": "考虑一维守恒型偏微分方程 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}u^{2}\\right) = 0$，该方程定义于单个谱元上，其物理坐标 $x$ 通过一个次数为 $r \\geq 2$ 的等参多项式映射 $x(\\xi)$ 从参考坐标 $\\xi \\in [-1,1]$ 获得。假设采用谱元法（SEM）离散，基函数为定义在 Legendre-Gauss-Lobatto 节点上的次数为 $p$ 的 Lagrange 多项式，并令雅可比量 $J(\\xi) = \\frac{dx}{d\\xi}$ 由该映射导出。在 Galerkin 弱形式中，非线性项贡献了形如 $\\int_{-1}^{1} \\phi_{i}(\\xi)\\, u(\\xi)^{2}\\, J(\\xi)\\, d\\xi$ 的积分，其中 $\\phi_{i}(\\xi)$ 是次数为 $p$ 的检验函数。\n\n如果所选的数值求积方法对于被积函数的多项式次数不是精确的，就会产生混叠误差。为了防止混叠并对解析解保持谱精度，我们采用过积分方法：我们使用具有 $N_{q}$ 个点的 Legendre-Gauss-Lobatto 求积法来近似积分，其中 $N_{q}$ 可能超过 $p+1$。一个经过充分检验的事实是，具有 $N_{q}$ 个点的 Legendre-Gauss-Lobatto 求积法对所有次数最高为 $2N_{q}-3$ 的多项式都是精确的。\n\n从这些定义和事实出发，并将“单元曲率”表示为映射次数 $r$ 及其导出的雅可比量 $J(\\xi)$，推导一个预测模型，给出所需的 Legendre-Gauss-Lobatto 求积点的最小数量 $N_{q}^{\\min}(p,r)$，以确保上述涉及二次非线性的内积能够被精确积分，从而消除由非线性和几何映射共同引起的混叠。将您的最终答案表示为关于 $p$ 和 $r$ 的单个闭式解析表达式。不需要数值近似或舍入。", "solution": "该问题要求推导在一个谱元法（SEM）离散化中，为精确积分某个特定积分所需的 Legendre-Gauss-Lobatto (LGL) 求积点的最小数量（记为 $N_{q}^{\\min}$）。其目标是消除在弯曲单元上给定非线性项的混叠误差。\n\n求解过程首先确定指定积分的被积函数的多项式次数，然后应用给定的 LGL 求积法则来找到精确积分所需的最小点数。\n\n所讨论的被积函数为 $f(\\xi) = \\phi_{i}(\\xi)\\, u(\\xi)^{2}\\, J(\\xi)$。为了找到所需的求积点数，我们必须首先确定 $f(\\xi)$ 的最大可能多项式次数。该次数是其各多项式因子次数的总和。\n\n1. **检验函数 $\\phi_{i}(\\xi)$ 的次数**：问题指出，谱元法离散化使用次数为 $p$ 的 Lagrange 多项式基。在 Galerkin 配方中，检验函数 $\\phi_{i}(\\xi)$ 从同一基函数空间中选取。因此，$\\phi_{i}(\\xi)$ 是一个次数为 $p$ 的多项式。\n    $$ \\deg(\\phi_{i}) = p $$\n\n2. **解项 $u(\\xi)^{2}$ 的次数**：数值解 $u(\\xi)$ 被近似为次数为 $p$ 的基函数的线性组合。因此，$u(\\xi)$ 本身是一个次数最多为 $p$ 的多项式。该函数的平方 $u(\\xi)^{2}$ 将是一个次数最多为 $u(\\xi)$ 次数 2 倍的多项式。\n    $$ \\deg(u^{2}) = 2 \\times \\deg(u) = 2p $$\n\n3. **雅可比量 $J(\\xi)$ 的次数**：物理坐标 $x$ 通过一个次数为 $r$ 的多项式映射 $x(\\xi)$ 与参考坐标 $\\xi$ 相关。该变换的雅可比量是此映射的导数，$J(\\xi) = \\frac{dx}{d\\xi}$。求导过程会将多项式的次数降低1。\n    $$ \\deg(J) = \\deg(x) - 1 = r - 1 $$\n\n被积函数 $f(\\xi)$ 的总次数是这三个分量次数的总和：\n$$ \\deg(f) = \\deg(\\phi_{i}) + \\deg(u^{2}) + \\deg(J) $$\n$$ \\deg(f) = p + 2p + (r-1) = 3p + r - 1 $$\n\n现在，我们应用所给出的 LGL 求积法则。该法则指出，具有 $N_{q}$ 个点的 LGL 求积法可以精确地积分任何次数最高为 $2N_{q}-3$ 的多项式。为防止混叠，求积法必须对我们的被积函数 $f(\\xi)$ 精确。这导出以下条件：\n$$ 2N_{q} - 3 \\geq \\deg(f) $$\n代入推导出的被积函数次数，得到不等式：\n$$ 2N_{q} - 3 \\geq 3p + r - 1 $$\n\n现在我们对 $N_{q}$ 求解此不等式，以找到所需的最小点数。\n$$ 2N_{q} \\geq 3p + r - 1 + 3 $$\n$$ 2N_{q} \\geq 3p + r + 2 $$\n$$ N_{q} \\geq \\frac{3p + r + 2}{2} $$\n\n由于求积点数 $N_{q}$ 必须是整数，因此最小点数 $N_{q}^{\\min}(p,r)$ 是大于或等于右侧表达式的最小整数。这由向上取整函数给出。\n$$ N_{q}^{\\min}(p,r) = \\left\\lceil \\frac{3p + r + 2}{2} \\right\\rceil $$\n这个闭式解析表达式给出了精确积分指定的非线性项所需的 LGL 求积点的最小数量，从而消除了由二次非线性和次数为 $r$ 的几何映射共同引起的混叠误差。", "answer": "$$ \\boxed{\\left\\lceil \\frac{3p + r + 2}{2} \\right\\rceil} $$", "id": "3446211"}]}