{"hands_on_practices": [{"introduction": "在对数值格式进行傅里叶分析时，核心步骤是确定离散算子如何影响每个傅里叶模式。这个作用可以被一个称为“傅里叶符号”的复数量化。[@problem_id:3429328] 将指导您为一个四阶中心差分格式推导其傅里叶符号，并分析其在低波数下的行为，这是评估任何有限差分格式准确性的基本技能。", "problem": "考虑一个长度为 $L$ 的一维周期性空间域，以及一个包含 $N$ 个点的均匀网格，网格间距为 $h = L/N$。设 $u_j$ 表示在节点 $x_j = j h$ 上的网格函数，其中 $j = 0, 1, \\dots, N-1$，索引具有周期性。定义线性差分算子 $D$，它通过四阶中心差分格式来近似一阶空间导数\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\n使用离散傅里叶变换 (DFT)，将 $D$ 视为一个位移不变的卷积算子，并将其傅里叶符号 $\\widehat{D}(\\theta)$ 定义为一个复标量，使得对于任何单一傅里叶模式 $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$（其中 $U \\in \\mathbb{C}$，连续波数 $k_c \\in \\mathbb{R}$，且 $\\theta = k_c h$），都有 $(D u)_j = \\widehat{D}(\\theta)\\,u_j$。所有三角函数均以弧度为单位。\n\n从 DFT 的定义和离散帕塞瓦尔恒等式（该恒等式将网格函数的 $\\ell^2$ 能量与其傅里叶系数的模平方和等同起来）出发，推导上述差分格式的傅里叶符号 $\\widehat{D}(\\theta)$ 的显式闭式表达式。然后，求其小 $k$ 展开（即当 $|\\theta|\\ll 1$ 时关于 $\\theta$ 的泰勒级数），并将其与连续微分算子的符号 $i\\,k_c$ 进行比较。具体来说，计算 $\\widehat{D}(\\theta)$ 在 $\\theta = 0$ 附近的级数展开式的前三个非零项，并用 $k_c$ 和 $h$ 表示。解释该展开式所表明的精度阶数。\n\n您的最终答案必须是 $\\widehat{D}(\\theta)$ 的一个单一闭式解析表达式，用 $k_c$ 和 $h$ 表示。不需要四舍五入。", "solution": "我们在周期性网格上进行计算，其中线性、位移不变的差分算子是卷积，并且可以通过离散傅里叶变换 (DFT) 对角化。离散帕塞瓦尔恒等式保证了物理空间中的能量范数对应于傅里叶空间中模态能量的总和，从而可以通过算子的傅里叶符号逐个模态地进行精度和稳定性分析。\n\n设单一傅里叶模式为 $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$，其中 $U \\in \\mathbb{C}$，$k_c \\in \\mathbb{R}$，且 $x_j = j h$。定义 $\\theta = k_c h$，因此 $u_{j+m} = U \\exp\\!\\big(i\\,k_c\\,x_{j+m}\\big) = U \\exp\\!\\big(i\\,k_c\\,(x_j + m h)\\big) = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)\\exp\\!\\big(i\\,m\\theta\\big) = u_j\\,\\exp\\!\\big(i\\,m\\theta\\big)$。\n\n算子 $D$ 由下式给出\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\n代入傅里叶模式并提出公因子 $u_j$ 可得\n\\begin{align*}\n(D u)_j\n= \\frac{1}{12\\,h}\\left(-\\,u_j\\,\\exp(2 i \\theta) \\;+\\; 8\\,u_j\\,\\exp(i \\theta) \\;-\\; 8\\,u_j\\,\\exp(-i \\theta) \\;+\\; u_j\\,\\exp(-2 i \\theta)\\right) \\\\\n= u_j \\cdot \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n\\end{align*}\n根据傅里叶符号的定义，可得\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n$$\n我们使用恒等式 $\\exp(i\\alpha) - \\exp(-i\\alpha) = 2 i \\sin(\\alpha)$ 进行化简：\n\\begin{align*}\n8\\,\\exp(i\\theta) - 8\\,\\exp(-i\\theta) = 16 i \\sin(\\theta), \\\\\n-\\,\\exp(2 i\\theta) + \\exp(-2 i\\theta) = -\\,2 i \\sin(2\\theta).\n\\end{align*}\n因此\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{1}{12\\,h}\\left(16 i \\sin(\\theta) - 2 i \\sin(2\\theta)\\right)\n= \\frac{i}{12\\,h}\\left(16 \\sin(\\theta) - 2 \\sin(2\\theta)\\right) \\\\\n= \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right).\n\\end{align*}\n这就是显式的闭式傅里叶符号。它是一个纯虚数，这与一阶导数的近似是一致的。\n\n为了得到小 $k$ 展开式，我们令 $\\theta = k_c h$ 并对 $|\\theta|\\ll 1$ 的情况展开正弦函数：\n\\begin{align*}\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040} + \\mathcal{O}(\\theta^9), \\\\\n\\sin(2\\theta) = 2\\theta - \\frac{(2\\theta)^3}{6} + \\frac{(2\\theta)^5}{120} - \\frac{(2\\theta)^7}{5040} + \\mathcal{O}(\\theta^9) \\\\\n= 2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\n计算 $8 \\sin(\\theta) - \\sin(2\\theta)$：\n\\begin{align*}\n8 \\sin(\\theta) - \\sin(2\\theta)\n= 8\\left(\\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040}\\right)\n- \\left(2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= (8\\theta - 2\\theta) + \\left(-\\frac{8}{6}\\theta^3 + \\frac{4}{3}\\theta^3\\right) + \\left(\\frac{8}{120}\\theta^5 - \\frac{4}{15}\\theta^5\\right) + \\left(-\\frac{8}{5040}\\theta^7 + \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= 6\\theta + 0\\cdot\\theta^3 - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\n因此，\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{i}{6\\,h}\\left(6\\theta - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9)\\right) \\\\\n= i\\left(\\frac{\\theta}{h} - \\frac{\\theta^5}{30\\,h} + \\frac{\\theta^7}{252\\,h} + \\mathcal{O}\\!\\left(\\frac{\\theta^9}{h}\\right)\\right).\n\\end{align*}\n代入 $\\theta = k_c h$ 可得\n\\begin{align*}\n\\widehat{D}(\\theta)\n= i\\left(k_c - \\frac{k_c^5 h^4}{30} + \\frac{k_c^7 h^6}{252} + \\mathcal{O}\\!\\big(k_c^9 h^8\\big)\\right)\n= i\\,k_c\\left(1 - \\frac{(k_c h)^4}{30} + \\frac{(k_c h)^6}{252} + \\mathcal{O}\\!\\big((k_c h)^8\\big)\\right).\n\\end{align*}\n与连续算子符号 $i\\,k_c$ 相比，主导误差项的阶数为 $(k_c h)^4$，这表明该差分格式对一阶导数的近似具有四阶精度。\n\n因此，显式傅里叶符号为\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right),\n\\quad \\text{with } \\theta = k_c h,\n$$\n其相对于 $i\\,k_c$ 的小 $k$ 展开证实了其四阶精度。", "answer": "$$\\boxed{\\frac{i}{6\\,h}\\left(8\\,\\sin(k_c h)\\;-\\;\\sin(2\\,k_c h)\\right)}$$", "id": "3429328"}, {"introduction": "线性问题的傅里叶分析相对直接，但非线性项（如对流项 $u u_x$）引入了新的复杂性，即混叠效应。在这种情况下，物理空间中的简单相乘对应于傅里叶空间中的离散卷积，这可能导致非物理的能量增长。[@problem_id:3429312] 旨在通过一个具体的例子，揭示混叠如何破坏能量守恒，并向最高频率模式注入虚假能量，这是理解和应用谱方法求解非线性偏微分方程时必须掌握的关键概念。", "problem": "考虑周期性域 $[0,2\\pi]$ 上的无粘性伯格斯方程 $u_t + u u_x = 0$。设 $N$ 为一个正偶数，并定义网格 $x_j = 2\\pi j/N$，其中 $j=0,\\dots,N-1$。将网格函数 $u(x_j)$ 的离散傅里叶变换 (DFT) 表示为 $\\widehat{u}_k = \\frac{1}{N}\\sum_{j=0}^{N-1} u(x_j) e^{-i k x_j}$，其中整数波数 $k$ 在标准范围 $k \\in \\{-N/2, -N/2+1, \\dots, N/2-1\\}$ 内。离散帕塞瓦尔恒等式为 $\\frac{1}{N}\\sum_{j=0}^{N-1} \\overline{f(x_j)}\\, g(x_j) = \\sum_{k} \\overline{\\widehat{f}_k}\\, \\widehat{g}_k$。对于乘积的伪谱计算，物理空间中的乘法对应于傅里叶空间中模 $N$ 的离散卷积：$\\widehat{f g}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{f}_p\\, \\widehat{g}_q$。在解析集上，谱导数定义为 $\\widehat{f_x}[k] = i k \\widehat{f}_k$。\n\n设 $N=12$ 并考虑初始数据\n$$u(x,0) = A \\cos(2 x) + B \\sin(4 x),$$\n其中 $A$ 和 $B$ 是实数振幅。非线性项 $u u_x$ 的一个伪谱格式按以下步骤进行：\n- 计算 $\\widehat{u}_k$，\n- 形成 $\\widehat{u_x}_k = i k \\widehat{u}_k$，\n- 逆变换回物理空间以得到 $u(x_j)$ 和 $u_x(x_j)$，\n- 计算逐点乘积 $u(x_j)\\, u_x(x_j)$，\n- 进行 DFT 以获得 $\\widehat{u u_x}_k$。\n\n不应用去混叠处理。\n\n任务：\n1) 使用上述离散卷积特性，确定哪个解析傅里叶模式接收到来自 $k=2$ 和 $k=4$ 模式相互作用的混叠贡献，并计算该模式下的系数 $\\widehat{u u_x}[k]$ 作为 $A$ 和 $B$ 的函数。\n\n2) 从离散帕塞瓦尔恒等式和守恒形式下连续对流算子的斜伴随性出发，解释为什么通过物理空间乘法和模 $N$ 卷积计算 $u u_x$ 会导致高频模式能量的伪增长，并根据三波相互作用和混叠来识别其机制。\n\n3) 选择正确描述高频模式行为以及与分析一致的补救措施的选项。\n\n选项：\nA. $k=2$ 和 $k=4$ 的未解析相互作用产生一个 $k=6$ 的模式，该模式混叠到奈奎斯特模式 $k=-6$（因为 $6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$），从而得到 $\\widehat{u u_x}[-6] = 3 A B$ 并将能量注入到最高解析模式中。根据离散帕塞瓦尔定理，内积 $\\langle u, u u_x\\rangle_h$ 不为零，因为乘法是通过模 $N$ 卷积计算的，这破坏了斜伴随能量平衡；应用三分之二去混叠规则或在傅里叶空间中计算 $(u^2)_x/2$ 可以恢复能量守恒。\n\nB. 混叠将相互作用发送到 $k=2$，得到 $\\widehat{u u_x}[2] = - A B$，从而将能量转移到低频模式；帕塞瓦尔定理确保了伪谱乘法的能量守恒，而去混叠没有影响。\n\nC. 乘积 $u u_x$ 在 $k=\\pm 6$ 处没有贡献，因为 $k=2$ 和 $k=4$ 都在截断波数以下；因此，在使用不带去混叠的伪谱乘法时，离散能量是自动守恒的。\n\nD. 任何伪高频模式能量的增长都完全是由时间积分器引起的；对于精确的时间积分，伪谱非线性项 $u u_x$ 在没有去混叠的情况下对所有 $N$ 都是能量守恒的。", "solution": "我们首先计算相关的傅里叶系数，并利用伪谱乘法的离散卷积结构。\n\n根据定义，对于 $u(x,0) = A \\cos(2 x) + B \\sin(4 x)$，我们有复傅里叶系数\n$$\\widehat{u}_2 = \\frac{A}{2}, \\quad \\widehat{u}_{-2} = \\frac{A}{2}, \\quad \\widehat{u}_4 = -\\frac{i B}{2}, \\quad \\widehat{u}_{-4} = \\frac{i B}{2},$$\n其他所有系数初始为零。傅里叶空间中的导数为 $\\widehat{u_x}_k = i k \\widehat{u}_k$，所以\n$$\\widehat{u_x}_2 = i \\cdot 2 \\cdot \\frac{A}{2} = i A, \\quad \\widehat{u_x}_{-2} = i \\cdot (-2) \\cdot \\frac{A}{2} = - i A,$$\n$$\\widehat{u_x}_4 = i \\cdot 4 \\cdot \\left(-\\frac{i B}{2}\\right) = 2 B, \\quad \\widehat{u_x}_{-4} = i \\cdot (-4) \\cdot \\left(\\frac{i B}{2}\\right) = 2 B.$$\n\n第1部分：识别混叠模式并计算该模式下的 $\\widehat{u u_x}$。\n\n物理空间中的乘法，然后进行 DFT，对应于模 $N$ 的离散卷积：对于任何 $k$，\n$$\\widehat{u u_x}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{u}_p\\, \\widehat{u_x}_q = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, 12)} \\widehat{u}_p\\, (i q\\, \\widehat{u}_q).$$\n\n我们感兴趣的相互作用是发生在解析的低频模式 $k=2$ 和 $k=4$ 之间。在连续情况下，它们的和产生 $k=6$，这超出了主要的正值范围（当 $N=12$ 时，有 $k \\in \\{-6,-5,\\dots,5\\}$，而奈奎斯特模式 $k=-6$ 是频率 $|k|=6$ 的唯一代表）。在离散的模 $N$ 卷积中，数对 $p=2$ 和 $q=4$ 对解析模式 $k \\equiv 2+4 \\equiv 6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$ 有贡献。同样，$p=4$ 和 $q=2$ 也对 $k \\equiv -6$ 有贡献。负频率数对 $p=-2, q=-4$ 和 $p=-4, q=-2$ 的和也为 $-6$ 而无需环绕。收集所有对 $k=-6$ 的贡献，得到\n\n$$\n\\begin{aligned}\n\\widehat{u u_x}[-6] \n= \\widehat{u}_{-2}\\, \\widehat{u_x}_{-4} + \\widehat{u}_{-4}\\, \\widehat{u_x}_{-2} + \\widehat{u}_{2}\\, \\widehat{u_x}_{4} + \\widehat{u}_{4}\\, \\widehat{u_x}_{2} \\\\\n= \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(\\frac{i B}{2}\\right)\\left(- i A\\right) + \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(-\\frac{i B}{2}\\right)\\left(i A\\right) \\\\\n= A B + \\frac{A B}{2} + A B + \\frac{A B}{2} \\\\\n= 3 A B.\n\\end{aligned}\n$$\n\n因此，混叠贡献出现在奈奎斯特模式 $k=-6$ 处，其值为 $\\widehat{u u_x}[-6] = 3 A B$，这是一个实系数，对应于网格上频率为 $6$ 的余弦函数。在物理空间中，使用三角恒等式，\n\n$$\n\\begin{aligned}\nu_x = -2 A \\sin(2 x) + 4 B \\cos(4 x), \\\\\nu u_x = A \\cos(2 x)\\cdot 4 B \\cos(4 x) + B \\sin(4 x)\\cdot (-2 A) \\sin(2 x) + \\text{(在其他频率上的自相互作用)} \\\\\n= 3 A B \\cos(6 x) + A B \\cos(2 x) + \\text{(在 } k=\\pm 4, \\pm 8 \\text{ 处的项)}.\n\\end{aligned}\n$$\n\n在 $N=12$ 的网格上，$\\cos(6 x_j)$ 正是奈奎斯特模式，并且可以由单个 $k=-6$ 的系数表示，这与 $\\widehat{u u_x}[-6] = 3 A B$ 的结果一致。\n\n第2部分：通过帕塞瓦尔定理和离散卷积产生的伪高频模式能量增长。\n\n在连续问题中，守恒形式的非线性对流项 $\\frac{1}{2}(u^2)_x$ 在周期性域上的 $L^2$ 内积中是斜伴随的，从而得出能量恒等式\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{L^2}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle = -\\frac{1}{2}\\left\\langle u, (u^2)_x \\right\\rangle = 0,$$\n因为 $\\int_0^{2\\pi} u(x) (u^2)_x(x)\\, dx = \\int_0^{2\\pi} \\frac{1}{2} (u^2(x))_x u(x)\\, dx = \\frac{1}{2}\\int_0^{2\\pi} (u^2(x))_x u(x)\\, dx$ 可以化简为一个消失的周期性边界项。在去混叠的谱伽辽金离散化中，同样的相消在离散层面上也成立：将 $(u^2)_x/2$ 投影到解析模式上会保持离散 $L^2$ 能量守恒。\n\n然而，在没有去混叠的伪谱设置中，网格上的逐点乘积 $u u_x$ 在傅里叶空间中对应于模 $N$ 的卷积，这将未解析的和 $p+q$ 折叠回解析集中。负责能量守恒的精巧斜伴随结构被这种折叠所破坏：精确卷积中的三波反对称配对（它会将相互作用发送到 $k=6$，这里在解析集之外）被填充奈奎斯特模式 $k=-6$ 的混叠相互作用所取代。根据离散帕塞瓦尔恒等式，\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{h}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle_h = -\\sum_{k} \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k,$$\n并且模 $N$ 卷积通常会产生 $\\sum_k \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k \\neq 0$，因为 $\\widehat{u u_x}_k$ 包含的混叠贡献不能被 $(u^2)_x/2$ 的守恒投影所平衡。在我们的具体情景中，尽管 $\\widehat{u}_{-6}(0)=0$，但傅里叶空间中的演化方程\n$$\\frac{d}{dt}\\widehat{u}_k = - \\widehat{u u_x}_k,$$\n意味着奈奎斯特模式满足 $\\frac{d}{dt}\\widehat{u}_{-6} = - 3 A B \\neq 0$，因此能量被注入到最高解析模式中。这是伪增长：在真正的伽辽金投影中，$k=2$ 和 $k=4$ 的相互作用只会产生 $k=6$，它位于解析集之外，会被丢弃，而不是被折叠到 $k=-6$ 上。\n\n因此，其机制是伪谱乘积中模 $N$ 卷积下的三波相互作用的离散混叠，加上非线性项离散化中守恒斜对称形式的丧失。补救措施包括：\n- 在乘法之前，通过将超出三分之二规则的模式置零来进行去混叠（或填充到 $3N/2$），这可以防止未解析的和折叠回解析集，以及\n- 以守恒形式计算非线性项，例如，完全在傅里叶空间中通过 $\\frac{1}{2}(u^2)_x$ 计算（或以斜对称分裂形式），这可以恢复离散能量守恒。\n\n第3部分：逐项分析选项。\n\n选项A：它正确地指出，对于 $N=12$，相互作用 $2+4=6$ 混叠到奈奎斯特模式 $k=-6$。计算出的系数 $\\widehat{u u_x}[-6] = 3 A B$ 与上面的卷积计算相匹配。它正确地解释了带有模 $N$ 卷积的离散帕塞瓦尔定理破坏了斜伴随能量平衡，导致能量伪注入到最高模式中，并引用了标准的补救措施（三分之二去混叠规则或守恒的 $(u^2)_x/2$ 计算）。结论：正确。\n\n选项B：它断言混叠将能量发送到 $k=2$，并有 $\\widehat{u u_x}[2] = -A B$，这与卷积分析不符；主要的混叠高频贡献在 $k=-6$ 处，而不是 $k=2$。它还错误地声称帕塞瓦尔定理可以确保在没有去混叠的情况下伪谱乘法的能量守恒；事实上，混叠破坏了能量平衡。结论：错误。\n\n选项C：它声称在 $k=\\pm 6$ 处没有贡献，因为 $2$ 和 $4$ 都在截断波数以下。这忽略了非线性项产生和频率 $6$ 以及它在模 $N$ 卷积下混叠到奈奎斯特模式 $k=-6$ 的事实。它也错误地指出能量是自动守恒的。结论：错误。\n\n选项D：它将伪增长完全归因于时间积分，并声称伪谱 $u u_x$ 在不考虑去混叠的情况下是能量守恒的。这种增长机制甚至在半离散层面（傅里叶系数的常微分方程）就由混叠引起；精确的时间积分并不能消除它。结论：错误。", "answer": "$$\\boxed{A}$$", "id": "3429312"}]}