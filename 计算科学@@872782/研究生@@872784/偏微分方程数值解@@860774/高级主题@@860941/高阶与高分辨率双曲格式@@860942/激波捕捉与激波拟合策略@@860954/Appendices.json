{"hands_on_practices": [{"introduction": "在我们深入研究如何用数值方法“捕捉”激波之前，首先必须理解其解析性质。这个练习 [@problem_id:3442590] 将引导你使用作为双曲理论基石的Rankine–Hugoniot跳跃条件，为伯格斯方程 (Burgers' equation) 推导激波波速。你还将运用Lax熵条件来检验此激波的物理可容许性，从而将其与纯粹的数学构造区分开来。", "problem": "考虑标量守恒律（无粘伯格斯方程），由 $u_{t} + (f(u))_{x} = 0$ 给出，其通量为 $f(u) = \\frac{u^{2}}{2}$。设初始数据为黎曼阶梯，$x  0$ 时 $u(x,0) = u_{L}$，$x > 0$ 时 $u(x,0) = u_{R}$，其中常数状态为 $u_{L} = 2$ 和 $u_{R} = 0$。从包含单个传播间断的移动控制体上的守恒律积分形式出发，推导此黎曼问题的分段常数弱解的物理允许激波速度 $s$ 的跳跃关系。然后，对给定状态计算 $s$，检验凸通量的拉克斯熵条件，其形式为 $f'(u_{L})  s  f'(u_{R})$（对于伯格斯方程，等价于 $u_{L}  u_{R}$），并写出 $t  0$ 时相应的分段弱解 $u(x,t)$，该解包含一个位于 $x = x_{s}(t)$ 的单激波。明确给出激波轨迹 $x_{s}(t)$，并验证您的解在分布意义下满足守恒律，且满足与凸熵-熵通量对相关的熵不等式。最后，简要解释该激波速度如何用于追踪界面 $x_{s}(t)$ 的激波拟合策略中，并将其与激波捕捉格式近似相同解的方式进行对比。\n\n提供激波速度 $s$ 的最终数值答案；无需四舍五入，不涉及物理单位。", "solution": "无粘伯格斯方程是标量守恒律 $u_{t} + (f(u))_{x} = 0$，其中 $f(u) = \\frac{u^{2}}{2}$。给定黎曼数据，$x  0$ 时 $u(x,0) = u_{L}$，$x > 0$ 时 $u(x,0) = u_{R}$，我们寻求一个具有单个间断的弱解，该间断以速度 $s$ 移动，位于 $x = x_{s}(t)$，并分隔开常数状态 $u_{L}$ 和 $u_{R}$。\n\n推导激波速度的基础是守恒律的积分形式。对于一个具有紧支集的光滑检验函数 $\\varphi(x,t)$，弱形式为\n$$\n\\int_{0}^{\\infty} \\int_{-\\infty}^{\\infty} \\left( u \\, \\varphi_{t} + f(u) \\, \\varphi_{x} \\right) \\, \\mathrm{d}x \\, \\mathrm{d}t + \\int_{-\\infty}^{\\infty} u(x,0) \\, \\varphi(x,0) \\, \\mathrm{d}x = 0.\n$$\n或者，考虑一个随激波移动的小控制体，该控制体包围位于 $x = x_{s}(t)$ 的间断，其左右状态为 $u_{L}$ 和 $u_{R}$。在此移动界面上应用守恒律，可得到朗金-雨果尼奥（Rankine–Hugoniot, RH）跳跃条件\n$$\ns \\, [u] = [f(u)],\n$$\n其中 $[u] = u_{R} - u_{L}$ 且 $[f(u)] = f(u_{R}) - f(u_{L})$。该条件可通过将守恒律在一个区间 $(x_{s}(t) - \\epsilon, x_{s}(t) + \\epsilon)$ 上积分并令 $\\epsilon \\to 0$ 得到，或者直接通过对 $u(x,t)$ 采用亥维赛德型拟设从弱形式中得到。\n\n对 RH 条件求解 $s$ 可得\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}.\n$$\n对于伯格斯方程，$f(u) = \\frac{u^{2}}{2}$，所以\n$$\nf(u_{L}) = \\frac{(2)^{2}}{2} = 2, \\quad f(u_{R}) = \\frac{(0)^{2}}{2} = 0.\n$$\n因此，\n$$\ns = \\frac{0 - 2}{0 - 2} = \\frac{-2}{-2} = 1.\n$$\n\n接下来，检验凸通量的拉克斯熵条件。对于具有凸函数 $f$ 的标量守恒律，连接 $u_{L}$到 $u_{R}$ 的激波的拉克斯条件是\n$$\nf'(u_{L})  s  f'(u_{R}).\n$$\n对于伯格斯方程，$f'(u) = u$，因此\n$$\nf'(u_{L}) = 2, \\quad f'(u_{R}) = 0, \\quad s = 1,\n$$\n于是\n$$\n2  1  0,\n$$\n该条件成立。等价地，对于伯格斯方程，激波的容许性条件简化为 $u_{L}  u_{R}$，由于 $2  0$，此条件得到满足。这保证了特征线从两侧汇入激波，确保了熵容许性。\n\n相应的 $t  0$ 的分段弱解是一个位于\n$$\nx_{s}(t) = s \\, t = t,\n$$\n的单激波，其常数状态为\n$$\nu(x,t) = \\begin{cases}\n2,  x  x_{s}(t), \\\\\n0,  x > x_{s}(t).\n\\end{cases}\n$$\n在界面 $x = x_{s}(t)$ 处，$u$ 是不连续的；可以将其从左侧和右侧的迹值定义为 $u_{L}$ 和 $u_{R}$。为验证这是一个弱解，可将此分段常数形式代入弱形式中。在远离激波处，$u$ 是常数，因此 $u_{t} = 0$ 和 $f(u)_{x} = 0$ 逐点成立。激波处的贡献简化为集中在界面上的跳跃测度。弱平衡简化为已经推导出的 RH 条件，该条件由 $s = 1$ 满足，从而证实了分布散度为零。\n\n为了检验与凸熵-熵通量对的熵相容性，考虑标准熵 $\\eta(u) = \\frac{1}{2} u^{2}$ 和熵通量 $q(u) = \\int \\eta'(u) f'(u) \\, \\mathrm{d}u = \\int u \\cdot u \\, \\mathrm{d}u = \\frac{1}{3} u^{3}$。对于以速度 $s$ 移动的激波，一个形式的熵不等式要求\n$$\ns \\, [\\eta(u)] \\geq [q(u)],\n$$\n其中 $[\\eta(u)] = \\eta(u_{R}) - \\eta(u_{L})$ 且 $[q(u)] = q(u_{R}) - q(u_{L})$。计算\n$$\n\\eta(u_{L}) = \\frac{1}{2} (2)^{2} = 2, \\quad \\eta(u_{R}) = \\frac{1}{2} (0)^{2} = 0, \\quad [\\eta(u)] = 0 - 2 = -2,\n$$\n和\n$$\nq(u_{L}) = \\frac{1}{3} (2)^{3} = \\frac{8}{3}, \\quad q(u_{R}) = \\frac{1}{3} (0)^{3} = 0, \\quad [q(u)] = 0 - \\frac{8}{3} = -\\frac{8}{3}.\n$$\n那么\n$$\ns \\, [\\eta(u)] = 1 \\cdot (-2) = -2, \\quad [q(u)] = -\\frac{8}{3},\n$$\n并且确实\n$$\n-2 \\geq -\\frac{8}{3}\n$$\n成立，因为 $-2 = -\\frac{6}{3}$ 且 $-\\frac{6}{3} > -\\frac{8}{3}$ 是正确的。因此，熵不等式得到满足。\n\n关于数值策略，激波拟合格式会明确地将界面 $x_{s}(t)$ 作为计算网格中的移动边界进行追踪。激波速度 $s = 1$ 决定了激波轨迹的常微分方程，\n$$\n\\frac{\\mathrm{d} x_{s}}{\\mathrm{d} t} = s = 1,\n$$\n其中 $x_{s}(0) = 0$，得出 $x_{s}(t) = t$。网格或界面条件会相应更新，以维持跨激波的正确跳跃条件。相比之下，激波捕捉格式（例如带有单调数值通量或总变差不增（TVD）限制器的有限体积法，或人工粘性法）不显式追踪界面；而是依靠离散化机制来稳定和近似间断，将激波弥散在少数几个网格单元上，同时在离散意义下保持正确的 RH 速度和熵容许性。\n\n因此，所求的激波速度为 $s = 1$，拉克斯熵条件得到满足，分段弱解为当 $x  t$ 时左状态 $u = 2$ 和当 $x > t$ 时右状态 $u = 0$，激波位于 $x_{s}(t) = t$。", "answer": "$$\\boxed{1}$$", "id": "3442590"}, {"introduction": "现在，让我们从理论转向实践，通过数值格式来“捕捉”激波。本练习 [@problem_id:3442603] 将应用经典的Godunov有限体积法，该方法利用在单元界面上的局部黎曼问题的精确解来计算数值通量。通过对伯格斯方程进行单个时间步的计算，你将看到守恒原理如何在离散层面上被强制执行，从而正确地传播间断。", "problem": "考虑标量守恒律，即无粘性伯格斯方程 $u_{t}+f(u)_{x}=0$，其通量为 $f(u)=\\frac{1}{2}u^{2}$。一个一阶戈杜诺夫有限体积格式（激波捕捉）通过在单元交界面求解黎曼问题，并使用这些自相似解的精确交界面通量，来演化单元平均值。设空间网格由长度为 $2\\Delta x$ 的周期性区间上的 $2$ 个单元组成，单元交界面位于 $x=-\\Delta x$、$x=0$ 和 $x=\\Delta x$。在时间 $t^{n}$ 时，左侧单元 $[-\\Delta x,0]$ 上的单元平均值为 $\\bar{u}_{0}^{n}=1$，右侧单元 $[0,\\Delta x]$ 上的单元平均值为 $\\bar{u}_{1}^{n}=-1$。使用从伯格斯方程的精确黎曼问题导出的戈杜诺夫通量和基于守恒的有限体积更新方法，计算一个时间步长 $\\Delta t$ 后更新的左侧单元平均值 $\\bar{u}_{0}^{n+1}$，并仅用 $\\Delta t$ 和 $\\Delta x$ 表示。你的最终答案必须是一个单一的闭式解析表达式。不包含任何单位。不要四舍五入。", "solution": "用户希望使用一阶戈杜诺夫有限体积格式，计算一个时间步长后左侧单元更新后的单元平均值 $\\bar{u}_{0}^{n+1}$。\n\n### 步骤 1：提取给定条件\n-   **守恒律**：无粘性伯格斯方程，$u_{t} + f(u)_{x} = 0$。\n-   **通量函数**：$f(u) = \\frac{1}{2}u^{2}$。代表特征速度的通量导数为 $f'(u) = u$。\n-   **数值格式**：一阶戈杜诺夫有限体积格式。\n-   **网格设置**：在长度为 $2\\Delta x$ 的周期性区间上设置一个包含 $2$ 个单元的网格。\n-   **单元定义**：\n    -   左侧单元（单元 $0$）：中心位于区间 $[-\\Delta x, 0]$。宽度为 $\\Delta x$。交界面位于 $x_{-1/2} = -\\Delta x$ 和 $x_{1/2} = 0$。\n    -   右侧单元（单元 $1$）：中心位于区间 $[0, \\Delta x]$。宽度为 $\\Delta x$。交界面位于 $x_{1/2} = 0$ 和 $x_{3/2} = \\Delta x$。\n-   **$t^n$ 时刻的初始条件**：\n    -   左侧单元的单元平均值：$\\bar{u}_{0}^{n} = 1$。\n    -   右侧单元的单元平均值：$\\bar{u}_{1}^{n} = -1$。\n-   **边界条件**：区域是周期性的。这意味着位于 $x = -\\Delta x$ 的左边界与位于 $x = \\Delta x$ 的右边界相连。因此，单元 $0$ 的左邻居是单元 $1$，单元 $1$ 的右邻居是单元 $0$。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题是科学上成立、适定、客观且自洽的。\n-   **科学上成立**：无粘性伯格斯方程是流体动力学和双曲型偏微分方程中的一个基本模型。戈杜诺夫格式是求解此类方程的标准、成熟的数值方法。所有概念都基于已建立的数学和物理原理。\n-   **适定性**：问题定义清晰，给出了具体的偏微分方程、数值格式、网格和初始条件。它要求计算一个特定的量 $\\bar{u}_{0}^{n+1}$，该量可以从给定信息中唯一确定。\n-   **客观性**：语言精确，没有主观或含糊不清的术语。\n-   **完整性**：提供了进行计算所需的所有必要信息（偏微分方程、通量、初始数据、网格、边界条件）。\n\n问题是有效的。\n\n### 步骤 3：求解过程\n\n对于宽度为 $\\Delta x$ 的单元，其单元平均值 $\\bar{u}_i$ 的一阶有限体积更新由守恒律在单元 $[x_{i-1/2}, x_{i+1/2}]$ 上以及时间从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 上积分给出：\n$$ \\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n此处，$F_{i+1/2}$ 和 $F_{i-1/2}$ 分别是单元交界面 $x_{i+1/2}$ 和 $x_{i-1/2}$ 处的数值通量。\n\n我们需要计算左侧单元，即单元 $0$ 更新后的平均值。$\\bar{u}_{0}^{n+1}$ 的计算公式为：\n$$ \\bar{u}_{0}^{n+1} = \\bar{u}_{0}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) $$\n其中 $F_{1/2}$ 是交界面 $x=0$ 处的通量，$F_{-1/2}$ 是交界面 $x=-\\Delta x$ 处的通量。在戈杜诺夫格式中，数值通量 $F_{i+1/2}$ 是通过求解交界面 $x_{i+1/2}$ 处的黎曼问题确定的，其左状态为 $u_L = \\bar{u}_i^n$，右状态为 $u_R = \\bar{u}_{i+1}^n$。然后通量为 $F_{i+1/2} = f(u_{RP}(0))$，其中 $u_{RP}(x/t)$ 是此局部黎曼问题的自相似解在 $x/t = 0$ 处的值。\n\n**1. 计算交界面 $x = 0$ 处的通量 $F_{1/2}$**\n该交界面位于单元 $0$ 和单元 $1$ 之间。$x=0$ 处的黎曼问题具有：\n- 左状态：$u_L = \\bar{u}_{0}^{n} = 1$\n- 右状态：$u_R = \\bar{u}_{1}^{n} = -1$\n\n特征速度为 $f'(u) = u$。因此，$f'(u_L) = 1$ 且 $f'(u_R) = -1$。\n由于 $f'(u_L)  f'(u_R)$，该黎曼问题的解是一个激波。此激波的速度 $s$ 由朗肯-雨贡纽条件给出：\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(-1)^2 - \\frac{1}{2}(1)^2}{-1 - 1} = \\frac{\\frac{1}{2} - \\frac{1}{2}}{-2} = 0 $$\n该激波是静止的，位于交界面 $x=0$ 处。自相似解为，当 $x/t  s = 0$ 时，$u(x/t) = u_L = 1$；当 $x/t > s = 0$ 时，$u(x/t) = u_R = -1$。\n戈杜诺夫通量是在对应于 $x/t=0$ 线的状态下计算的物理通量。由于激波在 $x/t=0$ 处是静止的，通量在激波两侧是连续的。我们可以使用左状态或右状态来计算它：\n$f(u_L) = f(1) = \\frac{1}{2}(1)^2 = \\frac{1}{2}$\n$f(u_R) = f(-1) = \\frac{1}{2}(-1)^2 = \\frac{1}{2}$\n因此，该交界面处的戈杜诺夫通量为：\n$$ F_{1/2} = \\frac{1}{2} $$\n\n**2. 计算交界面 $x = -\\Delta x$ 处的通量 $F_{-1/2}$**\n该交界面位于单元 $0$ 与其左邻居之间。由于周期性边界条件，单元 $0$ 的左邻居是单元 $1$。$x=-\\Delta x$ 处的黎曼问题具有：\n- 左状态：$u_L = \\bar{u}_{1}^{n} = -1$\n- 右状态：$u_R = \\bar{u}_{0}^{n} = 1$\n\n特征速度为 $f'(u_L) = -1$ 且 $f'(u_R) = 1$。\n由于 $f'(u_L)  f'(u_R)$，该黎曼问题的解是一个稀疏波。该波在速度 $f'(u_L)=-1$ 和 $f'(u_R)=1$ 之间呈扇形展开。\n自相似解 $u(x/t)$ 由下式给出：\n$$ u(x/t) = \\begin{cases} -1  \\text{for } x/t  -1 \\\\ x/t  \\text{for } -1 \\leq x/t \\leq 1 \\\\ 1  \\text{for } x/t > 1 \\end{cases} $$\n戈杜诺夫通量是在对应于自相似解的 $x/t=0$ 线的状态下计算的物理通量。对于 $x/t=0$，我们位于稀疏扇内部，状态为 $u=0$。\n那么通量为：\n$$ F_{-1/2} = f(u=0) = \\frac{1}{2}(0)^2 = 0 $$\n\n**3. 更新单元平均值 $\\bar{u}_{0}^{n+1}$**\n现在我们将初始条件和计算出的通量代入单元 $0$ 的有限体积更新公式中：\n$$ \\bar{u}_{0}^{n+1} = \\bar{u}_{0}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) $$\n代入数值 $\\bar{u}_{0}^{n} = 1$、$F_{1/2} = \\frac{1}{2}$ 和 $F_{-1/2} = 0$：\n$$ \\bar{u}_{0}^{n+1} = 1 - \\frac{\\Delta t}{\\Delta x} \\left( \\frac{1}{2} - 0 \\right) $$\n$$ \\bar{u}_{0}^{n+1} = 1 - \\frac{\\Delta t}{2 \\Delta x} $$\n这就是更新后的左侧单元的单元平均值的最终表达式。", "answer": "$$\n\\boxed{1 - \\frac{\\Delta t}{2 \\Delta x}}\n$$", "id": "3442603"}, {"introduction": "现实世界的问题，例如气体动力学中的问题，通常涉及守恒律方程组，其复杂性远超标量的伯格斯方程。最后一个练习 [@problem_id:3442595] 将难度提升至一维欧拉方程 (Euler equations)，并介绍一种强大且广泛应用的激波捕捉工具——Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器。你将为一个对称碰撞问题计算数值通量，从而深入了解这类格式如何处理除激波外的复杂波结构，如接触间断。", "problem": "考虑理想气体的一维可压缩欧拉方程，\n$$\n\\partial_{t} \\mathbf{U} + \\partial_{x} \\mathbf{F}(\\mathbf{U}) = \\mathbf{0},\n$$\n其守恒变量为 $\\mathbf{U} = (\\rho,\\, \\rho u,\\, E)$，通量为 $\\mathbf{F}(\\mathbf{U}) = (\\rho u,\\, \\rho u^{2} + p,\\, u(E+p))$，状态方程为 $p = (\\gamma -1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$，绝热指数为 $\\gamma$。在网格宽度为 $\\Delta x$ 的均匀网格上，一种有限体积法通过以下方式推进网格平均值：\n$$\n\\mathbf{U}_{i}^{n+1} = \\mathbf{U}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\mathbf{F}_{i+\\frac{1}{2}}^{n} - \\mathbf{F}_{i-\\frac{1}{2}}^{n}\\right),\n$$\n其中 $\\mathbf{F}_{i\\pm 1/2}^{n}$ 是在网格交界面处的相容数值通量，通过求解一个局部黎曼问题由左右状态计算得出。\n\n你将使用 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器（一种激波捕捉策略）来计算交界面处的数值通量的质量分量，然后在一个显式时间步长内更新网格平均密度。声速为 $a = \\sqrt{\\gamma p/\\rho}$，且 HLLC 求解器必须使用物理上可容许的信号速度估计。\n\n考虑一个双网格周期性网格，包含网格 $i=0$（左）和 $i=1$（右），每个网格的宽度均为 $\\Delta x$。网格 $i=0$ 和 $i=1$ 之间的交界面具有左状态 $\\mathbf{U}_{L} = (\\rho_{L},\\, \\rho_{L}u_{L},\\, E_{L})$ 和右状态 $\\mathbf{U}_{R} = (\\rho_{R},\\, \\rho_{R}u_{R},\\, E_{R})$，其热力学变量由下式给出：\n$$\n\\gamma = 1.4,\\quad \\rho_{L} = 1.2\\ \\text{kg}\\,\\text{m}^{-3},\\quad u_{L} = 50\\ \\text{m}\\,\\text{s}^{-1},\\quad p_{L} = 1.0\\times 10^{5}\\ \\text{Pa},\n$$\n$$\n\\rho_{R} = 1.2\\ \\text{kg}\\,\\text{m}^{-3},\\quad u_{R} = -50\\ \\text{m}\\,\\text{s}^{-1},\\quad p_{R} = 1.0\\times 10^{5}\\ \\text{Pa},\n$$\n总能量 $E_{L}$ 和 $E_{R}$ 由状态方程设定。网格间距和时间步长为：\n$$\n\\Delta x = 0.10\\ \\text{m},\\qquad \\Delta t = 2.0\\times 10^{-4}\\ \\text{s}.\n$$\n\n任务：\n1. 使用 HLLC 求解器，根据给定的左右状态，计算网格 $i=0$ 和 $i=1$ 之间交界面处的数值质量通量。\n2. 使用周期性边界条件，计算一个时间步后网格 $i=0$ 中更新后的网格平均密度 $\\rho_{0}^{\\,n+1}$。初始状态为 $\\rho_{0}^{\\,n} = \\rho_{L}$，$u_{0}^{\\,n} = u_{L}$，$p_{0}^{\\,n} = p_{L}$，以及类似的 $\\rho_{1}^{\\,n} = \\rho_{R}$，$u_{1}^{\\,n} = u_{R}$，$p_{1}^{\\,n} = p_{R}$。\n\n将你的最终答案表示为一个等于 $\\rho_{0}^{\\,n+1}$ 的单个实数，单位为 $\\text{kg}\\,\\text{m}^{-3}$。无需进行四舍五入；报告计算得出的精确值。", "solution": "问题要求计算在一个时间步后，一个双网格周期性区域中网格 $i=0$ 内更新后的网格平均密度 $\\rho_{0}^{n+1}$。该更新过程由应用于一维欧拉方程的有限体积法控制。\n\n网格 $i$ 中守恒变量矢量 $\\mathbf{U}_{i} = (\\rho_{i}, (\\rho u)_{i}, E_{i})$ 的有限体积更新公式如下：\n$$\n\\mathbf{U}_{i}^{n+1} = \\mathbf{U}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\mathbf{F}_{i+\\frac{1}{2}}^{n} - \\mathbf{F}_{i-\\frac{1}{2}}^{n}\\right)\n$$\n我们关心的是此方程的第一个分量，它描述了网格平均密度 $\\rho_{i}$ 的演化：\n$$\n\\rho_{i}^{n+1} = \\rho_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^{(1), n} - F_{i-\\frac{1}{2}}^{(1), n}\\right)\n$$\n其中 $F^{(1)}$ 是质量通量，即数值通量矢量 $\\mathbf{F}$ 的第一个分量。对于网格 $i=0$，更新方程为：\n$$\n\\rho_{0}^{n+1} = \\rho_{0}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{\\frac{1}{2}}^{(1), n} - F_{-\\frac{1}{2}}^{(1), n}\\right)\n$$\n网格 $0$ 中的初始密度为 $\\rho_{0}^{n} = \\rho_{L} = 1.2\\ \\text{kg}\\,\\text{m}^{-3}$。任务简化为使用 Harten–Lax–van Leer–Contact (HLLC) 近似黎曼求解器计算数值质量通量 $F_{1/2}^{(1),n}$ 和 $F_{-1/2}^{(1),n}$。\n\n通量 $F_{1/2}^{(1),n}$ 位于网格 $i=0$ 和网格 $i=1$ 之间的交界面上。该黎曼问题的左状态是网格 $0$ 中的状态 $\\mathbf{U}_{0}^{n}$，右状态是网格 $1$ 中的状态 $\\mathbf{U}_{1}^{n}$。题目将它们分别定义为 $\\mathbf{U}_{L}$ 和 $\\mathbf{U}_{R}$。\n通量 $F_{-1/2}^{(1),n}$ 位于网格 $i=0$ 左侧的交界面上。由于双网格周期性边界条件，网格 $i=0$ 左侧的网格是 $i=1$。因此，该黎曼问题的左状态是 $\\mathbf{U}_{1}^{n} = \\mathbf{U}_{R}$，右状态是 $\\mathbf{U}_{0}^{n} = \\mathbf{U}_{L}$。\n\n让我们首先计算通量 $F_{1/2}^{(1),n} = F_{\\text{HLLC}}^{(1)}(\\mathbf{U}_{L}, \\mathbf{U}_{R})$。\n\n**1. 初始状态和声速**\n左右状态由下式给出：\n$$\n\\gamma = 1.4,\\quad \\rho_{L} = 1.2,\\quad u_{L} = 50,\\quad p_{L} = 1.0\\times 10^{5}\n$$\n$$\n\\rho_{R} = 1.2,\\quad u_{R} = -50,\\quad p_{R} = 1.0\\times 10^{5}\n$$\n声速为 $a = \\sqrt{\\gamma p/\\rho}$。\n$$\na_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^{5}}{1.2}} = \\sqrt{\\frac{7}{6} \\times 10^5} \\ \\text{m}\\,\\text{s}^{-1}\n$$\n由于 $\\rho_{L} = \\rho_{R}$ 且 $p_{L} = p_{R}$，声速相等：$a_{R} = a_{L}$。我们用 $a$ 表示这个共同的声速。\n\n**2. HLLC 波速估计**\n我们使用 Davis 估计来计算最快的左行和右行信号速度 $S_L$ 和 $S_R$：\n$$\nS_{L} = \\min(u_{L} - a_{L}, u_{R} - a_{R}) = \\min(50 - a, -50 - a) = -50 - a\n$$\n$$\nS_{R} = \\max(u_{L} + a_{L}, u_{R} + a_{R}) = \\max(50 + a, -50 + a) = 50 + a\n$$\n注意到 $S_{R} = -S_{L}$。\n\n**3. HLLC 接触波速度**\nHLLC 求解器中接触间断的速度 $S_*$ 由下式给出：\n$$\nS_{*} = \\frac{p_{R} - p_{L} + \\rho_{L} u_{L}(S_{L} - u_{L}) - \\rho_{R} u_{R}(S_{R} - u_{R})}{\\rho_{L}(S_{L} - u_{L}) - \\rho_{R}(S_{R} - u_{R})}\n$$\n代入给定值和关系式：$p_{L}=p_{R}$，$\\rho_{L}=\\rho_{R}$，$u_{R}=-u_{L}$，$S_{L} = -u_{L}-a$ 以及 $S_{R} = u_{L}+a$：\n分子为：\n$0 + \\rho_{L} u_{L}((-u_{L}-a) - u_{L}) - \\rho_{L} (-u_{L})((u_{L}+a) - (-u_{L}))$\n$= \\rho_{L} u_{L}(-2u_{L}-a) + \\rho_{L} u_{L}(2u_{L}+a)$\n$= \\rho_{L} u_{L}(-2u_{L}-a + 2u_{L}+a) = 0$\n由于分母非零，接触速度为 $S_*=0$。\n\n**4. HLLC 数值质量通量**\nHLLC 数值通量 $\\mathbf{F}_{\\text{HLLC}}$ 的选择取决于 $x/t=0$ 轴相对于波速 $S_L$、$S_*$ 和 $S_R$ 的位置。\n由于 $u_L0$ 且 $a0$，我们有 $S_L = -50-a  0$ 和 $S_R = 50+a  0$。并且 $S_*=0$。\n情况属于 $S_L \\le 0 \\le S_R$。通量由“星区”状态决定。由于 $S_*=0$，轴线 $x/t=0$ 位于接触间断上。\nHLLC通量公式规定，如果 $S_L \\le 0 \\le S_*$，通量为 $\\mathbf{F}_L^*$；如果 $S_* \\le 0 \\le S_R$，通量为 $\\mathbf{F}_R^*$。在 $S_* = 0$ 的情况下，这两个通量在接触面上是相等的。星区质量通量为 $F_K^{*(1)} = S_* \\rho_K^*$，其中 $\\rho_K^*$ 是星区密度。由于 $S_*=0$，穿过交界面的数值质量通量为：\n$$\nF_{1/2}^{(1),n} = F_{\\text{HLLC}}^{(1)}(\\mathbf{U}_{L}, \\mathbf{U}_{R}) = 0\n$$\n这个结果在物理上是直观的：初始条件是对称的，表示两团气体相向移动。这会在交界面处产生一个静止的接触间断，没有质量流穿过该间断。\n\n**5. 交界面 $i=-1/2$ 处的通量**\n接下来，我们计算通量 $F_{-1/2}^{(1),n} = F_{\\text{HLLC}}^{(1)}(\\mathbf{U}_{R}, \\mathbf{U}_{L})$。左右状态被交换了。我们用上标 ' 来表示这个问题的状态：$\\mathbf{U}'_{L} = \\mathbf{U}_{R}$ 和 $\\mathbf{U}'_{R} = \\mathbf{U}_{L}$。\n物理参数是对称的：$\\rho'_{L}=\\rho_{R}=\\rho_{L}=\\rho'_{R}$，$p'_{L}=p_{R}=p_{L}=p'_{R}$。速度是反对称的：$u'_{L}=u_{R}=-u_{L}=-u'_{R}$。\n整个问题设置与第一个相同，只是在空间上进行了反射。同样的逻辑适用，得到声速 $a'_{L}=a'_{R}=a$，波速估计 $S'_{L} = S_L$ 和 $S'_{R}=S_R$，以及接触速度 $S'_* = 0$。\n因此，该交界面处的质量通量也为零：\n$$\nF_{-1/2}^{(1),n} = 0\n$$\n\n**6. 更新网格 $i=0$ 中的密度**\n最后，我们将计算出的通量代回网格 $i=0$ 的密度更新方程中：\n$$\n\\rho_{0}^{n+1} = \\rho_{0}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{\\frac{1}{2}}^{(1), n} - F_{-\\frac{1}{2}}^{(1), n}\\right)\n$$\n$$\n\\rho_{0}^{n+1} = \\rho_{0}^{n} - \\frac{2.0\\times 10^{-4}}{0.10} \\left(0 - 0\\right)\n$$\n$$\n\\rho_{0}^{n+1} = \\rho_{0}^{n}\n$$\n网格 $0$ 中的初始密度为 $\\rho_{0}^{n} = \\rho_{L} = 1.2\\ \\text{kg}\\,\\text{m}^{-3}$。\n因此，更新后的密度为：\n$$\n\\rho_{0}^{n+1} = 1.2\\ \\text{kg}\\,\\text{m}^{-3}\n$$\n任务的第一部分，计算交界面处的数值质量通量，结果为 $0\\ \\text{kg}\\,\\text{m}^{-2}\\text{s}^{-1}$。第二部分，计算更新后的密度，结果为 $1.2\\ \\text{kg}\\,\\text{m}^{-3}$。所要求的最终答案是后者。", "answer": "$$\\boxed{1.2}$$", "id": "3442595"}]}