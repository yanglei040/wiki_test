{"hands_on_practices": [{"introduction": "在分析数值格式如何影响总变差之前，我们必须能够精确地计算它。第一个练习 [@problem_id:3422971] 通过引导我们计算一个简单但基础的情形——分段常数函数的总变差，来巩固我们的理解。这个实践将总变差 ($TV$) 的形式化数学定义与更直观的概念——即对不连续处的绝对跳跃求和——联系起来，这是分析数值模拟离散数据的基础。", "problem": "考虑一个在有限区间 $[a,b]$ 上定义的分段常数函数 $u(x)$。该函数在剖分 $a=x_0 < x_1 < \\dots < x_N=b$ 上取值，使得当 $x \\in (x_{j-1}, x_j]$ 时，$u(x)=u_j$ 对 $j=1, \\dots, N$ 成立，并且 $u(a)=u_1$。计算该函数在 $[a,b]$ 上的总变差。", "solution": "问题在于计算给定分段常数函数 $u(x)$ 在区间 $[a,b]$ 上的全变差。该问题是良构的，并包含了严格求解所需的所有信息。我们将首先为全变差建立一个上界，然后证明该上界是可达到的，从而证明它就是上确界。\n\n问题将函数 $u:[a,b]\\to\\mathbb{R}$ 定义为 $u(x)=\\sum_{j=1}^{N}u_{j}\\,\\chi_{I_{j}}(x)$，其中 $I_{j}=(x_{j-1},x_{j}]$，并附加条件 $u(x_0)=u_1$，其中 $a=x_0<x_1<\\dots<x_N=b$。根据总变差的定义，\n$$\nTV(u) = \\sup \\left\\{ \\sum_{k=0}^{m-1} |u(y_{k+1}) - u(y_k)| : a=y_0 < y_1 < \\dots < y_m=b, \\; m \\in \\mathbb{N} \\right\\}\n$$\n我们考虑一个任意的剖分 $P = \\{y_k\\}_{k=0}^m$。函数 $u(x)$ 仅在点 $x_1, \\dots, x_{N-1}$ 处不连续。\n求和 $\\sum_{k=0}^{m-1} |u(y_{k+1}) - u(y_k)|$ 可以被 $u$ 的值域范围所限制，但更精确的上界是所有可能跳跃的总和。考虑一个包含所有不连续点 $x_j$ 的精细剖分。例如，我们选择一个剖分 $P^*$，它包含所有的 $x_j$ 以及每个区间 $(x_{j-1}, x_j)$ 中间的点。具体来说，令 $P^* = \\{x_0, x_1-\\epsilon, x_1, \\dots, x_{N-1}-\\epsilon, x_{N-1}, x_N-\\epsilon, x_N\\}$，其中 $\\epsilon$ 是一个很小的正数。对于这个剖分，我们计算和值：\n$$\n\\sum |u(y_{k+1}) - u(y_k)| = |u(x_1-\\epsilon) - u(x_0)| + |u(x_1) - u(x_1-\\epsilon)| + \\dots\n$$\n由于在每个子区间 $(x_{j-1}, x_j)$ 内 $u(x)$ 是常数，因此只要 $y_k$ 和 $y_{k+1}$ 都在同一个开区间 $(x_{j-1}, x_j)$ 内，那么 $|u(y_{k+1})-u(y_k)| = 0$。因此，只有跨越不连续点 $x_j$ 的项才对和有贡献。\n当剖分点 $y_k, y_{k+1}$ 跨越一个不连续点 $x_j$ 时，即 $y_k \\le x_j  y_{k+1}$，则 $u(y_k)$ 的值接近 $u_j$，而 $u(y_{k+1})$ 的值接近 $u_{j+1}$。该项的贡献近似为 $|u_{j+1} - u_j|$。\n通过三角不等式，对于任何剖分 $P$，其和值都不会超过在不连续点处跳跃的总和：\n$$\n\\sum_{k=0}^{m-1} |u(y_{k+1}) - u(y_k)| \\le \\sum_{j=1}^{N-1} |u_{j+1} - u_j|\n$$\n这个上界是可以达到的。考虑一个剖分，它在每个不连续点 $x_j$ 的两侧都取点，例如 $y_{2j} = x_j - \\epsilon$ 和 $y_{2j+1} = x_j + \\epsilon$（对于 $j=1,\\dots,N-1$）。当我们让 $\\epsilon \\to 0$ 时，这个剖分上的和会收敛到 $\\sum_{j=1}^{N-1} |u(x_j+\\epsilon) - u(x_j-\\epsilon)| = \\sum_{j=1}^{N-1} |u_{j+1} - u_j|$。\n因此，这个和是所有剖分和的上确界，即总变差。", "answer": "$$\\boxed{\\sum_{j=1}^{N-1} |u_{j+1} - u_j|}$$", "id": "3422971"}, {"introduction": "一个常见的误解是，将一个总变差递减 ($TVD$) 的时间积分器与任何空间算子结合，都会得到一个 $TVD$ 格式。这个解析练习 [@problem_id:3422974] 直接挑战了这一观点。通过将一个 $TVD-RK3$ 时间步进方法应用于一个非 $TVD$ 的中心差分空间离散化，我们将明确计算总变差的变化，并证明它可能会增加，从而违反 $TVD$ 性质。这个关键的例子突显出，要获得无振荡的结果，空间算子的性质与时间积分器的性质同等重要。", "problem": "考虑标量守恒律 $u_{t} + f(u)_{x} = 0$，其中通量为凸函数 $f(u) = \\frac{u^{2}}{2}$，定义在一个具有四个点（索引为 $i \\in \\{0,1,2,3\\}$）的均匀周期性网格上，网格间距为 $\\Delta x = 1$。设半离散空间算子为中心差分守恒近似\n$$\nL(u)_{i} \\equiv -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x},\n$$\n其中索引是周期性的。使用三阶总变差递减龙格—库塔（TVD-RK3）方法向前推进一个时间步长 $\\Delta t  0$，该方法由以下三阶段更新定义\n$$\nu^{(1)} = u^{n} + \\Delta t\\, L(u^{n}), \\quad\nu^{(2)} = \\frac{3}{4} u^{n} + \\frac{1}{4}\\Big(u^{(1)} + \\Delta t\\, L(u^{(1)})\\Big), \\quad\nu^{n+1} = \\frac{1}{3} u^{n} + \\frac{2}{3}\\Big(u^{(2)} + \\Delta t\\, L(u^{(2)})\\Big).\n$$\n此处 $u^{n}$ 表示在时间层 $n$ 的数值解向量。设初始数据为 $u^{n} = (u^{n}_{0},u^{n}_{1},u^{n}_{2},u^{n}_{3}) = (0,a,0,0)$，其中 $a  0$。离散总变差定义为\n$$\n\\mathrm{TV}(u) \\equiv \\sum_{i=0}^{3} \\big|u_{i+1} - u_{i}\\big|,\n$$\n其中索引是周期性的，因此 $u_{4} \\equiv u_{0}$。仅使用上述定义和格式规范，对中心空间算子执行单个 TVD-RK3 步骤，并确定总变差增量 $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$ 作为 $a$ 和 $\\Delta t$ 的函数的确切表达式，假设 $0  \\Delta t  \\frac{4}{a}$，这样在计算总变差时出现的所有绝对值都可以无符号歧义地进行评估。你的最终答案必须是 $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$ 的封闭形式解析表达式。不需要四舍五入。", "solution": "用户希望使用特定的数值格式，求出一个时间步长后总变差的增量。\n\n### 第一步：提取已知条件\n-   **方程**：标量守恒律 $u_{t} + f(u)_{x} = 0$。\n-   **通量函数**：$f(u) = \\frac{u^{2}}{2}$。这是一个凸函数。\n-   **网格**：具有四个点的均匀周期性网格，索引为 $i \\in \\{0,1,2,3\\}$。\n-   **网格间距**：$\\Delta x = 1$。\n-   **空间算子**：一个半离散中心差分守恒近似，由 $L(u)_{i} \\equiv -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x}$ 给出。周期性意味着 $u_{i+4} = u_i$ 和 $u_{i-4} = u_i$。\n-   **时间步进方法**：三阶总变差递减龙格—库塔（TVD-RK3）方法：\n    $$\n    u^{(1)} = u^{n} + \\Delta t\\, L(u^{n})\n    $$\n    $$\n    u^{(2)} = \\frac{3}{4} u^{n} + \\frac{1}{4}\\Big(u^{(1)} + \\Delta t\\, L(u^{(1)})\\Big)\n    $$\n    $$\n    u^{n+1} = \\frac{1}{3} u^{n} + \\frac{2}{3}\\Big(u^{(2)} + \\Delta t\\, L(u^{(2)})\\Big)\n    $$\n-   **初始数据**：$u^{n} = (u^{n}_{0}, u^{n}_{1}, u^{n}_{2}, u^{n}_{3}) = (0, a, 0, 0)$，其中 $a  0$。\n-   **总变差定义**：$\\mathrm{TV}(u) \\equiv \\sum_{i=0}^{3} \\big|u_{i+1} - u_{i}\\big|$，具有周期性索引（$u_4 \\equiv u_0$）。\n-   **约束条件**：$0  \\Delta t  \\frac{4}{a}$。\n-   **目标**：求出 $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$ 作为 $a$ 和 $\\Delta t$ 的函数的确切表达式。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学或事实不健全性**：该问题在科学上是健全的。它描述了一个针对著名偏微分方程（伯格斯方程）的标准数值实验，使用了标准的数值方法（中心差分，TVD-RK3）。\n2.  **不可形式化或不相关**：该问题是完全可形式化的，并且与偏微分方程的数值方法主题直接相关，特别是关于总变差的部分。\n3.  **不完整或矛盾的设置**：问题被完全指定。所有必需的定义、初始数据和方法都已提供。\n4.  **不切实际或不可行**：该设置是一个标准的、可行的计算问题。所提供的关于 $\\Delta t$ 的约束在物理上和数学上都是合理的。\n5.  **不适定或结构不良**：该问题是适定的。计算序列是确定性的，并导向一个唯一的解析结果。\n6.  **伪深刻、琐碎或同义反复**：该问题是一个非琐碎的直接计算，旨在检验对数值格式的理解。其目的是展示一种数值方法的一个关键属性（或其缺失），这是一种标准的教学方法。\n\n### 第三步：结论和行动\n问题有效。将提供详细的解决方案。\n\n### 解决方案\n\n求解过程首先计算初始总变差，然后执行TVD-RK3方法的三个阶段以找到下一个时间层的解 $u^{n+1}$，最后计算新的总变差和增量。\n\n**1. 初始总变差, $\\mathrm{TV}(u^{n})$**\n初始数据是向量 $u^{n} = (0, a, 0, 0)$。总变差定义为 $\\mathrm{TV}(u) = \\sum_{i=0}^{3} |u_{i+1} - u_{i}|$，其中索引是周期性的，$u_4 = u_0$。\n$$\n\\mathrm{TV}(u^n) = |u^n_1 - u^n_0| + |u^n_2 - u^n_1| + |u^n_3 - u^n_2| + |u^n_0 - u^n_3|\n$$\n代入 $u^n$ 的值：\n$$\n\\mathrm{TV}(u^n) = |a - 0| + |0 - a| + |0 - 0| + |0 - 0| = |a| + |-a|\n$$\n因为 $a  0$，这可以简化为：\n$$\n\\mathrm{TV}(u^n) = a + a = 2a\n$$\n\n**2. TVD-RK3 时间步**\n空间算子在 $f(u) = \\frac{u^2}{2}$ 和 $\\Delta x = 1$ 条件下为：\n$$\nL(u)_i = -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x} = -\\frac{\\frac{1}{2}u_{i+1}^2 - \\frac{1}{2}u_{i-1}^2}{2} = -\\frac{u_{i+1}^2 - u_{i-1}^2}{4}\n$$\n索引按模4计算。\n\n**阶段 (i): 计算 $L(u^n)$ 和 $u^{(1)}$**\n首先，我们计算向量 $L(u^n)$：\n$$\nL(u^n)_0 = -\\frac{(u^n_1)^2 - (u^n_3)^2}{4} = -\\frac{a^2 - 0^2}{4} = -\\frac{a^2}{4}\n$$\n$$\nL(u^n)_1 = -\\frac{(u^n_2)^2 - (u^n_0)^2}{4} = -\\frac{0^2 - 0^2}{4} = 0\n$$\n$$\nL(u^n)_2 = -\\frac{(u^n_3)^2 - (u^n_1)^2}{4} = -\\frac{0^2 - a^2}{4} = \\frac{a^2}{4}\n$$\n$$\nL(u^n)_3 = -\\frac{(u^n_0)^2 - (u^n_2)^2}{4} = -\\frac{0^2 - 0^2}{4} = 0\n$$\n所以，$L(u^n) = (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0)$。\n现在，计算 $u^{(1)}$：\n$$\nu^{(1)} = u^n + \\Delta t L(u^n) = (0, a, 0, 0) + \\Delta t (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0) = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)\n$$\n\n**阶段 (ii): 计算 $L(u^{(1)})$ 和 $u^{(2)}$**\n接下来，我们使用 $u^{(1)} = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)$ 计算 $L(u^{(1)})$：\n$$\nL(u^{(1)})_0 = -\\frac{(u^{(1)}_1)^2 - (u^{(1)}_3)^2}{4} = -\\frac{a^2 - 0^2}{4} = -\\frac{a^2}{4}\n$$\n$$\nL(u^{(1)})_1 = -\\frac{(u^{(1)}_2)^2 - (u^{(1)}_0)^2}{4} = -\\frac{(\\frac{a^2 \\Delta t}{4})^2 - (-\\frac{a^2 \\Delta t}{4})^2}{4} = 0\n$$\n$$\nL(u^{(1)})_2 = -\\frac{(u^{(1)}_3)^2 - (u^{(1)}_1)^2}{4} = -\\frac{0^2 - a^2}{4} = \\frac{a^2}{4}\n$$\n$$\nL(u^{(1)})_3 = -\\frac{(u^{(1)}_0)^2 - (u^{(1)}_2)^2}{4} = -\\frac{(-\\frac{a^2 \\Delta t}{4})^2 - (\\frac{a^2 \\Delta t}{4})^2}{4} = 0\n$$\n一个关键的观察是，由于 $u^{(1)}$ 中生成值的对称性，$L(u^{(1)}) = L(u^n)$。\n现在，计算 $u^{(2)}$：\n$$\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4}(u^{(1)} + \\Delta t L(u^{(1)})) = \\frac{3}{4} u^n + \\frac{1}{4}( (u^n + \\Delta t L(u^n)) + \\Delta t L(u^n) )\n$$\n$$\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4} u^n + \\frac{1}{4}(2 \\Delta t L(u^n)) = u^n + \\frac{1}{2} \\Delta t L(u^n)\n$$\n代入向量：\n$$\nu^{(2)} = (0, a, 0, 0) + \\frac{\\Delta t}{2} (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0) = (-\\frac{a^2 \\Delta t}{8}, a, \\frac{a^2 \\Delta t}{8}, 0)\n$$\n\n**阶段 (iii): 计算 $L(u^{(2)})$ 和 $u^{n+1}$**\n向量 $u^{(2)}$ 具有与 $u^{(1)}$ 相同的对称结构，形式为 $(-c, a, c, 0)$。如同 $L(u^{(1)})$ 所示，这种对称性意味着 $L(u^{(2)}) = L(u^n)$。\n现在，计算最终状态 $u^{n+1}$：\n$$\nu^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}(u^{(2)} + \\Delta t L(u^{(2)})) = \\frac{1}{3} u^n + \\frac{2}{3}( (u^n + \\frac{1}{2}\\Delta t L(u^n)) + \\Delta t L(u^n) )\n$$\n$$\nu^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}(u^n + \\frac{3}{2}\\Delta t L(u^n)) = \\frac{1}{3} u^n + \\frac{2}{3} u^n + \\Delta t L(u^n) = u^n + \\Delta t L(u^n)\n$$\n这表明对于这个特定问题，$u^{n+1} = u^{(1)}$。\n$$\nu^{n+1} = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)\n$$\n\n**3. 最终总变差, $\\mathrm{TV}(u^{n+1})$**\n我们计算 $u^{n+1} = (u^{n+1}_0, u^{n+1}_1, u^{n+1}_2, u^{n+1}_3)$ 的总变差：\n$$\n\\mathrm{TV}(u^{n+1}) = |u^{n+1}_1 - u^{n+1}_0| + |u^{n+1}_2 - u^{n+1}_1| + |u^{n+1}_3 - u^{n+1}_2| + |u^{n+1}_0 - u^{n+1}_3|\n$$\n我们来评估每一项：\n-   $|u^{n+1}_1 - u^{n+1}_0| = |a - (-\\frac{a^2 \\Delta t}{4})| = |a + \\frac{a^2 \\Delta t}{4}|$。因为 $a0, \\Delta t0$，这一项是 $a + \\frac{a^2 \\Delta t}{4}$。\n-   $|u^{n+1}_2 - u^{n+1}_1| = |\\frac{a^2 \\Delta t}{4} - a|$。问题提供了约束 $0  \\Delta t  \\frac{4}{a}$，这意味着 $a \\Delta t  4$，或 $\\frac{a \\Delta t}{4}  1$。由于 $a0$，我们可以乘以 $a$ 得到 $\\frac{a^2 \\Delta t}{4}  a$。因此，绝对值内的参数为负。因此，$|\\frac{a^2 \\Delta t}{4} - a| = -( \\frac{a^2 \\Delta t}{4} - a ) = a - \\frac{a^2 \\Delta t}{4}$。\n-   $|u^{n+1}_3 - u^{n+1}_2| = |0 - \\frac{a^2 \\Delta t}{4}| = |-\\frac{a^2 \\Delta t}{4}| = \\frac{a^2 \\Delta t}{4}$。\n-   $|u^{n+1}_0 - u^{n+1}_3| = |-\\frac{a^2 \\Delta t}{4} - 0| = |-\\frac{a^2 \\Delta t}{4}| = \\frac{a^2 \\Delta t}{4}$。\n\n将各项相加得到 $\\mathrm{TV}(u^{n+1})$：\n$$\n\\mathrm{TV}(u^{n+1}) = \\left(a + \\frac{a^2 \\Delta t}{4}\\right) + \\left(a - \\frac{a^2 \\Delta t}{4}\\right) + \\frac{a^2 \\Delta t}{4} + \\frac{a^2 \\Delta t}{4}\n$$\n$$\n\\mathrm{TV}(u^{n+1}) = 2a + \\frac{2 a^2 \\Delta t}{4} = 2a + \\frac{a^2 \\Delta t}{2}\n$$\n\n**4. 总变差增量**\n总变差增量是最终总变差与初始总变差之差：\n$$\n\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^n) = \\left(2a + \\frac{a^2 \\Delta t}{2}\\right) - 2a = \\frac{a^2 \\Delta t}{2}\n$$\n这个正增量证实了中心差分格式不是总变差递减的（TVD），因为它会产生新的振荡并增加总变差。", "answer": "$$\\boxed{\\frac{a^{2} \\Delta t}{2}}$$", "id": "3422974"}, {"introduction": "在先前解析示例的基础上，这个计算实践 [@problem_id:3422960] 深入探讨了所谓的“$TVD$” Runge-Kutta 方法的实际行为，这些方法更准确地称为强稳定性保持 ($SSP$) 方法。我们将实现一个数值实验，观察当与一个非 $TVD$ 空间算子耦合时，在 $SSP-RK3$ 的每个子阶段总变差的变化。这个练习将揭示 $SSP$ 格式的一个微妙但关键的方面：即使单个阶段可能会增加总变差，在特定条件下，完整的步骤仍然可以是总变差递减的，从而将看似矛盾的行为与凸组合的底层理论协调起来。", "problem": "考虑在周期性空间域 $[0,1]$ 上的标量线性平流偏微分方程 (PDE) $u_t + a u_x = 0$，其中 $a \\in \\mathbb{R}$ 是恒定的平流速度。设初始条件为一个受高频正弦波扰动的分段常数跳跃，\n$$\nu(x,0) = \\chi_{[0,1/2)}(x) + \\epsilon \\sin(2\\pi m x),\n$$\n其中 $\\chi_{[0,1/2)}$ 表示区间 $[0,1/2)$ 的指示函数，$\\epsilon \\in \\mathbb{R}$ 是一个小振幅，而 $m \\in \\mathbb{N}$ 是模数。\n\n我们在具有 $N$ 个点、网格间距 $\\Delta x = 1/N$ 和周期性边界条件的均匀网格上对空间进行离散化。使用非全变差递减 (non-Total Variation Diminishing, non-TVD) 的二阶中心差分空间算子，\n$$\n(D_{\\text{cen}} u)_i = \\frac{u_{i+1} - u_{i-1}}{2\\Delta x},\n$$\n并定义半离散算子\n$$\nL(u) = -a D_{\\text{cen}} u.\n$$\n使用规范的强稳定性保持 (Strong-Stability-Preserving, SSP) 三阶 Runge–Kutta 时间积分器（在文献中常被称为 TVD-RK3）向前推进一个时间步，时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 数 $c = a\\Delta t/\\Delta x$ 决定。对于这单个完整步，计算数值解在初始状态以及在三个 Runge–Kutta 内部阶段中每一个阶段的全变差 (Total Variation, TV)。此处，离散全变差定义为\n$$\n\\operatorname{TV}(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_i|,\n$$\n其中使用周期性索引 $u_N \\equiv u_0$。\n\n你的任务是实现一个程序，该程序针对指定的参数执行以下操作：\n- 在均匀网格上构建初始数据。\n- 对半离散系统 $u_t = L(u)$ 应用 SSP 三阶 Runge–Kutta 方法的一个完整步，使用非 TVD 中心差分算子。\n- 计算初始状态和每个 Runge–Kutta 子阶段的离散全变差 $\\operatorname{TV}$。\n- 报告第一个子阶段的 TV 是否相对于初始 TV 增加，以及整个完整步的 TV 是否相对于初始 TV 减小。\n\n为探究该行为并与强稳定性保持凸组合理论进行调和，请使用以下参数值测试套件：\n- 测试用例 $1$ (旨在显示第一阶段 TV 增加和完整步 TV 减少的一般情况): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=0.8$.\n- 测试用例 $2$ (小时间步边界行为): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=0.2$.\n- 测试用例 $3$ (大时间步边缘行为): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=2.5$.\n\n无需物理单位，因为所有量都是无量纲的。三角函数中使用的角度以弧度为单位。\n\n对于每个测试用例，你的程序必须生成一个包含以下内容的列表：\n- 四个浮点值 $[\\operatorname{TV}(u^0), \\operatorname{TV}(u^{(1)}), \\operatorname{TV}(u^{(2)}), \\operatorname{TV}(u^{(3)})]$，其中 $u^0$ 是初始状态，$u^{(k)}$ 表示第 k 个 Runge–Kutta 阶段，而 $u^{(3)}$ 是完整步的结果。\n- 两个布尔值：第一个指示 $\\operatorname{TV}(u^{(1)})  \\operatorname{TV}(u^0)$ 是否成立，第二个指示 $\\operatorname{TV}(u^{(3)})  \\operatorname{TV}(u^0)$ 是否成立。\n\n你的程序应生成单行输出，其中包含三个测试用例结果的逗号分隔列表，并用方括号括起来。每个测试用例的结果都由一个如上所述的列表表示。例如，输出格式必须为\n$$\n[\\,[tv0_1,tv1_1,tv2_1,tv3_1,\\text{bool\\_inc\\_stage1\\_1},\\text{bool\\_overall\\_dec\\_1}],\\,[tv0_2,tv1_2,tv2_2,tv3_2,\\text{bool\\_inc\\_stage1\\_2},\\text{bool\\_overall\\_dec\\_2}],\\,[tv0_3,tv1_3,tv2_3,tv3_3,\\text{bool\\_inc\\_stage1\\_3},\\text{bool\\_overall\\_dec\\_3}]\\,].\n$$\n所有数字和布尔值都应直接打印，不带任何附加文本。", "solution": "用户提供的问题经评估有效。它在偏微分方程数值分析领域具有科学依据，内容自洽且适定。所有的定义、参数和目标都陈述得清晰明确。该问题构成了一个标准且富有洞察力的数值实验，用于探究强稳定性保持 (SSP) 时间积分器与非全变差递减 (non-TVD) 的空间算子耦合时的行为。\n\n核心任务是在周期性域 $[0,1]$ 上对标量线性平流方程 $u_t + a\\,u_x = 0$ 进行数值模拟。解的演化将根据其离散全变差 (TV) 进行分析。\n\n首先，我们建立离散问题的设置。空间域 $[0,1]$ 被离散化为一个包含 $N$ 个点的均匀网格，$x_i = i\\,\\Delta x$，$i = 0, 1, \\dots, N-1$，其中网格间距为 $\\Delta x = 1/N$。我们遵守周期性边界条件，这意味着索引 $i$ 处的量与 $i \\pm N$ 处的量循环相关。初始条件 $u(x,0) = \\chi_{[0,1/2)}(x) + \\epsilon \\sin(2\\pi m x)$ 在这些网格点上被求值，以构建初始离散解向量 $u^0$。在每个网格点 $x_i$ 上，其值为 $(u^0)_i = u(x_i, 0)$。指示函数 $\\chi_{[0,1/2)}(x_i)$ 在 $x_i  0.5$ 时为 $1$，否则为 $0$。\n\n将 PDE 重写为 $u_t = -a\\,u_x$ 后的半离散化，被构造成一个常微分方程组 (ODEs) $\\frac{du}{dt} = L(u)$。空间算子 $L(u)$ 使用空间导数 $u_x$ 的二阶中心差分近似来定义：\n$$\nL(u)_i = -a \\left( \\frac{u_{i+1} - u_{i-1}}{2\\Delta x} \\right)\n$$\n已知该算子是色散的且非 TVD 的；也就是说，它会向解中引入新的、非物理的振荡（局部极值）。使用该算子的简单前向欧拉时间步 $u^{n+1} = u^n + \\Delta t L(u^n)$ 对于平流方程是无条件不稳定的，并且已知会放大振荡，从而增加解的全变差。\n\n时间积分通过使用三阶强稳定性保持 Runge-Kutta (SSP-RK$3$) 方法的一个完整步来执行。给定在时间 $t_n$ 的解 $u^n$，在 $t_{n+1} = t_n + \\Delta t$ 的解通过以下三个阶段计算：\n$$\n\\begin{align*}\nu^{(1)} = u^n + \\Delta t L(u^n) \\\\\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4} u^{(1)} + \\frac{1}{4} \\Delta t L(u^{(1)}) \\\\\nu^{n+1} = u^{(3)} = \\frac{1}{3} u^n + \\frac{2}{3} u^{(2)} + \\frac{2}{3} \\Delta t L(u^{(2)})\n\\end{align*}\n$$\n时间步长 $\\Delta t$ 由 Courant-Friedrichs-Lewy (CFL) 数 $c = a\\Delta t/\\Delta x$ 决定。\n\nSSP 方法背后的原理是，如果前向欧拉步在时间步限制 $\\Delta t \\le \\Delta t_0$ 下是 TVD 的，那么作为此类步的凸组合的 SSP 方法，在相关的限制 $\\Delta t \\le C_{\\text{SSP}}\\Delta t_0$ 下也将是 TVD 的。对于 SSP-RK$3$，SSP 系数为 $C_{\\text{SSP}}=1$。然而，在这个问题中，使用中心差分算子 $L$ 的前向欧拉步对于任何 $\\Delta t > 0$ 都不是 TVD 的。因此，时间积分器的 SSP 属性并不能形式上保证完整步的结果是 TVD 的。本练习的目的是研究实际结果。第一阶段 $u^{(1)}$ 是一个纯粹的前向欧拉步，预计会增加全变差。后续阶段通过其凸组合结构，可能会抵消这种增加，如果 CFL 数在格式的稳定区域内，则可能导致在整个完整步上 TV 净减少。\n\n网格函数 $u$ 的离散全变差提供了其振荡内容的一种度量，定义为：\n$$\n\\operatorname{TV}(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_i|\n$$\n其中周期性意味着 $u_N = u_0$。我们为初始状态 $u^0$ 和三个阶段性结果 $u^{(1)}$、$u^{(2)}$ 和 $u^{(3)}$ 中的每一个计算此量。\n\n该实现处理三个测试用例：\n- 用例 1 ($c=0.8$)：此 CFL 数在组合格式的线性稳定性极限 ($c \\le \\sqrt{3}$) 内。它旨在展示第一阶段增加 TV，但完整步成功地相对于初始状态减少了 TV 的特征行为。\n- 用例 2 ($c=0.2$)：一个小的 CFL 数，也在稳定区域内。其行为将受到前向欧拉步的强烈影响，尽管更新的幅度较小可能会缓和 TV 的增长。\n- 用例 3 ($c=2.5$)：一个大的 CFL 数，远在稳定区域之外 ($c > \\sqrt{3} \\approx 1.732$)。我们预期会出现数值不稳定的行为，其特征是在所有阶段全变差都出现快速且显著的增长。\n\n该程序定义了用于计算空间算子 $L(u)$ 和全变差 $\\operatorname{TV}(u)$ 的函数，通过 `numpy.roll` 正确处理周期性边界。对于每个测试用例，它会初始化解向量，通过执行 SSP-RK$3$ 的各个阶段计算所需的四个 TV 值，并评估两个布尔条件：$\\operatorname{TV}(u^{(1)}) > \\operatorname{TV}(u^0)$ 和 $\\operatorname{TV}(u^{(3)})  \\operatorname{TV}(u^0)$。然后将结果进行整理并格式化为指定的单行输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing the Total Variation (TV) behavior of a numerical\n    scheme for the linear advection equation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, a, epsilon, m, c)\n        (400, 1.0, 0.05, 100, 0.8),\n        (400, 1.0, 0.05, 100, 0.2),\n        (400, 1.0, 0.05, 100, 2.5),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, a, epsilon, m, c = case\n\n        # 1. Setup grid, time step, and initial condition\n        dx = 1.0 / N\n        dt = c * dx / a\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n        \n        # Initial condition: u(x,0) = chi_[0,1/2) + epsilon*sin(2*pi*m*x)\n        u0 = np.where(x  0.5, 1.0, 0.0)\n        u0 += epsilon * np.sin(2 * np.pi * m * x)\n\n        # 2. Define helper functions for the spatial operator and TV calculation\n        def compute_L(u, a_val, dx_val):\n            \"\"\"Computes L(u) = -a * D_cen(u) with periodic boundaries.\"\"\"\n            u_plus_1 = np.roll(u, -1)\n            u_minus_1 = np.roll(u, 1)\n            du_dx_cen = (u_plus_1 - u_minus_1) / (2.0 * dx_val)\n            return -a_val * du_dx_cen\n\n        def calculate_tv(u):\n            \"\"\"Computes the total variation of u with periodic boundaries.\"\"\"\n            u_plus_1 = np.roll(u, -1)\n            return np.sum(np.abs(u_plus_1 - u))\n\n        # 3. Compute initial TV\n        tv0 = calculate_tv(u0)\n\n        # 4. Apply one full step of SSP-RK3 and compute TV at each stage\n        # Stage 1\n        L_u0 = compute_L(u0, a, dx)\n        u1 = u0 + dt * L_u0\n        tv1 = calculate_tv(u1)\n\n        # Stage 2\n        L_u1 = compute_L(u1, a, dx)\n        u2 = 0.75 * u0 + 0.25 * u1 + 0.25 * dt * L_u1\n        tv2 = calculate_tv(u2)\n\n        # Stage 3 (Final full-step result)\n        L_u2 = compute_L(u2, a, dx)\n        u3 = (1.0/3.0) * u0 + (2.0/3.0) * u2 + (2.0/3.0) * dt * L_u2\n        tv3 = calculate_tv(u3)\n\n        # 5. Determine the boolean flags\n        bool_inc_stage1 = tv1 > tv0\n        bool_overall_dec = tv3  tv0\n        \n        # 6. Collate results for the current test case\n        case_result = [tv0, tv1, tv2, tv3, bool_inc_stage1, bool_overall_dec]\n        all_results.append(case_result)\n\n    # 7. Format the final output string exactly as required.\n    # The output should be a list of lists, represented as a string.\n    # e.g., [[val1,val2,true],[val3,val4,false]]\n    outer_list_str_parts = []\n    for res in all_results:\n        inner_list_str_items = []\n        for item in res:\n            if isinstance(item, bool):\n                # Use lowercase 'true'/'false' for consistency with common standards like JSON\n                inner_list_str_items.append(str(item).lower())\n            else:\n                inner_list_str_items.append(f\"{item:.15f}\") # Use enough precision for floats\n        \n        inner_list_str = f\"[{','.join(inner_list_str_items)}]\"\n        outer_list_str_parts.append(inner_list_str)\n\n    final_output_str = f\"[{','.join(outer_list_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3422960"}]}