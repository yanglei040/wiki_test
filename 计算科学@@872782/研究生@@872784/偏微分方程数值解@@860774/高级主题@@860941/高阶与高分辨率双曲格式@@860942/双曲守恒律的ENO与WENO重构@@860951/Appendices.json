{"hands_on_practices": [{"introduction": "从ENO格式的“非此即彼”的模板选择，到WENO格式的“加权平均”，关键的一步在于如何量化“光滑度”。本练习聚焦于WENO格式的核心部件——光滑度指示因子 $\\beta_k$。通过对给定的候选多项式计算其光滑度指示因子，你将深入理解WENO是如何评估每个模板的优劣，并为后续非线性权重的分配提供数学依据的 [@problem_id:3385559]。", "problem": "考虑一维标量双曲守恒律 $u_{t} + f(u)_{x} = 0$，该方程在一个均匀网格上通过有限体积法进行离散，网格单元中心为 $x_{i}$，单元宽度为 $\\Delta x$。在加权本质无振荡 (WENO) 重构中，多个候选模板在目标单元上生成局部重构多项式，并通过 Jiang–Shu 光滑度指示子来衡量其光滑度，以形成非线性权。设局部坐标为 $\\xi = (x - x_{i}) / \\Delta x \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$，并假设三个候选模板 $S_{0}$、$S_{1}$、$S_{2}$ 在单元 $i$ 上产生如下二次重构多项式：\n$$\np_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\,\\xi + \\frac{1}{50}\\,\\xi^{2}, \\quad\np_{1}(\\xi) = 1 - \\frac{1}{20}\\,\\xi + \\frac{3}{20}\\,\\xi^{2}, \\quad\np_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\,\\xi - \\frac{1}{25}\\,\\xi^{2}.\n$$\n从候选多项式的 Jiang–Shu 光滑度指示子是通过在目标单元上对多项式的适当缩放的导数的平方进行积分得到的这一定义出发，推导每个 $p_{k}$ 的显式光滑度指示子 $\\,\\beta_{k}\\,$，并计算 $\\,\\beta_{0}, \\beta_{1}, \\beta_{2}\\,$ 这三个值。根据该指示子，确定哪个模板被认为更光滑（即 $\\,\\beta_{k}\\,$ 值最小的模板）。请用精确分数形式表示您的最终数值结果。按顺序提供三个光滑度指示子，其后跟最光滑模板的索引 $\\,k \\in \\{0,1,2\\}\\,$，以单行矩阵的形式给出。", "solution": "该问题要求计算三个给定的二次重构多项式 $p_k(\\xi)$ 的 Jiang–Shu 光滑度指示子 $\\beta_k$，并确定最光滑的模板。\n\n首先，我们必须建立光滑度指示子的精确公式。问题陈述其是通过“在目标单元上对多项式的适当缩放的导数的平方进行积分得到”的。在加权本质无振荡 (WENO) 格式的背景下，对于一个 $r-1$ 次多项式，Jiang–Shu 光滑度指示子 $\\beta_k$ 定义为：\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{x_{i-1/2}}^{x_{i+1/2}} (\\Delta x)^{2l-1} \\left( \\frac{d^l p_k(x)}{dx^l} \\right)^2 dx\n$$\n问题以局部坐标 $\\xi = (x - x_i) / \\Delta x$ 的形式提供了多项式，其中积分区间，即单元 $i$ 从 $x_{i-1/2} = x_i - \\frac{\\Delta x}{2}$ 到 $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$，对应于 $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$。我们必须将积分变换到该坐标系中。链式法则给出了关于 $x$ 和 $\\xi$ 的导数之间的关系：\n$$\n\\frac{d^l}{dx^l} = \\left(\\frac{1}{\\Delta x}\\right)^l \\frac{d^l}{d\\xi^l}\n$$\n微分元变换为 $dx = \\Delta x \\, d\\xi$。将这些代入 $\\beta_k$ 的定义中：\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} (\\Delta x)^{2l-1} \\left( \\left(\\frac{1}{\\Delta x}\\right)^l \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 (\\Delta x \\, d\\xi)\n$$\n$$\n\\beta_k = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} (\\Delta x)^{2l-1} \\frac{1}{(\\Delta x)^{2l}} \\left( \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 (\\Delta x \\, d\\xi) = \\sum_{l=1}^{r-1} \\int_{-1/2}^{1/2} \\left( \\frac{d^l p_k(\\xi)}{d\\xi^l} \\right)^2 d\\xi\n$$\n给定的多项式是二次的，这对应于三阶重构 ($r=3$)。因此，我们对最高为 $l=r-1=2$ 阶的导数进行求和。公式简化为：\n$$\n\\beta_k = \\int_{-1/2}^{1/2} \\left( \\frac{d p_k(\\xi)}{d\\xi} \\right)^2 d\\xi + \\int_{-1/2}^{1/2} \\left( \\frac{d^2 p_k(\\xi)}{d\\xi^2} \\right)^2 d\\xi\n$$\n现在我们将此公式应用于每个给定的多项式。\n\n对于模板 $S_0$，多项式为 $p_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\xi + \\frac{1}{50}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_0}{d\\xi} = \\frac{1}{5} + \\frac{1}{25}\\xi\n$$\n$$\n\\frac{d^2p_0}{d\\xi^2} = \\frac{1}{25}\n$$\n我们计算 $\\beta_0$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{5} + \\frac{1}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{25} + \\frac{2}{125}\\xi + \\frac{1}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{25}\\xi + \\frac{1}{125}\\xi^2 + \\frac{1}{1875}\\xi^3 \\right]_{-1/2}^{1/2}\n$$\n$$\n= 2 \\left( \\frac{1}{25}\\left(\\frac{1}{2}\\right) + \\frac{1}{1875}\\left(\\frac{1}{8}\\right) \\right) = \\frac{1}{25} + \\frac{1}{7500} = \\frac{300}{7500} + \\frac{1}{7500} = \\frac{301}{7500}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{25} \\right)^2 d\\xi = \\frac{1}{625} \\int_{-1/2}^{1/2} d\\xi = \\frac{1}{625} [\\xi]_{-1/2}^{1/2} = \\frac{1}{625}\n$$\n因此，$\\beta_0 = \\frac{301}{7500} + \\frac{1}{625} = \\frac{301}{7500} + \\frac{12}{7500} = \\frac{313}{7500}$。\n\n对于模板 $S_1$，多项式为 $p_{1}(\\xi) = 1 - \\frac{1}{20}\\xi + \\frac{3}{20}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_1}{d\\xi} = -\\frac{1}{20} + \\frac{3}{10}\\xi\n$$\n$$\n\\frac{d^2p_1}{d\\xi^2} = \\frac{3}{10}\n$$\n我们计算 $\\beta_1$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( -\\frac{1}{20} + \\frac{3}{10}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{400} - \\frac{3}{100}\\xi + \\frac{9}{100}\\xi^2 \\right) d\\xi\n$$\n由于积分区间关于原点对称，奇函数项 $\\xi$ 的积分为零。因此：\n$$\n= \\int_{-1/2}^{1/2} \\left( \\frac{1}{400} + \\frac{9}{100}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{400}\\xi + \\frac{3}{100}\\xi^3 \\right]_{-1/2}^{1/2} = 2 \\left( \\frac{1}{400}\\left(\\frac{1}{2}\\right) + \\frac{3}{100}\\left(\\frac{1}{8}\\right) \\right) = 2 \\left( \\frac{1}{800} + \\frac{3}{800} \\right) = \\frac{8}{800} = \\frac{1}{100}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{3}{10} \\right)^2 d\\xi = \\frac{9}{100} \\int_{-1/2}^{1/2} d\\xi = \\frac{9}{100}\n$$\n因此，$\\beta_1 = \\frac{1}{100} + \\frac{9}{100} = \\frac{10}{100} = \\frac{1}{10}$。\n\n对于模板 $S_2$，多项式为 $p_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\xi - \\frac{1}{25}\\xi^{2}$。\n其导数为：\n$$\n\\frac{dp_2}{d\\xi} = \\frac{1}{100} - \\frac{2}{25}\\xi\n$$\n$$\n\\frac{d^2p_2}{d\\xi^2} = -\\frac{2}{25}\n$$\n我们计算 $\\beta_2$ 的积分：\n$$\n\\int_{-1/2}^{1/2} \\left( \\frac{1}{100} - \\frac{2}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{10000} - \\frac{1}{1250}\\xi + \\frac{4}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{10000}\\xi + \\frac{4}{1875}\\xi^3 \\right]_{-1/2}^{1/2}\n$$\n$$\n= 2 \\left( \\frac{1}{20000} + \\frac{4}{1875 \\cdot 8} \\right) = 2 \\left( \\frac{1}{20000} + \\frac{1}{3750} \\right) = \\frac{1}{10000} + \\frac{1}{1875} = \\frac{3}{30000} + \\frac{16}{30000} = \\frac{19}{30000}\n$$\n$$\n\\int_{-1/2}^{1/2} \\left( -\\frac{2}{25} \\right)^2 d\\xi = \\frac{4}{625} \\int_{-1/2}^{1/2} d\\xi = \\frac{4}{625}\n$$\n因此，$\\beta_2 = \\frac{19}{30000} + \\frac{4}{625} = \\frac{19}{30000} + \\frac{4 \\cdot 48}{625 \\cdot 48} = \\frac{19}{30000} + \\frac{192}{30000} = \\frac{211}{30000}$。\n\n最后，我们比较这些光滑度指示子。$\\beta_k$ 值越小，表示单元上的多项式越光滑。\n$$\n\\beta_0 = \\frac{313}{7500}, \\quad \\beta_1 = \\frac{1}{10}, \\quad \\beta_2 = \\frac{211}{30000}\n$$\n为了比较这些分数，我们将它们通分，公分母为 $30000$：\n$$\n\\beta_0 = \\frac{313 \\times 4}{7500 \\times 4} = \\frac{1252}{30000}\n$$\n$$\n\\beta_1 = \\frac{1 \\times 3000}{10 \\times 3000} = \\frac{3000}{30000}\n$$\n$$\n\\beta_2 = \\frac{211}{30000}\n$$\n比较分子，我们有 $211  1252  3000$。因此，光滑度指示子的大小顺序为 $\\beta_2  \\beta_0  \\beta_1$。最小值是 $\\beta_2$，这意味着模板 $S_2$ 提供了最光滑的重构多项式。该模板的索引是 $k=2$。\n\n最终结果为 $\\beta_0 = \\frac{313}{7500}$，$\\beta_1 = \\frac{1}{10}$，$\\beta_2 = \\frac{211}{30000}$，最光滑的模板由 $k=2$ 索引。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{313}{7500}  \\frac{1}{10}  \\frac{211}{30000}  2 \\end{pmatrix}}\n$$", "id": "3385559"}, {"introduction": "现在，是时候将所有知识点整合起来，完成一次完整的WENO重构了。本练习将引导你完成一个标准的五阶有限体积WENO-JS格式的全部计算流程。你将从单元平均值出发，计算候选重构值、光滑度指示因子、非线性权重，并最终组合得到界面上的高精度、无振荡的重构值，从而全面体验WENO算法的威力 [@problem_id:3385594]。", "problem": "考虑在一维均匀网格上的一维标量双曲守恒律 $u_{t} + f(u)_{x} = 0$，其中网格中心为 $x_{i}$，网格平均值为 $u_{i}$。在有限体积更新中，半离散形式需要在界面 $x_{i \\pm 1/2}$ 处计算数值通量。对于正特征速度，进入 $x_{i+1/2}$ 处数值通量的迎风左状态 $u_{i+1/2}^{-}$ 是使用 Jiang and Shu 的加权基本无振荡 (WENO-JS) 方法，根据相邻网格的平均值重构得到的。五阶 WENO-JS 重构结合了来自三个子模板的三个三阶候选重构，其非线性权取决于光滑度指示子和一个用于避免除以零的小参数。\n\n从有限体积原理以及加权基本无振荡方法中使用的多项式重构和光滑度测量的基本定义出发，使用 WENO-JS 方法和以下给定数据，确定左界面值 $u_{i+1/2}^{-}$：\n- 网格平均值：$u_{i-2} = 1.5$，$u_{i-1} = 1.0$，$u_{i} = 0.5$，$u_{i+1} = 0.0$，$u_{i+2} = -0.2$。\n- 小正参数：$\\epsilon = 10^{-6}$。\n- 非线性指数：$p = 2$。\n\n您的计算必须明确地给出由三点子模板得到的三个候选界面值、光滑度指示子、未归一化和归一化的非线性权，以及得出 $u_{i+1/2}^{-}$ 的最终凸组合。将您的最终数值答案四舍五入到六位有效数字。无需物理单位，因为根据测试数据的构造，这些变量是无量纲的。", "solution": "该问题要求根据一组给定的网格平均值，计算在界面 $x_{i+1/2}$ 处的左偏五阶加权基本无振荡 (WENO-JS) 重构值，记为 $u_{i+1/2}^{-}$。WENO-JS 方法使用非线性权组合多个低阶候选重构，这些权取决于解在不同子模板上的光滑度。\n\n输入数据为网格平均值：$u_{i-2} = 1.5$，$u_{i-1} = 1.0$，$u_{i} = 0.5$，$u_{i+1} = 0.0$ 和 $u_{i+2} = -0.2$。加权方案的参数为小参数 $\\epsilon = 10^{-6}$ 和指数 $p = 2$。\n\n$u_{i+1/2}^{-}$ 的五阶重构使用一个五点模板 $\\{u_{i-2}, u_{i-1}, u_{i}, u_{i+1}, u_{i+2}\\}$。它是由三个从三点子模板 $S_0 = \\{u_{i-2}, u_{i-1}, u_i\\}$、$S_1 = \\{u_{i-1}, u_i, u_{i+1}\\}$ 和 $S_2 = \\{u_i, u_{i+1}, u_{i+2}\\}$ 推导出的三阶重构的凸组合构成的。\n\n首先，我们计算三个候选界面值 $\\hat{u}_{i+1/2}^{(k)}$（其中 $k \\in \\{0, 1, 2\\}$），它们是从每个子模板进行的三阶精度重构。标准公式为：\n$$ \\hat{u}_{i+1/2}^{(0)} = \\frac{1}{3}u_{i-2} - \\frac{7}{6}u_{i-1} + \\frac{11}{6}u_i $$\n$$ \\hat{u}_{i+1/2}^{(1)} = -\\frac{1}{6}u_{i-1} + \\frac{5}{6}u_i + \\frac{1}{3}u_{i+1} $$\n$$ \\hat{u}_{i+1/2}^{(2)} = \\frac{1}{3}u_i + \\frac{5}{6}u_{i+1} - \\frac{1}{6}u_{i+2} $$\n代入给定的网格平均值：\n$$ \\hat{u}_{i+1/2}^{(0)} = \\frac{1}{3}(1.5) - \\frac{7}{6}(1.0) + \\frac{11}{6}(0.5) = 0.5 - \\frac{7}{6} + \\frac{5.5}{6} = \\frac{3}{6} - \\frac{1.5}{6} = \\frac{1.5}{6} = 0.25 $$\n$$ \\hat{u}_{i+1/2}^{(1)} = -\\frac{1}{6}(1.0) + \\frac{5}{6}(0.5) + \\frac{1}{3}(0.0) = -\\frac{1}{6} + \\frac{2.5}{6} = \\frac{1.5}{6} = 0.25 $$\n$$ \\hat{u}_{i+1/2}^{(2)} = \\frac{1}{3}(0.5) + \\frac{5}{6}(0.0) - \\frac{1}{6}(-0.2) = \\frac{1}{6} + \\frac{0.2}{6} = \\frac{1.2}{6} = 0.2 $$\n三个候选界面值为 $\\hat{u}_{i+1/2}^{(0)} = 0.25$，$\\hat{u}_{i+1/2}^{(1)} = 0.25$ 和 $\\hat{u}_{i+1/2}^{(2)} = 0.2$。\n\n其次，我们计算每个子模板 $S_k$ 的光滑度指示子 $\\beta_k$。这些指示子衡量了被重构函数的局部光滑度。其公式为：\n$$ \\beta_0 = \\frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \\frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2 $$\n$$ \\beta_1 = \\frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \\frac{1}{4}(u_{i-1} - u_{i+1})^2 $$\n$$ \\beta_2 = \\frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \\frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2 $$\n代入给定值：\n对于 $\\beta_0$：\n$$ u_{i-2} - 2u_{i-1} + u_i = 1.5 - 2(1.0) + 0.5 = 0 $$\n$$ u_{i-2} - 4u_{i-1} + 3u_i = 1.5 - 4(1.0) + 3(0.5) = 1.5 - 4.0 + 1.5 = -1.0 $$\n$$ \\beta_0 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-1.0)^2 = 0.25 $$\n对于 $\\beta_1$：\n$$ u_{i-1} - 2u_i + u_{i+1} = 1.0 - 2(0.5) + 0.0 = 0 $$\n$$ u_{i-1} - u_{i+1} = 1.0 - 0.0 = 1.0 $$\n$$ \\beta_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(1.0)^2 = 0.25 $$\n对于 $\\beta_2$：\n$$ u_i - 2u_{i+1} + u_{i+2} = 0.5 - 2(0.0) + (-0.2) = 0.3 $$\n$$ 3u_i - 4u_{i+1} + u_{i+2} = 3(0.5) - 4(0.0) + (-0.2) = 1.5 - 0.2 = 1.3 $$\n$$ \\beta_2 = \\frac{13}{12}(0.3)^2 + \\frac{1}{4}(1.3)^2 = \\frac{13}{12}(0.09) + \\frac{1}{4}(1.69) = 0.0975 + 0.4225 = 0.52 $$\n光滑度指示子为 $\\beta_0 = 0.25$，$\\beta_1 = 0.25$ 和 $\\beta_2 = 0.52$。\n\n第三，我们使用理想权 $d_k$、光滑度指示子 $\\beta_k$、参数 $\\epsilon$ 和指数 $p$ 来计算未归一化的非线性权 $\\alpha_k$。对于五阶 WENO，理想权为 $d_0 = 0.1$，$d_1 = 0.6$ 和 $d_2 = 0.3$。$\\alpha_k$ 的公式为：\n$$ \\alpha_k = \\frac{d_k}{(\\beta_k + \\epsilon)^p} $$\n使用给定值 $\\epsilon = 10^{-6}$ 和 $p=2$：\n$$ \\alpha_0 = \\frac{0.1}{(0.25 + 10^{-6})^2} = \\frac{0.1}{(0.250001)^2} \\approx 1.59998720 $$\n$$ \\alpha_1 = \\frac{0.6}{(0.25 + 10^{-6})^2} = \\frac{0.6}{(0.250001)^2} \\approx 9.59992320 $$\n$$ \\alpha_2 = \\frac{0.3}{(0.52 + 10^{-6})^2} = \\frac{0.3}{(0.520001)^2} \\approx 1.10946284 $$\n\n第四，我们将这些权进行归一化，以获得最终的非线性权 $\\omega_k$：\n$$ \\omega_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j} $$\n未归一化权的合为：\n$$ \\sum_{j=0}^{2} \\alpha_j \\approx 1.59998720 + 9.59992320 + 1.10946284 = 12.30937324 $$\n归一化后的权为：\n$$ \\omega_0 = \\frac{1.59998720}{12.30937324} \\approx 0.12998089 $$\n$$ \\omega_1 = \\frac{9.59992320}{12.30937324} \\approx 0.77988534 $$\n$$ \\omega_2 = \\frac{1.10946284}{12.30937324} \\approx 0.09013377 $$\n\n最后，WENO-JS 重构值 $u_{i+1/2}^{-}$ 是候选重构值以非线性权 $\\omega_k$ 为权重的凸组合：\n$$ u_{i+1/2}^{-} = \\sum_{k=0}^{2} \\omega_k \\hat{u}_{i+1/2}^{(k)} $$\n代入我们计算出的值：\n$$ u_{i+1/2}^{-} \\approx (0.12998089)(0.25) + (0.77988534)(0.25) + (0.09013377)(0.2) $$\n$$ u_{i+1/2}^{-} \\approx (0.12998089 + 0.77988534)(0.25) + (0.09013377)(0.2) $$\n$$ u_{i+1/2}^{-} \\approx (0.90986623)(0.25) + (0.09013377)(0.2) $$\n$$ u_{i+1/2}^{-} \\approx 0.2274665575 + 0.018026754 $$\n$$ u_{i+1/2}^{-} \\approx 0.2454933115 $$\n题目要求将最终答案四舍五入到六位有效数字。\n$$ u_{i+1/2}^{-} \\approx 0.245493 $$\n光滑度指示子 $\\beta_0$ 和 $\\beta_1$ 很小，正确地识别了数据在模板 $S_0$ 和 $S_1$ 上的光滑性。因此，权重 $\\omega_0$ 和 $\\omega_1$ 接近于理想权除以它们在光滑模板上的和（即 $\\frac{0.1}{0.1+0.6} \\approx 0.14$，$\\frac{0.6}{0.1+0.6} \\approx 0.86$），而非光滑模板的权重 $\\omega_2$ 则从其理想值 $d_2 = 0.3$ 被显著降低至约 $0.09$。这使得最终值非常接近于光滑重构值 $0.25$。", "answer": "$$ \\boxed{0.245493} $$", "id": "3385594"}]}