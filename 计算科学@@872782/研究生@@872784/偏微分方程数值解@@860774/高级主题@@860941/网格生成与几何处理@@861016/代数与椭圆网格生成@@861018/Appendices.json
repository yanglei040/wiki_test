{"hands_on_practices": [{"introduction": "代数方法是生成结构化网格最直接的技术之一，其中双线性插值是其基石。网格质量的一个关键衡量标准是其正交性，因为非正交的网格线会降低数值求解器的精度。本练习旨在通过解析方式，将物理域的几何形状（一个倾斜的四边形）与网格中心的坐标线夹角直接联系起来，从而让学生从第一性原理出发，深刻理解域边界形状如何影响内部网格质量。[@problem_id:3362194]", "problem": "考虑一个双线性代数映射，它将坐标为 $(\\xi,\\eta)\\in[0,1]\\times[0,1]$ 的计算单元正方形映射到一个凸物理四边形。该四边形的顶点按逆时针顺序为 $\\mathbf{P}_{1}=(0,0)$、$\\mathbf{P}_{2}=(L,0)$、$\\mathbf{P}_{3}=(L+s,H)$ 和 $\\mathbf{P}_{4}=(0,H)$，其中 $L0$、$H0$ 且 $|s|  L$。求网格中心 $(\\xi,\\eta)=(1/2,1/2)$ 处坐标线夹角的余弦值。您的答案应表示为 $s$ 和 $H$ 的函数。", "solution": "1.  **确定双线性映射**\n    双线性插值公式为：\n    $\\mathbf{x}(\\xi,\\eta) = (1-\\xi)(1-\\eta)\\mathbf{P}_{1} + \\xi(1-\\eta)\\mathbf{P}_{2} + (1-\\xi)\\eta\\mathbf{P}_{4} + \\xi\\eta\\mathbf{P}_{3}$\n    代入顶点坐标 $\\mathbf{P}_{1}=(0,0)$, $\\mathbf{P}_{2}=(L,0)$, $\\mathbf{P}_{3}=(L+s,H)$, $\\mathbf{P}_{4}=(0,H)$：\n    $x(\\xi,\\eta) = \\xi(1-\\eta)L + \\xi\\eta(L+s) = L\\xi - L\\xi\\eta + L\\xi\\eta + s\\xi\\eta = L\\xi + s\\xi\\eta = \\xi(L+s\\eta)$\n    $y(\\xi,\\eta) = (1-\\xi)\\eta H + \\xi\\eta H = \\eta H - \\xi\\eta H + \\xi\\eta H = H\\eta$\n    所以，映射为 $\\mathbf{x}(\\xi,\\eta) = (\\xi(L+s\\eta), H\\eta)$。\n\n2.  **计算切向量**\n    沿 $\\xi$ 方向的切向量 $\\mathbf{x}_\\xi$ 和沿 $\\eta$ 方向的切向量 $\\mathbf{x}_\\eta$ 分别为：\n    $\\mathbf{x}_\\xi = \\frac{\\partial\\mathbf{x}}{\\partial\\xi} = (\\frac{\\partial x}{\\partial\\xi}, \\frac{\\partial y}{\\partial\\xi}) = (L+s\\eta, 0)$\n    $\\mathbf{x}_\\eta = \\frac{\\partial\\mathbf{x}}{\\partial\\eta} = (\\frac{\\partial x}{\\partial\\eta}, \\frac{\\partial y}{\\partial\\eta}) = (s\\xi, H)$\n\n3.  **在网格中心计算切向量**\n    在网格中心点 $(\\xi, \\eta) = (1/2, 1/2)$，切向量为：\n    $\\mathbf{x}_\\xi(1/2, 1/2) = (L+s/2, 0)$\n    $\\mathbf{x}_\\eta(1/2, 1/2) = (s/2, H)$\n\n4.  **计算夹角的余弦值**\n    两向量夹角 $\\theta$ 的余弦值由点积公式给出：\n    $\\cos\\theta = \\frac{\\mathbf{x}_\\xi \\cdot \\mathbf{x}_\\eta}{\\|\\mathbf{x}_\\xi\\| \\|\\mathbf{x}_\\eta\\|}$\n    点积：$\\mathbf{x}_\\xi \\cdot \\mathbf{x}_\\eta = (L+s/2)(s/2) + (0)(H) = \\frac{Ls}{2} + \\frac{s^2}{4}$\n    向量模长：\n    $\\|\\mathbf{x}_\\xi\\| = \\sqrt{(L+s/2)^2 + 0^2} = L+s/2$ (假设四边形是凸的)\n    $\\|\\mathbf{x}_\\eta\\| = \\sqrt{(s/2)^2 + H^2} = \\sqrt{\\frac{s^2}{4} + H^2}$\n    代入余弦公式：\n    $\\cos\\theta = \\frac{\\frac{Ls}{2} + \\frac{s^2}{4}}{(L+s/2) \\sqrt{\\frac{s^2}{4} + H^2}} = \\frac{\\frac{s}{2}(L + s/2)}{(L+s/2) \\sqrt{\\frac{s^2}{4} + H^2}} = \\frac{s/2}{\\sqrt{\\frac{s^2+4H^2}{4}}} = \\frac{s/2}{\\frac{\\sqrt{s^2+4H^2}}{2}} = \\frac{s}{\\sqrt{s^2+4H^2}}$\n    该值是衡量网格非正交性的一个度量。当 $s=0$ 时，四边形为矩形，$\\cos\\theta = 0$，网格在该点正交。", "answer": "$$\\boxed{\\frac{s}{\\sqrt{s^{2} + 4H^{2}}}}$$", "id": "3362194"}, {"introduction": "除了网格线的角度，控制网格单元的尺寸和面积对于保证计算精度和效率同样至关重要，尤其是在自适应网格技术中。理论上，雅可比行列式 $J$ 是连接物理域面积微元 $dA$ 和计算域面积微元 $d\\xi d\\eta$ 的桥梁。本练习通过一个具体的代数映射，要求学生计算一个网格单元的精确面积，并将其与常用的中点求积近似值进行比较，进而分析两者之间的误差。这个过程将抽象的理论关系 $dA = J d\\xi d\\eta$ 变得具体化，有助于理解在实践中选择特定网格生成映射的数值后果。[@problem_id:3362222]", "problem": "考虑一个在偏微分方程 (PDE) 数值解的代数网格生成中常用的曲线坐标映射：从具有计算坐标 $(\\xi,\\eta)$ 的计算域 $[0,1] \\times [0,1]$ 到物理平面 $(x,y)$，定义\n$$\nx(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta) = \\eta + \\beta\\,\\xi^{2},\n$$\n其中 $\\alpha$ 和 $\\beta$ 是实参数，其选择应使该映射在 $[0,1]\\times[0,1]$ 上是保向的（假设 $0 \\le \\alpha \\beta  \\tfrac{1}{2}$）。设计算域在 $\\xi$ 方向上均匀剖分为 $M$ 个单元，在 $\\eta$ 方向上均匀剖分为 $N$ 个单元，因此 $\\Delta \\xi = \\tfrac{1}{M}$，$\\Delta \\eta = \\tfrac{1}{N}$，对于整数 $i \\in \\{0,1,\\dots,M-1\\}$ 有 $\\xi_i = i\\,\\Delta \\xi$，对于整数 $j \\in \\{0,1,\\dots,N-1\\}$ 有 $\\eta_j = j\\,\\Delta \\eta$。考虑计算单元 $C_{ij} = [\\xi_i,\\xi_{i+1}] \\times [\\eta_j,\\eta_{j+1}]$。\n\n从局部物理面积元变换的基本定义 $dA = J(\\xi,\\eta)\\,d\\xi\\,d\\eta$ 出发，其中 $J(\\xi,\\eta) = \\det\\left(\\dfrac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right)$ 是雅可比行列式，推导局部单元面积的精确闭式表达式\n$$\nA_{ij} = \\int_{\\xi_i}^{\\xi_{i+1}}\\int_{\\eta_j}^{\\eta_{j+1}} J(\\xi,\\eta)\\,d\\eta\\,d\\xi,\n$$\n然后推导中点求积近似\n$$\nA_{ij}^{\\mathrm{(mid)}} = J\\!\\left(\\xi_i+\\tfrac{\\Delta \\xi}{2},\\,\\eta_j+\\tfrac{\\Delta \\eta}{2}\\right)\\,\\Delta \\xi\\,\\Delta \\eta\n$$\n在此均匀计算网格上。最后，计算求积误差 $E_{ij} = A_{ij} - A_{ij}^{\\mathrm{(mid)}}$，并用 $i$、$j$、$M$、$N$、$\\alpha$ 和 $\\beta$ 将其完全化简。\n\n请提供 $E_{ij}$ 的完全化简的解析表达式作为最终答案。不需要进行数值代入，也不需要四舍五入。答案必须是一个单一的闭式解析表达式。", "solution": "用户要求我解决一个关于代数与椭圆网格生成的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **坐标映射：** 从计算坐标 $(\\xi, \\eta)$到物理坐标 $(x, y)$ 的映射由以下公式给出：\n    $x(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta$\n    $y(\\xi,\\eta) = \\eta + \\beta\\,\\xi^{2}$\n*   **域：** 计算域为 $[\\xi, \\eta] \\in [0,1] \\times [0,1]$。\n*   **参数：** $\\alpha$ 和 $\\beta$ 是实参数。\n*   **约束条件：** $0 \\le \\alpha \\beta  \\tfrac{1}{2}$，确保映射是保向的。\n*   **计算网格：**\n    *   在 $\\xi$ 方向上有 $M$ 个单元，在 $\\eta$ 方向上有 $N$ 个单元的均匀剖分。\n    *   网格间距：$\\Delta \\xi = \\tfrac{1}{M}$ 和 $\\Delta \\eta = \\tfrac{1}{N}$。\n    *   网格节点：对于 $i \\in \\{0, 1, \\dots, M-1\\}$ 有 $\\xi_i = i\\,\\Delta \\xi$，对于 $j \\in \\{0, 1, \\dots, N-1\\}$ 有 $\\eta_j = j\\,\\Delta \\eta$。\n    *   计算单元：$C_{ij} = [\\xi_i, \\xi_{i+1}] \\times [\\eta_j, \\eta_{j+1}]$，其中 $\\xi_{i+1} = \\xi_i + \\Delta\\xi$ 且 $\\eta_{j+1} = \\eta_j + \\Delta\\eta$。\n*   **面积定义：**\n    *   雅可比行列式：$J(\\xi,\\eta) = \\det\\left(\\dfrac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right)$。\n    *   精确单元面积：$A_{ij} = \\int_{\\xi_i}^{\\xi_{i+1}}\\int_{\\eta_j}^{\\eta_{j+1}} J(\\xi,\\eta)\\,d\\eta\\,d\\xi$。\n    *   面积的中点求积近似：$A_{ij}^{\\mathrm{(mid)}} = J\\!\\left(\\xi_i+\\tfrac{\\Delta \\xi}{2},\\,\\eta_j+\\tfrac{\\Delta \\eta}{2}\\right)\\,\\Delta \\xi\\,\\Delta \\eta$。\n*   **任务：** 计算求积误差 $E_{ij} = A_{ij} - A_{ij}^{\\mathrm{(mid)}}$，并用 $i, j, M, N, \\alpha, \\beta$ 表示并化简表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题是计算流体动力学和数值分析中的一个标准练习，特别是在求解偏微分方程（PDE）的网格生成领域。曲线坐标、雅可比变换和数值求积等概念是基本且成熟的。对 $\\alpha\\beta$ 的约束是确保变换非奇异的有效条件。\n*   **适定性：** 问题提供了所有必要的定义，并要求一个特定的、可推导的量。步骤是合乎逻辑的，并能导出一个唯一的解析解。\n*   **客观性：** 问题使用精确的数学语言陈述，没有主观性或模糊性。\n\n**步骤 3：结论与行动**\n\n问题有效。这是一个应用数学中适定的、有科学依据的问题。我现在将着手求解。\n\n### 求解推导\n\n求解过程需要四个主要步骤：\n1.  推导雅可比行列式 $J(\\xi, \\eta)$。\n2.  通过直接积分计算精确单元面积 $A_{ij}$。\n3.  计算中点近似值 $A_{ij}^{\\mathrm{(mid)}}$。\n4.  计算差值 $E_{ij} = A_{ij} - A_{ij}^{\\mathrm{(mid)}}$ 并化简。\n\n**1. 雅可比行列式**\n\n首先，我们计算映射函数 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的偏导数。\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi + \\alpha\\,\\xi\\,\\eta) = 1 + \\alpha\\,\\eta\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi + \\alpha\\,\\xi\\,\\eta) = \\alpha\\,\\xi\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\eta + \\beta\\,\\xi^2) = 2\\,\\beta\\,\\xi\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\eta + \\beta\\,\\xi^2) = 1\n$$\n变换的雅可比矩阵是：\n$$\n\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1 + \\alpha\\,\\eta  \\alpha\\,\\xi \\\\ 2\\,\\beta\\,\\xi  1 \\end{pmatrix}\n$$\n雅可比行列式是该矩阵的行列式：\n$$\nJ(\\xi,\\eta) = \\det\\begin{pmatrix} 1 + \\alpha\\,\\eta  \\alpha\\,\\xi \\\\ 2\\,\\beta\\,\\xi  1 \\end{pmatrix} = (1 + \\alpha\\,\\eta)(1) - (\\alpha\\,\\xi)(2\\,\\beta\\,\\xi) = 1 + \\alpha\\,\\eta - 2\\,\\alpha\\,\\beta\\,\\xi^2\n$$\n给定的约束条件 $0 \\le \\alpha\\beta  \\frac{1}{2}$ 确保了对于所有的 $(\\xi, \\eta) \\in [0,1] \\times [0,1]$ 都有 $J(\\xi,\\eta) > 0$，这意味着映射是保向的。\n\n**2. 精确单元面积 $A_{ij}$**\n\n与计算单元 $C_{ij} = [\\xi_i, \\xi_{i+1}] \\times [\\eta_j, \\eta_{j+1}]$ 对应的物理单元的精确面积 $A_{ij}$，可以通过在 $C_{ij}$ 上对雅可比行列式进行积分得到：\n$$\nA_{ij} = \\int_{\\xi_i}^{\\xi_{i+1}} \\int_{\\eta_j}^{\\eta_{j+1}} (1 + \\alpha\\,\\eta - 2\\,\\alpha\\,\\beta\\,\\xi^2)\\,d\\eta\\,d\\xi\n$$\n我们首先对 $\\eta$ 进行积分：\n$$\n\\int_{\\eta_j}^{\\eta_{j+1}} (1 + \\alpha\\,\\eta - 2\\,\\alpha\\,\\beta\\,\\xi^2)\\,d\\eta = \\left[ \\eta + \\frac{\\alpha}{2}\\eta^2 - 2\\,\\alpha\\,\\beta\\,\\xi^2\\,\\eta \\right]_{\\eta_j}^{\\eta_{j+1}}\n$$\n使用 $\\eta_{j+1} - \\eta_j = \\Delta\\eta$ 和 $\\eta_{j+1}^2 - \\eta_j^2 = (\\eta_{j+1} - \\eta_j)(\\eta_{j+1} + \\eta_j) = \\Delta\\eta(2\\eta_j + \\Delta\\eta)$，内层积分的结果是：\n$$\n= (\\eta_{j+1} - \\eta_j) + \\frac{\\alpha}{2}(\\eta_{j+1}^2 - \\eta_j^2) - 2\\,\\alpha\\,\\beta\\,\\xi^2(\\eta_{j+1} - \\eta_j)\n$$\n$$\n= \\Delta\\eta + \\frac{\\alpha}{2}\\Delta\\eta(2\\eta_j + \\Delta\\eta) - 2\\,\\alpha\\,\\beta\\,\\xi^2\\Delta\\eta = \\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\,\\alpha\\,\\beta\\,\\xi^2 \\right)\n$$\n接下来，我们将此结果从 $\\xi_i$到 $\\xi_{i+1}$ 对 $\\xi$ 进行积分：\n$$\nA_{ij} = \\int_{\\xi_i}^{\\xi_{i+1}} \\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\,\\alpha\\,\\beta\\,\\xi^2 \\right) d\\xi\n$$\n$$\nA_{ij} = \\Delta\\eta \\left[ \\left(1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2})\\right)\\xi - \\frac{2}{3}\\alpha\\,\\beta\\,\\xi^3 \\right]_{\\xi_i}^{\\xi_{i+1}}\n$$\n使用 $\\xi_{i+1}-\\xi_i = \\Delta\\xi$ 和 $\\xi_{i+1}^3 - \\xi_i^3 = (\\xi_{i+1}-\\xi_i)(\\xi_{i+1}^2 + \\xi_{i+1}\\xi_i + \\xi_i^2) = \\Delta\\xi(3\\xi_i^2 + 3\\xi_i\\Delta\\xi + \\Delta\\xi^2)$，我们得到：\n$$\nA_{ij} = \\Delta\\eta \\left( \\left(1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2})\\right)\\Delta\\xi - \\frac{2}{3}\\alpha\\,\\beta\\,(\\xi_{i+1}^3 - \\xi_i^3) \\right)\n$$\n$$\nA_{ij} = \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - \\frac{2}{3}\\alpha\\,\\beta\\,\\frac{\\xi_{i+1}^3 - \\xi_i^3}{\\Delta\\xi} \\right)\n$$\n$$\nA_{ij} = \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - \\frac{2}{3}\\alpha\\,\\beta\\,(3\\xi_i^2 + 3\\xi_i\\Delta\\xi + \\Delta\\xi^2) \\right)\n$$\n$$\nA_{ij} = \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\alpha\\beta(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{3}\\Delta\\xi^2) \\right)\n$$\n\n**3. 中点求积近似 $A_{ij}^{\\mathrm{(mid)}}$**\n\n中点法则通过在单元中心 $(\\xi_i+\\tfrac{\\Delta \\xi}{2}, \\eta_j+\\tfrac{\\Delta \\eta}{2})$ 处计算被积函数的值，然后乘以计算空间中单元的面积 $\\Delta\\xi\\Delta\\eta$ 来近似积分。\n$$\nA_{ij}^{\\mathrm{(mid)}} = J\\left(\\xi_i+\\frac{\\Delta\\xi}{2}, \\eta_j+\\frac{\\Delta\\eta}{2}\\right) \\Delta\\xi\\Delta\\eta\n$$\n我们在中点处计算雅可比行列式：\n$$\nJ\\left(\\xi_i+\\frac{\\Delta\\xi}{2}, \\eta_j+\\frac{\\Delta\\eta}{2}\\right) = 1 + \\alpha\\left(\\eta_j+\\frac{\\Delta\\eta}{2}\\right) - 2\\,\\alpha\\,\\beta\\left(\\xi_i+\\frac{\\Delta\\xi}{2}\\right)^2\n$$\n展开平方项：$(\\xi_i+\\frac{\\Delta\\xi}{2})^2 = \\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{4}\\Delta\\xi^2$。\n所以，中点近似为：\n$$\nA_{ij}^{\\mathrm{(mid)}} = \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\alpha\\beta(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{4}\\Delta\\xi^2) \\right)\n$$\n\n**4. 求积误差 $E_{ij}$**\n\n求积误差是精确面积与近似值之间的差：\n$$\nE_{ij} = A_{ij} - A_{ij}^{\\mathrm{(mid)}}\n$$\n代入 $A_{ij}$ 和 $A_{ij}^{\\mathrm{(mid)}}$ 的表达式：\n$$\nE_{ij} = \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\alpha\\beta(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{3}\\Delta\\xi^2) \\right) - \\Delta\\xi\\Delta\\eta \\left( 1 + \\alpha(\\eta_j + \\frac{\\Delta\\eta}{2}) - 2\\alpha\\beta(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{4}\\Delta\\xi^2) \\right)\n$$\n许多项相互抵消，剩下：\n$$\nE_{ij} = \\Delta\\xi\\Delta\\eta \\left[ -2\\alpha\\beta\\left(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{3}\\Delta\\xi^2\\right) - \\left(-2\\alpha\\beta\\left(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{4}\\Delta\\xi^2\\right)\\right) \\right]\n$$\n$$\nE_{ij} = \\Delta\\xi\\Delta\\eta \\left[ -2\\alpha\\beta\\left(\\xi_i^2 + \\xi_i\\Delta\\xi + \\frac{1}{3}\\Delta\\xi^2 - \\xi_i^2 - \\xi_i\\Delta\\xi - \\frac{1}{4}\\Delta\\xi^2\\right) \\right]\n$$\n$$\nE_{ij} = \\Delta\\xi\\Delta\\eta \\left[ -2\\alpha\\beta\\left(\\frac{1}{3}\\Delta\\xi^2 - \\frac{1}{4}\\Delta\\xi^2\\right) \\right]\n$$\n$$\nE_{ij} = \\Delta\\xi\\Delta\\eta \\left[ -2\\alpha\\beta\\left(\\frac{4-3}{12}\\Delta\\xi^2\\right) \\right] = \\Delta\\xi\\Delta\\eta \\left( -2\\alpha\\beta \\frac{\\Delta\\xi^2}{12} \\right)\n$$\n$$\nE_{ij} = -\\frac{2}{12}\\alpha\\beta\\,\\Delta\\xi^3\\Delta\\eta = -\\frac{1}{6}\\alpha\\beta\\,\\Delta\\xi^3\\Delta\\eta\n$$\n问题要求最终答案用 $M$ 和 $N$ 表示。我们代入 $\\Delta\\xi = \\frac{1}{M}$ 和 $\\Delta\\eta = \\frac{1}{N}$：\n$$\nE_{ij} = -\\frac{1}{6}\\alpha\\beta\\left(\\frac{1}{M}\\right)^3\\left(\\frac{1}{N}\\right) = -\\frac{\\alpha\\beta}{6M^3N}\n$$\n误差与单元索引 $i$ 和 $j$ 无关。这是因为被积函数 $J(\\xi,\\eta)$ 在每个变量上是次数最多为 2 的多项式，而中点法则的误差取决于二阶导数，对于这个特定的雅可比函数，二阶导数是常数（$J_{\\xi\\xi} = -4\\alpha\\beta$ 且 $J_{\\eta\\eta}=0$）。", "answer": "$$\\boxed{-\\frac{\\alpha\\beta}{6M^{3}N}}$$", "id": "3362222"}, {"introduction": "椭圆方法的主要优势在于能够精确控制网格属性，这与代数方法相比是一个巨大的进步。本练习将引导我们探索一个更高级的概念——“反向问题”：我们不再被动接受一个给定方法生成的网格，而是主动规定我们期望的网格属性（例如，通过目标雅可比行列式 $J_{\\star}$ 来控制单元面积分布），然后求解生成该网格所需的映射函数。这项实践将展示如何通过线性化和亥姆霍兹分解等数学工具，将这个复杂的控制问题转化为一个可解的泊松方程系统，从而揭示椭圆偏微分方程与高级网格控制之间的深刻联系。[@problem_id:3362226]", "problem": "考虑一个二维映射，它从具有坐标 $(x,y)$ 的单连通物理域 $\\Omega \\subset \\mathbb{R}^{2}$ 映射到计算坐标 $(\\xi,\\eta)$，该映射用于求解偏微分方程（PDE）的椭圆网格生成中。令 $\\boldsymbol{\\xi}(x,y) = (\\xi(x,y),\\eta(x,y))$ 表示从物理空间到计算空间的逆映射，并令逆雅可比行列式为 $J^{-1}(x,y) = \\det\\!\\left(\\nabla \\boldsymbol{\\xi}(x,y)\\right)$，其中 $\\nabla \\boldsymbol{\\xi}$ 是 $2\\times 2$ 的雅可比矩阵 $\\partial(\\xi,\\eta)/\\partial(x,y)$。\n\n要求您探究逆规定问题：给定一个光滑且严格为正的目标雅可比场 $J_{\\star}(x,y)0$，推导一个关于辅助势的类泊松系统，该系统的解能够产生 $(\\xi,\\eta)$，使得 $\\det\\!\\left(\\nabla \\boldsymbol{\\xi}\\right)^{-1} = J_{\\star}$ 在主阶上近似成立，并分析相应的可解性约束（可积性条件）。\n\n从以下基本出发点开始：\n- 光滑映射的雅可比行列式的定义及其在局部面积变化中的作用：对于任何子域 $U \\subset \\Omega$，$\\int_{U}\\det\\!\\left(\\nabla \\boldsymbol{\\xi}\\right)\\,\\mathrm{d}x\\,\\mathrm{d}y$ 等于 $\\boldsymbol{\\xi}(U)$ 在计算空间中的面积。\n- 围绕恒等映射的线性化：记 $\\xi(x,y) = x + u(x,y)$ 和 $\\eta(x,y) = y + v(x,y)$，其中 $u$ 和 $v$ 足够光滑且 $|\\nabla u|+|\\nabla v|$ 很小。\n- 二维向量场 $\\boldsymbol{w}=(u,v)$ 的 Helmholtz 分解：存在标量势 $p$ 和 $q$，使得 $\\boldsymbol{w} = \\nabla p + \\nabla^{\\perp}q$，其中 $\\nabla p = (p_{x},p_{y})$ 且 $\\nabla^{\\perp}q=(-q_{y},q_{x})$。\n\n任务：\n1. 在线性化拟设下，并仅使用上述基本出发点，推导一个关于势 $(p,q)$ 的类泊松系统，该系统强制 $\\det\\!\\left(\\nabla \\boldsymbol{\\xi}\\right)^{-1} \\approx J_{\\star}$ 对 $u$ 和 $v$ 的导数近似到一阶。简要解释 $q$ 在近共形性中的作用。您的系统必须用 $\\Delta p$ 和 $\\Delta q$ 表示，其中 $\\Delta$ 表示在 $\\Omega$ 上的拉普拉斯算子。\n2. 在 $\\partial\\Omega$ 上的周期性边界条件下，即当 $(\\xi,\\eta)$ 及其所有导数在环面 $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ 上对 $x$ 和 $y$ 都是 $2\\pi$-周期时，陈述并论证该系统的可解性（可积性）条件。\n3. 将您的推导应用于特定目标场\n   $$J_{\\star}(x,y) = 1 + \\alpha \\cos(x)\\cos(y), \\quad |\\alpha|1,$$\n   在周期域 $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ 上，并选择与您的可积性条件一致的最简单的近共形规定。计算 $\\xi(x,y)$ 和 $\\eta(x,y)$ 关于 $\\alpha$、$x$ 和 $y$ 的显式主阶表达式，忽略 $\\alpha^{2}$ 及更高阶的项。\n\n您的最终答案必须是作为单个闭式解析表达式的数对 $(\\xi(x,y),\\eta(x,y))$。无需四舍五入。如果您呈现多个表达式，请在最终答案中使用 LaTeX $\\mathrm{pmatrix}$ 环境将它们写成单行。", "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且适定。\n\n### 步骤 1：提取已知条件\n- **映射：** $\\boldsymbol{\\xi}(x,y) = (\\xi(x,y), \\eta(x,y))$，从物理坐标 $(x,y)$ 到计算坐标 $(\\xi,\\eta)$。\n- **线性化拟设：** $\\xi(x,y) = x + u(x,y)$ 和 $\\eta(x,y) = y + v(x,y)$，其中位移场 $\\boldsymbol{w}=(u,v)$ 的一阶导数很小。\n- **Helmholtz 分解：** $\\boldsymbol{w} = \\nabla p + \\nabla^{\\perp}q$，这意味着 $u = p_x - q_y$ 且 $v = p_y + q_x$。此处，$\\nabla p = (p_x, p_y)$ 且 $\\nabla^{\\perp}q = (-q_y, q_x)$。\n- **目标条件：** $\\det(\\nabla \\boldsymbol{\\xi})^{-1} \\approx J_{\\star}(x,y)$，其中 $\\nabla \\boldsymbol{\\xi}$ 是雅可比矩阵 $\\frac{\\partial(\\xi,\\eta)}{\\partial(x,y)}$，且 $J_{\\star}(x,y)0$ 是给定的光滑目标场。逆映射雅可比的行列式定义为 $J^{-1}(x,y) \\equiv \\det(\\nabla \\boldsymbol{\\xi})$。该条件转化为 $J \\approx J_\\star$，其中 $J$ 是正向映射（从计算空间到物理空间）的雅可比行列式。\n- **任务3的特定情况：** 在周期域 $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ 上，$J_{\\star}(x,y) = 1 + \\alpha \\cos(x)\\cos(y)$ 且 $|\\alpha|1$。最终表达式应忽略 $\\mathcal{O}(\\alpha^2)$ 阶的项。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是适定的，并且在向量微积分、偏微分方程和数值网格生成领域具有坚实的科学基础。尽管符号密集，但定义是明确且一致的。线性化方法是一种标准的物理和数学技术。Helmholtz 分解的使用是恰当的。在给定条件 $|\\alpha|1$ 下，目标函数 $J_\\star$ 是光滑且严格为正的。在周期域上的设定是一个标准的边界值问题（BVP）设置。因此，该问题被认为是有效的。\n\n### 步骤 3：推导与求解\n\n**任务 1：类泊松系统的推导**\n\n我们首先计算逆映射雅可比矩阵 $\\nabla\\boldsymbol{\\xi}$ 的行列式。\n该映射由 $\\xi(x,y) = x + u(x,y)$ 和 $\\eta(x,y) = y + v(x,y)$ 给出。\n雅可比矩阵为：\n$$ \\nabla\\boldsymbol{\\xi} = \\begin{pmatrix} \\xi_x  \\xi_y \\\\ \\eta_x  \\eta_y \\end{pmatrix} = \\begin{pmatrix} 1 + u_x  u_y \\\\ v_x  1 + v_y \\end{pmatrix} $$\n其行列式为：\n$$ \\det(\\nabla\\boldsymbol{\\xi}) = (1+u_x)(1+v_y) - u_y v_x = 1 + u_x + v_y + u_x v_y - u_y v_x $$\n问题要求对 $u$ 和 $v$ 的导数近似到一阶。因此，我们忽略二次项 $u_x v_y$ 和 $u_y v_x$：\n$$ \\det(\\nabla\\boldsymbol{\\xi}) \\approx 1 + u_x + v_y = 1 + \\nabla \\cdot \\boldsymbol{w} $$\n其中 $\\boldsymbol{w} = (u,v)$。\n\n目标条件是 $\\det(\\nabla\\boldsymbol{\\xi})^{-1} \\approx J_{\\star}$，这意味着 $\\det(\\nabla\\boldsymbol{\\xi}) \\approx \\frac{1}{J_{\\star}}$。\n将 $\\det(\\nabla\\boldsymbol{\\xi})$ 的两个表达式相等，得到：\n$$ 1 + \\nabla \\cdot \\boldsymbol{w} \\approx \\frac{1}{J_{\\star}} \\implies \\nabla \\cdot \\boldsymbol{w} \\approx \\frac{1}{J_{\\star}} - 1 = \\frac{1 - J_{\\star}}{J_{\\star}} $$\n现在，我们将 Helmholtz 分解 $\\boldsymbol{w} = \\nabla p + \\nabla^{\\perp}q$ 代入散度表达式中。\n$\\boldsymbol{w}$ 的分量为 $u = p_x - q_y$ 和 $v = p_y + q_x$。\n散度 $\\nabla \\cdot \\boldsymbol{w}$ 为：\n$$ \\nabla \\cdot \\boldsymbol{w} = u_x + v_y = (p_x - q_y)_x + (p_y + q_x)_y = p_{xx} - q_{yx} + p_{yy} + q_{xy} $$\n假设势 $p$ 和 $q$ 足够光滑，使得混合偏导数相等（即 $q_{xy}=q_{yx}$），则上式简化为：\n$$ \\nabla \\cdot \\boldsymbol{w} = p_{xx} + p_{yy} = \\Delta p $$\n其中 $\\Delta$ 是拉普拉斯算子。\n这得到了我们系统的第一个方程，即关于势 $p$ 的泊松方程：\n$$ \\Delta p = \\frac{1 - J_{\\star}(x,y)}{J_{\\star}(x,y)} $$\n为获得关于 $(p,q)$ 的系统，我们必须指定一个关于 $q$ 的方程。这与近共形性要求有关。如果一个映射局部保角，则它是共形的。对于线性化映射，这近似等价于位移场 $\\boldsymbol{w}=(u,v)$ 满足类柯西-黎曼方程 $u_x=v_y$ 和 $u_y=-v_x$。\n让我们考虑位移场 $\\boldsymbol{w}$ 的旋度：\n$$ \\nabla \\times \\boldsymbol{w} = v_x - u_y = (p_y + q_x)_x - (p_x - q_y)_y = p_{yx} + q_{xx} - p_{xy} + q_{yy} = q_{xx} + q_{yy} = \\Delta q $$\n量 $\\nabla \\times \\boldsymbol{w}$ 度量了映射的局部无穷小旋转。严格的共形映射其网格线的局部旋转为零。因此，为实现近共形性，很自然地要求位移场的旋转部分很小。最简单的规定是将其设为零，这意味着使位移场 $\\boldsymbol{w}$ 成为无旋场。这给出了我们系统的第二个方程：\n$$ \\Delta q = 0 $$\n因此，得到的关于势 $(p,q)$ 的类泊松系统是：\n$$ \\Delta p = \\frac{1 - J_{\\star}(x,y)}{J_{\\star}(x,y)} $$\n$$ \\Delta q = 0 $$\n势 $q$ 控制位移场 $\\boldsymbol{w}$ 的螺线（无散）部分，该部分对应于局部旋转。设置 $\\Delta q=0$ 确保位移场是无旋的（$\\nabla \\times \\boldsymbol{w}=0$），这是共形性的一个基本组成部分，并能促进网格正交性。\n\n**任务 2：可解性条件**\n\n我们分析在具有周期性边界条件的域 $\\Omega$ 上泊松方程 $\\Delta \\phi = F(x,y)$ 的可解性。通过对等式两边在整个域上积分，并应用散度定理（或格林第二恒等式）：\n$$ \\iint_{\\Omega} \\Delta \\phi \\,dx\\,dy = \\oint_{\\partial\\Omega} (\\nabla\\phi) \\cdot \\boldsymbol{n} \\,dS $$\n其中 $\\boldsymbol{n}$ 是边界 $\\partial\\Omega$ 的外单位法向量。\n对于周期域 $\\Omega=[0,2\\pi]\\times[0,2\\pi]$，边界积分为：\n$$ \\int_0^{2\\pi} [\\phi_x(2\\pi,y) - \\phi_x(0,y)]\\,dy + \\int_0^{2\\pi} [\\phi_y(x,2\\pi) - \\phi_y(x,0)]\\,dx $$\n由于 $\\phi$ 的所有导数都满足周期性边界条件，我们有 $\\phi_x(2\\pi,y)=\\phi_x(0,y)$ 和 $\\phi_y(x,2\\pi)=\\phi_y(x,0)$。因此，边界积分为零。\n这导出了可解性（或可积性）条件，即所谓的 Fredholm 择一性：\n$$ \\iint_{\\Omega} F(x,y) \\,dx\\,dy = 0 $$\n将此条件应用于我们的系统：\n1.  对于方程 $\\Delta p = \\frac{1-J_{\\star}}{J_{\\star}}$，可解性条件是：\n    $$ \\iint_{\\Omega} \\frac{1 - J_{\\star}(x,y)}{J_{\\star}(x,y)} \\,dx\\,dy = 0 $$\n    该条件对规定的目标雅可比场 $J_{\\star}$ 施加了一个约束。\n2.  对于方程 $\\Delta q = 0$，源项为 $F(x,y) = 0$。条件 $\\iint_{\\Omega} 0 \\,dx\\,dy = 0$ 被平凡满足，因此 $q$ 的解总是存在的（在相差一个加性常数的情况下）。\n\n**任务 3：应用于特定情况**\n\n给定 $J_{\\star}(x,y) = 1 + \\alpha \\cos(x)\\cos(y)$ 在 $\\Omega=[0,2\\pi]\\times[0,2\\pi]$ 上，且我们必须忽略 $\\mathcal{O}(\\alpha^2)$ 阶的项。\n$\\Delta p$ 方程的源项是 $F(x,y) = \\frac{1-J_{\\star}}{J_{\\star}} = \\frac{1 - (1 + \\alpha \\cos(x)\\cos(y))}{1 + \\alpha \\cos(x)\\cos(y))} = \\frac{-\\alpha \\cos(x)\\cos(y)}{1 + \\alpha \\cos(x)\\cos(y)}$。\n由于 $|\\alpha|1$，我们可以使用几何级数 $1/(1+z) = 1 - z + z^2 - \\dots$ 对其进行展开：\n$$ F(x,y) = -\\alpha \\cos(x)\\cos(y) \\left(1 - \\alpha \\cos(x)\\cos(y) + \\mathcal{O}(\\alpha^2)\\right) = -\\alpha \\cos(x)\\cos(y) + \\mathcal{O}(\\alpha^2) $$\n按照指示截断到 $\\alpha$ 的一阶，该偏微分方程组变为：\n$$ \\Delta p = -\\alpha \\cos(x)\\cos(y) $$\n$$ \\Delta q = 0 $$\n我们检查 $p$ 方程的可解性条件：\n$$ \\iint_{\\Omega} -\\alpha \\cos(x)\\cos(y) \\,dx\\,dy = -\\alpha \\left(\\int_0^{2\\pi} \\cos(x)\\,dx\\right) \\left(\\int_0^{2\\pi} \\cos(y)\\,dy\\right) = -\\alpha \\cdot 0 \\cdot 0 = 0 $$\n该条件得到满足。\n\n现在我们求解具有周期性边界条件的偏微分方程。\n在周期域上，$\\Delta q = 0$ 的解为任意常数，即 $q(x,y) = C_q$。由于位移场仅取决于 $q$ 的导数，我们可以不失一般性地选择 $C_q = 0$。\n对于 $p$ 方程，我们寻求一个形如 $p(x,y) = A \\cos(x)\\cos(y)$ 的特解。\n$$ \\Delta p = \\frac{\\partial^2}{\\partial x^2}(A \\cos(x)\\cos(y)) + \\frac{\\partial^2}{\\partial y^2}(A \\cos(x)\\cos(y)) $$\n$$ \\Delta p = -A \\cos(x)\\cos(y) - A \\cos(x)\\cos(y) = -2A \\cos(x)\\cos(y) $$\n与源项比较，$-2A \\cos(x)\\cos(y) = -\\alpha \\cos(x)\\cos(y)$，我们得到 $A = \\frac{\\alpha}{2}$。\n$p$ 的通解为 $p(x,y) = \\frac{\\alpha}{2} \\cos(x)\\cos(y) + C_p$，其中 $C_p$ 是一个常数（齐次解）。\n\n最后，我们计算位移场 $(u,v)$ 和映射 $(\\xi,\\eta)$。\n$$ u(x,y) = p_x - q_y = \\frac{\\partial}{\\partial x}\\left(\\frac{\\alpha}{2} \\cos(x)\\cos(y)\\right) - 0 = -\\frac{\\alpha}{2} \\sin(x)\\cos(y) $$\n$$ v(x,y) = p_y + q_x = \\frac{\\partial}{\\partial y}\\left(\\frac{\\alpha}{2} \\cos(x)\\cos(y)\\right) + 0 = -\\frac{\\alpha}{2} \\cos(x)\\sin(y) $$\n常数 $C_p$ 对位移场没有贡献。\n$\\xi(x,y)$ 和 $\\eta(x,y)$ 的主阶表达式为：\n$$ \\xi(x,y) = x + u(x,y) = x - \\frac{\\alpha}{2} \\sin(x)\\cos(y) $$\n$$ \\eta(x,y) = y + v(x,y) = y - \\frac{\\alpha}{2} \\cos(x)\\sin(y) $$\n这些表达式给出了在 $\\alpha$ 主阶上所需的映射。", "answer": "$$ \\boxed{ \\begin{pmatrix} x - \\frac{\\alpha}{2} \\sin(x)\\cos(y)  y - \\frac{\\alpha}{2} \\cos(x)\\sin(y) \\end{pmatrix} } $$", "id": "3362226"}]}