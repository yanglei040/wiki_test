## 引言
在不可压缩流动的[数值模拟](@entry_id:137087)中，压力与[速度场](@entry_id:271461)的耦合求解是一个经典且核心的难题。由于连续性方程中缺少压力项，控制方程呈现出独特的[鞍点](@entry_id:142576)结构，这使得直接耦合求解的计算成本极为高昂。为应对这一挑战，以SIMPLE和SIMPLER算法为代表的分离式求解方法应运而生，它们通过迭代解耦的方式，极大地提高了求解效率和鲁棒性，成为计算流体动力学（CFD）领域的基石。

本文旨在系统性地剖析SIMPLE及其改进算法。在“原理与机制”章节中，我们将深入探讨[压力-速度耦合](@entry_id:155962)的根源，详细拆解SIMPLE算法的预测-校正步骤、压力校正方程的推导，并解释为解决[同位网格](@entry_id:175200)难题而生的[Rhie-Chow插值](@entry_id:154759)。我们还将对比SIMPLER算法在迭代策略上的改进。随后的“应用与交叉学科联系”章节将视野拓宽，展示这些算法如何扩展至非定常、[湍流](@entry_id:151300)和传热等复杂物理情境，并揭示其与[固体力学](@entry_id:164042)、[高性能计算](@entry_id:169980)等领域的深刻联系。最后，在“动手实践”章节中，读者将通过一系列精心设计的问题，将理论知识应用于[代码验证](@entry_id:146541)、算法性能评估等实际任务中。

通过本文的学习，读者将不仅掌握SIMPLE族算法的工作原理，更将理解其在现代计算科学中的广泛应用和深远影响。让我们首先从其最核心的原理与机制开始探索。

## 原理与机制

在不可压缩流动的数值模拟中，一个核心的挑战源于控制方程的数学特性。与[可压缩流](@entry_id:747589)动不同，[不可压缩流](@entry_id:140301)动的密度 $\rho$ 是一个常数，这意味着不存在直接将压力 $p$ 与[密度关联](@entry_id:157860)的状态方程。因此，压力不再是一个[热力学变量](@entry_id:160587)，而是扮演一个更为微妙的角色。本章将深入探讨[压力-速度耦合](@entry_id:155962)的根本挑战，并系统地阐述用于解决该挑战的经典分离式算法——SIMPLE及其改进版SIMPLER的原理和机制。

### [不可压缩流](@entry_id:140301)中的[压力-速度耦合](@entry_id:155962)挑战

[不可压缩流](@entry_id:140301)动的控制方程由[动量方程](@entry_id:197225)和[连续性方程](@entry_id:195013)组成。动量方程描述了流体运动如何响应各种力（包括压力梯度、粘性力和[体力](@entry_id:174230)），而连续性方程则施加了一个[运动学](@entry_id:173318)约束：速度场 $\mathbf{u}$ 的散度必须为零，即 $\nabla \cdot \mathbf{u} = 0$。

这个约束是瞬时的、全局的。流场中的任何变化都必须立即调整，以确保在每个点上流入的质量等于流出的质量。压[力场](@entry_id:147325) $p$ 正是实现这种协调的关键。它会瞬时地调整自身，以产生恰当的[压力梯度力](@entry_id:262279)，从而引导[速度场](@entry_id:271461) $\mathbf{u}$ 满足[无散度约束](@entry_id:748603)。从数学角度看，压力 $p$ 的作用等同于一个**拉格朗日乘子**，其任务是强制执行 $\nabla \cdot \mathbf{u} = 0$ 这一[运动学](@entry_id:173318)约束。

当我们将控制方程离散化，例如使用有限体积法时，这种结构变得尤为清晰。如果我们将所有离散的速度和压力未知数写成一个大的[线性系统](@entry_id:147850)，其矩阵形式会呈现出一种特殊的**[鞍点](@entry_id:142576)结构** [@problem_id:3442959]：

$$
\begin{pmatrix}
\mathbf{A} & \mathbf{G} \\
\mathbf{D} & \mathbf{0}
\end{pmatrix}
\begin{pmatrix}
\mathbf{U} \\
\mathbf{P}
\end{pmatrix}
=
\begin{pmatrix}
\mathbf{F} \\
\mathbf{0}
\end{pmatrix}
$$

在此系统中，$\mathbf{U}$ 和 $\mathbf{P}$ 分别是离散速度和压力的向量。$\mathbf{A}$ 代表离散化的[对流-扩散](@entry_id:148742)算子，$\mathbf{G}$ 是[离散梯度](@entry_id:171970)算子（将[压力梯度](@entry_id:274112)应用于动量方程），而 $\mathbf{D}$ 则是离散[散度算子](@entry_id:265975)（施加连续性约束）。最引人注目的是压力-压力块（$\mathbf{P}$-$\mathbf{P}$ 块）中的[零矩阵](@entry_id:155836) $\mathbf{0}$。这明确地表明，[连续性方程](@entry_id:195013)本身不包含压力项，进一步印证了压力作为拉格朗日乘子的角色。

直接求解这个大型的、耦合的[鞍点系统](@entry_id:754480)是可能的，但计算成本高昂且数值上具有挑战性。因此，在计算流体动力学（CFD）的实践中，**分离式算法**（segregated algorithms）应运而生。这类算法的核心思想是将压力和速度的求解过程[解耦](@entry_id:637294)，通过迭代的方式逐步逼近满足所有方程的解。SIMPLE及其变体就是这类算法中最著名和最广泛应用的代表。

### 预测-校正策略：分离式求解的核心

分离式算法普遍采用一种**预测-校正**（predictor-corrector）的迭代策略。其基本逻辑如下：

1.  **预测步（Predictor Step）**：首先，我们猜测一个压[力场](@entry_id:147325) $p^*$（在第一次迭代中是初始猜测，后续迭代中是上一轮的结果）。然后，利用这个猜测的压[力场](@entry_id:147325)来求解离散化的[动量方程](@entry_id:197225)，得到一个临时的、中间速度场 $\mathbf{u}^*$。这个速度场 $\mathbf{u}^*$ 满足了[动量平衡](@entry_id:193575)（在 $p^*$ 的作用下），但通常不满足连续性方程，即 $\nabla \cdot \mathbf{u}^* \neq 0$。

2.  **校正步（Corrector Step）**：接下来，我们的目标是找到一组校正量——压力校正值 $p'$ 和速度校正值 $\mathbf{u}'$。这些校正量需要使得校正后的场（$p = p^* + p'$ 和 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$）能够同时满足动量方程和[连续性方程](@entry_id:195013)。核心任务是建立 $p'$ 和 $\mathbf{u}'$ 之间的关系，并利用连续性约束 $\nabla \cdot \mathbf{u} = 0$ 来求解 $p'$。

SIMPLE 和 SIMPLER 算法遵循这一基本框架，但它们在如何推导和求解校正方程，以及整个迭代循环的组织方式上有所不同。

### SIMPLE 算法 (压力耦合[方程组](@entry_id:193238)的[半隐式方法](@entry_id:200119))

SIMPLE (Semi-Implicit Method for Pressure-Linked Equations) 算法是 Patankar 和 Spalding 在 20 世纪 70 年代提出的经典算法。它通过一系列清晰的步骤实现了预测-校正策略 [@problem_id:3443059]。

#### 1. 动量预测

在一个迭代步开始时，我们使用当前的压[力场](@entry_id:147325) $p^*$ 求解离散动量方程，得到预测[速度场](@entry_id:271461) $\mathbf{u}^*$。对于一个[控制体](@entry_id:143882) $P$，其离散动量方程可写为：
$$
a_P \mathbf{u}_P^* = \sum_{N} a_N \mathbf{u}_N^* + \mathbf{b}_P - \nabla p_P^*
$$
这里，$a_P$ 是中心系数，$a_N$ 是相邻节点的系数，$\mathbf{b}_P$ 包含了源项和其他显式部分，$\nabla p_P^*$ 是作用在控制体 $P$ 上的离散[压力梯度](@entry_id:274112)。

#### 2. 压力校正方程的推导

这是 SIMPLE 算法的核心。我们的目标是找到一个关于压力校正值 $p'$ 的方程。推导过程如下 [@problem_id:3442964]：

首先，我们写出最终的、正确的速度 $\mathbf{u}$ 和压力 $p$ 应满足的[动量方程](@entry_id:197225)：
$$
a_P \mathbf{u}_P = \sum_{N} a_N \mathbf{u}_N + \mathbf{b}_P - \nabla (p_P^* + p_P')
$$
将此式减去预测步的动量方程，我们得到一个关于速度校正值 $\mathbf{u}'_P = \mathbf{u}_P - \mathbf{u}_P^*$ 和邻居速度校正值 $\mathbf{u}'_N$ 的精确关系：
$$
a_P \mathbf{u}'_P = \sum_{N} a_N \mathbf{u}'_N - \nabla p_P'
$$
为了得到一个易于求解的、关于 $p'$ 的方程，SIMPLE 算法引入了一个关键的**近似**：它忽略了邻居速度校正项的贡献，即假设 $\sum_{N} a_N \mathbf{u}'_N \approx 0$。这个近似的理由是，[速度场](@entry_id:271461)的主要校正驱动力来自于压力校正，邻居速度校正的耦合效应被视为次要的。

通过这个近似，我们得到了一个简化的、局部的速度校正和压力校正梯度之间的关系：
$$
a_P \mathbf{u}'_P \approx - \nabla p_P' \quad \implies \quad \mathbf{u}'_P \approx -(a_P)^{-1} \nabla p_P'
$$
现在，我们将这个关系代入必须被最终[速度场](@entry_id:271461)满足的连续性方程 $\nabla \cdot \mathbf{u} = 0$：
$$
\nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0 \quad \implies \quad \nabla \cdot \mathbf{u}' = - \nabla \cdot \mathbf{u}^*
$$
$$
\nabla \cdot (-(a_P)^{-1} \nabla p') = - \nabla \cdot \mathbf{u}^*
$$
这就形成了一个关于压力校正值 $p'$ 的**泊松型方程**。该方程的源项 $- \nabla \cdot \mathbf{u}^*$ 正是预测速度场 $\mathbf{u}^*$ 在每个[控制体](@entry_id:143882)中的质量不平衡量（或称连续性方程的残差）。这个方程是椭圆形的，意味着一个点的 $p'$ 会受到整个计算域的影响，这与压[力场](@entry_id:147325)的物理特性相符。

#### 3. 校正与亚松弛

求解上述[泊松方程](@entry_id:143763)得到 $p'$ 场后，我们就可以校正压力和速度场：

- **压力校正**: $p^{\text{new}} = p^* + \alpha_p p'$
- **速度校正**: $\mathbf{u}^{\text{new}} = \mathbf{u}^* + \mathbf{u}'$ （其中 $\mathbf{u}'$ 由 $p'$ 计算得到）

这里，$\alpha_p$ 是一个**亚松弛因子**（under-relaxation factor），通常取值在 $(0, 1)$ 之间。引入亚松弛是**至关重要**的，因为我们在推导压力校正方程时忽略了 $\sum a_N \mathbf{u}'_N$ 项。这一近似导致计算出的 $p'$ 往往被“高估”。如果不加以抑制，直接将完整的 $p'$ 添加到压[力场](@entry_id:147325)，会导致迭代过程产生剧烈[振荡](@entry_id:267781)甚至发散。因此，亚松弛通过限制每次迭代的修正幅度来稳定整个分离式求解过程 [@problem_id:3442959]。

通过一个具体的例子可以更好地理解压力校正方程的装配和作用。考虑一个一维问题，离散的连续性方程要求每个[控制体](@entry_id:143882) $P$ 的净[质量流](@entry_id:143424)量为零。在校正步骤中，这意味着预测步的净[质量流](@entry_id:143424)出（残差 $R_P$）必须由校正质量流 $m_f'$ 来平衡：$\sum_f m_f' = -R_P$ [@problem_id:3442981]。每个面上的[质量流](@entry_id:143424)校正 $m_f'$ 又与该面两侧的压力校正值 $p'$ 成正比，例如 $m_f' = D_f(p'_P - p'_N)$。将此关系代入每个控制体的[质量平衡方程](@entry_id:178786)，就形成了一个关于所有 $p'$ 未知数的[线性方程组](@entry_id:148943)。求解该[方程组](@entry_id:193238)，我们便能确保校正后的[速度场](@entry_id:271461)满足离散的质量守恒。

### [同位网格](@entry_id:175200)的挑战与 Rhie-Chow 插值

早期的 SIMPLE 算法大多在**交错网格**（staggered grid）上实现，即压力存储在控制体中心，而速度分量存储在控制体的面上。这种布置天然地形成了紧密的[压力-速度耦合](@entry_id:155962)，因为压力差直接驱动穿过它们之间的面的速度。

然而，对于复杂几何，[交错网格](@entry_id:147661)的记账和实现都非常繁琐。因此，**[同位网格](@entry_id:175200)**（collocated grid），即将所有变量（压力和所有速度分量）都存储在[控制体](@entry_id:143882)中心，变得更受欢迎。但这引入了一个新的、严重的问题：**[压力-速度解耦](@entry_id:167545)**（pressure-velocity decoupling）。

在[同位网格](@entry_id:175200)上，如果采用简单的[线性插值](@entry_id:137092)来计算面上的速度（例如，取相邻两个单元中心速度的平均值），离散的压力梯度算子可能无法“感知”到一种棋盘状（checkerboard）的非物理压[力场](@entry_id:147325) [@problem_id:3442965]。例如，在一个一维网格上，一个形如 $p_i = p_0 + (-1)^i \delta p$ 的压[力场](@entry_id:147325)，其在每个单元中心 $i$ 的[中心差分](@entry_id:173198)梯度 $\frac{p_{i+1}-p_{i-1}}{2\Delta x}$ 将会是零。这意味着，动量方程对这种高频、[振荡](@entry_id:267781)的[压力模](@entry_id:159654)式完全不敏感。反过来，这也导致连续性方程无法抑制这种虚假的[压力模](@entry_id:159654)式，从而在解中产生严重的“棋盘”[振荡](@entry_id:267781)。

为了解决这个问题，**Rhie-Chow 插值**被提了出来。其核心思想是，不直接插值速度，而是插值构成速度的各个部分。回顾动量方程的重排形式：$\mathbf{u}_P = (a_P)^{-1} \mathbf{H}_P - (a_P)^{-1} \nabla p_P$，其中 $\mathbf{H}_P$ 代表非压力项。Rhie-Chow 方法构造面上的速度时，会对动量预测部分 $\mathbf{u}^* \equiv (a_P)^{-1} \mathbf{H}_P$ 进行插值，但对压力梯度部分则采用更精细的处理 [@problem_id:3443010]。

一个一致的 Rhie-Chow 插值形式的面法向速度 $u_f$ 如下 [@problem_id:3442965]：
$$
u_f = \overline{\left( \frac{\mathbf{H}}{a} \right)_f} \cdot \mathbf{n}_f - \overline{\left( \frac{1}{a} \right)_f} (\nabla p)_f \cdot \mathbf{n}_f
$$
这里，上划线 $\overline{(\cdot)}_f$ 表示从相邻单元中心到面的[线性插值](@entry_id:137092)，而 $(\nabla p)_f$ 是直接在面上计算的压力梯度，例如，其法向分量可近似为 $\frac{p_N - p_P}{\delta_f}$（其中 $\delta_f$ 是单元中心间距）。关键在于，即使[中心差分](@entry_id:173198)的压力梯度 $\overline{(\nabla p)_P}$ 对棋盘模式不敏感，面上的压力梯度项 $\frac{p_N - p_P}{\delta_f}$ 却能准确地捕捉到相邻单元的压力差。通过这种方式，面速度和质量通量被直接与相邻单元的压力差紧密耦合起来，从而有效抑制了非物理的压力[振荡](@entry_id:267781)。

在现代 CFD 计算中，Rhie-Chow 插值或其变体已成为在[同位网格](@entry_id:175200)上实现 SIMPLE 类算法的标准实践 [@problem_id:3442959]。

### SIMPLER 算法 (SIMPLE Revised)

尽管 SIMPLE 算法非常成功，但其[收敛速度](@entry_id:636873)可能较慢，且严重依赖于亚松弛因子的选择。SIMPLER (SIMPLE Revised) 算法是对其的改进，旨在通过计算一个更准确的压[力场](@entry_id:147325)来加速收敛 [@problem_id:3443036]。

SIMPLER 算法的迭代循环与 SIMPLE 有显著不同，其核心是**在一个迭代步中求解两次类泊松方程**：一次为压力本身，一次为压力校正 [@problem_id:3443067]。

#### 1. 压力方程的求解

SIMPLER 迭代的第一步是求解一个关于**压力本身 $p$** 的方程。这个方程的推导方式与 SIMPLE 中的压力校正方程类似，但出发点不同。我们再次从重排的离散[动量方程](@entry_id:197225)出发：
$$
\mathbf{u}_P = \frac{\sum_N a_N \mathbf{u}_N + \mathbf{b}_P}{a_P} - \frac{1}{a_P} \nabla p_P
$$
我们将上式记为 $\mathbf{u}_P = \hat{\mathbf{u}}_P - d_P \nabla p_P$，其中 $\hat{\mathbf{u}}_P$ 代表了除压力梯度外所有项的贡献。SIMPLER 的关键思想是，将这个速度表达式代入[连续性方程](@entry_id:195013) $\nabla \cdot \mathbf{u} = 0$：
$$
\nabla \cdot (\hat{\mathbf{u}} - d \nabla p) = 0 \quad \implies \quad \nabla \cdot (d \nabla p) = \nabla \cdot \hat{\mathbf{u}}
$$
这就构成了一个关于压力 $p$ 的泊松方程。在求解此方程时，$\hat{\mathbf{u}}$ 中的邻居速度 $\mathbf{u}_N$ 通常采用上一次迭代的值。求解这个方程，我们能得到一个当前迭代步中对真实压[力场](@entry_id:147325)的更优估计。

#### 2. 动量预测

得到这个改进的压[力场](@entry_id:147325) $p$ 后，SIMPLER 用它来求解动量方程，得到预测速度场 $\mathbf{u}^*$。由于所用的压[力场](@entry_id:147325)比 SIMPLE 中的 $p^*$ 更准确，这个 $\mathbf{u}^*$ 场的质量更高，即其不满足连续性的程度（散度）会更小。

#### 3. 速度校正

尽管 $\mathbf{u}^*$ 是用更好的压[力场](@entry_id:147325)计算的，但由于我们在第一步求解压力方程时对 $\hat{\mathbf{u}}$ 进行了近似（使用了旧的邻居速度），所以 $\mathbf{u}^*$ 仍然不会精确满足连续性方程。因此，SIMPLER 仍然需要一个校正步骤。

这一步与 SIMPLE 中的校正步骤几乎完全相同：求解一个压力校正方程 $\nabla \cdot (d \nabla p') = - \nabla \cdot \mathbf{u}^*$ 来得到 $p'$。然而，一个**至关重要的区别**在于，这个 $p'$ **仅用于校正速度场**，以确保最终的速度场满足连续性约束。压[力场](@entry_id:147325)本身并**不**使用 $p'$ 来更新。进入下一个迭代步的压[力场](@entry_id:147325)，是第一步中求解得到的压力 $p$。

#### SIMPLER 算法总结

SIMPLER 的迭代循环可以总结为 [@problem_id:3443067]：
1.  **求解压力方程**：利用动量系数和上一迭代步的速度，建立并求解一个关于压力 $p$ 的方程，得到一个改进的压[力场](@entry_id:147325)。
2.  **动量预测**：使用这个改进的压[力场](@entry_id:147325) $p$ 求解[动量方程](@entry_id:197225)，得到预测速度 $\mathbf{u}^*$。
3.  **速度校正**：建立并求解一个关于压力校正值 $p'$ 的方程，但仅用其结果来校正速度场（$\mathbf{u} \leftarrow \mathbf{u}^* + \mathbf{u}'(p')$），而不更新压[力场](@entry_id:147325)。

由于 SIMPLER 在每个迭代步的开始就致力于获得一个更好的压[力场](@entry_id:147325)，它所需要的速度校正量通常比 SIMPLE 小得多。这往往能带来更快的整体收敛速度和更好的鲁棒性，尽管每个迭代步的计算成本（由于求解了两次泊松方程）更高 [@problem_id:3442959]。

### 比较与扩展

- **SIMPLE vs. SIMPLER**: SIMPLE 算法结构更简单，每次迭代计算量小，但收敛可能较慢且依赖亚松弛。SIMPLER 算法每次迭代计算量大，但通常能以更少的迭代次数达到收敛，尤其是在某些流动问题中表现更稳定。例如，在[扩散](@entry_id:141445)主导的流动中（低[佩克莱数](@entry_id:141791) $\mathrm{Pe}$），SIMPLE 的近似较差，SIMPLER 的优势可能更为明显 [@problem_id:3443069]。

- **SIMPLEC (SIMPLE-Consistent)**: SIMPLEC 是对 SIMPLE 的一个直接改进。它在推导速度校正关系时，对邻居速度校正项 $\sum a_N \mathbf{u}'_N$ 做了更一致的近似，而不是完全忽略。这通常能提高算法的收敛速度，并允许使用更大的压力亚松弛因子（甚至为1），从而增强了[耦合强度](@entry_id:275517) [@problem_id:3443065]。

- **PISO (Pressure-Implicit with Splitting of Operators)**: PISO 算法主要为瞬态问题设计。在 SIMPLE 的预测-校正步骤之后，它增加了第二个（甚至第三个）校正步骤。这些额外的校正步骤在不重新求解昂贵的动量方程的情况下，进一步修正速度和压力，以更严格地满足连续性方程。这使得 PISO 能够在每个时间步内实现更强的[压力-速度耦合](@entry_id:155962)，从而允许使用更大的时间步长 [@problem_id:3443065]。

总之，SIMPLE 算法及其变体（SIMPLER, SIMPLEC, PISO）构成了求解不可压缩流动的分离式方法家族。它们都基于预测-校正的思想，通过巧妙的代数操作，将[压力-速度耦合](@entry_id:155962)问题转化为一系列更易于处理的、[解耦](@entry_id:637294)的[方程组](@entry_id:193238)。理解它们的内在机制、近似假设以及各自的优缺点，对于在实际 CFD 应用中做出明智的算法选择至关重要。