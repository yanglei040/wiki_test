## 引言
在计算力学和工程仿真领域，精确模拟包含复杂几何特征（如裂纹、相界或[材料界面](@entry_id:751731)）的物理现象是一项长期存在的挑战。传统的有限元方法（FEM）在处理这类问题时，通常要求网格与这些特征的几何形状完全对齐，一旦特征发生演化（如裂纹扩展），就必须进行代价高昂且算法复杂的网格重剖分。为了克服这一瓶颈，一种更为强大和灵活的数值技术——广义/扩展有限元方法（GFEM/XFEM）应运而生。

本文旨在系统性地介绍XFEM的核心思想与实践。该方法基于[单位分解法](@entry_id:170899)（Partition of Unity Method, PUM）的坚实理论基础，通过“富集”而非“重剖分”的策略，从根本上解决了固定网格难以模拟[不连续性](@entry_id:144108)的难题。读者将通过本文学习到，如何利用这一优雅的框架，精确地求解那些对标准有限元构成严峻挑战的问题。

文章将分为三个部分展开：在“原理与机制”一章中，我们将深入探讨[单位分解法](@entry_id:170899)的数学基础，解释XFEM如何构建其富集逼近空间，并讨论针对不同物理现象的富集策略及实现中的关键技术细节。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示XFEM在[断裂力学](@entry_id:141480)、[地质力学](@entry_id:175967)、多物理场耦合等多个领域的强大应用。最后，在“动手实践”部分，通过一系列精心设计的问题，读者将有机会亲手应用所学知识，加深对节点富集、单元计算和方法内在机制的理解。

## Principles and Mechanisms

本章深入探讨了广义/扩展有限元方法（GFEM/XFEM）的核心原理与机制。我们将从该方法的理论基石——[单位分解法](@entry_id:170899)（Partition of Unity Method）——出发，系统地阐释如何通过“[单位分解](@entry_id:150115)”来增强标准有限元（FEM）的逼近能力，使其能够精确地模拟不连续和奇异性等复杂物理现象。随后，我们将详细介绍针对不同类型问题（如裂纹、[材料界面](@entry_id:751731)）的特定富集策略，并讨论在实际应用中必须解决的关键问题，如数值积分和方法权衡。

### [单位分解法](@entry_id:170899)：XFEM的理论基石

标准有限元方法构建的逼近空间通常由分片多项式函数构成，这使得它在求解光滑问题时表现优异。然而，当解包含不连续或奇异性时，例如在[断裂力学](@entry_id:141480)中的裂纹问题，标准[有限元法](@entry_id:749389)的收敛性会严重退化，除非网格与这些特征的几何完全对齐。这种对齐要求在模拟[特征演化](@entry_id:165250)（如[裂纹扩展](@entry_id:749562)）时，会导致代价高昂且算法复杂的反复网格重剖分。

扩展有限元方法通过[单位分解法](@entry_id:170899)（Partition of Unity Method, PUM）从根本上解决了这一难题。其核心思想不是去改变网格，而是通过增强逼近函数空间来使其能够“内在地”捕捉解的非光滑特性。

一个标准的有限元位移场逼近可以写为：
$$ \boldsymbol{u}^h(\boldsymbol{x}) = \sum_{i \in \mathcal{I}} N_i(\boldsymbol{x}) \boldsymbol{d}_i $$
其中，$\mathcal{I}$ 是网格中所有节点的集合，$N_i(\boldsymbol{x})$ 是与节点 $i$ 相关联的标准有限元形函数，$\boldsymbol{d}_i$ 是节点的位移自由度向量。这些形函数 $\{N_i\}$ 具备一个至关重要的性质，即 **单位分解（Partition of Unity, PU）** 性质：
$$ \sum_{i \in \mathcal{I}} N_i(\boldsymbol{x}) = 1, \quad \forall \boldsymbol{x} \in \Omega $$
其中 $\Omega$ 是计算域。该性质保证了标准有限元空间至少可以精确再生常数场，这是确保收敛性的基本要求。

PUM利用这一性质，通过将已知的、能够描述解的局部行为的函数（称为 **富集函数**，enrichment functions）与[单位分解](@entry_id:150115)形函数相乘，从而将这些行为“[植入](@entry_id:177559)”到逼近空间中 [@problem_id:3524275]。一个通用的XFEM逼近形式如下：
$$ \boldsymbol{u}^h(\boldsymbol{x}) = \underbrace{\sum_{i \in \mathcal{I}} N_i(\boldsymbol{x}) \boldsymbol{a}_i}_{\text{标准部分}} + \underbrace{\sum_{j \in \mathcal{J}} N_j(\boldsymbol{x}) \Psi(\boldsymbol{x}) \boldsymbol{b}_j}_{\text{富集部分}} $$
这里，$\{\boldsymbol{a}_i\}$ 是与标准[多项式逼近](@entry_id:137391)相关的自由度，$\mathcal{J} \subset \mathcal{I}$ 是被选择进行富集的节点[子集](@entry_id:261956)。$\Psi(\boldsymbol{x})$ 是一个全局定义的富集函数，它携带了我们希望模拟的特殊信息（如不连续性或奇异性）。$\{\boldsymbol{b}_j\}$ 是与富集部分相关的新增自由度。

通过这种方式，富集函数 $\Psi(\boldsymbol{x})$ 的非光滑特性被形函数 $N_j(\boldsymbol{x})$ 的局部支承（local support）特性所“局部化”。这意味着富集只在包含非光滑特征的区域（即富集节点 $j$ 的形函数支承域内）被激活，而远离该区域的逼近则退化为标准有限元形式。这一优雅的机制使得XFEM能够在不依赖网格对齐的情况下模拟裂纹等几何特征，从而避免了网格重剖分 [@problem_id:3524275]。

### 一致性、完备性与“混合单元”问题

PUM框架的一个关键理论优势是其 **一致性（consistency）** 和 **层次性（hierarchy）**。从上述逼近形式可以看出，通过将所有富集自由度 $\boldsymbol{b}_j$ 置零，XFEM逼近将自动退化为标准有限元逼近。这意味着富集后的逼近空间 $V_h^{\text{XFEM}}$ 是标准有限元空间 $V_h^{\text{FEM}}$ 的一个超集（$V_h^{\text{FEM}} \subset V_h^{\text{XFEM}}$）。这一特性保证了XFEM至少拥有与底层标准有限元相当的逼近能力，并且保留了其原有的[多项式再生](@entry_id:753580)能力和收敛性质 [@problem_id:2555194]。

更深入地，为了确保逼近空间的 **完备性（completeness）**，即能够精确再生特定函数的能力，富集函数本身需要满足一定条件。一个普遍的要求是，局部的富集[函数空间](@entry_id:143478)应能精确再生构成它的函数族。例如，若要确保逼近空间能够再生任意 $p$ 次多项式，一个充分条件是要求在每个节点处的局部逼近函数空间能够再生 $p$ 次多项式。这可以通过选择一组包含 $\mathbb{P}_p$（所有次数不超过 $p$ 的[多项式空间](@entry_id:144410)）的局部富集函数 $\{L_\alpha\}$ 来实现。要包含 $\mathbb{P}_p$ 这个维度为 $p+1$ 的空间，最少需要 $p+1$ 个线性无关的、连续的富集函数（例如，单项式 $\{1, s, s^2, \dots, s^p\}$）[@problem_id:3390105]。

然而，在富集区域与未富集区域的边界上，会出现一个微妙的问题。那些部分节点被富集、部分节点未被富集的单元，被称为 **混合单元（blending elements）** [@problem_id:2637815]。在这样一个单元 $e$ 中，仅与富集节点相关的形函数之和通常不为1，即 $\sum_{j \in \mathcal{J}_e} N_j(\boldsymbol{x}) \neq 1$，其中 $\mathcal{J}_e$ 是单元 $e$ 的富集节点集。这意味着富集[基函数](@entry_id:170178) $\{N_j(\boldsymbol{x}) \Psi(\boldsymbol{x})\}_{j \in \mathcal{J}_e}$ 失去了单位分解的完备性；它们无法精确再生富集函数 $\Psi(\boldsymbol{x})$ 本身，最多只能再生 $\left(\sum_{j \in \mathcal{J}_e} N_j(\boldsymbol{x})\right) \Psi(\boldsymbol{x})$。这种在富集边界上发生的完备性损失会破坏逼近质量，可能导致[收敛率](@entry_id:146534)下降。为了解决这个问题，需要引入一些修正技术，如使用光滑的过渡函数（ramp function）来调整富集，以恢复其完备性 [@problem_id:2555194] [@problem_id:2637815]。

### 富集策略：针对问题的量体裁衣

XFEM的威力在于能够为不同物理问题选择最合适的富集函数 $\Psi(\boldsymbol{x})$。富集函数的选择直接取决于待求解问题的解的局部特性。

#### 强[不连续性建模](@entry_id:165486)：Heaviside富集

当解本身在某个界面上发生跳跃时，我们称之为 **强不连续性（strong discontinuity）**。在数学上，这意味着解 $u$ 的跳跃值 $\llbracket u \rrbracket \neq 0$。这类解不属于标准的Sobolev空间 $H^1(\Omega)$。一个典型的物理例子是弹性体中裂纹两侧的位移场，其两侧的位移是不同的 [@problem_id:3390122]。

为了模拟这种跳跃，我们引入 **Heaviside富集函数**。该函数通常基于一个水平集函数（level set function）$\phi(\boldsymbol{x})$ 来定义，其中 $\phi(\boldsymbol{x})=0$ 表示不连续界面 $\Gamma$ 的位置。[Heaviside函数](@entry_id:176879) $H(\phi(\boldsymbol{x}))$ 定义为：
$$ H(\phi(\boldsymbol{x})) = \begin{cases} +1  \text{ if } \phi(\boldsymbol{x}) > 0 \\ -1  \text{ if } \phi(\boldsymbol{x})  0 \end{cases} $$
使用该函数，富集后的逼近形式为：
$$ u_h(\boldsymbol{x}) = \sum_{i \in \mathcal{I}} N_i(\boldsymbol{x}) a_i + \sum_{j \in \mathcal{N}_\Gamma} N_j(\boldsymbol{x}) H(\phi(\boldsymbol{x})) b_j $$
一个至关重要的细节是如何选择被富集的节点集 $\mathcal{N}_\Gamma$。富集操作只应对那些其形函数支承域被[不连续面](@entry_id:180188)“切割”的节点进行。如果一个节点的支承域完全位于界面的某一侧（例如，$\phi(\boldsymbol{x}) > 0$），那么在该支承域内 $H(\phi(\boldsymbol{x}))$ 恒为常数（+1）。此时，富集[基函数](@entry_id:170178) $N_j(\boldsymbol{x})H(\phi(\boldsymbol{x}))$ 就等于 $N_j(\boldsymbol{x})$，这与标准[基函数](@entry_id:170178)线性相关，会导致[刚度矩阵](@entry_id:178659)奇异。因此，正确的富集节点集 $\mathcal{N}_\Gamma$ 应精确定义为：其形函数支承域同时包含 $\phi > 0$ 和 $\phi  0$ 区域的节点 [@problem_id:3390088]。

#### 弱[不连续性建模](@entry_id:165486)：[绝对值](@entry_id:147688)富集

当解本身是连续的，但其梯度在某个界面上发生跳跃时，我们称之为 **弱不连续性（weak discontinuity）**。这表现为解的图形在该处有一个“拐折”（kink）。数学上，这意味着 $\llbracket u \rrbracket = 0$ 但[法向导数](@entry_id:169511)的跳跃 $\llbracket \nabla u \cdot \boldsymbol{n} \rrbracket \neq 0$。这类解属于 $H^1(\Omega)$ 空间，但缺乏更高的正则性。一个经典的物理例子是，在由两种不同[热导率](@entry_id:147276)材料构成的复合体中，[稳态温度](@entry_id:136775)场在[材料界面](@entry_id:751731)上是连续的，但[热通量](@entry_id:138471)（与[温度梯度](@entry_id:136845)相关）的法向分量是不连续的 [@problem_id:3390122] [@problem_id:3390045]。

为了模拟这种拐折，可以采用 **[绝对值](@entry_id:147688)富集函数** $|\phi(\boldsymbol{x})|$。函数 $|\phi(\boldsymbol{x})|$ 在界面 $\phi(\boldsymbol{x})=0$ 处是连续的（值为0），但其[法向导数](@entry_id:169511)在该处存在跳跃，因为 $\nabla|\phi| = \text{sgn}(\phi)\nabla\phi$。这恰好能捕捉解的拐折特性，同时保持解的连续性。因此，对于弱不连续问题，[绝对值函数](@entry_id:160606)是比[Heaviside函数](@entry_id:176879)更合适的富集选择 [@problem_id:3390122] [@problem_id:3390045]。

#### 奇异性建模：[裂纹尖端](@entry_id:182807)富集

在[线性弹性断裂力学](@entry_id:172400)中，裂纹尖端附近的应[力场](@entry_id:147325)和应变场具有 $\sim r^{-1/2}$ 的奇异性，其中 $r$ 是到尖端的距离。这导致位移场具有 $\sim \sqrt{r}$ 的行为。标准的多项式形函数无法有效逼近这种奇异性。

为此，XFEM引入了一组专门的 **[裂纹尖端](@entry_id:182807)富集函数（near-tip branch functions）**，它们直接来自于尖端附近位移场的渐近解析解。对于二维平面弹性问题，一套标准的富集函数集是 [@problem_id:3390051]：
$$ \{ B_k(r, \theta) \}_{k=1}^4 = \left\{ \sqrt{r}\sin(\tfrac{\theta}{2}), \sqrt{r}\cos(\tfrac{\theta}{2}), \sqrt{r}\sin(\tfrac{\theta}{2})\sin\theta, \sqrt{r}\cos(\tfrac{\theta}{2})\sin\theta \right\} $$
这些函数中的 $(r, \theta)$ 是以[裂纹尖端](@entry_id:182807)为原点的局部极坐标。在XFEM的实现中，这些坐标可以通过两个正交的[水平集](@entry_id:751248)函数 $\phi$ 和 $\psi$ 来方便地定义。例如，$\phi$ 描述裂纹面，$\psi$ 描述[裂纹尖端](@entry_id:182807)处与裂纹相切的直线，则可以定义 $r = \sqrt{\phi^2 + \psi^2}$ 和 $\theta = \operatorname{atan2}(\phi, \psi)$。通过将这些[解析函数](@entry_id:139584)[植入](@entry_id:177559)逼近空间，XFEM能够以极高的精度捕捉尖端场的奇异性，从而精确计算应力强度因子等断裂参数。

### 实现中的关键考量

#### [数值积分](@entry_id:136578)

XFEM的灵活性带来了实现上的一个核心挑战：数值积分。在被[不连续面](@entry_id:180188)切割的单元上，被积函数（例如，来自刚度矩阵的项 $c \nabla(N_i H) \cdot \nabla(N_j H)$）不再是光滑的多项式，而是在单元内部包含跳跃的分片多项式。

标准的 **高斯积分（Gaussian quadrature）** 法则是为光滑多项式设计的，其高精度依赖于被积函数的[光滑性](@entry_id:634843)。当直接将标准[高斯积分](@entry_id:187139)应用于一个包含跳跃的函数时，其结果会严重失准，且积分值会随着[不连续面](@entry_id:180188)位置的微小变化而发生剧烈、非物理的波动 [@problem_id:2586316]。这会导致[刚度矩阵](@entry_id:178659)计算错误，破坏方法的稳定性和收敛性。

正确的做法是采用 **子单元积分（subcell integration）** [@problem_id:2586316] [@problem_id:2555194]。其基本思想是，首先根据[不连续面](@entry_id:180188)的几何位置（由[水平集](@entry_id:751248)函数 $\phi=0$ 给出）将被切割的单元分解为多个子三角或子四面体。在每个子单元内部，被积函数（如 $N_i H$）变回了光滑的多项式。然后，在每个子单元上分别应用标准的[高斯积分法](@entry_id:178260)则，最后将所有子单元的积分结果相加。通过这种方式，积分的精度和一致性得以恢复。

#### 方法论权衡：XFEM vs. 网格重剖分

在模拟[裂纹扩展](@entry_id:749562)等问题时，XFEM提供了一种与传统方法——即始终保持网格与裂纹几何共形的 **[自适应网格](@entry_id:164379)重剖分（adaptive remeshing）**——截然不同的思路。两种方法各有优劣 [@problem_id:3506796]：

*   **精度**：对于给定的网格，通过网格重剖分并加密尖端区域，可以达到很高的精度。XFEM通过内置的解析富集，同样可以在相对粗糙的网格上获得极佳的尖端场精度。
*   **计算成本**：网格重剖分方法的主要成本在于每次[裂纹扩展](@entry_id:749562)步都需生成新的高质量三维网格，这是一个非常耗时的过程。此外，还需要在旧网格和新网格之间进行解场（位移、温度等）的投影，这会引入额外的误差。XFEM避免了[网格生成](@entry_id:149105)和场投影，其主要成本转移到了更复杂的单元级计算（子单元积分）和求解可能病态的[线性方程组](@entry_id:148943)上。在三维问题中，由于[网格生成](@entry_id:149105)的成本极高，XFEM通常在每步的计算成本上更具优势 [@problem_id:3506796]。
*   **鲁棒性与通用性**：这是XFEM最显著的优势。对于复杂的裂纹行为，如[分叉](@entry_id:270606)、合并、弯曲，网格重剖分方法的算法逻辑变得极其复杂甚至难以实现。而XFEM中，裂纹路径的改变仅仅是更新其水平集函数的表示，富集过程自动适应新的几何，因而对处理任意复杂的拓扑演化具有无与伦比的鲁棒性。

综上所述，XFEM虽然在理论和实现上比标准FEM更复杂，但它提供了一种强大而高效的工具，专门用于解决那些以固定网格难以处理的、包含复杂演化不连续性的问题。