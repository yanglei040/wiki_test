{"hands_on_practices": [{"introduction": "在弯曲区域上求解方程需要理解其内蕴几何。本练习将引导您计算 NURBS 曲面的度量张量分量，这些分量量化了由映射引起的局部扭曲，并且是正确变换微分算子和积分的基础。[@problem_id:3411148]", "problem": "考虑一个在等几何分析 (IGA) 中使用的张量积二次非均匀有理B样条 (NURBS) 曲面，它将参数正方形映射到一个弯曲的二维域。设参数坐标为 $\\boldsymbol{\\xi}=(u,v)\\in[0,1]^{2}$，曲面映射为 $\\mathbf{X}(u,v)=\\sum_{i=0}^{2}\\sum_{j=0}^{2}R_{ij}(u,v)\\,\\mathbf{P}_{ij}$，其中 $R_{ij}(u,v)$ 是由二次开节点单变量B样条和权因子 $w_{ij}$ 构成的有理基函数，$\\mathbf{P}_{ij}\\in\\mathbb{R}^{2}$ 是控制点。节点向量为 $U=V=\\{0,0,0,1,1,1\\}$，控制点为\n$$\n\\mathbf{P}_{00}=(0,0),\\ \\mathbf{P}_{10}=(1,0),\\ \\mathbf{P}_{20}=(2,0),\\quad\n\\mathbf{P}_{01}=(0,1),\\ \\mathbf{P}_{11}=(1,1),\\ \\mathbf{P}_{21}=(2,1),\\quad\n\\mathbf{P}_{02}=(0,2),\\ \\mathbf{P}_{12}=(1,2),\\ \\mathbf{P}_{22}=(2,2),\n$$\n权因子为\n$$\nw_{ij}=1\\ \\text{for all}\\ (i,j)\\neq(1,1),\\quad w_{11}=2.\n$$\n定义度量系数 $g_{\\alpha\\beta}(u,v)=\\partial_{\\alpha}\\mathbf{X}(u,v)\\cdot\\partial_{\\beta}\\mathbf{X}(u,v)$，其中 $\\alpha,\\beta\\in\\{u,v\\}$，$\\partial_{\\alpha}\\mathbf{X}$ 表示映射关于参数坐标的偏导数。从NURBS基函数和有理曲面映射的标准定义出发，推导计算 $g_{\\alpha\\beta}(u,v)$ 所需的表达式，并计算在参数位置 $(u,v)=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处的度量分量。\n\n然后，解释在等几何框架内，$g_{\\alpha\\beta}$ 系数如何控制定义在弯曲域上的偏微分方程 (PDE) 的梯度和积分的变换。特别是，阐明梯度算子和面积元在映射 $\\mathbf{X}$ 下如何变化，并将 $g_{\\alpha\\beta}$ 与这些变换联系起来。\n\n报告 $g_{11}$、$g_{12}$ 和 $g_{22}$ 在 $(u,v)=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处的精确值。使用 $\\mathrm{pmatrix}$ 环境将最终答案表示为单行矩阵。", "solution": "该问题将分两部分进行解答。首先，我们将推导和计算在指定参数点处的度量张量分量。其次，我们将解释在等几何分析求解偏微分方程 (PDE) 的背景下度量张量的作用。\n\n### 第一部分：度量张量分量的计算\n\n问题要求计算在 $(u,v)=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处的度量系数 $g_{\\alpha\\beta}(u,v)$。度量张量分量定义为 $g_{\\alpha\\beta} = \\partial_{\\alpha}\\mathbf{X} \\cdot \\partial_{\\beta}\\mathbf{X}$，其中 $\\mathbf{X}(u,v)$ 是NURBS曲面映射，$\\partial_{\\alpha}$ 表示关于参数坐标 $u$ 或 $v$ 的偏导数。我们将用 $\\partial_u \\mathbf{X}$ 表示关于 $u$ 的偏导数，用 $\\partial_v \\mathbf{X}$ 表示关于 $v$ 的偏导数。需要计算的分量是 $g_{uu}$、$g_{uv}$ 和 $g_{vv}$。\n\nNURBS曲面定义为 $\\mathbf{X}(u,v) = \\sum_{i=0}^{2}\\sum_{j=0}^{2}R_{ij}(u,v)\\,\\mathbf{P}_{ij}$。有理基函数 $R_{ij}(u,v)$ 由下式给出：\n$$\nR_{ij}(u,v) = \\frac{N_i^{(p)}(u) N_j^{(p)}(v) w_{ij}}{W(u,v)}\n$$\n其中 $N_k^{(p)}$ 是次数为 $p$ 的B样条基函数，$w_{ij}$ 是权因子，$W(u,v)$ 是分母函数：\n$$\nW(u,v) = \\sum_{k=0}^{2}\\sum_{l=0}^{2} N_k^{(p)}(u) N_l^{(p)}(v) w_{kl}\n$$\n节点向量为 $U=V=\\{0,0,0,1,1,1\\}$。这对应于在每个参数方向上具有 $n+1=3$ 个基函数的次数 $p=2$（二次）的样条。端点的重复节点意味着B样条基函数是区间 $[0,1]$ 上的二次Bernstein多项式：\n$$\nN_{0,2}(u) = (1-u)^2 \\\\\nN_{1,2}(u) = 2u(1-u) \\\\\nN_{2,2}(u) = u^2\n$$\n基函数 $N_{j,2}(v)$ 的定义与此类似。根据单位分解性质，对于 $u \\in [0,1]$，有 $\\sum_{i=0}^{2} N_{i,2}(u) = 1$。\n\n分母函数 $W(u,v)$ 可以被简化。由于除了 $w_{11}=2$ 外，对所有 $(i,j)$ 都有 $w_{ij}=1$，我们有：\n$$\nW(u,v) = \\sum_{k,l} N_{k,2}(u) N_{l,2}(v) + (w_{11}-1) N_{1,2}(u) N_{1,2}(v)\n$$\n利用单位分解性质，$\\sum_{k,l} N_{k,2}(u) N_{l,2}(v) = \\left(\\sum_k N_{k,2}(u)\\right) \\left(\\sum_l N_{l,2}(v)\\right) = 1 \\cdot 1 = 1$。当 $w_{11}=2$ 时，我们得到：\n$$\nW(u,v) = 1 + N_{1,2}(u) N_{1,2}(v) = 1 + 4uv(1-u)(1-v)\n$$\n曲面映射可以写成 $\\mathbf{X}(u,v) = \\frac{\\mathbf{A}(u,v)}{W(u,v)}$，其中 $\\mathbf{A}(u,v) = \\sum_{i,j} N_{i,2}(u) N_{j,2}(v) w_{ij} \\mathbf{P}_{ij}$。\n\n$\\mathbf{X}(u,v)$ 的偏导数可以用商法则求得。对于关于 $u$ 的导数：\n$$\n\\partial_u \\mathbf{X} = \\frac{(\\partial_u \\mathbf{A}) W - \\mathbf{A} (\\partial_u W)}{W^2}\n$$\n其中 $\\partial_u \\mathbf{A} = \\sum_{i,j} (\\partial_u N_{i,2}(u)) N_{j,2}(v) w_{ij} \\mathbf{P}_{ij}$ 且 $\\partial_u W = (\\partial_u N_{1,2}(u)) N_{1,2}(v)$。\n\n我们必须在 $(u,v)=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处计算这些值。首先，我们计算基函数及其在 $u=\\tfrac{1}{2}$ 处的导数值：\n$$\nN_{0,2}(\\tfrac{1}{2}) = (1-\\tfrac{1}{2})^2 = \\tfrac{1}{4} \\\\\nN_{1,2}(\\tfrac{1}{2}) = 2(\\tfrac{1}{2})(1-\\tfrac{1}{2}) = \\tfrac{1}{2} \\\\\nN_{2,2}(\\tfrac{1}{2}) = (\\tfrac{1}{2})^2 = \\tfrac{1}{4}\n$$\n基函数的导数是：\n$$\n\\partial_u N_{0,2}(u) = -2(1-u) \\implies \\partial_u N_{0,2}(\\tfrac{1}{2}) = -1 \\\\\n\\partial_u N_{1,2}(u) = 2 - 4u \\implies \\partial_u N_{1,2}(\\tfrac{1}{2}) = 0 \\\\\n\\partial_u N_{2,2}(u) = 2u \\implies \\partial_u N_{2,2}(\\tfrac{1}{2}) = 1\n$$\n根据对称性，$N_{j,2}(\\tfrac{1}{2})$ 和 $\\partial_v N_{j,2}(\\tfrac{1}{2})$ 的值是相同的。\n\n现在，我们计算 $W$ 及其在 $(\\tfrac{1}{2},\\tfrac{1}{2})$ 处的导数值：\n$$\nW(\\tfrac{1}{2},\\tfrac{1}{2}) = 1 + N_{1,2}(\\tfrac{1}{2}) N_{1,2}(\\tfrac{1}{2}) = 1 + (\\tfrac{1}{2})(\\tfrac{1}{2}) = \\tfrac{5}{4}\n$$\n$$\n\\partial_u W(\\tfrac{1}{2},\\tfrac{1}{2}) = (\\partial_u N_{1,2}(\\tfrac{1}{2})) N_{1,2}(\\tfrac{1}{2}) = 0 \\cdot \\tfrac{1}{2} = 0\n$$\n根据对称性，$\\partial_v W(\\tfrac{1}{2},\\tfrac{1}{2}) = 0$。\n\n由于在关注点处 $\\partial_u W$ 和 $\\partial_v W$ 均为零，导数表达式显著简化为：\n$$\n\\partial_u \\mathbf{X}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\frac{\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2})}{W(\\tfrac{1}{2},\\tfrac{1}{2})} \\quad \\text{和} \\quad \\partial_v \\mathbf{X}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\frac{\\partial_v \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2})}{W(\\tfrac{1}{2},\\tfrac{1}{2})}\n$$\n让我们计算 $\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2})$：\n$$\n\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\sum_{i=0}^2 \\sum_{j=0}^2 (\\partial_u N_{i,2}(\\tfrac{1}{2})) N_{j,2}(\\tfrac{1}{2}) w_{ij} \\mathbf{P}_{ij}\n$$\n由于 $\\partial_u N_{1,2}(\\tfrac{1}{2})=0$，所以 $i=1$ 的项为零：\n$$\n\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = (\\partial_u N_{0,2}(\\tfrac{1}{2})) \\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{0j} \\mathbf{P}_{0j} + (\\partial_u N_{2,2}(\\tfrac{1}{2})) \\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{2j} \\mathbf{P}_{2j}\n$$\n$$\n\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = (-1) \\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{0j} \\mathbf{P}_{0j} + (1) \\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{2j} \\mathbf{P}_{2j}\n$$\n第一个和为：\n$\\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{0j} \\mathbf{P}_{0j} = \\tfrac{1}{4}(1)\\mathbf{P}_{00} + \\tfrac{1}{2}(1)\\mathbf{P}_{01} + \\tfrac{1}{4}(1)\\mathbf{P}_{02} = \\tfrac{1}{4}(0,0) + \\tfrac{1}{2}(0,1) + \\tfrac{1}{4}(0,2) = (0, \\tfrac{1}{2}) + (0, \\tfrac{1}{2}) = (0,1)$。\n第二个和为：\n$\\sum_{j=0}^2 N_{j,2}(\\tfrac{1}{2}) w_{2j} \\mathbf{P}_{2j} = \\tfrac{1}{4}(1)\\mathbf{P}_{20} + \\tfrac{1}{2}(1)\\mathbf{P}_{21} + \\tfrac{1}{4}(1)\\mathbf{P}_{22} = \\tfrac{1}{4}(2,0) + \\tfrac{1}{2}(2,1) + \\tfrac{1}{4}(2,2) = (\\tfrac{1}{2},0) + (1,\\tfrac{1}{2}) + (\\tfrac{1}{2},\\tfrac{1}{2}) = (2,1)$。\n因此，$\\partial_u \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = -(0,1) + (2,1) = (2,0)$。\n\n类似地，我们计算 $\\partial_v \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2})$：\n$$\n\\partial_v \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\sum_{i=0}^2 N_{i,2}(\\tfrac{1}{2}) \\left( \\sum_{j=0}^2 (\\partial_v N_{j,2}(\\tfrac{1}{2})) w_{ij} \\mathbf{P}_{ij} \\right)\n$$\n由于 $\\partial_v N_{1,2}(\\tfrac{1}{2})=0$，括号内求和中 $j=1$ 的项为零。\n$$\n\\partial_v \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = (\\partial_v N_{0,2}(\\tfrac{1}{2})) \\sum_{i=0}^2 N_{i,2}(\\tfrac{1}{2}) w_{i0} \\mathbf{P}_{i0} + (\\partial_v N_{2,2}(\\tfrac{1}{2})) \\sum_{i=0}^2 N_{i,2}(\\tfrac{1}{2}) w_{i2} \\mathbf{P}_{i2}\n$$\n第一个和为：\n$\\sum_{i=0}^2 N_{i,2}(\\tfrac{1}{2}) w_{i0} \\mathbf{P}_{i0} = \\tfrac{1}{4}(1)\\mathbf{P}_{00} + \\tfrac{1}{2}(1)\\mathbf{P}_{10} + \\tfrac{1}{4}(1)\\mathbf{P}_{20} = \\tfrac{1}{4}(0,0) + \\tfrac{1}{2}(1,0) + \\tfrac{1}{4}(2,0) = (0,0) + (\\tfrac{1}{2},0) + (\\tfrac{1}{2},0) = (1,0)$。\n第二个和为：\n$\\sum_{i=0}^2 N_{i,2}(\\tfrac{1}{2}) w_{i2} \\mathbf{P}_{i2} = \\tfrac{1}{4}(1)\\mathbf{P}_{02} + \\tfrac{1}{2}(1)\\mathbf{P}_{12} + \\tfrac{1}{4}(1)\\mathbf{P}_{22} = \\tfrac{1}{4}(0,2) + \\tfrac{1}{2}(1,2) + \\tfrac{1}{4}(2,2) = (0, \\tfrac{1}{2}) + (\\tfrac{1}{2},1) + (\\tfrac{1}{2},\\tfrac{1}{2}) = (1,2)$。\n因此，$\\partial_v \\mathbf{A}(\\tfrac{1}{2},\\tfrac{1}{2}) = -(1,0) + (1,2) = (0,2)$。\n\n现在我们可以计算在 $(\\tfrac{1}{2},\\tfrac{1}{2})$ 处的切向量 $\\partial_u \\mathbf{X}$ 和 $\\partial_v \\mathbf{X}$：\n$$\n\\partial_u \\mathbf{X}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\frac{(2,0)}{5/4} = (\\tfrac{8}{5}, 0)\n$$\n$$\n\\partial_v \\mathbf{X}(\\tfrac{1}{2},\\tfrac{1}{2}) = \\frac{(0,2)}{5/4} = (0, \\tfrac{8}{5})\n$$\n最后，我们计算度量张量分量，问题中将其标记为 $g_{11}$、$g_{12}$、$g_{22}$，分别对应于 $g_{uu}$、$g_{uv}$、$g_{vv}$：\n$$\ng_{11} = g_{uu} = \\partial_u \\mathbf{X} \\cdot \\partial_u \\mathbf{X} = (\\tfrac{8}{5}, 0) \\cdot (\\tfrac{8}{5}, 0) = (\\tfrac{8}{5})^2 = \\tfrac{64}{25}\n$$\n$$\ng_{12} = g_{uv} = \\partial_u \\mathbf{X} \\cdot \\partial_v \\mathbf{X} = (\\tfrac{8}{5}, 0) \\cdot (0, \\tfrac{8}{5}) = 0\n$$\n$$\ng_{22} = g_{vv} = \\partial_v \\mathbf{X} \\cdot \\partial_v \\mathbf{X} = (0, \\tfrac{8}{5}) \\cdot (0, \\tfrac{8}{5}) = (\\tfrac{8}{5})^2 = \\tfrac{64}{25}\n$$\n\n### 第二部分：度量张量在IGA中的作用\n\n等几何分析框架基于一个从简单参数域 $\\hat{\\Omega}$（此处为单位正方形 $[0,1]^2$）到复杂物理域 $\\Omega \\subset \\mathbb{R}^2$ 的映射 $\\mathbf{X}$。在 $\\Omega$ 上求解PDE时，所有计算都被拉回到 $\\hat{\\Omega}$ 上。度量系数 $g_{\\alpha\\beta}$ 是描述映射局部几何并控制微分算子和积分变换的基本量。\n\n设参数坐标为 $\\boldsymbol{\\xi} = (u,v)$，物理坐标为 $\\mathbf{x} = (x,y)$。映射为 $\\mathbf{x} = \\mathbf{X}(\\boldsymbol{\\xi})$。曲面上参数坐标线的切向量为 $\\mathbf{g}_u = \\partial_u \\mathbf{X}$ 和 $\\mathbf{g}_v = \\partial_v \\mathbf{X}$。这些向量在曲面上每一点构成了切空间的一个局部基。度量系数 $g_{\\alpha\\beta} = \\mathbf{g}_\\alpha \\cdot \\mathbf{g}_\\beta$ 是这些基向量的内积。它们构成了度量张量（或第一基本形式）矩阵：\n$$\nG = \\begin{pmatrix} g_{uu} & g_{uv} \\\\ g_{vu} & g_{vv} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{g}_u \\cdot \\mathbf{g}_u & \\mathbf{g}_u \\cdot \\mathbf{g}_v \\\\ \\mathbf{g}_v \\cdot \\mathbf{g}_u & \\mathbf{g}_v \\cdot \\mathbf{g}_v \\end{pmatrix}\n$$\n\n**梯度算子的变换：**\n物理域中标量函数 $\\phi(\\mathbf{x})$ 的梯度 $\\nabla_{\\mathbf{x}} \\phi$ 必须用参数域中的导数来表示以便计算。我们处理复合函数 $\\hat{\\phi}(\\boldsymbol{\\xi}) = \\phi(\\mathbf{X}(\\boldsymbol{\\xi}))$。链式法则将两个域中的梯度联系起来：$\\nabla_{\\boldsymbol{\\xi}} \\hat{\\phi} = J^T \\nabla_{\\mathbf{x}} \\phi$，其中 $J = \\nabla_{\\boldsymbol{\\xi}} \\mathbf{X}$ 是变换的雅可比矩阵：\n$$\nJ = \\begin{pmatrix} \\partial_u x & \\partial_v x \\\\ \\partial_u y & \\partial_v y \\end{pmatrix} = \\begin{pmatrix} (\\mathbf{g}_u)^T \\\\ (\\mathbf{g}_v)^T \\end{pmatrix}\n$$\n为了获得物理梯度 $\\nabla_{\\mathbf{x}}\\phi$，我们反转这个关系：$\\nabla_{\\mathbf{x}} \\phi = (J^T)^{-1} \\nabla_{\\boldsymbol{\\xi}} \\hat{\\phi}$。度量张量通过 $G = J J^T$ 直接与雅可比矩阵相关。这意味着度量张量的逆 $G^{-1}$ 与梯度变换所需的雅可比矩阵的逆相关：$G^{-1} = (J J^T)^{-1} = (J^T)^{-1} J^{-1}$。在许多PDE的弱形式中（例如，对于拉普拉斯算子 $-\\Delta \\phi$），会出现 $\\int_\\Omega \\nabla \\phi \\cdot \\nabla \\psi \\, dA$ 这一项。当映射到父域时，点积变为 $(\\nabla_{\\mathbf{x}} \\phi)^T (\\nabla_{\\mathbf{x}} \\psi) = (\\nabla_{\\boldsymbol{\\xi}} \\hat{\\phi})^T J^{-1} (J^T)^{-1} (\\nabla_{\\boldsymbol{\\xi}} \\hat{\\psi}) = (\\nabla_{\\boldsymbol{\\xi}} \\hat{\\phi})^T G^{-1} (\\nabla_{\\boldsymbol{\\xi}} \\hat{\\psi})$。因此，逆度量张量 $G^{-1}$ 直接介导了狄利克雷能量的变换。\n\n**面积元的变换：**\n物理域 $\\Omega$ 上的积分被变换为参数域 $\\hat{\\Omega}$ 上的积分。物理域中的微分面积元 $dA$ 通过雅可比行列式与参数域中的微分面积元 $d\\hat{A} = du\\,dv$ 相关联：\n$$\ndA = |\\det(J)| \\, du \\, dv\n$$\n度量张量的行列式为 $\\det(G) = \\det(JJ^T) = \\det(J)\\det(J^T) = (\\det(J))^2$。因此，雅可比行列式是度量张量行列式的平方根：\n$$\n|\\det(J)| = \\sqrt{\\det(G)} = \\sqrt{g_{uu}g_{vv} - g_{uv}^2}\n$$\n因此，一个积分变换如下：\n$$\n\\int_{\\Omega} f(\\mathbf{x}) \\, dA = \\int_{\\hat{\\Omega}} f(\\mathbf{X}(\\boldsymbol{\\xi})) \\sqrt{\\det(G)} \\, du \\, dv\n$$\n总之，度量系数 $g_{\\alpha\\beta}$ 完全刻画了由映射 $\\mathbf{X}$ 引入的局部变形。它们通过提供变换微分算子（如梯度）和积分的规则，对于将一个复杂的物理域 $\\Omega$ 上的PDE问题重塑为简单参数域 $\\hat{\\Omega}$ 上的问题至关重要。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{64}{25} & 0 & \\frac{64}{25} \\end{pmatrix}}\n$$", "id": "3411148"}, {"introduction": "在等几何分析中，系统矩阵的组装依赖于在复杂的、由 NURBS 定义的单元上进行精确的数值积分。本实践将通过实现一个高斯求积方案来计算映射后曲面的面积，从而让您直接了解映射的雅可比行列式如何影响求积权重。[@problem_id:3411147]", "problem": "您的任务是实现对由非均匀有理B样条（NURBS）参数化的曲面片进行逐单元的数值积分。从通过可微映射回拉面积分开始，推导并实现一个程序，该程序使用高斯积分计算常数标量场的曲面积分，并通过雅可比行列式显式地量化曲率如何影响积分权重。您的实现必须使用单个张量积NURBS曲面，其在角向具有二次基，在径向具有线性基，并且必须根据可微映射规则精确地处理从参数正方形到物理平面的映射。\n\n基本原理：\n- 曲面片由一个光滑映射 $S : [0,1]^2 \\to \\mathbb{R}^2$ 定义，其中 $(u,v) \\in [0,1]^2$ 是参数坐标，$(x,y) = S(u,v)$ 是物理坐标。\n- 曲面积分的变量替换公式表明，对于标量场 $f(x,y)$，\n$$\n\\int_{\\Omega} f(x,y) \\, dA = \\int_{[0,1]^2} f(S(u,v)) \\, \\left|\\det J(u,v)\\right| \\, du \\, dv,\n$$\n其中 $J(u,v)$ 是 $S$ 关于 $(u,v)$ 的偏导数雅可比矩阵，$\\left|\\det J(u,v)\\right|$ 是其行列式的绝对值。\n- 非均匀有理B样条（NURBS）曲面由张量积有理基函数构造。对于 $u$ 方向的次数 $p$ 和 $v$ 方向的次数 $q$，定义多项式B样条基函数 $N_i(u)$ 和 $M_j(v)$（$i=0,\\dots,p$，$j=0,\\dots,q$），以及正权重 $w_{ij}$。有理基函数为\n$$\nR_{ij}(u,v) = \\frac{N_i(u) M_j(v) w_{ij}}{W(u,v)}, \\quad W(u,v) = \\sum_{a=0}^{p}\\sum_{b=0}^{q} N_a(u) M_b(v) w_{ab}.\n$$\n曲面映射则为\n$$\nS(u,v) = \\sum_{i=0}^{p}\\sum_{j=0}^{q} R_{ij}(u,v) \\, P_{ij},\n$$\n其中 $P_{ij} \\in \\mathbb{R}^2$ 是控制点。\n- 高斯积分通过在特定节点上对函数求值的加权和来近似积分。对于每个参数方向，使用 $n_u$ 和 $n_v$ 个节点和权重，并为 $[0,1]^2$ 构造张量积积分。\n\n要求：\n1.  构造一个单一的张量积NURBS曲面，在 $u$ 方向使用二次基（$p=2$），在 $v$ 方向使用线性基（$q=1$）。使用对应于单个单元的钳位节点矢量，因此多项式基简化为 $[0,1]$ 上的伯恩斯坦多项式：\n    - 在 $u$ 方向，使用 $[0,1]$ 上的二次伯恩斯坦多项式：$N_0(u)$, $N_1(u)$, $N_2(u)$。\n    - 在 $v$ 方向，使用 $[0,1]$ 上的线性伯恩斯坦多项式：$M_0(v)$, $M_1(v)$。\n    提供它们关于 $u$ 和 $v$ 的一阶导数的一致定义。\n2.  通过一段圆弧和一个径向线段的张量积，在平面中定义一个四分之一环形几何体。$u$ 方向对应于从 $0$ 到 $\\pi/2$ 的角坐标，$v$ 方向对应于径向坐标。使用一个 $3 \\times 2$ 的控制点网格：\n    - 对于每个半径 $r \\in \\{r_{\\mathrm{in}}, r_{\\mathrm{out}}\\}$，设置\n      $P_{0,\\cdot}(r) = (r, 0)$,\n      $P_{1,\\cdot}(r) = \\left(\\frac{r}{\\sqrt{2}}, \\frac{r}{\\sqrt{2}}\\right)$,\n      $P_{2,\\cdot}(r) = (0, r)$,\n      其中 $\\cdot$ 表示两个径向位置 $r=r_{\\mathrm{in}}$ 和 $r=r_{\\mathrm{out}}$。\n    - 对于沿圆弧的有理权重，使用 $(w_{0,\\cdot}, w_{1,\\cdot}, w_{2,\\cdot}) = \\left(1, \\frac{1}{\\sqrt{2}}, 1\\right)$，并对两个径向位置重复使用。这精确地表示了 $u$ 方向上的一个圆弧。\n3.  通过从有理基和控制点获得 $S(u,v)$ 关于 $u$ 和 $v$ 的一阶导数，计算雅可比矩阵 $J(u,v)$。\n4.  实现张量积高斯积分，在 $u$ 方向使用 $n_u = 5$ 个节点，在 $v$ 方向使用 $n_v = 5$ 个节点，从 $[-1,1]$ 映射到 $[0,1]$，并使用这些节点来近似常数标量场 $f(x,y)=1$ 在物理曲面上的积分。\n5.  通过计算在所有积分节点上 $\\left|\\det J(u,v)\\right|$ 的极值，量化弯曲几何对积分权重的影响。\n6.  实现以下参数集的测试套件，并对每个测试用例计算：\n    - 近似面积 $A \\approx \\sum w_u w_v \\left|\\det J(u,v)\\right|$。\n    - 在所有积分点上 $\\left|\\det J(u,v)\\right|$ 的最小值和最大值。\n    使用以下情况：\n    - 情况1（理想情况，有理圆环）：$r_{\\mathrm{in}} = 1.0$, $r_{\\mathrm{out}} = 2.0$, 权重 $(1, 1/\\sqrt{2}, 1)$。\n    - 情况2（多项式，非有理几何）：$r_{\\mathrm{in}} = 1.0$, $r_{\\mathrm{out}} = 2.0$, 权重 $(1, 1, 1)$。\n    - 情况3（边界情况，退化环）：$r_{\\mathrm{in}} = 1.5$, $r_{\\mathrm{out}} = 1.5$, 权重 $(1, 1/\\sqrt{2}, 1)$。\n7.  最终输出格式：您的程序应生成一行输出，其中包含一个由三个子列表组成的逗号分隔列表，每个子列表按顺序对应一个测试用例，并包含三个浮点数 $[A, \\min|\\det J|, \\max|\\det J|]$。例如：“[[A1,min1,max1],[A2,min2,max2],[A3,min3,max3]]”。所有数字均表示为无单位的浮点数。\n\n您的程序必须是自包含的，并且能够按原样运行，不接受任何输入，并且必须遵守指定的执行环境和库。", "solution": "用户提供的问题经过严格的验证过程后被评估为**有效**。该问题在微分几何和数值分析方面有科学依据，提法良好，目标明确，数据充分，并且结构客观。它要求在等几何分析领域进行标准的、可验证的计算。\n\n解决方案首先推导了NURBS曲面及其导数的必要数学公式，然后实现了一个数值算法来计算所需的量。\n\n**1. NURBS曲面参数化与基函数**\n\nNURBS曲面由一个从参数域（此处选择为单位正方形 $[0,1]^2$）到物理域 $\\mathbb{R}^2$ 的映射 $S(u,v)$ 定义。该映射是由以下有理函数给出的：\n$$ S(u,v) = \\frac{\\sum_{i=0}^{p}\\sum_{j=0}^{q} N_i(u) M_j(v) w_{ij} P_{ij}}{\\sum_{a=0}^{p}\\sum_{b=0}^{q} N_a(u) M_b(v) w_{ab}} $$\n其中 $P_{ij} \\in \\mathbb{R}^2$ 是控制点，$w_{ij} > 0$ 是其关联的权重，$N_i(u)$ 和 $M_j(v)$ 分别是次数为 $p$ 和 $q$ 的B样条基函数。\n\n对于这个问题，我们考虑使用钳位节点矢量的单个曲面片，这将B样条基函数简化为伯恩斯坦多项式。\n次数指定为 $u$ 方向 $p=2$（二次）和 $v$ 方向 $q=1$（线性）。\n\n基函数及其一阶导数如下：\n- 在 $u$ 方向（$[0,1]$ 上的二次伯恩斯坦多项式）：\n  - $N_0(u) = (1-u)^2$\n  - $N_1(u) = 2u(1-u)$\n  - $N_2(u) = u^2$\n  - $N_0'(u) = -2(1-u)$\n  - $N_1'(u) = 2 - 4u$\n  - $N_2'(u) = 2u$\n\n- 在 $v$ 方向（$[0,1]$ 上的线性伯恩斯坦多项式）：\n  - $M_0(v) = 1-v$\n  - $M_1(v) = v$\n  - $M_0'(v) = -1$\n  - $M_1'(v) = 1$\n\n**2. 曲面导数与雅可比矩阵**\n\n为了计算曲面面积，我们需要映射 $S(u,v)$ 的雅可比矩阵。我们定义 $S(u,v)$ 的向量值分子和标量值分母如下：\n$$ \\mathbf{A}(u,v) = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i(u) M_j(v) w_{ij} P_{ij} $$\n$$ W(u,v) = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i(u) M_j(v) w_{ij} $$\n曲面映射 $S(u,v) = \\mathbf{A}(u,v) / W(u,v)$ 的偏导数使用商法则求得：\n$$ \\frac{\\partial S}{\\partial u} = \\frac{1}{W^2} \\left( W \\frac{\\partial \\mathbf{A}}{\\partial u} - \\mathbf{A} \\frac{\\partial W}{\\partial u} \\right) \\quad \\text{和} \\quad \\frac{\\partial S}{\\partial v} = \\frac{1}{W^2} \\left( W \\frac{\\partial \\mathbf{A}}{\\partial v} - \\mathbf{A} \\frac{\\partial W}{\\partial v} \\right) $$\n$\\mathbf{A}(u,v)$ 和 $W(u,v)$ 的导数通过对其各自的和逐项求导得到：\n$$ \\frac{\\partial \\mathbf{A}}{\\partial u} = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i'(u) M_j(v) w_{ij} P_{ij} \\quad \\text{和} \\quad \\frac{\\partial W}{\\partial u} = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i'(u) M_j(v) w_{ij} $$\n$$ \\frac{\\partial \\mathbf{A}}{\\partial v} = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i(u) M_j'(v) w_{ij} P_{ij} \\quad \\text{和} \\quad \\frac{\\partial W}{\\partial v} = \\sum_{i=0}^{2}\\sum_{j=0}^{1} N_i(u) M_j'(v) w_{ij} $$\n雅可比矩阵 $J(u,v)$ 由偏导数向量构成，这些向量沿着参数网格线与曲面相切：\n$$ J(u,v) = \\begin{bmatrix} \\frac{\\partial S_x}{\\partial u} & \\frac{\\partial S_x}{\\partial v} \\\\ \\frac{\\partial S_y}{\\partial u} & \\frac{\\partial S_y}{\\partial v} \\end{bmatrix} $$\n其行列式的绝对值 $|\\det J(u,v)|$ 是参数域和物理域之间的局部面积缩放因子。\n\n**3. 通过高斯积分进行数值积分**\n\n曲面片的面积，即常数标量场 $f(x,y)=1$ 的积分，通过变量替换到参数域来计算：\n$$ \\mathrm{Area} = \\int_{\\Omega} 1 \\, dA = \\int_{0}^{1}\\int_{0}^{1} |\\det J(u,v)| \\, du \\, dv $$\n这个二维积分使用张量积高斯-勒让德积分法则进行数值近似。对于指定的 $u$ 方向 $n_u = 5$ 个节点和 $v$ 方向 $n_v = 5$ 个节点，我们首先获得区间 $[-1,1]$ 上的标准积分点 $\\{\\xi_k\\}$ 和权重 $\\{\\omega_k\\}$。通过仿射变换 $u_k = (\\xi_k + 1)/2$ 将它们映射到积分区间 $[0,1]$。相应的积分权重必须按此变换的雅可比行列式（即 $1/2$）进行缩放。因此，$[0,1]$ 区间上的权重为 $w_{u_k} = \\omega_k/2$。面积则通过离散和来近似：\n$$ \\mathrm{Area} \\approx \\sum_{k=1}^{n_u} \\sum_{l=1}^{n_v} w_{u_k} w_{v_l} |\\det J(u_k, v_l)| $$\n其中 $(u_k, v_l)$ 是映射后的积分点。\n\n**4. 算法实现步骤**\n\n对于每个测试用例，整体算法按以下步骤进行：\n1.  **初始化几何**：根据指定的半径和权重向量，构造 $3 \\times 2$ 的控制点网格 $P_{ij}$ 和相应的 $3 \\times 2$ 权重矩阵 $w_{ij}$。\n2.  **准备积分**：获取 $[-1,1]$ 上的5个高斯-勒让德节点和权重，并映射它们以创建 $[0,1]^2$ 域的积分规则。\n3.  **积分循环**：遍历 $n_u \\times n_v = 25$ 个积分点 $(u_k, v_l)$。在每个点：\n    a. 评估伯恩斯坦基函数 $N_i(u_k)$、$M_j(v_l)$ 及其导数 $N_i'(u_k)$、$M_j'(v_l)$。\n    b. 通过对所有基函数、权重和控制点的贡献求和，计算 $W$ 和 $\\mathbf{A}$ 及其关于 $u$ 和 $v$ 的偏导数。\n    c. 应用商法则求切向量 $\\frac{\\partial S}{\\partial u}$ 和 $\\frac{\\partial S}{\\partial v}$。\n    d. 计算雅可比矩阵的行列式 $\\det J(u_k, v_l)$。\n    e. 将加权贡献 $w_{u_k} w_{v_l} |\\det J(u_k, v_l)|$ 累加到面积的总和中。\n    f. 存储 $|\\det J(u_k, v_l)|$ 的值以供后续分析。\n4.  **汇总结果**：循环结束后，累加和即为近似面积 $A$。从存储的雅可比行列式列表中找到最小值和最大值。\n\n对所有指定的测试用例执行此过程以生成最终结果。$|\\det J|$ 在积分点上的变化为NURBS映射引入的几何变形提供了一个定量度量。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the area and Jacobian determinant statistics for NURBS surfaces.\n    \"\"\"\n    # Test cases: (r_in, r_out, weights_u)\n    test_cases = [\n        (1.0, 2.0, np.array([1.0, 1.0 / np.sqrt(2.0), 1.0])),\n        (1.0, 2.0, np.array([1.0, 1.0, 1.0])),\n        (1.5, 1.5, np.array([1.0, 1.0 / np.sqrt(2.0), 1.0])),\n    ]\n\n    # Gaussian quadrature parameters for a 5-point rule\n    n_points = 5\n    gauss_points, gauss_weights = np.polynomial.legendre.leggauss(n_points)\n\n    # Map nodes and weights from [-1, 1] to [0, 1]\n    # For a function f(x) on [0,1], integral is approx. sum(w_i * f(x_i))\n    # where x_i = (p_i+1)/2 and w_i = q_i/2\n    q_points = 0.5 * (gauss_points + 1)\n    q_weights = 0.5 * gauss_weights\n\n    # --- Basis Functions and their Derivatives ---\n    # Quadratic Bernstein polynomials for u in [0,1]\n    N_funcs = [\n        lambda u: (1 - u)**2,\n        lambda u: 2 * u * (1 - u),\n        lambda u: u**2\n    ]\n    # Derivatives of quadratic Bernstein polynomials\n    dN_du_funcs = [\n        lambda u: -2 * (1 - u),\n        lambda u: 2 - 4 * u,\n        lambda u: 2 * u\n    ]\n    # Linear Bernstein polynomials for v in [0,1]\n    M_funcs = [\n        lambda v: 1 - v,\n        lambda v: v\n    ]\n    # Derivatives of linear Bernstein polynomials\n    dM_dv_funcs = [\n        lambda v: -1.0,\n        lambda v: 1.0\n    ]\n\n    results = []\n    for r_in, r_out, weights_u in test_cases:\n        # --- Define Geometry: Control Points and Weights ---\n        # Control points P[i, j, coord] for a 3x2 grid\n        P = np.zeros((3, 2, 2))\n        radii = [r_in, r_out]\n        \n        for j in range(2): # 0 for r_in, 1 for r_out\n            r = radii[j]\n            P[0, j, :] = [r, 0.0]\n            P[1, j, :] = [r / np.sqrt(2.0), r / np.sqrt(2.0)]\n            P[2, j, :] = [0.0, r]\n\n        # Weights w[i, j] for a 3x2 grid\n        weights = np.zeros((3, 2))\n        weights[:, 0] = weights_u\n        weights[:, 1] = weights_u\n\n        # --- Numerical Integration ---\n        total_area = 0.0\n        det_J_values = []\n\n        for k in range(n_points):\n            u = q_points[k]\n            wu = q_weights[k]\n            \n            # Evaluate u-basis functions and derivatives\n            N_vals = np.array([f(u) for f in N_funcs])\n            dN_du_vals = np.array([f(u) for f in dN_du_funcs])\n\n            for l in range(n_points):\n                v = q_points[l]\n                wv = q_weights[l]\n\n                # Evaluate v-basis functions and derivatives\n                M_vals = np.array([f(v) for f in M_funcs])\n                dM_dv_vals = np.array([f(v) for f in dM_dv_funcs])\n\n                # --- Calculate S(u,v) derivatives using the quotient rule ---\n                # S(u,v) = A(u,v) / W(u,v)\n                \n                # W and its derivatives\n                W_ij = np.outer(N_vals, M_vals) * weights\n                W = np.sum(W_ij)\n                \n                dW_du_ij = np.outer(dN_du_vals, M_vals) * weights\n                dW_du = np.sum(dW_du_ij)\n\n                dW_dv_ij = np.outer(N_vals, dM_dv_vals) * weights\n                dW_dv = np.sum(dW_dv_ij)\n\n                # A and its derivatives (A is a 2D vector)\n                A = np.einsum('ij,ijk->k', W_ij, P)\n                dA_du = np.einsum('ij,ijk->k', dW_du_ij, P)\n                dA_dv = np.einsum('ij,ijk->k', dW_dv_ij, P)\n\n                # Apply quotient rule for dS/du and dS/dv\n                # dS_du and dS_dv are 2D vectors (tangents)\n                dS_du = (dA_du * W - A * dW_du) / (W**2)\n                dS_dv = (dA_dv * W - A * dW_dv) / (W**2)\n                \n                # Jacobian determinant\n                det_J = dS_du[0] * dS_dv[1] - dS_du[1] * dS_dv[0]\n                abs_det_J = np.abs(det_J)\n                \n                det_J_values.append(abs_det_J)\n                total_area += wu * wv * abs_det_J\n\n        min_det_J = np.min(det_J_values)\n        max_det_J = np.max(det_J_values)\n        \n        results.append([total_area, min_det_J, max_det_J])\n\n    # Format the final output string exactly as required\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        output_str += f\"[{res[0]},{res[1]},{res[2]}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3411147"}, {"introduction": "验证数值求解器的正确性是计算科学中的关键步骤。本练习介绍精确解方法（MMS），您将从一个预设的解出发，反向推导对应的偏微分方程源项，这个过程要求您精确应用映射区域上微分算子的链式法则。[@problem_id:3411193]", "problem": "考虑在一个弯曲物理域 $\\Omega$ 上的二维泊松方程 $-\\nabla_{x}\\cdot\\nabla_{x} u = f$。该物理域 $\\Omega$ 是通过一个光滑双射映射 $F:\\hat{\\Omega}\\to\\Omega$，由参数正方形 $\\hat{\\Omega} = [0,1]^{2}$ 的非均匀有理B样条 (NURBS) 图像生成的。设 NURBS 映射由双线性（权重等于 $1$）曲面明确给出\n$$F(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big) = \\big(\\xi,\\,\\eta + c\\,\\xi\\,\\eta\\big),$$\n其中 $c$ 是一个固定的实参数，满足 $c-1$，因此对于所有 $(\\xi,\\eta)\\in\\hat{\\Omega}$ 都有 $1+c\\,\\xi0$。通过将参数函数 $\\hat{u}:\\hat{\\Omega}\\to\\mathbb{R}$ 进行拉回，指定 $u$ 来定义制造解：\n$$u(x,y) = \\hat{u}\\big(F^{-1}(x,y)\\big),\\qquad \\hat{u}(\\xi,\\eta) = \\sin(\\pi\\,\\xi)\\,\\sin(\\pi\\,\\eta)。$$\n您的任务是，在物理坐标 $(x,y)$ 中，推导泊松方程中出现的精确右端项 $f$，其形式需适用于使用 NURBS 基函数的等几何分析下的伽辽金误差验证。您必须从连接映射下梯度和相应度量张量的基本几何守恒恒等式出发。特别地，利用物理梯度是通过链式法则和 $F$ 的雅可比矩阵 $J_{F}(\\xi,\\eta)$ 从参数梯度获得的，以及拉普拉斯算子可以用参数坐标 $(\\xi,\\eta)$ 和度量张量 $G(\\xi,\\eta) = J_{F}(\\xi,\\eta)^{\\top}\\,J_{F}(\\xi,\\eta)$ 来表示。\n\n计算 $J_{F}$ 和 $G$，并使用 $G^{-1}$ 和 $\\det(G)$ 将物理拉普拉斯算子 $\\Delta_{x} u$ 表示为 $(\\xi,\\eta)$ 的函数，然后对制造解 $\\hat{u}$ 进行求值。最后，通过代入由 $F$ 得到的逆映射 $(\\xi,\\eta)=F^{-1}(x,y)$，将您的答案完全用物理坐标 $(x,y)$ 表示。提供 $f(x,y)$ 的精确解析表达式，无需数值近似。不需要单位，也不要进行四舍五入。", "solution": "该问题是有效的。这是一个标准的、适定的偏微分方程数值分析问题，特别是在用于等几何分析中代码验证的制造解方法的框架内。所有必要的数据和定义都已提供，该问题在科学上和数学上都是合理的。\n\n目标是给定一个制造解 $u(x,y)$，求出泊松方程 $-\\Delta_{x} u = f$ 中的源项 $f(x,y)$。解 $u$ 是通过将参数域 $\\hat{\\Omega} = [0,1]^2$ 上的函数 $\\hat{u}(\\xi,\\eta)$ 拉回到物理域 $\\Omega$ 来定义的。映射为 $F:\\hat{\\Omega} \\to \\Omega$，由 $F(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta)) = (\\xi, \\eta+c\\xi\\eta)$ 给出。解为 $u(x,y) = \\hat{u}(F^{-1}(x,y))$，其中 $\\hat{u}(\\xi,\\eta) = \\sin(\\pi\\xi)\\sin(\\pi\\eta)$。\n\n该任务需要计算 $u$ 在物理坐标下的拉普拉斯算子 $\\Delta_x u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$。这涉及到使用链式法则，将物理空间偏导数算子 $(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$ 用参数空间算子 $(\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta})$ 来表示。\n\n首先，我们建立导数算子之间的关系。对于任何光滑函数 $g(x,y)$，其与 $F$ 的复合给出 $\\hat{g}(\\xi, \\eta) = g(F(\\xi, \\eta))$。链式法则给出：\n$$ \\frac{\\partial \\hat{g}}{\\partial \\xi} = \\frac{\\partial g}{\\partial x}\\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial g}{\\partial y}\\frac{\\partial y}{\\partial \\xi} \\quad \\text{和} \\quad \\frac{\\partial \\hat{g}}{\\partial \\eta} = \\frac{\\partial g}{\\partial x}\\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial g}{\\partial y}\\frac{\\partial y}{\\partial \\eta} $$\n映射分量的偏导数是：\n$$ \\frac{\\partial x}{\\partial \\xi} = 1, \\quad \\frac{\\partial x}{\\partial \\eta} = 0, \\quad \\frac{\\partial y}{\\partial \\xi} = c\\eta, \\quad \\frac{\\partial y}{\\partial \\eta} = 1+c\\xi $$\n将这些代入链式法则方程：\n$$ \\frac{\\partial \\hat{g}}{\\partial \\xi} = \\frac{\\partial g}{\\partial x} + c\\eta \\frac{\\partial g}{\\partial y} $$\n$$ \\frac{\\partial \\hat{g}}{\\partial \\eta} = (1+c\\xi) \\frac{\\partial g}{\\partial y} $$\n从第二个方程，我们解出 $\\frac{\\partial g}{\\partial y}$：\n$$ \\frac{\\partial g}{\\partial y} = \\frac{1}{1+c\\xi} \\frac{\\partial \\hat{g}}{\\partial \\eta} $$\n将此代入第一个方程，我们可以解出 $\\frac{\\partial g}{\\partial x}$：\n$$ \\frac{\\partial \\hat{g}}{\\partial \\xi} = \\frac{\\partial g}{\\partial x} + c\\eta \\left( \\frac{1}{1+c\\xi} \\frac{\\partial \\hat{g}}{\\partial \\eta} \\right) \\implies \\frac{\\partial g}{\\partial x} = \\frac{\\partial \\hat{g}}{\\partial \\xi} - \\frac{c\\eta}{1+c\\xi} \\frac{\\partial \\hat{g}}{\\partial \\eta} $$\n这些表达式定义了作用于 $(\\xi, \\eta)$ 函数的物理导数算子：\n$$ \\frac{\\partial}{\\partial x} \\equiv D_x = D_\\xi - \\frac{c\\eta}{1+c\\xi} D_\\eta $$\n$$ \\frac{\\partial}{\\partial y} \\equiv D_y = \\frac{1}{1+c\\xi} D_\\eta $$\n其中 $D_\\xi = \\frac{\\partial}{\\partial \\xi}$ 和 $D_\\eta = \\frac{\\partial}{\\partial \\eta}$。\n\n接下来，我们通过将这些算子两次应用于 $u$ 来计算二阶偏导数，其参数表示为 $\\hat{u}$。\n对于 $\\frac{\\partial^2 u}{\\partial y^2}$：\n$$ \\frac{\\partial^2 u}{\\partial y^2} = D_y(D_y u) = \\left(\\frac{1}{1+c\\xi} D_\\eta\\right) \\left(\\frac{1}{1+c\\xi} D_\\eta \\hat{u}\\right) = \\frac{1}{(1+c\\xi)^2} D_\\eta^2 \\hat{u} = \\frac{1}{(1+c\\xi)^2} \\frac{\\partial^2 \\hat{u}}{\\partial \\eta^2} $$\n对于 $\\frac{\\partial^2 u}{\\partial x^2}$：\n$$ \\frac{\\partial^2 u}{\\partial x^2} = D_x(D_x u) = \\left(D_\\xi - \\frac{c\\eta}{1+c\\xi} D_\\eta\\right) \\left(D_\\xi \\hat{u} - \\frac{c\\eta}{1+c\\xi} D_\\eta \\hat{u}\\right) $$\n仔细应用乘法法则：\n$$ \\frac{\\partial^2 u}{\\partial x^2} = D_\\xi\\left(D_\\xi \\hat{u} - \\frac{c\\eta}{1+c\\xi} D_\\eta \\hat{u}\\right) - \\frac{c\\eta}{1+c\\xi} D_\\eta\\left(D_\\xi \\hat{u} - \\frac{c\\eta}{1+c\\xi} D_\\eta \\hat{u}\\right) $$\n$$ = \\left( \\frac{\\partial^2 \\hat{u}}{\\partial \\xi^2} + \\frac{c^2\\eta}{(1+c\\xi)^2}\\frac{\\partial \\hat{u}}{\\partial \\eta} - \\frac{c\\eta}{1+c\\xi}\\frac{\\partial^2 \\hat{u}}{\\partial \\xi \\partial \\eta} \\right) - \\left( \\frac{c\\eta}{1+c\\xi}\\frac{\\partial^2 \\hat{u}}{\\partial \\eta \\partial \\xi} - \\frac{c^2\\eta}{(1+c\\xi)^2}\\frac{\\partial \\hat{u}}{\\partial \\eta} - \\frac{c^2\\eta^2}{(1+c\\xi)^2}\\frac{\\partial^2 \\hat{u}}{\\partial \\eta^2} \\right) $$\n合并各项，我们得到：\n$$ \\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial^2 \\hat{u}}{\\partial \\xi^2} - \\frac{2c\\eta}{1+c\\xi}\\frac{\\partial^2 \\hat{u}}{\\partial \\xi \\partial \\eta} + \\frac{c^2\\eta^2}{(1+c\\xi)^2}\\frac{\\partial^2 \\hat{u}}{\\partial \\eta^2} + \\frac{2c^2\\eta}{(1+c\\xi)^2}\\frac{\\partial \\hat{u}}{\\partial \\eta} $$\n参数坐标中的拉普拉斯算子是和 $\\Delta_x u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$：\n$$ \\Delta_x u = \\frac{\\partial^2 \\hat{u}}{\\partial \\xi^2} - \\frac{2c\\eta}{1+c\\xi}\\frac{\\partial^2 \\hat{u}}{\\partial \\xi \\partial \\eta} + \\frac{1+c^2\\eta^2}{(1+c\\xi)^2}\\frac{\\partial^2 \\hat{u}}{\\partial \\eta^2} + \\frac{2c^2\\eta}{(1+c\\xi)^2}\\frac{\\partial \\hat{u}}{\\partial \\eta} $$\n现在，我们计算 $\\hat{u}(\\xi,\\eta) = \\sin(\\pi\\xi)\\sin(\\pi\\eta)$ 的必要导数：\n$$ \\frac{\\partial \\hat{u}}{\\partial \\eta} = \\pi\\sin(\\pi\\xi)\\cos(\\pi\\eta) $$\n$$ \\frac{\\partial^2 \\hat{u}}{\\partial \\xi^2} = -\\pi^2\\sin(\\pi\\xi)\\sin(\\pi\\eta) = -\\pi^2\\hat{u} $$\n$$ \\frac{\\partial^2 \\hat{u}}{\\partial \\eta^2} = -\\pi^2\\sin(\\pi\\xi)\\sin(\\pi\\eta) = -\\pi^2\\hat{u} $$\n$$ \\frac{\\partial^2 \\hat{u}}{\\partial \\xi \\partial \\eta} = \\pi^2\\cos(\\pi\\xi)\\cos(\\pi\\eta) $$\n将这些代入 $\\Delta_x u$ 的表达式中：\n$$ \\Delta_x u = -\\pi^2\\hat{u} - \\frac{2c\\eta}{1+c\\xi}(\\pi^2\\cos(\\pi\\xi)\\cos(\\pi\\eta)) + \\frac{1+c^2\\eta^2}{(1+c\\xi)^2}(-\\pi^2\\hat{u}) + \\frac{2c^2\\eta}{(1+c\\xi)^2}(\\pi\\sin(\\pi\\xi)\\cos(\\pi\\eta)) $$\n我们可以对各项进行分组：\n$$ \\Delta_x u = -\\pi^2\\hat{u} \\left(1 + \\frac{1+c^2\\eta^2}{(1+c\\xi)^2}\\right) - \\frac{2c\\eta\\pi^2}{1+c\\xi}\\cos(\\pi\\xi)\\cos(\\pi\\eta) + \\frac{2c^2\\eta\\pi}{(1+c\\xi)^2}\\sin(\\pi\\xi)\\cos(\\pi\\eta) $$\n最后一步是将此结果用物理坐标 $(x,y)$ 表示。我们需要逆映射 $F^{-1}(x,y)=(\\xi,\\eta)$。\n从 $x=\\xi$ 和 $y=\\eta(1+c\\xi)$，我们得到：\n$$ \\xi = x \\quad \\text{和} \\quad \\eta = \\frac{y}{1+cx} $$\n将这些代入 $\\Delta_x u$ 的表达式中：\n$$ \\Delta_x u(x,y) = -\\pi^2 \\sin(\\pi x)\\sin\\left(\\frac{\\pi y}{1+cx}\\right) \\left(1 + \\frac{1+c^2\\left(\\frac{y}{1+cx}\\right)^2}{(1+cx)^2}\\right) - \\frac{2c\\left(\\frac{y}{1+cx}\\right)\\pi^2}{1+cx}\\cos(\\pi x)\\cos\\left(\\frac{\\pi y}{1+cx}\\right) + \\frac{2c^2\\left(\\frac{y}{1+cx}\\right)\\pi}{(1+cx)^2}\\sin(\\pi x)\\cos\\left(\\frac{\\pi y}{1+cx}\\right) $$\n简化系数：\n$$ 1 + \\frac{1+c^2\\frac{y^2}{(1+cx)^2}}{(1+cx)^2} = \\frac{(1+cx)^2 + 1 + \\frac{c^2y^2}{(1+cx)^2}}{(1+cx)^2} = \\frac{(1+cx)^4 + (1+cx)^2 + c^2y^2}{(1+cx)^4} $$\n$$ \\frac{2c\\left(\\frac{y}{1+cx}\\right)\\pi^2}{1+cx} = \\frac{2c\\pi^2 y}{(1+cx)^2} $$\n$$ \\frac{2c^2\\left(\\frac{y}{1+cx}\\right)\\pi}{(1+cx)^2} = \\frac{2c^2\\pi y}{(1+cx)^3} $$\n综合起来：\n$$ \\Delta_x u(x,y) = -\\pi^2 \\sin(\\pi x)\\sin\\left(\\frac{\\pi y}{1+cx}\\right)\\frac{(1+cx)^4+(1+cx)^2+c^2y^2}{(1+cx)^4} - \\frac{2c\\pi^2 y}{(1+cx)^2}\\cos(\\pi x)\\cos\\left(\\frac{\\pi y}{1+cx}\\right) + \\frac{2c^2\\pi y}{(1+cx)^3}\\sin(\\pi x)\\cos\\left(\\frac{\\pi y}{1+cx}\\right) $$\n源项为 $f(x,y) = -\\Delta_x u(x,y)$。\n$$ f(x,y) = \\pi^2 \\sin(\\pi x)\\sin\\left(\\frac{\\pi y}{1+cx}\\right)\\frac{(1+cx)^4+(1+cx)^2+c^2y^2}{(1+cx)^4} + \\frac{2c\\pi y}{(1+cx)^3} \\cos\\left(\\frac{\\pi y}{1+cx}\\right) \\left(\\pi(1+cx)\\cos(\\pi x) - c\\sin(\\pi x)\\right) $$", "answer": "$$\\boxed{\\pi^2 \\sin(\\pi x)\\sin\\left(\\frac{\\pi y}{1+cx}\\right) \\frac{(1+cx)^4+(1+cx)^2+c^2y^2}{(1+cx)^4} + \\frac{2c\\pi y}{(1+cx)^3} \\cos\\left(\\frac{\\pi y}{1+cx}\\right) \\left( \\pi(1+cx)\\cos(\\pi x) - c\\sin(\\pi x) \\right)}$$", "id": "3411193"}]}