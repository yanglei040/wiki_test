{"hands_on_practices": [{"introduction": "我们从最基本的任务开始：显式地定义基函数。本练习将引导你在标准参考三角形上推导出 Crouzeix-Raviart (CR) 基函数。接着，我们将探讨仿射映射这一关键概念，它使得这些参考基函数能够应用于网格中的任意通用三角形，这是有限元方法的一块基石。[@problem_id:3376187]", "problem": "考虑在三角形上求解泊松模型问题的 Crouzeix–Raviart (CR) 非协调有限元。设参考三角形为 $\\hat{T}$，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。$\\hat{T}$ 上的局部 CR 形函数是唯一的线性函数 $\\hat{\\phi}_{i}$，$i=1,2,3$，使得每个 $\\hat{\\phi}_{i}$ 在一条参考边的中点处为 $1$，而在另外两条边的中点处为 $0$。\n\n1) 仅使用三个边中点处的定义自由度，确定参考三角形 $\\hat{T}$ 上的参考基函数 $\\hat{\\phi}_{1}$、$\\hat{\\phi}_{2}$ 和 $\\hat{\\phi}_{3}$ 的显式公式。\n\n2) 设 $F:\\hat{T}\\to T$ 是一个形式为 $x = F(\\hat{x}) = B\\hat{x} + b$ 的仿射映射，其中 $B\\in\\mathbb{R}^{2\\times 2}$ 是非奇异矩阵， $b\\in\\mathbb{R}^{2}$。将 $T$ 上的物理 CR 基函数定义为 $\\phi_{i} = \\hat{\\phi}_{i}\\circ F^{-1}$。从导数的链式法则和积分的变量替换公式出发，推导以下变换法则：\n- 关联 $T$ 上的梯度 $\\nabla \\phi_{i}$ 与 $\\hat{T}$ 上的参考梯度 $\\hat{\\nabla}\\hat{\\phi}_{i}$，以及\n- 关联 $T$ 上和 $\\partial T$ 上的积分与 $\\hat{T}$ 上和 $\\partial\\hat{T}$ 上的积分，并用 $B$ 显式地表示雅可比缩放因子。\n\n3) 特化到各向异性对角仿射映射，其中 $B=\\mathrm{diag}(\\alpha,\\beta)$，$\\alpha$ 和 $\\beta$ 为给定的正参数。考虑局部刚度矩阵 $K_{T}\\in\\mathbb{R}^{3\\times 3}$，其元素为\n$$\n(K_{T})_{ij} \\;=\\; \\int_{T} \\nabla \\phi_{i}(x)\\cdot \\nabla \\phi_{j}(x)\\,\\mathrm{d}x.\n$$\n使用第 2) 部分推导的变换法则和第 1) 部分得到的参考 CR 基函数的显式公式，计算 $K_{T}$ 的行列式，并以 $\\alpha$ 和 $\\beta$ 的闭式解析表达式给出。\n\n你的最终答案必须是一个单一的闭式表达式。无需进行四舍五入。", "solution": "所述问题是适定的，在有限元方法理论中有坚实的科学基础，并提供了一套完整且一致的定义和数据。因此，这是一个有效的问题。我们按照要求分三部分进行求解。\n\n### 第 1 部分：参考基函数的推导\n\n设参考三角形 $\\hat{T}$ 是 $\\mathbb{R}^2$ 中点 $(\\hat{x}, \\hat{y})$ 的集合，其顶点为 $\\hat{v}_1=(0,0)$、$\\hat{v}_2=(1,0)$ 和 $\\hat{v}_3=(0,1)$。该三角形的边位于直线 $\\hat{x}=0$、$\\hat{y}=0$ 和 $\\hat{x}+\\hat{y}=1$ 上。三条边的中点是：\n- $\\hat{m}_1$：连接 $\\hat{v}_2$ 和 $\\hat{v}_3$ 的边的中点，即 $(\\frac{1+0}{2}, \\frac{0+1}{2}) = (\\frac{1}{2}, \\frac{1}{2})$。\n- $\\hat{m}_2$：连接 $\\hat{v}_1$ 和 $\\hat{v}_3$ 的边的中点，即 $(\\frac{0+0}{2}, \\frac{0+1}{2}) = (0, \\frac{1}{2})$。\n- $\\hat{m}_3$：连接 $\\hat{v}_1$ 和 $\\hat{v}_2$ 的边的中点，即 $(\\frac{1+0}{2}, \\frac{0+0}{2}) = (\\frac{1}{2}, 0)$。\n\nCrouzeix-Raviart (CR) 基函数 $\\hat{\\phi}_i$ ($i=1,2,3$) 是形式为 $\\hat{\\phi}(\\hat{x}, \\hat{y}) = a\\hat{x} + b\\hat{y} + c$ 的线性函数。它们由条件 $\\hat{\\phi}_i(\\hat{m}_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n**对于 $\\hat{\\phi}_1$：**\n我们要求 $\\hat{\\phi}_1(\\hat{m}_1)=1$、$\\hat{\\phi}_1(\\hat{m}_2)=0$ 和 $\\hat{\\phi}_1(\\hat{m}_3)=0$。设 $\\hat{\\phi}_1(\\hat{x}, \\hat{y}) = a_1\\hat{x} + b_1\\hat{y} + c_1$。这得到以下线性方程组：\n$$\n\\begin{cases}\na_1(\\frac{1}{2}) + b_1(\\frac{1}{2}) + c_1 = 1 \\\\\na_1(0) + b_1(\\frac{1}{2}) + c_1 = 0 \\\\\na_1(\\frac{1}{2}) + b_1(0) + c_1 = 0\n\\end{cases}\n$$\n从第二个方程，我们得到 $b_1 = -2c_1$。从第三个方程，我们得到 $a_1 = -2c_1$。将这些代入第一个方程，得到 $(-2c_1)(\\frac{1}{2}) + (-2c_1)(\\frac{1}{2}) + c_1 = 1$，化简为 $-c_1 - c_1 + c_1 = 1$，即 $-c_1=1$。因此，$c_1=-1$，这意味着 $a_1=2$ 且 $b_1=2$。\n第一个基函数是 $\\hat{\\phi}_1(\\hat{x}, \\hat{y}) = 2\\hat{x} + 2\\hat{y} - 1$。\n\n**对于 $\\hat{\\phi}_2$：**\n我们要求 $\\hat{\\phi}_2(\\hat{m}_1)=0$、$\\hat{\\phi}_2(\\hat{m}_2)=1$ 和 $\\hat{\\phi}_2(\\hat{m}_3)=0$。设 $\\hat{\\phi}_2(\\hat{x}, \\hat{y}) = a_2\\hat{x} + b_2\\hat{y} + c_2$。\n$$\n\\begin{cases}\na_2(\\frac{1}{2}) + b_2(\\frac{1}{2}) + c_2 = 0 \\\\\na_2(0) + b_2(\\frac{1}{2}) + c_2 = 1 \\\\\na_2(\\frac{1}{2}) + b_2(0) + c_2 = 0\n\\end{cases}\n$$\n从第三个方程，我们得到 $a_2 = -2c_2$。代入第一个方程：$(-2c_2)(\\frac{1}{2}) + \\frac{b_2}{2} + c_2 = 0$，化简为 $-c_2 + \\frac{b_2}{2} + c_2 = 0$，所以 $b_2=0$。第二个方程变为 $c_2=1$。这意味着 $a_2 = -2$。\n第二个基函数是 $\\hat{\\phi}_2(\\hat{x}, \\hat{y}) = -2\\hat{x} + 1$。\n\n**对于 $\\hat{\\phi}_3$：**\n我们要求 $\\hat{\\phi}_3(\\hat{m}_1)=0$、$\\hat{\\phi}_3(\\hat{m}_2)=0$ 和 $\\hat{\\phi}_3(\\hat{m}_3)=1$。设 $\\hat{\\phi}_3(\\hat{x}, \\hat{y}) = a_3\\hat{x} + b_3\\hat{y} + c_3$。\n$$\n\\begin{cases}\na_3(\\frac{1}{2}) + b_3(\\frac{1}{2}) + c_3 = 0 \\\\\na_3(0) + b_3(\\frac{1}{2}) + c_3 = 0 \\\\\na_3(\\frac{1}{2}) + b_3(0) + c_3 = 1\n\\end{cases}\n$$\n从第二个方程，我们得到 $b_3 = -2c_3$。代入第一个方程：$\\frac{a_3}{2} + (-2c_3)(\\frac{1}{2}) + c_3 = 0$，这意味着 $a_3=0$。第三个方程变为 $c_3=1$。这意味着 $b_3 = -2$。\n第三个基函数是 $\\hat{\\phi}_3(\\hat{x}, \\hat{y}) = -2\\hat{y} + 1$。\n\n总之，参考基函数是：\n$$\n\\hat{\\phi}_1(\\hat{x}, \\hat{y}) = 2\\hat{x} + 2\\hat{y} - 1\n$$\n$$\n\\hat{\\phi}_2(\\hat{x}, \\hat{y}) = 1 - 2\\hat{x}\n$$\n$$\n\\hat{\\phi}_3(\\hat{x}, \\hat{y}) = 1 - 2\\hat{y}\n$$\n\n### 第 2 部分：变换法则\n\n设 $x = F(\\hat{x}) = B\\hat{x} + b$，其中 $B \\in \\mathbb{R}^{2\\times 2}$ 是非奇异矩阵， $b \\in \\mathbb{R}^2$。逆映射为 $\\hat{x} = F^{-1}(x) = B^{-1}(x-b)$。物理基函数为 $\\phi_i(x) = (\\hat{\\phi}_i \\circ F^{-1})(x) = \\hat{\\phi}_i(B^{-1}(x-b))$。\n\n**梯度变换：**\n我们使用导数的链式法则。设 $\\nabla$ 和 $\\hat{\\nabla}$ 分别表示关于 $x$ 和 $\\hat{x}$ 的梯度算子。\n$$\n(\\hat{\\nabla} \\hat{\\phi}_i)^T = (\\nabla \\phi_i)^T \\frac{\\partial x}{\\partial \\hat{x}}\n$$\n其中 $\\frac{\\partial x}{\\partial \\hat{x}}$ 是变换 $F$ 的雅可比矩阵，记作 $D_{\\hat{x}}F$。对于仿射映射 $F(\\hat{x}) = B\\hat{x} + b$，该雅可比矩阵就是矩阵 $B$。所以，$(\\hat{\\nabla} \\hat{\\phi}_i)^T = (\\nabla \\phi_i)^T B$。\n两边转置得到 $\\hat{\\nabla} \\hat{\\phi}_i = B^T \\nabla \\phi_i$。由于 $B$ 是非奇异的，$B^T$ 也是非奇异的。我们可以解出物理梯度 $\\nabla \\phi_i$：\n$$\n\\nabla \\phi_i(x) = (B^T)^{-1} \\hat{\\nabla} \\hat{\\phi}_i(\\hat{x}) = B^{-T} \\hat{\\nabla} \\hat{\\phi}_i(F^{-1}(x))\n$$\n\n**积分变换（面积）：**\n重积分的标准变量替换公式是：\n$$\n\\int_T f(x) \\,dx = \\int_{\\hat{T}} f(F(\\hat{x})) |\\det(D_{\\hat{x}}F)| \\,d\\hat{x}\n$$\n雅可比行列式是 $|\\det(B)|$。因此，三角形面积上的积分变换为：\n$$\n\\int_T f(x) \\,dx = |\\det(B)| \\int_{\\hat{T}} f(B\\hat{x}+b) \\,d\\hat{x}\n$$\n面积分的雅可比缩放因子是 $|\\det(B)|$。\n\n**积分变换（边界）：**\n考虑参考三角形 $\\hat{T}$ 的一条边 $\\hat{e}$，由弧长 $\\hat{s}$ 参数化。物理三角形 $T$ 上的对应边是 $e=F(\\hat{e})$。设 $\\hat{\\tau}$是 $\\hat{e}$ 的单位切向量。边上的一点可以写成 $\\hat{x}(\\hat{s}) = \\hat{x}_0 + \\hat{s}\\hat{\\tau}$。物理边上的对应点是 $x(\\hat{s}) = F(\\hat{x}(\\hat{s})) = B(\\hat{x}_0 + \\hat{s}\\hat{\\tau}) + b$。\n物理边上的切向量是 $\\frac{dx}{d\\hat{s}} = B\\hat{\\tau}$。$e$ 上的弧长微分是 $ds = \\|\\frac{dx}{d\\hat{s}}\\| d\\hat{s} = \\|B\\hat{\\tau}\\| d\\hat{s}$。\n边 $e$ 上的线积分的变换为：\n$$\n\\int_e g(x) \\,ds = \\int_{\\hat{e}} g(F(\\hat{x})) \\|B\\hat{\\tau}\\| \\,d\\hat{s}\n$$\n缩放因子是 $\\|B\\hat{\\tau}\\|$，它取决于边 $\\hat{e}$ 的方向。在整个边界 $\\partial T = \\cup_k e_k$ 上的积分变换是每条边的变换之和：\n$$\n\\int_{\\partial T} g(x) \\,ds = \\sum_k \\int_{e_k} g(x) \\,ds = \\sum_k \\int_{\\hat{e}_k} g(F(\\hat{x})) \\|B\\hat{\\tau}_k\\| \\,d\\hat{s}\n$$\n其中 $\\hat{\\tau}_k$ 是边 $\\hat{e}_k$ 的单位切向量。\n\n### 第 3 部分：局部刚度矩阵的行列式\n\n局部刚度矩阵由 $(K_T)_{ij} = \\int_T \\nabla \\phi_i(x) \\cdot \\nabla \\phi_j(x) \\,dx$ 定义。\n使用变换法则：\n$$\n(K_T)_{ij} = \\int_{\\hat{T}} (B^{-T} \\hat{\\nabla} \\hat{\\phi}_i) \\cdot (B^{-T} \\hat{\\nabla} \\hat{\\phi}_j) |\\det(B)| \\,d\\hat{x}\n$$\n线性基函数 $\\hat{\\phi}_i$ 的梯度在 $\\hat{T}$ 上是常向量。设 $\\hat{g}_i = \\hat{\\nabla} \\hat{\\phi}_i$。被积函数是常数，所以我们可以将其从积分中提出：\n$$\n(K_T)_{ij} = ( (B^{-T} \\hat{g}_i) \\cdot (B^{-T} \\hat{g}_j) ) |\\det(B)| \\int_{\\hat{T}} d\\hat{x}\n$$\n参考三角形 $\\hat{T}$ 的面积是 $\\frac{1}{2}$。内积可以用矩阵转置表示法写成：$(B^{-T}\\hat{g}_i)^T (B^{-T}\\hat{g}_j) = \\hat{g}_i^T (B^{-T})^T B^{-T} \\hat{g}_j = \\hat{g}_i^T B^{-1} B^{-T} \\hat{g}_j$。\n对于给定的映射，$B = \\mathrm{diag}(\\alpha, \\beta) = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix}$。这个矩阵是对称的，所以 $B^T=B$。\n那么 $B^{-1} = \\mathrm{diag}(\\alpha^{-1}, \\beta^{-1})$ 且 $B^{-T} = B^{-1}$。此外，因为 $\\alpha, \\beta 0$，所以 $|\\det(B)| = |\\alpha\\beta|=\\alpha\\beta$。\n刚度矩阵元素的公式化简为：\n$$\n(K_T)_{ij} = \\frac{\\alpha\\beta}{2} (\\hat{g}_i^T B^{-2} \\hat{g}_j)\n$$\n其中 $B^{-2} = \\mathrm{diag}(\\alpha^{-2}, \\beta^{-2})$。\n\n根据第 1 部分，参考基函数的梯度为：\n$\\hat{g}_1 = \\hat{\\nabla}(2\\hat{x} + 2\\hat{y} - 1) = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$。\n$\\hat{g}_2 = \\hat{\\nabla}(1 - 2\\hat{x}) = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$。\n$\\hat{g}_3 = \\hat{\\nabla}(1 - 2\\hat{y}) = \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix}$。\n\n一个关键的观察是，这些梯度向量的和为零：\n$$\n\\hat{g}_1 + \\hat{g}_2 + \\hat{g}_3 = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这是因为 $\\sum_{i=1}^3 \\hat{\\phi}_i(\\hat{x}, \\hat{y}) = (2\\hat{x} + 2\\hat{y} - 1) + (1 - 2\\hat{x}) + (1 - 2\\hat{y}) = 1$ 是一个常函数，而常数的梯度为零。\n\n梯度向量 $\\hat{g}_i$ 之间的这种线性相关性意味着局部刚度矩阵 $K_T$ 是奇异的。为了说明这一点，考虑向量 $c = (1, 1, 1)^T$。我们来计算乘积 $K_T c$。其第 $j$ 个分量是：\n$$\n(K_T c)_j = \\sum_{i=1}^3 (K_T)_{ji} c_i = \\sum_{i=1}^3 (K_T)_{ji} = \\sum_{i=1}^3 \\frac{\\alpha\\beta}{2} (\\hat{g}_j^T B^{-2} \\hat{g}_i)\n$$\n$$\n(K_T c)_j = \\frac{\\alpha\\beta}{2} \\hat{g}_j^T B^{-2} \\left(\\sum_{i=1}^3 \\hat{g}_i\\right) = \\frac{\\alpha\\beta}{2} \\hat{g}_j^T B^{-2} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = 0\n$$\n由于对于非零向量 $c=(1,1,1)^T$ 有 $K_T c = 0$，矩阵 $K_T$ 存在非平凡零空间。因此，它是奇异的。任何奇异矩阵的行列式都为零。\n\n为了完整起见，我们可以显式地构造矩阵 $K_T$。设 $M_{ij} = \\hat{g}_i^T B^{-2} \\hat{g}_j$。那么 $K_T = \\frac{\\alpha\\beta}{2} M$。\n$M_{11} = \\begin{pmatrix} 2  2 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} = 4\\alpha^{-2} + 4\\beta^{-2}$。\n$M_{12} = \\begin{pmatrix} 2  2 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} = -4\\alpha^{-2}$。\n$M_{13} = \\begin{pmatrix} 2  2 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} = -4\\beta^{-2}$。\n$M_{22} = \\begin{pmatrix} -2  0 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} = 4\\alpha^{-2}$。\n$M_{23} = \\begin{pmatrix} -2  0 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} = 0$。\n$M_{33} = \\begin{pmatrix} 0  -2 \\end{pmatrix} \\begin{pmatrix} \\alpha^{-2}  0 \\\\ 0  \\beta^{-2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -2 \\end{pmatrix} = 4\\beta^{-2}$。\n矩阵 $M$ 是对称的：\n$$\nM = 4 \\begin{pmatrix} \\alpha^{-2} + \\beta^{-2}  -\\alpha^{-2}  -\\beta^{-2} \\\\ -\\alpha^{-2}  \\alpha^{-2}  0 \\\\ -\\beta^{-2}  0  \\beta^{-2} \\end{pmatrix}\n$$\n该矩阵每行（或每列）的元素之和为零。例如，对于第一行：$(\\alpha^{-2} + \\beta^{-2}) - \\alpha^{-2} - \\beta^{-2} = 0$。这证实了 $(1,1,1)^T$ 在 $M$ 的零空间中，因此也在 $K_T$ 的零空间中。\n$K_T$ 的行列式是：\n$$\n\\det(K_T) = \\det\\left(\\frac{\\alpha\\beta}{2} M\\right) = \\left(\\frac{\\alpha\\beta}{2}\\right)^3 \\det(M)\n$$\n由于 $M$ 是奇异的，所以 $\\det(M)=0$。由此立即可得 $\\det(K_T)=0$。\n\nCrouzeix-Raviart 单元的局部刚度矩阵的行列式为零，这是任何在其单元基函数中包含常函数的有限元的一般性质。\n行列式的最终闭式解析表达式是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3376187"}, {"introduction": "在掌握了局部单元的定义之后，本练习将演示下一个关键步骤：组装全局系统。通过为一个由两个单元组成的简单网格计算局部刚度矩阵，然后将它们组合起来，你将亲身体验非协调元的组装过程。在非协调元中，自由度与边相关联，而非顶点。[@problem_id:3376155]", "problem": "考虑在方形区域 $\\Omega = [0,1]^{2}$ 上的齐次泊松问题 $-\\Delta u = f$，带有齐次狄利克雷边界条件。设 $\\mathcal{T}_{h}$ 是将 $\\Omega$ 沿从 $(0,0)$到 $(1,1)$ 的对角线切割得到的两个三角形 $T_{1}$ 和 $T_{2}$ 的三角剖分：\n- $T_{1}$ 的顶点为 $v_{1} = (0,0)$，$v_{2} = (1,0)$，$v_{3} = (1,1)$。\n- $T_{2}$ 的顶点为 $w_{1} = (0,0)$，$w_{2} = (1,1)$，$w_{3} = (0,1)$。\n\n使用 Crouzeix–Raviart (CR) 非协调 $\\mathbb{P}_{1}$ 有限元空间来近似该问题，其自由度为边中点的值。通过将边界边上的自由度设置为零来施加齐次狄利克雷边界条件。\n\n从双线性形式为 $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$ 的弱形式出发，并仅使用以下基本事实：\n- 在每个三角形 $T$ 上，与边 $e$ 相关联的任何 CR 基函数在 $T$ 上都是仿射的，并且由其在 $T$ 的三条边中点处的值唯一确定。\n- 三角形上的重心坐标 $\\lambda_{i}$ 是仿射的，满足 $\\lambda_{i}(v_{i}) = 1$ 和当 $j \\neq i$ 时 $\\lambda_{i}(v_{j})=0$，以及 $\\lambda_{1} + \\lambda_{2} + \\lambda_{3} = 1$。\n- 仿射函数的梯度在三角形上是常数，因此梯度乘积的积分简化为常数点积乘以三角形的面积。\n\n任务：\n1. 在一个顶点为 $(x_{1},y_{1})$、$(x_{2},y_{2})$、$(x_{3},y_{3})$ 的三角形 $T$ 上，将顶点 $i$ 的对边标记为 $e_{i}$，并通过条件 $\\psi_{i}^{T}(m_{e_{i}}) = 1$ 和当 $j \\neq i$ 时 $\\psi_{i}^{T}(m_{e_{j}}) = 0$ 来定义局部 CR 基函数 $\\psi_{i}^{T}$，其中 $m_{e}$ 表示边 $e$ 的中点。推导 $\\psi_{i}^{T}$ 关于重心坐标 $\\lambda_{i}$ 的显式形式，然后推导局部刚度矩阵项\n$$\nK^{\\mathrm{CR}}_{T}(i,j) \\;=\\; \\int_{T} \\nabla \\psi_{i}^{T} \\cdot \\nabla \\psi_{j}^{T} \\, dx,\n$$\n的显式公式，用重心坐标的梯度和 $T$ 的面积表示。\n\n2. 对于上面定义的特定网格 $\\mathcal{T}_{h} = \\{T_{1}, T_{2}\\}$，使用每个三角形上重心坐标的显式梯度，计算完整的 $3 \\times 3$ 局部刚度矩阵 $K^{\\mathrm{CR}}_{T_{1}}$ 和 $K^{\\mathrm{CR}}_{T_{2}}$。\n\n3. 使用基于边的自由度组装全局 CR 刚度矩阵，其中边界边的自由度固定为零。识别唯一的内部边（对角线 $(0,0)$–$(1,1)$），将其全局基函数表示为 $\\Phi$，并组装标量全局刚度项\n$$\nA \\;=\\; \\int_{\\Omega} \\nabla \\Phi \\cdot \\nabla \\Phi \\, dx,\n$$\n作为来自 $T_{1}$ 和 $T_{2}$ 的相应局部贡献之和。\n\n提供 $A$ 的最终值，为一个精确的数字。无需四舍五入。", "solution": "用户提供了一个在 Crouzeix-Raviart (CR) 非协调有限元方法背景下待解决的问题。\n\n### 步骤 1：提取已知条件\n- **问题**：在区域 $\\Omega = [0,1]^{2}$ 上的 $-\\Delta u = f$。\n- **边界条件**：齐次狄利克雷条件，$u=0$ on $\\partial\\Omega$。\n- **三角剖分**：$\\mathcal{T}_{h}$ 由两个三角形 $T_{1}$ 和 $T_{2}$ 组成。\n- **三角形 $T_{1}$**：顶点 $v_{1} = (0,0)$，$v_{2} = (1,0)$，$v_{3} = (1,1)$。\n- **三角形 $T_{2}$**：顶点 $w_{1} = (0,0)$，$w_{2} = (1,1)$，$w_{3} = (0,1)$。\n- **有限元空间**：Crouzeix-Raviart 非协调 $\\mathbb{P}_{1}$ 空间。\n- **自由度**：边中点的值。\n- **边界条件实施**：边界边上的自由度设置为零。\n- **双线性形式**：$a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$。\n- **基本事实 1**：在三角形 $T$ 上，与边 $e$ 相关的任何 CR 基函数在 $T$ 上都是仿射的，并由其在 $T$ 的三个边中点处的值唯一确定。\n- **基本事实 2**：三角形上的重心坐标 $\\lambda_{i}$ 是仿射的，满足 $\\lambda_{i}(v_{i}) = 1$ 和当 $j \\neq i$ 时 $\\lambda_{i}(v_{j})=0$，以及 $\\sum_{i=1}^3 \\lambda_{i} = 1$。\n- **基本事实 3**：仿射函数的梯度在三角形上是常数。\n- **任务 1**：推导局部 CR 基函数 $\\psi_{i}^{T}$ 关于重心坐标的显式形式，以及局部刚度矩阵项 $K^{\\mathrm{CR}}_{T}(i,j) = \\int_{T} \\nabla \\psi_{i}^{T} \\cdot \\nabla \\psi_{j}^{T} \\, dx$ 的公式。\n- **任务 2**：计算 $3 \\times 3$ 的局部刚度矩阵 $K^{\\mathrm{CR}}_{T_{1}}$ 和 $K^{\\mathrm{CR}}_{T_{2}}$。\n- **任务 3**：为单个内部边基函数 $\\Phi$ 组装标量全局刚度项 $A = \\int_{\\Omega} |\\nabla\\Phi|^2 \\, dx$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它描述了有限元方法的一个标准应用，这是偏微分方程数值分析中的一个核心课题。所使用的概念——泊松方程、弱形式、Crouzeix-Raviart 元、重心坐标和刚度矩阵组装——都是完善且严格定义的。该问题是自包含的，提供了所有必要的信息。任务结构逻辑清晰，引导求解者从局部单元推导到全局组装。问题是客观的，没有任何歧义或矛盾。\n\n### 步骤 3：结论与行动\n问题是**有效的**。下面将提供一个完整的、有理有据的解答。\n\n### 解答\n\n#### 第 1 部分：局部基函数和刚度矩阵公式的推导\n\n设 $T$ 是一个顶点为 $v_1, v_2, v_3$ 的三角形。设 $\\lambda_1, \\lambda_2, \\lambda_3$ 是对应的重心坐标。边 $e_i$ 表示顶点 $v_i$ 的对边，$e_i$ 的中点是 $m_{e_i}$。CR 基函数 $\\psi_i^T$ 是 $T$ 上的一个仿射函数，由条件 $\\psi_i^T(m_{e_i}) = 1$ 和当 $j \\neq i$ 时 $\\psi_i^T(m_{e_j}) = 0$ 定义。\n\n重心坐标 $\\lambda_k$ 在一条边的中点处的值，例如 $m_{e_1} = (v_2+v_3)/2$，由 $\\lambda_k(m_{e_1}) = \\frac{1}{2}(\\lambda_k(v_2) + \\lambda_k(v_3))$ 给出。利用性质 $\\lambda_k(v_j) = \\delta_{kj}$，我们求出重心坐标在三个边中点处的值：\n- 在 $m_{e_1}$ 处：$\\lambda_1(m_{e_1}) = 0$，$\\lambda_2(m_{e_1}) = \\frac{1}{2}$，$\\lambda_3(m_{e_1}) = \\frac{1}{2}$。\n- 在 $m_{e_2}$ 处：$\\lambda_1(m_{e_2}) = \\frac{1}{2}$，$\\lambda_2(m_{e_2}) = 0$，$\\lambda_3(m_{e_2}) = \\frac{1}{2}$。\n- 在 $m_{e_3}$ 处：$\\lambda_1(m_{e_3}) = \\frac{1}{2}$，$\\lambda_2(m_{e_3}) = \\frac{1}{2}$，$\\lambda_3(m_{e_3}) = 0$。\n\n我们寻求一个用仿射函数 $\\lambda_j$ 表示的仿射函数 $\\psi_i^T$。让我们测试候选函数 $1 - 2\\lambda_i$。对于 $i=1$，函数是 $1 - 2\\lambda_1$。我们在中点处对其求值：\n- 在 $m_{e_1}$ 处：$1 - 2\\lambda_1(m_{e_1}) = 1 - 2(0) = 1$。\n- 在 $m_{e_2}$ 处：$1 - 2\\lambda_1(m_{e_2}) = 1 - 2(\\frac{1}{2}) = 0$。\n- 在 $m_{e_3}$ 处：$1 - 2\\lambda_1(m_{e_3}) = 1 - 2(\\frac{1}{2}) = 0$。\n这些值与 $\\psi_1^T$ 的定义相符。由于三角形上的仿射函数由其在三个不共线点（如边中点）的值唯一确定，因此这是正确的形式。根据对称性，边 $e_i$ 的局部基函数为 $\\psi_i^T = 1 - 2\\lambda_i$。\n\n接下来，我们推导局部刚度矩阵项 $K^{\\mathrm{CR}}_{T}(i,j) = \\int_{T} \\nabla \\psi_{i}^{T} \\cdot \\nabla \\psi_{j}^{T} \\, dx$ 的公式。\n对基函数求梯度得到 $\\nabla \\psi_i^T = \\nabla(1 - 2\\lambda_i) = -2 \\nabla \\lambda_i$。由于 $\\lambda_i$ 是一个仿射函数，其梯度 $\\nabla\\lambda_i$ 在 $T$ 上是一个常数向量。因此，被积函数在 $T$ 上也是常数：\n$$ \\nabla \\psi_{i}^{T} \\cdot \\nabla \\psi_{j}^{T} = (-2 \\nabla \\lambda_i) \\cdot (-2 \\nabla \\lambda_j) = 4 (\\nabla \\lambda_i \\cdot \\nabla \\lambda_j) $$\n常数在三角形面积上的积分等于该常数乘以面积 $|T|$。\n$$ K^{\\mathrm{CR}}_{T}(i,j) = \\int_{T} 4 (\\nabla \\lambda_i \\cdot \\nabla \\lambda_j) \\, dx = 4 |T| (\\nabla \\lambda_i \\cdot \\nabla \\lambda_j) $$\n\n#### 第 2 部分：$T_1$ 和 $T_2$ 局部刚度矩阵的计算\n\n对于顶点为 $(x_1, y_1), (x_2, y_2), (x_3, y_3)$ 的三角形，其面积为 $|T| = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|$，重心坐标的梯度由以下公式给出：\n$$ \\nabla \\lambda_1 = \\frac{1}{2|T|} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix}, \\quad \\nabla \\lambda_2 = \\frac{1}{2|T|} \\begin{pmatrix} y_3 - y_1 \\\\ x_1 - x_3 \\end{pmatrix}, \\quad \\nabla \\lambda_3 = \\frac{1}{2|T|} \\begin{pmatrix} y_1 - y_2 \\\\ x_2 - x_1 \\end{pmatrix} $$\n对于顶点为 $v_1=(0,0)$, $v_2=(1,0)$, $v_3=(1,1)$ 的三角形 $T_1$：\n面积为 $|T_1| = \\frac{1}{2} |0(0-1) + 1(1-0) + 1(0-0)| = \\frac{1}{2}$。因此，$2|T_1| = 1$。\n梯度为：\n$$ \\nabla \\lambda_1^{T_1} = \\begin{pmatrix} 0-1 \\\\ 1-1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla \\lambda_2^{T_1} = \\begin{pmatrix} 1-0 \\\\ 0-1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla \\lambda_3^{T_1} = \\begin{pmatrix} 0-0 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n点积矩阵 $(\\nabla \\lambda_i^{T_1} \\cdot \\nabla \\lambda_j^{T_1})$ 为：\n$$ \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} $$\n局部刚度矩阵为 $K_{T_1}^{\\mathrm{CR}}(i,j) = 4 |T_1| (\\nabla \\lambda_i^{T_1} \\cdot \\nabla \\lambda_j^{T_1}) = 2 (\\nabla \\lambda_i^{T_1} \\cdot \\nabla \\lambda_j^{T_1})$：\n$$ K^{\\mathrm{CR}}_{T_1} = 2 \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} = \\begin{pmatrix} 2  -2  0 \\\\ -2  4  -2 \\\\ 0  -2  2 \\end{pmatrix} $$\n对于顶点为 $w_1=(0,0)$, $w_2=(1,1)$, $w_3=(0,1)$ 的三角形 $T_2$，我们令 $v_1=w_1, v_2=w_2, v_3=w_3$。\n面积为 $|T_2| = \\frac{1}{2} |0(1-1) + 1(1-0) + 0(0-1)| = \\frac{1}{2}$。因此，$2|T_2| = 1$。\n梯度为：\n$$ \\nabla \\lambda_1^{T_2} = \\begin{pmatrix} 1-1 \\\\ 0-1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}, \\quad \\nabla \\lambda_2^{T_2} = \\begin{pmatrix} 1-0 \\\\ 0-0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla \\lambda_3^{T_2} = \\begin{pmatrix} 0-1 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} $$\n点积矩阵 $(\\nabla \\lambda_i^{T_2} \\cdot \\nabla \\lambda_j^{T_2})$ 为：\n$$ \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ -1  -1  2 \\end{pmatrix} $$\n局部刚度矩阵为 $K_{T_2}^{\\mathrm{CR}}(i,j) = 4 |T_2| (\\nabla \\lambda_i^{T_2} \\cdot \\nabla \\lambda_j^{T_2}) = 2 (\\nabla \\lambda_i^{T_2} \\cdot \\nabla \\lambda_j^{T_2})$：\n$$ K^{\\mathrm{CR}}_{T_2} = 2 \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ -1  -1  2 \\end{pmatrix} = \\begin{pmatrix} 2  0  -2 \\\\ 0  2  -2 \\\\ -2  -2  4 \\end{pmatrix} $$\n\n#### 第 3 部分：全局刚度项的组装\n\n该网格有一条内部边，即从 $(0,0)$ 到 $(1,1)$ 的对角线。由于齐次狄利克雷边界条件，唯一活动的自由度对应于这条内部边。设 $\\Phi$ 为该自由度的全局基函数。全局刚度项为 $A = a(\\Phi, \\Phi) = \\int_{\\Omega} |\\nabla\\Phi|^2 \\, dx$。这是来自 $T_1$ 和 $T_2$ 的贡献之和：\n$$ A = \\int_{T_1} |\\nabla\\Phi|^2 \\, dx + \\int_{T_2} |\\nabla\\Phi|^2 \\, dx $$\n在顶点为 $v_1(0,0), v_2(1,0), v_3(1,1)$ 的 $T_1$ 上，从 $(0,0)$ 到 $(1,1)$ 的内部边是顶点 $v_2$ 的对边。因此，$\\Phi$ 在 $T_1$ 上的限制是局部基函数 $\\psi_2^{T_1}$。来自 $T_1$ 的贡献是 $\\int_{T_1} |\\nabla\\psi_2^{T_1}|^2 \\, dx = K^{\\mathrm{CR}}_{T_1}(2,2)$。\n\n在顶点为 $w_1(0,0), w_2(1,1), w_3(0,1)$ 的 $T_2$ 上，从 $(0,0)$ 到 $(1,1)$ 的内部边是连接 $w_1$ 和 $w_2$ 的边。这是顶点 $w_3$ 的对边。使用我们的计算映射 $v_1=w_1, v_2=w_2, v_3=w_3$，这对应于 $v_3$ 的对边。因此，$\\Phi$ 在 $T_2$ 上的限制是局部基函数 $\\psi_3^{T_2}$。来自 $T_2$ 的贡献是 $\\int_{T_2} |\\nabla\\psi_3^{T_2}|^2 \\, dx = K^{\\mathrm{CR}}_{T_2}(3,3)$。\n\n全局刚度项是这些局部对角线项的和：\n$$ A = K^{\\mathrm{CR}}_{T_1}(2,2) + K^{\\mathrm{CR}}_{T_2}(3,3) $$\n使用第 2 部分计算的矩阵：\n$$ K^{\\mathrm{CR}}_{T_1}(2,2) = 4 $$\n$$ K^{\\mathrm{CR}}_{T_2}(3,3) = 4 $$\n因此，最终值为：\n$$ A = 4 + 4 = 8 $$", "answer": "$$\\boxed{8}$$", "id": "3376155"}, {"introduction": "一个数值方法只有当它能收敛到正确解时才是有用的。对于非协调元，这一点通过“膜片检验”（patch test）来验证，它确保该方法能够精确地重现简单的多项式解。本练习深入探讨了 CR 元通过此检验所需的数学条件，让你洞察保证其相容性和收敛性的理论基础。[@problem_id:3376183]", "problem": "考虑一个三角形网格上的二阶椭圆偏微分方程的 Crouzeix–Raviart 非协调有限元。每个三角形上的局部多项式空间是线性多项式空间 $\\mathbb{P}_{1}$，自由度是每条边上一个点的点值。三角形 $\\mathcal{T}$ 上的 Crouzeix–Raviart 插值被定义为 $\\mathbb{P}_{1}$ 中唯一的函数，其在三个选定的边点处的值与目标函数的值相匹配。一个标准的一致性（斑片）检验要求所有全局线性位移场 $u(x,y)=a+bx+cy$ 都被精确重现。\n\n设 $\\mathcal{T}$ 是一个扭曲的三角形，其顶点为 $V_{1}=(0,0)$、$V_{2}=(1,\\varepsilon)$ 和 $V_{3}=(\\eta,1)$，其中 $\\varepsilon$ 和 $\\eta$ 是固定的实参数，使得该三角形非退化。在 $\\mathcal{T}$ 的每条边上，将自由度点设置在该边弦长的一部分处，从该边列出的第一个端点开始测量：\n- 在边 $V_{2}V_{3}$ 上，取点 $P_{1}=V_{2}+\\alpha_{1}(V_{3}-V_{2})$，其中 $0  \\alpha_{1}  1$。\n- 在边 $V_{3}V_{1}$ 上，取点 $P_{2}=V_{3}+\\alpha_{2}(V_{1}-V_{3})$，其中 $0  \\alpha_{2}  1$。\n- 在边 $V_{1}V_{2}$ 上，取点 $P_{3}=V_{1}+\\alpha_{3}(V_{2}-V_{1})$，其中 $0  \\alpha_{3}  1$。\n\n定义 $3\\times 3$ 的类范德蒙插值矩阵\n$$\n\\mathbf{M}=\\begin{pmatrix}\n1  x(P_{1})  y(P_{1})\\\\\n1  x(P_{2})  y(P_{2})\\\\\n1  x(P_{3})  y(P_{3})\n\\end{pmatrix},\n$$\n其中 $(x(P_{k}),y(P_{k}))$ 是 $P_{k}$ (对于 $k=1,2,3$) 的笛卡尔坐标。单值性（以及在 $\\mathcal{T}$ 上精确重现所有线性场）等价于 $\\det(\\mathbf{M})\\neq 0$。请计算行列式 $\\det(\\mathbf{M})$ 的显式闭式解析表达式，用 $\\varepsilon$、$\\eta$、$\\alpha_{1}$、$\\alpha_{2}$ 和 $\\alpha_{3}$ 表示，并尽可能简化。报告您关于 $\\det(\\mathbf{M})$ 的最终表达式。无需四舍五入。\n\n此外，在您的推导中，从基本原理出发解释为什么用于精确重现 $u(x,y)=a+bx+cy$ 的斑片检验要求共享一条边的两个相邻三角形在该共享边上选择相同的物理点（即，考虑到边的定向，边上分数位置相同）。您的最终报告表达式中不要包含不等式或条件；只提供所要求的 $\\det(\\mathbf{M})$ 的符号公式。", "solution": "该问题包含两部分。第一部分是计算与特定三角形上的 Crouzeix-Raviart 单元相关的类范德蒙矩阵的行列式。第二部分是为斑片检验所要求的一个条件提供基于基本原理的解释。\n\n### 第一部分：计算 $\\det(\\mathbf{M})$\n\n要求计算三角形 $\\mathcal{T}$（顶点为 $V_{1}=(0,0)$、$V_{2}=(1,\\varepsilon)$ 和 $V_{3}=(\\eta,1)$）的矩阵 $\\mathbf{M}$ 的行列式。矩阵 $\\mathbf{M}$ 由下式给出：\n$$\n\\mathbf{M}=\\begin{pmatrix}\n1  x(P_{1})  y(P_{1})\\\\\n1  x(P_{2})  y(P_{2})\\\\\n1  x(P_{3})  y(P_{3})\n\\end{pmatrix}\n$$\n$\\det(\\mathbf{M})$ 的值是由点 $P_{1}$、$P_{2}$ 和 $P_{3}$ 构成的三角形有向面积的两倍。一个强大的计算方法是使用重心坐标。\n\n设三角形 $\\mathcal{T}$ 的顶点用向量 $V_1$、$V_2$ 和 $V_3$ 表示。三角形内的任何点 $P$ 都可以写成线性组合 $P = \\lambda_1 V_1 + \\lambda_2 V_2 + \\lambda_3 V_3$，其中 $\\lambda_1, \\lambda_2, \\lambda_3$ 是重心坐标，满足 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$。点 $P_1, P_2, P_3$ 定义在 $\\mathcal{T}$ 的边上：\n$P_{1}=V_{2}+\\alpha_{1}(V_{3}-V_{2}) = (1-\\alpha_1)V_2 + \\alpha_1V_3$。其重心坐标为 $(0, 1-\\alpha_1, \\alpha_1)$。\n$P_{2}=V_{3}+\\alpha_{2}(V_{1}-V_{3}) = \\alpha_2V_1 + (1-\\alpha_2)V_3$。其重心坐标为 $(\\alpha_2, 0, 1-\\alpha_2)$。\n$P_{3}=V_{1}+\\alpha_{3}(V_{2}-V_{1}) = (1-\\alpha_3)V_1 + \\alpha_3V_2$。其重心坐标为 $(1-\\alpha_3, \\alpha_3, 0)$。\n\n以 $P_1, P_2, P_3$ 为顶点的三角形的有向面积与以 $V_1, V_2, V_3$ 为顶点的三角形的有向面积之间的关系，由重心坐标矩阵的行列式决定。设 $\\mathcal{A}(A, B, C)$ 表示以 $A, B, C$ 为顶点的三角形的有向面积。该关系为：\n$$\n\\mathcal{A}(P_1, P_2, P_3) = \\det(\\Lambda) \\cdot \\mathcal{A}(V_1, V_2, V_3)\n$$\n其中 $\\Lambda$ 是行向量为 $P_1, P_2, P_3$ 重心坐标的矩阵：\n$$\n\\Lambda = \\begin{pmatrix}\n0  1-\\alpha_1  \\alpha_1 \\\\\n\\alpha_2  0  1-\\alpha_2 \\\\\n1-\\alpha_3  \\alpha_3  0\n\\end{pmatrix}\n$$\n$\\Lambda$ 的行列式可沿第一行使用代数余子式展开计算：\n$$\n\\det(\\Lambda) = 0 - (1-\\alpha_1)\\det\\begin{pmatrix} \\alpha_2  1-\\alpha_2 \\\\ 1-\\alpha_3  0 \\end{pmatrix} + \\alpha_1\\det\\begin{pmatrix} \\alpha_2  0 \\\\ 1-\\alpha_3  \\alpha_3 \\end{pmatrix}\n$$\n$$\n\\det(\\Lambda) = -(1-\\alpha_1)(0 - (1-\\alpha_2)(1-\\alpha_3)) + \\alpha_1(\\alpha_2\\alpha_3 - 0)\n$$\n$$\n\\det(\\Lambda) = (1-\\alpha_1)(1-\\alpha_2)(1-\\alpha_3) + \\alpha_1\\alpha_2\\alpha_3\n$$\n矩阵 $\\mathbf{M}$ 的行列式是三角形 $P_1P_2P_3$ 有向面积的两倍：\n$$\n\\det(\\mathbf{M}) = 2 \\cdot \\mathcal{A}(P_1, P_2, P_3)\n$$\n结合这些事实，我们得到：\n$$\n\\det(\\mathbf{M}) = \\det(\\Lambda) \\cdot [2 \\cdot \\mathcal{A}(V_1, V_2, V_3)]\n$$\n项 $2 \\cdot \\mathcal{A}(V_1, V_2, V_3)$ 是顶点 $V_1, V_2, V_3$ 的类范德蒙矩阵的行列式：\n$$\n2 \\cdot \\mathcal{A}(V_1, V_2, V_3) = \\det\\begin{pmatrix} 1  x(V_1)  y(V_1) \\\\ 1  x(V_2)  y(V_2) \\\\ 1  x(V_3)  y(V_3) \\end{pmatrix}\n$$\n代入给定的坐标 $V_{1}=(0,0)$、$V_{2}=(1,\\varepsilon)$ 和 $V_{3}=(\\eta,1)$：\n$$\n2 \\cdot \\mathcal{A}(V_1, V_2, V_3) = \\det\\begin{pmatrix} 1  0  0 \\\\ 1  1  \\varepsilon \\\\ 1  \\eta  1 \\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - \\varepsilon \\cdot \\eta) - 0 + 0 = 1 - \\varepsilon\\eta\n$$\n此量非零，因为假定三角形 $\\mathcal{T}$ 是非退化的。\n\n最后，我们代入 $\\det(\\Lambda)$ 和 $2 \\cdot \\mathcal{A}(V_1, V_2, V_3)$ 的表达式，得到 $\\mathbf{M}$ 的行列式：\n$$\n\\det(\\mathbf{M}) = [\\alpha_1\\alpha_2\\alpha_3 + (1-\\alpha_1)(1-\\alpha_2)(1-\\alpha_3)](1-\\varepsilon\\eta)\n$$\n单值性条件 $\\det(\\mathbf{M}) \\neq 0$ 要求此表达式非零。由于对于 $k=1,2,3$ 有 $0  \\alpha_k  1$，所以项 $\\alpha_1\\alpha_2\\alpha_3$ 和 $(1-\\alpha_1)(1-\\alpha_2)(1-\\alpha_3)$ 都严格为正。它们的和也因此严格为正。由于三角形 $\\mathcal{T}$ 是非退化的，所以 $1-\\varepsilon\\eta \\neq 0$。因此，$\\det(\\mathbf{M})$ 永不为零，这证实了对于任何内部边点选择，单元上都具有单值性。\n\n### 第二部分：斑片检验解释\n\n斑片检验验证有限元格式能否在一片单元上精确重现某一类多项式（在此情况下为线性多项式 $u(x,y)=a+bx+cy$）。要求相邻单元在其共享边上必须使用相同的物理点，这一要求源于全局有限元空间的基本构造。\n\n1.  **全局有限元空间构造**：全局有限元函数 $u_h$ 并非整个定义域上的单个多项式。相反，它是一组局部多项式的集合，网格中的每个单元（三角形）$\\mathcal{T}$ 都有一个，即 $u_h|_\\mathcal{T} = p_\\mathcal{T} \\in \\mathbb{P}_1$。这些局部多项式被“缝合”在一起，形成一个全局定义的函数。\n\n2.  **自由度 (DoFs)**：缝合是通过定义一组全局自由度 (DoFs) 来实现的。对于 Crouzeix-Raviart 单元，DoFs 是网格每条边上一个指定点的函数值。设 $E$ 是网格中的一条边，并设 $P_E$ 是为 DoF 在 $E$ 上选择的点。与 $E$ 相关的 DoF 是值 $d_E = u_h(P_E)$。\n\n3.  **全局空间的适定性**：为使全局空间是适定的，每个 DoF 必须有单一、明确的值。考虑一条由两个三角形 $\\mathcal{T}_1$ 和 $\\mathcal{T}_2$ 共享的内部边 $E$。设 $p_1 = u_h|_{\\mathcal{T}_1}$ 和 $p_2 = u_h|_{\\mathcal{T}_2}$。共享边 $E$ 的单个 DoF $d_E$ 同时约束 $p_1$ 和 $p_2$。这只有在两个局部多项式都在边上的*完全相同的物理点* $P_E$ 处求值时才可能实现。也就是说，强制执行连续性条件 $p_1(P_E) = p_2(P_E) = d_E$。如果 $\\mathcal{T}_1$ 使用了点 $P_a \\in E$，而 $\\mathcal{T}_2$ 使用了另一个点 $P_b \\in E$，那么边 $E$ 就不会有单个 DoF，而是两个独立的约束。这将破坏单元之间的耦合和组装过程，使得定义一个协调一致的全局有限元空间成为不可能。\n\n4.  **通过斑片检验**：假定每条边 $E$ 都使用相同的物理点 $P_E$，我们可以证明线性多项式的斑片检验是可以通过的。为了检验是否能精确重现线性场 $u(x,y)=a+bx+cy$，我们构造其有限元插值 $u_h$。这是通过将每个 DoF 的值设置为 $u$ 在相应 DoF 点处的值来完成的：对于所有边 $E$，有 $d_E = u(P_E)$。\n    - 在任何三角形 $\\mathcal{T}$ 上，局部函数 $p_\\mathcal{T} = u_h|_\\mathcal{T}$ 是由其三条边上的三个 DoF 值唯一决定的线性多项式。根据构造，这些值是 $u(P_{E_1})$、$u(P_{E_2})$ 和 $u(P_{E_3})$。\n    - 由于 $u$ 本身是一个线性多项式，而 $p_\\mathcal{T}$ 是一个在三个不共线点上与 $u$ 匹配的线性多项式（如第一部分所证），线性插值的唯一性意味着 $p_\\mathcal{T}$ 必须在 $\\mathcal{T}$ 上的任何地方都与 $u$ 完全相同。\n    - 这对于斑片中的每个三角形都成立。因此，全局插值 $u_h$ 在任何地方都与原始线性函数 $u$ 完全相同，即 $u_h \\equiv u$。斑片检验通过。\n\n总之，要求在共享边上使用相同的物理点并非斑片检验本身的结果，而是全局 Crouzeix-Raviart 有限元空间适定性的先决条件。斑片检验随后证实了这个正确构造的空间具有对线性多项式的正确逼近性质。考虑边的定向是这种一致性的一部分；如果一条从 $V_i$ 到 $V_j$ 的边使用距离 $V_i$ 为 $\\alpha_k$ 分数位置的点，那么一个将该边视为从 $V_j$ 到 $V_i$ 的相邻单元必须使用距离 $V_j$ 为 $1-\\alpha_k$ 分数位置的点，以确保物理点是相同的。", "answer": "$$\n\\boxed{[\\alpha_1\\alpha_2\\alpha_3 + (1-\\alpha_1)(1-\\alpha_2)(1-\\alpha_3)](1-\\varepsilon\\eta)}\n$$", "id": "3376183"}]}