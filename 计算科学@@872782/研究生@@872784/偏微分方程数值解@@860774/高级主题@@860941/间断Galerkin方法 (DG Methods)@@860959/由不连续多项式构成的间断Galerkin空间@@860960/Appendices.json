{"hands_on_practices": [{"introduction": "在我们应用数值方法之前，首先必须理解近似空间的规模和结构。这个练习旨在通过计算间断伽辽金 (DG) 离散中的自由度 (DoFs) 数量来奠定基础。通过运用组合学的基本原理，你将推导出每个单元以及整个计算网格上的自由度数量的公式，从而清晰地理解问题规模如何随多项式阶数和空间维度扩展。[@problem_id:3379041]", "problem": "考虑一个在有界域 $\\Omega \\subset \\mathbb{R}^{d}$ 上定义的偏微分方程（PDE, Partial Differential Equation）的标量值间断Galerkin（DG, Discontinuous Galerkin）离散化，其中计算网格由 $N_{K}$ 个形状规则的单元组成，每个单元都是一个固定的参考 $d$-单纯形在仿射映射下的像。\n\n在每个单元 $K$ 上，局部逼近空间取为多项式空间 $\\mathbb{P}_{p}(K)$，该空间由所有总次数至多为 $p$ 的 $d$ 变量实值多元多项式组成。\n\n仅使用关于多元多项式和组合计数的第一性原理和核心定义，通过确定 $\\mathbb{P}_{p}(K)$ 在 $d$ 个空间维度中的维数，来推导每个单元的自由度数量。然后，推断整个网格上全局DG空间中的总自由度数，注意DG方法在单元交界面上不施加连续性约束。请将您的最终结果表示为一个单一的闭式解析表达式，该表达式包含以下两者组成的对：\n- 每个单元的自由度数，以及\n- 网格上的总自由度数。\n\n无需四舍五入。请以符号形式表达您的答案，不带单位。", "solution": "*   陈述问题目标：求 $\\mathbb{P}_p(K)$ 的维数，然后求总自由度（DoFs）。\n    *   **每个单元自由度的推导**：\n        *   将每个单元的自由度定义为多项式空间 $\\mathbb{P}_{p}(K)$ 的维数。\n        *   注意，从参考单元的仿射映射不改变多项式空间的维数。\n        *   问题简化为求总次数至多为 $p$ 的 $d$ 变量多项式空间的维数。\n        *   该空间的一个基是所有形如 $x_1^{\\alpha_1} x_2^{\\alpha_2} \\cdots x_d^{\\alpha_d}$ 的单项式的集合，其中 $\\alpha_i$ 是非负整数且 $\\sum_{i=1}^{d} \\alpha_i \\le p$。\n        *   该空间的维数就是这种单项式的数量。\n        *   将此问题表述为一个组合计数问题：求不等式 $\\alpha_1 + \\dots + \\alpha_d \\le p$ 的非负整数解 $(\\alpha_1, \\dots, \\alpha_d)$ 的数量。\n        *   引入一个松弛变量 $\\alpha_{d+1} \\ge 0$，将不等式转换为等式：$\\alpha_1 + \\dots + \\alpha_d + \\alpha_{d+1} = p$。\n        *   解释此方程的“隔板法”论证。我们正在排列 $p$ 个“星”（单位）和 $d$ 个“条”（用于分隔 $d+1$ 个变量的隔板）。总位置数为 $p+d$。我们必须从这些位置中选择 $d$ 个作为隔板。\n        *   方法的数量是 $\\binom{p+d}{d}$。\n        *   指出这就是每个单元的自由度数。\n    *   **总自由度的推导**：\n        *   解释间断Galerkin空间的性质。其关键特征是在单元交界面处缺少连续性约束。\n        *   这意味着全局解空间是每个单元上局部空间的直和：$V_h = \\bigoplus_{K \\in \\mathcal{T}_h} \\mathbb{P}_p(K)$，其中 $\\mathcal{T}_h$ 是网格。\n        *   向量空间直和的维数是它们各自维数的和。\n        *   因此，总自由度数是网格中所有单元上局部自由度的总和。\n        *   假定有 $N_K$ 个单元，且每个单元具有相同数量的自由度，则总数是 $N_K$ 乘以每个单元的自由度数。\n        *   总自由度 = $N_K \\binom{p+d}{d}$。\n    *   **综合最终的成对结果**。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\binom{p+d}{d} & N_{K} \\binom{p+d}{d}\n\\end{pmatrix}\n}\n$$", "id": "3379041"}, {"introduction": "间断伽辽金 (DG) 方法的决定性特征是允许在单元交界面上存在间断，这提供了极大的灵活性。本实践聚焦于“跳跃算子”，这是量化这些间断的数学工具。你将首先证明一个基本性质——该算子对于全局连续函数为零——然后为一个来自 DG 空间的函数计算一个非零跳跃，从而巩固你对这些空间与传统连续有限元空间区别的直观理解。[@problem_id:3379062]", "problem": "考虑在一维域 $\\Omega = (0,1)$ 上建立的标量守恒律，以及一个剖分（网格）$\\mathcal{T}_h = \\{K_1, K_2\\}$，其中 $K_1 = (0, \\frac{1}{2})$ 且 $K_2 = (\\frac{1}{2}, 1)$。令 $V_h$ 表示间断 Galerkin (DG) 空间，其由每个单元上全次数最多为一的间断多项式组成，即\n$$\nV_h = \\{ v \\in L^2(\\Omega) : v|_{K_i} \\in \\mathbb{P}_1(K_i) \\text{ for } i=1,2 \\}.\n$$\n在由 $K_1$ 和 $K_2$ 共享的内部面 $F = \\{x = \\frac{1}{2}\\}$ 上，令 $\\boldsymbol{n}^-$ 表示 $K_1$ 的单位外法向量，$\\boldsymbol{n}^+$ 表示 $K_2$ 的单位外法向量。在一维空间中，这得到在 $x = \\frac{1}{2}$ 处 $\\boldsymbol{n}^- = +1$ 且在 $x = \\frac{1}{2}$ 处 $\\boldsymbol{n}^+ = -1$。对于一个标量函数 $v$，定义在 $F$ 上的跳跃算子为\n$$\n[v] := v^- \\boldsymbol{n}^- + v^+ \\boldsymbol{n}^+,\n$$\n其中 $v^-$ 和 $v^+$ 分别表示从 $K_1$ 和 $K_2$ 内部取值的 $v$ 在 $F$ 上的迹。\n\n从 Lebesgue 空间 $L^2(\\Omega)$、Sobolev 空间 $H^1(\\Omega)$、界面上的迹以及上述跳跃算子的基本定义出发，分析跳跃算子零化全局连续函数的性质：证明如果 $u \\in H^1(\\Omega)$ 在 $\\overline{\\Omega}$ 上是全局连续的，则在 $F$ 上有 $[u] = 0$。\n\n然后，在空间 $V_h$ 内构造一个展示非零跳跃的反例，如下定义 $v_h \\in V_h$：\n$$\nv_h(x) = \\begin{cases}\nx, & x \\in K_1,\\\\\nx + \\frac{1}{4}, & x \\in K_2.\n\\end{cases}\n$$\n计算在面 $F$ 处的跳跃 $[v_h]$。你的最终答案必须是 $[v_h]$ 的精确值，写成一个单独的数字（无单位）。如果需要四舍五入，请保留四位有效数字，但在本题中，期望得到一个精确值。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n- **域**：$\\Omega = (0,1)$\n- **网格**：$\\mathcal{T}_h = \\{K_1, K_2\\}$，其中 $K_1 = (0, \\frac{1}{2})$ 且 $K_2 = (\\frac{1}{2}, 1)$。\n- **有限元空间**：$V_h = \\{ v \\in L^2(\\Omega) : v|_{K_i} \\in \\mathbb{P}_1(K_i) \\text{ for } i=1,2 \\}$，其中 $\\mathbb{P}_1(K_i)$ 是单元 $K_i$ 上全次数最多为一的多项式空间。\n- **内部面**：$F = \\{x = \\frac{1}{2}\\}$。\n- **F 处的法向量**：$\\boldsymbol{n}^- = +1$（$K_1$ 的单位外法向量）和 $\\boldsymbol{n}^+ = -1$（$K_2$ 的单位外法向量）。\n- **F 处的迹**：$v^-$ 是 $v$ 在 $F$ 上从 $K_1$ 内部取值的迹（即 $\\lim_{x \\to (1/2)^-} v(x)$）。$v^+$ 是 $v$ 在 $F$ 上从 $K_2$ 内部取值的迹（即 $\\lim_{x \\to (1/2)^+} v(x)$）。\n- **跳跃算子定义**：$[v] := v^- \\boldsymbol{n}^- + v^+ \\boldsymbol{n}^+$.\n- **第一个任务**：证明对于一个全局连续函数 $u \\in H^1(\\Omega)$，其在 $F$ 上的跳跃 $[u]$ 为零。\n- **第二个任务**：对于由以下公式定义的特定函数 $v_h \\in V_h$\n$$\nv_h(x) = \\begin{cases}\nx, & x \\in K_1,\\\\\nx + \\frac{1}{4}, & x \\in K_2,\n\\end{cases}\n$$\n计算其在面 $F$ 上的跳跃 $[v_h]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行分析：\n- **科学依据**：该问题基于偏微分方程数值分析领域的标准、成熟概念和定义，特别是间断 Galerkin (DG) 方法。所有术语、空间（$L^2$, $H^1$, $\\mathbb{P}_1$）和算子在此背景下都是标准的。\n- **良态性**：该问题是良态的。它包含一个标准的证明，然后是一个直接的计算。所提供的定义足以得出一个唯一的、有意义的答案。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n- **缺陷清单**：该问题没有表现出任何列出的缺陷。它在数学上是合理的、形式化的、完整的、内部一致的，并且与 DG 方法的主题直接相关。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供解答。\n\n该问题包含两部分。第一部分是证明所定义的跳跃算子能零化 $H^1(\\Omega)$ 中的全局连续函数。第二部分是计算空间 $V_h$ 中一个特定间断函数的跳跃。\n\n对于第一部分，令 $u$ 是一个函数，使得 $u \\in H^1(\\Omega)$ 并且 $u$ 在闭域 $\\overline{\\Omega} = [0,1]$ 上是全局连续的。界面 $F$ 位于点 $x = \\frac{1}{2}$ 处。\n迹 $u^-$ 是从单元 $K_1 = (0, \\frac{1}{2})$ 内部逼近 $u$ 的值。这是左极限：\n$$\nu^- = \\lim_{x \\to (1/2)^-} u(x)\n$$\n迹 $u^+$ 是从单元 $K_2 = (\\frac{1}{2}, 1)$ 内部逼近 $u$ 的值。这是右极限：\n$$\nu^+ = \\lim_{x \\to (1/2)^+} u(x)\n$$\n因为函数 $u$ 在 $\\overline{\\Omega}$ 上是连续的，所以它在 $x = \\frac{1}{2}$ 处必然是连续的。对于一个连续函数，其左极限、右极限以及函数在该点的值都相等。因此，\n$$\nu^- = u^+ = u(\\frac{1}{2})\n$$\n现在，我们应用在面 $F$ 上的跳跃算子 $[u]$ 的定义：\n$$\n[u] = u^- \\boldsymbol{n}^- + u^+ \\boldsymbol{n}^+\n$$\n问题陈述，在 $x=\\frac{1}{2}$ 处，$K_1$ 的单位外法向量是 $\\boldsymbol{n}^- = +1$，而 $K_2$ 的单位外法向量是 $\\boldsymbol{n}^+ = -1$。将这些值和迹代入跳跃的定义中，得到：\n$$\n[u] = u^-(+1) + u^+(-1) = u^- - u^+\n$$\n由于我们已经因为连续性确立了 $u^- = u^+$，我们发现：\n$$\n[u] = u^- - u^- = 0\n$$\n这表明对于任何全局连续函数，所定义的跳跃算子的计算结果为零。这是一个关键性质，它将连续（$H^1$协调）函数与通常在 DG 空间中发现的间断函数区分开来。\n\n对于问题的第二部分，我们需要计算一个特定函数 $v_h \\in V_h$ 的跳跃。该函数定义如下：\n$$\nv_h(x) = \\begin{cases}\nx, & x \\in K_1 = (0, \\frac{1}{2}) \\\\\nx + \\frac{1}{4}, & x \\in K_2 = (\\frac{1}{2}, 1)\n\\end{cases}\n$$\n这个函数在每个单元 $K_i$ 上都由一阶多项式构成，因此它是空间 $V_h$ 的一个有效成员。我们需要计算它在内部面 $F = \\{x = \\frac{1}{2}\\}$ 上的跳跃 $[v_h]$。\n\n首先，我们计算在 $x = \\frac{1}{2}$ 处的迹 $v_h^-$ 和 $v_h^+$。\n从左侧（从 $K_1$ 内部）的迹是：\n$$\nv_h^- = \\lim_{x \\to (1/2)^-} v_h(x) = \\lim_{x \\to (1/2)^-} x = \\frac{1}{2}\n$$\n从右侧（从 $K_2$ 内部）的迹是：\n$$\nv_h^+ = \\lim_{x \\to (1/2)^+} v_h(x) = \\lim_{x \\to (1/2)^+} \\left(x + \\frac{1}{4}\\right) = \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{4}\n$$\n正如对 $V_h$ 中的函数所预期的那样，这两个迹不相等，表明在单元界面处存在间断。\n\n现在，我们使用跳跃算子的定义 $[v_h] = v_h^- \\boldsymbol{n}^- + v_h^+ \\boldsymbol{n}^+$，以及给定的法向量 $\\boldsymbol{n}^- = +1$ 和 $\\boldsymbol{n}^+ = -1$：\n$$\n[v_h] = \\left(\\frac{1}{2}\\right) (+1) + \\left(\\frac{3}{4}\\right) (-1)\n$$\n$$\n[v_h] = \\frac{1}{2} - \\frac{3}{4}\n$$\n为了进行分数减法，我们找到公分母，即 4：\n$$\n[v_h] = \\frac{2}{4} - \\frac{3}{4} = -\\frac{1}{4}\n$$\n函数 $v_h$ 在面 $F$ 处的跳跃是 $-\\frac{1}{4}$。", "answer": "$$\\boxed{-\\frac{1}{4}}$$", "id": "3379062"}, {"introduction": "在理解了 DG 空间及其性质之后，最后一步是构建偏微分方程 (PDE) 的离散形式。这个练习将指导你推导半离散常微分方程 (ODE) 系统 $M\\dot{\\boldsymbol{u}} = \\boldsymbol{f}(\\boldsymbol{u})$。你将通过推导质量矩阵 $M$ 来发现基函数的关键作用，并看到正交基（如勒让德多项式）如何使其成为对角矩阵，这一特性极大地简化了显式和隐式时间推进格式的计算。[@problem_id:3379043]", "problem": "考虑标量线性平流偏微分方程（PDE），定义在周期域 $\\Omega = (0,L)$ 上，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\n$$\n其平流速度为常数 $a>0$ 且带有周期性边界条件。将 $\\Omega$ 剖分为 $N$ 个长度为 $h = L/N$ 的均匀单元 $\\{K_j\\}_{j=1}^{N}$，并定义间断 Galerkin（DG）有限元空间 $\\mathbb{V}_{h}^{p}$，该空间由每个单元上次数至多为 $p$ 的不连续分片多项式构成。在每个单元 $K_j$ 上，使用由参考坐标 $\\xi \\in [-1,1]$ 上的 Legendre 多项式 $\\{L_i(\\xi)\\}_{i=0}^{p}$ 构成的模态基，其中参考坐标通过仿射映射 $x = x_{j} + \\frac{h}{2}\\,\\xi$ 与物理坐标关联， $x_{j}$ 是 $K_j$ 的中心。将半离散近似解 $u_h(x,t)$ 表示为\n$$\nu_h(x,t)|_{K_j} = \\sum_{i=0}^{p} \\hat{u}_{j,i}(t)\\,L_i(\\xi).\n$$\n从该偏微分方程及其在每个单元上的标准弱形式出发，逐单元进行分部积分，并通过在界面处使用迎风通量来强制数值通量的连续性。推导紧凑形式的半离散常微分方程（ODE）系统\n$$\nM\\,\\dot{\\boldsymbol{u}}(t) = \\boldsymbol{f}(\\boldsymbol{u}(t)),\n$$\n其中 $M$ 是由局部单元质量矩阵组装成的全局质量矩阵，$\\boldsymbol{f}$ 包含体积分项和界面通量项的平流贡献。\n\n然后，在指定的均匀网格和模态 Legendre 基下，确定每个局部质量矩阵 $M^{(j)}$ 的显式对角形式，并由此获得其逆矩阵的元素。从第一性原理出发，不使用任何预先给定的公式，讨论在显式和隐式时间积分格式中应用或求逆质量矩阵的策略，并说明所选基底如何影响计算复杂性。\n\n你的最终答案必须是局部逆质量矩阵的对角元素 $((M^{(j)})^{-1})_{ii}$ 的单一闭式解析表达式，该表达式是单元长度 $h$ 和模态指数 $i \\in \\{0,\\dots,p\\}$ 的函数。不需要进行数值计算。", "solution": "问题陈述经过严格验证，确认有效。这是一个偏微分方程数值分析领域的标准、适定问题，特别涉及间断 Galerkin（DG）方法。所有必要组成部分均已提供，不存在科学或逻辑上的矛盾。\n\n我们首先在单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$ 上推导线性平流方程 $\\partial_{t} u + a\\,\\partial_{x} u = 0$ 的半离散格式。我们将该偏微分方程乘以一个测试函数 $v_h \\in \\mathbb{V}_{h}^{p}$ 并在 $K_j$ 上积分：\n$$\n\\int_{K_j} \\partial_t u_h(x,t) v_h(x) \\,dx + \\int_{K_j} a\\,\\partial_x u_h(x,t) v_h(x) \\,dx = 0.\n$$\n对第二项（平流项）进行分部积分，得到：\n$$\n\\int_{K_j} a\\,\\partial_x u_h v_h \\,dx = \\left[ a u_h v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{K_j} a u_h \\partial_x v_h \\,dx.\n$$\n将其代回第一个方程，我们得到单元 $K_j$ 上的弱形式：\n$$\n\\int_{K_j} \\partial_t u_h v_h \\,dx - \\int_{K_j} a u_h \\partial_x v_h \\,dx + \\left[ a u_h v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0.\n$$\n边界项展开为 $a u_h(x_{j+1/2}^-)v_h(x_{j+1/2}^-) - a u_h(x_{j-1/2}^-)v_h(x_{j-1/2}^-)$，其中记号 $u_h(x^\\pm)$ 表示函数 $u_h$ 在界面左侧 ($x^-$) 或右侧 ($x^+$) 的迹。由于 $v_h$ 是 $K_j$ 内的测试函数，其迹是单值的，即 $v_h(x_{j+1/2}^-)=v_h(x_{j+1/2})$ 且 $v_h(x_{j-1/2}^-)=v_h(x_{j-1/2})$。\n\n为确保单元间的信息交流，界面上的物理通量 $a u_h$ 被数值通量所替代，记为 $f^*(u_h^-, u_h^+)$。对于给定的平流速度 $a>0$ 的问题，迎风通量是合适的，此时信息从左向右传播。因此，通量由“迎风”状态决定，即界面左侧的状态：$f^*(u_h^-, u_h^+) = a u_h^-$。\n在 $K_j$ 的右边界 $x_{j+1/2}$ 处，迎风状态是来自 $K_j$ 的内部迹，即 $u_h(x_{j+1/2}^-)$。\n在 $K_j$ 的左边界 $x_{j-1/2}$ 处，迎风状态是来自左侧相邻单元 $K_{j-1}$ 的内部迹，即 $u_h(x_{j-1/2}^-)|_{K_{j-1}}$。由于周期性边界条件，对于 $j=1$，其左侧的邻居是 $K_N$。\n\n包含数值通量的弱形式变为：\n$$\n\\frac{d}{dt}\\int_{K_j} u_h v_h \\,dx = \\int_{K_j} a u_h \\partial_x v_h \\,dx - a u_h(x_{j+1/2}^-)|_{K_j} v_h(x_{j+1/2}) + a u_h(x_{j-1/2}^-)|_{K_{j-1}} v_h(x_{j-1/2}).\n$$\n我们现在引入指定的模态基。在每个单元 $K_j$ 上，解 $u_h$ 表示为 Legendre 多项式 $L_i(\\xi)$ 的线性组合，其中 $\\xi \\in [-1,1]$ 是参考坐标：\n$$\nu_h(x,t)|_{K_j} = \\sum_{i=0}^{p} \\hat{u}_{j,i}(t) L_i(\\xi(x)).\n$$\n我们选择测试函数 $v_h$ 为基函数本身，即 $v_h(x) = L_k(\\xi(x))$，其中 $k \\in \\{0, \\dots, p\\}$。从物理坐标 $x$ 到参考坐标 $\\xi$ 的映射为 $x = x_j + \\frac{h}{2}\\xi$，这意味着 $dx = \\frac{h}{2}d\\xi$ 且 $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$。\n\n将展开式代入弱形式的左侧（LHS）：\n$$\n\\text{LHS} = \\frac{d}{dt}\\int_{K_j} \\left( \\sum_{i=0}^{p} \\hat{u}_{j,i}(t) L_i(\\xi) \\right) L_k(\\xi) \\,dx = \\sum_{i=0}^{p} \\dot{\\hat{u}}_{j,i}(t) \\int_{K_j} L_i(\\xi) L_k(\\xi) \\,dx.\n$$\n变换到参考坐标系，积分为：\n$$\n\\int_{-1}^{1} L_i(\\xi) L_k(\\xi) \\frac{h}{2} \\,d\\xi = \\frac{h}{2} \\int_{-1}^{1} L_i(\\xi) L_k(\\xi) \\,d\\xi.\n$$\n我们使用 Legendre 多项式的基本正交性：$\\int_{-1}^{1} L_i(\\xi)L_k(\\xi) \\,d\\xi = \\frac{2}{2i+1}\\delta_{ik}$，其中 $\\delta_{ik}$ 是 Kronecker delta。\n因此，左侧（LHS）简化为：\n$$\n\\sum_{i=0}^{p} \\dot{\\hat{u}}_{j,i}(t) \\left( \\frac{h}{2} \\frac{2}{2i+1} \\delta_{ik} \\right) = \\dot{\\hat{u}}_{j,k}(t) \\frac{h}{2k+1}.\n$$\n这个表达式定义了单元 $K_j$ 局部系统的第 $k$ 行。这些系数构成了局部质量矩阵 $M^{(j)}$。对于每个 $j$，这给出了一个系统 $M^{(j)}\\dot{\\hat{\\boldsymbol{u}}}_j(t)$，其中 $\\hat{\\boldsymbol{u}}_j$ 是系数向量 $\\{\\hat{u}_{j,i}\\}_{i=0}^p$。局部质量矩阵的元素为：\n$$\n(M^{(j)})_{ki} = \\frac{h}{2k+1}\\delta_{ki}.\n$$\n弱形式的右侧（RHS）构成了向量 $\\boldsymbol{f}_j(\\boldsymbol{u})$ 的分量。将所有单元 $j=1, \\dots, N$ 的这些方程组装起来，得到全局半离散常微分方程系统 $M\\,\\dot{\\boldsymbol{u}}(t) = \\boldsymbol{f}(\\boldsymbol{u}(t))$，其中 $M$ 是以 $M^{(j)}$ 为块的块对角全局质量矩阵，$\\boldsymbol{f}$ 包含所有空间贡献。\n\n问题要求局部质量矩阵 $M^{(j)}$ 及其逆矩阵的显式形式。根据推导，由于 Legendre 基的正交性，$M^{(j)}$ 是一个对角矩阵，其元素为：\n$$\n(M^{(j)})_{ii} = \\frac{h}{2i+1} \\quad \\text{for } i \\in \\{0, \\dots, p\\}.\n$$\n对角矩阵的逆矩阵就是其对角元素取倒数后形成的对角矩阵。因此，局部逆质量矩阵 $(M^{(j)})^{-1}$ 也是对角的，其元素为：\n$$\n((M^{(j)})^{-1})_{ii} = \\left(\\frac{h}{2i+1}\\right)^{-1} = \\frac{2i+1}{h}.\n$$\n\n最后，我们讨论此结果对时间积分格式的计算影响。该常微分方程系统为 $M \\dot{\\boldsymbol{u}} = \\boldsymbol{f}(\\boldsymbol{u})$，或 $\\dot{\\boldsymbol{u}} = M^{-1}\\boldsymbol{f}(\\boldsymbol{u})$。\n\n对于一个显式时间积分格式，例如 Runge-Kutta 方法，每个阶段都需要计算右侧项 $M^{-1}\\boldsymbol{f}(\\boldsymbol{u})$。全局质量矩阵 $M$ 是由局部矩阵 $M^{(j)}$ 构成的块对角矩阵。因此，其逆矩阵 $M^{-1}$ 也是块对角的，块为 $(M^{(j)})^{-1}$。操作 $\\boldsymbol{w} = M^{-1}\\boldsymbol{g}$ 可以逐单元执行：$\\boldsymbol{w}_j = (M^{(j)})^{-1}\\boldsymbol{g}_j$。由于 $(M^{(j)})^{-1}$ 是一个对角矩阵，这个矩阵-向量乘法在计算上是微不足道的，对于每个模态都简化为标量乘法：\n$$\n(\\boldsymbol{w}_j)_i = ((M^{(j)})^{-1})_{ii} (\\boldsymbol{g}_j)_i = \\frac{2i+1}{h}(\\boldsymbol{g}_j)_i.\n$$\n总成本与自由度数呈线性关系，为 $O(N(p+1))$。这种“质量集中”（mass lumping）是正交模态基的自然结果，使得显式DG方法非常高效。如果使用非正交基（例如，节点基），$M^{(j)}$ 将是一个稠密矩阵，计算 $(M^{(j)})^{-1}\\boldsymbol{g}_j$ 需要在每个单元上求解一个小型线性系统，其计算成本通常为 $O(p^3)$，这对于高阶方法（大的 $p$）来说要昂贵得多。\n\n对于一个隐式时间积分格式，例如 Backward Euler 方法，在每个时间步都必须求解一个线性系统：$(M - \\Delta t K)\\boldsymbol{u}^{n+1} = M \\boldsymbol{u}^n$，其中 $K$ 是空间算子 $\\boldsymbol{f}(\\boldsymbol{u})$ 的矩阵表示。这个大型稀疏全局系统通常使用像 GMRES 这样的迭代方法来求解。每次迭代都需要与系统矩阵 $(M-\\Delta t K)$ 进行矩阵-向量乘法。如前所述，由于其对角结构，在此乘积中应用 $M$ 的计算成本很低。此外，迭代求解器需要预条件子来实现高效收敛。质量矩阵 $M$ 本身就是一个极好且廉价的预条件子。应用预条件子涉及求解形如 $M\\boldsymbol{z}=\\boldsymbol{r}$ 的系统，这正是为显式方法讨论的高效操作 $\\boldsymbol{z}=M^{-1}\\boldsymbol{r}$。因此，选择正交模态基对于显式和隐式格式都非常有利，因为它使质量矩阵对角化，从而简化了时间步进算法并降低了计算成本。\n\n最终答案是局部逆质量矩阵对角元素的闭式表达式。", "answer": "$$\\boxed{\\frac{2i+1}{h}}$$", "id": "3379043"}]}