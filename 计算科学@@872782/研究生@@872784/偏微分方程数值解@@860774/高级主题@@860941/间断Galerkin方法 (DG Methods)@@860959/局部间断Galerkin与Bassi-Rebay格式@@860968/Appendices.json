{"hands_on_practices": [{"introduction": "不同的间断伽辽金格式在处理高频振荡时表现出不同的特性，这直接关系到数值解的稳定性和质量。本练习将引导你在一维简化模型中，通过解析方式推导局部间断伽辽金（LDG）和 Bassi-Rebay 2（BR2）格式的刚度矩阵。通过对半离散算子进行特征值分析，我们可以直接量化并比较它们对最高频模式的固有阻尼特性，从而从根本上洞察其稳定性行为。", "problem": "考虑一维热方程 $u_t = \\nu u_{xx}$，定义在周期性区域 $x \\in [0,2]$ 上，其中扩散系数为常数 $\\nu = 1$。使用包含两个尺寸为 $h=1$ 的单元的均匀网格对该区域进行离散化，并在每个单元上使用阶数为 $p=2$ 的 Gauss–Lobatto–Legendre 基 $\\{\\phi_{0},\\phi_{1},\\phi_{2}\\}$，其节点位于 $\\xi=-1,0,1$（映射到物理单元），并采用标准的3点 Gauss–Lobatto 权重 $\\{w_{1},w_{2},w_{3}\\}=\\{\\tfrac{1}{3},\\tfrac{4}{3},\\tfrac{1}{3}\\}$。采用对角质量集中法，每个单元的质量矩阵为 $M_{e}=\\tfrac{h}{2}\\operatorname{diag}(w_{1},w_{2},w_{3})$，全局质量矩阵是块对角的。\n\n从弱形式以及针对扩散问题的局部间断伽辽金 (LDG) 和 Bassi–Rebay 2 (BR2) 格式的定义出发。对于 BR2，采用对称内部罚函数表示，其稳定化参数为 $\\sigma_{\\mathrm{BR2}}$，界面双线性形式为\n$$\na_{e}(u,v) \\;=\\; - \\nu \\left\\{ \\partial_{n} u \\right\\} [v] \\;-\\; \\nu \\left\\{ \\partial_{n} v \\right\\} [u] \\;+\\; \\nu \\,\\frac{\\sigma_{\\mathrm{BR2}}}{h}\\,[u]\\,[v],\n$$\n其中 $[u]=u^{-}-u^{+}$ 表示界面上的跳跃，$\\{\\partial_{n} u\\}=\\tfrac{1}{2}(\\partial_{n}u^{-}+\\partial_{n}u^{+})$ 是法向导数的平均值。对于 LDG，使用交替通量 LDG 格式，并通过静态凝聚辅助梯度变量来获得一个具有相同结构类型和稳定化参数 $\\sigma_{\\mathrm{LDG}}$ 的凝聚双线性形式。\n\n在给定的网格和基上，显式写出限制在高频界面子空间中的 BR2 全局刚度贡献。在该子空间中，只有单元边界处的端点自由度是活动的（即，在 $\\xi= \\pm 1$ 处的节点值可能非零，而在 $\\xi=0$ 处的内部节点值为零）。在此子空间中，BR2 刚度简化为两个 $2\\times 2$ 界面块之和，每个界面块的形式为\n$$\nK^{(\\mathrm{int})}_{\\mathrm{BR2}} \\;=\\; \\nu \\,\\frac{\\sigma_{\\mathrm{BR2}}}{h}\n\\begin{pmatrix}\n1  &-1\\\\\n-1  &1\n\\end{pmatrix}\n$$\n这两个界面块在两个界面上分别组装到相应的 $6\\times 6$ 全局布局中。该布局对应于自由度排序 $(u_{0,1},u_{0,2},u_{0,3},u_{1,1},u_{1,2},u_{1,3})$，其中 $u_{e,i}$ 表示单元 $e$ 上的第 $i$ 个节点值。使用每个节点项为 $\\frac{h}{2} w_{i}$ 的对角全局质量矩阵，对限制在界面子空间中的半离散算子 $A_{\\mathrm{BR2}} = M^{-1} K_{\\mathrm{BR2}}$ 进行特征分解，并确定其最大阻尼率（即 $A_{\\mathrm{BR2}}$ 的最大特征值），该值表征了高频耗散。\n\n类似地，用稳定化参数 $\\sigma_{\\mathrm{LDG}}$ 构建 LDG 凝聚界面刚度 $K^{(\\mathrm{int})}_{\\mathrm{LDG}}$，并在同一界面子空间上计算 $A_{\\mathrm{LDG}}=M^{-1}K_{\\mathrm{LDG}}$ 的相应最大特征值。对于 Bassi–Rebay 2 格式，取 $\\sigma_{\\mathrm{BR2}}=6$；对于采用交替通量和标准选择以得到凝聚算子的局部间断伽辽金格式，取 $\\sigma_{\\mathrm{LDG}}=2$。\n\n最后，通过计算最大特征值之比来量化高频阻尼的差异，\n$$\n\\mathcal{R} \\;=\\; \\frac{\\lambda_{\\max}(A_{\\mathrm{BR2}})}{\\lambda_{\\max}(A_{\\mathrm{LDG}})}.\n$$\n将最终答案表示为单个实数。无需单位，也无需四舍五入。", "solution": "用户希望我验证问题陈述，如果有效，则解决它。\n\n### 步骤 1：提取已知条件\n- **控制方程**：一维热方程，$u_{t} = \\nu u_{xx}$。\n- **区域**：$x \\in [0,2]$，周期性边界条件。\n- **扩散系数**：$\\nu = 1$。\n- **网格**：均匀网格，包含两个尺寸为 $h=1$ 的单元。单元为 $E_0 = [0,1]$ 和 $E_1 = [1,2]$。\n- **离散化基**：每个单元上为阶数 $p=2$ 的 Gauss–Lobatto–Legendre 基。\n- **节点**：参考单元 $[-1,1]$ 上的节点位于 $\\xi=-1, 0, 1$。\n- **求积/集中权重**：3点 Gauss–Lobatto 权重为 $\\{w_{1}, w_{2}, w_{3}\\} = \\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\}$。\n- **质量矩阵**：使用对角质量集中法。每个单元的质量矩阵为 $M_{e} = \\frac{h}{2} \\operatorname{diag}(w_{1}, w_{2}, w_{3})$。\n- **BR2 格式**：对称内部罚函数表示，界面双线性形式为 $a_{e}(u,v) = - \\nu \\{ \\partial_{n} u \\} [v] - \\nu \\{ \\partial_{n} v \\} [u] + \\nu \\frac{\\sigma_{\\mathrm{BR2}}}{h}\\,[u]\\,[v]$。界面刚度块给出为 $K^{(\\mathrm{int})}_{\\mathrm{BR2}} = \\nu \\frac{\\sigma_{\\mathrm{BR2}}}{h} \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix}$。\n- **LDG 格式**：交替通量格式，经静态凝聚得到与 BR2 结构类型相同的界面刚度，稳定化参数为 $\\sigma_{\\mathrm{LDG}}$。\n- **目标子空间**：高频界面子空间，其中内部节点值为零。这意味着只有单元边界处（$\\xi = \\pm 1$）的自由度为非零值。\n- **自由度 (DoF) 排序**：全局自由度排序为 $(u_{0,1}, u_{0,2}, u_{0,3}, u_{1,1}, u_{1,2}, u_{1,3})$，其中 $u_{e,i}$ 是单元 $e$ 上的第 $i$ 个节点值。\n- **稳定化参数**：$\\sigma_{\\mathrm{BR2}} = 6$ 和 $\\sigma_{\\mathrm{LDG}} = 2$。\n- **分析算子**：对每种格式为 $A = M^{-1} K$。\n- **目标**：计算最大特征值之比 $\\mathcal{R} = \\frac{\\lambda_{\\max}(A_{\\mathrm{BR2}})}{\\lambda_{\\max}(A_{\\mathrm{LDG}})}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了偏微分方程 (PDE) 数值分析中的一个标准过程，特别是间断伽辽金 (DG) 方法的比较。问题提法是适定的，提供了所有必要的参数、定义和明确的目标。语言精确客观。其设置，包括简化到界面子空间和提供的刚度块结构，是分析 DG 格式高频耗散的常用且有效技术。该问题是自洽的、一致的，并且计算上是可行的。没有矛盾、歧义或无效的科学前提。\n\n### 步骤 3：结论和行动\n问题有效。我现在开始求解。\n\n问题要求分析限制在特定子空间中的半离散算子 $A = M^{-1}K$。我们首先定义这个子空间和相应的矩阵。\n\n网格由两个单元组成，$E_0 = [0,1]$ 和 $E_1 = [1,2]$。对于每个单元，我们使用 $p=2$ 的基函数，节点位于 $\\xi=-1,0,1$。\n- 对于单元 $E_0$：节点对应于物理坐标 $x=0, 0.5, 1$。自由度为 $u_{0,1}, u_{0,2}, u_{0,3}$。\n- 对于单元 $E_1$：节点对应于物理坐标 $x=1, 1.5, 2$。自由度为 $u_{1,1}, u_{1,2}, u_{1,3}$。\n\n分析被限制在“高频界面子空间”中，其中内部节点值为零。内部节点位于 $\\xi=0$，对应于自由度 $u_{0,2}$ 和 $u_{1,2}$。因此，我们设置 $u_{0,2}=0$ 和 $u_{1,2}=0$。\n活动的自由度是单元边界处的节点值：\n- $x=0$ 处的 $u_{0,1}$\n- $x=1$ 处的 $u_{0,3}$\n- $x=1$ 处的 $u_{1,1}$\n- $x=2$ 处的 $u_{1,3}$\n\n区域是周期性的，所以 $x=2$ 处的界面连接到 $x=0$。我们有两个界面：一个在 $x=1$ 处，一个在 $x=0 \\equiv 2$ 处。\n在我们受限的4维子空间中，根据全局索引排序的未知向量是 $U_{sub} = (u_{0,1}, u_{0,3}, u_{1,1}, u_{1,3})^T$。\n\n首先，我们为该子空间构造质量矩阵 $M_{sub}$。问题陈述使用了集中质量矩阵，其中 $M_e = \\frac{h}{2}\\operatorname{diag}(w_{1},w_{2},w_{3})$。当 $h=1$ 且权重为 $\\{w_1, w_2, w_3\\} = \\{\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}\\}$ 时，单元质量矩阵为 $M_e = \\frac{1}{2}\\operatorname{diag}(\\frac{1}{3}, \\frac{4}{3}, \\frac{1}{3}) = \\operatorname{diag}(\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$。\n活动的自由度（$u_{0,1}, u_{0,3}, u_{1,1}, u_{1,3}$）对应于单元的端点（$\\xi = \\pm 1$），其权重为 $w_1 = w_3 = \\frac{1}{3}$。每个自由度对应的质量矩阵项为 $\\frac{h}{2}w_1 = \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{6}$。\n因此，子空间质量矩阵 $M_{sub}$ 是一个 $4 \\times 4$ 的对角矩阵：\n$$\nM_{sub} = \\frac{1}{6} \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} = \\frac{1}{6} I_4\n$$\n其逆矩阵为 $M_{sub}^{-1} = 6 I_4$。\n\n接下来，我们构造子空间中的刚度矩阵 $K_{sub}$。问题陈述指出，它由界面贡献的总和形成。单个界面的贡献由 $K^{(\\mathrm{int})} = \\nu \\frac{\\sigma}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 给出。\n\n对于 Bassi-Rebay 2 (BR2) 格式，我们有 $\\nu=1$, $h=1$, 和 $\\sigma_{\\mathrm{BR2}}=6$。\n$$\nK^{(\\mathrm{int})}_{\\mathrm{BR2}} = 1 \\cdot \\frac{6}{1} \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix} = 6 \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix}\n$$\n我们从两个界面组装全局子空间刚度矩阵 $K_{\\mathrm{BR2}, sub}$：\n1. 在 $x=1$ 处的界面：连接自由度 $u_{0,3}$ 和 $u_{1,1}$。\n2. 在 $x=0 \\equiv 2$ 处的界面（周期性）：连接 $u_{1,3}$（在 $x=2$ 处）和 $u_{0,1}$（在 $x=0$ 处）。\n\n将这些贡献组装到对应于 $U_{sub} = (u_{0,1}, u_{0,3}, u_{1,1}, u_{1,3})^T$ 的 $4 \\times 4$ 矩阵中：\n$$\nK_{\\mathrm{BR2}, sub} = \\begin{pmatrix}\n6  0  0  -6 \\\\\n0  6  -6  0 \\\\\n0  -6  6  0 \\\\\n-6  0  0  6\n\\end{pmatrix} = 6 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix}\n$$\nBR2 格式的算子是 $A_{\\mathrm{BR2}} = M_{sub}^{-1} K_{\\mathrm{BR2}, sub}$:\n$$\nA_{\\mathrm{BR2}} = (6 I_4) \\left( 6 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix} \\right) = 36 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix}\n$$\n为了找到 $A_{\\mathrm{BR2}}$ 的特征值，我们先找到其矩阵部分的特征值。通过置换行和列，该矩阵相似于一个块对角矩阵：\n$$\n\\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  1  0  0 \\\\\n0  0  1  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n每个块都是 $J = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。$J$ 的特征值由 $\\det(J - \\lambda I) = (1-\\lambda)^2 - 1 = \\lambda^2 - 2\\lambda = \\lambda(\\lambda-2) = 0$ 给出。$J$ 的特征值是 $0$ 和 $2$。\n因此，$A_{\\mathrm{BR2}}$ 矩阵部分的特征值是 $\\{0, 2, 0, 2\\}$。\n$A_{\\mathrm{BR2}}$ 的特征值是 $36 \\times \\{0, 2, 0, 2\\} = \\{0, 72, 0, 72\\}$。\n最大特征值是 $\\lambda_{\\max}(A_{\\mathrm{BR2}}) = 72$。\n\n我们对局部间断伽辽金 (LDG) 格式重复此过程。问题陈述其具有相同的结构形式，但 $\\sigma_{\\mathrm{LDG}} = 2$。\nLDG 的界面刚度块是：\n$$\nK^{(\\mathrm{int})}_{\\mathrm{LDG}} = \\nu \\frac{\\sigma_{\\mathrm{LDG}}}{h} \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix} = 1 \\cdot \\frac{2}{1} \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix} = 2 \\begin{pmatrix} 1  -1\\\\ -1  1 \\end{pmatrix}\n$$\n子空间刚度矩阵 $K_{\\mathrm{LDG}, sub}$ 是：\n$$\nK_{\\mathrm{LDG}, sub} = 2 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix}\n$$\nLDG 格式的算子是 $A_{\\mathrm{LDG}} = M_{sub}^{-1} K_{\\mathrm{LDG}, sub}$:\n$$\nA_{\\mathrm{LDG}} = (6 I_4) \\left( 2 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix} \\right) = 12 \\begin{pmatrix}\n1  0  0  -1 \\\\\n0  1  -1  0 \\\\\n0  -1  1  0 \\\\\n-1  0  0  1\n\\end{pmatrix}\n$$\n$A_{\\mathrm{LDG}}$ 的特征值是 $12 \\times \\{0, 2, 0, 2\\} = \\{0, 24, 0, 24\\}$。\n最大特征值是 $\\lambda_{\\max}(A_{\\mathrm{LDG}}) = 24$。\n\n最后，我们计算比率 $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\lambda_{\\max}(A_{\\mathrm{BR2}})}{\\lambda_{\\max}(A_{\\mathrm{LDG}})} = \\frac{72}{24} = 3\n$$\n这个比率量化了在给定参数下两种格式在高频阻尼方面的差异，对于此网格上的最高频率模式，BR2 提供的阻尼是 LDG 的三倍。", "answer": "$$\n\\boxed{3}\n$$", "id": "3417382"}, {"introduction": "现在，让我们从纯理论转向编程实践。本练习涉及编写代码求解一维对流扩散方程，该方程融合了双曲和抛物问题的特性。你的任务是实现一个参数化的 LDG 格式和一个作为基准的类 BR 格式，并探索数值通量中的设计选择（特别是迎风偏置参数 $\\theta$）如何影响格式的稳定性和精度，尤其是在扩散主导的情况下。", "problem": "考虑一个周期性域上的一维线性对流扩散方程，通过引入一个辅助梯度变量，将其写成一阶形式：求一个标量场 $u(x,t)$ 和一个辅助场 $q(x,t)$，使得\n$$\nu_t + b\\,u_x = \\nu\\,u_{xx}, \\quad x \\in [0,L], \\ t \\ge 0,\n$$\n等价于，\n$$\nu_t + b\\,u_x = \\nu\\,q_x, \\qquad q - u_x = 0,\n$$\n边界条件为周期性边界条件 $u(0,t) = u(L,t)$ 和 $q(0,t) = q(L,t)$。这里 $b$ 是恒定的对流速度，$\\nu$ 是恒定的扩散系数。目标是在局部间断伽辽金 (Local Discontinuous Galerkin, LDG) 通量族内，研究用于定义辅助梯度变量的数值通量中引入一个轻微的迎风偏置，是否能在扩散主导的情况下提高稳定性，而不过度阻尼平滑模态。作为背景，Bassi–Rebay (BR) 类格式，例如 Bassi–Rebay 2 (BR2)，是广泛用于处理扩散项的 LDG 替代方案；我们将引入一个能反映此类格式特性的、简单的类内部罚格式基线进行比较。\n\n您将在一个包含 $N$ 个等长 $h=L/N$ 单元的均匀网格上，使用分片常数近似（零次多项式）进行计算，单元中心为 $x_i = (i+\\tfrac{1}{2})h$，其中 $i=0,\\dots,N-1$。用 $u_i(t)$ 表示单元 $i$ 上 $u$ 的近似值，用 $q_i(t)$ 表示单元 $i$ 上 $q$ 的近似值，两者在每个单元上都视为常数。单元 $i$ 和单元 $i+1$ 之间的界面索引为 $i+\\tfrac{1}{2}$，并采用周期性环绕处理。\n\n上述系统在守恒形式下的半离散 LDG 格式，针对分片常数特化后，可写为：\n- 对于每个单元 $i$ 的辅助方程：\n$$\nh\\, q_i - \\big(\\widehat{u}^{\\text{diff}}_{i+\\frac{1}{2}} - \\widehat{u}^{\\text{diff}}_{i-\\frac{1}{2}}\\big) = 0,\n$$\n其中 $\\widehat{u}^{\\text{diff}}_{i+\\frac{1}{2}}$ 是界面上 $u$ 的单值数值通量，仅用于 $q$ 方程。\n- 对于每个单元 $i$ 的主方程：\n$$\nh\\, \\frac{d u_i}{d t} + \\Big( b\\,\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} - \\nu\\,\\widehat{q}_{i+\\frac{1}{2}} \\Big) - \\Big( b\\,\\widehat{u}^{\\text{conv}}_{i-\\frac{1}{2}} - \\nu\\,\\widehat{q}_{i-\\frac{1}{2}} \\Big) = 0,\n$$\n其中 $\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}}$ 是对流项的标准迎风数值通量，$\\widehat{q}_{i+\\frac{1}{2}}$ 是用于 $u$ 方程的 $q$ 的单值数值通量。\n\n通过迎风格式定义对流数值通量\n$$\n\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} =\n\\begin{cases}\nu_i,  & b \\ge 0,\\\\\nu_{i+1},  & b  0,\n\\end{cases}\n$$\n并将扩散 $q$ 通量定义为中心平均值\n$$\n\\widehat{q}_{i+\\frac{1}{2}} = \\tfrac{1}{2}(q_i + q_{i+1}).\n$$\n在用于 $q$ 方程的 $u$ 通量中引入一个迎风偏置参数 $\\theta \\in [0,1]$，设定为\n$$\n\\widehat{u}^{\\text{diff}}_{i+\\frac{1}{2}} = (1-\\theta)\\,\\tfrac{1}{2}\\,(u_i + u_{i+1}) + \\theta\\,u_i,\n$$\n这对应于中心平均值和左迹（一个固定的方向）的凸组合，从而在 $\\theta$ 为小的正数时，以轻微的迎风方式对离散梯度产生偏置。从半离散系统中消去 $q_i$ 会得到一个形式如下的封闭线性常微分方程组\n$$\n\\frac{d\\mathbf{u}}{dt} = A\\,\\mathbf{u},\n$$\n其中 $\\mathbf{u} \\in \\mathbb{R}^{N}$ 是单元平均值向量，$A \\in \\mathbb{R}^{N \\times N}$ 是依赖于 $b$、$\\nu$、$L$、$N$ 和 $\\theta$ 的半离散算子。\n\n为了与类 Bassi–Rebay 基线进行比较，考虑一个类内部罚格式（在一维空间和分片常数情况下反映了 Bassi–Rebay 类的特性），它直接在未知量 $u$ 上定义为\n$$\n\\frac{d u_i}{dt} = -\\frac{b}{h}\\,\\Big(\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} - \\widehat{u}^{\\text{conv}}_{i-\\frac{1}{2}}\\Big) + \\nu\\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},\n$$\n同样采用周期性环绕处理，并使用与上述相同的迎风对流通量 $\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}}$。这将得到另一个形式为\n$$\n\\frac{d\\mathbf{u}}{dt} = A\\,\\mathbf{u},\n$$\n的线性系统，但其矩阵 $A$ 不同。\n\n您的任务：\n1. 从上述积分形式出发，通过在半离散层面上消去辅助变量 $q$，推导并实现一个函数，该函数根据参数 $N$、$L$、$b$、$\\nu$ 和 $\\theta$ 组装 LDG 格式的矩阵 $A$。使用周期性边界条件。\n2. 实现上述指定的、对应于 Bassi–Rebay 类的类内部罚基线算子 $A$。\n3. 对于任何给定的算子 $A$，定义以下诊断指标：\n   - 谱横坐标裕度 $m = -\\max\\{\\Re(\\lambda): \\lambda \\in \\sigma(A)\\}$，其中 $\\sigma(A)$ 表示谱。当且仅当 $\\max\\{\\Re(\\lambda)\\} \\le 10^{-10}$ 时，将格式报告为稳定，并将 $m$ 报告为非负浮点数。\n   - 平滑模态阻尼比 $r = \\frac{-\\Re(\\lambda_{\\text{eff}})}{\\nu\\,k^2}$，其中 $k=1$ 是长度为 $L = 2\\pi$ 的周期区间上的基波波数，而 $\\lambda_{\\text{eff}}$ 是 $A$ 相对于离散正弦模态 $v_i = \\sin(k x_i)$ 使用欧几里得内积的瑞利商，即 $\\lambda_{\\text{eff}} = \\frac{v^\\top (A v)}{v^\\top v}$。该比率量化了最平滑的非平凡模态相对于连续介质速率 $-\\nu k^2$ 的过度阻尼程度。\n4. 您的程序必须构造 $A$，计算特征值，并为下面指定的套件中的每个测试用例返回布尔稳定性结论、裕度 $m$ 和比率 $r$。\n\n使用以下测试套件（所有参数均为无量纲，其中 $L$ 的单位与 $x$ 相同，$b$ 的单位为单位时间的 $x$，$ \\nu$ 的单位为单位时间的 $x^2$）：\n- 案例 1：LDG 格式，参数为 $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.0$。\n- 案例 2：LDG 格式，参数为 $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.1$。\n- 案例 3：LDG 格式，参数为 $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.5$。\n- 案例 4：LDG 格式，参数为 $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=1.0$。\n- 案例 5：LDG 格式，参数为 $N=10, L=2\\pi, b=-0.2, \\nu=1.0, \\theta=0.1$。\n- 案例 6：类 BR 基线，参数为 $N=40, L=2\\pi, b=0.2, \\nu=1.0$（忽略 $\\theta$）。\n- 案例 7：LDG 格式，参数为 $N=4, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.1$。\n\n您的程序应按案例 1 到 7 的顺序，生成单行输出，其中包含一个列表的列表\n$$\n\\big[\\,[\\text{stable}_1, m_1, r_1], \\ [\\text{stable}_2, m_2, r_2], \\ \\dots, \\ [\\text{stable}_7, m_7, r_7]\\,\\big],\n$$\n其中每个 $\\text{stable}_j$ 是一个布尔值，每个 $m_j$ 和 $r_j$ 是浮点数。整个列表必须打印在单行上，格式化为用方括号括起来的逗号分隔列表，内部列表各自按所述顺序包含三个条目。", "solution": "The user wants me to implement and analyze two numerical schemes for the one-dimensional linear convection-diffusion equation:\n1. A Local Discontinuous Galerkin (LDG) scheme with a tunable upwind parameter $\\theta$.\n2. A baseline interior-penalty-like scheme, referred to as Bassi-Rebay (BR) like.\n\nThe equation is $u_t + b u_x = \\nu u_{xx}$ on a periodic domain $[0, L]$.\nThis is rewritten as a first-order system:\n$u_t + b u_x = \\nu q_x$\n$q - u_x = 0$\n\nThe domain is discretized into $N$ cells of size $h = L/N$. The unknowns are piecewise constant cell averages $u_i(t)$ and $q_i(t)$ on cell $i$. The cell centers are $x_i = (i + 1/2)h$ for $i=0, \\dots, N-1$.\n\nLet's break down the problem into steps.\n\n**Part 1: Problem Validation**\n\nFirst, I need to validate the problem statement.\n\n*   **Extract Givens:**\n    *   Equation: $u_t + b\\,u_x = \\nu\\,u_{xx}$ on $[0, L]$ with periodic boundary conditions.\n    *   First-order system: $u_t + b\\,u_x = \\nu\\,q_x$, and $q - u_x = 0$.\n    *   Boundary conditions: $u(0,t) = u(L,t)$ and $q(0,t) = q(L,t)$.\n    *   Constants: convection speed $b$, diffusivity $\\nu$.\n    *   Discretization: Piecewise-constant approximation (degree zero). Uniform mesh of $N$ cells of size $h = L/N$. Cell-average unknowns $u_i(t)$, $q_i(t)$.\n    *   LDG semi-discrete scheme for cell $i$:\n        *   Auxiliary equation: $h\\, q_i - (\\widehat{u}^{\\text{diff}}_{i+1/2} - \\widehat{u}^{\\text{diff}}_{i-1/2}) = 0$.\n        *   Primary equation: $h\\, \\frac{d u_i}{d t} + ( b\\,\\widehat{u}^{\\text{conv}}_{i+1/2} - \\nu\\,\\widehat{q}_{i+1/2} ) - ( b\\,\\widehat{u}^{\\text{conv}}_{i-1/2} - \\nu\\,\\widehat{q}_{i-1/2} ) = 0$.\n    *   Numerical fluxes for LDG:\n        *   Convective flux: $\\widehat{u}^{\\text{conv}}_{i+1/2} = u_i$ if $b \\ge 0$, or $u_{i+1}$ if $b  0$. This is the standard upwind flux.\n        *   Diffusive q-flux: $\\widehat{q}_{i+1/2} = \\frac{1}{2}(q_i + q_{i+1})$. This is a central flux.\n        *   Diffusive u-flux (for q-equation): $\\widehat{u}^{\\text{diff}}_{i+1/2} = (1-\\theta)\\,\\frac{1}{2}\\,(u_i + u_{i+1}) + \\theta\\,u_i$. This is a convex combination of central and upwind (left-biased).\n    *   Final form of LDG system: $\\frac{d\\mathbf{u}}{dt} = A\\,\\mathbf{u}$.\n    *   BR-like baseline scheme for cell $i$:\n        *   $\\frac{d u_i}{dt} = -\\frac{b}{h}\\,(\\widehat{u}^{\\text{conv}}_{i+1/2} - \\widehat{u}^{\\text{conv}}_{i-1/2}) + \\nu\\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}$.\n        *   Convective flux is the same as for LDG.\n        *   The diffusive part is the standard central difference approximation for the second derivative.\n    *   Final form of BR-like system: $\\frac{d\\mathbf{u}}{dt} = A\\,\\mathbf{u}$.\n    *   Diagnostics:\n        *   Spectral abscissa margin: $m = -\\max\\{\\Re(\\lambda): \\lambda \\in \\sigma(A)\\}$.\n        *   Stability condition: $\\max\\{\\Re(\\lambda)\\} \\le 10^{-10}$.\n        *   Smooth-mode damping ratio: $r = \\frac{-\\Re(\\lambda_{\\text{eff}})}{\\nu\\,k^2}$, with $k=1$, $L=2\\pi$.\n        *   Effective eigenvalue: $\\lambda_{\\text{eff}} = \\frac{v^\\top (A v)}{v^\\top v}$ for $v_i = \\sin(k x_i) = \\sin(x_i)$.\n    *   Test Cases:\n        1.  LDG: $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.0$\n        2.  LDG: $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.1$\n        3.  LDG: $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.5$\n        4.  LDG: $N=40, L=2\\pi, b=0.2, \\nu=1.0, \\theta=1.0$\n        5.  LDG: $N=10, L=2\\pi, b=-0.2, \\nu=1.0, \\theta=0.1$\n        6.  BR-like: $N=40, L=2\\pi, b=0.2, \\nu=1.0$\n        7.  LDG: $N=4, L=2\\pi, b=0.2, \\nu=1.0, \\theta=0.1$\n    *   Output format: `[[stable_1, m_1, r_1], [stable_2, m_2, r_2], ..., [stable_7, m_7, r_7]]`.\n\n*   **Validate Using Extracted Givens:**\n    *   **Scientifically Grounded:** The problem deals with the numerical solution of the convection-diffusion equation using well-established finite volume / discontinuous Galerkin methods (LDG, BR). The concepts of numerical fluxes, stability analysis via eigenvalues (von Neumann analysis is related), and damping ratios are standard in numerical analysis for PDEs. The problem is scientifically sound.\n    *   **Well-Posed:** The problem asks to construct specific matrices and compute their properties. Given the parameters, the matrices are uniquely defined. The computations (eigenvalues, Rayleigh quotient) are well-defined mathematical operations. The problem is well-posed.\n    *   **Objective:** The language is precise and technical. Definitions are given mathematically. No subjective or opinion-based statements. The problem is objective.\n    *   **Flaw Checklist:**\n        1.  **Scientific/Factual Unsoundness:** No. The physics and mathematics are correct.\n        2.  **Non-Formalizable/Irrelevant:** No. The problem is a concrete task in numerical analysis, directly related to the specified topic.\n        3.  **Incomplete/Contradictory:** No. All necessary parameters and definitions are provided for each case. The setup is self-contained. The use of periodic boundary conditions is consistent.\n        4.  **Unrealistic/Infeasible:** No. The parameters are dimensionless and chosen for a numerical experiment, not to model a specific physical system. They are perfectly reasonable for this purpose.\n        5.  **Ill-Posed/Poorly Structured:** No. As discussed, the problem is well-posed.\n        6.  **Pseudo-Profound/Trivial:** No. This problem requires careful derivation of the matrix entries, which is a non-trivial task involving algebraic manipulation of the discrete equations. The comparison of different schemes is a standard and meaningful exercise in the field.\n        7.  **Outside Scientific Verifiability:** No. The results can be verified by independent implementation and calculation.\n\n*   **Verdict and Action:**\n    *   The problem is **valid**. I will proceed to the solution.\n\n**Part 2: Derivation of the Semi-Discrete Operators**\n\nThe goal is to derive the matrix $A$ for the system $\\frac{d\\mathbf{u}}{dt} = A\\mathbf{u}$ for both the LDG and BR-like schemes. All indices are considered modulo $N$ due to periodic boundary conditions.\n\n**1. LDG Scheme Operator**\n\nWe must eliminate the auxiliary variable $q$ from the system.\nFirst, we express $q_i$ in terms of $u_j$ using the auxiliary equation:\n$$h\\, q_i = \\widehat{u}^{\\text{diff}}_{i+\\frac{1}{2}} - \\widehat{u}^{\\text{diff}}_{i-\\frac{1}{2}}$$\nThe flux $\\widehat{u}^{\\text{diff}}$ is defined as:\n$$\\widehat{u}^{\\text{diff}}_{i+\\frac{1}{2}} = (1-\\theta)\\,\\frac{1}{2}\\,(u_i + u_{i+1}) + \\theta\\,u_i = \\frac{1+\\theta}{2}u_i + \\frac{1-\\theta}{2}u_{i+1}$$\nSubstituting this into the equation for $q_i$:\n$$h q_i = \\left(\\frac{1+\\theta}{2}u_i + \\frac{1-\\theta}{2}u_{i+1}\\right) - \\left(\\frac{1+\\theta}{2}u_{i-1} + \\frac{1-\\theta}{2}u_i\\right) = -\\frac{1+\\theta}{2}u_{i-1} + \\theta u_i + \\frac{1-\\theta}{2}u_{i+1}$$\nThus, $q_i$ is a discrete approximation of $u_x$:\n$$q_i = \\frac{1}{h} \\left(-\\frac{1+\\theta}{2}u_{i-1} + \\theta u_i + \\frac{1-\\theta}{2}u_{i+1}\\right)$$\nNext, we substitute this into the primary equation:\n$$h \\frac{d u_i}{d t} = -\\left( b\\,\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} - \\nu\\,\\widehat{q}_{i+\\frac{1}{2}} \\right) + \\left( b\\,\\widehat{u}^{\\text{conv}}_{i-\\frac{1}{2}} - \\nu\\,\\widehat{q}_{i-\\frac{1}{2}} \\right)$$\nRearranging gives:\n$$\\frac{d u_i}{dt} = -\\frac{b}{h}\\left(\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} - \\widehat{u}^{\\text{conv}}_{i-\\frac{1}{2}}\\right) + \\frac{\\nu}{h}\\left(\\widehat{q}_{i+\\frac{1}{2}} - \\widehat{q}_{i-\\frac{1}{2}}\\right)$$\nLet's analyze the convective and diffusive parts separately.\n\nThe convective part depends on the sign of $b$. For $b \\ge 0$, $\\widehat{u}^{\\text{conv}}_{i+1/2} = u_i$, giving a contribution of $-\\frac{b}{h}(u_i - u_{i-1})$. For $b  0$, $\\widehat{u}^{\\text{conv}}_{i+1/2} = u_{i+1}$, giving a contribution of $-\\frac{b}{h}(u_{i+1} - u_i)$.\n\nThe diffusive part uses the flux $\\widehat{q}_{i+1/2} = \\frac{1}{2}(q_i + q_{i+1})$. The contribution is:\n$$\\frac{\\nu}{h}\\left(\\frac{1}{2}(q_i + q_{i+1}) - \\frac{1}{2}(q_{i-1} + q_i)\\right) = \\frac{\\nu}{2h}(q_{i+1} - q_{i-1})$$\nWe substitute the expression for $q_j$ in terms of $u_k$:\n$$q_{i+1} - q_{i-1} = \\frac{1}{h}\\left(-\\frac{1+\\theta}{2}u_{i} + \\theta u_{i+1} + \\frac{1-\\theta}{2}u_{i+2}\\right) - \\frac{1}{h}\\left(-\\frac{1+\\theta}{2}u_{i-2} + \\theta u_{i-1} + \\frac{1-\\theta}{2}u_{i}\\right)$$\n$$q_{i+1} - q_{i-1} = \\frac{1}{h}\\left(\\frac{1+\\theta}{2}u_{i-2} - \\theta u_{i-1} - u_i + \\theta u_{i+1} + \\frac{1-\\theta}{2}u_{i+2}\\right)$$\nSo the diffusive contribution to $\\frac{du_i}{dt}$ is:\n$$\\frac{\\nu}{2h^2}\\left(\\frac{1+\\theta}{2}u_{i-2} - \\theta u_{i-1} - u_i + \\theta u_{i+1} + \\frac{1-\\theta}{2}u_{i+2}\\right)$$\nCombining the convective and diffusive parts, we obtain the stencil for the operator $A$. The stencil coefficient $s_k$ is the coefficient of $u_{i+k}$ in the expression for $(A\\mathbf{u})_i = \\frac{du_i}{dt}$.\nFor $b \\ge 0$:\n$s_{-2} = \\frac{\\nu(1+\\theta)}{4h^2}$, $s_{-1} = \\frac{b}{h} - \\frac{\\nu\\theta}{2h^2}$, $s_0 = -\\frac{b}{h} - \\frac{\\nu}{2h^2}$, $s_1 = \\frac{\\nu\\theta}{2h^2}$, $s_2 = \\frac{\\nu(1-\\theta)}{4h^2}$.\nFor $b  0$:\n$s_{-2} = \\frac{\\nu(1+\\theta)}{4h^2}$, $s_{-1} = -\\frac{\\nu\\theta}{2h^2}$, $s_0 = \\frac{b}{h} - \\frac{\\nu}{2h^2}$, $s_1 = -\\frac{b}{h} + \\frac{\\nu\\theta}{2h^2}$, $s_2 = \\frac{\\nu(1-\\theta)}{4h^2}$.\nThis defines a $5$-point stencil for the circulant matrix $A$.\n\n**2. BR-like Baseline Operator**\n\nThe scheme is given directly:\n$$\\frac{d u_i}{dt} = -\\frac{b}{h}\\left(\\widehat{u}^{\\text{conv}}_{i+\\frac{1}{2}} - \\widehat{u}^{\\text{conv}}_{i-\\frac{1}{2}}\\right) + \\nu\\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}$$\nThe convective term is identical to the LDG scheme. The diffusive term is the standard centered finite difference approximation of $\\nu u_{xx}$.\nCombining terms, we get a $3$-point stencil.\nFor $b \\ge 0$:\n$$s_{-1} = \\frac{b}{h} + \\frac{\\nu}{h^2}, \\quad s_0 = -\\frac{b}{h} - \\frac{2\\nu}{h^2}, \\quad s_1 = \\frac{\\nu}{h^2}$$\nFor $b  0$:\n$$s_{-1} = \\frac{\\nu}{h^2}, \\quad s_0 = \\frac{b}{h} - \\frac{2\\nu}{h^2}, \\quad s_1 = -\\frac{b}{h} + \\frac{\\nu}{h^2}$$\nThis defines a $3$-point stencil for the circulant matrix $A$.\n\n**3. Diagnostics Computation**\n\nFor each constructed matrix $A$, we compute the specified diagnostics:\n- **Stability and Spectral Abscissa Margin ($m$)**: We compute the eigenvalues $\\lambda_j$ of $A$. The spectral abscissa is $\\alpha = \\max_j\\{\\Re(\\lambda_j)\\}$. The scheme is stable if $\\alpha \\le 10^{-10}$. The margin is $m = -\\alpha$.\n- **Smooth-Mode Damping Ratio ($r$)**: This is defined as $r = \\frac{-\\Re(\\lambda_{\\text{eff}})}{\\nu\\,k^2}$. For the given parameters, $L=2\\pi$ and $k=1$. The test vector is $\\mathbf{v}$ with components $v_i = \\sin(k x_i) = \\sin(x_i)$, where $x_i = (i+1/2)h$. The effective eigenvalue $\\lambda_{\\text{eff}}$ is the Rayleigh quotient $\\lambda_{\\text{eff}} = \\frac{\\mathbf{v}^\\top (A \\mathbf{v})}{\\mathbf{v}^\\top \\mathbf{v}}$. The ratio becomes $r = \\frac{-\\Re(\\lambda_{\\text{eff}})}{\\nu}$.\n\nThe implementation will construct the matrix $A$ for each test case using the derived stencils, then compute these diagnostics. The periodic boundary conditions imply that $A$ is a circulant matrix.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import circulant\n\ndef assemble_A_LDG(N, L, b, nu, theta):\n    \"\"\"Assembles the LDG operator matrix A.\"\"\"\n    h = L / N\n    h2 = h * h\n\n    if b >= 0:\n        s_m2 = nu * (1 + theta) / (4 * h2)\n        s_m1 = b / h - nu * theta / (2 * h2)\n        s_0 = -b / h - nu / (2 * h2)\n        s_p1 = nu * theta / (2 * h2)\n        s_p2 = nu * (1 - theta) / (4 * h2)\n    else:  # b  0\n        s_m2 = nu * (1 + theta) / (4 * h2)\n        s_m1 = -nu * theta / (2 * h2)\n        s_0 = b / h - nu / (2 * h2)\n        s_p1 = -b / h + nu * theta / (2 * h2)\n        s_p2 = nu * (1 - theta) / (4 * h2)\n\n    A = np.zeros((N, N), dtype=float)\n    # Applying the 5-point stencil with periodic wrap-around\n    for i in range(N):\n        A[i, (i - 2 + N) % N] += s_m2\n        A[i, (i - 1 + N) % N] += s_m1\n        A[i, i] += s_0\n        A[i, (i + 1) % N] += s_p1\n        A[i, (i + 2) % N] += s_p2\n        \n    return A\n\ndef assemble_A_BR(N, L, b, nu):\n    \"\"\"Assembles the Bassi-Rebay-like operator matrix A.\"\"\"\n    h = L / N\n    h2 = h * h\n\n    if b >= 0:\n        s_m1 = b / h + nu / h2\n        s_0 = -b / h - 2 * nu / h2\n        s_p1 = nu / h2\n    else:  # b  0\n        s_m1 = nu / h2\n        s_0 = b / h - 2 * nu / h2\n        s_p1 = -b / h + nu / h2\n        \n    A = np.zeros((N, N), dtype=float)\n    # Applying the 3-point stencil with periodic wrap-around\n    for i in range(N):\n        A[i, (i - 1 + N) % N] += s_m1\n        A[i, i] += s_0\n        A[i, (i + 1) % N] += s_p1\n        \n    return A\n\ndef analyze_scheme(A, N, L, b, nu):\n    \"\"\"Computes stability, margin, and damping ratio for a given operator A.\"\"\"\n    # 1. Stability and margin m\n    eigvals = np.linalg.eigvals(A)\n    max_re = np.max(np.real(eigvals))\n    stable = bool(max_re = 1e-10)\n    m = -max_re\n\n    # 2. Smooth-mode damping ratio r\n    h = L / N\n    k = 1.0\n    x = (np.arange(N) + 0.5) * h\n    v = np.sin(k * x)\n    \n    lambda_eff = (v.T @ A @ v) / (v.T @ v)\n    \n    # Continuum damping rate for denominator\n    continuum_damping = nu * k**2\n    r = -np.real(lambda_eff) / continuum_damping\n    \n    return [stable, m, r]\n\ndef solve():\n    \"\"\"Main function to run test cases and print results.\"\"\"\n    test_cases = [\n        # Case 1: LDG, N=40, L=2pi, b=0.2, nu=1.0, theta=0.0\n        ('LDG', 40, 2 * np.pi, 0.2, 1.0, 0.0),\n        # Case 2: LDG, N=40, L=2pi, b=0.2, nu=1.0, theta=0.1\n        ('LDG', 40, 2 * np.pi, 0.2, 1.0, 0.1),\n        # Case 3: LDG, N=40, L=2pi, b=0.2, nu=1.0, theta=0.5\n        ('LDG', 40, 2 * np.pi, 0.2, 1.0, 0.5),\n        # Case 4: LDG, N=40, L=2pi, b=0.2, nu=1.0, theta=1.0\n        ('LDG', 40, 2 * np.pi, 0.2, 1.0, 1.0),\n        # Case 5: LDG, N=10, L=2pi, b=-0.2, nu=1.0, theta=0.1\n        ('LDG', 10, 2 * np.pi, -0.2, 1.0, 0.1),\n        # Case 6: BR-like, N=40, L=2pi, b=0.2, nu=1.0\n        ('BR', 40, 2 * np.pi, 0.2, 1.0, None),\n        # Case 7: LDG, N=4, L=2pi, b=0.2, nu=1.0, theta=0.1\n        ('LDG', 4, 2 * np.pi, 0.2, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        scheme_type, N, L, b, nu, theta = case\n        \n        if scheme_type == 'LDG':\n            A = assemble_A_LDG(N, L, b, nu, theta)\n        elif scheme_type == 'BR':\n            A = assemble_A_BR(N, L, b, nu)\n        else:\n            raise ValueError(f\"Unknown scheme type: {scheme_type}\")\n\n        analysis_result = analyze_scheme(A, N, L, b, nu)\n        results.append(analysis_result)\n    \n    # Format the final output string as a list of lists.\n    # The str() representation of a list includes the required spaces.\n    # Joining with ',' gives a compact representation.\n    output_str = f\"[[{', '.join(map(str, results[0]))}], [{', '.join(map(str, results[1]))}], [{', '.join(map(str, results[2]))}], [{', '.join(map(str, results[3]))}], [{', '.join(map(str, results[4]))}], [{', '.join(map(str, results[5]))}], [{', '.join(map(str, results[6]))}]]\"\n    print(output_str.replace(\"'\", \"\"))\n\nsolve()\n```", "id": "3417437"}, {"introduction": "我们将动手实践扩展到二维空间，这是迈向真实世界应用的关键一步。本练习的核心是计算离散格林函数，它揭示了数值格式对点源的基本响应。通过分析带有方向偏置的 LDG 格式和 BR2 格式的格林函数的形状与衰减特性，我们可以直观地观察并量化数值各向异性——这是一个影响解质量的关键属性，尤其是在结构化网格或物理扩散本身具有各向异性时。", "problem": "考虑单位正方形域上的标量扩散偏微分方程，其具有均匀狄利克雷边界条件，由下式给出\n$$\n-\\nabla \\cdot \\left( \\mathbf{K} \\, \\nabla u(x,y) \\right) = f(x,y), \\quad (x,y) \\in (0,1) \\times (0,1), \\quad u|_{\\partial \\Omega} = 0,\n$$\n其中 $\\mathbf{K} = \\mathrm{diag}(k_x, k_y)$ 是一个常数对称正定扩散张量，其元素 $k_x \\gt 0$ 和 $k_y \\gt 0$。设该域被划分为一个均匀的笛卡尔网格，在$x$方向有$N_x$个单元，在$y$方向有$N_y$个单元，每个单元都是尺寸为 $h_x = 1/N_x$ 和 $h_y = 1/N_y$ 的矩形。考虑每个单元上使用分片常数基函数。将离散格林函数定义为离散线性系统的解 $\\mathbf{g}$\n$$\n\\mathbf{A} \\, \\mathbf{g} = \\mathbf{e}_{i_0,j_0},\n$$\n其中 $\\mathbf{A}$ 是由间断伽辽金离散化产生的全局刚度矩阵，$\\mathbf{e}_{i_0,j_0}$ 是克罗内克δ向量，除了对应于单元 $(i_0,j_0)$ 的索引处为1外，其余位置均为0。离散格林函数表示对位于单元 $(i_0,j_0)$ 的点源的离散响应。\n\n您必须计算并比较两种间断伽辽金格式的离散格林函数：\n\n- 局部间断伽辽金(LDG)方法，通过一个基于面的罚算子实现，其方向通量偏置由参数 $\\alpha \\in [0,1)$ 和全局方向向量 $\\boldsymbol{\\beta} \\in \\mathbb{R}^2$ 控制。对于每个内部面，其单位法向量 $\\mathbf{n}$ 从左单元 $\\mathcal{L}$ 指向右单元 $\\mathcal{R}$，定义面稳定化系数\n$$\ns(\\mathbf{n}) = \\tau \\, \\frac{\\mathbf{n}^\\top \\mathbf{K} \\, \\mathbf{n}}{h_n},\n$$\n其中 $\\tau \\gt 0$ 是一个稳定化参数，$h_n$ 是垂直于面的网格尺寸，对于垂直面（法向量 $\\pm(1,0)$）等于 $h_x$，对于水平面（法向量 $\\pm(0,1)$）等于 $h_y$。LDG方向分裂根据 $\\mathrm{sign}(\\boldsymbol{\\beta} \\cdot \\mathbf{n})$ 将 $s(\\mathbf{n})$ 的一部分分配给每一侧，具体为\n$$\ns_{\\mathcal{L}}(\\mathbf{n}) = \\frac{1+\\alpha}{2} \\, s(\\mathbf{n}) \\quad \\text{和} \\quad s_{\\mathcal{R}}(\\mathbf{n}) = \\frac{1-\\alpha}{2} \\, s(\\mathbf{n}) \\quad \\text{如果 } \\boldsymbol{\\beta} \\cdot \\mathbf{n} \\ge 0,\n$$\n如果 $\\boldsymbol{\\beta} \\cdot \\mathbf{n}  0$，则交换。一个内部面的局部组装贡献为\n$$\n\\begin{aligned}\n\\mathbf{A}_{\\mathcal{L},\\mathcal{L}} \\mathrel{+}= s_{\\mathcal{L}}(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{L},\\mathcal{R}} \\mathrel{-}= s_{\\mathcal{L}}(\\mathbf{n}),\\\\\n\\mathbf{A}_{\\mathcal{R},\\mathcal{R}} \\mathrel{+}= s_{\\mathcal{R}}(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{L}} \\mathrel{-}= s_{\\mathcal{R}}(\\mathbf{n}),\n\\end{aligned}\n$$\n而对于边界面，组装简化为\n$$\n\\mathbf{A}_{\\mathcal{E},\\mathcal{E}} \\mathrel{+}= s(\\mathbf{n}),\n$$\n以施加均匀狄利克雷边界条件。当 $\\alpha \\ne 0$ 时，此LDG变体产生一个通常非对称的算子，并通过 $\\boldsymbol{\\beta}$ 引入方向偏置。\n\n- Bassi-Rebay 2 (BR2)方法，实现为分片常数基函数的类对称内部罚面算子。对于每个内部面，使用与上述相同的 $s(\\mathbf{n})$，对称组装贡献为\n$$\n\\mathbf{A}_{\\mathcal{L},\\mathcal{L}} \\mathrel{+}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{R}} \\mathrel{+}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{L},\\mathcal{R}} \\mathrel{-}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{L}} \\mathrel{-}= s(\\mathbf{n}),\n$$\n对于边界面\n$$\n\\mathbf{A}_{\\mathcal{E},\\mathcal{E}} \\mathrel{+}= s(\\mathbf{n}).\n$$\n当 $\\tau$ 足够大时，此BR2变体产生一个对称正定算子，在均匀网格上，当 $k_x$ 和 $k_y$ 是主扩散率时，它与各向异性拉普拉斯算子的一致五点离散化相吻合。\n\n给定位于 $(i_0,j_0)$ 的一个点源，通过求解相应的线性系统来计算离散格林函数 $\\mathbf{g}^{\\mathrm{LDG}}$ 和 $\\mathbf{g}^{\\mathrm{BR2}}$。通过以下定量度量来研究它们的衰减和方向各向异性，这些度量是根据离散格林函数在相邻单元上的值定义的：\n\n- 将轴对齐一阶邻居定义为 $(i_0+1,j_0)$、$(i_0-1,j_0)$、$(i_0,j_0+1)$、$(i_0,j_0-1)$，将沿正$x$轴的二阶邻居定义为 $(i_0+2,j_0)$。将一阶对角邻居定义为 $(i_0+1,j_0+1)$。设 $\\mathbf{g}$ 表示一个离散格林函数向量，$g_{i,j}$ 为其在单元 $(i,j)$ 中的值。然后计算：\n    - 左右各向异性指数\n    $$\n    \\mathrm{AI}_{\\mathrm{LR}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0} - g_{i_0-1,j_0} \\right|}{\\max\\left( \\left| g_{i_0+1,j_0} \\right|, \\left| g_{i_0-1,j_0} \\right| \\right)}.\n    $$\n    - 上下各向异性指数\n    $$\n    \\mathrm{AI}_{\\mathrm{TB}}(\\mathbf{g}) = \\frac{\\left| g_{i_0,j_0+1} - g_{i_0,j_0-1} \\right|}{\\max\\left( \\left| g_{i_0,j_0+1} \\right|, \\left| g_{i_0,j_0-1} \\right| \\right)}.\n    $$\n    - 轴向衰减比\n    $$\n    \\mathrm{DR}_{\\mathrm{axis}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0} \\right|}{\\left| g_{i_0+2,j_0} \\right|},\n    $$\n    前提是所有索引都在界内。\n    - 对角与轴向比\n    $$\n    \\mathrm{RAR}_{\\mathrm{diag/axis}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0+1} \\right|}{\\left| g_{i_0+1,j_0} \\right|}.\n    $$\n\n对于每个测试用例，计算 $\\mathbf{g}^{\\mathrm{LDG}}$ 和 $\\mathbf{g}^{\\mathrm{BR2}}$ 的上述四个度量，每个测试用例产生八个浮点数，按固定顺序排列\n$$\n\\left[ \\mathrm{AI}_{\\mathrm{LR}}(\\mathbf{g}^{\\mathrm{LDG}}), \\mathrm{AI}_{\\mathrm{LR}}(\\mathbf{g}^{\\mathrm{BR2}}), \\mathrm{AI}_{\\mathrm{TB}}(\\mathbf{g}^{\\mathrm{LDG}}), \\mathrm{AI}_{\\mathrm{TB}}(\\mathbf{g}^{\\mathrm{BR2}}), \\mathrm{DR}_{\\mathrm{axis}}(\\mathbf{g}^{\\mathrm{LDG}}), \\mathrm{DR}_{\\mathrm{axis}}(\\mathbf{g}^{\\mathrm{BR2}}), \\mathrm{RAR}_{\\mathrm{diag/axis}}(\\mathbf{g}^{\\mathrm{LDG}}), \\mathrm{RAR}_{\\mathrm{diag/axis}}(\\mathbf{g}^{\\mathrm{BR2}}) \\right].\n$$\n\n您的程序必须实现上述指定的 $\\mathbf{A}^{\\mathrm{LDG}}$ 和 $\\mathbf{A}^{\\mathrm{BR2}}$ 的组装，使用稀疏直接求解器求解离散格林函数的线性系统，并计算这些度量。\n\n测试套件：\n使用以下测试用例，其参数涵盖一般情况、受边界影响的情况和物理各向异性的情况：\n\n1. 测试用例 1（一般情况，物理各向同性，LDG方向偏置）：\n   - $N_x = 25$, $N_y = 25$, $i_0 = 12$, $j_0 = 12$, $k_x = 1$, $k_y = 1$, $\\tau = 1$, $\\alpha = 0.8$, $\\boldsymbol{\\beta} = (1,1)$。\n\n2. 测试用例 2（较小网格，源靠近边界，x方向LDG偏置更强）：\n   - $N_x = 9$, $N_y = 9$, $i_0 = 2$, $j_0 = 2$, $k_x = 1$, $k_y = 1$, $\\tau = 1.2$, $\\alpha = 0.9$, $\\boldsymbol{\\beta} = (1,0)$。\n\n3. 测试用例 3（物理各向异性扩散张量）：\n   - $N_x = 33$, $N_y = 33$, $i_0 = 16$, $j_0 = 16$, $k_x = 10$, $k_y = 1$, $\\tau = 1$, $\\alpha = 0.5$, $\\boldsymbol{\\beta} = (1,1)$。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含结果，形式为方括号括起来的逗号分隔列表，按顺序连接每个测试用例（顺序为1、2、3）的八个度量，总共24个浮点数：\n$$\n\\left[ \\text{metrics}_{\\text{TC1}}, \\text{metrics}_{\\text{TC2}}, \\text{metrics}_{\\text{TC3}} \\right].\n$$", "solution": "该问题要求计算和分析单位正方形上标量扩散方程的离散格林函数。这通过求解由两种不同的间断伽辽金(DG)格式产生的控制线性系统来实现：一种是非对称的局部间断伽辽金(LDG)方法，另一种是对称的Bassi-Rebay 2 (BR2)方法。基函数选择为在均匀笛卡尔网格上的分片常数函数。\n\n对于每个测试用例，整个过程包括三个主要阶段：\n1. 全局刚度矩阵 $\\mathbf{A}^{\\mathrm{LDG}}$ 和 $\\mathbf{A}^{\\mathrm{BR2}}$ 的组装。\n2. 求解线性系统 $\\mathbf{A}^{\\mathrm{LDG}} \\mathbf{g}^{\\mathrm{LDG}} = \\mathbf{e}_{i_0,j_0}$ 和 $\\mathbf{A}^{\\mathrm{BR2}} \\mathbf{g}^{\\mathrm{BR2}} = \\mathbf{e}_{i_0,j_0}$ 以找到离散格林函数 $\\mathbf{g}^{\\mathrm{LDG}}$ 和 $\\mathbf{g}^{\\mathrm{BR2}}$。\n3. 计算指定的度量以量化所计算格林函数的各向异性和衰减。\n\n一个关键步骤是构建全局刚度矩阵 $\\mathbf{A}$。区域 $\\Omega = (0,1) \\times (0,1)$ 被离散化为 $N_x \\times N_y$ 个矩形单元的网格。自由度的总数是 $N = N_x N_y$。单元由 $(i,j)$ 索引，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$，这些索引被映射到单个线性索引 $k = i N_y + j$。矩阵 $\\mathbf{A}$ 是一个 $N \\times N$ 的稀疏矩阵。\n\n矩阵组装通过迭代所有单元面来执行。每个面的贡献被添加到 $\\mathbf{A}$ 的相应条目中。\n\n让我们考虑一个分隔两个单元的内部垂直面，$\\mathcal{L}$ 位于 $(i,j)$，$\\mathcal{R}$ 位于 $(i+1,j)$。从 $\\mathcal{L}$ 指向 $\\mathcal{R}$ 的单位法向量是 $\\mathbf{n} = (1,0)^\\top$。法向的网格尺寸是 $h_n = h_x = 1/N_x$。面稳定化系数定义为：\n$$\ns(\\mathbf{n}) = \\tau \\frac{k_x}{h_x}\n$$\n类似地，对于 $(i,j)$ 和 $(i,j+1)$ 之间的水平面，法向量是 $\\mathbf{n} = (0,1)^\\top$，系数是 $s(\\mathbf{n}) = \\tau k_y / h_y$。\n\n对于BR2方法，它是一种对称内部罚方法，$\\mathcal{L}$ 和 $\\mathcal{R}$ 之间面的贡献是：\n$$\n\\mathbf{A}_{\\mathcal{L},\\mathcal{L}} \\mathrel{+}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{R}} \\mathrel{+}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{L},\\mathcal{R}} \\mathrel{-}= s(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{L}} \\mathrel{-}= s(\\mathbf{n})\n$$\n此组装规则是对称的，导致一个对称矩阵 $\\mathbf{A}^{\\mathrm{BR2}}$。\n\n对于LDG方法，该格式引入了非对称、方向性的偏置。稳定化系数 $s(\\mathbf{n})$ 被分成两部分，$s_{\\mathcal{L}}(\\mathbf{n})$ 和 $s_{\\mathcal{R}}(\\mathbf{n})$，这取决于点积 $\\boldsymbol{\\beta} \\cdot \\mathbf{n}$ 的符号，其中 $\\boldsymbol{\\beta}$ 是全局方向向量，$\\alpha \\in [0,1)$ 是偏置参数。\n如果 $\\boldsymbol{\\beta} \\cdot \\mathbf{n} \\ge 0$：\n$$\ns_{\\mathcal{L}}(\\mathbf{n}) = \\frac{1+\\alpha}{2} s(\\mathbf{n}), \\quad s_{\\mathcal{R}}(\\mathbf{n}) = \\frac{1-\\alpha}{2} s(\\mathbf{n})\n$$\n如果 $\\boldsymbol{\\beta} \\cdot \\mathbf{n}  0$，则 $\\mathcal{L}$ 和 $\\mathcal{R}$ 的角色互换，意味着：\n$$\ns_{\\mathcal{L}}(\\mathbf{n}) = \\frac{1-\\alpha}{2} s(\\mathbf{n}), \\quad s_{\\mathcal{R}}(\\mathbf{n}) = \\frac{1+\\alpha}{2} s(\\mathbf{n})\n$$\nLDG方法的矩阵组装贡献为：\n$$\n\\begin{aligned}\n\\mathbf{A}_{\\mathcal{L},\\mathcal{L}} \\mathrel{+}= s_{\\mathcal{L}}(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{L},\\mathcal{R}} \\mathrel{-}= s_{\\mathcal{L}}(\\mathbf{n}),\\\\\n\\mathbf{A}_{\\mathcal{R},\\mathcal{R}} \\mathrel{+}= s_{\\mathcal{R}}(\\mathbf{n}), \\quad \\mathbf{A}_{\\mathcal{R},\\mathcal{L}} \\mathrel{-}= s_{\\mathcal{R}}(\\mathbf{n})\n\\end{aligned}\n$$\n由于当 $\\alpha \\ne 0$ 时 $s_{\\mathcal{L}} \\ne s_{\\mathcal{R}}$，因此得到的矩阵 $\\mathbf{A}^{\\mathrm{LDG}}$ 通常是非对称的。\n\n对于域 $\\partial\\Omega$ 边界上的面，均匀狄利克雷条件被弱施加。对于具有一个边界面的单元 $\\mathcal{E}$，一个罚项被加到其对角线元素上：\n$$\n\\mathbf{A}_{\\mathcal{E},\\mathcal{E}} \\mathrel{+}= s(\\mathbf{n})\n$$\n这适用于BR2和LDG方法，其中 $\\mathbf{n}$ 是边界面的外向法向量。\n\n线性系统的右侧项 $\\mathbf{e}_{i_0,j_0}$ 是一个全零向量，除了在对应于源单元 $(i_0,j_0)$ 的线性索引处值为1。这代表一个离散狄拉克δ函数。\n\n矩阵 $\\mathbf{A}^{\\mathrm{LDG}}$ 和 $\\mathbf{A}^{\\mathrm{BR2}}$ 被组装为稀疏矩阵，具体使用 `scipy.sparse.lil_matrix` 进行高效构建，然后转换为 `scipy.sparse.csr_matrix` 以进行快速算术运算和求解。线性系统使用稀疏直接求解器 `scipy.sparse.linalg.spsolve` 求解。\n\n得到的解向量 $\\mathbf{g}^{\\mathrm{LDG}}$ 和 $\\mathbf{g}^{\\mathrm{BR2}}$ 被重塑为 $N_x \\times N_y$ 的数组。使用这些数组中的值 $g_{i,j}$，为每种方法计算以下四个度量：\n- 左右各向异性指数：$\\mathrm{AI}_{\\mathrm{LR}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0} - g_{i_0-1,j_0} \\right|}{\\max\\left( \\left| g_{i_0+1,j_0} \\right|, \\left| g_{i_0-1,j_0} \\right| \\right)}$\n- 上下各向异性指数：$\\mathrm{AI}_{\\mathrm{TB}}(\\mathbf{g}) = \\frac{\\left| g_{i_0,j_0+1} - g_{i_0,j_0-1} \\right|}{\\max\\left( \\left| g_{i_0,j_0+1} \\right|, \\left| g_{i_0,j_0-1} \\right| \\right)}$\n- 轴向衰减比：$\\mathrm{DR}_{\\mathrm{axis}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0} \\right|}{\\left| g_{i_0+2,j_0} \\right|}$\n- 对角与轴向比：$\\mathrm{RAR}_{\\mathrm{diag/axis}}(\\mathbf{g}) = \\frac{\\left| g_{i_0+1,j_0+1} \\right|}{\\left| g_{i_0+1,j_0} \\right|}$\n\n这些度量为每种DG方案的数值耗散和方向偏置，以及扩散张量 $\\mathbf{K}$ 的物理各向异性如何体现在离散解中提供了定量的洞察。最终输出是为所提供的三个测试用例中的每一个计算出的八个度量的扁平化列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef assemble_matrix(Nx, Ny, kx, ky, tau, alpha, beta, method):\n    \"\"\"\n    Assembles the sparse stiffness matrix for the given DG method.\n    \"\"\"\n    N = Nx * Ny\n    hx = 1.0 / Nx\n    hy = 1.0 / Ny\n    A = lil_matrix((N, N), dtype=np.float64)\n\n    def idx(i, j):\n        # Maps 2D element index (i, j) to 1D linear index.\n        return i * Ny + j\n\n    # Process vertical interior faces\n    sx = tau * kx / hx\n    for i in range(Nx - 1):\n        for j in range(Ny):\n            kL = idx(i, j)\n            kR = idx(i + 1, j)\n\n            if method == 'BR2':\n                A[kL, kL] += sx\n                A[kR, kR] += sx\n                A[kL, kR] -= sx\n                A[kR, kL] -= sx\n            elif method == 'LDG':\n                n = np.array([1.0, 0.0])\n                beta_dot_n = np.dot(beta, n)\n                if beta_dot_n >= 0:\n                    sL = 0.5 * (1.0 + alpha) * sx\n                    sR = 0.5 * (1.0 - alpha) * sx\n                else:\n                    sL = 0.5 * (1.0 - alpha) * sx\n                    sR = 0.5 * (1.0 + alpha) * sx\n                \n                A[kL, kL] += sL\n                A[kL, kR] -= sL\n                A[kR, kR] += sR\n                A[kR, kL] -= sR\n\n    # Process horizontal interior faces\n    sy = tau * ky / hy\n    for i in range(Nx):\n        for j in range(Ny - 1):\n            kL = idx(i, j)      # Bottom element\n            kR = idx(i, j + 1)  # Top element\n\n            if method == 'BR2':\n                A[kL, kL] += sy\n                A[kR, kR] += sy\n                A[kL, kR] -= sy\n                A[kR, kL] -= sy\n            elif method == 'LDG':\n                n = np.array([0.0, 1.0])\n                beta_dot_n = np.dot(beta, n)\n                if beta_dot_n >= 0:\n                    sL = 0.5 * (1.0 + alpha) * sy\n                    sR = 0.5 * (1.0 - alpha) * sy\n                else:\n                    sL = 0.5 * (1.0 - alpha) * sy\n                    sR = 0.5 * (1.0 + alpha) * sy\n                \n                A[kL, kL] += sL\n                A[kL, kR] -= sL\n                A[kR, kR] += sR\n                A[kR, kL] -= sR\n\n    # Process boundary faces (penalty enforcement)\n    # Left boundary (i=0)\n    for j in range(Ny):\n        A[idx(0, j), idx(0, j)] += sx\n    # Right boundary (i=Nx-1)\n    for j in range(Ny):\n        A[idx(Nx - 1, j), idx(Nx - 1, j)] += sx\n    # Bottom boundary (j=0)\n    for i in range(Nx):\n        A[idx(i, 0), idx(i, 0)] += sy\n    # Top boundary (j=Ny-1)\n    for i in range(Ny):\n        A[idx(i, Ny - 1), idx(i, Ny - 1)] += sy\n\n    return A.tocsr()\n\ndef compute_metrics(g, i0, j0):\n    \"\"\"\n    Computes the four specified metrics from the discrete Green's function.\n    \"\"\"\n    g_ip1_j0 = g[i0 + 1, j0]\n    g_im1_j0 = g[i0 - 1, j0]\n    g_i0_jp1 = g[i0, j0 + 1]\n    g_i0_jm1 = g[i0, j0 - 1]\n    g_ip2_j0 = g[i0 + 2, j0]\n    g_ip1_jp1 = g[i0 + 1, j0 + 1]\n\n    # AI_LR\n    num_lr = np.abs(g_ip1_j0 - g_im1_j0)\n    den_lr = np.max([np.abs(g_ip1_j0), np.abs(g_im1_j0)])\n    ai_lr = num_lr / den_lr if den_lr > 1e-15 else 0.0\n\n    # AI_TB\n    num_tb = np.abs(g_i0_jp1 - g_i0_jm1)\n    den_tb = np.max([np.abs(g_i0_jp1), np.abs(g_i0_jm1)])\n    ai_tb = num_tb / den_tb if den_tb > 1e-15 else 0.0\n\n    # DR_axis\n    num_dr = np.abs(g_ip1_j0)\n    den_dr = np.abs(g_ip2_j0)\n    dr_axis = num_dr / den_dr if den_dr > 1e-15 else 0.0\n\n    # RAR_diag/axis\n    num_rar = np.abs(g_ip1_jp1)\n    den_rar = np.abs(g_ip1_j0)\n    rar_diag_axis = num_rar / den_rar if den_rar > 1e-15 else 0.0\n\n    return {\n        'AI_LR': ai_lr, 'AI_TB': ai_tb, \n        'DR_axis': dr_axis, 'RAR_diag/axis': rar_diag_axis\n    }\n\ndef solve_case(case_params):\n    \"\"\"\n    Solves one test case: assembles matrices, solves systems, computes metrics.\n    \"\"\"\n    Nx, Ny, i0, j0, kx, ky, tau, alpha, beta_tuple = case_params\n    beta = np.array(beta_tuple, dtype=np.float64)\n    \n    A_ldg = assemble_matrix(Nx, Ny, kx, ky, tau, alpha, beta, 'LDG')\n    A_br2 = assemble_matrix(Nx, Ny, kx, ky, tau, alpha, beta, 'BR2')\n\n    N = Nx * Ny\n    rhs = np.zeros(N)\n    source_idx = i0 * Ny + j0\n    rhs[source_idx] = 1.0\n\n    g_ldg_flat = spsolve(A_ldg, rhs)\n    g_br2_flat = spsolve(A_br2, rhs)\n\n    g_ldg = g_ldg_flat.reshape((Nx, Ny))\n    g_br2 = g_br2_flat.reshape((Nx, Ny))\n\n    metrics_ldg = compute_metrics(g_ldg, i0, j0)\n    metrics_br2 = compute_metrics(g_br2, i0, j0)\n\n    results = [\n        metrics_ldg['AI_LR'], metrics_br2['AI_LR'],\n        metrics_ldg['AI_TB'], metrics_br2['AI_TB'],\n        metrics_ldg['DR_axis'], metrics_br2['DR_axis'],\n        metrics_ldg['RAR_diag/axis'], metrics_br2['RAR_diag/axis']\n    ]\n    return results\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, i0, j0, kx, ky, tau, alpha, beta)\n        (25, 25, 12, 12, 1.0, 1.0, 1.0, 0.8, (1.0, 1.0)),\n        (9, 9, 2, 2, 1.0, 1.0, 1.2, 0.9, (1.0, 0.0)),\n        (33, 33, 16, 16, 10.0, 1.0, 1.0, 0.5, (1.0, 1.0)),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        case_results = solve_case(case)\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3417428"}]}