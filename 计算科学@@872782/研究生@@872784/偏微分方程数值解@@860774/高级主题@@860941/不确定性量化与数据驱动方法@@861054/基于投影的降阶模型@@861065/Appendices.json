{"hands_on_practices": [{"introduction": "本练习将指导您完成构建一个基于投影的降阶模型（ROM）的核心步骤。您将从一个参数化的椭圆型偏微分方程的弱形式出发，通过伽辽金投影推导出降阶线性系统。此过程不仅能加深您对降阶基本机制的理解，还将引导您基于第一性原理，探讨保证模型稳定性的关键条件，即强制性。[@problem_id:2593121]", "problem": "考虑参数化的对称椭圆变分问题：求 $u(\\mu) \\in V$，使得对所有 $v \\in V$ 都有 $a_{\\mu}(u(\\mu),v) = f(v)$，其中 $V = H_{0}^{1}(0,\\pi)$ 且\n$$\na_{\\mu}(u,v) = \\int_{0}^{\\pi} \\left( \\mu \\, u'(x) v'(x) + u(x) v(x) \\right) \\,\\mathrm{d}x, \n\\qquad\nf(v) = \\int_{0}^{\\pi} g(x) v(x) \\,\\mathrm{d}x,\n$$\n参数 $\\mu \\in [\\mu_{\\min},\\mu_{\\max}]$，$g(x) = \\sin(x)$。设基于投影的降阶模型（ROM）的试验空间为 $V_{r} = \\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$，其中 $\\phi_{1}(x) = \\sqrt{\\frac{2}{\\pi}} \\sin(x)$ 和 $\\phi_{2}(x) = \\sqrt{\\frac{2}{\\pi}} \\sin(2x)$。选择测试空间 $W_{r}$，并用 $u_{r}(\\mu) = \\sum_{j=1}^{2} c_{j}(\\mu) \\phi_{j}$ 来近似 $u(\\mu)$。\n\n从弱形式和投影法的定义出发，施加残差与 $W_{r}$ 正交的条件，以推导降阶线性系统 $A_{r}(\\mu) c(\\mu) = b_{r}(\\mu)$，其中 $c(\\mu) = (c_{1}(\\mu), c_{2}(\\mu))^{\\top}$。将 $A_{r}(\\mu)$ 和 $b_{r}(\\mu)$ 严格用双线性和线性形式表示，即 $A_{r}(\\mu)_{ij} = a_{\\mu}(\\phi_{j},\\psi_{i})$ 和 $b_{r}(\\mu)_{i} = f(\\psi_{i})$，对于 $W_{r}$ 的一个选定的基 $\\{\\psi_{i}\\}_{i=1}^{2}$。\n\n然后，令 $W_{r} = V_{r}$（Galerkin选择），并显式计算 $A_{r}(\\mu)$ 和 $b_{r}(\\mu)$。接下来，从第一性原理出发，基于变分问题的适定性，阐述在何种关于双线性形式 $a_{\\mu}(\\cdot,\\cdot)$ 和空间的条件下，Galerkin ROM（即 $W_{r} = V_{r}$）对所有 $\\mu \\in [\\mu_{\\min},\\mu_{\\max}]$ 都是稳定的。\n\n最后，设 $V$ 上的范数为 $H^{1}$ 型范数\n$$\n\\|v\\|_{V}^{2} = \\int_{0}^{\\pi} \\left( |v'(x)|^{2} + |v(x)|^{2} \\right) \\,\\mathrm{d}x,\n$$\n并将参数限制在 $[\\mu_{\\min},\\mu_{\\max}] = \\left[\\frac{1}{2}, 2\\right]$。定义降阶矫顽常数\n$$\n\\alpha_{r}(\\mu) = \\inf_{0 \\neq v_{r} \\in V_{r}} \\frac{a_{\\mu}(v_{r},v_{r})}{\\|v_{r}\\|_{V}^{2}},\n$$\n及其一致对应项\n$$\n\\alpha_{r}^{\\star} = \\inf_{\\mu \\in [\\frac{1}{2},2]} \\alpha_{r}(\\mu).\n$$\n计算 $\\alpha_{r}^{\\star}$。你的最终答案必须是一个实数，不带单位，且无舍入说明。", "solution": "所给的问题陈述经过了验证，被认为是有效的。其科学基础在于偏微分方程的数值方法理论，特别是针对参数化椭圆问题的基于投影的模型降阶。该问题是适定的、客观的且内部一致的，包含了求解所需的所有信息。它不违反任何基本原理，构成了该领域一个标准的、可验证的练习。因此，我们可以开始求解。\n\n问题要求找到弱形式的一个近似解 $u_{r}(\\mu) \\in V_{r}$：求 $u(\\mu) \\in V$ 使得\n$$a_{\\mu}(u(\\mu),v) = f(v) \\quad \\forall v \\in V.$$\n近似解由 $u_{r}(\\mu) = \\sum_{j=1}^{2} c_{j}(\\mu) \\phi_{j}$ 给出，其中 $V_{r} = \\mathrm{span}\\{\\phi_{1}, \\phi_{2}\\}$。投影法施加了近似的残差与测试空间 $W_{r} = \\mathrm{span}\\{\\psi_{1}, \\psi_{2}\\}$ 正交的条件。残差定义为 $R(v) = f(v) - a_{\\mu}(u_{r}(\\mu), v)$。因此正交条件是\n$$a_{\\mu}(u_{r}(\\mu), \\psi_{i}) = f(\\psi_{i}), \\quad i = 1, 2.$$\n代入 $u_{r}(\\mu)$ 的表达式，并利用双线性形式 $a_{\\mu}(\\cdot, \\cdot)$ 在其第一个参数上的线性性质，我们得到\n$$a_{\\mu}\\left(\\sum_{j=1}^{2} c_{j}(\\mu) \\phi_{j}, \\psi_{i}\\right) = \\sum_{j=1}^{2} c_{j}(\\mu) a_{\\mu}(\\phi_{j}, \\psi_{i}) = f(\\psi_{i}), \\quad i=1, 2.$$\n这是一个关于未知系数 $c(\\mu) = (c_{1}(\\mu), c_{2}(\\mu))^{\\top}$ 的二元线性方程组。以矩阵形式表示，即为 $A_{r}(\\mu) c(\\mu) = b_{r}(\\mu)$，其中矩阵元素为 $(A_{r}(\\mu))_{ij} = a_{\\mu}(\\phi_{j}, \\psi_{i})$，向量元素为 $(b_{r}(\\mu))_{i} = f(\\psi_{i})$。\n\n我们现在专门讨论 Galerkin 方法，其中测试空间与试验空间相同，即 $W_{r} = V_{r}$，这意味着我们选择 $\\psi_{i} = \\phi_{i}$。我们显式计算降阶系统矩阵 $A_{r}(\\mu)$ 和向量 $b_{r}(\\mu)$。基函数为 $\\phi_{1}(x) = \\sqrt{\\frac{2}{\\pi}} \\sin(x)$ 和 $\\phi_{2}(x) = \\sqrt{\\frac{2}{\\pi}} \\sin(2x)$。它们的导数是 $\\phi_{1}'(x) = \\sqrt{\\frac{2}{\\pi}} \\cos(x)$ 和 $\\phi_{2}'(x) = 2\\sqrt{\\frac{2}{\\pi}} \\cos(2x)$。\n矩阵元素为 $(A_{r}(\\mu))_{ij} = a_{\\mu}(\\phi_{j}, \\phi_{i}) = \\int_{0}^{\\pi} (\\mu \\phi_{j}'(x) \\phi_{i}'(x) + \\phi_{j}(x) \\phi_{i}(x)) \\,\\mathrm{d}x$。我们需要以下积分，这些积分可由三角函数在 $[0,\\pi]$ 上的性质得出：\n$$ \\int_{0}^{\\pi} \\sin(kx)\\sin(lx)\\,\\mathrm{d}x = \\frac{\\pi}{2}\\delta_{kl}, \\quad \\int_{0}^{\\pi} \\cos(kx)\\cos(lx)\\,\\mathrm{d}x = \\frac{\\pi}{2}\\delta_{kl} \\quad (k,l \\in \\{1,2\\}), $$\n$$ \\int_{0}^{\\pi} \\sin(x)\\sin(2x)\\,\\mathrm{d}x = 0, \\quad \\int_{0}^{\\pi} \\cos(x)\\cos(2x)\\,\\mathrm{d}x = 0. $$\n质量矩阵 $M_{ij} = \\int_{0}^{\\pi} \\phi_{i}(x)\\phi_{j}(x)\\,\\mathrm{d}x$：\n$M_{11} = \\frac{2}{\\pi}\\int_{0}^{\\pi}\\sin^2(x)\\,\\mathrm{d}x = 1$, $M_{22} = \\frac{2}{\\pi}\\int_{0}^{\\pi}\\sin^2(2x)\\,\\mathrm{d}x = 1$, $M_{12}=M_{21} = 0$。所以，$M = I$。\n刚度矩阵 $K_{ij} = \\int_{0}^{\\pi} \\phi_{i}'(x)\\phi_{j}'(x)\\,\\mathrm{d}x$：\n$K_{11} = \\frac{2}{\\pi}\\int_{0}^{\\pi}\\cos^2(x)\\,\\mathrm{d}x = 1$, $K_{22} = \\frac{2}{\\pi}\\int_{0}^{\\pi}(2\\cos(2x))^2\\,\\mathrm{d}x = \\frac{8}{\\pi}\\frac{\\pi}{2}=4$, $K_{12}=K_{21}=0$。\n因此，$A_{r}(\\mu) = \\mu K + M = \\mu \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\mu+1 & 0 \\\\ 0 & 4\\mu+1 \\end{pmatrix}$。\n\n向量元素为 $(b_{r})_{i} = f(\\phi_{i}) = \\int_{0}^{\\pi} g(x)\\phi_{i}(x)\\,\\mathrm{d}x$，其中 $g(x) = \\sin(x)$。\n$(b_{r})_{1} = \\int_{0}^{\\pi} \\sin(x) \\sqrt{\\frac{2}{\\pi}}\\sin(x)\\,\\mathrm{d}x = \\sqrt{\\frac{2}{\\pi}}\\int_{0}^{\\pi}\\sin^2(x)\\,\\mathrm{d}x = \\sqrt{\\frac{2}{\\pi}}\\frac{\\pi}{2} = \\sqrt{\\frac{\\pi}{2}}$。\n$(b_{r})_{2} = \\int_{0}^{\\pi} \\sin(x) \\sqrt{\\frac{2}{\\pi}}\\sin(2x)\\,\\mathrm{d}x = \\sqrt{\\frac{2}{\\pi}}\\int_{0}^{\\pi}\\sin(x)\\sin(2x)\\,\\mathrm{d}x = 0$。\n所以，$b_{r} = \\begin{pmatrix} \\sqrt{\\frac{\\pi}{2}} \\\\ 0 \\end{pmatrix}$。注意 $b_r$ 与 $\\mu$ 无关。\n\n为了 Galerkin ROM 的稳定性，我们要求降阶线性系统对任意右端项都有唯一解。这等价于矩阵 $A_{r}(\\mu)$ 是可逆的。设 $v_{r} = \\sum_{j=1}^{2} c_{j}\\phi_{j}$ 是 $V_{r}$ 中的任意函数，其系数向量为 $c = (c_{1}, c_{2})^{\\top}$。与矩阵 $A_{r}(\\mu)$ 相关的二次型是\n$$c^{\\top}A_{r}(\\mu)c = \\sum_{i=1}^{2}\\sum_{j=1}^{2} c_{i} (A_{r}(\\mu))_{ij} c_{j} = \\sum_{i=1}^{2}\\sum_{j=1}^{2} c_{i} a_{\\mu}(\\phi_{j}, \\phi_{i}) c_{j} = a_{\\mu}\\left(\\sum_{j=1}^{2}c_{j}\\phi_{j}, \\sum_{i=1}^{2}c_{i}\\phi_{i}\\right) = a_{\\mu}(v_{r},v_{r}).$$\n从第一性原理可知，矩阵 $A_{r}(\\mu)$ 是正定的当且仅当对所有 $c \\neq 0$ 都有 $c^{\\top}A_{r}(\\mu)c > 0$。这等价于对所有 $v_{r} \\neq 0$ 都有 $a_{\\mu}(v_{r},v_{r}) > 0$。为了保证稳定性，一个更强的条件，即双线性形式 $a_{\\mu}(\\cdot,\\cdot)$ 在子空间 $V_{r}$ 上的矫顽性，是充分的。该条件表述为：存在一个常数 $\\alpha_{r}(\\mu)>0$ 使得对所有 $v_{r} \\in V_{r}$ 都有 $a_{\\mu}(v_{r},v_{r}) \\ge \\alpha_{r}(\\mu) \\|v_{r}\\|_{V}^{2}$。如果该条件成立，则 $v_r \\neq 0$ 意味着 $\\|v_r\\|_V > 0$，这又意味着 $a_{\\mu}(v_{r},v_{r}) > 0$。由此产生的 $A_{r}(\\mu)$ 的正定性保证了其可逆性，从而保证了 Galerkin ROM 的稳定性。对所有 $\\mu \\in [\\mu_{\\min},\\mu_{\\max}]$ 的一致稳定性取决于矫顽常数的一致正性，即 $\\inf_{\\mu \\in [\\mu_{\\min},\\mu_{\\max}]} \\alpha_{r}(\\mu) > 0$。\n\n最后，我们计算 $\\alpha_{r}^{\\star} = \\inf_{\\mu \\in [\\frac{1}{2},2]} \\alpha_{r}(\\mu)$，其中 $\\alpha_{r}(\\mu) = \\inf_{0 \\neq v_{r} \\in V_{r}} \\frac{a_{\\mu}(v_{r},v_{r})}{\\|v_{r}\\|_{V}^{2}}$。\n设 $v_{r}(x) = c_{1}\\phi_{1}(x) + c_{2}\\phi_{2}(x)$。分子是\n$a_{\\mu}(v_{r},v_{r}) = \\int_{0}^{\\pi} (\\mu (v_{r}')^2 + v_{r}^2) \\,\\mathrm{d}x = \\mu\\int_{0}^{\\pi}(c_{1}\\phi_{1}' + c_{2}\\phi_{2}')^2\\,\\mathrm{d}x + \\int_{0}^{\\pi}(c_{1}\\phi_{1} + c_{2}\\phi_{2})^2\\,\\mathrm{d}x$。\n使用前面计算出的正交性质，这可以简化为\n$a_{\\mu}(v_{r},v_{r}) = \\mu(c_{1}^2 K_{11} + c_{2}^2 K_{22}) + (c_{1}^2 M_{11} + c_{2}^2 M_{22}) = \\mu(c_{1}^2 + 4c_{2}^2) + (c_{1}^2+c_{2}^2) = (\\mu+1)c_{1}^2 + (4\\mu+1)c_{2}^2$。\n分母是范数的平方 $\\|v_{r}\\|_{V}^{2} = \\int_{0}^{\\pi} ((v_{r}')^2 + v_{r}^2)\\,\\mathrm{d}x$。这对应于 $\\mu=1$ 时的 $a_{\\mu}(v_r, v_r)$。\n$\\|v_{r}\\|_{V}^{2} = (c_{1}^2 + 4c_{2}^2) + (c_{1}^2+c_{2}^2) = 2c_{1}^2 + 5c_{2}^2$。\n我们需要求该比率的下确界：\n$$ \\frac{a_{\\mu}(v_{r},v_{r})}{\\|v_{r}\\|_{V}^{2}} = \\frac{(\\mu+1)c_{1}^2 + (4\\mu+1)c_{2}^2}{2c_{1}^2 + 5c_{2}^2}. $$\n此表达式关于 $(c_1, c_2)$ 是齐次的，因此我们可以对变量 $t = c_{2}^2/c_{1}^2 \\ge 0$ 进行最小化。这涵盖了除 $c_1=0$ 之外的所有情况，$c_1=0$ 的情况我们单独考虑。令 $h(t) = \\frac{(\\mu+1) + (4\\mu+1)t}{2 + 5t}$。\n为了求 $t \\ge 0$ 时 $h(t)$ 的下确界，我们分析其导数：\n$$ h'(t) = \\frac{(4\\mu+1)(2+5t) - 5((\\mu+1)+(4\\mu+1)t)}{(2+5t)^2} = \\frac{8\\mu+2 - (5\\mu+5)}{(2+5t)^2} = \\frac{3\\mu-3}{(2+5t)^2}. $$\n$h'(t)$ 的符号由 $\\mu-1$ 的符号决定。\n- 如果 $\\mu > 1$，$h'(t) > 0$，所以 $h(t)$ 是递增的。下确界在 $t=0$ 处取得：$h(0) = \\frac{\\mu+1}{2}$。这对应于 $c_2=0$。\n- 如果 $\\mu < 1$，$h'(t) < 0$，所以 $h(t)$ 是递减的。下确界是当 $t \\to \\infty$ 时的极限：$\\lim_{t\\to\\infty}h(t) = \\frac{4\\mu+1}{5}$。这对应于 $c_1=0$。\n- 如果 $\\mu = 1$，$h'(t) = 0$，所以 $h(t)$ 是常数：$h(t) = \\frac{1+1}{2} = 1$。\n\n因此，降阶矫顽常数为 $\\alpha_{r}(\\mu) = \\min\\left(\\frac{\\mu+1}{2}, \\frac{4\\mu+1}{5}\\right)$。\n我们需要求 $\\alpha_{r}^{\\star} = \\inf_{\\mu \\in [\\frac{1}{2},2]} \\alpha_{r}(\\mu)$。我们来分析 $\\mu$ 的这两个函数。它们在 $\\frac{\\mu+1}{2} = \\frac{4\\mu+1}{5} \\implies 5\\mu+5 = 8\\mu+2 \\implies 3\\mu = 3 \\implies \\mu=1$ 时相等。\n对于 $\\mu < 1$，$\\frac{\\mu+1}{2} > \\frac{4\\mu+1}{5}$。对于 $\\mu > 1$，$\\frac{\\mu+1}{2} < \\frac{4\\mu+1}{5}$。\n因此，$\\alpha_{r}(\\mu)$ 由下式给出：\n$$ \\alpha_{r}(\\mu) = \\begin{cases} \\frac{4\\mu+1}{5} & \\text{若 } \\mu \\in [\\frac{1}{2}, 1] \\\\ \\frac{\\mu+1}{2} & \\text{若 } \\mu \\in [1, 2] \\end{cases} $$\n函数 $\\frac{4\\mu+1}{5}$ 在 $[\\frac{1}{2}, 1]$ 上是递增的。函数 $\\frac{\\mu+1}{2}$ 在 $[1, 2]$ 上是递增的。由于 $\\alpha_{r}(1)$ 是连续的，整个函数 $\\alpha_{r}(\\mu)$ 在区间 $[\\frac{1}{2}, 2]$ 上是递增的。\n增函数在区间上的下确界是其在左端点的值。\n因此，$\\alpha_{r}^{\\star} = \\alpha_{r}(\\frac{1}{2})$。\n使用 $\\alpha_r(\\mu)$ 表达式的第一个分支：\n$$ \\alpha_{r}^{\\star} = \\frac{4(\\frac{1}{2}) + 1}{5} = \\frac{2+1}{5} = \\frac{3}{5}. $$", "answer": "$$\\boxed{\\frac{3}{5}}$$", "id": "2593121"}, {"introduction": "在构建了静态的降阶模型之后，下一个挑战是如何在动态（时间演化）问题中保证其精度。本练习介绍了一种强大的在线误差控制策略，它使用后验误差估计来实时量化ROM的误差。您将实现一个自适应算法，当误差超过预设阈值时，通过在线富集降阶基来动态调整模型，从而在保证精度的同时最大限度地提高计算效率。[@problem_id:3435653]", "problem": "考虑一个一维空间中的线性抛物型偏微分方程（PDE），其具有齐次狄利克雷边界条件和一个随时间变化的源项，该方程在空间上通过均匀网格上的中心有限差分进行离散，在时间上通过后向欧拉法进行离散。设空间域为区间 $\\left[0,1\\right]$，有 $N$ 个内部点，网格间距 $h = \\frac{1}{N+1}$，网格点为 $x_i = i h$（$i = 1,\\dots,N$）。设扩散系数为 $\\nu > 0$。使用标准的二阶中心差分拉普拉斯算子和齐次狄利克雷边界条件进行半离散（空间上）表示，得到未知向量 $u(t) \\in \\mathbb{R}^N$ 的常微分方程组，形式如下\n$$\n\\frac{d}{dt} u(t) = \\nu L u(t) + s(t),\n$$\n其中 $L \\in \\mathbb{R}^{N \\times N}$ 是通常的有限差分拉普拉斯算子，其模板为 $\\left[\\frac{1}{h^2}, -\\frac{2}{h^2}, \\frac{1}{h^2}\\right]$，并且由于齐次狄利克雷边界条件，在第一行和最后一行的边界外条目处为零，而 $s(t) \\in \\mathbb{R}^N$ 是在网格点上采样的源项向量。采用时间步长 $\\Delta t > 0$ 的后向欧拉时间离散化，对每个整数时间索引 $k \\ge 1$ 导出一个线性系统\n$$\n\\left(\\frac{1}{\\Delta t} I - \\nu L\\right) u^k = \\frac{1}{\\Delta t} u^{k-1} + s^k,\n$$\n其中 $I$ 是单位矩阵，$u^k \\approx u(t_k)$ 且 $t_k = k \\Delta t$，$s^k \\approx s(t_k)$。\n\n定义对称正定矩阵\n$$\nA := -\\nu L \\in \\mathbb{R}^{N \\times N}, \\quad B := \\frac{1}{\\Delta t} I + A \\in \\mathbb{R}^{N \\times N}.\n$$\n设降阶模型（ROM）在一个由基矩阵 $V_r \\in \\mathbb{R}^{N \\times r}$（其中 $V_r^T V_r = I_r$）的列向量张成的维度为 $r \\ll N$ 的试探子空间中逼近 $u^k$。将后向欧拉格式伽辽金投影到 $\\text{span}(V_r)$ 上，得到关于系数 $a^k \\in \\mathbb{R}^r$ 的降阶系统\n$$\n\\left(\\frac{1}{\\Delta t} I_r + V_r^T A V_r\\right) a^k = \\frac{1}{\\Delta t} a^{k-1} + V_r^T s^k.\n$$\nROM 状态为 $u_r^k = V_r a^k$。相应地，在时间步 $k$ 的全阶残差向量定义为\n$$\nr(u_r^k) := \\frac{1}{\\Delta t} u_r^{k-1} + s^k - \\left(\\frac{1}{\\Delta t} I + A\\right) u_r^k = \\frac{1}{\\Delta t} u_r^{k-1} + s^k - B u_r^k \\in \\mathbb{R}^N.\n$$\n\n你需要为 ROM 时间积分器实现一种在线误差控制策略，该策略基于投影残差对偶范数和增量基富集。\n\n任务：\n- 从线性强制问题的伽辽金投影和后向欧拉格式的基本概念出发，推导一个在每个时间步可计算的后验误差界，该误差界用 $r(u_r^k)$ 关于对称正定算子 $B$ 的对偶范数表示。设该对偶范数定义为\n$$\n\\|r\\|_{B^{-1}} := \\sqrt{r^T B^{-1} r}.\n$$\n- 设计一个用于在时间步 $k$ 接受 ROM 解的停止准则，该准则基于一个与 $\\|r(u_r^k)\\|_{B^{-1}}$ 相关的经过验证的后验界。在时间步 $k$ 的接受准则必须是：如果 $\\|r(u_r^k)\\|_{B^{-1}} \\le \\tau$，则接受，其中 $\\tau > 0$ 是一个容差。如果不接受，则通过附加一个在线计算的新方向来执行增量基更新，并在同一时间步重新计算 ROM 解，迭代此过程直到解被接受或基的规模达到预设的最大值 $r_{\\max}$。\n- 在时间步 $k$ 的在线富集方向必须以误差方程所证明的方式来选择。使用残差在 $B$-内积中的 Riesz 表示，即求解 $B w^k = r(u_r^k)$ 的向量 $w^k$。在欧几里得内积下，将 $w^k$ 与当前基的列向量进行正交化，然后将其归一化，附加到 $V_r$ 中，并更新降阶算子。在求解 $a^k$ 之前，在新基中重新计算 $a^{k-1}$ 为 $V_r^T u_r^{k-1}$。\n- 初始降阶基必须由对应于齐次狄利克雷边界条件的前 $r_0$ 个离散正弦模态构成，即对于 $j = 1,\\dots,r_0$ 和 $i = 1,\\dots,N$，其列向量的元素为 $v_j(i) = \\sin\\left(\\frac{j \\pi i}{N+1}\\right)$，并在欧几里得内积下进行标准正交化。初始 ROM 状态 $u_r^0$ 必须是初始条件在 $\\text{span}(V_{r_0})$ 上的投影。\n\n按如下方式设置全阶模型的数据：\n- 空间维度：$N = 80$ 个内部网格点。\n- 扩散系数：$\\nu = 10^{-2}$。\n- 最终时间：$T = 10^{-1}$。\n- 时间步长：$\\Delta t = 2 \\cdot 10^{-3}$，因此有 $K = \\frac{T}{\\Delta t} = 50$ 个时间步。\n- 初始条件：$u^0(x) = \\sin(\\pi x)$，在网格点上采样。\n- 源项：$s(x,t) = \\sin(5 \\pi x) e^{-t}$，在网格点上采样并在 $t_k = k \\Delta t$ 处求值。\n\n测试套件规范：\n实现所述的在线自适应 ROM 积分器，并针对以下三个测试案例运行它，每个案例由一个三元组 $(r_0, \\tau, r_{\\max})$ 指定：\n- 案例 A（正常路径）：$r_0 = 1$, $\\tau = 10^{-4}$, $r_{\\max} = 20$。\n- 案例 B（严格容差）：$r_0 = 2$, $\\tau = 10^{-5}$, $r_{\\max} = 25$。\n- 案例 C（紧容量边缘情况）：$r_0 = 3$, $\\tau = 10^{-6}$, $r_{\\max} = 8$。\n\n对于每个案例，报告：\n- 在完成所有 $K$ 个时间步并应用在线自适应规则后的最终降阶维度 $r_{\\text{final}}$。\n- 在所有被接受的时间步中，最大的可接受后验估计量 $\\max_{1 \\le k \\le K} \\|r(u_r^k)\\|_{B^{-1}}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序如下\n$$\n\\left[r_{\\text{final},A}, \\max\\_k \\|r(u_{r,A}^k)\\|_{B^{-1}}, r_{\\text{final},B}, \\max\\_k \\|r(u_{r,B}^k)\\|_{B^{-1}}, r_{\\text{final},C}, \\max\\_k \\|r(u_{r,C}^k)\\|_{B^{-1}}\\right],\n$$\n其中下标 $A,B,C$ 指代三个案例。每个 $r_{\\text{final}}$ 是一个整数，每个最大估计量值是一个浮点数。不需要物理单位。不使用角度。不使用百分比；所有量都应报告为原始数值。该行必须严格包含这六个值，顺序如此，不得有附加文本。\n\n你的实现必须是完全自包含和确定性的，仅使用指定的数值参数和所述的在线算法。数值线性代数部分必须能稳健地求解以 $B$ 为系数的线性系统。任何标准正交化都必须使用欧几里得内积。", "solution": "该问题要求为一个一维线性抛物型偏微分方程实现一个在线自适应降阶模型（ROM）。解决方案涉及两个主要阶段：首先是通过理论推导来证明误差控制策略的合理性，其次是数值算法的设计与实现。\n\n### 1. 后验误差估计量的推导\n\n时间相关问题使用后向欧拉法进行离散，导致在每个时间步 $k \\ge 1$ 需求解一个线性系统：\n$$ \\left(\\frac{1}{\\Delta t} I - \\nu L\\right) u^k = \\frac{1}{\\Delta t} u^{k-1} + s^k $$\n使用给定的定义 $A := -\\nu L$ 和 $B := \\frac{1}{\\Delta t} I + A$，全阶模型（FOM）方程可以简洁地写为：\n$$ B u^k = \\frac{1}{\\Delta t} u^{k-1} + s^k $$\n这里，$u^k \\in \\mathbb{R}^N$ 是在时间 $t_k$ 的 FOM 解。矩阵 $B$ 是对称正定（SPD）的，因为 $A$ 是 SPD（由于 $L$ 是负定的离散拉普拉斯算子且 $\\nu > 0$），并且 $\\frac{1}{\\Delta t}I$ 是一个正定对角矩阵。\n\nROM 解 $u_r^k$ 用于定义全阶残差向量 $r(u_r^k)$：\n$$ r(u_r^k) := \\frac{1}{\\Delta t} u_r^{k-1} + s^k - B u_r^k $$\n该残差量化了 ROM 解未能满足 FOM 方程的程度。\n\n为了将此残差与真实误差 $e^k := u^k - u_r^k$ 联系起来，我们推导误差演化方程。我们从 FOM 方程中减去整理后的残差定义，即 $\\frac{1}{\\Delta t} u_r^{k-1} + s^k = B u_r^k + r(u_r^k)$：\n$$ B u^k - (B u_r^k + r(u_r^k)) = \\frac{1}{\\Delta t} u^{k-1} - \\frac{1}{\\Delta t} u_r^{k-1} $$\n$$ B (u^k - u_r^k) - r(u_r^k) = \\frac{1}{\\Delta t} (u^{k-1} - u_r^{k-1}) $$\n$$ B e^k = \\frac{1}{\\Delta t} e^{k-1} + r(u_r^k) $$\n此方程将步骤 $k$ 的误差与前一步的误差 $e^{k-1}$ 以及当前步骤产生的残差联系起来。\n\n对于单步后验误差界，我们关心的是在步骤 $k$ *内部*产生的误差。通常通过假设上一步的解是精确的，即 $u_r^{k-1} = u^{k-1}$（这意味着 $e^{k-1} = 0$）来进行估计。在此假设下，误差方程简化为：\n$$ B e^k = r(u_r^k) \\implies e^k = B^{-1} r(u_r^k) $$\n为了度量这个误差，我们使用由 SPD 算子 $B$ 诱导的自然能量范数，定义为 $\\|x\\|_B := \\sqrt{x^T B x}$。误差的范数平方为：\n$$ \\|e^k\\|_B^2 = (e^k)^T B e^k = (B^{-1} r(u_r^k))^T B (B^{-1} r(u_r^k)) $$\n由于 $B$ 是对称的，其逆矩阵 $B^{-1}$ 也是对称的。因此，$(B^{-1} r(u_r^k))^T = r(u_r^k)^T (B^{-1})^T = r(u_r^k)^T B^{-1}$。将其代回，我们得到：\n$$ \\|e^k\\|_B^2 = r(u_r^k)^T B^{-1} B B^{-1} r(u_r^k) = r(u_r^k)^T B^{-1} r(u_r^k) $$\n这正是残差的对偶范数的平方，即 $\\|r(u_r^k)\\|_{B^{-1}}^2$。因此，我们建立了关键的恒等式：\n$$ \\|e^k\\|_B = \\|r(u_r^k)\\|_{B^{-1}} $$\n这个等式为使用可计算量 $\\|r(u_r^k)\\|_{B^{-1}}$ 作为在时间步 $k$ 引入的误差的后验估计量提供了理论依据。\n\n### 2. 算法设计与实现\n\n在线自适应算法执行一个时间步循环。在每个时间步内，一个内部循环执行基的自适应调整，直到误差估计量低于容差 $\\tau$ 或达到最大基规模 $r_{\\max}$。\n\n**初始化：**\n1.  **FOM 设置**：定义网格，即一个包含 $N$ 个内部点的均匀集合。构建有限差分拉普拉斯算子 $L$、矩阵 $A = -\\nu L$以及时间步进矩阵 $B = \\frac{1}{\\Delta t}I + A$。由于 $B$ 是常数且在每个自适应步骤中都用于求解，为了提高效率，我们在开始时一次性计算其 Cholesky 分解 $B = C^T C$。\n2.  **初始 ROM**：通过选取 $L$ 的前 $r_0$ 个离散正弦模态（它们是 $L$ 的特征向量）并将其标准正交化，来形成规模为 $r_0$ 的初始基 $V_{r_0}$。将初始条件 $u^0$ 投影到该基上以获得初始 ROM 状态 $u_r^0$。对于此问题，$u^0(x) = \\sin(\\pi x)$ 对应于第一个正弦模态，因此如果 $r_0 \\ge 1$，则投影是精确的，即 $u_r^0 = u^0$。\n\n**带在线自适应的时间积分（对每一步 $k=1, \\dots, K$）：**\n使用一个内部 `while` 循环来管理每个时间步 $k$ 的自适应过程。设 $u_r^{k-1}$ 是从上一步接受的 ROM 解。\n\n1.  **求解降阶系统**：\n    - 将算子 $A$ 投影到当前基 $V_r$ 上：$A_r = V_r^T A V_r$。\n    - 构建降阶系统矩阵 $B_r = \\frac{1}{\\Delta t} I_r + A_r$。\n    - 投影源项 $s^k$ 和前一解的贡献：$s_r^k = V_r^T s^k$ 以及系数向量 $a^{k-1} = V_r^T u_r^{k-1}$。\n    - 求解 $r \\times r$ 线性系统以得到新系数 $a^k$：$B_r a^k = \\frac{1}{\\Delta t} a^{k-1} + s_r^k$。\n    - 重构全空间 ROM 解：$u_r^k = V_r a^k$。\n\n2.  **计算误差估计量**：\n    - 计算全阶残差：$r_k = \\frac{1}{\\Delta t} u_r^{k-1} + s^k - B u_r^k$。\n    - 为了计算估计量 $\\eta_k = \\|r_k\\|_{B^{-1}} = \\sqrt{r_k^T B^{-1} r_k}$，我们首先求解 $N \\times N$ 系统 $B z_k = r_k$ 以得到 $z_k = B^{-1} r_k$。这可以通过使用预先计算的 $B$ 的 Cholesky 分解来高效完成。\n    - 于是估计量为 $\\eta_k = \\sqrt{r_k^T z_k}$。\n\n3.  **决策与自适应**：\n    - **接受**：如果 $\\eta_k \\le \\tau$ 或基的规模已达到其上限 ($r \\ge r_{\\max}$)，则接受解 $u_r^k$。这个 $u_r^k$ 将成为下一个时间步的 $u_r^{k-1}$，并且内部循环终止。$\\eta_k$ 的值被记录为此时间步的可接受估计量。\n    - **拒绝与富集**：如果 $\\eta_k > \\tau$ 且 $r < r_{\\max}$，则拒绝该解，并对基进行富集。\n        - 富集向量选为 $w_k = z_k = B^{-1} r_k$，即残差的 Riesz 表示。已知该方向对于减小误差是有效的。\n        - 使用欧几里得内积（Gram-Schmidt 过程）将 $w_k$ 与当前基的列向量 $V_r$ 进行正交化：$\\tilde{w}_k = w_k - V_r(V_r^T w_k)$。\n        - 将得到的向量 $\\tilde{w}_k$ 归一化以产生 $\\hat{w}_k$。\n        - 扩充基：$V_{r+1} = [V_r, \\hat{w}_k]$。\n        - 内部循环在同一时间步 $k$ 使用更大的基从步骤 1 继续。\n\n此过程重复进行，直到为所有 $K$ 个时间步都找到满意的解。对于每个测试案例，报告最终的基规模以及所有可接受估计量值的最大值。", "answer": "[6,9.99847118181313e-05,8,9.948293933945415e-06,8,1.1341029272300435e-06]", "id": "3435653"}]}