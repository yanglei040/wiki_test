{"hands_on_practices": [{"introduction": "随机 Galerkin 方法将一个随机偏微分方程转化为一个大型的确定性方程组。这个转化过程的核心在于计算耦合系数，即所谓的“三项积”(triple-product)张量。本练习将通过正交多项式的递推关系，带你亲手计算这些基本数值，从而掌握随机 Galerkin 系统构建的基石。[@problem_id:3432918]", "problem": "考虑一维高斯随机变量 $X \\sim \\mathcal{N}(0,1)$ 及其相关的标准正交概率学家埃尔米特多项式基 $\\{h_{n}(x)\\}_{n \\ge 0}$，其定义为 $h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$，其中 $\\mathrm{He}_{n}$ 是概率学家埃尔米特多项式，其标准正交性是相对于标准正态密度 $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$ 而言的。其标准正交性和三项递推关系为\n- $\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$，\n- 对于所有 $n \\ge 0$，$x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$，并约定 $h_{-1} \\equiv 0$。\n\n定义三重积张量项\n$$\nG_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big], \\quad i,j,k \\in \\mathbb{N}_{0}.\n$$\n这些项出现在具有仿射高斯输入的线性椭圆型随机偏微分方程的多项式混沌展开 (PCE) 离散化的随机伽辽金 (SG) 投影的系数耦合中。\n\n仅使用标准正交性、三项递推关系和埃尔米特多项式的标准性质，显式确定当 $i,j,k \\in \\{0,1,2,3\\}$ 时 $G_{ijk}$ 的所有非零值。然后，使用这些值计算所得 $4 \\times 4 \\times 4$ 子张量的弗罗贝尼乌斯范数的平方，\n$$\nS \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}.\n$$\n请以单个实数的形式提供最终答案。无需四舍五入。", "solution": "用户希望我验证并解决一个定量问题。\n\n### 第1步：提取已知条件\n-   **随机变量**：$X \\sim \\mathcal{N}(0,1)$，一个标准一维高斯随机变量。\n-   **基**：标准正交概率学家埃尔米特多项式基 $\\{h_{n}(x)\\}_{n \\ge 0}$。\n-   **基的定义**：$h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$，其中 $\\mathrm{He}_{n}$ 是概率学家埃尔米特多项式。\n-   **权重函数**：正交性是相对于标准正态密度 $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$。\n-   **标准正交关系**：$\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$，其中 $\\mathbb{E}[\\cdot]$ 是关于 $X$ 的期望，$\\delta_{mn}$ 是克罗内克δ函数。\n-   **三项递推关系**：对于所有 $n \\ge 0$，$x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$，并约定 $h_{-1}(x) \\equiv 0$。\n-   **目标对象**：三重积张量项 $G_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big]$，其中 $i,j,k \\in \\mathbb{N}_{0}$。\n-   **任务**：\n    1.  确定当索引 $i,j,k \\in \\{0,1,2,3\\}$ 时 $G_{ijk}$ 的所有非零值。\n    2.  计算所得 $4 \\times 4 \\times 4$ 子张量的弗罗贝尼乌斯范数的平方，定义为 $S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于正交多项式理论，特别是埃尔米特多项式及其在通过多项式混沌展开 (PCE) 进行不确定性量化中的应用。所提供的定义和关系（标准正交性、递推关系）对于概率学家埃尔米特多项式是标准且正确的。该问题在科学和数学上是合理的。\n2.  **良定性**：问题定义清晰。它要求计算特定的张量项以及随后的求和。所提供的信息足以确定一个唯一的、有意义的解。\n3.  **客观性**：问题以精确、正式的语言陈述，没有任何主观性或歧义。\n4.  **缺陷分析**：\n    -   没有违反科学原理。\n    -   问题与指定主题直接相关，是实施随机伽辽金方法的核心计算。\n    -   设置是完整且一致的。例如，对于 $n=0$，递推关系给出 $x h_0(x) = \\sqrt{1} h_1(x)$。根据标准正交性，$\\mathbb{E}[h_0(X)^2]=1$，这意味着 $h_0(x)=1$，因为它是一个0次多项式。因此，$h_1(x) = x$，这对于概率学家埃尔米特多项式是正确的。\n    -   计算过程虽然繁琐，但完全可行且是标准的。\n    -   问题结构合理，能够导出一个唯一的答案。\n\n### 第3步：结论与行动\n问题是有效的。我现在将进行完整的解答。\n\n问题要求计算三重积张量项的平方和，$S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$。这些项定义为 $G_{ijk} = \\mathbb{E}[h_i(X)h_j(X)h_k(X)]$。期望是关于标准正态测度的积分：\n$$\nG_{ijk} = \\int_{-\\infty}^{\\infty} h_i(x)h_j(x)h_k(x) \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) dx.\n$$\n由于乘法是可交换的，张量 $G_{ijk}$ 关于其索引 $(i,j,k)$ 的任何排列都是对称的。\n\n我们可以利用所提供的多项式三项递推关系来推导 $G_{ijk}$ 的递推关系。不失一般性，我们假设 $k \\ge 1$。可以重新排列递推关系来表示 $h_k(x)$：\n$$\nh_k(x) = \\frac{1}{\\sqrt{k}} \\left( x h_{k-1}(x) - \\sqrt{k-1} h_{k-2}(x) \\right), \\quad k \\ge 1.\n$$\n将此代入 $G_{ijk}$ 的定义中：\n$$\nG_{ijk} = \\mathbb{E}\\left[h_i(X) h_j(X) \\frac{1}{\\sqrt{k}} \\left( X h_{k-1}(X) - \\sqrt{k-1} h_{k-2}(X) \\right)\\right].\n$$\n$$\nG_{ijk} = \\frac{1}{\\sqrt{k}} \\mathbb{E}\\left[X h_i(X) h_j(X) h_{k-1}(X)\\right] - \\sqrt{\\frac{k-1}{k}} \\mathbb{E}\\left[h_i(X) h_j(X) h_{k-2}(X)\\right].\n$$\n第二项是 $-\\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}$。对于第一项，我们使用乘 $x$ 算子在相关的希尔伯特空间中是自伴的这一性质。因此 $\\mathbb{E}[f(X) g(X) X h(X)] = \\mathbb{E}[(X f(X)) g(X) h(X)]$。我们将递推关系应用于 $X h_i(X)$：\n$$\nX h_i(X) = \\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X).\n$$\n将此代入第一项的期望中：\n$$\n\\mathbb{E}\\left[(\\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X)) h_j(X) h_{k-1}(X)\\right] = \\sqrt{i+1} G_{i+1,j,k-1} + \\sqrt{i} G_{i-1,j,k-1}.\n$$\n结合这些结果，得到 $G_{ijk}$ 的递推关系（假设 $k \\ge 1$）：\n$$\nG_{ijk} = \\frac{\\sqrt{i+1}}{\\sqrt{k}} G_{i+1,j,k-1} + \\frac{\\sqrt{i}}{\\sqrt{k}} G_{i-1,j,k-1} - \\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}.\n$$\n递推的基例是 $k=0$。根据定义，$h_0(x)=1$。\n$$\nG_{ij0} = \\mathbb{E}[h_i(X)h_j(X)h_0(X)] = \\mathbb{E}[h_i(X)h_j(X)] = \\delta_{ij}.\n$$\n我们现在计算 $i,j,k \\in \\{0,1,2,3\\}$ 所需的非零项。由于对称性，我们只需要计算 $i \\le j \\le k$ 的情况。\n\n**k=0 的情况：**\n$G_{ij0} = \\delta_{ij}$。唯一的非零值（在排列意义下）是：\n- $G_{000} = \\delta_{00} = 1$。\n- $G_{110} = \\delta_{11} = 1$。\n- $G_{220} = \\delta_{22} = 1$。\n- $G_{330} = \\delta_{33} = 1$。\n\n**k=1 的情况：**\n对于 $k=1$，递推关系简化为：\n$G_{ij1} = \\sqrt{i+1} G_{i+1,j,0} + \\sqrt{i} G_{i-1,j,0} = \\sqrt{i+1} \\delta_{i+1,j} + \\sqrt{i} \\delta_{i-1,j}$。\n这仅在 $j=i+1$ 或 $j=i-1$ 时非零。对于 $i \\le j$，我们只需要考虑 $j=i+1$。\n- $G_{011} = \\sqrt{0+1} \\delta_{1,1} + 0 = 1$。\n- $G_{121} = \\sqrt{1+1} \\delta_{2,2} + \\sqrt{1} \\delta_{0,2} = \\sqrt{2}$。（根据对称性，这也是 $G_{112}$）。\n- $G_{231} = \\sqrt{2+1} \\delta_{3,3} + \\sqrt{2} \\delta_{1,3} = \\sqrt{3}$。（根据对称性，这也是 $G_{123}, G_{132}$ 等）。\n一个关键性质是，只有当 $i+j+k$ 为偶数时，$G_{ijk}$ 才非零。这是因为埃尔米特多项式的奇偶性与其次数相同，而奇函数在对称区间上的积分为零。所有索引和为奇数的 $G_{ijk}$ 均为零（例如，$G_{111}=0, G_{122}=0$）。\n\n**k=2 的情况：**\n$G_{ij2} = \\frac{1}{\\sqrt{2}}(\\sqrt{i+1} G_{i+1, j, 1} + \\sqrt{i} G_{i-1, j, 1} - G_{ij0})$。\n- $G_{022} = \\frac{1}{\\sqrt{2}}(\\sqrt{1} G_{121} - G_{020}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2} - 0) = 1$。\n- $G_{112} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{211} + \\sqrt{1} G_{011} - G_{110}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{2}) + 1 - 1) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$。\n- $G_{132} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{231} + \\sqrt{1} G_{031} - G_{130}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{3}) + 0 - 0) = \\sqrt{3}$。\n- $G_{222} = \\frac{1}{\\sqrt{2}}(\\sqrt{3} G_{321} + \\sqrt{2} G_{121} - G_{220}) = \\frac{1}{\\sqrt{2}}(\\sqrt{3}(\\sqrt{3}) + \\sqrt{2}(\\sqrt{2}) - 1) = \\frac{3+2-1}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$。\n- $G_{332} = \\frac{1}{\\sqrt{2}}(\\sqrt{4} G_{431} + \\sqrt{3} G_{231} - G_{330})$。我们需要 $G_{431} = \\sqrt{3+1}\\delta_{44} + \\sqrt{3}\\delta_{24} = 2$。\n  $G_{332} = \\frac{1}{\\sqrt{2}}(2(2) + \\sqrt{3}(\\sqrt{3}) - 1) = \\frac{4+3-1}{\\sqrt{2}} = \\frac{6}{\\sqrt{2}} = 3\\sqrt{2}$。\n\n**k=3 的情况：**\n$G_{ij3} = \\frac{1}{\\sqrt{3}}(\\sqrt{i+1} G_{i+1, j, 2} + \\sqrt{i} G_{i-1, j, 2} - \\sqrt{2} G_{ij1})$。\n- $G_{033} = \\frac{1}{\\sqrt{3}}(\\sqrt{1} G_{132} - \\sqrt{2} G_{031}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3} - 0) = 1$。\n- $G_{123} = \\frac{1}{\\sqrt{3}}(\\sqrt{2} G_{222} + \\sqrt{1} G_{022} - \\sqrt{2} G_{121}) = \\frac{1}{\\sqrt{3}}(\\sqrt{2}(2\\sqrt{2}) + 1 - \\sqrt{2}(\\sqrt{2})) = \\frac{4+1-2}{\\sqrt{3}} = \\frac{3}{\\sqrt{3}} = \\sqrt{3}$。\n- $G_{233} = \\frac{1}{\\sqrt{3}}(\\sqrt{3} G_{332} + \\sqrt{2} G_{132} - \\sqrt{2} G_{231}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3}(3\\sqrt{2}) + \\sqrt{2}(\\sqrt{3}) - \\sqrt{2}(\\sqrt{3})) = \\frac{3\\sqrt{6}}{\\sqrt{3}} = 3\\sqrt{2}$。\n\n**非零 $G_{ijk}$ 值及其平方大小的总结：**\n非零值出现在特定的索引组合中。我们列出唯一的值（在排列意义下）、它们的平方值以及它们索引的不同排列数。\n- 索引 $\\{0,0,0\\}$: $G_{000}=1$。$G_{000}^2 = 1$。有 $1$ 个排列。对总和的贡献：$1 \\times 1 = 1$。\n- 索引 $\\{0,1,1\\}$: $G_{011}=1$。$G_{011}^2 = 1$。有 $3$ 个排列：$(0,1,1), (1,0,1), (1,1,0)$。贡献：$3 \\times 1 = 3$。\n- 索引 $\\{0,2,2\\}$: $G_{022}=1$。$G_{022}^2 = 1$。有 $3$ 个排列。贡献：$3 \\times 1 = 3$。\n- 索引 $\\{0,3,3\\}$: $G_{033}=1$。$G_{033}^2 = 1$。有 $3$ 个排列。贡献：$3 \\times 1 = 3$。\n- 索引 $\\{1,1,2\\}$: $G_{112}=\\sqrt{2}$。$G_{112}^2 = 2$。有 $3$ 个排列。贡献：$3 \\times 2 = 6$。\n- 索引 $\\{1,2,3\\}$: $G_{123}=\\sqrt{3}$。$G_{123}^2 = 3$。由于所有索引都不同，有 $3! = 6$ 个排列。贡献：$6 \\times 3 = 18$。\n- 索引 $\\{2,2,2\\}$: $G_{222}=2\\sqrt{2}$。$G_{222}^2 = 8$。有 $1$ 个排列。贡献：$1 \\times 8 = 8$。\n- 索引 $\\{2,3,3\\}$: $G_{233}=3\\sqrt{2}$。$G_{233}^2 = 18$。有 $3$ 个排列。贡献：$3 \\times 18 = 54$。\n\n所有其他 $i,j,k \\in \\{0,1,2,3\\}$ 的 $G_{ijk}$ 均为零，原因要么是奇偶性规则（索引和为奇数），要么是三角不等式选择规则（这已由递推关系隐式处理）。\n\n**S 的最终计算：**\n我们将所有非零项的贡献相加：\n$$\nS = \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2} = 1 + 3 + 3 + 3 + 6 + 18 + 8 + 54.\n$$\n$$\nS = 10 + 6 + 18 + 8 + 54 = 16 + 18 + 8 + 54 = 34 + 8 + 54 = 42 + 54 = 96.\n$$\n该子张量的弗罗贝尼乌斯范数的平方是 $96$。", "answer": "$$\n\\boxed{96}\n$$", "id": "3432918"}, {"introduction": "在计算了基本的三项积之后，我们将处理一个更具一般性的情况：为一个具有仿射随机系数的偏微分方程组建系统矩阵。这需要计算形如 $\\mathbb{E}[\\xi_i \\Psi_{\\boldsymbol{\\alpha}} \\Psi_{\\boldsymbol{\\beta}}]$ 的期望值，它们定义了“随机耦合”矩阵。这个练习将帮助你打通从抽象的多项式混沌展开到具体待解线性系统之间的关键环节。[@problem_id:3432950]", "problem": "考虑一个带随机扩散系数的线性椭圆偏微分方程，其形式为 $-\\nabla \\cdot \\left(a(x,\\boldsymbol{\\xi}) \\nabla u(x,\\boldsymbol{\\xi})\\right) = f(x)$，定义在一个有界Lipschitz域上，其中随机性通过截断的Karhunen–Loève展开（KLE）引入。Karhunen–Loève展开是二阶随机场的一种表示，它表示为由不相关随机变量调制的正交空间模态的可数和。假设截断产生两个独立的标准正态随机变量 $\\boldsymbol{\\xi} = (\\xi_{1},\\xi_{2})$ 和一个仿射参数化 $a(x,\\boldsymbol{\\xi}) = a_{0}(x) + a_{1}(x)\\,\\xi_{1} + a_{2}(x)\\,\\xi_{2}$。在随机Galerkin（sG）方法中，我们在由多元多项式混沌（PC）基函数张成的有限维张量空间中求解 $u(x,\\boldsymbol{\\xi})$。\n\n使用以下基本事实：\n- 当基础场是高斯且中心化时，Karhunen–Loève展开（KLE）产生相互独立的标准正态变量。\n- 对于标准正态测度，概率论学家的Hermite多项式 $\\mathrm{He}_{n}(\\xi)$ 满足 $\\mathbb{E}\\left[\\mathrm{He}_{m}(\\xi)\\,\\mathrm{He}_{n}(\\xi)\\right] = n!\\,\\delta_{mn}$，以及递推关系 $\\xi\\,\\mathrm{He}_{n}(\\xi) = \\mathrm{He}_{n+1}(\\xi) + n\\,\\mathrm{He}_{n-1}(\\xi)$。\n- 高斯输入的多元PC基是由关于高斯测度的一维正交归一Hermite多项式的张量积构成的。\n\n任务：\n1. 仅使用上述核心定义，将KLE变量 $\\xi_{i}$ 映射到由多重指标 $\\boldsymbol{\\alpha} = (\\alpha_{1},\\alpha_{2}) \\in \\mathbb{N}_{0}^{2}$ 索引的多元正交归一多项式混沌基 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$。从一维分量显式构造 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$，并证明其相对于联合标准正态测度的正交归一性。\n2. 从基的正交归一性和Hermite递推关系出发，推导在sG组装中仿射系数所需的随机耦合矩阵的通用闭式表达式：\n   - 格拉姆矩阵 $G^{(0)}$，其元素为 $G^{(0)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right]$。\n   - 仿射耦合矩阵 $G^{(i)}$，其元素为 $G^{(i)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\xi_{i}\\,\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right]$，对于 $i \\in \\{1,2\\}$。\n3. 考虑二维总次数为2的截断多元PC空间，其指标集为 $\\mathcal{A} = \\{(0,0),(1,0),(0,1),(2,0),(1,1),(0,2)\\}$。使用您的通用表达式，精确计算单个耦合项 $G^{(1)}_{(2,0),(1,0)}$。您的最终答案必须是单一的闭式解析表达式。无需四舍五入，不涉及单位。", "solution": "该问题是有效的，因为它在科学上基于带随机输入的偏微分方程数值方法理论，特别是使用多项式混沌展开的随机Galerkin方法。该问题是适定的、客观的，并提供了推导所求量所需的所有定义和关系。我们开始解答。\n\n根据任务要求，解答分为三个部分。\n\n1.  **多元正交归一多项式混沌基的构造**\n\n问题给出了概率论学家的Hermite多项式 $\\mathrm{He}_{n}(\\xi)$ 关于标准正态测度（其中 $\\xi \\sim \\mathcal{N}(0,1)$）的正交关系：\n$$\n\\mathbb{E}\\left[\\mathrm{He}_{m}(\\xi)\\,\\mathrm{He}_{n}(\\xi)\\right] = n!\\,\\delta_{mn}\n$$\n这里，$\\mathbb{E}[\\cdot]$ 表示期望算子，$\\delta_{mn}$ 是Kronecker delta。基多项式是正交的但非正交归一的，因为它们的平方范数为 $\\mathbb{E}\\left[\\mathrm{He}_{n}(\\xi)^{2}\\right] = n!$。\n\n为构造一维正交归一基，我们对每个多项式进行归一化。设一维正交归一基函数为 $\\psi_{n}(\\xi)$。我们将其定义为：\n$$\n\\psi_{n}(\\xi) = \\frac{1}{\\sqrt{n!}}\\,\\mathrm{He}_{n}(\\xi)\n$$\n该基的正交归一性通过计算它们乘积的期望来验证：\n$$\n\\mathbb{E}\\left[\\psi_{m}(\\xi)\\,\\psi_{n}(\\xi)\\right] = \\mathbb{E}\\left[\\left(\\frac{1}{\\sqrt{m!}}\\,\\mathrm{He}_{m}(\\xi)\\right)\\left(\\frac{1}{\\sqrt{n!}}\\,\\mathrm{He}_{n}(\\xi)\\right)\\right] = \\frac{1}{\\sqrt{m!n!}}\\,\\mathbb{E}\\left[\\mathrm{He}_{m}(\\xi)\\,\\mathrm{He}_{n}(\\xi)\\right] = \\frac{1}{\\sqrt{m!n!}}\\,n!\\,\\delta_{mn} = \\delta_{mn}\n$$\n这证实了集合 $\\{\\psi_{n}(\\xi)\\}_{n \\in \\mathbb{N}_{0}}$ 相对于标准正态测度是正交归一的。\n\n问题指定了一个二维随机向量 $\\boldsymbol{\\xi} = (\\xi_{1}, \\xi_{2})$，其分量是独立的标准正态变量。对于多重指标 $\\boldsymbol{\\alpha} = (\\alpha_{1}, \\alpha_{2}) \\in \\mathbb{N}_{0}^{2}$，多元多项式混沌（PC）基 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$ 由一维正交归一基函数的张量积构成：\n$$\n\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) = \\Psi_{(\\alpha_{1}, \\alpha_{2})}(\\xi_{1}, \\xi_{2}) = \\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\alpha_{2}}(\\xi_{2})\n$$\n为证明该多元基的正交归一性，我们计算两个基函数 $\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$ 和 $\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})$ 乘积的期望，其中多重指标为 $\\boldsymbol{\\alpha} = (\\alpha_{1}, \\alpha_{2})$ 和 $\\boldsymbol{\\beta} = (\\beta_{1}, \\beta_{2})$。由于独立性，$\\boldsymbol{\\xi}$ 的联合概率密度函数是各个标准正态密度的乘积。因此，期望积分可以分离：\n$$\n\\mathbb{E}\\left[\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right] = \\mathbb{E}\\left[\\left(\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\alpha_{2}}(\\xi_{2})\\right)\\left(\\psi_{\\beta_{1}}(\\xi_{1})\\,\\psi_{\\beta_{2}}(\\xi_{2})\\right)\\right]\n$$\n$$\n= \\mathbb{E}\\left[\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\,\\psi_{\\alpha_{2}}(\\xi_{2})\\,\\psi_{\\beta_{2}}(\\xi_{2})\\right]\n$$\n由于 $\\xi_{1}$ 和 $\\xi_{2}$ 的独立性，乘积的期望等于期望的乘积：\n$$\n= \\mathbb{E}\\left[\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\right] \\, \\mathbb{E}\\left[\\psi_{\\alpha_{2}}(\\xi_{2})\\,\\psi_{\\beta_{2}}(\\xi_{2})\\right]\n$$\n利用一维正交归一性 $\\mathbb{E}\\left[\\psi_{m}(\\xi)\\,\\psi_{n}(\\xi)\\right] = \\delta_{mn}$，我们得到：\n$$\n= \\delta_{\\alpha_{1}\\beta_{1}}\\,\\delta_{\\alpha_{2}\\beta_{2}} = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}\n$$\n其中 $\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 是多元Kronecker delta，当 $\\boldsymbol{\\alpha} = \\boldsymbol{\\beta}$（即 $\\alpha_{1}=\\beta_{1}$ 且 $\\alpha_{2}=\\beta_{2}$）时为1，否则为0。这证实了多元基 $\\{\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\}_{\\boldsymbol{\\alpha} \\in \\mathbb{N}_{0}^{2}}$ 相对于 $\\mathbb{R}^{2}$ 上的联合标准正态测度是正交归一的。\n\n2.  **随机耦合矩阵的推导**\n\n矩阵 $G^{(0)}$ 和 $G^{(i)}$ 对于在随机Galerkin方法中组装线性系统至关重要。\n\n格拉姆矩阵 $G^{(0)}$ 的元素由 $G^{(0)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right]$ 给出。如前一节所示，这正是基函数的正交归一性条件。因此，其元素由多元Kronecker delta给出：\n$$\nG^{(0)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}\n$$\n这意味着格拉姆矩阵 $G^{(0)}$ 是单位矩阵。\n\n仿射耦合矩阵 $G^{(i)}$ 的元素由 $G^{(i)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\xi_{i}\\,\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right]$ 给出，对于 $i \\in \\{1,2\\}$。我们来推导 $G^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 的表达式：\n$$\nG^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\xi_{1}\\,\\Psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\,\\Psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})\\right] = \\mathbb{E}\\left[\\xi_{1}\\,\\psi_{\\alpha_{1}}(\\xi_{1})\\psi_{\\alpha_{2}}(\\xi_{2})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\psi_{\\beta_{2}}(\\xi_{2})\\right]\n$$\n按变量分组并利用独立性：\n$$\nG^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\mathbb{E}\\left[\\xi_{1}\\,\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\right] \\, \\mathbb{E}\\left[\\psi_{\\alpha_{2}}(\\xi_{2})\\,\\psi_{\\beta_{2}}(\\xi_{2})\\right]\n$$\n第二项就是 $\\delta_{\\alpha_{2}\\beta_{2}}$。对于第一项，我们代入 $\\psi_{n}$ 的定义并使用给定的 $\\mathrm{He}_{n}$ 的递推关系：$\\xi\\,\\mathrm{He}_{n}(\\xi) = \\mathrm{He}_{n+1}(\\xi) + n\\,\\mathrm{He}_{n-1}(\\xi)$。\n$$\n\\mathbb{E}\\left[\\xi_{1}\\,\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\right] = \\frac{1}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\mathbb{E}\\left[\\xi_{1}\\,\\mathrm{He}_{\\alpha_{1}}(\\xi_{1})\\,\\mathrm{He}_{\\beta_{1}}(\\xi_{1})\\right]\n$$\n$$\n= \\frac{1}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\mathbb{E}\\left[\\left(\\mathrm{He}_{\\alpha_{1}+1}(\\xi_{1}) + \\alpha_{1}\\,\\mathrm{He}_{\\alpha_{1}-1}(\\xi_{1})\\right)\\,\\mathrm{He}_{\\beta_{1}}(\\xi_{1})\\right]\n$$\n根据期望的线性和 $\\mathrm{He}_n$ 的正交性：\n$$\n= \\frac{1}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\left(\\mathbb{E}\\left[\\mathrm{He}_{\\alpha_{1}+1}(\\xi_{1})\\,\\mathrm{He}_{\\beta_{1}}(\\xi_{1})\\right] + \\alpha_{1}\\mathbb{E}\\left[\\mathrm{He}_{\\alpha_{1}-1}(\\xi_{1})\\,\\mathrm{He}_{\\beta_{1}}(\\xi_{1})\\right]\\right)\n$$\n$$\n= \\frac{1}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\left((\\alpha_{1}+1)!\\,\\delta_{\\beta_{1}, \\alpha_{1}+1} + \\alpha_{1}\\,(\\alpha_{1}-1)!\\,\\delta_{\\beta_{1}, \\alpha_{1}-1}\\right)\n$$\n由于 $\\alpha_{1}(\\alpha_{1}-1)! = \\alpha_{1}!$：\n$$\n= \\frac{(\\alpha_{1}+1)!}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\delta_{\\beta_{1}, \\alpha_{1}+1} + \\frac{\\alpha_{1}!}{\\sqrt{\\alpha_{1}!\\,\\beta_{1}!}}\\,\\delta_{\\beta_{1}, \\alpha_{1}-1}\n$$\n该表达式仅在 $\\beta_{1} = \\alpha_{1}+1$ 或 $\\beta_{1} = \\alpha_{1}-1$ 时非零。\n如果 $\\beta_{1} = \\alpha_{1}+1$：表达式变为 $\\frac{(\\alpha_{1}+1)!}{\\sqrt{\\alpha_{1}!\\,(\\alpha_{1}+1)!}} = \\sqrt{\\alpha_{1}+1}$。\n如果 $\\beta_{1} = \\alpha_{1}-1$：表达式变为 $\\frac{\\alpha_{1}!}{\\sqrt{\\alpha_{1}!\\,(\\alpha_{1}-1)!}} = \\sqrt{\\alpha_{1}}$。\n因此，我们可以将第一项写为：\n$$\n\\mathbb{E}\\left[\\xi_{1}\\,\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\beta_{1}}(\\xi_{1})\\right] = \\sqrt{\\alpha_{1}+1}\\,\\delta_{\\beta_{1}, \\alpha_{1}+1} + \\sqrt{\\alpha_{1}}\\,\\delta_{\\beta_{1}, \\alpha_{1}-1}\n$$\n将此与项 $\\delta_{\\alpha_{2}\\beta_{2}}$ 结合，得到 $G^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 的通用表达式为：\n$$\nG^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\left(\\sqrt{\\alpha_{1}+1}\\,\\delta_{\\beta_{1}, \\alpha_{1}+1} + \\sqrt{\\alpha_{1}}\\,\\delta_{\\beta_{1}, \\alpha_{1}-1}\\right)\\,\\delta_{\\alpha_{2}\\beta_{2}}\n$$\n通过对称性，通过交换索引1和2的角色可以得到 $G^{(2)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 的表达式：\n$$\nG^{(2)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\left(\\sqrt{\\alpha_{2}+1}\\,\\delta_{\\beta_{2}, \\alpha_{2}+1} + \\sqrt{\\alpha_{2}}\\,\\delta_{\\beta_{2}, \\alpha_{2}-1}\\right)\\,\\delta_{\\alpha_{1}\\beta_{1}}\n$$\n\n3.  **特定耦合项的计算**\n\n我们被要求计算项 $G^{(1)}_{(2,0),(1,0)}$。这对应于将多重指标设置为 $\\boldsymbol{\\alpha} = (2,0)$ 和 $\\boldsymbol{\\beta} = (1,0)$。因此，我们有 $\\alpha_{1}=2$，$\\alpha_{2}=0$，$\\beta_{1}=1$，和 $\\beta_{2}=0$。\n\n我们使用推导出的 $G^{(1)}_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$ 的表达式：\n$$\nG^{(1)}_{(2,0),(1,0)} = \\left(\\sqrt{2+1}\\,\\delta_{1, 2+1} + \\sqrt{2}\\,\\delta_{1, 2-1}\\right)\\,\\delta_{0,0}\n$$\n现在我们计算Kronecker delta：\n- $\\delta_{1, 2+1} = \\delta_{1,3} = 0$。\n- $\\delta_{1, 2-1} = \\delta_{1,1} = 1$。\n- $\\delta_{0,0} = 1$。\n\n将这些值代入表达式中：\n$$\nG^{(1)}_{(2,0),(1,0)} = \\left(\\sqrt{3} \\cdot 0 + \\sqrt{2} \\cdot 1\\right) \\cdot 1\n$$\n$$\nG^{(1)}_{(2,0),(1,0)} = \\left(0 + \\sqrt{2}\\right) \\cdot 1 = \\sqrt{2}\n$$\n该耦合项的精确值为 $\\sqrt{2}$。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "3432950"}, {"introduction": "在实际应用中，对所有随机维度使用固定的多项式阶数往往效率低下。这个综合性练习将要求你实现一个完整的自适应随机 Galerkin 求解器。你将通过开发一个基于残差的后验误差估计器来指导多项式阶数的自适应加密，从而在保证精度的同时实现计算效率的最大化。[@problem_id:3432978]", "problem": "考虑在空间域 $[0,1]$ 上具有齐次 Dirichlet 边界条件的一维非均匀扩散模型。设不确定扩散系数定义为 $a(x,\\xi) = a_0(x) + a_1(x)\\,\\xi$，其中 $\\xi$ 是一个在 $[-1,1]$ 上均匀分布的单个随机变量，并且对于给定的振幅参数 $\\epsilon \\in (0,1]$，$a_0(x) = 1 + 0.5\\sin(2\\pi x)$，$a_1(x) = \\epsilon\\cdot 0.3\\cos(2\\pi x)$。强迫项为 $f(x) \\equiv 1$，边界条件为 $u(0,\\xi) = 0$ 和 $u(1,\\xi) = 0$。\n\n目标是在随机 Galerkin (SG) 框架下，使用形式为\n$$\nu(x,\\xi) \\approx \\sum_{n=0}^{p} u_n(x)\\,\\Phi_n(\\xi)\n$$\n的多项式混沌展开 (PCE) 来求解该随机偏微分方程 (PDE)，\n其中 $\\{\\Phi_n(\\xi)\\}_{n\\ge 0}$ 是关于权重 $w(\\xi) = \\tfrac{1}{2}$ 在 $[-1,1]$ 上的正交归一 Legendre 多项式。定义 $\\Phi_n(\\xi) = \\sqrt{2n+1}\\,P_n(\\xi)$，其中 $P_n(\\xi)$ 是第 $n$ 个（未归一化的）Legendre 多项式，满足 $\\int_{-1}^{1} P_n(\\xi)P_m(\\xi)\\,d\\xi = \\frac{2}{2n+1}\\delta_{nm}$。在此归一化下，正交归一性为 $\\int_{-1}^{1} \\Phi_n(\\xi)\\Phi_m(\\xi)\\,w(\\xi)\\,d\\xi = \\delta_{nm}$。\n\n使用测试函数 $v_m(x)\\Phi_m(\\xi)$ 的 SG 弱形式，得到一个关于系数函数 $u_n(x)$ 的分块系统：\n$$\n\\sum_{n=0}^{p} \\left( \\int_{-1}^{1} \\Phi_n(\\xi)\\Phi_m(\\xi)\\,w(\\xi)\\,d\\xi \\right) \\int_0^1 a_0(x)\\,u_n'(x)\\,v_m'(x)\\,dx\n+\n\\sum_{n=0}^{p} \\left( \\int_{-1}^{1} \\xi\\,\\Phi_n(\\xi)\\Phi_m(\\xi)\\,w(\\xi)\\,d\\xi \\right) \\int_0^1 a_1(x)\\,u_n'(x)\\,v_m'(x)\\,dx\n=\n\\delta_{m0}\\int_0^1 f(x)\\,v_m(x)\\,dx.\n$$\n令 $T$ 为在正交归一基中由与 $\\xi$ 相乘所导出的耦合矩阵，它由著名的三项递推关系给出\n$$\n\\xi\\,\\Phi_n(\\xi) = \\alpha_n\\,\\Phi_{n+1}(\\xi) + \\beta_n\\,\\Phi_{n-1}(\\xi),\n\\quad\n\\alpha_n = \\frac{n+1}{\\sqrt{(2n+1)(2n+3)}},\n\\quad\n\\beta_n = \\frac{n}{\\sqrt{(2n+1)(2n-1)}},\n$$\n并约定 $\\Phi_{-1} \\equiv 0$。则 $T \\in \\mathbb{R}^{(p+1)\\times(p+1)}$ 是一个三对角矩阵，其元素为 $T_{n,n+1} = \\alpha_n$，$T_{n,n-1} = \\beta_n$，并且是对称的。\n\n在空间上，使用协调的一阶有限元 (FE) 方法，在一个具有 $N$ 个等尺寸单元的均匀网格上，应用通常的分段线性基。令 $K_0 \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ 和 $K_1 \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ 分别表示使用 $a_0(x)$ 和 $a_1(x)$ 组装的 FE 刚度矩阵，并令 $F_0 \\in \\mathbb{R}^{(N-1)}$ 为对应于 $f(x) \\equiv 1$ 的 FE 载荷向量。系数向量 $U = [u_0;u_1;\\dots;u_p] \\in \\mathbb{R}^{(p+1)(N-1)}$ 的 SG 线性系统为\n$$\n\\left( I_{p+1} \\otimes K_0 + T \\otimes K_1 \\right) U = \\left[ F_0; 0; \\dots; 0 \\right],\n$$\n其中 $\\otimes$ 表示 Kronecker 积，$I_{p+1}$ 是尺寸为 $p+1$ 的单位矩阵。\n\n开发一个基于残差的后验误差估计器，该估计器针对随机截断误差，并驱动自适应多项式阶数细化。使用第一个被忽略的模态 $u_{p+1}$ 的分层残差方程，该方程通过在 $m=p+1$ 阶上用截断的 PCE（其中 $u_{p+1} \\equiv 0$）测试 SG 方程得到。残差方程变为\n$$\nK_0\\,u_{p+1} \\approx -\\,\\alpha_p\\,K_1\\,u_p,\n$$\n这启发了对被忽略系数的分层预测器\n$$\n\\widehat{u}_{p+1} := -\\,K_0^{-1}\\,\\big(\\alpha_p\\,K_1\\,u_p\\big).\n$$\n定义相对于平均系数 $a_0(x)$ 的能量范数为\n$$\n\\| v \\|_{E}^2 := v^\\top K_0\\,v,\n$$\n以及相对于一个更高阶的参考 SG 解 $U^{\\mathrm{ref}}$ 的误差的随机能量范数为\n$$\n\\| e \\|_{E,\\mathrm{sto}}^2 := \\sum_{n=0}^{p_{\\mathrm{ref}}} \\| u_n^{\\mathrm{ref}} - u_n^{\\mathrm{approx}} \\|_E^2,\n$$\n其中当 $n \\le p$ 时 $u_n^{\\mathrm{approx}} = u_n$，当 $n > p$ 时 $u_n^{\\mathrm{approx}} = 0$。使用分层估计器\n$$\n\\eta_p := \\| \\widehat{u}_{p+1} \\|_E,\n$$\n在 $\\eta_p$ 超过给定容差时驱动自适应细化 $p \\to p+1$。为了在基准问题上进行可靠性和效率评估，计算比率\n$$\n\\mathrm{Rel} := \\frac{\\eta_p}{\\| e \\|_{E,\\mathrm{sto}}}, \\qquad \\mathrm{Eff} := \\frac{\\| e \\|_{E,\\mathrm{sto}}}{\\eta_p},\n$$\n其中使用一个足够丰富的参考多项式阶数 $p_{\\mathrm{ref}} > p$。\n\n实现以下要求：\n\n- 使用每个单元两点高斯求积计算 $\\int a(x)\\,dx$ 来构造 $K_0$ 和 $K_1$，并使用一阶有限元为 $f(x) \\equiv 1$ 精确组装 $F_0$。\n- 对于给定的初始多项式阶数 $p$ 和网格 $N$，求解 SG 系统，计算分层估计器 $\\eta_p$，并自适应地增加 $p$，直到估计器低于指定的容差或达到最大阶数限制。使用 $p_{\\max} = 12$。\n- 为了进行可靠性和效率分析，在多项式阶数 $p_{\\mathrm{ref}} = \\min(p+3,12)$ 处计算一个参考 SG 解，并相对于当前近似解评估 $\\| e \\|_{E,\\mathrm{sto}}$。\n- 对于每个测试用例，报告一个包含最终多项式阶数 $p_{\\mathrm{final}}$、自适应增量的总数 $\\mathsf{iters}$、可靠性比率 $\\mathrm{Rel}$ 和效率比率 $\\mathrm{Eff}$ 的列表。比率必须作为浮点数返回。\n\n测试套件：\n\n- 案例 1 (正常路径)：$N = 64$，$\\epsilon = 1.0$，初始 $p = 0$，容差 $\\mathrm{tol} = 10^{-3}$。\n- 案例 2 (更严格的容差)：$N = 64$，$\\epsilon = 1.0$，初始 $p = 0$，容差 $\\mathrm{tol} = 10^{-5}$。\n- 案例 3 (边缘案例，弱非均匀性)：$N = 64$，$\\epsilon = 0.05$，初始 $p = 0$，容差 $\\mathrm{tol} = 10^{-6}$。\n\n最终输出格式：\n\n你的程序应该生成单行输出，其中包含三个测试用例的结果，形式为用方括号括起来的、以逗号分隔的列表的列表，并按测试套件的顺序排列。每个内部列表必须是 $[p_{\\mathrm{final}}, \\mathsf{iters}, \\mathrm{Rel}, \\mathrm{Eff}]$ 的形式。例如，输出必须如下所示：\n$$\n[[p_1,\\mathsf{iters}_1,\\mathrm{Rel}_1,\\mathrm{Eff}_1],[p_2,\\mathsf{iters}_2,\\mathrm{Rel}_2,\\mathrm{Eff}_2],[p_3,\\mathsf{iters}_3,\\mathrm{Rel}_3,\\mathrm{Eff}_3]].\n$$\n所有数值必须以十进制形式报告。不涉及物理单位。", "solution": "用户提供了一个在带有随机输入的偏微分方程数值方法领域中定义明确的问题。该问题要求实现一种基于多项式混沌展开 (PCE) 的自适应随机 Galerkin (SG) 方法，以求解具有不确定系数的一维扩散方程。使用后验误差估计来驱动 PCE 多项式阶数的自适应细化。\n\n### 第 1 步：问题验证\n\n根据所需标准对问题进行验证。\n\n**提取的已知条件：**\n- **PDE 模型**：在一维空间域 $[0,1]$ 上的非均匀扩散方程：$-\\frac{d}{dx}\\left( a(x,\\xi) \\frac{du}{dx} \\right) = f(x)$。\n- **边界条件**：齐次 Dirichlet，$u(0,\\xi) = 0$ 和 $u(1,\\xi) = 0$。\n- **强迫项**：$f(x) \\equiv 1$。\n- **不确定扩散系数**：$a(x,\\xi) = a_0(x) + a_1(x)\\,\\xi$，其中 $\\xi$ 是在 $[-1,1]$ 上均匀分布的随机变量。\n- **系数函数**：对于 $\\epsilon \\in (0,1]$，$a_0(x) = 1 + 0.5\\sin(2\\pi x)$ 和 $a_1(x) = \\epsilon\\cdot 0.3\\cos(2\\pi x)$。\n- **随机离散化 (PCE)**：$u(x,\\xi) \\approx \\sum_{n=0}^{p} u_n(x)\\,\\Phi_n(\\xi)$，使用关于权重 $w(\\xi) = 1/2$ 的正交归一 Legendre 多项式 $\\{\\Phi_n(\\xi)\\}$。\n- **空间离散化 (FEM)**：在具有 $N$ 个单元的均匀网格上使用协调的一阶有限元。\n- **SG 系统**：全局线性系统由 $\\left( I_{p+1} \\otimes K_0 + T \\otimes K_1 \\right) U = \\left[ F_0; 0; \\dots; 0 \\right]$ 给出，其中 $K_0, K_1$ 是 FE 刚度矩阵，$F_0$ 是载荷向量，$T$ 是从 Legendre 多项式的三项递推关系导出的三对角耦合矩阵。\n- **误差估计器**：一个分层的、基于残差的后验误差估计器 $\\eta_p = \\| \\widehat{u}_{p+1} \\|_E$，其中 $\\widehat{u}_{p+1} := -\\,K_0^{-1}\\,\\big(\\alpha_p\\,K_1\\,u_p\\big)$ 且 $\\| v \\|_{E}^2 := v^\\top K_0\\,v$。系数 $\\alpha_p$ 由递推关系定义。\n- **自适应策略**：如果 $\\eta_p \\ge \\mathrm{tol}$，则从初始值开始增加多项式阶数 $p$，直到达到最大阶数 $p_{\\max} = 12$。\n- **误差分析**：为了分析，在 $p_{\\mathrm{ref}} = \\min(p+3, 12)$ 处计算一个参考解，并计算估计器相对于随机能量误差范数 $\\| e \\|_{E,\\mathrm{sto}}$ 的可靠性 ($\\mathrm{Rel}$) 和效率 ($\\mathrm{Eff}$) 比率。\n- **实现细节**：指定使用两点高斯求积来组装刚度矩阵。载荷向量需精确组装。\n- **测试用例**：\n    - 案例 1：$N = 64$，$\\epsilon = 1.0$，初始 $p = 0$，$\\mathrm{tol} = 10^{-3}$。\n    - 案例 2：$N = 64$，$\\epsilon = 1.0$，初始 $p = 0$，$\\mathrm{tol} = 10^{-5}$。\n    - 案例 3：$N = 64$，$\\epsilon = 0.05$，初始 $p = 0$，$\\mathrm{tol} = 10^{-6}$。\n\n**验证结论：**\n1.  **科学依据和事实合理性**：该问题在不确定性量化和偏微分方程数值分析理论中有充分的依据。SG-FEM 框架是一种标准技术。对于给定的参数范围，扩散系数 $a(x,\\xi)$ 保持严格为正，保证了扩散模型的物理和数学有效性。$a(x,\\xi)$ 的最小值为 $a(x, \\xi) \\ge \\min(a_0) - \\epsilon \\max|a_1| = (1-0.5) - 1.0 \\cdot 0.3 = 0.2 > 0$。\n2.  **适定性**：底层偏微分方程是一个标准的椭圆问题，是适定的。得到的 SG 线性系统是针对一个对称正定矩阵，保证了唯一解。\n3.  **客观性**：问题用精确的数学定义陈述，没有主观性。\n4.  **完整性和一致性**：所有必要的信息，包括模型方程、离散化方法、自适应策略和测试参数，都已提供。该设置是自洽的。\n5.  **非平凡或伪深刻**：该问题需要对一种已建立的数值方法进行不平凡的实现，代表了一项真正的计算科学任务。\n\n问题被认为是**有效的**。我们可以继续进行求解。\n\n### 第 2 步：求解设计\n\n将使用 Python 中的 `numpy` 库来实现该解决方案。整体结构将包含一个主函数，用于遍历所有测试用例。对于每个用例，一个专门的函数将执行自适应算法，计算所需的量，并返回结果。\n\n**1. 有限元组装：**\n一个辅助函数 `assemble_fem` 将构造有限元矩阵 $K_0$、$K_1$ 和载荷向量 $F_0$。\n- 空间域 $[0,1]$ 被离散化为 $N$ 个尺寸为 $h=1/N$ 的均匀单元。这产生了 $N-1$ 个内部自由度。\n- 刚度矩阵 $K_0, K_1$ 的尺寸为 $(N-1) \\times (N-1)$。对每个单元 $[x_i, x_{i+1}]$ 计算一个单元刚度矩阵 $k^e$。其元素与 $\\int_{x_i}^{x_{i+1}} a(x) \\, dx$ 成正比，其中 $a(x)$ 是 $a_0(x)$ 或 $a_1(x)$。此积分按照指定使用两点高斯求积进行近似。通过对每个单元的贡献求和来组装全局矩阵。\n- 尺寸为 $N-1$ 的载荷向量 $F_0$ 对应于常数强迫项 $f(x)=1$。对于一个 P1 线性基函数 $\\phi_j(x)$，积分 $\\int_0^1 f(x)\\phi_j(x)\\,dx = \\int_{x_{j-1}}^{x_{j+1}} 1 \\cdot \\phi_j(x)\\,dx$ 精确地是帽函数的面积，即 $h$。因此，$F_0$ 的所有元素都等于 $h$。\n\n**2. 随机 Galerkin 系统求解器：**\n一个函数 `get_sg_solution` 将为给定的多项式阶数 $p$ 构建并求解完整的 SG 系统。\n- 构造三对角耦合矩阵 $T \\in \\mathbb{R}^{(p+1)\\times(p+1)}$。其非零元素为 $T_{n,n+1} = T_{n+1,n} = \\alpha_n = (n+1)/\\sqrt{(2n+1)(2n+3)}$，其中 $n=0, \\dots, p-1$。\n- 使用 Kronecker 积形成全局 SG 矩阵 $A_{SG} = I_{p+1} \\otimes K_0 + T \\otimes K_1$。\n- 右端向量构造为 $[F_0; 0; \\dots; 0]$。\n- 使用 `numpy.linalg.solve` 求解系统 $A_{SG} U = RHS$ 以找到系数向量 $U$。\n\n**3. 自适应细化算法：**\n主要逻辑被封装在 `run_case_logic` 中。\n- 它将 $p$ 初始化为起始值并进入一个自适应循环。\n- 在循环内部，对于当前的阶数 $p$：\n    1.  求解 SG 系统以获得解向量 $U$。该向量的最后一块对应于系数函数 $u_p(x)$ 的节点值。\n    2.  计算分层误差估计器 $\\eta_p$。这涉及：\n        a.  计算残差右端项 $RHS_{res} = -\\alpha_p K_1 u_p$。\n        b.  求解线性系统 $K_0 \\widehat{u}_{p+1} = RHS_{res}$ 以得到误差预测器 $\\widehat{u}_{p+1}$。\n        c.  计算能量范数的平方 $\\eta_p^2 = \\|\\widehat{u}_{p+1}\\|_E^2 = \\widehat{u}_{p+1}^\\top K_0 \\widehat{u}_{p+1} = \\widehat{u}_{p+1}^\\top RHS_{res}$。\n    3.  如果 $\\eta_p$ 低于容差 `tol` 或 $p$ 达到最大阶数 $p_{\\max}$，则循环终止。否则，增加 $p$。\n\n**4. 误差和比率计算：**\n- 在自适应循环在 $p_{final}$ 处终止后，在更高的阶数 $p_{ref} = \\min(p_{final}+3, p_{max})$ 处计算参考解 $U^{ref}$。\n- 通过对参考系数和近似系数之间差的能量范数求和来计算随机能量误差 $\\|e\\|_{E,sto}$：$\\| e \\|_{E,\\mathrm{sto}}^2 = \\sum_{n=0}^{p_{\\mathrm{ref}}} \\| u_n^{\\mathrm{ref}} - u_n^{\\mathrm{approx}} \\|_E^2$。注意，对于 $n > p_{final}$，$u_n^{\\mathrm{approx}}=0$。\n- 最后，计算可靠性 $\\mathrm{Rel} = \\eta_p / \\| e \\|_{E,\\mathrm{sto}}$ 和效率 $\\mathrm{Eff} = \\| e \\|_{E,\\mathrm{sto}} / \\eta_p$。对误差或估计器可能为零的情况要特别小心，以避免除以零的错误。如果两者都为零，则比率定义为 $1.0$。\n\n以下代码实现了这一设计。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Main driver function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: N=64, epsilon=1.0, p_initial=0, tol=1e-3\n        (64, 1.0, 0, 1e-3),\n        # Case 2: N=64, epsilon=1.0, p_initial=0, tol=1e-5\n        (64, 1.0, 0, 1e-5),\n        # Case 3: N=64, epsilon=0.05, p_initial=0, tol=1e-6\n        (64, 0.05, 0, 1e-6),\n    ]\n\n    p_max = 12\n    results = []\n    for case in test_cases:\n        N, epsilon, p_initial, tol = case\n        result = run_case_logic(N, epsilon, p_initial, tol, p_max)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Convert numerical results to string representations for the list.\n    formatted_results = []\n    for res in results:\n        formatted_results.append(f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef get_alpha(n):\n    \"\"\"Computes the recurrence coefficient alpha_n for orthonormal Legendre polynomials.\"\"\"\n    return (n + 1) / np.sqrt((2 * n + 1) * (2 * n + 3))\n\ndef assemble_fem(N, epsilon):\n    \"\"\"\n    Assembles the finite element matrices K0, K1, and the load vector F0\n    for a uniform mesh with N elements.\n    \"\"\"\n    num_dofs = N - 1\n    h = 1.0 / N\n    x_nodes = np.linspace(0, 1, N + 1)\n\n    a0_func = lambda x: 1.0 + 0.5 * np.sin(2 * np.pi * x)\n    a1_func = lambda x: epsilon * 0.3 * np.cos(2 * np.pi * x)\n\n    gq_points = np.array([-1.0, 1.0]) / np.sqrt(3.0)\n    gq_weights = np.array([1.0, 1.0])\n\n    int_a0_elem = np.zeros(N)\n    int_a1_elem = np.zeros(N)\n\n    for i in range(N):\n        x_i, x_i_plus_1 = x_nodes[i], x_nodes[i+1]\n        jacobian = 0.5 * h\n        mapped_gq_points = jacobian * gq_points + 0.5 * (x_i + x_i_plus_1)\n        \n        a0_vals = a0_func(mapped_gq_points)\n        a1_vals = a1_func(mapped_gq_points)\n        \n        int_a0_elem[i] = jacobian * np.sum(gq_weights * a0_vals)\n        int_a1_elem[i] = jacobian * np.sum(gq_weights * a1_vals)\n\n    K0 = np.zeros((num_dofs, num_dofs))\n    K1 = np.zeros((num_dofs, num_dofs))\n    \n    # Fill diagonal\n    diag0 = (int_a0_elem[:-1] + int_a0_elem[1:]) / h**2\n    diag1 = (int_a1_elem[:-1] + int_a1_elem[1:]) / h**2\n    np.fill_diagonal(K0, diag0)\n    np.fill_diagonal(K1, diag1)\n    \n    # Fill off-diagonals\n    off_diag0 = -int_a0_elem[1:-1] / h**2\n    off_diag1 = -int_a1_elem[1:-1] / h**2\n    \n    if num_dofs > 1:\n        np.fill_diagonal(K0[1:], off_diag0)\n        np.fill_diagonal(K0[:, 1:], off_diag0)\n        np.fill_diagonal(K1[1:], off_diag1)\n        np.fill_diagonal(K1[:, 1:], off_diag1)\n            \n    F0 = np.full(num_dofs, h)\n    \n    return K0, K1, F0\n\ndef get_sg_solution(p, K0, K1, F0):\n    \"\"\"\n    Constructs and solves the Stochastic Galerkin system for a given polynomial degree p.\n    \"\"\"\n    num_dofs = K0.shape[0]\n    T = np.zeros((p + 1, p + 1))\n    for i in range(p):\n        alpha_i = get_alpha(i)\n        T[i, i + 1] = alpha_i\n        T[i + 1, i] = alpha_i\n\n    I_p = np.eye(p + 1)\n    A_sg = np.kron(I_p, K0) + np.kron(T, K1)\n\n    RHS = np.zeros((p + 1) * num_dofs)\n    RHS[:num_dofs] = F0\n\n    U = scipy.linalg.solve(A_sg, RHS, assume_a='sym')\n    return U\n\ndef run_case_logic(N, epsilon, p_initial, tol, p_max):\n    \"\"\"\n    Main logic for a single test case: adaptive refinement, error computation, and ratio calculation.\n    \"\"\"\n    K0, K1, F0 = assemble_fem(N, epsilon)\n    num_dofs = K0.shape[0]\n\n    p = p_initial\n    iters = 0\n    U_final, eta_final = None, -1.0\n\n    while True:\n        U = get_sg_solution(p, K0, K1, F0)\n        \n        u_p = U[p * num_dofs:]\n        \n        alpha_p = get_alpha(p)\n        rhs_res = -alpha_p * (K1 @ u_p)\n        \n        # Using pseudoinverse for K0 just in case, though it should be invertible.\n        # More robustly, use a direct symmetric solver\n        hat_u_p_plus_1 = scipy.linalg.solve(K0, rhs_res, assume_a='sym')\n        \n        eta_p_sq = hat_u_p_plus_1.T @ rhs_res\n        eta_p = np.sqrt(max(0, eta_p_sq))\n\n        if eta_p  tol or p >= p_max:\n            p_final = p\n            U_final = U\n            eta_final = eta_p\n            break\n\n        p += 1\n        iters += 1\n    \n    p_ref = min(p_final + 3, p_max)\n    \n    if p_ref = p_final:\n        true_error = 0.0\n    else:\n        U_ref = get_sg_solution(p_ref, K0, K1, F0)\n        error_sq = 0.0\n        \n        for n in range(p_ref + 1):\n            u_n_ref = U_ref[n*num_dofs : (n+1)*num_dofs]\n            if n = p_final:\n                u_n_approx = U_final[n*num_dofs : (n+1)*num_dofs]\n            else:\n                u_n_approx = np.zeros(num_dofs)\n            \n            diff = u_n_ref - u_n_approx\n            error_sq += diff.T @ K0 @ diff\n            \n        true_error = np.sqrt(max(0, error_sq))\n\n    with np.errstate(divide='ignore', invalid='ignore'):\n        Rel = np.divide(eta_final, true_error)\n        Eff = np.divide(true_error, eta_final)\n    \n    # Handle cases where both are zero\n    if true_error == 0 and eta_final == 0:\n        Rel = 1.0\n        Eff = 1.0\n    elif np.isnan(Rel): Rel = np.inf\n    elif np.isnan(Eff): Eff = np.inf\n    \n    return [p_final, iters, Rel, Eff]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3432978"}]}