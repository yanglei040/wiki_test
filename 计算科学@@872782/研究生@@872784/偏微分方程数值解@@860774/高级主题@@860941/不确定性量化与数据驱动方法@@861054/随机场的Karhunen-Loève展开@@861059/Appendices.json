{"hands_on_practices": [{"introduction": "本练习将Karhunen-Loève展开的抽象定义与具体的数值方法联系起来。您将首先通过解析推导，将一个常见协方差核的控制积分特征值问题，转化为一个更为人熟悉的Sturm-Liouville边值问题[@problem_id:3413105]。这项练习在连续理论与其离散对应物之间建立了关键的联系，接着您将实现并比较两种强大的数值技术——谱方法和有限元方法——来近似KL特征对。", "problem": "考虑一维域 $D=(0,L)$（其中 $L>0$）以及一个中心化的、均方连续的随机场，其协方差核为 $C(x,y)=\\exp(-\\alpha\\lvert x-y\\rvert)$（其中 $\\alpha>0$）。该随机场的 Karhunen–Loève (KL) 展开由协方差算子的积分特征值问题所决定，该算子被理解为 $L^2(0,L)$ 上的一个紧自伴算子。\n\n任务 A (推导)。从协方差算子和满足积分方程\n$$\n\\int_0^L C(x,y)\\,\\phi(y)\\,dy = \\lambda\\,\\phi(x),\\quad x\\in (0,L),\n$$\n的特征对 $(\\lambda,\\phi)$ 的定义出发，并仅使用微积分和泛函分析的基本事实（例如，积分符号下的微分、绝对值的性质以及线性算子），推导在 $(0,L)$ 中特征函数 $\\phi$ 的等价微分形式。证明 $\\phi$ 满足一个带有 Robin 型边界条件的二阶 Sturm–Liouville (SL) 边值问题，并明确指出微分特征值参数与积分特征值 $\\lambda$ 之间的关系。除了这些基本原理外，不要假设任何捷径公式，并确保每一步都从第一性原理出发进行论证。\n\n任务 B (数值谱近似)。使用具有 $N_q$ 个求积点的 Gauss–Legendre (GL) 求积，对 $(0,L)$ 上的协方差算子进行谱离散化。通过由求积节点和权重构建的对称矩阵来近似该积分算子，并计算近似 KL 特征值的 $m$ 个最大特征值 $\\{\\lambda_n\\}_{n=1}^m$（从大到小排序）。\n\n任务 C (通过 Sturm–Liouville 形式的有限元近似)。使用任务 A 中的微分形式，在 $(0,L)$ 上的均匀网格上，用 $N_e$ 个单元实现一个协调线性有限元方法 (Finite Element Method (FEM))。组装与 SL 算子弱形式相对应的刚度矩阵和质量矩阵，在双线性形式中一致地并入 Robin 型边界项，并求解得到的广义对称特征值问题，以获得 $m$ 个最小的微分特征值 $\\{\\mu_n\\}_{n=1}^m$。通过您在任务 A 中推导的关系将这些值转换为 KL 特征值，得到 $\\{\\lambda_n^{\\mathrm{FEM}}\\}_{n=1}^m$，并从大到小排序。\n\n任务 D (比较度量和测试套件)。对于每个参数集 $(L,\\alpha,N_q,N_e,m)$，分别用谱方法计算 $m$ 个最大的 KL 特征值 $\\{\\lambda_n^{\\mathrm{spec}}\\}_{n=1}^m$，以及通过有限元路径计算的特征值 $\\{\\lambda_n^{\\mathrm{FEM}}\\}_{n=1}^m$。定义相对差异\n$$\nr = \\max_{1\\le n\\le m}\\frac{\\lvert \\lambda_n^{\\mathrm{spec}}-\\lambda_n^{\\mathrm{FEM}}\\rvert}{\\lvert \\lambda_n^{\\mathrm{spec}}\\rvert}.\n$$\n您的程序必须对以下三个测试案例中的每一个进行 $r$ 的求值：\n- 案例 1: $(L,\\alpha,N_q,N_e,m)=(1.0,1.0,120,300,5)$。\n- 案例 2: $(L,\\alpha,N_q,N_e,m)=(2.0,0.5,160,300,5)$。\n- 案例 3: $(L,\\alpha,N_q,N_e,m)=(0.7,5.0,200,350,5)$。\n\n要求的最终输出。您的程序应生成一行输出，其中包含上述案例的三个 $r$ 值，以逗号分隔的列表形式，并用方括号括起来，每个值四舍五入到 $8$ 位小数（例如，$[0.00000123,0.00000456,0.00000789]$）。不应产生其他任何输出。\n\n注释：\n- 在您的推导和推理中出现的所有符号、变量、函数、算子和数字都必须使用标准数学符号表示。\n- 本问题不涉及物理单位。\n- 本问题不使用角度。", "solution": "问题陈述经评估有效。其科学基础在于随机过程和数值分析理论，特别是关于 Karhunen-Loève 展开及其数值近似。问题提法良好、自洽，所有数据、定义和任务都以数学精度进行了规定，允许存在唯一且有意义的解。不存在矛盾、歧义或事实不准确之处。\n\n### 任务 A：Sturm-Liouville 形式的推导\n\n我们从定义在域 $D=(0,L)$ 上的积分特征值问题开始：\n$$\n\\lambda\\,\\phi(x) = \\int_0^L C(x,y)\\,\\phi(y)\\,dy\n$$\n其中协方差核为 $C(x,y) = \\exp(-\\alpha|x-y|)$，$\\alpha > 0$。任务是推导出等价的微分特征值问题。\n\n首先，我们在 $y=x$ 处分割积分以处理绝对值项 $|x-y|$：\n$$\n\\lambda\\,\\phi(x) = \\int_0^x e^{-\\alpha(x-y)}\\,\\phi(y)\\,dy + \\int_x^L e^{-\\alpha(y-x)}\\,\\phi(y)\\,dy\n$$\n我们可以通过提出依赖于 $x$ 的项来重写此式：\n$$\n\\lambda\\,\\phi(x) = e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy + e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy\n$$\n为了将此积分方程转换为微分方程，我们对 $x$ 进行微分。我们应用莱布尼茨积分法则，该法则指出对于形式为 $I(x) = \\int_{a(x)}^{b(x)} f(x,t)\\,dt$ 的积分，其导数为 $I'(x) = \\int_{a(x)}^{b(x)} \\frac{\\partial f}{\\partial x}\\,dt + f(x, b(x)) \\frac{db}{dx} - f(x, a(x)) \\frac{da}{dx}$。\n\n对 $\\lambda\\,\\phi(x)$ 的方程逐项微分得到：\n$$\n\\lambda\\,\\phi'(x) = \\left[ -\\alpha e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy + e^{-\\alpha x} \\cdot (e^{\\alpha x}\\,\\phi(x)) \\right] + \\left[ \\alpha e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy - e^{\\alpha x} \\cdot (e^{-\\alpha x}\\,\\phi(x)) \\right]\n$$\n边界求值项 $e^{-\\alpha x} \\cdot (e^{\\alpha x}\\,\\phi(x))$ 和 $-e^{\\alpha x} \\cdot (e^{-\\alpha x}\\,\\phi(x))$ 分别简化为 $\\phi(x)$ 和 $-\\phi(x)$，它们相互抵消。剩下的是：\n$$\n\\lambda\\,\\phi'(x) = -\\alpha e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy + \\alpha e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy\n$$\n我们再次对 $x$ 进行二次微分，同样应用莱布尼茨法则：\n$$\n\\lambda\\,\\phi''(x) = -\\alpha \\left[ -\\alpha e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy + e^{-\\alpha x} \\cdot (e^{\\alpha x}\\phi(x)) \\right] + \\alpha \\left[ \\alpha e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy - e^{\\alpha x} \\cdot (e^{-\\alpha x}\\phi(x)) \\right]\n$$\n简化各项：\n$$\n\\lambda\\,\\phi''(x) = \\alpha^2 e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy - \\alpha\\phi(x) + \\alpha^2 e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy - \\alpha\\phi(x)\n$$\n$$\n\\lambda\\,\\phi''(x) = \\alpha^2 \\left( e^{-\\alpha x} \\int_0^x e^{\\alpha y}\\,\\phi(y)\\,dy + e^{\\alpha x} \\int_x^L e^{-\\alpha y}\\,\\phi(y)\\,dy \\right) - 2\\alpha\\phi(x)\n$$\n我们识别出括号中的表达式是 $\\lambda\\,\\phi(x)$ 的原始积分表示。将其代回，我们得到：\n$$\n\\lambda\\,\\phi''(x) = \\alpha^2 (\\lambda\\,\\phi(x)) - 2\\alpha\\phi(x)\n$$\n假设 $\\lambda \\neq 0$（由于核是正定的，这得到了保证），我们可以重新排列方程：\n$$\n\\phi''(x) - \\alpha^2\\phi(x) = -\\frac{2\\alpha}{\\lambda}\\phi(x)\n$$\n$$\n\\phi''(x) + \\left(\\frac{2\\alpha}{\\lambda} - \\alpha^2\\right)\\phi(x) = 0\n$$\n这是一个二阶常微分方程。我们可以将其写成标准的 Sturm-Liouville 形式 $-\\phi''(x) = \\mu\\,\\phi(x)$，其中微分特征值 $\\mu$ 定义为：\n$$\n\\mu = \\frac{2\\alpha}{\\lambda} - \\alpha^2\n$$\n反之，积分特征值 $\\lambda$ 与微分特征值 $\\mu$ 的关系为：\n$$\n\\lambda = \\frac{2\\alpha}{\\mu + \\alpha^2}\n$$\n接下来，我们推导边界条件。我们在边界 $x=0$ 和 $x=L$ 处计算 $\\lambda\\,\\phi(x)$ 和 $\\lambda\\,\\phi'(x)$ 的表达式。\n在 $x=0$ 处：\n$$\n\\lambda\\,\\phi(0) = \\int_0^L e^{-\\alpha y}\\,\\phi(y)\\,dy\n$$\n$$\n\\lambda\\,\\phi'(0) = -\\alpha \\int_0^0 (\\dots)\\,dy + \\alpha \\int_0^L e^{-\\alpha y}\\,\\phi(y)\\,dy = \\alpha \\int_0^L e^{-\\alpha y}\\,\\phi(y)\\,dy\n$$\n比较这两个方程，我们发现 $\\lambda\\,\\phi'(0) = \\alpha(\\lambda\\,\\phi(0))$，对于 $\\lambda \\neq 0$，这意味着 Robin 型边界条件：\n$$\n\\phi'(0) - \\alpha\\,\\phi(0) = 0\n$$\n在 $x=L$ 处：\n$$\n\\lambda\\,\\phi(L) = e^{-\\alpha L} \\int_0^L e^{\\alpha y}\\,\\phi(y)\\,dy\n$$\n$$\n\\lambda\\,\\phi'(L) = -\\alpha e^{-\\alpha L} \\int_0^L e^{\\alpha y}\\,\\phi(y)\\,dy - \\alpha \\int_L^L (\\dots)\\,dy = -\\alpha e^{-\\alpha L} \\int_0^L e^{\\alpha y}\\,\\phi(y)\\,dy\n$$\n比较这些得出 $\\lambda\\,\\phi'(L) = -\\alpha(\\lambda\\,\\phi(L))$，这产生了第二个边界条件：\n$$\n\\phi'(L) + \\alpha\\,\\phi(L) = 0\n$$\n总之，特征函数 $\\phi(x)$ 满足 Sturm-Liouville 边值问题：\n$$\n-\\phi''(x) = \\mu\\,\\phi(x), \\quad x \\in (0,L)\n$$\n$$\n\\text{BCs: } \\phi'(0) - \\alpha\\,\\phi(0) = 0, \\quad \\phi'(L) + \\alpha\\,\\phi(L) = 0\n$$\n\n### 任务 B：数值谱近似\n\n积分特征值问题 $\\int_0^L C(x,y)\\phi(y)dy = \\lambda\\phi(x)$ 使用具有 $N_q$ 个点的 Gauss-Legendre 求积进行近似。设 $\\{y_j, w_j\\}_{j=1}^{N_q}$ 是区间 $[-1,1]$ 上的求积节点和权重。通过仿射变换 $x_j' = \\frac{L}{2}(y_j+1)$ 和 $w_j' = \\frac{L}{2}w_j$ 将它们映射到域 $(0,L)$。在每个节点 $x_i'$ 处的积分方程被离散化为：\n$$\n\\sum_{j=1}^{N_q} C(x_i', x_j')\\,\\phi(x_j')\\,w_j' \\approx \\lambda\\,\\phi(x_i')\n$$\n为了将其表述为对称矩阵特征值问题，我们定义一个新向量 $\\psi_j = \\sqrt{w_j'}\\,\\phi(x_j')$。将 $\\phi(x_j') = \\psi_j/\\sqrt{w_j'}$ 代入离散方程并乘以 $\\sqrt{w_i'}$ 得到：\n$$\n\\sum_{j=1}^{N_q} \\sqrt{w_i'} C(x_i', x_j') \\sqrt{w_j'}\\,\\psi_j \\approx \\lambda\\,\\psi_i\n$$\n这是一个标准的对称特征值问题 $A\\mathbf{\\psi} = \\lambda\\mathbf{\\psi}$，其中矩阵 $A$ 的元素为 $A_{ij} = \\sqrt{w_i'} C(x_i', x_j') \\sqrt{w_j'}$。该矩阵 $A$ 的特征值提供了对真实 KL 特征值的近似 $\\{\\lambda_n^{\\mathrm{spec}}\\}$。由于 KL 特征值通常从大到小排序，我们计算 $A$ 的所有特征值并选择 $m$ 个最大的值。\n\n### 任务 C：有限元近似\n\nFEM 应用于任务 A 中推导的 Sturm-Liouville 问题。通过将微分方程 $-\\phi'' = \\mu\\phi$ 乘以一个测试函数 $v \\in H^1(0,L)$ 并在 $(0,L)$ 上积分来找到弱形式：\n$$\n-\\int_0^L \\phi''(x)v(x)\\,dx = \\mu \\int_0^L \\phi(x)v(x)\\,dx\n$$\n对左侧应用分部积分：\n$$\n\\int_0^L \\phi'(x)v'(x)\\,dx - [\\phi'(x)v(x)]_0^L = \\mu \\int_0^L \\phi(x)v(x)\\,dx\n$$\n我们将 Robin 边界条件 $\\phi'(0)=\\alpha\\phi(0)$ 和 $\\phi'(L)=-\\alpha\\phi(L)$ 代入边界项：\n$$\n[\\phi'(x)v(x)]_0^L = \\phi'(L)v(L) - \\phi'(0)v(0) = -\\alpha\\phi(L)v(L) - \\alpha\\phi(0)v(0)\n$$\n然后弱形式为：求 $\\phi \\in H^1(0,L)$，使得对于所有 $v \\in H^1(0,L)$，\n$$\n\\int_0^L \\phi'(x)v'(x)\\,dx + \\alpha\\phi(0)v(0) + \\alpha\\phi(L)v(L) = \\mu \\int_0^L \\phi(x)v(x)\\,dx\n$$\n这定义了刚度双线性形式 $a(\\phi,v) = \\int_0^L \\phi'v'\\,dx + \\alpha\\phi(0)v(0) + \\alpha\\phi(L)v(L)$ 和质量双线性形式 $b(\\phi,v) = \\int_0^L \\phi v\\,dx$。\n我们用 $N_e$ 个大小为 $h=L/N_e$ 的均匀线性单元离散化域 $(0,L)$，得到 $N_e+1$ 个节点。使用标准的线性“帽子”基函数 $N_i(x)$，我们近似 $\\phi(x) \\approx \\sum_{j=0}^{N_e} u_j N_j(x)$ 并设置 $v(x) = N_i(x)$。这导致了广义矩阵特征值问题 $K\\mathbf{u} = \\mu M\\mathbf{u}$，其中刚度矩阵 $K$ 和质量矩阵 $M$ 的条目为 $K_{ij} = a(N_j, N_i)$ 和 $M_{ij} = b(N_j, N_i)$。标准的局部单元刚度矩阵是 $\\frac{1}{h}\\begin{psmallmatrix} 1 & -1 \\\\ -1 & 1 \\end{psmallmatrix}$，局部质量矩阵是 $\\frac{h}{6}\\begin{psmallmatrix} 2 & 1 \\\\ 1 & 2 \\end{psmallmatrix}$。边界项 $\\alpha\\phi(0)v(0) + \\alpha\\phi(L)v(L)$ 仅对全局刚度矩阵的对角线元素 $K_{0,0}$ 和 $K_{N_e, N_e}$ 有贡献，为每个元素增加一个值 $\\alpha$。\n我们求解这个广义特征值问题，得到 $m$ 个最小的特征值 $\\{\\mu_n\\}_{n=1}^m$。然后使用推导的关系将它们转换为 KL 特征值：$\\lambda_n^{\\mathrm{FEM}} = \\frac{2\\alpha}{\\mu_n + \\alpha^2}$。因为 $\\mu_n$ 是从小到大排序的，所以得到的 $\\lambda_n^{\\mathrm{FEM}}$ 将正确地从大到小排序。\n\n### 任务 D：比较度量\n\n对于每个测试案例，计算谱方法得到的 $m$ 个最大特征值 $\\{\\lambda_n^{\\mathrm{spec}}\\}_{n=1}^m$ 和有限元方法得到的 $m$ 个最大特征值 $\\{\\lambda_n^{\\mathrm{FEM}}\\}_{n=1}^m$。相对差异 $r$ 计算为前 $m$ 个特征值中的最大相对误差：\n$$\nr = \\max_{1\\le n\\le m}\\frac{\\lvert \\lambda_n^{\\mathrm{spec}}-\\lambda_n^{\\mathrm{FEM}}\\rvert}{\\lvert \\lambda_n^{\\mathrm{spec}}\\rvert}\n$$\n程序将对指定的测试案例评估并报告此值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom numpy.polynomial.legendre import leggauss\n\ndef compute_spectral_eigenvalues(L, alpha, N_q, m):\n    \"\"\"\n    Computes KL eigenvalues using a spectral (Nyström) method.\n    Discretizes the integral operator with Gauss-Legendre quadrature.\n    \"\"\"\n    # 1. Get Gauss-Legendre nodes and weights for [-1, 1]\n    nodes, weights = leggauss(N_q)\n\n    # 2. Map nodes and weights to [0, L]\n    x_gl = L * (nodes + 1.0) / 2.0\n    w_gl = L * weights / 2.0\n\n    # 3. Construct the covariance matrix C(x_i, x_j)\n    x_diff = x_gl[:, None] - x_gl[None, :]\n    cov_matrix = np.exp(-alpha * np.abs(x_diff))\n\n    # 4. Symmetrize the matrix for the eigenvalue problem\n    sqrt_w = np.sqrt(w_gl)\n    symm_matrix = sqrt_w[:, None] * cov_matrix * sqrt_w[None, :]\n\n    # 5. Solve for eigenvalues. eigh returns them in ascending order.\n    eigenvalues = eigh(symm_matrix, eigvals_only=True)\n\n    # 6. Return the largest m eigenvalues, sorted in descending order.\n    return eigenvalues[-m:][::-1]\n\ndef compute_fem_eigenvalues(L, alpha, N_e, m):\n    \"\"\"\n    Computes KL eigenvalues via the Sturm-Liouville FEM formulation.\n    \"\"\"\n    # 1. Setup mesh parameters\n    h = L / N_e\n    num_nodes = N_e + 1\n\n    # 2. Assemble global mass matrix M (for linear elements)\n    diag_M = np.full(num_nodes, 2.0 * h / 3.0)\n    diag_M[0] = diag_M[-1] = h / 3.0\n    offdiag_M = np.full(num_nodes - 1, h / 6.0)\n    M = np.diag(diag_M) + np.diag(offdiag_M, k=1) + np.diag(offdiag_M, k=-1)\n    \n    # 3. Assemble global stiffness matrix K (for linear elements)\n    diag_K = np.full(num_nodes, 2.0 / h)\n    diag_K[0] = diag_K[-1] = 1.0 / h\n    offdiag_K = np.full(num_nodes - 1, -1.0 / h)\n    K = np.diag(diag_K) + np.diag(offdiag_K, k=1) + np.diag(offdiag_K, k=-1)\n\n    # 4. Incorporate Robin boundary conditions\n    K[0, 0] += alpha\n    K[-1, -1] += alpha\n\n    # 5. Solve the generalized eigenvalue problem K*u = mu*M*u\n    # eigh returns differential eigenvalues (mu) in ascending order.\n    mu_values = eigh(K, M, eigvals_only=True)\n\n    # 6. We need the smallest m differential eigenvalues\n    mu_m = mu_values[:m]\n\n    # 7. Convert differential eigenvalues (mu) to KL eigenvalues (lambda)\n    # The relation is lambda = 2*alpha / (mu + alpha^2)\n    # Since mu_m is sorted ascending, lambda_fem will be sorted descending.\n    lambda_fem = (2.0 * alpha) / (mu_m + alpha**2)\n    \n    return lambda_fem\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, alpha, N_q, N_e, m)\n        (1.0, 1.0, 120, 300, 5),\n        (2.0, 0.5, 160, 300, 5),\n        (0.7, 5.0, 200, 350, 5)\n    ]\n\n    results = []\n    for case in test_cases:\n        L, alpha, N_q, N_e, m = case\n\n        # Compute eigenvalues using both methods\n        lambda_spec = compute_spectral_eigenvalues(L, alpha, N_q, m)\n        lambda_fem = compute_fem_eigenvalues(L, alpha, N_e, m)\n\n        # Calculate the relative discrepancy\n        relative_errors = np.abs(lambda_spec - lambda_fem) / np.abs(lambda_spec)\n        max_discrepancy = np.max(relative_errors)\n        \n        # Store result formatted to 8 decimal places\n        results.append(f\"{max_discrepancy:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3413105"}, {"introduction": "对于周期域上的平稳随机场这一重要的特殊情况，KL展开具有一种特别优美的结构。本练习将引导您证明KL模态等价于傅里叶模态，这一结论使得高效计算成为可能[@problem_id:3413062]。随后，您将利用快速傅里叶变换（FFT）不仅计算KL展开，还将高效地对随机场进行采样并求解一个随机偏微分方程，从而展示一个强大的不确定性量化工作流程。", "problem": "考虑周期性域 $D=\\mathbb{T}^d$，它被建模为一个具有周期性边界条件的 $d$ 维单位环面，以及一个仅依赖于空间差分的平稳协方差函数 $C(x-y)$。Karhunen-Loève 展开由作用于平方可积函数的协方差算子 $K$ 的特征值问题定义：\n$$\n(K\\phi)(x) = \\int_D C(x-y)\\,\\phi(y)\\,dy = \\lambda\\,\\phi(x).\n$$\n从第一性原理出发：平稳性（平移不变性）和周期性意味着协方差算子可以表示为卷积。以此为基础，推导出 $K$ 在 $D=\\mathbb{T}^d$ 上的特征函数是空间傅里叶模态，而对应的特征值是 $C$ 的傅里叶级数系数。然后，设计一个使用快速傅里叶变换 (FFT) 的算法来：\n- 根据 $C$ 在均匀网格上的采样计算离散特征值 $\\lambda_k$。\n- 数值验证将 $K$ 应用于傅里叶模态 $e^{2\\pi i k\\cdot x}$ 会返回同一模态的标量倍数。\n- 通过抽取具有适当厄米共轭对称性并按 $\\sqrt{\\lambda_k}$ 缩放的独立复高斯傅里叶系数，来采样一个均值为零、协方差为 $C$ 的实值高斯随机场 $a(x)$。\n- 使用傅里叶对角化求解周期性亥姆霍兹型偏微分方程 $(I - \\beta \\Delta)u = a$，其中 $\\Delta$ 是 $\\mathbb{T}^d$ 上的拉普拉斯算子，$\\beta>0$ 是一个标量。\n\n你的程序必须实现以下数值模型组件：\n- 一个一维和二维的均匀网格，每个维度有 $N$ 个点，代表 $D=[0,1]^d$，网格点为 $x_j=j/N$（对于 $d=2$ 则逐分量计算）。\n- 一个离散、周期性的协方差核 $C_h$，通过在网格点之间的最小周期性欧几里得距离 $r$ 处评估高斯模型 $C_{\\text{G}}(r) = \\sigma^2 \\exp(-r^2/(2\\ell^2))$ 或指数模型 $C_{\\text{E}}(r) = \\sigma^2 \\exp(-r/\\ell)$ 来构建。\n- 使用离散傅里叶变换将 $\\lambda_k$ 计算为数组 $\\mathcal{F}[C_h]$。\n- 一个基于 FFT 的卷积，通过 $(K f)_h = \\mathcal{F}^{-1}(\\mathcal{F}[C_h]\\cdot \\mathcal{F}[f])$ 将 $K$ 应用于离散函数 $f$。\n- 一个在网格上的傅里叶模态生成器 $\\phi_k$，对于多重索引 $k$，有 $\\phi_k(x_j)=\\exp(2\\pi i\\,k\\cdot x_j)$。\n- 一个采样器，通过构建具有厄米共轭对称性且方差与 $\\lambda_k$ 成正比的复傅里叶系数，来生成具有协方差 $C_h$ 的实高斯场 $a$；通过在自共轭模态上施加对称性约束来强制输出为实值。\n- 一个使用傅里叶符号 $1+\\beta(2\\pi)^2\\lVert k\\rVert^2$ 的求解器，用于求解 $(I-\\beta\\Delta)u=a$。\n\n使用以下参数集测试套件进行数值验证：\n- 测试 1 (一维高斯特征模态一致性)：$d=1$，$N=64$，协方差 $C_{\\text{G}}$，其中 $\\sigma=1$ 且 $\\ell=0.12$，模态 $k=3$。输出相对 $\\ell^2$ 误差 $\\lVert K\\phi_k - \\lambda_k \\phi_k\\rVert_2 / \\lVert \\lambda_k \\phi_k\\rVert_2$。\n- 测试 2 (一维指数特征模态一致性)：$d=1$，$N=64$，协方差 $C_{\\text{E}}$，其中 $\\sigma=1$ 且 $\\ell=0.20$，模态 $k=5$。输出与测试 1 相同的相对误差。\n- 测试 3 (二维高斯特征模态一致性)：$d=2$，$N=(32,32)$，协方差 $C_{\\text{G}}$，其中 $\\sigma=1$ 且 $\\ell=0.15$，模态 $k=(2,3)$。输出与测试 1 相同的相对误差。\n- 测试 4 (基于 FFT 的采样实值性检查)：使用测试 3 中的二维高斯协方差和固定的随机种子 $12345$ 来采样 $a$。输出 $a$ 的虚部的最大绝对值。\n- 测试 5 (基于 FFT 的亥姆霍兹求解器残差)：使用测试 4 中采样的 $a$，求解 $\\beta=0.01$ 时的 $(I-\\beta\\Delta)u=a$。输出相对残差范数 $\\lVert (I-\\beta\\Delta)u - a\\rVert_2 / \\lVert a\\rVert_2$。\n\n所有输出必须是无量纲实数。你的程序应生成单行输出，其中包含五个测试的结果，按测试 1 到 5 的顺序以逗号分隔的列表形式放在方括号内（例如 $[r_1,r_2,r_3,r_4,r_5]$）。在所有傅里叶相位计算中，应一致地使用弧度。本问题不涉及物理单位。实现必须是自包含的，不需要外部输入，并且必须遵循指定的执行环境。", "solution": "该问题要求首先进行理论推导，然后设计并实现一个数值算法，用于处理与周期性域上的 Karhunen-Loève (KL) 展开相关的任务。\n\n**理论推导：环面上的特征函数与特征值**\n\n给定协方差算子 $K$ 在域 $D=\\mathbb{T}^d$（$d$ 维单位环面）上的特征值问题：\n$$\n(K\\phi)(x) = \\int_{\\mathbb{T}^d} C(x-y)\\,\\phi(y)\\,dy = \\lambda\\,\\phi(x)\n$$\n协方差函数 $C$ 是平稳的，意味着它仅依赖于空间差分 $z=x-y$。这表明算子 $K$ 是一个卷积算子，可以表示为 $(K\\phi)(x) = (C * \\phi)(x)$。\n\n我们将证明，对于波矢 $k \\in \\mathbb{Z}^d$，复空间傅里叶模态 $\\phi_k(x) = e^{2\\pi i k \\cdot x}$ 是此算子的特征函数。我们将 $\\phi_k(x)$ 代入特征值方程：\n$$\n(K\\phi_k)(x) = \\int_{\\mathbb{T}^d} C(x-y) e^{2\\pi i k \\cdot y} dy\n$$\n让我们在积分中进行变量替换，令 $z = x-y$。这意味着 $y = x-z$ 且 $dy = dz$（因为雅可比行列式为 $1$ 且域是周期性的）。积分仍在同一域 $\\mathbb{T}^d$ 上进行。\n$$\n(K\\phi_k)(x) = \\int_{\\mathbb{T}^d} C(z) e^{2\\pi i k \\cdot (x-z)} dz\n$$\n我们可以从积分中提出依赖于 $x$ 的项：\n$$\n(K\\phi_k)(x) = e^{2\\pi i k \\cdot x} \\int_{\\mathbb{T}^d} C(z) e^{-2\\pi i k \\cdot z} dz\n$$\n右侧的积分是函数 $C(z)$ 对于模态 $k$ 的傅里叶级数系数的定义。我们将此系数定义为 $\\lambda_k$：\n$$\n\\lambda_k = \\int_{\\mathbb{T}^d} C(z) e^{-2\\pi i k \\cdot z} dz\n$$\n将其代回，我们得到：\n$$\n(K\\phi_k)(x) = \\lambda_k \\, e^{2\\pi i k \\cdot x} = \\lambda_k \\, \\phi_k(x)\n$$\n这证实了傅里叶模态 $\\phi_k(x)$ 确实是环面 $\\mathbb{T}^d$ 上任何平稳（卷积）算子的特征函数。对应的特征值 $\\lambda_k$ 是核函数（在此情况下为协方差函数 $C$）的傅里叶级数系数。由于对于实值随机场，协方差函数是实且偶的（$C(z) = C(-z)$），其傅里叶系数（即特征值 $\\lambda_k$）是实数且非负的。\n\n**算法设计与数值实现**\n\n该数值模型在 $[0,1]^d$ 上的一个均匀离散网格上实现，每个维度有 $N$ 个点，并采用周期性边界条件。\n\n1.  **离散协方差核 $C_h$**：连续协方差函数 $C(r)$ 在一个空间延迟网格上进行评估，该网格的结构对应于通过 FFT 进行离散循环卷积所需。对于大小为 $N_1 \\times \\dots \\times N_d$ 的网格，我们形成一个延迟向量 $(\\delta_1, \\dots, \\delta_d)$ 的网格，其中每个 $\\delta_i \\in [-0.5, 0.5)$。核在每个点的值是 $C(r)$，其中 $r = \\sqrt{\\delta_1^2 + \\dots + \\delta_d^2}$ 是延迟向量的欧几里得范数。这种构造确保了核是中心化的，并能正确处理周期性环绕。\n\n2.  **离散特征值与算子应用**：根据理论推导和离散傅里叶变换 (DFT) 的卷积定理，离散特征值是离散协方差核的 DFT：$\\hat{C}_h = \\mathcal{F}[C_h]$。与模态 $k$ 对应的特征值是 $\\lambda_k = \\hat{C}_{h,k}$。离散算子 $K_h$ 对网格函数 $f$ 的应用定义为 $(K_h f) = \\mathcal{F}^{-1}(\\mathcal{F}[C_h] \\cdot \\mathcal{F}[f])$。\n\n3.  **数值验证**：为了测试特征关系，我们在网格上生成一个离散傅里叶模态 $\\phi_k(x_j)=e^{2\\pi i k \\cdot x_j}$。然后，我们使用基于 FFT 的卷积计算 $K_h\\phi_k$。将结果与 $\\lambda_k \\phi_k$ 进行比较，其中 $\\lambda_k$ 是 $\\mathcal{F}[C_h]$ 的第 $k$ 个分量。计算相对 $\\ell^2$ 误差来量化其一致性，该误差应接近机器精度。\n\n4.  **高斯随机场采样**：一个均值为零、协方差为 $C$ 的实值高斯随机场 $a(x)$ 在傅里叶空间中合成。离散傅里叶系数 $\\hat{a}_k$ 的方差与特征值 $\\lambda_k$ 成正比：$\\mathbb{E}[|\\hat{a}_k|^2] = N_{\\text{tot}}\\lambda_k$，其中 $N_{\\text{tot}}$ 是网格点的总数。要生成实值场 $a(x)$，其傅里叶系数必须满足厄米共轭对称性：$\\hat{a}_k = \\overline{\\hat{a}_{-k}}$。该算法为每个唯一的频率模态生成由 $\\sqrt{N_{\\text{tot}}\\lambda_k}$ 缩放的复高斯随机变量，并强制执行此对称性。对于自共轭模态（如 $k=0$），系数必须是实数，并从实正态分布中采样。然后通过应用逆 FFT 获得场 $a(x)$。\n\n5.  **周期性亥姆霍兹求解器**：环面上的偏微分方程 $(I - \\beta\\Delta)u = a$ 在傅里叶空间中被高效求解。应用傅里叶变换得到 $(\\mathcal{F}[I] - \\beta\\mathcal{F}[\\Delta])\\hat{u} = \\hat{a}$。拉普拉斯算子 $-\\Delta$ 对模态 $k$ 的符号是 $(2\\pi \\|k_{\\text{phys}}\\|)^2$，其中 $k_{\\text{phys}}$ 是物理波矢。因此，傅里叶空间中的方程变为 $(1 + \\beta(2\\pi \\|k_{\\text{phys}}\\|)^2)\\hat{u}_k = \\hat{a}_k$。解的傅里叶系数通过除法求得：$\\hat{u}_k = \\hat{a}_k / (1 + \\beta(2\\pi \\|k_{\\text{phys}}\\|)^2)$。对 $\\hat{u}$ 进行逆 FFT 即可得到解 $u(x)$。通过将离散算子应用于数值解 $u$ 并将其与原始右端项 $a$ 进行比较来计算残差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the five specified tests and print the results in the required format.\n    The problem asks for several numerical validations related to the Karhunen-Loève expansion\n    of a stationary random field on a periodic domain, and the solution of a PDE with such a field as input.\n    \"\"\"\n\n    def get_covariance_kernel(d, N_dims, model, sigma, ell):\n        \"\"\"\n        Constructs the discrete, periodic covariance kernel C_h on a grid.\n        \n        The kernel is arranged for use with FFT for circular convolution. This means\n        the spatial lags are centered around the origin with periodic boundary conditions.\n        \"\"\"\n        if d == 1:\n            N = N_dims\n            lags = np.arange(N, dtype=float) / N\n            lags[lags >= 0.5] -= 1.0  # Lags in [-0.5, 0.5)\n            r = np.abs(lags)\n        elif d == 2:\n            N1, N2 = N_dims\n            lags1 = np.arange(N1, dtype=float) / N1\n            lags1[lags1 >= 0.5] -= 1.0\n            lags2 = np.arange(N2, dtype=float) / N2\n            lags2[lags2 >= 0.5] -= 1.0\n            L1, L2 = np.meshgrid(lags1, lags2, indexing='ij')\n            r = np.sqrt(L1**2 + L2**2)\n        else:\n            raise ValueError(\"Dimension d must be 1 or 2.\")\n            \n        if model == 'G': # Gaussian covariance model\n            return sigma**2 * np.exp(-r**2 / (2 * ell**2))\n        elif model == 'E': # Exponential covariance model\n            return sigma**2 * np.exp(-r / ell)\n        else:\n            raise ValueError(\"Unknown covariance model.\")\n\n    def get_fourier_mode(d, N_dims, k):\n        \"\"\"\n        Generates a discrete spatial Fourier mode exp(2*pi*i*k.x) on the grid.\n        \"\"\"\n        if d == 1:\n            N = N_dims\n            x = np.arange(N, dtype=float) / N\n            return np.exp(2j * np.pi * k * x)\n        elif d == 2:\n            N1, N2 = N_dims\n            x1 = np.arange(N1, dtype=float) / N1\n            x2 = np.arange(N2, dtype=float) / N2\n            X1, X2 = np.meshgrid(x1, x2, indexing='ij')\n            return np.exp(2j * np.pi * (k[0] * X1 + k[1] * X2))\n        else:\n            raise ValueError(\"Dimension d must be 1 or 2.\")\n            \n    def run_eigenmode_test(d, N_dims, model, sigma, ell, k):\n        \"\"\"\n        Performs the eigenmode consistency check for Tests 1, 2, and 3.\n        It computes ||K*phi_k - lambda_k*phi_k|| / ||lambda_k*phi_k||.\n        \"\"\"\n        C_h = get_covariance_kernel(d, N_dims, model, sigma, ell)\n        lambda_vals = np.fft.fftn(C_h)\n        \n        if d == 1:\n            lambda_k = lambda_vals[k]\n        else: # d == 2\n            lambda_k = lambda_vals[k[0], k[1]]\n            \n        phi_k = get_fourier_mode(d, N_dims, k)\n        \n        # As per problem statement, discrete operator K is defined via FFT\n        K_phi_k = np.fft.ifftn(lambda_vals * np.fft.fftn(phi_k))\n        target = lambda_k * phi_k\n        \n        err_norm = np.linalg.norm(K_phi_k - target)\n        target_norm = np.linalg.norm(target)\n        \n        # Avoid division by zero\n        if target_norm < 1e-15:\n            return 0.0 if err_norm < 1e-15 else np.inf\n        \n        return err_norm / target_norm\n\n    def sample_field(N1, N2, C_h, seed):\n        \"\"\"\n        Samples a real-valued Gaussian random field with a given covariance kernel C_h.\n        This is done by generating Fourier coefficients with appropriate variance and\n        Hermitian symmetry, then applying an inverse FFT.\n        \"\"\"\n        rng = np.random.default_rng(seed)\n        N_tot = N1 * N2\n        \n        lambda_vals = np.fft.fftn(C_h)\n        # Variance of Fourier coefficient k is N_tot * lambda_k\n        variances = N_tot * np.maximum(0, np.real(lambda_vals))\n        \n        hat_a = np.zeros((N1, N2), dtype=np.complex128)\n        \n        # Loop over half the frequency plane and enforce Hermitian symmetry\n        for i in range(N1):\n            for j in range(N2):\n                kp_i, kp_j = (-i % N1), (-j % N2)\n\n                if (i, j) > (kp_i, kp_j):\n                    continue\n                \n                var = variances[i, j]\n                if var < 1e-30: continue\n                std_dev = np.sqrt(var)\n\n                if (i, j) == (kp_i, kp_j):  # Self-conjugate modes must be real\n                    hat_a[i, j] = rng.normal(scale=std_dev)\n                else:  # Paired modes are complex conjugates\n                    std_dev_half = np.sqrt(var / 2.0)\n                    val = (rng.normal(scale=std_dev_half) + \n                           1j * rng.normal(scale=std_dev_half))\n                    hat_a[i, j] = val\n                    hat_a[kp_i, kp_j] = np.conj(val)\n\n        a = np.fft.ifftn(hat_a)\n        return a\n\n    def solve_helmholtz_and_get_residual(N1, N2, beta, a):\n        \"\"\"\n        Solves the Helmholtz equation (I - beta*Delta)u = a using Fourier diagonalization\n        and computes the relative residual norm.\n        \"\"\"\n        hat_a = np.fft.fftn(a)\n        \n        # Physical frequencies corresponding to FFT indices\n        freqs1 = np.fft.fftfreq(N1, d=1.0/N1)\n        freqs2 = np.fft.fftfreq(N2, d=1.0/N2)\n        K1, K2 = np.meshgrid(freqs1, freqs2, indexing='ij')\n        K_norm_sq = K1**2 + K2**2\n        \n        # Fourier symbol of the operator (I - beta * Delta)\n        M = 1.0 + beta * (2 * np.pi)**2 * K_norm_sq\n        \n        hat_u = hat_a / M\n        u = np.fft.ifftn(hat_u)\n        \n        # To compute residual, apply operator to numerical solution `u`\n        Au = np.fft.ifftn(M * np.fft.fftn(u))\n        residual = Au - a\n        \n        res_norm = np.linalg.norm(residual)\n        a_norm = np.linalg.norm(a)\n        \n        if a_norm < 1e-15:\n            return 0.0 if res_norm < 1e-15 else np.inf\n            \n        return res_norm / a_norm\n\n    results = []\n\n    # Test 1: 1D Gaussian eigenmode consistency\n    results.append(run_eigenmode_test(d=1, N_dims=64, model='G', sigma=1, ell=0.12, k=3))\n    \n    # Test 2: 1D Exponential eigenmode consistency\n    results.append(run_eigenmode_test(d=1, N_dims=64, model='E', sigma=1, ell=0.20, k=5))\n    \n    # Test 3: 2D Gaussian eigenmode consistency\n    results.append(run_eigenmode_test(d=2, N_dims=(32,32), model='G', sigma=1, ell=0.15, k=(2,3)))\n    \n    # Common setup for Tests 4 and 5\n    d_T4, N_dims_T4, model_T4, sigma_T4, ell_T4 = 2, (32,32), 'G', 1, 0.15\n    seed_T4 = 12345\n    C_h_T4 = get_covariance_kernel(d_T4, N_dims_T4, model_T4, sigma_T4, ell_T4)\n    a_field = sample_field(N_dims_T4[0], N_dims_T4[1], C_h_T4, seed_T4)\n    \n    # Test 4: Realness check of the sampled field\n    results.append(np.max(np.abs(np.imag(a_field))))\n    \n    # Test 5: Relative residual of the Helmholtz solver\n    beta_T5 = 0.01\n    results.append(solve_helmholtz_and_get_residual(N_dims_T4[0], N_dims_T4[1], beta_T5, a_field))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3413062"}, {"introduction": "数值近似是应用KL展开的核心，但它不可避免地会引入误差。本练习将从实现转向分析，要求您严格地量化基于有限元的KL近似的精度[@problem_id:3413059]。通过为计算出的特征值和特征函数推导显式误差界，并追踪这些误差对一个含随机系数的偏微分方程解的影响，您将对离散化选择如何影响不确定性量化模型的可靠性建立更深刻的理解。", "problem": "设 $D \\subset \\mathbb{R}^{d}$ 是一个有界Lipschitz域，并设 $k : D \\times D \\to \\mathbb{R}$ 是一个对称半正定核，其中对于某个整数 $s \\geq 2$，有 $k \\in W^{s,\\infty}(D \\times D)$。定义协方差算子 $C : L^{2}(D) \\to L^{2}(D)$ 为\n$$\n(C f)(x) = \\int_{D} k(x,y) f(y) \\, dy.\n$$\n假设 $C$ 是紧的、自伴的且非负的。设 $\\{ \\lambda_{n}, \\phi_{n} \\}_{n \\geq 1}$ 表示其特征对，特征值排序为 $\\lambda_{1} \\geq \\lambda_{2} \\geq \\cdots \\geq 0$，且 $\\{ \\phi_{n} \\}$ 构成 $L^{2}(D)$ 的一个标准正交基。假设 $\\lambda_{n}$ 是单的且孤立的，其谱隙为\n$$\n\\mathrm{gap}_{n} = \\min\\{ \\lambda_{n-1} - \\lambda_{n}, \\lambda_{n} - \\lambda_{n+1} \\} > 0,\n$$\n约定当 $n=1$ 时 $\\lambda_{0} = +\\infty$。\n\n设 $V_{h} \\subset L^{2}(D)$ 是在尺寸为 $h > 0$ 的拟一致、形状规则的网格上，由次数为 $p \\geq 1$ 的分片多项式构成的有限元空间。考虑在 $V_{h}$ 中对 $C$ 的特征问题进行Galerkin离散化，其中双线性形式\n$$\nb(u,v) = \\int_{D} \\int_{D} k(x,y) u(y) v(x) \\, dy \\, dx\n$$\n由一个在每对单元上对次数最高为 $q \\geq 1$ 的多项式精确的求积法则逐单元近似。将由此得到的基于求积的离散算子记为 $C_{h,q}$，并将其第 $n$ 个离散特征对记为 $\\{ \\lambda_{n}^{h,q}, \\phi_{n}^{h,q} \\in V_{h} \\}$，在 $L^{2}(D)$ 中归一化。假设存在一个谱污染参数 $\\delta_{\\mathrm{spec}} \\in [0,\\mathrm{gap}_{n})$，它量化了 $\\lambda_{n}$ 附近的伪离散特征值或未分辨簇在最坏情况下的邻近程度，因此可用于扰动界的有效谱隙为 $\\mathrm{gap}_{n} - \\delta_{\\mathrm{spec}}$。\n\n假设标准的有限元逼近性质和求积相合性成立：存在依赖于网格和核的正则性但独立于 $h$ 和 $q$ 的正常数 $c_{\\mathrm{approx}}$ 和 $c_{\\mathrm{quad}}$，使得算子范数离散误差满足\n$$\n\\| C - C_{h,q} \\|_{L^{2}(D) \\to L^{2}(D)} \\leq c_{\\mathrm{approx}} h^{p+1} + c_{\\mathrm{quad}} h^{q+1}.\n$$\n定义简记\n$$\n\\varepsilon(h,q) = c_{\\mathrm{approx}} h^{p+1} + c_{\\mathrm{quad}} h^{q+1}.\n$$\n\n接下来，为进行不确定性量化，考虑一个带随机系数的线性椭圆偏微分方程：求 $u(\\cdot,\\omega) \\in H^{1}_{0}(D)$ 使得\n$$\n- \\nabla \\cdot \\big( a(x,\\omega) \\nabla u(x,\\omega) \\big) = f(x) \\quad \\text{in } D, \\qquad u(\\cdot,\\omega)\\big|_{\\partial D} = 0,\n$$\n其中 $f \\in H^{-1}(D)$ 是确定的，基线 $a_{0} \\in L^{\\infty}(D)$ 是一致椭圆且有界的，满足 $0 < a_{\\min} \\leq a_{0}(x) \\leq a_{\\max} < \\infty$。随机扰动由一个截断的Karhunen–Loève (KL) 展开给出\n$$\na(x,\\omega) = a_{0}(x) + \\epsilon \\sum_{j=1}^{N} \\sqrt{\\lambda_{j}} \\, \\xi_{j}(\\omega) \\, \\phi_{j}(x),\n$$\n其中 $\\epsilon > 0$ 是一个固定的振幅参数，$\\{ \\xi_{j} \\}_{j=1}^{N}$ 是独立的标准正态随机变量。数值模型在截断的KL展开中使用离散特征对，\n$$\na^{h,q}(x,\\omega) = a_{0}(x) + \\epsilon \\sum_{j=1}^{N} \\sqrt{\\lambda_{j}^{h,q}} \\, \\xi_{j}(\\omega) \\, \\phi_{j}^{h,q}(x).\n$$\n假设将 $a$ 映射到 $u$ 的解算子是从 $L^{2}(D)$到 $H^{1}_{0}(D)$ 的Lipschitz映射，其常数为 $c_{\\mathrm{map}} > 0$，即\n$$\n\\big\\| u(\\cdot;\\,a) - u(\\cdot;\\,a') \\big\\|_{H^{1}_{0}(D)} \\leq c_{\\mathrm{map}} \\, \\| a - a' \\|_{L^{2}(D)} \\quad \\text{for all admissible } a,a'.\n$$\n令 $\\lambda_{*} = \\min_{1 \\leq j \\leq N} \\lambda_{j} > 0$ 且 $g_{*} = \\min_{1 \\leq j \\leq N} \\big( \\mathrm{gap}_{j} - \\delta_{\\mathrm{spec}} \\big) > 0$。\n\n从紧自伴算子的谱理论、Galerkin有限元逼近性质以及不变子空间的经典扰动界出发，推导出以下各项的显式解析表达式：\n1) 第 $n$ 个模态的特征值误差的一个上界，用 $\\varepsilon(h,q)$ 表示。\n2) 第 $n$ 个模态的特征函数误差的 $L^{2}(D)$-范数的一个上界，用 $\\varepsilon(h,q)$ 和有效谱隙 $\\mathrm{gap}_{n} - \\delta_{\\mathrm{spec}}$ 表示。\n3) $u(\\cdot,\\omega)$ 和 $u^{h,q}(\\cdot,\\omega)$ 之间 $H^{1}_{0}(D)$-误差的均方根的一个上界，用 $\\varepsilon(h,q)$、$c_{\\mathrm{map}}$、$\\epsilon$、集合 $\\{ \\lambda_{j} \\}_{j=1}^{N}$ 以及 $\\lambda_{*}$ 和 $g_{*}$ 表示。\n\n你的最终答案必须是这三个界的解析表达式，以单个行向量的形式呈现。最终答案中不要包含不等式或等式；只将这三个界表达式本身作为读者可以进行符号求值的闭式表达式呈现。不需要进行四舍五入。", "solution": "该问题被评估为有效，因为它具有科学依据、是适定且客观的，并且处于泛函分析、数值分析和不确定性量化的标准数学框架内。严格推导所需的所有必要组成部分均已提供。\n\n该问题要求给出与协方差算子特征问题的Galerkin有限元逼近及其在带随机系数的偏微分方程中的应用相关的三个不同的上界。设 $\\varepsilon(h,q) = c_{\\mathrm{approx}} h^{p+1} + c_{\\mathrm{quad}} h^{q+1}$ 表示所提供的离散误差算子范数的界，$\\|C - C_{h,q}\\|_{L^{2}(D) \\to L^{2}(D)} \\leq \\varepsilon(h,q)$。\n\n**1) 特征值误差 $|\\lambda_{n} - \\lambda_{n}^{h,q}|$ 的上界**\n\n这个界是自伴算子Weyl不等式的直接推论。设 $C$ 和 $C_{h,q}$ 是 $L^2(D)$ 上的两个自伴算子。Courant-Fischer-Weyl极小极大原理指出，对于任意 $n \\geq 1$，算子 $A$ 的第 $n$ 个特征值 $\\lambda_n$ 可以被刻画。其一个推论是，如果 $A' = A+E$，则 $|\\lambda_n(A) - \\lambda_n(A')| \\le \\|E\\|$。\n\n在我们的情况中，可以设 $A=C$ 和 $A'=C_{h,q}$。扰动为 $E = C_{h,q} - C$。问题提供了算子范数界 $\\|E\\|_{L^{2}(D) \\to L^{2}(D)} \\leq \\varepsilon(h,q)$。\n直接应用该不等式即可得到特征值误差的界：\n$$\n|\\lambda_{n} - \\lambda_{n}^{h,q}| \\leq \\|C - C_{h,q}\\|_{L^{2}(D) \\to L^{2}(D)} \\leq \\varepsilon(h,q).\n$$\n因此，第一个要求的上界是 $\\varepsilon(h,q)$。\n\n**2) 特征函数误差 $\\|\\phi_{n} - \\phi_{n}^{h,q}\\|_{L^2(D)}$ 的上界**\n\n这需要一个不变子空间的扰动界，对于单特征值，该子空间即对应于特征函数。扰动理论中的一个标准结果，通常是Davis-Kahan定理的一个推论，给出了 $\\sin\\theta_n$ 的界。\n\n让我们考虑近似特征对相对于精确算子 $C$ 的残差。我们有 $C_{h,q}\\phi_{n}^{h,q} = \\lambda_{n}^{h,q}\\phi_{n}^{h,q}$。\n然后，$C\\phi_{n}^{h,q} - \\lambda_n \\phi_{n}^{h,q} = (C - C_{h,q})\\phi_{n}^{h,q} + (C_{h,q} - \\lambda_n)\\phi_{n}^{h,q} = (C - C_{h,q})\\phi_{n}^{h,q} + (\\lambda_{n}^{h,q} - \\lambda_n)\\phi_{n}^{h,q}$。\n称此残差为 $R_n$。其范数由以下不等式为界：\n$$\n\\|R_n\\|_{L^2(D)} \\leq \\|C - C_{h,q}\\| \\|\\phi_{n}^{h,q}\\| + |\\lambda_{n}^{h,q} - \\lambda_n| \\|\\phi_{n}^{h,q}\\|.\n$$\n使用 $\\|\\phi_n^{h,q}\\|=1$ 和第一部分的结果，我们得到：\n$$\n\\|R_n\\|_{L^2(D)} \\leq \\varepsilon(h,q) + \\varepsilon(h,q) = 2\\varepsilon(h,q).\n$$\n$\\phi_{n}^{h,q}$ 正交于 $\\phi_n$ 的分量，记为 $\\delta_n$，可以用此残差来界定。设 $P_n$ 是到 $\\phi_n$ 生成空间上的谱投影。则 $\\delta_n = (I-P_n)\\phi_n^{h,q}$。这两个函数之间夹角的正弦是 $\\|\\delta_n\\|_{L^2(D)} = \\sin\\theta_n$。\n一个标准的界给出 $\\sin\\theta_n \\le \\|R_n\\|_{L^2(D)} / (\\mathrm{gap}_n - |\\lambda_n - \\tilde{\\lambda}_n|)$，其中 $\\tilde{\\lambda}_n$ 是Rayleigh商。使用所提供的有效谱隙，这简化为：\n$$\n\\sin\\theta_n \\leq \\frac{\\|R_n\\|_{L^2(D)}}{\\mathrm{gap}_{n} - \\delta_{\\mathrm{spec}}} \\leq \\frac{2\\varepsilon(h,q)}{\\mathrm{gap}_{n} - \\delta_{\\mathrm{spec}}}.\n$$\n问题要求 $\\|\\phi_{n} - \\phi_{n}^{h,q}\\|_{L^2(D)}$ 的界。假设为 $\\phi_n^{h,q}$ 选择了适当的相位以使得 $(\\phi_n, \\phi_n^{h,q}) \\ge 0$，则误差范数与夹角 $\\theta_n$ 的关系为 $\\|\\phi_{n} - \\phi_{n}^{h,q}\\|_{L^2(D)} = 2\\sin(\\theta_n/2)$。\n对于 $\\theta_n \\in [0, \\pi/2]$，使用不等式 $2\\sin(\\theta_n/2) \\leq \\sqrt{2} \\sin\\theta_n$，我们得到：\n$$\n\\|\\phi_{n} - \\phi_{n}^{h,q}\\|_{L^2(D)} \\leq \\sqrt{2} \\sin\\theta_n \\leq \\frac{2\\sqrt{2}\\varepsilon(h,q)}{\\mathrm{gap}_{n} - \\delta_{\\mathrm{spec}}}.\n$$\n这就给出了第二个要求的界。\n\n**3) $H^{1}_{0}(D)$-误差的均方根上界**\n\n需要界定的量是 $E = \\left( \\mathbb{E} \\left[ \\| u(\\cdot, \\omega) - u^{h,q}(\\cdot, \\omega) \\|_{H_0^1(D)}^2 \\right] \\right)^{1/2}$。\n使用所提供的将系数场 $a$ 映射到解 $u$ 的解算子的Lipschitz连续性：\n$$\n\\| u(\\cdot, \\omega) - u^{h,q}(\\cdot, \\omega) \\|_{H_0^1(D)} \\leq c_{\\mathrm{map}} \\| a(\\cdot, \\omega) - a^{h,q}(\\cdot, \\omega) \\|_{L^2(D)}.\n$$\n两边平方，取期望，然后取平方根，得到：\n$$\nE \\leq c_{\\mathrm{map}} \\left( \\mathbb{E} \\left[ \\| a(\\cdot, \\omega) - a^{h,q}(\\cdot, \\omega) \\|_{L^2(D)}^2 \\right] \\right)^{1/2}.\n$$\n系数场中的误差为：\n$$\na(\\cdot, \\omega) - a^{h,q}(\\cdot, \\omega) = \\epsilon \\sum_{j=1}^{N} \\xi_{j}(\\omega) \\left( \\sqrt{\\lambda_{j}} \\phi_{j}(x) - \\sqrt{\\lambda_{j}^{h,q}} \\phi_{j}^{h,q}(x) \\right).\n$$\n令 $e_j(x) = \\sqrt{\\lambda_{j}} \\phi_{j}(x) - \\sqrt{\\lambda_{j}^{h,q}} \\phi_{j}^{h,q}(x)$。误差的 $L^2(D)$-范数平方为\n$$\n\\|a - a^{h,q}\\|_{L^2(D)}^2 = \\epsilon^2 \\left\\| \\sum_{j=1}^{N} \\xi_j(\\omega) e_j(x) \\right\\|_{L^2(D)}^2 = \\epsilon^2 \\sum_{j=1}^{N} \\sum_{k=1}^{N} \\xi_j(\\omega)\\xi_k(\\omega) (e_j, e_k)_{L^2(D)}.\n$$\n取期望并使用独立同分布标准正态变量的性质 $\\mathbb{E}[\\xi_j \\xi_k] = \\delta_{jk}$，我们得到：\n$$\n\\mathbb{E}\\left[ \\|a - a^{h,q}\\|_{L^2(D)}^2 \\right] = \\epsilon^2 \\sum_{j=1}^{N} \\|e_j\\|_{L^2(D)}^2.\n$$\n对于每个 $j \\in \\{1, \\dots, N\\}$，我们使用三角不等式来界定 $\\|e_j\\|_{L^2(D)}$：\n$$\n\\|e_j\\|_{L^2(D)} = \\|\\sqrt{\\lambda_{j}} \\phi_{j} - \\sqrt{\\lambda_{j}^{h,q}} \\phi_{j}^{h,q}\\| \\leq \\|\\sqrt{\\lambda_{j}} (\\phi_{j} - \\phi_{j}^{h,q})\\| + \\|(\\sqrt{\\lambda_{j}} - \\sqrt{\\lambda_{j}^{h,q}}) \\phi_{j}^{h,q}\\|.\n$$\n这简化为 $\\|e_j\\|_{L^2(D)} \\leq \\sqrt{\\lambda_j} \\|\\phi_{j} - \\phi_{j}^{h,q}\\| + |\\sqrt{\\lambda_{j}} - \\sqrt{\\lambda_{j}^{h,q}}|$。\n我们使用第1部分和第2部分的界。对于第二项，\n$$\n|\\sqrt{\\lambda_{j}} - \\sqrt{\\lambda_{j}^{h,q}}| = \\frac{|\\lambda_{j} - \\lambda_{j}^{h,q}|}{\\sqrt{\\lambda_{j}} + \\sqrt{\\lambda_{j}^{h,q}}} \\leq \\frac{\\varepsilon(h,q)}{\\sqrt{\\lambda_{j}}},\n$$\n其中我们使用了 $|\\lambda_{j} - \\lambda_{j}^{h,q}| \\leq \\varepsilon(h,q)$ 和 $\\sqrt{\\lambda_{j}} + \\sqrt{\\lambda_{j}^{h,q}} \\geq \\sqrt{\\lambda_{j}}$。假设 $\\lambda_* > 0$ 确保了 $\\lambda_j > 0$。\n代入特征函数和特征值误差的界：\n$$\n\\|e_j\\|_{L^2(D)} \\leq \\sqrt{\\lambda_j} \\left( \\frac{2\\sqrt{2}\\varepsilon(h,q)}{\\mathrm{gap}_{j} - \\delta_{\\mathrm{spec}}} \\right) + \\frac{\\varepsilon(h,q)}{\\sqrt{\\lambda_j}} = \\varepsilon(h,q) \\left( \\frac{2\\sqrt{2}\\sqrt{\\lambda_j}}{\\mathrm{gap}_{j} - \\delta_{\\mathrm{spec}}} + \\frac{1}{\\sqrt{\\lambda_j}} \\right).\n$$\n将此代入均方根误差 $E$ 的表达式中：\n$$\nE \\leq c_{\\mathrm{map}} \\epsilon \\left( \\sum_{j=1}^{N} \\left[ \\varepsilon(h,q) \\left( \\frac{2\\sqrt{2}\\sqrt{\\lambda_j}}{\\mathrm{gap}_{j} - \\delta_{\\mathrm{spec}}} + \\frac{1}{\\sqrt{\\lambda_j}} \\right) \\right]^2 \\right)^{1/2}.\n$$\n提出公因子 $\\varepsilon(h,q)$ 即可得到第三个界的最终表达式：", "answer": "$$\n\\boxed{\\begin{pmatrix} \\varepsilon(h,q) & \\frac{2\\sqrt{2}\\varepsilon(h,q)}{\\mathrm{gap}_n - \\delta_{\\mathrm{spec}}} & c_{\\mathrm{map}} \\epsilon \\varepsilon(h,q) \\left( \\sum_{j=1}^{N} \\left( \\frac{2\\sqrt{2}\\sqrt{\\lambda_j}}{\\mathrm{gap}_{j} - \\delta_{\\mathrm{spec}}} + \\frac{1}{\\sqrt{\\lambda_j}} \\right)^2 \\right)^{1/2} \\end{pmatrix}}\n$$", "id": "3413059"}]}