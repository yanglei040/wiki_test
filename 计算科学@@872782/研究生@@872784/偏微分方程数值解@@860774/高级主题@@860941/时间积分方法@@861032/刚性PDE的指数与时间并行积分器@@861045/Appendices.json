{"hands_on_practices": [{"introduction": "在我们深入研究指数积分法之前，首先必须理解为什么需要它们。本练习 [@problem_id:3389653] 通过一个经典案例——热传导方程——揭示了传统显式方法在求解刚性问题时遇到的困境。通过从第一性原理出发推导显式欧拉法的稳定性条件，您将亲手量化数值刚性带来的挑战，从而深刻体会到发展更高级积分方法的必要性。", "problem": "考虑一维热方程 $u_{t}=\\nu u_{xx}$，其中扩散系数 $\\nu0$ 为常数，该方程定义在周期性域 $[0,L]$ 上，并具有周期性边界条件。设一个包含 $N$ 个点的均匀空间网格由 $x_{j}=j h$ 定义，其中 $j=0,1,\\dots,N-1$，$h=L/N$。设 $u_{j}(t)\\approx u(x_{j},t)$。二阶中心差分半离散化得到线性自治系统 $\\frac{d}{dt}u_{j}(t)=\\nu\\,\\frac{u_{j-1}(t)-2u_{j}(t)+u_{j+1}(t)}{h^{2}}$，其中索引是周期性的。将离散拉普拉斯算子记为 $L_{h}$，从而半离散系统为 $\\mathbf{u}'(t)=\\nu L_{h}\\mathbf{u}(t)$。\n  \n要求你从以下基本定义和经过验证的事实出发：(i) 均匀周期网格上的循环矩阵可由离散傅里叶模对角化，(ii) 应用于线性系统 $\\mathbf{y}'=A\\mathbf{y}$ 的显式欧拉法产生放大矩阵 $I+\\Delta t\\,A$，以及 (iii) 对于正规矩阵，该方法的线性稳定性简化为要求 $I+\\Delta t\\,A$ 的谱半径不超过 $1$。不要假设任何预先制定的特征值公式；从这些基础出发推导所需内容。\n\n任务：\n  \n1. 通过分析其对离散傅里叶模的作用，计算 $L_{h}$ 的全套特征值。\n2. 使用时间步长为 $\\Delta t$ 的显式欧拉法，推导出形如 $\\Delta t\\leq C\\,h^{2}/\\nu$ 的线性稳定性约束，该约束保证周期网格上所有空间模的稳定性。\n3. 确定满足此界限的最小常数 $C$（与 $N$、$h$、$L$ 和 $\\nu$ 无关），适用于所有 $N\\geq 2$。\n\n以 $C$ 的精确值形式提供最终答案。无需四舍五入。最终答案中不要包含单位。答案必须是单个数字或单个闭式解析表达式。", "solution": "该问题经检验在科学上是合理的、适定的和自洽的。所提供的信息对于推导唯一解是充分且一致的。我们按照三个指定的任务进行求解。\n\n在周期域 $[0,L]$ 上的热方程 $u_{t}=\\nu u_{xx}$ 的半离散化由以下常微分方程组给出：\n$$\n\\frac{d}{dt}u_{j}(t)=\\nu\\,\\frac{u_{j-1}(t)-2u_{j}(t)+u_{j+1}(t)}{h^{2}}\n$$\n对于 $j=0,1,\\dots,N-1$，网格间距为 $h=L/N$，并采用周期性索引（即 $u_{-1}=u_{N-1}$ 和 $u_{N}=u_{0}$）。该系统可以写成矩阵形式 $\\mathbf{u}'(t)=\\nu L_{h}\\mathbf{u}(t)$，其中 $\\mathbf{u}(t) = [u_0(t), u_1(t), \\dots, u_{N-1}(t)]^T$，而 $L_h$ 是周期网格上二阶中心差分算子的矩阵表示。$L_h$ 对向量 $\\mathbf{v}$ 的作用是 $(L_h \\mathbf{v})_j = \\frac{1}{h^2}(v_{j-1} - 2v_j + v_{j+1})$。这种结构使 $L_h$ 成为一个循环矩阵。\n\n**任务 1：计算 $L_h$ 的特征值。**\n\n根据所提供的信息，均匀周期网格上的循环矩阵可由离散傅里叶模对角化。一个 $N \\times N$ 循环矩阵的特征向量是向量 $\\mathbf{w}^{(k)}$（$k=0, 1, \\dots, N-1$），其分量由下式给出：\n$$\nw_j^{(k)} = \\exp\\left(i \\frac{2\\pi k j}{N}\\right) \\quad \\text{for } j=0, 1, \\dots, N-1\n$$\n为了找到与特征向量 $\\mathbf{w}^{(k)}$ 对应的特征值 $\\lambda_k$，我们将算子 $L_h$ 作用于 $\\mathbf{w}^{(k)}$：\n$$\n(L_h \\mathbf{w}^{(k)})_j = \\frac{1}{h^2} \\left( w_{j-1}^{(k)} - 2w_j^{(k)} + w_{j+1}^{(k)} \\right)\n$$\n代入 $w_j^{(k)}$ 的表达式：\n$$\n(L_h \\mathbf{w}^{(k)})_j = \\frac{1}{h^2} \\left( \\exp\\left(i \\frac{2\\pi k(j-1)}{N}\\right) - 2\\exp\\left(i \\frac{2\\pi k j}{N}\\right) + \\exp\\left(i \\frac{2\\pi k(j+1)}{N}\\right) \\right)\n$$\n我们可以提出公因子 $\\exp(i \\frac{2\\pi k j}{N}) = w_j^{(k)}$：\n$$\n(L_h \\mathbf{w}^{(k)})_j = \\frac{1}{h^2} \\exp\\left(i \\frac{2\\pi k j}{N}\\right) \\left( \\exp\\left(-i \\frac{2\\pi k}{N}\\right) - 2 + \\exp\\left(i \\frac{2\\pi k}{N}\\right) \\right)\n$$\n使用欧拉公式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，括号中的项变为 $2\\cos\\left(\\frac{2\\pi k}{N}\\right) - 2$。\n$$\n(L_h \\mathbf{w}^{(k)})_j = \\frac{1}{h^2} w_j^{(k)} \\left( 2\\cos\\left(\\frac{2\\pi k}{N}\\right) - 2 \\right) = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi k}{N}\\right) - 1 \\right) w_j^{(k)}\n$$\n这是一个形如 $L_h \\mathbf{w}^{(k)} = \\lambda_k \\mathbf{w}^{(k)}$ 的特征值方程。特征值 $\\lambda_k$ 是：\n$$\n\\lambda_k = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi k}{N}\\right) - 1 \\right)\n$$\n使用半角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，并令 $\\theta = \\frac{\\pi k}{N}$，我们可以简化 $\\lambda_k$ 的表达式：\n$$\n\\lambda_k = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi k}{N}\\right)\n$$\n$L_h$ 的全套特征值由该公式给出，其中 $k=0, 1, \\dots, N-1$。\n\n**任务 2：推导线性稳定性约束。**\n\n半离散系统为 $\\mathbf{u}'(t) = A\\mathbf{u}(t)$，其中 $A = \\nu L_h$。$A$ 的特征值为 $\\mu_k = \\nu \\lambda_k = -\\frac{4\\nu}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right)$。由于 $L_h$ 是一个实对称循环矩阵，所以它是正规矩阵，因此 $A$ 也是正规的。\n\n应用时间步长为 $\\Delta t$ 的显式欧拉法，得到迭代格式：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t A \\mathbf{u}^n = (I + \\Delta t A) \\mathbf{u}^n\n$$\n放大矩阵为 $G = I + \\Delta t A$。对于正规矩阵 $A$，稳定性条件是 $G$ 的谱半径不得超过 $1$，即 $\\rho(G) \\le 1$。\n$G$ 的特征值记为 $g_k$，与 $A$ 的特征值通过 $g_k = 1 + \\Delta t \\mu_k$ 相关联。\n$$\ng_k = 1 - \\frac{4\\nu\\Delta t}{h^2}\\sin^2\\left(\\frac\\pi k}{N}\\right)\n$$\n由于 $\\mu_k$ 是实数，特征值 $g_k$ 也是实数。稳定性条件 $\\rho(G) \\le 1$ 简化为对所有 $k=0, 1, \\dots, N-1$ 都有 $|g_k| \\le 1$。这等价于两个不等式 $-1 \\le g_k \\le 1$。\n\n第一个不等式，$g_k \\le 1$：\n$$\n1 - \\frac{4\\nu\\Delta t}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\le 1 \\implies -\\frac{4\\nu\\Delta t}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\le 0\n$$\n由于 $\\nu  0$，$\\Delta t  0$，$h^2  0$ 且 $\\sin^2(\\cdot) \\ge 0$，该不等式恒成立。\n\n第二个不等式，$g_k \\ge -1$：\n$$\n1 - \\frac{4\\nu\\Delta t}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\ge -1 \\implies 2 \\ge \\frac{4\\nu\\Delta t}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right)\n$$\n对 $\\Delta t$ 求解，我们得到：\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu\\sin^2\\left(\\frac{\\pi k}{N}\\right)} = \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{\\pi k}{N}\\right)}\n$$\n该不等式必须对所有模 $k=0, 1, \\dots, N-1$ 成立。对于 $k=0$，$\\sin^2(0) = 0$，右侧无定义（或无穷大），这对 $\\Delta t$ 没有限制。这对应于常数模（平均值），它总是稳定的。对于所有其他模（$k=1, \\dots, N-1$），该条件必须被满足。为确保这一点，$\\Delta t$ 必须小于或等于这些上界的最小值：\n$$\n\\Delta t \\le \\min_{k=1,\\dots,N-1} \\left( \\frac{h^2}{2\\nu\\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\right) = \\frac{h^2}{2\\nu \\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)}\n$$\n这是对于一个给定的含 $N$ 个点的网格的一般稳定性约束。\n\n**任务 3：确定最小常数 $C$。**\n\n我们寻求一个常数 $C$，使得稳定性约束 $\\Delta t \\le C \\frac{h^2}{\\nu}$ 对所有 $N \\ge 2$ 成立。这需要找到一个对所有可能的网格配置都有效的 $C$ 值。一个普适的稳定性判据必须至少与对任何特定 $N$ 的条件一样严格。因此，为了使我们推导的条件得到满足，我们需要：\n$$\nC \\frac{h^2}{\\nu} \\le \\frac{h^2}{2\\nu \\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)}\n$$\n对所有 $N \\ge 2$ 成立。这可以简化为：\n$$\nC \\le \\frac{1}{2 \\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)}\n$$\n为使此式对所有 $N \\ge 2$ 都成立，$C$ 必须小于或等于右侧在所有 $N \\ge 2$ 上的下确界：\n$$\nC \\le \\inf_{N \\ge 2} \\left( \\frac{1}{2 \\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)} \\right) = \\frac{1}{2 \\sup_{N \\ge 2} \\left(\\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)\\right)}\n$$\n我们来分析 $S_N = \\max_{k=1,\\dots,N-1} \\sin^2\\left(\\frac{\\pi k}{N}\\right)$ 这一项。自变量 $\\frac{\\pi k}{N}$ 的范围是从 $\\frac{\\pi}{N}$ 到 $\\frac{\\pi(N-1)}{N}$。函数 $\\sin^2(x)$ 在 $x=\\pi/2$ 处取得最大值 $1$。\n- 如果 $N$ 是偶数，我们可以写成 $N=2M$，其中 $M \\ge 1$ 是某个整数。对于模 $k=M$，自变量为 $\\frac{\\pi M}{2M} = \\frac{\\pi}{2}$。因此，$\\sin^2(\\frac{\\pi}{2}) = 1$。在这种情况下，$S_N = 1$。这对所有偶数 $N \\ge 2$ 都成立。\n- 如果 $N$ 是奇数，$k$ 永远不可能是 $N/2$。$\\sin^2\\left(\\frac{\\pi k}{N}\\right)$ 的最大值出现在最接近 $N/2$ 的整数 $k$ 处，即 $k=(N-1)/2$ 和 $k=(N+1)/2$。对于这些值，最大值为 $\\cos^2\\left(\\frac{\\pi}{2N}\\right)$，它严格小于 $1$，但随着 $N \\to \\infty$ 而趋近于 $1$。\n\n数值序列 $\\{S_N\\}_{N \\ge 2}$ 是 $\\{1, 3/4, 1, \\cos^2(\\pi/10), 1, \\dots\\}$。该序列的上确界是：\n$$\n\\sup_{N \\ge 2} S_N = 1\n$$\n对于任何偶数 $N$ 都能达到这个上确界。\n将此代入我们关于 $C$ 的不等式中：\n$$\nC \\le \\frac{1}{2 \\times 1} = \\frac{1}{2}\n$$\n问题要求的是“满足此界限的最小常数 $C$”。这是数值分析中的一个标准术语，虽然可能有点令人困惑，它指的是最尖锐的可能常数，即能使稳定性条件普遍成立的 $C$ 的最大值。任何 $C  1/2$ 都会导致对任何偶数 $N$（例如，对于模 $k=N/2$）的稳定性条件被违反。因此，保证对所有 $N \\ge 2$ 都稳定的 $C$ 的最大可能值为 $1/2$。这是稳定性系数 $C_N = 1/(2S_N)$ 在所有 $N \\ge 2$ 中的最小值。\n\n因此，对任何 $N \\ge 2$ 都有效的最严格的稳定性约束是 $\\Delta t \\le \\frac{1}{2}\\frac{h^2}{\\nu}$。常数 $C$ 是 $1/2$。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3389653"}, {"introduction": "理解了刚性问题的挑战后，我们来亲手实践指数积分法最核心的思想：精确求解系统的线性部分。本练习 [@problem_id:3389682] 将一个抽象的概念转化为一个具体的计算任务。通过对一个小型离散拉普拉斯算子进行特征分解，您将精确计算出矩阵指数的作用，并将其与简单的泰勒级数近似进行比较，从而直观地把握指数积分法在处理刚性算子时的优势。", "problem": "考虑一维热方程 $\\partial_{t} u = \\partial_{xx} u$ 在 $x=0$ 和 $x=1$ 处具有齐次狄利克雷边界条件的空间半离散化，使用 $n=3$ 个内部网格点和单位网格间距。这产生一个刚性线性常微分方程(ODE)组 $\\dot{y}(t) = L y(t)$，其算子 $L$ 是对称负定的，并且是负的离散拉普拉斯算子。具体来说，令\n$$\nL \\;=\\; -\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n指数积分法通过 $y(t+\\Delta t) = \\exp(\\Delta t L)\\, y(t)$ 精确地推进线性问题的解。在像 Parareal 这样的时间并行方法中，一个简单的粗糙传播子可以由矩阵指数的截断泰勒级数构成。\n\n使用谱定理和 $L$ 的标准正交特征分解，计算对于数据 $v = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$ 和 $\\Delta t = 0.8$ 的精确传播向量 $\\exp(\\Delta t L)\\, v$，不使用任何快捷公式。然后，构造指数作用的三阶截断泰勒近似，\n$$\ny_{\\mathrm{tay}} \\;=\\; \\left(I + \\Delta t L + \\frac{\\Delta t^{2}}{2} L^{2} + \\frac{\\Delta t^{3}}{6} L^{3}\\right) v,\n$$\n并计算误差的欧几里得范数 $\\| \\exp(\\Delta t L)\\, v - y_{\\mathrm{tay}} \\|_{2}$。将您的最终数值四舍五入到五位有效数字。答案以纯数字形式表示（无单位）。", "solution": "用户希望计算一个 ODE 系统精确解与其三阶泰勒近似解之间误差的欧几里得范数。\n\n### 第一步：提取已知条件\n- ODE 系统为 $\\dot{y}(t) = L y(t)$。\n- 算子 $L$ 由以下矩阵给出：\n$$\nL = -\\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix} = \\begin{pmatrix} -2  1  0 \\\\ 1  -2  1 \\\\ 0  1  -2 \\end{pmatrix}\n$$\n- 初始数据向量为 $v = y(t_0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$。\n- 时间步长为 $\\Delta t = 0.8$。\n- 精确传播后的向量为 $y_{\\mathrm{exact}} = \\exp(\\Delta t L) v$。\n- 三阶泰勒近似为 $y_{\\mathrm{tay}} = \\left(I + \\Delta t L + \\frac{\\Delta t^{2}}{2} L^{2} + \\frac{\\Delta t^{3}}{6} L^{3}\\right) v$。\n- 任务是计算 $\\| y_{\\mathrm{exact}} - y_{\\mathrm{tay}} \\|_{2}$ 并将结果四舍五入到五位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是数值线性代数和常微分方程数值解中的一个明确定义的练习。\n- **科学依据：** 该问题使用了标准概念：用于线性 ODE 精确解的矩阵指数、泰勒级数近似以及用于矩阵函数的谱定理。矩阵 $L$ 是一维离散拉普拉斯算子的有效表示，后者是刚性 ODE 的常见来源。该问题是研究指数积分法时的标准设置。所有前提在事实上和数学上都是合理的。\n- **适定性：** 所有必要的数据（$L$、$v$、$\\Delta t$）都已提供。指令清晰，可得唯一数值答案。\n- **客观性：** 问题以精确的数学语言陈述，没有歧义或主观论断。\n\n### 第三步：结论与行动\n该问题有效。将继续进行求解。\n\n### 第一部分：计算精确解 $y_{\\mathrm{exact}}$\n\n该问题要求使用 $L$ 的谱分解。我们有 $L = QDQ^T$，其中 $Q$ 是特征向量构成的标准正交矩阵，$D$ 是特征值构成的对角矩阵。那么 $\\exp(\\Delta t L) = Q \\exp(\\Delta t D) Q^T$。精确解为 $y_{\\mathrm{exact}} = Q \\exp(\\Delta t D) Q^T v$。\n\n首先，我们求出 $L$ 的特征值和特征向量。矩阵 $L$ 是一个对称的托普利茨矩阵。相关正定矩阵 $-L$ 的特征值为 $\\lambda_k' = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right)$，其中 $k=1, 2, ..., n$，$n=3$。\n- $k=1$: $\\lambda_1' = 2 - 2\\cos(\\pi/4) = 2 - \\sqrt{2}$。\n- $k=2$: $\\lambda_2' = 2 - 2\\cos(\\pi/2) = 2$。\n- $k=3$: $\\lambda_3' = 2 - 2\\cos(3\\pi/4) = 2 + \\sqrt{2}$。\n\n$L$ 的特征值为 $\\lambda_k = -\\lambda_k'$。\n- $\\lambda_1 = -2 + \\sqrt{2}$\n- $\\lambda_2 = -2$\n- $\\lambda_3 = -2 - \\sqrt{2}$\n特征值对角矩阵为 $D = \\mathrm{diag}(-2+\\sqrt{2}, -2, -2-\\sqrt{2})$。\n\n对应的未归一化特征向量的分量为 $v_{k,j} = \\sin\\left(\\frac{jk\\pi}{n+1}\\right)$，其中 $j=1, 2, 3$。将这些向量归一化得到 $Q$ 的列向量。\n- 对于 $k=1$: $q_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} \\sin(\\pi/4) \\\\ \\sin(2\\pi/4) \\\\ \\sin(3\\pi/4) \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/\\sqrt{2} \\\\ 1/2 \\end{pmatrix}$。\n- 对于 $k=2$: $q_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} \\sin(2\\pi/4) \\\\ \\sin(4\\pi/4) \\\\ \\sin(6\\pi/4) \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ 0 \\\\ -1/\\sqrt{2} \\end{pmatrix}$。\n- 对于 $k=3$: $q_3 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} \\sin(3\\pi/4) \\\\ \\sin(6\\pi/4) \\\\ \\sin(9\\pi/4) \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -1/\\sqrt{2} \\\\ 1/2 \\end{pmatrix}$。\n\n特征向量矩阵为 $Q = \\begin{pmatrix} 1/2  1/\\sqrt{2}  1/2 \\\\ 1/\\sqrt{2}  0  -1/\\sqrt{2} \\\\ 1/2  -1/\\sqrt{2}  1/2 \\end{pmatrix}$。注意 $Q$ 是对称的，所以 $Q^T=Q$。\n\n接下来，我们计算 $v$ 在特征基上的投影，$c = Q^T v = Qv$。\n$c = \\begin{pmatrix} 1/2  1/\\sqrt{2}  1/2 \\\\ 1/\\sqrt{2}  0  -1/\\sqrt{2} \\\\ 1/2  -1/\\sqrt{2}  1/2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1/2 + 2/\\sqrt{2} + 3/2 \\\\ 1/\\sqrt{2} - 3/\\sqrt{2} \\\\ 1/2 - 2/\\sqrt{2} + 3/2 \\end{pmatrix} = \\begin{pmatrix} 2 + \\sqrt{2} \\\\ -\\sqrt{2} \\\\ 2 - \\sqrt{2} \\end{pmatrix}$。\n\n现在我们可以写出 $y_{\\mathrm{exact}} = c_1 \\exp(\\Delta t \\lambda_1) q_1 + c_2 \\exp(\\Delta t \\lambda_2) q_2 + c_3 \\exp(\\Delta t \\lambda_3) q_3$。\n指数项为，其中 $\\Delta t = 0.8$：\n- $\\Delta t \\lambda_1 = 0.8(-2+\\sqrt{2}) = -1.6 + 0.8\\sqrt{2} \\approx -0.468629$\n- $\\Delta t \\lambda_2 = 0.8(-2) = -1.6$\n- $\\Delta t \\lambda_3 = 0.8(-2-\\sqrt{2}) = -1.6 - 0.8\\sqrt{2} \\approx -2.731371$\n\n数值计算 $y_{\\mathrm{exact}}$ 的分量：\n$y_{\\mathrm{exact}} = (2+\\sqrt{2})\\exp(-1.6+0.8\\sqrt{2})q_1 - \\sqrt{2}\\exp(-1.6)q_2 + (2-\\sqrt{2})\\exp(-1.6-0.8\\sqrt{2})q_3$。\n这得到向量：\n$y_{\\mathrm{exact}} \\approx \\begin{pmatrix} 0.8856248 \\\\ 1.4840300 \\\\ 1.2894102 \\end{pmatrix}$。\n\n### 第二部分：计算泰勒近似解 $y_{\\mathrm{tay}}$\n\n我们使用公式 $y_{\\mathrm{tay}} = v + \\Delta t L v + \\frac{\\Delta t^{2}}{2} L^{2}v + \\frac{\\Delta t^{3}}{6}L^3 v$。我们依次计算各项 $L^k v$。\n- $v = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$\n- $Lv = \\begin{pmatrix} -2  1  0 \\\\ 1  -2  1 \\\\ 0  1  -2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -2+2 \\\\ 1-4+3 \\\\ 2-6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -4 \\end{pmatrix}$\n- $L^2v = L(Lv) = \\begin{pmatrix} -2  1  0 \\\\ 1  -2  1 \\\\ 0  1  -2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -4 \\\\ 8 \\end{pmatrix}$\n- $L^3v = L(L^2v) = \\begin{pmatrix} -2  1  0 \\\\ 1  -2  1 \\\\ 0  1  -2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -4 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ 8+8 \\\\ -4-16 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ 16 \\\\ -20 \\end{pmatrix}$\n\n现在我们使用系数 $\\Delta t = 0.8$，$\\frac{\\Delta t^2}{2} = \\frac{0.64}{2} = 0.32$ 和 $\\frac{\\Delta t^3}{6} = \\frac{0.512}{6} = \\frac{0.256}{3}$ 来组合 $y_{\\mathrm{tay}}$。\n$y_{\\mathrm{tay}} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} + 0.8 \\begin{pmatrix} 0 \\\\ 0 \\\\ -4 \\end{pmatrix} + 0.32 \\begin{pmatrix} 0 \\\\ -4 \\\\ 8 \\end{pmatrix} + \\frac{0.256}{3} \\begin{pmatrix} -4 \\\\ 16 \\\\ -20 \\end{pmatrix}$\n$y_{\\mathrm{tay}} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ -3.2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -1.28 \\\\ 2.56 \\end{pmatrix} + \\begin{pmatrix} -1.024/3 \\\\ 4.096/3 \\\\ -5.12/3 \\end{pmatrix}$\n- $y_{\\mathrm{tay},1} = 1 + 0 + 0 - \\frac{1.024}{3} = \\frac{3-1.024}{3} = \\frac{1.976}{3} \\approx 0.658667$\n- $y_{\\mathrm{tay},2} = 2 + 0 - 1.28 + \\frac{4.096}{3} = 0.72 + \\frac{4.096}{3} = \\frac{2.16+4.096}{3} = \\frac{6.256}{3} \\approx 2.085333$\n- $y_{\\mathrm{tay},3} = 3 - 3.2 + 2.56 - \\frac{5.12}{3} = 2.36 - \\frac{5.12}{3} = \\frac{7.08-5.12}{3} = \\frac{1.96}{3} \\approx 0.653333$\n\n所以，$y_{\\mathrm{tay}} \\approx \\begin{pmatrix} 0.6586667 \\\\ 2.0853333 \\\\ 0.6533333 \\end{pmatrix}$。\n\n### 第三部分：计算误差范数\n\n误差向量为 $e = y_{\\mathrm{exact}} - y_{\\mathrm{tay}}$。\n$e_1 \\approx 0.8856248 - 0.6586667 = 0.2269581$\n$e_2 \\approx 1.4840300 - 2.0853333 = -0.6013033$\n$e_3 \\approx 1.2894102 - 0.6533333 = 0.6360769$\n\n误差的欧几里得范数为 $\\|e\\|_2 = \\sqrt{e_1^2 + e_2^2 + e_3^2}$。\n$\\|e\\|_2^2 \\approx (0.2269581)^2 + (-0.6013033)^2 + (0.6360769)^2$\n$\\|e\\|_2^2 \\approx 0.0515098 + 0.3615658 + 0.4045939 = 0.8176695$\n$\\|e\\|_2 \\approx \\sqrt{0.8176695} \\approx 0.9042508$\n\n四舍五入到五位有效数字得到 $0.90425$。", "answer": "$$\\boxed{0.90425}$$", "id": "3389682"}, {"introduction": "在掌握了线性问题的精确求解之后，我们需将这一思想推广至更普遍的半线性问题，并学习如何严格分析其精度。本练习 [@problem_id:3389699] 引导您从理论层面构建并分析一个完整的指数积分格式。通过推导一阶指数时间差分（ETD）法及其局部截断误差，您将掌握这些方法设计的标准流程，并理解核心的 $\\varphi$-函数是如何巧妙处理刚性线性项与非线性项之间的相互作用的。", "problem": "考虑一个在巴拿赫空间 $\\mathcal{X}$ 上定义的半线性刚性演化问题，\n$$\n\\frac{d}{dt}u(t) = L\\,u(t) + N(u(t)), \\quad t \\ge t_0,\\qquad u(t_0)=u_0,\n$$\n其中 $L:\\mathcal{D}(L)\\subset \\mathcal{X}\\to \\mathcal{X}$ 是一个（可能无界的）线性算子，它生成一个有界解析 $C_0$-半群 $\\{\\exp(tL)\\}_{t\\ge 0}$，而 $N:\\mathcal{X}\\to \\mathcal{X}$ 是一个充分光滑的非线性映射，其 Fréchet 导数直到下文所需的阶数都有界。令 $\\Delta t0$ 且 $t_n=t_0+n\\Delta t$。仅使用温和解的常数变易公式，\n$$\nu(t_{n+1})=\\exp(\\Delta t\\,L)\\,u(t_n)+\\int_0^{\\Delta t}\\exp\\!\\big((\\Delta t-\\tau)L\\big)\\,N\\!\\big(u(t_n+\\tau)\\big)\\,d\\tau,\n$$\n完成以下任务：\n\n1) 推导一阶指数时间差分 (ETD) 方法，通常称为指数欧拉格式。该方法通过将积分下的非线性项替换为仅基于 $t_n$ 处数据的求积，来将近似解 $u_n\\approx u(t_n)$推进到 $u_{n+1}\\approx u(t_{n+1})$。你可以通过以下方式引入和定义 $\\varphi$-函数\n$$\n\\varphi_1(z) \\equiv \\int_0^1 \\exp\\!\\big((1-\\theta)z\\big)\\,d\\theta = \\frac{\\exp(z)-I}{z},\n$$\n当 $z$ 是一个算子时，通过幂级数在算子意义上进行解释。\n\n2) 将单步局部截断误差定义为将 $t_n$ 处的精确解代入数值更新格式，并将结果与 $u(t_{n+1})$ 比较所得到的偏差：\n$$\n\\tau_{n+1} \\equiv u(t_{n+1}) - \\Big[\\exp(\\Delta t\\,L)\\,u(t_n)+\\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N\\!\\big(u(t_n)\\big)\\Big].\n$$\n以 $\\Delta t$ 的幂的解析级数形式计算 $\\tau_{n+1}$，该级数用 $L$、$N$ 及其沿精确流的时间导数表示。你应该从 $N\\!\\big(u(t_n+\\tau)\\big)$ 关于 $\\tau=0$ 的时间泰勒展开开始，使用 $N$ 的 Fréchet 导数，并对半群计算所得的积分。你的最终答案必须是 $\\tau_{n+1}$ 的一个单一闭式解析表达式，用 $\\Delta t$、算子函数 $\\varphi_k(\\Delta t\\,L)$ 以及由 $L$、$N$ 及其 Fréchet 导数构成的 时间导数 $D_t^m\\big(N(u(t_n))\\big)$ 来表示。不需要进行数值计算，也不需要四舍五入。最终答案不带单位。", "solution": "该问题是适定的，在偏微分方程数值分析理论中有坚实的科学基础，并包含足够的信息以获得唯一解。我们按要求进行推导和计算。\n\n问题分为两部分。首先，我们推导一阶指数时间差分 (ETD) 格式。其次，我们计算相关的局部截断误差。\n\n**第一部分：指数欧拉方法的推导**\n\n我们从演化方程温和解的常数变易公式开始，该公式用 $t_n$ 时刻的精确解来描述 $t_{n+1}$ 时刻的精确解：\n$$\nu(t_{n+1}) = \\exp(\\Delta t\\,L)\\,u(t_n) + \\int_0^{\\Delta t} \\exp\\big((\\Delta t-\\tau)L\\big)\\,N\\big(u(t_n+\\tau)\\big)\\,d\\tau.\n$$\n这里，$t_{n+1} = t_n + \\Delta t$。为了推导数值方法，我们用 $u_n$ 表示 $u(t_n)$ 的数值近似。将解从 $u_n$ 推进到 $u_{n+1}$ 的格式是通过近似积分项得到的。\n\n指数欧拉方法作为一种一阶方法，对积分采用最简单的求积方式。我们用非线性项 $N(u(t_n+\\tau))$ 在时间区间开始处的值，即在 $\\tau=0$ 处的值来近似它。在数值格式的背景下，这意味着我们做如下近似：\n$$\nN\\big(u(t_n+\\tau)\\big) \\approx N\\big(u(t_n)\\big).\n$$\n在构建数值积分器时，我们用其近似值 $u_n$ 替换精确解 $u(t_n)$，因此被积函数被近似为 $N(u_n)$，它相对于积分变量 $\\tau$ 是一个常数。\n\n将此近似代入温和解公式，得到 $u_{n+1}$ 的数值格式：\n$$\nu_{n+1} = \\exp(\\Delta t\\,L)\\,u_n + \\int_0^{\\Delta t} \\exp\\big((\\Delta t-\\tau)L\\big)\\,N(u_n)\\,d\\tau.\n$$\n由于 $N(u_n)$ 不依赖于 $\\tau$，我们可以将其移到积分号外：\n$$\nu_{n+1} = \\exp(\\Delta t\\,L)\\,u_n + \\left( \\int_0^{\\Delta t} \\exp\\big((\\Delta t-\\tau)L\\big)\\,d\\tau \\right) N(u_n).\n$$\n现在，我们必须计算这个算子值积分。让我们进行变量代换，$s = \\Delta t - \\tau$。这意味着 $d\\tau = -ds$，积分限从 $\\tau=0$ 变为 $s=\\Delta t$，从 $\\tau=\\Delta t$ 变为 $s=0$。\n$$\n\\int_0^{\\Delta t} \\exp\\big((\\Delta t-\\tau)L\\big)\\,d\\tau = \\int_{\\Delta t}^0 \\exp(sL)\\,(-ds) = \\int_0^{\\Delta t} \\exp(sL)\\,ds.\n$$\n我们将其与问题陈述中提供的 $\\varphi_1$-函数联系起来。其定义为：\n$$\n\\varphi_1(z) = \\int_0^1 \\exp\\big((1-\\theta)z\\big)\\,d\\theta.\n$$\n我们设 $z = \\Delta t\\,L$。变量代换 $\\theta = 1 - s/(\\Delta t)$，即 $s = (1-\\theta)\\Delta t$。因此 $ds = -\\Delta t d\\theta$。当 $s=0$ 时 $\\theta=1$，当 $s=\\Delta t$ 时 $\\theta=0$。\n$$\n\\int_0^{\\Delta t} \\exp(sL) ds = \\int_1^0 \\exp\\big((1-\\theta)\\Delta t L\\big) (-\\Delta t d\\theta) = \\Delta t \\int_0^1 \\exp\\big((1-\\theta)\\Delta t L\\big)d\\theta = \\Delta t \\, \\varphi_1(\\Delta t L).\n$$\n这就建立了联系。半群的积分是 $\\Delta t\\,\\varphi_1(\\Delta t\\,L)$。\n\n将此结果代回到 $u_{n+1}$ 的表达式中，我们得到指数欧拉格式：\n$$\nu_{n+1} = \\exp(\\Delta t\\,L)\\,u_n + \\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N(u_n).\n$$\n这就完成了问题的第一部分。\n\n**第二部分：局部截断误差的计算**\n\n局部截断误差 $\\tau_{n+1}$ 定义为将精确解 $u(t_n)$ 代入数值格式时产生的残差：\n$$\n\\tau_{n+1} \\equiv u(t_{n+1}) - \\Big[\\exp(\\Delta t\\,L)\\,u(t_n) + \\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N\\big(u(t_n)\\big)\\Big].\n$$\n为了计算它，我们将 $u(t_{n+1})$ 替换为温和解公式中的表达式：\n$$\n\\tau_{n+1} = \\left( \\exp(\\Delta t\\,L)\\,u(t_n)+\\int_0^{\\Delta t}\\exp\\!\\big((\\Delta t-\\tau)L\\big)\\,N\\!\\big(u(t_n+\\tau)\\big)\\,d\\tau \\right) - \\Big[\\exp(\\Delta t\\,L)\\,u(t_n)+\\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N\\!\\big(u(t_n)\\big)\\Big].\n$$\n包含 $\\exp(\\Delta t\\,L)\\,u(t_n)$ 的项相互抵消，剩下：\n$$\n\\tau_{n+1} = \\int_0^{\\Delta t}\\exp\\!\\big((\\Delta t-\\tau)L\\big)\\,N\\!\\big(u(t_n+\\tau)\\big)\\,d\\tau - \\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N\\!\\big(u(t_n)\\big).\n$$\n为了继续，我们将 $N(u(t_n+\\tau))$ 在 $\\tau=0$ 附近按时间作泰勒级数展开。我们记全时间导数 $\\frac{d^k}{dt^k} F(u(t))|_{t=t_n}$ 为 $D_t^k \\big(F(u(t_n))\\big)$。\n$$\nN\\big(u(t_n+\\tau)\\big) = \\sum_{k=0}^{\\infty} \\frac{\\tau^k}{k!} D_t^k\\big(N(u(t_n))\\big).\n$$\n将此级数代入积分项：\n$$\n\\int_0^{\\Delta t}\\exp\\!\\big((\\Delta t-\\tau)L\\big) \\left( \\sum_{k=0}^{\\infty} \\frac{\\tau^k}{k!} D_t^k\\big(N(u(t_n))\\big) \\right) d\\tau = \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\left( \\int_0^{\\Delta t} \\exp\\!\\big((\\Delta t-\\tau)L\\big) \\tau^k d\\tau \\right) D_t^k\\big(N(u(t_n))\\big).\n$$\n我们必须计算积分 $I_k = \\int_0^{\\Delta t} \\exp\\!\\big((\\Delta t-\\tau)L\\big) \\tau^k d\\tau$。让我们进行变量代换 $\\tau = \\theta \\Delta t$，因此 $d\\tau = \\Delta t d\\theta$，$\\theta$ 的范围从 $0$ 到 $1$。\n$$\nI_k = \\int_0^1 \\exp\\big((\\Delta t - \\theta\\Delta t)L\\big) (\\theta\\Delta t)^k (\\Delta t d\\theta) = (\\Delta t)^{k+1} \\int_0^1 \\exp\\big((1-\\theta)\\Delta t L\\big) \\theta^k d\\theta.\n$$\n为了用 $\\varphi$-函数表示它，我们引入问题中所提供定义的标准推广。$\\varphi_j$-函数族定义为：\n$$\n\\varphi_j(z) \\equiv \\int_0^1 \\exp\\big((1-\\theta)z\\big) \\frac{\\theta^{j-1}}{(j-1)!} d\\theta, \\quad \\text{for } j \\ge 1.\n$$\n对于 $j=1$，这给出 $\\varphi_1(z) = \\int_0^1 \\exp((1-\\theta)z) d\\theta$，与问题陈述相符。\n使用这个定义，我们可以写出：\n$$\n\\int_0^1 \\exp\\big((1-\\theta)\\Delta t L\\big) \\theta^k d\\theta = k! \\int_0^1 \\exp\\big((1-\\theta)\\Delta t L\\big) \\frac{\\theta^k}{k!} d\\theta = k!\\,\\varphi_{k+1}(\\Delta t L).\n$$\n所以，积分 $I_k$ 是：\n$$\nI_k = (\\Delta t)^{k+1} k!\\, \\varphi_{k+1}(\\Delta t L).\n$$\n现在，我们将此结果代回到非线性项积分的级数中：\n$$\n\\int_0^{\\Delta t}\\exp\\!\\big((\\Delta t-\\tau)L\\big)\\,N\\!\\big(u(t_n+\\tau)\\big)\\,d\\tau = \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\left( (\\Delta t)^{k+1} k!\\, \\varphi_{k+1}(\\Delta t L) \\right) D_t^k\\big(N(u(t_n))\\big) = \\sum_{k=0}^{\\infty} (\\Delta t)^{k+1} \\varphi_{k+1}(\\Delta t L) D_t^k\\big(N(u(t_n))\\big).\n$$\n最后，我们将此结果代入局部截断误差 $\\tau_{n+1}$ 的表达式中：\n$$\n\\tau_{n+1} = \\left( \\sum_{k=0}^{\\infty} (\\Delta t)^{k+1} \\varphi_{k+1}(\\Delta t L) D_t^k\\big(N(u(t_n))\\big) \\right) - \\Delta t\\,\\varphi_1(\\Delta t\\,L)\\,N\\big(u(t_n)\\big).\n$$\n让我们展开级数的首项（对于 $k=0$）：\n$$\n(\\Delta t)^{0+1} \\varphi_{0+1}(\\Delta t L) D_t^0\\big(N(u(t_n))\\big) = \\Delta t\\, \\varphi_1(\\Delta t L) N(u(t_n)).\n$$\n这一项恰好是被减去的项。因此，它们相互抵消，求和从 $k=1$ 开始。\n$$\n\\tau_{n+1} = \\sum_{k=1}^{\\infty} (\\Delta t)^{k+1} \\varphi_{k+1}(\\Delta t L) D_t^k\\big(N(u(t_n))\\big).\n$$\n这就是所求的局部截断误差的解析级数。首项（对于 $k=1$）是 $(\\Delta t)^2 \\varphi_2(\\Delta t L) D_t\\big(N(u(t_n))\\big)$，这证实了局部误差是 $\\mathcal{O}((\\Delta t)^2)$ 阶的，与一阶方法相符。这个表达式是第二部分的最终答案。", "answer": "$$\n\\boxed{\\sum_{k=1}^{\\infty} (\\Delta t)^{k+1} \\varphi_{k+1}(\\Delta t L) D_t^k\\big(N(u(t_n))\\big)}\n$$", "id": "3389699"}]}