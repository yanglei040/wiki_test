## 引言
在科学与工程计算领域，[非线性偏微分方程](@entry_id:169481)（PDEs）无处不在，从[流体运动](@entry_id:182721)的模拟到材料的非弹性行为，再到图像的恢复，它们是描述复杂现象的通用语言。然而，求解这些方程通常计算成本高昂，尤其是在需要高分辨率的精细网格上。虽然多重网格方法被公认为求解线性PDEs最快的方法之一，但其标准的校正格式（Correction Scheme, CS）在面对[非线性](@entry_id:637147)问题时却遇到了根本性的障碍，因为残差与误差之间不再存在简单的线性关系。

为了弥合这一鸿沟，[全近似格式](@entry_id:749627)（Full Approximation Scheme, FAS）应运而生。它是一种强大的[多重网格](@entry_id:172017)[范式](@entry_id:161181)，通过在所有网格层级上直接处理[非线性](@entry_id:637147)问题，从而彻底革新了[非线性系统](@entry_id:168347)的求解策略。本文旨在系统地介绍FAS方法，引导读者深入理解其原理、机制及广泛应用。

本文将分为三个核心章节。在“原理与机制”中，我们将从[非线性](@entry_id:637147)的根本挑战出发，详细推导FAS的核心方程，阐明关键的“$\tau$-校正”概念，并剖析完整的FAS算法循环流程。随后，在“应用与跨学科联系”一章，我们将展示FAS如何在[计算流体动力学](@entry_id:147500)、图像处理、计算力学等多个前沿领域中解决实际问题，突显其作为一种灵活计算框架的强大能力。最后，“动手实践”部分将提供一系列精心设计的问题，帮助读者将理论知识转化为解决具体问题的实践技能。通过这一系列的学习，读者将全面掌握FAS这一现代计算科学的基石性工具。

## 原理与机制

在上一章中，我们回顾了线性多重网格方法，特别是校正格式（Correction Scheme, CS），它通过在粗网格上求解误差的残差方程来加速收敛。然而，当我们将注意力转向科学与工程中更为普遍的[非线性](@entry_id:637147)问题时，这种直接的误差校正思想遇到了根本性的挑战。本章将深入探讨为应对这一挑战而设计的核心算法——[全近似格式](@entry_id:749627)（Full Approximation Scheme, FAS）的原理与机制。我们将从[非线性](@entry_id:637147)问题的基本困难出发，系统地推导出FAS的核心方程，剖析其算法流程，并讨论其关键组成部分与实际应用中的高级主题。

### [非线性](@entry_id:637147)的根本挑战：从[误差校正](@entry_id:273762)到全近似

对于一个线性离散系统 $A_h u_h = f_h$，我们知道近似解 $u_h$ 的误差 $e_h = u_h^* - u_h$（其中 $u_h^*$ 为精确解）与残差 $r_h = f_h - A_h u_h$ 之间存在一个简单的线性关系：$A_h e_h = r_h$。这一关系是线性多重网格方法（即校正格式）的基石，因为它允许我们在粗网格上建立一个形式相同的方程来近似求解误差。

然而，对于一个一般的[非线性](@entry_id:637147)问题 $F_h(u_h) = f_h$，这种简单的关系不复存在。设 $u_h^*$ 为精确离散解，满足 $F_h(u_h^*) = f_h$。对于当前的近似解 $u_h$，残差定义为 $r_h = f_h - F_h(u_h)$。将 $u_h^* = u_h + e_h$ 代入精确解方程，我们得到 $F_h(u_h + e_h) = f_h$。结合残差的定义，我们可以推导出误差 $e_h$ 所满足的精确方程：

$$
F_h(u_h + e_h) - F_h(u_h) = f_h - F_h(u_h) = r_h
$$

这是一个关于误差 $e_h$ 的[非线性方程](@entry_id:145852)。我们无法像在线性情况下那样，找到一个**固定**的线性算子 $A_h$ 使得 $r_h = A_h e_h$ 对所有 $u_h$ 都成立。我们可以从两个角度来理解这一点 [@problem_id:3396518]。

首先，根据[向量值函数](@entry_id:261164)的[微积分基本定理](@entry_id:201377)，我们可以将 $F_h(u_h + e_h) - F_h(u_h)$ 表示为一个积分形式：

$$
r_h = F_h(u_h + e_h) - F_h(u_h) = \int_{0}^{1} J_{F_h}(u_h + t e_h) e_h \, dt = \left( \int_{0}^{1} J_{F_h}(u_h + t e_h) \, dt \right) e_h
$$

其中 $J_{F_h}$ 是 $F_h$ 的[雅可比矩阵](@entry_id:264467)（Fréchet导数）。可以看到，连接残差 $r_h$ 和误差 $e_h$ 的矩阵 $\bar{A}_h(e_h) = \int_{0}^{1} J_{F_h}(u_h + t e_h) \, dt$ 本身依赖于误差 $e_h$。除非 $J_{F_h}$ 是一个常数矩阵（即 $F_h$ 是仿射算子），否则不存在一个与 $e_h$ 无关的固定矩阵 $A_h$ 来普适地描述这种关系。

其次，在精确解 $u_h^*$ 的一个小邻域内进行泰勒展开，我们有 $F_h(u_h) = F_h(u_h^* - e_h) \approx F_h(u_h^*) - J_{F_h}(u_h^*) e_h$。由于 $F_h(u_h^*) = f_h$，残差可以近似表示为 $r_h = f_h - F_h(u_h) \approx J_{F_h}(u_h^*) e_h$。这表明，只有当误差 $e_h$ 很小时，残差才与误差近似成[线性关系](@entry_id:267880)。高阶项 $\mathcal{O}(\|e_h\|^2)$ 的存在破坏了全局的[线性关系](@entry_id:267880)。

这一根本性的困难促使我们必须放弃在线性校正格式中求解误差方程的思路，转而寻求一种新的策略。[全近似格式](@entry_id:749627)（FAS）应运而生，其核心思想是：**不在粗网格上求解误差，而是在粗网格上求解完整解的近似值** [@problem_id:3396537]。

### [全近似格式](@entry_id:749627)（FAS）的核心方程与$\tau$-校正

FAS的目标是在粗网格 $H$ 上构建一个[非线性方程](@entry_id:145852) $N_H(U_H) = g_H$，使其解 $U_H$ 能够有效地帮助我们校正细网格 $h$ 上的解。这里的 $N_H$ 和 $N_h$ 分别是同一连续问题在粗、细网格上的离散算子。为了让粗网格问题“感知”到细网格的求解状态，FAS引入了一个至关重要的**一致性原则** [@problem_id:3396520]。

该原则要求：如果 $u_h^*$ 是细网格问题 $N_h(u_h) = f_h$ 的精确解，那么它的限制（restriction）$I_h^H u_h^*$ 应该满足相应的粗网格方程。这里的 $I_h^H$ 是从细网格到粗网格的[限制算子](@entry_id:754316)。

然而，一般情况下，$N_H(I_h^H u_h^*)$ 并不等于 $I_h^H f_h$（或 $I_h^H N_h(u_h^*)$）。两者之差反映了不同网格上离散算子的不一致性。我们定义** defect** 或 **$\tau$-校正**（也称为相对[截断误差](@entry_id:140949)）来量化这种不一致性：

$$
\tau_h^H(w) = N_H(I_h^H w) - I_h^H N_h(w)
$$

其中 $w$ 是任意一个定义在细网格上的函数。有了这个定义，我们可以重写细网格精确解所满足的关系：$I_h^H N_h(u_h^*) = N_H(I_h^H u_h^*) - \tau_h^H(u_h^*)$。由于 $N_h(u_h^*) = f_h$，我们得到：

$$
N_H(I_h^H u_h^*) = I_h^H f_h + \tau_h^H(u_h^*)
$$

这个方程为我们指明了理想的粗网格问题形式。我们希望求解的粗网格变量 $U_H$ 就应该满足这样一个方程。然而，我们并不知道精确解 $u_h^*$，因此无法计算精确的 $\tau_h^H(u_h^*)$。FAS的关键步骤是用当前细网格上的近似解 $u_h^{\text{old}}$ 来近似它：

$$
\tau_h^H(u_h^*) \approx \tau_h^H(u_h^{\text{old}}) = N_H(I_h^H u_h^{\text{old}}) - I_h^H N_h(u_h^{\text{old}})
$$

将这个近似的 $\tau$-校正代入理想粗网格方程，我们便得到了FAS的**粗网格方程**：

$$
N_H(U_H) = I_h^H f_h + N_H(I_h^H u_h^{\text{old}}) - I_h^H N_h(u_h^{\text{old}})
$$

将此式重新整理，可以得到一个更常用且更具启发性的形式 [@problem_id:3396552]：

$$
N_H(U_H) = N_H(I_h^H u_h^{\text{old}}) + I_h^H (f_h - N_h(u_h^{\text{old}}))
$$

其中 $f_h - N_h(u_h^{\text{old}})$ 正是细网格上的残差 $r_h$。因此，FAS粗网格方程的右端项由两部分构成：[粗网格算子](@entry_id:747426)作用在限制后的当前解上，再加上限制后的细网格残差。这个方程的未知量是粗网格上的**完整解** $U_H$，而非仅仅是一个[误差校正](@entry_id:273762)量。

### $\tau$-校正的具体计算

为了更具体地理解 $\tau$-校正的含义，我们来看一个例子。考虑[非线性](@entry_id:637147)[泊松方程](@entry_id:143763) $-\Delta u + u^3 = 0$，并使用标准的五点差分格式进行离散。设细网格算子为 $F_h$，[粗网格算子](@entry_id:747426)为 $F_H$，粗网格步长 $H=2h$。$\tau$-校正的定义为 $\tau_h^H(u_h) = F_H(I_h^H u_h) - I_h^H(F_h(u_h))$。

我们通过一个思想实验来揭示其构成 [@problem_id:3396498]。假设细网格上的解 $u_h$ 是一个“尖峰”函数：它仅在某个同时也是粗网格节点的点 $(i,j)$ 上取值为 $\alpha$，而在所有其他点上均为0。

1.  **计算第一项 $F_H(I_h^H u_h)$**：
    - 首先，我们需要将细网格函数 $u_h$ 限制到粗网格上。使用标准的全加权（full-weighting）[限制算子](@entry_id:754316) $I_h^H$（其模板将在后文介绍），这个尖峰函数在粗网格上对应点的值会被平滑为 $\frac{\alpha}{4}$，而在其他粗网格点上为0。
    - 接着，我们将[粗网格算子](@entry_id:747426) $F_H$ 应用于这个平滑后的粗网格尖峰函数。在[中心点](@entry_id:636820)，由于其邻居均为0，拉普拉斯部分贡献 $\frac{4(\alpha/4)}{H^2} = \frac{\alpha}{(2h)^2} = \frac{\alpha}{4h^2}$，[非线性](@entry_id:637147)部分贡献 $(\frac{\alpha}{4})^3 = \frac{\alpha^3}{64}$。所以 $F_H(I_h^H u_h)$ 在该点的值为 $\frac{\alpha}{4h^2} + \frac{\alpha^3}{64}$。

2.  **计算第二项 $I_h^H(F_h(u_h))$**：
    - 首先，我们在细网格上计算 $F_h(u_h)$。在尖峰点 $(i,j)$，其值为 $\frac{4\alpha}{h^2} + \alpha^3$。在其四个直接邻点，值为 $-\frac{\alpha}{h^2}$。在其他点，值为0。这形成了一个中心-邻居模式的残差[分布](@entry_id:182848)。
    - 接着，我们将这个残差[分布](@entry_id:182848)限制到粗网格。使用[全加权限制算子](@entry_id:749624)，对这个[分布](@entry_id:182848)进行加权平均，得到在粗网格[中心点](@entry_id:636820)的值为 $\frac{1}{16} [4(\frac{4\alpha}{h^2} + \alpha^3) + 4 \times 2(-\frac{\alpha}{h^2})] = \frac{\alpha}{2h^2} + \frac{\alpha^3}{4}$。

3.  **计算$\tau$-校正**：
    - 将两项相减，得到 $\tau_h^H$ 在该点的值为 $(\frac{\alpha}{4h^2} + \frac{\alpha^3}{64}) - (\frac{\alpha}{2h^2} + \frac{\alpha^3}{4}) = -\frac{\alpha}{4h^2} - \frac{15\alpha^3}{64}$。

这个计算明确地显示了 $\tau_h^H$ 是非零的。它的值来源于两个方面：首先，线性部分（[拉普拉斯算子](@entry_id:146319)）的差异是由于 $F_H$ 的步长 $H$ 和 $F_h$ 的步长 $h$ 不同所致；其次，[非线性](@entry_id:637147)部分（$u^3$）的差异则更加复杂，因为它涉及到算子与限制操作的不可交换性，即 $ (I_h^H u_h)^3 \neq I_h^H (u_h^3) $。$\tau$-校正正是为了弥合这些差异，从而确保粗网格问题能够忠实地反映细网格的物理和代数特性。

### FAS双网格循环的完[整流](@entry_id:197363)程

现在我们可以将以上原理整合为一个完整的FAS双网格算法循环 [@problem_id:3396552]。假设我们从一个初始猜测 $u_h^{(0)}$ 开始，一个FAS循环的目标是计算出一个更优的近似解 $u_h^{(1)}$。

1.  **预平滑 (Pre-smoothing)**：
    对当前细网格近似解 $u_h$ 应用 $\nu_1$ 次[非线性](@entry_id:637147)松弛（或称平滑）迭代，例如[非线性](@entry_id:637147)Gauss-Seidel方法。平滑操作旨在衰减误差中的高频分量。得到平滑后的解 $\tilde{u}_h$。
    $$ \tilde{u}_h \leftarrow \text{Smooth}^{\nu_1}(u_h, f_h) $$

2.  **残差计算与限制 (Residual Computation and Restriction)**：
    计算平滑后解的残差 $r_h = f_h - N_h(\tilde{u}_h)$。然后，将当前解 $\tilde{u}_h$ 和残差 $r_h$ 都限制到粗网格上。
    $$ \tilde{u}_H \leftarrow I_h^H \tilde{u}_h $$
    $$ r_H \leftarrow I_h^H r_h $$

3.  **粗网格问题求解 (Coarse-Grid Solve)**：
    构造并求解粗网格FAS方程：
    $$ N_H(U_H) = N_H(\tilde{u}_H) + r_H $$
    至关重要的一点是，在迭代求解这个粗网格[非线性](@entry_id:637147)问题时，必须使用限制后的细网格解作为初始猜测值，即 $U_H^{(0)} = \tilde{u}_H$ [@problem_id:3396537]。这确保了粗网格求解过程从一个与细网格状态一致的点开始，其目标是计算相对于当前状态的校正。从零或其他任意值开始会破坏这种一致性，可能导致算法不稳定或收敛缓慢。在最粗的网格上，这个方程通常需要被精确求解（或求解到很高的精度）。对于中间层，求解是通过一次或多次递归的FAS循环完成的。

4.  **计算并延长校正量 (Correction Calculation and Prolongation)**：
    粗网格求解得到的 $U_H$ 是对完整解的更优近似。因此，粗网格上计算出的校正量是新解与旧解（限制后）的差值：
    $$ e_H \leftarrow U_H - \tilde{u}_H $$
    然后将这个[粗网格校正](@entry_id:177637)量通过延长（prolongation）算子 $I_H^h$ 插值回细网格，得到细网格校正量 $e_h = I_H^h e_H$。

5.  **细网格解更新 (Fine-Grid Update)**：
    用细网格校正量更新平滑后的解：
    $$ u_h^{\text{new}} \leftarrow \tilde{u}_h + e_h = \tilde{u}_h + I_H^h(U_H - I_h^H \tilde{u}_h) $$
    这个更新步骤可以被看作是对细网格解中低频（或粗尺度）成分的一次**替换** [@problem_id:3396578]。我们减去了旧解的粗尺度部分（由 $I_H^h I_h^H \tilde{u}_h$ 近似），并换上了通过求解粗网格问题得到的更精确的粗尺度部分（由 $I_H^h U_H$ 近似）。这种“替换”而非简单的加法，是处理[非线性](@entry_id:637147)的关键，它避免了显式构造[雅可比矩阵](@entry_id:264467)，同时保持了多层级间的一致性。

6.  **后平滑 (Post-smoothing)**：
    对更新后的解 $u_h^{\text{new}}$ 应用 $\nu_2$ 次[非线性](@entry_id:637147)松弛迭代，以消除延长操作可能引入的少量高频[振荡](@entry_id:267781)，并进一步巩固解。最终得到的结果即为本次FAS循环的输出。
    $$ u_h^{(1)} \leftarrow \text{Smooth}^{\nu_2}(u_h^{\text{new}}, f_h) $$

### 关键算法组件

FAS循环的有效性依赖于其两个核心组件：[平滑器](@entry_id:636528)和网格间传递算子。

#### [非线性](@entry_id:637147)[平滑器](@entry_id:636528)

[平滑器](@entry_id:636528)的作用是高效地衰减误差中的高频分量。一个常用的平滑器是**[非线性](@entry_id:637147)Gauss-Seidel (GS)方法**。对于一个离散系统 $F_h(u) = 0$，其分量形式为 $F_{i,j}(u) = 0$。一次[非线性](@entry_id:637147)GS扫描会按固定顺序（例如，[字典序](@entry_id:143032)）遍历所有网格点 $(i,j)$。在每个点上，它将其他所有点的值视为已知（对于已访问的点使用新值，未访问的点使用旧值），然后求解关于单个未知量 $u_{i,j}$ 的标量[非线性方程](@entry_id:145852) $F_{i,j}(\dots, u_{i,j}, \dots) = 0$。

[非线性](@entry_id:637147)GS迭代的收敛性，特别是其作为[平滑器](@entry_id:636528)的有效性，与算子 $F_h$ 的性质密切相关。一个充分条件是，如果 $F_h$ 的[雅可比矩阵](@entry_id:264467) $J_h(u)$ 在整个求解域上是**一致[严格对角占优](@entry_id:154277)**的，那么[非线性](@entry_id:637147)GS迭代映射是一个[压缩映射](@entry_id:139989)，从而保证收敛 [@problem_id:3396559]。对于由椭圆型[PDE离散化](@entry_id:175821)得到的系统，这个条件通常能够满足，保证了GS方法作为[平滑器](@entry_id:636528)的可靠性。

#### 网格间传递算子

网格间的信息传递由[限制算子](@entry_id:754316) $R$ 和[延长算子](@entry_id:144790) $P$ 完成。在二维均匀网格上，标准的选择是基于一维操作的[张量积](@entry_id:140694)构造 [@problem_id:3396504]。

-   **[限制算子](@entry_id:754316) (Restriction)**：常用的**[全加权限制算子](@entry_id:749624)**将一个粗网格点的值定义为其周围 $3 \times 3$ 细网格点邻域的加权平均。其权重模板为：
    $$
    R = \frac{1}{16} \begin{pmatrix} 1  2  1 \\ 2  4  2 \\ 1  2  1 \end{pmatrix}
    $$
    这个算子具有良好的平滑特性，能够将细网格上的信息（无论是解还是残差）以一种稳定的方式传递到粗网格。

-   **[延长算子](@entry_id:144790) (Prolongation)**：**[双线性插值](@entry_id:170280)**是标准的[延长算子](@entry_id:144790)。它根据细网格点相对于粗网格格点的位置来计算插值。
    -   与粗网格点重合的细网格点直接继承粗网格值（权重为1）。
    -   位于两个粗网格点连线中点的细网格点，其值为这两个粗网格点值的平均（权重各为 $\frac{1}{2}$）。
    -   位于四个粗网格点所构成单元格中心的细网格点，其值为这四个粗网格点值的平均（权重各为 $\frac{1}{4}$）。

这些算子共同构成了[多重网格](@entry_id:172017)中[尺度分离](@entry_id:270204)和信息整合的桥梁。

### 高级主题与实践考量

#### FAS 与 Newton-Multigrid 的比较

FAS并非解决[非线性](@entry_id:637147)问题的唯一多重网格策略。另一种著名的方法是**Newton-Multigrid (MG)**。理解两者的区别至关重要 [@problem_id:3396566]。

-   **基本思路**：Newton-MG是一种“先线性化，后求解”的方法。它在每个（外）迭代步中，首先通过[牛顿法](@entry_id:140116)将[非线性](@entry_id:637147)问题 $F_h(u_h)=0$ 线性化为 $J_h(u_h^{(k)}) \delta_h = -F_h(u_h^{(k)})$，然后调用一个**线性**[多重网格求解器](@entry_id:752283)（内循环）来求解这个关于校正量 $\delta_h$ 的[线性系统](@entry_id:147850)。而FAS则是一种“完全[非线性](@entry_id:637147)”的方法，它始终在所有网格层级上直接处理[非线性方程](@entry_id:145852) $F_\ell(u_\ell) = g_\ell$。

-   **算子与[雅可比矩阵](@entry_id:264467)**：Newton-MG必须在每个外迭代步计算并存储（或以无矩阵方式作用）[雅可比矩阵](@entry_id:264467) $J_h$。粗网格上的算子是细网格[雅可比矩阵](@entry_id:264467)的粗化近似（例如，通过Galerkin构造 $A_H = I_h^H J_h I_H^h$）。相比之下，FAS原则上不需[雅可比矩阵](@entry_id:264467)（除非[平滑器](@entry_id:636528)需要），其[粗网格算子](@entry_id:747426) $F_H$ 是原始[非线性](@entry_id:637147)问题在粗网格上的直接离散。

-   **$\tau$-校正**：$\tau$-校正是FAS所特有的机制，用于确保不同层级非[线性算子](@entry_id:149003)之间的一致性。Newton-MG由于处理的是线性系统，其内部的[多重网格求解器](@entry_id:752283)使用标准的线性校正格式，不涉及$\tau$-校正。

-   **收敛性**：在理想条件下，Newton-MG继承了[牛顿法](@entry_id:140116)的**二次**局部收敛性（前提是[线性系统](@entry_id:147850)被求解得足够精确）。FAS通常表现为**线性**收敛，但其收敛因子通常非常小且独立于网格尺寸 $h$，这使得它在许多应用中极为高效。

#### [循环类型](@entry_id:136710)与鲁棒性：V-循环 vs. W-循环

FAS算法的递归结构可以通过不同的“循环”类型来控制。最简单的是**V-循环**（$\gamma=1$），即在每一层只进行一次到下一粗层的递归调用。对于某些“困难”问题（例如，强[非线性](@entry_id:637147)或系数有大跳跃），粗网格问题本身也可能很难求解。仅仅一次递归的V-循环可能无法为粗网格问题提供足够精确的解，从而导致整体收敛性变差甚至发散。

为了增强鲁棒性，可以使用**W-循环**（$\gamma=2$），即在每一层进行两次到下一粗层的递归调用。这相当于在粗网格上用更强的求解器来求解子问题，从而为细网格提供更准确的低频校正。这种增强的代价是更高的计算成本 [@problem_id:3347228] [@problem_id:3347241] [@problem_id:3515971] [@problem_id:3396510]。

对于一个二维问题，粗化因子为4（$N_{\ell-1} \approx N_{\ell}/4$），一个$\gamma$-循环的渐进计算成本（以一次最细[网格平滑](@entry_id:167649)为单位）约为：

$$
\text{Work} \approx \frac{\nu_1 + \nu_2}{1 - \gamma/4}
$$

-   V-循环 ($\gamma=1$) 的成本约为 $\frac{4}{3}(\nu_1 + \nu_2)$。
-   W-循环 ($\gamma=2$) 的成本约为 $2(\nu_1 + \nu_2)$。

从V-循环到W-循环，单次循环的计算量增加了约50%，但换来的是对更广泛、更困难问题的稳健收敛。

#### 边界条件的处理

在实际问题中，边界条件的处理是算法成功的关键。对于[Dirichlet边界条件](@entry_id:142800) $u=g$，必须在FAS框架内进行一致的处理 [@problem_id:3396555]。

-   **在所有层级强制**：[Dirichlet条件](@entry_id:137096)必须在所有网格层级上强制实施。即，在细网格边界 $\partial\Omega_h$ 上设 $u_h = g_h$，在粗网格边界 $\partial\Omega_H$ 上设 $U_H = g_H$，其中 $g_h, g_H$ 是[连续函数](@entry_id:137361) $g$ 在相应网格边界点上的采样。FAS方程仅在**内部**网格点上求解。

-   **边界感知的传递算子**：[限制算子](@entry_id:754316) $R$ 和[延长算子](@entry_id:144790) $P$ 必须“尊重”边界。当限制一个解 $u_h$ 时，粗网格边界点的值应直接由 $g_H$ 给出，而非通过内部点加权平均得到。当延长一个校正量 $e_H$ 时，由于 $e_H$ 在粗网格边界上为0（因为 $U_H$ 和 $I_h^H u_h$ 在边界上都等于 $g_H$），[延长算子](@entry_id:144790) $P$ 应确保在细网格边界上的校正量也为0，从而不破坏细网格上已强制实施的边界值。靠近边界的插值模板也应是单侧的，以避免使用域外信息。

通过这种方式，边界信息被正确地整合到多层次的求解过程中，确保了算法的稳定性和准确性。