{"hands_on_practices": [{"introduction": "延长算子是将信息从粗网格传递到细网格的关键。它们的设计基于插值，其有效性通过其精度来衡量，特别是它们能精确重构的多项式阶数。这个练习 [@problem_id:3357474] 将引导您从零开始推导广泛使用的双线性插值算子并分析其误差，从而让您对“精度阶”这一概念有具体的理解。", "problem": "考虑一维空间中的一个均匀粗网格，其节点间距为 $H$，节点横坐标为 $x_i = i H$，其中 $i \\in \\mathbb{Z}$。令 $u^H_i$ 表示对一个足够光滑的标量场 $u(x)$ 的粗网格近似，该标量场是计算流体动力学 (CFD) 中出现的一个场变量。定义一个间距为 $h = H/2$ 的细网格，其节点包括 $x_i$、$x_i + H/2$ 和 $x_{i+1} = x_i + H$。\n\n(a) 仅使用插值的基本定义，即插值是在选定的多项式空间中与插值点处的数据相匹配的唯一元素，推导一维延长算子。该算子将粗网格节点值 $\\{u^H_i, u^H_{i+1}\\}$ 映射到 $\\{x_i, x_i + H/2, x_{i+1}\\}$ 处的细网格值，并要求插值在每个粗网格单元 $[x_i, x_{i+1}]$ 上是线性的。写出这三个细网格点关于 $\\{u^H_i, u^H_{i+1}\\}$ 的逐点映射结果。\n\n(b) 现在考虑一个二维空间中的均匀粗网格，其粗网格节点位于 $(x,y) \\in \\{0,H\\} \\times \\{0,H\\}$，标量场仍为 $u(x,y)$。通过取 (a) 部分中推导的一维线性插值的张量积，构造粗网格单元 $[0,H] \\times [0,H]$ 上的双线性延长算子。在单元中心 $(H/2,H/2)$ 处计算该双线性延长，并用角点值 $\\{u^H(0,0), u^H(H,0), u^H(0,H), u^H(H,H)\\}$ 表示。\n\n(c) 为通过多项式精确性检验来评估精度阶，令 $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$ 为一个二次多项式，其中 $a$、$b$、$c$、$d$、$e$ 和 $g$ 是常数。使用 (b) 部分的双线性延长，计算单元中心的插值误差，定义为\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\n其中 $I(x,y)$ 是由角点粗网格值 $\\{f(0,0), f(H,0), f(0,H), f(H,H)\\}$ 构建的双线性插值。请用 $a$、$b$ 和 $H$ 将最终答案表示为单个闭式解析表达式。不要使用大-$\\mathcal{O}$ 记号，且无需四舍五入。", "solution": "我们从给定单元上插值的基本定义开始：插值函数是在一个指定的多项式空间中，与插值点处的已知数据相匹配的唯一成员。在一维空间中，该空间是每个粗网格单元上次数至多为 $1$ 的多项式集合；在二维空间中，该空间是这些一维空间的张量积，即双线性多项式集合。\n\n(a) 部分。在粗网格单元 $[x_i,x_{i+1}]$ 上的一维线性延长。\n\n在 $[x_i,x_{i+1}]$ 上，其中 $x_{i+1} = x_i + H$，一维线性插值由拉格朗日基函数表征\n$$\nN_0(x) = \\frac{x_{i+1} - x}{H}, \\qquad N_1(x) = \\frac{x - x_i}{H},\n$$\n它们满足 $N_0(x_i) = 1$、$N_0(x_{i+1}) = 0$、$N_1(x_i) = 0$ 和 $N_1(x_{i+1}) = 1$。给定粗网格节点值 $u^H_i \\approx u(x_i)$ 和 $u^H_{i+1} \\approx u(x_{i+1})$，线性插值函数为\n$$\nI(x) = u^H_i \\, N_0(x) + u^H_{i+1} \\, N_1(x).\n$$\n在单元中的三个细网格点处求值：\n- 在 $x = x_i$ 处，\n$$\nI(x_i) = u^H_i \\, N_0(x_i) + u^H_{i+1} \\, N_1(x_i) = u^H_i.\n$$\n- 在 $x = x_i + H/2$ 处，\n$$\nN_0\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{x_{i+1} - (x_i + H/2)}{H} = \\frac{H/2}{H} = \\frac{1}{2}, \\quad\nN_1\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{(x_i + H/2) - x_i}{H} = \\frac{1}{2},\n$$\n所以\n$$\nI\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{1}{2} u^H_i + \\frac{1}{2} u^H_{i+1}.\n$$\n- 在 $x = x_{i+1}$ 处，\n$$\nI(x_{i+1}) = u^H_{i+1}.\n$$\n因此，从粗网格节点到单元内细网格节点的一维延长映射为\n$$\n\\bigl(u^H_i, u^H_{i+1}\\bigr) \\mapsto \\left( u^H_i,\\ \\frac{u^H_i + u^H_{i+1}}{2},\\ u^H_{i+1} \\right).\n$$\n\n(b) 部分。作为张量积的二维双线性延长及在单元中心的求值。\n\n在粗网格单元 $[0,H] \\times [0,H]$ 上，取 $x$ 和 $y$ 方向的一维基函数：\n$$\nN_0(x) = \\frac{H - x}{H}, \\quad N_1(x) = \\frac{x}{H}, \\qquad\nM_0(y) = \\frac{H - y}{H}, \\quad M_1(y) = \\frac{y}{H}.\n$$\n单元角点上的双线性基是 $\\{ \\phi_{pq}(x,y) = N_p(x) M_q(y) \\}_{p,q \\in \\{0,1\\}}$，因此给定角点值\n$$\nu^H_{00} = u^H(0,0), \\quad u^H_{10} = u^H(H,0), \\quad u^H_{01} = u^H(0,H), \\quad u^H_{11} = u^H(H,H),\n$$\n双线性插值函数为\n$$\nI(x,y) = u^H_{00} \\, N_0(x) M_0(y) + u^H_{10} \\, N_1(x) M_0(y) + u^H_{01} \\, N_0(x) M_1(y) + u^H_{11} \\, N_1(x) M_1(y).\n$$\n在中心点 $(H/2,H/2)$ 处，有\n$$\nN_0\\!\\left(\\frac{H}{2}\\right) = N_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}, \\qquad\nM_0\\!\\left(\\frac{H}{2}\\right) = M_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}.\n$$\n因此，\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\sum_{p=0}^{1} \\sum_{q=0}^{1} u^H_{pq} \\, \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} \\left( u^H_{00} + u^H_{10} + u^H_{01} + u^H_{11} \\right).\n$$\n\n(c) 部分。二次多项式在中心的插值误差及精度阶评估。\n\n令 $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$。在四个角点处计算 $f$ 的值：\n- 在 $(0,0)$ 处：\n$$\nf(0,0) = g.\n$$\n- 在 $(H,0)$ 处：\n$$\nf(H,0) = a H^2 + d H + g.\n$$\n- 在 $(0,H)$ 处：\n$$\nf(0,H) = b H^2 + e H + g.\n$$\n- 在 $(H,H)$ 处：\n$$\nf(H,H) = a H^2 + b H^2 + c H^2 + d H + e H + g = (a + b + c) H^2 + d H + e H + g.\n$$\n因此，使用 (b) 部分的结果，在中心处的双线性延长值为\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{1}{4} \\left[ g + (a H^2 + d H + g) + (b H^2 + e H + g) + \\bigl( (a+b+c) H^2 + d H + e H + g \\bigr) \\right].\n$$\n合并同类项：\n- 常数项：$g + g + g + g = 4 g$ 得到 $\\frac{1}{4} \\cdot 4 g = g$。\n- 与 $H$ 成正比的项：$d H + d H = 2 d H$ 和 $e H + e H = 2 e H$ 得到 $\\frac{1}{4} (2 d H + 2 e H) = \\frac{d+e}{2} H$。\n- 与 $H^2$ 成正比的项：$a H^2 + b H^2 + (a+b+c) H^2 = (2 a + 2 b + c) H^2$ 得到 $\\frac{1}{4} (2 a + 2 b + c) H^2$。\n\n因此，\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2.\n$$\n计算 $f$ 在中心处的精确值：\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = a \\left(\\frac{H}{2}\\right)^{2} + b \\left(\\frac{H}{2}\\right)^{2} + c \\left(\\frac{H}{2}\\right)\\left(\\frac{H}{2}\\right) + d \\left(\\frac{H}{2}\\right) + e \\left(\\frac{H}{2}\\right) + g.\n$$\n化简得：\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g.\n$$\n中心的插值误差，定义为\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\n则为\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g \\right) - \\left( g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2 \\right).\n$$\n消去公因子 $\\frac{d+e}{2} H$ 和 $g$，我们得到\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} - \\frac{2 a + 2 b + c}{4} \\right) H^2 = - \\frac{a + b}{4} \\, H^2.\n$$\n这个精确表达式表明，双线性延长能精确地重构混合项 $c x y$ 以及所有线性和常数项，并且主导误差项与 $H^2$ 成比例，这表明对于足够光滑的场，如果其局部二次模型能代表其截断行为，则延长算子在单元中心具有二阶精度。", "answer": "$$\\boxed{-\\frac{a+b}{4}\\,H^{2}}$$", "id": "3357474"}, {"introduction": "在为区域内部设计好算子之后，我们必须考虑如何处理边界，这是构建一个稳健求解器的关键步骤。其中一个核心原则是“常数保持”，它确保算子不会引入人为的源或汇。这项练习 [@problem_id:3440509] 演示了如何在狄利克雷边界附近系统地修改标准的全加权限制算子，以确保多重网格方法的基本属性得以维持。", "problem": "考虑一个定义在多边形域上的二维椭圆型偏微分方程 (PDE)，该域具有齐次狄利克雷边界条件，且其直边界段与笛卡尔网格对齐。设细网格是以节点为中心的，间距为 $h$，内部节点的索引为 $(i,j)$；粗网格的间距为 $H=2h$，内部粗网格节点的索引为 $(I,J)$。对于远离边界的内部粗网格节点，经典的全加权限制算子通过一个 $3\\times 3$ 的模板将细网格上的节点场 $r_{i,j}$（例如，残差）映射到粗网格上\n$$\n\\frac{1}{16}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix},\n$$\n该模板以细网格节点 $(2I,2J)$ 为中心。\n\n在狄利克雷边界附近，如果标准的 $3\\times 3$ 模板支撑集与域外重叠，那么在邻近边界的粗网格节点上直接应用上述模板可能需要域外的细网格值（即幽灵点）。一种避免使用幽灵点的稳健修正是：将对应于域外细网格节点的权重设置为零，并重新归一化域内剩余的权重，以使限制算子能够保持常数，即修正后的权重之和为 $1$。\n\n我们关注一个粗网格节点 $(I,J)$，它邻近一条与网格对齐的直狄利克雷边界，但不在角点上。该节点的情况是，标准 $3\\times 3$ 模板在边界法向一侧的整列细网格节点都位于域外。假设缺失的列对应于相对于细网格中心 $(2I,2J)$ 的 $3\\times 3$ 模板的“左”列。\n\n仅从以下要求出发：限制算子是可用细网格值的凸组合（权重非负且总和为 $1$），并且在没有边界时退化为内部的全加权形式。请通过移除域外列并重新缩放剩余权重，推导出在这个邻近边界的粗网格节点上的重新归一化全加权模板。请以完整的 $3\\times 3$ 权重矩阵形式给出最终答案，对被排除的位置插入 $0$，并将所有元素表示为精确分数。", "solution": "该问题要求推导一个修正的全加权限制算子模板，该模板用于邻近与网格对齐的直狄利克雷边界的粗网格节点。该修正必须遵循保持常数的原则，即模板的权重必须非负且总和为 $1$。\n\n对于内部粗网格节点 $(I,J)$，标准的全加权限制算子由一个 $3 \\times 3$ 的权重模板定义，该模板应用于对应细网格节点 $(2I, 2J)$ 及其周围的细网格残差场 $r$。未归一化的权重（我们将其表示为矩阵 $W$）如下：\n$$\nW =\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n这些未归一化权重的总和为 $S_{total} = 1+2+1+2+4+2+1+2+1 = 16$。通过对这些权重进行归一化，得到标准的限制算子 $R_{int}$，即 $R_{int} = \\frac{1}{S_{total}} W = \\frac{1}{16} W$。\n\n该问题考虑这样一种情况：粗网格节点 $(I,J)$ 靠近边界，导致模板支撑集对应“左”列的细网格节点位于计算域之外。我们假设矩阵 $W$ 的布局方式是其列对应于网格上的x方向，第一列即为“左”列。由于狄利克雷边界条件（边界上的值固定为 $0$，且不参与内部节点残差的计算），与此左列相关联的细网格节点的值是不可用的。\n\n修正程序规定，对应于这些域外细网格节点的权重必须设置为零。$W$ 左列中的未归一化权重为 $1$、$2$ 和 $1$。这些被移除的权重之和为：\n$$\nS_{removed} = 1 + 2 + 1 = 4\n$$\n剩余的未归一化权重位于 $W$ 的第二和第三列。这些剩余权重的总和 $S_{rem}$ 是总权重和减去被移除的权重和：\n$$\nS_{rem} = S_{total} - S_{removed} = 16 - 4 = 12\n$$\n剩余的未归一化权重矩阵（我们可称之为 $W_{bound, unnorm}$）是：\n$$\nW_{bound, unnorm} =\n\\begin{pmatrix}\n0  2  1 \\\\\n0  4  2 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n为确保修正后的限制算子能够保持常数，剩余的权重必须重新归一化，使其总和为 $1$。这可以通过将每个剩余的未归一化权重除以它们的总和 $S_{rem}$ 来实现。新的归一化因子是 $\\frac{1}{S_{rem}} = \\frac{1}{12}$。\n\n因此，得到的边界修正限制模板 $R_{bound}$ 为：\n$$\nR_{bound} = \\frac{1}{12} W_{bound, unnorm} = \\frac{1}{12}\n\\begin{pmatrix}\n0  2  1 \\\\\n0  4  2 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n将标量乘入矩阵并化简分数，得到最终的权重矩阵：\n$$\nR_{bound} =\n\\begin{pmatrix}\n\\frac{0}{12}  \\frac{2}{12}  \\frac{1}{12} \\\\\n\\frac{0}{12}  \\frac{4}{12}  \\frac{2}{12} \\\\\n\\frac{0}{12}  \\frac{2}{12}  \\frac{1}{12}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  \\frac{1}{6}  \\frac{1}{12} \\\\\n0  \\frac{1}{3}  \\frac{1}{6} \\\\\n0  \\frac{1}{6}  \\frac{1}{12}\n\\end{pmatrix}\n$$\n该矩阵表示邻近左侧直边界的粗网格节点的模板。其元素之和为 $0 + \\frac{1}{6} + \\frac{1}{12} + 0 + \\frac{1}{3} + \\frac{1}{6} + 0 + \\frac{1}{6} + \\frac{1}{12} = \\frac{2}{12} + \\frac{1}{12} + \\frac{4}{12} + \\frac{2}{12} + \\frac{2}{12} + \\frac{1}{12} = \\frac{12}{12} = 1$，这证实了该算子按要求保持了常数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{6}  \\frac{1}{12} \\\\\n0  \\frac{1}{3}  \\frac{1}{6} \\\\\n0  \\frac{1}{6}  \\frac{1}{12}\n\\end{pmatrix}\n}\n$$", "id": "3440509"}, {"introduction": "在探究了单个算子之后，我们现在可以看到它们如何在一个完整的多重网格循环中协同工作，以解决一个具有挑战性的非线性问题。全近似格式（FAS）是一种功能强大的多重网格变体，适用于非线性方程，它同时使用限制算子处理解状态和残差，并使用延长算子处理修正量。通过逐步完成一个完整的 FAS V-循环 [@problem_id:3357488]，您将对这些组件如何相互作用以加速非线性求解器收敛获得清晰的操作性理解。", "problem": "考虑一个代表计算流体力学的一维定常非线性扩散模型问题：$x \\in [0,1]$ 上的标量场 $u(x)$ 满足\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1,\n$$\n边界条件为狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。在均匀网格上，使用保守的中心有限体积/有限差分格式对算子进行离散化，其中对于网格间距 $h$ 和内部节点索引 $i$，离散非线性算子 $N^{h}(u)$ 为\n$$\n\\left(N^{h}(u)\\right)_{i} \\equiv - \\frac{1}{h} \\left( \\frac{1}{h} a_{i+\\frac{1}{2}} \\left( u_{i+1} - u_{i} \\right) - \\frac{1}{h} a_{i-\\frac{1}{2}} \\left( u_{i} - u_{i-1} \\right) \\right),\n$$\n其中非线性面扩散系数定义为\n$$\na_{i+\\frac{1}{2}} \\equiv 1 + \\left( \\frac{u_{i} + u_{i+1}}{2} \\right)^{2}.\n$$\n\n使用以下设置，完成一个全近似格式 (FAS) V-循环：\n\n- 细网格：$h = \\frac{1}{4}$，节点位于 $x = 0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1$，有三个内部未知量 $\\tilde{u}^{h} = \\left( \\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3} \\right)^{\\top}$，分别对应于 $x = \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}$。\n- 粗网格：$H = 2h = \\frac{1}{2}$，节点位于 $x = 0, \\frac{1}{2}, 1$，在 $x = \\frac{1}{2}$ 处有一个内部未知量 $u^{H}$。\n- 两个网格上的右端项都是常数源项 $1$ 的离散化，即对于 $i = 1,2,3$，$f^{h}_{i} = 1$，且在粗网格内部节点处 $f^{H} = 1$。\n- 初始细网格迭代值为零：$\\tilde{u}^{h} = (0,0,0)^{\\top}$。\n- 状态（网格函数）的限制算子为注入算子 $R_{u}: \\mathbb{R}^{3} \\to \\mathbb{R}$，定义为 $R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$。\n- 残差/亏量的限制算子为一维全加权算子 $R_{r}: \\mathbb{R}^{3} \\to \\mathbb{R}$，\n$$\nR_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}.\n$$\n- 修正量的延长算子 $P: \\mathbb{R} \\to \\mathbb{R}^{3}$ 是从粗网格内部修正量 $e^{H}$到细网格节点的线性插值，\n$$\nP(e^{H}) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top}.\n$$\n- 在粗网格上，从注入的粗网格状态开始，执行一步牛顿法来近似求解 FAS 粗网格方程。即，设 $F^{H}(u^{H}) \\equiv N^{H}(u^{H}) - \\left( f^{H}_{\\text{FAS}} \\right)$，取\n$$\nu^{H} \\leftarrow u^{H} - \\frac{F^{H}(u^{H})}{\\left( F^{H} \\right)'(u^{H})},\n$$\n从 $u^{H} = R_{u}(\\tilde{u}^{h})$ 开始。\n\n按以下步骤执行 FAS：\n\n1. 计算细网格亏量 $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$。\n2. 限制状态：$\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$，并写出在相同离散化原则下、间距为 $H$ 的粗网格非线性算子 $N^{H}(u^{H})$。\n3. 使用亏量和状态限制，以及在 $\\tilde{u}^{H}$ 处求值的粗网格算子，构造 FAS 粗网格右端项 $f^{H}_{\\text{FAS}}$。\n4. 对粗网格方程应用一步牛顿法以获得 $u^{H}$。\n5. 计算粗网格修正量 $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$。\n6. 延长修正量 $e^{h} \\equiv P(e^{H})$ 并更新细网格迭代值 $u^{h,\\text{new}} \\equiv \\tilde{u}^{h} + e^{h}$。\n\n在这些步骤中，明确写出 $R_{u}$、$R_{r}$ 和 $P$ 对状态和亏量的每次应用，并解释粗网格修正量如何修改细网格迭代值。最后，报告在中心节点 $x = \\frac{1}{2}$ 处更新后的细网格迭代值。请以单个实数形式提供最终答案。无需四舍五入，该量为无量纲量。", "solution": "用户希望对一个特定的一维非线性扩散问题执行一个全近似格式 (FAS) 的 V-循环。该过程被分解为问题陈述中指定的六个不同步骤。\n\n首先，我们建立数学背景。非线性边值问题是：\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1, \\quad x \\in [0,1]\n$$\n边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n\n细网格的间距为 $h = \\frac{1}{4}$，产生三个内部未知量 $\\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3}$，分别位于 $x_1 = \\frac{1}{4}$，$x_2 = \\frac{1}{2}$ 和 $x_3 = \\frac{3}{4}$。边界节点为 $u_0 = u(0) = 0$ 和 $u_4 = u(1) = 0$。细网格解的初始猜测为 $\\tilde{u}^{h} = (\\tilde{u}_1, \\tilde{u}_2, \\tilde{u}_3)^{\\top} = (0, 0, 0)^{\\top}$。源项被离散化为 $f^{h} = (1, 1, 1)^{\\top}$。\n\n粗网格的间距为 $H = 2h = \\frac{1}{2}$，在 $x = \\frac{1}{2}$ 处有一个内部未知量 $u^{H}$。边界节点为 $u^{H}_{0} = 0$ 和 $u^{H}_{2} = 0$。\n\n在内部节点 $i$ 处的细网格离散算子是：\n$$\n\\left(N^{h}(u)\\right)_{i} = - \\frac{1}{h^2} \\left( a_{i+\\frac{1}{2}} (u_{i+1} - u_{i}) - a_{i-\\frac{1}{2}} (u_{i} - u_{i-1}) \\right)\n$$\n其中 $a_{i+\\frac{1}{2}} = 1 + \\left( \\frac{u_i + u_{i+1}}{2} \\right)^{2}$ 且 $\\frac{1}{h^2} = \\frac{1}{(1/4)^2} = 16$。\n\n针对单个内部未知量 $u^H$ 的粗网格离散算子也类似地推导。令 $u^H$ 为中心节点的值。\n$$\nN^{H}(u^{H}) = - \\frac{1}{H^2} \\left( a_{1+\\frac{1}{2}}(u^{H}_{2} - u^{H}) - a_{1-\\frac{1}{2}}(u^{H} - u^{H}_{0}) \\right)\n$$\n当 $H=\\frac{1}{2}$，$u^{H}_{0}=0$，$u^{H}_{2}=0$ 时，扩散系数变为 $a_{1+\\frac{1}{2}} = 1 + (\\frac{u^H+0}{2})^2$ 和 $a_{1-\\frac{1}{2}} = 1 + (\\frac{0+u^H}{2})^2$。两者都等于 $1 + \\frac{(u^H)^2}{4}$。\n$$\nN^{H}(u^{H}) = -4 \\left( \\left(1 + \\frac{(u^H)^2}{4}\\right)(0 - u^H) - \\left(1 + \\frac{(u^H)^2}{4}\\right)(u^H - 0) \\right) = -4 \\left( -2u^H \\left(1 + \\frac{(u^H)^2}{4}\\right) \\right) = 8u^H + 2(u^H)^3\n$$\n现在我们执行 FAS V-循环的步骤。\n\n**步骤1：计算细网格亏量 $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$**\n初始迭代值为 $\\tilde{u}^{h} = (0,0,0)^{\\top}$。边界值为 $\\tilde{u}_0 = 0$ 和 $\\tilde{u}_4 = 0$。\n首先计算面扩散系数：\n$$\na_{i+\\frac{1}{2}} = 1 + \\left( \\frac{\\tilde{u}_i + \\tilde{u}_{i+1}}{2} \\right)^2 = 1 + \\left( \\frac{0 + 0}{2} \\right)^2 = 1\n$$\n这对所有面都成立。\n然后对每个内部节点 $i=1,2,3$ 计算离散算子 $N^{h}(\\tilde{u}^{h})$：\n$$\n\\left(N^{h}(\\tilde{u}^{h})\\right)_{i} = -16 \\left( 1(\\tilde{u}_{i+1} - \\tilde{u}_i) - 1(\\tilde{u}_i - \\tilde{u}_{i-1}) \\right) = -16 \\left( 1(0 - 0) - 1(0 - 0) \\right) = 0\n$$\n因此，$N^{h}(\\tilde{u}^{h}) = (0,0,0)^{\\top}$。\n亏量（或残差）为：\n$$\nd^{h} = f^{h} - N^{h}(\\tilde{u}^{h}) = (1,1,1)^{\\top} - (0,0,0)^{\\top} = (1,1,1)^{\\top}\n$$\n\n**步骤2：限制状态：$\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$**\n状态限制算子 $R_u$ 定义为注入：$R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$。\n将此应用于当前的细网格迭代值：\n$$\n\\tilde{u}^{H} = R_{u}\\left((0,0,0)^{\\top}\\right) = 0\n$$\n\n**步骤3：构造 FAS 粗网格右端项 $f^{H}_{\\text{FAS}}$**\n粗网格方程为 $N^H(u^H) = f^H_{\\text{FAS}}$，其中 FAS 右端项定义为：\n$$\nf^{H}_{\\text{FAS}} = N^{H}(\\tilde{u}^{H}) + R_{r}(f^{h} - N^{h}(\\tilde{u}^{h})) = N^{H}(\\tilde{u}^{H}) + R_{r}(d^{h})\n$$\n我们计算右端项的每一项：\n- 从步骤2可知，$\\tilde{u}^{H} = 0$。因此，$N^{H}(\\tilde{u}^{H}) = N^{H}(0) = 8(0) + 2(0)^3 = 0$。\n- 残差限制算子是一维全加权算子 $R_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}$。从步骤1可知，$d^h=(1,1,1)^{\\top}$。\n$$\nR_{r}(d^{h}) = \\frac{1}{4}(1) + \\frac{1}{2}(1) + \\frac{1}{4}(1) = 1\n$$\n将这些结果结合起来，得到 FAS 右端项：\n$$\nf^{H}_{\\text{FAS}} = 0 + 1 = 1\n$$\n待近似求解的粗网格方程为 $N^{H}(u^{H}) = 1$，即 $8u^{H} + 2(u^{H})^3 = 1$。\n\n**步骤4：对粗网格方程应用一步牛顿法以获得 $u^{H}$**\n我们从 $u^{H}_{\\text{start}} = \\tilde{u}^H = 0$ 开始，使用一步牛顿法求解 $F^{H}(u^{H}) \\equiv 8u^{H} + 2(u^{H})^3 - 1 = 0$。\n牛顿法更新规则是 $u^{H}_{\\text{new}} = u^{H}_{\\text{old}} - \\frac{F^{H}(u^{H}_{\\text{old}})}{(F^{H})'(u^{H}_{\\text{old}})}$。\n$F^{H}$ 的导数是 $(F^{H})'(u^{H}) = \\frac{d}{du^H}(8u^{H} + 2(u^{H})^3 - 1) = 8 + 6(u^{H})^2$。\n我们在起始点 $u^{H}_{\\text{old}} = 0$ 处计算 $F^H$ 及其导数：\n$$\nF^{H}(0) = 8(0) + 2(0)^3 - 1 = -1\n$$\n$$\n(F^{H})'(0) = 8 + 6(0)^2 = 8\n$$\n更新后的粗网格解 $u^H$ 是：\n$$\nu^{H} = 0 - \\frac{-1}{8} = \\frac{1}{8}\n$$\n\n**步骤5：计算粗网格修正量 $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$**\n粗网格修正量是新粗网格解与限制后的细网格解之间的差值：\n$$\ne^{H} = u^{H} - \\tilde{u}^{H} = \\frac{1}{8} - 0 = \\frac{1}{8}\n$$\n\n**步骤6：延长修正量 $e^{h} \\equiv P(e^{H})$ 并更新细网格迭代值**\n粗网格修正量 $e^H$ 使用延长算子 $P$ 插值到细网格。将 $P$ 应用于粗网格修正量 $e^H$ 得到细网格修正向量 $e^h$：\n$$\ne^{h} = P(e^H) = P\\left(\\frac{1}{8}\\right) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top} = \\left( \\frac{1}{2} \\cdot \\frac{1}{8}, \\; \\frac{1}{8}, \\; \\frac{1}{2} \\cdot \\frac{1}{8} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\n然后通过加上此修正量来更新细网格迭代值。此步骤将粗网格上捕获的低频误差信息注入回细网格解中：\n$$\nu^{h,\\text{new}} \\equiv \\tilde{u}^{h} + e^{h}\n$$\n$$\nu^{h,\\text{new}} = (0, 0, 0)^{\\top} + \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\n问题要求的是在中心节点 $x = \\frac{1}{2}$ 处更新后的值，这对应于向量 $u^{h,\\text{new}}$ 的第二个分量。该值为 $\\frac{1}{8}$。", "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$", "id": "3357488"}]}