{"hands_on_practices": [{"introduction": "代数多重网格（AMG）的第一步是分析系统矩阵，以确定哪些未知数之間存在“强”耦合关系。本练习提供了一个具体的分步计算过程，用于计算典型的一维拉普拉斯矩阵的经典Ruge–Stüben连接强度[@problem_id:3449289]。通过这个练习，你可以建立起对AMG如何从代数角度“看待”问题的直观理解。", "problem": "考虑矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$，其定义为 $A=\\operatorname{tridiag}(-1,2,-1)$。该矩阵是一个对称正定 $M$-矩阵，它源于在均匀网格上采用齐次狄利克雷边界条件对一维泊松算子进行标准二阶有限差分离散化。设连接强度阈值为 $\\theta=0.25$。使用经典的 Ruge–Stüben 对 $M$-矩阵的连接强度定义：对于每一行 $i$，一个非对角索引 $j \\neq i$ 是 $i$ 的强邻居，如果 $a_{ij}  0$ 并且\n$$\n- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr).\n$$\n任务：\n1. 对每一行 $i \\in \\{1,2,3,4,5\\}$，确定其强邻居集合 $N^{s}_{i}(\\theta)$，并直接根据矩阵 $A$ 的元素和上述定义来证明你的结果。\n2. 设 $G$ 是一个无向强度图，当且仅当 $i \\in N^{s}_{j}(\\theta)$ 或 $j \\in N^{s}_{i}(\\theta)$ 时，图中存在一条无向边 $\\{i,j\\}$。设 $B$ 表示 $G$ 的邻接矩阵。计算谱半径 $\\rho(B)$，并将最终答案表示为一个精确值（无四舍五入）。\n你的最终答案必须是等于 $\\rho(B)$ 的单个实数，不带单位。", "solution": "该问题要求我们执行一个与代数多重网格（AMG）方法中连接强度概念相关的两部分分析。首先，我们必须确定给定矩阵的强邻居集合。其次，我们必须基于这些连接构造一个图，并计算其邻接矩阵的谱半径。\n\n给定矩阵为 $A \\in \\mathbb{R}^{5 \\times 5}$，具体为 $A=\\operatorname{tridiag}(-1,2,-1)$。明确地写出该矩阵，我们有：\n$$\nA = \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}\n$$\n连接强度阈值给定为 $\\theta=0.25$。\n对于行 $i$，其强邻居 $j$（其中 $j \\neq i$）的定义有两个条件：\n1. 非对角元素 $a_{ij}$ 必须为负，即 $a_{ij}  0$。\n2. 该元素的大小必须满足不等式：$- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr)$。\n\n**第 1 部分：确定强邻居集合 $N^{s}_{i}(\\theta)$**\n\n我们将分别分析每一行 $i \\in \\{1, 2, 3, 4, 5\\}$。\n\n对于行 $i=1$：\n唯一的负非对角元素是 $a_{12}=-1$。\n我们计算该行中负非对角元素的最大绝对值：\n$\\max_{k \\neq 1} (-a_{1k}) = \\max(-a_{12}, -a_{13}, \\dots) = \\max(1, 0, \\dots) = 1$。\n邻居 $j$ 成为强邻居的阈值条件是 $-a_{1j} \\ge \\theta \\times 1 = 0.25$。\n对于 $j=2$，我们有 $-a_{12} = -(-1) = 1$。因为 $1 \\ge 0.25$，所以到节点 2 的连接是强的。\n因此，行 1 的强邻居集合是 $N^{s}_{1}(\\theta) = \\{2\\}$。\n\n对于行 $i=2$：\n负非对角元素为 $a_{21}=-1$ 和 $a_{23}=-1$。\n最大绝对值为 $\\max_{k \\neq 2} (-a_{2k}) = \\max(-a_{21}, -a_{23}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{2j} \\ge 0.25 \\times 1 = 0.25$。\n对于 $j=1$：$-a_{21} = 1$，满足 $\\ge 0.25$。\n对于 $j=3$：$-a_{23} = 1$，满足 $\\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{2}(\\theta) = \\{1, 3\\}$。\n\n对于行 $i=3$：\n负非对角元素为 $a_{32}=-1$ 和 $a_{34}=-1$。\n最大绝对值为 $\\max_{k \\neq 3} (-a_{3k}) = \\max(-a_{32}, -a_{34}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{3j} \\ge 0.25$。\n对于 $j=2$：$-a_{32} = 1 \\ge 0.25$。\n对于 $j=4$：$-a_{34} = 1 \\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{3}(\\theta) = \\{2, 4\\}$。\n\n对于行 $i=4$：\n负非对角元素为 $a_{43}=-1$ 和 $a_{45}=-1$。\n最大绝对值为 $\\max_{k \\neq 4} (-a_{4k}) = \\max(-a_{43}, -a_{45}) = \\max(1, 1) = 1$。\n阈值条件是 $-a_{4j} \\ge 0.25$。\n对于 $j=3$：$-a_{43} = 1 \\ge 0.25$。\n对于 $j=5$：$-a_{45} = 1 \\ge 0.25$。\n两个连接都是强的。因此，$N^{s}_{4}(\\theta) = \\{3, 5\\}$。\n\n对于行 $i=5$：\n唯一的负非对角元素是 $a_{54}=-1$。\n最大绝对值为 $\\max_{k \\neq 5} (-a_{5k}) = \\max(-a_{54}) = 1$。\n阈值条件是 $-a_{5j} \\ge 0.25$。\n对于 $j=4$：$-a_{54} = 1 \\ge 0.25$。该连接是强的。\n因此，$N^{s}_{5}(\\theta) = \\{4\\}$。\n\n总结来说，对于 $\\theta = 0.25$，矩阵 $A$ 中所有非零的非对角连接都被分类为强连接。\n\n**第 2 部分：计算谱半径 $\\rho(B)$**\n\n无向强度图 $G$ 中存在边 $\\{i,j\\}$ 当且仅当 $i \\in N^{s}_{j}(\\theta)$ 或 $j \\in N^{s}_{i}(\\theta)$。根据我们在第 1 部分的发现：\n- 边 $\\{1,2\\}$：$2 \\in N^{s}_{1}(\\theta)$（且 $1 \\in N^{s}_{2}(\\theta)$）。所以，存在一条边。\n- 边 $\\{2,3\\}$：$3 \\in N^{s}_{2}(\\theta)$（且 $2 \\in N^{s}_{3}(\\theta)$）。所以，存在一条边。\n- 边 $\\{3,4\\}$：$4 \\in N^{s}_{3}(\\theta)$（且 $3 \\in N^{s}_{4}(\\theta)$）。所以，存在一条边。\n- 边 $\\{4,5\\}$：$5 \\in N^{s}_{4}(\\theta)$（且 $4 \\in N^{s}_{5}(\\theta)$）。所以，存在一条边。\n不存在其他连接。例如，对于 $\\{1,3\\}$，$3 \\notin N^{s}_{1}(\\theta)$ 且 $1 \\notin N^{s}_{3}(\\theta)$。\n最终得到的图 $G$ 是一个有 5 个顶点的路径图，可画为 $1-2-3-4-5$。\n\n该图 $G$ 的邻接矩阵 $B$ 是一个 $5 \\times 5$ 矩阵，其中如果顶点 $i$ 和 $j$ 之间存在边，则 $B_{ij} = 1$，否则 $B_{ij} = 0$。\n$$\nB = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\n这是一个对称三对角矩阵。对于一个形式为 $\\operatorname{tridiag}(c,a,b)$ 的 $n \\times n$ 三对角矩阵，其特征值 $\\lambda_k$ 由公式 $\\lambda_k = a + 2\\sqrt{bc}\\cos\\left(\\frac{k\\pi}{n+1}\\right)$ 给出，其中 $k=1, 2, \\dots, n$。\n对于我们的矩阵 $B$，我们有 $n=5$, $a=0$ 且 $b=c=1$。其特征值为：\n$$\n\\lambda_k = 0 + 2\\sqrt{1 \\cdot 1} \\cos\\left(\\frac{k\\pi}{5+1}\\right) = 2 \\cos\\left(\\frac{k\\pi}{6}\\right), \\quad k=1,2,3,4,5.\n$$\n我们来计算这些特征值：\n- 对于 $k=1$：$\\lambda_1 = 2 \\cos\\left(\\frac{\\pi}{6}\\right) = 2 \\left(\\frac{\\sqrt{3}}{2}\\right) = \\sqrt{3}$。\n- 对于 $k=2$：$\\lambda_2 = 2 \\cos\\left(\\frac{2\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{3}\\right) = 2 \\left(\\frac{1}{2}\\right) = 1$。\n- 对于 $k=3$：$\\lambda_3 = 2 \\cos\\left(\\frac{3\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{2}\\right) = 2(0) = 0$。\n- 对于 $k=4$：$\\lambda_4 = 2 \\cos\\left(\\frac{4\\pi}{6}\\right) = 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 2 \\left(-\\frac{1}{2}\\right) = -1$。\n- 对于 $k=5$：$\\lambda_5 = 2 \\cos\\left(\\frac{5\\pi}{6}\\right) = 2 \\left(-\\frac{\\sqrt{3}}{2}\\right) = -\\sqrt{3}$。\n\n矩阵 $B$ 的特征值集合为 $\\{\\sqrt{3}, 1, 0, -1, -\\sqrt{3}\\}$。\n谱半径 $\\rho(B)$ 是特征值绝对值的最大值：\n$$\n\\rho(B) = \\max_{k} |\\lambda_k| = \\max\\left\\{|\\sqrt{3}|, |1|, |0|, |-1|, |-\\sqrt{3}|\\right\\} = \\max\\{\\sqrt{3}, 1, 0\\} = \\sqrt{3}.\n$$\n邻接矩阵 $B$ 的谱半径为 $\\sqrt{3}$。", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3449289"}, {"introduction": "一旦我们识别出强连接，下一步就是选择一个“粗网格”——一个变量子集，用以在更小的尺度上表示问题。本练习将引导你完成并行修正独立集（PMIS）算法，这是一种标准的选择方法[@problem_id:3449313]。你将把从一个更复杂的一维扩散问题中导出的连接强度信息应用到这个算法中，从而理解连接强度的抽象概念与构建粗网格的具体任务之间的直接联系。", "problem": "考虑单位区间上具有齐次狄利克雷边界条件的一维扩散算子 $-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right)$。使用二阶中心有限差分在具有 $8$ 个内部节点的均匀网格上离散化该算子。设离散算子由对称三对角矩阵 $A \\in \\mathbb{R}^{8 \\times 8}$ 表示，其元素定义为 $a_{i,i} = b_{i-1} + b_{i}$，$a_{i,i-1} = -b_{i-1}$，以及 $a_{i,i+1} = -b_{i}$，其中 $i = 1, \\dots, 8$，并约定 $b_{0} = 0$ 和 $b_{8} = 0$。假设面电导率 $\\{b_{i}\\}_{i=1}^{7}$ 由 $b_{1} = 1$，$b_{2} = 0.2$，$b_{3} = 0.8$，$b_{4} = 0.8$，$b_{5} = 0.1$，$b_{6} = 1.2$ 和 $b_{7} = 0.3$ 给出。\n\n在代数多重网格 (AMG) 中，连接强度的定义如下：对于每个行索引 $i$，强依赖关系集为 $S_{i} := \\{j \\neq i : -a_{i,j} \\ge \\theta \\max_{k \\neq i}(-a_{i,k})\\}$，阈值 $\\theta = \\frac{1}{4}$。将 $S_{i}$ 解释为对节点 $i$ 有强影响的节点 $j$ 的集合。\n\n在有向强度图上执行并行修正独立集 (PMIS) 粗化，该图的顶点集为 $\\{1,2,\\dots,8\\}$，有向边为 $i \\to j$（对于 $j \\in S_{i}$）。使用以下 PMIS 选择规则：分配权重 $w_{1} = 0.40$，$w_{2} = 0.95$，$w_{3} = 0.60$，$w_{4} = 0.55$，$w_{5} = 0.70$，$w_{6} = 0.20$，$w_{7} = 0.85$ 和 $w_{8} = 0.65$，选择所有满足 $w_{i}  w_{j}$（对于每个 $j \\in S_{i}$）的节点 $i$，将它们添加到粗集 $C$ 中，然后通过从考虑范围中移除每个节点 $\\ell$ 来强制独立性，其中存在一个选定的节点 $i$ 满足 $i \\in S_{\\ell}$。迭代此选择和移除过程，直到所有节点都被分类。细集为 $F := \\{1,2,\\dots,8\\} \\setminus C$。如果 F 中的任何节点没有强粗邻居，即对于某个 $i \\in F$ 存在 $S_{i} \\cap C = \\varnothing$ 的情况，则将该节点提升到 $C$，以使每个细节点都至少有一个强粗邻居。\n\n设 R 是由 $R := \\sum_{i \\in F} \\mathbf{1}_{|S_{i} \\cap C| \\ge 1}$ 定义的验证量，其中 $\\mathbf{1}_{\\cdot}$ 表示指示函数。计算所述矩阵 $A$、强度阈值 $\\theta$ 和 PMIS 权重的 R 值。以单个实数值形式提供您的最终答案。无需四舍五入。", "solution": "我们按照以下步骤解决此问题：\n\n### 步骤 1：构建矩阵 $A$\n矩阵 A 的非零元素是使用给定的公式和电导率值 $b_i$ 计算的。\n电导率向量为 $b = [0, 1, 0.2, 0.8, 0.8, 0.1, 1.2, 0.3, 0]$，对应索引 $i=0, \\dots, 8$。\n对于 $i=1$：$a_{1,1} = b_0+b_1 = 0+1=1$；$a_{1,2} = -b_1 = -1$。\n对于 $i=2$：$a_{2,1} = -b_1 = -1$；$a_{2,2} = b_1+b_2 = 1+0.2=1.2$；$a_{2,3} = -b_2 = -0.2$。\n对于 $i=3$：$a_{3,2} = -b_2 = -0.2$；$a_{3,3} = b_2+b_3 = 0.2+0.8=1$；$a_{3,4} = -b_3 = -0.8$。\n对于 $i=4$：$a_{4,3} = -b_3 = -0.8$；$a_{4,4} = b_3+b_4 = 0.8+0.8=1.6$；$a_{4,5} = -b_4 = -0.8$。\n对于 $i=5$：$a_{5,4} = -b_4 = -0.8$；$a_{5,5} = b_4+b_5 = 0.8+0.1=0.9$；$a_{5,6} = -b_5 = -0.1$。\n对于 $i=6$：$a_{6,5} = -b_5 = -0.1$；$a_{6,6} = b_5+b_6 = 0.1+1.2=1.3$；$a_{6,7} = -b_6 = -1.2$。\n对于 $i=7$：$a_{7,6} = -b_6 = -1.2$；$a_{7,7} = b_6+b_7 = 1.2+0.3=1.5$；$a_{7,8} = -b_7 = -0.3$。\n对于 $i=8$：$a_{8,7} = -b_7 = -0.3$；$a_{8,8} = b_7+b_8 = 0.3+0=0.3$。\n\n### 步骤 2：确定连接强度集 $S_i$\n连接强度由 $S_{i} := \\{j \\neq i : -a_{i,j} \\ge \\theta \\max_{k \\neq i}(-a_{i,k})\\}$ 定义，其中 $\\theta = \\frac{1}{4} = 0.25$。\n-   对于 $i=1$：非对角元素为 $a_{1,2}=-1$。所以 $-a_{1,2}=1$。$\\max_{k \\neq 1}(-a_{1,k}) = 1$。条件是 $-a_{1,2} \\ge 0.25 \\times 1$。$1 \\ge 0.25$，成立。$S_1 = \\{2\\}$。\n-   对于 $i=2$：非对角元素为 $a_{2,1}=-1$，$a_{2,3}=-0.2$。所以 $-a_{2,1}=1$，$-a_{2,3}=0.2$。$\\max(1, 0.2) = 1$。阈值为 $0.25 \\times 1 = 0.25$。\n    对于 $j=1$：$-a_{2,1}=1 \\ge 0.25$。成立。\n    对于 $j=3$：$-a_{2,3}=0.2  0.25$。不成立。\n    $S_2 = \\{1\\}$。\n-   对于 $i=3$：$-a_{3,2}=0.2$，$-a_{3,4}=0.8$。$\\max(0.2, 0.8) = 0.8$。阈值为 $0.25 \\times 0.8 = 0.2$。\n    对于 $j=2$：$-a_{3,2}=0.2 \\ge 0.2$。成立。\n    对于 $j=4$：$-a_{3,4}=0.8 \\ge 0.2$。成立。\n    $S_3 = \\{2, 4\\}$。\n-   对于 $i=4$：$-a_{4,3}=0.8$，$-a_{4,5}=0.8$。$\\max(0.8, 0.8) = 0.8$。阈值为 $0.25 \\times 0.8 = 0.2$。\n    对于 $j=3$：$-a_{4,3}=0.8 \\ge 0.2$。成立。\n    对于 $j=5$：$-a_{4,5}=0.8 \\ge 0.2$。成立。\n    $S_4 = \\{3, 5\\}$。\n-   对于 $i=5$：$-a_{5,4}=0.8$，$-a_{5,6}=0.1$。$\\max(0.8, 0.1) = 0.8$。阈值为 $0.25 \\times 0.8 = 0.2$。\n    对于 $j=4$：$-a_{5,4}=0.8 \\ge 0.2$。成立。\n    对于 $j=6$：$-a_{5,6}=0.1  0.2$。不成立。\n    $S_5 = \\{4\\}$。\n-   对于 $i=6$：$-a_{6,5}=0.1$，$-a_{6,7}=1.2$。$\\max(0.1, 1.2) = 1.2$。阈值为 $0.25 \\times 1.2 = 0.3$。\n    对于 $j=5$：$-a_{6,5}=0.1  0.3$。不成立。\n    对于 $j=7$：$-a_{6,7}=1.2 \\ge 0.3$。成立。\n    $S_6 = \\{7\\}$。\n-   对于 $i=7$：$-a_{7,6}=1.2$，$-a_{7,8}=0.3$。$\\max(1.2, 0.3) = 1.2$。阈值为 $0.25 \\times 1.2 = 0.3$。\n    对于 $j=6$：$-a_{7,6}=1.2 \\ge 0.3$。成立。\n    对于 $j=8$：$-a_{7,8}=0.3 \\ge 0.3$。成立。\n    $S_7 = \\{6, 8\\}$。\n-   对于 $i=8$：$-a_{8,7}=0.3$。$\\max=0.3$。阈值为 $0.25 \\times 0.3 = 0.075$。\n    对于 $j=7$：$-a_{8,7}=0.3 \\ge 0.075$。成立。\n    $S_8 = \\{7\\}$。\n\n强度集总结：$S_1=\\{2\\}, S_2=\\{1\\}, S_3=\\{2,4\\}, S_4=\\{3,5\\}, S_5=\\{4\\}, S_6=\\{7\\}, S_7=\\{6,8\\}, S_8=\\{7\\}$。\n\n### 步骤 3：执行 PMIS 粗化\n设 $U = \\{1, 2, 3, 4, 5, 6, 7, 8\\}$ 为未定节点集。权重为 $w = [0.40, 0.95, 0.60, 0.55, 0.70, 0.20, 0.85, 0.65]$。\n**第一轮：**\n-   选择：找到初始粗候选集 $I = \\{i \\in U : w_i  w_j, \\forall j \\in S_i\\}$。\n    -   $i=1$: $S_1=\\{2\\}$。$w_1=0.40  w_2=0.95$。不选。\n    -   $i=2$: $S_2=\\{1\\}$。$w_2=0.95 > w_1=0.40$。选 $2$。\n    -   $i=3$: $S_3=\\{2,4\\}$。$w_3=0.60  w_2=0.95$。不选。\n    -   $i=4$: $S_4=\\{3,5\\}$。$w_4=0.55  w_3=0.60$。不选。\n    -   $i=5$: $S_5=\\{4\\}$。$w_5=0.70 > w_4=0.55$。选 $5$。\n    -   $i=6$: $S_6=\\{7\\}$。$w_6=0.20  w_7=0.85$。不选。\n    -   $i=7$: $S_7=\\{6,8\\}$。$w_7=0.85 > w_6=0.20$ 和 $w_7 > w_8=0.65$。选 $7$。\n    -   $i=8$: $S_8=\\{7\\}$。$w_8=0.65  w_7=0.85$。不选。\n-   选定的粗节点集为 $I=\\{2, 5, 7\\}$。这些节点被添加到粗集：$C = \\{2, 5, 7\\}$。\n-   移除：对于选定的节点 $i \\in I$，满足 $i \\in S_\\ell$ 的节点 $\\ell$ 被放入细集 $F$。\n    -   $S_1=\\{2\\}$ 且 $2 \\in I \\implies 1 \\in F$。\n    -   $S_3=\\{2,4\\}$ 且 $2 \\in I \\implies 3 \\in F$。\n    -   $S_4=\\{3,5\\}$ 且 $5 \\in I \\implies 4 \\in F$。\n    -   $S_6=\\{7\\}$ 且 $7 \\in I \\implies 6 \\in F$。\n    -   $S_8=\\{7\\}$ 且 $7 \\in I \\implies 8 \\in F$。\n-   细集为 $F=\\{1, 3, 4, 6, 8\\}$。\n-   所有节点 $\\{1, \\dots, 8\\}$ 现在都已被分类为 $C$ 或 $F$。迭代过程在一轮后终止。\n\n初始划分为 $C = \\{2, 5, 7\\}$ 和 $F = \\{1, 3, 4, 6, 8\\}$。\n\n### 步骤 4：应用提升规则\n我们检查是否有任何节点 $i \\in F$ 没有强粗邻居，即 $S_i \\cap C = \\varnothing$。\n-   对于 $i=1 \\in F$，$S_1=\\{2\\}$。$S_1 \\cap C = \\{2\\} \\cap \\{2,5,7\\} = \\{2\\} \\neq \\varnothing$。\n-   对于 $i=3 \\in F$，$S_3=\\{2,4\\}$。$S_3 \\cap C = \\{2,4\\} \\cap \\{2,5,7\\} = \\{2\\} \\neq \\varnothing$。\n-   对于 $i=4 \\in F$，$S_4=\\{3,5\\}$。$S_4 \\cap C = \\{3,5\\} \\cap \\{2,5,7\\} = \\{5\\} \\neq \\varnothing$。\n-   对于 $i=6 \\in F$，$S_6=\\{7\\}$。$S_6 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\} \\neq \\varnothing$。\n-   对于 $i=8 \\in F$，$S_8=\\{7\\}$。$S_8 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\} \\neq \\varnothing$。\nF中的每个节点都至少有一个强粗邻居。没有节点被提升。\n最终的集合是 $C_{final} = C = \\{2, 5, 7\\}$ 和 $F_{final} = F = \\{1, 3, 4, 6, 8\\}$。\n\n### 步骤 5：计算量 R\n量 R 定义为 $R := \\sum_{i \\in F_{final}} \\mathbf{1}_{|S_{i} \\cap C_{final}| \\ge 1}$。这个和计算的是最终细集 $F_{final}$ 中拥有至少一个强邻居在最终粗集 $C_{final}$ 中的节点数量。\n正如步骤 4 中所确定的，每个节点 $i \\in F_{final}$ 都满足条件 $|S_{i} \\cap C_{final}| \\ge 1$。因此，对于每个 $i \\in F_{final}$，指示函数 $\\mathbf{1}_{|S_{i} \\cap C_{final}| \\ge 1}$ 等于 $1$。\nR 的值是这些指示函数的总和，也就是 $F_{final}$ 中节点的数量。\n$$R = \\sum_{i \\in \\{1, 3, 4, 6, 8\\}} 1 = |F_{final}| = 5$$", "answer": "$$\\boxed{5}$$", "id": "3449313"}, {"introduction": "AMG设置阶段的最终目标是构建一个插值算子 $P$，它能准确地将信息从粗网格传递到细网格。本练习揭示了经典连接强度定义的一个局限性，并引入了一个更强大的“代数距离”概念来识别那些在矩阵图中并非直接相邻的强连接[@problem_id:3449351]。然后，它展示了如何利用这种对连接性的更深刻理解，通过拟合代数光滑向量来构建一个更精确的插值算子。", "problem": "考虑一个一维域上的标量扩散模型问题 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，带有齐次狄利克雷边界条件，通过在三个内部网格点上使用标准二阶中心有限差分进行离散化。得到的线性系统为 $A u = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个对称正定（SPD）矩阵，具有 $M$-矩阵形式（对角线元素为正，非对角线元素为非正）：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n您将分析连接强度，并在代数多重网格（AMG）的背景下确定插值选择，明确地捕捉跨越零非对角线元素的间接耦合。\n\n1. 使用源于 Ruge–Stüben 方法的经典连接强度定义，如果 $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$，则节点 $j \\neq i$ 是 $i$ 的一个强邻居。计算当 $\\theta = 0.25$ 时，对于 $i \\in \\{1,2,3\\}$ 的经典强度集 $S_{i}^{\\mathrm{RS}}$。\n\n2. 使用两个代表扩散低能误差分量的测试向量，在矩阵 $A$ 的图上定义一个代数距离连接强度：\n$$\nv^{(1)} = (1,\\,1,\\,1)^{\\top}, \\qquad v^{(2)} = (0,\\,1,\\,2)^{\\top}.\n$$\n对于每个满足 $a_{ij} \\neq 0$ 的现有边 $(i,j)$，定义局部失配\n$$\nm_{ij} \\;=\\; \\left( \\sum_{t=1}^{2} \\big(v_{i}^{(t)} - v_{j}^{(t)}\\big)^{2} \\right)^{1/2}.\n$$\n对于满足 $a_{13} = 0$ 的非边对 $(1,3)$，将间接代数距离 $d_{13}$ 定义为在 $A$ 的图上从 $1$ 到 $3$ 的所有路径中，边失配之和的最小值，即：\n$$\nd_{13} \\;=\\; \\min_{\\text{paths } 1 \\to 3} \\sum_{\\text{edges }(p,q)\\text{ on path}} m_{pq}.\n$$\n使用阈值 $\\tau = 2$，如果 $d_{ij} \\le \\tau$，则声明 $(i,j)$ 为代数强连接。计算 $m_{12}$、$m_{23}$、$d_{13}$，并说明在此标准下 $(1,3)$ 是否为代数强连接。\n\n3. 假设粗集为 $C = \\{1,\\,3\\}$，细集为 $F = \\{2\\}$。基于上述代数距离评估，为细节点 $2$ 选择插值：使用局部最小二乘插值，并约束其能重构常数近零空间分量。具体来说，通过最小化\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\n并在重构约束 $w_{21} + w_{23} = 1$ 下，确定权重 $w_{21}$ 和 $w_{23}$。计算细节点 $2$ 相对于粗节点 $1$ 的插值权重 $w_{21}$ 的精确值。以精确值的形式给出最终答案，不要四舍五入，也不要带单位。", "solution": "**第 1 部分：经典连接强度**\n\n我们使用定义 $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$ 和参数 $\\theta = 0.25$ 来计算 $i \\in \\{1, 2, 3\\}$ 的强度集 $S_{i}^{\\mathrm{RS}}$。\n矩阵为 $A = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}$。\n\n_对于节点 $i=1$_：\n非对角线元素为 $a_{12} = -1$ 和 $a_{13} = 0$。其负值为 $-a_{12} = 1$ 和 $-a_{13} = 0$。\n它们的最大值为 $\\max_{k \\neq 1}(-a_{1k}) = \\max(1, 0) = 1$。\n强连接的阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=2$：$-a_{12} = 1 \\ge 0.25$。因此，节点 2 是节点 1 的强邻居。\n- 对于 $j=3$：$-a_{13} = 0  0.25$。因此，节点 3 是节点 1 的弱邻居。\n节点 1 的强度集是 $S_{1}^{\\mathrm{RS}} = \\{2\\}$。\n\n_对于节点 $i=2$_：\n非对角线元素为 $a_{21} = -1$ 和 $a_{23} = -1$。其负值为 $-a_{21} = 1$ 和 $-a_{23} = 1$。\n它们的最大值为 $\\max_{k \\neq 2}(-a_{2k}) = \\max(1, 1) = 1$。\n阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=1$：$-a_{21} = 1 \\ge 0.25$。因此，节点 1 是节点 2 的强邻居。\n- 对于 $j=3$：$-a_{23} = 1 \\ge 0.25$。因此，节点 3 是节点 2 的强邻居。\n节点 2 的强度集是 $S_{2}^{\\mathrm{RS}} = \\{1, 3\\}$。\n\n_对于节点 $i=3$_：\n根据与节点 1 的对称性，非对角线元素为 $a_{31} = 0$ 和 $a_{32} = -1$。其负值为 $-a_{31} = 0$ 和 $-a_{32} = 1$。\n最大值为 $\\max_{k \\neq 3}(-a_{3k}) = \\max(0, 1) = 1$。\n阈值为 $\\theta \\cdot 1 = 0.25$。\n- 对于 $j=1$：$-a_{31} = 0  0.25$。因此，节点 1 是节点 3 的弱邻居。\n- 对于 $j=2$：$-a_{32} = 1 \\ge 0.25$。因此，节点 2 是节点 3 的强邻居。\n节点 3 的强度集是 $S_{3}^{\\mathrm{RS}} = \\{2\\}$。\n\n**第 2 部分：代数距离连接强度**\n\n首先，我们为满足 $a_{ij} \\neq 0$ 的现有边 $(i,j)$ 计算局部失配 $m_{ij}$。$A$ 的图有边 $(1,2)$ 和 $(2,3)$。测试向量为 $v^{(1)} = (1, 1, 1)^{\\top}$ 和 $v^{(2)} = (0, 1, 2)^{\\top}$。\n\n_计算 $m_{12}$_：\n向量分量为 $v_1^{(1)}=1$，$v_2^{(1)}=1$ 和 $v_1^{(2)}=0$，$v_2^{(2)}=1$。\n$$\nm_{12} = \\left( (v_{1}^{(1)} - v_{2}^{(1)})^{2} + (v_{1}^{(2)} - v_{2}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (0-1)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_计算 $m_{23}$_：\n向量分量为 $v_2^{(1)}=1$，$v_3^{(1)}=1$ 和 $v_2^{(2)}=1$，$v_3^{(2)}=2$。\n$$\nm_{23} = \\left( (v_{2}^{(1)} - v_{3}^{(1)})^{2} + (v_{2}^{(2)} - v_{3}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (1-2)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_计算 $d_{13}$_：\n间接距离 $d_{13}$ 是失配的最短路径和。在 $A$ 的图上，从节点 1 到节点 3 的唯一路径是 $1 \\to 2 \\to 3$。\n$$\nd_{13} = m_{12} + m_{23} = 1 + 1 = 2.\n$$\n\n_对 $(1,3)$ 的强度评估_：\n代数强连接的条件是 $d_{ij} \\le \\tau$，其中 $\\tau=2$。\n由于 $d_{13} = 2$，我们有 $d_{13} \\le 2$。因此，即使 $a_{13}=0$，对 $(1,3)$ 也被认为是代数强连接。\n\n**第 3 部分：插值权重计算**\n\n我们需要找到权重 $w_{21}$ 和 $w_{23}$，它们在约束条件 $w_{21} + w_{23} = 1$ 下最小化目标函数\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\n我们可以将 $w_{23}$ 用 $w_{21}$ 表示为 $w_{23} = 1 - w_{21}$，并将其代入目标函数：\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - (1 - w_{21}) \\, v_{3}^{(t)} \\right)^{2}.\n$$\n整理括号内的项得到：\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( (v_{2}^{(t)} - v_{3}^{(t)}) - w_{21}(v_{1}^{(t)} - v_{3}^{(t)}) \\right)^{2}.\n$$\n现在，我们对每个测试向量 $v^{(t)}$ 计算该表达式。\n\n_对于 $t=1$_：$v^{(1)}=(1,1,1)^{\\top}$。\n分量差为 $v_2^{(1)} - v_3^{(1)} = 1 - 1 = 0$ 和 $v_1^{(1)} - v_3^{(1)} = 1 - 1 = 0$。\n和式中 $t=1$ 的项是 $(0 - w_{21} \\cdot 0)^2 = 0$。这是预料之中的，因为约束 $w_{21}+w_{23}=1$ 确保了对常数向量 $v^{(1)}$ 的精确重构。\n\n_对于 $t=2$_：$v^{(2)}=(0,1,2)^{\\top}$。\n分量差为 $v_2^{(2)} - v_3^{(2)} = 1 - 2 = -1$ 和 $v_1^{(2)} - v_3^{(2)} = 0 - 2 = -2$。\n和式中 $t=2$ 的项是 $\\left( -1 - w_{21}(-2) \\right)^{2} = (-1 + 2w_{21})^2$。\n\n目标函数简化为：\n$$\nJ(w_{21}) = 0 + (-1 + 2w_{21})^2 = (-1 + 2w_{21})^2.\n$$\n为了最小化这个关于 $w_{21}$ 的二次函数，我们找到使平方项为零的 $w_{21}$ 值。\n$$\n-1 + 2w_{21} = 0\n$$\n$$\n2w_{21} = 1\n$$\n$$\nw_{21} = \\frac{1}{2}.\n$$\n细节点 2 相对于粗节点 1 的插值权重值为 $\\frac{1}{2}$。这对应于标准的线性插值，对于这个简单的一维问题，通过此代数过程可以恢复该插值。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3449351"}]}