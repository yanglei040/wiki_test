{"hands_on_practices": [{"introduction": "本练习是理解中心差分法数值特性的基础。通过将该格式应用于一个简单的傅里叶模式（即正弦波），我们能够推导出离散对流项的精确解析表达式 [@problem_id:3369209]。这一分析清晰地揭示了数值格式如何修改波的传播，特别是其引入的色散误差，这是进行数值格式分析和理解其行为的关键一步。", "problem": "考虑一维线性平流偏微分方程 (PDE) $\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0$，其中速度 $a0$ 为常数，定义在周期性域上。在单元中心位于 $x_i$、间距为 $\\Delta x0$ 的均匀网格上，使用有限体积法 (FVM)，将面 $i+\\tfrac{1}{2}$ 处的对流面通量定义为 $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$，其中面值 $\\phi_{i+\\tfrac{1}{2}}$ 由中心插值 $\\phi_{i+\\tfrac{1}{2}} = \\tfrac{1}{2}(\\phi_i + \\phi_{i+1})$ 给出；$i-\\tfrac{1}{2}$ 处也类似。单元平衡中的半离散对流项为 $\\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$。\n\n假设网格中心解为单个傅里叶模态 $\\phi_i = \\sin(k x_i)$，其中 $k$ 是实波数。从上述定义的守恒律单元平衡和中心插值出发，推导以下各项的闭式表达式：\n- 中心面通量 $F_{i-\\tfrac{1}{2}}$ 和 $F_{i+\\tfrac{1}{2}}$，以及\n- 单元 $i$ 处得到的离散对流项 $C_i = \\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$，\n\n所有表达式仅用 $a$、$k$、$x_i$ 和 $\\Delta x$ 表示。\n\n将最终答案表示为单行矩阵，顺序为 $\\big[F_{i-\\tfrac{1}{2}},\\,F_{i+\\tfrac{1}{2}},\\,C_i\\big]$。无需单位。无需数值舍入；请提供精确的闭式表达式。", "solution": "该问题经验证具有科学依据、适定、客观且完整。提供了线性平流方程的有限体积法离散化所需的所有必要定义。该任务是数值分析中的一个标准练习，特别是关于数值格式的傅里叶分析。\n\n问题要求推导一维线性平流方程的面通量 $F_{i-\\tfrac{1}{2}}$ 和 $F_{i+\\tfrac{1}{2}}$，以及由此产生的离散对流项 $C_i$。推导过程从给定的定义出发。\n\n控制偏微分方程为：\n$$ \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0 $$\n其中 $a  0$ 是一个恒定速度。\n\n网格点 $i$ 处的网格中心解以单个傅里叶模态的形式给出：\n$$ \\phi_i = \\sin(k x_i) $$\n其中 $k$ 是波数，$x_i$ 是网格中心 $i$ 的坐标。网格是均匀的，间距为 $\\Delta x  0$，因此相邻网格中心的坐标为 $x_{i+1} = x_i + \\Delta x$ 和 $x_{i-1} = x_i - \\Delta x$。\n\n因此，相邻网格中心处的解值为：\n$$ \\phi_{i+1} = \\sin(k x_{i+1}) = \\sin(k(x_i + \\Delta x)) $$\n$$ \\phi_{i-1} = \\sin(k x_{i-1}) = \\sin(k(x_i - \\Delta x)) $$\n\n首先，我们推导面通量 $F_{i+\\tfrac{1}{2}}$ 的表达式。\n面 $i+\\tfrac{1}{2}$ 处的对流通量定义为 $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$。面值 $\\phi_{i+\\tfrac{1}{2}}$ 通过中心插值获得：\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_i + \\phi_{i+1}) $$\n代入 $\\phi_i$ 和 $\\phi_{i+1}$ 的表达式：\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) \\right] $$\n我们使用和差化积三角恒等式 $\\sin(A) + \\sin(B) = 2 \\sin\\left(\\frac{A+B}{2}\\right) \\cos\\left(\\frac{A-B}{2}\\right)$。令 $A = k(x_i + \\Delta x)$ 和 $B = k x_i$。\n$$ \\frac{A+B}{2} = \\frac{k x_i + k \\Delta x + k x_i}{2} = k x_i + \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + k \\Delta x - k x_i}{2} = \\frac{k \\Delta x}{2} $$\n应用该恒等式，我们得到：\n$$ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) = 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\n将此代回 $\\phi_{i+\\tfrac{1}{2}}$ 的表达式中：\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\n那么通量为：\n$$ F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\n\n接下来，我们推导面通量 $F_{i-\\tfrac{1}{2}}$ 的表达式。\n过程是类似的。通量为 $F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}}$，其面值由下式给出：\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_{i-1} + \\phi_i) $$\n代入 $\\phi_{i-1}$ 和 $\\phi_i$ 的表达式：\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) \\right] $$\n使用相同的和差化积恒等式，令 $A = k x_i$ 和 $B = k(x_i - \\Delta x)$：\n$$ \\frac{A+B}{2} = \\frac{k x_i + k x_i - k \\Delta x}{2} = k x_i - \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i - (k x_i - k \\Delta x)}{2} = \\frac{k \\Delta x}{2} $$\n应用该恒等式：\n$$ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) = 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\n将此代回：\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\n那么通量为：\n$$ F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\n\n最后，我们推导离散对流项 $C_i$。\n该项定义为单元体积上的通量散度：\n$$ C_i = \\frac{F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}}{\\Delta x} $$\n代入推导出的通量表达式：\n$$ C_i = \\frac{a}{\\Delta x} \\left[ \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\n提取公因式 $a \\cos\\left(\\frac{k \\Delta x}{2}\\right)$：\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\n现在我们使用差化积三角恒等式 $\\sin(A) - \\sin(B) = 2 \\cos\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$。令 $A = k x_i + \\frac{k \\Delta x}{2}$ 和 $B = k x_i - \\frac{k \\Delta x}{2}$。\n$$ \\frac{A+B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} + k x_i - \\frac{k \\Delta x}{2}}{2} = k x_i $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} - (k x_i - \\frac{k \\Delta x}{2})}{2} = \\frac{k \\Delta x}{2} $$\n应用该恒等式，括号中的项变为：\n$$ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) = 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) $$\n将此代入 $C_i$ 的表达式中：\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right] $$\n重新整理各项：\n$$ C_i = \\frac{a}{\\Delta x} \\left[ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] \\cos(k x_i) $$\n使用正弦的倍角公式 $\\sin(2\\theta) = 2 \\sin(\\theta) \\cos(\\theta)$，其中 $\\theta = \\frac{k \\Delta x}{2}$：\n$$ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) = \\sin\\left(2 \\cdot \\frac{k \\Delta x}{2}\\right) = \\sin(k \\Delta x) $$\n$C_i$ 的最终表达式为：\n$$ C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) $$\n\n所需的三个表达式为：\n1.  $F_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right)$\n2.  $F_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right)$\n3.  $C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i)$", "answer": "$$\n\\boxed{\\begin{pmatrix} a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right)  a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right)  \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) \\end{pmatrix}}\n$$", "id": "3369209"}, {"introduction": "实际的计算模拟往往采用非均匀网格，以便在关键区域使用更精细的分辨率。本练习将中心差分的概念从均匀网格推广到非均匀网格 [@problem_id:3369252]。您将需要根据单元之间的几何距离推导适用于非均匀网格的线性插值公式，并用它来计算一个具体案例中的通量和离散对流项，从而深入理解该格式在更一般情况下的应用。", "problem": "考虑一维线性平流偏微分方程 (PDE) $a\\,\\partial \\phi/\\partial x$，其中平流速度 $a$ 为常数，该方程在一个非均匀网格上使用以单元为中心的有限体积法进行离散。设三个连续的控制体宽度分别为 $\\Delta x_{i-1}$、$\\Delta x_i$ 和 $\\Delta x_{i+1}$，对应的单元中心未知量为 $\\phi_{i-1}$、$\\phi_i$ 和 $\\phi_{i+1}$。面上的对流面通量定义为 $F = a\\,\\phi_{\\text{face}}$，其中 $\\phi_{\\text{face}}$ 是通过基于相邻单元中心值之间的线性插值和面到单元中心的确切几何距离的二阶中心差分在面上重构的 $\\phi$ 值。单元 $i$ 中的离散对流项是保守通量散度 $(F_{i+1/2} - F_{i-1/2})/\\Delta x_i$。\n\n从面位置 $x_{i-1/2}$（位于相邻单元边界中点）的几何定义和非均匀网格上 $x_{i-1}$ 与 $x_i$ 之间的线性插值公式出发，推导 $\\phi_{i-1/2}$ 关于 $\\phi_{i-1}$、$\\phi_i$、$\\Delta x_{i-1}$ 和 $\\Delta x_i$ 的中心差分表达式。类似地，推导 $\\phi_{i+1/2}$ 关于 $\\phi_i$、$\\phi_{i+1}$、$\\Delta x_i$ 和 $\\Delta x_{i+1}$ 的表达式。然后使用这些重构的面值计算面通量 $F_{i-1/2}$ 和 $F_{i+1/2}$ 以及离散对流项 $(F_{i+1/2} - F_{i-1/2})/\\Delta x_i$。\n\n使用具体数据 $\\Delta x_{i-1} = 1$, $\\Delta x_i = 2$, $\\Delta x_{i+1} = 2$, $a = 1$, $\\phi_{i-1} = 1$, $\\phi_i = 2$, $\\phi_{i+1} = 4$ 计算这些量。以无舍入的精确值表示您的最终答案。按此顺序报告这三个量 $(F_{i-1/2}, F_{i+1/2}, (F_{i+1/2} - F_{i-1/2})/\\Delta x_i)$。", "solution": "该问题要求在一维非均匀、以单元为中心的有限体积网格上推导对流通量的中心差分近似，并随后对一组特定数据进行评估。\n\n首先，我们确定非均匀网格的几何结构。设 $x_k$ 是单元 $k$ 中心的坐标，设 $x_{k-1/2}$ 和 $x_{k+1/2}$ 是界定单元 $k$ 的面的坐标。单元 $k$ 的宽度定义为 $\\Delta x_k = x_{k+1/2} - x_{k-1/2}$。在以单元为中心的公式中，单元中心位于单元的几何中点。因此，对于任何单元 $k$，其中心位于 $x_k = \\frac{1}{2}(x_{k-1/2} + x_{k+1/2})$。\n\n根据这个定义，我们可以表示面相对于单元中心的位置：\n$x_{k+1/2} = x_k + \\frac{1}{2}\\Delta x_k$\n$x_{k-1/2} = x_k - \\frac{1}{2}\\Delta x_k$\n\n我们感兴趣的是相邻单元中心之间的插值，例如 $x_{i-1}$ 和 $x_i$。这两个单元中心之间的距离由下式给出：\n$d(x_{i-1}, x_i) = x_i - x_{i-1}$\n使用上述关系，我们可以写出：\n$x_i = x_{i-1/2} + \\frac{1}{2}\\Delta x_i$\n$x_{i-1} = x_{i-1/2} - \\frac{1}{2}\\Delta x_{i-1}$\n用第一个方程减去第二个方程，得到单元中心之间的距离：\n$x_i - x_{i-1} = \\left(x_{i-1/2} + \\frac{1}{2}\\Delta x_i\\right) - \\left(x_{i-1/2} - \\frac{1}{2}\\Delta x_{i-1}\\right) = \\frac{1}{2}(\\Delta x_{i-1} + \\Delta x_i)$。\n\n在面 $x_{i-1/2}$ 处输运标量 $\\phi$ 的值，记作 $\\phi_{i-1/2}$，是通过在相邻单元中心的值（$x_{i-1}$ 处的 $\\phi_{i-1}$ 和 $x_i$ 处的 $\\phi_i$）之间进行线性插值得到的。线性插值的一般公式是：\n$\\phi(x) = \\phi_{i-1} + (\\phi_i - \\phi_{i-1}) \\frac{x - x_{i-1}}{x_i - x_{i-1}}$\n\n为了求 $\\phi_{i-1/2}$，我们在 $x = x_{i-1/2}$ 处计算这个表达式。从单元中心 $x_{i-1}$ 到面 $x_{i-1/2}$ 的距离是：\n$x_{i-1/2} - x_{i-1} = x_{i-1/2} - \\left(x_{i-1/2} - \\frac{1}{2}\\Delta x_{i-1}\\right) = \\frac{1}{2}\\Delta x_{i-1}$。\n\n将距离代入插值公式：\n$\\phi_{i-1/2} = \\phi_{i-1} + (\\phi_i - \\phi_{i-1}) \\frac{\\frac{1}{2}\\Delta x_{i-1}}{\\frac{1}{2}(\\Delta x_{i-1} + \\Delta x_i)} = \\phi_{i-1} + (\\phi_i - \\phi_{i-1}) \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}$\n重新整理各项，将 $\\phi_{i-1/2}$ 表示为 $\\phi_{i-1}$ 和 $\\phi_i$ 的加权平均：\n$\\phi_{i-1/2} = \\phi_{i-1} \\left(1 - \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}\\right) + \\phi_i \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}$\n$\\phi_{i-1/2} = \\phi_{i-1} \\left(\\frac{\\Delta x_{i-1} + \\Delta x_i - \\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}\\right) + \\phi_i \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i}$\n$\\phi_{i-1/2} = \\frac{\\Delta x_i}{\\Delta x_{i-1} + \\Delta x_i} \\phi_{i-1} + \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i} \\phi_i$\n这就是在面 $i-1/2$ 处重构值的推导表达式。\n\n通过对称性，我们可以通过将所有索引加1来获得 $\\phi_{i+1/2}$ 的表达式。这对应于在 $x_i$ 处的 $\\phi_i$ 和 $x_{i+1}$ 处的 $\\phi_{i+1}$ 之间进行插值，以求得面 $x_{i+1/2}$ 处的值：\n$\\phi_{i+1/2} = \\frac{\\Delta x_{i+1}}{\\Delta x_i + \\Delta x_{i+1}} \\phi_i + \\frac{\\Delta x_i}{\\Delta x_i + \\Delta x_{i+1}} \\phi_{i+1}$\n\n对流面通量定义为 $F = a\\phi_{\\text{face}}$。因此：\n$F_{i-1/2} = a\\,\\phi_{i-1/2} = a \\left( \\frac{\\Delta x_i}{\\Delta x_{i-1} + \\Delta x_i} \\phi_{i-1} + \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1} + \\Delta x_i} \\phi_i \\right)$\n$F_{i+1/2} = a\\,\\phi_{i+1/2} = a \\left( \\frac{\\Delta x_{i+1}}{\\Delta x_i + \\Delta x_{i+1}} \\phi_i + \\frac{\\Delta x_i}{\\Delta x_i + \\Delta x_{i+1}} \\phi_{i+1} \\right)$\n\n单元 $i$ 的离散对流项，表示通量散度，由下式给出：\n$\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x_i}$\n\n现在，我们使用所提供的数据计算这些量：\n$\\Delta x_{i-1} = 1$\n$\\Delta x_i = 2$\n$\\Delta x_{i+1} = 2$\n$a = 1$\n$\\phi_{i-1} = 1$\n$\\phi_i = 2$\n$\\phi_{i+1} = 4$\n\n首先，我们计算通量 $F_{i-1/2}$：\n$F_{i-1/2} = (1) \\left( \\frac{2}{1 + 2} (1) + \\frac{1}{1 + 2} (2) \\right)$\n$F_{i-1/2} = \\frac{2}{3} (1) + \\frac{1}{3} (2) = \\frac{2}{3} + \\frac{2}{3} = \\frac{4}{3}$\n\n接下来，我们计算通量 $F_{i+1/2}$：\n$F_{i+1/2} = (1) \\left( \\frac{2}{2 + 2} (2) + \\frac{2}{2 + 2} (4) \\right)$\n$F_{i+1/2} = \\frac{2}{4} (2) + \\frac{2}{4} (4) = \\frac{1}{2} (2) + \\frac{1}{2} (4) = 1 + 2 = 3$\n\n最后，我们计算单元 $i$ 的离散对流项：\n$\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x_i} = \\frac{3 - \\frac{4}{3}}{2}$\n$\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x_i} = \\frac{\\frac{9}{3} - \\frac{4}{3}}{2} = \\frac{\\frac{5}{3}}{2} = \\frac{5}{6}$\n\n需要报告的三个量是 $(F_{i-1/2}, F_{i+1/2}, (F_{i+1/2} - F_{i-1/2})/\\Delta x_i)$。\n这些值为 $(\\frac{4}{3}, 3, \\frac{5}{6})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{3}  3  \\frac{5}{6} \\end{pmatrix}}$$", "id": "3369252"}, {"introduction": "中心差分格式虽然对于平滑解具有二阶精度，但其在处理间断或急剧梯度时会暴露出一个严重的缺陷。本练习旨在通过一个经典的数值实验来揭示这一问题 [@problem_id:3369239]。通过模拟一个初始为阶跃函数的标量场在一个时间步内的演化，您将直接观察并量化由中心差分引起的非物理振荡（即过冲），这直观地说明了为何在包含激波或接触间断的流场计算中，需要发展更高级的无振荡格式。", "problem": "考虑一个无源标量的线性平流（对流）方程，\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\n该方程具有恒定的平流速度 $a0$，定义在均匀网格上，网格单元中心为 $x_i = i\\,\\Delta x$，$i \\in \\mathbb{Z}$。采用保守有限体积离散化，交界面上的对流通量采用中心插值，时间积分采用前向欧拉法。也就是说，通过相邻单元中心值的算术平均来近似交界面值，并向前推进一个大小为 $\\Delta t$ 的显式时间步。\n\n初始条件是在单元 $i=0$ 和 $i=1$ 之间的交界面 $x_{1/2} = \\Delta x/2$ 处的一个单一间断阶跃：\n$$\n\\phi(x,0) = \\begin{cases}\n\\phi_L,  x  \\Delta x/2,\\\\\n\\phi_R,  x  \\Delta x/2,\n\\end{cases}\n$$\n其中 $\\phi_L = 1$ 且 $\\phi_R = 0$。\n\n令库朗数（也称为 Courant–Friedrichs–Lewy (CFL) 数）为\n$$\nC \\equiv \\frac{a\\,\\Delta t}{\\Delta x} = \\frac{7}{10}.\n$$\n\n仅使用控制守恒律、所述的离散化选择以及给定的初始数据，确定在中心离散化引入的、一个时间步之后出现的、高于初始最大值的第一个伪超调的 magnitude 和 location。将“magnitude”定义为更新后的值超过 $\\max(\\phi_L,\\phi_R)$ 的量，将“location”定义为该首次超调发生的单元索引 $i$。以行向量 $\\big(i,\\ \\text{magnitude}\\big)$ 的形式报告你的最终答案，使用精确值且不进行四舍五入。不需要物理单位。", "solution": "该问题是有效的，因为它在偏微分方程的数值分析中有科学依据，对于单个时间步是适定的，并且所有术语和条件都已明确无误地指定，没有歧义或矛盾。\n\n控制方程是一维线性平流方程，\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\n其中 $\\phi = \\phi(x,t)$ 是一个标量，而 $a  0$ 是一个恒定的平流速度。\n\n我们在宽度为 $\\Delta x$ 的均匀网格上使用保守有限体积法。网格单元中心位于 $x_i = i\\,\\Delta x$。单元 $i$ 覆盖区间 $[x_{i-1/2}, x_{i+1/2}]$，其中 $x_{i+1/2} = (i+1/2)\\,\\Delta x$。在时刻 $t$，单元 $i$ 中 $\\phi$ 的单元平均值记为 $\\phi_i(t)$。将控制方程在单元 $i$ 上积分，得到单元平均值的精确守恒律：\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx + [a\\phi(x,t)]_{x_{i-1/2}}^{x_{i+1/2}} = 0.\n$$\n用单元平均值 $\\phi_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx$ 表示，这变为：\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0,\n$$\n其中 $\\phi_{i \\pm 1/2}$ 表示在单元交界面处 $\\phi$ 的值。\n\n问题指定了对流项通量使用中心插值。这意味着交界面上的值由相邻两个单元中值的算术平均值来近似：\n$$\n\\phi_{i+1/2} \\approx \\frac{\\phi_i + \\phi_{i+1}}{2}.\n$$\n将此近似代入半离散方程，得到：\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} \\left( \\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2} \\right) = 0,\n$$\n这可以简化为空间导数的标准中心差分近似：\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1}) = 0.\n$$\n接下来，我们应用前向欧拉法进行时间积分。令 $\\phi_i^n$ 为时刻 $t_n = n\\,\\Delta t$ 时 $\\phi_i$ 的近似值。时间导数近似为：\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\n对 $\\phi_i^{n+1}$ 进行整理，我们得到全离散的更新格式：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\n使用库朗数的定义 $C \\equiv \\frac{a\\Delta t}{\\Delta x}$，更新格式为：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{C}{2} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\n问题给出的初始条件是一个阶跃函数：\n$$\n\\phi(x,0) = \\begin{cases}\n1,  x  \\frac{\\Delta x}{2},\\\\\n0,  x  \\frac{\\Delta x}{2}.\n\\end{cases}\n$$\n间断点位于单元 $i=0$ 和单元 $i=1$ 之间的交界面 $x_{1/2} = \\frac{\\Delta x}{2}$ 处。我们通过在每个单元上积分 $\\phi(x,0)$ 来确定初始的单元平均值 $\\phi_i^0$：\n对于任何索引 $i \\le 0$ 的单元，其区域 $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ 完全位于 $x  \\frac{\\Delta x}{2}$ 的区域内。因此，对于 $i \\le 0$：\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 1 \\, dx = 1.\n$$\n对于任何索引 $i \\ge 1$ 的单元，其区域 $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ 完全位于 $x  \\frac{\\Delta x}{2}$ 的区域内。因此，对于 $i \\ge 1$：\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 0 \\, dx = 0.\n$$\n因此，在 $n=0$ 时的离散初始状态为：\n$$\n\\phi_i^0 = \\begin{cases}\n1,  i \\le 0, \\\\\n0,  i \\ge 1.\n\\end{cases}\n$$\n现在我们使用 $C=\\frac{7}{10}$ 计算下一个时间步 $n=1$ 的解。\n$$\n\\phi_i^1 = \\phi_i^0 - \\frac{1}{2} \\left(\\frac{7}{10}\\right) (\\phi_{i+1}^0 - \\phi_{i-1}^0) = \\phi_i^0 - \\frac{7}{20} (\\phi_{i+1}^0 - \\phi_{i-1}^0).\n$$\n我们对每个单元索引 $i$ 计算 $\\phi_i^1$：\n- 对于 $i \\le -1$：$\\phi_{i-1}^0 = 1$，$\\phi_i^0 = 1$，$\\phi_{i+1}^0 = 1$。\n  $$\n  \\phi_i^1 = 1 - \\frac{7}{20}(1 - 1) = 1.\n  $$\n- 对于 $i=0$：$\\phi_{-1}^0=1$，$\\phi_0^0=1$，$\\phi_1^0=0$。\n  $$\n  \\phi_0^1 = 1 - \\frac{7}{20}(0 - 1) = 1 + \\frac{7}{20} = \\frac{27}{20}.\n  $$\n- 对于 $i=1$：$\\phi_0^0=1$，$\\phi_1^0=0$, $\\phi_2^0=0$。\n  $$\n  \\phi_1^1 = 0 - \\frac{7}{20}(0 - 1) = \\frac{7}{20}.\n  $$\n- 对于 $i \\ge 2$：$\\phi_{i-1}^0 = 0$，$\\phi_i^0 = 0$，$\\phi_{i+1}^0 = 0$。\n  $$\n  \\phi_i^1 = 0 - \\frac{7}{20}(0 - 0) = 0.\n  $$\n初始最大值为 $\\max(\\phi_L, \\phi_R) = \\max(1, 0) = 1$。问题将超调定义为超过此最大值的值。\n更新后的值为：\n$$\n\\phi_i^1 = \\begin{cases}\n1,  i \\le -1, \\\\\n\\frac{27}{20},  i = 0, \\\\\n\\frac{7}{20},  i = 1, \\\\\n0,  i \\ge 2.\n\\end{cases}\n$$\n值 $\\phi_0^1 = \\frac{27}{20} = 1.35$，大于 1。这是一个超调。\n值 $\\phi_1^1 = \\frac{7}{20} = 0.35$，在初始范围 $[0, 1]$ 内。所有其他值均为 0 或 1。\n因此，唯一的超调发生在单元 $i=0$ 中。根据定义，这是第一个伪超调。\n\n该超调的 location 是单元索引 $i=0$。\n该超调的 magnitude 定义为更新后的值超过初始最大值的量：\n$$\n\\text{Magnitude} = \\phi_0^1 - \\max(\\phi_L, \\phi_R) = \\frac{27}{20} - 1 = \\frac{7}{20}.\n$$\n要求的答案是行向量 $(i, \\text{magnitude})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{7}{20}\n\\end{pmatrix}\n}\n$$", "id": "3369239"}]}