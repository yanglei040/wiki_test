{"hands_on_practices": [{"introduction": "许多物理过程，如化学反应或热辐射，都由非线性源项描述。在使用隐式时间格式求解这些问题时，我们必须将这些非线性项线性化，以便构建和求解一个代数方程组。本练习将指导您完成一个核心操作：对一个指数形式的非线性源项进行牛顿线性化，并推导其对有限体积法离散后形成的系统矩阵的贡献。[@problem_id:3444840]", "problem": "考虑标量抛物型偏微分方程 $ \\frac{\\partial u}{\\partial t} = \\mathcal{L}(u) + S(u) $，其中 $ \\mathcal{L}(u) $ 表示产生穿过控制体面的通量的空间算子，$ S(u) = \\exp(u) $ 是一个非线性体积源项。使用有限体积法 (FVM)，假设一个测度（三维中的体积，二维中的面积，或一维中的长度）为 $ V_{P} $ 的单一控制体（单元）$ P $，其单元平均未知量 $ u_{P}(t) $ 在 $ P $ 上被视为常数。使用后向欧拉法，在从 $ t^{n} $ 到 $ t^{n+1} $、大小为 $ \\Delta t $ 的时间步长上进行时间离散化，并通过将源项隐式近似为 $ V_{P} S(u_{P}^{n+1}) $ 来为 $ u_{P}^{n+1} $ 组装一个非线性代数方程。\n\n为求解该非线性系统，在迭代次数 $ k $ 时，对源项围绕当前迭代值 $ u_{P}^{(k)} $ 执行牛顿线性化。通过将 $ P $ 中的后向欧拉残差在线性化后写为线性系统 $ a_{PP} u_{P}^{n+1} + \\sum_{N} a_{PN} u_{N}^{n+1} = b_{P} $ 的形式，提取仅由源项贡献的局部对角矩阵项和右端项，分别表示为 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $。您必须用 $ V_{P} $ 和 $ u_{P}^{(k)} $ 显式地表示 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $。\n\n请以单行矩阵的形式提供您的最终答案，该矩阵按顺序包含 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $ 这两个表达式。不需要进行数值计算，也不需要四舍五入。除了保持组装 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $ 的正确符号约定外，忽略 $ \\mathcal{L}(u) $ 和时间导数项的贡献。", "solution": "当前问题是有效的，因为它在科学上基于偏微分方程数值分析的原理，是适定的、客观的且内部一致的。因此，我们可以进行形式推导。\n\n控制标量抛物型偏微分方程由下式给出：\n$$ \\frac{\\partial u}{\\partial t} = \\mathcal{L}(u) + S(u) $$\n其中 $S(u) = \\exp(u)$ 是非线性体积源项。\n\n应用有限体积法 (FVM)，我们将此方程在一个测度为 $V_P$ 的控制体（单元）$P$ 上积分：\n$$ \\int_{V_P} \\frac{\\partial u}{\\partial t} \\, dV = \\int_{V_P} \\mathcal{L}(u) \\, dV + \\int_{V_P} S(u) \\, dV $$\n假设单元平均值 $u_P$ 是整个单元 $P$ 上 $u$ 的良好表示，则积分后的方程变为关于 $u_P(t)$ 的半离散常微分方程：\n$$ V_P \\frac{d u_P}{d t} = F_P(u) + V_P S(u_P) $$\n其中 $F_P(u)$ 表示在体积上积分的离散化空间算子 $\\mathcal{L}(u)$，它产生穿过单元面的净通量。\n\n接下来，我们使用全隐式后向欧拉法，在时间步长 $\\Delta t = t^{n+1} - t^n$ 上进行时间离散化。这涉及到在时间 $t^{n+1}$ 处近似时间导数，并在时间 $t^{n+1}$ 处计算右端的所有项：\n$$ V_P \\frac{u_P^{n+1} - u_P^n}{\\Delta t} = F_P(u^{n+1}) + V_P S(u_P^{n+1}) $$\n为了求解 $u_P^{n+1}$，通常将所有项移到一边，将此方程重排为残差形式 $R_P(u^{n+1}) = 0$。问题指定了最终的线性系统形式为 $a_{PP} u_{P}^{n+1} + \\sum_{N} a_{PN} u_{N}^{n+1} = b_{P}$，这意味着涉及未知数 $u^{n+1}$ 的项被组装在左侧 (LHS)，而已知量则在右侧 (RHS)。\n遵循此约定，方程被排列为：\n$$ \\left( V_P \\frac{u_P^{n+1}}{\\Delta t} - F_P(u^{n+1}) - V_P S(u_P^{n+1}) \\right) - V_P \\frac{u_P^n}{\\Delta t} = 0 $$\n问题要求我们仅分离源项的贡献。在全离散方程中，源项在左侧 (LHS) 表现为 $-V_P S(u_P^{n+1})$。由于 $S(u) = \\exp(u)$，该项是非线性的。\n\n为了求解非线性系统，我们采用牛顿线性化。在非线性求解器的每次迭代 $k$ 中，我们围绕当前已知的迭代值（表示为 $u_P^{(k)}$）对非线性项进行线性化。我们要求解的未知数是 $u_P^{n+1}$。一个通用函数 $f(x)$ 围绕 $x_k$ 的线性化为 $f(x) \\approx f(x_k) + f'(x_k)(x - x_k)$。\n将此方法应用于源函数 $S(u_P^{n+1})$，其中 $x = u_P^{n+1}$ 且 $x_k = u_P^{(k)}$：\n$$ S(u_P^{n+1}) \\approx S(u_P^{(k)}) + S'(u_P^{(k)}) (u_P^{n+1} - u_P^{(k)}) $$\n其中 $S'(u_P^{(k)})$ 是 $S(u)$ 关于 $u$ 的导数，在 $u_P^{(k)}$ 处求值。\n\n将这个线性化表达式代入我们重排后方程的源项部分 $-V_P S(u_P^{n+1})$，我们得到：\n$$ -V_P S(u_P^{n+1}) \\approx -V_P \\left[ S(u_P^{(k)}) + S'(u_P^{(k)}) (u_P^{n+1} - u_P^{(k)}) \\right] $$\n展开此表达式可得：\n$$ -V_P S'(u_P^{(k)}) u_P^{n+1} - V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)} $$\n这表示在迭代 $k$ 时，线性化源项对代数方程左侧 (LHS) 的总贡献。\n\n现在我们必须按照指示，将这些贡献分离到目标形式 $a_{PP} u_{P}^{n+1} = b_{P}$ 中，忽略所有其他项。\n包含未知数 $u_P^{n+1}$ 的项贡献给矩阵系数 $a_{PP}$。其余项相对于 $u_P^{n+1}$ 是常数，并被移至右侧 (RHS) 以构成 $b_P$。\n\n对左侧项 $a_{PP} u_{P}^{n+1}$ 的贡献是：\n$$ \\underbrace{\\left( -V_P S'(u_P^{(k)}) \\right)}_{a_{PP}^{(S)}} u_P^{n+1} $$\n因此，仅源项对对角矩阵项的贡献是：\n$$ a_{PP}^{(S)} = -V_P S'(u_P^{(k)}) $$\n\n来自线性化源项的剩余项 $- V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)}$ 在左侧 (LHS)。要将它们移至右侧 (RHS) 成为 $b_P$ 的一部分，我们必须改变它们的符号：\n$$ b_P^{(S)} = - \\left( - V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)} \\right) $$\n$$ b_P^{(S)} = V_P S(u_P^{(k)}) - V_P S'(u_P^{(k)}) u_P^{(k)} $$\n这就是仅源项对右侧向量的贡献。\n\n最后，我们代入 $S(u)$ 及其导数 $S'(u)$ 的具体形式：\n给定 $S(u) = \\exp(u)$，其导数为 $S'(u) = \\frac{d}{du}(\\exp(u)) = \\exp(u)$。\n在 $u_P^{(k)}$ 处求值：\n$S(u_P^{(k)}) = \\exp(u_P^{(k)})$\n$S'(u_P^{(k)}) = \\exp(u_P^{(k)})$\n\n将这些代入 $a_{PP}^{(S)}$ 和 $b_P^{(S)}$ 的表达式中：\n$$ a_{PP}^{(S)} = -V_P \\exp(u_P^{(k)}) $$\n$$ b_P^{(S)} = V_P \\exp(u_P^{(k)}) - V_P \\exp(u_P^{(k)}) u_P^{(k)} $$\n$b_P^{(S)}$ 的表达式可以进行因式分解：\n$$ b_P^{(S)} = V_P \\exp(u_P^{(k)}) (1 - u_P^{(k)}) $$\n这些就是源项贡献所需的显式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-V_{P} \\exp(u_{P}^{(k)}) & V_{P} \\exp(u_{P}^{(k)}) (1 - u_{P}^{(k)})\n\\end{pmatrix}\n}\n$$", "id": "3444840"}, {"introduction": "在更复杂的模型中，源项不仅可能依赖于局部单元的解，还可能依赖于解的空间梯度。本练习在前一个练习的基础上，探讨了这种梯度依赖性如何影响系统雅可比矩阵的结构。理解如何正确计算这些贡献对于构建能够高效收敛的非线性求解器至关重要，因为它揭示了源项如何在相邻的控制体之间引入额外的耦合。[@problem_id:3444822]", "problem": "考虑一个一维稳态扩散-反应偏微分方程(PDE)，该方程定义在间距为 $\\Delta x$ 的均匀网格上，具有单位横截面积，并使用有限体积法(FVM)进行离散。设 $P$ 表示一个通用的内部控制体，其相邻控制体为 $W$ (西) 和 $E$ (东)，并设 $u_W$、$u_P$ 和 $u_E$ 为相应单元中心的离散未知数。在控制体 $P$ 上的守恒积分平衡导出一个形式如下的离散残差\n$$\nR_P(u) \\;=\\; \\text{(进入$P$的扩散面通量之和)} \\;-\\; S_P\\,|V_P| \\, ,\n$$\n其中 $|V_P|=\\Delta x$ 是控制体的体积，而 $S_P$ 是为控制体 $P$ 计算的体积源项的逐点表示。假设源密度是 $u$ 及其梯度的一个非线性泛函，其模型如下\n$$\nS_P \\;=\\; \\lambda\\,u_P^{2} \\;+\\; \\mu\\,u_P\\left(\\frac{u_E - u_W}{2\\,\\Delta x}\\right) \\;+\\; \\nu\\,\\exp(\\sigma\\,u_P) \\, ,\n$$\n其中 $\\lambda$、$\\mu$、$\\nu$ 和 $\\sigma$ 为给定的实数参数，并且在 $P$ 点的梯度由中心差分 $(u_E-u_W)/(2\\Delta x)$ 近似。\n\n使用残差的定义和一致性线性化方法，推导源项对与控制体 $P$ 相关联的雅可比矩阵行的精确贡献，即，计算仅由源项产生的偏导数 $\\partial R_P/\\partial u_W$、$\\partial R_P/\\partial u_P$ 和 $\\partial R_P/\\partial u_E$。请将您的最终结果表示为有序行向量\n$$\n\\left[\\,\\frac{\\partial R_P}{\\partial u_W}\\,,\\,\\frac{\\partial R_P}{\\partial u_P}\\,,\\,\\frac{\\partial R_P}{\\partial u_E}\\,\\right]\n$$\n其形式为用 $u_W$、$u_P$、$u_E$、$\\Delta x$、$\\lambda$、$\\mu$、$\\nu$ 和 $\\sigma$ 表示的封闭解析式。\n\n在您的推导过程中，请从守恒律的积分形式和链式法则开始。简要解释 $S_P$ 对相邻单元值的依赖性如何改变全局雅可比矩阵的稀疏模式。不需要进行数值计算，并且除了所述的用于梯度的中心差分之外，不允许进行任何其他近似。最终答案必须是指定的单一解析行向量，不带单位，也无需进行舍入。", "solution": "该问题是适定的，有科学依据，并为得到唯一解提供了所有必要信息。我们可以开始推导。\n\n目标是计算一个非线性源项对由有限体积法(FVM)产生的离散方程组的雅可比矩阵的贡献。雅可比矩阵，通常表示为 $J$，其元素为 $J_{ij} = \\frac{\\partial R_i}{\\partial u_j}$，其中 $R_i$ 是控制体 $i$ 的守恒律残差，$u_j$ 是单元 $j$ 处的离散未知数。我们需要求的是对应于控制体 $P$ 的行的特定元素，其中的导数是关于局部未知数 $u_W$、$u_P$ 和 $u_E$ 求得的。\n\n通用内部控制体 $P$ 的残差由下式给出：\n$$\nR_P(u) \\;=\\; \\text{(进入 } P \\text{ 的扩散面通量之和)} \\;-\\; S_P\\,|V_P|\n$$\n问题明确要求我们求出*仅*由源项产生的偏导数。设源项对残差的贡献表示为 $R_{P,S}$。\n$$\nR_{P,S} \\;=\\; -S_P\\,|V_P|\n$$\n我们已知控制单元的体积 $|V_P| = \\Delta x$ 以及源项 $S_P$ 的表达式：\n$$\nS_P \\;=\\; \\lambda\\,u_P^{2} \\;+\\; \\mu\\,u_P\\left(\\frac{u_E - u_W}{2\\,\\Delta x}\\right) \\;+\\; \\nu\\,\\exp(\\sigma\\,u_P)\n$$\n将这些代入 $R_{P,S}$ 的表达式中，我们得到：\n$$\nR_{P,S} \\;=\\; -\\left[ \\lambda\\,u_P^{2} \\;+\\; \\mu\\,u_P\\left(\\frac{u_E - u_W}{2\\,\\Delta x}\\right) \\;+\\; \\nu\\,\\exp(\\sigma\\,u_P) \\right] \\Delta x\n$$\n为了简化求导过程，我们可以展开该表达式：\n$$\nR_{P,S} \\;=\\; -\\lambda\\,u_P^2\\,\\Delta x \\; - \\frac{\\mu\\,u_P(u_E - u_W)}{2} \\; - \\nu\\,\\Delta x\\,\\exp(\\sigma\\,u_P)\n$$\n现在我们使用链式法则计算 $R_{P,S}$ 关于 $u_W$、$u_P$ 和 $u_E$ 的偏导数。这些导数分别代表了源项对雅可比矩阵元素 $\\frac{\\partial R_P}{\\partial u_W}$、$\\frac{\\partial R_P}{\\partial u_P}$ 和 $\\frac{\\partial R_P}{\\partial u_E}$ 的贡献。\n\n1.  **关于 $u_W$ 的偏导数**：\n    我们将 $R_{P,S}$ 对 $u_W$ 求导，同时将 $u_P$ 和 $u_E$ 视为独立变量。唯一依赖于 $u_W$ 的是第二项。\n    $$\n    \\frac{\\partial R_P}{\\partial u_W} \\Bigg|_{\\text{source}} = \\frac{\\partial R_{P,S}}{\\partial u_W} = \\frac{\\partial}{\\partial u_W} \\left( - \\frac{\\mu\\,u_P(u_E - u_W)}{2} \\right) = \\frac{\\partial}{\\partial u_W} \\left( - \\frac{\\mu\\,u_P u_E}{2} + \\frac{\\mu\\,u_P u_W}{2} \\right)\n    $$\n    $$\n    \\frac{\\partial R_{P,S}}{\\partial u_W} = \\frac{\\mu\\,u_P}{2}\n    $$\n\n2.  **关于 $u_E$ 的偏导数**：\n    类似地，我们将 $R_{P,S}$ 对 $u_E$ 求导，同时将 $u_P$ 和 $u_W$ 视为独立变量。\n    $$\n    \\frac{\\partial R_P}{\\partial u_E} \\Bigg|_{\\text{source}} = \\frac{\\partial R_{P,S}}{\\partial u_E} = \\frac{\\partial}{\\partial u_E} \\left( - \\frac{\\mu\\,u_P(u_E - u_W)}{2} \\right) = \\frac{\\partial}{\\partial u_E} \\left( - \\frac{\\mu\\,u_P u_E}{2} + \\frac{\\mu\\,u_P u_W}{2} \\right)\n    $$\n    $$\n    \\frac{\\partial R_{P,S}}{\\partial u_E} = -\\frac{\\mu\\,u_P}{2}\n    $$\n\n3.  **关于 $u_P$ 的偏导数**：\n    我们将 $R_{P,S}$ 对 $u_P$ 求导，同时将 $u_W$ 和 $u_E$ 视为独立变量。$R_{P,S}$ 表达式中的所有三项都依赖于 $u_P$。\n    $$\n    \\frac{\\partial R_P}{\\partial u_P} \\Bigg|_{\\text{source}} = \\frac{\\partial R_{P,S}}{\\partial u_P} = \\frac{\\partial}{\\partial u_P} \\left( -\\lambda\\,u_P^2\\,\\Delta x \\; - \\frac{\\mu\\,u_P(u_E - u_W)}{2} \\; - \\nu\\,\\Delta x\\,\\exp(\\sigma\\,u_P) \\right)\n    $$\n    应用求导的加法法则和幂法则：\n    $$\n    \\frac{\\partial}{\\partial u_P} (-\\lambda\\,u_P^2\\,\\Delta x) = -2\\,\\lambda\\,u_P\\,\\Delta x\n    $$\n    $$\n    \\frac{\\partial}{\\partial u_P} \\left( - \\frac{\\mu\\,u_P(u_E - u_W)}{2} \\right) = - \\frac{\\mu(u_E - u_W)}{2}\n    $$\n    $$\n    \\frac{\\partial}{\\partial u_P} (- \\nu\\,\\Delta x\\,\\exp(\\sigma\\,u_P)) = - \\nu\\,\\Delta x \\cdot (\\sigma\\,\\exp(\\sigma\\,u_P)) = -\\nu\\,\\sigma\\,\\Delta x\\,\\exp(\\sigma\\,u_P)\n    $$\n    将这些结果相加，得到关于 $u_P$ 的偏导数：\n    $$\n    \\frac{\\partial R_{P,S}}{\\partial u_P} = -2\\,\\lambda\\,u_P\\,\\Delta x - \\frac{\\mu(u_E - u_W)}{2} - \\nu\\,\\sigma\\,\\Delta x\\,\\exp(\\sigma\\,u_P)\n    $$\n\n源项 $S_P$ 对离散梯度（其涉及相邻值 $u_W$ 和 $u_E$）的依赖性是一个关键特征。在一个标准的FVM格式中，如果源项是纯粹局部的，即 $S_P = f(u_P)$，那么其线性化将只对雅可比矩阵的对角元素 $\\frac{\\partial R_P}{\\partial u_P}$ 有贡献。非对角元素 $\\frac{\\partial R_P}{\\partial u_W}$ 和 $\\frac{\\partial R_P}{\\partial u_E}$ 将完全由扩散（或对流）通量的离散化产生。然而，由于这里的 $S_P$ 依赖于 $u_W$ 和 $u_E$，它对雅可比矩阵贡献了非零的非对角项。这不会改变一维最近邻通量模板的基本三对角稀疏模式，但它会修改非对角元素的值，从而以更复杂的方式耦合方程组。\n\n最后，我们将推导出的偏导数组合成指定的有序行向量：\n$$\n\\left[\\,\\frac{\\partial R_P}{\\partial u_W}\\,,\\,\\frac{\\partial R_P}{\\partial u_P}\\,,\\,\\frac{\\partial R_P}{\\partial u_E}\\,\\right]_{\\text{source}} = \\left[\\, \\frac{\\mu\\,u_P}{2} \\,,\\, -2\\,\\lambda\\,u_P\\,\\Delta x - \\frac{\\mu(u_E - u_W)}{2} - \\nu\\,\\sigma\\,\\Delta x\\,\\exp(\\sigma\\,u_P) \\,,\\, -\\frac{\\mu\\,u_P}{2} \\,\\right]\n$$\n该向量表示给定非线性源项对系统雅可比矩阵第 $P$ 行的精确贡献。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\mu u_P}{2} & -2 \\lambda u_P \\Delta x - \\frac{\\mu (u_E - u_W)}{2} - \\nu \\sigma \\Delta x \\exp(\\sigma u_P) & -\\frac{\\mu u_P}{2} \\end{pmatrix} } $$", "id": "3444822"}, {"introduction": "数值解的物理真实性与算法的正确性同样重要。例如，在模拟物质浓度时，解必须始终保持非负。本练习将探讨如何通过分析离散格式来确保解的正定性，推导线性化源项系数必须满足的条件，从而将离散化选择与保证物理现实性的矩阵理论（M-矩阵）联系起来。[@problem_id:3444890]", "problem": "考虑一个由线性产生-湮灭源控制的标量输运问题，其偏微分方程(PDE)通过有限体积法(FVM)进行离散。设控制体积 $P$ 处的线性化源项写作 $S(u_{P}) = a_{P}\\,u_{P} + b_{P}$，其中 $a_{P}$ 代表湮滅系数，$b_{P}$ 代表产生系数。假设在时间步长 $\\Delta t$ 上采用全隐式时间离散，并且空间离散（扩散项采用中心差分，对流项采用满足总变差减小单调性的迎风差分）所得到的、写在右侧的基于面的相邻耦合系数是非负的。设瞬态质量系数为 $m_{P} = \\rho c V_{P} / \\Delta t$，其中 $\\rho$ 是密度，$c$ 是一个正的材料常数，$V_{P}$ 是控制体积 $P$ 的体积。假设边界条件和初始数据是非负的。\n\n从 $V_{P}$ 上的守恒积分形式出发，通过全隐式FVM离散，推导出新的时间层 $n+1$ 上单个控制体积方程的系数形式，并援引非奇异单调矩阵（M-矩阵）理论，建立保证当右侧非负时 $u^{n+1} \\ge 0$ 按分量成立的关于 $a_{P}$ 和 $b_{P}$ 的条件。证明湮滅系数存在一个有限上界 $a_{P}^{\\max}$，超过该值正性可能丧失，并以 $m_{P}$ 和 $V_{P}$ 的形式精确计算出该界的闭式解。你的最终答案必须是 $a_{P}^{\\max}$ 的单个解析表达式，不含不等式，不含单位。", "solution": "该问题被验证为具有科学依据、良态且客观。这是偏微分方程数值解领域的一个标准问题，特别涉及有限体积法(FVM)的稳定性和正性。\n\n求解过程首先离散化一般标量输运方程，然后应用M-矩阵理论推导保证解的非负性的源项系数条件。\n\n设 $u$ 为标量变量。输运方程在控制体积 $V_P$ 和时间区间 $[t^n, t^{n+1}]$ 上的守恒积分形式为：\n$$\n\\int_{V_P} \\rho c u^{n+1} dV - \\int_{V_P} \\rho c u^n dV + \\int_{t^n}^{t^{n+1}} \\left( \\int_{A_P} \\mathbf{J} \\cdot d\\mathbf{A} \\right) dt = \\int_{t^n}^{t^{n+1}} \\left( \\int_{V_P} S_v dV \\right) dt\n$$\n其中 $\\rho$ 和 $c$ 是材料属性，$\\mathbf{J}$ 是总通量向量，$S_v$ 是体积源项。\n\n我们采用全隐式FVM离散。控制体积内的 $u$ 值由其单元平均值 $u_P$ 表示。所有项，包括通量和源项，都在新的时间层 $t^{n+1}$ 上进行计算。为清晰起见，我们将 $t^{n+1}$ 时的值表示为不带上标（例如，$u_P$），而将 $t^n$ 时的值表示为带上标 $n$（例如，$u_P^n$）。\n\n时间导数项近似为：\n$$\n\\frac{1}{\\Delta t} \\left( \\int_{V_P} \\rho c u^{n+1} dV - \\int_{V_P} \\rho c u^n dV \\right) \\approx \\frac{\\rho c V_P}{\\Delta t} (u_P - u_P^n) = m_P(u_P - u_P^n)\n$$\n其中 $m_P = \\frac{\\rho c V_P}{\\Delta t}$ 是给定的瞬态质量系数。\n\n问题陈述线性化源项为 $S(u_P) = a_P u_P + b_P$。这里存在一个歧义，即这究竟是体积源 $S_v$ 还是在体积上积分后的总源项 $\\int_{V_P} S_v dV$。要求最终答案以 $m_P$ 和 $V_P$ 表示强烈暗示了其意图是 $S_v$，即 $S_v(u) = a_P u + b_P$。在这种情况下，积分源项为：\n$$\n\\int_{V_P} S_v dV \\approx (a_P u_P + b_P)V_P\n$$\n给定通量项 $\\sum_f \\mathbf{J} \\cdot \\mathbf{A}_f$ 的空间离散在代数方程右侧产生非负的相邻耦合系数。这导出了标准的FVM形式：\n$$\n\\sum_f (\\mathbf{J} \\cdot \\mathbf{A}_f) \\approx A_{P, \\text{flux}} u_P - \\sum_{N} A_N u_N\n$$\n其中 $N$ 表示与 $P$ 相邻的控制体积集合，且系数 $A_N \\ge 0$。对于内部控制体积上的守恒格式，系数 $A_{P, \\text{flux}}$ 等于相邻系数之和，即 $A_{P, \\text{flux}} = \\sum_N A_N$。\n\n将这些离散项代入积分平衡方程（除以 $\\Delta t$后）得到：\n$$\nm_P(u_P - u_P^n) + \\left( \\sum_N A_N \\right) u_P - \\sum_N A_N u_N = (a_P u_P + b_P)V_P\n$$\n我们现在将此方程重排为标准的线性代数形式 $A_{P,P} u_P = \\sum_N A_{P,N} u_N + B_P$：\n$$\n\\left( m_P + \\sum_N A_N - a_P V_P \\right) u_P = \\sum_N A_N u_N + m_P u_P^n + b_P V_P\n$$\n由此，我们确定代数系统的系数：\n- 左侧主对角线系数：$A_{P,P} = m_P + \\sum_N A_N - a_P V_P$\n- 右侧非对角线系数：$A_{P,N} = A_N$\n- 右侧常数源项：$B_P = m_P u_P^n + b_P V_P$\n\n为使解 $u_P$ 对于任何非负初始条件 $u_P^n \\ge 0$ 和边界条件都保持非负，必须满足两个条件。系统矩阵必须是单调矩阵（M-矩阵），并且右侧向量必须是非负的。\n\n首先，我们分析右侧项 $B_P$。鉴于 $m_P > 0$，$u_P^n \\ge 0$ 和 $V_P > 0$，条件 $B_P \\ge 0$ 要求产生系数满足 $b_P \\ge 0$。\n\n其次，我们分析系统矩阵，称其为 $\\mathbf{M}$。第 $P$ 行的方程为 $\\mathbf{M}_{PP} u_P + \\sum_{N} \\mathbf{M}_{PN} u_N = B_P$。\n与我们推导的形式比较，我们有：\n- 对角线矩阵元素：$\\mathbf{M}_{PP} = A_{P,P} = m_P + \\sum_N A_N - a_P V_P$\n- 非对角线矩阵元素：$\\mathbf{M}_{PN} = -A_N$\n\n$\\mathbf{M}$ 是一个M-矩阵的充分条件是它是一个严格或不可约对角占优的L-矩阵。L-矩阵具有正的对角线元素和非正的非对角线元素。\n1.  非正非对角线元素的条件：$\\mathbf{M}_{PN} = -A_N \\le 0$。由于给定 $A_N \\ge 0$，此条件得到满足。\n2.  正对角线元素的条件：$\\mathbf{M}_{PP} > 0 \\implies m_P + \\sum_N A_N - a_P V_P > 0$。\n3.  对角占优条件：$|\\mathbf{M}_{PP}| \\ge \\sum_{N} |\\mathbf{M}_{PN}|$。假设 $\\mathbf{M}_{PP}>0$，则有：\n    $$\n    m_P + \\sum_N A_N - a_P V_P \\ge \\sum_N |-A_N| = \\sum_N A_N\n    $$\n    该不等式简化为：\n    $$\n    m_P - a_P V_P \\ge 0 \\implies a_P V_P \\le m_P \\implies a_P \\le \\frac{m_P}{V_P}\n    $$\n这个条件代表了为保证系统得到非负解而对 $a_P$ 施加的约束。它比条件 $\\mathbf{M}_{PP} > 0$ 更严格，因为 $\\sum_N A_N \\ge 0$。如果 $a_P$ 违反此界限（$a_P > m_P/V_P$），则对角占优性会丧失，矩阵不再保证是M-矩阵，其逆矩阵可能包含负元素，从而允许 $u_P  0$。\n\n问题将 $a_P$ 称为“湮滅系数”，这令人困惑，因为与 $u_P$ 成正比的湮滅项通常具有负系数（例如，$-k u_P$，其中 $k  0$）。由于 $m_P  0$ 和 $V_P  0$，负的 $a_P$ 总是满足 $a_P \\le m_P/V_P$。然而，问题要求一个有限上界 $a_P^{\\max}$，这意味着 $a_P$可以是一个正值（即一个产生系数），其值大到足以引起不稳定性。因此，我们将“$a_P$ 代表湮滅系数”解释为一种用词不当，我们的任务是找到产生系数 $a_P$ 的上限，超过该上限则正性丧失。\n\n这个上界 $a_P^{\\max}$ 是对角占优条件达到极限时的值：\n$$\na_P^{\\max} = \\frac{m_P}{V_P}\n$$\n如果 $a_P  a_P^{\\max}$，系统将不再是对角占优的，正性可能丧失。这证明了这样一个有限上界的存在。该界以指定的变量 $m_P$ 和 $V_P$ 的闭式表达式精确给出。\n因此，保证正性的源项系数条件是 $a_P \\le m_P/V_P$ 和 $b_P \\ge 0$。所求的是 $a_P$ 的上界。", "answer": "$$\\boxed{\\frac{m_P}{V_P}}$$", "id": "3444890"}]}