{"hands_on_practices": [{"introduction": "有限体积法的一大优势在于其建立在积分形式的守恒律之上，这使其能够自然地适应复杂的几何构型。本练习要求您直接从散度定理出发，推导在极坐标系下的散度算子的离散格式，而不是简单套用现成的公式。这项实践对于理解几何度量项如何在离散化过程中自然产生至关重要，并为您在任何曲线坐标或非结构网格上开发格式奠定了基础技能。[@problem_id:3409398]", "problem": "考虑一个在用极坐标表示的欧几里得平面中，由通量场输运的标量的稳态守恒律。设 $\\mathbf{f}(r,\\theta)=f_{r}(r,\\theta)\\,\\mathbf{e}_{r}+f_{\\theta}(r,\\theta)\\,\\mathbf{e}_{\\theta}$ 是一个足够光滑的通量矢量场，其中 $\\mathbf{e}_{r}$ 和 $\\mathbf{e}_{\\theta}$ 是极坐标单位基向量。以散度定理为基本出发点，对极坐标控制体 $\\mathcal{C}_{i,j}=[r_{i-\\frac{1}{2}},r_{i+\\frac{1}{2}}]\\times[\\theta_{j-\\frac{1}{2}},\\theta_{j+\\frac{1}{2}}]$ 上的单元平均散度，推导一个度量一致的有限体积法 (Finite Volume Method, FVM) 离散格式。你的推导必须从适用于极坐标的积分守恒形式 $\\iint_{\\mathcal{C}_{i,j}} \\nabla\\cdot\\mathbf{f}\\, \\mathrm{d}A=\\oint_{\\partial\\mathcal{C}_{i,j}} \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s$ 开始，并且必须明确展示在面和面积上正确的 $r$ 加权度量。不要假设任何曲线坐标的“捷径”公式；相反，应从极坐标中控制体的几何形状进行推导。\n\n然后，对于一个具有 $r$ 边 $R_{1}=r_{i-\\frac{1}{2}}$ 和 $R_{2}=r_{i+\\frac{1}{2}}$ 以及角向边 $\\Theta_{1}=\\theta_{j-\\frac{1}{2}}$ 和 $\\Theta_{2}=\\theta_{j+\\frac{1}{2}}$ 的单个环扇形控制体，使用精确的面积分将你得到的度量一致的 FVM 公式应用于以下通量场\n$$\nf_{r}(r,\\theta)=a\\,r^{2}\\cos\\theta,\\qquad f_{\\theta}(r,\\theta)=b\\,r^{3}\\sin\\!\\bigl(2\\theta\\bigr),\n$$\n其中 $a$ 和 $b$ 是常数。请给出离散单元平均散度 $\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j}$ 关于 $a$, $b$, $R_{1}$, $R_{2}$, $\\Theta_{1}$ 和 $\\Theta_{2}$ 的最终闭式表达式。最终答案必须是单一的解析表达式。不需要数值取整。请明确写出最终表达式。缩略词在首次使用时必须定义，例如，偏微分方程 (Partial Differential Equation, PDE) 和有限体积法 (Finite Volume Method, FVM)。", "solution": "该问题具有科学依据、是适定的、客观的，并包含推导唯一解析解所需的所有信息。这是偏微分方程 (Partial Differential Equations, PDEs) 数值解的一个标准练习。因此，该问题是有效的，并将提供解答。\n\n有限体积法 (Finite Volume Method, FVM) 的核心是守恒律积分形式的离散化。我们已知在控制体 $\\mathcal{C}_{i,j}$ 上的积分形式稳态守恒律为：\n$$\n\\iint_{\\mathcal{C}_{i,j}} \\nabla\\cdot\\mathbf{f}\\, \\mathrm{d}A = \\oint_{\\partial\\mathcal{C}_{i,j}} \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s\n$$\n其中 $\\mathbf{f}$ 是通量矢量，$\\mathbf{n}$ 是边界 $\\partial\\mathcal{C}_{i,j}$ 上指向外部的单位法向量，$\\mathrm{d}A$ 是微分面积元，$\\mathrm{d}s$ 是沿边界的微分线元。\n\n单元平均散度，记作 $\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j}$，定义为单元内的总散度除以单元面积 $A_{i,j}$：\n$$\n\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j} = \\frac{1}{A_{i,j}} \\iint_{\\mathcal{C}_{i,j}} \\nabla\\cdot\\mathbf{f}\\, \\mathrm{d}A\n$$\n代入散度定理可得基本的 FVM 公式：\n$$\n\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j} = \\frac{1}{A_{i,j}} \\oint_{\\partial\\mathcal{C}_{i,j}} \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s\n$$\n\n我们的任务是计算极坐标中控制体在公式右侧的值。控制体 $\\mathcal{C}_{i,j}$ 是一个由 $r \\in [r_{i-\\frac{1}{2}}, r_{i+\\frac{1}{2}}]$ 和 $\\theta \\in [\\theta_{j-\\frac{1}{2}}, \\theta_{j+\\frac{1}{2}}]$ 定义的环扇形。边界 $\\partial\\mathcal{C}_{i,j}$ 由四个面组成：\n1. 位于 $r = r_{i+\\frac{1}{2}}$ 的外侧面，其中 $\\theta$ 从 $\\theta_{j-\\frac{1}{2}}$ 变化到 $\\theta_{j+\\frac{1}{2}}$。此处，外法线为 $\\mathbf{n} = \\mathbf{e}_r$，微分弧长为 $\\mathrm{d}s = r_{i+\\frac{1}{2}}\\mathrm{d}\\theta$。\n2. 位于 $r = r_{i-\\frac{1}{2}}$ 的内侧面，其中 $\\theta$ 变化。外法线为 $\\mathbf{n} = -\\mathbf{e}_r$，弧长为 $\\mathrm{d}s = r_{i-\\frac{1}{2}}\\mathrm{d}\\theta$。\n3. 位于 $\\theta = \\theta_{j+\\frac{1}{2}}$ 的顺时针方向的面，其中 $r$ 从 $r_{i-\\frac{1}{2}}$ 变化到 $r_{i+\\frac{1}{2}}$。外法线为 $\\mathbf{n} = \\mathbf{e}_\\theta$，线元为 $\\mathrm{d}s = \\mathrm{d}r$。\n4. 位于 $\\theta = \\theta_{j-\\frac{1}{2}}$ 的逆时针方向的面，其中 $r$ 变化。外法线为 $\\mathbf{n} = -\\mathbf{e}_\\theta$，线元为 $\\mathrm{d}s = \\mathrm{d}r$。\n\n通量矢量以极坐标分量形式给出，为 $\\mathbf{f} = f_r \\mathbf{e}_r + f_\\theta \\mathbf{e}_\\theta$。通过边界的总通量 $\\oint \\mathbf{f}\\cdot\\mathbf{n}\\,\\mathrm{d}s$ 是通过这四个面的通量之和：\n\\begin{align*}\n\\oint_{\\partial\\mathcal{C}_{i,j}} \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s = \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\mathbf{f}(r_{i+\\frac{1}{2}}, \\theta) \\cdot \\mathbf{e}_r \\, (r_{i+\\frac{1}{2}} \\mathrm{d}\\theta) \\\\\n+ \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\mathbf{f}(r_{i-\\frac{1}{2}}, \\theta) \\cdot (-\\mathbf{e}_r) \\, (r_{i-\\frac{1}{2}} \\mathrm{d}\\theta) \\\\\n+ \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} \\mathbf{f}(r, \\theta_{j+\\frac{1}{2}}) \\cdot \\mathbf{e}_\\theta \\, \\mathrm{d}r \\\\\n+ \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} \\mathbf{f}(r, \\theta_{j-\\frac{1}{2}}) \\cdot (-\\mathbf{e}_\\theta) \\, \\mathrm{d}r\n\\end{align*}\n计算点积可得：\n\\begin{align*}\n\\oint_{\\partial\\mathcal{C}_{i,j}} \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s = \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} f_r(r_{i+\\frac{1}{2}}, \\theta) r_{i+\\frac{1}{2}} \\mathrm{d}\\theta - \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} f_r(r_{i-\\frac{1}{2}}, \\theta) r_{i-\\frac{1}{2}} \\mathrm{d}\\theta \\\\\n+ \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} f_\\theta(r, \\theta_{j+\\frac{1}{2}}) \\mathrm{d}r - \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} f_\\theta(r, \\theta_{j-\\frac{1}{2}}) \\mathrm{d}r\n\\end{align*}\n该表达式正确地展示了径向通量分量的 $r$ 加权度量，因为弧长元是 $\\mathrm{d}s = r \\mathrm{d}\\theta$。通量分量 $f_r$ 乘以面长 $r \\mathrm{d}\\theta$，从而得到项 $r f_r$。\n\n控制体面积 $A_{i,j}$ 通过对极坐标面积元 $\\mathrm{d}A = r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta$ 积分得到：\n$$\nA_{i,j} = \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta = \\left(\\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\mathrm{d}\\theta\\right) \\left(\\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} r\\,\\mathrm{d}r\\right) = (\\theta_{j+\\frac{1}{2}} - \\theta_{j-\\frac{1}{2}}) \\left[\\frac{1}{2}r^2\\right]_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} = \\frac{1}{2}(\\theta_{j+\\frac{1}{2}} - \\theta_{j-\\frac{1}{2}})(r_{i+\\frac{1}{2}}^2 - r_{i-\\frac{1}{2}}^2)\n$$\n结合这些结果，可以得到基于精确面积分的单元平均散度的通用度量一致 FVM 离散格式：\n$$\n\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j} = \\frac{1}{A_{i,j}} \\left[ \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\left(r f_r\\right)|_{r=r_{i+\\frac{1}{2}}} \\mathrm{d}\\theta - \\int_{\\theta_{j-\\frac{1}{2}}}^{\\theta_{j+\\frac{1}{2}}} \\left(r f_r\\right)|_{r=r_{i-\\frac{1}{2}}} \\mathrm{d}\\theta + \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} f_\\theta|_{\\theta=\\theta_{j+\\frac{1}{2}}} \\mathrm{d}r - \\int_{r_{i-\\frac{1}{2}}}^{r_{i+\\frac{1}{2}}} f_\\theta|_{\\theta=\\theta_{j-\\frac{1}{2}}} \\mathrm{d}r \\right]\n$$\n\n现在，我们将此公式应用于特定的通量场和控制体。边界为 $r_{i-\\frac{1}{2}} = R_1$, $r_{i+\\frac{1}{2}} = R_2$, $\\theta_{j-\\frac{1}{2}} = \\Theta_1$, 和 $\\theta_{j+\\frac{1}{2}} = \\Theta_2$。通量分量为 $f_r(r,\\theta) = a r^2 \\cos\\theta$ 和 $f_\\theta(r,\\theta) = b r^3 \\sin(2\\theta)$。\n\n控制体的面积为：\n$$\nA = \\frac{1}{2}(\\Theta_2 - \\Theta_1)(R_2^2 - R_1^2)\n$$\n\n接下来，我们精确计算四个边界积分：\n1. 在外侧面 $r=R_2$ 上的积分：\n$$\n\\int_{\\Theta_1}^{\\Theta_2} (r f_r)|_{r=R_2} \\mathrm{d}\\theta = \\int_{\\Theta_1}^{\\Theta_2} R_2 (a R_2^2 \\cos\\theta) \\mathrm{d}\\theta = a R_2^3 \\int_{\\Theta_1}^{\\Theta_2} \\cos\\theta \\mathrm{d}\\theta = a R_2^3 [\\sin\\theta]_{\\Theta_1}^{\\Theta_2} = a R_2^3 (\\sin\\Theta_2 - \\sin\\Theta_1)\n$$\n2. 在内侧面 $r=R_1$ 上的积分：\n$$\n\\int_{\\Theta_1}^{\\Theta_2} (r f_r)|_{r=R_1} \\mathrm{d}\\theta = \\int_{\\Theta_1}^{\\Theta_2} R_1 (a R_1^2 \\cos\\theta) \\mathrm{d}\\theta = a R_1^3 \\int_{\\Theta_1}^{\\Theta_2} \\cos\\theta \\mathrm{d}\\theta = a R_1^3 (\\sin\\Theta_2 - \\sin\\Theta_1)\n$$\n来自径向面的净通量是这两者之差：$a (R_2^3 - R_1^3)(\\sin\\Theta_2 - \\sin\\Theta_1)$。\n\n3. 在顺时针面 $\\theta=\\Theta_2$ 上的积分：\n$$\n\\int_{R_1}^{R_2} f_\\theta|_{\\theta=\\Theta_2} \\mathrm{d}r = \\int_{R_1}^{R_2} b r^3 \\sin(2\\Theta_2) \\mathrm{d}r = b \\sin(2\\Theta_2) \\left[\\frac{1}{4}r^4\\right]_{R_1}^{R_2} = \\frac{b}{4} \\sin(2\\Theta_2) (R_2^4 - R_1^4)\n$$\n4. 在逆时针面 $\\theta=\\Theta_1$ 上的积分：\n$$\n\\int_{R_1}^{R_2} f_\\theta|_{\\theta=\\Theta_1} \\mathrm{d}r = \\int_{R_1}^{R_2} b r^3 \\sin(2\\Theta_1) \\mathrm{d}r = b \\sin(2\\Theta_1) \\left[\\frac{1}{4}r^4\\right]_{R_1}^{R_2} = \\frac{b}{4} \\sin(2\\Theta_1) (R_2^4 - R_1^4)\n$$\n来自角向面的净通量是其差值：$\\frac{b}{4} (R_2^4 - R_1^4)(\\sin(2\\Theta_2) - \\sin(2\\Theta_1))$。\n\n总出射通量是来自径向面和角向面的净通量之和：\n$$\n\\oint \\mathbf{f}\\cdot \\mathbf{n}\\,\\mathrm{d}s = a(R_2^3 - R_1^3)(\\sin\\Theta_2 - \\sin\\Theta_1) + \\frac{b}{4}(R_2^4 - R_1^4)(\\sin(2\\Theta_2) - \\sin(2\\Theta_1))\n$$\n最后，离散单元平均散度是这个总通量除以单元面积：\n$$\n\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j} = \\frac{a(R_2^3 - R_1^3)(\\sin\\Theta_2 - \\sin\\Theta_1) + \\frac{b}{4}(R_2^4 - R_1^4)(\\sin(2\\Theta_2) - \\sin(2\\Theta_1))}{\\frac{1}{2}(\\Theta_2 - \\Theta_1)(R_2^2 - R_1^2)}\n$$\n这个表达式可以重写，将分母中的因子 $\\frac{1}{2}$ 移到分子上，变为因子 $2$：\n$$\n\\langle \\nabla\\cdot\\mathbf{f}\\rangle_{i,j} = \\frac{2}{(\\Theta_2 - \\Theta_1)(R_2^2 - R_1^2)} \\left[ a(R_2^3 - R_1^3)(\\sin\\Theta_2 - \\sin\\Theta_1) + \\frac{b}{4}(R_2^4 - R_1^4)(\\sin(2\\Theta_2) - \\sin(2\\Theta_1)) \\right]\n$$\n这就是最终的闭式表达式。", "answer": "$$\n\\boxed{\\frac{2}{(\\Theta_2 - \\Theta_1)(R_2^2 - R_1^2)} \\left[ a(R_2^3 - R_1^3)(\\sin\\Theta_2 - \\sin\\Theta_1) + \\frac{b}{4}(R_2^4 - R_1^4)(\\sin(2\\Theta_2) - \\sin(2\\Theta_1)) \\right]}\n$$", "id": "3409398"}, {"introduction": "在完成一个数值格式的编程实现后，我们如何能确信代码没有错误并且达到了预期的性能？制造解方法（Method of Manufactured Solutions, MMS）为验证代码的正确性和收敛阶提供了一个严谨的框架。本练习要求您设计一个完整的验证流程，从选取一个制造解到正确地分析计算误差，这是开发可靠科学计算软件的一项必备技能。[@problem_id:3409370]", "problem": "考虑积分守恒形式的稳态对流扩散方程：对于任意 Lipschitz 控制体 $K \\subset \\Omega \\subset \\mathbb{R}^2$，其单位外法线为 $\\boldsymbol{n}$，边界为 $\\partial K$，有\n$$\n\\int_{\\partial K} \\big(-\\kappa \\nabla u + \\boldsymbol{\\beta}\\, u\\big)\\cdot \\boldsymbol{n}\\, \\mathrm{d}\\Gamma \\;=\\; \\int_{K} S\\, \\mathrm{d}\\Omega,\n$$\n其中 $\\kappa>0$ 是扩散系数，$\\boldsymbol{\\beta}$ 是对流速度，$S$ 是源项。一种在非结构网格上使用的单元中心控制体方法离散化每个面上的通量，从而使得离散平衡在每个单元上都成立。人工解法要求选择一个足够光滑的精确解 $u_{\\mathrm{ex}}$，并推导出相应的 $S$ 和边界数据，使 $u_{\\mathrm{ex}}$ 成为该偏微分方程的精确解。您的任务是确定一个设计和验证方案，该方案能够在一族形状规则的非结构网格上，通过网格加密，可信地展示一个相容的二阶有限体积方法的二阶收敛性。\n\n选择一个正确指定以下所有内容的选项：在 $\\Omega=(0,1)^2$ 上的一个人造解 $u(x,y)$，常系数 $\\kappa$ 和 $\\boldsymbol{\\beta}$，与积分守恒定律一致的相应源项 $S(x,y)$，合适的边界数据，以及一个观察二阶收敛的合理程序，包括网格尺寸 $h$、误差范数和观测到的收敛阶的定义。只有一个选项是完全正确的。\n\nA. 取 $\\kappa=\\tfrac{1}{5}$，$\\boldsymbol{\\beta}=(1,\\tfrac{1}{2})$，以及\n$$\nu(x,y)=\\sin(\\pi x)\\sin(\\pi y)+x\\,y \\quad \\text{在 } \\Omega=(0,1)^2 \\text{ 上}.\n$$\n因为 $\\kappa$ 和 $\\boldsymbol{\\beta}$ 是常数且 $\\nabla\\cdot\\boldsymbol{\\beta}=0$，源项为\n$$\nS(x,y) \\;=\\; -\\kappa\\,\\Delta u(x,y)\\;+\\;\\boldsymbol{\\beta}\\cdot\\nabla u(x,y).\n$$\n由 $\\Delta u(x,y)=-2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$ 和 $\\nabla u(x,y)=\\big(\\pi\\cos(\\pi x)\\sin(\\pi y)+y,\\;\\pi\\sin(\\pi x)\\cos(\\pi y)+x\\big)$，可得\n$$\nS(x,y) \\;=\\; \\tfrac{2}{5}\\,\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\;+\\;\\pi\\cos(\\pi x)\\sin(\\pi y)\\;+\\;y\\;+\\;\\tfrac{1}{2}\\,\\pi\\sin(\\pi x)\\cos(\\pi y)\\;+\\;\\tfrac{x}{2}.\n$$\n施加狄利克雷边界数据 $u|_{\\partial\\Omega}=u(x,y)$。使用一个二阶单元中心有限体积方法，该方法包含线性最小二乘梯度重构和二阶面插值，并对扩散通量和对流通量进行标准的非正交性（偏斜）修正；使用相容的二阶求积来近似面通量。选择一个形状规则的非结构网格的加密序列，其网格尺寸为 $h_\\ell=\\max_{K\\in\\mathcal{T}_\\ell}\\mathrm{diam}(K)$，并使最粗网格上的局部佩克莱数 $\\mathrm{Pe}_f=\\tfrac{|\\boldsymbol{\\beta}\\cdot \\boldsymbol{n}_f|\\,h_f}{2\\kappa}=\\mathcal{O}(1)$ 适中，以避免振荡。在每个网格 $\\mathcal{T}_\\ell$ 上，计算单元平均值的面积加权离散 $L^2$ 误差\n$$\nE_\\ell \\;=\\; \\Bigg(\\sum_{K\\in\\mathcal{T}_\\ell} |K|\\,\\big(u_{h,K}-\\bar{u}_K^{\\mathrm{ex}}\\big)^2\\Bigg)^{1/2},\n$$\n其中 $\\bar{u}_K^{\\mathrm{ex}}=\\frac{1}{|K|}\\int_K u(x,y)\\,\\mathrm{d}\\Omega$ 通过足够精确的求积来计算。观测到的阶数 $p_\\ell$ 由下式估计\n$$\np_\\ell \\;=\\; \\frac{\\log\\big(E_\\ell/E_{\\ell+1}\\big)}{\\log\\big(h_\\ell/h_{\\ell+1}\\big)}.\n$$\n预期随着 $\\ell$ 增大，$p_\\ell\\approx 2$。\n\nB. 取 $\\kappa=\\tfrac{1}{5}$，$\\boldsymbol{\\beta}(x,y)=(x,y)$，以及 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)+x\\,y$。定义 $S(x,y)=-\\kappa\\,\\Delta u(x,y)+\\boldsymbol{\\beta}\\cdot\\nabla u(x,y)$ 并施加狄利克雷数据 $u|_{\\partial\\Omega}=u(x,y)$。为保证稳定性，用一阶迎风格式离散化对流项，用面心梯度离散化扩散项。在每个具有 $N_\\ell$ 个单元的网格上，将误差 $E_\\ell$ 衡量为单元中心的未加权均方根，并按 $p_\\ell=\\frac{\\log(E_\\ell/E_{\\ell+1})}{\\log(N_\\ell/N_{\\ell+1})}$ 计算观测到的阶数。\n\nC. 在 $\\Omega=(0,1)^2$ 上取 $\\kappa=\\tfrac{1}{5}$，$\\boldsymbol{\\beta}=(1,\\tfrac{1}{2})$，以及 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)+x\\,y$。设 $S(x,y)$ 如选项 A 所述，并在 $\\partial\\Omega$ 上施加齐次诺伊曼边界条件。在偏斜的非结构网格上使用不带非正交性修正的 Green–Gauss 梯度，对流项使用中心差分，并通过 $E_\\ell=\\sum_{K\\in\\mathcal{T}_\\ell}|u_{h,K}-u(x_K,y_K)|$ 计算离散 $L^1$ 误差，网格尺寸取 $h_\\ell=\\min_{K\\in\\mathcal{T}_\\ell}\\mathrm{diam}(K)$。使用与选项 A 中相同的对数比率公式估计观测到的阶数。\n\nD. 取 $\\kappa=\\tfrac{1}{5}$，$\\boldsymbol{\\beta}=(1,\\tfrac{1}{2})$，以及 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$，并有 $S(x,y)=-\\kappa\\,\\Delta u(x,y)+\\boldsymbol{\\beta}\\cdot\\nabla u(x,y)$。施加齐次狄利克雷边界条件 $u|_{\\partial\\Omega}=0$，并使用通量限制的迎风格式，通过在最粗网格上选择 $\\kappa=\\tfrac{1}{1000}$ 来防止高佩克莱数下的振荡。通过计算单元中心的最大范数误差并使用 $h_\\ell$ 等于平均面长度来估计观测到的阶数，以验证二阶收敛性。", "solution": "用户请求验证问题陈述，然后提供完整的解决方案和对所提供选项的评估。\n\n### 问题验证\n\n第一步是对问题陈述本身进行严格验证。\n\n**第 1 步：提取已知条件**\n\n-   **控制方程**：对于任何控制体 $K \\subset \\Omega \\subset \\mathbb{R}^2$，稳态对流扩散方程的积分守恒形式为 $\\int_{\\partial K} \\big(-\\kappa \\nabla u + \\boldsymbol{\\beta}\\, u\\big)\\cdot \\boldsymbol{n}\\, \\mathrm{d}\\Gamma = \\int_{K} S\\, \\mathrm{d}\\Omega$。\n-   **系数**：$\\kappa > 0$ 是扩散系数（常数），$\\boldsymbol{\\beta}$ 是对流速度，$S$ 是源项。\n-   **数值方法背景**：一种在非结构网格上使用的单元中心控制体方法。\n-   **任务**：确定一个可信的设计和验证方案，以展示一个相容的二阶有限体积方法的二阶收敛性。该方案必须指定：\n    1.  在 $\\Omega=(0,1)^2$ 上的一个人造解 $u(x,y)$。\n    2.  常系数 $\\kappa$ 和 $\\boldsymbol{\\beta}$。\n    3.  相应的源项 $S(x,y)$。\n    4.  合适的边界数据。\n    5.  一个观察二阶收敛的合理程序，包括网格尺寸 $h$、误差范数和观测到的收敛阶的定义。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题建立在标准守恒形式的对流扩散方程之上，这是许多 STEM 领域中输运现象的基石。人工解法（Method of Manufactured Solutions, MMS）是偏微分方程数值解领域中用于代码验证的标准、严谨的技术。收敛阶、误差范数和网格加密等概念是数值分析的基础。该问题不含伪科学，事实可靠。\n-   **适定性**：任务是从一组选项中评估并选择最合适的方案。这是计算科学方法论中的一个明确定义的问题。它要求评估几种提议的实验设计的正确性和严谨性。问题暗示存在一个唯一的最佳选项。\n-   **客观性**：问题以精确、客观的语言陈述。“积分守恒形式”、“二阶收敛”和“单元中心控制体方法”等术语在数值分析的背景下具有特定、无歧义的含义。评估标准基于数值验证的既定原则。\n\n**第 3 步：结论和行动**\n\n问题陈述是有效的。它在科学上是合理的，适定的，并且是客观的。它提出了一个关于正确应用人工解法的标准的、非平凡的问题。我现在将通过评估每个选项来继续解答。\n\n### 解答和选项分析\n\n一个用于展示二阶收敛性的可信验证方案必须被精心构建。每个组成部分——人造解、源项、边界条件、数值方法和误差分析程序——都必须是一致且理论上合理的。\n\n**选项 A 的分析**\n\n1.  **人造解与系数**：$u(x,y)=\\sin(\\pi x)\\sin(\\pi y)+x\\,y$ 是在 $\\Omega=(0,1)^2$ 上的一个无穷可微（光滑）函数。它不是一个低阶多项式，以免二阶方法可能以异常高的精度表示它。系数是常数：$\\kappa=\\tfrac{1}{5}$ 和 $\\boldsymbol{\\beta}=(1,\\tfrac{1}{2})$。这种配置是合适的。\n2.  **源项推导**：问题始于积分守恒定律 $\\int_{\\partial K} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, \\mathrm{d}\\Gamma = \\int_K S \\, \\mathrm{d}\\Omega$，其中通量为 $\\boldsymbol{F} = -\\kappa \\nabla u + \\boldsymbol{\\beta} u$。根据散度定理，这对应于微分方程 $S = \\nabla \\cdot \\boldsymbol{F} = \\nabla \\cdot(-\\kappa \\nabla u + \\boldsymbol{\\beta} u)$。由于 $\\kappa$ 是常数且 $\\boldsymbol{\\beta}$ 是常数向量场，所以 $\\nabla \\cdot \\boldsymbol{\\beta} = 0$。方程简化为 $S = -\\kappa \\Delta u + \\boldsymbol{\\beta} \\cdot \\nabla u$。\n    该选项正确地陈述了这种简化形式。我们来验证计算：\n    -   $\\nabla u(x,y) = \\begin{pmatrix} \\pi\\cos(\\pi x)\\sin(\\pi y)+y \\\\ \\pi\\sin(\\pi x)\\cos(\\pi y)+x \\end{pmatrix}$。\n    -   $\\Delta u(x,y) = \\nabla \\cdot (\\nabla u) = -\\pi^2\\sin(\\pi x)\\sin(\\pi y) - \\pi^2\\sin(\\pi x)\\sin(\\pi y) = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$。\n    -   $\\boldsymbol{\\beta}\\cdot\\nabla u = (1)(\\pi\\cos(\\pi x)\\sin(\\pi y)+y) + (\\tfrac{1}{2})(\\pi\\sin(\\pi x)\\cos(\\pi y)+x)$。\n    -   $S = -(\\tfrac{1}{5})(-2\\pi^2\\sin(\\pi x)\\sin(\\pi y)) + \\pi\\cos(\\pi x)\\sin(\\pi y)+y + \\tfrac{1}{2}\\pi\\sin(\\pi x)\\cos(\\pi y)+\\tfrac{x}{2}$。\n    这简化为 $S(x,y) = \\tfrac{2}{5}\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\pi\\cos(\\pi x)\\sin(\\pi y) + \\tfrac{1}{2}\\pi\\sin(\\pi x)\\cos(\\pi y) + \\tfrac{x}{2} + y$。选项中 $S(x,y)$ 的表达式是正确的。\n3.  **边界条件**：施加狄利克雷边界数据 $u|_{\\partial\\Omega}=u_{\\mathrm{ex}}(x,y)$ 是为 MMS 设置边界条件最直接和一致的方法。\n4.  **数值方法**：描述指定了二阶非结构有限体积方法的所有关键要素：二阶梯度重构（例如，最小二乘法）、二阶面插值，以及至关重要的非正交性修正。这是一个正确和完整的描述。\n5.  **验证程序**：\n    -   保持单元佩克莱数适中，$\\mathrm{Pe}_f=\\tfrac{|\\boldsymbol{\\beta}\\cdot \\boldsymbol{n}_f|\\,h_f}{2\\kappa}=\\mathcal{O}(1)$，是一个审慎的措施，以确保问题保持在对流主导区域，而不会引入可能破坏非耗散对流格式收敛性研究的大量非物理振荡。\n    -   误差度量 $E_\\ell = \\left(\\sum_{K\\in\\mathcal{T}_\\ell} |K|\\,\\big(u_{h,K}-\\bar{u}_K^{\\mathrm{ex}}\\big)^2\\right)^{1/2}$ 是离散的、体积加权的 $L^2$ 误差的正确定义。它正确地将离散单元平均解 $u_{h,K}$ 与精确单元平均值 $\\bar{u}_K^{\\mathrm{ex}}$ 进行比较。\n    -   网格尺寸定义 $h_\\ell=\\max_{K\\in\\mathcal{T}_\\ell}\\mathrm{diam}(K)$ 是理论误差估计中使用的标准定义。\n    -   用于计算观测收敛阶的公式，$p_\\ell = \\frac{\\log\\big(E_\\ell/E_{\\ell+1}\\big)}{\\log\\big(h_\\ell/h_{\\ell+1}\\big)}$，是标准公式。\n\n**对 A 的结论**：此选项的每个组成部分都描述了一个严谨、专业执行的验证方案。它在内部是一致的，并遵循了人工解法的最佳实践。**正确**。\n\n**选项 B 的分析**\n\n1.  **源项推导**：它指定了 $\\boldsymbol{\\beta}(x,y)=(x,y)$，这是一个非恒定向量场，其散度为 $\\nabla \\cdot \\boldsymbol{\\beta} = \\frac{\\partial x}{\\partial x} + \\frac{\\partial y}{\\partial y} = 2 \\neq 0$。源项必须是 $S = \\nabla\\cdot(-\\kappa \\nabla u + \\boldsymbol{\\beta} u) = -\\kappa \\Delta u + (\\nabla\\cdot\\boldsymbol{\\beta})u + \\boldsymbol{\\beta}\\cdot\\nabla u = -\\kappa \\Delta u + 2u + \\boldsymbol{\\beta}\\cdot\\nabla u$。该选项提供了 $S(x,y)=-\\kappa\\,\\Delta u(x,y)+\\boldsymbol{\\beta}\\cdot\\nabla u(x,y)$，这是不正确的，因为它省略了项 $(\\nabla\\cdot\\boldsymbol{\\beta})u$。这个源项对应于 PDE 的非守恒形式，与问题的出发点相矛盾。这是一个致命的缺陷。\n2.  **数值方法**：它建议使用“为保证稳定性的一阶迎风格式”。一阶方法最多只能产生一阶收敛。用一阶格式来展示二阶收敛是根本不可能的。\n3.  **验证程序**：\n    -   误差是“未加权的均方根”。体积加权的范数（如选项 A 中的离散 $L^2$ 范数）是合适的选择，因为它对应于一个连续函数空间范数。\n    -   收敛阶是相对于单元数 $N_\\ell$ 计算的。对于二维问题中的准均匀网格序列，$h_\\ell \\propto N_\\ell^{-1/2}$。一个误差为 $E \\propto h^p$ 的方法将有 $E \\propto (N^{-1/2})^p = N^{-p/2}$。相对于 $N$ 的收敛阶是 $p/2$。所用的公式 $p_\\ell=\\frac{\\log(E_\\ell/E_{\\ell+1})}{\\log(N_\\ell/N_{\\ell+1})}$ 估计的是 $p/2$。为了验证阶数 $p=2$，人们应该观察到相对于 $N$ 的收敛率为 $1$。该选项在计算内容上具有误导性。\n\n**对 B 的结论**：此选项包含多个基本错误：不正确的源项，使用一阶方法测试二阶精度，以及有缺陷的收敛阶计算。**不正确**。\n\n**选项 C 的分析**\n\n1.  **边界条件**：它建议施加“齐次诺伊曼边界条件”。此 PDE 的自然边界条件是关于通量 $\\boldsymbol{F} \\cdot \\boldsymbol{n} = (-\\kappa \\nabla u + \\boldsymbol{\\beta} u)\\cdot \\boldsymbol{n}$ 的。齐次诺伊曼意味着此通量在 $\\partial\\Omega$ 上为零。然而，对于给定的 $u(x,y)$，通量在边界上通常不为零。例如，在边界 $x=1$ 上，$\\boldsymbol{n}=(1,0)$，通量为 $-\\kappa \\frac{\\partial u}{\\partial x} + \\beta_x u = -\\tfrac{1}{5}(-\\pi\\sin(\\pi y)+y) + (1)(\\sin(\\pi)\\sin(\\pi y)+y) = \\tfrac{\\pi}{5}\\sin(\\pi y) + \\tfrac{4}{5}y \\neq 0$。施加一个精确解不满足的条件会使问题不一致。\n2.  **数值方法**：在“偏斜的非结构网格上使用不带非正交性修正的 Green–Gauss 梯度”会把梯度近似的精度降低到一阶，这反过来又会将整个格式在这些网格上的整体精度降低到一阶。这妨碍了观察二阶收敛。\n3.  **验证程序**：\n    -   误差度量 $E_\\ell=\\sum_{K\\in\\mathcal{T}_\\ell}|u_{h,K}-u(x_K,y_K)|$ 不是一个正确的离散 $L^1$ 范数，因为它缺少单元面积权重 $|K|$。\n    -   网格尺寸定义为 $h_\\ell=\\min_{K\\in\\mathcal{T}_\\ell}\\mathrm{diam}(K)$。收敛率在理论上是根据*最大*网格尺寸建立的，它界定了各处的局部误差。使用最小尺寸会产生无意义的收敛率结果。\n\n**对 C 的结论**：此选项几乎在每个方面都有缺陷：不一致的边界条件，一个在通用网格上仅为一阶精度的格式，以及对误差范数和网格尺寸的错误定义。**不正确**。\n\n**选项 D 的分析**\n\n1.  **人造解与边界条件**：$u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ 是一个合适的光滑函数。它在 $\\Omega=(0,1)^2$ 的边界上为零，因此施加齐次狄利克雷边界条件是一致的。\n2.  **数值方法与区域**：它提出了一个“通量限制的迎风格式”，并设置 $\\kappa=\\tfrac{1}{1000}$ 以创建高佩克莱数区域。虽然通量限制器被设计为在光滑区域是二阶的，但它们的目的在于处理非光滑特征或在强对流中防止振荡。对于二阶精度的基线验证，使用这样的格式并不理想；限制器的切换机制有时会干扰获得清晰的渐近收敛率，这种现象被称为阶数降低，尤其是在解的极值点附近（这个 $u_{\\mathrm{ex}}$ 就有）。在不那么极端的佩克莱数区域使用更简单的二阶格式（如 A 中所示）是验证空间离散化核心二阶特性的更直接、更可靠的方法。\n3.  **验证程序**：\n    -   网格尺寸定义为“$h_\\ell$ 等于平均面长度”。这不是收敛性分析的标准或严谨定义。误差界取决于最坏情况下的单元尺寸，即最大直径。使用平均值可能会掩盖真实的收敛行为。这是一个重大的方法论缺陷。\n    -   误差范数是单元中心的最大范数，这是一个有效的选择，但对 $h$ 的有缺陷的定义破坏了计算阶数的整个过程。\n\n**对 D 的结论**：对网格尺寸 $h_\\ell$ 的非标准和不恰当定义是一个关键缺陷。使用复杂的、受限的格式来执行直接的二阶精度基线验证的策略，从方法论的角度来看也是值得怀疑的。**不正确**。\n\n**结论**\n\n只有选项 A 提出了一个全面且方法论上合理的方案，用于使用人工解法验证二阶收敛性。它正确地推导了源项，指定了合适的边界条件，描述了一个合适的二阶数值格式，并采用了标准、严谨的误差范数、网格尺寸和阶数计算定义。", "answer": "$$\\boxed{A}$$", "id": "3409370"}, {"introduction": "对于像伯格斯方程（Burgers' equation）$\\partial_t u + \\partial_x (u^2/2) = 0$這樣的双曲守恒律而言，仅仅满足守恒性并不足以保证解的唯一性和物理正确性，还必须满足一个熵条件。数值格式必须引入适量的耗散来模拟这一物理原理，以防止非物理解的产生。通过这个编程练习，您将比较不同的数值通量并直接测量它们的熵耗散，从而具体地理解理论上的稳定性是如何在实践中体现的。[@problem_id:3409438]", "problem": "考虑一维空间中的无粘伯格斯方程的标量守恒律，由以下偏微分方程 (PDE) 给出\n$$\n\\partial_t u + \\partial_x f(u) = 0,\\quad f(u) = \\frac{u^2}{2},\n$$\n该方程定义在周期为 $1$ 的周期性区域 $[0,1)$ 上。从控制体上的积分守恒律出发，即\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d} t} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t)\\,\\mathrm{d}x + \\left[f\\big(u(x_{i+\\frac{1}{2}}^{-},t)\\big) - f\\big(u(x_{i-\\frac{1}{2}}^{+},t)\\big)\\right] = 0,\n$$\n并将空间域离散为 $N$ 个宽度为 $\\Delta x = 1/N$ 的均匀控制体，其网格平均未知量为\n$$\nu_i(t) \\approx \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t)\\,\\mathrm{d}x,\\quad i=0,1,\\dots,N-1,\n$$\n使用模 $N$ 的周期性索引。通过数值通量 $\\widehat{f}(u_L,u_R)$ 来近似界面通量，从而得到半离散控制体格式\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\frac{1}{\\Delta x}\\left(\\widehat{f}(u_i,u_{i+1}) - \\widehat{f}(u_{i-1},u_i)\\right).\n$$\n使用强稳定性保持三阶龙格-库塔 (SSP-RK) 方法对半离散格式进行时间演化，时间步长 $\\Delta t$ 由 Courant–Friedrichs–Lewy (CFL) 条件选择\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\frac{\\Delta x}{\\max_i |u_i|},\n$$\n其中 $\\mathrm{CFL} = 0.4$，并约定分母由 $\\max\\{\\max_i |u_i|, 10^{-12}\\}$ 替代，以避免除以零。\n\n将伯格斯方程的凸数学熵和熵通量定义为\n$$\nU(u) = \\frac{u^2}{2},\\qquad \\Psi(u) = \\frac{u^3}{3}.\n$$\n在时间 $t$ 的离散总熵为\n$$\n\\mathcal{E}(t) = \\sum_{i=0}^{N-1} U(u_i(t))\\,\\Delta x.\n$$\n在周期性区域上，通过边界的熵通量为零。因此，满足离散熵不等式的离散格式将使得 $\\mathcal{E}(t)$ 随时间非增，并且时间区间 $[0,T]$ 上的离散熵耗散可以通过差值来量化\n$$\n\\Delta \\mathcal{E} = \\mathcal{E}(T) - \\mathcal{E}(0),\n$$\n该值应小于或等于零。\n\n实现并比较两种熵稳定有限体积通量：\n- Lax–Friedrichs 分裂通量。使用伯格斯方程的两点熵守恒通量\n$$\n\\widehat{f}^{\\mathrm{EC}}(u_L,u_R) = \\frac{1}{6}\\left(u_L^2 + u_L u_R + u_R^2\\right),\n$$\n并附加 Lax–Friedrichs 耗散\n$$\n\\widehat{f}^{\\mathrm{LF}}(u_L,u_R) = \\widehat{f}^{\\mathrm{EC}}(u_L,u_R) - \\frac{1}{2}\\,\\alpha^{\\mathrm{LF}}(u_R - u_L),\\quad \\alpha^{\\mathrm{LF}} = \\max\\{|u_L|,|u_R|\\}.\n$$\n- Harten–Lax–van Leer (HLL) 通量。使用伯格斯方程的特征信号速度来定义，这些速度是局部特征速度 $s_L = \\min\\{u_L,u_R\\}$ 和 $s_R = \\max\\{u_L,u_R\\}$ 的最小值和最大值\n$$\n\\widehat{f}^{\\mathrm{HLL}}(u_L,u_R) = \n\\begin{cases}\nf(u_L), & s_L \\ge 0,\\\\\nf(u_R), & s_R \\le 0,\\\\\n\\dfrac{s_R f(u_L) - s_L f(u_R) + s_L s_R (u_R - u_L)}{s_R - s_L}, & \\text{otherwise}.\n\\end{cases}\n$$\n\n时间积分必须使用三阶 SSP-RK 方法以及上述的 $\\Delta t$。对于下面的每个测试用例，计算两种数值通量的离散熵耗散 $\\Delta \\mathcal{E}$ 并报告其值。\n\n测试套件。对以下三种情况进行计算，每种情况都有其自己的参数。所有运行均使用 $\\mathrm{CFL} = 0.4$ 和 $[0,1)$ 上的周期性边界条件。\n- 情况 A (光滑，激波形成前)：$N = 400$，最终时间 $T = 0.12$，初始条件 $u(x,0) = \\sin(2\\pi x)$，其中 $x$ 是网格中心 $x_i = (i+1/2)\\Delta x$。\n- 情况 B (间断，激波和稀疏波)：$N = 400$，最终时间 $T = 0.10$，初始条件为 $x \\in [0,0.5)$ 时 $u(x,0) = 1$，$x \\in [0.5,1)$ 时 $u(x,0) = -1$，并进行周期性环绕处理。\n- 情况 C (常数状态)：$N = 200$，最终时间 $T = 0.10$，对所有 $x$ 初始条件为 $u(x,0) = 0.7$。\n\n答案规格和输出格式。对于每种情况，按顺序计算离散熵耗散值 $\\Delta \\mathcal{E}^{\\mathrm{LF}}$ 和 $\\Delta \\mathcal{E}^{\\mathrm{HLL}}$，它们是实数（无量纲）。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按如下顺序排列\n$$\n\\left[\\Delta \\mathcal{E}^{\\mathrm{LF}}_{\\text{A}},\\ \\Delta \\mathcal{E}^{\\mathrm{HLL}}_{\\text{A}},\\ \\Delta \\mathcal{E}^{\\mathrm{LF}}_{\\text{B}},\\ \\Delta \\mathcal{E}^{\\mathrm{HLL}}_{\\text{B}},\\ \\Delta \\mathcal{E}^{\\mathrm{LF}}_{\\text{C}},\\ \\Delta \\mathcal{E}^{\\mathrm{HLL}}_{\\text{C}}\\right].\n$$\n每个数字应以小数形式打印，小数点后精确到八位。不应打印任何其他文本。由于所有量都是无量纲的，因此不需要物理单位。", "solution": "我们从控制体的积分守恒律开始。对于控制体 $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ 上的标量守恒律 $\\partial_t u + \\partial_x f(u) = 0$，进行积分并使用微积分基本定理可得\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t)\\,\\mathrm{d}x + f\\big(u(x_{i+\\frac{1}{2}}^{-},t)\\big) - f\\big(u(x_{i-\\frac{1}{2}}^{+},t)\\big) = 0.\n$$\n定义网格平均值 $u_i(t) = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t)\\,\\mathrm{d}x$ 并用相容的数值通量 $\\widehat{f}(u_L,u_R)$ 近似通量，可得到半离散有限体积格式\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\frac{1}{\\Delta x}\\left(\\widehat{f}(u_i,u_{i+1}) - \\widehat{f}(u_{i-1},u_i)\\right).\n$$\n这个过程直接在离散层面体现了守恒性，因为当对所有控制体求和时，内部通量会相互抵消。\n\n对于伯格斯方程，$f(u) = \\frac{u^2}{2}$，特征速度为 $a(u) = f'(u) = u$。一个凸数学熵及其熵通量由下式给出\n$$\nU(u) = \\frac{u^2}{2},\\qquad \\Psi(u) = \\int^u a(v)\\,U'(v)\\,\\mathrm{d}v = \\int^u v \\cdot v\\,\\mathrm{d}v = \\frac{u^3}{3}.\n$$\n我们用 $\\mathcal{E}(t) = \\sum_i U(u_i(t))\\Delta x$ 来度量离散总熵。在周期性区域上，对于熵解，连续熵平衡可写作 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int U(u)\\,\\mathrm{d}x \\le 0$；在离散层面，一个熵稳定的有限体积通量 $\\widehat{f}$ 满足一个网格不等式，求和后意味着 $\\mathcal{E}(t)$ 是非增的。\n\n熵稳定通量的构建过程是将其分裂为一个熵守恒的中心通量和一个熵耗散项。对于伯格斯方程，两点熵守恒通量 (Tadmor 通量) 是\n$$\n\\widehat{f}^{\\mathrm{EC}}(u_L,u_R) = \\frac{1}{6}\\left(u_L^2 + u_L u_R + u_R^2\\right).\n$$\n仅此通量是非耗散的，并且离散地守恒熵，但在存在激波时不稳定。添加一个形式为 $-\\frac{1}{2} d(u_L,u_R)(u_R - u_L)$ 的对称正耗散系数 $d(u_L,u_R) \\ge 0$ 会产生一个熵稳定通量。一个典型的选择是 Lax–Friedrichs (也称为 Rusanov) 耗散\n$$\n\\alpha^{\\mathrm{LF}}(u_L,u_R) = \\max\\{|a(u_L)|,|a(u_R)|\\} = \\max\\{|u_L|,|u_R|\\},\n$$\n从而得到 Lax–Friedrichs 分裂通量\n$$\n\\widehat{f}^{\\mathrm{LF}}(u_L,u_R) = \\widehat{f}^{\\mathrm{EC}}(u_L,u_R) - \\frac{1}{2}\\alpha^{\\mathrm{LF}}(u_R - u_L).\n$$\n这个选择是熵稳定的：每个界面上的离散熵产生是非负的，并且求和后得到一个非增的 $\\mathcal{E}(t)$。\n\n另一种熵稳定的离散化方法是使用近似黎曼求解器。Harten–Lax–van Leer (HLL) 通量采用包围所有局部特征速度的边界信号速度 $s_L \\le 0 \\le s_R$。对于伯格斯方程，局部特征速度就是状态本身，因此一个方便的选择是 $s_L = \\min\\{u_L,u_R\\}$ 和 $s_R = \\max\\{u_L,u_R\\}$。HLL 通量是\n$$\n\\widehat{f}^{\\mathrm{HLL}}(u_L,u_R) = \n\\begin{cases}\nf(u_L), & s_L \\ge 0,\\\\\nf(u_R), & s_R \\le 0,\\\\\n\\dfrac{s_R f(u_L) - s_L f(u_R) + s_L s_R (u_R - u_L)}{s_R - s_L}, & \\text{otherwise}.\n\\end{cases}\n$$\n对于标量凸通量，这与 Godunov 通量一致并且是熵耗散的；因此它也产生一个非增的 $\\mathcal{E}(t)$。\n\n时间积分使用强稳定性保持三阶龙格-库塔 (SSP-RK) 格式，当与在合适的 Courant–Friedrichs–Lewy (CFL) 条件下的单调（总变差递减）空间离散化相结合时，可以保持强稳定性性质。该方法通过以下方式将 $u^n$ 更新为 $u^{n+1}$\n$$\n\\begin{aligned}\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n),\\\\\nu^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right),\\\\\nu^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}\\left(u^{(2)} + \\Delta t\\,\\mathcal{L}(u^{(2)})\\right),\n\\end{aligned}\n$$\n其中 $\\mathcal{L}(u)$ 是有限体积空间算子\n$$\n[\\mathcal{L}(u)]_i = -\\frac{1}{\\Delta x}\\left(\\widehat{f}(u_i,u_{i+1}) - \\widehat{f}(u_{i-1},u_i)\\right).\n$$\n时间步长选择为\n$$\n\\Delta t = \\mathrm{CFL}\\cdot \\frac{\\Delta x}{\\max_i |u_i|},\n$$\n其中 $\\mathrm{CFL} = 0.4$，并通过取 $\\max\\{\\max_i |u_i|,10^{-12}\\}$ 来保护最大模。\n\n为了量化离散熵耗散，我们计算\n$$\n\\Delta \\mathcal{E} = \\sum_{i=0}^{N-1} \\frac{u_i(T)^2}{2}\\,\\Delta x - \\sum_{i=0}^{N-1} \\frac{u_i(0)^2}{2}\\,\\Delta x.\n$$\n对于周期性边界，熵平衡没有边界贡献，因此任何单调或熵稳定的通量都应满足 $\\Delta \\mathcal{E} \\le 0$。我们在三个测试用例上对 Lax–Friedrichs 分裂通量和 HLL 通量评估 $\\Delta \\mathcal{E}$：\n- 情况 A：在最终时间 $T = 0.12$ 时，初始数据为光滑的 $\\sin(2\\pi x)$，$N=400$。这个时间点接近但早于精确激波形成时间 $t_s = 1/(2\\pi)$，因此预计耗散会很小，但由于数值扩散而不会为零。\n- 情况 B：在 $T=0.10$ 时，初始数据为间断的阶跃函数，$u=1$ 在 $[0,0.5)$ 上，$u=-1$ 在 $[0.5,1)$ 上，$N=400$。这种情况包含激波和稀疏波；预计耗散会更大，在无接触的标量问题上，HLL 通常比 Lax–Friedrichs 扩散性小，尽管两者都是熵耗散的。\n- 情况 C：在 $T=0.10$ 时，状态为常数 $u=0.7$，$N=200$。在周期性网格上，使用相容数值通量的有限体积方法可以精确地保持常数，因此 $\\Delta \\mathcal{E}$ 在舍入误差范围内应精确为零。\n\n算法流程如下：\n- 将区域离散为 $N$ 个网格，网格中心为 $x_i = (i+\\tfrac{1}{2})\\Delta x$，\n- 根据指定的初始条件初始化 $u_i(0)$，\n- 使用 SSP-RK 方法、所选通量以及根据 CFL 规则的自适应 $\\Delta t$ 进行时间演化，\n- 计算在 $t=0$ 和 $t=T$ 时的总熵 $\\mathcal{E}$，并求其差值 $\\Delta \\mathcal{E}$，\n- 对两种通量和所有三个测试用例重复上述过程，\n- 并按要求的顺序和格式打印六个值。\n\n该设计从积分守恒律出发，并使用有限体积控制体离散化。熵框架为通量选择和作为离散熵耗散可量化度量的 $\\Delta \\mathcal{E}$ 提供了理论依据。周期性边界确保了边界熵通量为零，从而将观测到的 $\\mathcal{E}$ 变化直接与数值耗散联系起来。", "answer": "```python\nimport numpy as np\n\ndef flux_physical(u):\n    return 0.5 * u * u\n\ndef flux_entropy_conservative(uL, uR):\n    # Tadmor EC flux for Burgers: (uL^2 + uL*uR + uR^2)/6\n    return (uL*uL + uL*uR + uR*uR) / 6.0\n\ndef flux_LF_split(uL, uR):\n    f_ec = flux_entropy_conservative(uL, uR)\n    alpha = max(abs(uL), abs(uR))\n    return f_ec - 0.5 * alpha * (uR - uL)\n\ndef flux_HLL(uL, uR):\n    fL = flux_physical(uL)\n    fR = flux_physical(uR)\n    sL = min(uL, uR)\n    sR = max(uL, uR)\n    if sL >= 0.0:\n        return fL\n    elif sR = 0.0:\n        return fR\n    else:\n        denom = sR - sL\n        # denom > 0 because sR > sL when sL  0  sR\n        return (sR * fL - sL * fR + sL * sR * (uR - uL)) / denom\n\ndef compute_fluxes(u, flux_func):\n    N = len(u)\n    # Periodic indexing\n    fluxes = np.zeros(N, dtype=float)\n    for i in range(N):\n        uL = u[i]\n        uR = u[(i + 1) % N]\n        fluxes[i] = flux_func(uL, uR)\n    return fluxes\n\ndef spatial_operator(u, dx, flux_func):\n    N = len(u)\n    F = compute_fluxes(u, flux_func)\n    # Residual: -(F_{i+1/2} - F_{i-1/2})/dx\n    # Here F[i] corresponds to interface between i and i+1 (i+1/2)\n    # So F_imh for cell i is F[i-1], F_iph is F[i]\n    res = -(F - np.roll(F, 1)) / dx\n    return res\n\ndef ssp_rk3(u0, T, dx, CFL, flux_func):\n    u = u0.copy()\n    t = 0.0\n    while t  T - 1e-14:\n        umax = np.max(np.abs(u))\n        denom = max(umax, 1e-12)\n        dt = CFL * dx / denom\n        # Do not step beyond T\n        if t + dt > T:\n            dt = T - t\n        # Stage 1\n        L1 = spatial_operator(u, dx, flux_func)\n        u1 = u + dt * L1\n        # Stage 2\n        L2 = spatial_operator(u1, dx, flux_func)\n        u2 = 0.75 * u + 0.25 * (u1 + dt * L2)\n        # Stage 3\n        L3 = spatial_operator(u2, dx, flux_func)\n        u = (1.0/3.0) * u + (2.0/3.0) * (u2 + dt * L3)\n        t += dt\n    return u\n\ndef total_entropy(u, dx):\n    return np.sum(0.5 * u * u) * dx\n\ndef init_case_A(N):\n    dx = 1.0 / N\n    x = (np.arange(N) + 0.5) * dx\n    return np.sin(2.0 * np.pi * x)\n\ndef init_case_B(N):\n    dx = 1.0 / N\n    x = (np.arange(N) + 0.5) * dx\n    u = np.empty(N, dtype=float)\n    u[x  0.5] = 1.0\n    u[x >= 0.5] = -1.0\n    return u\n\ndef init_case_C(N, c=0.7):\n    return np.full(N, c, dtype=float)\n\ndef run_case(u0, T, flux_func, CFL=0.4):\n    N = len(u0)\n    dx = 1.0 / N\n    E0 = total_entropy(u0, dx)\n    uT = ssp_rk3(u0, T, dx, CFL, flux_func)\n    ET = total_entropy(uT, dx)\n    return ET - E0\n\ndef solve():\n    # Test suite parameters\n    CFL = 0.4\n    # Case A\n    N_A = 400\n    T_A = 0.12\n    u0_A = init_case_A(N_A)\n    # Case B\n    N_B = 400\n    T_B = 0.10\n    u0_B = init_case_B(N_B)\n    # Case C\n    N_C = 200\n    T_C = 0.10\n    u0_C = init_case_C(N_C, c=0.7)\n\n    results = []\n\n    # Case A: LF split and HLL\n    dE_A_LF = run_case(u0_A, T_A, flux_func=lambda a,b: flux_LF_split(a,b), CFL=CFL)\n    dE_A_HLL = run_case(u0_A, T_A, flux_func=lambda a,b: flux_HLL(a,b), CFL=CFL)\n    results.extend([dE_A_LF, dE_A_HLL])\n\n    # Case B: LF split and HLL\n    dE_B_LF = run_case(u0_B, T_B, flux_func=lambda a,b: flux_LF_split(a,b), CFL=CFL)\n    dE_B_HLL = run_case(u0_B, T_B, flux_func=lambda a,b: flux_HLL(a,b), CFL=CFL)\n    results.extend([dE_B_LF, dE_B_HLL])\n\n    # Case C: LF split and HLL\n    dE_C_LF = run_case(u0_C, T_C, flux_func=lambda a,b: flux_LF_split(a,b), CFL=CFL)\n    dE_C_HLL = run_case(u0_C, T_C, flux_func=lambda a,b: flux_HLL(a,b), CFL=CFL)\n    results.extend([dE_C_LF, dE_C_HLL])\n\n    # Format with exactly 8 digits after decimal point\n    formatted = \",\".join(f\"{val:.8f}\" for val in results)\n    print(f\"[{formatted}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3409438"}]}