{"hands_on_practices": [{"introduction": "为了量化评估有限差分格式引入的误差，一个强大的工具是在傅里叶空间中分析其行为。对一个精确的微分算子 $\\partial_x$ 而言，其傅里叶符号是 $ik$，而一个离散的差分算子则会产生一个“有效波数” $k^*$，使得其作用等效于乘以 $ik^*$。[@problem_id:3425558] 这项练习将引导您推导中心差分和迎风差分格式的有效波数，从而从根本上揭示数值色散（$k^*$ 的实部与 $k$ 的差异）和数值耗散（$k^*$ 的虚部）的来源。", "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中速度 $a0$ 为常数。定义一个均匀网格 $x_{j} = j h$，其中网格间距 $h0$，网格索引 $j \\in \\mathbb{Z}$。为一阶导数 $u_{x}$ 定义两种空间离散化方法：\n- 二阶中心差分格式 $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 h}$。\n- 一阶迎风格式（适用于 $a0$）$D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{h}$。\n\n对于一个离散平面波 $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$，其实际波数为 $k \\in \\mathbb{R}$，振幅为常数 $\\hat{u} \\in \\mathbb{C}$，通过离散傅里叶符号关系 $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$ 定义有效波数映射 $k^{\\ast}(k)$，其中 $D$ 表示 $D_{\\mathrm{c}}$ 或 $D_{\\mathrm{u}}$。使用离散傅里叶变换 (DFT) 的观点和上述 $k^{\\ast}(k)$ 的定义，完成以下任务：\n1. 推导 $D_{\\mathrm{c}}$ 和 $D_{\\mathrm{u}}$ 的 $k^{\\ast}(k)$ 的精确解析表达式。\n2. 推导 $D_{\\mathrm{c}}$ 和 $D_{\\mathrm{u}}$ 的偏差函数 $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$。\n3. 根据您的表达式，简要解释当这些一维格式在二维张量积网格上逐维应用以近似方向导数时，$k^{\\ast}(k)$ 中的平台（即在某个 $k$ 区间上 $\\frac{d k^{\\ast}}{d k} \\approx 0$ 的区域）和拐点等特征如何与数值各向异性相关联。\n\n用 $k$ 和 $h$ 的符号形式表达您的最终答案，并将其表示为一个单行矩阵，按顺序包含 $k^{\\ast}_{\\mathrm{c}}(k)$、$k^{\\ast}_{\\mathrm{u}}(k)$、$\\Delta_{\\mathrm{c}}(k)$ 和 $\\Delta_{\\mathrm{u}}(k)$ 这四个条目。无需四舍五入；给出精确的封闭形式表达式。", "solution": "解答过程按照问题陈述的要求分为三个部分。我们分析给定差分算子的离散傅里叶符号，以确定有效波数 $k^{\\ast}(k)$ 和偏差函数 $\\Delta(k)$。\n\n**1. 推导有效波数 $k^{\\ast}_{\\mathrm{c}}(k)$ 和 $k^{\\ast}_{\\mathrm{u}}(k)$**\n\n有效波数 $k^{\\ast}(k)$ 由关系式 $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$ 定义，适用于离散平面波 $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$。代入 $x_j = jh$，我们得到 $u_j = \\hat{u}\\,\\exp(i k j h)$。我们将每个差分算子 $D$ 应用于此平面波，并求解 $k^{\\ast}(k)$。\n\n**中心差分格式 ($D_{\\mathrm{c}}$):**\n二阶中心差分算子为 $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 h}$。将其应用于平面波，得到：\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k (j+1) h) - \\hat{u}\\,\\exp(i k (j-1) h)}{2 h}\n$$\n我们提出公因子项 $\\hat{u}\\,\\exp(i k j h)$，它等于 $u_j$：\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2h} \\left( \\exp(i k h) - \\exp(-i k h) \\right)\n$$\n使用 Euler 恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，我们可以将括号中的表达式重写为 $2i\\sin(kh)$：\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2h} \\left( 2i\\sin(kh) \\right) = i \\frac{\\sin(kh)}{h} u_j\n$$\n将此结果与定义 $D_{\\mathrm{c}} u_{j} = i k^{\\ast}_{\\mathrm{c}}(k) u_{j}$ 进行比较，我们可以直接确定中心格式的有效波数表达式：\n$$\nk^{\\ast}_{\\mathrm{c}}(k) = \\frac{\\sin(kh)}{h}\n$$\n该有效波数是纯实数，这表明二阶中心差分格式是无耗散的；它只引入相位（色散）误差。\n\n**迎风格式 ($D_{\\mathrm{u}}$):**\n一阶迎风算子（对于 $a0$）是 $D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{h}$。将其应用于平面波：\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k j h) - \\hat{u}\\,\\exp(i k (j-1) h)}{h}\n$$\n再次，我们提出公因子 $u_j = \\hat{u}\\,\\exp(i k j h)$：\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{u_j}{h} \\left( 1 - \\exp(-i k h) \\right)\n$$\n根据定义 $D_{\\mathrm{u}} u_{j} = i k^{\\ast}_{\\mathrm{u}}(k) u_{j}$，我们发现 $i k^{\\ast}_{\\mathrm{u}}(k)$ 是算子的傅里叶符号：\n$$\ni k^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k h)}{h}\n$$\n求解 $k^{\\ast}_{\\mathrm{u}}(k)$：\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k h)}{ih}\n$$\n为了用实部和虚部表示它，我们使用 Euler 恒等式 $\\exp(-ikh) = \\cos(kh) - i\\sin(kh)$：\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - (\\cos(kh) - i\\sin(kh))}{ih} = \\frac{1 - \\cos(kh) + i\\sin(kh)}{ih}\n$$\n将分子和分母同乘以 $-i$（因为 $1/i = -i$），得到：\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{-i(1-\\cos(kh)) -i^2\\sin(kh)}{-i^2h} = \\frac{\\sin(kh) - i(1-\\cos(kh))}{h}\n$$\n这个有效波数是复数。其实部 $\\mathrm{Re}[k^{\\ast}_{\\mathrm{u}}(k)] = \\frac{\\sin(kh)}{h}$ 控制数值色散（相位误差）。其虚部 $\\mathrm{Im}[k^{\\ast}_{\\mathrm{u}}(k)] = -\\frac{1-\\cos(kh)}{h}$ 控制数值耗散（振幅误差）。\n\n**2. 推导偏差函数 $\\Delta_{\\mathrm{c}}(k)$ 和 $\\Delta_{\\mathrm{u}}(k)$**\n\n偏差函数定义为 $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$。它量化了有效波数与精确波数相比的相对误差。\n\n**中心差分格式 ($\\Delta_{\\mathrm{c}}$):**\n$$\n\\Delta_{\\mathrm{c}}(k) = \\frac{k^{\\ast}_{\\mathrm{c}}(k)}{k} - 1 = \\frac{\\sin(kh)/h}{k} - 1 = \\frac{\\sin(kh)}{kh} - 1\n$$\n\n**迎风格式 ($\\Delta_{\\mathrm{u}}$):**\n$$\n\\Delta_{\\mathrm{u}}(k) = \\frac{k^{\\ast}_{\\mathrm{u}}(k)}{k} - 1 = \\frac{(\\sin(kh) - i(1 - \\cos(kh)))/h}{k} - 1 = \\frac{\\sin(kh) - i(1 - \\cos(kh))}{kh} - 1\n$$\n\n**3. $k^{\\ast}(k)$ 特征与二维数值各向异性之间的联系**\n\n当数值格式的误差取决于波相对于计算网格的传播方向时，就会出现数值各向异性。当一维格式在二维张量积网格上逐维应用时，有效波数变成一个向量 $\\mathbf{k}^{\\ast} = (k^{\\ast}(k_x), k^{\\ast}(k_y))$，其中 $k_x$ 和 $k_y$ 是实际波数向量 $\\mathbf{k}$ 的分量。\n\n平流方程的精确色散关系是线性的，例如 $\\omega = \\mathbf{a} \\cdot \\mathbf{k}$。数值色散关系 $\\omega_{\\mathrm{num}} = \\mathbf{a} \\cdot \\mathbf{k}^{\\ast} = a_x k^{\\ast}(k_x) + a_y k^{\\ast}(k_y)$ 是非线性的，因为 $k^{\\ast}(k)$ 是其自变量的非线性函数。这种非线性是数值各向异性的根本来源，因为误差特性不具有旋转不变性；它们依赖于 $\\mathbf{k}$ 与网格轴的对齐方式。\n\n一维 $k^{\\ast}(k)$ 对 $k$ 曲线的特定特征对应于严重的各向异性效应：\n\n- **平台：** $\\mathrm{Re}[k^{\\ast}(k)]$ 图像中的平台意味着导数 $\\frac{d}{dk}\\mathrm{Re}[k^{\\ast}(k)]$ 近似为零。该导数与数值群速度成正比。对于中心差分和迎风格式，$\\mathrm{Re}[k^{\\ast}(k)] = \\frac{\\sin(kh)}{h}$，它在 $kh = \\frac{\\pi}{2}$ 处有一个平台（零导数）。对于一个二维波，如果其传播方式使得其某个波数分量（例如 $k_x$）满足 $k_x h \\approx \\frac{\\pi}{2}$，那么群速度的相应分量将消失。这会导致波包以不正确的、与网格对齐的方向传播，这是严重数值各向异性的典型表现。\n\n- **拐点和极值点：** $k^{\\ast}(k)$ 曲线中的一个拐点对应于群速度的一个极值点。两种格式色散部分最病态的点是在奈奎斯特波数处，即 $kh=\\pi$。在这一点上，$\\mathrm{Re}[k^{\\ast}(\\pi/h)]=0$，且群速度为负，$v_g \\propto \\cos(\\pi)=-1$。这意味着高波数分量可能沿错误的方向传播。在二维模拟中，如果一个波斜向于网格传播，其分量 $k_x h$ 和 $k_y h$ 可能落入色散曲线的不同区域。例如，一个分量可能处于正群速度区域，而另一个分量处于负群速度区域，从而导致波结构以高度依赖方向的方式完全崩解。\n\n总之，$k^{\\ast}$ 和 $k$ 之间的非线性关系是各向异性的原因。平台和拐点是色散曲线上的标志，它们标志着病态波传播行为（例如，零或负群速度）的区域，这在多维空间中表现为极端的方向偏差。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sin(kh)}{h}  \\frac{\\sin(kh) - i(1 - \\cos(kh))}{h}  \\frac{\\sin(kh)}{kh} - 1  \\frac{\\sin(kh) - i(1 - \\cos(kh))}{kh} - 1\n\\end{pmatrix}\n}\n$$", "id": "3425558"}, {"introduction": "理论分析揭示，中心差分等格式可能导致高频波分量的相速度超过真实物理速度，这种现象称为色散超调（dispersive overshoot）。当模拟含有间断或尖锐梯度的波形（如方波或锯齿波）时，这种超调会表现为间断处前方出现的非物理振荡，即吉布斯类现象。[@problem_id:3425583] 在这项实践中，您将通过模拟一个锯齿波的平流过程，亲眼观察并量化这种由数值色散引起的过冲现象，并将其与基于色散关系的理论预测指标进行比较。", "problem": "考虑一个定义在周期性域上的一维常系数线性平流方程，\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\\quad x\\in[0,1),\\ t\\ge 0,\n$$\n其中平流速度 $a0$，并采用周期性边界条件。初始条件为一个零均值的锯齿波，由下式给出\n$$\nu(x,0) = s(x) := x - \\lfloor x \\rfloor - \\tfrac{1}{2},\n$$\n该波在每个整数点处都有一个量级为 $1$ 的跳跃。你将使用两种全离散有限差分格式，在一个包含 $N_x$ 个点和周期性边界条件的均匀网格上，对该初始条件进行数值演化：\n\n- 一种二阶中心格式，形式为经典的 Lax–Wendroff 更新，\n$$\nu_j^{n+1} = u_j^n - \\frac{\\nu}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right),\n$$\n- 一种一阶迎风格式，\n$$\nu_j^{n+1} = u_j^n - \\nu\\left(u_j^n - u_{j-1}^n\\right),\n$$\n其中 $u_j^n$ 是对 $x_j = j\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$ 处 $u(x_j, t^n)$ 的近似，Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a\\,\\Delta t/\\Delta x$，并且索引对 $N_x$ 取模以强制施加周期性。\n\n你的任务如下。\n\n1. 从傅里叶模式拟设 $u_j^n = \\hat{u}\\,\\exp\\!\\left(i(j\\,\\kappa - n\\,\\omega\\,\\Delta t)\\right)$ 出发，其中离散波数 $\\kappa \\in [0,\\pi]$，为每种格式定义以满足以下条件的放大因子 $G(\\kappa)$ 表示的全离散色散关系\n$$\ne^{-i\\,\\omega(\\kappa)\\,\\Delta t} = G(\\kappa).\n$$\n由此，定义数值相位 $\\theta(\\kappa)$ 为展开后的宗量 $\\theta(\\kappa) = -\\mathrm{Arg}\\,G(\\kappa)$，使其在 $\\kappa$ 上连续，并定义数值相速度比\n$$\n\\rho(\\kappa) = \\frac{\\omega(\\kappa)}{a\\,k} = \\frac{\\theta(\\kappa)}{\\nu\\,\\kappa},\n$$\n其中 $k = \\kappa/\\Delta x$ 是物理波数。解释为什么对于某些高波数 $\\kappa$，$\\rho(\\kappa)1$ 表明相对于真实相速度存在色散过冲。\n\n2. 使用每种格式，以均匀时间步长 $\\Delta t = \\nu\\,\\Delta x/a$ 将锯齿波初始条件演化至时间 $T$，共计 $N_t = \\lfloor T/\\Delta t \\rfloor$ 步。将 $t^{N_t}$ 时的数值解记为 $u_j^{N_t}$。令平流后的间断点位置为 $x_\\star = (a\\,N_t\\,\\Delta t)\\ \\mathrm{mod}\\ 1$。定义一个以索引 $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$ 为中心、包含 $2m+1$ 个网格点的小窗口，其中 $m=6$。通过下式量化类 Gibbs 现象的过冲幅度\n$$\n\\mathcal{O} = \\max\\big\\{0,\\, \\max_{|j-j_\\star|\\le m} u_j^{N_t} - \\tfrac{1}{2}\\big\\},\n$$\n即窗口内超过上平台水平 $\\tfrac{1}{2}$ 的正超出部分，若无过冲则截断为零。不使用物理单位；所有量均为无量纲。\n\n3. 使用 Lax–Wendroff 格式的离散色散关系，定义近奈奎斯特（near-Nyquist）色散过冲预测器为\n$$\n\\Pi = \\max_{\\kappa\\in[\\alpha\\pi,\\pi]} \\max\\{0,\\, \\rho(\\kappa) - 1\\},\n$$\n其中 $\\alpha = 0.8$。这隔离了伪色散最显著的高波数区域。\n\n实现一个程序，该程序：\n- 构建周期性网格，初始化 $u(x,0)=s(x)$，将每种格式推进到时间 $T$，计算每种格式的过冲幅度 $\\mathcal{O}$，并使用展开后的数值相位 $\\theta(\\kappa)$ 计算 Lax–Wendroff 格式的预测器 $\\Pi$。\n- 使用以下参数三元组 $(N_x,\\nu,T)$ 的测试套件，其中 $a=1$：\n    - 情况 A：$(N_x,\\nu,T) = (256,\\,0.2,\\,0.2)$，\n    - 情况 B：$(N_x,\\nu,T) = (256,\\,0.9,\\,0.2)$，\n    - 情况 C：$(N_x,\\nu,T) = (64,\\,0.5,\\,0.2)$。\n- 对于每种情况，返回浮点数三元组\n$$\n\\Big[\\ \\mathcal{O}_{\\mathrm{LW}},\\ \\mathcal{O}_{\\mathrm{UP}},\\ \\Pi_{\\mathrm{LW}}\\ \\Big],\n$$\n其中 $\\mathcal{O}_{\\mathrm{LW}}$ 是 Lax–Wendroff 格式的测量过冲，$\\mathcal{O}_{\\mathrm{UP}}$ 是迎风格式的测量过冲，$\\Pi_{\\mathrm{LW}}$ 是根据 Lax–Wendroff 色散关系计算出的预测器。将报告的每个浮点数四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含情况 A、B 和 C 的结果，按顺序连接成一个用方括号括起来的逗号分隔列表，即\n$$\n[\\mathcal{O}_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(A)},\\ \\Pi_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(B)},\\ \\Pi_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(C)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(C)},\\ \\Pi_{\\mathrm{LW}}^{(C)}],\n$$\n不含任何附加文本。每个数字必须按规定四舍五入到 $6$ 位小数。此设计旨在测试一个典型情况、一个接近稳定性的高 Courant 数情况以及一个较粗网格情况，以探究类 Gibbs 振荡对近奈奎斯特波数处的色散过冲的依赖性。", "solution": "### 第 1 部分：色散关系与相速度\n\n我们首先为每种格式推导放大因子 $G(\\kappa)$。我们将傅里叶模式拟设 $u_j^n = G^n(\\kappa) e^{ij\\kappa}$ 代入有限差分格式中。\n\n**Lax-Wendroff 格式**\n将拟设代入 LW 格式得到：\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\frac{\\nu}{2}\\left(e^{i(j+1)\\kappa} - e^{i(j-1)\\kappa}\\right) + \\frac{\\nu^2}{2}\\left(e^{i(j+1)\\kappa} - 2e^{ij\\kappa} + e^{i(j-1)\\kappa}\\right)\n$$\n两边同除以 $e^{ij\\kappa}$ 并使用欧拉恒等式 $e^{i\\kappa}-e^{-i\\kappa} = 2i\\sin\\kappa$ 和 $e^{i\\kappa}+e^{-i\\kappa} = 2\\cos\\kappa$：\n$$\n\\begin{align*}\nG_{\\mathrm{LW}}(\\kappa) = 1 - \\frac{\\nu}{2}(e^{i\\kappa} - e^{-i\\kappa}) + \\frac{\\nu^2}{2}(e^{i\\kappa} - 2 + e^{-i\\kappa}) \\\\\n= 1 - i\\nu\\sin\\kappa + \\frac{\\nu^2}{2}(2\\cos\\kappa - 2) \\\\\n= 1 - \\nu^2(1 - \\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**迎风格式**\n类似地，对于一阶迎风格式（$a0$）：\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\nu\\left(e^{ij\\kappa} - e^{i(j-1)\\kappa}\\right)\n$$\n两边同除以 $e^{ij\\kappa}$：\n$$\n\\begin{align*}\nG_{\\mathrm{UP}}(\\kappa) = 1 - \\nu(1 - e^{-i\\kappa}) \\\\\n= 1 - \\nu + \\nu e^{-i\\kappa} \\\\\n= (1 - \\nu + \\nu\\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**数值相速度与色散过冲**\n数值色散关系由 $\\omega(\\kappa)$ 给出，其中 $e^{-i\\omega(\\kappa)\\Delta t} = G(\\kappa)$。这意味着 $\\omega(\\kappa) = i\\ln(G(\\kappa))/\\Delta t$。数值相速度为 $v_p(\\kappa) = \\omega(\\kappa)/k$，其中 $k = \\kappa/\\Delta x$ 是物理波数。该偏微分方程的精确色散关系是 $\\omega_{\\mathrm{exact}}(k) = ak$，其相速度为常数 $a$。\n\n数值相速度比 $\\rho(\\kappa)$ 是数值相速度与精确相速度之比：\n$$\n\\rho(\\kappa) = \\frac{v_p(\\kappa)}{a} = \\frac{\\omega(\\kappa)}{ak}\n$$\n根据定义 $e^{-i\\omega\\Delta t} = G(\\kappa)$ 和 $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$，我们有 $-i\\omega\\Delta t = \\ln|G(\\kappa)| + i\\mathrm{Arg}(G(\\kappa)) = \\ln|G(\\kappa)| - i\\theta(\\kappa)$。取等式两边的虚部，我们得到 $\\omega\\Delta t = \\theta(\\kappa)$。将此代入 $\\rho(\\kappa)$ 的表达式中：\n$$\n\\rho(\\kappa) = \\frac{\\theta(\\kappa)/\\Delta t}{a(\\kappa/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\kappa(a\\Delta t/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\nu\\kappa}\n$$\n这与问题中给出的定义相符。\n\n$\\rho(\\kappa)  1$ 的值表明，波数为 $k$ 的数值解分量比真实的波速 $a$ 传播得更快。这被称为超前相误差。间断点，例如锯齿波初始条件中的跳跃，是由宽谱的傅里叶模式组成的。如果高波数分量（大的 $k$，对应于接近奈奎斯特频率 $\\pi$ 的 $\\kappa$）比构成波主体部分的低波数分量传播得快，它们就会“跑到”主波形的前面。这些快速移动的高频模式的叠加会在平流后的间断点前方产生伪振荡。这种效应是 Gibbs 现象的一种形式，称为色散过冲。度量 $\\mathcal{O}$ 旨在量化这些超前振荡的幅度。\n\n### 第 2 和 3 部分：数值实现\n解答需要为两种格式实现时间演化，然后计算指定的度量。\n\n1.  **初始化**：对于每个测试用例 $(N_x, \\nu, T)$（$a=1$），我们定义网格间距 $\\Delta x = 1/N_x$ 和时间步长 $\\Delta t = \\nu \\Delta x/a$。总步数为 $N_t = \\lfloor T/\\Delta t \\rfloor$。初始条件 $u(x,0) = x - 1/2$（对于 $x \\in [0,1)$）在网格 $x_j=j\\Delta x$ 上离散化为 $u_j^0 = j\\Delta x - 1/2$。\n\n2.  **时间演化**：我们迭代 $N_t$ 次。在每一步中，我们使用各自的公式更新两种格式的数值解 $u_j$。周期性通过对索引以 $N_x$ 取模来处理。\n\n3.  **过冲计算（$\\mathcal{O}$）**：在最后一个时间步 $t^{N_t}$ 之后，我们计算平流后间断点的精确位置，$x_\\star = (a N_t \\Delta t) \\pmod 1$。最近的网格索引是 $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$。我们在以 $j_\\star$ 为中心的 $2m+1$ 个点的窗口内找到数值解的最大值。过冲是该最大值超过上平台值 $1/2$ 的量，并截断为零。对于 $\\nu \\in [0,1]$，一阶迎风格式是单调的，这意味着它不会产生新的极值。因此，我们预期对于所有测试用例，$\\mathcal{O}_{\\mathrm{UP}} = 0$。\n\n4.  **预测器计算（$\\Pi_{\\mathrm{LW}}$）**：对于 Lax-Wendroff 格式，我们在 $\\kappa \\in [0, \\pi]$ 的精细离散化上计算相速度比 $\\rho(\\kappa)$。至关重要的是对相位 $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$ 使用相位展开（unwrapping），以处理当 $G(\\kappa)$ 在复平面上穿过负实轴时发生的相位跳跃。然后我们在高波数范围 $[\\alpha\\pi, \\pi]$ 内找到 $\\rho(\\kappa)-1$ 的最大值，并截断为零。", "answer": "[0.082531,0.000000,0.119632,0.111816,0.000000,0.005193,0.183492,0.000000,0.222045]", "id": "3425583"}, {"introduction": "除了定性观察，我们还需要定量分析数值误差如何长期影响波包的整体动态特性，例如其位置和形状。一个波包的移动由其群速度决定，而其展宽则与群速度色散有关，数值格式会同时扭曲这两者。[@problem_id:3425532] 本练习将通过分析一个高斯波包的演化，指导您将波包质心位置的漂移误差和空间方差的增长分解为由数值色散和数值耗散分别贡献的部分，从而深入理解这两种误差的综合效应。", "problem": "考虑实数线上的线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，其中平流速度 $a0$ 为常数。初始条件为一个调制的髙斯波包 $u(x,0) = \\exp\\!\\left(-\\left(\\frac{x}{\\sigma}\\right)^2\\right)\\cos(k_0 x)$，其中 $\\sigma0$ 是包络宽度参数，$k_00$ 是载波波数。所有角度和波数都必须以弧度为单位处理。将时间 $t$ 的能量密度质心和展宽（方差）定义为\n$$\nx_c(t) = \\frac{\\int_{\\mathbb{R}} x\\,|u(x,t)|^2\\,dx}{\\int_{\\mathbb{R}} |u(x,t)|^2\\,dx},\\qquad\n\\mathrm{Var}_x(t) = \\frac{\\int_{\\mathbb{R}} (x - x_c(t))^2\\,|u(x,t)|^2\\,dx}{\\int_{\\mathbb{R}} |u(x,t)|^2\\,dx}.\n$$\n对于连续偏微分方程，$x_c(t)=a\\,t$ 且 $\\mathrm{Var}_x(t)$ 不随时间变化。\n\n我们研究在间距为 $\\Delta x$ 的均匀网格上，由两种半离散线方法的空间离散化引入的数值色散和数值耗散：\n- 中心差分 $D^0 u_j = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$，以及\n- （对于 $a0$ 的）单边迎风差分 $D^- u_j = \\frac{u_{j} - u_{j-1}}{\\Delta x}$。\n\n假设对于半离散线性常微分方程，时间推进是精确的，因此数值相位和振幅的演化完全由空间离散傅里叶符号决定。\n\n任务：\n1. 从上述定义和对 $u_j(t) \\propto e^{i(j\\kappa - \\omega t)}$ 的离散傅里叶模态分析出发，对每种空间离散化，推导数值色散关系 $\\omega_{\\mathrm{num}}(k)$ 和耗散率 $\\gamma(k)$ 作为连续波数 $k$ 和网格间距 $\\Delta x$ 的函数，其中 $\\kappa = k\\,\\Delta x$。定义数值群速度 $v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk}$ 和曲率 $\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2}$。\n2. 在 $k_0$ 附近的谱空间中使用窄带高斯近似，通过将初始高斯谱强度乘以因子 $\\exp\\!\\left(-2\\,\\gamma(k)\\,t\\right)$ 并将 $\\gamma(k)$ 在 $k_0$ 附近展开至二阶，来为迎风格式在时间 $t$ 的谱强度（振幅的平方）建模。利用此模型证明，在时间 $t$ 的有效谱强度方差变为\n$$\ns_k^2(t) = \\left(\\frac{1}{s_k^2(0)} + 2\\,\\gamma''(k_0)\\,t\\right)^{-1},\n$$\n且谱强度均值移动量为\n$$\n\\delta k(t) = -2\\,\\gamma'(k_0)\\,t\\,s_k^2(t),\n$$\n其中 $s_k^2(0)$ 是围绕 $k_0$ 的初始谱强度方差，撇号表示关于 $k$ 的导数。\n3. 对窄带波包使用驻相法，论证质心近似按\n$$\nx_c(t) \\approx v_g(k_0)\\,t + \\beta_2(k_0)\\,\\delta k(t)\\,t,\n$$\n漂移，因此相对于精确平流的质心漂移误差 $\\Delta x_c(t) = x_c(t) - a\\,t$ 可分解为一个色散贡献 $\\left(v_g(k_0) - a\\right)t$ 和一个额外的耗散贡献 $\\beta_2(k_0)\\,\\delta k(t)\\,t$（对于迎风格式）。对于中心格式，$\\delta k(t)=0$。\n4. 证明对于方差为 $s_k^2(t)$ 的高斯谱强度分布，在时间 $t$ 的空间强度方差满足近似\n$$\n\\mathrm{Var}_x(t) \\approx \\frac{1}{4\\,s_k^2(t)} + \\beta_2(k_0)^2\\,t^2\\,s_k^2(t).\n$$\n因此，相对于 $t=0$ 的展宽增量可分解为一个色散部分 $\\beta_2(k_0)^2\\,t^2\\,s_k^2(t)$ 和一个耗散部分 $\\frac{1}{4\\,s_k^2(t)} - \\frac{1}{4\\,s_k^2(0)}$（对于迎风格式）。对于中心格式，$s_k^2(t)=s_k^2(0)$ 且耗散部分消失。\n5. 使用初始条件 $u(x,0) = \\exp\\!\\left(-\\left(\\frac{x}{\\sigma}\\right)^2\\right)\\cos(k_0 x)$ 来确定初始谱强度方差 $s_k^2(0)$（用 $\\sigma$ 表示）。所有波数和角度均以弧度为单位。\n\n实现一个程序，对下面的每个测试用例，计算：\n- 中心格式的质心漂移误差 $\\Delta x_c^{\\mathrm{cen}}(T)$，\n- 迎风格式的总质心漂移误差 $\\Delta x_c^{\\mathrm{up}}(T)$，\n- 迎风格式质心漂移误差的色散和耗散分量，\n- 中心格式的展宽增量 $\\Delta\\mathrm{Var}_x^{\\mathrm{cen}}(T)$，\n- 迎风格式的总展宽增量 $\\Delta\\mathrm{Var}_x^{\\mathrm{up}}(T)$，\n- 迎风格式展宽增量的色散和耗散分量。\n\n所有量都必须以无量纲单位计算，并且角度必须以弧度处理。使用前述的半离散、时间精确框架。\n\n测试套件（每个元组为 $(a,\\ \\sigma,\\ k_0,\\ \\Delta x,\\ T)$）：\n- 用例 A（理想情况）：$(1.0,\\ 4.0,\\ 0.5,\\ 0.2,\\ 1.5)$，\n- 用例 B（接近 Nyquist 边界）：$(1.0,\\ 3.0,\\ \\pi,\\ 0.5,\\ 1.0)$，\n- 用例 C（更宽的谱和中等网格）：$(2.0,\\ 1.5,\\ 1.2,\\ 0.3,\\ 0.8)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个用例的结果按以下顺序排列：\n$[\\Delta x_c^{\\mathrm{cen}},\\ \\Delta x_c^{\\mathrm{up}},\\ (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}},\\ (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}},\\ \\Delta\\mathrm{Var}_x^{\\mathrm{cen}},\\ \\Delta\\mathrm{Var}_x^{\\mathrm{up}},\\ (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}},\\ (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}}]$。将所有用例（按 A、B、C 的顺序）的结果连接成一个扁平列表。最终的打印输出必须是仅包含此单个列表的一行。", "solution": "该分析基于线性平流方程 $u_t + a u_x = 0$ 的半离散线方法，该方法为空间网格点产生了一个关于时间的常微分方程(ODE)，即 $\\frac{d u_j}{dt} = -a D u_j$。我们被告知要假设时间积分是精确的，这意味着所有误差都源于空间算子 $D$。数值格式的行为由其对单个傅里叶模态 $u_j(t) \\propto e^{i(k x_j - \\omega t)}$ 的影响来表征，其中 $x_j=j\\Delta x$。将此拟设代入半离散方程，可以求出复数值频率 $\\omega(k)$。我们记 $\\omega(k) = \\omega_{\\mathrm{num}}(k) - i\\gamma(k)$，其中 $\\omega_{\\mathrm{num}}(k)$ 是数值色散关系，$\\gamma(k)$ 是数值耗散率。非零的 $\\gamma(k)$ 会导致振幅按 $e^{-\\gamma(k)t}$ 的规律衰减。\n\n**1. 数值色散和耗散（任务1）**\n\n我们通过分析离散算子 $-aD$ 作用于特征函数 $e^{ikx_j}$ 时的特征值来找到 $\\omega(k)$。设 $\\kappa = k \\Delta x$。半离散方程为 $\\frac{d u_j}{dt} = -a D u_j$。代入拟设 $u_j(t) = \\hat{u}_k e^{i(k j \\Delta x - \\omega t)}$ 得到 $-i\\omega = \\lambda(k)$，其中 $\\lambda(k)$ 是算子 $-aD$ 的傅里叶符号，满足 $-a D e^{ikj\\Delta x} = \\lambda(k) e^{ikj\\Delta x}$。因此，$\\omega(k) = i \\lambda(k)$。\n\n**中心差分格式 ($D^0$)**：\n算子为 $D^0 u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$。其作用于 $e^{ikj\\Delta x}$ 的结果是：\n$$D^0 e^{ikj\\Delta x} = \\frac{e^{ik(j+1)\\Delta x} - e^{ik(j-1)\\Delta x}}{2\\Delta x} = \\frac{e^{i\\kappa} - e^{-i\\kappa}}{2\\Delta x} e^{ikj\\Delta x} = \\frac{2i\\sin(\\kappa)}{2\\Delta x} e^{ikj\\Delta x} = i\\frac{\\sin(k\\Delta x)}{\\Delta x} e^{ikj\\Delta x}$$\n$-aD^0$ 的特征值是 $\\lambda(k) = -a \\left(i\\frac{\\sin(k\\Delta x)}{\\Delta x}\\right)$。\n复频率为 $\\omega(k) = i\\lambda(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$。\n这是纯实数，因此对于中心格式：\n- 数值色散关系：$\\omega_{\\mathrm{num}}(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$\n- 耗散率：$\\gamma(k) = 0$\n群速度为 $v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk} = a \\cos(k\\Delta x)$。\n群速度色散（曲率）为 $\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2} = -a \\Delta x \\sin(k\\Delta x)$。\n\n**迎风差分格式 ($D^-$)**：\n对于 $a0$，算子为 $D^- u_j = \\frac{u_j - u_{j-1}}{\\Delta x}$。其作用为：\n$$D^- e^{ikj\\Delta x} = \\frac{e^{ikj\\Delta x} - e^{ik(j-1)\\Delta x}}{\\Delta x} = \\frac{1 - e^{-i\\kappa}}{\\Delta x} e^{ikj\\Delta x} = \\frac{1 - \\cos(\\kappa) + i\\sin(\\kappa)}{\\Delta x} e^{ikj\\Delta x}$$\n$-aD^-$ 的特征值是 $\\lambda(k) = -a \\frac{1 - \\cos(k\\Delta x) + i\\sin(k\\Delta x)}{\\Delta x}$。\n复频率为 $\\omega(k) = i\\lambda(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x} - i \\, a \\frac{1-\\cos(k\\Delta x)}{\\Delta x}$。\n根据 $\\omega = \\omega_{\\mathrm{num}} - i\\gamma$ 来确定实部和虚部：\n- 数值色散关系：$\\omega_{\\mathrm{num}}(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$\n- 耗散率：$\\gamma(k) = a \\frac{1-\\cos(k\\Delta x)}{\\Delta x}$\n色散特性与中心格式相同：\n- 群速度：$v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk} = a \\cos(k\\Delta x)$\n- 曲率：$\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2} = -a \\Delta x \\sin(k\\Delta x)$\n\n为分析耗散效应，我们需要迎风格式 $\\gamma(k)$ 的导数：\n- $\\gamma'(k) = \\frac{d\\gamma}{dk} = a \\Delta x \\sin(k\\Delta x)$\n- $\\gamma''(k) = \\frac{d^2\\gamma}{dk^2} = a (\\Delta x)^2 \\cos(k\\Delta x)$\n\n**2. 初始谱特性（任务5）**\n\n初始条件是 $u(x,0) = e^{-(x/\\sigma)^2} \\cos(k_0 x)$。傅里叶变换是 $\\hat{u}(k,0) = \\mathcal{F}\\{u(x,0)\\}$。\n利用 $\\cos(k_0 x) = \\frac{1}{2}(e^{ik_0 x} + e^{-ik_0 x})$ 和傅里叶变换性质 $\\mathcal{F}\\{f(x)e^{ik_0 x}\\} = \\hat{f}(k-k_0)$，我们发现 $\\hat{u}(k,0)$ 是两个以 $\\pm k_0$ 为中心的高斯函数的和。\n谱强度为 $|\\hat{u}(k,0)|^2$。对于窄带波包（大的 $\\sigma k_0$），交叉项可以忽略不计。$k_0$ 附近的强度与单个高斯项的平方成正比。\n$e^{-x^2/\\sigma^2}$ 的变换是 $\\sigma\\sqrt{\\pi} e^{-(k\\sigma)^2/4}$。因此，$k_0$ 附近谱振幅的轮廓是 $\\propto e^{-(k-k_0)^2\\sigma^2/4}$。\n于是谱强度为 $I(k,0) \\propto (e^{-(k-k_0)^2\\sigma^2/4})^2 = e^{-(k-k_0)^2\\sigma^2/2}$。\n我们将其建模为方差为 $s_k^2$ 的高斯分布，即 $I(k,0) \\propto e^{-\\frac{(k-k_0)^2}{2s_k^2(0)}}$。\n比较指数，$\\frac{(k-k_0)^2}{2s_k^2(0)} = \\frac{(k-k_0)^2\\sigma^2}{2}$，得到初始谱强度方差：\n$$s_k^2(0) = \\frac{1}{\\sigma^2}$$\n\n**3. 波包动力学与误差分析（任务2、3、4）**\n\n问题为窄带波包的演化提供了近似。我们将把它们与我们推导出的量一起使用。\n对于迎风格式，谱强度演化为 $|\\hat{u}(k,t)|^2 = |\\hat{u}(k,0)|^2 e^{-2\\gamma(k)t}$。将 $\\gamma(k)$ 在 $k_0$ 附近展开到二阶，并对高斯指数进行配方，可以证实给定的关于随时间演化的谱方差 $s_k^2(t)$ 和平均波数位移 $\\delta k(t)$ 的公式：\n- $s_k^2(t) = \\left(\\frac{1}{s_k^2(0)} + 2t\\gamma''(k_0)\\right)^{-1} = \\left(\\sigma^2 + 2ta(\\Delta x)^2 \\cos(k_0\\Delta x)\\right)^{-1}$\n- $\\delta k(t) = -2\\gamma'(k_0)t s_k^2(t) = -2 (a \\Delta x \\sin(k_0\\Delta x)) t s_k^2(t)$\n对于中心格式，$\\gamma(k)=0$，所以 $s_k^2(t) = s_k^2(0)$ 且 $\\delta k(t) = 0$。\n\n**质心漂移误差，$\\Delta x_c(T) = x_c(T) - aT$**：\n使用驻相近似 $x_c(t) \\approx v_g(k_0)t + \\beta_2(k_0)\\delta k(t)t$：\n$\\Delta x_c(t) \\approx (v_g(k_0) - a)t + \\beta_2(k_0)\\delta k(t)t$。第一项是色散误差，两种格式都存在。第二项是耗散误差，仅在迎风格式中存在。\n- 中心格式：$\\Delta x_c^{\\mathrm{cen}}(T) = (v_g(k_0) - a)T = a(\\cos(k_0\\Delta x)-1)T$。\n- 迎风格式：\n    - 色散分量：$(\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}} = a(\\cos(k_0\\Delta x)-1)T$。\n    - 耗散分量：$(\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}} = \\beta_2(k_0)\\delta k(T)T = (-a\\Delta x \\sin(k_0\\Delta x)) \\delta k(T) T$。\n    - 总计：$\\Delta x_c^{\\mathrm{up}}(T) = (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}} + (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}}$。\n\n**空间展宽增量，$\\Delta\\mathrm{Var}_x(T) = \\mathrm{Var}_x(T) - \\mathrm{Var}_x(0)$**：\n使用近似 $\\mathrm{Var}_x(t) \\approx \\frac{1}{4s_k^2(t)} + \\beta_2(k_0)^2 t^2 s_k^2(t)$ 以及 $\\mathrm{Var}_x(0) \\approx \\frac{1}{4s_k^2(0)}$：\n$\\Delta\\mathrm{Var}_x(t) \\approx \\left(\\frac{1}{4s_k^2(t)} - \\frac{1}{4s_k^2(0)}\\right) + \\beta_2(k_0)^2 t^2 s_k^2(t)$。第一项是耗散部分，第二项是色散部分。\n- 中心格式：$s_k^2(T) = s_k^2(0)$。耗散部分为零。\n    - $\\Delta\\mathrm{Var}_x^{\\mathrm{cen}}(T) = \\beta_2(k_0)^2 T^2 s_k^2(0) = (-a\\Delta x \\sin(k_0\\Delta x))^2 T^2 \\frac{1}{\\sigma^2}$。\n- 迎风格式：\n    - 色散分量：$(\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}} = \\beta_2(k_0)^2 T^2 s_k^2(T)$。\n    - 耗散分量：$(\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}} = \\frac{1}{4s_k^2(T)} - \\frac{1}{4s_k^2(0)} = \\frac{1}{4}(\\sigma^2 + 2T\\gamma''(k_0) - \\sigma^2) = \\frac{T}{2}\\gamma''(k_0) = \\frac{T}{2} a(\\Delta x)^2\\cos(k_0\\Delta x)$。\n    - 总计：$\\Delta\\mathrm{Var}_x^{\\mathrm{up}}(T) = (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}} + (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}}$。\n\n这些公式足以实现测试套件所需的计算。", "answer": "[-0.07449506663242041,-0.07638634882193568,-0.07449506663242041,-0.0018912821895152646,0.0016629904996459393,0.003923485575510619,0.001659092497645167,0.002264393077865452,-29.60881320326807,-30.09337583610996,-29.60881320326807,-0.4845626328418903,1169.589718423432,1184.629553752533,1169.589718423432,15.0398353291013,-1.821124237243939,-1.9721734994017688,-1.821124237243939,-0.15104926215782983,0.5843477138343753,0.7712170366472481,0.583547372174375,0.1876696644728731]", "id": "3425532"}]}