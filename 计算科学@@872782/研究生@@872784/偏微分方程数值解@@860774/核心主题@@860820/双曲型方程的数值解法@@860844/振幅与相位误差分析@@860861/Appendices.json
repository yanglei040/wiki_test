{"hands_on_practices": [{"introduction": "当我们将连续导数替换为有限差分近似时，这对波的表示有何影响？本练习深入探讨数值色散的核心概念。我们将运用傅里叶分析，为经典的二阶中心差分格式推导出其“有效数值波数”。这个量揭示了数值格式如何“感知”一个波，其与真实波数的偏差正是相误差的根源，这为理解和量化数值色散提供了最基本的工具。[@problem_id:3363559]", "problem": "考虑在均匀网格 $x_{j} = j\\,\\Delta x$（其中 $\\Delta x > 0$ 且 $j \\in \\mathbb{Z}$）上的线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数。空间导数 $u_{x}$ 由二阶中心差分算子近似：\n$$\n\\left(D_{0} u\\right)_{j} \\equiv \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\n假设一个离散傅里叶模式 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$，其中无量纲网格波数为 $\\theta \\in [-\\pi,\\pi]$。通过关系式 $D_{0} u_{j} = i\\,\\tilde{k}(\\theta)\\,u_{j}$ 定义有效数值波数 $\\tilde{k}(\\theta)$，因此精确波数为 $k = \\theta / \\Delta x$。使用此框架：\n- 推导与二阶中心差分相关的 $\\tilde{k}(\\theta)$ 的精确表达式。\n- 对 $\\tilde{k}(\\theta)$ 在 $\\theta = 0$ 附近进行关于 $\\theta$ 的泰勒展开，展开到并包括 $\\theta^{3}$ 阶项，并由此确定相对于 $k$ 的 $\\tilde{k}(\\theta)$ 的主导色散项。\n\n将 $\\tilde{k}(\\theta)$ 截断至并包括 $\\theta^{3}$ 项的级数作为最终答案。无需四舍五入。将答案表示为 $\\theta$ 和 $\\Delta x$ 的函数，不带单位。角度以弧度为单位。", "solution": "本题要求推导用于空间导数 $u_x$ 的二阶中心差分近似的有效数值波数 $\\tilde{k}(\\theta)$，并随后进行泰勒级数展开。\n\n首先，我们推导 $\\tilde{k}(\\theta)$ 的表达式。题目指出，平流方程 $u_t + a u_x = 0$ 中的空间导数 $u_x$ 由二阶中心差分算子 $(D_0 u)_j$ 近似，其定义为：\n$$\n(D_0 u)_j = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}\n$$\n我们分析此算子对单个离散傅里叶模式 $u_j(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$ 的作用。这里，$j$ 是网格索引，$\\theta$ 是无量纲网格波数，$i = \\sqrt{-1}$，而 $\\hat{u}(t)$ 是该模式随时间变化的振幅。\n\n将 $u_j$ 的傅里叶模式表达式代入差分算子公式，我们得到：\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,(j+1)\\,\\theta) - \\hat{u}(t)\\,\\exp(i\\,(j-1)\\,\\theta)}{2\\,\\Delta x}\n$$\n我们可以提出公因式 $\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$，它等于 $u_j(t)$：\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta) \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right)}{2\\,\\Delta x} = u_j(t) \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x}\n$$\n使用欧拉公式 $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$，我们可以将分子中的项重写为 $2i\\,\\sin(\\theta)$。将其代回得到：\n$$\n(D_0 u)_j = u_j(t) \\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j(t)\n$$\n题目通过关系式 $D_0 u_j = i\\,\\tilde{k}(\\theta)\\,u_j$ 定义了有效数值波数 $\\tilde{k}(\\theta)$。通过将此定义与我们刚推导出的结果进行比较，我们可以确定 $\\tilde{k}(\\theta)$ 的表达式：\n$$\ni\\,\\tilde{k}(\\theta)\\,u_j = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j\n$$\n这直接给出了二阶中心差分格式的数值波数的精确表达式：\n$$\n\\tilde{k}(\\theta) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n接下来，我们对 $\\tilde{k}(\\theta)$ 在 $\\theta=0$ 附近进行关于 $\\theta$ 的幂次泰勒展开。正弦函数的麦克劳林级数为：\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots = \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5)\n$$\n将此级数代入我们关于 $\\tilde{k}(\\theta)$ 的表达式中：\n$$\n\\tilde{k}(\\theta) = \\frac{1}{\\Delta x} \\left( \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5) \\right)\n$$\n将此展开式截断至并包括 $\\theta^3$ 阶项，我们得到：\n$$\n\\tilde{k}(\\theta) \\approx \\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}\n$$\n对于连续傅里叶模式 $\\exp(ikx)$，其精确波数为 $k$。对于离散模式，对应关系为 $k = \\theta/\\Delta x$。展开式的第一项 $\\frac{\\theta}{\\Delta x}$，与真实波数 $k$ 完全匹配。第二项 $-\\frac{\\theta^3}{6\\,\\Delta x}$ 是主阶误差项。此项是造成数值色散的原因，因为它导致波的传播速度依赖于波数。推导完成。", "answer": "$$ \\boxed{\\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}} $$", "id": "3363559"}, {"introduction": "我们在前一个练习中量化的色散误差会带来实际且通常不希望出现的后果。本练习将探讨纯色散格式（如中心差分）最著名的陷阱之一。通过推导数值相速度，我们将看到高频波（波长接近网格间距的波）的传播效果很差，其相速度甚至可能趋近于零。这一分析解释了在模拟激波或尖锐锋面时，数值解中为何会出现非物理的寄生振荡，为理解为何简单的中心差分格式通常不适用于此类问题提供了清晰的理论依据。[@problem_id:3363508]", "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中波速 $a > 0$ 为常数。设空间域在均匀网格 $x_{j} = j\\,\\Delta x$ 上离散化，其中网格指数 $j \\in \\mathbb{Z}$，网格间距 $\\Delta x > 0$。使用二阶中心差分离散化空间导数，得到半离散格式为\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0.\n$$\n假设对该半离散系统进行精确时间积分，以使该格式不引入数值耗散。通过寻找形式为 $u_{j}(t) = \\hat{u}\\,\\exp\\!\\left(i\\,(j\\,\\theta - \\omega\\,t)\\right)$ 的解，进行离散傅里叶（von Neumann）分析，其中 $\\hat{u} \\in \\mathbb{C}$ 是恒定振幅，$\\theta \\in [0,\\pi]$ 是以弧度为单位的无量纲波数，$\\omega \\in \\mathbb{R}$ 是角频率。\n\n从这些定义和半离散格式出发，推导色散关系，并由此得到数值相速度 $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$ 关于 $a$ 和 $\\theta$ 的闭式解析表达式，其中 $k = \\theta/\\Delta x$ 是物理波数。然后，使用你的表达式解释为什么 $\\theta$ 接近 $\\pi$ 的模态是严重欠解析的，并表现出接近于零的数值相速度，并讨论在产生高波数内容的激波捕捉情境下，这种行为的物理含义。\n\n你的最终答案必须是 $v_{p}^{\\mathrm{num}}(\\theta)$ 关于 $a$ 和 $\\theta$（其中 $\\theta$ 以弧度为单位）的单个闭式表达式。不需要进行数值舍入。请在你的解中提供定性讨论，但确保最终方框内的答案只包含所要求的解析表达式。", "solution": "半离散格式由下式给出：\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0\n$$\n我们将模态解 $u_{j}(t) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))$ 代入格式中，进行离散傅里叶分析。首先，我们计算必要的项。时间导数为：\n$$\n\\frac{d u_{j}(t)}{d t} = \\frac{d}{dt} \\left[ \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) \\right] = -i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) = -i\\,\\omega\\,u_{j}(t)\n$$\n空间平移项为：\n$$\nu_{j+1}(t) = \\hat{u}\\,\\exp(i\\,((j+1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(i\\,\\theta) = u_{j}(t)\\,\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}(t) = \\hat{u}\\,\\exp(i\\,((j-1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(-i\\,\\theta) = u_{j}(t)\\,\\exp(-i\\,\\theta)\n$$\n将这些表达式代入半离散方程，得到：\n$$\n-i\\,\\omega\\,u_{j}(t) + a\\,\\frac{u_{j}(t)\\,\\exp(i\\,\\theta) - u_{j}(t)\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n对于非平凡解，我们要求 $u_{j}(t) \\neq 0$，因此我们可以将整个方程除以 $u_{j}(t)$：\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right) = 0\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$，我们可以将括号中的项重写为 $2i\\,\\sin(\\theta)$。方程变为：\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} (2i\\,\\sin(\\theta)) = 0\n$$\n$$\n-i\\,\\omega + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\n求解数值频率 $\\omega$ 可得到半离散格式的色散关系：\n$$\n\\omega = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\n问题将数值相速度定义为 $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$，其中物理波数为 $k = \\theta/\\Delta x$。代入 $\\omega$ 和 $k$ 的表达式：\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = \\frac{\\omega}{k} = \\frac{\\frac{a\\,\\sin(\\theta)}{\\Delta x}}{\\frac{\\theta}{\\Delta x}}\n$$\n通过消去 $\\Delta x$ 项来简化此表达式，得到数值相速度的最终闭式表达式：\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = a\\,\\frac{\\sin(\\theta)}{\\theta}\n$$\n对于精确的偏微分方程 $u_t + a u_x = 0$，所有波数的精确相速度均为 $a$。因子 $\\frac{\\sin(\\theta)}{\\theta}$ 代表了数值相位误差。\n\n我们现在分析 $\\theta$ 接近 $\\pi$ 的模态的行为。无量纲波数 $\\theta = k\\,\\Delta x = \\frac{2\\pi \\Delta x}{\\lambda}$，其中 $\\lambda$ 是波长。范围 $\\theta \\in [0, \\pi]$ 对应于波长 $\\lambda \\in [2\\Delta x, \\infty)$。因此，$\\theta = \\pi$ 对应于网格上可分辨的最短波长 $\\lambda = 2\\Delta x$，这被称为 $2\\Delta x$ 波。\n\n当 $\\theta$ 趋近于 $\\pi$ 时，数值相速度的行为如下：\n$$\n\\lim_{\\theta \\to \\pi} v_{p}^{\\mathrm{num}}(\\theta) = \\lim_{\\theta \\to \\pi} a\\,\\frac{\\sin(\\theta)}{\\theta} = a\\,\\frac{\\sin(\\pi)}{\\pi} = a\\,\\frac{0}{\\pi} = 0\n$$\n这个结果表明，波数在网格截止频率（$\\theta = \\pi$）处或附近的模态，其数值相速度趋近于零。因此，这些高频分量被二阶中心差分格式严重欠解析；它们几乎变为静止，并且不以正确的速度 $a$ 传播。\n\n在激波捕捉的情境中，这种行为的物理含义尤其严重。激波和其他间断的特征是具有宽广的傅里叶模态谱，包括非常高波数的内容。当计算的解中存在这些特征时：\n$1$. 由陡峭梯度产生的高波数分量不能被该格式正确地传播。它们的移动速度远低于主波前。\n$2$. 这种传播速度上的差异导致这些高频分量滞后于激波，表现为伪的、非物理的振荡，通常被称为“扭动”或 Gibbs 现象。\n$3$. 由于该格式是纯色散的，并且不引入数值耗散（根据问题关于精确时间积分的假设），这些伪模态中的能量不会被衰减。相反，它会污染求解域，降低模拟的准确性和物理真实性。这就是为什么简单的中心差分格式不足以模拟带激波问题的主要原因，除非它们通过人工耗散或专门设计用来控制或消除高频振荡的滤波技术来增强。", "answer": "$$\\boxed{a\\,\\frac{\\sin(\\theta)}{\\theta}}$$", "id": "3363508"}, {"introduction": "到目前为止，我们都是通过已知的格式公式来分析其误差。但如果我们想验证一个复杂代码或一个未知求解器的属性，该怎么办？本练习将引入一种强大的实验性方法。我们将把数值模拟的输出建模为一个含噪声的时间序列，并利用最小二乘法来估计其底层的复数放大因子，从而将误差分析问题转化为一个统计推断问题。该技术提供了一种从任何线性单步格式的输出中直接测量其振幅和相误差的实用方法，这对于验证数值代码和理解其在实际应用中的行为至关重要。[@problem_id:3363550]", "problem": "考虑一个线性常系数偏微分方程（PDE），该方程在空间上进行了半离散化，并采用单步线性方法在时间上推进。根据线性时间步进格式的傅里叶分析，每个空间傅里叶模式 $e^{\\mathrm{i} \\kappa x}$ 独立演化，其复傅里叶系数 $\\tilde{u}(\\kappa, t)$ 在每个时间步长乘以一个复放大因子 $G(\\theta)$，其中 $\\theta = \\kappa \\Delta x$，$\\Delta x$ 是空间网格间距。设 $\\{a_{n}\\}_{n=0}^{N}$ 表示从一个初始模式振幅 $a_{0} \\neq 0$ 的数值实验中，在离散时间 $t_{n} = n \\Delta t$（其中 $\\Delta t$ 是时间步长）提取的单模傅里叶系数的复数时间历史。为了对提取过程中的投影和测量不确定性进行建模，假设模式历史的观测模型如下：\n$$\na_{n+1} = G(\\theta) \\, a_{n} + \\eta_{n}, \\quad n = 0,1,\\dots,N-1,\n$$\n其中 $\\{\\eta_{n}\\}$ 是独立同分布的圆复高斯随机变量，均值为零，方差为 $\\sigma^{2}$，定义为 $\\mathbb{E}[\\eta_{n}] = 0$，$\\mathbb{E}[\\eta_{n} \\eta_{m}^{*}] = \\sigma^{2} \\delta_{nm}$，以及 $\\mathbb{E}[\\eta_{n} \\eta_{m}] = 0$。此处，${}^{*}$ 表示复共轭，$\\delta_{nm}$ 是克罗内克（Kronecker）δ函数。\n\n从线性格式中傅里叶模式放大的定义和给定的统计模型出发，根据第一性原理推导：\n1. 基于观测序列 $\\{a_{n}\\}$ 的复放大因子 $G(\\theta)$ 的最小二乘估计量 $\\widehat{G}(\\theta)$。\n2. 放大因子的振幅和相位的闭式估计量 $\\widehat{r} = |\\widehat{G}(\\theta)|$ 和 $\\widehat{\\phi} = \\arg(\\widehat{G}(\\theta))$，其中 $\\arg(\\cdot)$ 表示以弧度为单位的主辐角。\n3. $\\widehat{r}$ 和 $\\widehat{\\phi}$ 的渐近双侧 $(1 - \\alpha)$ 置信界，表示为半宽度 $\\Delta_{r}$ 和 $\\Delta_{\\phi}$，并用 $\\{a_{n}\\}$、$\\sigma^{2}$ 和 $\\alpha \\in (0,1)$ 表示，其假设条件为 $\\sum_{n=0}^{N-1} |a_{n}|^{2} > 0$。\n\n您的推导必须从以下基本事实开始：线性单步格式允许存在傅里叶模式放大因子，且最小二乘估计最小化残差平方和。推导过程必须在给定的圆复高斯噪声模型下，对估计量进行严格的统计分析。最终答案必须是 $\\widehat{r}$、$\\widehat{\\phi}$、$\\Delta_{r}$ 和 $\\Delta_{\\phi}$ 的显式解析表达式，用观测数据 $\\{a_{n}\\}$、噪声方差 $\\sigma^{2}$ 和置信水平参数 $\\alpha$ 来表示。角度必须以弧度表示。无需四舍五入。", "solution": "问题要求根据模型 $a_{n+1} = G(\\theta) a_n + \\eta_n$ 控制的时间序列 $\\{a_n\\}$，求出复放大因子 $G(\\theta)$ 的振幅和相位的估计量，以及这些估计量的置信界。为简化符号，我们将复放大因子记为 $G$，其估计量记为 $\\widehat{G}$。\n\n### 第1部分：最小二乘估计量 $\\widehat{G}$\n最小二乘法旨在找到使残差的模平方和最小化的 $G$ 值。残差是噪声项 $\\eta_n = a_{n+1} - G a_n$。残差平方和 $S(G)$ 由下式给出：\n$$\nS(G) = \\sum_{n=0}^{N-1} |\\eta_n|^2 = \\sum_{n=0}^{N-1} |a_{n+1} - G a_n|^2\n$$\n我们可以将模的平方 $|z|^2$ 表示为 $z z^*$，其中 $z^*$ 是 $z$ 的复共轭。\n$$\nS(G, G^*) = \\sum_{n=0}^{N-1} (a_{n+1} - G a_n)(a_{n+1}^* - G^* a_n^*)\n$$\n展开乘积可得：\n$$\nS(G, G^*) = \\sum_{n=0}^{N-1} \\left( |a_{n+1}|^2 - G^* a_n^* a_{n+1} - G a_n a_{n+1}^* + |G|^2 |a_n|^2 \\right)\n$$\n为了求最小值，我们使用 Wirtinger 演算，将 $S$ 对 $G^*$ 的偏导数设为零，同时将 $G$ 视为常数。\n$$\n\\frac{\\partial S}{\\partial G^*} = \\sum_{n=0}^{N-1} \\left( -a_n^* a_{n+1} + G |a_n|^2 \\right)\n$$\n将此导数设为零可得到估计量 $\\widehat{G}$：\n$$\n\\sum_{n=0}^{N-1} \\left( -a_n^* a_{n+1} + \\widehat{G} |a_n|^2 \\right) = 0\n$$\n$$\n\\widehat{G} \\sum_{n=0}^{N-1} |a_n|^2 = \\sum_{n=0}^{N-1} a_{n+1} a_n^*\n$$\n解出 $\\widehat{G}$，我们得到最小二乘估计量。该估计量的存在性由问题假设 $\\sum_{n=0}^{N-1} |a_n|^2 > 0$ 保证。\n$$\n\\widehat{G} = \\frac{\\sum_{n=0}^{N-1} a_{n+1} a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2}\n$$\n\n### 第2部分：振幅 $\\widehat{r}$ 和相位 $\\widehat{\\phi}$ 的估计量\n复数 $G$ 的振幅 $r$ 和相位 $\\phi$ 由 $G = r e^{\\mathrm{i}\\phi}$ 定义，其中 $r = |G|$ 且 $\\phi = \\arg(G)$。$r$ 和 $\\phi$ 的估计量是通过将这些定义应用于估计量 $\\widehat{G}$ 得到的。\n\n振幅的估计量 $\\widehat{r}$ 是：\n$$\n\\widehat{r} = |\\widehat{G}| = \\left| \\frac{\\sum_{n=0}^{N-1} a_{n+1} a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2} \\right| = \\frac{\\left| \\sum_{n=0}^{N-1} a_{n+1} a_n^* \\right|}{\\sum_{n=0}^{N-1} |a_n|^2}\n$$\n相位的估计量 $\\widehat{\\phi}$ 是：\n$$\n\\widehat{\\phi} = \\arg(\\widehat{G}) = \\arg\\left( \\frac{\\sum_{n=0}^{N-1} a_{n+1} a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2} \\right)\n$$\n由于分母 $\\sum_{n=0}^{N-1} |a_n|^2$ 是一个正实数，它不影响复数分数的辐角。因此，相位估计量简化为：\n$$\n\\widehat{\\phi} = \\arg\\left( \\sum_{n=0}^{N-1} a_{n+1} a_n^* \\right)\n$$\n\n### 第3部分：渐近置信界\n为了推导置信界，我们必须首先确定我们的估计量 $\\widehat{G}$ 的统计分布。我们来分析估计误差 $\\mathcal{E} = \\widehat{G} - G$。\n$$\n\\widehat{G} = \\frac{\\sum_{n=0}^{N-1} (G a_n + \\eta_n) a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2} = \\frac{G \\sum_{n=0}^{N-1} |a_n|^2 + \\sum_{n=0}^{N-1} \\eta_n a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2} = G + \\frac{\\sum_{n=0}^{N-1} \\eta_n a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2}\n$$\n因此，误差为 $\\mathcal{E} = \\widehat{G} - G = \\frac{\\sum_{n=0}^{N-1} \\eta_n a_n^*}{\\sum_{n=0}^{N-1} |a_n|^2}$。\n为了推导渐近性质，我们将序列 $\\{a_n\\}$ 视为一组确定性的回归量。误差 $\\mathcal{E}$ 是独立同分布（i.i.d.）圆复高斯随机变量 $\\{\\eta_n\\}$ 的线性组合。因此，$\\mathcal{E}$ 也是一个圆复高斯随机变量。其统计特性如下：\n均值：$\\mathbb{E}[\\mathcal{E}] = \\mathbb{E}\\left[ \\frac{\\sum \\eta_n a_n^*}{\\sum |a_n|^2} \\right] = \\frac{\\sum \\mathbb{E}[\\eta_n] a_n^*}{\\sum |a_n|^2} = 0$。这表明 $\\widehat{G}$ 是一个无偏估计量。\n方差：$\\text{Var}(\\mathcal{E}) = \\mathbb{E}[|\\mathcal{E}|^2] = \\mathbb{E}\\left[ \\left(\\frac{\\sum_n \\eta_n a_n^*}{\\sum_k |a_k|^2}\\right) \\left(\\frac{\\sum_m \\eta_m a_m^*}{\\sum_l |a_l|^2}\\right)^* \\right] = \\frac{1}{(\\sum_k |a_k|^2)^2} \\sum_{n,m} a_n^* a_m \\mathbb{E}[\\eta_n \\eta_m^*]$。\n使用 $\\mathbb{E}[\\eta_n \\eta_m^*] = \\sigma^2 \\delta_{nm}$：\n$$\n\\text{Var}(\\mathcal{E}) = \\frac{\\sigma^2}{(\\sum_k |a_k|^2)^2} \\sum_{n} a_n^* a_n = \\frac{\\sigma^2 \\sum_n |a_n|^2}{(\\sum_k |a_k|^2)^2} = \\frac{\\sigma^2}{\\sum_{n=0}^{N-1} |a_n|^2}\n$$\n设 $\\mathcal{E} = \\mathcal{E}_R + \\mathrm{i} \\mathcal{E}_I$。对于一个圆复高斯变量，$\\mathcal{E}_R$ 和 $\\mathcal{E}_I$ 是独立的、零均值的正态随机变量，其方差相等，为 $\\sigma_g^2 = \\frac{1}{2}\\text{Var}(\\mathcal{E})$。\n$$\n\\sigma_g^2 = \\text{Var}(\\mathcal{E}_R) = \\text{Var}(\\mathcal{E}_I) = \\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}\n$$\n估计量 $\\widehat{G} = \\widehat{G}_R + \\mathrm{i} \\widehat{G}_I$ 的分量近似服从正态分布：$\\widehat{G}_R \\sim \\mathcal{N}(G_R, \\sigma_g^2)$ 和 $\\widehat{G}_I \\sim \\mathcal{N}(G_I, \\sigma_g^2)$。\n\n为了求出 $\\widehat{r}$ 和 $\\widehat{\\phi}$ 的方差，我们使用多元 Delta 方法进行不确定性传播。渐近方差由下式给出：\n$$\n\\text{Var}(\\widehat{r}) \\approx \\left(\\frac{\\partial r}{\\partial G_R}\\right)^2 \\sigma_g^2 + \\left(\\frac{\\partial r}{\\partial G_I}\\right)^2 \\sigma_g^2\n\\quad \\text{和} \\quad\n\\text{Var}(\\widehat{\\phi}) \\approx \\left(\\frac{\\partial \\phi}{\\partial G_R}\\right)^2 \\sigma_g^2 + \\left(\\frac{\\partial \\phi}{\\partial G_I}\\right)^2 \\sigma_g^2\n$$\n偏导数是：$\\frac{\\partial r}{\\partial G_R} = \\cos(\\phi)$，$\\frac{\\partial r}{\\partial G_I} = \\sin(\\phi)$，$\\frac{\\partial \\phi}{\\partial G_R} = -\\frac{\\sin(\\phi)}{r}$，$\\frac{\\partial \\phi}{\\partial G_I} = \\frac{\\cos(\\phi)}{r}$。\n代入这些可得：\n$$\n\\text{Var}(\\widehat{r}) \\approx (\\cos^2\\phi + \\sin^2\\phi)\\sigma_g^2 = \\sigma_g^2 = \\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}\n$$\n$$\n\\text{Var}(\\widehat{\\phi}) \\approx \\left(\\frac{\\sin^2\\phi}{r^2} + \\frac{\\cos^2\\phi}{r^2}\\right)\\sigma_g^2 = \\frac{\\sigma_g^2}{r^2} = \\frac{\\sigma^2}{2 r^2 \\sum_{n=0}^{N-1} |a_n|^2}\n$$\n渐近地，$\\widehat{r}$ 和 $\\widehat{\\phi}$ 服从正态分布。我们通过用估计值替换真实参数来构建置信区间。\n$$\n\\widehat{r} \\sim \\mathcal{N}\\left(r, \\frac{\\sigma^2}{2 \\sum |a_n|^2}\\right) \\quad \\text{和} \\quad \\widehat{\\phi} \\sim \\mathcal{N}\\left(\\phi, \\frac{\\sigma^2}{2 \\widehat{r}^2 \\sum |a_n|^2}\\right)\n$$\n一个双侧 $(1-\\alpha)$ 置信区间由 $\\text{估计值} \\pm \\text{半宽度}$ 给出。半宽度是 $z_{\\alpha/2} \\times (\\text{标准差})$，其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 临界值，满足当 $Z \\sim \\mathcal{N}(0,1)$ 时 $\\mathbb{P}(Z > z_{\\alpha/2}) = \\alpha/2$。\n\n振幅的半宽度 $\\Delta_r$ 是：\n$$\n\\Delta_r = z_{\\alpha/2} \\sqrt{\\text{Var}(\\widehat{r})} = z_{\\alpha/2} \\sqrt{\\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}}\n$$\n相位的半宽度 $\\Delta_\\phi$ 是：\n$$\n\\Delta_\\phi = z_{\\alpha/2} \\sqrt{\\frac{\\sigma^2}{2 \\widehat{r}^2 \\sum_{n=0}^{N-1} |a_n|^2}} = \\frac{z_{\\alpha/2}}{\\widehat{r}} \\sqrt{\\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}}\n$$\n代入 $\\widehat{r}$ 的表达式：\n$$\n\\Delta_\\phi = z_{\\alpha/2} \\frac{\\sum_{n=0}^{N-1} |a_n|^2}{|\\sum_{n=0}^{N-1} a_{n+1} a_n^*|} \\sqrt{\\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}} = z_{\\alpha/2} \\frac{\\sqrt{\\sigma^2 \\sum_{n=0}^{N-1} |a_n|^2}}{\\sqrt{2} |\\sum_{n=0}^{N-1} a_{n+1} a_n^*|}\n$$\n\n$\\widehat{r}$、$\\widehat{\\phi}$、$\\Delta_r$ 和 $\\Delta_\\phi$ 的表达式汇总在最终答案中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\left| \\sum_{n=0}^{N-1} a_{n+1} a_n^* \\right|}{\\sum_{n=0}^{N-1} |a_n|^2}  \\arg\\left( \\sum_{n=0}^{N-1} a_{n+1} a_n^* \\right)  z_{\\alpha/2} \\sqrt{\\frac{\\sigma^2}{2 \\sum_{n=0}^{N-1} |a_n|^2}}  z_{\\alpha/2} \\frac{\\sqrt{\\sigma^2 \\sum_{n=0}^{N-1} |a_n|^2}}{\\sqrt{2} \\left| \\sum_{n=0}^{N-1} a_{n+1} a_n^* \\right|}\n\\end{pmatrix}\n}\n$$", "id": "3363550"}]}