{"hands_on_practices": [{"introduction": "我们的第一个练习是基础性的。我们将使用冯·诺依曼稳定性分析来推导前向时间中心空间（FTCS）格式的放大因子。我们的目标是确定在给定柯朗数 $C$ 下最坏情况的增长率，然后找到“最佳”（或“最不不稳定”）的柯朗数，这将揭示该方法的一个根本性缺陷。[@problem_id:3409110]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度为常数 $a \\neq 0$。在均匀空间网格 $x_{j} = j\\,\\Delta x$ 和离散时间 $t^{n} = n\\,\\Delta t$ 上进行离散化，用前向差分近似 $u_{t}$，用中心差分近似 $u_{x}$（即前向时间中心空间格式）。将库朗数记为 $C = a\\,\\Delta t/\\Delta x$。使用 von Neumann 傅里叶模态分析，其中波角 $\\theta \\in [-\\pi,\\pi]$，定义模态放大因子 $G(\\theta)$ 和模态振幅增长率 $|G(\\theta)|$。对于给定的 $C$，将最坏情况下的增长率定义为 $\\max_{\\theta \\in [-\\pi,\\pi]} |G(\\theta)|$。\n\n你的任务是：\n1. 从离散格式和傅里叶模态 ansatz 出发，推导出用 $C$ 和 $\\theta$ 表示的 $G(\\theta)$ 和 $|G(\\theta)|$。\n2. 求解“最不稳定的库朗数”问题：找到使 $\\max_{\\theta} |G(\\theta)|$ 最小化的 $C^{\\ast}$ 值，并确定达到此最坏情况增长率时的波角 $\\theta^{\\ast}$，以及最小化的最坏情况增长率的值。\n3. 根据你的表达式解释，为什么对于任何 $C  0$，即使是最优的 $C^{\\ast}$ 也无法在 von Neumann 意义上得到一个稳定的方法。\n\n将你的最终结果以单行形式列出 $\\bigl(C^{\\ast},\\,\\theta^{\\ast},\\,\\min_{C}\\max_{\\theta}|G(\\theta)|\\bigr)$，其中角度必须以弧度表示。不需要进行数值舍入；请给出精确表达式。", "solution": "该问题要求对一维线性平流方程的前向时间中心空间 (FTCS) 格式进行稳定性分析。分析将按要求分三部分进行：首先，推导放大因子；其次，求解优化问题以找到“最不稳定的库朗数”；第三，解释该格式的无条件不稳定性。\n\n线性平流方程为\n$$\nu_t + a u_x = 0\n$$\n其中 $a \\neq 0$ 是一个常数平流速度。我们在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上离散化此方程，并将 $u(x_j, t^n)$ 的数值近似记为 $u_j^n$。\n\nFTCS 格式对时间导数使用前向差分，对空间导数使用中心差分：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} = 0\n$$\n整理以求解下一个时间步的解 $u_j^{n+1}$，可得：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2 \\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\n引入库朗数 $C = \\frac{a \\Delta t}{\\Delta x}$，该格式变为：\n$$\nu_j^{n+1} = u_j^n - \\frac{C}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\n\n**1. 推导放大因子 $G(\\theta)$ 及其模 $|G(\\theta)|$**\n\n为了进行 von Neumann 稳定性分析，我们考虑一个单一的傅里叶模态解：\n$$\nu_j^n = (G(\\theta))^n e^{i k x_j}\n$$\n其中 $k$ 是波数，$G(\\theta)$ 是该模态在每个时间步长内的放大因子。相角定义为 $\\theta = k \\Delta x$。代入 $x_j = j \\Delta x$，ansatz 变为：\n$$\nu_j^n = G^n e^{i j \\theta}\n$$\n我们将此 ansatz 代入离散方程中。各项变为：\n$u_j^{n+1} = G^{n+1} e^{i j \\theta}$\n$u_j^n = G^n e^{i j \\theta}$\n$u_{j+1}^n = G^n e^{i (j+1) \\theta} = G^n e^{i j \\theta} e^{i \\theta}$\n$u_{j-1}^n = G^n e^{i (j-1) \\theta} = G^n e^{i j \\theta} e^{-i \\theta}$\n\n将这些代入格式中：\n$$\nG^{n+1} e^{i j \\theta} = G^n e^{i j \\theta} - \\frac{C}{2} (G^n e^{i j \\theta} e^{i \\theta} - G^n e^{i j \\theta} e^{-i \\theta})\n$$\n除以公因子 $G^n e^{i j \\theta}$（非零），我们得到放大因子 $G = G(\\theta)$ 的表达式：\n$$\nG = 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta})\n$$\n使用欧拉恒等式 $e^{i \\theta} - e^{-i \\theta} = 2i \\sin(\\theta)$，我们简化 $G$：\n$$\nG(\\theta) = 1 - \\frac{C}{2} (2i \\sin(\\theta)) = 1 - i C \\sin(\\theta)\n$$\n这就是 FTCS 格式的放大因子。\n\n接下来，我们求其模 $|G(\\theta)|$。放大因子是一个复数，其实部为 $1$，虚部为 $-C \\sin(\\theta)$。其模由下式给出：\n$$\n|G(\\theta)| = \\sqrt{(\\text{Re}(G))^2 + (\\text{Im}(G))^2} = \\sqrt{1^2 + (-C \\sin(\\theta))^2}\n$$\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}\n$$\n\n**2. “最不稳定的库朗数”问题**\n\n任务是找到使最坏情况增长率 $\\max_{\\theta} |G(\\theta)|$ 最小化的库朗数 $C^{\\ast}$。我们定义函数 $F(C) = \\max_{\\theta \\in [-\\pi,\\pi]} |G(\\theta)|$。\n首先，对于一个固定的库朗数 $C$，我们找到 $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$ 在所有波角 $\\theta \\in [-\\pi, \\pi]$ 上的最大值。当项 $\\sin^2(\\theta)$ 最大化时， $|G(\\theta)|$ 的值也最大化。$\\sin^2(\\theta)$ 的最大值是 $1$，这发生在 $\\theta = \\pm \\frac{\\pi}{2}$ 时。\n因此，对于给定的 $C$，最坏情况下的增长率为：\n$$\nF(C) = \\max_{\\theta} |G(\\theta)| = \\sqrt{1 + C^2 (1)} = \\sqrt{1 + C^2}\n$$\n对于任何 $C \\ne 0$，这个最大增长都发生在波角 $\\theta^{\\ast}(C) = \\pm \\frac{\\pi}{2}$ 处。\n\n接下来，我们必须找到使这个最坏情况增长函数 $F(C) = \\sqrt{1 + C^2}$ 最小化的 $C^{\\ast}$ 值。库朗数 $C = a \\Delta t / \\Delta x$ 是一个实数。由于 $a \\ne 0$，通过选择 $\\Delta t > 0$ 可以使 $C$ 非零。函数 $F(C)$ 依赖于 $C^2$，因此它在 $C \\in \\mathbb{R}$ 上的最小值在 $C^2$ 最小时出现。$C^2$ 的最小值是 $0$，这发生在 $C=0$ 时。\n因此，使最坏情况增长率最小化的库朗数值是：\n$$\nC^{\\ast} = 0\n$$\n最小化的最坏情况增长率的值通过计算 $F(C)$ 在 $C^{\\ast}=0$ 处的值得到：\n$$\n\\min_{C} \\max_{\\theta} |G(\\theta)| = F(C^{\\ast}) = F(0) = \\sqrt{1 + 0^2} = 1\n$$\n最后，我们必须确定达到这个最小化的最坏情况增长率时的波角 $\\theta^{\\ast}$。在 $C^{\\ast}=0$ 时，对于所有的 $\\theta$，放大因子都是 $G(\\theta) = 1$。因此，对于所有 $\\theta \\in [-\\pi, \\pi]$，都达到了 $1$ 的最大增长率。这带来了一个模糊性。然而，我们可以通过考虑 $C \\to C^{\\ast} = 0$ 的极限来解决这个问题。对于任何 $C \\neq 0$，最坏情况的增长率都明确地发生在 $\\theta = \\pm \\frac{\\pi}{2}$ 处。对于任何非零的时间步长（无论多小），这些模态都是最不稳定的。因此，将它们确定为临界波角是合乎逻辑的。我们选择一个代表值：\n$$\n\\theta^{\\ast} = \\frac{\\pi}{2}\n$$\n因此，三元组 $(C^{\\ast}, \\theta^{\\ast}, \\min_{C}\\max_{\\theta}|G(\\theta)|)$ 是 $(0, \\frac{\\pi}{2}, 1)$。\n\n**3. 对于 $C  0$ 的无条件不稳定性**\n\nvon Neumann 稳定性判据要求放大因子的模对于所有可能的波角 $\\theta$ 都小于或等于 $1$。也就是说，一个格式要稳定，必须满足：\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n根据我们的推导，我们有 $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$。稳定性条件变为：\n$$\n\\sqrt{1 + C^2 \\sin^2(\\theta)} \\le 1\n$$\n两边平方（由于两边均为非负，此操作是允许的），得到：\n$$\n1 + C^2 \\sin^2(\\theta) \\le 1\n$$\n这可以简化为 $C^2 \\sin^2(\\theta) \\le 0$。由于 $C^2 \\ge 0$ 和 $\\sin^2(\\theta) \\ge 0$，这个不等式只有在 $C^2 \\sin^2(\\theta) = 0$ 时才能满足。这意味着对于每个 $\\theta$，要么 $C=0$，要么 $\\sin(\\theta)=0$。\n为了使格式稳定，该条件必须对*所有* $\\theta$ 都成立。如果我们选择任意 $C  0$（由于 $a \\ne 0$，这对应于任意非零的时间步长），我们总能找到一个波角 $\\theta$ 使得 $\\sin(\\theta) \\ne 0$。一个典型的例子是 $\\theta = \\pi/2$，此时 $\\sin^2(\\pi/2)=1$。对于这个模态，放大因子的模为：\n$$\n|G(\\pi/2)| = \\sqrt{1 + C^2}  1\n$$\n由于对于任何 $C0$，都存在至少一个被放大的模态，因此该格式不满足 von Neumann 稳定性判据。实现稳定性的唯一情况是 $C=0$，这对应于 $\\Delta t = 0$。这是没有时间演化的平凡情况。因此，对于任何有意义的时间步长选择，FTCS 格式对于线性平流方程都是无条件不稳定的。即使是“最优”情况 $C^*=0$ 也仅仅对应于这个平凡的、不向前推进的解。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\frac{\\pi}{2}  1 \\end{pmatrix}}\n$$", "id": "3409110"}, {"introduction": "尽管前面的分析表明 FTCS 格式通常是不稳定的，但并非所有的傅里叶模式都会增长。本练习将聚焦于两种特殊情况——零频率（常数）模式和奈奎斯特频率（锯齿）模式。通过分析，我们将理解为什么它们是中性稳定的，以及这与中心差分算子的性质有何关联。[@problem_id:3409115]", "problem": "考虑一维周期性域上的常系数线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中 $a0$ 是常数。在均匀空间网格 $x_{j} = j\\,\\Delta x$（$j$ 为整数索引）和均匀时间层 $t^{n} = n\\,\\Delta t$（$n$ 为整数索引）上对 $u(x,t)$ 进行离散化。使用前向时间中心空间 (FTCS) 方法来近似 $u_{t}$ 和 $u_{x}$，得到显式更新公式\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\n通过假设单一傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,j\\,\\theta\\right)$ 来进行 von Neumann 傅里叶稳定性分析，其中 $i$ 是虚数单位，$\\theta \\in [-\\pi,\\pi]$ 是以弧度为单位的无量纲网格波数。推导由 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ 定义的放大因子 $G(\\theta)$，然后在 $\\theta = 0$ 和 $\\theta = \\pi$ 处计算 $G(\\theta)$ 的值，以证明 $|G(0)| = |G(\\pi)| = 1$。最后，利用基于傅里叶模式分析的基本原理和中心空间差分算子的性质，解释为什么即使线性平流的 FTCS 方法对于非平凡傅里叶内容是全局不稳定的，这些特定模式却是中性稳定的。\n\n你的最终答案必须是两个值 $G(0)$ 和 $G(\\pi)$ 的有序对，以使用 LaTeX $\\mathrm{pmatrix}$ 环境的单行矩阵形式报告。无需四舍五入。", "solution": "本问题要求对线性平流方程的前向时间中心空间 (FTCS) 差分格式进行 von Neumann 稳定性分析。我们必须首先推导放大因子，然后计算它在两个特定波数下的值，最后解释尽管该格式整体不稳定，但在这些波数下观察到中性稳定性的物理和数学原因。\n\n一维线性平流方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $a  0$ 是恒定的波速。\n\nFTCS 离散化格式如下：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n让我们定义库朗数 $C$ 为 $C = \\frac{a\\,\\Delta t}{\\Delta x}$。该差分格式可以更紧凑地写为：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n为了进行 von Neumann 分析，我们将单一傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ 代入离散方程。在这里，$\\hat{u}^{n}$ 是时间层 $n$ 上模式的振幅，$j$ 是空间网格索引，$\\theta = k_g \\Delta x$ 是无量纲网格波数，$i = \\sqrt{-1}$。\n\n差分格式中的各项变为：\n- $u_{j}^{n+1} \\rightarrow \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta)$\n- $u_{j}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$\n- $u_{j+1}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,(j+1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(i\\,\\theta)$\n- $u_{j-1}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$\n\n将这些代入 FTCS 方程得到：\n$$\n\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta) - \\frac{C}{2}\\left(\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(i\\,\\theta) - \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)\\right)\n$$\n将整个方程除以公因子 $\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$（对于非平凡模式），我们得到振幅之比：\n$$\n\\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}} = 1 - \\frac{C}{2}\\left(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)\\right)\n$$\n放大因子 $G(\\theta)$ 定义为 $G(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$。使用 Euler 公式 $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$，我们可以简化括号中的表达式：$\\exp(i\\,\\theta) - \\exp(-i\\,\\theta) = 2i\\sin(\\theta)$。\n将其代回，我们得到放大因子：\n$$\nG(\\theta) = 1 - iC\\sin(\\theta)\n$$\n现在，我们计算特定波数 $\\theta = 0$ 和 $\\theta = \\pi$ 下 $G(\\theta)$ 及其模。\n\n对于 $\\theta = 0$：\n$$\nG(0) = 1 - iC\\sin(0) = 1 - iC(0) = 1\n$$\n其模为 $|G(0)| = |1| = 1$。\n\n对于 $\\theta = \\pi$：\n$$\nG(\\pi) = 1 - iC\\sin(\\pi) = 1 - iC(0) = 1\n$$\n其模为 $|G(\\pi)| = |1| = 1$。\n\n在这两种情况下，放大因子的模都恰好为 $1$，这表示中性稳定。这些傅里叶模式的振幅不会随时间步的推进而改变。\n\n最后，我们必须解释这个结果。众所周知，用于线性平流的 FTCS 差分格式是无条件不稳定的。要理解这一点，我们考察任意 $\\theta$ 下 $G(\\theta)$ 的模：\n$$\n|G(\\theta)| = |1 - iC\\sin(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2} = \\sqrt{1 + C^2\\sin^2(\\theta)}\n$$\n为了使差分格式稳定，von Neumann 条件要求对于所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。然而，由于 $C = \\frac{a\\Delta t}{\\Delta x}  0$，项 $C^2\\sin^2(\\theta)$ 是非负的。对于任何不是 $\\pi$ 的整数倍的 $\\theta$，该项都严格为正。因此，对于任何 $\\theta \\in (-\\pi, 0) \\cup (0, \\pi)$，我们有 $|G(\\theta)|  1$。这意味着除了 $\\theta = 0$ 或 $\\theta = \\pi$ 的傅里叶模式外，任何傅里叶模式的振幅都将呈指数增长，从而导致该差分格式不稳定。\n\n$\\theta=0$ 和 $\\theta=\\pi$ 模式的中性稳定性是用于近似空间导数 $u_x$ 的中心差分算子 $\\delta_{2x} u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$ 造成的一种人为产物。\n1.  **$\\theta = 0$ 的情况：** 这个波数对应于模式 $u_j = \\hat{u}^n \\exp(i j \\cdot 0) = \\hat{u}^n$，它在所有空间网格点上都是一个常数值（一个直流分量）。常数的空间导数为零。中心差分算子正确地再现了这一点：$\\delta_{2x} (\\text{const.}) = \\frac{\\text{const.} - \\text{const.}}{2\\Delta x} = 0$。因此，对于此模式，FTCS 差分格式简化为 $u_j^{n+1} = u_j^n - 0$，即 $u_j^{n+1} = u_j^n$。该模式被精确地保持，从而得到 $G(0)=1$。\n\n2.  **$\\theta = \\pi$ 的情况：** 这个波数对应于网格上可表示的最高频率模式，$u_j = \\hat{u}^n \\exp(i j \\pi) = \\hat{u}^n (-1)^j$。该模式表示一个在每个网格点上符号交替的锯齿状模式（例如，$..., 1, -1, 1, -1, ...$）。当我们将中心差分算子应用于此模式时，我们得到：\n    $$\n    \\delta_{2x} u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x} = \\frac{\\hat{u}^n (-1)^{j+1} - \\hat{u}^n (-1)^{j-1}}{2\\Delta x}\n    $$\n    由于 $(-1)^{j+1} = -(-1)^j$ 且 $(-1)^{j-1} = (-1)^j(-1)^{-1} = -(-1)^j$，两个相邻点的值相同，$u_{j+1} = u_{j-1}$。因此，分子变为零。中心差分算子实际上将这种高振荡模式“看作”局部恒定，并错误地将其导数计算为零。这种对奈奎斯特频率模式的消除是标准二阶中心差分模板的一个已知属性。与 $\\theta=0$ 的情况一样，FTCS 方程中的空间导数项消失，导致 $u_j^{n+1} = u_j^n$ 和放大因子 $G(\\pi)=1$。\n\n总之，在 $\\theta=0$ 和 $\\theta=\\pi$ 处观察到的中性稳定性并非该差分格式可行性的标志，而是中心差分算子的一个特殊属性，即它对这两种模式“视而不见”。对于构成非平凡解的所有其他模式，它们的振幅会无界增长，导致整体数值解变得不稳定。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$", "id": "3409115"}, {"introduction": "了解单步放大因子是一回事，而观察其累积效应则是另一回事。这最后一个练习提出了一个优化问题：在给定固定“能量”的情况下，什么样的初始条件会在 $N$ 步后增长得最快？解决这个问题将为我们提供一个具体的、定量的衡量标准，以评估这种不稳定性灾难性的长期影响。[@problem_id:3409078]", "problem": "考虑周期性空间域上的线性平流方程 $u_t + a\\,u_x = 0$，其中 $a \\in \\mathbb{R}$ 是一个恒定的平流速度。在均匀网格 $x_j = j\\,\\Delta x$（$j = 0, 1, \\dots, M-1$）上对空间进行离散化，采用周期性索引，并用步长 $\\Delta t  0$ 对时间进行离散化。令 $u_j^n$ 表示 $u(x_j, n\\,\\Delta t)$ 的数值近似解。使用前向时间中心空间 (FTCS) 差分格式\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^n - u_{j-1}^n\\Big),\n$$\n来推进数值解，其中 $n = 0, 1, \\dots, N-1$，$N \\in \\mathbb{N}$ 是固定的，且 $M \\ge 4$ 是4的倍数。定义离散 $\\ell^2$-范数为 $\\|u^n\\|_2^2 = \\sum_{j=0}^{M-1} |u_j^n|^2$，并对初始数据施加能量约束 $\\sum_{j=0}^{M-1} |u_j^0|^2 = 1$。\n\n建立并求解在所有满足能量约束的初始数据上最大化 $\\|u^N\\|_2$ 的优化问题。从第一性原理出发，不借助任何预先给定的稳定性公式，推导 $\\|u^N\\|_2$ 可能的最大值的精确表达式，该表达式应由 $a$、$\\Delta t$、$\\Delta x$ 和 $N$ 表示。将最终答案表示为关于 $a$、$\\Delta t$、$\\Delta x$ 和 $N$ 的单一闭式解析表达式。无需四舍五入，也不包含单位。", "solution": "问题要求我们，对于从满足单位范数约束 $\\|u^0\\|_2 = 1$ 的初始条件 $u^0$ 出发，使用前向时间中心空间 (FTCS) 格式演化 $N$ 个时间步长后，求数值解的离散 $\\ell^2$-范数 $\\|u^N\\|_2$ 的可能最大值。\n\n设时间步 $n$ 的数值向量为 $U^n = [u_0^n, u_1^n, \\dots, u_{M-1}^n]^T$。FTCS 格式由以下方程给出：\n$$\nu_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^n - u_{j-1}^n\\Big)\n$$\n让我们定义库朗数 $c_r = \\frac{a\\,\\Delta t}{\\Delta x}$。该格式变为：\n$$\nu_j^{n+1} = u_j^n - \\frac{c_r}{2}\\,(u_{j+1}^n - u_{j-1}^n)\n$$\n由于周期性边界条件（例如 $u_{M}^n = u_0^n$ 和 $u_{-1}^n = u_{M-1}^n$），这个线性格式可以表示为矩阵-向量乘法 $U^{n+1} = L U^n$，其中 $L$ 是一个 $M \\times M$ 的循环矩阵。经过 $N$ 步后，解为 $U^N = L^N U^0$。\n\n优化问题是求解 $\\max_{\\|U^0\\|_2=1} \\|U^N\\|_2$。根据定义，这个最大值是矩阵 $L^N$ 的诱导 2-范数，记为 $\\|L^N\\|_2$。在周期性网格上表示 FTCS 格式的矩阵 $L$ 是一个循环矩阵。循环矩阵是正规矩阵，这意味着它与其共轭转置矩阵可交换（$L^*L = LL^*$）。对于一个正规矩阵，其幂的 2-范数等于其 2-范数的幂：$\\|L^N\\|_2 = (\\|L\\|_2)^N$。此外，正规矩阵的诱导 2-范数等于其谱半径 $\\rho(L)$，即其特征值的最大绝对值。因此，我们的任务简化为计算 $(\\rho(L))^N$。\n\n为了从第一性原理出发找到 $L$ 的特征值，我们进行离散傅里叶分析，通常称为冯·诺伊曼稳定性分析。我们寻找单一傅里叶模态形式的解：\n$$\nu_j^n = (g(k))^n e^{i k x_j} = (g(k))^n e^{i k j \\Delta x}\n$$\n这里，$k$ 是波数，$g(k)$ 是该模态的放大因子，它对应于 $L$ 的一个特征值。周期性边界条件 $u_{j+M}^n = u_j^n$ 意味着 $e^{i k M \\Delta x} = 1$。这使得波数被量化，只允许取离散值 $k_m = \\frac{2\\pi m}{M \\Delta x}$，其中整数模态 $m = 0, 1, \\dots, M-1$。\n\n将傅里叶模态的拟设代入 FTCS 格式得到：\n$$\n(g(k))^{n+1} e^{i k j \\Delta x} = (g(k))^n e^{i k j \\Delta x} - \\frac{c_r}{2} \\left[ (g(k))^n e^{i k (j+1) \\Delta x} - (g(k))^n e^{i k (j-1) \\Delta x} \\right]\n$$\n将整个方程除以 $(g(k))^n e^{i k j \\Delta x}$（对于非平凡解），得到放大因子 $g(k)$ 的表达式：\n$$\ng(k) = 1 - \\frac{c_r}{2} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\n使用欧拉公式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，其中 $\\theta = k \\Delta x$，我们得到：\n$$\ng(k) = 1 - i c_r \\sin(k \\Delta x)\n$$\n谱半径 $\\rho(L)$ 是在所有允许的离散波数 $k_m$ 上 $|g(k)|$ 的模的最大值：\n$$\n\\rho(L) = \\max_{m \\in \\{0, \\dots, M-1\\}} |g(k_m)|\n$$\n我们计算 $g(k)$ 的模：\n$$\n|g(k)| = |1 - i c_r \\sin(k \\Delta x)| = \\sqrt{1^2 + (-c_r \\sin(k \\Delta x))^2} = \\sqrt{1 + c_r^2 \\sin^2(k \\Delta x)}\n$$\n为了最大化 $|g(k)|$，我们必须最大化 $\\sin^2(k \\Delta x)$ 这一项。$\\sin^2(\\theta)$ 的最大值为 $1$。当 $\\theta = k \\Delta x = \\frac{\\pi}{2} + p\\pi$（$p$ 为任意整数）时，达到这个最大值。我们必须验证在我们的离散网格上是否存在这样的模态。离散空间频率为 $\\theta_m = k_m \\Delta x = \\frac{2\\pi m}{M}$，其中 $m = 0, 1, \\dots, M-1$。我们需要确定在此范围内是否存在一个整数 $m$，使得 $\\frac{2\\pi m}{M} = \\frac{\\pi}{2}$ 或 $\\frac{2\\pi m}{M} = \\frac{3\\pi}{2}$ 等。\n由 $\\frac{2\\pi m}{M} = \\frac{\\pi}{2}$，我们得到 $m = M/4$。\n由 $\\frac{2\\pi m}{M} = \\frac{3\\pi}{2}$，我们得到 $m = 3M/4$。\n问题陈述指明 $M$ 是 4 的倍数。这个关键条件保证了 $M/4$ 和 $3M/4$ 是整数。由于问题还说明了 $M \\ge 4$，这些 $m$ 的整数值落在有效范围 $\\{1, \\dots, M-1\\}$ 内。因此，网格上存在使得 $\\sin^2(k_m \\Delta x)$ 达到其最大值 1 的模态。\n\n因此，$|g(k)|$ 的最大值，即谱半径为：\n$$\n\\rho(L) = \\max_k |g(k)| = \\sqrt{1 + c_r^2 \\cdot (1)} = \\sqrt{1 + c_r^2}\n$$\n代回库朗数 $c_r = \\frac{a \\Delta t}{\\Delta x}$ 的定义：\n$$\n\\rho(L) = \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}\n$$\n在给定 $\\|u^0\\|_2=1$ 的条件下，$\\|u^N\\|_2$ 的最大值是 $\\|L^N\\|_2 = (\\rho(L))^N$。当初始数据 $u^0$ 是对应于具有最大模的特征值的特征向量时，例如 $m = M/4$ 的傅里叶模态，就可以达到这个最大值。\n精确的最大值为：\n$$\n\\max_{\\|u^0\\|_2=1} \\|u^N\\|_2 = \\left( \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2} \\right)^N = \\left( 1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2 \\right)^{N/2}\n$$\n这个表达式用给定的参数表示了 $N$ 步后解的 $\\ell^2$-范数的可能最大值。", "answer": "$$\n\\boxed{\\left(1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2\\right)^{N/2}}\n$$", "id": "3409078"}]}