{"hands_on_practices": [{"introduction": "在数值分析中，我们通常认为放大因子模为 $1$（$|g|=1$）的格式是中性稳定的，这似乎暗示误差不会增长。然而，这种直觉可能具有误导性。本练习将通过一个精心设计的思想实验，揭示即使在中性稳定的条件下，由于放大因子存在重根，微小的舍入误差也会随时间线性增长，这是“弱不稳定性”的典型特征。[@problem_id:3415211]", "problem": "考虑周期域上的一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\neq 0$。在空间上使用间距为 $\\Delta x$ 的均匀网格（由 $j \\in \\mathbb{Z}$ 索引）进行离散化，在时间上使用步长为 $\\Delta t$ 的时间步（由 $n \\in \\mathbb{Z}$ 索引）进行离散化。使用蛙跳时间中心格式\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\n即，\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n\\quad \\text{其中} \\quad \\mu := \\frac{a\\,\\Delta t}{\\Delta x}。\n$$\n采用傅里叶模 ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$，其中 $\\kappa := k\\,\\Delta x \\in [-\\pi,\\pi]$，波数为 $k \\in \\mathbb{R}$。假设精确计算得出 $\\widehat{u}^{\\,n}$ 的放大因子多项式，并且中性稳定意味着该多项式的所有相关根 $g$ 都满足 $|g|=1$。\n\n现在，构造一个具体的例子来证明，在存在舍入误差的情况下，中性稳定并不意味着长期误差增长是有界的。为此，选择库朗数 $\\mu = 1$ 和傅里叶波数 $\\kappa = \\pi/2$。在这种情况下，放大因子多项式有一个模为单位1的重根。假设精确解恒为零，但计算出的初始模态振幅受到微小舍入误差的污染，模型为\n$$\n\\widehat{u}^{\\,0} = 0, \n\\qquad \n\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon,\n$$\n其中固定的 $\\varepsilon$ 满足 $0  |\\varepsilon| \\ll 1$，表示在启动时舍入误差在该傅里叶模上的投影。\n\n仅使用上述基本设置和该格式所蕴含的傅里叶模递推关系，推导出 $N$ 个时间步后模态振幅 $\\widehat{u}^{\\,N}$ 的精确闭式表达式，用 $\\varepsilon$ 和 $N$ 表示。您的最终答案必须是单一的解析表达式。不需要进行数值舍入，也不适用任何物理单位。", "solution": "用户提供了一个关于蛙跳时间中心数值格式中弱不稳定性分析的问题陈述。\n\n### 步骤1：问题验证\n\n首先对该问题进行严格的验证过程。\n\n**提取的已知条件：**\n- **控制方程**：$u_{t} + a\\,u_{x} = 0$，其中 $a \\neq 0$。\n- **离散格式**：蛙跳时间中心格式，$u_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$，其中 $\\mu := \\frac{a\\,\\Delta t}{\\Delta x}$。\n- **分析方法**：傅里叶模 ansatz，$u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$，其中 $\\kappa := k\\,\\Delta x$。\n- **稳定性条件**：中性稳定定义为放大因子多项式的所有相关根 $g$ 满足 $|g|=1$。\n- **具体参数**：库朗数 $\\mu = 1$，归一化波数 $\\kappa = \\pi/2$。\n- **模态振幅的初始条件**：$\\widehat{u}^{\\,0} = 0$ 和 $\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon$，其中 $0  |\\varepsilon| \\ll 1$。\n- **目标**：推导出 $\\widehat{u}^{\\,N}$ 关于 $\\varepsilon$ 和 $N$ 的闭式表达式。\n\n**验证结论：**\n该问题是**有效的**。这是一个来自偏微分方程数值分析领域的、提法恰当且有科学依据的问题。所有必要信息都已提供，术语精确，其设置是演示数值格式中弱不稳定性概念的标准方法。该问题不违反任何无效标准。\n\n### 步骤2：解的推导\n\n我们从已知的蛙跳格式的递推关系开始：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n我们将傅里叶模 ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$ 代入此方程：\n$$\n\\widehat{u}^{\\,n+1}\\,\\exp(i\\,\\kappa\\,j) = \\widehat{u}^{\\,n-1}\\,\\exp(i\\,\\kappa\\,j) - \\mu\\left(\\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j+1)) - \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j-1))\\right)\n$$\n将整个方程除以公因子 $\\exp(i\\,\\kappa\\,j)$，得到模态振幅 $\\widehat{u}^{\\,n}$ 的递推关系：\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - \\mu\\,\\widehat{u}^{\\,n}\\left(\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)\\right)\n$$\n使用欧拉恒等式 $\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) = 2i\\sin(\\kappa)$，该关系式变为：\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n}\n$$\n整理各项，我们得到一个二阶线性齐次常系数递推关系：\n$$\n\\widehat{u}^{\\,n+1} + 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\n问题指定了参数 $\\mu = 1$ 和 $\\kappa = \\pi/2$。我们将这些值代入递推关系中。由于 $\\sin(\\pi/2) = 1$，系数 $2i\\mu\\sin(\\kappa)$ 变为 $2i(1)(1) = 2i$。因此，本例中的具体递推关系为：\n$$\n\\widehat{u}^{\\,n+1} + 2i\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\n为求解此递推关系，我们代入试探解 $\\widehat{u}^{\\,n} = g^n$ 来求其特征多项式的根：\n$$\ng^{n+1} + 2i\\,g^n - g^{n-1} = 0\n$$\n假设 $g \\neq 0$ 并除以 $g^{n-1}$，我们得到放大因子多项式：\n$$\ng^2 + 2i\\,g - 1 = 0\n$$\n这个二次表达式是一个完全平方：\n$$\n(g + i)^2 = g^2 + 2ig + i^2 = g^2 + 2ig - 1 = 0\n$$\n该多项式有一个重根 $g_{1,2} = -i$。此根的模为 $|-i| = 1$，这证实了问题陈述中关于模为单位1的重根的说法，该情况对应于中性稳定。\n\n对于具有重根 $g$ 的递推关系，$\\widehat{u}^{\\,n}$ 的通解形式为：\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) g^n\n$$\n其中 $C_1$ 和 $C_2$ 是待定常数，由初始条件确定。代入 $g = -i$，我们得到：\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) (-i)^n\n$$\n问题提供了代表微小舍入误差的初始条件：$\\widehat{u}^{\\,0} = 0$ 和 $\\widehat{u}^{\\,1} = -i\\varepsilon$。\n我们应用 $n=0$ 时的条件：\n$$\n\\widehat{u}^{\\,0} = (C_1 + C_2 \\cdot 0) (-i)^0 = C_1 \\cdot 1 = C_1\n$$\n由于 $\\widehat{u}^{\\,0} = 0$，我们得到 $C_1 = 0$。\n\n接着，我们应用 $n=1$ 时的条件：\n$$\n\\widehat{u}^{\\,1} = (C_1 + C_2 \\cdot 1) (-i)^1 = (0 + C_2) (-i) = -i C_2\n$$\n由于 $\\widehat{u}^{\\,1} = -i\\varepsilon$，我们令两个表达式相等：\n$$\n-i C_2 = -i\\varepsilon \\implies C_2 = \\varepsilon\n$$\n求出常数 $C_1 = 0$ 和 $C_2 = \\varepsilon$ 后，我们将它们代入通解，以求出在时间步 $n$ 处模态振幅的特解：\n$$\n\\widehat{u}^{\\,n} = (0 + \\varepsilon n) (-i)^n = n \\varepsilon (-i)^n\n$$\n问题要求给出 $N$ 个时间步后 $\\widehat{u}^{\\,N}$ 的表达式。我们只需将 $n$ 替换为 $N$：\n$$\n\\widehat{u}^{\\,N} = N \\varepsilon (-i)^N\n$$\n这个结果表明，模态振幅的大小 $|\\widehat{u}^{\\,N}| = |N \\varepsilon (-i)^N| = N|\\varepsilon|$ 随着时间步数 $N$ 线性增长。这种由放大因子多项式中模为单位1的重根引起的线性增长，是弱不稳定性的标志。尽管根据 $|g|=1$ 的准则，该格式是中性稳定的，但一个微小的初始误差会随时间被放大，导致长时间模拟的精度损失。", "answer": "$$\\boxed{N \\varepsilon (-i)^N}$$", "id": "3415211"}, {"introduction": "蛙跳格式是一种三层时间格式，因此需要两个初始时间层的数据才能启动。如何从单层初始条件生成第二层数据是一个关键的实际问题。本练习将探讨使用一个二阶龙格-库塔（RK2）方法作为启动程序的后果，并要求您精确推导该启动过程所激发的非物理计算模的振幅，从而定量理解计算污染的一个重要来源。[@problem_id:3415283]", "problem": "考虑在周期性域上的常系数线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，该方程在均匀网格 $x_{j} = j\\,\\Delta x$ 上以时间步长 $\\Delta t$ 进行离散。采用中心空间导数的蛙跳时间中心格式为\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n-1} \\;-\\; \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n其中 $\\mu \\equiv a\\,\\Delta t/\\Delta x$。已知这种两步格式除了物理模式外，还支持一个非物理的计算模式。减少其激励的一个实用方法是使用二阶启动程序从 $u^{0}$ 计算 $u^{1}$。\n\n采用以下启动方法：将显式中点二阶龙格-库塔 (RK2) 方法应用于半离散常微分方程 (ODE) $u_{t} = -a\\,D_{0}\\,u$（其中 $D_{0}u_{j} \\equiv \\left(u_{j+1}-u_{j-1}\\right)/(2\\,\\Delta x)$），从 $t^{0}$ 推进到 $t^{1} = t^{0} + \\Delta t$。然后在所有后续步骤中继续使用蛙跳格式。\n\n假设初始离散场是波数为 $\\theta \\in [-\\pi,\\pi]$ 的单个傅里叶模式 $u_{j}^{0} = \\exp(i\\,j\\,\\theta)$。对于此 $\\theta$，蛙跳格式允许两个时间放大因子 $g_{+}(\\theta,\\mu)$ 和 $g_{-}(\\theta,\\mu)$，分别对应物理模式和计算模式。在 RK2 启动产生 $u^{1}$ 之后，蛙跳格式的解可以写为叠加形式 $u^{n} = A\\,g_{+}^{\\,n} + B\\,g_{-}^{\\,n}$，其中合适的振幅 $A$ 和 $B$ 由 $u^{0}$ 和 $u^{1}$ 确定。\n\n请以封闭形式推导由这种 RK2 启动方法激发的计算模式的精确振幅 $B(\\mu,\\theta)$，仅用 $\\mu$ 和 $\\theta$ 表示。您的最终答案必须是关于 $B(\\mu,\\theta)$ 的单一解析表达式，不含任何未定参数。无需四舍五入。三角函数以弧度表示。", "solution": "用户希望找到由蛙跳数值格式的特定启动程序产生的计算模式的振幅。\n\n让我们系统地分解这个问题。\n\n首先，我们分析蛙跳格式本身以确定其放大因子。该格式由下式给出：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\n其中 $\\mu = a\\Delta t / \\Delta x$。我们通过代入形式为 $u_j^n = g^n e^{ij\\theta}$ 的单个傅里叶模式解来进行冯·诺依曼稳定性分析，其中 $g$ 是每个时间步的放大因子，$\\theta$ 是无量纲波数。\n$$\ng^{n+1}e^{ij\\theta} = g^{n-1}e^{ij\\theta} - \\mu g^n \\left(e^{i(j+1)\\theta} - e^{i(j-1)\\theta}\\right)\n$$\n两边同除以 $g^{n-1}e^{ij\\theta}$（假设 $g \\neq 0$），我们得到：\n$$\ng^2 = 1 - \\mu g \\left(e^{i\\theta} - e^{-i\\theta}\\right)\n$$\n使用欧拉公式，$e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$。该方程变为关于 $g$ 的特征二次方程：\n$$\ng^2 + (2i\\mu\\sin\\theta) g - 1 = 0\n$$\n使用二次公式 $g = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解 $g$，其中 $a=1$，$b=2i\\mu\\sin\\theta$，$c=-1$：\n$$\ng = \\frac{-2i\\mu\\sin\\theta \\pm \\sqrt{(2i\\mu\\sin\\theta)^2 - 4(1)(-1)}}{2}\n$$\n$$\ng = -i\\mu\\sin\\theta \\pm \\sqrt{-4\\mu^2\\sin^2\\theta + 4}\n$$\n$$\ng = -i\\mu\\sin\\theta \\pm \\sqrt{1 - \\mu^2\\sin^2\\theta}\n$$\n这两个是放大因子，分别对应物理模式和计算模式。我们将其记为 $g_+$ 和 $g_-$：\n$$\ng_+(\\mu, \\theta) = -i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta} \\quad \\text{(物理模式)}\n$$\n$$\ng_-(\\mu, \\theta) = -i\\mu\\sin\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta} \\quad \\text{(计算模式)}\n$$\n为使格式稳定，平方根下的项必须为非负，这导致了 Courant-Friedrichs-Lewy (CFL) 条件 $|\\mu\\sin\\theta| \\le 1$。当此条件成立时，有 $|g_{\\pm}|=1$。\n\n接下来，我们分析启动程序以找到第一个时间步的解 $u^1$。该程序对半离散方程 $u_t = -a D_0 u$ 使用显式中点二阶龙格-库塔 (RK2) 方法。对于单个傅里叶模式 $u_j(t) = \\hat{u}(t)e^{ij\\theta}$，空间导数算子的作用如下：\n$$\n-a D_0 u_j = -a \\frac{u_{j+1} - u_{j-1}}{2\\Delta x} = -a \\frac{\\hat{u}(t)e^{i(j+1)\\theta} - \\hat{u}(t)e^{i(j-1)\\theta}}{2\\Delta x} = -a \\frac{e^{i\\theta}-e^{-i\\theta}}{2\\Delta x} u_j(t) = -a \\frac{2i\\sin\\theta}{2\\Delta x} u_j(t)\n$$\n这得到了关于模态振幅 $\\hat{u}(t)$ 的一个常微分方程 (ODE)：\n$$\n\\frac{d\\hat{u}}{dt} = \\left(-\\frac{ia\\sin\\theta}{\\Delta x}\\right) \\hat{u} = \\lambda \\hat{u} \\quad \\text{其中} \\quad \\lambda = -\\frac{ia\\sin\\theta}{\\Delta x}\n$$\n对于一个常微分方程 $y' = f(t,y)$，RK2 方法是 $y^{n+1} = y^n + \\Delta t f(t^n+\\frac{\\Delta t}{2}, y^n + \\frac{\\Delta t}{2}f(t^n,y^n))$。对于我们的自治常微分方程 $f(y) = \\lambda y$，这简化为：\n$$\n\\hat{u}^1 = \\hat{u}^0 + \\Delta t \\left( \\lambda \\left(\\hat{u}^0 + \\frac{\\Delta t}{2}(\\lambda\\hat{u}^0)\\right) \\right) = \\hat{u}^0 \\left(1 + \\lambda\\Delta t + \\frac{1}{2}(\\lambda\\Delta t)^2 \\right)\n$$\n这个单步 RK2 的放大因子，我们称之为 $G_{RK2}$，是：\n$$\nG_{RK2} = 1 + \\lambda\\Delta t + \\frac{1}{2}(\\lambda\\Delta t)^2\n$$\n代入 $\\lambda \\Delta t = -\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta = -i\\mu\\sin\\theta$：\n$$\nG_{RK2} = 1 + (-i\\mu\\sin\\theta) + \\frac{1}{2}(-i\\mu\\sin\\theta)^2 = 1 - i\\mu\\sin\\theta - \\frac{1}{2}\\mu^2\\sin^2\\theta\n$$\n对于初始条件 $u_j^0 = e^{ij\\theta}$，前两个时间层的解是：\n$$\nu_j^0 = e^{ij\\theta} \\implies \\hat{u}^0 = 1\n$$\n$$\nu_j^1 = G_{RK2} e^{ij\\theta} \\implies \\hat{u}^1 = G_{RK2}\n$$\n\n蛙跳格式的通解是其两种模式的叠加：\n$$\nu_j^n = (A g_+^n + B g_-^n) e^{ij\\theta}\n$$\n其中 $A$ 和 $B$ 分别是物理模式和计算模式的恒定振幅。我们通过匹配 $n=0$ 和 $n=1$ 处的解来找到这些振幅：\n对于 $n=0$：$u_j^0 = (A g_+^0 + B g_-^0)e^{ij\\theta} = (A+B)e^{ij\\theta}$。与 $u_j^0 = e^{ij\\theta}$ 比较，我们得到：\n$$\nA + B = 1 \\quad (1)\n$$\n对于 $n=1$：$u_j^1 = (A g_+^1 + B g_-^1)e^{ij\\theta} = (Ag_+ + Bg_-)e^{ij\\theta}$。与 $u_j^1 = G_{RK2} e^{ij\\theta}$ 比较，我们得到：\n$$\nAg_+ + Bg_- = G_{RK2} \\quad (2)\n$$\n我们需要解这个关于 $B$ 的二元一次方程组。从 (1)，我们有 $A = 1 - B$。将此代入 (2)：\n$$\n(1-B)g_+ + Bg_- = G_{RK2}\n$$\n$$\ng_+ - B g_+ + B g_- = G_{RK2}\n$$\n$$\nB(g_- - g_+) = G_{RK2} - g_+\n$$\n$$\nB = \\frac{G_{RK2} - g_+}{g_- - g_+}\n$$\n现在我们代入 $G_{RK2}$、$g_+$ 和 $g_-$ 的表达式：\n分母是：\n$$\ng_- - g_+ = (-i\\mu\\sin\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}) - (-i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta}) = -2\\sqrt{1 - \\mu^2\\sin^2\\theta}\n$$\n分子是：\n$$\nG_{RK2} - g_+ = \\left(1 - i\\mu\\sin\\theta - \\frac{1}{2}\\mu^2\\sin^2\\theta\\right) - \\left(-i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta}\\right)\n$$\n$$\n= 1 - \\frac{1}{2}\\mu^2\\sin^2\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}\n$$\n将它们合并，我们得到：\n$$\nB(\\mu, \\theta) = \\frac{1 - \\frac{1}{2}\\mu^2\\sin^2\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}}{-2\\sqrt{1 - \\mu^2\\sin^2\\theta}}\n$$\n为了简化这个表达式，令 $X = \\sqrt{1 - \\mu^2\\sin^2\\theta}$。那么 $\\mu^2\\sin^2\\theta = 1 - X^2$。分子变为：\n$$\n1 - \\frac{1}{2}(1 - X^2) - X = 1 - \\frac{1}{2} + \\frac{1}{2}X^2 - X = \\frac{1}{2}X^2 - X + \\frac{1}{2} = \\frac{1}{2}(X^2 - 2X + 1) = \\frac{1}{2}(1 - X)^2\n$$\n分母就是 $-2X$。因此，振幅 $B$ 是：\n$$\nB = \\frac{\\frac{1}{2}(1 - X)^2}{-2X} = -\\frac{(1-X)^2}{4X}\n$$\n将 $X = \\sqrt{1 - \\mu^2\\sin^2\\theta}$ 代回，我们得到计算模式振幅的最终表达式：\n$$\nB(\\mu, \\theta) = -\\frac{\\left(1 - \\sqrt{1 - \\mu^2\\sin^2\\theta}\\right)^2}{4\\sqrt{1 - \\mu^2\\sin^2\\theta}}\n$$\n该表达式是由 $\\mu$ 和 $\\theta$ 表示的、被激发的计算模式的精确振幅。", "answer": "$$\\boxed{-\\frac{\\left(1 - \\sqrt{1 - \\mu^{2}\\sin^{2}(\\theta)}\\right)^{2}}{4\\sqrt{1 - \\mu^{2}\\sin^{2}(\\theta)}}}$$", "id": "3415283"}, {"introduction": "为了抑制蛙跳格式中不请自来的计算模，数值天气预报和气候模型中广泛使用时间滤波器。本练习将聚焦于经典的 Robert–Asselin 滤波器，并提出一个实际的校准任务。您需要通过平衡两个相互竞争的目标——有效衰减计算模与最小化对物理模引入的附加相位误差——来确定最佳的滤波参数 $\\epsilon$，这体现了在设计数值方案时经常遇到的权衡与妥协。[@problem_id:3415215]", "problem": "考虑恒定波速 $c0$ 的线性平流偏微分方程 (PDE) $u_{t} + c\\,u_{x} = 0$，该方程通过蛙跳时域中心格式和中心空间差分，在空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格上进行离散：\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - 2\\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right), \\quad \\text{其中} \\quad \\mu \\equiv \\frac{c\\,\\Delta t}{2\\,\\Delta x}.\n$$\n为了抑制与蛙跳计算模式相关的弱不稳定性，在每次蛙跳更新后应用 Robert–Asselin (RA) 滤波器：\n$$\nu_{j}^{n} \\leftarrow u_{j}^{n} + \\epsilon\\left(u_{j}^{n+1} - 2u_{j}^{n} + u_{j}^{n-1}\\right),\n$$\n其中 $\\epsilon \\in (0,1/2)$ 是一个待标定的无量纲参数。\n\n通过考虑形式为 $u_{j}^{n} = \\widehat{u}\\,\\lambda^{n} \\exp(i j \\theta)$ 的模态进行 von Neumann 傅里叶分析，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数，$\\lambda$ 是复合的蛙跳加滤波器步骤的单步放大因子。使用以下参数值：\n- $c = 0.8$，\n- $\\Delta x = 1$，\n- $\\Delta t = 1$，\n因此 $\\mu = 0.4$。通过强制在 $\\theta = \\pi$ 处的计算模式每个复合时间步长的振幅衰减因子为 $0.9$ 来标定 $\\epsilon$，并同时要求由 RA 滤波器引起的、在 $\\theta = \\pi/4$ 处的物理模式的每个时间步长的附加相位误差不超过 $0.007$ 弧度。\n\n从上述离散更新和滤波器定义出发，推导复合放大关系，识别在 $\\theta = \\pi$ 处的计算模式放大因子，并从规定的衰减中确定 $\\epsilon$。然后，推导至 $\\epsilon$ 的主阶，求出 RA 滤波器对物理模式引起的相位扰动，并在 $\\theta = \\pi/4$ 处对其进行求值，以验证是否满足相位误差限制。如果推导出的 $\\epsilon$ 违反了相位误差限制，则选择在满足相位误差界限的同时，能使计算模式每步振幅衰减因子不小于 $0.9$ 的最大 $\\epsilon$。否则，接受由计算模式衰减所确定的值。提供 $\\epsilon$ 的最终值，作为一个无量纲数。无需四舍五入。所有角度必须以弧度处理。", "solution": "用户希望我解决一个涉及线性平流方程的蛙跳格式和 Robert-Asselin 滤波器的数值分析问题。\n\n这是我的计划：\n1.  **验证问题陈述：** 我将提取所有给定信息，并仔细检查其科学合理性、完整性和客观性。鉴于该问题基于标准的数值偏微分方程方法，预期其是有效的。\n\n2.  **推导复合放大关系：** 我将按所述对组合的蛙跳加滤波器格式进行 von Neumann 分析。这包括将形式为 $u_j^n = \\widehat{u} \\lambda^n \\exp(ij\\theta)$ 的傅里叶模态代入离散方程组，以推导放大因子 $\\lambda$ 的特征多项式。该系统是：\n    1.  一个蛙跳步骤，从 $u^n$ 和 $u^{n-1}$ 计算 $u^{n+1}$。\n    2.  一个 RA 滤波器步骤，使用 $u^{n+1}$、$u^n$ 和 $u^{n-1}$ 更新 $u^n$ 的值。我们将滤波后的值表示为 $u_f^n$。\n    3.  下一个蛙跳步骤使用 $u^{n+1}$ 和滤波后的值 $u_f^n$ 来计算 $u^{n+2}$。\n\n3.  **分析计算模式：** 我将把特征多项式特定化到波数 $\\theta = \\pi$。这将得到在此特定波数下物理模式和计算模式的放大因子。利用为计算模式提供的衰减要求，我将确定滤波器参数 $\\epsilon$ 的值。\n\n4.  **分析相位误差：** 我将找到特征多项式的物理模式根 $\\lambda_p$。然后我将推导由滤波器引入的相位扰动 $\\Delta\\phi$ 的表达式，该表达式在 $\\epsilon$ 的主阶上有效。这是有滤波器（$\\epsilon  0$）和没有滤波器（$\\epsilon=0$）时 $\\lambda_p$ 相位之间的差异。\n\n5.  **应用约束并确定最终值：** 我将在指定的波数 $\\theta = \\pi/4$ 处评估相位扰动，并使用给定的参数值建立一个关于 $\\epsilon$ 的约束。然后，我将把从计算模式衰减推导出的 $\\epsilon$ 值与此相位误差约束进行比较。遵循问题的逻辑，我要么接受 $\\epsilon$ 的初始值，要么选择满足所有条件的最大允许值。\n\n让我们开始正式的流程。\n\n### 第1步：提取给定信息\n-   偏微分方程：$u_{t} + c\\,u_{x} = 0$，其中 $c  0$ 为常数。\n-   蛙跳格式：$u_{j}^{n+1} = u_{j}^{n-1} - 2\\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$。\n-   类库朗数参数：$\\mu \\equiv \\frac{c\\,\\Delta t}{2\\,\\Delta x}$。\n-   Robert–Asselin (RA) 滤波器：$u_{j}^{n} \\leftarrow u_{j}^{n} + \\epsilon\\left(u_{j}^{n+1} - 2u_{j}^{n} + u_{j}^{n-1}\\right)$，其中 $\\epsilon \\in (0, 1/2)$。\n-   用于分析的傅里叶模态：$u_{j}^{n} = \\widehat{u}\\,\\lambda^{n} \\exp(i j \\theta)$，其中 $\\theta \\in [-\\pi,\\pi]$。\n-   参数值：$c = 0.8$，$\\Delta x = 1$，$\\Delta t = 1$。这意味着 $\\mu = \\frac{0.8 \\times 1}{2 \\times 1} = 0.4$。\n-   约束1（计算模式衰减）：在 $\\theta = \\pi$ 处，计算模式每步衰减因子为 $0.9$。\n-   约束2（相位误差）：对于在 $\\theta = \\pi/4$ 处的物理模式，由 RA 滤波器引起的每个时间步长的附加相位误差不得超过 $0.007$ 弧度。\n\n### 第2步：使用提取的给定信息进行验证\n该问题在科学上是合理的、适定的和客观的。\n-   **科学合理性：** 该问题涉及数值分析中一个标准且成熟的课题：偏微分方程有限差分格式的稳定性和准确性。蛙跳格式、其弱不稳定性以及 Robert-Asselin 滤波器都是该领域的经典主题。\n-   **适定性：** 问题提供了一组清晰的方程、参数和两个不同的约束来确定单个参数 $\\epsilon$。在约束冲突时选择 $\\epsilon$ 的逻辑也已明确。其结构表明存在唯一解。\n-   **客观性：** 问题以精确的数学语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n问题是**有效的**。我将继续进行求解。\n\n### 推导与求解\n\n我们分析组合的蛙跳-滤波器格式。从 $(u^{n-1}, u^n)$ 对推进到 $(u^n, u^{n+1})$，然后再到 $(u^{n+1}, u^{n+2})$ 的过程如下：\n1.  使用标准的蛙跳更新计算 $u_j^{n+1}$：\n    $u_j^{n+1} = u_j^{n-1} - 2\\mu(u_{j+1}^{n} - u_{j-1}^{n})$\n2.  然后对 $u_j^n$ 的值进行滤波，生成一个新的值 $u_{f,j}^n$，该值用于后续步骤：\n    $u_{f,j}^n = u_j^n + \\epsilon(u_j^{n+1} - 2u_j^n + u_j^{n-1})$\n3.  下一个状态 $u_j^{n+2}$ 使用滤波后的值 $u_{f,j}^n$ 计算：\n    $u_j^{n+2} = u_{f,j}^n - 2\\mu(u_{j+1}^{n+1} - u_{j-1}^{n+1})$\n\n为了进行 von Neumann 分析，我们将傅里叶模态 $u_j^n = \\widehat{u}^n e^{ij\\theta}$ 代入这些方程。空间差分项变为：\n$u_{j+1}^n - u_{j-1}^n = \\widehat{u}^n e^{ij\\theta}(e^{i\\theta} - e^{-i\\theta}) = \\widehat{u}^n e^{ij\\theta} (2i\\sin\\theta)$。\n\n傅里叶空间中的方程组变为：\n1.  $\\widehat{u}^{n+1} = \\widehat{u}^{n-1} - 2\\mu (2i\\sin\\theta) \\widehat{u}^n = \\widehat{u}^{n-1} - 4i\\mu\\sin\\theta \\widehat{u}^n$。\n2.  $\\widehat{u}_f^n = \\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} - 2\\widehat{u}^n + \\widehat{u}^{n-1})$。\n3.  $\\widehat{u}^{n+2} = \\widehat{u}_f^n - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$。\n\n将 (2) 代入 (3)：\n$\\widehat{u}^{n+2} = [\\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} - 2\\widehat{u}^n + \\widehat{u}^{n-1})] - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$。\n\n从 (1) 中，我们用较新的值来表示 $\\widehat{u}^{n-1}$：$\\widehat{u}^{n-1} = \\widehat{u}^{n+1} + 4i\\mu\\sin\\theta \\widehat{u}^n$。将此代入 $\\widehat{u}^{n+2}$ 的方程中：\n$\\widehat{u}^{n+2} = \\widehat{u}^n + \\epsilon[\\widehat{u}^{n+1} - 2\\widehat{u}^n + (\\widehat{u}^{n+1} + 4i\\mu\\sin\\theta \\widehat{u}^n)] - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$\n$\\widehat{u}^{n+2} = \\widehat{u}^n + \\epsilon(2\\widehat{u}^{n+1} - 2\\widehat{u}^n + 4i\\mu\\sin\\theta \\widehat{u}^n) - 4i\\mu\\sin\\theta \\widehat{u}^{n+1}$\n\n按 $\\widehat{u}^{n+1}$ 和 $\\widehat{u}^n$ 对项进行分组：\n$\\widehat{u}^{n+2} = (2\\epsilon - 4i\\mu\\sin\\theta)\\widehat{u}^{n+1} + (1 - 2\\epsilon + 4i\\epsilon\\mu\\sin\\theta)\\widehat{u}^n$。\n\n通过设 $\\widehat{u}^n = \\lambda^n$，我们得到放大因子 $\\lambda$ 的特征多项式：\n$\\lambda^2 - (2\\epsilon - 4i\\mu\\sin\\theta)\\lambda - (1 - 2\\epsilon + 4i\\epsilon\\mu\\sin\\theta) = 0$。\n\n**使用计算模式标定 $\\epsilon$**\n\n我们分析 $\\theta=\\pi$ 的情况。此时，$\\sin\\theta = 0$。特征多项式简化为：\n$\\lambda^2 - 2\\epsilon\\lambda - (1 - 2\\epsilon) = 0$。\n\n根由二次求根公式给出：\n$\\lambda = \\frac{2\\epsilon \\pm \\sqrt{(-2\\epsilon)^2 - 4(1)(-(1-2\\epsilon))}}{2} = \\epsilon \\pm \\sqrt{\\epsilon^2 + 1 - 2\\epsilon} = \\epsilon \\pm \\sqrt{(\\epsilon-1)^2}$。\n由于 $\\epsilon \\in (0, 1/2)$，$\\epsilon-1  0$，因此 $\\sqrt{(\\epsilon-1)^2} = |\\epsilon-1| = 1-\\epsilon$。\n两个根是：\n$\\lambda_1 = \\epsilon + (1-\\epsilon) = 1$ (物理模式)。\n$\\lambda_2 = \\epsilon - (1-\\epsilon) = 2\\epsilon - 1$ (计算模式)。\n\n问题要求计算模式每步衰减因子为 $0.9$。这意味着其放大因子的模必须是 $0.9$：\n$|\\lambda_2| = |2\\epsilon - 1| = 0.9$。\n由于 $\\epsilon \\in (0, 1/2)$，$2\\epsilon-1$ 为负。因此，$|2\\epsilon-1| = -(2\\epsilon-1) = 1-2\\epsilon$。\n$1 - 2\\epsilon = 0.9 \\implies 2\\epsilon = 0.1 \\implies \\epsilon = 0.05$。\n这个值在规定的范围 $(0, 1/2)$ 内。\n\n**相位误差分析**\n\n一般特征方程的根是：\n$\\lambda = \\frac{(2\\epsilon - 4i\\mu\\sin\\theta) \\pm \\sqrt{(2\\epsilon - 4i\\mu\\sin\\theta)^2 + 4(1-2\\epsilon+4i\\epsilon\\mu\\sin\\theta)}}{2}$。\n平方根下的项简化为 $4(1 - (2\\mu\\sin\\theta)^2 - (2\\epsilon - \\epsilon^2))$。令 $\\nu = 2\\mu\\sin\\theta$。\n根是 $\\lambda = (\\epsilon - i\\nu) \\pm \\sqrt{1-\\nu^2 - 2\\epsilon + \\epsilon^2}$。\n物理模式是在 $\\nu \\to 0$ 时趋近于 $1$ 的那个。令 $R = \\sqrt{1-\\nu^2-2\\epsilon+\\epsilon^2}$。\n当 $\\nu \\to 0$ 时，$R \\to \\sqrt{(1-\\epsilon)^2} = 1-\\epsilon$。\n根变为 $\\epsilon \\pm (1-\\epsilon)$，即 $1$ 和 $2\\epsilon-1$。因此物理根是 $\\lambda_p = (\\epsilon - i\\nu) + R$。\n\n物理模式的相位是 $\\phi(\\epsilon) = \\arg(\\lambda_p)$。我们关心的是在 $\\epsilon$ 的主阶上的附加相位误差，$\\Delta\\phi = \\phi(\\epsilon) - \\phi(0)$。\n对于小的 $\\epsilon$，我们展开 $\\lambda_p$：\n$R = \\sqrt{1-\\nu^2 - (2\\epsilon-\\epsilon^2)} \\approx \\sqrt{1-\\nu^2}\\left(1 - \\frac{2\\epsilon}{1-\\nu^2}\\right)^{1/2} \\approx \\sqrt{1-\\nu^2}\\left(1 - \\frac{\\epsilon}{1-\\nu^2}\\right) = \\sqrt{1-\\nu^2} - \\frac{\\epsilon}{\\sqrt{1-\\nu^2}}$。\n$\\lambda_p(\\epsilon) \\approx (\\epsilon - i\\nu) + \\sqrt{1-\\nu^2} - \\frac{\\epsilon}{\\sqrt{1-\\nu^2}} = \\underbrace{(-i\\nu + \\sqrt{1-\\nu^2})}_{\\lambda_p(0)} + \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)$。\n相位扰动由 $\\Delta\\phi \\approx \\text{Im}\\left(\\frac{\\delta\\lambda_p}{\\lambda_p(0)}\\right)$ 给出，其中 $\\delta\\lambda_p$ 是 $O(\\epsilon)$ 阶项。\n注意，对于未滤波的蛙跳格式，对于稳定模式（$\\nu^2 \\le 1$），有 $|\\lambda_p(0)|=|\\sqrt{1-\\nu^2} - i\\nu|=1$。\n因此，$\\frac{1}{\\lambda_p(0)} = \\overline{\\lambda_p(0)} = \\sqrt{1-\\nu^2} + i\\nu$。\n$\\Delta\\phi \\approx \\text{Im}\\left[ \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right) (\\sqrt{1-\\nu^2} + i\\nu) \\right]$。\n$\\Delta\\phi \\approx \\epsilon\\nu\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)$。\n\n相位误差约束是在 $\\theta = \\pi/4$ 处 $|\\Delta\\phi| \\le 0.007$。\n首先，我们用给定的参数计算 $\\nu$：$\\mu=0.4$ 和 $\\theta=\\pi/4$。\n$\\nu = 2\\mu\\sin\\theta = 2(0.4)\\sin(\\pi/4) = 0.8 \\frac{\\sqrt{2}}{2} = 0.4\\sqrt{2}$。\n由于 $\\nu^2 = (0.4\\sqrt{2})^2 = 0.32  1$，该格式是稳定的。\n相位误差的模是：\n$|\\Delta\\phi| = \\left|\\epsilon\\nu\\left(1 - \\frac{1}{\\sqrt{1-\\nu^2}}\\right)\\right| = \\epsilon\\nu\\left(\\frac{1}{\\sqrt{1-\\nu^2}} - 1\\right)$。\n括号中的项是 $\\frac{1}{\\sqrt{1-0.32}}-1 = \\frac{1}{\\sqrt{0.68}}-1$。\n我们要求 $|\\Delta\\phi| \\le 0.007$，因此我们找到最大允许的 $\\epsilon$：\n$\\epsilon \\le \\frac{0.007}{\\nu(\\frac{1}{\\sqrt{1-\\nu^2}}-1)} = \\frac{0.007}{0.4\\sqrt{2}(\\frac{1}{\\sqrt{0.68}} - 1)}$。\n让我们计算这个界限：\n$0.4\\sqrt{2} \\approx 0.565685$。\n$\\frac{1}{\\sqrt{0.68}} - 1 \\approx \\frac{1}{0.82462} - 1 \\approx 1.21268 - 1 = 0.21268$。\n$\\epsilon \\le \\frac{0.007}{0.565685 \\times 0.21268} \\approx \\frac{0.007}{0.12032} \\approx 0.058178$。\n\n**关于 $\\epsilon$ 的最终决定**\n\n1.  在 $\\theta=\\pi$ 处的计算模式衰减要求给出 $\\epsilon = 0.05$。\n2.  在 $\\theta=\\pi/4$ 处的相位误差限制要求 $\\epsilon \\le 0.058178...$。\n\n值 $\\epsilon=0.05$ 满足相位误差约束 ($0.05 \\le 0.058178...$)。\n根据问题陈述，“如果推导出的 $\\epsilon$ 违反了相位误差限制，[...] 否则，接受由计算模式衰减所确定的值。”\n由于没有违反，我们接受从计算模式衰减要求推导出的值。\n参数的最终值为 $\\epsilon = 0.05$。\n按要求，所有角度都以弧度处理。无需四舍五入，因为结果是一个精确的小数。", "answer": "$$\\boxed{0.05}$$", "id": "3415215"}]}