{"hands_on_practices": [{"introduction": "在分析一个完整的时间步进格式之前，我们必须首先理解空间差分算子在傅里叶空间中的行为。线性、移位不变的算子可被傅里叶模对角化，这意味着每个模态仅仅被乘以一个称为傅里叶符号的复数。该符号的实部和虚部分别控制着算子的数值耗散和数值色散特性。这项练习 [@problem_id:3461944] 提供了推导最常见单边差分算子符号的基础实践，并解释了它们的物理意义，这是任何冯·诺依曼分析中至关重要的第一步。", "problem": "考虑一个在均匀网格 $x_{j} = j\\,\\Delta x$ 上对标量场 $u_{j}(t)$ 进行的线性、移位不变的空间离散化，该离散化用于近似空间导数算子 $\\partial_{x}$。两个单边有限差分算子定义为 $D_{+} u_{j} = \\left(u_{j+1} - u_{j}\\right)/\\Delta x$ 和 $D_{-} u_{j} = \\left(u_{j} - u_{j-1}\\right)/\\Delta x$。使用 von Neumann 稳定性分析 (VNSA) 的基本思想，即离散傅里叶模 $v_{j}(\\theta) = \\exp\\!\\left(i j \\theta\\right)$ 可以对角化线性、移位不变的差分算子，推导出傅里叶符号 $\\widehat{D_{+}}(\\theta)$ 和 $\\widehat{D_{-}}(\\theta)$，使得 $D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$。\n\n然后，考虑常系数线性平流方程 $\\partial_{t} u + a\\,\\partial_{x} u = 0$ 的半离散近似 $\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$，其中 $a \\in \\mathbb{R}$ 是平流速度，且 $D$ 为 $D_{+}$ 或 $D_{-}$。使用复数值的傅里叶符号，区分数值耗散（由符号的实部控制）和数值色散（由符号的虚部控制），并解释对于 $a$ 的何种符号，选择 $D_{+}$ 或 $D_{-}$ 会产生稳定的、耗散的平流。此外，确定在稳定使用时，对于波数 $0  \\theta  \\pi$，与 $D_{+}$ 或 $D_{-}$ 相关联的相速度是高估了还是低估了精确的相速度。\n\n请以闭合形式提供傅里叶符号对 $\\widehat{D_{+}}(\\theta)$ 和 $\\widehat{D_{-}}(\\theta)$ 作为您的最终答案。无需进行数值四舍五入，最终答案中也不应报告任何物理单位。", "solution": "用户提供了一个问题，要求在线性平流方程的背景下，推导和分析单边有限差分算子的傅里叶符号。\n\n### 第1步：提取已知条件\n-   均匀空间网格：$x_{j} = j\\,\\Delta x$\n-   网格上的标量场：$u_{j}(t)$\n-   向前差分算子：$D_{+} u_{j} = \\frac{u_{j+1} - u_{j}}{\\Delta x}$\n-   向后差分算子：$D_{-} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$\n-   离散傅里叶模：$v_{j}(\\theta) = \\exp(i j \\theta)$\n-   傅里叶符号的特征值定义：$D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$\n-   线性平流方程：$\\partial_{t} u + a\\,\\partial_{x} u = 0$，其中 $a \\in \\mathbb{R}$ 是常数平流速度。\n-   半离散近似：$\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$，其中 $D$ 为 $D_{+}$ 或 $D_{-}$。\n-   波数的分析域：$0  \\theta  \\pi$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学和数学上是合理的。它提出了偏微分方程数值分析领域中一个标准的、典型的问题。有限差分算子的定义、离散傅里叶模的使用以及半离散平流方程的构建都是标准的。该问题是自包含的，提供了所有必要的定义和方程。所提问题精确、适定，并且可以通过既定的数学步骤得到一个唯一、可验证的解。该问题是客观的，没有歧义或事实错误。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n主要任务是推导傅里叶符号 $\\widehat{D_{+}}(\\theta)$ 和 $\\widehat{D_{-}}(\\theta)$，并分析它们在用于离散化线性平流方程时的性质。\n\n#### 第1部分：傅里叶符号的推导\n\n线性、移位不变差分算子 $D$ 的傅里叶符号 $\\widehat{D}(\\theta)$ 是其对应于离散傅里叶特征函数 $v_{j}(\\theta) = \\exp(i j \\theta)$ 的特征值，其中 $\\theta = k \\Delta x$ 是无量纲波数，$k$ 是物理波数。\n\n对于向前差分算子 $D_{+}$，我们将其应用于 $v_{j}(\\theta)$：\n$$\nD_{+} v_{j}(\\theta) = \\frac{v_{j+1}(\\theta) - v_{j}(\\theta)}{\\Delta x} = \\frac{\\exp(i (j+1) \\theta) - \\exp(i j \\theta)}{\\Delta x}\n$$\n将 $\\exp(i j \\theta) = v_{j}(\\theta)$ 因子提出：\n$$\nD_{+} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (\\exp(i \\theta) - 1)}{\\Delta x} = \\left(\\frac{\\exp(i \\theta) - 1}{\\Delta x}\\right) v_{j}(\\theta)\n$$\n通过与定义 $D_{+} v_{j}(\\theta) = \\widehat{D_{+}}(\\theta) v_{j}(\\theta)$ 比较，我们确定 $D_{+}$ 的傅里叶符号为：\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\exp(i \\theta) - 1}{\\Delta x}\n$$\n对于向后差分算子 $D_{-}$，我们执行相同的过程：\n$$\nD_{-} v_{j}(\\theta) = \\frac{v_{j}(\\theta) - v_{j-1}(\\theta)}{\\Delta x} = \\frac{\\exp(i j \\theta) - \\exp(i (j-1) \\theta)}{\\Delta x}\n$$\n将 $\\exp(i j \\theta) = v_{j}(\\theta)$ 因子提出：\n$$\nD_{-} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (1 - \\exp(-i \\theta))}{\\Delta x} = \\left(\\frac{1 - \\exp(-i \\theta)}{\\Delta x}\\right) v_{j}(\\theta)\n$$\n因此，$D_{-}$ 的傅里叶符号为：\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - \\exp(-i \\theta)}{\\Delta x}\n$$\n\n#### 第2部分：半离散格式的稳定性分析\n\n平流方程的半离散近似为 $\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$。我们通过将 $u_{j}(t) = \\hat{u}(\\theta, t) \\exp(i j \\theta)$ 代入此方程来分析单个傅里叶模的演化。算子 $\\partial_t$ 仅作用于 $\\hat{u}(\\theta, t)$，而 $D$ 仅作用于空间部分 $\\exp(i j \\theta)$：\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) D \\exp(i j \\theta) = 0\n$$\n使用特征值性质 $D \\exp(i j \\theta) = \\widehat{D}(\\theta) \\exp(i j \\theta)$，我们得到：\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) \\widehat{D}(\\theta) \\exp(i j \\theta) = 0\n$$\n除以非零项 $\\exp(i j \\theta)$，我们得到关于傅里叶模振幅的常微分方程 (ODE)：\n$$\n\\frac{d\\hat{u}}{dt} = -a \\widehat{D}(\\theta) \\hat{u}\n$$\n该 ODE 的解为 $\\hat{u}(\\theta, t) = \\hat{u}(\\theta, 0) \\exp(-a \\widehat{D}(\\theta) t)$。为了使格式稳定，任何模的振幅都不能随时间无限增长，即对于所有 $\\theta$ 和 $t  0$，都有 $|\\exp(-a \\widehat{D}(\\theta) t)| \\le 1$。这要求指数的实部为非正：\n$$\n\\text{Re}(-a \\widehat{D}(\\theta)) \\le 0\n$$\n我们针对 $D=D_{+}$ 和 $D=D_{-}$ 分析此条件。让我们使用 $\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$ 将符号表示为其​实部和虚部。\n对于 $\\widehat{D_{+}}(\\theta)$：\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\cos(\\theta) - 1}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n稳定性条件为 $\\text{Re}(-a \\widehat{D_{+}}(\\theta)) = -a \\text{Re}(\\widehat{D_{+}}(\\theta)) = -a \\frac{\\cos(\\theta) - 1}{\\Delta x} = a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$。由于 $\\Delta x  0$ 且对于所有 $\\theta$ 都有 $1 - \\cos(\\theta) \\ge 0$，此不等式当且仅当 $a \\le 0$ 时成立。因此，向前差分格式 ($D_{+}$) 对于向左传播的波 ($a \\le 0$) 是稳定的。项 $a \\frac{1 - \\cos(\\theta)}{\\Delta x}$ 代表数值耗散，它会衰减模的振幅，除非 $\\theta=0$（模 $2\\pi$）。\n\n对于 $\\widehat{D_{-}}(\\theta)$：\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - (\\cos(\\theta) - i\\sin(\\theta))}{\\Delta x} = \\frac{1 - \\cos(\\theta)}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n稳定性条件为 $\\text{Re}(-a \\widehat{D_{-}}(\\theta)) = -a \\text{Re}(\\widehat{D_{-}}(\\theta)) = -a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$。此不等式当且仅当 $-a \\le 0$，即 $a \\ge 0$ 时成立。因此，向后差分格式 ($D_{-}$) 对于向右传播的波 ($a \\ge 0$) 是稳定的。该格式也是耗散的。\n\n这个结果是迎风格式原理的核心：为保证稳定性，单边差分必须取自波传播来的方向（“迎风”）。\n\n#### 第3部分：数值色散与相速度分析\n\n傅里叶模的解为 $u_j(t) = \\hat{u}(0) \\exp(-a t \\text{Re}(\\widehat{D})) \\exp(i (j\\theta - a t \\text{Im}(\\widehat{D})))$。波的相位是 $j\\theta - a t \\text{Im}(\\widehat{D}(\\theta))$。通过将 $j\\theta$ 写成 $(j\\Delta x)(\\theta/\\Delta x) = kx_j$，相位可以写为 $k x_j - \\omega_{num} t$，其中 $\\omega_{num} = a \\text{Im}(\\widehat{D}(\\theta))$。数值相速度是 $c_{num}(\\theta) = \\omega_{num}/k = a \\text{Im}(\\widehat{D}(\\theta)) / (\\theta/\\Delta x)$。\n\n对于 $D_{+}$ 和 $D_{-}$，符号的虚部是相同的：\n$$\n\\text{Im}(\\widehat{D_{+}}(\\theta)) = \\text{Im}(\\widehat{D_{-}}(\\theta)) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n因此，两种格式的数值相速度为：\n$$\nc_{num}(\\theta) = a \\frac{\\sin(\\theta)/\\Delta x}{\\theta/\\Delta x} = a \\frac{\\sin(\\theta)}{\\theta}\n$$\n偏微分方程 $\\partial_{t} u + a\\,\\partial_{x} u = 0$ 的精确相速度是 $c_{exact} = a$。\n\n我们比较 $c_{num}$ 与 $c_{exact}$ 在 $0  \\theta  \\pi$ 的情况。在此区间内，一个已知的数学不等式是 $0  \\sin(\\theta)/\\theta  1$。让我们分析稳定情况：\n1.  **$D_{-}$ 的稳定情况**：$a > 0$。我们比较 $c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$ 与 $c_{exact} = a$。由于 $a > 0$ 且 $\\frac{\\sin(\\theta)}{\\theta}  1$，因此有 $a \\frac{\\sin(\\theta)}{\\theta}  a$。所以，$c_{num}  c_{exact}$。数值相速度**低估**了精确相速度。\n2.  **$D_{+}$ 的稳定情况**：$a  0$。我们再次比较 $c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$ 与 $c_{exact} = a$。由于 $a  0$，将不等式 $\\frac{\\sin(\\theta)}{\\theta}  1$ 乘以 $a$ 会反转符号：$a \\frac{\\sin(\\theta)}{\\theta} > a$。所以，$c_{num} > c_{exact}$。数值相速度**高估**了精确相速度。\n\n尽管在 $a0$ 时相速度的代数值被高估了，但关键要注意的是，在两种稳定情况下，速度的大小总是被低估的。$|c_{num}| = |a \\frac{\\sin\\theta}{\\theta}| = |a| \\frac{\\sin\\theta}{\\theta}  |a| = |c_{exact}|$。这意味着对于所有波数 $\\theta \\in (0, \\pi)$，数值波的传播速度都比真实波慢，这种现象被称为相位滞后。这是数值色散的一种形式，因为速度依赖于波数 $\\theta$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\exp(i\\theta) - 1}{\\Delta x}  \\frac{1 - \\exp(-i\\theta)}{\\Delta x}\n\\end{pmatrix}\n}\n$$", "id": "3461944"}, {"introduction": "掌握了空间算子的傅里叶符号这一工具后，我们现在可以分析一个完整的、完全离散的数值格式。显式时间步进格式的稳定性是通过确保放大因子 $G(\\theta)$ 的模在所有波数下都不大于1来确定的，其中 $G(\\theta)$ 结合了空间算子符号和时间步进方法的影响。这通常会导出一个关联时间步长 $\\Delta t$ 和网格间距 $\\Delta x$ 的条件。这个经典问题 [@problem_id:3461957] 将引导你推导一阶迎风格式的Courant-Friedrichs-Lewy (CFL) 条件，这是数值偏微分方程领域的一个基石性结果，它揭示了稳定性与计算成本之间的基本权衡。", "problem": "考虑线性平流偏微分方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a0$ 是一个常数。设均匀空间网格由 $x_{j} = j\\,\\Delta x$ 给出，离散时间层级为 $t^{n} = n\\,\\Delta t$，未知数 $u_{j}^{n} \\approx u(x_{j}, t^{n})$。对于 $a0$，一阶迎风有限差分格式通过使用来自迎风方向的信息将 $u_{j}^{n}$ 推进到 $u_{j}^{n+1}$。假设周期性边界条件，以便在网格上可以良好地定义离散傅里叶模。\n\n从冯·诺依曼稳定性分析的第一性原理出发，即线性、平移不变的差分格式对傅里叶模 $e^{\\mathrm{i} j \\theta}$ 起对角作用，且稳定性由谱放大因子 $G(\\theta)$ 满足 $\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| \\leq 1$ 的要求来表征，推导 $a0$ 时一阶迎风格式的离散傅里叶符号，并确定使该格式在冯·诺依曼意义下稳定的最大库朗-弗里德里希斯-列维（CFL）数 $\\lambda_{\\max}$。这里的 CFL 数为 $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$。你的最终答案必须是单个实数 $\\lambda_{\\max}$，无需四舍五入。", "solution": "问题陈述经评估有效。这是一个来自偏微分方程（PDE）数值分析领域的适定、有科学依据的问题，并提供了所有必要的信息。\n\n线性平流方程由下式给出：\n$$u_{t} + a u_{x} = 0$$\n其中平流速度 $a$ 是一个正常数，$a  0$。我们在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上离散化此偏微分方程。离散点为 $(x_j, t^n) = (j\\,\\Delta x, n\\,\\Delta t)$，在这些点上的数值解记为 $u_j^n \\approx u(x_j, t^n)$。\n\n一阶迎风格式是通过对时间使用向前差分、对空间使用单边差分来构建的。对于 $a0$，特征信息从左向右传播（沿 $x$ 增加的方向）。因此，“迎风”方向是负 $x$ 方向。这决定了对空间导数 $u_x$ 使用一阶向后差分：\n$$u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$$\n$$u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$$\n将这些近似值代入偏微分方程，得到有限差分方程：\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left(\\frac{u_j^n - u_{j-1}^n}{\\Delta x}\\right) = 0$$\n我们可以重新整理这个方程，以求解下一个时间步的解 $u_j^{n+1}$：\n$$u_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)$$\n引入库朗-弗里德里希斯-列维（CFL）数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$，格式变为：\n$$u_j^{n+1} = u_j^n - \\lambda(u_j^n - u_{j-1}^n)$$\n$$u_j^{n+1} = (1 - \\lambda) u_j^n + \\lambda u_{j-1}^n$$\n这就是 $a0$ 时一阶迎风格式的显式表达式。\n\n为进行冯·诺依曼稳定性分析，我们考虑单个傅里叶模在网格上的行为。假设周期性边界条件，我们可以将解表示为形如 $u_j^n = \\hat{u}^n(k) e^{\\mathrm{i} k x_j}$ 的模的叠加，其中 $k$ 是波数。对于线性格式，分析单个模就足够了。设 $u_j^n$ 的形式为：\n$$u_j^n = G(\\theta)^n e^{\\mathrm{i} j \\theta}$$\n这里，$\\theta = k \\Delta x$ 是无量纲波数或相位角，$G(\\theta)$ 是放大因子。下一个时间步的解是 $u_j^{n+1} = G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta}$。将这个假设代入差分格式得到：\n$$G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta} = (1 - \\lambda) G(\\theta)^n e^{\\mathrm{i} j \\theta} + \\lambda G(\\theta)^n e^{\\mathrm{i} (j-1) \\theta}$$\n我们可以（对于非平凡解）将 $G(\\theta)^n$ 和 $e^{\\mathrm{i} j \\theta}$ 因子提出：\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) e^{\\mathrm{i} j \\theta} + \\lambda e^{\\mathrm{i} (j-1) \\theta} \\right)$$\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) + \\lambda e^{-\\mathrm{i} \\theta} \\right) e^{\\mathrm{i} j \\theta}$$\n两边同除以公因子 $e^{\\mathrm{i} j \\theta}$ 得到放大因子 $G(\\theta)$，即该格式的离散傅里叶符号：\n$$G(\\theta) = 1 - \\lambda + \\lambda e^{-\\mathrm{i} \\theta}$$\n如果对于所有可能的 $\\theta \\in [-\\pi, \\pi]$ 值，放大因子的模都小于或等于 $1$，则该格式在冯·诺依曼意义下是稳定的。条件是：\n$$|G(\\theta)| \\le 1 \\quad \\forall \\theta$$\n为分析此条件，我们计算 $G(\\theta)$ 的模的平方。使用欧拉公式 $e^{-\\mathrm{i} \\theta} = \\cos(\\theta) - \\mathrm{i} \\sin(\\theta)$，我们可以用其实部和虚部表示 $G(\\theta)$：\n$$G(\\theta) = (1 - \\lambda + \\lambda \\cos(\\theta)) - \\mathrm{i} (\\lambda \\sin(\\theta))$$\n模的平方为 $|G(\\theta)|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2$：\n$$|G(\\theta)|^2 = (1 - \\lambda + \\lambda \\cos(\\theta))^2 + (-\\lambda \\sin(\\theta))^2$$\n$$|G(\\theta)|^2 = (1 - \\lambda(1 - \\cos(\\theta)))^2 + \\lambda^2 \\sin^2(\\theta)$$\n展开各项：\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - \\cos(\\theta))^2 + \\lambda^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + \\lambda^2 \\sin^2(\\theta)$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + 1)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(2 - 2\\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + 2\\lambda^2(1 - \\cos(\\theta))$$\n提出公因子：\n$$|G(\\theta)|^2 = 1 + (2\\lambda^2 - 2\\lambda)(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta))$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 变为：\n$$1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 1$$\n$$-2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 0$$\n除以 $-2$ 会反转不等号：\n$$\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$$\n我们分析各个因子的符号。\n1. CFL 数 $\\lambda = \\frac{a \\Delta t}{\\Delta x}$ 必须为非负，因为 $a0$, $\\Delta t  0$, 且 $\\Delta x  0$。所以，$\\lambda \\ge 0$。\n2. 对于任意实数 $\\theta$，项 $(1 - \\cos(\\theta))$ 总是非负的，因为 $\\cos(\\theta) \\le 1$。具体来说，$0 \\le (1 - \\cos(\\theta)) \\le 2$。\n\n由于 $\\lambda \\ge 0$ 且 $(1 - \\cos(\\theta)) \\ge 0$，不等式 $\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$ 对所有 $\\theta$ 成立的充要条件是剩余的因子也为非负：\n$$1 - \\lambda \\ge 0$$\n这意味着 $\\lambda \\le 1$。\n综合关于 $\\lambda$ 的两个条件，该格式稳定的充要条件是 $0 \\le \\lambda \\le 1$。\n问题要求的是使格式稳定的最大 CFL 数 $\\lambda_{\\max}$。根据我们推导出的稳定域，这个值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3461957"}, {"introduction": "稳定性确保了数值解不会无限增大，但它并不保证准确性。一个稳定的格式仍然可能由于数值色散而产生物理上不正确的结果。波的频率 $\\omega$ 与其波数 $k$ 之间的关系称为色散关系。对于数值格式，这种关系通常与真实的物理关系不同，导致不同波长的波以不正确的速度传播。决定波包传播速度的群速度 $v_{g} = \\partial \\omega / \\partial k$ 是量化这种误差的关键指标。通过分析蛙跳格式 [@problem_id:3461974]，你将探索如何推导和解释数值群速度。这项实践揭示了离散色散对波传播模拟准确性的深远影响，这是计算流体力学和电磁学等领域的重要考虑因素。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，定义在周期性域上。在空间上使用间距为 $\\Delta x$ 的均匀网格进行离散，在时间上使用步长为 $\\Delta t$ 进行离散。令 $\\nu = a\\,\\Delta t/\\Delta x$ 表示库朗数。考虑时间上蛙跳、空间上中心差分的线性格式\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0.\n$$\n使用 von Neumann 傅里叶模态试探解 $u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数（单位为弧度），物理波数为 $k = \\theta/\\Delta x$，推导连接 $\\omega(\\theta)$ 和 $\\theta$ 的离散色散关系。然后，从第一性原理出发，计算群速度 $v_{g}(\\theta) = \\partial \\omega/\\partial k$ 作为 $\\theta$ 和 $\\nu$ 的显式函数，并将其与精确的连续群速度 $a$ 进行比较。最后，利用从您的色散关系中得到的小 $\\theta$ 级数，量化以 $|\\theta_{0}| \\ll 1$ 的 $\\theta_{0}$ 为中心的窄带高斯波包的群速度的主阶相对误差，并讨论这对该波包传播精度的影响，包括谱带宽的作用。\n\n您的最终答案必须是计算出的离散群速度 $v_{g}(\\theta)$ 的一个单一闭式解析表达式，用 $a$、$\\nu$ 和 $\\theta$ 表示（最终答案框中不带单位）。整个过程中角度均以弧度表示。无需进行数值四舍五入。", "solution": "问题陈述已经过严格验证，被认为是科学合理的、适定的、客观且自洽的。它提出了一个偏微分方程数值分析中的标准且非平凡的问题，具体涉及线性平流方程的蛙跳有限差分格式的色散性质。所有提供的信息都是一致的，并且足以进行严格的推导和分析。因此，该问题是有效的。\n\n我们从一维线性平流方程 $u_{t} + a\\,u_{x} = 0$ 开始，其中 $a$ 是一个常数速度。所提出的数值格式是时间上蛙跳、空间上中心差分的离散化：\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0\n$$\n为了分析该格式的色散性质，我们代入 von Neumann 傅里叶模态试探解 $u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$。这里，$j$ 和 $n$ 分别是离散的空间和时间索引，$\\Delta x$ 和 $\\Delta t$ 分别是网格间距和时间步长，$\\theta$ 是无量纲波数，$\\omega(\\theta)$ 是数值频率。\n\n格式中的各项变为：\n- $u^{n+1}_{j} = u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t)$\n- $u^{n-1}_{j} = u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)$\n- $u^{n}_{j+1} = u^{n}_{j}\\,\\exp(i\\,\\theta)$\n- $u^{n}_{j-1} = u^{n}_{j}\\,\\exp(-i\\,\\theta)$\n\n将这些代入有限差分方程，得到：\n$$\n\\frac{u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t) - u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j}\\,\\exp(i\\,\\theta) - u^{n}_{j}\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n对于非平凡解（$u^{n}_{j} \\neq 0$），我们可以除以 $u^{n}_{j}$：\n$$\n\\frac{\\exp(-i\\,\\omega\\,\\Delta t) - \\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n使用欧拉恒等式 $\\sin(z) = \\frac{\\exp(i\\,z) - \\exp(-i\\,z)}{2i}$，方程简化为：\n$$\n\\frac{-2i\\,\\sin(\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = 0\n$$\n$$\n-\\frac{i\\,\\sin(\\omega\\,\\Delta t)}{\\Delta t} + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\n两边除以 $i$ 并重新整理，得到隐式离散色散关系：\n$$\n\\frac{\\sin(\\omega\\,\\Delta t)}{\\Delta t} = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\n引入库朗数 $\\nu = a\\,\\Delta t/\\Delta x$，我们得到一个更紧凑的形式：\n$$\n\\sin(\\omega(\\theta)\\,\\Delta t) = \\nu\\,\\sin(\\theta)\n$$\n该关系式在 $\\omega$ 为实数时有效，条件是 $|\\nu\\,\\sin(\\theta)| \\le 1$。由于 $|\\sin(\\theta)| \\le 1$，这要求满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件 $|\\nu| \\le 1$。假设满足稳定性条件，我们可以写出显式色散关系：\n$$\n\\omega(\\theta) = \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta))\n$$\n接下来，我们计算离散群速度，定义为 $v_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k}$，其中 $k$ 是物理波数，通过 $k = \\theta/\\Delta x$ 与无量纲波数 $\\theta$ 相关联。使用链式法则，我们可以写出：\n$$\nv_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k} = \\frac{\\partial \\omega}{\\partial \\theta}\\frac{\\partial \\theta}{\\partial k}\n$$\n由 $\\theta = k\\,\\Delta x$，我们得到 $\\frac{\\partial \\theta}{\\partial k} = \\Delta x$。现在我们对 $\\omega(\\theta)$ 关于 $\\theta$ 求导：\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta}\\left[ \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta)) \\right] = \\frac{1}{\\Delta t} \\cdot \\frac{1}{\\sqrt{1 - (\\nu\\,\\sin(\\theta))^{2}}} \\cdot \\frac{\\partial}{\\partial \\theta}(\\nu\\,\\sin(\\theta))\n$$\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{1}{\\Delta t} \\frac{\\nu\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\n因此，群速度为：\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\frac{\\partial \\omega}{\\partial \\theta} = \\Delta x \\cdot \\left( \\frac{\\nu\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right)\n$$\n代入 $\\nu = a\\,\\Delta t/\\Delta x$：\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\left( \\frac{(a\\,\\Delta t/\\Delta x)\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right) = \\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\n这就是蛙跳格式的离散群速度。对于连续方程，精确的色散关系是 $\\omega(k) = ak$，这给出了精确的群速度 $v_{g}^{\\text{exact}} = \\frac{\\partial \\omega}{\\partial k} = a$。连续问题是非色散的。相比之下，数值群速度 $v_{g}(\\theta)$ 依赖于波数 $\\theta$，这表明该格式引入了数值色散。\n\n为了量化长波（$|\\theta| \\ll 1$）的误差，我们将 $v_{g}(\\theta)$ 在 $\\theta=0$ 附近进行泰勒级数展开。我们使用近似 $\\cos(\\theta) \\approx 1 - \\frac{\\theta^{2}}{2}$ 和 $\\sin^{2}(\\theta) \\approx \\theta^{2}$。\n$$\nv_{g}(\\theta) = \\frac{a(1 - \\frac{\\theta^{2}}{2} + O(\\theta^{4}))}{\\sqrt{1 - \\nu^{2}(\\theta^{2} + O(\\theta^{4}))}} = a\\left(1 - \\frac{\\theta^{2}}{2}\\right)(1 - \\nu^{2}\\theta^{2})^{-1/2} + O(\\theta^{4})\n$$\n对小 $x$ 使用二项式展开 $(1-x)^{-1/2} \\approx 1 + \\frac{1}{2}x$：\n$$\nv_{g}(\\theta) \\approx a\\left(1 - \\frac{\\theta^{2}}{2}\\right)\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2}\\right) = a\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2} - \\frac{1}{2}\\theta^{2} - \\frac{1}{4}\\nu^{2}\\theta^{4}\\right)\n$$\n保留到 $\\theta^{2}$ 阶的项：\n$$\nv_{g}(\\theta) \\approx a\\left(1 + \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\\right)\n$$\n群速度的主阶相对误差为：\n$$\n\\frac{v_{g}(\\theta) - a}{a} \\approx \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\n$$\n由于稳定性要求 $\\nu^{2} \\le 1$，因此项 $\\nu^{2}-1$ 是非正的。因此，对于小 $\\theta$，$v_{g}(\\theta) \\le a$。这表明存在滞后的相位误差：数值波分量的传播速度比其物理对应物慢。\n\n对于一个以低波数 $\\theta_{0}$ ($|\\theta_{0}| \\ll 1$) 为中心的窄带高斯波包，其质心将以大约 $v_{g}(\\theta_{0})$ 的速度传播，该速度略小于 $a$。更重要的是，由于群速度在波包的谱带宽上不是恒定的，不同的傅里叶分量将以不同的速度传播。群速度随波数的变化，即 $\\frac{\\partial v_{g}}{\\partial\\theta}$，会导致数值色散，使得波包随时间扩散并扭曲其形状。更宽的谱带宽会加剧这种效应，因为它涉及更宽范围的群速度，导致波包更快速地发生非物理性的扩散。在最高可分辨波数 $\\theta = \\pi$ 处，群速度为 $v_{g}(\\pi) = -a$，这意味着这些短波会向后传播，这是该格式的一个严重的数值伪影。", "answer": "$$\\boxed{\\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}}$$", "id": "3461974"}]}