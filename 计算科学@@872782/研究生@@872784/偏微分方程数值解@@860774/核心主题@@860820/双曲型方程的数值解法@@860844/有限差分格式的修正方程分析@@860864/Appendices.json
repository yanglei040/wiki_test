{"hands_on_practices": [{"introduction": "这项练习是一个基础的起点，它将演示如何将修正方程分析应用于最简单的有限差分格式之一——用于对流方程的一阶迎风格式。通过这个过程[@problem_id:3422645]，你将揭示出该格式中隐藏的数值黏性项，这一项在稳定格式的同时也引入了误差，是理解数值方法行为的关键一步。", "problem": "考虑具有恒定平流速度 $a0$ 的一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$。在间距为 $h$ 的均匀空间网格和时间步长为 $\\Delta t$ 的均匀时间网格上，使用前向欧拉时间离散和（适用于 $a0$ 的）一阶迎风空间离散来近似该偏微分方程：\n$$\nu_{j}^{n+1} = u_{j}^{n} - a\\,\\Delta t\\,\\frac{u_{j}^{n} - u_{j-1}^{n}}{h}.\n$$\n进行修正方程分析，以确定该有限差分格式引入的主导人工扩散项。具体而言，通过将精确解 $u(x,t)$ 在空间和时间上进行泰勒级数展开，并利用该偏微分方程消去高阶时间导数，推导出修正方程中乘以 $u_{xx}$ 的有效数值扩散系数 $\\nu_{\\text{num}}$。通过使用 Courant-Friedrichs-Lewy (CFL) 数 $\\lambda = a\\,\\Delta t / h$ 对结果进行求值，用 $a$、$h$ 和 $\\Delta t$ 表示 $\\nu_{\\text{num}}$。你的最终答案必须是单一的闭式解析表达式。无需四舍五入，最终表达式中不应包含任何单位。", "solution": "该问题要求对给定的一维线性平流方程的有限差分格式进行修正方程分析，以找出主导的人工扩散项。\n\n给定的偏微分方程 (PDE) 是线性平流方程：\n$$\nu_t + a\\,u_x = 0\n$$\n其中 $u = u(x,t)$ 是解变量，$t$ 是时间，$x$ 是空间坐标，$a0$ 是恒定平流速度。下标表示偏微分，即 $u_t = \\frac{\\partial u}{\\partial t}$ 和 $u_x = \\frac{\\partial u}{\\partial x}$。\n\n所提供的有限差分格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n} - a\\,\\Delta t\\,\\frac{u_{j}^{n} - u_{j-1}^{n}}{h}\n$$\n这里，$u_j^n$ 是精确解 $u$ 在网格点 $x_j = j h$ 和时间 $t_n = n \\Delta t$ 处的数值近似，其中 $h$ 是均匀空间步长，$\\Delta t$ 是均匀时间步长。该格式在时间上使用前向差分（前向欧拉），在空间上使用后向差分（因为 $a0$，所以是一阶迎风格式）。\n\n修正方程分析的目标是确定数值格式实际求解的偏微分方程。这通过将离散格式的每一项围绕一个中心点（通常是 $(x_j, t_n)$）进行泰勒级数展开，然后将所得表达式重新整理成偏微分方程的形式来实现。\n\n让我们将 $u_j^{n+1}$ 和 $u_{j-1}^n$ 这两项在点 $(x_j, t_n)$ 周围展开。我们假设精确解 $u(x,t)$ 足够光滑以允许这些展开。\n$u_j^{n+1} = u(x_j, t_n + \\Delta t)$ 在时间上的泰勒级数展开为：\n$$\nu_j^{n+1} = u(x_j,t_n) + \\Delta t \\frac{\\partial u}{\\partial t} + \\frac{(\\Delta t)^2}{2!} \\frac{\\partial^2 u}{\\partial t^2} + \\frac{(\\Delta t)^3}{3!} \\frac{\\partial^3 u}{\\partial t^3} + \\mathcal{O}((\\Delta t)^4)\n$$\n$u_{j-1}^n = u(x_j - h, t_n)$ 在空间上的泰勒级数展开为：\n$$\nu_{j-1}^n = u(x_j,t_n) - h \\frac{\\partial u}{\\partial x} + \\frac{h^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} - \\frac{h^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\mathcal{O}(h^4)\n$$\n为简洁起见，我们将用下标表示在 $(x_j, t_n)$ 处求值的偏导数，例如，$u_t = \\frac{\\partial u}{\\partial t}\\Big|_{(x_j, t_n)}$。\n\n首先，我们将有限差分格式两边同除以 $\\Delta t$ 进行改写：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{h} = 0\n$$\n现在，将泰勒级数展开式代入此方程：\n$$\n\\frac{1}{\\Delta t} \\left( \\left(u + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}((\\Delta t)^3)\\right) - u \\right) + \\frac{a}{h} \\left( u - \\left(u - h\\, u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\mathcal{O}(h^4)\\right) \\right) = 0\n$$\n化简括号内的项可得：\n$$\n\\left( u_t + \\frac{\\Delta t}{2} u_{tt} + \\mathcal{O}((\\Delta t)^2) \\right) + \\frac{a}{h} \\left( h\\, u_x - \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} - \\mathcal{O}(h^4) \\right) = 0\n$$\n展开各项：\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + a u_x - \\frac{ah}{2} u_{xx} + \\frac{ah^2}{6} u_{xxx} + \\text{H.O.T.} = 0\n$$\n其中 H.O.T. 代表高阶项。重新整理方程，按导数阶数组合各项，我们得到：\n$$\n(u_t + a u_x) + \\frac{\\Delta t}{2} u_{tt} - \\frac{ah}{2} u_{xx} + \\mathcal{O}(\\Delta t^2, h^2, \\Delta t h) = 0\n$$\n这个表达式代表了格式的截断误差。将此整个表达式设为零，即可得到修正方程。第一项 $(u_t + a u_x)$ 是原始的偏微分方程。对于精确解，该项为零。剩余的项代表了由离散化引入的误差。\n\n为了找到有效偏微分方程，我们必须将时间导数（$u_{tt}$、$u_{ttt}$ 等）用空间导数来表示。这是通过假设解足够光滑，并对偏微分方程本身 $u_t = -a u_x$ 进行重复微分来完成的。\n对 $t$ 微分：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} (u_t) = \\frac{\\partial}{\\partial t} (-a u_x) = -a \\frac{\\partial}{\\partial t} (\\partial_x u) = -a \\frac{\\partial}{\\partial x} (\\partial_t u) = -a \\frac{\\partial}{\\partial x} (u_t)\n$$\n现在，将 $u_t = -a u_x$ 代入此结果：\n$$\nu_{tt} = -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}\n$$\n在 $h$ 和 $\\Delta t$ 趋于零的极限下，这个关系不仅对原始偏微分方程成立，对修正方程本身的解也成立。现在，我们将这个 $u_{tt}$ 的表达式代回到我们展开的方程中：\n$$\n(u_t + a u_x) + \\frac{\\Delta t}{2} (a^2 u_{xx}) - \\frac{ah}{2} u_{xx} + \\text{H.O.T.} = 0\n$$\n我们可以重新整理此式以分离出原始的偏微分方程算子：\n$$\nu_t + a u_x = - \\left( \\frac{a^2 \\Delta t}{2} - \\frac{ah}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\n$$\nu_t + a u_x = \\left( \\frac{ah}{2} - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\n这就是修正方程。主导误差项是一个二阶导数项，其作用类似于一个形式为 $\\nu_{\\text{num}} u_{xx}$ 的扩散项。系数 $\\nu_{\\text{num}}$ 是数值（或人工）扩散系数。通过比较各项，我们确定它为：\n$$\n\\nu_{\\text{num}} = \\frac{ah}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n问题要求使用 Courant-Friedrichs-Lewy (CFL) 数（定义为 $\\lambda = \\frac{a \\Delta t}{h}$）来用 $a$、$h$ 和 $\\Delta t$ 表示这个结果。我们可以对 $\\nu_{\\text{num}}$ 的表达式进行因式分解，使这种关系更加明确：\n$$\n\\nu_{\\text{num}} = \\frac{ah}{2} \\left( 1 - \\frac{a \\Delta t}{h} \\right)\n$$\n此表达式包含量 $a$、$h$ 和 $\\Delta t$，并且其结构因 CFL 数的存在而变得清晰。这个显式格式的稳定性条件是 $0 \\le \\lambda \\le 1$。在此范围内，$\\nu_{\\text{num}} \\ge 0$，表明该格式引入了稳定化扩散。当 $\\lambda=1$ 时，数值扩散消失，该格式对于给定的偏微分方程变得精确（因为截断误差的主导项变为零）。\n\n因此，数值扩散系数的最终表达式是 $\\frac{ah}{2} \\left( 1 - \\frac{a \\Delta t}{h} \\right)$。", "answer": "$$\n\\boxed{\\frac{ah}{2}\\left(1 - \\frac{a \\Delta t}{h}\\right)}\n$$", "id": "3422645"}, {"introduction": "在上一练习的基础上，本实践将探讨另一种格式——Lax-Friedrichs格式。此分析将更加深入，不仅揭示耗散误差（即数值黏性），还将揭示色散误差（与相速度相关），这两者是对流格式中主要的误差来源。通过完成这项练习[@problem_id:3422654]，你还将接触到如何通过调整无量纲参数来分析甚至优化格式性能的概念。", "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数。设空间网格是均匀的，步长为 $h  0$，时间步长为 $\\Delta t  0$。Lax–Friedrichs 有限差分格式将 $u_{j}^{n}$ 推进到 $u_{j}^{n+1}$ 的方法如下\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2h}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\n定义库朗数 (Courant number) $\\lambda = \\frac{a\\,\\Delta t}{h}$。使用基于泰勒/傅里叶展开的修正方程分析，将该格式近似为一个连续的偏微分方程，形式如下\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\mu\\,u_{xxx} + \\text{高阶项},\n$$\n该方程在 $h$ 上有效至三阶。请确定系数 $\\nu$ 和 $\\mu$ 关于 $\\lambda$、$h$ 和 $\\Delta t$ 的解析表达式。然后，施加固定主阶耗散的约束，将人工粘性设置为零（即，要求主阶 $\\nu$ 为零），并在满足此约束的所有库朗数 $\\lambda$ 中，确定使主阶相位误差最小化（即，最小化乘以 $u_{xxx}$ 的系数的绝对值）的 $\\lambda$ 值。将最终答案表示为一个单行向量，依次包含 $u_{xx}$ 的系数、$u_{xxx}$ 的系数以及最优库朗数 $\\lambda$。无需四舍五入，最终答案中不应包含任何物理单位。", "solution": "对问题陈述的分析表明，该问题具有科学依据、是适定且客观的。所有必要信息均已提供，任务定义清晰且在数学上是可解的。因此，该问题被认为是有效的。\n\n目标是找到用于线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的 Lax–Friedrichs 有限差分格式所对应的修正偏微分方程。该格式由下式给出：\n$$u_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{a\\,\\Delta t}{2h}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$$\n使用库朗数 $\\lambda = \\frac{a\\,\\Delta t}{h}$ 的定义，该格式可以重写为：\n$$u_{j}^{n+1} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) - \\frac{\\lambda}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$$\n我们通过将格式的每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开来进行修正方程分析。设 $u(x,t)$ 是一个足够光滑的函数，其中 $u_j^n = u(x_j, t_n)$。展开式如下，其中所有导数均在点 $(x_j, t_n)$ 处取值：\n$$u_{j}^{n+1} = u(x_j, t_n+\\Delta t) = u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + O\\left((\\Delta t)^4\\right)$$\n$$u_{j\\pm 1}^{n} = u(x_j\\pm h, t_n) = u \\pm h u_x + \\frac{h^2}{2} u_{xx} \\pm \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + O(h^5)$$\n我们计算格式中出现的组合项：\n$$\\frac{1}{2}\\left(u_{j+1}^{n} + u_{j-1}^{n}\\right) = \\frac{1}{2}\\left(2u + h^2 u_{xx} + \\frac{h^4}{12}u_{xxxx} + O(h^6)\\right) = u + \\frac{h^2}{2}u_{xx} + \\frac{h^4}{24}u_{xxxx} + O(h^6)$$\n$$\\frac{1}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) = \\frac{1}{2}\\left(2h u_x + \\frac{h^3}{3} u_{xxx} + O(h^5)\\right) = h u_x + \\frac{h^3}{6}u_{xxx} + O(h^5)$$\n将这些展开式代入数值格式，得到：\n$$u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt} + \\dots = u + \\frac{h^2}{2}u_{xx} - \\lambda \\left(h u_x + \\frac{h^3}{6}u_{xxx}\\right) + O(h^4)$$\n使用 $\\lambda h = a \\Delta t$，我们将 $-\\lambda h u_x$ 简化为 $-a \\Delta t u_x$。消去 $u$ 并除以 $\\Delta t$，我们得到：\n$$u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{(\\Delta t)^2}{6} u_{ttt} + \\dots = -a u_x + \\frac{h^2}{2\\Delta t}u_{xx} - \\frac{\\lambda h^3}{6\\Delta t}u_{xxx} + \\dots$$\n重新整理以分离出 $u_t$：\n$$u_t = -a u_x + \\frac{h^2}{2\\Delta t}u_{xx} - \\frac{\\lambda h^3}{6\\Delta t}u_{xxx} - \\frac{\\Delta t}{2} u_{tt} - \\frac{(\\Delta t)^2}{6} u_{ttt} + \\dots$$\n为了找到修正方程，我们必须用空间导数来表示时间导数（$u_{tt}$, $u_{ttt}$）。这可以通过对修正方程本身 $u_t = -a u_x + \\nu u_{xx} + \\mu u_{xxx} + \\dots$ 反复求导并回代来实现。\n在主阶上，$u_t \\approx -a u_x$。\n二阶时间导数为 $u_{tt} = \\partial_t(u_t) \\approx \\partial_t(-a u_x) = -a u_{xt} = -a \\partial_x(u_t) \\approx -a \\partial_x(-a u_x) = a^2 u_{xx}$。\n三阶时间导数为 $u_{ttt} = \\partial_t(u_{tt}) \\approx \\partial_t(a^2 u_{xx}) = a^2 u_{xxt} = a^2 \\partial_{xx}(u_t) \\approx a^2 \\partial_{xx}(-a u_x) = -a^3 u_{xxx}$。\n为了正确确定 $\\mu$，我们需要一个更精确的 $u_{tt}$ 表达式，该表达式包含 $\\nu$：\n$$u_{tt} = \\partial_t(-a u_x + \\nu u_{xx} + \\dots) = -a \\partial_x(u_t) + \\nu \\partial_{xx}(u_t) + \\dots$$\n$$u_{tt} = -a \\partial_x(-a u_x + \\nu u_{xx} + \\dots) + \\nu \\partial_{xx}(-a u_x + \\dots) = a^2 u_{xx} - 2a\\nu u_{xxx} + O(h^2)$$\n将这些代入 $u_t$ 的表达式中：\n$$u_t = -a u_x + \\frac{h^2}{2\\Delta t}u_{xx} - \\frac{\\lambda h^3}{6\\Delta t}u_{xxx} - \\frac{\\Delta t}{2} \\left(a^2 u_{xx} - 2a\\nu u_{xxx} + \\dots\\right) - \\frac{(\\Delta t)^2}{6} \\left(-a^3 u_{xxx} + \\dots\\right) + \\dots$$\n我们现在按空间导数的阶数对各项进行分组，以获得修正方程 $u_t + a u_x = \\nu u_{xx} + \\mu u_{xxx} + \\dots$：\n$u_{xx}$ 的系数是 $\\nu$：\n$$\\nu = \\frac{h^2}{2\\Delta t} - \\frac{a^2 \\Delta t}{2}$$\n我们可以通过代入 $a = \\lambda h / \\Delta t$ 将其表示为给定参数 $\\lambda$, $h$, 和 $\\Delta t$ 的形式：\n$$\\nu = \\frac{h^2}{2\\Delta t} - \\frac{(\\lambda h / \\Delta t)^2 \\Delta t}{2} = \\frac{h^2}{2\\Delta t} - \\frac{\\lambda^2 h^2}{2\\Delta t} = \\frac{h^2}{2\\Delta t}(1-\\lambda^2)$$\n$u_{xxx}$ 的系数是 $\\mu$：\n$$\\mu = -\\frac{\\lambda h^3}{6\\Delta t} + a\\nu\\Delta t + \\frac{a^3(\\Delta t)^2}{6}$$\n代入 $\\nu$ 的表达式：\n$$\\mu = -\\frac{\\lambda h^3}{6\\Delta t} + a\\left(\\frac{h^2}{2\\Delta t} - \\frac{a^2 \\Delta t}{2}\\right)\\Delta t + \\frac{a^3(\\Delta t)^2}{6}$$\n$$\\mu = -\\frac{\\lambda h^3}{6\\Delta t} + \\frac{ah^2}{2} - \\frac{a^3(\\Delta t)^2}{2} + \\frac{a^3(\\Delta t)^2}{6} = -\\frac{\\lambda h^3}{6\\Delta t} + \\frac{ah^2}{2} - \\frac{a^3(\\Delta t)^2}{3}$$\n再次代入 $a = \\lambda h / \\Delta t$：\n$$\\mu = -\\frac{\\lambda h^3}{6\\Delta t} + \\frac{(\\lambda h / \\Delta t)h^2}{2} - \\frac{(\\lambda h / \\Delta t)^3(\\Delta t)^2}{3} = -\\frac{\\lambda h^3}{6\\Delta t} + \\frac{3\\lambda h^3}{6\\Delta t} - \\frac{\\lambda^3 h^3}{3\\Delta t}$$\n$$\\mu = \\frac{2\\lambda h^3}{6\\Delta t} - \\frac{\\lambda^3 h^3}{3\\Delta t} = \\frac{\\lambda h^3}{3\\Delta t} - \\frac{\\lambda^3 h^3}{3\\Delta t} = \\frac{\\lambda h^3}{3\\Delta t}(1-\\lambda^2)$$\n所以，前两个系数是 $\\nu = \\frac{h^2}{2\\Delta t}(1-\\lambda^2)$ 和 $\\mu = \\frac{\\lambda h^3}{3\\Delta t}(1-\\lambda^2)$。\n\n问题的第二部分要求将人工粘性系数 $\\nu$ 设置为零，以消除主阶耗散。\n$$\\nu = \\frac{h^2}{2\\Delta t}(1-\\lambda^2) = 0$$\n因为 $h  0$ 和 $\\Delta t  0$，这要求 $1-\\lambda^2 = 0$，从而得到 $\\lambda = \\pm 1$。库朗数 $\\lambda = a\\Delta t/h$ 是正的，因为 $a$、$\\Delta t$ 和 $h$ 都是正的。因此，唯一有效的解是 $\\lambda=1$。Lax-Friedrichs 格式的稳定性条件是 $|\\lambda| \\le 1$，所以 $\\lambda=1$ 是一个有效的选择。\n\n接着，问题要求从这组可能性（其中只包含 $\\lambda=1$）中找到使主阶相位误差系数的绝对值 $|\\mu|$ 最小的 $\\lambda$ 值。\n在 $\\lambda=1$ 处计算 $\\mu$ 的值：\n$$\\mu(\\lambda=1) = \\frac{(1) h^3}{3\\Delta t}(1-1^2) = 0$$\n在 $\\lambda=1$ 时， $|\\mu|$ 的大小为 0。由于 $|\\mu|$ 必须为非负数，这是它的绝对最小值。因此，满足约束 $\\nu=0$ 并最小化 $|\\mu|$ 的 $\\lambda$ 值是 $\\lambda=1$。当 $\\lambda=1$ 时，格式 $u_j^{n+1}=u_{j-1}^n$ 是该偏微分方程的一个精确解算器，因为它在每个时间步长内将解精确地平移一个网格单元，与特征线 $x-at=\\text{const}$ 相匹配。\n\n最终答案要求一个行向量，包含 $\\nu$ 的解析表达式、$\\mu$ 的解析表达式以及最优库朗数 $\\lambda$。\n$u_{xx}$ 的系数是 $\\nu = \\frac{h^2}{2\\Delta t}(1-\\lambda^2)$。\n$u_{xxx}$ 的系数是 $\\mu = \\frac{\\lambda h^3}{3\\Delta t}(1-\\lambda^2)$。\n最优库朗数是 $\\lambda = 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{h^2}{2\\Delta t}(1-\\lambda^2)  \\frac{\\lambda h^3}{3\\Delta t}(1-\\lambda^2)  1\n\\end{pmatrix}\n}\n$$", "id": "3422654"}, {"introduction": "最后的这项练习将视角从“分析”转向“设计”，这是计算科学中的一项关键高级技能。你不再是分析一个给定的格式，而是将运用修正方程分析的原理来“逆向工程”，构建出能够精确匹配目标偏微分方程（包含一个高阶项）的有限差分模板。这个练习[@problem_id:3422594]展示了修正方程分析如何成为构建新型、更优数值方法的强大理论工具。", "problem": "考虑一个定义在实数轴上的标量守恒律，它带有一个常系数线性平流项和一个超粘性项：\n$$\nu_{t} + a\\,u_{x} \\;=\\; -\\mu\\,u_{xxxx},\n$$\n其中 $a \\in \\mathbb{R}$ 和 $\\mu  0$ 是常数，且 $u(x,t)$ 足够光滑。在一个间距为 $h0$ 的均匀空间网格 $x_{i} = i\\,h$, $i \\in \\mathbb{Z}$ 上，构建一个半离散的线方法空间离散化格式\n$$\n\\frac{d}{dt}u_{i}(t) \\;+\\; a\\,\\mathcal{D}_{1} u_{i}(t) \\;=\\; -\\mu\\,\\mathcal{D}_{4} u_{i}(t),\n$$\n其中 $\\mathcal{D}_{1}$ 是一个近似 $\\partial_{x}$ 的中心、平移不变、反对称的 $2m{+}1$ 点有限差分格式，而 $\\mathcal{D}_{4}$ 是一个近似 $\\partial_{x}^{4}$ 的中心、平移不变、对称的 $2n{+}1$ 点有限差分格式。具体来说，假设\n$$\n\\mathcal{D}_{1} u_{i} \\;=\\; \\frac{1}{h}\\sum_{k=-m}^{m}\\alpha_{k}\\,u_{i+k}, \n\\quad \\alpha_{-k} = -\\alpha_{k}, \\quad \\alpha_{0}=0,\n$$\n并且\n$$\n\\mathcal{D}_{4} u_{i} \\;=\\; \\frac{1}{h^{4}}\\sum_{k=-n}^{n}\\beta_{k}\\,u_{i+k}, \n\\quad \\beta_{-k} = \\beta_{k}.\n$$\n使用修正方程分析 (MEA) 来确保半离散格式的等效偏微分方程与目标连续统方程\n$$\nu_{t} + a\\,u_{x} \\;=\\; -\\mu\\,u_{xxxx}\n$$\n的匹配精度达到并包括 $O(h^{4})$ 阶项，且没有 $O(h^{2})$ 或 $O(h^{3})$ 阶的伪项。在所有此类中心格式中，确定能够实现此阶数匹配的最小半宽 $m$ 和 $n$，并计算相应的唯一系数 $\\{\\alpha_{k}\\}_{k=-m}^{m}$ 和 $\\{\\beta_{k}\\}_{k=-n}^{n}$。\n\n将您的最终答案表示为按以下顺序排列的系数单行向量：\n$$\n\\bigl[\\alpha_{-2},\\,\\alpha_{-1},\\,\\alpha_{0},\\,\\alpha_{1},\\,\\alpha_{2},\\,\\beta_{-3},\\,\\beta_{-2},\\,\\beta_{-1},\\,\\beta_{0},\\,\\beta_{1},\\,\\beta_{2},\\,\\beta_{3}\\bigr],\n$$\n以精确有理数形式表示。不需要四舍五入，最终答案中不应包含任何单位。", "solution": "用户希望找到两个有限差分格式 $\\mathcal{D}_1$ 和 $\\mathcal{D}_4$ 的系数，这两个格式分别近似一阶和四阶导数，使得给定偏微分方程（PDE）的半离散格式满足特定的精度阶数。该问题将使用修正方程分析（MEA）来解决。\n\n### 步骤 1：问题验证\n\n**已知条件：**\n-   **目标 PDE：** $u_{t} + a\\,u_{x} = -\\mu\\,u_{xxxx}$，其中 $a \\in \\mathbb{R}$ 和 $\\mu  0$ 是常数。\n-   **半离散格式：** $\\frac{d}{dt}u_{i}(t) + a\\,\\mathcal{D}_{1} u_{i}(t) = -\\mu\\,\\mathcal{D}_{4} u_{i}(t)$。\n-   **一阶导数算子 $\\mathcal{D}_1$：** 一个中心的、反对称的 $2m+1$ 点格式，$\\mathcal{D}_{1} u_{i} = \\frac{1}{h}\\sum_{k=-m}^{m}\\alpha_{k}\\,u_{i+k}$，其中 $\\alpha_{-k} = -\\alpha_{k}$ 且 $\\alpha_{0}=0$。\n-   **四阶导数算子 $\\mathcal{D}_4$：** 一个中心的、对称的 $2n+1$ 点格式，$\\mathcal{D}_{4} u_{i} = \\frac{1}{h^{4}}\\sum_{k=-n}^{n}\\beta_{k}\\,u_{i+k}$，其中 $\\beta_{-k} = \\beta_{k}$。\n-   **精度要求：** 半离散格式的等效 PDE 必须与目标 PDE 匹配，直到并包括 $O(h^4)$ 阶项，且没有 $O(h^2)$ 或 $O(h^3)$ 阶的伪项。\n-   **目标：** 找到最小半宽 $m$ 和 $n$ 以及相应的格式系数。\n\n**验证：**\n-   **科学依据：** 该问题是 PDE 数值分析中的一个标准练习，特别是使用修正方程分析来设计高阶有限差分格式。该 PDE 是一个线性平流-超扩散方程，是一个有效的物理模型。\n-   **适定性：** 该问题对格式系数规定了明确的约束，从而导出一个适定的线性方程组。对最小格式宽度的要求确保了唯一解的存在。\n-   **客观性与完备性：** 该问题以精确的数学语言表述，并提供了所有必要的信息。\n\n**结论：** 该问题是有效的。\n\n### 步骤 2：修正方程分析\n\n我们对算子 $\\mathcal{D}_1$ 和 $\\mathcal{D}_4$ 应用泰勒级数展开来确定修正方程。对于一个足够光滑的函数 $u(x,t)$，我们在 $x_i$ 周围展开 $u(x_i+kh, t)$：\n$$u_{i+k} = u(x_i + kh) = \\sum_{j=0}^{\\infty} \\frac{(kh)^j}{j!} \\frac{\\partial^j u}{\\partial x^j}\\bigg|_{x_i}$$\n\n**$\\mathcal{D}_1$ 的分析：**\n将泰勒级数代入 $\\mathcal{D}_1$ 的定义中：\n$$\\mathcal{D}_{1} u_{i} = \\frac{1}{h} \\sum_{k=-m}^{m} \\alpha_{k} \\sum_{j=0}^{\\infty} \\frac{(kh)^j}{j!} u^{(j)} = \\sum_{j=0}^{\\infty} \\frac{h^{j-1}}{j!} \\left(\\sum_{k=-m}^{m} k^j \\alpha_k\\right) u^{(j)}$$\n其中 $u^{(j)} = \\partial^j u/\\partial x^j$。令 $C_j(\\alpha) = \\sum_{k=-m}^{m} k^j \\alpha_k$。由于反对称约束 $\\alpha_{-k} = -\\alpha_k$ 和 $\\alpha_0=0$，矩 $C_j(\\alpha)$ 仅在 $j$ 为奇数时非零。具体来说，当 $j$ 为奇数时，$C_j(\\alpha) = 2\\sum_{k=1}^{m} k^j \\alpha_k$；当 $j$ 为偶数时，$C_j(\\alpha)=0$。\n$\\mathcal{D}_1 u_{i}$ 的展开式变为：\n$$\\mathcal{D}_{1} u_{i} = C_1(\\alpha) u^{(1)} + \\frac{h^2}{6} C_3(\\alpha) u^{(3)} + \\frac{h^4}{120} C_5(\\alpha) u^{(5)} + O(h^6)$$\n为与 $\\partial_x$ 保持一致性，我们要求 $C_1(\\alpha)=1$。\n\n**$\\mathcal{D}_4$ 的分析：**\n类似地，对于 $\\mathcal{D}_4$：\n$$\\mathcal{D}_{4} u_{i} = \\frac{1}{h^4} \\sum_{k=-n}^{n} \\beta_{k} \\sum_{j=0}^{\\infty} \\frac{(kh)^j}{j!} u^{(j)} = \\sum_{j=0}^{\\infty} \\frac{h^{j-4}}{j!} \\left(\\sum_{k=-n}^{n} k^j \\beta_k\\right) u^{(j)}$$\n令 $D_j(\\beta) = \\sum_{k=-n}^{n} k^j \\beta_k$。由于对称约束 $\\beta_{-k} = \\beta_k$，矩 $D_j(\\beta)$ 仅在 $j$ 为偶数时非零。具体来说，$D_0(\\beta)=\\beta_0+2\\sum_{k=1}^n \\beta_k$ 且当 $j0$ 且为偶数时，$D_j(\\beta) = 2\\sum_{k=1}^{n} k^j \\beta_k$。当 $j$ 为奇数时，$D_j(\\beta)=0$。\n$\\mathcal{D}_4 u_{i}$ 的展开式变为：\n$$\\mathcal{D}_{4} u_{i} = \\frac{D_0(\\beta)}{h^4} u + \\frac{D_2(\\beta)}{2h^2} u^{(2)} + \\frac{D_4(\\beta)}{24} u^{(4)} + \\frac{h^2 D_6(\\beta)}{720} u^{(6)} + \\frac{h^4 D_8(\\beta)}{40320} u^{(8)} + O(h^6)$$\n为与 $\\partial_x^4$ 保持一致性，我们必须消除低阶导数项并匹配 $u^{(4)}$ 项。这要求 $D_0(\\beta)=0$，$D_2(\\beta)=0$ 以及 $D_4(\\beta)=24$。\n\n**构建修正方程：**\n设 $v(x,t)$ 是一个代表半离散格式解的光滑函数。其演化由修正方程决定，该方程通过将泰勒展开代入格式得到：\n$$\\frac{\\partial v}{\\partial t} + a \\left(C_1 v^{(1)} + \\frac{h^2}{6}C_3 v^{(3)} + \\dots\\right) = -\\mu \\left(\\frac{D_4}{24} v^{(4)} + \\frac{h^2 D_6}{720} v^{(6)} + \\dots\\right)$$\n强制一致性条件 ($C_1=1, D_4=24, D_0=0, D_2=0$)，并重新整理得到：\n$$v_t + a v_x + \\mu v_{xxxx} = -h^2 \\left( a\\frac{C_3(\\alpha)}{6} v^{(3)} + \\mu\\frac{D_6(\\beta)}{720} v^{(6)} \\right) - h^4 \\left( a\\frac{C_5(\\alpha)}{120} v^{(5)} + \\mu\\frac{D_8(\\beta)}{40320} v^{(8)} \\right) + O(h^6)$$\n问题要求“没有 $O(h^2)$ 或 $O(h^3)$ 阶的伪项”。由于采用中心格式，$O(h^3)$ 阶项自然为零。为了使 $O(h^2)$ 阶项对任何解 $v$ 都消失，它们的系数必须为零：\n$$C_3(\\alpha) = 0 \\quad \\text{和} \\quad D_6(\\beta) = 0$$\n这些条件与一致性条件相结合，确保了格式的截断误差为 $O(h^4)$。修正方程与目标 PDE 的匹配精度达到 $O(h^3)$ 阶。差异项为 $O(h^4)$，因此该格式是四阶精确的。这满足了问题的精度要求，即要求一个四阶格式。\n\n### 步骤 3：计算格式系数\n\n**$\\mathcal{D}_1$ 的系数：**\n我们需要找到满足以下条件的最小 $m$ 和系数 $\\{\\alpha_k\\}$：\n1.  $C_1(\\alpha) = 2\\sum_{k=1}^{m} k \\alpha_k = 1 \\implies \\sum_{k=1}^{m} k \\alpha_k = 1/2$\n2.  $C_3(\\alpha) = 2\\sum_{k=1}^{m} k^3 \\alpha_k = 0 \\implies \\sum_{k=1}^{m} k^3 \\alpha_k = 0$\n对于 $m=1$，这是不可能的。我们尝试最小情况 $m=2$，这给出了一个关于 $\\alpha_1, \\alpha_2$ 的二元方程组：\n$$\\begin{cases} \\alpha_1 + 2\\alpha_2 = 1/2 \\\\ \\alpha_1 + 8\\alpha_2 = 0 \\end{cases}$$\n第二个方程减去第一个方程得到 $6\\alpha_2 = -1/2$，所以 $\\alpha_2 = -1/12$。代回可得 $\\alpha_1 = -8\\alpha_2 = -8(-1/12) = 2/3$。\n系数为：$\\alpha_1 = 2/3$, $\\alpha_2 = -1/12$。根据反对称性，$\\alpha_{-1} = -2/3$ 且 $\\alpha_{-2} = 1/12$，而 $\\alpha_0=0$。这对应于最小半宽 $m=2$。\n\n**$\\mathcal{D}_4$ 的系数：**\n我们需要找到满足以下条件的最小 $n$ 和系数 $\\{\\beta_k\\}$：\n1.  $D_0(\\beta) = \\beta_0 + 2\\sum_{k=1}^{n} \\beta_k = 0$\n2.  $D_2(\\beta) = 2\\sum_{k=1}^{n} k^2 \\beta_k = 0 \\implies \\sum_{k=1}^{n} k^2 \\beta_k = 0$\n3.  $D_4(\\beta) = 2\\sum_{k=1}^{n} k^4 \\beta_k = 24 \\implies \\sum_{k=1}^{n} k^4 \\beta_k = 12$\n4.  $D_6(\\beta) = 2\\sum_{k=1}^{n} k^6 \\beta_k = 0 \\implies \\sum_{k=1}^{n} k^6 \\beta_k = 0$\n对于 $n3$，该系统是超定的。我们尝试最小情况 $n=3$，这给出了一个关于 $\\beta_1, \\beta_2, \\beta_3$ 的三元方程组：\n$$\\begin{cases} \\beta_1 + 4\\beta_2 + 9\\beta_3 = 0 \\\\ \\beta_1 + 16\\beta_2 + 81\\beta_3 = 12 \\\\ \\beta_1 + 64\\beta_2 + 729\\beta_3 = 0 \\end{cases}$$\n方程相减得到：\n- (方程 2) - (方程 1) $\\implies 12\\beta_2 + 72\\beta_3 = 12 \\implies \\beta_2 + 6\\beta_3 = 1$\n- (方程 3) - (方程 2) $\\implies 48\\beta_2 + 648\\beta_3 = -12 \\implies 4\\beta_2 + 54\\beta_3 = -1$\n将 $\\beta_2 = 1-6\\beta_3$ 代入第二个简化后的方程：\n$4(1-6\\beta_3) + 54\\beta_3 = -1 \\implies 4 - 24\\beta_3 + 54\\beta_3 = -1 \\implies 30\\beta_3 = -5 \\implies \\beta_3 = -1/6$。\n然后 $\\beta_2 = 1 - 6(-1/6) = 1+1 = 2$。\n并且 $\\beta_1 = -4\\beta_2 - 9\\beta_3 = -4(2) - 9(-1/6) = -8 + 3/2 = -13/2$。\n最后，我们从 $D_0=0$ 求出 $\\beta_0$：\n$\\beta_0 = -2(\\beta_1+\\beta_2+\\beta_3) = -2(-13/2 + 2 - 1/6) = -2(-39/6 + 12/6 - 1/6) = -2(-28/6) = 28/3$。\n系数为：$\\beta_1 = -13/2$，$\\beta_2 = 2$，$\\beta_3 = -1/6$，以及 $\\beta_0=28/3$。根据对称性，$\\beta_{-k}=\\beta_k$。这对应于最小半宽 $n=3$。\n\n最小半宽为 $m=2$ 和 $n=3$。\n\n### 步骤 4：最终答案构建\n所需系数的向量为 $[\\alpha_{-2},\\,\\alpha_{-1},\\,\\alpha_{0},\\,\\alpha_{1},\\,\\alpha_{2},\\,\\beta_{-3},\\,\\beta_{-2},\\,\\beta_{-1},\\,\\beta_{0},\\,\\beta_{1},\\,\\beta_{2},\\,\\beta_{3}]$。\n- $\\alpha_{-2} = -\\alpha_2 = 1/12$\n- $\\alpha_{-1} = -\\alpha_1 = -2/3$\n- $\\alpha_0 = 0$\n- $\\alpha_1 = 2/3$\n- $\\alpha_2 = -1/12$\n- $\\beta_{-3} = \\beta_3 = -1/6$\n- $\\beta_{-2} = \\beta_2 = 2$\n- $\\beta_{-1} = \\beta_1 = -13/2$\n- $\\beta_0 = 28/3$\n- $\\beta_1 = -13/2$\n- $\\beta_2 = 2$\n- $\\beta_3 = -1/6$\n\n最终的行向量是：\n$[\\frac{1}{12}, -\\frac{2}{3}, 0, \\frac{2}{3}, -\\frac{1}{12}, -\\frac{1}{6}, 2, -\\frac{13}{2}, \\frac{28}{3}, -\\frac{13}{2}, 2, -\\frac{1}{6}]$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{12}  -\\frac{2}{3}  0  \\frac{2}{3}  -\\frac{1}{12}  -\\frac{1}{6}  2  -\\frac{13}{2}  \\frac{28}{3}  -\\frac{13}{2}  2  -\\frac{1}{6}\n\\end{pmatrix}\n}\n$$", "id": "3422594"}]}