{"hands_on_practices": [{"introduction": "修正方程分析是揭示数值格式内在行为的强大工具。它通过将离散格式泰勒展开，得到一个等效的、包含高阶导数项的偏微分方程，从而揭示格式的截断误差如何表现为物理上的耗散或色散。本练习将引导你运用修正方程来估算一阶迎风格式在求解伯格斯方程时产生的数值激波厚度，从而将抽象的理论分析与可观察到的数值现象联系起来，深刻理解数值粘性的起源及其对解的影响 [@problem_id:3364595]。", "problem": "考虑实数轴上的无量纲无粘性伯格斯方程 $u_{t} + \\left(\\frac{1}{2} u^{2}\\right)_{x} = 0$，其黎曼初值数据为：当 $x0$ 时，$u(x,0) = u_{L}$；当 $x0$ 时，$u(x,0)=u_{R}$，其中 $u_{L}  u_{R}  0$。该解包含一个满足熵条件的激波，其 Rankine–Hugoniot 速度为 $s$。该方程在间距为 $\\Delta x$ 的均匀网格上使用一阶迎风（施主单元）守恒格式进行离散化，并选择前向欧拉时间步长 $\\Delta t$ 以满足基于最大特征速度的 Courant–Friedrichs–Lewy (CFL) 数 $C$，即 $C = \\max_{x} |u(x,t)| \\, \\Delta t / \\Delta x$。\n\n假设以下数值参数和状态：$u_{L} = 2$，$u_{R} = 1$，$\\Delta x = 0.005$，$C = 0.8$。使用主阶修正方程分析，该分析在激波中心的常数状态附近对格式进行局部线性化，然后与粘性伯格斯方程 $u_{t} + u u_{x} = \\nu u_{xx}$ 的稳态行波约化进行匹配，估算完全由格式的数值耗散引起的内在激波厚度 $\\delta$。将 $\\delta$ 定义为从激波附着坐标系中的行波剖面获得的特征长度尺度，即双曲正切剖面中乘以相似变量的系数的倒数。陈述您引入的任何中间符号，在最终数值计算前保持其符号形式，并假设时间步长 $\\Delta t$ 是由 $C$ 使用最大特征速度 $u_{L}$ 设定的。\n\n计算 $\\delta$ 的最终数值，并将您的答案四舍五入到四位有效数字。将最终值表示为一个纯数（无量纲）。", "solution": "我们从守恒形式的无粘性伯格斯方程 $u_{t} + f(u)_{x} = 0$ 开始，其中 $f(u) = \\frac{1}{2} u^{2}$。在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格 $\\{x_{i}\\}$ 上，一阶迎风（施主单元）格式在特征速度 $f'(u)$ 为正的区域可以写为\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(f(u_{i}^{n}) - f(u_{i-1}^{n})\\right), \\quad \\lambda := \\frac{\\Delta t}{\\Delta x}.\n$$\n我们通过在局部常数状态 $u_{0}$ 附近对格式进行泰勒展开并保留 $\\Delta x$ 的主阶项来分析修正方程。关键的基础步骤是：\n- 在 $u_{0}$ 附近将通量线性化：$f(u) \\approx f(u_{0}) + f'(u_{0}) (u - u_{0})$。\n- 在此局部线性化中，该格式简化为线性平流方程 $v_{t} + a v_{x} = 0$ 的迎风格式，其中 $a = f'(u_{0})$。\n- 应用于 $v_{t} + a v_{x} = 0$ 的一阶迎风格式的经典修正方程是（来自关于光滑解在空间和时间上的泰勒展开）\n$$\nv_{t} + a v_{x} = \\frac{a \\, \\Delta x}{2} \\left(1 - a \\lambda \\right) v_{xx} + \\mathcal{O}(\\Delta x^{2}).\n$$\n回到非线性问题，这确定了在局部常数状态 $u_{0}$ 处（其中 $a = f'(u_{0}) = u_{0}$）评估的主阶数值粘性系数为\n$$\n\\nu_{\\text{num}}(u_{0}) = \\frac{1}{2} \\, a \\, \\Delta x \\, \\left(1 - a \\lambda\\right) = \\frac{1}{2} \\, u_{0} \\, \\Delta x \\, \\left(1 - u_{0} \\lambda\\right).\n$$\n\n接下来，为了估算由该数值粘性引起的激波厚度，我们将其与粘性伯格斯方程匹配\n$$\nu_{t} + u \\, u_{x} = \\nu \\, u_{xx},\n$$\n其中我们将在激波中心处评估的 $\\nu_{\\text{num}}$ 设为 $\\nu$。在以激波速度 $s$ 运动的坐标系中，行波约化使用相似变量 $\\xi = x - s t$，得到满足以下条件的稳态剖面 $u(\\xi)$\n$$\n- s \\, \\frac{d u}{d \\xi} + u \\, \\frac{d u}{d \\xi} = \\nu \\, \\frac{d^{2} u}{d \\xi^{2}} \\quad \\Rightarrow \\quad \\nu \\, \\frac{d^{2} u}{d \\xi^{2}} = \\left(u - s\\right) \\frac{d u}{d \\xi}.\n$$\n假设末端状态 $u_{L}$ 和 $u_{R}$ 之间存在单调连接，使用链式法则 $\\frac{d^{2} u}{d \\xi^{2}} = \\frac{d}{d \\xi}\\left(\\frac{d u}{d \\xi}\\right) = \\frac{d}{d u}\\left(\\frac{d u}{d \\xi}\\right) \\frac{d u}{d \\xi}$ 积分一次，得到\n$$\n\\nu \\, \\frac{d}{d u}\\left(\\frac{d u}{d \\xi}\\right) = u - s.\n$$\n对 $u$ 积分，并使用远场条件 $u'(\\xi) \\to 0$ 当 $\\xi \\to \\pm \\infty$ 时确定积分常数，可以得到标准的第一积分\n$$\n\\nu \\, \\frac{d u}{d \\xi} = \\frac{1}{2} \\left(u - u_{L}\\right) \\left(u - u_{R}\\right),\n$$\n其中 Rankine–Hugoniot 速度为 $s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{u_{L} + u_{R}}{2}$。分离变量法表明，该剖面是一个双曲正切函数，\n$$\nu(\\xi) = s - \\frac{\\Delta u}{2} \\, \\tanh\\!\\left( \\frac{\\Delta u}{4 \\nu} \\left(\\xi - \\xi_{0}\\right)\\right), \\quad \\Delta u := u_{L} - u_{R},\n$$\n因此，在 $\\tanh$ 的自变量中乘以 $\\xi$ 的系数为 $K = \\frac{\\Delta u}{4 \\nu}$。根据所述定义，内在激波厚度是该系数的倒数，\n$$\n\\delta := \\frac{1}{K} = \\frac{4 \\nu}{\\Delta u}.\n$$\n\n我们现在将其具体化到激波中心的数值粘性。行波的对称性意味着对于伯格斯方程，激波中心的状态等于 Rankine–Hugoniot 速度，即\n$$\nu_{0} = s = \\frac{u_{L} + u_{R}}{2}.\n$$\n时间步长由基于最大特征速度 $u_{L}$ 的 Courant–Friedrichs–Lewy (CFL) 条件选择：\n$$\nC = \\max |u| \\, \\frac{\\Delta t}{\\Delta x} = u_{L} \\, \\frac{\\Delta t}{\\Delta x} \\quad \\Rightarrow \\quad \\lambda = \\frac{\\Delta t}{\\Delta x} = \\frac{C}{u_{L}}.\n$$\n因此，\n$$\n\\nu_{\\text{num}}(u_{0}) = \\frac{1}{2} \\, u_{0} \\, \\Delta x \\, \\left(1 - u_{0} \\lambda \\right) \n= \\frac{1}{2} \\, s \\, \\Delta x \\left(1 - s \\, \\frac{C}{u_{L}}\\right).\n$$\n因此，内在厚度的估计值为\n$$\n\\delta = \\frac{4 \\, \\nu_{\\text{num}}(u_{0})}{\\Delta u} \n= \\frac{4}{\\Delta u} \\cdot \\frac{1}{2} \\, s \\, \\Delta x \\left(1 - s \\, \\frac{C}{u_{L}}\\right)\n= \\frac{2 s \\, \\Delta x}{\\Delta u} \\left(1 - \\frac{s C}{u_{L}}\\right).\n$$\n\n代入给定值 $u_{L} = 2$，$u_{R} = 1$，$\\Delta x = 0.005$ 和 $C = 0.8$：\n- $\\Delta u = u_{L} - u_{R} = 2 - 1 = 1$,\n- $s = \\frac{u_{L} + u_{R}}{2} = \\frac{2 + 1}{2} = \\frac{3}{2} = 1.5$,\n- $\\lambda = \\frac{C}{u_{L}} = \\frac{0.8}{2} = 0.4$,\n- $s \\lambda = 1.5 \\times 0.4 = 0.6$,\n- $\\nu_{\\text{num}} = \\frac{1}{2} \\times 1.5 \\times 0.005 \\times (1 - 0.6) = 0.75 \\times 0.005 \\times 0.4 = 0.00375 \\times 0.4 = 0.0015$,\n- $\\delta = \\frac{4 \\times 0.0015}{1} = 0.006$.\n\n四舍五入到四位有效数字，我们得到 $\\delta = 0.006000$，我们用科学记数法表示为 $6.000 \\times 10^{-3}$。", "answer": "$$\\boxed{6.000 \\times 10^{-3}}$$", "id": "3364595"}, {"introduction": "傅里叶分析（或冯·诺依曼分析）是研究线性数值格式稳定性和耗散-色散特性的核心方法。通过考察不同波数的离散傅里叶模态在时间演化中的振幅和相位的变化，我们可以精确了解数值格式如何影响解中不同尺度的分量。本练习将演示如何通过分析鲁萨诺夫通量的耗散率与波数的关系，来设计其数值耗散参数，以达到有效抑制不必要的高频数值振荡，同时精确保持解中关键低频物理特征的目的 [@problem_id:3364611]。", "problem": "考虑在间距为 $\\Delta x$ 的均匀网格上的线性常系数偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a0$ 为常数。使用守恒有限体积半离散化方法，并采用 Rusanov 通量（也称为局部 Lax–Friedrichs (LLF) 通量），其在每个单元交界面的定义为\n$$\nF_{i+\\frac{1}{2}} = \\frac{a}{2}\\left(u_{i} + u_{i+1}\\right) - \\frac{C}{2}\\left(u_{i+1} - u_{i}\\right),\n$$\n其中 $C0$ 是一个恒定的数值耗散速度。半离散有限体积更新方程为\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right).\n$$\n通过代入离散 Fourier 模 $u_{i}(t) = \\hat{u}(t)\\,\\exp\\!\\left(i k x_{i}\\right)$（其中 $x_{i} = i\\,\\Delta x$）来进行 Fourier (von Neumann) 分析，以获得半离散算子的符号 $\\lambda(k)$，并定义依赖于波数的耗散率 $\\sigma(k)$ 为 $\\sigma(k) = -\\mathrm{Re}\\,\\lambda(k)$。推导从 $k$ 到 $\\sigma(k)$ 的闭式映射，用 $C$ 和 $\\Delta x$ 表示。\n\n然后，设计数值耗散参数 $C$，使其在单个时间增量 $\\Delta t0$ 内满足以下目标：\n- 在半离散演化下，经过 $\\Delta t$ 时间，最高可分辨离散波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$ 的振幅必须衰减为原来的 $1/2$，即其振幅乘子等于 $\\exp\\!\\left(-\\sigma(k_{\\mathrm{N}})\\,\\Delta t\\right) = 1/2$。\n- 在相同的时间增量内，低波数模 $k_{\\mathrm{L}} = \\pi/(5\\,\\Delta x)$ 的振幅必须保持在不低于原振幅的 $0.93$ 倍，即其振幅乘子满足 $\\exp\\!\\left(-\\sigma(k_{\\mathrm{L}})\\,\\Delta t\\right) \\geq 0.93$。\n\n假设这样的选择是可行的，请为满足高波数阻尼目标的最小常数 $C$ 提供一个单一的符号表达式。用 $\\Delta x$ 和 $\\Delta t$ 表示最终的 $C$。如果您之后选择计算数值，请将速度 $C$ 以米/秒为单位表示。不要代入数值。最终答案必须是单一的闭式表达式。", "solution": "第一步是推导半离散算子的符号。半离散有限体积格式由下式给出：\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)\n$$\n在交界面 $i+1/2$ 处的 Rusanov 通量为：\n$$\nF_{i+\\frac{1}{2}} = \\frac{a}{2}\\left(u_{i} + u_{i+1}\\right) - \\frac{C}{2}\\left(u_{i+1} - u_{i}\\right)\n$$\n在交界面 $i-1/2$ 处为：\n$$\nF_{i-\\frac{1}{2}} = \\frac{a}{2}\\left(u_{i-1} + u_{i}\\right) - \\frac{C}{2}\\left(u_{i} - u_{i-1}\\right)\n$$\n那么通量差为：\n$$\nF_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} = \\left[ \\frac{a}{2}\\left(u_{i} + u_{i+1}\\right) - \\frac{C}{2}\\left(u_{i+1} - u_{i}\\right) \\right] - \\left[ \\frac{a}{2}\\left(u_{i-1} + u_{i}\\right) - \\frac{C}{2}\\left(u_{i} - u_{i-1}\\right) \\right]\n$$\n按常数 $a$ 和 $C$ 对各项进行分组：\n$$\nF_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} = \\frac{a}{2}\\left(u_{i+1} - u_{i-1}\\right) - \\frac{C}{2}\\left(u_{i+1} - 2u_{i} + u_{i-1}\\right)\n$$\n将此代入半离散更新方程：\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x} \\left[ \\frac{a}{2}\\left(u_{i+1} - u_{i-1}\\right) - \\frac{C}{2}\\left(u_{i+1} - 2u_{i} + u_{i-1}\\right) \\right]\n$$\n现在我们进行 Fourier 分析，代入离散 Fourier 模 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i k x_{j})$，其中 $x_{j} = j\\,\\Delta x$，指数中的 $i$ 表示虚数单位。索引 $j$ 可以是 $i$ 本身，或者是 $i-1$ 或 $i+1$。对于特定的网格点 $i$，我们有 $u_i(t) = \\hat{u}(t)\\exp(ik(i\\Delta x))$。时间导数变为 $\\frac{d u_{i}}{d t} = \\frac{d \\hat{u}}{d t} \\exp(ik(i\\Delta x))$。模板点之间的关系如下：\n$$\nu_{i+1} = \\hat{u}(t)\\exp(ik((i+1)\\Delta x)) = u_{i}(t) \\exp(ik\\Delta x)\n$$\n$$\nu_{i-1} = \\hat{u}(t)\\exp(ik((i-1)\\Delta x)) = u_{i}(t) \\exp(-ik\\Delta x)\n$$\n将这些关系代入空间差分：\n$$\nu_{i+1} - u_{i-1} = u_{i} (\\exp(ik\\Delta x) - \\exp(-ik\\Delta x)) = u_{i} (2i \\sin(k\\Delta x))\n$$\n$$\nu_{i+1} - 2u_{i} + u_{i-1} = u_{i} (\\exp(ik\\Delta x) - 2 + \\exp(-ik\\Delta x)) = u_{i} (2\\cos(k\\Delta x) - 2) = -4u_{i}\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n将这些代回半离散方程：\n$$\n\\frac{d \\hat{u}}{d t} \\exp(ik(i\\Delta x)) = -\\frac{u_{i}}{\\Delta x} \\left[ \\frac{a}{2}(2i \\sin(k\\Delta x)) - \\frac{C}{2}(-4\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)) \\right]\n$$\n用 $\\hat{u}\\exp(ik(i\\Delta x))$ 替换 $u_i$ 并化简，可以消去指数项：\n$$\n\\frac{d \\hat{u}}{d t} = -\\frac{\\hat{u}}{\\Delta x} \\left[ i a \\sin(k\\Delta x) + 2C\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\right]\n$$\n该方程具有形式 $\\frac{d\\hat{u}}{dt} = \\lambda(k)\\hat{u}$，其中 $\\lambda(k)$ 是半离散算子的符号：\n$$\n\\lambda(k) = -\\frac{1}{\\Delta x} \\left[ 2C\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) + i a \\sin(k\\Delta x) \\right]\n$$\n依赖于波数的耗散率 $\\sigma(k)$ 定义为符号实部的相反数：\n$$\n\\sigma(k) = -\\mathrm{Re}(\\lambda(k)) = - \\left( -\\frac{2C}{\\Delta x} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\right) = \\frac{2C}{\\Delta x} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n这就是耗散率的闭式映射。\n\n接下来，我们设计数值耗散参数 $C$。第一个条件是最高可分辨波数，即 Nyquist 波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$，在时间步长 $\\Delta t$ 内必须衰减为原来的 $1/2$。振幅乘子为 $\\exp(-\\sigma(k)\\Delta t)$。\n对于 $k = k_{\\mathrm{N}}$，$\\sigma(k)$ 中正弦函数的参数为：\n$$\n\\frac{k_{\\mathrm{N}}\\Delta x}{2} = \\frac{(\\pi/\\Delta x)\\Delta x}{2} = \\frac{\\pi}{2}\n$$\n因此，该波数下的耗散率为：\n$$\n\\sigma(k_{\\mathrm{N}}) = \\frac{2C}{\\Delta x} \\sin^2\\left(\\frac{\\pi}{2}\\right) = \\frac{2C}{\\Delta x} (1)^2 = \\frac{2C}{\\Delta x}\n$$\n阻尼条件为：\n$$\n\\exp(-\\sigma(k_{\\mathrm{N}})\\Delta t) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\sigma(k_{\\mathrm{N}})\\Delta t = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n\\sigma(k_{\\mathrm{N}})\\Delta t = \\ln(2)\n$$\n代入 $\\sigma(k_{\\mathrm{N}})$ 的表达式：\n$$\n\\left(\\frac{2C}{\\Delta x}\\right)\\Delta t = \\ln(2)\n$$\n解出 $C$ 得到一个唯一值：\n$$\nC = \\frac{\\Delta x \\ln(2)}{2 \\Delta t}\n$$\n这就是所要求的 $C$ 的符号表达式。$C$ 的单位是 $\\Delta x$ 的单位除以 $\\Delta t$ 的单位，即速度，符合要求。\n\n问题要求通过检验低波数模 $k_{\\mathrm{L}} = \\pi/(5\\Delta x)$ 的保持情况来检查此 $C$ 值的可行性。振幅乘子必须至少为 $0.93$。\n对于 $k = k_{\\mathrm{L}}$，正弦函数的参数为：\n$$\n\\frac{k_{\\mathrm{L}}\\Delta x}{2} = \\frac{(\\pi/(5\\Delta x))\\Delta x}{2} = \\frac{\\pi}{10}\n$$\n该波数下的耗散率为：\n$$\n\\sigma(k_{\\mathrm{L}}) = \\frac{2C}{\\Delta x} \\sin^2\\left(\\frac{\\pi}{10}\\right)\n$$\n条件为 $\\exp(-\\sigma(k_{\\mathrm{L}})\\Delta t) \\geq 0.93$。取自然对数：\n$$\n-\\sigma(k_{\\mathrm{L}})\\Delta t \\geq \\ln(0.93) \\implies \\sigma(k_{\\mathrm{L}})\\Delta t \\leq -\\ln(0.93)\n$$\n将 $C$ 和 $\\sigma(k_{\\mathrm{L}})$ 的表达式代入不等式左侧：\n$$\n\\sigma(k_{\\mathrm{L}})\\Delta t = \\left( \\frac{2}{\\Delta x} \\sin^2\\left(\\frac{\\pi}{10}\\right) \\right) \\left( \\frac{\\Delta x \\ln(2)}{2 \\Delta t} \\right) \\Delta t = \\ln(2) \\sin^2\\left(\\frac{\\pi}{10}\\right)\n$$\n我们必须检查是否满足 $\\ln(2) \\sin^2(\\pi/10) \\leq -\\ln(0.93)$。\n使用数值进行验证：$\\ln(2) \\approx 0.69315$，$\\sin(\\pi/10) = \\frac{\\sqrt{5}-1}{4} \\approx 0.30902$，所以 $\\sin^2(\\pi/10) \\approx 0.09549$。不等式左侧约等于 $0.69315 \\times 0.09549 \\approx 0.06622$。不等式右侧为 $-\\ln(0.93) \\approx -(-0.07257) = 0.07257$。不等式 $0.06622 \\leq 0.07257$ 成立。因此， $C$ 的选择是可行的，因为它满足两个条件。问题要求的是从高波数阻尼目标推导出的 $C$ 的单一符号表达式。", "answer": "$$\n\\boxed{\\frac{\\Delta x \\ln(2)}{2 \\Delta t}}\n$$", "id": "3364611"}, {"introduction": "在现代激波捕捉格式中，一个核心挑战是如何有选择性地施加人工粘性，以稳定计算同时避免污染光滑流场。不加区分地施加耗散会严重破坏解的精度，因此需要一个“智能”的激波传感器，仅在激波附近激活人工粘性。本练习将引导你基于激波（压缩）和稀疏波（膨胀）的根本运动学差异，即速度散度的符号，来设计并验证一个能够区分这两种波并减少在稀疏波中误报的改进型激波传感器 [@problem_id:3364614]。", "problem": "考虑一维可压缩欧拉方程，该方程描述了质量、动量和能量的守恒，其形式如下：\n$$\n\\partial_t \\rho + \\partial_x (\\rho u) = 0,\\quad\n\\partial_t (\\rho u) + \\partial_x (\\rho u^2 + p) = 0,\\quad\n\\partial_t E + \\partial_x \\left( (E + p) u \\right) = 0,\n$$\n其中 $\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位体积的总能量。在由这些方程控制的无粘性流中，激波产生于以负速度散度为特征的压缩运动学，而稀疏波则产生于以正速度散度为特征的膨胀运动学。人工粘性（AV）和激波传感器通常用于稳定偏微分方程（PDE）的数值解，其方法是在激波附近选择性地增加耗散，同时避免在光滑区域或稀疏波中产生耗散。\n\n假设我们在一个间距为 $\\Delta x$ 的均匀网格上，使用中心差分和周期性边界条件，定义一个离散的、基于压力梯度的激波传感器。设 $p_i$ 表示单元索引 $i$ 处的离散压力。考虑以下传感器：\n$$\nS_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon},\n$$\n其中 $\\epsilon$ 是一个小的正常数，用于防止除以零。这个 $S_i$ 是一个基于离散二阶导数与离散一阶导数之比的光滑度指示器。众所周知，它能检测到陡峭的梯度，但当分母 $\\left| p_{i+1} - p_{i-1} \\right|$ 变得很小而分子因光滑曲率保持有限值时，它可能会在稀疏扇内部伪激活。\n\n从激波在压缩（负速度散度）下形成、稀疏波在膨胀（正速度散度）下形成这一基本特征出发，设计一个修正的传感器，该传感器能抑制在稀疏波中的激活，并保留在压缩区中的激活。具体来说，通过中心差分定义离散速度散度为\n$$\nD^{(u)}_i = \\frac{u_{i+1} - u_{i-1}}{2 \\Delta x},\n$$\n并构建一个在压缩时值较大、在膨胀时值较小的门控因子。您的修正传感器应具有乘法形式\n$$\nS^{\\mathrm{corr}}_i = S_i \\cdot G_i,\n$$\n其中 $G_i$ 是 $D^{(u)}_i$ 和一个小的正常数 $\\eta$ 的无量纲函数，$\\eta$ 用于正则化 $G_i$ 以使其保持有限。您必须基于激波与压缩相关、稀疏波与膨胀相关的运动学原理来构建 $G_i$，并在您的解答中论证其构造方法。\n\n您的程序必须在均匀网格上使用周期性边界条件和中心差分来实现原始传感器 $S_i$ 和您修正后的传感器 $S^{\\mathrm{corr}}_i$，然后在几个人工合成测试场中定量评估其激活和失效模式。当 $S_i  T$ 或 $S^{\\mathrm{corr}}_i  T$ 时，索引 $i$ 处发生激活，其中 $T$ 是一个预设阈值。评估必须包括以下指标：\n1. 对于一个类激波的压缩剖面，计算限制在被识别为激波域索引内的真阳性率（一个小数）。将激波域索引定义为那些满足 $\\left| \\partial_x p \\right|$ 超过指定阈值且 $D^{(u)}_i  0$ 的索引。使用中心差分计算 $\\partial_x p$，并将激波域压力梯度阈值设为最大绝对压力梯度的一半，即\n$$\nG_{\\mathrm{shock}} = \\frac{1}{2} \\max_i \\left| \\frac{p_{i+1} - p_{i-1}}{2 \\Delta x} \\right|。\n$$\n报告 $S_i$ 和 $S^{\\mathrm{corr}}_i$ 的真阳性率。\n2. 对于一个类稀疏波的膨胀剖面，计算限制在满足 $D^{(u)}_i  0$ 的膨胀域索引内的伪激活率（一个小数）。报告 $S_i$ 和 $S^{\\mathrm{corr}}_i$ 的伪激活率。\n3. 对于一个类接触间断的剖面（压力恒定，非压力变量存在不连续），计算在整个域上 $S_i$ 和 $S^{\\mathrm{corr}}_i$ 的总体激活分数（一个小数）。\n4. 对于一个光滑的类声学正弦压力场，计算在整个域上 $S_i$ 和 $S^{\\mathrm{corr}}_i$ 的总体激活分数（一个小数）。\n\n在具有周期性边界条件的均匀网格上构建以下人工合成测试场，网格点数为 $N$，总域长度为 $L$，间距为 $\\Delta x = L / N$，对激波和稀疏波情况使用双曲正切过渡，对声学情况使用正弦波。使用下面列出的参数，所有中心差分均通过周期性邻居索引实现：\n- 网格参数：$N = 400$，$L = 1.0$，$\\Delta x = L/N$。\n- 正则化常数：$\\epsilon = 10^{-12}$，$\\eta = 10^{-8}$。\n- 激活阈值：$T = 0.8$。\n- 类激波的压缩剖面，中心位于 $x_0 = 0.5$，过渡宽度为 $w_{\\mathrm{shock}} = 0.005$，左右压力状态为 $p_L = 1.0$、$p_R = 0.1$，左右速度状态为 $u_L = 0.5$、$u_R = 0.0$。定义\n$$\np(x) = p_L - (p_L - p_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{shock}}}\\right)}{2},\\quad\nu(x) = u_L - (u_L - u_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{shock}}}\\right)}{2}。\n$$\n- 类稀疏波的膨胀剖面，中心位于 $x_0 = 0.5$，宽度为 $w_{\\mathrm{raf}} = 0.05$，左右压力状态为 $p_L = 1.0$、$p_R = 0.2$，左右速度状态为 $u_L = 0.0$、$u_R = 0.6$。定义\n$$\np(x) = p_L - (p_L - p_R)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{raf}}}\\right)}{2},\\quad\nu(x) = u_L + (u_R - u_L)\\, \\frac{1 + \\tanh\\left(\\frac{x - x_0}{w_{\\mathrm{raf}}}\\right)}{2}。\n$$\n- 类接触间断剖面：恒定压力 $p(x) = p_0$，$p_0 = 1.0$。对于此评估，不需要速度不连续，但选择一个温和的恒定速度 $u(x) = u_0$，$u_0 = 0.2$，以使 $D^{(u)}_i \\approx 0$。\n- 类声学正弦剖面：$p(x) = p_0 + A_p \\sin(k x)$，其中 $p_0 = 1.0$，$A_p = 0.01$，$k = 2 \\pi \\cdot 10$；以及 $u(x) = u_0 + A_u \\sin(k x)$，其中 $u_0 = 0.2$，$A_u = 0.02$。\n\n您的程序必须：\n- 使用上述离散化方法实现原始传感器 $S_i$ 和您修正后的传感器 $S^{\\mathrm{corr}}_i$。\n- 对每个测试场，计算指定的指标，并生成单行输出，其中包含按以下顺序排列的八个小数：\n1. 激波情况下 $S_i$ 的真阳性率，\n2. 激波情况下 $S^{\\mathrm{corr}}_i$ 的真阳性率，\n3. 稀疏波情况下 $S_i$ 的伪激活率，\n4. 稀疏波情况下 $S^{\\mathrm{corr}}_i$ 的伪激活率，\n5. 接触间断情况下 $S_i$ 的总体激活分数，\n6. 接触间断情况下 $S^{\\mathrm{corr}}_i$ 的总体激活分数，\n7. 声学情况下 $S_i$ 的总体激活分数，\n8. 声学情况下 $S^{\\mathrm{corr}}_i$ 的总体激活分数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔并用方括号括起来的结果列表（例如，$\\left[ \\mathrm{result1}, \\mathrm{result2}, \\mathrm{result3}, \\ldots \\right]$）。所有报告的量都必须是小数。", "solution": "主要任务是设计一个修正的激波传感器 $S^{\\mathrm{corr}}_i$，以减轻标准压力梯度传感器 $S_i$ 的已知失效模式，即在光滑的稀疏波中可能被伪激活。修正必须采用乘法门控因子的形式，$S^{\\mathrm{corr}}_i = S_i \\cdot G_i$。此门控因子 $G_i$ 的构造必须基于一个基本的运动学原理：激波与流体压缩（负速度散度，$\\partial_x u  0$）相关，而稀疏波与流体膨胀（正速度散度，$\\partial_x u  0$）相关。\n\n原始传感器由下式给出\n$$\nS_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon},\n$$\n其中 $p_i$ 是网格索引 $i$ 处的压力，$\\epsilon$ 是一个小的正则化常数。该传感器通过测量压力场的二阶差分与一阶差分之比来检测急剧变化。\n\n速度散度使用中心差分进行离散化，如下所示\n$$\nD^{(u)}_i = \\frac{u_{i+1} - u_{i-1}}{2 \\Delta x},\n$$\n其中 $u_i$ 是网格索引 $i$ 处的速度，$\\Delta x$ 是网格间距。\n\n为了构造门控因子 $G_i$，我们需要一个在压缩区域（$D^{(u)}_i  0$）接近 $1$ 且在膨胀区域（$D^{(u)}_i  0$）接近 $0$ 的函数。这将确保修正后的传感器 $S^{\\mathrm{corr}}_i = S_i \\cdot G_i$ 对激波“开启”，对稀疏波“关闭”。\n\n我们将 $G_i$ 定义为 $D^{(u)}_i$ 和一个小的正常数正则化常数 $\\eta$ 的函数。这种门控函数的一个合适形式是：\n$$\nG_i = \\frac{\\max(0, -D^{(u)}_i)}{|D^{(u)}_i| + \\eta}。\n$$\n让我们分析一下这个建议函数 $G_i$ 的行为：\n1.  **在压缩区域**，$D^{(u)}_i  0$。设 $D^{(u)}_i = -c$，其中 $c  0$ 代表压缩率的量值。门控因子变为\n    $$\n    G_i = \\frac{\\max(0, c)}{|-c| + \\eta} = \\frac{c}{c + \\eta}。\n    $$\n    当压缩变得强烈时（$c \\gg \\eta$），该比率接近 $1$。对于弱压缩（$c \\ll \\eta$），该因子很小。这提供了一个平滑的过渡。\n2.  **在膨胀区域**，$D^{(u)}_i  0$。分子变为 $\\max(0, -D^{(u)}_i) = 0$。因此，对于任何正的速度散度，\n    $$\n    G_i = 0。\n    $$\n    这完全抑制了传感器在膨胀流中的响应，符合要求。\n3.  **在零散度区域**，$D^{(u)}_i = 0$。门控因子也是 $G_i = 0$。\n4.  **性质**：该函数是无量綱的，因为它是具有相同时间倒数单位的量之比（假设 $\\eta$ 的单位与 $D^{(u)}_i$ 一致）。对于 $\\eta  0$，分母 $|D^{(u)}_i| + \\eta$ 始终为正，确保了表达式是良定义且有限的。\n\n$G_i$ 的这种构造直接实现了问题中指定的运动学原理。因此，最终的修正传感器定义为\n$$\nS^{\\mathrm{corr}}_i = S_i \\cdot G_i = \\frac{\\left| p_{i+1} - 2 p_i + p_{i-1} \\right|}{\\left| p_{i+1} - p_{i-1} \\right| + \\epsilon} \\cdot \\frac{\\max(0, -D^{(u)}_i)}{|D^{(u)}_i| + \\eta}。\n$$\n\n问题的后续部分要求进行数值实现，以在四个合成测试场上评估 $S_i$ 和 $S^{\\mathrm{corr}}_i$ 的性能：一个类激波剖面、一个类稀疏波剖面、一个类接触间断剖面和一个类声学剖面。评估使用特定指标：激波情况下的真阳性率、稀疏波情况下的伪激活率，以及接触和声学情况下的总体激活分数。实现将在一个 $N=400$ 个点的均匀周期性网格上进行，域长度为 $L=1.0$，使用给定的参数 $\\epsilon = 10^{-12}$、$\\eta = 10^{-8}$ 和激活阈值 $T = 0.8$。所有空间差分将使用带周期性边界条件的中心差分格式计算。最终程序将计算并输出八个指定的指标。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates an original and a corrected shock sensor\n    on four synthetic test fields, reporting eight performance metrics.\n    \"\"\"\n    # Global parameters\n    N = 400\n    L = 1.0\n    dx = L / N\n    epsilon = 1e-12\n    eta = 1e-8\n    T = 0.8\n    x = np.linspace(0, L, N, endpoint=False)\n\n    def compute_sensors(p, u):\n        \"\"\"\n        Computes the original sensor S, the corrected sensor Scorr,\n        and the discrete velocity divergence Du.\n        \"\"\"\n        # Periodic boundary conditions are handled by np.roll\n        p_plus_1 = np.roll(p, -1)\n        p_minus_1 = np.roll(p, 1)\n        u_plus_1 = np.roll(u, -1)\n        u_minus_1 = np.roll(u, 1)\n\n        # Original sensor S_i\n        num_S = np.abs(p_plus_1 - 2 * p + p_minus_1)\n        den_S = np.abs(p_plus_1 - p_minus_1) + epsilon\n        S = num_S / den_S\n\n        # Discrete velocity divergence D^(u)_i\n        Du = (u_plus_1 - u_minus_1) / (2 * dx)\n        \n        # Gating factor G_i\n        G = np.maximum(0, -Du) / (np.abs(Du) + eta)\n        \n        # Corrected sensor S^corr_i\n        Scorr = S * G\n        \n        return S, Scorr, Du\n\n    results = []\n\n    # Case 1: Shock-like compressive profile\n    x0_s, w_shock, pL_s, pR_s, uL_s, uR_s = 0.5, 0.005, 1.0, 0.1, 0.5, 0.0\n    trans_s = (1 + np.tanh((x - x0_s) / w_shock)) / 2\n    p_shock = pL_s - (pL_s - pR_s) * trans_s\n    u_shock = uL_s - (uL_s - uR_s) * trans_s\n    S_s, Scorr_s, Du_s = compute_sensors(p_shock, u_shock)\n    \n    activations_S = S_s > T\n    activations_Scorr = Scorr_s > T\n    \n    dp_dx = (np.roll(p_shock, -1) - np.roll(p_shock, 1)) / (2 * dx)\n    G_shock = 0.5 * np.max(np.abs(dp_dx))\n    shock_domain_mask = (np.abs(dp_dx) > G_shock)  (Du_s  0)\n    num_shock_domain = np.sum(shock_domain_mask)\n    \n    tpr_S = np.sum(activations_S[shock_domain_mask]) / num_shock_domain if num_shock_domain > 0 else 0.0\n    tpr_Scorr = np.sum(activations_Scorr[shock_domain_mask]) / num_shock_domain if num_shock_domain > 0 else 0.0\n    results.extend([tpr_S, tpr_Scorr])\n\n    # Case 2: Rarefaction-like expansive profile\n    x0_r, w_raf, pL_r, pR_r, uL_r, uR_r = 0.5, 0.05, 1.0, 0.2, 0.0, 0.6\n    trans_r = (1 + np.tanh((x - x0_r) / w_raf)) / 2\n    p_raf = pL_r - (pL_r - pR_r) * trans_r\n    u_raf = uL_r + (uR_r - uL_r) * trans_r\n    S_r, Scorr_r, Du_r = compute_sensors(p_raf, u_raf)\n\n    activations_S = S_r > T\n    activations_Scorr = Scorr_r > T\n\n    expansion_domain_mask = Du_r > 0\n    num_expansion_domain = np.sum(expansion_domain_mask)\n    \n    far_S = np.sum(activations_S[expansion_domain_mask]) / num_expansion_domain if num_expansion_domain > 0 else 0.0\n    far_Scorr = np.sum(activations_Scorr[expansion_domain_mask]) / num_expansion_domain if num_expansion_domain > 0 else 0.0\n    results.extend([far_S, far_Scorr])\n\n    # Case 3: Contact-like profile\n    p_contact = np.full(N, 1.0)\n    u_contact = np.full(N, 0.2)\n    S_c, Scorr_c, _ = compute_sensors(p_contact, u_contact)\n    \n    activations_S = S_c > T\n    activations_Scorr = Scorr_c > T\n    \n    af_S = np.sum(activations_S) / N\n    af_Scorr = np.sum(activations_Scorr) / N\n    results.extend([af_S, af_Scorr])\n\n    # Case 4: Acoustic-like sinusoidal profile\n    p0_a, Ap, k = 1.0, 0.01, 2 * np.pi * 10\n    u0_a, Au = 0.2, 0.02\n    p_acoustic = p0_a + Ap * np.sin(k * x)\n    u_acoustic = u0_a + Au * np.sin(k * x)\n    S_a, Scorr_a, _ = compute_sensors(p_acoustic, u_acoustic)\n\n    activations_S = S_a > T\n    activations_Scorr = Scorr_a > T\n\n    af_S = np.sum(activations_S) / N\n    af_Scorr = np.sum(activations_Scorr) / N\n    results.extend([af_S, af_Scorr])\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3364614"}]}