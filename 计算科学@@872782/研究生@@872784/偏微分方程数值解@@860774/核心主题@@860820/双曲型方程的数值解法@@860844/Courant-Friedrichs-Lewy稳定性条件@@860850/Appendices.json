{"hands_on_practices": [{"introduction": "Courant-Friedrichs-Lewy (CFL) 条件是显式时间推进格式求解双曲型偏微分方程的核心。本练习将通过对线性平流方程应用最经典的一阶迎风格式，指导您动手进行 von Neumann 稳定性分析。通过这个过程，您将推导出其精确的稳定性约束，这是理解数值色散与耗散，以及如何为显式格式选择合适时间步长的基本功 [@problem_id:3375615]。", "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，方程定义在间距为 $\\Delta x > 0$ 的均匀空间网格上，并采用步长为 $\\Delta t > 0$ 的显式时间步进。使用与 $a$ 的符号相一致的一阶迎风有限差分近似来离散化 $u_{x}$（如果 $a>0$，则为后向差分；如果 $a<0$，则为前向差分），并使用时间上的前向欧拉法来离散化 $u_{t}$。假设为空间周期性设置，因此离散傅里叶模态是可接受的。定义 Courant-Friedrichs-Lewy (CFL) 数为 $C := a\\,\\Delta t/\\Delta x$。通过考虑离散傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$（其中 $\\theta \\in \\mathbb{R}$ 是无量纲波数），对该格式进行 von Neumann (傅里叶) 稳定性分析，并推导关于 $C$ 的精确的充要稳定性约束，确保对所有波数，放大因子的模最多为 1。最后，将您的结果表示为最大允许时间步长 $\\Delta t_{\\max}$，用 $a$ 和 $\\Delta x$ 表示。请以单个闭式解析表达式的形式提供您的最终答案。无需进行数值取整。", "solution": "用户希望我解决一个问题。\n\n### 第 1 步：提取已知条件\n- **偏微分方程 (PDE)**：$u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}$ 是恒定的平流速度。\n- **网格**：间距为 $\\Delta x > 0$ 的均匀空间网格。\n- **时间步进**：显式，步长为 $\\Delta t > 0$。\n- **$u_t$ 的离散化**：时间上使用前向欧拉法，$u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$。\n- **$u_x$ 的离散化**：一阶迎风格式。\n    - 若 $a > 0$：后向差分，$u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$。\n    - 若 $a  0$：前向差分，$u_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}$。\n- **设置**：空间周期性。\n- **分析方法**：使用离散傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$ 进行 von Neumann 稳定性分析，其中 $\\theta \\in \\mathbb{R}$。\n- **定义**：Courant-Friedrichs-Lewy (CFL) 数，$C := a\\,\\Delta t/\\Delta x$。\n- **目标**：推导关于 $C$ 的精确充要稳定性约束，并将结果表示为最大允许时间步长 $\\Delta t_{\\max}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它提出了一个在偏微分方程数值分析领域中标准的、定义明确的问题。\n- **科学依据**：线性平流方程是一个基本模型方程。一阶迎风格式和 von Neumann 稳定性分析是标准的、成熟的技术。所有前提都是正确的。\n- **适定性**：问题陈述清晰，包含了推导唯一且有意义的解所需的所有信息。定义精确。\n- **客观性**：语言正式、客观，没有偏见或主观陈述。\n- **完整性**：问题是自洽的，提供了所有必需的定义和条件。没有矛盾之处。\n\n### 第 3 步：结论与行动\n问题是**有效的**。我将继续进行一个完整的、有理有据的求解。\n\n线性平流方程由下式给出\n$$\nu_t + a u_x = 0\n$$\n其中 $u(x,t)$ 是输运的量，$a$ 是恒定的平流速度，$t$ 是时间，$x$ 是空间坐标。我们在均匀网格上离散化该方程，其中 $x_j = j\\Delta x$，$t_n = n\\Delta t$。令 $u_j^n$ 表示 $u(x_j, t_n)$ 的数值近似。\n\n时间导数 $u_t$ 使用前向欧拉法近似：\n$$\nu_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n空间导数 $u_x$ 使用一阶迎风格式近似，这取决于平流速度 $a$ 的符号。\n\n**情况 1: $a > 0$**\n对于正平流速度，信息沿正 $x$ 方向传播。迎风格式对空间导数使用后向差分：\n$$\nu_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n$$\n将这些近似代入偏微分方程，得到有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n对 $u_j^{n+1}$ 进行整理，并引入 Courant-Friedrichs-Lewy (CFL) 数 $C = \\frac{a \\Delta t}{\\Delta x}$，我们得到：\n$$\nu_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n)\n$$\n由于 $a > 0$、$\\Delta t > 0$ 和 $\\Delta x > 0$，我们有 $C > 0$。\n\n为了进行 von Neumann 稳定性分析，我们将离散傅里叶模态 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ 代入格式，其中 $\\theta$ 是无量纲波数。振幅 $\\hat{u}^n$ 根据 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ 演化，其中 $G(\\theta)$ 是放大因子。\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta j) - \\hat{u}^n \\exp(i\\theta (j-1)))\n$$\n除以 $\\hat{u}^n \\exp(i\\theta j)$ (假设 $\\hat{u}^n \\neq 0$)：\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (1 - \\exp(-i\\theta))\n$$\n为使格式稳定，放大因子的模必须对所有波数 $\\theta \\in \\mathbb{R}$ 满足 $|G(\\theta)| \\le 1$。我们分析其模的平方：\n$$\n|G(\\theta)|^2 = |(1 - C) + C \\exp(-i\\theta)|^2 = |(1 - C + C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2(\\cos^2\\theta + \\sin^2\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 意味着：\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1\n$$\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\n由于对所有 $\\theta$ 都有 $(1-\\cos\\theta) \\ge 0$，该不等式简化为：\n$$\nC(1-C) \\ge 0\n$$\n鉴于我们处于 $a > 0$ 的情况，有 $C > 0$。因此，为使乘积非负，我们必须有 $1-C \\ge 0$，这意味着 $C \\le 1$。此情况下的综合稳定性条件是 $0  C \\le 1$。\n\n**情况 2: $a  0$**\n对于负平流速度，信息沿负 $x$ 方向传播。迎风格式对空间导数使用前向差分：\n$$\nu_x \\approx \\frac{u_{j+1}^n - u_j^n}{\\Delta x}\n$$\n有限差分方程是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\n$$\nu_j^{n+1} = u_j^n - C (u_{j+1}^n - u_j^n)\n$$\n由于 $a  0$，我们有 $C  0$。代入傅里叶模态 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ 得到：\n$$\n\\hat{u}^{n+1} \\exp(i\\theta j) = \\hat{u}^n \\exp(i\\theta j) - C (\\hat{u}^n \\exp(i\\theta (j+1)) - \\hat{u}^n \\exp(i\\theta j))\n$$\n除以 $\\hat{u}^n \\exp(i\\theta j)$：\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C (\\exp(i\\theta) - 1)\n$$\n模的平方是：\n$$\n|G(\\theta)|^2 = |(1+C) - C \\exp(i\\theta)|^2 = |(1+C-C\\cos\\theta) - iC\\sin\\theta|^2\n$$\n$$\n|G(\\theta)|^2 = (1+C-C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta = 1 + 2C(1+C) - 2C(1+C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 意味着：\n$$\n1 + 2C(1+C)(1-\\cos\\theta) \\le 1\n$$\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\n和之前一样，由于 $(1-\\cos\\theta) \\ge 0$，该不等式简化为：\n$$\nC(1+C) \\le 0\n$$\n鉴于我们处于 $a  0$ 的情况，有 $C  0$。因此，为使乘积非正，我们必须有 $1+C \\ge 0$，这意味着 $C \\ge -1$。此情况下的综合稳定性条件是 $-1 \\le C  0$。\n\n**综合稳定性约束**\n当 $a>0$ 时，稳定性条件是 $0  C \\le 1$；当 $a0$ 时，稳定性条件是 $-1 \\le C  0$。这两个条件可以统一。\n对于 $a > 0$，$C = \\frac{a\\Delta t}{\\Delta x} > 0$。条件 $C \\le 1$ 变为 $\\frac{a\\Delta t}{\\Delta x} \\le 1$。\n对于 $a  0$，$C = \\frac{a\\Delta t}{\\Delta x}  0$。条件 $C \\ge -1$ 变为 $\\frac{a\\Delta t}{\\Delta x} \\ge -1$，这等价于 $-\\frac{a\\Delta t}{\\Delta x} \\le 1$。\n注意到对于 $a>0$，$|a| = a$；对于 $a0$，$|a| = -a$。因此两个条件可以统一表达为一个紧凑的形式：\n$$\n\\frac{|a|\\Delta t}{\\Delta x} \\le 1\n$$\n这就是一阶迎风格式的精确充要稳定性约束。\n\n**最大允许时间步长**\n为了求得最大允许时间步长 $\\Delta t_{\\max}$，我们对稳定性不等式求解 $\\Delta t$。假设 $a \\neq 0$：\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\n因此，保证对所有波数都稳定的 $\\Delta t$ 的最大值为：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\n这个结果就是针对此特定数值格式的著名的 Courant-Friedrichs-Lewy (CFL) 条件。它表明时间步长必须足够小，以使数值格式的依赖域包含偏微分方程的依赖域。在一个时间步长内，流体质点行进的距离为 $|a|\\Delta t$，这个距离必须小于或等于一个网格间距 $\\Delta x$。", "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$", "id": "3375615"}, {"introduction": "偏微分方程的类型（双曲型、抛物型、椭圆型）深刻地影响着其数值解的稳定性要求。在分析了双曲型的平流方程后，我们将目光转向一个典型的抛物型方程——热传导方程。本练习将要求您对热传导方程的前向时间中心空间（FTCS）格式进行 von Neumann 分析，从而揭示其独特的稳定性边界 [@problem_id:3375578]。您会发现，对于显式扩散格式，最大允许时间步长 $\\Delta t$ 与空间步长的平方 $(\\Delta x)^2$ 成正比，这与平流问题中的线性关系形成了鲜明对比。", "problem": "考虑一维热方程 $u_{t} = \\nu\\, u_{xx}$，该方程定义在一个间距为 $\\Delta x$ 的无限长、均匀空间网格上，其中 $\\nu  0$ 是一个常数，代表运动粘度（或扩散系数）。在时间步长为 $\\Delta t$ 的均匀时间网格上，使用前向时间中心空间 (FTCS) 格式对时间进行离散化。对于线性常系数问题，Courant-Friedrichs-Lewy (CFL) 稳定性条件可以通过 von Neumann (傅里叶) 分析来评估，该分析要求放大因子的模对所有空间傅里叶模式都不超过1。\n\n从适用于偏微分方程数值解的基本原理出发，即在均匀网格上求解 $u_{t} = \\nu\\, u_{xx}$ 的离散 FTCS 更新公式以及在 von Neumann 分析中使用的傅里叶模式拟设，推导保证所有离散傅里叶模式有界增长的稳定性约束条件。然后，根据此条件，确定允许的最大时间步长 $\\Delta t_{\\max}$，并将其表示为关于 $\\Delta x$ 和 $\\nu$ 的闭式表达式。以单个解析表达式的形式报告您的最终答案 $\\Delta t_{\\max}$。不要提供不等式，并且在最终报告的表达式中不要包含单位。", "solution": "我们从一维热方程 $u_{t} = \\nu\\, u_{xx}$ 开始，其中 $\\nu  0$ 是一个常数。在均匀空间网格 $x_{j} = j\\,\\Delta x$ 和均匀时间网格 $t^{n} = n\\,\\Delta t$ 上，前向时间中心空间 (FTCS) 格式将该方程离散化为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\n等价地，显式更新公式为\n$$\nu_{j}^{n+1} = u_{j}^{n} + r\\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\n其中我们引入了无量纲的扩散数\n$$\nr = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\n\n为了通过 von Neumann (傅里叶) 分析来评估线性稳定性，我们考虑该格式对单个空间傅里叶模式的响应。假设解的形式为\n$$\nu_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{j}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right),\n$$\n其中 $k \\in \\mathbb{R}$ 是空间波数，$\\mathrm{i}$ 是虚数单位。将此拟设代入更新公式，我们得到\n$$\n\\hat{u}^{n+1}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + r\\left[\\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j+1)\\,\\Delta x\\right) - 2 \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j-1)\\,\\Delta x\\right)\\right].\n$$\n消去公因式 $\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right)$，得到标量递推关系\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n}\\left[1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right)\\right].\n$$\n定义放大因子 $G(k)$ 为 $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$；则\n$$\nG(k) = 1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right).\n$$\n使用恒等式 $\\exp\\!\\left(\\mathrm{i}\\,\\theta\\right) + \\exp\\!\\left(-\\mathrm{i}\\,\\theta\\right) = 2 \\cos\\!\\theta$，我们简化得到：\n$$\nG(k) = 1 + r\\left(2\\cos\\!\\left(k\\,\\Delta x\\right) - 2\\right) = 1 - 2r\\left(1 - \\cos\\!\\left(k\\,\\Delta x\\right)\\right).\n$$\n回顾三角恒等式 $1 - \\cos\\!\\theta = 2 \\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)$，得到\n$$\nG(k) = 1 - 4 r\\,\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right).\n$$\n\n对于线性常系数格式，von Neumann 稳定性要求放大因子的模对每个波数 $k$ 都不超过1，即\n$$\n|G(k)| \\leq 1 \\quad \\text{for all } k \\in \\mathbb{R}.\n$$\n由于这里的 $G(k)$ 是实数，这简化为\n$$\n-1 \\leq G(k) \\leq 1 \\quad \\text{for all } k.\n$$\n当 $k$ 变化时，函数 $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)$ 的取值范围是 $[0,1]$。最严格的界限出现在极值处。在 $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$ 和 $1$ 处计算 $G$：\n- 当 $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$ 时，我们有 $G = 1$，这对任何 $r$ 都满足界限。\n- 当 $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=1$ 时，我们有 $G = 1 - 4r$。\n\n稳定性要求 $-1 \\leq 1 - 4r \\leq 1$。右侧不等式 $1 - 4r \\leq 1$ 对 $r \\geq 0$ 是平凡成立的。左侧不等式 $-1 \\leq 1 - 4r$ 得出\n$$\n-1 \\leq 1 - 4r \\quad \\Longleftrightarrow \\quad -2 \\leq -4r \\quad \\Longleftrightarrow \\quad r \\leq \\frac{1}{2}.\n$$\n此外，对于扩散方程和显式 FTCS 格式，也要求 $r \\geq 0$ 以避免离散扩散算子中的符号反转。因此，von Neumann 稳定性条件是\n$$\n0 \\leq r \\leq \\frac{1}{2}.\n$$\n回顾 $r = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}$，允许的最大显式时间步长是\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2\\,\\nu}.\n$$\n这就是热方程 FTCS 离散化的扩散 CFL 限制条件。", "answer": "$$\\boxed{\\frac{(\\Delta x)^{2}}{2 \\nu}}$$", "id": "3375578"}, {"introduction": "CFL 条件不仅仅是一个数学推论，它有着深刻的物理内涵，即“数值依赖域必须包含物理依赖域”。为了深入理解这一原理，本练习设计了一个思想实验，要求您从几个选项中辨识出一个因违反此物理原则而注定不稳定的格式 [@problem_id:3375543]。通过分析一个错误的“顺风”格式，您将直观地看到当数值格式无法“看到”所需信息时，为何会导致解的无界增长，从而将抽象的稳定性理论与信息的物理传播联系起来。", "problem": "考虑在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，具有恒定波速 $a0$ 的线性平流方程 $u_t + a\\,u_x = 0$。其精确解沿特征线 $x(t) = x_0 + a t$ 传播，因此点 $(x_i,t_{n+1})$ 的值依赖于沿特征线从左侧 $(x_i - a \\Delta t, t_n)$ 处传来的数据。在显式有限差分方法中，单次时间更新的数值依赖域是在时间层 $t_n$ 上，用于产生 $u_i^{n+1}$ 的更新公式右侧所使用的空间节点的集合。\n\n仅使用上述定义以及线性平流方程和显式有限差分格式的第一性原理，请确定哪个选项构建了一个显式单步格式，其在 $(x_i,t_{n+1})$ 的数值依赖域未能覆盖 $a0$ 时偏微分方程的依赖域，并正确预测了这种不匹配所导致的相应不稳定性机制。令 $\\nu := a\\,\\Delta t/\\Delta x$ 表示库朗数。\n\n选择唯一的最佳选项。\n\nA. 格式和机制：\n采用时间向前和空间向前（顺风）格式进行更新，\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_{i+1}^n - u_i^n\\right).\n$$\n对于 $a0$，此格式在时间 $t_n$ 仅使用 $x_i$ 和 $x_{i+1}$，因此其数值依赖域排除了偏微分方程依赖域所需要的逆风节点 $x_{i-1}$。冯·诺依曼分析得出的放大因子为 $G(\\theta) = 1 + \\nu\\big(1 - e^{\\mathrm{i}\\theta}\\big)$，只要 $\\nu0$，对于所有 $\\theta\\neq 0$ 都有 $|G(\\theta)|1$，这意味着无条件线性不稳定。修正方程揭示了一个与 $-\\,\\tfrac{a}{2}\\,(a\\Delta t + \\Delta x)\\,u_{xx}$ 成正比的负数值粘性（反扩散）项，因此短波增长最快。\n\nB. 格式和机制：\n采用时间向前和空间向后（逆风）格式进行更新，\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_i^n - u_{i-1}^n\\right).\n$$\n对于 $a0$，此格式在时间 $t_n$ 使用 $x_i$ 和 $x_{i-1}$，因此其数值依赖域包含了偏微分方程的依赖域。在 Courant-Friedrichs-Lewy 条件 $0\\le \\nu \\le 1$ 下是线性稳定的，其数值扩散会衰减高波数。\n\nC. 格式和机制：\n采用时间向前和空间中心格式进行更新，\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\n对于 $a0$，此格式在时间 $t_n$ 使用 $x_{i-1}$、$x_i$ 和 $x_{i+1}$，因此其数值依赖域包含了偏微分方程的依赖域。然而，时间上的前向欧拉法应用于斜伴随空间算子会产生 $G(\\theta)=1-\\mathrm{i}\\nu\\sin\\theta$ 并且对于任何 $\\theta\\neq 0$ 都有 $|G(\\theta)|1$，因此是由于纯色散算子的时间离散化而导致的无条件不稳定性，而不是由于依赖域不匹配。\n\nD. 格式和机制：\n采用 Lax-Friedrichs 方法进行更新，\n$$\nu_i^{n+1} \\;=\\; \\tfrac{1}{2}\\big(u_{i+1}^n + u_{i-1}^n\\big) \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\n对于 $a0$，该格式的数值依赖域包含了偏微分方程的依赖域。由于附加的数值扩散控制了高波数，只要 $|\\nu|\\le 1$，它就是线性稳定的。\n\n哪个选项是正确的？", "solution": "用户需要对问题陈述进行批判性验证，然后是解的第一性原理推导以及对所有提供选项的评估。\n\n### 第1步：提取已知条件\n-   **偏微分方程：** 线性平流方程，$u_t + a\\,u_x = 0$。\n-   **波速：** $a$ 是一个正常数 ($a0$)。\n-   **网格：** 空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。\n-   **库朗数定义：** $\\nu := a\\,\\Delta t/\\Delta x$。\n-   **偏微分方程（PDE）依赖域：** 对于点 $(x_i, t_{n+1})$，其在前一时间层 $t_n$ 的依赖域是点 $(x_i - a \\Delta t, t_n)$。这由特征线 $x(t) = x_0 + a t$ 推导得出。\n-   **数值依赖域：** 对于显式有限差分方法，这是在时间层 $t_n$ 上用于计算节点 $x_i$ 在时间 $t_{n+1}$ 的解 $u_i^{n+1}$ 的空间节点的集合。\n-   **任务：** 确定哪个选项构建了一个显式单步格式，其在 $(x_i,t_{n+1})$ 的数值依赖域未能覆盖 $a0$ 时偏微分方程的依赖域，并正确预测了由此不匹配所导致的相应不稳定性机制。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性：** 问题基于线性平流方程和 Courant-Friedrichs-Lewy (CFL) 条件，这些都是偏微分方程数值分析中的基本概念。所有定义和原理都是标准和正确的。没有科学或事实错误。\n2.  **非形式化或不相关：** 这是一个应用数学和数值方法中的经典、可形式化的问题。它与 Courant-Friedrichs-Lewy 稳定性条件的主题直接相关。\n3.  **不完整或矛盾的设置：** 问题是自洽的。它提供了偏微分方程，定义了所有相关术语（$\\Delta x$、$\\Delta t$、$\\nu$、依赖域），并清楚地陈述了目标。没有矛盾之处。\n4.  **不切实际或不可行：** 该设置是用于教授和分析数值方法的标准模型问题。它既不不切实际，也不不可行。\n5.  **不适定或结构不良：** 问题是适定的。问题明确无误，要求根据已建立的数学分析从所提供的选项中找出一个唯一答案。\n6.  **伪深刻、琐碎或同义反复：** 问题需要对 CFL 条件、冯·诺依曼稳定性分析和修正方程分析有扎实的理解。这是一个实质性问题，不是琐碎问题。\n7.  **超出科学可验证性：** 所需的声明和分析都是数学上可验证的。\n\n### 第3步：结论和行动\n问题陈述是**有效的**。这是一个清晰、正确且自洽的数值分析问题。我将继续进行解的推导。\n\n### 从第一性原理推导\n\n控制偏微分方程是线性平流方程：\n$$u_t + a u_x = 0, \\quad a  0$$\n此方程的解 $u(x,t)$ 沿着由 $\\frac{dx}{dt} = a$ 定义的特征曲线保持不变。积分此式可得特征线 $x - at = \\text{常数}$。这意味着点 $(x_i, t_{n+1})$ 处解的值由其在更早时间 $t_n$、在穿过 $(x_i, t_{n+1})$ 的特征线与直线 $t=t_n$ 相交的点处的值决定。该点是 $(x_i - a(t_{n+1}-t_n), t_n) = (x_i - a \\Delta t, t_n)$。这就是偏微分方程的依赖域。\n\n使用库朗数 $\\nu = a \\Delta t / \\Delta x$，我们可以将该点的空间坐标表示为 $x_i - \\nu \\Delta x$。由于 $a0$, $\\Delta t  0$, 且 $\\Delta x  0$，我们有 $\\nu  0$。因此，偏微分方程的依赖域位于网格点 $x_i$ 的左侧。\n\nCourant-Friedrichs-Lewy (CFL) 条件是显式有限差分格式收敛的一个必要（但非充分）条件。它指出，格式的数值依赖域必须包含偏微分方程的依赖域。对于一个从点 $u_{i+j}^n$（其中 $j \\in \\{j_{min}, \\dots, j_{max}\\}$）计算 $u_i^{n+1}$ 的一维格式，其数值依赖域是区间 $[x_{i+j_{min}}, x_{i+j_{max}}]$。CFL 条件要求：\n$$x_{i+j_{min}} \\le x_i - a \\Delta t \\le x_{i+j_{max}}$$\n$$x_i + j_{min}\\Delta x \\le x_i - \\nu \\Delta x \\le x_i + j_{max}\\Delta x$$\n$$j_{min} \\le -\\nu \\le j_{max}$$\n由于 $\\nu  0$，这意味着为了满足 CFL 条件，格式必须至少使用一个位于 $x_i$ 左侧或在 $x_i$ 上的点（即 $j_{min} \\le 0$），并且点 $x_i - \\nu \\Delta x$ 必须位于格式点的跨度内。具体来说，一个只使用点 $\\{x_i, x_{i+1}, \\dots\\}$（即 $j_{min} \\ge 0$）的格式对于 $a0$ 将总是违反 CFL 条件，因为 $-\\nu  0$ 且 $j_{min} \\ge 0$，所以 $j_{min} \\le -\\nu$ 永远不会满足。这种格式被称为“顺风”格式，并且预计是不稳定的。\n\n我们现在必须分析每个选项，看哪一个描述了这种情况并准确解释了其后果。\n\n### 逐项分析\n\n**A. 格式和机制：时间向前和空间向前（顺风）**\n该格式是 $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$。\n-   **依赖域：** 此格式使用 $t_n$ 时刻的节点 $x_i$ 和 $x_{i+1}$ 的值来计算 $u_i^{n+1}$。数值依赖域是点集 $\\{x_i, x_{i+1}\\}$。偏微分方程的依赖域是单点 $x_i - a\\Delta t = x_i - \\nu \\Delta x$。由于 $a0$，$\\nu0$，所以该点位于 $x_i$ 的左侧。数值区域 $[x_i, x_{i+1}]$ 不包含点 $x_i - \\nu \\Delta x$。因此，对于任何 $\\nu0$，CFL 条件都被违反。该选项关于这一点的论断是正确的。\n-   **不稳定性机制（冯·诺依曼分析）：** 我们将傅里叶模式 $u_j^n = G^n e^{\\mathrm{i} j \\theta}$（其中 $\\theta = k \\Delta x$）代入格式中。\n    $$G^{n+1} e^{\\mathrm{i} i \\theta} = G^n e^{\\mathrm{i} i \\theta} - \\nu(G^n e^{\\mathrm{i} (i+1) \\theta} - G^n e^{\\mathrm{i} i \\theta})$$\n    两边除以 $G^n e^{\\mathrm{i} i \\theta}$ 得到放大因子 $G(\\theta)$:\n    $$G(\\theta) = 1 - \\nu(e^{\\mathrm{i}\\theta} - 1) = 1 - \\nu(\\cos\\theta - 1) - \\mathrm{i}\\nu\\sin\\theta$$\n    模的平方是：\n    $$|G(\\theta)|^2 = (1 - \\nu(\\cos\\theta-1))^2 + (-\\nu\\sin\\theta)^2 = 1 - 2\\nu(\\cos\\theta-1) + \\nu^2(\\cos\\theta-1)^2 + \\nu^2\\sin^2\\theta$$\n    $$|G(\\theta)|^2 = 1 + 2\\nu(1-\\cos\\theta) + \\nu^2(\\cos^2\\theta - 2\\cos\\theta + 1 + \\sin^2\\theta) = 1 + 2\\nu(1-\\cos\\theta) + \\nu^2(2 - 2\\cos\\theta)$$\n    $$|G(\\theta)|^2 = 1 + 2(\\nu + \\nu^2)(1-\\cos\\theta)$$\n    由于 $\\nu  0$ 且 $1-\\cos\\theta \\ge 0$，我们有 $|G(\\theta)|^2 \\ge 1$。对于所有 $\\theta \\neq 2m\\pi$（即对于所有非零波数），模严格大于1。这证明了对于 $\\nu0$ 该格式是无条件不稳定的。该选项对放大因子及其模的分析是正确的。\n-   **不稳定性机制（修正方程）：** 我们通过泰勒展开找到修正方程。该格式为 $\\frac{u_i^{n+1}-u_i^n}{\\Delta t} + a\\frac{u_{i+1}^n-u_i^n}{\\Delta x} = 0$。\n    $$ (u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots) + a(u_x + \\frac{\\Delta x}{2} u_{xx} + \\dots) = 0 $$\n    $$ u_t + a u_x = - \\frac{\\Delta t}{2} u_{tt} - \\frac{a \\Delta x}{2} u_{xx} + \\dots $$\n    从偏微分方程可知，$u_t \\approx -a u_x$，所以 $u_{tt} \\approx -a u_{xt} = -a(u_t)_x \\approx -a(-a u_x)_x = a^2 u_{xx}$。将其代回：\n    $$ u_t + a u_x = - \\frac{\\Delta t}{2} (a^2 u_{xx}) - \\frac{a \\Delta x}{2} u_{xx} + \\dots = -\\frac{a}{2}(a\\Delta t + \\Delta x) u_{xx} + \\dots $$\n    主导误差项的系数为 $D_{num} = -\\frac{a}{2}(a\\Delta t + \\Delta x)$。由于 $a0$，该系数为负。该项起到反扩散（或负粘性）项的作用，导致短波分量的指数级增长。该选项关于修正方程及其解释的陈述是完全正确的。\n-   **结论：** 该选项的所有部分都是正确的。它正确地识别了一个不满足CFL依赖域条件的格式，并正确解释了由此产生的不稳定性。**正确**。\n\n**B. 格式和机制：时间向前和空间向后（逆风）**\n该格式是 $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$。\n-   **依赖域：** 数值依赖域是 $\\{x_{i-1}, x_i\\}$，即区间 $[x_{i-1}, x_i]$。CFL 条件要求 $x_{i-1} \\le x_i - \\nu\\Delta x \\le x_i$。这可以简化为 $x_i - \\Delta x \\le x_i - \\nu\\Delta x$ 和 $x_i - \\nu\\Delta x \\le x_i$。第一个不等式得到 $1 \\ge \\nu$，第二个不等式对于 $\\nu0$ 总是成立。因此，如果 $0 \\le \\nu \\le 1$，则满足CFL条件。该选项正确地指出，该格式在此条件下是稳定的，并且在此范围内，数值依赖域包含偏微分方程的依赖域。\n-   这个选项描述了一个*可以*满足CFL条件并且是条件稳定的格式。它没有描述一个以*未能*覆盖依赖域为其根本缺陷的格式。\n-   **结论：** 陈述是事实正确的，但它们没有回答所提出的问题。**不正确**。\n\n**C. 格式和机制：时间向前和空间中心 (FTCS)**\n该格式是 $u_i^{n+1} = u_i^n - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n)$。\n-   **依赖域：** 数值依赖域是 $\\{x_{i-1}, x_i, x_{i+1}\\}$，即 $[x_{i-1}, x_{i+1}]$。CFL 条件要求 $x_{i-1} \\le x_i - \\nu\\Delta x \\le x_{i+1}$。这在 $|\\nu| \\le 1$ 时满足。因此对于 $0  \\nu \\le 1$，依赖域被覆盖。\n-   **不稳定性机制：** 放大因子为 $G(\\theta) = 1 - \\mathrm{i}\\nu\\sin\\theta$。其模的平方为 $|G(\\theta)|^2 = 1 + \\nu^2\\sin^2\\theta$，对于任何 $\\nu0$ 和 $\\sin\\theta \\neq 0$，该值都大于1。该格式是无条件不稳定的。\n-   该选项正确地指出了这种不稳定性，但关键在于它声明这*不是*由于依赖域不匹配造成的（至少对于 $\\nu \\le 1$）。这种不稳定性是由于将前向欧拉时间步进法应用于具有纯虚数特征值的空间离散算子而产生的。然而，问题要求的是不稳定性*源于这种不匹配*的情况。\n-   **结论：** 此选项描述了一个不稳定的格式，但其不稳定性机制与问题所要求的不同。**不正确**。\n\n**D. 格式和机制：Lax-Friedrichs 方法**\n该格式是 $u_i^{n+1} = \\tfrac{1}{2}(u_{i+1}^n + u_{i-1}^n) - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n)$。\n-   **依赖域：** 数值依赖域是 $\\{x_{i-1}, x_{i+1}\\}$，即 $[x_{i-1}, x_{i+1}]$。与FTCS一样，CFL条件在 $|\\nu| \\le 1$ 时满足。\n-   **稳定性：** 放大因子为 $G(\\theta) = \\cos\\theta - \\mathrm{i}\\nu\\sin\\theta$。其模的平方为 $|G(\\theta)|^2 = \\cos^2\\theta + \\nu^2\\sin^2\\theta = 1 + (\\nu^2 - 1)\\sin^2\\theta$。为了稳定，我们需要 $|G|^2 \\le 1$，这要求 $\\nu^2 - 1 \\le 0$，即 $|\\nu| \\le 1$。该格式是条件稳定的。\n-   这个选项描述了一个在其稳定范围内条件稳定并满足CFL条件的格式。它没有描述一个不满足依赖域条件的格式。\n-   **结论：** 陈述是事实正确的，但此选项不满足问题的标准。**不正确**。\n\n### 结论\n选项A是唯一一个正确指出了一个有限差分格式（时间向前、空间向前或“顺风”格式）的选项，对于给定的问题（$a0$），该格式的数值依赖域从根本上未能包含偏微分方程的依赖域。它还通过冯·诺依曼分析和修正方程，对由此产生的无条件不稳定性进行了完整而正确的分析，并指明其机制为反扩散。", "answer": "$$\\boxed{A}$$", "id": "3375543"}]}