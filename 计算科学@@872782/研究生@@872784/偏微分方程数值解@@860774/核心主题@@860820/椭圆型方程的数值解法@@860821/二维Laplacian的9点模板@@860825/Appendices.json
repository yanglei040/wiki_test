{"hands_on_practices": [{"introduction": "任何有限差分方法的基础都源于其核心的计算模板。本练习将引导你通过泰勒级数展开，从第一性原理出发，构建一个高阶的9点模板。通过确定模板的权重以满足特定的精度要求[@problem_id:3454092]，你将深刻理解这些数值工具是如何被设计的，以及为什么9点模板能比更简单的5点模板提供更高的精度。", "problem": "考虑在间距为 $h_x > 0$ 和 $h_y > 0$ 的矩形笛卡尔网格上近似二维拉普拉斯算子 $\\Delta u = u_{xx} + u_{yy}$。设该近似由一个以网格点 $(x_i,y_j)$ 为中心的对称 $9$ 点模板构建，使用中心点、四个轴对齐邻点和四个对角邻点的网格值。假设该模板具有以下形式\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right),\n$$\n其中 $a$、$b_x$、$b_y$ 和 $c$ 是可能依赖于 $h_x$ 和 $h_y$ 但不依赖于 $u$ 的权重。从泰勒级数展开和拉普拉斯算子的定义出发，推导权重 $a$、$b_x$、$b_y$ 和 $c$ 的显式表达式，使得：\n- 对于任意光滑函数 $u$，算子 $\\mathcal{L}_{9}[u]$ 与 $\\Delta u$ 相容（即，在主阶上精确地再现 $\\Delta u$），\n- 对于矩形网格上的一般光滑函数 $u$，截断误差为二阶精度（即 $\\mathcal{O}(h_x^{2} + h_y^{2})$），\n- 当 $h_x = h_y$ 时，主截断误差项与 $\\Delta(\\Delta u)$ 成正比，使得离散化对于满足 $\\Delta u = 0$ 的调和函数具有四阶精度。\n\n请以单个解析表达式的形式，按 $(a, b_x, b_y, c)$ 的顺序给出四个不同的权重作为最终答案。不需要数值近似或舍入。在首次出现时明确定义所使用的任何缩写，例如，偏微分方程 (Partial Differential Equation, PDE)。", "solution": "所述问题具有科学依据、良定、客观，并包含足够的信息以获得唯一解。这是偏微分方程 (Partial Differential Equations, PDE) 数值方法领域的一个标准问题。因此，该问题是有效的，我将进行完整的推导。\n\n目标是找到 $9$ 点模板算子 $\\mathcal{L}_{9}[u]$ 的权重 $a$、$b_x$、$b_y$ 和 $c$，使其近似二维拉普拉斯算子 $\\Delta u = u_{xx} + u_{yy}$。该模板由下式给出：\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right)\n$$\n为确定权重，我们将每一项 $u_{i+p,j+q}$ 在中心点 $(x_i, y_j) = (i h_x, j h_y)$ 周围进行泰勒级数展开，其中 $u_{i,j} = u(x_i, y_j)$。我们假设函数 $u(x,y)$ 足够光滑。令在 $(x_i, y_j)$ 处的偏导数用下标表示，例如，$u_{x} = \\frac{\\partial u}{\\partial x}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。\n\n为模板分组的邻点的泰勒级数展开为：\n\\begin{align*}\nu_{i+1,j} + u_{i-1,j} = 2u_{i,j} + h_x^2 u_{xx} + \\frac{h_x^4}{12} u_{xxxx} + \\frac{h_x^6}{360} u_{xxxxxx} + \\mathcal{O}(h_x^8) \\\\\nu_{i,j+1} + u_{i,j-1} = 2u_{i,j} + h_y^2 u_{yy} + \\frac{h_y^4}{12} u_{yyyy} + \\frac{h_y^6}{360} u_{yyyyyy} + \\mathcal{O}(h_y^8)\n\\end{align*}\n对于对角邻点，其和为：\n\\begin{align*}\nu_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} \\\\\n= 4u_{i,j} + 2(h_x^2 u_{xx} + h_y^2 u_{yy}) + \\frac{1}{6}(h_x^4 u_{xxxx} + 6h_x^2 h_y^2 u_{xxyy} + h_y^4 u_{yyyy}) \\\\\n+ \\frac{1}{180}(h_x^6 u_{xxxxxx} + 15h_x^4 h_y^2 u_{xxxxyy} + 15h_x^2 h_y^4 u_{xxyyyy} + h_y^6 u_{yyyyyy}) + \\mathcal{O}(h^8)\n\\end{align*}\n\n将这些展开式代入 $\\mathcal{L}_{9}[u]$ 的表达式中，并按 $u$ 的导数收集各项：\n\\begin{align*}\n\\mathcal{L}_{9}[u] = (a + 2b_x + 2b_y + 4c)u_{i,j} \\\\\n+ (b_x h_x^2 + 2c h_x^2)u_{xx} + (b_y h_y^2 + 2c h_y^2)u_{yy} \\\\\n+ \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c(h_x^2 h_y^2)u_{xxyy} \\\\\n+ \\mathcal{O}(h^6)\n\\end{align*}\n\n现在我们施加问题中给出的条件。\n第一个条件是 $\\mathcal{L}_{9}[u]$ 必须与 $\\Delta u = u_{xx} + u_{yy}$ 相容。这意味着 $\\mathcal{L}_{9}[u]$ 展开式中主导导数项的系数必须与 $\\Delta u$ 的系数相匹配，且低阶项必须为零。\n\\begin{enumerate}\n    \\item $u$ 的系数： $a + 2b_x + 2b_y + 4c = 0$\n    \\item $u_{xx}$ 的系数： $b_x h_x^2 + 2c h_x^2 = 1 \\implies b_x + 2c = \\frac{1}{h_x^2}$\n    \\item $u_{yy}$ 的系数： $b_y h_y^2 + 2c h_y^2 = 1 \\implies b_y + 2c = \\frac{1}{h_y^2}$\n\\end{enumerate}\n这三个方程关联了四个未知权重。我们可以用 $c$ 来表示 $a$、$b_x$ 和 $b_y$：\n由 (2) 得，$b_x = \\frac{1}{h_x^2} - 2c$。\n由 (3) 得，$b_y = \\frac{1}{h_y^2} - 2c$。\n将这些代入 (1) 中：\n$a + 2\\left(\\frac{1}{h_x^2} - 2c\\right) + 2\\left(\\frac{1}{h_y^2} - 2c\\right) + 4c = 0$\n$a + \\frac{2}{h_x^2} - 4c + \\frac{2}{h_y^2} - 4c + 4c = 0$\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c$。\n\n使用这些系数，截断误差 $\\mathcal{T} = \\mathcal{L}_{9}[u] - \\Delta u$ 的主项由四阶导数给出：\n$\\mathcal{T} = \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)$。\n代入 $b_x$ 和 $b_y$ 的表达式：\n$u_{xxxx}$ 的系数： $\\frac{h_x^4}{12}\\left(\\frac{1}{h_x^2} - 2c\\right) + \\frac{ch_x^4}{6} = \\frac{h_x^2}{12} - \\frac{2ch_x^4}{12} + \\frac{2ch_x^4}{12} = \\frac{h_x^2}{12}$。\n$u_{yyyy}$ 的系数： $\\frac{h_y^4}{12}\\left(\\frac{1}{h_y^2} - 2c\\right) + \\frac{ch_y^4}{6} = \\frac{h_y^2}{12} - \\frac{2ch_y^4}{12} + \\frac{2ch_y^4}{12} = \\frac{h_y^2}{12}$。\n因此，主截断误差为：\n$$\n\\mathcal{T} = \\frac{h_x^2}{12} u_{xxxx} + \\frac{h_y^2}{12} u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)\n$$\n这是 $\\mathcal{O}(h_x^2 + h_y^2)$ 阶的，满足问题的第二个条件。\n\n第三个条件提供了确定 $c$ 的方法。当 $h_x = h_y = h$ 时，主截断误差必须与施加于 $u$ 的双调和算子 $\\Delta(\\Delta u) = u_{xxxx} + 2u_{xxyy} + u_{yyyy}$ 成正比。\n在 $\\mathcal{T}$ 的表达式中令 $h_x = h_y = h$：\n$$\n\\mathcal{T}|_{h_x=h_y=h} = \\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c(h,h) h^4 u_{xxyy} + \\mathcal{O}(h^4)\n$$\n为使其与 $\\Delta(\\Delta u)$ 成正比，我们必须有：\n$$\n\\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c h^4 u_{xxyy} = K (u_{xxxx} + 2u_{xxyy} + u_{yyyy})\n$$\n对于某个比例因子 $K$。通过比较偏导数的系数：\n- $u_{xxxx}$： $\\frac{h^2}{12} = K$\n- $u_{yyyy}$： $\\frac{h^2}{12} = K$\n- $u_{xxyy}$： $c h^4 = 2K$\n\n从这些关系中，我们发现 $K = \\frac{h^2}{12}$，进而得到 $c h^4 = 2\\left(\\frac{h^2}{12}\\right) = \\frac{h^2}{6}$。这意味着对于方形网格，$c = \\frac{1}{6h^2}$。\n通过此选择，截断误差变为 $\\mathcal{T}|_h = \\frac{h^2}{12} \\Delta (\\Delta u) + \\mathcal{O}(h^4)$。对于调和函数，其中 $\\Delta u = 0$，则有 $\\Delta(\\Delta u) = \\Delta(0) = 0$。$\\mathcal{O}(h^2)$ 误差项消失，近似变为四阶精度，符合要求。\n\n为了找到对于一般 $h_x, h_y$ 的表达式，我们需要一个 $c(h_x, h_y)$ 的形式，当 $h_x=h_y=h$ 时，它能简化为 $c = \\frac{1}{6h^2}$。构建此类高阶格式的一种标准方法是使截断误差具有理想的结构。我们尝试将我们的误差项与拉普拉斯算子高阶导数的紧凑表示相匹配。考虑算子 $(I + \\frac{h_x^2}{12}\\partial_{xx} + \\frac{h_y^2}{12}\\partial_{yy})\\Delta u$：\n$$\n\\left(I + \\frac{h_x^2}{12}\\frac{\\partial^2}{\\partial x^2} + \\frac{h_y^2}{12}\\frac{\\partial^2}{\\partial y^2}\\right)\\Delta u = \\Delta u + \\frac{h_x^2}{12}(u_{xxxx} + u_{xxyy}) + \\frac{h_y^2}{12}(u_{xxyy} + u_{yyyy})\n$$\n这个表达式需要修改偏微分方程的右侧。我们的模板仅是 $\\Delta u$ 的近似，因此我们需要匹配误差项。\n推广 $c$ 的一个更直接、更标准的方法是要求 $\\mathcal{T}$ 中四阶导数项的系数成特定比例。选择 $c = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2}$ 可以使截断误差具有理想的结构。让我们验证这个选择。\n如果 $h_x=h_y=h$，那么 $c = \\frac{h^2+h^2}{12 h^2 h^2} = \\frac{2h^2}{12h^4} = \\frac{1}{6h^2}$。这与我们对方形网格的发现是一致的。\n因此我们确定 $c$ 的表达式为：\n$$\nc = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2} = \\frac{1}{12}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)\n$$\n现在我们可以找到其他权重的最终表达式：\n$b_x = \\frac{1}{h_x^2} - 2c = \\frac{1}{h_x^2} - \\frac{2(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = \\frac{1}{h_x^2} - \\frac{h_x^2+h_y^2}{6 h_x^2 h_y^2} = \\frac{6h_y^2 - (h_x^2+h_y^2)}{6 h_x^2 h_y^2} = \\frac{5h_y^2 - h_x^2}{6 h_x^2 h_y^2}$。\n这也可以写作 $b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$。\n\n根据对称性，交换 $h_x$ 和 $h_y$：\n$b_y = \\frac{5h_x^2 - h_y^2}{6 h_x^2 h_y^2}$，或 $b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$。\n\n最后，对于 $a$：\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{4(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{h_x^2+h_y^2}{3 h_x^2 h_y^2}$\n将各项通分，分母为 $3h_x^2 h_y^2$：\n$a = \\frac{-6h_y^2 - 6h_x^2 + h_x^2 + h_y^2}{3 h_x^2 h_y^2} = \\frac{-5h_x^2 - 5h_y^2}{3 h_x^2 h_y^2} = -\\frac{5}{3}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)$。\n\n根据问题的约束条件，这四个权重已被唯一确定。\n\n最终的表达式为：\n$a = -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)$\n$b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$\n$b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$\n$c = \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right), & \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}, & \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}, & \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2} \\end{pmatrix}}\n$$", "id": "3454092"}, {"introduction": "虽然精度是数值方法的一个主要目标，但一个优秀的格式还必须能产生具有物理意义的结果。本练习探讨了单调性这一关键属性，它与离散极值原理紧密相关。你将构建一个满足相容性但非单调的9点格式，并观察它如何导致非物理解[@problem_id:3454096]，例如在解中产生位于边界条件范围之外的数值。这个练习强调了仅有相容性是不够的，为我们揭示了数值方法定性行为的重要性。", "problem": "考虑一族定义在间距为 $h$ 的均匀笛卡尔网格上的九点有限差分算子，其旨在近似负二维拉普拉斯算子 $-\\Delta u = -(\\partial_{xx} u + \\partial_{yy} u)$。在一个内部网格点 $(i,j)$ 上，定义算子\n$$\nA_{h} u_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} \\;-\\; \\alpha\\,[u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}] \\;-\\; \\beta\\,[u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}] \\Big),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是与 $h$ 无关的实常数，九点格式包括中心节点、四个基本方向的邻点和四个对角线方向的邻点。假设在计算网格的外部边界上施加狄利克雷边界条件，因此边界值是已知的，并作为内部节点离散方程的右端项。\n\na) 通过对 $(i,j)$ 点进行二阶泰勒展开，推导 $\\alpha$、$\\beta$ 和 $\\gamma$ 必须满足的相容性条件，以使 $A_{h} u_{i,j}$ 在 $h \\to 0$ 时是 $-\\Delta u(x_{i},y_{j})$ 的一个二阶精确近似。你的推导必须从 $u_{i\\pm 1,j}$、$u_{i,j\\pm 1}$ 和 $u_{i\\pm 1,j\\pm 1}$ 的泰勒展开开始，并系统地消去零阶项，以避免产生虚假的类反应项。\n\nb) 使用 (a) 部分的相容性条件，选择一个满足这些条件但违反单调性的特定对 $(\\alpha,\\beta)$（即产生的刚度矩阵不是一个单调矩阵（M-矩阵））。根据非对角系数的符号，明确说明你选择的组合为何是非单调的。然后，在一个 $3\\times 3$ 的网格上（一个内部节点被八个边界节点包围），施加狄利克雷边界数据，其中四个角点（对角线）边界节点的值设为 $u=1$，四个边中点（基本方向）边界节点的值设为 $u=0$。考虑齐次方程 $-\\Delta u = 0$，这样唯一的右端项贡献来自于通过格式代入的边界数据。在该单个内部节点上计算得到的离散方程，并求出由你的非单调九点算子产生的内部值 $u_{i,j}$。将你的最终答案表示为一个精确的有理数。不需要进行四舍五入。", "solution": "该问题要求推导一族九点有限差分格式的相容性条件，然后使用该族中的一个非单调实例进行具体计算。\n\n** (a) 部分：相容性条件**\n\n算子由下式给出\n$$\nA_{h} u_{i,j} = \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big)\n$$\n其中 $\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}$ 以及 $\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}$。设中心点 $(x_i, y_j)$ 记为 $(x, y)$，并设 $u$ 及其导数均在该点求值。我们在邻点处对函数 $u$ 进行泰勒级数展开。\n\n四个基本方向邻点的和为：\n\\begin{align*} \\label{eq:1}\nu(x+h, y) + u(x-h, y) + u(x, y+h) + u(x, y-h) = \\left( u + h u_x + \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n+ \\left( u - h u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n+ \\left( u + h u_y + \\frac{h^2}{2} u_{yy} + \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n+ \\left( u - h u_y + \\frac{h^2}{2} u_{yy} - \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n= 4u + h^2(u_{xx} + u_{yy}) + \\frac{h^4}{12}(u_{xxxx} + u_{yyyy}) + O(h^6)\n\\end{align*}\n由于对称性，奇数阶导数项相互抵消。\n\n四个对角线邻点的和 $\\sum_{\\sigma,\\tau \\in \\{-1,1\\}} u(x+\\sigma h, y+\\tau h)$ 也可类似展开。一个通用对角点上的泰勒展开为：\n$$\nu(x+\\sigma h, y+\\tau h) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} (\\sigma h \\partial_x + \\tau h \\partial_y)^k u\n$$\n对 $\\sigma, \\tau \\in \\{-1, 1\\}$ 的四种组合求和，会使所有含有 $\\sigma$ 或 $\\tau$ 奇次幂的项消失。例如，$\\sum \\sigma = 0$，$\\sum \\sigma \\tau = 0$，$\\sum \\sigma^3 = 0$ 等。不为零的和是 $\\sum 1 = 4$，$\\sum \\sigma^2 = 4$，$\\sum \\tau^2 = 4$，$\\sum \\sigma^2 \\tau^2 = 4$，$\\sum \\sigma^4 = 4$，$\\sum \\tau^4 = 4$。\n该和的展开式为：\n\\begin{align*} \\label{eq:2}\n\\sum_{\\sigma,\\tau} u(x+\\sigma h, y+\\tau h) = 4u + \\frac{h^2}{2!} \\sum_{\\sigma,\\tau} (\\sigma^2 u_{xx} + 2\\sigma\\tau u_{xy} + \\tau^2 u_{yy}) \\\\\n\\quad + \\frac{h^4}{4!} \\sum_{\\sigma,\\tau} (\\sigma^4 u_{xxxx} + 4\\sigma^3\\tau u_{xxxy} + 6\\sigma^2\\tau^2 u_{xxyy} + 4\\sigma\\tau^3 u_{xyyy} + \\tau^4 u_{yyyy}) + O(h^6) \\\\\n= 4u + \\frac{h^2}{2} (4u_{xx} + 4u_{yy}) + \\frac{h^4}{24} (4u_{xxxx} + 24u_{xxyy} + 4u_{yyyy}) + O(h^6) \\\\\n= 4u + 2h^2(u_{xx} + u_{yy}) + \\frac{h^4}{6}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + O(h^6)\n\\end{align*}\n\n现在，我们将这些和代入 $A_h u_{i,j}$ 的表达式中：\n\\begin{align*}\nh^2 A_h u_{i,j} = \\gamma u - \\alpha \\left[ 4u + h^2(u_{xx} + u_{yy}) + O(h^4) \\right] - \\beta \\left[ 4u + 2h^2(u_{xx} + u_{yy}) + O(h^4) \\right] \\\\\n= (\\gamma - 4\\alpha - 4\\beta)u - (\\alpha + 2\\beta)h^2(u_{xx} + u_{yy}) - (\\text{terms of order } h^4 \\text{ and higher})\n\\end{align*}\n除以 $h^2$，我们得到：\n$$\nA_h u_{i,j} = \\frac{\\gamma - 4\\alpha - 4\\beta}{h^2}u - (\\alpha + 2\\beta)(u_{xx} + u_{yy}) + O(h^2)\n$$\n为了使 $A_h u_{i,j}$ 成为 $-\\Delta u = -(u_{xx} + u_{yy})$ 的一个相容近似，必须满足以下条件：\n1. $u$ 的零阶项系数必须为零。这可以防止出现虚假的反应项，并且是保证相容性所必需的。\n$$\n\\gamma - 4\\alpha - 4\\beta = 0 \\implies \\gamma = 4(\\alpha + \\beta)\n$$\n2. 拉普拉斯项 $(u_{xx} + u_{yy})$ 的系数必须是 $-1$。\n$$\n-(\\alpha + 2\\beta) = -1 \\implies \\alpha + 2\\beta = 1\n$$\n这两个方程是该算子成为 $-\\Delta u$ 的二阶精确近似的相容性条件。\n\n** (b) 部分：非单调算子与计算**\n\n由此有限差分算子产生的刚度矩阵是单调的（一个M-矩阵），如果其对角元为正，且所有非对角元均为非正。矩阵中对应于节点 $(i,j)$ 的行中，乘以 $u_{k,l}$ 的元素是 $A_{h} u_{i,j}$ 表达式中 $u_{k,l}$ 的系数。\n- $u_{i,j}$ 的系数（对角元）是 $\\frac{\\gamma}{h^2}$。\n- 一个基本方向邻点的系数（非对角元）是 $-\\frac{\\alpha}{h^2}$。\n- 一个对角线邻点的系数（非对角元）是 $-\\frac{\\beta}{h^2}$。\n\n为了满足单调性，我们要求非对角元为非正，这意味着 $-\\frac{\\alpha}{h^2} \\le 0$ 和 $-\\frac{\\beta}{h^2} \\le 0$。这又意味着 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$。违反这两个条件中的任何一个都会使格式变为非单调。\n\n我们需要选择一对 $(\\alpha, \\beta)$，使其满足相容性条件 $\\alpha + 2\\beta = 1$ 但违反单调性。我们选择一个负的 $\\beta$ 值。一个简单的选择是 $\\beta = -1/2$。\n将其代入相容性条件：\n$$\n\\alpha + 2(-\\frac{1}{2}) = 1 \\implies \\alpha - 1 = 1 \\implies \\alpha = 2\n$$\n这就得到了 $(\\alpha, \\beta) = (2, -1/2)$ 这对组合。这对组合满足 $\\alpha+2\\beta = 1$。由于 $\\beta = -1/2  0$，单调性条件被违反。对应于对角线邻点的非对角矩阵元素为 $-\\beta/h^2 = -(-1/2)/h^2 = 1/(2h^2) > 0$。\n\n现在我们使用第一个相容性条件来求 $\\gamma$：\n$$\n\\gamma = 4(\\alpha + \\beta) = 4(2 - \\frac{1}{2}) = 4(\\frac{3}{2}) = 6\n$$\n因此，我们的非单调算子由参数 $\\alpha=2$, $\\beta=-1/2$ 和 $\\gamma=6$ 定义。\n\n我们现在考虑一个带有单个内部节点 $(i,j)$ 的 $3 \\times 3$ 网格。离散方程为 $A_h u_{i,j} = 0$，因为我们近似的是 $-\\Delta u = 0$。\n$$\n\\frac{1}{h^2}\\Big( \\gamma u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big) = 0\n$$\n两边乘以 $h^2$ 并求解 $u_{i,j}$ 得：\n$$\n\\gamma u_{i,j} = \\alpha \\sum_{\\text{cardinal}} u + \\beta \\sum_{\\text{diagonal}} u\n$$\n边界条件为：四个基本方向邻点处 $u=0$，四个对角线邻点处 $u=1$。\n因此，这些和为：\n$$\n\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} = 0 + 0 + 0 + 0 = 0\n$$\n$$\n\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} = 1 + 1 + 1 + 1 = 4\n$$\n将这些值和参数 $\\alpha=2, \\beta=-1/2, \\gamma=6$ 代入 $u_{i,j}$ 的方程中：\n$$\n6 \\, u_{i,j} = (2)(0) + (-\\frac{1}{2})(4)\n$$\n$$\n6 \\, u_{i,j} = 0 - 2 = -2\n$$\n$$\nu_{i,j} = \\frac{-2}{6} = -\\frac{1}{3}\n$$\n内部值为 $-1/3$。这个结果超出了边界数据的值域 $[0,1]$，这表明离散极值原理被违反，而这是该算子非单调性的直接后果。", "answer": "$$\n\\boxed{-\\frac{1}{3}}\n$$", "id": "3454096"}, {"introduction": "将有限差分格式应用于整个网格，会把一个偏微分方程转化为一个大型线性代数方程组 $A\\mathbf{u} = \\mathbf{f}$。系数矩阵 $A$ 的结构对于选择高效的求解策略至关重要。最后的这个练习旨在连接几何上的计算模板与代数上的线性系统。通过分析由9点模板生成的矩阵的稀疏模式并计算其带宽[@problem_id:3454114]，你将掌握评估离散化后线性系统计算复杂度的基本技能，这对于大规模科学计算是必不可少的。", "problem": "考虑单位正方形 $\\Omega = (0,1) \\times (0,1)$ 上的二维拉普拉斯算子 $\\Delta$（带有齐次狄利克雷边界条件），以及椭圆边值问题 $-\\Delta u = f$ on $\\Omega$。使用包含 $n \\times n$ 个内部点的均匀笛卡尔网格对 $\\Omega$ 进行离散化，网格间距为 $h = \\frac{1}{n+1}$，并采用标准的九点有限差分格式来近似拉普拉斯算子，该格式将每个网格点与其八个最近的邻居点（四个轴向邻居和四个对角线邻居）耦合起来。假设未知量按行进行字典序（行主序）排序，使得坐标为 $(p,q)$（其中 $1 \\leq p,q \\leq n$）的网格点上的标量未知量被映射到线性索引\n$$\nI(p,q) = (q-1)n + p \\in \\{1,2,\\dots,n^2\\}.\n$$\n将这个在 $n \\times n$ 网格上的九点格式所得到的稀疏对称系统矩阵记为 $A \\in \\mathbb{R}^{n^2 \\times n^2}$。使用上述排序方式，通过确定非零元可能出现的对角线偏移量（以索引差表示）集合来描述 $A$ 的稀疏模式，并从第一性原理推导出矩阵带宽。在本问题中，带宽 $b$ 由下半带宽 $\\ell$ 和上半带宽 $u$ 定义为 $b = \\ell + u + 1$，其中\n$$\n\\ell = \\max\\{\\, i-j \\,:\\, 1 \\leq j \\leq i \\leq n^2,\\ a_{ij} \\neq 0 \\,\\}, \\qquad\nu = \\max\\{\\, j-i \\,:\\, 1 \\leq i \\leq j \\leq n^2,\\ a_{ij} \\neq 0 \\,\\}.\n$$\n此外，通过根据网格点的位置（角点、边点或内部点）对其进行分类，并对它们按行的非零元计数求和，计算 $A$ 中非零元的精确总数，作为 $n$ 的函数。假设 $n \\geq 2$，以确保存在边和角的情况。将你的最终答案表示为一个数对，第一个元素是带宽 $b$，第二个元素是非零元总数 $\\operatorname{nnz}(A)$，均以闭合形式表示。无需进行数值舍入，且不涉及物理单位。将最终答案以包含这两个表达式的单行矩阵形式给出。", "solution": "问题要求计算系统矩阵 $A$ 的带宽和非零元总数。该矩阵是通过在均匀网格上对二维拉普拉斯算子进行九点有限差分格式离散化，并对未知量采用字典序排序得到的。\n\n该问题是适定的，有科学依据，并为得到唯一解提供了所有必要信息。我们可以开始解题。\n\n设区域内部由一个 $n \\times n$ 个点的均匀网格离散化，点用 $(p,q)$ 索引，其中 $1 \\leq p,q \\leq n$。这些点的笛卡尔坐标是 $(x_p, y_q) = (ph, qh)$，网格间距为 $h = \\frac{1}{n+1}$。未知量 $u(x_p, y_q)$ 记为 $u_{p,q}$。\n\n在点 $(p,q)$ 处，拉普拉斯算子的九点格式涉及该点本身及其八个最近的邻居点：$(p\\pm1, q)$、$(p, q\\pm1)$ 和 $(p\\pm1, q\\pm1)$。点 $(p,q)$ 处的离散方程是 $u_{p',q'}$ 值的线性组合，其中 $(p',q')$ 在 $(p,q)$ 的格式内。\n\n未知量按字典序（行主序）排序，将二维网格索引 $(p,q)$ 映射到矩阵系统的一维线性索引 $i$：\n$$\ni = I(p,q) = (q-1)n + p\n$$\n得到的线性系统为 $A\\mathbf{u} = \\mathbf{f}$，其中 $A$ 是一个 $n^2 \\times n^2$ 的矩阵。$A$ 的一个元素 $a_{ij}$ 非零，当且仅当对应于索引 $j$ 的未知量出现在对应于索引 $i$ 的未知量的离散方程中。设 $i=I(p,q)$ 且 $j=I(p',q')$。如果 $(p',q')$ 是以 $(p,q)$ 为中心的格式中的一个网格点，则 $a_{ij} \\neq 0$。主对角元 $a_{ii}$ 总是非零的。\n\n**第一部分：稀疏模式和带宽**\n\n为了确定稀疏模式和带宽，我们分析一般点 $(p,q)$ 的格式中所有邻居点 $(p',q')$ 的线性索引差 $j-i$。设 $p' = p + \\Delta p$ 和 $q' = q + \\Delta q$，其中 $\\Delta p, \\Delta q \\in \\{-1, 0, 1\\}$（但不能同时为零）。\n\n索引差为：\n$$\nj-i = I(p+\\Delta p, q+\\Delta q) - I(p,q) = ((q+\\Delta q)-1)n + (p+\\Delta p) - ((q-1)n+p)\n$$\n$$\nj-i = (q-1)n + (\\Delta q)n + p + \\Delta p - (q-1)n - p = (\\Delta q)n + \\Delta p\n$$\n我们现在列出八个邻居点的索引差：\n1.  轴向邻居：\n    -   右邻居：$(\\Delta p, \\Delta q) = (1, 0) \\implies j-i = (0)n + 1 = 1$。\n    -   左邻居：$(\\Delta p, \\Delta q) = (-1, 0) \\implies j-i = (0)n - 1 = -1$。\n    -   上邻居：$(\\Delta p, \\Delta q) = (0, 1) \\implies j-i = (1)n + 0 = n$。\n    -   下邻居：$(\\Delta p, \\Delta q) = (0, -1) \\implies j-i = (-1)n + 0 = -n$。\n2.  对角线邻居：\n    -   右上邻居：$(\\Delta p, \\Delta q) = (1, 1) \\implies j-i = (1)n + 1 = n+1$。\n    -   左上邻居：$(\\Delta p, \\Delta q) = (-1, 1) \\implies j-i = (1)n - 1 = n-1$。\n    -   右下邻居：$(\\Delta p, \\Delta q) = (1, -1) \\implies j-i = (-1)n + 1 = -n+1$。\n    -   左下邻居：$(\\Delta p, \\Delta q) = (-1, -1) \\implies j-i = (-1)n - 1 = -n-1$。\n\n这些差值表示了非零元可能出现的相对于主对角线的偏移量。所有可能的非零元偏移量的集合是 $\\{0, \\pm 1, \\pm(n-1), \\pm n, \\pm(n+1)\\}$。\n\n带宽 $b$ 定义为 $b = \\ell + u + 1$，基于下半带宽和上半带宽：\n-   下半带宽为 $\\ell = \\max\\{i-j \\mid a_{ij} \\neq 0, i \\geq j\\}$。这是非正偏移量 $j-i$ 的 $-(j-i)$ 的最大值。非正偏移量的集合是 $\\{0, -1, -n+1, -n, -(n+1)\\}$。因此，$i-j$ 的最大值为 $\\max\\{0, 1, n-1, n, n+1\\} = n+1$。所以，$\\ell = n+1$。\n-   上半带宽为 $u = \\max\\{j-i \\mid a_{ij} \\neq 0, j \\geq i\\}$。这是非负偏移量 $j-i$ 的最大值。非负偏移量的集合是 $\\{0, 1, n-1, n, n+1\\}$。最大值为 $n+1$。所以，$u = n+1$。\n\n因此，总带宽为：\n$$\nb = \\ell + u + 1 = (n+1) + (n+1) + 1 = 2n + 3\n$$\n\n**第二部分：非零元总数**\n\n非零元的总数 $\\operatorname{nnz}(A)$ 是每行非零元数量的总和。对于对应于网格点 $(p,q)$ 的行，非零元的数量是 1（对角项 $a_{ii}$）加上其邻居中也属于*内部*网格点的数量。由于齐次狄利克雷条件，位于 $\\Omega$ 边界上的邻居点不对应于未知量，因此不会在 $A$ 中产生非零元。\n\n我们根据其位置对 $n \\times n$ 个内部网格点进行分类，这决定了它们有多少个邻居是内部点。问题假设 $n \\geq 2$。\n\n1.  **内部-内部点：** 这些是满足 $1  p  n$ 和 $1  q  n$ 的点 $(p,q)$。它们的所有8个邻居也都是内部点。\n    -   此类点的数量：$(n-2) \\times (n-2) = (n-2)^2$。\n    -   $A$ 中每个对应的行有 $1$ (对角元) $+ 8$ (非对角元) $= 9$ 个非零元。\n    -   对非零元总数的贡献：$9(n-2)^2$。\n\n2.  **边点：** 这些是位于内部网格边界上但不是角点的点。当 $p \\in \\{1,n\\}$ 且 $1  q  n$，或 $q \\in \\{1,n\\}$ 且 $1  p  n$ 时，就会出现这种情况。\n    -   垂直边上的点（例如，$(1,q)$ 且 $1  q  n$）：这些点有 5 个内部邻居（$(1,q\\pm1), (2,q), (2,q\\pm1)$）。有 $2(n-2)$ 个这样的点。\n    -   水平边上的点（例如，$(p,1)$ 且 $1  p  n$）：这些点有 5 个内部邻居（$(p\\pm1,1), (p\\pm1,2), (p,2)$）。有 $2(n-2)$ 个这样的点。\n    -   总共有 $4(n-2)$ 个边点。\n    -   $A$ 中每个对应的行有 $1$ (对角元) $+ 5$ (非对角元) $= 6$ 个非零元。\n    -   对非零元总数的贡献：$6 \\times 4(n-2) = 24(n-2)$。\n\n3.  **角点：** 这是内部网格的四个角点：$(1,1), (n,1), (1,n), (n,n)$。\n    -   此类点的数量：4。\n    -   每个角点有 3 个内部邻居（例如，对于 $(1,1)$，邻居是 $(2,1), (1,2), (2,2)$）。\n    -   $A$ 中每个对应的行有 $1$ (对角元) $+ 3$ (非对角元) $= 4$ 个非零元。\n    -   对非零元总数的贡献：$4 \\times 4 = 16$。\n\n非零元的总数是这些贡献的总和：\n$$\n\\operatorname{nnz}(A) = 9(n-2)^2 + 24(n-2) + 16\n$$\n展开表达式：\n$$\n\\operatorname{nnz}(A) = 9(n^2 - 4n + 4) + 24n - 48 + 16 = 9n^2 - 36n + 36 + 24n - 32 = 9n^2 - 12n + 4\n$$\n这个表达式可以因式分解为：\n$$\n\\operatorname{nnz}(A) = (3n-2)^2\n$$\n\n因此，带宽为 $2n+3$，非零元总数为 $(3n-2)^2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2n+3  (3n-2)^2 \\end{pmatrix}}\n$$", "id": "3454114"}]}