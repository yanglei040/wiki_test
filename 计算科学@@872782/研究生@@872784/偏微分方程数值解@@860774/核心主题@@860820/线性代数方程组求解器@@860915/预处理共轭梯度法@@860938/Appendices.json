{"hands_on_practices": [{"introduction": "要真正理解一个算法，没有什么比亲手计算一个具体例子更有效了。第一个练习将引导您在一个小型线性系统上，完成预条件共轭梯度法（PCG）的一次完整迭代。请密切关注预条件子（在这里是一个简单的雅可比预条件子）如何被用来变换残差向量，并为构建第一个搜索方向奠定基础。[@problem_id:1029864]", "problem": "考虑线性系统 $ A \\mathbf{x} = \\mathbf{b} $，其中\n$$ A = \\begin{bmatrix} 4 & -2 & 0 \\\\ -2 & 3 & -1 \\\\ 0 & -1 & 2 \\end{bmatrix} \\quad \\text{和} \\quad \\mathbf{b} = \\begin{bmatrix} 4 \\\\ -3 \\\\ 2 \\end{bmatrix}. $$\n应用采用对角缩放（雅可比预处理器）的预处理共轭梯度（PCG）方法，从初始猜测 $ \\mathbf{x}_0 = \\mathbf{0} $ 开始。迭代一次后，计算残差向量的2-范数。雅可比预处理器 $ M $ 是矩阵 $ A $ 的对角部分，因此 $ M = \\operatorname{diag}(4, 3, 2) $。", "solution": "1. 初始残差\n$$r_0 = b - A x_0 = \\begin{bmatrix}4\\\\-3\\\\2\\end{bmatrix}.$$\n2. 预处理后的残差\n$$M^{-1} = \\operatorname{diag}\\bigl(\\tfrac14,\\tfrac13,\\tfrac12\\bigr),\\qquad \nz_0 = M^{-1}r_0 = \\begin{bmatrix}1\\\\-1\\\\1\\end{bmatrix}.$$\n3. 搜索方向\n$$p_0 = z_0 = \\begin{bmatrix}1\\\\-1\\\\1\\end{bmatrix}.$$\n4. 矩阵向量乘积\n$$A p_0 = \\begin{bmatrix} 4 & -2 & 0 \\\\ -2 & 3 & -1 \\\\ 0 & -1 & 2 \\end{bmatrix}\n\\begin{bmatrix}1\\\\-1\\\\1\\end{bmatrix}\n=\\begin{bmatrix}6\\\\-6\\\\3\\end{bmatrix}.$$\n5. 步长\n$$\\alpha_0 = \\frac{r_0^T z_0}{p_0^T A p_0}\n=\\frac{9}{15}=\\frac35.$$\n6. 更新后的残差\n$$r_1 = r_0 - \\alpha_0 A p_0\n=\\begin{bmatrix}4\\\\-3\\\\2\\end{bmatrix}\n-\\frac35\\begin{bmatrix}6\\\\-6\\\\3\\end{bmatrix}\n=\\begin{bmatrix}0.4\\\\0.6\\\\0.2\\end{bmatrix}.$$\n7. 残差的2-范数\n$$\\|r_1\\|_2 = \\sqrt{0.4^2 + 0.6^2 + 0.2^2}\n= \\frac{\\sqrt{14}}{5}.$$", "answer": "$$\\boxed{\\frac{\\sqrt{14}}{5}}$$", "id": "1029864"}, {"introduction": "共轭梯度法的卓越效率并非偶然，它植根于深刻的代数性质。这个练习将带您从“如何计算”转向“为何有效”，挑战您构建一个PCG方法保证在两步内收敛到精确解的系统。通过这个思想实验，您将直接体会到CG收敛的核心理论，即将迭代次数与预条件矩阵的不同特征值的数量联系起来。[@problem_id:2427437]", "problem": "考虑使用共轭梯度（CG）方法及其预处理变体求解线性系统。构造明确的矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 和 $M \\in \\mathbb{R}^{5 \\times 5}$，使它们都是对称正定矩阵，并且预处理算子 $M^{-1}A$ 恰好有 $2$ 个不同的特征值。通过您构造的直接推理来验证该特征值属性。然后，考虑对任意的 $b \\in \\mathbb{R}^{5}$ 和任意的初始猜测 $x_0 \\in \\mathbb{R}^{5}$，使用预处理器 $M$ 将预处理共轭梯度（PCG）方法应用于系统 $A x = b$。基于线性代数的第一性原理和算法的定义属性，提供一个严格的证明，说明 PCG 方法在有界的迭代次数内终止并得到精确解，且该迭代次数不依赖于 $b$ 或 $x_0$。确定具有此性质的最小整数 $k^\\star$。\n\n您的最终答案必须仅为 $k^\\star$ 的值。无需四舍五入。", "solution": "该问题要求我们构造大小为 $5 \\times 5$ 的特定对称正定（SPD）矩阵 $A$ 和 $M$，使得预处理算子 $M^{-1}A$ 恰好拥有 $2$ 个不同的特征值。随后，我们必须提供一个严格的证明，说明用于求解系统 $A x = b$ 的预处理共轭梯度（PCG）方法会在有限次迭代 $k^\\star$ 内收敛到精确解，且该迭代次数与右端项 $b$ 和初始猜测 $x_0$ 的选择无关。最后，我们必须确定这个最小上界 $k^\\star$。\n\n首先，我们构造所需的矩阵 $A$ 和 $M$。一个简单而有效的构造方法是使用对角矩阵。设 $M$ 为 $5 \\times 5$ 的单位矩阵，$M=I_5$。单位矩阵是对称的，其所有特征值均为 $1$，因此它是正定的。\n接下来，我们构造矩阵 $A$。为确保 $M^{-1}A$ 有两个不同的特征值，并且考虑到我们选择了 $M=I_5$，矩阵 $A$ 本身必须有两个不同的特征值。我们还需要 $A$ 是对称且正定的。对角线上元素为正的对角矩阵满足这些要求。我们可以选择：\n$$\nA = \\text{diag}(1, 1, 1, 2, 2)\n$$\n根据构造，这个矩阵 $A$ 是对称的。它的特征值是其对角线上的元素，即 $1$ 和 $2$。由于所有特征值都是正的，所以 $A$ 是正定的。\n预处理算子为 $M^{-1}A = I_5^{-1}A = A$。因此，$M^{-1}A$ 的特征值为 $\\{1, 1, 1, 2, 2\\}$。不同特征值的集合是 $\\{\\lambda_1, \\lambda_2\\} = \\{1, 2\\}$。因此，恰好有 $2$ 个不同的特征值，符合问题陈述的要求。我们对 $A$ 和 $M$ 的构造是有效的。\n\n现在，我们必须分析 PCG 方法的收敛性。使用 SPD 预处理器 $M$ 求解系统 $A x = b$ 的 PCG 算法在数学上等价于将标准共轭梯度（CG）算法应用于一个变换后的线性系统。由于 $M$ 是 SPD 矩阵，它有唯一的 Cholesky 分解 $M = L L^T$，其中 $L$ 是一个非奇异的下三角矩阵。\n\n我们可以如下变换原系统 $A x = b$：\n$$\nA x = b \\implies (L^{-1} A L^{-T}) (L^T x) = L^{-1} b\n$$\n我们定义 $\\hat{A} = L^{-1} A L^{-T}$，$\\hat{x} = L^T x$ 和 $\\hat{b} = L^{-1}b$。该系统变为 $\\hat{A} \\hat{x} = \\hat{b}$。\n矩阵 $\\hat{A}$ 是 SPD 矩阵。它是对称的，因为 $A$ 是对称的：\n$$\n\\hat{A}^T = (L^{-1} A L^{-T})^T = (L^{-T})^T A^T (L^{-1})^T = L^{-1} A L^{-T} = \\hat{A}\n$$\n它是正定的，因为 $A$ 是 SPD 矩阵且 $L^{-T}$ 是非奇异的。对于任意非零向量 $y \\in \\mathbb{R}^5$，令 $z = L^{-T}y$。由于 $L^{-T}$ 是非奇异的，所以 $z \\neq 0$。于是：\n$$\ny^T \\hat{A} y = y^T (L^{-1} A L^{-T}) y = (L^{-T}y)^T A (L^{-T}y) = z^T A z > 0\n$$\n应用于 $A x = b$ 的 PCG 算法被设计成使其生成的迭代序列 $x_k$ 对应于标准 CG 算法应用于 $\\hat{A} \\hat{x} = \\hat{b}$ 所生成的迭代序列 $\\hat{x}_k = L^T x_k$。\n\nCG 方法的一个基本定理指出，该算法最多在 $m$ 次迭代内终止并得到精确解，其中 $m$ 是系统矩阵的不同特征值的数量。该性质的产生是因为误差 $e_k = x - x_k$ 可以表示为 $e_k = P_k(A) e_0$，其中 $P_k$ 是一个次数为 $k$ 且满足 $P_k(0)=1$ 的多项式。CG 方法寻找能使误差的 $A$-范数最小化的多项式。如果矩阵有 $m$ 个不同的特征值 $\\{\\mu_1, \\dots, \\mu_m\\}$，可以构造一个次数为 $m$ 的多项式 $Q(t) = \\prod_{i=1}^m (1 - t/\\mu_i)$，它在所有特征值处为零且满足 $Q(0)=1$。CG 算法在第 $m$ 步找到这个多项式，从而得到零误差。这对任何初始猜测 $x_0$ 和右端项 $b$ 都成立。\n\n对于我们的预处理系统，相关的系统矩阵是 $\\hat{A}$。我们需要确定 $\\hat{A}$ 的不同特征值的数量。矩阵 $\\hat{A}$ 和 $M^{-1}A$ 是相似的，这意味着它们具有相同的特征值。我们可以明确地展示这种相似变换：\n$$\n\\hat{A} = L^{-1} A L^{-T} = L^{-1} (M M^{-1}) A L^{-T} = L^{-1} (L L^T) (M^{-1}A) (L^T)^{-1} = (L^{-1}L) L^T (M^{-1}A) (L^T)^{-1} = L^T (M^{-1}A) (L^T)^{-1}\n$$\n由于 $\\hat{A}$ 是 $M^{-1}A$ 的一个相似变换，它们具有相同的特征多项式，因此具有相同的特征值。\n\n根据我们的构造，预处理矩阵 $M^{-1}A$ 恰好有 $2$ 个不同的特征值。因此，变换后的矩阵 $\\hat{A}$ 也恰好有 $2$ 个不同的特征值。\n\n因此，将标准 CG 收敛定理应用于系统 $\\hat{A} \\hat{x} = \\hat{b}$，该算法保证在最多 $2$ 次迭代内找到精确解 $\\hat{x}$。由于 $\\hat{x}_k = L^T x_k$ 且 $L$ 是非奇异的，如果 $\\hat{x}_k = \\hat{x}$，则 $x_k = x$。这种最多 $2$ 步收敛对于任何初始猜测 $\\hat{x}_0 = L^T x_0$ 和任何右端项 $\\hat{b} = L^{-1} b$ 都是保证的，这等价于任何 $x_0$ 和 $b$，因为 $L$ 是可逆的。虽然对于特定的初始条件，收敛可能在 $1$ 次迭代内发生（如果初始残差是 $\\hat{A}$ 的一个特征向量），但这个界限必须对任意输入都成立。决定这个界限的最坏情况是，初始残差在所有不同特征值的特征空间中都有分量。\n\n因此，对任何 $b$ 和 $x_0$ 都能限定迭代次数的最小整数 $k^\\star$ 是预处理算子 $M^{-1}A$ 的不同特征值的数量。在本问题中，这个数量是 $2$。\n所以，$k^\\star = 2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2427437"}, {"introduction": "在实际应用中，判断何时停止迭代与算法本身同样重要。最后一个练习旨在探讨停止准则的精妙之处，特别是在处理源于物理仿真的病态缩放问题时。您将批判性地评估广泛使用但可能产生误导的欧几里得范数，并分析一个更为稳健的、基于预条件子所诱导几何的尺度不变准则。[@problem_id:3433972]", "problem": "考虑对称正定 (SPD) 线性系统 $A x = b$，该系统由一个各向异性扩散偏微分方程的有限元离散化产生，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，且 $b \\in \\mathbb{R}^{n}$。假设我们使用预条件共轭梯度 (PCG) 方法和对称正定预条件子 $M \\in \\mathbb{R}^{n \\times n}$ 来求解该系统。令 $x_{k}$ 表示第 $k$ 次迭代解，$r_{k} = b - A x_{k}$ 表示残差，$e_{k} = x_{k} - x_{*}$ 表示误差，其中 $x_{*}$ 是 $A x_{*} = b$ 的精确解。定义 $M^{-1}$-内积和范数分别为 $\\langle u, v \\rangle_{M^{-1}} = u^{\\top} M^{-1} v$ 和 $\\|u\\|_{M^{-1}} = \\sqrt{u^{\\top} M^{-1} u}$，以及 $A$-范数为 $\\|u\\|_{A} = \\sqrt{u^{\\top} A u}$。众所周知，PCG 使用预条件残差 $z_{k} = M^{-1} r_{k}$ 来构造搜索方向。\n\n在实践中，一个常见的停止准则是欧几里得相对残差 $\\|r_{k}\\|_{2} / \\|b\\|_{2} \\le \\tau$，其中容差 $\\tau > 0$。对于缩放不良的系统，这个选择可能会产生误导：如果未知数被重新缩放，残差的欧几里得范数可能会以与算法的预条件几何结构所衡量的具有物理意义的收敛性无关的方式发生变化。\n\n考虑一个由对称正定对角矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 给出的变量的对称对角缩放，并定义缩放后的未知数 $\\hat{x} = W x$、缩放后的系统矩阵 $\\hat{A} = W^{-1} A W^{-1}$ 和缩放后的右端项 $\\hat{b} = W^{-1} b$，因此缩放后的系统为 $\\hat{A} \\hat{x} = \\hat{b}$。设预条件子被一致地缩放为 $\\hat{M} = W^{-1} M W^{-1}$。在此缩放变换下，缩放后的残差为 $\\hat{r}_{k} = \\hat{b} - \\hat{A} \\hat{x}_{k} = W^{-1} r_{k}$。\n\n请评判在存在不良缩放时，使用欧几里得相对残差 $\\|r_{k}\\|_{2} / \\|b\\|_{2}$ 作为 PCG 的停止准则的做法，并评估基于预条件范数比率 $\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$ 的缩放不变准则。在你的推理中，从范数、残差、误差的基本定义以及对称对角缩放的影响出发。然后考虑预条件算子 $H = M^{-1/2} A M^{-1/2}$ 的谱性质，以及它们在关联残差范数与误差范数中的作用。\n\n选择所有正确的陈述：\n\nA. 欧几里得相对残差 $\\|r_{k}\\|_{2} / \\|b\\|_{2}$ 在由 $W$ 定义的对称对角缩放下是不变的，因此适用于缩放不良的系统。\n\nB. 比率 $\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$ 在上述定义的对称对角缩放（其中 $\\hat{M} = W^{-1} M W^{-1}$）下是不变的，这使其成为一个缩放鲁棒的停止准则。\n\nC. 使用预条件残差范数 $\\|r_{k}\\|_{M^{-1}}$ 等价于精确地测量误差 $\\|e_{k}\\|_{A}$，无论 $M$ 的选择如何。\n\nD. 存在仅依赖于预条件算子 $H = M^{-1/2} A M^{-1/2}$ 的极端特征值的常数，使得 $\\|e_{k}\\|_{A}$ 可以被 $\\|r_{k}\\|_{M^{-1}}$ 的正常数倍从上下界定，这意味着对 $\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$ 的容差控制了误差的相对 $A$-范数（在谱因子的范围内）。\n\nE. 在 PCG 的每次迭代中测量 $\\|r_{k}\\|_{M^{-1}}$ 在计算上是不可行的，因为它除了常规操作外，还需要对 $r_{k}$ 应用 $A^{-1}$。", "solution": "问题陈述的验证过程如下。\n\n### 第一步：提取已知条件\n-   方程组：$A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定 (SPD) 矩阵。\n-   预条件子：$M \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵。\n-   PCG 迭代解：$x_k$ 是第 $k$ 次迭代解。\n-   残差：$r_k = b - A x_k$。\n-   误差：$e_k = x_k - x_*$，其中 $x_*$ 是精确解，$A x_* = b$。\n-   预条件残差：$z_k = M^{-1} r_k$。\n-   $M^{-1}$-内积和范数：$\\langle u, v \\rangle_{M^{-1}} = u^{\\top} M^{-1} v$ 和 $\\|u\\|_{M^{-1}} = \\sqrt{u^{\\top} M^{-1} u}$。\n-   $A$-范数：$\\|u\\|_{A} = \\sqrt{u^{\\top} A u}$。\n-   对称对角缩放：一个对角 SPD 矩阵 $W \\in \\mathbb{R}^{n \\times n}$。\n-   缩放后的变量：$\\hat{x} = W x$，$\\hat{A} = W^{-1} A W^{-1}$，$\\hat{b} = W^{-1} b$，$\\hat{M} = W^{-1} M W^{-1}$。\n-   缩放后的系统：$\\hat{A} \\hat{x} = \\hat{b}$。\n-   缩放后的残差：$\\hat{r}_{k} = \\hat{b} - \\hat{A} \\hat{x}_{k}$，题目给出其等于 $W^{-1} r_{k}$。\n-   预条件算子：$H = M^{-1/2} A M^{-1/2}$。\n-   待评估的停止准则：\n    1.  欧几里得相对残差：$\\|r_{k}\\|_{2} / \\|b\\|_{2}$。\n    2.  预条件范数比率：$\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于预条件共轭梯度 (PCG) 方法求解线性系统的标准理论，这是数值线性代数的基石。所有定义，包括范数、预条件子、残差、误差和对称缩放的定义，都是标准且正确的。关系 $\\hat{r}_{k} = W^{-1} r_{k}$ 的推导是正确的：$\\hat{r}_{k} = \\hat{b} - \\hat{A} \\hat{x}_{k} = (W^{-1} b) - (W^{-1} A W^{-1})(W x_k) = W^{-1}(b - A x_k) = W^{-1} r_k$。矩阵 $A$、$M$ 和 $W$ 都是对称正定，确保了所有逆矩阵和平方根（例如 $M^{-1/2}$）都存在且良定义。缩放后的矩阵 $\\hat{A}$ 和 $\\hat{M}$ 也是对称正定，保持了 PCG 所需的结构。该问题在科学上和数学上是合理的。\n-   **适定性**：问题要求基于所提供的理论框架对几个陈述进行评估。这是一个定义明确、目标清晰的概念性问题。\n-   **客观性**：语言精确，使用了公认的数学术语，没有歧义或主观性。\n\n### 第三步：结论与行动\n问题陈述有效。可以进行分析。\n\n### 推导与分析\n\n问题的核心是评估 PCG 方法的不同停止准则在变量的对称对角缩放下的表现。一个鲁棒的准则在这种变换下应该是不变的，因为缩放是单位或表示的改变，不应影响对物理精确解收敛程度的衡量。\n\n令 $W$ 是一个具有正对角元素的对角 SPD 矩阵 $w_{ii}$。该缩放将系统 $Ax=b$ 变换为 $\\hat{A}\\hat{x}=\\hat{b}$，其中 $\\hat{A} = W^{-1}AW^{-1}$，$\\hat{x} = Wx$，$\\hat{b} = W^{-1}b$。预条件子被一致地变换为 $\\hat{M} = W^{-1}MW^{-1}$。第 $k$ 次迭代时缩放系统的残差为 $\\hat{r}_k = W^{-1}r_k$。\n\n**欧几里得相对残差分析：**\n我们考察缩放后系统的比率 $\\|\\hat{r}_k\\|_2 / \\|\\hat{b}\\|_2$。\n代入定义，我们得到：\n$$ \\frac{\\|\\hat{r}_k\\|_2}{\\|\\hat{b}\\|_2} = \\frac{\\|W^{-1} r_k\\|_2}{\\|W^{-1} b\\|_2} $$\n通常情况下，$\\|W^{-1} v\\|_2 \\neq c \\|v\\|_2$，其中 $c$ 是一个与 $v$ 无关的常数。对于一个向量 $v$，$\\|W^{-1}v\\|_2^2 = \\sum_{i=1}^n (v_i/w_{ii})^2$，这与 $\\|v\\|_2^2 = \\sum_{i=1}^n v_i^2$ 不成比例，除非所有 $w_{ii}$ 都相同（即 $W$ 是单位矩阵的标量倍）。对于一般的对角缩放 $W$，范数的比率会改变。因此，欧几里得相对残差在这种缩放下不是不变的。用户可以选择一个缩放 $W$ 来任意减小（或增大）这个比率，使得该停止准则不可靠。\n\n**预条件范数比率分析：**\n我们考察缩放后系统的比率 $\\|\\hat{r}_k\\|_{\\hat{M}^{-1}} / \\|\\hat{b}\\|_{\\hat{M}^{-1}}$。\n范数 $\\|\\cdot\\|_{\\hat{M}^{-1}}$ 由矩阵 $\\hat{M}^{-1}$ 定义。给定 $\\hat{M} = W^{-1}MW^{-1}$，其逆为 $\\hat{M}^{-1} = (W^{-1}MW^{-1})^{-1} = W M^{-1} W$。\n我们来计算缩放后残差 $\\hat{r}_k$ 的范数平方：\n$$ \\|\\hat{r}_k\\|_{\\hat{M}^{-1}}^2 = \\hat{r}_k^\\top \\hat{M}^{-1} \\hat{r}_k = (W^{-1}r_k)^\\top (W M^{-1} W) (W^{-1}r_k) $$\n由于 $W$ 是对称的，$(W^{-1})^\\top = W^{-1}$。\n$$ \\|\\hat{r}_k\\|_{\\hat{M}^{-1}}^2 = r_k^\\top (W^{-1})^\\top W M^{-1} W W^{-1} r_k = r_k^\\top W^{-1} W M^{-1} W W^{-1} r_k = r_k^\\top I M^{-1} I r_k = r_k^\\top M^{-1} r_k = \\|r_k\\|_{M^{-1}}^2 $$\n这表明 $\\| \\hat{r}_k \\|_{\\hat{M}^{-1}} = \\|r_k\\|_{M^{-1}}$。残差的预条件范数在这种特定的缩放变换下是不变的。同样的逻辑也适用于任何向量，包括右端项 $b$：$\\|\\hat{b}\\|_{\\hat{M}^{-1}} = \\|b\\|_{M^{-1}}$。\n因此，该比率是不变的：\n$$ \\frac{\\|\\hat{r}_k\\|_{\\hat{M}^{-1}}}{\\|\\hat{b}\\|_{\\hat{M}^{-1}}} = \\frac{\\|r_k\\|_{M^{-1}}}{\\|b\\|_{M^{-1}}} $$\n这确立了该准则的缩放不变性和鲁棒性。\n\n**误差范数与残差范数之间的关系：**\n误差 $e_k$ 与残差 $r_k$ 通过 $r_k = b - Ax_k = Ax_* - Ax_k = A(x_* - x_k) = -Ae_k$ 相关联。因此，$e_k = -A^{-1}r_k$。\n误差的 $A$-范数平方为：\n$$ \\|e_k\\|_A^2 = e_k^\\top A e_k = (-A^{-1}r_k)^\\top A (-A^{-1}r_k) = r_k^\\top (A^{-1})^\\top A A^{-1} r_k = r_k^\\top A^{-1} r_k $$\n残差的 $M^{-1}$-范数平方为 $\\|r_k\\|_{M^{-1}}^2 = r_k^\\top M^{-1} r_k$。\n这两个量，$\\|e_k\\|_A^2$ 和 $\\|r_k\\|_{M^{-1}}^2$，通常不相等，也不由一个普适常数关联。它们之间的关系取决于 $M$ 的选择。\n为了形式化这一点，我们使用算子 $H = M^{-1/2} A M^{-1/2}$。由于 $A$ 和 $M$ 是对称正定， $H$ 也是对称正定。设其特征值为 $0  \\lambda_{\\min}(H) \\le \\dots \\le \\lambda_{\\max}(H)$。\n我们有 $A = M^{1/2} H M^{1/2}$，所以 $A^{-1} = M^{-1/2} H^{-1} M^{-1/2}$。\n将此代入 $\\|e_k\\|_A^2$ 的表达式中：\n$$ \\|e_k\\|_A^2 = r_k^\\top (M^{-1/2} H^{-1} M^{-1/2}) r_k = (M^{-1/2}r_k)^\\top H^{-1} (M^{-1/2}r_k) $$\n令向量 $u_k = M^{-1/2}r_k$。则 $\\|e_k\\|_A^2 = u_k^\\top H^{-1} u_k$。\n并且，$\\|r_k\\|_{M^{-1}}^2 = r_k^\\top M^{-1} r_k = (M^{-1/2}r_k)^\\top (M^{-1/2}r_k) = u_k^\\top u_k = \\|u_k\\|_2^2$。\n根据对称正定矩阵 $H^{-1}$ 的瑞利商性质，其特征值为 $1/\\lambda_{\\max}(H)$ 和 $1/\\lambda_{\\min}(H)$：\n$$ \\lambda_{\\min}(H^{-1}) \\|u_k\\|_2^2 \\le u_k^\\top H^{-1} u_k \\le \\lambda_{\\max}(H^{-1}) \\|u_k\\|_2^2 $$\n$$ \\frac{1}{\\lambda_{\\max}(H)} \\|u_k\\|_2^2 \\le u_k^\\top H^{-1} u_k \\le \\frac{1}{\\lambda_{\\min}(H)} \\|u_k\\|_2^2 $$\n将范数表达式代回：\n$$ \\frac{1}{\\lambda_{\\max}(H)} \\|r_k\\|_{M^{-1}}^2 \\le \\|e_k\\|_A^2 \\le \\frac{1}{\\lambda_{\\min}(H)} \\|r_k\\|_{M^{-1}}^2 $$\n对所有部分取平方根，得到双边不等式：\n$$ \\frac{1}{\\sqrt{\\lambda_{\\max}(H)}} \\|r_k\\|_{M^{-1}} \\le \\|e_k\\|_A \\le \\frac{1}{\\sqrt{\\lambda_{\\min}(H)}} \\|r_k\\|_{M^{-1}} $$\n这表明误差的 $A$-范数和残差的 $M^{-1}$-范数是等价范数，其等价常数由预条件算子 $H$ 的极端特征值决定。\n\n**$\\|r_k\\|_{M^{-1}}$ 的计算成本：**\nPCG 算法需要在每次迭代中计算预条件残差 $z_k = M^{-1}r_k$。为了计算 $\\|r_k\\|_{M^{-1}}^2$，我们需要计算 $r_k^\\top M^{-1} r_k$。这可以计算为内积 $r_k^\\top z_k$。一旦 $r_k$ 和 $z_k$ 可用，这是一个 $O(n)$ 的操作，与矩阵向量乘积（$O(n^2)$ 或更稀疏）和预条件子求解（成本可变，但大于 $O(n)$）的成本相比通常可以忽略不计。此计算不涉及 $A^{-1}$。\n\n### 选项评估\n\n**A. 欧几里得相对残差 $\\|r_{k}\\|_{2} / \\|b\\|_{2}$ 在由 $W$ 定义的对称对角缩放下是不变的，因此适用于缩放不良的系统。**\n如上所示，$\\|W^{-1}r_k\\|_2 / \\|W^{-1}b\\|_2$ 通常不等于 $\\|r_k\\|_2 / \\|b\\|_2$。不变性的前提是错误的。\n**结论：不正确。**\n\n**B. 比率 $\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$ 在上述定义的对称对角缩放（其中 $\\hat{M} = W^{-1} M W^{-1}$）下是不变的，这使其成为一个缩放鲁棒的停止准则。**\n我们的分析确定了 $\\|\\hat{r}_k\\|_{\\hat{M}^{-1}} = \\|r_k\\|_{M^{-1}}$ 和 $\\|\\hat{b}\\|_{\\hat{M}^{-1}} = \\|b\\|_{M^{-1}}$。因此，该比率确实是不变的。这个性质正是使其成为一个抵抗不良缩放的鲁棒准则的原因。\n**结论：正确。**\n\n**C. 使用预条件残差范数 $\\|r_{k}\\|_{M^{-1}}$ 等价于精确地测量误差 $\\|e_{k}\\|_{A}$，无论 $M$ 的选择如何。**\n我们的分析表明 $\\|e_k\\|_A^2 = r_k^\\top A^{-1} r_k$ 且 $\\|r_k\\|_{M^{-1}}^2 = r_k^\\top M^{-1} r_k$。它们相等的充要条件是 $A=M$（在相关的子空间上）。陈述中声称等价是“精确的”并且“无论 $M$ 的选择如何”都成立，这是错误的。它们的关系是一个不等式，其界限取决于 $M^{-1}A$ 的谱。\n**结论：不正确。**\n\n**D. 存在仅依赖于预条件算子 $H = M^{-1/2} A M^{-1/2}$ 的极端特征值的常数，使得 $\\|e_{k}\\|_{A}$ 可以被 $\\|r_{k}\\|_{M^{-1}}$ 的正常数倍从上下界定，这意味着对 $\\|r_{k}\\|_{M^{-1}} / \\|b\\|_{M^{-1}}$ 的容差控制了误差的相对 $A$-范数（在谱因子的范围内）。**\n如推导所示，我们有 $\\frac{1}{\\sqrt{\\lambda_{\\max}(H)}} \\|r_k\\|_{M^{-1}} \\le \\|e_k\\|_A \\le \\frac{1}{\\sqrt{\\lambda_{\\min}(H)}} \\|r_k\\|_{M^{-1}}$。这些常数是正的，并且仅依赖于 $H$ 的极端特征值。这种范数等价性意味着将残差的相对 $M^{-1}$-范数驱动至零也会将误差的相对 $A$-范数驱动至零。该陈述是预条件方法分析中的一个正确且基本的结果。\n**结论：正确。**\n\n**E. 在 PCG 的每次迭代中测量 $\\|r_{k}\\|_{M^{-1}}$ 在计算上是不可行的，因为它除了常规操作外，还需要对 $r_{k}$ 应用 $A^{-1}$。**\n该范数需要计算 $r_k^\\top M^{-1} r_k = r_k^\\top z_k$。向量 $z_k=M^{-1}r_k$ 已经是标准 PCG 算法的一部分。它不需要 $A^{-1}$。额外的成本是一个内积，这在计算上是廉价的。因此，该陈述是错误的。\n**结论：不正确。**", "answer": "$$\\boxed{BD}$$", "id": "3433972"}]}