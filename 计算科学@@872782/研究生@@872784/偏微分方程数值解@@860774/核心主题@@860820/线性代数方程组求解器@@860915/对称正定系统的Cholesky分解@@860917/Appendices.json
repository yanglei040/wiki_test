{"hands_on_practices": [{"introduction": "理解一个算法的效率是应用它的第一步。这个练习将引导你从第一性原理出发，精确计算稠密矩阵 Cholesky 分解所需的浮点运算（flop）次数 [@problem_id:3370813]。通过这个过程，你将亲自验证其计算复杂度为 $\\frac{n^3}{3} + O(n^2)$，并将其与求解线性系统所需的正向和反向替换步骤的成本进行比较，从而对整个求解过程的计算开销有一个扎实的理解。", "problem": "考虑一个对称正定线性系统 $A x = b$，该系统源于对均匀网格上的均匀椭圆偏微分方程（PDE）（例如二维泊松方程）进行有限差分法离散化。假设 $A \\in \\mathbb{R}^{n \\times n}$ 被视为稠密矩阵，并通过 Cholesky 分解 $A = L L^{\\top}$ 进行因式分解，其中 $L$ 是一个对角线元素为正的下三角矩阵。采用以下算术成本模型：每次浮点加法、减法、乘法、除法和平方根运算计为 1 次浮点运算（flop）。\n\n任务：\n- 从使用内积逐列计算 $L$ 的标准非分块 Cholesky 算法出发，根据第一性原理推导分解 $A$ 所需的精确总浮点运算次数，表示为关于 $n$ 的多项式，并由此证明其为 $n^{3}/3 + O(n^{2})$。\n- 使用标准前向替换法求解 $L y = b$ 和回代法求解 $L^{\\top} x = y$，推导每次三角求解的精确浮点运算次数。\n- 结合您的结果，得出一个关于 $n$ 的单一简化闭式表达式，表示通过 Cholesky 分解 $A$ 然后通过前向替换和回代法为单个右端项求解 $A x = b$ 所需的精确总浮点运算次数。\n\n作为最终答案，仅报告合并步骤得到的精确总浮点运算次数，并简化为关于 $n$ 的单一多项式。无需四舍五入。", "solution": "根据指定标准审查问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 方程组是一个线性系统 $A x = b$。\n- 矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定（SPD）的，并被视为稠密矩阵。\n- 该系统将使用 Cholesky 分解 $A = L L^{\\top}$ 求解，其中 $L$ 是一个对角线元素为正的下三角矩阵。\n- 求解过程包括三个阶段：\n    1.  Cholesky 分解：$A \\to L$。\n    2.  前向替换：求解 $L y = b$ 以得到 $y$。\n    3.  回代：求解 $L^{\\top} x = y$ 以得到 $x$。\n- 算术成本模型将一次浮点运算（flop）定义为一次加法、减法、乘法、除法或平方根运算。\n- 任务是：\n    1.  使用基于内积的标准逐列算法，推导 Cholesky 分解的精确总浮点运算次数，并将结果表示为关于 $n$ 的多项式。\n    2.  推导前向替换和回代步骤的精确浮点运算次数。\n    3.  将所有计数合并为一个单一的简化闭式表达式，用于表示求解 $A x = b$ 所需的总浮点运算次数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于数值线性代数中的基本和标准概念——Cholesky 分解和三角求解。浮点运算次数分析是科学计算中的一个典型练习。\n- **良构性：** 该问题清楚地指明了算法、成本模型和期望的输出形式。这种结构确保了存在唯一且有意义的解。\n- **客观性：** 该问题使用精确、无歧义的数学语言陈述，不含主观内容。\n\n该问题没有表现出说明中列出的任何缺陷，如科学上不合理、不完整、矛盾或模糊。这是一个数值分析中定义明确的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供详细的解法。\n\n### 解法推导\n\n设 $A = (a_{ij})$ 和 $L = (l_{ij})$ 为 $n \\times n$ 矩阵，其中当 $j > i$ 时 $l_{ij}=0$。Cholesky 分解由矩阵方程 $A = L L^{\\top}$ 定义。这对应于标量方程：\n$$a_{ij} = \\sum_{k=1}^{\\min(i,j)} l_{ik} l_{jk}$$\n我们将推导所需三个阶段中每一个阶段的浮点运算次数。\n\n**1. Cholesky 分解（$A = L L^{\\top}$）的浮点运算次数**\n\n问题指定了使用内积的逐列算法。对于每一列 $j = 1, 2, \\dots, n$，我们计算元素 $l_{jj}$ 和 $i > j$ 时的 $l_{ij}$。\n\n对于对角线元素 $l_{jj}$：\n由 $a_{jj} = \\sum_{k=1}^{j} l_{jk}^2 = \\sum_{k=1}^{j-1} l_{jk}^2 + l_{jj}^2$，我们求解 $l_{jj}$：\n$$l_{jj} = \\sqrt{a_{jj} - \\sum_{k=1}^{j-1} l_{jk}^2}$$\n- 求和 $\\sum_{k=1}^{j-1} l_{jk}^2$ 涉及 $j-1$ 次乘法和 $j-2$ 次加法。（对于 $j=1$，求和为空，其成本为 $0$）。这是一个长度为 $j-1$ 的向量与其自身的内积。当 $j>1$ 时，成本为 $2(j-1)-1 = 2j-3$ 次浮点运算。\n- $l_{jj}$ 的计算除了求和之外还需要一次减法和一次平方根运算。\n- 因此，计算 $l_{jj}$ 的浮点运算次数对于 $j>1$ 是 $(2j-3) + 1 + 1 = 2j-1$ 次。对于 $j=1$，成本是 1 次浮点运算（一次平方根）。公式 $2j-1$ 对于 $j=1$ 也得出 1，因此该公式普遍适用。\n\n对于非对角线元素 $l_{ij}$（其中 $i > j$）：\n由 $a_{ij} = \\sum_{k=1}^{j} l_{ik} l_{jk} = \\sum_{k=1}^{j-1} l_{ik} l_{jk} + l_{ij} l_{jj}$，我们求解 $l_{ij}$：\n$$l_{ij} = \\frac{1}{l_{jj}} \\left( a_{ij} - \\sum_{k=1}^{j-1} l_{ik} l_{jk} \\right)$$\n- 求和 $\\sum_{k=1}^{j-1} l_{ik} l_{jk}$ 是两个长度为 $j-1$ 的向量的内积。它需要 $j-1$ 次乘法和 $j-2$ 次加法，总共 $2(j-1)-1 = 2j-3$ 次浮点运算（对于 $j>1$）。\n- 然后，$l_{ij}$ 的计算需要一次减法和一次除法。\n- 计算单个 $l_{ij}$ 的浮点运算次数对于 $j>1$ 是 $(2j-3) + 1 + 1 = 2j-1$ 次。对于 $j=1$，成本是 1 次浮点运算（一次除法），这也由公式 $2j-1$ 给出。\n\n第 $j$ 列的总浮点运算次数是计算 $l_{jj}$ 和 $n-j$ 个元素 $l_{ij}$（对于 $i=j+1, \\dots, n$）的成本之和。\n第 $j$ 列的成本：\n$$C_j = (2j-1) + (n-j)(2j-1) = (1+n-j)(2j-1)$$\n\n分解的总浮点运算次数 $C_{fact}$ 是所有列成本的总和：\n$$C_{fact} = \\sum_{j=1}^{n} C_j = \\sum_{j=1}^{n} (n-j+1)(2j-1)$$\n让我们展开求和中的项：\n$(n-j+1)(2j-1) = -2j^2 + (2n+3)j - (n+1)$。\n我们来进行求和：\n$$C_{fact} = \\sum_{j=1}^{n} \\left( -2j^2 + (2n+3)j - (n+1) \\right)$$\n$$C_{fact} = -2\\sum_{j=1}^{n} j^2 + (2n+3)\\sum_{j=1}^{n} j - (n+1)\\sum_{j=1}^{n} 1$$\n使用标准幂和公式：$\\sum_{j=1}^{n} 1 = n$, $\\sum_{j=1}^{n} j = \\frac{n(n+1)}{2}$, $\\sum_{j=1}^{n} j^2 = \\frac{n(n+1)(2n+1)}{6}$。\n$$C_{fact} = -2 \\left( \\frac{n(n+1)(2n+1)}{6} \\right) + (2n+3) \\left( \\frac{n(n+1)}{2} \\right) - n(n+1)$$\n提取公因式 $n(n+1)$：\n$$C_{fact} = n(n+1) \\left[ -\\frac{2n+1}{3} + \\frac{2n+3}{2} - 1 \\right]$$\n$$C_{fact} = n(n+1) \\left[ \\frac{-2(2n+1) + 3(2n+3) - 6}{6} \\right]$$\n$$C_{fact} = n(n+1) \\left[ \\frac{-4n - 2 + 6n + 9 - 6}{6} \\right]$$\n$$C_{fact} = n(n+1) \\left[ \\frac{2n+1}{6} \\right] = \\frac{n(n+1)(2n+1)}{6}$$\n展开这个多项式得到：\n$$C_{fact} = \\frac{n(2n^2 + 3n + 1)}{6} = \\frac{2n^3 + 3n^2 + n}{6} = \\frac{n^3}{3} + \\frac{n^2}{2} + \\frac{n}{6}$$\n这表明分解成本确实是 $\\frac{n^3}{3} + O(n^2)$。\n\n**2. 三角求解的浮点运算次数**\n\n**前向替换（$L y = b$）：**\n我们求解 $y_i$，其中 $i=1, \\dots, n$：\n$$y_i = \\frac{1}{l_{ii}} \\left( b_i - \\sum_{j=1}^{i-1} l_{ij} y_j \\right)$$\n为求得总浮点运算次数 $C_{fwd}$，我们将每个 $i$ 的运算相加：\n- 对于 $i=1$，$y_1 = b_1 / l_{11}$ 需要 1 次除法。\n- 对于每个 $i > 1$，求和 $\\sum_{j=1}^{i-1} l_{ij} y_j$ 需要 $i-1$ 次乘法和 $i-2$ 次加法。然后，我们执行 1 次减法和 1 次除法。\n- 计算 $y_i$ 的总成本对于 $i > 1$ 是 $(i-1) + (i-2) + 1 + 1 = 2i-1$ 次浮点运算。\n前向替换的总次数是：\n$$C_{fwd} = 1 + \\sum_{i=2}^{n} (2i-1) = 1 + \\left( 2\\sum_{i=2}^{n} i - \\sum_{i=2}^{n} 1 \\right)$$\n$$C_{fwd} = 1 + 2\\left(\\frac{n(n+1)}{2} - 1\\right) - (n-1) = 1 + n(n+1) - 2 - n + 1 = n^2+n-n = n^2$$\n或者，按运算类型计数：\n- 乘法：$\\sum_{i=2}^{n} (i-1) = \\sum_{k=1}^{n-1} k = \\frac{n(n-1)}{2}$ 次浮点运算。\n- 加法/减法：$\\sum_{i=2}^{n} ((i-2)+1) = \\frac{n(n-1)}{2}$ 次浮点运算。\n- 除法：$\\sum_{i=1}^{n} 1 = n$ 次浮点运算。\n总计 $C_{fwd} = \\frac{n(n-1)}{2} + \\frac{n(n-1)}{2} + n = n(n-1) + n = n^2-n+n = n^2$。\n\n**回代（$L^{\\top} x = y$）：**\n我们求解 $x_i$，其中 $i=n, \\dots, 1$：\n$$x_i = \\frac{1}{l_{ii}} \\left( y_i - \\sum_{j=i+1}^{n} l_{ji} x_j \\right)$$\n其结构与前向替换相同。每行 $i$ 的运算次数取决于对角线右侧的非零元素数量，即 $n-i$。\n总浮点运算次数 $C_{bwd}$，根据对称性，与前向替换的情况相同。\n$$C_{bwd} = n^2$$\n\n**3. 总浮点运算次数**\n\n分解 $A$ 并求解 $A x = b$ 所需的总浮点运算次数是三个阶段成本的总和：\n$$C_{total} = C_{fact} + C_{fwd} + C_{bwd}$$\n$$C_{total} = \\left( \\frac{2n^3 + 3n^2 + n}{6} \\right) + n^2 + n^2$$\n$$C_{total} = \\frac{2n^3 + 3n^2 + n}{6} + 2n^2$$\n为了将它们合并成一个单一的表达式，我们找到一个公分母：\n$$C_{total} = \\frac{2n^3 + 3n^2 + n + 12n^2}{6}$$\n$$C_{total} = \\frac{2n^3 + 15n^2 + n}{6}$$\n这就是精确总浮点运算次数的简化闭式多项式表达式。", "answer": "$$\\boxed{\\frac{2n^3 + 15n^2 + n}{6}}$$", "id": "3370813"}, {"introduction": "理论的边界往往在实践中才能被最深刻地理解。Cholesky 分解法的一个核心前提是矩阵必须是对称正定（symmetric positive-definite, SPD）的。这个练习通过一个精心设计的反例，让你亲手尝试对一个非正定对称矩阵进行 Cholesky 分解 [@problem_id:3370787]。你将直接观察到算法在何处以及为何会失败，从而深刻理解为何正定性是该方法成功的基石，而非一个可有可无的数学条件。", "problem": "考虑在混合或约束提法下求解偏微分方程 (PDE) 的数值解，这种提法会导致对称鞍点系统。根据基本定义，一个对称正定 (SPD) 矩阵 $A$ 对所有非零 $x$ 满足 $x^{\\top} A x > 0$，并且此类矩阵允许进行无需主元选择的 Cholesky 分解 $A = L L^{\\top}$。在约束 PDE 模型中（例如，通过拉格朗日乘子施加积分约束），离散化通常会产生一个对称但不定的 Karush–Kuhn–Tucker (KKT) 系统，该系统不满足 SPD 性质。\n\n设 $A \\in \\mathbb{R}^{2 \\times 2}$ 为对称不定矩阵\n$$\nA \\;=\\; \\begin{pmatrix} 1  2 \\\\ 2  0 \\end{pmatrix},\n$$\n它代表了最小的非平凡鞍点结构。尝试对 $A$ 进行无主元选择的 Cholesky 分解 $A = L L^{\\top}$，其中 $L$ 为下三角矩阵。仅使用 Cholesky 分解过程的基本性质（即每一步都需要对当前更新后的对角线元素取平方根，并减去先前计算出的列的外积贡献），计算在消去第一列后遇到的更新后的第二对角线元素（第二个主元）。然后，根据你观察到的失败，论证为何对于求解偏微分方程离散化中出现的此类不定系统，带有对称主元选择的 $L D L^{\\top}$ 分解是稳健求解所必需的。\n\n将对 $A$ 进行无主元选择的 Cholesky 分解时遇到的第二个主元的确切值作为你的最终答案。无需四舍五入。", "solution": "基本设定是，对称正定 (SPD) 矩阵 $A$ 对所有非零 $x$ 满足 $x^{\\top} A x > 0$，等价地，$A$ 的所有顺序主子式均为正。对于此类矩阵，存在无主元选择的 Cholesky 分解 $A = L L^{\\top}$，其中 $L$ 是下三角矩阵，分解的每一步都通过对一个必须为严格正数的更新主元取平方根来形成新的对角线元素。\n\n对于在约束或混合 PDE 提法中出现的对称不定矩阵（例如，通过拉格朗日乘子施加积分约束的 KKT 系统），SPD 性质不再成立，因此尝试进行无主元选择的 Cholesky 分解可能会遇到非正主元，从而阻碍分解过程。\n\n我们分析给定的矩阵\n$$\nA \\;=\\; \\begin{pmatrix} 1  2 \\\\ 2  0 \\end{pmatrix}.\n$$\n开始尝试进行无主元选择的 Cholesky 分解。记\n$$\nL \\;=\\; \\begin{pmatrix} \\ell_{11}  0 \\\\ \\ell_{21}  \\ell_{22} \\end{pmatrix}.\n$$\n第一个主元是 $(1,1)$ 元素 $a_{11} = 1$。第一步需要\n$$\n\\ell_{11} \\;=\\; \\sqrt{a_{11}} \\;=\\; \\sqrt{1} \\;=\\; 1,\n$$\n这是允许的，因为 $a_{11} > 0$。然后，第一列的次对角元计算如下\n$$\n\\ell_{21} \\;=\\; \\frac{a_{21}}{\\ell_{11}} \\;=\\; \\frac{2}{1} \\;=\\; 2.\n$$\n在消去第一列的贡献后，更新后的第二对角线元素（Cholesky 分解的第二个主元）是 $(1,1)$ 块的舒尔补：\n$$\na_{22}^{(1)} \\;=\\; a_{22} \\;-\\; \\ell_{21}^{2} \\;=\\; 0 \\;-\\; (2)^{2} \\;=\\; -4.\n$$\n这个更新后的主元是 $-4$，是负数。Cholesky 分解的这一步现在需要计算 $\\sqrt{a_{22}^{(1)}} = \\sqrt{-4}$，其结果不是实数，因此无主元选择的 Cholesky 分解失败。等价地，第二个顺序主子式为负：\n$$\n\\det(A) \\;=\\; (1)(0) - (2)(2) \\;=\\; -4 \\; 0,\n$$\n这证实了矩阵的不定性以及对 Cholesky 分解的阻碍。\n\n这次失败解释了为什么对此类系统而言，带有对称主元选择的 $L D L^{\\top}$ 分解是必要的。在 $L D L^{\\top}$ 分解中，对角因子 $D$ 可以包含 $1 \\times 1$ 和 $2 \\times 2$ 的块，这使得算法能够处理负主元或零主元，而无需对非正数取平方根。对称主元选择（例如，Bunch–Kaufman 族的策略）会选择稳定的 $1 \\times 1$ 或 $2 \\times 2$ 主元，从而在存在不定性的情况下确保数值稳健性。对于上述矩阵 $A$，可以直接选取一个 $2 \\times 2$ 的主元块，从而得到一个有效的 $L D L^{\\top}$ 表示，其中 $D$ 中的块捕捉了不定的耦合关系，而无主元选择的 Cholesky 分解则无法通过第二个主元。这正是在约束偏微分方程离散化产生的鞍点系统中所遇到的情况，其中不定结构要求使用带有对称主元选择的 $L D L^{\\top}$ 分解来进行稳健的直接求解或预处理。", "answer": "$$\\boxed{-4}$$", "id": "3370787"}, {"introduction": "在求解由偏微分方程（PDE）离散化产生的大型稀疏线性系统时，直接进行 Cholesky 分解可能成本过高。一种更高效的策略是使用迭代法，并通过“预处理”来加速其收敛。这个练习将向你展示如何将 Cholesky 分解的思想转化为一种强大的预处理器，即不完全 Cholesky 分解（IC(0)） [@problem_id:3370799]。你将为一个源自 PDE 的具体 $4 \\times 4$ 矩阵构建 IC(0) 预处理器，并量化比较预处理共轭梯度法（PCG）相对于标准共轭梯度法（CG）在收敛速度上的显著提升。", "problem": "考虑模型椭圆边值问题 $-\\Delta u = f$，该问题定义在单位正方形上，并带有齐次狄利克雷边界条件。在具有 $2 \\times 2$ 个内部点的均匀网格上，使用标准五点有限差分格式并按字典序（逐行）排序，得到的对称正定（SPD）线性系统的系数矩阵为 $A \\in \\mathbb{R}^{4 \\times 4}$，由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n4  -1  -1  0 \\\\\n-1  4  0  -1 \\\\\n-1  0  4  -1 \\\\\n0  -1  -1  4\n\\end{pmatrix}.\n$$\n为简单起见，均匀网格间距的缩放因子已被吸收到 $A$ 中；这不影响下面的分析。设右端项为 $b = (1,0,0,0)^{\\top}$，初始猜测为 $x_0 = 0$。将零填充不完全 Cholesky 分解（IC$(0)$）定义为一个下三角矩阵 $L$，其稀疏模式与 $A$ 的下三角部分一致，使得预条件子 $M = L L^{\\top}$ 近似于 $A$。使用左预处理，即预处理共轭梯度（PCG）方法将 $M^{-1}$ 应用于残差。\n\n任务：\n- 根据 $A$ 的下三角部分的自然稀疏模式，为 $A$ 的 IC$(0)$ 分解构造 $L$。\n- 执行一次非预处理共轭梯度（CG）方法迭代和一次使用 $M^{-1}$ 的左预处理CG（PCG）迭代，两者均从 $x_0 = 0$ 开始。将得到的残差分别记为 $r_1^{\\mathrm{unpre}}$ 和 $r_1^{\\mathrm{pre}}$。\n- 计算欧几里得范数 $\\|r_1^{\\mathrm{unpre}}\\|_2$ 和 $\\|r_1^{\\mathrm{pre}}\\|_2$。\n- 通过单个标量因子 $\\mathcal{I} = \\|r_1^{\\mathrm{unpre}}\\|_2 / \\|r_1^{\\mathrm{pre}}\\|_2$ 来量化PCG相对于非预处理CG的改进。\n\n将最终答案表示为单个精确的解析表达式。无需四舍五入，最终表达式中不包含单位。", "solution": "该问题是适定的，有科学依据，并提供了执行所要求计算的所有必要信息。这是数值线性代数中的一个标准练习。我们开始求解。\n\n问题要求计算在一次非预处理和预处理共轭梯度方法迭代后得到的改进因子 $\\mathcal{I} = \\|r_1^{\\mathrm{unpre}}\\|_2 / \\|r_1^{\\mathrm{pre}}\\|_2$。给定矩阵为\n$$\nA = \\begin{pmatrix}\n4  -1  -1  0 \\\\\n-1  4  0  -1 \\\\\n-1  0  4  -1 \\\\\n0  -1  -1  4\n\\end{pmatrix}\n$$\n右端项为 $b = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}^{\\top}$，初始猜测为 $x_0 = \\begin{pmatrix} 0  0  0  0 \\end{pmatrix}^{\\top}$。\n\n首先，我们构造零填充不完全 Cholesky 分解 (IC($0$))，$L$。矩阵 $L$ 必须具有与 $A$ 的下三角部分相同的稀疏模式。\n$$\nL = \\begin{pmatrix}\nl_{11}  0  0  0 \\\\\nl_{21}  l_{22}  0  0 \\\\\nl_{31}  0  l_{33}  0 \\\\\n0  l_{42}  l_{43}  l_{44}\n\\end{pmatrix}\n$$\n$L$ 的元素计算方式使得 $(LL^{\\top})_{ij} \\approx A_{ij}$。IC($0$) 算法给出：\n$l_{11} = \\sqrt{a_{11}} = \\sqrt{4} = 2$。\n$l_{21} = a_{21} / l_{11} = -1 / 2$。\n$l_{31} = a_{31} / l_{11} = -1 / 2$。\n$l_{22} = \\sqrt{a_{22} - l_{21}^2} = \\sqrt{4 - (-1/2)^2} = \\sqrt{4 - 1/4} = \\sqrt{15/4} = \\frac{\\sqrt{15}}{2}$。\n$l_{33} = \\sqrt{a_{33} - l_{31}^2} = \\sqrt{4 - (-1/2)^2} = \\sqrt{15/4} = \\frac{\\sqrt{15}}{2}$。\n$l_{42} = (a_{42} - l_{41}l_{21}) / l_{22} = a_{42}/l_{22}$ (因为 $l_{41}=0$) $= -1 / (\\frac{\\sqrt{15}}{2}) = -\\frac{2}{\\sqrt{15}}$。\n$l_{43} = (a_{43} - l_{41}l_{31} - l_{42}l_{32}) / l_{33} = a_{43}/l_{33}$ (因为 $l_{41}=0, l_{32}=0$) $= -1 / (\\frac{\\sqrt{15}}{2}) = -\\frac{2}{\\sqrt{15}}$。\n$l_{44} = \\sqrt{a_{44} - (l_{42}^2 + l_{43}^2)} = \\sqrt{4 - (-\\frac{2}{\\sqrt{15}})^2 - (-\\frac{2}{\\sqrt{15}})^2} = \\sqrt{4 - \\frac{4}{15} - \\frac{4}{15}} = \\sqrt{\\frac{60-8}{15}} = \\sqrt{\\frac{52}{15}} = \\frac{2\\sqrt{13}}{\\sqrt{15}}$。\n所以，IC($0$) 因子为\n$$\nL = \\begin{pmatrix}\n2  0  0  0 \\\\\n-1/2  \\sqrt{15}/2  0  0 \\\\\n-1/2  0  \\sqrt{15}/2  0 \\\\\n0  -2/\\sqrt{15}  -2/\\sqrt{15}  2\\sqrt{13}/\\sqrt{15}\n\\end{pmatrix}\n$$\n预条件子为 $M = LL^{\\top}$。\n\n接下来，我们执行一次非预处理共轭梯度（CG）迭代。\n从 $x_0 = 0$ 开始，初始残差为 $r_0 = b - Ax_0 = b = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}^{\\top}$。\n初始搜索方向为 $p_0 = r_0$。\n步长 $\\alpha_0$ 为 $\\alpha_0 = \\frac{r_0^{\\top} r_0}{p_0^{\\top} A p_0}$。\n$r_0^{\\top} r_0 = 1^2 = 1$。\n$A p_0 = A r_0 = \\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -1 \\\\ -1 \\\\ 0 \\end{pmatrix}$。\n$p_0^{\\top} A p_0 = r_0^{\\top} (A r_0) = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -1 \\\\ -1 \\\\ 0 \\end{pmatrix} = 4$。\n所以, $\\alpha_0 = 1/4$。\n第一次迭代的结果为 $x_1 = x_0 + \\alpha_0 p_0 = \\frac{1}{4} \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}^{\\top}$。\n新的残差为 $r_1^{\\mathrm{unpre}} = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{4} \\begin{pmatrix} 4 \\\\ -1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/4 \\\\ 1/4 \\\\ 0 \\end{pmatrix}$。\n欧几里得范数为 $\\|r_1^{\\mathrm{unpre}}\\|_2 = \\sqrt{0^2 + (1/4)^2 + (1/4)^2 + 0^2} = \\sqrt{2/16} = \\sqrt{1/8} = \\frac{1}{2\\sqrt{2}}$。\n\n现在，我们执行一次预处理共轭梯度（PCG）迭代。\n初始残差为 $r_0 = b = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}^{\\top}$。\n我们求解预处理系统 $M z_0 = r_0$，即 $LL^{\\top}z_0=r_0$。\n首先，通过向前代入法求解 $Ly=r_0$：\n$2y_1 = 1 \\implies y_1=1/2$。\n$-\\frac{1}{2}y_1 + \\frac{\\sqrt{15}}{2}y_2 = 0 \\implies y_2 = \\frac{y_1}{\\sqrt{15}} = \\frac{1}{2\\sqrt{15}}$。\n$-\\frac{1}{2}y_1 + \\frac{\\sqrt{15}}{2}y_3 = 0 \\implies y_3 = \\frac{y_1}{\\sqrt{15}} = \\frac{1}{2\\sqrt{15}}$。\n$-\\frac{2}{\\sqrt{15}}y_2 - \\frac{2}{\\sqrt{15}}y_3 + \\frac{2\\sqrt{13}}{\\sqrt{15}}y_4 = 0 \\implies \\sqrt{13}y_4 = y_2+y_3 = \\frac{1}{\\sqrt{15}} \\implies y_4 = \\frac{1}{\\sqrt{13}\\sqrt{15}}$。\n接下来，通过向后代入法求解 $L^{\\top}z_0=y$：\n$\\frac{2\\sqrt{13}}{\\sqrt{15}}z_{04} = y_4 = \\frac{1}{\\sqrt{13}\\sqrt{15}} \\implies 2\\sqrt{13}z_{04} = \\frac{1}{\\sqrt{13}} \\implies z_{04} = \\frac{1}{26}$。\n$\\frac{\\sqrt{15}}{2}z_{03} - \\frac{2}{\\sqrt{15}}z_{04} = y_3 = \\frac{1}{2\\sqrt{15}} \\implies 15z_{03}-4z_{04} = 1 \\implies 15z_{03} = 1+4/26 = 15/13 \\implies z_{03} = 1/13$。\n根据对称性，$z_{02} = 1/13$。\n$2z_{01} - \\frac{1}{2}z_{02} - \\frac{1}{2}z_{03} = y_1 = 1/2 \\implies 2z_{01} = 1/2 + \\frac{1}{2}(1/13) + \\frac{1}{2}(1/13) = 1/2+1/13 = 15/26 \\implies z_{01}=15/52$。\n所以，$z_0 = \\begin{pmatrix} 15/52  1/13  1/13  1/26 \\end{pmatrix}^{\\top} = \\frac{1}{52}\\begin{pmatrix} 15  4  4  2 \\end{pmatrix}^{\\top}$。\n初始搜索方向为 $p_0 = z_0$。\n步长为 $\\alpha_0 = \\frac{r_0^{\\top} z_0}{p_0^{\\top} A p_0}$。\n$r_0^{\\top} z_0 = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix} z_0 = z_{01} = 15/52$。\n$A p_0 = A z_0 = \\frac{1}{52}\\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix} \\begin{pmatrix} 15 \\\\ 4 \\\\ 4 \\\\ 2 \\end{pmatrix} = \\frac{1}{52}\\begin{pmatrix} 60-4-4 \\\\ -15+16-2 \\\\ -15+16-2 \\\\ -4-4+8 \\end{pmatrix} = \\frac{1}{52}\\begin{pmatrix} 52 \\\\ -1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1/52 \\\\ -1/52 \\\\ 0 \\end{pmatrix}$。\n$p_0^{\\top} A p_0 = z_0^{\\top}(Az_0) = \\frac{1}{52}\\begin{pmatrix} 15  4  4  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1/52 \\\\ -1/52 \\\\ 0 \\end{pmatrix} = \\frac{1}{52}(15 - \\frac{4}{52} - \\frac{4}{52}) = \\frac{1}{52}(15-\\frac{2}{13}) = \\frac{1}{52}(\\frac{195-2}{13}) = \\frac{193}{676}$。\n$\\alpha_0 = \\frac{15/52}{193/676} = \\frac{15}{52}\\frac{676}{193} = \\frac{15 \\times 13}{193} = \\frac{195}{193}$。\n新的残差为 $r_1^{\\mathrm{pre}} = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{195}{193}\\begin{pmatrix} 1 \\\\ -1/52 \\\\ -1/52 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-195/193 \\\\ 195/(193 \\cdot 52) \\\\ 195/(193 \\cdot 52) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -2/193 \\\\ 195/10036 \\\\ 195/10036 \\\\ 0 \\end{pmatrix}$。\n范数为 $\\|r_1^{\\mathrm{pre}}\\|_2 = \\sqrt{(-\\frac{2}{193})^2 + (\\frac{195}{193 \\cdot 52})^2 + (\\frac{195}{193 \\cdot 52})^2}$。\n由于 $\\frac{195}{52} = \\frac{15 \\cdot 13}{4 \\cdot 13} = \\frac{15}{4}$，我们有\n$\\|r_1^{\\mathrm{pre}}\\|_2^2 = \\frac{1}{193^2} \\left( (-2)^2 + 2 \\cdot (\\frac{15}{4})^2 \\right) = \\frac{1}{193^2} \\left( 4 + 2 \\frac{225}{16} \\right) = \\frac{1}{193^2} \\left( 4 + \\frac{225}{8} \\right) = \\frac{1}{193^2} \\left( \\frac{32+225}{8} \\right) = \\frac{257}{8 \\cdot 193^2}$。\n所以，$\\|r_1^{\\mathrm{pre}}\\|_2 = \\sqrt{\\frac{257}{8 \\cdot 193^2}} = \\frac{\\sqrt{257}}{193\\sqrt{8}} = \\frac{\\sqrt{257}}{193 \\cdot 2\\sqrt{2}}$。\n\n最后，我们计算改进因子 $\\mathcal{I}$。\n$\\mathcal{I} = \\frac{\\|r_1^{\\mathrm{unpre}}\\|_2}{\\|r_1^{\\mathrm{pre}}\\|_2} = \\frac{1/(2\\sqrt{2})}{\\sqrt{257}/(193 \\cdot 2\\sqrt{2})} = \\frac{1}{2\\sqrt{2}} \\cdot \\frac{193 \\cdot 2\\sqrt{2}}{\\sqrt{257}} = \\frac{193}{\\sqrt{257}}$。\n数字 $193$ 和 $257$ 是素数，所以此表达式不能进一步简化。", "answer": "$$\\boxed{\\frac{193}{\\sqrt{257}}}$$", "id": "3370799"}]}