{"hands_on_practices": [{"introduction": "要真正理解一个算法，最好的方法莫过于亲手执行一遍。本练习提供了一个具体的小规模算例，旨在引导你完整地完成单次双共轭梯度稳定（BiCGSTAB）方法的迭代计算。通过追踪每一步的计算，从更新残差到计算步长，你将对该方法的核心机制建立起牢固而直观的认识[@problem_id:3585874]。", "problem": "考虑非奇异线性方程组 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$。克雷洛夫子空间方法通过根据彼得罗夫-伽辽金条件和在低维子空间中进行残差最小化等原则对残差 $r_{k} = b - A x_{k}$ 进行投影，来构造近似解 $x_{k}$。双共轭梯度稳定方法 (BiCGSTAB) 是将双共轭梯度 (BiCG) 方法的双正交投影特性与一个局部残差最小化稳定步相结合而得到的。\n\n从以下经过充分检验的原则出发：\n- 欧几里得内积为 $\\langle u, v \\rangle = u^{\\top} v$，欧几里得 (二-)范数为 $\\|u\\|_{2} = \\sqrt{\\langle u, u \\rangle}$。\n- 对于通过搜索方向更新得到的中间残差，使用固定的非零“影子残差” $\\tilde r$ 的彼得罗夫-伽辽金投影强制要求 $\\langle \\tilde r, r_{k+1} \\rangle = 0$。\n- 给定一个非零的中间残差 $s_{k}$，在 $\\omega \\in \\mathbb{R}$ 上最小化 $\\|s_{k} - \\omega A s_{k}\\|_{2}$ 的标量 $\\omega_{k}$ 由最小二乘问题产生的正规方程确定。\n\n使用这些原则，对以下具体数据执行一次完整的双共轭梯度稳定 (BiCGSTAB) 方法迭代：\n$$\nA = \\begin{bmatrix}2  -1 \\\\ 1  3\\end{bmatrix}, \\quad\nb = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}, \\quad\nx_{0} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}, \\quad\n\\tilde r = r_{0},\n$$\n使用标准初始化 $r_{0} = b - A x_{0}$ 和 $p_{0} = r_{0}$。数值计算以下标量和向量：\n$$\n\\rho_{0}, \\ \\alpha_{0}, \\ s_{0}, \\ \\omega_{0}, \\ x_{1}, \\ r_{1}, \\ p_{1}.\n$$\n\n作答要求：\n- 使用标准欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$。\n- 作为最终报告的量，请提供单个标量值 $\\|r_{1}\\|_{2}^{2}$，结果应为最简形式的精确有理数。\n- 不要四舍五入；由于要求的是精确有理数答案，因此不需要关于有效数字的说明。", "solution": "经评估，问题陈述是有效的。它在科学上基于数值线性代数的既定原则，特别是双共轭梯度稳定 (BiCGSTAB) 方法。该问题是适定的，为算法的一次完整迭代提供了所有必要的数据。数据和目标陈述客观，没有矛盾或含糊不清之处。因此，我将开始解答。\n\n任务是为给定的线性方程组 $A x = b$ 执行一次完整的 BiCGSTAB 方法迭代。该算法由一系列明确定义的步骤组成。我们从索引 $k=0$ 开始。\n\n**步骤 0：初始化**\n\n解的初始猜测值为 $x_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n初始残差 $r_{0}$ 计算为 $r_{0} = b - A x_{0}$。\n给定 $A = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix}$ 和 $b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$：\n$A x_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n因此，$r_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n问题指定初始“影子残差”为 $\\tilde{r}_{0} = r_{0}$，所以 $\\tilde{r}_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n初始搜索方向为 $p_{0} = r_{0}$，所以 $p_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n**迭代 $k=0$**\n\n1.  **计算 $\\rho_{0}$：**\n    标量 $\\rho_{0}$ 由内积 $\\rho_{0} = \\langle \\tilde{r}_{0}, r_{0} \\rangle$ 定义。\n    使用欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$：\n    $\\rho_{0} = r_{0}^{\\top} r_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = (1)(1) + (0)(0) = 1$。\n\n2.  **计算 $v_{0} = A p_{0}$：**\n    $v_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} (2)(1) + (-1)(0) \\\\ (1)(1) + (3)(0) \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n\n3.  **计算 $\\alpha_{0}$：**\n    标量 $\\alpha_{0}$ 是从关于中间更新的彼得罗夫-伽辽金条件推导出来的，即 $\\alpha_{0} = \\frac{\\rho_{0}}{\\langle \\tilde{r}_{0}, v_{0} \\rangle}$。\n    分母中的内积为：\n    $\\langle \\tilde{r}_{0}, v_{0} \\rangle = \\tilde{r}_{0}^{\\top} v_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = (1)(2) + (0)(1) = 2$。\n    因此，$\\alpha_{0} = \\frac{1}{2}$。\n\n4.  **计算中间残差 $s_{0}$：**\n    $s_{0} = r_{0} - \\alpha_{0} v_{0}$。\n    $s_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{1}{2} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 1/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$。\n\n5.  **计算 $t_{0} = A s_{0}$：**\n    $t_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} (2)(0) + (-1)(-1/2) \\\\ (1)(0) + (3)(-1/2) \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix}$。\n\n6.  **计算 $\\omega_{0}$：**\n    选择标量 $\\omega_{0}$ 以最小化 $\\|s_{0} - \\omega A s_{0}\\|_{2}$，这等价于最小化 $\\|s_{0} - \\omega t_{0}\\|_{2}$。这个最小二乘问题的解由正规方程给出，从而得到 $\\omega_{0} = \\frac{\\langle s_{0}, t_{0} \\rangle}{\\langle t_{0}, t_{0} \\rangle}$。\n    首先，我们计算必要的内积：\n    $\\langle s_{0}, t_{0} \\rangle = s_{0}^{\\top} t_{0} = \\begin{bmatrix} 0  -1/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (0)(1/2) + (-1/2)(-3/2) = \\frac{3}{4}$。\n    $\\langle t_{0}, t_{0} \\rangle = t_{0}^{\\top} t_{0} = \\begin{bmatrix} 1/2  -3/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (\\frac{1}{2})^{2} + (-\\frac{3}{2})^{2} = \\frac{1}{4} + \\frac{9}{4} = \\frac{10}{4} = \\frac{5}{2}$。\n    因此，$\\omega_{0} = \\frac{3/4}{5/2} = \\frac{3}{4} \\cdot \\frac{2}{5} = \\frac{6}{20} = \\frac{3}{10}$。\n\n7.  **更新解以得到 $x_{1}$：**\n    $x_{1} = x_{0} + \\alpha_{0} p_{0} + \\omega_{0} s_{0}$。\n    $x_{1} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{1}{2} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\frac{3}{10} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ -3/20 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$。\n\n8.  **更新残差以得到 $r_{1}$：**\n    $r_{1} = s_{0} - \\omega_{0} t_{0}$。\n    $r_{1} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -5/10 \\end{bmatrix} - \\begin{bmatrix} 3/20 \\\\ -9/20 \\end{bmatrix} = \\begin{bmatrix} 0 - 3/20 \\\\ -10/20 - (-9/20) \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n\n9.  **更新搜索方向以得到 $p_{1}$：**\n    这需要计算 $\\rho_{1}$ 和 $\\beta_{0}$。\n    $\\rho_{1} = \\langle \\tilde{r}_{0}, r_{1} \\rangle = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} = -\\frac{3}{20}$。\n    $\\beta_{0} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{\\alpha_{0}}{\\omega_{0}} = \\frac{-3/20}{1} \\frac{1/2}{3/10} = -\\frac{3}{20} \\cdot \\frac{1}{2} \\cdot \\frac{10}{3} = -\\frac{30}{120} = -\\frac{1}{4}$。\n    搜索方向更新为 $p_{1} = r_{1} + \\beta_{0} (p_{0} - \\omega_{0} v_{0})$。\n    首先，计算括号中的项：\n    $p_{0} - \\omega_{0} v_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 6/10 \\\\ 3/10 \\end{bmatrix} = \\begin{bmatrix} 4/10 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix}$。\n    现在，计算 $p_{1}$：\n    $p_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} + (-\\frac{1}{4}) \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} - \\begin{bmatrix} 2/20 \\\\ -3/40 \\end{bmatrix} = \\begin{bmatrix} -5/20 \\\\ -2/40 + 3/40 \\end{bmatrix} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n第一次完整迭代计算出的量为：\n$\\rho_{0} = 1$, $\\alpha_{0} = \\frac{1}{2}$, $s_{0} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$, $\\omega_{0} = \\frac{3}{10}$, $x_{1} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$, $r_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$, $p_{1} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n**最终计算**\n\n题目要求计算 $\\|r_{1}\\|_{2}^{2}$。\n$\\|r_{1}\\|_{2}^{2} = \\langle r_{1}, r_{1} \\rangle = r_{1}^{\\top} r_{1} = \\begin{bmatrix} -3/20  -1/20 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n$\\|r_{1}\\|_{2}^{2} = (-\\frac{3}{20})^{2} + (-\\frac{1}{20})^{2} = \\frac{9}{400} + \\frac{1}{400} = \\frac{10}{400} = \\frac{1}{40}$。\n结果是一个精确的有理数，符合题目要求。", "answer": "$$\\boxed{\\frac{1}{40}}$$", "id": "3585874"}, {"introduction": "掌握了标准流程后，我们可以通过探索特殊情况来加深理解。这个练习探讨了一种有趣的情形：当BiCGSTAB的“稳定”步骤产生零校正（即 $\\omega_k=0$）时会发生什么。这种假设性场景是一个绝佳的思想实验，它揭示了算法中双共轭梯度（BiCG）部分与最小残差步骤之间的内在联系，并阐明了“稳定”一词的真正含义[@problem_id:3616023]。", "problem": "考虑一个产生于粘声介质频率域地震波场模拟的线性系统 $A x = b$，其中 $A \\in \\mathbb{C}^{n \\times n}$ 是一个由于吸收边界条件和衰减而形成的大型、稀疏、非厄米矩阵。应用基于双共轭梯度稳定 (BiCGSTAB) 方法的迭代求解器来近似解。设初始猜测值为 $x_{0}$，初始残差为 $r_{0} = b - A x_{0}$，影子残差为 $r^{\\sharp}$ 且满足 $\\langle r^{\\sharp}, r_{0}\\rangle \\neq 0$，其中 $\\langle \\cdot, \\cdot \\rangle$ 表示 $\\mathbb{C}^{n}$ 上的标准欧几里得内积，并约定 $\\langle u, v \\rangle = v^{*} u$。通过常规的非对称克雷洛夫投影定义初始搜索方向 $p_{0} = r_{0}$ 和标量 $\\alpha_{1}$，然后构成中间残差\n$$\ns_{1} = r_{0} - \\alpha_{1} A p_{0}.\n$$\n该方法接下来通过最小化残差 $r_{1}(\\omega) = s_{1} - \\omega t_{1}$ 的2-范数平方来寻求一个稳定化标量 $\\omega_{1}$，其中 $t_{1} = A s_{1}$。最小值点 $\\omega_{1}$ 由条件 $r_{1}(\\omega)$ 在一维仿射子空间 $\\{s_{1} - \\omega t_{1} : \\omega \\in \\mathbb{C}\\}$ 中具有最小2-范数来确定。\n\n假设一个与强非均匀衰减相关的情景，其中 $A$ 对 $s_{1}$ 的作用产生一个在欧几里得内积意义下与 $s_{1}$ 正交的向量 $t_{1}$，即：\n$$\n\\langle t_{1}, s_{1} \\rangle = 0 \\quad \\text{and} \\quad \\langle t_{1}, t_{1} \\rangle \\neq 0.\n$$\n在这些假设下，确定最小化标量 $\\omega_{1}$，并推导迭代值和残差的更新结果，\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + \\omega_{1} s_{1}, \\qquad r_{1} = s_{1} - \\omega_{1} t_{1}.\n$$\n将最终答案以一个单行矩阵的形式给出，该矩阵包含 $\\omega_{1}$、$x_{1}$ 和 $r_{1}$ 这三个条目，并用 $x_{0}$、$p_{0}$、$\\alpha_{1}$ 和 $s_{1}$ 进行符号化表示。无需进行数值计算，也无需四舍五入。", "solution": "用户提出了一个来自计算地球物理学领域的问题，具体涉及使用双共轭梯度稳定(BiCGSTAB)方法求解线性系统。按照流程，必须首先对问题进行严格验证。\n\n### 步骤1：提取已知条件\n问题提供了以下数据和定义：\n-   一个线性系统 $A x = b$，其中 $A \\in \\mathbb{C}^{n \\times n}$ 是大型、稀疏和非厄米矩阵。\n-   初始猜测值为 $x_{0}$。\n-   初始残差为 $r_{0} = b - A x_{0}$。\n-   存在一个影子残差 $r^{\\sharp}$，使得 $\\langle r^{\\sharp}, r_{0}\\rangle \\neq 0$。\n-   $\\mathbb{C}^{n}$ 上的内积定义为 $\\langle u, v \\rangle = v^{*} u$。\n-   初始搜索方向为 $p_{0} = r_{0}$。\n-   对于某个标量 $\\alpha_{1}$，中间残差定义为 $s_{1} = r_{0} - \\alpha_{1} A p_{0}$。\n-   向量 $t_{1}$ 定义为 $t_{1} = A s_{1}$。\n-   寻求一个稳定化标量 $\\omega_{1}$ 以最小化 $r_{1}(\\omega) = s_{1} - \\omega t_{1}$ 的2-范数平方。\n-   假设了一个特定条件：$\\langle t_{1}, s_{1} \\rangle = 0$ 且 $\\langle t_{1}, t_{1} \\rangle \\neq 0$。\n-   更新后的迭代值为 $x_{1} = x_{0} + \\alpha_{1} p_{0} + \\omega_{1} s_{1}$。\n-   更新后的残差为 $r_{1} = s_{1} - \\omega_{1} t_{1}$。\n-   任务是在给定条件下求出 $\\omega_{1}$、$x_{1}$ 和 $r_{1}$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n-   **科学上成立**：该问题在数值线性代数及其在地震模拟中的应用方面有充分的理论依据。BiCGSTAB方法是一种标准的迭代求解器。由于物理现象（衰减）和数值产物（吸收边界）而将矩阵 $A$ 描述为非厄米矩阵是准确的。BiCGSTAB算法的步骤是标准的。指定的内积定义是复向量空间中两种常见约定之一。条件 $\\langle t_1, s_1 \\rangle = 0$ 是为分析而提出的一个特定数学情景，并非声称其普遍发生。因此，该问题在科学上是合理的。\n-   **适定的**：该问题是适定的。它要求基于一组清晰的定义和一个特定的、数学上一致的假设来确定特定量（$\\omega_{1}$, $x_{1}$, $r_{1}$）。最小化一个二次函数的目标确保了唯一最小值点的存在。\n-   **客观的**：语言正式、精确，且不含主观性。所有术语在相关领域内都是标准的。\n-   该问题不存在以下列出的任何缺陷：\n    1.  没有科学或事实上的不合理之处。\n    2.  问题陈述规范，与主题直接相关。\n    3.  设置完整且一致；所有必要的量都已定义。\n    4.  条件并非物理上不可能，即使中心假设代表一个特定的、或许不常见的案例。\n    5.  问题不是病态的；可以推导出唯一、稳定的解。\n    6.  问题并非微不足道；它需要正确应用向量微积分和线性代数原理。\n    7.  问题是一个数学推导，因此是可验证的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。现在将提供一个合理的解决方案。\n\n### 解题推导\n目标是确定标量 $\\omega_{1} \\in \\mathbb{C}$，以最小化残差 $r_{1}(\\omega) = s_{1} - \\omega t_{1}$ 的2-范数平方。对于任意向量 $v \\in \\mathbb{C}^{n}$，2-范数平方定义为 $\\|v\\|_{2}^{2} = \\langle v, v \\rangle$。\n\n令 $f(\\omega)$ 为要最小化的函数：\n$$\nf(\\omega) = \\|s_{1} - \\omega t_{1}\\|_{2}^{2} = \\langle s_{1} - \\omega t_{1}, s_{1} - \\omega t_{1} \\rangle\n$$\n使用给定的内积定义 $\\langle u, v \\rangle = v^{*} u$，我们可以展开此表达式。标量-向量乘积的共轭转置是 $(\\omega t_1)^* = \\bar{\\omega} t_1^*$。\n$$\nf(\\omega) = (s_{1} - \\omega t_{1})^{*} (s_{1} - \\omega t_{1}) = (s_{1}^{*} - \\bar{\\omega} t_{1}^{*}) (s_{1} - \\omega t_{1})\n$$\n展开乘积可得：\n$$\nf(\\omega) = s_{1}^{*}s_{1} - \\omega s_{1}^{*}t_{1} - \\bar{\\omega} t_{1}^{*}s_{1} + \\bar{\\omega}\\omega t_{1}^{*}t_{1}\n$$\n我们可以使用内积符号表示这些项：\n-   $s_{1}^{*}s_{1} = \\langle s_{1}, s_{1} \\rangle = \\|s_{1}\\|_{2}^{2}$\n-   $t_{1}^{*}s_{1} = \\langle s_{1}, t_{1} \\rangle$\n-   $s_{1}^{*}t_{1} = (t_{1}^{*}s_{1})^{*} = \\langle s_{1}, t_{1} \\rangle^{*}$\n-   $t_{1}^{*}t_{1} = \\langle t_{1}, t_{1} \\rangle = \\|t_{1}\\|_{2}^{2}$\n\n将这些代入 $f(\\omega)$ 的表达式中：\n$$\nf(\\omega) = \\|s_{1}\\|_{2}^{2} - \\omega \\langle s_{1}, t_{1} \\rangle^{*} - \\bar{\\omega} \\langle s_{1}, t_{1} \\rangle + |\\omega|^{2} \\|t_{1}\\|_{2}^{2}\n$$\n为求最小值，我们可以将关于 $\\bar{\\omega}$ 的复导数设为零：\n$$\n\\frac{\\partial f}{\\partial \\bar{\\omega}} = - \\langle s_{1}, t_{1} \\rangle + \\omega \\|t_{1}\\|_{2}^{2} = 0\n$$\n对 $\\omega$ 求解，得到最小值点的一般表达式，我们将其记为 $\\omega_1$：\n$$\n\\omega_{1} = \\frac{\\langle s_{1}, t_{1} \\rangle}{\\|t_{1}\\|_{2}^{2}} = \\frac{\\langle s_{1}, t_{1} \\rangle}{\\langle t_{1}, t_{1} \\rangle}\n$$\n这是BiCGSTAB算法中 $\\omega_1$ 的标准公式。\n\n现在，我们应用问题陈述中给出的特定条件：$\\langle t_{1}, s_{1} \\rangle = 0$。\n复内积具有性质 $\\langle u, v \\rangle = \\overline{\\langle v, u \\rangle}$。因此：\n$$\n\\langle s_{1}, t_{1} \\rangle = \\overline{\\langle t_{1}, s_{1} \\rangle}\n$$\n给定 $\\langle t_{1}, s_{1} \\rangle = 0$，我们有：\n$$\n\\langle s_{1}, t_{1} \\rangle = \\overline{(0)} = 0\n$$\n$\\omega_1$ 表达式的分子为零。分母为 $\\langle t_{1}, t_{1} \\rangle$，题目明确说明其不为零。\n因此，$\\omega_1$ 的值为：\n$$\n\\omega_{1} = \\frac{0}{\\langle t_{1}, t_{1} \\rangle} = 0\n$$\n或者，将条件 $\\langle t_1, s_1 \\rangle = 0$（这意味着 $\\langle s_1, t_1 \\rangle = 0$）直接代入展开的函数 $f(\\omega)$ 中：\n$$\nf(\\omega) = \\|s_{1}\\|_{2}^{2} - \\omega(0) - \\bar{\\omega}(0) + |\\omega|^{2} \\|t_{1}\\|_{2}^{2} = \\|s_{1}\\|_{2}^{2} + |\\omega|^{2} \\|t_{1}\\|_{2}^{2}\n$$\n由于 $\\|s_{1}\\|_{2}^{2}$ 是一个非负常数，而 $\\|t_{1}\\|_{2}^{2}$ 是一个正常数（因为 $\\langle t_{1}, t_{1} \\rangle \\neq 0$），当 $|\\omega|^{2} \\|t_{1}\\|_{2}^{2}$ 项最小时，函数 $f(\\omega)$ 达到最小值。这发生在 $|\\omega|^{2}=0$ 时，即 $\\omega = 0$。因此，最小化标量是 $\\omega_1 = 0$。\n\n在确定了 $\\omega_{1} = 0$ 后，我们可以求出更新后的迭代值 $x_{1}$ 和残差 $r_{1}$。\n迭代值的更新公式为：\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + \\omega_{1} s_{1}\n$$\n代入 $\\omega_1=0$：\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + (0) s_{1} = x_{0} + \\alpha_{1} p_{0}\n$$\n残差的更新公式为：\n$$\nr_{1} = s_{1} - \\omega_{1} t_{1}\n$$\n代入 $\\omega_1=0$：\n$$\nr_{1} = s_{1} - (0) t_{1} = s_{1}\n$$\n条件 $\\langle t_1, s_1 \\rangle = \\langle As_1, s_1 \\rangle = 0$ 意味着BiCGSTAB的稳定化步骤没有对残差提供任何改进，因为最佳稳定化参数 $\\omega_1$ 为零。该方法在本次迭代中实际上简化为双共轭梯度方法的一个步骤，新的残差 $r_1$ 就是中间残差 $s_1$。\n\n所求的三个量，用指定变量表示为 $\\omega_1=0$，$x_1=x_0 + \\alpha_1 p_0$ 和 $r_1=s_1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  & x_{0} + \\alpha_{1} p_{0}  & s_{1}\n\\end{pmatrix}\n}\n$$", "id": "3616023"}, {"introduction": "成为一名优秀的计算科学家，不仅需要知道算法如何工作，更要懂得何时使用它。本练习挑战你批判性地思考将BiCGSTAB这一为通用非对称系统设计的方法，应用于对称正定（SPD）系统时的后果。通过将其与专门的共轭梯度（CG）方法进行比较，你将培养出在面对具体问题时选择最高效工具的关键决策能力[@problem_id:2374446]。", "problem": "给你一个大型稀疏线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，即对于所有非零向量 $x \\in \\mathbb{R}^n$，都有 $A = A^\\top$ 且 $x^\\top A x > 0$。考虑使用双共轭梯度稳定 (BiCGSTAB) 方法或共轭梯度 (CG) 方法求解该系统，两种方法都从相同的初始猜测 $x_0$ 开始，并使用相同的右端项 $b$。假设采用标准浮点运算和两种方法的标准教科书实现，且不进行任何针对特定问题的调优。请比较两种方法源于第一性原理的基本性质（适用性、关于某个范数的最优性、以及每次迭代的算术运算），以及它们在 SPD 问题上的典型性能影响。\n\n以下哪个陈述最准确？\n\nA. 将 BiCGSTAB 应用于 SPD 系统是有效的，但它没有利用对称性或正定性：每次 BiCGSTAB 迭代通常需要大约 2 次与 $A$ 的矩阵向量乘积，以及比 CG 更多的内积运算，并且它缺乏 CG 所具有的 $A$-范数误差最小化性质。对于可比的容差，CG 通常需要不超过其迭代次数，并且花费的时间更少。\n\nB. BiCGSTAB 不能应用于 SPD 矩阵，因为它要求系数矩阵是非对称的，而 CG 是这种情况下唯一适用的 Krylov 方法。\n\nC. 在 SPD 矩阵上，且使用相同的初始猜测时，BiCGSTAB 产生与 CG 完全相同的迭代序列，并且每次迭代的计算成本相同。\n\nD. 在 SPD 问题上，BiCGSTAB 保证每次迭代中欧几里得残差范数 $\\lVert r_k \\rVert_2$ 单调递减，因此尽管每次迭代的成本略高，但在迭代次数上通常优于 CG。\n\nE. 如果使用一个理想的 SPD 预处理器，BiCGSTAB 在数学上就等价于预处理共轭梯度法，并继承其 $A$-范数误差最小化性质。", "solution": "必须首先确定问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 线性系统为 $A x = b$。\n- 矩阵 $A$ 是 $\\mathbb{R}^{n \\times n}$ 中的一个元素，并且是大型、稀疏、对称正定 (SPD) 的。\n- SPD 的定义为：对于所有非零向量 $x \\in \\mathbb{R}^n$，有 $A = A^\\top$ 且 $x^\\top A x > 0$。\n- 需要比较的数值方法是双共轭梯度稳定 (BiCGSTAB) 方法和共轭梯度 (CG) 方法。\n- 两种方法都从相同的初始猜测 $x_0$ 开始，并使用相同的右端项向量 $b$。\n- 背景是标准浮点运算和无特殊调优的标准教科书实现。\n- 任务是基于适用性、关于某个范数的最优性、每次迭代的算术运算以及在 SPD 系统上的典型性能来比较这两种方法。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题深植于数值线性代数领域，这是计算工程与科学的核心学科。SPD 矩阵、CG 方法和 BiCGSTAB 方法的概念是标准的、定义明确的数学对象。这些算法的比较是该领域的一个经典主题。\n- **适定性：** 该问题要求在指定条件下评估关于两种明确定义的算法的几个比较性陈述的准确性。这会得出一个唯一、正确的评估。\n- **客观性：** 问题使用了精确、客观的术语（例如，“对称正定”、“$A$-范数误差最小化”、“矩阵向量乘积”）。它要求分析可以通过数学证明和算法分析来验证的基本性质。\n\n问题陈述没有表现出验证协议中列出的任何缺陷。它是科学上合理、适定、客观的，并且与指定主题直接相关。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。将进行完整的解答和选项评估。\n\n### 推导与分析\n\n我们分析将共轭梯度 (CG) 和双共轭梯度稳定 (BiCGSTAB) 方法应用于对称正定 (SPD) 线性系统 $A x = b$ 时的性质。\n\n**共轭梯度 (CG) 方法：**\nCG 方法是专为 SPD 系统设计的。其关键性质如下：\n1.  **最优性：** 在每次迭代 $k$ 中，迭代解 $x_k$ 在仿射 Krylov 子空间 $x_0 + \\mathcal{K}_k(A, r_0)$ 上最小化误差向量 $e_k = x - x_k$ 的 $A$-范数，其中 $r_0 = b - Ax_0$ 是初始残差，且 $\\mathcal{K}_k(A, r_0) = \\text{span}\\{r_0, Ar_0, \\dots, A^{k-1}r_0\\}$。也就是说，\n    $$ \\|x - x_k\\|_A = \\min_{y \\in x_0 + \\mathcal{K}_k(A, r_0)} \\|x - y\\|_A $$\n    其中 $A$-范数定义为 $\\|z\\|_A = \\sqrt{z^\\top A z}$。这是一个强大的全局最优性。\n2.  **递推关系：** $A$ 的对称性允许使用短递推关系。新迭代解 $x_k$ 和残差 $r_k$ 的计算仅依赖于前一步 ($k-1$) 的值。\n3.  **计算成本：** CG 的标准实现每次迭代需要一次矩阵向量乘积 ($Ap_k$)、两次内积和三次向量更新。\n4.  **收敛性：** 在误差的 $A$-范数下，收敛是单调的。达到某一容差所需的迭代次数是有界的，并且取决于矩阵 $A$ 的条件数 $\\kappa(A)$。\n\n**双共轭梯度稳定 (BiCGSTAB) 方法：**\nBiCGSTAB 是一种用于求解一般非对称线性系统的 Krylov 子空间方法。\n1.  **适用性：** 它可以应用于任何具有非奇异矩阵 $A$ 的系统，这包括 SPD 矩阵。它不要求矩阵非对称。\n2.  **算法结构：** BiCGSTAB 基于双共轭梯度 (BiCG) 方法。BiCG 生成两组相互正交的残差向量，一组用于系统 $Ax=b$，另一组用于伴随系统 $A^\\top y = c$。对于对称矩阵 $A=A^\\top$，BiCG 会简化，但其收敛过程可能不稳定。BiCGSTAB 通过将一个 BiCG 步骤与一个类似于 GMRES(1) 的局部最小化步骤相结合来平滑这种收敛。在每次迭代 $i$ 中，它通过一个 BiCG 步骤计算一个中间解，然后通过应用一个局部最小化残差范数的进一步修正来“稳定”该解。\n3.  **最优性：** BiCGSTAB 不具备类似于 CG 的 $A$-范数最小化的全局最优性。它在每一步近似地局部最小化残差范数 $\\|r_k\\|_2$，这通常导致比 BiCG 更平滑的收敛，但不保证残差范数的单调递减。\n4.  **计算成本：** BiCGSTAB 的标准实现每次迭代需要两次矩阵向量乘积（一次涉及 $A$，另一次在一般情况下涉及 $A^\\top$，在此处也是 $A$）。具体来说，该算法为 BiCG 部分计算一次乘积，为稳定化步骤计算另一次。它还涉及大约四次内积和比 CG 更多的向量更新。每次迭代的计算工作量大约是 CG 的两倍。\n\n**对于 SPD 系统的比较：**\n将 BiCGSTAB 应用于 SPD 系统时，该算法不会简化为 CG。它执行其通用过程，未能像 CG 那样利用对称性和正定性的有益性质。CG 是针对此类问题的专门化、最优算法。因此，无论是在迭代次数方面（由于其最优性），还是决定性地，在总计算时间方面（由于其较低的单次迭代成本），CG 都有望更高效。\n\n### 逐项分析\n\n**A. 将 BiCGSTAB 应用于 SPD 系统是有效的，但它没有利用对称性或正定性：每次 BiCGSTAB 迭代通常需要大约 2 次与 $A$ 的矩阵向量乘积，以及比 CG 更多的内积运算，并且它缺乏 CG 所具有的 $A$-范数误差最小化性质。对于可比的容差，CG 通常需要不超过其迭代次数，并且花费的时间更少。**\n- **结论：** 正确。\n- **理由：** 该陈述准确地总结了比较。BiCGSTAB 是适用的（“有效的”）。对于对称矩阵，它的结构不会从根本上改变，因此不像 CG 那样有效地利用这一性质。与 CG 的一次矩阵向量乘积相比，其每次迭代的成本确实是大约两次，并且有更多的辅助操作。它缺乏 CG 的标志性 $A$-范数最小化性质。因此，作为专门化方法，CG 在处理 SPD 问题时，无论在迭代次数还是总运行时间上，几乎总是更优越。\n\n**B. BiCGSTAB 不能应用于 SPD 矩阵，因为它要求系数矩阵是非对称的，而 CG 是这种情况下唯一适用的 Krylov 方法。**\n- **结论：** 不正确。\n- **理由：** 这个陈述包含两个谬误。首先，BiCGSTAB 是为非对称矩阵设计的，但适用于任何非奇异矩阵，包括 SPD 矩阵。它不*要求*非对称性。其次，CG 不是*唯一*适用于 SPD 系统的 Krylov 方法；其他方法如 GMRES、MINRES 或 BiCGSTAB 也可以应用，尽管它们通常不如 CG 高效。\n\n**C. 在 SPD 矩阵上，且使用相同的初始猜测时，BiCGSTAB 产生与 CG 完全相同的迭代序列，并且每次迭代的计算成本相同。**\n- **结论：** 不正确。\n- **理由：** 这将 BiCGSTAB 与基础的 BiCG 方法混淆了。在精确算术中，对于一个 SPD 矩阵 $A$ 且影子残差选择为 $\\tilde{r}_0 = r_0$ 时，BiCG 方法会产生与 CG 相同的迭代序列。然而，BiCGSTAB 是一个不同的算法，它包含一个额外的稳定化步骤。它不会产生与 CG 相同的迭代序列。此外，BiCGSTAB 每次迭代的成本大约是 CG 的两倍，而不是相同。\n\n**D. 在 SPD 问题上，BiCGSTAB 保证每次迭代中欧几里得残差范数 $\\lVert r_k \\rVert_2$ 单调递减，因此尽管每次迭代的成本略高，但在迭代次数上通常优于 CG。**\n- **结论：** 不正确。\n- **理由：** BiCGSTAB 不保证残差范数的单调递减，尽管其收敛通常比 BiCG 的平滑得多。$\\|r_k\\|_2$ 的小幅增加是可能的。更重要的是，对于 SPD 问题，它在迭代次数上通常不会优于 CG；CG 的最优性通常导致更少的迭代次数。最后，其每次迭代的成本是显著（约 100%）更高，而不是“略微”更高。\n\n**E. 如果使用一个理想的 SPD 预处理器，BiCGSTAB 在数学上就等价于预处理共轭梯度法，并继承其 $A$-范数误差最小化性质。**\n- **结论：** 不正确。\n- **理由：** 一个理想的预处理器是 $M=A$。使用这样的预处理器，预处理后的系统变为 $M^{-1}Ax = M^{-1}b \\implies Ix = A^{-1}b$。预处理 CG (PCG) 和预处理 BiCGSTAB 都会解这个系统，并在单次迭代中找到精确解。虽然在这种退化情况下它们的最终输出相同，但算法本身并没有变得“数学上等价”。它们是不同的操作序列。BiCGSTAB 并没有“继承”PCG 的最优性；它只是像 PCG 一样快速地解决了一个平凡的问题。声称继承了一个基本的算法性质是错误的。", "answer": "$$\\boxed{A}$$", "id": "2374446"}]}