{"hands_on_practices": [{"introduction": "在有限元方法中，最核心的步骤之一是将连续的弱形式转化为一个离散的线性方程组。这个练习将指导你完成这一基本过程，为一个简单的边值问题构建其对应的刚度矩阵。通过这个实践，你将具体地看到连续双线性形式的性质（如矫顽性）如何直接转化为离san矩阵的性质（如正定性），从而保证数值解的存在性和唯一性。[@problem_id:3462584]", "problem": "考虑在开区间 $\\Omega=(0,1)$ 上的二阶标量椭圆边值问题：求 $u:\\Omega\\to\\mathbb{R}$，使得对于 $x\\in\\Omega$，有 $-u''(x)+\\gamma\\,u(x)=f(x)$，且满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$，其中 $\\gamma>0$ 是一个给定的常数，$f\\in L^{2}(\\Omega)$ 是一个给定的源项。其弱形式为：求 $u\\in H_{0}^{1}(\\Omega)$，使得对于所有 $v\\in H_{0}^{1}(\\Omega)$，有 $a(u,v)=\\ell(v)$，其中双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$ 定义为 $a(u,v)=\\int_{0}^{1}u'(x)v'(x)\\,\\mathrm{d}x+\\gamma\\int_{0}^{1}u(x)v(x)\\,\\mathrm{d}x$ 以及 $\\ell(v)=\\int_{0}^{1}f(x)v(x)\\,\\mathrm{d}x$。与伽辽金原理相关的加权余量法寻求 $u_{h}\\in V_{h}$，使得对于所有 $w_{h}\\in W_{h}$，有 $a(u_{h},w_{h})=\\ell(w_{h})$，且 $W_{h}=V_{h}$。\n\n令试验空间 $V_{h}$ 为 $H_{0}^{1}(\\Omega)$ 的子空间，由在节点为 $x_{0}=0$、$x_{1}=\\frac{1}{3}$、$x_{2}=\\frac{2}{3}$、$x_{3}=1$ 的均匀网格上的分段线性、全局连续函数构成。令 $V_{h}=\\operatorname{span}\\{\\varphi_{1},\\varphi_{2}\\}$，其中 $\\varphi_{1}$ 和 $\\varphi_{2}$ 分别是与内部节点 $x_{1}$ 和 $x_{2}$ 相关联的标准帽函数，其显式表达式为\n$$ \\varphi_1(x) = \\begin{cases} \\frac{x}{h},  0 \\le x \\le h \\\\ \\frac{2h-x}{h},  h \\le x \\le 2h \\\\ 0,  \\text{其他情况} \\end{cases} \\quad \\varphi_2(x) = \\begin{cases} \\frac{x-h}{h},  h \\le x \\le 2h \\\\ \\frac{3h-x}{h},  2h \\le x \\le 3h \\\\ 0,  \\text{其他情况} \\end{cases} $$\n其中 $h=\\frac{1}{3}$。令测试空间 $W_{h}$ 等于 $V_{h}$，因此该方法为标准伽辽金方法。\n\n任务：\n- 从第一性原理推导在节点基 $\\{\\varphi_{1},\\varphi_{2}\\}$ 下表示 $V_{h}$ 和 $W_{h}$ 上的 $a(\\cdot,\\cdot)$ 的刚度矩阵 $A\\in\\mathbb{R}^{2\\times 2}$，即 $A_{ij}=a(\\varphi_{j},\\varphi_{i})$，其中 $i,j\\in\\{1,2\\}$。\n- 利用 $a(\\cdot,\\cdot)$ 在 $H_{0}^{1}(\\Omega)$ 上的连续性（有界性）和强制性（椭圆性）的定义，讨论这些性质如何推导出矩阵 $A$ 的谱特性，如对称性和正定性，以及这些性质如何与 $A$ 的离散谱（特征值）相关联。\n- 对于特定参数值 $\\gamma=4$，计算矩阵 $A$ 的最小特征值。最终答案以精确值表示，无需四舍五入。", "solution": "该问题陈述是一维边值问题有限元方法中的一个标准练习。它在科学上是合理的、适定的、客观的且自洽的。所有定义、参数和函数都已给出且相互一致。因此，该问题被认为是有效的，并将提供解答。\n\n该任务分为三个部分：推导刚度矩阵 $A$，基于双线性形式 $a(\\cdot,\\cdot)$ 的性质讨论其谱特性，以及针对特定参数值计算 $A$ 的最小特征值。\n\n### 第1部分：刚度矩阵 $A$ 的推导\n\n刚度矩阵 $A \\in \\mathbb{R}^{2\\times 2}$ 的元素定义为 $A_{ij} = a(\\varphi_{j}, \\varphi_{i})$，其中 $i,j \\in \\{1,2\\}$，$\\{\\varphi_{1}, \\varphi_{2}\\}$ 是试验函数空间 $V_h$ 的节点基。双线性形式为\n$$a(u,v)=\\int_{0}^{1}u'(x)v'(x)\\,\\mathrm{d}x+\\gamma\\int_{0}^{1}u(x)v(x)\\,\\mathrm{d}x$$\n网格尺寸为 $h=\\frac{1}{3}$，节点位于 $x_0=0$，$x_1=h$，$x_2=2h$ 和 $x_3=3h=1$。基函数 $\\varphi_1(x)$ 和 $\\varphi_2(x)$ 是分别以内节点 $x_1$ 和 $x_2$ 为中心的标准分段线性“帽”函数。\n\n基函数的导数是分段常数：\n$$ \\varphi_{1}'(x)=\\begin{cases} 1/h,  x \\in (0,h) \\\\ -1/h,  x \\in (h,2h) \\\\ 0,  \\text{其他情况} \\end{cases} \\quad \\text{以及} \\quad \\varphi_{2}'(x)=\\begin{cases} 1/h,  x \\in (h,2h) \\\\ -1/h,  x \\in (2h,3h) \\\\ 0,  \\text{其他情况} \\end{cases} $$\n\n我们现在计算矩阵 $A$ 的四个元素。\n\n**元素 $A_{11}$:**\n$A_{11} = a(\\varphi_1, \\varphi_1) = \\int_{0}^{1} (\\varphi_1'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (\\varphi_1(x))^2\\,\\mathrm{d}x$。\n第一个积分为：\n$$ \\int_{0}^{1} (\\varphi_1'(x))^2\\,\\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{1}{h}\\right)^2\\,\\mathrm{d}x + \\int_{h}^{2h} \\left(-\\frac{1}{h}\\right)^2\\,\\mathrm{d}x = \\frac{1}{h^2} \\cdot h + \\frac{1}{h^2} \\cdot h = \\frac{2}{h} $$\n第二个积分为：\n$$ \\int_{0}^{1} (\\varphi_1(x))^2\\,\\mathrm{d}x = \\int_{0}^{h} \\left(\\frac{x}{h}\\right)^2\\,\\mathrm{d}x + \\int_{h}^{2h} \\left(\\frac{2h-x}{h}\\right)^2\\,\\mathrm{d}x = \\frac{1}{h^2}\\left[\\frac{x^3}{3}\\right]_0^h + \\frac{1}{h^2}\\left[-\\frac{(2h-x)^3}{3}\\right]_h^{2h} = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3} $$\n因此，$A_{11} = \\frac{2}{h} + \\gamma \\frac{2h}{3}$。\n\n**元素 $A_{22}$:**\n由于网格的对称性和基函数的定义（$\\varphi_2$ 是 $\\varphi_1$ 的空间平移），$A_{22} = a(\\varphi_2, \\varphi_2)$ 的计算是相同的。\n$A_{22} = \\int_{0}^{1} (\\varphi_2'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (\\varphi_2(x))^2\\,\\mathrm{d}x = \\frac{2}{h} + \\gamma \\frac{2h}{3}$。\n\n**元素 $A_{21}$:**\n$A_{21} = a(\\varphi_1, \\varphi_2) = \\int_{0}^{1} \\varphi_1'(x)\\varphi_2'(x)\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} \\varphi_1(x)\\varphi_2(x)\\,\\mathrm{d}x$。\n$\\varphi_1'$ 和 $\\varphi_2'$ 的支集仅在区间 $(h, 2h)$ 上重叠。\n$$ \\int_{0}^{1} \\varphi_1'(x)\\varphi_2'(x)\\,\\mathrm{d}x = \\int_{h}^{2h} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,\\mathrm{d}x = -\\frac{1}{h^2} \\int_{h}^{2h}\\,\\mathrm{d}x = -\\frac{h}{h^2} = -\\frac{1}{h} $$\n$\\varphi_1$ 和 $\\varphi_2$ 的支集也仅在 $(h, 2h)$ 上重叠。\n$$ \\int_{0}^{1} \\varphi_1(x)\\varphi_2(x)\\,\\mathrm{d}x = \\int_{h}^{2h} \\left(\\frac{2h-x}{h}\\right)\\left(\\frac{x-h}{h}\\right)\\,\\mathrm{d}x = \\frac{1}{h^2} \\int_{h}^{2h} (-x^2 + 3hx - 2h^2)\\,\\mathrm{d}x $$\n$$ = \\frac{1}{h^2} \\left[-\\frac{x^3}{3} + \\frac{3hx^2}{2} - 2h^2x\\right]_h^{2h} = \\frac{1}{h^2} \\left( \\left(-\\frac{8h^3}{3} + 6h^3 - 4h^3\\right) - \\left(-\\frac{h^3}{3} + \\frac{3h^3}{2} - 2h^3\\right) \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{6} \\right) = \\frac{h}{6} $$\n因此，$A_{21} = -\\frac{1}{h} + \\gamma \\frac{h}{6}$。\n\n**元素 $A_{12}$:**\n$A_{12} = a(\\varphi_2, \\varphi_1)$。由于双线性形式 $a(u,v)$ 是对称的，即 $a(u,v) = a(v,u)$，因此 $A_{12} = A_{21}$。\n\n组合矩阵 $A$：\n$$ A = \\begin{pmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{h} + \\frac{2\\gamma h}{3}  -\\frac{1}{h} + \\frac{\\gamma h}{6} \\\\ -\\frac{1}{h} + \\frac{\\gamma h}{6}  \\frac{2}{h} + \\frac{2\\gamma h}{3} \\end{pmatrix} $$\n代入 $h=\\frac{1}{3}$：\n$$ \\frac{2}{h} = 6, \\quad \\frac{2\\gamma h}{3} = \\frac{2\\gamma}{9}, \\quad -\\frac{1}{h} = -3, \\quad \\frac{\\gamma h}{6} = \\frac{\\gamma}{18} $$\n刚度矩阵为：\n$$ A = \\begin{pmatrix} 6 + \\frac{2\\gamma}{9}  -3 + \\frac{\\gamma}{18} \\\\ -3 + \\frac{\\gamma}{18}  6 + \\frac{2\\gamma}{9} \\end{pmatrix} $$\n\n### 第2部分：$A$ 的性质及其与谱的关系\n\n无限维空间 $H_0^1(\\Omega)$ 上的连续双线性形式 $a(\\cdot,\\cdot)$ 的性质直接转化为有限维向量空间 $\\mathbb{R}^2$ 上的离散刚度矩阵 $A$ 的性质。\n\n**对称性：**\n双线性形式 $a(u,v) = \\int u'v' + \\gamma \\int uv$ 是对称的，因为对于所有 $u,v \\in H_0^1(\\Omega)$，有 $a(u,v) = a(v,u)$。此性质被刚度矩阵 $A$ 继承：\n$$ A_{ij} = a(\\varphi_j, \\varphi_i) = a(\\varphi_i, \\varphi_j) = A_{ji} $$\n因此，$A$ 是一个对称矩阵。我们的显式计算证实了这一点。实对称矩阵的一个关键谱特性是其所有特征值都是实数。\n\n**正定性：**\n该双线性形式在 $H_0^1(\\Omega)$ 上是强制的，意味着存在一个常数 $\\alpha > 0$ 使得对于所有 $u \\in H_0^1(\\Omega)$，有 $a(u,u) \\ge \\alpha\\|u\\|_{H^1(\\Omega)}^2$。对于我们的形式，当 $\\gamma > 0$ 时：\n$$ a(u,u) = \\int_{0}^{1} (u'(x))^2\\,\\mathrm{d}x + \\gamma \\int_{0}^{1} (u(x))^2\\,\\mathrm{d}x $$\n由于 $\\gamma0$，对于任何非零函数 $u \\in H_0^1(\\Omega)$，都有 $a(u,u)  0$。\n连续空间上的这种强制性意味着离散矩阵 $A$ 的正定性。为了说明这一点，考虑一个任意非零系数向量 $\\mathbf{c} = (c_1, c_2)^T \\in \\mathbb{R}^2$。该向量通过 $u_h(x) = c_1\\varphi_1(x) + c_2\\varphi_2(x)$ 定义了一个非零函数 $u_h \\in V_h$。由于 $\\{\\varphi_1, \\varphi_2\\}$ 是线性无关的，$\\mathbf{c} \\neq \\mathbf{0}$ 意味着 $u_h \\not\\equiv 0$。\n现在考察二次型 $\\mathbf{c}^T A \\mathbf{c}$：\n$$ \\mathbf{c}^T A \\mathbf{c} = \\sum_{i=1}^2 \\sum_{j=1}^2 c_i A_{ij} c_j = \\sum_{i=1}^2 \\sum_{j=1}^2 c_i a(\\varphi_j, \\varphi_i) c_j $$\n根据 $a(\\cdot,\\cdot)$ 的双线性性：\n$$ \\mathbf{c}^T A \\mathbf{c} = a\\left(\\sum_{j=1}^2 c_j\\varphi_j, \\sum_{i=1}^2 c_i\\varphi_i\\right) = a(u_h, u_h) $$\n由于 $u_h$ 是 $H_0^1(\\Omega)$ 中的一个非零函数，$a(\\cdot,\\cdot)$ 的强制性保证了 $a(u_h, u_h)  0$。因此，对于所有 $\\mathbf{c} \\neq \\mathbf{0}$，都有 $\\mathbf{c}^T A \\mathbf{c}  0$。这就是正定矩阵的定义。\n\n**谱特性：**\n矩阵 $A$ 是对称正定的。这对它的谱（特征值集合）有直接影响：\n1. $A$ 的所有特征值都是实数（由于对称性）。\n2. $A$ 的所有特征值都严格为正（由于正定性）。\n设 $\\lambda$ 是 $A$ 的一个特征值，对应的特征向量为 $\\mathbf{c}$。则 $A\\mathbf{c} = \\lambda\\mathbf{c}$。与 $\\mathbf{c}$ 做点积得到 $\\mathbf{c}^T A \\mathbf{c} = \\lambda \\mathbf{c}^T \\mathbf{c} = \\lambda \\|\\mathbf{c}\\|_2^2$。由于对于非零特征向量，$\\mathbf{c}^T A \\mathbf{c}  0$ 且 $\\|\\mathbf{c}\\|_2^2  0$，因此 $\\lambda  0$。$A$ 的谱包含在 $(0, \\infty)$ 中。\n\n### 第3部分：$\\gamma = 4$ 时的最小特征值\n\n我们需要计算当 $\\gamma = 4$ 时矩阵 $A$ 的最小特征值。将此值代入我们推导出的矩阵：\n$$ A = \\begin{pmatrix} 6 + \\frac{2(4)}{9}  -3 + \\frac{4}{18} \\\\ -3 + \\frac{4}{18}  6 + \\frac{2(4)}{9} \\end{pmatrix} = \\begin{pmatrix} 6 + \\frac{8}{9}  -3 + \\frac{2}{9} \\\\ -3 + \\frac{2}{9}  6 + \\frac{8}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{62}{9}  -\\frac{25}{9} \\\\ -\\frac{25}{9}  \\frac{62}{9} \\end{pmatrix} $$\n特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根：\n$$ \\det \\begin{pmatrix} \\frac{62}{9} - \\lambda  -\\frac{25}{9} \\\\ -\\frac{25}{9}  \\frac{62}{9} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(\\frac{62}{9} - \\lambda\\right)^2 - \\left(-\\frac{25}{9}\\right)^2 = 0 $$\n$$ \\left(\\frac{62}{9} - \\lambda\\right)^2 = \\left(\\frac{25}{9}\\right)^2 $$\n对两边开平方根，得到两种可能性：\n$$ \\frac{62}{9} - \\lambda = \\frac{25}{9} \\quad \\text{或} \\quad \\frac{62}{9} - \\lambda = -\\frac{25}{9} $$\n分别求解 $\\lambda$：\n情况1：\n$$ \\lambda_1 = \\frac{62}{9} - \\frac{25}{9} = \\frac{37}{9} $$\n情况2：\n$$ \\lambda_2 = \\frac{62}{9} + \\frac{25}{9} = \\frac{87}{9} = \\frac{29}{3} $$\n两个特征值是 $\\lambda_1 = \\frac{37}{9}$ 和 $\\lambda_2 = \\frac{29}{3}$。为了找到最小的，我们比较它们：\n$\\frac{29}{3} = \\frac{87}{9}$。\n由于 $\\frac{37}{9}  \\frac{87}{9}$，最小的特征值为 $\\frac{37}{9}$。", "answer": "$$\n\\boxed{\\frac{37}{9}}\n$$", "id": "3462584"}, {"introduction": "虽然弱形式在计算上十分便捷，但理解其理论根源至关重要。本练习将带你从最原始的微分方程“强残差”出发，直接应用加权残差法。你将通过分部积分，亲手揭示强形式如何自然地演变为弱形式，从而深刻理解为何弱形式能够降低对基函数的光滑性要求，并有效地处理边界项。[@problem_id:3462644]", "problem": "考虑在一维区间 $[0,h]$ 上定义的二阶线性椭圆偏微分方程 $-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x)$，其中 $h0$ 是单个内部有限元的长度，$a(x)$ 是一个严格为正的系数。假设 $a(x)$ 可微，并设 $a(x)=a_0+a_1 x$，其中 $a_00$ 和 $a_1\\in\\mathbb{R}$ 为常数，且 $f(x)=f_0$ 为一个常数源项。在有限元法 (FEM) 中，设 $u(x)$ 由线性有限元场 $u_h(x)=N_1(x)\\,u_1+N_2(x)\\,u_2$ 近似，其中节点自由度为 $u_1,u_2\\in\\mathbb{R}$，在 $[0,h]$ 上的标准形函数为 $N_1(x)=1-\\frac{x}{h}$ 和 $N_2(x)=\\frac{x}{h}$。考虑 Galerkin 原理，其中检验（权重）函数 $w_h$ 取自与试探空间相同的生成空间，并将单元上的单元级强残差定义为 $R_e(u_h)=-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$。\n\n从加权残差法的基本定义和分部积分的微积分恒等式出发，完成以下任务：\n\n- 计算在单元 $[0,h]$ 上 $R_e(u_h)$ 的显式表达式。\n- 计算加权残差积分 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$。\n- 使用分部积分，展示 $\\int_{0}^{h} w_h\\,R_e(u_h)\\,dx$ 如何分解为一个边界通量项和与弱形式陈述相关的双线性形式，并由此证明，在跨单元进行全局组装时，内部边界项相互抵消后，所得的刚度组装与从弱形式获得的刚度组装一致。\n\n请用 $a_0$、$a_1$、$f_0$、$h$、$u_1$ 和 $u_2$ 表示 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$ 的单一闭式解析表达式作为最终答案。无需进行数值代入。最终答案中不要包含任何单位。", "solution": "该问题要求对一维线性椭圆方程基于加权残差法进行三部分分析。首先，我们计算线性有限元近似的强残差的显式形式。其次，我们使用第一个形函数作为权重函数，计算加权残差积分。第三，我们论证应用于强形式的加权残差法与标准弱形式（或变分形式）之间的联系。\n\n设微分方程为\n$$-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u}{dx}\\right)=f(x) \\quad \\text{for } x \\in [0,h]$$\n其中 $a(x) = a_0 + a_1 x$ 且 $f(x) = f_0$。有限元近似为 $u_h(x) = N_1(x)u_1 + N_2(x)u_2$，其中在单元 $[0,h]$ 上的线性形函数为 $N_1(x) = 1 - \\frac{x}{h}$ 和 $N_2(x) = \\frac{x}{h}$。\n\n**第1部分：计算单元级强残差 $R_e(u_h)$ 的显式表达式**\n\n单元级强残差定义为 $R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)$。首先，我们计算近似解 $u_h(x)$ 的导数：\n$$u_h(x) = \\left(1-\\frac{x}{h}\\right)u_1 + \\frac{x}{h}u_2$$\n$$\\frac{d u_h}{dx} = -\\frac{1}{h}u_1 + \\frac{1}{h}u_2 = \\frac{u_2 - u_1}{h}$$\n导数 $\\frac{d u_h}{dx}$ 在单元上是常数。接下来，我们计算项 $a(x)\\frac{d u_h}{dx}$：\n$$a(x)\\frac{d u_h}{dx} = (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right)$$\n现在我们对该表达式关于 $x$ 求导：\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\frac{d}{dx}\\left[ (a_0 + a_1 x) \\left(\\frac{u_2 - u_1}{h}\\right) \\right]$$\n由于 $\\frac{u_2 - u_1}{h}$ 是一个常数，我们可以将其提出：\n$$\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) = \\left(\\frac{u_2 - u_1}{h}\\right) \\frac{d}{dx}(a_0 + a_1 x) = \\left(\\frac{u_2 - u_1}{h}\\right) a_1$$\n最后，我们组装强残差 $R_e(u_h)$：\n$$R_e(u_h) = -\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right) - f(x) = -a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$$\n这就是单元上强残差的显式表达式。注意，由于试探函数是线性的，且系数 $a(x)$ 也是线性的，因此强残差在整个单元上是常数。\n\n**第2部分：计算加权残差积分 $\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx$**\n\nGalerkin 方法要求残差与检验函数正交，而检验函数与试探函数取自同一空间。在这里，我们使用检验函数 $w_h(x) = N_1(x) = 1 - \\frac{x}{h}$。我们计算该积分：\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] dx$$\n包含残差的项 $-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0$ 相对于积分变量 $x$ 是常数。因此我们可以将其移到积分号外：\n$$= \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx$$\n我们现在计算形函数 $N_1(x)$ 在单元域上的积分：\n$$\\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right) dx = \\left[x - \\frac{x^2}{2h}\\right]_0^h = \\left(h - \\frac{h^2}{2h}\\right) - (0) = h - \\frac{h}{2} = \\frac{h}{2}$$\n将此结果代回，我们得到加权残差积分的最终表达式：\n$$\\int_{0}^{h} N_1(x)\\,R_e(u_h)\\,dx = \\left[-a_1\\left(\\frac{u_2 - u_1}{h}\\right) - f_0\\right] \\left(\\frac{h}{2}\\right)$$\n$$= -a_1\\left(\\frac{u_2 - u_1}{h}\\right)\\frac{h}{2} - f_0\\frac{h}{2} = -\\frac{a_1}{2}(u_2 - u_1) - \\frac{f_0 h}{2}$$\n$$= \\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}$$\n\n**第3部分：分解为边界项和双线性项以及与弱形式的关系**\n\n我们从加权残差法的基本陈述开始，对于一个来自试探空间的通用检验函数 $w_h(x)$：\n$$\\int_{0}^{h} w_h(x)\\,R_e(u_h)\\,dx = \\int_{0}^{h} w_h(x) \\left[-\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)-f(x)\\right] dx = 0$$\n这可以写成：\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = \\int_{0}^{h} w_h(x) f(x) dx$$\n我们对左侧的积分应用分部积分，使用公式 $\\int v \\, du' = [vu] - \\int v' \\, u$。令 $v = w_h(x)$ 和 $u' = \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)$。则 $v' = \\frac{dw_h}{dx}$ 且 $u = a(x)\\,\\frac{d u_h}{dx}$。\n$$-\\int_{0}^{h} w_h(x)\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{d u_h}{dx}\\right)dx = - \\left( \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h - \\int_0^h \\frac{d w_h}{dx} a(x) \\frac{d u_h}{dx} dx \\right)$$\n$$= \\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h$$\n将此代回加权残差方程，得到：\n$$\\int_0^h a(x) \\frac{d w_h}{dx} \\fracd u_h}{dx} dx - \\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = \\int_0^h w_h(x) f(x) dx$$\n该方程展示了分解过程。我们可以识别出以下各项：\n1.  **双线性形式 (Bilinear Form):** 项 $\\int_0^h a(x) \\frac{d w_h}{dx} \\frac{d u_h}{dx} dx$ 是双线性形式 $B(u_h, w_h)$。当试探函数和检验函数用基函数展开时（$u_h = \\sum_j N_j u_j$, $w_h = N_i$），该项产生单元刚度矩阵，其元素为 $K_{ij} = \\int_0^h a(x) \\frac{dN_i}{dx}\\frac{dN_j}{dx}dx$。\n2.  **边界通量项 (Boundary Flux Term):** 项 $\\left[w_h(x) a(x) \\frac{d u_h}{dx}\\right]_0^h = w_h(h) a(h) \\left.\\frac{du_h}{dx}\\right|_{x=h} - w_h(0) a(0) \\left.\\frac{du_h}{dx}\\right|_{x=0}$ 代表了来自单元边界的贡献。量 $q_h(x) = -a(x) \\frac{du_h}{dx}$ 是数值通量。\n3.  **线性形式 (Linear Form):** 项 $\\int_0^h w_h(x) f(x) dx$ 是线性形式 $L(w_h)$，它产生单元载荷向量 $F_i = \\int_0^h N_i(x) f(x) dx$。\n\n方程 $B(u_h, w_h) = L(w_h) + \\text{boundary terms}$ 正是单元级问题的弱形式。对加权强残差应用分部积分是推导弱形式的标准程序，这样做在计算上是有利的，因为它降低了对试探函数可微性的阶数要求。\n\n由弱形式产生的刚度组装直接从双线性形式 $B(u_h, w_h)$ 导出。我们的推导表明，这个双线性形式是在对加权强残差陈述进行一次分部积分后自然产生的。关键点在于，在有限元系统的全局组装过程中，相邻内部单元的边界通量项会相互抵消。对于单元 $(e)$ 和单元 $(e+1)$ 共享的节点，来自单元 $(e)$ 的项是 $-w_h(x_{node}) q_h(x_{node}^-)$，来自单元 $(e+1)$ 的项是 $+w_h(x_{node}) q_h(x_{node}^+)$。由弱解强制执行的通量连续性 $q_h(x_{node}^-) = q_h(x_{node}^+)$ 确保了这些项在所有内部节点处的和为零。因此，一旦通过分部积分和单元间抵消妥善处理了边界项，从弱形式导出的刚度组装确实与从强形式获得的刚度组装相一致。", "answer": "$$\n\\boxed{\\frac{a_1}{2}(u_1 - u_2) - \\frac{f_0 h}{2}}\n$$", "id": "3462644"}, {"introduction": "在理论分析中，我们通常假设可以精确计算所有积分，但在实际的有限元软件中，这几乎总由数值积分（求积）完成。这种近似会引入误差，有时被称为“变分犯罪”。本练习将探讨这一实际问题，通过分析一个因使用不精确求积而导致的特定“变分犯罪”，让你亲手量化其引入的一致性误差，从而理解实际编程决策如何影响Galerkin方法的理论精度。[@problem_id:3462648]", "problem": "考虑在开区间 $(0,1)$ 上的具有齐次 Dirichlet 边界条件的一维、二阶、线性、椭圆偏微分方程 (PDE)，\n$$\n-\\,\\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}(x)\\right) \\,=\\, f(x),\\qquad u(0)=u(1)=0,\n$$\n其中，空间变化的扩散系数为 $a(x)=1+x$。在加权余量法和 Galerkin 原理的框架下，其弱形式为：求 $u\\in H^1_0(0,1)$，使得\n$$\n\\int_{0}^{1} a(x)\\,u'(x)\\,v'(x)\\,dx \\;=\\; \\int_{0}^{1} f(x)\\,v(x)\\,dx\n$$\n对于所有 $v\\in H^1_0(0,1)$ 成立。设精确解为 $u(x)=\\sin(\\pi x)$，它从强形式一致地确定了 $f(x)$。\n\n现在考虑在区间 $[0,1]$ 上的单个二次 Lagrange 有限元方法 (FEM) 空间，节点位于 $x=0$、$x=\\tfrac{1}{2}$ 和 $x=1$。将中间节点的基函数记为 $\\phi_{1}(x)$，其特征为 $\\phi_{1}(0)=0$，$\\phi_{1}\\!\\left(\\tfrac{1}{2}\\right)=1$ 和 $\\phi_{1}(1)=0$。精确的双线性形式为\n$$\nb(u,v) \\;=\\; \\int_{0}^{1} a(x)\\,u'(x)\\,v'(x)\\,dx.\n$$\n假设该双线性形式通过不精确的数值积分（特别是在 $[0,1]$ 上的中点法则）进行近似，\n$$\nQ[g] \\;=\\; g\\!\\left(\\tfrac{1}{2}\\right),\n$$\n应用于被积函数 $g(x)=a(x)\\,u'(x)\\,\\phi_{1}'(x)$。这是一个经典的变分犯罪实例，其中 Galerkin 正交性因用 $Q[\\cdot]$ 替换精确双线性形式 $b(\\cdot,\\cdot)$ 而受到扰动。\n\n定义在精确解上对中间节点测试函数求值的、由积分引起的相容性误差泛函，\n$$\nE(\\phi_{1}) \\;=\\; b(u,\\phi_{1}) \\;-\\; Q\\!\\left[a(\\cdot)\\,u'(\\cdot)\\,\\phi_{1}'(\\cdot)\\right].\n$$\n仅使用指定数据 $a(x)=1+x$、$u(x)=\\sin(\\pi x)$ 以及 $\\phi_{1}(x)$ 的精确表达式，确定 $E(\\phi_{1})$ 的精确值。\n\n你的最终答案必须是单一的闭式解析表达式。不需要四舍五入。", "solution": "用户希望找到由积分引起的相容性误差泛函 $E(\\phi_{1})$ 的精确值。\n\n首先验证该问题，以确保其科学上合理、适定且客观。\n给定条件如下：\n- 偏微分方程为 $-\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}(x)\\right) = f(x)$，在区间 $(0,1)$ 上。\n- 边界条件为 $u(0)=u(1)=0$。\n- 扩散系数为 $a(x) = 1+x$。\n- 精确解为 $u(x) = \\sin(\\pi x)$。\n- 有限元空间是 $[0,1]$ 上的单个二次 Lagrange 单元，节点位于 $x=0$、$x=\\frac{1}{2}$ 和 $x=1$。\n- 中间节点的基函数 $\\phi_{1}(x)$ 满足 $\\phi_{1}(0)=0$、$\\phi_{1}(\\frac{1}{2})=1$ 和 $\\phi_{1}(1)=0$。\n- 精确的双线性形式为 $b(u,v) = \\int_{0}^{1} a(x)\\,u'(x)\\,v'(x)\\,dx$。\n- 数值积分法则是 $Q[g] = g(\\frac{1}{2})$。\n- 误差泛函定义为 $E(\\phi_{1}) = b(u,\\phi_{1}) - Q[a(\\cdot)\\,u'(\\cdot)\\,\\phi_{1}'(\\cdot)]$。\n\n该问题是有限元方法分析中的一个标准练习，特别涉及由不精确积分引起的变分犯罪。所有组成部分在偏微分方程数值分析的背景下都有明确的定义。该问题是自洽的、数学上一致的，并且没有任何科学缺陷或歧义。因此，该问题是有效的，可以推导出解答。\n\n求解过程分为以下几个步骤：\n1.  确定基函数 $\\phi_{1}(x)$ 的解析表达式。\n2.  计算其导数 $\\phi_{1}'(x)$。\n3.  计算精确解的导数 $u'(x)$。\n4.  计算误差泛函 $E(\\phi_{1})$ 的两项。\n5.  合并各项以求得 $E(\\phi_{1})$ 的最终值。\n\n步骤 1：求基函数 $\\phi_{1}(x)$。\n由于 $\\phi_{1}(x)$ 是一个二次基函数，它可以写成一个二次多项式：$\\phi_{1}(x) = Ax^2 + Bx + C$。系数 $A$、$B$ 和 $C$ 由节点条件确定。\n-   $\\phi_{1}(0)=0 \\implies A(0)^2 + B(0) + C = 0 \\implies C=0$。\n-   $\\phi_{1}(1)=0 \\implies A(1)^2 + B(1) = 0 \\implies A+B=0 \\implies B=-A$。\n-   $\\phi_{1}(x)$ 现在的形式为 $\\phi_{1}(x) = Ax^2 - Ax = Ax(x-1)$。\n-   $\\phi_{1}(\\frac{1}{2})=1 \\implies A(\\frac{1}{2})(\\frac{1}{2}-1) = 1 \\implies A(-\\frac{1}{4})=1 \\implies A=-4$。\n-   当 $A=-4$ 时，我们得到 $B=4$。\n因此，基函数为 $\\phi_{1}(x) = -4x^2 + 4x = 4x(1-x)$。\n\n步骤 2：求导数 $\\phi_{1}'(x)$。\n将 $\\phi_{1}(x)$ 的表达式对 $x$ 求导得到：\n$\\phi_{1}'(x) = \\frac{d}{dx}(-4x^2 + 4x) = 4 - 8x$。\n\n步骤 3：求导数 $u'(x)$。\n给定精确解为 $u(x) = \\sin(\\pi x)$。其导数为：\n$u'(x) = \\frac{d}{dx}(\\sin(\\pi x)) = \\pi \\cos(\\pi x)$。\n\n步骤 4：计算 $E(\\phi_{1})$ 的两项。\n误差泛函为 $E(\\phi_{1}) = b(u,\\phi_{1}) - Q[a(\\cdot)\\,u'(\\cdot)\\,\\phi_{1}'(\\cdot)]$。\n\n第一项是精确的双线性形式：\n$b(u,\\phi_{1}) = \\int_{0}^{1} a(x) u'(x) \\phi_{1}'(x) dx$。\n代入 $a(x)$、$u'(x)$ 和 $\\phi_{1}'(x)$ 的表达式：\n$b(u,\\phi_{1}) = \\int_{0}^{1} (1+x) (\\pi \\cos(\\pi x)) (4 - 8x) dx$。\n我们可以提出常数并化简多项式部分：\n$b(u,\\phi_{1}) = 4\\pi \\int_{0}^{1} (1+x)(1-2x) \\cos(\\pi x) dx = 4\\pi \\int_{0}^{1} (1 - x - 2x^2) \\cos(\\pi x) dx$。\n这个积分使用分部积分法求解。令 $p(x) = 1 - x - 2x^2$。该积分的形式为 $\\int p(x) \\cos(\\pi x) dx$。重复分部积分的通用公式是：\n$\\int p(x)\\cos(\\alpha x)dx = \\frac{\\sin(\\alpha x)}{\\alpha}p(x) + \\frac{\\cos(\\alpha x)}{\\alpha^2}p'(x) - \\frac{\\sin(\\alpha x)}{\\alpha^3}p''(x) - \\ldots$\n这里，$\\alpha=\\pi$，$p(x) = 1-x-2x^2$，$p'(x) = -1-4x$，$p''(x) = -4$。\n所以，不定积分为：\n$\\int (1-x-2x^2)\\cos(\\pi x)dx = \\frac{\\sin(\\pi x)}{\\pi}(1-x-2x^2) + \\frac{\\cos(\\pi x)}{\\pi^2}(-1-4x) - \\frac{\\sin(\\pi x)}{\\pi^3}(-4)$。\n现在我们在积分上下限 $x=1$ 和 $x=0$ 处计算该表达式的值。\n在 $x=1$ 处：\n$\\frac{\\sin(\\pi)}{\\pi}(1-1-2) + \\frac{\\cos(\\pi)}{\\pi^2}(-1-4) - \\frac{\\sin(\\pi)}{\\pi^3}(-4) = 0 + \\frac{-1}{\\pi^2}(-5) - 0 = \\frac{5}{\\pi^2}$。\n在 $x=0$ 处：\n$\\frac{\\sin(0)}{\\pi}(1) + \\frac{\\cos(0)}{\\pi^2}(-1) - \\frac{\\sin(0)}{\\pi^3}(-4) = 0 + \\frac{1}{\\pi^2}(-1) - 0 = -\\frac{1}{\\pi^2}$。\n定积分的值是在 $x=1$ 处的值减去在 $x=0$ 处的值：\n$\\int_{0}^{1} (1 - x - 2x^2) \\cos(\\pi x) dx = \\frac{5}{\\pi^2} - \\left(-\\frac{1}{\\pi^2}\\right) = \\frac{6}{\\pi^2}$。\n将其代回 $b(u,\\phi_{1})$ 的表达式：\n$b(u,\\phi_{1}) = 4\\pi \\left(\\frac{6}{\\pi^2}\\right) = \\frac{24}{\\pi}$。\n\n第二项是根据法则 $Q[g] = g(\\frac{1}{2})$ 在积分点 $x=\\frac{1}{2}$ 处计算被積函数的值。\n待求值的函数是 $g(x) = a(x) u'(x) \\phi_{1}'(x)$。\n$Q[a(\\cdot) u'(\\cdot) \\phi_{1}'(\\cdot)] = a\\left(\\frac{1}{2}\\right) u'\\left(\\frac{1}{2}\\right) \\phi_{1}'\\left(\\frac{1}{2}\\right)$。\n我们来计算在 $x=\\frac{1}{2}$ 处的每个分量：\n-   $a(\\frac{1}{2}) = 1 + \\frac{1}{2} = \\frac{3}{2}$。\n-   $u'(\\frac{1}{2}) = \\pi \\cos(\\pi \\cdot \\frac{1}{2}) = \\pi \\cos(\\frac{\\pi}{2}) = \\pi \\cdot 0 = 0$。\n-   $\\phi_{1}'(\\frac{1}{2}) = 4 - 8(\\frac{1}{2}) = 4 - 4 = 0$。\n因此，第二项为：\n$Q[a(\\cdot) u'(\\cdot) \\phi_{1}'(\\cdot)] = \\frac{3}{2} \\cdot 0 \\cdot 0 = 0$。\n\n步骤 5：合并各项以求得 $E(\\phi_{1})$。\n$E(\\phi_{1}) = b(u,\\phi_{1}) - Q[a(\\cdot)\\,u'(\\cdot)\\,\\phi_{1}'(\\cdot)] = \\frac{24}{\\pi} - 0 = \\frac{24}{\\pi}$。\n由积分引起的相容性误差泛函的精确值为 $\\frac{24}{\\pi}$。", "answer": "$$\n\\boxed{\\frac{24}{\\pi}}\n$$", "id": "3462648"}]}