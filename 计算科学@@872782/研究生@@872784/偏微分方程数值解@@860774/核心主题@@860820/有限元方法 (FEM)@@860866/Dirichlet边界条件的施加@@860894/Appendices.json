{"hands_on_practices": [{"introduction": "在有限元方法中，处理非齐次狄利克雷边界条件需要特别的技巧。“提升法” (Lifting) 是一种强大的变分方法，它将原问题转化为一个具有齐次边界条件的问题，从而简化了离散过程。本练习 [@problem_id:3385201] 将引导你推导修正后的弱形式并进行应用，从而巩固你对边界数据如何整合到有限元系统右侧项的理解。", "problem": "考虑在区间 $\\Omega=(0,1)$ 上的二阶标量扩散问题，其带有非齐次狄利克雷（Dirichlet）边界数据。其强形式为：求 $u:\\Omega\\to\\mathbb{R}$ 使得\n$$\n-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=f(x)\\quad\\text{在 }\\Omega\\text{ 内},\\qquad u(0)=\\alpha,\\quad u(1)=\\beta,\n$$\n其中 $\\kappa:\\Omega\\to\\mathbb{R}$ 是空间变化的扩散系数，$f:\\Omega\\to\\mathbb{R}$ 是源项，$\\alpha,\\beta\\in\\mathbb{R}$ 是给定的边界值。我们在索伯列夫（Sobolev）空间 $H^{1}(\\Omega)$ 及其子空间 $H_{0}^{1}(\\Omega)$ 中进行求解，该子空间由在边界上迹为零的函数组成。弱形式由双线性形式 $a(u,v)=\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx$ 和线性形式 $\\ell(v)=\\int_{0}^{1}f(x)\\,v(x)\\,dx$ 定义。为通过提升（lifting）来施加狄利克雷边界条件，令 $L(g)\\in H^{1}(\\Omega)$ 为任一其迹与边界数据 $g=\\{\\alpha,\\beta\\}$ 一致的函数，并定义 $\\tilde{u}=u-L(g)\\in H_{0}^{1}(\\Omega)$。从强形式和弱解的定义出发，仅使用分部积分以及索伯列夫空间和迹的基本性质，推导在 $H_{0}^{1}(\\Omega)$ 中的提升弱问题，即一个如下形式的变分问题：求 $\\tilde{u}\\in H_{0}^{1}(\\Omega)$ 使得\n$$\na(\\tilde{u},v)=\\ell(v)-a(L(g),v)\\quad\\text{对于所有 }v\\in H_{0}^{1}(\\Omega).\n$$\n\n然后，将数据实例化如下：取 $\\kappa(x)=1+x$，$f(x)=\\sin(\\pi x)$，$\\alpha=\\frac{1}{2}$，$\\beta=-\\frac{1}{2}$，并选择提升函数为仿射函数 $L(g)(x)=\\alpha(1-x)+\\beta x$。在包含 $N=4$ 个相等子区间的 $\\Omega$ 均匀网格上，使用连续分片线性有限元进行离散化，即网格尺寸为 $h=\\frac{1}{4}$，节点为 $x_{j}=j h$（$j\\in\\{0,1,2,3,4\\}$）。令 $\\varphi_{2}$ 为与内部节点 $x=\\frac{1}{2}$ 相关联的标准帽子基函数，即：\n$$\n\\varphi_{2}(x)=\\begin{cases}\n4x-1, x\\in\\left[\\frac{1}{4},\\frac{1}{2}\\right],\\\\\n3-4x, x\\in\\left[\\frac{1}{2},\\frac{3}{4}\\right],\\\\\n0, \\text{其他,}\n\\end{cases}\n\\quad\\text{以及}\\quad\n\\varphi_{2}'(x)=\\begin{cases}\n4, x\\in\\left(\\frac{1}{4},\\frac{1}{2}\\right),\\\\\n-4, x\\in\\left(\\frac{1}{2},\\frac{3}{4}\\right),\\\\\n0, \\text{其他.}\n\\end{cases}\n$$\n\n使用您推导出的提升弱形式和上述数据，计算修正后的右端项中与 $\\varphi_{2}$ 对应的标量项，即\n$$\nb_{2}\\;=\\;\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx\\;-\\;\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx,\n$$\n所有三角函数均以弧度计算。请以单个精确的封闭形式表达式给出您的最终答案。不要对结果进行四舍五入。", "solution": "我们从强形式 $-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=f(x)$ 出发，该问题定义在 $\\Omega=(0,1)$ 上，带有狄利克雷边界条件 $u(0)=\\alpha$, $u(1)=\\beta$。令 $v\\in H_{0}^{1}(\\Omega)$ 为一个在边界上迹为零的任意测试函数。将强形式乘以 $v$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{0}^{1}\\left(-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)\\right)v(x)\\,dx=\\int_{0}^{1}f(x)\\,v(x)\\,dx.\n$$\n在分布意义下使用分部积分。由于 $v\\in H_{0}^{1}(\\Omega)$ 在 $x=0$ 和 $x=1$ 处的迹为零，边界项消失，我们得到\n$$\n\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{0}^{1}f(x)\\,v(x)\\,dx.\n$$\n定义双线性形式 $a(u,v)=\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx$ 和线性泛函 $\\ell(v)=\\int_{0}^{1}f(x)\\,v(x)\\,dx$。则带有非齐次狄利克雷数据的弱形式为：求 $u\\in H^{1}(\\Omega)$，其迹为 $u|_{\\partial\\Omega}=g$，使得\n$$\na(u,v)=\\ell(v)\\quad\\text{对于所有 }v\\in H_{0}^{1}(\\Omega).\n$$\n\n为通过提升来施加狄利克雷条件，选择一个提升函数 $L(g)\\in H^{1}(\\Omega)$ 且 $L(g)|_{\\partial\\Omega}=g$，并写出 $u=\\tilde{u}+L(g)$，其中 $\\tilde{u}\\in H_{0}^{1}(\\Omega)$。代入弱形式得到\n$$\na(\\tilde{u}+L(g),v)=\\ell(v)\\quad\\text{对于所有 }v\\in H_{0}^{1}(\\Omega).\n$$\n利用 $a(\\cdot,\\cdot)$ 的双线性性质，上式变为\n$$\na(\\tilde{u},v)+a(L(g),v)=\\ell(v)\\quad\\text{对于所有 }v\\in H_{0}^{1}(\\Omega),\n$$\n或等价地，\n$$\na(\\tilde{u},v)=\\ell(v)-a(L(g),v)\\quad\\text{对于所有 }v\\in H_{0}^{1}(\\Omega).\n$$\n这就是在 $H_{0}^{1}(\\Omega)$ 中的提升弱问题。\n\n接下来，我们将数据实例化。取 $\\kappa(x)=1+x$，$f(x)=\\sin(\\pi x)$，$\\alpha=\\frac{1}{2}$，$\\beta=-\\frac{1}{2}$。选择仿射提升\n$$\nL(g)(x)=\\alpha(1-x)+\\beta x=\\frac{1}{2}-x,\n$$\n因此对所有 $x\\in(0,1)$ 都有 $L'(g)(x)=-1$。\n\n在具有 $N=4$ 个子区间的均匀网格上，节点位置为 $x_{j}=j h$，其中 $h=\\frac{1}{4}$。与内部节点 $x=\\frac{1}{2}$ 相关联的帽子基函数 $\\varphi_{2}$ 的支集在 $\\left[\\frac{1}{4},\\frac{3}{4}\\right]$ 上，并由下式给出\n$$\n\\varphi_{2}(x)=\\begin{cases}\n4x-1, x\\in\\left[\\frac{1}{4},\\frac{1}{2}\\right],\\\\\n3-4x, x\\in\\left[\\frac{1}{2},\\frac{3}{4}\\right],\\\\\n0, \\text{其他,}\n\\end{cases}\n\\quad\n\\varphi_{2}'(x)=\\begin{cases}\n4, x\\in\\left(\\frac{1}{4},\\frac{1}{2}\\right),\\\\\n-4, x\\in\\left(\\frac{1}{2},\\frac{3}{4}\\right),\\\\\n0, \\text{其他.}\n\\end{cases}\n$$\n\n我们必须计算\n$$\nb_{2}=\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx-\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx.\n$$\n我们分别计算这两个积分。\n\n首先，计算提升项的贡献。由于 $L'(g)(x)=-1$ 且 $\\kappa(x)=1+x$，\n$$\n\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx=\\int_{0}^{1}(1+x)(-1)\\,\\varphi_{2}'(x)\\,dx\n=-\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx.\n$$\n在支撑 $\\varphi_{2}'$ 的两个单元上进行分割：\n$$\n\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx\n=\\int_{\\frac{1}{4}}^{\\frac{1}{2}}(1+x)\\cdot 4\\,dx+\\int_{\\frac{1}{2}}^{\\frac{3}{4}}(1+x)\\cdot(-4)\\,dx.\n$$\n计算不定积分 $\\int (1+x)\\,dx = x+\\frac{x^{2}}{2}$。则\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}(1+x)\\,dx=\\left[x+\\frac{x^{2}}{2}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}=\\frac{11}{32},\\qquad\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}(1+x)\\,dx=\\left[x+\\frac{x^{2}}{2}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}}=\\frac{13}{32}.\n$$\n因此，\n$$\n\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx=4\\cdot\\frac{11}{32}-4\\cdot\\frac{13}{32}=-\\frac{1}{4},\n$$\n从而\n$$\n\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx=-\\left(-\\frac{1}{4}\\right)=\\frac{1}{4}.\n$$\n\n其次，计算源项的贡献\n$$\n\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx=\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx+\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx.\n$$\n使用不定积分\n$$\n\\int \\sin(\\pi x)\\,dx=-\\frac{\\cos(\\pi x)}{\\pi},\\qquad\n\\int x\\,\\sin(\\pi x)\\,dx=-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}.\n$$\n对于第一个子区间，\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx\n=4\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}\n-\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}.\n$$\n在 $x=\\frac{1}{2}$ 和 $x=\\frac{1}{4}$ 处求值，使用 $\\cos\\!\\left(\\frac{\\pi}{2}\\right)=0$，$\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$，$\\cos\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$，$\\sin\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$，得出\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx=\\frac{4-2\\sqrt{2}}{\\pi^{2}}.\n$$\n对于第二个子区间，\n$$\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx\n=3\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}}\n-4\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}},\n$$\n并使用 $\\cos\\!\\left(\\frac{3\\pi}{4}\\right)=-\\frac{\\sqrt{2}}{2}$，$\\sin\\!\\left(\\frac{3\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$ 以及之前的值，我们得到\n$$\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx=\\frac{4-2\\sqrt{2}}{\\pi^{2}}.\n$$\n因此，\n$$\n\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx=\\frac{8-4\\sqrt{2}}{\\pi^{2}}=\\frac{4(2-\\sqrt{2})}{\\pi^{2}}.\n$$\n\n组合修正后的右端项，\n$$\nb_{2}=\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx-\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx\n=\\frac{4(2-\\sqrt{2})}{\\pi^{2}}-\\frac{1}{4}.\n$$\n这是一个精确的封闭形式表达式，符合要求。", "answer": "$$\\boxed{\\frac{4\\left(2-\\sqrt{2}\\right)}{\\pi^{2}}-\\frac{1}{4}}$$", "id": "3385201"}, {"introduction": "当在单元中心网格上使用有限差分法时，节点通常不位于物理边界上，这使得“幽灵单元” (ghost cells) 的使用成为必要。本练习 [@problem_id:3385233] 聚焦于一个常见的挑战：如何正确定义角点附近的幽灵单元值以保持方法的精度，因为不当的处理会降低解的质量。通过分析泰勒展开，你将学会推导二阶精度的离散格式，这是实现稳健的有限差分求解器的关键技能。", "problem": "考虑在单位正方形 $\\Omega = [0,1]\\times[0,1]$ 上的二维泊松方程 $-\\nabla^2 u = f$，其在整个边界 $\\partial\\Omega$ 上给定狄利克雷边界条件 $u = g$。假设 $f$ 和 $g$ 是足够光滑的函数，至少二阶连续可微。你将使用有限差分法 (FDM) 在一个均匀的、单元中心的网格上离散化此偏微分方程 (PDE)，网格间距为 $h = 1/N$，其中内部未知数 $u_{i,j}$ 位于单元中心 $(x_i,y_j) = ((i+\\tfrac{1}{2})h,(j+\\tfrac{1}{2})h)$，对于整数 $i,j \\in \\{0,1,\\dots,N-1\\}$。在内部点处，使用标准的拉普拉斯算子五点近似：\n$$\n-\\nabla^2 u(x_i,y_j) \\approx -\\left(\\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h^2} + \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{h^2}\\right).\n$$\n由于网格是单元中心的，邻近边界的点需要虚拟值来完成中心差分。狄利克雷边界条件的施加方式必须保持二阶精度，并且在多个边界段相交的位置（例如角点 $(x,y)=(0,0)$ 附近）不会过度约束或重复计算边界信息。\n\n关注邻近角点的内部单元 $(i,j)=(0,0)$ 处的离散方程，其邻点包括域内的 $u_{1,0}$ 和 $u_{0,1}$，以及分别与左边界和下边界相关的虚拟值 $u_{-1,0}$ 和 $u_{0,-1}$。从 $u$ 的光滑性和关于物理边界 $x=0$ 和 $y=0$ 的泰勒展开出发，确定如何构造二阶精度的虚拟单元关系式，以施加狄利克雷边界条件，同时不引入虚假的边界数据重复。然后，写出在 $(i,j)=(0,0)$ 处得到的二阶精度修正五点格式。\n\n以下哪种处理方法在邻近角点的内部点 $(i,j)=(0,0)$ 处正确地施加了狄利克雷条件，保持了二阶精度，并避免了重复计算边界数据？\n\nA. 使用通过跨每个边界面进行二阶精度反射获得的虚拟单元值：$u_{-1,0} = 2\\,g(0,y_0) - u_{0,0}$ 和 $u_{0,-1} = 2\\,g(x_0,0) - u_{0,0}$，其中 $x_0 = h/2$ 且 $y_0 = h/2$。将这些代入五点拉普拉斯算子，得到\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + 2\\,g(0,y_0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + 2\\,g(x_0,0)}{h^2}\\right) = f_{0,0},\n$$\n该方法为每个面引入恰好一个边界贡献，并保持二阶精度。\n\nB. 仅使用角点边界值替换两个虚拟单元，$u_{-1,0} = 2\\,g(0,0) - u_{0,0}$ 和 $u_{0,-1} = 2\\,g(0,0) - u_{0,0}$，这样离散方程就变为\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + 2\\,g(0,0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + 2\\,g(0,0)}{h^2}\\right) = f_{0,0},\n$$\n该方法利用了两个边界在同角点相交的事实，因此使用一个单一的共享狄利克雷值。\n\nC. 为避免重复，对来自两个面的边界数据进行平均：设 $u_{-1,0} = 2\\,\\frac{g(0,y_0)+g(x_0,0)}{2} - u_{0,0}$ 且 $u_{0,-1} = u_{-1,0}$。得到的格式为\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + g(0,y_0)+g(x_0,0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + g(0,y_0)+g(x_0,0)}{h^2}\\right) = f_{0,0},\n$$\n该方法使用单一的平均校正来避免重复计算角点。\n\nD. 添加一个对角虚拟单元校正来捕捉角点影响：设 $u_{-1,0} = 2\\,g(0,y_0) - u_{0,0}$，$u_{0,-1} = 2\\,g(x_0,0) - u_{0,0}$，并在 $(i,j)=(0,0)$ 处的九点格式中引入 $u_{-1,-1} = 2\\,g(0,0) - u_{0,0}$，以纳入边界段在角点处的交汇，从而提高角点附近的精度。", "solution": "### 步骤 1：提取已知信息\n\n问题陈述提供了以下信息：\n- **偏微分方程 (PDE)**: $-\\nabla^2 u = f$\n- **区域**: $\\Omega = [0,1]\\times[0,1]$\n- **边界条件**: 在边界 $\\partial\\Omega$ 上，$u = g$\n- **光滑性**: $f$ 和 $g$ 至少二阶连续可微。\n- **方法**: 在均匀的单元中心网格上使用有限差分法 (FDM)。\n- **网格间距**: $h = 1/N$\n- **未知数**: $u_{i,j}$ 位于单元中心 $(x_i,y_j) = ((i+\\tfrac{1}{2})h,(j+\\tfrac{1}{2})h)$，其中 $i,j \\in \\{0,1,\\dots,N-1\\}$。\n- **离散拉普拉斯算子**: 在内部点 $(i,j)$ 处的标准五点近似由下式给出 $$-\\nabla^2 u(x_i,y_j) \\approx -\\left(\\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h^2} + \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{h^2}\\right)。$$\n- **焦点**: 邻近角点的内部单元 $(i,j)=(0,0)$ 处的离散方程。\n- **目标**: 确定二阶精度的虚拟单元关系式 $u_{-1,0}$ 和 $u_{0,-1}$，以在角点 $(x,y)=(0,0)$ 附近施加狄利克雷边界条件，并推导修正的五点格式。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n该问题描述了有限差分法在带狄利克雷边界条件的泊松方程上的一个经典应用。背景是在单元中心网格上实现，这需要使用虚拟单元。\n\n- **科学依据充分**: 该问题基于偏微分方程数值分析的基本原理。泊松方程、有限差分法、单元中心网格和虚拟单元技术都是标准的、成熟的概念。其物理和数学基础是可靠的。\n- **适定的**: 连续问题（带狄利克雷数据的泊松方程）是适定的。所构建的离散问题会导出一个可解的线性系统。问题是具体且有明确指向的。\n- **客观的**: 问题以精确的技术语言陈述，没有主观或模棱两可的术语。\n- **完整且一致**: 提供了所有必要的信息（偏微分方程、区域、边界条件、网格结构、离散格式）。没有内部矛盾。\n- **可行且不平凡**: 该任务需要使用泰勒级数进行标准但仔细的推导，以确保二阶精度，这是数值方法中的一项核心能力。在单元中心网格上处理角点的细微差别是一个有意义的概念性挑战。\n\n问题陈述是有效的。\n\n### 步骤 3：推导正确的处理方法\n\n我们的任务是推导单元 $(i,j)=(0,0)$ 的离散方程。该单元的中心位于 $(x_0, y_0) = (h/2, h/2)$。此处的离散泊松方程为：\n$$\n-\\left(\\frac{u_{1,0} - 2u_{0,0} + u_{-1,0}}{h^2} + \\frac{u_{0,1} - 2u_{0,0} + u_{0,-1}}{h^2}\\right) = f_{0,0}\n$$\n其中 $u_{k,l}$ 表示在 $(x_k, y_l) = ((k+1/2)h, (l+1/2)h)$ 处的数值解。值 $u_{-1,0}$ 和 $u_{0,-1}$ 是虚拟值，因为它们对应于区域 $\\Omega$ 之外的点。我们必须用内部值和边界数据 $g$ 来定义它们，并要保持二阶精度。\n\n**1. 左边界 ($x=0$) 的虚拟值 $u_{-1,0}$：**\n值 $u_{-1,0}$ 对应于点 $(x_{-1}, y_0) = (-h/2, h/2)$。相邻的内部值 $u_{0,0}$ 位于 $(x_0, y_0) = (h/2, h/2)$。边界在 $x=0$ 处。\n为保持二阶精度，我们可以将边界条件的近似中心设在边界上的点 $(0, y_0)$，该点恰好位于虚拟点和单元中心之间。\n使用泰勒级数，真实解 $u$ 在边界点 $(0, y_0)$ 的值与在 $(h/2, y_0)$ 和 $(-h/2, y_0)$ 处的值关系如下：\n$$u(0, y_0) = \\frac{u(h/2, y_0) + u(-h/2, y_0)}{2} - \\frac{h^2}{8} u_{xx}(0, y_0) + O(h^4)$$\n因此，近似 $u(0, y_0) \\approx \\frac{u(h/2, y_0) + u(-h/2, y_0)}{2}$ 是二阶精度的。\n狄利克雷边界条件规定 $u(0, y_0) = g(0, y_0)$。在我们的离散表示法中，当 $y_0 = h/2$ 时，这变成：\n$$g(0, h/2) \\approx \\frac{u_{0,0} + u_{-1,0}}{2}$$\n求解虚拟值 $u_{-1,0}$：\n$$u_{-1,0} = 2g(0, h/2) - u_{0,0}$$\n此关系以 $O(h^2)$ 的精度施加边界条件。\n\n**2. 下边界 ($y=0$) 的虚拟值 $u_{0,-1}$：**\n通过对 $y=0$ 边界完全类似的论证，我们在 $(x_0, 0)$ 处近似边界值，该点位于单元中心 $(x_0, y_0) = (h/2, h/2)$ 和虚拟点 $(x_0, y_{-1}) = (h/2, -h/2)$ 的中点。\n边界条件是 $u(x_0, 0) = g(x_0, 0)$。二阶精度的离散近似为：\n$$g(x_0, 0) \\approx \\frac{u_{0,0} + u_{0,-1}}{2}$$\n其中 $x_0=h/2$。求解虚拟值 $u_{0,-1}$：\n$$u_{0,-1} = 2g(h/2, 0) - u_{0,0}$$\n\n**3. 在 $(0,0)$ 处的修正五点格式：**\n现在我们将这些虚拟值表达式代回到离散泊松方程中：\n$$\n-\\left(\\frac{u_{1,0} - 2u_{0,0} + (2g(0, h/2) - u_{0,0})}{h^2} + \\frac{u_{0,1} - 2u_{0,0} + (2g(h/2, 0) - u_{0,0})}{h^2}\\right) = f_{0,0}\n$$\n简化分子中的项：\n$$\n-\\left(\\frac{u_{1,0} - 3u_{0,0} + 2g(0, h/2)}{h^2} + \\frac{u_{0,1} - 3u_{0,0} + 2g(h/2, 0)}{h^2}\\right) = f_{0,0}\n$$\n这就是二阶精度的修正格式。关键在于，它使用了在点 $(0, h/2)$ 和 $(h/2, 0)$ 处求值的边界数据 $g$，这些点是单元中心 $(h/2, h/2)$ 在相应边界上的投影。对于这种标准方法，在角点 $(0,0)$ “重复计算”的概念是一个误导；$x$ 方向导数和 $y$ 方向导数的格式是使用各自边界的数据独立修正的。这是正确且标准的程序。\n\n### 逐项分析\n\n**A. 使用通过跨每个边界面进行二阶精度反射获得的虚拟单元值：$u_{-1,0} = 2\\,g(0,y_0) - u_{0,0}$ 和 $u_{0,-1} = 2\\,g(x_0,0) - u_{0,0}$，其中 $x_0 = h/2$ 且 $y_0 = h/2$。将这些代入五点拉普拉斯算子，得到**\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + 2\\,g(0,y_0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + 2\\,g(x_0,0)}{h^2}\\right) = f_{0,0},\n$$\n**该方法为每个面引入恰好一个边界贡献，并保持二阶精度。**\n\n该选项的虚拟单元关系式、边界点 $g(0, y_0) = g(0, h/2)$ 和 $g(x_0, 0) = g(h/2, 0)$ 的使用以及最终得到的方程与我们的推导完全匹配。所提供的推理也是正确的。\n结论：**正确**。\n\n**B. 仅使用角点边界值替换两个虚拟单元，$u_{-1,0} = 2\\,g(0,0) - u_{0,0}$ 和 $u_{0,-1} = 2\\,g(0,0) - u_{0,0}$，这样离散方程就变为**\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + 2\\,g(0,0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + 2\\,g(0,0)}{h^2}\\right) = f_{0,0},\n$$\n**该方法利用了两个边界在同角点相交的事实，因此使用一个单一的共享狄利克雷值。**\n\n这种方法是有缺陷的。用于虚拟单元 $u_{-1,0}$ 的正确边界点是 $(0, y_0) = (0, h/2)$，而不是角点 $(0,0)$。边界值的差异为 $g(0,h/2) - g(0,0) = g_y(0,h/2) \\cdot (h/2) + O(h^2) = O(h)$，假设 $g$ 是光滑的。虚拟值关系中的这个 $O(h)$ 误差会将格式的局部截断误差降低到一阶，因此，解的全局精度将是一阶而非二阶。这违反了一个关键要求。\n结论：**错误**。\n\n**C. 为避免重复，对来自两个面的边界数据进行平均：设 $u_{-1,0} = 2\\,\\frac{g(0,y_0)+g(x_0,0)}{2} - u_{0,0}$ 且 $u_{0,-1} = u_{-1,0}$。得到的格式为**\n$$\n-\\left(\\frac{u_{1,0} - 3 u_{0,0} + g(0,y_0)+g(x_0,0)}{h^2} + \\frac{u_{0,1} - 3 u_{0,0} + g(0,y_0)+g(x_0,0)}{h^2}\\right) = f_{0,0},\n$$\n**该方法使用单一的平均校正来避免重复计算角点。**\n\n这种方法在概念上是错误的。虚拟值 $u_{-1,0}$ 用于近似偏导数 $u_{xx}$。它的值应该仅由 $x$ 方向的边界条件（即在 $x=0$ 处）确定。将来自 $y=0$ 面上的边界条件 $g(x_0,0)$ 平均进来，会污染 $u_{xx}$ 的近似，并使格式与原偏微分方程不一致。避免“重复计算”的前提是错误的，因为标准方法（选项A）并不会重复计算。\n结论：**错误**。\n\n**D. 添加一个对角虚拟单元校正来捕捉角点影响：设 $u_{-1,0} = 2\\,g(0,y_0) - u_{0,0}$，$u_{0,-1} = 2\\,g(x_0,0) - u_{0,0}$，并在 $(i,j)=(0,0)$ 处的九点格式中引入 $u_{-1,-1} = 2\\,g(0,0) - u_{0,0}$，以纳入边界段在角点处的交汇，从而提高角点附近的精度。**\n\n问题明确要求修改**五点格式**。这个选项提议将离散化改为九点格式，这从根本上改变了问题。五点格式不涉及像 $u_{-1,-1}$ 这样的对角邻点，因此引入这个值与指定的任务无关。虽然在其他情况下，角点处理有时可能涉及更复杂的格式，但它不是所提问题的解决方案。\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "3385233"}, {"introduction": "谱方法以其高精度而著称，但由于其全局基函数的特性，在施加边界条件时会带来独特的挑战。当边界值不满足周期性（例如 $u(-1) \\neq u(1)$）时，基于快速变换的算法可能会在边界附近引入虚假的吉布斯 (Gibbs) 振荡。此概念性练习 [@problem_id:3385166] 深入探讨了该现象的理论根源，并探讨了如提升法和谱滤波等高级缓解策略，让你深入了解近似理论与实际执行之间的相互作用。", "problem": "考虑标量场 $u$ 的线性边值问题：求 $u:[-1,1]\\to\\mathbb{R}$ 使得\n$$\n- u''(x) = f(x),\\quad x\\in(-1,1),\\qquad u(-1)=a,\\quad u(1)=b,\n$$\n其中 $f$ 在 $[-1,1]$ 上是光滑的，且给定 $a,b\\in\\mathbb{R}$。使用基于 Chebyshev–Lobatto 网格的 Chebyshev 谱配置法：对于多项式次数 $N$，配置点为 $x_j=\\cos\\!\\left(\\frac{\\pi j}{N}\\right)$，其中 $j=0,\\dots,N$。狄利克雷条件通过强加法在端点 $x_0=1$ 和 $x_N=-1$ 处施加。使用与余弦展开兼容类型的离散余弦变换 (DCT) 在节点值和 Chebyshev 系数之间进行映射，这等价于，为了进行快速变换，将 $u(\\cos\\theta)$ 在角变量 $\\theta\\in[0,\\pi]$ 上表示为余弦级数，并对其进行偶式 $2\\pi$-周期延拓至 $[0,2\\pi]$。\n\n在实践中，当 $a\\neq b$ 时，在配置解中观察到局限于 $x=\\pm 1$ 附近的高频振荡，尤其是在利用快速变换的后处理步骤中。这些振荡不会均匀地污染内部区域，而是表现为过冲，在未滤波的表示中，这些过冲不会随着 $N$ 的增加而在端点处逐点消失，呈现出类似 Gibbs 的行为。\n\n从谱近似的第一性原理出发，考虑映射 $x=\\cos\\theta$、Chebyshev 基中的多项式插值/投影的性质，以及快速变换所隐含的周期性延拓可能引入人为不连续性的机制。基于这些原理，以下哪些陈述正确地指出了在 $x=\\pm 1$ 处观察到的振荡的原因，并提出了与谱配置格式的稳定性和准确性相一致的缓解策略？\n\nA. 通过将 $u$ 写为 $u=v+\\ell$ 来提升边界条件，其中 $\\ell(x)$ 是满足 $\\ell(-1)=a$ 和 $\\ell(1)=b$ 的唯一线性函数，然后求解具有齐次 Dirichlet 数据 $v(\\pm 1)=0$ 的 $v$。在 Chebyshev–Lobatto 点上用 Chebyshev 基近似 $v$，消除了 $v(\\cos\\theta)$ 的 $2\\pi$-周期延拓在 $\\theta=0$ 和 $\\theta=2\\pi$ 处的跳跃，从而消除了类 Gibbs 振荡的主要来源。对最大的 Chebyshev 模态应用高阶指数滤波器（滤波器阶数 $p$ 随 $N$ 缓慢增长），可以抑制残余的伪振荡，同时保持远离端点处的谱精度。\n\nB. 在进行逆变换之前将 Chebyshev 系数零填充到长度 $M=\\tfrac{3}{2}N$，并在过采样网格上求值（即 $3/2$ 法则），对于 $a\\neq b$ 的线性椭圆问题，这能完全消除 $x=\\pm 1$ 附近的 Gibbs 振荡，因为过采样消除了离散余弦变换中偶式周期延拓所引入的不连续性。\n\nC. 使用同步近似项 (SAT) 边界惩罚来弱施加 Dirichlet 条件，其中惩罚参数与 $N$ 无关，这能保证在 Chebyshev 配置法中抑制线性和非线性问题的 Gibbs 振荡，且不影响离散算子的条件数。\n\nD. 当使用基于偶式延拓 $x=\\cos\\theta$ 的快速变换时，不相等的端点值 $a\\neq b$ 会在 $g(\\theta)=u(\\cos\\theta)$ 的周期性接缝处引起一个大小为 $|b-a|$ 的跳跃不连续，这会在 $\\theta=0$ 和 $\\theta=2\\pi$ 处激发出 Fourier 型的 Gibbs 现象，并映射到 $x=\\pm 1$。提升为齐次 Dirichlet 数据，然后应用利用 $[-1,1]$ 上已知光滑性的 Fourier 延拓或 Gegenbauer 重构，可以缓解振荡并在内部区域恢复指数收敛性。\n\nE. 在不包括端点的 Chebyshev–Gauss 节点上进行配置，然后通过在 $x=\\pm 1$ 处计算所得插值多项式的值来施加边界条件，这样可以避免 Gibbs 振荡，因为该多项式在 $[-1,1]$ 上是解析的，因此不会在边界附近表现出过冲。\n\n选择所有正确的陈述。基于映射 $x=\\cos\\theta$、多项式谱近似的性质，以及周期性延拓、滤波和过采样对不连续性和混淆的影响，提供理由。", "solution": "用户希望对问题陈述进行严格验证，然后提供详细的解决方案和对所给选项的评估。\n\n### 第 1 步：提取已知信息\n- **控制方程：** $- u''(x) = f(x)$，其中 $x \\in (-1, 1)$。\n- **边界条件：** $u(-1)=a$, $u(1)=b$，其中 $a, b \\in \\mathbb{R}$ 且 $f(x)$ 是 $[-1, 1]$ 上的光滑函数。\n- **数值方法：** Chebyshev 谱配置法。\n- **配置网格：** Chebyshev–Lobatto 点，$x_j = \\cos(\\frac{\\pi j}{N})$，其中 $j=0, 1, \\dots, N$。\n- **边界条件施加：** 强施加，意味着解被强制取值 $u(x_0)=u(1)=b$ 和 $u(x_N)=u(-1)=a$。*注意：问题文本中陈述 $x_0=-1$ 和 $x_N=1$，这与定义 $x_j=\\cos(\\pi j/N)$ 相矛盾。这是一个次要的印刷错误，因为 $x_0=\\cos(0)=1$，$x_N=\\cos(\\pi)=-1$。基本信息是在端点 $x=\\pm 1$ 处施加边界条件。*\n- **变换方法：** 使用离散余弦变换 (DCT) 进行快速计算，这被指出等价于使用余弦级数表示函数 $g(\\theta) = u(\\cos\\theta)$，该表示基于其偶式、$2\\pi$-周期延拓。\n- **观察到的现象：** 对于 $a \\neq b$，数值解在边界 $x=\\pm 1$ 附近表现出高频、类似 Gibbs 的振荡。这些过冲不会随着多项式次数 $N$ 的增加而消失。\n\n### 第 2 步：使用提取的已知信息进行验证\n1.  **科学依据：** 该问题牢固地植根于数值分析理论，特别是求解微分方程的谱方法。所描述的现象是一种众所周知的伪影，当基于周期基函数（如 Fourier 级数，DCT/FFT 隐式使用）的谱方法应用于具有非周期性边界条件的问题时，就会发生这种现象。Chebyshev 多项式、余弦变量代换 ($x=\\cos\\theta$) 和余弦-Fourier 级数之间的联系是该领域的基石。\n2.  **适定性：** 底层的边值问题是一个标准、适定的一维 Poisson 方程。问题要求识别数值伪影的原因和解决方案，这是数值分析中一个明确定义的任务。\n3.  **客观性：** 问题以精确、客观、技术性的语言陈述，没有主观或故作高深的断言。\n\n关于配置点索引（$x_0$ 和 $x_N$）的次要印刷错误已被注意到，但这并不影响问题的核心，该核心关注的是在 $x=\\pm 1$ 处的边界值 $a$ 和 $b$ 的后果。中心前提——当使用快速变换时，非齐次边界条件 $u(1) \\neq u(-1)$ 会在谱配置法中导致类似 Gibbs 的振荡——是一个有据可查的现象。该问题是有效的。\n\n### 第 3 步：结论与行动\n该问题有效。我将继续进行解答。\n\n### 推导与选项分析\n问题的核心在于使用离散余弦变换 (DCT)，它在算法上与快速傅里叶变换 (FFT) 相关。FFT 的速度依赖于被变换的数据是来自一个光滑、周期函数的样本的假设。如果周期函数是无穷次可微的 ($C^\\infty$)，则相应 Fourier 级数的收敛速度是快速的（谱收敛）；如果函数或其某个导数存在不连续性，则收敛速度是缓慢的（代数收敛）。\n\n映射 $x = \\cos\\theta$ 将区间 $x \\in [-1, 1]$ 变换为 $\\theta \\in [0, \\pi]$。$[-1, 1]$ 上的函数 $u(x)$ 变为 $[0, \\pi]$ 上的函数 $g(\\theta) = u(\\cos\\theta)$。DCT 对应于将 $g(\\theta)$ 展开为余弦级数 $\\sum_k c_k \\cos(k\\theta)$。这等价于对 $g(\\theta)$ 的偶式、$2\\pi$-周期延拓进行 Fourier 级数展开。\n\n类似 Gibbs 振荡的根源在于问题的边界条件与基函数的内在周期性之间的不兼容。如果 $u(1) \\neq u(-1)$，即 $g(0) \\neq g(\\pi)$，则该问题不是天然周期性的。虽然严格的分析表明，光滑函数 $u(\\cos\\theta)$ 的偶式周期延拓也是光滑的，但数值配置解 $u_N(x)$ 与真实解在多项式基上的投影并不相同。施加非齐次边界条件导致计算出的多项式 $u_N(x)$ 的系数 $\\hat{u}_k$ 衰减缓慢，类似于不连续函数的 Fourier 系数。这种缓慢衰减是类似 Gibbs 振荡的原因。这种病态行为通常被比喻为快速变换在周期性接缝处“看到”一个跳跃不连续，因为定义域两端的函数值不同。最有效的补救措施包括重新表述问题，使其与周期性表示兼容。\n\n现在，我将基于这些原则评估每个选项。\n\n**选项 A：** `通过将 $u$ 写为 $u=v+\\ell$ 来提升边界条件，其中 $\\ell(x)$ 是满足 $\\ell(-1)=a$ 和 $\\ell(1)=b$ 的唯一线性函数，然后求解具有齐次 Dirichlet 数据 $v(\\pm 1)=0$ 的 $v$。在 Chebyshev–Lobatto 点上用 Chebyshev 基近似 $v$，消除了 $v(\\cos\\theta)$ 的 $2\\pi$-周期延拓在 $\\theta=0$ 和 $\\theta=2\\pi$ 处的跳跃，从而消除了类 Gibbs 振荡的主要来源。对最大的 Chebyshev 模态应用高阶指数滤波器（滤波器阶数 $p$ 随 $N$ 缓慢增长），可以抑制残余的伪振荡，同时保持远离端点处的谱精度。`\n\n该陈述是正确的。\n1.  **提升 (Lifting)：** 减去一个线性函数 $\\ell(x) = \\frac{b-a}{2}x + \\frac{a+b}{2}$ 是一种称为“提升”的标准且有效的技术。它将原始的 $u(x)$ 问题转换为一个关于新变量 $v(x) = u(x) - \\ell(x)$ 且具有齐次边界条件 $v(\\pm 1) = 0$ 的问题。新的微分方程是 $-v''(x) = -u''(x) + \\ell''(x) = f(x)$，因为 $\\ell''(x)=0$。\n2.  **提升的效果：** 函数 $v(\\cos\\theta)$ 现在在 $\\theta=0$ 和 $\\theta=\\pi$ 处为零。其偶式周期延拓不仅是光滑的，而且在周期性的“接缝”处也为零。这使得问题与余弦级数基的周期性更加兼容，从而导致 $v(x)$ 的 Chebyshev 系数衰减得更快（谱衰减）。陈述中的措辞“消除了跳跃”是一种描述这种兼容性恢复的常见且直观的方式。\n3.  **滤波：** 提升后，由于其他效应，可能仍会残留一些小的高频振荡。对高频系数应用特殊设计的滤波器（如指数滤波器）是平滑解并抑制这些残余振荡的标准后处理步骤。高阶滤波器可以在保持近似的整体谱精度的同时完成此任务。\n\n**对 A 的结论：正确**\n\n**选项 B：** `在进行逆变换之前将 Chebyshev 系数零填充到长度 $M=\\tfrac{3}{2}N$，并在过采样网格上求值（即 $3/2$ 法则），对于 $a\\neq b$ 的线性椭圆问题，这能完全消除 $x=\\pm 1$ 附近的 Gibbs 振荡，因为过采样消除了离散余弦变换中偶式周期延拓所引入的不连续性。`\n\n该陈述是错误的。\n1.  **3/2 法则：** 3/2 法则是一种去混淆技术，用于在谱方法中高效且精确地计算*二次非线性项*。它涉及零填充系数，变换到过采样网格上的物理空间，逐点计算乘积，然后变换回来。它旨在防止与 Gibbs 振荡不同的混淆误差。\n2.  **对 Gibbs 现象的影响：** 在系数空间中进行零填充是一种插值形式。虽然它可以改变 Gibbs 振荡的外观，但它不能“完全消除”它们。根本问题是系数的缓慢衰减，而过采样并不能解决这个问题。过采样不会“消除”不连续性；它只是在更精细的网格上表示函数。\n\n**对 B 的结论：错误**\n\n**选项 C：** `使用同步近似项 (SAT) 边界惩罚来弱施加 Dirichlet 条件，其中惩罚参数与 $N$ 无关，这能保证在 Chebyshev 配置法中抑制线性和非线性问题的 Gibbs 振荡，且不影响离散算子的条件数。`\n\n该陈述在多个方面都是错误的。\n1.  **SAT 惩罚参数：** 在 SAT 方法中，向方程添加一个惩罚项以施加边界条件。为了在 Chebyshev 谱方法中保证稳定性和准确性，其中算子范数随 $N$ 缩放（例如，$\\|D^2\\| \\sim O(N^4)$），惩罚参数 $\\tau$ 通常必须随 $N$ 缩放（例如，$\\tau \\sim O(N^2)$）。一个与 $N$ 无关的参数通常不足以在 $N$ 增加时足够强地施加边界条件。\n2.  **条件数：** 向矩阵系统添加惩罚项*总是*会影响矩阵及其条件数。声称这样做“不影响条件数”是错误的。\n3.  **Gibbs 抑制：** 虽然 SAT 是一种施加边界条件的有效方法，但它本身并不能解决导致类似 Gibbs 振荡的根本周期性不匹配问题。提升（如选项 A 和 D 中所述）是解决该问题的直接方法。\n\n**对 C 的结论：错误**\n\n**选项 D：** `当使用基于偶式延拓 $x=\\cos\\theta$ 的快速变换时，不相等的端点值 $a\\neq b$ 会在 $g(\\theta)=u(\\cos\\theta)$ 的周期性接缝处引起一个大小为 $|b-a|$ 的跳跃不连续，这会在 $\\theta=0$ 和 $\\theta=2\\pi$ 处激发出 Fourier 型的 Gibbs 现象，并映射到 $x=\\pm 1$。提升为齐次 Dirichlet 数据，然后应用利用 $[-1,1]$ 上已知光滑性的 Fourier 延拓或 Gegenbauer 重构，可以缓解振荡并在内部区域恢复指数收敛性。`\n\n该陈述是正确的。\n1.  **原因识别：** 陈述“引起一个跳跃不连续”是一种物理上直观且常见的解释，尽管不完全严格。如前所述，非齐次边界条件导致数值解的谱系数表现得*好像*它们来自一个不连续的函数。这种“有效不连续性”是类似 Gibbs 振铃的根本原因。描述的其余部分与此模型一致。\n2.  **缓解策略：** 提出的策略是正确的，代表了先进、强大的技术。\n    *   **提升：** 如在 A 中所述，这是第一个也是最关键的步骤。\n    *   **Fourier 延拓 / Gegenbauer 重构：** 这些是最先进的后处理技术。Fourier 延拓将函数 $v(x)$ 扩展到一个更大的域，在该域上它是周期的，从而允许使用具有完全谱精度的标准 FFT。Gegenbauer 重构采用缓慢收敛的 Chebyshev 级数，并将其在一个不同的多项式基（Gegenbauer 多项式）中重新展开，该基更适合捕捉非光滑行为，从而恢复远离边界的指数收敛性。\n3.  **结果：** 声称这些方法“恢复指数收敛性”是准确的，并突出了它们的根本性质，将它们与简单的滤波区分开来。\n\n**对 D 的结论：正确**\n\n**选项 E：** `在不包括端点的 Chebyshev–Gauss 节点上进行配置，然后通过在 $x=\\pm 1$ 处计算所得插值多项式的值来施加边界条件，这样可以避免 Gibbs 振荡，因为该多项式在 $[-1,1]$ 上是解析的，因此不会在边界附近表现出过冲。`\n\n该陈述是错误的。\n1.  **节点选择：** 使用 Chebyshev-Gauss 节点（不包括端点）是一种有效的备用网格选择。边界条件可以通过替换两个内部配置方程等方式施加。\n2.  **有缺陷的推理：** 推理存在严重缺陷。一个多项式虽然是解析的，但肯定可以表现出振荡和过冲（例如，等距节点上的 Runge 现象）。虽然选择 Chebyshev 节点（任何类型）是为了最小化此类效应，但它们并不能消除这些效应。更重要的是，这种方法没有解决周期性不匹配的根本问题。如果在后处理中使用快速变换，同样的类似 Gibbs 的伪影将会出现，因为底层解 $u(x)$ 仍然有 $u(1) \\neq u(-1)$。\n\n**对 E 的结论：错误**\n\n### 结论\n陈述 A 和 D 都正确地（使用常见、基于物理的语言）指出了类似 Gibbs 振荡的根本原因，并提出了有效且可行的缓解策略。陈述 A 描述了一种标准的、实用的方法（提升 + 滤波），而陈述 D 描述了一种更先进、更强大的方法（提升 + 重构），可以完全恢复指数收敛性。两者都是对谱方法中有效程序的正确描述。", "answer": "$$\\boxed{AD}$$", "id": "3385166"}]}