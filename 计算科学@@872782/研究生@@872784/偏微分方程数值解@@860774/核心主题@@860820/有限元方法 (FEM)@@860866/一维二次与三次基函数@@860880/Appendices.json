{"hands_on_practices": [{"introduction": "要真正理解基函数，仅仅使用它们的最终公式是远远不够的。本练习将带您回到第一性原理，演示如何通过建立并求解基于插值条件的线性方程组，来系统地推导二次拉格朗日基函数。通过构建并反演范德蒙德矩阵 [@problem_id:3359471]，您将对多项式插值和线性代数之间的联系有更具体的理解，而这正是有限元方法的核心。", "problem": "在偏微分方程(PDEs)的有限元法(FEM)背景下，考虑参考区间 $[-1,1]$ 及其上的节点集 $\\{-1,0,1\\}$。二次Lagrange基函数 $\\{\\ell_{-1}(x), \\ell_{0}(x), \\ell_{1}(x)\\}$ 是次数至多为 $2$ 的多项式空间中唯一的一组多项式，它们对于节点 $x_{-1}=-1$、$x_{0}=0$ 和 $x_{1}=1$ 满足节点Kronecker-delta条件 $\\ell_{i}(x_{j})=\\delta_{ij}$。请仅使用基本原理，即Lagrange节点基函数的定义，以及利用单项式基 $\\{1,x,x^{2}\\}$ 构建相关Vandermonde矩阵并求逆的方法，通过对节点集 $\\{-1,0,1\\}$ 的 $3\\times 3$ Vandermonde矩阵求逆来推导这些多项式的系数向量，并以简化的标准多项式形式明确写出每个基多项式。请将最终答案以一个包含这三个关于 $x$ 的多项式的单行矩阵形式给出。无需进行四舍五入。", "solution": "在尝试解答之前，需对问题进行验证。\n\n### 步骤1：提取已知条件\n- **定义域：** 参考区间为 $[-1,1]$。\n- **节点：** 节点集为 $\\{x_{-1}, x_{0}, x_{1}\\} = \\{-1, 0, 1\\}$。\n- **基函数：** 我们需求解二次Lagrange基函数 $\\{\\ell_{-1}(x), \\ell_{0}(x), \\ell_{1}(x)\\}$。\n- **多项式空间：** 基函数是次数至多为 $2$ 的多项式。\n- **定义属性：** 基函数必须在节点上满足Kronecker-delta条件：$\\ell_{i}(x_{j})=\\delta_{ij}$，其中 $i, j \\in \\{-1, 0, 1\\}$。\n- **方法论：** 推导过程必须使用单项式基 $\\{1, x, x^2\\}$ 为给定节点构建Vandermonde矩阵，对此矩阵求逆，并使用其逆矩阵来找到基多项式的系数。\n- **输出：** 最终答案必须是以简化的标准形式明确写出的多项式，并以单行矩阵的形式呈现。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于数值分析的基本、公认原理，特别是多项式插值理论和有限元法。Lagrange基函数、单项式基和Vandermonde矩阵的概念在数学和工程学中都是标准内容。\n- **适定性：** 该问题是适定的。对于任何一组 $n+1$ 个不同的节点，都存在一组唯一的、次数至多为 $n$ 的 $n+1$ 个Lagrange基多项式。该问题提供了 $3$ 个不同的节点，要求找到唯一的二次（次数为 $2$）基，并指定了一种有效的构造方法。\n- **客观性：** 该问题以精确、客观的数学语言陈述，没有歧义或主观性论断。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它在科学上是合理的、适定的且客观的。将按照指定的方法论推导解答。\n\n### 解答推导\n\n一个一般的二次多项式可以表示为单项式基 $\\{1, x, x^2\\}$ 的线性组合：\n$$p(x) = c_0 \\cdot 1 + c_1 \\cdot x + c_2 \\cdot x^2$$\n我们寻求三个这样的多项式 $\\ell_{-1}(x)$、$\\ell_{0}(x)$ 和 $\\ell_{1}(x)$，其系数向量分别为 $(c_{-1,0}, c_{-1,1}, c_{-1,2})$、$(c_{0,0}, c_{0,1}, c_{0,2})$ 和 $(c_{1,0}, c_{1,1}, c_{1,2})$。\n\nLagrange基函数的定义属性是 $\\ell_{i}(x_j) = \\delta_{ij}$。对于一个通用的基函数 $\\ell_i(x) = c_{i0} + c_{i1}x + c_{i2}x^2$，在三个节点 $x_{-1}=-1$、$x_0=0$ 和 $x_1=1$ 处求值，可得到一个关于其三个系数的三元线性方程组：\n$$\n\\begin{cases}\nc_{i0} + c_{i1}(x_{-1}) + c_{i2}(x_{-1})^2 = \\delta_{i, -1} \\\\\nc_{i0} + c_{i1}(x_{0}) + c_{i2}(x_{0})^2 = \\delta_{i, 0} \\\\\nc_{i0} + c_{i1}(x_{1}) + c_{i2}(x_{1})^2 = \\delta_{i, 1}\n\\end{cases}\n$$\n代入节点值 $x_{-1}=-1$、$x_0=0$、$x_1=1$：\n$$\n\\begin{cases}\nc_{i0} - c_{i1} + c_{i2} = \\delta_{i, -1} \\\\\nc_{i0} = \\delta_{i, 0} \\\\\nc_{i0} + c_{i1} + c_{i2} = \\delta_{i, 1}\n\\end{cases}\n$$\n该方程组可以写成矩阵形式 $V \\mathbf{c}_i = \\mathbf{d}_i$，其中 $\\mathbf{c}_i = (c_{i0}, c_{i1}, c_{i2})^T$，$\\mathbf{d}_i = (\\delta_{i,-1}, \\delta_{i,0}, \\delta_{i,1})^T$，而 $V$ 是由节点构造的Vandermonde矩阵：\n$$V = \\begin{pmatrix} 1  x_{-1}  x_{-1}^2 \\\\ 1  x_{0}  x_{0}^2 \\\\ 1  x_{1}  x_{1}^2 \\end{pmatrix} = \\begin{pmatrix} 1  -1  (-1)^2 \\\\ 1  0  0^2 \\\\ 1  1  1^2 \\end{pmatrix} = \\begin{pmatrix} 1  -1  1 \\\\ 1  0  0 \\\\ 1  1  1 \\end{pmatrix}$$\n对于 $i = -1, 0, 1$，右端向量是 $\\mathbb{R}^3$ 的标准基向量，尽管由于节点索引的原因顺序有所不同：$\\mathbf{d}_{-1} = (1,0,0)^T$，$\\mathbf{d}_{0} = (0,1,0)^T$，以及 $\\mathbf{d}_{1} = (0,0,1)^T$。\n\n系数向量 $\\mathbf{c}_i$ 通过求解 $\\mathbf{c}_i = V^{-1}\\mathbf{d}_i$ 得到。这意味着 $\\ell_{-1}(x)$ 的系数向量是 $V^{-1}$ 的第一列，$\\ell_0(x)$ 的系数向量是第二列，而 $\\ell_1(x)$ 的系数向量是第三列。我们的任务简化为求Vandermonde矩阵 $V$ 的逆矩阵。\n\n首先，我们沿第二行展开来计算 $V$ 的行列式：\n$$\\det(V) = 1 \\cdot (-1)^{2+1} \\det\\begin{pmatrix} -1  1 \\\\ 1  1 \\end{pmatrix} = -1((-1)(1) - (1)(1)) = -1(-2) = 2$$\n由于 $\\det(V) \\neq 0$，逆矩阵 $V^{-1}$ 存在。我们使用伴随矩阵公式 $V^{-1} = \\frac{1}{\\det(V)}\\text{adj}(V)$ 来求逆。伴随矩阵是代数余子式矩阵的转置。\n\n代数余子式矩阵 $C_{ij} = (-1)^{i+j}M_{ij}$ 为：\n$$\n\\text{cof}(V) = \\begin{pmatrix}\n+\\det\\begin{pmatrix} 0  0 \\\\ 1  1 \\end{pmatrix}  -\\det\\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}  +\\det\\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\\\\n-\\det\\begin{pmatrix} -1  1 \\\\ 1  1 \\end{pmatrix}  +\\det\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}  -\\det\\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix} \\\\\n+\\det\\begin{pmatrix} -1  1 \\\\ 0  0 \\end{pmatrix}  -\\det\\begin{pmatrix} 1  1 \\\\ 1  0 \\end{pmatrix}  +\\det\\begin{pmatrix} 1  -1 \\\\ 1  0 \\end{pmatrix}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0  -1  1 \\\\\n2  0  -2 \\\\\n0  1  1\n\\end{pmatrix}\n$$\n伴随矩阵是代数余子式矩阵的转置：\n$$\\text{adj}(V) = (\\text{cof}(V))^T = \\begin{pmatrix} 0  2  0 \\\\ -1  0  1 \\\\ 1  -2  1 \\end{pmatrix}$$\n逆矩阵为：\n$$V^{-1} = \\frac{1}{2} \\begin{pmatrix} 0  2  0 \\\\ -1  0  1 \\\\ 1  -2  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -1  \\frac{1}{2} \\end{pmatrix}$$\n$V^{-1}$ 的各列包含多项式的系数 $(c_{i0}, c_{i1}, c_{i2})$。\n第一列给出了 $\\ell_{-1}(x)$ 的系数：\n$$\\begin{pmatrix} c_{-1,0} \\\\ c_{-1,1} \\\\ c_{-1,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\implies \\ell_{-1}(x) = 0 - \\frac{1}{2}x + \\frac{1}{2}x^2 = \\frac{1}{2}x^2 - \\frac{1}{2}x$$\n第二列给出了 $\\ell_{0}(x)$ 的系数：\n$$\\begin{pmatrix} c_{0,0} \\\\ c_{0,1} \\\\ c_{0,2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\implies \\ell_{0}(x) = 1 + 0x - 1x^2 = 1 - x^2$$\n第三列给出了 $\\ell_{1}(x)$ 的系数：\n$$\\begin{pmatrix} c_{1,0} \\\\ c_{1,1} \\\\ c_{1,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\implies \\ell_{1}(x) = 0 + \\frac{1}{2}x + \\frac{1}{2}x^2 = \\frac{1}{2}x^2 + \\frac{1}{2}x$$\n三个基多项式的简化标准形式为：\n$\\ell_{-1}(x) = \\frac{1}{2}x^2 - \\frac{1}{2}x$\n$\\ell_{0}(x) = -x^2 + 1$\n$\\ell_{1}(x) = \\frac{1}{2}x^2 + \\frac{1}{2}x$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}x^2 - \\frac{1}{2}x  1 - x^2  \\frac{1}{2}x^2 + \\frac{1}{2}x\n\\end{pmatrix}\n}\n$$", "id": "3359471"}, {"introduction": "一旦我们有了基函数，我们就可以用它们来构建系统矩阵，例如刚度矩阵和质量矩阵，这涉及到对这些函数或其导数的乘积进行积分。由于这些积分可能很复杂，我们通常依赖于数值求积。本实践问题 [@problem_id:3359439] 探讨了一个关键问题：要*精确*计算刚度矩阵的积分，所需的求积点数*最少*是多少？解答这个问题需要分析被积函数的多项式次数，这有助于我们深入了解有限元方法实现的效率和准确性。同样，这一原则也适用于质量矩阵项的计算 [@problem_id:3359448]。", "problem": "在求解一维偏微分方程 (PDE) 的有限元法 (FEM) 中，考虑参考单元 $\\hat{\\Omega} = [-1,1]$ 以及在 $\\hat{\\Omega}$ 上的 $p$ 次标准拉格朗日节点基 $\\{\\ell_i(\\hat{x})\\}$。在 $\\hat{\\Omega}$ 上，常系数椭圆算子的局部刚度矩阵项为\n$$\nK_{ij} \\;=\\; \\int_{-1}^{1} \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})\\,d\\hat{x}.\n$$\n假设这些积分使用 $[-1,1]$ 上的 $n$ 点高斯-勒让德求积法进行计算，该方法具有 $2n-1$ 次的多项式精度。对于多项式次数 $p=2$ 和 $p=3$（记作 $P_2$ 和 $P_3$），请确定在每种情况下，为使所有基函数索引对 $(i,j)$ 的 $K_{ij}$ 都能被精确积分所需的最小求积点数 $n$。将您对 $P_2$ 和 $P_3$ 的答案表示为一个按 $p$ 递增顺序排列的单行向量。无需四舍五入，不涉及物理单位。", "solution": "本题要求确定对于多项式次数为 $p=2$ 和 $p=3$ 的一维拉格朗日有限元，精确计算局部刚度矩阵项 $K_{ij}$ 所需的高斯-勒让德求积点数 $n$ 的最小值。\n\n参考单元 $\\hat{\\Omega} = [-1,1]$ 上的刚度矩阵项由以下积分给出：\n$$\nK_{ij} = \\int_{-1}^{1} \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})\\,d\\hat{x}\n$$\n此处，$\\{\\ell_i(\\hat{x})\\}$ 是 $p$ 次拉格朗日基函数集合。根据定义，每个基函数 $\\ell_i(\\hat{x})$ 都是一个 $p$ 次多项式。\n\n第一步是确定被积函数 $I(\\hat{x}) = \\ell_i'(\\hat{x})\\,\\ell_j'(\\hat{x})$ 的多项式次数。\n一个 $p$ 次多项式的导数是一个 $p-1$ 次多项式。因此，$\\ell_i'(\\hat{x})$ 和 $\\ell_j'(\\hat{x})$ 都是 $p-1$ 次多项式。\n\n两个 $p-1$ 次多项式的乘积是一个 $(p-1) + (p-1) = 2p-2$ 次多项式。因此，被积函数 $I(\\hat{x})$ 是一个 $2p-2$ 次多项式。\n\n题目指出，$n$ 点高斯-勒让德求积法则对于最高 $2n-1$ 次的多项式是精确的。为了精确计算 $I(\\hat{x})$ 的积分，求积法则的精度次数必须大于或等于多项式 $I(\\hat{x})$ 的次数。这给出了以下不等式：\n$$\n2n-1 \\ge \\deg(I(\\hat{x}))\n$$\n代入被积函数的次数，我们得到：\n$$\n2n-1 \\ge 2p-2\n$$\n为了找到最小点数 $n$，我们对 $n$ 求解这个不等式：\n$$\n2n \\ge 2p-2+1\n$$\n$$\n2n \\ge 2p-1\n$$\n$$\nn \\ge \\frac{2p-1}{2}\n$$\n$$\nn \\ge p - \\frac{1}{2}\n$$\n由于求积点数 $n$ 必须是整数，因此 $n$ 的最小值是满足此条件的最小整数。这可以通过对右侧取上整得到：\n$$\nn_{min} = \\lceil p - \\frac{1}{2} \\rceil\n$$\n对于任何整数 $p \\ge 1$，这可以简化为 $n_{min} = p$。\n\n现在我们将这个一般性结果应用于所要求的两种具体情况。\n\n情况 1：$p=2$（二次基函数，$P_2$）\n对于 $p=2$，最小求积点数为：\n$$\nn \\ge 2 - \\frac{1}{2} = 1.5\n$$\n满足此条件的最小整数 $n$ 是 $n=2$。\n或者，被积函数的次数是 $2(2)-2 = 2$。精确性条件是 $2n-1 \\ge 2$，得出 $2n \\ge 3$，即 $n \\ge 1.5$。最小整数是 $n=2$。\n\n情况 2：$p=3$（三次基函数，$P_3$）\n对于 $p=3$，最小求积点数为：\n$$\nn \\ge 3 - \\frac{1}{2} = 2.5\n$$\n满足此条件的最小整数 $n$ 是 $n=3$。\n或者，被积函数的次数是 $2(3)-2 = 4$。精确性条件是 $2n-1 \\ge 4$，得出 $2n \\ge 5$，即 $n \\ge 2.5$。最小整数是 $n=3$。\n\n对于 $p=2$ 所需的最小求积点数是 $2$，对于 $p=3$ 是 $3$。题目要求将这些答案表示为一个按 $p$ 递增顺序排列的单行向量。顺序是 $(p=2, p=3)$，所以对应的 $n$ 值为 $(2, 3)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  3\n\\end{pmatrix}\n}\n$$", "id": "3359439"}, {"introduction": "除了代数构造和在积分中的应用，基函数的几何形状对有限元逼近的质量有着深远的影响。本练习 [@problem_id:3359493] 探究了二次和三次拉格朗日基函数的非负性和振荡特性。理解为什么某些高阶基函数在单元内部必须取负值，是掌握如龙格现象以及数值解中可能出现的伪振荡等概念的关键。", "problem": "考虑典型的一维参考单元 $[-1,1]$ 以及在等距节点上构建的 $p$ 次节点拉格朗日基。对于次数 $p=2$，使用节点 $x=-1$、$x=0$ 和 $x=1$。对于次数 $p=3$，使用节点 $x=-1$、$x=-\\tfrac{1}{3}$、$x=\\tfrac{1}{3}$ 和 $x=1$。拉格朗日基函数由插值性质定义：对于给定的节点 $x_i$，相应的基函数 $\\ell_i(x)$ 是次数至多为 $p$ 的唯一多项式，使得 $\\ell_i(x_i)=1$ 且对于所有其他节点 $x_j\\neq x_i$ 有 $\\ell_i(x_j)=0$。如果一个函数 $\\phi(x)$ 对于所有 $x\\in[-1,1]$ 都满足 $\\phi(x)\\ge 0$，则称其在 $[-1,1]$ 上是非负的。\n\n根据拉格朗日插值的基本定义和实多项式的基本性质（包括实多项式在穿过其单实零点时会改变符号这一事实），确定哪一个陈述正确描述了 $P_2$ 和 $P_3$ 拉格朗日基函数在 $[-1,1]$ 上的非负性，并解释了符号变化与单元内多项式振荡的关系。\n\nA. 对于节点为 $-1$, $0$, $1$ 的 $P_2$，所有三个拉格朗日基函数在 $[-1,1]$ 上都是非负的；对于节点为 $-1$, $-\\tfrac{1}{3}$, $\\tfrac{1}{3}$, $1$ 的 $P_3$，恰好两个内部基函数是非负的；没有符号变化表示没有振荡。\n\nB. 对于 $P_2$，只有与 $x=0$ 相关的内部基函数在 $[-1,1]$ 上是非负的，而每个端点基函数在内部改变一次符号。对于 $P_3$，没有一个拉格朗日基函数在 $[-1,1]$ 上是非负的，并且每个基函数都至少有一次内部符号变化；符号变化发生在每个单零点处，反映了在多个节点上插值所需的交替性，即单元内振荡随多项式次数的增加而增长。\n\nC. 对于 $P_2$，所有基函数在 $[-1,1]$ 内部改变两次符号；而对于 $P_3$，端点基函数保持非负，内部基函数恰好改变一次符号；拉格朗日构造消除了振荡。\n\nD. 通过将任何拉格朗日基函数乘以一个正常数可以强制实现非负性，因此所有次数的基函数都可以通过缩放变为非负的；振荡与内部零点的存在无关。\n\nE. 使用等距节点时，每个 $P_3$ 拉格朗日基函数在 $[-1,1]$ 上恰好有三次内部符号变化，因此符号变化的次数等于多项式的次数。", "solution": "**问题分解：**\n\n题目要求我分析在参考单元 $[-1, 1]$ 上，对于多项式次数 $p=2$ 和 $p=3$ 且使用等距节点时的拉格朗日基函数的非负性。我还需要将其与单元内振荡的概念联系起来。\n\n**第一部分：验证**\n\n*   **步骤 1：提取已知条件**\n    *   典型一维参考单元：$[-1,1]$。\n    *   $p$ 次节点拉格朗日基，构建于等距节点上。\n    *   对于次数 $p=2$，使用节点 $x=-1$、$x=0$ 和 $x=1$。\n    *   对于次数 $p=3$，使用节点 $x=-1$、$x=-\\tfrac{1}{3}$、$x=\\tfrac{1}{3}$ 和 $x=1$。\n    *   拉格朗日基函数 $\\ell_i(x)$ 的定义：次数至多为 $p$ 的唯一多项式，使得 $\\ell_i(x_i)=1$ 且对于所有其他节点 $x_j\\neq x_i$ 都有 $\\ell_i(x_j)=0$。\n    *   $[-1,1]$ 上非负性的定义：对于所有 $x\\in[-1,1]$ 都有 $\\phi(x)\\ge 0$。\n    *   提到的基本性质：一个实多项式在穿过其单实零点时会改变符号。\n    *   问题：确定哪个陈述正确描述了 $P_2$ 和 $P_3$ 拉格朗日基函数在 $[-1,1]$ 上的非负性，并解释了符号变化与单元内多项式振荡的关系。\n\n*   **步骤 2：使用提取的已知条件进行验证**\n    *   **科学上是否成立？** 是。拉格朗日插值是数值分析和逼近论中的一个标准课题。多项式的性质是数学的核心。\n    *   **是否适定？** 是。多项式次数、节点位置和区间都已精确指定。问题要求对明确定义的数学对象进行分析，从而得出唯一的结论。\n    *   **是否客观？** 是。问题以清晰、无歧义的数学术语陈述。\n    *   **缺陷检查清单：**\n        1.  **科学或事实不健全：** 无。前提是数值方法的标准定义。\n        2.  **无法形式化或不相关：** 无。问题是形式化陈述的，并且与偏微分方程数值解（特别是有限元法）中基函数的研究直接相关。\n        3.  **设置不完整或矛盾：** 无。所有必要信息都已提供。\n        4.  **不切实际或不可行：** 无。研究对象是标准的数学构造。\n        5.  **病态或结构不良：** 无。指定多项式的性质可以被唯一确定。\n        6.  **伪深刻、琐碎或同义反复：** 无。该问题需要正确应用多项式性质和插值理论，这是一项实质性的任务。\n        7.  **无法进行科学验证：** 无。这些断言在数学上是可证明的。\n\n*   **步骤 3：结论与行动**\n    *   问题陈述有效。将推导解答。\n\n### 推导\n\n我们将构建或分析在参考单元 $[-1, 1]$ 上多项式次数为 $p=2$ ($\\text{P}_2$) 和 $p=3$ ($\\text{P}_3$) 的拉格朗日基函数。对于具有节点 $\\{x_j\\}_{j=0}^p$ 的 $p$ 次拉格朗日基函数 $\\ell_i(x)$，其通用公式为：\n$$ \\ell_i(x) = \\prod_{j=0, j\\neq i}^{p} \\frac{x-x_j}{x_i-x_j} $$\n\n**$\\text{P}_2$ 基函数的分析**\n节点为 $x_0 = -1$, $x_1 = 0$, $x_2 = 1$。次数为 $p=2$。\n\n1.  **与节点 $x_0 = -1$ 相关的基函数 $\\ell_0(x)$：**\n    该函数必须满足 $\\ell_0(-1)=1$, $\\ell_0(0)=0$ 和 $\\ell_0(1)=0$。在 $x=0$ 和 $x=1$ 处的零点决定了其形式。\n    $$ \\ell_0(x) = \\frac{(x-0)(x-1)}{(-1-0)(-1-1)} = \\frac{x(x-1)}{2} = \\frac{1}{2}x^2 - \\frac{1}{2}x $$\n    在区间 $[-1, 1]$ 上，这个二次函数在 $x=0$ 处有一个零点，该零点位于定义域的内部 $(-1, 1)$。对于 $x \\in (-1, 0)$, $\\ell_0(x) > 0$。对于 $x \\in (0, 1)$, $\\ell_0(x)  0$。因此，$\\ell_0(x)$ 在 $[-1, 1]$ 上不是非负的，并且在内部改变一次符号。\n\n2.  **与节点 $x_1 = 0$ 相关的基函数 $\\ell_1(x)$：**\n    该函数必须满足 $\\ell_1(0)=1$, $\\ell_1(-1)=0$ 和 $\\ell_1(1)=0$。\n    $$ \\ell_1(x) = \\frac{(x-(-1))(x-1)}{(0-(-1))(0-1)} = \\frac{(x+1)(x-1)}{-1} = 1-x^2 $$\n    这是一个开口向下的抛物线，其最大值在 $x=0$ 处。对于所有 $x \\in [-1, 1]$，我们有 $x^2 \\le 1$，这意味着 $1-x^2 \\ge 0$。因此，$\\ell_1(x)$ 在 $[-1, 1]$ 上是非负的。\n\n3.  **与节点 $x_2 = 1$ 相关的基函数 $\\ell_2(x)$：**\n    该函数必须满足 $\\ell_2(1)=1$, $\\ell_2(-1)=0$ 和 $\\ell_2(0)=0$。\n    $$ \\ell_2(x) = \\frac{(x-(-1))(x-0)}{(1-(-1))(1-0)} = \\frac{x(x+1)}{2} = \\frac{1}{2}x^2 + \\frac{1}{2}x $$\n    根据对称性，$\\ell_2(x) = \\ell_0(-x)$。该函数在 $x=0$ 处有一个零点，该零点位于内部 $(-1, 1)$。对于 $x \\in (-1, 0)$, $\\ell_2(x)  0$。对于 $x \\in (0, 1)$, $\\ell_2(x) > 0$。因此，$\\ell_2(x)$ 在 $[-1, 1]$ 上不是非负的，并且在内部改变一次符号。\n\n**$\\text{P}_2$ 总结：**只有内部基函数 $\\ell_1(x)$ 在 $[-1, 1]$ 上是非负的。两个端点基函数 $\\ell_0(x)$ 和 $\\ell_2(x)$ 都在单元内部改变一次符号。\n\n**$\\text{P}_3$ 基函数的分析**\n节点为 $x_0 = -1$, $x_1 = -1/3$, $x_2 = 1/3$, $x_3 = 1$。次数为 $p=3$。我们可以通过确定每个基函数的根来分析其符号行为。根据定义，$\\ell_i(x)$ 的根是所有其他节点 $x_j$ (其中 $j \\neq i$)。\n\n1.  **与节点 $x_0 = -1$ 相关的基函数 $\\ell_0(x)$：**\n    $\\ell_0(x)$ 的根是 $x = -1/3, x = 1/3, x = 1$。其中两个根 $-1/3$ 和 $1/3$ 位于区间 $(-1, 1)$ 的内部。由于这些是该多项式的单根，$\\ell_0(x)$ 在穿过每个根时必须改变符号。因此，$\\ell_0(x)$ 在区间内部改变两次符号，并且在 $[-1, 1]$ 上不是非负的。\n\n2.  **与节点 $x_1 = -1/3$ 相关的基函数 $\\ell_1(x)$：**\n    $\\ell_1(x)$ 的根是 $x = -1, x = 1/3, x = 1$。其中一个根 $1/3$ 位于内部 $(-1, 1)$。该函数在穿过 $x=1/3$ 时必须改变符号。因此，$\\ell_1(x)$ 在区间内部改变一次符号，并且在 $[-1, 1]$ 上不是非负的。\n\n3.  **与节点 $x_2 = 1/3$ 相关的基函数 $\\ell_2(x)$：**\n    $\\ell_2(x)$ 的根是 $x = -1, x = -1/3, x = 1$。其中一个根 $-1/3$ 位于内部 $(-1, 1)$。与 $\\ell_1(x)$ 类似，该函数在穿过 $x=-1/3$ 时必须改变符号。因此，$\\ell_2(x)$ 在区间内部改变一次符号，并且在 $[-1, 1]$ 上不是非负的。\n\n4.  **与节点 $x_3 = 1$ 相关的基函数 $\\ell_3(x)$：**\n    $\\ell_3(x)$ 的根是 $x = -1, x = -1/3, x = 1/3$。其中两个根 $-1/3$ 和 $1/3$ 位于区间 $(-1, 1)$ 的内部。与 $\\ell_0(x)$ 类似，该函数在区间内部必须改变两次符号，并且在 $[-1, 1]$ 上不是非负的。\n\n**$\\text{P}_3$ 总结：**四个拉格朗日基函数在 $[-1, 1]$ 上都不是非负的。每个函数都在单元内部至少有一次符号变化。\n\n**与振荡的关系：**\n基函数在单元内的符号变化是多项式振荡的直接体现。基函数 $\\ell_i(x)$ 在其自身节点 $x_i$ 处等于 $1$ 并在所有其他节点 $x_j$ 处等于 $0$ 的要求，迫使多项式在这些点之间“摆动”。对于等距节点，这种效应（称为龙格现象）随着多项式次数 $p$ 的增加而变得更加明显。我们的分析显示了这一趋势：对于 $\\text{P}_2$，端点函数有一个内部零点；对于 $\\text{P}_3$，它们有两个。所有基函数的内部根的总数从 $\\text{P}_2$ 的 $2$ 个增加到 $\\text{P}_3$ 的 $1+1+2+2=6$ 个。这表明，对于这种节点选择，单元内振荡随多项式次数的增加而增长。\n\n### 逐项分析\n\n**A. 对于节点为 $-1$, $0$, $1$ 的 $P_2$，所有三个拉格朗日基函数在 $[-1,1]$ 上都是非负的；对于节点为 $-1$, $-\\tfrac{1}{3}$, $\\tfrac{1}{3}$, $1$ 的 $P_3$，恰好两个内部基函数是非负的；没有符号变化表示没有振荡。**\n这个陈述在事实上是错误的。对于 $\\text{P}_2$，我们发现只有一个基函数（$\\ell_1(x)$）是非负的。对于 $\\text{P}_3$，我们发现没有一个基函数是非负的。\n**结论：错误**。\n\n**B. 对于 $P_2$，只有与 $x=0$ 相关的内部基函数在 $[-1,1]$ 上是非负的，而每个端点基函数在内部改变一次符号。对于 $P_3$，没有一个拉格朗日基函数在 $[-1,1]$ 上是非负的，并且每个基函数都至少有一次内部符号变化；符号变化发生在每个单零点处，反映了在多个节点上插值所需的交替性，即单元内振荡随多项式次数的增加而增长。**\n这个陈述与我们的推导完全一致。\n- 对 $\\text{P}_2$ 基函数的描述是正确的：只有 $\\ell_1(x)$ 是非负的，而 $\\ell_0(x)$ 和 $\\ell_2(x)$ 各有一次内部符号变化。\n- 对 $\\text{P}_3$ 基函数的描述是正确的：没有一个是始终非负的，并且所有基函数都至少有一次内部符号变化。\n- 最后的解释正确地将符号变化（内部零点）与在等距节点上进行高次多项式插值所固有的振荡行为联系起来。\n**结论：正确**。\n\n**C. 对于 $P_2$，所有基函数在 $[-1,1]$ 内部改变两次符号；而对于 $P_3$，端点基函数保持非负，内部基函数恰好改变一次符号；拉格朗日构造消除了振荡。**\n这个陈述包含多个谬误。对于 $\\text{P}_2$，$\\ell_1(x)$ 不改变符号，而 $\\ell_0(x)$ 和 $\\ell_2(x)$ 改变一次符号，不是两次。对于 $\\text{P}_3$，端点基函数不是非负的。声称拉格朗日构造消除了振荡，这与等距节点情况下的事实恰恰相反。\n**结论：错误**。\n\n**D. 通过将任何拉格朗日基函数乘以一个正常数可以强制实现非负性，因此所有次数的基函数都可以通过缩放变为非负的；振荡与内部零点的存在无关。**\n这在根本上是有缺陷的。如果一个函数同时取正值和负值，将其乘以一个正常数并不会改变其符号行为。此外，内部零点（符号变化）的存在正是所讨论的振荡的定义。\n**结论：错误**。\n\n**E. 使用等距节点时，每个 $P_3$ 拉格朗日基函数在 $[-1,1]$ 上恰好有三次内部符号变化，因此符号变化的次数等于多项式的次数。**\n这在事实上是错误的。一个 $\\text{P}_3$ 基函数是一个三次多项式，总共最多只能有3个实根。端点函数 $\\ell_0(x)$ 和 $\\ell_3(x)$ 有两个内部根。内部函数 $\\ell_1(x)$ 和 $\\ell_2(x)$ 有一个内部根。每个函数都有三次内部符号变化的说法是错误的。\n**结论：错误**。", "answer": "$$\\boxed{B}$$", "id": "3359493"}]}