## 引言
在有限元方法（FEM）的广阔领域中，[基函数](@entry_id:170178)的选择是决定数值模拟精度、效率和能力的核心。虽然线性[基函数](@entry_id:170178)因其简单性而成为入门首选，但它们在处理复杂几何、陡峭梯度或高精度要求问题时往往力不从心。这正是[高阶基函数](@entry_id:165641)——如本文将探讨的一维二次与[三次基函数](@entry_id:748106)——展现其强大威力的地方。本文旨在系统性地填补从理解基础线性元到掌握高阶元的知识鸿沟。我们将超越简单的[线性插值](@entry_id:137092)，深入探索这些更复杂多项式所提供的丰富功能和数学精髓。

读者将通过三个层次递进的章节，全面掌握这一主题。在“**原理与机制**”一章中，我们将从第一性原理出发，详细阐述二次和[三次基函数](@entry_id:748106)的构建方法、关键数学性质以及[等参变换](@entry_id:750863)的机制。随后的“**应用与交叉学科联系**”一章将展示这些理论如何在[结构力学](@entry_id:276699)、波物理和[非线性](@entry_id:637147)问题等实际应用中发挥作用。最后，“**动手实践**”部分将提供具体的计算练习，帮助您将理论知识转化为实践技能。

让我们首先深入第一章，揭示这些强大数学工具背后的基本原理与精妙机制。

## 原理与机制

在有限元方法中，近似解是在一个由分片多项式构成的有限维[函数空间](@entry_id:143478)中求出的。构建这些分片[多项式空间](@entry_id:144410)的基石是在单个“单元”上定义的[局部基](@entry_id:151573)函数。本章将详细阐述一维问题中二次和三次多项式[基函数](@entry_id:170178)的构建原理及其关键机制，这些内容是高阶有限元方法的基础。

### 多项式[基函数](@entry_id:170178)的基础

为了在一个区间上用[多项式逼近](@entry_id:137391)一个函数，我们首先需要精确定义我们所使用的多项式空间，并理解其基本属性。

#### 多项式空间 $P_k(I)$

在[有限元分析](@entry_id:138109)中，我们通常在一个有界闭区间 $I = [a, b]$ 上定义局部函数空间。对于 $k$ 次多项式，这个空间被记为 $P_k(I)$，它包含了所有在区间 $I$ 上次数**不超过** $k$ 的实系数多项式。任何一个属于 $P_k(I)$ 的多项式 $p(x)$ 都可以写成如下形式：

$p(x) = c_0 + c_1 x + c_2 x^2 + \dots + c_k x^k$

其中 $c_i \in \mathbb{R}$ 是常数系数。重要的是，$P_k(I)$ 是一个[向量空间](@entry_id:151108)，因为它对加法和标量乘法封闭，并且包含零多项式。这与“次数恰好为 $k$ 的多项式集合”不同，后者不是一个[向量空间](@entry_id:151108)。

#### 维度与自由度

[向量空间](@entry_id:151108)的**维度**是指其任何一组基所包含的向量数量。对于[多项式空间](@entry_id:144410) $P_k(I)$，一组标准的基是单项式集合 $\{1, x, x^2, \dots, x^k\}$。这个集合包含 $k+1$ 个线性无关的函数，因此，$P_k(I)$ 的维度是：

$\dim P_k(I) = k+1$

这个维度独立于区间的具体位置或长度（只要 $a \lt b$）。根据线性代数的基本原理，为了唯一确定一个 $k+1$ 维[向量空间](@entry_id:151108)中的向量，我们需要 $k+1$ 个[线性无关](@entry_id:148207)的条件。在有限元背景下，这些条件被称为**自由度 (Degrees of Freedom, DoF)**。自由度是作用于[多项式空间](@entry_id:144410)上的一组[线性泛函](@entry_id:276136)，它们的取值唯一地确定了空间中的多项式。

因此，确定一个 $P_k(I)$ 中的多项式所需的自由度数量恰好是该空间的维度，即 $k+1$。由此我们可以直接推断：

*   对于**二次单元** ($k=2$)，我们需要 $\dim P_2(I) = 2+1 = 3$ 个自由度。
*   对于**三次单元** ($k=3$)，我们需要 $\dim P_3(I) = 3+1 = 4$ 个自由度。

这些自由度的具体形式可以有多种选择，例如在特定点上的函数值、在特定点上的导数值，或是函数在区间上的积分均值等 [@problem_id:3359476]。

#### [单值性](@entry_id:174849)

选择的一组自由度必须是**单值的 (unisolvent)**。这意味着，对于任意一组给定的自由度值，都存在且仅存在一个多项式与之对应。当自由度是 $k+1$ 个不同节点上的函数值求值时，[单值性](@entry_id:174849)得到了保证。这是因为一个非零的 $k$ 次多项式最多有 $k$ 个根，不可能在 $k+1$ 个不同的点上同时为零。因此，在 $k+1$ 个不同节点上指定函数值，足以唯一地确定一个 $k$ 次多项式。

### [节点基](@entry_id:752522)函数：拉格朗日族

最常见的自由度选择是在单元上选取一系列**节点 (nodes)**，并将函数在这些节点上的值作为自由度。由此产生的[基函数](@entry_id:170178)族被称为**拉格朗日 (Lagrange) [基函数](@entry_id:170178)**。

#### 克罗内克性质

[拉格朗日基](@entry_id:751105)函数的核心在于其定义的**克罗内克 (Kronecker) 插值性质**。假设我们为 $P_k(I)$ 空间选择了 $k+1$ 个不同的节点 $\{\xi_0, \xi_1, \dots, \xi_k\}$。那么，对应的[拉格朗日基](@entry_id:751105)函数集 $\{\ell_0(x), \ell_1(x), \dots, \ell_k(x)\}$ 中的每一个[基函数](@entry_id:170178) $\ell_i(x)$ 本身都是一个 $P_k(I)$ 中的多项式，并且它在所有节点上满足以下条件：

$\ell_i(\xi_j) = \delta_{ij} = \begin{cases} 1  \text{if } i=j \\ 0  \text{if } i \neq j \end{cases}$

其中 $\delta_{ij}$ 是克罗内克符号。换言之，[基函数](@entry_id:170178) $\ell_i(x)$ 在其“自己的”节点 $\xi_i$ 上取值为 1，而在所有其他节点 $\xi_j$ ($j \neq i$) 上取值为 0。这个特性使得任何一个 $P_k(I)$ 中的多项式 $p(x)$ 都可以方便地表示为其在节点上值的[线性组合](@entry_id:154743)：

$p(x) = \sum_{j=0}^{k} p(\xi_j) \ell_j(x)$

#### 构建二次[基函数](@entry_id:170178)

让我们在一个[标准化](@entry_id:637219)的**[参考单元](@entry_id:168425) (reference element)** $\hat{K} = [-1, 1]$ 上，从第一性原理出发构建二次[拉格朗日基](@entry_id:751105)函数。对于 $P_2$ 空间，我们需要 3 个节点。一个方便且对称的选择是 $\{-1, 0, 1\}$ [@problem_id:3359431]。

*   **构建 $\ell_0(x)$ (对应节点 $x_0 = -1$)**:
    该函数需满足 $\ell_0(-1)=1$, $\ell_0(0)=0$, $\ell_0(1)=0$。后两个条件意味着 $x=0$ 和 $x=1$ 是 $\ell_0(x)$ 的根。因此，$\ell_0(x)$ 必须包含因子 $x$ 和 $(x-1)$。作为一个二次多项式，其形式必为 $\ell_0(x) = C_0 \cdot x(x-1)$。利用第一个条件 $\ell_0(-1)=1$ 来确定常数 $C_0$：
    $C_0 \cdot (-1)(-1-1) = 2C_0 = 1 \implies C_0 = \frac{1}{2}$
    所以，$\ell_0(x) = \frac{1}{2}x(x-1) = \frac{1}{2}(x^2 - x)$。

*   **构建 $\ell_1(x)$ (对应节点 $x_1 = 0$)**:
    该函数需满足 $\ell_1(-1)=0$, $\ell_1(0)=1$, $\ell_1(1)=0$。根位于 $x=-1$ 和 $x=1$，因此 $\ell_1(x) = C_1(x+1)(x-1) = C_1(x^2-1)$。利用 $\ell_1(0)=1$：
    $C_1(0^2-1) = -C_1 = 1 \implies C_1 = -1$
    所以，$\ell_1(x) = -(x^2-1) = 1-x^2$。

*   **构建 $\ell_2(x)$ (对应节点 $x_2 = 1$)**:
    该函数需满足 $\ell_2(-1)=0$, $\ell_2(0)=0$, $\ell_2(1)=1$。根位于 $x=-1$ 和 $x=0$，因此 $\ell_2(x) = C_2 \cdot x(x+1)$。利用 $\ell_2(1)=1$：
    $C_2 \cdot (1)(1+1) = 2C_2 = 1 \implies C_2 = \frac{1}{2}$
    所以，$\ell_2(x) = \frac{1}{2}x(x+1) = \frac{1}{2}(x^2 + x)$。

综上，对应于节点 $\{-1, 0, 1\}$ 的二次[拉格朗日基](@entry_id:751105)函数为 [@problem_id:3359431]：
$\begin{pmatrix} \frac{1}{2}(x^2 - x)  1 - x^2  \frac{1}{2}(x^2 + x) \end{pmatrix}$

#### 构建[三次基函数](@entry_id:748106)

同样的方法可以用于构建更高次的[基函数](@entry_id:170178)。对于 $P_3$ 空间，我们需要 4 个节点。一组标准的[等距节点](@entry_id:168260)是 $\{-1, -1/3, 1/3, 1\}$ [@problem_id:3359485]。构建[基函数](@entry_id:170178) $\ell_i(x)$ 的一般公式是：
$\ell_i(x) = \prod_{j=0, j \neq i}^{k} \frac{x - \xi_j}{\xi_i - \xi_j}$

例如，对于节点 $\xi_0 = -1$ 的[基函数](@entry_id:170178) $\ell_0(x)$：
$\ell_0(x) = \frac{(x - (-1/3))(x - 1/3)(x - 1)}{(-1 - (-1/3))(-1 - 1/3)(-1 - 1)} = \frac{(x+1/3)(x-1/3)(x-1)}{(-2/3)(-4/3)(-2)} = -\frac{9}{16}(x^2 - \frac{1}{9})(x-1)$
展开后得到 $\ell_0(x) = -\frac{9}{16}x^3 + \frac{9}{16}x^2 + \frac{1}{16}x - \frac{1}{16}$。

由于节点集关于[原点对称](@entry_id:172995)，[基函数](@entry_id:170178)也具有对称性。具体而言，$\ell_{k-i}(x) = \ell_i(-x)$。利用此性质，我们可以从 $\ell_0(x)$ 和 $\ell_1(x)$ 轻松得到 $\ell_3(x)$ 和 $\ell_2(x)$。最终，这四个[基函数](@entry_id:170178)为 [@problem_id:3359485]：
$\begin{pmatrix} -\frac{9}{16}x^3 + \frac{9}{16}x^2 + \frac{1}{16}x - \frac{1}{16}  \frac{27}{16}x^3 - \frac{9}{16}x^2 - \frac{27}{16}x + \frac{9}{16}  -\frac{27}{16}x^3 - \frac{9}{16}x^2 + \frac{27}{16}x + \frac{9}{16}  \frac{9}{16}x^3 + \frac{9}{16}x^2 - \frac{1}{16}x - \frac{1}{16} \end{pmatrix}$

#### 为保证全局连续性而选择节点

在将求解域剖分成多个单元后，我们希望构造的全局近似函数是连续的（即 $C^0$ 连续）。为了实现这一点，相邻单元在共享的边界上必须具有相同的函数值。对于拉格朗日单元，这意味着必须将单元的**端点**包含在节点集之中。当两个相邻单元共享一个端点时，它们也共享该点的自由度（即函数值）。在[全局组装](@entry_id:749916)过程中，这个共享的自由度确保了函数在单元边界处的连续性。

如果一个单元的所有节点都选在单元内部（开区间内），那么在单元边界上就没有任何约束，组装起来的全局函数通常是不连续的。因此，标准的一维拉格朗日 $P_2$ 单元的[节点选择](@entry_id:637104)是两个端点和一个内部点（通常是中点），而 $P_3$ 单元则选择两个端点和两个内部点（通常是三等分点）[@problem_id:3359426]。

### 从[参考单元](@entry_id:168425)到物理单元：[等参变换](@entry_id:750863)

在[参考单元](@entry_id:168425)上构建[基函数](@entry_id:170178)非常方便，但实际计算需要在各种大小和位置的**物理单元 (physical elements)** 上进行。**等参 (isoparametric) 映射**概念建立了从参考单元到物理单元的桥梁。

#### [仿射映射](@entry_id:746332)

对于一维问题，最常用的映射是**[仿射映射](@entry_id:746332) (affine mapping)**。它将参考单元 $\hat{K} = [-1, 1]$（坐标为 $\hat{x}$）线性地映射到物理单元 $K = [x_L, x_R]$（坐标为 $x$）。该映射可写为：

$x = F(\hat{x}) = a + b\hat{x}$

映射的两个常数 $a$ 和 $b$ 由端点对应关系确定：$F(-1) = x_L$ 和 $F(1) = x_R$。这给出了一个[线性方程组](@entry_id:148943)：

$a - b = x_L$
$a + b = x_R$

解这个[方程组](@entry_id:193238)，我们得到：

$b = \frac{x_R - x_L}{2} = \frac{h}{2}$
$a = \frac{x_L + x_R}{2}$

其中 $h = x_R - x_L$ 是物理单元的长度。因此，缩放参数 $b$ 恰好是单元长度的一半 [@problem_id:3359455]。

#### 导数的变换（雅可比行列式）

在有限元方法中，我们经常需要计算[基函数](@entry_id:170178)的导数（例如，为了计算[刚度矩阵](@entry_id:178659)）。当[基函数](@entry_id:170178) $\hat{\phi}(\hat{x})$ 定义在[参考单元](@entry_id:168425)上时，其在物理单元上的对应函数为 $\phi(x) = \hat{\phi}(\hat{x}(x))$。我们需要利用[链式法则](@entry_id:190743)来计算其导数：

$\frac{d\phi}{dx} = \frac{d\hat{\phi}}{d\hat{x}} \frac{d\hat{x}}{dx}$

这里的 $\frac{d\hat{x}}{dx}$ 是逆映射 $\hat{x}(x)$ 的导数，也称为变换的**[雅可比](@entry_id:264467) (Jacobian)** 的逆。从前述[仿射映射](@entry_id:746332) $x(\hat{x})$，我们可以求得逆映射 $\hat{x}(x)$：

$\hat{x}(x) = \frac{x-a}{b} = \frac{x - (x_L+x_R)/2}{(x_R-x_L)/2} = \frac{2}{x_R-x_L}x - \frac{x_L+x_R}{x_R-x_L}$

对 $x$ 求导，我们得到一个常数：

$\frac{d\hat{x}}{dx} = \frac{2}{x_R - x_L} = \frac{2}{h}$

因此，导数的变换关系为 $\frac{d\phi}{dx} = \frac{2}{h} \frac{d\hat{\phi}}{d\hat{x}}$ [@problem_id:3359415]。

#### 克罗内克性质的不变性

一个重要的性质是，[拉格朗日基](@entry_id:751105)函数的克罗内克插值属性在从参考单元到物理单元的映射下是保持不变的。如果 $\hat{\ell}_i(\hat{x}_j) = \delta_{ij}$ 在参考单元的节点 $\hat{x}_j$ 上成立，那么在物理单元的节点 $x_j = F(\hat{x}_j)$ 上，对应的物理[基函数](@entry_id:170178) $\ell_i(x) = \hat{\ell}_i(F^{-1}(x))$ 同样满足：

$\ell_i(x_j) = \hat{\ell}_i(F^{-1}(x_j)) = \hat{\ell}_i(\hat{x}_j) = \delta_{ij}$

这个性质的成立不要求映射必须是仿射的，只要是双射即可。它保证了我们在物理单元上仍然可以用节点值来方便地表示函数 [@problem_id:3359468]。

#### 范数的标度变换

当从[参考单元](@entry_id:168425)变换到物理单元时，[函数的范数](@entry_id:275551)会发生变化，其变化规律与单元尺寸 $h$ 相关。这对于[有限元误差分析](@entry_id:749282)至关重要。

对于 $L^2$ 范数，通过变量代换 $dx = \frac{dx}{d\hat{x}}d\hat{x} = \frac{h}{2}d\hat{x}$ (对于 $\hat{K}=[-1,1]$) 或 $dx=hd\xi$ (对于 $\hat{K}=[0,1]$)，我们有：

$\|u_h\|_{L^2(K)}^2 = \int_{K} |u_h(x)|^2 dx = \int_{\hat{K}} |\hat{u}(\hat{x})|^2 (\text{det } J) d\hat{x} \propto h \|\hat{u}\|_{L^2(\hat{K})}^2$

对于 $H^1$ [半范数](@entry_id:264573)，它涉及到导数：

$|u_h|_{H^1(K)}^2 = \int_{K} |\frac{du_h}{dx}|^2 dx = \int_{\hat{K}} |\frac{1}{J}\frac{d\hat{u}}{d\hat{x}}|^2 (\text{det } J) d\hat{x} = \int_{\hat{K}} \frac{1}{(\text{det } J)} |\frac{d\hat{u}}{d\hat{x}}|^2 d\hat{x} \propto \frac{1}{h} |\hat{u}|_{H^1(\hat{K})}^2$

综合起来，$H^1$ 范数的平方的变换规律是：

$\|u_h\|_{H^1(K)}^2 = \|u_h\|_{L^2(K)}^2 + |u_h|_{H^1(K)}^2 \propto h \|\hat{u}\|_{L^2(\hat{K})}^2 + \frac{1}{h} |\hat{u}|_{H^1(\hat{K})}^2$

这些标度关系不依赖于多项式的具体次数（无论是 $P_2$ 还是 $P_3$），也不依赖于[基函数](@entry_id:170178)的具体选择（如拉格朗日节点的具体位置），只要映射是仿射的 [@problem_id:3359462]。

### 应用与高级概念

[基函数](@entry_id:170178)的选择直接影响有限元方法的实现细节和[适用范围](@entry_id:636189)。

#### 强制施加狄利克雷边界条件

[拉格朗日基](@entry_id:751105)函数的克罗内克性质使得**强制 (strong) 施加**狄利克雷 (Dirichlet) 边界条件变得异常简单。如果一个边界点 $x_b$ 是[有限元网格](@entry_id:174862)的一个节点，并且在该点有边界条件 $u(x_b) = \alpha$，那么我们近似解 $u_h(x) = \sum_j u_j \ell_j(x)$ 在该点的值就是 $u_h(x_b) = u_b$。因此，施加边界条件就等同于直接将该节点对应的自由度（未知数）$u_b$ 的值设为 $\alpha$。在最终的全局[线性系统](@entry_id:147850)中，这通常通过修改矩阵的对应行和右端项来实现 [@problem_id:3359468]。

#### 超越节点值：[埃尔米特基函数](@entry_id:167915)

对于需要解的函数具有更高光滑度要求的问题（例如，需要 $C^1$ 连续性的[四阶偏微分方程](@entry_id:176247)），仅使用节点值的[拉格朗日元](@entry_id:168612)是不够的。**埃尔米特 (Hermite) [基函数](@entry_id:170178)**应运而生。它们不仅在节点上[插值函数](@entry_id:262791)值，还插值导数值。

一个经典的三次埃尔米特单元在参考区间 $[-1, 1]$ 的两个端点上定义了 4 个自由度：$u(-1)$, $u'(-1)$, $u(1)$, $u'(1)$。对应的四个[三次基函数](@entry_id:748106) $h_1, h_2, h_3, h_4$ 满足广义的克罗内克性质，例如，$h_1(x)$ 对应于 $u(-1)$，它必须满足 $h_1(-1)=1$，并且在其他三个自由度上为零，即 $h_1'(-1)=0, h_1(1)=0, h_1'(1)=0$。通过求解这些条件，可以得到四个[基函数](@entry_id:170178) [@problem_id:3359452]：

$\begin{pmatrix} \frac{1}{4}x^3 - \frac{3}{4}x + \frac{1}{2}  \frac{1}{4}x^3 - \frac{1}{4}x^2 - \frac{1}{4}x + \frac{1}{4}  -\frac{1}{4}x^3 + \frac{3}{4}x + \frac{1}{2}  \frac{1}{4}x^3 + \frac{1}{4}x^2 - \frac{1}{4}x - \frac{1}{4} \end{pmatrix}$

当使用[埃尔米特元](@entry_id:750232)施加[狄利克雷边界条件](@entry_id:173524) $u(x_b)=\alpha$ 时，我们只固定与函数值相关的自由度，而与导数相关的自由度通常保持未知，除非边界条件中也包含对导数的约束 [@problem_id:3359468]。

#### 超越[节点基](@entry_id:752522)：[模态基](@entry_id:752055)函数

拉格朗日和[埃尔米特基函数](@entry_id:167915)都是**节点 (nodal) [基函数](@entry_id:170178)**，其自由度与空间中的特定点相关联。另一种重要的选择是**模态 (modal) [基函数](@entry_id:170178)**，其自由度是函数展开到一组预定义的多项式（“模态”）上的系数。

一个特别强大和常用的[模态基](@entry_id:752055)是基于**勒让德 (Legendre) 多项式** $\{P_0, P_1, P_2, \dots\}$。勒让德多项式在区间 $[-1, 1]$ 上关于标准的 $L^2$ [内积](@entry_id:158127)是**正交的**：

$\langle P_m, P_n \rangle = \int_{-1}^{1} P_m(x) P_n(x) dx = \frac{2}{2n+1} \delta_{mn}$

使用[勒让德多项式](@entry_id:141510) $\{P_0, P_1, P_2, P_3\}$ 作为 $P_3$ 空间的一组基，会带来一个巨大的计算优势：**质量矩阵是对角的**。质量矩阵的元素为 $M_{ij} = \langle P_i, P_j \rangle$，由于正交性，所有非对角元素均为零。这在许多数值方法（如谱方法和间断[伽辽金法](@entry_id:749698)）中大大简化了计算。

这组[正交基](@entry_id:264024)可以通过对单项式基 $\{1, x, x^2, x^3\}$ 应用格拉姆-施密特 (Gram-Schmidt) 正交化过程得到（在相差一个常数倍数的意义下）[@problem_id:3359494]。通过适当的归一化，例如令 $\phi_n(x) = \sqrt{\frac{2n+1}{2}} P_n(x)$，可以得到一组**[标准正交基](@entry_id:147779)**，其[质量矩阵](@entry_id:177093)为[单位矩阵](@entry_id:156724)。

值得注意的是，在[仿射映射](@entry_id:746332)下，正交性得以保持（仅相差一个雅可比常数因子），因此在物理单元上的[质量矩阵](@entry_id:177093)也保持对角性。然而，刚度矩阵（涉及[基函数](@entry_id:170178)导数的积分）在使用勒让德基时通常不是对角的，因为勒让德多项式的导数集并不构成一个[正交系](@entry_id:184795) [@problem_id:3359494]。