{"hands_on_practices": [{"introduction": "应用里兹方法的第一步是牢固掌握能量泛函。第一个练习为此提供了一个具体的起点，要求您使用单个试探函数来计算一个简单一维问题的总势能。通过明确计算泛函的两个组成部分，您将对内应变能和外力功势能这两个概念建立起直接的物理直觉，而物理系统正是通过平衡这两个基本量来达到稳定状态的。[@problem_id:3384633]", "problem": "考虑在开区间 $\\Omega=(0,1)$ 上的带齐次狄利克雷边界条件的一维二阶线性椭圆偏微分方程（PDE）：\n$$-(a(x) u^{\\prime}(x))^{\\prime}=f(x),\\qquad u(0)=0,\\quad u(1)=0,$$\n其中 $a(x)$ 是一个严格为正的系数，$f(x)$ 是一个给定的源项。能量最小化原理指出，其解可被描述为在索博列夫空间 $H^{1}_{0}(\\Omega)$ 上某个适当的能量泛函的最小化子。\n\n使用能量最小化框架和 Ritz 方法，对具体数据 $a(x)=1$ 和 $f(x)=x$ 执行以下操作：\n1. 从 PDE 的强形式和驻定势能原理出发，写出与给定 PDE 和数据相对应的、需要在 $v\\in H^{1}_{0}(\\Omega)$ 上最小化的能量泛函 $J(v)$，确保与边界条件一致。\n2. 使用满足 $u(0)=u(1)=0$ 的单函数试探解 $u(x)=x(1-x)$，通过以闭合形式计算所有必需的积分，精确地求出 $J(u)$ 的值。\n3. 简要解释 $J(u)$ 中的两个贡献项在其底层变分结构中所对应的储存内能和外部功输入的物理意义。\n\n将 $J(u)$ 的最终值表示为一个精确数，无需四舍五入。", "solution": "该问题要求将能量最小化原理和 Ritz 方法应用于一个特定的一维边值问题。我们首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **PDE:** $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$\n- **定义域:** $\\Omega=(0,1)$\n- **边界条件:** $u(0)=0, u(1)=0$ (齐次狄利克雷)\n- **系数:** $a(x)$ 是一个严格正函数。\n- **源项:** $f(x)$ 是一个给定的源函数。\n- **函数空间:** 解位于索博列夫空间 $H^{1}_{0}(\\Omega)$ 中。\n- **具体数据:** $a(x)=1$ 且 $f(x)=x$。\n- **试函数:** $u(x)=x(1-x)$。\n- **任务:** 1. 推导能量泛函 $J(v)$。 2. 对给定的试函数计算 $J(u)$。 3. 解释 $J(u)$ 中各项的物理意义。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它描述了求解一维泊松方程的标准变分或能量最小化方法，这是数值偏微分方程理论和计算力学的基石。所提供的数据（$a(x)=1$, $f(x)=x$）是良定义的。指定的函数空间 $H^{1}_{0}(\\Omega)$ 是该问题的正确设定。试函数满足所需的边界条件。该问题是自洽的、无歧义的且适定的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n该问题是有效的。我们继续进行求解。\n\n### 第 1 部分：能量泛函的推导\n\n驻定势能原理指出，边值问题的解 $u(x)$ 是在容许函数空间上使总能量泛函 $J(v)$ 最小化的函数。一个容许函数 $v(x)$ 必须足够光滑并满足本质边界条件，在此情况下即为 $v(0)=0$ 和 $v(1)=0$。合适的函数空间是 $H^{1}_{0}(\\Omega)$，即一阶导数平方可积且在边界上为零的函数空间。\n\n为了找到其最小化子满足 PDE 强形式 $-(a(x) u^{\\prime}(x))^{\\prime}=f(x)$ 的泛函 $J(v)$，我们首先推导其弱形式。我们将 PDE 乘以一个任意的检验函数 $v \\in H^{1}_{0}(\\Omega)$，并在定义域 $\\Omega=(0,1)$ 上积分：\n$$ -\\int_{0}^{1} (a(x) u^{\\prime}(x))^{\\prime} v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx $$\n对左侧应用分部积分法，我们得到：\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx - \\left[ a(x) u^{\\prime}(x) v(x) \\right]_{0}^{1} = \\int_{0}^{1} f(x) v(x) \\,dx $$\n由于 $v \\in H^{1}_{0}(\\Omega)$，我们有 $v(0)=0$ 和 $v(1)=0$。因此，边界项消失，从而得到弱形式：求 $u \\in H^{1}_{0}(\\Omega)$ 使得\n$$ \\int_{0}^{1} a(x) u^{\\prime}(x) v^{\\prime}(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx \\quad \\forall v \\in H^{1}_{0}(\\Omega) $$\n此方程是能量泛函 $J(v)$ 的欧拉-拉格朗日方程，其定义为：\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} a(x) (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} f(x) v(x) \\,dx $$\n对于给定的具体数据 $a(x)=1$ 和 $f(x)=x$，需要最小化的泛函是：\n$$ J(v) = \\frac{1}{2} \\int_{0}^{1} (v^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x v(x) \\,dx $$\n\n### 第 2 部分：对试函数的能量泛函求值\n\nRitz 方法通过在 $H^{1}_{0}(\\Omega)$ 的一个有限维子空间上最小化泛函 $J(v)$ 来寻求近似解。在本例中，我们使用试函数 $u(x) = x(1-x)$（也可写作 $u(x) = x - x^{2}$）进行单函数近似。我们首先确认它是一个容许函数：$u(0)=0(1-0)=0$ 且 $u(1)=1(1-1)=0$，因此它满足所需的边界条件。\n\n接下来，我们计算试函数的导数：\n$$ u^{\\prime}(x) = \\frac{d}{dx}(x - x^{2}) = 1 - 2x $$\n现在我们计算 $J(u)$ 表达式中的两个积分。\n\n第一个积分是：\n$$ \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx = \\int_{0}^{1} (1-2x)^{2} \\,dx = \\int_{0}^{1} (1 - 4x + 4x^{2}) \\,dx $$\n$$ = \\left[ x - 4\\frac{x^{2}}{2} + 4\\frac{x^{3}}{3} \\right]_{0}^{1} = \\left[ x - 2x^{2} + \\frac{4}{3}x^{3} \\right]_{0}^{1} $$\n$$ = \\left( 1 - 2(1)^{2} + \\frac{4}{3}(1)^{3} \\right) - (0) = 1 - 2 + \\frac{4}{3} = -1 + \\frac{4}{3} = \\frac{1}{3} $$\n\n第二个积分是：\n$$ \\int_{0}^{1} x u(x) \\,dx = \\int_{0}^{1} x(x - x^{2}) \\,dx = \\int_{0}^{1} (x^{2} - x^{3}) \\,dx $$\n$$ = \\left[ \\frac{x^{3}}{3} - \\frac{x^{4}}{4} \\right]_{0}^{1} = \\left( \\frac{1^{3}}{3} - \\frac{1^{4}}{4} \\right) - (0) = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12} $$\n\n最后，我们将这些结果代入 $J(u)$ 的表达式中：\n$$ J(u) = \\frac{1}{2} \\int_{0}^{1} (u^{\\prime}(x))^{2} \\,dx - \\int_{0}^{1} x u(x) \\,dx $$\n$$ J(u) = \\frac{1}{2} \\left( \\frac{1}{3} \\right) - \\left( \\frac{1}{12} \\right) = \\frac{1}{6} - \\frac{1}{12} = \\frac{2}{12} - \\frac{1}{12} = \\frac{1}{12} $$\n\n### 第 3 部分：各项贡献的解释\n\n能量泛函 $J(u)$ 代表了由该 PDE 描述的物理系统的总势能。它由两个具有不同物理解释的项组成。\n\n1.  **内能：** 第一项 $\\frac{1}{2} \\int_{0}^{1} a(x) (u^{\\prime}(x))^{2} \\,dx$ 代表了系统因形变而储存的内部应变能。在力学背景下（例如，拉伸的弦或弯曲的梁），$u^{\\prime}(x)$ 是应变，$a(x)$ 与材料的刚度有关。被积函数是应变能密度，其在定义域上的积分给出了总储存内能。对于我们的试函数，该值为 $\\frac{1}{2} \\times \\frac{1}{3} = \\frac{1}{6}$。\n\n2.  **外力功势：** 第二项 $-\\int_{0}^{1} f(x) u(x) \\,dx$ 代表了外载荷的势能。积分 $\\int_{0}^{1} f(x) u(x) \\,dx$ 是分布外力 $f(x)$ 在位移 $u(x)$ 上所做的功。保守外力场的势是其所做功的负值。对于我们的试函数，外载荷所做的功是 $\\frac{1}{12}$，所以外力功势是 $-\\frac{1}{12}$。\n\n系统通过采用一种使总势能 $J(u) = (\\text{内能}) - (\\text{外力所做的功})$ 最小化的构型 $u(x)$ 来寻求稳定平衡。值 $J(u) = \\frac{1}{12}$ 是系统在近似位移场 $u(x)=x(1-x)$ 下的总势能。", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "3384633"}, {"introduction": "当我们使用多个基函数的线性组合来逼近解时，里兹方法的真正威力才得以展现，这也构成了有限元方法的基础。本练习将引导您完成这一关键过程，将连续的能量泛函离散化为一个线性代数方程组 $A\\mathbf{c} = \\mathbf{b}$。您将使用分段线性的“帽子”函数——这是许多实用有限元程序的核心——从基本定义出发，组装刚度矩阵和载荷向量。[@problem_id:3384616]", "problem": "考虑在开区间 $\\Omega=(0,1)$ 上具有齐次狄利克雷边界条件的一维泊松方程的边值问题。其相关的能量泛函为\n$$\n\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx,\n$$\n其中 $a=1$ 且 $f(x)=1$。Ritz方法旨在寻求一个 $u_{h}\\in V_{h}\\subset H_{0}^{1}(0,1)$，它在有限维子空间 $V_{h}$ 上最小化 $\\mathcal{J}(u)$。\n\n将区域由节点 $x_{0}=0$，$x_{1}=\\frac{1}{3}$，$x_{2}=\\frac{2}{3}$，$x_{3}=1$ 均匀剖分为3个子区间。设 $\\phi_{1}$ 和 $\\phi_{2}$ 分别是与节点 $x_{1}$ 和 $x_{2}$ 相关联的节点帽函数，使得对于 $i,j\\in\\{1,2\\}$ 有 $\\phi_{i}(x_{j})=\\delta_{ij}$，且 $\\phi_{i}(0)=\\phi_{i}(1)=0$。定义试探空间 $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$ 和 Ritz 拟设 $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$，其中 $c_{1}$ 和 $c_{2}$ 是未知系数。\n\n从能量泛函 $\\mathcal{J}(u)$ 和 $V_{h}$ 的定义出发，通过强制 $\\mathcal{J}$ 限制在 $V_{h}$ 上沿 $\\phi_{1}$ 和 $\\phi_{2}$ 方向的一阶变分为零，来推导关于 $(c_{1},c_{2})$ 的离散代数系统。通过使用 $\\phi_{1}$ 和 $\\phi_{2}$ 的分段定义计算必要的积分，显式地组装所得到的刚度矩阵和载荷向量。然后求解该系统得到 $(c_{1},c_{2})$，并将系数向量以行矩阵的形式报告。请用精确形式表示你的最终答案，无需四舍五入。", "solution": "对问题陈述进行有效性评估。\n\n### 步骤 1：提取已知条件\n- **控制方程**：在开区间 $\\Omega=(0,1)$ 上的一维泊松方程。\n- **边界条件**：齐次狄利克雷边界条件，$u(0)=0$ 且 $u(1)=0$。\n- **能量泛函**：$\\mathcal{J}(u)=\\frac{1}{2}\\int_{0}^{1} a\\,|u'(x)|^{2}\\,dx-\\int_{0}^{1} f(x)\\,u(x)\\,dx$。\n- **常数**：$a=1$，$f(x)=1$。\n- **方法**：Ritz 方法。\n- **区域剖分**：由节点 $x_{0}=0$，$x_{1}=\\frac{1}{3}$，$x_{2}=\\frac{2}{3}$，$x_{3}=1$ 将区域均匀剖分为 3 个子区间。子区间长度为 $h=\\frac{1}{3}$。\n- **试探空间**：$V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$，其中 $\\phi_{1}$ 和 $\\phi_{2}$ 分别是与内部节点 $x_{1}$ 和 $x_{2}$ 相关联的节点帽函数。这些基函数满足对于 $i,j\\in\\{1,2\\}$ 有 $\\phi_{i}(x_{j})=\\delta_{ij}$，且 $\\phi_{i}(0)=\\phi_{i}(1)=0$。\n- **Ritz 拟设**：近似解为 $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$。\n- **任务**：推导并求解关于系数向量 $(c_{1},c_{2})$ 的离散代数系统。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了将 Ritz 方法（有限元方法的一种特定形式）应用于一个经典边值问题（一维泊松方程）。能量泛函、基函数的选择（分段线性“帽”函数）以及整体流程都是偏微分方程数值分析领域的标准和基本概念。该设置与已建立的数学理论完全一致。\n2.  **适定性**：该问题是适定的。将 Ritz-Galerkin 方法应用于此椭圆边值问题，保证能得到唯一解，因为与算子相关的双线性形式在 Sobolev 空间 $H_{0}^{1}(0,1)$ 上是强制且连续的，这确保了所得到的刚度矩阵是对称正定的，因而是可逆的。\n3.  **客观性**：问题以精确、无歧义的数学语言陈述。所有术语在上下文中都是标准的且良定义的。\n4.  **完整性**：所有必要的信息（泛函、区域、剖分、基函数和常数）都已提供。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它在数学上是合理的、适定的并且是完全指定的。将推导求解。\n\nRitz 方法旨在寻求一个函数 $u_{h} \\in V_{h}$，以最小化能量泛函 $\\mathcal{J}(u)$。给定拟设 $u_{h}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$，泛函变为系数 $c_{1}$ 和 $c_{2}$ 的函数：\n$$\n\\mathcal{J}(c_{1}, c_{2}) = \\frac{1}{2}\\int_{0}^{1} a \\left| c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right|^{2} dx - \\int_{0}^{1} f(x) \\left( c_{1}\\phi_{1}(x) + c_{2}\\phi_{2}(x) \\right) dx.\n$$\n这个二次函数的最小值可以通过将其关于 $c_{1}$ 和 $c_{2}$ 的偏导数设为零来找到：\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{1}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{1}'(x) dx - \\int_{0}^{1} f(x) \\phi_{1}(x) dx = 0\n$$\n$$\n\\frac{\\partial \\mathcal{J}}{\\partial c_{2}} = \\int_{0}^{1} a \\left( c_{1}\\phi_{1}'(x) + c_{2}\\phi_{2}'(x) \\right) \\phi_{2}'(x) dx - \\int_{0}^{1} f(x) \\phi_{2}(x) dx = 0\n$$\n这可以写成一个线性系统 $A\\mathbf{c} = \\mathbf{b}$，其中 $\\mathbf{c} = \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix}$，刚度矩阵 $A$ 的元素为 $A_{ij} = \\int_{0}^{1} a \\phi_{j}'(x)\\phi_{i}'(x) dx$，载荷向量 $\\mathbf{b}$ 的元素为 $b_{i} = \\int_{0}^{1} f(x) \\phi_{i}(x) dx$。\n\n首先，我们定义基函数及其导数。网格间距为 $h = x_{1}-x_{0} = \\frac{1}{3}$。\n与节点 $x_{1}=\\frac{1}{3}$ 相关联的帽函数 $\\phi_{1}(x)$ 是：\n$$\n\\phi_{1}(x) = \\begin{cases} \\frac{x-x_{0}}{x_{1}-x_{0}} = \\frac{x}{1/3} = 3x & x \\in [0, 1/3] \\\\ \\frac{x_{2}-x}{x_{2}-x_{1}} = \\frac{2/3-x}{1/3} = 2 - 3x & x \\in [1/3, 2/3] \\\\ 0 & \\text{其它情况} \\end{cases}\n$$\n其导数为：\n$$\n\\phi_{1}'(x) = \\begin{cases} 3 & x \\in (0, 1/3) \\\\ -3 & x \\in (1/3, 2/3) \\\\ 0 & \\text{其它情况} \\end{cases}\n$$\n与节点 $x_{2}=\\frac{2}{3}$ 相关联的帽函数 $\\phi_{2}(x)$ 是：\n$$\n\\phi_{2}(x) = \\begin{cases} \\frac{x-x_{1}}{x_{2}-x_{1}} = \\frac{x-1/3}{1/3} = 3x - 1 & x \\in [1/3, 2/3] \\\\ \\frac{x_{3}-x}{x_{3}-x_{2}} = \\frac{1-x}{1/3} = 3 - 3x & x \\in [2/3, 1] \\\\ 0 & \\text{其它情况} \\end{cases}\n$$\n其导数为：\n$$\n\\phi_{2}'(x) = \\begin{cases} 3 & x \\in (1/3, 2/3) \\\\ -3 & x \\in (2/3, 1) \\\\ 0 & \\text{其它情况} \\end{cases}\n$$\n现在，我们计算当 $a=1$ 时刚度矩阵 $A$ 的元素：\n$$\nA_{11} = \\int_{0}^{1} |\\phi_{1}'(x)|^{2} dx = \\int_{0}^{1/3} (3)^{2} dx + \\int_{1/3}^{2/3} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.\n$$\n$$\nA_{22} = \\int_{0}^{1} |\\phi_{2}'(x)|^{2} dx = \\int_{1/3}^{2/3} (3)^{2} dx + \\int_{2/3}^{1} (-3)^{2} dx = 9 \\cdot \\frac{1}{3} + 9 \\cdot \\frac{1}{3} = 3+3 = 6.\n$$\n根据对称性，非对角项是相同的，$A_{12}=A_{21}$。乘积 $\\phi_{1}'(x)\\phi_{2}'(x)$ 仅在区间 $(1/3, 2/3)$ 上非零：\n$$\nA_{12} = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}'(x) dx = \\int_{1/3}^{2/3} (-3)(3) dx = \\int_{1/3}^{2/3} -9 dx = -9 \\cdot \\frac{1}{3} = -3.\n$$\n因此，刚度矩阵为 $A = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix}$。\n\n接下来，我们计算当 $f(x)=1$ 时载荷向量 $\\mathbf{b}$ 的元素：\n$b_{i} = \\int_{0}^{1} \\phi_{i}(x) dx$。这个积分是三角形帽函数的面积，即 $\\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times (2h) \\times 1 = h = \\frac{1}{3}$。我们通过对 $b_1$ 直接积分来验证这一点：\n$$\nb_{1} = \\int_{0}^{1} \\phi_{1}(x) dx = \\int_{0}^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^{2}}{2}\\right]_{0}^{1/3} + \\left[2x-\\frac{3x^{2}}{2}\\right]_{1/3}^{2/3}\n$$\n$$\nb_1 = \\left(\\frac{3}{2}\\frac{1}{9}\\right) + \\left( \\left(\\frac{4}{3}-\\frac{3}{2}\\frac{4}{9}\\right) - \\left(\\frac{2}{3}-\\frac{3}{2}\\frac{1}{9}\\right) \\right) = \\frac{1}{6} + \\left( \\left(\\frac{4}{3}-\\frac{2}{3}\\right) - \\left(\\frac{2}{3}-\\frac{1}{6}\\right) \\right) = \\frac{1}{6} + \\left( \\frac{2}{3} - \\frac{3}{6} \\right) = \\frac{1}{6} + \\frac{1}{6} = \\frac{2}{6} = \\frac{1}{3}.\n$$\n根据区域和基函数的对称性，$b_{2} = \\int_{0}^{1} \\phi_{2}(x) dx = \\frac{1}{3}$。\n因此，载荷向量为 $\\mathbf{b} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}$。\n\n我们现在求解线性系统 $A\\mathbf{c}=\\mathbf{b}$：\n$$\n\\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} \\begin{pmatrix} c_{1} \\\\ c_{2} \\end{pmatrix} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix}\n$$\n这对应于方程组：\n$1) \\quad 6c_{1} - 3c_{2} = \\frac{1}{3}$\n$2) \\quad -3c_{1} + 6c_{2} = \\frac{1}{3}$\n通过观察，问题的对称性表明 $c_{1}=c_{2}$。将 $c_{1}=c_{2}=c$ 代入第一个方程：\n$6c - 3c = \\frac{1}{3} \\implies 3c = \\frac{1}{3} \\implies c = \\frac{1}{9}$。\n因此，$c_{1} = \\frac{1}{9}$ 且 $c_{2} = \\frac{1}{9}$。\n或者，使用矩阵求逆：\n$\\det(A) = (6)(6) - (-3)(-3) = 36-9=27$。\n$A^{-1} = \\frac{1}{27}\\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix}$。\n$$\n\\mathbf{c} = A^{-1}\\mathbf{b} = \\frac{1}{27}\\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix} \\begin{pmatrix} 1/3 \\\\ 1/3 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 6(1/3)+3(1/3) \\\\ 3(1/3)+6(1/3) \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 2+1 \\\\ 1+2 \\end{pmatrix} = \\frac{1}{27}\\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1/9 \\\\ 1/9 \\end{pmatrix}.\n$$\n系数向量为 $(c_{1}, c_{2}) = (1/9, 1/9)$。问题要求将其以行矩阵的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{1}{9} & \\frac{1}{9} \\end{pmatrix}\n}\n$$", "id": "3384616"}, {"introduction": "一个稳健的数值方法不仅要求能得到解，更要求我们理解解的质量和系统的稳定性。这个高级练习将我们的焦点从计算转向分析，深入探究前一个练习中生成的刚度矩阵的性质。通过推导条件数的精确表达式，您将研究数值稳定性如何与网格细化相关联，从而揭示一个支配有限元方法性能的基本原则。[@problem_id:3384581]", "problem": "考虑单位区间上具有齐次狄利克雷边界条件的一维线性椭圆边值问题的能量泛函，\n$$\nJ(u)=\\tfrac{1}{2}\\int_{0}^{1} \\big(u'(x)\\big)^{2}\\,dx - \\int_{0}^{1} f(x)\\,u(x)\\,dx,\n$$\n该泛函定义在索博列夫空间 $H_{0}^{1}(0,1)$ 上。设 $V_{h}\\subset H_{0}^{1}(0,1)$ 是一个协调有限维子空间，由定义在均匀剖分 $\\{x_{i}=ih\\}_{i=0}^{n}$ (其中 $h=1/n$ 且 $u(0)=u(1)=0$) 上的连续分片线性函数构成。用 $\\{\\phi_{i}\\}_{i=1}^{n-1}$ 表示 $V_{h}$ 的常规节点帽函数基。里兹法旨在寻找 $u_{h}\\in V_{h}$ 以在 $V_{h}$ 上最小化 $J$，这导出了对称正定线性系统 $A\\mathbf{u}=\\mathbf{b}$，其元素为 $A_{ij}=\\int_{0}^{1}\\phi_{i}'(x)\\phi_{j}'(x)\\,dx$。\n\n从第一性原理出发，除了三角函数的标准性质和欧几里得诱导的2-范数下的条件数定义外，不假设任何特殊公式，完成以下任务：\n\n1. 通过计算积分 $\\int_{0}^{1}\\phi_{i}'(x)\\phi_{j}'(x)\\,dx$，推导在此设定下刚度矩阵 $A$ 以网格尺寸 $h$ 表示的精确形式。\n\n2. 明确地刻画 $A$ 的所有特征对，并由此获得 $2$-范数条件数 $\\kappa_{2}(A)$ 作为 $n$ 和 $h$ 的函数的精确闭式表达式。\n\n3. 使用你的精确表达式，确定在渐近关系 $\\kappa_{2}(A)\\sim C\\,h^{-2}$ (当 $h\\to 0^{+}$ 时) 中的领阶系数 $C$，并将其表示为一个与 $h$ 无关的单一闭式解析常数。\n\n你的最终答案必须是精确常数 $C$ 的一个闭式解析表达式（无需数值舍入，也不涉及单位）。", "solution": "该问题被验证为有科学依据、适定且客观的。它是偏微分方程数值分析中的一个标准问题，并包含了求得唯一解所需的所有信息。\n\n解答按照题目要求分为三个部分呈现。\n\n### 第一部分：刚度矩阵 $A$ 的推导\n\n刚度矩阵 $A$ 的元素为 $A_{ij} = \\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x)\\,dx$，其中 $\\{\\phi_{i}\\}_{i=1}^{n-1}$ 是子空间 $V_h$ 的节点帽函数基。均匀剖分由节点 $x_k = kh$ 给出，其中 $k=0, 1, \\dots, n$，网格尺寸为 $h=1/n$。\n\n基函数 $\\phi_i(x)$ 是连续的分片线性函数，由 $\\phi_i(x_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克δ。它仅在区间 $(x_{i-1}, x_{i+1})$ 上非零。其显式形式为：\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h} & \\text{for } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h} & \\text{for } x \\in [x_i, x_{i+1}] \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n导数 $\\phi_i'(x)$ 是分片常数：\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h} & \\text{for } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h} & \\text{for } x \\in (x_i, x_{i+1}) \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n我们通过考虑索引 $i, j \\in \\{1, \\dots, n-1\\}$ 的三种情况来计算 $A_{ij}$ 的积分。\n\n**情况1：对角元 ($j=i$)**\n被积函数 $(\\phi_i'(x))^2$ 仅在 $(x_{i-1}, x_{i+1})$ 上非零。\n$$\nA_{ii} = \\int_{0}^{1} (\\phi_i'(x))^2\\,dx = \\int_{x_{i-1}}^{x_{i+1}} (\\phi_i'(x))^2\\,dx \\\\\n= \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2\\,dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2\\,dx \\\\\n= \\frac{1}{h^2} (x_i - x_{i-1}) + \\frac{1}{h^2} (x_{i+1} - x_i) \\\\\n= \\frac{1}{h^2} (h) + \\frac{1}{h^2} (h) = \\frac{1}{h} + \\frac{1}{h} = \\frac{2}{h}\n$$\n\n**情况2：次对角元 ($|i-j|=1$)**\n让我们考虑 $j=i+1$。乘积 $\\phi_i'(x)\\phi_{i+1}'(x)$ 仅在导数的支集重叠处非零。$\\phi_i'(x)$ 的支集是 $(x_{i-1}, x_{i+1})$，而 $\\phi_{i+1}'(x)$ 的支集是 $(x_i, x_{i+2})$。重叠部分是区间 $(x_i, x_{i+1})$。\n在此区间上，$\\phi_i'(x) = -1/h$ 且 $\\phi_{i+1}'(x) = 1/h$。\n$$\nA_{i,i+1} = \\int_{0}^{1} \\phi_i'(x)\\phi_{i+1}'(x)\\,dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx \\\\\n= -\\frac{1}{h^2} (x_{i+1} - x_i) = -\\frac{1}{h^2} (h) = -\\frac{1}{h}\n$$\n根据积分的对称性，$A_{i+1,i} = A_{i,i+1} = -1/h$。\n\n**情况3：其他元素 ($|i-j|>1$)**\n在这种情况下，$\\phi_i'(x)$ 和 $\\phi_j'(x)$ 的支集不相交。它们的乘积处处为零。\n$$\nA_{ij} = \\int_{0}^{1} \\phi_i'(x)\\phi_j'(x)\\,dx = \\int_{0}^{1} 0 \\,dx = 0\n$$\n综合这些结果，$(n-1) \\times (n-1)$ 的刚度矩阵 $A$ 是一个对称三对角矩阵：\n$$\nA = \\frac{1}{h}\n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 & 0 \\\\\n-1 & 2 & -1 & \\cdots & 0 & 0 \\\\\n0 & -1 & 2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 2 & -1 \\\\\n0 & 0 & 0 & \\cdots & -1 & 2\n\\end{pmatrix}\n$$\n\n### 第二部分：$A$ 的特征对与条件数 $\\kappa_2(A)$\n\n设 $\\lambda$ 是 $A$ 的一个特征值，$\\mathbf{v} = (v_1, v_2, \\dots, v_{n-1})^T$ 是对应的特征向量。特征值问题为 $A\\mathbf{v} = \\lambda\\mathbf{v}$。设 $m=n-1$ 为矩阵的大小。该系统的第 $j$ 行为：\n$$\n\\frac{1}{h}(-v_{j-1} + 2v_j - v_{j+1}) = \\lambda v_j, \\quad \\text{for } j=1, \\dots, m,\n$$\n其中我们定义 $v_0 = 0$ 和 $v_{m+1} = 0$ 以一致地处理边界行。整理后，我们得到一个二阶线性齐次差分方程：\n$$\n-v_{j-1} + (2 - \\lambda h)v_j - v_{j+1} = 0\n$$\n我们寻求形式为 $v_j = r^j$ 的解。将其代入方程得到特征方程：\n$$\n-r^{j-1} + (2 - \\lambda h)r^j - r^{j+1} = 0 \\implies r^2 - (2 - \\lambda h)r + 1 = 0\n$$\n设 $2 - \\lambda h = 2\\cos\\theta$，对于某个 $\\theta$。方程变为 $r^2 - 2\\cos\\theta \\, r + 1 = 0$，其根为 $r = \\exp(\\pm i\\theta)$。$v_j$ 的通解是这些根的线性组合：\n$$\nv_j = c_1 \\cos(j\\theta) + c_2 \\sin(j\\theta)\n$$\n我们应用边界条件。条件 $v_0=0$ 意味着 $c_1 \\cos(0) + c_2 \\sin(0) = c_1 = 0$。因此，解必须具有形式 $v_j = c_2 \\sin(j\\theta)$。\n第二个条件 $v_{m+1}=v_n=0$ 要求 $c_2 \\sin((m+1)\\theta) = c_2 \\sin(n\\theta) = 0$。对于一个非平凡的特征向量，$c_2 \\neq 0$，所以我们必须有 $\\sin(n\\theta) = 0$。这意味着 $n\\theta = k\\pi$，其中 $k$ 为整数。\n因此，$\\theta_k = \\frac{k\\pi}{n}$，其中 $k=1, 2, \\dots, n-1$。这些 $k$ 的值产生不同的非平凡特征向量。\n\n从我们的代换 $2 - \\lambda h = 2\\cos\\theta$，我们找到对应于每个 $\\theta_k$ 的特征值 $\\lambda_k$：\n$$\n\\lambda_k h = 2 - 2\\cos(\\theta_k) = 2 - 2\\cos\\left(\\frac{k\\pi}{n}\\right) = 4\\sin^2\\left(\\frac{k\\pi}{2n}\\right)\n$$\n所以 $A$ 的特征值为：\n$$\n\\lambda_k = \\frac{4}{h} \\sin^2\\left(\\frac{k\\pi}{2n}\\right), \\quad k=1, 2, \\dots, n-1\n$$\n相应的未归一化特征向量 $\\mathbf{v}^{(k)}$ 的分量为：\n$$\nv_j^{(k)} = \\sin\\left(\\frac{jk\\pi}{n}\\right), \\quad j=1, 2, \\dots, n-1\n$$\n对于一个对称正定（SPD）矩阵，$2$-范数条件数 $\\kappa_2(A)$ 是其最大特征值与最小特征值之比，即 $\\kappa_2(A) = \\lambda_{max}/\\lambda_{min}$。\n函数 $\\sin^2(x)$ 在 $(0, \\pi/2)$ 上是严格递增的。对于 $k \\in \\{1, \\dots, n-1\\}$，自变量 $\\frac{k\\pi}{2n}$ 在 $(0, \\pi/2)$ 区间内。\n最小特征值 $\\lambda_{min}$ 对应于 $k=1$：\n$$\n\\lambda_{min} = \\lambda_1 = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2n}\\right)\n$$\n最大特征值 $\\lambda_{max}$ 对应于 $k=n-1$：\n$$\n\\lambda_{max} = \\lambda_{n-1} = \\frac{4}{h} \\sin^2\\left(\\frac{(n-1)\\pi}{2n}\\right)\n$$\n使用恒等式 $\\sin(\\pi/2 - x) = \\cos(x)$，我们化简 $\\lambda_{max}$：\n$$\n\\lambda_{max} = \\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2n}\\right) = \\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2n}\\right)\n$$\n那么条件数为：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{max}}{\\lambda_{min}} = \\frac{\\frac{4}{h} \\cos^2\\left(\\frac{\\pi}{2n}\\right)}{\\frac{4}{h} \\sin^2\\left(\\frac{\\pi}{2n}\\right)} = \\frac{\\cos^2\\left(\\frac{\\pi}{2n}\\right)}{\\sin^2\\left(\\frac{\\pi}{2n}\\right)} = \\cot^2\\left(\\frac{\\pi}{2n}\\right)\n$$\n由于 $h=1/n$，这可以写成 $h$ 的函数：\n$$\n\\kappa_2(A) = \\cot^2\\left(\\frac{\\pi h}{2}\\right)\n$$\n\n### 第三部分：$\\kappa_2(A)$ 的渐近分析\n\n我们需要确定在渐近关系 $\\kappa_2(A) \\sim C h^{-2}$ (当 $h \\to 0^+$ 时) 中的领阶系数 $C$。这等价于求极限：\n$$\nC = \\lim_{h\\to 0^+} \\frac{\\kappa_2(A)}{h^{-2}} = \\lim_{h\\to 0^+} h^2 \\kappa_2(A)\n$$\n代入我们得到的 $\\kappa_2(A)$ 的表达式：\n$$\nC = \\lim_{h\\to 0^+} h^2 \\cot^2\\left(\\frac{\\pi h}{2}\\right)\n$$\n设 $x = \\frac{\\pi h}{2}$。当 $h \\to 0^+$ 时，我们有 $x \\to 0^+$。我们可以写出 $h = \\frac{2x}{\\pi}$。极限变为：\n$$\nC = \\lim_{x\\to 0^+} \\left(\\frac{2x}{\\pi}\\right)^2 \\cot^2(x) = \\frac{4}{\\pi^2} \\lim_{x\\to 0^+} x^2 \\frac{\\cos^2(x)}{\\sin^2(x)}\n$$\n这个极限可以分开计算：\n$$\nC = \\frac{4}{\\pi^2} \\left(\\lim_{x\\to 0^+} \\frac{x^2}{\\sin^2(x)}\\right) \\left(\\lim_{x\\to 0^+} \\cos^2(x)\\right)\n$$\n使用基本三角极限 $\\lim_{x\\to 0} \\frac{\\sin x}{x} = 1$，我们有：\n$$\n\\lim_{x\\to 0^+} \\frac{x^2}{\\sin^2(x)} = \\left(\\lim_{x\\to 0^+} \\frac{x}{\\sin x}\\right)^2 = 1^2 = 1\n$$\n对于余弦项：\n$$\n\\lim_{x\\to 0^+} \\cos^2(x) = (\\cos(0))^2 = 1^2 = 1\n$$\n将这些值代回：\n$$\nC = \\frac{4}{\\pi^2} \\cdot 1 \\cdot 1 = \\frac{4}{\\pi^2}\n$$\n领阶系数 $C$ 是 $\\frac{4}{\\pi^2}$。", "answer": "$$\\boxed{\\frac{4}{\\pi^2}}$$", "id": "3384581"}]}