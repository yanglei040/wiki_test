{"hands_on_practices": [{"introduction": "一个数值格式在何种程度上逼近了它旨在求解的偏微分方程？相容性分析通过推导修正方程（modified equation）来回答这个问题，该方程揭示了数值格式实际求解的、包含了高阶误差项的等效连续方程。这项实践将指导你为经典的Lax-Wendroff格式推导其修正方程，并识别出导致数值耗散（numerical dissipation）和数值色散（numerical dispersion）的关键误差项，从而让你对格式的内在行为有更深刻的量化理解。[@problem_id:3373281]", "problem": "考虑常系数线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}$，$a \\neq 0$。该方程建立在空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格上。设 $u^{n}_{j}$ 表示对 $u(x_{j}, t^{n})$ 的数值近似，其中 $x_{j} = j \\,\\Delta x$，$t^{n} = n\\,\\Delta t$。针对此 PDE，基于泰勒展开的两步 Lax–Wendroff 格式通过以下方式更新 $u^{n}_{j}$：\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n仅使用通过泰勒展开得到的相容性的基本定义以及修正方程的概念（一个等价的连续偏微分方程，其光滑解在指定阶数上与格式一致），推导出一个光滑函数 $u(x,t)$ 所满足的修正方程，该方程需包含 $u_{t}+a\\,u_{x}$ 之外的最低阶非零偶数阶和奇数阶导数修正项。将您的结果表示为归一化形式\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{更高阶项},\n$$\n其中系数 $\\alpha_{2}$ 和 $\\alpha_{3}$ 依赖于 $a$、$\\Delta t$ 和 $\\Delta x$。指明这些项中哪些是耗散项（偶数阶导数），哪些是色散项（奇数阶导数），并显式地确定 $\\alpha_{2}$ 和 $\\alpha_{3}$。您可以引入库朗数 $r = a\\,\\Delta t/\\Delta x$，但前提是您最终的 $\\alpha_{2}$ 和 $\\alpha_{3}$ 表达式是用 $a$、$\\Delta t$ 和 $\\Delta x$ 来量化的。\n\n将包含 $\\alpha_{2}$ 和 $\\alpha_{3}$ 的行矩阵按此顺序作为您的最终答案报告。无需进行数值计算。", "solution": "该问题要求推导应用于线性平流方程 $u_t + a u_x = 0$ 的两步 Lax-Wendroff 格式的修正方程。目标是找到修正方程归一化形式中的系数 $\\alpha_2$ 和 $\\alpha_3$：\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{更高阶项}。\n$$\n推导过程如下：对数值格式中的每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开，并假设在该点处，数值解 $u^n_j$ 对应于一个光滑函数 $u(x,t)$。\n\n给定的 Lax-Wendroff 格式为：\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n为便于分析，我们将格式两边同除以 $\\Delta t$ 进行重排：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} \\;=\\; -\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n现在，我们将每一项在点 $(x_j, t_n)$ 附近展开为泰勒级数，其中 $u$ 及其导数在该点求值。\n\n左侧 (LHS) 是时间导数的前向差分近似：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\mathcal{O}(\\Delta t^3).\n$$\n右侧 (RHS) 包含两个涉及空间差分的项。第一项是 $u_x$ 的中心差分近似：\n$$\n-\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr) = -\\frac{a}{2\\,\\Delta x} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) - \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= -\\frac{a}{2\\,\\Delta x} \\left( 2\\Delta x u_x + \\frac{\\Delta x^3}{3}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^4).\n$$\nRHS 上的第二项是 $u_{xx}$ 的中心差分近似：\n$$\n\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr) = \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\dots \\right) - 2u + \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\dots \\right) \\right]\n$$\n$$\n= \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left( \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12}u_{xxxx} + \\dots \\right) = \\frac{a^2 \\Delta t}{2}u_{xx} + \\frac{a^2 \\Delta t \\Delta x^2}{24}u_{xxxx} + \\mathcal{O}(\\Delta t \\Delta x^4).\n$$\n令展开后的 LHS 和 RHS 相等，得到局部截断误差的表达式：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\n重新整理以匹配原始 PDE 的形式，我们得到：\n$$\nu_t + a u_x = \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}u_{tt}\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}u_{ttt} + \\text{h.o.t.}\n$$\n为了得到修正方程，我们必须将 RHS 上的所有时间导数用空间导数表示。这可以通过对修正方程本身进行重复微分来实现。在最低阶上，修正方程为 $u_t = -a u_x$。我们用它来替换更高阶的时间导数。算子关系为 $\\frac{\\partial}{\\partial t} \\approx -a \\frac{\\partial}{\\partial x}$。将此应用于 $u_{tt}$ 和 $u_{ttt}$：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx (-a\\frac{\\partial}{\\partial x})(-a u_x) = a^2 u_{xx}.\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t} u_{tt} \\approx (-a\\frac{\\partial}{\\partial x})(a^2 u_{xx}) = -a^3 u_{xxx}.\n$$\n将这些近似值代回关于 $u_t+au_x$ 的方程中：\n$$\nu_t + a u_x \\approx \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}(a^2 u_{xx})\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}(-a^3 u_{xxx}).\n$$\n我们按空间导数的阶数对各项进行分组：\n二阶导数项 $u_{xx}$ 的系数为：\n$$\n\\frac{a^2 \\Delta t}{2} - \\frac{a^2 \\Delta t}{2} = 0.\n$$\n三阶导数项 $u_{xxx}$ 的系数为：\n$$\n-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t^2(-a^3)}{6} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\n因此，截至三阶导数项的修正方程为：\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) u_{xxx} + \\text{h.o.t.}\n$$\n该方程揭示了主阶误差的性质。对应于数值耗散的偶数阶导数项 ($u_{xx}$) 的系数为零。对应于数值色散的奇数阶导数项 ($u_{xxx}$) 的系数非零（除非库朗数 $r = a\\Delta t / \\Delta x$ 的绝对值为 1）。这表明该格式是色散的。最低阶的非零偶数阶导数项是四阶项 ($u_{xxxx}$)，这确保了当 $|r|1$ 时格式是耗散的。\n\n现在，我们将我们的结果与指定的归一化形式进行匹配：\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{h.o.t.}\n$$\n通过比较系数，我们找到 $\\alpha_2$ 和 $\\alpha_3$。\n对于 $u_{xx}$ 项：\n$$\n\\Delta x\\,\\alpha_{2} = 0 \\quad \\implies \\quad \\alpha_{2} = 0.\n$$\n对于 $u_{xxx}$ 项：\n$$\n\\Delta x^{2}\\,\\alpha_{3} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\n解出 $\\alpha_3$：\n$$\n\\alpha_{3} = \\frac{1}{\\Delta x^2} \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) = -\\frac{a}{6} + \\frac{a^3 \\Delta t^2}{6 \\Delta x^2}.\n$$\n因此，系数被确定。$\\alpha_2$ 为零，表明不存在二阶数值耗散。$\\alpha_3$ 通常非零，表明存在三阶数值色散。\n\n系数的最终表达式为：\n$\\alpha_2 = 0$.\n$\\alpha_3 = \\frac{a^3 \\Delta t^2}{6 \\Delta x^2} - \\frac{a}{6}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{a^{3} \\Delta t^{2}}{6 \\Delta x^{2}} - \\frac{a}{6}\n\\end{pmatrix}\n}\n$$", "id": "3373281"}, {"introduction": "即使一个格式是相容的，如果计算中产生的误差会无限增长，那么该格式也毫无用处——这正是稳定性的重要性所在。对于显式时间积分方法，稳定性通常会对时间步长施加一个限制，这便是著名的Courant–Friedrichs–Lewy (CFL) 条件。本练习将引导你使用两种不同的方法——算子谱分析和冯·诺依曼（von Neumann）分析——来确定一个迎风间断Galerkin格式的稳定性边界，让你亲手计算出保证数值解不发散的最大允许时间步长。[@problem_id:3373451]", "problem": "考虑周期域上的一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a0$ 为常数。在尺寸为 $h$ 的均匀网格上，使用多项式次数为 $p=0$ 的间断 Galerkin (DG) 方法，并采用迎风数值通量进行空间离散化。此半离散方法等价于标准的迎风有限体积格式。使用前向欧拉法进行时间推进。\n\n您可以假定以下定义和事实作为起点：\n- 针对该问题，$p=0$ 的间断 Galerkin (DG) 半离散格式（采用迎风通量）对单元平均值 $\\{u_{j}\\}$ 产生单元系统 $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = -\\frac{a}{h}\\left(u_{j}(t) - u_{j-1}(t)\\right)$。\n- 对于空间均匀的周期性离散化，von Neumann 分析采用傅里叶假设 $u_{j}(t)=\\widehat{u}(t)\\,\\exp(\\mathrm{i} j \\theta)$，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数。\n- Courant–Friedrichs–Lewy (CFL) 数定义为 $\\text{CFL} \\equiv a\\,\\Delta t / h$，其中 $\\Delta t$ 是时间步长。\n- 对于具有半离散特征值 $\\lambda$ 的模式，前向欧拉法的放大因子为 $1 + \\Delta t\\,\\lambda$，其线性稳定区域为闭圆盘 $\\{z \\in \\mathbb{C} : |1+z|\\leq 1\\}$。\n\n任务：\n1. 仅使用上述基本定义和事实，为 $p=0$ 的半离散算子的特征值导出一个基于有界谱包含的实用 CFL 估计。换言之，用一个简单的复平面几何集来界定半离散谱，并要求其在前向欧拉映射下的像位于前向欧拉稳定圆盘内，从而获得关于 $\\text{CFL}$ 的一个充分条件。\n2. 独立地进行 von Neumann 分析，以获得经验性的前向欧拉稳定性极限（即使所有傅里叶模式都保持稳定的最大 $\\text{CFL}$ 值）。\n3. 计算 $p=0$ 时，基于谱界限的实用估计与 von Neumann 经验极限的比值 $\\mathcal{R}$。\n\n您的最终答案必须是单个实数 $\\mathcal{R}$，以精确形式书写（无需四舍五入）。表示 $\\mathcal{R}$ 时不带任何单位。", "solution": "用户希望分析一维线性平流方程数值格式的稳定性。分析需要使用两种不同的方法进行，并要求计算所得稳定性极限的比值。\n\n首先验证问题。\n\n### 步骤1：提取已知条件\n- **方程：** $u_{t} + a\\,u_{x} = 0$，其中 $a0$ 为常数，在周期域上。\n- **空间离散化：** 在尺寸为 $h$ 的均匀网格上，使用多项式次数为 $p=0$ 的间断 Galerkin (DG) 方法和迎风数值通量。\n- **半离散格式：** 对于单元平均值 $\\{u_{j}\\}$ 为 $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = -\\frac{a}{h}\\left(u_{j}(t) - u_{j-1}(t)\\right)$。这是一个系统 $\\frac{\\mathrm{d}\\vec{u}}{\\mathrm{d}t} = L\\vec{u}$，其中 $L$ 是半离散算子。\n- **时间离散化：** 前向欧拉法。\n- **Von Neumann 假设：** $u_{j}(t)=\\widehat{u}(t)\\,\\exp(\\mathrm{i} j \\theta)$，其中 $\\theta \\in [-\\pi,\\pi]$。\n- **CFL 定义：** $\\text{CFL} \\equiv \\nu = a\\,\\Delta t / h$，其中 $\\Delta t$ 是时间步长。\n- **前向欧拉稳定区域：** 集合 $S_{FE} = \\{z \\in \\mathbb{C} : |1+z|\\leq 1\\}$，其中 $z = \\Delta t \\lambda$ 且 $\\lambda$ 是半离散算子 $L$ 的一个特征值。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题坚实地植根于偏微分方程数值分析的标准理论，特别是关于有限差分/有限体积方法稳定性的理论。\n- **适定性：** 问题陈述清晰，所有必要的定义都已提供。任务具体，并能导出一个唯一的数值答案。\n- **客观性：** 问题以精确、客观的数学语言表述。\n- 该问题是自洽的、一致的，并且不违反任何科学原理。所提供的半离散格式对于指定的 DG-P0/迎风有限体积格式是正确的。定义均为标准定义。\n\n### 步骤3：结论与行动\n问题有效。将继续进行求解。\n\n### 任务1：基于谱界限的 CFL 估计\n\n目标是通过界定半离散算子 $L$ 的谱，并确保其在时间步进映射下的缩放像位于前向欧拉法的稳定区域内，从而找到关于 CFL 数 $\\nu$ 的一个充分条件。\n\n周期域上单元平均值 $\\{u_j\\}_{j=1}^N$ 的半离散系统为 $\\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = \\frac{a}{h}(u_{j-1} - u_j)$。这可以写成矩阵形式 $\\frac{\\mathrm{d}\\vec{u}}{\\mathrm{d}t} = L\\vec{u}$，其中 $L$ 是一个循环矩阵。\n算子 $L$ 的特征值 $\\lambda$ 可以通过将傅里叶模式 $u_j(t) = \\widehat{u}(t)\\exp(\\mathrm{i} j \\theta)$ 代入半离散方程得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta)) = -\\frac{a}{h}\\left(\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta) - \\widehat{u}(t)\\exp(\\mathrm{i} (j-1) \\theta)\\right)\n$$\n对左侧关于 $t$ 求导并提取公因子，得到：\n$$\n\\exp(\\mathrm{i} j \\theta)\\frac{\\mathrm{d}\\widehat{u}}{\\mathrm{d}t} = -\\frac{a}{h}\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta) (1 - \\exp(-\\mathrm{i}\\theta))\n$$\n这给出了模态振幅 $\\widehat{u}(t)$ 的常微分方程 $\\frac{\\mathrm{d}\\widehat{u}}{\\mathrm{d}t} = \\lambda(\\theta)\\widehat{u}$，其中特征值 $\\lambda(\\theta)$ 为：\n$$\n\\lambda(\\theta) = -\\frac{a}{h}(1 - \\exp(-\\mathrm{i}\\theta))\n$$\n所有这些对于 $\\theta \\in [-\\pi, \\pi]$ 的特征值构成了 $L$ 的谱，记为 $\\sigma(L)$。我们可以将 $\\lambda(\\theta)$ 重写为：\n$$\n\\lambda(\\theta) = -\\frac{a}{h} + \\frac{a}{h}\\exp(-\\mathrm{i}\\theta)\n$$\n该方程描述了复平面上的一个圆，其圆心为 $c = -a/h$，半径为 $r = a/h$。\n\n一个“基于有界谱包含的实用 CFL 估计”涉及找到一个包含谱的简单几何集 $\\Sigma$，即 $\\sigma(L) \\subseteq \\Sigma$，然后要求缩放后的集合 $\\Delta t \\Sigma$ 位于前向欧拉稳定区域 $S_{FE}$ 内。一个标准方法是使用 Gerschgorin 圆盘定理。对于矩阵 $L$，每一行都有一个对角元素 $-a/h$ 和一个非对角元素 $a/h$。所有的 Gerschgorin 圆盘都是相同的，均以 $-a/h$ 为中心，半径为 $a/h$。这些圆盘的并集为谱提供了一个界，即：\n$$\n\\Sigma = \\left\\{ z \\in \\mathbb{C} : \\left|z + \\frac{a}{h}\\right| \\le \\frac{a}{h} \\right\\}\n$$\n这个圆盘也是谱的凸包。稳定性条件是 $\\Delta t \\Sigma \\subseteq S_{FE}$。集合 $\\Delta t \\Sigma$ 为：\n$$\n\\Delta t \\Sigma = \\left\\{ w \\in \\mathbb{C} : \\left|\\frac{w}{\\Delta t} + \\frac{a}{h}\\right| \\le \\frac{a}{h} \\right\\} = \\left\\{ w \\in \\mathbb{C} : \\left|w + \\frac{a\\Delta t}{h}\\right| \\le \\frac{a\\Delta t}{h} \\right\\}\n$$\n使用定义 $\\nu = a\\Delta t/h$，缩放后的界是圆盘 $D_{\\nu} = \\{ w \\in \\mathbb{C} : |w + \\nu| \\le \\nu \\}$。这是一个以 $-\\nu$ 为中心，半径为 $\\nu$ 的圆盘。\n前向欧拉稳定区域是 $S_{FE} = \\{ w \\in \\mathbb{C} : |1+w| \\le 1 \\}$，这是一个以 $-1$ 为中心，半径为 $1$ 的圆盘。\n为使圆盘 $D_{\\nu}$ 包含在圆盘 $S_{FE}$ 内，它们圆心之间的距离与 $D_{\\nu}$ 的半径之和必须小于或等于 $S_{FE}$ 的半径：\n$$\n|(-\\nu) - (-1)| + \\nu \\le 1\n$$\n$$\n|1-\\nu| + \\nu \\le 1\n$$\n因为 $\\nu = a\\Delta t/h  0$，我们考虑两种情况：\n1. 如果 $0  \\nu \\le 1$，那么 $|1-\\nu| = 1-\\nu$。条件是 $(1-\\nu) + \\nu \\le 1$，简化为 $1 \\le 1$。这是成立的。\n2. 如果 $\\nu  1$，那么 $|1-\\nu| = \\nu-1$。条件是 $(\\nu-1) + \\nu \\le 1$，简化为 $2\\nu \\le 2$，即 $\\nu \\le 1$。这与假设 $\\nu  1$ 相矛盾。\n因此，对于所有 $\\nu \\in (0,1]$，该条件都满足。最大值为 $\\nu=1$。\n$$\n\\text{CFL}_{\\text{spec}} = 1\n$$\n\n### 任务2：Von Neumann 稳定性分析\n\nVon Neumann 分析在完全离散的格式上进行。应用前向欧拉法于时间，得到：\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\left( -\\frac{a}{h}(u_j^n - u_{j-1}^n) \\right)\n$$\n设 $\\nu = a\\Delta t/h$。格式为 $u_j^{n+1} = u_j^n - \\nu(u_j^n - u_{j-1}^n)$。\n我们代入傅里叶假设 $u_j^n = (G(\\theta))^n \\exp(\\mathrm{i} j \\theta)$，其中 $G(\\theta)$ 是放大因子。\n$$\n(G(\\theta))^{n+1} \\exp(\\mathrm{i} j \\theta) = (G(\\theta))^n \\exp(\\mathrm{i} j \\theta) - \\nu \\left( (G(\\theta))^n \\exp(\\mathrm{i} j \\theta) - (G(\\theta))^n \\exp(\\mathrm{i} (j-1)\\theta) \\right)\n$$\n除以 $(G(\\theta))^n \\exp(\\mathrm{i} j \\theta)$：\n$$\nG(\\theta) = 1 - \\nu(1 - \\exp(-\\mathrm{i}\\theta))\n$$\n为了稳定性，我们要求对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G(\\theta)| \\le 1$。$G(\\theta)$ 的表达式可以写成：\n$$\nG(\\theta) = (1-\\nu) + \\nu\\exp(-\\mathrm{i}\\theta)\n$$\n随着 $\\theta$ 的变化，这个表达式在复平面上描绘出一个以 $c = 1-\\nu$ 为中心、半径为 $r = \\nu$ 的圆。为使这个圆包含在以原点为中心的单位圆盘内，我们要求 $|c|+r \\le 1$。\n$$\n|1-\\nu| + \\nu \\le 1\n$$\n这与任务1中的条件相同。如前所示，对于 $\\nu  0$，此不等式当且仅当 $\\nu \\le 1$ 时成立。\n经验稳定性极限是满足条件的最大 $\\nu$ 值。\n$$\n\\text{CFL}_{\\text{vN}} = 1\n$$\n\n### 任务3：计算比值 $\\mathcal{R}$\n\n比值 $\\mathcal{R}$ 是基于谱界限的实用估计除以 von Neumann 经验极限。\n$$\n\\mathcal{R} = \\frac{\\text{CFL}_{\\text{spec}}}{\\text{CFL}_{\\text{vN}}} = \\frac{1}{1} = 1\n$$\n对于这个特定问题，半离散算子是范态的，并且标准分析技术（Gerschgorin 界、数值范围、von Neumann 分析）都得出相同的精确稳定性极限。“实用估计”和“经验极限”之间的区别消失了。", "answer": "$$\n\\boxed{1}\n$$", "id": "3373451"}, {"introduction": "Lax等价定理为线性问题建立了“相容性 + 稳定性 = 收敛性”的核心关系。然而，对于非线性守恒律，情况变得更加复杂：我们不仅要求格式收敛，还要求它收敛到物理上正确的、满足熵条件的弱解。这项富有挑战性的实践要求你主动构建一个相容但却不稳定的数值格式，并分析它为何会收敛到一个不满足熵条件的非物理解，从而深刻揭示稳定性与解的物理可容许性之间的关键联系。[@problem_id:3373303]", "problem": "设 $u(x,t)$ 是标量守恒律（伯格斯方程）$u_t + \\left(\\frac{1}{2}u^2\\right)_x = 0$ 在 $\\mathbb{R} \\times (0,\\infty)$ 上的解，其黎曼初始数据为当 $x0$ 时 $u(x,0) = u_L$，当 $x0$ 时 $u(x,0)=u_R$。考虑一个空间步长为 $\\Delta x0$、时间步长为 $\\Delta t0$ 的均匀网格，并记 $\\lambda = \\Delta t/\\Delta x$。如果一个有限体积法通过通量差分形式 $u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right)$ 来更新单元平均值 $\\{u_j^n\\}_{j \\in \\mathbb{Z}}$，则称该方法是守恒的，其中 $F_{j+1/2}^n$ 是一个仅依赖于相邻状态的双变量数值通量。如果对于所有 $u \\in \\mathbb{R}$ 都有 $F(u,u) = f(u)$，则称数值通量 $F(u_L,u_R)$ 与物理通量 $f(u) = \\frac{1}{2}u^2$ 是相容的。如果存在一个与 $\\Delta x$、$\\Delta t$ 和 $n$ 无关的常数 $C$，使得对于所有 $n \\ge 0$ 以及由该格式从初始数据 $\\{u_j^0\\}$ 和 $\\{v_j^0\\}$ 生成的任意两个解，都有 $\\sum_{j \\in \\mathbb{Z}} |u_j^n - v_j^n| \\le C \\sum_{j \\in \\mathbb{Z}} |u_j^0 - v_j^0|$ 成立，则称一个格式是 $L^1$-稳定的。如果守恒律的一个弱解满足激波的Lax熵条件，或者等价地，如果它是当 $\\epsilon \\to 0^+$ 时 $u_t + \\left(\\frac{1}{2}u^2\\right)_x = \\epsilon u_{xx}$ 的消失黏性极限，则该弱解是熵可容的。\n\n你的任务是：\n\n1. 从守恒律结构和相容性定义出发，为伯格斯方程构造一个显式的守恒有限体积格式，该格式是相容的，但其主修正方程校正项起到负黏性作用。仔细论证你构造的格式是守恒和相容的，并使用泰勒展开和差分近似推导其主修正方程，以确定黏性项的符号。\n\n2. 使用单调性和$L^1$稳定性概念的定义，通过证明你构造的格式不是单调的，并且其线性化放大因子在某个常数态邻域内的某个傅里叶模态上超过1，来证明该格式不是$L^1$-稳定的。将此与修正方程中黏性项的符号联系起来。\n\n3. 考虑 $u_L=0$ 和 $u_R=1$ 的黎曼问题。解释为什么对于该数据，伯格斯方程的熵解是一个稀疏扇，以及为什么任何连接 $u_L$ 到 $u_R$ 的激波都是不可容的。然后，通过引用守恒形式和Rankine–Hugoniot关系，分析在负黏性存在的情况下你的格式所选择的弱极限。确定该格式为此黎曼问题选择的间断速度$s$，并提供此$s$作为你的最终答案。最终答案必须是一个不带单位的实数。不需要四舍五入；提供精确值。", "solution": "该问题由三个关于伯格斯方程有限体积格式的任务组成。我们将在构造所需的数值格式后，按顺序处理每个任务。\n\n### 第一部分：具有负黏性的格式的构造与分析\n\n问题要求构造一个守恒且相容的有限体积格式，但该格式表现出负黏性。一个有限体积格式以守恒的通量差分形式给出：\n$$ u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right) $$\n其中 $\\lambda = \\frac{\\Delta t}{\\Delta x}$，$u_j^n$ 是在时间 $n$ 单元 $j$ 中解的单元平均值，$F_{j+1/2}^n = F(u_j^n, u_{j+1}^n)$ 是单元 $j$ 和 $j+1$ 之间界面上的数值通量。伯格斯方程的物理通量是 $f(u) = \\frac{1}{2}u^2$，其特征速度为 $f'(u) = u$。\n\n一个标准的稳定格式，如迎风格式，使用来自流动方向的信息。要构造一个具有负黏性（通常会导致不稳定性）的格式，我们可以设计一个使用来自“顺风”方向信息的通量。这是一种反迎风或顺风格式。\n\n我们根据界面处特征速度的近似符号来定义数值通量 $F(u_L, u_R)$，例如，用 $\\frac{u_L+u_R}{2}$ 来近似：\n$$ F(u_L, u_R) = \\begin{cases} f(u_R)  \\text{若 } (u_L+u_R)/2 > 0 \\\\ f(u_L)  \\text{若 } (u_L+u_R)/2  0 \\end{cases} $$\n对于 $(u_L+u_R)/2 = 0$ 的情况，通量可以定义为 $F(u_L, u_R) = f(0) = 0$，这与当 $u_L \\to 0^-$ 和 $u_R \\to 0^+$ 时的两个分支都一致。\n\n我们验证该格式的性质：\n1.  **守恒性：** 该格式以通量差分形式 $u_j^{n+1} = u_j^n - \\lambda (F(u_j^n, u_{j+1}^n) - F(u_{j-1}^n, u_j^n))$ 定义。这种形式保证了积分量 $\\sum_j u_j^n \\Delta x$ 的守恒，这可以通过对 $j$ 求和看出，结果是通量的级数相消求和。\n2.  **相容性：** 如果 $F(u, u) = f(u)$，则通量 $F(u_L, u_R)$ 与 $f(u)$ 相容。对于我们定义的通量，如果我们设 $u_L = u_R = u$，则 $(u_L+u_R)/2 = u$。如果 $u>0$，$F(u,u) = f(u)$。如果 $u0$，$F(u,u) = f(u)$。如果 $u=0$，$F(0,0)=f(0)$。因此，该通量是相容的。\n\n现在，我们推导该格式的修正方程的主项。我们考虑一个解为正的区域，$u > 0$。在这种情况下，$F(u_L, u_R) = f(u_R) = \\frac{1}{2}u_R^2$。格式变为：\n$$ u_j^{n+1} = u_j^n - \\lambda \\left( f(u_{j+1}^n) - f(u_j^n) \\right) $$\n我们围绕点 $(x_j, t_n)$ 对此方程进行泰勒级数展开。\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + \\frac{f(u_{j+1}^n) - f(u_j^n)}{\\Delta x} = 0 $$\n第一项按时间展开：\n$$ \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O((\\Delta t)^2) $$\n第二项按空间展开：\n$$ \\frac{f(u(x_j+\\Delta x, t_n)) - f(u(x_j, t_n))}{\\Delta x} = f_x + \\frac{\\Delta x}{2}f_{xx} + O((\\Delta x)^2) $$\n其中所有导数都在 $(x_j, t_n)$ 处取值。将这些代入格式中得到：\n$$ u_t + f_x + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta x}{2}f_{xx} + \\dots = 0 $$\n为了找到主阶修正项，我们使用原始偏微分方程 $u_t + f_x = 0$ 作为一阶近似，将高阶导数用空间导数表示。由 $u_t = -f_x$，我们发现 $u_{tt} = \\partial_t(-f_x) = - (f_t)_x = -(f'(u)u_t)_x = -(f'(u)(-f_x))_x = (f'(u)f_x)_x$。\n将此代入展开的格式中：\n$$ u_t + f_x = -\\frac{\\Delta t}{2}(f'(u)f_x)_x - \\frac{\\Delta x}{2}f_{xx} + O(\\Delta t^2, \\Delta x^2) $$\n使用 $f_x = f'(u)u_x$ 和 $f_{xx} = (f'(u)u_x)_x$，我们得到：\n$$ u_t + f_x = -\\left[ \\frac{\\Delta t}{2}(f')^2 + \\frac{\\Delta x}{2}f' \\right] u_{xx} + \\dots $$\n$$ u_t + f_x = -\\frac{\\Delta x}{2} \\left[ \\lambda (f')^2 + f' \\right] u_{xx} + \\dots $$\n黏性守恒律的标准形式是 $u_t + f_x = \\nu u_{xx}$，其中 $\\nu$ 是黏性系数。我们的修正方程揭示了一个等效数值黏性 $\\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda (f')^2 + f')$。\n对于伯格斯方程，$f'(u)=u$：\n$$ \\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda u^2 + u) $$\n当 $\\lambda u^2 + u > 0$ 时，这是一个负黏性。对于假定的情况 $u>0$，由于 $\\lambda>0$，这个条件总是满足的。因此，我们的格式引入了一个负黏性项，它起到反扩散的作用。\n\n### 第二部分：所构造格式的不稳定性\n\n我们现在证明该格式不是 $L^1$-稳定的。我们通过证明它不是单调的，并分析其线性化放大因子来做到这一点。如果一个格式 $u_j^{n+1} = H(u_{j-k}^n, \\dots, u_{j+k}^n)$ 对于其所有自变量 $u_i^n$ 都满足 $\\frac{\\partial H}{\\partial u_i^n} \\ge 0$，则该格式是单调的。\n对于我们的格式，当 $u>0$ 时，$u_j^{n+1} = H(u_j^n, u_{j+1}^n) = u_j^n - \\lambda(f(u_{j+1}^n) - f(u_j^n))$。\n我们计算偏导数：\n$$ \\frac{\\partial H}{\\partial u_j^n} = 1 - \\lambda \\frac{\\partial}{\\partial u_j^n}(-f(u_j^n)) = 1 + \\lambda f'(u_j^n) = 1 + \\lambda u_j^n $$\n对于 $u_j^n>0$ 和 $\\lambda>0$，这是正的。\n$$ \\frac{\\partial H}{\\partial u_{j+1}^n} = -\\lambda \\frac{\\partial}{\\partial u_{j+1}^n}(f(u_{j+1}^n)) = -\\lambda f'(u_{j+1}^n) = -\\lambda u_{j+1}^n $$\n对于 $u_{j+1}^n>0$ 和 $\\lambda>0$，该导数是严格为负的。由于其中一个偏导数为负，该格式不是单调的。根据 Harten、Lax 和 van Leer 的定理，一个非单调格式在非线性情况下不可能是总变差不增（TVD）的。对于标量守恒律，$L^1$-压缩与TVD性质密切相关，这表明它缺乏 $L^1$-稳定性。\n\n为了严格证明不稳定性，我们对该格式的线性化版本进行von Neumann稳定性分析。让我们围绕一个常数态 $\\bar{u}>0$ 进行线性化。对于扰动 $\\delta_j^n$ 的格式是：\n$$ \\delta_j^{n+1} = \\delta_j^n - \\lambda \\bar{u} (\\delta_{j+1}^n - \\delta_j^n) $$\n我们寻找形如 $\\delta_j^n = G^n e^{i k j \\Delta x}$ 的解，其中 $k$ 是波数，$G$ 是放大因子。\n$$ G = 1 - c\\lambda (e^{i\\theta} - 1) $$\n其中 $c=\\bar{u}>0$ 且 $\\theta = k\\Delta x$。$G$的模的平方是：\n$$ |G|^2 = \\left| 1 - c\\lambda(\\cos\\theta - 1) - i c\\lambda\\sin\\theta \\right|^2 $$\n$$ |G|^2 = (1 - c\\lambda(\\cos\\theta - 1))^2 + (c\\lambda\\sin\\theta)^2 $$\n$$ |G|^2 = 1 - 2c\\lambda(\\cos\\theta - 1) + c^2\\lambda^2(\\cos\\theta-1)^2 + c^2\\lambda^2\\sin^2\\theta $$\n$$ |G|^2 = 1 + 2c\\lambda(1-\\cos\\theta) + c^2\\lambda^2(\\cos^2\\theta-2\\cos\\theta+1+\\sin^2\\theta) $$\n$$ |G|^2 = 1 + (2c\\lambda + 2c^2\\lambda^2)(1-\\cos\\theta) $$\n由于 $c=\\bar{u}>0, \\lambda>0$，项 $2c\\lambda + 2c^2\\lambda^2$ 是正的。同时，$1-\\cos\\theta \\ge 0$。对于任何 $\\theta \\neq 2m\\pi$（$m \\in \\mathbb{Z}$）的模态，我们有 $1-\\cos\\theta > 0$，这意味着 $|G|^2 > 1$。\n大于1的放大因子意味着解的某些傅里叶模态会随时间指数增长。这种无界增长违反了 $L^1$-稳定性的定义，该定义要求两个解之差的 $L^1$-范数受初始差值的常数倍所界定。指数增长是第一部分中推导出的负黏性的直接体现，这对应于一个不适定的时间反向热方程。\n\n### 第三部分：格式选择的黎曼问题解\n\n我们考虑伯格斯方程的黎曼问题，初始数据为当 $x0$ 时 $u(x,0)=u_L=0$，当 $x>0$ 时 $u(x,0)=u_R=1$。\n特征速度为 $f'(u_L)=0$ 和 $f'(u_R)=1$。由于 $f'(u_L)  f'(u_R)$，从左半轴出发的特征线比从右半轴出发的要慢。特征线从原点发散，形成一个扇形区域。熵可容弱解是一个连续稀疏波：\n$$ u(x,t) = \\begin{cases} 0  \\text{若 } x/t  0 \\\\ x/t  \\text{若 } 0 \\le x/t \\le 1 \\\\ 1  \\text{若 } x/t  1 \\end{cases} $$\n一个连接 $u_L=0$ 到 $u_R=1$ 的间断激波解的速度 $s$ 将由Rankine-Hugoniot条件给出：\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(1)^2 - \\frac{1}{2}(0)^2}{1 - 0} = \\frac{1}{2} $$\n为了使这个激波是熵可容的，它必须满足Lax熵条件：$f'(u_L) > s > f'(u_R)$。对于 $f'(u)=u$，这变为 $0 > 1/2 > 1$，这是错误的。因此，这个激波是非物理的。\n\n所构造的数值格式是守恒的。根据Lax-Wendroff定理，如果由守恒格式生成的数值解在 $\\Delta x, \\Delta t \\to 0$ 时收敛，则其极限必须是偏微分方程的一个弱解，这意味着它在任何间断处都满足Rankine-Hugoniot条件。\n我们的格式在 $u>0$ 时具有负的数值黏性。选择熵解的消失黏性法依赖于添加一个项 $\\epsilon u_{xx}$（其中 $\\epsilon > 0$）并取极限 $\\epsilon \\to 0^+$。我们格式的修正方程对应于一个 $\\epsilon  0$ 的极限。这个过程会选择违反熵条件的解。具体来说，它会选择满足反Lax条件 $f'(u_L)  s  f'(u_R)$ 的激波。对于我们的问题，这个条件是 $0  1/2  1$，这是成立的。\n因此，所构造的格式不会收敛到稀疏波。相反，它将尝试形成非物理的间断解。这个间断的速度由格式的守恒性质决定，因此必须是由Rankine-Hugoniot条件给出的速度。\n因此，该格式选择的间断速度$s$为：\n$$ s = \\frac{1}{2} $$", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "3373303"}]}