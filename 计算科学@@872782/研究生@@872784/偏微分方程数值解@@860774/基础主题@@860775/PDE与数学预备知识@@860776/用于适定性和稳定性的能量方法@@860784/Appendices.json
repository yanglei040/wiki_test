{"hands_on_practices": [{"introduction": "能量方法的核心在于模仿连续情况下的分部积分，以分析离散格式的能量演化。本练习将从一个基本问题入手：扩散方程的有限差分格式。通过对一个使用“虚拟网格点”来处理诺伊曼（Neumann）边界条件的方案进行离散能量分析，我们将亲手推导能量平衡方程，并确定如何选择参数以确保数值解的能量不会出现伪增长。这个过程将直观地展示离散分部求和（summation by parts）是如何成为保证数值稳定性的有力工具的[@problem_id:3384271]。", "problem": "考虑一维扩散（热）方程 $u_{t} = u_{xx}$，其空间域为 $x \\in [0,1]$，边界条件为齐次诺伊曼边界条件 $u_{x}(0,t) = 0$ 和 $u_{x}(1,t) = 0$。设空间区间由 $x_{i} = i h$ 进行均匀划分，其中 $i = 0, 1, \\dots, N$，$h = 1/N$。在网格值 $u_{i}(t)$ 上定义一个半离散有限差分格式：\n$$\n\\frac{d}{dt} u_{i} = \\frac{u_{i-1} - 2 u_{i} + u_{i+1}}{h^{2}}, \\quad i = 1, 2, \\dots, N-1,\n$$\n并通过引入鬼点值 $u_{-1}$ 和 $u_{N+1}$，在边界节点 $i=0$ 和 $i=N$ 应用相同的三点模板。假设一个双参数仿射鬼点闭合：\n$$\nu_{-1} = \\alpha\\,u_{0} + \\beta\\,u_{1}, \\qquad u_{N+1} = \\alpha\\,u_{N} + \\beta\\,u_{N-1},\n$$\n其中实数权重 $\\alpha, \\beta \\in \\mathbb{R}$ 待定。\n\n从离散 $L^{2}$ 能量 $\\|u\\|_{h}^{2} := h \\sum_{i=0}^{N} u_{i}^{2}$ 以及扩散通过分部积分耗散能量这一基本事实出发，推导该格式的精确半离散能量平衡。用 $\\alpha$ 和 $\\beta$ 表示内部耗散和边界能量通量。然后，确定 $\\alpha$ 和 $\\beta$ 的值，使得离散能量对于任意网格数据都是非增的，并且诺伊曼边界条件在边界节点上以一种自然的离散意义得到满足。将你的最终答案表示为有序对 $(\\alpha,\\beta)$，使用精确值。无需四舍五入。", "solution": "用户希望找到一维热方程有限差分格式中鬼点闭合的参数 $(\\alpha, \\beta)$，使得该格式在离散能量范数下是稳定的，并且满足诺伊曼边界条件。\n\n首先，我们推导半离散能量平衡。离散 $L^2$ 能量定义为 $E(t) = \\|u(t)\\|_{h}^{2} = h \\sum_{i=0}^{N} u_{i}(t)^{2}$。我们计算其时间导数：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( h \\sum_{i=0}^{N} u_{i}^{2} \\right) = h \\sum_{i=0}^{N} 2 u_{i} \\frac{du_{i}}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\frac{du_{i}}{dt}\n$$\n对于所有节点 $i=0, 1, \\dots, N$，半离散格式为：\n$$\n\\frac{du_{i}}{dt} = \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}}\n$$\n将此代入 $\\frac{dE}{dt}$ 的表达式中：\n$$\n\\frac{dE}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\left( \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}} \\right) = \\frac{2}{h} \\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1})\n$$\n为了分析这个表达式，我们进行分部求和。求和号内的项可以写成 $u_i((u_{i+1}-u_i) - (u_i-u_{i-1}))$。\n$$\n\\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1}) = \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\sum_{i=0}^{N} u_{i} (u_i-u_{i-1})\n$$\n我们对第二个和式重新索引。令 $j=i-1$，则 $i=j+1$。该和式变为 $\\sum_{j=-1}^{N-1} u_{j+1} (u_{j+1}-u_j)$。\n$$\n= \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\left( u_0(u_0-u_{-1}) + \\sum_{j=0}^{N-1} u_{j+1}(u_{j+1}-u_j) \\right)\n$$\n我们将第一个和式在 $i=N-1$ 处拆分：$\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) + u_N(u_{N+1}-u_N)$。\n$$\n= u_N(u_{N+1}-u_N) + \\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) - u_0(u_0-u_{-1}) - \\sum_{i=0}^{N-1} u_{i+1}(u_{i+1}-u_i)\n$$\n合并这两个和式得到：\n$$\n= u_N(u_{N+1}-u_N) - u_0(u_0-u_{-1}) + \\sum_{i=0}^{N-1} (u_i - u_{i+1})(u_{i+1}-u_i)\n$$\n$$\n= u_N(u_{N+1}-u_N) + u_0(u_{-1}-u_0) - \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\n将此代回 $\\frac{dE}{dt}$ 的表达式，我们得到能量平衡方程：\n$$\n\\frac{dE}{dt} = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right) - \\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\n这个方程与连续情况下的方程 $\\frac{d}{dt}\\int_0^1 u^2 dx = 2[uu_x]_0^1 - 2\\int_0^1 (u_x)^2 dx$ 相对应。项\n$$\nD = -\\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2 = -2h \\sum_{i=0}^{N-1} \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2\n$$\n是**内部耗散**。它总是非正的。项\n$$\nB = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right)\n$$\n是**边界能量通量**。\n\n现在，我们必须确定 $\\alpha$ 和 $\\beta$。条件是：\n1. 对于任意网格数据，离散能量是非增的，即 $\\frac{dE}{dt} \\le 0$。\n2. 诺伊曼边界条件以一种自然的离散意义得到满足。\n\n由于内部耗散 $D$ 已经是非正的，稳定性条件 $\\frac{dE}{dt} \\le 0$ 要求对边界通量 $B$ 施加约束。在连续情况下，诺伊曼条件 $u_x(0,t)=u_x(1,t)=0$ 使得边界通量项 $[uu_x]_0^1$ 为零。对于能量方法而言，一种“自然的离散意义”是在离散边界通量上强制执行相同的属性，即 $B=0$。这是稳定性的一个充分条件，因为 $\\frac{dE}{dt}$ 届时将等于非正的耗散项 $D$。\n\n我们令 $B=0$。在代入鬼点关系式之前，这意味着对于任意 $u_i$ 都有：\n$u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) = 0$。\n这可以通过将每个部分设为零来保证：\n$u_{-1}-u_0 = 0 \\implies u_{-1}=u_0$\n$u_{N+1}-u_N = 0 \\implies u_{N+1}=u_N$\n\n现在我们使用给定的仿射鬼点闭合来求解 $\\alpha$ 和 $\\beta$。\n在左边界：\n$$\nu_{-1} = \\alpha u_0 + \\beta u_1\n$$\n为了使该式对于任意 $u_0$ 和 $u_1$ 都等于 $u_0$，我们必须有：\n$$\nu_0 = \\alpha u_0 + \\beta u_1 \\implies (\\alpha-1)u_0 + \\beta u_1 = 0\n$$\n由于这必须对任意 $u_0$ 和 $u_1$ 的值都成立，所以系数必须为零。这得到 $\\alpha-1=0$ 和 $\\beta=0$，因此 $\\alpha=1$ 和 $\\beta=0$。\n\n在右边界：\n$$\nu_{N+1} = \\alpha u_N + \\beta u_{N-1}\n$$\n为了使该式对于任意 $u_N$ 和 $u_{N-1}$ 都等于 $u_N$：\n$$\nu_N = \\alpha u_N + \\beta u_{N-1} \\implies (\\alpha-1)u_N + \\beta u_{N-1} = 0\n$$\n这同样意味着 $\\alpha=1$ 和 $\\beta=0$。\n\n选择 $(\\alpha, \\beta) = (1,0)$ 满足了两个边界要求，并保证了边界通量 $B$ 为零，从而确保了稳定性（$\\frac{dE}{dt} \\le 0$）。\n\n这个选择对应于将鬼点值设置为 $u_{-1}=u_0$ 和 $u_{N+1}=u_N$。这代表了零阶外推。该方法以 $\\frac{u_0-u_{-1}}{h}=0$（在 $x=-h/2$ 处对 $u_x$ 的一阶近似）和 $\\frac{u_{N+1}-u_N}{h}=0$（在 $x=1+h/2$ 处）的形式实现了离散的零通量条件，这是一种简单、常见，因此“自然的”方法。\n\n因此，唯一满足这两个条件的有序对 $(\\alpha, \\beta)$ 是 $(1,0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0\n\\end{pmatrix}\n}\n$$", "id": "3384271"}, {"introduction": "对于双曲型方程，边界条件的施加方式对数值稳定性至关重要。分部求和-同步近似项（SBP-SAT）方法提供了一个严谨而系统化的框架来构造能量稳定的高阶格式。本练习将聚焦于线性平流方程，通过推导离散能量的演化，来确定SAT罚参数的取值，从而确保离散格式在边界上的能量通量能够正确地模拟连续情况，并耗散掉任何可能导致不稳定的边界误差。这个练习是理解如何为复杂的数值格式设计稳定边界条件的关键一步[@problem_id:3384333]。", "problem": "考虑在空间区间 $x \\in [0,1]$ 上，速度为 $a \\in \\mathbb{R}$ 的常系数线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$。将该偏微分方程乘以 $u$ 并在 $[0,1]$ 上积分，通过连续能量法可得到能量恒等式\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int_{0}^{1} u(x,t)^2\\,\\mathrm{d}x\\right) + \\frac{a}{2}\\left(u(1,t)^2 - u(0,t)^2\\right) = 0,\n$$\n该式清楚地表明，通过边界的能量通量由边界值和 $a$ 的符号决定。为了进行数值近似，假设空间导数由一个分部求和 (SBP) 有限差分算子 $D = H^{-1}Q$ 来近似，该算子作用于网格点 $x_1=0, x_2, \\cdots, x_N=1$ 上的网格函数 $u(t) \\in \\mathbb{R}^{N}$。其中 $H \\in \\mathbb{R}^{N\\times N}$ 是对称正定矩阵，$Q \\in \\mathbb{R}^{N\\times N}$ 满足 SBP 性质 $Q + Q^{\\top} = B$，其中 $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$，$e_1, e_N \\in \\mathbb{R}^{N}$ 分别是第一个和最后一个标准基向量。为了弱施加边界条件，在左右边界分别使用带有未知罚系数 $\\sigma_L, \\sigma_R \\in \\mathbb{R}$ 的同步近似项 (SAT)，从而得到以下半离散格式\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right),\n$$\n其中 $u_1(t)$ 和 $u_N(t)$ 表示 $u(t)$ 的第一个和最后一个分量，$g_L(t)$ 和 $g_R(t)$ 是与流入边界（特征线进入区域的边界）和流出边界（特征线离开区域的边界）相关的给定边界数据，具体取决于 $a$ 的符号。使用离散能量 $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$，确定 SAT 罚系数 $\\sigma_L$ 和 $\\sigma_R$ 作为 $a$ 的函数的值，使得：\n- 离散能量法在流入边界处与连续能量通量相匹配，即边界数据的贡献与连续恒等式中的符号和大小相同，并且\n- 离散能量是半有界的，也就是说，离散能量导数的上界由一个仅取决于给定流入数据的项确定，并且流出边界的贡献是耗散的。\n\n将您的最终答案表示为 $\\sigma_L$ 和 $\\sigma_R$ 关于 $a$ 的闭式解析表达式，并以单个行矩阵的形式一起呈现。无需进行数值取整。", "solution": "在此确认问题陈述的有效性。该问题是偏微分方程数值方法稳定性分析领域一个适定的、有科学依据的练习，具体涉及分部求和-同步近似项 (SBP-SAT) 框架。所有给出的定义和已知条件都是标准的、自洽且一致的。因此，我们可以开始求解。\n\n我们的目标是确定半离散格式的罚系数 $\\sigma_L$ 和 $\\sigma_R$\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\n我们将使用能量法。离散能量定义为 $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$。我们要求解它的时间导数 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$。\n\n首先，我们用矩阵 $H$ 左乘半离散方程，得到：\n$$\nH\\,u_t + a\\,Q\\,u = \\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + \\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\n接下来，我们与解向量 $u(t)$ 做点积（即用 $u^{\\top}$ 左乘）：\n$$\nu^{\\top}H\\,u_t + a\\,u^{\\top}Q\\,u = \\sigma_L\\,u^{\\top}e_1\\left(g_L - u_1\\right) + \\sigma_R\\,u^{\\top}e_N\\left(g_R - u_N\\right).\n$$\n我们逐项分析。\n第一项与能量导数有关。由于 $H$ 是对称的且不随时间变化，我们有\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}u^{\\top}H\\,u\\right) = \\frac{1}{2}\\left(u_t^{\\top}H\\,u + u^{\\top}H\\,u_t\\right) = u^{\\top}H\\,u_t.\n$$\n第二项涉及矩阵 $Q$。利用 SBP 性质 $Q+Q^{\\top}=B$，二次型 $u^{\\top}Qu$ 可以表示为：\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q\\,u\\right) = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q^{\\top}u\\right) = \\frac{1}{2}u^{\\top}(Q+Q^{\\top})u = \\frac{1}{2}u^{\\top}B\\,u.\n$$\n代入 $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$ 并回想 $u_1 = e_1^{\\top}u$ 和 $u_N = e_N^{\\top}u$，我们得到：\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}u^{\\top}(-e_1 e_1^{\\top} + e_N e_N^{\\top})u = \\frac{1}{2}\\left(-(u^{\\top}e_1)(e_1^{\\top}u) + (u^{\\top}e_N)(e_N^{\\top}u)\\right) = \\frac{1}{2}\\left(-u_1^2 + u_N^2\\right).\n$$\n等式右边的项是 SAT 项。注意到 $u^{\\top}e_1 = u_1$ 和 $u^{\\top}e_N = u_N$，右边变为：\n$$\n\\sigma_L\\,u_1(g_L - u_1) + \\sigma_R\\,u_N(g_R - u_N) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\n综合这些结果，我们得到离散能量演化方程：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} + \\frac{a}{2}\\left(u_N^2 - u_1^2\\right) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\n重新整理，按边界对各项进行分组，我们有：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left( \\frac{a}{2}u_1^2 + \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 \\right) + \\left( -\\frac{a}{2}u_N^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2 \\right).\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left(\\frac{a}{2} - \\sigma_L\\right)u_1^2 + \\sigma_L\\,g_L u_1 - \\left(\\frac{a}{2} + \\sigma_R\\right)u_N^2 + \\sigma_R\\,g_R u_N.\n$$\n$\\sigma_L$ 和 $\\sigma_R$ 的选择取决于平流速度 $a$ 的符号，它决定了流入和流出边界。\n\n情况1：$a  0$。\n特征线从左向右传播。流入边界在 $x=0$（左边界），流出边界在 $x=1$（右边界）。\n物理边界条件在 $x=0$ 处给定，即 $u(0,t) = g_L(t)$。\n连续能量恒等式意味着能量流入为 $\\frac{a}{2}g_L^2$。为了与之匹配，我们分析 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的流入项：$(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$。为了满足半有界性，我们希望此项具有 $-\\text{耗散} + \\text{流入}$ 的形式。我们进行配方：\n$$\n-\\frac{a}{2}(u_1 - g_L)^2 + \\frac{a}{2}g_L^2 = -\\frac{a}{2}(u_1^2 - 2g_L u_1 + g_L^2) + \\frac{a}{2}g_L^2 = -\\frac{a}{2}u_1^2 + a\\,g_L u_1.\n$$\n将 $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$ 与 $-\\frac{a}{2}u_1^2 + a\\,g_L u_1$ 进行比较，我们令系数相等：\n- $u_1^2$ 的系数：$\\frac{a}{2} - \\sigma_L = -\\frac{a}{2} \\implies \\sigma_L = a$。\n- $g_L u_1$ 的系数：$\\sigma_L = a$。\n两个条件均由 $\\sigma_L = a$ 满足。\n在流出边界（$x=1$），没有给定数据。流出必须是耗散的。流出项为 $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R g_R u_N$。在没有外部数据的情况下，确保耗散性的最直接方法是将罚项设为零，这在 $\\sigma_R = 0$ 时发生。这些项随后简化为 $-\\frac{a}{2}u_N^2$，由于 $a0$，该项是非正的。\n因此，对于 $a0$，我们有 $\\sigma_L = a$ 和 $\\sigma_R = 0$。能量变化率变为 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{a}{2}(u_1-g_L)^2 + \\frac{a}{2}g_L^2 - \\frac{a}{2}u_N^2 \\le \\frac{a}{2}g_L^2$，这满足了要求。\n\n情况2：$a  0$。\n特征线从右向左传播。流入边界在 $x=1$（右边界），流出边界在 $x=0$（左边界）。\n物理边界条件在 $x=1$ 处，即 $u(1,t) = g_R(t)$。\n连续能量恒等式意味着能量流入为 $-\\frac{a}{2}g_R^2$。我们分析 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的流入项：$-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$。我们进行配方以匹配所需形式，并注意到 $a0$：\n$$\n\\frac{a}{2}(u_N - g_R)^2 - \\frac{a}{2}g_R^2 = \\frac{a}{2}(u_N^2 - 2g_R u_N + g_R^2) - \\frac{a}{2}g_R^2 = \\frac{a}{2}u_N^2 - a\\,g_R u_N.\n$$\n由于 $a0$，项 $\\frac{a}{2}(u_N-g_R)^2$ 是耗散的。将 $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$ 与 $\\frac{a}{2}u_N^2 - a\\,g_R u_N$ 进行比较：\n- $u_N^2$ 的系数：$-(\\frac{a}{2} + \\sigma_R) = \\frac{a}{2} \\implies -\\sigma_R = a \\implies \\sigma_R = -a$。\n- $g_R u_N$ 的系数：$\\sigma_R = -a$。\n两个条件均由 $\\sigma_R = -a$ 满足。\n在流出边界（$x=0$），我们要求耗散性。流出项为 $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$。设置 $\\sigma_L=0$ 可消除罚项，这些项简化为 $\\frac{a}{2}u_1^2$，由于 $a0$，该项是非正的。\n因此，对于 $a0$，我们有 $\\sigma_L = 0$ 和 $\\sigma_R = -a$。能量变化率变为 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{a}{2}u_1^2 + \\frac{a}{2}(u_N-g_R)^2 - \\frac{a}{2}g_R^2 \\le -\\frac{a}{2}g_R^2$，满足了要求。\n\n情况3：$a = 0$。\n偏微分方程为 $u_t=0$。不需要边界条件。该格式在没有罚项的情况下应该是稳定的。流入和流出分析都表明相应的系数为零。对于 $a=0$，有 $\\sigma_L=a=0$ 和 $\\sigma_R=0$（来自 $a0$ 的情况），以及 $\\sigma_L=0$ 和 $\\sigma_R=-a=0$（来自 $a0$ 的情况）。两者一致。因此，$\\sigma_L=0, \\sigma_R=0$。\n\n我们可以将这些结果统一成一个适用于任何 $a \\in \\mathbb{R}$ 的单一表达式。\n对于 $\\sigma_L$：当 $a0$ 时，$\\sigma_L=a$；当 $a \\le 0$ 时，$\\sigma_L=0$。这可以写作 $\\sigma_L = \\max(a, 0) = \\frac{a+|a|}{2}$。\n对于 $\\sigma_R$：当 $a0$ 时，$\\sigma_R=0$；当 $a \\le 0$ 时，$\\sigma_R=-a$。注意，如果 $a0$，则 $-a = |a|$。这可以写作 $\\sigma_R = \\max(-a, 0) = \\frac{-a+|a|}{2}$。\n\n因此，罚系数由以下表达式给出：\n$$\n\\sigma_L = \\frac{a+|a|}{2} \\quad \\text{和} \\quad \\sigma_R = \\frac{-a+|a|}{2}.\n$$\n这些是线性平流方程 SBP-SAT 格式的标准迎风罚系数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{a+|a|}{2}  \\frac{-a+|a|}{2}\n\\end{pmatrix}\n}\n$$", "id": "3384333"}, {"introduction": "一个稳定的半离散格式（空间离散）并不能保证全离散格式（空间和时间离散）的稳定性；时间积分方法的选择同样至关重要。本练习将我们的注意力从空间转向时间，分析应用于波动方程的经典蛙跳格式（leapfrog scheme）。我们将推导一个离散能量不变量，并利用它来确定著名的Courant–Friedrichs–Lewy（CFL）稳定性条件，该条件联系了时间步长、空间步长和波速。此外，我们还将分析蛙跳格式的一个固有特性——寄生模式（parasitic modes），理解其来源和对数值解的影响[@problem_id:3384336]。", "problem": "考虑一个 $d$ 维周期性域上的常系数波动方程，该方程在空间上通过标准的二阶中心有限差分拉普拉斯算子进行离散。令 $h$ 表示每个坐标方向上的均匀网格间距，令 $L_h$ 为作用于网格函数的离散拉普拉斯算子，其具有以下性质：$L_h$ 在离散 $\\ell^2$ 内积下是对称的，并且在周期性边界条件下是负半定的。半离散波动方程的形式为\n$$\nu_{tt}(t) = c^2 L_h u(t),\n$$\n其中 $c0$ 是波速，$u(t)$ 是一个依赖于时间 $t$ 的网格函数。\n\n您对 $u(t)$ 应用显式的两步时间中心（蛙跳）更新格式，\n$$\nu^{n+1} - 2 u^n + u^{n-1} = c^2 \\Delta t^2 L_h u^n,\n$$\n其中时间步长为 $\\Delta t$，网格函数 $u^n \\approx u(n\\,\\Delta t)$。\n\n您的任务是：\n\n1) 仅从 $L_h$ 的对称性和负半定性以及时间步进递推的结构出发，推导一个离散能量 $\\mathcal{E}^{n+\\frac{1}{2}}$，该能量在周期性网格上的上述更新格式下对 $n$ 精确保守。您的推导必须明确使用离散 $\\ell^2$ 内积和对 $n$ 构成伸缩和的代数恒等式。\n\n2) 使用推导出的不变量，建立一个严格条件，在该条件下 $\\mathcal{E}^{n+\\frac{1}{2}}$ 是正定的，并能一致地控制半离散波动方程的物理能量。将此条件具体应用到 $d$ 维空间中的周期性中心差分拉普拉斯算子，已知其谱半径满足\n$$\n\\max_{\\xi} \\lambda_{\\max}(-L_h) = \\frac{4d}{h^2},\n$$\n并将得到的 Courant–Friedrichs–Lewy (CFL) 界限表示为关于 $d$ 的无量纲数 $\\sigma \\equiv \\dfrac{c\\,\\Delta t}{h}$ 的一个严格限制。\n\n3) 为评估蛙跳时间积分固有的寄生模式，请分析通过将半离散波动方程的一阶哈密顿形式投影到单个傅里叶-拉普拉斯特征模上得到的标量线性测试方程。具体来说，考虑 $y_t = i \\omega y$（其中 $\\omega \\ge 0$）并应用蛙跳更新 $y^{n+1} = y^{n-1} + 2 \\Delta t i \\omega y^n$。推导两个放大因子的闭式解，并在 $\\omega\\,\\Delta t \\to 0$ 的极限下，指出哪个是寄生计算模式，以及它在时间上如何表现。\n\n只需报告您在第 2 部分中得到的 $\\sigma$ 的严格上界表达式作为最终答案。不需要单位，也无需四舍五入，因为答案是精确的。", "solution": "该问题要求为应用于半离散波动方程的蛙跳格式推导一个守恒的离散能量，推导相关的稳定性条件（CFL 条件），并分析蛙跳格式的寄生模式。最终答案是 Courant 数 $\\sigma$ 的严格上界。\n\n### 第 1 部分：守恒离散能量的推导\n\n将在 $d$ 维周期性网格上的两个网格函数 $u$ 和 $v$ 的离散 $\\ell^2$ 内积表示为 $\\langle u, v \\rangle$，其关联的范数为 $\\|u\\|^2 = \\langle u, u \\rangle$。问题指出，离散拉普拉斯算子 $L_h$ 在此内积下是对称的，即 $\\langle L_h u, v \\rangle = \\langle u, L_h v \\rangle$，并且是负半定的，即对于任何网格函数 $u$，都有 $\\langle L_h u, u \\rangle \\le 0$。\n\n蛙跳时间步进格式由下式给出\n$$\nu^{n+1} - 2u^n + u^{n-1} = c^2 \\Delta t^2 L_h u^n.\n$$\n为了找到一个守恒量，我们寻找总能量的离散模拟，总能量是动能和势能之和。我们将半整数时间步 $n+\\frac{1}{2}$ 处的离散能量定义为\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2} \\left\\| \\frac{u^{n+1} - u^n}{\\Delta t} \\right\\|^2 - \\frac{c^2}{2} \\langle L_h u^{n+1}, u^n \\rangle.\n$$\n第一项是离散动能，第二项是离散势能。我们现在证明这个量是精确保守的，即对于所有 $n \\ge 1$，都有 $\\mathcal{E}^{n+\\frac{1}{2}} = \\mathcal{E}^{n-\\frac{1}{2}}$。\n\n我们来计算从时间步 $n-\\frac{1}{2}$ 到 $n+\\frac{1}{2}$ 的能量变化：\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = \\left( \\frac{1}{2} \\left\\| \\frac{u^{n+1} - u^n}{\\Delta t} \\right\\|^2 - \\frac{1}{2} \\left\\| \\frac{u^n - u^{n-1}}{\\Delta t} \\right\\|^2 \\right) - \\frac{c^2}{2} \\left( \\langle L_h u^{n+1}, u^n \\rangle - \\langle L_h u^n, u^{n-1} \\rangle \\right).\n$$\n我们首先分析动能项。使用代数恒等式 $\\|A\\|^2 - \\|B\\|^2 = \\langle A-B, A+B \\rangle$，并令 $A = u^{n+1} - u^n$ 和 $B = u^n - u^{n-1}$，我们得到\n\\begin{align*}\n\\frac{1}{2\\Delta t^2} \\left( \\|u^{n+1} - u^n\\|^2 - \\|u^n - u^{n-1}\\|^2 \\right) = \\frac{1}{2\\Delta t^2} \\langle (u^{n+1} - u^n) - (u^n - u^{n-1}), (u^{n+1} - u^n) + (u^n - u^{n-1}) \\rangle \\\\\n= \\frac{1}{2\\Delta t^2} \\langle u^{n+1} - 2u^n + u^{n-1}, u^{n+1} - u^{n-1} \\rangle.\n\\end{align*}\n现在，我们将蛙跳格式 $u^{n+1} - 2u^n + u^{n-1} = c^2 \\Delta t^2 L_h u^n$ 代入此表达式：\n$$\n\\frac{1}{2\\Delta t^2} \\langle c^2 \\Delta t^2 L_h u^n, u^{n+1} - u^{n-1} \\rangle = \\frac{c^2}{2} \\langle L_h u^n, u^{n+1} - u^{n-1} \\rangle = \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^n, u^{n-1} \\rangle).\n$$\n将此结果代回总能量变化的表达式中，得到\n\\begin{align*}\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^n, u^{n-1} \\rangle) - \\frac{c^2}{2} (\\langle L_h u^{n+1}, u^n \\rangle - \\langle L_h u^n, u^{n-1} \\rangle) \\\\\n= \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^{n+1}, u^n \\rangle).\n\\end{align*}\n利用算子 $L_h$ 的对称性，我们有 $\\langle L_h u^n, u^{n+1} \\rangle = \\langle u^n, L_h u^{n+1} \\rangle = \\langle L_h u^{n+1}, u^n \\rangle$。因此，这两项相互抵消：\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = 0.\n$$\n这证实了 $\\mathcal{E}^{n+\\frac{1}{2}}$ 是该格式的一个精确保守量。\n\n### 第 2 部分：稳定性（CFL）条件\n\n为使数值格式稳定，守恒能量 $\\mathcal{E}^{n+\\frac{1}{2}}$ 必须是解状态的一个正定（或半正定）二次型，这确保了解的范数不随时间增长。时间 $n$ 的状态可以用对 $(u^{n+1}, u^n)$ 来描述。我们需要找到在何种条件下对于任何状态都有 $\\mathcal{E}^{n+\\frac{1}{2}} \\ge 0$。\n\n我们使用极化恒等式 $\\langle Ax, y \\rangle = \\frac{1}{4}(\\langle A(x+y), x+y \\rangle - \\langle A(x-y), x-y \\rangle)$ 来重写势能项，该恒等式对任何对称算子 $A$ 都成立。令 $A=L_h$，$x=u^{n+1}$ 和 $y=u^n$：\n$$\n\\langle L_h u^{n+1}, u^n \\rangle = \\frac{1}{4} \\left( \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle - \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right).\n$$\n将此代入能量表达式中：\n\\begin{align*}\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2\\Delta t^2} \\|u^{n+1} - u^n\\|^2 - \\frac{c^2}{8} \\left( \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle - \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right) \\\\\n= \\left( \\frac{1}{2\\Delta t^2} \\|u^{n+1} - u^n\\|^2 + \\frac{c^2}{8} \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right) - \\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle.\n\\end{align*}\n我们来对各项进行分组。该表达式可以重写为：\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2} \\left\\langle \\left( \\frac{1}{\\Delta t^2}I + \\frac{c^2}{4}L_h \\right) (u^{n+1}-u^n), u^{n+1}-u^n \\right\\rangle - \\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle.\n$$\n第二项 $-\\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle$ 是非负的，因为 $L_h$ 是负半定的（对于任何 $v$ 都有 $\\langle L_h v, v \\rangle \\le 0$）。为了使 $\\mathcal{E}^{n+1/2}$ 为非负，第一项也必须是非负的。这要求算子 $A = \\frac{1}{\\Delta t^2}I + \\frac{c^2}{4}L_h$ 是半正定的。\n\n一个算子是半正定的，当且仅当其所有特征值都是非负的。令 $\\lambda_k$ 为 $L_h$ 的一个特征值。由于 $L_h$ 是负半定的，所以 $\\lambda_k \\le 0$。$A$ 的相应特征值为 $\\mu_k = \\frac{1}{\\Delta t^2} + \\frac{c^2}{4}\\lambda_k$。条件 $\\mu_k \\ge 0$ 必须对所有 $k$ 成立。\n$$\n\\frac{1}{\\Delta t^2} + \\frac{c^2}{4}\\lambda_k \\ge 0 \\implies 1 + \\frac{c^2 \\Delta t^2}{4}\\lambda_k \\ge 0.\n$$\n这个不等式必须对所有特征值 $\\lambda_k$ 都满足。最严格的情况对应于最负的特征值，即 $\\lambda_{\\min} = \\min_k \\lambda_k$。条件变为：\n$$\n1 + \\frac{c^2 \\Delta t^2}{4}\\lambda_{\\min} \\ge 0 \\implies 1 \\ge -\\frac{c^2 \\Delta t^2}{4}\\lambda_{\\min} \\implies \\frac{c^2 \\Delta t^2}{4} (-\\lambda_{\\min}) \\le 1.\n$$\n量 $-\\lambda_{\\min}$ 是半正定算子 $-L_h$ 的最大特征值，也就是它的谱半径 $\\rho(-L_h)$。因此，稳定性条件是：\n$$\nc^2 \\Delta t^2 \\rho(-L_h) \\le 4.\n$$\n问题给出了在周期性边界条件下，标准的 $d$ 维中心有限差分拉普拉斯算子的谱半径：$\\rho(-L_h) = \\frac{4d}{h^2}$。将此代入我们的稳定性条件：\n$$\nc^2 \\Delta t^2 \\left(\\frac{4d}{h^2}\\right) \\le 4 \\implies \\frac{c^2 \\Delta t^2}{h^2} d \\le 1.\n$$\n定义无量纲的 Courant 数 $\\sigma \\equiv \\frac{c\\,\\Delta t}{h}$，条件变为 $\\sigma^2 d \\le 1$。由于 $\\sigma \\ge 0$，这得出了严格的 CFL 条件：\n$$\n\\sigma \\le \\frac{1}{\\sqrt{d}}.\n$$\n$\\sigma$ 的严格上界是 $\\frac{1}{\\sqrt{d}}$。\n\n### 第 3 部分：寄生模式分析\n\n我们分析应用于测试方程 $y_t = i\\omega y$（其中 $\\omega \\ge 0$）的蛙跳格式。给定的更新格式为\n$$\ny^{n+1} = y^{n-1} + 2 \\Delta t i \\omega y^n.\n$$\n这可以重写为一个线性齐次递推关系：$y^{n+1} - (2i\\omega\\Delta t)y^n - y^{n-1} = 0$。为了找到放大因子，我们寻找形式为 $y^n = g^n$ 的解，这导出了关于 $g$ 的特征方程：\n$$\ng^2 - (2i\\omega\\Delta t)g - 1 = 0.\n$$\n令 $p = \\omega\\Delta t$。方程为 $g^2 - 2ipg - 1 = 0$。使用二次公式求解 $g$：\n$$\ng = \\frac{2ip \\pm \\sqrt{(-2ip)^2 - 4(1)(-1)}}{2} = \\frac{2ip \\pm \\sqrt{-4p^2 + 4}}{2} = ip \\pm \\sqrt{1-p^2}.\n$$\n两个放大因子是 $g_1 = ip + \\sqrt{1-p^2}$ 和 $g_2 = ip - \\sqrt{1-p^2}$。\n\n为了区分物理模式和寄生模式，我们考察它们在 $\\omega\\Delta t \\to 0$（即 $p \\to 0$）极限下的行为。我们使用对于小 $p$ 的泰勒展开式 $\\sqrt{1-p^2} \\approx 1 - \\frac{1}{2}p^2$。\n\n对于第一个根 $g_1$：\n$$\ng_1 \\approx ip + \\left(1 - \\frac{1}{2}p^2\\right) = 1 + ip - \\frac{1}{2}p^2.\n$$\n对于常微分方程 $y_t=i\\omega y$ 在一个时间步长 $\\Delta t$ 内的精确放大因子是 $\\exp(i\\omega\\Delta t) = \\exp(ip)$。其泰勒展开式为 $\\exp(ip) = 1 + ip + \\frac{(ip)^2}{2!} + \\dots = 1 + ip - \\frac{1}{2}p^2 + O(p^3)$。由于 $g_1$ 与真实放大因子的展开式匹配到二阶，所以 $g_1$ 是物理模式。\n\n对于第二个根 $g_2$：\n$$\ng_2 \\approx ip - \\left(1 - \\frac{1}{2}p^2\\right) = -1 + ip + \\frac{1}{2}p^2.\n$$\n在极限 $p \\to 0$ 下，$g_2 \\to -1$。这个模式不对应于原始微分方程的解，因此是寄生计算模式。它的存在意味着任何数值解通常都是物理模式和这种寄生模式的叠加。由于 $g_2 \\approx -1$，解的寄生分量表现得像 $C_2 (g_2)^n \\approx C_2 (-1)^n$，其中 $C_2$ 是一个常数。这在时间上表现为一种高频数值振荡，在每个时间步都改变符号，并叠加在物理上正确的解之上。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{d}}}$$", "id": "3384336"}]}