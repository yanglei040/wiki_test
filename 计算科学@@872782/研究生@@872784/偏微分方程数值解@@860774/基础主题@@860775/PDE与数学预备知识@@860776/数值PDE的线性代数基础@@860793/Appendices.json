{"hands_on_practices": [{"introduction": "一维离散拉普拉斯算子是数值偏微分方程领域中的一个基石。本练习将从第一性原理出发，推导该矩阵的完整谱结构（特征值和特征向量），并揭示其与离散正弦变换之间的深刻联系 [@problem_id:3416297]。掌握这一核心分析，对于理解数值方法的稳定性、收敛性以及快速傅里叶变换（FFT）求解器的构造至关重要。", "problem": "考虑开区间 $(0,1)$ 上的一个均匀网格，其上有 $N$ 个内点，位置为 $x_{j} = j h$，其中 $j \\in \\{1,2,\\dots,N\\}$，$h = \\frac{1}{N+1}$。施加齐次狄利克雷边界条件，使得网格函数 $v = (v_{1},\\dots,v_{N})^{\\top} \\in \\mathbb{R}^{N}$ 在端点处满足 $v_{0} = 0$ 和 $v_{N+1} = 0$。定义一维狄利克雷离散拉普拉斯算子 $A \\in \\mathbb{R}^{N \\times N}$，其作用为\n$$\n(A v)_{j} = 2 v_{j} - v_{j-1} - v_{j+1}, \\quad j \\in \\{1,2,\\dots,N\\},\n$$\n约定 $v_{0} = 0$ 和 $v_{N+1} = 0$。等价地，$A$ 是一个对称三对角托普利茨矩阵，其元素为 $A_{j j} = 2$ 和 $A_{j, j\\pm 1} = -1$。这是负二阶导数在狄利克雷边界条件下的中心二阶有限差分近似的矩阵表示，为了简化，它已乘以因子 $h^2$。\n\n从特征值和特征向量的基本定义以及上述有限差分模型出发，执行以下步骤：\n\n1. 通过求解 $A v = \\lambda v$ 来推导 $A$ 的特征对 $(\\lambda_{k}, v^{(k)})$。仅使用由三对角结构和边界条件所蕴含的递推关系来确定允许的离散模式和相应的特征值。证明特征向量是离散正弦模式，并确定允许的波数。将特征向量归一化以形成一个标准正交族。\n\n2. 将标准正交特征向量组装成一个矩阵 $Q \\in \\mathbb{R}^{N \\times N}$，并构成对角矩阵 $\\Lambda = \\operatorname{diag}(\\lambda_{1},\\dots,\\lambda_{N})$。利用对称矩阵和标准正交特征向量的性质，将 $A$ 显式地对角化为 $A = Q \\Lambda Q^{\\top}$。通过写出 $Q$ 的元素，将其与离散正弦变换 (DST) 联系起来。\n\n3. 利用对角化和适当的三角函数乘积恒等式，计算 $A$ 的精确行列式 $\\det(A)$，结果表示为关于 $N$ 的闭式解析表达式。\n\n以 $\\det(A)$ 的单个闭式解析表达式的形式提供最终答案，不带单位。不要四舍五入；需要精确表达式。", "solution": "该问题要求推导离散拉普拉斯矩阵 $A$ 的特征对、对其进行对角化，并随后计算其行列式。我们将通过求解由特征值问题产生的递推关系来着手。\n\n矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 通过其对向量 $v \\in \\mathbb{R}^{N}$ 的作用来定义，即 $(A v)_{j} = 2 v_{j} - v_{j-1} - v_{j+1}$，其中 $j=1, \\dots, N$，边界条件为 $v_{0}=0$ 和 $v_{N+1}=0$。\n\n**1. 推导特征对 $(\\lambda_{k}, v^{(k)})$}\n\n特征值问题是 $A v = \\lambda v$。对于每个分量 $j$，这可以转化为：\n$$\n2 v_{j} - v_{j-1} - v_{j+1} = \\lambda v_{j}\n$$\n整理各项，我们得到关于特征向量 $v$ 的分量 $v_j$ 的一个二阶线性齐次递推关系：\n$$\nv_{j+1} - (2 - \\lambda) v_{j} + v_{j-1} = 0, \\quad \\text{for } j=1, \\dots, N\n$$\n其边界条件为 $v_0 = 0$ 和 $v_{N+1} = 0$。\n\n我们寻求 $v_j = r^j$ 形式的解。将此代入递推关系，得到特征方程：\n$$\nr^2 - (2-\\lambda)r + 1 = 0\n$$\n其根由二次求根公式给出：$r_{1,2} = \\frac{(2-\\lambda) \\pm \\sqrt{(2-\\lambda)^2 - 4}}{2}$。\n由于 $A$ 是实对称矩阵，其特征值 $\\lambda$ 必须是实数。我们可以根据判别式 $\\Delta = (2-\\lambda)^2 - 4$ 来分析根的性质。\n如果 $\\Delta \\geq 0$，则根 $r_1, r_2$ 为实数。通解为 $v_j = c_1 r_1^j + c_2 r_2^j$。条件 $v_0=0$ 意味着 $c_1+c_2=0$，因此 $v_j = c_1(r_1^j - r_2^j)$。条件 $v_{N+1}=0$ 意味着 $c_1(r_1^{N+1} - r_2^{N+1})=0$。由于 $r_1r_2=1$，且当 $\\Delta>0$ 时我们有 $|r_1| \\neq |r_2|$，这将导致 $c_1=0$，从而得到平凡解 $v=0$。对于 $\\Delta=0$ 的情况，$\\lambda=0$ 或 $\\lambda=4$，且 $r_1=r_2=\\pm 1$，在给定的边界条件下，这同样会导致平凡解。\n\n因此，我们必须有 $\\Delta  0$，这意味着 $(2-\\lambda)^2  4$，即 $0  \\lambda  4$。在这种情况下，根是一对共轭复数。我们定义一个角度 $\\theta$ 使得 $2-\\lambda = 2\\cos(\\theta)$。对于 $0  \\lambda  4$ 这是始终可能的。根变为：\n$$\nr_{1,2} = \\cos(\\theta) \\pm i \\sin(\\theta) = e^{\\pm i\\theta}\n$$\n$v_j$ 的通解是 $(e^{i\\theta})^j$ 和 $(e^{-i\\theta})^j$ 的线性组合：\n$$\nv_j = c_1 e^{ij\\theta} + c_2 e^{-ij\\theta}\n$$\n应用第一个边界条件 $v_0 = 0$：\n$$\nv_0 = c_1 e^0 + c_2 e^0 = c_1 + c_2 = 0 \\implies c_2 = -c_1\n$$\n这可将解简化为：\n$$\nv_j = c_1(e^{ij\\theta} - e^{-ij\\theta}) = 2i c_1 \\sin(j\\theta)\n$$\n这表明特征向量是离散正弦模式。设 $C = 2i c_1$ 为任意常数。则 $v_j = C \\sin(j\\theta)$。\n\n现在，我们应用第二个边界条件 $v_{N+1}=0$：\n$$\nv_{N+1} = C \\sin((N+1)\\theta) = 0\n$$\n对于非平凡特征向量，我们要求 $C \\neq 0$，这意味着 $\\sin((N+1)\\theta) = 0$。这个条件对 $\\theta$ 的可能值进行了量化：\n$$\n(N+1)\\theta = k\\pi \\implies \\theta_k = \\frac{k\\pi}{N+1}\n$$\n其中 $k$ 为某个整数。$k=1, 2, \\dots, N$ 这些值会产生不同的非平凡特征向量。当 $k=0$ 或 $k=N+1$ 时，对所有的 $j$ 都有 $\\sin(j\\theta_k)=0$，从而得到零向量。其他整数 $k$ 值产生的特征向量要么与 $k \\in \\{1, \\dots, N\\}$ 的特征向量相同，要么是其标量倍数。因此，我们有与 $k=1, 2, \\dots, N$ 对应的 $N$ 个不同的特征向量。\n\n特征值 $\\lambda_k$ 由相应的 $\\theta_k$ 确定：\n$$\n\\lambda_k = 2 - 2\\cos(\\theta_k) = 2 - 2\\cos\\left(\\frac{k\\pi}{N+1}\\right)\n$$\n使用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$，我们得到：\n$$\n\\lambda_k = 4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right), \\quad k=1, 2, \\dots, N\n$$\n相应的未归一化特征向量 $v^{(k)}$ 的分量是：\n$$\nv_j^{(k)} = \\sin\\left(j\\theta_k\\right) = \\sin\\left(\\frac{jk\\pi}{N+1}\\right), \\quad j=1, 2, \\dots, N\n$$\n\n为了归一化这些特征向量，我们要求它们的欧几里得范数为 1。我们计算范数的平方：\n$$\n\\sum_{j=1}^{N} \\left(v_j^{(k)}\\right)^2 = \\sum_{j=1}^{N} \\sin^2\\left(\\frac{jk\\pi}{N+1}\\right)\n$$\n使用恒等式 $\\sin^2(x) = \\frac{1}{2}(1-\\cos(2x))$，该和变为：\n$$\n\\sum_{j=1}^{N} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2jk\\pi}{N+1}\\right)\\right) = \\frac{N}{2} - \\frac{1}{2} \\sum_{j=1}^{N} \\cos\\left(\\frac{2jk\\pi}{N+1}\\right)\n$$\n余弦和可以通过考虑复指数的等比级数 $\\sum_{j=1}^{N} z^j$ 来求值，其中 $z = \\exp\\left(i \\frac{2k\\pi}{N+1}\\right)$。由于 $k \\in \\{1, \\dots, N\\}$，所以 $z \\neq 1$。级数和为 $\\sum_{j=1}^{N} z^j = z \\frac{1-z^N}{1-z}$。由于 $z^{N+1}=1$，我们有 $z^N = z^{-1}$。级数和为 $z \\frac{1-z^{-1}}{1-z} = \\frac{z-1}{1-z}=-1$。因此，$\\sum_{j=1}^{N} \\cos\\left(\\frac{2jk\\pi}{N+1}\\right) = \\operatorname{Re}(-1) = -1$。\n因此，范数的平方为 $\\frac{N}{2} - \\frac{1}{2}(-1) = \\frac{N+1}{2}$。\n归一化常数是 $\\sqrt{\\frac{2}{N+1}}$。标准正交特征向量 $v^{(k)}$ 的分量是：\n$$\nv_j^{(k)} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{jk\\pi}{N+1}\\right), \\quad j,k = 1, \\dots, N\n$$\n\n**2. A 的对角化**\n\n我们将标准正交特征向量 $v^{(k)}$ 作为列组装成一个矩阵 $Q \\in \\mathbb{R}^{N \\times N}$：\n$$\nQ_{jk} = (v^{(k)})_j = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{jk\\pi}{N+1}\\right)\n$$\n特征值矩阵 $\\Lambda$ 是对角矩阵 $\\Lambda = \\operatorname{diag}(\\lambda_1, \\dots, \\lambda_N)$，其中\n$$\n\\Lambda_{kk} = \\lambda_k = 4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)\n$$\n对于 $k=1, \\dots, N$ 的一组特征值方程 $A v^{(k)} = \\lambda_k v^{(k)}$ 可以写成矩阵形式 $A Q = Q \\Lambda$。\n由于 $A$ 是一个实对称矩阵，其特征向量构成一个标准正交基。因此，以这些标准正交特征向量为列的矩阵 $Q$ 是一个正交矩阵，满足 $Q^{\\top}Q = I$，这意味着 $Q^{-1}=Q^{\\top}$。\n在 $A Q = Q \\Lambda$ 的右侧乘以 $Q^{\\top}$，我们得到 $A Q Q^{\\top} = Q \\Lambda Q^{\\top}$，简化后即为 $A = Q \\Lambda Q^{\\top}$。这就是 $A$ 的谱分解（对角化）。\n\n$Q$ 的元素是 $Q_{jk} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{jk\\pi}{N+1}\\right)$。根据定义，这个矩阵是一型离散正弦变换 (DST-I) 的矩阵。缩放因子确保了该变换是正交的（对合的）。注意 $Q$ 是一个对称矩阵，即 $Q = Q^{\\top}$。\n\n**3. 计算 $\\det(A)$**\n\n利用性质 $\\det(XY) = \\det(X)\\det(Y)$ 和 $\\det(X^{\\top}) = \\det(X)$，我们可以从 $A$ 的对角化计算其行列式：\n$$\n\\det(A) = \\det(Q \\Lambda Q^{\\top}) = \\det(Q) \\det(\\Lambda) \\det(Q^{\\top}) = \\det(\\Lambda) (\\det(Q))^2\n$$\n由于 $Q$ 是正交的，所以 $Q Q^{\\top}=I$，因此 $\\det(Q Q^{\\top})=\\det(Q)\\det(Q^{\\top})=(\\det(Q))^2 = \\det(I)=1$。\n因此，$\\det(A) = \\det(\\Lambda)$。\n对角矩阵 $\\Lambda$ 的行列式是其对角元素的乘积：\n$$\n\\det(A) = \\prod_{k=1}^{N} \\lambda_k = \\prod_{k=1}^{N} 4\\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)\n$$\n我们可以将因子 $4$ 提出：\n$$\n\\det(A) = 4^N \\left( \\prod_{k=1}^{N} \\sin\\left(\\frac{k\\pi}{2(N+1)}\\right) \\right)^2\n$$\n为了计算正弦的乘积，我们使用一个著名的恒等式：\n$$\n\\prod_{k=1}^{m-1} \\sin\\left(\\frac{k\\pi}{m}\\right) = \\frac{m}{2^{m-1}}\n$$\n我们设 $m = 2(N+1)$。我们乘积中正弦函数的参数是 $\\frac{k\\pi}{m}$。设 $P = \\prod_{k=1}^{N} \\sin\\left(\\frac{k\\pi}{m}\\right)$。该恒等式涉及一个乘到 $m-1 = 2N+1$ 的连乘积。我们将我们的乘积与该恒等式联系起来：\n$$\n\\frac{m}{2^{m-1}} = \\prod_{k=1}^{2N+1} \\sin\\left(\\frac{k\\pi}{m}\\right) = \\left(\\prod_{k=1}^{N} \\sin\\left(\\frac{k\\pi}{m}\\right)\\right) \\cdot \\sin\\left(\\frac{(N+1)\\pi}{m}\\right) \\cdot \\left(\\prod_{k=N+2}^{2N+1} \\sin\\left(\\frac{k\\pi}{m}\\right)\\right)\n$$\n中间项是 $\\sin\\left(\\frac{(N+1)\\pi}{2(N+1)}\\right) = \\sin(\\pi/2) = 1$。\n对于最后一项，我们使用恒等式 $\\sin(\\pi-x)=\\sin(x)$。设 $j=m-k$。当 $k$ 从 $N+2$ 取到 $2N+1$ 时，$j$ 从 $N$ 向下取到 $1$。\n$$\n\\sin\\left(\\frac{k\\pi}{m}\\right) = \\sin\\left(\\frac{(m-j)\\pi}{m}\\right) = \\sin\\left(\\pi - \\frac{j\\pi}{m}\\right) = \\sin\\left(\\frac{j\\pi}{m}\\right)\n$$\n因此，最后一个乘积等于第一个乘积：$\\prod_{k=N+2}^{2N+1} \\sin\\left(\\frac{k\\pi}{m}\\right) = P$。\n我们得到 $\\frac{m}{2^{m-1}} = P \\cdot 1 \\cdot P = P^2$。\n代入 $m=2(N+1)$：\n$$\nP^2 = \\frac{2(N+1)}{2^{2(N+1)-1}} = \\frac{2(N+1)}{2^{2N+1}} = \\frac{N+1}{2^{2N}}\n$$\n最后，我们将此结果代回到行列式的表达式中：\n$$\n\\det(A) = 4^N \\cdot P^2 = (2^2)^N \\cdot \\frac{N+1}{2^{2N}} = 2^{2N} \\frac{N+1}{2^{2N}} = N+1\n$$\n$N \\times N$ 离散拉普拉斯矩阵的行列式就是 $N+1$。", "answer": "$$\\boxed{N+1}$$", "id": "3416297"}, {"introduction": "在使用有限元方法时，离散后得到的刚度矩阵的代数性质（如对称正定性）应当忠实地反映连续变分形式的内在属性。本练习通过一个精心设计的思想实验，探讨了不恰当的数值积分（求积）法则如何破坏这种一致性，从而导致刚度矩阵失去对称性 [@problem_id:3416264]。这个过程清晰地揭示了，从连续到离散的转化过程中，每一个实现细节都可能对最终线性系统的基本结构产生深远影响。", "problem": "考虑在区间 $\\Omega = (0,1)$ 上的标量扩散问题，带有齐次狄利克雷边界条件：求 $u \\in H_{0}^{1}(\\Omega)$ 使得\n$$\n- \\frac{d}{dx}\\!\\left(\\beta(x)\\, \\frac{du}{dx}\\right) = f(x) \\quad \\text{在 } \\Omega \\text{ 中}, \\quad u(0)=u(1)=0,\n$$\n其中扩散系数为 $\\beta(x) = 1 + \\rho\\, x$，$\\rho > 0$ 是一个固定参数。其变分形式为：求 $u \\in H_{0}^{1}(\\Omega)$ 使得对于所有 $v \\in H_{0}^{1}(\\Omega)$，\n$$\na(u,v) := \\int_{0}^{1} \\beta(x)\\, u'(x)\\, v'(x)\\, dx = \\ell(v),\n$$\n其中 $\\ell$ 是一个给定的线性泛函。\n\n使用连续分段仿射（线性）有限元（FE）在节点为 $x_{0}=0$、$x_{1}=\\frac{1}{3}$、$x_{2}=\\frac{2}{3}$、$x_{3}=1$ 的均匀网格上对该变分问题进行离散化。强加边界条件，因此全局系统涉及两个内部基函数 $\\{\\varphi_{1},\\varphi_{2}\\}$。在对 $a(\\cdot,\\cdot)$ 进行精确积分的情况下，刚度矩阵是对称正定的。\n\n现在通过引入一种非一致求积来修改组装过程，该求积以下述精确方式破坏对称性：对于每个对应于测试函数 $\\varphi_{i}$ 和试探函数 $\\varphi_{j}$ 的指标对 $(i,j)$，通过在测试函数节点处计算系数并将导数乘积的积分保持精确来近似单元积分。具体来说，将组装的矩阵元素定义为\n$$\nK_{ij} := \\sum_{K} \\beta(x_{i}) \\int_{K} \\varphi_{i}'(x)\\, \\varphi_{j}'(x)\\, dx,\n$$\n其中，根据有限元支撑域的规定，对于行 $i=1$，求和遍及两个单元 $K=[x_{0},x_{1}] \\cup [x_{1},x_{2}]$；对于行 $i=2$，求和遍及 $K=[x_{1},x_{2}] \\cup [x_{2},x_{3}]$。\n\n从 Galerkin 方法和有限元基函数的第一性原理出发：\n\n- 推导在该网格上 $\\beta \\equiv 1$ 时的精确（对称）刚度矩阵。\n- 证明在上述非一致求积下，得到的矩阵形式为 $K(\\rho) = D(\\rho)\\, S$，其中 $S$ 是 $\\beta \\equiv 1$ 时的精确刚度矩阵，而 $D(\\rho)$ 是一个依赖于 $\\rho$ 的正定对角矩阵。\n- 从代数上解释为什么用 $D(\\rho)$ 进行左缩放会破坏对称性，从而破坏对称正定（SPD）结构，尽管每个因子在适当的意义下都是正定的。\n\n最后，以 $\\rho$ 的函数形式，计算 $2 \\times 2$ 矩阵 $K(\\rho)$ 的最小特征值 $\\lambda_{\\min}(\\rho)$ 的闭合形式解。以 $\\rho$ 的单个解析表达式形式给出答案，不带单位。不要对结果进行近似或四舍五入。", "solution": "我们从变分形式 $a(u,v) = \\int_{0}^{1} \\beta(x)\\, u'(x)\\, v'(x)\\, dx$ 以及与内部节点 $x_{1}=\\frac{1}{3}$ 和 $x_{2}=\\frac{2}{3}$ 相关联的、使用连续分段仿射有限元（FE）基函数 $\\{\\varphi_{i}\\}$ 的标准 Galerkin 离散化开始。网格是均匀的，间距为 $h = \\frac{1}{3}$，并且有三个单元：$[x_{0},x_{1}]$, $[x_{1},x_{2}]$, $[x_{2},x_{3}]$。\n\n一维均匀网格上线性有限元的基本事实：\n\n- 在长度为 $h$ 的单元 $K=[x_{k},x_{k+1}]$ 上，对于模型系数 $\\beta \\equiv 1$ 的局部刚度是一个 $2 \\times 2$ 矩阵\n$$\n\\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix},\n$$\n这是由精确积分 $\\int_{K} \\varphi_{k}' \\varphi_{k}'\\, dx = \\frac{1}{h}$，$\\int_{K} \\varphi_{k}' \\varphi_{k+1}'\\, dx = -\\frac{1}{h}$ 和对称性得到的。\n\n- 在三单元网格上进行组装并在 $x_{0}$ 和 $x_{3}$ 处施加狄利克雷边界条件后，对于内部自由度 $(\\varphi_{1},\\varphi_{2})$ 且 $\\beta \\equiv 1$ 的全局刚度为\n$$\nS \\;=\\; \\frac{1}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n\\;=\\; 3 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}.\n$$\n正如从对称强制双线性形式的精确 Galerkin 方法所预期的那样，该矩阵 $S$ 是对称正定的（SPD）。\n\n接下来，我们引入可变系数 $\\beta(x) = 1 + \\rho x$ 并定义非一致求积。对于每个行指标 $i \\in \\{1,2\\}$，它对应于支撑在两个相邻单元上的测试函数 $\\varphi_{i}$，我们通过将 $\\beta$ 从积分中提出并在测试函数节点 $x_{i}$ 处求值来近似单元贡献：\n$$\nK_{ij} := \\sum_{K \\subset \\operatorname{supp}(\\varphi_{i})} \\beta(x_{i}) \\int_{K} \\varphi_{i}'(x)\\, \\varphi_{j}'(x)\\, dx.\n$$\n由于 $\\beta(x_{i})$ 相对于单元积分是常数且不依赖于 $K$，我们可以将其从接触节点 $i$ 的两个单元的求和中提出来：\n$$\nK_{ij} = \\beta(x_{i}) \\sum_{K \\subset \\operatorname{supp}(\\varphi_{i})} \\int_{K} \\varphi_{i}'(x)\\, \\varphi_{j}'(x)\\, dx.\n$$\n但精确导数乘积积分在两个单元上的和恰好是常系数问题 $\\beta \\equiv 1$ 的全局刚度矩阵的相应元素。因此，\n$$\nK_{ij} = \\beta(x_{i})\\, S_{ij}.\n$$\n以矩阵形式，其中行指标决定了乘数，这可以写为\n$$\nK(\\rho) \\;=\\; D(\\rho)\\, S, \\quad \\text{其中} \\quad D(\\rho) = \\operatorname{diag}\\big(\\beta(x_{1}),\\, \\beta(x_{2})\\big).\n$$\n\n我们现在确定 $D(\\rho)$ 的对角线元素。当 $x_{1}=\\frac{1}{3}$ 和 $x_{2}=\\frac{2}{3}$ 时，我们有\n$$\n\\beta(x_{1}) = 1 + \\rho\\, \\frac{1}{3} =: a, \\qquad \\beta(x_{2}) = 1 + \\rho\\, \\frac{2}{3} =: b.\n$$\n于是\n$$\nD(\\rho) = \\begin{pmatrix} a  0 \\\\ 0  b \\end{pmatrix}, \\qquad S = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}, \\qquad K(\\rho) = \\begin{pmatrix} 6a  -3a \\\\ -3b  6b \\end{pmatrix}.\n$$\n\n对称性和对称正定性失效的代数机制：\n\n- 对于可变系数，使用精确积分的精确 Galerkin 刚度为 $S_{\\text{exact}}(\\rho) = \\big[\\int_{0}^{1} \\beta(x)\\, \\varphi_{i}' \\varphi_{j}'\\, dx\\big]$，由于被积函数在 $(i,j)$ 上是对称的，因此该矩阵是对称的。此外，根据 $a(\\cdot,\\cdot)$ 的强制性，$S_{\\text{exact}}(\\rho)$ 是对称正定的。\n\n- 非一致求积用一个类似 Petrov-Galerkin 的左缩放 $K(\\rho) = D(\\rho)\\, S$ 代替了对称双线性形式，其中 $S$ 是对称正定的，$D(\\rho)$ 是正定对角矩阵，但只出现在测试函数侧（行）。除非 $D(\\rho)$ 与 $S$ 可交换（这仅在 $a=b$ 时成立），否则乘积 $D(\\rho)\\, S$ 通常是非对称的：\n$$\nK(\\rho)^{T} = S\\, D(\\rho) \\neq D(\\rho)\\, S = K(\\rho) \\quad \\text{如果} \\quad a \\neq b.\n$$\n因此，对称性被破坏了，因为通过 $D(\\rho)$ 进行的左缩放对测试函数和试探函数的加权不同，这打破了 Galerkin 方法中对称性的基础——伴随性。尽管 $S$ 和 $D(\\rho)$ 在各自的意义上都是正定的，但它们的乘积不是对称的，因此不是对称正定的。\n\n我们现在计算 $2 \\times 2$ 矩阵 $K(\\rho) = \\begin{pmatrix} 6a  -3a \\\\ -3b  6b \\end{pmatrix}$ 的特征值。其特征多项式是\n$$\n\\det\\!\\big(K(\\rho) - \\lambda I\\big) = \\det \\begin{pmatrix} 6a - \\lambda  -3a \\\\ -3b  6b - \\lambda \\end{pmatrix}\n= (6a - \\lambda)(6b - \\lambda) - 9ab.\n$$\n展开，\n$$\n(6a - \\lambda)(6b - \\lambda) - 9ab = 36ab - 6(a+b)\\lambda + \\lambda^{2} - 9ab = \\lambda^{2} - 6(a+b)\\lambda + 27ab.\n$$\n因此特征值为\n$$\n\\lambda_{\\pm}(\\rho) = \\frac{6(a+b) \\pm \\sqrt{36(a+b)^{2} - 108\\, ab}}{2}\n= 3(a+b) \\pm 3 \\sqrt{(a+b)^{2} - 3ab}.\n$$\n我们使用 $a = 1 + \\frac{\\rho}{3}$ 和 $b = 1 + \\frac{2\\rho}{3}$ 来简化量 $a+b$ 和 $(a+b)^{2} - 3ab$：\n$$\na + b = \\left(1 + \\frac{\\rho}{3}\\right) + \\left(1 + \\frac{2\\rho}{3}\\right) = 2 + \\rho,\n$$\n$$\n(a+b)^{2} - 3ab = a^{2} - ab + b^{2}.\n$$\n计算 $a^{2} - ab + b^{2}$：\n$$\na^{2} = \\left(1 + \\frac{\\rho}{3}\\right)^{2} = 1 + \\frac{2\\rho}{3} + \\frac{\\rho^{2}}{9}, \\quad\nb^{2} = \\left(1 + \\frac{2\\rho}{3}\\right)^{2} = 1 + \\frac{4\\rho}{3} + \\frac{4\\rho^{2}}{9},\n$$\n$$\nab = \\left(1 + \\frac{\\rho}{3}\\right)\\left(1 + \\frac{2\\rho}{3}\\right) = 1 + \\rho + \\frac{2\\rho^{2}}{9}.\n$$\n因此，\n$$\na^{2} - ab + b^{2} = \\left(1 + \\frac{2\\rho}{3} + \\frac{\\rho^{2}}{9}\\right) - \\left(1 + \\rho + \\frac{2\\rho^{2}}{9}\\right) + \\left(1 + \\frac{4\\rho}{3} + \\frac{4\\rho^{2}}{9}\\right)\n= 1 + \\rho + \\frac{\\rho^{2}}{3}.\n$$\n因此最小的特征值是\n$$\n\\lambda_{\\min}(\\rho) = 3(a+b) - 3 \\sqrt{(a+b)^{2} - 3ab} = 3(2 + \\rho) - 3 \\sqrt{1 + \\rho + \\frac{\\rho^{2}}{3}}.\n$$\n等价地，\n$$\n\\lambda_{\\min}(\\rho) = 6 + 3\\rho - 3 \\sqrt{1 + \\rho + \\frac{\\rho^{2}}{3}}.\n$$\n这是一个关于 $\\rho$ 的闭合形式解析表达式。对于 $\\rho \\geq 0$，该表达式是严格正的，因为 $K(\\rho)$ 作为两个正定矩阵 $D(\\rho)$ 和 $S$ 的乘积，通过\n$$\nS^{1/2} \\, K(\\rho) \\, S^{-1/2} = S^{1/2} D(\\rho) S^{1/2},\n$$\n与对称正定矩阵 $S^{1/2} D(\\rho) S^{1/2}$ 相似，这保证了即使 $K(\\rho)$ 是非对称的，其谱也是正实的。这里的损失是对称性（以及因此的对称正定性），这直接归因于在离散层面上破坏了双线性形式对称性的非一致、按行加权的求积方法。", "answer": "$$\\boxed{6 + 3\\rho - 3\\sqrt{\\,1 + \\rho + \\frac{\\rho^{2}}{3}\\,}}$$", "id": "3416264"}, {"introduction": "离散最大值原理是保证数值解具有物理解释的关键性质，它与离散后系统矩阵的代数结构——即M-矩阵性质——紧密相关。本练习将通过编写代码，动手探索有限元刚度矩阵的M-矩阵特性与网格几何形状及材料非向性之间的关系 [@problem_id:3416313]。你将通过实验验证，符合特定几何条件（如所有内角为锐角）的网格如何保证这一重要性质，而钝角或强非向性又如何将其破坏，从而深刻理解网格质量对解的定性行为的决定性作用。", "problem": "考虑多边形域上的二维标量扩散边值问题，其由椭圆偏微分方程 $-\\nabla \\cdot (K(x) \\nabla u(x)) = f(x)$ 建模，并带有齐次狄利克雷边界条件 $u(x) = 0$。其中，$K(x)$ 是一个标量场或对称正定张量场。在平面三角网格上使用协调线性拉格朗日有限元法，每个三角形具有逐片常数系数 $K_T$。通过对每个三角形 $T$ 和局部基函数 $\\varphi_i$，将单元双线性形式 $\\int_T \\nabla \\varphi_i(x)^\\top K_T \\nabla \\varphi_j(x) \\, \\mathrm{d}x$ 求和，来组装全局刚度矩阵 $A$。将注意力集中于与内部节点 $\\mathcal{I}$ 对应的子矩阵 $A_{\\mathcal{I}\\mathcal{I}}$，内部节点定义为严格位于域内部的网格节点。在此设定下，刚度矩阵是所谓的 $M$-矩阵的性质由以下代数条件刻画：(i) $A_{\\mathcal{I}\\mathcal{I}}$ 是对称正定的，(ii) $A_{\\mathcal{I}\\mathcal{I}}$ 的所有非对角元都是非正的，以及 (iii) $A_{\\mathcal{I}\\mathcal{I}}$ 的每个内部行都是弱对角占优的。这种符号结构通过逆正性机制成为离散极值原理的基础。\n\n您的任务是在一个独立的程序中，从第一性原理出发实现 $A$ 的组装、$A_{\\mathcal{I}\\mathcal{I}}$ 的提取，以及对上述 $M$-矩阵条件和非正性（也称为 $Z$-矩阵）符号模式的验证。您将构建三个网格和系数分布，以探究网格几何形状、系数与 $A$ 的符号模式之间的关系，包括一个带有钝角三角形的反例，它会破坏符号模式的单调性。所有数值均为无量纲。若涉及角度，则以弧度为单位。\n\n推导中使用的基本假设和定义：\n- 协调线性有限元空间使用在每个三角形上是仿射的且全局连续的节点基函数。\n- 单元级刚度贡献是通过将双线性形式 $\\int_T \\nabla \\varphi_i(x)^\\top K_T \\nabla \\varphi_j(x) \\, \\mathrm{d}x$ 标准伽辽金投影到局部基上获得的，这导致每个三角形上的局部基函数梯度为常数，且每个三角形的系数 $K_T$ 也为常数。\n- 全局刚度矩阵 $A$ 是通过基于单元连接性将局部贡献求和到相应条目中来组装的，不提供任何快捷公式；您必须明确推导并计算必要的梯度和积分。\n- 对称正定性需要通过数值方法验证，检查 $A_{\\mathcal{I}\\mathcal{I}}$ 的所有特征值是否在一个小的数值公差范围内严格为正。\n- $Z$-矩阵符号模式需要通过检查 $A_{\\mathcal{I}\\mathcal{I}}$ 的所有非对角元是否在一个小的数值公差范围内为非正来验证。\n- 内部行的弱对角占优需要通过检查对于每个 $i \\in \\mathcal{I}$ 是否满足 $A_{ii} \\geq \\sum_{j \\neq i} |A_{ij}|$ 来验证，检查时允许一个小的数值公差。\n\n构建以下三个测试用例：\n\n- 测试用例 1（锐角，各向同性）：设域为正方形 $[0,1] \\times [0,1]$。在坐标 $(x_i, y_j)$ 处定义一个 $5 \\times 5$ 的均匀节点网格，其中对于整数 $i,j \\in \\{0,1,2,3,4\\}$，$x_i = i/4$ 且 $y_j = j/4$。通过东北-西南对角线对 $4 \\times 4$ 个正方形中的每一个进行三角剖分，每个正方形形成两个三角形：用网格索引表示为 $(i,j)\\text{-}(i+1,j)\\text{-}(i+1,j+1)$ 和 $(i,j)\\text{-}(i+1,j+1)\\text{-}(i,j+1)$。对所有三角形，设置标量系数 $K_T = \\kappa_T \\, I$，其中 $\\kappa_T = 1$。\n\n- 测试用例 2（钝角扰动，各向同性，异质）：从测试用例 1 开始，但将中心的内部节点从 $(0.5,0.5)$ 扰动到 $(0.1,0.5)$，同时保持所有其他节点坐标不变。使用基于原始网格索引的相同三角剖分连接关系。定义分片常数标量系数 $K_T = \\kappa_T \\, I$，其中对于包含被扰动的中心节点作为顶点的三角形，$\\kappa_T = 50$，否则 $\\kappa_T = 1$。\n\n- 测试用例 3（锐角，各向异性）：使用测试用例 1 的未扰动网格和三角剖分。通过 $K_T = R^\\top \\operatorname{diag}(100, 1) R$ 为每个三角形定义一个恒定的各向异性对称正定系数张量，其中 $R$ 是旋转矩阵 $\nR = \\begin{bmatrix}\n\\cos \\theta  -\\sin \\theta \\\\\n\\sin \\theta  \\cos \\theta\n\\end{bmatrix}\n$, $\\theta = \\pi/4$。\n\n在所有情况下，将内部节点集合 $\\mathcal{I}$ 定义为严格位于正方形内部的节点，即坐标 $(x,y)$ 满足 $0  x  1$ 和 $0  y  1$ 的节点。组装完整的刚度矩阵 $A$，然后提取 $A_{\\mathcal{I}\\mathcal{I}}$。\n\n对于每个测试用例，计算两个布尔指标：\n- $Z$：$A_{\\mathcal{I}\\mathcal{I}}$ 是否具有 $Z$-矩阵符号模式（所有非对角元均为非正）。\n- $M$：$A_{\\mathcal{I}\\mathcal{I}}$ 是否满足 $M$-矩阵准则（对称正定、非正非对角元、以及内部行的弱对角占优）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序为 $[Z_1, M_1, Z_2, M_2, Z_3, M_3]$，其中下标表示测试用例索引。输出必须是布尔值。", "solution": "任务是使用线性有限元法 (FEM) 在三角网格上为二维标量扩散问题组装刚度矩阵，并验证所得矩阵系统的特定代数性质。我们感兴趣的性质是那些刻画 $M$-矩阵的性质，这些性质与离散极值原理相关。\n\n起点是域 $\\Omega$ 上的椭圆偏微分方程：\n$$-\\nabla \\cdot (K(x) \\nabla u(x)) = f(x) \\quad \\text{in } \\Omega$$\n带有齐次狄利克雷边界条件 $u(x) = 0$ on $\\partial\\Omega$。这里，$u(x)$ 是标量场，$K(x)$ 是一个对称正定系数张量，假设其在网格的每个三角形 $T$ 上是分片常数，记作 $K_T$。\n\n该问题的弱形式是寻找 $u \\in H^1_0(\\Omega)$，使得对于所有 $v \\in H^1_0(\\Omega)$：\n$$a(u,v) = \\int_\\Omega (\\nabla v)^\\top K (\\nabla u) \\, \\mathrm{d}x = \\int_\\Omega fv \\, \\mathrm{d}x$$\n我们使用协调线性有限元空间 $V_h$ 来离散化空间 $H^1_0(\\Omega)$。设 $\\{\\varphi_i\\}_{i \\in \\mathcal{N}}$ 为全局节点基函数集合，其中 $\\mathcal{N}$ 是网格中所有节点索引的集合。近似解为 $u_h = \\sum_{j \\in \\mathcal{N}} u_j \\varphi_j(x)$，其中 $u_j$ 是节点值。伽辽金法产生一个线性系统 $AU = F$，其中 $U$ 是节点值 $u_j$ 的向量，刚度矩阵 $A$ 的元为 $A_{ij} = a(\\varphi_j, \\varphi_i)$。由于齐次狄利克雷边界条件，我们只求解内部节点的节点值，其索引由集合 $\\mathcal{I}$ 给出。这导致一个简化的系统 $A_{\\mathcal{I}\\mathcal{I}}U_{\\mathcal{I}} = F_{\\mathcal{I}}$，其中 $A_{\\mathcal{I}\\mathcal{I}}$ 是 $A$ 中对应于内部节点的子矩阵。\n\n全局刚度矩阵 $A$ 是通过对网格中每个单元（三角形）$T$ 的贡献求和来组装的：\n$$A_{ij} = \\sum_{T} \\int_T (\\nabla \\varphi_i)^\\top K_T (\\nabla \\varphi_j) \\, \\mathrm{d}x$$\n仅当节点 $i$ 和 $j$ 是三角形 $T$ 的顶点时，该积分才对 $A_{ij}$ 有贡献。对于具有顶点 $p_1, p_2, p_3$ 的单个三角形 $T$，局部基函数是仿射的，因此它们的梯度在 $T$ 内是常数向量。设顶点坐标为 $p_k = (x_k, y_k)$，其中 $k \\in \\{1,2,3\\}$。与顶点 $p_k$ 相关联的局部基函数 $\\varphi_k$ 的梯度由下式给出：\n$$\\nabla \\varphi_k = \\frac{1}{2|T|} \\mathbf{v}_k$$\n其中 $|T|$ 是三角形的面积，向量 $\\mathbf{v}_k$ 由顶点坐标确定。具体来说：\n$$\\mathbf{v}_1 = \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix}, \\quad \\mathbf{v}_2 = \\begin{pmatrix} y_3 - y_1 \\\\ x_1 - x_3 \\end{pmatrix}, \\quad \\mathbf{v}_3 = \\begin{pmatrix} y_1 - y_2 \\\\ x_2 - x_1 \\end{pmatrix}$$\n面积 $|T|$ 计算为 $|T| = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|$。\n\n对于每个三角形 $T$，我们计算一个 $3 \\times 3$ 的单元刚度矩阵 $A^T$。由于 $\\nabla\\varphi_i$、$\\nabla\\varphi_j$ 和 $K_T$ 在单元内是常数，积分简化为一个乘积：\n$$A^T_{ij} = |T| (\\nabla \\varphi_i)^\\top K_T (\\nabla \\varphi_j)$$\n其中 $i,j \\in \\{1,2,3\\}$ 是顶点的局部索引。如果我们定义一个 $2 \\times 3$ 矩阵 $B_T = [\\nabla \\varphi_1, \\nabla \\varphi_2, \\nabla \\varphi_3]$，则单元刚度矩阵可以紧凑地表示为 $A^T = |T| B_T^\\top K_T B_T$。然后将这些局部元加到 $A$ 中相应的全局位置。对于一个全局节点索引为 $(n_1, n_2, n_3)$ 的三角形，局部元 $A^T_{ij}$ 被加到全局元 $A_{n_i, n_j}$ 上。\n\n组装全局矩阵 $A$ 后，我们提取与指定内部节点对应的子矩阵 $A_{\\mathcal{I}\\mathcal{I}}$。然后，我们使用一个数值公差 $\\epsilon$（例如 $10^{-9}$）来验证 $A_{\\mathcal{I}\\mathcal{I}}$ 的以下性质：\n\n1.  **Z-矩阵性质**：所有非对角元必须为非正。我们检查对于索引集 $\\mathcal{I}$ 中的所有 $i \\ne j$，是否有 $A_{ij} \\le \\epsilon$。对此的布尔指标是 $Z$。\n\n2.  **M-矩阵性质**：如果一个矩阵是 Z-矩阵且其逆矩阵为正，则该矩阵为 M-矩阵。对于对称矩阵，这等价于它是一个对称正定（SPD）的 Z-矩阵。本问题增加了弱对角占优的条件。因此，我们组合检查三个条件：\n    a. **对称正定性 (SPD)**：我们验证对称性（$A_{\\mathcal{I}\\mathcal{I}} = A_{\\mathcal{I}\\mathcal{I}}^\\top$），然后计算 $A_{\\mathcal{I}\\mathcal{I}}$ 的特征值。所有特征值必须严格为正（大于 $\\epsilon$）。\n    b. **Z-矩阵性质**：如上定义。\n    c. **弱对角占优 (WDD)**：对于每个行 $i \\in \\mathcal{I}$，我们检查是否 $A_{ii} \\ge \\sum_{j \\in \\mathcal{I}, j \\ne i} |A_{ij}|$。对于非对角元为非正的 Z-矩阵，这等价于检查每行的和是否为非负，即 $\\sum_{j \\in \\mathcal{I}} A_{ij} \\ge 0$。\n\n当且仅当所有这三个条件（SPD、Z-矩阵和 WDD）都满足时，布尔指标 $M$ 才为真。\n\n这些测试用例旨在研究网格几何形状和材料系数对这些性质的影响。\n- **测试用例 1**：在由锐角直角三角形组成的均匀网格上使用各向同性系数 ($K_T=I$)。这是理想情况，预期 Z-矩阵和 M-矩阵性质都成立。\n- **测试用例 2**：扰动一个节点，向网格中引入钝角。这是一个经典的反例。单元矩阵元 $A^T_{ij}$ 与 $-\\cot\\gamma_{ij}$ 相关，其中 $\\gamma_{ij}$ 是边 $(i, j)$ 的对角。如果一个角是钝角，其余切值为负，导致一个正的非对角贡献 $A^T_{ij} > 0$。这可能会破坏全局矩阵 $A_{\\mathcal{I}\\mathcal{I}}$ 的 Z-矩阵性质。\n- **测试用例 3**：在锐角网格上引入一个强的、恒定的各向异性。非对角元非正的条件变为 $(\\nabla \\varphi_i)^\\top K_T (\\nabla \\varphi_j) \\le 0$。如果 $K_T$ 中的高电导率方向与网格不对齐，即使在几何上是锐角的网格上，这个条件也可能被违反，导致 Z-矩阵性质的丧失。\n\n实现将按以下步骤进行：为每个用例生成网格数据，按照上述推导从第一性原理组装矩阵 $A$，提取 $A_{\\mathcal{II}}$，然后以编程方式检查 $Z$-矩阵和 $M$-矩阵条件以生成所需的布尔标志。", "answer": "```python\nimport numpy as np\n\ndef evaluate_case(nodes, triangles, K_func, interior_node_indices, tol=1e-9):\n    \"\"\"\n    Assembles the FEM stiffness matrix and evaluates its properties.\n\n    Args:\n        nodes (np.ndarray): Array of node coordinates, shape (num_nodes, 2).\n        triangles (list[tuple]): List of triangles, each a tuple of 3 node indices.\n        K_func (callable): Function that takes triangle nodes and returns the 2x2 K_T matrix.\n        interior_node_indices (list[int]): List of indices for interior nodes.\n        tol (float): Numerical tolerance for comparisons.\n\n    Returns:\n        tuple[bool, bool]: A tuple (is_Z, is_M) indicating Z-matrix and M-matrix properties.\n    \"\"\"\n    num_nodes = nodes.shape[0]\n    A = np.zeros((num_nodes, num_nodes))\n\n    for tri_indices in triangles:\n        # 1. Get vertex coordinates\n        p1, p2, p3 = nodes[tri_indices[0]], nodes[tri_indices[1]], nodes[tri_indices[2]]\n\n        # 2. Calculate triangle area and basis function gradients\n        # The element stiffness matrix is invariant to vertex ordering, but its\n        # derivation is cleaner if we use the absolute area.\n        matrix_for_area = np.array([\n            [p2[0] - p1[0], p2[1] - p1[1]],\n            [p3[0] - p1[0], p3[1] - p1[1]]\n        ])\n        area = 0.5 * np.abs(np.linalg.det(matrix_for_area))\n\n        if area  1e-12:  # Skip degenerate triangles\n            continue\n\n        # Gradients of local basis functions (phi_1, phi_2, phi_3)\n        # grad(phi_k) = (1 / 2*|T|) * [y_next - y_prev, x_prev - x_next]\n        grad_phi = (1.0 / (2.0 * area)) * np.array([\n            [p2[1] - p3[1], p3[1] - p1[1], p1[1] - p2[1]],  # dy components\n            [p3[0] - p2[0], p1[0] - p3[0], p2[0] - p1[0]]   # dx components\n        ])\n\n        # 3. Get coefficient K_T for the current triangle\n        K_T = K_func(tri_indices)\n\n        # 4. Compute the 3x3 element stiffness matrix A_T\n        A_T = area * grad_phi.T @ K_T @ grad_phi\n\n        # 5. Assemble A_T into the global stiffness matrix A\n        for i in range(3):\n            for j in range(3):\n                A[tri_indices[i], tri_indices[j]] += A_T[i, j]\n\n    # Extract the submatrix corresponding to interior nodes\n    A_II = A[np.ix_(interior_node_indices, interior_node_indices)]\n\n    # --- Verify Matrix Properties ---\n\n    # 1. Z-matrix property: all off-diagonal entries are non-positive\n    off_diagonal_mask = ~np.eye(A_II.shape[0], dtype=bool)\n    is_Z = np.all(A_II[off_diagonal_mask] = tol)\n\n    # 2. M-matrix properties: is a Z-matrix, SPD, and WDD.\n    is_M = False\n    if is_Z:\n        # Check for Symmetric Positive Definiteness (SPD)\n        is_symmetric = np.allclose(A_II, A_II.T, atol=tol)\n        is_spd = False\n        if is_symmetric:\n            try:\n                eigenvalues = np.linalg.eigvalsh(A_II)\n                is_spd = np.all(eigenvalues > tol)\n            except np.linalg.LinAlgError:\n                is_spd = False\n        \n        if is_spd:\n            # Check for Weak Diagonal Dominance (WDD)\n            # For a Z-matrix, WDD is equivalent to non-negative row sums.\n            row_sums = np.sum(A_II, axis=1)\n            is_wdd = np.all(row_sums >= -tol)\n            \n            if is_wdd:\n                is_M = True # Only if Z, SPD, and WDD all hold\n\n    return is_Z, is_M\n\ndef solve():\n    \"\"\"\n    Sets up and runs the three test cases, then prints the results.\n    \"\"\"\n    N = 5\n    num_nodes = N * N\n    \n    # Identify interior node indices (nodes not on the boundary 0 or 1)\n    interior_node_indices = []\n    for j in range(1, N - 1):\n        for i in range(1, N - 1):\n            interior_node_indices.append(j * N + i)\n\n    # Define triangulation based on a uniform grid\n    # Each square is split by the NE-SW diagonal\n    triangles = []\n    for j in range(N - 1):\n        for i in range(N - 1):\n            p_bl = j * N + i        # Bottom-left\n            p_br = j * N + i + 1    # Bottom-right\n            p_tl = (j + 1) * N + i    # Top-left\n            p_tr = (j + 1) * N + i + 1# Top-right\n            triangles.append((p_bl, p_br, p_tr))\n            triangles.append((p_bl, p_tr, p_tl))\n    \n    results = []\n\n    # --- Test Case 1: Acute, Isotropic ---\n    nodes1 = np.array([[i / (N - 1), j / (N - 1)] for j in range(N) for i in range(N)])\n    def K_func1(tri_indices):\n        return np.identity(2)\n    \n    Z1, M1 = evaluate_case(nodes1, triangles, K_func1, interior_node_indices)\n    results.extend([Z1, M1])\n\n    # --- Test Case 2: Obtuse, Isotropic, Heterogeneous ---\n    nodes2 = np.copy(nodes1)\n    perturbed_node_idx = (N // 2) * N + (N // 2)  # Central node (2,2) -> index 12\n    nodes2[perturbed_node_idx] = [0.1, 0.5]\n    \n    def K_func2(tri_indices):\n        if perturbed_node_idx in tri_indices:\n            return 50.0 * np.identity(2)\n        return np.identity(2)\n\n    Z2, M2 = evaluate_case(nodes2, triangles, K_func2, interior_node_indices)\n    results.extend([Z2, M2])\n\n    # --- Test Case 3: Acute, Anisotropic ---\n    nodes3 = nodes1 # Unperturbed mesh\n    theta = np.pi / 4.0\n    c, s = np.cos(theta), np.sin(theta)\n    R = np.array([[c, -s], [s, c]])\n    D = np.diag([100.0, 1.0])\n    K_aniso = R.T @ D @ R\n\n    def K_func3(tri_indices):\n        return K_aniso\n\n    Z3, M3 = evaluate_case(nodes3, triangles, K_func3, interior_node_indices)\n    results.extend([Z3, M3])\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3416313"}]}