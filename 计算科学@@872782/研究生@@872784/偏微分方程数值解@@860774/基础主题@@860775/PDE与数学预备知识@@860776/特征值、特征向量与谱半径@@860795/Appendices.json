{"hands_on_practices": [{"introduction": "理解偏微分方程数值解中的谱性质，最清晰的起点莫过于周期性问题。在这种理想化的设定下，离散傅里叶模式天然地构成了线性、移位不变算子的特征向量。本练习 [@problem_id:3383470] 将指导你通过推导离散拉普拉斯算子的傅里叶符号，建立起算子结构与其完整谱之间的直接联系，并最终确定其谱半径。掌握这一基本分析工具是进行冯·诺依曼稳定性分析等高级课题的基石。", "problem": "考虑在周期性域上对热方程进行半离散化时产生的一维离散拉普拉斯算子。设空间域为区间 $[0,1]$，具有周期性边界条件和 $N$ 个点的均匀网格，其中 $N$ 是偶数。网格间距为 $h = \\frac{1}{N}$，网格点为 $x_j = j h$，其中 $j = 0,1,\\dots,N-1$。定义离散拉普拉斯算子 $L_h : \\mathbb{C}^N \\to \\mathbb{C}^N$ 如下：\n$$\n(L_h u)_j = \\frac{u_{j+1} - 2 u_j + u_{j-1}}{h^2},\n$$\n采用周期性索引，即 $u_{-1} \\equiv u_{N-1}$ 和 $u_{N} \\equiv u_{0}$。\n\n从离散拉普拉斯算子的定义和离散傅里叶模式 $u^{(\\theta)}_j = \\exp(i \\theta j)$ 出发（其中 $\\theta \\in [-\\pi,\\pi)$ 是一个无量纲的离散波数），推导 $L_h$ 的傅里叶符号 $\\hat{L}(\\theta)$，并解释允许的离散波数集合 $\\{\\theta_k = \\frac{2\\pi k}{N} : k = 0,1,\\dots,N-1\\}$ 在 $\\hat{L}$ 下的像如何刻画 $L_h$ 在周期性边界条件下的谱。使用此特性来确定 $L_h$ 的谱半径 $\\rho(L_h)$，作为网格间距 $h$ 的函数。\n\n将最终答案表示为单个封闭形式的解析表达式。无需四舍五入，最终表达式中不应包含单位。", "solution": "首先验证问题，以确保其具有科学依据、是适定的且客观的。\n\n### 第一步：提取已知条件\n- **域：** 区间 $[0,1]$，具有周期性边界条件。\n- **离散化：** $N$ 个点的均匀网格，其中 $N$ 是一个偶数。\n- **网格间距：** $h = \\frac{1}{N}$。\n- **网格点：** $x_j = j h$，其中 $j = 0,1,\\dots,N-1$。\n- **算子：** 离散拉普拉斯算子 $L_h : \\mathbb{C}^N \\to \\mathbb{C}^N$ 定义为 $(L_h u)_j = \\frac{u_{j+1} - 2 u_j + u_{j-1}}{h^2}$。\n- **边界条件：** 使用周期性索引，$u_{-1} \\equiv u_{N-1}$ 和 $u_N \\equiv u_0$。\n- **测试函数：** 离散傅里叶模式为 $u^{(\\theta)}_j = \\exp(i \\theta j)$，其中 $\\theta \\in [-\\pi,\\pi)$ 是一个无量纲的离散波数。\n- **允许的波数：** 允许的离散波数集合为 $\\{\\theta_k = \\frac{2\\pi k}{N} : k = 0,1,\\dots,N-1\\}$。\n- **目标：** 推导傅里叶符号 $\\hat{L}(\\theta)$，解释其与 $L_h$ 谱的关系，并用此求出谱半径 $\\rho(L_h)$ 作为 $h$ 的函数。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是有限差分法傅里叶分析中的一个标准练习，这是偏微分方程数值分析中的一个核心课题。所有概念都是成熟的。\n- **适定性：** 算子、域、边界条件和目标都得到了精确定义。预期会有一个唯一的、有意义的解。\n- **客观性：** 问题使用形式化数学语言陈述，没有歧义或主观因素。\n\n该问题没有表现出任何缺陷，如科学上不健全、信息缺失或逻辑矛盾。这是一个有效且适定的问题。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供完整的解答。\n\n---\n\n解题过程首先确定离散拉普拉斯算子 $L_h$ 对离散傅里叶模式 $u^{(\\theta)}_j$ 的作用。这些模式是任何周期性网格上的线性移不变算子（例如 $L_h$）的特征向量。相应的特征值由该算子的傅里叶符号给出。\n\n让我们将 $L_h$ 应用于模式 $u^{(\\theta)}_j = \\exp(i \\theta j)$：\n$$\n(L_h u^{(\\theta)})_j = \\frac{u^{(\\theta)}_{j+1} - 2 u^{(\\theta)}_j + u^{(\\theta)}_{j-1}}{h^2}\n$$\n代入 $u^{(\\theta)}_j$ 的定义：\n$$\n(L_h u^{(\\theta)})_j = \\frac{\\exp(i \\theta (j+1)) - 2 \\exp(i \\theta j) + \\exp(i \\theta (j-1))}{h^2}\n$$\n我们可以提出因子 $\\exp(i \\theta j)$：\n$$\n(L_h u^{(\\theta)})_j = \\frac{\\exp(i \\theta j) (\\exp(i \\theta) - 2 + \\exp(-i \\theta))}{h^2}\n$$\n使用定义 $u^{(\\theta)}_j = \\exp(i \\theta j)$，我们可以将其写成一个特征值方程：\n$$\n(L_h u^{(\\theta)})_j = \\left( \\frac{\\exp(i \\theta) + \\exp(-i \\theta) - 2}{h^2} \\right) u^{(\\theta)}_j\n$$\n这个方程表明 $u^{(\\theta)}$ 是 $L_h$ 的一个特征向量。相应的特征值依赖于波数 $\\theta$，称为算子 $L_h$ 的傅里叶符号，记为 $\\hat{L}(\\theta)$。\n$$\n\\hat{L}(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta) - 2}{h^2}\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$，我们可以简化 $\\hat{L}(\\theta)$ 的表达式：\n$$\n\\hat{L}(\\theta) = \\frac{2\\cos(\\theta) - 2}{h^2} = -\\frac{2(1 - \\cos(\\theta))}{h^2}\n$$\n利用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$，傅里叶符号变为：\n$$\n\\hat{L}(\\theta) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\n问题指定了一个具有 $N$ 个点的有限周期性网格。要使傅里叶模式 $u^{(\\theta)}_j$ 成为此网格上的一个有效函数，它必须满足周期性条件 $u_j = u_{j+N}$。将此应用于我们的模式：\n$$\nu^{(\\theta)}_j = u^{(\\theta)}_{j+N} \\implies \\exp(i \\theta j) = \\exp(i \\theta (j+N)) = \\exp(i \\theta j)\\exp(i \\theta N)\n$$\n这要求 $\\exp(i \\theta N) = 1$，这当且仅当对于某个整数 $k$，有 $\\theta N = 2\\pi k$。这将允许的波数量子化：\n$$\n\\theta_k = \\frac{2\\pi k}{N}, \\quad \\text{for } k \\in \\mathbb{Z}\n$$\n网格上不同模式的集合可以通过考虑 $k$ 的 $N$ 个连续值得到，例如 $k = 0, 1, \\dots, N-1$。这 $N$ 个模式 $\\{u^{(\\theta_k)}\\}_{k=0}^{N-1}$ 构成了向量空间 $\\mathbb{C}^N$ 的一个完备正交基。\n\n算子 $L_h$ 的谱，记为 $\\text{spec}(L_h)$，是其所有特征值的集合。在本例中，通过在每个允许的离散波数 $\\theta_k$ 处计算傅里叶符号 $\\hat{L}(\\theta)$ 的值来获得特征值。因此，允许的波数集合在映射 $\\hat{L}$ 下的像刻画了 $L_h$ 的谱。特征值为：\n$$\n\\lambda_k = \\hat{L}(\\theta_k) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_k}{2}\\right) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{1}{2} \\cdot \\frac{2\\pi k}{N}\\right) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right)\n$$\n对于 $k = 0, 1, \\dots, N-1$。\n\n谱半径 $\\rho(L_h)$ 是特征值绝对值的最大值：\n$$\n\\rho(L_h) = \\max_{k \\in \\{0, 1, \\dots, N-1\\}} |\\lambda_k|\n$$\n代入 $\\lambda_k$ 的表达式：\n$$\n\\rho(L_h) = \\max_{k \\in \\{0, 1, \\dots, N-1\\}} \\left|-\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right)\\right|\n$$\n因为对于任何实数 $x$，$h^2  0$ 且 $\\sin^2(x) \\ge 0$，所以绝对值可以简化为：\n$$\n\\rho(L_h) = \\frac{4}{h^2} \\max_{k \\in \\{0, 1, \\dots, N-1\\}} \\sin^2\\left(\\frac{\\pi k}{N}\\right)\n$$\n为了找到最大值，我们需要在指定的整数 $k$ 范围内最大化函数 $f(k) = \\sin^2\\left(\\frac{\\pi k}{N}\\right)$。当其参数 $x$ 是 $\\frac{\\pi}{2}$ 的奇数倍时，即对于 $m \\in \\mathbb{Z}$ 有 $x = (2m+1)\\frac{\\pi}{2}$，函数 $\\sin^2(x)$ 达到其最大值 1。\n\n我们在寻找一个整数 $k \\in \\{0, 1, \\dots, N-1\\}$，使得 $\\frac{\\pi k}{N}$ 尽可能接近这样的值。让我们尝试设置 $\\frac{\\pi k}{N} = \\frac{\\pi}{2}$。解出 $k$ 得到 $k = \\frac{N}{2}$。\n问题陈述了 $N$ 是一个偶数。因此，$k = \\frac{N}{2}$ 是一个整数。对于任何 $N \\ge 2$ 的网格，我们有 $1 \\le \\frac{N}{2} \\le N-1$，所以 $k = \\frac{N}{2}$ 是集合 $\\{0, 1, \\dots, N-1\\}$ 中的一个有效索引。\n对于这个 $k$ 值，我们有：\n$$\n\\max_{k \\in \\{0, 1, \\dots, N-1\\}} \\sin^2\\left(\\frac{\\pi k}{N}\\right) = \\sin^2\\left(\\frac{\\pi (N/2)}{N}\\right) = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1\n$$\n这是 $\\sin^2$ 函数可能取得的最高值。\n\n将这个最大值代回到谱半径的表达式中：\n$$\n\\rho(L_h) = \\frac{4}{h^2} \\cdot 1 = \\frac{4}{h^2}\n$$\n在具有 $N$ 个点的周期性网格上，离散拉普拉斯算子的谱半径为 $\\frac{4}{h^2}$。", "answer": "$$\\boxed{\\frac{4}{h^2}}$$", "id": "3383470"}, {"introduction": "在解决了理想的周期性问题之后，我们转向更具挑战性但更常见的有界域问题，其中边界条件起着决定性作用。边界条件施加的约束，会从连续的可能模式中筛选出一组特定的离散特征模式。本练习 [@problem_id:3383514] 旨在通过对比纯狄利克雷（Dirichlet）和混合狄利克雷-诺伊曼（Dirichlet-Neumann）边界条件，深入探讨不同的物理约束如何导致截然不同的离散谱。理解这一过程对于准确地用数值方法模拟物理系统至关重要。", "problem": "考虑区间 $[0,1]$ 上的一维偏微分方程 (PDE) $- \\frac{d^{2} u}{d x^{2}} = f(x)$。使用均匀网格 $x_{j} = j h$（其中 $j = 0,1,\\dots,n$ 且 $h = \\frac{1}{n}$）将该区间离散化，并在内部节点 $j = 1,2,\\dots,n-1$ 处取未知数 $u_{j}$。在内部节点处，使用中心二阶差分 $- \\frac{u_{j-1} - 2 u_{j} + u_{j+1}}{h^{2}}$ 来近似二阶导数。比较以下两种边界条件情形：\n\n- 纯 Dirichlet 条件：$u(0) = 0$ 且 $u(1) = 0$，实现为 $u_{0} = 0$ 且 $u_{n} = 0$。\n- 混合 Dirichlet–Neumann 条件：$u(0) = 0$ 且 $u'(1) = 0$，通过后向差分 $u'(1) \\approx \\frac{u_{n} - u_{n-1}}{h} = 0$ 实现，因此 $u_{n} = u_{n-1}$。\n\n分别针对纯 Dirichlet 和混合 Dirichlet–Neumann 的情况，仅使用上述近似，构建作用于内部向量 $\\mathbf{u} = (u_{1},u_{2},\\dots,u_{n-1})^{\\top}$ 的相应 $(n-1) \\times (n-1)$ 离散算子 $A_{D}$ 和 $A_{DN}$。然后，通过寻找与每种边界处理兼容的离散正弦模态，并施加边界关系以确定允许的离散波数，来分析特征值问题 $A_{D} \\mathbf{v} = \\lambda \\mathbf{v}$ 和 $A_{DN} \\mathbf{v} = \\lambda \\mathbf{v}$。\n\n使用此分析，推导出作为 $n$ 和 $h$ 的函数的精确离散特征值集合，找出每种情况下的最小特征值，并计算当 $n \\to \\infty$ 时，混合 Dirichlet–Neumann 算子下的最小特征值与纯 Dirichlet 算子下的最小特征值的比值的极限。将最终答案表示为一个不带单位的实数。无需四舍五入。", "solution": "问题要求分析两个离散算子 $A_{D}$ 和 $A_{DN}$ 的特征值，这两个算子分别对应于具有不同边界条件的一维 Poisson 方程的有限差分离散化。最终目标是计算它们的最小特征值之比的极限。\n\n首先，我们建立与正弦特征向量对应的特征值 $\\lambda$ 的一般形式。内部节点 $x_j$ 处二阶导数的离散算子由中心二阶差分给出。特征值问题 $A\\mathbf{v} = \\lambda\\mathbf{v}$，在分量 $j$（远离边界处）上可以写为：\n$$ \\frac{1}{h^2}(-v_{j-1} + 2v_j - v_{j+1}) = \\lambda v_j $$\n我们寻找一个离散正弦模态形式的特征向量 $v_j = \\sin(k x_j) = \\sin(kjh)$，其中 $k$ 是一个待由边界条件确定的离散波数。将此形式代入方程中：\n$$ \\frac{1}{h^2}(-\\sin(k(j-1)h) + 2\\sin(kjh) - \\sin(k(j+1)h)) = \\lambda \\sin(kjh) $$\n使用三角恒等式 $\\sin(A-B) + \\sin(A+B) = 2\\sin(A)\\cos(B)$，令 $A=kjh$ 和 $B=kh$，括号中的表达式变为：\n$$ 2\\sin(kjh) - (\\sin(kjh-kh) + \\sin(kjh+kh)) = 2\\sin(kjh) - 2\\sin(kjh)\\cos(kh) = 2\\sin(kjh)(1-\\cos(kh)) $$\n因此，特征值方程变为：\n$$ \\frac{2\\sin(kjh)}{h^2}(1-\\cos(kh)) = \\lambda \\sin(kjh) $$\n假设存在非平凡特征向量，即 $\\sin(kjh) \\neq 0$，我们可以解出 $\\lambda$：\n$$ \\lambda = \\frac{2}{h^2}(1-\\cos(kh)) $$\n使用半角公式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，上式可简化为：\n$$ \\lambda = \\frac{4}{h^2}\\sin^2\\left(\\frac{kh}{2}\\right) $$\n这个 $\\lambda$ 的表达式对两种情况都有效。每个算子的具体特征值由允许的波数 $k$ 的集合决定，这些波数是通过施加各自的边界条件找到的。\n\n**情况 1：纯 Dirichlet 边界条件**\n离散边界条件为 $u_0 = 0$ 和 $u_n = 0$。对于特征向量 $\\mathbf{v}$，这转化为 $v_0 = 0$ 和 $v_n = 0$。\n拟设 $v_j = \\sin(kjh)$ 自动满足 $v_0 = \\sin(0) = 0$。\n条件 $v_n=0$ 要求 $\\sin(knh) = 0$。由于 $h = 1/n$，这变为 $\\sin(k) = 0$。\n因此允许的波数为 $k_p = p\\pi$，其中 $p$ 为整数。为了得到 $n-1$ 个内部节点的 $n-1$ 个线性无关的非平凡特征向量，我们取 $p = 1, 2, \\dots, n-1$。\n\nDirichlet 算子 $A_D$ 的特征值可通过将这些波数代入 $\\lambda$ 的通用表达式中得到：\n$$ \\lambda_p(A_D) = \\frac{4}{h^2}\\sin^2\\left(\\frac{p\\pi h}{2}\\right) \\quad \\text{for } p = 1, 2, \\dots, n-1 $$\n最小特征值 $\\lambda_{min}(A_D)$ 对应于 $p$ 的最小值，即 $p=1$。\n$$ \\lambda_{min}(A_D) = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi h}{2}\\right) $$\n\n**情况 2：混合 Dirichlet–Neumann 边界条件**\n离散边界条件为 $u_0 = 0$ 和 $\\frac{u_n - u_{n-1}}{h} = 0$，这意味着 $u_n = u_{n-1}$。对于特征向量 $\\mathbf{v}$，这转化为 $v_0=0$ 和 $v_n = v_{n-1}$。\n拟设 $v_j = \\sin(kjh)$ 再次满足 $v_0=0$。\n条件 $v_n = v_{n-1}$ 要求 $\\sin(knh) = \\sin(k(n-1)h)$。\n使用 $nh=1$，我们得到 $\\sin(k) = \\sin(k-kh)$。\n使用 $\\sin(A-B)$ 的恒等式：\n$$ \\sin(k) = \\sin(k)\\cos(kh) - \\cos(k)\\sin(kh) $$\n$$ \\sin(k)(1-\\cos(kh)) + \\cos(k)\\sin(kh) = 0 $$\n使用半角恒等式 $1-\\cos(kh) = 2\\sin^2(kh/2)$ 和 $\\sin(kh)=2\\sin(kh/2)\\cos(kh/2)$：\n$$ \\sin(k) \\left(2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) + \\cos(k) \\left(2\\sin\\left(\\frac{kh}{2}\\right)\\cos\\left(\\frac{kh}{2}\\right)\\right) = 0 $$\n$$ 2\\sin\\left(\\frac{kh}{2}\\right) \\left[ \\sin(k)\\sin\\left(\\frac{kh}{2}\\right) + \\cos(k)\\cos\\left(\\frac{kh}{2}\\right) \\right] = 0 $$\n使用恒等式 $\\cos(A-B) = \\cos A \\cos B + \\sin A \\sin B$：\n$$ 2\\sin\\left(\\frac{kh}{2}\\right) \\cos\\left(k - \\frac{kh}{2}\\right) = 0 $$\n这给出了两种可能性。如果 $\\sin(kh/2)=0$，则 $kh/2 = p\\pi$，导致 $\\lambda=0$。然而，这也会导致 $v_j = \\sin(2p\\pi j h) = \\sin(2p\\pi j/n)$，对于许多 $p$ 和 $j$ 的选择，这会给出平凡特征向量，因此我们舍弃这种情况。\n另一种可能性给出了允许的波数的条件：\n$$ \\cos\\left(k - \\frac{kh}{2}\\right) = 0 \\implies k\\left(1 - \\frac{h}{2}\\right) = \\frac{(2p+1)\\pi}{2} \\quad \\text{for an integer } p $$\n$$ k_p = \\frac{(2p+1)\\pi}{2(1-h/2)} = \\frac{(2p+1)\\pi}{2(1 - 1/(2n))} = \\frac{(2p+1)\\pi n}{2n-1} $$\n我们取 $p = 0, 1, \\dots, n-2$ 以获得 $n-1$ 个不同的模态。\n\n混合 Dirichlet-Neumann 算子 $A_{DN}$ 的特征值为：\n$$ \\lambda_p(A_{DN}) = \\frac{4}{h^2}\\sin^2\\left(\\frac{k_p h}{2}\\right) \\quad \\text{for } p = 0, 1, \\dots, n-2 $$\n其中 $\\frac{k_p h}{2} = \\frac{(2p+1)\\pi n}{2(2n-1)} \\frac{h}{2} = \\frac{(2p+1)\\pi n}{2(2n-1)} \\frac{1}{2n} = \\frac{(2p+1)\\pi}{4(n-1/2)} = \\frac{(2p+1)\\pi}{2(2n-1)}$。\n最小特征值 $\\lambda_{min}(A_{DN})$ 对应于 $p$ 的最小值，即 $p=0$。\n$$ \\lambda_{min}(A_{DN}) = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(2n-1)}\\right) $$\n\n**比值与极限**\n最后，我们计算当 $n \\to \\infty$ 时最小特征值的比值的极限。\n$$ R = \\lim_{n \\to \\infty} \\frac{\\lambda_{min}(A_{DN})}{\\lambda_{min}(A_D)} = \\lim_{n \\to \\infty} \\frac{\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(2n-1)}\\right)}{\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi h}{2}\\right)} $$\n代入 $h=1/n$：\n$$ R = \\lim_{n \\to \\infty} \\frac{\\sin^2\\left(\\frac{\\pi}{2(2n-1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2n}\\right)} = \\left( \\lim_{n \\to \\infty} \\frac{\\sin\\left(\\frac{\\pi}{2(2n-1)}\\right)}{\\sin\\left(\\frac{\\pi}{2n}\\right)} \\right)^2 $$\n当 $n$ 很大时，正弦函数的自变量很小。我们对小的 $x$ 使用近似 $\\sin(x) \\approx x$。这可以通过极限 $\\lim_{u\\to 0} \\frac{\\sin(u)}{u} = 1$ 来证明是合理的。\n$$ \\lim_{n \\to \\infty} \\frac{\\sin\\left(\\frac{\\pi}{2(2n-1)}\\right)}{\\sin\\left(\\frac{\\pi}{2n}\\right)} = \\lim_{n \\to \\infty} \\frac{\\frac{\\pi}{2(2n-1)}}{\\frac{\\pi}{2n}} = \\lim_{n \\to \\infty} \\frac{2n}{2(2n-1)} = \\lim_{n \\to \\infty} \\frac{n}{2n-1} $$\n将分子和分母同除以 $n$：\n$$ \\lim_{n \\to \\infty} \\frac{1}{2 - 1/n} = \\frac{1}{2} $$\n最终结果是这个极限的平方：\n$$ R = \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} $$\n这个结果与连续问题的最小特征值之比 $(\\pi^2/4) / \\pi^2 = 1/4$ 相匹配，这与一个相容离散化的预期一致。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "3383514"}, {"introduction": "谱半径并非纯粹的数学概念，它在数值分析中，尤其是在时间演化问题的稳定性方面，扮演着核心角色。本计算练习 [@problem_id:3383464] 将理论与实践联系起来，要求你为不同边界条件（狄利克雷、诺伊曼和罗宾）下的离散拉普拉斯算子构建矩阵。通过数值计算其最大特征值（即谱半径），你将能够确定显式前向欧拉时间积分格式的稳定性上限 $\\Delta t_{\\max}$。这个练习清晰地展示了如何将抽象的特征值分析转化为设计稳定高效数值算法的具体指导。", "problem": "考虑单位区间上受齐次边界条件约束的一维扩散方程，及其在均匀网格上的线方法离散化。设 $M \\in \\mathbb{N}$ 表示内部网格点的数量，且 $h = \\frac{1}{M+1}$。通过应用于内部点的标准二阶中心差分格式，以及在两端 $x=0$ 和 $x=1$ 处的以下边界封闭之一来定义离散算子 $A \\in \\mathbb{R}^{M \\times M}$：\n- 齐次 Dirichlet：$u(0)=0$ 和 $u(1)=0$，\n- 齐次 Neumann：$u_x(0)=0$ 和 $u_x(1)=0$，\n- 齐次 Robin：$u_x(0) + \\gamma u(0) = 0$ 和 $u_x(1) + \\gamma u(1) = 0$，其中 $\\gamma \\ge 0$。\n\n假设半离散系统写作 $u'(t) = - A u(t)$，其中 $A$ 是对称半正定矩阵（除了齐次 Neumann 情况外是正定的，该情况下会出现一个零特征值）。矩阵 $A$ 必须按如下方式构造：\n- 对于齐次 Dirichlet 边界条件，$A = \\frac{1}{h^2} \\operatorname{tridiag}(-1, 2, -1)$（主对角线元素恒为 $2$，第一亚对角线和第一超对角线元素恒为 $-1$）。\n- 对于齐次 Neumann 边界条件，$A = \\frac{1}{h^2}$ 具有相同的三对角内部项，但第一个和最后一个对角线元素被修改为 $1$，以通过一阶精度的虚拟点消除法来处理离散的零通量边界。\n- 对于两端参数为 $\\gamma \\ge 0$ 的齐次 Robin 边界条件，使用一阶精度的虚拟点消除法得到 $u_0 = \\frac{u_1}{1 + \\gamma h}$ 和 $u_{M+1} = \\frac{u_M}{1 + \\gamma h}$。这仅修改了内部二阶差分算子的第一个和最后一个对角线元素，得到 $A = \\frac{1}{h^2}$，其主对角线元素处处为 $2$，但在第一个和最后一个位置上为 $2 - \\frac{1}{1 + \\gamma h}$，第一亚对角线和第一超对角线元素为 $-1$。\n\n设 $\\lambda(A)$ 表示 $A$ 的特征值的多重集，$\\rho(A)$ 表示 $A$ 的谱半径。将显式前向 Euler 时间积分器应用于线性常微分方程 (ODE) $u'(t) = - A u(t)$。利用前向 Euler 方法应用于对称半正定系统的线性稳定性要求，对每种情况确定能确保对所有初始数据都稳定的最大允许时间步长 $\\Delta t_{\\max}$，以秒为单位的实数表示。你的推理必须从特征值问题 $A v = \\lambda v$ 的定义、前向 Euler 方法的放大矩阵以及谱半径的定义出发。你不能使用任何预先给定的特征值闭式公式；相反，你的程序必须构造矩阵 $A$ 并数值计算其特征值。\n\n测试组：\n- 情况 1：$M = 5$，Dirichlet 边界条件。\n- 情况 2：$M = 5$，Neumann 边界条件。\n- 情况 3：$M = 5$，Robin 边界条件，$\\gamma = 0.1$。\n- 情况 4：$M = 5$，Robin 边界条件，$\\gamma = 10.0$。\n- 情况 5：$M = 1$，Dirichlet 边界条件。\n- 情况 6：$M = 2$，Neumann 边界条件。\n- 情况 7：$M = 10$，Dirichlet 边界条件。\n- 情况 8：$M = 10$，Neumann 边界条件。\n\n对于每个测试用例，你的程序必须：\n- 根据指定的边界条件和参数构造矩阵 $A$，\n- 计算 $\\lambda(A)$ 中的所有特征值，\n- 确定最大特征值 $\\lambda_{\\max}(A)$，\n- 使用放大矩阵对所有本征模应用的线性稳定性条件，计算最大允许的显式前向 Euler 时间步长 $\\Delta t_{\\max}$（以秒为单位）。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含八个 $\\Delta t_{\\max}$ 值（以秒为单位）的逗号分隔列表，并用方括号括起来（例如，$[\\Delta t_1,\\Delta t_2,\\ldots,\\Delta t_8]$）。不应打印任何额外文本。所有角度（如有）必须以弧度为单位；本问题中没有角度。所有实数都表示为小数（而非分数）。", "solution": "该问题要求确定将前向 Euler 方法应用于半离散化的一维扩散方程 $u_t = u_{xx}$ 时的最大稳定时间步长 $\\Delta t_{\\max}$。通过在具有 $M$ 个内部点的均匀网格上使用线方法进行半离散化，得到一个常微分方程组 (ODEs)，$u'(t) = -A u(t)$，其中 $u(t) \\in \\mathbb{R}^M$ 是内部网格点上的温度值向量，$A \\in \\mathbb{R}^{M \\times M}$ 是表示离散化负拉普拉斯算子 $- \\frac{d^2}{dx^2}$ 的矩阵。$A$ 的性质取决于在单位区间两端 $x=0$ 和 $x=1$ 处施加的边界条件。\n\n前向 Euler 方法根据以下显式更新规则将解从时间 $t_n$推进到 $t_{n+1} = t_n + \\Delta t$：\n$$u^{n+1} = u^n + \\Delta t (-A u^n)$$\n这可以重写为：\n$$u^{n+1} = (I - \\Delta t A) u^n$$\n其中 $I$ 是 $M \\times M$ 的单位矩阵。矩阵 $G = I - \\Delta t A$ 被称为放大矩阵，因为它决定了求解分量在单个时间步长内的演化方式。\n\n为使数值方法稳定，误差或扰动不能随时间无限增长。对于线性系统，如果放大矩阵的谱半径 $\\rho(G)$ 不大于 $1$，则可以保证这一点。谱半径是 $G$ 的特征值的最大模。\n$$\\rho(G) \\le 1$$\n\n$G$ 的特征值与 $A$ 的特征值直接相关。设 $\\lambda$ 是 $A$ 的一个特征值，对应的特征向量为 $v$，使得 $Av = \\lambda v$。那么，将 $G$ 应用于 $v$ 可得：\n$$Gv = (I - \\Delta t A) v = Iv - \\Delta t (Av) = v - \\Delta t (\\lambda v) = (1 - \\Delta t \\lambda) v$$\n因此，如果 $\\lambda$ 是 $A$ 的一个特征值，那么 $\\mu = 1 - \\Delta t \\lambda$ 就是 $G$ 的一个特征值。稳定性条件 $\\rho(G) \\le 1$ 转化为对所有 $G$ 的特征值 $\\mu_j$ 都有 $|\\mu_j| \\le 1$，这意味着：\n$$|1 - \\Delta t \\lambda_j| \\le 1$$\n对于所有 $A$ 的特征值 $\\lambda_j$。\n\n问题指出矩阵 $A$ 是对称半正定的。这保证了其特征值 $\\lambda_j$ 是实数且非负，即对于所有 $j=1, \\dots, M$，有 $\\lambda_j \\in \\mathbb{R}$ 且 $\\lambda_j \\ge 0$。稳定性不等式可以展开为：\n$$-1 \\le 1 - \\Delta t \\lambda_j \\le 1$$\n右侧不等式 $1 - \\Delta t \\lambda_j \\le 1$ 简化为 $-\\Delta t \\lambda_j \\le 0$。因为 $\\Delta t  0$ 且 $\\lambda_j \\ge 0$，所以这个条件总是满足的。\n左侧不等式 $-1 \\le 1 - \\Delta t \\lambda_j$ 简化为 $\\Delta t \\lambda_j \\le 2$。\n\n这个不等式必须对所有特征值 $\\lambda_j$ 都成立。最严格的约束来自于 $A$ 的最大特征值，记为 $\\lambda_{\\max}(A)$。对称半正定矩阵的谱半径是其最大特征值，因此 $\\rho(A) = \\lambda_{\\max}(A)$。因此稳定性条件变为：\n$$\\Delta t \\cdot \\lambda_{\\max}(A) \\le 2$$\n$$\\Delta t \\le \\frac{2}{\\lambda_{\\max}(A)}$$\n因此，保证稳定性的最大允许时间步长为：\n$$\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(A)} = \\frac{2}{\\rho(A)}$$\n如果 $\\lambda_{\\max}(A) = 0$（这仅在 $A$ 为零矩阵时发生），则该方法是无条件稳定的。然而，对于给定的问题配置，$A$ 从不是零矩阵，因此 $\\lambda_{\\max}(A)  0$。\n\n每个测试用例的计算过程如下：\n$1$. 确定网格间距 $h = \\frac{1}{M+1}$。\n$2$. 构造与指定边界条件相对应的 $M \\times M$ 矩阵 $A$。\n$3$. 数值计算对称矩阵 $A$ 的特征值。\n$4$. 确定最大特征值 $\\lambda_{\\max}(A)$。\n$5$. 计算最大稳定时间步长 $\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(A)}$。\n\n每种边界条件类型的矩阵 $A$ 的构造方法已明确给出：\n\n- **齐次 Dirichlet**：$A = \\frac{1}{h^2} \\operatorname{tridiag}(-1, 2, -1)$。这是一个 $M \\times M$ 矩阵，主对角线元素为 $2$，第一亚对角线和超对角线元素为 $-1$，所有元素再乘以 $\\frac{1}{h^2}$。\n- **齐次 Neumann**：$A = \\frac{1}{h^2} \\operatorname{tridiag}(-1_s, d, -1_s)$，其中 $1_s$ 表示亚/超对角线，主对角线向量为 $d = [1, 2, 2, \\dots, 2, 1]^T$。这是通过从标准的 $\\operatorname{tridiag}(-1, 2, -1)$ 矩阵开始，并将第一个和最后一个对角线元素从 $2$ 修改为 $1$ 来构造的。\n- **齐次 Robin**：$A = \\frac{1}{h^2} \\operatorname{tridiag}(-1_s, d, -1_s)$，其中主对角线向量为 $d = [d_1, 2, 2, \\dots, 2, d_1]^T$，特定值为 $d_1 = 2 - \\frac{1}{1 + \\gamma h}$。这是通过从标准的 $\\operatorname{tridiag}(-1, 2, -1)$ 矩阵开始，并修改第一个和最后一个对角线元素来构造的。\n\n对于每个测试用例，程序将执行这些步骤来计算 $\\Delta t_{\\max}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable time step for the forward Euler method\n    applied to the 1D diffusion equation under various boundary conditions.\n    \"\"\"\n    # Test cases: (M, boundary_condition_type, gamma)\n    # gamma is None for Dirichlet and Neumann cases.\n    test_cases = [\n        (5, 'dirichlet', None),\n        (5, 'neumann', None),\n        (5, 'robin', 0.1),\n        (5, 'robin', 10.0),\n        (1, 'dirichlet', None),\n        (2, 'neumann', None),\n        (10, 'dirichlet', None),\n        (10, 'neumann', None),\n    ]\n\n    results = []\n    \n    for M, bc_type, gamma in test_cases:\n        # 1. Calculate grid spacing h\n        h = 1.0 / (M + 1)\n        \n        # 2. Construct the matrix A\n        A = np.zeros((M, M))\n        \n        if bc_type == 'dirichlet':\n            # Main diagonal\n            np.fill_diagonal(A, 2.0)\n            # Sub-diagonal and Super-diagonal\n            if M  1:\n                np.fill_diagonal(A[1:], -1.0)\n                np.fill_diagonal(A[:, 1:], -1.0)\n        \n        elif bc_type == 'neumann':\n            # Main diagonal\n            np.fill_diagonal(A, 2.0)\n            A[0, 0] = 1.0\n            if M  1:\n                A[M - 1, M - 1] = 1.0\n            # Sub-diagonal and Super-diagonal\n            if M  1:\n                np.fill_diagonal(A[1:], -1.0)\n                np.fill_diagonal(A[:, 1:], -1.0)\n\n        elif bc_type == 'robin':\n            # Main diagonal\n            np.fill_diagonal(A, 2.0)\n            diag_val_boundary = 2.0 - 1.0 / (1.0 + gamma * h)\n            A[0, 0] = diag_val_boundary\n            if M  1:\n                A[M - 1, M - 1] = diag_val_boundary\n            # Sub-diagonal and Super-diagonal\n            if M  1:\n                np.fill_diagonal(A[1:], -1.0)\n                np.fill_diagonal(A[:, 1:], -1.0)\n        \n        # Scale A by 1/h^2\n        A /= (h**2)\n        \n        # 3. Compute eigenvalues\n        # Since A is symmetric, eigvalsh is efficient and appropriate.\n        eigenvalues = np.linalg.eigvalsh(A)\n        \n        # 4. Find the spectral radius (maximum eigenvalue)\n        rho_A = np.max(eigenvalues)\n        \n        # 5. Calculate the maximum stable time step\n        # dt_max = 2 / rho(A)\n        # Avoid division by zero, although not expected for these test cases\n        if rho_A  1e-12:\n            dt_max = 2.0 / rho_A\n        else:\n            # Unconditionally stable, dt_max is theoretically infinite.\n            # This case should not be reached with the given problems.\n            dt_max = np.inf\n            \n        results.append(dt_max)\n\n    # Final print statement in the exact required format.\n    # The format string ensures decimal representation for all numbers.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3383464"}]}