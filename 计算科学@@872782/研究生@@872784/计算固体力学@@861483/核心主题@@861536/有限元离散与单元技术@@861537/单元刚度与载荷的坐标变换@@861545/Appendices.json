{"hands_on_practices": [{"introduction": "本练习旨在连接理论与实践，演示如何将作用在梁单元上的连续分布荷载转换为一组离散的、功等效的节点力和力矩。该过程植根于虚功原理，是有限元分析的基石。您将首先推导局部坐标系下的一致荷载向量，然后将其转换到全局坐标系中，这是组装系统级方程的一项关键技能。[@problem_id:3555024]", "problem": "考虑一个长度为 $L$ 的二维欧拉-伯努利梁（框架）有限元，连接节点 $1$ 和节点 $2$。该单元的局部坐标系 $\\{x,y\\}$ 是通过将全局坐标系 $\\{X,Y\\}$ 从全局 $X$ 轴逆时针旋转一个恒定角度 $\\theta$ 到局部 $x$ 轴得到的。局部 $y$ 轴是平面内的横向轴，与局部 $x$ 轴正交归一。在局部坐标系中，节点自由度按 $\\begin{bmatrix} u_1, v_1, \\varphi_1, u_2, v_2, \\varphi_2 \\end{bmatrix}^{\\mathsf{T}}$ 排序，其中 $u$ 是轴向位移，$v$ 是横向位移，$\\varphi$ 是转角。\n\n一个分布荷载仅作用在局部横向 $+y$ 方向上，并沿单元按如下方式变化\n$$\nq_l(x) \\;=\\; q_0 \\;+\\; q_1\\,\\frac{x}{L} \\;+\\; q_2\\,\\Bigl(\\frac{x}{L}\\Bigr)^{2},\n\\quad 0 \\le x \\le L,\n$$\n其中 $q_0$、$q_1$ 和 $q_2$ 是常数。使用虚功原理和欧拉-伯努利梁横向位移的标准三次Hermite插值，\n$$\nv(x) \\;=\\; H_1(\\xi)\\,v_1 \\;+\\; H_2(\\xi)\\,L\\,\\varphi_1 \\;+\\; H_3(\\xi)\\,v_2 \\;+\\; H_4(\\xi)\\,L\\,\\varphi_2,\n\\quad \\xi \\equiv \\frac{x}{L},\n$$\n其中\n$$\nH_1(\\xi)=1-3\\xi^{2}+2\\xi^{3}, \\quad\nH_2(\\xi)=\\xi-2\\xi^{2}+\\xi^{3}, \\quad\nH_3(\\xi)=3\\xi^{2}-2\\xi^{3}, \\quad\nH_4(\\xi)=-\\xi^{2}+\\xi^{3},\n$$\n首先，求出仅由 $q_l(x)$ 引起的、与节点 $1$ 的横向位移相关的相容局部等效节点荷载向量分量，即局部向量 $\\begin{bmatrix} F_{u1}^{(l)}, F_{v1}^{(l)}, M_{1}^{(l)}, F_{u2}^{(l)}, F_{v2}^{(l)}, M_{2}^{(l)} \\end{bmatrix}^{\\mathsf{T}}$ 中的分量 $F_{v1}^{(l)}$。\n\n然后，使用力变换将局部等效节点荷载映射到全局坐标系中\n$$\n\\mathbf{f}^{(g)} \\;=\\; \\mathbf{T}^{\\mathsf{T}}\\,\\mathbf{f}^{(l)},\n$$\n其中 $\\mathbf{T}$ 是将全局节点位移映射到局部节点位移的分块对角变换，即\n$$\n\\begin{bmatrix} u \\\\ v \\\\ \\varphi \\end{bmatrix}^{(l)}\n\\;=\\;\n\\mathbf{R}\\,\n\\begin{bmatrix} U \\\\ V \\\\ \\Phi \\end{bmatrix}^{(g)},\n\\qquad\n\\mathbf{R}\n=\n\\begin{bmatrix}\n\\cos\\theta & \\sin\\theta & 0 \\\\\n-\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n该变换独立地应用于节点 $1$ 和节点 $2$。\n\n从第一性原理出发，推导仅由 $q_l(x)$ 引起的、在节点 $1$ 处的等效节点荷载的全局 $X$ 分量（记为 $F_{X1}^{(g)}$）的闭式表达式。将您的最终答案表示为关于 $q_0$、$q_1$、$q_2$、$L$ 和 $\\theta$ 的单个符号表达式。最终表达式中不要包含单位。不需要进行数值计算或四舍五入。", "solution": "该问题是有效的，因为它是计算固体力学中一个适定、有科学依据的问题，其内部一致且包含唯一解所需的所有必要信息。\n\n推导过程主要分为两个步骤：首先，使用虚功原理确定相容的局部等效节点荷载；其次，将这些局部荷载转换到全局坐标系。\n\n虚功原理指出，外部自分布荷载所做的虚功 $\\delta W_{\\text{ext}}$ 等于等效节点荷载 $\\mathbf{f}^{(l)}$ 通过虚节点位移 $\\delta\\mathbf{d}^{(l)}$ 所做的功。分布荷载 $q_l(x)$ 仅作用在局部横向方向上，因此虚功由下式给出：\n$$\n\\delta W_{\\text{ext}} = \\int_0^L q_l(x) \\, \\delta v(x) \\, dx\n$$\n虚横向位移 $\\delta v(x)$ 是使用所提供的Hermite形函数 $H_i(\\xi)$ 从虚节点自由度插值得到的，其中 $\\xi = x/L$：\n$$\n\\delta v(x) = H_1(\\xi)\\,\\delta v_1 + H_2(\\xi)\\,L\\,\\delta \\varphi_1 + H_3(\\xi)\\,\\delta v_2 + H_4(\\xi)\\,L\\,\\delta \\varphi_2\n$$\n虚功也可以离散地表示为：\n$$\n\\delta W_{\\text{ext}} = [F_{u1}^{(l)}, F_{v1}^{(l)}, M_1^{(l)}, F_{u2}^{(l)}, F_{v2}^{(l)}, M_2^{(l)}] \\begin{bmatrix} \\delta u_1 \\\\ \\delta v_1 \\\\ \\delta \\varphi_1 \\\\ \\delta u_2 \\\\ \\delta v_2 \\\\ \\delta \\varphi_2 \\end{bmatrix}\n$$\n由于所施加的荷载 $q_l(x)$ 是纯横向的，它不通过任何虚轴向位移 $\\delta u(x)$ 做功。因此，相容的节点轴向力为零：$F_{u1}^{(l)} = 0$ 和 $F_{u2}^{(l)} = 0$。\n\n为了求出节点 $1$ 处的局部横向力 $F_{v1}^{(l)}$，我们令 $\\delta W_{\\text{ext}}$ 两个表达式中虚位移 $\\delta v_1$ 的系数相等：\n$$\nF_{v1}^{(l)} = \\int_0^L q_l(x) H_1(\\xi) \\, dx\n$$\n我们代入 $q_l(x)$ 和 $H_1(\\xi)$ 的给定表达式，并使用 $x = L\\xi$ 和 $dx = L\\,d\\xi$ 将积分变量从 $x$ 更改为 $\\xi$：\n$$\nF_{v1}^{(l)} = \\int_0^1 \\left( q_0 + q_1\\xi + q_2\\xi^2 \\right) \\left( 1 - 3\\xi^2 + 2\\xi^3 \\right) L \\, d\\xi\n$$\n我们可以根据常数 $q_0$、$q_1$ 和 $q_2$ 将此积分分为三部分：\n$$\nF_{v1}^{(l)} = L \\left( q_0 \\int_0^1 H_1(\\xi) \\, d\\xi + q_1 \\int_0^1 \\xi H_1(\\xi) \\, d\\xi + q_2 \\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi \\right)\n$$\n我们分别计算每个积分：\n$$\n\\int_0^1 H_1(\\xi) \\, d\\xi = \\int_0^1 (1 - 3\\xi^2 + 2\\xi^3) \\, d\\xi = \\left[ \\xi - \\xi^3 + \\frac{2}{4}\\xi^4 \\right]_0^1 = 1 - 1 + \\frac{1}{2} = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\xi H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi - 3\\xi^3 + 2\\xi^4) \\, d\\xi = \\left[ \\frac{1}{2}\\xi^2 - \\frac{3}{4}\\xi^4 + \\frac{2}{5}\\xi^5 \\right]_0^1 = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{5} = \\frac{10-15+8}{20} = \\frac{3}{20}\n$$\n$$\n\\int_0^1 \\xi^2 H_1(\\xi) \\, d\\xi = \\int_0^1 (\\xi^2 - 3\\xi^4 + 2\\xi^5) \\, d\\xi = \\left[ \\frac{1}{3}\\xi^3 - \\frac{3}{5}\\xi^5 + \\frac{2}{6}\\xi^6 \\right]_0^1 = \\frac{1}{3} - \\frac{3}{5} + \\frac{1}{3} = \\frac{2}{3} - \\frac{3}{5} = \\frac{10-9}{15} = \\frac{1}{15}\n$$\n将这些结果代回，我们得到 $F_{v1}^{(l)}$ 的表达式：\n$$\nF_{v1}^{(l)} = L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right)\n$$\n第二步是将局部节点荷载转换到全局坐标系。力/力矩向量的变换由 $\\mathbf{f}^{(g)} = \\mathbf{T}^{\\mathsf{T}} \\mathbf{f}^{(l)}$ 给出。完整的变换矩阵 $\\mathbf{T}$ 是分块对角矩阵，由两个 $3 \\times 3$ 的旋转矩阵 $\\mathbf{R}$ 组成。因此，节点 $1$ 处的节点荷载变换为：\n$$\n\\begin{bmatrix} F_{X1}^{(g)} \\\\ F_{Y1}^{(g)} \\\\ M_{Z1}^{(g)} \\end{bmatrix} = \\mathbf{R}^{\\mathsf{T}} \\begin{bmatrix} F_{u1}^{(l)} \\\\ F_{v1}^{(l)} \\\\ M_1^{(l)} \\end{bmatrix}\n$$\n给定旋转矩阵 $\\mathbf{R}$ 的转置是：\n$$\n\\mathbf{R}^{\\mathsf{T}} = \\begin{bmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}\n$$\n执行矩阵-向量乘法，节点 $1$ 处荷载的全局 $X$ 分量 $F_{X1}^{(g)}$ 为：\n$$\nF_{X1}^{(g)} = F_{u1}^{(l)} \\cos\\theta - F_{v1}^{(l)} \\sin\\theta\n$$\n如前所述，由于施加的分布荷载是纯横向的，局部轴向力分量 $F_{u1}^{(l)}$ 为零。因此，表达式简化为：\n$$\nF_{X1}^{(g)} = - F_{v1}^{(l)} \\sin\\theta\n$$\n最后，代入推导出的 $F_{v1}^{(l)}$ 表达式，得到所需的全局荷载分量：\n$$\nF_{X1}^{(g)} = -L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta\n$$\n此表达式是最终答案，以指定的常数 $q_0$、$q_1$、$q_2$、$L$ 和 $\\theta$ 表示。", "answer": "$$ \\boxed{-L \\left( \\frac{1}{2} q_0 + \\frac{3}{20} q_1 + \\frac{1}{15} q_2 \\right) \\sin\\theta} $$", "id": "3555024"}, {"introduction": "此问题侧重于节点力与力矩的直接变换，并验证变换过程中的两个基本属性。通过变换一个自平衡的荷载系统，您将证实平衡条件在不同坐标系下得以保持。此外，您还将证明相似变换 ($K_g = T^T K_l T$) 保持了刚度矩阵的对称性，这是保证数值求解器稳定性和效率的一个至关重要的特性。[@problem_id:3555039]", "problem": "考虑有限元法（FEM）中的一个二维欧拉-伯努利梁单元，该单元有两个节点，记为节点 $i$ 和节点 $j$。其局部坐标为 $(x,y)$，其中局部 $x$ 轴与单元轴线对齐。该单元长度为 $L$，通过绕平面外 $z$ 轴刚性旋转角度 $\\theta$（以弧度为单位）嵌入到全局 $(X,Y)$ 坐标系中。单元方位由 $\\theta = \\pi/3$ 和 $L = 2$ 指定。每个节点的局部节点自由度按 $(u_x, u_y, \\varphi_z)$ 顺序排列，其中 $u_x$ 和 $u_y$ 是平移，$\\varphi_z$ 是绕 $z$ 轴的面内转动。\n\n施加一个自平衡的局部节点作用力系统，包括在节点 $i$ 处的一个端部剪力-弯矩对以及在节点 $j$ 处的反作用力。在局部坐标系中，施加的节点作用力如下：\n- 在节点 $i$ 处：沿 $+y$ 方向的剪力 $V_i$，大小为 $V_i = 12$；以及绕 $z$ 轴的节点弯矩，大小为 $M_i = 5$。\n- 在节点 $j$ 处：沿 $+y$ 方向的剪力 $V_j$ 和绕 $z$ 轴的节点弯矩 $M_j$，其大小待定，需满足单元在局部坐标系中的合力和合力矩均为零。\n\n假设标准符号约定：沿 $+y$ 方向为正剪力，绕 $+z$ 轴（逆时针）为正弯矩。设从局部到全局的方向余弦旋转矩阵 $Q$ 将局部位移分量映射到全局位移分量。单元级位移变换矩阵 $T$ 作用于按序排列的节点位移向量 $(u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})$，该矩阵是由用于平移的适当旋转子矩阵和用于 $\\varphi_z$ 的单位矩阵构成的分块对角矩阵。\n\n任务：\n1. 在局部坐标系中应用静力平衡条件，以 $L$、$V_i$ 和 $M_i$ 表示 $V_j$ 和 $M_j$。\n2. 从虚功不变性原理和旋转映射 $Q$ 的定义出发，推导节点力分量的适当变换，并构建与按分量 $(f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})$ 定义的局部节点荷载向量 $F_l$ 相对应的全局节点荷载向量 $F_g$。\n3. 根据给定的 $L$、$V_i$、$M_i$ 和 $\\theta$ 的数值，计算节点作用力的显式全局分量。\n4. 使用第一性原理和刚性旋转的性质，验证节点平衡在变换下保持不变，并且由对称的局部刚度矩阵 $K_l$ 构建的变换后的全局单元刚度矩阵 $K_g$ 仍然保持对称。\n\n将最终的全局节点荷载向量 $F_g$ 的分量按 $(f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})$ 的顺序表示，力的单位为牛顿，力矩的单位为牛顿-米。角度使用弧度。无需四舍五入，请给出精确值。", "solution": "问题陈述被评估为有效。它在科学上基于计算固体力学和有限元法的原理，是适定的、客观的，并且包含获得唯一解所需的所有必要信息，没有矛盾。\n\n解答过程按顺序处理四个任务。\n\n单元的有序自由度（DOF）在局部坐标系 $(x,y)$ 和全局坐标系 $(X,Y)$ 中给出。\n局部位移向量为 $d_l = (u_{x,i}, u_{y,i}, \\varphi_{z,i}, u_{x,j}, u_{y,j}, \\varphi_{z,j})^{\\mathsf{T}}$。\n相应的局部节点荷载向量为 $F_l = (f_{x,i}, f_{y,i}, m_{z,i}, f_{x,j}, f_{y,j}, m_{z,j})^{\\mathsf{T}}$。\n\n单元长度 $L=2$，相对于全局坐标系的方向角为 $\\theta = \\pi/3$。\n\n**任务1：在局部坐标系中应用静力平衡条件**\n\n施加了一个自平衡的节点作用力系统。在节点 $i$ 处，作用力为一个沿 $+y$ 方向大小为 $V_i = 12$ 的剪力，以及一个绕 $+z$ 轴大小为 $M_i = 5$ 的弯矩。用局部荷载向量表示法，这意味着：\n$f_{x,i} = 0$\n$f_{y,i} = V_i = 12$\n$m_{z,i} = M_i = 5$\n\n在节点 $j$ 处，存在反作用力：一个沿 $+y$ 方向的剪力 $V_j$（因此 $f_{y,j} = V_j$）和一个弯矩 $M_j$（因此 $m_{z,j} = M_j$）。没有指定轴向力，因此我们假设 $f_{x,j}$ 由平衡条件确定。\n\n为使单元处于静力平衡状态，合力与合力矩必须为零。\n1.  局部 $x$ 方向的力之和：\n    $$ \\sum f_x = f_{x,i} + f_{x,j} = 0 $$\n    由于 $f_{x,i}=0$，我们得到 $f_{x,j}=0$。\n\n2.  局部 $y$ 方向的力之和：\n    $$ \\sum f_y = f_{y,i} + f_{y,j} = 0 $$\n    $$ V_i + V_j = 0 \\implies V_j = -V_i = -12 $$\n    所以，节点 $j$ 处的剪力作用为 $f_{y,j} = -12$。\n\n3.  绕节点 $i$ 的力矩之和：\n    $$ \\sum M_i = m_{z,i} + m_{z,j} + (f_{y,j} \\times L) = 0 $$\n    节点 $j$ 处的力 $f_{y,j}$ 相对于节点 $i$ 的力臂为 $L$。\n    $$ M_i + M_j + (-V_i)L = 0 $$\n    解出 $M_j$：\n    $$ M_j = V_i L - M_i $$\n    代入给定值 $L=2$、$V_i=12$ 和 $M_i=5$：\n    $$ M_j = (12)(2) - 5 = 24 - 5 = 19 $$\n    所以，节点 $j$ 处的弯矩为 $m_{z,j} = 19$。\n\n完整的局部节点荷载向量为：\n$$ F_l = \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\\\ f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\\\ 0 \\\\ -12 \\\\ 19 \\end{pmatrix} $$\n\n**任务2：推导节点力的变换并构建全局节点荷载向量 $F_g$**\n\n从局部坐标系到全局坐标系的节点力变换由虚功不变性原理 $\\delta W$ 推导得出。\n$$ \\delta W = (\\delta d_g)^{\\mathsf{T}} F_g = (\\delta d_l)^{\\mathsf{T}} F_l $$\n其中 $d_g$ 和 $d_l$ 是全局和局部节点位移向量，$F_g$ 和 $F_l$ 是相应的节点荷载向量。\n\n局部位移 $d_l$ 通过变换矩阵 $T$ 与全局位移 $d_g$ 相关联：\n$$ d_l = T d_g $$\n位移的变分遵循相同的规则：$\\delta d_l = T \\delta d_g$。将此代入虚功方程：\n$$ (\\delta d_g)^{\\mathsf{T}} F_g = (T \\delta d_g)^{\\mathsf{T}} F_l = (\\delta d_g)^{\\mathsf{T}} T^{\\mathsf{T}} F_l $$\n由于此等式对任意非零虚位移向量 $\\delta d_g$ 都必须成立，我们可以得出结论：\n$$ F_g = T^{\\mathsf{T}} F_l $$\n矩阵 $T$ 将全局自由度变换为局部自由度。对于单个节点，该变换将 $(u_{X}, u_{Y}, \\varphi_{Z})$ 与 $(u_{x}, u_{y}, \\varphi_{z})$ 相关联。平移分量发生旋转，而面内转角 $\\varphi_z$ 是不变的。\n局部坐标是通过将全局坐标旋转角度 $-\\theta$ 得到的。该变换由下式给出：\n$$ \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} u_X \\\\ u_Y \\end{pmatrix} $$\n这个 $2 \\times 2$ 矩阵是 $Q^{\\mathsf{T}}$，即从局部到全局的旋转矩阵 $Q$ 的转置。\n$$ Q = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} $$\n节点转角是不变的：$\\varphi_z = \\varphi_Z$。一个节点的自由度变换由矩阵 $T_{node}$ 描述：\n$$ T_{node} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ -\\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n完整的单元变换矩阵 $T$ 是一个 $6 \\times 6$ 的分块对角矩阵：\n$$ T = \\begin{pmatrix} T_{node} & \\mathbf{0} \\\\ \\mathbf{0} & T_{node} \\end{pmatrix} $$\n力变换需要 $T^{\\mathsf{T}}$：\n$$ T^{\\mathsf{T}} = \\begin{pmatrix} T_{node}^{\\mathsf{T}} & \\mathbf{0} \\\\ \\mathbf{0} & T_{node}^{\\mathsf{T}} \\end{pmatrix} \\quad \\text{其中} \\quad T_{node}^{\\mathsf{T}} = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n令 $R = T_{node}^{\\mathsf{T}}$。全局力向量 $F_g$ 是通过分别使用 $R$ 变换节点 $i$ 和 $j$ 处的节点力得到的：\n$$ F_{g,i} = \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = R \\begin{pmatrix} f_{x,i} \\\\ f_{y,i} \\\\ m_{z,i} \\end{pmatrix} \\quad \\text{和} \\quad F_{g,j} = \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = R \\begin{pmatrix} f_{x,j} \\\\ f_{y,j} \\\\ m_{z,j} \\end{pmatrix} $$\n\n**任务3：计算显式的全局分量**\n\n给定 $\\theta = \\pi/3$：\n$\\cos(\\pi/3) = 1/2$\n$\\sin(\\pi/3) = \\sqrt{3}/2$\n\n变换矩阵 $R$ 为：\n$$ R = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n局部节点荷载为 $F_{l,i} = (0, 12, 5)^{\\mathsf{T}}$ 和 $F_{l,j} = (0, -12, 19)^{\\mathsf{T}}$。\n\n对于节点 $i$：\n$$ \\begin{pmatrix} f_{X,i} \\\\ f_{Y,i} \\\\ m_{Z,i} \\end{pmatrix} = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 12 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(12) + (0)(5) \\\\ (\\sqrt{3}/2)(0) + (1/2)(12) + (0)(5) \\\\ (0)(0) + (0)(12) + (1)(5) \\end{pmatrix} = \\begin{pmatrix} -6\\sqrt{3} \\\\ 6 \\\\ 5 \\end{pmatrix} $$\n\n对于节点 $j$：\n$$ \\begin{pmatrix} f_{X,j} \\\\ f_{Y,j} \\\\ m_{Z,j} \\end{pmatrix} = \\begin{pmatrix} 1/2 & -\\sqrt{3}/2 & 0 \\\\ \\sqrt{3}/2 & 1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -12 \\\\ 19 \\end{pmatrix} = \\begin{pmatrix} (1/2)(0) + (-\\sqrt{3}/2)(-12) + (0)(19) \\\\ (\\sqrt{3}/2)(0) + (1/2)(-12) + (0)(19) \\\\ (0)(0) + (0)(-12) + (1)(19) \\end{pmatrix} = \\begin{pmatrix} 6\\sqrt{3} \\\\ -6 \\\\ 19 \\end{pmatrix} $$\n\n最终的全局节点荷载向量 $F_g$ 由这些分量组合而成：\n$F_g = (f_{X,i}, f_{Y,i}, m_{Z,i}, f_{X,j}, f_{Y,j}, m_{Z,j})^{\\mathsf{T}} = (-6\\sqrt{3}, 6, 5, 6\\sqrt{3}, -6, 19)^{\\mathsf{T}}$\n\n**任务4：验证平衡性和刚度矩阵对称性**\n\n*   **节点平衡的保持：** 如果合力向量和合力矩向量（绕任意点）均为零，则力与力矩系统处于平衡状态。从局部坐标系到全局坐标系的变换是刚性旋转，这是一种保持向量和及力矩属性的仿射变换。\n    形式上，令局部坐标系中的总力向量为 $\\mathbf{F}_{total, l} = \\sum_{k} \\mathbf{F}_{l,k}$。问题陈述局部系统处于平衡状态，因此 $\\mathbf{F}_{total, l} = \\mathbf{0}$。全局坐标系中的总力为 $\\mathbf{F}_{total, g} = \\sum_{k} \\mathbf{F}_{g,k}$。每个力向量的变换关系为 $\\mathbf{F}_{g,k} = Q \\mathbf{F}_{l,k}$。\n    $$ \\mathbf{F}_{total, g} = \\sum_{k} (Q \\mathbf{F}_{l,k}) = Q \\left( \\sum_{k} \\mathbf{F}_{l,k} \\right) = Q \\mathbf{F}_{total, l} = Q \\mathbf{0} = \\mathbf{0} $$\n    因此，力的平衡得以保持。类似的论证也适用于力矩平衡。在一个坐标系中自平衡的力和力矩系统，在经过到另一个坐标系的刚性变换后，仍然保持自平衡。我们的数值结果证实了这一点：\n    $\\sum F_X = -6\\sqrt{3} + 6\\sqrt{3} = 0$。\n    $\\sum F_Y = 6 - 6 = 0$。\n\n*   **变换后刚度矩阵 $K_g$ 的对称性：** 从局部坐标到全局坐标的刚度矩阵变换由下式给出：\n    $$ K_g = T^{\\mathsf{T}} K_l T $$\n    我们已知局部刚度矩阵 $K_l$ 是对称的，即 $K_l^{\\mathsf{T}} = K_l$。我们必须验证 $K_g$ 也是对称的，即 $K_g^{\\mathsf{T}} = K_g$。\n    让我们计算 $K_g$ 的转置：\n    $$ K_g^{\\mathsf{T}} = (T^{\\mathsf{T}} K_l T)^{\\mathsf{T}} $$\n    使用乘积转置的性质 $(ABC)^{\\mathsf{T}} = C^{\\mathsf{T}} B^{\\mathsf{T}} A^{\\mathsf{T}}$：\n    $$ K_g^{\\mathsf{T}} = T^{\\mathsf{T}} (K_l)^{\\mathsf{T}} (T^{\\mathsf{T}})^{\\mathsf{T}} $$\n    使用转置的转置是原矩阵的性质 $(A^{\\mathsf{T}})^{\\mathsf{T}} = A$：\n    $$ K_g^{\\mathsf{T}} = T^{\\mathsf{T}} (K_l)^{\\mathsf{T}} T $$\n    因为 $K_l$ 是对称的，我们代入 $K_l^{\\mathsf{T}} = K_l$：\n    $$ K_g^{\\mathsf{T}} = T^{\\mathsf{T}} K_l T $$\n    这恰好是 $K_g$ 的定义。因此，$K_g^{\\mathsf{T}} = K_g$，证明了如果局部刚度矩阵是对称的，那么全局刚度矩阵也是对称的。该性质对于有限元法中使用的合同变换是基础性的。", "answer": "$$ \\boxed{\n\\begin{pmatrix} -6\\sqrt{3} & 6 & 5 & 6\\sqrt{3} & -6 & 19 \\end{pmatrix}\n} $$", "id": "3555039"}, {"introduction": "这项高级实践探讨了在处理材料属性和方向随空间变化的单元（例如曲梁或功能梯度材料）时出现的微妙问题。您将研究数值积分（高斯求积）与坐标变换之间至关重要的相互作用。通过比较严谨的逐点变换方法与一种常见的简化方法，您将量化潜在的误差，从而更深刻地理解一个稳健的有限元实现所需满足的要求。[@problem_id:3554988]", "problem": "考虑一个嵌入在二维环境空间中的一维曲线单元。设单元参数表示为 $\\xi \\in [-1,1]$。在每个 $\\xi$ 点，存在一个局部正交归一材料坐标系，该坐标系通过一个由连续可微的角度函数 $\\theta(\\xi)$（角度以弧度为单位）定义的正常正交旋转场 $R(\\xi) \\in \\mathbb{R}^{2 \\times 2}$ 与全局坐标系相关联。由于材料的功能梯度特性，局部材料刚度是空间变化的。该单元承受一个在局部材料坐标系中指定的分布载荷。\n\n您的推导和实现必须严格遵循适用于计算固体力学的基本原理：\n- 刚性旋转下的坐标系不变性和基变换：一个正常正交矩阵 $R(\\xi)$ 满足 $R(\\xi)^\\top R(\\xi) = I$，二次型的基变换对应于 $Q^{glob}(\\xi) = R(\\xi)^\\top Q^{loc}(\\xi) R(\\xi)$。\n- 线性叠加和通过 Gauss–Legendre 求积进行的数值积分：一个积分 $\\int_{-1}^{1} g(\\xi)\\, d\\xi$ 通过使用 $n$ 个 Gauss 点 $\\{\\xi_i\\}$ 和权重 $\\{w_i\\}$ 的加权和 $\\sum_{i=1}^{n} w_i\\, g(\\xi_i)$ 来近似。\n\n在 $\\xi \\in [-1,1]$ 上定义以下场：\n- 旋转场 $R(\\xi)$ 由下式给出\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\phantom{-}\\cos\\theta(\\xi)\n\\end{bmatrix}.\n$$\n- 功能梯度材料的局部刚度矩阵 $K^{loc}(\\xi) \\in \\mathbb{R}^{2 \\times 2}$，建模为对角半正定矩阵\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}, \\quad\nk_t(\\xi) = k_0 \\left(1 + \\alpha\\, \\xi\\right)^p, \\quad\nk_n(\\xi) = \\beta\\, k_t(\\xi),\n$$\n其中 $k_0 > 0$，$\\alpha \\in \\mathbb{R}$，$p \\ge 1$，且 $\\beta \\ge 0$。\n- 局部分布载荷向量 $f^{loc}(\\xi) \\in \\mathbb{R}^2$ 由下式给出\n$$\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}, \\quad\nq_t(\\xi) = q_0 \\left(1 + \\gamma\\, \\xi\\right), \\quad\nq_n(\\xi) = \\frac{1}{2}\\, q_0 \\cos\\left(\\pi\\, \\xi\\right),\n$$\n其中 $q_0 \\in \\mathbb{R}$ 且 $\\gamma \\in \\mathbb{R}$。\n\n根据基变换原理，在参数 $\\xi$ 处的坐标系一致的全局刚度密度和全局载荷密度由下式给出\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi), \\qquad\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi).\n$$\n单元一致集结量是以下积分\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi)\\, d\\xi, \\qquad\nL_{cons} = \\int_{-1}^{1} f^{glob}(\\xi)\\, d\\xi,\n$$\n使用 $n$ 个点的 Gauss–Legendre 求积进行数值计算，其中 $n$ 是一个固定的小整数。一种常用但可能不一致的简化方法是用在单元中心评估的单个旋转 $\\bar{R} = R(0)$ 来替代空间变化的旋转，并在积分后进行变换：\n$$\nS_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} K^{loc}(\\xi)\\, d\\xi \\right) \\bar{R}, \\qquad\nL_{naive} = \\bar{R}^\\top \\left( \\int_{-1}^{1} f^{loc}(\\xi)\\, d\\xi \\right).\n$$\n\n任务：\n1. 从上述基本原理出发，推导 $S_{cons}$、$L_{cons}$ 和 $S_{naive}$、$L_{naive}$ 的坐标系一致公式和简化（朴素）公式，并明确展示旋转场 $R(\\xi)$ 在积分内部的作用。\n2. 使用在 $\\xi \\in [-1,1]$ 上的 $n=8$ 点 Gauss–Legendre 求积实现这两种公式。\n3. 对于下面提供的每个测试用例，计算相对一致性误差\n$$\ne_K = \\frac{\\left\\| S_{naive} - S_{cons} \\right\\|_F}{\\left\\| S_{cons} \\right\\|_F}, \\qquad\ne_F = \\frac{\\left\\| L_{naive} - L_{cons} \\right\\|_2}{\\left\\| L_{cons} \\right\\|_2},\n$$\n其中 $\\|\\cdot\\|_F$ 表示矩阵的 Frobenius 范数，$\\|\\cdot\\|_2$ 表示向量的 Euclidean 范数。\n4. 角度必须以弧度处理。最终的数值答案是无量纲实数。\n\n测试套件（每个用例定义了 $\\theta(\\xi)$、$k_0$、$\\alpha$、$p$、$\\beta$、$q_0$、$\\gamma$）：\n- 用例 $1$（缓变旋转，弱梯度）：$\\theta(\\xi) = \\left(\\frac{\\pi}{6}\\right)\\, \\xi$, $k_0 = 1$, $\\alpha = 0.2$, $p = 2$, $\\beta = 0.3$, $q_0 = 1.0$, $\\gamma = 0.1$。\n- 用例 $2$（快变旋转，强梯度）：$\\theta(\\xi) = \\left(\\frac{\\pi}{2}\\right)\\, \\sin(\\pi\\, \\xi)$, $k_0 = 1$, $\\alpha = 0.5$, $p = 3$, $\\beta = 0.5$, $q_0 = 1.0$, $\\gamma = 0.5$。\n- 用例 $3$（恒定旋转，可变刚度）：$\\theta(\\xi) = \\frac{\\pi}{4}$, $k_0 = 1$, $\\alpha = 0.8$, $p = 2$, $\\beta = 0.2$, $q_0 = 2.0$, $\\gamma = 0.3$。\n- 用例 $4$（奇次三次旋转，恒定刚度）：$\\theta(\\xi) = \\pi\\, \\xi^3$, $k_0 = 1$, $\\alpha = 0.0$, $p = 1$, $\\beta = 0.4$, $q_0 = 1.5$, $\\gamma = 0.0$。\n\n您的程序必须为每个用例计算 $(e_K, e_F)$，并生成单行输出，其中包含一个逗号分隔的列表，按 $[e_{K,1}, e_{F,1}, e_{K,2}, e_{F,2}, e_{K,3}, e_{F,3}, e_{K,4}, e_{F,4}]$ 的顺序包含 8 个浮点数结果，并用方括号括起来，计算全程角度均以弧度解释。", "solution": "该问题要求推导和比较两种计算一维曲线单元的单元级集结刚度和载荷向量的方法：一种是坐标系一致的方法，另一种是计算上更简单但可能不准确的简化（朴素）方法。这种比较通过相对误差度量来量化。该问题是适定的，科学上基于计算固体力学的原理，并包含获得唯一数值解所需的所有信息。\n\n### 1. 公式推导\n\n设所有场变量都是单元参数 $\\xi \\in [-1, 1]$ 的函数。从局部材料坐标系到全局坐标系的旋转由角度 $\\theta(\\xi)$ 给出，它定义了正常正交旋转矩阵：\n$$\nR(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n局部刚度矩阵 $K^{loc}(\\xi)$ 和局部分布载荷向量 $f^{loc}(\\xi)$ 如下所示：\n$$\nK^{loc}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}, \\qquad\nf^{loc}(\\xi) =\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n$$\n\n#### 1.1. 坐标系一致公式\n该公式在积分前，对单元上每一点 $\\xi$ 都遵循坐标系不变性。首先通过将局部量变换到全局坐标系来逐点计算全局刚度和载荷密度 $K^{glob}(\\xi)$ 和 $f^{glob}(\\xi)$。\n\n全局载荷密度 $f^{glob}(\\xi)$ 通过向量的基变换法则求得：\n$$\nf^{glob}(\\xi) = R(\\xi)^\\top f^{loc}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nq_t(\\xi) \\\\\nq_n(\\xi)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nq_t(\\xi)\\cos\\theta(\\xi) + q_n(\\xi)\\sin\\theta(\\xi) \\\\\n-q_t(\\xi)\\sin\\theta(\\xi) + q_n(\\xi)\\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n全局刚度密度 $K^{glob}(\\xi)$ 通过二次型（或二阶张量）的基变换法则求得：\n$$\nK^{glob}(\\xi) = R(\\xi)^\\top K^{loc}(\\xi) R(\\xi)\n$$\n执行矩阵乘法可得：\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & \\sin\\theta(\\xi) \\\\\n-\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\nk_t(\\xi) & 0 \\\\\n0 & k_n(\\xi)\n\\end{bmatrix}\n\\begin{bmatrix}\n\\cos\\theta(\\xi) & -\\sin\\theta(\\xi) \\\\\n\\sin\\theta(\\xi) & \\cos\\theta(\\xi)\n\\end{bmatrix}\n$$\n$$\nK^{glob}(\\xi) =\n\\begin{bmatrix}\nk_t(\\xi)\\cos^2\\theta(\\xi) + k_n(\\xi)\\sin^2\\theta(\\xi) & (k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi) \\\\\n(k_n(\\xi) - k_t(\\xi))\\cos\\theta(\\xi)\\sin\\theta(\\xi) & k_t(\\xi)\\sin^2\\theta(\\xi) + k_n(\\xi)\\cos^2\\theta(\\xi)\n\\end{bmatrix}\n$$\n单元一致集结量 $S_{cons}$ 和 $L_{cons}$ 是这些全局密度在单元域上的积分：\n$$\nS_{cons} = \\int_{-1}^{1} K^{glob}(\\xi) \\,d\\xi, \\qquad L_{cons} = \\int_{-1}^{1} f^{glob}(\\xi) \\,d\\xi\n$$\n这些积分使用 $n$ 点 Gauss–Legendre 求积进行计算。对于一个通用被积函数 $g(\\xi)$：\n$$\n\\int_{-1}^{1} g(\\xi) \\,d\\xi \\approx \\sum_{i=1}^{n} w_i g(\\xi_i)\n$$\n其中 $\\{\\xi_i\\}$ 是 Gauss 点，$\\{w_i\\}$ 是对应的权重。对于此问题，$n=8$。因此，一致集结量计算如下：\n$$\nS_{cons} \\approx \\sum_{i=1}^{8} w_i K^{glob}(\\xi_i), \\qquad L_{cons} \\approx \\sum_{i=1}^{8} w_i f^{glob}(\\xi_i)\n$$\n\n#### 1.2. 简化（朴素）公式\n该公式颠倒了运算顺序：它首先对局部量进行积分，然后基于单元中心点 $\\xi=0$ 应用单一旋转。\n\n首先，计算积分后的局部刚度和载荷：\n$$\nK^{loc}_{int} = \\int_{-1}^{1} K^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} k_t(\\xi) & 0 \\\\ 0 & k_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} k_t(\\xi) \\,d\\xi & 0 \\\\ 0 & \\int_{-1}^{1} k_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\n$$\nf^{loc}_{int} = \\int_{-1}^{1} f^{loc}(\\xi) \\,d\\xi = \\int_{-1}^{1} \\begin{bmatrix} q_t(\\xi) \\\\ q_n(\\xi) \\end{bmatrix} \\,d\\xi = \\begin{bmatrix} \\int_{-1}^{1} q_t(\\xi) \\,d\\xi \\\\ \\int_{-1}^{1} q_n(\\xi) \\,d\\xi \\end{bmatrix}\n$$\n这些积分使用相同的 Gauss 求积方案进行数值计算：\n$$\nK^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i K^{loc}(\\xi_i), \\qquad f^{loc}_{int} \\approx \\sum_{i=1}^{8} w_i f^{loc}(\\xi_i)\n$$\n接下来，在单元中心 $\\xi=0$ 处评估一个单一的、恒定的旋转矩阵 $\\bar{R}$：\n$$\n\\bar{R} = R(0) =\n\\begin{bmatrix}\n\\cos\\theta(0) & -\\sin\\theta(0) \\\\\n\\sin\\theta(0) & \\cos\\theta(0)\n\\end{bmatrix}\n$$\n然后，通过将这个单一旋转应用于积分后的局部量来计算朴素集结量 $S_{naive}$ 和 $L_{naive}$：\n$$\nS_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}, \\qquad L_{naive} = \\bar{R}^\\top f^{loc}_{int}\n$$\n只有当旋转场 $R(\\xi)$ 在单元上是常数时，这种方法才是精确的，此时对于所有 $\\xi \\in [-1, 1]$ 都有 $\\bar{R} = R(\\xi)$。\n\n### 2. 误差度量\n两种公式之间的差异使用相对一致性误差 $e_K$ 和 $e_F$ 来衡量。\n\n刚度矩阵的误差使用 Frobenius 范数 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$ 来衡量：\n$$\ne_K = \\frac{\\| S_{naive} - S_{cons} \\|_F}{\\| S_{cons} \\|_F}\n$$\n载荷向量的误差使用 Euclidean 范数（或 $L_2$-范数）$\\|v\\|_2 = \\sqrt{\\sum_i |v_i|^2}$ 来衡量：\n$$\ne_F = \\frac{\\| L_{naive} - L_{cons} \\|_2}{\\| L_{cons} \\|_2}\n$$\n如果 $S_{cons}$ 或 $L_{cons}$ 的范数为零，则相应的误差取为零，这种情况当且仅当分子也为零时发生。\n\n### 3. 计算过程\n对于每个测试用例，数值实现将按以下步骤进行：\n1.  为用例定义与参数相关的函数：$\\theta(\\xi)$、$k_t(\\xi)$、$k_n(\\xi)$、$q_t(\\xi)$ 和 $q_n(\\xi)$。\n2.  获取 $n=8$ 个 Gauss-Legendre 求积点 $\\xi_i$ 和权重 $w_i$。\n3.  将四个累加器初始化为零：$S_{cons}$、$L_{cons}$、$K^{loc}_{int}$ 和 $f^{loc}_{int}$。\n4.  遍历 8 个 Gauss 点。在每个点 $\\xi_i$ 处：\n    a. 评估所有场函数：$\\theta(\\xi_i)$、$k_t(\\xi_i)$、$k_n(\\xi_i)$、$q_t(\\xi_i)$、$q_n(\\xi_i)$。\n    b. 构造矩阵 $R(\\xi_i)$ 和 $K^{loc}(\\xi_i)$，以及向量 $f^{loc}(\\xi_i)$。\n    c. 计算全局密度 $K^{glob}(\\xi_i) = R(\\xi_i)^\\top K^{loc}(\\xi_i) R(\\xi_i)$ 和 $f^{glob}(\\xi_i) = R(\\xi_i)^\\top f^{loc}(\\xi_i)$。\n    d. 将加权贡献加到一致性总和中：$S_{cons} \\leftarrow S_{cons} + w_i K^{glob}(\\xi_i)$ 和 $L_{cons} \\leftarrow L_{cons} + w_i f^{glob}(\\xi_i)$。\n    e. 将加权贡献加到朴素法中间总和中：$K^{loc}_{int} \\leftarrow K^{loc}_{int} + w_i K^{loc}(\\xi_i)$ 和 $f^{loc}_{int} \\leftarrow f^{loc}_{int} + w_i f^{loc}(\\xi_i)$。\n5.  循环结束后，计算朴素集结量：\n    a. 评估 $\\bar{R} = R(0)$。\n    b. 计算 $S_{naive} = \\bar{R}^\\top K^{loc}_{int} \\bar{R}$ 和 $L_{naive} = \\bar{R}^\\top f^{loc}_{int}$。\n6.  最后，使用指定的范数定义计算相对误差 $e_K$ 和 $e_F$。这两个值构成了该测试用例的结果。\n对所有四个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes consistency errors for two different FEA formulations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (theta_func, k0, alpha, p, beta, q0, gamma)\n    test_cases = [\n        (lambda xi: (np.pi / 6.0) * xi, 1.0, 0.2, 2, 0.3, 1.0, 0.1),\n        (lambda xi: (np.pi / 2.0) * np.sin(np.pi * xi), 1.0, 0.5, 3, 0.5, 1.0, 0.5),\n        (lambda xi: np.pi / 4.0, 1.0, 0.8, 2, 0.2, 2.0, 0.3),\n        (lambda xi: np.pi * (xi**3), 1.0, 0.0, 1, 0.4, 1.5, 0.0),\n    ]\n\n    # Number of Gauss-Legendre quadrature points\n    n_gauss = 8\n    gauss_points, gauss_weights = np.polynomial.legendre.leggauss(n_gauss)\n\n    results = []\n\n    for case in test_cases:\n        theta_func, k0, alpha, p, beta, q0, gamma = case\n\n        # Define material and load functions based on case parameters\n        def k_t(xi):\n            return k0 * (1.0 + alpha * xi)**p\n\n        def k_n(xi):\n            return beta * k_t(xi)\n\n        def q_t(xi):\n            return q0 * (1.0 + gamma * xi)\n\n        def q_n(xi):\n            return 0.5 * q0 * np.cos(np.pi * xi)\n\n        # Initialize aggregators\n        S_cons = np.zeros((2, 2))\n        L_cons = np.zeros(2)\n        K_loc_int = np.zeros((2, 2))\n        f_loc_int = np.zeros(2)\n\n        # Perform Gauss-Legendre quadrature\n        for i in range(n_gauss):\n            xi = gauss_points[i]\n            w = gauss_weights[i]\n\n            # Evaluate fields at the current Gauss point\n            th = theta_func(xi)\n            kt_val = k_t(xi)\n            kn_val = k_n(xi)\n            qt_val = q_t(xi)\n            qn_val = q_n(xi)\n            \n            # Construct local matrices and vectors\n            K_loc = np.array([[kt_val, 0.0], [0.0, kn_val]])\n            f_loc = np.array([qt_val, qn_val])\n\n            # Construct rotation matrix\n            c, s = np.cos(th), np.sin(th)\n            R = np.array([[c, -s], [s, c]])\n            R_T = R.T\n            \n            # --- Consistent Formulation: Transform then Integrate ---\n            K_glob = R_T @ K_loc @ R\n            f_glob = R_T @ f_loc\n            \n            S_cons += w * K_glob\n            L_cons += w * f_glob\n            \n            # --- Naive Formulation: Integrate then Transform ---\n            K_loc_int += w * K_loc\n            f_loc_int += w * f_loc\n\n        # Finalize the naive formulation calculation\n        th_0 = theta_func(0.0)\n        c0, s0 = np.cos(th_0), np.sin(th_0)\n        R_bar = np.array([[c0, -s0], [s0, c0]])\n        R_bar_T = R_bar.T\n\n        S_naive = R_bar_T @ K_loc_int @ R_bar\n        L_naive = R_bar_T @ f_loc_int\n        \n        # Calculate relative consistency errors\n        norm_S_cons = np.linalg.norm(S_cons, 'fro')\n        if norm_S_cons == 0.0:\n            e_K = 0.0\n        else:\n            e_K = np.linalg.norm(S_naive - S_cons, 'fro') / norm_S_cons\n\n        norm_L_cons = np.linalg.norm(L_cons)\n        if norm_L_cons == 0.0:\n            e_F = 0.0\n        else:\n            e_F = np.linalg.norm(L_naive - L_cons) / norm_L_cons\n        \n        results.extend([e_K, e_F])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3554988"}]}