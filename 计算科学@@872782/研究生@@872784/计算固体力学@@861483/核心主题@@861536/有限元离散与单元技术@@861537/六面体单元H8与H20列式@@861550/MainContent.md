## 引言
在[计算固体力学](@entry_id:169583)领域，对三维实体结构进行精确的数值模拟是工程设计与科学研究的基石。[六面体单元](@entry_id:174602)，特别是八节点（H8）和二十节点（H20）单元，因其高效性和在模拟中的广泛应用，构成了有限元分析的支柱。然而，尽管它们被广泛使用，标准低阶单元的内在局限性——例如在特定条件下表现出过刚行为的“闭锁”现象——对分析结果的可靠性构成了重大挑战。因此，深入理解这些单元的数学原理、性能瓶颈以及克服这些瓶颈的先进技术，对于任何[有限元分析](@entry_id:138109)者来说都至关重要。

本文旨在系统性地阐述H8与H20[六面体单元](@entry_id:174602)的理论与实践。我们将从第一性原理出发，引导读者穿越理论的殿堂，直面应用的挑战。在“原理与机制”一章中，我们将详细剖析这两种单元基于等参法的数学构造，并揭示闭锁和[沙漏模式](@entry_id:174855)等数值问题的根源。随后，在“应用与跨学科联系”一章中，我们将展示这些单元如何在[结构分析](@entry_id:153861)、[热力耦合](@entry_id:183230)和[接触力学](@entry_id:177379)等复杂场景中发挥作用，并探讨如何利用增强技术来获得准确可靠的解。最后，通过“动手实践”部分，读者将有机会亲手推导和分析单元的关键特性，从而将理论知识转化为扎实的实践技能。

## 原理与机制

本章旨在深入探讨[计算固体力学](@entry_id:169583)中三维实体建[模的基](@entry_id:156416)石——[六面体单元](@entry_id:174602)的公式化、原理和机制。我们将重点关注两种最常用的单元类型：八节点线性[六面体单元](@entry_id:174602)（H8）和二十节点二次[六面体单元](@entry_id:174602)（H20）。我们将从等参有限元法的基本概念出发，系统地构建这两种单元的理论框架，并探讨其在实际应用中遇到的关键数值问题，如数值积分、闭锁现象和稳定性。

### [等参单元](@entry_id:173863)法

在有限元法中，为了处理复杂的几何形状，通常采用一种强大的技术，即**[等参单元](@entry_id:173863)法**（isoparametric formulation）。该方法的核心思想是利用一个形状规则的**[参考单元](@entry_id:168425)**（reference element）或母单元（parent element），通过一个[坐标映射](@entry_id:747874)将其变换为描述物理域中真实几何形状的**物理单元**（physical element）。

对于[六面体单元](@entry_id:174602)，标准的[参考单元](@entry_id:168425)是一个立方体，其[局部坐标](@entry_id:181200)（或自然坐标）$(\xi, \eta, \zeta)$ 的取值范围为 $[-1, 1]^3$ [@problem_id:3570552]。从这个简单的参考域到复杂物理域的映射，以及物理单元内位移等场变量的近似，都使用同一组**形函数**（shape functions）$N_i$ 来完成，这便是“等参”一词的由来。

物理坐标 $\mathbf{x} = (x, y, z)$ 可以通过其节点坐标 $\mathbf{x}_i$ 和形函数 $N_i(\xi, \eta, \zeta)$ 进行插值：
$$
\mathbf{x}(\xi, \eta, \zeta) = \sum_{i=1}^{n} N_i(\xi, \eta, \zeta) \mathbf{x}_i
$$
其中 $n$ 是单元的节点总数。同样，单元内的[位移场](@entry_id:141476) $\mathbf{u}$ 也由其节点位移 $\mathbf{u}_i$ 进行插值：
$$
\mathbf{u}(\xi, \eta, \zeta) = \sum_{i=1}^{n} N_i(\xi, \eta, \zeta) \mathbf{u}_i
$$
形函数的一个基本要求是满足**克罗内克-德尔塔**（Kronecker-delta）性质，即在节点 $j$ 的位置，形函数 $N_i$ 的值为 $N_i(\boldsymbol{\xi}_j) = \delta_{ij}$。这意味着在任一节点上，插值得到的值精确等于该节点的节点值。

### 八节点[六面体单元](@entry_id:174602) (H8)

八节点线性[六面体单元](@entry_id:174602)，通常简称为 H8，是三维分析中最基础和最广泛使用的实体单元之一。它在[参考单元](@entry_id:168425)的八个角点处设置节点，坐标为 $(\pm 1, \pm 1, \pm 1)$。

#### H8 形函数的构造

H8 单元的形函数是**三线性**（trilinear）的，即它们是 $\xi, \eta, \zeta$ 三个坐标的[线性组合](@entry_id:154743)，包括它们的乘积项。一个通用的三线性函数形式为 $a_0 + a_1\xi + a_2\eta + a_3\zeta + a_4\xi\eta + a_5\eta\zeta + a_6\zeta\xi + a_7\xi\eta\zeta$。根据克罗内克-德尔[塔性质](@entry_id:273153)，我们可以系统地推导出每个节点的形函数。

以参考坐标为 $(-1, -1, -1)$ 的节点1为例，其形函数 $N_1$ 必须在该点等于1，而在其他七个角点处等于0。注意到其他七个角点至少有一个坐标为 $+1$。因此，一个满足零值条件的函数形式可以是 $(1-\xi)(1-\eta)(1-\zeta)$ 的倍数。为了满足 $N_1(-1,-1,-1)=1$，我们确定其系数。代入 $(-1,-1,-1)$，我们得到 $C(1-(-1))(1-(-1))(1-(-1)) = 8C$。令 $8C=1$，则 $C=1/8$。因此，节点1的形函数为：
$$
N_1(\xi, \eta, \zeta) = \frac{1}{8}(1-\xi)(1-\eta)(1-\zeta)
$$
通过类似的方法，可以推导出对应于任意角点 $(\xi_i, \eta_i, \zeta_i)$ 的通用形函数表达式 [@problem_id:3570574]：
$$
N_i(\xi, \eta, \zeta) = \frac{1}{8}(1+\xi_i\xi)(1+\eta_i\eta)(1+\zeta_i\zeta)
$$

#### H8 单元的性质与[几何映射](@entry_id:749852)

H8 单元的形函数具有**[单位分解](@entry_id:150115)**（partition of unity）的性质，即所有形函数之和恒等于1：$\sum_{i=1}^{8} N_i(\xi, \eta, \zeta) = 1$。这一性质保证了当所有节点位移相同时（刚体平移），单元内所有点的位移也相同。同时，H8 单元的形[函数空间](@entry_id:143478)完整包含了线性多项式基 $\{1, \xi, \eta, \zeta\}$，这意味着它可以精确表示线性[位移场](@entry_id:141476)。

[几何映射](@entry_id:749852)的特性由**[雅可比矩阵](@entry_id:264467)**（Jacobian matrix）$\mathbf{J}$ 描述，其定义为物理坐标对参考坐标的导数：$\mathbf{J} = \frac{\partial \mathbf{x}}{\partial \boldsymbol{\xi}}$。雅可比矩阵的[行列式](@entry_id:142978) $\det(\mathbf{J})$ 在几何上表示了物理空间中的微元体积 $dV$ 与参考空间中微元体积 $d\xi d\eta d\zeta$ 之间的比例关系，$dV = \det(\mathbf{J}) d\xi d\eta d\zeta$。

对于 H8 单元，其雅可比矩阵的元素通常是 $\xi, \eta, \zeta$ 的函数。然而，在一个特殊且重要的情况下，[雅可比矩阵](@entry_id:264467)是常数：当且仅当[几何映射](@entry_id:749852)是**仿射**（affine）的，即物理单元是一个平行六面体时。在这种情况下，$\det(\mathbf{J})$ 也是一个常数 [@problem_id:3570552]。例如，对于一个从参考立方体 $[-1,1]^3$ 到物理长方体 $[0,L_x]\times[0,L_y]\times[0,L_z]$ 的映射，其[雅可比行列式](@entry_id:137120)为常数 $\frac{L_x L_y L_z}{8}$ [@problem_id:3570574]。如果单元发生扭曲，$\det(\mathbf{J})$ 将不再是常数。

#### [应变-位移关系](@entry_id:173321)

在线性小应变理论中，应变张量 $\boldsymbol{\varepsilon}$ 是位移场 $\mathbf{u}$ 的对称梯度。为了计算应变，我们需要位移对物理坐标的导数。利用[链式法则](@entry_id:190743)，我们可以通过[雅可比矩阵](@entry_id:264467)的逆 $\mathbf{J}^{-1}$ 将对物理坐标的求导转换到参考[坐标系](@entry_id:156346)下：
$$
\frac{\partial}{\partial \mathbf{x}} = (\mathbf{J}^{-1})^{\mathsf{T}} \frac{\partial}{\partial \boldsymbol{\xi}}
$$
将位移插值公式代入，即可得到应变与节点位移之间的关系，这通常用**[应变-位移矩阵](@entry_id:163451)**（strain-displacement matrix）$\mathbf{B}$ 来表示：$\boldsymbol{\varepsilon} = \mathbf{B}\mathbf{u}$。$\mathbf{B}$ 矩阵的项包含了形函数对物理坐标的导数，因此它通常是 $(\xi, \eta, \zeta)$ 的函数。

### 二十节点[六面体单元](@entry_id:174602) (H20)

为了提高近似精度，可以使用[高阶单元](@entry_id:750328)。二十节点二次[六面体单元](@entry_id:174602)（H20）是一种常用的[高阶单元](@entry_id:750328)，它属于“serendipity”（巧凑）族。除了 H8 单元的8个角点外，H20 还在12条边的中点增加了节点，总计20个节点 [@problem_id:3570564]。

#### H20 形函数与性质

H20 单元的形函数是二次的。角点节点的形函数是修正后的三线性函数，而边中点节点的形函数是二次的。这些函数的构造确保了单元在边界上的位移插值是二次的。例如，在任一条边上，H20 的位移插值会退化为该边上三个节点（两个角点和一个中点）的一维二次[拉格朗日插值](@entry_id:167052) [@problem_id:3570564]。

与 H8 类似，H20 的形函数也满足[单位分解](@entry_id:150115)性质。更重要的是，H20 的形[函数空间](@entry_id:143478)完整包含了二次多项式基 $\{1, \xi, \eta, \zeta, \xi^2, \eta^2, \zeta^2, \xi\eta, \eta\zeta, \zeta\xi\}$。这意味着 H20 单元能够精确表示任意二次[位移场](@entry_id:141476)。然而，值得注意的是，一个完整的三维二次多项式空间（tri-quadratic）包含 $3^3=27$ 个项（如 $\xi^2\eta, \xi^2\eta^2$ 等），H20 单元的20个形函数无法张成这个完整的空间，因此它不能精确表示任意的、包含所有混合项的二次场 [@problem_id:3570564]。

#### [高阶单元](@entry_id:750328)的几何[表示能力](@entry_id:636759)

由于使用了二次形函数进行几何插值，H20 单元能够模拟具有弯曲边界的几何体。例如，如果一条边的中点节点在物理空间中不与两个角点共线，那么这条边将被映射为一条抛物线（二次曲线）[@problem_id:3570552]。这种能力使得 H20 单元在处理复杂[曲面](@entry_id:267450)几何时比 H8 单元具有显著优势。

### 单元性能与关键数值测试

评估一个有限元的性能和可靠性，需要依赖一系列标准测试。这些测试揭示了单元在何种条件下能够提供准确和收敛的解。

#### 连续性与收敛性

标准的 H8 和 H20 单元都属于**$C^0$ 连续单元**。这意味着在相邻单元的共享面上，[位移场](@entry_id:141476)是连续的，但其导数（即应变和应力）通常是不连续的。位移的连续性是保证能量有限和求解收敛的基本要求。要实现更高阶的 $C^1$ 连续性（位移及其一阶导数都连续），需要采用更复杂的单元，如 Hermite 单元 [@problem_id:3570564]。

#### [分片检验](@entry_id:162864) (The Patch Test)

**[分片检验](@entry_id:162864)**是判断有限元是否能收敛到正确解的必要条件。它要求当一个由任意形状单元组成的单元集（“片”）经受一个产生常应变状态的位移场时，单元内部计算出的应变也必须是常数，并与精确解一致。

H8 和 H20 单元都能通过[分片检验](@entry_id:162864)。其根本原因在于它们的形函数可以精确地表示线性[位移场](@entry_id:141476) $\mathbf{u}(\mathbf{x}) = \mathbf{a} + \mathbf{B}\mathbf{x}$（其中 $\mathbf{a}$ 是常向量，$\mathbf{B}$ 是常矩阵）。基于单位分解性质和等参插值公式，可以证明插值位移场 $\mathbf{u}_h$ 与精确线性场完全一致 [@problem_id:3570564] [@problem_id:3570577]。因此，无论单元的几何形状如何（只要映射有效），H8 和 H20 单元都能精确地再现任何常应变状态。这一性质是它们在工程实践中可靠性的理论保证，并且可以通过数值实验进行验证 [@problem_id:3570546]。

#### [收敛率](@entry_id:146534)

[收敛率](@entry_id:146534)描述了当网格尺寸 $h$ 减小时，有限元解的误差如何趋近于零。对于一个光滑的精确解，基于 $p$ 次多项式的单元，其位移的 $L^2$ 范数误差通常以 $O(h^{p+1})$ 的速率收敛。

*   **H8 单元**：其形函数完整覆盖了线性多项式（$p=1$），因此其理论[收敛率](@entry_id:146534)为 $O(h^2)$。
*   **H20 单元**：其形函数完整覆盖了二次多项式（$p=2$），因此其理论[收敛率](@entry_id:146534)为 $O(h^3)$。

数值实验可以验证这些理论[收敛率](@entry_id:146534)。通过在一系列加密的网格上计算[插值误差](@entry_id:139425)，可以观察到 H20 单元的误差下降速度确实快于 H8 单元 [@problem_id:3570546]。这表明，对于需要高精度的光滑解问题，使用[高阶单元](@entry_id:750328)通常比单纯加密低阶单元网格更具计算效率。

### [数值积分](@entry_id:136578)与荷载计算

有限元方法中的许多量，如[单元刚度矩阵](@entry_id:139369)和等效节点力，都是通过在单元域上积分得到的。由于被积函数通常是复杂的多项式或有理函数，这些积分几乎总是通过**[数值积分](@entry_id:136578)**（numerical integration）来完成。

#### [高斯求积](@entry_id:146011)

**[高斯-勒让德求积](@entry_id:138201)**（Gauss-Legendre quadrature）是有限元中最常用的[数值积分方法](@entry_id:141406)。一个 $n$ 点的[高斯求积法](@entry_id:146011)则可以在一维区间 $[-1, 1]$ 上精确地积分最高 $2n-1$ 次的多项式。对于三维[六面体单元](@entry_id:174602)，通常使用张量积形式的[求积法则](@entry_id:753909)，即在 $\xi, \eta, \zeta$ 每个方向上独立应用一维法则。

#### 完全积分方案

选择合适的积分点数量（即积分阶数）至关重要。**完全积分**（full integration）是指使用足够多的积分点来精确计算仿射（无扭曲）单元的[刚度矩阵](@entry_id:178659)。

*   **H8 单元**：对于一个仿射 H8 单元，其刚度矩阵的被积函数在每个参考坐标方向上是二次多项式。例如，应变项可能是 $\xi$ 的线性函数，而刚度矩阵包含应变项的平方，因此是二次的。要精确积分二次多项式，需要 $2n-1 \ge 2$，即 $n \ge 1.5$，故至少需要2个积分点。因此，H8 的完全积分方案是 $2 \times 2 \times 2$ [高斯点](@entry_id:170251) [@problem_id:3570551]。

*   **H20 单元**：对于一个仿射 H20 单元，其[位移场](@entry_id:141476)是二次的，应变场是线性的，但由于形函数导数中存在二次项，刚度矩阵的被积函数最高可达四次。例如，考虑一个弯曲变形模式 $u_\zeta = c\zeta^3$，其[应变能密度](@entry_id:200085)与 $\zeta^4$ 成正比。要精确积分四次多项式，需要 $2n-1 \ge 4$，即 $n \ge 2.5$，故至少需要3个积分点。因此，H20 的标准完全积分方案是 $3 \times 3 \times 3$ [高斯点](@entry_id:170251) [@problem_id:3570584]。选择较低的积分阶（如 $2 \times 2 \times 2$）会导致能量计算不准，从而影响解的精度。

#### [一致节点荷载](@entry_id:176954)与质量矩阵

外力（如体力和面力）也必须通[过积分](@entry_id:753033)转换为施加在节点上的**[一致节点荷载](@entry_id:176954)**（consistent nodal forces）。其原理源于虚功原理，节点力 $F_i$ 由下式给出：
$$
F_i = \int_V N_i \mathbf{b} \, dV + \int_S N_i \mathbf{t} \, dS
$$
其中 $\mathbf{b}$ 是[体力](@entry_id:174230)，$\mathbf{t}$ 是面力。由于 H8 和 H20 单元的形函数不同，即使在相同的表面荷载作用下，它们分配到节点上的力也是不同的。例如，对于一个二次[分布](@entry_id:182848)的面力，H20 单元由于其二次形函数，能更精确地捕捉荷载[分布](@entry_id:182848)的细节，并将其一致地分配给角点和边中点节点，而 H8 单元的线性形函数则会产生一种“平滑化”的近似分配 [@problem_id:3570541]。

类似地，在动力学分析中，**[一致质量矩阵](@entry_id:174630)**（consistent mass matrix）也通过形函数的积分得到，$M_{ij} = \int_V \rho N_i N_j \, dV$。这个矩阵捕捉了惯性力的连续分布，比简单的[集中质量矩阵](@entry_id:173011)更精确 [@problem_id:3570574]。

### 高级主题：闭锁与稳定化

在固体力学应用中，尤其是在处理薄结构或[不可压缩材料](@entry_id:159741)时，低阶单元（如 H8）可能会表现出病态行为，即所谓的**闭锁**（locking）现象。

#### 体积闭锁现象

当材料接[近不可压缩](@entry_id:752387)时（即[泊松比](@entry_id:158876) $\nu \to 0.5$），体积模量 $K$ 相对于[剪切模量](@entry_id:167228) $\mu$ 变得极大。为了使[应变能](@entry_id:162699)保持有限，材料的[体积应变](@entry_id:267252) $\varepsilon_{vol} = \mathrm{tr}(\boldsymbol{\varepsilon})$ 必须趋近于零。

对于一个使用完全积分的 H8 单元（$2 \times 2 \times 2$ [高斯点](@entry_id:170251)），这意味着[不可压缩性约束](@entry_id:750592) $\mathrm{tr}(\boldsymbol{\varepsilon}) = 0$ 被强制在全部8个积分点上满足。然而，H8 单元的运动模式（kinematics）过于简单，其三线性位移场产生的线性应变场很难在满足8个点约束的同时还能表现出复杂的变形模式（如弯曲）。结果是，为了满足这些过多的约束，单元表现得异常刚硬，无法正确变形，这种现象称为**体积闭锁**（volumetric locking）[@problem_id:3570575]。同样的问题也存在于使用 $3 \times 3 \times 3$ 完全积分的 H20 单元中。

#### [减缩积分](@entry_id:167949)与[沙漏模式](@entry_id:174855)

解决闭锁问题的一种常用方法是**[减缩积分](@entry_id:167949)**（reduced integration）。对于 H8 单元，这意味着使用单[点积](@entry_id:149019)分（$1 \times 1 \times 1$ [高斯点](@entry_id:170251)）来计算刚度矩阵。此时，[不可压缩性约束](@entry_id:750592)仅在单元中心一点被强制执行，极大地放宽了约束，从而有效地缓解了体积闭锁 [@problem_id:3570551]。

然而，[减缩积分](@entry_id:167949)带来了新的问题：**[沙漏模式](@entry_id:174855)**（hourglass modes）或称**[伪零能模式](@entry_id:755267)**（spurious zero-energy modes）。一个稳定的[单元刚度矩阵](@entry_id:139369)应该只有6个零[特征值](@entry_id:154894)，对应于6个刚体运动模式。但对于使用单[点积](@entry_id:149019)分的 H8 单元，其刚度矩阵的秩只有6，而不是所需的 $24-6=18$。这意味着它有 $18-6=12$ 个额外的[零能模式](@entry_id:172472) [@problem_id:3570597]。这些模式是单元可以发生的、在积分点处不产生应变（因此不产生[应变能](@entry_id:162699)）的非物理变形。它们就像沙漏的形状，使得单元在没有外力抵抗的情况下就能轻易地扭曲，导致计算结果出现剧烈[振荡](@entry_id:267781)，甚至完全失效。

#### 体积闭锁的解决方案：[选择性减缩积分](@entry_id:168281)与 B-bar 方法

为了在避免闭锁的同时抑制[沙漏模式](@entry_id:174855)，发展了更为精巧的方法。

*   **[选择性减缩积分 (SRI)](@entry_id:754659)**：此方法将单元刚度在概念上分解为**体积**（volumetric）和**偏应力**（deviatoric）两部分。体积部分与体积变形相关，是导致闭锁的根源；[偏应力](@entry_id:163323)部分与形状改变相关。SRI 方法对这两部分采用不同的积分方案：对易于闭锁的体积部分采用[减缩积分](@entry_id:167949)（如H8用1[点积](@entry_id:149019)分），而对提供主要[抗变](@entry_id:192290)形能力的偏应力部分仍采用完全积分（如H8用 $2 \times 2 \times 2$ [点积](@entry_id:149019)分）。这样既能消除体积闭锁，又能通过完全积分的[偏应力](@entry_id:163323)部分有效抑制[沙漏模式](@entry_id:174855)，保证单元的稳定性 [@problem_id:3570575] [@problem_id:3570551]。

*   **B-bar 方法**：这是一种在公式层面修改[应变-位移关系](@entry_id:173321)的方法。它将标准 B 矩阵计算出的[体积应变](@entry_id:267252) $\mathrm{tr}(\boldsymbol{\varepsilon})$ 投影到一个更低阶的空间（例如，替换为单元内的平均[体积应变](@entry_id:267252) $\overline{\mathrm{tr}(\boldsymbol{\varepsilon})}$），然后用这个修正后的[体积应变](@entry_id:267252)去计算应力。而[偏应变](@entry_id:201263)部分则保持不变。这种方法同样能有效缓解体积闭锁，同时保留了单元正确的抗剪切性能，且通常不会引入不稳定性 [@problem_id:3570575]。

#### [沙漏控制](@entry_id:163812)

对于必须使用[减缩积分](@entry_id:167949)（例如在某些[显式动力学](@entry_id:171710)算法中）且无法使用 SRI 的情况，必须直接处理[沙漏模式](@entry_id:174855)。**[沙漏控制](@entry_id:163812)**（hourglass control）是一种通过添加一个小的、物理上合理的“人工”刚度来惩罚沙漏变形的技术。

具体做法是，首先识别出单元的[沙漏模式](@entry_id:174855)向量（它们是单元 B 矩阵零空间中与[刚体运动](@entry_id:193355)模式正交的向量）。然后，构造一个**稳定化[刚度矩阵](@entry_id:178659)** $\mathbf{K}_{hg}$，它只在[沙漏模式](@entry_id:174855)对应的变形方向上产生恢复力，而在其他方向上（包括刚体运动）不起作用。最终的[单元刚度矩阵](@entry_id:139369)为 $\mathbf{K}_{stab} = \mathbf{K}_{phys} + \mathbf{K}_{hg}$，其中 $\mathbf{K}_{phys}$ 是由[减缩积分](@entry_id:167949)计算的物理刚度。通过这种方式，稳定化后的[刚度矩阵](@entry_id:178659)恢复了正确的秩，消除了[伪零能模式](@entry_id:755267)，使得单元在计算中表现稳定 [@problem_id:3570597]。