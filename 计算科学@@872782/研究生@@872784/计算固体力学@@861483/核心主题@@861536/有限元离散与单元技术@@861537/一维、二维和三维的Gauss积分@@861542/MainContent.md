## 引言
在现代工程与[科学计算](@entry_id:143987)中，尤其是在[有限元法](@entry_id:749389)（FEM）等数值技术中，我们常常需要对复杂函数在任意形状的区域上进行积分，以计算物理系统的响应。然而，这些积分往往难以甚至不可能求得解析解，这构成了一个核心的计算挑战。[高斯积分](@entry_id:187139)（Gauss Quadrature）作为一种高效且极其精确的[数值积分方法](@entry_id:141406)，为解决这一难题提供了强有力的工具。本文旨在系统性地介绍一维、二维及三维空间中的[高斯积分](@entry_id:187139)理论及其在[计算固体力学](@entry_id:169583)中的应用。

本文将分为三个核心章节，引导读者从理论走向实践。在“原理与机制”一章中，我们将深入探讨[高斯积分](@entry_id:187139)如何通过优化选择积分点来达到惊人的精度，并介绍其在多维空间中的实现方式。接下来，在“应用与交叉学科联系”一章中，我们将展示高斯积分如何在[有限元分析](@entry_id:138109)中扮演基石角色，并探讨[减缩积分](@entry_id:167949)等高级策略如何解决[体积锁定](@entry_id:172606)等实际工程难题。最后，通过“动手实践”部分，您将有机会通过具体的编程练习，将所学理论应用于解决实际问题。

让我们首先进入第一章，深入了解[高斯积分](@entry_id:187139)背后的基本原理和精妙机制。

## 原理与机制

在上一章中，我们介绍了在[计算固体力学](@entry_id:169583)中进行[数值积分](@entry_id:136578)的必要性，尤其是在有限元法 (Finite Element Method, FEM) 的背景下。当处理复杂的几何形状和[材料非线性](@entry_id:162855)时，[单元刚度矩阵](@entry_id:139369)和力向量的计算通常归结为在参考域（如一维区间 $[-1,1]$、二维正方形 $[-1,1]^2$ 或三维立方体 $[-1,1]^3$）上对复杂函数进行积分。本章将深入探讨[高斯积分](@entry_id:187139) (Gauss quadrature) 的基本原理和机制，这是一种功能强大且在计算力学中应用广泛的数值积分技术。我们将从一维情况下的基本理论开始，扩展到多维[张量积法则](@entry_id:177156)，并探讨其在有限元分析中的实际应用、挑战和高级策略。

### 高斯-勒让德一维积分

[数值积分](@entry_id:136578)，或称数值求积 (quadrature)，旨在用一个带权重的函数在特定点（称为**节点**或**横坐标**）上的取值之和来近似一个[定积分](@entry_id:147612)：
$$
\int_{a}^{b} w(x) f(x) \,dx \approx \sum_{i=1}^{n} W_i f(x_i)
$$
其中 $w(x)$ 是一个非负的权函数。[高斯积分](@entry_id:187139)的核心思想是：通过明智地选择 $n$ 个节点 $x_i$ 和 $n$ 个权重 $W_i$，我们可以达到最高可能的**精度阶** (degree of exactness)，即能够精确积分尽可能高阶的多项式。

#### 最优精度原理

对于在区间 $[-1,1]$ 上且权函数为 $w(x)=1$ 的积分，最重要的[高斯积分](@entry_id:187139)类型是**高斯-勒让德积分** (Gauss-Legendre quadrature)。与**牛顿-柯特斯 (Newton-Cotes) 法则**（如梯形法则或辛普森法则）等预先固定节点（通常是等距[分布](@entry_id:182848)）的方法不同，[高斯积分](@entry_id:187139)通过优化节点的位置来获得卓越的精度。

一条具有 $n$ 个节点和 $n$ 个权重的积分法则总共有 $2n$ 个自由度。[高斯积分](@entry_id:187139)的精妙之处在于，它利用这 $2n$ 个自由度来精确积分所有次数不超过 $2n-1$ 的多项式。这一[精度阶](@entry_id:145189)是任何 $n$ [点积](@entry_id:149019)分法则所能达到的理论上限。实现这一目标的关键在于节点 $x_i$ 的选择：对于 $n$ 点高斯-勒让德积分，节点被选为 $n$ 阶**勒让德多项式** (Legendre polynomial) $P_n(x)$ 的 $n$ 个根。[勒让德多项式](@entry_id:141510)是在区间 $[-1,1]$ 上关于单位权函数 $w(x)=1$ 正交的一族多项式。

这些节点（$P_n(x)$ 的根）有几个重要的性质：它们都位于[开区间](@entry_id:157577) $(-1,1)$ 内，是互不相同的实数。这意味着高斯-勒让德积分点永远不会包含积分区间的端点 $-1$ 和 $1$ [@problem_id:3567621]。与此相关的权重 $W_i$ 也被证明是严格为正的，这对数值稳定性至关重要。相比之下，一个 $n$ 点的闭式[牛顿-柯特斯法则](@entry_id:171388)使用包括端点在内的[等距节点](@entry_id:168260)，其[精度阶](@entry_id:145189)通常为 $n-1$（当 $n$ 为奇数时为 $n$），远低于高斯积分的 $2n-1$ [@problem_id:3567621]。

#### [精度阶](@entry_id:145189)的推导

为什么选择[勒让德多项式](@entry_id:141510)的根能够得到 $2n-1$ 的精度阶？我们可以通过一个基于正交性的优雅论证来证明这一点 [@problem_id:3567565]。

考虑一个任意次数不高于 $2n-1$ 的多项式 $f(x)$。我们可以用 $n$ 阶[勒让德多项式](@entry_id:141510) $P_n(x)$ 去除 $f(x)$，得到一个商多项式 $q(x)$ 和一个余多项式 $r(x)$：
$$
f(x) = q(x) P_n(x) + r(x)
$$
由于 $f(x)$ 的次数 $\le 2n-1$，$P_n(x)$ 的次数为 $n$，因此商 $q(x)$ 和余数 $r(x)$ 的次数都将不高于 $n-1$。

首先，我们对 $f(x)$ 进行精确积分：
$$
\int_{-1}^{1} f(x) \,dx = \int_{-1}^{1} q(x) P_n(x) \,dx + \int_{-1}^{1} r(x) \,dx
$$
勒让德多项式族 $\{P_k(x)\}$ 在 $[-1,1]$ 上是正交的，即 $\int_{-1}^{1} P_k(x) P_m(x) \,dx = 0$ 当 $k \neq m$。由于 $q(x)$ 的次数 $\le n-1$，它可以表示为[勒让德多项式](@entry_id:141510) $P_0(x), \dots, P_{n-1}(x)$ 的[线性组合](@entry_id:154743)。因此，$q(x)$ 与 $P_n(x)$ 正交，第一个积分项为零：
$$
\int_{-1}^{1} q(x) P_n(x) \,dx = 0
$$
于是，精确积分的结果简化为：
$$
\int_{-1}^{1} f(x) \,dx = \int_{-1}^{1} r(x) \,dx
$$

接下来，我们考察 $n$ 点高斯积分求和。根据定义，高斯节点 $x_i$ 是 $P_n(x)$ 的根，所以 $P_n(x_i) = 0$。在这些节点上计算 $f(x)$ 的值：
$$
f(x_i) = q(x_i) P_n(x_i) + r(x_i) = q(x_i) \cdot 0 + r(x_i) = r(x_i)
$$
因此，高斯积分求和变为：
$$
\sum_{i=1}^{n} W_i f(x_i) = \sum_{i=1}^{n} W_i r(x_i)
$$
[高斯积分法](@entry_id:178260)则被构建为至少能精确积分所有次数不高于 $n-1$ 的多项式。由于 $r(x)$ 的次数 $\le n-1$，[高斯积分](@entry_id:187139)对其是精确的：
$$
\sum_{i=1}^{n} W_i r(x_i) = \int_{-1}^{1} r(x) \,dx
$$
通过比较，我们发现对于任何次数不高于 $2n-1$ 的多项式 $f(x)$，高斯积分的求和结果与精确积分值相等。为了证明 $2n-1$ 是最高的[精度阶](@entry_id:145189)，只需考虑一个 $2n$ 次多项式，例如 $f(x) = [P_n(x)]^2$。它的精确积分 $\int_{-1}^{1} [P_n(x)]^2 \,dx$ 是一个正数，而高斯积分求和 $\sum W_i [P_n(x_i)]^2 = \sum W_i \cdot 0 = 0$。由于结果不相等，该法则对于 $2n$ 次多项式不是精确的。

### 数值构造与[误差分析](@entry_id:142477)

#### [Golub-Welsch算法](@entry_id:749964)

理论上的最优性固然重要，但如何在实践中高效、准确地计算出高斯-勒让德积分的节点 $x_i$ 和权重 $W_i$ 呢？一种稳定且广泛使用的方法是 **Golub-Welsch 算法** [@problem_id:3567593]。该算法巧妙地将寻找[积分节点和权重](@entry_id:146264)的问题转化为了一个[对称三对角矩阵](@entry_id:755732)的[特征值问题](@entry_id:142153)。

这个过程的核心是[正交多项式](@entry_id:146918)都满足的**[三项递推关系](@entry_id:176845)**。对于在 $[-1,1]$ 上关于单位权重 $w(x)=1$ 的**标准正交**勒让德多项式族 $\{\varphi_k(x)\}$，该关系式具有如下形式：
$$
x \varphi_k(x) = a_{k+1} \varphi_{k+1}(x) + a_k \varphi_{k-1}(x)
$$
由于积分区间和权函数都是对称的，对角项系数为零。递推系数 $a_k$ 可以被推导为 $a_k = k / \sqrt{4k^2 - 1}$。

这个[递推关系](@entry_id:189264)可以写成一个 $n \times n$ 的[对称三对角矩阵](@entry_id:755732)，称为**[雅可比矩阵](@entry_id:264467) (Jacobi matrix)** $J_n$：
$$
J_n = \begin{pmatrix}
0 & a_1 & 0 & \dots & 0 \\
a_1 & 0 & a_2 & \ddots & \vdots \\
0 & a_2 & 0 & \ddots & 0 \\
\vdots & \ddots & \ddots & \ddots & a_{n-1} \\
0 & \dots & 0 & a_{n-1} & 0
\end{pmatrix}
$$
Golub-Welsch 算法的关键结论是：
1.  $n$ 点高斯-勒让德积分的**节点** $x_i$ 正是这个雅可比矩阵 $J_n$ 的 $n$ 个[特征值](@entry_id:154894)。
2.  积分的**权重** $W_i$ 可以从归一化的[特征向量](@entry_id:151813) $q_i$ 的第一个分量 $q_{i,1}$ 计算得到：$W_i = \mu_0 (q_{i,1})^2$，其中 $\mu_0 = \int_{-1}^{1} 1 \,dx = 2$。

由于[雅可比矩阵](@entry_id:264467)是高度结构化的[对称三对角矩阵](@entry_id:755732)，其特征值问题可以使用非常高效的数值算法（如三对角 QR 算法）在 $\mathcal{O}(n^2)$ 时间内解决。这使得 Golub-Welsch 算法成为计算高精度[高斯积分法](@entry_id:178260)则的标准方法。

#### 非多项式函数的[误差估计](@entry_id:141578)

当被积函数 $f(x)$ 不是多项式时，[高斯积分](@entry_id:187139)只能给出一个近似值。量化这个近似的误差对于确保计算结果的可靠性至关重要。对于一个在 $[-1,1]$ 上具有 $2n$ 阶连续导数的函数 $f(x)$，其 $n$ 点高斯-勒让德积分的误差 $E[f]$ 可以表示为 [@problem_id:3567594]：
$$
E[f] = \int_{-1}^{1} f(x) \,dx - \sum_{i=1}^{n} W_i f(x_i) = \frac{2^{2n+1}(n!)^4}{(2n+1)[(2n)!]^3} f^{(2n)}(\eta)
$$
其中 $\eta$ 是位于 $(-1,1)$ 内的某个点。这个公式来源于对 $f(x)$ 和它的导数在 $n$ 个高斯节点上进行 Hermite 插值所产生的误差。

这个误差公式在实践中非常有用。如果我们能够估计出函数 $2n$ 阶导数的[上界](@entry_id:274738) $M_{2n} = \max_{x \in [-1,1]} |f^{(2n)}(x)|$，我们就可以预先确定需要多少个积分点 $n$ 才能保证[积分误差](@entry_id:171351)小于给定的容差 $\varepsilon$。

例如，考虑积分 $I = \int_{-1}^{1} \cosh(x) \,dx$。该函数的任意偶数阶导数都是 $\cosh(x)$ 本身，其在 $[-1,1]$ 上的最大值为 $\cosh(1)$。如果我们希望误差 $|E[f]| \le 10^{-4}$，我们可以通过代入误差公式并逐一尝试 $n=1, 2, 3, \dots$ 来找到满足条件的最小 $n$。计算表明，对于 $n=2$，[误差界](@entry_id:139888)约为 $0.0114$，不满足要求；而对于 $n=3$，[误差界](@entry_id:139888)约为 $9.8 \times 10^{-5}$，小于 $10^{-4}$。因此，我们只需要 $n=3$ 个积分点就能保证所需的精度 [@problem_id:3567594]。这充分展示了高斯积分对于光滑非多项式函数的快速收敛性。

### [多维积分](@entry_id:184252)：张量积法

在二维和三维问题中，我们需要在正方形或立方体等区域上进行积分。处理这类区域最直接的方法是**张量积 (tensor-product)** 构造。

#### 等参元的通用流程

考虑在[有限元分析](@entry_id:138109)中，计算一个物理单元 $\Omega_e$ 上的积分 $\int_{\Omega_e} f(x) \,d\Omega$。通过[等参映射](@entry_id:173239) $F: \hat{\Omega} \to \Omega_e$，我们将物理单元上的积分转换为在参考立方体 $\hat{\Omega}=[-1,1]^3$ 上的积分。根据[变量替换定理](@entry_id:160749)，[积分变换](@entry_id:186209)为 [@problem_id:3567580]：
$$
\int_{\Omega_e} f(x) \,d\Omega = \int_{\hat{\Omega}} f(F(\xi)) \left|\det J(\xi)\right| \,d\hat{\Omega}
$$
其中 $\xi=(\xi, \eta, \zeta)$ 是参考坐标，$J(\xi)$ 是映射 $F$ 的[雅可比矩阵](@entry_id:264467)，其[行列式](@entry_id:142978) $\det J(\xi)$ 描述了从参考坐标到物理坐标的局部体积变化。

由于参考域 $\hat{\Omega}=[-1,1]^3$ 是三个一维区间的[笛卡尔积](@entry_id:154642)，我们可以应用[张量积法则](@entry_id:177156)。这意味着我们分别在 $\xi, \eta, \zeta$ 每个方向上应用一维高斯-勒让德积分。如果每个方向都使用 $n$ 个点，则总的积分点集合是 $n^3$ 个点的三维网格 $\{(\xi_i, \eta_j, \zeta_k)\}_{i,j,k=1}^n$。对应的权重是相应一维权重的乘积 $W_{ijk} = W_i W_j W_k$。

因此，三维积分的近似计算流程如下：
$$
\int_{\Omega_e} f(x) \,d\Omega \approx \sum_{i=1}^n \sum_{j=1}^n \sum_{k=1}^n (W_i W_j W_k) \, f(F(\xi_i, \eta_j, \zeta_k)) \left|\det J(\xi_i, \eta_j, \zeta_k)\right|
$$
这个过程的本质是在参考域的每个[张量积](@entry_id:140694)[高斯点](@entry_id:170251)上，计算被积函数在对应物理点的值，乘以该点的雅可比行列式，最后再乘以该[高斯点](@entry_id:170251)的组合权重，然后将所有点的贡献加起来。任何简化（例如，忽略雅可比行列式或使用一个常数值代替它）通常都会导致不准确的结果，除非映射是简单的仿射变换 [@problem_id:3567580]。

#### [张量积法则](@entry_id:177156)的[精度阶](@entry_id:145189)

[张量积法则](@entry_id:177156)的[精度阶](@entry_id:145189)遵循一个直接但重要的规则。如果一个二维[张量积](@entry_id:140694)积分在 $\xi$ 方向使用 $n_x$ 个点，在 $\eta$ 方向使用 $n_y$ 个点，那么它能精确积分任何可以分离变量的多项式 $p(\xi)q(\eta)$，其中 $p(\xi)$ 的次数 $\le 2n_x-1$ 且 $q(\eta)$ 的次数 $\le 2n_y-1$ [@problem_id:3567621]。

然而，在有限元中，我们更关心的是对**总次数** (total degree) 的多项式的精确性。一个总次数为 $t$ 的多项式 $p(\xi, \eta)$ 是形如 $\xi^i \eta^j$ 且 $i+j \le t$ 的所有项的线性组合。为了保证对所有这些项都精确积分，我们必须满足最坏情况的要求。最坏的情况是纯次幂项，如 $\xi^t$ 和 $\eta^t$。为了精确积分 $\xi^t$，我们需要 $t \le 2n_x-1$。为了精确积分 $\eta^t$，我们需要 $t \le 2n_y-1$。这两个条件必须同时满足。

因此，一个 $(n_x, n_y)$ 点的[张量积法则](@entry_id:177156)能够保证精确积分所有总次数不高于 $t_{\max}$ 的多项式，其中 [@problem_id:3567619]：
$$
t_{\max} = \min(2n_x-1, 2n_y-1) = 2\min(n_x, n_y) - 1
$$
这个结论凸显了[多维积分](@entry_id:184252)的一个关键点：整个积分的精度受限于点数最少的那个方向。例如，一个 $3 \times 2$ 点的积分法则，其总次数的保证精度阶为 $2\min(3,2)-1 = 3$。

### 在有限元法中的应用：被积函数复杂性

高斯积分的强大威力在于其对多项式的精确性。然而，在实际的[有限元分析](@entry_id:138109)中，尤其是在使用[等参单元](@entry_id:173863)时，被积函数往往并非多项式，这给精确积分带来了挑战。

#### 质量矩阵与[刚度矩阵](@entry_id:178659)的积分

我们来比较一下[质量矩阵](@entry_id:177093)和刚度矩阵的积分。假设单元密度 $\rho$ 为常数，一个单元的**[一致质量矩阵](@entry_id:174630)** (consistent mass matrix) 的项具有如下形式的被积函数：
$$
\text{Integrand}_{\text{mass}} = \rho N_i(\xi, \eta) N_j(\xi, \eta) J(\xi, \eta)
$$
其中 $N_i$ 是形函数，$J(\xi, \eta) = \det(\mathbf{J})$ 是[雅可比行列式](@entry_id:137120)。对于一个用多项式形函数定义的等参元（例如，二次[四边形单元](@entry_id:176937)），其[几何映射](@entry_id:749852)是多项式。这意味着[雅可比矩阵](@entry_id:264467) $\mathbf{J}$ 的各项是多项式，其[行列式](@entry_id:142978) $J(\xi, \eta)$ 也是一个多项式。因此，[质量矩阵](@entry_id:177093)的被积函数（形函数乘积乘以[雅可比行列式](@entry_id:137120)）整个都是一个多项式。在这种情况下，我们可以通过选择足够多的[高斯点](@entry_id:170251)来**精确地**积分质量矩阵。

例如，对于一个由双二次[几何映射](@entry_id:749852)定义的二次[四边形单元](@entry_id:176937)，其形函数 $N_i$ 关于 $\xi$ 或 $\eta$ 的最高次数为 $2$。雅可比行列式 $J(\xi, \eta)$ 经计算可能是一个关于 $\xi$ 次数为 $2$、关于 $\eta$ 次数为 $1$ 的多项式。那么，被积函数 $N_i N_j J$ 关于 $\xi$ 的最高次数将是 $2+2+2=6$，关于 $\eta$ 的最高次数是 $2+2+1=5$。为了精确积分，我们需要一个 $n \times n$ 的[张量积法则](@entry_id:177156)，其中 $2n-1 \ge 6 \implies n \ge 3.5$ 且 $2n-1 \ge 5 \implies n \ge 3$。因此，必须选择 $n=\max(4,3)=4$，即一个 $4 \times 4$ 的积分法则来保证精确积分 [@problem_id:3567564]。

相比之下，**刚度矩阵** (stiffness matrix) 的情况要复杂得多。其被积函数的形式为：
$$
\text{Integrand}_{\text{stiffness}} = (\mathbf{B}_i)^T \mathbf{D} \mathbf{B}_j J(\xi, \eta)
$$
其中 $\mathbf{D}$ 是材料[本构矩阵](@entry_id:164908)，$\mathbf{B}_i$ 是[应变-位移矩阵](@entry_id:163451)，包含形函数对**物理坐标** $(x,y)$ 的导数，如 $\partial N_i / \partial x$。这些导数通过链式法则计算，涉及到雅可比矩阵的**逆** $\mathbf{J}^{-1}$：
$$
\begin{Bmatrix} \partial N_i / \partial x \\ \partial N_i / \partial y \end{Bmatrix} = \mathbf{J}^{-1} \begin{Bmatrix} \partial N_i / \partial \xi \\ \partial N_i / \partial \eta \end{Bmatrix}
$$
由于 $\mathbf{J}^{-1} = \frac{1}{\det(\mathbf{J})} \text{adj}(\mathbf{J})$，其中 $\text{adj}(\mathbf{J})$ 是 $\mathbf{J}$ 的[伴随矩阵](@entry_id:148203)，$\mathbf{J}^{-1}$ 的项通常是 $\xi$ 和 $\eta$ 的**[有理函数](@entry_id:154279)**（多项式除以多项式），而非多项式。因此，$\mathbf{B}_i$ 矩阵的项也是[有理函数](@entry_id:154279)。最终，[刚度矩阵](@entry_id:178659)的被积函数也变成了一个有理函数。

#### 弯曲几何的挑战

对于非仿射（即弯曲的）等参元，当计算依赖于几何的非多项式量（例如曲线的[弧长](@entry_id:191173)或[曲面](@entry_id:267450)的面积）时，被积函数会变得复杂。例如，考虑一个由二次[拉格朗日形函数](@entry_id:635448)定义的弯曲杆单元，其[几何映射](@entry_id:749852)为 $x(\xi)=\xi, y(\xi)=\xi^2$。其弧长雅可比为 [@problem_id:3567565]：
$$
J(\xi) = \sqrt{\left(\frac{dx}{d\xi}\right)^2 + \left(\frac{dy}{d\xi}\right)^2} = \sqrt{1^2 + (2\xi)^2} = \sqrt{1+4\xi^2}
$$
这个雅可比本身就是一个非多项式函数。因此，即使是像 $\int (dN_i/d\xi)^2 / J(\xi) \,d\xi$ 这样的刚度项，其被积函数也是一个复杂的非多项式函数。由于高斯积分仅对多项式是精确的，对于这类由弯曲几何产生的非多项式被积函数，**任何有限数量的[高斯点](@entry_id:170251)都无法实现精确积分**。我们只能通过增加积分点数 $n$ 来提高近似精度。这揭示了有限元实践中的一个核心权衡：在模拟复杂几何时，我们必须接受数值积分本身就是一种近似。

### 高级积分策略与[数值病态](@entry_id:169044)问题

在有限元分析中，选择积分点的数量不仅仅是为了精度，它还深刻影响着单元的性能、计算成本和数值稳定性。有时，故意使用比“完全积分”所需更少的点（即**[减缩积分](@entry_id:167949)**）反而能带来好处，但这需要非常小心。

#### [减缩积分](@entry_id:167949)与[沙漏模式](@entry_id:174855)

考虑一个四节点双线性[四边形单元](@entry_id:176937) (Q1)，其[刚度矩阵](@entry_id:178659)的被积函数最高是二次的（对于矩形单元），因此一个 $2 \times 2$ 的[高斯积分法](@entry_id:178260)则（4个点）被认为是“完全积分”。如果我们为了节省计算成本而只使用一个[中心点](@entry_id:636820)（$1 \times 1$ 法则）进行积分，即[减缩积分](@entry_id:167949)，会发生什么？

这样做确实能减少计算量，但会引入一种称为**[沙漏模式](@entry_id:174855)** (hourglass modes) 的灾难性数值失稳现象 [@problem_id:3567538]。在单[点积](@entry_id:149019)分下，单元的应变只在中心点 $(\xi, \eta)=(0,0)$ 处被计算。我们可以找到一些非刚体的节点位移模式，它们在单元中心点产生的应变为零。由于应变为零，这些模式对应的应变能也为零。这些零能量、非刚体的变形模式就像沙漏一样，可以在不产生任何抵抗力的情况下发生，从而污染整个解。

对于 Q1 单元，存在两种独立的[沙漏模式](@entry_id:174855)。它们对应的节点位移模式分别为 $\boldsymbol{d}_x \propto [1, -1, 1, -1]^T$ 作用于 $x$ 方向位移，以及 $\boldsymbol{d}_y \propto [1, -1, 1, -1]^T$ 作用于 $y$ 方向位移。这两种模式在数学上对应于[刚度矩阵](@entry_id:178659)的[秩亏](@entry_id:754065)。一个 2D Q1 单元有 8 个自由度。除了 3 个[刚体运动](@entry_id:193355)模态外，单[点积](@entry_id:149019)分的[刚度矩阵](@entry_id:178659)还额外产生了 2 个零能量的沙漏模态，使其秩从理想的 5 降至 3。因此，除非采用特殊的[沙漏控制](@entry_id:163812)技术，否则对低阶单元进行统一的[减缩积分](@entry_id:167949)是极其危险的。

#### [选择性减缩积分](@entry_id:168281)与[体积锁定](@entry_id:172606)

然而，在某些特定情况下，[减缩积分](@entry_id:167949)是一种有效的补救措施，最著名的例子是处理**[体积锁定](@entry_id:172606)** (volumetric locking) [@problem_id:3567585]。

在模拟[近不可压缩材料](@entry_id:752388)（泊松比 $\nu \to 0.5$）时，标准位移[有限元法](@entry_id:749389)中的低阶单元（如 Q1 单元）会表现出一种称为[体积锁定](@entry_id:172606)的病态行为。其根源在于，[近不可压缩性](@entry_id:752381)要求体积应变 $\text{tr}(\boldsymbol{\varepsilon})$ 几乎为零。在使用完全积分（如 $2 \times 2$）时，这个约束被强制施加在每一个[高斯点](@entry_id:170251)上。对于 Q1 单元，这意味着在 4 个点上施加了 4 个独立的体积约束。然而，单元的[运动学](@entry_id:173318)自由度不足以同时满足所有这些约束而不产生虚假的、巨大的抵抗力。结果是单元变得异常“僵硬”，无法正确变形。

**[选择性减缩积分](@entry_id:168281) (Selective Reduced Integration, SRI)** 是一种优雅的解决方案。其思想是将[单元刚度矩阵](@entry_id:139369)在计算时分解为**偏部分** (deviatoric part) 和**体部分** (volumetric part)：$\boldsymbol{K}_e = \boldsymbol{K}_{e, \text{dev}} + \boldsymbol{K}_{e, \text{vol}}$。然后：
-   对表现良好的**偏部分**使用**完全积分**（例如，对 Q1 单元使用 $2 \times 2$ 法则），以确保单元的剪切行为被准确捕捉，并避免[沙漏模式](@entry_id:174855)。
-   对引起问题的**体部分**使用**[减缩积分](@entry_id:167949)**（例如，对 Q1 单元使用 $1 \times 1$ 法则），从而只在单元中心施加一个体积约束。

这种方法显著减少了约束数量，有效“解锁”了单元，使其能够正确地模拟[近不可压缩](@entry_id:752387)行为，同时保持了数值稳定性。这种策略在 2D [双线性](@entry_id:146819)四边形和 3D 三线性[六面体单元](@entry_id:174602)中都非常有效 [@problem_id:3567585]。从概念上讲，对体积项使用单[点积](@entry_id:149019)分，等效于用一个单元内的常数（即其平均值）来代替变化的体积应变场，这与更高级的 B-bar 等混合公式有着深刻的联系 [@problem_id:3567585]。

### 关于单纯形单元积分的说明

值得注意的是，我们目前讨论的张量积积分法主要适用于矩形和立方体（或其[等参映射](@entry_id:173239)）这类“积”型区域。对于另一种重要的单元类型——三角形和四面体等**单纯形** (simplicial) 单元，情况则有所不同 [@problem_id:3567629]。

单纯形单元没有张量积结构，因此不能直接应用一维高斯法则的乘积。它们的积分法则需要专门构建。在[三角形单元](@entry_id:167871)中，方便的[坐标系](@entry_id:156346)是**[面积坐标](@entry_id:174984)**或**[重心坐标](@entry_id:155488)** $(\lambda_1, \lambda_2, \lambda_3)$，它们是单元内一点位置的自然描述。一个点 $(x,y)$ 的[重心坐标](@entry_id:155488)满足 $\lambda_1+\lambda_2+\lambda_3=1$，且 $\lambda_i \ge 0$。

为三角形构造的积分法则通常追求以下理想属性：
1.  **对称性**：积分点和权重的集合在三角形的三个顶点的任意[置换](@entry_id:136432)下保持不变。这消除了人为的方向偏差，确保单元的行为不依赖于节点的编号顺序。
2.  **正权重**：所有权重都为正，这对于保证[质量矩阵](@entry_id:177093)的[正定性](@entry_id:149643)和数值计算的稳定性至关重要。
3.  **高精度阶**：用尽可能少的点达到尽可能高的多项式精确度。

存在许多专门为三角形和四面体设计的、满足这些性质的积分法则。它们的选择是有限元实现中一个独立而重要的课题，突显了[数值积分](@entry_id:136578)的多样性和针对不同几何形状的特异性。