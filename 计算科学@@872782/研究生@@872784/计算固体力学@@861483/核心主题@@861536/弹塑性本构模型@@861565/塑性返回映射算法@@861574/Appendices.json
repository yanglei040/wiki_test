{"hands_on_practices": [{"introduction": "我们从一个经典案例开始，该案例是理解返回映射算法的基石。通过在简单的剪切载荷下推导$J_2$塑性模型的解析解，您可以亲手实践弹塑性问题中的弹性预测-塑性修正核心思想。这项练习将帮助您在无需处理复杂数值方法的情况下，深刻理解应力如何通过径向返回路径回到屈服面上，为后续更复杂的实践奠定坚实的理论基础。[@problem_id:3596324]", "problem": "考虑一个均匀的、小应变的各向同性弹塑性固体，其遵循带有相关联流动和线性各向同性硬化的偏应力第二不变量（J$_2$）屈服准则，并承受简单剪切。弹性响应是线性的，剪切模量为 $G$；硬化由恒定的切线模量 $H$ 表征。初始屈服应力为 $\\sigma_{y0}$，在时间 $t_n$ 的初始状态为无应力且未发生塑性变形。在时长为 $\\Delta t$ 的单个大时间步内，在 $1$-$2$ 平面内施加一个均匀的工程剪切应变增量 $\\Delta \\gamma \\ge 0$（简单剪切），且法向应变为零。\n\n仅从以下基本原理出发：\n- 小应变运动学，包括工程剪切应变和张量剪切应变之间的关系。\n- 剪切模量为 $G$ 的线性各向同性弹性理论。\n- $J_2$ 屈服函数的定义 $f = q - \\sigma_{y}$，其中 $q$ 是 von Mises 等效应力，$\\sigma_{y} = \\sigma_{y0} + H \\,\\varepsilon_{p}^{\\mathrm{eq}}$ 是当前屈服应力，$\\varepsilon_{p}^{\\mathrm{eq}}$ 是等效塑性应变。\n- 与屈服面正交的相关联流动法则，以及在该时间步上进行的后向欧拉（隐式）积分。\n- 定义 $q = \\sqrt{\\frac{3}{2}\\, \\boldsymbol{s}:\\boldsymbol{s}}$ 以及满足 $d\\varepsilon_{p}^{\\mathrm{eq}} = \\sqrt{\\frac{2}{3}}\\, \\| d\\boldsymbol{\\varepsilon}_{p}^{\\mathrm{dev}} \\|$ 的 $\\varepsilon_{p}^{\\mathrm{eq}}$。\n\n推导该步结束后剪切应力分量 $\\sigma_{12,n+1}$ 的闭式更新表达式，该表达式用 $G$、$H$、$\\sigma_{y0}$ 和 $\\Delta \\gamma$ 表示。然后，通过将后向欧拉返回映射方程直接作为在大时间步 $\\Delta t$ 上的数值积分进行求解（即，在一步内完成隐式更新，无需子步），验证可以得到相同的表达式。\n\n你的最终答案必须是关于 $\\sigma_{12,n+1}$ 的单个闭式解析表达式，用 $G$、$H$、$\\sigma_{y0}$ 和 $\\Delta \\gamma$ 表示。最终方框内的答案不应包含单位。如果你的表达式是分段的，你可以使用最小值算子将其写成单个表达式。", "solution": "该问题陈述被评估为有效。它提出了一个计算固体力学中适定的、有科学依据的问题，特别是关于 J$_2$ 塑性理论中返回映射算法的应用。给定条件是完备、一致且客观陈述的。\n\n任务是从一个无应力且未发生塑性变形的初始状态出发，推导经过单步简单剪切后剪切应力分量 $\\sigma_{12,n+1}$ 的闭式表达式。我们将采用标准的弹性预测/塑性修正算法，该算法代表了对时间步 $\\Delta t$ 内本构方程进行后向欧拉积分的直接解。\n\n首先，我们定义运动学。在 $1$-$2$ 平面内，法向应变为零的简单工程剪切应变增量 $\\Delta \\gamma$ 对应于总应变增量张量 $\\Delta\\boldsymbol{\\varepsilon}$，表示为：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  \\frac{1}{2}\\Delta\\gamma  0 \\\\ \\frac{1}{2}\\Delta\\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n$\\Delta\\boldsymbol{\\varepsilon}$ 的迹为零，因此变形是体积不变的。应变增量是纯偏量的，即 $\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$。\n\n求解过程遵循返回映射算法：\n\n1.  **弹性预测：** 我们首先假设整个应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 都是弹性的。计算在时间 $t_{n+1}$ 的试探应力状态。由于初始状态是无应力的（$\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$），我们有：\n    $$\n    \\boldsymbol{\\sigma}_{n+1}^{\\mathrm{trial}} = \\boldsymbol{C} : \\Delta\\boldsymbol{\\varepsilon}\n    $$\n    对于线性各向同性弹性体和偏应变增量，应力增量由 $\\Delta\\boldsymbol{\\sigma} = 2G \\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ 给出。因此，试探应力的唯一非零分量是：\n    $$\n    \\sigma_{12,n+1}^{\\mathrm{trial}} = 2G \\Delta\\varepsilon_{12} = 2G \\left(\\frac{1}{2}\\Delta\\gamma\\right) = G\\Delta\\gamma\n    $$\n    试探应力张量是纯偏量，因此 $\\boldsymbol{s}_{n+1}^{\\mathrm{trial}} = \\boldsymbol{\\sigma}_{n+1}^{\\mathrm{trial}}$。\n\n2.  **屈服检查：** 我们检查这个试探应力状态是否违反屈服条件。屈服函数为 $f = q - \\sigma_y$。在该步开始时，材料未发生塑性变形，因此屈服应力为初始屈服应力 $\\sigma_y = \\sigma_{y0}$。我们计算试探状态的 von Mises 等效应力 $q_{n+1}^{\\mathrm{trial}}$：\n    $$\n    q_{n+1}^{\\mathrm{trial}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}_{n+1}^{\\mathrm{trial}} : \\boldsymbol{s}_{n+1}^{\\mathrm{trial}}} = \\sqrt{\\frac{3}{2} \\left( (\\sigma_{12,n+1}^{\\mathrm{trial}})^2 + (\\sigma_{21,n+1}^{\\mathrm{trial}})^2 \\right)} = \\sqrt{\\frac{3}{2} \\left( (G\\Delta\\gamma)^2 + (G\\Delta\\gamma)^2 \\right)}\n    $$\n    $$\n    q_{n+1}^{\\mathrm{trial}} = \\sqrt{\\frac{3}{2} (2 G^2 \\Delta\\gamma^2)} = \\sqrt{3} G |\\Delta\\gamma|\n    $$\n    由于问题指定 $\\Delta\\gamma \\ge 0$，我们有 $q_{n+1}^{\\mathrm{trial}} = \\sqrt{3} G \\Delta\\gamma$。\n    试探屈服函数值为 $f^{\\mathrm{trial}} = q_{n+1}^{\\mathrm{trial}} - \\sigma_{y0}$。\n\n    - 如果 $f^{\\mathrm{trial}} \\le 0$，即 $\\sqrt{3} G \\Delta\\gamma \\le \\sigma_{y0}$，则试探状态是容许的。该步是纯弹性的。最终应力即为试探应力：\n      $$\n      \\sigma_{12,n+1} = \\sigma_{12,n+1}^{\\mathrm{trial}} = G\\Delta\\gamma \\quad \\text{if } \\Delta\\gamma \\le \\frac{\\sigma_{y0}}{G\\sqrt{3}}\n      $$\n\n    - 如果 $f^{\\mathrm{trial}} > 0$，即 $\\sqrt{3} G \\Delta\\gamma > \\sigma_{y0}$，则试探状态位于屈服面之外。发生塑性流动，需要进行塑性修正。\n\n3.  **塑性修正（返回映射）：** 对于塑性步，最终状态 $(\\boldsymbol{\\sigma}_{n+1}, \\varepsilon_{p,n+1}^{\\mathrm{eq}})$ 必须满足积分后的本构关系和屈服条件。后向欧拉格式意味着：\n    - 加法分解：$\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}_e + \\Delta\\boldsymbol{\\varepsilon}_p$。\n    - 弹性定律：$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}_e$。\n    - 流动法则（相关联）：$\\Delta\\boldsymbol{\\varepsilon}_p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}} = \\Delta\\lambda \\frac{3}{2q_{n+1}} \\boldsymbol{s}_{n+1}$，其中 $\\Delta\\lambda$ 是一致性参数。\n    - 硬化定律：$\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\varepsilon_{p,n}^{\\mathrm{eq}} + \\Delta\\varepsilon_{p}^{\\mathrm{eq}}$。已知 $\\varepsilon_{p,n}^{\\mathrm{eq}}=0$，我们有 $\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\Delta\\varepsilon_{p}^{\\mathrm{eq}}$。率形式 $d\\varepsilon_{p}^{\\mathrm{eq}} = \\sqrt{\\frac{2}{3} d\\boldsymbol{\\varepsilon}_p:d\\boldsymbol{\\varepsilon}_p}$ 在该步上积分得到 $\\Delta\\varepsilon_{p}^{\\mathrm{eq}} = \\Delta\\lambda$。\n    - 一致性条件：$f_{n+1} = q_{n+1} - (\\sigma_{y0} + H \\varepsilon_{p,n+1}^{\\mathrm{eq}}) = 0 \\implies q_{n+1} = \\sigma_{y0} + H \\Delta\\lambda$。\n\n    结合这些方程，我们推导出返回映射。最终应力与试探应力相关：\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\mathrm{trial}} - \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}_p\n    $$\n    对于偏量分量：\n    $$\n    \\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{n+1}^{\\mathrm{trial}} - 2G \\Delta\\boldsymbol{\\varepsilon}_p = \\boldsymbol{s}_{n+1}^{\\mathrm{trial}} - 2G \\left(\\Delta\\lambda \\frac{3}{2q_{n+1}} \\boldsymbol{s}_{n+1}\\right) = \\boldsymbol{s}_{n+1}^{\\mathrm{trial}} - \\frac{3G\\Delta\\lambda}{q_{n+1}} \\boldsymbol{s}_{n+1}\n    $$\n    重新整理得到 $\\boldsymbol{s}_{n+1} \\left(1 + \\frac{3G\\Delta\\lambda}{q_{n+1}}\\right) = \\boldsymbol{s}_{n+1}^{\\mathrm{trial}}$。这表明 $\\boldsymbol{s}_{n+1}$ 与 $\\boldsymbol{s}_{n+1}^{\\mathrm{trial}}$ 共轴，这就是径向返回原理。我们可以写成 $\\boldsymbol{s}_{n+1} = k \\, \\boldsymbol{s}_{n+1}^{\\mathrm{trial}}$，其中 $k$ 是某个标量，这意味着 $q_{n+1} = k \\, q_{n+1}^{\\mathrm{trial}}$。\n    通过对重新整理后的方程取范数，可以找到偏应力的大小：\n    $$\n    q_{n+1} = q_{n+1}^{\\mathrm{trial}} - 3G\\Delta\\lambda\n    $$\n    现在我们得到了一个关于 $\\Delta\\lambda$ 和 $q_{n+1}$ 的代数方程组：\n    1.  $q_{n+1} = q_{n+1}^{\\mathrm{trial}} - 3G\\Delta\\lambda$\n    2.  $q_{n+1} = \\sigma_{y0} + H\\Delta\\lambda$\n    令 $q_{n+1}$ 的两个表达式相等：\n    $$\n    q_{n+1}^{\\mathrm{trial}} - 3G\\Delta\\lambda = \\sigma_{y0} + H\\Delta\\lambda \\implies q_{n+1}^{\\mathrm{trial}} - \\sigma_{y0} = (3G+H)\\Delta\\lambda\n    $$\n    求解塑性乘子 $\\Delta\\lambda$：\n    $$\n    \\Delta\\lambda = \\frac{q_{n+1}^{\\mathrm{trial}} - \\sigma_{y0}}{3G+H}\n    $$\n    由于我们处于塑性情况，$q_{n+1}^{\\mathrm{trial}} > \\sigma_{y0}$，因此 $\\Delta\\lambda > 0$。\n    现在我们求最终应力。最终偏应力是试探偏应力的径向缩放：\n    $$\n    \\boldsymbol{s}_{n+1} = \\frac{q_{n+1}}{q_{n+1}^{\\mathrm{trial}}} \\boldsymbol{s}_{n+1}^{\\mathrm{trial}}\n    $$\n    将 $\\Delta\\lambda$ 代入一致性条件以求得 $q_{n+1}$：\n    $$\n    q_{n+1} = \\sigma_{y0} + H \\left(\\frac{q_{n+1}^{\\mathrm{trial}} - \\sigma_{y0}}{3G+H}\\right) = \\frac{\\sigma_{y0}(3G+H) + H(q_{n+1}^{\\mathrm{trial}} - \\sigma_{y0})}{3G+H} = \\frac{3G\\sigma_{y0} + H q_{n+1}^{\\mathrm{trial}}}{3G+H}\n    $$\n    因此，最终偏应力张量为：\n    $$\n    \\boldsymbol{s}_{n+1} = \\left(\\frac{3G\\sigma_{y0} + H q_{n+1}^{\\mathrm{trial}}}{(3G+H)q_{n+1}^{\\mathrm{trial}}}\\right) \\boldsymbol{s}_{n+1}^{\\mathrm{trial}}\n    $$\n    我们需要分量 $\\sigma_{12,n+1}$。由于变形是体积不变的，$\\sigma_{12,n+1} = s_{12,n+1}$。\n    $$\n    \\sigma_{12,n+1} = \\left(\\frac{3G\\sigma_{y0} + H q_{n+1}^{\\mathrm{trial}}}{(3G+H)q_{n+1}^{\\mathrm{trial}}}\\right) \\sigma_{12,n+1}^{\\mathrm{trial}}\n    $$\n    代入 $\\sigma_{12,n+1}^{\\mathrm{trial}} = G\\Delta\\gamma$ 和 $q_{n+1}^{\\mathrm{trial}} = \\sqrt{3}G\\Delta\\gamma$：\n    $$\n    \\sigma_{12,n+1} = \\left(\\frac{3G\\sigma_{y0} + H (\\sqrt{3}G\\Delta\\gamma)}{(3G+H)(\\sqrt{3}G\\Delta\\gamma)}\\right) (G\\Delta\\gamma) = \\frac{3G\\sigma_{y0} + \\sqrt{3}GH\\Delta\\gamma}{\\sqrt{3}(3G+H)}\n    $$\n    $$\n    \\sigma_{12,n+1} = \\frac{\\sqrt{3}G\\sigma_{y0}}{3G+H} + \\frac{GH\\Delta\\gamma}{3G+H} \\quad \\text{if } \\Delta\\gamma > \\frac{\\sigma_{y0}}{G\\sqrt{3}}\n    $$\n\n4.  **组合表达式：** 我们可以将弹性和弹塑性解组合成一个单一表达式。令弹性解为 $f(\\Delta\\gamma) = G\\Delta\\gamma$，塑性解为 $g(\\Delta\\gamma) = \\frac{GH\\Delta\\gamma + \\sqrt{3}G\\sigma_{y0}}{3G+H}$。\n    我们分析差值 $f(\\Delta\\gamma) - g(\\Delta\\gamma)$：\n    $$\n    G\\Delta\\gamma - \\frac{GH\\Delta\\gamma + \\sqrt{3}G\\sigma_{y0}}{3G+H} = \\frac{G\\Delta\\gamma(3G+H) - (GH\\Delta\\gamma + \\sqrt{3}G\\sigma_{y0})}{3G+H} = \\frac{3G^2\\Delta\\gamma - \\sqrt{3}G\\sigma_{y0}}{3G+H} = \\frac{\\sqrt{3}G}{3G+H}(\\sqrt{3}G\\Delta\\gamma - \\sigma_{y0})\n    $$\n    - 如果 $\\Delta\\gamma \\le \\frac{\\sigma_{y0}}{G\\sqrt{3}}$，则 $f(\\Delta\\gamma) \\le g(\\Delta\\gamma)$，正确的解是弹性解 $f(\\Delta\\gamma)$。\n    - 如果 $\\Delta\\gamma > \\frac{\\sigma_{y0}}{G\\sqrt{3}}$，则 $f(\\Delta\\gamma) > g(\\Delta\\gamma)$，正确的解是塑性解 $g(\\Delta\\gamma)$。\n    这个逻辑精确地对应于最小值算子。最终应力是这两个值中较小的一个：\n    $$\n    \\sigma_{12,n+1} = \\min\\left( G\\Delta\\gamma, \\frac{GH\\Delta\\gamma + \\sqrt{3}G\\sigma_{y0}}{3G+H} \\right)\n    $$\n    这个单一表达式概括了该一维问题的弹性预测和塑性修正（径向返回），正确地实现了从弹性区域到塑性区域的过渡。为了简洁，这个表达式可以稍微重新整理：\n    $$\n    \\sigma_{12,n+1} = \\min\\left( G\\Delta\\gamma, \\frac{G(H\\Delta\\gamma + \\sqrt{3}\\sigma_{y0})}{3G+H} \\right)\n    $$\n\n这个推导证实了，对单个大时间步直接求解后向欧拉返回映射方程，可以得到所提供的闭式解。", "answer": "$$\n\\boxed{\\min\\left( G\\Delta\\gamma, \\frac{G(H\\Delta\\gamma + \\sqrt{3}\\sigma_{y0})}{3G+H} \\right)}\n$$", "id": "3596324"}, {"introduction": "在掌握了基本原理后，我们进入一个更贴近实际工程应用的场景。真实的材料行为通常由非线性的硬化规律描述，这使得解析求解变得不可能。本练习将指导您为带有指数硬化规律的J$_2$塑性模型，构建一个可靠的数值求解器，通过带有线搜索和安全保护机制的牛顿迭代法求解非线性的一致性方程，这对于开发稳健的本构模型至关重要。[@problem_id:3596258]", "problem": "考虑一种小应变、线性各向同性弹塑性材料，其遵循关联流动法则，并使用基于偏应力第二不变量（$J_2$）的屈服函数。使用以下来自计算固体力学的基础且经过充分检验的基本定义和事实：\n\n- Cauchy应力张量分解为体积部分和偏量部分，即 $\\boldsymbol{\\sigma} = \\kappa \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{e}^{\\mathrm{dev}}$，其中 $\\kappa$ 是体积模量，$\\mu$ 是剪切模量，$\\boldsymbol{\\varepsilon}$ 是应变张量，$\\boldsymbol{e}^{\\mathrm{dev}}$ 是偏弹性应变张量。偏应力张量为 $\\boldsymbol{s} = 2 \\mu \\, \\boldsymbol{e}^{\\mathrm{dev}}$。\n- 关联塑性流动法则是 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\, \\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，其中 $f$ 是屈服函数，$\\mathrm{d}\\lambda \\ge 0$ 是塑性乘子增量。\n- 对于$J_2$塑性，一种常见的以偏应力大小表示的屈服函数形式是 $f(\\boldsymbol{\\sigma}, \\alpha) = \\|\\boldsymbol{s}\\| - \\sqrt{\\dfrac{2}{3}} \\, \\sigma_{\\mathrm{y}}(\\alpha)$，其中 $\\alpha$ 是等效塑性应变，$\\sigma_{\\mathrm{y}}(\\alpha)$ 是当前屈服应力。\n- 等效塑性应变增量为 $\\mathrm{d}\\bar{\\varepsilon}^{\\mathrm{p}} = \\sqrt{\\dfrac{2}{3}} \\, \\|\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}}\\|$，这意味着 $\\mathrm{d}\\alpha = \\mathrm{d}\\bar{\\varepsilon}^{\\mathrm{p}}$。\n- 在标准的返回映射算法（对于$J_2$是径向返回）下，更新后的偏应力与试探偏应力保持共线，其大小因塑性流动而减小。\n- 本问题中的所有量均为无量纲。无需物理单位。\n\n从这些基础出发，考虑一个由 $\\sigma_{\\mathrm{y}}(\\alpha) = \\sigma_{\\mathrm{y}0} + H \\left(1 - e^{-b \\alpha}\\right)$ 给出的指数型各向同性硬化定律，其中 $\\sigma_{\\mathrm{y}0} > 0$ 是初始屈服应力，$H \\ge 0$ 是硬化模量，$b > 0$ 控制饱和速率。设 $\\alpha_n$ 表示前一时间步的等效塑性应变，$\\|\\boldsymbol{s}_{\\mathrm{tr}}\\|$ 表示假设纯弹性响应时当前步的试探偏应力大小。返回映射旨在寻找塑性乘子增量 $\\Delta\\lambda \\ge 0$，使得更新后的状态正好位于屈服面上。\n\n您的任务是：\n\n1. 从上述基本原理出发，不使用简化公式，推导出塑性乘子增量 $\\Delta\\lambda$ 的标量一致性方程，形式为 $g(\\Delta\\lambda) = 0$，其中 $g(\\Delta\\lambda)$ 由 $\\mu$、$\\|\\boldsymbol{s}_{\\mathrm{tr}}\\|$、$\\sigma_{\\mathrm{y}0}$、$H$、$b$ 和 $\\alpha_n$ 明确定义。\n\n2. 构建一个配备线搜索的安全保护牛顿迭代法，用于求解一维变量 $\\Delta\\lambda \\ge 0$ 的方程 $g(\\Delta\\lambda) = 0$。您的安全保护牛顿法必须：\n   - 从一个有效区间 $[\\lambda_{\\mathrm{L}}, \\lambda_{\\mathrm{U}}]$ 开始，其中 $\\lambda_{\\mathrm{L}} = 0$，并在发生塑性加载时更新 $\\lambda_{\\mathrm{U}}$ 以确保 $g(\\lambda_{\\mathrm{L}}) \\ge 0$ 和 $g(\\lambda_{\\mathrm{U}}) \\le 0$。\n   - 使用牛顿步长 $\\Delta\\lambda_{\\mathrm{trial}} = \\Delta\\lambda - \\dfrac{g(\\Delta\\lambda)}{g'(\\Delta\\lambda)}$ 作为候选步。\n   - 如果 $\\Delta\\lambda_{\\mathrm{trial}}$ 超出区间，则用二分步长 $\\dfrac{\\lambda_{\\mathrm{L}} + \\lambda_{\\mathrm{U}}}{2}$ 替换它。\n   - 对优值函数 $\\phi(\\Delta\\lambda) = \\dfrac{1}{2} \\, g(\\Delta\\lambda)^2$ 应用带有 Armijo（充分下降）条件的回溯线搜索，以接受或减小沿牛顿方向的步长。\n\n3. 陈述精确的数学条件，用数据以及 $g(\\Delta\\lambda)$ 和 $g'(\\Delta\\lambda)$ 的性质来表达，在这些条件下，所提出的带线搜索的安全保护牛顿法能保证全局收敛到唯一根。您的条件必须纯粹以数学术语陈述，引用导数的连续性、单调性和有界性等性质，并且必须足以保证根的唯一性和收敛性。\n\n4. 将您的算法实现为一个完整的、可运行的程序。该程序针对给定的测试套件，计算每种情况下的 $\\Delta\\lambda$ 并输出结果。\n\n使用以下测试套件，每种情况都是一个元组 $(\\mu,\\|\\boldsymbol{s}_{\\mathrm{tr}}\\|,\\sigma_{\\mathrm{y}0},H,b,\\alpha_n)$：\n- 情况1（一般塑性）：$(80000.0, 600.0, 250.0, 1000.0, 10.0, 0.05)$。\n- 情况2（弹性边界）：$(80000.0, 500.0, 250.0, 1000.0, 10.0, 0.05)$。\n- 情况3（理想塑性，无硬化）：$(80000.0, 600.0, 250.0, 0.0, 10.0, 0.05)$。\n- 情况4（快速饱和硬化）：$(30000.0, 1200.0, 200.0, 1500.0, 200.0, 0.0)$。\n\n对于每种情况，您的程序必须计算塑性乘子增量 $\\Delta\\lambda$（作为一个浮点数），并将结果汇总到单行输出中。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$）。不允许有其他输出。", "solution": "我们从一个小应变、线性各向同性弹性以及关联塑性流动法则开始。应力分解为 $\\boldsymbol{\\sigma} = \\kappa \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{e}^{\\mathrm{dev}}$，其中偏应力为 $\\boldsymbol{s} = 2 \\mu \\, \\boldsymbol{e}^{\\mathrm{dev}}$。用偏应力大小表示的$J_2$屈服函数为 $f(\\boldsymbol{\\sigma}, \\alpha) = \\|\\boldsymbol{s}\\| - \\sqrt{\\dfrac{2}{3}} \\, \\sigma_{\\mathrm{y}}(\\alpha)$，其中 $\\alpha$ 是等效塑性应变，$\\sigma_{\\mathrm{y}}(\\alpha)$ 是当前屈服应力。关联流动法则给出 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\, \\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。对于$J_2$屈服函数 $f(\\boldsymbol{\\sigma}, \\alpha) = \\|\\boldsymbol{s}\\| - \\sqrt{\\dfrac{2}{3}} \\, \\sigma_{\\mathrm{y}}(\\alpha)$，其对应力的梯度为 $\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\dfrac{\\partial f}{\\partial \\boldsymbol{s}} = \\dfrac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}$，这是一个与 $\\boldsymbol{s}$ 同向的单位偏量向量。\n\n在标准的径向返回映射假设下，更新后的偏应力 $\\boldsymbol{s}_{n+1}$ 与试探偏应力 $\\boldsymbol{s}_{\\mathrm{tr}}$ 共线，其大小通过弹性关系因偏塑性应变增量而减小：$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\mathrm{tr}} - 2 \\mu \\, \\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}}$，其中 $\\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\Delta\\lambda \\, \\dfrac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}$。由于 $\\dfrac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}$ 与 $\\boldsymbol{s}_{\\mathrm{tr}}$ 同向，其大小满足\n$$\n\\|\\boldsymbol{s}_{n+1}\\| = \\|\\boldsymbol{s}_{\\mathrm{tr}}\\| - 2 \\mu \\, \\Delta\\lambda.\n$$\n增量结束时的屈服函数一致性条件要求 $f(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1}) = 0$，即\n$$\n\\|\\boldsymbol{s}_{n+1}\\| - \\sqrt{\\dfrac{2}{3}} \\, \\sigma_{\\mathrm{y}}(\\alpha_{n+1}) = 0.\n$$\n等效塑性应变演化为 $\\mathrm{d}\\bar{\\varepsilon}^{\\mathrm{p}} = \\sqrt{\\dfrac{2}{3}} \\|\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}}\\|$，使用 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\dfrac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}$ 可得 $\\mathrm{d}\\bar{\\varepsilon}^{\\mathrm{p}} = \\sqrt{\\dfrac{2}{3}} \\, \\mathrm{d}\\lambda$。因此，等效塑性应变增量为 $\\Delta\\alpha = \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda$，更新后的 $\\alpha$ 为 $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda$。\n\n使用指数型各向同性硬化定律 $\\sigma_{\\mathrm{y}}(\\alpha) = \\sigma_{\\mathrm{y}0} + H \\left(1 - e^{-b \\alpha}\\right)$，一致性条件变为\n$$\n\\|\\boldsymbol{s}_{\\mathrm{tr}}\\| - 2 \\mu \\, \\Delta\\lambda - \\sqrt{\\dfrac{2}{3}} \\left[ \\sigma_{\\mathrm{y}0} + H \\left( 1 - e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)} \\right) \\right] = 0.\n$$\n定义标量函数\n$$\ng(\\Delta\\lambda) = \\|\\boldsymbol{s}_{\\mathrm{tr}}\\| - 2 \\mu \\, \\Delta\\lambda - \\sqrt{\\dfrac{2}{3}} \\left[ \\sigma_{\\mathrm{y}0} + H \\left( 1 - e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)} \\right) \\right].\n$$\n当且仅当 $g(0) > 0$ 时发生塑性加载，此时必须找到唯一的根 $\\Delta\\lambda > 0$。\n\n我们计算 $g(\\Delta\\lambda)$ 的导数：\n$$\ng'(\\Delta\\lambda) = - 2 \\mu - \\sqrt{\\dfrac{2}{3}} \\left[ H \\cdot \\dfrac{\\mathrm{d}}{\\mathrm{d}\\Delta\\lambda} \\left( 1 - e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)} \\right) \\right].\n$$\n由于 $\\dfrac{\\mathrm{d}}{\\mathrm{d}\\Delta\\lambda} \\left( 1 - e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)} \\right) = b \\sqrt{\\dfrac{2}{3}} \\, e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)}$，我们得到\n$$\ng'(\\Delta\\lambda) = - 2 \\mu - \\left( \\dfrac{2}{3} \\right) H b \\, e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)}.\n$$\n因此，只要 $\\mu > 0$、$H \\ge 0$ 和 $b > 0$，对于所有 $\\Delta\\lambda \\ge 0$ 都有 $g'(\\Delta\\lambda)  0$。事实上，\n$$\ng'(\\Delta\\lambda) \\le - 2 \\mu  0,\n$$\n所以 $g$ 是严格递减且连续可微的。此外，$\\lim_{\\Delta\\lambda \\to +\\infty} g(\\Delta\\lambda) = -\\infty$，因此最多只有一个根。如果 $g(0) > 0$，根据介值定理，存在唯一的根 $\\Delta\\lambda^\\star > 0$。\n\n现在我们设计一个带线搜索的安全保护牛顿法。设优值函数为\n$$\n\\phi(\\Delta\\lambda) = \\dfrac{1}{2} \\, g(\\Delta\\lambda)^2.\n$$\n我们使用牛顿步长\n$$\n\\Delta\\lambda_{\\mathrm{N}} = \\Delta\\lambda - \\dfrac{g(\\Delta\\lambda)}{g'(\\Delta\\lambda)}.\n$$\n为确保全局收敛，我们实施以下安全措施：\n\n- 初始化和区间限定：设置下界 $\\lambda_{\\mathrm{L}} = 0$。如果 $g(0) \\le 0$，则判断为弹性响应，并设 $\\Delta\\lambda = 0$。否则，选择一个初始上界 $\\lambda_{\\mathrm{U}}$（例如，对于一个小的 $\\varepsilon > 0$，取 $\\lambda_{\\mathrm{U}} = \\max\\left( \\dfrac{g(0)}{2 \\mu}, \\varepsilon \\right)$），并增加 $\\lambda_{\\mathrm{U}}$（例如，通过加倍）直到 $g(\\lambda_{\\mathrm{U}}) \\le 0$。这样，唯一的根就位于 $[\\lambda_{\\mathrm{L}}, \\lambda_{\\mathrm{U}}]$ 内。\n- 安全步：计算牛顿候选步 $\\Delta\\lambda_{\\mathrm{N}}$。如果 $\\Delta\\lambda_{\\mathrm{N}} \\notin [\\lambda_{\\mathrm{L}}, \\lambda_{\\mathrm{U}}]$，则用二分步长 $\\Delta\\lambda_{\\mathrm{B}} = \\dfrac{\\lambda_{\\mathrm{L}} + \\lambda_{\\mathrm{U}}}{2}$ 代替。否则，使用 $\\Delta\\lambda_{\\mathrm{N}}$ 作为线搜索的方向基础。\n- 带 Armijo 条件的线搜索：定义牛顿方向 $p = -\\dfrac{g(\\Delta\\lambda)}{g'(\\Delta\\lambda)}$。从步长 $\\alpha = 1$ 开始，进行回溯（例如，反复将 $\\alpha$ 减半），直到满足 Armijo 充分下降条件：\n$$\n\\phi(\\Delta\\lambda + \\alpha p) \\le \\phi(\\Delta\\lambda) + c \\, \\alpha \\, \\nabla \\phi(\\Delta\\lambda) \\, p,\n$$\n其中 $c \\in (0,1)$，且 $\\nabla \\phi(\\Delta\\lambda) = g(\\Delta\\lambda) g'(\\Delta\\lambda)$。因为 $p = -\\dfrac{g(\\Delta\\lambda)}{g'(\\Delta\\lambda)}$，右侧简化为\n$$\n\\phi(\\Delta\\lambda) - c \\, \\alpha \\, g(\\Delta\\lambda)^2.\n$$\n此外，要确保接受的步长 $\\Delta\\lambda_{\\mathrm{new}} = \\Delta\\lambda + \\alpha p$ 保持在 $[\\lambda_{\\mathrm{L}}, \\lambda_{\\mathrm{U}}]$ 内。如果牛顿候选步超出区间，则改用二分步，这会缩小区间大小。\n- 区间更新：如果 $g(\\Delta\\lambda_{\\mathrm{new}}) > 0$，则设置 $\\lambda_{\\mathrm{L}} \\leftarrow \\Delta\\lambda_{\\mathrm{new}}$；否则，设置 $\\lambda_{\\mathrm{U}} \\leftarrow \\Delta\\lambda_{\\mathrm{new}}$。然后设置 $\\Delta\\lambda \\leftarrow \\Delta\\lambda_{\\mathrm{new}}$。\n\n终止准则：当 $|g(\\Delta\\lambda)| \\le \\varepsilon_{\\mathrm{tol}}$（对于选定的容差 $\\varepsilon_{\\mathrm{tol}} > 0$）或区间宽度 $|\\lambda_{\\mathrm{U}} - \\lambda_{\\mathrm{L}}| \\le \\varepsilon_{\\mathrm{tol}}$ 时停止。\n\n全局收敛和唯一性条件：在以下条件下，所提出的方法全局收敛到唯一根：\n- 函数 $g(\\Delta\\lambda)$ 在 $[0, +\\infty)$ 上连续可微；这是成立的，因为 $g$ 是多项式和指数的组合。\n- 严格单调性且导数有界远离零：存在一个常数 $m > 0$，使得对于所有 $\\Delta\\lambda \\ge 0$，$g'(\\Delta\\lambda) \\le -m  0$。在我们的例子中，$m = 2 \\mu$，所以只要 $\\mu > 0$，对于所有 $\\Delta\\lambda \\ge 0$，$g'(\\Delta\\lambda) \\le -2 \\mu  0$。这保证了 $g$ 是强单调的，并且根是唯一的。\n- 区间限定条件：如果 $g(0) > 0$，则存在 $\\lambda_{\\mathrm{U}} > 0$ 使得 $g(\\lambda_{\\mathrm{U}}) \\le 0$；由于 $\\lim_{\\Delta\\lambda \\to +\\infty} g(\\Delta\\lambda) = -\\infty$，这样的 $\\lambda_{\\mathrm{U}}$ 总是存在的。建立一个包含根的区间 $[\\lambda_{\\mathrm{L}}, \\lambda_{\\mathrm{U}}]$ 可确保安全保护的牛顿步或二分法能使迭代值保持在区间内并取得进展。\n- 优值函数 $\\phi(\\Delta\\lambda) = \\dfrac{1}{2} g(\\Delta\\lambda)^2$ 沿线搜索方向是连续可微且强制的（只要 $g'(\\Delta\\lambda) \\neq 0$，牛顿方向就是 $\\phi$ 的下降方向）。Armijo 回溯保证了充分下降，从而保证了从区间内任何起点开始的收敛性。\n\n在这些条件和安全措施下，对于所有允许的材料参数（$\\mu > 0$，$H \\ge 0$，$b > 0$）以及任何满足 $g(0) > 0$（塑性加载）的试探状态，该算法都能全局收敛到唯一的根 $\\Delta\\lambda^\\star$。如果 $g(0) \\le 0$，则该步为弹性步，正确解为 $\\Delta\\lambda = 0$。\n\n测试套件的实现细节：对于每个测试用例 $(\\mu,\\|\\boldsymbol{s}_{\\mathrm{tr}}\\|,\\sigma_{\\mathrm{y}0},H,b,\\alpha_n)$，定义\n$$\ng(\\Delta\\lambda) = \\|\\boldsymbol{s}_{\\mathrm{tr}}\\| - 2 \\mu \\, \\Delta\\lambda - \\sqrt{\\dfrac{2}{3}} \\left[ \\sigma_{\\mathrm{y}0} + H \\left( 1 - e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)} \\right) \\right],\n$$\n和\n$$\ng'(\\Delta\\lambda) = - 2 \\mu - \\left( \\dfrac{2}{3} \\right) H b \\, e^{-b (\\alpha_n + \\sqrt{\\dfrac{2}{3}} \\, \\Delta\\lambda)}.\n$$\n应用所述的带 Armijo 回溯线搜索和二分法备用的安全保护牛顿迭代，然后将计算出的四个案例的 $\\Delta\\lambda$ 值汇总成指定的输出格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_delta_lambda(mu, s_tr_norm, sigma_y0, H, b, alpha_n,\n                         tol=1e-12, max_iter=200, armijo_c=1e-4, backtrack_factor=0.5):\n    \"\"\"\n    Safeguarded Newton iteration with line search to solve g(Δλ) = 0 for J2 plasticity\n    with exponential isotropic hardening. Returns Δλ >= 0.\n    \"\"\"\n    sqrt23 = np.sqrt(2.0 / 3.0)\n\n    def g(lam):\n        return (s_tr_norm\n                - 2.0 * mu * lam\n                - sqrt23 * (sigma_y0 + H * (1.0 - np.exp(-b * (alpha_n + sqrt23 * lam)))))\n\n    def gp(lam):\n        # g'(lam) = -2 mu - (2/3) H b exp(-b (alpha_n + sqrt(2/3) lam))\n        return -2.0 * mu - (2.0 / 3.0) * H * b * np.exp(-b * (alpha_n + sqrt23 * lam))\n\n    # Elastic check: if g(0) = 0, no plastic correction\n    g0 = g(0.0)\n    if g0 = 0.0:\n        return 0.0\n\n    # Bracketing: lower bound is 0, find upper bound with g(upper) = 0\n    # Start with a heuristic upper bound and expand until sign change.\n    # Heuristic: ignoring hardening saturation, lam_u0 ~ g0 / (2 mu)\n    lam_L = 0.0\n    lam_U = max(g0 / (2.0 * mu), 1e-16)\n    # Ensure lam_U within a reasonable range by expansion\n    # Since g(lam) -> -inf as lam -> +inf, this loop will terminate.\n    iter_expand = 0\n    while g(lam_U) > 0.0 and iter_expand  1000:\n        lam_U *= 2.0\n        iter_expand += 1\n    if g(lam_U) > 0.0:\n        # As a fallback, set a very large upper bound\n        lam_U = lam_U + 1.0\n        while g(lam_U) > 0.0:\n            lam_U *= 2.0\n\n    # Initialize current iterate within bracket\n    lam = lam_L\n\n    # Merit function\n    def phi(lam):\n        val = g(lam)\n        return 0.5 * val * val\n\n    # Main safeguarded Newton iteration with line search\n    for _ in range(max_iter):\n        val = g(lam)\n        if abs(val) = tol:\n            break\n        # Newton direction p = -g / g'\n        deriv = gp(lam)\n        # If derivative is too small (shouldn't happen with mu>0), fallback to bisection\n        if deriv == 0.0 or not np.isfinite(deriv):\n            lam_cand = 0.5 * (lam_L + lam_U)\n        else:\n            p = -val / deriv\n            lam_newton = lam + p\n            # If Newton candidate leaves the bracket, use bisection step\n            if lam_newton = lam_L or lam_newton >= lam_U or not np.isfinite(lam_newton):\n                lam_cand = 0.5 * (lam_L + lam_U)\n            else:\n                # Backtracking line search along Newton direction\n                alpha = 1.0\n                phi_curr = phi(lam)\n                # Armijo condition: phi(lam + alpha p) = phi(lam) - c * alpha * g(lam)^2\n                # Also enforce bracket membership\n                while True:\n                    lam_trial = lam + alpha * p\n                    # Project into bracket if numerical noise causes crossing\n                    if lam_trial = lam_L or lam_trial >= lam_U or (not np.isfinite(lam_trial)):\n                        # Reduce step if outside bracket\n                        alpha *= backtrack_factor\n                        if alpha  1e-16:\n                            lam_trial = 0.5 * (lam_L + lam_U)\n                            break\n                        continue\n                    phi_trial = phi(lam_trial)\n                    if phi_trial = phi_curr - armijo_c * alpha * (val * val):\n                        lam_cand = lam_trial\n                        break\n                    alpha *= backtrack_factor\n                    if alpha  1e-16:\n                        lam_cand = 0.5 * (lam_L + lam_U)\n                        break\n\n        # Update bracket\n        val_cand = g(lam_cand)\n        if val_cand > 0.0:\n            lam_L = lam_cand\n        else:\n            lam_U = lam_cand\n        lam = lam_cand\n\n        # Secondary termination: bracket width small\n        if (lam_U - lam_L) = tol:\n            break\n\n    return lam\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (mu, ||s_tr||, sigma_y0, H, b, alpha_n)\n    test_cases = [\n        (80000.0, 600.0, 250.0, 1000.0, 10.0, 0.05),  # Case 1: general plastic\n        (80000.0, 500.0, 250.0, 1000.0, 10.0, 0.05),  # Case 2: elastic boundary\n        (80000.0, 600.0, 250.0, 0.0,    10.0, 0.05),  # Case 3: perfect plasticity (H=0)\n        (30000.0, 1200.0, 200.0, 1500.0, 200.0, 0.0), # Case 4: rapid saturation hardening\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, s_tr_norm, sigma_y0, H, b, alpha_n = case\n        dlambda = compute_delta_lambda(mu, s_tr_norm, sigma_y0, H, b, alpha_n)\n        results.append(dlambda)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3596258"}, {"introduction": "最后，我们将挑战从简单的J$_2$模型扩展到更复杂的压力相关材料模型，例如用于岩土和混凝土的Drucker-Prager模型。这类模型的屈服面通常包含几何奇点（如锥顶），常规的返回路径在此处失效。本练习的核心是推导并实现处理锥顶返回的特殊逻辑，这要求您在算法中加入分支判断，以确保在所有应力状态下都能获得正确且稳健的解。[@problem_id:3596281]", "problem": "考虑一个满足线性各向同性弹性的小应变弹塑性固体，其体积模量为 $K$，剪切模量为 $G$，并遵循 Drucker–Prager 屈服函数 $f(\\boldsymbol{\\sigma}) = q + \\alpha p - k \\le 0$。其中，$p = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 是平均（静水）应力，受压为正；$q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$\\boldsymbol{s}$ 为偏应力；$\\alpha > 0$ 是一个与摩擦相关的材料参数；$k > 0$ 是一个恒定的类粘聚力参数（理想塑性）。塑性流动由一个非关联塑性势 $g(\\boldsymbol{\\sigma}) = q + \\beta p$ 定义，其中剪胀参数 $\\beta \\ge 0$。在应力空间上，使用一个标准的隐式最近点返回映射算法，在一个时间步内采用单个塑性乘子增量 $\\Delta\\lambda \\ge 0$。算法从一个已知的、具有不变量 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$ 的弹性试探预测状态 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 开始。假设在修正状态下，常规的 Kuhn–Tucker 条件和一致性条件均得到满足。\n\n请从第一性原理出发，推导修正后的应力必须返回到锥顶（静水压端点，此时 $q^{n+1} = 0$）而非锥面（此时 $q^{n+1} > 0$）的条件，并陈述相应的分支逻辑。您的结果应清楚地指明：\n- 以 $p^{\\mathrm{tr}}$、$q^{\\mathrm{tr}}$、$K$、$G$、$\\alpha$ 和 $\\beta$ 表示的、区分返回锥面与返回锥顶的显式不等式；\n- 在理想塑性情况下，每个分支中 $p^{n+1}$、$q^{n+1}$ 和 $\\Delta\\lambda$ 的表达式。\n\n下列哪个选项正确地陈述了该问题的锥顶返回条件和分支逻辑？\n\nA. 如果 $q^{\\mathrm{tr}} > \\dfrac{3G}{\\alpha K \\beta}\\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\beta}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\beta \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{p^{\\mathrm{tr}} - k/\\alpha}{K \\beta}$。\n\nB. 如果 $q^{\\mathrm{tr}} > \\dfrac{2G}{\\alpha K \\beta}\\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{2G + \\alpha K \\beta}$，$q^{n+1} = q^{\\mathrm{tr}} - 2G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\beta \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{k/\\alpha - p^{\\mathrm{tr}}}{K \\beta}$。\n\nC. 如果 $q^{\\mathrm{tr}} > \\dfrac{3G}{K}\\left(p^{\\mathrm{tr}} - \\dfrac{k}{\\alpha}\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + K}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{k/\\alpha - p^{\\mathrm{tr}}}{K}$。\n\nD. 如果 $q^{\\mathrm{tr}} > \\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}}$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{p^{\\mathrm{tr}} - k/\\alpha}{3G}$。", "solution": "用户需要对非关联 Drucker-Prager 塑性模型的返回映射算法进行详细推导和验证，包括锥顶返回的分支逻辑。\n\n**问题陈述验证**\n\n*   **第1步：提取已知条件**\n    -   **本构关系：** 小应变弹塑性。\n    -   **弹性：** 线性各向同性，体积模量为 $K$，剪切模量为 $G$。\n    -   **屈服函数：** $f(\\boldsymbol{\\sigma}) = q + \\alpha p - k \\le 0$，其中 $p = \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 是平均应力（压为正），$q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$\\alpha > 0$ 是摩擦参数， $k > 0$ 是粘聚力参数。\n    -   **塑性：** 理想塑性（硬化为零）。\n    -   **流动法则：** 非关联，由塑性势 $g(\\boldsymbol{\\sigma}) = q + \\beta p$ 决定，剪胀参数 $\\beta \\ge 0$。\n    -   **算法：** 从弹性试探状态 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$（不变量为 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$）开始的隐式最近点返回映射算法。使用单个塑性乘子增量 $\\Delta\\lambda \\ge 0$。\n    -   **条件：** Kuhn–Tucker 条件（$\\Delta\\lambda \\ge 0$，$f(\\boldsymbol{\\sigma}^{n+1}) \\le 0$，$\\Delta\\lambda f(\\boldsymbol{\\sigma}^{n+1}) = 0$）和修正状态 $\\boldsymbol{\\sigma}^{n+1}$ 下的一致性条件。\n\n*   **第2步：使用提取的已知条件进行验证**\n    该问题具有科学依据，是适定的、客观的。它描述了计算固体力学中的一个标准情景。Drucker-Prager 模型、非关联流动和返回映射算法是该领域的基本概念。处理锥形屈服面的顶点奇异性问题是实现这些模型的一个经典且重要的方面。所有参数和函数都有明确定义，其前提在塑性理论框架内是内部一致且事实可靠的。不存在信息缺失、矛盾或模糊之处。\n\n*   **第3步：结论与行动**\n    问题陈述是有效的。将推导解答。\n\n**从第一性原理推导**\n\n返回映射算法将位于屈服面之外（即 $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) > 0$）的弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 修正到屈服面上的最终应力 $\\boldsymbol{\\sigma}^{n+1}$。更新法则是：\n$$ \\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}^p $$\n其中 $\\mathbf{C}$ 是四阶各向同性弹性刚度张量，$\\Delta\\boldsymbol{\\varepsilon}^p$ 是塑性应变增量。对于线性各向同性弹性，$\\mathbf{C} = 2G \\mathbf{I}^{\\text{dev}} + K \\mathbf{1} \\otimes \\mathbf{1}$，其中 $\\mathbf{I}^{\\text{dev}}$ 是四阶偏量投影算子。\n\n塑性应变增量由非关联流动法则给出：\n$$ \\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{\\boldsymbol{\\sigma}^{n+1}} $$\n其中 $\\Delta\\lambda \\ge 0$ 是塑性乘子。\n\n首先，我们求塑性势 $g(\\boldsymbol{\\sigma}) = q + \\beta p$ 的梯度：\n$$ \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} $$\n应力不变量 $p$ 和 $q$ 的梯度为：\n$$ \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\mathbf{1} \\quad ; \\quad \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s} \\quad (\\text{对于 } q > 0) $$\n其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\mathbf{1}$ 是偏应力张量。\n因此，流动向量为：\n$$ \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q^{n+1}}\\boldsymbol{s}^{n+1} + \\frac{\\beta}{3}\\mathbf{1} $$\n该表达式对于返回到锥面（其中 $q^{n+1} > 0$）是有效的。\n\n将流动法则代入应力更新公式：\n$$ \\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\, \\mathbf{C} : \\left( \\frac{3}{2q^{n+1}}\\boldsymbol{s}^{n+1} + \\frac{\\beta}{3}\\mathbf{1} \\right) $$\n利用各向同性刚度张量的性质 $\\mathbf{C}:\\boldsymbol{s}^{n+1} = 2G\\boldsymbol{s}^{n+1}$ 和 $\\mathbf{C}:\\mathbf{1} = 3K\\mathbf{1}$，我们得到：\n$$ \\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\left( 2G \\frac{3}{2q^{n+1}}\\boldsymbol{s}^{n+1} + K \\frac{\\beta}{3} 3\\mathbf{1} \\right) = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda \\left( \\frac{3G}{q^{n+1}}\\boldsymbol{s}^{n+1} + K\\beta\\mathbf{1} \\right) $$\n通过令 $\\boldsymbol{\\sigma} = \\boldsymbol{s} + p\\mathbf{1}$，我们将此方程分解为偏量部分和体积部分：\n$$ \\boldsymbol{s}^{n+1} + p^{n+1}\\mathbf{1} = \\boldsymbol{s}^{\\mathrm{tr}} + p^{\\mathrm{tr}}\\mathbf{1} - \\frac{3G\\Delta\\lambda}{q^{n+1}}\\boldsymbol{s}^{n+1} - K\\beta\\Delta\\lambda\\mathbf{1} $$\n令偏量部分相等：\n$$ \\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - \\frac{3G\\Delta\\lambda}{q^{n+1}}\\boldsymbol{s}^{n+1} \\implies \\boldsymbol{s}^{n+1} \\left(1 + \\frac{3G\\Delta\\lambda}{q^{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}} $$\n此关系表明 $\\boldsymbol{s}^{n+1}$ 与 $\\boldsymbol{s}^{\\mathrm{tr}}$ 共线。对两边取 von Mises 等效应力，得到一个标量关系：\n$$ q^{n+1} \\left(1 + \\frac{3G\\Delta\\lambda}{q^{n+1}}\\right) = q^{\\mathrm{tr}} \\implies q^{n+1} + 3G\\Delta\\lambda = q^{\\mathrm{tr}} $$\n$$ q^{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\lambda $$\n令体积（静水）部分相等：\n$$ p^{n+1}\\mathbf{1} = p^{\\mathrm{tr}}\\mathbf{1} - K\\beta\\Delta\\lambda\\mathbf{1} \\implies p^{n+1} = p^{\\mathrm{tr}} - K\\beta\\Delta\\lambda $$\n\n**情况1：返回锥面 ($q^{n+1} > 0$)**\n修正后的状态必须满足屈服条件 $f(\\boldsymbol{\\sigma}^{n+1}) = q^{n+1} + \\alpha p^{n+1} - k = 0$。代入 $q^{n+1}$ 和 $p^{n+1}$ 的表达式：\n$$ (q^{\\mathrm{tr}} - 3G\\Delta\\lambda) + \\alpha(p^{\\mathrm{tr}} - K\\beta\\Delta\\lambda) - k = 0 $$\n重新整理以求解塑性乘子 $\\Delta\\lambda$：\n$$ q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k = \\Delta\\lambda(3G + \\alpha K \\beta) $$\n$$ \\Delta\\lambda = \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\beta} $$\n分子表示试探状态下的屈服函数值 $f^{\\mathrm{tr}}$。由于我们假设发生了塑性加载，所以 $f^{\\mathrm{tr}} > 0$。分母也为正，因为 $G > 0$、$K > 0$、$\\alpha > 0$ 且 $\\beta \\ge 0$，这保证了 $\\Delta\\lambda > 0$。\n\n**分支条件：返回锥面 vs. 返回锥顶**\n返回锥面的推导仅在 $q^{n+1} > 0$ 时有效。\n$$ q^{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\lambda > 0 \\implies q^{\\mathrm{tr}} > 3G\\Delta\\lambda $$\n代入 $\\Delta\\lambda$ 的表达式：\n$$ q^{\\mathrm{tr}} > 3G \\left( \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\beta} \\right) $$\n$$ q^{\\mathrm{tr}}(3G + \\alpha K \\beta) > 3G(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k) $$\n$$ 3Gq^{\\mathrm{tr}} + \\alpha K \\beta q^{\\mathrm{tr}} > 3Gq^{\\mathrm{tr}} + 3G\\alpha p^{\\mathrm{tr}} - 3Gk $$\n$$ \\alpha K \\beta q^{\\mathrm{tr}} > 3G(\\alpha p^{\\mathrm{tr}} - k) $$\n假设 $\\alpha > 0$, $K > 0$, $\\beta > 0$（$\\beta=0$ 的情况需要特殊处理，但会得到一个一致的极限），我们得到返回锥面的条件：\n$$ q^{\\mathrm{tr}} > \\frac{3G}{\\alpha K \\beta}(\\alpha p^{\\mathrm{tr}} - k) $$\n如果此不等式成立，则应力返回锥面。否则，返回锥顶。\n\n**情况2：返回锥顶 ($q^{n+1} = 0$)**\n当 $q^{\\mathrm{tr}} \\le \\frac{3G}{\\alpha K \\beta}(\\alpha p^{\\mathrm{tr}} - k)$ 时发生。\n从几何上看，这对应于返回路径（在 $(p,q)$ 平面中斜率为 $3G/(K\\beta)$ 的直线）与 $p$ 轴相交于压力 $p_{\\text{intersect}} > k/\\alpha$ 的点，该点在弹性域之外。因此，算法必须投影到最近的容许点，即锥顶本身。\n锥顶由 $q=0$ 和屈服条件 $q+\\alpha p - k \\le 0$ 定义，当 $q=0$ 时，该条件变为 $\\alpha p - k \\le 0$，或 $p \\le k/\\alpha$。屈服边界上的锥顶点位于 $p=k/\\alpha$。\n因此，对于锥顶返回，最终状态为：\n$$ q^{n+1} = 0 \\quad ; \\quad p^{n+1} = k/\\alpha $$\n在锥顶处，流动方向不唯一，位于塑性势的次微分中。$p$ 和 $q$ 的更新方程仍然成立，但我们根据已知的最终状态来确定 $\\Delta\\lambda$。使用静水压力更新方程：\n$$ p^{n+1} = p^{\\mathrm{tr}} - K\\beta\\Delta\\lambda $$\n$$ k/\\alpha = p^{\\mathrm{tr}} - K\\beta\\Delta\\lambda $$\n求解 $\\Delta\\lambda$（再次假设 $\\beta>0$）：\n$$ \\Delta\\lambda = \\frac{p^{\\mathrm{tr}} - k/\\alpha}{K\\beta} $$\n要使其成为一个有效的塑性乘子，我们需要 $\\Delta\\lambda > 0$，这意味着 $p^{\\mathrm{tr}} > k/\\alpha$。这与锥顶返回条件一致，因为 $q^{\\mathrm{tr}}>0$ 且 $q^{\\mathrm{tr}} \\le \\frac{3G}{\\alpha K \\beta}(\\alpha p^{\\mathrm{tr}} - k)$ 只有在 $(\\alpha p^{\\mathrm{tr}} - k) > 0$ 时才能满足，即 $p^{\\mathrm{tr}} > k/\\alpha$。\n\n**结果总结：**\n*   **分支条件：**\n    - 如果 $q^{\\mathrm{tr}} > \\dfrac{3G}{\\alpha K \\beta}(\\alpha p^{\\mathrm{tr}} - k)$，则返回锥面。\n    - 如果 $q^{\\mathrm{tr}} \\le \\dfrac{3G}{\\alpha K \\beta}(\\alpha p^{\\mathrm{tr}} - k)$，则返回锥顶。\n*   **返回锥面分支：**\n    - $\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\beta}$\n    - $q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$\n    - $p^{n+1} = p^{\\mathrm{tr}} - K \\beta \\Delta\\lambda$\n*   **返回锥顶分支：**\n    - $q^{n+1} = 0$\n    - $p^{n+1} = k/\\alpha$\n    - $\\Delta\\lambda = \\dfrac{p^{\\mathrm{tr}} - k/\\alpha}{K\\beta}$\n\n**逐项分析**\n\n*   **选项A：** `如果 $q^{\\mathrm{tr}} > \\dfrac{3G}{\\alpha K \\beta}\\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\beta}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\beta \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{p^{\\mathrm{tr}} - k/\\alpha}{K \\beta}$。`\n    此选项完全匹配推导出的分支条件、返回锥面的更新公式以及返回锥顶的更新公式。\n    **结论：正确**\n\n*   **选项B：** `如果 $q^{\\mathrm{tr}} > \\dfrac{2G}{\\alpha K \\beta}\\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{2G + \\alpha K \\beta}$，$q^{n+1} = q^{\\mathrm{tr}} - 2G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\beta \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{k/\\alpha - p^{\\mathrm{tr}}}{K \\beta}$。`\n    此选项在整个偏应力返回计算中错误地使用了因子 $2G$ 而不是 $3G$。因子 $3G$ 是由 $2G \\times (3/2)$ 正确得出的。此外，在锥顶返回情况中，$\\Delta\\lambda$ 表达式的分子符号错误。\n    **结论：错误**\n\n*   **选项C：** `如果 $q^{\\mathrm{tr}} > \\dfrac{3G}{K}\\left(p^{\\mathrm{tr}} - \\dfrac{k}{\\alpha}\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + K}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}} - K \\Delta\\lambda$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{k/\\alpha - p^{\\mathrm{tr}}}{K}$。`\n    分支条件缺少因子 $\\alpha$ 和 $\\beta$。返回锥面分支的更新方程隐含地假设了 $\\alpha=1$ 和 $\\beta=1$。锥顶返回的 $\\Delta\\lambda$ 也假设了 $\\beta=1$ 并且符号错误。这与给定的通用非关联模型不符。\n    **结论：错误**\n\n*   **选项D：** `如果 $q^{\\mathrm{tr}} > \\left(\\alpha p^{\\mathrm{tr}} - k\\right)$，则返回锥面；否则返回锥顶。在返回锥面的分支中，$\\Delta\\lambda = \\dfrac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G}$，$q^{n+1} = q^{\\mathrm{tr}} - 3G \\Delta\\lambda$，$p^{n+1} = p^{\\mathrm{tr}}$。在返回锥顶的分支中，$q^{n+1} = 0$，$p^{n+1} = \\dfrac{k}{\\alpha}$，且 $\\Delta\\lambda = \\dfrac{p^{\\mathrm{tr}} - k/\\alpha}{3G}$。`\n    此选项对应于返回锥面部分中 $\\beta=0$（无塑性剪胀）的特殊情况，因为 $p^{n+1}=p^{\\mathrm{tr}}$ 且 $\\Delta\\lambda$ 的分母缺少了与 K 相关的项。然而，即使在这种情况下，分支条件也是不正确的，并且返回锥顶分支中 $\\Delta\\lambda$ 的表达式也是不正确的（分母应为 $K\\beta$，当 $\\beta=0$ 时没有定义，这突显了此情况的奇异性）。该选项对于 $\\beta \\ge 0$ 的一般问题是无效的。\n    **结论：错误**", "answer": "$$\\boxed{A}$$", "id": "3596281"}]}