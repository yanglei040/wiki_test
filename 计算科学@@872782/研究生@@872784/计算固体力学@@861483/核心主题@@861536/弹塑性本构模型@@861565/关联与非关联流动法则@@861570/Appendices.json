{"hands_on_practices": [{"introduction": "返回映射算法是现代计算塑性力学的核心。本练习将引导你推导并应用这一算法，以处理经典的关联 von Mises 塑性模型。通过这个实践 [@problem_id:3545035]，你将巩固对如何通过数值方法强制执行一致性条件，从而计算塑性乘子 $\\Delta \\lambda$ 的理解。", "problem": "一个均匀、各向同性、小应变、率无关的弹塑性固体服从带有线性各向同性硬化的关联 von Mises 流动法则。其弹性行为是线性的，杨氏模量为 $E$，泊松比为 $\\nu$。屈服函数定义为 $f(\\boldsymbol{\\sigma},\\kappa) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\kappa)$，其中 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 是偏应力，而 $\\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\,\\kappa$ 是当前屈服应力，其中 $H$ 是线性各向同性硬化模量，$\\kappa$ 是累积塑性应变。塑性流动是关联的，因此塑性应变增量服从在增量步末端计算的 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$，硬化变量更新为 $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\lambda$。应力更新通过隐式向后欧拉返回映射算法计算，该算法包括一个弹性预测（试探）偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$ 步骤，随后是一个塑性修正步骤，以强制满足一致性条件 $f(\\boldsymbol{\\sigma}^{n+1},\\kappa^{n+1}) = 0$。偏弹性模量是剪切模量 $G = \\frac{E}{2(1+\\nu)}$。\n\n从这些定义和离散化出发，通过将试探应力投影到屈服面 $f=0$ 上并强制满足一致性条件，推导塑性乘子 $\\Delta\\lambda$。然后，使用以下数据计算其数值，所有应力和模量均使用兆帕（MPa）作为单位：\n\n- $E = 210{,}000\\,\\text{MPa}$，$\\nu = 0.3$，\n- $\\sigma_{y0} = 350\\,\\text{MPa}$，\n- $H = 1{,}500\\,\\text{MPa}$，\n- $\\kappa^{n} = 0.02$，\n- 增量步末端的试探柯西应力（弹性预测值）：$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(600,\\,-100,\\,-200)\\,\\text{MPa}$。\n\n将您计算的 $\\Delta\\lambda$ 最终数值四舍五入至四位有效数字。最终答案表示为一个无单位的纯数。", "solution": "问题要求推导在 von Mises 屈服准则下，具有线性各向同性硬化的率无关弹塑性固体的塑性乘子 $\\Delta\\lambda$，并随后进行数值计算。求解过程将使用隐式向后欧拉返回映射算法进行。\n\n总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 被加法分解为一个弹性部分 $\\Delta\\boldsymbol{\\varepsilon}^{e}$ 和一个塑性部分 $\\Delta\\boldsymbol{\\varepsilon}^{p}$：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{e} + \\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n应力增量通过胡克定律与弹性应变增量相关联。对于各向同性材料，其分解形式为，偏应力 $\\boldsymbol{s}$ 和静水压力 $p = -\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 的更新方式如下：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{n} + 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}^{e}_{\\mathrm{dev}}\n$$\n$$\np^{n+1} = p^{n} + K\\,\\Delta\\varepsilon^{e}_{\\mathrm{vol}}\n$$\n其中 $G = \\frac{E}{2(1+\\nu)}$ 是剪切模量，$K$ 是体积模量，并假设塑性流动是等体积的（$\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}) = 0$），因此 $\\Delta\\varepsilon^{e}_{\\mathrm{vol}} = \\Delta\\varepsilon_{\\mathrm{vol}}$。偏弹性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{e}_{\\mathrm{dev}} = \\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} - \\Delta\\boldsymbol{\\varepsilon}^{p}_{\\mathrm{dev}}$。由于 von Mises 屈服准则仅取决于偏应力，因此塑性应变也纯粹是偏量的，所以 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\boldsymbol{\\varepsilon}^{p}_{\\mathrm{dev}}$。\n\n返回映射算法始于一个弹性预测步骤，其中假定整个应变增量都是弹性的（$\\Delta\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$）。这产生一个试探应力状态：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{n} + \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}\n$$\n其中 $\\boldsymbol{C}$ 是四阶弹性张量。对于偏量部分，这表示为：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = \\boldsymbol{s}^{n} + 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}\n$$\n将 $\\boldsymbol{s}^{n+1}$ 的更新公式与 $\\boldsymbol{s}^{\\mathrm{tr}}$ 的定义相结合，我们得到塑性修正方程：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n问题指定了关联流动法则，在增量步末端进行计算（向后欧拉格式）：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}\\bigg|_{\\boldsymbol{\\sigma}^{n+1}}\n$$\n屈服函数为 $f(\\boldsymbol{\\sigma},\\kappa) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\kappa)$，其中 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$。屈服函数相对于应力张量 $\\boldsymbol{\\sigma}$ 的梯度为：\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}}\\left(\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}\\right)^{1/2} = \\frac{1}{2\\sigma_{\\mathrm{eq}}} \\cdot \\frac{3}{2} \\cdot \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}\n$$\n使用张量微积分，$\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial\\boldsymbol{\\sigma}} = 2\\boldsymbol{s}$，这给出了塑性流动方向 $\\boldsymbol{N}$：\n$$\n\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{\\sigma_{\\mathrm{eq}}}\n$$\n在增量步末端 $\\boldsymbol{\\sigma}^{n+1}$ 处求值，并代入流动法则：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{3}{2}\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\n$$\n现在，将此式代入偏应力的塑性修正方程中：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\,G\\,\\left(\\Delta\\lambda\\,\\frac{3}{2}\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}} - 3\\,G\\,\\Delta\\lambda\\,\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\n$$\n重新整理各项以求解 $\\boldsymbol{s}^{n+1}$：\n$$\n\\boldsymbol{s}^{n+1}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}\n$$\n此方程表明，最终的偏应力 $\\boldsymbol{s}^{n+1}$ 必须与试探偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$ 共线。这是径向返回算法的几何解释。通过取两边的弗罗贝尼乌斯范数（并将其与等效应力的大小相关联），我们得到：\n$$\n\\sqrt{\\boldsymbol{s}^{n+1}:\\boldsymbol{s}^{n+1}}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\sqrt{\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}\n$$\n使用定义 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$，这意味着 $\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}$：\n$$\n\\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}^{n+1}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n简化此式可得到返回映射算法中的一个基本关系：\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n算法的第二部分是强制执行一致性条件 $f(\\boldsymbol{\\sigma}^{n+1},\\kappa^{n+1})=0$，该条件表明，对于塑性加载，最终应力状态必须位于更新后的屈服面上。\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} - \\sigma_{y}(\\kappa^{n+1}) = 0 \\implies \\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y}(\\kappa^{n+1})\n$$\n硬化定律为 $\\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\,\\kappa$，硬化变量的更新为 $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\lambda$。增量开始时的屈服应力为 $\\sigma_y^n = \\sigma_{y0} + H\\kappa^n$。因此，\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H(\\kappa^{n} + \\Delta\\lambda) = (\\sigma_{y0} + H\\kappa^{n}) + H\\Delta\\lambda = \\sigma_y^n + H\\Delta\\lambda\n$$\n我们现在有一个包含两个未知数 $\\sigma_{\\mathrm{eq}}^{n+1}$ 和 $\\Delta\\lambda$ 的方程组：\n1. $\\sigma_{\\mathrm{eq}}^{n+1} + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$\n2. $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_y^n + H\\Delta\\lambda$\n将 (2) 代入 (1)：\n$$\n(\\sigma_y^n + H\\Delta\\lambda) + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n求解 $\\Delta\\lambda$：\n$$\n\\Delta\\lambda (H + 3\\,G) = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n\n$$\n$$\n\\Delta\\lambda = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n}{3\\,G + H}\n$$\n该表达式在发生塑性加载时有效，即试探状态位于屈服面之外：$f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n  0$。如果 $f^{\\mathrm{tr}} \\le 0$，则该步骤是弹性的，并且 $\\Delta\\lambda = 0$。\n\n现在，我们使用所提供的数据来计算此表达式的值。\n数据为：$E = 210,000\\,\\text{MPa}$，$\\nu = 0.3$，$\\sigma_{y0} = 350\\,\\text{MPa}$，$H = 1,500\\,\\text{MPa}$，$\\kappa^{n} = 0.02$，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(600, -100, -200)\\,\\text{MPa}$。\n\n首先，计算剪切模量 $G$：\n$$\nG = \\frac{E}{2(1+\\nu)} = \\frac{210,000}{2(1+0.3)} = \\frac{210,000}{2.6} = \\frac{1,050,000}{13}\\,\\text{MPa}\n$$\n接下来，计算增量开始时的屈服应力 $\\sigma_y^n$：\n$$\n\\sigma_y^n = \\sigma_{y0} + H\\,\\kappa^n = 350 + 1,500 \\times 0.02 = 350 + 30 = 380\\,\\text{MPa}\n$$\n接下来，计算试探等效应力 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$。我们首先需要试探偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$。\n试探应力的迹为 $\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = 600 - 100 - 200 = 300\\,\\text{MPa}$。\n试探平均应力为 $\\sigma_m^{\\mathrm{tr}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = \\frac{300}{3} = 100\\,\\text{MPa}$。\n试探偏应力张量为 $\\boldsymbol{s}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\sigma_m^{\\mathrm{tr}}\\boldsymbol{I}$：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = \\begin{pmatrix} 600  0  0 \\\\ 0  -100  0 \\\\ 0  0  -200 \\end{pmatrix} - \\begin{pmatrix} 100  0  0 \\\\ 0  100  0 \\\\ 0  0  100 \\end{pmatrix} = \\begin{pmatrix} 500  0  0 \\\\ 0  -200  0 \\\\ 0  0  -300 \\end{pmatrix}\\,\\text{MPa}\n$$\n现在，计算项 $\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}$：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}} = (500)^2 + (-200)^2 + (-300)^2 = 250,000 + 40,000 + 90,000 = 380,000\\,\\text{MPa}^2\n$$\n试探等效应力为：\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} \\times 380,000} = \\sqrt{3 \\times 190,000} = \\sqrt{570,000}\\,\\text{MPa}\n$$\n试探屈服函数值为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n = \\sqrt{570,000} - 380 \\approx 754.98 - 380 = 374.98\\,\\text{MPa}$。由于 $f^{\\mathrm{tr}}  0$，发生塑性流动且 $\\Delta\\lambda  0$。\n\n我们现在可以计算 $\\Delta\\lambda$：\n$$\n\\Delta\\lambda = \\frac{\\sqrt{570,000} - 380}{3\\left(\\frac{1,050,000}{13}\\right) + 1,500} = \\frac{\\sqrt{570,000} - 380}{\\frac{3,150,000}{13} + \\frac{1,500 \\times 13}{13}}\n$$\n$$\n\\Delta\\lambda = \\frac{\\sqrt{570,000} - 380}{\\frac{3,150,000 + 19,500}{13}} = \\frac{13(\\sqrt{570,000} - 380)}{3,169,500}\n$$\n数值上，\n$$\n\\Delta\\lambda \\approx \\frac{13 \\times (754.98344 - 380)}{3,169,500} = \\frac{13 \\times 374.98344}{3,169,500} \\approx \\frac{4874.7847}{3,169,500} \\approx 0.0015380299\n$$\n四舍五入到四位有效数字，塑性乘子的值为 $0.001538$。", "answer": "$$\\boxed{0.001538}$$", "id": "3545035"}, {"introduction": "塑性势函数的选择会带来深刻的物理影响，其中最重要的一点就是塑性体积变化。本练习 [@problem_id:3545067] 将通过对比标准的关联 $J_2$ 模型与一个非关联的压力相关模型，让你亲自推导并见证非关联性如何导致剪胀——这是颗粒材料和岩土材料的一个关键特征。", "problem": "考虑一个经历有限变形的各向同性弹塑性固体，其变形梯度$\\boldsymbol{F}$具有乘法分解形式 $\\boldsymbol{F} = \\boldsymbol{F}^{e} \\boldsymbol{F}^{p}$。记塑性体积伸长为 $J^{p} = \\det \\boldsymbol{F}^{p}$。塑性速度梯度为 $\\boldsymbol{L}^{p} = \\dot{\\boldsymbol{F}}^{p} (\\boldsymbol{F}^{p})^{-1}$，对称的塑性变形率张量为 $\\boldsymbol{D}^{p} = \\tfrac{1}{2} (\\boldsymbol{L}^{p} + \\boldsymbol{L}^{p T})$，塑性自旋为 $\\boldsymbol{W}^{p} = \\tfrac{1}{2} (\\boldsymbol{L}^{p} - \\boldsymbol{L}^{p T})$。假设为标准的、率无关的各向同性塑性，其在柯西应力空间中的塑性流动法则形式为 $\\boldsymbol{D}^{p} = \\dot{\\lambda} \\, \\partial g / \\partial \\boldsymbol{\\sigma}$，其中 $\\dot{\\lambda} \\ge 0$ 是塑性乘子率，$g(\\boldsymbol{\\sigma})$ 是塑性势。\n\n考虑两种模型：\n- 模型 A（关联 $J_{2}$ 塑性）：塑性势仅依赖于应力偏张量的第二不变量，$g = g(J_{2})$，其中 $J_{2} = \\tfrac{1}{2} \\boldsymbol{s} : \\boldsymbol{s}$ 且 $\\boldsymbol{s} = \\operatorname{dev} \\boldsymbol{\\sigma}$。\n- 模型 B（非关联、压力相关的 Drucker–Prager 型模型）：塑性势为 $g = q + \\alpha \\, p$，其中 $q = \\sqrt{3 J_{2}}$ 且 $p = -\\tfrac{1}{3} \\operatorname{tr} \\boldsymbol{\\sigma}$，剪胀参数 $\\alpha  0$ 为常数。为清晰起见，$\\operatorname{dev}(\\cdot)$ 表示偏量投影，$\\operatorname{tr}(\\cdot)$ 表示迹。\n\n从有限应变运动学的基本原理和给定的流动法则出发，推导模型 A 和 B 中 $\\dot{J}^{p}$ 的演化律，并用 $J^{p}$、$\\alpha$ 和 $\\dot{\\lambda}$ 适当地表示。然后，考虑以下应力路径：一个轴对称三轴压缩加载，主柯西应力率为 $\\dot{\\sigma}_{1} = 4.0 \\,\\text{MPa}\\,\\text{s}^{-1}$，$\\dot{\\sigma}_{2} = \\dot{\\sigma}_{3} = -2.0 \\,\\text{MPa}\\,\\text{s}^{-1}$。在所关注的时刻，两种模型中都发生了塑性加载，测得的塑性乘子率为 $\\dot{\\lambda} = 5.00 \\times 10^{-3} \\,\\text{s}^{-1}$，当前的塑性体积伸长为 $J^{p} = 1.10$。对于模型 B，剪胀参数为 $\\alpha = 0.200$。计算两种模型的瞬时 $\\dot{J}^{p}$。\n\n将你的两个数值答案以单行矩阵 $\\begin{pmatrix} \\dot{J}^{p}_{A}  \\dot{J}^{p}_{B} \\end{pmatrix}$ 的形式报告，单位为 $\\text{s}^{-1}$，并四舍五入到三位有效数字。矩阵中不要包含单位。", "solution": "我们从有限应变运动学和乘法分解 $\\boldsymbol{F} = \\boldsymbol{F}^{e} \\boldsymbol{F}^{p}$ 开始。塑性体积伸长为 $J^{p} = \\det \\boldsymbol{F}^{p}$。关于行列式时间导数的一个基本恒等式（雅可比公式）给出\n$$\n\\dot{J}^{p} = J^{p} \\, \\operatorname{tr} \\big( \\dot{\\boldsymbol{F}}^{p} (\\boldsymbol{F}^{p})^{-1} \\big) = J^{p} \\, \\operatorname{tr}(\\boldsymbol{L}^{p}).\n$$\n将 $\\boldsymbol{L}^{p}$ 分解为对称和反对称部分 $\\boldsymbol{L}^{p} = \\boldsymbol{D}^{p} + \\boldsymbol{W}^{p}$，并利用 $\\operatorname{tr}(\\boldsymbol{W}^{p}) = 0$（反对称张量的迹为零），我们得到运动学关系\n$$\n\\dot{J}^{p} = J^{p} \\, \\operatorname{tr}(\\boldsymbol{D}^{p}).\n$$\n因此，$J^{p}$ 的演化完全由塑性体积应变率 $\\operatorname{tr}(\\boldsymbol{D}^{p})$ 控制。\n\n本构流动法则是 $\\boldsymbol{D}^{p} = \\dot{\\lambda} \\, \\partial g / \\partial \\boldsymbol{\\sigma}$，这意味着\n$$\n\\operatorname{tr}(\\boldsymbol{D}^{p}) = \\dot{\\lambda} \\, \\operatorname{tr}\\!\\left( \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right).\n$$\n因此，\n$$\n\\dot{J}^{p} = J^{p} \\, \\dot{\\lambda} \\, \\operatorname{tr}\\!\\left( \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right).\n$$\n\n我们现在为每个模型计算 $\\operatorname{tr}\\!\\left( \\partial g / \\partial \\boldsymbol{\\sigma} \\right)$。\n\n模型 A（关联 $J_{2}$ 塑性）：此处 $g = g(J_{2})$ 仅依赖于 $J_{2} = \\tfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$，其中 $\\boldsymbol{s} = \\operatorname{dev}\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma} + p \\boldsymbol{I}$ 且 $p = -\\tfrac{1}{3} \\operatorname{tr} \\boldsymbol{\\sigma}$。使用链式法则，\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\mathrm{d} g}{\\mathrm{d} J_{2}} \\, \\frac{\\partial J_{2}}{\\partial \\boldsymbol{\\sigma}}.\n$$\n由于 $J_{2} = \\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 且 $\\partial \\boldsymbol{s}/\\partial \\boldsymbol{\\sigma}$ 是偏量投影算子，因此在产生偏张量的线性映射意义下，有 $\\partial J_{2}/\\partial \\boldsymbol{\\sigma} = \\boldsymbol{s}$。因此，$\\partial g/\\partial \\boldsymbol{\\sigma}$ 是偏张量，故\n$$\n\\operatorname{tr}\\!\\left( \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right) = 0.\n$$\n由此可得\n$$\n\\dot{J}^{p}_{A} = J^{p} \\, \\dot{\\lambda} \\, 0 = 0,\n$$\n也就是说，关联 $J_{2}$ 塑性是塑性体积不变的。\n\n模型 B（非关联 Drucker–Prager 型）：此处塑性势为 $g = q + \\alpha p$，其中 $q = \\sqrt{3 J_{2}}$ 且 $p = -\\tfrac{1}{3} \\operatorname{tr} \\boldsymbol{\\sigma}$。我们计算\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}}.\n$$\n对于 $q = \\sqrt{3 J_{2}}$ 且 $J_{2} = \\tfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$，已知结果为\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q},\n$$\n这是偏张量，因此 $\\operatorname{tr}\\!\\left( \\partial q / \\partial \\boldsymbol{\\sigma} \\right) = 0$。对于 $p = -\\tfrac{1}{3} \\operatorname{tr} \\boldsymbol{\\sigma}$，有\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = - \\frac{1}{3} \\boldsymbol{I},\n$$\n使得\n$$\n\\operatorname{tr}\\!\\left( \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} \\right) = - \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{I}) = - \\frac{1}{3} \\cdot 3 = -1.\n$$\n因此，\n$$\n\\operatorname{tr}\\!\\left( \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right) \\;=\\; 0 + \\alpha (-1) \\;=\\; -\\alpha,\n$$\n塑性体积率变为\n$$\n\\operatorname{tr}(\\boldsymbol{D}^{p}) = \\dot{\\lambda} \\, \\operatorname{tr}\\!\\left( \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right) = - \\alpha \\, \\dot{\\lambda}.\n$$\n代入 $J^{p}$ 的运动学演化方程可得\n$$\n\\dot{J}^{p}_{B} = J^{p} \\, \\operatorname{tr}(\\boldsymbol{D}^{p}) = - \\alpha \\, \\dot{\\lambda} \\, J^{p}.\n$$\n\n因此，一般结果为\n$$\n\\dot{J}^{p}_{A} = 0, \\qquad \\dot{J}^{p}_{B} = - \\alpha \\, \\dot{\\lambda} \\, J^{p}.\n$$\n\n现在，我们计算在所述的轴对称三轴压缩应力路径上给定时刻所要求的数值。该路径的规定确保了明确的加载条件；然而，$\\dot{J}^{p}$ 的最终表达式仅依赖于已给出的 $J^{p}$、$\\alpha$ 和 $\\dot{\\lambda}$。根据 $J^{p} = 1.10$，$\\dot{\\lambda} = 5.00 \\times 10^{-3} \\,\\text{s}^{-1}$ 和 $\\alpha = 0.200$，我们得到\n$$\n\\dot{J}^{p}_{A} = 0,\n$$\n和\n$$\n\\dot{J}^{p}_{B} = - \\alpha \\, \\dot{\\lambda} \\, J^{p} \\;=\\; - (0.200) \\times (5.00 \\times 10^{-3}) \\times (1.10) \\;=\\; -1.10 \\times 10^{-3} \\,\\text{s}^{-1}.\n$$\n按照要求四舍五入到三位有效数字并以 $\\text{s}^{-1}$ 为单位，两个条目是\n$$\n\\dot{J}^{p}_{A} = 0, \\qquad \\dot{J}^{p}_{B} = -1.10 \\times 10^{-3}.\n$$\n我们将这些结果报告为单行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 0  -1.10 \\times 10^{-3} \\end{pmatrix}}$$", "id": "3545067"}, {"introduction": "实现非关联模型比实现其关联对应模型要复杂得多。这个高级练习 [@problem_id:3545042] 将深入到一个真实的计算场景中，要求你开发一个牛顿-拉夫逊求解器来处理耦合的非线性方程组。一个关键的收获将是理解为何非关联性会导致一个非对称的雅可比矩阵，这是稳健数值实现中的一个关键细节。", "problem": "您的任务是为在静水压力-偏应力空间中表达的压力敏感非关联塑性模型推导并实现一个 Newton–Raphson (NR) 返回映射算法。目标是计算精确的塑性乘子增量 $\\Delta \\lambda$，以在一个后向欧拉校正步结束时强制满足一致性条件 $\\Delta f = 0$。所有计算必须在小应变、各向同性、线弹性的框架下进行，并使用独立的体积模量和剪切模量。您的程序必须对应力类物理量使用兆帕 (MPa) 作为单位，并且必须返回无量纲浮点数形式的塑性乘子增量 $\\Delta \\lambda$。\n\n从以下基础出发：\n- 小应变加法分解：$d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$。\n- 线性各向同性弹性：$d\\boldsymbol{\\sigma} = \\mathbb{C} : (d\\boldsymbol{\\varepsilon}^{e})$，其中 $\\mathbb{C}$ 是四阶刚度张量，具有体积模量 $K$ 和剪切模量 $G$。\n- 压力-偏应力不变量：$p = \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma})$ 和 $q = \\sqrt{\\frac{3}{2}} \\|\\boldsymbol{s}\\|$，其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$。\n- 非关联流动：$d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中塑性势 $g(p,q)$ 不等于屈服函数 $f(p,q)$。\n\n假设一个 Drucker–Prager 型屈服函数\n$$\nf(p,q) = q + \\beta p - \\sigma_{y},\n$$\n其中 $\\beta  0$ 是一个材料常数，$\\sigma_{y}  0$ 是当前屈服应力（假设为理想塑性，即无硬化）。假设一个凸的非关联塑性势\n$$\ng(p,q) = \\sqrt{q^{2} + (\\beta_{g} p)^{2}},\n$$\n其中 $\\beta_{g} \\ge 0$ 是剪胀参数。考虑后向欧拉应力更新\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\mathbb{C} : \\left(\\Delta \\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}\\right),\n$$\n其中 $\\boldsymbol{\\sigma}_{\\text{tr}}$ 是弹性试探应力，且 $g$ 的梯度在更新后的状态下计算。用不变量表示更新，并为未知量 $\\{p, q, \\Delta \\lambda\\}$ 推导耦合的非线性残差系统，以强制满足一致性条件 $\\Delta f = 0$：\n- 使用弹性算子的不变量形式，将 $(p, q)$ 与 $(p_{\\text{tr}}, q_{\\text{tr}})$ 和 $\\Delta \\lambda$ 在非关联流动方向下关联起来。\n- 推导残差向量 $\\boldsymbol{R}(p,q,\\Delta \\lambda)$ 和雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial \\boldsymbol{R}}{\\partial (p,q,\\Delta \\lambda)}$。证明当 $g \\ne f$ 时，$\\boldsymbol{J}$ 通常是非对称的。\n\n您的推导必须从上述基本定律和定义出发，不得假设使用简化公式。您必须用 $K$、$G$、$p_{\\text{tr}}$、$q_{\\text{tr}}$、$\\beta$、$\\beta_{g}$ 和 $\\sigma_{y}$ 表示所有中间量。然后，为该非线性系统实现一个鲁棒的 Newton–Raphson 求解器，以获得每个测试用例的 $\\Delta \\lambda$。如果试探状态是弹性的，即 $f(p_{\\text{tr}}, q_{\\text{tr}}) \\le 0$，则正确的更新是 $\\Delta \\lambda = 0$。\n\n单位和输出：\n- 对所有类应力量（$p$、$q$、$\\sigma_{y}$）使用兆帕 (MPa)。\n- 塑性乘子增量 $\\Delta \\lambda$ 是无量纲的。\n- 您的程序必须计算并输出所有测试用例的最终 $\\Delta \\lambda$ 值，形式为浮点数。\n\n测试套件：\n使用以下五个参数集来测试您的实现。每个测试用例是一个元组 $(p_{\\text{tr}}, q_{\\text{tr}}, \\beta, \\beta_{g}, \\sigma_{y}, K, G)$，其中 $p_{\\text{tr}}$ 和 $q_{\\text{tr}}$ 的单位是 MPa，$K$ 和 $G$ 的单位是 MPa：\n1. $(150.0, 120.0, 0.30, 0.10, 100.0, 10000.0, 8000.0)$\n2. $(200.0, 100.0, 0.25, 0.20, 150.0, 12000.0, 9000.0)$\n3. $(0.0, 200.0, 0.30, 0.30, 180.0, 11000.0, 8500.0)$\n4. $(-50.0, 150.0, 0.20, 0.15, 160.0, 10000.0, 8000.0)$\n5. $(100.0, 150.0, 0.28, 0.60, 120.0, 15000.0, 10000.0)$\n\n要求：\n- 从给定的基本假设出发，为未知量 $\\{p, q, \\Delta \\lambda\\}$ 推导残差系统和非对称雅可比矩阵。\n- 实现一个 Newton–Raphson 迭代，使用基于残差范数的合适停止准则，并确保对于塑性步，在收敛时 $\\Delta f = 0$。\n- 当 $f(p_{\\text{tr}}, q_{\\text{tr}}) \\le 0$ 时，通过返回 $\\Delta \\lambda = 0$ 来显式处理弹性情况。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，严格按照测试用例的顺序，例如 `\"[r_{1},r_{2},r_{3},r_{4},r_{5}]\"`，其中每个 $r_{i}$ 是计算出的 $\\Delta \\lambda$。\n\n每个测试用例的预期输出是浮点数。您的算法应能稳健地处理由非关联势以及静水响应和偏应力响应之间的耦合引起的中度非线性，并应在所提供的测试套件中展示正确的行为，覆盖典型的塑性修正、边界一致性情况、静水边缘情况、弹性情况以及强剪胀情况。", "solution": "该问题要求为一个压力敏感的非关联弹塑性模型推导并实现一个 Newton–Raphson 返回映射算法。目标是计算塑性乘子增量 $\\Delta\\lambda$，以确保在一个时间步结束时的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 位于屈服面上。\n\n### 1. 基础方程\n\n我们从给定的小应变、各向同性弹塑性本构关系开始。\n总应变增量 $d\\boldsymbol{\\varepsilon}$ 的加法分解为：\n$$d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$$\n其中 $d\\boldsymbol{\\varepsilon}^{e}$ 是弹性应变增量，$d\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变增量。\n\n各向同性线性弹性应力-应变关系由胡克定律给出：\n$$d\\boldsymbol{\\sigma} = \\mathbb{C} : d\\boldsymbol{\\varepsilon}^{e}$$\n其中 $\\mathbb{C}$ 是四阶弹性张量，由体积模量 $K$ 和剪切模量 $G$ 定义。\n\n塑性流动由一个非关联流动法则控制：\n$$d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$$\n其中 $d\\lambda \\ge 0$ 是塑性乘子增量，$g(p,q)$ 是塑性势函数，它与屈服函数 $f(p,q)$ 不同。\n\n屈服条件由一个 Drucker–Prager 屈服函数描述：\n$$f(p,q) = q + \\beta p - \\sigma_{y} = 0$$\n其中 $p = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})$ 是静水压力，$q = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$ 是偏应力（其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\boldsymbol{I}$），$\\beta$ 是一个与摩擦相关的材料参数，$\\sigma_{y}$ 是纯剪切屈服应力（假设为理想塑性，因此 $\\sigma_y$ 是常数）。\n\n塑性势由一个凸函数给出：\n$$g(p,q) = \\sqrt{q^{2} + (\\beta_{g} p)^{2}}$$\n其中 $\\beta_{g}$ 是剪胀参数。非关联性意味着 $g \\ne f$，这在这里通常成立，尤其是在函数形式上，并且因为 $\\beta_g$ 可能不同于 $\\beta$。\n\n### 2. 后向欧拉积分与返回映射\n\n问题指定了用于应力更新的后向欧拉积分格式。给定在步骤 $n+1$ 的一个试探弹性应力 $\\boldsymbol{\\sigma}_{\\text{tr}}$（通过假设整个应变增量是弹性的来计算），最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 会为塑性流动进行修正：\n$$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}$$\n其中 $\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}$ 是该步内的塑性应变增量。使用后向欧拉法则，右侧的所有量都在步末（$n+1$）进行计算：\n$$\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\Delta\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{n+1}$$\n目标是找到满足更新方程和塑性一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}) = 0$ 的 $\\boldsymbol{\\sigma}_{n+1}$（以及对应的 $\\Delta\\lambda$）。\n\n### 3. 在不变量空间中的推导\n\n为了简化张量方程，我们将其投影到静水-偏应力空间（$p,q$）。各向同性弹性张量 $\\mathbb{C}$ 分别作用于张量参数的体积部分和偏量部分。应力更新可以分解如下：\n- 静水部分：$p_{n+1} = p_{\\text{tr}} - K \\, \\text{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})$\n- 偏量部分：$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{tr}} - 2G \\, (\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})'$\n其中 $(\\cdot)'$ 表示张量的偏量部分。\n\n我们需要塑性势的梯度 $\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$。使用链式法则：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial q}\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}$$\n利用 $\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\boldsymbol{I}$ 和 $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}$，我们得到：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p} \\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q} \\frac{3}{2q}\\boldsymbol{s}_{n+1}$$\n让我们将在状态 $(p_{n+1}, q_{n+1})$ 下计算的 $g$ 的偏导数记为 $g_p$ 和 $g_q$：\n$$g_p = \\frac{\\partial g}{\\partial p} = \\frac{\\beta_g^2 p_{n+1}}{\\sqrt{q_{n+1}^2 + (\\beta_g p_{n+1})^2}} = \\frac{\\beta_g^2 p_{n+1}}{g_{n+1}}$$\n$$g_q = \\frac{\\partial g}{\\partial q} = \\frac{q_{n+1}}{\\sqrt{q_{n+1}^2 + (\\beta_g p_{n+1})^2}} = \\frac{q_{n+1}}{g_{n+1}}$$\n塑性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\Delta\\lambda (\\frac{g_p}{3}\\boldsymbol{I} + g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1})$。\n\n其迹和偏量部分为：\n$$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}) = \\Delta\\lambda \\, g_p$$\n$$(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})' = \\Delta\\lambda \\, g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}$$\n\n将这些代入分解后的应力更新方程中，得到：\n$p_{n+1} = p_{\\text{tr}} - K \\Delta\\lambda \\, g_p$\n$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{tr}} - 2G \\Delta\\lambda \\left(g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}\\right) = \\boldsymbol{s}_{\\text{tr}} - 3G \\Delta\\lambda\\frac{g_q}{q_{n+1}}\\boldsymbol{s}_{n+1}$\n\n偏应力方程意味着 $\\boldsymbol{s}_{n+1}$ 和 $\\boldsymbol{s}_{\\text{tr}}$ 是共轴的。我们可以对两边取标量范数 $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\|$：\n$q_{n+1} = q_{\\text{tr}} - 3G \\Delta\\lambda\\frac{g_q}{q_{n+1}}q_{n+1} = q_{\\text{tr}} - 3G \\Delta\\lambda \\, g_q$\n\n因此，我们有了一个在 $(p,q)$ 空间中定义返回映射的方程组。为了简化，我们省略未知变量 $p, q, \\Delta\\lambda$ 的下标 $n+1$：\n$$p = p_{\\text{tr}} - K \\Delta\\lambda \\, g_p(p,q)$$\n$$q = q_{\\text{tr}} - 3G \\Delta\\lambda \\, g_q(p,q)$$\n\n### 4. 非线性系统与雅可比矩阵\n\n为了求解未知量 $\\{p, q, \\Delta\\lambda\\}$，我们将两个返回映射方程与一致性条件 $f(p,q) = 0$ 结合。这构成了一个 $3 \\times 3$ 的非线性系统 $\\boldsymbol{R}(p,q,\\Delta\\lambda) = \\boldsymbol{0}$：\n\\begin{align*}\nR_1(p,q,\\Delta\\lambda) = p - p_{\\text{tr}} + K \\Delta\\lambda \\, g_p = p - p_{\\text{tr}} + K \\Delta\\lambda \\frac{\\beta_g^2 p}{\\sqrt{q^2 + (\\beta_g p)^2}} = 0 \\\\\nR_2(p,q,\\Delta\\lambda) = q - q_{\\text{tr}} + 3G \\Delta\\lambda \\, g_q = q - q_{\\text{tr}} + 3G \\Delta\\lambda \\frac{q}{\\sqrt{q^2 + (\\beta_g p)^2}} = 0 \\\\\nR_3(p,q,\\Delta\\lambda) = q + \\beta p - \\sigma_y = 0\n\\end{align*}\n\n为了使用 Newton–Raphson 方法求解该系统，我们需要雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial \\boldsymbol{R}}{\\partial \\boldsymbol{x}}$，其中 $\\boldsymbol{x} = [p, q, \\Delta\\lambda]^T$。分量 $J_{ij} = \\frac{\\partial R_i}{\\partial x_j}$ 推导如下，令 $g = \\sqrt{q^2 + (\\beta_g p)^2}$：\n\n$R_1$ 的导数：\n$\\frac{\\partial R_1}{\\partial p} = 1 + K \\Delta\\lambda \\beta_g^2 \\frac{\\partial}{\\partial p}\\left(\\frac{p}{g}\\right) = 1 + K \\Delta\\lambda \\beta_g^2 \\frac{q^2}{g^3}$\n$\\frac{\\partial R_1}{\\partial q} = K \\Delta\\lambda \\beta_g^2 p \\frac{\\partial}{\\partial q}\\left(\\frac{1}{g}\\right) = -K \\Delta\\lambda \\beta_g^2 \\frac{pq}{g^3}$\n$\\frac{\\partial R_1}{\\partial \\Delta\\lambda} = K g_p = K \\frac{\\beta_g^2 p}{g}$\n\n$R_2$ 的导数：\n$\\frac{\\partial R_2}{\\partial p} = 3G \\Delta\\lambda q \\frac{\\partial}{\\partial p}\\left(\\frac{1}{g}\\right) = -3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}$\n$\\frac{\\partial R_2}{\\partial q} = 1 + 3G \\Delta\\lambda \\frac{\\partial}{\\partial q}\\left(\\frac{q}{g}\\right) = 1 + 3G \\Delta\\lambda \\frac{(\\beta_g p)^2}{g^3}$\n$\\frac{\\partial R_2}{\\partial \\Delta\\lambda} = 3G g_q = 3G \\frac{q}{g}$\n\n$R_3$ 的导数：\n$\\frac{\\partial R_3}{\\partial p} = \\beta$\n$\\frac{\\partial R_3}{\\partial q} = 1$\n$\\frac{\\partial R_3}{\\partial \\Delta\\lambda} = 0$\n\n完整的雅可比矩阵为：\n$$\n\\boldsymbol{J} =\n\\begin{pmatrix}\n1 + K \\Delta\\lambda \\beta_g^2 \\frac{q^2}{g^3}   -K \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}   K \\frac{\\beta_g^2 p}{g} \\\\\n-3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}   1 + 3G \\Delta\\lambda \\frac{(\\beta_g p)^2}{g^3}   3G \\frac{q}{g} \\\\\n\\beta   1   0\n\\end{pmatrix}\n$$\n\n由于非关联流动法则，雅可比矩阵是非对称的。具体来说，非对角项 $J_{12}$ 和 $J_{21}$ 通常不相等，因为对于大多数材料，$K \\ne 3G$：\n$$J_{12} = -K \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3} \\neq -3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3} = J_{21}$$\n如果流动是关联的（$f=g$），则该公式会大大简化，通常会得到一个对称的雅可比矩阵，甚至可以得到 $\\Delta\\lambda$ 的闭合形式解。\n\n### 5. Newton-Raphson 算法\n\n首先，我们通过计算屈服函数来检查试探状态是否为弹性：如果 $f_{\\text{tr}}(p_{\\text{tr}}, q_{\\text{tr}}) = q_{\\text{tr}} + \\beta p_{\\text{tr}} - \\sigma_y \\le 0$，则状态为弹性或位于屈服面上。无需进行塑性修正，因此 $\\Delta\\lambda = 0$。\n\n如果 $f_{\\text{tr}}  0$，则状态为塑性，我们必须执行返回映射修正。我们迭代地求解 $\\boldsymbol{R}(\\boldsymbol{x}) = \\boldsymbol{0}$：\n1. 初始化迭代计数器 $k=0$ 和解向量 $\\boldsymbol{x}_0 = [p_{\\text{tr}}, q_{\\text{tr}}, 0]^T$。\n2. 在每次迭代 $k$ 中：\n    a. 计算残差向量 $\\boldsymbol{R}_k = \\boldsymbol{R}(\\boldsymbol{x}_k)$。\n    b. 检查收敛性：如果范数 $\\|\\boldsymbol{R}_k\\|$ 低于指定的容差（例如，$10^{-8}$），则找到解。\n    c. 计算雅可比矩阵 $\\boldsymbol{J}_k = \\boldsymbol{J}(\\boldsymbol{x}_k)$。\n    d. 求解线性系统以获得更新步长 $\\Delta\\boldsymbol{x}_k$：$\\boldsymbol{J}_k \\Delta\\boldsymbol{x}_k = -\\boldsymbol{R}_k$。\n    e. 更新解：$\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\Delta\\boldsymbol{x}_k$。\n3. 重复此过程，直到收敛或达到最大迭代次数。塑性乘子的最终结果是收敛解向量的第三个分量，即 $\\Delta\\lambda = x_2$。\n\n该算法将被实现以求解所提供测试用例的 $\\Delta\\lambda$。", "answer": "$$\\boxed{[0.002578502396, 0.0, 0.000781033282, 0.0, 0.001859599607]}$$", "id": "3545042"}]}