## 引言
在计算结构力学领域，[梁单元](@entry_id:746744)的[有限元分析](@entry_id:138109)是工程师与研究者分析框架、桥梁及各种骨架结构的基础。其核心在于如何将连续的[梁理论](@entry_id:176426)系统地离散化为一组可由计算机求解的[代数方程](@entry_id:272665)。这其中，精确构造描述单元力-位移关系的**刚度矩阵**，以及等效表示作用于单元上复杂[分布](@entry_id:182848)荷载的**[一致荷载向量](@entry_id:163156)**，是整个分析过程的关键，也是初学者常常感到困惑的环节。

本文旨在填补这一知识空白，通过三章内容，为读者提供一个关于梁[单元[刚度矩](@entry_id:139369)阵](@entry_id:178659)和[一致荷载向量](@entry_id:163156)的全面而深入的理解。在“**原理与机制**”一章中，我们将从虚功原理和形函数等第一性原理出发，一步步推导出这些核心矩阵和向量的数学形式及其物理意义。接下来的“**应用与[交叉](@entry_id:147634)学科联系**”一章将展示这些基本构件如何被扩展应用于处理[热应力](@entry_id:180613)、地基相互作用、电磁力等复杂的[多物理场](@entry_id:164478)问题。最后，通过“**动手实践**”部分提供的练习，读者将有机会亲手应用所学知识，巩固理论理解。

现在，让我们从[梁单元](@entry_id:746744)最基本的力学原理与数学构造开始，深入探索其“原理与机制”。

## 原理与机制

本章在前一章介绍[梁单元](@entry_id:746744)有限元方法背景的基础上，深入探讨其核心的理论原理与具体实现机制。我们将系统地推导[梁单元](@entry_id:746744)的[刚度矩阵](@entry_id:178659)和[一致荷载向量](@entry_id:163156)，并阐明其在结构分析中的物理意义与数学构造。我们将从[梁单元](@entry_id:746744)的基本运动学描述出发，通过虚功原理建立力与位移之间的关系，然后引入形函数来近似单元内的位移场，最终导出求解有限元方程所必需的各个矩阵和向量。

### [梁单元](@entry_id:746744)的运动学描述与能量共轭力

在有限元方法中，精确描述单元的[运动学](@entry_id:173318)行为是首要任务。这包括定义其自由度（Degrees of Freedom, DOFs）以及与这些自由度相对应的[广义力](@entry_id:169699)。

对于一个在 $x-y$ 平面内弯曲的平面 Euler–Bernoulli [梁单元](@entry_id:746744)，其长度为 $L$，连接节点 $i$（位于 $x=0$）和节点 $j$（位于 $x=L$）。该单元的基本[运动学](@entry_id:173318)假设是其[横截面](@entry_id:154995)在变形后保持为平面且垂直于变形后的中性轴。在此假设下，单元的变形可以完全由其横向位移 $w(x)$ 和[横截面](@entry_id:154995)转角 $\theta(x)$ 描述。对于小变形问题，转角是位移的导数，即 $\theta(x) = \frac{dw(x)}{dx}$。

为了通过节点上的有限个变量来描述整个单元的变形，我们选取每个节点处的横向位移 $w$ 和转角 $\theta$ 作为**节点自由度**。因此，一个两节点的平面[梁单元](@entry_id:746744)共有四个自由度，可以表示为一个节点位移向量 $\mathbf{d}$：
$$
\mathbf{d} = \{ w_i, \theta_i, w_j, \theta_j \}^{\mathsf{T}}
$$

为了确定与这些位移自由度相对应的力，我们应用**虚功原理 (Principle of Virtual Work, PVW)**。[虚功原理](@entry_id:138749)指出，对于处于平衡状态的物体，[内力](@entry_id:167605)在任意[虚位移](@entry_id:168781)场上所做的[虚功](@entry_id:176403)（[内虚功](@entry_id:172278) $\delta W_{\text{int}}$）等于外力在同一[虚位移](@entry_id:168781)场上所做的[虚功](@entry_id:176403)（外[虚功](@entry_id:176403) $\delta W_{\text{ext}}$）。

对于[梁单元](@entry_id:746744)，[内虚功](@entry_id:172278)主要由弯矩 $M(x)$ 在虚曲率 $\delta\kappa(x)$ 上做功产生。通过[分部积分](@entry_id:136350)，可以将[内虚功](@entry_id:172278)表达式与节点[虚位移](@entry_id:168781)联系起来。这个过程揭示了在单元边界（即节点处），内力所做的功必须由外部施加的节点力来平衡。这些与节点[虚位移](@entry_id:168781) $\delta w$ 和虚转角 $\delta \theta$ 直接对应的节点力，被称为**能量共轭**的广义节点力。

通过详细的推导可以证明，与横向位移 $w$ 能量共轭的力是**横向剪力 $V$**，而与转角 $\theta$ 能量共轭的力是**[弯矩](@entry_id:202968) $M$**。因此，对应于节点自由度向量 $\mathbf{d} = \{w_i, \theta_i, w_j, \theta_j\}^{\mathsf{T}}$ 的广义节点力向量 $\mathbf{f}$ 为：
$$
\mathbf{f} = \{ V_i, M_i, V_j, M_j \}^{\mathsf{T}}
$$
其中，$V_i$ 和 $M_i$ 是节点 $i$ 处的剪力和[弯矩](@entry_id:202968)，$V_j$ 和 $M_j$ 是节点 $j$ 处的[剪力](@entry_id:172634)和弯矩。节点上的[虚功](@entry_id:176403)可以表示为 $\delta W_{\text{nodal}} = V \delta w + M \delta \theta$。[@problem_id:3602704]

当我们将分析从[纯弯曲](@entry_id:202969)梁扩展到**平面框架单元**时，还需要考虑[轴向变形](@entry_id:180213)。此时，每个节点增加一个轴向位移自由度 $u$。同样基于能量共轭原理，与轴向位移 $u$ 对应的[广义力](@entry_id:169699)是**轴向力 $N$**。因此，一个平面框架单元在局部坐标系下有六个自由度，其节点位移向量和对应的节点力向量分别为：
$$
\mathbf{d} = \{ u_1, w_1, \theta_1, u_2, w_2, \theta_2 \}^{\mathsf{T}}
$$
$$
\mathbf{f} = \{ N_1, V_1, M_1, N_2, V_2, M_2 \}^{\mathsf{T}}
$$
这种位移与力的配对关系是建立[单元刚度矩阵](@entry_id:139369)和力向量的基础。[@problem_id:3602687]

### 插值与形函数

确定了节点自由度后，我们需要一种方法来描述单元内部任意点的位移，这通过**插值 (Interpolation)** 实现。我们使用一组称为**形函数 (Shape Functions)** 的[基函数](@entry_id:170178)，将单元内的连续位移场 $w(x)$ 表示为节点自由度 $\mathbf{d}$ 的线性组合。

对于 Euler-Bernoulli 梁，其应变能表达式包含位移的[二阶导数](@entry_id:144508)（曲率）。为了确保[应变能](@entry_id:162699)是有限的，[位移场](@entry_id:141476) $w(x)$ 必须是 $C^1$ 连续的，即位移本身及其一阶导数（转角）在单元内部及节点处都是连续的。为了满足这一要求，并使用四个节点自由度（$w_1, \theta_1, w_2, \theta_2$）来唯一确定位移场，我们需要一个至少包含四个待定系数的多项式，即三次多项式（Cubic Polynomial）：
$$
w(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3
$$
其导数（转角）为：
$$
\theta(x) = \frac{dw}{dx} = a_1 + 2 a_2 x + 3 a_3 x^2
$$
通过施加在两个节点上的四个边界条件：
- $w(0) = w_1$
- $\theta(0) = w'(0) = \theta_1$
- $w(L) = w_2$
- $\theta(L) = w'(L) = \theta_2$

我们可以解出系数 $a_0, a_1, a_2, a_3$ 与节点自由度的关系。将结果重新整理，可以把 $w(x)$ 写成如下形式：
$$
w(x) = N_1(x) w_1 + N_2(x) \theta_1 + N_3(x) w_2 + N_4(x) \theta_2
$$
其中，$N_1(x), N_2(x), N_3(x), N_4(x)$ 就是著名的**三次 Hermite 形函数**：
$$
\begin{aligned}
N_1(x) = 1 - \frac{3x^2}{L^2} + \frac{2x^3}{L^3} \\
N_2(x) = x - \frac{2x^2}{L} + \frac{x^3}{L^2} \\
N_3(x) = \frac{3x^2}{L^2} - \frac{2x^3}{L^3} \\
N_4(x) = -\frac{x^2}{L} + \frac{x^3}{L^2}
\end{aligned}
$$
这些形函数具有所谓的**克罗内克-德尔塔 (Kronecker-delta)** 特性，例如，$N_1(x)$ 在节点1处值为1，在节点2处值为0，其导数在两个节点处均为0。类似地，$N_2(x)$ 在节点1处的导数为1，但在节点1和节点2处的值均为0。

利用这些形函数，我们可以构造一个 $2 \times 4$ 的插值矩阵 $[N(x)]$，将单元内任意点的位移和转角与节点自由度向量 $\mathbf{d}$ 联系起来：
$$
\begin{pmatrix} w(x) \\ \theta(x) \end{pmatrix} = [N(x)] \mathbf{d} = \begin{pmatrix} N_1(x)  N_2(x)  N_3(x)  N_4(x) \\ N_1'(x)  N_2'(x)  N_3'(x)  N_4'(x) \end{pmatrix} \begin{pmatrix} w_1 \\ \theta_1 \\ w_2 \\ \theta_2 \end{pmatrix}
$$
该矩阵的第一行是 Hermite 形函数，第二行是它们的导数。这个插值关系是后续推导刚度矩阵和[一致荷载向量](@entry_id:163156)的数学基础。[@problem_id:3602721]

### [单元刚度矩阵](@entry_id:139369)的推导

**[单元刚度矩阵](@entry_id:139369) $\mathbf{K}_e$** 定义了节点力与节点位移之间的线性关系，即 $\mathbf{f} = \mathbf{K}_e \mathbf{d}$。它源于系统的应变能。对于一个线弹性体，应变能 $U$ 可以表示为节点位移的二次型：
$$
U = \frac{1}{2} \mathbf{d}^{\mathsf{T}} \mathbf{K}_e \mathbf{d}
$$
对于 Euler-Bernoulli 梁，其[应变能](@entry_id:162699)完全由弯曲产生，其表达式为：
$$
U = \frac{1}{2} \int_{0}^{L} EI \kappa(x)^2 dx
$$
其中，$E$ 是[杨氏模量](@entry_id:140430)，$I$ 是[截面](@entry_id:154995)惯性矩，$EI$ 是[抗弯刚度](@entry_id:180453)，而 $\kappa(x) = \frac{d^2w}{dx^2}$ 是梁的曲率。

利用形函数插值，我们可以将曲率 $\kappa(x)$ 表示为节点自由度 $\mathbf{d}$ 的函数。对位移插值表达式 $w(x) = \mathbf{N}_w(x) \mathbf{d}$（这里 $\mathbf{N}_w(x)$ 是形函数行向量）求[二阶导数](@entry_id:144508)，得到：
$$
\kappa(x) = \frac{d^2w}{dx^2} = \frac{d^2\mathbf{N}_w(x)}{dx^2} \mathbf{d} = \mathbf{B}(x) \mathbf{d}
$$
这里的 $\mathbf{B}(x)$ 矩阵称为**[应变-位移矩阵](@entry_id:163451)**，其分量是形函数的[二阶导数](@entry_id:144508)，$\mathbf{B}(x) = [N_1''(x), N_2''(x), N_3''(x), N_4''(x)]$。

将此关系代入[应变能](@entry_id:162699)表达式：
$$
U = \frac{1}{2} \int_{0}^{L} EI (\mathbf{B}(x)\mathbf{d})^{\mathsf{T}} (\mathbf{B}(x)\mathbf{d}) dx = \frac{1}{2} \mathbf{d}^{\mathsf{T}} \left( \int_{0}^{L} EI \mathbf{B}(x)^{\mathsf{T}} \mathbf{B}(x) dx \right) \mathbf{d}
$$
通过与 $U = \frac{1}{2} \mathbf{d}^{\mathsf{T}} \mathbf{K}_e \mathbf{d}$ 对比，我们得到[单元刚度矩阵](@entry_id:139369)的积分表达式：
$$
\mathbf{K}_e = \int_{0}^{L} EI \mathbf{B}(x)^{\mathsf{T}} \mathbf{B}(x) dx
$$
对于具有恒定抗弯刚度 $EI$ 的棱柱梁，我们可以计算出形函数的[二阶导数](@entry_id:144508)，并完成积分。例如，[刚度矩阵](@entry_id:178659)的第一个元素 $K_{11}$ 为 $EI \int_0^L (N_1''(x))^2 dx$。执行所有积分运算后，我们得到经典的 $4 \times 4$ **弯曲刚度矩阵 $\mathbf{k}_b$**：[@problem_id:3602686]
$$
\mathbf{k}_b = \frac{EI}{L^3}
\begin{pmatrix}
12  & 6L  & -12  & 6L \\
6L  & 4L^2  & -6L  & 2L^2 \\
-12  & -6L  & 12  & -6L \\
6L  & 2L^2  & -6L  & 4L^2
\end{pmatrix}
$$

对于考虑[轴向变形](@entry_id:180213)的平面框架单元，我们还需要推导**轴向[刚度矩阵](@entry_id:178659) $\mathbf{k}_a$**。[轴向变形](@entry_id:180213)通常采用简单的线性 ($C^0$) 插值，其刚度矩阵为：
$$
\mathbf{k}_a = \frac{EA}{L}
\begin{pmatrix}
1  & -1 \\
-1  & 1
\end{pmatrix}
$$
在轴向与弯曲变形[解耦](@entry_id:637294)的假设下（[截面](@entry_id:154995)对称），完整的 $6 \times 6$ **平面框架单元局部刚度矩阵 $\mathbf{K}$** 可以通过组合轴向和[弯曲刚度](@entry_id:180453)矩阵得到。根据自由度向量 $\mathbf{d} = \{u_{1}, w_{1}, \theta_{1}, u_{2}, w_{2}, \theta_{2}\}^{\mathsf{T}}$ 的顺序，我们将 $\mathbf{k}_a$ 和 $\mathbf{k}_b$ 的元素放置到相应的位置，得到：[@problem_id:3602698]
$$
\mathbf{K} =
\begin{pmatrix}
\frac{EA}{L} & 0 & 0 & -\frac{EA}{L} & 0 & 0 \\
0 & \frac{12EI}{L^3} & \frac{6EI}{L^2} & 0 & -\frac{12EI}{L^3} & \frac{6EI}{L^2} \\
0 & \frac{6EI}{L^2} & \frac{4EI}{L} & 0 & -\frac{6EI}{L^2} & \frac{2EI}{L} \\
-\frac{EA}{L} & 0 & 0 & \frac{EA}{L} & 0 & 0 \\
0 & -\frac{12EI}{L^3} & -\frac{6EI}{L^2} & 0 & \frac{12EI}{L^3} & -\frac{6EI}{L^2} \\
0 & \frac{6EI}{L^2} & \frac{2EI}{L} & 0 & -\frac{6EI}{L^2} & \frac{4EI}{L}
\end{pmatrix}
$$
矩阵中的大量零元素清晰地展示了在[局部坐标系](@entry_id:751394)下轴向和弯曲响应的解耦特性。

### [一致节点荷载](@entry_id:176954)向量

当[梁单元](@entry_id:746744)受到[分布](@entry_id:182848)荷载 $q(x)$（例如，重力或风压）作用时，我们需要将这个连续的荷载等效地转换为作用在节点上的**节点荷载向量 $\mathbf{f}_e$**。一种简单的方法是**集总荷载 (Lumped Load)**，例如将总荷载平均分配到两个节点上。然而，这种方法忽略了荷载在单元长度上的[分布](@entry_id:182848)特性，不够精确。

一种更严谨的方法是推导**[一致节点荷载](@entry_id:176954)向量 (Consistent Nodal Load Vector)**。其核心思想是：等效的节点荷载向量 $\mathbf{f}_e$ 在任意虚节点位移 $\delta\mathbf{d}$ 上所做的[虚功](@entry_id:176403)，必须等于原始[分布](@entry_id:182848)荷载 $q(x)$ 在由 $\delta\mathbf{d}$ 插值得到的连续[虚位移](@entry_id:168781)场 $\delta w(x)$ 上所做的[虚功](@entry_id:176403)。
$$
\delta\mathbf{d}^{\mathsf{T}} \mathbf{f}_e = \int_0^L q(x) \delta w(x) dx
$$
将 $\delta w(x) = \mathbf{N}_w(x) \delta \mathbf{d}$ 代入上式，我们得到：
$$
\delta\mathbf{d}^{\mathsf{T}} \mathbf{f}_e = \delta\mathbf{d}^{\mathsf{T}} \left( \int_0^L \mathbf{N}_w(x)^{\mathsf{T}} q(x) dx \right)
$$
由于该等式对任意 $\delta\mathbf{d}$ 均成立，因此[一致荷载向量](@entry_id:163156)的表达式为：
$$
\mathbf{f}_e = \int_0^L \mathbf{N}_w(x)^{\mathsf{T}} q(x) dx
$$
这意味着荷载向量的每个分量 $f_i$ 是通过对应的形函数 $N_i(x)$ 对[分布](@entry_id:182848)荷载 $q(x)$ 进行加权积分得到的。

作为一个基本示例，考虑作用在整个单元上的**均布荷载** $q$。通过对 Hermite 形函数进行积分，我们可以得到[一致荷载向量](@entry_id:163156)：[@problem_id:3602758]
$$
\mathbf{f}_e = \{ \frac{qL}{2}, \frac{qL^2}{12}, \frac{qL}{2}, -\frac{qL^2}{12} \}^{\mathsf{T}}
$$
与简单的集总荷载模型 $\mathbf{f}_{\text{lump}} = \{\frac{qL}{2}, 0, \frac{qL}{2}, 0\}^{\mathsf{T}}$ 相比，[一致荷载向量](@entry_id:163156)不仅包含了等效的节点力（$qL/2$），还包含了等效的**节点弯矩**。这些[弯矩](@entry_id:202968)项 $\frac{qL^2}{12}$ 和 $-\frac{qL^2}{12}$ 恰好是经典结构力学中两端固定梁在均布荷载作用下的**固端矩 (Fixed-End Moments)**。集总荷载模型忽略了这些弯矩，相当于引入了“伪”或**虚假的端部弯矩**，其大小为 $\frac{qL^2}{12}$。这正是使用[一致荷载向量](@entry_id:163156)比集总荷载更精确的原因，因为它在能量（功）的意义上更准确地模拟了[分布](@entry_id:182848)荷载的效果。[@problem_id:3602684]

对于更复杂的情况，例如**线性变化的[分布](@entry_id:182848)荷载** $q(x) = q_0 + q_1x$，我们同样可以应用积分公式，得到相应的荷载向量。例如，其第一和第二个分量（节点1处的力和力矩）分别为：[@problem_id:3602700]
$$
f_1 = \frac{q_0 L}{2} + \frac{3 q_1 L^2}{20}
$$
$$
f_2 = \frac{q_0 L^2}{12} + \frac{q_1 L^3}{30}
$$
其他分量也可以类似计算得出。

### 数值积分与系统集成

在实际的有限元程序中，刚度矩阵和荷载向量的积分通常使用**[数值积分](@entry_id:136578) (Numerical Integration)**，特别是**[高斯-勒让德求积](@entry_id:138201) (Gauss-Legendre Quadrature)**。这种方法通过在特定积分点（[高斯点](@entry_id:170251)）上对被积函数求值并加权求和来近似定积分。一个具有 $n_g$ 个积分点的高斯求积法则可以精确地积分最高次数为 $2n_g - 1$ 的多项式。

为了**精确地**计算刚度矩阵和荷载向量，我们需要选择足够多的[高斯点](@entry_id:170251)。
- **刚度矩阵**：其被积函数为 $\mathbf{B}^{\mathsf{T}}\mathbf{B}$。对于 Hermite 三次形函数，$\mathbf{B}(x)$ 是线性多项式。因此，被积函数是二次多项式（次数为2）。为了精确积分，需要 $2n_g - 1 \ge 2$，这意味着 $n_g \ge 1.5$。因此，最少需要 **2个[高斯点](@entry_id:170251)**。[@problem_id:3602692]
- **[一致荷载向量](@entry_id:163156)**：对于线性变化的荷载 $q(x)$（次数为1），被积函数为 $\mathbf{N}^{\mathsf{T}}q(x)$。由于形函数 $\mathbf{N}(x)$ 是三次多项式，被积函数的最高次数为 $3+1=4$。为了精确积分，需要 $2n_g - 1 \ge 4$，这意味着 $n_g \ge 2.5$。因此，最少需要 **3个[高斯点](@entry_id:170251)**。[@problem_id:3602700]
选择合适的积分阶数是确保计算精度和效率的关键。

### [刚体模态](@entry_id:754366)与边界条件

我们推导出的[单元刚度矩阵](@entry_id:139369)有一个重要特性：它是**奇异的 (Singular)**，或者说**半正定的 (Positive Semidefinite)**。这意味着存在非零的位移向量 $\mathbf{d}_{\text{RBM}}$，使得 $\mathbf{K}_e \mathbf{d}_{\text{RBM}} = \mathbf{0}$。这些位移向量对应于**[刚体模态](@entry_id:754366) (Rigid-Body Modes)**，即不产生任何应变（因此没有[应变能](@entry_id:162699)）的运动。对于平面梁，存在两种[刚体模态](@entry_id:754366)：
1.  **刚体平移**：$w(x) = a$（常数）
2.  **[刚体转动](@entry_id:191086)**：$w(x) = bx$（绕原点的小角度转动）

任何形如 $w(x) = a + bx$ 的[位移场](@entry_id:141476)，其曲率 $\kappa = w''(x) = 0$，因此[应变能](@entry_id:162699) $U=0$。当单元被组装成一个完整的结构时，未施加约束的[全局刚度矩阵](@entry_id:138630) $\mathbf{K}$ 同样是半正定的，反映了整个结构可以作为刚体自由移动。

为了得到一个有唯一解的静力学问题，我们必须施加足够的**[本质边界条件](@entry_id:173524) (Essential Boundary Conditions)** 来消除所有的[刚体模态](@entry_id:754366)。[本质边界条件](@entry_id:173524)直接约束了某些节点自由度的值（例如，指定某点的位移或转角为零）。一个有效的约束集必须能确保唯一能满足所有边界条件的刚体位移是零位移（即 $a=0$ 和 $b=0$）。

以下是一些典型的边界条件及其效果分析：[@problem_id:3602746]
- **固支端 (Clamped)**：在 $x=0$ 处施加 $w(0)=0$ 和 $\theta(0)=0$。将 $w(x)=a+bx$ 代入，得到 $a=0$ 和 $b=0$。这消除了所有[刚体模态](@entry_id:754366)。
- **两端简支 (Simply Supported)**：在 $x=0$ 和 $x=L$ 处施加 $w(0)=0$ 和 $w(L)=0$。代入后得到 $a=0$ 和 $a+bL=0$，从而 $b=0$。这也消除了所有[刚体模态](@entry_id:754366)。
- **一端固定转角**：仅施加 $\theta(0)=0$。这只能约束 $b=0$，但 $a$ 仍是任意的。结构仍可以自由平移，因此不足以获得唯一解。
- **混合约束**：在 $x=0$ 处施加 $w(0)=0$，在 $x=L$ 处施加 $\theta(L)=0$。这同样可以约束 $a=0$ 和 $b=0$，构成一个静定结构。

只有当施加的边界条件足以消除所有[刚体模态](@entry_id:754366)时，缩减后的[全局刚度矩阵](@entry_id:138630)才会变为**正定的 (Positive Definite)**，从而保证对于任意给定的荷载向量，线性方程组 $\mathbf{K}\mathbf{d}=\mathbf{f}$ 存在唯一的解。对于无约束的自由体（如太空中的卫星），其刚度矩阵是半正定的。此时，只有当外荷载满足平衡条件（即合力与[合力矩](@entry_id:166772)为零）时，方程才有解，但解不是唯一的，可以相差一个任意的刚体位移。