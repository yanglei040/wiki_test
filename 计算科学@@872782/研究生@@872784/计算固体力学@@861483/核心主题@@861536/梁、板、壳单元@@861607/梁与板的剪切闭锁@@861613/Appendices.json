{"hands_on_practices": [{"introduction": "本实践是观察剪切锁死现象的经典切入点。通过使用线性有限元对一根简单的Timoshenko梁进行建模，我们可以将不同积分方案（完全积分与减缩积分）的数值结果与精确的解析解进行直接比较。该练习清晰、定量地展示了在细长梁中，剪切锁死如何表现为过度的刚度，以及减缩积分如何为此提供一种简单而有效的补救措施。[@problem_id:3600155]", "problem": "一根长度为 $L$、矩形截面宽度为 $b$、厚度为 $h$ 的悬臂梁，使用Timoshenko梁理论（TBT）进行建模，并通过有限元法（FEM）进行离散化。横向位移 $w(x)$ 和转角 $\\theta(x)$ 采用双节点线性单元。梁在 $x=0$ 处被固支，并在自由端 $x=L$ 处承受一个横向集中载荷 $P$。材料是线性弹性的，其杨氏模量为 $E$，泊松比为 $\\nu$，剪切模量为 $G = \\dfrac{E}{2(1+\\nu)}$。剪切修正因子 $\\kappa$ 用于修正剪切刚度，以考虑沿厚度方向的非均匀剪应力。目标是为细长梁和厚梁的尖端挠度构建定量基准，并通过比较剪切能的完全积分与减缩积分来揭示剪切锁死现象。\n\n从第一性原理出发：Timoshenko梁的运动学关系表明，剪应变为 $\\gamma(x) = \\dfrac{dw}{dx} - \\theta(x)$，弯曲曲率为 $\\dfrac{d\\theta}{dx}$。本构关系为弯矩 $M(x) = E I \\dfrac{d\\theta}{dx}$ 和剪力 $V(x) = \\kappa G A \\gamma(x)$，其中 $I = \\dfrac{b h^3}{12}$ 是截面二次矩，$A = b h$ 是截面积。在尖端载荷 $P$ 作用下，梁的总势能为\n$$\n\\Pi[w,\\theta] = \\int_{0}^{L} \\left( \\tfrac{1}{2} E I \\left(\\dfrac{d\\theta}{dx}\\right)^2 + \\tfrac{1}{2} \\kappa G A \\left(\\dfrac{dw}{dx} - \\theta\\right)^2 \\right) \\, dx \\;-\\; P\\, w(L).\n$$\n在每个单元上使用线性形函数对 $w$ 和 $\\theta$ 进行离散化，组集全局刚度矩阵，在 $x=0$ 处应用固支边界条件（$w(0)=0$，$\\theta(0)=0$），并求解节点自由度。计算每个测试用例的有限元模型的尖端挠度 $w(L)$。作为定量基准，将数值得到的 $w(L)$ 与Timoshenko梁理论给出的悬臂梁在尖端载荷作用下的精确解析尖端挠度进行比较，\n$$\nw_{\\mathrm{exact}} = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa G A}.\n$$\n定义无量纲比率\n$$\nR = \\frac{w_{\\mathrm{FE}}}{w_{\\mathrm{exact}}},\n$$\n其中 $w_{\\mathrm{FE}}$ 是有限元计算的尖端挠度。使用此比率来评估精度并识别剪切锁死，其中 $R \\ll 1$ 表示由于自锁导致的过度刚性。\n\n为剪切项 $\\int \\tfrac{1}{2} \\kappa G A \\left(\\dfrac{dw}{dx}-\\theta\\right)^2 dx$ 实现两种求积方案：\n- 在参考单元上使用$2$点Gauss-Legendre求积进行完全积分，\n- 在参考单元上使用$1$点Gauss-Legendre求积进行减缩积分。\n弯曲项 $\\int \\tfrac{1}{2} E I \\left(\\dfrac{d\\theta}{dx}\\right)^2 dx$ 应进行精确积分。\n\n在国际单位制（SI）中使用以下科学上符合实际的材料和几何参数：$E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$，$\\nu = 0.3$，$\\kappa = \\dfrac{5}{6}$，$b = 1.0 \\times 10^{-2}\\,\\mathrm{m}$，$L = 1.0\\,\\mathrm{m}$，以及 $P = 1.0 \\times 10^{3}\\,\\mathrm{N}$。考虑三种厚度以涵盖从细长梁到厚梁的范围：$h \\in \\{1.0 \\times 10^{-3}\\,\\mathrm{m},\\, 1.0 \\times 10^{-2}\\,\\mathrm{m},\\, 1.0 \\times 10^{-1}\\,\\mathrm{m}\\}$，并采用不同的网格分辨率和积分方案。\n\n将测试套件设计为以下六个案例，每个案例由元组 $(L,b,h,E,\\nu,\\kappa,P,N_{\\mathrm{el}},n_{\\mathrm{g}})$ 指定，其中 $N_{\\mathrm{el}}$ 是单元数量，$n_{\\mathrm{g}}$ 是用于剪切项的Gauss点数：\n- 案例 1: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 1,\\, 2)$。\n- 案例 2: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 1,\\, 1)$。\n- 案例 3: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 8,\\, 2)$。\n- 案例 4: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-3},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 8,\\, 1)$。\n- 案例 5: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-1},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 2,\\, 2)$。\n- 案例 6: $(1.0,\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-1},\\, 2.10\\times 10^{11},\\, 0.3,\\, \\dfrac{5}{6},\\, 1.0\\times 10^{3},\\, 2,\\, 1)$。\n\n您的程序必须为每个案例计算 $R$。最终输出必须是单行文本，包含六个比率，形式为逗号分隔的列表，并用方括号括起来，每个比率四舍五入到$6$位小数，例如 $\\left[\\dots\\right]$。由于 $R$ 是无量纲的，输出中不需要物理单位。不允许使用外部输入或文件；所有参数都将嵌入程序中。", "solution": "该问题要求使用基于Timoshenko梁理论（TBT）的有限元法（FEM）计算悬臂梁的尖端挠度。目标是通过比较细长梁和厚梁在完全和减缩数值积分方案下的结果，来分析剪切自锁现象。数值结果将与精确解析解进行比较。\n\n出发点是梁的总势能 $\\Pi$，它是应变能与外载荷势之和。\n$$\n\\Pi[w,\\theta] = U_b + U_s - W_{ext} = \\int_{0}^{L} \\frac{1}{2} E I \\left(\\frac{d\\theta}{dx}\\right)^2 dx + \\int_{0}^{L} \\frac{1}{2} \\kappa G A \\left(\\frac{dw}{dx} - \\theta\\right)^2 dx - P w(L)\n$$\n此处，$U_b$ 是弯曲应变能，$U_s$ 是剪切应变能。$w(x)$ 是横向位移，$\\theta(x)$ 是截面转角，$E$ 是杨氏模量，$I$ 是截面二次矩，$\\kappa$ 是剪切修正因子，$G$ 是剪切模量，$A$ 是截面积，$L$ 是梁的长度，$P$ 是尖端载荷。\n\n在有限元法中，连续函数 $w(x)$ 和 $\\theta(x)$ 在每个单元上使用形函数和节点值进行近似。对于长度为 $l_e$ 的双节点线性单元，其近似式为：\n$$\nw(\\xi) = N_1(\\xi) w_1 + N_2(\\xi) w_2 \\quad \\text{and} \\quad \\theta(\\xi) = N_1(\\xi) \\theta_1 + N_2(\\xi) \\theta_2\n$$\n其中 $\\xi \\in [-1, 1]$ 是单元上的自然坐标，$w_i$ 和 $\\theta_i$ 是节点自由度（DOFs），$N_1(\\xi) = \\frac{1}{2}(1-\\xi)$ 和 $N_2(\\xi) = \\frac{1}{2}(1+\\xi)$ 是线性形函数。单元的节点位移向量为 $\\mathbf{d}_e = [w_1, \\theta_1, w_2, \\theta_2]^T$。\n\n弯曲曲率和剪应变用节点自由度表示。曲率 $\\frac{d\\theta}{dx}$ 在一个线性单元内是常数：\n$$\n\\frac{d\\theta}{dx} = \\frac{d\\theta}{d\\xi}\\frac{d\\xi}{dx} = \\frac{1}{l_e}(-\\theta_1 + \\theta_2) = \\mathbf{B}_b \\mathbf{d}_e, \\quad \\text{where } \\mathbf{B}_b = \\frac{1}{l_e}[0, -1, 0, 1]\n$$\n剪应变 $\\gamma(x) = \\frac{dw}{dx} - \\theta(x)$ 为：\n$$\n\\gamma(\\xi) = \\frac{1}{l_e}(-w_1 + w_2) - (N_1(\\xi)\\theta_1 + N_2(\\xi)\\theta_2) = \\mathbf{B}_s(\\xi) \\mathbf{d}_e\n$$\n其中 $\\mathbf{B}_s(\\xi) = [-\\frac{1}{l_e}, -N_1(\\xi), \\frac{1}{l_e}, -N_2(\\xi)]$。\n\n单元刚度矩阵 $\\mathbf{K}_e$ 是通过最小化势能推导出来的，得到 $\\mathbf{K}_e = \\mathbf{K}_{b,e} + \\mathbf{K}_{s,e}$。弯曲刚度矩阵 $\\mathbf{K}_{b,e}$ 为：\n$$\n\\mathbf{K}_{b,e} = \\int_0^{l_e} E I (\\mathbf{B}_b)^T \\mathbf{B}_b dx = E I l_e (\\mathbf{B}_b)^T \\mathbf{B}_b = \\frac{E I}{l_e} \\begin{bmatrix} 0  0  0  0 \\\\ 0  1  0  -1 \\\\ 0  0  0  0 \\\\ 0  -1  0  1 \\end{bmatrix}\n$$\n由于被积函数是常数，这代表了精确积分。\n\n剪切刚度矩阵 $\\mathbf{K}_{s,e}$ 是通过在单元长度上进行数值积分来计算的：\n$$\n\\mathbf{K}_{s,e} = \\int_0^{l_e} \\kappa G A (\\mathbf{B}_s)^T \\mathbf{B}_s dx = \\int_{-1}^{1} \\kappa G A (\\mathbf{B}_s(\\xi))^T \\mathbf{B}_s(\\xi) \\frac{l_e}{2} d\\xi\n$$\n\n对于减缩积分（$n_g=1$），我们使用一个位于 $\\xi=0$ 且权重为 $w_1=2$ 的Gauss点。在 $\\xi=0$ 处，$N_1(0)=N_2(0)=1/2$，且 $\\mathbf{B}_s(0) = [-\\frac{1}{l_e}, -\\frac{1}{2}, \\frac{1}{l_e}, -\\frac{1}{2}]$。该积分变为：\n$$\n\\mathbf{K}_{s,e}^{(\\text{1-pt})} = \\kappa G A \\frac{l_e}{2} \\left( w_1 (\\mathbf{B}_s(0))^T \\mathbf{B}_s(0) \\right) = \\kappa G A l_e (\\mathbf{B}_s(0))^T \\mathbf{B}_s(0)\n$$\n$$\n\\mathbf{K}_{s,e}^{(\\text{1-pt})} = \\kappa G A \\begin{bmatrix} 1/l_e  1/2  -1/l_e  1/2 \\\\ 1/2  l_e/4  -1/2  l_e/4 \\\\ -1/l_e  -1/2  1/l_e  -1/2 \\\\ 1/2  l_e/4  -1/2  l_e/4 \\end{bmatrix}\n$$\n\n对于完全积分（$n_g=2$），我们使用两个位于 $\\xi_{1,2} = \\mp 1/\\sqrt{3}$ 且权重为 $w_{1,2}=1$ 的Gauss点。这等效于对 $(\\mathbf{B}_s)^T \\mathbf{B}_s$ 中的多项式项进行精确积分，这些项关于 $\\xi$ 最多是二次的。得到的矩阵为：\n$$\n\\mathbf{K}_{s,e}^{(\\text{2-pt})} = \\kappa G A \\begin{bmatrix} 1/l_e  1/2  -1/l_e  1/2 \\\\ 1/2  l_e/3  -1/2  l_e/6 \\\\ -1/l_e  -1/2  1/l_e  -1/2 \\\\ 1/2  l_e/6  -1/2  l_e/3 \\end{bmatrix}\n$$\n总单元刚度矩阵为 $\\mathbf{K}_e = \\mathbf{K}_{b,e} + \\mathbf{K}_{s,e}$，其中使用相应的剪切矩阵。\n\n对于由 $N_{\\mathrm{el}}$ 个单元组成的网格，组集全局刚度矩阵 $\\mathbf{K}$ 和力向量 $\\mathbf{F}$。该系统有 $2(N_{\\mathrm{el}}+1)$ 个自由度。力向量 $\\mathbf{F}$ 除了对应于尖端节点（$x=L$）横向位移的项等于 $P$ 之外，其余各项均为零。通过移除 $\\mathbf{K}$ 的前两行和前两列以及 $\\mathbf{F}$ 的前两项，来施加根部（$x=0$）的固支边界条件，$w(0)=0$ 和 $\\theta(0)=0$。然后求解得到的简化系统 $\\mathbf{K}_{\\text{reduced}} \\mathbf{d}_{\\text{reduced}} = \\mathbf{F}_{\\text{reduced}}$ 以获得未知的节点自由度 $\\mathbf{d}_{\\text{reduced}}$。\n\n从解向量中，提取尖端挠度 $w_{\\mathrm{FE}} = w(L)$。将其与TBT的精确解析解进行比较：\n$$\nw_{\\mathrm{exact}} = \\frac{P L^3}{3 E I} + \\frac{P L}{\\kappa G A}\n$$\n为每个测试用例计算无量纲比率 $R = w_{\\mathrm{FE}}/w_{\\mathrm{exact}}$。对于细长梁，剪应变 $\\gamma = dw/dx - \\theta$ 必须趋近于零。使用线性单元进行完全积分会过强地施加此条件，导致单元变得过度刚硬，这种现象称为剪切自锁，表现为 $R \\ll 1$。对剪切项进行减缩积分可以放松此约束，从而减轻自锁现象，并为细长梁提供更准确的结果。\n\n每个测试用例的计算步骤如下：\n1.  定义几何和材料参数。\n2.  计算单元长度 $l_e = L/N_{\\mathrm{el}}$。\n3.  计算单元弯曲刚度矩阵 $\\mathbf{K}_{b,e}$。\n4.  根据指定的Gauss点数 $n_{\\mathrm{g}}$ 计算单元剪切刚度矩阵 $\\mathbf{K}_{s,e}$。\n5.  形成总单元刚度矩阵 $\\mathbf{K}_e$。\n6.  为包含 $N_{\\mathrm{el}}$ 个单元的网格组集全局刚度矩阵 $\\mathbf{K}$。\n7.  定义在尖端施加载荷 $P$ 的全局力向量 $\\mathbf{F}$。\n8.  应用边界条件以获得简化系统。\n9.  求解线性系统以获得未知位移。\n10. 提取数值计算的尖端挠度 $w_{\\mathrm{FE}}$。\n11. 计算精确尖端挠度 $w_{\\mathrm{exact}}$。\n12. 计算并存储比率 $R = w_{\\mathrm{FE}} / w_{\\mathrm{exact}}$。\n\n对所有六个指定的测试用例重复此过程，涵盖具有不同网格分辨率和积分方案的细长梁和厚梁，以演示剪切自锁的原理及其解决方法。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the tip deflection of a Timoshenko beam using FEM\n    and compares it to the exact analytical solution to demonstrate shear locking.\n    \"\"\"\n\n    def solve_fem_timoshenko(L, b, h, E, nu, kappa, P, Nel, n_g):\n        \"\"\"\n        Computes the ratio R = w_FE / w_exact for a single test case.\n\n        Args:\n            L (float): Beam length\n            b (float): Cross-section breadth\n            h (float): Cross-section thickness\n            E (float): Young's modulus\n            nu (float): Poisson's ratio\n            kappa (float): Shear correction factor\n            P (float): Tip load\n            Nel (int): Number of elements\n            n_g (int): Number of Gauss points for shear term (1 or 2)\n\n        Returns:\n            float: The ratio R of FEM-calculated to exact tip deflection.\n        \"\"\"\n        # 1. Derived properties\n        G = E / (2 * (1 + nu))\n        A = b * h\n        I = b * h**3 / 12\n        le = L / Nel\n\n        # 2. Element stiffness matrices\n        # Bending stiffness matrix (integrated exactly)\n        K_b_e = (E * I / le) * np.array([\n            [0,  0,  0,  0],\n            [0,  1,  0, -1],\n            [0,  0,  0,  0],\n            [0, -1,  0,  1]\n        ])\n\n        # Shear stiffness matrix (numerical integration)\n        if n_g == 1:  # Reduced integration (1-point Gauss)\n            K_s_e = (kappa * G * A) * np.array([\n                [1/le,    1/2, -1/le,    1/2],\n                [ 1/2,   le/4,  -1/2,   le/4],\n                [-1/le,  -1/2,  1/le,   -1/2],\n                [ 1/2,   le/4,  -1/2,   le/4]\n            ])\n        elif n_g == 2:  # Full integration (2-point Gauss)\n            K_s_e = (kappa * G * A) * np.array([\n                [1/le,    1/2, -1/le,    1/2],\n                [ 1/2,   le/3,  -1/2,   le/6],\n                [-1/le,  -1/2,  1/le,   -1/2],\n                [ 1/2,   le/6,  -1/2,   le/3]\n            ])\n        else:\n            raise ValueError(\"Number of Gauss points n_g must be 1 or 2.\")\n        \n        K_e = K_b_e + K_s_e\n\n        # 3. Assembly of global stiffness matrix\n        num_nodes = Nel + 1\n        num_dof = 2 * num_nodes\n        K_global = np.zeros((num_dof, num_dof))\n\n        for i in range(Nel):\n            dof_indices = np.array([2*i, 2*i+1, 2*i+2, 2*i+3])\n            K_global[np.ix_(dof_indices, dof_indices)] += K_e\n\n        # 4. Global force vector\n        F_global = np.zeros(num_dof)\n        F_global[2 * Nel] = P  # Apply force P at w-dof of the last node\n\n        # 5. Apply Boundary Conditions (clamped at x=0, node 0)\n        # DOFs 0 (w_0) and 1 (theta_0) are fixed.\n        # We form the reduced system by removing rows/columns 0 and 1.\n        K_reduced = K_global[2:, 2:]\n        F_reduced = F_global[2:]\n\n        # 6. Solve the linear system\n        d_reduced = np.linalg.solve(K_reduced, F_reduced)\n        \n        # 7. Extract FEM tip deflection\n        # The tip deflection w(L) is at node Nel. Its global DOF is 2*Nel.\n        # In the reduced vector, its index is 2*Nel - 2.\n        w_FE = d_reduced[2 * Nel - 2]\n    \n        # 8. Calculate exact analytical solution\n        w_exact_bending = (P * L**3) / (3 * E * I)\n        w_exact_shear = (P * L) / (kappa * G * A)\n        w_exact = w_exact_bending + w_exact_shear\n\n        # 9. Compute and return the ratio R\n        R = w_FE / w_exact\n        return R\n\n    # Define the six test cases from the problem statement\n    test_cases = [\n        # (L,     b,      h,      E,        nu,  kappa,   P,    Nel, n_g)\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 1, 2),  # Case 1\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 1, 1),  # Case 2\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 8, 2),  # Case 3\n        (1.0, 1.0e-2, 1.0e-3, 2.10e11, 0.3, 5/6, 1.0e3, 8, 1),  # Case 4\n        (1.0, 1.0e-2, 1.0e-1, 2.10e11, 0.3, 5/6, 1.0e3, 2, 2),  # Case 5\n        (1.0, 1.0e-2, 1.0e-1, 2.10e11, 0.3, 5/6, 1.0e3, 2, 1)   # Case 6\n    ]\n\n    results = []\n    for case in test_cases:\n        R = solve_fem_timoshenko(*case)\n        # Format the result to 6 decimal places as required.\n        results.append(f\"{R:.6f}\")\n\n    # Print the final output in the exact specified format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3600155"}, {"introduction": "在观察到剪切自锁现象后，下一个合乎逻辑的步骤是理解其在单元公式内部的根源。本实践采用“膜片检验”（patch test），这是一项验证有限元一致性的基本工具。通过对单个双线性板单元施加一个纯弯曲状态——该状态理论上应不产生任何剪切应变——我们将以解析方式计算出该单元错误产生的伪剪切能，从而揭示导致剪切自锁的标准单元列式中存在的数学缺陷。[@problem_id:3600168]", "problem": "考虑 Mindlin–Reissner 板理论，其中横向剪切应变由以下关系式定义：$$\\gamma_{xz}=\\frac{\\partial w}{\\partial x} - \\theta_{x},\\qquad \\gamma_{yz}=\\frac{\\partial w}{\\partial y} - \\theta_{y},$$ 其中 $w(x,y)$ 是中性面的横向位移，$(\\theta_{x}(x,y),\\theta_{y}(x,y))$ 分别是法线绕 $y$ 轴和 $-x$ 轴的转角。一个四节点双线性四边形等参 Mindlin 板单元占据矩形区域 $$\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}\\,|\\,0\\le x\\le L,\\;0\\le y\\le H\\},$$ 其节点位于 $(0,0)$、$(L,0)$、$(L,H)$ 和 $(0,H)$。设自然坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，其仿射映射为 $$x=\\frac{L}{2}(1+\\xi),\\qquad y=\\frac{H}{2}(1+\\eta),$$ 并设标准双线性形函数为 $$N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\quad N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).$$ $w$、$\\theta_{x}$ 和 $\\theta_{y}$ 的有限元法 (FEM) 插值取为 $$w_{h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i},\\qquad \\theta_{x,h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{x,i},\\qquad \\theta_{y,h}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,\\theta_{y,i},$$ 其中下标 $h$ 表示离散场，节点值 $(w_{i},\\theta_{x,i},\\theta_{y,i})$ 根据零剪切斑块检验的定义，通过在节点处对精确场进行采样来给定： $$w(x,y)=\\alpha x^{2},\\qquad \\theta_{x}(x,y)=\\frac{\\partial w}{\\partial x}=2\\alpha x,\\qquad \\theta_{y}(x,y)=\\frac{\\partial w}{\\partial y}=0.$$ 使用这些给定条件，计算单元的残余离散剪切能 $$U_{s}=\\frac{1}{2}\\,\\kappa\\,G\\,t\\int_{\\Omega}\\left(\\gamma_{xz,h}^{2}+\\gamma_{yz,h}^{2}\\right)\\,d\\Omega,$$ 其中 $\\kappa$ 是剪切修正因子，$G$ 是剪切模量，$t$ 是板厚。将最终答案表示为以 $\\alpha$、$L$、$H$、$\\kappa$、$G$ 和 $t$ 表示的符号闭式解析表达式。最终能量以焦耳为单位表示。不需要进行数值近似或四舍五入。", "solution": "该问题要求计算一个四节点双线性四边形单元在纯弯曲变形场下的离散剪切能 $U_s$。该变形场在理论上应不产生任何剪切应变。然而，由于低阶单元插值函数的局限性，会产生一个虚假的、非零的剪切能，这是剪切锁死现象的根源。\n\n首先，我们通过在单元的四个节点处对给定的精确场进行采样，来确定节点自由度 $(w_i, \\theta_{x,i}, \\theta_{y,i})$。节点坐标为 $(0,0), (L,0), (L,H), (0,H)$。精确场为 $w(x,y) = \\alpha x^2$, $\\theta_x(x,y) = 2\\alpha x$, $\\theta_y(x,y) = 0$。采样得到：\n-   $w = [0, \\alpha L^2, \\alpha L^2, 0]^T$\n-   $\\theta_x = [0, 2\\alpha L, 2\\alpha L, 0]^T$\n-   $\\theta_y = [0, 0, 0, 0]^T$\n\n接下来，我们使用双线性形函数 $N_i(\\xi, \\eta)$ 和上述节点值构造插值场 $w_h$, $\\theta_{x,h}$, 和 $\\theta_{y,h}$。\n$$w_h(\\xi, \\eta) = \\sum N_i w_i = \\alpha L^2 (N_2 + N_3) = \\alpha L^2 \\frac{1+\\xi}{2}$$\n$$\\theta_{x,h}(\\xi, \\eta) = \\sum N_i \\theta_{x,i} = 2\\alpha L (N_2 + N_3) = 2\\alpha L \\frac{1+\\xi}{2} = \\alpha L(1+\\xi)$$\n$$\\theta_{y,h}(\\xi, \\eta) = 0$$\n\n然后，我们计算插值位移场 $w_h$ 的梯度。利用从物理坐标 $(x,y)$ 到自然坐标 $(\\xi, \\eta)$ 的映射 $x = L(1+\\xi)/2$ 和 $y = H(1+\\eta)/2$，其雅可比矩阵为对角阵 $\\mathbf{J} = \\mathrm{diag}(L/2, H/2)$。空间导数算子为：\n$$\\frac{\\partial}{\\partial x} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}, \\quad \\frac{\\partial}{\\partial y} = \\frac{2}{H}\\frac{\\partial}{\\partial \\eta}$$\n应用这些算子于 $w_h$：\n$$\\frac{\\partial w_h}{\\partial x} = \\frac{2}{L} \\frac{\\partial}{\\partial \\xi} \\left( \\alpha L^2 \\frac{1+\\xi}{2} \\right) = \\frac{2}{L} \\left( \\frac{\\alpha L^2}{2} \\right) = \\alpha L$$\n$$\\frac{\\partial w_h}{\\partial y} = \\frac{2}{H} \\frac{\\partial}{\\partial \\eta} \\left( \\alpha L^2 \\frac{1+\\xi}{2} \\right) = 0$$\n\n现在，我们根据问题定义计算离散剪切应变 $\\gamma_{xz,h} = \\frac{\\partial w_h}{\\partial x} - \\theta_{x,h}$ 和 $\\gamma_{yz,h} = \\frac{\\partial w_h}{\\partial y} - \\theta_{y,h}$：\n$$\\gamma_{xz,h} = \\alpha L - \\alpha L(1+\\xi) = -\\alpha L \\xi$$\n$$\\gamma_{yz,h} = 0 - 0 = 0$$\n尽管精确场是无剪切的，但离散化过程产生了一个非零的寄生剪切应变场 $\\gamma_{xz,h} = -\\alpha L \\xi$。\n\n最后，我们通过在单元面积上积分来计算剪切能 $U_s$。积分在自然坐标系中进行，其中面积微元为 $d\\Omega = \\det(\\mathbf{J}) d\\xi d\\eta = (LH/4) d\\xi d\\eta$。\n$$U_s = \\frac{1}{2} \\kappa G t \\int_{\\Omega} \\left(\\gamma_{xz,h}^2 + \\gamma_{yz,h}^2\\right) d\\Omega$$\n$$U_s = \\frac{1}{2} \\kappa G t \\int_{-1}^{1}\\int_{-1}^{1} \\left( (-\\alpha L \\xi)^2 + 0^2 \\right) \\frac{LH}{4} d\\xi d\\eta$$\n$$U_s = \\frac{\\kappa G t \\alpha^2 L^3 H}{8} \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2 d\\xi d\\eta$$\n该积分是可分离的，其值为：\n$$\\int_{-1}^{1}\\int_{-1}^{1} \\xi^2 d\\xi d\\eta = \\left( \\int_{-1}^{1} \\xi^2 d\\xi \\right) \\left( \\int_{-1}^{1} d\\eta \\right) = \\left( \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} \\right) \\left( [\\eta]_{-1}^{1} \\right) = \\left( \\frac{2}{3} \\right) (2) = \\frac{4}{3}$$\n将此结果代回能量表达式：\n$$U_s = \\frac{\\kappa G t \\alpha^2 L^3 H}{8} \\left( \\frac{4}{3} \\right) = \\frac{\\kappa G t \\alpha^2 L^3 H}{6}$$\n\n这就是储存在单元中的伪剪切能的最终符号表达式。", "answer": "$$\\boxed{\\frac{\\kappa G t \\alpha^{2} L^{3} H}{6}}$$", "id": "3600168"}, {"introduction": "最后的这项实践将我们的分析扩展到一个完整的二维板问题，以说明剪切自锁在更复杂场景下的行为。通过分析一个采用非常粗糙网格的固支方板，我们将探究单元技术（自锁与非自锁）与离散化之间的相互作用。这个案例展示了一种模型变得过度约束的病态情景，它作为一个警示，提醒我们尽管减缩积分等技术至关重要，但它们并非万能药，必须在理解其局限性的基础上谨慎使用。[@problem_id:3600210]", "problem": "考虑一个方形固支薄板，在空间均匀的横向压力载荷作用下，使用 Reissner–Mindlin 运动学假设进行建模。该方形板的边长为 $a$，厚度为 $t$，杨氏模量为 $E$，泊松比为 $\\nu$。横向挠度场为 $w(x,y)$，法线转角为 $\\theta_x(x,y)$ 和 $\\theta_y(x,y)$。Reissner–Mindlin 板的运动学通过以下公式定义弯曲曲率和横向剪切应变：\n$$\n\\kappa_x = \\frac{\\partial \\theta_x}{\\partial x},\\quad \\kappa_y = \\frac{\\partial \\theta_y}{\\partial y},\\quad \\kappa_{xy} = \\frac{\\partial \\theta_x}{\\partial y} + \\frac{\\partial \\theta_y}{\\partial x},\n$$\n$$\n\\gamma_{xz} = \\frac{\\partial w}{\\partial x} - \\theta_x,\\quad \\gamma_{yz} = \\frac{\\partial w}{\\partial y} - \\theta_y.\n$$\n弯曲本构关系使用板的弯曲刚度\n$$\nD_b = \\frac{E t^3}{12(1-\\nu^2)},\n$$\n其中应力合力矢量 $\\{M_x,M_y,M_{xy}\\}$ 与 $\\{\\kappa_x,\\kappa_y,\\kappa_{xy}\\}$ 的关系如下：\n$$\n\\begin{bmatrix} M_x \\\\ M_y \\\\ M_{xy} \\end{bmatrix}\n=\nD_b\n\\begin{bmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\kappa_x \\\\ \\kappa_y \\\\ \\kappa_{xy}\n\\end{bmatrix}.\n$$\n横向剪切本构关系使用剪切修正因子 $\\kappa$ 和剪切模量 $G=\\dfrac{E}{2(1+\\nu)}$ 来定义：\n$$\n\\begin{bmatrix} Q_x \\\\ Q_y \\end{bmatrix}\n=\n\\kappa\\,G\\,t\\,\n\\begin{bmatrix}\n1  0 \\\\\n0  1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\gamma_{xz} \\\\ \\gamma_{yz}\n\\end{bmatrix}.\n$$\n该板四边固支，意味着在边界上 $w=0$、$\\theta_x=0$ 和 $\\theta_y=0$。该板承受一个均匀的横向载荷 $q$（单位面积上的力），方向向下。\n\n在方形域上使用 $2\\times 2$ 个单元的四节点双线性四边形有限元方法 (FEM) 进行离散化。每个节点具有三个自由度 (DOF)：横向挠度 $w$、转角 $\\theta_x$ 和转角 $\\theta_y$。通过数值积分实现单元刚度，具体如下：\n\n- 对弯曲部分，使用标准的 $2\\times 2$ Gauss 积分。\n- 对剪切部分，实现两种方案：\n  1. 一个“闭锁”单元，对剪切刚度使用完全的 $2\\times 2$ Gauss 积分。\n  2. 一个“非闭锁”单元，在单元中心对剪切刚度使用减缩的 $1\\times 1$ Gauss 积分。\n\n使用 $2\\times 2$ Gauss 积分，组装全局刚度以及与分配到 $w$ 自由度上的均布载荷 $q$ 对应的一致载荷矢量。通过在所有边界节点上强制 $w=\\theta_x=\\theta_y=0$ 来施加固支边界条件。对闭锁和非闭锁剪切积分方案求解线性系统，并提取板几何中心的节点横向挠度。\n\n您的任务是通过评估几组参数集，计算预测的中心挠度对剪切修正因子 $\\kappa$ 的敏感性。使用以下国际单位制的材料和几何参数：\n- $a = 1.0\\,\\mathrm{m}$,\n- $E = 210\\times 10^9\\,\\mathrm{Pa}$,\n- $\\nu = 0.3$,\n- $q = 1000\\,\\mathrm{N/m^2}$.\n\n测试套件包含以下几种情况，每种情况由 $(t,\\kappa)$ 指定：\n1. $(t = 0.01\\,\\mathrm{m},\\ \\kappa = 5/6)$,\n2. $(t = 0.01\\,\\mathrm{m},\\ \\kappa = 1)$,\n3. $(t = 0.001\\,\\mathrm{m},\\ \\kappa = 5/6)$,\n4. $(t = 0.1\\,\\mathrm{m},\\ \\kappa = 5/6)$.\n\n对于每种情况，使用闭锁和非闭锁剪切积分方案计算中心挠度。将每个挠度以 $\\mathrm{m}$ 为单位表示为浮点数。您的程序应产生单行输出，其中包含一个用方括号括起来的、由逗号分隔的八个数字列表，顺序如下：\n$$\n[\\ w_{\\text{locked},1},\\ w_{\\text{unlocked},1},\\ w_{\\text{locked},2},\\ w_{\\text{unlocked},2},\\ w_{\\text{locked},3},\\ w_{\\text{unlocked},3},\\ w_{\\text{locked},4},\\ w_{\\text{unlocked},4}\\ ],\n$$\n其中 $w_{\\text{locked},i}$ 和 $w_{\\text{unlocked},i}$ 分别是使用闭锁和非闭锁单元为测试用例 $i$ 计算出的中心挠度。以 $\\mathrm{m}$ 为单位，使用默认浮点格式作答。", "solution": "此问题要求使用一个由四个方形双线性单元组成的 $2 \\times 2$ 网格，计算一个固支方板在均布载荷下的中心挠度。由于问题的高度对称性（几何、载荷、网格和边界条件），我们可以极大地简化分析。\n\n所有边界节点（共8个）的自由度都被约束为零。唯一具有非零自由度的节点是位于板几何中心的节点5。由于对称性，中心节点的转角自由度 $\\theta_{x5}$ 和 $\\theta_{y5}$ 必然为零。因此，整个问题简化为求解中心节点挠度 $w_5$ 的单个方程：$K_{w_5 w_5} w_5 = F_{w_5}$。\n\n刚度项 $K_{w_5 w_5}$ 和力项 $F_{w_5}$ 是汇集于中心节点5的四个单元贡献的总和。由于弯曲刚度仅与转角自由度相关，因此对角刚度项 $K_{w_5 w_5}$ 完全由剪切刚度决定。\n\n对于每个单元，其对角剪切刚度项 $K^e_{s, w_i w_i}$（与局部节点 $i$ 的 $w$ 自由度相关）可以解析计算。对于“闭锁”情况（完全 $2 \\times 2$ 积分），该项为 $K^e_{s, w_i w_i, \\text{locked}} = \\frac{2}{3} \\kappa G t$。对于“非闭锁”情况（减缩 $1 \\times 1$ 积分），该项为 $K^e_{s, w_i w_i, \\text{unlocked}} = \\frac{1}{2} \\kappa G t$。\n\n中心节点5是四个单元中每一个的角节点。因此，全局刚度项 $K_{w_5 w_5}$ 是四个单元相应对角项的总和：\n$$\nK_{w_5 w_5, \\text{locked}} = 4 \\times \\left(\\frac{2}{3} \\kappa G t\\right) = \\frac{8}{3} \\kappa G t\n$$\n$$\nK_{w_5 w_5, \\text{unlocked}} = 4 \\times \\left(\\frac{1}{2} \\kappa G t\\right) = 2 \\kappa G t\n$$\n\n作用在中心节点5上的一致载荷 $F_{w_5}$ 也是由四个单元贡献的总和。每个单元对中心节点的贡献是 $q A_e / 4$，其中 $A_e = (a/2)^2 = a^2/4$ 是单元面积。因此，总力为：\n$$\nF_{w_5} = 4 \\times \\left(q \\frac{a^2/4}{4}\\right) = \\frac{q a^2}{4}\n$$\n\n现在我们可以求解中心挠度：\n$$\nw_{\\text{locked}} = \\frac{F_{w_5}}{K_{w_5 w_5, \\text{locked}}} = \\frac{q a^2 / 4}{(8/3) \\kappa G t} = \\frac{3 q a^2}{32 \\kappa G t} = \\frac{3 q a^2 (1+\\nu)}{16 \\kappa E t}\n$$\n$$\nw_{\\text{unlocked}} = \\frac{F_{w_5}}{K_{w_5 w_5, \\text{unlocked}}} = \\frac{q a^2 / 4}{2 \\kappa G t} = \\frac{q a^2}{8 \\kappa G t} = \\frac{q a^2 (1+\\nu)}{4 \\kappa E t}\n$$\n这些公式表明，对于这个特定的粗糙网格，挠度与 $1/t$ 成正比，这与剪切变形行为一致，而不是薄板弯曲所预期的 $1/t^3$ 依赖关系。这揭示了一个病态的、完全被剪切锁死的模型，即使使用减缩积分也无法缓解。该计算的目标正是演示这一病态行为。\n\n通过将给定的参数代入这些公式，我们可以计算出每个测试用例的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the center deflection of a clamped square plate under uniform pressure\n    using a 2x2 mesh of 4-node Reissner-Mindlin plate elements.\n\n    The solution leverages the symmetry of the problem. For the specified 2x2 grid\n    with clamped boundary conditions, only the central node has non-zero degrees\n    of freedom. Due to the complete symmetry of the geometry, loading, and mesh,\n    the 3x3 stiffness sub-matrix for the central node's DOFs (w, theta_x, theta_y)\n    is diagonal. This uncouples the equations.\n\n    The deflection 'w' is then given by w = F_w / K_ww, where F_w is the nodal\n    force and K_ww is the corresponding stiffness. A key finding is that the\n    bending stiffness does not contribute to K_ww, which comes purely from the\n    shear stiffness. Analytical calculation of K_ww for the central node (summing\n    contributions from 4 elements) and the central nodal force F_w leads to\n    simplified analytical formulas for the deflection, which are used below. This\n    demonstrates a pathological case of shear locking.\n    \"\"\"\n\n    # Define the problem parameters in SI units.\n    a = 1.0  # m\n    E = 210e9  # Pa\n    nu = 0.3  # Poisson's ratio\n    q = 1000.0  # N/m^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, kappa).\n    test_cases = [\n        (0.01, 5.0/6.0),\n        (0.01, 1.0),\n        (0.001, 5.0/6.0),\n        (0.1, 5.0/6.0),\n    ]\n\n    results = []\n    for t, kappa in test_cases:\n        # Based on the analytical derivation for this specific problem setup:\n        #\n        # w_locked = (3 * q * a**2 * (1 + nu)) / (16 * kappa * E * t)\n        # w_unlocked = (q * a**2 * (1 + nu)) / (4 * kappa * E * t)\n        #\n        # Pre-calculating the common parts of the formulas for efficiency and clarity.\n        \n        # Constant part for the \"locked\" (full 2x2 integration) formula.\n        c_locked_numerator = 3.0 * q * a**2 * (1.0 + nu)\n        c_locked_denominator = 16.0 * E\n        c_locked = c_locked_numerator / c_locked_denominator\n        \n        # Constant part for the \"unlocked\" (reduced 1x1 integration) formula.\n        c_unlocked_numerator = q * a**2 * (1.0 + nu)\n        c_unlocked_denominator = 4.0 * E\n        c_unlocked = c_unlocked_numerator / c_unlocked_denominator\n\n        # Calculate deflections for the current test case\n        # w = C / (kappa * t)\n        \n        denominator = kappa * t\n        \n        w_locked = c_locked / denominator\n        w_unlocked = c_unlocked / denominator\n        \n        results.append(w_locked)\n        results.append(w_unlocked)\n\n    # Final print statement in the exact required format.\n    # The output format is a single line: [w_locked_1,w_unlocked_1,w_locked_2,...]\n    # Using np.float64 to ensure standard floating-point representation.\n    print(f\"[{','.join(map(str, [np.float64(x) for x in results]))}]\")\n\nsolve()\n```", "id": "3600210"}]}