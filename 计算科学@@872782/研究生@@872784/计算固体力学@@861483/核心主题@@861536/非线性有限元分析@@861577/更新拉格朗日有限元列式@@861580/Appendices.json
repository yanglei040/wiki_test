{"hands_on_practices": [{"introduction": "这第一个练习聚焦于更新拉格朗日（UL）公式的运动学核心。通过手动计算一个简单单元的更新后变形梯度，你将对乘法更新法则 $F_{n+1} = f F_n$ 如何在实践中应用获得具体理解。这项基本技能是构建完整非线性有限元分析的第一步。[@problem_id:3608832]", "problem": "在用于大变形的更新拉格朗日 (UL) 有限元列式中，时间步 $n$ 的当前构型被作为从时间步 $n$ 到 $n+1$ 的增量更新的参考构型。考虑一个四节点线性四面体单元，其在时间步 $n$ （当前构型）的节点坐标由下式给出\n$$\n\\mathbf{x}_{1}^{(n)} = (0,\\,0,\\,0),\\quad\n\\mathbf{x}_{2}^{(n)} = (1,\\,0,\\,0),\\quad\n\\mathbf{x}_{3}^{(n)} = (0,\\,1,\\,0),\\quad\n\\mathbf{x}_{4}^{(n)} = (0,\\,0,\\,1).\n$$\n在同一步，从 $n$ 到 $n+1$ 的节点增量位移为\n$$\n\\Delta \\mathbf{u}_{1} = (0,\\,0,\\,0),\\quad\n\\Delta \\mathbf{u}_{2} = (1,\\,2,\\,-1),\\quad\n\\Delta \\mathbf{u}_{3} = (0,\\,1,\\,1),\\quad\n\\Delta \\mathbf{u}_{4} = (-2,\\,0,\\,3).\n$$\n假设在时间步 $n$ 的当前构型上定义了标准的 $C^{0}$ 线性形函数，并假设该单元在运动学上是均匀的，因此用这些形函数计算时，增量变形梯度在整个单元上是恒定的。在时间步 $n$ 的变形梯度（在单元内视为常数）为\n$$\n\\mathbf{F}_{n} = \n\\begin{pmatrix}\n2  0  0\\\\\n0  1  0\\\\\n0  0  \\tfrac{1}{2}\n\\end{pmatrix}.\n$$\n从更新拉格朗日描述中增量映射的运动学定义出发，构建单元增量变形梯度 $\\mathbf{f}$，并使用乘法更新计算单元形心处的更新变形梯度 $\\mathbf{F}_{n+1}$。将所有量视为无量纲。请将您的最终答案以单个 $3\\times 3$ 矩阵 $\\mathbf{F}_{n+1}$ 的形式给出。无需四舍五入。", "solution": "在更新拉格朗日（UL）列式中，时间步 $n+1$ 的总变形梯度 $\\mathbf{F}_{n+1}$ 通过增量变形梯度 $\\mathbf{f}$ 与时间步 $n$ 的变形梯度 $\\mathbf{F}_{n}$ 以乘法形式相关联：\n$$ \\mathbf{F}_{n+1} = \\mathbf{f} \\mathbf{F}_{n} $$\n增量变形梯度 $\\mathbf{f}$ 将向量从时间步 $n$ 的构型映射到时间步 $n+1$ 的构型，其定义为 $\\mathbf{f} = \\mathbf{I} + \\nabla_n(\\Delta\\mathbf{u})$，其中 $\\mathbf{I}$ 是单位张量，$\\nabla_n(\\Delta\\mathbf{u})$ 是增量位移场相对于当前构型坐标的空间梯度。\n\n对于有限元，增量位移场的梯度由下式给出：\n$$ \\nabla_n(\\Delta\\mathbf{u}) = \\sum_{I=1}^{4} \\Delta\\mathbf{u}_I (\\nabla_n N_I)^T $$\n其中 $N_I$ 是节点 $I$ 的形函数，$\\Delta\\mathbf{u}_I$ 是节点增量位移。\n\n**1. 计算形函数梯度**\n由于单元在当前构型中的节点坐标定义了一个主单元，形函数即为重心坐标。设 $\\mathbf{x} = (x, y, z)$ 是当前构型中的坐标，形函数为：\n$$ N_1(x,y,z) = 1 - x - y - z, \\quad N_2(x,y,z) = x, \\quad N_3(x,y,z) = y, \\quad N_4(x,y,z) = z $$\n这些形函数相对于 $\\mathbf{x}$ 的梯度为常向量：\n$$ \\nabla_n N_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla_n N_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\nabla_n N_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla_n N_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n\n**2. 计算增量位移梯度**\n使用给定的节点增量位移 $\\Delta\\mathbf{u}_I$，我们计算 $\\nabla_n(\\Delta\\mathbf{u})$。由于 $\\Delta\\mathbf{u}_1 = \\mathbf{0}$，第一项为零。\n$$\n\\nabla_n(\\Delta\\mathbf{u}) = \\Delta\\mathbf{u}_2 (\\nabla_n N_2)^T + \\Delta\\mathbf{u}_3 (\\nabla_n N_3)^T + \\Delta\\mathbf{u}_4 (\\nabla_n N_4)^T\n$$\n$$\n=\n\\begin{pmatrix} 1 \\\\ 2 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\end{pmatrix} +\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\end{pmatrix} +\n\\begin{pmatrix} -2 \\\\ 0 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\end{pmatrix}\n$$\n$$\n=\n\\begin{pmatrix} 1  0  0 \\\\ 2  0  0 \\\\ -1  0  0 \\end{pmatrix} +\n\\begin{pmatrix} 0  0  0 \\\\ 0  1  0 \\\\ 0  1  0 \\end{pmatrix} +\n\\begin{pmatrix} 0  0  -2 \\\\ 0  0  0 \\\\ 0  0  3 \\end{pmatrix}\n=\n\\begin{pmatrix}\n1  0  -2 \\\\\n2  1  0 \\\\\n-1  1  3\n\\end{pmatrix}\n$$\n\n**3. 计算增量变形梯度**\n$$\n\\mathbf{f} = \\mathbf{I} + \\nabla_n(\\Delta\\mathbf{u}) =\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} +\n\\begin{pmatrix} 1  0  -2 \\\\ 2  1  0 \\\\ -1  1  3 \\end{pmatrix} =\n\\begin{pmatrix} 2  0  -2 \\\\ 2  2  0 \\\\ -1  1  4 \\end{pmatrix}\n$$\n\n**4. 执行乘法更新**\n最后，我们使用乘法更新法则计算 $\\mathbf{F}_{n+1}$：\n$$\n\\mathbf{F}_{n+1} = \\mathbf{f} \\mathbf{F}_{n} =\n\\begin{pmatrix} 2  0  -2 \\\\ 2  2  0 \\\\ -1  1  4 \\end{pmatrix}\n\\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}\n$$\n进行矩阵乘法：\n$$\n\\mathbf{F}_{n+1} =\n\\begin{pmatrix}\n(2)(2) + (0)(0) + (-2)(0)  (2)(0) + (0)(1) + (-2)(0)  (2)(0) + (0)(0) + (-2)(\\frac{1}{2}) \\\\\n(2)(2) + (2)(0) + (0)(0)  (2)(0) + (2)(1) + (0)(0)  (2)(0) + (2)(0) + (0)(\\frac{1}{2}) \\\\\n(-1)(2) + (1)(0) + (4)(0)  (-1)(0) + (1)(1) + (4)(0)  (-1)(0) + (1)(0) + (4)(\\frac{1}{2})\n\\end{pmatrix}\n$$\n$$\n\\mathbf{F}_{n+1} =\n\\begin{pmatrix}\n4  0  -1 \\\\\n4  2  0 \\\\\n-2  1  2\n\\end{pmatrix}\n$$\n这就是在时间步 $n+1$ 的更新变形梯度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  0  -1 \\\\\n4  2  0 \\\\\n-2  1  2\n\\end{pmatrix}\n}\n$$", "id": "3608832"}, {"introduction": "在运动学的基础上，本练习通过计算单元内部的内力，建立了运动学与动力学之间的桥梁。你将在当前构型下应用虚功原理，组装空间应变-位移矩阵（$B$ 矩阵），并计算内力向量，这是求解系统平衡方程的关键组成部分。本练习展示了连续介质层面的应力状态如何在有限元背景下被离散为节点力。[@problem_id:3608915]", "problem": "考虑一个三维八节点三线性六面体单元在其当前构型下的更新拉格朗日有限元列式。设当前节点坐标构成一个轴对齐的长方体，边长分别为 $L_x = 0.6$ m、$L_y = 0.4$ m 和 $L_z = 0.2$ m，节点位于角点 $(0,0,0)$、$(L_x,0,0)$、$(L_x,L_y,0)$、$(0,L_y,0)$、$(0,0,L_z)$、$(L_x,0,L_z)$、$(L_x,L_y,L_z)$、$(0,L_y,L_z)$。使用从坐标为 $(\\xi,\\eta,\\zeta)\\in[-1,1]^3$ 的母域到当前构型的标准等参映射以及三线性形函数\n$$\nN_i(\\xi,\\eta,\\zeta) = \\frac{1}{8}\\left(1+\\xi\\,\\xi_i\\right)\\left(1+\\eta\\,\\eta_i\\right)\\left(1+\\zeta\\,\\zeta_i\\right),\n$$\n其中 $(\\xi_i,\\eta_i,\\zeta_i)\\in\\{-1,1\\}^3$ 是节点 $i$ 在母空间中的坐标。在空间（当前）构型中进行计算，并使用柯西应力张量计算内虚功。\n\n从当前构型中的虚功率平衡出发，即内虚功为\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_t} \\boldsymbol{\\sigma} : \\operatorname{sym}(\\nabla_x \\delta \\boldsymbol{v}) \\,\\mathrm{d}v,\n$$\n通过使用空间梯度 $\\nabla_x N_i$ 组装空间应变-位移矩阵 $B$，推导单个高斯点处的有限元内力贡献。采用包含工程剪切分量的 Voigt 映射，使得应变率向量为 $[d_{xx},\\, d_{yy},\\, d_{zz},\\, 2d_{xy},\\, 2d_{yz},\\, 2d_{zx}]^{\\mathsf{T}}$，柯西应力向量为 $[\\sigma_{xx},\\, \\sigma_{yy},\\, \\sigma_{zz},\\, \\sigma_{xy},\\, \\sigma_{yz},\\, \\sigma_{zx}]^{\\mathsf{T}}$。\n\n假设当前构型中存在均匀的柯西应力，其值（单位为兆帕）由下式给出\n$$\n\\boldsymbol{\\sigma} = \n\\begin{pmatrix}\n120  30  -50 \\\\\n30  90  -20 \\\\\n-50  -20  60\n\\end{pmatrix}\n\\text{ MPa}.\n$$\n使用 $2\\times 2\\times 2$ 高斯求积法则，积分点位于 $(\\xi,\\eta,\\zeta) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$，每个点的权重为 $1$。重点关注位于 $(\\xi,\\eta,\\zeta) = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$ 的高斯点。采用标准的八节点排序，其中节点 $1$ 在母域中的位置为 $(\\xi_1,\\eta_1,\\zeta_1) = (-1,-1,-1)$。请在该高斯点组装空间 $B$ 矩阵，并计算此单个高斯点对节点 $1$ 的内部节点力 $x$ 分量的标量贡献。\n\n以牛顿为单位表示您的最终答案，并将答案四舍五入到四位有效数字。请勿在最终的方框答案中包含单位。", "solution": "该问题要求基于更新拉格朗日列式，计算有限元内部节点力向量的一个特定分量。出发点是虚功原理，其中内力向量由下式给出：\n$$\n\\boldsymbol{f}_{\\text{int}} = \\int_{\\Omega_t} \\boldsymbol{B}^{\\mathsf{T}} \\boldsymbol{\\sigma} \\,\\mathrm{d}v\n$$\n其中 $\\Omega_t$ 是物体的当前体积，$\\boldsymbol{\\sigma}$ 是柯西应力向量，$\\boldsymbol{B}$ 是空间应变-位移矩阵。该积分使用高斯求积进行数值近似：\n$$\n\\boldsymbol{f}_{\\text{int}} \\approx \\sum_{gp} (\\boldsymbol{B}^{\\mathsf{T}} \\boldsymbol{\\sigma} \\det(\\boldsymbol{J}) w)_{gp}\n$$\n其中 $\\boldsymbol{J}$ 是等参映射的雅可比矩阵，$w$ 是高斯权重。我们关注单个高斯点对节点1的 $x$ 方向力的贡献。节点 $I$ 处内力的 $x$ 分量 $(f_{\\text{int}, I})_x$ 来自 $\\boldsymbol{B}_I^{\\mathsf{T}}$ 的第一行与应力向量的点积，其在该高斯点的贡献为：\n$$\n(f_{\\text{int}, I, gp})_x = \\left( \\frac{\\partial N_I}{\\partial x} \\sigma_{xx} + \\frac{\\partial N_I}{\\partial y} \\sigma_{xy} + \\frac{\\partial N_I}{\\partial z} \\sigma_{zx} \\right)_{gp} \\det(\\boldsymbol{J})_{gp} w_{gp}\n$$\n\n**1. 计算雅可比矩阵和其行列式**\n从母坐标 $\\boldsymbol{\\xi} \\in [-1,1]^3$ 到空间坐标 $\\boldsymbol{x} \\in [0,L_x]\\times[0,L_y]\\times[0,L_z]$ 的映射为 $x = \\frac{L_x}{2}(1+\\xi)$, $y = \\frac{L_y}{2}(1+\\eta)$, $z = \\frac{L_z}{2}(1+\\zeta)$。雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{\\xi}}$ 是一个常数对角阵：\n$$\n\\boldsymbol{J} = \\begin{pmatrix} L_x/2  0  0 \\\\ 0  L_y/2  0 \\\\ 0  0  L_z/2 \\end{pmatrix}\n$$\n其行列式为 $\\det(\\boldsymbol{J}) = \\frac{L_x L_y L_z}{8} = \\frac{(0.6)(0.4)(0.2)}{8} = 0.006 \\, \\text{m}^3$。\n\n**2. 计算形函数梯度**\n节点 1 的母坐标为 $(\\xi_1, \\eta_1, \\zeta_1) = (-1,-1,-1)$，其形函数为 $N_1 = \\frac{1}{8}(1-\\xi)(1-\\eta)(1-\\zeta)$。在目标高斯点 $(\\xi, \\eta, \\zeta)_{gp} = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$ 处，其关于母坐标的梯度分量是相同的：\n$$\n\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{gp} = \\frac{\\partial N_1}{\\partial \\eta}\\Big|_{gp} = \\frac{\\partial N_1}{\\partial \\zeta}\\Big|_{gp} = -\\frac{1}{8}\\left(1-\\frac{1}{\\sqrt{3}}\\right)^2 = -\\frac{1}{8} \\frac{(\\sqrt{3}-1)^2}{3} = -\\frac{4-2\\sqrt{3}}{24} = -\\frac{2-\\sqrt{3}}{12}\n$$\n使用链式法则 $\\nabla_x N_1 = \\boldsymbol{J}^{-T} \\nabla_{\\xi} N_1$（由于 $\\boldsymbol{J}$ 是对角阵，$\\boldsymbol{J}^{-T}=\\boldsymbol{J}^{-1}$），我们得到空间梯度：\n$$\n\\frac{\\partial N_1}{\\partial x}\\Big|_{gp} = \\frac{2}{L_x} \\left(-\\frac{2-\\sqrt{3}}{12}\\right) = -\\frac{2-\\sqrt{3}}{6L_x}\n$$\n$$\n\\frac{\\partial N_1}{\\partial y}\\Big|_{gp} = -\\frac{2-\\sqrt{3}}{6L_y}, \\quad \\frac{\\partial N_1}{\\partial z}\\Big|_{gp} = -\\frac{2-\\sqrt{3}}{6L_z}\n$$\n\n**3. 计算力的分量**\n将所有值代入力表达式中。高斯权重 $w$ 为 $1$。应力以 MPa ($10^6$ N/m$^2$)给出。\n$$\n(f_{\\text{int}, 1})_x = \\left[ \\left(-\\frac{2-\\sqrt{3}}{6L_x}\\right)\\sigma_{xx} + \\left(-\\frac{2-\\sqrt{3}}{6L_y}\\right)\\sigma_{xy} + \\left(-\\frac{2-\\sqrt{3}}{6L_z}\\right)\\sigma_{zx} \\right] \\det(\\boldsymbol{J}) \\cdot w\n$$\n$$\n(f_{\\text{int}, 1})_x = -\\frac{2-\\sqrt{3}}{6} \\left( \\frac{\\sigma_{xx}}{L_x} + \\frac{\\sigma_{xy}}{L_y} + \\frac{\\sigma_{zx}}{L_z} \\right) \\det(\\boldsymbol{J})\n$$\n代入数值：\n$$\n\\frac{\\sigma_{xx}}{L_x} + \\frac{\\sigma_{xy}}{L_y} + \\frac{\\sigma_{zx}}{L_z} = \\left( \\frac{120}{0.6} + \\frac{30}{0.4} - \\frac{50}{0.2} \\right) \\times 10^6 = (200 + 75 - 250) \\times 10^6 = 25 \\times 10^6 \\, \\frac{\\text{N}}{\\text{m}^3}\n$$\n$$\n(f_{\\text{int}, 1})_x = -\\frac{2-\\sqrt{3}}{6} (25 \\times 10^6 \\, \\frac{\\text{N}}{\\text{m}^3}) (0.006 \\, \\text{m}^3) = -\\frac{2-\\sqrt{3}}{6} (150000) \\, \\text{N}\n$$\n$$\n(f_{\\text{int}, 1})_x = -(2-\\sqrt{3}) \\times 25000 \\, \\text{N} \\approx -6698.73 \\, \\text{N}\n$$\n四舍五入到四位有效数字，结果为 $-6699$ N。", "answer": "$$\n\\boxed{-6699}\n$$", "id": "3608915"}, {"introduction": "这最后一个练习深入探讨了材料坐标系无关性（客观性）这一关键原则及其在计算环境中的实现。通过一个编程练习，你将研究一个客观的本构律在刚体旋转下的行为，更重要的是，一个运动学上不正确的数值更新方案会如何违反这一物理原则，从而导致错误的结果。这项任务突显了物理理论与数值算法设计在计算力学中微妙而关键的相互作用。[@problem_id:3608929]", "problem": "考虑计算固体力学中的材料框架无关性原理及其对更新拉格朗日（UL）有限元格式的影响。材料框架无关性要求储存能量密度不受叠加刚体运动的影响。形式上，对于任何满足 $Q^{\\top}Q = I$ 和 $\\det(Q) = 1$ 的纯旋转矩阵 $Q$，能量密度 $W(F)$ 必须满足 $W(QF) = W(F)$。特别地，对于一个纯刚体旋转 $F = R(\\theta)$，其中 $R(\\theta)$ 是一个旋转角度为 $\\theta$ 弧度的旋转，$W(R(\\theta))$ 必须等于 $W(I)$。\n\n从第一性原理出发，使用以下基本事实和定义：\n- 变形梯度为 $F = \\nabla \\varphi$，其中 $\\varphi$ 是运动。\n- 客观性（材料框架无关性）要求 $W(F)$ 仅是右柯西-格林张量 $C = F^{\\top}F$ 的函数。\n- 在更新拉格朗日（UL）格式中，增量变形作用于当前构型；变形梯度在增量上的正确运动学更新必须在映射复合的意义上是乘法的。\n\n为了测试的具体性和普适性，我们在平面应变条件下工作，空间维度 $d = 2$，使用无量纲单位，并取材料参数 $\\mu = 1$ 和 $\\lambda = 1$（因此所有计算出的能量都是无量纲数）。实现以下能量密度函数：\n- 一个在 $d = 2$ 中定义的客观可压缩 neo-Hookean 能量\n$$W_{\\mathrm{NH}}(F) = \\frac{\\mu}{2}\\left(I_1 - d\\right) - \\mu \\ln J + \\frac{\\lambda}{2}\\left(\\ln J\\right)^2,$$\n其中 $C = F^{\\top}F$，$I_1 = \\mathrm{tr}(C)$，$J = \\det(F)$，且 $d = 2$，$\\mu = 1$，$\\lambda = 1$。根据客观性，对于任何刚体旋转 $R(\\theta)$，$W_{\\mathrm{NH}}(R(\\theta)) = W_{\\mathrm{NH}}(I)$，并且由于对于 $F = R(\\theta)$ 有 $I_1 = d$ 和 $J = 1$，因此可得 $W_{\\mathrm{NH}}(R(\\theta)) = 0$。\n- 一个故意设计的非客观能量（以在能量层面揭示违反材料框架无关性的情况），定义为\n$$W_{\\mathrm{non}}(F) = \\alpha\\,F_{12},$$\n其中 $\\alpha = 1$，它依赖于 $F$ 的单个分量，因此不满足客观性。对于旋转 $R(\\theta)$，$W_{\\mathrm{non}}(R(\\theta))$ 会随 $\\theta$ 变化。\n\n设计数值测试，以：\n- 验证刚体旋转 $F = R(\\theta)$ 使客观能量保持不变。\n- 当 UL 离散化使用在增量上对 $F$ 的不正确加法更新时，检测框架无关性的数值违反，即\n$$F_{\\mathrm{add}} = I + \\sum_{k=1}^{n}\\left(R(\\Delta \\theta) - I\\right),$$\n其中 $n$ 是增量数，$\\Delta \\theta = \\theta/n$，$R(\\Delta \\theta)$ 是每一步的增量旋转。这种加法更新对于大旋转在运动学上是不正确的，并且通常无法在离散层面保持客观性，而正确的乘法复合将产生 $F = \\prod_{k=1}^{n} R(\\Delta\\theta) = R(\\theta)$。\n\n你的程序必须：\n- 实现 $d = 2$ 的旋转矩阵\n$$R(\\theta) = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta\\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix}.$$\n- 实现如上定义的 $W_{\\mathrm{NH}}(F)$ 和 $W_{\\mathrm{non}}(F)$。\n- 对于每个测试用例，计算精确的刚体旋转 $F_{\\mathrm{exact}} = R(\\theta)$ 和如上所述的有缺陷的 UL 加法更新 $F_{\\mathrm{add}}$，然后评估能量 $W_{\\mathrm{NH}}(F_{\\mathrm{exact}})$ 和 $W_{\\mathrm{NH}}(F_{\\mathrm{add}})$ 并报告绝对能量偏差\n$$e_{\\mathrm{dev}} = \\left|W_{\\mathrm{NH}}(F_{\\mathrm{add}}) - W_{\\mathrm{NH}}(F_{\\mathrm{exact}})\\right|.$$\n- 使用容差 $\\varepsilon = 10^{-12}$ 生成一个用于违规检测的布尔标志：\n$$\\mathrm{flag} = \\left(e_{\\mathrm{dev}}  \\varepsilon\\right).$$\n- 此外，为指定的角度计算 $W_{\\mathrm{non}}(R(\\theta))$，以量化能量层面上的非客观行为。\n\n角度规格必须以弧度为单位。所有能量都是无量纲数；直接以浮点数形式报告，不带单位。\n\n测试套件：\n- UL 离散化测试（每个测试由总旋转角 $\\theta$ 和增量数 $n$ 指定）：\n  1. $\\theta = \\pi/6$, $n = 5$。\n  2. $\\theta = 0$, $n = 5$。\n  3. $\\theta = \\pi$, $n = 10$。\n  4. $\\theta = \\pi/2$, $n = 100$。\n- 非客观能量测试（仅报告能量值 $W_{\\mathrm{non}}(R(\\theta))$）：\n  5. $\\theta = 0$。\n  6. $\\theta = \\pi/4$。\n  7. $\\theta = \\pi/2$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含：\n- 对于测试用例 $1$–$4$：每个用例的浮点数 $e_{\\mathrm{dev}}$ 后跟布尔值 $\\mathrm{flag}$，共计 $8$ 个条目。\n- 对于测试用例 $5$–$7$：$W_{\\mathrm{non}}(R(\\theta))$ 的浮点数值，共计 $3$ 个条目。\n\n因此，输出必须是包含 $11$ 个条目的单个列表：\n$$\\left[e_{\\mathrm{dev}}^{(1)},\\mathrm{flag}^{(1)},e_{\\mathrm{dev}}^{(2)},\\mathrm{flag}^{(2)},e_{\\mathrm{dev}}^{(3)},\\mathrm{flag}^{(3)},e_{\\mathrm{dev}}^{(4)},\\mathrm{flag}^{(4)},W_{\\mathrm{non}}^{(5)},W_{\\mathrm{non}}^{(6)},W_{\\mathrm{non}}^{(7)}\\right].$$", "solution": "核心物理原理是能量层面上的材料框架无关性（客观性）。从变形梯度 $F = \\nabla \\varphi$ 的定义出发，叠加一个刚体旋转 $Q$ 会将运动变换为 $\\tilde{\\varphi} = Q \\varphi$，从而将变形梯度变换为 $\\tilde{F} = Q F$。材料框架无关性要求对于任何满足 $Q^{\\top}Q = I$ 和 $\\det(Q) = 1$ 的纯旋转矩阵 $Q$，$W(QF) = W(F)$。由于 $C = F^{\\top}F$ 在叠加刚体旋转下是不变的，因此 $C$ 是任何客观能量密度的合适自变量。特别是，如果 $F = R(\\theta)$ 是一个纯旋转，满足 $R(\\theta)^{\\top}R(\\theta) = I$ 和 $\\det(R(\\theta)) = 1$，那么 $C = I$，并且任何在参考状态下为零的客观能量函数都必须满足 $W(R(\\theta)) = W(I)$。\n\n我们选择在 $d=2$ 中的可压缩 neo-Hookean 能量，\n$$W_{\\mathrm{NH}}(F) = \\frac{\\mu}{2}\\left(I_1 - d\\right) - \\mu \\ln J + \\frac{\\lambda}{2}\\left(\\ln J\\right)^2,$$\n其中 $I_1 = \\mathrm{tr}(F^{\\top}F)$，$J = \\det(F)$，$\\mu = 1$，$\\lambda = 1$ 且 $d = 2$。对于刚体旋转 $F = R(\\theta)$，我们有 $I_1 = \\mathrm{tr}(I) = d = 2$ 和 $J = 1$，所以\n$$W_{\\mathrm{NH}}(R(\\theta)) = \\frac{1}{2}\\left(2 - 2\\right) - 1\\cdot \\ln(1) + \\frac{1}{2}\\left(\\ln(1)\\right)^2 = 0.$$\n这证实了客观模型在刚体旋转下的能量不变性。\n\n为了在能量层面揭示非客观性，我们定义了一个故意设计的非客观能量，\n$$W_{\\mathrm{non}}(F) = \\alpha\\,F_{12},$$\n其中 $\\alpha = 1$。因为它依赖于 $F$ 的单个分量而不是 $C = F^{\\top}F$，所以它违反了客观性。对于 $d=2$ 中的 $F = R(\\theta)$，\n$$R(\\theta) = \\begin{bmatrix}\\cos\\theta  -\\sin\\theta\\\\ \\sin\\theta  \\cos\\theta\\end{bmatrix},$$\n我们有 $F_{12} = -\\sin\\theta$，所以 $W_{\\mathrm{non}}(R(\\theta)) = -\\sin\\theta$，它随 $\\theta$ 变化且不是常数。\n\n在更新拉格朗日（UL）格式中，增量运动从当前构型开始应用，变形梯度在增量间的正确更新必须是乘法形式的，以表示映射的复合。具体来说，设总旋转被分解为 $n$ 个角度为 $\\Delta \\theta = \\theta/n$ 的相等增量，每个增量旋转为 $R(\\Delta \\theta)$。$n$ 个增量后正确的累积变形梯度是乘积\n$$F_{\\mathrm{exact}} = \\prod_{k=1}^{n} R(\\Delta\\theta) = R(\\theta).$$\n相反，形式为\n$$F_{\\mathrm{add}} = I + \\sum_{k=1}^{n}\\left(R(\\Delta \\theta) - I\\right) = I + n\\left(R(\\Delta \\theta) - I\\right)$$\n的有缺陷的加法更新不代表映射的复合，并且会累积与 $n$ 成比例的误差。这种加法更新忽略了对旋转至关重要的高阶项，因此即使在本构能量函数是客观的情况下，也会在离散算法中破坏客观性。\n\n检测策略：\n- 计算 $F_{\\mathrm{exact}} = R(\\theta)$，评估 $W_{\\mathrm{NH}}(F_{\\mathrm{exact}})$，由于客观性，其值应为 $0$。\n- 通过上述加法更新计算有缺陷的 $F_{\\mathrm{add}}$，评估 $W_{\\mathrm{NH}}(F_{\\mathrm{add}})$，并构成偏差\n$$e_{\\mathrm{dev}} = \\left|W_{\\mathrm{NH}}(F_{\\mathrm{add}}) - W_{\\mathrm{NH}}(F_{\\mathrm{exact}})\\right|.$$\n- 如果 $e_{\\mathrm{dev}}  \\varepsilon$ (其中 $\\varepsilon = 10^{-12}$)，则宣布违规。\n\n算法设计：\n1. 如图所示，使用 $\\cos\\theta$ 和 $\\sin\\theta$ 在 $d=2$ 中实现 $R(\\theta)$。\n2. 实现 $W_{\\mathrm{NH}}(F)$：\n   - 计算 $J = \\det(F)$。\n   - 计算 $C = F^{\\top}F$ 和 $I_1 = \\mathrm{tr}(C)$。\n   - 使用 $\\mu = 1$, $\\lambda = 1$, $d = 2$ 返回 $W_{\\mathrm{NH}}(F)$。\n3. 将 $W_{\\mathrm{non}}(F)$ 实现为 $F_{12}$。\n4. 对于每个 UL 测试用例，计算：\n   - $F_{\\mathrm{exact}} = R(\\theta)$。\n   - $F_{\\mathrm{add}} = I + n\\left(R(\\Delta\\theta) - I\\right)$，其中 $\\Delta\\theta = \\theta/n$。\n   - 使用 $\\varepsilon = 10^{-12}$ 计算 $e_{\\mathrm{dev}}$ 和 $\\mathrm{flag}$。\n5. 对于每个非客观测试用例，计算 $W_{\\mathrm{non}}(R(\\theta))$。\n6. 将结果聚合成所需的单行列表。\n\n测试套件原理：\n- 用例 1（$\\theta = \\pi/6$, $n = 5$）是一个通过数次增量累积的中等旋转，暴露了加法更新中的缺陷。\n- 用例 2（$\\theta = 0$, $n = 5$）是一个边界情况，其中精确更新和加法更新都平凡地得到 $F = I$，因此不应发生违规。\n- 用例 3（$\\theta = \\pi$, $n = 10$）代表一个大旋转，其中加法更新显著偏离纯旋转，放大了能量差异。\n- 用例 4（$\\theta = \\pi/2$, $n = 100$）测试了许多小的增量，这在乘法更新下应该是无害的，但在加法更新下会累积非物理效应。\n- 非客观用例 5–7 量化了对于 $\\theta = 0$, $\\theta = \\pi/4$ 和 $\\theta = \\pi/2$ 时 $W_{\\mathrm{non}}(R(\\theta))$ 如何随 $\\theta$ 变化，从而通过构造直接展示了能量层面上对框架无关性的违反。\n\n最终程序实现了这些步骤，并按指定顺序打印所需的包含 11 个条目的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rotation_matrix(theta: float) - np.ndarray:\n    \"\"\"2D rotation matrix for angle theta (radians).\"\"\"\n    c = np.cos(theta)\n    s = np.sin(theta)\n    return np.array([[c, -s],\n                     [s,  c]], dtype=float)\n\ndef W_neo_hookean_2d(F: np.ndarray, mu: float = 1.0, lam: float = 1.0) - float:\n    \"\"\"Compressible neo-Hookean energy in 2D, nondimensional, with mu=1, lam=1.\"\"\"\n    J = np.linalg.det(F)\n    # For rigid rotations J > 0; guard log for robustness\n    if J = 0:\n        # Penalize non-physical state to keep test stable; large positive energy\n        return np.inf\n    C = F.T @ F\n    I1 = np.trace(C)\n    d = 2.0\n    return 0.5 * mu * (I1 - d) - mu * np.log(J) + 0.5 * lam * (np.log(J))**2\n\ndef W_non_objective(F: np.ndarray, alpha: float = 1.0) - float:\n    \"\"\"Deliberately non-objective energy: depends on F_12.\"\"\"\n    return alpha * F[0, 1]\n\ndef additive_UL_F(theta: float, n_inc: int) - np.ndarray:\n    \"\"\"Flawed UL additive update of F over n_inc equal rotation increments.\"\"\"\n    I = np.eye(2)\n    if n_inc == 0:\n        return I\n    dtheta = theta / n_inc\n    R_inc = rotation_matrix(dtheta)\n    return I + n_inc * (R_inc - I)\n\ndef solve():\n    # Define UL discretization test cases: (theta, n_inc)\n    ul_cases = [\n        (np.pi/6, 5),   # Case 1: moderate rotation, several increments\n        (0.0, 5),       # Case 2: zero rotation, boundary case\n        (np.pi, 10),    # Case 3: large rotation, multiple increments\n        (np.pi/2, 100), # Case 4: many small increments\n    ]\n\n    # Non-objective energy test angles\n    nonobj_angles = [\n        0.0,            # Case 5\n        np.pi/4,        # Case 6\n        np.pi/2,        # Case 7\n    ]\n\n    tol = 1e-12\n    results = []\n\n    # UL tests: compute energy deviation and violation flag\n    for theta, n in ul_cases:\n        F_exact = rotation_matrix(theta)\n        F_add = additive_UL_F(theta, n)\n        e_exact = W_neo_hookean_2d(F_exact)\n        e_ul = W_neo_hookean_2d(F_add)\n        # If e_ul is inf due to non-physical J, mark as a strong violation\n        if not np.isfinite(e_ul):\n            e_dev = float('inf')\n            flag = True\n        else:\n            e_dev = abs(e_ul - e_exact)\n            flag = e_dev  tol\n        results.append(e_dev)\n        results.append(flag)\n\n    # Non-objective energy tests: compute W_non(R(theta))\n    for theta in nonobj_angles:\n        R = rotation_matrix(theta)\n        w_non = W_non_objective(R, alpha=1.0)\n        results.append(w_non)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3608929"}]}