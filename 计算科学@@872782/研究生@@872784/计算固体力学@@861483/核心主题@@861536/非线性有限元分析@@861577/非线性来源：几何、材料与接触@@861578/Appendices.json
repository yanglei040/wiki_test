{"hands_on_practices": [{"introduction": "几何非线性源于大变形，此时物体的几何形状发生显著改变，导致应变-位移关系不再是线性的。为了准确描述这一现象，我们需要掌握有限变形运动学的基本工具。本练习将通过一个均匀拉伸的简单算例，引导你计算变形梯度、柯西-格林张量及进行极分解，这些都是后续进行更复杂的几何非线性分析的基石。[@problem_id:3601263]", "problem": "考虑一个三维体正在经历一个均匀变形，该变形由运动 $\\,\\varphi:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}\\,$ 描述，在笛卡尔物质坐标系下由 $\\,\\varphi(X)=\\begin{bmatrix}\\lambda_{1} X_{1} \\\\ \\lambda_{2} X_{2} \\\\ \\lambda_{3} X_{3}\\end{bmatrix}\\,$ 给出，其中 $\\,\\lambda_{1},\\lambda_{2},\\lambda_{3}0\\,$ 是恒定的主拉伸。将此变形视为体现几何非线性的有限变形，并按以下步骤进行。\n\n从变形梯度、右柯西-格林变形张量、格林-拉格朗日应变张量和右极分解的定义出发，计算与 $\\,\\varphi\\,$ 相关的变形梯度 $\\,F\\,$、右柯西-格林张量 $\\,C\\,$ 和格林-拉格朗日应变 $\\,E\\,$。然后对 $\\,F\\,$ 进行右极分解，即写作 $\\,F=R\\,U\\,$，并确定右拉伸张量 $\\,U\\,$ 和旋转张量 $\\,R\\,$。\n\n作为您最终报告的答案，请提供雅可比行列式 $\\,J=\\det F\\,$ 关于 $\\,\\lambda_{1},\\lambda_{2},\\lambda_{3}\\,$ 的精确符号表达式。将您的最终答案表示为闭式解析表达式。不包含单位。无需四舍五入。", "solution": "问题陈述被评估为有效。它在科学上基于连续介质力学的原理，提法恰当，提供了所有必要信息，且其表述是客观的。该问题要求将标准定义应用于有限变形的一个基本案例，这使其成为一个合适且可解的问题。\n\n物体的运动由从物质（或参考）构型（坐标为 $\\mathbf{X} = (X_1, X_2, X_3)$）到空间（或当前）构型（坐标为 $\\mathbf{x} = (x_1, x_2, x_3)$）的映射 $\\varphi$ 描述。给定的运动是：\n$$\n\\mathbf{x} = \\varphi(\\mathbf{X}) = \\begin{bmatrix} \\lambda_{1} X_{1} \\\\ \\lambda_{2} X_{2} \\\\ \\lambda_{3} X_{3} \\end{bmatrix}\n$$\n其中 $\\lambda_1, \\lambda_2, \\lambda_3 > 0$ 是恒定的主拉伸。\n\n首先，我们计算变形梯度张量 $\\mathbf{F}$。它被定义为运动相对于物质坐标的梯度：\n$$\n\\mathbf{F} = \\frac{\\partial \\varphi}{\\partial \\mathbf{X}} = \\nabla_{\\mathbf{X}} \\varphi\n$$\n在分量形式中，其元素为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。我们计算这些分量：\n$F_{11} = \\frac{\\partial (\\lambda_1 X_1)}{\\partial X_1} = \\lambda_1$\n$F_{22} = \\frac{\\partial (\\lambda_2 X_2)}{\\partial X_2} = \\lambda_2$\n$F_{33} = \\frac{\\partial (\\lambda_3 X_3)}{\\partial X_3} = \\lambda_3$\n所有非对角分量均为零，例如，$F_{12} = \\frac{\\partial (\\lambda_1 X_1)}{\\partial X_2} = 0$。\n因此，变形梯度张量 $\\mathbf{F}$ 是一个对角矩阵：\n$$\n\\mathbf{F} = \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix}\n$$\n\n接下来，我们计算右柯西-格林变形张量 $\\mathbf{C}$。它的定义是：\n$$\n\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}\n$$\n其中 $\\mathbf{F}^T$ 是 $\\mathbf{F}$ 的转置。由于 $\\mathbf{F}$ 是一个对角矩阵，它是对称的，所以 $\\mathbf{F}^T = \\mathbf{F}$。\n$$\n\\mathbf{C} = \\mathbf{F}^T \\mathbf{F} = \\mathbf{F} \\mathbf{F} = \\mathbf{F}^2 = \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{bmatrix}\n$$\n\n然后，我们计算格林-拉格朗日应变张量 $\\mathbf{E}$。它由 $\\mathbf{C}$ 和单位张量 $\\mathbf{I}$ 定义为：\n$$\n\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})\n$$\n代入 $\\mathbf{C}$ 的表达式：\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{bmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{bmatrix} - \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} \\right) = \\frac{1}{2} \\begin{bmatrix} \\lambda_1^2 - 1  0  0 \\\\ 0  \\lambda_2^2 - 1  0 \\\\ 0  0  \\lambda_3^2 - 1 \\end{bmatrix}\n$$\n\n现在，我们对 $\\mathbf{F}$ 进行右极分解，该分解指出 $\\mathbf{F}$ 可以唯一地写为 $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$，其中 $\\mathbf{R}$ 是一个真正常交张量（旋转张量），而 $\\mathbf{U}$ 是一个正定对称张量（右拉伸张量）。\n张量 $\\mathbf{U}$ 可以通过关系式 $\\mathbf{C} = \\mathbf{U}^2$ 从 $\\mathbf{C}$ 计算得出，这意味着 $\\mathbf{U} = \\sqrt{\\mathbf{C}}$。\n对于我们找到的对角张量 $\\mathbf{C}$，它的主平方根是一个对角张量，其元素是 $\\mathbf{C}$ 对角元素的平方根。\n$$\n\\mathbf{U} = \\sqrt{\\mathbf{C}} = \\begin{bmatrix} \\sqrt{\\lambda_1^2}  0  0 \\\\ 0  \\sqrt{\\lambda_2^2}  0 \\\\ 0  0  \\sqrt{\\lambda_3^2} \\end{bmatrix}\n$$\n因为给定 $\\lambda_1, \\lambda_2, \\lambda_3 > 0$，我们有 $\\sqrt{\\lambda_i^2} = \\lambda_i$。\n$$\n\\mathbf{U} = \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix}\n$$\n注意，在这个纯均匀拉伸的特殊情况下，$\\mathbf{U} = \\mathbf{F}$。这表明该变形是无旋的。\n\n现在可以从分解式 $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$ 中求出旋转张量 $\\mathbf{R}$。由于为了使分解唯一，$\\mathbf{F}$ 必须是可逆的（$\\det \\mathbf{F} \\neq 0$），我们可以写出 $\\mathbf{R} = \\mathbf{F} \\mathbf{U}^{-1}$。\n代入我们关于 $\\mathbf{F}$ 和 $\\mathbf{U}$ 的结果：\n$$\n\\mathbf{R} = \\mathbf{F} \\mathbf{U}^{-1} = \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{\\lambda_1}  0  0 \\\\ 0  \\frac{1}{\\lambda_2}  0 \\\\ 0  0  \\frac{1}{\\lambda_3} \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = \\mathbf{I}\n$$\n旋转张量是单位张量 $\\mathbf{I}$。这是一个有效的旋转张量，因为它是正交的（$\\mathbf{I}^T\\mathbf{I} = \\mathbf{I}$）并且行列式为 $+1$。这证实了所给的变形是无旋转的纯拉伸。\n\n最后，我们计算雅可比行列式 $J = \\det \\mathbf{F}$。雅可比行列式衡量了从参考构型到当前构型的体积变化。\n使用 $\\mathbf{F}$ 的矩阵：\n$$\n\\mathbf{F} = \\begin{bmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{bmatrix}\n$$\n对角矩阵的行列式是其对角元素的乘积。\n$$\nJ = \\det \\mathbf{F} = \\lambda_1 \\lambda_2 \\lambda_3\n$$\n这就是问题所要求的最终表达式。", "answer": "$$\n\\boxed{\\lambda_{1} \\lambda_{2} \\lambda_{3}}\n$$", "id": "3601263"}, {"introduction": "几何非线性的一个重要工程后果是所谓的“$P-\\Delta$效应”，即轴向力会影响结构的横向刚度，并可能导致屈曲。本练习将通过一个经典的平面框架算例，让你亲手构建考虑了初始应力（即轴向力）的几何刚度矩阵。通过求解线性化屈曲特征值问题，你将能够量化$P-\\Delta$效应并预测结构的临界屈曲荷载。[@problem_id:3601273]", "problem": "考虑一个使用欧拉-伯努利梁柱单元进行理想化分析的平面二维框架。每个节点拥有三个自由度：全局轴向平移 $u_X$、全局横向平移 $u_Y$ 和绕Z轴的转动 $\\theta_Z$。材料为线性弹性，其杨氏模量为 $E$，横截面积为 $A$，截面二次矩为 $I$。几何非线性仅通过与各单元中恒定轴向力 $P$ 相关的初始应力（几何）刚度来考虑。P–$\\Delta$效应通过求解一个线性化特征值屈曲问题来量化。\n\n从虚功原理和小应变、小转动运动学出发，使用标准的双节点欧拉-伯努利插值对轴向场和横向场为每个单元建模。线性弹性刚度矩阵源于轴向拉伸和弯曲曲率产生的内部应变能。几何刚度矩阵源于轴向力 $P$ 在二阶横向位移梯度上所做的功。对于长度为 $L$、方位角为 $\\phi$（以弧度为单位，从全局 $X$ 轴朝单元局部轴向方向测量）的单元，通过以下步骤组装全局线性弹性刚度矩阵 $\\mathbf{K}$ 和全局几何刚度矩阵 $\\mathbf{K}_g$：\n- 使用欧拉-伯努利理论构建每个单元的局部线性弹性刚度 $\\mathbf{K}_e^{\\text{loc}}(E,A,I,L)$。\n- 构建与 $P$ 的虚功和Hermite三次横向插值相一致的每个单元的局部几何（初始应力）刚度 $\\mathbf{K}_{g,e}^{\\text{loc}}(P,L)$。\n- 使用适当的正交变换将每个局部矩阵旋转到全局坐标系，并通过标准有限元程序组装成全局矩阵。\n- 通过从全局系统中消除受约束的自由度来施加指定的本质边界条件。\n\n然后，确定满足广义特征值问题的最小正载荷因子 $\\lambda_{\\text{cr}}$\n$$\n\\mathbf{K}\\,\\mathbf{u} \\;=\\; \\lambda\\,\\mathbf{K}_g\\,\\mathbf{u},\n$$\n根据其构造，该问题统一缩放给定的轴向力模式 $\\{P_e\\}$ 以达到临界状态。此 $\\lambda_{\\text{cr}}$ 是无量纲的，它量化了对于所选参考轴向力，P-Δ效应对预测屈曲载荷的影响。\n\n所有角度必须以弧度为单位。使用国际单位制：$E$ 的单位为 $\\text{Pa}$，$A$ 的单位为 $\\text{m}^2$，$I$ 的单位为 $\\text{m}^4$，长度单位为 $\\text{m}$，力单位为 $\\text{N}$。将每个 $\\lambda_{\\text{cr}}$ 报告为浮点数。如果某个情况下的几何刚度矩阵恒等于零，则将结果定义为 $+\\infty$。\n\n实现一个程序，为以下测试套件构建并解决屈曲问题。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表。每个条目是四舍五入到六位小数的最小正实数特征值 $\\lambda_{\\text{cr}}$。\n\n测试套件：\n- 案例1（理想情况，两端铰接柱）：一根离散为两个等长单元的单根竖直柱。\n  - 节点：$(0,0)$、$(0,L/2)$、$(0,L)$，其中 $L = 3.0\\,\\text{m}$。\n  - 单元：两个柱单元，分别连接底-中节点和中-顶节点。\n  - 属性：$E = 210\\times 10^9\\,\\text{Pa}$，$A = 0.01\\,\\text{m}^2$，$I = 8\\times 10^{-6}\\,\\text{m}^4$。\n  - 轴向力：每个柱单元中的轴向力 $P = 1.0\\,\\text{N}$。\n  - 边界条件：在底部和顶部节点，固定 $u_X$ 和 $u_Y$；转角 $\\theta_Z$ 是自由的。\n  - 输出：$\\lambda_{\\text{cr}}$（无量纲）。\n- 案例2（边界条件覆盖，两端固接柱）：几何形状、离散化和属性与案例1相同。\n  - 轴向力：每个柱单元中的轴向力 $P = 1.0\\,\\text{N}$。\n  - 边界条件：在底部和顶部节点，固定 $u_X$、$u_Y$ 和 $\\theta_Z$。\n  - 输出：$\\lambda_{\\text{cr}}$（无量纲）。\n- 案例3（框架连接性和荷载路径覆盖，单跨框架）：两根竖直柱（每根离散为两个单元）由一根顶部横梁连接。\n  - 柱节点：左柱位于 $(0,0)$、$(0,L/2)$、$(0,L)$；右柱位于 $(B,0)$、$(B,L/2)$、$(B,L)$；其中 $L=3.0\\,\\text{m}$ 且 $B=4.0\\,\\text{m}$。\n  - 横梁单元：连接 $(0,L)$ 和 $(B,L)$。\n  - 属性：柱的属性为 $E = 210\\times 10^9\\,\\text{Pa}$，$A = 0.01\\,\\text{m}^2$，$I = 8\\times 10^{-6}\\,\\text{m}^4$；横梁的属性为 $E = 210\\times 10^9\\,\\text{Pa}$，$A = 0.01\\,\\text{m}^2$，$I = 1.6\\times 10^{-5}\\,\\text{m}^4$。\n  - 轴向力：每个柱单元中的轴向力为 $P = 1.0\\,\\text{N}$；横梁中的轴向力为 $P = 0.0\\,\\text{N}$。\n  - 边界条件：在两个柱底 $(0,0)$ 和 $(B,0)$ 处，固定 $u_X$、$u_Y$ 和 $\\theta_Z$。\n  - 输出：$\\lambda_{\\text{cr}}$（无量纲）。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”），每个结果对应案例1、案例2和案例3，并四舍五入到六位小数。", "solution": "该问题要求使用有限元法确定几个二维框架结构的临界屈曲载荷因子 $\\lambda_{\\text{cr}}$。该分析基于线性化特征值屈曲公式，这是计算固体力学中评估结构抵抗P-$\\Delta$效应稳定性的标准程序。解决方案包括构建线性弹性刚度矩阵 $\\mathbf{K}$ 和几何刚度矩阵 $\\mathbf{K}_g$，施加边界条件，并求解由此产生的广义特征值问题。\n\n整个过程建立在虚功原理之上，或者等效地，建立在系统总势能 $\\Pi$ 的驻值性之上。\n$$ \\Pi = U + W $$\n为进行稳定性分析，应变能 $U$ 被展开以包含位移的二阶项，这捕捉了轴向力与横向挠度之间的相互作用。总应变能由线性弹性应变能 $U_e$ 和与初始应力状态相关的几何应变能 $U_g$ 组成。\n当势能的一次变分为零（$\\delta\\Pi = 0$）时，系统达到平衡。稳定性判据由二次变分 $\\delta^2\\Pi$ 的符号确定。当对于某个非平凡位移场 $\\delta^2\\Pi = 0$ 时，发生屈曲，这表明系统从稳定平衡状态过渡到不稳定平衡状态。此条件导出了线性化特征值问题。\n\n具体步骤如下：\n\n1.  **单元离散化和局部刚度矩阵**\n每个结构构件被建模为双节点欧拉-伯努利梁柱单元。在局部坐标系（$x, y, z$）中，$x$ 轴与单元的形心轴对齐，每个节点有三个自由度（DOFs）：轴向位移 $u_x$、横向位移 $u_y$ 和转角 $\\theta_z$。单元节点位移向量为 $\\mathbf{d}_e^{\\text{loc}} = [u_{x1}, u_{y1}, \\theta_{z1}, u_{x2}, u_{y2}, \\theta_{z2}]^T$。\n\n-   **线性弹性刚度矩阵 ($\\mathbf{K}_e^{\\text{loc}}$)**：此矩阵源于线性弹性应变能 $U_e = \\frac{1}{2}\\int_V \\boldsymbol{\\sigma}^T \\boldsymbol{\\epsilon} \\, dV$。对于欧拉-伯努利梁，这可以分解为轴向和弯曲分量。得到的 $6 \\times 6$ 局部刚度矩阵将节点力和力矩与节点位移联系起来：\n    $$ \\mathbf{K}_e^{\\text{loc}} = \\begin{bmatrix}\n    \\frac{EA}{L}  0  0  -\\frac{EA}{L}  0  0 \\\\\n    0  \\frac{12EI}{L^3}  \\frac{6EI}{L^2}  0  -\\frac{12EI}{L^3}  \\frac{6EI}{L^2} \\\\\n    0  \\frac{6EI}{L^2}  \\frac{4EI}{L}  0  -\\frac{6EI}{L^2}  \\frac{2EI}{L} \\\\\n    -\\frac{EA}{L}  0  0  \\frac{EA}{L}  0  0 \\\\\n    0  -\\frac{12EI}{L^3}  -\\frac{6EI}{L^2}  0  \\frac{12EI}{L^3}  -\\frac{6EI}{L^2} \\\\\n    0  \\frac{6EI}{L^2}  \\frac{2EI}{L}  0  -\\frac{6EI}{L^2}  \\frac{4EI}{L}\n    \\end{bmatrix} $$\n    其中 $E$ 是杨氏模量，$A$ 是横截面积，$I$ 是截面二次矩，$L$ 是单元长度。\n\n-   **几何刚度矩阵 ($\\mathbf{K}_{g,e}^{\\text{loc}}$)**：此矩阵，也称为初始应力矩阵，源于恒定轴向力 $P$（假定为压力）在横向位移梯度的非线性二阶项上所做的功。其势能项为 $U_g = \\frac{1}{2} \\int_0^L P \\left( \\frac{du_y}{dx} \\right)^2 dx$。通过对横向位移场 $u_y(x)$ 使用Hermite三次形函数，我们推导出局部几何刚度矩阵：\n    $$ \\mathbf{K}_{g,e}^{\\text{loc}} = \\frac{P}{30L} \\begin{bmatrix}\n    0  0  0  0  0  0 \\\\\n    0  36  3L  0  -36  3L \\\\\n    0  3L  4L^2  0  -3L  -L^2 \\\\\n    0  0  0  0  0  0 \\\\\n    0  -36  -3L  0  36  -3L \\\\\n    0  3L  -L^2  0  -3L  4L^2\n    \\end{bmatrix} $$\n    注意，该矩阵与参考轴向力 $P$ 呈线性正比关系。\n\n2.  **坐标变换**\n为了组装全局系统，每个单元的局部刚度矩阵必须转换到全局坐标系（$X, Y, Z$）。这是通过一个转换矩阵 $\\mathbf{T}$ 实现的，该矩阵关联了局部和全局节点位移，$\\mathbf{d}_e^{\\text{loc}} = \\mathbf{T} \\mathbf{d}_e^{\\text{glob}}$。矩阵 $\\mathbf{T}$ 是基于单元的方位角 $\\phi$ 由一个 $3 \\times 3$ 的旋转矩阵 $\\mathbf{R}$ 构建的：\n$$ \\mathbf{R} = \\begin{bmatrix} \\cos\\phi  \\sin\\phi  0 \\\\ -\\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{bmatrix}, \\quad \\mathbf{T} = \\begin{bmatrix} \\mathbf{R}  \\mathbf{0} \\\\ \\mathbf{0}  \\mathbf{R} \\end{bmatrix} $$\n随后，通过合同变换得到全局坐标系中的单元刚度矩阵 $\\mathbf{K}_e$ 和 $\\mathbf{K}_{g,e}$：\n$$ \\mathbf{K}_e = \\mathbf{T}^T \\mathbf{K}_e^{\\text{loc}} \\mathbf{T}, \\quad \\mathbf{K}_{g,e} = \\mathbf{T}^T \\mathbf{K}_{g,e}^{\\text{loc}} \\mathbf{T} $$\n\n3.  **全局矩阵的组装**\n整个结构的全局刚度矩阵 $\\mathbf{K}$ 和 $\\mathbf{K}_g$ 是通过将每个单元的全局矩阵的贡献累加到全局矩阵的相应条目中来组装的。全局矩阵的大小为 $(3 N_{nodes}) \\times (3 N_{nodes})$，其中 $N_{nodes}$ 是结构中节点的总数。\n\n4.  **边界条件的施加**\n通过从全局矩阵中消除与受约束自由度对应的行和列来施加本质边界条件（指定位移）。这种划分产生了简化矩阵 $\\mathbf{K}_{\\text{reduced}}$ 和 $\\mathbf{K}_{g, \\text{reduced}}$，它们控制着系统自由（未约束）自由度的行为。\n\n5.  **特征值问题的求解**\n屈曲条件 $\\delta^2\\Pi = 0$ 导出了齐次方程组：\n$$ (\\mathbf{K} - \\lambda \\mathbf{K}_g) \\mathbf{u} = 0 \\quad \\implies \\quad \\mathbf{K} \\mathbf{u} = \\lambda \\mathbf{K}_g \\mathbf{u} $$\n施加边界条件后，我们求解简化的广义特征值问题：\n$$ \\mathbf{K}_{\\text{reduced}} \\mathbf{u}_{\\text{free}} = \\lambda \\mathbf{K}_{g, \\text{reduced}} \\mathbf{u}_{\\text{free}} $$\n特征值 $\\lambda$ 是载荷因子。临界屈曲载荷因子 $\\lambda_{\\text{cr}}$ 是从此问题中得到的最小正实数特征值。它代表了为使结构发生屈曲，参考轴向力 $\\{P_e\\}$ 必须乘以的因子。相应的特征向量 $\\mathbf{u}_{\\text{free}}$ 代表了屈曲模态的形状。该问题使用标准的线性代数库进行数值求解。如果几何刚度矩阵 $\\mathbf{K}_g$ 恒等于零（即所有参考轴向力都为零），则在此上下文中未定义屈曲，$\\lambda_{\\text{cr}}$ 取为无穷大。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef get_local_stiffness_matrices(E, A, I, P, L):\n    \"\"\"\n    Constructs the local elastic and geometric stiffness matrices for a 2D Euler-Bernoulli beam element.\n    \n    Args:\n        E (float): Young's modulus\n        A (float): Cross-sectional area\n        I (float): Second moment of area\n        P (float): Compressive axial force\n        L (float): Element length\n        \n    Returns:\n        tuple: A tuple containing the 6x6 local elastic stiffness matrix (K_e_loc) \n               and the 6x6 local geometric stiffness matrix (Kg_e_loc).\n    \"\"\"\n    if L == 0:\n        return np.zeros((6, 6)), np.zeros((6, 6))\n        \n    EA_L = E * A / L\n    EI_L = E * I / L\n    EI_L2 = E * I / L**2\n    EI_L3 = E * I / L**3\n    \n    K_e_loc = np.array([\n        [EA_L, 0, 0, -EA_L, 0, 0],\n        [0, 12*EI_L3, 6*EI_L2, 0, -12*EI_L3, 6*EI_L2],\n        [0, 6*EI_L2, 4*EI_L, 0, -6*EI_L2, 2*EI_L],\n        [-EA_L, 0, 0, EA_L, 0, 0],\n        [0, -12*EI_L3, -6*EI_L2, 0, 12*EI_L3, -6*EI_L2],\n        [0, 6*EI_L2, 2*EI_L, 0, -6*EI_L2, 4*EI_L]\n    ])\n\n    Kg_e_loc = np.zeros((6, 6))\n    if P != 0:\n        P_30L = P / (30 * L)\n        Kg_e_loc = P_30L * np.array([\n            [0, 0, 0, 0, 0, 0],\n            [0, 36, 3*L, 0, -36, 3*L],\n            [0, 3*L, 4*L**2, 0, -3*L, -L**2],\n            [0, 0, 0, 0, 0, 0],\n            [0, -36, -3*L, 0, 36, -3*L],\n            [0, 3*L, -L**2, 0, -3*L, 4*L**2]\n        ])\n    \n    return K_e_loc, Kg_e_loc\n\ndef get_transformation_matrix(phi):\n    \"\"\"\n    Constructs the transformation matrix for a 2D beam element.\n\n    Args:\n        phi (float): Angle of the element with the global X-axis, in radians.\n\n    Returns:\n        numpy.ndarray: The 6x6 transformation matrix T.\n    \"\"\"\n    c = np.cos(phi)\n    s = np.sin(phi)\n    \n    R = np.array([\n        [c, s, 0],\n        [-s, c, 0],\n        [0, 0, 1]\n    ])\n    \n    T = np.zeros((6, 6))\n    T[0:3, 0:3] = R\n    T[3:6, 3:6] = R\n    \n    return T\n\ndef solve_buckling(nodes, elements, bcs):\n    \"\"\"\n    Assembles and solves the linearized buckling eigenvalue problem for a 2D frame.\n    \"\"\"\n    num_nodes = len(nodes)\n    num_dofs = 3 * num_nodes\n    \n    K_global = np.zeros((num_dofs, num_dofs))\n    Kg_global = np.zeros((num_dofs, num_dofs))\n\n    for elem in elements:\n        n1_idx, n2_idx = elem['nodes']\n        n1_coords = nodes[n1_idx]\n        n2_coords = nodes[n2_idx]\n        \n        dx = n2_coords[0] - n1_coords[0]\n        dy = n2_coords[1] - n1_coords[1]\n        \n        L = np.sqrt(dx**2 + dy**2)\n        phi = np.arctan2(dy, dx)\n        \n        E, A, I, P = elem['E'], elem['A'], elem['I'], elem['P']\n        \n        K_loc, Kg_loc = get_local_stiffness_matrices(E, A, I, P, L)\n        T = get_transformation_matrix(phi)\n        \n        K_elem_global = T.T @ K_loc @ T\n        Kg_elem_global = T.T @ Kg_loc @ T\n        \n        dof_indices = np.array([\n            3*n1_idx, 3*n1_idx + 1, 3*n1_idx + 2,\n            3*n2_idx, 3*n2_idx + 1, 3*n2_idx + 2\n        ])\n        \n        ix_grid = np.ix_(dof_indices, dof_indices)\n        K_global[ix_grid] += K_elem_global\n        Kg_global[ix_grid] += Kg_elem_global\n\n    if not np.any(Kg_global):\n        return np.inf\n\n    all_dofs = set(range(num_dofs))\n    constrained_dofs = set(bcs.keys())\n    free_dofs = sorted(list(all_dofs - constrained_dofs))\n    \n    ix_grid_free = np.ix_(free_dofs, free_dofs)\n    K_reduced = K_global[ix_grid_free]\n    Kg_reduced = Kg_global[ix_grid_free]\n    \n    if K_reduced.shape[0] == 0:\n        return np.inf\n        \n    try:\n        eigenvalues = eig(K_reduced, b=Kg_reduced, right=False)\n    except np.linalg.LinAlgError:\n        return np.inf\n\n    real_eigenvalues = eigenvalues[np.isreal(eigenvalues)].real\n    positive_eigenvalues = real_eigenvalues[real_eigenvalues  1e-9] \n    \n    if len(positive_eigenvalues) == 0:\n        return np.inf\n        \n    lambda_cr = np.min(positive_eigenvalues)\n    return lambda_cr\n\ndef solve():\n    # Define the test cases from the problem statement.\n    L_case1 = 3.0\n    nodes_1 = [(0.0, 0.0), (0.0, L_case1/2.0), (0.0, L_case1)]\n    elements_1 = [\n        {'nodes': (0, 1), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0},\n        {'nodes': (1, 2), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0}\n    ]\n    # Case 1: Pinned-pinned column\n    bcs_1 = {0: 0, 1: 0, 6: 0, 7: 0}\n\n    # Case 2: Fixed-fixed column\n    bcs_2 = {0: 0, 1: 0, 2: 0, 6: 0, 7: 0, 8: 0}\n\n    # Case 3: Single-bay frame\n    L_case3, B_case3 = 3.0, 4.0\n    nodes_3 = [\n        (0.0, 0.0), (0.0, L_case3/2.0), (0.0, L_case3),\n        (B_case3, 0.0), (B_case3, L_case3/2.0), (B_case3, L_case3)\n    ]\n    elements_3 = [\n        {'nodes': (0, 1), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0},\n        {'nodes': (1, 2), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0},\n        {'nodes': (3, 4), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0},\n        {'nodes': (4, 5), 'E': 210e9, 'A': 0.01, 'I': 8e-6, 'P': 1.0},\n        {'nodes': (2, 5), 'E': 210e9, 'A': 0.01, 'I': 1.6e-5, 'P': 0.0}\n    ]\n    bcs_3 = {0: 0, 1: 0, 2: 0, 9: 0, 10: 0, 11: 0}\n    \n    test_cases = [\n        (nodes_1, elements_1, bcs_1),\n        (nodes_1, elements_1, bcs_2),\n        (nodes_3, elements_3, bcs_3)\n    ]\n\n    results = []\n    for case in test_cases:\n        nodes, elements, bcs = case\n        result = solve_buckling(nodes, elements, bcs)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3601273"}, {"introduction": "当材料的本构关系（应力-应变关系）为非线性时，我们称之为材料非线性，其中弹塑性行为是最典型的例子。在隐式有限元分析中，正确处理塑性流动需要一套专门的算法，即“返回映射算法”。本练习将引导你推导一维弹塑性模型的应力更新算法和保证二次收敛速度所必需的“一致切线算子”，这是实现稳健的非线性材料仿真的核心。[@problem_id:3601269]", "problem": "考虑一个一维小应变杆，承受单调递增的拉伸变形，在有限元法（FEM）框架内，使用标准的率无关伴随弹塑性本构定律和线性各向同性硬化进行建模。材料行为由以下要素定义：\n\n- 应变加法分解 $\\,\\varepsilon = \\varepsilon^{\\mathrm{e}} + \\varepsilon^{\\mathrm{p}}\\,$.\n- 二次形式的弹性亥姆霍兹自由能 $\\,\\psi(\\varepsilon^{\\mathrm{e}}) = \\tfrac{1}{2} E \\left(\\varepsilon^{\\mathrm{e}}\\right)^{2}\\,$, 其中 $\\,E\\,$ 是杨氏模量。\n- 柯西应力 $\\,\\sigma\\,$ 遵循 $\\,\\sigma = \\frac{\\partial \\psi}{\\partial \\varepsilon^{\\mathrm{e}}} = E \\left(\\varepsilon - \\varepsilon^{\\mathrm{p}}\\right)\\,$。\n- 伴随屈服函数 $\\,f(\\sigma,\\alpha) = |\\sigma| - \\sigma_{y0} - H \\alpha\\,$, 其中 $\\,\\sigma_{y0}  0\\,$ 是初始屈服应力，$\\,H \\ge 0\\,$ 是各向同性硬化模量，$\\,\\alpha\\,$ 是等效塑性应变，定义为 $\\,\\dot{\\alpha} = |\\dot{\\varepsilon}^{\\mathrm{p}}|\\,$。\n- 与伴随塑性一致的正交性和互补条件：$\\,\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma} \\, \\partial f / \\partial \\sigma\\,$, $\\,\\dot{\\alpha} = \\dot{\\gamma}\\,$, $\\,\\dot{\\gamma} \\ge 0\\,$, $\\,f \\le 0\\,$, $\\,\\dot{\\gamma} f = 0\\,$。\n\n假设加载保持严格拉伸，因此 $\\,\\sigma \\ge 0\\,$ 且流动方向为正。考虑从 $\\,t_{n}\\,$ 到 $\\,t_{n+1}\\,$ 的单个隐式时间增量，给定总应变为 $\\,\\varepsilon_{n+1}\\,$。设 $\\,t_{n}\\,$ 时刻的内变量为 $\\,\\varepsilon^{\\mathrm{p}}_{n}\\,$ 和 $\\,\\alpha_{n}\\,$。定义试探弹性预测值 $\\,\\sigma_{\\mathrm{tr}} = E \\left(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}\\right)\\,$ 和试探屈服值 $\\,f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}\\,$。\n\n假设该步是塑性激活的，即 $\\,f_{\\mathrm{tr}}  0\\,$。从上述基本定义和条件出发，完成以下任务：\n\n1. 使用适用于隐式有限元法的无条件稳定格式离散化内变量的演化，并为塑性乘子增量 $\\,\\Delta \\gamma\\,$ 建立相应的离散系统。\n2. 对于拉伸加载下塑性激活的情况（$\\,f_{\\mathrm{tr}}  0\\,$），推导算法应力更新 $\\,\\sigma_{n+1}\\,$，用 $\\,\\varepsilon_{n+1}\\,$, $\\,\\varepsilon^{\\mathrm{p}}_{n}\\,$, $\\,\\alpha_{n}\\,$, $\\,E\\,$, $\\,H\\,$ 和 $\\,\\sigma_{y0}\\,$ 表示。\n3. 计算隐式有限元公式中全局平衡方程的 Newton–Raphson 解法所需的一致性切线算子，即，在拉伸加载下的塑性激活情况下，计算 $\\,\\dfrac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}}\\,$。\n\n以 $\\,E\\,$ 和 $\\,H\\,$ 表示的一致性切线模量的单个闭式解析表达式的形式提供最终结果。不需要进行数值计算，最终表达式中也不应包含物理单位。", "solution": "该问题陈述经证实具有科学依据、提法恰当且客观。它代表了计算弹塑性领域中的一个标准问题。我们开始求解。\n\n该问题要求在有限元法（FEM）框架下，推导正在经历塑性变形的一维杆的应力更新和一致性切线模量。该模型是具有线性各向同性硬化的率无关伴随弹塑性模型。给定单调递增的拉伸加载情况，这意味着应力 $\\sigma$ 是非负的，即 $\\sigma \\ge 0$。\n\n首先，我们根据拉伸加载条件简化屈服函数和流动法则。屈服函数为 $f(\\sigma, \\alpha) = |\\sigma| - \\sigma_{y0} - H \\alpha$。由于 $\\sigma \\ge 0$，该函数变为 $f(\\sigma, \\alpha) = \\sigma - \\sigma_{y0} - H \\alpha$。\n塑性应变的流动法则是 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma} \\frac{\\partial f}{\\partial \\sigma}$。其梯度为 $\\frac{\\partial f}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma}(\\sigma - \\sigma_{y0} - H \\alpha) = 1$。\n因此，流动法则简化为 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$。\n硬化定律由 $\\dot{\\alpha} = |\\dot{\\varepsilon}^{\\mathrm{p}}|$ 给出。代入 $\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma}$，并且已知塑性乘子率 $\\dot{\\gamma}$ 是非负的，即 $\\dot{\\gamma} \\ge 0$，我们得到 $\\dot{\\alpha} = |\\dot{\\gamma}| = \\dot{\\gamma}$。\n\n问题要求对从时间 $t_n$ 到 $t_{n+1}$ 的单个隐式时间增量进行离散化表述。我们将采用后向欧拉法，这是一种无条件稳定的格式，来对内变量 $\\varepsilon^{\\mathrm{p}}$ 和 $\\alpha$ 的演化方程进行积分。\n\n演化方程的后向欧拉离散化为：\n$$ \\varepsilon^{\\mathrm{p}}_{n+1} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta \\varepsilon^{\\mathrm{p}} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma \\left. \\frac{\\partial f}{\\partial \\sigma} \\right|_{n+1} $$\n$$ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\alpha = \\alpha_{n} + \\Delta\\gamma $$\n其中 $\\Delta\\gamma = \\int_{t_n}^{t_{n+1}} \\dot{\\gamma} \\, \\mathrm{d}t$ 是塑性乘子的增量。由于 $\\left. \\frac{\\partial f}{\\partial \\sigma} \\right|_{n+1} = 1$，塑性应变的更新变为：\n$$ \\varepsilon^{\\mathrm{p}}_{n+1} = \\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma $$\n\n假设该步是塑性激活的，意味着在初始弹性试探步之后，屈服条件被违反（$f_{\\mathrm{tr}} > 0$）。这意味着在该增量期间发生了塑性流动，并且在增量结束时，状态必须位于屈服面上。这由离散一致性条件表示：\n$$ f_{n+1} = f(\\sigma_{n+1}, \\alpha_{n+1}) = 0 $$\n代入简化的屈服函数，我们有：\n$$ \\sigma_{n+1} - \\sigma_{y0} - H \\alpha_{n+1} = 0 $$\n\n现在我们用增量 $\\Delta\\gamma$ 和已知量来表示 $\\sigma_{n+1}$ 和 $\\alpha_{n+1}$。\n$t_{n+1}$ 时刻的应力由本构定律给出：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n+1}) $$\n代入 $\\varepsilon^{\\mathrm{p}}_{n+1}$ 的更新公式：\n$$ \\sigma_{n+1} = E (\\varepsilon_{n+1} - (\\varepsilon^{\\mathrm{p}}_{n} + \\Delta\\gamma)) = E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}) - E \\Delta\\gamma $$\n$E (\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$ 项被定义为试探应力 $\\sigma_{\\mathrm{tr}}$。因此，\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E \\Delta\\gamma $$\n更新后的硬化变量是：\n$$ \\alpha_{n+1} = \\alpha_{n} + \\Delta\\gamma $$\n\n现在我们可以将 $\\sigma_{n+1}$ 和 $\\alpha_{n+1}$ 的这些表达式代入离散一致性条件 $f_{n+1} = 0$ 中：\n$$ (\\sigma_{\\mathrm{tr}} - E \\Delta\\gamma) - \\sigma_{y0} - H (\\alpha_{n} + \\Delta\\gamma) = 0 $$\n重新排列各项以求解 $\\Delta\\gamma$，这就解决了任务1：\n$$ (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) - E \\Delta\\gamma - H \\Delta\\gamma = 0 $$\n括号中的项是试探屈服值 $f_{\\mathrm{tr}} = \\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}$。方程变为：\n$$ f_{\\mathrm{tr}} - (E+H) \\Delta\\gamma = 0 $$\n对于塑性步，我们假设 $f_{\\mathrm{tr}} > 0$。由于 $E>0$ 且 $H \\ge 0$，和 $E+H$ 是正的。我们可以解出 $\\Delta\\gamma$：\n$$ \\Delta\\gamma = \\frac{f_{\\mathrm{tr}}}{E+H} $$\n这证实了 $\\Delta\\gamma > 0$，与塑性激活加载一致。\n\n对于任务2，我们推导算法应力更新 $\\sigma_{n+1}$。我们将 $\\Delta\\gamma$ 的表达式代回到 $\\sigma_{n+1}$ 的方程中：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E \\Delta\\gamma = \\sigma_{\\mathrm{tr}} - E \\left( \\frac{f_{\\mathrm{tr}}}{E+H} \\right) $$\n代入 $f_{\\mathrm{tr}}$ 的定义：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - \\frac{E}{E+H} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n该表达式代表“返回映射”算法，它将试探应力状态投影回更新后的屈服面上。这个表达式可用于任务3，但为了完整性，我们也可以将其展开：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} \\left( 1 - \\frac{E}{E+H} \\right) + \\frac{E}{E+H} (\\sigma_{y0} + H \\alpha_{n}) = \\frac{H}{E+H}\\sigma_{\\mathrm{tr}} + \\frac{E}{E+H}(\\sigma_{y0} + H\\alpha_{n}) $$\n代入 $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$ 得到完整的依赖关系：\n$$ \\sigma_{n+1} = \\frac{H E}{E+H}(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n}) + \\frac{E}{E+H}(\\sigma_{y0} + H\\alpha_{n}) $$\n\n对于任务3，我们计算一致性切线算子（一维情况下为模量），即更新后的应力 $\\sigma_{n+1}$ 对总应变 $\\varepsilon_{n+1}$ 的导数。\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} $$\n我们对任务2中推导出的 $\\sigma_{n+1}$ 表达式求导。最方便的起始形式是：\n$$ \\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - \\frac{E}{E+H} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n变量 $\\varepsilon^{\\mathrm{p}}_{n}$ 和 $\\alpha_{n}$ 是增量开始时的历史值，因此相对于 $\\varepsilon_{n+1}$ 是常数。材料参数 $E$、$H$ 和 $\\sigma_{y0}$ 也是常数。唯一依赖于 $\\varepsilon_{n+1}$ 的项是试探应力 $\\sigma_{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})$。\n试探应力的导数是：\n$$ \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d}}{\\mathrm{d} \\varepsilon_{n+1}} [E(\\varepsilon_{n+1} - \\varepsilon^{\\mathrm{p}}_{n})] = E $$\n现在，我们对 $\\sigma_{n+1}$ 的表达式应用链式法则：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\mathrm{d}}{\\mathrm{d} \\varepsilon_{n+1}} (\\sigma_{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_{n}) $$\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} $$\n代入 $\\frac{\\mathrm{d} \\sigma_{\\mathrm{tr}}}{\\mathrm{d} \\varepsilon_{n+1}} = E$：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = E - \\frac{E}{E+H} (E) = E \\left( 1 - \\frac{E}{E+H} \\right) $$\n简化括号中的表达式：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = E \\left( \\frac{E+H-E}{E+H} \\right) = E \\left( \\frac{H}{E+H} \\right) $$\n因此，塑性激活步的一致性切线模量为：\n$$ \\frac{\\mathrm{d} \\sigma_{n+1}}{\\mathrm{d} \\varepsilon_{n+1}} = \\frac{EH}{E+H} $$\n这个结果可以被物理解释为两个串联元件的等效刚度：一个代表弹性响应（刚度为$E$），另一个代表塑性硬化响应（刚度为$H$）。如果材料是理想塑性的（$H=0$），则切线模量为 $0$。如果没有塑性变形（相当于 $H \\to \\infty$），则切线模量正确地恢复为弹性模量 $E$。", "answer": "$$\\boxed{\\frac{EH}{E+H}}$$", "id": "3601269"}]}