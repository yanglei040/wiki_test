{"hands_on_practices": [{"introduction": "从有限元分析中得到的原始应力场在单元边界上通常是不连续的。为了获得一个连续且更精确的节点应力，最直接的方法是对共享该节点的各单元的应力值进行平均。此练习将引导您从最小二乘法的第一性原理出发，推导出面积加权平均法，证明它是在$L^{2}$范数意义下的最佳近似，而不仅仅是一种直观选择。通过这个实践[@problem_id:3603826]，您将理解为何较大的单元在节点应力计算中应具有更大的权重。", "problem": "考虑一个通过有限元法 (FEM) 离散化的小应变二维平面应力问题。在一个内部节点 $i$ 处，由四个双线性四边形单元 $\\{e=1,2,3,4\\}$ 组成的星形单元片 $\\mathcal{S}(i)$ 在此交汇。设 $\\sigma_{xx}^{(e)}$ 表示单元 $e$ 上 Cauchy 应力 $xx$ 分量的单元平均值，并设 $A_{e}$ 表示单元 $e$ 的面积。假设每个单元的应力场在其单元内为分片常数，其值为 $\\sigma_{xx}^{(e)}$，并且您需要寻求一个在 $\\mathcal{S}(i)$ 上为常数的恢复节点应力值 $\\sigma_{xx}^{\\star}(i)$，该值在最小二乘意义下能最佳地表示该单元片。\n\n仅使用 $\\mathcal{S}(i)$ 上 $L^{2}$ 范数下的最小二乘逼近第一性原理，推导 $\\sigma_{xx}^{\\star}(i)$ 关于 $\\{A_{e}\\}$ 和 $\\{\\sigma_{xx}^{(e)}\\}$ 的表达式，过程中不引用任何已有的应力恢复公式。然后，对于下面给出的特定星形单元片数据，计算面积加权的恢复节点应力，并将其与单元平均值的未加权算术平均进行比较，报告它们的差值\n$$\n\\Delta \\sigma_{xx} \\equiv \\sigma_{xx}^{\\star}(i) - \\overline{\\sigma}_{xx}^{\\,\\text{arith}},\n$$\n其中 $\\overline{\\sigma}_{xx}^{\\,\\text{arith}}$ 是 $\\{\\sigma_{xx}^{(e)}\\}_{e=1}^{4}$ 的算术平均值。使用以下数据：\n- 单元 $1$：$A_{1}=120~\\text{mm}^{2}$，$\\sigma_{xx}^{(1)}=95~\\text{MPa}$。\n- 单元 $2$：$A_{2}=80~\\text{mm}^{2}$，$\\sigma_{xx}^{(2)}=110~\\text{MPa}$。\n- 单元 $3$：$A_{3}=200~\\text{mm}^{2}$，$\\sigma_{xx}^{(3)}=85~\\text{MPa}$。\n- 单元 $4$：$A_{4}=100~\\text{mm}^{2}$，$\\sigma_{xx}^{(4)}=130~\\text{MPa}$。\n\n将 $\\Delta \\sigma_{xx}$ 的单个数值作为最终答案报告。将您的答案四舍五入到四位有效数字，并以兆帕 (MPa) 为单位表示。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **背景：**一个通过有限元法 (FEM) 离散化的小应变二维平面应力问题。\n- **域：**一个由四个双线性四边形单元 $\\{e=1,2,3,4\\}$ 组成的星形单元片 $\\mathcal{S}(i)$，它们在一个内部节点 $i$ 处交汇。\n- **单元数据：**对于每个单元 $e$，给定了面积 $A_{e}$ 和单元平均应力 $\\sigma_{xx}^{(e)}$。\n- **假设：**单元片内的应力场是分片常数，在每个单元 $e$ 上的值为 $\\sigma_{xx}^{(e)}$。\n- **目标：**找到一个在 $\\mathcal{S}(i)$ 上为常数的恢复节点应力值 $\\sigma_{xx}^{\\star}(i)$，它在最小二乘意义下能最佳地表示该单元片，即最小化误差的 $L^{2}$ 范数。\n- **任务 1：**从第一性原理出发，推导 $\\sigma_{xx}^{\\star}(i)$ 关于 $\\{A_{e}\\}$ 和 $\\{\\sigma_{xx}^{(e)}\\}$ 的表达式。\n- **任务 2：**计算差值 $\\Delta \\sigma_{xx} \\equiv \\sigma_{xx}^{\\star}(i) - \\overline{\\sigma}_{xx}^{\\,\\text{arith}}$，其中 $\\overline{\\sigma}_{xx}^{\\,\\text{arith}}$ 是单元应力 $\\{\\sigma_{xx}^{(e)}\\}_{e=1}^{4}$ 的算术平均值。\n- **数值数据：**\n  - 单元 $1$：$A_{1}=120~\\text{mm}^{2}$，$\\sigma_{xx}^{(1)}=95~\\text{MPa}$。\n  - 单元 $2$：$A_{2}=80~\\text{mm}^{2}$，$\\sigma_{xx}^{(2)}=110~\\text{MPa}$。\n  - 单元 $3$：$A_{3}=200~\\text{mm}^{2}$，$\\sigma_{xx}^{(3)}=85~\\text{MPa}$。\n  - 单元 $4$：$A_{4}=100~\\text{mm}^{2}$，$\\sigma_{xx}^{(4)}=130~\\text{MPa}$。\n- **最终答案格式：**以兆帕 (MPa) 为单位报告 $\\Delta \\sigma_{xx}$ 的数值，并四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学或事实上的不健全性：**该问题牢固地植根于有限元法理论，这是计算固体力学的基石。使用最小二乘法最小化从不连续的分片场中获得“平滑”或“恢复”场是一种标准且数学上严谨的程序。没有违反科学原理的地方。\n- **非形式化或不相关：**该问题与计算力学中的应力恢复和节点平均主题直接相关。使用 $L^2$ 范数下的最小二乘法是一个形式化的、定义明确的数学指令。\n- **不完整或矛盾的设置：**问题是完全指定的。它提供了所有必要的数据（单元面积和应力）和一个明确的目标准则（最小二乘最小化），以推导公式并计算所需值。没有矛盾之处。\n- **不切实际或不可行：**给定的面积和应力值对于典型的工程构件分析是物理上现实的。\n- **病态或结构不良：**该问题是适定的。严格凸二次泛函的最小化保证了唯一解的存在。术语是标准的且无歧义的。\n- **伪深刻、琐碎或同义反复：**该问题要求从第一性原理进行推导，这考验了对基本概念的理解，然后进行具体计算。这是一个标准的、非平凡的练习。\n- **超出科学可验证性：**推导是一个数学证明问题，计算是数值上可验证的。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整的解答。\n\n### 解答推导与计算\n\n目标是找到一个常数恢复应力 $\\sigma_{xx}^{\\star}(i)$（为简洁起见，记为 $\\sigma^{\\star}$），它能在最小二乘意义下最佳地逼近单元片 $\\mathcal{S}(i)$ 上的分片常数应力场 $\\sigma(\\mathbf{x})$。单元片是四个单元的并集，$\\mathcal{S}(i) = \\bigcup_{e=1}^{4} e$。应力场 $\\sigma(\\mathbf{x})$ 定义为，对于单元 $e$ 中的任意点 $\\mathbf{x}$，$\\sigma(\\mathbf{x}) = \\sigma_{xx}^{(e)}$。\n\n最小二乘原理要求最小化误差的 $L^{2}$ 范数的平方，即在整个单元片上对两个场之间差值的平方进行积分。需要最小化的目标函数是 $J(\\sigma^{\\star})$：\n$$\nJ(\\sigma^{\\star}) = \\int_{\\mathcal{S}(i)} (\\sigma(\\mathbf{x}) - \\sigma^{\\star})^2 \\, dA\n$$\n由于单元片 $\\mathcal{S}(i)$ 由四个单元组成，并假设重叠可忽略不计（即，它们仅在边界处相交），因此单元片上的积分可以写成每个单元上积分的总和：\n$$\nJ(\\sigma^{\\star}) = \\sum_{e=1}^{4} \\int_{e} (\\sigma(\\mathbf{x}) - \\sigma^{\\star})^2 \\, dA\n$$\n在每个单元 $e$ 内部，应力 $\\sigma(\\mathbf{x})$ 是常数 $\\sigma_{xx}^{(e)}$。因此，对于求和中的每一项，被积函数 $(\\sigma_{xx}^{(e)} - \\sigma^{\\star})^2$ 在其积分域上是常数。单元 $e$ 上的积分就是这个常数值乘以该单元的面积 $A_e$：\n$$\nJ(\\sigma^{\\star}) = \\sum_{e=1}^{4} A_e (\\sigma_{xx}^{(e)} - \\sigma^{\\star})^2\n$$\n为了找到使该泛函最小化的 $\\sigma^{\\star}$ 值，我们必须通过对 $J$ 关于 $\\sigma^{\\star}$ 求导并将其设为零来找到驻点：\n$$\n\\frac{dJ}{d\\sigma^{\\star}} = 0\n$$\n应用链式法则进行微分：\n$$\n\\frac{dJ}{d\\sigma^{\\star}} = \\sum_{e=1}^{4} A_e \\cdot 2 (\\sigma_{xx}^{(e)} - \\sigma^{\\star}) \\cdot \\frac{d}{d\\sigma^{\\star}}(\\sigma_{xx}^{(e)} - \\sigma^{\\star}) = \\sum_{e=1}^{4} A_e \\cdot 2 (\\sigma_{xx}^{(e)} - \\sigma^{\\star}) \\cdot (-1) = -2 \\sum_{e=1}^{4} A_e (\\sigma_{xx}^{(e)} - \\sigma^{\\star})\n$$\n将导数设为零：\n$$\n-2 \\sum_{e=1}^{4} A_e (\\sigma_{xx}^{(e)} - \\sigma^{\\star}) = 0 \\implies \\sum_{e=1}^{4} A_e (\\sigma_{xx}^{(e)} - \\sigma^{\\star}) = 0\n$$\n分配求和：\n$$\n\\sum_{e=1}^{4} A_e \\sigma_{xx}^{(e)} - \\sum_{e=1}^{4} A_e \\sigma^{\\star} = 0\n$$\n由于 $\\sigma^{\\star}$ 相对于求和索引 $e$ 是常数，因此可以从第二个和式中提取出来：\n$$\n\\sum_{e=1}^{4} A_e \\sigma_{xx}^{(e)} - \\sigma^{\\star} \\left(\\sum_{e=1}^{4} A_e\\right) = 0\n$$\n求解 $\\sigma^{\\star}$（即 $\\sigma_{xx}^{\\star}(i)$），我们得到面积加权平均应力的表达式：\n$$\n\\sigma_{xx}^{\\star}(i) = \\frac{\\sum_{e=1}^{4} A_e \\sigma_{xx}^{(e)}}{\\sum_{e=1}^{4} A_e}\n$$\n这就完成了从第一性原理出发的推导。\n\n接下来，我们使用所提供的数据来计算数值。\n面积之和为：\n$$\n\\sum_{e=1}^{4} A_e = A_1 + A_2 + A_3 + A_4 = 120~\\text{mm}^2 + 80~\\text{mm}^2 + 200~\\text{mm}^2 + 100~\\text{mm}^2 = 500~\\text{mm}^2\n$$\n分子是每个单元的面积与应力乘积之和：\n$$\n\\sum_{e=1}^{4} A_e \\sigma_{xx}^{(e)} = (120 \\cdot 95) + (80 \\cdot 110) + (200 \\cdot 85) + (100 \\cdot 130) \\quad [\\text{MPa} \\cdot \\text{mm}^2]\n$$\n$$\n\\sum_{e=1}^{4} A_e \\sigma_{xx}^{(e)} = 11400 + 8800 + 17000 + 13000 = 50200~\\text{MPa} \\cdot \\text{mm}^2\n$$\n恢复的节点应力为：\n$$\n\\sigma_{xx}^{\\star}(i) = \\frac{50200~\\text{MPa} \\cdot \\text{mm}^2}{500~\\text{mm}^2} = 100.4~\\text{MPa}\n$$\n现在我们计算未加权算术平均值 $\\overline{\\sigma}_{xx}^{\\,\\text{arith}}$：\n$$\n\\overline{\\sigma}_{xx}^{\\,\\text{arith}} = \\frac{1}{4} \\sum_{e=1}^{4} \\sigma_{xx}^{(e)} = \\frac{95 + 110 + 85 + 130}{4}~\\text{MPa}\n$$\n$$\n\\overline{\\sigma}_{xx}^{\\,\\text{arith}} = \\frac{420}{4}~\\text{MPa} = 105~\\text{MPa}\n$$\n最后，我们计算差值 $\\Delta \\sigma_{xx}$：\n$$\n\\Delta \\sigma_{xx} = \\sigma_{xx}^{\\star}(i) - \\overline{\\sigma}_{xx}^{\\,\\text{arith}} = 100.4~\\text{MPa} - 105~\\text{MPa} = -4.6~\\text{MPa}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta \\sigma_{xx} = -4.600~\\text{MPa}\n$$", "answer": "$$\n\\boxed{-4.600}\n$$", "id": "3603826"}, {"introduction": "超越简单的加权平均，我们可以采用更复杂的应力恢复技术来获得更高质量的应力场。超收敛拼片恢复（Superconvergent Patch Recovery, SPR）方法就是其中一种强大的技术，其核心思想是假设在一小块单元（拼片）上的“真实”应力场是平滑且连续的。本练习将让您亲手操作SPR方法，通过将一个连续的多项式函数拟合到单元内部高精度的超收敛点上的应力值，来构建一个更优越的应力场，并将其与简单的节点平均结果进行比较[@problem_id:3603800]。", "problem": "考虑一个二维、小应变、平面应力问题，该问题使用四节点双线性四边形单元进行离散化。一个单元片由四个全等单元组成，排列成一个 $2 \\times 2$ 的块，覆盖了角点为 $(0,0)$、$(2,0)$、$(0,2)$ 和 $(2,2)$ 的矩形域。这四个单元分别占据 $[0,1] \\times [0,1]$、$[1,2] \\times [0,1]$、$[0,1] \\times [1,2]$ 和 $[1,2] \\times [1,2]$。应力在位于单元中心的超收敛点处进行采样。在单元中心测得的正应力分量 $\\sigma_{xx}$ 的值为：\n- 单元中心位于 $(0.5,0.5)$：$\\sigma_{xx} = 10.5\\,\\mathrm{MPa}$，\n- 单元中心位于 $(1.5,0.5)$：$\\sigma_{xx} = 12.5\\,\\mathrm{MPa}$，\n- 单元中心位于 $(0.5,1.5)$：$\\sigma_{xx} = 9.5\\,\\mathrm{MPa}$，\n- 单元中心位于 $(1.5,1.5)$：$\\sigma_{xx} = 11.5\\,\\mathrm{MPa}$。\n\n使用超收敛片恢复 (SPR) 方法，通过无权最小二乘法将线性多项式 $p(x,y) = a_{0} + a_{1} x + a_{2} y$ 拟合到这四个应力样本，并计算在九个网格节点 $(x,y) \\in \\{0,1,2\\} \\times \\{0,1,2\\}$ 处的恢复节点应力。为了进行比较，定义一个简单的节点平均程序如下：对于每个节点，取共享该节点的所有相邻单元的单元中心应力的算术平均值（角节点有一个单元，边节点有两个单元，内部节点有四个单元）。计算所有九个节点上，SPR 恢复的节点应力与简单平均的节点应力之间的均方根差。以 $\\mathrm{MPa}$ 为单位表示最终的均方根差。最终答案必须是单个实数值或单个闭式解析表达式。", "solution": "用户要求我解决一个问题，其中需要计算两种节点应力恢复方案之间的均方根差：超收敛片恢复 (SPR) 和简单节点平均法。\n\n### 步骤1：提取已知条件\n- **问题类型**：二维、小应变、平面应力。\n- **离散化**：四节点双线性四边形单元。\n- **几何形状**：一个由四个全等单元组成的单元片，排列成 $2 \\times 2$ 的块。\n- **区域**：一个角点为 $(0,0)$、$(2,0)$、$(0,2)$ 和 $(2,2)$ 的矩形。\n- **单元域**：\n  - 单元 1：$[0,1] \\times [0,1]$\n  - 单元 2：$[1,2] \\times [0,1]$\n  - 单元 3：$[0,1] \\times [1,2]$\n  - 单元 4：$[1,2] \\times [1,2]$\n- **采样点**：单元中心（超收敛点）。\n- **应力数据 ($\\sigma_{xx}$)**：\n  - 在中心 $(0.5,0.5)$（单元 1）：$\\sigma_{xx} = 10.5\\,\\mathrm{MPa}$。\n  - 在中心 $(1.5,0.5)$（单元 2）：$\\sigma_{xx} = 12.5\\,\\mathrm{MPa}$。\n  - 在中心 $(0.5,1.5)$（单元 3）：$\\sigma_{xx} = 9.5\\,\\mathrm{MPa}$。\n  - 在中心 $(1.5,1.5)$（单元 4）：$\\sigma_{xx} = 11.5\\,\\mathrm{MPa}$。\n- **SPR 任务**：使用无权最小二乘法将线性多项式 $p(x,y) = a_{0} + a_{1} x + a_{2} y$ 拟合到四个应力样本。在九个节点 $(x,y) \\in \\{0,1,2\\} \\times \\{0,1,2\\}$ 处评估恢复的应力。\n- **简单平均任务**：对于每个节点，计算所有相邻单元的单元中心应力的算术平均值。\n- **最终计算**：计算所有九个节点上，SPR 恢复的节点应力与简单平均的节点应力之间的均方根差 (RMSD)。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是有限元方法中后处理技术的标准应用，特别是 Zienkiewicz-Zhu (SPR) 应力恢复方法。所有概念在计算固体力学中都是公认的。\n- **适定性**：问题是完全指定的。它提供了所有必要的数据和要遵循的程序的明确定义。最小二乘问题是超定的（4个方程，3个未知数），它有唯一的解。\n- **客观性**：问题以精确、定量的术语陈述，没有任何主观性。\n\n### 步骤3：结论和行动\n该问题在科学上是合理的，是适定的、客观的，并且不包含任何可识别的缺陷。它是**有效的**。我将继续进行求解。\n\n### 解题过程\n\n解题过程分三个阶段进行：\n1.  通过将线性多项式拟合到给定的应力数据来确定 SPR 应力场。\n2.  使用 SPR 方法和简单平均法计算恢复的节点应力。\n3.  计算两组节点应力之间的均方根差。\n\n**1. 超收敛片恢复 (SPR)**\n\n我们需要将线性多项式 $p(x,y) = a_{0} + a_{1} x + a_{2} y$ 拟合到四个数据点 $(\\sigma_{xx}, x, y)$：$(10.5, 0.5, 0.5)$、$(12.5, 1.5, 0.5)$、$(9.5, 0.5, 1.5)$ 和 $(11.5, 1.5, 1.5)$。这需要解决一个无权最小二乘问题。\n\n该问题可以写成矩阵形式 $\\mathbf{X} \\mathbf{a} \\approx \\mathbf{b}$，其中我们希望找到系数向量 $\\mathbf{a} = \\begin{pmatrix} a_0  a_1  a_2 \\end{pmatrix}^T$ 以最小化残差的欧几里得范数 $\\|\\mathbf{X} \\mathbf{a} - \\mathbf{b}\\|$。\n\n设计矩阵 $\\mathbf{X}$ 和观测向量 $\\mathbf{b}$ 为：\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  0.5  0.5 \\\\\n1  1.5  0.5 \\\\\n1  0.5  1.5 \\\\\n1  1.5  1.5\n\\end{pmatrix}, \\quad\n\\mathbf{b} = \\begin{pmatrix}\n10.5 \\\\\n12.5 \\\\\n9.5 \\\\\n11.5\n\\end{pmatrix}\n$$\n解 $\\mathbf{a}$ 由正规方程给出：$\\mathbf{X}^T \\mathbf{X} \\mathbf{a} = \\mathbf{X}^T \\mathbf{b}$。\n\n首先，我们计算 $\\mathbf{X}^T \\mathbf{X}$：\n$$\n\\mathbf{X}^T \\mathbf{X} = \\begin{pmatrix}\n1  1  1  1 \\\\\n0.5  1.5  0.5  1.5 \\\\\n0.5  0.5  1.5  1.5\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0.5  0.5 \\\\\n1  1.5  0.5 \\\\\n1  0.5  1.5 \\\\\n1  1.5  1.5\n\\end{pmatrix} = \\begin{pmatrix}\n4  4  4 \\\\\n4  5  4 \\\\\n4  4  5\n\\end{pmatrix}\n$$\n接下来，我们计算 $\\mathbf{X}^T \\mathbf{b}$：\n$$\n\\mathbf{X}^T \\mathbf{b} = \\begin{pmatrix}\n1  1  1  1 \\\\\n0.5  1.5  0.5  1.5 \\\\\n0.5  0.5  1.5  1.5\n\\end{pmatrix}\n\\begin{pmatrix}\n10.5 \\\\\n12.5 \\\\\n9.5 \\\\\n11.5\n\\end{pmatrix} = \\begin{pmatrix}\n10.5 + 12.5 + 9.5 + 11.5 \\\\\n5.25 + 18.75 + 4.75 + 17.25 \\\\\n5.25 + 6.25 + 14.25 + 17.25\n\\end{pmatrix} = \\begin{pmatrix}\n44 \\\\\n46 \\\\\n43\n\\end{pmatrix}\n$$\n现在，我们求解线性系统：\n$$\n\\begin{pmatrix}\n4  4  4 \\\\\n4  5  4 \\\\\n4  4  5\n\\end{pmatrix}\n\\begin{pmatrix}\na_0 \\\\\na_1 \\\\\na_2\n\\end{pmatrix} = \\begin{pmatrix}\n44 \\\\\n46 \\\\\n43\n\\end{pmatrix}\n$$\n从第一行，我们有 $4a_0 + 4a_1 + 4a_2 = 44$，简化为 $a_0 + a_1 + a_2 = 11$。\n第二行减去第一行得到：$(4a_0 + 5a_1 + 4a_2) - (4a_0 + 4a_1 + 4a_2) = 46 - 44$，得出 $a_1 = 2$。\n第三行减去第一行得到：$(4a_0 + 4a_1 + 5a_2) - (4a_0 + 4a_1 + 4a_2) = 43 - 44$，得出 $a_2 = -1$。\n将 $a_1 = 2$ 和 $a_2 = -1$ 代入简化的第一个方程：$a_0 + 2 - 1 = 11$，得到 $a_0 = 10$。\n\n系数为 $a_0 = 10$，$a_1 = 2$，$a_2 = -1$。恢复的 SPR 应力场为：\n$p(x,y) = 10 + 2x - y$\n\n**2. 节点应力计算**\n\n我们使用两种方法计算九个网格节点 $(x,y) \\in \\{0,1,2\\} \\times \\{0,1,2\\}$ 处的应力。\n\n**SPR 应力 ($\\sigma_{SPR}$):**\n我们将每个节点的坐标代入 $p(x,y)$：\n- $\\sigma_{SPR}(0,0) = 10 + 2(0) - 0 = 10$\n- $\\sigma_{SPR}(1,0) = 10 + 2(1) - 0 = 12$\n- $\\sigma_{SPR}(2,0) = 10 + 2(2) - 0 = 14$\n- $\\sigma_{SPR}(0,1) = 10 + 2(0) - 1 = 9$\n- $\\sigma_{SPR}(1,1) = 10 + 2(1) - 1 = 11$\n- $\\sigma_{SPR}(2,1) = 10 + 2(2) - 1 = 13$\n- $\\sigma_{SPR}(0,2) = 10 + 2(0) - 2 = 8$\n- $\\sigma_{SPR}(1,2) = 10 + 2(1) - 2 = 10$\n- $\\sigma_{SPR}(2,2) = 10 + 2(2) - 2 = 12$\n\n**简单平均应力 ($\\sigma_{AVG}$):**\n给定的单元中心应力为：$\\sigma_{c1} = 10.5$（对于位于 $[0,1] \\times [0,1]$ 的单元），$\\sigma_{c2} = 12.5$（位于 $[1,2] \\times [0,1]$），$\\sigma_{c3} = 9.5$（位于 $[0,1] \\times [1,2]$），以及 $\\sigma_{c4} = 11.5$（位于 $[1,2] \\times [1,2]$）。\n- 节点 $(0,0)$ (角节点，与单元1相邻): $\\sigma_{AVG}(0,0) = \\sigma_{c1} = 10.5$\n- 节点 $(1,0)$ (边节点，与单元1、2相邻): $\\sigma_{AVG}(1,0) = \\frac{\\sigma_{c1} + \\sigma_{c2}}{2} = \\frac{10.5 + 12.5}{2} = 11.5$\n- 节点 $(2,0)$ (角节点，与单元2相邻): $\\sigma_{AVG}(2,0) = \\sigma_{c2} = 12.5$\n- 节点 $(0,1)$ (边节点，与单元1、3相邻): $\\sigma_{AVG}(0,1) = \\frac{\\sigma_{c1} + \\sigma_{c3}}{2} = \\frac{10.5 + 9.5}{2} = 10$\n- 节点 $(1,1)$ (内部节点，与所有4个单元相邻): $\\sigma_{AVG}(1,1) = \\frac{\\sigma_{c1} + \\sigma_{c2} + \\sigma_{c3} + \\sigma_{c4}}{4} = \\frac{10.5 + 12.5 + 9.5 + 11.5}{4} = 11$\n- 节点 $(2,1)$ (边节点，与单元2、4相邻): $\\sigma_{AVG}(2,1) = \\frac{\\sigma_{c2} + \\sigma_{c4}}{2} = \\frac{12.5 + 11.5}{2} = 12$\n- 节点 $(0,2)$ (角节点，与单元3相邻): $\\sigma_{AVG}(0,2) = \\sigma_{c3} = 9.5$\n- 节点 $(1,2)$ (边节点，与单元3、4相邻): $\\sigma_{AVG}(1,2) = \\frac{\\sigma_{c3} + \\sigma_{c4}}{2} = \\frac{9.5 + 11.5}{2} = 10.5$\n- 节点 $(2,2)$ (角节点，与单元4相邻): $\\sigma_{AVG}(2,2) = \\sigma_{c4} = 11.5$\n\n**3. 均方根差 (RMSD)**\n\n均方根差 (RMSD) 是对 $N=9$ 个节点计算得出的：\n$$\n\\text{RMSD} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\sigma_{SPR,i} - \\sigma_{AVG,i})^2}\n$$\n我们来计算每个节点的平方差：\n- 节点 $(0,0)$: $(10 - 10.5)^2 = (-0.5)^2 = 0.25$\n- 节点 $(1,0)$: $(12 - 11.5)^2 = (0.5)^2 = 0.25$\n- 节点 $(2,0)$: $(14 - 12.5)^2 = (1.5)^2 = 2.25$\n- 节点 $(0,1)$: $(9 - 10)^2 = (-1)^2 = 1.0$\n- 节点 $(1,1)$: $(11 - 11)^2 = (0)^2 = 0.0$\n- 节点 $(2,1)$: $(13 - 12)^2 = (1)^2 = 1.0$\n- 节点 $(0,2)$: $(8 - 9.5)^2 = (-1.5)^2 = 2.25$\n- 节点 $(1,2)$: $(10 - 10.5)^2 = (-0.5)^2 = 0.25$\n- 节点 $(2,2)$: $(12 - 11.5)^2 = (0.5)^2 = 0.25$\n\n平方差之和为：\n$$\n\\sum (\\Delta \\sigma)^2 = 0.25 + 0.25 + 2.25 + 1.0 + 0.0 + 1.0 + 2.25 + 0.25 + 0.25 = 7.5\n$$\n均方差为：\n$$\n\\frac{1}{9} \\sum (\\Delta \\sigma)^2 = \\frac{7.5}{9} = \\frac{15/2}{9} = \\frac{15}{18} = \\frac{5}{6}\n$$\n均方根差是该值的平方根：\n$$\n\\text{RMSD} = \\sqrt{\\frac{5}{6}}\n$$\n结果的单位是 MPa。", "answer": "$$\\boxed{\\sqrt{\\frac{5}{6}}}$$", "id": "3603800"}, {"introduction": "前面介绍的加权平均和多项式拟合方法主要侧重于数据的“平滑化”，但它们恢复出的应力场不一定满足潜在的物理定律，例如平衡方程。本练习介绍了一种不同的恢复哲学：构建一个“平衡的”应力恢复场。您将推导出一个严格满足局部静态平衡方程的应力场，这项技术对于构建可靠的后验误差估计至关重要[@problem_id:3603844]。", "problem": "考虑一根用于应力恢复的、被离散为两单元补片的棱柱形线性弹性杆，其横截面积恒定。单元长度分别为 $L_{1} = 0.45\\,\\mathrm{m}$ 和 $L_{2} = 0.55\\,\\mathrm{m}$，因此该补片范围为 $x \\in [0, L]$，总长度为 $L = L_{1} + L_{2} = 1.0\\,\\mathrm{m}$。该杆受到沿 $x$ 轴方向的均布轴向体力，单位体积力为 $b = 7.85 \\times 10^{4}\\,\\mathrm{N/m^{3}}$。左端的外法向单位向量为 $n(0) = -1$，右端为 $n(L) = +1$。已知的边界单位面积面力为 $\\bar{t}(0) = -1.20 \\times 10^{8}\\,\\mathrm{Pa}$ 和 $\\bar{t}(L) = 1.199215 \\times 10^{8}\\,\\mathrm{Pa}$。\n\n从第一性原理出发，构建在整个两单元补片上的唯一线性平衡恢复应力场 $\\sigma_{\\mathrm{rec}}(x)$，该应力场需满足局部线性动量静力平衡方程以及在 $x=0$ 和 $x=L$ 处的面力边界条件。该恢复场必须是关于 $x$ 的线性函数，并且必须与给定的均布体力相平衡。\n\n将最终的恢复应力场表示为关于 $x$ 的单一显式函数，单位为帕斯卡（Pa）。无需四舍五入。", "solution": "首先将对问题进行验证，以确保其科学基础可靠、提法良好且自洽。\n\n### 步骤 1：提取已知条件\n-   单元1的长度：$L_{1} = 0.45\\,\\mathrm{m}$\n-   单元2的长度：$L_{2} = 0.55\\,\\mathrm{m}$\n-   杆的总长度：$L = L_{1} + L_{2} = 1.0\\,\\mathrm{m}$\n-   杆的域：$x \\in [0, L]$\n-   均布轴向单位体积力：$b = 7.85 \\times 10^{4}\\,\\mathrm{N/m^{3}}$\n-   左端的外法向单位向量：$n(0) = -1$\n-   右端的外法向单位向量：$n(L) = +1$\n-   左端的单位面积面力：$\\bar{t}(0) = -1.20 \\times 10^{8}\\,\\mathrm{Pa}$\n-   右端的单位面积面力：$\\bar{t}(L) = 1.199215 \\times 10^{8}\\,\\mathrm{Pa}$\n-   恢复应力场 $\\sigma_{\\mathrm{rec}}(x)$ 必须是关于 $x$ 的线性函数。\n-   $\\sigma_{\\mathrm{rec}}(x)$ 必须满足局部线性动量静力平衡（平衡）和指定的面力边界条件。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题基于一维连续介质力学的原理，并与计算固体力学中的应力恢复主题直接相关。它要求构建一个同时满足平衡微分方程和边界条件的应力场。\n\n问题要求一个唯一的线性应力场 $\\sigma_{\\mathrm{rec}}(x) = Ax + B$，其中 $A$ 和 $B$ 是常数。为了确定这两个常数，我们需要两个独立的条件。问题提供了三个条件：平衡方程和两个面力边界条件。这使得问题有可能被超定。\n\n1.  **平衡条件**：一维局部线性动量静力平衡由以下微分方程给出：\n    $$ \\frac{d\\sigma}{dx} + b = 0 $$\n    将此应用于线性恢复场可得：\n    $$ \\frac{d}{dx}(Ax + B) + b = 0 \\implies A + b = 0 \\implies A = -b $$\n\n2.  **边界条件**：面力 $\\bar{t}$ 通过柯西公式 $\\bar{t} = \\sigma n$ 与应力 $\\sigma$ 相关联。\n    -   在 $x=0$ 处：$\\bar{t}(0) = \\sigma_{\\mathrm{rec}}(0) n(0)$。由于 $n(0)=-1$，可得 $\\bar{t}(0) = -\\sigma_{\\mathrm{rec}}(0)$。\n      代入 $\\sigma_{\\mathrm{rec}}(0) = A(0) + B = B$，我们得到 $\\bar{t}(0) = -B$，即 $B = -\\bar{t}(0)$。\n    -   在 $x=L$ 处：$\\bar{t}(L) = \\sigma_{\\mathrm{rec}}(L) n(L)$。由于 $n(L)=+1$，可得 $\\bar{t}(L) = \\sigma_{\\mathrm{rec}}(L)$。\n      代入 $\\sigma_{\\mathrm{rec}}(L) = AL + B$，我们得到第三个条件：$\\bar{t}(L) = AL + B$。\n\n只有当这三个条件一致时，才存在唯一解。将 $A = -b$ 和 $B = -\\bar{t}(0)$ 的值代入第三个条件，得到一个一致性要求：\n$$ \\bar{t}(L) = (-b)L + (-\\bar{t}(0)) \\implies \\bar{t}(L) + \\bar{t}(0) + bL = 0 $$\n这个方程表示杆的整体平衡，即所有外力（来自面力和体力）的总和必须为零。让我们用给定的数值来验证这一点：\n$$ (1.199215 \\times 10^{8}\\,\\mathrm{Pa}) + (-1.20 \\times 10^{8}\\,\\mathrm{Pa}) + (7.85 \\times 10^{4}\\,\\mathrm{N/m^{3}})(1.0\\,\\mathrm{m}) $$\n$$ = (119921500 - 120000000 + 78500)\\,\\mathrm{Pa} $$\n$$ = (-78500 + 78500)\\,\\mathrm{Pa} = 0 $$\n给定的数据是一致的，并满足整体平衡。因此，该问题不是超约束的，而是提法良好的，存在唯一解。关于单个单元长度（$L_1$，$L_2$）的信息是有限元方法的背景信息，对于构建这个特定的补片级恢复场不是必需的。\n\n### 步骤 3：结论与操作\n该问题是有效的，因为它具有科学依据、提法良好且自洽。可以继续求解过程。\n\n### 求解\n目标是找到与体力 $b$ 平衡并满足面力边界条件的唯一线性恢复应力场 $\\sigma_{\\mathrm{rec}}(x)$。我们假设应力场具有以下线性形式：\n$$ \\sigma_{\\mathrm{rec}}(x) = Ax + B $$\n其中 $A$ 和 $B$ 是待定常数。\n\n首先，我们施加局部平衡条件。一维静力平衡方程为：\n$$ \\frac{d\\sigma}{dx} + b = 0 $$\n由于 $\\sigma_{\\mathrm{rec}}(x)$ 必须满足此方程，我们代入其线性形式：\n$$ \\frac{d}{dx}(Ax + B) + b = 0 $$\n$$ A + b = 0 $$\n这得到了常数 $A$：\n$$ A = -b $$\n代入给定的 $b$ 值：\n$$ A = -7.85 \\times 10^{4}\\,\\mathrm{N/m^{3}} $$\n\n接下来，我们使用边界条件来确定常数 $B$。面力 $\\bar{t}$ 和应力 $\\sigma$ 之间的关系由柯西公式给出，即 $\\bar{t} = \\sigma n$。我们在边界 $x=0$ 处应用此公式。\n$$ \\bar{t}(0) = \\sigma_{\\mathrm{rec}}(0) \\cdot n(0) $$\n已知 $\\bar{t}(0) = -1.20 \\times 10^{8}\\,\\mathrm{Pa}$ 且 $n(0) = -1$。\n$$ -1.20 \\times 10^{8}\\,\\mathrm{Pa} = \\sigma_{\\mathrm{rec}}(0) \\cdot (-1) $$\n$$ \\sigma_{\\mathrm{rec}}(0) = 1.20 \\times 10^{8}\\,\\mathrm{Pa} $$\n根据假设的应力场线性形式，我们有：\n$$ \\sigma_{\\mathrm{rec}}(0) = A(0) + B = B $$\n通过令 $\\sigma_{\\mathrm{rec}}(0)$ 的两个表达式相等，我们求得常数 $B$：\n$$ B = 1.20 \\times 10^{8}\\,\\mathrm{Pa} $$\n\n确定了常数 $A$ 和 $B$ 之后，我们现在可以构建恢复应力场的显式函数：\n$$ \\sigma_{\\mathrm{rec}}(x) = Ax + B $$\n$$ \\sigma_{\\mathrm{rec}}(x) = (-7.85 \\times 10^{4})x + (1.20 \\times 10^{8}) $$\n整理成更标准的形式：\n$$ \\sigma_{\\mathrm{rec}}(x) = 1.20 \\times 10^{8} - 7.85 \\times 10^{4} x $$\n表达式的单位是帕斯卡（Pa），符合要求。问题现已解决。关于 $L_1$ 和 $L_2$ 的信息对于此计算不是必需的，因为恢复场是根据连续介质原理在整个补片 $x \\in [0, L]$ 上定义的。", "answer": "$$\n\\boxed{1.20 \\times 10^{8} - 7.85 \\times 10^{4} x}\n$$", "id": "3603844"}]}