## 引言
在计算力学领域，为了以更少的计算成本获得更高的求解精度，高阶有限元方法（如p版本和hp版本）已成为不可或缺的先进工具。这些方法的核心，在于其独特的数学构件——等级形函数（hierarchical shape functions）。与传统h版本有限元中使用的非嵌套[节点基](@entry_id:752522)函数不同，等级形函数为系统性地提升解的逼近精度提供了优雅而高效的途径。

然而，传统有限元方法在处理具有奇异性（如[裂纹尖端](@entry_id:182807)）或需要极高精度的复杂问题时，往往面临收敛缓慢和计算量激增的瓶颈。本文旨在填补这一知识鸿沟，深入剖析等级形函数的内在机制，揭示其为何能有效克服这些挑战。

在接下来的章节中，读者将踏上一段从理论到实践的探索之旅。我们将首先在“原理与机制”一章中，从最基本的原则出发，系统地学习如何为不同类型的单元构造等级形函数。随后，在“应用与交叉学科联系”一章中，我们将见证这些理论在自适应分析、[高性能计算](@entry_id:169980)以及[多物理场耦合](@entry_id:171389)等前沿领域的强大威力。最后，“动手实践”部分将提供具体的计算练习，帮助读者巩固所学知识。现在，让我们从等级形函数最核心的原理开始。

## 原理与机制

继前一章对p版本和hp版本有限元方法的基本介绍之后，本章将深入探讨其核心构件——等级形函数（hierarchical shape functions）的内在原理与关键机制。我们将从一维问题最基本的构造原则出发，逐步扩展到复杂的多维单元和实际的有限元实现，最终阐明这些先进方法在解决挑战性工程问题（如奇异性问题和体积锁死）中的卓越性能及其背后的理论依据。

### 等级形函数的概念

传统有限元方法（h版本）通常采用**[节点基](@entry_id:752522)函数**（nodal basis functions），例如标准的拉格朗日（Lagrange）多项式。这类[基函数](@entry_id:170178)的特点是其近似空间不具有**嵌套**（nested）特性。也就是说，一个p次单元的[基函数](@entry_id:170178)与一个p+1次单元的[基函数](@entry_id:170178)是完全不同的两套函数。若要提升单元的近似阶次，必须完全抛弃旧的基底，重新构建新的单元矩阵，这在自适应计算中效率低下。

**等级形函数**（hierarchical shape functions）的核心思想是构建一系列嵌套的近似空间，记作 $\mathcal{V}^{(1)} \subset \mathcal{V}^{(2)} \subset \dots \subset \mathcal{V}^{(p)}$。这意味着，高一阶次的近似空间是通过在低阶空间的基础上**增加**（augmenting）新的[基函数](@entry_id:170178)来获得的，而非替换。这种增量式的构造方式极大地便利了p自适应和hp[自适应算法](@entry_id:142170)的实现，因为低阶次的[单元刚度矩阵](@entry_id:139369)可以作为高阶次矩阵的一个子块被重复利用。

为了理解等级构造的根本原则，我们考察最简单的[一维杆单元](@entry_id:171268)，其参考域为 $\xi \in [-1, 1]$。一个线性（$p=1$）单元的近似解可以由两个[节点基](@entry_id:752522)函数表示：
$$
N_1(\xi) = \frac{1}{2}(1-\xi), \quad N_2(\xi) = \frac{1}{2}(1+\xi)
$$
这两个函数满足在节点 $\xi_1 = -1$ 和 $\xi_2 = 1$ 处的克罗内克-德尔塔（Kronecker-delta）性质，即 $N_i(\xi_j) = \delta_{ij}$。因此，近似解 $u_h^{(p=1)}(\xi) = d_1 N_1(\xi) + d_2 N_2(\xi)$ 的自由度 $d_1$ 和 $d_2$ 直接对应于单元端点的节点值，即 $d_1 = u_h(-1)$ 和 $d_2 = u_h(1)$。

现在，我们希望将这个线性基底提升为二次（$p=2$）。在等级框架下，我们保留 $N_1$ 和 $N_2$，并引入一个新的**内部模态**（internal mode）或**[气泡函数](@entry_id:176111)**（bubble function）$N_3(\xi)$。二次近似解的形式为：
$$
u_h^{(p=2)}(\xi) = d_1 N_1(\xi) + d_2 N_2(\xi) + d_3 N_3(\xi)
$$
一个至关重要的要求是，增加 $N_3$ 不应改变原有自由度 $d_1$ 和 $d_2$ 作为端点值的物理意义。换言之，即使引入了三次项，我们仍然希望 $u_h^{(p=2)}(-1) = d_1$ 和 $u_h^{(p=2)}(1) = d_2$。让我们来检验这个条件：
在 $\xi = -1$ 处：
$$
u_h^{(p=2)}(-1) = d_1 N_1(-1) + d_2 N_2(-1) + d_3 N_3(-1) = d_1(1) + d_2(0) + d_3 N_3(-1) = d_1 + d_3 N_3(-1)
$$
为了使 $u_h^{(p=2)}(-1) = d_1$，必须有 $d_3 N_3(-1) = 0$。同理，在 $\xi = 1$ 处求值可得 $d_2 + d_3 N_3(1) = d_2$，这意味着 $d_3 N_3(1) = 0$。由于内部自由度 $d_3$ 可以取任意值，上述两个条件要想普遍成立，唯一的可能是形函数 $N_3(\xi)$ 本身在两个端点处为零：
$$
N_3(-1) = 0 \quad \text{and} \quad N_3(1) = 0
$$
这个**端点消失特性**是所有内部模态（或[气泡函数](@entry_id:176111)）必须满足的基本要求。它确保了高阶项的引入不会“污染”低阶节点自由度的物理解释，从而维持了基底的等级结构 [@problem_id:2538579]。对于二次函数，任何形如 $C(\xi^2 - 1)$（其中 $C$ 为非零常数）的多项式都满足此条件，例如 $1-\xi^2$ 或 $\frac{1}{2}(\xi^2 - 1)$ 都是合格的二次[气泡函数](@entry_id:176111)。

### 等级[基函数](@entry_id:170178)的构造

基于上述原则，我们可以为不同类型的单元系统地构造等级[基函数](@entry_id:170178)。

#### 一维[基函数](@entry_id:170178)

对于一维参考单元 $[-1,1]$，一个完整的p阶等级基底通常包含：
1.  **节点模态 (Nodal Modes)**：两个线性函数 $N_1(\xi)$ 和 $N_2(\xi)$，与单元的顶点相关联。
2.  **内部模态 (Internal Modes)**：$p-1$个p阶或更低阶的多项式，它们在 $\xi = \pm 1$ 处均为零。一个经典的构造方法是使用积分勒让德多项式（Integrated Legendre Polynomials）。例如，形如 $\phi_k(s) = \alpha_k (P_{k-1}(s) - P_{k+1}(s))$ (其中 $k \ge 2$) 的函数族，通过[勒让德多项式](@entry_id:141510)的递推关系可知其在端点处为零，并且可以选择合适的系数使其具有正交性 [@problem_id:3570988]。

#### 二维及三维[张量积](@entry_id:140694)[基函数](@entry_id:170178)

对于矩形（四边形）和长方体（六面体）单元，等级[基函数](@entry_id:170178)可以通过一维[基函数](@entry_id:170178)的**张量积**（tensor product）方便地构造。我们将一维[基函数](@entry_id:170178)分为两类：节点函数（如 $N_1, N_2$）和内部/[气泡函数](@entry_id:176111)（如 $\phi_k, k \ge 2$）。三维[六面体单元](@entry_id:174602) $\hat{\Omega}=[-1,1]^3$ 上的[基函数](@entry_id:170178) $\Psi(\xi, \eta, \zeta)$ 可写作 $\psi_i(\xi) \psi_j(\eta) \psi_k(\zeta)$ 的形式，其中 $\psi$ 来自一维[基函数](@entry_id:170178)集。根据参与张量积的函数类型，三维[基函数](@entry_id:170178)可按拓扑实体进行分类 [@problem_id:3570957]：

*   **顶点模态 (Vertex Modes)**：由三个节点函数相乘得到，例如 $N_v = N_1(\xi)N_2(\eta)N_1(\zeta)$。这种函数仅在一个顶点上为1，在所有其他顶点上为0。一个六面体有8个顶点，因此有8个顶点模态。

*   **边模态 (Edge Modes)**：由一个一维内部模态和两个一維节点函数相乘得到，例如 $N_e = \phi_k(\xi)N_1(\eta)N_1(\zeta)$ ($k \ge 2$)。该函数在 $(\eta, \zeta) = (-1, -1)$ 这条边上非零，但在其端点（顶点）以及所有其他边、面、顶点上均为零。一个六面体有12条边，每条边对应 $p-1$ 个内部模态，总计 $12(p-1)$ 个边模态。

*   **面模态 (Face Modes)**：由两个一维内部模态和一个一维节点函数相乘得到，例如 $N_f = N_2(\xi)\phi_j(\eta)\phi_k(\zeta)$ ($j, k \ge 2$)。该函数在 $\xi=1$ 这个面上非零，但在该面的边界（即四条边）以及所有其他面上均为零。一个六面体有6个面，每个面对应 $(p-1)^2$ 个内部模态，总计 $6(p-1)^2$ 个面模态。

*   **体模态 (Interior Modes)**：由三个一维内部模态相乘得到，例如 $N_i = \phi_i(\xi)\phi_j(\eta)\phi_k(\zeta)$ ($i, j, k \ge 2$)。该函数在单元的整个边界上（所有六个面）均为零。一个六面体有 $(p-1)^3$ 个体模态。

将所有模态加总，一个p阶[六面体单元](@entry_id:174602)的总自由度数目为 $D(p) = 8 + 12(p-1) + 6(p-1)^2 + (p-1)^3$，通过[二项式展开](@entry_id:269603)可以惊奇地发现，这恰好等于 $(p+1)^3$，这正是p阶张量积多项式空间 $Q_p$ 的维度。这种按拓扑实体（顶点、边、面、体）的分解是等级[基函数](@entry_id:170178)的一个标志性特征。

#### 单纯形[基函数](@entry_id:170178)

对于三角形和四面体等单纯形单元，无法使用张量积构造。此时，**[重心坐标](@entry_id:155488)**（barycentric coordinates）成为构造[基函数](@entry_id:170178)的有力工具。以参考四面体为例，其上的任意一点可由四个顶点 $V_1, V_2, V_3, V_4$ 的[重心坐标](@entry_id:155488) $(\lambda_1, \lambda_2, \lambda_3, \lambda_4)$ 表示，满足 $\sum \lambda_i = 1$ 且 $\lambda_i \ge 0$。$\lambda_i=0$ 定义了与顶点$V_i$相对的面。

利用[重心坐标](@entry_id:155488)，同样可以构造出与拓扑实体关联的等级[基函数](@entry_id:170178) [@problem_id:3571020]：

*   **顶点模态**：即线性形函数 $\varphi_i^{(v)} = \lambda_i$。它在顶点 $V_i$ 处为1，在其他顶点处为0。

*   **边模态**：与连接 $V_i$ 和 $V_j$ 的边关联的模态，形如 $\varphi_{ij,m}^{(e)} = \lambda_i \lambda_j P_m(\dots)$。因子 $\lambda_i \lambda_j$ 确保了该函数在所有不包含此边的面上为零，并且在该边自身的两个端点（$V_i, V_j$）处也为零，从而形成沿边的“气泡”函数。

*   **面模态**：与 $V_i, V_j, V_k$ 构成的面关联的模态，形如 $\varphi_{ijk,\alpha,\beta}^{(f)} = \lambda_i \lambda_j \lambda_k P_{\alpha,\beta}(\dots)$。因子 $\lambda_i \lambda_j \lambda_k$ 确保了函数在该面的边界（三条边）上为零。

*   **体模态**：形如 $\varphi_{\ell}^{(b)} = \lambda_1 \lambda_2 \lambda_3 \lambda_4 q_\ell(\dots)$。因子 $\lambda_1 \lambda_2 \lambda_3 \lambda_4$ 确保了函数在四面体的所有四个面上（即整个边界）均为零。

无论是张量积还是单纯形，构造等级[基函数](@entry_id:170178)的核心策略都是一致的：利用坐标乘积来精确[控制函数](@entry_id:183140)在单元边界上的消失行为，从而将其与特定的拓扑实体唯一地关联起来。

### 等级基与[节点基](@entry_id:752522)的等价性

尽管构造方式和自由度的物理解释不同，但对于给定的单元和多项式阶次 $p$，等级（模态）基底和标准的拉格朗日（节点）基底实际上张成了**完全相同**的[多项式空间](@entry_id:144410) $\mathcal{P}_p$。这意味着两种表示是等价的，并且可以相互转换。

考虑一个p阶多项式近似 $u(\xi)$，它可以表示为[模态基](@entry_id:752055) $\lbrace m_j(\xi) \rbrace_{j=0}^p$ 的[线性组合](@entry_id:154743)（模态展开），也可以通过其在 $p+1$ 个不同插值点 $\lbrace \xi_i \rbrace_{i=0}^p$ 上的值（节点展开）来唯一确定。模态展开为 $u(\xi) = \sum_{j=0}^{p} a_j m_j(\xi)$，其中 $\mathbf{a} = [a_0, \dots, a_p]^\top$ 是[模态系数](@entry_id:752057)向量。在各个插值点 $\xi_i$ 处对该式求值，我们得到一组线性方程：
$$
u(\xi_i) = \sum_{j=0}^{p} a_j m_j(\xi_i), \quad \text{for } i = 0, 1, \dots, p
$$
这可以写成矩阵形式 $\mathbf{u} = V \mathbf{a}$，其中 $\mathbf{u} = [u(\xi_0), \dots, u(\xi_p)]^\top$ 是节点值向量，而 $V$ 是一个**广义范德蒙德矩阵**（generalized Vandermonde matrix），其元素为 $V_{ij} = m_j(\xi_i)$ [@problem_id:3570950]。

根据[代数基本定理](@entry_id:152321)，一个非零的p次多项式最多有p个根。如果 $V\mathbf{a} = \mathbf{0}$，则意味着多项式 $u(\xi) = \sum a_j m_j(\xi)$ 在 $p+1$ 个不同的点 $\xi_i$ 处为零。这迫使 $u(\xi)$ 必须是零多项式。由于 $\lbrace m_j \rbrace$ 是一组[基函数](@entry_id:170178)（线性无关），这進而要求所有系数 $a_j$ 都为零，即 $\mathbf{a}=\mathbf{0}$。因此，矩阵 $V$ 是非奇异的（可逆的）。

$V$ 的[可逆性](@entry_id:143146)建立了[模态系数](@entry_id:752057) $\mathbf{a}$ 与节点值 $\mathbf{u}$ 之间的[一一对应](@entry_id:143935)关系（$\mathbf{u}=V\mathbf{a}$ 和 $\mathbf{a}=V^{-1}\mathbf{u}$），从而证明了两种表示的等价性。更有趣的是，这个关系也揭示了如何用[模态基](@entry_id:752055)来表示[节点基](@entry_id:752522)。一个拉格朗日[节点基](@entry_id:752522)函数 $N_k(\xi)$ 本身也是一个p阶多項式，其节点值向量是第k个[标准基向量](@entry_id:152417) $\mathbf{e}_k$（即在第k个节点为1，其他节点为0）。因此，表示 $N_k(\xi)$ 的[模态系数](@entry_id:752057)向量 $\mathbf{c}^{(k)}$ 满足 $V \mathbf{c}^{(k)} = \mathbf{e}_k$，解得 $\mathbf{c}^{(k)} = V^{-1}\mathbf{e}_k$。这说明，[拉格朗日基](@entry_id:751105)函数 $N_k(\xi)$ 在[模态基](@entry_id:752055)下的系数向量，恰好是转换矩阵 $V$ 的逆矩阵的第k列 [@problem_id:3570950]。

### 有限元实现中的关键机制

将等级形函数应用于实际的有限元计算时，需要考虑几个关键的机制，这些机制保证了数值解的正确性和[计算效率](@entry_id:270255)。

#### $C^0$连续性与组装

有限元解若要属于能量空间 $H^1(\Omega)$，必须在整个求解域上是$C^0$连续的。这意味着在任何两个相邻单元的公共界面 $\Gamma$ 上，位移场的跳跃 $\llbracket u_h \rrbracket$ 必须为零，即界面两侧的迹（trace）必须完全匹配。

这一要求决定了自由度（DOFs）如何在单元间共享。我们已经知道，单元内部模态（体模态）在其所属单元的边界上恒为零，因此它们的迹为零。这意味着内部模态对单元间的连续性没有任何贡献，它们的自由度是**纯单元局部**的，不与任何其他单元耦合 [@problem_id:3570961]。

然而，顶点、边和面模态在单元边界上的迹不为零。为了保证在整个公共界面（例如，一条边或一个面）上迹相等，仅仅共享公共顶点上的自由度是不够的。必须保证与该界面相关的所有模态（即顶点、边、面模态）的自由度在相邻单元间都是**共享**的。例如，在二维问题中，两个共享一条边的单元，必须共享该边两个端点的顶点自由度，以及与该边关联的所有边模态的自由度。

实现这种共享时还有一个微妙之处：**方向性**（orientation）。边模态和面模态通常是根据界面上的局部坐标系定义的。如果两个相邻单元对公共边的[局部坐标](@entry_id:181200)定义方向相反（例如，一个是从顶点A到B，另一个是从B到A），那么奇数阶的[基函数](@entry_id:170178)可能会因为坐标反转而改变符号。例如，一个一维边模态 $B_k(s)$ 可能满足 $B_k(-s) = (-1)^{k-1} B_k(s)$ 的奇偶性关系 [@problem_id:3570988]。为了确保迹匹配，自由度的约束必须考虑这个方向。若单元(1)和(2)的[局部坐标](@entry_id:181200)关系为 $s^{(2)} = \sigma s^{(1)}$（其中 $\sigma = \pm 1$ 是方向指示符），则两个单元的边[模态系数](@entry_id:752057) $a_k^{(1)}$ 和 $a_k^{(2)}$ 之间必须满足约束关系 $a_k^{(1)} - \sigma^{k-1} a_k^{(2)} = 0$。因此，在有限元程序集成的过程中，必须建立一套全局一致的边和面方向约定，以正确地施加连续性约束。

#### [等参映射](@entry_id:173239)

在实践中，物理单元很少是理想的方形或立方体。我们通过**[等参映射](@entry_id:173239)**（isoparametric mapping） $\mathbf{x} = \mathbf{x}(\hat{\boldsymbol{\xi}})$ 将[参考单元](@entry_id:168425) $\hat{K}$（如单位正方形）映射到物理空间中的任意（扭曲）单元 $K$。形函数和它们的梯度也需要通过这个映射进行转换。

一个在参考单元上定义的形函数 $\hat{N}(\hat{\boldsymbol{\xi}})$ 对应于物理单元上的函数 $N(\mathbf{x})$，两者通过复合关系 $N(\mathbf{x}(\hat{\boldsymbol{\xi}})) = \hat{N}(\hat{\boldsymbol{\xi}})$ 联系起来。我们更关心的是梯度的转换，因为它直接关系到应变和[单元刚度矩阵](@entry_id:139369)的计算。根据多元微积分的[链式法则](@entry_id:190743)，物理坐标下的梯度 $\nabla_{\mathbf{x}} N$ 和参考坐标下的梯度 $\nabla_{\hat{\boldsymbol{\xi}}} \hat{N}$ 之间存在如下关系 [@problem_id:3570972]：
$$
\nabla_{\hat{\boldsymbol{\xi}}} \hat{N} = \mathbf{J}^T \nabla_{\mathbf{x}} N
$$
其中 $\mathbf{J} = \frac{\partial \mathbf{x}}{\partial \hat{\boldsymbol{\xi}}}$ 是[等参映射](@entry_id:173239)的雅可比矩阵（Jacobian matrix）。求解物理梯度可得：
$$
\nabla_{\mathbf{x}} N = (\mathbf{J}^T)^{-1} \nabla_{\hat{\boldsymbol{\xi}}} \hat{N} = (\mathbf{J}^{-1})^T \nabla_{\hat{\boldsymbol{\xi}}} \hat{N}
$$
这个公式是计算[单元刚度矩阵](@entry_id:139369)的核心。

#### 映射对单元矩阵的影响

[等参映射](@entry_id:173239)不仅转换了梯度，还通过雅可比行列式 $\det(\mathbf{J})$ 影响了积分计算，这對基[函数的正交性](@entry_id:160337)有深远影响。例如，[单元质量矩阵](@entry_id:748930)的项为 $M_{ij} = \int_K N_i N_j d\mathbf{x}$。转换到[参考单元](@entry_id:168425)上，它变为：
$$
M_{ij} = \int_{\hat{K}} \hat{N}_i(\hat{\boldsymbol{\xi}}) \hat{N}_j(\hat{\boldsymbol{\xi}}) \det(\mathbf{J}(\hat{\boldsymbol{\xi}})) d\hat{\boldsymbol{\xi}}
$$
即使我们精心构造的等级[基函数](@entry_id:170178) $\lbrace \hat{N}_i \rbrace$ 在[参考单元](@entry_id:168425)上关于单位权重是正交的（即 $\int_{\hat{K}} \hat{N}_i \hat{N}_j d\hat{\boldsymbol{\xi}} = \delta_{ij}$），它们在物理单元上的正交性通常也会被破坏。这是因为积分中出现了[雅可比行列式](@entry_id:137120) $\det(\mathbf{J})$ 这个**非恒定的权重函数**。

对于一个[双线性](@entry_id:146819) isoparametric 四边形，$\det(\mathbf{J})$ 是 $\xi$ 和 $\eta$ 的双线性函数 [@problem_id:3570985]。只有当单元是平行四边形时，映射是仿射的（affine），$\det(\mathbf{J})$ 才是一个常数。在这种特殊情况下，参考单元上的正交性得以保持，[单元质量矩阵](@entry_id:748930)是对角的。然而，对于一般的扭曲四边形，$\det(\mathbf{J})$ 是变化的，它会引入不同模态之间的耦合，导致原本对角的[质量矩阵](@entry_id:177093)（对于内部模态）变得稠密。同样的耦合效应也存在于[刚度矩阵](@entry_id:178659)中，因为其积分项也包含 $\det(\mathbf{J})$ 以及依赖于 $\hat{\boldsymbol{\xi}}$ 的 $\mathbf{J}^{-1}$。这种几何引入的耦合是p版本有限元中一个重要的实际考虑因素。

### 计算性能与高阶应用

等级形函数的设计不仅在理论上优雅，更在计算实践中带来了显著的优势，并使其成为解决特定领域难题的利器。

#### 矩阵[稀疏性](@entry_id:136793)与[静态凝聚](@entry_id:176722)

一个常见的误解是，由于等级[基函数](@entry_id:170178)（特别是[高阶模](@entry_id:750331)态）的支撑域更广，它们可能会导致比[节点基](@entry_id:752522)更稠密的[全局刚度矩阵](@entry_id:138630)。然而，由于两种基底张成了相同的函数空间，全局自由度之间的耦合关系（即刚度矩阵的稀疏模式）在拓扑上是等价的。两个全局自由度 $i$ 和 $j$ 之间存在耦合（$K_{ij} \neq 0$）的充要条件是它们对应的[基函数](@entry_id:170178)支撑域相交。这个条件取决于网格的拓扑结构，而与基底的具体选择无关。因此，对于相同的网格和阶次，使用等级基或[节点基](@entry_id:752522)产生的[全局刚度矩阵](@entry_id:138630)，其非零元的数量和[分布](@entry_id:182848)模式是相同的（在自由度重排序的意义下）[@problem_id:3571006]。

等级基的真正优势在于其独特的结构，这种结构使得**[静态凝聚](@entry_id:176722)**（static condensation）技术得以自然应用。我们已经知道，内部模態（体、面、边）的自由度是纯粹局限于单个单元或单个界面上的。特别是体模态，它们只与同一单元内的其他模态耦合。这意味着，如果我们将自由度按顶点、边、面、体进行分组，[全局刚度矩阵](@entry_id:138630)会呈现出一种箭头形的块状结构。我们可以在单元层面，通过求解一个小型线性系统，将所有内部自由度用界面自由度（顶点、边、面）表示出来，然后从全局系统中**消去**（eliminate）这些内部自由度。这个过程就是[静态凝聚](@entry_id:176722)。

[静态凝聚](@entry_id:176722)后得到的全局系统只包含界面自由度，其规模大大减小，[条件数](@entry_id:145150)也得到改善，从而显著降低了求解成本。这是等级[基函数](@entry_id:170178)相比于[节点基](@entry_id:752522)函数的一个重大计算优势。

#### p-版本与体积锁死

在求解近乎[不可压缩材料](@entry_id:159741)（[泊松比](@entry_id:158876) $\nu \to 0.5$）的弹性力学问题时，标准的位移有限元法会遭遇**体积锁死**（volumetric locking）现象：数值解变得异常僵硬，无法收敛到正确结果。其根源在于，当[体积模量](@entry_id:160069) $\kappa$ 趋于无穷大时，[能量泛函](@entry_id:170311)中的体积项 $\int_\Omega \kappa (\operatorname{div} \mathbf{u})^2 d\Omega$ 强制离散解的散度 $\operatorname{div} \mathbf{u}_h$ 处处为零。对于低阶单元，满足此约束的离散位移空间（即离散无散度空间）可能过于贫乏，甚至只包含零位移，从而锁死整个系统。

等级[基函数](@entry_id:170178)为解决此问题提供了理想的框架 [@problem_id:3571007]。有效的策略是采用**混合 formulation**，引入压力 $p$作为[独立变量](@entry_id:267118)，或采用等价的**假设应变**（assumed strain）方法。

*   **混合位移-压力 formulation**：最成功的一类方法是基于满足LBB（Ladyzhenskaya-Babuška-Brezzi）稳定条件的混合单元。例如，选择p阶连续等级多项式作为位移空间 $\mathcal{V}_h^{(p)}$，并选择 $p-1$ 阶**不连续**多项式作为压力空间 $\mathcal{Q}_h^{(p-1)}$。这种p次位移/p-1次压力的组合被证明是LBB稳定的，可以得到对 $\kappa$ 鲁棒的、无锁死的收敛解。等级基的层次结构使得实现這種多阶次组合变得非常自然。

*   **$\bar{B}$方法**：这种假设应变方法在效果上等价于混合法。它在计算体积能时，不用原始的 $\operatorname{div}\mathbf{u}_h$，而是用其在一个低阶不连续[多项式空间](@entry_id:144410)（例如 $p-1$ 阶）上的$L^2$投影。这同样放宽了过强的离散[无散度约束](@entry_id:748603)，从而消除了锁死。

#### [hp-自适应](@entry_id:750398)的动机：奇异性问题

p版本和hp版本有限元方法发展的最终极、最强大的动机，在于它们处理带**奇异性**（singularity）问题的超凡能力。在工程实践中，由于几何（如凹角、裂纹尖端）或载荷的突变，许多问题的解在局部区域不光滑，其导数可能趋于无穷。

以一个包含凹角（角度 $\omega \gt \pi$）的二维弹性体为例，解在角点附近的[位移场](@entry_id:141476)表现为 $u(r, \theta) \sim r^\lambda \Psi(\theta)$，其中 $r$ 是到角点的距离，奇异性指数 $\lambda \in (0,1)$。由于 $r^\lambda$ 项的存在，解的 Sobolev 正则性被限制在 $H^{1+\lambda}$，而不是光滑的 $H^k$ ($k \gg 1$) [@problem_id:3570952]。

对于这类非光滑解，传统方法的表现如下：
*   **均匀h-refinement**（固定p，加密网格）：由于奇异性的“污染”，能量误差的[收敛率](@entry_id:146534)是代数的且非常缓慢，约为 $\mathcal{O}(N^{-\lambda/2})$，其中 $N$ 是总自由度。
*   **均匀p-refinement**（固定网格，提高阶次）：同样受奇异性污染，高阶多项式无法有效逼近非解析的 $r^\lambda$ 函数。[收敛率](@entry_id:146534)同样是缓慢的代数级别，约为 $\mathcal{O}(N^{-\lambda/2})$。

而**[hp-自适应](@entry_id:750398)**策略则能出色地克服这一困难，恢复[指数[收](@entry_id:142080)敛率](@entry_id:146534)。其[最优策略](@entry_id:138495)是：
1.  在[奇异点](@entry_id:199525)（如凹角）附近，采用**几何 graded 网格**，即单元尺寸随着接近[奇异点](@entry_id:199525)的距离呈[几何级数](@entry_id:158490)递减。这是一种强烈的h-refinement，它能有效地用低阶多项式捕捉 $r^\lambda$ 的行为。在这些小单元上，保持较低的 polynomial degree $p$ 即可。
2.  在远离[奇异点](@entry_id:199525)的光滑区域，解是解析的。在这里，p-refinement的威力得以充分发挥。在这些较大的单元上，应**提高多项式阶次p**，以实现对光滑解的指数逼近。

通过这种“双管齐下”的策略——在奇异区用h-refinement，在光滑区用p-refinement——hp-FEM能够实现能量误差的[指数收敛](@entry_id:142080)，通常形如 $\mathcal{O}(\exp(-\gamma N^{1/3}))$。这种逼近非光滑解的卓越效率，是发展和应用等级形函数与hp-FEM的根本动力所在。