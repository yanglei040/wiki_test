## 引言
在现代工程与[科学计算](@entry_id:143987)中，将[计算机辅助设计](@entry_id:157566)（CAD）中的精确几何模型无缝集成到[数值分析](@entry_id:142637)中，是提高模拟保真度和效率的关键。[等几何分析](@entry_id:752839)（Isogeometric Analysis, IGA）正是为此而生，它通过统一使用NURBS等[样条](@entry_id:143749)[基函数](@entry_id:170178)来描述几何和逼近物理场，打破了传统[有限元分析](@entry_id:138109)中几何近似与[网格生成](@entry_id:149105)之间的壁垒。然而，尽管NURBS在几何表示上极为强大，其标准的[张量积](@entry_id:140694)结构却带来了一个严峻挑战：当需要对模型的局部区域（如[应力集中](@entry_id:160987)点或裂纹尖端）进行网格加密以提高精度时，加密操作会不可避免地传播至整个模型，引入大量不必要的自由度，从而极大地浪费了计算资源。这一知识缺口催生了对真正局部加密技术的研究。

本文旨在系统性地介绍并深入剖析解决这一难题的核心技术——[T样条](@entry_id:755791)及其在[等几何分析](@entry_id:752839)中的应用。通过本文的学习，读者将全面了解从传统样条到高级局部加密方法的演进路径。第一章“原理与机制”将详细阐述[B样条](@entry_id:172303)、[NURBS](@entry_id:174125)以及分析适应性[T样条](@entry_id:755791)（ASTS）的数学原理，揭示其如何实现局部加密并保持分析所需的优良性质。第二章“应用与跨学科连接”将展示[T样条](@entry_id:755791)如何在计算力学、高性能计算和自适应求解等领域解决实际工程问题，并与其他学科产生联系。最后，第三章“动手实践”提供了一系列精心设计的问题，帮助读者巩固理论知识。本文将引导读者从基础概念出发，逐步掌握[等几何分析](@entry_id:752839)中局部加密的前沿理论与实践。

## 原理与机制

在[等几何分析](@entry_id:752839)（Isogeometric Analysis, IGA）的框架中，几何表示与分析求解所使用的[基函数](@entry_id:170178)是统一的，这要求我们采用能够精确描述复杂几何并具备良好分析性质的[基函数](@entry_id:170178)。本章旨在深入阐述[等几何分析](@entry_id:752839)中[基函数](@entry_id:170178)的构建原理，重点探讨从标准[B样条](@entry_id:172303)和非均匀有理B样条（[NURBS](@entry_id:174125)）到支持局部加密的高级方法（如[T样条](@entry_id:755791)）的演进、关键机制与实际应用。

### [B样条](@entry_id:172303)与NURBS[基函数](@entry_id:170178)的构建

[等几何分析](@entry_id:752839)的基础构建于计算机辅助设计（CAD）中成熟的样条技术。其中，**[B样条](@entry_id:172303)**（B-splines）[基函数](@entry_id:170178)因其优越的性质——如局部支撑性、非负性、[单位分解](@entry_id:150115)性以及可调的连续性——而成为核心。

#### [B样条基函数](@entry_id:164756)及其性质

[B样条基函数](@entry_id:164756)是通过**[Cox-de Boor递推公式](@entry_id:162935)**定义的。给定一个由非递减参数值组成的**[节点向量](@entry_id:176218)**（knot vector）$\Xi = \{\xi_0, \xi_1, \dots, \xi_m\}$，次数为 $p$ 的第 $i$ 个[B样条基函数](@entry_id:164756) $N_{i,p}(x)$ 定义如下：

对于 $p=0$：
$$
N_{i,0}(x) = \begin{cases} 1  \text{若 } \xi_i \le x \lt \xi_{i+1} \\ 0  \text{其他} \end{cases}
$$

对于 $p > 0$：
$$
N_{i,p}(x) = \frac{x - \xi_i}{\xi_{i+p} - \xi_i} N_{i,p-1}(x) + \frac{\xi_{i+p+1} - x}{\xi_{i+p+1} - \xi_{i+1}} N_{i+1,p-1}(x)
$$
其中，约定任何形如 $\frac{0}{0}$ 的项均取值为 $0$。

[B样条基函数](@entry_id:164756)具有几个关键性质：
1.  **局部支撑性**：[基函数](@entry_id:170178) $N_{i,p}(x)$ 的支撑区间为 $[\xi_i, \xi_{i+p+1}]$，意味着它仅在参[数域](@entry_id:155558)的一个局部范围内非零。
2.  **非负性**：在支撑区间内，$N_{i,p}(x) \ge 0$。
3.  **[单位分解](@entry_id:150115)性**（Partition of Unity）：在参数域的任意一点，所有非零[基函数](@entry_id:170178)的和恒为1，即 $\sum_{i} N_{i,p}(x) = 1$。

为了具体理解这些性质，我们考虑一个二次（$p=2$）[B样条基函数](@entry_id:164756)的构建实例。给定一个**开放均匀[节点向量](@entry_id:176218)** $\Xi = [0,0,0,1,2,3,3,3]$。这种[节点向量](@entry_id:176218)在边界处重复 $p+1$ 次，确保了曲[线或](@entry_id:170208)[曲面](@entry_id:267450)能够插值其端点控制点。通过[Cox-de Boor公式](@entry_id:637598)，我们可以推导出定义在该[节点向量](@entry_id:176218)上的所有二次[B样条基函数](@entry_id:164756) $N_{i,2}(x)$ 的具体[分段多项式](@entry_id:634113)表达式。在计算之后，可以验证在整个参[数域](@entry_id:155558) $[0,3]$ 上，这些[基函数](@entry_id:170178)之和 $S(x) = \sum_{i} N_{i,2}(x)$ 恒等于 $1$。这一单位分解性质对于保证[几何映射](@entry_id:749852)能够精确重现刚体运动至关重要，并且是分析方法（如[有限元法](@entry_id:749389)）通过**[分片检验](@entry_id:162864)**（patch test）的必要条件 [@problem_id:3594359]。

#### 非均匀有理B样条（NURBS）

尽管[B样条](@entry_id:172303)功能强大，但它们无法精确表示除抛物线之外的二次曲线，例如圆形、椭圆等。为了克服这一限制，引入了**[非均匀有理B样条](@entry_id:174125)**（Non-Uniform Rational B-Splines, NURBS）。NURBS通过为每个控制点 $\mathbf{P}_i$ 分配一个权重 $w_i > 0$ 来推广[B样条](@entry_id:172303)。[NURBS](@entry_id:174125)有理[基函数](@entry_id:170178) $R_{i,p}(u)$ 定义为：
$$
R_{i,p}(u) = \frac{w_i N_{i,p}(u)}{\sum_{j} w_j N_{j,p}(u)}
$$
[NURBS](@entry_id:174125)曲[线或](@entry_id:170208)[曲面](@entry_id:267450)的[几何映射](@entry_id:749852) $\mathbf{x}(u)$ 则是控制点与有理[基函数](@entry_id:170178)的加权平均：
$$
\mathbf{x}(u) = \sum_{i} R_{i,p}(u) \mathbf{P}_i
$$
通过精心选择控制点位置和权重，[NURBS](@entry_id:174125)可以精确表示所有二次曲线。一个经典例子是使用二次[NURBS](@entry_id:174125)精确表示一个四分之一单位圆。例如，给定控制点 $\mathbf{P}_0=(1,0)$, $\mathbf{P}_1=(1,1)$, $\mathbf{P}_2=(0,1)$，权重 $w_0=1$, $w_1=1/\sqrt{2}$, $w_2=1$，以及[节点向量](@entry_id:176218) $\Xi=[0,0,0,1,1,1]$，可以证明生成的[NURBS](@entry_id:174125)曲线 $\mathbf{x}(u)$ 满足 $x(u)^2 + y(u)^2 = 1$，从而精确地参数化了从 $(1,0)$ 到 $(0,1)$ 的圆弧 [@problem_id:3594408]。这种精确几何[表示能力](@entry_id:636759)是[等几何分析](@entry_id:752839)的核心优势之一。

在进行分析计算时，我们需要在物理空间 $\Omega$ 上进行积分，这就需要建立参数空间与物理空间之间的[微分](@entry_id:158718)关系。这个关系由**雅可比矩阵**（Jacobian matrix）的[行列式](@entry_id:142978) $J$ 描述。对于一维曲线 $\mathbf{x}(u)$，雅可比行列式是参数空间到[弧长](@entry_id:191173)的映射因子，$J(u) = \|\mathrm{d}\mathbf{x}/\mathrm{d}u\|$。对于上述四分之一圆的例子，我们可以从其NURBS定义出发，通过求导计算出在任意参数点（例如 $u=1/2$）的[雅可比](@entry_id:264467)值 [@problem_id:3594408]。

### 标准[B样条](@entry_id:172303)基的加密策略

为了在求解中提高精度，尤其是在解的梯度变化剧烈的区域，我们需要加密分析网格。在IGA中，这对应于加密[样条](@entry_id:143749)基。对于标准的张量积[B样条](@entry_id:172303)或NURBS，主要有三种加密策略 [@problem_id:3594401]：

1.  **h-加密**（h-refinement）：也称为**[节点插入](@entry_id:751052)**（knot insertion），即在保持多项式次数 $p$ 不变的情况下，向[节点向量](@entry_id:176218)中添加新的节点。每插入一个新节点，就会增加一个[基函数](@entry_id:170178)（自由度），同时减小受影响[基函数](@entry_id:170178)的支撑域，从而实现局部网格的细化。这种方法会使[基函数](@entry_id:170178)更加**局部化**。

2.  **[p-加密](@entry_id:173797)**（p-refinement）：即**次数提升**（degree elevation），在保持节点位置和连续性不变的情况下，提高[基函数](@entry_id:170178)的多项式次数 $p$。次数提升会增加每个单元的自由度数量，并扩大[基函数](@entry_id:170178)的支撑域，使其变得**非局部化**。这通常能以更快的速率提升近似精度。

3.  **k-加密**（k-refinement）：这是通过提升多项式次数 $p$ 并同时保持节点最小重数（通常为1）来实现的。结果是，在节点处的**连续性**得到提高（从 $C^{p-m}$ 到 $C^{p'-m}$，其中 $p' > p$）。与[p-加密](@entry_id:173797)类似，k-加密也会增加自由度并扩大[基函数](@entry_id:170178)的支撑域。

一个关键的程序是**[节点插入](@entry_id:751052)算法**（通常指Boehm算法），它确保在插入新节点时几何形状保持不变。该算法通过计算一组新的控制点 $\mathbf{Q}_j$ 作为原始控制点 $\mathbf{P}_i$ 的线性组合，来定义一个与原始曲线完全相同的、但在更丰富的基函数空间中表示的曲线。这个[线性变换](@entry_id:149133)可以表示为一个**加密矩阵** $\mathbf{R}$，使得 $\mathbf{Q} = \mathbf{R} \mathbf{P}$。例如，对于一条二次[Bézier曲线](@entry_id:160922)（由[节点向量](@entry_id:176218) $\Xi = [0,0,0,1,1,1]$ 定义），向其插入一个新节点 $\hat{u}=0.5$，我们可以推导出从原始3个控制点到新的4个控制点的 $4 \times 3$ 加密矩阵 [@problem_id:3594390]。

然而，标准[张量积样条](@entry_id:634851)的一个主要缺点是加密的**全局效应**。在二维或三维问题中，插入一个节点（例如，一条新的节点线）必须贯穿整个参[数域](@entry_id:155558)。这意味着即使我们只想在模型的一个小角落提高精度，也必须在整行或整列上添加不必要的自由度。这种全局传播限制了加密的效率，并促使研究者们开发支持真正局部加密的技术。

### [T样条](@entry_id:755791)：迈向真正的局部加密

为了克服[张量积样条](@entry_id:634851)的全局传播限制，**[T样条](@entry_id:755791)**（T-splines）应运而生。[T样条](@entry_id:755791)通过允许节点线在参数网格中终止于**T-连接点**（T-junctions）来推广NURBS，从而实现了真正的局部加密。

#### 朴素[T样条](@entry_id:755791)的问题

最初的[T样条](@entry_id:755791)定义非常灵活，但也带来了一些严重问题。如果局部加密处理不当，可能会破坏[基函数](@entry_id:170178)的关键性质。例如，考虑一个[双线性](@entry_id:146819)（$p=q=1$）的[T样条](@entry_id:755791)基。如果我们天真地在一个局部区域插入新的节点线，而不进行任何补偿，那么在T-连接点附近的[基函数](@entry_id:170178)就会由不一致的局部[节点向量](@entry_id:176218)定义。这会导致[基函数](@entry_id:170178)的**[单位分解](@entry_id:150115)性失效**。我们可以构造一个反例，在一个局部区域计算[基函数](@entry_id:170178)之和，其结果不为1，这直接违反了数值分析所需的基本性质 [@problem_id:3594413]。此外，任意的[T样条](@entry_id:755791)网格还可能导致[基函数](@entry_id:170178)的**线性相关**，使得[刚度矩阵](@entry_id:178659)奇异，分析无法进行。

#### 分析适应性[T样条](@entry_id:755791)（ASTS）

为了解决这些问题，研究者们提出了一套更严格的规则，定义了**分析适应性[T样条](@entry_id:755791)**（Analysis-Suitable T-splines, ASTS）。ASTS是一类特殊的[T样条](@entry_id:755791)，它通过对T-网格的拓扑结构施加约束，确保生成的[基函数](@entry_id:170178)具备所有进行可靠分析所需的性质（如[线性无关](@entry_id:148207)性、单位分解性、非负性）。

ASTS的核心约束条件包括 [@problem_id:3594355]：
1.  **T-连接点扩展规则**：对于一个给定的T-连接点，其“杆”（即终止的节点线）必须沿着其“头”（即与之相交的节点线）在参数方向上进行概念上的延伸。对于次数为 $p$ 的样条，该延伸必须跨越 $p$ 个网格单元。这个规则是确保[基函数](@entry_id:170178)局部[节点向量](@entry_id:176218)一致性的关键。

2.  **对偶相容性与非重叠扩展**：为了保证基[函数的[线性无关](@entry_id:269975)](@entry_id:148207)性，要求水平和垂直的T-连接点扩展线不能相交或重叠。更形式化地，这个几何约束确保了所谓的**对偶相容性**（dual compatibility）。这意味着在每个单元上，[T样条](@entry_id:755791)基可以稳定地转换为等价的[Bernstein多项式基](@entry_id:746761)（通过**Bézier提取**），并且存在局部支撑的对偶泛函。对偶泛函的存在直接保证了基[函数的[线性无关](@entry_id:269975)](@entry_id:148207)性。

通过遵守这些规则，ASTS[基函数](@entry_id:170178)继承了[B样条](@entry_id:172303)的所有优良性质，同时允许了真正的局部加密。

### ASTS的原理与实践

#### ASTS[基函数](@entry_id:170178)的构建与支撑域

在实践中，ASTS[基函数](@entry_id:170178)的构建遵循T-连接点扩展规则。考虑一个双二次（$p=q=2$）的[T样条](@entry_id:755791)空间，其中存在一个T-连接点。根据扩展规则，该连接点的影响会延伸到邻近的 $p=2$ 个网格单元。因此，位于T-连接点附近的[基函数](@entry_id:170178)，其局部[节点向量](@entry_id:176218)的构造必须包含扩展线所指示的节点。这会影响[基函数](@entry_id:170178)的支撑域。例如，T-连接点一侧的[基函数](@entry_id:170178)支撑域可能会比另一侧的更大或形状不同，因为它必须“看到”T-连接点引入的额外节点信息 [@problem_id:3594349]。这种非对称性正是ASTS实现局部加密和保持连续性的机制所在。

#### ASTS的几何与分析优势

ASTS不仅在理论上是完备的，在实际应用中也展现出巨大优势：

- **水密性（Watertightness）**：ASTS的构造规则确保了在任意共享边（包括T-连接点所在的边）上，相邻单元的几何表示是完全一致的。这意味着整个几何模型是**水密的**（$C^0$连续），没有任何缝隙或重叠。这对于[固体力学](@entry_id:164042)中连续介质的模拟至关重要 [@problem_id:3594364]。

- **边界条件施加**：对于与T-网格边界对齐的边，ASTS的[迹空间](@entry_id:756085)（trace space）退化为一个标准的（一维）[NURBS](@entry_id:174125)空间。这使得**强施加[狄利克雷边界条件](@entry_id:173524)**（strong imposition of Dirichlet boundary conditions）成为可能。可以通过求解一个较小的线性系统来确定边界控制点的值，以精确或最佳逼近给定的边界条件函数 [@problem_id:3594364]。

- **[计算效率](@entry_id:270255)**：局部加密最显著的优势体现在计算效率上。在[求解偏微分方程](@entry_id:138485)时，[刚度矩阵](@entry_id:178659) $K$ 的非零元 $K_{ij}$ 存在于[基函数](@entry_id:170178) $N_i$ 和 $N_j$ 的支撑域重叠处。对于一个需要局部加密的问题，标准的张量积加密会引入大量不必要的自由度，导致刚度矩阵的**带宽**（bandwidth）显著增加，从而增加求解成本。而ASTS通过仅在需要处添加自由度，保持了系统的[稀疏性](@entry_id:136793)，并且在合适的自由度编号下，可以避免带宽的大幅增长。这使得ASTS在处理具有局部特征（如裂纹、应力集中）的问题时，计算成本远低于全局加密方法 [@problem_id:3594402]。

### 更广阔的视角：其他局部加密技术

[T样条](@entry_id:755791)并非唯一的局部加密技术。为了提供更全面的认识，我们简要介绍另外两种主流方法，并与[T样条](@entry_id:755791)进行对比 [@problem_id:3594423]：

- **截断层次[B样条](@entry_id:172303)（Truncated Hierarchical B-splines, THB）**：THB基于预先定义的一系列相互嵌套的全局[张量积样条](@entry_id:634851)空间。局部加密通过在不同区域激活不同层次的[基函数](@entry_id:170178)来实现。为了确保基[函数的[线性无关](@entry_id:269975)](@entry_id:148207)性和[单位分解](@entry_id:150115)性，粗糙层次的[基函数](@entry_id:170178)在被精细层次覆盖的区域会被“截断”。THB的构造保证了线性无关性，并且其加密机制不依赖于T-连接点式的几何传播规则，因而具有很好的局部性。

- **局部加密样条（Locally Refined splines, LR-splines）**：LR-splines是一种增量式的构造方法。从一个初始的[张量积](@entry_id:140694)[B样条](@entry_id:172303)基出发，通过插入局部的节点线段来进行加密。任何被新线段“切断”支撑域的[基函数](@entry_id:170178)都会被移除，并替换为一组在更精细网格上定义的、具有更小支撑域的新[基函数](@entry_id:170178)。LR-splines的更新规则被设计为在每一步都保持线性无关性和单位分解性，其加密传播是所有方法中最少的。

**比较**：
- **线性无关性**：[T样条](@entry_id:755791)需要ASTS约束来保证；THB和LR-splines通过其构造本身保证。
- **加密传播**：ASTS的加密会沿着T-连接点扩展规则传播；THB的加密影响范围限于父子[基函数](@entry_id:170178)的支撑域；LR-splines的传播最为局部化。
- **实现复杂性**：[T样条](@entry_id:755791)的拓扑数据结构和规则相对复杂；THB需要管理一个层次结构；LR-splines的增量式更新规则也需要仔细实现。

综上所述，从[B样条](@entry_id:172303)到[NURBS](@entry_id:174125)，再到[T样条](@entry_id:755791)等局部加密技术，[等几何分析](@entry_id:752839)的[基函数](@entry_id:170178)理论不断发展，旨在以更高的效率和灵活性来统一精确几何表示和高性能[数值分析](@entry_id:142637)。[T样条](@entry_id:755791)，特别是分析适应性[T样条](@entry_id:755791)，为解决标准[张量积样条](@entry_id:634851)的加密瓶颈提供了一个强大而严谨的框架。