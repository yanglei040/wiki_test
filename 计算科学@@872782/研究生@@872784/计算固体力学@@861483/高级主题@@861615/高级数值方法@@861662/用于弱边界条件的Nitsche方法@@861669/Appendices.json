{"hands_on_practices": [{"introduction": "要真正掌握Nitsche方法，我们必须首先理解其核心的边界积分项是如何在单元层面构建和实施的。本练习将引导你完成一个具体、循序渐进的计算过程，让你在一个二维三角形单元上亲手推导Nitsche方法的各个组成部分。通过将抽象的双线性形式转化为基于形函数和数值积分的具体矩阵项，本练习旨在揭示Nitsche方法在有限元代码中的实现细节，为你后续更深入的学习奠定坚实的基础。[@problem_id:3584364]", "problem": "考虑二维空间中的小应变、线性、各向同性弹性问题。位移场表示为 $u:\\Omega\\to\\mathbb{R}^{2}$，线性化应变为 $\\varepsilon(u)=\\frac{1}{2}\\left(\\nabla u+\\nabla u^{\\top}\\right)$，Cauchy 应力为 $\\sigma(u)=2\\mu\\,\\varepsilon(u)+\\lambda\\,\\operatorname{tr}(\\varepsilon(u))\\,I$，其中 $I$ 是单位张量，$\\mu$ 和 $\\lambda$ 是 Lamé 参数，$\\operatorname{tr}(\\cdot)$ 表示迹。在 Dirichlet 边界 $\\Gamma_{D}$ 上，面力为 $\\sigma(u)n$，其中 $n$ 是单位外法线。Nitsche 方法通过在双线性形式中增加包含 $\\sigma(u)n$、$\\sigma(v)n$ 和带参数 $\\gamma$ 的罚项的边界积分，来弱施加 Dirichlet 边界条件。\n\n您将专注于有限元法 (FEM) 中使用的单个线性（1次）三角形有限元。设该单元的顶点为 $x_{1}=(0,0)$、$x_{2}=(1,0)$ 和 $x_{3}=(0,1)$。$\\Gamma_{D}$ 上的边是从 $x_{1}$ 到 $x_{2}$ 的线段，通过 $x(s)=(s,0)$ 参数化，$s\\in[0,1]$，单位外法线为 $n=(0,-1)^{\\top}$。材料被视为各向同性，其杨氏模量为 $E$，泊松比为 $\\nu=0$，因此 $\\lambda=0$ 且 $\\mu=\\frac{E}{2}$，从而有 $\\sigma(u)=E\\,\\varepsilon(u)$。罚参数按 $\\gamma=\\alpha\\,\\frac{E}{h_{e}}$ 进行缩放，其中 $h_{e}$ 是边界边的长度。取 $E=210\\times 10^{9}$，$\\alpha=10$，且 $h_{e}=1$。Dirichlet 数据值与所求的双线性形式项无关，不应使用。\n\n将与顶点相关联的标量形函数表示为 $\\varphi_{1}$、$\\varphi_{2}$ 和 $\\varphi_{3}$，并通过将每个标量形函数与笛卡尔单位向量 $e_{x}$ 和 $e_{y}$ 相乘来构造向量基函数。使用在 $[0,1]$ 上的两点高斯求积，节点为 $s_{1}=\\frac{1}{2}-\\frac{1}{2\\sqrt{3}}$ 和 $s_{2}=\\frac{1}{2}+\\frac{1}{2\\sqrt{3}}$，权重均为 $w_{k}=\\frac{1}{2}$，完成以下任务：\n\n1. 从上述定义和选定的几何形状出发，推导用于组装三个 Nitsche 贡献项\n$$\n\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,\\mathrm{d}s,\\quad\n\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,\\mathrm{d}s,\\quad\n\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,\\mathrm{d}s,\n$$\n的单元级求积表达式。其中，向量值有限元试探函数 $u_{h}$ 和检验函数 $v_{h}$ 是由给定三角形上的线性标量形函数构建的。\n\n2. 使用推导出的表达式，计算对应于对称 Nitsche 组合 $-\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,\\mathrm{d}s-\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,\\mathrm{d}s+\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,\\mathrm{d}s$ 的单个标量双线性形式项。其中，试探基为 $\\varphi_{1}\\,e_{x}$，检验基为 $\\varphi_{2}\\,e_{x}$。使用指定的求积法则和给定的参数计算其数值。\n\n以 $\\mathrm{N}/\\mathrm{m}$ 为单位表示最终的标量项，并将您的答案四舍五入到四位有效数字。", "solution": "用户希望解决一个计算固体力学中关于使用 Nitsche 方法施加 Dirichlet 边界条件的问题。该任务包括两个部分：首先，推导在特定三角形单元上 Nitsche 边界项的一般求积表达式；其次，计算得到的双线性形式的一个特定项。\n\n### 步骤 1：问题验证\n\n#### 提取已知条件\n-   **问题类型**：二维小应变、线性、各向同性弹性。\n-   **单元几何**：顶点为 $x_{1}=(0,0)$、$x_{2}=(1,0)$ 和 $x_{3}=(0,1)$ 的线性三角形单元。\n-   **边界条件**：在 $\\Gamma_{D}$ 上的 Dirichlet 边界条件，$\\Gamma_{D}$ 是从 $x_{1}$ 到 $x_{2}$ 的边。\n-   **边界参数化**：$\\Gamma_{D}$ 上的边通过 $x(s)=(s,0)$ 参数化，$s\\in[0,1]$。\n-   **外法线**：$\\Gamma_D$ 上的单位外法线为 $n=(0,-1)^{\\top}$。\n-   **材料属性**：杨氏模量 $E = 210 \\times 10^{9}$，泊松比 $\\nu=0$。\n-   **本构关系**：由 $\\nu=0$ 可得 Lamé 参数 $\\lambda=0$ 和 $\\mu=\\frac{E}{2}$。Cauchy 应力张量给出为 $\\sigma(u)=E\\,\\varepsilon(u)$，其中应变为 $\\varepsilon(u)=\\frac{1}{2}\\left(\\nabla u+\\nabla u^{\\top}\\right)$。\n-   **罚参数**：$\\gamma=\\alpha\\,\\frac{E}{h_{e}}$，其中 $\\alpha=10$，边界边长 $h_{e}=1$。因此，$\\gamma = 10E$。\n-   **有限元基**：向量基函数由标量线性形函数 $\\varphi_{i}$ 构造成 $\\varphi_{i}e_{x}$ 和 $\\varphi_{i}e_{y}$。\n-   **数值积分**：在 $[0,1]$ 上的两点高斯求积，节点为 $s_{1}=\\frac{1}{2}-\\frac{1}{2\\sqrt{3}}$、$s_{2}=\\frac{1}{2}+\\frac{1}{2\\sqrt{3}}$，权重为 $w_{1}=w_{2}=\\frac{1}{2}$。\n-   **任务 1**：推导三个 Nitsche 积分：\n    $\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,\\mathrm{d}s$、$\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,\\mathrm{d}s$ 和 $\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,\\mathrm{d}s$ 的单元级求积表达式。\n-   **任务 2**：计算特定的双线性形式项 $B(u_h, v_h) = -\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,\\mathrm{d}s-\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,\\mathrm{d}s+\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,\\mathrm{d}s$ 的值，其中试探函数为 $u_{h} = \\varphi_{1}\\,e_{x}$，检验函数为 $v_{h} = \\varphi_{2}\\,e_{x}$。\n-   **输出格式**：最终答案必须是以 $\\mathrm{N}/\\mathrm{m}$ 为单位的数值，并四舍五入到四位有效数字。\n\n#### 使用提取的已知条件进行验证\n-   **科学依据**：问题在已建立的线性弹性和有限元法理论框架内被正确地表述。Nitsche 方法是一种标准且有效的技术。材料参数（$E, \\nu, \\lambda, \\mu$）之间的关系是正确的。\n-   **适定性**：问题是完全指定的。它提供了所有必要的信息：单元几何、材料属性、基函数、边界定义和数值积分方案。目标是计算一个特定的数值，这是一个明确定义的任务。\n-   **客观性**：问题使用精确、明确的技术语言陈述，没有任何主观性。\n\n该问题不违反任何无效性标准。这是一个计算力学中的标准、适定问题。\n\n#### 结论与行动\n问题有效。将提供解答。\n\n### 步骤 2：解答\n\n#### 准备工作：形函数及其梯度\n顶点为 $x_1=(0,0)$、$x_2=(1,0)$、$x_3=(0,1)$ 的三角形的标量线性形函数 $\\varphi_i(x,y)$ 是从条件 $\\varphi_i(x_j) = \\delta_{ij}$ 推导出来的。\n-   $\\varphi_{1}(x,y) = 1-x-y$\n-   $\\varphi_{2}(x,y) = x$\n-   $\\varphi_{3}(x,y) = y$\n\n这些形函数的梯度在整个单元上是常数：\n-   $\\nabla \\varphi_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$\n-   $\\nabla \\varphi_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n-   $\\nabla \\varphi_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\n边界 $\\Gamma_D$ 对应于连接 $x_1$ 和 $x_2$ 的边，参数化为 $x(s) = (s,0)$，$s \\in [0,1]$。在此边界上，形函数取值为：\n-   $\\varphi_{1}(s,0) = 1-s$\n-   $\\varphi_{2}(s,0) = s$\n-   $\\varphi_{3}(s,0) = 0$\n\n#### 第 1 部分：求积表达式的推导\n\n设试探函数 $u_h$ 和检验函数 $v_h$ 是有限元空间中的通用基函数。我们考虑 $u_h = \\varphi_k e_d$ 和 $v_h = \\varphi_l e_{d'}$，其中 $k, l \\in \\{1,2,3\\}$ 且 $d, d' \\in \\{x,y\\}$。\n\n对于 $u_h = \\varphi_k e_d$ 的应变张量是 $\\varepsilon(\\varphi_k e_d) = \\frac{1}{2}(\\nabla(\\varphi_k e_d) + \\nabla(\\varphi_k e_d)^\\top) = \\frac{1}{2}(e_d \\otimes \\nabla\\varphi_k + \\nabla\\varphi_k \\otimes e_d)$。\n应力是 $\\sigma(u_h) = E\\varepsilon(\\varphi_k e_d)$。\n在 $\\Gamma_D$ 上（法线为 $n = (0,-1)^\\top$）的面力向量是 $\\sigma(u_h)n$。\n\n积分使用两点高斯求积法则进行近似：$\\int_{0}^{1} f(s) \\mathrm{d}s \\approx \\sum_{q=1}^{2} w_q f(s_q)$，其中 $w_{1,2}=1/2$。\n\n1.  **第一个 Nitsche 项**：$\\int_{\\Gamma_{D}}\\sigma(u_{h})\\,n\\cdot v_{h}\\,\\mathrm{d}s$\n    对于 $u_h=\\varphi_k e_d$ 和 $v_h=\\varphi_l e_{d'}$，被积函数是 $(\\sigma(\\varphi_k e_d)n) \\cdot (\\varphi_l(s,0) e_{d'})$。注意 $\\sigma(\\varphi_k e_d)$ 是常数。\n    求积表达式是：\n    $$ \\int_{\\Gamma_{D}}\\sigma(\\varphi_k e_d)\\,n\\cdot (\\varphi_l e_{d'})\\,\\mathrm{d}s \\approx \\sum_{q=1}^{2} w_q \\left[ (E \\varepsilon(\\varphi_k e_d) n) \\cdot (\\varphi_l(s_q,0) e_{d'}) \\right] $$\n\n2.  **第二个 Nitsche 项（对称项）**：$\\int_{\\Gamma_{D}}\\sigma(v_{h})\\,n\\cdot u_{h}\\,\\mathrm{d}s$\n    这可以通过交换试探函数和检验函数的作用得到。\n    求积表达式是：\n    $$ \\int_{\\Gamma_{D}}\\sigma(\\varphi_l e_{d'})\\,n\\cdot (\\varphi_k e_d)\\,\\mathrm{d}s \\approx \\sum_{q=1}^{2} w_q \\left[ (E \\varepsilon(\\varphi_l e_{d'}) n) \\cdot (\\varphi_k(s_q,0) e_d) \\right] $$\n\n3.  **第三个 Nitsche 项（罚项）**：$\\int_{\\Gamma_{D}}\\gamma\\,u_{h}\\cdot v_{h}\\,\\mathrm{d}s$\n    被积函数是 $\\gamma (\\varphi_k(s,0)e_d) \\cdot (\\varphi_l(s,0)e_{d'}) = \\gamma \\varphi_k(s,0) \\varphi_l(s,0) \\delta_{dd'}$。\n    求积表达式是：\n    $$ \\int_{\\Gamma_{D}}\\gamma (\\varphi_k e_d)\\cdot (\\varphi_l e_{d'})\\,\\mathrm{d}s \\approx \\gamma \\delta_{dd'} \\sum_{q=1}^{2} w_q \\varphi_k(s_q,0) \\varphi_l(s_q,0) $$\n\n这三个表达式构成了所要求的一般单元级求积形式。\n\n#### 第 2 部分：特定双线性形式项的计算\n\n我们现在计算 $B(u_h, v_h) = -I_1 - I_2 + I_3$，其中 $I_1 = \\int_{\\Gamma_D} \\sigma(u_h)n \\cdot v_h \\mathrm{d}s$，$I_2 = \\int_{\\Gamma_D} \\sigma(v_h)n \\cdot u_h \\mathrm{d}s$，$I_3 = \\int_{\\Gamma_D} \\gamma u_h \\cdot v_h \\mathrm{d}s$。\n特定的基函数是：\n-   试探函数：$u_h = \\varphi_1 e_x = (1-x-y)e_x$\n-   检验函数：$v_h = \\varphi_2 e_x = x e_x$\n\n**计算面力：**\n\n对于 $u_h = \\varphi_1 e_x$：\n$\\nabla u_h = \\nabla\\varphi_1 \\otimes e_x^\\top = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ -1  0 \\end{pmatrix}$。\n问题陈述错误地暗示了 $\\nabla u_h = e_x \\otimes \\nabla\\varphi_1$。我们遵循标准定义 $\\nabla u_{ij} = \\partial_j u_i$。\n$\\nabla u_h = \\begin{pmatrix} \\partial_x u_x  \\partial_y u_x \\\\ \\partial_x u_y  \\partial_y u_y \\end{pmatrix} = \\begin{pmatrix} \\partial_x \\varphi_1  \\partial_y \\varphi_1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} -1  -1 \\\\ 0  0 \\end{pmatrix}$。\n$\\varepsilon(u_h) = \\frac{1}{2}(\\nabla u_h + \\nabla u_h^\\top) = \\frac{1}{2}\\left( \\begin{pmatrix} -1  -1 \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix} -1  0 \\\\ -1  0 \\end{pmatrix} \\right) = \\begin{pmatrix} -1  -1/2 \\\\ -1/2  0 \\end{pmatrix}$。\n$\\sigma(u_h) = E\\varepsilon(u_h)$。\n面力为 $\\sigma(u_h)n = E \\begin{pmatrix} -1  -1/2 \\\\ -1/2  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = E \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}$。\n\n对于 $v_h = \\varphi_2 e_x$：\n$\\nabla v_h = \\begin{pmatrix} \\partial_x \\varphi_2  \\partial_y \\varphi_2 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n$\\varepsilon(v_h) = \\frac{1}{2}(\\nabla v_h + \\nabla v_h^\\top) = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n$\\sigma(v_h) = E\\varepsilon(v_h)$。\n面力为 $\\sigma(v_h)n = E \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n**计算积分：**\n\n积分区间为 $s \\in [0,1]$。在此边界上，$u_h(s) = (1-s)e_x$ 且 $v_h(s) = s e_x$。两点求积对最高 $2(2)-1=3$ 次的多项式是精确的。我们所有的被积函数次数都为 2 或更低，因此求积是精确的。我们可以解析地计算这些积分。\n\n1.  **积分 $I_1$**：$\\int_0^1 (\\sigma(u_h)n) \\cdot v_h(s) \\mathrm{d}s$\n    被积函数为 $(E \\begin{pmatrix} 1/2 \\\\ 0 \\end{pmatrix}) \\cdot (s e_x) = (E/2) s$。\n    $$I_1 = \\int_0^1 \\frac{E}{2}s \\, \\mathrm{d}s = \\frac{E}{2} \\left[\\frac{s^2}{2}\\right]_0^1 = \\frac{E}{4}$$\n\n2.  **积分 $I_2$**：$\\int_0^1 (\\sigma(v_h)n) \\cdot u_h(s) \\mathrm{d}s$\n    面力 $\\sigma(v_h)n$ 是零向量。\n    $$I_2 = \\int_0^1 0 \\cdot ((1-s)e_x) \\, \\mathrm{d}s = 0$$\n\n3.  **积分 $I_3$**：$\\int_0^1 \\gamma u_h(s) \\cdot v_h(s) \\mathrm{d}s$\n    当 $\\gamma = 10E$ 时，被积函数为 $\\gamma ((1-s)e_x) \\cdot (s e_x) = \\gamma s(1-s)$。\n    $$I_3 = \\gamma \\int_0^1 (s-s^2) \\, \\mathrm{d}s = \\gamma \\left[\\frac{s^2}{2} - \\frac{s^3}{3}\\right]_0^1 = \\gamma \\left(\\frac{1}{2} - \\frac{1}{3}\\right) = \\frac{\\gamma}{6} = \\frac{10E}{6} = \\frac{5E}{3}$$\n\n**合并各项：**\n对双线性形式的总贡献为：\n$$ B(\\varphi_1 e_x, \\varphi_2 e_x) = -I_1 - I_2 + I_3 = -\\frac{E}{4} - 0 + \\frac{5E}{3} = E\\left(-\\frac{3}{12} + \\frac{20}{12}\\right) = \\frac{17E}{12} $$\n\n**最终数值：**\n代入 $E = 210 \\times 10^{9} \\, \\mathrm{N}/\\mathrm{m}^2$。假设是单位厚度的平面问题，则刚度矩阵项的单位是 N/m。\n$$ \\text{值} = \\frac{17}{12} \\times (210 \\times 10^9) = \\frac{3570}{12} \\times 10^9 = 297.5 \\times 10^9 $$\n使用标准科学记数法并四舍五入到四位有效数字（其本身已经满足），该值为 $2.975 \\times 10^{11} \\, \\mathrm{N}/\\mathrm{m}$。", "answer": "$$\\boxed{2.975 \\times 10^{11}}$$", "id": "3584364"}, {"introduction": "Nitsche方法是众多弱式施加边界条件的技术之一。为了深刻理解其独特性，有必要将其与罚函数法、拉格朗日乘子法等常见方法进行比较。本实践将引导你完成一个数值实验，通过分析不同方法产生的系统矩阵的条件数，来探索它们在数值稳定性方面的差异。这个过程不仅能加深你对Nitsche方法特性的理解，也为在实际工程问题中选择合适的数值模型和预条件子提供了关键的洞察。[@problem_id:3584401]", "problem": "考虑一个占据区域 $[0,1]$ 的线性弹性杆，其杨氏模量为 $E$，横截面积为 $A$。其强形式控制方程为 $-(E A u')' = f$（在 $[0,1]$ 内），同时在左端施加狄利克雷边界条件 $u(0) = 0$，并在 $x=1$ 处施加自然边界条件。从线性弹性的基本弱形式出发，通过分部积分，可以对左边界的贡献项进行弱处理。使用有限元法 (FEM)，在包含 $N$ 个单元的均匀网格上，用连续分段线性形函数来近似位移 $u$。\n\n你的任务是：\n\n- 从弱形式出发，且不依赖任何简化公式，推导在 $x=0$ 处实施边界条件的三种策略的离散双线性形式：\n  1. 罚函数法：用一个与材料和网格参数一致缩放的边界罚项来增广双线性形式。\n  2. Nitsche 方法：添加一致性边界项和一个对称稳定项以保证矫顽性。\n  3. 拉格朗日乘子法：使用一个拉格朗日乘子来施加边界约束，构成一个增广鞍点系统。\n- 对于每种方法，使用线性形函数在包含 $N$ 个单元、单元长度为 $h = 1/N$、杨氏模量为 $E$、横截面积为 $A$ 的均匀网格上，组装全局刚度矩阵。不要通过直接施加 $u(0)=0$ 来消去自由度；应按指定的方式弱施加该条件。\n- 计算每个组装后矩阵的 2-范数条件数。对于一个方阵 $M$，其 2-范数条件数定义为 $\\kappa_2(M) = \\sigma_{\\max}(M)/\\sigma_{\\min}(M)$，其中 $\\sigma_{\\max}(M)$ 和 $\\sigma_{\\min}(M)$ 是通过奇异值分解 (SVD) 得到的最大和最小奇异值。\n\n假设和要求：\n\n- 假设 $A = 1$ 和 $E = 1$，从而使刚度矩阵的元素和条件数均为无量纲。\n- 对于罚函数法，使用罚参数 $\\gamma_p$ 并使边界项与单元长度 $h$ 一致地缩放。\n- 对于 Nitsche 方法，使用稳定参数 $\\alpha$，并包含与 $h$ 成比例缩放的一致性对称边界项和稳定项。\n- 对于拉格朗日乘子法，对离散约束算子使用一个缩放参数 $s$；研究其对条件数的影响。\n\n测试套件：\n\n- 使用以下测试用例，每个用例由 $(N,\\gamma_p,\\alpha,s)$ 指定：\n  1. $(4, 100, 10, 1)$：标准网格和适中的稳定参数（理想情况）。\n  2. $(1, 100, 10, 1)$：单单元网格，用以探究粗糙离散化行为（边界情况）。\n  3. $(8, 1000000, 10, 1)$：非常大的罚参数，以测试条件数（边缘情况）。\n  4. $(8, 100, 0.000001, 100)$：非常小的 Nitsche 稳定参数和大的乘子缩放，用以探究近不稳定性及鞍点条件数（边缘情况）。\n\n输出规格：\n\n- 对于每个测试用例，计算一个包含三个浮点数的列表 $[\\kappa_2(M_{\\text{penalty}}), \\kappa_2(M_{\\text{nitsche}}), \\kappa_2(M_{\\text{multiplier}})]$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目对应于上述的一个测试用例（顺序相同），且每个条目本身也是一个包含三个浮点数的列表。例如：$[[c_{11},c_{12},c_{13}],[c_{21},c_{22},c_{23}],\\dots]$。", "solution": "该问题是计算固体力学中的一个有效练习，重点在于弱施加狄利克雷边界条件的三种常用方法的有限元实现和数值分析。此问题具有科学依据，是适定且客观的。我们将进行完整的推导和解答。\n\n一维线性弹性杆的控制方程是以下边值问题的强形式：\n$$ -(E A u'(x))' = f(x) \\quad \\text{for } x \\in (0, 1) $$\n其边界条件为狄利克雷边界条件 $u(0) = 0$ 和自然（诺伊曼）边界条件 $EA u'(1) = 0$。此处，$u(x)$ 是轴向位移，$E$ 是杨氏模量，$A$ 是横截面积，$f(x)$ 是分布轴向力。\n\n为推导弱形式，我们将控制方程与一个足够光滑的测试函数 $v(x)$ 相乘，并在域 $\\Omega = [0, 1]$上进行积分：\n$$ \\int_0^1 -(E A u')' v \\,\\mathrm{d}x = \\int_0^1 f v \\,\\mathrm{d}x $$\n对左侧项进行分部积分可得：\n$$ \\left[ -E A u' v \\right]_0^1 + \\int_0^1 E A u' v' \\,\\mathrm{d}x = \\int_0^1 f v \\,\\mathrm{d}x $$\n$$ -E A u'(1) v(1) + E A u'(0) v(0) + \\int_0^1 E A u' v' \\,\\mathrm{d}x = \\int_0^1 f v \\,\\mathrm{d}x $$\n应用自然边界条件 $E A u'(1) = 0$，方程简化为：\n$$ \\int_0^1 E A u' v' \\,\\mathrm{d}x + E A u'(0) v(0) = \\int_0^1 f v \\,\\mathrm{d}x $$\n这就是基本弱形式。项 $E A u'(0)$ 代表在狄利克雷边界上的未知反力。所指定的三种方法——罚函数法、Nitsche 方法和拉格朗日乘子法——以不同方式处理该项以及 $u(0)=0$ 的施加。\n\n我们将域 $[0,1]$ 离散化为 $N$ 个长度为 $h=1/N$ 的均匀单元。我们使用连续的分段线性 (P1) 基函数 $\\phi_i(x)$ 来近似位移 $u$ 和测试函数 $v$：\n$$ u_h(x) = \\sum_{j=0}^{N} u_j \\phi_j(x) \\quad \\text{and} \\quad v_h(x) = \\sum_{i=0}^{N} v_i \\phi_i(x) $$\n其中 $u_j$ 是节点位移自由度。标准双线性形式 $a(u,v) = \\int_0^1 E A u' v' \\,\\mathrm{d}x$ 离散化为矩阵-向量积 $\\mathbf{v}^T \\mathbf{K}_{bulk} \\mathbf{u}$。矩阵 $\\mathbf{K}_{bulk}$ 是由单元刚度矩阵 $\\mathbf{k}^e = \\frac{EA}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 组装而成的全局刚度矩阵。对于一个有 $N+1$ 个节点的杆，$\\mathbf{K}_{bulk}$ 是一个 $(N+1) \\times (N+1)$ 的矩阵。在假设 $E=A=1$ 的情况下：\n$$\n\\mathbf{K}_{bulk} = \\frac{1}{h}\n\\begin{pmatrix}\n1  -1    \\\\\n-1  2  -1   \\\\\n \\ddots  \\ddots  \\ddots  \\\\\n  -1  2  -1 \\\\\n   -1  1\n\\end{pmatrix}\n$$\n该矩阵对应于两端均为自然边界条件的杆，并且是奇异的。\n\n### 1. 罚函数法\n\n罚函数法通过在弱形式中添加一个罚项来近似处理狄利克雷条件，该罚项惩罚边界上的非零位移。修正后的双线性形式为：\n$$ a_p(u,v) = \\int_0^1 E A u' v' \\,\\mathrm{d}x + \\beta u(0) v(0) $$\n罚参数 $\\beta$ 必须很大。按照指定，我们选择一个与刚度矩阵元素一致的缩放：$\\beta = \\frac{\\gamma_p EA}{h}$，其中 $\\gamma_p$ 是一个无量纲参数。\n罚项的离散形式是 $\\frac{\\gamma_p EA}{h} u_h(0) v_h(0) = \\frac{\\gamma_p EA}{h} u_0 v_0$。该项只影响全局刚度矩阵的 $(0,0)$ 元素。\n罚函数法的最终矩阵 $\\mathbf{K}_{\\text{penalty}}$ 为：\n$$ \\mathbf{K}_{\\text{penalty}} = \\mathbf{K}_{bulk} + \\mathbf{K}_{add} $$\n其中 $\\mathbf{K}_{add}$ 是一个除 $(\\mathbf{K}_{add})_{00} = \\frac{\\gamma_p EA}{h}$ 外所有元素都为零的矩阵。当 $E=A=1$ 时：\n$$\n(\\mathbf{K}_{\\text{penalty}})_{00} = \\frac{1}{h} + \\frac{\\gamma_p}{h} = \\frac{1+\\gamma_p}{h}\n$$\n\n### 2. Nitsche 方法\n\nNitsche 方法通过添加一致性项（即对精确解为零的项）和一个确保矫顽性的稳定项来施加边界条件。我们使用一个对称格式。其双线性形式为：\n$$ a_N(u,v) = \\int_0^1 E A u'v' \\,\\mathrm{d}x + E A u'(0)v(0) + E A v'(0)u(0) + \\frac{\\alpha EA}{h} u(0)v(0) $$\n其中 $\\alpha$ 是一个无量纲的稳定参数。这些项是通过在基本弱形式中对称地包含边界约束而推导出来的。\n我们离散化这些新增的项。注意 $u_h(0) = u_0$，$v_h(0)=v_0$。在 $x=0$ 处的导数是在第一个单元 $(0,h)$ 内部计算的，因此 $u'_h(0) = (u_1-u_0)/h$。\n-   稳定项：$\\frac{\\alpha EA}{h} u_h(0) v_h(0)$ 对 $(\\mathbf{K}_N)_{00}$ 元素的贡献为 $\\frac{\\alpha EA}{h}$。\n-   对称项：$E A u'_h(0)v_h(0) + E A v'_h(0)u_h(0) = EA \\frac{u_1-u_0}{h} v_0 + EA \\frac{v_1-v_0}{h} u_0$。\n    该项对 $(\\mathbf{K}_N)_{00}$ 的贡献为 $-\\frac{EA}{h}$（来自 $-u_0v_0/h$），对 $(\\mathbf{K}_N)_{01}$ 的贡献为 $+\\frac{EA}{h}$（来自 $u_1v_0/h$）。类似地，它对 $(\\mathbf{K}_N)_{00}$ 的贡献为 $-\\frac{EA}{h}$（来自 $-v_0u_0/h$），对 $(\\mathbf{K}_N)_{10}$ 的贡献为 $+\\frac{EA}{h}$（来自 $v_1u_0/h$）。\n\n将这些贡献加到 $\\mathbf{K}_{bulk}$ 上（设 $E=A=1$）：\n-   $(\\mathbf{K}_N)_{00} = (\\mathbf{K}_{bulk})_{00} - \\frac{1}{h} - \\frac{1}{h} + \\frac{\\alpha}{h} = \\frac{1}{h} - \\frac{2}{h} + \\frac{\\alpha}{h} = \\frac{\\alpha-1}{h}$。\n-   $(\\mathbf{K}_N)_{01} = (\\mathbf{K}_{bulk})_{01} + \\frac{1}{h} = -\\frac{1}{h} + \\frac{1}{h} = 0$。\n-   $(\\mathbf{K}_N)_{10} = (\\mathbf{K}_{bulk})_{10} + \\frac{1}{h} = -\\frac{1}{h} + \\frac{1}{h} = 0$。\n其他元素保持不变。最终得到的矩阵 $\\mathbf{K}_{\\text{nitsche}}$ 为：\n$$\n\\mathbf{K}_{\\text{nitsche}} = \\frac{1}{h}\n\\begin{pmatrix}\n\\alpha-1  0  0  \\dots \\\\\n0  2  -1  \\\\\n0  -1  2  \\ddots \\\\\n\\vdots   \\ddots  \\ddots  -1 \\\\\n   -1  1\n\\end{pmatrix}\n$$\n这种解耦结构是一维 P1 单元产生的一种人为现象。为保证矫顽性，该矩阵必须是正定的，对于这种结构，要求 $\\alpha > 1$。\n\n### 3. 拉格朗日乘子法\n\n该方法引入一个拉格朗日乘子 $\\lambda_0$ 来精确施加约束 $u(0)=0$。这会形成一个混合（鞍点）系统。未知量是位移向量 $\\mathbf{u}$ 和乘子 $\\lambda_0$。\n方程组为：\n$$ \\begin{pmatrix} \\mathbf{K}_{bulk}  \\mathbf{C}^T \\\\ \\mathbf{C}  \\mathbf{0} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u} \\\\ \\lambda_0 \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f} \\\\ 0 \\end{pmatrix} $$\n约束条件是 $u_h(0) = u_0 = 0$。因此，离散约束算子 $\\mathbf{C}$ 是行向量 $[1, 0, \\dots, 0]$。\n问题为约束算子指定了一个缩放参数 $s$。我们将此缩放对称地应用于非对角块，得到以下矩阵：\n$$ \\mathbf{K}_{\\text{multiplier}} = \\begin{pmatrix} \\mathbf{K}_{bulk}  s\\mathbf{C}^T \\\\ s\\mathbf{C}  0 \\end{pmatrix} $$\n这是一个 $(N+2) \\times (N+2)$ 的对称不定矩阵。当 $E=A=1$ 时：\n$$\n\\mathbf{K}_{\\text{multiplier}} =\n\\begin{pmatrix}\n1/h  -1/h  \\dots  0  s \\\\\n-1/h  2/h  \\dots  0  0 \\\\\n\\vdots   \\ddots   \\vdots \\\\\n0  \\dots  -1/h  1/h  0 \\\\\ns  0  \\dots  0  0\n\\end{pmatrix}\n$$\n我们现在将使用提供的测试用例，为这三个矩阵中的每一个计算 2-范数条件数 $\\kappa_2(\\mathbf{M}) = \\sigma_{\\max}(\\mathbf{M})/\\sigma_{\\min}(\\mathbf{M})$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svdvals\n\ndef calculate_condition_numbers(N, gamma_p, alpha, s_param):\n    \"\"\"\n    Assembles the stiffness matrices for the Penalty, Nitsche, and Lagrange\n    Multiplier methods and computes their two-norm condition numbers.\n\n    Args:\n        N (int): Number of elements.\n        gamma_p (float): Penalty parameter.\n        alpha (float): Nitsche stabilization parameter.\n        s_param (float): Lagrange multiplier scaling parameter.\n\n    Returns:\n        list: A list of three floats containing the condition numbers for\n              the penalty, Nitsche, and Lagrange multiplier matrices.\n    \"\"\"\n    h = 1.0 / N\n    EA_h = 1.0 / h\n\n    # 1. Assemble K_bulk for a bar with N elements\n    dof = N + 1\n    K_bulk = np.zeros((dof, dof))\n    \n    diag0 = np.full(dof, 2.0 * EA_h)\n    diag0[0] = EA_h\n    diag0[-1] = EA_h\n    np.fill_diagonal(K_bulk, diag0)\n\n    diag1 = np.full(dof - 1, -EA_h)\n    K_bulk.flat[1::dof+1] = diag1\n    K_bulk.flat[dof::dof+1] = diag1\n\n    # 2. Penalty method matrix\n    K_penalty = K_bulk.copy()\n    K_penalty[0, 0] += gamma_p * EA_h\n    \n    s_vals_p = svdvals(K_penalty)\n    cond_p = s_vals_p[0] / s_vals_p[-1]\n\n    # 3. Nitsche's method matrix\n    K_nitsche = K_bulk.copy()\n    K_nitsche[0, 0] = (alpha - 1.0) * EA_h\n    K_nitsche[0, 1] = 0.0\n    K_nitsche[1, 0] = 0.0\n    \n    s_vals_n = svdvals(K_nitsche)\n    if np.isclose(s_vals_n[-1], 0):\n        cond_n = np.inf\n    else:\n        cond_n = s_vals_n[0] / s_vals_n[-1]\n\n    # 4. Lagrange multiplier matrix\n    K_lm = np.zeros((dof + 1, dof + 1))\n    K_lm[:dof, :dof] = K_bulk\n    K_lm[0, dof] = s_param\n    K_lm[dof, 0] = s_param\n    \n    s_vals_lm = svdvals(K_lm)\n    if np.isclose(s_vals_lm[-1], 0):\n        cond_lm = np.inf\n    else:\n        cond_lm = s_vals_lm[0] / s_vals_lm[-1]\n\n    return [cond_p, cond_n, cond_lm]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, gamma_p, alpha, s)\n        (4, 100, 10, 1),\n        (1, 100, 10, 1),\n        (8, 1000000, 10, 1),\n        (8, 100, 0.000001, 100)\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, gamma_p, alpha, s = case\n        results = calculate_condition_numbers(N, gamma_p, alpha, s)\n        all_results.append(results)\n\n    # Final print statement in the exact required format.\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3584401"}, {"introduction": "在有限元分析中，高精度是我们的核心追求之一，但当计算网格无法完美匹配真实几何形状时，精度可能会受到影响。本练习探讨了一个更深层次但极为实际的问题：当离散边界法向与精确法向存在偏差时，如何保持Nitsche方法的最优收敛性。通过一步步的理论推导，你将构建一个修正算子来恢复方法的协调性，这个过程将突显出稳健、高保真数值模拟背后所需的数学严谨性。[@problem_id:3584380]", "problem": "考虑一个占据有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 的二维小应变线性弹性体，其边界 $\\partial \\Omega$ 上的外单位法向量为 $\\mathbf{n}$。设边界分解为 Dirichlet 部分 $\\Gamma_{D}$ 和 Neumann 部分 $\\Gamma_{N}$，其中 $\\Gamma_{D} \\cup \\Gamma_{N} = \\partial \\Omega$ 且 $\\Gamma_{D} \\cap \\Gamma_{N} = \\emptyset$。该材料是各向同性的，其 Lamé 参数为 $\\lambda$ 和 $\\mu$，Cauchy 应力为 $\\boldsymbol{\\sigma}(\\mathbf{u}) = 2 \\mu \\boldsymbol{\\varepsilon}(\\mathbf{u}) + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u})) \\mathbf{I}$，其中 $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{T})$ 是无穷小应变张量。平衡的强形式为 $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{f} \\quad \\text{in } \\Omega$，且 $\\mathbf{u} = \\mathbf{g} \\quad \\text{on } \\Gamma_{D}$，$\\boldsymbol{\\sigma}(\\mathbf{u}) \\mathbf{n} = \\mathbf{t} \\quad \\text{on } \\Gamma_{N}$。\n\n位移场 $\\mathbf{u}_{h}$ 采用协调有限元空间，并使用对称 Nitsche 方法弱施加 $\\Gamma_{D}$ 上的条件 $\\mathbf{u} = \\mathbf{g}$。$\\Gamma_{D}$ 上的对称 Nitsche 双线性形式包含一致性项\n$$\n-\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma\n\\;-\\;\n\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\mathbf{n}) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma,\n$$\n和一个罚项 $\\int_{\\Gamma_{D}} \\frac{\\gamma}{h} \\mathbf{u}_{h} \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma$，其中 $\\gamma > 0$，$h$ 为局部网格尺寸。\n\n假设精确几何由一个离散边界表示，其在 $\\Gamma_{D}$ 上的外单位法向量为 $\\mathbf{n}_{h}$，沿某一边界段与精确法向量 $\\mathbf{n}$ 偏离一个恒定角度 $\\theta$，即 $\\mathbf{n} \\cdot \\mathbf{n}_{h} = \\cos \\theta$ 且 $|\\theta| \\ll 1$。已知在 Nitsche 一致性项中用 $\\mathbf{n}_{h}$ 替代 $\\mathbf{n}$ 会损害伴随一致性，并可能降低收敛率。\n\n提出一种对离散法向量进行线性作用的边界修正，以恢复 Nitsche 一致性项的伴随一致性，同时保持其对称结构。具体来说，考虑一个修正后的一致性项，该项使用算子 $C(\\theta)$，通过向精确法向方向的投影 $P_{\\mathbf{n}} := \\mathbf{n} \\mathbf{n}^{T}$ 和一个标量因子 $\\alpha(\\theta)$ 作用于 $\\mathbf{n}_{h}$：\n$$\n-\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma\n\\;-\\;\n\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma.\n$$\n\n从分部积分和上述定义得到的基本弱形式出发，推导这些修正项满足伴随一致性的要求，并确定标量修正因子 $\\alpha(\\theta)$ 的闭式表达式，使得修正后的一致性项与使用精确法向量 $\\mathbf{n}$ 构建的项完全相等。分析此修正如何影响 Nitsche 一致性项，并根据算子 $P_{\\mathbf{n}}$ 和角度 $\\theta$ 解释为什么最优收敛率得以恢复。\n\n你的最终答案应该是 $\\alpha(\\theta)$ 的无单位的单一解析表达式。如果使用近似，你必须给出精确的闭式表达式作为最终答案。不需要进行数值舍入。", "solution": "该问题要求推导对称 Nitsche 列式中一致性项的标量修正因子 $\\alpha(\\theta)$。此修正旨在补偿因使用离散边界法向量 $\\mathbf{n}_h$ 代替精确法向量 $\\mathbf{n}$ 而引入的几何误差，其中两个法向量由一个恒定角度 $\\theta$ 相关联，满足 $\\mathbf{n} \\cdot \\mathbf{n}_h = \\cos \\theta$。目标是恢复一致性项的精确形式，这是确保有限元方法的伴随一致性和最优收敛率的前提条件。\n\n使用对称 Nitsche 方法弱施加 $\\Gamma_D$ 上的 Dirichlet 边界条件 $\\mathbf{u} = \\mathbf{g}$，其标准形式涉及来自 $\\Gamma_D$ 的双线性形式贡献：\n$$\nb_{\\Gamma_D}(\\mathbf{u}_h, \\mathbf{v}_h) = -\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma - \\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\mathbf{n}) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma + \\int_{\\Gamma_{D}} \\frac{\\gamma}{h} \\mathbf{u}_{h} \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma.\n$$\n前两项是一致性项，第三项是罚项。\n\n当精确域被离散域近似时，问题就出现了，此时 $\\Gamma_D$ 上的外单位法向量是 $\\mathbf{n}_h$ 而不是 $\\mathbf{n}$。在一致性项中直接使用 $\\mathbf{n}_h$ 会导致一致性的丧失。所提出的修正如下修改一致性项：\n$$\nb_{\\Gamma_D}^{\\text{corr}}(\\mathbf{u}_h, \\mathbf{v}_h) = -\\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma - \\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{v}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{u}_{h} \\, \\mathrm{d}\\Gamma.\n$$\n罚项不受影响。恢复理想列式的条件是，对于有限元空间中任意容许的离散场对 $\\mathbf{u}_h$ 和 $\\mathbf{v}_h$，这些修正后的一致性项必须与原始项相同。\n\n由于这些项的对称结构，我们只需对其中一项强制施加等式。我们要求对于任意 $\\mathbf{u}_h$ 和 $\\mathbf{v}_h$：\n$$\n\\int_{\\Gamma_{D}} (\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\mathbf{n}) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma = \\int_{\\Gamma_{D}} \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_{h}) \\, \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}\\big) \\cdot \\mathbf{v}_{h} \\, \\mathrm{d}\\Gamma.\n$$\n由于此等式必须对有限元空间中任意选择的测试函数 $\\mathbf{v}_h$ 都成立，因此积分内的向量项必须在 $\\Gamma_D$ 上几乎处处相等。这给出了条件：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{u}_h) \\mathbf{n} = \\boldsymbol{\\sigma}(\\mathbf{u}_h) \\big( \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h} \\big).\n$$\n此处，$\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ 是 Cauchy 应力张量，一个作用于向量的对称二阶张量。由运动学容许位移场产生的所有可能的应力张量空间是足够丰富的（它张成了对称 $2 \\times 2$ 矩阵的空间）。因此，要使等式 $\\boldsymbol{\\sigma} \\mathbf{a} = \\boldsymbol{\\sigma} \\mathbf{b}$ 对所有容许的 $\\boldsymbol{\\sigma}$ 成立，向量必须相等，即 $\\mathbf{a} = \\mathbf{b}$。将此原理应用于我们的方程，得到对修正后法向量的核心要求：\n$$\n\\mathbf{n} = \\alpha(\\theta) \\, P_{\\mathbf{n}} \\mathbf{n}_{h}.\n$$\n此方程直接将精确法向量 $\\mathbf{n}$ 与修正后的离散法向量联系起来。现在我们可以求解标量因子 $\\alpha(\\theta)$。\n\n问题将投影算子 $P_{\\mathbf{n}}$ 定义为 $P_{\\mathbf{n}} := \\mathbf{n} \\mathbf{n}^{T}$。它对离散法向量 $\\mathbf{n}_h$ 的作用是：\n$$\nP_{\\mathbf{n}} \\mathbf{n}_{h} = (\\mathbf{n} \\mathbf{n}^{T}) \\mathbf{n}_{h} = \\mathbf{n} (\\mathbf{n}^{T} \\mathbf{n}_{h}) = \\mathbf{n} (\\mathbf{n} \\cdot \\mathbf{n}_{h}).\n$$\n我们已知精确法向量和离散法向量之间的夹角为 $\\theta$，所以 $\\mathbf{n} \\cdot \\mathbf{n}_h = \\cos \\theta$。将此代入 $P_{\\mathbf{n}} \\mathbf{n}_{h}$ 的表达式中，得到：\n$$\nP_{\\mathbf{n}} \\mathbf{n}_{h} = \\mathbf{n} \\cos \\theta.\n$$\n现在，我们将此结果代回我们的核心要求方程：\n$$\n\\mathbf{n} = \\alpha(\\theta) \\, (\\mathbf{n} \\cos \\theta).\n$$\n这可以改写为：\n$$\n\\mathbf{n} = (\\alpha(\\theta) \\cos \\theta) \\mathbf{n}.\n$$\n由于 $\\mathbf{n}$ 是单位向量，它非零，所以我们可以令等式两边的标量系数相等：\n$$\n1 = \\alpha(\\theta) \\cos \\theta.\n$$\n求解 $\\alpha(\\theta)$ 得到所需的闭式表达式：\n$$\n\\alpha(\\theta) = \\frac{1}{\\cos \\theta}.\n$$\n这就是使修正后的一致性项与理想项完全相等的修正因子的表达式。\n\n要理解为什么这能恢复最优收敛率，我们必须分析此修正的效果。使用不正确的法向量 $\\mathbf{n}_h$ 而不是 $\\mathbf{n}$ 会引入一致性误差。Nitsche 列式的一致性依赖于由体项分部积分产生的边界牵引力项 $\\int_{\\Gamma_D} (\\boldsymbol{\\sigma}(\\mathbf{u})\\mathbf{n}) \\cdot \\mathbf{v}_h \\, \\mathrm{d}\\Gamma$ 与 Nitsche 列式中相应项的精确抵消。如果使用 $\\mathbf{n}_h$，则会留下一个残余项 $\\int_{\\Gamma_D} (\\boldsymbol{\\sigma}(\\mathbf{u}) (\\mathbf{n} - \\mathbf{n}_h)) \\cdot \\mathbf{v}_h \\, \\mathrm{d}\\Gamma$。这种变分犯罪污染了列式，并导致收敛阶的降低。伴随一致性对解的泛函的最优收敛至关重要，但由于该方法对于原始问题不再是一致的，因此伴随一致性也丧失了。\n\n所提出的修正分两步进行：\n1. 投影 $P_{\\mathbf{n}}$ 作用于 $\\mathbf{n}_h$ 产生 $P_{\\mathbf{n}} \\mathbf{n}_h = (\\cos\\theta)\\mathbf{n}$。此操作从几何上分离出离散法向量 $\\mathbf{n}_h$ 在真实法向量 $\\mathbf{n}$ 方向上的分量，并消除了与真实边界相切的错误分量。\n2. 所得向量 $(\\cos\\theta)\\mathbf{n}$ 的方向正确，但其大小为 $\\cos\\theta$（由于 $|\\theta| \\ll 1$，$\\cos\\theta \\approx 1$），大小不正确。标量因子 $\\alpha(\\theta) = 1/\\cos\\theta$ 对该向量进行重新缩放，将其大小恢复为 1。\n\n因此，组合操作 $\\alpha(\\theta) P_{\\mathbf{n}} \\mathbf{n}_h$ 精确地重构了真实法向量 $\\mathbf{n}$。通过将此修正后的向量代入 Nitsche 一致性项，我们使其在数学上与使用 $\\mathbf{n}$ 的理想项完全相同。这完全消除了由法向量的几何近似引起的一致性误差。通过恢复对称列式的一致性，伴随一致性也得以恢复，并且标准误差估计保证了最优收敛率的实现，就如同使用了精确几何一样。", "answer": "$$\n\\boxed{\\frac{1}{\\cos(\\theta)}}\n$$", "id": "3584380"}]}