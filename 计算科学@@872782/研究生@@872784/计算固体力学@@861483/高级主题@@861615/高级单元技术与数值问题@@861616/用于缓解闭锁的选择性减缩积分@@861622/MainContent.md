## 引言
在[计算固体力学](@entry_id:169583)的广阔领域中，有限元法（FEM）是分析固体和结构行为不可或缺的工具。然而，在追求精确数值解的过程中，我们常常会遇到一种被称为“锁定”（locking）的棘手[数值病态](@entry_id:169044)。当有限元单元的离散[运动学](@entry_id:173318)空间过于“贫乏”，无法在满足材料本构或几何约束的同时精确地描述变形时，单元就会表现出非物理的、人为的刚度，导致位移预测严重偏低，应力结果失真。这一问题在模拟[近不可压缩材料](@entry_id:752388)（如橡胶）和薄型结构（如梁、板、壳）时尤为突出，构成了从学术研究到工程实践中的一个关键挑战。

本文旨在系统地剖析[锁定现象](@entry_id:751421)的根源，并详细介绍一种经典且极为有效的解决方案——[选择性减缩积分](@entry_id:168281)（Selective Reduced Integration, SRI）。通过阅读本文，您将不再将SRI仅仅视为一个数值“技巧”，而是深入理解其背后的力学原理和理论基础。文章将分为三个核心部分：

-   **原理与机制**：我们将首先深入探讨[锁定现象](@entry_id:751421)的本质，区分[体积锁定](@entry_id:172606)与剪切锁定，并阐明[选择性减缩积分](@entry_id:168281)是如何通过对能量项进行区别处理来“解锁”单元的。此外，我们还将揭示其与更深层次的[混合有限元](@entry_id:178533)理论之间的深刻联系。
-   **应用与跨学科连接**：随后，我们将展示SRI的强大生命力，考察其如何从基础的线性问题推广至[非线性](@entry_id:637147)材料、结构力学、多物理场耦合及动力学分析等复杂前沿领域，成为解决各类实际工程挑战的关键技术。
-   **动手实践**：最后，通过一系列精心设计的编程与推导练习，您将有机会亲手实现并验证SRI算法，将理论知识转化为解决实际问题的能力。

现在，让我们从第一章“原理与机制”开始，一同揭开[锁定现象](@entry_id:751421)的神秘面纱，并掌握[选择性减缩积分](@entry_id:168281)这一强大武器。

## 原理与机制

在固体和结构的有限元分析中，数值解的精度关键取决于所选离散函数空间逼近真实物理行为的能力。当[单元形函数](@entry_id:198891)所施加的离散[运动学](@entry_id:173318)约束过强，无法满足材料本构律或问题控制理论中固有的约束时，就会出现一种常见且有害的[数值病态](@entry_id:169044)，称为**锁定**（locking）。这会导致一种人为的刚度响应，单元“锁死”并且无法正确变形，从而严重低估位移并导致应力预测极不准确。本章旨在阐明锁定背后的原理和机制，并介绍一种经典而有效的补救措施：**[选择性减缩积分](@entry_id:168281)**。

### [锁定现象](@entry_id:751421)：一种人为的刚度

从本质上讲，锁定是一种近似失败，而不是代数可解性的问题。必须将其与[数值病态](@entry_id:169044)区分开，后者指的是代数系统 $\mathbf{K}\mathbf{d} = \mathbf{f}$ 的解对扰动的敏感性 [@problem_id:3599205]。虽然引起锁定的物理参数通常会导致刚度矩阵 $\mathbf{K}$ 的条件数很大，但这两个问题是截然不同的。一个锁定的系统，即使以完美的[数值精度](@entry_id:173145)求解，也会产生物理上不正确的结果，因为离散格式本身就是对连续问题的拙劣近似。因此，锁定是伽辽金[弱形式](@entry_id:142897)离散化的一种病态，其根源在于有限元插值空间与本构约束之间的不兼容。

这种现象在[固体力学](@entry_id:164042)的几个关键领域中表现得尤为明显，最著名的是在[近不可压缩材料](@entry_id:752388)（[体积锁定](@entry_id:172606)）和薄结构元件如梁和板（剪切锁定）的分析中。

### [近不可压缩](@entry_id:752387)弹性中的[体积锁定](@entry_id:172606)

考虑一个[微应变](@entry_id:191645)、各向同性的线弹性材料。其[应变能密度](@entry_id:200085) $\Psi$ 可以加法分解为控制体积变化的体积部分和控制形状变化的偏量部分：

$$
\Psi(\boldsymbol{\epsilon}) = \Psi_{\text{vol}}(\boldsymbol{\epsilon}) + \Psi_{\text{dev}}(\boldsymbol{\epsilon}) = \frac{1}{2}K(\operatorname{tr}(\boldsymbol{\epsilon}))^2 + \mu(\boldsymbol{\epsilon}_{\text{dev}}:\boldsymbol{\epsilon}_{\text{dev}})
$$

这里，$\boldsymbol{\epsilon}$ 是微[应变张量](@entry_id:193332)，$\operatorname{tr}(\boldsymbol{\epsilon})$ 是它的迹（代表体积应变 $\nabla \cdot \mathbf{u}$），$\boldsymbol{\epsilon}_{\text{dev}}$ 是它的偏量（无迹）部分。该材料由其[体积模量](@entry_id:160069) $K$ 和剪切模量 $\mu$ 来表征 [@problem_id:3599180]。

当材料抵[抗体](@entry_id:146805)积变化的能力远大于其抵抗形状变化的能力时，即 $K \gg \mu$，该材料被称为**[近不可压缩](@entry_id:752387)**。这对应于[泊松比](@entry_id:158876) $\nu$ 趋近于 $0.5$。在完美不可压缩的极限情况下，$K \to \infty$，为了使[应变能](@entry_id:162699)保持有限，解必须满足[运动学](@entry_id:173318)约束 $\operatorname{tr}(\boldsymbol{\epsilon}) = \nabla \cdot \mathbf{u} = 0$。在[近不可压缩](@entry_id:752387)的情况下，由非常大的体积模量 $K$ 缩放的体积能项，就像一个严厉的惩罚项，强制执行约束 $\nabla \cdot \mathbf{u} \approx 0$ [@problem_id:3599145]。

当我们使用基于位移的有限元法对问题进行离散化时，[单元刚度矩阵](@entry_id:139369)的积分是通过数值求积（通常是[高斯-勒让德法则](@entry_id:636900)）来计算的。一个“完全”积分法则是指对于给定的单元公式，有足够多的积分点来精确（或近乎精确）地积分[刚度矩阵](@entry_id:178659)的被积函数。这种[数值积分](@entry_id:136578)实际上试图在每个[高斯点](@entry_id:170251)上强制执行[不可压缩性约束](@entry_id:750592)。

这就是低阶单元问题的症结所在。以一个二维四节点[双线性](@entry_id:146819)[四边形单元](@entry_id:176937)（$Q_4$）为例。该单元内的位移场是双线性的。因此，[体积应变](@entry_id:267252) $\operatorname{tr}(\boldsymbol{\epsilon}_h) = \partial u_x/\partial x + \partial u_y/\partial y$ 是[局部坐标](@entry_id:181200)的线性函数，仅能由三个独立参数描述（例如，$A+B\xi+C\eta$）。然而，一个完全的 $2 \times 2$ 高斯求积法则在四个不同的[高斯点](@entry_id:170251)上计算体积能的被积函数。在[近不可压缩](@entry_id:752387)极限下，这在运动学场上施加了四个局部约束 $\operatorname{tr}(\boldsymbol{\epsilon}_h(\boldsymbol{x}_i)) = 0$，而该场只有三种体积变形模式。系统被过度约束了。线性应变场在这四个点上为零的唯一方法是它在单元内处处为零。这个过分严格的条件阻止了单元以需要轻微体积变化的模式（例如弯曲时发生的模式）变形，导致其表现出人为的刚性。这就是**[体积锁定](@entry_id:172606)** [@problem_id:3599145]。其他低阶单元，如三维中的8节点三线性[六面体单元](@entry_id:174602)（$Q_1$），也会出现类似的失配 [@problem_id:3599200]。

### 梁和板中的剪切锁定

在分析薄结构元件时，也会出现类似的[锁定现象](@entry_id:751421)。考虑一个使用铁木辛柯[梁理论](@entry_id:176426)建模的梁，与更简单的欧拉-伯努利理论不同，该理论考虑了[横向剪切变形](@entry_id:176673)。其运动学由横向位移 $w(x)$ 和[横截面](@entry_id:154995)转角 $\theta(x)$ 描述。横向剪切应变由梁中心线的斜率与[横截面](@entry_id:154995)转角之差给出 [@problem_id:3599204]：

$$
\gamma_{xz} = \frac{dw}{dx} - \theta_x
$$

梁的应变能包含一个与曲率 $(\partial \theta_x / \partial x)^2$ 成正比的弯曲分量，以及一个与剪切应变 $\gamma_{xz}^2$ 成正比的剪切分量。对于非常薄的梁（厚长比 $t/L \ll 1$），真实的物理行为接近于[欧拉-伯努利梁](@entry_id:749104)，其横向剪切应变可以忽略不计，即 $\gamma_{xz} \to 0$。由剪切刚度 $\kappa G A$ 缩放的剪切能项，就像一个惩罚项，强制执行此约束。

如果我们使用低阶有限元，例如对 $w$ 和 $\theta_x$ 都使用线性插值的二[节点单元](@entry_id:752523)，就会出现锁定问题。在这样一个单元内，$\frac{dw}{dx}$ 是常数，而 $\theta_x$ 是线性的。在单元内处处强制执行约束 $\gamma_{xz} = 0$ 将要求线性函数 $\theta_x$ 是一个等于 $\frac{dw}{dx}$ 的常数，这严重限制了单元的弯曲能力。对剪切能项进行完全积分试图在多个点上强制执行这个过度限制的约束，导致了被称为**剪切锁定**的伪刚度响应。单元无法在不产生寄生剪切能的情况下自由弯曲，因此它“锁住”了 [@problem_id:3599204] [@problem_id:3599205]。

### 补救措施：[选择性减缩积分](@entry_id:168281)

缓解锁定的关键是在不损害单元整体稳定性和精度的前提下，削弱对有问题的运动学约束的强制执行。一种天真的方法可能是**一致[减缩积分](@entry_id:167949)（URI）**，即对整个刚度矩阵的计算减少求积点的数量。例如，对 $Q_4$ 单元使用单个[高斯点](@entry_id:170251)。这减少了约束的数量，确实可以减轻锁定。

然而，URI 引入了一个严重的副作用：**[沙漏模式](@entry_id:174855)**。这些是伪非物理变形模式，在减缩的积分点集上不产生应变，因此不储存任何[应变能](@entry_id:162699) [@problem_id:3599151]。在数学上，[沙漏模式](@entry_id:174855)是节点位移向量 $\mathbf{d}$，它属于[秩亏](@entry_id:754065)的、[减缩积分](@entry_id:167949)的刚度矩阵 $\mathbf{K}_e$ 的零空间，但不是[刚体运动](@entry_id:193355) [@problem_id:3599196]。对于用单个[高斯点](@entry_id:170251)积分的[8节点六面体单元](@entry_id:750117)，有24个自由度。单个积分点提供了6个应变约束，留下一个维度为 $24-6=18$ 的[零空间](@entry_id:171336)。由于只有6个[刚体运动](@entry_id:193355)模式，这留下了 $18-6=12$ 个伪[沙漏模式](@entry_id:174855) [@problem_id:3599196]。这些模式在解中表现为不受控制的、网格尺度的[振荡](@entry_id:267781)，使得单元不稳定且无法使用，除非有特殊的稳定化方案。

一个远为稳健和优雅的解决方案是**[选择性减缩积分](@entry_id:168281)（SRI）**。SRI 的原理是*选择性地*仅对引起锁定的那部分应变能采用[减缩积分](@entry_id:167949)，同时对其余表现良好的部分保留完全积分以维持稳定性。

-   **对于[体积锁定](@entry_id:172606)**：[刚度矩阵](@entry_id:178659)被加法分解为体积部分和偏量部分，$\mathbf{K}_e = \mathbf{K}^{\text{vol}}_e + \mathbf{K}^{\text{dev}}_e$。SRI 涉及使用减缩求积法则（例如，1个点）来计算 $\mathbf{K}^{\text{vol}}_e$，并使用完全求积法则（例如，对于 $Q_1$ 六面体使用 $2 \times 2 \times 2$ 个点）来计算 $\mathbf{K}^{\text{dev}}_e$。这种方法削弱了[不可压缩性约束](@entry_id:750592)，缓解了锁定，而完全积分的偏量项则提供了抑制沙漏不稳定性所需的秩 [@problem_id:3599200] [@problem_id:3599151]。

-   **对于剪切锁定**：梁的刚度矩阵被分解为弯曲部分和剪切部分。SRI 涉及对剪切项使用减缩法则（例如，1个点），对弯曲项使用完全法则（例如，2个点）。这以一种较弱的、平均的意义上强制执行零剪切应变约束，从而缓解了锁定，同时准确地捕捉了弯曲行为并确保了稳定性 [@problem_id:3599204]。

通过仅降低双线性形式中由约束主导的部分的秩，SRI 允许离散空间以较弱的意义满足约束，从而恢复了单元的性能 [@problem_id:3599205]。

### 理论基础：与混合公式的联系

虽然 SRI 可以被看作是一个聪明的数值“技巧”，但它拥有一个深刻而严谨的理论依据，植根于**[混合有限元法](@entry_id:165231)**的理论。

处理像[不可压缩性](@entry_id:274914)这样的约束问题的另一种方法是使用拉格朗日乘子将约束明确地引入[变分原理](@entry_id:198028)中。对于不可压缩性，拉格朗日乘子是[静水压力](@entry_id:275365) $p$。这导致了一个**混合位移-压力（u/p）公式**，其中位移 $\mathbf{u}$ 和压力 $p$ 都是独立的未知数 [@problem_id:3599213]。离散混合公式的稳定性由著名的 **Ladyzhenskaya–Babuška–Brezzi (LBB) 条件**（也称为 **[inf-sup 条件](@entry_id:174538)**）决定：

$$
\inf_{q_h \in Q_h, \, q_h \neq 0} \; \sup_{\mathbf{v}_h \in V_h, \, \mathbf{v}_h \neq 0} \; \frac{\int_{\Omega} (\nabla \cdot \mathbf{v}_h) \, q_h \, \mathrm{d}x}{\|\mathbf{v}_h\|_{H^1(\Omega)} \, \|q_h\|_{L^2(\Omega)}} \ge \beta \gt 0
$$

这里，$V_h$ 和 $Q_h$ 分别是位移和压力的离散空间。[inf-sup 条件](@entry_id:174538)要求这两个空间之间存在兼容性，确保离散压力约束的数量不会压倒位移空间中的[运动学](@entry_id:173318)自由度。LBB 条件的失效（即随着[网格细化](@entry_id:168565) $\beta \to 0$）会导致公式不稳定，通常表现为压[力场](@entry_id:147325)中的伪振荡 [@problem_id:3599213]。

位移法公式中的[锁定现象](@entry_id:751421)与相关混合公式中 LBB 条件的失效是直接对应的。例如，对位移和压力使用相同的插值（例如，$Q_1$ 位移和 $Q_1$ 压力）是 LBB 不稳定配对的典型例子 [@problem_id:3599213]。相应的仅位移 $Q_1$ 单元，当完全积分时，表现出严重的[体积锁定](@entry_id:172606)。

这种深刻的联系，被称为 **Malkus-Hughes 等效原理**，即对于许多常见单元，基于 SRI 的位移法公式在代数上与一个稳定的混合公式相同，后者在单元级别上消除了压力变量（这个过程称为静力凝聚） [@problem_id:3599172] [@problem_id:3599213]。例如，将单点求积应用于 $Q_1$ 单元的体积项，在数学上等效于使用 $Q_1$ 位移和分片常数压力（$P_0$）的混合公式，这种配对在合适的网格上是满足 LBB 条件的。减缩求积法则有效地将离散散度投影到一个更低阶（且稳定）的压力空间上 [@problem_id:3599172] [@problem_id:3599213]。类似的相关技术，如**$\bar{B}$ 方法**，也有类似的解释，其中体积应变算子被明确投影到一个单元常数值上 [@problem_id:3599180] [@problem_id:3599151]。

这种等效性为 SRI 提供了坚实的理论基础，将其从一种启发式的补救措施提升为一种计算上高效、理论上严格稳定的[混合方法](@entry_id:163463)的实现。

### 更广阔的背景：增强假设应变

[选择性减缩积分](@entry_id:168281)是一种功能强大且广泛使用的技术，但它只是为克服锁定而设计的几种先进“单元技术”之一。另一类著名的方法是基于**增强假设应变（Enhanced Assumed Strain, EAS）**。[EAS方法](@entry_id:748781)不是修改[数值积分](@entry_id:136578)，而是通过在每个单元内用额外的、不相容的应变模式来增强应变场，从而修改变分原理本身。选择这些模式是为了丰富单元的[运动学](@entry_id:173318)能力，使其能够在不发生锁定的情况下满足约束。一个关键的一致性条件要求这些增强模式在恒定应[力场](@entry_id:147325)下不做功 [@problem_id:3599152]。虽然[EAS方法](@entry_id:748781)的公式和实现通常更为复杂，但它们为设计高性能单元提供了一个通用框架，这些单元可以通刚体位移检验（patch test），且无需借助[减缩积分](@entry_id:167949)即可避免锁定 [@problem_id:3599152]。这类替代框架的存在，凸显了现代有限[元理论](@entry_id:638043)在应对[运动学](@entry_id:173318)约束这一根本挑战方面的丰富性。