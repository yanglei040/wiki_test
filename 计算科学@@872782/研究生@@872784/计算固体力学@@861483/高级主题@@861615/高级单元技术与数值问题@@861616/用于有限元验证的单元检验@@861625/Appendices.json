{"hands_on_practices": [{"introduction": "本练习是验证单元性能的经典补丁测试。我们将从一个已知的、均匀的应变状态出发，通过计算节点位移和单元应力，亲手验证一个标准的双线性四边形单元片体能够精确地再现线性位移场和恒定应力场。这个过程将加深你对有限元法如何处理简单载荷情况的理解，并展示其在理想条件下的精确性 [@problem_id:3606154]。", "problem": "考虑一个用于小应变线性弹性平面应力问题的有限元法 (FEM) 中的两乘二双线性等参四边形单元正方形网格片。物理域为正方形 $[0,L] \\times [0,L]$，通过均匀网格被划分为四个相等的单元，节点坐标位于\n$$(x_i,y_i) \\in \\{0,\\tfrac{L}{2},L\\} \\times \\{0,\\tfrac{L}{2},L\\},$$\n且节点按从左到右、从下到上的顺序编号如下：\n$$\n\\text{Node }1:(0,0),\\quad \\text{Node }2:(\\tfrac{L}{2},0),\\quad \\text{Node }3:(L,0),\\\\\n\\text{Node }4:(0,\\tfrac{L}{2}),\\quad \\text{Node }5:(\\tfrac{L}{2},\\tfrac{L}{2}),\\quad \\text{Node }6:(L,\\tfrac{L}{2}),\\\\\n\\text{Node }7:(0,L),\\quad \\text{Node }8:(\\tfrac{L}{2},L),\\quad \\text{Node }9:(L,L).\n$$\n假设为小应变运动学，其中平面内应变定义为\n$$\\varepsilon_{xx}=\\frac{\\partial u}{\\partial x},\\quad \\varepsilon_{yy}=\\frac{\\partial v}{\\partial y},\\quad \\gamma_{xy}=\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x},$$\n其中位移分量为 $u(x,y)$ 和 $v(x,y)$。在整个网格片上施加一个均匀应变状态：\n$$\\varepsilon_{xx}=\\varepsilon_0,\\quad \\varepsilon_{yy}=0,\\quad \\gamma_{xy}=0,$$\n刚体平移和旋转通过约束条件 $u(0,0)=0$ 和 $v(0,0)=0$ 来固定。材料是线性弹性、均匀且各向同性的，其杨氏模量为 $E$，泊松比为 $\\nu$，应力-应变关系为平面应力关系。\n\n任务：\n1. 从小应变运动学定义和均匀应变设定出发，推导出与约束条件一致的精确位移场 $(u(x,y),v(x,y))$，然后构建九节点网格片的全局节点位移向量，其顺序为 $\\left[u_1, v_1, u_2, v_2, \\dots, u_9, v_9\\right]$。\n2. 利用当节点值取自精确场时，双线性等参四边形单元能够精确重现全局线性位移场这一事实，推导出在平面应力条件下网格片产生的组合应力场。请用 $E$、$\\nu$ 和 $\\varepsilon_0$ 的符号形式表示应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\tau_{xy}$。\n\n位移单位以米表示，应力单位以帕斯卡表示。最终答案必须是一个单行矩阵，包含有序的节点位移分量，后跟三个应力分量，所有这些都以闭式解析表达式给出。无需四舍五入。", "solution": "该问题要求确定在给定的均匀应变场下，有限元网格片的节点位移和由此产生的应力状态。解答过程主要分为两部分：首先，推导精确位移场及相应的节点位移；其次，利用有限元单元的特性来确定应力场。\n\n第1部分：精确位移场和节点位移的推导\n\n问题指定了整个域内的均匀应变状态：\n$$ \\varepsilon_{xx} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy} = 0 $$\n$$ \\gamma_{xy} = 0 $$\n\n小应变运动学关系如下：\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n\n我们对这些关系进行积分，以求得位移场 $(u(x,y), v(x,y))$。\n从 $\\frac{\\partial u}{\\partial x} = \\varepsilon_0$ 出发，我们对 $x$ 进行积分，得到：\n$$ u(x,y) = \\int \\varepsilon_0 \\, dx = \\varepsilon_0 x + f(y) $$\n其中 $f(y)$ 是关于 $y$ 的任意函数。\n\n从 $\\frac{\\partial v}{\\partial y} = 0$ 出发，我们对 $y$ 进行积分，得到：\n$$ v(x,y) = \\int 0 \\, dy = g(x) $$\n其中 $g(x)$ 是关于 $x$ 的任意函数。\n\n接下来，我们使用剪应变条件 $\\gamma_{xy} = 0$：\n$$ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 0 $$\n代入 $u$ 和 $v$ 的表达式：\n$$ \\frac{\\partial}{\\partial y}(\\varepsilon_0 x + f(y)) + \\frac{\\partial}{\\partial x}(g(x)) = 0 $$\n$$ \\frac{df}{dy} + \\frac{dg}{dx} = 0 \\implies \\frac{df}{dy} = -\\frac{dg}{dx} $$\n由于左侧仅是 $y$ 的函数，而右侧仅是 $x$ 的函数，因此它们必须都等于一个常数，我们称之为 $C_1$。\n$$ \\frac{df}{dy} = C_1 \\implies f(y) = \\int C_1 \\, dy = C_1 y + C_2 $$\n$$ \\frac{dg}{dx} = -C_1 \\implies g(x) = \\int -C_1 \\, dx = -C_1 x + C_3 $$\n这里，$C_2$ 和 $C_3$ 是积分常数。\n\n将这些函数代回，得到给定均匀应变状态下的通用位移场：\n$$ u(x,y) = \\varepsilon_0 x + C_1 y + C_2 $$\n$$ v(x,y) = -C_1 x + C_3 $$\n包含 $C_1, C_2, C_3$ 的项代表刚体运动。$(C_2, C_3)$ 是均匀平移，而 $C_1 y$ 和 $-C_1 x$ 项代表绕原点的小角度刚体旋转。问题指出刚体平移和旋转是固定的。给出的具体约束是 $u(0,0)=0$ 和 $v(0,0)=0$。\n应用这些约束：\n$$ u(0,0) = \\varepsilon_0(0) + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n$$ v(0,0) = -C_1(0) + C_3 = 0 \\implies C_3 = 0 $$\n这些约束固定了刚体平移。问题的措辞暗示刚体旋转也应被抑制。旋转分量为 $\\omega_z = \\frac{1}{2}(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}) = \\frac{1}{2}(-C_1 - C_1) = -C_1$。要将旋转固定为零，我们必须设置 $C_1 = 0$。\n\n因此，对应于无刚体运动的纯应变状态的精确位移场是：\n$$ u(x,y) = \\varepsilon_0 x $$\n$$ v(x,y) = 0 $$\n该场在其空间坐标上是线性的。\n\n接下来，我们在九个节点坐标处计算这个精确位移场，以构建全局节点位移向量。节点坐标已给出，向量按 $[u_1, v_1, u_2, v_2, \\dots, u_9, v_9]$ 的顺序排列。\n\n节点1：$(x_1,y_1) = (0,0) \\implies u_1 = \\varepsilon_0(0) = 0$, $v_1=0$\n节点2：$(x_2,y_2) = (\\frac{L}{2},0) \\implies u_2 = \\varepsilon_0(\\frac{L}{2})$, $v_2=0$\n节点3：$(x_3,y_3) = (L,0) \\implies u_3 = \\varepsilon_0 L$, $v_3=0$\n节点4：$(x_4,y_4) = (0,\\frac{L}{2}) \\implies u_4 = \\varepsilon_0(0) = 0$, $v_4=0$\n节点5：$(x_5,y_5) = (\\frac{L}{2},\\frac{L}{2}) \\implies u_5 = \\varepsilon_0(\\frac{L}{2})$, $v_5=0$\n节点6：$(x_6,y_6) = (L,\\frac{L}{2}) \\implies u_6 = \\varepsilon_0 L$, $v_6=0$\n节点7：$(x_7,y_7) = (0,L) \\implies u_7 = \\varepsilon_0(0) = 0$, $v_7=0$\n节点8：$(x_8,y_8) = (\\frac{L}{2},L) \\implies u_8 = \\varepsilon_0(\\frac{L}{2})$, $v_8=0$\n节点9：$(x_9,y_9) = (L,L) \\implies u_9 = \\varepsilon_0 L$, $v_9=0$\n\n全局节点位移向量 $\\mathbf{d}$ 是一个18分量的向量：\n$$ \\mathbf{d} = \\left[ 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0 \\right]^T $$\n\n第2部分：组合应力场的推导\n\n问题指出了双线性等参四边形单元的一个关键特性：它们能够精确地重现全局线性位移场。这个特性被称为通过完备性网格检验 (Patch Test)。由于精确位移场 $(u(x,y) = \\varepsilon_0 x, v(x,y) = 0)$ 是线性的，所以根据精确节点位移构建的有限元近似解 $u^h(x,y), v^h(x,y)$ 将在网格片内的任何地方都与精确场完全相同。\n$$ u^h(x,y) = u(x,y) = \\varepsilon_0 x $$\n$$ v^h(x,y) = v(x,y) = 0 $$\n因此，从有限元解计算出的应变是恒定的，并且等于给定的应变：\n$$ \\varepsilon_{xx}^h = \\frac{\\partial u^h}{\\partial x} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy}^h = \\frac{\\partial v^h}{\\partial y} = 0 $$\n$$ \\gamma_{xy}^h = \\frac{\\partial u^h}{\\partial y} + \\frac{\\partial v^h}{\\partial x} = 0 + 0 = 0 $$\n应力场可以通过使用线性弹性各向同性材料的平面应力本构关系从应变场获得。该关系为：\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} $$\n代入应变值 $\\{\\varepsilon_0, 0, 0\\}^T$：\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_0 \\\\ 0 \\\\ 0 \\end{Bmatrix} $$\n这给出了应力分量：\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2} (1 \\cdot \\varepsilon_0 + \\nu \\cdot 0) = \\frac{E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2} (\\nu \\cdot \\varepsilon_0 + 1 \\cdot 0) = \\frac{\\nu E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\tau_{xy} = \\frac{E}{1-\\nu^2} \\left( \\frac{1-\\nu}{2} \\cdot 0 \\right) = 0 $$\n由于应变场在整个网格片上是均匀的，因此应力场也是均匀的。\n\n最后，我们将最终答案组合成一个单行矩阵，其中包含18个有序的节点位移分量，后跟3个应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy})$。", "answer": "$$ \\boxed{\\begin{pmatrix} 0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  \\frac{E \\varepsilon_0}{1-\\nu^2}  \\frac{\\nu E \\varepsilon_0}{1-\\nu^2}  0 \\end{pmatrix}} $$", "id": "3606154"}, {"introduction": "在验证了标准单元能够通过补丁测试后，我们通过一个思想实验来探究其背后的理论基础。本练习将构建一组违反“单位分解”（Partition of Unity）性质的假想形函数，并分析其后果 [@problem_id:3606135]。通过预测这种不满足一致性条件的单元在均匀应变场下的表现，你将深刻理解形函数的基本性质对于单元收敛性和正确性的关键作用。", "problem": "考虑一个在覆盖矩形域 $\\Omega = [0,2L] \\times [0,2H]$ 的 $2 \\times 2$ 相同四节点等参四边形单元网格上进行的、针对有限元法 (FEM) 的小应变、二维、线性弹性单元检验 (patch test)。设精确位移场为一个均匀应变状态，\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\,\\mathbf{x}, \\quad \\text{其中 } \\mathbf{B} \\text{ 是一个常数 } 2 \\times 2 \\text{ 矩阵}, \\quad \\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B}),\n$$\n且体力为零。在整个边界 $\\partial \\Omega$ 上的节点位移是给定的，以使每个边界节点 $i$ 的节点值都精确满足 $\\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\,\\mathbf{x}_i$。\n\n对于每个单元，几何映射使用母空间 $(\\xi,\\eta) \\in [-1,1]^2$ 上的标准双线性形函数，\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\n从而物理坐标被插值为 $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$。然而，假设位移插值通过仅用一个气泡函数修改第一个位移形函数而违反了单位分解 (Partition of Unity, PoU) 性质：\n$$\n\\tilde{N}_1(\\xi,\\eta) = N_1(\\xi,\\eta) + \\beta\\,b(\\xi,\\eta), \\quad \\tilde{N}_2 = N_2, \\quad \\tilde{N}_3 = N_3, \\quad \\tilde{N}_4 = N_4,\n$$\n其中 $\\beta \\neq 0$ 是一个固定的无量纲参数，且 $b(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi^2)(1-\\eta^2)$ 在单元边界上满足 $b=0$ 但在单元内部 $b>0$。因此，在单元内部 $\\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta\\,b \\neq 1$，而在单元边界上 $\\sum_{i=1}^{4} \\tilde{N}_i = 1$。\n\n在 $2 \\times 2$ 单元块的每个单元上使用上述假设的位移形函数 $\\{\\tilde{N}_i\\}$，并施加与均匀应变场对应的精确节点边界位移，下列哪项最能描述计算出的应变场的定性误差和单元检验的结果？\n\nA. 计算出的应变场在整个单元块上保持完全均匀，因为节点边界位移强制施加了精确解；单元检验通过。\n\nB. 计算出的位移场在所有单元边界上都是精确的，但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变，导致非恒定的应力和不一致的节点反力；单元检验未通过，且除非 $\\beta \\to 0$，否则误差不会消失。\n\nC. 由于违反单位分解性质，仅失去了刚体运动的再现能力，但均匀应变的再现能力保持精确；单元检验通过。\n\nD. 此修改引入了一个零能沙漏模式，该模式消除了刚度，导致在整个单元块上产生恒为零的应力，而不管施加的均匀应变如何。\n\nE. 违反单位分解性质会诱导出一个伪恒定体力，使得边界反力保持正确并且均匀应变得以再现；单元检验通过。", "solution": "本问题旨在检验对拼凑检验背后核心原理的理解，特别是形函数必须满足的基本性质。一个协调的单元要通过拼凑检验，其形函数必须能够精确再现任意线性位移场，这包括刚体运动（常数场）和恒定应变（线性场）。\n\n1.  **分析修改后的形函数性质**：\n    问题的核心在于位移插值使用了修改后的形函数 $\\{\\tilde{N}_i\\}$。我们首先分析这些形函数的和：\n    $$ \\sum_{i=1}^{4} \\tilde{N}_i = \\tilde{N}_1 + N_2 + N_3 + N_4 = (N_1 + \\beta b) + N_2 + N_3 + N_4 = \\left(\\sum_{i=1}^{4} N_i\\right) + \\beta b $$\n    由于标准的双线性形函数 $N_i$ 满足单位分解（Partition of Unity, PoU）性质，即 $\\sum N_i = 1$，所以修改后的形函数之和为：\n    $$ \\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta b(\\xi,\\eta) $$\n    在单元内部，气泡函数 $b(\\xi,\\eta) > 0$ 且 $\\beta \\neq 0$，因此 $\\sum \\tilde{N}_i \\neq 1$。这意味着单位分解性质被违反。\n\n2.  **检验常数场（刚体平移）的再现能力**：\n    如果施加一个刚体平移，所有节点的位移都等于一个常向量 $\\mathbf{u}_0$。插值得到的位移场为：\n    $$ \\mathbf{u}^h = \\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{u}_0 = \\left(\\sum \\tilde{N}_i\\right) \\mathbf{u}_0 = (1 + \\beta b) \\mathbf{u}_0 \\neq \\mathbf{u}_0 $$\n    由于单元内部的位移场不等于常数 $\\mathbf{u}_0$，该单元无法精确再现刚体运动。\n\n3.  **检验线性场（恒定应变）的再现能力**：\n    拼凑检验要求精确再现一个线性位移场 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$。我们检验使用精确的节点位移 $\\mathbf{d}_i = \\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\mathbf{x}_i$ 进行插值，能否恢复原始的线性场：\n    $$ \\mathbf{u}^h = \\sum \\tilde{N}_i \\mathbf{d}_i = \\sum \\tilde{N}_i (\\mathbf{B}\\mathbf{x}_i) = \\mathbf{B} \\left( \\sum \\tilde{N}_i \\mathbf{x}_i \\right) $$\n    展开求和项：\n    $$ \\sum \\tilde{N}_i \\mathbf{x}_i = (N_1 + \\beta b)\\mathbf{x}_1 + \\sum_{i=2}^4 N_i \\mathbf{x}_i = \\left(\\sum N_i \\mathbf{x}_i\\right) + \\beta b \\mathbf{x}_1 $$\n    对于等参单元，几何坐标由标准形函数插值得到，即 $\\mathbf{x} = \\sum N_i \\mathbf{x}_i$。因此：\n    $$ \\mathbf{u}^h = \\mathbf{B} (\\mathbf{x} + \\beta b \\mathbf{x}_1) = \\mathbf{B}\\mathbf{x} + \\beta b (\\mathbf{B}\\mathbf{x}_1) = \\mathbf{u}(\\mathbf{x}) + \\beta b \\mathbf{u}(\\mathbf{x}_1) $$\n    插值场 $\\mathbf{u}^h$ 并不等于精确的线性场 $\\mathbf{u}(\\mathbf{x})$，而是多出了一个误差项 $\\beta b \\mathbf{u}(\\mathbf{x}_1)$。此误差项在单元内部非零。这证明该单元格式无法精确再现线性位移场，因此**拼凑检验必定失败**。\n\n4.  **分析计算出的应变场**：\n    计算应变场需要对位移场求梯度：$\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}^h)$。\n    $$ \\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}) + \\mathrm{sym}(\\nabla [\\beta b \\mathbf{u}(\\mathbf{x}_1)]) = \\boldsymbol{\\varepsilon}^\\star + \\beta \\, \\mathrm{sym}((\\nabla b) \\otimes \\mathbf{u}(\\mathbf{x}_1)) $$\n    精确应变 $\\boldsymbol{\\varepsilon}^\\star$ 是一个常数。然而，计算出的应变场 $\\boldsymbol{\\varepsilon}^h$ 包含一个误差项，该误差项与气泡函数的梯度 $\\nabla b$ 成正比。由于 $\\nabla b$ 在单元内部通常不是零或常数，而是位置的函数，因此计算出的应变场将是**非均匀**且**振荡**的。其量级与 $\\beta$ 成正比。非均匀的应变将导致非恒定的应力场，这在物理上是不正确的，并且会导致内部节点力不平衡。\n\n5.  **评估选项**：\n    *   **A**: 错误。单元检验失败，应变场非均匀。\n    *   **B**: 正确。该选项准确地描述了后果：单元内部出现与 $\\beta$ 成正比的非均匀、振荡应变，导致非恒定应力和不一致的节点力。它正确地指出单元检验未通过，且误差不会消失（除非 $\\beta=0$）。尽管其关于“位移场在所有单元边界上都是精确的”陈述对于内部边界是一个简化（因为内部节点位移的解将是不精确的），但它对单元内部的物理行为以及测试结果的描述是所有选项中最准确的。\n    *   **C**: 错误。不仅刚体运动再现能力丧失，恒定应变的再现能力也丧失了。单元检验失败。\n    *   **D**: 错误。这种修改引入的是不协调性（inconsistency），而非必然的零能模式。计算出的应力不会恒为零。\n    *   **E**: 错误。单元检验失败，且诱导的误差不是一个恒定体力所能等效的。\n\n因此，选项B最能描述该不协调单元在拼凑检验中的表现。", "answer": "$$\\boxed{B}$$", "id": "3606135"}, {"introduction": "将理论知识应用于实践是掌握有限元方法的关键。本练习模拟了在开发或验证有限元程序时实施补丁测试的完整流程 [@problem_id:3606149]。你需要像一位开发者一样，仔细评估各种实现细节——从网格划分、边界条件设置到积分方案和误差度量——从而选出最严谨、最可靠的测试方案，以确保单元的基本性能得到正确验证。", "problem": "考虑有界域 $\\Omega \\subset \\mathbb{R}^2$（其边界为 $\\partial \\Omega$）上的小应变线性弹性静力学问题，其控制方程为 $\\Omega$ 内的 $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\boldsymbol{0}$。其中，$\\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$，而 $\\mathbb{C}$ 是由杨氏模量 $E$ 和泊松比 $\\nu$ 在平面应力或平面应变条件下决定的线性弹性本构张量。一个人为构造的线性位移场 $\\boldsymbol{u}^\\star(\\boldsymbol{x}) = \\boldsymbol{a} + \\mathbf{B}\\,\\boldsymbol{x}$（其中 $\\boldsymbol{a} \\in \\mathbb{R}^2$ 为常向量，$\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$ 为常矩阵）会引起常应变 $\\boldsymbol{\\varepsilon}^\\star$ 和常应力 $\\boldsymbol{\\sigma}^\\star$。有限元法（FEM）的经典斑块检验（patch test）断言，只要单元级积分使用具有足够精度的求积方法进行计算，那么在适当的边界条件和体力为零的情况下，一个协调单元应当能精确地再现这种状态。\n\n现要求您为有限元代码中的斑块检验选择一个最完整且最稳健的实现流程，该流程应涵盖网格生成、参数赋值 $(E,\\nu)$、求积选择、边界条件施加，以及诸如 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$ 等误差度量的后处理。该流程应能在一阶单元（例如，线性三角形和双线性四边形）应用于仿射和轻度扭曲的网格时，可靠地诊断其“通过”或“不通过”，并且不受非单元多项式协调性所固有的混淆效应的干扰。\n\n以下哪个选项最能满足这些要求？\n\nA. 在 $\\Omega$ 中生成一个多单元斑块（例如，一个至少包含 $3 \\times 3$ 个一阶单元的规则或轻度扭曲的网格）。赋予材料参数 $E > 0$ 和一个适中的 $\\nu$ 值（如 $\\nu = 0.30$）（平面应力或平面应变），并将体力设置为 $\\boldsymbol{0}$。为所选的插值和映射选择能够精确积分单元刚度的单元求积方法：对于线性三角形，使用 $1$ 点精确面积求积；对于等参双线性四边形，使用完整的 $2 \\times 2$ 高斯求积。在斑块的所有边界节点上施加狄利克雷（Dirichlet）边界条件 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。组装并求解。使用至少与刚度矩阵组装时所用阶数相同（或更高阶）的求积方法，通过计算 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} \\left\\|\\nabla \\boldsymbol{u}_h(\\boldsymbol{x}) - \\nabla \\boldsymbol{u}^\\star\\right\\|^2 \\,\\mathrm{d}\\Omega\\right)^{1/2}$ 来进行误差后处理。如果误差达到或接近舍入误差水平，并且恢复的应力在单元内是常数且等于 $\\boldsymbol{\\sigma}^\\star$，则宣布“通过”。\n\nB. 生成一个单单元域 $\\Omega$，并赋值 $E > 0$ 以及任意 $\\nu \\in (-1,0.5)$。使用任何可用的求积法则。仅在单元的角节点上施加 $\\boldsymbol{u}^\\star$ 的节点值；其他边界节点（若有）不加约束。求解，如果节点位移误差 $\\max_{\\text{nodes}} \\left\\|\\boldsymbol{u}_h - \\boldsymbol{u}^\\star\\right\\|$ 为零，则宣布“通过”，而不计算梯度级别的误差范数。\n\nC. 生成一个多单元斑块。赋值 $E > 0$ 和适中的 $\\nu$。在整个边界 $\\partial \\Omega$ 上施加纯面力边界条件 $\\boldsymbol{t} = \\boldsymbol{\\sigma}^\\star \\boldsymbol{n}$ 且不施加额外约束，并对四边形单元使用减缩积分（例如，$1 \\times 1$ 高斯积分）以避免过度刚硬。仅在单元高斯点处计算误差，若该处误差为零则宣布“通过”。\n\nD. 生成一个多单元斑块。在纯位移格式中赋值 $E > 0$ 和接近不可压缩的 $\\nu = 0.499$。对所有单元使用完全数值积分，并在 $\\partial \\Omega$ 上施加 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。如果 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)}$ 可测且非零，则宣布“不通过”，并将其解释为单元未能通过斑块检验。\n\nE. 生成一个多单元斑块并赋值 $E > 0$ 和适中的 $\\nu$。在组装时使用完全求积，并在 $\\partial \\Omega$ 上施加 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。通过计算由周围单元梯度简单平均得到的节点梯度来后处理斑块检验，计算 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$ 时不进行域积分，如果平均后的节点梯度误差低于容差，则宣布“通过”。\n\n选择正确的选项。", "solution": "问题要求选择一个最完整且最稳健的拼凑检验（patch test）实现流程。一个稳健的流程必须能可靠地检验单元的多项式协调性，同时避免其他数值效应（如锁定、沙漏、边界条件问题）的干扰。\n\n拼凑检验的核心是验证有限元格式能否精确再现任意的常应变状态。这要求在施加与线性位移场 $\\boldsymbol{u}^\\star$ 一致的边界条件后，有限元解 $\\boldsymbol{u}_h$ 能在整个检验区域（斑块）内精确满足 $\\nabla \\boldsymbol{u}_h = \\nabla \\boldsymbol{u}^\\star$。\n\n我们根据以下关键原则来评估每个选项：\n1.  **网格（斑块）**：应由多个单元组成，包含内部节点，并最好包含扭曲单元，以检验单元间的协调性和对几何失真的鲁棒性。\n2.  **边界条件**：必须能唯一地、稳定地施加线性位移场。在所有边界节点上施加狄利克雷（位移）边界条件 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ 是最直接的方法。\n3.  **材料参数**：应选择适中的、非极端的参数（如 $\\nu=0.3$），以将协调性检验与体积锁定等其他效应分离开。\n4.  **数值积分**：积分阶数必须足够高，以确保在给定线性位移场时，离散的弱形式方程得到精确满足。这通常要求使用能精确积分单元刚度矩阵的“完全”积分法则。\n5.  **误差评估**：必须严格验证计算解的梯度在整个域上是否恒定且等于精确值。计算梯度误差的 $L^2$ 范数 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)}$ 是最严谨的度量标准。检验通过的标准是该误差达到机器精度。\n\n现在评估各个选项：\n\n**A**: 此流程完美地遵循了上述所有原则。\n-   **网格**: 使用包含扭曲单元的多单元斑块。\n-   **参数**: 使用适中的 $\\nu$ 值。\n-   **积分**: 为不同单元类型指定了恰当的完全积分法则（T3用1点，Q4用2x2高斯）。这是确保一致性检验本身不受积分误差干扰的关键。\n-   **边界条件**: 在所有边界节点上施加狄利克雷条件，这是最稳健的做法。\n-   **误差评估**: 使用最严格的 $L^2$ 范数来度量梯度误差，并以舍入误差作为通过标准。\n此流程是严谨、完整且无歧义的。**因此，A是正确的**。\n\n**B**: 此流程存在多个严重缺陷。\n-   **单单元域**: 无法检验单元间的协调性，这是拼凑检验的核心目的之一。\n-   **任意积分法则**: 积分阶数对结果至关重要，不能任意选择。\n-   **不充分的约束**: 仅约束角节点可能导致不唯一的解。\n-   **不充分的误差度量**: 仅检查节点位移误差，而忽略了关键的梯度（应变）场。\n此流程是无效的。\n\n**C**: 此流程同样存在严重缺陷。\n-   **纯面力边界条件**: 不施加位移约束会导致刚体运动未被约束，使得刚度矩阵奇异，问题无唯一解。\n-   **减缩积分**: 使用减缩积分会混淆检验目的。虽然它可以缓解锁定，但也可能引入沙漏模式，并且不能作为检验基本协调性的标准方法。\n-   **不充分的误差评估**: 仅检查高斯点处的误差是不够的，解必须在域内处处精确。\n\n**D**: 此流程混淆了拼凑检验和体积锁定检验。\n-   **接近不可压缩的 $\\nu$**: 使用 $\\nu = 0.499$ 会在一阶单元中触发体积锁定，产生很大的误差。\n-   **错误的结论**: 将锁定引起的误差错误地归因于单元未能通过拼凑检验。一个单元可能完全满足协调性要求（即在 $\\nu=0.3$ 时通过检验），但在近不可压缩条件下表现不佳。这是两个不同的问题。\n\n**E**: 此流程的误差评估方法不正确。\n-   **梯度平均**: 使用平滑或平均后的节点梯度来评估误差是不严谨的。拼凑检验要求原始的、单元内部的（通常是不连续的）梯度场是精确的。平均化处理会掩盖单元的真实行为，不能作为严格的验证标准。\n\n综上所述，选项A是唯一描述了正确、稳健且全面的拼凑检验实施流程的选项。", "answer": "$$\\boxed{A}$$", "id": "3606149"}]}