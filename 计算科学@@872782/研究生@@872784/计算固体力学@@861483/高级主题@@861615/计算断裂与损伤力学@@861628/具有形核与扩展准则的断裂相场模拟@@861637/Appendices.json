{"hands_on_practices": [{"introduction": "在完整的材料中形成裂纹需要克服一定的能量壁垒。本练习将引导你对一根简单的一维杆应用变分原理，推导出一个临界应力，当外加应力达到该值时，完好无损的状态将失稳并开始萌生损伤。这个练习是理解相场模型中断裂何时以及为何会萌生的基石。", "problem": "考虑一根长度为 $L$、单位横截面积的一维弹性杆，沿坐标 $x \\in [0,L]$ 排布，在 $x=L$ 处受到一给定的均匀牵引力 $\\sigma$，并在 $x=0$ 处固定，即 $u(0)=0$。假设为小应变线性弹性，杨氏模量为 $E$，因此应变为 $\\varepsilon(x) = u'(x)$，未损伤弹性储能密度为 $\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}$。断裂由一个标量相场损伤变量 $d(x) \\in [0,1]$ 建模，该变量通过函数 $g(d) = (1-d)^{2}$ 降低刚度，并由 Ambrosio–Tortorelli (AT1) 裂纹表面泛函控制。设裂纹表面密度（单位参考长度）为 $\\psi_{c}(d,d') = \\tfrac{G_{c}}{2\\ell} d + \\tfrac{G_{c}\\ell}{2} (d')^{2}$，其中 $G_{c}$ 是临界能量释放率（断裂韧性），$\\ell$ 是内禀长度尺度。总势能泛函为\n$$\n\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') \\right) \\, dx \\;-\\; \\int_{0}^{L} \\sigma\\, u'(x)\\, dx.\n$$\n您可以假设仅受拉伸载荷，因此 $\\sigma \\ge 0$。\n\n(a) 使用最小势能原理和一维平衡，构建与 $x=L$ 处给定牵引力相符的均匀位移解 $u(x)$。\n\n(b) 将注意力限制在空间均匀损伤场 $d(x)=d$（因此 $d' = 0$）上，并分析 $\\Pi$ 在 $d=0$ 处关于 $d$ 的驻定性。确定未损伤状态 $d=0$ 对损伤形核保持稳定的条件，并推导当 $d=0$ 失去稳定性时对应的临界牵引力 $\\sigma_{c}$（用 $E$、$G_{c}$ 和 $\\ell$ 表示）。将您的最终答案 $\\sigma_{c}$ 以帕斯卡（Pascals）为单位，表示为单一的闭式解析表达式。未提供数值；请勿进行任何数值代入。无需四舍五入。", "solution": "用户提供了一个计算固体力学领域的问题，具体涉及断裂的相场建模。该问题需要遵循力学平衡原理和通过变分法进行稳定性分析来解决。\n\n### 问题验证\n问题陈述已经过验证，被认为是科学上合理的、适定的、客观的且内部一致的。它提供了推导出唯一且有意义的解所需的所有必要信息、定义和边界条件。该公式使用了连续介质力学和相场理论中的标准概念，如势能泛函、Ambrosio-Tortorelli 正则化和最小势能原理。因此，该问题是有效的，将提供解答。\n\n### (a) 部分：均匀位移解\n\n总势能泛函由下式给出：\n$$\n\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') \\right) \\, dx \\;-\\; \\int_{0}^{L} \\sigma\\, u'(x)\\, dx\n$$\n其中 $\\psi_{0}(u') = \\frac{1}{2} E (u')^2$，$g(d)=(1-d)^2$，$\\sigma$ 是给定的均匀牵引力。\n\n根据最小势能原理，对于给定的损伤场 $d(x)$，位移场 $u(x)$ 必须使 $\\Pi$ 最小化。这要求 $\\Pi$ 关于 $u$ 的一阶变分为零。变量 $u(x)$ 的欧拉-拉格朗日方程为：\n$$\n\\frac{d}{dx} \\left( \\frac{\\partial \\mathcal{L}}{\\partial u'} \\right) - \\frac{\\partial \\mathcal{L}}{\\partial u} = 0\n$$\n其中拉格朗日密度 $\\mathcal{L}$ 是泛函的被积函数：\n$$\n\\mathcal{L}(u', d, d') = g(d)\\, \\psi_{0}(u') + \\psi_{c}(d,d') - \\sigma u'\n$$\n我们计算 $\\mathcal{L}$ 的偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u'} = \\frac{\\partial}{\\partial u'} \\left( (1-d)^2 \\frac{1}{2} E (u')^2 \\right) - \\sigma = (1-d)^2 E u' - \\sigma\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial u} = 0\n$$\n将这些代入欧拉-拉格朗日方程，得到平衡方程：\n$$\n\\frac{d}{dx} \\left( (1-d)^2 E u' - \\sigma \\right) = 0\n$$\n这意味着 $(1-d)^2 E u' - \\sigma$ 沿杆是常数。我们称这个常数为 $C$。\n$$\n(1-d(x))^2 E u'(x) - \\sigma = C\n$$\n问题描述了在 $x=L$ 处的牵引力边界条件。在这个变分公式的背景下，项 $-\\int_0^L \\sigma u' dx$ 会在任何自由边界上产生一个自然边界条件。在 $x=L$ 处，自然边界条件是 $\\frac{\\partial \\mathcal{L}}{\\partial u'} \\big|_{x=L} = 0$。这得到：\n$$\n\\left. \\left( (1-d)^2 E u' - \\sigma \\right) \\right|_{x=L} = 0\n$$\n这确定了常数 $C=0$。因此，平衡条件对所有 $x \\in [0,L]$ 成立：\n$$\n(1-d(x))^2 E u'(x) = \\sigma\n$$\n该方程表明，力学应力 $\\sigma_{int} = g(d) E u'$ 在整个杆上是恒定的，并且等于所施加的牵引力 $\\sigma$。\n\n对于(a)部分，我们被要求求解均匀位移解。这自然地被解释为未损伤状态下的解，该状态是(b)部分稳定性分析的参考状态。在未损伤状态下，$d(x) = 0$ 对所有 $x$ 成立。将此代入平衡方程得到：\n$$\n(1-0)^2 E u'(x) = \\sigma \\implies E u'(x) = \\sigma\n$$\n应变是恒定的：$u'(x) = \\frac{\\sigma}{E}$。对此表达式关于 $x$ 积分，得到位移场：\n$$\nu(x) = \\int \\frac{\\sigma}{E} dx = \\frac{\\sigma}{E} x + C_1\n$$\n其中 $C_1$ 是一个积分常数。我们应用 $x=0$ 处的固定边界条件，即 $u(0)=0$：\n$$\nu(0) = \\frac{\\sigma}{E}(0) + C_1 = 0 \\implies C_1 = 0\n$$\n因此，未损伤杆的位移解为：\n$$\nu(x) = \\frac{\\sigma}{E} x\n$$\n\n### (b) 部分：稳定性分析和临界牵引力\n\n我们被要求将分析限制在空间均匀损伤场上，即 $d(x)=d$，其中 $d$ 是一个常数。因此，损伤场的导数为 $d'(x)=0$。\n\n在此假设下，我们可以将总势能表示为标量变量 $d$ 的函数。首先，我们强制执行在(a)部分中推导出的力学平衡条件，对于常数 $d$，该条件变为 $u'(x) = \\frac{\\sigma}{E(1-d)^2}$。我们将此应变以及 $d'(x)=0$ 代入势能泛函 $\\Pi[u,d]$：\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( (1-d)^2 \\frac{E}{2} \\left( \\frac{\\sigma}{E(1-d)^2} \\right)^2 + \\left( \\frac{G_c}{2\\ell} d + \\frac{G_c\\ell}{2} (0)^2 \\right) \\right) dx - \\int_{0}^{L} \\sigma \\left( \\frac{\\sigma}{E(1-d)^2} \\right) dx\n$$\n简化积分内的项：\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( \\frac{(1-d)^2 E \\sigma^2}{2E^2(1-d)^4} + \\frac{G_c d}{2\\ell} - \\frac{\\sigma^2}{E(1-d)^2} \\right) dx\n$$\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( \\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} - \\frac{\\sigma^2}{E(1-d)^2} \\right) dx\n$$\n$$\n\\Pi(d) = \\int_{0}^{L} \\left( -\\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} \\right) dx\n$$\n由于被积函数与 $x$ 无关，我们可以在长度 $L$ 上进行积分：\n$$\n\\Pi(d) = L \\left( -\\frac{\\sigma^2}{2E(1-d)^2} + \\frac{G_c d}{2\\ell} \\right)\n$$\n未损伤状态对应于 $d=0$。此状态的稳定性由 $\\Pi(d)$ 在 $d$ 的小的正值处的行为决定。由于单边物理约束 $d \\ge 0$，如果 $d=0$ 是势能在可行域内的局部最小值，则该状态是稳定的。这要求当 $d$ 从 $0$ 无穷小增加时，势能不减少。在数学上，$\\Pi(d)$ 在 $d=0$ 处沿 $d$ 增加方向的方向导数必须为非负：\n$$\n\\frac{d\\Pi}{dd} \\bigg|_{d=0} \\ge 0\n$$\n首先，我们计算 $\\Pi(d)$ 关于 $d$ 的导数：\n$$\n\\frac{d\\Pi}{dd} = \\frac{d}{dd} \\left[ L \\left( -\\frac{\\sigma^2}{2E}(1-d)^{-2} + \\frac{G_c d}{2\\ell} \\right) \\right]\n$$\n$$\n\\frac{d\\Pi}{dd} = L \\left[ -\\frac{\\sigma^2}{2E}(-2)(1-d)^{-3}(-1) + \\frac{G_c}{2\\ell} \\right]\n$$\n$$\n\\frac{d\\Pi}{dd} = L \\left( -\\frac{\\sigma^2}{E(1-d)^3} + \\frac{G_c}{2\\ell} \\right)\n$$\n现在，我们计算该导数在 $d=0$ 处的值：\n$$\n\\frac{d\\Pi}{dd} \\bigg|_{d=0} = L \\left( -\\frac{\\sigma^2}{E(1-0)^3} + \\frac{G_c}{2\\ell} \\right) = L \\left( -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\right)\n$$\n因此，稳定性条件为：\n$$\nL \\left( -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\right) \\ge 0 \\implies -\\frac{\\sigma^2}{E} + \\frac{G_c}{2\\ell} \\ge 0\n$$\n$$\n\\frac{\\sigma^2}{E} \\le \\frac{G_c}{2\\ell} \\implies \\sigma^2 \\le \\frac{E G_c}{2\\ell}\n$$\n只要施加的牵引力 $\\sigma$ 满足此条件，未损伤状态 $d=0$ 就是稳定的。当此不等式首次被违反时，该状态失去稳定性。临界牵引力 $\\sigma_c$ 是在稳定区域边界上的 $\\sigma$ 值，此时等式成立：\n$$\n\\sigma_c^2 = \\frac{E G_c}{2\\ell}\n$$\n解出 $\\sigma_c$（并取正根，因为 $\\sigma \\ge 0$）：\n$$\n\\sigma_c = \\sqrt{\\frac{E G_c}{2\\ell}}\n$$\n此表达式给出了所需的以帕斯卡为单位的临界牵引力。对于 $\\sigma  \\sigma_c$，导数 $\\frac{d\\Pi}{dd}|_{d=0}$ 变为负值，表明可以通过引入损伤来降低势能，因此未损伤状态变得不稳定。", "answer": "$$\\boxed{\\sqrt{\\frac{E G_{c}}{2\\ell}}}$$", "id": "3587452"}, {"introduction": "在理解了损伤如何因达到能量阈值而萌生之后 ([@problem_id:3587452])，我们来探讨一个关键的改进：材料对拉伸和压缩的不同响应。本练习将演示拉压能量分解如何防止材料在压缩载荷下产生损伤，这是一个符合物理现实的重要特性。通过解决这个问题，你将看到数学公式如何直接实现这种真实的材料行为。", "problem": "考虑一根长度为 $L$、杨氏模量为 $E$ 的直棱柱形、小应变、线弹性一维（$1$D）杆，该杆通过基于 Ambrosio–Tortorelli (AT-2) 正则化的拉压分离相场断裂公式进行建模。轴向位移为 $u(x)$，相场（损伤）变量为 $d(x) \\in [0,1]$，其中 $d=0$ 表示完好状态，$d=1$ 表示完全断裂的材料。该杆受到由 $u(x)$ 的运动学边界条件施加的均匀压缩应变 $\\varepsilon  0$，并且不存在预先存在的损伤。\n\n假设以下要素：\n- $1$D 中弹性储能密度的谱拉压分离为\n$$\n\\psi^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}, \n\\qquad\n\\psi^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2},\n$$\n其中麦考利括号 $\\langle \\cdot \\rangle_{+}$ 和 $\\langle \\cdot \\rangle_{-}$ 定义为 $\\langle x \\rangle_{+} = \\max(x,0)$ 和 $\\langle x \\rangle_{-} = \\min(x,0)$。\n- 在域 $[0,L]$ 上的总内能泛函为\n$$\n\\Pi[u,d] \n= \\int_{0}^{L} \\left( g(d)\\, \\psi^{+}(\\varepsilon(u)) + \\psi^{-}(\\varepsilon(u))\n+ G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right) \\right) \\,\\mathrm{d}x,\n$$\n其中 $G_{c}$ 是临界能量释放率，$\\ell$ 是长度尺度参数，退化函数为 $g(d) = (1-d)^{2} + \\kappa$，其中 $\\kappa \\in (0,1)$ 是一个小的残余刚度。\n- 损伤变量 $d(x)$ 在 $x=0$ 和 $x=L$ 处满足自然（变分一致）边界条件。\n\n从 $\\Pi$ 相对于 $d(x)$ 的平稳性以及上述定义出发，执行以下操作：\n$1.$ 推导一维情况下 $d(x)$ 的相场方程（欧拉-拉格朗日方程）的强形式，并识别源（损伤驱动）项和扩散正则化项。\n$2.$ 在均匀压缩状态 $\\varepsilon  0$ 下评估源项，并证明在拉压分离下该项为零。\n$3.$ 利用得到的边值问题和自然边界条件，求解在 $[0,L]$ 上与初始无损杆一致的、物理上可接受的相场分布 $d(x)$。\n\n以在 $[0,L]$ 上 $d(x)$ 的显式表达式作为最终答案。最终答案中无需包含中间步骤。答案没有单位，也无需四舍五入。", "solution": "用户希望我解决一个计算固体力学领域的问题，具体涉及断裂的相场模型。问题是确定一根在一维杆在均匀压缩下达到平衡时的损伤分布 $d(x)$。\n\n### 步骤1：提取已知条件\n-   **域**：一根长度为 $L$ 的直棱柱形一维（$1$D）杆。\n-   **本构模型**：小应变、线弹性，杨氏模量为 $E$。\n-   **状态变量**：轴向位移 $u(x)$，相场（损伤）$d(x) \\in [0,1]$。\n-   **载荷**：均匀压缩应变 $\\varepsilon  0$。\n-   **初始条件**：无预存损伤。\n-   **能量分离**：谱拉压分离，$\\psi^{+}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}$ 且 $\\psi^{-}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}$。\n-   **麦考利括号**：$\\langle x \\rangle_{+} = \\max(x,0)$ 且 $\\langle x \\rangle_{-} = \\min(x,0)$。\n-   **总能量泛函**：$\\Pi[u,d] = \\int_{0}^{L} \\left( g(d)\\, \\psi^{+}(\\varepsilon(u)) + \\psi^{-}(\\varepsilon(u)) + G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right) \\right) \\,\\mathrm{d}x$。\n-   **常数与函数**：临界能量释放率 $G_c$，长度尺度参数 $\\ell$，退化函数 $g(d) = (1-d)^{2} + \\kappa$，残余刚度参数 $\\kappa \\in (0,1)$。\n-   **边界条件**：$d(x)$ 在 $x=0$ 和 $x=L$ 处满足自然（变分一致）边界条件。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在连续介质损伤力学和断裂变分原理理论中有充分依据。Ambrosio-Tortorelli (AT-2) 相场模型是正则化尖锐裂纹问题的标准且被广泛接受的方法。使用拉压分离是真实模拟混凝土或陶瓷等在拉伸和压缩下响应不同的材料的关键和标准特征。所有要素均基于已建立的科学原理。\n-   **适定性**：该问题是适定的。它要求解一个从变分原理推导出的边值问题。泛函已定义，域已指定，边界条件的性质也已给出。这种结构允许确定唯一解。\n-   **客观性**：问题使用精确的数学定义和客观语言陈述。没有主观、隐喻或基于意见的陈述。\n-   **完整性**：问题是自洽的，提供了进行推导和求解所需的所有必要信息。不需要外部信息或未说明的假设。\n-   **一致性**：给定的条件内部一致。定义或约束中没有矛盾。\n\n### 步骤3：结论与行动\n问题是有效的。这是材料力学和相场建模中的一个标准练习。我将继续进行求解。\n\n解答是根据问题陈述中列出的三个步骤推导出来的。\n\n首先，我们推导相场方程的强形式。通过要求总能量泛函 $\\Pi[u,d]$ 相对于 $d$ 的一阶变分为零来找到平衡状态。该泛函可以写成 $\\Pi[d] = \\int_{0}^{L} \\mathcal{L}(d, d') \\,\\mathrm{d}x$，其中拉格朗日密度 $\\mathcal{L}$（对于固定的应变场 $\\varepsilon$）为\n$$\n\\mathcal{L}(d, d') = g(d)\\, \\psi^{+}(\\varepsilon) + \\psi^{-}(\\varepsilon) + G_{c} \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2} (d')^{2} \\right)\n$$\n相应的欧拉-拉格朗日方程为 $\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = 0$。我们计算所需的导数。退化函数 $g(d) = (1-d)^{2} + \\kappa$ 的导数为 $g'(d) = -2(1-d)$。\n$\\mathcal{L}$ 关于 $d$ 的偏导数为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} = g'(d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell} = -2(1-d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell}\n$$\n$\\mathcal{L}$ 关于 $d'$ 的偏导数为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d'} = G_{c} \\ell d'\n$$\n对上述表达式求关于 $x$ 的全导数得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = G_{c} \\ell d''\n$$\n将这些代入欧拉-拉格朗日方程，得到相场方程的强形式：\n$$\n-2(1-d) \\psi^{+}(\\varepsilon) + G_{c} \\frac{d}{\\ell} - G_{c} \\ell d'' = 0\n$$\n重新整理该方程得到：\n$$\nG_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d = -2(1-d) \\psi^{+}(\\varepsilon)\n$$\n这里，左侧的项 $G_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d$ 是扩散正则化项。右侧的项 $-2(1-d) \\psi^{+}(\\varepsilon)$ 是损伤驱动源项。\n\n其次，我们评估给定载荷条件下的源项。杆处于均匀压缩状态，因此应变 $\\varepsilon  0$。拉伸弹性储能密度 $\\psi^{+}(\\varepsilon)$ 定义为 $\\psi^{+}(\\varepsilon) = \\frac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2}$，其中麦考利括号为 $\\langle \\varepsilon \\rangle_{+} = \\max(\\varepsilon, 0)$。对于负应变 $\\varepsilon  0$，我们有 $\\langle \\varepsilon \\rangle_{+} = 0$。因此，拉伸储能密度为零：\n$$\n\\psi^{+}(\\varepsilon) = \\frac{1}{2} E (0)^{2} = 0\n$$\n因此，损伤驱动源项为零：$-2(1-d) \\psi^{+}(\\varepsilon) = 0$。这证实了在该模型中，压缩状态不会引起材料退化。\n\n第三，我们求解得到的 $d(x)$ 的边值问题。当源项为零时，相场方程简化为一个齐次的二阶线性常微分方程：\n$$\nG_{c} \\ell d'' - \\frac{G_{c}}{\\ell} d = 0\n$$\n由于 $G_c  0$ 且 $\\ell  0$，我们可以除以 $G_c \\ell$ 得到：\n$$\nd'' - \\frac{1}{\\ell^{2}} d = 0\n$$\n该常微分方程的通解为\n$$\nd(x) = C_{1} \\exp\\left(\\frac{x}{\\ell}\\right) + C_{2} \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。问题指定了自然边界条件。这些条件可以从 $\\Pi$ 的一阶变分中的边界项 $[ \\frac{\\partial \\mathcal{L}}{\\partial d'} \\delta d ]_{0}^{L} = [ G_c \\ell d' \\delta d ]_{0}^{L}$ 得到。为使此项对于任意变分 $\\delta d$ 均为零，我们必须有 $d'(0)=0$ 和 $d'(L)=0$。\n通解的导数为：\n$$\nd'(x) = \\frac{C_1}{\\ell} \\exp\\left(\\frac{x}{\\ell}\\right) - \\frac{C_2}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n应用 $x=0$ 处的条件：\n$$\nd'(0) = \\frac{C_1}{\\ell} - \\frac{C_2}{\\ell} = 0 \\quad \\implies \\quad C_1 = C_2\n$$\n应用 $x=L$ 处的条件并代入 $C_1=C_2$：\n$$\nd'(L) = \\frac{C_1}{\\ell} \\exp\\left(\\frac{L}{\\ell}\\right) - \\frac{C_1}{\\ell} \\exp\\left(-\\frac{L}{\\ell}\\right) = \\frac{C_1}{\\ell} \\left( \\exp\\left(\\frac{L}{\\ell}\\right) - \\exp\\left(-\\frac{L}{\\ell}\\right) \\right) = \\frac{2C_1}{\\ell} \\sinh\\left(\\frac{L}{\\ell}\\right) = 0\n$$\n由于 $L0$ 且 $\\ell0$，项 $\\sinh(L/\\ell)$ 非零。因此，该等式要求 $C_1 = 0$。由于 $C_1=C_2$，我们也有 $C_2=0$。\n将 $C_1=0$ 和 $C_2=0$ 代入通解，得到相场分布的唯一、物理上可接受的解：\n$$\nd(x) = 0 \\quad \\text{对于所有 } x \\in [0,L]\n$$\n该解对应于完全完好的材料（$d=0$），这与初始无损杆承受纯压缩载荷的情况一致，因为在此模型中压缩不会驱动损伤。", "answer": "$$\n\\boxed{0}\n$$", "id": "3587568"}, {"introduction": "掌握了损伤萌生 ([@problem_id:3587452]) 和材料非对称响应 ([@problem_id:3587568]) 的理论后，最后一步是将这些概念转化为可执行的算法。这个动手编程练习将指导你为一个有限元单元完成损伤更新步骤的数值实现。你将组装矩阵并求解方程组，亲眼见证损伤场在单个时间步内如何演化，从而架起理论方程与计算结果之间的桥梁。", "problem": "考虑在一维空间下，使用所谓的 AT2 模型，通过 Ambrosio-Tortorelli 正则化方法对脆性断裂进行相场模拟。对于长度为 $L$ 的一维杆，单位厚度的总自由能定义在损伤场 $d(x,t)$ 和位移场 $u(x,t)$ 上，它结合了弹性应变能和裂纹表面密度泛函。弹性应变能密度的拉伸部分用 $\\psi^+(u)$ 表示，其历史场 $H(t)$ 强制了损伤增长的不可逆性。控制方程源于最小势能原理和 Karush-Kuhn-Tucker 型不可逆约束。本问题中的所有量都是无量綱的，不需要物理单位。\n\n你需要对损伤场实现后向欧拉时间离散化，并计算一个具有线性形函数的一维有限元上的节点损伤值的更新，但需遵循以下建模假设：\n\n- 历史场定义为 $H^n = \\max\\!\\left(H^{n-1}, \\psi^+(u^n)\\right)$，它强制了驱动断裂的拉伸能量的不可逆性。对于本问题，每个测试用例都会直接给出 $H^n$，你不能计算 $\\psi^+(u^n)$。\n- 损伤不可逆约束为几乎处处满足 $d^n(x) \\ge d^{n-1}(x)$，边界约束为 $0 \\le d^n(x) \\le 1$。\n- 通过在损伤演化中引入一个粘性正则化参数 $\\eta  0$ 来包含微小的速率依赖性，从而得到以下形式的演化方程\n$$\n\\eta\\,\\dot{d} - G_c\\,\\ell\\,\\Delta d + \\frac{G_c}{\\ell}\\,d = 2\\,H\\,(1-d),\n$$\n其中 $G_c$ 是无量纲的临界能量释放参数，$\\ell$ 是无量纲的正则化长度，$\\Delta$ 是一维拉普拉斯算子。\n\n对损伤场在大小为 $\\Delta t$ 的时间步上执行后向欧拉时间离散化，以获得在时间步 $n$ 的半离散强形式：\n$$\n\\frac{\\eta}{\\Delta t}\\left(d^n - d^{n-1}\\right) - G_c\\,\\ell\\,\\Delta d^n + \\frac{G_c}{\\ell}\\,d^n = 2\\,H^n\\,(1 - d^n).\n$$\n将其重排为弱形式，并使用一个长度为 $L$、具有线性形函数 $N_1(x)$ 和 $N_2(x)$ 的一维有限元进行离散化，同时在 $d$ 上施加齐次诺伊曼边界条件（单元两端损伤通量为零）。设时间步 $n$ 的损伤场节点值为向量 $\\mathbf{d}^n = [d_1^n, d_2^n]^T$，$\\mathbf{d}^{n-1}$ 与此类似。\n\n你必须推导单元矩阵并实现以下用于更新的线性系统：\n$$\n\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r},\n$$\n其中\n$$\n\\mathbf{K} = G_c\\,\\ell\\,\\mathbf{K}_{\\nabla} + \\alpha\\,\\mathbf{M}, \\quad \\alpha = \\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n,\n$$\n$$\n\\mathbf{r} = \\frac{\\eta}{\\Delta t}\\,\\mathbf{M}\\,\\mathbf{d}^{n-1} + 2\\,H^n\\,\\mathbf{f},\n$$\n其中\n$$\n\\mathbf{K}_{\\nabla} = \\frac{1}{L}\\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix},\\quad\n\\mathbf{M} = \\frac{L}{6}\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix},\\quad\n\\mathbf{f} = \\begin{bmatrix} \\int_0^L N_1(x)\\,dx \\\\ \\int_0^L N_2(x)\\,dx \\end{bmatrix} = \\frac{L}{2}\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}.\n$$\n求解线性系统后，逐节点地施加不可逆性和边界约束：\n$$\n\\mathbf{d}^n \\leftarrow \\min\\!\\left(1, \\max\\!\\left(\\mathbf{d}^n, \\mathbf{d}^{n-1}\\right)\\right),\n$$\n该操作逐分量地应用于节点值。此外，还包括一个形核准则：当从未损伤状态 $\\mathbf{d}^{n-1} = \\mathbf{0}$ 开始时，如果历史场不超过经典的 AT2 形核阈值 $H_{\\text{crit}} = \\dfrac{G_c}{2\\,\\ell}$，则不应有损伤形核，此时你必须设置 $\\mathbf{d}^n = \\mathbf{d}^{n-1}$。\n\n你的任务是实现一个程序，该程序能够：\n- 为单个单元组装单元矩阵。\n- 通过上述线性系统求解 $\\mathbf{d}^n$。\n- 应用不可逆性和边界约束。\n- 在适当的时候应用形核准则。\n- 生成指定的输出格式。\n\n所有量都是无量纲的。本问题不使用角度。最终程序必须在没有用户输入的情况下运行，并使用下面的测试套件。对于每个测试用例，程序必须将两个节点值 $[d_1^n, d_2^n]$ 作为浮点数输出，并四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1 (从零损伤开始的一般性增长，高于形核阈值)：$L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=6.0$, $\\mathbf{d}^{n-1}=[0.0, 0.0]$。\n- 案例 2 (无形核，历史场低于阈值)：$L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=3.0$, $\\mathbf{d}^{n-1}=[0.0, 0.0]$。\n- 案例 3 (从部分损伤状态开始的不可逆传播，历史场低于阈值)：$L=1.0$, $G_c=1.0$, $\\ell=0.1$, $\\eta=0.02$, $\\Delta t=0.1$, $H^n=3.0$, $\\mathbf{d}^{n-1}=[0.4, 0.4]$。\n- 案例 4 (高驱动力下小粘性和小时间步的边缘情况)：$L=0.5$, $G_c=2.0$, $\\ell=0.05$, $\\eta=0.000001$, $\\Delta t=0.001$, $H^n=50.0$, $\\mathbf{d}^{n-1}=[0.1, 0.1]$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，每个内部列表包含一个测试用例的两个四舍五入的节点值，并用方括号括起来，例如：$[[d_{1}^{(1)},d_{2}^{(1)}],[d_{1}^{(2)},d_{2}^{(2)}],\\ldots]$，其中上标表示测试用例的索引。输出必须只有一行，且不含任何额外文本。", "solution": "所提出的问题是计算固体力学中一个有效且适定的练习，具体涉及脆性断裂相场模型的数值解。该模型是 Ambrosio-Tortorelli (AT2) 公式，通过粘性项进行正则化，在时间上使用后向欧拉法离散，在空间上使用一维线性有限元离散。该问题是自洽的、科学上合理的，并且提供了单单元计算所需的所有参数和矩阵。所定义的线性系统存在唯一解，并且后续的算法步骤是明确的。\n\n任务的核心是基于前一时间步的值 $\\mathbf{d}^{n-1}$，为节点损伤值 $\\mathbf{d}^n = [d_1^n, d_2^n]^T$ 实现单时间步更新。该过程由损伤场 $d(x, t)$ 的控制偏微分方程推导而来：\n$$\n\\eta\\,\\dot{d} - G_c\\,\\ell\\,\\Delta d + \\frac{G_c}{\\ell}\\,d = 2\\,H\\,(1-d)\n$$\n应用后向欧拉时间离散化，其中 $\\dot{d} \\approx (d^n - d^{n-1})/\\Delta t$，得到时间步 $n$ 的半离散强形式：\n$$\n\\frac{\\eta}{\\Delta t}\\left(d^n - d^{n-1}\\right) - G_c\\,\\ell\\,\\Delta d^n + \\frac{G_c}{\\ell}\\,d^n = 2\\,H^n\\,(1 - d^n)\n$$\n为了获得有限元实现的矩阵形式，我们首先重新整理方程，将与未知场 $d^n$ 相关的所有项都归到左侧：\n$$\n- G_c\\,\\ell\\,\\Delta d^n + \\left(\\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n\\right) d^n = \\frac{\\eta}{\\Delta t}\\,d^{n-1} + 2\\,H^n\n$$\n这是一个关于 $d^n$ 的线性椭圆偏微分方程。遵循伽辽金法，我们乘以一个测试函数 $v(x)$ 并在单元域 $[0, L]$ 上积分。对拉普拉斯项应用分部积分，并纳入指定的齐次诺伊曼边界条件（在 $x=0$ 和 $x=L$ 处 $\\nabla d^n = 0$），得到弱形式：\n$$\n\\int_0^L \\left[ G_c\\,\\ell\\,(\\nabla d^n) \\cdot (\\nabla v) + \\left(\\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2H^n\\right) d^n v \\right] dx = \\int_0^L \\left[ \\frac{\\eta}{\\Delta t}\\, d^{n-1} v + 2H^n v \\right] dx\n$$\n场 $d^n(x)$ 和 $d^{n-1}(x)$ 使用线性形函数 $N_i(x)$ 进行离散，即 $d^n(x) = \\sum_j d_j^n N_j(x)$ 和 $d^{n-1}(x) = \\sum_j d_j^{n-1} N_j(x)$。通过依次选择测试函数 $v(x)$ 为每个形函数 $N_i(x)$，我们得到一个关于节点值 $\\mathbf{d}^n$ 的线性代数方程组。这个系统正是问题陈述中给出的系统，$\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r}$，其中：\n$$\n\\mathbf{K} = G_c\\,\\ell\\,\\mathbf{K}_{\\nabla} + \\alpha\\,\\mathbf{M}\n$$\n$$\n\\mathbf{r} = \\frac{\\eta}{\\Delta t}\\,\\mathbf{M}\\,\\mathbf{d}^{n-1} + 2\\,H^n\\,\\mathbf{f}\n$$\n系数为 $\\alpha = \\frac{\\eta}{\\Delta t} + \\frac{G_c}{\\ell} + 2\\,H^n$。矩阵 $\\mathbf{K}_{\\nabla}$、$\\mathbf{M}$ 和向量 $\\mathbf{f}$ 分别是一维线性单元的标准单元梯度矩阵、质量矩阵和力向量。\n\n单个更新步骤的算法如下：\n1.  **形核准则：** 检查单元是否处于未损伤状态，即 $\\mathbf{d}^{n-1} = \\mathbf{0}$。如果是，则将历史场值 $H^n$ 与临界形核阈值 $H_{\\text{crit}} = \\frac{G_c}{2\\,\\ell}$ 进行比较。如果 $H^n \\le H_{\\text{crit}}$，则无损伤形核，我们设置 $\\mathbf{d}^n = \\mathbf{d}^{n-1} = \\mathbf{0}$。否则，或者如果单元已经受损，则进入下一步。\n2.  **组装：** 根据单元长度 $L$ 构造矩阵 $\\mathbf{K}_{\\nabla}$、$\\mathbf{M}$ 和向量 $\\mathbf{f}$。计算标量 $\\alpha$。使用给定的公式和输入参数组装系统矩阵 $\\mathbf{K}$ 和右侧向量 $\\mathbf{r}$。\n3.  **求解：** 求解 $2 \\times 2$ 线性系统 $\\mathbf{K}\\,\\mathbf{d}^n = \\mathbf{r}$ 以获得候选的节点损伤向量 $\\mathbf{d}^n$。矩阵 $\\mathbf{K}$ 保证是正定的，确保存在唯一解。\n4.  **施加约束：** 损伤场必须是非递减的（不可逆性），且界于 $0$ 和 $1$ 之间。这些源于 Karush-Kuhn-Tucker 条件的约束通过后处理步骤在节点层面施加： \n    $$\n    \\mathbf{d}^n \\leftarrow \\min\\!\\left(1, \\max\\!\\left(\\mathbf{d}^n, \\mathbf{d}^{n-1}\\right)\\right)\n    $$ \n    该操作逐分量地应用于节点向量 $\\mathbf{d}^n$ 的元素。\n\n将此程序系统地应用于所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_damage_update(L, Gc, l, eta, dt, Hn, d_prev):\n    \"\"\"\n    Computes the damage field update for a single 1D finite element.\n\n    Args:\n        L (float): Element length.\n        Gc (float): Critical energy release parameter.\n        l (float): Regularization length.\n        eta (float): Viscous regularization parameter.\n        dt (float): Time step size.\n        Hn (float): History field value at step n.\n        d_prev (np.ndarray): Nodal damage values from step n-1, shape (2,).\n\n    Returns:\n        np.ndarray: Updated nodal damage values at step n, shape (2,).\n    \"\"\"\n    \n    # 1. Nucleation Criterion\n    # Check if starting from an undamaged state\n    if np.all(d_prev == 0.0):\n        H_crit = Gc / (2.0 * l)\n        if Hn = H_crit:\n            return d_prev\n\n    # 2. Assembly\n    # Define standard 1D linear element matrices\n    K_nabla = (1.0 / L) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n    M = (L / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n    f = (L / 2.0) * np.array([1.0, 1.0])\n\n    # Calculate coefficient alpha\n    alpha = (eta / dt) + (Gc / l) + (2.0 * Hn)\n\n    # Assemble the system matrix K and right-hand side vector r\n    K = Gc * l * K_nabla + alpha * M\n    r = (eta / dt) * M @ d_prev + (2.0 * Hn) * f\n\n    # 3. Solve\n    d_n_candidate = np.linalg.solve(K, r)\n\n    # 4. Enforce Constraints\n    d_n = np.maximum(d_n_candidate, d_prev)\n    d_n = np.minimum(1.0, d_n)\n    \n    return d_n\n\ndef solve():\n    \"\"\"\n    Runs the test suite for the phase-field damage update problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 6.0, 'd_prev': np.array([0.0, 0.0])},\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 3.0, 'd_prev': np.array([0.0, 0.0])},\n        {'L': 1.0, 'Gc': 1.0, 'l': 0.1, 'eta': 0.02, 'dt': 0.1, 'Hn': 3.0, 'd_prev': np.array([0.4, 0.4])},\n        {'L': 0.5, 'Gc': 2.0, 'l': 0.05, 'eta': 0.000001, 'dt': 0.001, 'Hn': 50.0, 'd_prev': np.array([0.1, 0.1])},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_damage_update(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]:.6f},{r[1]:.6f}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3587473"}]}