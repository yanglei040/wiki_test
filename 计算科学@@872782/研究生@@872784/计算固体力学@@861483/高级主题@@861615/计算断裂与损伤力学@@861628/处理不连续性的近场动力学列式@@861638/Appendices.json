{"hands_on_practices": [{"introduction": "在近场动力学中，显式时间积分是模拟动态断裂等不连续性演化过程的常用方法。然而，该方法的数值稳定性受到 Courant-Friedrichs-Lewy (CFL) 条件的严格制约，该条件将时间步长与离散系统的最高振动频率联系起来。本练习将指导您通过模态分析，为一维近场动力学杆模型推导出最大稳定时间步长，从而将数值约束与材料的微观参数和离散化细节直接关联起来 [@problem_id:3587117]。掌握这一基本技能是进行任何有效的显式动态模拟的先决条件。", "problem": "考虑一个一维(1D)基于键的近场动力学实体，该实体在一个均匀周期性格点上离散化，节点间距为 $h$，质量密度为 $\\rho$，横截面积为 $A$，每个节点的集总质量为 $m = \\rho A h$。假设近场动力学视域 $\\delta$ 在每侧跨越 $N_b$ 个邻居层，且 $\\delta = N_b h$，其中 $N_b$ 是一个正奇数。在视域内，每个键施加一个线性的对力，其微模量为常数 $c$，并且近场动力学内力的空间积分通过对每个键连邻居使用权重为 $h$ 的均匀求积进行近似。由此得到的节点 $i$ 处的半离散运动方程可以写为\n$$\nm\\,\\ddot{u}_i(t) + \\sum_{s=1}^{N_b} c h \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n其中 $u_i(t)$ 是节点 $i$ 处的位移，周期性边界条件确保了指数在格点上循环。\n\n你需要分析应用于质量归一化系统的显式中心差分(CD)时间积分方案，并根据质量归一化刚度算子的最大特征值确定稳定性约束。然后，对于所描述的均匀 $1\\mathrm{D}$ 离散化，通过在周期性格点上进行模态(傅里叶)分析，计算质量归一化刚度算子的最大特征值 $\\lambda_{\\max}$，并确定使特征值最大化的波数。\n\n利用这些结果，提供一个关于显式CD方案的最大允许时间步长 $\\Delta t_{\\max}$ 的单一闭式解析表达式，该表达式用 $\\rho$、$A$、$c$ 和 $N_b$ 表示，并假设 $N_b$ 是奇数。最大允许时间步长以秒为单位表示。最终答案必须是单一的闭式表达式。", "solution": "该问题要求推导应用于一维基于键的近场动力学模型的显式中心差分(CD)时间积分方案的最大稳定时间步长 $\\Delta t_{\\max}$。推导过程分几个步骤：首先，分析CD方案相对于系统特征值的稳定性；其次，通过对所给运动方程进行模态分析来计算这些特征值；第三，确定最大特征值；最后，将此最大特征值代入稳定性判据以求得 $\\Delta t_{\\max}$。\n\n节点 $i$ 处的半离散运动方程为：\n$$\nm\\,\\ddot{u}_i(t) + \\sum_{s=1}^{N_b} c h \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n其中 $m = \\rho A h$ 是每个节点的集总质量，$\\rho$ 是质量密度，$A$ 是横截面积，$h$ 是节点间距，$c$ 是常数微模量，$N_b$ 是视域每侧的邻居层数。\n\n首先，我们构建质量归一化的运动方程。将给定方程除以质量 $m$：\n$$\n\\ddot{u}_i(t) + \\frac{ch}{m} \\sum_{s=1}^{N_b} \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n代入质量表达式 $m = \\rho A h$：\n$$\n\\ddot{u}_i(t) + \\frac{ch}{\\rho A h} \\sum_{s=1}^{N_b} \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n节点间距 $h$ 消去，得到：\n$$\n\\ddot{u}_i(t) + \\frac{c}{\\rho A} \\sum_{s=1}^{N_b} \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n这个耦合常微分方程组可以写成矩阵形式 $\\ddot{\\mathbf{u}}(t) + \\mathbf{K}_m \\mathbf{u}(t) = \\mathbf{0}$，其中 $\\mathbf{K}_m$ 是质量归一化刚度矩阵。\n\n对于形如 $\\ddot{\\mathbf{u}} + \\mathbf{K}_m \\mathbf{u} = \\mathbf{0}$ 的系统，显式中心差分方案的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件要求时间步长 $\\Delta t$ 满足：\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}} = \\frac{2}{\\sqrt{\\lambda_{\\max}}}\n$$\n其中 $\\omega_{\\max}$ 是离散系统的最高自然频率，而 $\\lambda_{\\max} = \\omega_{\\max}^2$ 是质量归一化刚度矩阵 $\\mathbf{K}_m$ 的最大特征值。\n\n为求 $\\mathbf{K}_m$ 的特征值，我们进行模态(傅里葉)分析。我们假设周期性格点上的位移具有行波解（傅里叶模态）的形式：\n$$\nu_j(t) = \\tilde{u}(k) \\exp(i(kjh - \\omega t))\n$$\n其中 $j$ 是节点指数，$k$ 是波数，$\\omega$ 是角频率。二阶时间导数为 $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$。将此代入质量归一化的运动方程中：\n$$\n-\\omega^2 u_i(t) + \\frac{c}{\\rho A} \\sum_{s=1}^{N_b} \\left( 2 u_i(t) - u_{i+s}(t) - u_{i-s}(t) \\right) = 0\n$$\n代入模态形式并消去公因子 $\\tilde{u}(k)\\exp(i(kih - \\omega t))$：\n$$\n-\\omega^2 + \\frac{c}{\\rho A} \\sum_{s=1}^{N_b} \\left( 2 - e^{iksh} - e^{-iksh} \\right) = 0\n$$\n$\\mathbf{K}_m$ 的特征值 $\\lambda(k)$ 是 $\\omega^2(k)$ 的值，这给出了色散关系：\n$$\n\\lambda(k) = \\omega^2(k) = \\frac{c}{\\rho A} \\sum_{s=1}^{N_b} \\left( 2 - (e^{iksh} + e^{-iksh}) \\right)\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，上式变为：\n$$\n\\lambda(k) = \\frac{2c}{\\rho A} \\sum_{s=1}^{N_b} \\left( 1 - \\cos(ksh) \\right)\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\n\\lambda(k) = \\frac{4c}{\\rho A} \\sum_{s=1}^{N_b} \\sin^2\\left(\\frac{ksh}{2}\\right)\n$$\n为求最大特征值 $\\lambda_{\\max}$，我们必须找到使 $\\lambda(k)$ 最大化的波数 $k$。对于离散格点，唯一的波数位于第一布里渊区 $k \\in [-\\pi/h, \\pi/h]$。函数 $\\lambda(k)$ 在布里渊区的边界处取得最大值，特别是在 $k = \\pi/h$ 处。这对应于最高频率模态，其中相邻节点朝相反方向运动，从而使键的拉伸最大化。\n\n我们在 $k = \\pi/h$ 处计算 $\\lambda(k)$ 的值：\n$$\n\\lambda_{\\max} = \\lambda(\\pi/h) = \\frac{4c}{\\rho A} \\sum_{s=1}^{N_b} \\sin^2\\left(\\frac{(\\pi/h)sh}{2}\\right) = \\frac{4c}{\\rho A} \\sum_{s=1}^{N_b} \\sin^2\\left(\\frac{s\\pi}{2}\\right)\n$$\n项 $\\sin^2(s\\pi/2)$ 在 $s$ 为奇数时值为 $1$，在 $s$ 为偶数时值为 $0$。题目说明 $N_b$ 是一个正奇数。求和的范围是 $s \\in \\{1, 2, \\dots, N_b\\}$。在此范围内的奇数个数为 $\\frac{N_b+1}{2}$。因此，该和为：\n$$\n\\sum_{s=1}^{N_b} \\sin^2\\left(\\frac{s\\pi}{2}\\right) = 1 \\times (\\text{奇数 } s \\text{ 的个数}) + 0 \\times (\\text{偶数 } s \\text{ 的个数}) = \\frac{N_b+1}{2}\n$$\n将此结果代回 $\\lambda_{\\max}$ 的表达式中：\n$$\n\\lambda_{\\max} = \\frac{4c}{\\rho A} \\left( \\frac{N_b+1}{2} \\right) = \\frac{2c(N_b+1)}{\\rho A}\n$$\n最后，我们将此最大特征值代入稳定性判据，求得最大允许时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\sqrt{\\lambda_{\\max}}} = \\frac{2}{\\sqrt{\\frac{2c(N_b+1)}{\\rho A}}}\n$$\n简化表达式：\n$$\n\\Delta t_{\\max} = 2 \\sqrt{\\frac{\\rho A}{2c(N_b+1)}} = \\sqrt{\\frac{4\\rho A}{2c(N_b+1)}} = \\sqrt{\\frac{2\\rho A}{c(N_b+1)}}\n$$\n这个闭式表达式给出了最大稳定时间步长，用指定的参数 $\\rho$、$A$、$c$ 和 $N_b$ 表示。量纲分析证实了结果的单位是时间（秒）。", "answer": "$$\\boxed{\\sqrt{\\frac{2\\rho A}{c(N_b+1)}}}$$", "id": "3587117"}, {"introduction": "在确保数值稳定性之后，我们必须验证我们的模拟是否准确地反映了断裂的物理过程。最可靠的验证方法是进行能量平衡审计，以确保系统的总能量——包括动能、弹性能和断裂功——在没有外部做功的情况下是守恒的，或者其耗散得到了正确的核算。本练习要求您实现一个包含不可逆键断裂的一维动态模拟，并执行严格的能量审计 [@problem_id:3587038]。通过量化数值耗散的来源，您将深刻理解模拟的保真度以及断裂过程中能量转换的物理机制。", "problem": "考虑一个一维均匀杆的基于键的近场动力学公式，该杆被离散化为 $N$ 个等间距的物质点。近场动力学运动方程直接源于牛顿第二定律和成对的近场动力学力函数。您的任务是为具有不可逆键断裂的微弹性脆性模型实现一个显式中心差分时间积分器，并执行严格的能量平衡检查，包括动能、弹性（成对键）能以及因键断裂而累积的断裂功。此外，您必须量化归因于两个来源的数值耗散：显式时间积分和断裂时邻居（键）的阶梯式更新。\n\n基本原理：\n- 牛顿第二定律：对于每个质量为 $m_i$ 的物质点 $i$，其加速度由净内近场动力学力给出，即 $m_i \\, \\ddot{y}_i(t) = \\sum_{j \\in \\mathcal{H}_i} f_{ij}(t)$，其中 $\\mathcal{H}_i$ 表示在参考构型中 $i$ 的作用域内的邻居集合。\n- 具有恒定微模量 $c$ 和单位影响函数的一维基于键的微弹性脆性近场动力学：对于点 $i$ 和 $j$ 之间的一个键，参考间距为 $r_{0,ij} = x_j - x_i > 0$，当前间距为 $r_{ij}(t) = y_j(t) - y_i(t)$，拉伸率为 $s_{ij}(t) = \\dfrac{r_{ij}(t) - r_{0,ij}}{r_{0,ij}}$。沿键的成对标量力贡献为 $f_{ij}(t) = c \\, s_{ij}(t) \\, V_i V_j$，对点 $i$ 产生正向作用，对点 $j$ 产生负向作用，其中 $V_i$ 和 $V_j$ 是相关的点体积。当 $s_{ij}(t) \\ge s_{\\mathrm{crit}}$ 时，键发生不可逆断裂。\n- 能量学：动能为 $E_{\\mathrm{kin}}(t) = \\sum_i \\dfrac{1}{2} m_i v_i(t)^2$，其中 $v_i(t)$ 是物质点速度。储存在所有未断裂键中的弹性能力为 $E_{\\mathrm{el}}(t) = \\sum_{(i,j) \\in \\mathcal{B}(t)} \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{ij}(t)^2 \\, V_i V_j$，其中 $\\mathcal{B}(t)$ 是当前的未断裂键集合（每个键只计算一次）。因键断裂而累积的断裂功为 $E_{\\mathrm{frac}}(t) = \\sum_{(i,j) \\in \\mathcal{F}(t)} \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{\\mathrm{crit}}^2 \\, V_i V_j$，其中 $\\mathcal{F}(t)$ 是到时间 $t$ 为止已断裂的键集合。\n- 能量平衡检查：在没有外力做功的情况下，理想的能量平衡是 $E_{\\mathrm{tot}}(t) = E_{\\mathrm{kin}}(t) + E_{\\mathrm{el}}(t) + E_{\\mathrm{frac}}(t) = \\mathrm{constant}$。任何偏离恒定值的现象都是由数值伪影引起的。将给定时间 $t$ 的总数值耗散定义为 $D_{\\mathrm{tot}}(t) = E_{\\mathrm{tot}}(0) - E_{\\mathrm{tot}}(t)$。当在离散的更新时间检测到键断裂时，键的拉伸率可能会超过 $s_{\\mathrm{crit}}$；与此相关的、$E_{\\mathrm{frac}}$ 未计入的超调能量为 $D_{\\mathrm{nbr}}(t) = \\sum_{\\text{break events}} \\dfrac{1}{2} c \\, r_{0,ij} \\, \\left( s_{ij}(t)^2 - s_{\\mathrm{crit}}^2 \\right) \\, V_i V_j$，在检测时间进行评估。将此量归因于阶梯式邻居（键）更新耗散。然后将余量 $D_{\\mathrm{time}}(t) = D_{\\mathrm{tot}}(t) - D_{\\mathrm{nbr}}(t)$ 归因于显式时间积分误差。\n\n几何与离散化：\n- 一根长度为 $L$ 的一维均匀杆被离散化为 $N$ 个物质点。参考位置为 $x_i = i \\, \\Delta x$，对于 $i = 0, 1, \\dots, N-1$，其中 $\\Delta x = L/(N-1)$。所有点 $i$ 的点体积为 $V_i = \\Delta x$。每个点的质量为 $m_i = \\rho \\, A \\, V_i$，其中 $A$ 是横截面积，$\\rho$ 是质量密度。使用 $A = 1$ 和 $\\rho = 1$（无量纲一致单位）。\n- 近场动力学作用域为 $h$。参考构型中的邻居集包括所有满足 $j > i$ 和 $x_j - x_i \\le h$ 的点对 $(i,j)$。所有键的影响函数均为1，因此没有额外的加权。\n\n时间积分与键断裂：\n- 使用速度存储在半时间步上的显式中心差分更新：$v_i^{n+\\frac{1}{2}} = v_i^{n-\\frac{1}{2}} + \\dfrac{F_i^n}{m_i} \\, \\Delta t$，以及 $y_i^{n+1} = y_i^n + v_i^{n+\\frac{1}{2}} \\, \\Delta t$，其中 $F_i^n$ 是根据构型 $y^n$ 中未断裂的键计算出的净内力。使用 $y_i^0 = x_i$ 和 $v_i^{\\frac{1}{2}} = v_i^0$ 进行初始化（因为当 $s_{ij}^0 = 0$ 时 $F_i^0 = 0$）。\n- 更新到 $y^{n+1}$ 后，检测所有满足 $s_{ij}^{n+1} \\ge s_{\\mathrm{crit}}$ 的键。对于每个这样的键，累积断裂功增量 $\\Delta E_{\\mathrm{frac}} = \\dfrac{1}{2} c \\, r_{0,ij} \\, s_{\\mathrm{crit}}^2 \\, V_i V_j$，计算超调耗散增量 $\\Delta D_{\\mathrm{nbr}} = \\dfrac{1}{2} c \\, r_{0,ij} \\, \\left( s_{ij}^{n+1}{}^2 - s_{\\mathrm{crit}}^2 \\right) \\, V_i V_j$，并将该键标记为断裂，以便它此后不再贡献力或弹性能力。请注意，检测是在离散时间进行的，不使用子步长；因此，当发生超调时，$\\Delta D_{\\mathrm{nbr}} \\ge 0$。\n\n初始条件：\n- 初始位移为零，$y_i^0 = x_i$。初始速度是一个线性斜坡 $v_i^0 = v_{\\mathrm{amp}} \\, \\dfrac{x_i}{L}$，在短时间内对所有键产生均匀的拉伸率。当 $s_{ij}$ 保持很小时，这一选择导致所有作用域内的键的初始拉伸率是均匀的，约为 $ \\dot{s}_{ij}(0) \\approx \\dfrac{v_{\\mathrm{amp}}}{L}$。\n\n所需输出与单位：\n- 所有量都是无量纲的（单位一致的系统）。不需要进行物理单位转换。\n- 对于每个测试用例，在最终模拟时间 $T$ 计算以下浮点数：$D_{\\mathrm{tot}}(T)$、$D_{\\mathrm{nbr}}(T)$ 和 $D_{\\mathrm{time}}(T)$。此外，使用在每个时间步采样到的值，计算整个模拟过程中的最大总耗散幅值，$D_{\\max} = \\max_{0 \\le t \\le T} \\left| D_{\\mathrm{tot}}(t) \\right|$。\n\n测试套件：\n使用以下参数集实现三个测试用例。在所有情况下，使用 $N = 101$，$L = 1$，$\\rho = 1$，$A = 1$，作用域 $h = 3 \\Delta x$，微模量 $c = 0.5$，以及临界拉伸率 $s_{\\mathrm{crit}} = 0.02$。\n1. 正常情况：中等时间步长和速度幅值，预计会有一些键断裂和中等程度的超調。\n   - $\\Delta t = 2.0 \\times 10^{-4}$，$T = 5.0 \\times 10^{-2}$，$v_{\\mathrm{amp}} = 0.5$。\n2. 近保守边界：小时间步长，预计显式积分误差非常低且超調减小。\n   - $\\Delta t = 5.0 \\times 10^{-5}$，$T = 5.0 \\times 10^{-2}$，$v_{\\mathrm{amp}} = 0.5$。\n3. 边缘情况：大时间步长，预计超調引起的耗散更大且积分误差明显。\n   - $\\Delta t = 8.0 \\times 10^{-4}$，$T = 5.0 \\times 10^{-2}$，$v_{\\mathrm{amp}} = 0.5$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例产生一个包含四个浮点数的列表，顺序为 $[D_{\\mathrm{tot}}(T), D_{\\mathrm{nbr}}(T), D_{\\mathrm{time}}(T), D_{\\max}]$。因此，总输出是包含三个此类列表的列表，每个测试用例一个，例如 $[[d_{1,\\mathrm{tot}}, d_{1,\\mathrm{nbr}}, d_{1,\\mathrm{time}}, d_{1,\\max}], [d_{2,\\mathrm{tot}}, d_{2,\\mathrm{nbr}}, d_{2,\\mathrm{time}}, d_{2,\\max}], [d_{3,\\mathrm{tot}}, d_{3,\\mathrm{nbr}}, d_{3,\\mathrm{time}}, d_{3,\\max}]]$。", "solution": "该问题要求实现一个针对微弹性脆性杆的一维、基于键的近场动力学模拟。目标是执行详细的能量平衡分析，量化来自两个不同来源的数值耗散：显式时间积分方案和键断裂更新的离散特性。\n\n本解答首先将长度为 $L$ 的一维杆离散化为 $N$ 个物质点。每个点 $i$ 的参考位置是 $x_i = i \\Delta x$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$，均匀间距为 $\\Delta x = L/(N-1)$。每个点都有一个体积 $V_i = \\Delta x$ 和质量 $m_i = \\rho A V_i$，其中 $\\rho$ 是质量密度，$A$ 是横截面积。对于此问题，我们使用 $\\rho=1$ 和 $A=1$。\n\n该近场动力学模型是基于键的，这意味着物质点通过在一个称为作用域（horizon, $h$）的有限半径内的成对力相互作用。如果在初始时任意两点 $i$ 和 $j$ 的间距 $r_{0,ij} = |x_j - x_i|$ 小于或等于 $h$，则它们之间建立一个键。为了实现，我们只考虑 $i  j$ 的点对，所以 $r_{0,ij} = x_j - x_i$。这个键集合是预先计算并存储的。每个键的状态（活动或断裂）在整个模拟过程中被跟踪。\n\n系统的动力学由每个物质点 $i$ 的牛顿第二定律决定：\n$$m_i \\ddot{y}_i(t) = F_i(t)$$\n其中 $y_i(t)$ 是点 $i$ 的当前位置，$F_i(t)$ 是作用于其上的净近场动力学力。该力是连接到点 $i$ 的所有键的贡献之和。根据问题的定义，点 $i$ 和 $j$（其中 $i  j$）之间的成对力由给定的微弹性脆性模型确定。时间积分使用显式中心差分方案。在每个时间步中，计算力，更新速度和位置，然后检查键断裂。能量项（动能、弹性势能、断裂功）和耗散项（超调耗散、时间积分耗散）也相应地进行累积和计算。该过程的实现细节见所附的 Python 代码。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the peridynamic simulation for the specified test cases\n    and print the results in the required format.\n    \"\"\"\n\n    def run_simulation(N, L, rho, A, c, scrit, h, dt, T, v_amp):\n        \"\"\"\n        Executes a single peridynamic simulation with a given set of parameters.\n\n        Returns a list of floats: [D_tot(T), D_nbr(T), D_time(T), D_max].\n        \"\"\"\n        # 1. Discretization and Initialization\n        dx = L / (N - 1)\n        m = rho * A * dx\n        V2 = dx * dx  # Pre-calculate V_i * V_j as it's constant\n\n        x = np.linspace(0, L, N, dtype=np.float64)\n        y_n = np.copy(x)\n\n        # Initial velocities\n        v_0 = v_amp * x / L\n        \n        # Central difference scheme uses velocities at half-time steps.\n        # v_n_minus_half represents v^{n-1/2}.\n        # For initialization, v^{1/2} = v^0 since F^0 is zero.\n        v_n_minus_half = np.copy(v_0)\n\n        # 2. Bond Setup\n        bonds = []\n        for i in range(N):\n            for j in range(i + 1, N):\n                dist = x[j] - x[i]\n                if dist = h + 1e-9: # Add tolerance for float comparison\n                    bonds.append({'i': i, 'j': j, 'r0': dist, 'active': True})\n        \n        # 3. Energy Initialization\n        E_frac = 0.0\n        D_nbr = 0.0\n        \n        # Initial kinetic energy at t=0. v(0) = v_0.\n        E_kin_0 = 0.5 * m * np.sum(v_0**2)\n        # Initial elastic and fracture energies are zero.\n        E_tot_0 = E_kin_0\n\n        D_max = 0.0\n        \n        num_steps = int(round(T / dt))\n\n        # 4. Time-stepping Loop\n        for n in range(num_steps):\n            # A. Compute forces F^n from positions y^n\n            F_n = np.zeros(N, dtype=np.float64)\n            s_n_values = {}  # Store stretches s^n for energy calculation\n\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    i, j = bond['i'], bond['j']\n                    r_n = y_n[j] - y_n[i]\n                    s_n = (r_n - bond['r0']) / bond['r0']\n                    s_n_values[k] = s_n\n                    \n                    f = c * s_n * V2\n                    F_n[i] += f\n                    F_n[j] -= f\n\n            # B. Update velocities from v^{n-1/2} to v^{n+1/2}\n            v_n_plus_half = v_n_minus_half + (F_n / m) * dt\n\n            # C. Energy calculation at time t_n\n            # v^n = (v^{n-1/2} + v^{n+1/2}) / 2\n            v_n = 0.5 * (v_n_minus_half + v_n_plus_half)\n            E_kin_n = 0.5 * m * np.sum(v_n**2)\n            \n            E_el_n = 0.0\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    s_n = s_n_values[k]\n                    E_el_n += 0.5 * c * bond['r0'] * s_n**2 * V2\n\n            E_tot_n = E_kin_n + E_el_n + E_frac\n            D_tot_n = E_tot_0 - E_tot_n\n            D_max = max(D_max, abs(D_tot_n))\n\n            # D. Update positions from y^n to y^{n+1}\n            y_n_plus_1 = y_n + v_n_plus_half * dt\n            \n            # E. Check for bond breaks based on new positions y^{n+1}\n            # The accumulated E_frac, D_nbr will be used in the next step's energy calc\n            for k, bond in enumerate(bonds):\n                if bond['active']:\n                    i, j = bond['i'], bond['j']\n                    r_np1 = y_n_plus_1[j] - y_n_plus_1[i]\n                    s_np1 = (r_np1 - bond['r0']) / bond['r0']\n                    \n                    if s_np1 >= scrit:\n                        bond['active'] = False\n                        \n                        E_frac += 0.5 * c * bond['r0'] * scrit**2 * V2\n                        D_nbr += 0.5 * c * bond['r0'] * (s_np1**2 - scrit**2) * V2\n            \n            # F. Prepare for the next iteration\n            y_n = y_n_plus_1\n            v_n_minus_half = v_n_plus_half\n    \n        # 5. Post-loop: Final calculation at time T\n        # Current state: y_n = y^{N_steps}, v_n_minus_half = v^{N_steps-1/2}\n        \n        # Final force calculation at t_N = T\n        F_N = np.zeros(N, dtype=np.float64)\n        s_N_values = {}\n        for k, bond in enumerate(bonds):\n            if bond['active']:\n                i, j = bond['i'], bond['j']\n                r_N = y_n[j] - y_n[i]\n                s_N = (r_N - bond['r0']) / bond['r0']\n                s_N_values[k] = s_N\n                \n                f = c * s_N * V2\n                F_N[i] += f\n                F_N[j] -= f\n\n        # Final velocity updates to get v at time T\n        v_N_plus_half = v_n_minus_half + (F_N / m) * dt\n        v_N = 0.5 * (v_n_minus_half + v_N_plus_half)\n        \n        # Final energy calculation\n        E_kin_T = 0.5 * m * np.sum(v_N**2)\n        \n        E_el_T = 0.0\n        for k, bond in enumerate(bonds):\n            if bond['active']:\n                s_N = s_N_values[k]\n                E_el_T += 0.5 * c * bond['r0'] * s_N**2 * V2\n\n        # E_frac and D_nbr are their final accumulated values\n        E_tot_T = E_kin_T + E_el_T + E_frac\n        D_tot_T = E_tot_0 - E_tot_T\n        D_time_T = D_tot_T - D_nbr\n        \n        D_max = max(D_max, abs(D_tot_T))\n        \n        return [D_tot_T, D_nbr, D_time_T, D_max]\n\n    # --- Main execution ---\n    # Common parameters\n    N = 101\n    L = 1.0\n    rho = 1.0\n    A = 1.0\n    c = 0.5\n    scrit = 0.02\n    dx = L / (N - 1)\n    h = 3.0 * dx\n    \n    test_cases = [\n        # (dt, T, v_amp)\n        (2.0e-4, 5.0e-2, 0.5), # Case 1: Happy path\n        (5.0e-5, 5.0e-2, 0.5), # Case 2: Near-conservative\n        (8.0e-4, 5.0e-2, 0.5)  # Case 3: Edge case (large dt)\n    ]\n\n    results = []\n    for dt, T, v_amp in test_cases:\n        case_results = run_simulation(N, L, rho, A, c, scrit, h, dt, T, v_amp)\n        results.append(case_results)\n\n    # Format the final output string exactly as required\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3587038"}, {"introduction": "近场动力学面临的一个众所周知的问题是“表面效应”，即由于相互作用域被截断，靠近自由表面或裂纹的物质点会表现出虚假的刚度折减。为了提高模型的预测精度，尤其是在预测裂纹萌生和扩展方面，可以对这种效应进行解析量化和校正。本练习旨在挑战您推导出一个半无限空间模型的刚度折减因子，并设计一个相应的校正方案 [@problem_id:3587105]。掌握这一概念对于将近场动力学断裂建模从定性分析推向定量预测至关重要。", "problem": "考虑一个占据区域 $x \\geq 0$ 的三维半空间，该半空间由原型微弹性脆性 (PMB) 模型描述的基于键的近场动力学材料构成。该材料具有恒定的微模量 $c$ 和恒定的影响函数 $\\omega(|\\boldsymbol{\\xi}|) = 1$，其球形相互作用域的半径为 $\\delta$。设 $\\boldsymbol{x}$ 表示距离自由表面 $x=0$ 深度为 $x$ 的一个材料点，并设 $\\boldsymbol{\\xi} = \\boldsymbol{x}' - \\boldsymbol{x}$ 表示连接到邻近点 $\\boldsymbol{x}'$ 的键矢量。\n\n假设在 $x$ 方向上施加一个小的均匀单轴应变场，其工程应变为 $\\varepsilon$，因此经典小应变张量为 $\\boldsymbol{\\varepsilon} = \\mathrm{diag}(\\varepsilon, 0, 0)$。在 PMB 模型中，小应变下的成对键伸长率为 $s(\\boldsymbol{\\xi}) \\approx \\boldsymbol{n} \\cdot \\boldsymbol{\\varepsilon} \\, \\boldsymbol{n}$，其中 $\\boldsymbol{n} = \\boldsymbol{\\xi}/|\\boldsymbol{\\xi}|$ 是键的方向，$\\boldsymbol{x}$ 点的近场动力学应变能密度为\n$$\nW_{\\mathrm{pd}}(\\boldsymbol{x}) = \\frac{1}{2} \\, c \\int_{H(\\boldsymbol{x})} s(\\boldsymbol{\\xi})^{2} \\, \\omega(|\\boldsymbol{\\xi}|) \\, \\mathrm{d}V',\n$$\n其中 $H(\\boldsymbol{x}) = \\{ \\boldsymbol{\\xi} \\in \\mathbb{R}^{3}: |\\boldsymbol{\\xi}| \\leq \\delta, \\, x + \\xi_{x} \\geq 0 \\}$ 是被自由表面截断的相互作用域。\n\n将在深度 $x$ 处的伪刚度折减因子 $R(\\alpha)$ 定义为 $\\boldsymbol{x}$ 点的近场动力学能量密度与远离边界的内部点的体材料近场动力学能量密度之比，其中 $\\alpha = x/\\delta \\in [0,1]$。体材料能量密度对应于 $H(\\boldsymbol{x}) = \\{ \\boldsymbol{\\xi}: |\\boldsymbol{\\xi}| \\leq \\delta \\}$ (无截断)。\n\n从上述定义出发，推导在所述均匀单轴应变条件下，$R(\\alpha)$ 对于 $0 \\leq \\alpha \\leq 1$ 的闭式解析表达式。然后，假设微模量 $c$ 已经过校准，使得体材料的近场动力学能量密度等于具有目标模量 $E_{0}$ 的经典连续介质能量密度，即 $W_{\\mathrm{pd,bulk}} = \\frac{1}{2} E_{0} \\varepsilon^{2}$。确定一个施加在边界层 $0 \\leq x \\leq \\delta$ 内微模量上的乘法修正因子 $\\beta(\\alpha)$，使得每个深度上修正后的近场动力学能量密度与目标连续介质能量密度的匹配度在公差 $t = 10^{-3}$ 以内。\n\n将您的最终答案表示为关于 $\\alpha$ 的无量纲函数，不带单位。不需要进行数值四舍五入；请提供精确的解析表达式。", "solution": "该问题要求推导与基于键的近场动力学半空间中的表面效应相关的两个量：刚度折减因子 $R(\\alpha)$ 和相应的修正因子 $\\beta(\\alpha)$。解答过程分为两个主要部分。\n\n首先，我们推导伪刚度折减因子 $R(\\alpha)$。根据定义，该因子是距离自由表面深度为 $x$ 处的近场动力学应变能密度 $W_{\\mathrm{pd}}(x)$ 与体材料中的应变能密度 $W_{\\mathrm{pd,bulk}}$ 之比。深度由无量纲量 $\\alpha = x/\\delta$ 参数化，其中 $\\delta$ 是近场动力学相互作用域的半径。\n\n$R(\\alpha) = \\frac{W_{\\mathrm{pd}}(x)}{W_{\\mathrm{pd,bulk}}}$\n\n近场动力学应变能密度由下式给出：\n$$W_{\\mathrm{pd}}(\\boldsymbol{x}) = \\frac{1}{2} \\, c \\int_{H(\\boldsymbol{x})} s(\\boldsymbol{\\xi})^{2} \\, \\omega(|\\boldsymbol{\\xi}|) \\, \\mathrm{d}V'$$\n影响函数为 $\\omega(|\\boldsymbol{\\xi}|) = 1$。在 $x$ 方向上小的单轴应变 $\\varepsilon$ 下的键伸长率 $s(\\boldsymbol{\\xi})$ 为 $s(\\boldsymbol{\\xi}) \\approx \\boldsymbol{n} \\cdot \\boldsymbol{\\varepsilon} \\, \\boldsymbol{n}$。设 $\\boldsymbol{\\xi} = (\\xi_x, \\xi_y, \\xi_z)$ 且 $|\\boldsymbol{\\xi}| = \\rho$。沿键的单位矢量为 $\\boldsymbol{n} = \\boldsymbol{\\xi}/\\rho$。经典应变张量为 $\\boldsymbol{\\varepsilon} = \\mathrm{diag}(\\varepsilon, 0, 0)$。\n键伸长率计算如下：\n$s(\\boldsymbol{\\xi}) = \\frac{\\boldsymbol{\\xi}}{\\rho} \\cdot \\begin{pmatrix} \\varepsilon  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\frac{\\boldsymbol{\\xi}}{\\rho} = \\frac{1}{\\rho^2} (\\xi_x, \\xi_y, \\xi_z) \\begin{pmatrix} \\varepsilon \\xi_x \\\\ 0 \\\\ 0 \\end{pmatrix} = \\varepsilon \\frac{\\xi_x^2}{\\rho^2}$。\n被积项为 $s(\\boldsymbol{\\xi})^2 = \\varepsilon^2 \\frac{\\xi_x^4}{\\rho^4}$。\n\n为了进行体积积分，我们对以材料点 $\\boldsymbol{x}$ 为中心的键矢量 $\\boldsymbol{\\xi}$ 使用球坐标。为方便起见，我们将极轴与 $x$ 方向对齐。设 $\\xi_x = \\rho \\cos\\phi$, $\\xi_y = \\rho \\sin\\phi \\cos\\theta$, $\\xi_z = \\rho \\sin\\phi \\sin\\theta$，其中 $\\rho = |\\boldsymbol{\\xi}|$ 是径向距离，$\\phi \\in [0, \\pi]$ 是与正 $x$ 轴的极角，$\\theta \\in [0, 2\\pi]$ 是方位角。体积元为 $\\mathrm{d}V' = \\rho^2 \\sin\\phi \\, \\mathrm{d}\\rho \\, \\mathrm{d}\\phi \\, \\mathrm{d}\\theta$。\n在这些坐标系中，$s(\\boldsymbol{\\xi})^2 = \\varepsilon^2 (\\frac{\\rho \\cos\\phi}{\\rho})^4 = \\varepsilon^2 \\cos^4\\phi$。\n\n接下来，我们计算体材料能量密度 $W_{\\mathrm{pd,bulk}}$。对于远离任何边界的点，相互作用域 $H(\\boldsymbol{x})$ 是一个半径为 $\\delta$ 的完整球体，记为 $B(\\delta)$。\n$W_{\\mathrm{pd,bulk}} = \\frac{1}{2} c \\varepsilon^2 \\int_{B(\\delta)} \\cos^4\\phi \\, \\mathrm{d}V' = \\frac{1}{2} c \\varepsilon^2 \\int_0^{2\\pi} \\mathrm{d}\\theta \\int_0^\\pi \\mathrm{d}\\phi \\int_0^\\delta \\mathrm{d}\\rho \\, (\\cos^4\\phi)(\\rho^2\\sin\\phi)$。\n该积分可分离变量：\n$\\int_0^{2\\pi} \\mathrm{d}\\theta = 2\\pi$。\n$\\int_0^\\delta \\rho^2 \\, \\mathrm{d}\\rho = \\frac{\\delta^3}{3}$。\n$\\int_0^\\pi \\cos^4\\phi \\sin\\phi \\, \\mathrm{d}\\phi$。令 $u = \\cos\\phi$，则 $\\mathrm{d}u = -\\sin\\phi \\, \\mathrm{d}\\phi$。积分上下限从 $[0, \\pi]$ 变为 $[1, -1]$。\n$\\int_1^{-1} u^4 (-\\mathrm{d}u) = \\int_{-1}^1 u^4 \\, \\mathrm{d}u = \\left[\\frac{u^5}{5}\\right]_{-1}^1 = \\frac{1}{5} - \\frac{-1}{5} = \\frac{2}{5}$。\n结合这些结果，总积分为 $(2\\pi) (\\frac{\\delta^3}{3}) (\\frac{2}{5}) = \\frac{4\\pi\\delta^3}{15}$。\n因此，$W_{\\mathrm{pd,bulk}} = \\frac{1}{2} c \\varepsilon^2 \\left(\\frac{4\\pi\\delta^3}{15}\\right) = \\frac{2\\pi c \\delta^3 \\varepsilon^2}{15}$。\n\n现在，我们计算深度为 $x$（其中 $0 \\le x \\le \\delta$）的点的能量密度 $W_{\\mathrm{pd}}(x)$。积分域是被截断的相互作用域 $H(\\boldsymbol{x}) = \\{ \\boldsymbol{\\xi} \\in \\mathbb{R}^{3}: |\\boldsymbol{\\xi}| \\leq \\delta, \\, x + \\xi_{x} \\geq 0 \\}$。\n在我们的球坐标系中，约束条件为 $x + \\rho\\cos\\phi \\ge 0$，或 $\\rho\\cos\\phi \\ge -x$。使用 $\\alpha=x/\\delta$，该式变为 $\\rho\\cos\\phi \\ge -\\alpha\\delta$。\n$W_{\\mathrm{pd}}(x)$ 的积分为：\n$W_{\\mathrm{pd}}(x) = \\frac{1}{2} c \\varepsilon^2 \\int_0^{2\\pi} \\mathrm{d}\\theta \\int_0^\\pi \\mathrm{d}\\phi \\int_0^{\\rho_{max}(\\phi)} \\mathrm{d}\\rho \\, (\\cos^4\\phi)(\\rho^2\\sin\\phi)$，\n其中 $\\rho_{max}(\\phi)$ 由约束条件 $\\rho \\le \\delta$ 和 $\\rho\\cos\\phi \\ge -\\alpha\\delta$ 决定。\n对于 $\\phi \\in [0, \\pi/2]$，$\\cos\\phi \\ge 0$，因此 $\\rho\\cos\\phi \\ge 0 \\ge -\\alpha\\delta$。该条件始终满足，因此 $\\rho_{max}(\\phi)=\\delta$。\n对于 $\\phi \\in (\\pi/2, \\pi]$，$\\cos\\phi  0$。该条件为 $\\rho \\le -\\alpha\\delta/\\cos\\phi$。所以 $\\rho_{max}(\\phi) = \\min(\\delta, -\\alpha\\delta/\\cos\\phi)$。\n$\\rho_{max}$ 这两种情况之间的边界发生在 $\\delta = -\\alpha\\delta/\\cos\\phi$ 时，这给出 $\\cos\\phi = -\\alpha$。令 $\\phi_c = \\arccos(-\\alpha)$，其中对于 $\\alpha \\in [0, 1]$，$\\phi_c \\in [\\pi/2, \\pi]$。\n- 对于 $\\phi \\in [0, \\phi_c]$，我们有 $\\cos\\phi \\ge -\\alpha$，所以 $-\\alpha/\\cos\\phi \\ge 1$ (因为对于 $\\phi \\in (\\pi/2,\\phi_c)$，$\\cos\\phi0$)，这意味着 $-\\alpha\\delta/\\cos\\phi \\ge \\delta$。所以 $\\rho_{max}(\\phi)=\\delta$。\n- 对于 $\\phi \\in (\\phi_c, \\pi]$，我们有 $\\cos\\phi  -\\alpha$，所以 $-\\alpha/\\cos\\phi  1$，这意味着 $-\\alpha\\delta/\\cos\\phi  \\delta$。所以 $\\rho_{max}(\\phi) = -\\alpha\\delta/\\cos\\phi$。\n\n体积积分分为两部分：\n$I(x) = \\int_0^{2\\pi} \\mathrm{d}\\theta \\left[ \\int_0^{\\phi_c} \\cos^4\\phi \\sin\\phi \\left(\\int_0^\\delta \\rho^2 \\mathrm{d}\\rho\\right) \\mathrm{d}\\phi + \\int_{\\phi_c}^\\pi \\cos^4\\phi \\sin\\phi \\left(\\int_0^{-\\alpha\\delta/\\cos\\phi} \\rho^2 \\mathrm{d}\\rho\\right) \\mathrm{d}\\phi \\right]$\n$I(x) = 2\\pi \\left[ \\frac{\\delta^3}{3} \\int_0^{\\phi_c} \\cos^4\\phi \\sin\\phi \\, \\mathrm{d}\\phi + \\int_{\\phi_c}^\\pi \\cos^4\\phi \\sin\\phi \\left(\\frac{1}{3} \\frac{(-\\alpha\\delta)^3}{\\cos^3\\phi}\\right) \\mathrm{d}\\phi \\right]$\n$I(x) = \\frac{2\\pi\\delta^3}{3} \\left[ \\int_0^{\\phi_c} \\cos^4\\phi \\sin\\phi \\, \\mathrm{d}\\phi - \\alpha^3 \\int_{\\phi_c}^\\pi \\cos\\phi \\sin\\phi \\, \\mathrm{d}\\phi \\right]$\n计算积分：\n$\\int_0^{\\phi_c} \\cos^4\\phi \\sin\\phi \\, \\mathrm{d}\\phi = \\left[-\\frac{\\cos^5\\phi}{5}\\right]_0^{\\phi_c} = -\\frac{\\cos^5\\phi_c}{5} + \\frac{1}{5} = \\frac{1-(-\\alpha)^5}{5} = \\frac{1+\\alpha^5}{5}$。\n$\\int_{\\phi_c}^\\pi \\cos\\phi \\sin\\phi \\, \\mathrm{d}\\phi = \\left[\\frac{\\sin^2\\phi}{2}\\right]_{\\phi_c}^\\pi = \\frac{\\sin^2\\pi - \\sin^2\\phi_c}{2} = -\\frac{\\sin^2\\phi_c}{2}$。\n由于 $\\sin^2\\phi_c = 1 - \\cos^2\\phi_c = 1 - (-\\alpha)^2 = 1-\\alpha^2$，该积分为 $-\\frac{1-\\alpha^2}{2} = \\frac{\\alpha^2-1}{2}$。\n代回到 $I(x)$ 的表达式中：\n$I(x) = \\frac{2\\pi\\delta^3}{3} \\left[ \\frac{1+\\alpha^5}{5} - \\alpha^3\\left(\\frac{\\alpha^2-1}{2}\\right) \\right] = \\frac{2\\pi\\delta^3}{30} [2(1+\\alpha^5) - 5\\alpha^3(\\alpha^2-1)] = \\frac{2\\pi\\delta^3}{30} [2+2\\alpha^5 - 5\\alpha^5 + 5\\alpha^3] = \\frac{\\pi\\delta^3}{15} (2+5\\alpha^3-3\\alpha^5)$。\n则 $W_{\\mathrm{pd}}(x) = \\frac{1}{2} c \\varepsilon^2 I(x) = \\frac{\\pi c \\varepsilon^2 \\delta^3}{30} (2+5\\alpha^3-3\\alpha^5)$。\n\n最后，我们计算比率 $R(\\alpha)$：\n$R(\\alpha) = \\frac{W_{\\mathrm{pd}}(x)}{W_{\\mathrm{pd,bulk}}} = \\frac{\\frac{\\pi c \\varepsilon^2 \\delta^3}{15} (2+5\\alpha^3-3\\alpha^5)/2}{\\frac{2 \\pi c \\delta^3 \\varepsilon^2}{15}} = \\frac{\\frac{1}{30} (2+5\\alpha^3-3\\alpha^5)}{\\frac{2}{15}} = \\frac{1}{4} (2+5\\alpha^3-3\\alpha^5)$。\n$R(\\alpha) = \\frac{1}{2} + \\frac{5}{4}\\alpha^3 - \\frac{3}{4}\\alpha^5$。\n\n第二，我们推导修正因子 $\\beta(\\alpha)$。目标是将微模量 $c$ 修改为 $c' = \\beta(\\alpha) c$，使得修正后的能量密度 $W_{\\mathrm{pd,corr}}(x)$ 与目标连续介质能量密度相匹配。问题指出，这个目标能量密度等于体材料的近场动力学能量密度 $W_{\\mathrm{pd,bulk}}$。深度 $x$ 处的修正能量密度为：\n$W_{\\mathrm{pd,corr}}(x) = \\beta(\\alpha) W_{\\mathrm{pd}}(x)$。\n我们要求它等于目标能量 $W_{\\mathrm{pd,bulk}}$。\n$\\beta(\\alpha) W_{\\mathrm{pd}}(x) = W_{\\mathrm{pd,bulk}}$。\n求解 $\\beta(\\alpha)$：\n$\\beta(\\alpha) = \\frac{W_{\\mathrm{pd,bulk}}}{W_{\\mathrm{pd}}(x)} = \\frac{1}{R(\\alpha)}$。\n问题规定匹配度应在公差 $t=10^{-3}$ 以内。选择 $\\beta(\\alpha) = 1/R(\\alpha)$ 会得到完美匹配，$W_{\\mathrm{pd,corr}}(x) = W_{\\mathrm{pd,bulk}}$，因此误差为 0，小于指定的公差。这提供了精确的解析修正因子。\n$\\beta(\\alpha) = \\frac{1}{\\frac{1}{2} + \\frac{5}{4}\\alpha^3 - \\frac{3}{4}\\alpha^5} = \\frac{4}{2 + 5\\alpha^3 - 3\\alpha^5}$。\n\n推导出的两个关于 $\\alpha \\in [0,1]$ 的无量纲函数是刚度折减因子 $R(\\alpha)$ 和相应的修正因子 $\\beta(\\alpha)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} + \\frac{5}{4}\\alpha^3 - \\frac{3}{4}\\alpha^5  \\frac{4}{2 + 5\\alpha^3 - 3\\alpha^5}\n\\end{pmatrix}\n}\n$$", "id": "3587105"}]}