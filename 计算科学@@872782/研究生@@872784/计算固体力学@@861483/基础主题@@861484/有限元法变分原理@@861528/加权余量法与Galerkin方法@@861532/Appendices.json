{"hands_on_practices": [{"introduction": "有限元方法的核心是将连续的偏微分方程转化为离散的代数方程组。第一个练习将通过经典的泊松方程，具体地、一步步地引导你完成这个过程。通过从加权残值陈述式出发，推导单元刚度矩阵并执行简单的组装，你将巩固对这一基本程序的理解[@problem_id:3610256]。", "problem": "考虑一个多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的稳态二维泊松方程，用于描述一个标量场 $u(x,y)$，其中传導率 $k>0$ 为各向同性的常数：\n$$ -\\nabla \\cdot \\left( k \\nabla u \\right) = f \\quad \\text{in } \\Omega, $$\n并在边界 $\\partial \\Omega$ 上施加适当的本质边界条件。从加权残差法陈述出发，并使用伽辽金(Galerkin)检验函数选择（即检验空间和试探空间由相同的有限元基函数张成），推导三角形单元 $e$ 上的单元刚度矩阵表达式，其形式为一个积分：\n$$ K^{(e)} = \\int_{\\Omega_e} B^{T} k B \\, d\\Omega, $$\n其中 $B$ 由单元上线性形函数的空间梯度构成。证明对于线性三角形单元，$B$ 在整个单元上是常数，并根据节点坐标显式地计算该积分。\n\n然后，考虑一个方形域 $\\Omega = [0,1] \\times [0,1]$，它被从 $(0,0)$ 到 $(1,1)$ 的对角线离散为两个不重叠的线性三角形单元：\n- 单元 $e_1$ 的全局节点为 $\\{1,2,3\\}$，坐标为 $(x_1,y_1)=(0,0)$，$(x_2,y_2)=(1,0)$，$(x_3,y_3)=(1,1)$。\n- 单元 $e_2$ 的全局节点为 $\\{1,3,4\\}$，坐标为 $(x_1,y_1)=(0,0)$，$(x_3,y_3)=(1,1)$，$(x_4,y_4)=(0,1)$。\n\n使用推导出的 $B$ 和常数传導率 $k$，通过在每个单元上计算 $\\int_{\\Omega_e} B^{T} k B \\, d\\Omega$ 来显式地计算 $K^{(e_1)}$ 和 $K^{(e_2)}$。使用基于全局节点编号 $\\{1,2,3,4\\}$ 的标准有限元组装程序，将这两个单元矩阵组装成 $4 \\times 4$ 的全局刚度矩阵 $K$。\n\n组装后的全局刚度矩阵项 $K_{23}$ 是多少？请用 $k$ 的精确符号表达式表示。请以 $k$ 的单个精确符号表达式形式给出最终答案（无单位，无近似值）。", "solution": "过程始于对问题陈述的验证。\n\n### 第1步：提取已知条件\n- **控制方程**：稳态二维泊松方程由 $-\\nabla \\cdot (k \\nabla u) = f$ 在域 $\\Omega \\subset \\mathbb{R}^{2}$ 中给出。\n- **传導率**：$k$ 是一个正常数（$k>0$）且各向同性。\n- **方法论**：推导应从加权残差法陈述开始，并采用伽辽金方法，其中检验函数和试探函数来自同一有限元基函数张成的空间。\n- **目标表达式**：单元刚度矩阵 $K^{(e)}$ 必须以 $K^{(e)} = \\int_{\\Omega_e} B^{T} k B \\, d\\Omega$ 的形式推导。\n- **单元类型**：使用线性三角形单元。\n- **特定域**：一个方形域 $\\Omega = [0,1] \\times [0,1]$。\n- **离散化**：该域被从 $(0,0)$ 到 $(1,1)$ 的对角线划分为两个不重叠的线性三角形单元 $e_1$ 和 $e_2$。\n- **单元连接关系与坐标**：\n    - 单元 $e_1$：全局节点 $\\{1,2,3\\}$，坐标为 $(x_1,y_1)=(0,0)$，$(x_2,y_2)=(1,0)$ 和 $(x_3,y_3)=(1,1)$。\n    - 单元 $e_2$：全局节点 $\\{1,3,4\\}$，坐标为 $(x_1,y_1)=(0,0)$，$(x_3,y_3)=(1,1)$ 和 $(x_4,y_4)=(0,1)$。\n- **目标**：计算单元刚度矩阵 $K^{(e_1)}$ 和 $K^{(e_2)}$，将它们组装成全局刚度矩阵 $K$，并确定特定项 $K_{23}$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于泊松方程，这是物理学和工程学中的一个基本偏微分方程，并使用有限元法（FEM）进行求解，FEM是一种标准的、成熟的数值技术。其原理在计算固体力学和传热学中是正确且主流的。\n- **适定的**：问题陈述清晰，提供了所有必要的信息。域、单元类型、节点坐标和连接关系都已明确定义。这种设置确保了所要求的刚度矩阵项有一个唯一的、稳定的和有意义的解。\n- **客观性**：问题使用精确的数学和技术语言表述，没有任何主观性或歧义。\n\n该问题未表现出任何无效性缺陷。它是科学合理的、适定的、完整的和可形式化的。\n\n### 第3步：结论与行动\n问题是有效的。将提供完整解答。\n\n### 求解推导\n\n推导从给定泊松方程的加权残差法陈述开始。设 $w$ 为任意检验函数。加权残差陈述为：\n$$ \\int_{\\Omega} w \\left[ -\\nabla \\cdot (k \\nabla u) - f \\right] d\\Omega = 0 $$\n对散度项应用分部积分（格林第一恒等式）可得：\n$$ \\int_{\\Omega} \\nabla w \\cdot (k \\nabla u) d\\Omega - \\int_{\\partial \\Omega} w (k \\nabla u \\cdot \\mathbf{n}) ds - \\int_{\\Omega} w f d\\Omega = 0 $$\n这就是问题的弱形式。对于刚度矩阵，我们关心的是涉及 $u$ 和 $w$ 的双线性形式。在有限元法中，域 $\\Omega$ 被离散为单元 $\\Omega_e$。解 $u$ 在每个单元 $e$ 内通过形函数 $N_i$ 和节点值 $d_i^{(e)}$ 近似为 $u_h^{(e)}$：\n$$ u_h^{(e)}(x,y) = \\sum_{i=1}^{n_{en}} N_i^{(e)}(x,y) d_i^{(e)} = \\mathbf{N}^{(e)} \\mathbf{d}^{(e)} $$\n其中 $n_{en}$ 是每个单元的节点数（此处 $n_{en}=3$）。在伽辽金方法中，检验函数 $w$ 从与试探（形）函数相同的空间中选取。因此，我们可以写出 $w_h = \\sum_{j=1}^{n_{en}} c_j N_j^{(e)}$，其中 $c_j$ 是任意系数。这要求弱形式对每个基函数 $N_j$ 都单独成立。一个单元对方程组的贡献由一个矩阵给出，称为单元刚度矩阵 $K^{(e)}$，其各项为：\n$$ K_{ji}^{(e)} = \\int_{\\Omega_e} k (\\nabla N_j) \\cdot (\\nabla N_i) d\\Omega $$\n近似解 $u_h^{(e)}$ 的梯度是：\n$$ \\nabla u_h^{(e)} = \\begin{pmatrix} \\frac{\\partial u_h^{(e)}}{\\partial x} \\\\ \\frac{\\partial u_h^{(e)}}{\\partial y} \\end{pmatrix} = \\sum_{i=1}^{n_{en}} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} d_i^{(e)} = \\mathbf{B}^{(e)} \\mathbf{d}^{(e)} $$\n其中矩阵 $\\mathbf{B}^{(e)}$ 定义为：\n$$ \\mathbf{B}^{(e)} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x}  \\frac{\\partial N_2}{\\partial x}  \\dots  \\frac{\\partial N_{n_{en}}}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_2}{\\partial y}  \\dots  \\frac{\\partial N_{n_{en}}}{\\partial y} \\end{pmatrix} $$\n刚度矩阵的被积函数可以用矩阵表示法写成 $k (\\nabla N_j)^T (\\nabla N_i)$。完整的矩阵变为：\n$$ K^{(e)} = \\int_{\\Omega_e} k \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} d\\Omega $$\n由于 $k$ 是一个标量常数，这等价于所要求的形式 $K^{(e)} = \\int_{\\Omega_e} \\mathbf{B}^{(e)T} k \\mathbf{B}^{(e)} d\\Omega$。\n\n对于一个3节点线性三角形单元，形函数是坐标的线性函数：$N_i(x,y) = a_i + b_i x + c_i y$。其导数为常数：$\\frac{\\partial N_i}{\\partial x} = b_i$ 和 $\\frac{\\partial N_i}{\\partial y} = c_i$。因此，矩阵 $\\mathbf{B}^{(e)}$ 在整个单元上是常数。系数 $b_i$ 和 $c_i$ 由下式给出：\n$$ b_i = \\frac{y_j - y_k}{2A_e}, \\quad c_i = \\frac{x_k - x_j}{2A_e} $$\n其中 $(i,j,k)$ 是 $(1,2,3)$ 的一个循环置换，$A_e$ 是单元的面积。$\\mathbf{B}^{(e)}$ 矩阵是：\n$$ \\mathbf{B}^{(e)} = \\frac{1}{2A_e} \\begin{pmatrix} y_2-y_3  y_3-y_1  y_1-y_2 \\\\ x_3-x_2  x_1-x_3  x_2-x_1 \\end{pmatrix} $$\n由于 $k$ 和 $\\mathbf{B}^{(e)}$ 在单元上是常数，$K^{(e)}$ 的积分简化为：\n$$ K^{(e)} = k \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} \\int_{\\Omega_e} d\\Omega = k A_e \\mathbf{B}^{(e)T} \\mathbf{B}^{(e)} $$\n\n现在，我们计算两个指定单元的刚度矩阵。\n\n**单元 $e_1$**：\n节点（局部1, 2, 3）是全局节点（1, 2, 3），坐标为：$(x_1,y_1)=(0,0)$，$(x_2,y_2)=(1,0)$，$(x_3,y_3)=(1,1)$。\n面积 $A_{e_1} = \\frac{1}{2} |x_1(y_2-y_3)+x_2(y_3-y_1)+x_3(y_1-y_2)| = \\frac{1}{2}|0(0-1)+1(1-0)+1(0-0)| = \\frac{1}{2}$。\n矩阵 $\\mathbf{B}^{(1)}$ 的分量为：\n$y_2-y_3 = 0-1 = -1$\n$y_3-y_1 = 1-0 = 1$\n$y_1-y_2 = 0-0 = 0$\n$x_3-x_2 = 1-1 = 0$\n$x_1-x_3 = 0-1 = -1$\n$x_2-x_1 = 1-0 = 1$\n由于 $2A_{e_1}=1$，矩阵 $\\mathbf{B}^{(1)}$ 为：\n$$ \\mathbf{B}^{(1)} = \\frac{1}{1} \\begin{pmatrix} -1  1  0 \\\\ 0  -1  1 \\end{pmatrix} = \\begin{pmatrix} -1  1  0 \\\\ 0  -1  1 \\end{pmatrix} $$\n单元刚度矩阵 $K^{(e_1)}$ 为：\n$$ K^{(e_1)} = k A_{e_1} \\mathbf{B}^{(1)T} \\mathbf{B}^{(1)} = k \\left(\\frac{1}{2}\\right) \\begin{pmatrix} -1  0 \\\\ 1  -1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} -1  1  0 \\\\ 0  -1  1 \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} $$\n该矩阵的行和列对应于全局节点 $\\{1, 2, 3\\}$。\n\n**单元 $e_2$**：\n局部节点（1, 2, 3）映射到全局节点（1, 3, 4）。坐标为：$(x_1,y_1)=(0,0)$ [全局 1]，$(x_2,y_2)=(1,1)$ [全局 3]，$(x_3,y_3)=(0,1)$ [全局 4]。\n面积 $A_{e_2} = \\frac{1}{2}|0(1-1)+1(1-0)+0(0-1)| = \\frac{1}{2}$。\n矩阵 $\\mathbf{B}^{(2)}$ 的分量（使用局部节点坐标）为：\n$y_2-y_3 = 1-1 = 0$\n$y_3-y_1 = 1-0 = 1$\n$y_1-y_2 = 0-1 = -1$\n$x_3-x_2 = 0-1 = -1$\n$x_1-x_3 = 0-0 = 0$\n$x_2-x_1 = 1-0 = 1$\n由于 $2A_{e_2}=1$，矩阵 $\\mathbf{B}^{(2)}$ 为：\n$$ \\mathbf{B}^{(2)} = \\frac{1}{1} \\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\end{pmatrix} $$\n单元刚度矩阵 $K^{(e_2)}$ 为：\n$$ K^{(e_2)} = k A_{e_2} \\mathbf{B}^{(2)T} \\mathbf{B}^{(2)} = k \\left(\\frac{1}{2}\\right) \\begin{pmatrix} 0  -1 \\\\ 1  0 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1  0  -1 \\\\ 0  1  -1 \\\\ -1  -1  2 \\end{pmatrix} $$\n该矩阵的行和列对应于其局部节点 $\\{1, 2, 3\\}$，它们映射到全局节点 $\\{1, 3, 4\\}$。\n\n**全局刚度矩阵的组装与 $K_{23}$ 的求解**\n全局刚度矩阵 $K$ 是一个 $4 \\times 4$ 的矩阵。一个矩阵项 $K_{IJ}$ 是所有同时包含全局节点 $I$ 和全局节点 $J$ 的单元贡献的总和。\n$$ K_{IJ} = \\sum_{e} K_{ij}^{(e)} \\quad \\text{其中局部节点 } i \\to \\text{全局 } I \\text{ 且局部节点 } j \\to \\text{全局 } J $$\n我们需要找到矩阵项 $K_{23}$。该项表示全局节点2和全局节点3之间的相互作用。\n我们检查单元连接关系：\n- 单元 $e_1$ 包含全局节点 $\\{1, 2, 3\\}$。它同时包含节点2和节点3。\n- 单元 $e_2$ 包含全局节点 $\\{1, 3, 4\\}$。它不包含节点2。\n因此，只有单元 $e_1$ 对全局刚度矩阵的 $K_{23}$ 项有贡献。\n$e_1$ 的局部编号为 $\\{1,2,3\\}$，这直接对应于全局编号 $\\{1,2,3\\}$。因此，$e_1$ 对全局 $K_{23}$ 项的贡献就是 $K^{(e_1)}_{23}$ 项。\n根据我们对 $K^{(e_1)}$ 的计算：\n$$ K^{(e_1)} = \\frac{k}{2} \\begin{pmatrix} K^{(e_1)}_{11}  K^{(e_1)}_{12}  K^{(e_1)}_{13} \\\\ K^{(e_1)}_{21}  K^{(e_1)}_{22}  K^{(e_1)}_{23} \\\\ K^{(e_1)}_{31}  K^{(e_1)}_{32}  K^{(e_1)}_{33} \\end{pmatrix} = \\frac{k}{2} \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} $$\n第2行第3列的项是 $K^{(e_1)}_{23} = \\frac{k}{2}(-1) = -\\frac{k}{2}$。\n由于没有其他单元对该项有贡献，组装后的全局刚度项为：\n$$ K_{23} = K^{(e_1)}_{23} = -\\frac{k}{2} $$\n最终答案是此项的符号表达式。", "answer": "$$\\boxed{-\\frac{k}{2}}$$", "id": "3610256"}, {"introduction": "在静态分析的基础上，我们将这些原理扩展到动力学问题，其中惯性项引入了质量矩阵的概念。这个练习探讨了理论上一致的质量矩阵与计算上高效的“集中”质量矩阵之间的权衡。通过实现这两种矩阵并计算由此产生的残值，你将对如何在加权残值框架内评估数值近似获得实践性的见解[@problem_id:3610262]。", "problem": "考虑一个长度为 $L$，横截面积为常数 $A$，质量密度为 $\\rho$，杨氏模量为 $E$ 的棱柱杆的一维小应变瞬态弹性动力学问题。设位移场为 $u(x,t)$，单位长度上施加的外部体力为 $p(x,t)$。根据牛顿第二定律和胡克定律，控制方程的强形式如下：\n$$\n\\rho A \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial}{\\partial x}\\left(E A \\, \\frac{\\partial u}{\\partial x}(x,t)\\right) = p(x,t), \\quad x \\in (0,L), \\; t > 0.\n$$\n采用试探函数 $w(x)$（其中测试空间与试探空间相等）的 Galerkin 加权残差表达式为\n$$\n\\int_0^L \\rho A \\, w(x) \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) \\, \\mathrm{d}x + \\int_0^L E A \\, \\frac{\\partial w}{\\partial x}(x) \\, \\frac{\\partial u}{\\partial x}(x,t) \\, \\mathrm{d}x - \\int_0^L w(x) \\, p(x,t) \\, \\mathrm{d}x = 0,\n$$\n对于所有容许的 $w$。使用具有 $n$ 个全局节点的有限元近似，令 $u(x,t) \\approx \\sum_{j=1}^n N_j(x) \\, d_j(t)$，其中 $N_j(x)$ 是形函数，$d_j(t)$ 是节点位移。当选择 Galerkin 试探函数 $w(x) = N_i(x)$ 时，半离散系统变为\n$$\n\\mathbf{M} \\, \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\, \\mathbf{d}(t) = \\mathbf{f}(t),\n$$\n其中一致质量矩阵和刚度矩阵的项为\n$$\nM_{ij} = \\int_0^L \\rho A \\, N_i(x) \\, N_j(x) \\, \\mathrm{d}x, \\quad K_{ij} = \\int_0^L E A \\, \\frac{\\mathrm{d}N_i}{\\mathrm{d}x}(x) \\, \\frac{\\mathrm{d}N_j}{\\mathrm{d}x}(x) \\, \\mathrm{d}x,\n$$\n力向量为 $f_i(t) = \\int_0^L N_i(x) \\, p(x,t) \\, \\mathrm{d}x$。在标准实践中，一致质量矩阵 $\\mathbf{M}$ 通过精确或足够精确的 Gaussian 求积法计算。通过将质量集成视为使用节点 Newton–Cotes 权重的非精确求积，可以得到一个集总质量矩阵 $\\mathbf{M}_\\ell$，这会产生一个对角近似：\n$$\nM_{\\ell,ii} \\approx \\rho A \\, \\sum_{e} \\left(J_e \\sum_{k \\in \\mathcal{N}_e} \\alpha_k \\, N_i(\\xi_k) \\, N_i(\\xi_k)\\right),\n$$\n其中求和遍历所有单元 $e$，$\\mathcal{N}_e$ 是单元节点，$\\xi_k$ 是参考单元上的节点坐标，$J_e = L_e/2$ 是单元雅可比行列式，$\\alpha_k$ 是参考区间上的闭合 Newton–Cotes 权重。对于两节点线性单元，使用梯形权重 $\\alpha = [1,1]$。对于三节点二次单元，使用 Simpson 权重 $\\alpha = [\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$。在这两种情况下，当被积函数 $N_i N_j$ 的多项式次数超过了求积规则的精度时，求积是不精确的，这会在 Galerkin 加权残差表达式中引入一个残差。\n\n对于给定的加速度 $\\mathbf{a}(t) = \\ddot{\\mathbf{d}}(t)$，定义其诱导的质量项残差向量为\n$$\n\\mathbf{r}(t) = \\left(\\mathbf{M} - \\mathbf{M}_\\ell\\right)\\mathbf{a}(t).\n$$\n通过无量纲的相对残差来量化非精确求积的影响\n$$\n\\eta(t) = \\frac{\\left\\|\\mathbf{r}(t)\\right\\|_2}{\\left\\|\\mathbf{M}\\,\\mathbf{a}(t)\\right\\|_2}.\n$$\n\n您的任务是编写一个程序，该程序为以下每个测试用例构建网格，使用对 $N_i N_j$ 多项式次数精确的 Gaussian 求积法组装一致质量矩阵 $\\mathbf{M}$，按照上述规定通过节点 Newton–Cotes 求积法组装集总质量矩阵 $\\mathbf{M}_\\ell$，评估一个构造的节点加速度向量 $\\mathbf{a}$，并计算 $\\eta$。所有三角函数的参数均以弧度为单位。\n\n测试套件：\n- 用例 1（线性单元，非平凡加速度）：\n    - $L = 1.0$ 米，$A = 1.0 \\times 10^{-4}$ 平方米，$\\rho = 7800$ 千克/立方米。\n    - 包含 $n_e = 4$ 个两节点线性单元的均匀网格。\n    - 构造位移 $u(x,t) = \\sin(\\pi x)\\cos(\\omega t)$，其中 $\\omega = 200$ 弧度/秒；在 $t=0$ 秒时评估。此时 $a(x,0) = \\ddot{u}(x,0) = -\\omega^2 \\sin(\\pi x)$，因此设置节点加速度 $a_i = -\\omega^2 \\sin(\\pi x_i)$。\n- 用例 2（二次单元，更高空间频率的加速度）：\n    - $L = 1.0$ 米，$A = 1.0 \\times 10^{-4}$ 平方米，$\\rho = 7800$ 千克/立方米。\n    - 包含 $n_e = 2$ 个三节点二次单元（节点位于单元端点和中点）的均匀网格。\n    - 构造位移 $u(x,t) = \\sin(2\\pi x)\\cos(\\omega t)$，其中 $\\omega = 300$ 弧度/秒；在 $t=0$ 秒时评估。此时 $a(x,0) = -\\omega^2 \\sin(2\\pi x)$，因此设置节点加速度 $a_i = -\\omega^2 \\sin(2\\pi x_i)$。\n- 用例 3（线性单元，恒定加速度边界情况）：\n    - $L = 1.0$ 米，$A = 1.0 \\times 10^{-4}$ 平方米，$\\rho = 7800$ 千克/立方米。\n    - 包含 $n_e = 3$ 个两节点线性单元的均匀网格。\n    - 恒定加速度 $a_0 = 50$ 米/平方秒；为所有 $i$ 设置节点加速度 $a_i = a_0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述用例的顺序排列结果，其中每个条目是该用例的 $\\eta$ 的浮点值。例如，输出必须具有`[eta1,eta2,eta3]`的形式。因为 $\\eta$ 是无量纲的，所以无需报告物理单位。", "solution": "用户提供了一个问题陈述，在尝试解决之前需要对其进行验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：一维瞬态弹性动力学方程为 $\\rho A \\, \\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial}{\\partial x}\\left(E A \\, \\frac{\\partial u}{\\partial x}(x,t)\\right) = p(x,t)$。\n- **离散化方法**：Galerkin 有限元法，其中 $u(x,t) \\approx \\sum_{j=1}^n N_j(x) \\, d_j(t)$，试探函数为 $w(x) = N_i(x)$。\n- **半离散系统**：$\\mathbf{M} \\, \\ddot{\\mathbf{d}}(t) + \\mathbf{K} \\, \\mathbf{d}(t) = \\mathbf{f}(t)$。\n- **一致质量矩阵**：$M_{ij} = \\int_0^L \\rho A \\, N_i(x) \\, N_j(x) \\, \\mathrm{d}x$，使用对被积函数精确的 Gaussian 求积法计算。\n- **集总质量矩阵**：一个对角矩阵 $\\mathbf{M}_\\ell$，通过单元级节点求积获得。\n  - 对于 2 节点线性单元，权重 $\\alpha = [1,1]$（梯形法则）。\n  - 对于 3 节点二次单元，权重 $\\alpha = [\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$（Simpson 法则）。\n- **残差定义**：诱导的质量项残差向量为 $\\mathbf{r}(t) = \\left(\\mathbf{M} - \\mathbf{M}_\\ell\\right)\\mathbf{a}(t)$，其中 $\\mathbf{a}(t) = \\ddot{\\mathbf{d}}(t)$。\n- **误差度量**：无量纲相对残差为 $\\eta(t) = \\frac{\\left\\|\\mathbf{r}(t)\\right\\|_2}{\\left\\|\\mathbf{M}\\,\\mathbf{a}(t)\\right\\|_2}$。\n- **测试用例**：\n  1. **用例 1**：$L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$。网格：$n_e = 4$ 个线性单元。节点加速度：$a_i = -\\omega^2 \\sin(\\pi x_i)$，其中 $\\omega = 200$，在 $t=0$ 时评估。\n  2. **用例 2**：$L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$。网格：$n_e = 2$ 个二次单元。节点加速度：$a_i = -\\omega^2 \\sin(2\\pi x_i)$，其中 $\\omega = 300$，在 $t=0$ 时评估。\n  3. **用例 3**：$L = 1.0$, $A = 10^{-4}$, $\\rho = 7800$。网格：$n_e = 3$ 个线性单元。节点加速度：所有节点的 $a_i = a_0 = 50$。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行严格的验证检查。\n- **科学基础**：该问题建立在连续介质力学、动力学和有限元法的既定原则之上。一致质量矩阵和集总质量矩阵的概念是计算动力学中的标准。使用构造解来定义加速度场是一种有效的验证技术。\n- **适定性**：该问题是适定的。所有物理参数（$L$、$A$、$\\rho$）、网格配置（$n_e$、单元类型）和加速度场都为每个用例明确定义。计算矩阵 $\\mathbf{M}$ 和 $\\mathbf{M}_\\ell$ 以及最终量 $\\eta$ 的过程是明确的，确保存在唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述。\n- **完整性与一致性**：问题是自洽的。虽然控制方程包含带有杨氏模量 $E$ 的刚度项，但 $\\eta$ 的计算仅取决于质量矩阵和加速度向量。因此，$E$ 的值不是必需的，其缺失不会使问题不完整。所提供的参数和定义彼此一致。集总质量矩阵的公式虽然以一种稍微非标准的形式表达，但通过分析表明，它正确地代表了标准的节点求积集总方案（线性单元的梯形法则，二次单元的 Simpson 法则）。\n- **平凡性/同义反复**：该问题并非平凡。它需要实现有限元组装过程，并突出了计算动力学中的一个关键概念：质量集总引入的误差。用例 3 的结果为零残差，这是对质量集总特性理解的非平凡检验，特别是对于线性单元，它保持了总质量和质量一阶矩。分母 $\\|\\mathbf{M}\\,\\mathbf{a}(t)\\|_2$ 仅在 $\\mathbf{a}(t)$ 是零向量时才为零（因为 $\\mathbf{M}$ 是正定的），这在任何测试套件中都不是这种情况。\n\n### 第 3 步：结论与行动\n问题被判定为**有效**。将提供详细的解决方案。\n\n### 解决方案\n目标是计算无量纲相对残差 $\\eta = \\|\\mathbf{r}\\|_2 / \\|\\mathbf{M}\\mathbf{a}\\|_2$，它量化了在给定节点加速度向量 $\\mathbf{a}$ 的情况下，使用集总质量矩阵 $\\mathbf{M}_\\ell$ 代替一致质量矩阵 $\\mathbf{M}$ 所引入的差异。这需要为几个有限元网格组装这两个矩阵。\n\n**1. 有限元公式与单元矩阵**\n我们考虑域 $x \\in [0, L]$ 的均匀离散化。对于长度为 $L_e$ 的单元，我们使用雅可比行列式 $J_e = L_e/2$ 将物理坐标 $x$ 映射到参考坐标 $\\xi \\in [-1, 1]$。\n\n**对于 2 节点线性单元：**\n单元一致质量矩阵由下式给出\n$$\n\\mathbf{M}^{(e)}_{cons} = \\int_{e} \\rho A \\mathbf{N}(x) \\mathbf{N}(x)^T \\mathrm{d}x = \\rho A J_e \\int_{-1}^{1} \\mathbf{N}(\\xi) \\mathbf{N}(\\xi)^T \\mathrm{d}\\xi = \\frac{\\rho A L_e}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n该积分为精确值。单元集总质量矩阵，使用梯形法则（在节点 $\\xi=[-1,1]$ 处的权重为 $\\alpha=[1,1]$），是\n$$\n\\mathbf{M}^{(e)}_{\\ell} = \\rho A J_e \\, \\text{diag}\\left(\\sum_{k=1}^2 \\alpha_k N_a(\\xi_k)^2\\right)_{a=1,2} = \\frac{\\rho A L_e}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n\n**对于 3 节点二次单元：**\n单元一致质量矩阵是\n$$\n\\mathbf{M}^{(e)}_{cons} = \\rho A J_e \\int_{-1}^{1} \\mathbf{N}(\\xi) \\mathbf{N}(\\xi)^T \\mathrm{d}\\xi = \\frac{\\rho A L_e}{30} \\begin{pmatrix} 4  2  -1 \\\\ 2  16  2 \\\\ -1  2  4 \\end{pmatrix}.\n$$\n单元集总质量矩阵，使用 Simpson 法则（在节点 $\\xi=[-1,0,1]$ 处的权重为 $\\alpha=[\\tfrac{1}{3}, \\tfrac{4}{3}, \\tfrac{1}{3}]$），是\n$$\n\\mathbf{M}^{(e)}_{\\ell} = \\rho A J_e \\, \\text{diag}\\left(\\sum_{k=1}^3 \\alpha_k N_a(\\xi_k)^2\\right)_{a=1,2,3} = \\frac{\\rho A L_e}{6} \\begin{pmatrix} 1  0  0 \\\\ 0  4  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n\n**2. 全局矩阵组装**\n全局矩阵 $\\mathbf{M}$ 和 $\\mathbf{M}_\\ell$ 通过遍历每个单元，识别其节点的全局索引，并将相应单元矩阵 $\\mathbf{M}^{(e)}_{cons}$ 和 $\\mathbf{M}^{(e)}_{\\ell}$ 的条目加到全局矩阵的适当位置来组装。\n\n**3. 节点加速度与残差计算**\n对于每个测试用例，生成一个具有坐标 $x_i$ 的节点网格。通过在这些坐标处评估指定的加速度函数来填充节点加速度向量 $\\mathbf{a}$，即 $a_i = a(x_i)$。\n定义了全局矩阵和加速度向量后，计算残差向量 $\\mathbf{r}$ 和一致质量加权力向量 $\\mathbf{f}_M = \\mathbf{M}\\mathbf{a}$。最后，计算它们的欧几里得范数（$\\| \\cdot \\|_2$）以求得 $\\eta$。\n\n**用例 3 分析**\n对于线性单元，形函数具有属性 $\\sum_j N_j(x) = 1$。当加速度恒定时，$a_i = a_0$ 对所有 $i$ 成立，因此 $\\mathbf{a} = a_0 \\mathbf{1}$，其中 $\\mathbf{1}$ 是一个全为 1 的向量。向量 $\\mathbf{M}\\mathbf{1}$ 的第 $i$ 个分量是 $\\sum_j M_{ij} = \\sum_j \\int_0^L \\rho A N_i(x) N_j(x) \\mathrm{d}x = \\int_0^L \\rho A N_i(x) \\left(\\sum_j N_j(x)\\right) \\mathrm{d}x = \\int_0^L \\rho A N_i(x) \\mathrm{d}x$。此操作称为行和集总。对于线性单元，行和集总与梯形法则规定的集总方案相同。因此，$\\mathbf{M}\\mathbf{1} = \\mathbf{M}_\\ell\\mathbf{1}$。由此得出，对于常数加速度向量 $\\mathbf{a}=a_0 \\mathbf{1}$，残差向量 $\\mathbf{r} = (\\mathbf{M} - \\mathbf{M}_\\ell)\\mathbf{a} = a_0(\\mathbf{M}\\mathbf{1} - \\mathbf{M}_\\ell\\mathbf{1}) = \\mathbf{0}$。因此，相对残差 $\\eta$ 必须精确为 $0$。\n\n以下程序为每个测试用例实现了此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the relative residual for three test cases.\n    \"\"\"\n\n    # Define test cases as per the problem description\n    test_cases = [\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 4, \"elem_type\": \"linear\",\n            \"accel_func\": lambda x, omega=200.0: -omega**2 * np.sin(np.pi * x)\n        },\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 2, \"elem_type\": \"quadratic\",\n            \"accel_func\": lambda x, omega=300.0: -omega**2 * np.sin(2.0 * np.pi * x)\n        },\n        {\n            \"L\": 1.0, \"A\": 1.0e-4, \"rho\": 7800,\n            \"n_e\": 3, \"elem_type\": \"linear\",\n            \"accel_func\": lambda x, a0=50.0: a0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        L, A, rho = params[\"L\"], params[\"A\"], params[\"rho\"]\n        n_e, elem_type = params[\"n_e\"], params[\"elem_type\"]\n        accel_func = params[\"accel_func\"]\n\n        # 1. Generate mesh and nodal information\n        if elem_type == \"linear\":\n            num_nodes = n_e + 1\n            nodes_per_elem = 2\n        elif elem_type == \"quadratic\":\n            num_nodes = 2 * n_e + 1\n            nodes_per_elem = 3\n        else:\n            raise ValueError(\"Unsupported element type\")\n            \n        node_coords = np.linspace(0, L, num_nodes)\n        elem_len = L / n_e\n\n        # 2. Define element mass matrices\n        if elem_type == \"linear\":\n            # Consistent mass matrix for a 2-node linear bar element\n            Me_cons = (rho * A * elem_len / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n            # Lumped mass matrix (using Trapezoidal rule)\n            Me_lump = (rho * A * elem_len / 2.0) * np.identity(nodes_per_elem)\n        \n        elif elem_type == \"quadratic\":\n            # Consistent mass matrix for a 3-node quadratic bar element\n            Me_cons = (rho * A * elem_len / 30.0) * np.array([[4.0, 2.0, -1.0], [2.0, 16.0, 2.0], [-1.0, 2.0, 4.0]])\n            # Lumped mass matrix (using Simpson's rule)\n            Me_lump = (rho * A * elem_len / 6.0) * np.diag([1.0, 4.0, 1.0])\n            \n        # 3. Assemble global matrices\n        M_cons = np.zeros((num_nodes, num_nodes))\n        M_lump = np.zeros((num_nodes, num_nodes))\n        \n        for e in range(n_e):\n            if elem_type == \"linear\":\n                # Element e connects global nodes e and e+1\n                indices = [e, e + 1]\n            else: # quadratic\n                # Element e connects global nodes 2e, 2e+1, and 2e+2\n                indices = [2 * e, 2 * e + 1, 2 * e + 2]\n            \n            # Use np.ix_ to facilitate adding element matrix to global matrix\n            ix = np.ix_(indices, indices)\n            M_cons[ix] += Me_cons\n            \n            # Assemble diagonal lumped mass matrix\n            for i_local, i_global in enumerate(indices):\n                M_lump[i_global, i_global] += Me_lump[i_local, i_local]\n\n        # 4. Construct nodal acceleration vector\n        a_vals = accel_func(node_coords)\n        if np.isscalar(a_vals):\n            # Handle constant acceleration case\n            a = np.full(num_nodes, a_vals, dtype=float)\n        else:\n            a = a_vals\n            \n        # 5. Compute residual, norms, and the relative residual eta\n        r = (M_cons - M_lump) @ a\n        fM = M_cons @ a\n\n        norm_r = np.linalg.norm(r)\n        norm_fM = np.linalg.norm(fM)\n        \n        # The ratio is 0 if the numerator is 0. norm_fM is non-zero\n        # for non-zero acceleration, as M_cons is positive definite.\n        eta = norm_r / norm_fM if norm_fM != 0 else 0.0\n        results.append(eta)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3610262"}, {"introduction": "加权残值法的实际应用涉及数值积分，而在此处做出的选择可能会产生深远的影响。这个高级练习通过将“沙漏”不稳定性（一种由减缩积分引起的数值伪影）视为产生零残值的非平凡位移模式，对其进行了研究。你将学习如何通过识别这些零残值方向，并添加一个经校准以恢复正确物理能量响应的修正项，来设计一种稳定化方案[@problem_id:3610216]。", "problem": "考虑一个小应变、线性、各向同性、平面应变弹性力学问题中，有限元 (FE) 法的单个双线性四边形单元 ($\\mathrm{Q4}$)。母单元坐标为 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$，且该单元映射到一个边长为 $L$ 的正方形，其雅可比行列式为常数 $\\det J = L^{2}/4$。设双线性形函数为 $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$，$N_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$，$N_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$ 和 $N_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$。取拉梅 (Lamé) 参数为 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $G = \\frac{E}{2(1+\\nu)}$，其中 $E$ 为杨氏模量 (Young’s modulus)，$\\nu$ 为泊松比 (Poisson ratio)。在标准的伽辽金 (Galerkin) 加权残差法中，线性动量平衡的弱形式为 $\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\boldsymbol{v} \\cdot \\boldsymbol{b} \\, \\mathrm{d}\\Omega + \\int_{\\Gamma_{t}} \\boldsymbol{v} \\cdot \\boldsymbol{t} \\, \\mathrm{d}\\Gamma$，其中 $\\boldsymbol{u}$ 是位移场，$\\boldsymbol{v}$ 是检验函数，$\\boldsymbol{\\varepsilon}(\\cdot)$ 是小应变算子，$\\mathbb{C}$ 是由 $\\lambda$ 和 $G$ 表征的平面应变弹性张量，$\\boldsymbol{b}$ 是体力，$\\boldsymbol{t}$ 是面力。使用在 $(\\xi,\\eta)=(0,0)$ 处的单点高斯 (Gauss) 积分（缩减积分），内残差和刚度仅在单元中心进行计算。这种缩减积分会产生非平凡的零残差方向（沙漏模式），这些模式在中心点产生零应变，因此内虚功为零，从而导致秩亏。\n\n关注以下典型沙漏模式：节点位移仅在 $x$ 方向有非零分量，即 $(u_{1x},u_{2x},u_{3x},u_{4x}) = (a,-a,a,-a)$ 和 $(u_{1y},u_{2y},u_{3y},u_{4y}) = (0,0,0,0)$，其中 $a$ 是一个实数振幅。该位移模式引起的应变 $\\varepsilon_{xx}$ 和 $\\varepsilon_{xy}$ 在 $(\\xi,\\eta)=(0,0)$ 处为零，因此用单点高斯积分计算的伽辽金残差沿此方向为零。\n\n你将构建一种基于残差的稳定化方法，通过添加一个限制在沙漏零残差子空间内的项来恢复秩，同时避免过度刚化。令 $e(\\xi,\\eta)$ 表示 Voigt 记法下的应变矢量，其第三个分量取为张量剪切应变的两倍，即 $e = [\\varepsilon_{xx}, \\varepsilon_{yy}, 2 \\varepsilon_{xy}]^{\\mathsf{T}}$，因此应力矢量 $s = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^{\\mathsf{T}}$ 满足 $s = \\mathbf{D} \\, e$，其中平面应变弹性矩阵为\n$$\n\\mathbf{D} = \\begin{bmatrix}\n\\lambda + 2 G  \\lambda  0 \\\\\n\\lambda  \\lambda + 2 G  0 \\\\\n0  0  G\n\\end{bmatrix}.\n$$\n定义限制在沙漏子空间内的稳定化能量泛函为\n$$\nU_{\\mathrm{stab}}(u_{h}) = \\frac{1}{2} \\, \\alpha \\sum_{q=1}^{4} e_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) \\, \\det J,\n$$\n其中 $(\\xi_{q},\\eta_{q})$ 是 $2 \\times 2$ 法则的四个高斯点，$\\det J = L^{2}/4$，$e_{h}$ 是由沙漏位移 $u_{h}$ 引起的应变（假设投影到沙漏零残差子空间上的投影算子是精确的，因此在该子空间之外没有稳定化作用），$\\alpha$ 是一个待确定的无量纲稳定化系数。\n\n从伽辽金弱形式和双线性形函数出发，并使用加权残差的观点，执行以下步骤：\n\n- 证明所选的 $u_{h}$ 在单点高斯积分下是一个零残差方向，即证明 $e_{h}(0,0) = \\boldsymbol{0}$，因此在中心点计算的内虚功为零。\n- 使用完全的 $2 \\times 2$ 高斯积分计算此沙漏模式的精确伽辽金应变能 $U_{\\mathrm{full}}(u_{h})$，结果用 $a$、$\\lambda$ 和 $G$ 表示。\n- 施加恢复秩且不引起过度刚化的校准条件 $U_{\\mathrm{stab}}(u_{h}) = U_{\\mathrm{full}}(u_{h})$，并求解稳定化系数 $\\alpha$。\n\n你的最终答案必须是 $\\alpha$ 的单个实数或封闭形式表达式。无需四舍五入，$\\alpha$ 无需单位。", "solution": "问题陈述经过严格验证，被认为是自洽、科学上合理且适定的。它代表了计算固体力学领域中关于缩减积分有限元沙漏稳定化的一个标准问题。所有必要的数据和定义均已提供。\n\n解答过程按问题陈述要求分三步进行。首先，我们将推导给定沙漏位移模式的应变场，并验证其在单元中心为零。其次，我们将使用完全积分计算此模式的精确应变能。第三，我们将评估稳定化能量泛函，并使用校准条件来确定稳定化系数 $\\alpha$。\n\n步骤 1：沙漏模式的应变场及零残差方向的验证。\n\n单元内的位移场 $\\boldsymbol{u}(\\xi, \\eta)$ 通过双线性形函数 $N_i(\\xi, \\eta)$ 从节点位移插值得到：\n$$\n\\boldsymbol{u}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\boldsymbol{u}_i\n$$\n问题指定了一种特定的沙漏模式，我们将其表示为 $\\boldsymbol{u}_h$。该模式的节点位移由 $(u_{1x}, u_{2x}, u_{3x}, u_{4x}) = (a, -a, a, -a)$ 和 $(u_{1y}, u_{2y}, u_{3y}, u_{4y}) = (0, 0, 0, 0)$ 给出。\n\n位移场的 $x$ 分量为：\n$$\nu_x(\\xi, \\eta) = N_1(\\xi, \\eta) a + N_2(\\xi, \\eta) (-a) + N_3(\\xi, \\eta) a + N_4(\\xi, \\eta) (-a)\n$$\n代入形函数：\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\xi)(1-\\eta) - (1+\\xi)(1-\\eta) + (1+\\xi)(1+\\eta) - (1-\\xi)(1+\\eta) ]\n$$\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\eta)(1-\\xi-1-\\xi) + (1+\\eta)(1+\\xi-1+\\xi) ]\n$$\n$$\nu_x(\\xi, \\eta) = \\frac{a}{4} [ (1-\\eta)(-2\\xi) + (1+\\eta)(2\\xi) ] = \\frac{a}{4} [-2\\xi + 2\\xi\\eta + 2\\xi + 2\\xi\\eta] = \\frac{a}{4} [4\\xi\\eta] = a\\xi\\eta\n$$\n位移场的 $y$ 分量为 $u_y(\\xi, \\eta) = 0$。因此，沙漏位移场为 $\\boldsymbol{u}_h(\\xi, \\eta) = [a\\xi\\eta, 0]^{\\mathsf{T}}$。\n\n为了计算应变，我们需要从母单元坐标 $(\\xi, \\eta)$到物理坐标 $(x, y)$ 的映射。对于一个边长为 $L$、雅可比行列式为常数 $\\det \\mathbf{J} = L^2/4$ 的正方形单元，一个合适的映射是 $x = \\frac{L}{2}\\xi$ 和 $y = \\frac{L}{2}\\eta$。该映射的雅可比矩阵为：\n$$\n\\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} L/2  0 \\\\ 0  L/2 \\end{bmatrix}\n$$\n其逆矩阵为 $\\mathbf{J}^{-1} = \\begin{bmatrix} 2/L  0 \\\\ 0  2/L \\end{bmatrix}$。梯度算子变换如下：$\\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix}$。因此，$\\frac{\\partial}{\\partial x} = \\frac{2}{L}\\frac{\\partial}{\\partial \\xi}$ 且 $\\frac{\\partial}{\\partial y} = \\frac{2}{L}\\frac{\\partial}{\\partial \\eta}$。\n\n小应变张量的分量为：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{2}{L} \\frac{\\partial}{\\partial \\xi}(a\\xi\\eta) = \\frac{2a}{L}\\eta\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{2}{L} \\frac{\\partial}{\\partial \\eta}(0) = 0\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}\\left(\\frac{2}{L}\\frac{\\partial}{\\partial \\eta}(a\\xi\\eta) + 0\\right) = \\frac{a}{L}\\xi\n$$\n在指定的 Voigt 记法中，应变矢量 $e_h = [\\varepsilon_{xx}, \\varepsilon_{yy}, 2\\varepsilon_{xy}]^{\\mathsf{T}}$ 为：\n$$\ne_h(\\xi, \\eta) = \\left[ \\frac{2a}{L}\\eta, \\, 0, \\, \\frac{2a}{L}\\xi \\right]^{\\mathsf{T}}\n$$\n在单元中心 $(\\xi, \\eta) = (0, 0)$ 处计算应变矢量：\n$$\ne_h(0, 0) = \\left[ \\frac{2a}{L}(0), \\, 0, \\, \\frac{2a}{L}(0) \\right]^{\\mathsf{T}} = [0, 0, 0]^{\\mathsf{T}} = \\boldsymbol{0}\n$$\n由于应变在中心点为零，使用单点高斯积分计算的内虚功（其仅依赖于中心点的值）为零。这证实了 $\\boldsymbol{u}_h$ 是该缩减积分单元的一个零残差方向（一个沙漏模式）。\n\n步骤 2：精确伽辽金应变能 $U_{\\mathrm{full}}(u_h)$ 的计算。\n\n总应变能由 $U = \\frac{1}{2} \\int_{\\Omega} e^{\\mathsf{T}} \\mathbf{D} e \\, d\\Omega$ 给出。面积微元为 $d\\Omega = \\det \\mathbf{J} \\, d\\xi \\, d\\eta = \\frac{L^2}{4} d\\xi \\, d\\eta$。\n首先，我们计算应变能密度项 $e_h^{\\mathsf{T}} \\mathbf{D} e_h$：\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\begin{bmatrix} \\frac{2a}{L}\\eta  0  \\frac{2a}{L}\\xi \\end{bmatrix} \\begin{bmatrix} \\lambda + 2 G  \\lambda  0 \\\\ \\lambda  \\lambda + 2 G  0 \\\\ 0  0  G \\end{bmatrix} \\begin{bmatrix} \\frac{2a}{L}\\eta \\\\ 0 \\\\ \\frac{2a}{L}\\xi \\end{bmatrix}\n$$\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\begin{bmatrix} \\frac{2a}{L}\\eta  0  \\frac{2a}{L}\\xi \\end{bmatrix} \\begin{bmatrix} (\\lambda + 2G)\\frac{2a}{L}\\eta \\\\ \\lambda\\frac{2a}{L}\\eta \\\\ G\\frac{2a}{L}\\xi \\end{bmatrix} = (\\lambda + 2G)\\left(\\frac{2a}{L}\\eta\\right)^2 + G\\left(\\frac{2a}{L}\\xi\\right)^2\n$$\n$$\ne_h^{\\mathsf{T}} \\mathbf{D} e_h = \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right]\n$$\n现在，我们将此密度在单元域上积分以求得总能量 $U_{\\mathrm{full}}(u_h)$。问题要求使用完全的 $2 \\times 2$ 高斯积分计算能量。由于被积函数是关于 $\\xi$ 和 $\\eta$ 的二次函数，这等同于在母单元域 $[-1,1] \\times [-1,1]$ 上进行精确的解析积分。\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{1}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right] \\right) \\left( \\frac{L^2}{4} \\right) d\\xi \\, d\\eta\n$$\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{a^2}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left[ (\\lambda + 2G)\\eta^2 + G\\xi^2 \\right] d\\xi \\, d\\eta\n$$\n我们计算积分：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\eta^2 d\\xi \\, d\\eta = \\int_{-1}^{1} d\\xi \\int_{-1}^{1} \\eta^2 d\\eta = [\\xi]_{-1}^{1} \\left[\\frac{\\eta^3}{3}\\right]_{-1}^{1} = (2)\\left(\\frac{1}{3} - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{4}{3}\n$$\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\xi^2 d\\xi \\, d\\eta = \\int_{-1}^{1} d\\eta \\int_{-1}^{1} \\xi^2 d\\xi = [\\eta]_{-1}^{1} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = (2)\\left(\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将这些结果代回能量表达式：\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{a^2}{2} \\left[ (\\lambda + 2G)\\frac{4}{3} + G\\frac{4}{3} \\right] = \\frac{a^2}{2} \\frac{4}{3} (\\lambda + 2G + G)\n$$\n$$\nU_{\\mathrm{full}}(u_h) = \\frac{2}{3} a^2 (\\lambda + 3G)\n$$\n\n步骤 3：稳定化系数 $\\alpha$ 的确定。\n\n稳定化能量泛函定义为：\n$$\nU_{\\mathrm{stab}}(u_{h}) = \\frac{1}{2} \\, \\alpha \\sum_{q=1}^{4} e_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) \\, \\det J\n$$\n求和是在 $2 \\times 2$ 法则的四个高斯点上进行的，这些点是 $(\\xi_q, \\eta_q) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。在每个点上，都有 $\\xi_q^2 = 1/3$ 和 $\\eta_q^2 = 1/3$。\n我们计算在任意高斯点 $q$ 处的被加项：\n$$\ne_{h}(\\xi_{q},\\eta_{q})^{\\mathsf{T}} \\, \\mathbf{D} \\, e_{h}(\\xi_{q},\\eta_{q}) = \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\eta_q^2 + G\\xi_q^2 \\right]\n$$\n$$\n= \\frac{4a^2}{L^2} \\left[ (\\lambda + 2G)\\frac{1}{3} + G\\frac{1}{3} \\right] = \\frac{4a^2}{3L^2} (\\lambda + 3G)\n$$\n对于所有四个高斯点，该值是恒定的。求和号内的项是这个量乘以 $\\det J = L^2/4$：\n$$\n\\text{Summand} = \\left( \\frac{4a^2}{3L^2} (\\lambda + 3G) \\right) \\left( \\frac{L^2}{4} \\right) = \\frac{a^2}{3} (\\lambda + 3G)\n$$\n该和是四个相同项的和：\n$$\n\\sum_{q=1}^{4} (\\dots) = 4 \\times \\frac{a^2}{3} (\\lambda + 3G)\n$$\n现在我们计算稳定化能量：\n$$\nU_{\\mathrm{stab}}(u_h) = \\frac{1}{2} \\alpha \\left( \\frac{4a^2}{3} (\\lambda + 3G) \\right) = \\frac{2}{3} \\alpha a^2 (\\lambda + 3G)\n$$\n校准条件为 $U_{\\mathrm{stab}}(u_h) = U_{\\mathrm{full}}(u_h)$。\n$$\n\\frac{2}{3} \\alpha a^2 (\\lambda + 3G) = \\frac{2}{3} a^2 (\\lambda + 3G)\n$$\n假设沙漏振幅非平凡 ($a \\neq 0$) 且材料物理上现实 ($\\lambda > 0$, $G > 0$, 因此 $\\lambda + 3G \\neq 0$)，我们可以消去两边的公因子，得到：\n$$\n\\alpha = 1\n$$\n稳定化参数 $\\alpha$ 是一个无量纲的值 $1$。这个结果表明，所选形式的稳定化能量，在校准以匹配沙漏模式的精确能量时，恰好是应变场高阶部分的贡献，这部分能量能被 $2 \\times 2$ 高斯求积正确捕捉，但会被单点法则漏掉。", "answer": "$$\\boxed{1}$$", "id": "3610216"}]}