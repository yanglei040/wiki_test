{"hands_on_practices": [{"introduction": "我们为什么需要弱形式？它仅仅是求解偏微分方程的一种数学技巧，还是有着更深刻的物理和数学内涵？本练习将通过一个经典的反例来回答这个问题。我们将探讨在一个带有重入角的L形域上，即使一个“强解”（即在每个点都满足偏微分方程的光滑解）由于角点奇异性的存在而无法找到，一个有物理意义的“弱解”依然存在且唯一。这个练习[@problem_id:3604122]将加深你对弱形式理论重要性的理解，并揭示其在处理非光滑解问题时的强大能力。", "problem": "考虑二维小应变线性弹性力学中的反平面剪切模型。设 $\\Omega \\subset \\mathbb{R}^{2}$ 为L形区域 $\\Omega = (-1,1)^{2} \\setminus \\left([0,1] \\times [-1,0]\\right)$，其在原点处有一个内角为 $\\omega = \\frac{3\\pi}{2}$ 的凹角。平面外位移 $u:\\Omega \\to \\mathbb{R}$ 满足静态线性动量平衡方程 $-\\nabla \\cdot \\boldsymbol{\\sigma} = b$ 和本构关系 $\\boldsymbol{\\sigma} = \\mu \\nabla u$，其中 $\\mu  0$ 是剪切模量，$b$ 是常数体积力密度。假设 $\\mu = 1$ 且 $b \\equiv 1$。本质（Dirichlet）边界 $\\Gamma_{D} = \\partial \\Omega$ 上给定 $u = 0$。\n\n1. 从线性动量平衡和本构关系出发，构建在 $\\Omega$ 上的强形式边值问题以及在 Sobolev 空间 $H^{1}_{0}(\\Omega)$ 上的弱（变分）形式，并精确定义所有符号。明确说明试探函数和检验函数的函数空间。\n2. 引用 Lax–Milgram 定理（陈述有界性和矫顽性条件），证明该弱形式在 $H^{1}_{0}(\\Omega)$ 中存在唯一解。\n3. 分析解在凹角附近的局部行为。仅使用偏微分方程（PDE）的基本原理和以凹角为中心的极坐标 $(r,\\theta)$ 下拉普拉斯算子的标准性质，构造一个反例，说明由于角点奇异性，即使弱解 $u \\in H^{1}(\\Omega)$ 是良定的，强解 $u \\in H^{2}(\\Omega)$ 也未必存在。\n4. 确定解在凹角附近的主阶奇异项 $u_{s}(r,\\theta)$，并用关于原点的极坐标表示。你的推导必须从偏微分方程和构成凹角的射线上的边界条件出发，并确定奇异指数。通过估计二阶导数的可积性，严格论证并得出 $u \\in H^{2}(\\Omega)$ 是否成立的结论。\n5. 讨论这种奇异行为对在弱形式和数值近似中施加本质边界条件 $\\Gamma_{D}$ 的影响，包括 $H^{1}(\\Omega)$ 函数的迹的概念以及如何施加 $u=0$ on $\\Gamma_{D}$。\n\n你的最终答案应为凹角附近主奇异项 $u_{s}(r,\\theta)$ 的符号表达式。无需数值取整。最终答案仅用 $r$ 和 $\\theta$ 表示。", "solution": "所述问题具有科学依据，是良定的、客观的、完整的且一致的。它是偏微分方程理论和计算力学中的一个标准且重要的问题，用于阐释在存在区域奇异性时弱解和正则性理论的概念。该问题是有效的。\n\n### 1. 强形式和弱形式边值问题的构建\n\n该问题由静态线性动量平衡和线性弹性本构关系控制。\n\n**强形式：**\n线性动量平衡方程由下式给出：\n$$-\\nabla \\cdot \\boldsymbol{\\sigma} = b$$\n反平面剪切的本构关系为：\n$$\\boldsymbol{\\sigma} = \\mu \\nabla u$$\n其中 $u$ 是平面外位移，$\\boldsymbol{\\sigma}$ 是应力向量（在此二维背景下，如果平面是 $xy$ 平面且位移在 $z$ 方向，则 $\\boldsymbol{\\sigma}$ 是分量为 $(\\sigma_{zx}, \\sigma_{zy})$ 的向量），$\\mu$ 是剪切模量，$b$ 是体积力密度。\n\n将本构关系代入平衡方程得到：\n$$-\\nabla \\cdot (\\mu \\nabla u) = b$$\n鉴于 $\\mu$ 是一个正常数，上式简化为：\n$$-\\mu \\nabla \\cdot (\\nabla u) = b$$\n$$-\\mu \\Delta u = b$$\n其中 $\\Delta u = \\nabla \\cdot \\nabla u$ 是 $u$ 的拉普拉斯算子。\n\n问题指定了区域 $\\Omega = (-1,1)^{2} \\setminus ([0,1] \\times [-1,0])$，剪切模量 $\\mu=1$，以及常数体积力密度 $b=1$。在整个边界 $\\Gamma_D = \\partial \\Omega$ 上，位移被指定为零。\n因此，该边值问题的强形式是寻找一个足够光滑的函数 $u$（例如，$u \\in C^{2}(\\Omega) \\cap C^{0}(\\bar{\\Omega})$），满足：\n$$\n\\begin{cases}\n-\\Delta u = 1  \\text{in } \\Omega \\\\\nu = 0  \\text{on } \\partial \\Omega\n\\end{cases}\n$$\n\n**弱（变分）形式：**\n为了推导弱形式，我们从强形式出发，乘以一个任意的检验函数 $v$，并在区域 $\\Omega$ 上积分。检验函数 $v$ 必须从一个合适的函数空间中选取。由于边界条件 $u=0$ 是本质（Dirichlet）条件，我们要求试探函数 $u$ 和检验函数 $v$ 属于一个满足该条件的空间。合适的空间是 Sobolev 空间 $H^{1}_{0}(\\Omega)$。\n\n空间 $H^{1}(\\Omega)$ 是 $L^{2}(\\Omega)$ 中一阶弱导数也在 $L^{2}(\\Omega)$ 中的函数构成的空间。空间 $H^{1}_{0}(\\Omega)$ 是 $H^{1}(\\Omega)$ 中迹（广义边界值）在 $\\partial\\Omega$ 上为零的函数构成的子集。形式上，$H^{1}_{0}(\\Omega)$ 是 $C^{\\infty}_{0}(\\Omega)$（在 $\\Omega$ 中具有紧支集的无限可微函数）在 $H^{1}$ 范数下的闭包。\n\n设 $u \\in H^{1}_{0}(\\Omega)$ 为试探解，$v \\in H^{1}_{0}(\\Omega)$ 为检验函数。\n将偏微分方程乘以 $v$ 并积分：\n$$ \\int_{\\Omega} (-\\Delta u) v \\, d\\Omega = \\int_{\\Omega} 1 \\cdot v \\, d\\Omega $$\n我们对左侧应用格林第一恒等式（多维分部积分）：\n$$ \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega - \\int_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) v \\, dS = \\int_{\\Omega} v \\, d\\Omega $$\n这里，$\\mathbf{n}$ 是边界 $\\partial\\Omega$ 的单位外法向量。由于检验函数 $v$ 属于 $H^{1}_{0}(\\Omega)$，其在边界上的迹为零，即在 $\\partial\\Omega$ 上 $v=0$。因此，边界积分为零：\n$$ \\int_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) v \\, dS = 0 $$\n得到的方程即为问题的弱形式：寻找 $u \\in H^{1}_{0}(\\Omega)$ 使得\n$$ \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega = \\int_{\\Omega} v \\, d\\Omega \\quad \\forall v \\in H^{1}_{0}(\\Omega) $$\n为了将其形式化以便应用 Lax-Milgram 定理，我们定义一个双线性形式 $a(u,v)$ 和一个线性泛函 $L(v)$：\n-   双线性形式：$a(u,v) := \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega$\n-   线性泛函：$L(v) := \\int_{\\Omega} v \\, d\\Omega$\n\n于是弱问题为：寻找 $u \\in V$ 使得对所有 $v \\in V$ 都有 $a(u,v) = L(v)$，其中试探函数和检验函数的函数空间均为 $V = H^{1}_{0}(\\Omega)$。\n\n### 2. 通过 Lax-Milgram 定理证明存在性和唯一性\n\nLax–Milgram 定理指出，如果 $V$ 是一个希尔伯特空间，$a(\\cdot,\\cdot): V \\times V \\to \\mathbb{R}$ 是一个有界且矫顽的双线性形式，并且 $L(\\cdot): V \\to \\mathbb{R}$ 是一个有界的线性泛函，那么问题 $a(u,v) = L(v)$ 对所有 $v \\in V$ 存在唯一的解 $u \\in V$。\n\n我们对 $V = H^{1}_{0}(\\Omega)$ 的问题验证这些条件。$H^{1}(\\Omega)$ 上的内积为 $\\langle u,v \\rangle_{H^1} = \\int_\\Omega (uv + \\nabla u \\cdot \\nabla v) d\\Omega$，范数为 $\\|v\\|_{H^1} = \\sqrt{\\langle v,v \\rangle_{H^1}}$。\n\n**a) 线性泛函 $L(v)$ 的有界性：**\n$$ |L(v)| = \\left| \\int_{\\Omega} v \\, d\\Omega \\right| = \\left| \\int_{\\Omega} 1 \\cdot v \\, d\\Omega \\right| $$\n根据 $L^{2}(\\Omega)$ 中的柯西-施瓦茨不等式：\n$$ |L(v)| \\le \\left(\\int_{\\Omega} 1^{2} \\, d\\Omega \\right)^{1/2} \\left(\\int_{\\Omega} v^{2} \\, d\\Omega \\right)^{1/2} = \\sqrt{\\text{Area}(\\Omega)} \\|v\\|_{L^2} $$\nL形区域的面积为 $3$。所以，$|L(v)| \\le \\sqrt{3} \\|v\\|_{L^2}$。由于 $\\|v\\|_{L^2} \\le \\|v\\|_{H^1}$，我们有\n$$ |L(v)| \\le \\sqrt{3} \\|v\\|_{H^1} $$\n因此，$L$ 是 $H^{1}_{0}(\\Omega)$ 上的有界线性泛函。\n\n**b) 双线性形式 $a(u,v)$ 的有界性：**\n$$ |a(u,v)| = \\left| \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega \\right| $$\n根据 $\\mathbb{R}^2$ 中向量的柯西-施瓦茨不等式，然后是 $L^{2}(\\Omega)$ 中函数的柯西-施瓦茨不等式：\n$$ |a(u,v)| \\le \\int_{\\Omega} |\\nabla u| |\\nabla v| \\, d\\Omega \\le \\|\\nabla u\\|_{L^2} \\|\\nabla v\\|_{L^2} $$\n梯度的 $L^2$ 范数是 $H^1$ 范数的一部分：$\\|\\nabla v\\|_{L^2} \\le \\|v\\|_{H^1}$。因此，\n$$ |a(u,v)| \\le \\|u\\|_{H^1} \\|v\\|_{H^1} $$\n这表明 $a(u,v)$ 是有界的，有界性常数为 $M=1$。\n\n**c) 双线性形式 $a(u,v)$ 的矫顽性（或 $V$-椭圆性）：**\n我们需要证明存在一个常数 $\\alpha  0$ 使得对所有 $v \\in V$ 都有 $a(v,v) \\ge \\alpha \\|v\\|_{H^1}^{2}$。对于 $v \\in H^{1}_{0}(\\Omega)$，我们有：\n$$ a(v,v) = \\int_{\\Omega} \\nabla v \\cdot \\nabla v \\, d\\Omega = \\|\\nabla v\\|_{L^2}^{2} $$\n对于像 $\\Omega$ 這樣的有界域，庞加莱不等式成立：对任意 $v \\in H^{1}_{0}(\\Omega)$，存在一个常数 $C_P  0$（仅依赖于 $\\Omega$）使得 $\\|v\\|_{L^2} \\le C_P \\|\\nabla v\\|_{L^2}$。\n$H^1$ 范数为 $\\|v\\|_{H^1}^{2} = \\|v\\|_{L^2}^{2} + \\|\\nabla v\\|_{L^2}^{2}$。使用庞加莱不等式：\n$$ \\|v\\|_{H^1}^{2} \\le C_P^{2} \\|\\nabla v\\|_{L^2}^{2} + \\|\\nabla v\\|_{L^2}^{2} = (C_P^{2} + 1) \\|\\nabla v\\|_{L^2}^{2} $$\n重新整理可得：\n$$ \\|\\nabla v\\|_{L^2}^{2} \\ge \\frac{1}{C_P^{2} + 1} \\|v\\|_{H^1}^{2} $$\n因此，\n$$ a(v,v) \\ge \\alpha \\|v\\|_{H^1}^{2} \\quad \\text{with} \\quad \\alpha = \\frac{1}{C_P^{2} + 1}  0 $$\n双线性形式 $a(u,v)$ 在 $H^{1}_{0}(\\Omega)$ 上是矫顽的。\n\n由于 Lax-Milgram 定理的所有条件都已满足，该问题存在唯一的弱解 $u \\in H^{1}_{0}(\\Omega)$。\n\n### 3.  4. 角点奇异性分析及 $H^{2}(\\Omega)$ 中强解的不存在性\n\n$H^2(\\Omega)$ 中强解 $u$ 的存在性取决于区域和数据的正则性。虽然数据 $b=1$ 是光滑的，但L形区域 $\\Omega$ 不是凸的，并且有一个凹角，这阻止了解属于 $H^2(\\Omega)$。\n\n为了分析局部行为，我们关注原点凹角附近的齐次拉普拉斯方程 $\\Delta u = 0$。局部奇异性由偏微分方程的齐次部分决定。我们使用极坐标 $(r,\\theta)$，其中角点位于 $r=0$。该区域局部对应于楔形域 $0  r  \\epsilon$ 和 $0  \\theta  \\omega = \\frac{3\\pi}{2}$。相邻边上的边界条件为当 $\\theta=0$ 和 $\\theta=\\omega$ 时 $u=0$。\n\n我们使用分离变量法，寻找形式为 $u(r,\\theta) = r^{\\lambda} \\phi(\\theta)$ 的非平凡解。将其代入极坐标下的拉普拉斯方程 $\\Delta u = u_{rr} + \\frac{1}{r} u_r + \\frac{1}{r^2} u_{\\theta\\theta} = 0$ 中，得到：\n$$ \\lambda(\\lambda-1) r^{\\lambda-2} \\phi(\\theta) + \\frac{1}{r} \\lambda r^{\\lambda-1} \\phi(\\theta) + \\frac{1}{r^2} r^{\\lambda} \\phi''(\\theta) = 0 $$\n$$ r^{\\lambda-2} [\\lambda^2 \\phi(\\theta) + \\phi''(\\theta)] = 0 $$\n这简化为常微分方程：\n$$ \\phi''(\\theta) + \\lambda^2 \\phi(\\theta) = 0 $$\n通解为 $\\phi(\\theta) = A \\cos(\\lambda\\theta) + B \\sin(\\lambda\\theta)$。\n边界条件 $u(r,0)=0$ 和 $u(r,\\omega)=0$ 转化为 $\\phi(0)=0$ 和 $\\phi(\\omega)=0$。\n-   $\\phi(0) = A \\cos(0) + B \\sin(0) = A = 0$。\n-   所以，$\\phi(\\theta) = B \\sin(\\lambda\\theta)$。\n-   $\\phi(\\omega) = B \\sin(\\lambda\\omega) = 0$。\n为了得到非平凡解（$B \\neq 0$），必须有 $\\sin(\\lambda\\omega) = 0$，这意味着对于某个整数 $k \\ge 1$，有 $\\lambda\\omega = k\\pi$。\n$$ \\lambda_k = \\frac{k\\pi}{\\omega} $$\n对于给定区域，$\\omega = \\frac{3\\pi}{2}$。指数为：\n$$ \\lambda_k = \\frac{k\\pi}{3\\pi/2} = \\frac{2k}{3}, \\quad k=1, 2, 3, \\dots $$\n角点附近的解是这些基函数的线性组合：$u(r,\\theta) = \\sum_{k=1}^\\infty c_k r^{2k/3} \\sin\\left(\\frac{2k\\theta}{3}\\right)$。\n\n解的最奇异部分对应于最小的正指数 $\\lambda_1 = \\lambda = \\frac{2}{3}$。这就是**主阶奇异项**：\n$$ u_s(r,\\theta) = c_1 r^{2/3} \\sin\\left(\\frac{2\\theta}{3}\\right) $$\n其中 $c_1$ 是一个常数，称为应力强度因子，由整体几何形状和载荷决定。问题要求给出该项的形式。\n\n现在我们可以通过分析该项的正则性来构造第3部分所要求的反例。我们来检验一个在原点附近行为类似 $u_s$ 的函数是否属于 $H^1(\\Omega)$ 和 $H^2(\\Omega)$。\n\n**正则性检验：**\n$u_s$ 的导数行为如下：\n-   一阶导数：$|\\nabla u_s| \\sim \\frac{\\partial}{\\partial r} r^{2/3} \\sim r^{2/3 - 1} = r^{-1/3}$。\n-   二階導数：$|\\nabla^2 u_s| \\sim \\frac{\\partial^2}{\\partial r^2} r^{2/3} \\sim r^{2/3 - 2} = r^{-4/3}$。\n\n为了局部地检验 $u_s \\in H^1$，我们必须检验其一阶导数是否平方可积。在原点附近 $|\\nabla u_s|^2$ 的积分行为如下：\n$$ \\int_0^\\epsilon \\int_0^{3\\pi/2} |\\nabla u_s|^2 r \\, d\\theta \\, dr \\sim \\int_0^\\epsilon (r^{-1/3})^2 r \\, dr = \\int_0^\\epsilon r^{-2/3} r \\, dr = \\int_0^\\epsilon r^{1/3} \\, dr $$\n该积分为 $\\left[\\frac{3}{4} r^{4/3}\\right]_0^\\epsilon$，是有限的。因此，弱解 $u \\in H^1(\\Omega)$。\n\n为了局部地检验 $u_s \\in H^2$，我们必须检验其二阶导数是否平方可积。$|\\nabla^2 u_s|^2$ 的积分行为如下：\n$$ \\int_0^\\epsilon \\int_0^{3\\pi/2} |\\nabla^2 u_s|^2 r \\, d\\theta \\, dr \\sim \\int_0^\\epsilon (r^{-4/3})^2 r \\, dr = \\int_0^\\epsilon r^{-8/3} r \\, dr = \\int_0^\\epsilon r^{-5/3} \\, dr $$\n该积分为 $\\left[-\\frac{3}{2} r^{-2/3}\\right]_0^\\epsilon$，当 $r \\to 0$ 时发散。由于二阶导数不是平方可积的，所以在原点的任何邻域内 $u_s \\notin H^2$。这意味着完整解 $u$ 不在 $H^2(\\Omega)$ 中。\n\n这个分析构成了反例，表明即使唯一的 $H^1(\\Omega)$ 弱解得到保证，$u \\in H^2(\\Omega)$ 意义下的強解也不存在。$H^2$ 正则性的失效是区域中凹角的直接后果。\n\n### 5. 对边界条件的影响\n\n在弱形式中处理本质边界条件 $u=0$ on $\\Gamma_D$ 的方式，与人们对经典解的设想不同。\n-   **在弱形式中：** 在 $\\partial\\Omega$ 上的条件 $u=0$ 是通过迹定理在广义意义下满足的。解的函数空间 $H^1_0(\\Omega)$ 被特别定义为边界 $\\partial\\Omega$ 上迹为零的 $H^1(\\Omega)$ 函数集合。通过在这个空间内寻找解 $u$，边界条件被*先验地*作为对容许函数空间的约束施加。它是问题设定的“本质”部分，而不是一个需要解以逐点方式满足的方程（这对于一个 $H^1$ 函数可能没有意义）。\n-   **在数值近似（例如，有限元法）中：** 同样的原理适用。我们构造一个有限维子空间 $V_h \\subset H^1_0(\\Omega)$。这通常通过在 $\\Omega$ 上定义网格并使用分片多项式函数（形函数）$\\phi_i(x)$ 的基底来完成。为了确保 $V_h$ 中的任何函数 $u_h = \\sum c_i \\phi_i$ 在 $\\partial\\Omega$ 上满足 $u_h=0$，我们只需确保所有与*非*边界节点关联的基函数 $\\phi_i$ 在 $\\partial\\Omega$ 上为零。在实践中，与 Dirichlet 边界上的节点对应的自由度会从全局代数方程组中消除。\n\n奇异性 $u_s \\sim r^{2/3}$ 的存在对数值近似有深远的影响。使用均匀网格和多项式基函数的标准有限元法难以捕捉这种奇异行为。能量范数下的误差 $\\|u-u_h\\|_{H^1}$，对于光滑解本应以 $O(h^p)$ 的速率收敛（其中 $h$ 是网格尺寸，$p$ 是多项式次数），但现在受限于解的正则性。对于这个问题，收敛速率退化为 $O(h^{\\lambda_1}) = O(h^{2/3})$，这比线性元的最佳速率 $O(h)$ 要慢得多。这需要采用先进的技术，如朝向角点的分级网格加密，或用已知的奇异形式来丰富基函数（例如，使用扩展有限元法XFEM或奇异单元），以恢复最佳收敛速率。", "answer": "$$\n\\boxed{r^{2/3}\\sin\\left(\\frac{2\\theta}{3}\\right)}\n$$", "id": "3604122"}, {"introduction": "从连续的弱形式到有限元方法中的离散形式，这一步转换并非总是完美无缺。在实际计算中，为了简化模型或加速计算，我们常常会对几何形状或积分进行近似处理。这些近似，虽然看似微小，却可能破坏变分形式的一致性，导致离散系统不再精确对应原始的连续问题，这类操作有时被戏称为“变分犯罪”。本练习[@problem_id:3604073]旨在量化这种不一致性所带来的影响。你将分析一个变截面杆，并通过引入一个“一致性指标”来检验几何近似和减缩积分如何导致其解偏离了真实的弱形式，从而让你对有限元方法的精度和收敛性有更具体、更深刻的认识。", "problem": "考虑一根长度为 $L0$ 的直棱柱杆，在小应变、一维线弹性条件下占据区域 $x \\in [0,L]$。设杨氏模量为 $E0$，横截面积随 $x$ 线性变化，表达式为 $A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$，其中 $A_{0}0$ 且 $\\alpha$ 为无量纲参数。该杆承受分布轴向体力 $b(x) = b_{1} x$（其中 $b_{1}$ 为常数）以及边界条件：$u(0) = 0$（本质边界条件）和在 $x=L$ 处给定的面力 $t_{0}$（自然边界条件）。轴向平衡的强形式可表示为在 $[0,L]$ 上 $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) = b(x)$，并在 $x=L$ 处有 $E A(L) u'(L) = t_{0}$。\n\n从线性动量平衡以及应变 $\\varepsilon(x) = u'(x)$ 和应力 $\\sigma(x) = E \\varepsilon(x)$ 的定义出发，使用虚功原理，并采用一个在 $x=0$ 处为零的通用检验函数 $w(x)$，推导在 $[0,L]$ 上的弱形式。然后，考虑在 $[0,L]$ 上使用单个双节点有限元法（FEM）进行离散化，采用线性形函数 $N_{1}(x) = 1 - \\frac{x}{L}$ 和 $N_{2}(x) = \\frac{x}{L}$。通过将第一个自由度设为零来施加 Dirichlet 边界条件，并使用单参数试探函数 $u_{h}(x) = d_{2} N_{2}(x)$ 和检验函数 $w_{h}(x) = N_{2}(x)$。\n\n研究以下两种“变分犯罪”对弱形式一致性的影响：\n1. 几何近似：在刚度积分中，用常数近似面积 $\\widehat{A}(x) = A_{0}$ 替代真实面积 $A(x)$。\n2. 降阶积分：使用中点法则近似体力积分 $\\int_{0}^{L} b(x) w_{h}(x) \\,\\mathrm{d}x$，即 $b\\!\\left(\\frac{L}{2}\\right) w_{h}\\!\\left(\\frac{L}{2}\\right) L$。\n\n对表面力项 $t_{0} w_{h}(L)$ 使用精确计算。\n\n(a) 在上述“犯罪”条件下，推导关于 $d_{2}$ 的离散方程，并用 $E$、$A_{0}$、$\\alpha$、$L$、$b_{1}$ 和 $t_{0}$ 符号化地求解 $d_{2}$。\n\n(b) 将与 $u_h$ 相关的强形式残差定义为 $r(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)$，将在 $x=L$ 处的 Neumann 边界不匹配项定义为 $m = E A(L) u_{h}'(L) - t_{0}$。使用精确系数 $E$ 和 $A(x)$，构建标量一致性指标\n$$\nJ := \\int_{0}^{L} r(x)\\, N_{2}(x) \\,\\mathrm{d}x \\;+\\; m\\, N_{2}(L),\n$$\n该指标通过强形式残差和边界项不匹配来检测对精确弱形式的违背。将(a)部分中得到的 $d_2$ 代入，计算 $J$ 的闭合形式解。\n\n以牛顿（Newtons）为单位表示 $J$ 的最终值。无需代入任何数值；请用 $E$、$A_{0}$、$\\alpha$、$L$、$b_{1}$ 和 $t_{0}$ 给出一个单一的、简化的解析表达式。最终答案必须是单一表达式。如果在推导过程中进行了任何近似，请从第一性原理出发进行论证。无需四舍五入。", "solution": "该问题要求使用有限元法（FEM）分析一维线弹性杆，并特别关注“变分犯罪”对公式一致性的影响。我们将首先推导弱形式，然后是带有指定近似的离散方程，求解未知位移，最后计算一致性指标 $J$。\n\n该边值问题的控制强形式由下式给出：\n$$-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) = b(x) \\quad \\text{for } x \\in (0, L)$$\n边界条件为：\n$$u(0) = 0 \\quad (\\text{本质边界条件})$$\n$$E A(L) u'(L) = t_{0} \\quad (\\text{自然边界条件})$$\n其中 $u(x)$ 是轴向位移，$E$ 是杨氏模量，$A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$ 是可变横截面积，$b(x) = b_{1} x$ 是分布体力（单位长度上的力），$t_0$ 是在 $x=L$ 端施加的面力（一个集中力）。\n\n为了推导弱形式，我们采用虚功原理。我们将控制微分方程乘以一个虚位移或检验函数 $w(x)$，该函数必须满足齐次本质边界条件，即 $w(0)=0$。然后我们在区域 $[0,L]$ 上积分：\n$$-\\int_{0}^{L} \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) w(x) \\,\\mathrm{d}x = \\int_{0}^{L} b(x) w(x) \\,\\mathrm{d}x$$\n我们对左侧（LHS）进行分部积分：\n$$ \\text{LHS} = \\int_{0}^{L} E A(x) u'(x) w'(x) \\,\\mathrm{d}x - \\left[ E A(x) u'(x) w(x) \\right]_{0}^{L} $$\n计算边界项：\n$$ \\left[ E A(x) u'(x) w(x) \\right]_{0}^{L} = E A(L) u'(L) w(L) - E A(0) u'(0) w(0) $$\n在 $x=0$ 处的项因为 $w(0)=0$ 而消失。在 $x=L$ 处，我们应用自然边界条件 $E A(L) u'(L) = t_0$。因此，边界项变为 $t_0 w(L)$。将此代回，我们得到弱形式：\n求解 $u(x)$，使其满足 $u(0)=0$，并且对于所有满足 $w(0)=0$ 的检验函数 $w(x)$：\n$$ \\int_{0}^{L} E A(x) u'(x) w'(x) \\,\\mathrm{d}x = \\int_{0}^{L} b(x) w(x) \\,\\mathrm{d}x + t_0 w(L) $$\n\n现在，我们进行有限元离散化。区域 $[0,L]$ 被一个双节点单元离散化。未知位移场 $u(x)$ 由试探函数 $u_h(x) = \\sum_{i=1}^{2} d_i N_i(x)$ 近似，其中 $d_i$ 是节点位移，$N_i(x)$ 是线性形函数：$N_{1}(x) = 1 - \\frac{x}{L}$ 和 $N_{2}(x) = \\frac{x}{L}$。本质边界条件 $u(0)=0$ 意味着 $u_h(0) = d_1 N_1(0) + d_2 N_2(0) = d_1 \\cdot 1 + d_2 \\cdot 0 = d_1 = 0$。检验函数从同一空间中选取，即 $w_h(x) = c_2 N_2(x)$。由于是线性问题，我们可以简单地设置 $w_h(x) = N_2(x)$。\n试探函数及其导数为：\n$$u_{h}(x) = d_{2} N_{2}(x) = d_{2} \\frac{x}{L}$$\n$$u_{h}'(x) = d_{2} \\frac{1}{L}$$\n检验函数及其导数为：\n$$w_{h}(x) = N_{2}(x) = \\frac{x}{L}$$\n$$w_{h}'(x) = N_{2}'(x) = \\frac{1}{L}$$\n\n(a) 在变分犯罪下推导 $d_2$ 的离散方程。\n\n离散弱形式为 $a(u_h, w_h) = l(w_h)$。我们必须使用指定的“犯罪”来计算双线性形式 $a(\\cdot, \\cdot)$ 和线性泛函 $l(\\cdot)$。\n\n1.  **刚度项 (LHS)**：几何犯罪是在刚度积分中用常数近似 $\\widehat{A}(x) = A_{0}$ 代替 $A(x)$。\n    $$ \\text{LHS} = \\int_{0}^{L} E \\widehat{A}(x) u_{h}'(x) w_{h}'(x) \\,\\mathrm{d}x = \\int_{0}^{L} E A_{0} \\left( \\frac{d_2}{L} \\right) \\left( \\frac{1}{L} \\right) \\,\\mathrm{d}x $$\n    $$ \\text{LHS} = \\frac{E A_{0} d_{2}}{L^2} \\int_{0}^{L} \\mathrm{d}x = \\frac{E A_{0} d_{2}}{L^2} [x]_{0}^{L} = \\frac{E A_{0} d_{2}}{L} $$\n\n2.  **力项 (RHS)**：这包括体力积分和面力项。\n    -   体力积分使用中点法则（一种求积犯罪）进行近似。\n    $$ \\int_{0}^{L} b(x) w_{h}(x) \\,\\mathrm{d}x \\approx L \\cdot b\\left(\\frac{L}{2}\\right) w_{h}\\left(\\frac{L}{2}\\right) $$\n    我们有 $b(x) = b_1 x$，所以 $b(L/2) = b_1 \\frac{L}{2}$。检验函数是 $w_h(x) = N_2(x) = \\frac{x}{L}$，所以 $w_h(L/2) = \\frac{L/2}{L} = \\frac{1}{2}$。\n    $$ \\text{体力项} \\approx L \\left( b_1 \\frac{L}{2} \\right) \\left( \\frac{1}{2} \\right) = \\frac{b_1 L^2}{4} $$\n    -   面力项被精确计算。\n    $$ t_{0} w_{h}(L) = t_{0} N_{2}(L) = t_{0} \\left( \\frac{L}{L} \\right) = t_{0} $$\n    将这些组合起来得到 RHS：\n    $$ \\text{RHS} = \\frac{b_1 L^2}{4} + t_0 $$\n\n令 LHS 和 RHS 相等，得到 $d_2$ 的离散方程：\n$$ \\frac{E A_{0} d_{2}}{L} = \\frac{b_1 L^2}{4} + t_0 $$\n求解 $d_2$：\n$$ d_{2} = \\frac{L}{E A_{0}} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) = \\frac{b_1 L^3}{4 E A_0} + \\frac{t_0 L}{E A_0} $$\n\n(b) 计算一致性指标 $J$。\n\n一致性指标定义为：\n$$ J := \\int_{0}^{L} r(x)\\, N_{2}(x) \\,\\mathrm{d}x \\;+\\; m\\, N_{2}(L) $$\n其中 $r(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)$ 是强形式残差，$m = E A(L) u_{h}'(L) - t_{0}$ 是 Neumann 边界不匹配项。\n\n让我们将 $r(x)$ 和 $m$ 的定义代入 $J$。注意 $N_2(L)=1$。\n$$ J = \\int_{0}^{L} \\left(-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)\\right) N_{2}(x) \\,\\mathrm{d}x + \\left(E A(L) u_{h}'(L) - t_{0}\\right) \\cdot 1 $$\n我们对积分中的第一项进行分部积分：\n$$ -\\int_{0}^{L} \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) N_{2}(x) \\,\\mathrm{d}x = \\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - \\left[E A(x) u_{h}'(x) N_{2}(x)\\right]_0^L $$\n边界项计算结果为 $E A(L) u_{h}'(L) N_{2}(L) - E A(0) u_{h}'(0) N_{2}(0)$。在 $x=0$ 处的项为零，因为 $N_2(0)=0$。\n将此代回 $J$ 的表达式中：\n$$ J = \\left(\\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - E A(L) u_{h}'(L) N_{2}(L) \\right) - \\int_0^L b(x) N_2(x) dx + E A(L) u_{h}'(L) - t_0 $$\n由于 $N_2(L)=1$，包含 $E A(L) u_{h}'(L)$ 的项相互抵消：\n$$ J = \\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - \\int_0^L b(x) N_2(x) dx - t_0 $$\n这表明 $J$ 是用近似解 $u_h$ 和检验函数 $w_h=N_2$ 计算的*精确*弱形式的残差。\n$$J = a_{exact}(u_h, N_2) - l_{exact}(N_2)$$\n解 $d_2$ 是从*有犯罪的*弱形式 $a_{approx}(u_h, N_2) = l_{approx}(N_2)$ 中获得的。因此，我们可以将 $J$ 表示为由这些犯罪引入的误差之和：\n$$ J = [ a_{exact}(u_h, N_2) - a_{approx}(u_h, N_2) ] - [ l_{exact}(N_2) - l_{approx}(N_2) ] $$\n让我们计算这两个误差项。\n\n1.  **刚度误差**：$E_K = a_{exact} - a_{approx}$\n$$ E_K = \\int_0^L E A(x) u_h'(x) N_2'(x) dx - \\int_0^L E \\widehat{A}(x) u_h'(x) N_2'(x) dx $$\n$$ E_K = \\int_0^L E (A(x) - \\widehat{A}(x)) u_h'(x) N_2'(x) dx $$\n代入 $A(x) = A_{0}(1 + \\alpha \\frac{x}{L})$、$\\widehat{A}(x) = A_0$、$u_h'(x) = d_2/L$ 和 $N_2'(x) = 1/L$：\n$$ E_K = \\int_0^L E \\left( A_{0}\\alpha \\frac{x}{L} \\right) \\left( \\frac{d_2}{L} \\right) \\left( \\frac{1}{L} \\right) dx = \\frac{E A_0 \\alpha d_2}{L^3} \\int_0^L x \\,dx $$\n$$ E_K = \\frac{E A_0 \\alpha d_2}{L^3} \\left[ \\frac{x^2}{2} \\right]_0^L = \\frac{E A_0 \\alpha d_2}{L^3} \\frac{L^2}{2} = \\frac{E A_0 \\alpha d_2}{2L} $$\n\n2.  **力误差**：$E_F = l_{exact} - l_{approx}$\n面力项 $t_0 N_2(L)$ 是相同的，因此抵消。误差仅来自于体力积分。\n$$ E_F = \\int_0^L b(x) N_2(x) dx - \\left( L \\cdot b\\left(\\frac{L}{2}\\right) N_2\\left(\\frac{L}{2}\\right) \\right) $$\n精确积分为：\n$$ \\int_0^L (b_1 x) \\left(\\frac{x}{L}\\right) dx = \\frac{b_1}{L} \\int_0^L x^2 dx = \\frac{b_1}{L} \\left[ \\frac{x^3}{3} \\right]_0^L = \\frac{b_1 L^2}{3} $$\n近似积分已计算为 $\\frac{b_1 L^2}{4}$。\n$$ E_F = \\frac{b_1 L^2}{3} - \\frac{b_1 L^2}{4} = b_1 L^2 \\left(\\frac{4-3}{12}\\right) = \\frac{b_1 L^2}{12} $$\n\n现在，组合 $J = E_K - E_F$：\n$$ J = \\frac{E A_0 \\alpha d_2}{2L} - \\frac{b_1 L^2}{12} $$\n最后，我们代入在(a)部分中找到的 $d_2$ 的表达式：\n$$ d_2 = \\frac{L}{E A_0} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) $$\n$$ J = \\frac{E A_0 \\alpha}{2L} \\left[ \\frac{L}{E A_0} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) \\right] - \\frac{b_1 L^2}{12} $$\n在第一部分中，$E A_0$ 和 $L$ 项相互抵消：\n$$ J = \\frac{\\alpha}{2} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) - \\frac{b_1 L^2}{12} $$\n$$ J = \\frac{\\alpha b_1 L^2}{8} + \\frac{\\alpha t_0}{2} - \\frac{b_1 L^2}{12} $$\n合并含有 $b_1 L^2$ 的项：\n$$ J = b_1 L^2 \\left( \\frac{\\alpha}{8} - \\frac{1}{12} \\right) + \\frac{\\alpha t_0}{2} $$\n$$ J = b_1 L^2 \\left( \\frac{3\\alpha - 2}{24} \\right) + \\frac{\\alpha t_0}{2} $$\n$J$ 的这个最终表达式量化了由两个变分犯罪引入的不一致性。与 $b_1$ 成正比的项包含来自几何犯罪（$\\alpha$）和求积犯罪（常数部分）的分量，而与 $t_0$ 成正比的项仅由几何犯罪产生。如果没有实施犯罪（$\\alpha=0$ 且积分精确），$J$ 将为零。", "answer": "$$\\boxed{b_{1} L^2 \\left( \\frac{3\\alpha - 2}{24} \\right) + \\frac{\\alpha t_{0}}{2}}$$", "id": "3604073"}, {"introduction": "掌握了弱形式的基础之后，我们可以将其应用于更复杂的真实世界场景，例如，当外力的大小或方向取决于结构本身的变形时。这类力被称为“跟随力”，是一种非保守力。如果天真地应用弱形式，可能会导致数值模型的不稳定甚至得出完全错误的预测。解决这一问题的关键在于进行“一致性线性化”，它能够精确地捕捉力随位移变化的规律。在这个高级练习[@problem_id:3604053]中，你将为一个承受跟随压力的结构推导其弱形式，并进行严格的变分线性化，以得到正确的“载荷刚度矩阵”。通过与不一致的公式进行对比，你将能够识别并量化由此产生的“伪刚度”，从而深刻体会到严谨的变分推导对于非线性问题稳定性和准确性的至关重要性。", "problem": "考虑一个占据域 $\\Omega \\subset \\mathbb{R}^{2}$ 的二维弹性体，其边界为 $\\partial \\Omega = \\Gamma_{u} \\cup \\Gamma_{t}$，其中 $\\Gamma_{u}$ 和 $\\Gamma_{t}$ 不相交。该物体处于准静态平衡状态，并满足线性动量平衡和牵引力边界条件。设 Cauchy 应力为 $\\boldsymbol{\\sigma}$，在 $\\Gamma_{t}$ 上的给定牵引力为大小为 $p$ 的均布随动线荷载，沿边界段当前构型的外单位法向量 $\\mathbf{n}(\\boldsymbol{\\varphi})$ 方向作用，其中 $\\boldsymbol{\\varphi}$ 是变形映射。假设边界段上为小应变但有限转动的设定，因此内部的材料响应保持线性弹性，但边界牵引力跟随当前的法线方向。\n\n从强形式的线性动量平衡和牵引力边界条件出发，推导该边值问题的弱（变分）形式，并将 $\\Gamma_{t}$ 上的外虚功贡献具体化到单个直边界边 $\\Gamma_{e} \\subset \\Gamma_{t}$ 的情况。该边界边由一个双节点线性段离散化，节点在参考构型中的位置为 $\\mathbf{X}_{1}$ 和 $\\mathbf{X}_{2}$，节点位移为 $\\mathbf{u}_{1}$ 和 $\\mathbf{u}_{2}$。将当前边向量记为 $\\mathbf{a} = \\big(\\mathbf{X}_{2} + \\mathbf{u}_{2}\\big) - \\big(\\mathbf{X}_{1} + \\mathbf{u}_{1}\\big)$，其当前长度记为 $L = \\|\\mathbf{a}\\|$，当前单位切向量记为 $\\mathbf{t} = \\mathbf{a}/L$，当前单位法向量记为 $\\mathbf{n} = \\mathbf{P}\\,\\mathbf{t}$，其中 $\\mathbf{P} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$ 表示将 $\\mathbb{R}^{2}$ 中任意向量逆时针旋转 $\\pi/2$ 弧度的矩阵。在此设定下，$\\Gamma_{e}$ 上的外虚功为\n$$\n\\delta W_{\\text{ext}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{n}(\\mathbf{u}) \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s.\n$$\n\n使用虚功原理和变分线性化，推导 $\\delta W_{\\text{ext}}$ 关于 Newton 增量 $(\\Delta \\mathbf{u}_{1}, \\Delta \\mathbf{u}_{2})$ 的一致线性化，并证明对于具有线性形函数的双节点直边，每个节点上的单元级外荷载向量为 $\\mathbf{f}_{i} = \\frac{pL}{2}\\,\\mathbf{n}$，其一致 Gateaux 导数（即所谓的荷载刚度）满足\n$$\n\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\Big[ \\big(\\mathbf{n} \\otimes \\mathbf{t}\\big) + \\mathbf{P}\\big(\\mathbf{I} - \\mathbf{t} \\otimes \\mathbf{t}\\big) \\Big] \\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n对于参考边与全局 $x$ 轴对齐的初始方向，即 $\\mathbf{X}_{2} - \\mathbf{X}_{1} = (L_{0}, 0)^{\\mathsf{T}}$，计算此表达式，并考虑该方向附近的构型，使得 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{n} \\approx (0,1)^{\\mathsf{T}}$。证明一致荷载刚度简化为\n$$\n\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\,\\mathbf{P}\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n现在，通过将随动方向和当前线元测度冻结在其参考值来构建一个非一致弱形式，即使用 $\\mathbf{N} = \\mathbf{P}\\,\\mathbf{T}_{0}$（其中 $\\mathbf{T}_{0} = (\\mathbf{X}_{2} - \\mathbf{X}_{1})/\\|\\mathbf{X}_{2} - \\mathbf{X}_{1}\\|$）并在外虚功中用 $L_{0} = \\|\\mathbf{X}_{2} - \\mathbf{X}_{1}\\|$ 替换 $L$，从而得到\n$$\n\\delta W_{\\text{ext}}^{\\text{inc}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{N} \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s \\approx p\\,\\frac{L_{0}}{2}\\,\\mathbf{N} \\cdot \\big(\\delta \\mathbf{u}_{1} + \\delta \\mathbf{u}_{2}\\big).\n$$\n对此非一致表达式关于 $(\\Delta \\mathbf{u}_{1}, \\Delta \\mathbf{u}_{2})$ 进行线性化，但允许当前长度 $L$ 变化，同时保持 $\\mathbf{N}$ 和 $L_{0}$ 固定，并证明在每个节点上得到的非一致荷载刚度为\n$$\n\\Delta \\mathbf{f}_{i}^{\\text{inc}} = \\frac{p}{2}\\,\\big(\\mathbf{N} \\otimes \\mathbf{t}\\big)\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n对于相同的初始方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{N} \\approx (0,1)^{\\mathsf{T}}$，通过考虑节点1处节点力变化的 $x$ 分量中乘以 $\\Delta a_{y} = \\big(\\Delta u_{2,y} - \\Delta u_{1,y}\\big)$ 的系数，识别并量化由这种非一致弱形式引入的一个伪刚度分量，即\n$$\n\\Delta f_{1,x} = k_{\\text{spur}}\\,\\Delta a_{y}.\n$$\n将标量系数 $k_{\\text{spur}}$ 计算为\n$$\nk_{\\text{spur}} = \\frac{p}{2}\\,\\big([\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2}\\big),\n$$\n其中对于指定方向，$\\mathbf{B}_{\\text{inc}} = \\mathbf{N} \\otimes \\mathbf{t}$ 且 $\\mathbf{B} = \\mathbf{P}$。将 $k_{\\text{spur}}$ 的最终值以 $\\mathrm{N}\\,\\mathrm{m}^{-1}$ 为单位，表示为关于 $p$ 的单个闭式解析表达式。不需要进行数值舍入。", "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- **域**：$\\Omega \\subset \\mathbb{R}^{2}$ 域中的一个二维弹性体。\n- **边界**：$\\partial \\Omega = \\Gamma_{u} \\cup \\Gamma_{t}$，其中 $\\Gamma_{u} \\cap \\Gamma_{t} = \\emptyset$。\n- **物理**：准静态平衡，线性动量平衡。\n- **$\\Gamma_{t}$ 上的边界条件**：给定大小为 $p$ 的均布随动线荷载，沿当前构型的外单位法向量 $\\mathbf{n}(\\boldsymbol{\\varphi})$ 作用，其中 $\\boldsymbol{\\varphi}$ 是变形映射。\n- **本构和运动学假设**：边界上小应变、有限转动，内部线性弹性。\n- **强形式**：线性动量平衡和牵引力边界条件。\n- **子边界 $\\Gamma_e \\subset \\Gamma_t$ 上的外虚功**：\n$$\n\\delta W_{\\text{ext}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{n}(\\mathbf{u}) \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s\n$$\n- **离散化**：$\\Gamma_e$ 是一个双节点线性段，节点在参考构型中的位置为 $\\mathbf{X}_{1}, \\mathbf{X}_{2}$，位移为 $\\mathbf{u}_{1}, \\mathbf{u}_{2}$。\n- **几何定义**：\n  - 当前边向量：$\\mathbf{a} = \\big(\\mathbf{X}_{2} + \\mathbf{u}_{2}\\big) - \\big(\\mathbf{X}_{1} + \\mathbf{u}_{1}\\big)$\n  - 当前长度：$L = \\|\\mathbf{a}\\|$\n  - 当前单位切向量：$\\mathbf{t} = \\mathbf{a}/L$\n  - 当前单位法向量：$\\mathbf{n} = \\mathbf{P}\\,\\mathbf{t}$，其中 $\\mathbf{P} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$。\n- **任务1**：推导单元级节点力 $\\mathbf{f}_{i} = \\frac{pL}{2}\\,\\mathbf{n}$ 和一致线性化（荷载刚度）$\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\Big[ \\big(\\mathbf{n} \\otimes \\mathbf{t}\\big) + \\mathbf{P}\\big(\\mathbf{I} - \\mathbf{t} \\otimes \\mathbf{t}\\big) \\Big] \\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big)$。\n- **任务2**：证明对于初始方向 $\\mathbf{X}_{2} - \\mathbf{X}_{1} = (L_{0}, 0)^{\\mathsf{T}}$ 和其附近的构型（$\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$, $\\mathbf{n} \\approx (0,1)^{\\mathsf{T}}$），一致荷载刚度简化为 $\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\,\\mathbf{P}\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big)$。\n- **非一致公式**：\n  - 虚功：$\\delta W_{\\text{ext}}^{\\text{inc}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{N} \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s$，其中 $\\mathbf{N}$ 是固定的参考法向量，$\\mathrm{d}s$ 是当前弧长元。\n  - 提到的另一种形式：$\\delta W_{\\text{ext}}^{\\text{inc}} \\approx p\\,\\frac{L_{0}}{2}\\,\\mathbf{N} \\cdot \\big(\\delta \\mathbf{u}_{1} + \\delta \\mathbf{u}_{2}\\big)$。\n- **任务3**：将非一致公式线性化，其中 $L$ 可变而 $\\mathbf{N}$ 固定，以证明非一致荷载刚度为 $\\Delta \\mathbf{f}_{i}^{\\text{inc}} = \\frac{p}{2}\\,\\big(\\mathbf{N} \\otimes \\mathbf{t}\\big)\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big)$。\n- **任务4**：对于特定方向，使用公式 $k_{\\text{spur}} = \\frac{p}{2}\\,\\big([\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2}\\big)$ 量化由 $\\Delta f_{1,x} = k_{\\text{spur}}\\,\\Delta a_{y}$ 定义的伪刚度系数 $k_{\\text{spur}}$，其中 $\\mathbf{B}_{\\text{inc}} = \\mathbf{N} \\otimes \\mathbf{t}$ 且 $\\mathbf{B} = \\mathbf{P}$。\n- **最终答案**：用 $p$ 表示 $k_{\\text{spur}}$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题植根于连续介质力学和有限元方法的原理，具体涉及非保守随动荷载的公式化。这是计算固体力学中一个标准的、无争议的课题。\n2.  **适定性**：该问题结构为一系列推导后进行一次计算。它提供了所有必要的定义、方程和约束，以获得所求量的唯一解析解。\n3.  **客观性**：语言正式而精确。所有术语都有数学定义。没有主观或基于观点的陈述。\n4.  **完整性和一致性**：该问题是自洽的。虽然它提到了两种略有不同的非一致公式，但它明确了在线性化步骤中使用哪一种，从而避免了歧义。从一致到非一致公式的逻辑流程及其比较是连贯的。\n5.  **现实性和可行性**：随动压力荷载的情景是一个常见的工程问题（例如，柔性结构上的流体压力）。小应变、有限转动的假设是结构分析中一个有效且广泛使用的简化方法。\n\n### 第3步：结论和行动\n该问题在科学上是合理的、适定的、客观的且内部一致的。这是计算固体力学中的一个有效问题。我将继续进行求解。\n\n***\n\n虚功原理指出，对于处于平衡状态的物体，对于任何运动学容许的虚位移，外力所做的虚功等于内力所做的虚功。平衡的强形式 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$（在 $\\Omega$ 中）和牵引力边界条件 $\\boldsymbol{\\sigma} \\mathbf{n}_{\\text{bdy}} = \\mathbf{t}_{\\text{ prescribed}}$（在 $\\Gamma_t$ 上），通过乘以一个虚位移场 $\\delta\\mathbf{u}$ 并在域 $\\Omega$ 上积分，可以转换成弱形式。应用散度定理可得出标准的弱形式：\n$$\n\\int_{\\Omega} \\nabla(\\delta\\mathbf{u}) : \\boldsymbol{\\sigma} \\, \\mathrm{d}V = \\int_{\\Omega} \\delta\\mathbf{u} \\cdot \\mathbf{b} \\, \\mathrm{d}V + \\int_{\\Gamma_t} \\delta\\mathbf{u} \\cdot \\mathbf{t}_{\\text{prescribed}} \\, \\mathrm{d}A\n$$\n问题集中于 $\\Gamma_t$ 上的边界积分，它代表外虚功 $\\delta W_{\\text{ext}}$。\n\n**第1部分：外虚功和节点力的离散化**\n双节点直边 $\\Gamma_e$ 上的外虚功由 $\\delta W_{\\text{ext}} = \\int_{\\Gamma_{e}} p\\,\\mathbf{n}(\\mathbf{u}) \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s$ 给出。对于双节点线性单元，位移场和虚位移场由节点值插值得到：$\\mathbf{u}(\\xi) = N_1(\\xi)\\mathbf{u}_1 + N_2(\\xi)\\mathbf{u}_2$ 和 $\\delta\\mathbf{u}(\\xi) = N_1(\\xi)\\delta\\mathbf{u}_1 + N_2(\\xi)\\delta\\mathbf{u}_2$，其中线性形函数为 $N_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_2(\\xi) = \\frac{1+\\xi}{2}$，$\\xi \\in [-1, 1]$。当前构型中的弧长微分为 $\\mathrm{d}s = \\frac{L}{2}\\mathrm{d}\\xi$。由于 $p$、$\\mathbf{n}$ 和 $L$ 沿着直段是常数：\n$$\n\\delta W_{\\text{ext}} = \\int_{-1}^{1} p\\,\\mathbf{n} \\cdot \\left(N_1(\\xi)\\delta\\mathbf{u}_1 + N_2(\\xi)\\delta\\mathbf{u}_2\\right) \\frac{L}{2} \\, \\mathrm{d}\\xi = p\\frac{L}{2}\\mathbf{n} \\cdot \\left( \\delta\\mathbf{u}_1 \\int_{-1}^{1} N_1(\\xi)\\mathrm{d}\\xi + \\delta\\mathbf{u}_2 \\int_{-1}^{1} N_2(\\xi)\\mathrm{d}\\xi \\right)\n$$\n线性形函数在父单元上的积分为 $\\int_{-1}^{1} N_1(\\xi)\\mathrm{d}\\xi = 1$ 和 $\\int_{-1}^{1} N_2(\\xi)\\mathrm{d}\\xi = 1$。因此，\n$$\n\\delta W_{\\text{ext}} = p\\frac{L}{2}\\mathbf{n} \\cdot \\left(\\delta\\mathbf{u}_1 + \\delta\\mathbf{u}_2\\right) = \\left(\\frac{pL}{2}\\mathbf{n}\\right) \\cdot \\delta\\mathbf{u}_1 + \\left(\\frac{pL}{2}\\mathbf{n}\\right) \\cdot \\delta\\mathbf{u}_2\n$$\n根据定义，$\\delta W_{\\text{ext}} = \\mathbf{f}_1 \\cdot \\delta\\mathbf{u}_1 + \\mathbf{f}_2 \\cdot \\delta\\mathbf{u}_2$。通过比较各项，我们发现在每个节点 $i \\in \\{1,2\\}$ 上的单元级外荷载向量为 $\\mathbf{f}_i = \\frac{pL}{2}\\mathbf{n}$。\n\n**第2部分：一致线性化（荷载刚度）**\n为了求出荷载刚度矩阵，我们必须计算节点力 $\\mathbf{f}_i$ 关于节点位移在增量位移 $(\\Delta\\mathbf{u}_1, \\Delta\\mathbf{u}_2)$ 方向上的 Gateaux 导数。\n$$\n\\Delta\\mathbf{f}_i = D[\\mathbf{f}_i](\\mathbf{u})[\\Delta\\mathbf{u}] = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\mathbf{f}_i(\\mathbf{u} + \\epsilon\\Delta\\mathbf{u})\n$$\n由于 $\\mathbf{f}_i = \\frac{p}{2}L\\mathbf{n}$， $L$ 和 $\\mathbf{n}$ 都依赖于 $\\mathbf{u}$。使用乘法法则：\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2}\\left( (\\Delta L)\\mathbf{n} + L(\\Delta\\mathbf{n}) \\right)\n$$\n我们对 $L$ 和 $\\mathbf{n}$ 进行线性化。令 $\\mathbf{a} = (\\mathbf{X}_2-\\mathbf{X}_1) + (\\mathbf{u}_2-\\mathbf{u}_1) = \\mathbf{A} + \\mathbf{a}_u$。增量为 $\\Delta\\mathbf{a} = \\Delta\\mathbf{u}_2-\\Delta\\mathbf{u}_1$。\n长度为 $L = (\\mathbf{a}\\cdot\\mathbf{a})^{1/2}$。其变分为 $\\Delta L = \\frac{\\mathbf{a} \\cdot \\Delta\\mathbf{a}}{L} = \\frac{\\mathbf{a}}{L} \\cdot \\Delta\\mathbf{a} = \\mathbf{t} \\cdot \\Delta\\mathbf{a}$。\n单位切向量为 $\\mathbf{t}=\\mathbf{a}/L$。其变分为 $\\Delta \\mathbf{t} = \\frac{\\Delta\\mathbf{a}}{L} - \\frac{\\mathbf{a}}{L^2}\\Delta L = \\frac{1}{L} \\left(\\Delta\\mathbf{a} - \\mathbf{t}(\\mathbf{t}\\cdot\\Delta\\mathbf{a})\\right) = \\frac{1}{L}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n单位法向量为 $\\mathbf{n}=\\mathbf{P}\\mathbf{t}$。其变分为 $\\Delta\\mathbf{n} = \\mathbf{P}\\Delta\\mathbf{t} = \\frac{1}{L}\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n将 $\\Delta L$ 和 $\\Delta\\mathbf{n}$ 代入 $\\Delta\\mathbf{f}_i$ 的表达式中：\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2} \\left( (\\mathbf{t} \\cdot \\Delta\\mathbf{a})\\mathbf{n} + L \\left( \\frac{1}{L}\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a} \\right) \\right)\n$$\n使用张量积恒等式 $(\\mathbf{v}\\cdot\\mathbf{w})\\mathbf{u} = (\\mathbf{u}\\otimes\\mathbf{v})\\mathbf{w}$，我们将 $(\\mathbf{t} \\cdot \\Delta\\mathbf{a})\\mathbf{n}$ 写为 $(\\mathbf{n}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2} \\left[ (\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\right] \\Delta\\mathbf{a}\n$$\n这与问题陈述中给出的一致线性化表达式相符，其中 $\\Delta\\mathbf{a} = \\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1$。\n\n**第3部分：对参考方向的具体化**\n对于方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{n} \\approx (0,1)^{\\mathsf{T}}$：\n- $\\mathbf{t}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$\n- $\\mathbf{n}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$\n- $\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$\n- $\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\approx \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 0  0 \\end{pmatrix}$\n方括号中的项变为：\n$$\n(\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\approx \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} + \\begin{pmatrix} 0  -1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} = \\mathbf{P}\n$$\n因此，一致荷载刚度简化为 $\\Delta\\mathbf{f}_i = \\frac{p}{2}\\mathbf{P}(\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)$，从而证实了问题陈述。\n\n**第4部分：非一致公式和线性化**\n问题指导我们线性化一个非一致公式，其中节点力取为 $\\mathbf{f}_i^{\\text{inc}} = \\frac{pL}{2}\\mathbf{N}$，这里 $\\mathbf{N}$ 是固定的参考法向量，$L$ 是当前长度。\n线性化结果为 $\\Delta\\mathbf{f}_i^{\\text{inc}} = \\frac{p}{2}(\\Delta L)\\mathbf{N}$。\n使用先前推导的表达式 $\\Delta L = \\mathbf{t} \\cdot (\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)$：\n$$\n\\Delta\\mathbf{f}_i^{\\text{inc}} = \\frac{p}{2} (\\mathbf{t} \\cdot (\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)) \\mathbf{N} = \\frac{p}{2} (\\mathbf{N}\\otimes\\mathbf{t})(\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)\n$$\n这证实了非一致荷载刚度的表达式。\n\n**第5部分：伪刚度分量的计算**\n我们被要求计算 $k_{\\text{spur}}$，其通过关系 $k_{\\text{spur}} = \\frac{p}{2}\\,\\big([\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2}\\big)$ 定义。该系数表示交叉刚度项中的误差，该项将相对垂直位移增量 $\\Delta a_y$ 与水平力增量 $\\Delta f_{1,x}$ 耦合起来。\n从推导可知，关联 $\\Delta\\mathbf{f}_i$ 与 $\\Delta\\mathbf{a}$ 的荷载刚度矩阵为：\n- 一致：$\\mathbf{K}_{\\text{load}} = \\frac{p}{2} \\left[ (\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\right] = \\frac{p}{2}\\mathbf{B}$。对于指定方向，$\\mathbf{B} = \\mathbf{P}$。\n- 非一致：$\\mathbf{K}_{\\text{load}}^{\\text{inc}} = \\frac{p}{2} (\\mathbf{N}\\otimes\\mathbf{t}) = \\frac{p}{2}\\mathbf{B}_{\\text{inc}}$。\n\n我们为方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{N} \\approx (0,1)^{\\mathsf{T}}$ 计算 $\\mathbf{B}$ 和 $\\mathbf{B}_{\\text{inc}}$：\n$$\n\\mathbf{B} = \\mathbf{P} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}\n$$\n$$\n\\mathbf{B}_{\\text{inc}} = \\mathbf{N}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}\n$$\n现在，我们计算差分矩阵 $\\mathbf{B}_{\\text{inc}} - \\mathbf{B}$：\n$$\n\\mathbf{B}_{\\text{inc}} - \\mathbf{B} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} - \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0 - 0  0 - (-1) \\\\ 1 - 1  0 - 0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n该矩阵的 $(1,2)$ 分量为 $[\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2} = 1$。\n将此代入给定的 $k_{\\text{spur}}$ 公式中：\n$$\nk_{\\text{spur}} = \\frac{p}{2} \\big( [\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2} \\big) = \\frac{p}{2} \\cdot 1 = \\frac{p}{2}\n$$\n量 $p$ 是单位长度上的力（单位为 $\\mathrm{N}\\,\\mathrm{m}^{-1}$），因此 $k_{\\text{spur}}$ 具有刚度的单位，这是一致的。", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "3604053"}]}