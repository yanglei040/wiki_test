{"hands_on_practices": [{"introduction": "位移梯度张量 $\\nabla \\mathbf{u}$ 是连续介质力学的基石，它包含了关于变形的所有局部信息。本练习提供了一个具体的机会来剖析这个基本张量，通过将一个给定的位移场分解为其对称部分（应变）和反对称部分（自旋）。通过执行这种分解并验证关键的恒等式，您将对数学对象如何描述材料的拉伸、剪切和旋转获得更深刻的物理直觉。[@problem_id:3568721]", "problem": "一个均匀、各向同性的固体经历了一个小变形，其位移场由 $\\mathbf{u}(\\mathbf{x}) = \\begin{bmatrix} \\alpha x^{2} \\\\ \\beta x y \\\\ \\gamma z \\end{bmatrix}$ 描述，其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是实常数，$\\mathbf{x} = (x,y,z)$ 是笛卡尔坐标。以无穷小应变理论的运动学为基础，完成以下任务：\n\n1. 从笛卡尔坐标中位移梯度 $\\nabla \\mathbf{u}$ 的定义以及二阶张量分解为对称和反对称部分的加法分解出发，推导位移梯度 $\\nabla \\mathbf{u}$、无穷小应变张量 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T}\\right)$ 和无穷小自旋张量 $\\boldsymbol{\\omega} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^{T}\\right)$ 作为 $x$、$y$、$z$、$\\alpha$、$\\beta$ 和 $\\gamma$ 函数的显式表达式。\n\n2. 计算散度 $\\nabla \\cdot \\mathbf{u}$ 和旋度 $\\nabla \\times \\mathbf{u}$，并从基本原理验证 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$ 以及 $\\boldsymbol{\\omega}$ 的轴向量表示等于 $\\tfrac{1}{2}\\nabla \\times \\mathbf{u}$。\n\n3. 定义标量不变量 $S(x,y,z)$ 为 $S(x,y,z) := \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2}$，其中 $\\boldsymbol{\\omega}_{\\text{ax}}$ 表示 $\\boldsymbol{\\omega}$ 的轴向量，$\\|\\cdot\\|_{2}$ 是欧几里得范数。以 $x$、$y$、$z$、$\\alpha$、$\\beta$ 和 $\\gamma$ 的函数形式，给出 $S(x,y,z)$ 的闭合形式解。将最终结果表示为无单位的单一解析表达式。\n\n最后，简要评论您计算出的场的空间变化，并讨论在小应变假设下该变形的物理合理性。该评论不影响计算部分的评分。\n\n您的最终答案必须是 $S(x,y,z)$ 的单一解析表达式。", "solution": "该问题陈述经评估有效。它在连续介质力学中无穷小应变理论的既定框架内具有科学依据。该问题是适定的、客观的、自洽的，并需要基于所提供的位移场进行一套标准的、可验证的计算。所有定义和关系均为该领域的标准内容。\n\n解题过程遵循问题陈述中概述的三个部分。\n\n第 $1$ 部分：位移梯度、应变张量和自旋张量的推导。\n\n给定的位移场为 $\\mathbf{u}(\\mathbf{x}) = \\begin{pmatrix} u_x \\\\ u_y \\\\ u_z \\end{pmatrix} = \\begin{pmatrix} \\alpha x^{2} \\\\ \\beta x y \\\\ \\gamma z \\end{pmatrix}$。\n位移梯度张量 $\\nabla \\mathbf{u}$ 是一个二阶张量，其在笛卡尔坐标系中的分量由 $(\\nabla \\mathbf{u})_{ij} = \\frac{\\partial u_i}{\\partial x_j}$ 给出。\n\n各分量计算如下：\n$(\\nabla \\mathbf{u})_{11} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial}{\\partial x}(\\alpha x^{2}) = 2\\alpha x$\n$(\\nabla \\mathbf{u})_{12} = \\frac{\\partial u_x}{\\partial y} = \\frac{\\partial}{\\partial y}(\\alpha x^{2}) = 0$\n$(\\nabla \\mathbf{u})_{13} = \\frac{\\partial u_x}{\\partial z} = \\frac{\\partial}{\\partial z}(\\alpha x^{2}) = 0$\n$(\\nabla \\mathbf{u})_{21} = \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial}{\\partial x}(\\beta x y) = \\beta y$\n$(\\nabla \\mathbf{u})_{22} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial y}(\\beta x y) = \\beta x$\n$(\\nabla \\mathbf{u})_{23} = \\frac{\\partial u_y}{\\partial z} = \\frac{\\partial}{\\partial z}(\\beta x y) = 0$\n$(\\nabla \\mathbf{u})_{31} = \\frac{\\partial u_z}{\\partial x} = \\frac{\\partial}{\\partial x}(\\gamma z) = 0$\n$(\\nabla \\mathbf{u})_{32} = \\frac{\\partial u_z}{\\partial y} = \\frac{\\partial}{\\partial y}(\\gamma z) = 0$\n$(\\nabla \\mathbf{u})_{33} = \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial}{\\partial z}(\\gamma z) = \\gamma$\n\n将这些分量组合成矩阵，得到位移梯度：\n$$ \\nabla \\mathbf{u} = \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} $$\n无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 是 $\\nabla \\mathbf{u}$ 的对称部分：\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} + \\begin{pmatrix} 2\\alpha x  \\beta y  0 \\\\ 0  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\begin{pmatrix} 4\\alpha x  \\beta y  0 \\\\ \\beta y  2\\beta x  0 \\\\ 0  0  2\\gamma \\end{pmatrix} = \\begin{pmatrix} 2\\alpha x  \\frac{1}{2}\\beta y  0 \\\\ \\frac{1}{2}\\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} $$\n无穷小自旋张量 $\\boldsymbol{\\omega}$ 是 $\\nabla \\mathbf{u}$ 的反对称部分：\n$$ \\boldsymbol{\\omega} = \\frac{1}{2}\\left(\\nabla \\mathbf{u} - (\\nabla \\mathbf{u})^{T}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 2\\alpha x  0  0 \\\\ \\beta y  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} - \\begin{pmatrix} 2\\alpha x  \\beta y  0 \\\\ 0  \\beta x  0 \\\\ 0  0  \\gamma \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\omega} = \\frac{1}{2} \\begin{pmatrix} 0  -\\beta y  0 \\\\ \\beta y  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\frac{1}{2}\\beta y  0 \\\\ \\frac{1}{2}\\beta y  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n\n第 $2$ 部分：连续介质力学恒等式的验证。\n\n首先，计算位移场的散度 $\\nabla \\cdot \\mathbf{u}$：\n$$ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = 2\\alpha x + \\beta x + \\gamma = (2\\alpha + \\beta)x + \\gamma $$\n接下来，计算应变张量的迹 $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$：\n$$ \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = 2\\alpha x + \\beta x + \\gamma = (2\\alpha + \\beta)x + \\gamma $$\n比较这两个结果，我们验证了 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\nabla \\cdot \\mathbf{u}$。\n\n接下来，计算位移场的旋度 $\\nabla \\times \\mathbf{u}$：\n$$ \\nabla \\times \\mathbf{u} = \\begin{vmatrix} \\mathbf{e}_x  \\mathbf{e}_y  \\mathbf{e}_z \\\\ \\frac{\\partial}{\\partial x}  \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial z} \\\\ \\alpha x^{2}  \\beta x y  \\gamma z \\end{vmatrix} = \\left(\\frac{\\partial(\\gamma z)}{\\partial y} - \\frac{\\partial(\\beta x y)}{\\partial z}\\right)\\mathbf{e}_x - \\left(\\frac{\\partial(\\gamma z)}{\\partial x} - \\frac{\\partial(\\alpha x^2)}{\\partial z}\\right)\\mathbf{e}_y + \\left(\\frac{\\partial(\\beta x y)}{\\partial x} - \\frac{\\partial(\\alpha x^2)}{\\partial y}\\right)\\mathbf{e}_z $$\n$$ \\nabla \\times \\mathbf{u} = (0 - 0)\\mathbf{e}_x - (0 - 0)\\mathbf{e}_y + (\\beta y - 0)\\mathbf{e}_z = \\beta y \\mathbf{e}_z = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\beta y \\end{pmatrix} $$\n反对称张量 $\\boldsymbol{\\omega}$ 的轴向量 $\\boldsymbol{\\omega}_{\\text{ax}}$ 的分量为 $w_k = -\\frac{1}{2}\\epsilon_{ijk}\\omega_{ij}$，其中 $\\epsilon_{ijk}$ 是列维-奇维塔符号。\n$w_x = -\\frac{1}{2}(\\epsilon_{123}\\omega_{23} + \\epsilon_{132}\\omega_{32}) = -\\omega_{23} = 0$\n$w_y = -\\frac{1}{2}(\\epsilon_{213}\\omega_{13} + \\epsilon_{231}\\omega_{31}) = \\omega_{13} = 0$\n$w_z = -\\frac{1}{2}(\\epsilon_{312}\\omega_{12} + \\epsilon_{321}\\omega_{21}) = -\\omega_{12} = -(-\\frac{1}{2}\\beta y) = \\frac{1}{2}\\beta y$\n因此，轴向量为 $\\boldsymbol{\\omega}_{\\text{ax}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2}\\beta y \\end{pmatrix}$。\n我们需要验证 $\\boldsymbol{\\omega}_{\\text{ax}} = \\frac{1}{2}\\nabla \\times \\mathbf{u}$。\n$$ \\frac{1}{2}\\nabla \\times \\mathbf{u} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\beta y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2}\\beta y \\end{pmatrix} $$\n因此，对于给定的位移场，恒等式 $\\boldsymbol{\\omega}_{\\text{ax}} = \\frac{1}{2}\\nabla \\times \\mathbf{u}$ 得到了明确的验证。\n\n第 $3$ 部分：标量不变量 $S(x,y,z)$ 的计算。\n\n标量不变量定义为 $S(x,y,z) := \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2}$。\n从第 $2$ 部分可知 $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = (2\\alpha + \\beta)x + \\gamma$。\n轴向量 $\\boldsymbol{\\omega}_{\\text{ax}}$ 的欧几里得范数是：\n$$ \\|\\boldsymbol{\\omega}_{\\text{ax}}\\|_{2} = \\sqrt{w_x^2 + w_y^2 + w_z^2} = \\sqrt{0^2 + 0^2 + \\left(\\frac{1}{2}\\beta y\\right)^2} = \\sqrt{\\left(\\frac{1}{2}\\beta y\\right)^2} = \\left|\\frac{1}{2}\\beta y\\right| $$\n将这些表达式代入 $S(x,y,z)$ 的定义中：\n$$ S(x,y,z) = (2\\alpha + \\beta)x + \\gamma + \\left|\\frac{1}{2}\\beta y\\right| $$\n\n关于空间变化和物理合理性的简要评论：\n应变张量 $\\boldsymbol{\\varepsilon}$ 和自旋张量 $\\boldsymbol{\\omega}$ 的分量是空间坐标 $x$ 和 $y$ 的函数，这表明变形是非均匀的。体积应变 $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ 随 $x$ 线性变化，意味着材料在不同 $x$ 坐标处的切片会以不同程度膨胀或收缩。由 $\\boldsymbol{\\omega}_{\\text{ax}}$ 表示的局部旋转随 $y$ 线性变化，且始终沿 $z$ 轴方向。\n小应变假设要求位移梯度张量 $\\nabla \\mathbf{u}$ 的分量大小远小于 $1$，即 $|\\nabla \\mathbf{u}_{ij}| \\ll 1$。由于诸如 $(\\nabla \\mathbf{u})_{11}=2\\alpha x$ 和 $(\\nabla \\mathbf{u})_{21}=\\beta y$ 等分量随坐标线性增长，因此该假设只能在原点 $(0,0,0)$ 附近一个足够小的区域内成立。因此，该位移场仅在物理上可作为小材料邻域内变形的局部近似。", "answer": "$$\n\\boxed{(2\\alpha + \\beta)x + \\gamma + \\frac{1}{2}|\\beta y|}\n$$", "id": "3568721"}, {"introduction": "矢量微积分中一个至关重要的恒等式指出，任何标量场的梯度的旋度恒为零（$\\nabla \\times \\nabla d = \\mathbf{0}$），这表明梯度场是无旋的。本练习不仅要求您为一个特定的标量场证明这个恒等式，还要探讨其在计算力学中的深远意义。理解为什么这个解析上的真理在数值近似中可能不成立，是开发和诊断稳健的模拟工具（尤其是在梯度损伤力学等前沿领域）的关键。[@problem_id:3568747]", "problem": "考虑施加于有界开区域 $\\Omega \\subset \\mathbb{R}^{3}$ 上的梯度损伤正则化，其中损伤场 $d(\\mathbf{x})$ 被视为一个无量纲标量，并假定其足够光滑。设\n$$\nd(x,y,z) \\;=\\; \\alpha\\, x^{3}y^{2} \\;+\\; \\beta\\, x y z \\;+\\; \\gamma\\, \\sin(xy) \\;+\\; \\delta\\, \\cos(z),\n$$\n其中 $\\alpha,\\beta,\\gamma,\\delta \\in \\mathbb{R}$ 为常数，且 $(x,y,z) \\in \\Omega$。您将通过分析量 $\\nabla \\times \\nabla d$ 来研究一个与梯度损伤模型的计算实现相关的一致性诊断。\n\n任务：\n\n1. 严格地从 $\\mathbb{R}^{3}$ 中梯度和旋度算子的分量形式定义出发，计算上述 $d(x,y,z)$ 的 $\\nabla \\times \\nabla d$。在您的推导中，仅使用“对于足够光滑的函数，其混合二阶偏导数相等”这一基本事实。陈述使您的简化成立的对 $d$ 的最小光滑性假设。\n\n2. 定义标量诊断\n$$\nJ \\;=\\; \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega.\n$$\n使用任务1的结果，在任意有界区域 $\\Omega$ 上为给定的 $d(x,y,z)$ 精确计算 $J$，并为一致的梯度损伤计算对结果进行物理解释。\n\n3. 简要解释在一个采用四面体网格和 $C^{0}$ 连续分片线性插值来近似 $d$ 的有限元方法 (FEM) 实现中，对 $\\nabla \\times \\nabla d_{h}$ 的经典（单元内）计算为何可能无法揭示数值伪影，并使用第一性原理指出，在分布意义上非零贡献源于何处。\n\n最终数值报告说明：将所有量视为无量纲。将 $J$ 的最终值表示为无舍入的精确数。最终报告值不带单位。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 第1步：提取已知条件\n- 区域：一个有界开区域 $\\Omega \\subset \\mathbb{R}^{3}$。\n- 损伤场：一个假定足够光滑的无量纲标量场 $d(\\mathbf{x})$。\n- 损伤场的函数形式：$d(x,y,z) = \\alpha\\, x^{3}y^{2} + \\beta\\, x y z + \\gamma\\, \\sin(xy) + \\delta\\, \\cos(z)$。\n- 常数：$\\alpha,\\beta,\\gamma,\\delta \\in \\mathbb{R}$。\n- 位置向量：$(x,y,z) \\in \\Omega$。\n- 待分析的量：$\\nabla \\times \\nabla d$。\n- 标量诊断：$J = \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega$。\n- 任务1：从分量形式定义出发计算 $\\nabla \\times \\nabla d$，并使用混合偏导数的相等性。陈述最小光滑性假设。\n- 任务2：计算 $J$ 并解释结果。\n- 任务3：解释在 $C^{0}$ 有限元上下文中经典单元内计算 $\\nabla \\times \\nabla d_{h}$ 的失效，以及在分布意义上非零贡献的来源。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于矢量微积分的基本原理，特别是任何足够光滑的标量场的梯度的旋度为零这一恒等式。它将此概念应用于计算固体力学的一个相关领域（梯度损伤模型），并探讨了其对数值方法（FEM）的影响。这些概念是标准的，并且在科学上是合理的。\n- **适定性**：问题清晰地分为三个不同的任务。函数 $d(x,y,z)$ 被明确给出，待计算的量 $J$ 和 $\\nabla \\times \\nabla d$ 也被明确定义。第三个任务要求基于数值分析的既定原则进行概念性解释。所有部分都存在唯一且有意义的解。\n- **客观性**：问题使用精确的数学和技术语言陈述，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：问题提供了所有必要的信息。函数 $d(x,y,z)$ 定义明确。算子 $\\nabla$ 和 $\\nabla \\times$ 是标准的。不存在内部矛盾。\n- **结论**：该问题是有效的。它在科学上是合理的、适定的、客观的且自洽的。\n\n### 任务1：计算 $\\nabla \\times \\nabla d$\n\n在笛卡尔坐标系 $(x,y,z)$ 中，梯度和旋度算子定义为：\n$$\n\\nabla f = \\frac{\\partial f}{\\partial x}\\hat{\\mathbf{i}} + \\frac{\\partial f}{\\partial y}\\hat{\\mathbf{j}} + \\frac{\\partial f}{\\partial z}\\hat{\\mathbf{k}}\n$$\n$$\n\\nabla \\times \\mathbf{F} = \\left( \\frac{\\partial F_z}{\\partial y} - \\frac{\\partial F_y}{\\partial z} \\right) \\hat{\\mathbf{i}} + \\left( \\frac{\\partial F_x}{\\partial z} - \\frac{\\partial F_z}{\\partial x} \\right) \\hat{\\mathbf{j}} + \\left( \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} \\right) \\hat{\\mathbf{k}}\n$$\n其中 $f$ 是一个标量场，$\\mathbf{F} = F_x \\hat{\\mathbf{i}} + F_y \\hat{\\mathbf{j}} + F_z \\hat{\\mathbf{k}}$ 是一个矢量场。\n\n我们被要求计算 $\\nabla \\times (\\nabla d)$。设矢量场 $\\mathbf{F}$ 是标量场 $d$ 的梯度，即 $\\mathbf{F} = \\nabla d$。$\\mathbf{F}$ 的分量为：\n$$\nF_x = \\frac{\\partial d}{\\partial x}, \\quad F_y = \\frac{\\partial d}{\\partial y}, \\quad F_z = \\frac{\\partial d}{\\partial z}\n$$\n将这些代入旋度的定义，我们得到梯度旋度的一般表达式：\n$$\n\\nabla \\times (\\nabla d) = \\left( \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial z}\\right) - \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial d}{\\partial y}\\right) \\right) \\hat{\\mathbf{i}} + \\left( \\frac{\\partial}{\\partial z}\\left(\\frac{\\partial d}{\\partial x}\\right) - \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial z}\\right) \\right) \\hat{\\mathbf{j}} + \\left( \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial y}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial x}\\right) \\right) \\hat{\\mathbf{k}}\n$$\n这可以用偏导数的下标表示法写成：\n$$\n\\nabla \\times (\\nabla d) = (d_{zy} - d_{yz})\\hat{\\mathbf{i}} + (d_{xz} - d_{zx})\\hat{\\mathbf{j}} + (d_{yx} - d_{xy})\\hat{\\mathbf{k}}\n$$\n问题要求使用对于足够光滑函数的混合二阶偏导数相等这一性质。这是 Clairaut 定理，该定理指出，如果函数 $d$ 在某点的一个邻域内具有连续的二阶偏导数，那么求导的顺序无关紧要，即 $\\frac{\\partial^2 d}{\\partial x_i \\partial x_j} = \\frac{\\partial^2 d}{\\partial x_j \\partial x_i}$。该定理成立的最小光滑性假设是函数 $d$ 必须是 $C^2$ 类的（其二阶偏导数存在且连续）。\n\n给定的损伤场 $d(x,y,z) = \\alpha\\, x^{3}y^{2} + \\beta\\, x y z + \\gamma\\, \\sin(xy) + \\delta\\, \\cos(z)$ 由多项式和三角函数 sin 和 cos 组成。这些函数在整个 $\\mathbb{R}^3$ 上是无限可微的（$C^{\\infty}$）。因此，函数 $d$ 是 $C^{\\infty}$ 类的，这比要求的 $C^2$ 条件要光滑得多。\n\n因此，对于给定的函数 $d$：\n$$\n\\frac{\\partial^2 d}{\\partial y \\partial z} = \\frac{\\partial^2 d}{\\partial z \\partial y}, \\quad \\frac{\\partial^2 d}{\\partial z \\partial x} = \\frac{\\partial^2 d}{\\partial x \\partial z}, \\quad \\frac{\\partial^2 d}{\\partial x \\partial y} = \\frac{\\partial^2 d}{\\partial y \\partial x}\n$$\n这意味着 $\\nabla \\times (\\nabla d)$ 的每个分量都为零。\n$$\n\\nabla \\times (\\nabla d) = (0)\\hat{\\mathbf{i}} + (0)\\hat{\\mathbf{j}} + (0)\\hat{\\mathbf{k}} = \\mathbf{0}\n$$\n对于任何 $C^2$ 标量场，这是一个普遍结果，通常由矢量恒等式 $\\nabla \\times \\nabla d \\equiv \\mathbf{0}$ 概括。对所提供的特定 $d(x,y,z)$ 进行计算，仅仅是作为对该恒等式的一个具体验证。\n\n为明确起见，我们为给定的 $d$ 计算其导数：\n首先，梯度 $\\nabla d$：\n$$\n\\frac{\\partial d}{\\partial x} = 3\\alpha x^2 y^2 + \\beta y z + \\gamma y \\cos(xy)\n$$\n$$\n\\frac{\\partial d}{\\partial y} = 2\\alpha x^3 y + \\beta x z + \\gamma x \\cos(xy)\n$$\n$$\n\\frac{\\partial d}{\\partial z} = \\beta x y - \\delta \\sin(z)\n$$\n现在，计算旋度的 z-分量的混合二阶偏导数：\n$$\n\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial d}{\\partial y}\\right) = \\frac{\\partial}{\\partial x}(2\\alpha x^3 y + \\beta x z + \\gamma x \\cos(xy)) = 6\\alpha x^2 y + \\beta z + \\gamma \\cos(xy) - \\gamma xy \\sin(xy)\n$$\n$$\n\\frac{\\partial}{\\partial y}\\left(\\frac{\\partial d}{\\partial x}\\right) = \\frac{\\partial}{\\partial y}(3\\alpha x^2 y^2 + \\beta y z + \\gamma y \\cos(xy)) = 6\\alpha x^2 y + \\beta z + \\gamma \\cos(xy) - \\gamma xy \\sin(xy)\n$$\n它们相等，所以 z-分量为零。其他混合偏导数对的相等性可类似得出。\n\n### 任务2：$J$ 的计算与解释\n\n标量诊断定义为：\n$$\nJ = \\int_{\\Omega} \\left| \\nabla \\times \\nabla d(\\mathbf{x}) \\right|^{2} \\, \\mathrm{d}\\Omega\n$$\n根据任务1的结果，我们确定对于给定的足够光滑的标量场 $d(x,y,z)$，量 $\\nabla \\times \\nabla d$ 恒为零向量 $\\mathbf{0}$。\n$$\n\\nabla \\times \\nabla d(\\mathbf{x}) = \\mathbf{0} \\quad \\forall \\mathbf{x} \\in \\Omega\n$$\n将此代入 $J$ 的定义：\n$$\nJ = \\int_{\\Omega} |\\mathbf{0}|^{2} \\, \\mathrm{d}\\Omega = \\int_{\\Omega} 0 \\, \\mathrm{d}\\Omega\n$$\n零在任何有界区域 $\\Omega$ 上的积分都为零。\n$$\nJ = 0\n$$\n物理解释：恒等式 $\\nabla \\times \\nabla d = \\mathbf{0}$ 意味着任何可以表示为标量势的梯度（一个保守场）的矢量场都是无旋的（旋度为零）。在连续介质力学的背景下，这是一个基本的一致性条件。积分 $J$ 表示在区域 $\\Omega$ 上“不一致性”的平方大小的总和。$J=0$ 的值表示完全一致。在计算实现中，微分算子是近似的。由于离散化误差，数值梯度的数值旋度的近似值 $\\nabla_h \\times \\nabla_h d_h$ 可能不完全为零。因此，$J$ 是一个强大的诊断工具：在模拟中，$J$ 的非零值表示数值方案未能保持这一基本矢量恒等式，并标志着计算中一致性的丧失。一个稳健的梯度损伤模型数值方法应确保 $J$ 为零，或者至少在网格细化下以适当的速率趋近于零。\n\n### 任务3：有限元方法 (FEM) 实现\n\n在一个采用四面体网格上的 $C^0$ 连续分片线性插值来近似损伤场 $d$ 的有限元方法 (FEM) 实现中，离散近似表示为 $d_h(\\mathbf{x})$。\n1.  **$C^0$ 连续性与分片线性**：$C^0$ 连续性意味着函数 $d_h$ 在相邻四面体的面上是连续的，但其导数（即其梯度）不保证连续。在单个四面体（单元 $e$）内，线性插值的形式为 $d_h(\\mathbf{x}) = a_e + b_e x + c_e y + f_e z$，其中系数对于该单元是常数。\n2.  **单元内梯度**：$d_h$ 在单元 $e$ 内的梯度是 $\\nabla d_h(\\mathbf{x}) = b_e \\hat{\\mathbf{i}} + c_e \\hat{\\mathbf{j}} + f_e \\hat{\\mathbf{k}}$。这是每个单元内的一个常矢量场。\n3.  **经典单元内旋度**：任何常矢量场的旋度恒为零。因此，如果通过在每个单元*内部*应用旋度算子来计算 $\\nabla \\times (\\nabla d_h)$，则在所有单元的内部，结果处处为 $\\mathbf{0}$。这就是问题中提到的“经典（单元内）计算”。这种计算具有误导性，因为它完全忽略了单元界面上的行为，并且会错误地暗示完全一致性（$J=0$）。\n4.  **非零贡献的分布来源**：场 $\\nabla d_h$ 是一个*分片常数*矢量场。它在每个四面体内是常数，但通常在相邻四面体的共享面上存在跳跃间断。分布理论为对这类函数求导提供了框架。具有跳跃间断的函数的导数包含一个支撑在跳跃面上的狄拉克δ函数。\n5.  **分布意义上的旋度**：让我们考虑由两个单元 $e_i$ 和 $e_j$ 共享的、单位法向量为 $\\mathbf{n}$ 的面 $S_{ij}$。这些单元中的梯度向量是常数但不同：$\\mathbf{g}_i = (\\nabla d_h)|_{e_i}$ 和 $\\mathbf{g}_j = (\\nabla d_h)|_{e_j}$。梯度穿过该面的跳跃为 $[\\![\\nabla d_h]\\!] = \\mathbf{g}_j - \\mathbf{g}_i$。在分布意义上，不连续场 $\\nabla d_h$ 的旋度不为零。它包含一个集中在网格面上的奇异部分。这个奇异部分可以（使用广义 Stokes 定理）表示为：\n$$\n(\\nabla \\times \\nabla d_h)_{\\text{singular}} = \\sum_{\\text{faces } S_{ij}} (\\mathbf{n} \\times [\\![\\nabla d_h]\\!])_S \\delta_S\n$$\n其中 $\\delta_S$ 是一个表面狄拉克δ分布。项 $\\mathbf{n} \\times [\\![\\nabla d_h]\\!]$ 表示梯度场的切向分量穿过该面的跳跃。\n6.  **结论**：对真实的、分布意义上的 $\\nabla \\times \\nabla d_h$ 的非零贡献源于梯度场 $\\nabla d_h$ 在单元间界面上的跳跃间断。单元内的计算对此是“盲目”的，因为它只看到单元内部的常数场（因此是无旋场）。正是 $C^0$ 单元未能强制梯度的连续性，才造成了这种数值伪影，如果以一种能考虑这些单元间贡献的方式正确计算 $J$，将导致其值非零。在梯度或旋度协调性至关重要的问题中，这是使用高阶单元或混合有限元方法的一个主要动机。", "answer": "$$\n\\boxed{0}\n$$", "id": "3568747"}, {"introduction": "散度定理在体积内场的局部行为（其散度）与其在边界上的行为（其通量）之间架起了一座强大的桥梁。在固体力学中，该定理将内部体力与表面牵引力联系起来。本练习将从解析理论转向计算验证，要求您在一个具有复杂、空间变化的属性（这是实际模拟中的常见情况）的物体中，对柯西应力张量的散度定理进行数值验证。[@problem_id:3568743]", "problem": "考虑在小应变、各向同性、线性弹性的平面应变运动学条件下，对二维二阶张量场的散度定理（高斯定理）进行验证。对于一个有界且足够光滑的域 $\\Omega \\subset \\mathbb{R}^2$，其边界为 $\\partial \\Omega$，外单位法向量为 $\\mathbf{n}$，二阶张量场的散度定理指出以下恒等式成立：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{\\sigma} \\, d\\Omega \\;=\\; \\int_{\\partial \\Omega} \\boldsymbol{\\sigma} \\, \\mathbf{n} \\, dS,\n$$\n其中 $\\boldsymbol{\\sigma}(x,y)$ 是 Cauchy 应力张量，$\\nabla \\cdot \\boldsymbol{\\sigma}$ 是对 $\\boldsymbol{\\sigma}$ 按行求的散度（产生一个向量场）。目标是根据给定位移场重构的非均匀材料属性，对这两个积分进行数值计算并进行比较。\n\n使用以下建模假设和定义作为基本基础：\n- 小应变运动学：无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 定义为\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1}{2}\\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top} \\right),\n$$\n其中位移场为 $\\mathbf{u} = [u(x,y), v(x,y)]^{\\top}$。\n- 平面应变下的各向同性线性弹性：应力-应变关系为\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} \\;+\\; 2\\mu \\, \\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathrm{tr}(\\boldsymbol{\\varepsilon})$ 是 $\\boldsymbol{\\varepsilon}$ 的迹，$\\mathbf{I}$ 是单位张量，$\\lambda(x,y)$ 和 $\\mu(x,y)$ 是与位置相关的 Lamé 参数，通过杨氏模量 $E(x,y)$ 和泊松比 $\\nu(x,y)$ 定义为\n$$\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)}, \\qquad \\lambda \\;=\\; \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}.\n$$\n- 作用于 $\\boldsymbol{\\sigma}$ 的散度算子产生一个向量场\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} \\\\\n\\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\n\\end{bmatrix}.\n$$\n\n设计算域为单位正方形\n$$\n\\Omega \\;=\\; [0,1]\\times[0,1],\n$$\n其边界 $\\partial \\Omega$ 由四条边组成，外单位法向量分别为\n$$\n\\mathbf{n}_{\\text{left}} = [-1,0]^{\\top},\\quad \\mathbf{n}_{\\text{right}} = [1,0]^{\\top},\\quad \\mathbf{n}_{\\text{bottom}} = [0,-1]^{\\top},\\quad \\mathbf{n}_{\\text{top}} = [0,1]^{\\top}.\n$$\n\n给定两个位移场来重构 $\\boldsymbol{\\sigma}(x,y)$：\n1. 一个光滑的非多项式场，用于检验非均匀弹性：\n$$\nu(x,y) \\;=\\; \\sin(\\pi x)\\sin(\\pi y) \\;+\\; 0.1\\,x^2, \\qquad v(x,y) \\;=\\; \\cos(\\pi x)\\sin(\\pi y) \\;+\\; 0.05\\, x y.\n$$\n2. 一个用于常应力基准的线性场：\n$$\nu(x,y) \\;=\\; \\alpha x, \\qquad v(x,y) \\;=\\; \\beta y,\n$$\n其中常数 $\\alpha = 0.3$ 和 $\\beta = -0.2$。\n\n给定一般情况下的非均匀材料属性：\n$$\nE(x,y) \\;=\\; E_0 \\left( 1 \\;+\\; 0.3\\, x \\;+\\; 0.2\\, y \\;+\\; 0.1 \\sin(2\\pi x)\\cos(2\\pi y) \\right), \\qquad E_0 \\;=\\; 1000,\n$$\n$$\n\\nu(x,y) \\;=\\; \\nu_0 \\;+\\; 0.05 \\sin(\\pi x)\\sin(\\pi y), \\qquad \\nu_0 \\;=\\; 0.3,\n$$\n对于基准情况，使用常数 $E(x,y) = E_0$ 和 $\\nu(x,y) = \\nu_0$。所有三角函数均使用弧度。\n\n数值计算以下两个向量值积分：\n- 散度的体积分：\n$$\n\\mathbf{I}_{\\Omega} \\;=\\; \\int_{\\Omega} \\nabla \\cdot \\boldsymbol{\\sigma} \\, d\\Omega,\n$$\n- 牵引力的边值积分：\n$$\n\\mathbf{I}_{\\partial \\Omega} \\;=\\; \\int_{\\partial \\Omega} \\boldsymbol{\\sigma}\\, \\mathbf{n} \\, dS \\;=\\; \\sum_{\\text{edges}} \\int_{\\text{edge}} \\boldsymbol{\\sigma}\\, \\mathbf{n}_{\\text{edge}} \\, d\\ell.\n$$\n\n使用张量微积分定义和链式法则，从给定的 $\\mathbf{u}(x,y)$ 以及空间变化的 $\\lambda(x,y)$ 和 $\\mu(x,y)$ 解析地计算 $\\nabla \\cdot \\boldsymbol{\\sigma}$，然后执行数值积分来近似积分值。对于求积，在 $\\Omega$ 上使用阶数为 $q_{\\Omega}$ 的张量积 Gauss–Legendre 求积，在 $\\partial \\Omega$ 的每条边上使用阶数为 $q_{\\partial \\Omega}$ 的一维 Gauss–Legendre 求积，两者都映射到 $[0,1]$。\n\n设计一个程序，针对指定的参数集，计算绝对误差范数\n$$\n\\varepsilon \\;=\\; \\left\\| \\mathbf{I}_{\\Omega} \\;-\\; \\mathbf{I}_{\\partial \\Omega} \\right\\|_2,\n$$\n其中 $\\|\\cdot\\|_2$ 表示欧几里得范数。程序必须精确实现上述本构关系和运动学，并评估求积阶数的影响。\n\n测试套件：\n- 情况 $1$：非均匀 $E(x,y), \\nu(x,y)$ 与光滑位移场，$q_{\\Omega} = 5$，$q_{\\partial \\Omega} = 5$。\n- 情况 $2$：非均匀 $E(x,y), \\nu(x,y)$ 与光滑位移场，$q_{\\Omega} = 1$，$q_{\\partial \\Omega} = 1$。\n- 情况 $3$：非均匀 $E(x,y), \\nu(x,y)$ 与光滑位移场，$q_{\\Omega} = 10$，$q_{\\partial \\Omega} = 10$。\n- 情况 $4$：常数 $E(x,y) = E_0$，常数 $\\nu(x,y) = \\nu_0$ 与线性位移场（$\\alpha = 0.3$，$\\beta = -0.2$），$q_{\\Omega} = 2$，$q_{\\partial \\Omega} = 2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按情况 $1$ 到 $4$ 的顺序列出结果，例如 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$。所有值都是无量纲的。所有三角函数求值必须使用弧度。不应需要用户输入；程序必须能直接运行。", "solution": "用户要求在二维平面应变线性弹性的背景下，对二阶张量场的散度定理进行数值验证。\n\n### 步骤 1：问题验证\n\n我已仔细审阅了问题陈述。\n\n#### 提取的已知条件：\n- **定理：** 张量 $\\boldsymbol{\\sigma}$ 的散度定理：$\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{\\sigma} d\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{\\sigma} \\mathbf{n} dS$。\n- **物理模型：** 小应变、各向同性、线性弹性以及平面应变。\n- **本构律：** $\\boldsymbol{\\sigma} = \\lambda \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}$，其中 Lamé 参数 $\\lambda(x,y)$ 和 $\\mu(x,y)$ 与位置相关，由杨氏模量 $E(x,y)$ 和泊松比 $\\nu(x,y)$ 导出。\n- **运动学：** $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top})$。\n- **散度定义：** 按行求散度，$(\\nabla \\cdot \\boldsymbol{\\sigma})_i = \\sum_j \\frac{\\partial \\sigma_{ij}}{\\partial x_j}$。\n- **域：** 单位正方形 $\\Omega = [0,1]\\times[0,1]$。\n- **位移场：** 给定一个光滑的非多项式场和一个线性场。\n- **材料属性：** 给定了非均匀、与位置相关的函数 $E(x,y)$ 和 $\\nu(x,y)$，以及一个常数属性的情况。\n- **任务：** 数值计算体积分 $\\mathbf{I}_{\\Omega} = \\int_{\\Omega} \\nabla \\cdot \\boldsymbol{\\sigma} d\\Omega$ 和边值积分 $\\mathbf{I}_{\\partial \\Omega} = \\int_{\\partial \\Omega} \\boldsymbol{\\sigma} \\mathbf{n} dS$。\n- **数值方法：** 解析推导被积函数 $\\nabla \\cdot \\boldsymbol{\\sigma}$，并对两个积分使用 Gauss-Legendre 求积法。为每种情况指定了求积阶数 $q_{\\Omega}$ 和 $q_{\\partial \\Omega}$。\n- **输出：** 计算差值的欧几里得范数 $\\varepsilon = \\| \\mathbf{I}_{\\Omega} - \\mathbf{I}_{\\partial \\Omega} \\|_2$，针对四种特定的测试情况。\n\n#### 验证结论：\n问题被判定为**有效**。\n- **科学依据充分：** 问题基于连续介质力学和向量微积分的基本原理。定义的材料属性函数 $\\nu(x,y)$ 和 $E(x,y)$ 在整个域内保持在物理上现实的范围内（例如，$E  0$ 且 $\\nu$ 不为 $0.5$）。\n- **适定的：** 所有函数、常数和边界条件都已明确定义。任务是执行数值计算，在给定方法下会产生唯一的结果。\n- **客观的：** 问题以精确的数学语言陈述，没有任何模糊性或主观性。\n- **完整性与一致性：** 问题是自洽的。所有必要的方程和参数都已提供。没有内部矛盾。\n- **可行性：** 所需的符号微分虽然繁多但可以处理。指定的数值方法（Gauss-Legendre 求积）是标准的，并且在计算上是可行的。问题包含一个更简单的基准情况（情况 4），这可以作为一个极好的合理性检查，因为该情况的精确结果是误差为零。\n\n问题表述严谨，是计算力学领域一个有效的练习。我现在将着手解决。\n\n### 步骤 2：求解推导\n\n求解需要按所述实现数学模型和数值积分程序。任务的核心是计算体积分和边值积分的被积函数。\n\n#### 体积分的被积函数\n体积分是 $\\mathbf{I}_{\\Omega} = \\int_{\\Omega} \\nabla \\cdot \\boldsymbol{\\sigma} d\\Omega$。被积函数是向量场 $\\nabla \\cdot \\boldsymbol{\\sigma}$，其分量为：\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y}\n$$\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\n$$\n鉴于材料属性 $\\lambda(x,y)$ 和 $\\mu(x,y)$ 是空间变化的，必须应用链式法则来对应力分量进行微分：\n$$\n\\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{xx}\n$$\n$$\n\\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{yy}\n$$\n$$\n\\sigma_{xy} = \\sigma_{yx} = 2\\mu\\varepsilon_{xy}\n$$\n导数变为：\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} = \\frac{\\partial \\lambda}{\\partial x}\\mathrm{tr}(\\boldsymbol{\\varepsilon}) + \\lambda \\frac{\\partial \\mathrm{tr}(\\boldsymbol{\\varepsilon})}{\\partial x} + 2\\frac{\\partial \\mu}{\\partial x}\\varepsilon_{xx} + 2\\mu \\frac{\\partial \\varepsilon_{xx}}{\\partial x}\n$$\n$$\n\\frac{\\partial \\sigma_{xy}}{\\partial y} = 2\\frac{\\partial \\mu}{\\partial y}\\varepsilon_{xy} + 2\\mu \\frac{\\partial \\varepsilon_{xy}}{\\partial y}\n$$\n对于散度的 $y$-分量，情况类似。这需要计算 Lamé 参数的一阶导数和应变分量的一阶导数。应变的导数（例如 $\\partial \\varepsilon_{xx} / \\partial x$）又需要位移场分量 $u(x,y)$ 和 $v(x,y)$ 的二阶导数。Lamé 参数的导数（例如 $\\partial \\lambda / \\partial x$）需要 $E(x,y)$ 和 $\\nu(x,y)$ 的一阶导数。所有这些基本函数及其导数均已提供或可解析推导。实现时将在每个求积点系统地计算所有这些量。\n\n#### 边值积分的被积函数\n边值积分是 $\\mathbf{I}_{\\partial \\Omega} = \\int_{\\partial \\Omega} \\mathbf{t} dS$，其中 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ 是牵引力向量。这被计算为单位正方形四条边上积分的总和：\n$\\mathbf{I}_{\\partial\\Omega} = \\int_0^1 \\boldsymbol{\\sigma}(1,y)\\begin{bmatrix}1\\\\0\\end{bmatrix}dy + \\int_0^1 \\boldsymbol{\\sigma}(0,y)\\begin{bmatrix}-1\\\\0\\end{bmatrix}dy + \\int_0^1 \\boldsymbol{\\sigma}(x,1)\\begin{bmatrix}0\\\\1\\end{bmatrix}dx + \\int_0^1 \\boldsymbol{\\sigma}(x,0)\\begin{bmatrix}0\\\\-1\\end{bmatrix}dx$\n$$\n\\mathbf{I}_{\\partial\\Omega} = \\int_0^1 \\begin{bmatrix} \\sigma_{xx}(1,y) \\\\ \\sigma_{yx}(1,y) \\end{bmatrix} dy + \\int_0^1 \\begin{bmatrix} -\\sigma_{xx}(0,y) \\\\ -\\sigma_{yx}(0,y) \\end{bmatrix} dy + \\int_0^1 \\begin{bmatrix} \\sigma_{xy}(x,1) \\\\ \\sigma_{yy}(x,1) \\end{bmatrix} dx + \\int_0^1 \\begin{bmatrix} -\\sigma_{xy}(x,0) \\\\ -\\sigma_{yy}(x,0) \\end{bmatrix} dx\n$$\n这里的被积函数是应力张量 $\\boldsymbol{\\sigma}$ 的分量，在边界上求值。这需要计算位移及其一阶导数以求得应变 $\\boldsymbol{\\varepsilon}$，以及材料属性 $E$ 和 $\\nu$ 以求得 $\\lambda$ 和 $\\mu$，所有这些都在边界求积点上进行求值。\n\n#### 数值求积\n两个积分都使用 Gauss-Legendre 求积法来近似。对于一维积分 $\\int_0^1 f(z) dz$，近似值为：\n$$\n\\int_0^1 f(z) dz \\approx \\frac{1}{2} \\sum_{i=1}^{q} w_i f\\left(\\frac{\\xi_i+1}{2}\\right)\n$$\n其中 $(\\xi_i, w_i)$ 是 $[-1, 1]$ 上的 Gauss 点和权重。\n对于 $[0,1]\\times[0,1]$ 上的二维体积分，使用张量积法则：\n$$\n\\int_0^1 \\int_0^1 \\mathbf{g}(x,y) dx dy \\approx \\frac{1}{4} \\sum_{i=1}^{q_\\Omega} \\sum_{j=1}^{q_\\Omega} w_i w_j \\mathbf{g}\\left(\\frac{\\xi_i+1}{2}, \\frac{\\xi_j+1}{2}\\right)\n$$\n因子 $\\frac{1}{2}$ 和 $\\frac{1}{4}$ 是从规范区间/正方形到积分域的变换的雅可比行列式。\n\n#### 程序结构\n实现结构如下：\n1. 一个函数 `calculate_state(x, y, funcs)`：接受一个点 $(x,y)$ 和一个包含解析函数（用于 $u, v, E, \\nu$ 及其导数）的字典 `funcs`。它计算并返回该点的所有必要力学量：应力张量 $\\boldsymbol{\\sigma}$ 及其散度 $\\nabla \\cdot \\boldsymbol{\\sigma}$。这将复杂的物理计算模块化。\n2. 函数 `compute_volume_integral` 和 `compute_boundary_integral`：这些函数实现 Gauss-Legendre 求积方案。它们遍历 Gauss 点，调用 `calculate_state` 获取被积函数的值，并执行加权求和。\n3. 一个主函数 `solve`：为四个测试用例中的每一个定义具体参数（包括解析函数的字典），调用积分程序计算 $\\mathbf{I}_{\\Omega}$ 和 $\\mathbf{I}_{\\partial \\Omega}$，计算最终的误差范数 $\\varepsilon$，并格式化输出。\n\n对于情况 4（线性位移，常数属性），应变和材料属性的导数为零。这导致 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$，因此 $\\mathbf{I}_{\\Omega} = \\mathbf{0}$。边值积分 $\\mathbf{I}_{\\partial \\Omega}$ 的解析解也为 $\\mathbf{0}$。因此，数值误差 $\\varepsilon_4$ 预计将接近机器零，可作为对实现正确性的验证。对于其他情况，随着求积阶数从情况 2 ($q=1$) 增加到情况 1 ($q=5$) 再到情况 3 ($q=10$)，误差预计会减小。", "answer": "[1.328328178652391e-05,53.48937000854497,2.2033088926448347e-11,0.0]", "id": "3568743"}]}