## 引言
在计算材料科学的宏伟蓝图中，从单个原子的量子行为到材料整体的宏观响应，无数物理现象都由复杂的[微分方程](@entry_id:264184)所支配。然而，解析解在现实世界中寥寥无几，我们更多时候面对的是离散的模拟数据点或无法直接求解的方程。如何从这些离散信息中精确提取导数（如力、通量），或通过积分计算总能量、[电子态密度](@entry_id:182354)等宏观量，便成为连接理论模型与可预测物理世界的关键。数值[微分与积分](@entry_id:141565)为解决这一核心挑战提供了强大而系统的工具箱。

本文旨在为读者构建一个关于数值[微分与积分](@entry_id:141565)的完整知识框架，从底层原理到前沿应用。
- 在“**原理与机制**”一章中，我们将回归本源，从[泰勒级数](@entry_id:147154)出发，系统地构建[有限差分法](@entry_id:147158)，并深入剖析[截断误差与舍入误差](@entry_id:164039)之间微妙的平衡。我们还将探索适用于周期性体系的[谱方法](@entry_id:141737)，以及通过优化节点实现惊人效率的高斯求积等高级技术。
- 随后，在“**应用与交叉学科联系**”一章中，我们将把理论付诸实践。通过一系列生动的案例，您将看到这些数值方法如何被用于计算材料的自由能、弹性常数、[电子结构](@entry_id:145158)和陈数，以及如何利用辛[积分算法](@entry_id:192581)保证分子动力学模拟的长期稳定性。
- 最后，在“**动手实践**”部分，您将有机会通过解决具体问题来巩固所学知识，亲手推导差分格式、处理真实计算中的挑战，从而将理论内化为自己的技能。

通过这一系列的学习，您不仅将掌握数值[微分与积分](@entry_id:141565)的“如何做”，更将理解其背后的“为什么”，从而在未来的研究中能够游刃有余地选择和应用最合适的数值工具。

## 原理与机制

在计算材料科学中，从[电子结构计算](@entry_id:748901)到宏观连续介质模型，[数值微分](@entry_id:144452)和积分是不可或缺的基本工具。它们使我们能够求解控制材料行为的[微分方程](@entry_id:264184)，并从离散数据中提取物理上有意义的量，如力、通量和总能量。本章旨在深入探讨这些数值方法背后的核心原理与机制，揭示其准确性、效率和局限性。我们将从泰勒级数这一基石出发，系统地构建[有限差分法](@entry_id:147158)，并探讨在实践中遇到的[截断误差与舍入误差](@entry_id:164039)之间的微妙权衡。随后，我们将视野扩展到适用于周期性体系的高级方法，如[谱方法](@entry_id:141737)和紧致差分格式。最后，我们将转向[数值积分](@entry_id:136578)，比较牛顿-科茨公式和[高斯求积](@entry_id:146011)的优劣，并为[材料科学](@entry_id:152226)中出现的特定挑战（如含权积分和高度[振荡积分](@entry_id:137059)）提供精妙的解决方案。

### [数值微分](@entry_id:144452)：从泰勒级数到[有限差分](@entry_id:167874)

[数值微分](@entry_id:144452)的核心思想是用一个在离散点[上采样](@entry_id:275608)得到的函数值的组合来近似其在一个特定点上的导数。这种近似的理论基础源于函数的泰勒级数展开。

#### 基本差分格式与[截断误差](@entry_id:140949)

假设我们有一个一维光滑[标量场](@entry_id:151443) $u(x)$，例如沿某一[晶向](@entry_id:137393)的位移分量，它在均匀网格点 $x_i = i h$ 上被采样。我们希望在点 $x_i$ 处计算其导数。根据**[泰勒定理](@entry_id:144253)**，我们可以将 $u(x)$ 在 $x_i$ 附近的点 $x_{i \pm 1}$ 处展开：
$$
u(x_{i+1}) = u(x_i) + h u'(x_i) + \frac{h^2}{2} u''(x_i) + \frac{h^3}{6} u'''(x_i) + \mathcal{O}(h^4)
$$
$$
u(x_{i-1}) = u(x_i) - h u'(x_i) + \frac{h^2}{2} u''(x_i) - \frac{h^3}{6} u'''(x_i) + \mathcal{O}(h^4)
$$
通过对这些展开式进行简单的代数组合，我们便可以得到不同导数的近似公式。例如，从第一个展开式中解出 $u'(x_i)$，我们得到**向前差分**公式：
$$
u'(x_i) \approx \frac{u(x_{i+1}) - u(x_i)}{h}
$$
这个近似忽略了 $h u''(x_i)/2$ 以及更高阶的项。被忽略的这些项构成了所谓的**[截断误差](@entry_id:140949)**（truncation error），它是将一个连续的微分算子用离散的差分算子替代时所产生的内在数学误差。对于向前差分，主导截断误差项是 $\frac{h}{2} u''(x_i)$，因此我们说该格式的精度是**一阶**的，记为 $\mathcal{O}(h)$。

一个更精确的近似可以通过组合上述两个[泰勒展开](@entry_id:145057)式得到。将两者相减，偶数阶导数项被消去：
$$
u(x_{i+1}) - u(x_{i-1}) = 2h u'(x_i) + \frac{h^3}{3} u'''(x_i) + \mathcal{O}(h^5)
$$
整理后得到**[中心差分](@entry_id:173198)**公式：
$$
u'(x_i) \approx \frac{u(x_{i+1}) - u(x_{i-1})}{2h}
$$
其主导截断误差为 $-\frac{h^2}{6} u'''(x_i)$，精度为**二阶**，即 $\mathcal{O}(h^2)$。这意味着当步长 $h$ 减半时，中心差分的截断误差会减小到原来的四分之一，其[收敛速度](@entry_id:636873)远快于一阶格式。

同样地，将两个泰勒展开式相加，可以得到[二阶导数](@entry_id:144508)的[中心差分近似](@entry_id:177025)。这在计算[应变梯度](@entry_id:204192)（$\frac{\partial^2 u_x}{\partial x^2}$）或[势能面](@entry_id:147441)曲率时非常有用 [@problem_id:3471283]：
$$
u(x_{i+1}) + u(x_{i-1}) = 2u(x_i) + h^2 u''(x_i) + \frac{h^4}{12} u^{(4)}(x_i) + \mathcal{O}(h^6)
$$
整理后得到：
$$
u''(x_i) \approx \frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2}
$$
这个广泛使用的三点[中心差分格式](@entry_id:747203)对[二阶导数](@entry_id:144508)的近似具有二阶精度，其[截断误差](@entry_id:140949)为 $-\frac{h^2}{12} u^{(4)}(\xi)$，其中 $\xi$ 是 $(x_{i-1}, x_{i+1})$ 内的某一点。

#### [非均匀网格](@entry_id:752607)的挑战

在许多实际问题中，例如为了解析[材料界面](@entry_id:751731)处的陡峭[浓度梯度](@entry_id:136633)，使用[非均匀网格](@entry_id:752607)是必要的。然而，在[非均匀网格](@entry_id:752607)上直接套用为均匀网格设计的公式会导致精度下降。

考虑一个节点 $x_i$，其左右邻居点分别为 $x_{i-1}$ 和 $x_{i+1}$，间距为 $h_- = x_i - x_{i-1}$ 和 $h_+ = x_{i+1} - x_i$。如果我们仍然使用形式上的“中心差分”公式 $D^{(2)}u(x_i) = \frac{u(x_{i+1}) - u(x_{i-1})}{h_- + h_+}$ 来近似 $u'(x_i)$，[泰勒展开](@entry_id:145057)分析会揭示一个问题 [@problem_id:3471300]。其[截断误差](@entry_id:140949)的[主导项](@entry_id:167418)变为 $\frac{1}{2}(h_+ - h_-)u''(x_i)$。如果网格间距的变化是剧烈的，即 $h_+ - h_-$ 与平均步长 $h = \max\{h_-, h_+\}$ 是同阶的（$\mathcal{O}(h)$），那么这个公式的精度就从二阶退化到了一阶。只有当网格是“平滑变化的”，即 $h_+ - h_- = \mathcal{O}(h^2)$ 时（例如，网格点由物理坐标到计算坐标的[光滑映射](@entry_id:203730)生成），这个简单的公式才能保持[二阶精度](@entry_id:137876)。

为了在任意[非均匀网格](@entry_id:752607)上都获得[高阶精度](@entry_id:750325)，我们必须使用更通用的方法，如**[待定系数法](@entry_id:166225)**（method of undetermined weights）。例如，要为 $u'(x_0)$ 构建一个使用 $x_0, x_1, x_2$ 三个非[均匀分布](@entry_id:194597)点的单边差分格式（这在计算边界通量时非常有用 [@problem_id:3471320]），我们可以写出一般形式 $u'(x_0) \approx c_0 u(x_0) + c_1 u(x_1) + c_2 u(x_2)$。然后，我们要求该公式对于低阶多项式（例如 $u(x)=1, (x-x_0), (x-x_0)^2$）是精确的。这会导出一个关于系数 $c_0, c_1, c_2$ 的[线性方程组](@entry_id:148943)。求解该[方程组](@entry_id:193238)可以得到在任意间距 $h_1 = x_1 - x_0$ 和 $h_2 = x_2 - x_0$ 下都能保证二阶精度的系数。这个强大的技术可以推广到构建任意阶精度、任意导数和任意网格[分布](@entry_id:182848)的差分格式。

### 实践中的陷阱：截断误差、[舍入误差](@entry_id:162651)与噪声

理论上的[截断误差分析](@entry_id:756198)假设我们能用无限精度进行计算。然而，在实际的计算机中，[浮点数](@entry_id:173316)的有限精度引入了**[舍入误差](@entry_id:162651)**（roundoff error）。[数值微分](@entry_id:144452)操作对舍入误差特别敏感，理解其与截断误差的相互作用至关重要。

#### 误差的权衡

考虑计算[二阶导数](@entry_id:144508)的标准三点[中心差分公式](@entry_id:139451)。我们已经知道其截断误差 $\mathcal{E}_T$ 的大小约为 $C_T h^2$，其中 $C_T$ 是一个与函数[高阶导数](@entry_id:140882)相关的常数。另一方面，计算 $u(x_{i+1}) - 2u(x_i) + u(x_{i-1})$ 时，如果 $h$ 很小，这三个函数值会非常接近，它们的相减会产生**[灾难性抵消](@entry_id:146919)**（subtractive cancellation），导致有效数字的严重损失。更一般地，如果每次函数求值都带有一个幅度约为[机器精度](@entry_id:756332) $\varepsilon_{\mathrm{mach}}$ 或某个噪声水平 $\sigma$ 的误差，那么分子上的总[误差幅度](@entry_id:169950)约为 $\mathcal{O}(\sigma)$。当除以 $h^2$ 时，这个误差被急剧放大。因此，舍入或噪声误差 $\mathcal{E}_R$ 的大小约为 $C_R \sigma / h^2$ [@problem_id:3471283]。

总误差 $\mathcal{E}_{\mathrm{total}} = \mathcal{E}_T + \mathcal{E}_R \approx C_T h^2 + C_R \sigma / h^2$。这是一个关于步长 $h$ 的经典“V形”曲线。当 $h$ 很大时，[截断误差](@entry_id:140949)占主导；当 $h$ 很小时，舍入/噪声误差占主导。存在一个[最优步长](@entry_id:143372) $h_{\mathrm{opt}}$，它使得总误差最小。通过对总误差求导并令其为零，可以发现 $h_{\mathrm{opt}} \propto (\sigma/B_4)^{1/4}$，其中 $B_4$ 是四阶导数的界。这揭示了一个深刻的道理：并非步长越小越好。在达到某个[临界点](@entry_id:144653)后，进一步减小 $h$ 反而会因为放大了舍入误差而降低计算结果的准确性。

#### [高阶格式](@entry_id:150564)总是更好吗？

直觉上，使用更高阶的差分格式（例如，使用五个点来近似[二阶导数](@entry_id:144508)的四阶精度格式）似乎总能带来更好的结果，因为其[截断误差](@entry_id:140949)以 $\mathcal{O}(h^4)$ 的速度减小。然而，这种想法忽略了舍入/噪声误差的影响。

一个[高阶格式](@entry_id:150564)通常涉及更多点和更大的系数。例如，近似 $E''(x_0)$ 的五点[中心差分公式](@entry_id:139451)为 $\frac{-E(x_0+2h) + 16E(x_0+h) - 30E(x_0) + 16E(x_0-h) - E(x_0-2h)}{12h^2}$。其[截断误差](@entry_id:140949)界为 $\frac{B_6}{90}h^4$，但其噪声误差界的分子是 $(1+16+30+16+1)\sigma = 64\sigma$，而三点格式的分子是 $4\sigma$。因此，五点格式的噪声[误差界](@entry_id:139888)约为 $\frac{16\sigma}{3h^2}$，比三点格式的 $\frac{4\sigma}{h^2}$ 要大。

这意味着，当函数求值存在不可避免的噪声 $\sigma$ 时（例如，来自未完全收敛的DFT计算），[高阶格式](@entry_id:150564)虽然能更快地压低[截断误差](@entry_id:140949)，但它也更剧烈地放大了噪声 [@problem_id:3471326]。通过分别最小化两种格式的总误差界，可以发现存在一个由噪声水平 $\sigma$ 和函数[高阶导数](@entry_id:140882)界 $B_4, B_6$ 决定的参数区域。在此区域内，五点格式的最优可达精度实际上劣于三点格式。这个例子告诫我们，在为有噪声的计算（这在[计算材料科学](@entry_id:145245)中非常普遍）选择数值方法时，必须综合考虑截断误差和噪声放大效应。

#### [数值微分](@entry_id:144452)的病态性与正则化

从傅里叶分析的角度看，[微分](@entry_id:158718)操作是一个**高通滤波器**。对函数 $f(x)$ 求导，在[频域](@entry_id:160070)中对应于将其[傅里叶变换](@entry_id:142120) $\hat{f}(\omega)$ 乘以 $i\omega$。这意味着高频分量被线性放大。离散差分算子也具有类似的性质。例如，[中心差分](@entry_id:173198)算子的[频率响应](@entry_id:183149)为 $\frac{i \sin(\omega h)}{h}$，其幅值在[奈奎斯特频率](@entry_id:276417)附近达到最大值 $1/h$。对于小的 $h$，这是一个非常大的放大因子。

当处理被白噪声（其[功率谱](@entry_id:159996)在所有频率上是平坦的）污染的数据时，[数值微分](@entry_id:144452)会不成比例地放大噪声中的高频成分，导致结果完全被噪声淹没。这表明[数值微分](@entry_id:144452)本质上是一个**病态**（ill-posed）问题。

为了解决这个问题，需要引入**正则化**（regularization）。其思想是在求导之前或求导过程中对数据进行平滑处理，以抑制高频噪声。两种常见的策略包括 [@problem_id:3471295]：
1.  **高斯预滤波**：在应用差分算子之前，先用一个高斯核对数据进行卷积。这相当于在[频域](@entry_id:160070)中乘以一个高斯函数 $e^{-\frac{1}{2}(\sigma_G\omega)^2}$，它能有效衰减高频分量。高斯核的宽度 $\sigma_G$ 是一个可调参数，需要在保留信号特征与抑制噪声之间取得平衡。
2.  **[吉洪诺夫正则化](@entry_id:140094) (Tikhonov Regularization)**：这是一种更系统的方法，通过求解一个[变分问题](@entry_id:756445)来寻找一个既拟[合数](@entry_id:263553)据又足够光滑的函数。其频率响应形式为 $\frac{i\omega}{1+\lambda\omega^2}$，其中 $\lambda$ 是正则化参数。当 $\omega$ 很大时，该响应衰减为零，从而抑制了高频噪声。

选择合适的正则化策略和参数，可以在有效求导的同时，将噪声放大控制在可接受的范围内。

### 高级[微分](@entry_id:158718)格式：谱方法与紧致差分

对于特定类型的问题，尤其是涉及周期性边界条件的体系（如[理想晶体](@entry_id:138314)），存在比标准有限差分更强大、更精确的[微分](@entry_id:158718)方法。

#### 周期性体系的谱方法

**谱方法**（spectral method）利用函数在一组[全局基函数](@entry_id:749917)（对于周期性问题，是[傅里叶级数](@entry_id:139455)）上的展开。计算周期函数 $u(\mathbf{x})$ 的[拉普拉斯算子](@entry_id:146319) $\nabla^2 u$ 的过程如下 [@problem_id:3471280]：
1.  使用**[快速傅里叶变换 (FFT)](@entry_id:146372)** 将网格上的函数值 $u(\mathbf{x})$ 变换到[波数](@entry_id:172452)空间，得到其[傅里叶系数](@entry_id:144886) $\hat{u}(\mathbf{k})$。这一步的计算成本约为 $\mathcal{O}(N \log N)$，其中 $N$ 是总网格点数。
2.  在[波数](@entry_id:172452)空间中执行[微分](@entry_id:158718)。根据[傅里叶变换的性质](@entry_id:265641)，对 $x_j$ 求[二阶导数](@entry_id:144508)相当于乘以 $(i k_j)^2 = -k_j^2$。因此，$\nabla^2 u$ 的[傅里叶变换](@entry_id:142120)就是 $-|\mathbf{k}|^2 \hat{u}(\mathbf{k})$。这一步的成本为 $\mathcal{O}(N)$。
3.  使用逆FFT将结果 $-|\mathbf{k}|^2 \hat{u}(\mathbf{k})$ 变换回[实空间](@entry_id:754128)。成本同样是 $\mathcal{O}(N \log N)$。

[谱方法](@entry_id:141737)的主要优势在于其**谱精度**。对于解析（无限阶光滑）的[周期函数](@entry_id:139337)，[谱方法](@entry_id:141737)的误差随 $N$ 的增加呈指数级下降，比任何代数阶次的有限差分法（如 $\mathcal{O}(h^2)$ 或 $\mathcal{O}(h^4)$）都要快得多。然而，它的缺点在于对[函数光滑性](@entry_id:161935)的高度依赖。如果函数存在不连续点或[尖点](@entry_id:636792)（kink），谱精度会丧失，[收敛速度](@entry_id:636873)退化为代数阶，并且会出现**[吉布斯现象](@entry_id:138701)**（Gibbs phenomenon）——在不连续点附近产生难以消除的全局性[振荡](@entry_id:267781)。相比之下，有限差分法的误差是局部的，即使在不连续点附近精度下降，也不会污染整个计算域。因此，方法的选择取决于被[微分](@entry_id:158718)场的正则性。

#### [紧致有限差分格式](@entry_id:747522)

**紧致差分格式**（compact finite difference scheme）旨在以有限差分法的局部数据结构（通常是[三对角系统](@entry_id:635799)）实现接近[谱方法](@entry_id:141737)的精度。它不是显式地用周围的点表示某点的导数，而是建立一个涉及邻近点上导数值的隐式关系。

例如，一个四阶精度的紧致格式可以有如下形式 [@problem_id:3471329]：
$$
\frac{1}{4} u'_{i-1} + u'_i + \frac{1}{4} u'_{i+1} = \frac{3}{4h}(u_{i+1} - u_{i-1})
$$
要计算所有格点上的导数 $\{u'_i\}$，需要求解一个三对角[线性方程组](@entry_id:148943)。虽然这比显式格式计算量稍大，但得到的回报是极高的精度。通过分析其对傅里叶模式 $e^{ikx}$ 的响应，可以得到该格式的**[修正波数](@entry_id:141354)**（modified wavenumber），它描述了离散算子对不同波长的响应与理想微分算子的偏离程度。紧致格式的[修正波数](@entry_id:141354)在很宽的频率范围内都非常接近真实波数，这意味着它具有很小的**[色散误差](@entry_id:748555)**（dispersive error），能够更准确地模拟[波的传播](@entry_id:144063)，这在[相场模型](@entry_id:202885)或动力学模拟中至关重要。

### 数值积分：求积的艺术

数值积分，或称**求积**（quadrature），旨在用函数在一系列离散点（称为求积点）上的值的加权和来近似其[定积分](@entry_id:147612)。

#### 牛顿-科茨公式族

这类方法的基本思想是在整个积分区间或若干子区间上用一个低阶多项式来插值被积函数，然后精确地对这个插值多项式积分。
最简单的例子是梯形法则，它用一个线性函数[连接子](@entry_id:177005)区间的两个端点。一个更精确的例子是**辛普森法则**（Simpson's rule）。在一个宽度为 $2h$ 的区间 $[x_i, x_{i+2}]$ 上，我们可以用一个二次多项式穿过三个点 $(x_i, u_i), (x_{i+1}, u_{i+1}), (x_{i+2}, u_{i+2})$。对这个二次多项式积分，得到的结果是 [@problem_id:3471317]：
$$
\int_{x_i}^{x_{i+2}} u(x) \,dx \approx \frac{h}{3} (u_i + 4u_{i+1} + u_{i+2})
$$
为了计算整个区间 $[a, b]$ 上的积分，我们可以将[区间划分](@entry_id:264619)为 $N/2$ 个这样的子面板（$N$为偶数），并将每个面板上的辛普森法则结果相加，得到**[复合辛普森法则](@entry_id:173111)**：
$$
\int_{a}^{b} u(x) \,dx \approx \frac{h}{3} [ u_0 + 4u_1 + 2u_2 + 4u_3 + \dots + 2u_{N-2} + 4u_{N-1} + u_N ]
$$
通过严谨的泰勒展开分析可以证明，该复合公式的[全局截断误差](@entry_id:143638)为 $E = -\frac{(b-a)h^4}{180} u^{(4)}(\xi)$，其中 $\xi \in [a, b]$。这是一个四阶精度的格式，对于[光滑函数](@entry_id:267124)非常有效。

#### 高斯求积：最优节点的威力

牛顿-科茨公式的一个限制是它使用了等距的、预先固定的求积点。**[高斯求积](@entry_id:146011)**（Gaussian quadrature）则采取了一种更优的策略：它同时优化求积点的位置和对应的权重，以达到给定点数下的最高可能精度。

其核心原理与**带权正交多项式**有关。对于一个在区间 $\Omega$ 上定义的权函数 $w(x)$，如果一个 $N$ 点求积公式能够精确地积出所有形如 $w(x) P_{2N-1}(x)$ 的函数（其中 $P_{2N-1}(x)$ 是任意次数不超过 $2N-1$ 的多项式），那么这个公式就是高斯求积。其 $N$ 个求积点恰好是与权函数 $w(x)$ 相关的 $N$ 阶正交多项式的根。

这种方法的威力在一个典型的[材料科学](@entry_id:152226)问题中得到了完美展示：计算原子的总电子数 $N_e = \int_0^\infty 4\pi r^2 n(r) dr$，其中 $n(r)$ 是从DFT计算得到的径向电子密度 [@problem_id:3471355]。$n(r)$ 通常具有 $e^{-\lambda r}$ 的指数衰减行为。我们可以将积分重写为：
$$
I = 4\pi \int_0^\infty (r^2 e^{-\lambda r}) \left( \frac{n(r)}{e^{-\lambda r}} \right) dr
$$
这里的 $r^2 e^{-\lambda r}$ 部分包含了被积函数最主要的非多项式特征。通过变量代换 $x = \lambda r$，积分可以变换为 $\frac{4\pi}{\lambda^3} \int_0^\infty (x^2 e^{-x}) g(x) dx$ 的形式，其中 $g(x)$ 是一个行为良好的函数，可以被多项式很好地近似。这里的权函数 $w(x) = x^2 e^{-x}$ 正是**广义拉盖尔（Laguerre）多项式** $L_m^{(2)}(x)$ 的权函数。因此，使用对应的 $N$ 点[高斯-拉盖尔求积](@entry_id:142563)法，可以用极少的求积点数达到非常高的精度。这比在截断的区间上使用成百上千个点的[复合辛普森法则](@entry_id:173111)要高效得多。

### 应对高度[振荡积分](@entry_id:137059)的先进策略

在计算[线性响应函数](@entry_id:160418)或输运性质时，常会遇到形如 $I(\omega) = \int_0^L f(x) e^{i\omega\phi(x)} dx$ 的**高度[振荡积分](@entry_id:137059)**，其中 $\omega \gg 1$。对于这类积分，传统的[自适应求积](@entry_id:144088)方法会失效 [@problem_id:3471310]。

自适应方法通过比较粗略和精细的局部积分估计来判断是否需要加密网格。然而，对于高度[振荡](@entry_id:267781)的函数，求积点很可能偶然落在使[局部误差估计](@entry_id:146659)显得很小的位置（例如，采样点恰好对称地[分布](@entry_id:182848)在一个周期的两侧），导致所谓的“伪精度”。算法会错误地接受一个实际上误差很大的子区间，最终导致全局误差巨大。

处理这类问题的现代稳健策略，如**Filon型方法**，其核心思想是“分离”被积函数中的慢变[部分和](@entry_id:162077)快[振荡](@entry_id:267781)部分：
1.  通过变量代换 $\theta = \omega\phi(x)$，将[积分变换](@entry_id:186209)为标准傅里叶积分形式：$\int_{\theta_0}^{\theta_1} a(\theta) e^{i\theta} d\theta$，其中振幅 $a(\theta) = \frac{f(x(\theta))}{\omega\phi'(x(\theta))}$ 是一个随 $\omega$ 增大而变得更平滑、幅值更小的函数。
2.  将 $\theta$ [区间划分](@entry_id:264619)，在每个子区间上用一个低阶多项式 $p(\theta)$ 去近似慢变的振幅 $a(\theta)$。
3.  解析地计算积分 $\int p(\theta) e^{i\theta} d\theta$。由于多项式与[复指数](@entry_id:162635)的积分有解析解，这一步是精确的。

这种方法的误差来源于用多项式近似慢变振幅 $a(\theta)$。由于当 $\omega$ 增大时 $a(\theta)$ 变得越来越平滑，固定数量的求积点可以越来越好地近似它。因此，这类方法的精度通常会随振荡频率 $\omega$ 的增加而提高，这与传统方法正好相反，体现了其处理高度[振荡](@entry_id:267781)问题的优越性。