## 引言
在[分子动力学](@entry_id:147283)（MD）模拟中，精确控制温度、压力等[热力学](@entry_id:141121)条件是获得物理真实性结果的基石。继[恒温器](@entry_id:169186)之后，恒压器（barostat）是另一个核心工具，它使得我们能够在与实验条件更相符的恒定压力环境下探索材料的行为。然而，不同的恒压算法在理论基础和动力学效应上存在巨大差异，错误的选择或使用会导致模拟结果出现严重偏差，甚至得出非物理的结论。本文旨在填补这一知识鸿沟，为计算科学家提供一个关于[恒压器](@entry_id:200779)的全面指南。

本文将带领读者深入理解[恒压器](@entry_id:200779)的工作机制、应用场景与实践挑战。在“原理与机制”一章中，我们将从压力的微观定义出发，剖析Berendsen和Parrinello-Rahman等主流算法的设计哲学及其[统计力](@entry_id:194984)学根源。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将探讨如何在[材料科学](@entry_id:152226)研究中有效应用这些工具来模拟力学性质、[相变](@entry_id:147324)和微[结构演化](@entry_id:186256)，并讨论其与纳米科学、控制论等领域的交叉联系。最后，“实践练习”部分将通过具体问题，巩固您对关键概念的理解，并提升您在实际模拟中诊断和解决问题的能力。通过学习本文，您将能够自信地为您的研究选择和配置最合适的恒压器，从而显著提升模拟的可靠性与准确性。

## 原理与机制

在[分子动力学](@entry_id:147283)（MD）模拟中，维持系统处于恒定的[热力学](@entry_id:141121)条件下对于准确预测材料的物理性质至关重要。继前一章介绍的用于控制温度的恒温器之后，本章将深入探讨用于控制压力的**恒压器**（barostat）的原理与机制。[恒压器](@entry_id:200779)通过动态调整模拟体系的体积或形状，确保系统的平均内部压力与预设的外部压力相匹配，从而使模拟能够在等温等压（NPT）系综或其他恒定应力系综下进行。本章将从压力的微观定义出发，系统地阐述两种主流恒压算法——弱[耦合方法](@entry_id:195982)与扩展[拉格朗日方法](@entry_id:142825)——的设计哲学、动力学行为及其在[统计力](@entry_id:194984)学层面上的严格性，并最终讨论各向同性与[各向异性压力](@entry_id:746456)控制的适用场景。

### 压力在[分子模拟](@entry_id:182701)中的微观基础

在宏观世界中，压力被直观地理解为单位面积上所受的力。然而，在原子尺度的模拟中，并没有一个明确的“容器壁”来测量这种力。因此，我们必须借助[统计力](@entry_id:194984)学，从粒子的微观状态（位置和动量）来定义压力。其理论基础是**克劳修斯[维里定理](@entry_id:146441)**（Clausius virial theorem）。

对于一个由 $N$ 个粒子组成的系统，其瞬时**维里**（virial）$W$ 定义为粒子位置向量 $\mathbf{r}_i$ 与其所受总力 $\mathbf{f}_i$ [点积](@entry_id:149019)的总和：
$$
W = \sum_{i=1}^{N} \mathbf{r}_i \cdot \mathbf{f}_i
$$
其中力 $\mathbf{f}_i$ 源于粒子间的相互作用[势能](@entry_id:748988) $U(\{\mathbf{r}_i\})$，即 $\mathbf{f}_i = -\nabla_i U$。维里定理将系统的宏观压力 $p$ 与微观量联系起来。对于一个处于体积 $V$ 和温度 $T$ 下的各向同性三维系统，其瞬时压力 $p$ 由两部分贡献构成：**动能项**和**位形项**（即维里项）[@problem_id:3449035]。

瞬时压力表达式为：
$$
p = \frac{1}{3V} \left( \sum_{i=1}^{N} m_i v_i^2 + W \right)
$$
其中 $m_i$ 和 $v_i$ 分别是粒子 $i$ 的质量和速度大小。第一项 $\sum m_i v_i^2$ 是系统总动能的两倍（$2K$），反映了粒子热运动对压力的贡献，通常被称为**动力学压力**。根据能量均分定理，在平衡态下，其系综平均值与温度 $T$ 相关，$\langle 2K \rangle = 3Nk_BT$（对于无约束的系统），其中 $k_B$ 是[玻尔兹曼常数](@entry_id:142384)。因此，压力方程常被写作：
$$
p = \frac{N k_B T}{V} + \frac{W}{3V}
$$
这个表达式明确了压力的两个来源：第一项是理想气体压力，完全由粒子的动能和密度决定；第二项则包含了粒子间相互作用的全部复杂性，是[凝聚态物质](@entry_id:747660)（液体和固体）压力的主要贡献来源。对于理想气体，$\mathbf{f}_i = 0$，维里为零，压力方程简化为[理想气体状态方程](@entry_id:137803)。但在真实材料中，维里项 $W$ 的贡献至关重要，它可以是正值（主要由排斥力贡献，如在高密度液体中）或负值（主要由吸[引力](@entry_id:175476)贡献，如在低压气体或受张力的固体中）。[恒压器](@entry_id:200779)的核心任务就是通过调整体积 $V$，使这个微观计算出的瞬时压力 $p$ 的[时间平均](@entry_id:267915)值趋近于目标外部压力 $p_{\mathrm{ext}}$。

### 恒压器的基本作用：调控系统体积

[恒压器](@entry_id:200779)和[恒温器](@entry_id:169186)的目标截然不同，它们通过操纵系统中不同的自由度来实现各自的控制。[恒温器](@entry_id:169186)通过调整粒子的**速度**来控制系统的动能，从而维持恒定的温度。而恒压器则通过调整粒子的**位置**和模拟盒的**体积**来控制系统的势能和粒子密度，进而维持恒定的压力[@problem_id:2013268]。

我们可以通过一个简单的思想实验来阐明这一区别。考虑一个系统，其总能量 $E = K + U$，其中 $K$ 是总动能，$U$ 是总势能。假设[势能](@entry_id:748988) $U$ 是一个关于粒子坐标的 $n$ 次齐次函数，即当所有粒子坐标 $\mathbf{r}_i$ 按[比例因子](@entry_id:266678) $\lambda$ 缩放时（$\mathbf{r}_i \rightarrow \lambda \mathbf{r}_i$），[势能](@entry_id:748988)变为 $U \rightarrow \lambda^n U$。 Lennard-Jones 势中的 $r^{-12}$ 和 $r^{-6}$ 项就是这种齐次函数的例子（分别为 $n=-12$ 和 $n=-6$）。

1.  **恒温器操作**：瞬间将所有粒子的速度缩放 $\lambda_T$ 倍（$v_i \rightarrow \lambda_T v_i$），而位置不变。由于动能是速度的二次函数，$K \rightarrow \lambda_T^2 K$。[势能](@entry_id:748988) $U$ 不变。因此，总能量的变化为 $\Delta E_{\mathrm{thermostat}} = (\lambda_T^2 - 1)K$。

2.  **恒压器操作**：瞬间将所有粒子的位置和模拟盒的尺寸缩放 $\lambda_P$ 倍（$\mathbf{r}_i \rightarrow \lambda_P \mathbf{r}_i$），而速度不变。动能 $K$ 不变。由于势能的齐次性， $U \rightarrow \lambda_P^n U$。总能量的变化为 $\Delta E_{\mathrm{barostat}} = (\lambda_P^n - 1)U$。

如果我们考虑系统处于平衡态，其时间平均动能为 $\langle K \rangle$，平均势能为 $\langle U \rangle$，两者之比为 $\gamma = \langle U \rangle / \langle K \rangle$，那么这两种操作引起的能量变化之比为[@problem_id:2013268]：
$$
\frac{\Delta E_{\mathrm{thermostat}}}{\Delta E_{\mathrm{barostat}}} = \frac{(\lambda_T^2 - 1)\langle K \rangle}{(\lambda_P^n - 1)\langle U \rangle} = \frac{\lambda_T^2 - 1}{\gamma (\lambda_P^n - 1)}
$$
这个结果清晰地表明，恒温器直接作用于系统的动能部分，而恒压器则直接作用于系统的[势能](@entry_id:748988)部分。正是通过对体积（以及粒子相对位置）的调控，恒压器改变了粒子间的平均距离，从而调整了[相互作用能](@entry_id:264333)和维里，最终使压力达到目标值。

### 恒压算法的两大[范式](@entry_id:161181)

历史上，研究者们提出了多种实现恒压控制的算法。这些算法大体上可以归入两种截然不同的设计哲学：**弱[耦合方法](@entry_id:195982)**和**扩展[拉格朗日方法](@entry_id:142825)**。

#### 弱[耦合方法](@entry_id:195982)：Berendsen [恒压器](@entry_id:200779)

Berendsen 恒压器是最早被广泛应用的恒压算法之一，它基于一种简单直观的“[弱耦合](@entry_id:140994)”思想：将模拟系统想象成与一个具有恒定压力 $p_{\mathrm{ext}}$ 的巨大外部“压力浴”相耦合。当系统内部压力 $p$ 与外部压力 $p_{\mathrm{ext}}$ 不符时，通过一个确定性的反馈机制，以一阶动力学的方式将 $p$ “弛豫”到 $p_{\mathrm{ext}}$。

其核心思想是，体积的变化率应正比于瞬时压力与目标压力之差[@problem_id:3434139]：
$$
\frac{dV}{dt} = \frac{\beta_T V}{\tau_p} (p - p_{\mathrm{ext}})
$$
这里的 $\tau_p$ 是一个可调参数，称为**压力[弛豫时间](@entry_id:191572)**，它控制着[压力恢复](@entry_id:270791)到目标值的快慢。$\beta_T$ 是体系的等温[压缩系数](@entry_id:272630)，定义为 $\beta_T = -\frac{1}{V}\left(\frac{\partial V}{\partial p}\right)_T$，它反映了材料抵[抗体](@entry_id:146805)积变化的“软硬”程度。

在离散的时间步长 $\Delta t$ 内，这个[微分方程](@entry_id:264184)可以近似为体积的一个微小缩放。对于各向同性的情况，模拟盒的边长 $L$ 和所有粒子的坐标 $\mathbf{r}_i$ 在每个时间步都会被乘以一个缩放因子 $s$ [@problem_id:3434203]。这个缩放因子 $s$ 可以从上述弛豫方程推导得出。在一阶近似下，它表示为：
$$
s \approx 1 + \frac{1}{3}\frac{\beta_{T} \Delta t}{\tau_{p}}(p - p_{\mathrm{ext}})
$$
这个公式的推导过程清晰地揭示了算法的本质：计算当前压力 $p$，与目标值 $p_{\mathrm{ext}}$ 比较，然后根据差值计算出一个缩放因子，用它来调整盒子大小和粒子位置，以期在下一个时间步更接近目标压力。

Berendsen [恒压器](@entry_id:200779)虽然概念简单、易于实现且[数值稳定性](@entry_id:146550)好，但它存在一个根本性的缺陷：它不能严格地生成正确的**等温等压（NPT）系综**。其动力学过程是确定性的阻尼，而不是一个能够产生正确[热力学](@entry_id:141121)涨落的[随机过程](@entry_id:159502)。这可以从几个角度来理解：

1.  **涨落抑制**：该算法的方程是一个纯粹的耗散方程，它会指数式地抑制体积的涨落，而不是让其围绕平衡值进行符合[统计力](@entry_id:194984)学的自然涨落。正确的 NPT 系综要求体积[方差](@entry_id:200758)满足 $\langle (\delta V)^2 \rangle = k_B T V \beta_T$。Berendsen [恒压器](@entry_id:200779)产生的[体积涨落](@entry_id:141521)通常远小于此理论值，尤其是在压力[弛豫时间](@entry_id:191572) $\tau_p$ 设置得较短时[@problem_id:3434139]。这种对物理涨落的抑制在研究[相变](@entry_id:147324)、临界现象或需要精确计算[响应函数](@entry_id:142629)（如[压缩系数](@entry_id:272630)）时是致命的。

2.  **动力学模式的过阻尼**：系统的[体积涨落](@entry_id:141521)与物质内部的[声学模](@entry_id:263916)式（[声子](@entry_id:140728)）直接相关。最慢的物理压力响应模式（最低频的[声学模](@entry_id:263916)式）具有一个特征频率 $\omega_1 \approx c_s (2\pi/L)$，其中 $c_s$ 是声速。如果[恒压器](@entry_id:200779)的弛豫速率 $1/\tau_p$ 远大于这个物理频率（$\tau_p$ 过短），[恒压器](@entry_id:200779)就会“过度”地干预系统，在其自然的[声学振荡](@entry_id:161154)完成一个周期前就将其强行压制下去。这种**过阻尼**效应会扭曲系统的本征动力学[@problem_id:3434139]。特别是在[临界点](@entry_id:144653)附近，$\beta_T$ 发散而 $c_s$ 趋于零，物理模式变得极慢，此时若不将 $\tau_p$ 设置得非常长，就极易产生非物理的结果。

3.  **非[哈密顿动力学](@entry_id:156273)**：从更根本的动力学系统理论来看，Berendsen 方法引入的运动方程是非哈密顿的。通过计算其在扩展相空间（包含坐标、动量和体积）中流的散度，即**相空间[可压缩性](@entry_id:144559)** $\kappa_{ps}$，可以发现其值不为零[@problem_id:3434144]：
    $$
    \kappa_{ps, B} = -\frac{\beta_T}{\tau_p} \left( \frac{2K}{9V} + p_{\mathrm{ext}} \right) \neq 0
    $$
    这违反了**[刘维尔定理](@entry_id:191167)**（Liouville's theorem），该定理要求[哈密顿系统](@entry_id:143533)的相空间流必须是不可压缩的（$\kappa_{ps} = 0$）。相空间体积不守恒意味着该动力学演化无法保持正确的相空间测度，因此它生成的轨迹不对应于任何一个已知的[平衡态](@entry_id:168134)[统计系综](@entry_id:149738)。

尽管有这些理论缺陷，Berendsen [恒压器](@entry_id:200779)在模拟的**弛豫阶段**（equilibration）仍然是一个非常有用的工具。在弛豫阶段，我们主要关心的是让系统尽快达到目标温度和压力，而对系综的严格性要求不高。它的快速收敛和稳定性使其成为将系统从一个任意初态引导至目标[热力学状态](@entry_id:755916)的理想选择。

有趣的是，Berendsen 的[唯象模型](@entry_id:273816)可以被看作是更具物理图像的 **Andersen 恒压器** 在高摩擦极限下的结果。Andersen [恒压器](@entry_id:200779)引入一个具有质量 $M_p$ 的虚拟“活塞”来控制体积 $V$，其运动方程（包含摩擦项 $\gamma$）为 $M_p \ddot{V} = (p - p_{\mathrm{ext}}) - \gamma \dot{V}$。在[摩擦力](@entry_id:171772)远大于惯性力的**[过阻尼极限](@entry_id:161869)**下（$M_p \ddot{V} \approx 0$），该方程简化为 $\dot{V} \approx \frac{1}{\gamma}(p - p_{\mathrm{ext}})$。将其与 Berendsen 的方程比较，可以发现两者形式等价，并且压力[弛豫时间](@entry_id:191572) $\tau_p$ 与 Andersen 活塞的[摩擦系数](@entry_id:150354) $\gamma$ 直接相关：$\tau_p = \gamma \beta_T V$ [@problem_id:106789]。

#### 扩展[拉格朗日方法](@entry_id:142825)：Parrinello-Rahman 恒压器

与 Berendsen 方法的唯象思想不同，Parrinello-Rahman (PR) [恒压器](@entry_id:200779)建立在坚实的[统计力](@entry_id:194984)学基础之上。其核心思想是将模拟盒的自由度（体积或更一般的[晶格矢量](@entry_id:161583)）也视为系统的**动态变量**，并为它们引入共轭[动量和动能](@entry_id:173022)项，从而构建一个**[扩展拉格朗日量](@entry_id:136469)**（或[哈密顿量](@entry_id:172864)）[@problem_id:3449035]。整个扩展系统（粒子 + 盒子）的演化遵循[哈密顿力学](@entry_id:146202)，从而自然地生成了正确的[统计系综](@entry_id:149738)。

在最简单的各向同性情况下，我们可以将体积 $V$ 视为一个[广义坐标](@entry_id:156576)，并为其引入一个虚拟质量 $W$（也称为恒压器质量参数）和[共轭动量](@entry_id:172203) $\Pi_V$。扩展系统的[哈密顿量](@entry_id:172864)可以写成：
$$
H_{\mathrm{ext}} = \sum_{i=1}^N \frac{\mathbf{p}_i^2}{2m_i} + U(\{\mathbf{r}_i\}) + \frac{\Pi_V^2}{2W} + p_{\mathrm{ext}}V
$$
从这个[哈密顿量](@entry_id:172864)出发，根据哈密顿方程可以推导出粒子和体积的[运动方程](@entry_id:170720)。体积的运动方程是二阶的，形式上类似于一个由压力不平衡驱动的[谐振子](@entry_id:155622)：
$$
W\ddot{V} = p - p_{\mathrm{ext}}
$$
这种二阶动力学与 Berendsen 方法的一阶弛豫形成鲜明对比。它允许体积围绕平衡值进行[振荡](@entry_id:267781)，而不是单向地衰减。这些[振荡](@entry_id:267781)可以与系统内部的物理声学[模式耦合](@entry_id:752088)，从而更真实地反映系统的动态响应[@problem_id:3434139]。

[恒压器](@entry_id:200779)质量参数 $W$ 的选择至关重要。它决定了体积响应的惯性。通过对体积在[平衡点](@entry_id:272705)附近的小幅[振动](@entry_id:267781)进行分析，可以发现体积的[振荡](@entry_id:267781)[角频率](@entry_id:261565) $\omega_b$ 为[@problem_id:3434146]：
$$
\omega_b = \sqrt{\frac{9V_0}{W \beta_T}}
$$
其中 $V_0$ 是平衡体积。这个关系式表明，$W$ 越大，体积[振荡](@entry_id:267781)的频率越低，周期越长，即恒压器的响应越“迟钝”；$W$ 越小，响应越快。选择 $W$ 的原则是在保证压力能够有效弛豫的同时，避免其[振荡频率](@entry_id:269468)与系统内部分子的高频[振动](@entry_id:267781)发生共振，以免产生非物理的能量交换。通常，$\omega_b$ 的周期应远长于原子[振动](@entry_id:267781)的周期，但远短于整个模拟的时长。

Parrinello-Rahman 方法的深刻之处在于其严格的[统计力](@entry_id:194984)学基础。为了在动力学模拟中正确地实现它，通常需要使用**标度坐标**（scaled coordinates）$\mathbf{s}_i$。粒子在真[实空间](@entry_id:754128)中的坐标 $\mathbf{r}_i$ 通过模拟盒矩阵 $\mathbf{h}$ 与标度坐标相关联：$\mathbf{r}_i = \mathbf{h} \mathbf{s}_i$。当使用标度[坐标时](@entry_id:263720)，NPT 系综的[配分函数](@entry_id:193625)会因为[坐标变换](@entry_id:172727)的**雅可比行列式**（Jacobian）而产生一个额外的因子。

从 unscaled 坐标 $\mathbf{r}^N$ 到 scaled 坐标 $\mathbf{s}^N$ 的变换，其体积元的关系是 $d\mathbf{r}^N = (\det \mathbf{h})^N d\mathbf{s}^N = V^N d\mathbf{s}^N$ [@problem_id:3434168]。因此，NPT 系综在标度坐标下的[平衡概率](@entry_id:187870)密度 $\rho_{\mathrm{eq}}$ 包含一个 $V^N$ 的因子：
$$
\rho_{\mathrm{eq}}(\mathbf{s}^N, V) \propto V^N \exp[-\beta(U(\mathbf{h}\mathbf{s}^N) + p_{\mathrm{ext}} V)]
$$
为了让扩展拉格朗日动力学能够采样这个[分布](@entry_id:182848)，我们需要在[扩展哈密顿量](@entry_id:749188)的势能部分加入一个修正项，以重现这个 $V^N$ 因子。由于 $V^N = \exp(N \ln V)$，这个修正项正是 $- (N/\beta) \ln V = -N k_B T \ln V$ [@problem_id:3434168] [@problem_id:3434196]。修正后的[有效势能](@entry_id:171609)为：
$$
H_{\mathrm{ext,pot}} = U(\mathbf{h}\mathbf{s}^N) + p_{\mathrm{ext}}V - N k_B T \ln V
$$
这个对数项至关重要，它确保了在对动量自由度积分后，得到的边际构型[分布](@entry_id:182848)与 NPT 系综的理论[分布](@entry_id:182848)完全一致。这个修正项对盒子的[运动方程](@entry_id:170720)会产生一个额外的“力”，其大小为 $-\partial(-N k_B T \ln V)/\partial V = N k_B T / V$。这个力可以被看作是源于粒子在有限体积内运动的熵效应，其形式如同一个“[理想气体](@entry_id:200096)”压力项，它与维里压力一起，共同平衡外部压力[@problem_id:3434168]。重要的是，这个修正项仅与体积 $V$（或 $\det \mathbf{h}$）有关，不依赖于粒子坐标 $\mathbf{s}_i$，因此它不改变粒子所受的物理力，也不改变维里的计算。

从动力学系统角度看，Parrinello-Rahman 方法是[哈密顿系统](@entry_id:143533)，其在扩展相空间中的流是不可压缩的，即**相空间[可压缩性](@entry_id:144559)为零**（$\kappa_{ps, PR} = 0$）[@problem_id:3434144]。这保证了它能够正确地保持相空间测度，从而在[遍历性假设](@entry_id:147104)下，严格地采样 NPT 系综。因此，对于需要精确计算系综平均性质和动力学性质的**生产阶段**（production）模拟，Parrinello-Rahman 及其变体是标准和推荐的选择。

### 各向同性与[各向异性压力](@entry_id:746456)控制

到目前为止，我们的讨论主要集中在[均匀缩放](@entry_id:267671)模拟盒（**各向同性**控制）的情形。然而，对于许多材料，特别是晶体，允许模拟盒的形状发生改变（**各向异性**控制）是至关重要的。

描述一个任意形状的周期性模拟盒，需要一个 $3 \times 3$ 的**盒矩阵** $\mathbf{h}$，其列向量 $\{\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3\}$ 是模拟盒的三个[晶格](@entry_id:196752)[基矢](@entry_id:199546)。盒子的体积为 $V = |\det(\mathbf{h})|$。盒子的形状和体积信息被完全编码在**度规张量**（metric tensor） $\mathbf{G} = \mathbf{h}^T\mathbf{h}$ 中。[度规张量](@entry_id:160222)的元素 $G_{ij} = \mathbf{a}_i \cdot \mathbf{a}_j$ 给出了[晶格](@entry_id:196752)[基矢](@entry_id:199546)的长度平方（对角元）和它们之间夹角（通过非对角元）。一个重要的性质是，度规张量 $\mathbf{G}$ 在盒子的刚性转动下保持不变，即它只编码盒子的内部几何（形状和体积），而不包含其在空间中的绝对取向[@problem_id:3434175]。

当模拟盒从一个参考构型 $\mathbf{h}_0$ 变形到一个当前构型 $\mathbf{h}$ 时，这种变形可以用[连续介质力学](@entry_id:155125)中的应变张量来量化。例如，**[格林-拉格朗日应变张量](@entry_id:187745)** $\mathbf{E}$ 可以通过盒矩阵和度规张量表示为[@problem_id:3434175]：
$$
\mathbf{E} = \frac{1}{2}((\mathbf{h}_{0}^{-1})^T \mathbf{G} \mathbf{h}_{0}^{-1} - \mathbf{I})
$$
其中 $\mathbf{I}$ 是单位矩阵。这个关系将微观的模拟盒动力学与宏观的[材料变形](@entry_id:169356)理论联系起来。

基于这些概念，我们可以区分两种[压力控制](@entry_id:166392)方式[@problem_id:3434182]：

1.  **各向同性恒压器**：这类[恒压器](@entry_id:200779)控制一个标量目标压力 $p_0$，并强制模拟盒进行均匀的、保持形状的缩放。这相当于只允许盒矩阵 $\mathbf{h}$ 乘以一个标量因子。这种方法适用于模拟本身就是各向同性的体系，或者其宏观响应可以近似为各向同性的情况。典型的例子包括：
    *   液体和气体
    *   [非晶固体](@entry_id:204277)（玻璃）
    *   [多晶材料](@entry_id:158956)（在宏观尺度上）
    *   处于静水压下的立方晶系的单晶

2.  **[各向异性恒压器](@entry_id:746444)**：这类[恒压器](@entry_id:200779)能够控制一个完整的张量目标压力 $\mathbf{P}_0$，并允许盒矩阵 $\mathbf{h}$ 的所有九个分量独立演化，从而使盒子的边长和角度都可以自由改变。这种方法是必需的，当：
    *   模拟具有[弹性各向异性](@entry_id:196053)的单晶材料（如六方、正交等非立方晶系）。
    *   系统处于非静水压应力状态下，如[单轴拉伸](@entry_id:188287)/压缩或[剪切应力](@entry_id:137139)。
    *   研究固-固[相变](@entry_id:147324)，特别是那些涉及[晶格](@entry_id:196752)[对称性破缺](@entry_id:158994)和[晶胞](@entry_id:143489)形状改变的[相变](@entry_id:147324)。
    *   模拟层状材料或界面体系，它们在不同方向上具有截然不同的力学响应。

Parrinello-Rahman 方法的强大之处在于它自然地推广到了各向异性情况。通过将 $\mathbf{h}$ 的所有分量（或其对称化的组合）都作为[扩展拉格朗日量](@entry_id:136469)中的动态变量，该方法可以模拟系统在最一般的应力状态下的响应[@problem_id:3434175]。此时，驱动盒子变形的“力”来自于内部[压力张量](@entry_id:147910) $\mathbf{P}$ 与外部目标[压力张量](@entry_id:147910) $\mathbf{P}_0$ 之差。这使得 PR [恒压器](@entry_id:200779)成为研究晶体[材料力学](@entry_id:201885)性质和[结构相变](@entry_id:201054)的不可或缺的工具。